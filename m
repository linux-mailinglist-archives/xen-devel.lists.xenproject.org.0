Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D9999144CA
	for <lists+xen-devel@lfdr.de>; Mon,  6 May 2019 09:00:22 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hNXZ7-000350-MQ; Mon, 06 May 2019 06:57:33 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=XZcu=TG=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hNXYn-0002K0-Ey
 for xen-devel@lists.xenproject.org; Mon, 06 May 2019 06:57:13 +0000
X-Inumbo-ID: 236f0133-6fcc-11e9-843c-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 236f0133-6fcc-11e9-843c-bc764e045a96;
 Mon, 06 May 2019 06:56:57 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 31FFFAF21;
 Mon,  6 May 2019 06:56:54 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  6 May 2019 08:56:19 +0200
Message-Id: <20190506065644.7415-21-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190506065644.7415-1-jgross@suse.com>
References: <20190506065644.7415-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH RFC V2 20/45] xen/sched: make credit scheduler
 vcpu agnostic.
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Dario Faggioli <dfaggioli@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U3dpdGNoIGNyZWRpdCBzY2hlZHVsZXIgY29tcGxldGVseSBmcm9tIHZjcHUgdG8gc2NoZWRfaXRl
bSB1c2FnZS4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4K
LS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jIHwgNTA0ICsrKysrKysrKysrKysrKysrKysr
KysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAyNTEgaW5zZXJ0aW9u
cygrKSwgMjUzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfY3Jl
ZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4IDc3YmViZjViNDIuLmJhYmNj
YjY5ZjcgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKKysrIGIveGVuL2Nv
bW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtNzAsMTAgKzcwLDEwIEBACiAgKiBpbmNvbnNpc3RlbnQg
c2V0IG9mIGxvY2tzLiBUaGVyZWZvcmUgYXRvbWljLXNhZmUgYml0IG9wZXJhdGlvbnMgbXVzdAog
ICogYmUgdXNlZCBmb3IgYWNjZXNzaW5nIGl0LgogICovCi0jZGVmaW5lIENTQ0hFRF9GTEFHX1ZD
UFVfUEFSS0VEICAgIDB4MCAgLyogVkNQVSBvdmVyIGNhcHBlZCBjcmVkaXRzICovCi0jZGVmaW5l
IENTQ0hFRF9GTEFHX1ZDUFVfWUlFTEQgICAgIDB4MSAgLyogVkNQVSB5aWVsZGluZyAqLwotI2Rl
ZmluZSBDU0NIRURfRkxBR19WQ1BVX01JR1JBVElORyAweDIgIC8qIFZDUFUgbWF5IGhhdmUgbW92
ZWQgdG8gYSBuZXcgcGNwdSAqLwotI2RlZmluZSBDU0NIRURfRkxBR19WQ1BVX1BJTk5FRCAgICAw
eDQgIC8qIFZDUFUgY2FuIHJ1biBvbmx5IG9uIDEgcGNwdSAqLworI2RlZmluZSBDU0NIRURfRkxB
R19JVEVNX1BBUktFRCAgICAweDAgIC8qIElURU0gb3ZlciBjYXBwZWQgY3JlZGl0cyAqLworI2Rl
ZmluZSBDU0NIRURfRkxBR19JVEVNX1lJRUxEICAgICAweDEgIC8qIElURU0geWllbGRpbmcgKi8K
KyNkZWZpbmUgQ1NDSEVEX0ZMQUdfSVRFTV9NSUdSQVRJTkcgMHgyICAvKiBJVEVNIG1heSBoYXZl
IG1vdmVkIHRvIGEgbmV3IHBjcHUgKi8KKyNkZWZpbmUgQ1NDSEVEX0ZMQUdfSVRFTV9QSU5ORUQg
ICAgMHg0ICAvKiBJVEVNIGNhbiBydW4gb25seSBvbiAxIHBjcHUgKi8KIAogCiAvKgpAQCAtOTEs
NyArOTEsNyBAQAogLyoKICAqIENTQ0hFRF9TVEFUUwogICoKLSAqIE1hbmFnZSB2ZXJ5IGJhc2lj
IHBlci12Q1BVIGNvdW50ZXJzIGFuZCBzdGF0cy4KKyAqIE1hbmFnZSB2ZXJ5IGJhc2ljIHBlci1p
dGVtIGNvdW50ZXJzIGFuZCBzdGF0cy4KICAqCiAgKiBVc2VmdWwgZm9yIGRlYnVnZ2luZyBsaXZl
IHN5c3RlbXMuIFRoZSBzdGF0cyBhcmUgZGlzcGxheWVkCiAgKiB3aXRoIHJ1bnEgZHVtcHMgKCdy
JyBvbiB0aGUgWGVuIGNvbnNvbGUpLgpAQCAtMTAwLDIzICsxMDAsMjMgQEAKIAogI2RlZmluZSBD
U0NIRURfU1RBVFMKIAotI2RlZmluZSBTQ0hFRF9WQ1BVX1NUQVRTX1JFU0VUKF9WKSAgICAgICAg
ICAgICAgICAgICAgICBcCisjZGVmaW5lIFNDSEVEX0lURU1fU1RBVFNfUkVTRVQoX1YpICAgICAg
ICAgICAgICAgICAgICAgIFwKICAgICBkbyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAogICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIG1lbXNldCgmKF9WKS0+c3RhdHMsIDAsIHNp
emVvZigoX1YpLT5zdGF0cykpOyAgIFwKICAgICB9IHdoaWxlICggMCApCiAKLSNkZWZpbmUgU0NI
RURfVkNQVV9TVEFUX0NSQU5LKF9WLCBfWCkgICAgICAgKCgoX1YpLT5zdGF0cy5fWCkrKykKKyNk
ZWZpbmUgU0NIRURfSVRFTV9TVEFUX0NSQU5LKF9WLCBfWCkgICAgICAgKCgoX1YpLT5zdGF0cy5f
WCkrKykKIAotI2RlZmluZSBTQ0hFRF9WQ1BVX1NUQVRfU0VUKF9WLCBfWCwgX1kpICAgICAoKChf
ViktPnN0YXRzLl9YKSA9IChfWSkpCisjZGVmaW5lIFNDSEVEX0lURU1fU1RBVF9TRVQoX1YsIF9Y
LCBfWSkgICAgICgoKF9WKS0+c3RhdHMuX1gpID0gKF9ZKSkKIAogI2Vsc2UgLyogIVNDSEVEX1NU
QVRTICovCiAKICN1bmRlZiBDU0NIRURfU1RBVFMKIAotI2RlZmluZSBTQ0hFRF9WQ1BVX1NUQVRT
X1JFU0VUKF9WKSAgICAgICAgIGRvIHt9IHdoaWxlICggMCApCi0jZGVmaW5lIFNDSEVEX1ZDUFVf
U1RBVF9DUkFOSyhfViwgX1gpICAgICAgZG8ge30gd2hpbGUgKCAwICkKLSNkZWZpbmUgU0NIRURf
VkNQVV9TVEFUX1NFVChfViwgX1gsIF9ZKSAgICBkbyB7fSB3aGlsZSAoIDAgKQorI2RlZmluZSBT
Q0hFRF9JVEVNX1NUQVRTX1JFU0VUKF9WKSAgICAgICAgIGRvIHt9IHdoaWxlICggMCApCisjZGVm
aW5lIFNDSEVEX0lURU1fU1RBVF9DUkFOSyhfViwgX1gpICAgICAgZG8ge30gd2hpbGUgKCAwICkK
KyNkZWZpbmUgU0NIRURfSVRFTV9TVEFUX1NFVChfViwgX1gsIF9ZKSAgICBkbyB7fSB3aGlsZSAo
IDAgKQogCiAjZW5kaWYgLyogU0NIRURfU1RBVFMgKi8KIApAQCAtMTI4LDcgKzEyOCw3IEBACiAj
ZGVmaW5lIFRSQ19DU0NIRURfU0NIRURfVEFTS0xFVCBUUkNfU0NIRURfQ0xBU1NfRVZUKENTQ0hF
RCwgMSkKICNkZWZpbmUgVFJDX0NTQ0hFRF9BQ0NPVU5UX1NUQVJUIFRSQ19TQ0hFRF9DTEFTU19F
VlQoQ1NDSEVELCAyKQogI2RlZmluZSBUUkNfQ1NDSEVEX0FDQ09VTlRfU1RPUCAgVFJDX1NDSEVE
X0NMQVNTX0VWVChDU0NIRUQsIDMpCi0jZGVmaW5lIFRSQ19DU0NIRURfU1RPTEVOX1ZDUFUgICBU
UkNfU0NIRURfQ0xBU1NfRVZUKENTQ0hFRCwgNCkKKyNkZWZpbmUgVFJDX0NTQ0hFRF9TVE9MRU5f
SVRFTSAgIFRSQ19TQ0hFRF9DTEFTU19FVlQoQ1NDSEVELCA0KQogI2RlZmluZSBUUkNfQ1NDSEVE
X1BJQ0tFRF9DUFUgICAgVFJDX1NDSEVEX0NMQVNTX0VWVChDU0NIRUQsIDUpCiAjZGVmaW5lIFRS
Q19DU0NIRURfVElDS0xFICAgICAgICBUUkNfU0NIRURfQ0xBU1NfRVZUKENTQ0hFRCwgNikKICNk
ZWZpbmUgVFJDX0NTQ0hFRF9CT09TVF9TVEFSVCAgIFRSQ19TQ0hFRF9DTEFTU19FVlQoQ1NDSEVE
LCA3KQpAQCAtMTU4LDE1ICsxNTgsMTUgQEAgc3RydWN0IGNzY2hlZF9wY3B1IHsKIH07CiAKIC8q
Ci0gKiBWaXJ0dWFsIENQVQorICogVmlydHVhbCBJVEVNCiAgKi8KIHN0cnVjdCBjc2NoZWRfaXRl
bSB7CiAgICAgc3RydWN0IGxpc3RfaGVhZCBydW5xX2VsZW07Ci0gICAgc3RydWN0IGxpc3RfaGVh
ZCBhY3RpdmVfdmNwdV9lbGVtOworICAgIHN0cnVjdCBsaXN0X2hlYWQgYWN0aXZlX2l0ZW1fZWxl
bTsKIAogICAgIC8qIFVwLXBvaW50ZXJzICovCiAgICAgc3RydWN0IGNzY2hlZF9kb20gKnNkb207
Ci0gICAgc3RydWN0IHZjcHUgKnZjcHU7CisgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW07CiAK
ICAgICBzX3RpbWVfdCBzdGFydF90aW1lOyAgIC8qIFdoZW4gd2Ugd2VyZSBzY2hlZHVsZWQgKHVz
ZWQgZm9yIGNyZWRpdCkgKi8KICAgICB1bnNpZ25lZCBmbGFnczsKQEAgLTE5MiwxMCArMTkyLDEw
IEBAIHN0cnVjdCBjc2NoZWRfaXRlbSB7CiAgKiBEb21haW4KICAqLwogc3RydWN0IGNzY2hlZF9k
b20gewotICAgIHN0cnVjdCBsaXN0X2hlYWQgYWN0aXZlX3ZjcHU7CisgICAgc3RydWN0IGxpc3Rf
aGVhZCBhY3RpdmVfaXRlbTsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGFjdGl2ZV9zZG9tX2VsZW07
CiAgICAgc3RydWN0IGRvbWFpbiAqZG9tOwotICAgIHVpbnQxNl90IGFjdGl2ZV92Y3B1X2NvdW50
OworICAgIHVpbnQxNl90IGFjdGl2ZV9pdGVtX2NvdW50OwogICAgIHVpbnQxNl90IHdlaWdodDsK
ICAgICB1aW50MTZfdCBjYXA7CiB9OwpAQCAtMjE1LDcgKzIxNSw3IEBAIHN0cnVjdCBjc2NoZWRf
cHJpdmF0ZSB7CiAKICAgICAvKiBQZXJpb2Qgb2YgbWFzdGVyIGFuZCB0aWNrIGluIG1pbGxpc2Vj
b25kcyAqLwogICAgIHVuc2lnbmVkIGludCB0aWNrX3BlcmlvZF91cywgdGlja3NfcGVyX3RzbGlj
ZTsKLSAgICBzX3RpbWVfdCByYXRlbGltaXQsIHRzbGljZSwgdmNwdV9taWdyX2RlbGF5OworICAg
IHNfdGltZV90IHJhdGVsaW1pdCwgdHNsaWNlLCBpdGVtX21pZ3JfZGVsYXk7CiAKICAgICBzdHJ1
Y3QgbGlzdF9oZWFkIGFjdGl2ZV9zZG9tOwogICAgIHVpbnQzMl90IHdlaWdodDsKQEAgLTIzMSw3
ICsyMzEsNyBAQCBzdGF0aWMgdm9pZCBjc2NoZWRfdGljayh2b2lkICpfY3B1KTsKIHN0YXRpYyB2
b2lkIGNzY2hlZF9hY2N0KHZvaWQgKmR1bW15KTsKIAogc3RhdGljIGlubGluZSBpbnQKLV9fdmNw
dV9vbl9ydW5xKHN0cnVjdCBjc2NoZWRfaXRlbSAqc3ZjKQorX19pdGVtX29uX3J1bnEoc3RydWN0
IGNzY2hlZF9pdGVtICpzdmMpCiB7CiAgICAgcmV0dXJuICFsaXN0X2VtcHR5KCZzdmMtPnJ1bnFf
ZWxlbSk7CiB9CkBAIC0yNDIsNyArMjQyLDcgQEAgX19ydW5xX2VsZW0oc3RydWN0IGxpc3RfaGVh
ZCAqZWxlbSkKICAgICByZXR1cm4gbGlzdF9lbnRyeShlbGVtLCBzdHJ1Y3QgY3NjaGVkX2l0ZW0s
IHJ1bnFfZWxlbSk7CiB9CiAKLS8qIElzIHRoZSBmaXJzdCBlbGVtZW50IG9mIGNwdSdzIHJ1bnEg
KGlmIGFueSkgY3B1J3MgaWRsZSB2Y3B1PyAqLworLyogSXMgdGhlIGZpcnN0IGVsZW1lbnQgb2Yg
Y3B1J3MgcnVucSAoaWYgYW55KSBjcHUncyBpZGxlIGl0ZW0/ICovCiBzdGF0aWMgaW5saW5lIGJv
b2xfdCBpc19ydW5xX2lkbGUodW5zaWduZWQgaW50IGNwdSkKIHsKICAgICAvKgpAQCAtMjUxLDcg
KzI1MSw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbF90IGlzX3J1bnFfaWRsZSh1bnNpZ25lZCBpbnQg
Y3B1KQogICAgIEFTU0VSVChzcGluX2lzX2xvY2tlZChwZXJfY3B1KHNjaGVkX3JlcywgY3B1KS0+
c2NoZWR1bGVfbG9jaykpOwogCiAgICAgcmV0dXJuIGxpc3RfZW1wdHkoUlVOUShjcHUpKSB8fAot
ICAgICAgICAgICBpc19pZGxlX3ZjcHUoX19ydW5xX2VsZW0oUlVOUShjcHUpLT5uZXh0KS0+dmNw
dSk7CisgICAgICAgICAgIGlzX2lkbGVfaXRlbShfX3J1bnFfZWxlbShSVU5RKGNwdSktPm5leHQp
LT5pdGVtKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkCkBAIC0yNzMsMTEgKzI3MywxMSBAQCBk
ZWNfbnJfcnVubmFibGUodW5zaWduZWQgaW50IGNwdSkKIHN0YXRpYyBpbmxpbmUgdm9pZAogX19y
dW5xX2luc2VydChzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnN2YykKIHsKLSAgICB1bnNpZ25lZCBpbnQg
Y3B1ID0gc3ZjLT52Y3B1LT5wcm9jZXNzb3I7CisgICAgdW5zaWduZWQgaW50IGNwdSA9IHNjaGVk
X2l0ZW1fY3B1KHN2Yy0+aXRlbSk7CiAgICAgY29uc3Qgc3RydWN0IGxpc3RfaGVhZCAqIGNvbnN0
IHJ1bnEgPSBSVU5RKGNwdSk7CiAgICAgc3RydWN0IGxpc3RfaGVhZCAqaXRlcjsKIAotICAgIEJV
R19PTiggX192Y3B1X29uX3J1bnEoc3ZjKSApOworICAgIEJVR19PTiggX19pdGVtX29uX3J1bnEo
c3ZjKSApOwogCiAgICAgbGlzdF9mb3JfZWFjaCggaXRlciwgcnVucSApCiAgICAgewpAQCAtMjg2
LDEwICsyODYsMTAgQEAgX19ydW5xX2luc2VydChzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnN2YykKICAg
ICAgICAgICAgIGJyZWFrOwogICAgIH0KIAotICAgIC8qIElmIHRoZSB2Y3B1IHlpZWxkZWQsIHRy
eSB0byBwdXQgaXQgYmVoaW5kIG9uZSBsb3dlci1wcmlvcml0eQotICAgICAqIHJ1bm5hYmxlIHZj
cHUgaWYgd2UgY2FuLiAgVGhlIG5leHQgcnVucV9zb3J0IHdpbGwgYnJpbmcgaXQgZm9yd2FyZAor
ICAgIC8qIElmIHRoZSBpdGVtIHlpZWxkZWQsIHRyeSB0byBwdXQgaXQgYmVoaW5kIG9uZSBsb3dl
ci1wcmlvcml0eQorICAgICAqIHJ1bm5hYmxlIGl0ZW0gaWYgd2UgY2FuLiAgVGhlIG5leHQgcnVu
cV9zb3J0IHdpbGwgYnJpbmcgaXQgZm9yd2FyZAogICAgICAqIHdpdGhpbiAzMG1zIGlmIHRoZSBx
dWV1ZSB0b28gbG9uZy4gKi8KLSAgICBpZiAoIHRlc3RfYml0KENTQ0hFRF9GTEFHX1ZDUFVfWUlF
TEQsICZzdmMtPmZsYWdzKQorICAgIGlmICggdGVzdF9iaXQoQ1NDSEVEX0ZMQUdfSVRFTV9ZSUVM
RCwgJnN2Yy0+ZmxhZ3MpCiAgICAgICAgICAmJiBfX3J1bnFfZWxlbShpdGVyKS0+cHJpID4gQ1ND
SEVEX1BSSV9JRExFICkKICAgICB7CiAgICAgICAgIGl0ZXI9aXRlci0+bmV4dDsKQEAgLTMwNSwy
MCArMzA1LDIwIEBAIHN0YXRpYyBpbmxpbmUgdm9pZAogcnVucV9pbnNlcnQoc3RydWN0IGNzY2hl
ZF9pdGVtICpzdmMpCiB7CiAgICAgX19ydW5xX2luc2VydChzdmMpOwotICAgIGluY19ucl9ydW5u
YWJsZShzdmMtPnZjcHUtPnByb2Nlc3Nvcik7CisgICAgaW5jX25yX3J1bm5hYmxlKHNjaGVkX2l0
ZW1fY3B1KHN2Yy0+aXRlbSkpOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQKIF9fcnVucV9yZW1v
dmUoc3RydWN0IGNzY2hlZF9pdGVtICpzdmMpCiB7Ci0gICAgQlVHX09OKCAhX192Y3B1X29uX3J1
bnEoc3ZjKSApOworICAgIEJVR19PTiggIV9faXRlbV9vbl9ydW5xKHN2YykgKTsKICAgICBsaXN0
X2RlbF9pbml0KCZzdmMtPnJ1bnFfZWxlbSk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZAogcnVu
cV9yZW1vdmUoc3RydWN0IGNzY2hlZF9pdGVtICpzdmMpCiB7Ci0gICAgZGVjX25yX3J1bm5hYmxl
KHN2Yy0+dmNwdS0+cHJvY2Vzc29yKTsKKyAgICBkZWNfbnJfcnVubmFibGUoc2NoZWRfaXRlbV9j
cHUoc3ZjLT5pdGVtKSk7CiAgICAgX19ydW5xX3JlbW92ZShzdmMpOwogfQogCkBAIC0zMjksNyAr
MzI5LDcgQEAgc3RhdGljIHZvaWQgYnVybl9jcmVkaXRzKHN0cnVjdCBjc2NoZWRfaXRlbSAqc3Zj
LCBzX3RpbWVfdCBub3cpCiAgICAgdW5zaWduZWQgaW50IGNyZWRpdHM7CiAKICAgICAvKiBBc3Nl
cnQgc3ZjIGlzIGN1cnJlbnQgKi8KLSAgICBBU1NFUlQoIHN2YyA9PSBDU0NIRURfSVRFTShjdXJy
X29uX2NwdShzdmMtPnZjcHUtPnByb2Nlc3NvcikpICk7CisgICAgQVNTRVJUKCBzdmMgPT0gQ1ND
SEVEX0lURU0oY3Vycl9vbl9jcHUoc2NoZWRfaXRlbV9jcHUoc3ZjLT5pdGVtKSkpICk7CiAKICAg
ICBpZiAoIChkZWx0YSA9IG5vdyAtIHN2Yy0+c3RhcnRfdGltZSkgPD0gMCApCiAgICAgICAgIHJl
dHVybjsKQEAgLTM0OSw4ICszNDksOCBAQCBERUZJTkVfUEVSX0NQVSh1bnNpZ25lZCBpbnQsIGxh
c3RfdGlja2xlX2NwdSk7CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBfX3J1bnFfdGlja2xlKHN0cnVj
dCBjc2NoZWRfaXRlbSAqbmV3KQogewotICAgIHVuc2lnbmVkIGludCBjcHUgPSBuZXctPnZjcHUt
PnByb2Nlc3NvcjsKLSAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSA9IG5ldy0+dmNwdS0+c2No
ZWRfaXRlbTsKKyAgICB1bnNpZ25lZCBpbnQgY3B1ID0gc2NoZWRfaXRlbV9jcHUobmV3LT5pdGVt
KTsKKyAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSA9IG5ldy0+aXRlbTsKICAgICBzdHJ1Y3Qg
Y3NjaGVkX2l0ZW0gKiBjb25zdCBjdXIgPSBDU0NIRURfSVRFTShjdXJyX29uX2NwdShjcHUpKTsK
ICAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKHBlcl9jcHUoc2No
ZWR1bGVyLCBjcHUpKTsKICAgICBjcHVtYXNrX3QgbWFzaywgaWRsZV9tYXNrLCAqb25saW5lOwpA
QCAtMzY0LDE2ICszNjQsMTYgQEAgc3RhdGljIGlubGluZSB2b2lkIF9fcnVucV90aWNrbGUoc3Ry
dWN0IGNzY2hlZF9pdGVtICpuZXcpCiAgICAgaWRsZXJzX2VtcHR5ID0gY3B1bWFza19lbXB0eSgm
aWRsZV9tYXNrKTsKIAogICAgIC8qCi0gICAgICogRXhjbHVzaXZlIHBpbm5pbmcgaXMgd2hlbiBh
IHZjcHUgaGFzIGhhcmQtYWZmaW5pdHkgd2l0aCBvbmx5IG9uZQotICAgICAqIGNwdSwgYW5kIHRo
ZXJlIGlzIG5vIG90aGVyIHZjcHUgdGhhdCBoYXMgaGFyZC1hZmZpbml0eSB3aXRoIHRoYXQKKyAg
ICAgKiBFeGNsdXNpdmUgcGlubmluZyBpcyB3aGVuIGEgaXRlbSBoYXMgaGFyZC1hZmZpbml0eSB3
aXRoIG9ubHkgb25lCisgICAgICogY3B1LCBhbmQgdGhlcmUgaXMgbm8gb3RoZXIgaXRlbSB0aGF0
IGhhcyBoYXJkLWFmZmluaXR5IHdpdGggdGhhdAogICAgICAqIHNhbWUgY3B1LiBUaGlzIGlzIGlu
ZnJlcXVlbnQsIGJ1dCBpZiBpdCBoYXBwZW5zLCBpcyBmb3IgYWNoaWV2aW5nCiAgICAgICogdGhl
IG1vc3QgcG9zc2libGUgZGV0ZXJtaW5pc20sIGFuZCBsZWFzdCBwb3NzaWJsZSBvdmVyaGVhZCBm
b3IKLSAgICAgKiB0aGUgdmNwdXMgaW4gcXVlc3Rpb24uCisgICAgICogdGhlIGl0ZW1zIGluIHF1
ZXN0aW9uLgogICAgICAqCiAgICAgICogVHJ5IHRvIGlkZW50aWZ5IHRoZSB2YXN0IG1ham9yaXR5
IG9mIHRoZXNlIHNpdHVhdGlvbnMsIGFuZCBkZWFsCiAgICAgICogd2l0aCB0aGVtIHF1aWNrbHku
CiAgICAgICovCi0gICAgaWYgKCB1bmxpa2VseSh0ZXN0X2JpdChDU0NIRURfRkxBR19WQ1BVX1BJ
Tk5FRCwgJm5ldy0+ZmxhZ3MpICYmCisgICAgaWYgKCB1bmxpa2VseSh0ZXN0X2JpdChDU0NIRURf
RkxBR19JVEVNX1BJTk5FRCwgJm5ldy0+ZmxhZ3MpICYmCiAgICAgICAgICAgICAgICAgICBjcHVt
YXNrX3Rlc3RfY3B1KGNwdSwgJmlkbGVfbWFzaykpICkKICAgICB7CiAgICAgICAgIEFTU0VSVChj
cHVtYXNrX2N5Y2xlKGNwdSwgaXRlbS0+Y3B1X2hhcmRfYWZmaW5pdHkpID09IGNwdSk7CkBAIC0z
ODQsNyArMzg0LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIF9fcnVucV90aWNrbGUoc3RydWN0IGNz
Y2hlZF9pdGVtICpuZXcpCiAKICAgICAvKgogICAgICAqIElmIHRoZSBwY3B1IGlzIGlkbGUsIG9y
IHRoZXJlIGFyZSBubyBpZGxlcnMgYW5kIHRoZSBuZXcKLSAgICAgKiB2Y3B1IGlzIGEgaGlnaGVy
IHByaW9yaXR5IHRoYW4gdGhlIG9sZCB2Y3B1LCBydW4gaXQgaGVyZS4KKyAgICAgKiBpdGVtIGlz
IGEgaGlnaGVyIHByaW9yaXR5IHRoYW4gdGhlIG9sZCBpdGVtLCBydW4gaXQgaGVyZS4KICAgICAg
KgogICAgICAqIElmIHRoZXJlIGFyZSBpZGxlIGNwdXMsIGZpcnN0IHRyeSB0byBmaW5kIG9uZSBz
dWl0YWJsZSB0byBydW4KICAgICAgKiBuZXcsIHNvIHdlIGNhbiBhdm9pZCBwcmVlbXB0aW5nIGN1
ci4gIElmIHdlIGNhbm5vdCBmaW5kIGEKQEAgLTQwMyw3ICs0MDMsNyBAQCBzdGF0aWMgaW5saW5l
IHZvaWQgX19ydW5xX3RpY2tsZShzdHJ1Y3QgY3NjaGVkX2l0ZW0gKm5ldykKICAgICBlbHNlIGlm
ICggIWlkbGVyc19lbXB0eSApCiAgICAgewogICAgICAgICAvKgotICAgICAgICAgKiBTb2Z0IGFu
ZCBoYXJkIGFmZmluaXR5IGJhbGFuY2luZyBsb29wLiBGb3IgdmNwdXMgd2l0aG91dAorICAgICAg
ICAgKiBTb2Z0IGFuZCBoYXJkIGFmZmluaXR5IGJhbGFuY2luZyBsb29wLiBGb3IgaXRlbXMgd2l0
aG91dAogICAgICAgICAgKiBhIHVzZWZ1bCBzb2Z0IGFmZmluaXR5LCBjb25zaWRlciBoYXJkIGFm
ZmluaXR5IG9ubHkuCiAgICAgICAgICAqLwogICAgICAgICBmb3JfZWFjaF9hZmZpbml0eV9iYWxh
bmNlX3N0ZXAoIGJhbGFuY2Vfc3RlcCApCkBAIC00NDYsMTAgKzQ0NiwxMCBAQCBzdGF0aWMgaW5s
aW5lIHZvaWQgX19ydW5xX3RpY2tsZShzdHJ1Y3QgY3NjaGVkX2l0ZW0gKm5ldykKICAgICAgICAg
ICAgIHsKICAgICAgICAgICAgICAgICBpZiAoIGNwdW1hc2tfaW50ZXJzZWN0cyhpdGVtLT5jcHVf
aGFyZF9hZmZpbml0eSwgJmlkbGVfbWFzaykgKQogICAgICAgICAgICAgICAgIHsKLSAgICAgICAg
ICAgICAgICAgICAgU0NIRURfVkNQVV9TVEFUX0NSQU5LKGN1ciwga2lja2VkX2F3YXkpOwotICAg
ICAgICAgICAgICAgICAgICBTQ0hFRF9WQ1BVX1NUQVRfQ1JBTksoY3VyLCBtaWdyYXRlX3IpOwor
ICAgICAgICAgICAgICAgICAgICBTQ0hFRF9JVEVNX1NUQVRfQ1JBTksoY3VyLCBraWNrZWRfYXdh
eSk7CisgICAgICAgICAgICAgICAgICAgIFNDSEVEX0lURU1fU1RBVF9DUkFOSyhjdXIsIG1pZ3Jh
dGVfcik7CiAgICAgICAgICAgICAgICAgICAgIFNDSEVEX1NUQVRfQ1JBTksobWlncmF0ZV9raWNr
ZWRfYXdheSk7Ci0gICAgICAgICAgICAgICAgICAgIHNldF9iaXQoX1ZQRl9taWdyYXRpbmcsICZj
dXItPnZjcHUtPnBhdXNlX2ZsYWdzKTsKKyAgICAgICAgICAgICAgICAgICAgc2NoZWRfc2V0X3Bh
dXNlX2ZsYWdzX2F0b21pYyhjdXItPml0ZW0sIF9WUEZfbWlncmF0aW5nKTsKICAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICAgLyogVGlja2xlIGNwdSBhbnl3YXksIHRvIGxldCBuZXcg
cHJlZW1wdCBjdXIuICovCiAgICAgICAgICAgICAgICAgU0NIRURfU1RBVF9DUkFOSyh0aWNrbGVk
X2J1c3lfY3B1KTsKQEAgLTYwNSw3ICs2MDUsNyBAQCBpbml0X3BkYXRhKHN0cnVjdCBjc2NoZWRf
cHJpdmF0ZSAqcHJ2LCBzdHJ1Y3QgY3NjaGVkX3BjcHUgKnNwYywgaW50IGNwdSkKICAgICBzcGMt
PmlkbGVfYmlhcyA9IG5yX2NwdV9pZHMgLSAxOwogCiAgICAgLyogU3RhcnQgb2ZmIGlkbGluZy4u
LiAqLwotICAgIEJVR19PTighaXNfaWRsZV92Y3B1KGN1cnJfb25fY3B1KGNwdSktPnZjcHUpKTsK
KyAgICBCVUdfT04oIWlzX2lkbGVfaXRlbShjdXJyX29uX2NwdShjcHUpKSk7CiAgICAgY3B1bWFz
a19zZXRfY3B1KGNwdSwgcHJ2LT5pZGxlcnMpOwogICAgIHNwYy0+bnJfcnVubmFibGUgPSAwOwog
fQpAQCAtNjM5LDkgKzYzOSw5IEBAIGNzY2hlZF9zd2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxl
ciAqbmV3X29wcywgdW5zaWduZWQgaW50IGNwdSwKICAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUg
KnBydiA9IENTQ0hFRF9QUklWKG5ld19vcHMpOwogICAgIHN0cnVjdCBjc2NoZWRfaXRlbSAqc3Zj
ID0gdmRhdGE7CiAKLSAgICBBU1NFUlQoc3ZjICYmIGlzX2lkbGVfdmNwdShzdmMtPnZjcHUpKTsK
KyAgICBBU1NFUlQoc3ZjICYmIGlzX2lkbGVfaXRlbShzdmMtPml0ZW0pKTsKIAotICAgIGlkbGVf
dmNwdVtjcHVdLT5zY2hlZF9pdGVtLT5wcml2ID0gdmRhdGE7CisgICAgc2NoZWRfaWRsZV9pdGVt
KGNwdSktPnByaXYgPSB2ZGF0YTsKIAogICAgIC8qCiAgICAgICogV2UgYXJlIGhvbGRpbmcgdGhl
IHJ1bnF1ZXVlIGxvY2sgYWxyZWFkeSAoaXQncyBiZWVuIHRha2VuIGluCkBAIC02NjcsMzMgKzY2
NywzMyBAQCBjc2NoZWRfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVu
c2lnbmVkIGludCBjcHUsCiAKICNpZm5kZWYgTkRFQlVHCiBzdGF0aWMgaW5saW5lIHZvaWQKLV9f
Y3NjaGVkX3ZjcHVfY2hlY2soc3RydWN0IHZjcHUgKnZjKQorX19jc2NoZWRfaXRlbV9jaGVjayhz
dHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKLSAgICBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKiBjb25z
dCBzdmMgPSBDU0NIRURfSVRFTSh2Yy0+c2NoZWRfaXRlbSk7CisgICAgc3RydWN0IGNzY2hlZF9p
dGVtICogY29uc3Qgc3ZjID0gQ1NDSEVEX0lURU0oaXRlbSk7CiAgICAgc3RydWN0IGNzY2hlZF9k
b20gKiBjb25zdCBzZG9tID0gc3ZjLT5zZG9tOwogCi0gICAgQlVHX09OKCBzdmMtPnZjcHUgIT0g
dmMgKTsKLSAgICBCVUdfT04oIHNkb20gIT0gQ1NDSEVEX0RPTSh2Yy0+ZG9tYWluKSApOworICAg
IEJVR19PTiggc3ZjLT5pdGVtICE9IGl0ZW0gKTsKKyAgICBCVUdfT04oIHNkb20gIT0gQ1NDSEVE
X0RPTShpdGVtLT5kb21haW4pICk7CiAgICAgaWYgKCBzZG9tICkKICAgICB7Ci0gICAgICAgIEJV
R19PTiggaXNfaWRsZV92Y3B1KHZjKSApOwotICAgICAgICBCVUdfT04oIHNkb20tPmRvbSAhPSB2
Yy0+ZG9tYWluICk7CisgICAgICAgIEJVR19PTiggaXNfaWRsZV9pdGVtKGl0ZW0pICk7CisgICAg
ICAgIEJVR19PTiggc2RvbS0+ZG9tICE9IGl0ZW0tPmRvbWFpbiApOwogICAgIH0KICAgICBlbHNl
CiAgICAgewotICAgICAgICBCVUdfT04oICFpc19pZGxlX3ZjcHUodmMpICk7CisgICAgICAgIEJV
R19PTiggIWlzX2lkbGVfaXRlbShpdGVtKSApOwogICAgIH0KIAogICAgIFNDSEVEX1NUQVRfQ1JB
TksoaXRlbV9jaGVjayk7CiB9Ci0jZGVmaW5lIENTQ0hFRF9WQ1BVX0NIRUNLKF92YykgIChfX2Nz
Y2hlZF92Y3B1X2NoZWNrKF92YykpCisjZGVmaW5lIENTQ0hFRF9JVEVNX0NIRUNLKGl0ZW0pICAo
X19jc2NoZWRfaXRlbV9jaGVjayhpdGVtKSkKICNlbHNlCi0jZGVmaW5lIENTQ0hFRF9WQ1BVX0NI
RUNLKF92YykKKyNkZWZpbmUgQ1NDSEVEX0lURU1fQ0hFQ0soaXRlbSkKICNlbmRpZgogCiAvKgot
ICogRGVsYXksIGluIG1pY3Jvc2Vjb25kcywgYmV0d2VlbiBtaWdyYXRpb25zIG9mIGEgVkNQVSBi
ZXR3ZWVuIFBDUFVzLgotICogVGhpcyBwcmV2ZW50cyByYXBpZCBmbHV0dGVyaW5nIG9mIGEgVkNQ
VSBiZXR3ZWVuIENQVXMsIGFuZCByZWR1Y2VzIHRoZQorICogRGVsYXksIGluIG1pY3Jvc2Vjb25k
cywgYmV0d2VlbiBtaWdyYXRpb25zIG9mIGEgSVRFTSBiZXR3ZWVuIFBDUFVzLgorICogVGhpcyBw
cmV2ZW50cyByYXBpZCBmbHV0dGVyaW5nIG9mIGEgSVRFTSBiZXR3ZWVuIENQVXMsIGFuZCByZWR1
Y2VzIHRoZQogICogaW1wbGljaXQgb3ZlcmhlYWRzIHN1Y2ggYXMgY2FjaGUtd2FybWluZy4gMW1z
ICgxMDAwKSBoYXMgYmVlbiBtZWFzdXJlZAogICogYXMgYSBnb29kIHZhbHVlLgogICovCkBAIC03
MDEsMTAgKzcwMSwxMSBAQCBzdGF0aWMgdW5zaWduZWQgaW50IHZjcHVfbWlncmF0aW9uX2RlbGF5
X3VzOwogaW50ZWdlcl9wYXJhbSgidmNwdV9taWdyYXRpb25fZGVsYXkiLCB2Y3B1X21pZ3JhdGlv
bl9kZWxheV91cyk7CiAKIHN0YXRpYyBpbmxpbmUgYm9vbAotX19jc2NoZWRfdmNwdV9pc19jYWNo
ZV9ob3QoY29uc3Qgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIHN0cnVjdCB2Y3B1ICp2KQor
X19jc2NoZWRfaXRlbV9pc19jYWNoZV9ob3QoY29uc3Qgc3RydWN0IGNzY2hlZF9wcml2YXRlICpw
cnYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkK
IHsKLSAgICBib29sIGhvdCA9IHBydi0+dmNwdV9taWdyX2RlbGF5ICYmCi0gICAgICAgICAgICAg
ICAoTk9XKCkgLSB2LT5zY2hlZF9pdGVtLT5sYXN0X3J1bl90aW1lKSA8IHBydi0+dmNwdV9taWdy
X2RlbGF5OworICAgIGJvb2wgaG90ID0gcHJ2LT5pdGVtX21pZ3JfZGVsYXkgJiYKKyAgICAgICAg
ICAgICAgIChOT1coKSAtIGl0ZW0tPmxhc3RfcnVuX3RpbWUpIDwgcHJ2LT5pdGVtX21pZ3JfZGVs
YXk7CiAKICAgICBpZiAoIGhvdCApCiAgICAgICAgIFNDSEVEX1NUQVRfQ1JBTksoaXRlbV9ob3Qp
OwpAQCAtNzEzLDM2ICs3MTQsMzggQEAgX19jc2NoZWRfdmNwdV9pc19jYWNoZV9ob3QoY29uc3Qg
c3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIHN0cnVjdCB2Y3B1ICp2KQogfQogCiBzdGF0aWMg
aW5saW5lIGludAotX19jc2NoZWRfdmNwdV9pc19taWdyYXRlYWJsZShjb25zdCBzdHJ1Y3QgY3Nj
aGVkX3ByaXZhdGUgKnBydiwgc3RydWN0IHZjcHUgKnZjLAorX19jc2NoZWRfaXRlbV9pc19taWdy
YXRlYWJsZShjb25zdCBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0sCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBkZXN0X2NwdSwgY3B1bWFza190ICptYXNrKQogewogICAgIC8qCiAg
ICAgICogRG9uJ3QgcGljayB1cCB3b3JrIHRoYXQncyBob3Qgb24gcGVlciBQQ1BVLCBvciB0aGF0
IGNhbid0IChvcgogICAgICAqIHdvdWxkIHByZWZlciBub3QgdG8pIHJ1biBvbiBjcHUuCiAgICAg
ICoKLSAgICAgKiBUaGUgY2FsbGVyIGlzIHN1cHBvc2VkIHRvIGhhdmUgYWxyZWFkeSBjaGVja2Vk
IHRoYXQgdmMgaXMgYWxzbworICAgICAqIFRoZSBjYWxsZXIgaXMgc3VwcG9zZWQgdG8gaGF2ZSBh
bHJlYWR5IGNoZWNrZWQgdGhhdCBpdGVtIGlzIGFsc28KICAgICAgKiBub3QgcnVubmluZy4KICAg
ICAgKi8KLSAgICBBU1NFUlQoIXZjLT5zY2hlZF9pdGVtLT5pc19ydW5uaW5nKTsKKyAgICBBU1NF
UlQoIWl0ZW0tPmlzX3J1bm5pbmcpOwogCi0gICAgcmV0dXJuICFfX2NzY2hlZF92Y3B1X2lzX2Nh
Y2hlX2hvdChwcnYsIHZjKSAmJgorICAgIHJldHVybiAhX19jc2NoZWRfaXRlbV9pc19jYWNoZV9o
b3QocHJ2LCBpdGVtKSAmJgogICAgICAgICAgICBjcHVtYXNrX3Rlc3RfY3B1KGRlc3RfY3B1LCBt
YXNrKTsKIH0KIAogc3RhdGljIGludAotX2NzY2hlZF9jcHVfcGljayhjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YywgYm9vbF90IGNvbW1pdCkKK19jc2NoZWRfY3B1
X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRl
bSwKKyAgICAgICAgICAgICAgICAgYm9vbF90IGNvbW1pdCkKIHsKLSAgICAvKiBXZSBtdXN0IGFs
d2F5cyB1c2UgdmMtPnByb2Nzc29yJ3Mgc2NyYXRjaCBzcGFjZSAqLwotICAgIGNwdW1hc2tfdCAq
Y3B1cyA9IGNwdW1hc2tfc2NyYXRjaF9jcHUodmMtPnByb2Nlc3Nvcik7CisgICAgaW50IGNwdSA9
IHNjaGVkX2l0ZW1fY3B1KGl0ZW0pOworICAgIC8qIFdlIG11c3QgYWx3YXlzIHVzZSBjcHUncyBz
Y3JhdGNoIHNwYWNlICovCisgICAgY3B1bWFza190ICpjcHVzID0gY3B1bWFza19zY3JhdGNoX2Nw
dShjcHUpOwogICAgIGNwdW1hc2tfdCBpZGxlcnM7Ci0gICAgY3B1bWFza190ICpvbmxpbmUgPSBj
cHVwb29sX2RvbWFpbl9jcHVtYXNrKHZjLT5kb21haW4pOworICAgIGNwdW1hc2tfdCAqb25saW5l
ID0gY3B1cG9vbF9kb21haW5fY3B1bWFzayhpdGVtLT5kb21haW4pOwogICAgIHN0cnVjdCBjc2No
ZWRfcGNwdSAqc3BjID0gTlVMTDsKLSAgICBpbnQgY3B1ID0gdmMtPnByb2Nlc3NvcjsKICAgICBp
bnQgYmFsYW5jZV9zdGVwOwogCiAgICAgZm9yX2VhY2hfYWZmaW5pdHlfYmFsYW5jZV9zdGVwKCBi
YWxhbmNlX3N0ZXAgKQogICAgIHsKLSAgICAgICAgYWZmaW5pdHlfYmFsYW5jZV9jcHVtYXNrKHZj
LT5zY2hlZF9pdGVtLCBiYWxhbmNlX3N0ZXAsIGNwdXMpOworICAgICAgICBhZmZpbml0eV9iYWxh
bmNlX2NwdW1hc2soaXRlbSwgYmFsYW5jZV9zdGVwLCBjcHVzKTsKICAgICAgICAgY3B1bWFza19h
bmQoY3B1cywgb25saW5lLCBjcHVzKTsKICAgICAgICAgLyoKICAgICAgICAgICogV2Ugd2FudCB0
byBwaWNrIHVwIGEgcGNwdSBhbW9uZyB0aGUgb25lcyB0aGF0IGFyZSBvbmxpbmUgYW5kCkBAIC03
NjEsMTIgKzc2NCwxMyBAQCBfY3NjaGVkX2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
Km9wcywgc3RydWN0IHZjcHUgKnZjLCBib29sX3QgY29tbWl0KQogICAgICAgICAgKiBiYWxhbmNp
bmcgc3RlcCBhbGwgdG9nZXRoZXIuCiAgICAgICAgICAqLwogICAgICAgICBpZiAoIGJhbGFuY2Vf
c3RlcCA9PSBCQUxBTkNFX1NPRlRfQUZGSU5JVFkgJiYKLSAgICAgICAgICAgICAoIWhhc19zb2Z0
X2FmZmluaXR5KHZjLT5zY2hlZF9pdGVtKSB8fCBjcHVtYXNrX2VtcHR5KGNwdXMpKSApCisgICAg
ICAgICAgICAgKCFoYXNfc29mdF9hZmZpbml0eShpdGVtKSB8fCBjcHVtYXNrX2VtcHR5KGNwdXMp
KSApCiAgICAgICAgICAgICBjb250aW51ZTsKIAogICAgICAgICAvKiBJZiBwcmVzZW50LCBwcmVm
ZXIgdmMncyBjdXJyZW50IHByb2Nlc3NvciAqLwotICAgICAgICBjcHUgPSBjcHVtYXNrX3Rlc3Rf
Y3B1KHZjLT5wcm9jZXNzb3IsIGNwdXMpCi0gICAgICAgICAgICAgICAgPyB2Yy0+cHJvY2Vzc29y
IDogY3B1bWFza19jeWNsZSh2Yy0+cHJvY2Vzc29yLCBjcHVzKTsKKyAgICAgICAgY3B1ID0gY3B1
bWFza190ZXN0X2NwdShzY2hlZF9pdGVtX2NwdShpdGVtKSwgY3B1cykKKyAgICAgICAgICAgICAg
ICA/IHNjaGVkX2l0ZW1fY3B1KGl0ZW0pCisgICAgICAgICAgICAgICAgOiBjcHVtYXNrX2N5Y2xl
KHNjaGVkX2l0ZW1fY3B1KGl0ZW0pLCBjcHVzKTsKICAgICAgICAgQVNTRVJUKGNwdW1hc2tfdGVz
dF9jcHUoY3B1LCBjcHVzKSk7CiAKICAgICAgICAgLyoKQEAgLTc3OCwxNSArNzgyLDE1IEBAIF9j
c2NoZWRfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAq
dmMsIGJvb2xfdCBjb21taXQpCiAgICAgICAgICAqIFdlIGdpdmUgcHJlZmVyZW5jZSB0byB0aGUg
aWRsZSBleGVjdXRpb24gdmVoaWNsZSB3aXRoIHRoZSBtb3N0CiAgICAgICAgICAqIGlkbGluZyBu
ZWlnaGJvdXJzIGluIGl0cyBncm91cGluZy4gVGhpcyBkaXN0cmlidXRlcyB3b3JrIGFjcm9zcwog
ICAgICAgICAgKiBkaXN0aW5jdCBjb3JlcyBmaXJzdCBhbmQgZ3VhcmFudGVlcyB3ZSBkb24ndCBk
byBzb21ldGhpbmcgc3R1cGlkCi0gICAgICAgICAqIGxpa2UgcnVuIHR3byBWQ1BVcyBvbiBjby1o
eXBlcnRocmVhZHMgd2hpbGUgdGhlcmUgYXJlIGlkbGUgY29yZXMKKyAgICAgICAgICogbGlrZSBy
dW4gdHdvIElURU1zIG9uIGNvLWh5cGVydGhyZWFkcyB3aGlsZSB0aGVyZSBhcmUgaWRsZSBjb3Jl
cwogICAgICAgICAgKiBvciBzb2NrZXRzLgogICAgICAgICAgKgogICAgICAgICAgKiBOb3RpY2Ug
dGhhdCwgd2hlbiBjb21wdXRpbmcgdGhlICJpZGxlbmVzcyIgb2YgY3B1LCB3ZSBtYXkgd2FudCB0
bwotICAgICAgICAgKiBkaXNjb3VudCB2Yy4gVGhhdCBpcywgaWZmIHZjIGlzIHRoZSBjdXJyZW50
bHkgcnVubmluZyBhbmQgdGhlIG9ubHkKLSAgICAgICAgICogcnVubmFibGUgdmNwdSBvbiBjcHUs
IHdlIGFkZCBjcHUgdG8gdGhlIGlkbGVycy4KKyAgICAgICAgICogZGlzY291bnQgaXRlbS4gVGhh
dCBpcywgaWZmIGl0ZW0gaXMgdGhlIGN1cnJlbnRseSBydW5uaW5nIGFuZCB0aGUKKyAgICAgICAg
ICogb25seSBydW5uYWJsZSBpdGVtIG9uIGNwdSwgd2UgYWRkIGNwdSB0byB0aGUgaWRsZXJzLgog
ICAgICAgICAgKi8KICAgICAgICAgY3B1bWFza19hbmQoJmlkbGVycywgJmNwdV9vbmxpbmVfbWFw
LCBDU0NIRURfUFJJVihvcHMpLT5pZGxlcnMpOwotICAgICAgICBpZiAoIHZjLT5wcm9jZXNzb3Ig
PT0gY3B1ICYmIGlzX3J1bnFfaWRsZShjcHUpICkKKyAgICAgICAgaWYgKCBzY2hlZF9pdGVtX2Nw
dShpdGVtKSA9PSBjcHUgJiYgaXNfcnVucV9pZGxlKGNwdSkgKQogICAgICAgICAgICAgX19jcHVt
YXNrX3NldF9jcHUoY3B1LCAmaWRsZXJzKTsKICAgICAgICAgY3B1bWFza19hbmQoY3B1cywgJmlk
bGVycywgY3B1cyk7CiAKQEAgLTc5Niw3ICs4MDAsNyBAQCBfY3NjaGVkX2NwdV9waWNrKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjLCBib29sX3QgY29tbWl0KQog
ICAgICAgICAgKiBDUFUsIGFzIHdlIGp1c3QgJiYtZWQgaXQgd2l0aCBpZGxlcnMpLiBJbiBmYWN0
LCBpZiB3ZSBhcmUgb24gU01ULCBhbmQKICAgICAgICAgICogY3B1IHBvaW50cyB0byBhIGJ1c3kg
dGhyZWFkIHdpdGggYW4gaWRsZSBzaWJsaW5nLCBib3RoIHRoZSB0aHJlYWRzCiAgICAgICAgICAq
IHdpbGwgYmUgY29uc2lkZXJlZCB0aGUgc2FtZSwgZnJvbSB0aGUgImlkbGVuZXNzIiBjYWxjdWxh
dGlvbiBwb2ludAotICAgICAgICAgKiBvZiB2aWV3IiwgcHJldmVudGluZyB2Y3B1IGZyb20gYmVp
bmcgbW92ZWQgdG8gdGhlIHRocmVhZCB0aGF0IGlzCisgICAgICAgICAqIG9mIHZpZXciLCBwcmV2
ZW50aW5nIGl0ZW0gZnJvbSBiZWluZyBtb3ZlZCB0byB0aGUgdGhyZWFkIHRoYXQgaXMKICAgICAg
ICAgICogYWN0dWFsbHkgaWRsZS4KICAgICAgICAgICoKICAgICAgICAgICogTm90aWNlIHRoYXQg
Y3B1bWFza190ZXN0X2NwdSgpIGlzIHF1aWNrZXIgdGhhbiBjcHVtYXNrX2VtcHR5KCksIHNvCkBA
IC04NjIsNyArODY2LDggQEAgX2NzY2hlZF9jcHVfcGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2YywgYm9vbF90IGNvbW1pdCkKICAgICBpZiAoIGNvbW1pdCAm
JiBzcGMgKQogICAgICAgIHNwYy0+aWRsZV9iaWFzID0gY3B1OwogCi0gICAgVFJBQ0VfM0QoVFJD
X0NTQ0hFRF9QSUNLRURfQ1BVLCB2Yy0+ZG9tYWluLT5kb21haW5faWQsIHZjLT52Y3B1X2lkLCBj
cHUpOworICAgIFRSQUNFXzNEKFRSQ19DU0NIRURfUElDS0VEX0NQVSwgaXRlbS0+ZG9tYWluLT5k
b21haW5faWQsIGl0ZW0tPml0ZW1faWQsCisgICAgICAgICAgICAgY3B1KTsKIAogICAgIHJldHVy
biBjcHU7CiB9CkBAIC04NzAsNyArODc1LDYgQEAgX2NzY2hlZF9jcHVfcGljayhjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YywgYm9vbF90IGNvbW1pdCkKIHN0YXRp
YyBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKgogY3NjaGVkX3Jlc19waWNrKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7Ci0gICAgc3RydWN0IHZj
cHUgKnZjID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnN2YyA9IENTQ0hF
RF9JVEVNKGl0ZW0pOwogCiAgICAgLyoKQEAgLTg4MCwyNiArODg0LDI2IEBAIGNzY2hlZF9yZXNf
cGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF9pdGVtICppdGVt
KQogICAgICAqIGNzY2hlZF9pdGVtX3dha2UoKSAoc3RpbGwgY2FsbGVkIGZyb20gdmNwdV9taWdy
YXRlKCkpIHdlIHdvbid0CiAgICAgICogZ2V0IGJvb3N0ZWQsIHdoaWNoIHdlIGRvbid0IGRlc2Vy
dmUgYXMgd2UgYXJlICJvbmx5IiBtaWdyYXRpbmcuCiAgICAgICovCi0gICAgc2V0X2JpdChDU0NI
RURfRkxBR19WQ1BVX01JR1JBVElORywgJnN2Yy0+ZmxhZ3MpOwotICAgIHJldHVybiBwZXJfY3B1
KHNjaGVkX3JlcywgX2NzY2hlZF9jcHVfcGljayhvcHMsIHZjLCAxKSk7CisgICAgc2V0X2JpdChD
U0NIRURfRkxBR19JVEVNX01JR1JBVElORywgJnN2Yy0+ZmxhZ3MpOworICAgIHJldHVybiBwZXJf
Y3B1KHNjaGVkX3JlcywgX2NzY2hlZF9jcHVfcGljayhvcHMsIGl0ZW0sIDEpKTsKIH0KIAogc3Rh
dGljIGlubGluZSB2b2lkCi1fX2NzY2hlZF92Y3B1X2FjY3Rfc3RhcnQoc3RydWN0IGNzY2hlZF9w
cml2YXRlICpwcnYsIHN0cnVjdCBjc2NoZWRfaXRlbSAqc3ZjKQorX19jc2NoZWRfaXRlbV9hY2N0
X3N0YXJ0KHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LCBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnN2
YykKIHsKICAgICBzdHJ1Y3QgY3NjaGVkX2RvbSAqIGNvbnN0IHNkb20gPSBzdmMtPnNkb207CiAg
ICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZwcnYtPmxv
Y2ssIGZsYWdzKTsKIAotICAgIGlmICggbGlzdF9lbXB0eSgmc3ZjLT5hY3RpdmVfdmNwdV9lbGVt
KSApCisgICAgaWYgKCBsaXN0X2VtcHR5KCZzdmMtPmFjdGl2ZV9pdGVtX2VsZW0pICkKICAgICB7
Ci0gICAgICAgIFNDSEVEX1ZDUFVfU1RBVF9DUkFOSyhzdmMsIHN0YXRlX2FjdGl2ZSk7CisgICAg
ICAgIFNDSEVEX0lURU1fU1RBVF9DUkFOSyhzdmMsIHN0YXRlX2FjdGl2ZSk7CiAgICAgICAgIFND
SEVEX1NUQVRfQ1JBTksoYWNjdF9pdGVtX2FjdGl2ZSk7CiAKLSAgICAgICAgc2RvbS0+YWN0aXZl
X3ZjcHVfY291bnQrKzsKLSAgICAgICAgbGlzdF9hZGQoJnN2Yy0+YWN0aXZlX3ZjcHVfZWxlbSwg
JnNkb20tPmFjdGl2ZV92Y3B1KTsKLSAgICAgICAgLyogTWFrZSB3ZWlnaHQgcGVyLXZjcHUgKi8K
KyAgICAgICAgc2RvbS0+YWN0aXZlX2l0ZW1fY291bnQrKzsKKyAgICAgICAgbGlzdF9hZGQoJnN2
Yy0+YWN0aXZlX2l0ZW1fZWxlbSwgJnNkb20tPmFjdGl2ZV9pdGVtKTsKKyAgICAgICAgLyogTWFr
ZSB3ZWlnaHQgcGVyLWl0ZW0gKi8KICAgICAgICAgcHJ2LT53ZWlnaHQgKz0gc2RvbS0+d2VpZ2h0
OwogICAgICAgICBpZiAoIGxpc3RfZW1wdHkoJnNkb20tPmFjdGl2ZV9zZG9tX2VsZW0pICkKICAg
ICAgICAgewpAQCAtOTA4LDU2ICs5MTIsNTYgQEAgX19jc2NoZWRfdmNwdV9hY2N0X3N0YXJ0KHN0
cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LCBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnN2YykKICAgICB9
CiAKICAgICBUUkFDRV8zRChUUkNfQ1NDSEVEX0FDQ09VTlRfU1RBUlQsIHNkb20tPmRvbS0+ZG9t
YWluX2lkLAotICAgICAgICAgICAgIHN2Yy0+dmNwdS0+dmNwdV9pZCwgc2RvbS0+YWN0aXZlX3Zj
cHVfY291bnQpOworICAgICAgICAgICAgIHN2Yy0+aXRlbS0+aXRlbV9pZCwgc2RvbS0+YWN0aXZl
X2l0ZW1fY291bnQpOwogCiAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcHJ2LT5sb2NrLCBm
bGFncyk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZAotX19jc2NoZWRfdmNwdV9hY2N0X3N0b3Bf
bG9ja2VkKHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LAorX19jc2NoZWRfaXRlbV9hY2N0X3N0
b3BfbG9ja2VkKHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LAogICAgIHN0cnVjdCBjc2NoZWRf
aXRlbSAqc3ZjKQogewogICAgIHN0cnVjdCBjc2NoZWRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+
c2RvbTsKIAotICAgIEJVR19PTiggbGlzdF9lbXB0eSgmc3ZjLT5hY3RpdmVfdmNwdV9lbGVtKSAp
OworICAgIEJVR19PTiggbGlzdF9lbXB0eSgmc3ZjLT5hY3RpdmVfaXRlbV9lbGVtKSApOwogCi0g
ICAgU0NIRURfVkNQVV9TVEFUX0NSQU5LKHN2Yywgc3RhdGVfaWRsZSk7CisgICAgU0NIRURfSVRF
TV9TVEFUX0NSQU5LKHN2Yywgc3RhdGVfaWRsZSk7CiAgICAgU0NIRURfU1RBVF9DUkFOSyhhY2N0
X2l0ZW1faWRsZSk7CiAKICAgICBCVUdfT04oIHBydi0+d2VpZ2h0IDwgc2RvbS0+d2VpZ2h0ICk7
Ci0gICAgc2RvbS0+YWN0aXZlX3ZjcHVfY291bnQtLTsKLSAgICBsaXN0X2RlbF9pbml0KCZzdmMt
PmFjdGl2ZV92Y3B1X2VsZW0pOworICAgIHNkb20tPmFjdGl2ZV9pdGVtX2NvdW50LS07CisgICAg
bGlzdF9kZWxfaW5pdCgmc3ZjLT5hY3RpdmVfaXRlbV9lbGVtKTsKICAgICBwcnYtPndlaWdodCAt
PSBzZG9tLT53ZWlnaHQ7Ci0gICAgaWYgKCBsaXN0X2VtcHR5KCZzZG9tLT5hY3RpdmVfdmNwdSkg
KQorICAgIGlmICggbGlzdF9lbXB0eSgmc2RvbS0+YWN0aXZlX2l0ZW0pICkKICAgICB7CiAgICAg
ICAgIGxpc3RfZGVsX2luaXQoJnNkb20tPmFjdGl2ZV9zZG9tX2VsZW0pOwogICAgIH0KIAogICAg
IFRSQUNFXzNEKFRSQ19DU0NIRURfQUNDT1VOVF9TVE9QLCBzZG9tLT5kb20tPmRvbWFpbl9pZCwK
LSAgICAgICAgICAgICBzdmMtPnZjcHUtPnZjcHVfaWQsIHNkb20tPmFjdGl2ZV92Y3B1X2NvdW50
KTsKKyAgICAgICAgICAgICBzdmMtPml0ZW0tPml0ZW1faWQsIHNkb20tPmFjdGl2ZV9pdGVtX2Nv
dW50KTsKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZF92Y3B1X2FjY3Qoc3RydWN0IGNzY2hlZF9w
cml2YXRlICpwcnYsIHVuc2lnbmVkIGludCBjcHUpCitjc2NoZWRfaXRlbV9hY2N0KHN0cnVjdCBj
c2NoZWRfcHJpdmF0ZSAqcHJ2LCB1bnNpZ25lZCBpbnQgY3B1KQogewogICAgIHN0cnVjdCBzY2hl
ZF9pdGVtICpjdXJyaXRlbSA9IGN1cnJlbnQtPnNjaGVkX2l0ZW07CiAgICAgc3RydWN0IGNzY2hl
ZF9pdGVtICogY29uc3Qgc3ZjID0gQ1NDSEVEX0lURU0oY3Vycml0ZW0pOwogICAgIGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcyA9IHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpOwogCi0gICAgQVNT
RVJUKCBjdXJyZW50LT5wcm9jZXNzb3IgPT0gY3B1ICk7CisgICAgQVNTRVJUKCBzY2hlZF9pdGVt
X2NwdShjdXJyaXRlbSkgPT0gY3B1ICk7CiAgICAgQVNTRVJUKCBzdmMtPnNkb20gIT0gTlVMTCAp
OwotICAgIEFTU0VSVCggIWlzX2lkbGVfdmNwdShzdmMtPnZjcHUpICk7CisgICAgQVNTRVJUKCAh
aXNfaWRsZV9pdGVtKHN2Yy0+aXRlbSkgKTsKIAogICAgIC8qCi0gICAgICogSWYgdGhpcyBWQ1BV
J3MgcHJpb3JpdHkgd2FzIGJvb3N0ZWQgd2hlbiBpdCBsYXN0IGF3b2tlLCByZXNldCBpdC4KLSAg
ICAgKiBJZiB0aGUgVkNQVSBpcyBmb3VuZCBoZXJlLCB0aGVuIGl0J3MgY29uc3VtaW5nIGEgbm9u
LW5lZ2xpZ2VhYmxlCisgICAgICogSWYgdGhpcyBJVEVNJ3MgcHJpb3JpdHkgd2FzIGJvb3N0ZWQg
d2hlbiBpdCBsYXN0IGF3b2tlLCByZXNldCBpdC4KKyAgICAgKiBJZiB0aGUgSVRFTSBpcyBmb3Vu
ZCBoZXJlLCB0aGVuIGl0J3MgY29uc3VtaW5nIGEgbm9uLW5lZ2xpZ2VhYmxlCiAgICAgICogYW1v
dW50IG9mIENQVSByZXNvdXJjZXMgYW5kIHNob3VsZCBubyBsb25nZXIgYmUgYm9vc3RlZC4KICAg
ICAgKi8KICAgICBpZiAoIHN2Yy0+cHJpID09IENTQ0hFRF9QUklfVFNfQk9PU1QgKQogICAgIHsK
ICAgICAgICAgc3ZjLT5wcmkgPSBDU0NIRURfUFJJX1RTX1VOREVSOwogICAgICAgICBUUkFDRV8y
RChUUkNfQ1NDSEVEX0JPT1NUX0VORCwgc3ZjLT5zZG9tLT5kb20tPmRvbWFpbl9pZCwKLSAgICAg
ICAgICAgICAgICAgc3ZjLT52Y3B1LT52Y3B1X2lkKTsKKyAgICAgICAgICAgICAgICAgc3ZjLT5p
dGVtLT5pdGVtX2lkKTsKICAgICB9CiAKICAgICAvKgpAQCAtOTY2LDEyICs5NzAsMTIgQEAgY3Nj
aGVkX3ZjcHVfYWNjdChzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwgdW5zaWduZWQgaW50IGNw
dSkKICAgICBidXJuX2NyZWRpdHMoc3ZjLCBOT1coKSk7CiAKICAgICAvKgotICAgICAqIFB1dCB0
aGlzIFZDUFUgYW5kIGRvbWFpbiBiYWNrIG9uIHRoZSBhY3RpdmUgbGlzdCBpZiBpdCB3YXMKKyAg
ICAgKiBQdXQgdGhpcyBJVEVNIGFuZCBkb21haW4gYmFjayBvbiB0aGUgYWN0aXZlIGxpc3QgaWYg
aXQgd2FzCiAgICAgICogaWRsaW5nLgogICAgICAqLwotICAgIGlmICggbGlzdF9lbXB0eSgmc3Zj
LT5hY3RpdmVfdmNwdV9lbGVtKSApCisgICAgaWYgKCBsaXN0X2VtcHR5KCZzdmMtPmFjdGl2ZV9p
dGVtX2VsZW0pICkKICAgICB7Ci0gICAgICAgIF9fY3NjaGVkX3ZjcHVfYWNjdF9zdGFydChwcnYs
IHN2Yyk7CisgICAgICAgIF9fY3NjaGVkX2l0ZW1fYWNjdF9zdGFydChwcnYsIHN2Yyk7CiAgICAg
fQogICAgIGVsc2UKICAgICB7CkBAIC05ODQsMTUgKzk4OCwxNSBAQCBjc2NoZWRfdmNwdV9hY2N0
KHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LCB1bnNpZ25lZCBpbnQgY3B1KQogICAgICAgICAg
KiBtaWdyYXRpbmcgaXQgdG8gcnVuIGVsc2V3aGVyZSAoc2VlIG11bHRpLWNvcmUgYW5kIG11bHRp
LXRocmVhZAogICAgICAgICAgKiBzdXBwb3J0IGluIGNzY2hlZF9yZXNfcGljaygpKS4KICAgICAg
ICAgICovCi0gICAgICAgIG5ld19jcHUgPSBfY3NjaGVkX2NwdV9waWNrKG9wcywgY3VycmVudCwg
MCk7CisgICAgICAgIG5ld19jcHUgPSBfY3NjaGVkX2NwdV9waWNrKG9wcywgY3Vycml0ZW0sIDAp
OwogCiAgICAgICAgIGl0ZW1fc2NoZWR1bGVfdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3Ms
IGN1cnJpdGVtKTsKIAogICAgICAgICBpZiAoIG5ld19jcHUgIT0gY3B1ICkKICAgICAgICAgewot
ICAgICAgICAgICAgU0NIRURfVkNQVV9TVEFUX0NSQU5LKHN2YywgbWlncmF0ZV9yKTsKKyAgICAg
ICAgICAgIFNDSEVEX0lURU1fU1RBVF9DUkFOSyhzdmMsIG1pZ3JhdGVfcik7CiAgICAgICAgICAg
ICBTQ0hFRF9TVEFUX0NSQU5LKG1pZ3JhdGVfcnVubmluZyk7Ci0gICAgICAgICAgICBzZXRfYml0
KF9WUEZfbWlncmF0aW5nLCAmY3VycmVudC0+cGF1c2VfZmxhZ3MpOworICAgICAgICAgICAgc2No
ZWRfc2V0X3BhdXNlX2ZsYWdzX2F0b21pYyhjdXJyaXRlbSwgX1ZQRl9taWdyYXRpbmcpOwogICAg
ICAgICAgICAgLyoKICAgICAgICAgICAgICAqIEFzIHdlIGFyZSBhYm91dCB0byB0aWNrbGUgY3B1
LCB3ZSBzaG91bGQgY2xlYXIgaXRzIGJpdCBpbgogICAgICAgICAgICAgICogaWRsZXJzLiBCdXQs
IGlmIHdlIGFyZSBoZXJlLCBpdCBtZWFucyB0aGVyZSBpcyBzb21lb25lIHJ1bm5pbmcKQEAgLTEw
MDksMjEgKzEwMTMsMjAgQEAgc3RhdGljIHZvaWQgKgogY3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0sCiAgICAgICAg
ICAgICAgICAgICAgdm9pZCAqZGQpCiB7Ci0gICAgc3RydWN0IHZjcHUgKnZjID0gaXRlbS0+dmNw
dTsKICAgICBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnN2YzsKIAotICAgIC8qIEFsbG9jYXRlIHBlci1W
Q1BVIGluZm8gKi8KKyAgICAvKiBBbGxvY2F0ZSBwZXItSVRFTSBpbmZvICovCiAgICAgc3ZjID0g
eHphbGxvYyhzdHJ1Y3QgY3NjaGVkX2l0ZW0pOwogICAgIGlmICggc3ZjID09IE5VTEwgKQogICAg
ICAgICByZXR1cm4gTlVMTDsKIAogICAgIElOSVRfTElTVF9IRUFEKCZzdmMtPnJ1bnFfZWxlbSk7
Ci0gICAgSU5JVF9MSVNUX0hFQUQoJnN2Yy0+YWN0aXZlX3ZjcHVfZWxlbSk7CisgICAgSU5JVF9M
SVNUX0hFQUQoJnN2Yy0+YWN0aXZlX2l0ZW1fZWxlbSk7CiAgICAgc3ZjLT5zZG9tID0gZGQ7Ci0g
ICAgc3ZjLT52Y3B1ID0gdmM7Ci0gICAgc3ZjLT5wcmkgPSBpc19pZGxlX2RvbWFpbih2Yy0+ZG9t
YWluKSA/CisgICAgc3ZjLT5pdGVtID0gaXRlbTsKKyAgICBzdmMtPnByaSA9IGlzX2lkbGVfaXRl
bShpdGVtKSA/CiAgICAgICAgIENTQ0hFRF9QUklfSURMRSA6IENTQ0hFRF9QUklfVFNfVU5ERVI7
Ci0gICAgU0NIRURfVkNQVV9TVEFUU19SRVNFVChzdmMpOworICAgIFNDSEVEX0lURU1fU1RBVFNf
UkVTRVQoc3ZjKTsKICAgICBTQ0hFRF9TVEFUX0NSQU5LKGl0ZW1fYWxsb2MpOwogICAgIHJldHVy
biBzdmM7CiB9CkBAIC0xMDMxLDI0ICsxMDM0LDIxIEBAIGNzY2hlZF9hbGxvY192ZGF0YShjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtLAogc3RhdGlj
IHZvaWQKIGNzY2hlZF9pdGVtX2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCBzY2hlZF9pdGVtICppdGVtKQogewotICAgIHN0cnVjdCB2Y3B1ICp2YyA9IGl0ZW0tPnZj
cHU7CiAgICAgc3RydWN0IGNzY2hlZF9pdGVtICpzdmMgPSBpdGVtLT5wcml2OwogICAgIHNwaW5s
b2NrX3QgKmxvY2s7CiAKLSAgICBCVUdfT04oIGlzX2lkbGVfdmNwdSh2YykgKTsKKyAgICBCVUdf
T04oIGlzX2lkbGVfaXRlbShpdGVtKSApOwogCiAgICAgLyogY3NjaGVkX3Jlc19waWNrKCkgbG9v
a3MgaW4gdmMtPnByb2Nlc3NvcidzIHJ1bnEsIHNvIHdlIG5lZWQgdGhlIGxvY2suICovCiAgICAg
bG9jayA9IGl0ZW1fc2NoZWR1bGVfbG9ja19pcnEoaXRlbSk7CiAKLSAgICBpdGVtLT5yZXMgPSBj
c2NoZWRfcmVzX3BpY2sob3BzLCBpdGVtKTsKLSAgICB2Yy0+cHJvY2Vzc29yID0gaXRlbS0+cmVz
LT5wcm9jZXNzb3I7CisgICAgc2NoZWRfc2V0X3JlcyhpdGVtLCBjc2NoZWRfcmVzX3BpY2sob3Bz
LCBpdGVtKSk7CiAKICAgICBzcGluX3VubG9ja19pcnEobG9jayk7CiAKICAgICBsb2NrID0gaXRl
bV9zY2hlZHVsZV9sb2NrX2lycShpdGVtKTsKIAotICAgIGlmICggIV9fdmNwdV9vbl9ydW5xKHN2
YykgJiYgdmNwdV9ydW5uYWJsZSh2YykgJiYKLSAgICAgICAgICF2Yy0+c2NoZWRfaXRlbS0+aXNf
cnVubmluZyApCisgICAgaWYgKCAhX19pdGVtX29uX3J1bnEoc3ZjKSAmJiBpdGVtX3J1bm5hYmxl
KGl0ZW0pICYmICFpdGVtLT5pc19ydW5uaW5nICkKICAgICAgICAgcnVucV9pbnNlcnQoc3ZjKTsK
IAogICAgIGl0ZW1fc2NoZWR1bGVfdW5sb2NrX2lycShsb2NrLCBpdGVtKTsKQEAgLTEwNzUsMTgg
KzEwNzUsMTggQEAgY3NjaGVkX2l0ZW1fcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiAKICAgICBTQ0hFRF9TVEFUX0NSQU5LKGl0ZW1f
cmVtb3ZlKTsKIAotICAgIEFTU0VSVCghX192Y3B1X29uX3J1bnEoc3ZjKSk7CisgICAgQVNTRVJU
KCFfX2l0ZW1fb25fcnVucShzdmMpKTsKIAotICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KENT
Q0hFRF9GTEFHX1ZDUFVfUEFSS0VELCAmc3ZjLT5mbGFncykgKQorICAgIGlmICggdGVzdF9hbmRf
Y2xlYXJfYml0KENTQ0hFRF9GTEFHX0lURU1fUEFSS0VELCAmc3ZjLT5mbGFncykgKQogICAgIHsK
ICAgICAgICAgU0NIRURfU1RBVF9DUkFOSyhpdGVtX3VucGFyayk7Ci0gICAgICAgIHZjcHVfdW5w
YXVzZShzdmMtPnZjcHUpOworICAgICAgICB2Y3B1X3VucGF1c2Uoc3ZjLT5pdGVtLT52Y3B1KTsK
ICAgICB9CiAKICAgICBzcGluX2xvY2tfaXJxKCZwcnYtPmxvY2spOwogCi0gICAgaWYgKCAhbGlz
dF9lbXB0eSgmc3ZjLT5hY3RpdmVfdmNwdV9lbGVtKSApCi0gICAgICAgIF9fY3NjaGVkX3ZjcHVf
YWNjdF9zdG9wX2xvY2tlZChwcnYsIHN2Yyk7CisgICAgaWYgKCAhbGlzdF9lbXB0eSgmc3ZjLT5h
Y3RpdmVfaXRlbV9lbGVtKSApCisgICAgICAgIF9fY3NjaGVkX2l0ZW1fYWNjdF9zdG9wX2xvY2tl
ZChwcnYsIHN2Yyk7CiAKICAgICBzcGluX3VubG9ja19pcnEoJnBydi0+bG9jayk7CiAKQEAgLTEw
OTYsODYgKzEwOTYsODUgQEAgY3NjaGVkX2l0ZW1fcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiBzdGF0aWMgdm9pZAogY3NjaGVkX2l0
ZW1fc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAq
aXRlbSkKIHsKLSAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBj
c2NoZWRfaXRlbSAqIGNvbnN0IHN2YyA9IENTQ0hFRF9JVEVNKGl0ZW0pOwotICAgIHVuc2lnbmVk
IGludCBjcHUgPSB2Yy0+cHJvY2Vzc29yOworICAgIHVuc2lnbmVkIGludCBjcHUgPSBzY2hlZF9p
dGVtX2NwdShpdGVtKTsKIAogICAgIFNDSEVEX1NUQVRfQ1JBTksoaXRlbV9zbGVlcCk7CiAKLSAg
ICBCVUdfT04oIGlzX2lkbGVfdmNwdSh2YykgKTsKKyAgICBCVUdfT04oIGlzX2lkbGVfaXRlbShp
dGVtKSApOwogCiAgICAgaWYgKCBjdXJyX29uX2NwdShjcHUpID09IGl0ZW0gKQogICAgIHsKICAg
ICAgICAgLyoKICAgICAgICAgICogV2UgYXJlIGFib3V0IHRvIHRpY2tsZSBjcHUsIHNvIHdlIHNo
b3VsZCBjbGVhciBpdHMgYml0IGluIGlkbGVycy4KLSAgICAgICAgICogQnV0LCB3ZSBhcmUgaGVy
ZSBiZWNhdXNlIHZjIGlzIGdvaW5nIHRvIHNsZWVwIHdoaWxlIHJ1bm5pbmcgb24gY3B1LAorICAg
ICAgICAgKiBCdXQsIHdlIGFyZSBoZXJlIGJlY2F1c2UgaXRlbSBpcyBnb2luZyB0byBzbGVlcCB3
aGlsZSBydW5uaW5nIG9uIGNwdSwKICAgICAgICAgICogc28gdGhlIGJpdCBtdXN0IGJlIHplcm8g
YWxyZWFkeS4KICAgICAgICAgICovCiAgICAgICAgIEFTU0VSVCghY3B1bWFza190ZXN0X2NwdShj
cHUsIENTQ0hFRF9QUklWKHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpKS0+aWRsZXJzKSk7CiAgICAg
ICAgIGNwdV9yYWlzZV9zb2Z0aXJxKGNwdSwgU0NIRURVTEVfU09GVElSUSk7CiAgICAgfQotICAg
IGVsc2UgaWYgKCBfX3ZjcHVfb25fcnVucShzdmMpICkKKyAgICBlbHNlIGlmICggX19pdGVtX29u
X3J1bnEoc3ZjKSApCiAgICAgICAgIHJ1bnFfcmVtb3ZlKHN2Yyk7CiB9CiAKIHN0YXRpYyB2b2lk
CiBjc2NoZWRfaXRlbV93YWtlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNj
aGVkX2l0ZW0gKml0ZW0pCiB7Ci0gICAgc3RydWN0IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsKICAg
ICBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKiBjb25zdCBzdmMgPSBDU0NIRURfSVRFTShpdGVtKTsKICAg
ICBib29sX3QgbWlncmF0aW5nOwogCi0gICAgQlVHX09OKCBpc19pZGxlX3ZjcHUodmMpICk7Cisg
ICAgQlVHX09OKCBpc19pZGxlX2l0ZW0oaXRlbSkgKTsKIAotICAgIGlmICggdW5saWtlbHkoY3Vy
cl9vbl9jcHUodmMtPnByb2Nlc3NvcikgPT0gaXRlbSkgKQorICAgIGlmICggdW5saWtlbHkoY3Vy
cl9vbl9jcHUoc2NoZWRfaXRlbV9jcHUoaXRlbSkpID09IGl0ZW0pICkKICAgICB7CiAgICAgICAg
IFNDSEVEX1NUQVRfQ1JBTksoaXRlbV93YWtlX3J1bm5pbmcpOwogICAgICAgICByZXR1cm47CiAg
ICAgfQotICAgIGlmICggdW5saWtlbHkoX192Y3B1X29uX3J1bnEoc3ZjKSkgKQorICAgIGlmICgg
dW5saWtlbHkoX19pdGVtX29uX3J1bnEoc3ZjKSkgKQogICAgIHsKICAgICAgICAgU0NIRURfU1RB
VF9DUkFOSyhpdGVtX3dha2Vfb25ydW5xKTsKICAgICAgICAgcmV0dXJuOwogICAgIH0KIAotICAg
IGlmICggbGlrZWx5KHZjcHVfcnVubmFibGUodmMpKSApCisgICAgaWYgKCBsaWtlbHkoaXRlbV9y
dW5uYWJsZShpdGVtKSkgKQogICAgICAgICBTQ0hFRF9TVEFUX0NSQU5LKGl0ZW1fd2FrZV9ydW5u
YWJsZSk7CiAgICAgZWxzZQogICAgICAgICBTQ0hFRF9TVEFUX0NSQU5LKGl0ZW1fd2FrZV9ub3Rf
cnVubmFibGUpOwogCiAgICAgLyoKLSAgICAgKiBXZSB0ZW1wb3Jhcmx5IGJvb3N0IHRoZSBwcmlv
cml0eSBvZiBhd2FraW5nIFZDUFVzIQorICAgICAqIFdlIHRlbXBvcmFyaWx5IGJvb3N0IHRoZSBw
cmlvcml0eSBvZiBhd2FraW5nIElURU1zIQogICAgICAqCi0gICAgICogSWYgdGhpcyBWQ1BVIGNv
bnN1bWVzIGEgbm9uIG5lZ2xpZ2VhYmxlIGFtb3VudCBvZiBDUFUsIGl0CisgICAgICogSWYgdGhp
cyBJVEVNIGNvbnN1bWVzIGEgbm9uIG5lZ2xpZ2libGUgYW1vdW50IG9mIENQVSwgaXQKICAgICAg
KiB3aWxsIGV2ZW50dWFsbHkgZmluZCBpdHNlbGYgaW4gdGhlIGNyZWRpdCBhY2NvdW50aW5nIGNv
ZGUKICAgICAgKiBwYXRoIHdoZXJlIGl0cyBwcmlvcml0eSB3aWxsIGJlIHJlc2V0IHRvIG5vcm1h
bC4KICAgICAgKgotICAgICAqIElmIG9uIHRoZSBvdGhlciBoYW5kIHRoZSBWQ1BVIGNvbnN1bWVz
IGxpdHRsZSBDUFUgYW5kIGlzCisgICAgICogSWYgb24gdGhlIG90aGVyIGhhbmQgdGhlIElURU0g
Y29uc3VtZXMgbGl0dGxlIENQVSBhbmQgaXMKICAgICAgKiBibG9ja2luZyBhbmQgYXdva2VuIGEg
bG90IChkb2luZyBJL08gZm9yIGV4YW1wbGUpLCBpdHMKICAgICAgKiBwcmlvcml0eSB3aWxsIHJl
bWFpbiBib29zdGVkLCBvcHRpbWl6aW5nIGl0J3Mgd2FrZS10by1ydW4KICAgICAgKiBsYXRlbmNp
ZXMuCiAgICAgICoKLSAgICAgKiBUaGlzIGFsbG93cyB3YWtlLXRvLXJ1biBsYXRlbmN5IHNlbnNp
dGl2ZSBWQ1BVcyB0byBwcmVlbXB0Ci0gICAgICogbW9yZSBDUFUgcmVzb3VyY2UgaW50ZW5zaXZl
IFZDUFVzIHdpdGhvdXQgaW1wYWN0aW5nIG92ZXJhbGwgCisgICAgICogVGhpcyBhbGxvd3Mgd2Fr
ZS10by1ydW4gbGF0ZW5jeSBzZW5zaXRpdmUgSVRFTXMgdG8gcHJlZW1wdAorICAgICAqIG1vcmUg
Q1BVIHJlc291cmNlIGludGVuc2l2ZSBJVEVNcyB3aXRob3V0IGltcGFjdGluZyBvdmVyYWxsCiAg
ICAgICogc3lzdGVtIGZhaXJuZXNzLgogICAgICAqCiAgICAgICogVGhlcmUgYXJlIHR3byBjYXNl
cywgd2hlbiB3ZSBkb24ndCB3YW50IHRvIGJvb3N0OgotICAgICAqICAtIFZDUFVzIHRoYXQgYXJl
IHdha2luZyB1cCBhZnRlciBhIG1pZ3JhdGlvbiwgcmF0aGVyIHRoYW4KKyAgICAgKiAgLSBJVEVN
cyB0aGF0IGFyZSB3YWtpbmcgdXAgYWZ0ZXIgYSBtaWdyYXRpb24sIHJhdGhlciB0aGFuCiAgICAg
ICogICAgYWZ0ZXIgaGF2aW5nIGJsb2NrOwotICAgICAqICAtIFZDUFVzIG9mIGNhcHBlZCBkb21h
aW5zIHVucGF1c2luZyBhZnRlciBlYXJuaW5nIGNyZWRpdHMKKyAgICAgKiAgLSBJVEVNcyBvZiBj
YXBwZWQgZG9tYWlucyB1bnBhdXNpbmcgYWZ0ZXIgZWFybmluZyBjcmVkaXRzCiAgICAgICogICAg
dGhleSBoYWQgb3ZlcnNwZW50LgogICAgICAqLwotICAgIG1pZ3JhdGluZyA9IHRlc3RfYW5kX2Ns
ZWFyX2JpdChDU0NIRURfRkxBR19WQ1BVX01JR1JBVElORywgJnN2Yy0+ZmxhZ3MpOworICAgIG1p
Z3JhdGluZyA9IHRlc3RfYW5kX2NsZWFyX2JpdChDU0NIRURfRkxBR19JVEVNX01JR1JBVElORywg
JnN2Yy0+ZmxhZ3MpOwogCiAgICAgaWYgKCAhbWlncmF0aW5nICYmIHN2Yy0+cHJpID09IENTQ0hF
RF9QUklfVFNfVU5ERVIgJiYKLSAgICAgICAgICF0ZXN0X2JpdChDU0NIRURfRkxBR19WQ1BVX1BB
UktFRCwgJnN2Yy0+ZmxhZ3MpICkKKyAgICAgICAgICF0ZXN0X2JpdChDU0NIRURfRkxBR19JVEVN
X1BBUktFRCwgJnN2Yy0+ZmxhZ3MpICkKICAgICB7Ci0gICAgICAgIFRSQUNFXzJEKFRSQ19DU0NI
RURfQk9PU1RfU1RBUlQsIHZjLT5kb21haW4tPmRvbWFpbl9pZCwgdmMtPnZjcHVfaWQpOworICAg
ICAgICBUUkFDRV8yRChUUkNfQ1NDSEVEX0JPT1NUX1NUQVJULCBpdGVtLT5kb21haW4tPmRvbWFp
bl9pZCwKKyAgICAgICAgICAgICAgICAgaXRlbS0+aXRlbV9pZCk7CiAgICAgICAgIFNDSEVEX1NU
QVRfQ1JBTksoaXRlbV9ib29zdCk7CiAgICAgICAgIHN2Yy0+cHJpID0gQ1NDSEVEX1BSSV9UU19C
T09TVDsKICAgICB9CiAKLSAgICAvKiBQdXQgdGhlIFZDUFUgb24gdGhlIHJ1bnEgYW5kIHRpY2ts
ZSBDUFVzICovCisgICAgLyogUHV0IHRoZSBJVEVNIG9uIHRoZSBydW5xIGFuZCB0aWNrbGUgQ1BV
cyAqLwogICAgIHJ1bnFfaW5zZXJ0KHN2Yyk7CiAgICAgX19ydW5xX3RpY2tsZShzdmMpOwogfQpA
QCAtMTE4Niw3ICsxMTg1LDcgQEAgY3NjaGVkX2l0ZW1feWllbGQoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKICAgICBzdHJ1Y3QgY3NjaGVkX2l0
ZW0gKiBjb25zdCBzdmMgPSBDU0NIRURfSVRFTShpdGVtKTsKIAogICAgIC8qIExldCB0aGUgc2No
ZWR1bGVyIGtub3cgdGhhdCB0aGlzIHZjcHUgaXMgdHJ5aW5nIHRvIHlpZWxkICovCi0gICAgc2V0
X2JpdChDU0NIRURfRkxBR19WQ1BVX1lJRUxELCAmc3ZjLT5mbGFncyk7CisgICAgc2V0X2JpdChD
U0NIRURfRkxBR19JVEVNX1lJRUxELCAmc3ZjLT5mbGFncyk7CiB9CiAKIHN0YXRpYyBpbnQKQEAg
LTEyMTUsOCArMTIxNCw4IEBAIGNzY2hlZF9kb21fY250bCgKICAgICAgICAgewogICAgICAgICAg
ICAgaWYgKCAhbGlzdF9lbXB0eSgmc2RvbS0+YWN0aXZlX3Nkb21fZWxlbSkgKQogICAgICAgICAg
ICAgewotICAgICAgICAgICAgICAgIHBydi0+d2VpZ2h0IC09IHNkb20tPndlaWdodCAqIHNkb20t
PmFjdGl2ZV92Y3B1X2NvdW50OwotICAgICAgICAgICAgICAgIHBydi0+d2VpZ2h0ICs9IG9wLT51
LmNyZWRpdC53ZWlnaHQgKiBzZG9tLT5hY3RpdmVfdmNwdV9jb3VudDsKKyAgICAgICAgICAgICAg
ICBwcnYtPndlaWdodCAtPSBzZG9tLT53ZWlnaHQgKiBzZG9tLT5hY3RpdmVfaXRlbV9jb3VudDsK
KyAgICAgICAgICAgICAgICBwcnYtPndlaWdodCArPSBvcC0+dS5jcmVkaXQud2VpZ2h0ICogc2Rv
bS0+YWN0aXZlX2l0ZW1fY291bnQ7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBzZG9tLT53
ZWlnaHQgPSBvcC0+dS5jcmVkaXQud2VpZ2h0OwogICAgICAgICB9CkBAIC0xMjQ1LDkgKzEyNDQs
OSBAQCBjc2NoZWRfYWZmX2NudGwoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qg
c2NoZWRfaXRlbSAqaXRlbSwKIAogICAgIC8qIEFyZSB3ZSBiZWNvbWluZyBleGNsdXNpdmVseSBw
aW5uZWQ/ICovCiAgICAgaWYgKCBjcHVtYXNrX3dlaWdodChoYXJkKSA9PSAxICkKLSAgICAgICAg
c2V0X2JpdChDU0NIRURfRkxBR19WQ1BVX1BJTk5FRCwgJnN2Yy0+ZmxhZ3MpOworICAgICAgICBz
ZXRfYml0KENTQ0hFRF9GTEFHX0lURU1fUElOTkVELCAmc3ZjLT5mbGFncyk7CiAgICAgZWxzZQot
ICAgICAgICBjbGVhcl9iaXQoQ1NDSEVEX0ZMQUdfVkNQVV9QSU5ORUQsICZzdmMtPmZsYWdzKTsK
KyAgICAgICAgY2xlYXJfYml0KENTQ0hFRF9GTEFHX0lURU1fUElOTkVELCAmc3ZjLT5mbGFncyk7
CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZApAQCAtMTI5MCwxNCArMTI4OSwxNCBAQCBjc2NoZWRf
c3lzX2NudGwoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAogICAgICAgICBlbHNlIGlmICgg
cHJ2LT5yYXRlbGltaXQgJiYgIXBhcmFtcy0+cmF0ZWxpbWl0X3VzICkKICAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfSU5GTyAiRGlzYWJsaW5nIGNvbnRleHQgc3dpdGNoIHJhdGUgbGltaXRpbmdc
biIpOwogICAgICAgICBwcnYtPnJhdGVsaW1pdCA9IE1JQ1JPU0VDUyhwYXJhbXMtPnJhdGVsaW1p
dF91cyk7Ci0gICAgICAgIHBydi0+dmNwdV9taWdyX2RlbGF5ID0gTUlDUk9TRUNTKHBhcmFtcy0+
dmNwdV9taWdyX2RlbGF5X3VzKTsKKyAgICAgICAgcHJ2LT5pdGVtX21pZ3JfZGVsYXkgPSBNSUNS
T1NFQ1MocGFyYW1zLT52Y3B1X21pZ3JfZGVsYXlfdXMpOwogICAgICAgICBzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZwcnYtPmxvY2ssIGZsYWdzKTsKIAogICAgICAgICAvKiBGQUxMVEhSVSAqLwog
ICAgIGNhc2UgWEVOX1NZU0NUTF9TQ0hFRE9QX2dldGluZm86CiAgICAgICAgIHBhcmFtcy0+dHNs
aWNlX21zID0gcHJ2LT50c2xpY2UgLyBNSUxMSVNFQ1MoMSk7CiAgICAgICAgIHBhcmFtcy0+cmF0
ZWxpbWl0X3VzID0gcHJ2LT5yYXRlbGltaXQgLyBNSUNST1NFQ1MoMSk7Ci0gICAgICAgIHBhcmFt
cy0+dmNwdV9taWdyX2RlbGF5X3VzID0gcHJ2LT52Y3B1X21pZ3JfZGVsYXkgLyBNSUNST1NFQ1Mo
MSk7CisgICAgICAgIHBhcmFtcy0+dmNwdV9taWdyX2RlbGF5X3VzID0gcHJ2LT5pdGVtX21pZ3Jf
ZGVsYXkgLyBNSUNST1NFQ1MoMSk7CiAgICAgICAgIHJjID0gMDsKICAgICAgICAgYnJlYWs7CiAg
ICAgfQpAQCAtMTMxNSw3ICsxMzE0LDcgQEAgY3NjaGVkX2FsbG9jX2RvbWRhdGEoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgZG9tYWluICpkb20pCiAgICAgICAgIHJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOwogCiAgICAgLyogSW5pdGlhbGl6ZSBjcmVkaXQgYW5kIHdlaWdodCAq
LwotICAgIElOSVRfTElTVF9IRUFEKCZzZG9tLT5hY3RpdmVfdmNwdSk7CisgICAgSU5JVF9MSVNU
X0hFQUQoJnNkb20tPmFjdGl2ZV9pdGVtKTsKICAgICBJTklUX0xJU1RfSEVBRCgmc2RvbS0+YWN0
aXZlX3Nkb21fZWxlbSk7CiAgICAgc2RvbS0+ZG9tID0gZG9tOwogICAgIHNkb20tPndlaWdodCA9
IENTQ0hFRF9ERUZBVUxUX1dFSUdIVDsKQEAgLTEzMzIsNyArMTMzMSw3IEBAIGNzY2hlZF9mcmVl
X2RvbWRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpkYXRhKQogLyoKICAq
IFRoaXMgaXMgYSBPKG4pIG9wdGltaXplZCBzb3J0IG9mIHRoZSBydW5xLgogICoKLSAqIFRpbWUt
c2hhcmUgVkNQVXMgY2FuIG9ubHkgYmUgb25lIG9mIHR3byBwcmlvcml0aWVzLCBVTkRFUiBvciBP
VkVSLiBXZSB3YWxrCisgKiBUaW1lLXNoYXJlIElURU1zIGNhbiBvbmx5IGJlIG9uZSBvZiB0d28g
cHJpb3JpdGllcywgVU5ERVIgb3IgT1ZFUi4gV2Ugd2FsawogICogdGhyb3VnaCB0aGUgcnVucSBh
bmQgbW92ZSB1cCBhbnkgVU5ERVJzIHRoYXQgYXJlIHByZWNlZGVkIGJ5IE9WRVJTLiBXZQogICog
cmVtZW1iZXIgdGhlIGxhc3QgVU5ERVIgdG8gbWFrZSB0aGUgbW92ZSB1cCBvcGVyYXRpb24gTygx
KS4KICAqLwpAQCAtMTM4NSw3ICsxMzg0LDcgQEAgY3NjaGVkX2FjY3Qodm9pZCogZHVtbXkpCiB7
CiAgICAgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYgPSBkdW1teTsKICAgICB1bnNpZ25lZCBs
b25nIGZsYWdzOwotICAgIHN0cnVjdCBsaXN0X2hlYWQgKml0ZXJfdmNwdSwgKm5leHRfdmNwdTsK
KyAgICBzdHJ1Y3QgbGlzdF9oZWFkICppdGVyX2l0ZW0sICpuZXh0X2l0ZW07CiAgICAgc3RydWN0
IGxpc3RfaGVhZCAqaXRlcl9zZG9tLCAqbmV4dF9zZG9tOwogICAgIHN0cnVjdCBjc2NoZWRfaXRl
bSAqc3ZjOwogICAgIHN0cnVjdCBjc2NoZWRfZG9tICpzZG9tOwpAQCAtMTQzMiwyNiArMTQzMSwy
NiBAQCBjc2NoZWRfYWNjdCh2b2lkKiBkdW1teSkKICAgICAgICAgc2RvbSA9IGxpc3RfZW50cnko
aXRlcl9zZG9tLCBzdHJ1Y3QgY3NjaGVkX2RvbSwgYWN0aXZlX3Nkb21fZWxlbSk7CiAKICAgICAg
ICAgQlVHX09OKCBpc19pZGxlX2RvbWFpbihzZG9tLT5kb20pICk7Ci0gICAgICAgIEJVR19PTigg
c2RvbS0+YWN0aXZlX3ZjcHVfY291bnQgPT0gMCApOworICAgICAgICBCVUdfT04oIHNkb20tPmFj
dGl2ZV9pdGVtX2NvdW50ID09IDAgKTsKICAgICAgICAgQlVHX09OKCBzZG9tLT53ZWlnaHQgPT0g
MCApOwotICAgICAgICBCVUdfT04oIChzZG9tLT53ZWlnaHQgKiBzZG9tLT5hY3RpdmVfdmNwdV9j
b3VudCkgPiB3ZWlnaHRfbGVmdCApOworICAgICAgICBCVUdfT04oIChzZG9tLT53ZWlnaHQgKiBz
ZG9tLT5hY3RpdmVfaXRlbV9jb3VudCkgPiB3ZWlnaHRfbGVmdCApOwogCi0gICAgICAgIHdlaWdo
dF9sZWZ0IC09ICggc2RvbS0+d2VpZ2h0ICogc2RvbS0+YWN0aXZlX3ZjcHVfY291bnQgKTsKKyAg
ICAgICAgd2VpZ2h0X2xlZnQgLT0gKCBzZG9tLT53ZWlnaHQgKiBzZG9tLT5hY3RpdmVfaXRlbV9j
b3VudCApOwogCiAgICAgICAgIC8qCiAgICAgICAgICAqIEEgZG9tYWluJ3MgZmFpciBzaGFyZSBp
cyBjb21wdXRlZCB1c2luZyBpdHMgd2VpZ2h0IGluIGNvbXBldGl0aW9uCiAgICAgICAgICAqIHdp
dGggdGhhdCBvZiBhbGwgb3RoZXIgYWN0aXZlIGRvbWFpbnMuCiAgICAgICAgICAqCi0gICAgICAg
ICAqIEF0IG1vc3QsIGEgZG9tYWluIGNhbiB1c2UgY3JlZGl0cyB0byBydW4gYWxsIGl0cyBhY3Rp
dmUgVkNQVXMKKyAgICAgICAgICogQXQgbW9zdCwgYSBkb21haW4gY2FuIHVzZSBjcmVkaXRzIHRv
IHJ1biBhbGwgaXRzIGFjdGl2ZSBJVEVNcwogICAgICAgICAgKiBmb3Igb25lIGZ1bGwgYWNjb3Vu
dGluZyBwZXJpb2QuIFdlIGFsbG93IGEgZG9tYWluIHRvIGVhcm4gbW9yZQogICAgICAgICAgKiBv
bmx5IHdoZW4gdGhlIHN5c3RlbS13aWRlIGNyZWRpdCBiYWxhbmNlIGlzIG5lZ2F0aXZlLgogICAg
ICAgICAgKi8KLSAgICAgICAgY3JlZGl0X3BlYWsgPSBzZG9tLT5hY3RpdmVfdmNwdV9jb3VudCAq
IHBydi0+Y3JlZGl0c19wZXJfdHNsaWNlOworICAgICAgICBjcmVkaXRfcGVhayA9IHNkb20tPmFj
dGl2ZV9pdGVtX2NvdW50ICogcHJ2LT5jcmVkaXRzX3Blcl90c2xpY2U7CiAgICAgICAgIGlmICgg
cHJ2LT5jcmVkaXRfYmFsYW5jZSA8IDAgKQogICAgICAgICB7CiAgICAgICAgICAgICBjcmVkaXRf
cGVhayArPSAoICggLXBydi0+Y3JlZGl0X2JhbGFuY2UKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAqIHNkb20tPndlaWdodAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICog
c2RvbS0+YWN0aXZlX3ZjcHVfY291bnQpICsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAqIHNkb20tPmFjdGl2ZV9pdGVtX2NvdW50KSArCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICh3ZWlnaHRfdG90YWwgLSAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSAvIHdl
aWdodF90b3RhbDsKICAgICAgICAgfQpAQCAtMTQ2MiwxNCArMTQ2MSwxNCBAQCBjc2NoZWRfYWNj
dCh2b2lkKiBkdW1teSkKICAgICAgICAgICAgIGlmICggY3JlZGl0X2NhcCA8IGNyZWRpdF9wZWFr
ICkKICAgICAgICAgICAgICAgICBjcmVkaXRfcGVhayA9IGNyZWRpdF9jYXA7CiAKLSAgICAgICAg
ICAgIC8qIEZJWE1FIC0tIHNldCBjYXAgcGVyLXZjcHUgYXMgd2VsbC4uLj8gKi8KLSAgICAgICAg
ICAgIGNyZWRpdF9jYXAgPSAoIGNyZWRpdF9jYXAgKyAoIHNkb20tPmFjdGl2ZV92Y3B1X2NvdW50
IC0gMSApCi0gICAgICAgICAgICAgICAgICAgICAgICAgKSAvIHNkb20tPmFjdGl2ZV92Y3B1X2Nv
dW50OworICAgICAgICAgICAgLyogRklYTUUgLS0gc2V0IGNhcCBwZXItaXRlbSBhcyB3ZWxsLi4u
PyAqLworICAgICAgICAgICAgY3JlZGl0X2NhcCA9ICggY3JlZGl0X2NhcCArICggc2RvbS0+YWN0
aXZlX2l0ZW1fY291bnQgLSAxICkKKyAgICAgICAgICAgICAgICAgICAgICAgICApIC8gc2RvbS0+
YWN0aXZlX2l0ZW1fY291bnQ7CiAgICAgICAgIH0KIAogICAgICAgICBjcmVkaXRfZmFpciA9ICgg
KCBjcmVkaXRfdG90YWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBzZG9tLT53ZWlnaHQK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgKiBzZG9tLT5hY3RpdmVfdmNwdV9jb3VudCApCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICogc2RvbS0+YWN0aXZlX2l0ZW1fY291bnQgKQogICAg
ICAgICAgICAgICAgICAgICAgICAgKyAod2VpZ2h0X3RvdGFsIC0gMSkKICAgICAgICAgICAgICAg
ICAgICAgICApIC8gd2VpZ2h0X3RvdGFsOwogCkBAIC0xNTAzLDE0ICsxNTAyLDE0IEBAIGNzY2hl
ZF9hY2N0KHZvaWQqIGR1bW15KQogICAgICAgICAgICAgY3JlZGl0X2ZhaXIgPSBjcmVkaXRfcGVh
azsKICAgICAgICAgfQogCi0gICAgICAgIC8qIENvbXB1dGUgZmFpciBzaGFyZSBwZXIgVkNQVSAq
LwotICAgICAgICBjcmVkaXRfZmFpciA9ICggY3JlZGl0X2ZhaXIgKyAoIHNkb20tPmFjdGl2ZV92
Y3B1X2NvdW50IC0gMSApCi0gICAgICAgICAgICAgICAgICAgICAgKSAvIHNkb20tPmFjdGl2ZV92
Y3B1X2NvdW50OworICAgICAgICAvKiBDb21wdXRlIGZhaXIgc2hhcmUgcGVyIElURU0gKi8KKyAg
ICAgICAgY3JlZGl0X2ZhaXIgPSAoIGNyZWRpdF9mYWlyICsgKCBzZG9tLT5hY3RpdmVfaXRlbV9j
b3VudCAtIDEgKQorICAgICAgICAgICAgICAgICAgICAgICkgLyBzZG9tLT5hY3RpdmVfaXRlbV9j
b3VudDsKIAogCi0gICAgICAgIGxpc3RfZm9yX2VhY2hfc2FmZSggaXRlcl92Y3B1LCBuZXh0X3Zj
cHUsICZzZG9tLT5hY3RpdmVfdmNwdSApCisgICAgICAgIGxpc3RfZm9yX2VhY2hfc2FmZSggaXRl
cl9pdGVtLCBuZXh0X2l0ZW0sICZzZG9tLT5hY3RpdmVfaXRlbSApCiAgICAgICAgIHsKLSAgICAg
ICAgICAgIHN2YyA9IGxpc3RfZW50cnkoaXRlcl92Y3B1LCBzdHJ1Y3QgY3NjaGVkX2l0ZW0sIGFj
dGl2ZV92Y3B1X2VsZW0pOworICAgICAgICAgICAgc3ZjID0gbGlzdF9lbnRyeShpdGVyX2l0ZW0s
IHN0cnVjdCBjc2NoZWRfaXRlbSwgYWN0aXZlX2l0ZW1fZWxlbSk7CiAgICAgICAgICAgICBCVUdf
T04oIHNkb20gIT0gc3ZjLT5zZG9tICk7CiAKICAgICAgICAgICAgIC8qIEluY3JlbWVudCBjcmVk
aXQgKi8KQEAgLTE1MTgsMjAgKzE1MTcsMjAgQEAgY3NjaGVkX2FjY3Qodm9pZCogZHVtbXkpCiAg
ICAgICAgICAgICBjcmVkaXQgPSBhdG9taWNfcmVhZCgmc3ZjLT5jcmVkaXQpOwogCiAgICAgICAg
ICAgICAvKgotICAgICAgICAgICAgICogUmVjb21wdXRlIHByaW9yaXR5IG9yLCBpZiBWQ1BVIGlz
IGlkbGluZywgcmVtb3ZlIGl0IGZyb20KKyAgICAgICAgICAgICAqIFJlY29tcHV0ZSBwcmlvcml0
eSBvciwgaWYgSVRFTSBpcyBpZGxpbmcsIHJlbW92ZSBpdCBmcm9tCiAgICAgICAgICAgICAgKiB0
aGUgYWN0aXZlIGxpc3QuCiAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgIGlmICggY3JlZGl0
IDwgMCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgc3ZjLT5wcmkgPSBDU0NIRURf
UFJJX1RTX09WRVI7CiAKLSAgICAgICAgICAgICAgICAvKiBQYXJrIHJ1bm5pbmcgVkNQVXMgb2Yg
Y2FwcGVkLW91dCBkb21haW5zICovCisgICAgICAgICAgICAgICAgLyogUGFyayBydW5uaW5nIElU
RU1zIG9mIGNhcHBlZC1vdXQgZG9tYWlucyAqLwogICAgICAgICAgICAgICAgIGlmICggc2RvbS0+
Y2FwICE9IDBVICYmCiAgICAgICAgICAgICAgICAgICAgICBjcmVkaXQgPCAtY3JlZGl0X2NhcCAm
JgotICAgICAgICAgICAgICAgICAgICAgIXRlc3RfYW5kX3NldF9iaXQoQ1NDSEVEX0ZMQUdfVkNQ
VV9QQVJLRUQsICZzdmMtPmZsYWdzKSApCisgICAgICAgICAgICAgICAgICAgICAhdGVzdF9hbmRf
c2V0X2JpdChDU0NIRURfRkxBR19JVEVNX1BBUktFRCwgJnN2Yy0+ZmxhZ3MpICkKICAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIFNDSEVEX1NUQVRfQ1JBTksoaXRlbV9wYXJr
KTsKLSAgICAgICAgICAgICAgICAgICAgdmNwdV9wYXVzZV9ub3N5bmMoc3ZjLT52Y3B1KTsKKyAg
ICAgICAgICAgICAgICAgICAgdmNwdV9wYXVzZV9ub3N5bmMoc3ZjLT5pdGVtLT52Y3B1KTsKICAg
ICAgICAgICAgICAgICB9CiAKICAgICAgICAgICAgICAgICAvKiBMb3dlciBib3VuZCBvbiBjcmVk
aXRzICovCkBAIC0xNTQ3LDIxICsxNTQ2LDIxIEBAIGNzY2hlZF9hY2N0KHZvaWQqIGR1bW15KQog
ICAgICAgICAgICAgICAgIHN2Yy0+cHJpID0gQ1NDSEVEX1BSSV9UU19VTkRFUjsKIAogICAgICAg
ICAgICAgICAgIC8qIFVucGFyayBhbnkgY2FwcGVkIGRvbWFpbnMgd2hvc2UgY3JlZGl0cyBnbyBw
b3NpdGl2ZSAqLwotICAgICAgICAgICAgICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KENTQ0hF
RF9GTEFHX1ZDUFVfUEFSS0VELCAmc3ZjLT5mbGFncykgKQorICAgICAgICAgICAgICAgIGlmICgg
dGVzdF9hbmRfY2xlYXJfYml0KENTQ0hFRF9GTEFHX0lURU1fUEFSS0VELCAmc3ZjLT5mbGFncykg
KQogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAg
ICAgICAgICAgICogSXQncyBpbXBvcnRhbnQgdG8gdW5zZXQgdGhlIGZsYWcgQUZURVIgdGhlIHVu
cGF1c2UoKQotICAgICAgICAgICAgICAgICAgICAgKiBjYWxsIHRvIG1ha2Ugc3VyZSB0aGUgVkNQ
VSdzIHByaW9yaXR5IGlzIG5vdCBib29zdGVkCisgICAgICAgICAgICAgICAgICAgICAqIGNhbGwg
dG8gbWFrZSBzdXJlIHRoZSBJVEVNJ3MgcHJpb3JpdHkgaXMgbm90IGJvb3N0ZWQKICAgICAgICAg
ICAgICAgICAgICAgICogaWYgaXQgaXMgd29rZW4gdXAgaGVyZS4KICAgICAgICAgICAgICAgICAg
ICAgICovCiAgICAgICAgICAgICAgICAgICAgIFNDSEVEX1NUQVRfQ1JBTksoaXRlbV91bnBhcmsp
OwotICAgICAgICAgICAgICAgICAgICB2Y3B1X3VucGF1c2Uoc3ZjLT52Y3B1KTsKKyAgICAgICAg
ICAgICAgICAgICAgdmNwdV91bnBhdXNlKHN2Yy0+aXRlbS0+dmNwdSk7CiAgICAgICAgICAgICAg
ICAgfQogCi0gICAgICAgICAgICAgICAgLyogVXBwZXIgYm91bmQgb24gY3JlZGl0cyBtZWFucyBW
Q1BVIHN0b3BzIGVhcm5pbmcgKi8KKyAgICAgICAgICAgICAgICAvKiBVcHBlciBib3VuZCBvbiBj
cmVkaXRzIG1lYW5zIElURU0gc3RvcHMgZWFybmluZyAqLwogICAgICAgICAgICAgICAgIGlmICgg
Y3JlZGl0ID4gcHJ2LT5jcmVkaXRzX3Blcl90c2xpY2UgKQogICAgICAgICAgICAgICAgIHsKLSAg
ICAgICAgICAgICAgICAgICAgX19jc2NoZWRfdmNwdV9hY2N0X3N0b3BfbG9ja2VkKHBydiwgc3Zj
KTsKKyAgICAgICAgICAgICAgICAgICAgX19jc2NoZWRfaXRlbV9hY2N0X3N0b3BfbG9ja2VkKHBy
diwgc3ZjKTsKICAgICAgICAgICAgICAgICAgICAgLyogRGl2aWRlIGNyZWRpdHMgaW4gaGFsZiwg
c28gdGhhdCB3aGVuIGl0IHN0YXJ0cwogICAgICAgICAgICAgICAgICAgICAgKiBhY2NvdW50aW5n
IGFnYWluLCBpdCBzdGFydHMgYSBsaXR0bGUgYml0ICJhaGVhZCIgKi8KICAgICAgICAgICAgICAg
ICAgICAgY3JlZGl0IC89IDI7CkBAIC0xNTY5LDggKzE1NjgsOCBAQCBjc2NoZWRfYWNjdCh2b2lk
KiBkdW1teSkKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9CiAKLSAgICAgICAgICAg
IFNDSEVEX1ZDUFVfU1RBVF9TRVQoc3ZjLCBjcmVkaXRfbGFzdCwgY3JlZGl0KTsKLSAgICAgICAg
ICAgIFNDSEVEX1ZDUFVfU1RBVF9TRVQoc3ZjLCBjcmVkaXRfaW5jciwgY3JlZGl0X2ZhaXIpOwor
ICAgICAgICAgICAgU0NIRURfSVRFTV9TVEFUX1NFVChzdmMsIGNyZWRpdF9sYXN0LCBjcmVkaXQp
OworICAgICAgICAgICAgU0NIRURfSVRFTV9TVEFUX1NFVChzdmMsIGNyZWRpdF9pbmNyLCBjcmVk
aXRfZmFpcik7CiAgICAgICAgICAgICBjcmVkaXRfYmFsYW5jZSArPSBjcmVkaXQ7CiAgICAgICAg
IH0KICAgICB9CkBAIC0xNTk2LDEwICsxNTk1LDEwIEBAIGNzY2hlZF90aWNrKHZvaWQgKl9jcHUp
CiAgICAgc3BjLT50aWNrKys7CiAKICAgICAvKgotICAgICAqIEFjY291bnRpbmcgZm9yIHJ1bm5p
bmcgVkNQVQorICAgICAqIEFjY291bnRpbmcgZm9yIHJ1bm5pbmcgSVRFTQogICAgICAqLwotICAg
IGlmICggIWlzX2lkbGVfdmNwdShjdXJyZW50KSApCi0gICAgICAgIGNzY2hlZF92Y3B1X2FjY3Qo
cHJ2LCBjcHUpOworICAgIGlmICggIWlzX2lkbGVfaXRlbShjdXJyZW50LT5zY2hlZF9pdGVtKSAp
CisgICAgICAgIGNzY2hlZF9pdGVtX2FjY3QocHJ2LCBjcHUpOwogCiAgICAgLyoKICAgICAgKiBD
aGVjayBpZiBydW5xIG5lZWRzIHRvIGJlIHNvcnRlZApAQCAtMTYyMCw3ICsxNjE5LDcgQEAgY3Nj
aGVkX3J1bnFfc3RlYWwoaW50IHBlZXJfY3B1LCBpbnQgY3B1LCBpbnQgcHJpLCBpbnQgYmFsYW5j
ZV9zdGVwKQogICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfcGNwdSAqIGNvbnN0IHBlZXJfcGNwdSA9
IENTQ0hFRF9QQ1BVKHBlZXJfY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkX2l0ZW0gKnNwZWVyOwog
ICAgIHN0cnVjdCBsaXN0X2hlYWQgKml0ZXI7Ci0gICAgc3RydWN0IHZjcHUgKnZjOworICAgIHN0
cnVjdCBzY2hlZF9pdGVtICppdGVtOwogCiAgICAgQVNTRVJUKHBlZXJfcGNwdSAhPSBOVUxMKTsK
IApAQCAtMTYyOCw3ICsxNjI3LDcgQEAgY3NjaGVkX3J1bnFfc3RlYWwoaW50IHBlZXJfY3B1LCBp
bnQgY3B1LCBpbnQgcHJpLCBpbnQgYmFsYW5jZV9zdGVwKQogICAgICAqIERvbid0IHN0ZWFsIGZy
b20gYW4gaWRsZSBDUFUncyBydW5xIGJlY2F1c2UgaXQncyBhYm91dCB0bwogICAgICAqIHBpY2sg
dXAgd29yayBmcm9tIGl0IGl0c2VsZi4KICAgICAgKi8KLSAgICBpZiAoIHVubGlrZWx5KGlzX2lk
bGVfdmNwdShjdXJyX29uX2NwdShwZWVyX2NwdSktPnZjcHUpKSApCisgICAgaWYgKCB1bmxpa2Vs
eShpc19pZGxlX2l0ZW0oY3Vycl9vbl9jcHUocGVlcl9jcHUpKSkgKQogICAgICAgICBnb3RvIG91
dDsKIAogICAgIGxpc3RfZm9yX2VhY2goIGl0ZXIsICZwZWVyX3BjcHUtPnJ1bnEgKQpAQCAtMTYz
Niw0NiArMTYzNSw0NCBAQCBjc2NoZWRfcnVucV9zdGVhbChpbnQgcGVlcl9jcHUsIGludCBjcHUs
IGludCBwcmksIGludCBiYWxhbmNlX3N0ZXApCiAgICAgICAgIHNwZWVyID0gX19ydW5xX2VsZW0o
aXRlcik7CiAKICAgICAgICAgLyoKLSAgICAgICAgICogSWYgbmV4dCBhdmFpbGFibGUgVkNQVSBo
ZXJlIGlzIG5vdCBvZiBzdHJpY3RseSBoaWdoZXIKKyAgICAgICAgICogSWYgbmV4dCBhdmFpbGFi
bGUgSVRFTSBoZXJlIGlzIG5vdCBvZiBzdHJpY3RseSBoaWdoZXIKICAgICAgICAgICogcHJpb3Jp
dHkgdGhhbiBvdXJzLCB0aGlzIFBDUFUgaXMgdXNlbGVzcyB0byB1cy4KICAgICAgICAgICovCiAg
ICAgICAgIGlmICggc3BlZXItPnByaSA8PSBwcmkgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAg
ICAgICAgLyogSXMgdGhpcyBWQ1BVIHJ1bm5hYmxlIG9uIG91ciBQQ1BVPyAqLwotICAgICAgICB2
YyA9IHNwZWVyLT52Y3B1OwotICAgICAgICBCVUdfT04oIGlzX2lkbGVfdmNwdSh2YykgKTsKKyAg
ICAgICAgLyogSXMgdGhpcyBJVEVNIHJ1bm5hYmxlIG9uIG91ciBQQ1BVPyAqLworICAgICAgICBp
dGVtID0gc3BlZXItPml0ZW07CisgICAgICAgIEJVR19PTiggaXNfaWRsZV9pdGVtKGl0ZW0pICk7
CiAKICAgICAgICAgLyoKLSAgICAgICAgICogSWYgdGhlIHZjcHUgaXMgc3RpbGwgaW4gcGVlcl9j
cHUncyBzY2hlZHVsaW5nIHRhaWwsIG9yIGlmIGl0CisgICAgICAgICAqIElmIHRoZSBpdGVtIGlz
IHN0aWxsIGluIHBlZXJfY3B1J3Mgc2NoZWR1bGluZyB0YWlsLCBvciBpZiBpdAogICAgICAgICAg
KiBoYXMgbm8gdXNlZnVsIHNvZnQgYWZmaW5pdHksIHNraXAgaXQuCiAgICAgICAgICAqCiAgICAg
ICAgICAqIEluIGZhY3QsIHdoYXQgd2Ugd2FudCBpcyB0byBjaGVjayBpZiB3ZSBoYXZlIGFueSAi
c29mdC1hZmZpbmUKICAgICAgICAgICogd29yayIgdG8gc3RlYWwsIGJlZm9yZSBzdGFydGluZyB0
byBsb29rIGF0ICJoYXJkLWFmZmluZSB3b3JrIi4KICAgICAgICAgICoKLSAgICAgICAgICogTm90
aWNlIHRoYXQsIGlmIG5vdCBldmVuIG9uZSB2Q1BVIG9uIHRoaXMgcnVucSBoYXMgYSB1c2VmdWwK
KyAgICAgICAgICogTm90aWNlIHRoYXQsIGlmIG5vdCBldmVuIG9uZSBpdGVtIG9uIHRoaXMgcnVu
cSBoYXMgYSB1c2VmdWwKICAgICAgICAgICogc29mdCBhZmZpbml0eSwgd2UgY291bGQgaGF2ZSBh
dm9pZCBjb25zaWRlcmluZyB0aGlzIHJ1bnEgZm9yCiAgICAgICAgICAqIGEgc29mdCBiYWxhbmNp
bmcgc3RlcCBpbiB0aGUgZmlyc3QgcGxhY2UuIFRoaXMsIGZvciBpbnN0YW5jZSwKICAgICAgICAg
ICogY2FuIGJlIGltcGxlbWVudGVkIGJ5IHRha2luZyBub3RlIG9mIG9uIHdoYXQgcnVucSB0aGVy
ZSBhcmUKLSAgICAgICAgICogdkNQVXMgd2l0aCB1c2VmdWwgc29mdCBhZmZpbml0aWVzIGluIHNv
bWUgc29ydCBvZiBiaXRtYXAKKyAgICAgICAgICogaXRlbXMgd2l0aCB1c2VmdWwgc29mdCBhZmZp
bml0aWVzIGluIHNvbWUgc29ydCBvZiBiaXRtYXAKICAgICAgICAgICogb3IgY291bnRlci4KICAg
ICAgICAgICovCi0gICAgICAgIGlmICggdmMtPnNjaGVkX2l0ZW0tPmlzX3J1bm5pbmcgfHwKLSAg
ICAgICAgICAgICAoYmFsYW5jZV9zdGVwID09IEJBTEFOQ0VfU09GVF9BRkZJTklUWSAmJgotICAg
ICAgICAgICAgICAhaGFzX3NvZnRfYWZmaW5pdHkodmMtPnNjaGVkX2l0ZW0pKSApCisgICAgICAg
IGlmICggaXRlbS0+aXNfcnVubmluZyB8fCAoYmFsYW5jZV9zdGVwID09IEJBTEFOQ0VfU09GVF9B
RkZJTklUWSAmJgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFoYXNfc29mdF9h
ZmZpbml0eShpdGVtKSkgKQogICAgICAgICAgICAgY29udGludWU7CiAKLSAgICAgICAgYWZmaW5p
dHlfYmFsYW5jZV9jcHVtYXNrKHZjLT5zY2hlZF9pdGVtLCBiYWxhbmNlX3N0ZXAsIGNwdW1hc2tf
c2NyYXRjaCk7Ci0gICAgICAgIGlmICggX19jc2NoZWRfdmNwdV9pc19taWdyYXRlYWJsZShwcnYs
IHZjLCBjcHUsIGNwdW1hc2tfc2NyYXRjaCkgKQorICAgICAgICBhZmZpbml0eV9iYWxhbmNlX2Nw
dW1hc2soaXRlbSwgYmFsYW5jZV9zdGVwLCBjcHVtYXNrX3NjcmF0Y2gpOworICAgICAgICBpZiAo
IF9fY3NjaGVkX2l0ZW1faXNfbWlncmF0ZWFibGUocHJ2LCBpdGVtLCBjcHUsIGNwdW1hc2tfc2Ny
YXRjaCkgKQogICAgICAgICB7CiAgICAgICAgICAgICAvKiBXZSBnb3QgYSBjYW5kaWRhdGUuIEdy
YWIgaXQhICovCi0gICAgICAgICAgICBUUkFDRV8zRChUUkNfQ1NDSEVEX1NUT0xFTl9WQ1BVLCBw
ZWVyX2NwdSwKLSAgICAgICAgICAgICAgICAgICAgIHZjLT5kb21haW4tPmRvbWFpbl9pZCwgdmMt
PnZjcHVfaWQpOwotICAgICAgICAgICAgU0NIRURfVkNQVV9TVEFUX0NSQU5LKHNwZWVyLCBtaWdy
YXRlX3EpOworICAgICAgICAgICAgVFJBQ0VfM0QoVFJDX0NTQ0hFRF9TVE9MRU5fSVRFTSwgcGVl
cl9jcHUsCisgICAgICAgICAgICAgICAgICAgICBpdGVtLT5kb21haW4tPmRvbWFpbl9pZCwgaXRl
bS0+aXRlbV9pZCk7CisgICAgICAgICAgICBTQ0hFRF9JVEVNX1NUQVRfQ1JBTksoc3BlZXIsIG1p
Z3JhdGVfcSk7CiAgICAgICAgICAgICBTQ0hFRF9TVEFUX0NSQU5LKG1pZ3JhdGVfcXVldWVkKTsK
LSAgICAgICAgICAgIFdBUk5fT04odmMtPmlzX3VyZ2VudCk7CiAgICAgICAgICAgICBydW5xX3Jl
bW92ZShzcGVlcik7Ci0gICAgICAgICAgICBzY2hlZF9zZXRfcmVzKHZjLT5zY2hlZF9pdGVtLCBw
ZXJfY3B1KHNjaGVkX3JlcywgY3B1KSk7CisgICAgICAgICAgICBzY2hlZF9zZXRfcmVzKGl0ZW0s
IHBlcl9jcHUoc2NoZWRfcmVzLCBjcHUpKTsKICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAg
KiBzcGVlciB3aWxsIHN0YXJ0IGV4ZWN1dGluZyBkaXJlY3RseSBvbiBjcHUsIHdpdGhvdXQgaGF2
aW5nIHRvCiAgICAgICAgICAgICAgKiBnbyB0aHJvdWdoIHJ1bnFfaW5zZXJ0KCkuIFNvIHdlIG11
c3QgdXBkYXRlIHRoZSBydW5uYWJsZSBjb3VudApAQCAtMTcwMSw3ICsxNjk4LDcgQEAgY3NjaGVk
X2xvYWRfYmFsYW5jZShzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwgaW50IGNwdSwKICAgICBp
bnQgcGVlcl9jcHUsIGZpcnN0X2NwdSwgcGVlcl9ub2RlLCBic3RlcDsKICAgICBpbnQgbm9kZSA9
IGNwdV90b19ub2RlKGNwdSk7CiAKLSAgICBCVUdfT04oIGNwdSAhPSBzbmV4dC0+dmNwdS0+cHJv
Y2Vzc29yICk7CisgICAgQlVHX09OKCBjcHUgIT0gc2NoZWRfaXRlbV9jcHUoc25leHQtPml0ZW0p
ICk7CiAgICAgb25saW5lID0gY3B1cG9vbF9vbmxpbmVfY3B1bWFzayhjKTsKIAogICAgIC8qCkBA
IC0xNzMwLDcgKzE3MjcsNyBAQCBjc2NoZWRfbG9hZF9iYWxhbmNlKHN0cnVjdCBjc2NoZWRfcHJp
dmF0ZSAqcHJ2LCBpbnQgY3B1LAogICAgICAgICAvKgogICAgICAgICAgKiBXZSBwZWVrIGF0IHRo
ZSBub24taWRsaW5nIENQVXMgaW4gYSBub2RlLXdpc2UgZmFzaGlvbi4gSW4gZmFjdCwKICAgICAg
ICAgICogaXQgaXMgbW9yZSBsaWtlbHkgdGhhdCB3ZSBmaW5kIHNvbWUgYWZmaW5lIHdvcmsgb24g
b3VyIHNhbWUKLSAgICAgICAgICogbm9kZSwgbm90IHRvIG1lbnRpb24gdGhhdCBtaWdyYXRpbmcg
dmNwdXMgd2l0aGluIHRoZSBzYW1lIG5vZGUKKyAgICAgICAgICogbm9kZSwgbm90IHRvIG1lbnRp
b24gdGhhdCBtaWdyYXRpbmcgaXRlbXMgd2l0aGluIHRoZSBzYW1lIG5vZGUKICAgICAgICAgICog
Y291bGQgd2VsbCBleHBlY3RlZCB0byBiZSBjaGVhcGVyIHRoYW4gYWNyb3NzLW5vZGVzIChtZW1v
cnkKICAgICAgICAgICogc3RheXMgbG9jYWwsIHRoZXJlIG1pZ2h0IGJlIHNvbWUgbm9kZS13aWRl
IGNhY2hlW3NdLCBldGMuKS4KICAgICAgICAgICovCkBAIC0xNzUxLDcgKzE3NDgsNyBAQCBjc2No
ZWRfbG9hZF9iYWxhbmNlKHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LCBpbnQgY3B1LAogICAg
ICAgICAgICAgICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAKICAgICAgICAgICAgICAgICAvKgotICAg
ICAgICAgICAgICAgICAqIElmIHRoZXJlIGlzIG9ubHkgb25lIHJ1bm5hYmxlIHZDUFUgb24gcGVl
cl9jcHUsIGl0IG1lYW5zCisgICAgICAgICAgICAgICAgICogSWYgdGhlcmUgaXMgb25seSBvbmUg
cnVubmFibGUgaXRlbSBvbiBwZWVyX2NwdSwgaXQgbWVhbnMKICAgICAgICAgICAgICAgICAgKiB0
aGVyZSdzIG5vIG9uZSB0byBiZSBzdG9sZW4gaW4gaXRzIHJ1bnF1ZXVlLCBzbyBza2lwIGl0Lgog
ICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICogQ2hlY2tpbmcgdGhpcyB3aXRo
b3V0IGhvbGRpbmcgdGhlIGxvY2sgaXMgcmFjeS4uLiBCdXQgdGhhdCdzCkBAIC0xNzY0LDEzICsx
NzYxLDEzIEBAIGNzY2hlZF9sb2FkX2JhbGFuY2Uoc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYs
IGludCBjcHUsCiAgICAgICAgICAgICAgICAgICogICBBbmQgd2UgY2FuIGF2b2lkIHRoYXQgYnkg
cmUtY2hlY2tpbmcgbnJfcnVubmFibGUgYWZ0ZXIKICAgICAgICAgICAgICAgICAgKiAgIGhhdmlu
ZyBncmFiYmVkIHRoZSBsb2NrLCBpZiB3ZSB3YW50OwogICAgICAgICAgICAgICAgICAqIC0gaWYg
d2UgcmFjZSB3aXRoIGluY19ucl9ydW5uYWJsZSgpLCB3ZSBza2lwIGEgcENQVSB0aGF0IG1heQot
ICAgICAgICAgICAgICAgICAqICAgaGF2ZSBydW5uYWJsZSB2Q1BVcyBpbiBpdHMgcnVucXVldWUs
IGJ1dCB0aGF0J3Mgbm90IGEKKyAgICAgICAgICAgICAgICAgKiAgIGhhdmUgcnVubmFibGUgaXRl
bXMgaW4gaXRzIHJ1bnF1ZXVlLCBidXQgdGhhdCdzIG5vdCBhCiAgICAgICAgICAgICAgICAgICog
ICBwcm9ibGVtIGJlY2F1c2U6CiAgICAgICAgICAgICAgICAgICogICArIGlmIHJhY2luZyB3aXRo
IGNzY2hlZF9pdGVtX2luc2VydCgpIG9yIGNzY2hlZF9pdGVtX3dha2UoKSwKLSAgICAgICAgICAg
ICAgICAgKiAgICAgX19ydW5xX3RpY2tsZSgpIHdpbGwgYmUgY2FsbGVkIGFmdGVyd29yZHMsIHNv
IHRoZSB2Q1BVCisgICAgICAgICAgICAgICAgICogICAgIF9fcnVucV90aWNrbGUoKSB3aWxsIGJl
IGNhbGxlZCBhZnRlcndvcmRzLCBzbyB0aGUgaXRlbQogICAgICAgICAgICAgICAgICAqICAgICB3
b24ndCBnZXQgc3R1Y2sgaW4gdGhlIHJ1bnF1ZXVlIGZvciB0b28gbG9uZzsKLSAgICAgICAgICAg
ICAgICAgKiAgICsgaWYgcmFjaW5nIHdpdGggY3NjaGVkX3J1bnFfc3RlYWwoKSwgaXQgbWF5IGJl
IHRoYXQgYQotICAgICAgICAgICAgICAgICAqICAgICB2Q1BVIHRoYXQgd2UgY291bGQgaGF2ZSBw
aWNrZWQgdXAsIHN0YXlzIGluIGEgcnVucXVldWUKKyAgICAgICAgICAgICAgICAgKiAgICsgaWYg
cmFjaW5nIHdpdGggY3NjaGVkX3J1bnFfc3RlYWwoKSwgaXQgbWF5IGJlIHRoYXQgYW4KKyAgICAg
ICAgICAgICAgICAgKiAgICAgaXRlbSB0aGF0IHdlIGNvdWxkIGhhdmUgcGlja2VkIHVwLCBzdGF5
cyBpbiBhIHJ1bnF1ZXVlCiAgICAgICAgICAgICAgICAgICogICAgIHVudGlsIHNvbWVvbmUgZWxz
ZSB0cmllcyB0byBzdGVhbCBpdCBhZ2Fpbi4gQnV0IHRoaXMgaXMKICAgICAgICAgICAgICAgICAg
KiAgICAgbm8gd29yc2UgdGhhbiB3aGF0IGNhbiBoYXBwZW4gYWxyZWFkeSAod2l0aG91dCB0aGlz
CiAgICAgICAgICAgICAgICAgICogICAgIG9wdGltaXphdGlvbiksIGl0IHRoZSBwQ1BVIHdvdWxk
IHNjaGVkdWxlIHJpZ2h0IGFmdGVyIHdlCkBAIC0xODA1LDcgKzE4MDIsNyBAQCBjc2NoZWRfbG9h
ZF9iYWxhbmNlKHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LCBpbnQgY3B1LAogICAgICAgICAg
ICAgICAgICAgICBjc2NoZWRfcnVucV9zdGVhbChwZWVyX2NwdSwgY3B1LCBzbmV4dC0+cHJpLCBi
c3RlcCkgOiBOVUxMOwogICAgICAgICAgICAgICAgIHBjcHVfc2NoZWR1bGVfdW5sb2NrKGxvY2ss
IHBlZXJfY3B1KTsKIAotICAgICAgICAgICAgICAgIC8qIEFzIHNvb24gYXMgb25lIHZjcHUgaXMg
Zm91bmQsIGJhbGFuY2luZyBlbmRzICovCisgICAgICAgICAgICAgICAgLyogQXMgc29vbiBhcyBv
bmUgaXRlbSBpcyBmb3VuZCwgYmFsYW5jaW5nIGVuZHMgKi8KICAgICAgICAgICAgICAgICBpZiAo
IHNwZWVyICE9IE5VTEwgKQogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAg
KnN0b2xlbiA9IDE7CkBAIC0xODQ0LDE0ICsxODQxLDE1IEBAIGNzY2hlZF9zY2hlZHVsZSgKIHsK
ICAgICBjb25zdCBpbnQgY3B1ID0gc21wX3Byb2Nlc3Nvcl9pZCgpOwogICAgIHN0cnVjdCBsaXN0
X2hlYWQgKiBjb25zdCBydW5xID0gUlVOUShjcHUpOwotICAgIHN0cnVjdCBjc2NoZWRfaXRlbSAq
IGNvbnN0IHNjdXJyID0gQ1NDSEVEX0lURU0oY3VycmVudC0+c2NoZWRfaXRlbSk7CisgICAgc3Ry
dWN0IHNjaGVkX2l0ZW0gKml0ZW0gPSBjdXJyZW50LT5zY2hlZF9pdGVtOworICAgIHN0cnVjdCBj
c2NoZWRfaXRlbSAqIGNvbnN0IHNjdXJyID0gQ1NDSEVEX0lURU0oaXRlbSk7CiAgICAgc3RydWN0
IGNzY2hlZF9wcml2YXRlICpwcnYgPSBDU0NIRURfUFJJVihvcHMpOwogICAgIHN0cnVjdCBjc2No
ZWRfaXRlbSAqc25leHQ7CiAgICAgc3RydWN0IHRhc2tfc2xpY2UgcmV0OwogICAgIHNfdGltZV90
IHJ1bnRpbWUsIHRzbGljZTsKIAogICAgIFNDSEVEX1NUQVRfQ1JBTksoc2NoZWR1bGUpOwotICAg
IENTQ0hFRF9WQ1BVX0NIRUNLKGN1cnJlbnQpOworICAgIENTQ0hFRF9JVEVNX0NIRUNLKGl0ZW0p
OwogCiAgICAgLyoKICAgICAgKiBIZXJlIGluIENyZWRpdDEgY29kZSwgd2UgdXN1YWxseSBqdXN0
IGNhbGwgVFJBQ0VfbkQoKSBoZWxwZXJzLCBhbmQKQEAgLTE4NjUsMzAgKzE4NjMsMzAgQEAgY3Nj
aGVkX3NjaGVkdWxlKAogICAgICAgICB9IGQ7CiAgICAgICAgIGQuY3B1ID0gY3B1OwogICAgICAg
ICBkLnRhc2tsZXQgPSB0YXNrbGV0X3dvcmtfc2NoZWR1bGVkOwotICAgICAgICBkLmlkbGUgPSBp
c19pZGxlX3ZjcHUoY3VycmVudCk7CisgICAgICAgIGQuaWRsZSA9IGlzX2lkbGVfaXRlbShpdGVt
KTsKICAgICAgICAgX190cmFjZV92YXIoVFJDX0NTQ0hFRF9TQ0hFRFVMRSwgMSwgc2l6ZW9mKGQp
LAogICAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgY2hhciAqKSZkKTsKICAgICB9CiAKLSAg
ICBydW50aW1lID0gbm93IC0gY3VycmVudC0+c2NoZWRfaXRlbS0+c3RhdGVfZW50cnlfdGltZTsK
KyAgICBydW50aW1lID0gbm93IC0gaXRlbS0+c3RhdGVfZW50cnlfdGltZTsKICAgICBpZiAoIHJ1
bnRpbWUgPCAwICkgLyogRG9lcyB0aGlzIGV2ZXIgaGFwcGVuPyAqLwogICAgICAgICBydW50aW1l
ID0gMDsKIAotICAgIGlmICggIWlzX2lkbGVfdmNwdShzY3Vyci0+dmNwdSkgKQorICAgIGlmICgg
IWlzX2lkbGVfaXRlbShpdGVtKSApCiAgICAgewotICAgICAgICAvKiBVcGRhdGUgY3JlZGl0cyBv
ZiBhIG5vbi1pZGxlIFZDUFUuICovCisgICAgICAgIC8qIFVwZGF0ZSBjcmVkaXRzIG9mIGEgbm9u
LWlkbGUgSVRFTS4gKi8KICAgICAgICAgYnVybl9jcmVkaXRzKHNjdXJyLCBub3cpOwogICAgICAg
ICBzY3Vyci0+c3RhcnRfdGltZSAtPSBub3c7CiAgICAgfQogICAgIGVsc2UKICAgICB7Ci0gICAg
ICAgIC8qIFJlLWluc3RhdGUgYSBib29zdGVkIGlkbGUgVkNQVSBhcyBub3JtYWwtaWRsZS4gKi8K
KyAgICAgICAgLyogUmUtaW5zdGF0ZSBhIGJvb3N0ZWQgaWRsZSBJVEVNIGFzIG5vcm1hbC1pZGxl
LiAqLwogICAgICAgICBzY3Vyci0+cHJpID0gQ1NDSEVEX1BSSV9JRExFOwogICAgIH0KIAogICAg
IC8qIENob2ljZXMsIGNob2ljZXM6Ci0gICAgICogLSBJZiB3ZSBoYXZlIGEgdGFza2xldCwgd2Ug
bmVlZCB0byBydW4gdGhlIGlkbGUgdmNwdSBubyBtYXR0ZXIgd2hhdC4KLSAgICAgKiAtIElmIHNj
aGVkIHJhdGUgbGltaXRpbmcgaXMgaW4gZWZmZWN0LCBhbmQgdGhlIGN1cnJlbnQgdmNwdSBoYXMK
KyAgICAgKiAtIElmIHdlIGhhdmUgYSB0YXNrbGV0LCB3ZSBuZWVkIHRvIHJ1biB0aGUgaWRsZSBp
dGVtIG5vIG1hdHRlciB3aGF0LgorICAgICAqIC0gSWYgc2NoZWQgcmF0ZSBsaW1pdGluZyBpcyBp
biBlZmZlY3QsIGFuZCB0aGUgY3VycmVudCBpdGVtIGhhcwogICAgICAqICAgcnVuIGZvciBsZXNz
IHRoYW4gdGhhdCBhbW91bnQgb2YgdGltZSwgY29udGludWUgdGhlIGN1cnJlbnQgb25lLAogICAg
ICAqICAgYnV0IHdpdGggYSBzaG9ydGVyIHRpbWVzbGljZSBhbmQgcmV0dXJuIGl0IGltbWVkaWF0
ZWx5CiAgICAgICogLSBPdGhlcndpc2UsIGNob3NlIHRoZSBvbmUgd2l0aCB0aGUgaGlnaGVzdCBw
cmlvcml0eSAod2hpY2ggbWF5CkBAIC0xOTA2LDExICsxOTA0LDExIEBAIGNzY2hlZF9zY2hlZHVs
ZSgKICAgICAgKiBJbiBmYWN0LCBpdCBtYXkgYmUgdGhlIGNhc2UgdGhhdCBzY3VyciBpcyBhYm91
dCB0byBzcGluLCBhbmQgdGhlcmUncwogICAgICAqIG5vIHBvaW50IGZvcmNpbmcgaXQgdG8gZG8g
c28gdW50aWwgcmF0ZSBsaW1pdGluZyBleHBpcmVzLgogICAgICAqLwotICAgIGlmICggIXRlc3Rf
Yml0KENTQ0hFRF9GTEFHX1ZDUFVfWUlFTEQsICZzY3Vyci0+ZmxhZ3MpCisgICAgaWYgKCAhdGVz
dF9iaXQoQ1NDSEVEX0ZMQUdfSVRFTV9ZSUVMRCwgJnNjdXJyLT5mbGFncykKICAgICAgICAgICYm
ICF0YXNrbGV0X3dvcmtfc2NoZWR1bGVkCiAgICAgICAgICAmJiBwcnYtPnJhdGVsaW1pdAotICAg
ICAgICAgJiYgdmNwdV9ydW5uYWJsZShjdXJyZW50KQotICAgICAgICAgJiYgIWlzX2lkbGVfdmNw
dShjdXJyZW50KQorICAgICAgICAgJiYgaXRlbV9ydW5uYWJsZShpdGVtKQorICAgICAgICAgJiYg
IWlzX2lkbGVfaXRlbShpdGVtKQogICAgICAgICAgJiYgcnVudGltZSA8IHBydi0+cmF0ZWxpbWl0
ICkKICAgICB7CiAgICAgICAgIHNuZXh0ID0gc2N1cnI7CkBAIC0xOTI4LDExICsxOTI2LDExIEBA
IGNzY2hlZF9zY2hlZHVsZSgKICAgICAgICAgaWYgKCB1bmxpa2VseSh0Yl9pbml0X2RvbmUpICkK
ICAgICAgICAgewogICAgICAgICAgICAgc3RydWN0IHsKLSAgICAgICAgICAgICAgICB1bnNpZ25l
ZCB2Y3B1OjE2LCBkb206MTY7CisgICAgICAgICAgICAgICAgdW5zaWduZWQgaXRlbToxNiwgZG9t
OjE2OwogICAgICAgICAgICAgICAgIHVuc2lnbmVkIHJ1bnRpbWU7CiAgICAgICAgICAgICB9IGQ7
Ci0gICAgICAgICAgICBkLmRvbSA9IHNjdXJyLT52Y3B1LT5kb21haW4tPmRvbWFpbl9pZDsKLSAg
ICAgICAgICAgIGQudmNwdSA9IHNjdXJyLT52Y3B1LT52Y3B1X2lkOworICAgICAgICAgICAgZC5k
b20gPSBpdGVtLT5kb21haW4tPmRvbWFpbl9pZDsKKyAgICAgICAgICAgIGQuaXRlbSA9IGl0ZW0t
Pml0ZW1faWQ7CiAgICAgICAgICAgICBkLnJ1bnRpbWUgPSBydW50aW1lOwogICAgICAgICAgICAg
X190cmFjZV92YXIoVFJDX0NTQ0hFRF9SQVRFTElNSVQsIDEsIHNpemVvZihkKSwKICAgICAgICAg
ICAgICAgICAgICAgICAgICh1bnNpZ25lZCBjaGFyICopJmQpOwpAQCAtMTk0NCwxMyArMTk0Miwx
MyBAQCBjc2NoZWRfc2NoZWR1bGUoCiAgICAgdHNsaWNlID0gcHJ2LT50c2xpY2U7CiAKICAgICAv
KgotICAgICAqIFNlbGVjdCBuZXh0IHJ1bm5hYmxlIGxvY2FsIFZDUFUgKGllIHRvcCBvZiBsb2Nh
bCBydW5xKQorICAgICAqIFNlbGVjdCBuZXh0IHJ1bm5hYmxlIGxvY2FsIElURU0gKGllIHRvcCBv
ZiBsb2NhbCBydW5xKQogICAgICAqLwotICAgIGlmICggdmNwdV9ydW5uYWJsZShjdXJyZW50KSAp
CisgICAgaWYgKCBpdGVtX3J1bm5hYmxlKGl0ZW0pICkKICAgICAgICAgX19ydW5xX2luc2VydChz
Y3Vycik7CiAgICAgZWxzZQogICAgIHsKLSAgICAgICAgQlVHX09OKCBpc19pZGxlX3ZjcHUoY3Vy
cmVudCkgfHwgbGlzdF9lbXB0eShydW5xKSApOworICAgICAgICBCVUdfT04oIGlzX2lkbGVfaXRl
bShpdGVtKSB8fCBsaXN0X2VtcHR5KHJ1bnEpICk7CiAgICAgICAgIC8qIEN1cnJlbnQgaGFzIGJs
b2NrZWQuIFVwZGF0ZSB0aGUgcnVubmFibGUgY291bnRlciBmb3IgdGhpcyBjcHUuICovCiAgICAg
ICAgIGRlY19ucl9ydW5uYWJsZShjcHUpOwogICAgIH0KQEAgLTE5NTgsMjMgKzE5NTYsMjMgQEAg
Y3NjaGVkX3NjaGVkdWxlKAogICAgIHNuZXh0ID0gX19ydW5xX2VsZW0ocnVucS0+bmV4dCk7CiAg
ICAgcmV0Lm1pZ3JhdGVkID0gMDsKIAotICAgIC8qIFRhc2tsZXQgd29yayAod2hpY2ggcnVucyBp
biBpZGxlIFZDUFUgY29udGV4dCkgb3ZlcnJpZGVzIGFsbCBlbHNlLiAqLworICAgIC8qIFRhc2ts
ZXQgd29yayAod2hpY2ggcnVucyBpbiBpZGxlIElURU0gY29udGV4dCkgb3ZlcnJpZGVzIGFsbCBl
bHNlLiAqLwogICAgIGlmICggdGFza2xldF93b3JrX3NjaGVkdWxlZCApCiAgICAgewogICAgICAg
ICBUUkFDRV8wRChUUkNfQ1NDSEVEX1NDSEVEX1RBU0tMRVQpOwotICAgICAgICBzbmV4dCA9IENT
Q0hFRF9JVEVNKGlkbGVfdmNwdVtjcHVdLT5zY2hlZF9pdGVtKTsKKyAgICAgICAgc25leHQgPSBD
U0NIRURfSVRFTShzY2hlZF9pZGxlX2l0ZW0oY3B1KSk7CiAgICAgICAgIHNuZXh0LT5wcmkgPSBD
U0NIRURfUFJJX1RTX0JPT1NUOwogICAgIH0KIAogICAgIC8qCiAgICAgICogQ2xlYXIgWUlFTEQg
ZmxhZyBiZWZvcmUgc2NoZWR1bGluZyBvdXQKICAgICAgKi8KLSAgICBjbGVhcl9iaXQoQ1NDSEVE
X0ZMQUdfVkNQVV9ZSUVMRCwgJnNjdXJyLT5mbGFncyk7CisgICAgY2xlYXJfYml0KENTQ0hFRF9G
TEFHX0lURU1fWUlFTEQsICZzY3Vyci0+ZmxhZ3MpOwogCiAgICAgLyoKICAgICAgKiBTTVAgTG9h
ZCBiYWxhbmNlOgogICAgICAqCi0gICAgICogSWYgdGhlIG5leHQgaGlnaGVzdCBwcmlvcml0eSBs
b2NhbCBydW5uYWJsZSBWQ1BVIGhhcyBhbHJlYWR5IGVhdGVuCisgICAgICogSWYgdGhlIG5leHQg
aGlnaGVzdCBwcmlvcml0eSBsb2NhbCBydW5uYWJsZSBJVEVNIGhhcyBhbHJlYWR5IGVhdGVuCiAg
ICAgICogdGhyb3VnaCBpdHMgY3JlZGl0cywgbG9vayBvbiBvdGhlciBQQ1BVcyB0byBzZWUgaWYg
d2UgaGF2ZSBtb3JlCiAgICAgICogdXJnZW50IHdvcmsuLi4gSWYgbm90LCBjc2NoZWRfbG9hZF9i
YWxhbmNlKCkgd2lsbCByZXR1cm4gc25leHQsIGJ1dAogICAgICAqIGFscmVhZHkgcmVtb3ZlZCBm
cm9tIHRoZSBydW5xLgpAQCAtMTk5OCwzMiArMTk5NiwzMiBAQCBjc2NoZWRfc2NoZWR1bGUoCiAg
ICAgICAgIGNwdW1hc2tfY2xlYXJfY3B1KGNwdSwgcHJ2LT5pZGxlcnMpOwogICAgIH0KIAotICAg
IGlmICggIWlzX2lkbGVfdmNwdShzbmV4dC0+dmNwdSkgKQorICAgIGlmICggIWlzX2lkbGVfaXRl
bShzbmV4dC0+aXRlbSkgKQogICAgICAgICBzbmV4dC0+c3RhcnRfdGltZSArPSBub3c7CiAKIG91
dDoKICAgICAvKgogICAgICAqIFJldHVybiB0YXNrIHRvIHJ1biBuZXh0Li4uCiAgICAgICovCi0g
ICAgcmV0LnRpbWUgPSAoaXNfaWRsZV92Y3B1KHNuZXh0LT52Y3B1KSA/CisgICAgcmV0LnRpbWUg
PSAoaXNfaWRsZV9pdGVtKHNuZXh0LT5pdGVtKSA/CiAgICAgICAgICAgICAgICAgLTEgOiB0c2xp
Y2UpOwotICAgIHJldC50YXNrID0gc25leHQtPnZjcHUtPnNjaGVkX2l0ZW07CisgICAgcmV0LnRh
c2sgPSBzbmV4dC0+aXRlbTsKIAotICAgIENTQ0hFRF9WQ1BVX0NIRUNLKHJldC50YXNrLT52Y3B1
KTsKKyAgICBDU0NIRURfSVRFTV9DSEVDSyhyZXQudGFzayk7CiAgICAgcmV0dXJuIHJldDsKIH0K
IAogc3RhdGljIHZvaWQKLWNzY2hlZF9kdW1wX3ZjcHUoc3RydWN0IGNzY2hlZF9pdGVtICpzdmMp
Citjc2NoZWRfZHVtcF9pdGVtKHN0cnVjdCBjc2NoZWRfaXRlbSAqc3ZjKQogewogICAgIHN0cnVj
dCBjc2NoZWRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKIAogICAgIHByaW50aygiWyVp
LiVpXSBwcmk9JWkgZmxhZ3M9JXggY3B1PSVpIiwKLSAgICAgICAgICAgIHN2Yy0+dmNwdS0+ZG9t
YWluLT5kb21haW5faWQsCi0gICAgICAgICAgICBzdmMtPnZjcHUtPnZjcHVfaWQsCisgICAgICAg
ICAgICBzdmMtPml0ZW0tPmRvbWFpbi0+ZG9tYWluX2lkLAorICAgICAgICAgICAgc3ZjLT5pdGVt
LT5pdGVtX2lkLAogICAgICAgICAgICAgc3ZjLT5wcmksCiAgICAgICAgICAgICBzdmMtPmZsYWdz
LAotICAgICAgICAgICAgc3ZjLT52Y3B1LT5wcm9jZXNzb3IpOworICAgICAgICAgICAgc2NoZWRf
aXRlbV9jcHUoc3ZjLT5pdGVtKSk7CiAKICAgICBpZiAoIHNkb20gKQogICAgIHsKQEAgLTIwNTcs
NyArMjA1NSw3IEBAIGNzY2hlZF9kdW1wX3BjcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
LCBpbnQgY3B1KQogCiAgICAgLyoKICAgICAgKiBXZSBuZWVkIGJvdGggbG9ja3M6Ci0gICAgICog
LSBjc2NoZWRfZHVtcF92Y3B1KCkgd2FudHMgdG8gYWNjZXNzIGRvbWFpbnMnIHNjaGVkdWxpbmcK
KyAgICAgKiAtIGNzY2hlZF9kdW1wX2l0ZW0oKSB3YW50cyB0byBhY2Nlc3MgZG9tYWlucycgc2No
ZWR1bGluZwogICAgICAqICAgcGFyYW1ldGVycywgd2hpY2ggYXJlIHByb3RlY3RlZCBieSB0aGUg
cHJpdmF0ZSBzY2hlZHVsZXIgbG9jazsKICAgICAgKiAtIHdlIHNjYW4gdGhyb3VnaCB0aGUgcnVu
cXVldWUsIHNvIHdlIG5lZWQgdGhlIHByb3BlciBydW5xdWV1ZQogICAgICAqICAgbG9jayAodGhl
IG9uZSBvZiB0aGUgcnVucXVldWUgb2YgdGhpcyBjcHUpLgpAQCAtMjA3MywxMiArMjA3MSwxMiBA
QCBjc2NoZWRfZHVtcF9wY3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgaW50IGNwdSkK
ICAgICAgICAgICAgbnJfY3B1X2lkcywgY3B1bWFza19iaXRzKHBlcl9jcHUoY3B1X3NpYmxpbmdf
bWFzaywgY3B1KSksCiAgICAgICAgICAgIG5yX2NwdV9pZHMsIGNwdW1hc2tfYml0cyhwZXJfY3B1
KGNwdV9jb3JlX21hc2ssIGNwdSkpKTsKIAotICAgIC8qIGN1cnJlbnQgVkNQVSAobm90aGluZyB0
byBzYXkgaWYgdGhhdCdzIHRoZSBpZGxlIHZjcHUpLiAqLworICAgIC8qIGN1cnJlbnQgSVRFTSAo
bm90aGluZyB0byBzYXkgaWYgdGhhdCdzIHRoZSBpZGxlIGl0ZW0pLiAqLwogICAgIHN2YyA9IENT
Q0hFRF9JVEVNKGN1cnJfb25fY3B1KGNwdSkpOwotICAgIGlmICggc3ZjICYmICFpc19pZGxlX3Zj
cHUoc3ZjLT52Y3B1KSApCisgICAgaWYgKCBzdmMgJiYgIWlzX2lkbGVfaXRlbShzdmMtPml0ZW0p
ICkKICAgICB7CiAgICAgICAgIHByaW50aygiXHRydW46ICIpOwotICAgICAgICBjc2NoZWRfZHVt
cF92Y3B1KHN2Yyk7CisgICAgICAgIGNzY2hlZF9kdW1wX2l0ZW0oc3ZjKTsKICAgICB9CiAKICAg
ICBsb29wID0gMDsKQEAgLTIwODgsNyArMjA4Niw3IEBAIGNzY2hlZF9kdW1wX3BjcHUoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBpbnQgY3B1KQogICAgICAgICBpZiAoIHN2YyApCiAgICAg
ICAgIHsKICAgICAgICAgICAgIHByaW50aygiXHQlM2Q6ICIsICsrbG9vcCk7Ci0gICAgICAgICAg
ICBjc2NoZWRfZHVtcF92Y3B1KHN2Yyk7CisgICAgICAgICAgICBjc2NoZWRfZHVtcF9pdGVtKHN2
Yyk7CiAgICAgICAgIH0KICAgICB9CiAKQEAgLTIxMzAsMjkgKzIxMjgsMjkgQEAgY3NjaGVkX2R1
bXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzKQogICAgICAgICAgICBwcnYtPnJhdGVsaW1p
dCAvIE1JQ1JPU0VDUygxKSwKICAgICAgICAgICAgQ1NDSEVEX0NSRURJVFNfUEVSX01TRUMsCiAg
ICAgICAgICAgIHBydi0+dGlja3NfcGVyX3RzbGljZSwKLSAgICAgICAgICAgcHJ2LT52Y3B1X21p
Z3JfZGVsYXkvIE1JQ1JPU0VDUygxKSk7CisgICAgICAgICAgIHBydi0+aXRlbV9taWdyX2RlbGF5
LyBNSUNST1NFQ1MoMSkpOwogCiAgICAgcHJpbnRrKCJpZGxlcnM6ICUqcGJcbiIsIG5yX2NwdV9p
ZHMsIGNwdW1hc2tfYml0cyhwcnYtPmlkbGVycykpOwogCi0gICAgcHJpbnRrKCJhY3RpdmUgdmNw
dXM6XG4iKTsKKyAgICBwcmludGsoImFjdGl2ZSBpdGVtczpcbiIpOwogICAgIGxvb3AgPSAwOwog
ICAgIGxpc3RfZm9yX2VhY2goIGl0ZXJfc2RvbSwgJnBydi0+YWN0aXZlX3Nkb20gKQogICAgIHsK
ICAgICAgICAgc3RydWN0IGNzY2hlZF9kb20gKnNkb207CiAgICAgICAgIHNkb20gPSBsaXN0X2Vu
dHJ5KGl0ZXJfc2RvbSwgc3RydWN0IGNzY2hlZF9kb20sIGFjdGl2ZV9zZG9tX2VsZW0pOwogCi0g
ICAgICAgIGxpc3RfZm9yX2VhY2goIGl0ZXJfc3ZjLCAmc2RvbS0+YWN0aXZlX3ZjcHUgKQorICAg
ICAgICBsaXN0X2Zvcl9lYWNoKCBpdGVyX3N2YywgJnNkb20tPmFjdGl2ZV9pdGVtICkKICAgICAg
ICAgewogICAgICAgICAgICAgc3RydWN0IGNzY2hlZF9pdGVtICpzdmM7CiAgICAgICAgICAgICBz
cGlubG9ja190ICpsb2NrOwogCi0gICAgICAgICAgICBzdmMgPSBsaXN0X2VudHJ5KGl0ZXJfc3Zj
LCBzdHJ1Y3QgY3NjaGVkX2l0ZW0sIGFjdGl2ZV92Y3B1X2VsZW0pOwotICAgICAgICAgICAgbG9j
ayA9IGl0ZW1fc2NoZWR1bGVfbG9jayhzdmMtPnZjcHUtPnNjaGVkX2l0ZW0pOworICAgICAgICAg
ICAgc3ZjID0gbGlzdF9lbnRyeShpdGVyX3N2Yywgc3RydWN0IGNzY2hlZF9pdGVtLCBhY3RpdmVf
aXRlbV9lbGVtKTsKKyAgICAgICAgICAgIGxvY2sgPSBpdGVtX3NjaGVkdWxlX2xvY2soc3ZjLT5p
dGVtKTsKIAogICAgICAgICAgICAgcHJpbnRrKCJcdCUzZDogIiwgKytsb29wKTsKLSAgICAgICAg
ICAgIGNzY2hlZF9kdW1wX3ZjcHUoc3ZjKTsKKyAgICAgICAgICAgIGNzY2hlZF9kdW1wX2l0ZW0o
c3ZjKTsKIAotICAgICAgICAgICAgaXRlbV9zY2hlZHVsZV91bmxvY2sobG9jaywgc3ZjLT52Y3B1
LT5zY2hlZF9pdGVtKTsKKyAgICAgICAgICAgIGl0ZW1fc2NoZWR1bGVfdW5sb2NrKGxvY2ssIHN2
Yy0+aXRlbSk7CiAgICAgICAgIH0KICAgICB9CiAKQEAgLTIyMjYsNyArMjIyNCw3IEBAIGNzY2hl
ZF9pbml0KHN0cnVjdCBzY2hlZHVsZXIgKm9wcykKICAgICBlbHNlCiAgICAgICAgIHBydi0+cmF0
ZWxpbWl0ID0gTUlDUk9TRUNTKHNjaGVkX3JhdGVsaW1pdF91cyk7CiAKLSAgICBwcnYtPnZjcHVf
bWlncl9kZWxheSA9IE1JQ1JPU0VDUyh2Y3B1X21pZ3JhdGlvbl9kZWxheV91cyk7CisgICAgcHJ2
LT5pdGVtX21pZ3JfZGVsYXkgPSBNSUNST1NFQ1ModmNwdV9taWdyYXRpb25fZGVsYXlfdXMpOwog
CiAgICAgcmV0dXJuIDA7CiB9Ci0tIAoyLjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBs
aXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4v
bGlzdGluZm8veGVuLWRldmVs

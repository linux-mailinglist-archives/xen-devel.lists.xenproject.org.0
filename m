Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id CAE157E228
	for <lists+xen-devel@lfdr.de>; Thu,  1 Aug 2019 20:28:55 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1htFlP-0006p9-6N; Thu, 01 Aug 2019 18:25:19 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=wIOK=V5=zededa.com=roman@srs-us1.protection.inumbo.net>)
 id 1htFlO-0006p4-0Q
 for xen-devel@lists.xenproject.org; Thu, 01 Aug 2019 18:25:18 +0000
X-Inumbo-ID: b5d4ed5e-b489-11e9-8980-bc764e045a96
Received: from mail-qk1-x743.google.com (unknown [2607:f8b0:4864:20::743])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id b5d4ed5e-b489-11e9-8980-bc764e045a96;
 Thu, 01 Aug 2019 18:25:16 +0000 (UTC)
Received: by mail-qk1-x743.google.com with SMTP id s22so52844194qkj.12
 for <xen-devel@lists.xenproject.org>; Thu, 01 Aug 2019 11:25:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=zededa.com; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=6g/ld1ndQYtMIXmRd6VqM+jYdqbZGXbCLdmDyLr+yr0=;
 b=UNyQeTETCAAJn6QwZ4b0emt2oWnATvZtDoXrTtt4+igzvWDn68jwOPGP4zAbc7U96Z
 r6lLi4z+92h6OzQCuOgGaLHAx0QgOnTWJ0MES7KvDbE30/XboHhmZker+0XspstqB5lF
 Y431wZ09/P+qQprodhrVVG8owyf6kaWJ2vKORwCxidxb61BlEgKnzUquFYXDs64sSvvt
 Bc1f3lX85ENz0QIuMk/PtvnE4gM4Br9vrVzFohvW7sG3DjJUIH6+7PmsicPvq5PbN1j7
 H18PkOYWOcWZOlYVm+DDrcQ0tK856QA0pz21eeCM55V2NCiIYppW89TTBOR1YcFw8wxb
 AJVQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=6g/ld1ndQYtMIXmRd6VqM+jYdqbZGXbCLdmDyLr+yr0=;
 b=dHsHAHJlJUU4rQc/ZYO42/zYb/7XNWlWoV7buPV37LSHyxs88wh7kOlkHZq+HFj0uD
 dx1+HoApK/BIGwEMIo7A+z6ybDpPR6fOJZkLA3C67lVtl4LHeZbhxcV3IcrsgEhy/ZtQ
 ilOT4poP3e2WacNYVQ46U2Wok1KIWNF1F0qSuGfF2jxQWVALA1A8TBnnfUODKp2QyUi+
 oAhV1KYFDFnYm2ex74JnpA/NeNxjPSfldUTE0mlei6srCs3hTtcW4ZmT5V2Vf3sXRe+5
 +YOYay1Pl1ZHO/fkOtoZuDocHRlR4qZqVZU8/aqfdFb8F/ievf37+oa1zI9ic19hIwtN
 Q/2w==
X-Gm-Message-State: APjAAAXj1qUYZJez1my0FHteHg2vWPKUHc5uBupxN/h6gF6lH4pQ/4wa
 Ghh84ml+c13Jo5kxzD5ITPYrA5BB9DFMpcB9FiglFw==
X-Google-Smtp-Source: APXvYqwCLT1WUHWxcnblQiFTT9RgcXAW4joc4gzO146W3NL1jL53eAjcD0GWEr3PN0esmX+HHyMfYn1mcVWhBU1pZys=
X-Received: by 2002:a37:a7d2:: with SMTP id
 q201mr58746205qke.403.1564683916181; 
 Thu, 01 Aug 2019 11:25:16 -0700 (PDT)
MIME-Version: 1.0
References: <20190724141145.hg4aa5wyg5tsgv5p@Air-de-Roger>
 <CAMmSBy_XRLrxdM-U11pu4JinAKP3fi2TO=VCSo8g_BzMG3X0TA@mail.gmail.com>
 <20190726093545.zwmbt27c24skd3iz@Air-de-Roger>
 <20190730092122.dbpfzu7jsznpyksd@Air-de-Roger>
 <CAMmSBy8U3druT0V_9ADojAyQxn7KTWARMsZ08DZ_5EWU43qDAg@mail.gmail.com>
 <20190731083631.63vqxrdr5vyeeswn@Air-de-Roger>
 <20190731084336.lkpk4n35qg2zo67w@Air-de-Roger>
 <CAMmSBy89cvwnRRPhorpUucLdc5LEak__Mtyw8ka5XvqP7W+q6A@mail.gmail.com>
 <d6ba30f8-7959-57bc-3843-e11f48b52766@citrix.com>
 <CAMmSBy9ZiEU95yAK1ry_41GR0ttWTX9EEJ0bMStZaK=PrzCH7w@mail.gmail.com>
 <20190801081559.wruxck32h5bum2va@Air-de-Roger>
In-Reply-To: <20190801081559.wruxck32h5bum2va@Air-de-Roger>
From: Roman Shaposhnik <roman@zededa.com>
Date: Thu, 1 Aug 2019 11:25:04 -0700
Message-ID: <CAMmSBy9y6hHQfDgcDFmKiRw9QiRSgcxHAq6Qo=o7apTR2EuusA@mail.gmail.com>
To: =?UTF-8?Q?Roger_Pau_Monn=C3=A9?= <roger.pau@citrix.com>
Subject: Re: [Xen-devel] [BUG] After upgrade to Xen 4.12.0 iommu=no-igfx
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "jgross@suse.com" <jgross@suse.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Paul Durrant <Paul.Durrant@citrix.com>,
 "jbeulich@suse.com" <jbeulich@suse.com>,
 "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>,
 "boris.ostrovsky@oracle.com" <boris.ostrovsky@oracle.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gVGh1LCBBdWcgMSwgMjAxOSBhdCAxOjE2IEFNIFJvZ2VyIFBhdSBNb25uw6kgPHJvZ2VyLnBh
dUBjaXRyaXguY29tPiB3cm90ZToKPgo+IE9uIFdlZCwgSnVsIDMxLCAyMDE5IGF0IDAyOjAzOjI0
UE0gLTA3MDAsIFJvbWFuIFNoYXBvc2huaWsgd3JvdGU6Cj4gPiBPbiBXZWQsIEp1bCAzMSwgMjAx
OSBhdCAxMjo0NiBQTSBBbmRyZXcgQ29vcGVyCj4gPiA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4gd3JvdGU6Cj4gPiA+Cj4gPiA+IE9uIDMxLzA3LzIwMTkgMjA6MzUsIFJvbWFuIFNoYXBvc2hu
aWsgd3JvdGU6Cj4gPiA+ID4gT24gV2VkLCBKdWwgMzEsIDIwMTkgYXQgMTo0MyBBTSBSb2dlciBQ
YXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4gd3JvdGU6Cj4gPiA+ID4+IE9uIFdlZCwg
SnVsIDMxLCAyMDE5IGF0IDEwOjM2OjMxQU0gKzAyMDAsIFJvZ2VyIFBhdSBNb25uw6kgd3JvdGU6
Cj4gPiA+ID4+PiBPbiBUdWUsIEp1bCAzMCwgMjAxOSBhdCAxMDo1NToyNEFNIC0wNzAwLCBSb21h
biBTaGFwb3NobmlrIHdyb3RlOgo+ID4gPiA+Pj4+IFNvcnJ5IC0tIGdvdCBhIGJpdCBkaXN0cmFj
dGVkIHllc3RlcmRheS4gQXR0YWNoZWQgaXMgdGhlIGxvZyB3aXRoIG9ubHkKPiA+ID4gPj4+PiB5
b3VyIGxhdGVzdCBwYXRjaCBhdHRhY2hlZC4gSW50ZXJlc3RpbmdseSBlbm91Z2ggdGhlIGJveCBi
b290ZWQgZmluZQo+ID4gPiA+Pj4+IHdpdGhvdXQgc2NyZWVuIGFydGlmYWN0cy4gU28gSSBndWVz
cyB3ZSdyZSBnZXR0aW5nIGNsb3Nlci4uLgo+ID4gPiA+Pj4+Cj4gPiA+ID4+Pj4gVGhhbmtzIGZv
ciBhbGwgdGhlIGhlbHAhCj4gPiA+ID4+PiBUaGF0J3MgcXVpdGUgd2VpcmQsIHRoZXJlJ3Mgbm8g
ZnVuY3Rpb25hbCBjaGFuZ2VzIGJldHdlZW4gdGhlCj4gPiA+ID4+PiBwcmV2aW91cyBwYXRjaGVz
IGFuZCB0aGlzIG9uZSwgdGhlIG9ubHkgZGlmZmVyZW5jZSBpcyB0aGF0IHRoaXMgcGF0Y2gKPiA+
ID4gPj4+IGhhcyBtb3JlIHZlcmJvc2Ugb3V0cHV0Lgo+ID4gPiA+Pj4KPiA+ID4gPj4+IEFyZSB5
b3Ugc3VyZSB5b3UgZGlkbid0IGhhdmUgYW55IGxvY2FsIHBhdGNoZXMgb24gdG9wIG9mIFhlbiB0
aGF0Cj4gPiA+ID4+PiBjb3VsZCBleHBsYWluIHRoaXMgZGlmZmVyZW5jZSBpbiBiZWhhdmlvdXI/
Cj4gPiA+ID4+IEZXSVcsIGNhbiB5b3UgcGxlYXNlIHRyeSB0aGUgcGxhaW4gcGF0Y2ggYWdhaW46
Cj4gPiA+ID4+Cj4gPiA+ID4+IGh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvYXJjaGl2ZXMv
aHRtbC94ZW4tZGV2ZWwvMjAxOS0wNy9tc2cwMTU0Ny5odG1sCj4gPiA+ID4+Cj4gPiA+ID4+IEFu
ZCByZXBvcnQgYmFjaz8KPiA+ID4gPj4KPiA+ID4gPj4gSSB3b3VsZCBsaWtlIHRvIGdldCB0aGlz
IGNvbW1pdHRlZCBBU0FQIGlmIGl0IGRvZXMgZml4IHlvdXIgaXNzdWUuCj4gPiA+ID4gSSdkIGxp
a2UgdG8gc2F5IHRoYXQgaXQgZGlkIC0tIGJ1dCBJIHRyaWVkIGl0IGFnYWluIGp1c3Qgbm93IGFu
ZCBpdAo+ID4gPiA+IHN0aWxsIGdhcmJsZWQgc2NyZWVuIGFuZCB0b25zIG9mOgo+ID4gPiA+Cj4g
PiA+ID4gKFhFTikgcHJpbnRrOiAyNjY2NSBtZXNzYWdlcyBzdXBwcmVzc2VkLgo+ID4gPiA+IChY
RU4pIFtWVC1EXURNQVI6W0RNQSBSZWFkXSBSZXF1ZXN0IGRldmljZSBbMDAwMDowMDowMi4wXSBm
YXVsdCBhZGRyCj4gPiA+ID4gOGUxNGMwMDAsIGlvbW11IHJlZyA9IGZmZmY4MmMwMDA4ZGUwMDAK
PiA+ID4gPgo+ID4gPiA+IEknbSB2ZXJ5IG11Y2ggY29uZnVzZWQgYnkgd2hhdCdzIGdvaW5nIG9u
LCBidXQgaXQgc2VlbXMgdGhhdCdzIHRoZQo+ID4gPiA+IGNhc2UgLS0gYWRkaW5nIHRob3NlIGRl
YnVnIHByaW50IHN0YXRlbWVudHMgbWFrZSB0aGUgaXNzdWUgZ28gYXdheQo+ID4gPiA+Cj4gPiA+
ID4gSGVyZSBhcmUgdGhlIHBhdGNoZXMgdGhhdCBhcmUgYmVpbmcgYXBwbGllZDoKPiA+ID4gPiAg
ICBOT1QgV09SS0lORzoKPiA+ID4gPiBodHRwczovL2dpdGh1Yi5jb20vcnZzL2V2ZS9ibG9iL3hl
bi1idWcvcGtnL3hlbi8wMS1pb21tdS1tYXBwaW5ncy5wYXRjaAo+ID4gPiA+Cj4gPiA+ID4gICAg
V09SS0lORzogaHR0cHM6Ly9naXRodWIuY29tL3J2cy9ldmUvYmxvYi9hMTI5MWZjZDRlNjY5ZGYy
YTYzMjg1YWZiNWU4YjQ4NDFmNDVjMWM4L3BrZy94ZW4vMDEtaW9tbXUtbWFwcGluZ3MucGF0Y2gK
PiA+ID4gPgo+ID4gPiA+IEF0IHRoaXMgcG9pbnQgSSdtIHJlYWxseSBub3Qgc3VyZSB3aGF0J3Mg
Z29pbmcgb24uCj4gPiA+Cj4gPiA+IE9rLiAgc2VlaW5nIGFzIHlvdSd2ZSBkb3VibGUgY2hlY2tl
ZCB0aGlzLCB0aGUgbXlzdGVyeSBkZWVwZW5zLgo+ID4gPgo+ID4gPiBNeSBiZXQgaXMgb24gdGhl
IGludGVsX2lvbW11X2xvb2t1cF9wYWdlKCkgY2FsbCBoYXZpbmcgc2lkZSBlZmZlY3RzWzFdLgo+
ID4gPiBJZiB5b3UgdGFrZSBvdXQgdGhlIGRlYnVnZ2luZyBpbiB0aGUgbWlkZGxlIG9mIHRoZSBs
b29wIGluCj4gPiA+IHJtcnJfaWRlbnRpdHlfbWFwcGluZygpLCBkb2VzIHRoZSBwcm9ibGVtIHJl
cHJvZHVjZSBhZ2Fpbj8KPiA+ID4KPiA+ID4gfkFuZHJldwo+ID4gPgo+ID4gPiBbMV0gTG9va2lu
ZyBhdCB0aGUgaW50ZXJuYWxzIG9mIGFkZHJfdG9fZG1hX3BhZ2VfbWFkZHIoKSwgaXQgZG9lcyAx
MDAlCj4gPiA+IG1vcmUgbWVtb3J5IGFsbG9jYXRpb24gYW5kIGhpZ2hlci1sZXZlbCBQVEUgY29u
c3RydWN0aW9uIHRoYW4gbG9va3Mgd2lzZQo+ID4gPiBmb3Igd2hhdCBpcyBzdXBwb3NlZCB0byBi
ZSBhIGdldHRlci4KPiA+Cj4gPiBZdXAuIFRoYXQncyB3aGF0IGl0IGlzIC0tIGludGVsX2lvbW11
X2xvb2t1cF9wYWdlKCkgc2VlbXMgdG8gYmUgdGhlIGN1bHByaXQuCj4gPgo+ID4gSSd2ZSBkaWQg
dGhlIGV4cGVyaW1lbnQgaW4gdGhlIG90aGVyIGRpcmVjdGlvbiAtLSBhZGRpbmcgYSBkdW1teSBj
YWxsOgo+ID4gICAgICBodHRwczovL2dpdGh1Yi5jb20vcnZzL2V2ZS9ibG9iLzM2YWVlYWE3YzBh
NTM0NzRmYjFlY2VmMmZmNTg3YTg2NjM3ZGY4NTgvcGtnL3hlbi8wMS1pb21tdS1tYXBwaW5ncy5w
YXRjaCNMMjMKPiA+IG9uIHRvcCBvZiBvcmlnaW5hbCBSb2dlcidzIHBhdGNoIG1ha2VzIHN5c3Rl
bSBib290IE5PUk1BTExZLgo+Cj4gSSdtIGFnYWluIHF1aXRlIGxvc3QsIGFuZCBJIGRvbid0IHJl
YWxseSB1bmRlcnN0YW5kIHdoeSBtYXBwaW5ncyBhZGRlZAo+IGJ5IGFyY2hfaW9tbXVfaHdkb21f
aW5pdCBzZWVtcyB0byB3b3JrIGZpbmUgd2hpbGUgbWFwcGluZ3MgYWRkZWQgYnkKPiBybXJyX2lk
ZW50aXR5X21hcHBpbmcgZG9uJ3QuCj4KPiBJIGhhdmUgeWV0IGFub3RoZXIgcGF0Y2ggZm9yIHlv
dSB0byB0cnksIHdoaWNoIGF0dGVtcHRzIHRvIG1pbWljCj4gZXhhY3RseSB3aGF0IGFyY2hfaW9t
bXVfaHdkb21faW5pdCBkb2VzIGludG8gcm1ycl9pZGVudGl0eV9tYXBwaW5nLAo+IGNhbiB5b3Ug
cGxlYXNlIGdpdmUgaXQgYSB0cnk/Cj4KPiBUaGlzIGhhcyB0aGUgYWRkZWQgYm9udXMgb2YgbGlt
aXRpbmcgdGhlIHVzZSBvZgo+IHtzZXQvY2xlYXJ9X2lkZW50aXR5X3AybV9lbnRyeSB0byB0cmFu
c2xhdGVkIGRvbWFpbnMgb25seSwgc2luY2UKPiBybXJyX2lkZW50aXR5X21hcHBpbmcgd2FzIHRo
ZSBvbmx5IGNhbGxlciBhZ2FpbnN0IFBWIGRvbWFpbnMuCj4KPiBUaGFua3MsIFJvZ2VyLgo+IC0t
LTg8LS0tCj4gZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYyBiL3hlbi9hcmNoL3g4
Ni9tbS9wMm0uYwo+IGluZGV4IGZlZjk3YzgyZjYuLmQzNmE1OGIxYTYgMTAwNjQ0Cj4gLS0tIGEv
eGVuL2FyY2gveDg2L21tL3AybS5jCj4gKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCj4gQEAg
LTEzNDEsMTAgKzEzNDEsOCBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShzdHJ1Y3QgZG9t
YWluICpkLCB1bnNpZ25lZCBsb25nIGdmbl9sLAo+Cj4gICAgICBpZiAoICFwYWdpbmdfbW9kZV90
cmFuc2xhdGUocDJtLT5kb21haW4pICkKPiAgICAgIHsKPiAtICAgICAgICBpZiAoICFuZWVkX2lv
bW11X3B0X3N5bmMoZCkgKQo+IC0gICAgICAgICAgICByZXR1cm4gMDsKPiAtICAgICAgICByZXR1
cm4gaW9tbXVfbGVnYWN5X21hcChkLCBfZGZuKGdmbl9sKSwgX21mbihnZm5fbCksIFBBR0VfT1JE
RVJfNEssCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVGX3JlYWRhYmxl
IHwgSU9NTVVGX3dyaXRhYmxlKTsKPiArICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKPiAr
ICAgICAgICByZXR1cm4gLUVOWElPOwo+ICAgICAgfQo+Cj4gICAgICBnZm5fbG9jayhwMm0sIGdm
biwgMCk7Cj4gQEAgLTE0MzIsOSArMTQzMCw4IEBAIGludCBjbGVhcl9pZGVudGl0eV9wMm1fZW50
cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCkKPgo+ICAgICAgaWYgKCAh
cGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkKPiAgICAgIHsKPiAtICAgICAgICBpZiAoICFuZWVk
X2lvbW11X3B0X3N5bmMoZCkgKQo+IC0gICAgICAgICAgICByZXR1cm4gMDsKPiAtICAgICAgICBy
ZXR1cm4gaW9tbXVfbGVnYWN5X3VubWFwKGQsIF9kZm4oZ2ZuX2wpLCBQQUdFX09SREVSXzRLKTsK
PiArICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKPiArICAgICAgICByZXR1cm4gLUVOWElP
Owo+ICAgICAgfQo+Cj4gICAgICBnZm5fbG9jayhwMm0sIGdmbiwgMCk7Cj4gZGlmZiAtLWdpdCBh
L3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL2lvbW11LmMKPiBpbmRleCA1ZDcyMjcwYzViLi42MmRmNWNhNWFhIDEwMDY0NAo+
IC0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCj4gKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKPiBAQCAtMTk2OSw2ICsxOTY5LDcgQEAgc3Rh
dGljIGludCBybXJyX2lkZW50aXR5X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZCwgYm9vbF90IG1h
cCwKPiAgICAgIHVuc2lnbmVkIGxvbmcgZW5kX3BmbiA9IFBBR0VfQUxJR05fNEsocm1yci0+ZW5k
X2FkZHJlc3MpID4+IFBBR0VfU0hJRlRfNEs7Cj4gICAgICBzdHJ1Y3QgbWFwcGVkX3JtcnIgKm1y
bXJyOwo+ICAgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Cj4gKyAg
ICB1bnNpZ25lZCBpbnQgZmx1c2hfZmxhZ3MgPSAwOwo+Cj4gICAgICBBU1NFUlQocGNpZGV2c19s
b2NrZWQoKSk7Cj4gICAgICBBU1NFUlQocm1yci0+YmFzZV9hZGRyZXNzIDwgcm1yci0+ZW5kX2Fk
ZHJlc3MpOwo+IEBAIC0xOTgyLDcgKzE5ODMsNyBAQCBzdGF0aWMgaW50IHJtcnJfaWRlbnRpdHlf
bWFwcGluZyhzdHJ1Y3QgZG9tYWluICpkLCBib29sX3QgbWFwLAo+ICAgICAgICAgIGlmICggbXJt
cnItPmJhc2UgPT0gcm1yci0+YmFzZV9hZGRyZXNzICYmCj4gICAgICAgICAgICAgICBtcm1yci0+
ZW5kID09IHJtcnItPmVuZF9hZGRyZXNzICkKPiAgICAgICAgICB7Cj4gLSAgICAgICAgICAgIGlu
dCByZXQgPSAwOwo+ICsgICAgICAgICAgICBpbnQgcmV0ID0gMCwgZXJyOwo+Cj4gICAgICAgICAg
ICAgIGlmICggbWFwICkKPiAgICAgICAgICAgICAgewo+IEBAIC0xOTk1LDEzICsxOTk2LDIwIEBA
IHN0YXRpYyBpbnQgcm1ycl9pZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmQsIGJvb2xf
dCBtYXAsCj4KPiAgICAgICAgICAgICAgd2hpbGUgKCBiYXNlX3BmbiA8IGVuZF9wZm4gKQo+ICAg
ICAgICAgICAgICB7Cj4gLSAgICAgICAgICAgICAgICBpZiAoIGNsZWFyX2lkZW50aXR5X3AybV9l
bnRyeShkLCBiYXNlX3BmbikgKQo+IC0gICAgICAgICAgICAgICAgICAgIHJldCA9IC1FTlhJTzsK
PiArICAgICAgICAgICAgICAgIGlmICggcGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkKPiArICAg
ICAgICAgICAgICAgICAgICByZXQgPSBjbGVhcl9pZGVudGl0eV9wMm1fZW50cnkoZCwgYmFzZV9w
Zm4pOwo+ICsgICAgICAgICAgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICAgICAgIHJldCA9
IGlvbW11X3VubWFwKGQsIF9kZm4oYmFzZV9wZm4pLCBQQUdFX09SREVSXzRLLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmbHVzaF9mbGFncyk7Cj4gICAgICAgICAg
ICAgICAgICBiYXNlX3BmbisrOwo+ICAgICAgICAgICAgICB9Cj4KPiAgICAgICAgICAgICAgbGlz
dF9kZWwoJm1ybXJyLT5saXN0KTsKPiAgICAgICAgICAgICAgeGZyZWUobXJtcnIpOwo+ICsgICAg
ICAgICAgICAvKiBLZWVwIHRoZSBwcmV2aW91cyBlcnJvciBjb2RlIGlmIHRoZXJlJ3Mgb25lLiAq
Lwo+ICsgICAgICAgICAgICBlcnIgPSBpb21tdV9pb3RsYl9mbHVzaF9hbGwoZCwgZmx1c2hfZmxh
Z3MpOwo+ICsgICAgICAgICAgICBpZiAoICFyZXQgKQo+ICsgICAgICAgICAgICAgICAgcmV0ID0g
ZXJyOwo+ICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ICAgICAgICAgIH0KPiAgICAgIH0KPiBA
QCAtMjAxMSw4ICsyMDE5LDEzIEBAIHN0YXRpYyBpbnQgcm1ycl9pZGVudGl0eV9tYXBwaW5nKHN0
cnVjdCBkb21haW4gKmQsIGJvb2xfdCBtYXAsCj4KPiAgICAgIHdoaWxlICggYmFzZV9wZm4gPCBl
bmRfcGZuICkKPiAgICAgIHsKPiAtICAgICAgICBpbnQgZXJyID0gc2V0X2lkZW50aXR5X3AybV9l
bnRyeShkLCBiYXNlX3BmbiwgcDJtX2FjY2Vzc19ydywgZmxhZyk7Cj4gKyAgICAgICAgaW50IGVy
cjsKPgo+ICsgICAgICAgIGlmICggcGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkKPiArICAgICAg
ICAgICAgZXJyID0gc2V0X2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3BmbiwgcDJtX2FjY2Vz
c19ydywgZmxhZyk7Cj4gKyAgICAgICAgZWxzZQo+ICsgICAgICAgICAgICBlcnIgPSBpb21tdV9t
YXAoZCwgX2RmbihiYXNlX3BmbiksIF9tZm4oYmFzZV9wZm4pLCBQQUdFX09SREVSXzRLLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVGX3JlYWRhYmxlIHwgSU9NTVVGX3dyaXRh
YmxlLCAmZmx1c2hfZmxhZ3MpOwo+ICAgICAgICAgIGlmICggZXJyICkKPiAgICAgICAgICAgICAg
cmV0dXJuIGVycjsKPiAgICAgICAgICBiYXNlX3BmbisrOwo+IEBAIC0yMDI2LDcgKzIwMzksNyBA
QCBzdGF0aWMgaW50IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhzdHJ1Y3QgZG9tYWluICpkLCBib29s
X3QgbWFwLAo+ICAgICAgbXJtcnItPmNvdW50ID0gMTsKPiAgICAgIGxpc3RfYWRkX3RhaWwoJm1y
bXJyLT5saXN0LCAmaGQtPmFyY2gubWFwcGVkX3JtcnJzKTsKPgo+IC0gICAgcmV0dXJuIDA7Cj4g
KyAgICByZXR1cm4gaW9tbXVfaW90bGJfZmx1c2hfYWxsKGQsIGZsdXNoX2ZsYWdzKTsKPiAgfQo+
Cj4gIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfYWRkX2RldmljZSh1OCBkZXZmbiwgc3RydWN0IHBj
aV9kZXYgKnBkZXYpCgpUaGlzIHBhdGNoIGNvbXBsZXRlbHkgZml4ZXMgdGhlIHByb2JsZW0gZm9y
IG1lIQoKVGhhbmtzIFJvZ2VyISBJJ2QgbG92ZSB0byBzZWUgdGhpcyBpbiBYZW4gNC4xMwoKVGhh
bmtzLApSb21hbi4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3Jn
Cmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

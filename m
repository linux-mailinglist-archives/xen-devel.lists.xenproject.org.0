Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DFDC3B0EC1
	for <lists+xen-devel@lfdr.de>; Thu, 12 Sep 2019 14:19:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i8O1z-0007QM-Dt; Thu, 12 Sep 2019 12:16:59 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GjwE=XH=citrix.com=paul.durrant@srs-us1.protection.inumbo.net>)
 id 1i8O1x-0007QB-41
 for xen-devel@lists.xenproject.org; Thu, 12 Sep 2019 12:16:57 +0000
X-Inumbo-ID: 32993118-d557-11e9-9597-12813bfff9fa
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 32993118-d557-11e9-9597-12813bfff9fa;
 Thu, 12 Sep 2019 12:16:50 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1568290610;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=VvgsGAB7BTrgkm7+yI0yUwdTY5E5FVE/Qy+13qP79B8=;
 b=gQZXiS0XW6yEqUaKdO5aQaxJdDC0+BYAQFo5VfMTBxhijibCARScvROH
 mCS+UhNpd2bjPmo4jKHrk2bc70UVTi1l/IDuaLUaGp7ocJHsrqp3Fco3F
 BKqtPOGPwzIB2jQiab08KWsISlEt5pY6V5Lfs1QTTGcdTnw6fnAALT9cd U=;
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=paul.durrant@citrix.com;
 spf=Pass smtp.mailfrom=Paul.Durrant@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 paul.durrant@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="paul.durrant@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa4.hc3370-68.iphmx.com: domain of
 Paul.Durrant@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="Paul.Durrant@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: rlJib4CmA0tFeLUbs9BDFI0fMYESysKlsZ6TbnJRAHIJjwCRLOGc5T4u0Rma43e0h+AqAe29M2
 bgMR6a9nPQegYFa8nNOLUUyu02l5mGnqRcb8nKc8c5jXcJOxSkHfnojPsUewmHmqB/MDuCgB/o
 y0VHCIapTWxM1Hop8oPebKcHdj0Cp+quoqyjRcd9rJO5nzU7jOPQ/Dy+TmHxDySmt2XAQd+goR
 Lrn0NlYdp+spgsRX0fMhTjuu1l1JTMnDPcXZrgNI8mDWPK5MCqzVlgBrWIO7gOjTxtXGhWYocj
 mDc=
X-SBRS: 2.7
X-MesageID: 5769901
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,497,1559534400"; 
   d="scan'208";a="5769901"
From: Paul Durrant <paul.durrant@citrix.com>
To: <qemu-devel@nongnu.org>, <xen-devel@lists.xenproject.org>
Date: Thu, 12 Sep 2019 13:16:44 +0100
Message-ID: <20190912121646.29148-2-paul.durrant@citrix.com>
X-Mailer: git-send-email 2.20.1.2.gb21ebb6
In-Reply-To: <20190912121646.29148-1-paul.durrant@citrix.com>
References: <20190912121646.29148-1-paul.durrant@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 1/3] xen / notify: introduce a new
 XenWatchList abstraction
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony Perard <anthony.perard@citrix.com>,
 Paul Durrant <paul.durrant@citrix.com>,
 Stefano Stabellini <sstabellini@kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

WGVuc3RvcmUgd2F0Y2ggY2FsbC1iYWNrcyBhcmUgYWxyZWFkeSBhYnN0cmFjdGVkIGF3YXkgZnJv
bSBYZW5CdXMgdXNpbmcKdGhlIFhlbldhdGNoIGRhdGEgc3RydWN0dXJlIGJ1dCB0aGUgYXNzb2Np
YXRlZCBOb3RpZmllckxpc3QgbWFuaXB1bGF0aW9uCmFuZCBmaWxlIGhhbmRsZSByZWdpc3RyYXRp
b24gaXMgc3RpbGwgb3BlbiBjb2RlZCBpbiB2YXJpb3VzIHhlbl9idXNfLi4uKCkKZnVuY3Rpb25z
LgpUaGlzIHBhdGNoIGNyZWF0ZXMgYSBuZXcgWGVuV2F0Y2hMaXN0IGRhdGEgc3RydWN0dXJlIHRv
IGFsbG93IHRoZXNlCmludGVyYWN0aW9ucyB0byBiZSBhYnN0cmFjdGVkIGF3YXkgZnJvbSBYZW5C
dXMgYXMgd2VsbC4gVGhpcyBpcyBpbgpwcmVwYXJhdGlvbiBmb3IgYSBzdWJzZXF1ZW50IHBhdGNo
IHdoaWNoIHdpbGwgaW50cm9kdWNlIHNlcGFyYXRlIHdhdGNoIGxpc3RzCmZvciBYZW5CdXMgYW5k
IFhlbkRldmljZSBvYmplY3RzLgoKTk9URTogVGhpcyBwYXRjaCBhbHNvIGludHJvZHVjZXMgYSBu
ZXcgbm90aWZpZXJfbGlzdF9lbXB0eSgpIGhlbHBlciBmdW5jdGlvbgogICAgICBmb3IgdGhlIHB1
cnBvc2VzIG9mIGFkZGluZyBhbiBhc3NlcnRpb24gdGhhdCBhIFhlbldhdGNoTGlzdCBpcyBub3QK
ICAgICAgZnJlZWQgd2hpbHN0IGl0cyBhc3NvY2lhdGVkIE5vdGlmaWVyTGlzdCBpcyBzdGlsbCBv
Y2N1cGllZC4KClNpZ25lZC1vZmYtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBBbnRob255IFBlcmFyZCA8YW50aG9ueS5wZXJhcmRAY2l0cml4
LmNvbT4KLS0tCkNjOiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+
Ci0tLQogaHcveGVuL3RyYWNlLWV2ZW50cyAgICAgIHwgICA1ICstCiBody94ZW4veGVuLWJ1cy5j
ICAgICAgICAgfCAxMTcgKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tCiBp
bmNsdWRlL2h3L3hlbi94ZW4tYnVzLmggfCAgIDMgKy0KIGluY2x1ZGUvcWVtdS9ub3RpZnkuaCAg
ICB8ICAgMiArCiB1dGlsL25vdGlmeS5jICAgICAgICAgICAgfCAgIDUgKysKIDUgZmlsZXMgY2hh
bmdlZCwgODcgaW5zZXJ0aW9ucygrKSwgNDUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvaHcv
eGVuL3RyYWNlLWV2ZW50cyBiL2h3L3hlbi90cmFjZS1ldmVudHMKaW5kZXggYmM4MmVjYjFhNS4u
YWM4ZDljMjBkMiAxMDA2NDQKLS0tIGEvaHcveGVuL3RyYWNlLWV2ZW50cworKysgYi9ody94ZW4v
dHJhY2UtZXZlbnRzCkBAIC0xOSw5ICsxOSw4IEBAIHhlbl9idXNfdW5yZWFsaXplKHZvaWQpICIi
CiB4ZW5fYnVzX2VudW1lcmF0ZSh2b2lkKSAiIgogeGVuX2J1c190eXBlX2VudW1lcmF0ZShjb25z
dCBjaGFyICp0eXBlKSAidHlwZTogJXMiCiB4ZW5fYnVzX2JhY2tlbmRfY3JlYXRlKGNvbnN0IGNo
YXIgKnR5cGUsIGNvbnN0IGNoYXIgKnBhdGgpICJ0eXBlOiAlcyBwYXRoOiAlcyIKLXhlbl9idXNf
YWRkX3dhdGNoKGNvbnN0IGNoYXIgKm5vZGUsIGNvbnN0IGNoYXIgKmtleSwgY2hhciAqdG9rZW4p
ICJub2RlOiAlcyBrZXk6ICVzIHRva2VuOiAlcyIKLXhlbl9idXNfcmVtb3ZlX3dhdGNoKGNvbnN0
IGNoYXIgKm5vZGUsIGNvbnN0IGNoYXIgKmtleSwgY2hhciAqdG9rZW4pICJub2RlOiAlcyBrZXk6
ICVzIHRva2VuOiAlcyIKLXhlbl9idXNfd2F0Y2goY29uc3QgY2hhciAqdG9rZW4pICJ0b2tlbjog
JXMiCit4ZW5fYnVzX2FkZF93YXRjaChjb25zdCBjaGFyICpub2RlLCBjb25zdCBjaGFyICprZXkp
ICJub2RlOiAlcyBrZXk6ICVzIgoreGVuX2J1c19yZW1vdmVfd2F0Y2goY29uc3QgY2hhciAqbm9k
ZSwgY29uc3QgY2hhciAqa2V5KSAibm9kZTogJXMga2V5OiAlcyIKIHhlbl9kZXZpY2VfcmVhbGl6
ZShjb25zdCBjaGFyICp0eXBlLCBjaGFyICpuYW1lKSAidHlwZTogJXMgbmFtZTogJXMiCiB4ZW5f
ZGV2aWNlX3VucmVhbGl6ZShjb25zdCBjaGFyICp0eXBlLCBjaGFyICpuYW1lKSAidHlwZTogJXMg
bmFtZTogJXMiCiB4ZW5fZGV2aWNlX2JhY2tlbmRfc3RhdGUoY29uc3QgY2hhciAqdHlwZSwgY2hh
ciAqbmFtZSwgY29uc3QgY2hhciAqc3RhdGUpICJ0eXBlOiAlcyBuYW1lOiAlcyAtPiAlcyIKZGlm
ZiAtLWdpdCBhL2h3L3hlbi94ZW4tYnVzLmMgYi9ody94ZW4veGVuLWJ1cy5jCmluZGV4IDAyNWRm
NWU1OWYuLjI4ZWZhY2NmZjIgMTAwNjQ0Ci0tLSBhL2h3L3hlbi94ZW4tYnVzLmMKKysrIGIvaHcv
eGVuL3hlbi1idXMuYwpAQCAtMTU3LDE4ICsxNTcsNjAgQEAgc3RhdGljIHZvaWQgZnJlZV93YXRj
aChYZW5XYXRjaCAqd2F0Y2gpCiAgICAgZ19mcmVlKHdhdGNoKTsKIH0KIAotc3RhdGljIFhlbldh
dGNoICp4ZW5fYnVzX2FkZF93YXRjaChYZW5CdXMgKnhlbmJ1cywgY29uc3QgY2hhciAqbm9kZSwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqa2V5LCBYZW5X
YXRjaEhhbmRsZXIgaGFuZGxlciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dm9pZCAqb3BhcXVlLCBFcnJvciAqKmVycnApCitzdHJ1Y3QgWGVuV2F0Y2hMaXN0IHsKKyAgICBz
dHJ1Y3QgeHNfaGFuZGxlICp4c2g7CisgICAgTm90aWZpZXJMaXN0IG5vdGlmaWVyczsKK307CisK
K3N0YXRpYyB2b2lkIHdhdGNoX2xpc3RfZXZlbnQodm9pZCAqb3BhcXVlKQoreworICAgIFhlbldh
dGNoTGlzdCAqd2F0Y2hfbGlzdCA9IG9wYXF1ZTsKKyAgICBjaGFyICoqdjsKKyAgICBjb25zdCBj
aGFyICp0b2tlbjsKKworICAgIHYgPSB4c19jaGVja193YXRjaCh3YXRjaF9saXN0LT54c2gpOwor
ICAgIGlmICghdikgeworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgdG9rZW4gPSB2W1hT
X1dBVENIX1RPS0VOXTsKKworICAgIG5vdGlmaWVyX2xpc3Rfbm90aWZ5KCZ3YXRjaF9saXN0LT5u
b3RpZmllcnMsICh2b2lkICopdG9rZW4pOworCisgICAgZnJlZSh2KTsKK30KKworc3RhdGljIFhl
bldhdGNoTGlzdCAqd2F0Y2hfbGlzdF9jcmVhdGUoc3RydWN0IHhzX2hhbmRsZSAqeHNoKQorewor
ICAgIFhlbldhdGNoTGlzdCAqd2F0Y2hfbGlzdCA9IGdfbmV3MChYZW5XYXRjaExpc3QsIDEpOwor
CisgICAgZ19hc3NlcnQoeHNoKTsKKworICAgIHdhdGNoX2xpc3QtPnhzaCA9IHhzaDsKKyAgICBu
b3RpZmllcl9saXN0X2luaXQoJndhdGNoX2xpc3QtPm5vdGlmaWVycyk7CisgICAgcWVtdV9zZXRf
ZmRfaGFuZGxlcih4c19maWxlbm8od2F0Y2hfbGlzdC0+eHNoKSwgd2F0Y2hfbGlzdF9ldmVudCwg
TlVMTCwKKyAgICAgICAgICAgICAgICAgICAgICAgIHdhdGNoX2xpc3QpOworCisgICAgcmV0dXJu
IHdhdGNoX2xpc3Q7Cit9CisKK3N0YXRpYyB2b2lkIHdhdGNoX2xpc3RfZGVzdHJveShYZW5XYXRj
aExpc3QgKndhdGNoX2xpc3QpCit7CisgICAgZ19hc3NlcnQobm90aWZpZXJfbGlzdF9lbXB0eSgm
d2F0Y2hfbGlzdC0+bm90aWZpZXJzKSk7CisgICAgcWVtdV9zZXRfZmRfaGFuZGxlcih4c19maWxl
bm8od2F0Y2hfbGlzdC0+eHNoKSwgTlVMTCwgTlVMTCwgTlVMTCk7CisgICAgZ19mcmVlKHdhdGNo
X2xpc3QpOworfQorCitzdGF0aWMgWGVuV2F0Y2ggKndhdGNoX2xpc3RfYWRkKFhlbldhdGNoTGlz
dCAqd2F0Y2hfbGlzdCwgY29uc3QgY2hhciAqbm9kZSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgY2hhciAqa2V5LCBYZW5XYXRjaEhhbmRsZXIgaGFuZGxlciwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqb3BhcXVlLCBFcnJvciAqKmVycnApCiB7
CiAgICAgWGVuV2F0Y2ggKndhdGNoID0gbmV3X3dhdGNoKG5vZGUsIGtleSwgaGFuZGxlciwgb3Bh
cXVlKTsKICAgICBFcnJvciAqbG9jYWxfZXJyID0gTlVMTDsKIAotICAgIHRyYWNlX3hlbl9idXNf
YWRkX3dhdGNoKHdhdGNoLT5ub2RlLCB3YXRjaC0+a2V5LCB3YXRjaC0+dG9rZW4pOwotCi0gICAg
bm90aWZpZXJfbGlzdF9hZGQoJnhlbmJ1cy0+d2F0Y2hfbm90aWZpZXJzLCAmd2F0Y2gtPm5vdGlm
aWVyKTsKKyAgICBub3RpZmllcl9saXN0X2FkZCgmd2F0Y2hfbGlzdC0+bm90aWZpZXJzLCAmd2F0
Y2gtPm5vdGlmaWVyKTsKIAotICAgIHhzX25vZGVfd2F0Y2goeGVuYnVzLT54c2gsIG5vZGUsIGtl
eSwgd2F0Y2gtPnRva2VuLCAmbG9jYWxfZXJyKTsKKyAgICB4c19ub2RlX3dhdGNoKHdhdGNoX2xp
c3QtPnhzaCwgbm9kZSwga2V5LCB3YXRjaC0+dG9rZW4sICZsb2NhbF9lcnIpOwogICAgIGlmIChs
b2NhbF9lcnIpIHsKICAgICAgICAgZXJyb3JfcHJvcGFnYXRlKGVycnAsIGxvY2FsX2Vycik7CiAK
QEAgLTE4MSwxOCArMjIzLDM0IEBAIHN0YXRpYyBYZW5XYXRjaCAqeGVuX2J1c19hZGRfd2F0Y2go
WGVuQnVzICp4ZW5idXMsIGNvbnN0IGNoYXIgKm5vZGUsCiAgICAgcmV0dXJuIHdhdGNoOwogfQog
Ci1zdGF0aWMgdm9pZCB4ZW5fYnVzX3JlbW92ZV93YXRjaChYZW5CdXMgKnhlbmJ1cywgWGVuV2F0
Y2ggKndhdGNoLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXJyb3IgKiplcnJw
KQorc3RhdGljIHZvaWQgd2F0Y2hfbGlzdF9yZW1vdmUoWGVuV2F0Y2hMaXN0ICp3YXRjaF9saXN0
LCBYZW5XYXRjaCAqd2F0Y2gsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFcnJvciAq
KmVycnApCiB7Ci0gICAgdHJhY2VfeGVuX2J1c19yZW1vdmVfd2F0Y2god2F0Y2gtPm5vZGUsIHdh
dGNoLT5rZXksIHdhdGNoLT50b2tlbik7Ci0KLSAgICB4c19ub2RlX3Vud2F0Y2goeGVuYnVzLT54
c2gsIHdhdGNoLT5ub2RlLCB3YXRjaC0+a2V5LCB3YXRjaC0+dG9rZW4sCisgICAgeHNfbm9kZV91
bndhdGNoKHdhdGNoX2xpc3QtPnhzaCwgd2F0Y2gtPm5vZGUsIHdhdGNoLT5rZXksIHdhdGNoLT50
b2tlbiwKICAgICAgICAgICAgICAgICAgICAgZXJycCk7CiAKICAgICBub3RpZmllcl9yZW1vdmUo
JndhdGNoLT5ub3RpZmllcik7CiAgICAgZnJlZV93YXRjaCh3YXRjaCk7CiB9CiAKK3N0YXRpYyBY
ZW5XYXRjaCAqeGVuX2J1c19hZGRfd2F0Y2goWGVuQnVzICp4ZW5idXMsIGNvbnN0IGNoYXIgKm5v
ZGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmtleSwg
WGVuV2F0Y2hIYW5kbGVyIGhhbmRsZXIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHZvaWQgKm9wYXF1ZSwgRXJyb3IgKiplcnJwKQoreworICAgIHRyYWNlX3hlbl9idXNfYWRk
X3dhdGNoKG5vZGUsIGtleSk7CisKKyAgICByZXR1cm4gd2F0Y2hfbGlzdF9hZGQoeGVuYnVzLT53
YXRjaF9saXN0LCBub2RlLCBrZXksIGhhbmRsZXIsIG9wYXF1ZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgZXJycCk7Cit9CisKK3N0YXRpYyB2b2lkIHhlbl9idXNfcmVtb3ZlX3dhdGNoKFhl
bkJ1cyAqeGVuYnVzLCBYZW5XYXRjaCAqd2F0Y2gsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBFcnJvciAqKmVycnApCit7CisgICAgdHJhY2VfeGVuX2J1c19yZW1vdmVfd2F0Y2go
d2F0Y2gtPm5vZGUsIHdhdGNoLT5rZXkpOworCisgICAgd2F0Y2hfbGlzdF9yZW1vdmUoeGVuYnVz
LT53YXRjaF9saXN0LCB3YXRjaCwgZXJycCk7Cit9CisKIHN0YXRpYyB2b2lkIHhlbl9idXNfYmFj
a2VuZF9jcmVhdGUoWGVuQnVzICp4ZW5idXMsIGNvbnN0IGNoYXIgKnR5cGUsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIGNoYXIgKnBhdGgsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVycm9yICoqZXJycCkKQEAgLTMzOCwz
NSArMzk2LDE0IEBAIHN0YXRpYyB2b2lkIHhlbl9idXNfdW5yZWFsaXplKEJ1c1N0YXRlICpidXMs
IEVycm9yICoqZXJycCkKICAgICAgICAgeGVuYnVzLT5iYWNrZW5kX3dhdGNoID0gTlVMTDsKICAg
ICB9CiAKLSAgICBpZiAoIXhlbmJ1cy0+eHNoKSB7Ci0gICAgICAgIHJldHVybjsKKyAgICBpZiAo
eGVuYnVzLT53YXRjaF9saXN0KSB7CisgICAgICAgIHdhdGNoX2xpc3RfZGVzdHJveSh4ZW5idXMt
PndhdGNoX2xpc3QpOworICAgICAgICB4ZW5idXMtPndhdGNoX2xpc3QgPSBOVUxMOwogICAgIH0K
IAotICAgIHFlbXVfc2V0X2ZkX2hhbmRsZXIoeHNfZmlsZW5vKHhlbmJ1cy0+eHNoKSwgTlVMTCwg
TlVMTCwgTlVMTCk7Ci0KLSAgICB4c19jbG9zZSh4ZW5idXMtPnhzaCk7Ci19Ci0KLXN0YXRpYyB2
b2lkIHhlbl9idXNfd2F0Y2godm9pZCAqb3BhcXVlKQotewotICAgIFhlbkJ1cyAqeGVuYnVzID0g
b3BhcXVlOwotICAgIGNoYXIgKip2OwotICAgIGNvbnN0IGNoYXIgKnRva2VuOwotCi0gICAgZ19h
c3NlcnQoeGVuYnVzLT54c2gpOwotCi0gICAgdiA9IHhzX2NoZWNrX3dhdGNoKHhlbmJ1cy0+eHNo
KTsKLSAgICBpZiAoIXYpIHsKLSAgICAgICAgcmV0dXJuOworICAgIGlmICh4ZW5idXMtPnhzaCkg
eworICAgICAgICB4c19jbG9zZSh4ZW5idXMtPnhzaCk7CiAgICAgfQotCi0gICAgdG9rZW4gPSB2
W1hTX1dBVENIX1RPS0VOXTsKLQotICAgIHRyYWNlX3hlbl9idXNfd2F0Y2godG9rZW4pOwotCi0g
ICAgbm90aWZpZXJfbGlzdF9ub3RpZnkoJnhlbmJ1cy0+d2F0Y2hfbm90aWZpZXJzLCAodm9pZCAq
KXRva2VuKTsKLQotICAgIGZyZWUodik7CiB9CiAKIHN0YXRpYyB2b2lkIHhlbl9idXNfcmVhbGl6
ZShCdXNTdGF0ZSAqYnVzLCBFcnJvciAqKmVycnApCkBAIC0zOTAsOSArNDI3LDcgQEAgc3RhdGlj
IHZvaWQgeGVuX2J1c19yZWFsaXplKEJ1c1N0YXRlICpidXMsIEVycm9yICoqZXJycCkKICAgICAg
ICAgeGVuYnVzLT5iYWNrZW5kX2lkID0gMDsgLyogQXNzdW1lIGxhY2sgb2Ygbm9kZSBtZWFucyBk
b20wICovCiAgICAgfQogCi0gICAgbm90aWZpZXJfbGlzdF9pbml0KCZ4ZW5idXMtPndhdGNoX25v
dGlmaWVycyk7Ci0gICAgcWVtdV9zZXRfZmRfaGFuZGxlcih4c19maWxlbm8oeGVuYnVzLT54c2gp
LCB4ZW5fYnVzX3dhdGNoLCBOVUxMLAotICAgICAgICAgICAgICAgICAgICAgICAgeGVuYnVzKTsK
KyAgICB4ZW5idXMtPndhdGNoX2xpc3QgPSB3YXRjaF9saXN0X2NyZWF0ZSh4ZW5idXMtPnhzaCk7
CiAKICAgICBtb2R1bGVfY2FsbF9pbml0KE1PRFVMRV9JTklUX1hFTl9CQUNLRU5EKTsKIApkaWZm
IC0tZ2l0IGEvaW5jbHVkZS9ody94ZW4veGVuLWJ1cy5oIGIvaW5jbHVkZS9ody94ZW4veGVuLWJ1
cy5oCmluZGV4IDFjMmQ5ZGZkYjguLjg4Yjg0ZTI5YmIgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvaHcv
eGVuL3hlbi1idXMuaAorKysgYi9pbmNsdWRlL2h3L3hlbi94ZW4tYnVzLmgKQEAgLTE0LDYgKzE0
LDcgQEAKIAogdHlwZWRlZiB2b2lkICgqWGVuV2F0Y2hIYW5kbGVyKSh2b2lkICpvcGFxdWUpOwog
Cit0eXBlZGVmIHN0cnVjdCBYZW5XYXRjaExpc3QgWGVuV2F0Y2hMaXN0OwogdHlwZWRlZiBzdHJ1
Y3QgWGVuV2F0Y2ggWGVuV2F0Y2g7CiB0eXBlZGVmIHN0cnVjdCBYZW5FdmVudENoYW5uZWwgWGVu
RXZlbnRDaGFubmVsOwogCkBAIC02Myw3ICs2NCw3IEBAIHR5cGVkZWYgc3RydWN0IFhlbkJ1cyB7
CiAgICAgQnVzU3RhdGUgcWJ1czsKICAgICBkb21pZF90IGJhY2tlbmRfaWQ7CiAgICAgc3RydWN0
IHhzX2hhbmRsZSAqeHNoOwotICAgIE5vdGlmaWVyTGlzdCB3YXRjaF9ub3RpZmllcnM7CisgICAg
WGVuV2F0Y2hMaXN0ICp3YXRjaF9saXN0OwogICAgIFhlbldhdGNoICpiYWNrZW5kX3dhdGNoOwog
fSBYZW5CdXM7CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVtdS9ub3RpZnkuaCBiL2luY2x1ZGUv
cWVtdS9ub3RpZnkuaAppbmRleCBhM2Q3M2U0YmM3Li5iY2ZhNzBmYjJlIDEwMDY0NAotLS0gYS9p
bmNsdWRlL3FlbXUvbm90aWZ5LmgKKysrIGIvaW5jbHVkZS9xZW11L25vdGlmeS5oCkBAIC00MCw2
ICs0MCw4IEBAIHZvaWQgbm90aWZpZXJfcmVtb3ZlKE5vdGlmaWVyICpub3RpZmllcik7CiAKIHZv
aWQgbm90aWZpZXJfbGlzdF9ub3RpZnkoTm90aWZpZXJMaXN0ICpsaXN0LCB2b2lkICpkYXRhKTsK
IAorYm9vbCBub3RpZmllcl9saXN0X2VtcHR5KE5vdGlmaWVyTGlzdCAqbGlzdCk7CisKIC8qIFNh
bWUgYXMgTm90aWZpZXIgYnV0IGFsbG93cyAubm90aWZ5KCkgdG8gcmV0dXJuIGVycm9ycyAqLwog
dHlwZWRlZiBzdHJ1Y3QgTm90aWZpZXJXaXRoUmV0dXJuIE5vdGlmaWVyV2l0aFJldHVybjsKIApk
aWZmIC0tZ2l0IGEvdXRpbC9ub3RpZnkuYyBiL3V0aWwvbm90aWZ5LmMKaW5kZXggYWVlOGQ5M2Ni
MC4uNzZiYWIyMTJhZSAxMDA2NDQKLS0tIGEvdXRpbC9ub3RpZnkuYworKysgYi91dGlsL25vdGlm
eS5jCkBAIC00MCw2ICs0MCwxMSBAQCB2b2lkIG5vdGlmaWVyX2xpc3Rfbm90aWZ5KE5vdGlmaWVy
TGlzdCAqbGlzdCwgdm9pZCAqZGF0YSkKICAgICB9CiB9CiAKK2Jvb2wgbm90aWZpZXJfbGlzdF9l
bXB0eShOb3RpZmllckxpc3QgKmxpc3QpCit7CisgICAgcmV0dXJuIFFMSVNUX0VNUFRZKCZsaXN0
LT5ub3RpZmllcnMpOworfQorCiB2b2lkIG5vdGlmaWVyX3dpdGhfcmV0dXJuX2xpc3RfaW5pdChO
b3RpZmllcldpdGhSZXR1cm5MaXN0ICpsaXN0KQogewogICAgIFFMSVNUX0lOSVQoJmxpc3QtPm5v
dGlmaWVycyk7Ci0tIAoyLjIwLjEuMi5nYjIxZWJiNgoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=

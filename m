Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id EBE5533499
	for <lists+xen-devel@lfdr.de>; Mon,  3 Jun 2019 18:08:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hXpRV-0001zI-4V; Mon, 03 Jun 2019 16:04:13 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=fnY6=UC=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1hXpRU-0001yr-GW
 for xen-devel@lists.xenproject.org; Mon, 03 Jun 2019 16:04:12 +0000
X-Inumbo-ID: 39df92f4-8619-11e9-8980-bc764e045a96
Received: from foss.arm.com (unknown [217.140.101.70])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTP
 id 39df92f4-8619-11e9-8980-bc764e045a96;
 Mon, 03 Jun 2019 16:04:11 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.72.51.249])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 5C8A7A78;
 Mon,  3 Jun 2019 09:04:11 -0700 (PDT)
Received: from e108454-lin.cambridge.arm.com (e108454-lin.cambridge.arm.com
 [10.1.196.50])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 48CED3F246;
 Mon,  3 Jun 2019 09:04:09 -0700 (PDT)
From: Julien Grall <julien.grall@arm.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  3 Jun 2019 17:03:42 +0100
Message-Id: <20190603160350.29806-7-julien.grall@arm.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190603160350.29806-1-julien.grall@arm.com>
References: <20190603160350.29806-1-julien.grall@arm.com>
Subject: [Xen-devel] [PATCH v3 06/14] xen: Convert is_xen_heap_mfn to use
 typesafe MFN
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Tm8gZnVuY3Rpb25hbCBjaGFuZ2VzLgoKU2lnbmVkLW9mZi1ieTogSnVsaWVuIEdyYWxsIDxqdWxp
ZW4uZ3JhbGxAYXJtLmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KQWNrZWQtYnk6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3N0YWJlbGxpbmlAa2VybmVsLm9y
Zz4KUmV2aWV3ZWQtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4K
Ci0tLQogICAgQ2hhbmdlcyBpbiB2MzoKICAgICAgICAtIEFkZCBHZW9yZ2UncyByZXZpZXdlZC1i
eQoKICAgIENoYW5nZXMgaW4gdjI6CiAgICAgICAgLSBGaXggY29kaW5nIHN0eWxlCiAgICAgICAg
LSBNZXJnZSB0aGUgZGVjbGFyYXRpb24gZm9yIGdwZm4gYW5kIG9sZF9ncGZuCiAgICAgICAgLSBE
b24ndCBvcGVuLWNvZGUgbWZuX3ZhbGlkCiAgICAgICAgLSBBZGQgSmFuJ3MgcmV2aWV3ZWQtYnkK
ICAgICAgICAtIFVzZSBtZm5fYWRkKG1mbiwgLTEpCiAgICAgICAgLSBBZGQgU3RlZmFubydzIGFj
a2VkLWJ5IGZvciBBUk0gcGFydHMKLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAgICAgICAgICAg
fCAxMCArKysrKy0tLS0tCiB4ZW4vYXJjaC94ODYvbW0vcDJtLmMgICAgICAgICAgfCAgMiArLQog
eGVuL2FyY2gveDg2L21tL3NoYWRvdy9tdWx0aS5jIHwgIDIgKy0KIHhlbi9jb21tb24vcGFnZV9h
bGxvYy5jICAgICAgICB8ICA0ICsrLS0KIHhlbi9pbmNsdWRlL2FzbS1hcm0vbW0uaCAgICAgICB8
ICA4ICsrKystLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21tLmggICAgICAgfCAgMiArLQogNiBm
aWxlcyBjaGFuZ2VkLCAxNCBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IDJmNjIwZDlh
ZWIuLjNkM2Q4YmQ3YTggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCkBAIC00NDU4LDggKzQ0NTgsOCBAQCBpbnQgeGVubWVtX2FkZF90b19waHlz
bWFwX29uZSgKICAgICBnZm5fdCBncGZuKQogewogICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Ug
PSBOVUxMOwotICAgIHVuc2lnbmVkIGxvbmcgZ2ZuID0gMDsgLyogZ2NjIC4uLiAqLwotICAgIHVu
c2lnbmVkIGxvbmcgcHJldl9tZm4sIG9sZF9ncGZuOworICAgIHVuc2lnbmVkIGxvbmcgZ2ZuID0g
MCAvKiBnY2MgLi4uICovLCBvbGRfZ3BmbjsKKyAgICBtZm5fdCBwcmV2X21mbjsKICAgICBpbnQg
cmMgPSAwOwogICAgIG1mbl90IG1mbiA9IElOVkFMSURfTUZOOwogICAgIHAybV90eXBlX3QgcDJt
dDsKQEAgLTQ1MDUsMTIgKzQ1MDUsMTIgQEAgaW50IHhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUo
CiAgICAgfQogCiAgICAgLyogUmVtb3ZlIHByZXZpb3VzbHkgbWFwcGVkIHBhZ2UgaWYgaXQgd2Fz
IHByZXNlbnQuICovCi0gICAgcHJldl9tZm4gPSBtZm5feChnZXRfZ2ZuKGQsIGdmbl94KGdwZm4p
LCAmcDJtdCkpOwotICAgIGlmICggbWZuX3ZhbGlkKF9tZm4ocHJldl9tZm4pKSApCisgICAgcHJl
dl9tZm4gPSBnZXRfZ2ZuKGQsIGdmbl94KGdwZm4pLCAmcDJtdCk7CisgICAgaWYgKCBtZm5fdmFs
aWQocHJldl9tZm4pICkKICAgICB7CiAgICAgICAgIGlmICggaXNfeGVuX2hlYXBfbWZuKHByZXZf
bWZuKSApCiAgICAgICAgICAgICAvKiBYZW4gaGVhcCBmcmFtZXMgYXJlIHNpbXBseSB1bmhvb2tl
ZCBmcm9tIHRoaXMgcGh5cyBzbG90LiAqLwotICAgICAgICAgICAgcmMgPSBndWVzdF9waHlzbWFw
X3JlbW92ZV9wYWdlKGQsIGdwZm4sIF9tZm4ocHJldl9tZm4pLCBQQUdFX09SREVSXzRLKTsKKyAg
ICAgICAgICAgIHJjID0gZ3Vlc3RfcGh5c21hcF9yZW1vdmVfcGFnZShkLCBncGZuLCBwcmV2X21m
biwgUEFHRV9PUkRFUl80Syk7CiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIC8qIE5vcm1hbCBk
b21haW4gbWVtb3J5IGlzIGZyZWVkLCB0byBhdm9pZCBsZWFraW5nIG1lbW9yeS4gKi8KICAgICAg
ICAgICAgIHJjID0gZ3Vlc3RfcmVtb3ZlX3BhZ2UoZCwgZ2ZuX3goZ3BmbikpOwpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L21tL3AybS5jIGIveGVuL2FyY2gveDg2L21tL3AybS5jCmluZGV4IDI3
OTI3ODcxNWUuLmUwM2YwYWU2MzAgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwor
KysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLmMKQEAgLTI5NzAsNyArMjk3MCw3IEBAIGludCBwMm1f
YWRkX2ZvcmVpZ24oc3RydWN0IGRvbWFpbiAqdGRvbSwgdW5zaWduZWQgbG9uZyBmZ2ZuLAogICAg
IHByZXZfbWZuID0gZ2V0X2dmbih0ZG9tLCBncGZuLCAmcDJtdF9wcmV2KTsKICAgICBpZiAoIG1m
bl92YWxpZChwcmV2X21mbikgKQogICAgIHsKLSAgICAgICAgaWYgKCBpc194ZW5faGVhcF9tZm4o
bWZuX3gocHJldl9tZm4pKSApCisgICAgICAgIGlmICggaXNfeGVuX2hlYXBfbWZuKHByZXZfbWZu
KSApCiAgICAgICAgICAgICAvKiBYZW4gaGVhcCBmcmFtZXMgYXJlIHNpbXBseSB1bmhvb2tlZCBm
cm9tIHRoaXMgcGh5cyBzbG90ICovCiAgICAgICAgICAgICByYyA9IGd1ZXN0X3BoeXNtYXBfcmVt
b3ZlX3BhZ2UodGRvbSwgX2dmbihncGZuKSwgcHJldl9tZm4sIDApOwogICAgICAgICBlbHNlCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vc2hhZG93L211bHRpLmMgYi94ZW4vYXJjaC94ODYv
bW0vc2hhZG93L211bHRpLmMKaW5kZXggNzQ2ODFiYTg1Yy4uMjY3OThiMzE3YyAxMDA2NDQKLS0t
IGEveGVuL2FyY2gveDg2L21tL3NoYWRvdy9tdWx0aS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9z
aGFkb3cvbXVsdGkuYwpAQCAtNTU5LDcgKzU1OSw3IEBAIF9zaF9wcm9wYWdhdGUoc3RydWN0IHZj
cHUgKnYsCiAgICAgICogY2FjaGluZyBhdHRyaWJ1dGVzIGluIHRoZSBzaGFkb3dzIHRvIG1hdGNo
IHdoYXQgd2FzIGFza2VkIGZvci4KICAgICAgKi8KICAgICBpZiAoIChsZXZlbCA9PSAxKSAmJiBp
c19odm1fZG9tYWluKGQpICYmCi0gICAgICAgICAhaXNfeGVuX2hlYXBfbWZuKG1mbl94KHRhcmdl
dF9tZm4pKSApCisgICAgICAgICAhaXNfeGVuX2hlYXBfbWZuKHRhcmdldF9tZm4pICkKICAgICB7
CiAgICAgICAgIGludCB0eXBlOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3BhZ2VfYWxsb2Mu
YyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCmluZGV4IDcxZTI0ZGJiMmQuLjA0YzlkYzBjNjUg
MTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCisrKyBiL3hlbi9jb21tb24vcGFn
ZV9hbGxvYy5jCkBAIC0yMTA0LDkgKzIxMDQsOSBAQCB2b2lkIGluaXRfeGVuaGVhcF9wYWdlcyhw
YWRkcl90IHBzLCBwYWRkcl90IHBlKQogICAgICAqIFl1ayEgRW5zdXJlIHRoZXJlIGlzIGEgb25l
LXBhZ2UgYnVmZmVyIGJldHdlZW4gWGVuIGFuZCBEb20gem9uZXMsIHRvCiAgICAgICogcHJldmVu
dCBtZXJnaW5nIG9mIHBvd2VyLW9mLXR3byBibG9ja3MgYWNyb3NzIHRoZSB6b25lIGJvdW5kYXJ5
LgogICAgICAqLwotICAgIGlmICggcHMgJiYgIWlzX3hlbl9oZWFwX21mbihwYWRkcl90b19wZm4o
cHMpLTEpICkKKyAgICBpZiAoIHBzICYmICFpc194ZW5faGVhcF9tZm4obWZuX2FkZChtYWRkcl90
b19tZm4ocHMpLCAtMSkpICkKICAgICAgICAgcHMgKz0gUEFHRV9TSVpFOwotICAgIGlmICggIWlz
X3hlbl9oZWFwX21mbihwYWRkcl90b19wZm4ocGUpKSApCisgICAgaWYgKCAhaXNfeGVuX2hlYXBf
bWZuKG1hZGRyX3RvX21mbihwZSkpICkKICAgICAgICAgcGUgLT0gUEFHRV9TSVpFOwogCiAgICAg
bWVtZ3VhcmRfZ3VhcmRfcmFuZ2UobWFkZHJfdG9fdmlydChwcyksIHBlIC0gcHMpOwpkaWZmIC0t
Z2l0IGEveGVuL2luY2x1ZGUvYXNtLWFybS9tbS5oIGIveGVuL2luY2x1ZGUvYXNtLWFybS9tbS5o
CmluZGV4IGI1NjAxOGFhY2UuLmE5YzgzNTJiOTQgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2Fz
bS1hcm0vbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL21tLmgKQEAgLTEzOCwxNiArMTM4
LDE2IEBAIGV4dGVybiB2YWRkcl90IHhlbmhlYXBfdmlydF9zdGFydDsKICNlbmRpZgogCiAjaWZk
ZWYgQ09ORklHX0FSTV8zMgotI2RlZmluZSBpc194ZW5faGVhcF9wYWdlKHBhZ2UpIGlzX3hlbl9o
ZWFwX21mbihtZm5feChwYWdlX3RvX21mbihwYWdlKSkpCisjZGVmaW5lIGlzX3hlbl9oZWFwX3Bh
Z2UocGFnZSkgaXNfeGVuX2hlYXBfbWZuKHBhZ2VfdG9fbWZuKHBhZ2UpKQogI2RlZmluZSBpc194
ZW5faGVhcF9tZm4obWZuKSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAg
ICB1bnNpZ25lZCBsb25nIG1mbl8gPSAobWZuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCisgICAgdW5zaWduZWQgbG9uZyBtZm5fID0gbWZuX3gobWZuKTsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAogICAgIChtZm5fID49IG1mbl94KHhlbmhlYXBfbWZuX3N0YXJ0KSAm
JiAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgbWZuXyA8IG1mbl94KHhlbmhlYXBfbWZu
X2VuZCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiB9KQogI2Vsc2UKICNkZWZpbmUg
aXNfeGVuX2hlYXBfcGFnZShwYWdlKSAoKHBhZ2UpLT5jb3VudF9pbmZvICYgUEdDX3hlbl9oZWFw
KQogI2RlZmluZSBpc194ZW5faGVhcF9tZm4obWZuKSBcCi0gICAgKG1mbl92YWxpZChfbWZuKG1m
bikpICYmIGlzX3hlbl9oZWFwX3BhZ2UobWZuX3RvX3BhZ2UoX21mbihtZm4pKSkpCisgICAgKG1m
bl92YWxpZChtZm4pICYmIGlzX3hlbl9oZWFwX3BhZ2UobWZuX3RvX3BhZ2UobWZuKSkpCiAjZW5k
aWYKIAogI2RlZmluZSBpc194ZW5fZml4ZWRfbWZuKG1mbikgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKQEAgLTI0Niw3ICsyNDYsNyBAQCBzdGF0aWMgaW5saW5lIHBhZGRyX3Qg
X192aXJ0X3RvX21hZGRyKHZhZGRyX3QgdmEpCiAjaWZkZWYgQ09ORklHX0FSTV8zMgogc3RhdGlj
IGlubGluZSB2b2lkICptYWRkcl90b192aXJ0KHBhZGRyX3QgbWEpCiB7Ci0gICAgQVNTRVJUKGlz
X3hlbl9oZWFwX21mbihtYSA+PiBQQUdFX1NISUZUKSk7CisgICAgQVNTRVJUKGlzX3hlbl9oZWFw
X21mbihtYWRkcl90b19tZm4obWEpKSk7CiAgICAgbWEgLT0gbWZuX3RvX21hZGRyKHhlbmhlYXBf
bWZuX3N0YXJ0KTsKICAgICByZXR1cm4gKHZvaWQgKikodW5zaWduZWQgbG9uZykgbWEgKyBYRU5I
RUFQX1ZJUlRfU1RBUlQ7CiB9CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgg
Yi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKaW5kZXggMGQ5NTRlMWJkOC4uZTQyMGQ4ODEzNyAx
MDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCisrKyBiL3hlbi9pbmNsdWRlL2Fz
bS14ODYvbW0uaApAQCAtMjc4LDcgKzI3OCw3IEBAIHN0cnVjdCBwYWdlX2luZm8KIAogI2RlZmlu
ZSBpc194ZW5faGVhcF9wYWdlKHBhZ2UpICgocGFnZSktPmNvdW50X2luZm8gJiBQR0NfeGVuX2hl
YXApCiAjZGVmaW5lIGlzX3hlbl9oZWFwX21mbihtZm4pIFwKLSAgICAoX19tZm5fdmFsaWQobWZu
KSAmJiBpc194ZW5faGVhcF9wYWdlKG1mbl90b19wYWdlKF9tZm4obWZuKSkpKQorICAgIChtZm5f
dmFsaWQobWZuKSAmJiBpc194ZW5faGVhcF9wYWdlKG1mbl90b19wYWdlKG1mbikpKQogI2RlZmlu
ZSBpc194ZW5fZml4ZWRfbWZuKG1mbikgICAgICAgICAgICAgICAgICAgICBcCiAgICAgKCgobWZu
X3RvX21hZGRyKG1mbikpID49IF9fcGEoJl9zdGV4dCkpICYmICAgIFwKICAgICAgKChtZm5fdG9f
bWFkZHIobWZuKSkgPD0gX19wYSgmX18yTV9yd2RhdGFfZW5kKSkpCi0tIAoyLjExLjAKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

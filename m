Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id BADE0C458B
	for <lists+xen-devel@lfdr.de>; Wed,  2 Oct 2019 03:28:42 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iFTP1-0006FA-FF; Wed, 02 Oct 2019 01:26:03 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=7bij=X3=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1iFTOz-0006EA-OB
 for xen-devel@lists.xenproject.org; Wed, 02 Oct 2019 01:26:01 +0000
X-Inumbo-ID: 97c41646-e4b3-11e9-bf31-bc764e2007e4
Received: from mail.kernel.org (unknown [198.145.29.99])
 by localhost (Halon) with ESMTPS
 id 97c41646-e4b3-11e9-bf31-bc764e2007e4;
 Wed, 02 Oct 2019 01:26:01 +0000 (UTC)
Received: from localhost (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256
 bits)) (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 1650D20818;
 Wed,  2 Oct 2019 01:26:00 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1569979560;
 bh=ci8zJC3KyY879QMa81K4rBlioQVKqmNwm5BqedFACvQ=;
 h=Date:From:To:cc:Subject:In-Reply-To:References:From;
 b=HZFYCzOZuATwXi/sGqFI9G6sN3vmPZ7MisoBHOlmAyNm7yee5GPltc+O6JA9xRWYi
 E0IJiAixIBg6RZ0QUbvGvYOTmwoXKMW8k+LnbXxOM13W1xVGohTW1tu8RM7z29BGOD
 FKzqvIeKKsb5xMg0PYaXbGwL4dQZbKYEb7c9L5U8=
Date: Tue, 1 Oct 2019 18:25:59 -0700 (PDT)
From: Stefano Stabellini <sstabellini@kernel.org>
X-X-Sender: sstabellini@sstabellini-ThinkPad-T480s
To: Julien Grall <julien.grall@arm.com>
In-Reply-To: <20190805132955.1630-2-julien.grall@arm.com>
Message-ID: <alpine.DEB.2.21.1910011825490.26319@sstabellini-ThinkPad-T480s>
References: <20190805132955.1630-1-julien.grall@arm.com>
 <20190805132955.1630-2-julien.grall@arm.com>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
Subject: Re: [Xen-devel] [PATCH v2 1/4] xen/console: Don't treat NUL
 character as the end of the buffer
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Jan Beulich <jbeulich@suse.com>, xen-devel@lists.xenproject.org,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gTW9uLCA1IEF1ZyAyMDE5LCBKdWxpZW4gR3JhbGwgd3JvdGU6Cj4gQWZ0ZXIgdXBncmFkaW5n
IERlYmlhbiB0byBCdXN0ZXIsIEkgaGF2ZSBiZWdhbiB0byBub3RpY2UgY29uc29sZQo+IG1hbmds
aW5nIHdoZW4gdXNpbmcgenNoIGluIERvbTAuIFRoaXMgaXMgaGFwcGVubmluZyBiZWNhdXNlIG91
dHB1dCBzZW50IGJ5Cj4genNoIHRvIHRoZSBjb25zb2xlIG1heSBjb250YWluIE5VTHMgaW4gdGhl
IG1pZGRsZSBvZiB0aGUgYnVmZmVyLgo+IAo+IFRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24gb2Yg
Q09OU09MRUlPX3dyaXRlIGNvbnNpZGVycyB0aGF0IGEgYnVmZmVyCj4gYWx3YXlzIHRlcm1pbmF0
ZSB3aXRoIGEgTlVMIGFuZCB0aGVyZWZvcmUgd2lsbCBpZ25vcmUgYW55dGhpbmcgYWZ0ZXIgaXQu
Cj4gCj4gSW4gZ2VuZXJhbCwgTlVMcyBhcmUgcGVyZmVjdGx5IGxlZ2l0aW1hdGUgaW4gdGVybWlu
YWwgc3RyZWFtcy4gRm9yCj4gaW5zdGFuY2UsIHRoaXMgY291bGQgYmUgdXNlZCBmb3IgcGFkZGlu
ZyBzbG93IHRlcm1pbmFscy4gU2VlIHRlcm1pbmZvKDUpCj4gc2VjdGlvbiBgRGVsYXlzIGFuZCBQ
YWRkaW5nYCwgb3Igc2VhcmNoIGZvciB0aGUgcGNyZSAnXGJwYWQnLgo+IAo+IE90aGVyIHVzZSBj
YXNlcyBpbmNsdWRlcyB1c2luZyB0aGUgY29uc29sZSBmb3IgZHVtcGluZyBub24taHVtYW4KPiBy
ZWFkYWJsZSBpbmZvcm1hdGlvbiAoZS5nIGRlYnVnZ2VyLCBmaWxlIGlmIG5vIG5ldHdvcmsuLi4p
LiBXaXRoIHRoZQo+IGN1cnJlbnQgYmVoYXZpb3IsIHRoZSByZXN1bHRpbmcgc3RyZWFtIHdpbGwg
ZW5kIHVwIHRvIGJlIGNvcnJ1cHRlZC4KPiAKPiBUaGUgZG9jdW1lbnRhdGlvbiBmb3IgQ09OU09M
RUlPX3dyaXRlIGlzIHByZXR0eSBsaW1pdGVkICh0byBub3Qgc2F5Cj4gaW5leGlzdGVudCkuIEZy
b20gdGhlIGRlY2xhcmF0aW9uLCB0aGUgaHlwZXJjYWxsIHRha2VzIGEgYnVmZmVyIGFuZCBzaXpl
Lgo+IFNvIHRoaXMgY291bGQgbGVhZCB0byB0aGluayB0aGUgTlVMIGNoYXJhY3RlciBpcyBhbGxv
d2VkIGluIHRoZSBtaWRkbGUgb2YKPiB0aGUgYnVmZmVyLgo+IAo+IFRoaXMgcGF0Y2ggdXBkYXRl
cyB0aGUgY29uc29sZSBBUEkgdG8gcGFzcyB0aGUgc2l6ZSBhbG9uZyB0aGUgYnVmZmVyCj4gZG93
biBzbyB3ZSBjYW4gcmVtb3ZlIHRoZSByZWxpYW5jZSBvbiBidWZmZXIgdGVybWluYXRpbmcgYnkg
YSBOVUwKPiBjaGFyYWN0ZXIuCj4gCj4gU2lnbmVkLW9mZi1ieTogSnVsaWVuIEdyYWxsIDxqdWxp
ZW4uZ3JhbGxAYXJtLmNvbT4KPiAKPiAtLS0KPiAKPiBUaGlzIHBhdGNoIHdhcyBvcmlnaW5hbGx5
IHNlbnQgc3RhbmRhbG9uZSBbMV0uIEJ1dCB0aGUgc2VyaWVzIGdyb3dzIHRvCj4gaW5jbHVkZSBh
bm90aGVyIGJ1ZyBmb3VuZCBpbiB0aGUgY29uc29sZSBjb2RlIGFuZCBkb2N1bWVudGF0aW9uLgo+
IAo+IENuaGFuZ2VzIGluIHYyOgo+ICAgICAtIFN3aXRjaCBmcm9tIHVuc2lnbmVkIGludCB0byBz
aXplX3QuIFNvIHRydW5jYXRpb24gaXMgYXZvaWRlZC4gV2UKPiAgICAgY2FuIGRlY2lkZSB3aGV0
aGVyIHdlIHdhbnQgZXhwbGljaXQgdHJ1bmNhdGlvbiBsYXRlciBvbi4KPiAgICAgLSBSZW1vdmUg
dW5lY2Vzc2FyeSBsZWFkaW5nIE5VTCBhZGRlZCBpbiBkdW1wX2NvbnNvbGVfcmluZ19rZXkKPiAg
ICAgLSBSZW1vdmUgdW5lY2Vzc2FyeSBkZWNvcmF0aW9uIGluIHNlcmNvbl9wdXRzCj4gICAgIC0g
Rml4IGxvb3AgaW4gbGZiX3Njcm9sbF9wdXRzCj4gICAgIC0gdXNlIHdoaWxlKCkgcmF0aGVyIHRo
YW4gZG8ge30gd2hpbGUoKQo+IAo+IENoYW5nZSBzaW5jZSB0aGUgc3RhbmRhbG9uZSB2ZXJzaW9u
Ogo+ICAgICAtIEZpeCBlYXJseSBwcmludGsgb24gQXJtCj4gICAgIC0gRml4IGdkYnN0dWIKPiAg
ICAgLSBSZW1vdmUgdW5lY2Vzc2FyeSBsZWFkaW5nIE5VTCBjaGFyYWN0ZXIgYWRkZWQgYnkgWGVu
Cj4gICAgIC0gSGFuZGxlIERvbVUgY29uc29sZQo+ICAgICAtIFJld29yayB0aGUgY29tbWl0IG1l
c3NhZ2UKPiAKPiBCZWxvdyBhIHNtYWxsIEMgcHJvZ3JhbSB0byByZXBybyB0aGUgYnVnIG9uIFhl
bjoKPiAKPiBpbnQgbWFpbih2b2lkKQo+IHsKPiAgICAgd3JpdGUoMSwKPiAgICAgICAgICAgIlxy
XDMzWzBtXDBcMFwwXDBcMFwwXDBcMFwzM1syN21cMzNbMjRtXDMzW2pcMzNbMzJtanVsaWVuXDMz
WzMxbUBcMzNbMDBtXDMzWzM2bWp1bm8yLWp1bGllbmc6flwzM1szN20+IiwKPiAgICAgICAgICAg
NzUpOwo+ICAgICB3cml0ZSgxLAo+ICAgICAgICAgICAiXDMzW0tcMzNbMzJDXDMzWzAxOzMzbS0t
anVubzItanVsaWVuZy0xMzo0NC0tXDMzWzAwbVwzM1szN21cMzNbNTVEIiwKPiAgICAgICAgICAg
NTQpOwo+ICAgICB3cml0ZSgxLCAiXDMzWz8yMDA0aCIsIDgpOwo+IAo+ICAgICByZXR1cm4gMDsK
PiB9Cj4gCj4gV2l0aG91dCB0aGlzIHBhdGNoLCB0aGUgb25seSAtLWp1bm8yLWp1bGllbmctMTM6
NDQtLSB3aWxsIGJlIHByaW50ZWQgaW4KPiB5ZWxsb3cuCj4gCj4gVGhpcyBwYXRjaCB3YXMgdGVz
dGVkIG9uIEFybSB1c2luZyBzZXJpYWwgY29uc29sZS4gSSBhbSBub3QgZW50aXJlbHkKPiBzdXJl
IHdoZXRoZXIgdGhlIHZpZGVvIGFuZCBQViBjb25zb2xlIGlzIGNvcnJlY3QuIEkgd291bGQgYXBw
cmVjaWF0ZSBoZWxwCj4gZm9yIHRlc3RpbmcgaGVyZS4KPiAKPiBbMV0gaHR0cHM6Ly9saXN0cy54
ZW5wcm9qZWN0Lm9yZy9hcmNoaXZlcy9odG1sL3hlbi1kZXZlbC8yMDE5LTAyL21zZzAxOTMyLmh0
bWwKCkFja2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+
CgoKPiAtLS0KPiAgeGVuL2FyY2gvYXJtL2Vhcmx5X3ByaW50ay5jICAgICAgIHwgIDUgKystLQo+
ICB4ZW4vY29tbW9uL2dkYnN0dWIuYyAgICAgICAgICAgICAgfCAgNiArKy0tCj4gIHhlbi9kcml2
ZXJzL2NoYXIvY29uc29sZS5jICAgICAgICB8IDU5ICsrKysrKysrKysrKysrKysrKystLS0tLS0t
LS0tLS0tLS0tLS0tLQo+ICB4ZW4vZHJpdmVycy9jaGFyL2NvbnNvbGVkLmMgICAgICAgfCAgNyAr
Ky0tLQo+ICB4ZW4vZHJpdmVycy9jaGFyL3NlcmlhbC5jICAgICAgICAgfCAgNyArKystLQo+ICB4
ZW4vZHJpdmVycy9jaGFyL3hlbl9wdl9jb25zb2xlLmMgfCAxMCArKystLS0tCj4gIHhlbi9kcml2
ZXJzL3ZpZGVvL2xmYi5jICAgICAgICAgICB8IDE0ICsrKysrKy0tLS0KPiAgeGVuL2RyaXZlcnMv
dmlkZW8vbGZiLmggICAgICAgICAgIHwgIDQgKy0tCj4gIHhlbi9kcml2ZXJzL3ZpZGVvL3ZnYS5j
ICAgICAgICAgICB8IDE0ICsrKysrLS0tLS0KPiAgeGVuL2luY2x1ZGUveGVuL2NvbnNvbGUuaCAg
ICAgICAgIHwgIDIgKy0KPiAgeGVuL2luY2x1ZGUveGVuL2Vhcmx5X3ByaW50ay5oICAgIHwgIDIg
Ky0KPiAgeGVuL2luY2x1ZGUveGVuL3B2X2NvbnNvbGUuaCAgICAgIHwgIDQgKy0tCj4gIHhlbi9p
bmNsdWRlL3hlbi9zZXJpYWwuaCAgICAgICAgICB8ICA0ICstLQo+ICB4ZW4vaW5jbHVkZS94ZW4v
dmlkZW8uaCAgICAgICAgICAgfCAgNCArLS0KPiAgMTQgZmlsZXMgY2hhbmdlZCwgNzEgaW5zZXJ0
aW9ucygrKSwgNzEgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9l
YXJseV9wcmludGsuYyBiL3hlbi9hcmNoL2FybS9lYXJseV9wcmludGsuYwo+IGluZGV4IDk3NDY2
YTEyYjEuLjMzMzA3M2Q5N2UgMTAwNjQ0Cj4gLS0tIGEveGVuL2FyY2gvYXJtL2Vhcmx5X3ByaW50
ay5jCj4gKysrIGIveGVuL2FyY2gvYXJtL2Vhcmx5X3ByaW50ay5jCj4gQEAgLTE3LDkgKzE3LDEw
IEBACj4gIHZvaWQgZWFybHlfcHV0Y2goY2hhciBjKTsKPiAgdm9pZCBlYXJseV9mbHVzaCh2b2lk
KTsKPiAgCj4gLXZvaWQgZWFybHlfcHV0cyhjb25zdCBjaGFyICpzKQo+ICt2b2lkIGVhcmx5X3B1
dHMoY29uc3QgY2hhciAqcywgc2l6ZV90IG5yKQo+ICB7Cj4gLSAgICB3aGlsZSAoKnMgIT0gJ1ww
Jykgewo+ICsgICAgd2hpbGUgKCBuci0tID4gMCApCj4gKyAgICB7Cj4gICAgICAgICAgaWYgKCpz
ID09ICdcbicpCj4gICAgICAgICAgICAgIGVhcmx5X3B1dGNoKCdccicpOwo+ICAgICAgICAgIGVh
cmx5X3B1dGNoKCpzKTsKPiBkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9nZGJzdHViLmMgYi94ZW4v
Y29tbW9uL2dkYnN0dWIuYwo+IGluZGV4IDA3MDk1ZTFlYzcuLjYyMzQ4MzRhMjAgMTAwNjQ0Cj4g
LS0tIGEveGVuL2NvbW1vbi9nZGJzdHViLmMKPiArKysgYi94ZW4vY29tbW9uL2dkYnN0dWIuYwo+
IEBAIC02OCw3ICs2OCw3IEBAIHN0YXRpYyB2b2lkIGdkYl9zbXBfcmVzdW1lKHZvaWQpOwo+ICBz
dGF0aWMgY2hhciBfX2luaXRkYXRhIG9wdF9nZGJbMzBdOwo+ICBzdHJpbmdfcGFyYW0oImdkYiIs
IG9wdF9nZGIpOwo+ICAKPiAtc3RhdGljIHZvaWQgZ2Ric3R1Yl9jb25zb2xlX3B1dHMoY29uc3Qg
Y2hhciAqc3RyKTsKPiArc3RhdGljIHZvaWQgZ2Ric3R1Yl9jb25zb2xlX3B1dHMoY29uc3QgY2hh
ciAqc3RyLCBzaXplX3QgbnIpOwo+ICAKPiAgLyogdmFsdWUgPC0+IGNoYXIgKGRlKXNlcmlhbHpl
cnMgKi8KPiAgc3RhdGljIGNoYXIKPiBAQCAtNTQ2LDE0ICs1NDYsMTQgQEAgX19nZGJfY3R4ID0g
ewo+ICBzdGF0aWMgc3RydWN0IGdkYl9jb250ZXh0ICpnZGJfY3R4ID0gJl9fZ2RiX2N0eDsKPiAg
Cj4gIHN0YXRpYyB2b2lkCj4gLWdkYnN0dWJfY29uc29sZV9wdXRzKGNvbnN0IGNoYXIgKnN0cikK
PiArZ2Ric3R1Yl9jb25zb2xlX3B1dHMoY29uc3QgY2hhciAqc3RyLCBzaXplX3QgbnIpCj4gIHsK
PiAgICAgIGNvbnN0IGNoYXIgKnA7Cj4gIAo+ICAgICAgZ2RiX3N0YXJ0X3BhY2tldChnZGJfY3R4
KTsKPiAgICAgIGdkYl93cml0ZV90b19wYWNrZXRfY2hhcignTycsIGdkYl9jdHgpOwo+ICAKPiAt
ICAgIGZvciAoIHAgPSBzdHI7ICpwICE9ICdcMCc7IHArKyApCj4gKyAgICBmb3IgKCBwID0gc3Ry
OyBuciA+IDA7IHArKywgbnItLSApCj4gICAgICB7Cj4gICAgICAgICAgZ2RiX3dyaXRlX3RvX3Bh
Y2tldF9jaGFyKGhleDJjaGFyKCgqcD4+NCkgJiAweDBmKSwgZ2RiX2N0eCApOwo+ICAgICAgICAg
IGdkYl93cml0ZV90b19wYWNrZXRfY2hhcihoZXgyY2hhcigoKnApICYgMHgwZiksIGdkYl9jdHgg
KTsKPiBkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvY2hhci9jb25zb2xlLmMgYi94ZW4vZHJpdmVy
cy9jaGFyL2NvbnNvbGUuYwo+IGluZGV4IGQ3MjhlNzM3ZDEuLjc1MmExMWY2YzUgMTAwNjQ0Cj4g
LS0tIGEveGVuL2RyaXZlcnMvY2hhci9jb25zb2xlLmMKPiArKysgYi94ZW4vZHJpdmVycy9jaGFy
L2NvbnNvbGUuYwo+IEBAIC0zMjYsOSArMzI2LDkgQEAgbG9uZyByZWFkX2NvbnNvbGVfcmluZyhz
dHJ1Y3QgeGVuX3N5c2N0bF9yZWFkY29uc29sZSAqb3ApCj4gIHN0YXRpYyBjaGFyIHNlcmlhbF9y
eF9yaW5nW1NFUklBTF9SWF9TSVpFXTsKPiAgc3RhdGljIHVuc2lnbmVkIGludCBzZXJpYWxfcnhf
Y29ucywgc2VyaWFsX3J4X3Byb2Q7Cj4gIAo+IC1zdGF0aWMgdm9pZCAoKnNlcmlhbF9zdGVhbF9m
bikoY29uc3QgY2hhciAqKSA9IGVhcmx5X3B1dHM7Cj4gK3N0YXRpYyB2b2lkICgqc2VyaWFsX3N0
ZWFsX2ZuKShjb25zdCBjaGFyICosIHNpemVfdCBucikgPSBlYXJseV9wdXRzOwo+ICAKPiAtaW50
IGNvbnNvbGVfc3RlYWwoaW50IGhhbmRsZSwgdm9pZCAoKmZuKShjb25zdCBjaGFyICopKQo+ICtp
bnQgY29uc29sZV9zdGVhbChpbnQgaGFuZGxlLCB2b2lkICgqZm4pKGNvbnN0IGNoYXIgKiwgc2l6
ZV90IG5yKSkKPiAgewo+ICAgICAgaWYgKCAoaGFuZGxlID09IC0xKSB8fCAoaGFuZGxlICE9IHNl
cmNvbl9oYW5kbGUpICkKPiAgICAgICAgICByZXR1cm4gMDsKPiBAQCAtMzQ2LDE1ICszNDYsMTUg
QEAgdm9pZCBjb25zb2xlX2dpdmViYWNrKGludCBpZCkKPiAgICAgICAgICBzZXJpYWxfc3RlYWxf
Zm4gPSBOVUxMOwo+ICB9Cj4gIAo+IC1zdGF0aWMgdm9pZCBzZXJjb25fcHV0cyhjb25zdCBjaGFy
ICpzKQo+ICtzdGF0aWMgdm9pZCBzZXJjb25fcHV0cyhjb25zdCBjaGFyICpzLCBzaXplX3QgbnIp
Cj4gIHsKPiAgICAgIGlmICggc2VyaWFsX3N0ZWFsX2ZuICE9IE5VTEwgKQo+IC0gICAgICAgICgq
c2VyaWFsX3N0ZWFsX2ZuKShzKTsKPiArICAgICAgICBzZXJpYWxfc3RlYWxfZm4ocywgbnIpOwo+
ICAgICAgZWxzZQo+IC0gICAgICAgIHNlcmlhbF9wdXRzKHNlcmNvbl9oYW5kbGUsIHMpOwo+ICsg
ICAgICAgIHNlcmlhbF9wdXRzKHNlcmNvbl9oYW5kbGUsIHMsIG5yKTsKPiAgCj4gICAgICAvKiBD
b3B5IGFsbCBzZXJpYWwgb3V0cHV0IGludG8gUFYgY29uc29sZSAqLwo+IC0gICAgcHZfY29uc29s
ZV9wdXRzKHMpOwo+ICsgICAgcHZfY29uc29sZV9wdXRzKHMsIG5yKTsKPiAgfQo+ICAKPiAgc3Rh
dGljIHZvaWQgZHVtcF9jb25zb2xlX3Jpbmdfa2V5KHVuc2lnbmVkIGNoYXIga2V5KQo+IEBAIC0z
ODcsMTAgKzM4Nyw5IEBAIHN0YXRpYyB2b2lkIGR1bXBfY29uc29sZV9yaW5nX2tleSh1bnNpZ25l
ZCBjaGFyIGtleSkKPiAgICAgICAgICBzb2ZhciArPSBsZW47Cj4gICAgICAgICAgYyArPSBsZW47
Cj4gICAgICB9Cj4gLSAgICBidWZbc29mYXJdID0gJ1wwJzsKPiAgCj4gLSAgICBzZXJjb25fcHV0
cyhidWYpOwo+IC0gICAgdmlkZW9fcHV0cyhidWYpOwo+ICsgICAgc2VyY29uX3B1dHMoYnVmLCBz
b2Zhcik7Cj4gKyAgICB2aWRlb19wdXRzKGJ1Ziwgc29mYXIpOwo+ICAKPiAgICAgIGZyZWVfeGVu
aGVhcF9wYWdlcyhidWYsIG9yZGVyKTsKPiAgfQo+IEBAIC01MjgsNyArNTI3LDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIHhlbl9jb25zb2xlX3dyaXRlX2RlYnVnX3BvcnQoY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgbGVuKQo+ICBzdGF0aWMgbG9uZyBndWVzdF9jb25zb2xlX3dyaXRlKFhFTl9HVUVT
VF9IQU5ETEVfUEFSQU0oY2hhcikgYnVmZmVyLCBpbnQgY291bnQpCj4gIHsKPiAgICAgIGNoYXIg
a2J1ZlsxMjhdOwo+IC0gICAgaW50IGtjb3VudCA9IDA7Cj4gKyAgICB1bnNpZ25lZCBpbnQga2Nv
dW50ID0gMDsKPiAgICAgIHN0cnVjdCBkb21haW4gKmNkID0gY3VycmVudC0+ZG9tYWluOwo+ICAK
PiAgICAgIHdoaWxlICggY291bnQgPiAwICkKPiBAQCAtNTQxLDI1ICs1NDAsMjIgQEAgc3RhdGlj
IGxvbmcgZ3Vlc3RfY29uc29sZV93cml0ZShYRU5fR1VFU1RfSEFORExFX1BBUkFNKGNoYXIpIGJ1
ZmZlciwgaW50IGNvdW50KQo+ICAgICAgICAgIGtjb3VudCA9IG1pbl90KGludCwgY291bnQsIHNp
emVvZihrYnVmKS0xKTsKPiAgICAgICAgICBpZiAoIGNvcHlfZnJvbV9ndWVzdChrYnVmLCBidWZm
ZXIsIGtjb3VudCkgKQo+ICAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsKPiAtICAgICAgICBr
YnVmW2tjb3VudF0gPSAnXDAnOwo+ICAKPiAgICAgICAgICBpZiAoIGlzX2hhcmR3YXJlX2RvbWFp
bihjZCkgKQo+ICAgICAgICAgIHsKPiAgICAgICAgICAgICAgLyogVXNlIGRpcmVjdCBjb25zb2xl
IG91dHB1dCBhcyBpdCBjb3VsZCBiZSBpbnRlcmFjdGl2ZSAqLwo+ICAgICAgICAgICAgICBzcGlu
X2xvY2tfaXJxKCZjb25zb2xlX2xvY2spOwo+ICAKPiAtICAgICAgICAgICAgc2VyY29uX3B1dHMo
a2J1Zik7Cj4gLSAgICAgICAgICAgIHZpZGVvX3B1dHMoa2J1Zik7Cj4gKyAgICAgICAgICAgIHNl
cmNvbl9wdXRzKGtidWYsIGtjb3VudCk7Cj4gKyAgICAgICAgICAgIHZpZGVvX3B1dHMoa2J1Ziwg
a2NvdW50KTsKPiAgCj4gICNpZmRlZiBDT05GSUdfWDg2Cj4gICAgICAgICAgICAgIGlmICggb3B0
X2NvbnNvbGVfeGVuICkKPiAgICAgICAgICAgICAgewo+IC0gICAgICAgICAgICAgICAgc2l6ZV90
IGxlbiA9IHN0cmxlbihrYnVmKTsKPiAtCj4gICAgICAgICAgICAgICAgICBpZiAoIHhlbl9ndWVz
dCApCj4gLSAgICAgICAgICAgICAgICAgICAgeGVuX2h5cGVyY2FsbF9jb25zb2xlX3dyaXRlKGti
dWYsIGxlbik7Cj4gKyAgICAgICAgICAgICAgICAgICAgeGVuX2h5cGVyY2FsbF9jb25zb2xlX3dy
aXRlKGtidWYsIGtjb3VudCk7Cj4gICAgICAgICAgICAgICAgICBlbHNlCj4gLSAgICAgICAgICAg
ICAgICAgICAgeGVuX2NvbnNvbGVfd3JpdGVfZGVidWdfcG9ydChrYnVmLCBsZW4pOwo+ICsgICAg
ICAgICAgICAgICAgICAgIHhlbl9jb25zb2xlX3dyaXRlX2RlYnVnX3BvcnQoa2J1Ziwga2NvdW50
KTsKPiAgICAgICAgICAgICAgfQo+ICAjZW5kaWYKPiAgCj4gQEAgLTU3NiwxOSArNTcyLDIwIEBA
IHN0YXRpYyBsb25nIGd1ZXN0X2NvbnNvbGVfd3JpdGUoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTShj
aGFyKSBidWZmZXIsIGludCBjb3VudCkKPiAgICAgICAgICAgICAgY2hhciAqa2luID0ga2J1Ziwg
KmtvdXQgPSBrYnVmLCBjOwo+ICAKPiAgICAgICAgICAgICAgLyogU3RyaXAgbm9uLXByaW50YWJs
ZSBjaGFyYWN0ZXJzICovCj4gLSAgICAgICAgICAgIGZvciAoIDsgOyApCj4gKyAgICAgICAgICAg
IGRvCj4gICAgICAgICAgICAgIHsKPiAgICAgICAgICAgICAgICAgIGMgPSAqa2luKys7Cj4gLSAg
ICAgICAgICAgICAgICBpZiAoIGMgPT0gJ1wwJyB8fCBjID09ICdcbicgKQo+ICsgICAgICAgICAg
ICAgICAgaWYgKCBjID09ICdcbicgKQo+ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAg
ICAgICAgICAgICAgICAgaWYgKCBpc3ByaW50KGMpIHx8IGMgPT0gJ1x0JyApCj4gICAgICAgICAg
ICAgICAgICAgICAgKmtvdXQrKyA9IGM7Cj4gLSAgICAgICAgICAgIH0KPiArICAgICAgICAgICAg
fSB3aGlsZSAoIC0ta2NvdW50ID4gMCApOwo+ICsKPiAgICAgICAgICAgICAgKmtvdXQgPSAnXDAn
Owo+ICAgICAgICAgICAgICBzcGluX2xvY2soJmNkLT5wYnVmX2xvY2spOwo+ICsgICAgICAgICAg
ICBrY291bnQgPSBraW4gLSBrYnVmOwo+ICAgICAgICAgICAgICBpZiAoIGMgPT0gJ1xuJyApCj4g
ICAgICAgICAgICAgIHsKPiAtICAgICAgICAgICAgICAgIGtjb3VudCA9IGtpbiAtIGtidWY7Cj4g
ICAgICAgICAgICAgICAgICBjZC0+cGJ1ZltjZC0+cGJ1Zl9pZHhdID0gJ1wwJzsKPiAgICAgICAg
ICAgICAgICAgIGd1ZXN0X3ByaW50ayhjZCwgWEVOTE9HX0dfREVCVUcgIiVzJXNcbiIsIGNkLT5w
YnVmLCBrYnVmKTsKPiAgICAgICAgICAgICAgICAgIGNkLT5wYnVmX2lkeCA9IDA7Cj4gQEAgLTY2
NywxNiArNjY0LDE2IEBAIHN0YXRpYyBib29sX3QgY29uc29sZV9sb2Nrc19idXN0ZWQ7Cj4gIAo+
ICBzdGF0aWMgdm9pZCBfX3B1dHN0cihjb25zdCBjaGFyICpzdHIpCj4gIHsKPiArICAgIHNpemVf
dCBsZW4gPSBzdHJsZW4oc3RyKTsKPiArCj4gICAgICBBU1NFUlQoc3Bpbl9pc19sb2NrZWQoJmNv
bnNvbGVfbG9jaykpOwo+ICAKPiAtICAgIHNlcmNvbl9wdXRzKHN0cik7Cj4gLSAgICB2aWRlb19w
dXRzKHN0cik7Cj4gKyAgICBzZXJjb25fcHV0cyhzdHIsIGxlbik7Cj4gKyAgICB2aWRlb19wdXRz
KHN0ciwgbGVuKTsKPiAgCj4gICNpZmRlZiBDT05GSUdfWDg2Cj4gICAgICBpZiAoIG9wdF9jb25z
b2xlX3hlbiApCj4gICAgICB7Cj4gLSAgICAgICAgc2l6ZV90IGxlbiA9IHN0cmxlbihzdHIpOwo+
IC0KPiAgICAgICAgICBpZiAoIHhlbl9ndWVzdCApCj4gICAgICAgICAgICAgIHhlbl9oeXBlcmNh
bGxfY29uc29sZV93cml0ZShzdHIsIGxlbik7Cj4gICAgICAgICAgZWxzZQo+IEBAIC0xMjUwLDYg
KzEyNDcsNyBAQCB2b2lkIGRlYnVndHJhY2VfcHJpbnRrKGNvbnN0IGNoYXIgKmZtdCwgLi4uKQo+
ICAgICAgY2hhciAgICAgICAgICBjbnRidWZbMjRdOwo+ICAgICAgdmFfbGlzdCAgICAgICBhcmdz
Owo+ICAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKPiArICAgIHVuc2lnbmVkIGludCBucjsKPiAg
Cj4gICAgICBpZiAoIGRlYnVndHJhY2VfYnl0ZXMgPT0gMCApCj4gICAgICAgICAgcmV0dXJuOwo+
IEBAIC0xMjYxLDE0ICsxMjU5LDE1IEBAIHZvaWQgZGVidWd0cmFjZV9wcmludGsoY29uc3QgY2hh
ciAqZm10LCAuLi4pCj4gICAgICBBU1NFUlQoZGVidWd0cmFjZV9idWZbZGVidWd0cmFjZV9ieXRl
cyAtIDFdID09IDApOwo+ICAKPiAgICAgIHZhX3N0YXJ0KGFyZ3MsIGZtdCk7Cj4gLSAgICB2c25w
cmludGYoYnVmLCBzaXplb2YoYnVmKSwgZm10LCBhcmdzKTsKPiArICAgIG5yID0gdnNjbnByaW50
ZihidWYsIHNpemVvZihidWYpLCBmbXQsIGFyZ3MpOwo+ICAgICAgdmFfZW5kKGFyZ3MpOwo+ICAK
PiAgICAgIGlmICggZGVidWd0cmFjZV9zZW5kX3RvX2NvbnNvbGUgKQo+ICAgICAgewo+IC0gICAg
ICAgIHNucHJpbnRmKGNudGJ1Ziwgc2l6ZW9mKGNudGJ1ZiksICIldSAiLCArK2NvdW50KTsKPiAt
ICAgICAgICBzZXJpYWxfcHV0cyhzZXJjb25faGFuZGxlLCBjbnRidWYpOwo+IC0gICAgICAgIHNl
cmlhbF9wdXRzKHNlcmNvbl9oYW5kbGUsIGJ1Zik7Cj4gKyAgICAgICAgdW5zaWduZWQgaW50IG4g
PSBzbnByaW50ZihjbnRidWYsIHNpemVvZihjbnRidWYpLCAiJXUgIiwgKytjb3VudCk7Cj4gKwo+
ICsgICAgICAgIHNlcmlhbF9wdXRzKHNlcmNvbl9oYW5kbGUsIGNudGJ1Ziwgbik7Cj4gKyAgICAg
ICAgc2VyaWFsX3B1dHMoc2VyY29uX2hhbmRsZSwgYnVmLCBucik7Cj4gICAgICB9Cj4gICAgICBl
bHNlCj4gICAgICB7Cj4gQEAgLTEzODEsNyArMTM4MCw3IEBAIHZvaWQgcGFuaWMoY29uc3QgY2hh
ciAqZm10LCAuLi4pCj4gICAqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqCj4gICAqLwo+ICAKPiAtc3RhdGljIHZvaWQgc3VzcGVu
ZF9zdGVhbF9mbihjb25zdCBjaGFyICpzdHIpIHsgfQo+ICtzdGF0aWMgdm9pZCBzdXNwZW5kX3N0
ZWFsX2ZuKGNvbnN0IGNoYXIgKnN0ciwgc2l6ZV90IG5yKSB7IH0KPiAgc3RhdGljIGludCBzdXNw
ZW5kX3N0ZWFsX2lkOwo+ICAKPiAgaW50IGNvbnNvbGVfc3VzcGVuZCh2b2lkKQo+IGRpZmYgLS1n
aXQgYS94ZW4vZHJpdmVycy9jaGFyL2NvbnNvbGVkLmMgYi94ZW4vZHJpdmVycy9jaGFyL2NvbnNv
bGVkLmMKPiBpbmRleCA1NTJhYmY1NzY2Li4yMjJlMDE4NDQyIDEwMDY0NAo+IC0tLSBhL3hlbi9k
cml2ZXJzL2NoYXIvY29uc29sZWQuYwo+ICsrKyBiL3hlbi9kcml2ZXJzL2NoYXIvY29uc29sZWQu
Ywo+IEBAIC03NywxNiArNzcsMTMgQEAgc2l6ZV90IGNvbnNvbGVkX2d1ZXN0X3J4KHZvaWQpCj4g
IAo+ICAgICAgICAgIGlmICggaWR4ID49IEJVRl9TWiApCj4gICAgICAgICAgewo+IC0gICAgICAg
ICAgICBwdl9jb25zb2xlX3B1dHMoYnVmKTsKPiArICAgICAgICAgICAgcHZfY29uc29sZV9wdXRz
KGJ1ZiwgQlVGX1NaKTsKPiAgICAgICAgICAgICAgaWR4ID0gMDsKPiAgICAgICAgICB9Cj4gICAg
ICB9Cj4gIAo+ICAgICAgaWYgKCBpZHggKQo+IC0gICAgewo+IC0gICAgICAgIGJ1ZltpZHhdID0g
J1wwJzsKPiAtICAgICAgICBwdl9jb25zb2xlX3B1dHMoYnVmKTsKPiAtICAgIH0KPiArICAgICAg
ICBwdl9jb25zb2xlX3B1dHMoYnVmLCBpZHgpOwo+ICAKPiAgICAgIC8qIE5vIG5lZWQgZm9yIGEg
bWVtIGJhcnJpZXIgYmVjYXVzZSBldmVyeSBjaGFyYWN0ZXIgd2FzIGFscmVhZHkgY29uc3VtZWQg
Ki8KPiAgICAgIGJhcnJpZXIoKTsKPiBkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvY2hhci9zZXJp
YWwuYyBiL3hlbi9kcml2ZXJzL2NoYXIvc2VyaWFsLmMKPiBpbmRleCAyMjFhMTRjMDkyLi44OGNk
ODc2NzkwIDEwMDY0NAo+IC0tLSBhL3hlbi9kcml2ZXJzL2NoYXIvc2VyaWFsLmMKPiArKysgYi94
ZW4vZHJpdmVycy9jaGFyL3NlcmlhbC5jCj4gQEAgLTIyMywxMSArMjIzLDEwIEBAIHZvaWQgc2Vy
aWFsX3B1dGMoaW50IGhhbmRsZSwgY2hhciBjKQo+ICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmcG9ydC0+dHhfbG9jaywgZmxhZ3MpOwo+ICB9Cj4gIAo+IC12b2lkIHNlcmlhbF9wdXRzKGlu
dCBoYW5kbGUsIGNvbnN0IGNoYXIgKnMpCj4gK3ZvaWQgc2VyaWFsX3B1dHMoaW50IGhhbmRsZSwg
Y29uc3QgY2hhciAqcywgc2l6ZV90IG5yKQo+ICB7Cj4gICAgICBzdHJ1Y3Qgc2VyaWFsX3BvcnQg
KnBvcnQ7Cj4gICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwo+IC0gICAgY2hhciBjOwo+ICAKPiAg
ICAgIGlmICggaGFuZGxlID09IC0xICkKPiAgICAgICAgICByZXR1cm47Cj4gQEAgLTIzOCw4ICsy
MzcsMTAgQEAgdm9pZCBzZXJpYWxfcHV0cyhpbnQgaGFuZGxlLCBjb25zdCBjaGFyICpzKQo+ICAK
PiAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZwb3J0LT50eF9sb2NrLCBmbGFncyk7Cj4gIAo+IC0g
ICAgd2hpbGUgKCAoYyA9ICpzKyspICE9ICdcMCcgKQo+ICsgICAgZm9yICggOyBuciA+IDA7IG5y
LS0sIHMrKyApCj4gICAgICB7Cj4gKyAgICAgICAgY2hhciBjID0gKnM7Cj4gKwo+ICAgICAgICAg
IGlmICggKGMgPT0gJ1xuJykgJiYgKGhhbmRsZSAmIFNFUkhORF9DT09LRUQpICkKPiAgICAgICAg
ICAgICAgX19zZXJpYWxfcHV0Yyhwb3J0LCAnXHInIHwgKChoYW5kbGUgJiBTRVJITkRfSEkpID8g
MHg4MCA6IDB4MDApKTsKPiAgCj4gZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL2NoYXIveGVuX3B2
X2NvbnNvbGUuYyBiL3hlbi9kcml2ZXJzL2NoYXIveGVuX3B2X2NvbnNvbGUuYwo+IGluZGV4IGNj
MWMxZDc0M2YuLjYxMjc4NGIwNzQgMTAwNjQ0Cj4gLS0tIGEveGVuL2RyaXZlcnMvY2hhci94ZW5f
cHZfY29uc29sZS5jCj4gKysrIGIveGVuL2RyaXZlcnMvY2hhci94ZW5fcHZfY29uc29sZS5jCj4g
QEAgLTEyOSwxMyArMTI5LDEzIEBAIHNpemVfdCBwdl9jb25zb2xlX3J4KHN0cnVjdCBjcHVfdXNl
cl9yZWdzICpyZWdzKQo+ICAgICAgcmV0dXJuIHJlY3Y7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzaXpl
X3QgcHZfcmluZ19wdXRzKGNvbnN0IGNoYXIgKmJ1ZikKPiArc3RhdGljIHNpemVfdCBwdl9yaW5n
X3B1dHMoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbnIpCj4gIHsKPiAgICAgIFhFTkNPTlNfUklO
R19JRFggY29ucywgcHJvZDsKPiAgICAgIHNpemVfdCBzZW50ID0gMCwgYXZhaWw7Cj4gICAgICBi
b29sIHB1dF9yID0gZmFsc2U7Cj4gIAo+IC0gICAgd2hpbGUgKCBidWZbc2VudF0gIT0gJ1wwJyB8
fCBwdXRfciApCj4gKyAgICB3aGlsZSAoIHNlbnQgPCBuciB8fCBwdXRfciApCj4gICAgICB7Cj4g
ICAgICAgICAgY29ucyA9IEFDQ0VTU19PTkNFKGNvbnNfcmluZy0+b3V0X2NvbnMpOwo+ICAgICAg
ICAgIHByb2QgPSBjb25zX3JpbmctPm91dF9wcm9kOwo+IEBAIC0xNTYsNyArMTU2LDcgQEAgc3Rh
dGljIHNpemVfdCBwdl9yaW5nX3B1dHMoY29uc3QgY2hhciAqYnVmKQo+ICAgICAgICAgICAgICBj
b250aW51ZTsKPiAgICAgICAgICB9Cj4gIAo+IC0gICAgICAgIHdoaWxlICggYXZhaWwgJiYgKGJ1
ZltzZW50XSAhPSAnXDAnIHx8IHB1dF9yKSApCj4gKyAgICAgICAgd2hpbGUgKCBhdmFpbCAmJiAo
c2VudCA8IG5yIHx8IHB1dF9yKSApCj4gICAgICAgICAgewo+ICAgICAgICAgICAgICBpZiAoIHB1
dF9yICkKPiAgICAgICAgICAgICAgewo+IEBAIC0xODUsNyArMTg1LDcgQEAgc3RhdGljIHNpemVf
dCBwdl9yaW5nX3B1dHMoY29uc3QgY2hhciAqYnVmKQo+ICAgICAgcmV0dXJuIHNlbnQ7Cj4gIH0K
PiAgCj4gLXZvaWQgcHZfY29uc29sZV9wdXRzKGNvbnN0IGNoYXIgKmJ1ZikKPiArdm9pZCBwdl9j
b25zb2xlX3B1dHMoY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbnIpCj4gIHsKPiAgICAgIHVuc2ln
bmVkIGxvbmcgZmxhZ3M7Cj4gIAo+IEBAIC0xOTMsNyArMTkzLDcgQEAgdm9pZCBwdl9jb25zb2xl
X3B1dHMoY29uc3QgY2hhciAqYnVmKQo+ICAgICAgICAgIHJldHVybjsKPiAgCj4gICAgICBzcGlu
X2xvY2tfaXJxc2F2ZSgmdHhfbG9jaywgZmxhZ3MpOwo+IC0gICAgcHZfcmluZ19wdXRzKGJ1Zik7
Cj4gKyAgICBwdl9yaW5nX3B1dHMoYnVmLCBucik7Cj4gICAgICBzcGluX3VubG9ja19pcnFyZXN0
b3JlKCZ0eF9sb2NrLCBmbGFncyk7Cj4gIH0KPiAgCj4gZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJz
L3ZpZGVvL2xmYi5jIGIveGVuL2RyaXZlcnMvdmlkZW8vbGZiLmMKPiBpbmRleCA1MDIyMTk1YWU1
Li43NWI3NDliMzMwIDEwMDY0NAo+IC0tLSBhL3hlbi9kcml2ZXJzL3ZpZGVvL2xmYi5jCj4gKysr
IGIveGVuL2RyaXZlcnMvdmlkZW8vbGZiLmMKPiBAQCAtNTMsMTQgKzUzLDE1IEBAIHN0YXRpYyB2
b2lkIGxmYl9zaG93X2xpbmUoCj4gIH0KPiAgCj4gIC8qIEZhc3QgbW9kZSB3aGljaCByZWRyYXdz
IGFsbCBtb2RpZmllZCBwYXJ0cyBvZiBhIDJEIHRleHQgYnVmZmVyLiAqLwo+IC12b2lkIGxmYl9y
ZWRyYXdfcHV0cyhjb25zdCBjaGFyICpzKQo+ICt2b2lkIGxmYl9yZWRyYXdfcHV0cyhjb25zdCBj
aGFyICpzLCBzaXplX3QgbnIpCj4gIHsKPiAgICAgIHVuc2lnbmVkIGludCBpLCBtaW5fcmVkcmF3
X3kgPSBsZmIueXBvczsKPiAtICAgIGNoYXIgYzsKPiAgCj4gICAgICAvKiBQYXN0ZSBjaGFyYWN0
ZXJzIGludG8gdGV4dCBidWZmZXIuICovCj4gLSAgICB3aGlsZSAoIChjID0gKnMrKykgIT0gJ1ww
JyApCj4gKyAgICBmb3IgKCA7IG5yID4gMDsgbnItLSwgcysrICkKPiAgICAgIHsKPiArICAgICAg
ICBjaGFyIGMgPSAqczsKPiArCj4gICAgICAgICAgaWYgKCAoYyA9PSAnXG4nKSB8fCAobGZiLnhw
b3MgPj0gbGZiLmxmYnAudGV4dF9jb2x1bW5zKSApCj4gICAgICAgICAgewo+ICAgICAgICAgICAg
ICBpZiAoICsrbGZiLnlwb3MgPj0gbGZiLmxmYnAudGV4dF9yb3dzICkKPiBAQCAtOTcsMTMgKzk4
LDE0IEBAIHZvaWQgbGZiX3JlZHJhd19wdXRzKGNvbnN0IGNoYXIgKnMpCj4gIH0KPiAgCj4gIC8q
IFNsb3dlciBsaW5lLWJhc2VkIHNjcm9sbCBtb2RlIHdoaWNoIGludGVyYWN0cyBiZXR0ZXIgd2l0
aCBkb20wLiAqLwo+IC12b2lkIGxmYl9zY3JvbGxfcHV0cyhjb25zdCBjaGFyICpzKQo+ICt2b2lk
IGxmYl9zY3JvbGxfcHV0cyhjb25zdCBjaGFyICpzLCBzaXplX3QgbnIpCj4gIHsKPiAgICAgIHVu
c2lnbmVkIGludCBpOwo+IC0gICAgY2hhciBjOwo+ICAKPiAtICAgIHdoaWxlICggKGMgPSAqcysr
KSAhPSAnXDAnICkKPiArICAgIGZvciAoIDsgbnIgPiAwOyBuci0tLCBzKysgKQo+ICAgICAgewo+
ICsgICAgICAgIGNoYXIgYyA9ICpzOwo+ICsKPiAgICAgICAgICBpZiAoIChjID09ICdcbicpIHx8
IChsZmIueHBvcyA+PSBsZmIubGZicC50ZXh0X2NvbHVtbnMpICkKPiAgICAgICAgICB7Cj4gICAg
ICAgICAgICAgIHVuc2lnbmVkIGludCBieXRlcyA9IChsZmIubGZicC53aWR0aCAqCj4gZGlmZiAt
LWdpdCBhL3hlbi9kcml2ZXJzL3ZpZGVvL2xmYi5oIGIveGVuL2RyaXZlcnMvdmlkZW8vbGZiLmgK
PiBpbmRleCBhYzQwYTY2Mzc5Li5lNzQzY2NkZDZiIDEwMDY0NAo+IC0tLSBhL3hlbi9kcml2ZXJz
L3ZpZGVvL2xmYi5oCj4gKysrIGIveGVuL2RyaXZlcnMvdmlkZW8vbGZiLmgKPiBAQCAtMzUsOCAr
MzUsOCBAQCBzdHJ1Y3QgbGZiX3Byb3Agewo+ICAgICAgdW5zaWduZWQgaW50IHRleHRfcm93czsK
PiAgfTsKPiAgCj4gLXZvaWQgbGZiX3JlZHJhd19wdXRzKGNvbnN0IGNoYXIgKnMpOwo+IC12b2lk
IGxmYl9zY3JvbGxfcHV0cyhjb25zdCBjaGFyICpzKTsKPiArdm9pZCBsZmJfcmVkcmF3X3B1dHMo
Y29uc3QgY2hhciAqcywgc2l6ZV90IG5yKTsKPiArdm9pZCBsZmJfc2Nyb2xsX3B1dHMoY29uc3Qg
Y2hhciAqcywgc2l6ZV90IG5yKTsKPiAgdm9pZCBsZmJfY2FycmlhZ2VfcmV0dXJuKHZvaWQpOwo+
ICB2b2lkIGxmYl9mcmVlKHZvaWQpOwo+ICAKPiBkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdmlk
ZW8vdmdhLmMgYi94ZW4vZHJpdmVycy92aWRlby92Z2EuYwo+IGluZGV4IDQ1NDQ1N2FkZTguLjY2
NmYyZTI1MDkgMTAwNjQ0Cj4gLS0tIGEveGVuL2RyaXZlcnMvdmlkZW8vdmdhLmMKPiArKysgYi94
ZW4vZHJpdmVycy92aWRlby92Z2EuYwo+IEBAIC0xOCw5ICsxOCw5IEBAIHN0YXRpYyBpbnQgdmdh
Y29uX2tlZXA7Cj4gIHN0YXRpYyB1bnNpZ25lZCBpbnQgeHBvcywgeXBvczsKPiAgc3RhdGljIHVu
c2lnbmVkIGNoYXIgKnZpZGVvOwo+ICAKPiAtc3RhdGljIHZvaWQgdmdhX3RleHRfcHV0cyhjb25z
dCBjaGFyICpzKTsKPiAtc3RhdGljIHZvaWQgdmdhX25vb3BfcHV0cyhjb25zdCBjaGFyICpzKSB7
fQo+IC12b2lkICgqdmlkZW9fcHV0cykoY29uc3QgY2hhciAqKSA9IHZnYV9ub29wX3B1dHM7Cj4g
K3N0YXRpYyB2b2lkIHZnYV90ZXh0X3B1dHMoY29uc3QgY2hhciAqcywgc2l6ZV90IG5yKTsKPiAr
c3RhdGljIHZvaWQgdmdhX25vb3BfcHV0cyhjb25zdCBjaGFyICpzLCBzaXplX3QgbnIpIHt9Cj4g
K3ZvaWQgKCp2aWRlb19wdXRzKShjb25zdCBjaGFyICosIHNpemVfdCBucikgPSB2Z2Ffbm9vcF9w
dXRzOwo+ICAKPiAgLyoKPiAgICogJ3ZnYT08bW9kZS1zcGVjaWZpZXI+WyxrZWVwXScgd2hlcmUg
PG1vZGUtc3BlY2lmaWVyPiBpcyBvbmUgb2Y6Cj4gQEAgLTE3NCwxMiArMTc0LDEyIEBAIHZvaWQg
X19pbml0IHZpZGVvX2VuZGJvb3Qodm9pZCkKPiAgICAgIH0KPiAgfQo+ICAKPiAtc3RhdGljIHZv
aWQgdmdhX3RleHRfcHV0cyhjb25zdCBjaGFyICpzKQo+ICtzdGF0aWMgdm9pZCB2Z2FfdGV4dF9w
dXRzKGNvbnN0IGNoYXIgKnMsIHNpemVfdCBucikKPiAgewo+IC0gICAgY2hhciBjOwo+IC0KPiAt
ICAgIHdoaWxlICggKGMgPSAqcysrKSAhPSAnXDAnICkKPiArICAgIGZvciAoIDsgbnIgPiAwOyBu
ci0tLCBzKysgKQo+ICAgICAgewo+ICsgICAgICAgIGNoYXIgYyA9ICpzOwo+ICsKPiAgICAgICAg
ICBpZiAoIChjID09ICdcbicpIHx8ICh4cG9zID49IGNvbHVtbnMpICkKPiAgICAgICAgICB7Cj4g
ICAgICAgICAgICAgIGlmICggKyt5cG9zID49IGxpbmVzICkKPiBkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUveGVuL2NvbnNvbGUuaCBiL3hlbi9pbmNsdWRlL3hlbi9jb25zb2xlLmgKPiBpbmRleCBi
NGY5NDYzOTM2Li5iYTkxNGY5ZTViIDEwMDY0NAo+IC0tLSBhL3hlbi9pbmNsdWRlL3hlbi9jb25z
b2xlLmgKPiArKysgYi94ZW4vaW5jbHVkZS94ZW4vY29uc29sZS5oCj4gQEAgLTM4LDcgKzM4LDcg
QEAgc3RydWN0IGRvbWFpbiAqY29uc29sZV9pbnB1dF9kb21haW4odm9pZCk7Cj4gICAqIFN0ZWFs
IG91dHB1dCBmcm9tIHRoZSBjb25zb2xlLiBSZXR1cm5zICt2ZSBpZGVudGlmaWVyLCBlbHNlIC12
ZSBlcnJvci4KPiAgICogVGFrZXMgdGhlIGhhbmRsZSBvZiB0aGUgc2VyaWFsIGxpbmUgdG8gc3Rl
YWwsIGFuZCBzdGVhbCBjYWxsYmFjayBmdW5jdGlvbi4KPiAgICovCj4gLWludCBjb25zb2xlX3N0
ZWFsKGludCBoYW5kbGUsIHZvaWQgKCpmbikoY29uc3QgY2hhciAqKSk7Cj4gK2ludCBjb25zb2xl
X3N0ZWFsKGludCBoYW5kbGUsIHZvaWQgKCpmbikoY29uc3QgY2hhciAqLCBzaXplX3QgbnIpKTsK
PiAgCj4gIC8qIEdpdmUgYmFjayBzdG9sZW4gY29uc29sZS4gVGFrZXMgdGhlIGlkZW50aWZpZXIg
cmV0dXJuZWQgYnkgY29uc29sZV9zdGVhbC4gKi8KPiAgdm9pZCBjb25zb2xlX2dpdmViYWNrKGlu
dCBpZCk7Cj4gZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9lYXJseV9wcmludGsuaCBiL3hl
bi9pbmNsdWRlL3hlbi9lYXJseV9wcmludGsuaAo+IGluZGV4IDJjM2UxYjM1MTkuLjBmNzZjM2E3
NGYgMTAwNjQ0Cj4gLS0tIGEveGVuL2luY2x1ZGUveGVuL2Vhcmx5X3ByaW50ay5oCj4gKysrIGIv
eGVuL2luY2x1ZGUveGVuL2Vhcmx5X3ByaW50ay5oCj4gQEAgLTUsNyArNSw3IEBACj4gICNkZWZp
bmUgX19YRU5fRUFSTFlfUFJJTlRLX0hfXwo+ICAKPiAgI2lmZGVmIENPTkZJR19FQVJMWV9QUklO
VEsKPiAtdm9pZCBlYXJseV9wdXRzKGNvbnN0IGNoYXIgKnMpOwo+ICt2b2lkIGVhcmx5X3B1dHMo
Y29uc3QgY2hhciAqcywgc2l6ZV90IG5yKTsKPiAgI2Vsc2UKPiAgI2RlZmluZSBlYXJseV9wdXRz
IE5VTEwKPiAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9wdl9jb25zb2xl
LmggYi94ZW4vaW5jbHVkZS94ZW4vcHZfY29uc29sZS5oCj4gaW5kZXggY2I5MjUzOTY2Ni4uNDc0
NWY0NmYyZCAxMDA2NDQKPiAtLS0gYS94ZW4vaW5jbHVkZS94ZW4vcHZfY29uc29sZS5oCj4gKysr
IGIveGVuL2luY2x1ZGUveGVuL3B2X2NvbnNvbGUuaAo+IEBAIC04LDcgKzgsNyBAQAo+ICB2b2lk
IHB2X2NvbnNvbGVfaW5pdCh2b2lkKTsKPiAgdm9pZCBwdl9jb25zb2xlX3NldF9yeF9oYW5kbGVy
KHNlcmlhbF9yeF9mbiBmbik7Cj4gIHZvaWQgcHZfY29uc29sZV9pbml0X3Bvc3RpcnEodm9pZCk7
Cj4gLXZvaWQgcHZfY29uc29sZV9wdXRzKGNvbnN0IGNoYXIgKmJ1Zik7Cj4gK3ZvaWQgcHZfY29u
c29sZV9wdXRzKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IG5yKTsKPiAgc2l6ZV90IHB2X2NvbnNv
bGVfcngoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpOwo+ICBldnRjaG5fcG9ydF90IHB2X2Nv
bnNvbGVfZXZ0Y2huKHZvaWQpOwo+ICAKPiBAQCAtMTcsNyArMTcsNyBAQCBldnRjaG5fcG9ydF90
IHB2X2NvbnNvbGVfZXZ0Y2huKHZvaWQpOwo+ICBzdGF0aWMgaW5saW5lIHZvaWQgcHZfY29uc29s
ZV9pbml0KHZvaWQpIHt9Cj4gIHN0YXRpYyBpbmxpbmUgdm9pZCBwdl9jb25zb2xlX3NldF9yeF9o
YW5kbGVyKHNlcmlhbF9yeF9mbiBmbikgeyB9Cj4gIHN0YXRpYyBpbmxpbmUgdm9pZCBwdl9jb25z
b2xlX2luaXRfcG9zdGlycSh2b2lkKSB7IH0KPiAtc3RhdGljIGlubGluZSB2b2lkIHB2X2NvbnNv
bGVfcHV0cyhjb25zdCBjaGFyICpidWYpIHsgfQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgcHZfY29u
c29sZV9wdXRzKGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IG5yKSB7IH0KPiAgc3RhdGljIGlubGlu
ZSBzaXplX3QgcHZfY29uc29sZV9yeChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncykgeyByZXR1
cm4gMDsgfQo+ICBldnRjaG5fcG9ydF90IHB2X2NvbnNvbGVfZXZ0Y2huKHZvaWQpCj4gIHsKPiBk
aWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NlcmlhbC5oIGIveGVuL2luY2x1ZGUveGVuL3Nl
cmlhbC5oCj4gaW5kZXggZjI5OTRkNDA5My4uNjU0OGYwYjBhOSAxMDA2NDQKPiAtLS0gYS94ZW4v
aW5jbHVkZS94ZW4vc2VyaWFsLmgKPiArKysgYi94ZW4vaW5jbHVkZS94ZW4vc2VyaWFsLmgKPiBA
QCAtMTE0LDggKzExNCw4IEBAIGludCBzZXJpYWxfcGFyc2VfaGFuZGxlKGNoYXIgKmNvbmYpOwo+
ICAvKiBUcmFuc21pdCBhIHNpbmdsZSBjaGFyYWN0ZXIgdmlhIHRoZSBzcGVjaWZpZWQgQ09NIHBv
cnQuICovCj4gIHZvaWQgc2VyaWFsX3B1dGMoaW50IGhhbmRsZSwgY2hhciBjKTsKPiAgCj4gLS8q
IFRyYW5zbWl0IGEgTlVMTC10ZXJtaW5hdGVkIHN0cmluZyB2aWEgdGhlIHNwZWNpZmllZCBDT00g
cG9ydC4gKi8KPiAtdm9pZCBzZXJpYWxfcHV0cyhpbnQgaGFuZGxlLCBjb25zdCBjaGFyICpzKTsK
PiArLyogVHJhbnNtaXQgYSBzdHJpbmcgdmlhIHRoZSBzcGVjaWZpZWQgQ09NIHBvcnQuICovCj4g
K3ZvaWQgc2VyaWFsX3B1dHMoaW50IGhhbmRsZSwgY29uc3QgY2hhciAqcywgc2l6ZV90IG5yKTsK
PiAgCj4gIC8qCj4gICAqIEFuIGFsdGVybmF0aXZlIHRvIHJlZ2lzdGVyaW5nIGEgY2hhcmFjdGVy
LXJlY2VpdmUgaG9vay4gVGhpcyBmdW5jdGlvbgo+IGRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94
ZW4vdmlkZW8uaCBiL3hlbi9pbmNsdWRlL3hlbi92aWRlby5oCj4gaW5kZXggMmU4OTdmOWRmNS4u
OTA1ZjMzMTExMiAxMDA2NDQKPiAtLS0gYS94ZW4vaW5jbHVkZS94ZW4vdmlkZW8uaAo+ICsrKyBi
L3hlbi9pbmNsdWRlL3hlbi92aWRlby5oCj4gQEAgLTEzLDExICsxMywxMSBAQAo+ICAKPiAgI2lm
ZGVmIENPTkZJR19WSURFTwo+ICB2b2lkIHZpZGVvX2luaXQodm9pZCk7Cj4gLWV4dGVybiB2b2lk
ICgqdmlkZW9fcHV0cykoY29uc3QgY2hhciAqKTsKPiArZXh0ZXJuIHZvaWQgKCp2aWRlb19wdXRz
KShjb25zdCBjaGFyICosIHNpemVfdCBucik7Cj4gIHZvaWQgdmlkZW9fZW5kYm9vdCh2b2lkKTsK
PiAgI2Vsc2UKPiAgI2RlZmluZSB2aWRlb19pbml0KCkgICAgKCh2b2lkKTApCj4gLSNkZWZpbmUg
dmlkZW9fcHV0cyhzKSAgICgodm9pZCkwKQo+ICsjZGVmaW5lIHZpZGVvX3B1dHMocywgbnIpICAg
KCh2b2lkKTApCj4gICNkZWZpbmUgdmlkZW9fZW5kYm9vdCgpICgodm9pZCkwKQo+ICAjZW5kaWYK
PiAgCj4gLS0gCj4gMi4xMS4wCj4gCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5w
cm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8v
eGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6C6947D91F
	for <lists+xen-devel@lfdr.de>; Thu,  1 Aug 2019 12:16:46 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ht85c-00014H-JX; Thu, 01 Aug 2019 10:13:40 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=6jP+=V5=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1ht85b-00013r-AR
 for xen-devel@lists.xenproject.org; Thu, 01 Aug 2019 10:13:39 +0000
X-Inumbo-ID: 06e866b5-b445-11e9-8980-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 06e866b5-b445-11e9-8980-bc764e045a96;
 Thu, 01 Aug 2019 10:13:38 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id EFCEFB604;
 Thu,  1 Aug 2019 10:13:36 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Thu,  1 Aug 2019 12:13:31 +0200
Message-Id: <20190801101333.9821-3-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190801101333.9821-1-jgross@suse.com>
References: <20190801101333.9821-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v2 2/4] xen: move debugtrace coding to
 common/debugtrace.c
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW5zdGVhZCBvZiBsaXZpbmcgaW4gZHJpdmVycy9jaGFyL2NvbnNvbGUuYyBtb3ZlIHRoZSBkZWJ1
Z3RyYWNlCnJlbGF0ZWQgY29kaW5nIHRvIGEgbmV3IGZpbGUgY29tbW9uL2RlYnVndHJhY2UuYwoK
Tm8gZnVuY3Rpb25hbCBjaGFuZ2UsIGNvZGUgbW92ZW1lbnQgb25seS4KClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KLS0tCiB4ZW4vY29tbW9uL01ha2VmaWxl
ICAgICAgICB8ICAgMSArCiB4ZW4vY29tbW9uL2RlYnVndHJhY2UuYyAgICB8IDE3NyArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHhlbi9kcml2ZXJzL2NoYXIv
Y29uc29sZS5jIHwgMTc0ICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCiAzIGZpbGVzIGNoYW5nZWQsIDE3OSBpbnNlcnRpb25zKCspLCAxNzMgZGVsZXRpb25zKC0p
CiBjcmVhdGUgbW9kZSAxMDA2NDQgeGVuL2NvbW1vbi9kZWJ1Z3RyYWNlLmMKCmRpZmYgLS1naXQg
YS94ZW4vY29tbW9uL01ha2VmaWxlIGIveGVuL2NvbW1vbi9NYWtlZmlsZQppbmRleCBlZGRkYTVk
YWE2Li42MmIzNGU2OWU5IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL01ha2VmaWxlCisrKyBiL3hl
bi9jb21tb24vTWFrZWZpbGUKQEAgLTQsNiArNCw3IEBAIG9iai15ICs9IGJzZWFyY2gubwogb2Jq
LSQoQ09ORklHX0NPUkVfUEFSS0lORykgKz0gY29yZV9wYXJraW5nLm8KIG9iai15ICs9IGNwdS5v
CiBvYmoteSArPSBjcHVwb29sLm8KK29iai0kKENPTkZJR19ERUJVR19UUkFDRSkgKz0gZGVidWd0
cmFjZS5vCiBvYmotJChDT05GSUdfSEFTX0RFVklDRV9UUkVFKSArPSBkZXZpY2VfdHJlZS5vCiBv
YmoteSArPSBkb21jdGwubwogb2JqLXkgKz0gZG9tYWluLm8KZGlmZiAtLWdpdCBhL3hlbi9jb21t
b24vZGVidWd0cmFjZS5jIGIveGVuL2NvbW1vbi9kZWJ1Z3RyYWNlLmMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uZWVkZTI4ZDRkNAotLS0gL2Rldi9udWxsCisrKyBiL3hl
bi9jb21tb24vZGVidWd0cmFjZS5jCkBAIC0wLDAgKzEsMTc3IEBACisvKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCisgKiBkZWJ1Z3RyYWNlLmMKKyAqCisgKiBEZWJ1Z3RyYWNlIGZvciBYZW4KKyAqLwor
CisKKyNpbmNsdWRlIDx4ZW4vY29uc29sZS5oPgorI2luY2x1ZGUgPHhlbi9pbml0Lmg+CisjaW5j
bHVkZSA8eGVuL2tleWhhbmRsZXIuaD4KKyNpbmNsdWRlIDx4ZW4vbGliLmg+CisjaW5jbHVkZSA8
eGVuL21tLmg+CisjaW5jbHVkZSA8eGVuL3NlcmlhbC5oPgorI2luY2x1ZGUgPHhlbi9zcGlubG9j
ay5oPgorI2luY2x1ZGUgPHhlbi93YXRjaGRvZy5oPgorCisvKiBTZW5kIG91dHB1dCBkaXJlY3Qg
dG8gY29uc29sZSwgb3IgYnVmZmVyIGl0PyAqLworc3RhdGljIHZvbGF0aWxlIGludCBkZWJ1Z3Ry
YWNlX3NlbmRfdG9fY29uc29sZTsKKworc3RhdGljIGNoYXIgICAgICAgICpkZWJ1Z3RyYWNlX2J1
ZjsgLyogRGVidWctdHJhY2UgYnVmZmVyICovCitzdGF0aWMgdW5zaWduZWQgaW50IGRlYnVndHJh
Y2VfcHJkOyAvKiBQcm9kdWNlciBpbmRleCAgICAgKi8KK3N0YXRpYyB1bnNpZ25lZCBpbnQgZGVi
dWd0cmFjZV9raWxvYnl0ZXMgPSAxMjgsIGRlYnVndHJhY2VfYnl0ZXM7CitzdGF0aWMgdW5zaWdu
ZWQgaW50IGRlYnVndHJhY2VfdXNlZDsKK3N0YXRpYyBERUZJTkVfU1BJTkxPQ0soZGVidWd0cmFj
ZV9sb2NrKTsKK2ludGVnZXJfcGFyYW0oImRlYnVndHJhY2UiLCBkZWJ1Z3RyYWNlX2tpbG9ieXRl
cyk7CisKK3N0YXRpYyB2b2lkIGRlYnVndHJhY2VfZHVtcF93b3JrZXIodm9pZCkKK3sKKyAgICBp
ZiAoIChkZWJ1Z3RyYWNlX2J5dGVzID09IDApIHx8ICFkZWJ1Z3RyYWNlX3VzZWQgKQorICAgICAg
ICByZXR1cm47CisKKyAgICBwcmludGsoImRlYnVndHJhY2VfZHVtcCgpIHN0YXJ0aW5nXG4iKTsK
KworICAgIC8qIFByaW50IG9sZGVzdCBwb3J0aW9uIG9mIHRoZSByaW5nLiAqLworICAgIEFTU0VS
VChkZWJ1Z3RyYWNlX2J1ZltkZWJ1Z3RyYWNlX2J5dGVzIC0gMV0gPT0gMCk7CisgICAgY29uc29s
ZV9zZXJpYWxfcHV0cygmZGVidWd0cmFjZV9idWZbZGVidWd0cmFjZV9wcmRdKTsKKworICAgIC8q
IFByaW50IHlvdW5nZXN0IHBvcnRpb24gb2YgdGhlIHJpbmcuICovCisgICAgZGVidWd0cmFjZV9i
dWZbZGVidWd0cmFjZV9wcmRdID0gJ1wwJzsKKyAgICBjb25zb2xlX3NlcmlhbF9wdXRzKCZkZWJ1
Z3RyYWNlX2J1ZlswXSk7CisKKyAgICBtZW1zZXQoZGVidWd0cmFjZV9idWYsICdcMCcsIGRlYnVn
dHJhY2VfYnl0ZXMpOworCisgICAgcHJpbnRrKCJkZWJ1Z3RyYWNlX2R1bXAoKSBmaW5pc2hlZFxu
Iik7Cit9CisKK3N0YXRpYyB2b2lkIGRlYnVndHJhY2VfdG9nZ2xlKHZvaWQpCit7CisgICAgdW5z
aWduZWQgbG9uZyBmbGFnczsKKworICAgIHdhdGNoZG9nX2Rpc2FibGUoKTsKKyAgICBzcGluX2xv
Y2tfaXJxc2F2ZSgmZGVidWd0cmFjZV9sb2NrLCBmbGFncyk7CisKKyAgICAvKgorICAgICAqIER1
bXAgdGhlIGJ1ZmZlciAqYmVmb3JlKiB0b2dnbGluZywgaW4gY2FzZSB0aGUgYWN0IG9mIGR1bXBp
bmcgdGhlCisgICAgICogYnVmZmVyIGl0c2VsZiBjYXVzZXMgbW9yZSBwcmludGsoKSBpbnZvY2F0
aW9ucy4KKyAgICAgKi8KKyAgICBwcmludGsoImRlYnVndHJhY2VfcHJpbnRrIG5vdyB3cml0aW5n
IHRvICVzLlxuIiwKKyAgICAgICAgICAgIWRlYnVndHJhY2Vfc2VuZF90b19jb25zb2xlID8gImNv
bnNvbGUiOiAiYnVmZmVyIik7CisgICAgaWYgKCAhZGVidWd0cmFjZV9zZW5kX3RvX2NvbnNvbGUg
KQorICAgICAgICBkZWJ1Z3RyYWNlX2R1bXBfd29ya2VyKCk7CisKKyAgICBkZWJ1Z3RyYWNlX3Nl
bmRfdG9fY29uc29sZSA9ICFkZWJ1Z3RyYWNlX3NlbmRfdG9fY29uc29sZTsKKworICAgIHNwaW5f
dW5sb2NrX2lycXJlc3RvcmUoJmRlYnVndHJhY2VfbG9jaywgZmxhZ3MpOworICAgIHdhdGNoZG9n
X2VuYWJsZSgpOworCit9CisKK3ZvaWQgZGVidWd0cmFjZV9kdW1wKHZvaWQpCit7CisgICAgdW5z
aWduZWQgbG9uZyBmbGFnczsKKworICAgIHdhdGNoZG9nX2Rpc2FibGUoKTsKKyAgICBzcGluX2xv
Y2tfaXJxc2F2ZSgmZGVidWd0cmFjZV9sb2NrLCBmbGFncyk7CisKKyAgICBkZWJ1Z3RyYWNlX2R1
bXBfd29ya2VyKCk7CisKKyAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZWJ1Z3RyYWNlX2xv
Y2ssIGZsYWdzKTsKKyAgICB3YXRjaGRvZ19lbmFibGUoKTsKK30KKworc3RhdGljIHZvaWQgZGVi
dWd0cmFjZV9hZGRfdG9fYnVmKGNoYXIgKmJ1ZikKK3sKKyAgICBjaGFyICpwOworCisgICAgZm9y
ICggcCA9IGJ1ZjsgKnAgIT0gJ1wwJzsgcCsrICkKKyAgICB7CisgICAgICAgIGRlYnVndHJhY2Vf
YnVmW2RlYnVndHJhY2VfcHJkKytdID0gKnA7CisgICAgICAgIC8qIEFsd2F5cyBsZWF2ZSBhIG51
bCBieXRlIGF0IHRoZSBlbmQgb2YgdGhlIGJ1ZmZlci4gKi8KKyAgICAgICAgaWYgKCBkZWJ1Z3Ry
YWNlX3ByZCA9PSAoZGVidWd0cmFjZV9ieXRlcyAtIDEpICkKKyAgICAgICAgICAgIGRlYnVndHJh
Y2VfcHJkID0gMDsKKyAgICB9Cit9CisKK3ZvaWQgZGVidWd0cmFjZV9wcmludGsoY29uc3QgY2hh
ciAqZm10LCAuLi4pCit7CisgICAgc3RhdGljIGNoYXIgYnVmWzEwMjRdLCBsYXN0X2J1ZlsxMDI0
XTsKKyAgICBzdGF0aWMgdW5zaWduZWQgaW50IGNvdW50LCBsYXN0X2NvdW50LCBsYXN0X3ByZDsK
KworICAgIGNoYXIgICAgICAgICAgY250YnVmWzI0XTsKKyAgICB2YV9saXN0ICAgICAgIGFyZ3M7
CisgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKKworICAgIGlmICggZGVidWd0cmFjZV9ieXRlcyA9
PSAwICkKKyAgICAgICAgcmV0dXJuOworCisgICAgZGVidWd0cmFjZV91c2VkID0gMTsKKworICAg
IHNwaW5fbG9ja19pcnFzYXZlKCZkZWJ1Z3RyYWNlX2xvY2ssIGZsYWdzKTsKKworICAgIEFTU0VS
VChkZWJ1Z3RyYWNlX2J1ZltkZWJ1Z3RyYWNlX2J5dGVzIC0gMV0gPT0gMCk7CisKKyAgICB2YV9z
dGFydChhcmdzLCBmbXQpOworICAgIHZzbnByaW50ZihidWYsIHNpemVvZihidWYpLCBmbXQsIGFy
Z3MpOworICAgIHZhX2VuZChhcmdzKTsKKworICAgIGlmICggZGVidWd0cmFjZV9zZW5kX3RvX2Nv
bnNvbGUgKQorICAgIHsKKyAgICAgICAgc25wcmludGYoY250YnVmLCBzaXplb2YoY250YnVmKSwg
IiV1ICIsICsrY291bnQpOworICAgICAgICBjb25zb2xlX3NlcmlhbF9wdXRzKGNudGJ1Zik7Cisg
ICAgICAgIGNvbnNvbGVfc2VyaWFsX3B1dHMoYnVmKTsKKyAgICB9CisgICAgZWxzZQorICAgIHsK
KyAgICAgICAgaWYgKCBzdHJjbXAoYnVmLCBsYXN0X2J1ZikgKQorICAgICAgICB7CisgICAgICAg
ICAgICBsYXN0X3ByZCA9IGRlYnVndHJhY2VfcHJkOworICAgICAgICAgICAgbGFzdF9jb3VudCA9
ICsrY291bnQ7CisgICAgICAgICAgICBzYWZlX3N0cmNweShsYXN0X2J1ZiwgYnVmKTsKKyAgICAg
ICAgICAgIHNucHJpbnRmKGNudGJ1Ziwgc2l6ZW9mKGNudGJ1ZiksICIldSAiLCBjb3VudCk7Cisg
ICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICB7CisgICAgICAgICAgICBkZWJ1Z3RyYWNl
X3ByZCA9IGxhc3RfcHJkOworICAgICAgICAgICAgc25wcmludGYoY250YnVmLCBzaXplb2YoY250
YnVmKSwgIiV1LSV1ICIsIGxhc3RfY291bnQsICsrY291bnQpOworICAgICAgICB9CisgICAgICAg
IGRlYnVndHJhY2VfYWRkX3RvX2J1ZihjbnRidWYpOworICAgICAgICBkZWJ1Z3RyYWNlX2FkZF90
b19idWYoYnVmKTsKKyAgICB9CisKKyAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZWJ1Z3Ry
YWNlX2xvY2ssIGZsYWdzKTsKK30KKworc3RhdGljIHZvaWQgZGVidWd0cmFjZV9rZXkodW5zaWdu
ZWQgY2hhciBrZXkpCit7CisgICAgZGVidWd0cmFjZV90b2dnbGUoKTsKK30KKworc3RhdGljIGlu
dCBfX2luaXQgZGVidWd0cmFjZV9pbml0KHZvaWQpCit7CisgICAgaW50IG9yZGVyOworICAgIHVu
c2lnbmVkIGludCBrYnl0ZXMsIGJ5dGVzOworCisgICAgLyogUm91bmQgc2l6ZSBkb3duIHRvIG5l
eHQgcG93ZXIgb2YgdHdvLiAqLworICAgIHdoaWxlICggKGtieXRlcyA9IChkZWJ1Z3RyYWNlX2tp
bG9ieXRlcyAmIChkZWJ1Z3RyYWNlX2tpbG9ieXRlcy0xKSkpICE9IDAgKQorICAgICAgICBkZWJ1
Z3RyYWNlX2tpbG9ieXRlcyA9IGtieXRlczsKKworICAgIGJ5dGVzID0gZGVidWd0cmFjZV9raWxv
Ynl0ZXMgPDwgMTA7CisgICAgaWYgKCBieXRlcyA9PSAwICkKKyAgICAgICAgcmV0dXJuIDA7CisK
KyAgICBvcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5dGVzKGJ5dGVzKTsKKyAgICBkZWJ1Z3RyYWNl
X2J1ZiA9IGFsbG9jX3hlbmhlYXBfcGFnZXMob3JkZXIsIDApOworICAgIEFTU0VSVChkZWJ1Z3Ry
YWNlX2J1ZiAhPSBOVUxMKTsKKworICAgIG1lbXNldChkZWJ1Z3RyYWNlX2J1ZiwgJ1wwJywgYnl0
ZXMpOworCisgICAgZGVidWd0cmFjZV9ieXRlcyA9IGJ5dGVzOworCisgICAgcmVnaXN0ZXJfa2V5
aGFuZGxlcignVCcsIGRlYnVndHJhY2Vfa2V5LAorICAgICAgICAgICAgICAgICAgICAgICAgInRv
Z2dsZSBkZWJ1Z3RyYWNlIHRvIGNvbnNvbGUvYnVmZmVyIiwgMCk7CisKKyAgICByZXR1cm4gMDsK
K30KK19faW5pdGNhbGwoZGVidWd0cmFjZV9pbml0KTsKKwpkaWZmIC0tZ2l0IGEveGVuL2RyaXZl
cnMvY2hhci9jb25zb2xlLmMgYi94ZW4vZHJpdmVycy9jaGFyL2NvbnNvbGUuYwppbmRleCA0OWZi
YmVkMjFhLi4xNjgwZDA3OGRiIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9jaGFyL2NvbnNvbGUu
YworKysgYi94ZW4vZHJpdmVycy9jaGFyL2NvbnNvbGUuYwpAQCAtMTE1NywxNzkgKzExNTcsNyBA
QCBpbnQgcHJpbnRrX3JhdGVsaW1pdCh2b2lkKQogCiAvKgogICogKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqICoqKioqKioq
KioqKioqKiBTZXJpYWwgY29uc29sZSByaW5nIGJ1ZmZlciAqKioqKioqKioqKioqKioqKioqCi0g
KiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgotICovCi0KLSNpZmRlZiBDT05GSUdfREVCVUdfVFJBQ0UKLQotLyogU2VuZCBvdXRw
dXQgZGlyZWN0IHRvIGNvbnNvbGUsIG9yIGJ1ZmZlciBpdD8gKi8KLXN0YXRpYyB2b2xhdGlsZSBp
bnQgZGVidWd0cmFjZV9zZW5kX3RvX2NvbnNvbGU7Ci0KLXN0YXRpYyBjaGFyICAgICAgICAqZGVi
dWd0cmFjZV9idWY7IC8qIERlYnVnLXRyYWNlIGJ1ZmZlciAqLwotc3RhdGljIHVuc2lnbmVkIGlu
dCBkZWJ1Z3RyYWNlX3ByZDsgLyogUHJvZHVjZXIgaW5kZXggICAgICovCi1zdGF0aWMgdW5zaWdu
ZWQgaW50IGRlYnVndHJhY2Vfa2lsb2J5dGVzID0gMTI4LCBkZWJ1Z3RyYWNlX2J5dGVzOwotc3Rh
dGljIHVuc2lnbmVkIGludCBkZWJ1Z3RyYWNlX3VzZWQ7Ci1zdGF0aWMgREVGSU5FX1NQSU5MT0NL
KGRlYnVndHJhY2VfbG9jayk7Ci1pbnRlZ2VyX3BhcmFtKCJkZWJ1Z3RyYWNlIiwgZGVidWd0cmFj
ZV9raWxvYnl0ZXMpOwotCi1zdGF0aWMgdm9pZCBkZWJ1Z3RyYWNlX2R1bXBfd29ya2VyKHZvaWQp
Ci17Ci0gICAgaWYgKCAoZGVidWd0cmFjZV9ieXRlcyA9PSAwKSB8fCAhZGVidWd0cmFjZV91c2Vk
ICkKLSAgICAgICAgcmV0dXJuOwotCi0gICAgcHJpbnRrKCJkZWJ1Z3RyYWNlX2R1bXAoKSBzdGFy
dGluZ1xuIik7Ci0KLSAgICAvKiBQcmludCBvbGRlc3QgcG9ydGlvbiBvZiB0aGUgcmluZy4gKi8K
LSAgICBBU1NFUlQoZGVidWd0cmFjZV9idWZbZGVidWd0cmFjZV9ieXRlcyAtIDFdID09IDApOwot
ICAgIGNvbnNvbGVfc2VyaWFsX3B1dHMoJmRlYnVndHJhY2VfYnVmW2RlYnVndHJhY2VfcHJkXSk7
Ci0KLSAgICAvKiBQcmludCB5b3VuZ2VzdCBwb3J0aW9uIG9mIHRoZSByaW5nLiAqLwotICAgIGRl
YnVndHJhY2VfYnVmW2RlYnVndHJhY2VfcHJkXSA9ICdcMCc7Ci0gICAgY29uc29sZV9zZXJpYWxf
cHV0cygmZGVidWd0cmFjZV9idWZbMF0pOwotCi0gICAgbWVtc2V0KGRlYnVndHJhY2VfYnVmLCAn
XDAnLCBkZWJ1Z3RyYWNlX2J5dGVzKTsKLQotICAgIHByaW50aygiZGVidWd0cmFjZV9kdW1wKCkg
ZmluaXNoZWRcbiIpOwotfQotCi1zdGF0aWMgdm9pZCBkZWJ1Z3RyYWNlX3RvZ2dsZSh2b2lkKQot
ewotICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0KLSAgICB3YXRjaGRvZ19kaXNhYmxlKCk7Ci0g
ICAgc3Bpbl9sb2NrX2lycXNhdmUoJmRlYnVndHJhY2VfbG9jaywgZmxhZ3MpOwotCi0gICAgLyoK
LSAgICAgKiBEdW1wIHRoZSBidWZmZXIgKmJlZm9yZSogdG9nZ2xpbmcsIGluIGNhc2UgdGhlIGFj
dCBvZiBkdW1waW5nIHRoZQotICAgICAqIGJ1ZmZlciBpdHNlbGYgY2F1c2VzIG1vcmUgcHJpbnRr
KCkgaW52b2NhdGlvbnMuCi0gICAgICovCi0gICAgcHJpbnRrKCJkZWJ1Z3RyYWNlX3ByaW50ayBu
b3cgd3JpdGluZyB0byAlcy5cbiIsCi0gICAgICAgICAgICFkZWJ1Z3RyYWNlX3NlbmRfdG9fY29u
c29sZSA/ICJjb25zb2xlIjogImJ1ZmZlciIpOwotICAgIGlmICggIWRlYnVndHJhY2Vfc2VuZF90
b19jb25zb2xlICkKLSAgICAgICAgZGVidWd0cmFjZV9kdW1wX3dvcmtlcigpOwotCi0gICAgZGVi
dWd0cmFjZV9zZW5kX3RvX2NvbnNvbGUgPSAhZGVidWd0cmFjZV9zZW5kX3RvX2NvbnNvbGU7Ci0K
LSAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZWJ1Z3RyYWNlX2xvY2ssIGZsYWdzKTsKLSAg
ICB3YXRjaGRvZ19lbmFibGUoKTsKLQotfQotCi12b2lkIGRlYnVndHJhY2VfZHVtcCh2b2lkKQot
ewotICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0KLSAgICB3YXRjaGRvZ19kaXNhYmxlKCk7Ci0g
ICAgc3Bpbl9sb2NrX2lycXNhdmUoJmRlYnVndHJhY2VfbG9jaywgZmxhZ3MpOwotCi0gICAgZGVi
dWd0cmFjZV9kdW1wX3dvcmtlcigpOwotCi0gICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZGVi
dWd0cmFjZV9sb2NrLCBmbGFncyk7Ci0gICAgd2F0Y2hkb2dfZW5hYmxlKCk7Ci19Ci0KLXN0YXRp
YyB2b2lkIGRlYnVndHJhY2VfYWRkX3RvX2J1ZihjaGFyICpidWYpCi17Ci0gICAgY2hhciAqcDsK
LQotICAgIGZvciAoIHAgPSBidWY7ICpwICE9ICdcMCc7IHArKyApCi0gICAgewotICAgICAgICBk
ZWJ1Z3RyYWNlX2J1ZltkZWJ1Z3RyYWNlX3ByZCsrXSA9ICpwOwotICAgICAgICAvKiBBbHdheXMg
bGVhdmUgYSBudWwgYnl0ZSBhdCB0aGUgZW5kIG9mIHRoZSBidWZmZXIuICovCi0gICAgICAgIGlm
ICggZGVidWd0cmFjZV9wcmQgPT0gKGRlYnVndHJhY2VfYnl0ZXMgLSAxKSApCi0gICAgICAgICAg
ICBkZWJ1Z3RyYWNlX3ByZCA9IDA7Ci0gICAgfQotfQotCi12b2lkIGRlYnVndHJhY2VfcHJpbnRr
KGNvbnN0IGNoYXIgKmZtdCwgLi4uKQotewotICAgIHN0YXRpYyBjaGFyIGJ1ZlsxMDI0XSwgbGFz
dF9idWZbMTAyNF07Ci0gICAgc3RhdGljIHVuc2lnbmVkIGludCBjb3VudCwgbGFzdF9jb3VudCwg
bGFzdF9wcmQ7Ci0KLSAgICBjaGFyICAgICAgICAgIGNudGJ1ZlsyNF07Ci0gICAgdmFfbGlzdCAg
ICAgICBhcmdzOwotICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0KLSAgICBpZiAoIGRlYnVndHJh
Y2VfYnl0ZXMgPT0gMCApCi0gICAgICAgIHJldHVybjsKLQotICAgIGRlYnVndHJhY2VfdXNlZCA9
IDE7Ci0KLSAgICBzcGluX2xvY2tfaXJxc2F2ZSgmZGVidWd0cmFjZV9sb2NrLCBmbGFncyk7Ci0K
LSAgICBBU1NFUlQoZGVidWd0cmFjZV9idWZbZGVidWd0cmFjZV9ieXRlcyAtIDFdID09IDApOwot
Ci0gICAgdmFfc3RhcnQoYXJncywgZm10KTsKLSAgICB2c25wcmludGYoYnVmLCBzaXplb2YoYnVm
KSwgZm10LCBhcmdzKTsKLSAgICB2YV9lbmQoYXJncyk7Ci0KLSAgICBpZiAoIGRlYnVndHJhY2Vf
c2VuZF90b19jb25zb2xlICkKLSAgICB7Ci0gICAgICAgIHNucHJpbnRmKGNudGJ1Ziwgc2l6ZW9m
KGNudGJ1ZiksICIldSAiLCArK2NvdW50KTsKLSAgICAgICAgY29uc29sZV9zZXJpYWxfcHV0cyhj
bnRidWYpOwotICAgICAgICBjb25zb2xlX3NlcmlhbF9wdXRzKGJ1Zik7Ci0gICAgfQotICAgIGVs
c2UKLSAgICB7Ci0gICAgICAgIGlmICggc3RyY21wKGJ1ZiwgbGFzdF9idWYpICkKLSAgICAgICAg
ewotICAgICAgICAgICAgbGFzdF9wcmQgPSBkZWJ1Z3RyYWNlX3ByZDsKLSAgICAgICAgICAgIGxh
c3RfY291bnQgPSArK2NvdW50OwotICAgICAgICAgICAgc2FmZV9zdHJjcHkobGFzdF9idWYsIGJ1
Zik7Ci0gICAgICAgICAgICBzbnByaW50ZihjbnRidWYsIHNpemVvZihjbnRidWYpLCAiJXUgIiwg
Y291bnQpOwotICAgICAgICB9Ci0gICAgICAgIGVsc2UKLSAgICAgICAgewotICAgICAgICAgICAg
ZGVidWd0cmFjZV9wcmQgPSBsYXN0X3ByZDsKLSAgICAgICAgICAgIHNucHJpbnRmKGNudGJ1Ziwg
c2l6ZW9mKGNudGJ1ZiksICIldS0ldSAiLCBsYXN0X2NvdW50LCArK2NvdW50KTsKLSAgICAgICAg
fQotICAgICAgICBkZWJ1Z3RyYWNlX2FkZF90b19idWYoY250YnVmKTsKLSAgICAgICAgZGVidWd0
cmFjZV9hZGRfdG9fYnVmKGJ1Zik7Ci0gICAgfQotCi0gICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmZGVidWd0cmFjZV9sb2NrLCBmbGFncyk7Ci19Ci0KLXN0YXRpYyB2b2lkIGRlYnVndHJhY2Vf
a2V5KHVuc2lnbmVkIGNoYXIga2V5KQotewotICAgIGRlYnVndHJhY2VfdG9nZ2xlKCk7Ci19Ci0K
LXN0YXRpYyBpbnQgX19pbml0IGRlYnVndHJhY2VfaW5pdCh2b2lkKQotewotICAgIGludCBvcmRl
cjsKLSAgICB1bnNpZ25lZCBpbnQga2J5dGVzLCBieXRlczsKLQotICAgIC8qIFJvdW5kIHNpemUg
ZG93biB0byBuZXh0IHBvd2VyIG9mIHR3by4gKi8KLSAgICB3aGlsZSAoIChrYnl0ZXMgPSAoZGVi
dWd0cmFjZV9raWxvYnl0ZXMgJiAoZGVidWd0cmFjZV9raWxvYnl0ZXMtMSkpKSAhPSAwICkKLSAg
ICAgICAgZGVidWd0cmFjZV9raWxvYnl0ZXMgPSBrYnl0ZXM7Ci0KLSAgICBieXRlcyA9IGRlYnVn
dHJhY2Vfa2lsb2J5dGVzIDw8IDEwOwotICAgIGlmICggYnl0ZXMgPT0gMCApCi0gICAgICAgIHJl
dHVybiAwOwotCi0gICAgb3JkZXIgPSBnZXRfb3JkZXJfZnJvbV9ieXRlcyhieXRlcyk7Ci0gICAg
ZGVidWd0cmFjZV9idWYgPSBhbGxvY194ZW5oZWFwX3BhZ2VzKG9yZGVyLCAwKTsKLSAgICBBU1NF
UlQoZGVidWd0cmFjZV9idWYgIT0gTlVMTCk7Ci0KLSAgICBtZW1zZXQoZGVidWd0cmFjZV9idWYs
ICdcMCcsIGJ5dGVzKTsKLQotICAgIGRlYnVndHJhY2VfYnl0ZXMgPSBieXRlczsKLQotICAgIHJl
Z2lzdGVyX2tleWhhbmRsZXIoJ1QnLCBkZWJ1Z3RyYWNlX2tleSwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICJ0b2dnbGUgZGVidWd0cmFjZSB0byBjb25zb2xlL2J1ZmZlciIsIDApOwotCi0gICAg
cmV0dXJuIDA7Ci19Ci1fX2luaXRjYWxsKGRlYnVndHJhY2VfaW5pdCk7Ci0KLSNlbmRpZiAvKiAh
Q09ORklHX0RFQlVHX1RSQUNFICovCi0KLQotLyoKLSAqICoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiAqKioqKioqKioqKioq
KiogRGVidWdnaW5nL3RyYWNpbmcvZXJyb3ItcmVwb3J0ICoqKioqKioqKioqKioqKgorICogKioq
KioqKioqKioqKioqKioqKioqKiBFcnJvci1yZXBvcnQgKioqKioqKioqKioqKioqKioqKioqKioq
KioKICAqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqCiAgKi8KIAotLSAKMi4xNi40CgoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxA
bGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFu
L2xpc3RpbmZvL3hlbi1kZXZlbA==

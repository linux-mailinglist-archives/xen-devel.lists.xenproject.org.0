Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 2C4DD16FC66
	for <lists+xen-devel@lfdr.de>; Wed, 26 Feb 2020 11:39:08 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j6u3d-000486-PW; Wed, 26 Feb 2020 10:36:49 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=joxT=4O=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1j6u3c-000481-A1
 for xen-devel@lists.xenproject.org; Wed, 26 Feb 2020 10:36:48 +0000
X-Inumbo-ID: e32155ba-5883-11ea-93ed-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id e32155ba-5883-11ea-93ed-12813bfff9fa;
 Wed, 26 Feb 2020 10:36:46 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 995A8AEEE;
 Wed, 26 Feb 2020 10:36:45 +0000 (UTC)
To: Roger Pau Monne <roger.pau@citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>
References: <20200224104645.96381-1-roger.pau@citrix.com>
 <20200224104645.96381-6-roger.pau@citrix.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <831167dd-1462-7eba-1822-bd975e8a4ebb@suse.com>
Date: Wed, 26 Feb 2020 11:36:52 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko/20100101
 Thunderbird/68.5.0
MIME-Version: 1.0
In-Reply-To: <20200224104645.96381-6-roger.pau@citrix.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v3 5/5] x86: add accessors for scratch cpu
 mask
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: xen-devel@lists.xenproject.org, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMjQuMDIuMjAyMCAxMTo0NiwgUm9nZXIgUGF1IE1vbm5lIHdyb3RlOgo+IEN1cnJlbnQgdXNh
Z2Ugb2YgdGhlIHBlci1DUFUgc2NyYXRjaCBjcHVtYXNrIGlzIGRhbmdlcm91cyBzaW5jZQo+IHRo
ZXJlJ3Mgbm8gd2F5IHRvIGZpZ3VyZSBvdXQgaWYgdGhlIG1hc2sgaXMgYWxyZWFkeSBiZWluZyB1
c2VkIGV4Y2VwdAo+IGZvciBtYW51YWwgY29kZSBpbnNwZWN0aW9uIG9mIGFsbCB0aGUgY2FsbGVy
cyBhbmQgcG9zc2libGUgY2FsbCBwYXRocy4KPiAKPiBUaGlzIGlzIHVuc2FmZSBhbmQgbm90IHJl
bGlhYmxlLCBzbyBpbnRyb2R1Y2UgYSBtaW5pbWFsIGdldC9wdXQKPiBpbmZyYXN0cnVjdHVyZSB0
byBwcmV2ZW50IG5lc3RlZCB1c2FnZSBvZiB0aGUgc2NyYXRjaCBtYXNrIGFuZCB1c2FnZQo+IGlu
IGludGVycnVwdCBjb250ZXh0LgoKV2hpbGUgSSBjYW4gc2VlIHRoZSByZWFzb25pbmcgKGVzcGVj
aWFsbHkgaW4gbGlnaHQgb2YgdGhlIGNoYW5nZQp3aGljaCBkaWQgdmlvbGF0ZSB0byBhc3N1bXB0
aW9uKSwgSSdtIHN0aWxsIHVuY2VydGFpbiBpZiB0aGlzIGlzbid0CiJvdmVyLWVuZ2luZWVyaW5n
Ii4gQW5kcmV3LCBkbyB5b3UgaGF2ZSBhIGNsZWFyIG9waW5pb24gb25lIHdheSBvcgp0aGUgb3Ro
ZXIgaGVyZT8KCj4gTW92ZSB0aGUgZGVjbGFyYXRpb24gb2Ygc2NyYXRjaF9jcHVtYXNrIHRvIHNt
cC5jIGluIG9yZGVyIHRvIHBsYWNlIHRoZQo+IGRlY2xhcmF0aW9uIGFuZCB0aGUgYWNjZXNzb3Jz
IGFzIGNsb3NlIGFzIHBvc3NpYmxlLgoKcy9kZWNsYXJhdGlvbi9kZWZpbml0aW9uL2cKCj4gLS0t
IGEveGVuL2FyY2gveDg2L2lycS5jCj4gKysrIGIveGVuL2FyY2gveDg2L2lycS5jCj4gQEAgLTE5
Niw3ICsxOTYsNyBAQCBzdGF0aWMgdm9pZCBfY2xlYXJfaXJxX3ZlY3RvcihzdHJ1Y3QgaXJxX2Rl
c2MgKmRlc2MpCj4gIHsKPiAgICAgIHVuc2lnbmVkIGludCBjcHUsIG9sZF92ZWN0b3IsIGlycSA9
IGRlc2MtPmlycTsKPiAgICAgIHVuc2lnbmVkIGludCB2ZWN0b3IgPSBkZXNjLT5hcmNoLnZlY3Rv
cjsKPiAtICAgIGNwdW1hc2tfdCAqdG1wX21hc2sgPSB0aGlzX2NwdShzY3JhdGNoX2NwdW1hc2sp
Owo+ICsgICAgY3B1bWFza190ICp0bXBfbWFzayA9IGdldF9zY3JhdGNoX2NwdW1hc2soKTsKPiAg
Cj4gICAgICBCVUdfT04oIXZhbGlkX2lycV92ZWN0b3IodmVjdG9yKSk7Cj4gIAo+IEBAIC0yMjMs
NyArMjIzLDEwIEBAIHN0YXRpYyB2b2lkIF9jbGVhcl9pcnFfdmVjdG9yKHN0cnVjdCBpcnFfZGVz
YyAqZGVzYykKPiAgICAgIHRyYWNlX2lycV9tYXNrKFRSQ19IV19JUlFfQ0xFQVJfVkVDVE9SLCBp
cnEsIHZlY3RvciwgdG1wX21hc2spOwo+ICAKPiAgICAgIGlmICggbGlrZWx5KCFkZXNjLT5hcmNo
Lm1vdmVfaW5fcHJvZ3Jlc3MpICkKPiArICAgIHsKPiArICAgICAgICBwdXRfc2NyYXRjaF9jcHVt
YXNrKCk7Cj4gICAgICAgICAgcmV0dXJuOwo+ICsgICAgfQoKSSB0aGluayBpZiBwb3NzaWJsZSBz
dWNoIGVycm9yIHBhdGggYWRqdXN0bWVudHMgd291bGQgYmV0dGVyIGJlCmF2b2lkZWQuIEFuZCB0
aGlzIHNlZW1zIGZlYXNpYmxlIGhlcmU6IFRoZXJlIGFyZSB0d28gZW50aXJlbHkKaW5kZXBlbmRl
bnQgdXNlZCBvZiB0aGUgc2NyYXRjaCBtYXNrIGluIHRoaXMgZnVuY3Rpb24uIFlvdSBjb3VsZAp0
aGVyZWZvcmUgcHV0IHRoZSBtYXNrIGFib3ZlIGZyb20gaGVyZSwgYW5kIGdldCBpdCBhZ2FpbiBm
dXJ0aGVyCmRvd24sIG9yIHlvdSBjb3VsZCBsZXZlcmFnZSBhIHByb3BlcnR5IG9mIHRoZSBjdXJy
ZW50CmltcGxlbWVudGF0aW9uLCBwbHVzIHRoZSBmYWN0IHRoYXQgdGhlIDJuZCB1c2UgZG9lc24n
dCBpbnZvbHZlZAphbnkgInJlYWwiIGZ1bmN0aW9uIGNhbGxzLCBhbmQgYXZvaWQgYSAybmQgZ2V0
L3B1dCBhbHRvZ2V0aGVyLgoKT2YgY291cnNlIGFub3RoZXIgcXVlc3Rpb24gdGhlbiBpcyB3aGV0
aGVyIGl0IGlzIGEgZ29vZCBwcm9wZXJ0eQpvZiB0aGUgY3VycmVudCBtb2RlbCwgaS5lLiB3aGV0
aGVyIGl0IHdvdWxkbid0IGJlIGJldHRlciBmb3IKInB1dCIgdG8gYWN0dWFsbHkgemFwIHRoZSBw
b2ludGVyLCB0byBwcmV2ZW50IHN1YnNlcXVlbnQgdXNlLgoKPiBAQCAtMjUzMSwxMiArMjUzNiwx
MiBAQCB2b2lkIGZpeHVwX2lycXMoY29uc3QgY3B1bWFza190ICptYXNrLCBib29sIHZlcmJvc2Up
Cj4gICAgICB1bnNpZ25lZCBpbnQgaXJxOwo+ICAgICAgc3RhdGljIGludCB3YXJuZWQ7Cj4gICAg
ICBzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2M7Cj4gKyAgICBjcHVtYXNrX3QgKmFmZmluaXR5ID0gZ2V0
X3NjcmF0Y2hfY3B1bWFzaygpOwo+ICAKPiAgICAgIGZvciAoIGlycSA9IDA7IGlycSA8IG5yX2ly
cXM7IGlycSsrICkKPiAgICAgIHsKPiAgICAgICAgICBib29sIGJyZWFrX2FmZmluaXR5ID0gZmFs
c2UsIHNldF9hZmZpbml0eSA9IHRydWU7Cj4gICAgICAgICAgdW5zaWduZWQgaW50IHZlY3RvcjsK
PiAtICAgICAgICBjcHVtYXNrX3QgKmFmZmluaXR5ID0gdGhpc19jcHUoc2NyYXRjaF9jcHVtYXNr
KTsKPiAgCj4gICAgICAgICAgaWYgKCBpcnEgPT0gMiApCj4gICAgICAgICAgICAgIGNvbnRpbnVl
Owo+IEBAIC0yNjQwLDYgKzI2NDUsOCBAQCB2b2lkIGZpeHVwX2lycXMoY29uc3QgY3B1bWFza190
ICptYXNrLCBib29sIHZlcmJvc2UpCj4gICAgICAgICAgICAgICAgICAgICBpcnEsIENQVU1BU0tf
UFIoYWZmaW5pdHkpKTsKPiAgICAgIH0KPiAgCj4gKyAgICBwdXRfc2NyYXRjaF9jcHVtYXNrKCk7
CgpKdXN0IGFzIGEgcmVtYXJrLCBub3QgbmVjZXNzYXJpbHkgYXMgYSByZXF1ZXN0IHRvIGNoYW5n
ZSB0aGUgY29kZTogSQp3b25kZXIgaWYgZG93biB0aGUgcm9hZCB0aGlzIHByZXR0eSB3aWRlIHNj
b3BlIG9mICJob2xkaW5nIiB0aGUgbWFzawppc24ndCBnb2luZyB0byBiaXRlIHVzLCB3aGVuIGEg
ZnVuY3Rpb24gY2FsbGVkIGZyb20gaGVyZSAoaW4gYSByYW5nZQpvZiBjb2RlIG5vdCBhY3RpdmVs
eSBuZWVkaW5nIHRoZSBtYXNrKSBhbHNvIG1heSB3YW50IHRvIHVzZSB0aGUgbWFzay4KQnV0IG9m
IGNvdXJzZSB3ZSBjYW4gbWFrZSB0aGlzIGZpbmVyIGdyYWluZWQgYXQgdGhlIHBvaW50IHdoZXJl
IGl0Cm1pZ2h0IGFjdHVhbGx5IHN0YXJ0IG1hdHRlcmluZy4KCj4gQEAgLTM2NDUsMTIgKzM2NDcs
MTcgQEAgbG9uZyBkb19tbXVleHRfb3AoCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbWFzaykpICkKPiAgICAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKPiAgICAgICAg
ICAgICAgaWYgKCB1bmxpa2VseShyYykgKQo+ICsgICAgICAgICAgICB7Cj4gKyAgICAgICAgICAg
ICAgICBwdXRfc2NyYXRjaF9jcHVtYXNrKCk7Cj4gICAgICAgICAgICAgICAgICBicmVhazsKPiAr
ICAgICAgICAgICAgfQoKQWdhaW4sIGluc3RlYWQgb2YgYWRqdXN0aW5nIGFuIGVycm9yIHBhdGgs
IGhvdyBhYm91dCBtYWtpbmcgdGhpcwpoYXZlIGFuIGVtcHR5IHN0YXRlbWVudCAoaS5lLiBkcm9w
cGluZyB0aGUgYnJlYWspIGFuZCAuLi4KCj4gICAgICAgICAgICAgIGlmICggb3AuY21kID09IE1N
VUVYVF9UTEJfRkxVU0hfTVVMVEkgKQoKLi4uIGhhdmluZyB0aGlzIGJlY29tZSAiZWxzZSBpZigp
Ij8KCj4gQEAgLTQzODQsNiArNDM5Myw5IEBAIHN0YXRpYyBpbnQgX19kb191cGRhdGVfdmFfbWFw
cGluZygKPiAgICAgICAgICBicmVhazsKPiAgICAgIH0KPiAgCj4gKyAgICBpZiAoIG1hc2sgJiYg
bWFzayAhPSBkLT5kaXJ0eV9jcHVtYXNrICkKPiArICAgICAgICBwdXRfc2NyYXRjaF9jcHVtYXNr
KCk7CgpUaGUgcmlnaHQgc2lkZSBvZiB0aGUgJiYgaGVyZSBtYWtlcyB0aGluZ3MgZmVlbCBhIGxp
dHRsZSBmcmFnaWxlIGZvcgptZS4KCj4gLS0tIGEveGVuL2FyY2gveDg2L21zaS5jCj4gKysrIGIv
eGVuL2FyY2gveDg2L21zaS5jCj4gQEAgLTE1OSwxMyArMTU5LDE1IEBAIHZvaWQgbXNpX2NvbXBv
c2VfbXNnKHVuc2lnbmVkIHZlY3RvciwgY29uc3QgY3B1bWFza190ICpjcHVfbWFzaywgc3RydWN0
IG1zaV9tc2cKPiAgCj4gICAgICBpZiAoIGNwdV9tYXNrICkKPiAgICAgIHsKPiAtICAgICAgICBj
cHVtYXNrX3QgKm1hc2sgPSB0aGlzX2NwdShzY3JhdGNoX2NwdW1hc2spOwo+ICsgICAgICAgIGNw
dW1hc2tfdCAqbWFzazsKPiAgCj4gICAgICAgICAgaWYgKCAhY3B1bWFza19pbnRlcnNlY3RzKGNw
dV9tYXNrLCAmY3B1X29ubGluZV9tYXApICkKPiAgICAgICAgICAgICAgcmV0dXJuOwo+ICAKPiAr
ICAgICAgICBtYXNrID0gZ2V0X3NjcmF0Y2hfY3B1bWFzaygpOwo+ICAgICAgICAgIGNwdW1hc2tf
YW5kKG1hc2ssIGNwdV9tYXNrLCAmY3B1X29ubGluZV9tYXApOwo+ICAgICAgICAgIG1zZy0+ZGVz
dDMyID0gY3B1X21hc2tfdG9fYXBpY2lkKG1hc2spOwo+ICsgICAgICAgIHB1dF9zY3JhdGNoX2Nw
dW1hc2soKTsKPiAgICAgIH0KClRoaXMsIEkgdGhpbmssIGNvdWxkIGRvIHdpdGggYSBsaXR0bGUg
bW9yZSBjaGFuZ2luZzoKCiAgICBpZiAoIGNwdV9tYXNrICkKICAgIHsKICAgICAgICBjcHVtYXNr
X3QgKm1hc2sgPSBnZXRfc2NyYXRjaF9jcHVtYXNrKCk7CgogICAgICAgIGNwdW1hc2tfYW5kKG1h
c2ssIGNwdV9tYXNrLCAmY3B1X29ubGluZV9tYXApOwogICAgICAgIGlmICggIWNwdW1hc2tfZW1w
dHkobWFzaykgKQogICAgICAgICAgICBtc2ctPmRlc3QzMiA9IGNwdV9tYXNrX3RvX2FwaWNpZCht
YXNrKTsKICAgICAgICBwdXRfc2NyYXRjaF9jcHVtYXNrKCk7CiAgICB9CgpUaGlzIHdheSBpbnN0
ZWFkIG9mIGxvb2tpbmcgdHdpY2UgYXQgdHdvIGNwdW1hc2tfdCBpbnN0YW5jZXMsIHRoZQoybmQg
b25lIGludm9sdmVzIGp1c3Qgb25lLiBUaG91Z2h0cz8KCj4gLS0tIGEveGVuL2FyY2gveDg2L3Nt
cC5jCj4gKysrIGIveGVuL2FyY2gveDg2L3NtcC5jCj4gQEAgLTI1LDYgKzI1LDMxIEBACj4gICNp
bmNsdWRlIDxpcnFfdmVjdG9ycy5oPgo+ICAjaW5jbHVkZSA8bWFjaF9hcGljLmg+Cj4gIAo+ICtE
RUZJTkVfUEVSX0NQVV9SRUFEX01PU1RMWShjcHVtYXNrX3Zhcl90LCBzY3JhdGNoX2NwdW1hc2sp
Owo+ICsKPiArI2lmbmRlZiBOREVCVUcKPiArY3B1bWFza190ICpzY3JhdGNoX2NwdW1hc2soYm9v
bCB1c2UpCj4gK3sKPiArICAgIHN0YXRpYyBERUZJTkVfUEVSX0NQVSh2b2lkICosIHNjcmF0Y2hf
Y3B1bWFza191c2UpOwo+ICsKPiArICAgIC8qCj4gKyAgICAgKiBEdWUgdG8gcmVlbnRyYW5jeSBz
Y3JhdGNoIGNwdW1hc2sgY2Fubm90IGJlIHVzZWQgaW4gSVJRLCAjTUMgb3IgI05NSQo+ICsgICAg
ICogY29udGV4dC4KPiArICAgICAqLwo+ICsgICAgQlVHX09OKGluX2lycSgpIHx8IGluX21jKCkg
fHwgaW5fbm1pKCkpOwo+ICsKPiArICAgIGlmICggdXNlICYmIHVubGlrZWx5KHRoaXNfY3B1KHNj
cmF0Y2hfY3B1bWFza191c2UpKSApCj4gKyAgICB7Cj4gKyAgICAgICAgcHJpbnRrKCIlcDogc2Ny
YXRjaCBDUFUgbWFzayBhbHJlYWR5IGluIHVzZSBieSAlcFxuIiwKPiArICAgICAgICAgICAgICAg
X19idWlsdGluX3JldHVybl9hZGRyZXNzKDApLCB0aGlzX2NwdShzY3JhdGNoX2NwdW1hc2tfdXNl
KSk7CgpfX2J1aWx0aW5fcmV0dXJuX2FkZHJlc3MoMCkgc2ltcGx5IHNob3dzIGFub3RoZXIgdGlt
ZSB3aGF0IC4uLgoKPiArICAgICAgICBCVUcoKTsKCi4uLiB0aGlzIGFscmVhZHkgd2lsbCBzaG93
LiBJJ2Qgc3VnZ2VzdCB0byBkcm9wIGl0LiBBbHNvIEkgdGhpbmsKeW91IHdhbnQgJXBzIGhlcmUu
CgpKYW4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhl
bi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBz
Oi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

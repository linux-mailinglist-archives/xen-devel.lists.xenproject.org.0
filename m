Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C026E144B26
	for <lists+xen-devel@lfdr.de>; Wed, 22 Jan 2020 06:17:42 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iu8L6-000566-HS; Wed, 22 Jan 2020 05:14:04 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=gwqu=3L=gmail.com=bobbyeshleman@srs-us1.protection.inumbo.net>)
 id 1iu5K4-00066N-4u
 for xen-devel@lists.xenproject.org; Wed, 22 Jan 2020 02:00:48 +0000
X-Inumbo-ID: fc17ccfa-3cba-11ea-8e9a-bc764e2007e4
Received: from mail-yw1-xc43.google.com (unknown [2607:f8b0:4864:20::c43])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id fc17ccfa-3cba-11ea-8e9a-bc764e2007e4;
 Wed, 22 Jan 2020 02:00:38 +0000 (UTC)
Received: by mail-yw1-xc43.google.com with SMTP id l5so484937ywd.4
 for <xen-devel@lists.xenproject.org>; Tue, 21 Jan 2020 18:00:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=vpEygt7pt71cmYMPQQ7nfEanAzIcbZ/6gc1mqNnsgzg=;
 b=Gg1/0eA3K44GBYQww0nFhEOwP1OY8QqnSqZY2mkWfaToq91rtfBgYxRu2kloVZQ5cP
 EQYvbsUB/gewJ/XOKgi0Geg685dlQH6qBVC89zY3Ewggpqd+qoXMu+48f1CTz/dAZvIn
 2SKB2RF/P1pi6Yn0qxjY+IXCAm/vaAbJHAJFJUuBVYNzqTn/GXyKDD+1tJDlnIMgo56u
 NcueR9rbvnDiF5YmI8qruGp+4xIRlpacNw16+u5xe0YhemzmAkyeoxfth4xxLCYqhEe2
 4l22Gqun56Wmvg02UT3KdLH/0+XG0lQ04tfPneNRajYKrX7Ku4QY+wEU26hRdMwX/S4x
 fIDA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=vpEygt7pt71cmYMPQQ7nfEanAzIcbZ/6gc1mqNnsgzg=;
 b=AaqHFAMWTsXx5WSVCD+uLZ2FIW0/4W5zsDsC41K77xeMxz/woXGbLsWwe0EJtD06Ma
 bGgdsit6H4ZCJf+P1BUF8c68ZfxkD9nYSfV8frY2DDz/3m5pkZX3WiMpokUTh29ltYQp
 gsc9/hUmFIbHNSZXfqeO+H1u+6PoAAmn+4ddIVkWf38rPosklyC5gT4xcNr6eZz52AB0
 GTtZNhi70QZx6rX89eP2Al++Bvfodj50jpRmpWOXa6OtER53GgUPKD7psImwO2/j5CYR
 TvewlnQh2SK5tOXp+8MYx6FhPjo/9OqcxSNJp+l9KPN/JbYjfCny1DXE2B0/QFeYSUGg
 9BLw==
X-Gm-Message-State: APjAAAWYTgnBqAQ+uYRM8lXXzhMG8JAr0hYpvS19GFINvSOL6NGmqeKP
 iq++6O+1ENR+N1ywRkzHd6XLuiTNBU66rA==
X-Google-Smtp-Source: APXvYqzTxS8onJ7BXK9F+FCDwjiMSaGmUq4yLy00tUKIpCIQWQn5fBJHj85QgE2SbiETBy96JdNasg==
X-Received: by 2002:a81:af56:: with SMTP id x22mr6000267ywj.153.1579658436416; 
 Tue, 21 Jan 2020 18:00:36 -0800 (PST)
Received: from bobbye-pc.knology.net ([216.186.244.35])
 by smtp.gmail.com with ESMTPSA id q185sm17504248ywh.61.2020.01.21.18.00.33
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 21 Jan 2020 18:00:36 -0800 (PST)
From: Bobby Eshleman <bobbyeshleman@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 21 Jan 2020 19:58:44 -0600
Message-Id: <542daec109fc79d5f5f583c20b85ce309fbc007e.1579615303.git.bobbyeshleman@gmail.com>
X-Mailer: git-send-email 2.25.0
In-Reply-To: <cover.1579615303.git.bobbyeshleman@gmail.com>
References: <cover.1579615303.git.bobbyeshleman@gmail.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Wed, 22 Jan 2020 05:14:01 +0000
Subject: [Xen-devel] [RFC XEN PATCH 05/23] riscv: early setup code
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Bobby Eshleman <bobbyeshleman@gmail.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Bobby Eshleman <bobby.eshleman@starlab.io>,
 Dan Robertson <dan@dlrobertson.com>,
 Alistair Francis <alistair.francis@wdc.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBwYXRjaCBpbml0aWFsaXplcyB2aXJ0dWFsIG1lbW9yeSBmb3IgWGVuIGFuZCBpbml0aWFs
aXplcyBVQVJULgpKdXN0IHRoZSBiYXJlIGJvbmVzIHRvIHN0YXJ0IHNlZWluZyBvdXRwdXQuICBN
YW55IHNob3J0Y3V0cyBleGlzdCBhbmQKbWFueSBUT0RPJ3MgcmVtYWluLgoKTW9zdCBvZiB0aGlz
IHBhdGNoIGlzIG1vZGVsZWQgYWZ0ZXIgWGVuIEFSTTY0IGFuZCBYdmlzb3IuICBNYW55IHZhbHVl
cwphcmUgaGFyZGNvZGVkIGZvciB0aGUgUUVNVSB2aXJ0IGJvYXJkLCB3aXRoIFRPRE8ncyBsZWZ0
IGZvciBwdWxsaW5nCnRob3NlIHZhbHVlcyBmcm9tIHRoZSBEVEIuCgpTaWduZWQtb2ZmLWJ5OiBB
bGlzdGFpciBGcmFuY2lzIDxhbGlzdGFpci5mcmFuY2lzQHdkYy5jb20+ClNpZ25lZC1vZmYtYnk6
IEJvYmJ5IEVzaGxlbWFuIDxib2JieWVzaGxlbWFuQGdtYWlsLmNvbT4KLS0tCiB4ZW4vYXJjaC9y
aXNjdi9oZWFkLlMgIHwgMTgwICsrKysrKysrCiB4ZW4vYXJjaC9yaXNjdi9tbS5jICAgIHwgOTI1
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiB4ZW4vYXJjaC9yaXNj
di9zZXR1cC5jIHwgMTIyICsrKysrKwogMyBmaWxlcyBjaGFuZ2VkLCAxMjI3IGluc2VydGlvbnMo
KykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB4ZW4vYXJjaC9yaXNjdi9oZWFkLlMKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCB4ZW4vYXJjaC9yaXNjdi9tbS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgeGVuL2FyY2gv
cmlzY3Yvc2V0dXAuYwoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3Jpc2N2L2hlYWQuUyBiL3hlbi9h
cmNoL3Jpc2N2L2hlYWQuUwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi4w
NzEyZGY0YTNlCi0tLSAvZGV2L251bGwKKysrIGIveGVuL2FyY2gvcmlzY3YvaGVhZC5TCkBAIC0w
LDAgKzEsMTgwIEBACisjaW5jbHVkZSA8YXNtL2FzbS5oPgorI2luY2x1ZGUgPGFzbS9hc20tb2Zm
c2V0cy5oPgorI2luY2x1ZGUgPGFzbS9pbml0Lmg+CisjaW5jbHVkZSA8YXNtL2Nzci5oPgorI2lu
Y2x1ZGUgPGFzbS9jb25maWcuaD4KKworLmdsb2JhbCBfc3RhcnQKKworRU5UUlkoc3RhcnQpCisJ
LnNlY3Rpb24gLmVudHJ5LCAiYXgiLCAlcHJvZ2JpdHMKK19zdGFydDoKKwkvKiBNYXNrIGFsbCBp
bnRlcnJ1cHRzICovCisJY3NydyBDU1JfU0lFLCB6ZXJvCisKKwkvKgorCSAqIERpc2FibGUgRlBV
IHRvIGRldGVjdCBpbGxlZ2FsIHVzYWdlIG9mCisJICogZmxvYXRpbmcgcG9pbnQgaW4ga2VybmVs
IHNwYWNlCisJICovCisJbGkgdDAsIFNTVEFUVVNfRlMKKwljc3JjIENTUl9TU1RBVFVTLCB0MAor
CisJLyogU2F2ZSBIQVJUIElEIGFuZCBEVEIgYmFzZSAqLworCWxhCWE2LCBfYm9vdGNwdV9yZWcw
CisJUkVHX1MJYTAsIChhNikKKwlsYQlhNiwgX2Jvb3RjcHVfcmVnMQorCVJFR19TCWExLCAoYTYp
CisKKwkvKiBTYXZlIGxvYWQgYWRkcmVzc2VzCisJICogYTIgLT4gbG9hZCBzdGFydAorCSAqIGEz
IC0+IGxvYWQgZW5kCisJICogYTQgLT4gZXhlY3V0aW9uIHN0YXJ0CisJICogYTUgLT4gZXhlY3V0
aW9uIGVuZAorCSAqLworCWxhCWEyLCBfc3RhcnQKKwlsYQlhNiwgX19leGVjX3N0YXJ0CisJUkVH
X0wJYTQsIChhNikKKwlsYQlhNiwgX19leGVjX2VuZAorCVJFR19MCWE1LCAoYTYpCisJc3ViCWE2
LCBhNSwgYTQKKwlhZGQJYTMsIGEyLCBhNgorCWxhCWE2LCBfbG9hZF9zdGFydAorCVJFR19TCWEy
LCAoYTYpCisJbGEJYTYsIF9sb2FkX2VuZAorCVJFR19TCWEzLCAoYTYpCisJbGEJYTYsIF9lbmQK
KwlSRUdfUwlhMywgKGE2KQorCisJLyogWmVyby1vdXQgYnNzIHNlY3Rpb24gKi8KKwlsYQlhNiwg
X19ic3Nfc3RhcnQKKwlSRUdfTAlhMCwgKGE2KQorCXN1YglhMCwgYTAsIGE0CisJYWRkCWEwLCBh
MCwgYTIKKwlsYQlhNiwgX19ic3NfZW5kCisJUkVHX0wJYTEsIChhNikKKwlzdWIJYTEsIGExLCBh
NAorCWFkZAlhMSwgYTEsIGEyCitfYnNzX3plcm86CisJUkVHX1MJemVybywgKGEwKQorCWFkZAlh
MCwgYTAsIF9fU0laRU9GX1BPSU5URVJfXworCWJsdAlhMCwgYTEsIF9ic3NfemVybworCisJLyog
U2V0dXAgdGVtcG9yYXJ5IHN0YWNrICovCisJbGEJYTYsIF9faHZjX3N0YWNrX2VuZAorCVJFR19M
CWEwLCAoYTYpCisJc3ViCWEwLCBhMCwgYTQKKwlhZGQJc3AsIGEwLCBhMgorCisgICAgICAgIC8q
IFNldHVwIGhhbmcgZm9yIElSUSB2ZWN0b3Igdy8gdmlydHVhbCBhZGRyZXNzICovCisJbGEJYTYs
IF9fZGVidWdfaXJxX3ZlY3RvcgorICAgICAgICBSRUdfTCAgIGE0LCAoYTYpCisJY3NydwlDU1Jf
U1RWRUMsIGE0CisKKwkvKiBTZXR1cCBpbml0aWFsIHBhZ2UgdGFibGUgKi8KKwlsYQlhNiwgX2xv
YWRfc3RhcnQKKwlSRUdfTAlhMCwgKGE2KQorCWxhCWE2LCBfbG9hZF9lbmQKKwlSRUdfTAlhMSwg
KGE2KQorCWxhCWE2LCBfX2V4ZWNfc3RhcnQKKwlSRUdfTAlhMiwgKGE2KQorCWxhCWE2LCBfX2V4
ZWNfZW5kCisJUkVHX0wJYTMsIChhNikKKwljYWxsCV9zZXR1cF9pbml0aWFsX3BhZ2V0YWJsZXMK
KworCWoJX3N0YXJ0X3NlY29uZGFyeV9ub3BlbgorCisJLmFsaWduCTMKK19zdGFydF9sb3R0ZXJ5
OgorCVJJU0NWX1BUUgkwCisJLmFsaWduCTMKK19fc3RhcnRfc2Vjb25kYXJ5X3Blbl9yZWxlYXNl
OgorCVJJU0NWX1BUUglzdGFydF9zZWNvbmRhcnlfcGVuX3JlbGVhc2UKKworCS8qCisJICogTm90
ZTogRnJvbSB0aGlzIHBvaW50IHByaW1hcnkgQ1BVIHN0YXJ0dXAgaXMgc2FtZSBhcyBzZWNvbmRh
cnkgQ1BVCisJICovCitfc3RhcnRfc2Vjb25kYXJ5X25vcGVuOgorCS8qIFNldCB0cmFwIHZlY3Rv
ciB0byBzcGluIGZvcmV2ZXIgdG8gaGVscCBkZWJ1ZyAqLworCS8vbGEJYTYsIF9zdGFydF9oYW5n
CisJLy9jc3J3CUNTUl9TVFZFQywgYTYKKworCS8qIEp1bXAgdG8gZmluYWwgZXhlY3V0aW9uIGFk
ZHJlc3MgKi8KKwlsYQlhNiwgX19jcHVfaW5pdAorCVJFR19MCWEwLCAoYTYpCisJamFscglhMAor
Citfc3RhcnRfaGFuZzoKKwl3ZmkKKwlqCV9zdGFydF9oYW5nCisKKwkuYWxpZ24gMworX19waHlz
X29mZnNldDoKKwlSSVNDVl9QVFIgcGh5c19vZmZzZXQKK19fcGd0Ymxfcm9vdDoKKwlSSVNDVl9Q
VFIgeGVuX3NlY29uZF9wYWdldGFibGUKK19fZXhlY19zdGFydDoKKwlSSVNDVl9QVFIgX2NvZGVf
c3RhcnQKK19fZXhlY19lbmQ6CisJUklTQ1ZfUFRSIF9jb2RlX2VuZAorX19ic3Nfc3RhcnQ6CisJ
UklTQ1ZfUFRSIF9ic3Nfc3RhcnQKK19fYnNzX2VuZDoKKwlSSVNDVl9QVFIgX2Jzc19lbmQKK19f
ZGVidWdfaXJxX3ZlY3RvcjoKKwlSSVNDVl9QVFIgX3N0YXJ0X2hhbmcKK19fY3B1X2luaXQ6CisJ
UklTQ1ZfUFRSIF9jcHVfaW5pdAorCisJLyoKKwkgKiBCb290IHJlZ2lzdGVyIDAgcGFzc2VkIGJ5
IGJvb3Rsb2FkZXIKKwkgKi8KKwkuZ2xvYmwgX2Jvb3RjcHVfcmVnMAorX2Jvb3RjcHVfcmVnMDoK
KwlSSVNDVl9QVFIgMHgwCisKKwkvKgorCSAqIEJvb3QgcmVnaXN0ZXIgMSBwYXNzZWQgYnkgYm9v
dGxvYWRlcgorCSAqLworCS5nbG9ibCBfYm9vdF9yZWcxCitfYm9vdGNwdV9yZWcxOgorCVJJU0NW
X1BUUiAweDAKKworCS8qCisJICogTG9hZCBzdGFydCBhZGRyZXNzIHN0b3JhZ2UKKwkgKi8KKwku
Z2xvYmwgX2xvYWRfc3RhcnQKK19sb2FkX3N0YXJ0OgorCVJJU0NWX1BUUiAweDAKKworCS8qCisJ
ICogTG9hZCBlbmQgYWRkcmVzcyBzdG9yYWdlCisJICovCisJLmdsb2JsIF9sb2FkX2VuZAorX2xv
YWRfZW5kOgorCVJJU0NWX1BUUiAweDAKKworICAgICAgICAuZ2xvYmwgX2VuZAorX2VuZDoKKwlS
SVNDVl9QVFIgMHgwCisKKwkvKgorCSAqIEV4Y2VwdGlvbiBzdGFja3MuCisJICovCitfX2h2Y19z
dGFja19lbmQ6CisJUklTQ1ZfUFRSIF9odmNfc3RhY2tfZW5kCisKKwkuYWxpZ24gMworCS5nbG9i
bCBfY3B1X2luaXQKK19jcHVfaW5pdDoKKyAgICAgICAgLyogU2V0IHN0YWNrIHBvaW50ZXIgdG8g
dmlydHVhbCBhZGRyZXNzIGF0IGVuZCBvZiB0aGUgWGVuIGV4ZWN1dGFibGUgKi8KKwlsYQlhNiwg
X19leGVjX2VuZAorICAgICAgICBSRUdfTCAgIHNwLCAoYTYpCisKKworCS8qIEp1bXAgdG8gQyBj
b2RlICovCisJY2FsbAlzdGFydF94ZW4KKworCS8qIEhhbmcgISEhICovCisJaglfc3RhcnRfaGFu
ZworCisJcmV0CmRpZmYgLS1naXQgYS94ZW4vYXJjaC9yaXNjdi9tbS5jIGIveGVuL2FyY2gvcmlz
Y3YvbW0uYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi44N2RiMmY1YjQw
Ci0tLSAvZGV2L251bGwKKysrIGIveGVuL2FyY2gvcmlzY3YvbW0uYwpAQCAtMCwwICsxLDkyNSBA
QAorLyoKKyAqIHhlbi9hcmNoL3Jpc2N2L21tLmMKKyAqCisgKiBNTVUgY29kZSBmb3IgYSBSSVND
LVYgUlYzMi82NCB3aXRoIGh5cGVydmlzb3IgZXh0ZW5zaW9ucy4KKyAqCisgKiBDb3B5cmlnaHQg
KGMpIDIwMTkgQm9iYnkgRXNobGVtYW4gPGJvYmJ5ZXNobGVtYW5AZ21haWwuY29tPgorICoKKyAq
IEJhc2VkIG9uIGNvZGUgdGhhdCBpcyBDb3B5cmlnaHQgKGMpIDIwMTggQW51cCBQYXRlbC4KKyAq
IEJhc2VkIG9uIGNvZGUgdGhhdCBpcyBDb3B5cmlnaHQgKGMpIDIwMTEgVGltIERlZWdhbiA8dGlt
QHhlbi5vcmc+CisgKiBCYXNlZCBvbiBjb2RlIHRoYXQgaXMgQ29weXJpZ2h0IChjKSAyMDExIENp
dHJpeCBTeXN0ZW1zLgorICoKKyAqIFBhcnRzIG9mIHRoaXMgY29kZSBhcmUgYmFzZWQgb246Cisg
KiAgICAgQVJNL1hlbjogeGVuL2FyY2gvYXJtL21tLmMuCisgKiAgICAgWHZpc29yOiBhcmNoL3Jp
c2N2L2NwdS9nZW5lcmljL2NwdV9tbXVfaW5pdGlhbF9wZ3RibC5jCisgKiAgICAgICAgIChodHRw
czovL2dpdGh1Yi5jb20veHZpc29yL3h2aXNvci90cmVlL3YwLjIuMTEpCisgKgorICogVGhpcyBw
cm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBt
b2RpZnkKKyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBl
aXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogKGF0IHlvdXIgb3B0aW9uKSBh
bnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4g
dGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJS
QU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiBNRVJDSEFOVEFC
SUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiBH
TlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICovCisKKyNpbmNs
dWRlIDx4ZW4vY29tcGlsZS5oPgorI2luY2x1ZGUgPHhlbi90eXBlcy5oPgorI2luY2x1ZGUgPHhl
bi9pbml0Lmg+CisjaW5jbHVkZSA8eGVuL21tLmg+CisjaW5jbHVkZSA8YXNtL3AybS5oPgorI2lu
Y2x1ZGUgPHB1YmxpYy9kb21jdGwuaD4KKyNpbmNsdWRlIDxhc20vcGFnZS5oPgorI2luY2x1ZGUg
PHhlbi9wcmVlbXB0Lmg+CisjaW5jbHVkZSA8eGVuL2Vycm5vLmg+CisjaW5jbHVkZSA8eGVuL2dy
YW50X3RhYmxlLmg+CisjaW5jbHVkZSA8eGVuL3NvZnRpcnEuaD4KKyNpbmNsdWRlIDx4ZW4vZXZl
bnQuaD4KKyNpbmNsdWRlIDx4ZW4vZ3Vlc3RfYWNjZXNzLmg+CisjaW5jbHVkZSA8eGVuL2RvbWFp
bl9wYWdlLmg+CisjaW5jbHVkZSA8eGVuL2Vyci5oPgorI2luY2x1ZGUgPGFzbS9wYWdlLmg+Cisj
aW5jbHVkZSA8YXNtL2N1cnJlbnQuaD4KKyNpbmNsdWRlIDxhc20vZmx1c2h0bGIuaD4KKyNpbmNs
dWRlIDxwdWJsaWMvbWVtb3J5Lmg+CisjaW5jbHVkZSA8eGVuL3NjaGVkLmg+CisjaW5jbHVkZSA8
eGVuL3ZtYXAuaD4KKyNpbmNsdWRlIDx4c20veHNtLmg+CisjaW5jbHVkZSA8eGVuL3Bmbi5oPgor
I2luY2x1ZGUgPHhlbi9zaXplcy5oPgorI2luY2x1ZGUgPGFzbS9zZXR1cC5oPgorCisjaWZkZWYg
TkRFQlVHCitzdGF0aWMgaW5saW5lIHZvaWQgX19hdHRyaWJ1dGVfXygoX19mb3JtYXRfXyhfX3By
aW50Zl9fLCAxLCAyKSkpCittbV9wcmludGsoY29uc3QgY2hhciAqZm10LCAuLi4pCit7Cit9Cisj
ZWxzZQorI2RlZmluZSBtbV9wcmludGsoZm10LCBhcmdzLi4uKSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBkbyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIsIGZtdCwg
IyNhcmdzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAg
V0FSTigpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgfSB3aGlsZSAoIDAgKTsKKyNlbmRpZgorCisjZGVmaW5lIFhF
Tl9UQUJMRV9NQVBfRkFJTEVEIDAKKyNkZWZpbmUgWEVOX1RBQkxFX1NVUEVSX1BBR0UgMQorI2Rl
ZmluZSBYRU5fVEFCTEVfTk9STUFMX1BBR0UgMgorCisvKiBPdmVycmlkZSBtYWNyb3MgZnJvbSBh
c20vcGFnZS5oIHRvIG1ha2UgdGhlbSB3b3JrIHdpdGggbWZuX3QgKi8KKyN1bmRlZiB2aXJ0X3Rv
X21mbgorI2RlZmluZSB2aXJ0X3RvX21mbih2YSkgX21mbihfX3ZpcnRfdG9fbWZuKHZhKSkKKyN1
bmRlZiBtZm5fdG9fdmlydAorI2RlZmluZSBtZm5fdG9fdmlydChtZm4pIF9fbWZuX3RvX3ZpcnQo
bWZuX3gobWZuKSkKKworLyogTGltaXRzIG9mIHRoZSBYZW4gaGVhcCAqLworbWZuX3QgeGVuaGVh
cF9tZm5fc3RhcnQgX19yZWFkX21vc3RseSA9IElOVkFMSURfTUZOX0lOSVRJQUxJWkVSOworbWZu
X3QgeGVuaGVhcF9tZm5fZW5kIF9fcmVhZF9tb3N0bHk7Cit2YWRkcl90IHhlbmhlYXBfdmlydF9l
bmQgX19yZWFkX21vc3RseTsKK3ZhZGRyX3QgeGVuaGVhcF92aXJ0X3N0YXJ0IF9fcmVhZF9tb3N0
bHk7Cit1bnNpZ25lZCBsb25nIHhlbmhlYXBfYmFzZV9wZHggX19yZWFkX21vc3RseTsKKworLyog
TGltaXRzIG9mIGZyYW1ldGFibGUgKi8KK3Vuc2lnbmVkIGxvbmcgZnJhbWV0YWJsZV92aXJ0X2Vu
ZCBfX3JlYWRfbW9zdGx5OwordW5zaWduZWQgbG9uZyBmcmFtZXRhYmxlX2Jhc2VfcGR4OworCisv
KgorICogeGVuX3NlY29uZF9wYWdldGFibGUgaXMgaW5kZXhlZCB3aXRoIHRoZSBWUE5bMl0gcGFn
ZSB0YWJsZSBlbnRyeSBmaWVsZAorICogeGVuX2ZpcnN0X3BhZ2V0YWJsZSBpcyBhY2Nlc3NlZCBm
cm9tIHRoZSBWUE5bMV0gcGFnZSB0YWJsZSBlbnRyeSBmaWVsZAorICogeGVuX3plcm9ldGhfcGFn
ZXRhYmxlIGlzIGFjY2Vzc2VkIGZyb20gdGhlIFZQTlswXSBwYWdlIHRhYmxlIGVudHJ5IGZpZWxk
CisgKi8KK3B0ZV90IHhlbl9zZWNvbmRfcGFnZXRhYmxlW1BBR0VfRU5UUklFU10gX19hdHRyaWJ1
dGVfXygoX19hbGlnbmVkX18oNDA5NikpKTsKK3N0YXRpYyBwdGVfdCB4ZW5fZmlyc3RfcGFnZXRh
YmxlW1BBR0VfRU5UUklFU10KKyAgICBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXyg0MDk2KSkp
Oworc3RhdGljIHB0ZV90IHhlbl96ZXJvZXRoX3BhZ2V0YWJsZVtQQUdFX0VOVFJJRVNdCisgICAg
X19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oNDA5NikpKTsKK3N0YXRpYyBwdGVfdCB4ZW5faGVh
cF9tZWdhcGFnZXNbUEFHRV9FTlRSSUVTXQorICAgIF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9f
KDQwOTYpKSk7CisKKy8qCisgKiBUaGUgc2Vjb25kIGxldmVsIHNsb3Qgd2hpY2ggcG9pbnRzIHRv
IHhlbl9oZWFwX21lZ2FwYWdlcy4KKyAqIFRoaXMgc2xvdCBpbmRleGVzIGludG8gdGhlIFBURSB0
aGF0IHBvaW50cyB0byB0aGUgZmlyc3QgbGV2ZWwgdGFibGUKKyAqIG9mIG1lZ2FwYWdlcyB0aGF0
IHdlIHVzZWQgdG8gbWFwIGluIGFuZCB0aGVuIGluaXRpYWxpemUgb3VyIGZpcnN0CisgKiBzZXQg
b2YgYm9vdCBwYWdlcy4gIE9uY2UgaXQgaGFzIGJlZW4gdXNlZCB0byBtYXAvaW5pdCBib290IHBh
Z2UsCisgKiB0aG9zZSBwYWdlcyBjYW4gYmUgdXNlZCB0byBhbGxvYyB0aGUgcmVzdCBvZiB0aGUg
cGFnZSB0YWJsZXMgd2l0aAorICogdGhlIGFsbG9jX2Jvb3RfcGFnZXMoKS4KKyAqLworc3RhdGlj
IF9faW5pdGRhdGEgaW50IHhlbl9zZWNvbmRfaGVhcF9zbG90ID0gLTE7CisKKyNkZWZpbmUgVEhJ
U19DUFVfUEdUQUJMRSB4ZW5fc2Vjb25kX3BhZ2V0YWJsZQorCisvKiBVc2VkIGJ5IF9zZXR1cF9p
bml0aWFsX3BhZ2V0YWJsZXMoKSBhbmQgaW5pdGlhbGl6ZWQgYnkgaGVhZC5TICovCitleHRlcm4g
dW5zaWduZWQgbG9uZyBfdGV4dF9zdGFydDsKK2V4dGVybiB1bnNpZ25lZCBsb25nIF90ZXh0X2Vu
ZDsKK2V4dGVybiB1bnNpZ25lZCBsb25nIF9jcHVpbml0X3N0YXJ0OworZXh0ZXJuIHVuc2lnbmVk
IGxvbmcgX2NwdWluaXRfZW5kOworZXh0ZXJuIHVuc2lnbmVkIGxvbmcgX3NwaW5sb2NrX3N0YXJ0
OworZXh0ZXJuIHVuc2lnbmVkIGxvbmcgX3NwaW5sb2NrX2VuZDsKK2V4dGVybiB1bnNpZ25lZCBs
b25nIF9pbml0X3N0YXJ0OworZXh0ZXJuIHVuc2lnbmVkIGxvbmcgX2luaXRfZW5kOworZXh0ZXJu
IHVuc2lnbmVkIGxvbmcgX3JvZGF0YV9zdGFydDsKK2V4dGVybiB1bnNpZ25lZCBsb25nIF9yb2Rh
dGFfZW5kOworCitwYWRkcl90IHBoeXNfb2Zmc2V0OwordW5zaWduZWQgbG9uZyBtYXhfcGFnZTsK
Kworc3RhdGljIGlubGluZSBwdGVfdCBtZm5fdG9fcHRlKG1mbl90IG1mbikKK3sKKyAgICB1bnNp
Z25lZCBsb25nIHB0ZSA9IG1mbl94KG1mbikgPDwgUFRFX1NISUZUOworICAgIHJldHVybiAocHRl
X3QpeyAucHRlID0gcHRlIH07Cit9CisKK3ZvaWQgKl9faW5pdCBhcmNoX3ZtYXBfdmlydF9lbmQo
dm9pZCkKK3sKKyAgICByZXR1cm4gKHZvaWQgKilWTUFQX1ZJUlRfRU5EOworfQorCitzdGF0aWMg
aW5saW5lIHB0ZV90IG1mbl90b194ZW5fZW50cnkobWZuX3QgbWZuKQoreworICAgIHJldHVybiBt
Zm5fdG9fcHRlKG1mbik7Cit9CisKKy8qIE1hcCBhIDRrIHBhZ2UgaW4gYSBmaXhtYXAgZW50cnkg
Ki8KK3ZvaWQgc2V0X2ZpeG1hcCh1bnNpZ25lZCBtYXAsIG1mbl90IG1mbiwgdW5zaWduZWQgaW50
IGZsYWdzKQoreworICAgIC8qIFRPRE8gKi8KK30KKworLyogUmVtb3ZlIGEgbWFwcGluZyBmcm9t
IGEgZml4bWFwIGVudHJ5ICovCit2b2lkIGNsZWFyX2ZpeG1hcCh1bnNpZ25lZCBtYXApCit7Cisg
ICAgLyogVE9ETyAqLworfQorCisjaWZkZWYgQ09ORklHX0RPTUFJTl9QQUdFCit2b2lkICptYXBf
ZG9tYWluX3BhZ2VfZ2xvYmFsKG1mbl90IG1mbikKK3sKKyAgICByZXR1cm4gdm1hcCgmbWZuLCAx
KTsKK30KKwordm9pZCB1bm1hcF9kb21haW5fcGFnZV9nbG9iYWwoY29uc3Qgdm9pZCAqdmEpCit7
CisgICAgdnVubWFwKHZhKTsKK30KKyNlbmRpZgorCit2b2lkIGZsdXNoX3BhZ2VfdG9fcmFtKHVu
c2lnbmVkIGxvbmcgbWZuLCBib29sIHN5bmNfaWNhY2hlKQoreworICAgIHZvaWQgKnZhID0gbWFw
X2RvbWFpbl9wYWdlKF9tZm4obWZuKSk7CisgICAgdW5tYXBfZG9tYWluX3BhZ2UodmEpOworCisg
ICAgLyogVE9ETyAqLworCisgICAgaWYgKCBzeW5jX2ljYWNoZSApCisgICAgICAgIGludmFsaWRh
dGVfaWNhY2hlKCk7Cit9CisKK2VudW0geGVubWFwX29wZXJhdGlvbiB7IElOU0VSVCwgUkVNT1ZF
LCBNT0RJRlksIFJFU0VSVkUgfTsKKworc3RhdGljIGludCBhbGxvY194ZW5fdGFibGUocHRlX3Qg
KmVudHJ5KQoreworICAgIHZvaWQgKnA7CisgICAgcHRlX3QgcHRlOworCisgICAgcCA9IGFsbG9j
X3hlbmhlYXBfcGFnZSgpOworICAgIGlmICggcCA9PSBOVUxMICkKKyAgICAgICAgcmV0dXJuIC1F
Tk9NRU07CisKKyAgICBjbGVhcl9wYWdlKHApOworICAgIHB0ZSA9IG1mbl90b194ZW5fZW50cnko
bWFkZHJfdG9fbWZuKHZpcnRfdG9fbWFkZHIocCkpKTsKKyAgICBwdGUucHRlIHw9IFBURV9UQUJM
RTsKKworICAgIHdyaXRlX3B0ZShlbnRyeSwgcHRlKTsKKyAgICByZXR1cm4gMDsKK30KKworc3Rh
dGljIGludCB4ZW5fcHRfdXBkYXRlKHVuc2lnbmVkIGxvbmcgdmEsIG1mbl90IG1mbiwgdW5zaWdu
ZWQgaW50IGZsYWdzKQoreworICAgIHB0ZV90ICplbnRyeTsKKyAgICBwdGVfdCAqZmlyc3Q7Cisg
ICAgcHRlX3QgKnplcm9ldGg7CisKKyAgICBwdGVfdCBwdGU7CisgICAgaW50IHJjOworCisgICAg
aWYgKCBtZm5fZXEobWZuLCBJTlZBTElEX01GTikgKQorICAgIHsKKyAgICAgICAgcmV0dXJuIC1F
SU5WQUw7CisgICAgfQorCisgICAgLyogVE9ETzogU3VwcG9ydCBwYWdldGFibGUgcm9vdCBmb3Ig
ZGlmZmVyZW50IENQVXMgKFNNUCkgKi8KKyAgICBlbnRyeSA9ICZ4ZW5fc2Vjb25kX3BhZ2V0YWJs
ZVtwYWdldGFibGVfc2Vjb25kX2luZGV4KHZhKV07CisgICAgaWYgKCAhcHRlX2lzX3ZhbGlkKGVu
dHJ5KSApCisgICAgeworICAgICAgICByYyA9IGFsbG9jX3hlbl90YWJsZShlbnRyeSk7CisgICAg
ICAgIGlmICggcmMgKQorICAgICAgICB7CisgICAgICAgICAgICByZXR1cm4gcmM7CisgICAgICAg
IH0KKyAgICB9CisgICAgZWxzZSBpZiAoIHB0ZV9pc19sZWFmKGVudHJ5KSApCisgICAgeworICAg
ICAgICAvKiBCcmVha2luZyB1cCBnaWdhcGFnZXMgaXMgbm90IHN1cHBvcnRlZCAqLworICAgICAg
ICByZXR1cm4gLUVPUE5PVFNVUFA7CisgICAgfQorCisgICAgZmlyc3QgPSAocHRlX3QgKiltYWRk
cl90b192aXJ0KHB0ZV90b19wYWRkcihlbnRyeSkpOworCisgICAgZW50cnkgPSAmZmlyc3RbcGFn
ZXRhYmxlX2ZpcnN0X2luZGV4KHZhKV07CisgICAgaWYgKCAhcHRlX2lzX3ZhbGlkKGVudHJ5KSAp
CisgICAgeworICAgICAgICByYyA9IGFsbG9jX3hlbl90YWJsZShlbnRyeSk7CisgICAgICAgIGlm
ICggcmMgKQorICAgICAgICB7CisgICAgICAgICAgICByZXR1cm4gcmM7CisgICAgICAgIH0KKyAg
ICB9CisgICAgZWxzZSBpZiAoIHB0ZV9pc19sZWFmKGVudHJ5KSApCisgICAgeworICAgICAgICAv
KiBCcmVha2luZyB1cCBtZWdhcGFnZXMgaXMgbm90IHN1cHBvcnRlZCAqLworICAgICAgICByZXR1
cm4gLUVPUE5PVFNVUFA7CisgICAgfQorCisgICAgemVyb2V0aCA9IChwdGVfdCAqKW1hZGRyX3Rv
X3ZpcnQocHRlX3RvX3BhZGRyKGVudHJ5KSk7CisKKyAgICBlbnRyeSA9ICZ6ZXJvZXRoW3BhZ2V0
YWJsZV96ZXJvZXRoX2luZGV4KHZhKV07CisgICAgcHRlID0gbWZuX3RvX3hlbl9lbnRyeShtZm4p
OworICAgIHB0ZS5wdGUgfD0gUFRFX0xFQUZfREVGQVVMVDsKKyAgICB3cml0ZV9wdGUoZW50cnks
IHB0ZSk7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIERFRklORV9TUElOTE9DSyh4ZW5f
cHRfbG9jayk7CisKK2ludCBtYXBfcGFnZXNfdG9feGVuKHVuc2lnbmVkIGxvbmcgdmlydCwgbWZu
X3QgbWZuLCB1bnNpZ25lZCBsb25nIG5yX21mbnMsCisgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgZmxhZ3MpCit7CisgICAgaW50IHJjID0gMDsKKyAgICB1bnNpZ25lZCBsb25nIGFk
ZHIgPSB2aXJ0LCBhZGRyX2VuZCA9IGFkZHIgKyBucl9tZm5zICogUEFHRV9TSVpFOworCisgICAg
cmMgPSAxOworCisgICAgaWYgKCAhSVNfQUxJR05FRCh2aXJ0LCBQQUdFX1NJWkUpICkKKyAgICB7
CisgICAgICAgIG1tX3ByaW50aygiVGhlIHZpcnR1YWwgYWRkcmVzcyBpcyBub3QgYWxpZ25lZCB0
byB0aGUgcGFnZS1zaXplLlxuIik7CisgICAgICAgIHJldHVybiAtRUlOVkFMOworICAgIH0KKwor
ICAgIHNwaW5fbG9jaygmeGVuX3B0X2xvY2spOworICAgIHdoaWxlICggYWRkciA8IGFkZHJfZW5k
ICkKKyAgICB7CisgICAgICAgIHJjID0geGVuX3B0X3VwZGF0ZShhZGRyLCBtZm4sIGZsYWdzKTsK
KyAgICAgICAgaWYgKCByYyA9PSBYRU5fVEFCTEVfTUFQX0ZBSUxFRCApCisgICAgICAgICAgICBi
cmVhazsKKworICAgICAgICBtZm4gPSBtZm5fYWRkKG1mbiwgMSk7CisgICAgICAgIGFkZHIgKz0g
UEFHRV9TSVpFOworICAgIH0KKworICAgIC8qCisgICAgICogRmx1c2ggdGhlIFRMQnMgZXZlbiBp
biBjYXNlIG9mIGZhaWx1cmUgYmVjYXVzZSB3ZSBtYXkgaGF2ZQorICAgICAqIHBhcnRpYWxseSBt
b2RpZmllZCB0aGUgUFQuIFRoaXMgd2lsbCBwcmV2ZW50IGFueSB1bmV4cGVjdGVkCisgICAgICog
YmVoYXZpb3IgYWZ0ZXJ3YXJkcy4KKyAgICAgKi8KKyAgICBhc20gdm9sYXRpbGUoInNmZW5jZS52
bWEiKTsKKyAgICBzcGluX3VubG9jaygmeGVuX3B0X2xvY2spOworCisgICAgcmV0dXJuIDA7Cit9
CisKK2ludCBwb3B1bGF0ZV9wdF9yYW5nZSh1bnNpZ25lZCBsb25nIHZpcnQsIHVuc2lnbmVkIGxv
bmcgbnJfbWZucykKK3sKKyAgICAodm9pZCkgdmlydDsKKyAgICAodm9pZCkgbnJfbWZuczsKKwor
ICAgIC8qIFRPRE8gKi8KKworICAgIHJldHVybiAgMDsKK30KKworaW50IGRlc3Ryb3lfeGVuX21h
cHBpbmdzKHVuc2lnbmVkIGxvbmcgdiwgdW5zaWduZWQgbG9uZyBlKQoreworICAgICh2b2lkKSB2
OworICAgICh2b2lkKSBlOworCisgICAgLyogVE9ETyAqLworCisgICAgcmV0dXJuIDA7Cit9CisK
K2ludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9uZyBl
LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisgICAgKHZvaWQpIHM7CisgICAgKHZvaWQpIGU7Cisg
ICAgKHZvaWQpIGZsYWdzOworCisgICAgLyogVE9ETyAqLworCisgICAgcmV0dXJuIDA7Cit9CisK
K3ZvaWQgYXJjaF9kdW1wX3NoYXJlZF9tZW1faW5mbyh2b2lkKQoreworICAgIC8qIFRPRE8gKi8K
K30KKworaW50IGRvbmF0ZV9wYWdlKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2UsIHVuc2lnbmVkIGludCBtZW1mbGFncykKK3sKKyAgICBBU1NFUlRfVU5SRUFDSEFCTEUo
KTsKKyAgICByZXR1cm4gLUVOT1NZUzsKK30KKworaW50IHN0ZWFsX3BhZ2Uoc3RydWN0IGRvbWFp
biAqZCwgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IG1lbWZsYWdzKQorewor
ICAgIHJldHVybiAtRU9QTk9UU1VQUDsKK30KKworaW50IHBhZ2VfaXNfcmFtX3R5cGUodW5zaWdu
ZWQgbG9uZyBtZm4sIHVuc2lnbmVkIGxvbmcgbWVtX3R5cGUpCit7CisgICAgQVNTRVJUX1VOUkVB
Q0hBQkxFKCk7CisgICAgcmV0dXJuIDA7Cit9CisKK3Vuc2lnbmVkIGxvbmcgZG9tYWluX2dldF9t
YXhpbXVtX2dwZm4oc3RydWN0IGRvbWFpbiAqZCkKK3sKKyAgICByZXR1cm4gZ2ZuX3goZC0+YXJj
aC5wMm0ubWF4X21hcHBlZF9nZm4pOworfQorCit2b2lkIHNoYXJlX3hlbl9wYWdlX3dpdGhfZ3Vl
c3Qoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgc3RydWN0IGRvbWFpbiAqZCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBlbnVtIFhFTlNIQVJFX2ZsYWdzIGZsYWdzKQoreworICAgIGlm
ICggcGFnZV9nZXRfb3duZXIocGFnZSkgPT0gZCApCisgICAgICAgIHJldHVybjsKKworICAgIHNw
aW5fbG9jaygmZC0+cGFnZV9hbGxvY19sb2NrKTsKKworICAgIC8qIFRPRE8gKi8KKworICAgIHNw
aW5fdW5sb2NrKCZkLT5wYWdlX2FsbG9jX2xvY2spOworfQorCitpbnQgeGVubWVtX2FkZF90b19w
aHlzbWFwX29uZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQgc3BhY2UsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1bmlvbiB4ZW5fYWRkX3RvX3BoeXNtYXBfYmF0Y2hfZXh0
cmEgZXh0cmEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGlk
eCwgZ2ZuX3QgZ2ZuKQoreworICAgIC8qIFRPRE8gKi8KKworICAgIHJldHVybiAwOworfQorCits
b25nIGFyY2hfbWVtb3J5X29wKGludCBvcCwgWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh2b2lkKSBh
cmcpCit7CisgICAgLyogVE9ETyAqLworICAgIHJldHVybiAwOworfQorCitzdHJ1Y3QgZG9tYWlu
ICpwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCit7
CisgICAgdW5zaWduZWQgbG9uZyB4LCB5ID0gcGFnZS0+Y291bnRfaW5mbzsKKyAgICBzdHJ1Y3Qg
ZG9tYWluICpvd25lcjsKKworICAgIGRvCisgICAgeworICAgICAgICB4ID0geTsKKyAgICAgICAg
LyoKKyAgICAgICAgICogQ291bnQgPT0gIDA6IFBhZ2UgaXMgbm90IGFsbG9jYXRlZCwgc28gd2Ug
Y2Fubm90IHRha2UgYSByZWZlcmVuY2UuCisgICAgICAgICAqIENvdW50ID09IC0xOiBSZWZlcmVu
Y2UgY291bnQgd291bGQgd3JhcCwgd2hpY2ggaXMgaW52YWxpZC4KKyAgICAgICAgICovCisgICAg
ICAgIGlmICggdW5saWtlbHkoKCh4ICsgMSkgJiBQR0NfY291bnRfbWFzaykgPD0gMSkgKQorICAg
ICAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfSB3aGlsZSAoICh5ID0gY21weGNoZygmcGFnZS0+
Y291bnRfaW5mbywgeCwgeCArIDEpKSAhPSB4ICk7CisKKyAgICBvd25lciA9IHBhZ2VfZ2V0X293
bmVyKHBhZ2UpOworICAgIEFTU0VSVChvd25lcik7CisKKyAgICByZXR1cm4gb3duZXI7Cit9CisK
K3ZvaWQgcHV0X3BhZ2Uoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBs
b25nIG54LCB4LCB5ID0gcGFnZS0+Y291bnRfaW5mbzsKKworICAgIGRvCisgICAgeworICAgICAg
ICBBU1NFUlQoKHkgJiBQR0NfY291bnRfbWFzaykgIT0gMCk7CisgICAgICAgIHggPSB5OworICAg
ICAgICBueCA9IHggLSAxOworICAgIH0gd2hpbGUgKCB1bmxpa2VseSgoeSA9IGNtcHhjaGcoJnBh
Z2UtPmNvdW50X2luZm8sIHgsIG54KSkgIT0geCkgKTsKKworICAgIGlmICggdW5saWtlbHkoKG54
ICYgUEdDX2NvdW50X21hc2spID09IDApICkKKyAgICB7CisgICAgICAgIGZyZWVfZG9taGVhcF9w
YWdlKHBhZ2UpOworICAgIH0KK30KKworaW50IGdldF9wYWdlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UsIHN0cnVjdCBkb21haW4gKmRvbWFpbikKK3sKKyAgICBzdHJ1Y3QgZG9tYWluICpvd25lciA9
IHBhZ2VfZ2V0X293bmVyX2FuZF9yZWZlcmVuY2UocGFnZSk7CisKKyAgICBpZiAoIGxpa2VseShv
d25lciA9PSBkb21haW4pICkKKyAgICAgICAgcmV0dXJuIDE7CisKKyAgICBpZiAoIG93bmVyICE9
IE5VTEwgKQorICAgICAgICBwdXRfcGFnZShwYWdlKTsKKworICAgIHJldHVybiAwOworfQorCisv
KiBDb21tb24gY29kZSByZXF1aXJlcyBnZXRfcGFnZV90eXBlIGFuZCBwdXRfcGFnZV90eXBlLgor
ICogV2UgZG9uJ3QgY2FyZSBhYm91dCB0eXBlY291bnRzIHNvIHdlIGp1c3QgZG8gdGhlIG1pbmlt
dW0gdG8gbWFrZSBpdAorICogaGFwcHkuICovCitpbnQgZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCit7CisgICAgcmV0dXJuIDE7Cit9CisK
K3ZvaWQgcHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQoreworICAgIHJldHVy
bjsKK30KKworLyoKKyAqIFRoaXMgZnVuY3Rpb24gc2hvdWxkIG9ubHkgYmUgdXNlZCB0byByZW1h
cCBkZXZpY2UgYWRkcmVzcyByYW5nZXMKKyAqIFRPRE86IGFkZCBhIGNoZWNrIHRvIHZlcmlmeSB0
aGlzIGFzc3VtcHRpb24KKyAqLwordm9pZCAqaW9yZW1hcF9hdHRyKHBhZGRyX3QgcGEsIHNpemVf
dCBsZW4sIHVuc2lnbmVkIGludCBhdHRyaWJ1dGVzKQoreworICAgIG1mbl90IG1mbiA9IF9tZm4o
UEZOX0RPV04ocGEpKTsKKyAgICB1bnNpZ25lZCBpbnQgb2ZmcyA9IHBhICYgKFBBR0VfU0laRSAt
IDEpOworICAgIHVuc2lnbmVkIGludCBuciA9IFBGTl9VUChvZmZzICsgbGVuKTsKKworICAgIHZv
aWQgKnB0ciA9IF9fdm1hcCgmbWZuLCBuciwgMSwgMSwgYXR0cmlidXRlcywgVk1BUF9ERUZBVUxU
KTsKKworICAgIGlmICggcHRyID09IE5VTEwgKQorICAgICAgICByZXR1cm4gTlVMTDsKKworICAg
IHJldHVybiBwdHIgKyBvZmZzOworfQorCit2b2lkICppb3JlbWFwKHBhZGRyX3QgcGEsIHNpemVf
dCBsZW4pCit7CisgICAgcmV0dXJuIGlvcmVtYXBfYXR0cihwYSwgbGVuLCBQQUdFX0hZUEVSVklT
T1JfTk9DQUNIRSk7Cit9CisKK3ZvaWQgZ250dGFiX2NsZWFyX2ZsYWdzKHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbmVkIGxvbmcgbnIsIHVpbnQxNl90ICphZGRyKQoreworICAgIC8qCisgICAgICog
Tm90ZSB0aGF0IHRoaXMgY2Fubm90IGJlIGNsZWFyX2JpdCgpLCBhcyB0aGUgYWNjZXNzIG11c3Qg
YmUKKyAgICAgKiBjb25maW5lZCB0byB0aGUgc3BlY2lmaWVkIDIgYnl0ZXMuCisgICAgICovCisg
ICAgdWludDE2X3QgbWFzayA9IH4oMSA8PCBuciksIG9sZDsKKworICAgIGRvCisgICAgeworICAg
ICAgICBvbGQgPSAqYWRkcjsKKyAgICB9IHdoaWxlICggY21weGNoZyhhZGRyLCBvbGQsIG9sZCAm
IG1hc2spICE9IG9sZCApOworfQorCit2b2lkIGdudHRhYl9tYXJrX2RpcnR5KHN0cnVjdCBkb21h
aW4gKmQsIG1mbl90IG1mbikKK3sKKyAgICAvKiBYWFg6IG1hcmsgZGlydHkgKi8KKyAgICBzdGF0
aWMgaW50IHdhcm5pbmc7CisgICAgaWYgKCAhd2FybmluZyApCisgICAgeworICAgICAgICBnZHBy
aW50ayhYRU5MT0dfV0FSTklORywgImdudHRhYl9tYXJrX2RpcnR5IG5vdCBpbXBsZW1lbnRlZCB5
ZXRcbiIpOworICAgICAgICB3YXJuaW5nID0gMTsKKyAgICB9Cit9CisKK2ludCBjcmVhdGVfZ3Jh
bnRfaG9zdF9tYXBwaW5nKHVuc2lnbmVkIGxvbmcgYWRkciwgbWZuX3QgZnJhbWUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MsIHVuc2lnbmVkIGludCBj
YWNoZV9mbGFncykKK3sKKyAgICBpbnQgcmM7CisgICAgcDJtX3R5cGVfdCB0ID0gcDJtX2dyYW50
X21hcF9ydzsKKworICAgIGlmICggY2FjaGVfZmxhZ3MgfHwgKGZsYWdzICYgfkdOVE1BUF9yZWFk
b25seSkgIT0gR05UTUFQX2hvc3RfbWFwICkKKyAgICAgICAgcmV0dXJuIEdOVFNUX2dlbmVyYWxf
ZXJyb3I7CisKKyAgICBpZiAoIGZsYWdzICYgR05UTUFQX3JlYWRvbmx5ICkKKyAgICAgICAgdCA9
IHAybV9ncmFudF9tYXBfcm87CisKKyAgICByYyA9IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KGN1
cnJlbnQtPmRvbWFpbiwgZ2FkZHJfdG9fZ2ZuKGFkZHIpLCBmcmFtZSwgMCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHQpOworCisgICAgaWYgKCByYyApCisgICAgICAgIHJldHVy
biBHTlRTVF9nZW5lcmFsX2Vycm9yOworICAgIGVsc2UKKyAgICAgICAgcmV0dXJuIEdOVFNUX29r
YXk7Cit9CisKK2ludCByZXBsYWNlX2dyYW50X2hvc3RfbWFwcGluZyh1bnNpZ25lZCBsb25nIGFk
ZHIsIG1mbl90IG1mbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBs
b25nIG5ld19hZGRyLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisgICAgZ2ZuX3QgZ2ZuID0gZ2Fk
ZHJfdG9fZ2ZuKGFkZHIpOworICAgIHN0cnVjdCBkb21haW4gKmQgPSBjdXJyZW50LT5kb21haW47
CisgICAgaW50IHJjOworCisgICAgaWYgKCBuZXdfYWRkciAhPSAwIHx8IChmbGFncyAmIEdOVE1B
UF9jb250YWluc19wdGUpICkKKyAgICAgICAgcmV0dXJuIEdOVFNUX2dlbmVyYWxfZXJyb3I7CisK
KyAgICByYyA9IGd1ZXN0X3BoeXNtYXBfcmVtb3ZlX3BhZ2UoZCwgZ2ZuLCBtZm4sIDApOworCisg
ICAgcmV0dXJuIHJjID8gR05UU1RfZ2VuZXJhbF9lcnJvciA6IEdOVFNUX29rYXk7Cit9CisKK2Jv
b2wgaXNfaW9tZW1fcGFnZShtZm5fdCBtZm4pCit7CisgICAgcmV0dXJuICFtZm5fdmFsaWQobWZu
KTsKK30KKwordW5zaWduZWQgbG9uZyBnZXRfdXBwZXJfbWZuX2JvdW5kKHZvaWQpCit7CisgICAg
LyogTm8gbWVtb3J5IGhvdHBsdWcgeWV0LCBzbyBjdXJyZW50IG1lbW9yeSBsaW1pdCBpcyB0aGUg
ZmluYWwgb25lLiAqLworICAgIHJldHVybiBtYXhfcGFnZSAtIDE7Cit9CisKK3N0YXRpYyB2b2lk
IHNldHVwX3NlY29uZF9sZXZlbF9tYXBwaW5ncyhwdGVfdCAqZmlyc3RfcGFnZXRhYmxlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgdmFkZHIp
Cit7CisgICAgdW5zaWduZWQgbG9uZyBwYWRkcjsKKyAgICB1bnNpZ25lZCBsb25nIGluZGV4Owor
ICAgIHB0ZV90ICpwOworCisgICAgaW5kZXggPSBwYWdldGFibGVfc2Vjb25kX2luZGV4KHZhZGRy
KTsKKyAgICBwID0gJnhlbl9zZWNvbmRfcGFnZXRhYmxlW2luZGV4XTsKKworICAgIGlmICggIXB0
ZV9pc192YWxpZChwKSApCisgICAgeworICAgICAgICBwYWRkciA9IHBoeXNfb2Zmc2V0ICsgKCh1
bnNpZ25lZCBsb25nKWZpcnN0X3BhZ2V0YWJsZSk7CisgICAgICAgIHAtPnB0ZSA9IGFkZHJfdG9f
cHBuKHBhZGRyKTsKKyAgICAgICAgcC0+cHRlIHw9IFBURV9UQUJMRTsKKyAgICB9Cit9CisKK3Zv
aWQgc2V0dXBfbWVnYXBhZ2VzKHB0ZV90ICpmaXJzdF9wYWdldGFibGUsIHVuc2lnbmVkIGxvbmcg
dmlydHVhbF9zdGFydCwKKyAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcGh5c2lj
YWxfc3RhcnQsIHVuc2lnbmVkIGxvbmcgcGFnZV9jbnQpCit7CisgICAgdW5zaWduZWQgbG9uZyBm
cmFtZV9hZGRyID0gcGh5c2ljYWxfc3RhcnQ7CisgICAgdW5zaWduZWQgbG9uZyBlbmQgPSBwaHlz
aWNhbF9zdGFydCArIChwYWdlX2NudCA8PCBQQUdFX1NISUZUKTsKKyAgICB1bnNpZ25lZCBsb25n
IHZhZGRyID0gdmlydHVhbF9zdGFydDsKKyAgICB1bnNpZ25lZCBsb25nIGluZGV4OworICAgIHB0
ZV90ICpwOworCisgICAgQlVHX09OKCFJU19BTElHTkVEKHBoeXNpY2FsX3N0YXJ0LCBGSVJTVF9T
SVpFKSk7CisKKyAgICB3aGlsZSAoIGZyYW1lX2FkZHIgPCBlbmQgKQorICAgIHsKKyAgICAgICAg
c2V0dXBfc2Vjb25kX2xldmVsX21hcHBpbmdzKGZpcnN0X3BhZ2V0YWJsZSwgdmFkZHIpOworCisg
ICAgICAgIGluZGV4ID0gcGFnZXRhYmxlX2ZpcnN0X2luZGV4KHZhZGRyKTsKKyAgICAgICAgcCA9
ICZmaXJzdF9wYWdldGFibGVbaW5kZXhdOworICAgICAgICBwLT5wdGUgPSBwYWRkcl90b19tZWdh
cGFnZV9wcG4oZnJhbWVfYWRkcik7CisgICAgICAgIHAtPnB0ZSB8PSBQVEVfTEVBRl9ERUZBVUxU
OworCisgICAgICAgIGZyYW1lX2FkZHIgKz0gRklSU1RfU0laRTsKKyAgICAgICAgdmFkZHIgKz0g
RklSU1RfU0laRTsKKyAgICB9CisKKyAgICBhc20gdm9sYXRpbGUoInNmZW5jZS52bWEiKTsKK30K
KworLyoKKyAqIENvbnZlcnQgYSB2aXJ0dWFsIGFkZHJlc3MgdG8gYSBQVEUgd2l0aCB0aGUgY29y
cmVjdCBQUE4uCisgKgorICogV0FSTklORzogT25seSB1c2UgdGhpcyBmdW5jdGlvbiB3aGlsZSB0
aGUgcGh5c2ljYWwgYWRkcmVzc2VzCisgKiBvZiBYZW4gYXJlIHN0aWxsIG1hcHBlZCBpbiBhcyB2
aXJ0dWFsIGFkZHJlc3NlcyBPUiBiZWZvcmUKKyAqIHRoZSBNTVUgaXMgZW5hYmxlZCAoaS5lLiwg
cGh5c19vZmZzZXQgbXVzdCBzdGlsbCBiZSB2YWxpZCkuCisgKi8KK3N0YXRpYyBpbmxpbmUgcHRl
X3QgcHRlX29mX3hlbmFkZHIodmFkZHJfdCB2YSkKK3sKKyAgICBwYWRkcl90IG1hID0gdmEgKyBw
aHlzX29mZnNldDsKKyAgICByZXR1cm4gbWZuX3RvX3hlbl9lbnRyeShtYWRkcl90b19tZm4obWEp
KTsKK30KKworLyogQ3JlYXRlcyBtZWdhcGFnZXMgb2YgMk1CIHNpemUgYmFzZWQgb24gc3YzOSBz
cGVjICovCit2b2lkIF9faW5pdCBzZXR1cF94ZW5oZWFwX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcg
YmFzZV9tZm4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxv
bmcgbnJfbWZucykKK3sKKyAgICB1bnNpZ25lZCBsb25nIG1mbiwgZW5kX21mbjsKKyAgICB2YWRk
cl90IHZhZGRyOworICAgIHB0ZV90ICpmaXJzdCwgcHRlOworCisgICAgLyogQWxpZ24gdG8gcHJl
dmlvdXMgMk1CIGJvdW5kYXJ5ICovCisgICAgbWZuID0gYmFzZV9tZm4gJiB+KChGSVJTVF9TSVpF
ID4+IFBBR0VfU0hJRlQpIC0gMSk7CisKKyAgICAvKiBGaXJzdCBjYWxsIHNldHMgdGhlIHhlbmhl
YXAgcGh5c2ljYWwgYW5kIHZpcnR1YWwgb2Zmc2V0LiAqLworICAgIGlmICggbWZuX2VxKHhlbmhl
YXBfbWZuX3N0YXJ0LCBJTlZBTElEX01GTikgKQorICAgIHsKKyAgICAgICAgeGVuaGVhcF9tZm5f
c3RhcnQgPSBfbWZuKGJhc2VfbWZuKTsKKyAgICAgICAgeGVuaGVhcF9iYXNlX3BkeCA9IG1mbl90
b19wZHgoX21mbihiYXNlX21mbikpOworICAgICAgICB4ZW5oZWFwX3ZpcnRfc3RhcnQgPQorICAg
ICAgICAgICAgRElSRUNUTUFQX1ZJUlRfU1RBUlQgKyAoYmFzZV9tZm4gLSBtZm4pICogUEFHRV9T
SVpFOworICAgIH0KKworICAgIGlmICggYmFzZV9tZm4gPCBtZm5feCh4ZW5oZWFwX21mbl9zdGFy
dCkgKQorICAgICAgICBwYW5pYygiY2Fubm90IGFkZCB4ZW5oZWFwIG1hcHBpbmcgYXQgJWx4IGJl
bG93IGhlYXAgc3RhcnQgJWx4XG4iLAorICAgICAgICAgICAgICBiYXNlX21mbiwgbWZuX3goeGVu
aGVhcF9tZm5fc3RhcnQpKTsKKworICAgIGVuZF9tZm4gPSBiYXNlX21mbiArIG5yX21mbnM7CisK
KyAgICAvKgorICAgICAqIFZpcnR1YWwgYWRkcmVzcyBhbGlnbmVkIHRvIHByZXZpb3VzIDJNQiB0
byBtYXRjaCBwaHlzaWNhbAorICAgICAqIGFkZHJlc3MgYWxpZ25tZW50IGRvbmUgYWJvdmUuCisg
ICAgICovCisgICAgdmFkZHIgPSAodmFkZHJfdClfX21mbl90b192aXJ0KGJhc2VfbWZuKSAmIChT
RUNPTkRfTUFTSyB8IEZJUlNUX01BU0spOworCisgICAgd2hpbGUgKCBtZm4gPCBlbmRfbWZuICkK
KyAgICB7CisgICAgICAgIHVuc2lnbmVkIGxvbmcgc2xvdCA9IHBhZ2V0YWJsZV9zZWNvbmRfaW5k
ZXgodmFkZHIpOworICAgICAgICBwdGVfdCAqcCA9ICZ4ZW5fc2Vjb25kX3BhZ2V0YWJsZVtzbG90
XTsKKworICAgICAgICBpZiAoIHB0ZV9pc192YWxpZChwKSApCisgICAgICAgIHsKKyAgICAgICAg
ICAgIC8qIG1mbl90b192aXJ0IGlzIG5vdCB2YWxpZCBvbiB0aGUgeGVuX2hlYXBfbWVnYXBhZ2Vz
IG1mbiwgc2luY2UgaXQKKyAgICAgICAgICAgICAqIGlzIG5vdCB3aXRoaW4gdGhlIHhlbmhlYXAu
ICovCisgICAgICAgICAgICBmaXJzdCA9IChzbG90ID09IHhlbl9zZWNvbmRfaGVhcF9zbG90KQor
ICAgICAgICAgICAgICAgICAgICAgICAgPyB4ZW5faGVhcF9tZWdhcGFnZXMKKyAgICAgICAgICAg
ICAgICAgICAgICAgIDogbWZuX3RvX3ZpcnQocHRlX2dldF9tZm4oKnApKTsKKyAgICAgICAgfQor
ICAgICAgICBlbHNlIGlmICggeGVuX3NlY29uZF9oZWFwX3Nsb3QgPT0gLTEgKQorICAgICAgICB7
CisgICAgICAgICAgICAvKiBVc2UgeGVuX2hlYXBfbWVnYXBhZ2VzIHRvIGJvb3RzdHJhcCB0aGUg
bWFwcGluZ3MgKi8KKyAgICAgICAgICAgIGZpcnN0ID0geGVuX2hlYXBfbWVnYXBhZ2VzOworICAg
ICAgICAgICAgcHRlID0gcHRlX29mX3hlbmFkZHIoKHZhZGRyX3QpeGVuX2hlYXBfbWVnYXBhZ2Vz
KTsKKyAgICAgICAgICAgIHB0ZS5wdGUgfD0gUFRFX1RBQkxFOworICAgICAgICAgICAgd3JpdGVf
cHRlKHAsIHB0ZSk7CisgICAgICAgICAgICB4ZW5fc2Vjb25kX2hlYXBfc2xvdCA9IHNsb3Q7Cisg
ICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICB7CisgICAgICAgICAgICBtZm5fdCBmaXJz
dF9tZm4gPSBhbGxvY19ib290X3BhZ2VzKDEsIDEpOworICAgICAgICAgICAgY2xlYXJfcGFnZSht
Zm5fdG9fdmlydChmaXJzdF9tZm4pKTsKKyAgICAgICAgICAgIHB0ZSA9IG1mbl90b194ZW5fZW50
cnkoZmlyc3RfbWZuKTsKKyAgICAgICAgICAgIHB0ZS5wdGUgfD0gUFRFX1RBQkxFOworICAgICAg
ICAgICAgd3JpdGVfcHRlKHAsIHB0ZSk7CisgICAgICAgICAgICBmaXJzdCA9IG1mbl90b192aXJ0
KGZpcnN0X21mbik7CisgICAgICAgIH0KKworICAgICAgICBwdGUgPSBtZm5fdG9feGVuX2VudHJ5
KF9tZm4obWZuKSk7CisgICAgICAgIHB0ZS5wdGUgfD0gUFRFX0xFQUZfREVGQVVMVDsKKyAgICAg
ICAgd3JpdGVfcHRlKCZmaXJzdFtwYWdldGFibGVfZmlyc3RfaW5kZXgodmFkZHIpXSwgcHRlKTsK
KworICAgICAgICAvKgorICAgICAgICAgKiBXZSBhcmUgbWFwcGluZyBwYWdlcyBhdCB0aGUgMk1C
IGZpcnN0LWxldmVsIGdyYW51bGFyaXR5LCBzbyBpbmNyZW1lbnQKKyAgICAgICAgICogYnkgRklS
U1RfU0laRS4KKyAgICAgICAgICovCisgICAgICAgIG1mbiArPSBGSVJTVF9TSVpFID4+IFBBR0Vf
U0hJRlQ7CisgICAgICAgIHZhZGRyICs9IEZJUlNUX1NJWkU7CisgICAgfQorCisgICAgYXNtIHZv
bGF0aWxlKCJzZmVuY2Uudm1hIik7Cit9CisKK3ZvaWQgX19pbml0IGNsZWFyX3BhZ2V0YWJsZXMo
dW5zaWduZWQgbG9uZyBsb2FkX2FkZHIsIHVuc2lnbmVkIGxvbmcgbGlua2VyX2FkZHIpCit7Cisg
ICAgdW5zaWduZWQgbG9uZyAqcDsKKyAgICB1bnNpZ25lZCBsb25nIHBhZ2U7CisgICAgdW5zaWdu
ZWQgbG9uZyBpOworCisgICAgcGFnZSA9ICh1bnNpZ25lZCBsb25nKSZ4ZW5fc2Vjb25kX3BhZ2V0
YWJsZVswXTsKKyAgICBwID0gKHVuc2lnbmVkIGxvbmcgKikocGFnZSArIGxvYWRfYWRkciAtIGxp
bmtlcl9hZGRyKTsKKyAgICBmb3IgKCBpID0gMDsgaSA8IEFSUkFZX1NJWkUoeGVuX3NlY29uZF9w
YWdldGFibGUpOyBpKysgKQorICAgIHsKKyAgICAgICAgcFtpXSA9IDBVTEw7CisgICAgfQorCisg
ICAgcGFnZSA9ICh1bnNpZ25lZCBsb25nKSZ4ZW5fZmlyc3RfcGFnZXRhYmxlWzBdOworICAgIHAg
PSAodW5zaWduZWQgbG9uZyAqKShwYWdlICsgbG9hZF9hZGRyIC0gbGlua2VyX2FkZHIpOworICAg
IGZvciAoIGkgPSAwOyBpIDwgQVJSQVlfU0laRSh4ZW5fZmlyc3RfcGFnZXRhYmxlKTsgaSsrICkK
KyAgICB7CisgICAgICAgIHBbaV0gPSAwVUxMOworICAgIH0KKworICAgIHBhZ2UgPSAodW5zaWdu
ZWQgbG9uZykmeGVuX3plcm9ldGhfcGFnZXRhYmxlWzBdOworICAgIHAgPSAodW5zaWduZWQgbG9u
ZyAqKShwYWdlICsgbG9hZF9hZGRyIC0gbGlua2VyX2FkZHIpOworICAgIGZvciAoIGkgPSAwOyBp
IDwgQVJSQVlfU0laRSh4ZW5femVyb2V0aF9wYWdldGFibGUpOyBpKysgKQorICAgIHsKKyAgICAg
ICAgcFtpXSA9IDBVTEw7CisgICAgfQorfQorCit2b2lkIF9fYXR0cmlidXRlX18oKHNlY3Rpb24o
Ii5lbnRyeSIpKSkKK3NldHVwX2luaXRpYWxfcGFnZXRhYmxlcyhwdGVfdCAqc2Vjb25kLCBwdGVf
dCAqZmlyc3QsIHB0ZV90ICp6ZXJvZXRoLAorICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGxvbmcgbWFwX3N0YXJ0LCB1bnNpZ25lZCBsb25nIG1hcF9lbmQsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBwYV9zdGFydCkKK3sKKyAgICB1bnNpZ25lZCBsb25n
IHBhZ2VfYWRkcjsKKyAgICB1bnNpZ25lZCBsb25nIGluZGV4MjsKKyAgICB1bnNpZ25lZCBsb25n
IGluZGV4MTsKKyAgICB1bnNpZ25lZCBsb25nIGluZGV4MDsKKworICAgIC8qIGFsaWduIHN0YXJ0
IGFkZHJlc3NlcyAqLworICAgIG1hcF9zdGFydCAmPSBaRVJPRVRIX01BUF9NQVNLOworICAgIHBh
X3N0YXJ0ICY9IFpFUk9FVEhfTUFQX01BU0s7CisKKyAgICBwYWdlX2FkZHIgPSBtYXBfc3RhcnQ7
CisgICAgd2hpbGUgKCBwYWdlX2FkZHIgPCBtYXBfZW5kICkKKyAgICB7CisgICAgICAgIGluZGV4
MiA9IHBhZ2V0YWJsZV9zZWNvbmRfaW5kZXgocGFnZV9hZGRyKTsKKyAgICAgICAgaW5kZXgxID0g
cGFnZXRhYmxlX2ZpcnN0X2luZGV4KHBhZ2VfYWRkcik7CisgICAgICAgIGluZGV4MCA9IHBhZ2V0
YWJsZV96ZXJvZXRoX2luZGV4KHBhZ2VfYWRkcik7CisKKyAgICAgICAgLyogU2V0dXAgbGV2ZWwy
IHRhYmxlICovCisgICAgICAgIHNlY29uZFtpbmRleDJdID0gcGFkZHJfdG9fcHRlKCh1bnNpZ25l
ZCBsb25nKWZpcnN0KTsKKyAgICAgICAgc2Vjb25kW2luZGV4Ml0ucHRlIHw9IFBURV9UQUJMRTsK
KworICAgICAgICAvKiBTZXR1cCBsZXZlbDEgdGFibGUgKi8KKyAgICAgICAgZmlyc3RbaW5kZXgx
XSA9IHBhZGRyX3RvX3B0ZSgodW5zaWduZWQgbG9uZyl6ZXJvZXRoKTsKKyAgICAgICAgZmlyc3Rb
aW5kZXgxXS5wdGUgfD0gUFRFX1RBQkxFOworCisgICAgICAgIC8qIFNldHVwIGxldmVsMCB0YWJs
ZSAqLworICAgICAgICBpZiAoICFwdGVfaXNfdmFsaWQoJnplcm9ldGhbaW5kZXgwXSkgKQorICAg
ICAgICB7CisgICAgICAgICAgICAvKiBVcGRhdGUgbGV2ZWwwIHRhYmxlICovCisgICAgICAgICAg
ICB6ZXJvZXRoW2luZGV4MF0gPSBwYWRkcl90b19wdGUoKHBhZ2VfYWRkciAtIG1hcF9zdGFydCkg
KyBwYV9zdGFydCk7CisgICAgICAgICAgICB6ZXJvZXRoW2luZGV4MF0ucHRlIHw9IFBURV9MRUFG
X0RFRkFVTFQ7CisgICAgICAgIH0KKworICAgICAgICAvKiBQb2ludCB0byBuZXh0IHBhZ2UgKi8K
KyAgICAgICAgcGFnZV9hZGRyICs9IFpFUk9FVEhfU0laRTsKKyAgICB9Cit9CisKKy8qCisgKiBX
QVJOSU5HOiBsb2FkX2FkZHIoKSBhbmQgbGlua2VyX2FkZHIoKSBhcmUgdG8gYmUgY2FsbGVkIG9u
bHkgd2hlbiB0aGUgTU1VIGlzCisgKiBkaXNhYmxlZCBhbmQgb25seSB3aGVuIGV4ZWN1dGVkIGJ5
IHRoZSBwcmltYXJ5IENQVS4gIFRoZXkgY2Fubm90IHJlZmVyIHRvCisgKiBhbnkgZ2xvYmFsIHZh
cmlhYmxlIG9yIGZ1bmN0aW9ucy4KKyAqLworCisvKgorICogQ29udmVydCBhbiBhZGRyZXNzZWQg
bGF5ZWQgb3V0IGF0IGxpbmsgdGltZSB0byB0aGUgYWRkcmVzcyB3aGVyZSBpdCB3YXMgbG9hZGVk
CisgKiBieSB0aGUgYm9vdGxvYWRlci4KKyAqLworI2RlZmluZSBsb2FkX2FkZHIobGlua2VyX2Fk
ZHJlc3MpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAg
ICAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIHVuc2lnbmVkIGxvbmcgX19saW5rZXJfYWRk
cmVzcyA9ICh1bnNpZ25lZCBsb25nKShsaW5rZXJfYWRkcmVzcyk7ICAgICAgXAorICAgICAgICBp
ZiAoIGxpbmtlcl9hZGRyX3N0YXJ0IDw9IF9fbGlua2VyX2FkZHJlc3MgJiYgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICBfX2xpbmtlcl9hZGRyZXNzIDwgbGlua2VyX2Fk
ZHJfZW5kICkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgeyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICBfX2xpbmtlcl9hZGRyZXNzID0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgIF9fbGlu
a2VyX2FkZHJlc3MgLSBsaW5rZXJfYWRkcl9zdGFydCArIGxvYWRfYWRkcl9zdGFydDsgICAgICAg
IFwKKyAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIF9fbGlua2VyX2FkZHJlc3M7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAg
IH0pCisKKy8qIENvbnZlcnQgYm9vdC10aW1lIFhlbiBhZGRyZXNzIGZyb20gd2hlcmUgaXQgd2Fz
IGxvYWRlZCBieSB0aGUgYm9vdCBsb2FkZXIgdG8gdGhlIGFkZHJlc3MgaXQgd2FzIGxheWVkIG91
dAorICogYXQgbGluay10aW1lLgorICovCisjZGVmaW5lIGxpbmtlcl9hZGRyKGxvYWRfYWRkcmVz
cykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICh7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKKyAgICAgICAgdW5zaWduZWQgbG9uZyBfX2xvYWRfYWRkcmVzcyA9
ICh1bnNpZ25lZCBsb25nKShsb2FkX2FkZHJlc3MpOyAgICAgICAgICBcCisgICAgICAgIGlmICgg
bG9hZF9hZGRyX3N0YXJ0IDw9IF9fbG9hZF9hZGRyZXNzICYmICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKKyAgICAgICAgICAgIF9fbG9hZF9hZGRyZXNzIDwgbG9hZF9hZGRyX2VuZCAp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICB7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKKyAgICAgICAgICAgIF9fbG9hZF9hZGRyZXNzID0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgX19sb2FkX2Fk
ZHJlc3MgLSBsb2FkX2FkZHJfc3RhcnQgKyBsaW5rZXJfYWRkcl9zdGFydDsgICAgICAgICAgXAor
ICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgX19sb2FkX2FkZHJlc3M7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgfSkK
KworLyoKKyAqIF9zZXR1cF9pbml0aWFsX3BhZ2V0YWJsZXM6CisgKgorICogMSkgQnVpbGQgdGhl
IHBhZ2UgdGFibGVzIGZvciBYZW4gdGhhdCBtYXAgdGhlIGZvbGxvd2luZzoKKyAqICAgMS4xKSAg
VGhlIHBoeXNpY2FsIGxvY2F0aW9uIG9mIFhlbiAod2hlcmUgdGhlIGJvb3Rsb2FkZXIgbG9hZGVk
IGl0KQorICogICAxLjIpICBUaGUgbGluay10aW1lIGxvY2F0aW9uIG9mIFhlbiAod2hlcmUgdGhl
IGxpbmtlciBleHBlY3RlZCBYZW4ncworICogICAgICAgICBhZGRyZXNzZXMgdG8gYmUpCisgKiAy
KSBMb2FkIHRoZSBwYWdlIHRhYmxlIGludG8gdGhlIFNBVFAgYW5kIGVuYWJsZSB0aGUgTU1VCisg
Ki8KK3ZvaWQgX19hdHRyaWJ1dGVfXygoc2VjdGlvbigiLmVudHJ5IikpKQorX3NldHVwX2luaXRp
YWxfcGFnZXRhYmxlcyh1bnNpZ25lZCBsb25nIGxvYWRfYWRkcl9zdGFydCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBsb2FkX2FkZHJfZW5kLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGxpbmtlcl9hZGRyX3N0YXJ0LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGxpbmtlcl9hZGRyX2VuZCkKK3sKKyAgICBw
dGVfdCAqc2Vjb25kOworICAgIHB0ZV90ICpmaXJzdDsKKyAgICBwdGVfdCAqemVyb2V0aDsKKwor
ICAgIGNsZWFyX3BhZ2V0YWJsZXMobG9hZF9hZGRyX3N0YXJ0LCBsaW5rZXJfYWRkcl9zdGFydCk7
CisKKyAgICAvKiBHZXQgdGhlIGFkZHJlc3NlcyB3aGVyZSB0aGUgcGFnZSB0YWJsZXMgd2VyZSBs
b2FkZWQgKi8KKyAgICBzZWNvbmQgPSAocHRlX3QgKilsb2FkX2FkZHIoJnhlbl9zZWNvbmRfcGFn
ZXRhYmxlKTsKKyAgICBmaXJzdCA9IChwdGVfdCAqKWxvYWRfYWRkcigmeGVuX2ZpcnN0X3BhZ2V0
YWJsZSk7CisgICAgemVyb2V0aCA9IChwdGVfdCAqKWxvYWRfYWRkcigmeGVuX3plcm9ldGhfcGFn
ZXRhYmxlKTsKKworICAgIC8qCisgICAgICogQ3JlYXRlIGEgbWFwcGluZyBvZiB0aGUgbG9hZCB0
aW1lIGFkZHJlc3MgcmFuZ2UgdG8uLi4gdGhlIGxvYWQgdGltZSBhZGRyZXNzIHJhbmdlLgorICAg
ICAqIFRoaXMgbWFwcGluZyBpcyB1c2VkIGF0IGJvb3QgdGltZSBvbmx5LgorICAgICAqLworICAg
IHNldHVwX2luaXRpYWxfcGFnZXRhYmxlcyhzZWNvbmQsIGZpcnN0LCB6ZXJvZXRoLCBsb2FkX2Fk
ZHJfc3RhcnQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRfYWRkcl9lbmQsIGxv
YWRfYWRkcl9zdGFydCk7CisKKyAgICAvKgorICAgICAqIENyZWF0ZSBhIG1hcHBpbmcgZnJvbSBY
ZW4ncyBsaW5rLXRpbWUgYWRkcmVzc2VzIHRvIHdoZXJlIHRoZXkgd2VyZSBhY3R1YWxseSBsb2Fk
ZWQuCisgICAgICoKKyAgICAgKiBUT0RPOiBQcm90ZWN0IHJlZ2lvbnMgYWNjb3JkaW5nbHkgKGUu
Zy4sIHByb3RlY3QgdGV4dCBhbmQgcm9kYXRhIGZyb20gd3JpdGVzKS4KKyAgICAgKi8KKyAgICBz
ZXR1cF9pbml0aWFsX3BhZ2V0YWJsZXMoc2Vjb25kLCBmaXJzdCwgemVyb2V0aCwgbGlua2VyX2Fk
ZHIoJl90ZXh0X3N0YXJ0KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyX2Fk
ZHIoJl90ZXh0X2VuZCksIGxvYWRfYWRkcigmX3RleHRfc3RhcnQpKTsKKyAgICBzZXR1cF9pbml0
aWFsX3BhZ2V0YWJsZXMoc2Vjb25kLCBmaXJzdCwgemVyb2V0aCwgbGlua2VyX2FkZHIoJl9pbml0
X3N0YXJ0KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua2VyX2FkZHIoJl9pbml0
X2VuZCksIGxvYWRfYWRkcigmX2luaXRfc3RhcnQpKTsKKyAgICBzZXR1cF9pbml0aWFsX3BhZ2V0
YWJsZXMoc2Vjb25kLCBmaXJzdCwgemVyb2V0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbGlua2VyX2FkZHIoJl9jcHVpbml0X3N0YXJ0KSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlua2VyX2FkZHIoJl9jcHVpbml0X2VuZCksCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGxvYWRfYWRkcigmX2NwdWluaXRfc3RhcnQpKTsKKyAgICBzZXR1cF9pbml0aWFsX3Bh
Z2V0YWJsZXMoc2Vjb25kLCBmaXJzdCwgemVyb2V0aCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlua2VyX2FkZHIoJl9zcGlubG9ja19zdGFydCksCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGxpbmtlcl9hZGRyKCZfc3BpbmxvY2tfZW5kKSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbG9hZF9hZGRyKCZfc3BpbmxvY2tfc3RhcnQpKTsKKyAgICBzZXR1cF9pbml0
aWFsX3BhZ2V0YWJsZXMoc2Vjb25kLCBmaXJzdCwgemVyb2V0aCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGlua2VyX2FkZHIoJl9yb2RhdGFfc3RhcnQpLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBsaW5rZXJfYWRkcigmX3JvZGF0YV9lbmQpLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBsb2FkX2FkZHIoJl9yb2RhdGFfc3RhcnQpKTsKKyAgICBzZXR1cF9pbml0
aWFsX3BhZ2V0YWJsZXMoc2Vjb25kLCBmaXJzdCwgemVyb2V0aCwgbGlua2VyX2FkZHJfc3RhcnQs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtlcl9hZGRyX2VuZCwgbG9hZF9hZGRy
X3N0YXJ0KTsKKworICAgIC8qIEVuc3VyZSBwYWdlIHRhYmxlIHdyaXRlcyBwcmVjZWRlIGxvYWRp
bmcgdGhlIFNBVFAgKi8KKyAgICBhc20gdm9sYXRpbGUoInNmZW5jZS52bWEiKTsKKworICAgIC8q
IEVuYWJsZSB0aGUgTU1VIGFuZCBsb2FkIHRoZSBuZXcgcGFnZXRhYmxlIGZvciBYZW4gKi8KKyAg
ICBjc3Jfd3JpdGUoc2F0cCwgCisgICAgICAgICAgICAgIChsb2FkX2FkZHIoeGVuX3NlY29uZF9w
YWdldGFibGUpID4+IFBBR0VfU0hJRlQpIHwgU0FUUF9NT0RFKTsKKworICAgIHBoeXNfb2Zmc2V0
ID0gbG9hZF9hZGRyX3N0YXJ0ID4gbGlua2VyX2FkZHJfc3RhcnQgPworICAgICAgICAgICAgICAg
ICAgICAgIGxvYWRfYWRkcl9zdGFydCAtIGxpbmtlcl9hZGRyX3N0YXJ0IDoKKyAgICAgICAgICAg
ICAgICAgICAgICBsaW5rZXJfYWRkcl9zdGFydCAtIGxvYWRfYWRkcl9zdGFydDsKK30KKworLyog
TWFwIGEgZnJhbWUgdGFibGUgdG8gY292ZXIgcGh5c2ljYWwgYWRkcmVzc2VzIHBzIHRocm91Z2gg
cGUgKi8KK3ZvaWQgX19pbml0IHNldHVwX2ZyYW1ldGFibGVfbWFwcGluZ3MocGFkZHJfdCBwcywg
cGFkZHJfdCBwZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIG5yX3BkeHMgPSBtZm5fdG9fcGR4KG1m
bl9hZGQobWFkZHJfdG9fbWZuKHBlKSwgLTEpKSAtCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWZuX3RvX3BkeChtYWRkcl90b19tZm4ocHMpKSArIDE7CisgICAgdW5zaWduZWQgbG9uZyBm
cmFtZXRhYmxlX3NpemUgPSBucl9wZHhzICogc2l6ZW9mKHN0cnVjdCBwYWdlX2luZm8pOworICAg
IHVuc2lnbmVkIGxvbmcgdmlydF9lbmQ7CisgICAgcHRlX3QgKmZpcnN0X3RhYmxlOworICAgIG1m
bl90IG1mbiwgYmFzZSwgZmlyc3Q7CisgICAgcHRlX3QgcHRlOworICAgIHVuc2lnbmVkIGxvbmcg
aSwgZmlyc3RfZW50cmllc19yZW1haW5pbmc7CisKKyAgICBmcmFtZXRhYmxlX2Jhc2VfcGR4ID0g
bWZuX3RvX3BkeChtYWRkcl90b19tZm4ocHMpKTsKKworICAgIC8qIEFsbG9jYXRlIGVub3VnaCBw
YWdlcyB0byBob2xkIHRoZSB3aG9sZSBhZGRyZXNzIHNwYWNlICovCisgICAgYmFzZSA9IGFsbG9j
X2Jvb3RfcGFnZXMoZnJhbWV0YWJsZV9zaXplID4+IFBBR0VfU0hJRlQsIE1CKDIpID4+IFBBR0Vf
U0hJRlQpOworICAgIHZpcnRfZW5kID0gRlJBTUVUQUJMRV9WSVJUX1NUQVJUICsgZnJhbWV0YWJs
ZV9zaXplOworCisgICAgZmlyc3RfZW50cmllc19yZW1haW5pbmcgPSAwOworICAgIG1mbiA9IGJh
c2U7CisKKyAgICAvKiBNYXAgdGhlIGZyYW1ldGFibGUgdmlydHVhbCBhZGRyZXNzIHNwZWFjZSB0
byB0aHNlIHBhZ2VzICovCisgICAgZm9yICggaSA9IFJPVU5EVVAoRlJBTUVUQUJMRV9WSVJUX1NU
QVJULCBNQigyKSk7IGkgPCB2aXJ0X2VuZDsgaSArPSBNQigyKSApCisgICAgeworICAgICAgICAv
KiBJZiB0aGlzIGZyYW1lIGhhcyBmaWxsZWQgdXAgYWxsIGVudHJpZXMsIHRoZW4gYWxsb2NhdGUg
YSBuZXcgdGFibGUgKi8KKyAgICAgICAgaWYgKCBmaXJzdF9lbnRyaWVzX3JlbWFpbmluZyA8PSAw
ICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogQWxsb2NhdGUgcGFnZSBmb3IgYSBmaXJzdC1s
ZXZlbCB0YWJsZSAqLworICAgICAgICAgICAgZmlyc3QgPSBhbGxvY19ib290X3BhZ2VzKDEsIDEp
OworCisgICAgICAgICAgICAvKiBSZXNldCBjb3VudGVyICovCisgICAgICAgICAgICBmaXJzdF9l
bnRyaWVzX3JlbWFpbmluZyA9IDUxMjsKKyAgICAgICAgfQorCisgICAgICAgIC8qIENvbnZlcnQg
dGhlIGZpcnN0LWxldmVsIHRhYmxlIGZyb20gaXQncyBtYWNoaW5lIGZyYW1lIG51bWJlciB0byBh
IHZpcnR1YWxfYWRkcmVzcyAqLworICAgICAgICBmaXJzdF90YWJsZSA9IChwdGVfdCAqKW1mbl90
b192aXJ0KGZpcnN0KTsKKworICAgICAgICBwdGUgPSBtZm5fdG9feGVuX2VudHJ5KG1mbik7Cisg
ICAgICAgIHB0ZS5wdGUgfD0gUFRFX0xFQUZfREVGQVVMVDsKKworICAgICAgICAvKiBQb2ludCB0
aGUgZmlyc3QtbGV2ZWwgdGFibGUgdG8gdGhlIG1hY2hpbmUgZnJhbWUgKi8KKyAgICAgICAgd3Jp
dGVfcHRlKCZmaXJzdF90YWJsZVtwYWdldGFibGVfZmlyc3RfaW5kZXgoaSldLCBwdGUpOworCisg
ICAgICAgIC8qIENvbnZlcnQgdGhlIGZpcnN0LWxldmVsIHRhYmxlIGFkZHJlc3MgaW50byBhIFBU
RSAqLworICAgICAgICBwdGUgPSBtZm5fdG9feGVuX2VudHJ5KG1hZGRyX3RvX21mbih2aXJ0X3Rv
X21hZGRyKCZmaXJzdF90YWJsZVswXSkpKTsKKyAgICAgICAgcHRlLnB0ZSB8PSBQVEVfVEFCTEU7
CisKKyAgICAgICAgLyogUG9pbnQgdGhlIHNlY29uZC1sZXZlbCB0YWJsZSB0byB0aGUgZmlyc3Qt
bGV2ZWwgdGFibGUgKi8KKyAgICAgICAgd3JpdGVfcHRlKCZ4ZW5fc2Vjb25kX3BhZ2V0YWJsZVtw
YWdldGFibGVfc2Vjb25kX2luZGV4KGkpXSwgcHRlKTsKKworICAgICAgICAvKiBGaXJzdC1sZXZl
bCB0YWJsZXMgYXJlIGF0IGEgMk1CIGdyYW51bGFyaXR5IHNvIGdvIHRvIHRoZSBuZXh0IDJNQiBw
YWdlICovCisgICAgICAgIG1mbiA9IG1mbl9hZGQobWZuLCBNQigyKSA+PiBQQUdFX1NISUZUKTsK
KworICAgICAgICAvKiBXZSd2ZSB1c2VkIGFuIGVudHJ5LCBzbyBkZWNyZW1lbnQgdGhlIGNvdW50
ZXIgKi8KKyAgICAgICAgZmlyc3RfZW50cmllc19yZW1haW5pbmctLTsKKyAgICB9CisKKyAgICBt
ZW1zZXQoJmZyYW1lX3RhYmxlWzBdLCAwLCBucl9wZHhzICogc2l6ZW9mKHN0cnVjdCBwYWdlX2lu
Zm8pKTsKKyAgICBtZW1zZXQoJmZyYW1lX3RhYmxlW25yX3BkeHNdLCAtMSwKKyAgICAgICAgICAg
ZnJhbWV0YWJsZV9zaXplIC0gKG5yX3BkeHMgKiBzaXplb2Yoc3RydWN0IHBhZ2VfaW5mbykpKTsK
KworICAgIGZyYW1ldGFibGVfdmlydF9lbmQgPQorICAgICAgICBGUkFNRVRBQkxFX1ZJUlRfU1RB
UlQgKyAobnJfcGR4cyAqIHNpemVvZihzdHJ1Y3QgcGFnZV9pbmZvKSk7Cit9CisKKy8qCisgKiBM
b2NhbCB2YXJpYWJsZXM6CisgKiBtb2RlOiBDCisgKiBjLWZpbGUtc3R5bGU6ICJCU0QiCisgKiBj
LWJhc2ljLW9mZnNldDogNAorICogaW5kZW50LXRhYnMtbW9kZTogbmlsCisgKiBFbmQ6CisgKi8K
ZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3Jpc2N2L3NldHVwLmMgYi94ZW4vYXJjaC9yaXNjdi9zZXR1
cC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAuLmVhZjNlN2M3MzYKLS0t
IC9kZXYvbnVsbAorKysgYi94ZW4vYXJjaC9yaXNjdi9zZXR1cC5jCkBAIC0wLDAgKzEsMTIyIEBA
CisvKgorICogeGVuL2FyY2gvcmlzY3Yvc2V0dXAuYworICoKKyAqCisgKiBFYXJseSBicmluZ3Vw
IGNvZGUgZm9yIGEgUklTQy1WIFJWMzIvNjQgd2l0aCBoeXBlcnZpc29yCisgKiBleHRlbnNpb25z
IChjb2RlIEgpLgorICoKKyAqIEJhc2VkIG9mZiB0aGUgQVJNIHNldHVwIGNvZGUgd2l0aCBjb3B5
cmlnaHQgVGltIERlZWdhbiA8dGltQHhlbi5vcmc+CisgKgorICogQ29weXJpZ2h0IChjKSAyMDE5
IEJvYmJ5IEVzaGxlbWFuIDxib2JieWVzaGxlbWFuQGdtYWlsLmNvbT4KKyAqCisgKiBUaGlzIHBy
b2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1v
ZGlmeQorICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGlj
ZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVp
dGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFu
eSBsYXRlciB2ZXJzaW9uLgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0
aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJB
TlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJ
TElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKi8KKworI2luY2x1
ZGUgPHhlbi9jb21waWxlLmg+CisjaW5jbHVkZSA8eGVuL2RvbWFpbl9wYWdlLmg+CisjaW5jbHVk
ZSA8eGVuL2dyYW50X3RhYmxlLmg+CisjaW5jbHVkZSA8eGVuL3R5cGVzLmg+CisjaW5jbHVkZSA8
eGVuL3N0cmluZy5oPgorI2luY2x1ZGUgPHhlbi9zZXJpYWwuaD4KKyNpbmNsdWRlIDx4ZW4vc2No
ZWQuaD4KKyNpbmNsdWRlIDx4ZW4vY29uc29sZS5oPgorI2luY2x1ZGUgPHhlbi9lcnIuaD4KKyNp
bmNsdWRlIDx4ZW4vaW5pdC5oPgorI2luY2x1ZGUgPHhlbi9pcnEuaD4KKyNpbmNsdWRlIDx4ZW4v
bW0uaD4KKyNpbmNsdWRlIDx4ZW4vc29mdGlycS5oPgorI2luY2x1ZGUgPHhlbi9rZXloYW5kbGVy
Lmg+CisjaW5jbHVkZSA8eGVuL2NwdS5oPgorI2luY2x1ZGUgPHhlbi9wZm4uaD4KKyNpbmNsdWRl
IDx4ZW4vdmlydHVhbF9yZWdpb24uaD4KKyNpbmNsdWRlIDx4ZW4vdm1hcC5oPgorI2luY2x1ZGUg
PHhlbi90cmFjZS5oPgorI2luY2x1ZGUgPGFzbS9wYWdlLmg+CisjaW5jbHVkZSA8YXNtL2N1cnJl
bnQuaD4KKyNpbmNsdWRlIDxhc20vc2V0dXAuaD4KKyNpbmNsdWRlIDxhc20vc2V0dXAuaD4KKyNp
bmNsdWRlIDx4c20veHNtLmg+CisKKy8qIFRoZSBsdWNreSBoYXJ0IHRvIGZpcnN0IGluY3JlbWVu
dCB0aGlzIHZhcmlhYmxlIHdpbGwgYm9vdCB0aGUgb3RoZXIgY29yZXMgKi8KK2F0b21pY190IGhh
cnRfbG90dGVyeTsKK3Vuc2lnbmVkIGxvbmcgYm9vdF9jcHVfaGFydGlkOwordW5zaWduZWQgbG9u
ZyB0b3RhbF9wYWdlczsKKwordm9pZCBhcmNoX2dldF94ZW5fY2Fwcyh4ZW5fY2FwYWJpbGl0aWVz
X2luZm9fdCAqaW5mbykKK3sKKyAgICAvKiBJbnRlcmZhY2UgbmFtZSBpcyBhbHdheXMgeGVuLTMu
MC0qIGZvciBYZW4tMy54LiAqLworICAgIGludCBtYWpvciA9IDMsIG1pbm9yID0gMDsKKyAgICBj
aGFyIHNbMzJdOworCisgICAgKCppbmZvKVswXSA9ICdcMCc7CisKKyAgICBzbnByaW50ZihzLCBz
aXplb2YocyksICJ4ZW4tJWQuJWQtcmlzY3YgIiwgbWFqb3IsIG1pbm9yKTsKKyAgICBzYWZlX3N0
cmNhdCgqaW5mbywgcyk7Cit9CisKKy8qCisgKiBUT0RPOiBEbyBub3QgaGFyZGNvZGUgdGhpcy4g
IFRoZXJlIGhhcyBiZWVuIGRpc2N1c3Npb24gb24gaG93IE9wZW5TQkkgd2lsbAorICogY29tbXVu
aWNhdGUgaXQncyBwcm90ZWN0ZWQgc3BhY2UgdG8gaXRzIHBheWxvYWQuICBYZW4gd2lsbCBuZWVk
IHRvIGNvbmZvcm0KKyAqIHRvIHRoYXQgYXBwcm9hY2guCisgKgorICogMHg4MDAwMDAwMCAtIDB4
ODAyMDAwMDAgaXMgUE1QIHByb3RlY3RlZCBieSBPcGVuU0JJIHNvIGV4Y2x1ZGUgaXQgZnJvbSB0
aGUKKyAqIHJhbSByYW5nZSAoYW55IGF0dGVtcHQgYXQgdXNpbmcgaXQgd2lsbCB0cmlnZ2VyIGEg
UE1QIGZhdWx0KS4KKyAqLworI2RlZmluZSBPUEVOU0JJX09GRlNFVCAweDAyMDAwMDAKKworc3Rh
dGljIHZvaWQgX19pbml0IHNldHVwX21tKHZvaWQpCit7CisgICAgcGFkZHJfdCByYW1fc3RhcnQs
IHJhbV9lbmQsIHJhbV9zaXplOworCisgICAgLyogVE9ETzogVXNlIEZEVCBpbnN0ZWFkIG9mIGhh
cmRjb2RpbmcgdGhlc2UgdmFsdWVzICovCisgICAgcmFtX3N0YXJ0ID0gMHg4MDAwMDAwMCArIE9Q
RU5TQklfT0ZGU0VUOworICAgIHJhbV9zaXplICA9IDB4MDgwMDAwMDAgLSBPUEVOU0JJX09GRlNF
VDsKKyAgICByYW1fZW5kICAgPSByYW1fc3RhcnQgKyByYW1fc2l6ZTsKKyAgICB0b3RhbF9wYWdl
cyA9IHJhbV9zaXplID4+IFBBR0VfU0hJRlQ7CisgICAgcGZuX3BkeF9ob2xlX3NldHVwKDApOwor
ICAgIHNldHVwX3hlbmhlYXBfbWFwcGluZ3MocmFtX3N0YXJ0Pj5QQUdFX1NISUZULCB0b3RhbF9w
YWdlcyk7CisgICAgeGVuaGVhcF92aXJ0X2VuZCA9IFhFTkhFQVBfVklSVF9TVEFSVCArIHJhbV9z
aXplOworICAgIHhlbmhlYXBfbWZuX2VuZCA9IG1hZGRyX3RvX21mbihyYW1fZW5kKTsKKyAgICBp
bml0X2Jvb3RfcGFnZXMobWZuX3RvX21hZGRyKHhlbmhlYXBfbWZuX3N0YXJ0KSwKKyAgICAgICAg
ICAgICAgICAgICAgbWZuX3RvX21hZGRyKHhlbmhlYXBfbWZuX2VuZCkpOworICAgIG1heF9wYWdl
ID0gUEZOX0RPV04ocmFtX2VuZCk7CisgICAgc2V0dXBfZnJhbWV0YWJsZV9tYXBwaW5ncygwLCBy
YW1fZW5kKTsKK30KKwordm9pZCBfX2luaXQgc3RhcnRfeGVuKHZvaWQpCit7CisgICAgc3RydWN0
IG5zMTY1NTBfZGVmYXVsdHMgbnMxNjU1MCA9IHsKKyAgICAgICAgLmRhdGFfYml0cyA9IDgsCisg
ICAgICAgIC5wYXJpdHkgICAgPSAnbicsCisgICAgICAgIC5zdG9wX2JpdHMgPSAxCisgICAgfTsK
KworICAgIHNldHVwX3ZpcnR1YWxfcmVnaW9ucyhOVUxMLCBOVUxMKTsKKyAgICBzZXR1cF9tbSgp
OworICAgIGVuZF9ib290X2FsbG9jYXRvcigpOworICAgIHZtX2luaXQoKTsKKworICAgIG5zMTY1
NTAuaW9fYmFzZSA9IDB4MTAwMDAwMDA7CisgICAgbnMxNjU1MC5pcnEgICAgID0gMTA7CisgICAg
bnMxNjU1MC5iYXVkICAgID0gMTE1MjAwOworICAgIG5zMTY1NTBfaW5pdCgwLCAmbnMxNjU1MCk7
CisgICAgY29uc29sZV9pbml0X3ByZWlycSgpOworCisgICAgcHJpbnRrKCJSSVNDLVYgWGVuIEJv
b3QhXG4iKTsKK30KKy8qCisgKiBMb2NhbCB2YXJpYWJsZXM6CisgKiBtb2RlOiBDCisgKiBjLWZp
bGUtc3R5bGU6ICJCU0QiCisgKiBjLWJhc2ljLW9mZnNldDogNAorICogaW5kZW50LXRhYnMtbW9k
ZTogbmlsCisgKiBFbmQ6CisgKi8KLS0gCjIuMjUuMAoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=

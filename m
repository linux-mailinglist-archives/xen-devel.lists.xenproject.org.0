Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8964C55294
	for <lists+xen-devel@lfdr.de>; Tue, 25 Jun 2019 16:53:51 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hfmn5-0003zl-Ew; Tue, 25 Jun 2019 14:51:23 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Ot0M=UY=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1hfmn4-0003zg-AQ
 for xen-devel@lists.xenproject.org; Tue, 25 Jun 2019 14:51:22 +0000
X-Inumbo-ID: b14ce3e8-9758-11e9-821c-1be19607e8e7
Received: from esa2.hc3370-68.iphmx.com (unknown [216.71.145.153])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id b14ce3e8-9758-11e9-821c-1be19607e8e7;
 Tue, 25 Jun 2019 14:51:20 +0000 (UTC)
Authentication-Results: esa2.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa2.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa2.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa2.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: jgN+Hex6taP29OxHbDLNssJYrrQ51Q2OJh55uhf1KEQd7/B1mWhfMff7cacokYiiZPlCmqgCt0
 YV8Qrlyp7e4FEFKMqf7k4bGQVrSZ9+GNvRrKPo6x/raMG8wzDnqYhCHlqfYr10c4Th5y01Ueq1
 LK+JPvwsLMNFzW5x3q9DjDfCBGRlLpi8sTgLV24gxjZaMRI9TWX3iG7B9B5v9LxKSka7aePWiZ
 q14sYyCKtkHyCCd/J37Js4riNsSvvD+/do7KefAh1vlgWYcrisEDheGMXY753fDihFspvLT6WI
 aD8=
X-SBRS: 2.7
X-MesageID: 2190886
X-Ironport-Server: esa2.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,416,1557201600"; 
   d="scan'208";a="2190886"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Tue, 25 Jun 2019 15:43:49 +0100
Message-ID: <20190625144350.6176-3-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190625144350.6176-1-andrew.cooper3@citrix.com>
References: <20190625144350.6176-1-andrew.cooper3@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 2/3] nodemask: Remove implicit addressof from
 the API
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Julien Grall <julien.grall@arm.com>,
 Jan Beulich <JBeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIG5vZGVtYXNrIEFQSSBkaWZmZXJzIGZyb20gdGhlIGNwdW1hc2sgQVBJIGJlY2F1c2UgZWFj
aCB3cmFwcGVyIHRvIGJpdG1hcApvcGVyYXRpb25zIGlzIGZ1cnRoZXIgd3JhcHBlZCBieSBhIG1h
Y3JvIHdoaWNoIHRha2VzIHRoZSBhZGRyZXNzIG9mIHRoZQpub2RlbWFzayBvYmplY3RzLgoKVGhp
cyByZXN1bHRzIGluIGNvZGUgd2hpY2ggaXMgc2xpZ2h0bHkgY29uZnVzaW5nIHRvIHJlYWQgYXMg
aXQgZG9lc24ndCBmb2xsb3cKQydzIGNhbGxpbmcgY29udmVudGlvbnMsIGFuZCBwcm9oaWJpdHMg
dGhlIHVzZSBvZiBzbGlnaHRseSBtb3JlIGNvbXBsaWNhdGVkCmNvbnN0cnVjdHMgZm9yIHNwZWNp
ZnlpbmcgcGFyYW1ldGVycy4KCkRyb3AgYWxsIHdyYXBwaW5nIG1hY3JvcywgcmVuYW1lIHRoZSBu
b2RlbWFzayBzdGF0aWMgaW5saW5lIGZ1bmN0aW9ucyB0byBkcm9wCnRoZSBkb3VibGUgdW5kZXJz
Y29yZXMsIGFuZCBmZWVkIE1BWF9OVU1OT0RFUyBpbnRvIGFwcHJvcHJpYXRlIGxvY2F0aW9ucy4K
ClRha2UgdGhlIG9wcG9ydHVuaXR5IHRvIGRyb3AgYSBjb21waWxlciB3b3JrYXJvdW5kIGZvciBu
b2RlX2lzc2V0KCkgZm9yIEdDQwozLjMuMiB3aGljaCBpcyBsb25nIG91dCBvZiBzdXBwb3J0LCBh
bmQgaW1wbG1lbnQgaXQgd2l0aCBhIHN0YXRpYyBpbmxpbmUuCgpVcGRhdGUgYWxsIGNhbGxlcnMg
dG8gdXNlIHRoZSBjb3JyZWN0IGluZGlyZWN0aW9uIHRoZW1zZWx2ZXMuCgpObyBmdW5jdGlvbmFs
IGNoYW5nZS4KClNpZ25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNp
dHJpeC5jb20+Ci0tLQpDQzogSmFuIEJldWxpY2ggPEpCZXVsaWNoQHN1c2UuY29tPgpDQzogV2Vp
IExpdSA8d2xAeGVuLm9yZz4KQ0M6IFJvZ2VyIFBhdSBNb25uw6kgPHJvZ2VyLnBhdUBjaXRyaXgu
Y29tPgpDQzogU3RlZmFubyBTdGFiZWxsaW5pIDxzc3RhYmVsbGluaUBrZXJuZWwub3JnPgpDQzog
SnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KQ0M6IEdlb3JnZSBEdW5sYXAgPGdl
b3JnZS5kdW5sYXBAZXUuY2l0cml4LmNvbT4KCnYyOgogKiBOZXcKLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tMF9idWlsZC5jICB8ICAxMiArLS0KIHhlbi9hcmNoL3g4Ni9udW1hLmMgICAgICAgIHwgICA4
ICstCiB4ZW4vYXJjaC94ODYvc3JhdC5jICAgICAgICB8ICAxNSArKy0tCiB4ZW4vY29tbW9uL2Rv
bWFpbi5jICAgICAgICB8ICAgOCArLQogeGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMgICAgfCAgMjgg
KysrLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYyAgfCAgIDIgKy0KIHhlbi9jb21tb24v
c3lzY3RsLmMgICAgICAgIHwgICAyICstCiB4ZW4vaW5jbHVkZS94ZW4vbm9kZW1hc2suaCB8IDE4
MSArKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDggZmlsZXMg
Y2hhbmdlZCwgMTEwIGluc2VydGlvbnMoKyksIDE0NiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvZG9tMF9idWlsZC5jIGIveGVuL2FyY2gveDg2L2RvbTBfYnVpbGQuYwpp
bmRleCBjNjk1NzA5MjBjLi40YWYyZWUwMDkxIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvZG9t
MF9idWlsZC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb20wX2J1aWxkLmMKQEAgLTIzMSw3ICsyMzEs
NyBAQCB1bnNpZ25lZCBpbnQgX19pbml0IGRvbTBfbWF4X3ZjcHVzKHZvaWQpCiAKICAgICBpZiAo
IHB2X3NoaW0gKQogICAgIHsKLSAgICAgICAgbm9kZXNfc2V0YWxsKGRvbTBfbm9kZXMpOworICAg
ICAgICBub2Rlc19zZXRhbGwoJmRvbTBfbm9kZXMpOwogCiAgICAgICAgIC8qCiAgICAgICAgICAq
IFdoZW4gYm9vdGluZyBpbiBzaGltIG1vZGUgQVBzIGFyZSBub3Qgc3RhcnRlZCB1bnRpbCB0aGUg
Z3Vlc3QgYnJpbmdzCkBAIC0yNDYsMTEgKzI0NiwxMSBAQCB1bnNpZ25lZCBpbnQgX19pbml0IGRv
bTBfbWF4X3ZjcHVzKHZvaWQpCiAKICAgICBmb3IgKCBpID0gMDsgaSA8IGRvbTBfbnJfcHhtczsg
KytpICkKICAgICAgICAgaWYgKCAobm9kZSA9IHB4bV90b19ub2RlKGRvbTBfcHhtc1tpXSkpICE9
IE5VTUFfTk9fTk9ERSApCi0gICAgICAgICAgICBub2RlX3NldChub2RlLCBkb20wX25vZGVzKTsK
LSAgICBub2Rlc19hbmQoZG9tMF9ub2RlcywgZG9tMF9ub2Rlcywgbm9kZV9vbmxpbmVfbWFwKTsK
LSAgICBpZiAoIG5vZGVzX2VtcHR5KGRvbTBfbm9kZXMpICkKKyAgICAgICAgICAgIG5vZGVfc2V0
KG5vZGUsICZkb20wX25vZGVzKTsKKyAgICBub2Rlc19hbmQoJmRvbTBfbm9kZXMsICZkb20wX25v
ZGVzLCAmbm9kZV9vbmxpbmVfbWFwKTsKKyAgICBpZiAoIG5vZGVzX2VtcHR5KCZkb20wX25vZGVz
KSApCiAgICAgICAgIGRvbTBfbm9kZXMgPSBub2RlX29ubGluZV9tYXA7Ci0gICAgZm9yX2VhY2hf
bm9kZV9tYXNrICggbm9kZSwgZG9tMF9ub2RlcyApCisgICAgZm9yX2VhY2hfbm9kZV9tYXNrICgg
bm9kZSwgJmRvbTBfbm9kZXMgKQogICAgICAgICBjcHVtYXNrX29yKCZkb20wX2NwdXMsICZkb20w
X2NwdXMsICZub2RlX3RvX2NwdW1hc2sobm9kZSkpOwogICAgIGNwdW1hc2tfYW5kKCZkb20wX2Nw
dXMsICZkb20wX2NwdXMsIGNwdXBvb2wwLT5jcHVfdmFsaWQpOwogICAgIGlmICggY3B1bWFza19l
bXB0eSgmZG9tMF9jcHVzKSApCkBAIC0zNDQsNyArMzQ0LDcgQEAgdW5zaWduZWQgbG9uZyBfX2lu
aXQgZG9tMF9jb21wdXRlX25yX3BhZ2VzKAogICAgIGlmICggIWRvbTBfbWVtX3NldCAmJiBDT05G
SUdfRE9NMF9NRU1bMF0gKQogICAgICAgICBwYXJzZV9kb20wX21lbShDT05GSUdfRE9NMF9NRU0p
OwogCi0gICAgZm9yX2VhY2hfbm9kZV9tYXNrICggbm9kZSwgZG9tMF9ub2RlcyApCisgICAgZm9y
X2VhY2hfbm9kZV9tYXNrICggbm9kZSwgJmRvbTBfbm9kZXMgKQogICAgICAgICBhdmFpbCArPSBh
dmFpbF9kb21oZWFwX3BhZ2VzX3JlZ2lvbihub2RlLCAwLCAwKSArCiAgICAgICAgICAgICAgICAg
IGluaXRpYWxfaW1hZ2VzX25ycGFnZXMobm9kZSk7CiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4
Ni9udW1hLmMgYi94ZW4vYXJjaC94ODYvbnVtYS5jCmluZGV4IGIzYzljMTJkN2YuLmMzNmM2OWU4
NDIgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9udW1hLmMKKysrIGIveGVuL2FyY2gveDg2L251
bWEuYwpAQCAtMTg2LDE1ICsxODYsMTUgQEAgdm9pZCBfX2luaXQgbnVtYV9pbml0X2FycmF5KHZv
aWQpCiAgICAgICAgbWFwcGluZy4gVG8gYXZvaWQgdGhpcyBmaWxsIGluIHRoZSBtYXBwaW5nIGZv
ciBhbGwgcG9zc2libGUKICAgICAgICBDUFVzLCBhcyB0aGUgbnVtYmVyIG9mIENQVXMgaXMgbm90
IGtub3duIHlldC4KICAgICAgICBXZSByb3VuZCByb2JpbiB0aGUgZXhpc3Rpbmcgbm9kZXMuICov
Ci0gICAgcnIgPSBmaXJzdF9ub2RlKG5vZGVfb25saW5lX21hcCk7CisgICAgcnIgPSBmaXJzdF9u
b2RlKCZub2RlX29ubGluZV9tYXApOwogICAgIGZvciAoIGkgPSAwOyBpIDwgbnJfY3B1X2lkczsg
aSsrICkKICAgICB7CiAgICAgICAgIGlmICggY3B1X3RvX25vZGVbaV0gIT0gTlVNQV9OT19OT0RF
ICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICBudW1hX3NldF9ub2RlKGksIHJyKTsK
LSAgICAgICAgcnIgPSBuZXh0X25vZGUocnIsIG5vZGVfb25saW5lX21hcCk7CisgICAgICAgIHJy
ID0gbmV4dF9ub2RlKHJyLCAmbm9kZV9vbmxpbmVfbWFwKTsKICAgICAgICAgaWYgKCByciA9PSBN
QVhfTlVNTk9ERVMgKQotICAgICAgICAgICAgcnIgPSBmaXJzdF9ub2RlKG5vZGVfb25saW5lX21h
cCk7CisgICAgICAgICAgICByciA9IGZpcnN0X25vZGUoJm5vZGVfb25saW5lX21hcCk7CiAgICAg
fQogfQogCkBAIC0yNzEsNyArMjcxLDcgQEAgdm9pZCBfX2luaXQgbnVtYV9pbml0bWVtX2luaXQo
dW5zaWduZWQgbG9uZyBzdGFydF9wZm4sIHVuc2lnbmVkIGxvbmcgZW5kX3BmbikKICAgICAvKiBz
ZXR1cCBkdW1teSBub2RlIGNvdmVyaW5nIGFsbCBtZW1vcnkgKi8KICAgICBtZW1ub2RlX3NoaWZ0
ID0gQklUU19QRVJfTE9ORyAtIDE7CiAgICAgbWVtbm9kZW1hcCA9IF9tZW1ub2RlbWFwOwotICAg
IG5vZGVzX2NsZWFyKG5vZGVfb25saW5lX21hcCk7CisgICAgbm9kZXNfY2xlYXIoJm5vZGVfb25s
aW5lX21hcCk7CiAgICAgbm9kZV9zZXRfb25saW5lKDApOwogICAgIGZvciAoIGkgPSAwOyBpIDwg
bnJfY3B1X2lkczsgaSsrICkKICAgICAgICAgbnVtYV9zZXRfbm9kZShpLCAwKTsKZGlmZiAtLWdp
dCBhL3hlbi9hcmNoL3g4Ni9zcmF0LmMgYi94ZW4vYXJjaC94ODYvc3JhdC5jCmluZGV4IDQ3YTQy
NjcyMjAuLjM0OGJjZmVhNzMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9zcmF0LmMKKysrIGIv
eGVuL2FyY2gveDg2L3NyYXQuYwpAQCAtMjI4LDcgKzIyOCw3IEBAIGFjcGlfbnVtYV94MmFwaWNf
YWZmaW5pdHlfaW5pdChjb25zdCBzdHJ1Y3QgYWNwaV9zcmF0X3gyYXBpY19jcHVfYWZmaW5pdHkg
KnBhKQogCX0KIAogCWFwaWNpZF90b19ub2RlW3BhLT5hcGljX2lkXSA9IG5vZGU7Ci0Jbm9kZV9z
ZXQobm9kZSwgcHJvY2Vzc29yX25vZGVzX3BhcnNlZCk7CisJbm9kZV9zZXQobm9kZSwgJnByb2Nl
c3Nvcl9ub2Rlc19wYXJzZWQpOwogCWFjcGlfbnVtYSA9IDE7CiAJcHJpbnRrKEtFUk5fSU5GTyAi
U1JBVDogUFhNICV1IC0+IEFQSUMgJTA4eCAtPiBOb2RlICV1XG4iLAogCSAgICAgICBweG0sIHBh
LT5hcGljX2lkLCBub2RlKTsKQEAgLTI2MSw3ICsyNjEsNyBAQCBhY3BpX251bWFfcHJvY2Vzc29y
X2FmZmluaXR5X2luaXQoY29uc3Qgc3RydWN0IGFjcGlfc3JhdF9jcHVfYWZmaW5pdHkgKnBhKQog
CQlyZXR1cm47CiAJfQogCWFwaWNpZF90b19ub2RlW3BhLT5hcGljX2lkXSA9IG5vZGU7Ci0Jbm9k
ZV9zZXQobm9kZSwgcHJvY2Vzc29yX25vZGVzX3BhcnNlZCk7CisJbm9kZV9zZXQobm9kZSwgJnBy
b2Nlc3Nvcl9ub2Rlc19wYXJzZWQpOwogCWFjcGlfbnVtYSA9IDE7CiAJcHJpbnRrKEtFUk5fSU5G
TyAiU1JBVDogUFhNICV1IC0+IEFQSUMgJTAyeCAtPiBOb2RlICV1XG4iLAogCSAgICAgICBweG0s
IHBhLT5hcGljX2lkLCBub2RlKTsKQEAgLTMzMiw3ICszMzIsNyBAQCBhY3BpX251bWFfbWVtb3J5
X2FmZmluaXR5X2luaXQoY29uc3Qgc3RydWN0IGFjcGlfc3JhdF9tZW1fYWZmaW5pdHkgKm1hKQog
CWlmICghKG1hLT5mbGFncyAmIEFDUElfU1JBVF9NRU1fSE9UX1BMVUdHQUJMRSkpIHsKIAkJc3Ry
dWN0IG5vZGUgKm5kID0gJm5vZGVzW25vZGVdOwogCi0JCWlmICghbm9kZV90ZXN0X2FuZF9zZXQo
bm9kZSwgbWVtb3J5X25vZGVzX3BhcnNlZCkpIHsKKwkJaWYgKCFub2RlX3Rlc3RfYW5kX3NldChu
b2RlLCAmbWVtb3J5X25vZGVzX3BhcnNlZCkpIHsKIAkJCW5kLT5zdGFydCA9IHN0YXJ0OwogCQkJ
bmQtPmVuZCA9IGVuZDsKIAkJfSBlbHNlIHsKQEAgLTM3Niw3ICszNzYsNyBAQCBzdGF0aWMgaW50
IF9faW5pdCBub2Rlc19jb3Zlcl9tZW1vcnkodm9pZCkKIAogCQlkbyB7CiAJCQlmb3VuZCA9IDA7
Ci0JCQlmb3JfZWFjaF9ub2RlX21hc2soaiwgbWVtb3J5X25vZGVzX3BhcnNlZCkKKwkJCWZvcl9l
YWNoX25vZGVfbWFzayggaiwgJm1lbW9yeV9ub2Rlc19wYXJzZWQgKQogCQkJCWlmIChzdGFydCA8
IG5vZGVzW2pdLmVuZAogCQkJCSAgICAmJiBlbmQgPiBub2Rlc1tqXS5zdGFydCkgewogCQkJCQlp
ZiAoc3RhcnQgPj0gbm9kZXNbal0uc3RhcnQpIHsKQEAgLTQ4MCwxMCArNDgwLDExIEBAIGludCBf
X2luaXQgYWNwaV9zY2FuX25vZGVzKHU2NCBzdGFydCwgdTY0IGVuZCkKIAkJcmV0dXJuIC0xOwog
CX0KIAotCW5vZGVzX29yKGFsbF9ub2Rlc19wYXJzZWQsIG1lbW9yeV9ub2Rlc19wYXJzZWQsIHBy
b2Nlc3Nvcl9ub2Rlc19wYXJzZWQpOworCW5vZGVzX29yKCZhbGxfbm9kZXNfcGFyc2VkLCAmbWVt
b3J5X25vZGVzX3BhcnNlZCwKKwkJICZwcm9jZXNzb3Jfbm9kZXNfcGFyc2VkKTsKIAogCS8qIEZp
bmFsbHkgcmVnaXN0ZXIgbm9kZXMgKi8KLQlmb3JfZWFjaF9ub2RlX21hc2soaSwgYWxsX25vZGVz
X3BhcnNlZCkKKwlmb3JfZWFjaF9ub2RlX21hc2soIGksICZhbGxfbm9kZXNfcGFyc2VkICkKIAl7
CiAJCXU2NCBzaXplID0gbm9kZXNbaV0uZW5kIC0gbm9kZXNbaV0uc3RhcnQ7CiAJCWlmICggc2l6
ZSA9PSAwICkKQEAgLTQ5NSw3ICs0OTYsNyBAQCBpbnQgX19pbml0IGFjcGlfc2Nhbl9ub2Rlcyh1
NjQgc3RhcnQsIHU2NCBlbmQpCiAJZm9yIChpID0gMDsgaSA8IG5yX2NwdV9pZHM7IGkrKykgewog
CQlpZiAoY3B1X3RvX25vZGVbaV0gPT0gTlVNQV9OT19OT0RFKQogCQkJY29udGludWU7Ci0JCWlm
ICghbm9kZV9pc3NldChjcHVfdG9fbm9kZVtpXSwgcHJvY2Vzc29yX25vZGVzX3BhcnNlZCkpCisJ
CWlmICghbm9kZV9pc3NldChjcHVfdG9fbm9kZVtpXSwgJnByb2Nlc3Nvcl9ub2Rlc19wYXJzZWQp
KQogCQkJbnVtYV9zZXRfbm9kZShpLCBOVU1BX05PX05PREUpOwogCX0KIAludW1hX2luaXRfYXJy
YXkoKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vZG9tYWluLmMgYi94ZW4vY29tbW9uL2RvbWFp
bi5jCmluZGV4IDIzMDg1ODgwNTIuLmNmMmE5NjM2ODcgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
ZG9tYWluLmMKKysrIGIveGVuL2NvbW1vbi9kb21haW4uYwpAQCAtNjEzLDkgKzYxMyw5IEBAIHZv
aWQgZG9tYWluX3VwZGF0ZV9ub2RlX2FmZmluaXR5KHN0cnVjdCBkb21haW4gKmQpCiAgICAgICAg
IGRvbV9hZmZpbml0eSA9IGNwdW1hc2tfZW1wdHkoZG9tX2NwdW1hc2tfc29mdCkgPwogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZG9tX2NwdW1hc2sgOiBkb21fY3B1bWFza19zb2Z0OwogCi0g
ICAgICAgIG5vZGVzX2NsZWFyKGQtPm5vZGVfYWZmaW5pdHkpOworICAgICAgICBub2Rlc19jbGVh
cigmZC0+bm9kZV9hZmZpbml0eSk7CiAgICAgICAgIGZvcl9lYWNoX2NwdSAoIGNwdSwgZG9tX2Fm
ZmluaXR5ICkKLSAgICAgICAgICAgIG5vZGVfc2V0KGNwdV90b19ub2RlKGNwdSksIGQtPm5vZGVf
YWZmaW5pdHkpOworICAgICAgICAgICAgbm9kZV9zZXQoY3B1X3RvX25vZGUoY3B1KSwgJmQtPm5v
ZGVfYWZmaW5pdHkpOwogICAgIH0KIAogICAgIHNwaW5fdW5sb2NrKCZkLT5ub2RlX2FmZmluaXR5
X2xvY2spOwpAQCAtNjI4LDcgKzYyOCw3IEBAIHZvaWQgZG9tYWluX3VwZGF0ZV9ub2RlX2FmZmlu
aXR5KHN0cnVjdCBkb21haW4gKmQpCiBpbnQgZG9tYWluX3NldF9ub2RlX2FmZmluaXR5KHN0cnVj
dCBkb21haW4gKmQsIGNvbnN0IG5vZGVtYXNrX3QgKmFmZmluaXR5KQogewogICAgIC8qIEJlaW5n
IGFmZmluZSB3aXRoIG5vIG5vZGVzIGlzIGp1c3Qgd3JvbmcgKi8KLSAgICBpZiAoIG5vZGVzX2Vt
cHR5KCphZmZpbml0eSkgKQorICAgIGlmICggbm9kZXNfZW1wdHkoYWZmaW5pdHkpICkKICAgICAg
ICAgcmV0dXJuIC1FSU5WQUw7CiAKICAgICBzcGluX2xvY2soJmQtPm5vZGVfYWZmaW5pdHlfbG9j
ayk7CkBAIC02MzcsNyArNjM3LDcgQEAgaW50IGRvbWFpbl9zZXRfbm9kZV9hZmZpbml0eShzdHJ1
Y3QgZG9tYWluICpkLCBjb25zdCBub2RlbWFza190ICphZmZpbml0eSkKICAgICAgKiBCZWluZy9i
ZWNvbWluZyBleHBsaWNpdGx5IGFmZmluZSB0byBhbGwgbm9kZXMgaXMgbm90IHBhcnRpY3VsYXJs
eQogICAgICAqIHVzZWZ1bC4gTGV0J3MgdGFrZSBpdCBhcyB0aGUgYHJlc2V0IG5vZGUgYWZmaW5p
dHlgIGNvbW1hbmQuCiAgICAgICovCi0gICAgaWYgKCBub2Rlc19mdWxsKCphZmZpbml0eSkgKQor
ICAgIGlmICggbm9kZXNfZnVsbChhZmZpbml0eSkgKQogICAgIHsKICAgICAgICAgZC0+YXV0b19u
b2RlX2FmZmluaXR5ID0gMTsKICAgICAgICAgZ290byBvdXQ7CmRpZmYgLS1naXQgYS94ZW4vY29t
bW9uL3BhZ2VfYWxsb2MuYyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCmluZGV4IDdiYmI0NGY3
ZDEuLjdiYmE1YjBiMmUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCisrKyBi
L3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCkBAIC04MjAsOSArODIwLDkgQEAgc3RhdGljIHN0cnVj
dCBwYWdlX2luZm8gKmdldF9mcmVlX2J1ZGR5KHVuc2lnbmVkIGludCB6b25lX2xvLAogICAgIHsK
ICAgICAgICAgaWYgKCBkICE9IE5VTEwgKQogICAgICAgICB7Ci0gICAgICAgICAgICBub2RlID0g
bmV4dF9ub2RlKGQtPmxhc3RfYWxsb2Nfbm9kZSwgbm9kZW1hc2spOworICAgICAgICAgICAgbm9k
ZSA9IG5leHRfbm9kZShkLT5sYXN0X2FsbG9jX25vZGUsICZub2RlbWFzayk7CiAgICAgICAgICAg
ICBpZiAoIG5vZGUgPj0gTUFYX05VTU5PREVTICkKLSAgICAgICAgICAgICAgICBub2RlID0gZmly
c3Rfbm9kZShub2RlbWFzayk7CisgICAgICAgICAgICAgICAgbm9kZSA9IGZpcnN0X25vZGUoJm5v
ZGVtYXNrKTsKICAgICAgICAgfQogICAgICAgICBpZiAoIG5vZGUgPj0gTUFYX05VTU5PREVTICkK
ICAgICAgICAgICAgIG5vZGUgPSBjcHVfdG9fbm9kZShzbXBfcHJvY2Vzc29yX2lkKCkpOwpAQCAt
ODc0LDIzICs4NzQsMjMgQEAgc3RhdGljIHN0cnVjdCBwYWdlX2luZm8gKmdldF9mcmVlX2J1ZGR5
KHVuc2lnbmVkIGludCB6b25lX2xvLAogICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAKICAgICAg
ICAgLyogUGljayBuZXh0IG5vZGUuICovCi0gICAgICAgIGlmICggIW5vZGVfaXNzZXQobm9kZSwg
bm9kZW1hc2spICkKKyAgICAgICAgaWYgKCAhbm9kZV9pc3NldChub2RlLCAmbm9kZW1hc2spICkK
ICAgICAgICAgewogICAgICAgICAgICAgLyogVmVyeSBmaXJzdCBub2RlIG1heSBiZSBjYWxsZXIt
c3BlY2lmaWVkIGFuZCBvdXRzaWRlIG5vZGVtYXNrLiAqLwogICAgICAgICAgICAgQVNTRVJUKCFu
b2RlbWFza19yZXRyeSk7Ci0gICAgICAgICAgICBmaXJzdCA9IG5vZGUgPSBmaXJzdF9ub2RlKG5v
ZGVtYXNrKTsKKyAgICAgICAgICAgIGZpcnN0ID0gbm9kZSA9IGZpcnN0X25vZGUoJm5vZGVtYXNr
KTsKICAgICAgICAgICAgIGlmICggbm9kZSA8IE1BWF9OVU1OT0RFUyApCiAgICAgICAgICAgICAg
ICAgY29udGludWU7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIChub2RlID0gbmV4dF9u
b2RlKG5vZGUsIG5vZGVtYXNrKSkgPj0gTUFYX05VTU5PREVTICkKLSAgICAgICAgICAgIG5vZGUg
PSBmaXJzdF9ub2RlKG5vZGVtYXNrKTsKKyAgICAgICAgZWxzZSBpZiAoIChub2RlID0gbmV4dF9u
b2RlKG5vZGUsICZub2RlbWFzaykpID49IE1BWF9OVU1OT0RFUyApCisgICAgICAgICAgICBub2Rl
ID0gZmlyc3Rfbm9kZSgmbm9kZW1hc2spOwogICAgICAgICBpZiAoIG5vZGUgPT0gZmlyc3QgKQog
ICAgICAgICB7CiAgICAgICAgICAgICAvKiBXaGVuIHdlIGhhdmUgdHJpZWQgYWxsIGluIG5vZGVt
YXNrLCB3ZSBmYWxsIGJhY2sgdG8gb3RoZXJzLiAqLwogICAgICAgICAgICAgaWYgKCAobWVtZmxh
Z3MgJiBNRU1GX2V4YWN0X25vZGUpIHx8IG5vZGVtYXNrX3JldHJ5KysgKQogICAgICAgICAgICAg
ICAgIHJldHVybiBOVUxMOwotICAgICAgICAgICAgbm9kZXNfYW5kbm90KG5vZGVtYXNrLCBub2Rl
X29ubGluZV9tYXAsIG5vZGVtYXNrKTsKLSAgICAgICAgICAgIGZpcnN0ID0gbm9kZSA9IGZpcnN0
X25vZGUobm9kZW1hc2spOworICAgICAgICAgICAgbm9kZXNfYW5kbm90KCZub2RlbWFzaywgJm5v
ZGVfb25saW5lX21hcCwgJm5vZGVtYXNrKTsKKyAgICAgICAgICAgIGZpcnN0ID0gbm9kZSA9IGZp
cnN0X25vZGUoJm5vZGVtYXNrKTsKICAgICAgICAgICAgIGlmICggbm9kZSA+PSBNQVhfTlVNTk9E
RVMgKQogICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICB9CkBAIC0xMTY3LDcg
KzExNjcsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IG5vZGVfdG9fc2NydWIoYm9vbCBnZXRfbm9k
ZSkKICAgICAgICAgbm9kZSA9IDA7CiAKICAgICBpZiAoIG5vZGVfbmVlZF9zY3J1Yltub2RlXSAm
JgotICAgICAgICAgKCFnZXRfbm9kZSB8fCAhbm9kZV90ZXN0X2FuZF9zZXQobm9kZSwgbm9kZV9z
Y3J1YmJpbmcpKSApCisgICAgICAgICAoIWdldF9ub2RlIHx8ICFub2RlX3Rlc3RfYW5kX3NldChu
b2RlLCAmbm9kZV9zY3J1YmJpbmcpKSApCiAgICAgICAgIHJldHVybiBub2RlOwogCiAgICAgLyoK
QEAgLTExNzgsNyArMTE3OCw3IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgbm9kZV90b19zY3J1Yihi
b29sIGdldF9ub2RlKQogICAgIGZvciAoIDsgOyApCiAgICAgewogICAgICAgICBkbyB7Ci0gICAg
ICAgICAgICBub2RlID0gY3ljbGVfbm9kZShub2RlLCBub2RlX29ubGluZV9tYXApOworICAgICAg
ICAgICAgbm9kZSA9IGN5Y2xlX25vZGUobm9kZSwgJm5vZGVfb25saW5lX21hcCk7CiAgICAgICAg
IH0gd2hpbGUgKCAhY3B1bWFza19lbXB0eSgmbm9kZV90b19jcHVtYXNrKG5vZGUpKSAmJgogICAg
ICAgICAgICAgICAgICAgKG5vZGUgIT0gbG9jYWxfbm9kZSkgKTsKIApAQCAtMTIwMSwxMCArMTIw
MSwxMCBAQCBzdGF0aWMgdW5zaWduZWQgaW50IG5vZGVfdG9fc2NydWIoYm9vbCBnZXRfbm9kZSkK
ICAgICAgICAgICAgICAqIHRoZW4gd2UnZCBuZWVkIHRvIHRha2UgdGhpcyBsb2NrIGV2ZXJ5IHRp
bWUgd2UgY29tZSBpbiBoZXJlLgogICAgICAgICAgICAgICovCiAgICAgICAgICAgICBpZiAoIChk
aXN0IDwgc2hvcnRlc3QgfHwgY2xvc2VzdCA9PSBOVU1BX05PX05PREUpICYmCi0gICAgICAgICAg
ICAgICAgICFub2RlX3Rlc3RfYW5kX3NldChub2RlLCBub2RlX3NjcnViYmluZykgKQorICAgICAg
ICAgICAgICAgICAhbm9kZV90ZXN0X2FuZF9zZXQobm9kZSwgJm5vZGVfc2NydWJiaW5nKSApCiAg
ICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaWYgKCBjbG9zZXN0ICE9IE5VTUFfTk9fTk9E
RSApCi0gICAgICAgICAgICAgICAgICAgIG5vZGVfY2xlYXIoY2xvc2VzdCwgbm9kZV9zY3J1YmJp
bmcpOworICAgICAgICAgICAgICAgICAgICBub2RlX2NsZWFyKGNsb3Nlc3QsICZub2RlX3NjcnVi
YmluZyk7CiAgICAgICAgICAgICAgICAgc2hvcnRlc3QgPSBkaXN0OwogICAgICAgICAgICAgICAg
IGNsb3Nlc3QgPSBub2RlOwogICAgICAgICAgICAgfQpAQCAtMTM1Niw3ICsxMzU2LDcgQEAgYm9v
bCBzY3J1Yl9mcmVlX3BhZ2VzKHZvaWQpCiAgICAgc3Bpbl91bmxvY2soJmhlYXBfbG9jayk7CiAK
ICBvdXRfbm9sb2NrOgotICAgIG5vZGVfY2xlYXIobm9kZSwgbm9kZV9zY3J1YmJpbmcpOworICAg
IG5vZGVfY2xlYXIobm9kZSwgJm5vZGVfc2NydWJiaW5nKTsKICAgICByZXR1cm4gbm9kZV90b19z
Y3J1YihmYWxzZSkgIT0gTlVNQV9OT19OT0RFOwogfQogCkBAIC0yMDA2LDcgKzIwMDYsNyBAQCBz
dGF0aWMgdm9pZCBfX2luaXQgc2NydWJfaGVhcF9wYWdlcyh2b2lkKQogICAgICAgICAgICAgY29u
dGludWU7CiAKICAgICAgICAgbGFzdF9kaXN0YW5jZSA9IElOVF9NQVg7Ci0gICAgICAgIGJlc3Rf
bm9kZSA9IGZpcnN0X25vZGUobm9kZV9vbmxpbmVfbWFwKTsKKyAgICAgICAgYmVzdF9ub2RlID0g
Zmlyc3Rfbm9kZSgmbm9kZV9vbmxpbmVfbWFwKTsKICAgICAgICAgLyogRmlndXJlIG91dCB3aGlj
aCBOT0RFIENQVXMgYXJlIGNsb3NlLiAqLwogICAgICAgICBmb3JfZWFjaF9vbmxpbmVfbm9kZSAo
IGogKQogICAgICAgICB7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jIGIv
eGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwppbmRleCAzYzBkN2M3MjY3Li42MTFmZjI2MTUzIDEw
MDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCisrKyBiL3hlbi9jb21tb24vc2No
ZWRfY3JlZGl0LmMKQEAgLTE4MTAsNyArMTgxMCw3IEBAIGNzY2hlZF9sb2FkX2JhbGFuY2Uoc3Ry
dWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIGludCBjcHUsCiAgICAgICAgICAgICB9IHdoaWxlKCBw
ZWVyX2NwdSAhPSBmaXJzdF9jcHUgKTsKIAogIG5leHRfbm9kZToKLSAgICAgICAgICAgIHBlZXJf
bm9kZSA9IGN5Y2xlX25vZGUocGVlcl9ub2RlLCBub2RlX29ubGluZV9tYXApOworICAgICAgICAg
ICAgcGVlcl9ub2RlID0gY3ljbGVfbm9kZShwZWVyX25vZGUsICZub2RlX29ubGluZV9tYXApOwog
ICAgICAgICB9IHdoaWxlKCBwZWVyX25vZGUgIT0gbm9kZSApOwogICAgIH0KIApkaWZmIC0tZ2l0
IGEveGVuL2NvbW1vbi9zeXNjdGwuYyBiL3hlbi9jb21tb24vc3lzY3RsLmMKaW5kZXggNzY1ZWZm
ZGU4ZC4uZjE4ODRiMGFiOSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zeXNjdGwuYworKysgYi94
ZW4vY29tbW9uL3N5c2N0bC5jCkBAIC0yODAsNyArMjgwLDcgQEAgbG9uZyBkb19zeXNjdGwoWEVO
X0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fc3lzY3RsX3QpIHVfc3lzY3RsKQogICAgICAgICBib29s
X3QgZG9fbWVtaW5mbyA9ICFndWVzdF9oYW5kbGVfaXNfbnVsbChuaS0+bWVtaW5mbyk7CiAgICAg
ICAgIGJvb2xfdCBkb19kaXN0YW5jZSA9ICFndWVzdF9oYW5kbGVfaXNfbnVsbChuaS0+ZGlzdGFu
Y2UpOwogCi0gICAgICAgIG51bV9ub2RlcyA9IGxhc3Rfbm9kZShub2RlX29ubGluZV9tYXApICsg
MTsKKyAgICAgICAgbnVtX25vZGVzID0gbGFzdF9ub2RlKCZub2RlX29ubGluZV9tYXApICsgMTsK
IAogICAgICAgICBpZiAoIGRvX21lbWluZm8gfHwgZG9fZGlzdGFuY2UgKQogICAgICAgICB7CmRp
ZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vbm9kZW1hc2suaCBiL3hlbi9pbmNsdWRlL3hlbi9u
b2RlbWFzay5oCmluZGV4IGUyODczOTkzNTIuLmNiZjVkMGVlMzMgMTAwNjQ0Ci0tLSBhL3hlbi9p
bmNsdWRlL3hlbi9ub2RlbWFzay5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9ub2RlbWFzay5oCkBA
IC01OCwxMiArNTgsNiBAQAogICogbm9kZV9zZXRfb2ZmbGluZShub2RlKQkJY2xlYXIgYml0ICdu
b2RlJyBpbiBub2RlX29ubGluZV9tYXAKICAqCiAgKiBmb3JfZWFjaF9vbmxpbmVfbm9kZShub2Rl
KQkJZm9yLWxvb3Agbm9kZSBvdmVyIG5vZGVfb25saW5lX21hcAotICoKLSAqIFN1YnRsZXR5Ogot
ICogMSkgVGhlICd0eXBlLWNoZWNrZWQnIGZvcm0gb2Ygbm9kZV9pc3NldCgpIGNhdXNlcyBnY2Mg
KDMuMy4yLCBhbnl3YXkpCi0gKiAgICB0byBnZW5lcmF0ZSBzbGlnaHRseSB3b3JzZSBjb2RlLiAg
U28gdXNlIGEgc2ltcGxlIG9uZS1saW5lICNkZWZpbmUKLSAqICAgIGZvciBub2RlX2lzc2V0KCks
IGluc3RlYWQgb2Ygd3JhcHBpbmcgYW4gaW5saW5lIGluc2lkZSBhIG1hY3JvLCB0aGUKLSAqICAg
IHdheSB3ZSBkbyB0aGUgb3RoZXIgY2FsbHMuCiAgKi8KIAogI2luY2x1ZGUgPHhlbi9rZXJuZWwu
aD4KQEAgLTczLDE2MSArNjcsMTMxIEBACiB0eXBlZGVmIHN0cnVjdCB7IERFQ0xBUkVfQklUTUFQ
KGJpdHMsIE1BWF9OVU1OT0RFUyk7IH0gbm9kZW1hc2tfdDsKIGV4dGVybiBub2RlbWFza190IF91
bnVzZWRfbm9kZW1hc2tfYXJnXzsKIAotI2RlZmluZSBub2RlX3NldChub2RlLCBkc3QpIF9fbm9k
ZV9zZXQoKG5vZGUpLCAmKGRzdCkpCi1zdGF0aWMgaW5saW5lIHZvaWQgX19ub2RlX3NldChpbnQg
bm9kZSwgdm9sYXRpbGUgbm9kZW1hc2tfdCAqZHN0cCkKK3N0YXRpYyBpbmxpbmUgdm9pZCBub2Rl
X3NldChpbnQgbm9kZSwgdm9sYXRpbGUgbm9kZW1hc2tfdCAqZHN0cCkKIHsKIAlzZXRfYml0KG5v
ZGUsIGRzdHAtPmJpdHMpOwogfQogCi0jZGVmaW5lIG5vZGVfY2xlYXIobm9kZSwgZHN0KSBfX25v
ZGVfY2xlYXIoKG5vZGUpLCAmKGRzdCkpCi1zdGF0aWMgaW5saW5lIHZvaWQgX19ub2RlX2NsZWFy
KGludCBub2RlLCB2b2xhdGlsZSBub2RlbWFza190ICpkc3RwKQorc3RhdGljIGlubGluZSB2b2lk
IG5vZGVfY2xlYXIoaW50IG5vZGUsIHZvbGF0aWxlIG5vZGVtYXNrX3QgKmRzdHApCiB7CiAJY2xl
YXJfYml0KG5vZGUsIGRzdHAtPmJpdHMpOwogfQogCi0jZGVmaW5lIG5vZGVzX3NldGFsbChkc3Qp
IF9fbm9kZXNfc2V0YWxsKCYoZHN0KSwgTUFYX05VTU5PREVTKQotc3RhdGljIGlubGluZSB2b2lk
IF9fbm9kZXNfc2V0YWxsKG5vZGVtYXNrX3QgKmRzdHAsIGludCBuYml0cykKK3N0YXRpYyBpbmxp
bmUgdm9pZCBub2Rlc19zZXRhbGwobm9kZW1hc2tfdCAqZHN0cCkKIHsKLQliaXRtYXBfZmlsbChk
c3RwLT5iaXRzLCBuYml0cyk7CisJYml0bWFwX2ZpbGwoZHN0cC0+Yml0cywgTUFYX05VTU5PREVT
KTsKIH0KIAotI2RlZmluZSBub2Rlc19jbGVhcihkc3QpIF9fbm9kZXNfY2xlYXIoJihkc3QpLCBN
QVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIHZvaWQgX19ub2Rlc19jbGVhcihub2RlbWFza190
ICpkc3RwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIHZvaWQgbm9kZXNfY2xlYXIobm9kZW1h
c2tfdCAqZHN0cCkKIHsKLQliaXRtYXBfemVybyhkc3RwLT5iaXRzLCBuYml0cyk7CisJYml0bWFw
X3plcm8oZHN0cC0+Yml0cywgTUFYX05VTU5PREVTKTsKIH0KIAotLyogTm8gc3RhdGljIGlubGlu
ZSB0eXBlIGNoZWNraW5nIC0gc2VlIFN1YnRsZXR5ICgxKSBhYm92ZS4gKi8KLSNkZWZpbmUgbm9k
ZV9pc3NldChub2RlLCBub2RlbWFzaykgdGVzdF9iaXQoKG5vZGUpLCAobm9kZW1hc2spLmJpdHMp
CitzdGF0aWMgaW5saW5lIGludCBub2RlX2lzc2V0KGludCBub2RlLCBjb25zdCBub2RlbWFza190
ICpzcmMpCit7CisJcmV0dXJuIHRlc3RfYml0KG5vZGUsIHNyYy0+Yml0cyk7Cit9CiAKLSNkZWZp
bmUgbm9kZV90ZXN0X2FuZF9zZXQobm9kZSwgbm9kZW1hc2spIFwKLQkJCV9fbm9kZV90ZXN0X2Fu
ZF9zZXQoKG5vZGUpLCAmKG5vZGVtYXNrKSkKLXN0YXRpYyBpbmxpbmUgaW50IF9fbm9kZV90ZXN0
X2FuZF9zZXQoaW50IG5vZGUsIG5vZGVtYXNrX3QgKmFkZHIpCitzdGF0aWMgaW5saW5lIGludCBu
b2RlX3Rlc3RfYW5kX3NldChpbnQgbm9kZSwgbm9kZW1hc2tfdCAqYWRkcikKIHsKIAlyZXR1cm4g
dGVzdF9hbmRfc2V0X2JpdChub2RlLCBhZGRyLT5iaXRzKTsKIH0KIAotI2RlZmluZSBub2Rlc19h
bmQoZHN0LCBzcmMxLCBzcmMyKSBcCi0JCQlfX25vZGVzX2FuZCgmKGRzdCksICYoc3JjMSksICYo
c3JjMiksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgdm9pZCBfX25vZGVzX2FuZChub2Rl
bWFza190ICpkc3RwLCBjb25zdCBub2RlbWFza190ICpzcmMxcCwKLQkJCQkJY29uc3Qgbm9kZW1h
c2tfdCAqc3JjMnAsIGludCBuYml0cykKK3N0YXRpYyBpbmxpbmUgdm9pZCBub2Rlc19hbmQobm9k
ZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzJwKQogewotCWJpdG1hcF9hbmQoZHN0
cC0+Yml0cywgc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRzLCBuYml0cyk7CisJYml0bWFwX2FuZChk
c3RwLT5iaXRzLCBzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIE1BWF9OVU1OT0RFUyk7CiB9CiAK
LSNkZWZpbmUgbm9kZXNfb3IoZHN0LCBzcmMxLCBzcmMyKSBcCi0JCQlfX25vZGVzX29yKCYoZHN0
KSwgJihzcmMxKSwgJihzcmMyKSwgTUFYX05VTU5PREVTKQotc3RhdGljIGlubGluZSB2b2lkIF9f
bm9kZXNfb3Iobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCi0JCQkJ
CWNvbnN0IG5vZGVtYXNrX3QgKnNyYzJwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIHZvaWQg
bm9kZXNfb3Iobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnApCiB7Ci0JYml0
bWFwX29yKGRzdHAtPmJpdHMsIHNyYzFwLT5iaXRzLCBzcmMycC0+Yml0cywgbmJpdHMpOworCWJp
dG1hcF9vcihkc3RwLT5iaXRzLCBzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIE1BWF9OVU1OT0RF
Uyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNfeG9yKGRzdCwgc3JjMSwgc3JjMikgXAotCQkJX19ub2Rl
c194b3IoJihkc3QpLCAmKHNyYzEpLCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5s
aW5lIHZvaWQgX19ub2Rlc194b3Iobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAq
c3JjMXAsCi0JCQkJCWNvbnN0IG5vZGVtYXNrX3QgKnNyYzJwLCBpbnQgbmJpdHMpCitzdGF0aWMg
aW5saW5lIHZvaWQgbm9kZXNfeG9yKG5vZGVtYXNrX3QgKmRzdHAsIGNvbnN0IG5vZGVtYXNrX3Qg
KnNyYzFwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlbWFza190ICpz
cmMycCkKIHsKLQliaXRtYXBfeG9yKGRzdHAtPmJpdHMsIHNyYzFwLT5iaXRzLCBzcmMycC0+Yml0
cywgbmJpdHMpOworCWJpdG1hcF94b3IoZHN0cC0+Yml0cywgc3JjMXAtPmJpdHMsIHNyYzJwLT5i
aXRzLCBNQVhfTlVNTk9ERVMpOwogfQogCi0jZGVmaW5lIG5vZGVzX2FuZG5vdChkc3QsIHNyYzEs
IHNyYzIpIFwKLQkJCV9fbm9kZXNfYW5kbm90KCYoZHN0KSwgJihzcmMxKSwgJihzcmMyKSwgTUFY
X05VTU5PREVTKQotc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZXNfYW5kbm90KG5vZGVtYXNrX3Qg
KmRzdHAsIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzFwLAotCQkJCQljb25zdCBub2RlbWFza190ICpz
cmMycCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSB2b2lkIG5vZGVzX2FuZG5vdChub2RlbWFz
a190ICpkc3RwLCBjb25zdCBub2RlbWFza190ICpzcmMxcCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnApCiB7Ci0JYml0bWFwX2FuZG5vdChk
c3RwLT5iaXRzLCBzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIG5iaXRzKTsKKwliaXRtYXBfYW5k
bm90KGRzdHAtPmJpdHMsIHNyYzFwLT5iaXRzLCBzcmMycC0+Yml0cywgTUFYX05VTU5PREVTKTsK
IH0KIAotI2RlZmluZSBub2Rlc19jb21wbGVtZW50KGRzdCwgc3JjKSBcCi0JCQlfX25vZGVzX2Nv
bXBsZW1lbnQoJihkc3QpLCAmKHNyYyksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgdm9p
ZCBfX25vZGVzX2NvbXBsZW1lbnQobm9kZW1hc2tfdCAqZHN0cCwKLQkJCQkJY29uc3Qgbm9kZW1h
c2tfdCAqc3JjcCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSB2b2lkIG5vZGVzX2NvbXBsZW1l
bnQobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCkKIHsKLQliaXRtYXBf
Y29tcGxlbWVudChkc3RwLT5iaXRzLCBzcmNwLT5iaXRzLCBuYml0cyk7CisJYml0bWFwX2NvbXBs
ZW1lbnQoZHN0cC0+Yml0cywgc3JjcC0+Yml0cywgTUFYX05VTU5PREVTKTsKIH0KIAotI2RlZmlu
ZSBub2Rlc19lcXVhbChzcmMxLCBzcmMyKSBcCi0JCQlfX25vZGVzX2VxdWFsKCYoc3JjMSksICYo
c3JjMiksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fbm9kZXNfZXF1YWwoY29u
c3Qgbm9kZW1hc2tfdCAqc3JjMXAsCi0JCQkJCWNvbnN0IG5vZGVtYXNrX3QgKnNyYzJwLCBpbnQg
bmJpdHMpCitzdGF0aWMgaW5saW5lIGludCBub2Rlc19lcXVhbChjb25zdCBub2RlbWFza190ICpz
cmMxcCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnApCiB7Ci0JcmV0dXJuIGJpdG1hcF9lcXVhbChz
cmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIG5iaXRzKTsKKwlyZXR1cm4gYml0bWFwX2VxdWFsKHNy
YzFwLT5iaXRzLCBzcmMycC0+Yml0cywgTUFYX05VTU5PREVTKTsKIH0KIAotI2RlZmluZSBub2Rl
c19pbnRlcnNlY3RzKHNyYzEsIHNyYzIpIFwKLQkJCV9fbm9kZXNfaW50ZXJzZWN0cygmKHNyYzEp
LCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIGludCBfX25vZGVzX2ludGVy
c2VjdHMoY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCi0JCQkJCWNvbnN0IG5vZGVtYXNrX3QgKnNy
YzJwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIGludCBub2Rlc19pbnRlcnNlY3RzKGNvbnN0
IG5vZGVtYXNrX3QgKnNyYzFwLAorCQkJCSAgIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzJwKQogewot
CXJldHVybiBiaXRtYXBfaW50ZXJzZWN0cyhzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIG5iaXRz
KTsKKwlyZXR1cm4gYml0bWFwX2ludGVyc2VjdHMoc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRzLCBN
QVhfTlVNTk9ERVMpOwogfQogCi0jZGVmaW5lIG5vZGVzX3N1YnNldChzcmMxLCBzcmMyKSBcCi0J
CQlfX25vZGVzX3N1YnNldCgmKHNyYzEpLCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMg
aW5saW5lIGludCBfX25vZGVzX3N1YnNldChjb25zdCBub2RlbWFza190ICpzcmMxcCwKLQkJCQkJ
Y29uc3Qgbm9kZW1hc2tfdCAqc3JjMnAsIGludCBuYml0cykKK3N0YXRpYyBpbmxpbmUgaW50IG5v
ZGVzX3N1YnNldChjb25zdCBub2RlbWFza190ICpzcmMxcCwgY29uc3Qgbm9kZW1hc2tfdCAqc3Jj
MnApCiB7Ci0JcmV0dXJuIGJpdG1hcF9zdWJzZXQoc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRzLCBu
Yml0cyk7CisJcmV0dXJuIGJpdG1hcF9zdWJzZXQoc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRzLCBN
QVhfTlVNTk9ERVMpOwogfQogCi0jZGVmaW5lIG5vZGVzX2VtcHR5KHNyYykgX19ub2Rlc19lbXB0
eSgmKHNyYyksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fbm9kZXNfZW1wdHko
Y29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSBpbnQgbm9k
ZXNfZW1wdHkoY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCkKIHsKLQlyZXR1cm4gYml0bWFwX2VtcHR5
KHNyY3AtPmJpdHMsIG5iaXRzKTsKKwlyZXR1cm4gYml0bWFwX2VtcHR5KHNyY3AtPmJpdHMsIE1B
WF9OVU1OT0RFUyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNfZnVsbChub2RlbWFzaykgX19ub2Rlc19m
dWxsKCYobm9kZW1hc2spLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIGludCBfX25vZGVz
X2Z1bGwoY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSBp
bnQgbm9kZXNfZnVsbChjb25zdCBub2RlbWFza190ICpzcmNwKQogewotCXJldHVybiBiaXRtYXBf
ZnVsbChzcmNwLT5iaXRzLCBuYml0cyk7CisJcmV0dXJuIGJpdG1hcF9mdWxsKHNyY3AtPmJpdHMs
IE1BWF9OVU1OT0RFUyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNfd2VpZ2h0KG5vZGVtYXNrKSBfX25v
ZGVzX3dlaWdodCgmKG5vZGVtYXNrKSwgTUFYX05VTU5PREVTKQotc3RhdGljIGlubGluZSBpbnQg
X19ub2Rlc193ZWlnaHQoY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgaW50IG5iaXRzKQorc3RhdGlj
IGlubGluZSBpbnQgbm9kZXNfd2VpZ2h0KGNvbnN0IG5vZGVtYXNrX3QgKnNyY3ApCiB7Ci0JcmV0
dXJuIGJpdG1hcF93ZWlnaHQoc3JjcC0+Yml0cywgbmJpdHMpOworCXJldHVybiBiaXRtYXBfd2Vp
Z2h0KHNyY3AtPmJpdHMsIE1BWF9OVU1OT0RFUyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNfc2hpZnRf
cmlnaHQoZHN0LCBzcmMsIG4pIFwKLQkJCV9fbm9kZXNfc2hpZnRfcmlnaHQoJihkc3QpLCAmKHNy
YyksIChuKSwgTUFYX05VTU5PREVTKQotc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZXNfc2hpZnRf
cmlnaHQobm9kZW1hc2tfdCAqZHN0cCwKLQkJCQkJY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgaW50
IG4sIGludCBuYml0cykKK3N0YXRpYyBpbmxpbmUgdm9pZCBub2Rlc19zaGlmdF9yaWdodChub2Rl
bWFza190ICpkc3RwLCBjb25zdCBub2RlbWFza190ICpzcmNwLAorCQkJCSAgICAgaW50IG4pCiB7
Ci0JYml0bWFwX3NoaWZ0X3JpZ2h0KGRzdHAtPmJpdHMsIHNyY3AtPmJpdHMsIG4sIG5iaXRzKTsK
KwliaXRtYXBfc2hpZnRfcmlnaHQoZHN0cC0+Yml0cywgc3JjcC0+Yml0cywgbiwgTUFYX05VTU5P
REVTKTsKIH0KIAotI2RlZmluZSBub2Rlc19zaGlmdF9sZWZ0KGRzdCwgc3JjLCBuKSBcCi0JCQlf
X25vZGVzX3NoaWZ0X2xlZnQoJihkc3QpLCAmKHNyYyksIChuKSwgTUFYX05VTU5PREVTKQotc3Rh
dGljIGlubGluZSB2b2lkIF9fbm9kZXNfc2hpZnRfbGVmdChub2RlbWFza190ICpkc3RwLAotCQkJ
CQljb25zdCBub2RlbWFza190ICpzcmNwLCBpbnQgbiwgaW50IG5iaXRzKQorc3RhdGljIGlubGlu
ZSB2b2lkIG5vZGVzX3NoaWZ0X2xlZnQobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tf
dCAqc3JjcCwKKwkJCQkgICAgaW50IG4pCiB7Ci0JYml0bWFwX3NoaWZ0X2xlZnQoZHN0cC0+Yml0
cywgc3JjcC0+Yml0cywgbiwgbmJpdHMpOworCWJpdG1hcF9zaGlmdF9sZWZ0KGRzdHAtPmJpdHMs
IHNyY3AtPmJpdHMsIG4sIE1BWF9OVU1OT0RFUyk7CiB9CiAKIC8qIEZJWE1FOiBiZXR0ZXIgd291
bGQgYmUgdG8gZml4IGFsbCBhcmNoaXRlY3R1cmVzIHRvIG5ldmVyIHJldHVybgogICAgICAgICAg
ID4gTUFYX05VTU5PREVTLCB0aGVuIHRoZSBzaWxseSBtaW5fdHMgY291bGQgYmUgZHJvcHBlZC4g
Ki8KIAotI2RlZmluZSBmaXJzdF9ub2RlKHNyYykgX19maXJzdF9ub2RlKCYoc3JjKSwgTUFYX05V
TU5PREVTKQotc3RhdGljIGlubGluZSBpbnQgX19maXJzdF9ub2RlKGNvbnN0IG5vZGVtYXNrX3Qg
KnNyY3AsIGludCBuYml0cykKK3N0YXRpYyBpbmxpbmUgaW50IGZpcnN0X25vZGUoY29uc3Qgbm9k
ZW1hc2tfdCAqc3JjcCkKIHsKLQlyZXR1cm4gbWluX3QoaW50LCBuYml0cywgZmluZF9maXJzdF9i
aXQoc3JjcC0+Yml0cywgbmJpdHMpKTsKKwlyZXR1cm4gbWluX3QoaW50LCBNQVhfTlVNTk9ERVMs
CisJCSAgICAgZmluZF9maXJzdF9iaXQoc3JjcC0+Yml0cywgTUFYX05VTU5PREVTKSk7CiB9CiAK
LSNkZWZpbmUgbmV4dF9ub2RlKG4sIHNyYykgX19uZXh0X25vZGUoKG4pLCAmKHNyYyksIE1BWF9O
VU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fbmV4dF9ub2RlKGludCBuLCBjb25zdCBub2Rl
bWFza190ICpzcmNwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIGludCBuZXh0X25vZGUoaW50
IG4sIGNvbnN0IG5vZGVtYXNrX3QgKnNyY3ApCiB7Ci0JcmV0dXJuIG1pbl90KGludCwgbmJpdHMs
IGZpbmRfbmV4dF9iaXQoc3JjcC0+Yml0cywgbmJpdHMsIG4rMSkpOworCXJldHVybiBtaW5fdChp
bnQsIE1BWF9OVU1OT0RFUywKKwkJICAgICBmaW5kX25leHRfYml0KHNyY3AtPmJpdHMsIE1BWF9O
VU1OT0RFUywgbiArIDEpKTsKIH0KIAotI2RlZmluZSBsYXN0X25vZGUoc3JjKSBfX2xhc3Rfbm9k
ZSgmKHNyYyksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fbGFzdF9ub2RlKGNv
bnN0IG5vZGVtYXNrX3QgKnNyY3AsIGludCBuYml0cykKK3N0YXRpYyBpbmxpbmUgaW50IGxhc3Rf
bm9kZShjb25zdCBub2RlbWFza190ICpzcmNwKQogewotCWludCBub2RlLCBwbm9kZSA9IG5iaXRz
OwotCWZvciAobm9kZSA9IF9fZmlyc3Rfbm9kZShzcmNwLCBuYml0cyk7Ci0JICAgICBub2RlIDwg
bmJpdHM7Ci0JICAgICBub2RlID0gX19uZXh0X25vZGUobm9kZSwgc3JjcCwgbmJpdHMpKQorCWlu
dCBub2RlLCBwbm9kZSA9IE1BWF9OVU1OT0RFUzsKKworCWZvciAobm9kZSA9IGZpcnN0X25vZGUo
c3JjcCk7CisJICAgICBub2RlIDwgTUFYX05VTU5PREVTOyBub2RlID0gbmV4dF9ub2RlKG5vZGUs
IHNyY3ApKQogCQlwbm9kZSA9IG5vZGU7CisKIAlyZXR1cm4gcG5vZGU7CiB9CiAKQEAgLTIzNywy
NyArMjAxLDI2IEBAIHN0YXRpYyBpbmxpbmUgaW50IF9fbGFzdF9ub2RlKGNvbnN0IG5vZGVtYXNr
X3QgKnNyY3AsIGludCBuYml0cykKIAlpZiAoc2l6ZW9mKG0pID09IHNpemVvZih1bnNpZ25lZCBs
b25nKSkgewkJCVwKIAkJbS5iaXRzWzBdID0gMVVMPDwobm9kZSk7CQkJCVwKIAl9IGVsc2UgewkJ
CQkJCQlcCi0JCW5vZGVzX2NsZWFyKG0pOwkJCQkJCVwKLQkJbm9kZV9zZXQoKG5vZGUpLCBtKTsJ
CQkJCVwKKwkJbm9kZXNfY2xlYXIoJm0pOwkJCQkJXAorCQlub2RlX3NldChub2RlLCAmbSk7CQkJ
CQlcCiAJfQkJCQkJCQkJXAogCW07CQkJCQkJCQlcCiB9KQogCi0jZGVmaW5lIGZpcnN0X3Vuc2V0
X25vZGUobWFzaykgX19maXJzdF91bnNldF9ub2RlKCYobWFzaykpCi1zdGF0aWMgaW5saW5lIGlu
dCBfX2ZpcnN0X3Vuc2V0X25vZGUoY29uc3Qgbm9kZW1hc2tfdCAqbWFza3ApCitzdGF0aWMgaW5s
aW5lIGludCBmaXJzdF91bnNldF9ub2RlKGNvbnN0IG5vZGVtYXNrX3QgKm1hc2twKQogewotCXJl
dHVybiBtaW5fdChpbnQsTUFYX05VTU5PREVTLAotCQkJZmluZF9maXJzdF96ZXJvX2JpdChtYXNr
cC0+Yml0cywgTUFYX05VTU5PREVTKSk7CisJcmV0dXJuIG1pbl90KGludCwgTUFYX05VTU5PREVT
LAorCQkgICAgIGZpbmRfZmlyc3RfemVyb19iaXQobWFza3AtPmJpdHMsIE1BWF9OVU1OT0RFUykp
OwogfQogCi0jZGVmaW5lIGN5Y2xlX25vZGUobiwgc3JjKSBfX2N5Y2xlX25vZGUoKG4pLCAmKHNy
YyksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fY3ljbGVfbm9kZShpbnQgbiwg
Y29uc3Qgbm9kZW1hc2tfdCAqbWFza3AsIGludCBuYml0cykKK3N0YXRpYyBpbmxpbmUgaW50IGN5
Y2xlX25vZGUoaW50IG4sIGNvbnN0IG5vZGVtYXNrX3QgKm1hc2twKQogewotICAgIGludCBueHQg
PSBfX25leHRfbm9kZShuLCBtYXNrcCwgbmJpdHMpOworCWludCBueHQgPSBuZXh0X25vZGUobiwg
bWFza3ApOworCisJaWYgKG54dCA9PSBNQVhfTlVNTk9ERVMpCisJCW54dCA9IGZpcnN0X25vZGUo
bWFza3ApOwogCi0gICAgaWYgKG54dCA9PSBuYml0cykKLSAgICAgICAgbnh0ID0gX19maXJzdF9u
b2RlKG1hc2twLCBuYml0cyk7Ci0gICAgcmV0dXJuIG54dDsKKwlyZXR1cm4gbnh0OwogfQogCiAj
ZGVmaW5lIE5PREVfTUFTS19MQVNUX1dPUkQgQklUTUFQX0xBU1RfV09SRF9NQVNLKE1BWF9OVU1O
T0RFUykKQEAgLTMwNSw4ICsyNjgsOCBAQCBzdGF0aWMgaW5saW5lIGludCBfX2N5Y2xlX25vZGUo
aW50IG4sIGNvbnN0IG5vZGVtYXNrX3QgKm1hc2twLCBpbnQgbmJpdHMpCiBleHRlcm4gbm9kZW1h
c2tfdCBub2RlX29ubGluZV9tYXA7CiAKICNpZiBNQVhfTlVNTk9ERVMgPiAxCi0jZGVmaW5lIG51
bV9vbmxpbmVfbm9kZXMoKQlub2Rlc193ZWlnaHQobm9kZV9vbmxpbmVfbWFwKQotI2RlZmluZSBu
b2RlX29ubGluZShub2RlKQlub2RlX2lzc2V0KChub2RlKSwgbm9kZV9vbmxpbmVfbWFwKQorI2Rl
ZmluZSBudW1fb25saW5lX25vZGVzKCkJbm9kZXNfd2VpZ2h0KCZub2RlX29ubGluZV9tYXApCisj
ZGVmaW5lIG5vZGVfb25saW5lKG5vZGUpCW5vZGVfaXNzZXQobm9kZSwgJm5vZGVfb25saW5lX21h
cCkKICNlbHNlCiAjZGVmaW5lIG51bV9vbmxpbmVfbm9kZXMoKQkxCiAjZGVmaW5lIG5vZGVfb25s
aW5lKG5vZGUpCSgobm9kZSkgPT0gMCkKQEAgLTMyMSw5ICsyODQsOSBAQCBleHRlcm4gbm9kZW1h
c2tfdCBub2RlX29ubGluZV9tYXA7CiAJbm9kZTsJCQkJCVwKIH0pCiAKLSNkZWZpbmUgbm9kZV9z
ZXRfb25saW5lKG5vZGUpCSAgIHNldF9iaXQoKG5vZGUpLCBub2RlX29ubGluZV9tYXAuYml0cykK
LSNkZWZpbmUgbm9kZV9zZXRfb2ZmbGluZShub2RlKQkgICBjbGVhcl9iaXQoKG5vZGUpLCBub2Rl
X29ubGluZV9tYXAuYml0cykKKyNkZWZpbmUgbm9kZV9zZXRfb25saW5lKG5vZGUpCSAgIHNldF9i
aXQobm9kZSwgbm9kZV9vbmxpbmVfbWFwLmJpdHMpCisjZGVmaW5lIG5vZGVfc2V0X29mZmxpbmUo
bm9kZSkJICAgY2xlYXJfYml0KG5vZGUsIG5vZGVfb25saW5lX21hcC5iaXRzKQogCi0jZGVmaW5l
IGZvcl9lYWNoX29ubGluZV9ub2RlKG5vZGUpIGZvcl9lYWNoX25vZGVfbWFzaygobm9kZSksIG5v
ZGVfb25saW5lX21hcCkKKyNkZWZpbmUgZm9yX2VhY2hfb25saW5lX25vZGUobm9kZSkgZm9yX2Vh
Y2hfbm9kZV9tYXNrKG5vZGUsICZub2RlX29ubGluZV9tYXApCiAKICNlbmRpZiAvKiBfX0xJTlVY
X05PREVNQVNLX0ggKi8KLS0gCjIuMTEuMAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3Rz
LnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0
aW5mby94ZW4tZGV2ZWw=

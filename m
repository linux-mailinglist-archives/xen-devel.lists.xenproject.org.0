Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D2A1AF2A86
	for <lists+xen-devel@lfdr.de>; Thu,  7 Nov 2019 10:25:04 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iSdyc-0000cX-TK; Thu, 07 Nov 2019 09:21:14 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=bx+4=Y7=gmail.com=pdurrant@srs-us1.protection.inumbo.net>)
 id 1iSdyb-0000cS-0z
 for xen-devel@lists.xenproject.org; Thu, 07 Nov 2019 09:21:13 +0000
X-Inumbo-ID: f00f0d30-013f-11ea-b678-bc764e2007e4
Received: from mail-pg1-x543.google.com (unknown [2607:f8b0:4864:20::543])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id f00f0d30-013f-11ea-b678-bc764e2007e4;
 Thu, 07 Nov 2019 09:21:11 +0000 (UTC)
Received: by mail-pg1-x543.google.com with SMTP id z24so1717669pgu.4
 for <xen-devel@lists.xenproject.org>; Thu, 07 Nov 2019 01:21:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc; bh=zLLqjA6BG6W3vvjoYf2yS+FtCRgIGHeRkqV+vixKlQ0=;
 b=cFVbW7qIm327+beC4AeNH5xwcOhbctJu40dhMqNr8cnZUzcBxb1+ZyHlHQklJ4bbQH
 ueI/cK5rOb6g6bLWb5pHv3PWSajViKcL0nAbcCGr9dMwgluncxVL9kPV9JGtQI0EBy21
 F4g+kejqhZ0UJwXN/1VDxtny/pRSipKgR9xUWMSExdawpoUWv9gABzh9Y7FjkK40suWf
 5mgRCUWRBASp9pbOPoXn9uvDM46QBM3DZ1fU+1H7scvyLZQBzyULugDQqw9fx3xJ18SH
 vVT1+dVlnTmSjIi68iUVDfexWxIxieW6Z9IGGHdXtQI3Xq/jZ1C4wbbMCUuEavZeJyTH
 sV0Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=zLLqjA6BG6W3vvjoYf2yS+FtCRgIGHeRkqV+vixKlQ0=;
 b=iWZ4USkLSvYeRO2tYgFZYtSPtbL8Af+oHK8FYY2gn66yQHO21z/mEUU+tN3KaVH0mS
 a4DwaYhd3aHoD/JR4rwujFI2orc+AHd3wUm5TmuLRjvBFUHspaCyzkZn3eS9HuhcaZGX
 6Ka/33zKzacZWOf7Dgm7CZPIYgvFWraT6gfFt8qv4+aJztVt8RXJJOEOIhCpGDMAcIde
 1LznI0UMIJo4J5kEFTfNM7n06ILJey0ahz9nwWspMnPUEEokYaUVMCOdUCR3JXpCnk0A
 5sAYAdK4HQ6lP9pbcvSHd4UBi40eGnHWyOjNYnfmUhlNqMo4q25vvExXBOhW2/aAjciS
 DcxQ==
X-Gm-Message-State: APjAAAVI3WrdLDVRukknW89/GBJWdzejI3zCfSpyiRk1AYhTtTC0VNgb
 PY3zzDBgr3T6pDc5mMz7nRtStggMG9xS3GRPW/E=
X-Google-Smtp-Source: APXvYqyhFAwotHrRp61GRCuM2gZUlW2UDTIISUPR38p8yeJT/zM0tLdeZLFRQkT41nUIuVBSJEgbUhDn+EnoULBhkJw=
X-Received: by 2002:a17:90b:4386:: with SMTP id
 in6mr3666392pjb.33.1573118470136; 
 Thu, 07 Nov 2019 01:21:10 -0800 (PST)
MIME-Version: 1.0
References: <20191106022427.9088-1-julian.tuminaro@gmail.com>
In-Reply-To: <20191106022427.9088-1-julian.tuminaro@gmail.com>
From: Paul Durrant <pdurrant@gmail.com>
Date: Thu, 7 Nov 2019 09:20:59 +0000
Message-ID: <CACCGGhBp4gE4HEGQ4CHB2TRCO2u35b1vBB-ys4z8kB2HpFiD4w@mail.gmail.com>
To: Julian Tuminaro <julian.tuminaro@gmail.com>
Subject: Re: [Xen-devel] [PATCH 1/1] kdd.c: Add support for initial
 handshake in KD protocol for Win 7, 8 and 10 (64 bit)
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Wei Liu <wl@xen.org>, Ian Jackson <ian.jackson@eu.citrix.com>,
 Jenish Rakholiya <rjenish@cmu.edu>, tim@xen.org,
 Julian Tuminaro <jtuminar@andrew.cmu.edu>,
 xen-devel <xen-devel@lists.xenproject.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gV2VkLCA2IE5vdiAyMDE5IGF0IDAyOjI0LCBKdWxpYW4gVHVtaW5hcm8gPGp1bGlhbi50dW1p
bmFyb0BnbWFpbC5jb20+IHdyb3RlOgo+Cj4gRnJvbTogImp1bGlhbi50dW1pbmFyb0BnbWFpbC5j
b20iIDxqdWxpYW4udHVtaW5hcm9AZ21haWwuY29tPgo+Cj4KPiBDdXJyZW50IGltcGxlbWVudGF0
aW9uIG9mIGZpbmRfb3MgaXMgYmFzZWQgb24gdGhlIGhhcmQtY29kZWQgdmFsdWVzIGZvcgo+IGRp
ZmZlcmVudCBXaW5kb3dzIHZlcnNpb24uIEl0IHVzZXMgdGhlIHZhbHVlIGZvciBnZXQgdGhlIGFk
ZHJlc3MgdG8KPiBzdGFydCBsb29raW5nIGZvciBET1MgaGVhZGVyIGluIHRoZSBnaXZlbiBzcGVj
aWZpZWQgcmFuZ2UuIEhvd2V2ZXIsIHRoaXMKPiBpcyBub3Qgc2NhbGFibGUgdG8gYWxsIHZlcnNp
b24gb2YgV2luZG93cyBhcyBpdCB3aWxsIHJlcXVpcmUgdXMgdG8ga2VlcAo+IGFkZGluZyBuZXcg
ZW50cmllcyBhbmQgYWxzbyBkdWUgdG8gS0FTTFIsIGNoYW5jZXMgb2Ygbm90IGhpdHRpbmcgdGhl
IFBFCj4gaGVhZGVyIGlzIHNpZ25pZmljYW50LiBXZSBpbXBsZW1lbnQgYSB3YXkgZm9yIDY0LWJp
dCBzeXN0ZW1zIHRvIHVzZSBJRFQKPiBlbnRyeSB0byBnZXQgYSB2YWxpZCBleGNlcHRpb24vaW50
ZXJydXB0IGhhbmRsZXIgYW5kIHRoZW4gbW92ZSBiYWNrIGludG8KPiB0aGUgbWVtb3J5IHRvIGZp
bmQgdGhlIHZhbGlkIERPUyBoZWFkZXIuIFNpbmNlIElEVCBlbnRyaWVzIGFyZSBwcm90ZWN0ZWQK
PiBieSBQYXRjaEd1YXJkLCB3ZSB0aGluayBvdXIgYXNzdW1wdGlvbiB0aGF0IElEVCBlbnRyaWVz
IHdpbGwgbm90IGJlCj4gY29ycnVwdGVkIGlzIHZhbGlkIGZvciBvdXIgcHVycG9zZS4gT25jZSB3
ZSBoYXZlIHRoZSBpbWFnZSBiYXNlLCB3ZQo+IHNlYXJjaCBmb3IgdGhlIERCR0tEX0dFVF9WRVJT
SU9ONjQgc3RydWN0dXJlIHR5cGUgaW4gLmRhdGEgc2VjdGlvbiB0bwo+IGdldCBpbmZvcm1hdGlv
biByZXF1aXJlZCBmb3IgaGFuZHNoYWtlLgo+Cj4gQ3VycmVudGx5LCB0aGlzIGlzIGEgd29yayBp
biBwcm9ncmVzcyBmZWF0dXJlIGFuZCBjdXJyZW50IHBhdGNoIG9ubHkKPiBzdXBwb3J0cyB0aGUg
aGFuZHNoYWtlIGFuZCBtZW1vcnkgcmVhZC93cml0ZSBvbiA2NC1iaXQgc3lzdGVtcy4KPgo+IFNp
Z25lZC1vZmYtYnk6IEplbmlzaCBSYWtob2xpeWEgPHJqZW5pc2hAY211LmVkdT4KPiBTaWduZWQt
b2ZmLWJ5OiBKdWxpYW4gVHVtaW5hcm8gPGp0dW1pbmFyQGFuZHJldy5jbXUuZWR1PgoKSnVsaWFu
LAoKVGhhbmtzIGZvciB0aGUgcGF0Y2guIFRoaXMgd29yayBpcyBncmVhdCBwcm9ncmVzcyBmb3Ig
a2RkLiBDb21tZW50cwpiZWxvdy4uLiBNYWlubHkgc3R5bGUtcmVsYXRlZCBidXQgSSB0aGluayB0
aGVyZSdzIGFsc28gc29tZSBjbGVhbi11cApuZWVkZWQgYW5kIGEgZmV3IHR3ZWFrcy4KCj4gLS0t
Cj4gIHRvb2xzL2RlYnVnZ2VyL2tkZC9rZGQuYyB8IDM4OSArKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKy0KPiAgMSBmaWxlIGNoYW5nZWQsIDM4OCBpbnNlcnRpb25zKCspLCAx
IGRlbGV0aW9uKC0pCj4KPiBkaWZmIC0tZ2l0IGEvdG9vbHMvZGVidWdnZXIva2RkL2tkZC5jIGIv
dG9vbHMvZGVidWdnZXIva2RkL2tkZC5jCj4gaW5kZXggZmI4YzY0NTM1NS4uNDA3YjcwYTIxYyAx
MDA2NDQKPiAtLS0gYS90b29scy9kZWJ1Z2dlci9rZGQva2RkLmMKPiArKysgYi90b29scy9kZWJ1
Z2dlci9rZGQva2RkLmMKPiBAQCAtNTEsNiArNTEsOCBAQAo+Cj4gICNpbmNsdWRlICJrZGQuaCIK
Pgo+ICsvLyBUT0RPOiBtYWtlIGZpeCB0aGlzIHRvIGFjdHVhbGx5IHVzZSBhZGRyZXNzIGluc3Rl
YWQgb2Ygb2Zmc2V0Pwo+ICsvLyBUT0RPOiBNYXliZSBjbGVhbiBzb21ldGhpbmcgYXMgd2VsbD8K
ClRoZXNlIFRPRE9zIGFyZSBhIG5vdCByZWFsbHkgd2VsbCBlbm91Z2ggZGVzY3JpYmVkIHRvIGJl
IGNvbW1pdHRlZApJTU8uIEknbSB0b3RhbGx5IGZpbmUgd2l0aCBoYXZpbmcgVE9ETyBvciBGSVhN
RSBjb21tZW50cywgYnV0IHRoZXkKb3VnaHQgdG8gYmUgY2xlYXIgZW5vdWdoIGZvciBzb21lb25l
IGVsc2UgcGlja2luZyB1cCB0aGUgY29kZS4KCj4gIC8qIFdpbmRvd3MgdmVyc2lvbiBkZXRhaWxz
ICovCj4gIHR5cGVkZWYgc3RydWN0IHsKPiAgICAgIHVpbnQzMl90IGJ1aWxkOwo+IEBAIC02Miw2
ICs2NCw3IEBAIHR5cGVkZWYgc3RydWN0IHsKPiAgICAgIHVpbnQzMl90IHZlcnNpb247ICAgICAg
ICAgICAvKiArLT4gTnRCdWlsZE51bWJlciAqLwo+ICAgICAgdWludDMyX3QgbW9kdWxlczsgICAg
ICAgICAgIC8qICstPiBQc0xvYWRlZE1vZHVsZUxpc3QgKi8KPiAgICAgIHVpbnQzMl90IHByY2Jz
OyAgICAgICAgICAgICAvKiArLT4gS2lQcm9jZXNzb3JCbG9jayAqLwo+ICsgICAgdWludDMyX3Qg
a2RkbDsKCkNvbW1lbnQgZm9yIHRoaXMgZmllbGQgcGVyaGFwcz8KCj4gIH0ga2RkX29zOwo+Cj4g
IC8qIFN0YXRlIG9mIHRoZSBkZWJ1Z2dlciBzdHViICovCj4gQEAgLTg1LDYgKzg4LDEwNiBAQCB0
eXBlZGVmIHN0cnVjdCB7Cj4gICAgICBrZGRfb3Mgb3M7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgLyogT1Mtc3BlY2lmaWMgbWFnaWMgbnVtYmVycyAqLwo+ICB9IGtkZF9zdGF0ZTsK
Pgo+ICsvKioKPiArICogQGJyaWVmIFNpemUgb2YgcG9pbnRlciBvbiA2NCBtYWNoaW5lCj4gKyAq
Lwo+ICsjZGVmaW5lIFNJWkVfUFRSNjQgOAo+ICsKPiArLyoqCj4gKyAqIEBicmllZiBTaXplIG9m
IHBvaW50ZXIgb24gMzIgbWFjaGluZQo+ICsgKi8KPiArI2RlZmluZSBTSVpFX1BUUjMyIDQKPiAr
Cj4gKwo+ICsvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioKPiArICogUEUgYW5kIERPUyBIZWFkZXIgcmVs
YXRlZCBvZmZzZXRzCj4gKyAqLwo+ICsKPiArLyoqCj4gKyAqIEBicmllZiBPZmZzZXQgaW4gRE9T
IGhlYWRlciB0byBsb29rIGZvciBQRSBoZWFkZXIKPiArICovCj4gKyNkZWZpbmUgRE9TX0hEUl9Q
RV9PRkYgMHgzYwo+ICsKPiArLyoqCj4gKyAqIEBicmllZiBTaXplIG9mIFBFIGhlYWRlciBvZmZz
ZXQgZmllbGQgaW4gRE9TIGhlYWRlcgo+ICsgKi8KPiArI2RlZmluZSBET1NfSERSX1BFX1NaIDQK
PiArCj4gKy8qKgo+ICsgKiBAYnJpZWYgT2Zmc2V0IG9mIG51bWJlciBvZiBzZWN0aW9ucyBmaWVs
ZCBpbiBQRSBoZWFkZXIKPiArICovCj4gKyNkZWZpbmUgUEVfTlVNX1NFQ1RJT05fT0ZGIDB4Ngo+
ICsKPiArLyoqCj4gKyAqIEBicmllZiBTaXplIG9mIG51bWJlciBvZiBzZWN0aW9ucyBmaWVsZCBp
biBQRSBoZWFkZXIKPiArICovCj4gKyNkZWZpbmUgUEVfTlVNX1NFQ1RJT05fU1ogMgo+ICsKPiAr
LyoqCj4gKyAqIEBicmllZiBPZmZzZXQgb2Ygb3B0aW9uYWwgaGVhZGVyIHNpemUgZmllbGQgaW4g
UEUgaGVhZGVyCj4gKyAqLwo+ICsjZGVmaW5lIFBFX09QVF9IRFJfU1pfT0ZGIDB4MTQKPiArCj4g
Ky8qKgo+ICsgKiBAYnJpZWYgU2l6ZSBvZiBvcHRpb25hbCBoZWFkZXIgc2l6ZSBmaWVsZCBpbiBQ
RSBoZWFkZXIKPiArICovCj4gKyNkZWZpbmUgUEVfT1BUX0hEUl9TWl9TWiAyCj4gKwo+ICsvKioK
PiArICogQGJyaWVmIFNpemUgb2YgUEUgaGVhZGVyCj4gKyAqLwo+ICsjZGVmaW5lIFBFX0hEUl9T
WiAweDE4Cj4gKwo+ICsvKioKPiArICogQGJyaWVmIFNpemUgb2Ygc2VjdGlvbiBoZWFkZXIgZW50
cmllcyBpbiBQRQo+ICsgKi8KPiArI2RlZmluZSBQRV9TRUNUX0VOVF9TWiAweDI4Cj4gKwo+ICsv
KioKPiArICogQGJyaWVmIE9mZnNldCBvZiBuYW1lIGZpZWxkIGluIHNlY3Rpb24gaGVhZGVyIGVu
dHJ5Cj4gKyAqLwo+ICsjZGVmaW5lIFBFX1NFQ1RfTkFNRV9PRkYgMAo+ICsKPiArLyoqCj4gKyAq
IEBicmllZiBTaXplIG9mIG5hbWUgZmllbGQgaW4gc2VjdGlvbiBoZWFkZXIgZW50cnkKPiArICov
Cj4gKyNkZWZpbmUgUEVfU0VDVF9OQU1FX1NaIDB4OAo+ICsKPiArLyoqCj4gKyAqIEBicmllZiBP
ZmZzZXQgb2YgdmlydHVhbCBhZGRyZXNzIChSVkEpIGZpZWxkIGluIHNlY3Rpb24gaGVhZGVyIGVu
dHJ5Cj4gKyAqLwo+ICsjZGVmaW5lIFBFX1NFQ1RfUlZBX09GRiAweGMKPiArCj4gKy8qKgo+ICsg
KiBAYnJpZWYgT2Zmc2V0IG9mIHZpcnR1YWwgc2l6ZSBmaWVsZCBpbiBzZWN0aW9uIGhlYWRlciBl
bnRyeQo+ICsgKi8KPiArI2RlZmluZSBQRV9TRUNUX1ZTSVpFX09GRiAweDgKPiArCj4gKy8qKgo+
ICsgKiBAYnJpZWYgU2l6ZSBvZiBEQkdLRF9HRVRfVkVSU0lPTjY0IHN0cnVjdAo+ICsgKi8KPiAr
I2RlZmluZSBEQkdLRF9HRVRfVkVSU0lPTjY0X1NaIDB4MjgKPiArCj4gKy8qKgo+ICsgKiBAYnJp
ZWYgT2Zmc2V0IG9mIEtFUk5fQkFTRSBpbiBEQkdLRF9HRVRfVkVSU0lPTjY0IHN0cnVjdAo+ICsg
Ki8KPiArI2RlZmluZSBEQkdLRF9LRVJOX0JBU0VfT0ZGIDB4MTAKPiArCj4gKy8qKgo+ICsgKiBA
YnJpZWYgT2Zmc2V0IG9mIFBzTG9hZGVkTW9kdWxlc0xpc3QgaW4gREJHS0RfR0VUX1ZFUlNJT042
NCBzdHJ1Y3QKPiArICovCj4gKyNkZWZpbmUgREJHS0RfTU9EX0xJU1RfT0ZGIDB4MTgKPiArCj4g
Ky8qKgo+ICsgKiBAYnJpZWYgT2Zmc2V0IG9mIERlYnVnZ2VyRGF0YUxpc3QgaW4gREJHS0RfR0VU
X1ZFUlNJT042NCBzdHJ1Y3QKPiArICovCj4gKyNkZWZpbmUgREJHS0RfS0RETF9PRkYgMHgyMAo+
ICsKPiArLyoqCj4gKyAqIEBicmllZiBPZmZzZXQgb2YgRGVidWdnZXJEYXRhTGlzdCBpbiBEQkdL
RF9HRVRfVkVSU0lPTjY0IHN0cnVjdAo+ICsgKi8KPiArI2RlZmluZSBEQkdLRF9NSU5PUl9PRkYg
MHgyCj4gKwo+ICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKPiAgICogIFV0aWxpdHkgZnVuY3Rpb25z
Cj4gICAqLwo+IEBAIC0zOTAsNiArNDkzLDI4NCBAQCBzdGF0aWMgdm9pZCBmaW5kX29zKGtkZF9z
dGF0ZSAqcykKPiAgICAgIHMtPm9zID0gdW5rbm93bl9vczsKPiAgfQo+Cj4gKyNpZiAwCj4gKy8q
Kgo+ICsgKiBAYnJpZWYgVGVtcG9yYXJ5IGZ1bmN0aW9uIGZvciBwcmludGluZyBtZW1vcnkgZHVt
cCB3aGlsZSBkZWJ1Z2dpbmcKPiArICogRHVtcHMgaW4gdGhlIGZvcm1hdCBvZiBRV09SRCB0eXBl
Cj4gKyAqCj4gKyAqIEBwYXJhbSBzIFBvaW50ZXIgdG8gdGhlIGtkZF9zdGF0ZSBzdHJ1Y3R1cmUK
PiArICogQHBhcmFtIGFkZHIgQWRkcmVzcyB0byBzdGFydCBkdW1waW5nIG1lbW9yeSBmcm9tCj4g
KyAqIEBwYXJhbSBzaXplIE51bWJlciBvZiBieXRlcyB0byBwcmludCAoYXV0b21hdGljYWxseSBh
bGlnbmVkIHRvIGhpZ2hlcgo+ICsgKiBtdWx0aXBsZSBvZiA4IGJ5dGVzCj4gKyAqCj4gKyAqIEBu
b3RlIFRPRE86IFJlbW92ZSB0aGlzIGJlZm9yZSBwdXNoaW5nIHRvIG1hc3RlcgoKSSBndWVzcyB0
aGlzIG1lYW5zIHlvdSB3YW50IHRvIGxlYXZlIHRoaXMgb3V0IG9mIHRoZSBhY3R1YWwgY29tbWl0
IGZvciBub3c/Cgo+ICsgKiBAbm90ZSBUT0RPOiBNYXliZSBhZGQgbGV2ZWwgb2YgbG9nZ2luZyB0
byBrZGQgKHVzaW5nIC12IG9wdGlvbikgLSBUaGUKPiArICogaWRlYSBvZiB1c2luZyBwcmludGYg
aW5zdGVhZCBvZiBLRERfTE9HIHdhcyB0byBub3QgcHJpbnQgYWxsIG90aGVyIHVud2FudGVkCj4g
KyAqIGxvZ2dpbmcgb3V0cHV0Cj4gKyAqLwo+ICtzdGF0aWMgdm9pZCBteV9tZW1kdW1wKGtkZF9z
dGF0ZSAqcywgdWludDY0X3QgYWRkciwgaW50IHNpemUpCj4gK3sKPiArICAgIGludCByZXQ7Cj4g
KyAgICB1aW50NjRfdCBidWY7Cj4gKwo+ICsgICAgLy8gd2UgZG9uJ3QgaGFuZGxlIG1pcy1hbGln
bmVkIGFkZHJlc3NlcwoKR2VuZXJhbCBzdHlsZSBpcyBub3QgdG8gdXNlIC8vIGNvbW1lbnRzLCBi
dXQgc3RpY2sgdG8gLyogKi8uCgo+ICsgICAgaWYgKGFkZHIgJiA3KSB7Cj4gKyAgICAgICAgLy8g
WFhYOiBUT0RPOiBkb24ndCBkbyB0aGlzCj4gKyAgICAgICAgcmV0dXJuOwo+ICsgICAgfQoKTm8g
cmVxdWlyZW1lbnQgZm9yIGJyYWNlcyBhcm91bmQgc2luZ2xlIGxpbmUgY2xhdXNlcy4KCj4gKwo+
ICsgICAgLy8gZHVtcCBtZW1vcnkgMSBRV09SRCBhdCBhIHRpbWUKPiArICAgIC8vIGZvcm1hdDog
PGFkZHJlc3M+IFtvZmZzZXQgZnJvbSBzdGFydF06IGR1bXAxIGR1bXAyCj4gKyAgICBmb3IgKGlu
dCBpID0gMDsgaSA8IHNpemU7IGkgKz0gMTYpIHsKPiArCj4gKyAgICAgICAgLy8gcmVhZCA4IGJ5
dGVzIC0gb24gZmFpbHVyZSwgYnJlYWsKPiArICAgICAgICByZXQgPSBrZGRfcmVhZF92aXJ0dWFs
KHMsIHMtPmNwdWlkLCBhZGRyICsgaSwgOCwgJmJ1Zik7Cj4gKyAgICAgICAgaWYgKHJldCAhPSA4
KSB7Cj4gKyAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgIH0KPiArCj4gKyAgICAgICAgLy8g
cHJpbnQgZmlyc3QgcGFydAo+ICsgICAgICAgIHByaW50ZigiMHglcCBbKzB4JTAzeF06ICVwICIs
ICh2b2lkICopKGFkZHIgKyBpKSwgaSwgKHZvaWQgKilidWYpOwo+ICsKPiArICAgICAgICAvLyBy
ZWFkIG5leHQgOCBieXRlcyBhbmQgcHJpbnQgaXQKPiArICAgICAgICByZXQgPSBrZGRfcmVhZF92
aXJ0dWFsKHMsIHMtPmNwdWlkLCBhZGRyICsgaSArIDgsIDgsICZidWYpOwo+ICsgICAgICAgIGlm
IChyZXQgIT0gOCkgewo+ICsgICAgICAgICAgICBicmVhazsKPiArICAgICAgICB9Cj4gKyAgICAg
ICAgcHJpbnRmKCIlcFxuIiwgKHZvaWQgKilidWYpOwo+ICsgICAgfQo+ICsgICAgcHJpbnRmKCJc
biIpOwo+ICt9Cj4gKyNlbmRpZgo+ICsKPiArLyoqCj4gKyAqIEBicmllZiBQYXJzZSB0aGUgbWVt
b3J5IGF0IFxhIGZpbGViYXNlIGFzIGEgdmFsaWQgRE9TIGhlYWRlciBhbmQgZ2V0IHZpcnR1YWwK
PiArICogYWRkcmVzcyBvZmZzZXQgYW5kIHNpemUgZm9yIGFueSBnaXZlbiBzZWN0aW9uIG5hbWUg
KGlmIGl0IGV4aXN0cykKPiArICoKPiArICogQHBhcmFtIHMgUG9pbnRlciB0byB0aGUga2RkX3N0
YXRlIHN0cnVjdHVyZQo+ICsgKiBAcGFyYW0gZmlsZWJhc2UgQmFzZSBhZGRyZXNzIG9mIHRoZSBm
aWxlIHN0cnVjdHVyZQo+ICsgKiBAcGFyYW0gc2VjdG5hbWUgUG9pbnRlciB0byB0aGUgc2VjdGlv
biBuYW1lIGMtc3RyaW5nIHRvIGxvb2sgZm9yCj4gKyAqIEBwYXJhbSB2YWRkciBQb2ludGVyIHRv
IHdyaXRlIHRoZSB2aXJ0dWFsIGFkZHJlc3Mgb2Ygc2VjdGlvbiBzdGFydCB0bwo+ICsgKiAoaWYg
Zm91bmQpCj4gKyAqIEBwYXJhbSB2aXN6ZSBQb2ludGVyIHRvIHdyaXRlIHRoZSBzZWN0aW9uIHNp
emUgdG8gKGlmIGZvdW5kKQo+ICsgKgo+ICsgKiBAcmV0dXJuIC0xIG9uIGZhaWx1cmUgdG8gZmlu
ZCB0aGUgc2VjdGlvbiBuYW1lCj4gKyAqIEByZXR1cm4gMCBvbiBzdWNjZXNzCj4gKyAqLwo+ICtz
dGF0aWMgaW50IGdldF9wZTY0X3NlY3Rpb25zKGtkZF9zdGF0ZSAqcywgdWludDY0X3QgZmlsZWJh
c2UsIGNoYXIgKnNlY3RuYW1lLAo+ICsgICAgICAgIHVpbnQ2NF90ICp2YWRkciwgdWludDMyX3Qg
KnZzaXplKQo+ICt7Cj4gKyAgICB1aW50OF90IGJ1ZlsweDMwXTsKPiArICAgIHVpbnQ2NF90IHBl
X2hkcjsKPiArICAgIHVpbnQ2NF90IHNlY3Rfc3RhcnQ7Cj4gKyAgICB1aW50MTZfdCBudW1fc2Vj
dGlvbnM7Cj4gKyAgICBpbnQgcmV0Owo+ICsKPiArICAgIHJldCA9IC0xOwoKWW91IGNvdWxkIGFz
c2lnbiBkdXJpbmcgZGVjbGFyYXRpb24uCgo+ICsKPiArICAgIGlmICghcy0+b3MudzY0KSB7Cj4g
KyAgICAgICAgcmV0dXJuIHJldDsKCnJldHVybiAtMSwgZm9yIGNvbnNpc3RlbmN5LCBwZXJoYXBz
PwoKPiArICAgIH0KPiArCj4gKyAgICAvLyByZWFkIFBFIGhlYWRlciBvZmZzZXQKPiArICAgIGlm
IChrZGRfcmVhZF92aXJ0dWFsKHMsIHMtPmNwdWlkLCBmaWxlYmFzZSArIERPU19IRFJfUEVfT0ZG
LCBET1NfSERSX1BFX1NaLAo+ICsgICAgICAgICAgICAgICAgYnVmKSAhPSBET1NfSERSX1BFX1Na
KSB7Cj4gKyAgICAgICAgcmV0dXJuIC0xOwo+ICsgICAgfQo+ICsKPiArICAgIHBlX2hkciA9IGZp
bGViYXNlICsgKih1aW50MzJfdCAqKWJ1ZjsKPiArCj4gKyAgICAvLyByZWFkIG51bWJlciBvZiBz
ZWN0aW9ucwo+ICsgICAgaWYgKGtkZF9yZWFkX3ZpcnR1YWwocywgcy0+Y3B1aWQsIHBlX2hkciAr
IFBFX05VTV9TRUNUSU9OX09GRiwKPiArICAgICAgICAgICAgICAgIFBFX05VTV9TRUNUSU9OX1Na
LCAmYnVmKSAhPSBQRV9OVU1fU0VDVElPTl9TWikgewo+ICsgICAgICAgIHJldHVybiAtMTsKPiAr
ICAgIH0KPiArICAgIG51bV9zZWN0aW9ucyA9ICoodWludDE2X3QgKilidWY7Cj4gKwo+ICsgICAg
Ly8gcmVhZCBzaXplIG9mIG9wdGlvbmFsIGhlYWRlcgo+ICsgICAgaWYgKGtkZF9yZWFkX3ZpcnR1
YWwocywgcy0+Y3B1aWQsIHBlX2hkciArIFBFX09QVF9IRFJfU1pfT0ZGLAo+ICsgICAgICAgICAg
ICAgICAgUEVfT1BUX0hEUl9TWl9TWiwgJmJ1ZikgIT0gUEVfT1BUX0hEUl9TWl9TWikgewo+ICsg
ICAgICAgIHJldHVybiAtMTsKPiArICAgIH0KPiArCj4gKyAgICAvLyAweDE4IGlzIHRoZSBzaXpl
IG9mIFBFIGhlYWRlcgo+ICsgICAgc2VjdF9zdGFydCA9IHBlX2hkciArIFBFX0hEUl9TWiArICoo
dWludDE2X3QgKilidWY7Cj4gKwo+ICsgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1fc2VjdGlv
bnM7IGkrKykgewo+ICsgICAgICAgIGlmIChrZGRfcmVhZF92aXJ0dWFsKHMsIHMtPmNwdWlkLCBz
ZWN0X3N0YXJ0ICsgKGkgKiBQRV9TRUNUX0VOVF9TWiksCj4gKyAgICAgICAgICAgICAgICAgICAg
UEVfU0VDVF9FTlRfU1osICZidWYpICE9IFBFX1NFQ1RfRU5UX1NaKSB7Cj4gKyAgICAgICAgICAg
IHJldHVybiAtMTsKPiArICAgICAgICB9Cj4gKwo+ICsgICAgICAgIGlmICghc3RybmNtcChzZWN0
bmFtZSwgKGNoYXIgKikoYnVmICsgUEVfU0VDVF9OQU1FX09GRiksCj4gKyAgICAgICAgICAgICAg
ICAgICAgUEVfU0VDVF9OQU1FX1NaKSkgewo+ICsgICAgICAgICAgICAqdmFkZHIgPSBmaWxlYmFz
ZSArICoodWludDMyX3QgKikoYnVmICsgUEVfU0VDVF9SVkFfT0ZGKTsKPiArICAgICAgICAgICAg
KnZzaXplID0gKih1aW50MzJfdCAqKShidWYgKyBQRV9TRUNUX1ZTSVpFX09GRik7Cj4gKyAgICAg
ICAgICAgIHJldCA9IDA7Cj4gKyAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgIH0KPiArICAg
IH0KPiArCj4gKyAgICByZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICsvKioKPiArICogQGJyaWVmIEdl
dCB0aGUgT1MgaW5mb3JtYXRpb24gbGlrZSBiYXNlIGFkZHJlc3MsIG1pbm9yIHZlcnNpb24sCj4g
KyAqIFBzTG9hZGVkTW9kdWxlTGlzdCBhbmQgRGVidWdnZXJEYXRhTGlzdCAoYmFzaWNhbGx5IHRo
ZSBmaWVsZHMgb2YKPiArICogREJHS0RfR0VUX1ZFUlNJT042NCBzdHJ1dHVyZSByZXF1aXJlZCB0
byBkbyBoYW5kc2hha2U/KS4KPiArICoKPiArICogVGhpcyBpcyBkb25lIGJ5IHJlYWRpbmcgdGhl
IElEVCBlbnRyeSBmb3IgZGl2aWRlLWJ5LXplcm8gZXhjZXB0aW9uIGFuZAo+ICsgKiBzZWFyY2hp
bmcgYmFjayBpbnRvIHRoZSBtZW1vcnkgZm9yIERPUyBoZWFkZXIgKHdoaWNoIGlzIG91ciBrZXJu
ZWwgYmFzZSkuCj4gKyAqIE9uY2Ugd2UgaGF2ZSB0aGUga2VybmVsIGJhc2UsIHdlIHBhcnNlIHRo
ZSBQRSBoZWFkZXIgYW5kIGxvb2sgZm9yIGtlcm5lbAo+ICsgKiBiYXNlIGFkZHJlc3MgaW4gdGhl
IC5kYXRhIHNlY3Rpb24uIE9uY2Ugd2UgaGF2ZSBwb3NzaWJsZSB2YWx1ZXMsIHdlIGxvb2sgZm9y
Cj4gKyAqIERCR0tEX0dFVF9WRVJTSU9ONjQgYmxvY2sgYnkgdXNpbmcgZm9sbG93aW5nIGhldXJp
c3RpY3Mgb24gdGhlIGFkZHJlc3Mgd2hpY2gKPiArICogaGFzIHRoZSBrZXJuZWwgYmFzZToKPiAr
ICoKPiArICogIC0gYXQgYWRkcmVzcyBbLTB4MTBdLCBpdCBzaG91bGQgaGF2ZSAweGYgYXMgdGhl
IE1ham9yVmVyc2lvbgo+ICsgKiAgLSBhdCBhZGRyZXNzIFsrMHg4XSwgaXQgc2hvdWxkIGhhdmUg
YSB2YWxpZCBrZXJuZWwgbWVtb3J5IGFkZHJlc3MgcG9pbnRpbmcKPiArICogIGluIC5kYXRhCj4g
KyAqICAtIGF0IGFkZHJlc3MgWysweDEwXSwgaXQgc2hvdWxkIGhhdmUgYSB2YWxpZCBrZXJuZWwg
bWVtb3J5IGFkZHJlc3MgcG9pbnRpbmcKPiArICogIGluIC5kYXRhCj4gKyAqCj4gKyAqIEBwYXJh
bSBzIFBvaW50ZXIgdG8gdGhlIGtkZCBzdGF0ZQo+ICsgKi8KPiArc3RhdGljIHZvaWQgZ2V0X29z
X2luZm9fNjQoa2RkX3N0YXRlICpzKQo+ICt7Cj4gKyAgICBrZGRfY3RybCBjdHJsOwo+ICsgICAg
aW50IHJldDsKPiArICAgIHVpbnQ2NF90IGJ1ZjsKPiArICAgIHVpbnQ2NF90IGlkdDBfYWRkcjsK
PiArICAgIHVpbnQ2NF90IGJhc2U7Cj4gKyAgICB1aW50NjRfdCBjYWRkcjsKPiArICAgIHVpbnQ2
NF90IGRhdGFfYmFzZTsKPiArICAgIHVpbnQzMl90IGRhdGFfc2l6ZTsKPiArICAgIHVpbnQ2NF90
IG1vZHB0cjsKPiArICAgIHVpbnQ2NF90IGtkZGw7Cj4gKyAgICB1aW50MTZfdCBtaW5vcjsKPiAr
ICAgIHVpbnQ4X3QgZGJna2RfZ2V0X3ZlcnNpb242NFsweDI4XTsKPiArCj4gKyAgICAvKiBUT0RP
OiByaWdodCBub3csIHdlIGFyZSBmb3JjaW5nIHRoaXMgdG8gMSAoYXMgd2Ugb25seSBzdXBwb3J0
IDY0IGJpdAo+ICsgICAgICogc3lzdGVtLCBob3dldmVyLCB3ZSBzaG91bGQgdXNlIGtkZF9zdGF0
ZSBvciBodm0gY2FsbHMgdG8gY2hlY2sgaWYgd2UgYXJlCj4gKyAgICAgKiBpbiA2NC1iaXQKPiAr
ICAgICAqLwo+ICsgICAgcy0+b3MudzY0ID0gMTsKPiArCj4gKyAgICAvLyBpZiB3ZSBhcmUgbm8g
aW4gNjQtYml0IG1vZGUsIGZhaWwKPiArICAgIGlmICghcy0+b3MudzY0KSB7Cj4gKyAgICAgICAg
Z290byBmYWlsOwo+ICsgICAgfQo+ICsKPiArICAgIC8vIGdldCBjb250cm9sIHJlZ2lzdGVycyBm
b3Igb3VyIG9zCj4gKyAgICByZXQgPSBrZGRfZ2V0X2N0cmwocy0+Z3Vlc3QsIHMtPmNwdWlkLCAm
Y3RybCwgcy0+b3MudzY0KTsKPiArICAgIGlmIChyZXQpIHsKPiArICAgICAgICBnb3RvIGZhaWw7
Cj4gKyAgICB9Cj4gKwo+ICsgICAgLy8gcmVhZCB0aGUgZGl2LWJ5LXplcm8gaGFuZGxlciBmdW5j
dGlvbiBhZGRyZXNzCj4gKyAgICBrZGRfcmVhZF92aXJ0dWFsKHMsIHMtPmNwdWlkLCBjdHJsLmM2
NC5pZHRfYmFzZSArIDgsIDgsICZidWYpOwo+ICsgICAgaWR0MF9hZGRyID0gKCh1aW50NjRfdCli
dWYgPDwgMzIpICYgMHhmZmZmZmZmZjAwMDAwMDAwOwo+ICsKPiArICAgIGtkZF9yZWFkX3ZpcnR1
YWwocywgcy0+Y3B1aWQsIGN0cmwuYzY0LmlkdF9iYXNlLCA4LCAmYnVmKTsKPiArICAgIGlkdDBf
YWRkciB8PSAoKGJ1ZiA+PiAzMikgJiAweGZmZmYwMDAwKTsKPiArICAgIGlkdDBfYWRkciB8PSAo
YnVmICYgMHhmZmZmKTsKPiArCj4gKyAgICBLRERfTE9HKHMsICJpZHQwIGFkZHI6ICVwXG4iLCAo
dm9pZCAqKWlkdDBfYWRkcik7Cj4gKyAgICBwcmludGYoImlkdDAgYWRkcjogJXBcbiIsICh2b2lk
ICopaWR0MF9hZGRyKTsKPiArCj4gKyAgICAvLyBnZXQgdGhlIHBhZ2Ugc3RhcnQgYW5kIGxvb2sg
Zm9yICJNWiIgZmlsZSBoZWFkZXIKPiArCj4gKyAgICBiYXNlID0gaWR0MF9hZGRyICYgfihQQUdF
X1NJWkUgLSAxKTsKPiArICAgIC8vIHByaW50ZigiJXBcbiIsICh2b2lkICopYmFzZSk7Cj4gKwo+
ICsgICAgd2hpbGUgKDEpIHsKPiArICAgICAgICB1aW50MTZfdCB2YWw7Cj4gKyAgICAgICAgaWYg
KGtkZF9yZWFkX3ZpcnR1YWwocywgcy0+Y3B1aWQsIGJhc2UsIDIsICZ2YWwpICE9IDIpIHsKPiAr
ICAgICAgICAgICAgLy8ganVzdCBtb3ZlIGdvaW5nIGJhY2s/PyB0aGlzIGlzIGJhZCB0aG91Z2gK
PiArICAgICAgICAgICAgcHJpbnRmKCJyYW4gaW50byB1bm1hcHBlZCByZWdpb24gd2l0aG91dCBm
aW5kaW5nIFBFIGhlYWRlclxuIik7CgpCYWlsIG91dCBvZiB0aGUgbG9vcCBoZXJlLCBvciBjb250
aW51ZT8gQ2hlY2tpbmcgdmFsIGFmdGVyIGEgZmFpbHVyZQpkb2Vzbid0IHNlZW0gcmlnaHQuCgo+
ICsgICAgICAgIH0KPiArCj4gKyAgICAgICAgaWYgKHZhbCA9PSAweDVhNGQpIHsgLy8gTVoKClBl
cmhhcHMgI2RlZmluZSB0aGlzIHZhbHVlLgoKPiArICAgICAgICAgICAgLy8gcHJpbnRmKCJtYXli
ZSBzdWNjZXNzXG4iKTsKPiArICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICAgfQo+ICsKPiAr
ICAgICAgICBiYXNlIC09IFBBR0VfU0laRTsKPiArICAgIH0KPiArCj4gKyAgICBLRERfTE9HKHMs
ICJiYXNlOiAlcFxuIiwgKHZvaWQgKiliYXNlKTsKPiArCj4gKyAgICAvLyBmb3VuZCB0aGUgZGF0
YSBzZWN0aW9uIHN0YXJ0Cj4gKyAgICBpZiAoZ2V0X3BlNjRfc2VjdGlvbnMocywgYmFzZSwgIi5k
YXRhIiwgJmRhdGFfYmFzZSwgJmRhdGFfc2l6ZSkpIHsKPiArICAgICAgICBnb3RvIGZhaWw7Cj4g
KyAgICB9Cj4gKwo+ICsgICAgLy8gbG9vayBmb3IgYWRkcmVzc2VzIHdoaWNoIGhhcyBrZXJuZWwg
YmFzZSB3cml0dGVuIGludG8gaXQKPiArICAgIGNhZGRyID0gZGF0YV9iYXNlOwo+ICsKPiArICAg
IG1vZHB0ciA9IDA7Cj4gKyAgICBrZGRsID0gMDsKPiArICAgIG1pbm9yID0gMDsKPiArCj4gKyAg
ICB3aGlsZSAoY2FkZHIgPCBkYXRhX2Jhc2UgKyBkYXRhX3NpemUpIHsKPiArICAgICAgICBpZiAo
a2RkX3JlYWRfdmlydHVhbChzLCBzLT5jcHVpZCwgY2FkZHIsIFNJWkVfUFRSNjQsICZidWYpICE9
Cj4gKyAgICAgICAgICAgICAgICBTSVpFX1BUUjY0KSB7Cj4gKyAgICAgICAgICAgIC8vIHJlYWNo
ZWQgZW5kIGFuZCBmb3VuZCBub3RoaW5nCj4gKyAgICAgICAgICAgIGdvdG8gZmFpbDsKPiArICAg
ICAgICB9Cj4gKwo+ICsgICAgICAgIC8vIGlmIHdlIGZvdW5kIGJhc2UgaW4gdGhlIG1lbW9yeSBh
ZGRyZXNzZXMKPiArICAgICAgICBpZiAoYnVmID09IGJhc2UpIHsKPiArICAgICAgICAgICAgLy8g
cmVhZCB0aGUgREJHS0RfR0VUX1ZFUlNJT042NCBzdHJ1Y3QKPiArICAgICAgICAgICAgaWYgKGtk
ZF9yZWFkX3ZpcnR1YWwocywgcy0+Y3B1aWQsIGNhZGRyIC0gREJHS0RfS0VSTl9CQVNFX09GRiwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgREJHS0RfR0VUX1ZFUlNJT042NF9TWiwgZGJna2Rf
Z2V0X3ZlcnNpb242NCkgPT0KPiArICAgICAgICAgICAgICAgICAgICBEQkdLRF9HRVRfVkVSU0lP
TjY0X1NaKSB7Cj4gKyAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiBtYWpvciB2ZXJzaW9uIGlz
IDB4Zgo+ICsgICAgICAgICAgICAgICAgaWYgKGRiZ2tkX2dldF92ZXJzaW9uNjRbMF0gPT0gJ1x4
MGYnKSB7Cj4gKwo+ICsgICAgICAgICAgICAgICAgICAgIC8vIHJlYWQgbWlub3IgdmVyc2lvbiwg
UHNMb2FkZWRNb2R1bGVMaXN0IHBvaW50ZXIgYW5kCj4gKyAgICAgICAgICAgICAgICAgICAgLy8g
RGVidWdnZXJEYXRhTGlzdAo+ICsgICAgICAgICAgICAgICAgICAgIG1vZHB0ciA9Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICoodWludDY0X3QgKikoZGJna2RfZ2V0X3ZlcnNpb242NCArIERC
R0tEX01PRF9MSVNUX09GRik7Cj4gKyAgICAgICAgICAgICAgICAgICAga2RkbCA9ICoodWludDY0
X3QgKikoZGJna2RfZ2V0X3ZlcnNpb242NCArIERCR0tEX0tERExfT0ZGKTsKPiArICAgICAgICAg
ICAgICAgICAgICBtaW5vciA9Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICoodWludDE2X3Qg
KikoZGJna2RfZ2V0X3ZlcnNpb242NCArIERCR0tEX01JTk9SX09GRik7Cj4gKwo+ICsgICAgICAg
ICAgICAgICAgICAgIC8vIGRvIGhldXJpc3RpYyBjaGVjawo+ICsgICAgICAgICAgICAgICAgICAg
IGlmIChtb2RwdHIgJiYga2RkbCAmJiBtb2RwdHIgIT0ga2RkbCAmJiBrZGRsICE9IGJhc2UgJiYK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UgIT0gbW9kcHRyICYmIG1vZHB0ciA+
PSBkYXRhX2Jhc2UgJiYKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHB0ciA8IChk
YXRhX2Jhc2UgKyBkYXRhX3NpemUpICYmCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBr
ZGRsID49IGRhdGFfYmFzZSAmJgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAga2RkbCA8
IChkYXRhX2Jhc2UgKyBkYXRhX3NpemUpKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgIC8v
IG15X21lbWR1bXAocywgY2FkZHIgLSAweDEwLCAweDMwKTsKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7Cj4gKyAgICAgICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAg
ICAgIH0KPiArICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICB9Cj4gKwo+ICsgICAgICAgIGNh
ZGRyICs9IHNpemVvZih2b2lkICopOwo+ICsgICAgfQo+ICsKPiArICAgIC8vIFRPRE86IHVzZSBL
RERfTE9HPwoKTG9va3MgbGlrZSB0aGlzIHNob3VsZCBiZSBmaXhlZC4KCj4gKyAgICBwcmludGYo
ImJhc2U6ICVwXG4iLCAodm9pZCAqKWJhc2UpOwo+ICsgICAgcHJpbnRmKCJtb2R1bGVzIGxpc3Q6
ICVwXG4iLCAodm9pZCAqKW1vZHB0cik7Cj4gKyAgICBwcmludGYoImtkZGw6ICVwXG4iLCAodm9p
ZCAqKWtkZGwpOwo+ICsgICAgcHJpbnRmKCJtaW5vciB2ZXJzaW9uOiAweCVoeFxuIiwgbWlub3Ip
Owo+ICsKPiArICAgIHMtPm9zLmJhc2UgPSBiYXNlOwo+ICsgICAgcy0+b3MubW9kdWxlcyA9IG1v
ZHB0ciAtIGJhc2U7Cj4gKyAgICBzLT5vcy5rZGRsID0ga2RkbCAtIGJhc2U7Cj4gKyAgICBzLT5v
cy5idWlsZCA9ICh1aW50MzJfdCkgbWlub3I7Cj4gKyAgICByZXR1cm47Cj4gKwo+ICtmYWlsOgo+
ICsgICAgLy8gWFhYOiBUT0RPOiBoYW5kbGUgZmFpbHVyZSBjYXNlCgpoYW5kbGUgaW4gd2hhdCB3
YXk/Cgo+ICsgICAgcy0+b3MgPSB1bmtub3duX29zOwoKTm8gbmVlZCBmb3IgYSByZXR1cm4gaGVy
ZS4KCj4gKyAgICByZXR1cm47Cj4gK30KPiArCj4KPiAgLyoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCj4g
ICAqICBIb3cgdG8gc2VuZCBwYWNrZXRzIGFuZCBhY2tzLgo+IEBAIC01MzQsNiArOTE1LDEyIEBA
IHN0YXRpYyB2b2lkIGtkZF9oYW5kbGVfaGFuZHNoYWtlKGtkZF9zdGF0ZSAqcykKPiAgewo+ICAg
ICAgLyogRmlndXJlIG91dCB3aGF0IHdlJ3JlIGxvb2tpbmcgYXQgKi8KPiAgICAgIGZpbmRfb3Mo
cyk7Cj4gKwo+ICsgICAgLyogaWYgdW5rbm93biBvcywgdXNlIHRoZSBpZHQgbWV0aG9kICovCj4g
KyAgICBpZiAoIXMtPm9zLmJhc2UpIHsKPiArICAgICAgICBnZXRfb3NfaW5mb182NChzKTsKPiAr
ICAgIH0KPiArCj4gICAgICBrZGRfc2VuZF9zdHJpbmcocywgIltrZGQ6ICVzIEAweCUiUFJJeDY0
Il1cclxuIiwgcy0+b3MubmFtZSwgcy0+b3MuYmFzZSk7Cj4KPiAgICAgIC8qIFJlc3BvbmQgd2l0
aCBzb21lIGRldGFpbHMgYWJvdXQgdGhlIGRlYnVnZ2VyIHN0dWIgd2Ugc2ltdWxhdGUgKi8KPiBA
QCAtNTU1LDcgKzk0Miw3IEBAIHN0YXRpYyB2b2lkIGtkZF9oYW5kbGVfaGFuZHNoYWtlKGtkZF9z
dGF0ZSAqcykKPiAgICAgIHMtPnR4cC5jbWQuc2hha2UudTNbMl0gICAgID0gMHg1NTsKPiAgICAg
IHMtPnR4cC5jbWQuc2hha2Uua2Vybl9hZGRyID0gcy0+b3MuYmFzZTsKPiAgICAgIHMtPnR4cC5j
bWQuc2hha2UubW9kc19hZGRyID0gcy0+b3MuYmFzZSArIHMtPm9zLm1vZHVsZXM7Cj4gLSAgICBz
LT50eHAuY21kLnNoYWtlLmRhdGFfYWRkciA9IDA7IC8qIERlYnVnZ2VyIGRhdGEgcHJvYmFibHkg
ZG9lc24ndCBleGlzdCAqLwo+ICsgICAgcy0+dHhwLmNtZC5zaGFrZS5kYXRhX2FkZHIgPSBzLT5v
cy5iYXNlICsgcy0+b3Mua2RkbDsgLy8gMDsgLyogRGVidWdnZXIgZGF0YSBwcm9iYWJseSBkb2Vz
bid0IGV4aXN0ICovCgpUaGF0IGNvbW1lbnQgZG9lc24ndCBzb3VuZCByaWdodCBhbnkgbW9yZS4K
ClRoYW5rcywKCiAgUGF1bAoKPgo+ICAgICAgS0REX0xPRyhzLCAiQ2xpZW50IGluaXRpYWwgaGFu
ZHNoYWtlOiAlc1xuIiwgcy0+b3MubmFtZSk7Cj4gICAgICBrZGRfc2VuZF9jbWQocywgS0REX0NN
RF9TSEFLRSwgMCk7Cj4gLS0KPiAyLjE3LjEKPgoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlz
dHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3hlbi1kZXZlbA==

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 601236AD6F
	for <lists+xen-devel@lfdr.de>; Tue, 16 Jul 2019 19:10:21 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hnQuQ-0005pm-Vr; Tue, 16 Jul 2019 17:06:34 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=v+lg=VN=bitdefender.com=ppircalabu@srs-us1.protection.inumbo.net>)
 id 1hnQuO-0005oa-Po
 for xen-devel@lists.xenproject.org; Tue, 16 Jul 2019 17:06:32 +0000
X-Inumbo-ID: 0d788aba-a7ec-11e9-8980-bc764e045a96
Received: from mx01.bbu.dsd.mx.bitdefender.com (unknown [91.199.104.161])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 0d788aba-a7ec-11e9-8980-bc764e045a96;
 Tue, 16 Jul 2019 17:06:30 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 26551305FFA5; Tue, 16 Jul 2019 20:06:26 +0300 (EEST)
Received: from bitdefender.com (unknown [195.189.155.70])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id EE06E304F605;
 Tue, 16 Jul 2019 20:06:25 +0300 (EEST)
From: Petre Pircalabu <ppircalabu@bitdefender.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 16 Jul 2019 20:06:21 +0300
Message-Id: <79a1e2aebc55c20f58cb8c925320de202b17d8f2.1563293545.git.ppircalabu@bitdefender.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <cover.1563293545.git.ppircalabu@bitdefender.com>
References: <cover.1563293545.git.ppircalabu@bitdefender.com>
In-Reply-To: <cover.1563293545.git.ppircalabu@bitdefender.com>
References: <cover.1563293545.git.ppircalabu@bitdefender.com>
Subject: [Xen-devel] [PATCH v2 07/10] vm_event: Add vm_event_ng interface
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Petre Pircalabu <ppircalabu@bitdefender.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Razvan Cojocaru <rcojocaru@bitdefender.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Tamas K Lengyel <tamas@tklengyel.com>,
 Jan Beulich <jbeulich@suse.com>, Alexandru Isaila <aisaila@bitdefender.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gaGlnaCB0aHJvdWdocHV0IGludHJvc3BlY3Rpb24gc2NlbmFyaW9zIHdoZXJlIGxvdHMgb2Yg
bW9uaXRvcgp2bV9ldmVudHMgYXJlIGdlbmVyYXRlZCwgdGhlIHJpbmcgYnVmZmVyIGNhbiBmaWxs
IHVwIGJlZm9yZSB0aGUgbW9uaXRvcgphcHBsaWNhdGlvbiBnZXRzIGEgY2hhbmNlIHRvIGhhbmRs
ZSBhbGwgdGhlIHJlcXVlc3RzIHRodXMgYmxvY2tpbmcKb3RoZXIgdmNwdXMgd2hpY2ggd2lsbCBo
YXZlIHRvIHdhaXQgZm9yIGEgc2xvdCB0byBiZWNvbWUgYXZhaWxhYmxlLgoKVGhpcyBwYXRjaCBh
ZGRzIHN1cHBvcnQgZm9yIGEgZGlmZmVyZW50IG1lY2hhbmlzbSB0byBoYW5kbGUgc3luY2hyb25v
dXMKdm1fZXZlbnQgcmVxdWVzdHMgLyByZXNwb25zZXMuIEFzIGVhY2ggc3luY2hyb25vdXMgcmVx
dWVzdCBwYXVzZXMgdGhlCnZjcHUgdW50aWwgdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UgaXMg
aGFuZGxlZCwgaXQgY2FuIGJlIHN0b3JlZCBpbgphIHNsb3R0ZWQgbWVtb3J5IGJ1ZmZlciAob25l
IHBlciB2Y3B1KSBzaGFyZWQgYmV0d2VlbiB0aGUgaHlwZXJ2aXNvciBhbmQKdGhlIGNvbnRyb2xs
aW5nIGRvbWFpbi4KClNpZ25lZC1vZmYtYnk6IFBldHJlIFBpcmNhbGFidSA8cHBpcmNhbGFidUBi
aXRkZWZlbmRlci5jb20+Ci0tLQogdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmggfCAgIDkg
KwogdG9vbHMvbGlieGMveGNfbWVtX3BhZ2luZy5jICAgfCAgIDkgKy0KIHRvb2xzL2xpYnhjL3hj
X21lbXNoci5jICAgICAgIHwgICA5ICstCiB0b29scy9saWJ4Yy94Y19tb25pdG9yLmMgICAgICB8
ICAyMyArLQogdG9vbHMvbGlieGMveGNfcHJpdmF0ZS5oICAgICAgfCAgMTIgKy0KIHRvb2xzL2xp
YnhjL3hjX3ZtX2V2ZW50LmMgICAgIHwgMTAwICsrKysrKy0KIHhlbi9hcmNoL3g4Ni9tbS5jICAg
ICAgICAgICAgIHwgICA3ICsKIHhlbi9jb21tb24vdm1fZXZlbnQuYyAgICAgICAgIHwgNTk1ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLQogeGVuL2luY2x1ZGUvcHVi
bGljL2RvbWN0bC5oICAgfCAgMTAgKy0KIHhlbi9pbmNsdWRlL3B1YmxpYy9tZW1vcnkuaCAgIHwg
ICAyICsKIHhlbi9pbmNsdWRlL3B1YmxpYy92bV9ldmVudC5oIHwgIDE2ICsrCiB4ZW4vaW5jbHVk
ZS94ZW4vdm1fZXZlbnQuaCAgICB8ICAxMSArLQogMTIgZmlsZXMgY2hhbmdlZCwgNjg0IGluc2Vy
dGlvbnMoKyksIDExOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy9pbmNs
dWRlL3hlbmN0cmwuaCBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCmluZGV4IGYzYWY3
MTAuLjEyOTNiMGYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCisr
KyBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCkBAIC0xMjgsNiArMTI4LDcgQEAgZW51
bSB4Y19lcnJvcl9jb2RlIHsKIAogdHlwZWRlZiBlbnVtIHhjX2Vycm9yX2NvZGUgeGNfZXJyb3Jf
Y29kZTsKIAorc3RydWN0IHhlbmZvcmVpZ25tZW1vcnlfcmVzb3VyY2VfaGFuZGxlOwogCiAvKgog
ICogIElOSVRJQUxJWkFUSU9OIEZVTkNUSU9OUwpAQCAtMjAwNyw2ICsyMDA4LDE0IEBAIGludCB4
Y192bV9ldmVudF9nZXRfdmVyc2lvbih4Y19pbnRlcmZhY2UgKnhjaCk7CiB2b2lkICp4Y19tb25p
dG9yX2VuYWJsZSh4Y19pbnRlcmZhY2UgKnhjaCwgdWludDMyX3QgZG9tYWluX2lkLCB1aW50MzJf
dCAqcG9ydCk7CiBpbnQgeGNfbW9uaXRvcl9kaXNhYmxlKHhjX2ludGVyZmFjZSAqeGNoLCB1aW50
MzJfdCBkb21haW5faWQpOwogaW50IHhjX21vbml0b3JfcmVzdW1lKHhjX2ludGVyZmFjZSAqeGNo
LCB1aW50MzJfdCBkb21haW5faWQpOworCisvKiBNb25pdG9yIE5HIGludGVyZmFjZSAqLworaW50
IHhjX21vbml0b3JfbmdfZW5hYmxlKHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJfdCBkb21haW5f
aWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhlbmZvcmVpZ25tZW1vcnlfcmVz
b3VyY2VfaGFuZGxlICoqZnJlcywKKyAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgKm51bV9j
aGFubmVscywgdm9pZCAqKnBfYWRkcik7CitpbnQgeGNfbW9uaXRvcl9uZ19kaXNhYmxlKHhjX2lu
dGVyZmFjZSAqeGNoLCB1aW50MzJfdCBkb21haW5faWQsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCB4ZW5mb3JlaWdubWVtb3J5X3Jlc291cmNlX2hhbmRsZSAqKmZyZXMpOworCiAv
KgogICogR2V0IGEgYml0bWFwIG9mIHN1cHBvcnRlZCBtb25pdG9yIGV2ZW50cyBpbiB0aGUgZm9y
bQogICogKDEgPDwgWEVOX0RPTUNUTF9NT05JVE9SX0VWRU5UXyopLgpkaWZmIC0tZ2l0IGEvdG9v
bHMvbGlieGMveGNfbWVtX3BhZ2luZy5jIGIvdG9vbHMvbGlieGMveGNfbWVtX3BhZ2luZy5jCmlu
ZGV4IGE4OGMwY2MuLjk3ODAwOGEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL3hjX21lbV9wYWdp
bmcuYworKysgYi90b29scy9saWJ4Yy94Y19tZW1fcGFnaW5nLmMKQEAgLTQ5LDcgKzQ5LDcgQEAg
aW50IHhjX21lbV9wYWdpbmdfZW5hYmxlKHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJfdCBkb21h
aW5faWQsCiAgICAgcmV0dXJuIHhjX3ZtX2V2ZW50X2NvbnRyb2woeGNoLCBkb21haW5faWQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWEVOX1ZNX0VWRU5UX0VOQUJMRSwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5fVk1fRVZFTlRfVFlQRV9QQUdJTkcsCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCk7CisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgMCwgcG9ydCk7CiB9CiAKIGludCB4Y19tZW1fcGFnaW5nX2Rpc2FibGUoeGNfaW50
ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCkKQEAgLTU3LDE1ICs1NywxMiBAQCBpbnQg
eGNfbWVtX3BhZ2luZ19kaXNhYmxlKHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJfdCBkb21haW5f
aWQpCiAgICAgcmV0dXJuIHhjX3ZtX2V2ZW50X2NvbnRyb2woeGNoLCBkb21haW5faWQsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgWEVOX1ZNX0VWRU5UX0RJU0FCTEUsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgWEVOX1ZNX0VWRU5UX1RZUEVfUEFHSU5HLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOworICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDAsIE5VTEwpOwogfQogCiBpbnQgeGNfbWVtX3BhZ2luZ19yZXN1bWUoeGNfaW50ZXJm
YWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCkKIHsKLSAgICByZXR1cm4geGNfdm1fZXZlbnRf
Y29udHJvbCh4Y2gsIGRvbWFpbl9pZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBY
RU5fVk1fRVZFTlRfUkVTVU1FLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhFTl9W
TV9FVkVOVF9UWVBFX1BBR0lORywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxM
KTsKKyAgICByZXR1cm4geGNfdm1fZXZlbnRfcmVzdW1lKHhjaCwgZG9tYWluX2lkLCBYRU5fVk1f
RVZFTlRfVFlQRV9QQUdJTkcsIDApOwogfQogCiBpbnQgeGNfbWVtX3BhZ2luZ19ub21pbmF0ZSh4
Y19pbnRlcmZhY2UgKnhjaCwgdWludDMyX3QgZG9tYWluX2lkLCB1aW50NjRfdCBnZm4pCmRpZmYg
LS1naXQgYS90b29scy9saWJ4Yy94Y19tZW1zaHIuYyBiL3Rvb2xzL2xpYnhjL3hjX21lbXNoci5j
CmluZGV4IDFjNGE3MDYuLjQ0ZDRmMjMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL3hjX21lbXNo
ci5jCisrKyBiL3Rvb2xzL2xpYnhjL3hjX21lbXNoci5jCkBAIC01NCw3ICs1NCw3IEBAIGludCB4
Y19tZW1zaHJfcmluZ19lbmFibGUoeGNfaW50ZXJmYWNlICp4Y2gsCiAgICAgcmV0dXJuIHhjX3Zt
X2V2ZW50X2NvbnRyb2woeGNoLCBkb21pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBYRU5fVk1fRVZFTlRfRU5BQkxFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhF
Tl9WTV9FVkVOVF9UWVBFX1NIQVJJTkcsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cG9ydCk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgcG9ydCk7CiB9CiAKIGlu
dCB4Y19tZW1zaHJfcmluZ19kaXNhYmxlKHhjX2ludGVyZmFjZSAqeGNoLCAKQEAgLTYzLDcgKzYz
LDcgQEAgaW50IHhjX21lbXNocl9yaW5nX2Rpc2FibGUoeGNfaW50ZXJmYWNlICp4Y2gsCiAgICAg
cmV0dXJuIHhjX3ZtX2V2ZW50X2NvbnRyb2woeGNoLCBkb21pZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBYRU5fVk1fRVZFTlRfRElTQUJMRSwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBYRU5fVk1fRVZFTlRfVFlQRV9TSEFSSU5HLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE5VTEwpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsIE5V
TEwpOwogfQogCiBzdGF0aWMgaW50IHhjX21lbXNocl9tZW1vcCh4Y19pbnRlcmZhY2UgKnhjaCwg
dWludDMyX3QgZG9taWQsCkBAIC0yMDMsMTAgKzIwMyw3IEBAIGludCB4Y19tZW1zaHJfcmFuZ2Vf
c2hhcmUoeGNfaW50ZXJmYWNlICp4Y2gsCiBpbnQgeGNfbWVtc2hyX2RvbWFpbl9yZXN1bWUoeGNf
aW50ZXJmYWNlICp4Y2gsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgZG9t
aWQpCiB7Ci0gICAgcmV0dXJuIHhjX3ZtX2V2ZW50X2NvbnRyb2woeGNoLCBkb21pZCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5fVk1fRVZFTlRfUkVTVU1FLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFhFTl9WTV9FVkVOVF9UWVBFX1NIQVJJTkcsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7CisgICAgcmV0dXJuIHhjX3ZtX2V2ZW50X3Jl
c3VtZSh4Y2gsIGRvbWlkLCBYRU5fVk1fRVZFTlRfVFlQRV9TSEFSSU5HLCAwKTsKIH0KIAogaW50
IHhjX21lbXNocl9kZWJ1Z19nZm4oeGNfaW50ZXJmYWNlICp4Y2gsCmRpZmYgLS1naXQgYS90b29s
cy9saWJ4Yy94Y19tb25pdG9yLmMgYi90b29scy9saWJ4Yy94Y19tb25pdG9yLmMKaW5kZXggZjA1
YjUzZC4uZDhkNjJjNCAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGMveGNfbW9uaXRvci5jCisrKyBi
L3Rvb2xzL2xpYnhjL3hjX21vbml0b3IuYwpAQCAtMzMsMTUgKzMzLDEyIEBAIGludCB4Y19tb25p
dG9yX2Rpc2FibGUoeGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCkKICAgICBy
ZXR1cm4geGNfdm1fZXZlbnRfY29udHJvbCh4Y2gsIGRvbWFpbl9pZCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBYRU5fVk1fRVZFTlRfRElTQUJMRSwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBYRU5fVk1fRVZFTlRfVFlQRV9NT05JVE9SLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE5VTEwpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAs
IE5VTEwpOwogfQogCiBpbnQgeGNfbW9uaXRvcl9yZXN1bWUoeGNfaW50ZXJmYWNlICp4Y2gsIHVp
bnQzMl90IGRvbWFpbl9pZCkKIHsKLSAgICByZXR1cm4geGNfdm1fZXZlbnRfY29udHJvbCh4Y2gs
IGRvbWFpbl9pZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5fVk1fRVZFTlRf
UkVTVU1FLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhFTl9WTV9FVkVOVF9UWVBF
X01PTklUT1IsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7CisgICAgcmV0
dXJuIHhjX3ZtX2V2ZW50X3Jlc3VtZSh4Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VWRU5UX1RZUEVf
TU9OSVRPUiwgMCk7CiB9CiAKIGludCB4Y19tb25pdG9yX2dldF9jYXBhYmlsaXRpZXMoeGNfaW50
ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwKQEAgLTI0Niw2ICsyNDMsMjIgQEAgaW50
IHhjX21vbml0b3JfZW11bF91bmltcGxlbWVudGVkKHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJf
dCBkb21haW5faWQsCiAgICAgcmV0dXJuIGRvX2RvbWN0bCh4Y2gsICZkb21jdGwpOwogfQogCitp
bnQgeGNfbW9uaXRvcl9uZ19lbmFibGUoeGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFp
bl9pZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5mb3JlaWdubWVtb3J5X3Jlc291cmNl
X2hhbmRsZSAqKmZyZXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICpudW1fY2hhbm5l
bHMsIHZvaWQgKipwX2FkZHIpCit7CisgICAgcmV0dXJuIHhjX3ZtX2V2ZW50X25nX2VuYWJsZSh4
Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VWRU5UX1RZUEVfTU9OSVRPUiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGZyZXMsIG51bV9jaGFubmVscywgcF9hZGRyKTsKK30KKworCitp
bnQgeGNfbW9uaXRvcl9uZ19kaXNhYmxlKHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJfdCBkb21h
aW5faWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgIHhlbmZvcmVpZ25tZW1vcnlfcmVzb3Vy
Y2VfaGFuZGxlICoqZnJlcykKK3sKKyAgICByZXR1cm4geGNfdm1fZXZlbnRfbmdfZGlzYWJsZSh4
Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VWRU5UX1RZUEVfTU9OSVRPUiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBmcmVzKTsKK30KKwogLyoKICAqIExvY2FsIHZhcmlhYmxlczoK
ICAqIG1vZGU6IEMKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhjL3hjX3ByaXZhdGUuaCBiL3Rvb2xz
L2xpYnhjL3hjX3ByaXZhdGUuaAppbmRleCBlNGY3YzNhLi45Y2Q2MDY5IDEwMDY0NAotLS0gYS90
b29scy9saWJ4Yy94Y19wcml2YXRlLmgKKysrIGIvdG9vbHMvbGlieGMveGNfcHJpdmF0ZS5oCkBA
IC00MTIsMTMgKzQxMiwyMyBAQCBpbnQgeGNfZmZzNjQodWludDY0X3QgeCk7CiAgKiB2bV9ldmVu
dCBvcGVyYXRpb25zLiBJbnRlcm5hbCB1c2Ugb25seS4KICAqLwogaW50IHhjX3ZtX2V2ZW50X2Nv
bnRyb2woeGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwgdW5zaWduZWQgaW50
IG9wLAotICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHR5cGUsIHVpbnQzMl90
ICpwb3J0KTsKKyAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCB0eXBlLCB1bnNp
Z25lZCBpbnQgZmxhZ3MsIHVpbnQzMl90ICpwb3J0KTsKK2ludCB4Y192bV9ldmVudF9yZXN1bWUo
eGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwgdW5zaWduZWQgaW50IHR5cGUs
CisgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncyk7CiAvKgogICogRW5h
YmxlcyB2bV9ldmVudCBhbmQgcmV0dXJucyB0aGUgbWFwcGVkIHJpbmcgcGFnZSBpbmRpY2F0ZWQg
YnkgdHlwZS4KICAqIHR5cGUgY2FuIGJlIFhFTl9WTV9FVkVOVF9UWVBFXyhQQUdJTkcvTU9OSVRP
Ui9TSEFSSU5HKQogICovCiB2b2lkICp4Y192bV9ldmVudF9lbmFibGUoeGNfaW50ZXJmYWNlICp4
Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwgaW50IHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgdWludDMyX3QgKnBvcnQpOworLyoKKyAqIEVuYWJsZXMvRGlzYWJsZXMgdm1fZXZlbnQgdXNp
bmcgdGhlIG5ldyBpbnRlcmZhY2UuCisgKi8KK2ludCB4Y192bV9ldmVudF9uZ19lbmFibGUoeGNf
aW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwgaW50IHR5cGUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgIHhlbmZvcmVpZ25tZW1vcnlfcmVzb3VyY2VfaGFuZGxlICoqZnJlcywK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICpudW1fY2hhbm5lbHMsIHZvaWQgKipwX2Fk
ZHIpOworaW50IHhjX3ZtX2V2ZW50X25nX2Rpc2FibGUoeGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQz
Ml90IGRvbWFpbl9pZCwgaW50IHR5cGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgIHhlbmZv
cmVpZ25tZW1vcnlfcmVzb3VyY2VfaGFuZGxlICoqZnJlcyk7CiAKIGludCBkb19kbV9vcCh4Y19p
bnRlcmZhY2UgKnhjaCwgdWludDMyX3QgZG9taWQsIHVuc2lnbmVkIGludCBucl9idWZzLCAuLi4p
OwogCmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy94Y192bV9ldmVudC5jIGIvdG9vbHMvbGlieGMv
eGNfdm1fZXZlbnQuYwppbmRleCAwNDRiZjcxLi5kMDcwZTY0IDEwMDY0NAotLS0gYS90b29scy9s
aWJ4Yy94Y192bV9ldmVudC5jCisrKyBiL3Rvb2xzL2xpYnhjL3hjX3ZtX2V2ZW50LmMKQEAgLTIy
LDggKzIyLDEyIEBACiAKICNpbmNsdWRlICJ4Y19wcml2YXRlLmgiCiAKKyNpZm5kZWYgUEZOX1VQ
CisjZGVmaW5lIFBGTl9VUCh4KSAgICAgKCgoeCkgKyBYQ19QQUdFX1NJWkUtMSkgPj4gWENfUEFH
RV9TSElGVCkKKyNlbmRpZiAvKiBQRk5fVVAgKi8KKwogaW50IHhjX3ZtX2V2ZW50X2NvbnRyb2wo
eGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwgdW5zaWduZWQgaW50IG9wLAot
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHR5cGUsIHVpbnQzMl90ICpwb3J0
KQorICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHR5cGUsIHVuc2lnbmVkIGlu
dCBmbGFncywgdWludDMyX3QgKnBvcnQpCiB7CiAgICAgREVDTEFSRV9ET01DVEw7CiAgICAgaW50
IHJjOwpAQCAtMzIsNiArMzYsNyBAQCBpbnQgeGNfdm1fZXZlbnRfY29udHJvbCh4Y19pbnRlcmZh
Y2UgKnhjaCwgdWludDMyX3QgZG9tYWluX2lkLCB1bnNpZ25lZCBpbnQgb3AsCiAgICAgZG9tY3Rs
LmRvbWFpbiA9IGRvbWFpbl9pZDsKICAgICBkb21jdGwudS52bV9ldmVudF9vcC5vcCA9IG9wOwog
ICAgIGRvbWN0bC51LnZtX2V2ZW50X29wLnR5cGUgPSB0eXBlOworICAgIGRvbWN0bC51LnZtX2V2
ZW50X29wLmZsYWdzID0gZmxhZ3M7CiAKICAgICByYyA9IGRvX2RvbWN0bCh4Y2gsICZkb21jdGwp
OwogICAgIGlmICggIXJjICYmIHBvcnQgKQpAQCAtMTEzLDcgKzExOCw3IEBAIHZvaWQgKnhjX3Zt
X2V2ZW50X2VuYWJsZSh4Y19pbnRlcmZhY2UgKnhjaCwgdWludDMyX3QgZG9tYWluX2lkLCBpbnQg
dHlwZSwKICAgICAgICAgZ290byBvdXQ7CiAgICAgfQogCi0gICAgcmMxID0geGNfdm1fZXZlbnRf
Y29udHJvbCh4Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VWRU5UX0VOQUJMRSwgdHlwZSwgcG9ydCk7
CisgICAgcmMxID0geGNfdm1fZXZlbnRfY29udHJvbCh4Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VW
RU5UX0VOQUJMRSwgdHlwZSwgMCwgcG9ydCk7CiAgICAgaWYgKCByYzEgIT0gMCApCiAgICAgewog
ICAgICAgICBQRVJST1IoIkZhaWxlZCB0byBlbmFibGUgdm1fZXZlbnRcbiIpOwpAQCAtMTY0LDYg
KzE2OSw5NyBAQCBpbnQgeGNfdm1fZXZlbnRfZ2V0X3ZlcnNpb24oeGNfaW50ZXJmYWNlICp4Y2gp
CiAgICAgcmV0dXJuIHJjOwogfQogCitpbnQgeGNfdm1fZXZlbnRfcmVzdW1lKHhjX2ludGVyZmFj
ZSAqeGNoLCB1aW50MzJfdCBkb21haW5faWQsCisgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCB0eXBlLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisgICAgREVDTEFSRV9ET01DVEw7
CisKKyAgICBkb21jdGwuY21kID0gWEVOX0RPTUNUTF92bV9ldmVudF9vcDsKKyAgICBkb21jdGwu
ZG9tYWluID0gZG9tYWluX2lkOworICAgIGRvbWN0bC51LnZtX2V2ZW50X29wLm9wID0gWEVOX1ZN
X0VWRU5UX1JFU1VNRTsKKyAgICBkb21jdGwudS52bV9ldmVudF9vcC50eXBlID0gdHlwZTsKKyAg
ICBkb21jdGwudS52bV9ldmVudF9vcC5mbGFncyA9IGZsYWdzOworICAgIGRvbWN0bC51LnZtX2V2
ZW50X29wLnUucmVzdW1lLnZjcHVfaWQgPSAwOworCisgICAgcmV0dXJuIGRvX2RvbWN0bCh4Y2gs
ICZkb21jdGwpOworfQorCitpbnQgeGNfdm1fZXZlbnRfbmdfZW5hYmxlKHhjX2ludGVyZmFjZSAq
eGNoLCB1aW50MzJfdCBkb21haW5faWQsIGludCB0eXBlLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICB4ZW5mb3JlaWdubWVtb3J5X3Jlc291cmNlX2hhbmRsZSAqKmZyZXMsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgIGludCAqbnVtX2NoYW5uZWxzLCB2b2lkICoqcF9hZGRyKQoreworICAg
IGludCByYzEsIHJjMjsKKyAgICB4Y19kb21pbmZvX3QgaW5mbzsKKyAgICB1bnNpZ25lZCBsb25n
IG5yX2ZyYW1lczsKKworICAgIGlmICggIWZyZXMgfHwgIW51bV9jaGFubmVscyB8fCAhIHBfYWRk
ciApCisgICAgICAgIHJldHVybiAtRUlOVkFMOworCisgICAgLyogR2V0IHRoZSBudW1iZXJzIG9m
IHZjcHVzICovCisgICAgaWYgKCB4Y19kb21haW5fZ2V0aW5mbyh4Y2gsIGRvbWFpbl9pZCwgMSwg
JmluZm8pICE9IDEgfHwKKyAgICAgICAgIGluZm8uZG9taWQgIT0gZG9tYWluX2lkICkKKyAgICB7
CisgICAgICAgIFBFUlJPUigieGNfZG9tYWluX2dldGluZm8gZmFpbGVkLlxuIik7CisgICAgICAg
IHJldHVybiAtRVNSQ0g7CisgICAgfQorCisgICAgKm51bV9jaGFubmVscyA9IGluZm8ubWF4X3Zj
cHVfaWQgKyAxOworCisgICAgcmMxID0geGNfZG9tYWluX3BhdXNlKHhjaCwgZG9tYWluX2lkKTsK
KyAgICBpZiAoIHJjMSApCisgICAgeworICAgICAgICBQRVJST1IoIlVuYWJsZSB0byBwYXVzZSBk
b21haW5cbiIpOworICAgICAgICByZXR1cm4gcmMxOworICAgIH0KKworICAgIHJjMSA9IHhjX3Zt
X2V2ZW50X2NvbnRyb2woeGNoLCBkb21haW5faWQsIFhFTl9WTV9FVkVOVF9FTkFCTEUsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBYRU5fVk1fRVZFTlRfRkxBR1NfTkdfT1As
IE5VTEwpOworICAgIGlmICggcmMxICkKKyAgICB7CisgICAgICAgIFBFUlJPUigiRmFpbGVkIHRv
IGVuYWJsZSB2bV9ldmVudFxuIik7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAgIG5y
X2ZyYW1lcyA9IFBGTl9VUCgqbnVtX2NoYW5uZWxzICogc2l6ZW9mKHN0cnVjdCB2bV9ldmVudF9z
bG90KSk7CisKKyAgICAqZnJlcyA9IHhlbmZvcmVpZ25tZW1vcnlfbWFwX3Jlc291cmNlKHhjaC0+
Zm1lbSwgZG9tYWluX2lkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgWEVOTUVNX3Jlc291cmNlX3ZtX2V2ZW50LAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgWEVOX1ZNX0VWRU5UX1RZUEVfTU9OSVRPUiwgMCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yX2ZyYW1lcywgcF9hZGRyLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJPVF9SRUFEIHwgUFJPVF9XUklU
RSwgMCk7CisgICAgaWYgKCAhKmZyZXMgKQorICAgIHsKKyAgICAgICAgeGNfdm1fZXZlbnRfY29u
dHJvbCh4Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VWRU5UX0RJU0FCTEUsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdHlwZSwgWEVOX1ZNX0VWRU5UX0ZMQUdTX05HX09QLCBOVUxMKTsKKyAg
ICAgICAgRVJST1IoIkZhaWxlZCB0byBtYXAgdm1fZXZlbnQgcmVzb3VyY2UiKTsKKyAgICAgICAg
cmMxID0gLWVycm5vOworICAgICAgICBnb3RvIG91dDsKKyAgICB9CisKK291dDoKKyAgICByYzIg
PSB4Y19kb21haW5fdW5wYXVzZSh4Y2gsIGRvbWFpbl9pZCk7CisgICAgaWYgKCByYzEgfHwgcmMy
ICkKKyAgICB7CisgICAgICAgIGlmICggcmMyICkKKyAgICAgICAgICAgIFBFUlJPUigiVW5hYmxl
IHRvIHBhdXNlIGRvbWFpblxuIik7CisKKyAgICAgICAgaWYgKCByYzEgPT0gMCApCisgICAgICAg
ICAgICByYzEgPSByYzI7CisgICAgfQorCisgICAgcmV0dXJuIHJjMTsKK30KKworaW50IHhjX3Zt
X2V2ZW50X25nX2Rpc2FibGUoeGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGRvbWFpbl9pZCwg
aW50IHR5cGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5mb3JlaWdubWVtb3J5X3Jl
c291cmNlX2hhbmRsZSAqKmZyZXMpCit7CisgICAgeGVuZm9yZWlnbm1lbW9yeV91bm1hcF9yZXNv
dXJjZSh4Y2gtPmZtZW0sICpmcmVzKTsKKyAgICAqZnJlcyA9IE5VTEw7CisKKyAgICByZXR1cm4g
eGNfdm1fZXZlbnRfY29udHJvbCh4Y2gsIGRvbWFpbl9pZCwgWEVOX1ZNX0VWRU5UX0RJU0FCTEUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBYRU5fVk1fRVZFTlRfRkxBR1Nf
TkdfT1AsIE5VTEwpOworfQorCiAvKgogICogTG9jYWwgdmFyaWFibGVzOgogICogbW9kZTogQwpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBk
ZjJjMDEzLi43NjhkZjRmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTE5LDYgKzExOSw3IEBACiAjaW5jbHVkZSA8eGVuL2VmaS5oPgog
I2luY2x1ZGUgPHhlbi9ncmFudF90YWJsZS5oPgogI2luY2x1ZGUgPHhlbi9oeXBlcmNhbGwuaD4K
KyNpbmNsdWRlIDx4ZW4vdm1fZXZlbnQuaD4KICNpbmNsdWRlIDxhc20vcGFnaW5nLmg+CiAjaW5j
bHVkZSA8YXNtL3NoYWRvdy5oPgogI2luY2x1ZGUgPGFzbS9wYWdlLmg+CkBAIC00NTU1LDYgKzQ1
NTYsMTIgQEAgaW50IGFyY2hfYWNxdWlyZV9yZXNvdXJjZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNp
Z25lZCBpbnQgdHlwZSwKICAgICB9CiAjZW5kaWYKIAorICAgIGNhc2UgWEVOTUVNX3Jlc291cmNl
X3ZtX2V2ZW50OgorICAgICAgICByYyA9IHZtX2V2ZW50X25nX2dldF9mcmFtZXMoZCwgaWQsIGZy
YW1lLCBucl9mcmFtZXMsIG1mbl9saXN0KTsKKyAgICAgICAgaWYgKCAhcmMgKQorICAgICAgICAg
ICAgKmZsYWdzIHw9IFhFTk1FTV9yc3JjX2FjcV9jYWxsZXJfb3duZWQ7CisgICAgICAgIGJyZWFr
OworCiAgICAgZGVmYXVsdDoKICAgICAgICAgcmMgPSAtRU9QTk9UU1VQUDsKICAgICAgICAgYnJl
YWs7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3ZtX2V2ZW50LmMgYi94ZW4vY29tbW9uL3ZtX2V2
ZW50LmMKaW5kZXggZTZhN2EyOS4uM2Y5YmU5NyAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi92bV9l
dmVudC5jCisrKyBiL3hlbi9jb21tb24vdm1fZXZlbnQuYwpAQCAtMjUsNiArMjUsNyBAQAogI2lu
Y2x1ZGUgPHhlbi93YWl0Lmg+CiAjaW5jbHVkZSA8eGVuL3ZtX2V2ZW50Lmg+CiAjaW5jbHVkZSA8
eGVuL21lbV9hY2Nlc3MuaD4KKyNpbmNsdWRlIDx4ZW4vdm1hcC5oPgogI2luY2x1ZGUgPGFzbS9w
Mm0uaD4KICNpbmNsdWRlIDxhc20vbW9uaXRvci5oPgogI2luY2x1ZGUgPGFzbS92bV9ldmVudC5o
PgpAQCAtMzUsNiArMzYsNzggQEAKICNkZWZpbmUgeGVuX3JtYigpICBzbXBfcm1iKCkKICNkZWZp
bmUgeGVuX3dtYigpICBzbXBfd21iKCkKIAorc3RhdGljIGludCB2bV9ldmVudF9yaW5nX3Bmbl9w
YXJhbSh1aW50MzJfdCB0eXBlKQoreworICAgIHN3aXRjaCggdHlwZSApCisgICAgeworI2lmZGVm
IENPTkZJR19IQVNfTUVNX1BBR0lORworICAgIGNhc2UgWEVOX1ZNX0VWRU5UX1RZUEVfUEFHSU5H
OgorICAgICAgICByZXR1cm4gSFZNX1BBUkFNX1BBR0lOR19SSU5HX1BGTjsKKyNlbmRpZgorICAg
IGNhc2UgWEVOX1ZNX0VWRU5UX1RZUEVfTU9OSVRPUjoKKyAgICAgICAgcmV0dXJuIEhWTV9QQVJB
TV9NT05JVE9SX1JJTkdfUEZOOworI2lmZGVmIENPTkZJR19IQVNfTUVNX1NIQVJJTkcKKyAgICBj
YXNlIFhFTl9WTV9FVkVOVF9UWVBFX1NIQVJJTkc6CisgICAgICAgIHJldHVybiBIVk1fUEFSQU1f
U0hBUklOR19SSU5HX1BGTjsKKyNlbmRpZgorICAgIH07CisKKyAgICBBU1NFUlRfVU5SRUFDSEFC
TEUoKTsKKyAgICByZXR1cm4gLTE7Cit9CisKK3N0YXRpYyBpbnQgdm1fZXZlbnRfcGF1c2VfZmxh
Zyh1aW50MzJfdCB0eXBlKQoreworICAgIHN3aXRjaCggdHlwZSApCisgICAgeworI2lmZGVmIENP
TkZJR19IQVNfTUVNX1BBR0lORworICAgIGNhc2UgWEVOX1ZNX0VWRU5UX1RZUEVfUEFHSU5HOgor
ICAgICAgICByZXR1cm4gX1ZQRl9tZW1fcGFnaW5nOworI2VuZGlmCisgICAgY2FzZSBYRU5fVk1f
RVZFTlRfVFlQRV9NT05JVE9SOgorICAgICAgICByZXR1cm4gX1ZQRl9tZW1fYWNjZXNzOworI2lm
ZGVmIENPTkZJR19IQVNfTUVNX1NIQVJJTkcKKyAgICBjYXNlIFhFTl9WTV9FVkVOVF9UWVBFX1NI
QVJJTkc6CisgICAgICAgIHJldHVybiBfVlBGX21lbV9zaGFyaW5nOworI2VuZGlmCisgICAgfTsK
KworICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOworICAgIHJldHVybiAtMTsKK30KKworI2lmZGVm
IENPTkZJR19IQVNfTUVNX1BBR0lORworc3RhdGljIHZvaWQgbWVtX3BhZ2luZ19ub3RpZmljYXRp
b24oc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwb3J0KTsKKyNlbmRpZgorc3RhdGljIHZv
aWQgbW9uaXRvcl9ub3RpZmljYXRpb24oc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwb3J0
KTsKKyNpZmRlZiBDT05GSUdfSEFTX01FTV9TSEFSSU5HCitzdGF0aWMgdm9pZCBtZW1fc2hhcmlu
Z19ub3RpZmljYXRpb24oc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwb3J0KTsKKyNlbmRp
ZgorCitzdGF0aWMgeGVuX2V2ZW50X2NoYW5uZWxfbm90aWZpY2F0aW9uX3Qgdm1fZXZlbnRfbm90
aWZpY2F0aW9uX2ZuKHVpbnQzMl90IHR5cGUpCit7CisgICAgc3dpdGNoKCB0eXBlICkKKyAgICB7
CisjaWZkZWYgQ09ORklHX0hBU19NRU1fUEFHSU5HCisgICAgY2FzZSBYRU5fVk1fRVZFTlRfVFlQ
RV9QQUdJTkc6CisgICAgICAgIHJldHVybiBtZW1fcGFnaW5nX25vdGlmaWNhdGlvbjsKKyNlbmRp
ZgorICAgIGNhc2UgWEVOX1ZNX0VWRU5UX1RZUEVfTU9OSVRPUjoKKyAgICAgICAgcmV0dXJuIG1v
bml0b3Jfbm90aWZpY2F0aW9uOworI2lmZGVmIENPTkZJR19IQVNfTUVNX1NIQVJJTkcKKyAgICBj
YXNlIFhFTl9WTV9FVkVOVF9UWVBFX1NIQVJJTkc6CisgICAgICAgIHJldHVybiBtZW1fc2hhcmlu
Z19ub3RpZmljYXRpb247CisjZW5kaWYKKyAgICB9OworCisgICAgQVNTRVJUX1VOUkVBQ0hBQkxF
KCk7CisgICAgcmV0dXJuIE5VTEw7Cit9CisKKy8qCisgKiBWTSBldmVudCByaW5nIGltcGxlbWVu
dGF0aW9uOworICovCisKICNkZWZpbmUgdG9fcmluZyhfdmVkKSBjb250YWluZXJfb2YoKF92ZWQp
LCBzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4sIHZlZCkKIAogLyogVk0gZXZlbnQgcmluZyBp
bXBsZW1lbnRhdGlvbiAqLwpAQCAtNjcsMTIgKzE0MCwxMiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IHZtX2V2ZW50X29wcyB2bV9ldmVudF9yaW5nX29wczsKIHN0YXRpYyBpbnQgdm1fZXZlbnRfcmlu
Z19lbmFibGUoCiAgICAgc3RydWN0IGRvbWFpbiAqZCwKICAgICBzdHJ1Y3QgeGVuX2RvbWN0bF92
bV9ldmVudF9vcCAqdmVjLAotICAgIHN0cnVjdCB2bV9ldmVudF9kb21haW4gKipwX3ZlZCwKLSAg
ICBpbnQgcGF1c2VfZmxhZywKLSAgICBpbnQgcGFyYW0sCi0gICAgeGVuX2V2ZW50X2NoYW5uZWxf
bm90aWZpY2F0aW9uX3Qgbm90aWZpY2F0aW9uX2ZuKQorICAgIHN0cnVjdCB2bV9ldmVudF9kb21h
aW4gKipwX3ZlZCkKIHsKICAgICBpbnQgcmM7CisgICAgaW50IHBhcmFtID0gdm1fZXZlbnRfcmlu
Z19wZm5fcGFyYW0odmVjLT50eXBlKTsKKyAgICBpbnQgcGF1c2VfZmxhZyA9IHZtX2V2ZW50X3Bh
dXNlX2ZsYWcodmVjLT50eXBlKTsKKyAgICB4ZW5fZXZlbnRfY2hhbm5lbF9ub3RpZmljYXRpb25f
dCBmbiA9IHZtX2V2ZW50X25vdGlmaWNhdGlvbl9mbih2ZWMtPnR5cGUpOwogICAgIHVuc2lnbmVk
IGxvbmcgcmluZ19nZm4gPSBkLT5hcmNoLmh2bS5wYXJhbXNbcGFyYW1dOwogICAgIHN0cnVjdCB2
bV9ldmVudF9yaW5nX2RvbWFpbiAqaW1wbDsKIApAQCAtMTExLDggKzE4NCw3IEBAIHN0YXRpYyBp
bnQgdm1fZXZlbnRfcmluZ19lbmFibGUoCiAgICAgICAgICAgICAgICAgICAgICh2bV9ldmVudF9z
cmluZ190ICopaW1wbC0+cmluZ19wYWdlLAogICAgICAgICAgICAgICAgICAgICBQQUdFX1NJWkUp
OwogCi0gICAgcmMgPSBhbGxvY191bmJvdW5kX3hlbl9ldmVudF9jaGFubmVsKGQsIDAsIGN1cnJl
bnQtPmRvbWFpbi0+ZG9tYWluX2lkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBub3RpZmljYXRpb25fZm4pOworICAgIHJjID0gYWxsb2NfdW5ib3VuZF94ZW5fZXZl
bnRfY2hhbm5lbChkLCAwLCBjdXJyZW50LT5kb21haW4tPmRvbWFpbl9pZCwgZm4pOwogICAgIGlm
ICggcmMgPCAwICkKICAgICAgICAgZ290byBlcnI7CiAKQEAgLTI0Miw2ICszMTQsNyBAQCBzdGF0
aWMgaW50IHZtX2V2ZW50X3JpbmdfZGlzYWJsZShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICoqcF92
ZWQpCiAKICAgICB4ZnJlZShpbXBsKTsKICAgICAqcF92ZWQgPSBOVUxMOworCiAgICAgcmV0dXJu
IDA7CiB9CiAKQEAgLTM2NSw2ICs0MzgsNTEgQEAgc3RhdGljIGludCB2bV9ldmVudF9yaW5nX2dl
dF9yZXNwb25zZShzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwsCiAgICAgcmV0dXJu
IHJjOwogfQogCitzdGF0aWMgdm9pZCB2bV9ldmVudF9oYW5kbGVfcmVzcG9uc2Uoc3RydWN0IGRv
bWFpbiAqZCwgc3RydWN0IHZjcHUgKnYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdm1fZXZlbnRfcmVzcG9uc2VfdCAqcnNwKQoreworICAgIC8qIENoZWNrIGZsYWdzIHdo
aWNoIGFwcGx5IG9ubHkgd2hlbiB0aGUgdkNQVSBpcyBwYXVzZWQgKi8KKyAgICBpZiAoIGF0b21p
Y19yZWFkKCZ2LT52bV9ldmVudF9wYXVzZV9jb3VudCkgKQorICAgIHsKKyNpZmRlZiBDT05GSUdf
SEFTX01FTV9QQUdJTkcKKyAgICAgICAgaWYgKCByc3AtPnJlYXNvbiA9PSBWTV9FVkVOVF9SRUFT
T05fTUVNX1BBR0lORyApCisgICAgICAgICAgICBwMm1fbWVtX3BhZ2luZ19yZXN1bWUoZCwgcnNw
KTsKKyNlbmRpZgorCisgICAgICAgIC8qCisgICAgICAgICAqIENoZWNrIGVtdWxhdGlvbiBmbGFn
cyBpbiB0aGUgYXJjaC1zcGVjaWZpYyBoYW5kbGVyIG9ubHksIGFzIGl0CisgICAgICAgICAqIGhh
cyB0byBzZXQgYXJjaC1zcGVjaWZpYyBmbGFncyB3aGVuIHN1cHBvcnRlZCwgYW5kIHRvIGF2b2lk
CisgICAgICAgICAqIGJpdG1hc2sgb3ZlcmhlYWQgd2hlbiBpdCBpc24ndCBzdXBwb3J0ZWQuCisg
ICAgICAgICAqLworICAgICAgICB2bV9ldmVudF9lbXVsYXRlX2NoZWNrKHYsIHJzcCk7CisKKyAg
ICAgICAgLyoKKyAgICAgICAgICogQ2hlY2sgaW4gYXJjaC1zcGVjaWZpYyBoYW5kbGVyIHRvIGF2
b2lkIGJpdG1hc2sgb3ZlcmhlYWQgd2hlbgorICAgICAgICAgKiBub3Qgc3VwcG9ydGVkLgorICAg
ICAgICAgKi8KKyAgICAgICAgdm1fZXZlbnRfcmVnaXN0ZXJfd3JpdGVfcmVzdW1lKHYsIHJzcCk7
CisKKyAgICAgICAgLyoKKyAgICAgICAgICogQ2hlY2sgaW4gYXJjaC1zcGVjaWZpYyBoYW5kbGVy
IHRvIGF2b2lkIGJpdG1hc2sgb3ZlcmhlYWQgd2hlbgorICAgICAgICAgKiBub3Qgc3VwcG9ydGVk
LgorICAgICAgICAgKi8KKyAgICAgICAgdm1fZXZlbnRfdG9nZ2xlX3NpbmdsZXN0ZXAoZCwgdiwg
cnNwKTsKKworICAgICAgICAvKiBDaGVjayBmb3IgYWx0cDJtIHN3aXRjaCAqLworICAgICAgICBp
ZiAoIHJzcC0+ZmxhZ3MgJiBWTV9FVkVOVF9GTEFHX0FMVEVSTkFURV9QMk0gKQorICAgICAgICAg
ICAgcDJtX2FsdHAybV9jaGVjayh2LCByc3AtPmFsdHAybV9pZHgpOworCisgICAgICAgIGlmICgg
cnNwLT5mbGFncyAmIFZNX0VWRU5UX0ZMQUdfU0VUX1JFR0lTVEVSUyApCisgICAgICAgICAgICB2
bV9ldmVudF9zZXRfcmVnaXN0ZXJzKHYsIHJzcCk7CisKKyAgICAgICAgaWYgKCByc3AtPmZsYWdz
ICYgVk1fRVZFTlRfRkxBR19HRVRfTkVYVF9JTlRFUlJVUFQgKQorICAgICAgICAgICAgdm1fZXZl
bnRfbW9uaXRvcl9uZXh0X2ludGVycnVwdCh2KTsKKworICAgICAgICBpZiAoIHJzcC0+ZmxhZ3Mg
JiBWTV9FVkVOVF9GTEFHX1ZDUFVfUEFVU0VEICkKKyAgICAgICAgICAgIHZtX2V2ZW50X3ZjcHVf
dW5wYXVzZSh2KTsKKyAgICB9Cit9CisKIC8qCiAgKiBQdWxsIGFsbCByZXNwb25zZXMgZnJvbSB0
aGUgZ2l2ZW4gcmluZyBhbmQgdW5wYXVzZSB0aGUgY29ycmVzcG9uZGluZyB2Q1BVCiAgKiBpZiBy
ZXF1aXJlZC4gQmFzZWQgb24gdGhlIHJlc3BvbnNlIHR5cGUsIGhlcmUgd2UgY2FuIGFsc28gY2Fs
bCBjdXN0b20KQEAgLTM3MywyMiArNDkxLDIwIEBAIHN0YXRpYyBpbnQgdm1fZXZlbnRfcmluZ19n
ZXRfcmVzcG9uc2Uoc3RydWN0IHZtX2V2ZW50X3JpbmdfZG9tYWluICppbXBsLAogICogTm90ZTog
cmVzcG9uc2VzIGFyZSBoYW5kbGVkIHRoZSBzYW1lIHdheSByZWdhcmRsZXNzIG9mIHdoaWNoIHJp
bmcgdGhleQogICogYXJyaXZlIG9uLgogICovCi1zdGF0aWMgaW50IHZtX2V2ZW50X3JpbmdfcmVz
dW1lKHN0cnVjdCB2bV9ldmVudF9yaW5nX2RvbWFpbiAqaW1wbCkKK3N0YXRpYyBpbnQgdm1fZXZl
bnRfcmluZ19yZXN1bWUoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLCBzdHJ1Y3QgdmNwdSAq
dikKIHsKICAgICB2bV9ldmVudF9yZXNwb25zZV90IHJzcDsKLQotICAgIGlmICggdW5saWtlbHko
IWltcGwgfHwgIXZtX2V2ZW50X2NoZWNrKCZpbXBsLT52ZWQpKSApCi0gICAgICAgICByZXR1cm4g
LUVOT0RFVjsKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwgPSB0b19yaW5n
KHZlZCk7CiAKICAgICAvKgotICAgICAqIHZtX2V2ZW50X3Jlc3VtZSgpIHJ1bnMgaW4gZWl0aGVy
IFhFTl9WTV9FVkVOVF8qIGRvbWN0bHMsIG9yCisgICAgICogdm1fZXZlbnRfcmluZ19yZXN1bWUo
KSBydW5zIGluIGVpdGhlciBYRU5fVk1fRVZFTlRfKiBkb21jdGxzLCBvcgogICAgICAqIEVWVENI
Tl9zZW5kIGNvbnRleHQgZnJvbSB0aGUgaW50cm9zcGVjdGlvbiBjb25zdW1lci4gQm90aCBjb250
ZXh0cwogICAgICAqIGFyZSBndWFyYW50ZWVkIG5vdCB0byBiZSB0aGUgc3ViamVjdCBvZiB2bV9l
dmVudCByZXNwb25zZXMuCiAgICAgICogV2hpbGUgd2UgY291bGQgQVNTRVJUKHYgIT0gY3VycmVu
dCkgZm9yIGVhY2ggVkNQVSBpbiBkIGluIHRoZSBsb29wCiAgICAgICogYmVsb3csIHRoaXMgY292
ZXJzIHRoZSBjYXNlIHdoZXJlIHdlIHdvdWxkIG5lZWQgdG8gaXRlcmF0ZSBvdmVyIGFsbAogICAg
ICAqIG9mIHRoZW0gbW9yZSBzdWNjaW50bHkuCiAgICAgICovCi0gICAgQVNTRVJUKGltcGwtPnZl
ZC5kICE9IGN1cnJlbnQtPmRvbWFpbik7CisgICAgQVNTRVJUKHZlZC0+ZCAhPSBjdXJyZW50LT5k
b21haW4pOwogCiAgICAgLyogUHVsbCBhbGwgcmVzcG9uc2VzIG9mZiB0aGUgcmluZy4gKi8KICAg
ICB3aGlsZSAoIHZtX2V2ZW50X3JpbmdfZ2V0X3Jlc3BvbnNlKGltcGwsICZyc3ApICkKQEAgLTQw
Miw3ICs1MTgsNyBAQCBzdGF0aWMgaW50IHZtX2V2ZW50X3JpbmdfcmVzdW1lKHN0cnVjdCB2bV9l
dmVudF9yaW5nX2RvbWFpbiAqaW1wbCkKICAgICAgICAgfQogCiAgICAgICAgIC8qIFZhbGlkYXRl
IHRoZSB2Y3B1X2lkIGluIHRoZSByZXNwb25zZS4gKi8KLSAgICAgICAgdiA9IGRvbWFpbl92Y3B1
KGltcGwtPnZlZC5kLCByc3AudmNwdV9pZCk7CisgICAgICAgIHYgPSBkb21haW5fdmNwdSh2ZWQt
PmQsIHJzcC52Y3B1X2lkKTsKICAgICAgICAgaWYgKCAhdiApCiAgICAgICAgICAgICBjb250aW51
ZTsKIApAQCAtNDEwLDQ3ICs1MjYsNyBAQCBzdGF0aWMgaW50IHZtX2V2ZW50X3JpbmdfcmVzdW1l
KHN0cnVjdCB2bV9ldmVudF9yaW5nX2RvbWFpbiAqaW1wbCkKICAgICAgICAgICogSW4gc29tZSBj
YXNlcyB0aGUgcmVzcG9uc2UgdHlwZSBuZWVkcyBleHRyYSBoYW5kbGluZywgc28gaGVyZQogICAg
ICAgICAgKiB3ZSBjYWxsIHRoZSBhcHByb3ByaWF0ZSBoYW5kbGVycy4KICAgICAgICAgICovCi0K
LSAgICAgICAgLyogQ2hlY2sgZmxhZ3Mgd2hpY2ggYXBwbHkgb25seSB3aGVuIHRoZSB2Q1BVIGlz
IHBhdXNlZCAqLwotICAgICAgICBpZiAoIGF0b21pY19yZWFkKCZ2LT52bV9ldmVudF9wYXVzZV9j
b3VudCkgKQotICAgICAgICB7Ci0jaWZkZWYgQ09ORklHX0hBU19NRU1fUEFHSU5HCi0gICAgICAg
ICAgICBpZiAoIHJzcC5yZWFzb24gPT0gVk1fRVZFTlRfUkVBU09OX01FTV9QQUdJTkcgKQotICAg
ICAgICAgICAgICAgIHAybV9tZW1fcGFnaW5nX3Jlc3VtZShpbXBsLT52ZWQuZCwgJnJzcCk7Ci0j
ZW5kaWYKLQotICAgICAgICAgICAgLyoKLSAgICAgICAgICAgICAqIENoZWNrIGVtdWxhdGlvbiBm
bGFncyBpbiB0aGUgYXJjaC1zcGVjaWZpYyBoYW5kbGVyIG9ubHksIGFzIGl0Ci0gICAgICAgICAg
ICAgKiBoYXMgdG8gc2V0IGFyY2gtc3BlY2lmaWMgZmxhZ3Mgd2hlbiBzdXBwb3J0ZWQsIGFuZCB0
byBhdm9pZAotICAgICAgICAgICAgICogYml0bWFzayBvdmVyaGVhZCB3aGVuIGl0IGlzbid0IHN1
cHBvcnRlZC4KLSAgICAgICAgICAgICAqLwotICAgICAgICAgICAgdm1fZXZlbnRfZW11bGF0ZV9j
aGVjayh2LCAmcnNwKTsKLQotICAgICAgICAgICAgLyoKLSAgICAgICAgICAgICAqIENoZWNrIGlu
IGFyY2gtc3BlY2lmaWMgaGFuZGxlciB0byBhdm9pZCBiaXRtYXNrIG92ZXJoZWFkIHdoZW4KLSAg
ICAgICAgICAgICAqIG5vdCBzdXBwb3J0ZWQuCi0gICAgICAgICAgICAgKi8KLSAgICAgICAgICAg
IHZtX2V2ZW50X3JlZ2lzdGVyX3dyaXRlX3Jlc3VtZSh2LCAmcnNwKTsKLQotICAgICAgICAgICAg
LyoKLSAgICAgICAgICAgICAqIENoZWNrIGluIGFyY2gtc3BlY2lmaWMgaGFuZGxlciB0byBhdm9p
ZCBiaXRtYXNrIG92ZXJoZWFkIHdoZW4KLSAgICAgICAgICAgICAqIG5vdCBzdXBwb3J0ZWQuCi0g
ICAgICAgICAgICAgKi8KLSAgICAgICAgICAgIHZtX2V2ZW50X3RvZ2dsZV9zaW5nbGVzdGVwKGlt
cGwtPnZlZC5kLCB2LCAmcnNwKTsKLQotICAgICAgICAgICAgLyogQ2hlY2sgZm9yIGFsdHAybSBz
d2l0Y2ggKi8KLSAgICAgICAgICAgIGlmICggcnNwLmZsYWdzICYgVk1fRVZFTlRfRkxBR19BTFRF
Uk5BVEVfUDJNICkKLSAgICAgICAgICAgICAgICBwMm1fYWx0cDJtX2NoZWNrKHYsIHJzcC5hbHRw
Mm1faWR4KTsKLQotICAgICAgICAgICAgaWYgKCByc3AuZmxhZ3MgJiBWTV9FVkVOVF9GTEFHX1NF
VF9SRUdJU1RFUlMgKQotICAgICAgICAgICAgICAgIHZtX2V2ZW50X3NldF9yZWdpc3RlcnModiwg
JnJzcCk7Ci0KLSAgICAgICAgICAgIGlmICggcnNwLmZsYWdzICYgVk1fRVZFTlRfRkxBR19HRVRf
TkVYVF9JTlRFUlJVUFQgKQotICAgICAgICAgICAgICAgIHZtX2V2ZW50X21vbml0b3JfbmV4dF9p
bnRlcnJ1cHQodik7Ci0KLSAgICAgICAgICAgIGlmICggcnNwLmZsYWdzICYgVk1fRVZFTlRfRkxB
R19WQ1BVX1BBVVNFRCApCi0gICAgICAgICAgICAgICAgdm1fZXZlbnRfdmNwdV91bnBhdXNlKHYp
OwotICAgICAgICB9CisgICAgICAgIHZtX2V2ZW50X2hhbmRsZV9yZXNwb25zZSh2ZWQtPmQsIHYs
ICZyc3ApOwogICAgIH0KIAogICAgIHJldHVybiAwOwpAQCAtNTM1LDU5ICs2MTEsMzYxIEBAIHN0
YXRpYyBpbnQgdm1fZXZlbnRfcmluZ19jbGFpbV9zbG90KHN0cnVjdCB2bV9ldmVudF9kb21haW4g
KnZlZCwgYm9vbCBhbGxvd19zbGVlCiAgICAgICAgIHJldHVybiB2bV9ldmVudF9yaW5nX2dyYWJf
c2xvdCh0b19yaW5nKHZlZCksIGN1cnJlbnQtPmRvbWFpbiAhPSB2ZWQtPmQpOwogfQogCi0jaWZk
ZWYgQ09ORklHX0hBU19NRU1fUEFHSU5HCi0vKiBSZWdpc3RlcmVkIHdpdGggWGVuLWJvdW5kIGV2
ZW50IGNoYW5uZWwgZm9yIGluY29taW5nIG5vdGlmaWNhdGlvbnMuICovCi1zdGF0aWMgdm9pZCBt
ZW1fcGFnaW5nX25vdGlmaWNhdGlvbihzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgaW50IHBvcnQp
CitzdGF0aWMgdm9pZCB2bV9ldmVudF9yaW5nX2NsZWFudXAoc3RydWN0IHZtX2V2ZW50X2RvbWFp
biAqdmVkKQogewotICAgIHZtX2V2ZW50X3JpbmdfcmVzdW1lKHRvX3Jpbmcodi0+ZG9tYWluLT52
bV9ldmVudF9wYWdpbmcpKTsKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwg
PSB0b19yaW5nKHZlZCk7CisgICAgLyogRGVzdHJveWluZyB0aGUgd2FpdCBxdWV1ZSBoZWFkIG1l
YW5zIHdha2luZyB1cCBhbGwKKyAgICAgKiBxdWV1ZWQgdmNwdXMuIFRoaXMgd2lsbCBkcmFpbiB0
aGUgbGlzdCwgYWxsb3dpbmcKKyAgICAgKiB0aGUgZGlzYWJsZSByb3V0aW5lIHRvIGNvbXBsZXRl
LiBJdCB3aWxsIGFsc28gZHJvcAorICAgICAqIGFsbCBkb21haW4gcmVmcyB0aGUgd2FpdC1xdWV1
ZWQgdmNwdXMgYXJlIGhvbGRpbmcuCisgICAgICogRmluYWxseSwgYmVjYXVzZSB0aGlzIGNvZGUg
cGF0aCBpbnZvbHZlcyBwcmV2aW91c2x5CisgICAgICogcGF1c2luZyB0aGUgZG9tYWluIChkb21h
aW5fa2lsbCksIHVucGF1c2luZyB0aGUKKyAgICAgKiB2Y3B1cyBjYXVzZXMgbm8gaGFybS4gKi8K
KyAgICBkZXN0cm95X3dhaXRxdWV1ZV9oZWFkKCZpbXBsLT53cSk7CiB9Ci0jZW5kaWYKIAotLyog
UmVnaXN0ZXJlZCB3aXRoIFhlbi1ib3VuZCBldmVudCBjaGFubmVsIGZvciBpbmNvbWluZyBub3Rp
ZmljYXRpb25zLiAqLwotc3RhdGljIHZvaWQgbW9uaXRvcl9ub3RpZmljYXRpb24oc3RydWN0IHZj
cHUgKnYsIHVuc2lnbmVkIGludCBwb3J0KQorLyoKKyAqIFZNIGV2ZW50IE5HIChuZXcgZ2VuZXJh
dGlvbikKKyAqLworI2RlZmluZSB0b19jaGFubmVscyhfdmVkKSBjb250YWluZXJfb2YoKF92ZWQp
LCBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZtX2V2
ZW50X2NoYW5uZWxzX2RvbWFpbiwgdmVkKQorCitzdHJ1Y3Qgdm1fZXZlbnRfY2hhbm5lbHNfZG9t
YWluCit7CisgICAgLyogVk0gZXZlbnQgZG9tYWluICovCisgICAgc3RydWN0IHZtX2V2ZW50X2Rv
bWFpbiB2ZWQ7CisgICAgLyogc2hhcmVkIGNoYW5uZWxzIGJ1ZmZlciAqLworICAgIHN0cnVjdCB2
bV9ldmVudF9zbG90ICpzbG90czsKKyAgICAvKiB0aGUgYnVmZmVyIHNpemUgKG51bWJlciBvZiBm
cmFtZXMpICovCisgICAgdW5zaWduZWQgaW50IG5yX2ZyYW1lczsKKyAgICAvKiBidWZmZXIncyBt
bmYgbGlzdCAqLworICAgIG1mbl90IG1mblswXTsKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
dm1fZXZlbnRfb3BzIHZtX2V2ZW50X2NoYW5uZWxzX29wczsKKworc3RhdGljIHZvaWQgdm1fZXZl
bnRfY2hhbm5lbHNfZnJlZV9idWZmZXIoc3RydWN0IHZtX2V2ZW50X2NoYW5uZWxzX2RvbWFpbiAq
aW1wbCkKIHsKLSAgICB2bV9ldmVudF9yaW5nX3Jlc3VtZSh0b19yaW5nKHYtPmRvbWFpbi0+dm1f
ZXZlbnRfbW9uaXRvcikpOworICAgIGludCBpOworCisgICAgdnVubWFwKGltcGwtPnNsb3RzKTsK
KyAgICBpbXBsLT5zbG90cyA9IE5VTEw7CisKKyAgICBmb3IgKCBpID0gMDsgaSA8IGltcGwtPm5y
X2ZyYW1lczsgaSsrICkKKyAgICAgICAgZnJlZV9kb21oZWFwX3BhZ2UobWZuX3RvX3BhZ2UoaW1w
bC0+bWZuW2ldKSk7CiB9CiAKLSNpZmRlZiBDT05GSUdfSEFTX01FTV9TSEFSSU5HCi0vKiBSZWdp
c3RlcmVkIHdpdGggWGVuLWJvdW5kIGV2ZW50IGNoYW5uZWwgZm9yIGluY29taW5nIG5vdGlmaWNh
dGlvbnMuICovCi1zdGF0aWMgdm9pZCBtZW1fc2hhcmluZ19ub3RpZmljYXRpb24oc3RydWN0IHZj
cHUgKnYsIHVuc2lnbmVkIGludCBwb3J0KQorc3RhdGljIGludCB2bV9ldmVudF9jaGFubmVsc19h
bGxvY19idWZmZXIoc3RydWN0IHZtX2V2ZW50X2NoYW5uZWxzX2RvbWFpbiAqaW1wbCkKIHsKLSAg
ICB2bV9ldmVudF9yaW5nX3Jlc3VtZSh0b19yaW5nKHYtPmRvbWFpbi0+dm1fZXZlbnRfc2hhcmUp
KTsKKyAgICBpbnQgaSA9IDA7CisKKyAgICBpbXBsLT5zbG90cyA9IHZ6YWxsb2MoaW1wbC0+bnJf
ZnJhbWVzICogUEFHRV9TSVpFKTsKKyAgICBpZiAoICFpbXBsLT5zbG90cyApCisgICAgICAgIHJl
dHVybiAtRU5PTUVNOworCisgICAgZm9yICggaSA9IDA7IGkgPCBpbXBsLT5ucl9mcmFtZXM7IGkr
KyApCisgICAgICAgIGltcGwtPm1mbltpXSA9IHZtYXBfdG9fbWZuKGltcGwtPnNsb3RzICsgaSAq
IFBBR0VfU0laRSk7CisKKyAgICBmb3IgKCBpID0gMDsgaSA8IGltcGwtPm5yX2ZyYW1lczsgaSsr
ICkKKyAgICAgICAgc2hhcmVfeGVuX3BhZ2Vfd2l0aF9ndWVzdChtZm5fdG9fcGFnZShpbXBsLT5t
Zm5baV0pLCBjdXJyZW50LT5kb21haW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgU0hBUkVfcncpOworCisgICAgcmV0dXJuIDA7CiB9CisKK3N0YXRpYyBpbnQgdm1fZXZlbnRf
Y2hhbm5lbHNfZW5hYmxlKAorICAgIHN0cnVjdCBkb21haW4gKmQsCisgICAgc3RydWN0IHhlbl9k
b21jdGxfdm1fZXZlbnRfb3AgKnZlYywKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICoqcF92
ZWQpCit7CisgICAgaW50IHJjLCBpID0gMDsKKyAgICB4ZW5fZXZlbnRfY2hhbm5lbF9ub3RpZmlj
YXRpb25fdCBmbiA9IHZtX2V2ZW50X25vdGlmaWNhdGlvbl9mbih2ZWMtPnR5cGUpOworICAgIHVu
c2lnbmVkIGludCBucl9mcmFtZXMgPSBQRk5fVVAoZC0+bWF4X3ZjcHVzICogc2l6ZW9mKHN0cnVj
dCB2bV9ldmVudF9zbG90KSk7CisgICAgc3RydWN0IHZtX2V2ZW50X2NoYW5uZWxzX2RvbWFpbiAq
aW1wbDsKKworICAgIGlmICggKnBfdmVkICkKKyAgICAgICAgcmV0dXJuIC1FQlVTWTsKKworICAg
IGltcGwgPSBfeHphbGxvYyhzaXplb2Yoc3RydWN0IHZtX2V2ZW50X2NoYW5uZWxzX2RvbWFpbikg
KworICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJfZnJhbWVzICogc2l6ZW9mKG1mbl90KSwK
KyAgICAgICAgICAgICAgICAgICAgX19hbGlnbm9mX18oc3RydWN0IHZtX2V2ZW50X2NoYW5uZWxz
X2RvbWFpbikpOworICAgIGlmICggdW5saWtlbHkoIWltcGwpICkKKyAgICAgICAgcmV0dXJuIC1F
Tk9NRU07CisKKyAgICBzcGluX2xvY2tfaW5pdCgmaW1wbC0+dmVkLmxvY2spOworCisgICAgaW1w
bC0+bnJfZnJhbWVzID0gbnJfZnJhbWVzOworICAgIGltcGwtPnZlZC5kID0gZDsKKyAgICBpbXBs
LT52ZWQub3BzID0gJnZtX2V2ZW50X2NoYW5uZWxzX29wczsKKworICAgIHJjID0gdm1fZXZlbnRf
aW5pdF9kb21haW4oZCk7CisgICAgaWYgKCByYyA8IDAgKQorICAgICAgICBnb3RvIGVycjsKKwor
ICAgIHJjID0gdm1fZXZlbnRfY2hhbm5lbHNfYWxsb2NfYnVmZmVyKGltcGwpOworICAgIGlmICgg
cmMgKQorICAgICAgICBnb3RvIGVycjsKKworICAgIGZvciAoIGkgPSAwOyBpIDwgZC0+bWF4X3Zj
cHVzOyBpKysgKQorICAgIHsKKyAgICAgICAgcmMgPSBhbGxvY191bmJvdW5kX3hlbl9ldmVudF9j
aGFubmVsKGQsIGksIGN1cnJlbnQtPmRvbWFpbi0+ZG9tYWluX2lkLCBmbik7CisgICAgICAgIGlm
ICggcmMgPCAwICkKKyAgICAgICAgICAgIGdvdG8gZXJyOworCisgICAgICAgIGltcGwtPnNsb3Rz
W2ldLnBvcnQgPSByYzsKKyAgICAgICAgaW1wbC0+c2xvdHNbaV0uc3RhdGUgPSBTVEFURV9WTV9F
VkVOVF9TTE9UX0lETEU7CisgICAgfQorCisgICAgKnBfdmVkID0gJmltcGwtPnZlZDsKKworICAg
IHJldHVybiAwOworCitlcnI6CisgICAgd2hpbGUgKCAtLWkgPj0gMCApCisgICAgICAgIGV2dGNo
bl9jbG9zZShkLCBpbXBsLT5zbG90c1tpXS5wb3J0LCAwKTsKKyAgICB4ZnJlZShpbXBsKTsKKwor
ICAgIHJldHVybiByYzsKK30KKworc3RhdGljIGludCB2bV9ldmVudF9jaGFubmVsc19kaXNhYmxl
KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKipwX3ZlZCkKK3sKKyAgICBzdHJ1Y3QgdmNwdSAqdjsK
KyAgICBzdHJ1Y3QgZG9tYWluICpkID0gKCpwX3ZlZCktPmQ7CisgICAgc3RydWN0IHZtX2V2ZW50
X2NoYW5uZWxzX2RvbWFpbiAqaW1wbCA9IHRvX2NoYW5uZWxzKCpwX3ZlZCk7CisgICAgaW50IGk7
CisKKyAgICBzcGluX2xvY2soJmltcGwtPnZlZC5sb2NrKTsKKworICAgIGZvcl9lYWNoX3ZjcHUo
IGltcGwtPnZlZC5kLCB2ICkKKyAgICB7CisgICAgICAgIGlmICggYXRvbWljX3JlYWQoJnYtPnZt
X2V2ZW50X3BhdXNlX2NvdW50KSApCisgICAgICAgICAgICB2bV9ldmVudF92Y3B1X3VucGF1c2Uo
dik7CisgICAgfQorCisgICAgZm9yICggaSA9IDA7IGkgPCBpbXBsLT52ZWQuZC0+bWF4X3ZjcHVz
OyBpKysgKQorICAgICAgICBldnRjaG5fY2xvc2UoaW1wbC0+dmVkLmQsIGltcGwtPnNsb3RzW2ld
LnBvcnQsIDApOworCisgICAgdm1fZXZlbnRfY2hhbm5lbHNfZnJlZV9idWZmZXIoaW1wbCk7CisK
KyAgICB2bV9ldmVudF9jbGVhbnVwX2RvbWFpbihkKTsKKworICAgIHNwaW5fdW5sb2NrKCZpbXBs
LT52ZWQubG9jayk7CisKKyAgICB4ZnJlZShpbXBsKTsKKyAgICAqcF92ZWQgPSBOVUxMOworCisg
ICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBib29sIHZtX2V2ZW50X2NoYW5uZWxzX2NoZWNrKHN0
cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKK3sKKyAgICByZXR1cm4gdG9fY2hhbm5lbHModmVk
KS0+c2xvdHMgIT0gTlVMTDsKK30KKworc3RhdGljIHZvaWQgdm1fZXZlbnRfY2hhbm5lbHNfY2xl
YW51cChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpCit7Cit9CisKK3N0YXRpYyBpbnQgdm1f
ZXZlbnRfY2hhbm5lbHNfY2xhaW1fc2xvdChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBhbGxvd19zbGVlcCkK
K3sKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgdm1fZXZlbnRfY2hhbm5lbHNfY2Fu
Y2VsX3Nsb3Qoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKQoreworfQorCitzdGF0aWMgdm9p
ZCB2bV9ldmVudF9jaGFubmVsc19wdXRfcmVxdWVzdChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2
ZWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bV9ldmVudF9y
ZXF1ZXN0X3QgKnJlcSkKK3sKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfY2hhbm5lbHNfZG9tYWluICpp
bXBsID0gdG9fY2hhbm5lbHModmVkKTsKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfc2xvdCAqc2xvdDsK
KworICAgIEFTU0VSVCggcmVxLT52Y3B1X2lkID49IDAgJiYgcmVxLT52Y3B1X2lkIDwgdmVkLT5k
LT5tYXhfdmNwdXMgKTsKKworICAgIHNsb3QgPSAmaW1wbC0+c2xvdHNbcmVxLT52Y3B1X2lkXTsK
KworICAgIGlmICggY3VycmVudC0+ZG9tYWluICE9IHZlZC0+ZCApCisgICAgeworICAgICAgICBy
ZXEtPmZsYWdzIHw9IFZNX0VWRU5UX0ZMQUdfRk9SRUlHTjsKKyNpZm5kZWYgTkRFQlVHCisgICAg
ICAgIGlmICggIShyZXEtPmZsYWdzICYgVk1fRVZFTlRfRkxBR19WQ1BVX1BBVVNFRCkgKQorICAg
ICAgICAgICAgZ2RwcmludGsoWEVOTE9HX0dfV0FSTklORywgImQlZHYlZCB3YXMgbm90IHBhdXNl
ZC5cbiIsCisgICAgICAgICAgICAgICAgICAgICB2ZWQtPmQtPmRvbWFpbl9pZCwgcmVxLT52Y3B1
X2lkKTsKICNlbmRpZgorICAgIH0KKworICAgIHJlcS0+dmVyc2lvbiA9IFZNX0VWRU5UX0lOVEVS
RkFDRV9WRVJTSU9OOworCisgICAgc3Bpbl9sb2NrKCZpbXBsLT52ZWQubG9jayk7CisgICAgaWYg
KCBzbG90LT5zdGF0ZSAhPSBTVEFURV9WTV9FVkVOVF9TTE9UX0lETEUgKQorICAgIHsKKyAgICAg
ICAgZ2RwcmludGsoWEVOTE9HX0dfV0FSTklORywgIlRoZSBWTSBldmVudCBzbG90IGZvciBkJWR2
JWQgaXMgbm90IElETEUuXG4iLAorICAgICAgICAgICAgICAgICBpbXBsLT52ZWQuZC0+ZG9tYWlu
X2lkLCByZXEtPnZjcHVfaWQpOworICAgICAgICBzcGluX3VubG9jaygmaW1wbC0+dmVkLmxvY2sp
OworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgc2xvdC0+dS5yZXEgPSAqcmVxOworICAg
IHNsb3QtPnN0YXRlID0gU1RBVEVfVk1fRVZFTlRfU0xPVF9TVUJNSVQ7CisgICAgc3Bpbl91bmxv
Y2soJmltcGwtPnZlZC5sb2NrKTsKKyAgICBub3RpZnlfdmlhX3hlbl9ldmVudF9jaGFubmVsKGlt
cGwtPnZlZC5kLCBzbG90LT5wb3J0KTsKK30KKworc3RhdGljIGludCB2bV9ldmVudF9jaGFubmVs
c19nZXRfcmVzcG9uc2Uoc3RydWN0IHZtX2V2ZW50X2NoYW5uZWxzX2RvbWFpbiAqaW1wbCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1ICp2LCB2
bV9ldmVudF9yZXNwb25zZV90ICpyc3ApCit7CisgICAgc3RydWN0IHZtX2V2ZW50X3Nsb3QgKnNs
b3QgPSAmaW1wbC0+c2xvdHNbdi0+dmNwdV9pZF07CisgICAgaW50IHJjID0gMDsKKworICAgIEFT
U0VSVCggc2xvdCAhPSBOVUxMICk7CisgICAgc3Bpbl9sb2NrKCZpbXBsLT52ZWQubG9jayk7CisK
KyAgICBpZiAoIHNsb3QtPnN0YXRlICE9IFNUQVRFX1ZNX0VWRU5UX1NMT1RfRklOSVNIICkKKyAg
ICB7CisgICAgICAgIGdkcHJpbnRrKFhFTkxPR19HX1dBUk5JTkcsICJUaGUgVk0gZXZlbnQgc2xv
dCBzdGF0ZSBmb3IgZCVkdiVkIGlzIGludmFsaWQuXG4iLAorICAgICAgICAgICAgICAgICBpbXBs
LT52ZWQuZC0+ZG9tYWluX2lkLCB2LT52Y3B1X2lkKTsKKyAgICAgICAgcmMgPSAtMTsKKyAgICAg
ICAgZ290byBvdXQ7CisgICAgfQorCisgICAgKnJzcCA9IHNsb3QtPnUucnNwOworICAgIHNsb3Qt
PnN0YXRlID0gU1RBVEVfVk1fRVZFTlRfU0xPVF9JRExFOworCitvdXQ6CisgICAgc3Bpbl91bmxv
Y2soJmltcGwtPnZlZC5sb2NrKTsKKworICAgIHJldHVybiByYzsKK30KKworc3RhdGljIGludCB2
bV9ldmVudF9jaGFubmVsc19yZXN1bWUoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLCBzdHJ1
Y3QgdmNwdSAqdikKK3sKKyAgICB2bV9ldmVudF9yZXNwb25zZV90IHJzcDsKKyAgICBzdHJ1Y3Qg
dm1fZXZlbnRfY2hhbm5lbHNfZG9tYWluICppbXBsID0gdG9fY2hhbm5lbHModmVkKTsKKworICAg
IEFTU0VSVCh2ZWQtPmQgIT0gY3VycmVudC0+ZG9tYWluKTsKKworICAgIGlmICggdm1fZXZlbnRf
Y2hhbm5lbHNfZ2V0X3Jlc3BvbnNlKGltcGwsIHYsICZyc3ApIHx8CisgICAgICAgICByc3AudmVy
c2lvbiAhPSBWTV9FVkVOVF9JTlRFUkZBQ0VfVkVSU0lPTiB8fAorICAgICAgICAgcnNwLnZjcHVf
aWQgIT0gdi0+dmNwdV9pZCApCisgICAgICAgIHJldHVybiAtMTsKKworICAgIHZtX2V2ZW50X2hh
bmRsZV9yZXNwb25zZSh2ZWQtPmQsIHYsICZyc3ApOworCisgICAgcmV0dXJuIDA7Cit9CisKK2lu
dCB2bV9ldmVudF9uZ19nZXRfZnJhbWVzKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGludCBp
ZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgZnJhbWUsIHVuc2ln
bmVkIGludCBucl9mcmFtZXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5fcGZuX3Qg
bWZuX2xpc3RbXSkKK3sKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQ7CisgICAgaW50
IGk7CisKKyAgICBzd2l0Y2ggKGlkICkKKyAgICB7CisgICAgY2FzZSBYRU5fVk1fRVZFTlRfVFlQ
RV9NT05JVE9SOgorICAgICAgICB2ZWQgPSBkLT52bV9ldmVudF9tb25pdG9yOworICAgICAgICBi
cmVhazsKKworICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAtRU5PU1lTOworICAgIH0KKwor
ICAgIGlmICggIXZtX2V2ZW50X2NoZWNrKHZlZCkgKQorICAgICAgICByZXR1cm4gLUVJTlZBTDsK
KworICAgIGlmICggZnJhbWUgIT0gMCB8fCBucl9mcmFtZXMgIT0gdG9fY2hhbm5lbHModmVkKS0+
bnJfZnJhbWVzICkKKyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisKKyAgICBzcGluX2xvY2soJnZl
ZC0+bG9jayk7CisKKyAgICBmb3IgKCBpID0gMDsgaSA8IHRvX2NoYW5uZWxzKHZlZCktPm5yX2Zy
YW1lczsgaSsrICkKKyAgICAgICAgbWZuX2xpc3RbaV0gPSBtZm5feCh0b19jaGFubmVscyh2ZWQp
LT5tZm5baV0pOworCisgICAgc3Bpbl91bmxvY2soJnZlZC0+bG9jayk7CisKKyAgICByZXR1cm4g
MDsKK30KKworLyoKKyAqIHZtX2V2ZW50IGltcGxlbWVudGF0aW9uIGFnbm9zdGljIGZ1bmN0aW9u
cworICovCiAKIC8qIENsZWFuIHVwIG9uIGRvbWFpbiBkZXN0cnVjdGlvbiAqLwogdm9pZCB2bV9l
dmVudF9jbGVhbnVwKHN0cnVjdCBkb21haW4gKmQpCiB7CiAjaWZkZWYgQ09ORklHX0hBU19NRU1f
UEFHSU5HCiAgICAgaWYgKCB2bV9ldmVudF9jaGVjayhkLT52bV9ldmVudF9wYWdpbmcpICkKLSAg
ICAgICAgZC0+dm1fZXZlbnRfcGFnaW5nLT5vcHMtPmNsZWFudXAoJmQtPnZtX2V2ZW50X3BhZ2lu
Zyk7CisgICAgeworICAgICAgICBkLT52bV9ldmVudF9wYWdpbmctPm9wcy0+Y2xlYW51cChkLT52
bV9ldmVudF9wYWdpbmcpOworICAgICAgICBkLT52bV9ldmVudF9wYWdpbmctPm9wcy0+ZGlzYWJs
ZSgmZC0+dm1fZXZlbnRfcGFnaW5nKTsKKyAgICB9CiAjZW5kaWYKIAogICAgIGlmICggdm1fZXZl
bnRfY2hlY2soZC0+dm1fZXZlbnRfbW9uaXRvcikgKQotICAgICAgICBkLT52bV9ldmVudF9tb25p
dG9yLT5vcHMtPmNsZWFudXAoJmQtPnZtX2V2ZW50X21vbml0b3IpOworICAgIHsKKyAgICAgICAg
ZC0+dm1fZXZlbnRfbW9uaXRvci0+b3BzLT5jbGVhbnVwKGQtPnZtX2V2ZW50X21vbml0b3IpOwor
ICAgICAgICBkLT52bV9ldmVudF9tb25pdG9yLT5vcHMtPmRpc2FibGUoJmQtPnZtX2V2ZW50X21v
bml0b3IpOworICAgIH0KIAogI2lmZGVmIENPTkZJR19IQVNfTUVNX1NIQVJJTkcKICAgICBpZiAo
IHZtX2V2ZW50X2NoZWNrKGQtPnZtX2V2ZW50X3NoYXJlKSApCi0gICAgICAgIGQtPnZtX2V2ZW50
X3NoYXJlLT5vcHMtPmNsZWFudXAoJmQtPnZtX2V2ZW50X3NoYXJlKTsKKyAgICB7CisgICAgICAg
IGQtPnZtX2V2ZW50X3NoYXJlLT5vcHMtPmNsZWFudXAoZC0+dm1fZXZlbnRfc2hhcmUpOworICAg
ICAgICBkLT52bV9ldmVudF9zaGFyZS0+b3BzLT5kaXNhYmxlKCZkLT52bV9ldmVudF9zaGFyZSk7
CisgICAgfQogI2VuZGlmCiB9CiAKLXN0YXRpYyB2b2lkIHZtX2V2ZW50X3JpbmdfY2xlYW51cChz
dHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICoqX3ZlZCkKK3N0YXRpYyBpbnQgdm1fZXZlbnRfZW5hYmxl
KHN0cnVjdCBkb21haW4gKmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVu
X2RvbWN0bF92bV9ldmVudF9vcCAqdmVjLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHZtX2V2ZW50X2RvbWFpbiAqKnBfdmVkKQogewotICAgIHN0cnVjdCB2bV9ldmVudF9yaW5n
X2RvbWFpbiAqaW1wbCA9IHRvX3JpbmcoKl92ZWQpOwotICAgIC8qIERlc3Ryb3lpbmcgdGhlIHdh
aXQgcXVldWUgaGVhZCBtZWFucyB3YWtpbmcgdXAgYWxsCi0gICAgICogcXVldWVkIHZjcHVzLiBU
aGlzIHdpbGwgZHJhaW4gdGhlIGxpc3QsIGFsbG93aW5nCi0gICAgICogdGhlIGRpc2FibGUgcm91
dGluZSB0byBjb21wbGV0ZS4gSXQgd2lsbCBhbHNvIGRyb3AKLSAgICAgKiBhbGwgZG9tYWluIHJl
ZnMgdGhlIHdhaXQtcXVldWVkIHZjcHVzIGFyZSBob2xkaW5nLgotICAgICAqIEZpbmFsbHksIGJl
Y2F1c2UgdGhpcyBjb2RlIHBhdGggaW52b2x2ZXMgcHJldmlvdXNseQotICAgICAqIHBhdXNpbmcg
dGhlIGRvbWFpbiAoZG9tYWluX2tpbGwpLCB1bnBhdXNpbmcgdGhlCi0gICAgICogdmNwdXMgY2F1
c2VzIG5vIGhhcm0uICovCi0gICAgZGVzdHJveV93YWl0cXVldWVfaGVhZCgmaW1wbC0+d3EpOwot
ICAgICh2b2lkKXZtX2V2ZW50X3JpbmdfZGlzYWJsZShfdmVkKTsKKyAgICByZXR1cm4gKCB2ZWMt
PmZsYWdzICYgWEVOX1ZNX0VWRU5UX0ZMQUdTX05HX09QICkgPworICAgICAgICB2bV9ldmVudF9j
aGFubmVsc19lbmFibGUoZCwgdmVjLCBwX3ZlZCkgOgorICAgICAgICB2bV9ldmVudF9yaW5nX2Vu
YWJsZShkLCB2ZWMsIHBfdmVkKTsKIH0KIAorc3RhdGljIGludCB2bV9ldmVudF9yZXN1bWUoc3Ry
dWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLCBzdHJ1Y3QgdmNwdSAqdikKK3sKKyAgICBpZiAoICF2
bV9ldmVudF9jaGVjayh2ZWQpICkKKyAgICAgICAgIHJldHVybiAtRU5PREVWOworCisgICAgaWYg
KCAhdiApCisgICAgICAgIHJldHVybiAtRUlOVkFMOworCisgICAgcmV0dXJuIHZlZC0+b3BzLT5y
ZXN1bWUodmVkLCB2KTsKK30KKworI2lmZGVmIENPTkZJR19IQVNfTUVNX1BBR0lORworLyogUmVn
aXN0ZXJlZCB3aXRoIFhlbi1ib3VuZCBldmVudCBjaGFubmVsIGZvciBpbmNvbWluZyBub3RpZmlj
YXRpb25zLiAqLworc3RhdGljIHZvaWQgbWVtX3BhZ2luZ19ub3RpZmljYXRpb24oc3RydWN0IHZj
cHUgKnYsIHVuc2lnbmVkIGludCBwb3J0KQoreworICAgIHZtX2V2ZW50X3Jlc3VtZSh2LT5kb21h
aW4tPnZtX2V2ZW50X3BhZ2luZywgdik7Cit9CisjZW5kaWYKKworLyogUmVnaXN0ZXJlZCB3aXRo
IFhlbi1ib3VuZCBldmVudCBjaGFubmVsIGZvciBpbmNvbWluZyBub3RpZmljYXRpb25zLiAqLwor
c3RhdGljIHZvaWQgbW9uaXRvcl9ub3RpZmljYXRpb24oc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVk
IGludCBwb3J0KQoreworICAgIHZtX2V2ZW50X3Jlc3VtZSh2LT5kb21haW4tPnZtX2V2ZW50X21v
bml0b3IsIHYpOworfQorCisjaWZkZWYgQ09ORklHX0hBU19NRU1fU0hBUklORworLyogUmVnaXN0
ZXJlZCB3aXRoIFhlbi1ib3VuZCBldmVudCBjaGFubmVsIGZvciBpbmNvbWluZyBub3RpZmljYXRp
b25zLiAqLworc3RhdGljIHZvaWQgbWVtX3NoYXJpbmdfbm90aWZpY2F0aW9uKHN0cnVjdCB2Y3B1
ICp2LCB1bnNpZ25lZCBpbnQgcG9ydCkKK3sKKyAgICB2bV9ldmVudF9yZXN1bWUodi0+ZG9tYWlu
LT52bV9ldmVudF9zaGFyZSwgdik7Cit9CisjZW5kaWYKKworLyoKKyAqIHZtX2V2ZW50IGRvbWN0
bCBpbnRlcmZhY2UKKyAqLworCiBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0cnVjdCBkb21haW4gKmQs
IHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMpCiB7CiAgICAgaW50IHJjOwpAQCAt
NjMyLDYgKzEwMTAsMTMgQEAgaW50IHZtX2V2ZW50X2RvbWN0bChzdHJ1Y3QgZG9tYWluICpkLCBz
dHJ1Y3QgeGVuX2RvbWN0bF92bV9ldmVudF9vcCAqdmVjKQogICAgIHsKICAgICAgICAgcmMgPSAt
RUlOVkFMOwogCisgICAgICAgIC8qCisgICAgICAgICAqIFRoZSBORyBpbnRlcmZhY2UgaXMgb25s
eSBzdXBwb3J0ZWQgYnkgWEVOX1ZNX0VWRU5UX1RZUEVfTU9OSVRPUgorICAgICAgICAgKiBmb3Ig
bm93LgorICAgICAgICAgKi8KKyAgICAgICAgaWYgKCB2ZWMtPmZsYWdzICYgWEVOX1ZNX0VWRU5U
X0ZMQUdTX05HX09QICkKKyAgICAgICAgICAgIGJyZWFrOworCiAgICAgICAgIHN3aXRjaCggdmVj
LT5vcCApCiAgICAgICAgIHsKICAgICAgICAgY2FzZSBYRU5fVk1fRVZFTlRfRU5BQkxFOgpAQCAt
NjU3LDkgKzEwNDIsNyBAQCBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0cnVjdCBkb21haW4gKmQsIHN0
cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMpCiAgICAgICAgICAgICAgICAgYnJlYWs7
CiAKICAgICAgICAgICAgIC8qIGRvbWFpbl9wYXVzZSgpIG5vdCByZXF1aXJlZCBoZXJlLCBzZWUg
WFNBLTk5ICovCi0gICAgICAgICAgICByYyA9IHZtX2V2ZW50X3JpbmdfZW5hYmxlKGQsIHZlYywg
JmQtPnZtX2V2ZW50X3BhZ2luZywgX1ZQRl9tZW1fcGFnaW5nLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSFZNX1BBUkFNX1BBR0lOR19SSU5HX1BGTiwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1lbV9wYWdpbmdfbm90aWZpY2F0aW9uKTsKKyAgICAgICAgICAg
IHJjID0gdm1fZXZlbnRfZW5hYmxlKGQsIHZlYywgJmQtPnZtX2V2ZW50X3BhZ2luZyk7CiAgICAg
ICAgIH0KICAgICAgICAgYnJlYWs7CiAKQEAgLTY2NywxMiArMTA1MCwxMyBAQCBpbnQgdm1fZXZl
bnRfZG9tY3RsKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29w
ICp2ZWMpCiAgICAgICAgICAgICBpZiAoICF2bV9ldmVudF9jaGVjayhkLT52bV9ldmVudF9wYWdp
bmcpICkKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgIGRvbWFpbl9wYXVzZShk
KTsKLSAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmluZ19kaXNhYmxlKCZkLT52bV9ldmVudF9w
YWdpbmcpOworICAgICAgICAgICAgcmMgPSBkLT52bV9ldmVudF9wYWdpbmctPm9wcy0+ZGlzYWJs
ZSgmZC0+dm1fZXZlbnRfcGFnaW5nKTsKICAgICAgICAgICAgIGRvbWFpbl91bnBhdXNlKGQpOwog
ICAgICAgICAgICAgYnJlYWs7CiAKICAgICAgICAgY2FzZSBYRU5fVk1fRVZFTlRfUkVTVU1FOgot
ICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9yaW5nX3Jlc3VtZSh0b19yaW5nKGQtPnZtX2V2ZW50
X3BhZ2luZykpOworICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9yZXN1bWUoZC0+dm1fZXZlbnRf
cGFnaW5nLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWluX3ZjcHUoZCwg
dmVjLT51LnJlc3VtZS52Y3B1X2lkKSk7CiAgICAgICAgICAgICBicmVhazsKIAogICAgICAgICBk
ZWZhdWx0OgpAQCAtNjk0LDIyICsxMDc4LDIzIEBAIGludCB2bV9ldmVudF9kb21jdGwoc3RydWN0
IGRvbWFpbiAqZCwgc3RydWN0IHhlbl9kb21jdGxfdm1fZXZlbnRfb3AgKnZlYykKICAgICAgICAg
ICAgIHJjID0gYXJjaF9tb25pdG9yX2luaXRfZG9tYWluKGQpOwogICAgICAgICAgICAgaWYgKCBy
YyApCiAgICAgICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgICAgICByYyA9IHZtX2V2ZW50X3Jp
bmdfZW5hYmxlKGQsIHZlYywgJmQtPnZtX2V2ZW50X21vbml0b3IsIF9WUEZfbWVtX2FjY2VzcywK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhWTV9QQVJBTV9NT05JVE9SX1JJTkdf
UEZOLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9uaXRvcl9ub3RpZmljYXRp
b24pOworCisgICAgICAgICAgICByYyA9IHZtX2V2ZW50X2VuYWJsZShkLCB2ZWMsICZkLT52bV9l
dmVudF9tb25pdG9yKTsKKwogICAgICAgICAgICAgYnJlYWs7CiAKICAgICAgICAgY2FzZSBYRU5f
Vk1fRVZFTlRfRElTQUJMRToKICAgICAgICAgICAgIGlmICggIXZtX2V2ZW50X2NoZWNrKGQtPnZt
X2V2ZW50X21vbml0b3IpICkKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgIGRv
bWFpbl9wYXVzZShkKTsKLSAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmluZ19kaXNhYmxlKCZk
LT52bV9ldmVudF9tb25pdG9yKTsKKyAgICAgICAgICAgIHJjID0gZC0+dm1fZXZlbnRfbW9uaXRv
ci0+b3BzLT5kaXNhYmxlKCZkLT52bV9ldmVudF9tb25pdG9yKTsKICAgICAgICAgICAgIGFyY2hf
bW9uaXRvcl9jbGVhbnVwX2RvbWFpbihkKTsKICAgICAgICAgICAgIGRvbWFpbl91bnBhdXNlKGQp
OwogICAgICAgICAgICAgYnJlYWs7CiAKICAgICAgICAgY2FzZSBYRU5fVk1fRVZFTlRfUkVTVU1F
OgotICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9yaW5nX3Jlc3VtZSh0b19yaW5nKGQtPnZtX2V2
ZW50X21vbml0b3IpKTsKKyAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmVzdW1lKGQtPnZtX2V2
ZW50X21vbml0b3IsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21haW5fdmNw
dShkLCB2ZWMtPnUucmVzdW1lLnZjcHVfaWQpKTsKICAgICAgICAgICAgIGJyZWFrOwogCiAgICAg
ICAgIGRlZmF1bHQ6CkBAIC03MjQsNiArMTEwOSwxMyBAQCBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0
cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMpCiAgICAg
ewogICAgICAgICByYyA9IC1FSU5WQUw7CiAKKyAgICAgICAgLyoKKyAgICAgICAgICogVGhlIE5H
IGludGVyZmFjZSBpcyBvbmx5IHN1cHBvcnRlZCBieSBYRU5fVk1fRVZFTlRfVFlQRV9NT05JVE9S
CisgICAgICAgICAqIGZvciBub3cuCisgICAgICAgICAqLworICAgICAgICBpZiAoIHZlYy0+Zmxh
Z3MgJiBYRU5fVk1fRVZFTlRfRkxBR1NfTkdfT1AgKQorICAgICAgICAgICAgYnJlYWs7CisKICAg
ICAgICAgc3dpdGNoKCB2ZWMtPm9wICkKICAgICAgICAgewogICAgICAgICBjYXNlIFhFTl9WTV9F
VkVOVF9FTkFCTEU6CkBAIC03MzgsMjEgKzExMzAsMjAgQEAgaW50IHZtX2V2ZW50X2RvbWN0bChz
dHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgeGVuX2RvbWN0bF92bV9ldmVudF9vcCAqdmVjKQogICAg
ICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgICAgICAvKiBkb21haW5fcGF1c2UoKSBub3Qg
cmVxdWlyZWQgaGVyZSwgc2VlIFhTQS05OSAqLwotICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9y
aW5nX2VuYWJsZShkLCB2ZWMsICZkLT52bV9ldmVudF9zaGFyZSwgX1ZQRl9tZW1fc2hhcmluZywK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhWTV9QQVJBTV9TSEFSSU5HX1JJTkdf
UEZOLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtX3NoYXJpbmdfbm90aWZp
Y2F0aW9uKTsKKyAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfZW5hYmxlKGQsIHZlYywgJmQtPnZt
X2V2ZW50X3NoYXJlKTsKICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIGNhc2UgWEVOX1ZN
X0VWRU5UX0RJU0FCTEU6CiAgICAgICAgICAgICBpZiAoICF2bV9ldmVudF9jaGVjayhkLT52bV9l
dmVudF9zaGFyZSkgKQogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgZG9tYWlu
X3BhdXNlKGQpOwotICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9yaW5nX2Rpc2FibGUoJmQtPnZt
X2V2ZW50X3NoYXJlKTsKKyAgICAgICAgICAgIHJjID0gZC0+dm1fZXZlbnRfc2hhcmUtPm9wcy0+
ZGlzYWJsZSgmZC0+dm1fZXZlbnRfc2hhcmUpOwogICAgICAgICAgICAgZG9tYWluX3VucGF1c2Uo
ZCk7CiAgICAgICAgICAgICBicmVhazsKIAogICAgICAgICBjYXNlIFhFTl9WTV9FVkVOVF9SRVNV
TUU6Ci0gICAgICAgICAgICByYyA9IHZtX2V2ZW50X3JpbmdfcmVzdW1lKHRvX3JpbmcoZC0+dm1f
ZXZlbnRfc2hhcmUpKTsKKyAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmVzdW1lKGQtPnZtX2V2
ZW50X3NoYXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWluX3ZjcHUo
ZCwgdmVjLT51LnJlc3VtZS52Y3B1X2lkKSk7CiAgICAgICAgICAgICBicmVhazsKIAogICAgICAg
ICBkZWZhdWx0OgpAQCAtODA5LDcgKzEyMDAsMTkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2bV9l
dmVudF9vcHMgdm1fZXZlbnRfcmluZ19vcHMgPSB7CiAgICAgLmNsZWFudXAgPSB2bV9ldmVudF9y
aW5nX2NsZWFudXAsCiAgICAgLmNsYWltX3Nsb3QgPSB2bV9ldmVudF9yaW5nX2NsYWltX3Nsb3Qs
CiAgICAgLmNhbmNlbF9zbG90ID0gdm1fZXZlbnRfcmluZ19jYW5jZWxfc2xvdCwKLSAgICAucHV0
X3JlcXVlc3QgPSB2bV9ldmVudF9yaW5nX3B1dF9yZXF1ZXN0CisgICAgLmRpc2FibGUgPSB2bV9l
dmVudF9yaW5nX2Rpc2FibGUsCisgICAgLnB1dF9yZXF1ZXN0ID0gdm1fZXZlbnRfcmluZ19wdXRf
cmVxdWVzdCwKKyAgICAucmVzdW1lID0gdm1fZXZlbnRfcmluZ19yZXN1bWUsCit9OworCitzdGF0
aWMgY29uc3Qgc3RydWN0IHZtX2V2ZW50X29wcyB2bV9ldmVudF9jaGFubmVsc19vcHMgPSB7Cisg
ICAgLmNoZWNrID0gdm1fZXZlbnRfY2hhbm5lbHNfY2hlY2ssCisgICAgLmNsZWFudXAgPSB2bV9l
dmVudF9jaGFubmVsc19jbGVhbnVwLAorICAgIC5jbGFpbV9zbG90ID0gdm1fZXZlbnRfY2hhbm5l
bHNfY2xhaW1fc2xvdCwKKyAgICAuY2FuY2VsX3Nsb3QgPSB2bV9ldmVudF9jaGFubmVsc19jYW5j
ZWxfc2xvdCwKKyAgICAuZGlzYWJsZSA9IHZtX2V2ZW50X2NoYW5uZWxzX2Rpc2FibGUsCisgICAg
LnB1dF9yZXF1ZXN0ID0gdm1fZXZlbnRfY2hhbm5lbHNfcHV0X3JlcXVlc3QsCisgICAgLnJlc3Vt
ZSA9IHZtX2V2ZW50X2NoYW5uZWxzX3Jlc3VtZSwKIH07CiAKIC8qCmRpZmYgLS1naXQgYS94ZW4v
aW5jbHVkZS9wdWJsaWMvZG9tY3RsLmggYi94ZW4vaW5jbHVkZS9wdWJsaWMvZG9tY3RsLmgKaW5k
ZXggMjM0ZDhjNS4uZmM3NDIwYyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvcHVibGljL2RvbWN0
bC5oCisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9kb21jdGwuaApAQCAtMzgsNyArMzgsNyBAQAog
I2luY2x1ZGUgImh2bS9zYXZlLmgiCiAjaW5jbHVkZSAibWVtb3J5LmgiCiAKLSNkZWZpbmUgWEVO
X0RPTUNUTF9JTlRFUkZBQ0VfVkVSU0lPTiAweDAwMDAwMDExCisjZGVmaW5lIFhFTl9ET01DVExf
SU5URVJGQUNFX1ZFUlNJT04gMHgwMDAwMDAxMgogCiAvKgogICogTkIuIHhlbl9kb21jdGwuZG9t
YWluIGlzIGFuIElOL09VVCBwYXJhbWV0ZXIgZm9yIHRoaXMgb3BlcmF0aW9uLgpAQCAtNzgxLDEy
ICs3ODEsMjAgQEAgc3RydWN0IHhlbl9kb21jdGxfZ2Ric3hfZG9tc3RhdHVzIHsKIHN0cnVjdCB4
ZW5fZG9tY3RsX3ZtX2V2ZW50X29wIHsKICAgICB1aW50MzJfdCAgICAgICBvcDsgICAgICAgICAg
IC8qIFhFTl9WTV9FVkVOVF8qICovCiAgICAgdWludDMyX3QgICAgICAgdHlwZTsgICAgICAgICAv
KiBYRU5fVk1fRVZFTlRfVFlQRV8qICovCisgLyogVXNlIHRoZSBORyBpbnRlcmZhY2UgKi8KKyNk
ZWZpbmUgX1hFTl9WTV9FVkVOVF9GTEFHU19OR19PUCAgICAgICAgIDAKKyNkZWZpbmUgWEVOX1ZN
X0VWRU5UX0ZMQUdTX05HX09QICAgICAgICAgICgxVSA8PCBfWEVOX1ZNX0VWRU5UX0ZMQUdTX05H
X09QKQorICAgIHVpbnQzMl90ICAgICAgIGZsYWdzOwogCiAgICAgdW5pb24gewogICAgICAgICBz
dHJ1Y3QgewogICAgICAgICAgICAgdWludDMyX3QgcG9ydDsgICAgICAgLyogT1VUOiBldmVudCBj
aGFubmVsIGZvciByaW5nICovCiAgICAgICAgIH0gZW5hYmxlOwogCisgICAgICAgIHN0cnVjdCB7
CisgICAgICAgICAgICB1aW50MzJfdCB2Y3B1X2lkOyAgICAvKiBJTjogdmNwdV9pZCovCisgICAg
ICAgIH0gcmVzdW1lOworCiAgICAgICAgIHVpbnQzMl90IHZlcnNpb247CiAgICAgfSB1OwogfTsK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3B1YmxpYy9tZW1vcnkuaCBiL3hlbi9pbmNsdWRlL3B1
YmxpYy9tZW1vcnkuaAppbmRleCA2OGRkYWRiLi4yZTg5MTJlIDEwMDY0NAotLS0gYS94ZW4vaW5j
bHVkZS9wdWJsaWMvbWVtb3J5LmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL21lbW9yeS5oCkBA
IC02MTIsNiArNjEyLDcgQEAgc3RydWN0IHhlbl9tZW1fYWNxdWlyZV9yZXNvdXJjZSB7CiAKICNk
ZWZpbmUgWEVOTUVNX3Jlc291cmNlX2lvcmVxX3NlcnZlciAwCiAjZGVmaW5lIFhFTk1FTV9yZXNv
dXJjZV9ncmFudF90YWJsZSAxCisjZGVmaW5lIFhFTk1FTV9yZXNvdXJjZV92bV9ldmVudCAyCiAK
ICAgICAvKgogICAgICAqIElOIC0gYSB0eXBlLXNwZWNpZmljIHJlc291cmNlIGlkZW50aWZpZXIs
IHdoaWNoIG11c3QgYmUgemVybwpAQCAtNjE5LDYgKzYyMCw3IEBAIHN0cnVjdCB4ZW5fbWVtX2Fj
cXVpcmVfcmVzb3VyY2UgewogICAgICAqCiAgICAgICogdHlwZSA9PSBYRU5NRU1fcmVzb3VyY2Vf
aW9yZXFfc2VydmVyIC0+IGlkID09IGlvcmVxIHNlcnZlciBpZAogICAgICAqIHR5cGUgPT0gWEVO
TUVNX3Jlc291cmNlX2dyYW50X3RhYmxlIC0+IGlkIGRlZmluZWQgYmVsb3cKKyAgICAgKiB0eXBl
ID09IFhFTk1FTV9yZXNvdXJjZV92bV9ldmVudCAtPiBpZCA9PSB2bV9ldmVudCB0eXBlCiAgICAg
ICovCiAgICAgdWludDMyX3QgaWQ7CiAKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3B1YmxpYy92
bV9ldmVudC5oIGIveGVuL2luY2x1ZGUvcHVibGljL3ZtX2V2ZW50LmgKaW5kZXggYzQ4YmMyMS4u
MmYyMTYwYiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvcHVibGljL3ZtX2V2ZW50LmgKKysrIGIv
eGVuL2luY2x1ZGUvcHVibGljL3ZtX2V2ZW50LmgKQEAgLTQyMSw2ICs0MjEsMjIgQEAgdHlwZWRl
ZiBzdHJ1Y3Qgdm1fZXZlbnRfc3QgewogCiBERUZJTkVfUklOR19UWVBFUyh2bV9ldmVudCwgdm1f
ZXZlbnRfcmVxdWVzdF90LCB2bV9ldmVudF9yZXNwb25zZV90KTsKIAorLyogVk0gRXZlbnQgc2xv
dCBzdGF0ZSAqLworI2RlZmluZSBTVEFURV9WTV9FVkVOVF9TTE9UX0lETEUgICAgIDAgLyogdGhl
IHNsb3QgZGF0YSBpcyBpbnZhbGlkICovCisjZGVmaW5lIFNUQVRFX1ZNX0VWRU5UX1NMT1RfU1VC
TUlUICAgMSAvKiBhIHJlcXVlc3Qgd2FzIHN1Ym1pdHRlZCAqLworI2RlZmluZSBTVEFURV9WTV9F
VkVOVF9TTE9UX0ZJTklTSCAgIDIgLyogYSByZXNwb25zZSB3YXMgaXNzdWVkICovCisKK3N0cnVj
dCB2bV9ldmVudF9zbG90Cit7CisgICAgdWludDMyX3QgcG9ydDsgICAgICAvKiBldnRjaG4gZm9y
IG5vdGlmaWNhdGlvbnMgdG8vZnJvbSBoZWxwZXIgKi8KKyAgICB1aW50MzJfdCBzdGF0ZTo0Owor
ICAgIHVpbnQzMl90IHBhZDoyODsKKyAgICB1bmlvbiB7CisgICAgICAgIHZtX2V2ZW50X3JlcXVl
c3RfdCByZXE7CisgICAgICAgIHZtX2V2ZW50X3Jlc3BvbnNlX3QgcnNwOworICAgIH0gdTsKK307
CisKICNlbmRpZiAvKiBkZWZpbmVkKF9fWEVOX18pIHx8IGRlZmluZWQoX19YRU5fVE9PTFNfXykg
Ki8KICNlbmRpZiAvKiBfWEVOX1BVQkxJQ19WTV9FVkVOVF9IICovCiAKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL3hlbi92bV9ldmVudC5oIGIveGVuL2luY2x1ZGUveGVuL3ZtX2V2ZW50LmgKaW5k
ZXggMjFhM2Y1MC4uMDQ2ODI2OSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3ZtX2V2ZW50
LmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3ZtX2V2ZW50LmgKQEAgLTMwLDE0ICszMCwxNyBAQAog
CiBzdHJ1Y3QgZG9tYWluOwogc3RydWN0IHZtX2V2ZW50X2RvbWFpbjsKK3N0cnVjdCB4ZW5fZG9t
Y3RsX3ZtX2V2ZW50X29wOwogCiBzdHJ1Y3Qgdm1fZXZlbnRfb3BzCiB7CiAgICAgYm9vbCAoKmNo
ZWNrKShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpOwotICAgIHZvaWQgKCpjbGVhbnVwKShz
dHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICoqX3ZlZCk7Ci0gICAgaW50ICgqY2xhaW1fc2xvdCkoc3Ry
dWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLCBib29sIGFsbG93X3NsZWVwKTsKKyAgICB2b2lkICgq
Y2xlYW51cCkoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqcF92ZWQpOworICAgIGludCAgKCpjbGFp
bV9zbG90KShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQsIGJvb2wgYWxsb3dfc2xlZXApOwog
ICAgIHZvaWQgKCpjYW5jZWxfc2xvdCkoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKTsKKyAg
ICBpbnQgICgqZGlzYWJsZSkoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqKnBfdmVkKTsKICAgICB2
b2lkICgqcHV0X3JlcXVlc3QpKHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCwgdm1fZXZlbnRf
cmVxdWVzdF90ICpyZXEpOworICAgIGludCAgKCpyZXN1bWUpKHN0cnVjdCB2bV9ldmVudF9kb21h
aW4gKnZlZCwgc3RydWN0IHZjcHUgKnYpOwogfTsKIAogc3RydWN0IHZtX2V2ZW50X2RvbWFpbgpA
QCAtMTExLDYgKzExNCwxMCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdm1fZXZlbnRfcHV0X3JlcXVl
c3Qoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLAogCiBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0
cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMpOwogCitp
bnQgdm1fZXZlbnRfbmdfZ2V0X2ZyYW1lcyhzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQg
aWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGZyYW1lLCB1bnNp
Z25lZCBpbnQgbnJfZnJhbWVzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVuX3Bmbl90
IG1mbl9saXN0W10pOworCiB2b2lkIHZtX2V2ZW50X3ZjcHVfcGF1c2Uoc3RydWN0IHZjcHUgKnYp
Owogdm9pZCB2bV9ldmVudF92Y3B1X3VucGF1c2Uoc3RydWN0IHZjcHUgKnYpOwogCi0tIAoyLjcu
NAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

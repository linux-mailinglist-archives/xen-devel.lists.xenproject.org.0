Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6606A2C958
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 16:57:42 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVdUs-0000VS-CM; Tue, 28 May 2019 14:54:38 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=twwc=T4=suse.com=vliaskovitis@srs-us1.protection.inumbo.net>)
 id 1hVdUq-0000V1-Ec
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 14:54:36 +0000
X-Inumbo-ID: 810a9362-8158-11e9-bc13-bf964a31188e
Received: from smtp.nue.novell.com (unknown [195.135.221.5])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 810a9362-8158-11e9-bc13-bf964a31188e;
 Tue, 28 May 2019 14:54:34 +0000 (UTC)
Received: from emea4-mta.ukb.novell.com ([10.120.13.87])
 by smtp.nue.novell.com with ESMTP (TLS encrypted);
 Tue, 28 May 2019 16:54:32 +0200
Received: from linux-nq5u.suse.de (nwb-a10-snat.microfocus.com [10.120.13.201])
 by emea4-mta.ukb.novell.com with ESMTP (NOT encrypted);
 Tue, 28 May 2019 15:54:22 +0100
From: Vasilis Liaskovitis <vliaskovitis@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 16:54:13 +0200
Message-Id: <20190528145416.16918-2-vliaskovitis@suse.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190528145416.16918-1-vliaskovitis@suse.com>
References: <20190528145416.16918-1-vliaskovitis@suse.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v4 1/4] xen: add hypercall for reading runtime
 parameters
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: jgross@suse.com, sstabellini@kernel.org, wei.liu2@citrix.com,
 jbeulich@suse.com, George.Dunlap@eu.citrix.com, andrew.cooper3@citrix.com,
 ian.jackson@eu.citrix.com, tim@xen.org, vliaskovitis@suse.com,
 anthony.perard@citrix.com, dgdegra@tycho.nsa.gov
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIGEgc3lzY3RsIGh5cGVyY2FsbCB0byBzdXBwb3J0IHJlYWRpbmcgaHlwZXJ2aXNvciBydW50
aW1lIHBhcmFtZXRlcnMuCgpMaW1pdGF0aW9uczoKLSBDdXN0b20gcnVudGltZSBwYXJhbWV0ZXJz
IChPUFRfQ1VTVE9NKSBhcmUgbm90IHN1cHBvcnRlZCB5ZXQuCi0gRm9yIGludGVnZXIgcGFyYW1l
dGVycyAoT1BUX1VJTlQpLCBvbmx5IHVuc2lnbmVkIHBhcmFtZXRlcnMgYXJlIHByaW50ZWQKY29y
cmVjdGx5LgotIFRoZSBpbXBsZW1lbnRhdGlvbiBvbmx5IHJlYWRzIHJ1bnRpbWUgcGFyYW1ldGVy
cywgYnV0IGl0IGNhbiBiZSBjaGFuZ2VkCnRvIHJlYWQgYWxsIGh5cGVydmlzb3IgcGFyYW1ldGVy
cyBpZiBuZWVkZWQuIAoKU2lnbmVkLW9mZi1ieTogVmFzaWxpcyBMaWFza292aXRpcyA8dmxpYXNr
b3ZpdGlzQHN1c2UuY29tPgotLS0KIHRvb2xzL2ZsYXNrL3BvbGljeS9tb2R1bGVzL2RvbTAudGUg
IHwgICAyICstCiB4ZW4vY29tbW9uL2tlcm5lbC5jICAgICAgICAgICAgICAgICB8IDExOCArKysr
KysrKysrKysrKysrKysrKysrKysrKysrCiB4ZW4vY29tbW9uL3N5c2N0bC5jICAgICAgICAgICAg
ICAgICB8ICA1MiArKysrKysrKysrKy0KIHhlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCAgICAg
ICAgIHwgIDE4ICsrKysrCiB4ZW4vaW5jbHVkZS94ZW4vbGliLmggICAgICAgICAgICAgICB8ICAg
MSArCiB4ZW4veHNtL2ZsYXNrL2hvb2tzLmMgICAgICAgICAgICAgICB8ICAgMyArCiB4ZW4veHNt
L2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVjdG9ycyB8ICAgMiArCiA3IGZpbGVzIGNoYW5nZWQsIDE5
MyBpbnNlcnRpb25zKCspLCAzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL2ZsYXNr
L3BvbGljeS9tb2R1bGVzL2RvbTAudGUgYi90b29scy9mbGFzay9wb2xpY3kvbW9kdWxlcy9kb20w
LnRlCmluZGV4IGEzNDdkNjY0ZjguLjY4MWQxYTEwMWIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2ZsYXNr
L3BvbGljeS9tb2R1bGVzL2RvbTAudGUKKysrIGIvdG9vbHMvZmxhc2svcG9saWN5L21vZHVsZXMv
ZG9tMC50ZQpAQCAtMTYsNyArMTYsNyBAQCBhbGxvdyBkb20wX3QgeGVuX3Q6eGVuIHsKIGFsbG93
IGRvbTBfdCB4ZW5fdDp4ZW4yIHsKIAlyZXNvdXJjZV9vcCBwc3JfY210X29wIHBzcl9hbGxvYyBw
bXVfY3RybCBnZXRfc3ltYm9sCiAJZ2V0X2NwdV9sZXZlbGxpbmdfY2FwcyBnZXRfY3B1X2ZlYXR1
cmVzZXQgbGl2ZXBhdGNoX29wCi0JY292ZXJhZ2Vfb3Agc2V0X3BhcmFtZXRlcgorCWNvdmVyYWdl
X29wIHNldF9wYXJhbWV0ZXIgZ2V0X3BhcmFtZXRlcgogfTsKIAogIyBBbGxvdyBkb20wIHRvIHVz
ZSBhbGwgWEVOVkVSXyBzdWJvcHMgdGhhdCBoYXZlIGNoZWNrcy4KZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24va2VybmVsLmMgYi94ZW4vY29tbW9uL2tlcm5lbC5jCmluZGV4IDYxMjU3NTQzMGYuLjY2
OTVmZmMzNzIgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24va2VybmVsLmMKKysrIGIveGVuL2NvbW1v
bi9rZXJuZWwuYwpAQCAtMTIsNiArMTIsNyBAQAogI2luY2x1ZGUgPHhlbi9wYWdpbmcuaD4KICNp
bmNsdWRlIDx4ZW4vZ3Vlc3RfYWNjZXNzLmg+CiAjaW5jbHVkZSA8eGVuL2h5cGVyY2FsbC5oPgor
I2luY2x1ZGUgPHhlbi9jdHlwZS5oPgogI2luY2x1ZGUgPHhzbS94c20uaD4KICNpbmNsdWRlIDxh
c20vY3VycmVudC5oPgogI2luY2x1ZGUgPHB1YmxpYy92ZXJzaW9uLmg+CkBAIC01Miw2ICs1Mywx
MjMgQEAgc3RhdGljIGludCBhc3NpZ25faW50ZWdlcl9wYXJhbShjb25zdCBzdHJ1Y3Qga2VybmVs
X3BhcmFtICpwYXJhbSwgdWludDY0X3QgdmFsKQogICAgIHJldHVybiAwOwogfQogCitzdGF0aWMg
aW50IGdldF9pbnRlZ2VyX3BhcmFtKGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKnBhcmFtLCB1
aW50NjRfdCAqdmFsKQoreworICAgIHN3aXRjaCAoIHBhcmFtLT5sZW4gKQorICAgIHsKKyAgICBj
YXNlIHNpemVvZih1aW50OF90KToKKyAgICAgICAgKnZhbCA9ICoodWludDhfdCAqKXBhcmFtLT5w
YXIudmFyOworICAgICAgICBicmVhazsKKworICAgIGNhc2Ugc2l6ZW9mKHVpbnQxNl90KToKKyAg
ICAgICAgKnZhbCA9ICoodWludDE2X3QgKilwYXJhbS0+cGFyLnZhcjsKKyAgICAgICAgYnJlYWs7
CisKKyAgICBjYXNlIHNpemVvZih1aW50MzJfdCk6CisgICAgICAgICp2YWwgPSAqKHVpbnQzMl90
ICopcGFyYW0tPnBhci52YXI7CisgICAgICAgIGJyZWFrOworCisgICAgY2FzZSBzaXplb2YodWlu
dDY0X3QpOgorICAgICAgICAqdmFsID0gKih1aW50NjRfdCAqKXBhcmFtLT5wYXIudmFyOworICAg
ICAgICBicmVhazsKKworICAgIGRlZmF1bHQ6CisgICAgICAgIEJVRygpOworICAgICAgICBicmVh
azsKKyAgICB9CisKKyAgICByZXR1cm4gMDsKK30KKworaW50IHJ1bnRpbWVfZ2V0X3BhcmFtcyhj
b25zdCBjaGFyICpjbWRsaW5lLCBjaGFyICp2YWx1ZXMsCisgICAgICAgICAgICAgICAgICAgICAg
c2l6ZV90IG1heGxlbikKK3sKKyAgICBjaGFyIG9wdFsxMjhdLCAqb3B0a2V5LCAqcSwgKnZhbCA9
IHZhbHVlczsKKyAgICBjb25zdCBjaGFyICpwID0gY21kbGluZTsKKyAgICBjb25zdCBzdHJ1Y3Qg
a2VybmVsX3BhcmFtICpwYXJhbTsKKyAgICBpbnQgcmMgPSAwLCBsZW4gPSAwOworICAgIHNpemVf
dCBidWZwb3MgPSAwOworICAgIHVpbnQ2NF90IHBhcmFtX2ludDsKKworICAgIHdoaWxlICggIXJj
ICkKKyAgICB7CisgICAgICAgIC8qIFNraXAgd2hpdGVzcGFjZS4gKi8KKyAgICAgICAgd2hpbGUg
KCBpc3NwYWNlKCpwKSApCisgICAgICAgICAgICBwKys7CisgICAgICAgIGlmICggKnAgPT0gJ1ww
JyApCisgICAgICAgICAgICBicmVhazsKKworICAgICAgICAvKiBHcmFiIHRoZSBuZXh0IHdoaXRl
c3BhY2UtZGVsaW1pdGVkIG9wdGlvbi4gKi8KKyAgICAgICAgcSA9IG9wdGtleSA9IG9wdDsKKyAg
ICAgICAgd2hpbGUgKCAhaXNzcGFjZSgqcCkgJiYgKCpwICE9ICdcMCcpICkKKyAgICAgICAgewor
ICAgICAgICAgICAgaWYgKCAocSAtIG9wdCkgPCAoc2l6ZW9mKG9wdCkgLSAxKSApIC8qIGF2b2lk
IG92ZXJmbG93ICovCisgICAgICAgICAgICAgICAgKnErKyA9ICpwOworICAgICAgICAgICAgZWxz
ZSByZXR1cm4gLUVOT01FTTsKKyAgICAgICAgICAgIHArKzsKKyAgICAgICAgfQorICAgICAgICAq
cSA9ICdcMCc7CisKKyAgICAgICAgZm9yICggcGFyYW0gPSBfX3BhcmFtX3N0YXJ0OyBwYXJhbSA8
IF9fcGFyYW1fZW5kOyBwYXJhbSsrICkKKyAgICAgICAgeworICAgICAgICAgICAgaWYgKCBzdHJj
bXAocGFyYW0tPm5hbWUsIG9wdGtleSkgKQorICAgICAgICAgICAgICAgIGNvbnRpbnVlOworCisg
ICAgICAgICAgICBzd2l0Y2ggKCBwYXJhbS0+dHlwZSApCisgICAgICAgICAgICB7CisgICAgICAg
ICAgICBjYXNlIE9QVF9TVFI6CisgICAgICAgICAgICAgICAgbGVuID0gc25wcmludGYodmFsICsg
YnVmcG9zLCBtYXhsZW4gLSBidWZwb3MsICIlcyAiLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChjaGFyKilwYXJhbS0+cGFyLnZhcik7CisgICAgICAgICAgICAgICAgYnJlYWs7CisK
KyAgICAgICAgICAgIGNhc2UgT1BUX1VJTlQ6CisgICAgICAgICAgICBjYXNlIE9QVF9TSVpFOgor
ICAgICAgICAgICAgICAgIC8qIFNpZ25lZCBpbnRlZ2VyIHBhcmFtZXRlcnMgYXJlIG5vdCBzdXBw
b3J0ZWQgeWV0LgorICAgICAgICAgICAgICAgICAqIFdoaWxlIHRoZXJlIGFyZSBubyBydW50aW1l
IHNpZ25lZCBpbnRlZ2VyIHBhcmFtZXRlcnMKKyAgICAgICAgICAgICAgICAgKiBhdCB0aGUgbW9t
ZW50LCBhZGRpbmcgb25lIGFuZCB0cnlpbmcgdG8gZ2V0IGl0cyB2YWx1ZQorICAgICAgICAgICAg
ICAgICAqIHdpdGggdGhlIGN1cnJlbnQgaW1wbGVtZW50YXRpb24gd2lsbCBvdXRwdXQgdGhlIHdy
b25nCisgICAgICAgICAgICAgICAgICogdmFsdWUuCisgICAgICAgICAgICAgICAgICovCisgICAg
ICAgICAgICAgICAgZ2V0X2ludGVnZXJfcGFyYW0ocGFyYW0sICZwYXJhbV9pbnQpOworICAgICAg
ICAgICAgICAgIGxlbiA9IHNucHJpbnRmKHZhbCArIGJ1ZnBvcywgbWF4bGVuIC0gYnVmcG9zLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlIlBSSXU2NCIgIiwgcGFyYW1faW50KTsK
KyAgICAgICAgICAgICAgICBicmVhazsKKworICAgICAgICAgICAgY2FzZSBPUFRfQk9PTDoKKyAg
ICAgICAgICAgICAgICBnZXRfaW50ZWdlcl9wYXJhbShwYXJhbSwgJnBhcmFtX2ludCk7CisgICAg
ICAgICAgICAgICAgbGVuID0gc25wcmludGYodmFsICsgYnVmcG9zLCBtYXhsZW4gLSBidWZwb3Ms
ICIlcyAiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtX2ludCA/ICJ0cnVl
IiA6ICJmYWxzZSIpOworICAgICAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgICAgICBjYXNl
IE9QVF9DVVNUT006CisgICAgICAgICAgICAgICAgLyogQ3VzdG9tIHBhcmFtZXRlcnMgYXJlIG5v
dCBzdXBwb3J0ZWQgeWV0LiAqLworICAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKKyAgICAg
ICAgICAgICAgICBicmVhazsKKworICAgICAgICAgICAgZGVmYXVsdDoKKyAgICAgICAgICAgICAg
ICBCVUcoKTsKKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIH0KKworICAgICAg
ICAgICAgaWYgKCBsZW4gPCAwICkKKyAgICAgICAgICAgICAgICByYyA9IGxlbjsKKyAgICAgICAg
ICAgIGVsc2UgaWYgKCBsZW4gPCBtYXhsZW4gLSBidWZwb3MgKQorICAgICAgICAgICAgICAgIC8q
IGlmIG91dHB1dCB3YXMgbm90IHRydW5jYXRlZCB1cGRhdGUgYnVmZmVyIHBvc2l0aW9uLiAqLwor
ICAgICAgICAgICAgICAgIGJ1ZnBvcyArPSBsZW47CisgICAgICAgICAgICBlbHNlIGlmICggbGVu
ID4gMCApCisgICAgICAgICAgICAgICAgcmMgPSAtRU5PTUVNOworCisgICAgICAgICAgICBicmVh
azsKKyAgICAgICAgfQorCisgICAgICAgIC8qIG5vIHBhcmFtZXRlciB3YXMgbWF0Y2hlZCAqLwor
ICAgICAgICBpZiAoIHBhcmFtID49IF9fcGFyYW1fZW5kICkKKyAgICAgICAgICAgIHJjID0gLUVJ
TlZBTDsKKyAgICB9CisKKyAgICByZXR1cm4gcmM7Cit9CisKIHN0YXRpYyBpbnQgcGFyc2VfcGFy
YW1zKGNvbnN0IGNoYXIgKmNtZGxpbmUsIGNvbnN0IHN0cnVjdCBrZXJuZWxfcGFyYW0gKnN0YXJ0
LAogICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGtlcm5lbF9wYXJhbSAqZW5k
KQogewpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zeXNjdGwuYyBiL3hlbi9jb21tb24vc3lzY3Rs
LmMKaW5kZXggYzBhYTZiZGU0ZS4uMjBiZTZhNmQ4ZCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9z
eXNjdGwuYworKysgYi94ZW4vY29tbW9uL3N5c2N0bC5jCkBAIC00NjYsOSArNDY2LDkgQEAgbG9u
ZyBkb19zeXNjdGwoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fc3lzY3RsX3QpIHVfc3lzY3Rs
KQogICAgICAgICAgICAgY29weWJhY2sgPSAxOwogICAgICAgICBicmVhazsKIAorI2RlZmluZSBY
RU5fUEFSQU1FVEVSX01BWF9TSVpFIDEwMjMKICAgICBjYXNlIFhFTl9TWVNDVExfc2V0X3BhcmFt
ZXRlcjoKICAgICB7Ci0jZGVmaW5lIFhFTl9TRVRfUEFSQU1FVEVSX01BWF9TSVpFIDEwMjMKICAg
ICAgICAgY2hhciAqcGFyYW1zOwogCiAgICAgICAgIGlmICggb3AtPnUuc2V0X3BhcmFtZXRlci5w
YWRbMF0gfHwgb3AtPnUuc2V0X3BhcmFtZXRlci5wYWRbMV0gfHwKQEAgLTQ3Nyw3ICs0NzcsNyBA
QCBsb25nIGRvX3N5c2N0bChYRU5fR1VFU1RfSEFORExFX1BBUkFNKHhlbl9zeXNjdGxfdCkgdV9z
eXNjdGwpCiAgICAgICAgICAgICByZXQgPSAtRUlOVkFMOwogICAgICAgICAgICAgYnJlYWs7CiAg
ICAgICAgIH0KLSAgICAgICAgaWYgKCBvcC0+dS5zZXRfcGFyYW1ldGVyLnNpemUgPiBYRU5fU0VU
X1BBUkFNRVRFUl9NQVhfU0laRSApCisgICAgICAgIGlmICggb3AtPnUuc2V0X3BhcmFtZXRlci5z
aXplID4gWEVOX1BBUkFNRVRFUl9NQVhfU0laRSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHJl
dCA9IC1FMkJJRzsKICAgICAgICAgICAgIGJyZWFrOwpAQCAtNTAxLDYgKzUwMSw1NCBAQCBsb25n
IGRvX3N5c2N0bChYRU5fR1VFU1RfSEFORExFX1BBUkFNKHhlbl9zeXNjdGxfdCkgdV9zeXNjdGwp
CiAKICAgICAgICAgYnJlYWs7CiAgICAgfQorICAgIGNhc2UgWEVOX1NZU0NUTF9nZXRfcGFyYW1l
dGVyOgorICAgIHsKKyAgICAgICAgY2hhciAqcGFyYW1zLCAqdmFsdWVzOworCisgICAgICAgIGlm
ICggb3AtPnUuZ2V0X3BhcmFtZXRlci5wYWRbMF0gfHwgb3AtPnUuZ2V0X3BhcmFtZXRlci5wYWRb
MV0gfHwKKyAgICAgICAgICAgICBvcC0+dS5nZXRfcGFyYW1ldGVyLnBhZFsyXSApCisgICAgICAg
IHsKKyAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7CisgICAgICAgICAgICBicmVhazsKKyAgICAg
ICAgfQorICAgICAgICBpZiAoIG9wLT51LmdldF9wYXJhbWV0ZXIuc2l6ZSA+IFhFTl9QQVJBTUVU
RVJfTUFYX1NJWkUgKQorICAgICAgICB7CisgICAgICAgICAgICByZXQgPSAtRTJCSUc7CisgICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBwYXJhbXMgPSB4bWFsbG9jX2J5dGVz
KG9wLT51LmdldF9wYXJhbWV0ZXIuc2l6ZSArIDEpOworICAgICAgICBpZiAoICFwYXJhbXMgKQor
ICAgICAgICB7CisgICAgICAgICAgICByZXQgPSAtRU5PTUVNOworICAgICAgICAgICAgYnJlYWs7
CisgICAgICAgIH0KKworICAgICAgICB2YWx1ZXMgPSB4bWFsbG9jX2J5dGVzKFhFTl9QQVJBTUVU
RVJfTUFYX1NJWkUpOworICAgICAgICBpZiAoICF2YWx1ZXMgKQorICAgICAgICB7CisgICAgICAg
ICAgICB4ZnJlZShwYXJhbXMpOworICAgICAgICAgICAgcmV0ID0gLUVOT01FTTsKKyAgICAgICAg
ICAgIGJyZWFrOworICAgICAgICB9CisKKyAgICAgICAgaWYgKCBjb3B5X2Zyb21fZ3Vlc3QocGFy
YW1zLCBvcC0+dS5nZXRfcGFyYW1ldGVyLnBhcmFtcywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgb3AtPnUuZ2V0X3BhcmFtZXRlci5zaXplKSApCisgICAgICAgICAgICByZXQgPSAtRUZB
VUxUOworICAgICAgICBlbHNlCisgICAgICAgIHsKKyAgICAgICAgICAgIHBhcmFtc1tvcC0+dS5z
ZXRfcGFyYW1ldGVyLnNpemVdID0gMDsKKyAgICAgICAgICAgIHJldCA9IHJ1bnRpbWVfZ2V0X3Bh
cmFtcyhwYXJhbXMsIHZhbHVlcywgWEVOX1BBUkFNRVRFUl9NQVhfU0laRSk7CisKKyAgICAgICAg
ICAgIGlmICggIXJldCAmJiBjb3B5X3RvX2d1ZXN0KG9wLT51LmdldF9wYXJhbWV0ZXIudmFsdWVz
LCB2YWx1ZXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJsZW4o
dmFsdWVzKSkgKQorICAgICAgICAgICAgICAgIHJldCA9IC1FRkFVTFQ7CisgICAgICAgIH0KKwor
ICAgICAgICB4ZnJlZShwYXJhbXMpOworICAgICAgICB4ZnJlZSh2YWx1ZXMpOworCisgICAgICAg
IGJyZWFrOworICAgIH0KIAogICAgIGRlZmF1bHQ6CiAgICAgICAgIHJldCA9IGFyY2hfZG9fc3lz
Y3RsKG9wLCB1X3N5c2N0bCk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3Rs
LmggYi94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmgKaW5kZXggYzQ5YjRkY2M5OS4uN2Q3N2Q1
NzExNSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oCisrKyBiL3hlbi9p
bmNsdWRlL3B1YmxpYy9zeXNjdGwuaApAQCAtMTEwMCw2ICsxMTAwLDIyIEBAIHR5cGVkZWYgc3Ry
dWN0IHhlbl9zeXNjdGxfY3B1X3BvbGljeSB4ZW5fc3lzY3RsX2NwdV9wb2xpY3lfdDsKIERFRklO
RV9YRU5fR1VFU1RfSEFORExFKHhlbl9zeXNjdGxfY3B1X3BvbGljeV90KTsKICNlbmRpZgogCisv
KgorICogWEVOX1NZU0NUTF9nZXRfcGFyYW1ldGVyCisgKgorICogUmVhZCBoeXBlcnZpc29yIHBh
cmFtZXRlcnMgYXQgcnVudGltZS4KKyAqIFBhcmFtZXRlcnMgYXJlIGEgc2luZ2xlIHN0cmluZyB0
ZXJtaW5hdGVkIGJ5IGEgTlVMIGJ5dGUgb2YgbWF4LiBzaXplCisgKiBjaGFyYWN0ZXJzLiBNdWx0
aXBsZSBzZXR0aW5ncyBjYW4gYmUgc3BlY2lmaWVkIGJ5IHNlcGFyYXRpbmcgdGhlbQorICogd2l0
aCBibGFua3MuCisgKi8KKworc3RydWN0IHhlbl9zeXNjdGxfZ2V0X3BhcmFtZXRlciB7CisgICAg
WEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBwYXJhbXM7ICAgICAgIC8qIElOOiBwb2ludGVyIHRv
IHBhcmFtZXRlcnMuICovCisgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSB2YWx1ZXM7ICAg
ICAgIC8qIE9VVDogcG9pbnRlciB0byBvdXRwdXQgdmFsdWVzLiAqLworICAgIHVpbnQxNl90IHNp
emU7ICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBJTjogc2l6ZSBvZiBwYXJhbWV0ZXJzLiAq
LworICAgIHVpbnQxNl90IHBhZFszXTsgICAgICAgICAgICAgICAgICAgICAgICAvKiBJTjogTVVT
VCBiZSB6ZXJvLiAqLworfTsKKwogc3RydWN0IHhlbl9zeXNjdGwgewogICAgIHVpbnQzMl90IGNt
ZDsKICNkZWZpbmUgWEVOX1NZU0NUTF9yZWFkY29uc29sZSAgICAgICAgICAgICAgICAgICAgMQpA
QCAtMTEzMCw2ICsxMTQ2LDcgQEAgc3RydWN0IHhlbl9zeXNjdGwgewogI2RlZmluZSBYRU5fU1lT
Q1RMX2xpdmVwYXRjaF9vcCAgICAgICAgICAgICAgICAgIDI3CiAjZGVmaW5lIFhFTl9TWVNDVExf
c2V0X3BhcmFtZXRlciAgICAgICAgICAgICAgICAgMjgKICNkZWZpbmUgWEVOX1NZU0NUTF9nZXRf
Y3B1X3BvbGljeSAgICAgICAgICAgICAgICAyOQorI2RlZmluZSBYRU5fU1lTQ1RMX2dldF9wYXJh
bWV0ZXIgICAgICAgICAgICAgICAgIDMwCiAgICAgdWludDMyX3QgaW50ZXJmYWNlX3ZlcnNpb247
IC8qIFhFTl9TWVNDVExfSU5URVJGQUNFX1ZFUlNJT04gKi8KICAgICB1bmlvbiB7CiAgICAgICAg
IHN0cnVjdCB4ZW5fc3lzY3RsX3JlYWRjb25zb2xlICAgICAgIHJlYWRjb25zb2xlOwpAQCAtMTE2
Miw2ICsxMTc5LDcgQEAgc3RydWN0IHhlbl9zeXNjdGwgewogI2lmIGRlZmluZWQoX19pMzg2X18p
IHx8IGRlZmluZWQoX194ODZfNjRfXykKICAgICAgICAgc3RydWN0IHhlbl9zeXNjdGxfY3B1X3Bv
bGljeSAgICAgICAgY3B1X3BvbGljeTsKICNlbmRpZgorICAgICAgICBzdHJ1Y3QgeGVuX3N5c2N0
bF9nZXRfcGFyYW1ldGVyICAgICBnZXRfcGFyYW1ldGVyOwogICAgICAgICB1aW50OF90ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwYWRbMTI4XTsKICAgICB9IHU7CiB9OwpkaWZmIC0tZ2l0
IGEveGVuL2luY2x1ZGUveGVuL2xpYi5oIGIveGVuL2luY2x1ZGUveGVuL2xpYi5oCmluZGV4IGUw
YjdiY2I2YjcuLjZlNjM2N2JiN2EgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9saWIuaAor
KysgYi94ZW4vaW5jbHVkZS94ZW4vbGliLmgKQEAgLTcxLDYgKzcxLDcgQEAgc3RydWN0IGRvbWFp
bjsKIHZvaWQgY21kbGluZV9wYXJzZShjb25zdCBjaGFyICpjbWRsaW5lKTsKIGludCBydW50aW1l
X3BhcnNlKGNvbnN0IGNoYXIgKmxpbmUpOwogaW50IHBhcnNlX2Jvb2woY29uc3QgY2hhciAqcywg
Y29uc3QgY2hhciAqZSk7CitpbnQgcnVudGltZV9nZXRfcGFyYW1zKGNvbnN0IGNoYXIgKmNtZGxp
bmUsIGNoYXIgKnZhbHVlcywgc2l6ZV90IG1heGxlbik7CiAKIC8qKgogICogR2l2ZW4gYSBzcGVj
aWZpYyBuYW1lLCBwYXJzZXMgYSBzdHJpbmcgb2YgdGhlIGZvcm06CmRpZmYgLS1naXQgYS94ZW4v
eHNtL2ZsYXNrL2hvb2tzLmMgYi94ZW4veHNtL2ZsYXNrL2hvb2tzLmMKaW5kZXggM2QwMGM3NDdm
Ni4uMWI4MzJlOWE0YyAxMDA2NDQKLS0tIGEveGVuL3hzbS9mbGFzay9ob29rcy5jCisrKyBiL3hl
bi94c20vZmxhc2svaG9va3MuYwpAQCAtODMwLDYgKzgzMCw5IEBAIHN0YXRpYyBpbnQgZmxhc2tf
c3lzY3RsKGludCBjbWQpCiAgICAgY2FzZSBYRU5fU1lTQ1RMX3NldF9wYXJhbWV0ZXI6CiAgICAg
ICAgIHJldHVybiBhdmNfY3VycmVudF9oYXNfcGVybShTRUNJTklUU0lEX1hFTiwgU0VDQ0xBU1Nf
WEVOMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhFTjJfX1NFVF9QQVJB
TUVURVIsIE5VTEwpOworICAgIGNhc2UgWEVOX1NZU0NUTF9nZXRfcGFyYW1ldGVyOgorICAgICAg
ICByZXR1cm4gYXZjX2N1cnJlbnRfaGFzX3Blcm0oU0VDSU5JVFNJRF9YRU4sIFNFQ0NMQVNTX1hF
TjIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYRU4yX19HRVRfUEFSQU1F
VEVSLCBOVUxMKTsKIAogICAgIGRlZmF1bHQ6CiAgICAgICAgIHJldHVybiBhdmNfdW5rbm93bl9w
ZXJtaXNzaW9uKCJzeXNjdGwiLCBjbWQpOwpkaWZmIC0tZ2l0IGEveGVuL3hzbS9mbGFzay9wb2xp
Y3kvYWNjZXNzX3ZlY3RvcnMgYi94ZW4veHNtL2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVjdG9ycwpp
bmRleCBlMDA0NDhiNzc2Li5jNWVlMjFkODUyIDEwMDY0NAotLS0gYS94ZW4veHNtL2ZsYXNrL3Bv
bGljeS9hY2Nlc3NfdmVjdG9ycworKysgYi94ZW4veHNtL2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVj
dG9ycwpAQCAtMTAzLDYgKzEwMyw4IEBAIGNsYXNzIHhlbjIKICAgICBjb3ZlcmFnZV9vcAogIyBY
RU5fU1lTQ1RMX3NldF9wYXJhbWV0ZXIKICAgICBzZXRfcGFyYW1ldGVyCisjIFhFTl9TWVNDVExf
Z2V0X3BhcmFtZXRlcgorICAgIGdldF9wYXJhbWV0ZXIKIH0KIAogIyBDbGFzc2VzIGRvbWFpbiBh
bmQgZG9tYWluMiBjb25zaXN0IG9mIG9wZXJhdGlvbnMgdGhhdCBhIGRvbWFpbiBwZXJmb3JtcyBv
bgotLSAKMi4yMC4xCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5v
cmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZl
bA==

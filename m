Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 091A4BE538
	for <lists+xen-devel@lfdr.de>; Wed, 25 Sep 2019 20:53:50 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDCM8-0004Cq-R5; Wed, 25 Sep 2019 18:49:40 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Cfsh=XU=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1iDCM7-0004CG-7j
 for xen-devel@lists.xen.org; Wed, 25 Sep 2019 18:49:39 +0000
X-Inumbo-ID: 34bdc224-dfc5-11e9-963a-12813bfff9fa
Received: from mail.kernel.org (unknown [198.145.29.99])
 by localhost (Halon) with ESMTPS
 id 34bdc224-dfc5-11e9-963a-12813bfff9fa;
 Wed, 25 Sep 2019 18:49:30 +0000 (UTC)
Received: from localhost.localdomain (c-67-164-102-47.hsd1.ca.comcast.net
 [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 210BF21D82;
 Wed, 25 Sep 2019 18:49:29 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1569437369;
 bh=NrZ3HSiOPjc7DKMa01HTHJj8hy+oJ6p7mrF4/eLD1SE=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=uMP/RPfz11fPZB6hKULkY0jbXzuo/vNnloHN0w+KDl+7VtVB9I/y4sZI79LEqpGnJ
 wxWJI70tu1AFjGam7V0uoK9D/oANisWgb6L1SH4ga5IFjRgrbn5kyNU8TTG3uH22l+
 dQ1pg9Ge9k68JRMMcg8L+FM4H7ZzzbueqJkVpOz8=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Wed, 25 Sep 2019 11:49:20 -0700
Message-Id: <20190925184924.21691-4-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1909251146261.24909@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1909251146261.24909@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v5 4/8] xen/arm: copy dtb fragment to guest dtb
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UmVhZCB0aGUgZHRiIGZyYWdtZW50IGNvcnJlc3BvbmRpbmcgdG8gYSBwYXNzdGhyb3VnaCBkZXZp
Y2UgZnJvbSBtZW1vcnkKYXQgdGhlIGxvY2F0aW9uIHJlZmVycmVkIHRvIGJ5IHRoZSAibXVsdGli
b290LGRldmljZS10cmVlIiBjb21wYXRpYmxlCm5vZGUuCgpBZGQgYSBuZXcgZmllbGQgbmFtZWQg
ZHRiX2Jvb3Rtb2R1bGUgdG8gc3RydWN0IGtlcm5lbF9pbmZvIHRvIGtlZXAgdHJhY2sKb2YgdGhl
IGR0YiBmcmFnbWVudCBsb2NhdGlvbi4KCkNvcHkgdGhlIGZyYWdtZW50IHRvIHRoZSBndWVzdCBk
dGIgKG9ubHkgL2FsaWFzZXMgYW5kIC9wYXNzdGhyb3VnaCkuCgpTZXQga2luZm8tPmd1ZXN0X3Bo
YW5kbGVfZ2ljIGJhc2VkIG9uIHRoZSBwaGFuZGxlIG9mIHRoZSBzcGVjaWFsICIvZ2ljIgpub2Rl
IGluIHRoZSBkZXZpY2UgdHJlZSBmcmFnbWVudC4gIi9naWMiIGlzIGEgZHVtbXkgbm9kZSBpbiB0
aGUgZHRiCmZyYWdtZW50IHRoYXQgcmVwcmVzZW50cyB0aGUgZ2ljIGludGVycnVwdCBjb250cm9s
bGVyLiBPdGhlciBwcm9wZXJ0aWVzCmluIHRoZSBkdGIgZnJhZ21lbnQgbWlnaHQgcmVmZXIgdG8g
aXQgKGZvciBpbnN0YW5jZSBpbnRlcnJ1cHQtcGFyZW50IG9mCmEgZGV2aWNlIG5vZGUpLiBXZSBy
ZXVzZSB0aGUgcGhhbmRsZSBvZiAiL2dpYyIgZnJvbSB0aGUgZHRiIGZyYWdtZW50IGFzCnRoZSBw
aGFuZGxlIG9mIHRoZSBmdWxsIEdJQyBub2RlIHRoYXQgd2lsbCBiZSBjcmVhdGVkIGZvciB0aGUg
Z3Vlc3QKZGV2aWNlIHRyZWUuIFRoYXQgd2F5LCB3aGVuIHdlIGNvcHkgcHJvcGVydGllcyBmcm9t
IHRoZSBkZXZpY2UgdHJlZQpmcmFnbWVudCB0byB0aGUgZG9tVSBkZXZpY2UgdHJlZSB0aGUgbGlu
a3MgcmVtYWluIHVuYnJva2VuLgoKU29tZSBvZiB0aGUgY29kZSBiZWxvdyBpcyB0YWtlbiBmcm9t
IHRvb2xzL2xpYnhsL2xpYnhsX2FybS5jLiBOb3RlIHRoYXQKaXQgaXMgT0sgdG8gdGFrZSBMR1BM
IDIuMSBjb2RlIGFuZCBpbmNsdWRpbmcgaXQgaW50byBhIEdQTHYyIGNvZGUgYmFzZS4KVGhlIHJl
c3VsdCBpcyBHUEx2MiBjb2RlLgoKU2lnbmVkLW9mZi1ieTogU3RlZmFubyBTdGFiZWxsaW5pIDxz
dGVmYW5vc0B4aWxpbnguY29tPgoKLS0tLQpDaGFuZ2VzIGluIHY1OgotIGNvZGUgc3R5bGUKLSBp
bi1jb2RlIGNvbW1lbnQKLSByZW1vdmUgZGVwdGggcGFyYW1ldGVyIGZyb20gc2Nhbl9wZmR0X25v
ZGUKLSBmb3IgaW5zdGVhZCBvZiBsb29wIGluIGRvbWFpbl9oYW5kbGVfZHRiX2Jvb3Rtb2R1bGUK
LSBtb3ZlICJnaWMiIGNoZWNrIHRvIGRvbWFpbl9oYW5kbGVfZHRiX2Jvb3Rtb2R1bGUKLSBhZGQg
Y2hlY2tfcGFydGlhbF9mZHQKLSB1c2UgRFRfUk9PVF9OT0RFX0FERFIvU0laRV9DRUxMU19ERUZB
VUxUCi0gYWRkIHNjYW5fcGFzc3Rocm91Z2hfcHJvcCBwYXJhbWV0ZXIsIHNldCBpdCB0byBmYWxz
ZSBmb3IgIi9hbGlhc2VzIgoKQ2hhbmdlcyBpbiB2NDoKLSB1c2UgcmVjdXJzaW9uIGluIHRoZSBp
bXBsZW1lbnRhdGlvbgotIHJlbmFtZSBoYW5kbGVfcHJvcGVydGllcyB0byBoYW5kbGVfcHJvcF9w
ZmR0Ci0gcmVuYW1lIHNjYW5fcHRfbm9kZSB0byBzY2FuX3BmZHRfbm9kZQotIHBhc3Mga2luZm8g
dG8gaGFuZGxlX3Byb3BlcnRpZXMKLSB1c2UgdWludDMyX3QgaW5zdGVhZCBvZiB1MzIKLSByZW5h
bWUgciB0byByZXMKLSBhZGQgInBhc3N0aHJvdWdoIiBhbmQgImFsaWFzZXMiIGNoZWNrCi0gYWRk
IGEgbmFtZSA9PSBOVUxMIGNoZWNrCi0gY29kZSBzdHlsZQotIG1vdmUgRFRCIGZyYWdtZW50IHNj
YW5uaW5nIGVhcmxpZXIsIGJlZm9yZSBEb21VIEdJQyBub2RlIGNyZWF0aW9uCi0gc2V0IGd1ZXN0
X3BoYW5kbGVfZ2ljIGJhc2VkIG9uICIvZ2ljIgotIGluLWNvZGUgY29tbWVudAoKQ2hhbmdlcyBp
biB2MzoKLSBzd2l0Y2ggdG8gdXNpbmcgZGV2aWNlX3RyZWVfZm9yX2VhY2hfbm9kZSBmb3IgdGhl
IGNvcHkKCkNoYW5nZXMgaW4gdjI6Ci0gYWRkIGEgbm90ZSBhYm91dCB0aGUgY29kZSBjb21pbmcg
ZnJvbSBsaWJ4bCBpbiB0aGUgY29tbWl0IG1lc3NhZ2UKLSBjb3B5IC9hbGlhc2VzCi0gY29kZSBz
dHlsZQotLS0KIHhlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyAgfCAxNTYgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysKIHhlbi9pbmNsdWRlL2FzbS1hcm0va2VybmVsLmggfCAg
IDIgKy0KIDIgZmlsZXMgY2hhbmdlZCwgMTU3IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkK
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMgYi94ZW4vYXJjaC9hcm0v
ZG9tYWluX2J1aWxkLmMKaW5kZXggMzJmODVjZDk1OS4uOWQ5ODVkM2JiZSAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCisrKyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVp
bGQuYwpAQCAtMTQsNiArMTQsNyBAQAogI2luY2x1ZGUgPHhlbi9ndWVzdF9hY2Nlc3MuaD4KICNp
bmNsdWRlIDx4ZW4vaW9jYXAuaD4KICNpbmNsdWRlIDx4ZW4vYWNwaS5oPgorI2luY2x1ZGUgPHhl
bi92bWFwLmg+CiAjaW5jbHVkZSA8eGVuL3dhcm5pbmcuaD4KICNpbmNsdWRlIDxhY3BpL2FjdGFi
bGVzLmg+CiAjaW5jbHVkZSA8YXNtL2RldmljZS5oPgpAQCAtMTcwMCw2ICsxNzAxLDE1NCBAQCBz
dGF0aWMgaW50IF9faW5pdCBtYWtlX3ZwbDAxMV91YXJ0X25vZGUoc3RydWN0IGtlcm5lbF9pbmZv
ICpraW5mbykKIH0KICNlbmRpZgogCitzdGF0aWMgaW50IF9faW5pdCBoYW5kbGVfcHJvcF9wZmR0
KHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHZvaWQgKnBmZHQsIGludCBub2Rlb2ZmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50MzJfdCBhZGRyZXNzX2NlbGxzLCB1aW50MzJfdCBzaXplX2Nl
bGxzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHNjYW5fcGFzc3Ro
cm91Z2hfcHJvcCkKK3sKKyAgICB2b2lkICpmZHQgPSBraW5mby0+ZmR0OworICAgIGludCBwcm9w
b2ZmLCBuYW1lb2ZmLCByZXM7CisgICAgY29uc3Qgc3RydWN0IGZkdF9wcm9wZXJ0eSAqcHJvcDsK
KworICAgIGZvciAoIHByb3BvZmYgPSBmZHRfZmlyc3RfcHJvcGVydHlfb2Zmc2V0KHBmZHQsIG5v
ZGVvZmYpOworICAgICAgICAgIHByb3BvZmYgPj0gMDsKKyAgICAgICAgICBwcm9wb2ZmID0gZmR0
X25leHRfcHJvcGVydHlfb2Zmc2V0KHBmZHQsIHByb3BvZmYpICkKKyAgICB7CisgICAgICAgIGlm
ICggIShwcm9wID0gZmR0X2dldF9wcm9wZXJ0eV9ieV9vZmZzZXQocGZkdCwgcHJvcG9mZiwgTlVM
TCkpICkKKyAgICAgICAgICAgIHJldHVybiAtRkRUX0VSUl9JTlRFUk5BTDsKKworICAgICAgICBu
YW1lb2ZmID0gZmR0MzJfdG9fY3B1KHByb3AtPm5hbWVvZmYpOworICAgICAgICByZXMgPSBmZHRf
cHJvcGVydHkoZmR0LCBmZHRfc3RyaW5nKHBmZHQsIG5hbWVvZmYpLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcHJvcC0+ZGF0YSwgZmR0MzJfdG9fY3B1KHByb3AtPmxlbikpOworICAgICAg
ICBpZiAoIHJlcyApCisgICAgICAgICAgICByZXR1cm4gcmVzOworICAgIH0KKworICAgIC8qIEZE
VF9FUlJfTk9URk9VTkQgPT4gVGhlcmUgaXMgbm8gbW9yZSBwcm9wZXJ0aWVzIGZvciB0aGlzIG5v
ZGUgKi8KKyAgICByZXR1cm4gKCBwcm9wb2ZmICE9IC1GRFRfRVJSX05PVEZPVU5EICkgPyBwcm9w
b2ZmIDogMDsKK30KKworc3RhdGljIGludCBfX2luaXQgc2Nhbl9wZmR0X25vZGUoc3RydWN0IGtl
cm5lbF9pbmZvICpraW5mbywgY29uc3Qgdm9pZCAqcGZkdCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBub2Rlb2ZmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdWludDMyX3QgYWRkcmVzc19jZWxscywgdWludDMyX3Qgc2l6ZV9jZWxscywKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgc2Nhbl9wYXNzdGhyb3VnaF9wcm9wKQorewor
ICAgIGludCByYyA9IDA7CisgICAgdm9pZCAqZmR0ID0ga2luZm8tPmZkdDsKKyAgICBpbnQgbm9k
ZV9uZXh0OworCisgICAgcmMgPSBmZHRfYmVnaW5fbm9kZShmZHQsIGZkdF9nZXRfbmFtZShwZmR0
LCBub2Rlb2ZmLCBOVUxMKSk7CisgICAgaWYgKCByYyApCisgICAgICAgIHJldHVybiByYzsKKwor
ICAgIHJjID0gaGFuZGxlX3Byb3BfcGZkdChraW5mbywgcGZkdCwgbm9kZW9mZiwgYWRkcmVzc19j
ZWxscywgc2l6ZV9jZWxscywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nhbl9wYXNzdGhy
b3VnaF9wcm9wKTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgcmV0dXJuIHJjOworCisgICAgYWRk
cmVzc19jZWxscyA9IGRldmljZV90cmVlX2dldF91MzIocGZkdCwgbm9kZW9mZiwgIiNhZGRyZXNz
LWNlbGxzIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEVF9ST09U
X05PREVfQUREUl9DRUxMU19ERUZBVUxUKTsKKyAgICBzaXplX2NlbGxzID0gZGV2aWNlX3RyZWVf
Z2V0X3UzMihwZmR0LCBub2Rlb2ZmLCAiI3NpemUtY2VsbHMiLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIERUX1JPT1RfTk9ERV9TSVpFX0NFTExTX0RFRkFVTFQpOworCisg
ICAgbm9kZV9uZXh0ID0gZmR0X2ZpcnN0X3N1Ym5vZGUocGZkdCwgbm9kZW9mZik7CisgICAgd2hp
bGUgKCBub2RlX25leHQgPiAwICkKKyAgICB7CisgICAgICAgIHNjYW5fcGZkdF9ub2RlKGtpbmZv
LCBwZmR0LCBub2RlX25leHQsIGFkZHJlc3NfY2VsbHMsIHNpemVfY2VsbHMsCisgICAgICAgICAg
ICAgICAgICAgICAgIHNjYW5fcGFzc3Rocm91Z2hfcHJvcCk7CisgICAgICAgIG5vZGVfbmV4dCA9
IGZkdF9uZXh0X3N1Ym5vZGUocGZkdCwgbm9kZV9uZXh0KTsKKyAgICB9CisKKyAgICByZXR1cm4g
ZmR0X2VuZF9ub2RlKGZkdCk7Cit9CisKK3N0YXRpYyBpbnQgX19pbml0IGNoZWNrX3BhcnRpYWxf
ZmR0KHZvaWQgKnBmZHQsIHNpemVfdCBzaXplKQoreworICAgIGludCByZXM7CisKKyAgICBpZiAo
ZmR0X21hZ2ljKHBmZHQpICE9IEZEVF9NQUdJQykgeworICAgICAgICBkcHJpbnRrKFhFTkxPR19F
UlIsICJQYXJ0aWFsIEZEVCBpcyBub3QgYSB2YWxpZCBGbGF0IERldmljZSBUcmVlIik7CisgICAg
ICAgIHJldHVybiAtRUlOVkFMOworICAgIH0KKworICAgIHJlcyA9IGZkdF9jaGVja19oZWFkZXIo
cGZkdCk7CisgICAgaWYgKHJlcykgeworICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIsICJGYWls
ZWQgdG8gY2hlY2sgdGhlIHBhcnRpYWwgRkRUICglZCkiLCByZXMpOworICAgICAgICByZXR1cm4g
LUVJTlZBTDsKKyAgICB9CisKKyAgICBpZiAoZmR0X3RvdGFsc2l6ZShwZmR0KSA+IHNpemUpIHsK
KyAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSLCAiUGFydGlhbCBGRFQgdG90YWxzaXplIGlzIHRv
byBiaWciKTsKKyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisgICAgfQorCisgICAgcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyBpbnQgX19pbml0IGRvbWFpbl9oYW5kbGVfZHRiX2Jvb3Rtb2R1bGUoc3Ry
dWN0IGRvbWFpbiAqZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKK3sKKyAgICB2b2lkICpwZmR0OworICAg
IGludCByZXMsIG5vZGVfbmV4dDsKKworICAgIHBmZHQgPSBpb3JlbWFwX2NhY2hlKGtpbmZvLT5k
dGJfYm9vdG1vZHVsZS0+c3RhcnQsCisgICAgICAgICAgICAgICAgICAgICAgICAga2luZm8tPmR0
Yl9ib290bW9kdWxlLT5zaXplKTsKKyAgICBpZiAoIHBmZHQgPT0gTlVMTCApCisgICAgICAgIHJl
dHVybiAtRUZBVUxUOworCisgICAgcmVzID0gY2hlY2tfcGFydGlhbF9mZHQocGZkdCwga2luZm8t
PmR0Yl9ib290bW9kdWxlLT5zaXplKTsKKyAgICBpZiAoIHJlcyA8IDAgKQorICAgICAgICByZXR1
cm4gcmVzOworCisgICAgZm9yICggbm9kZV9uZXh0ID0gZmR0X2ZpcnN0X3N1Ym5vZGUocGZkdCwg
MCk7IAorICAgICAgICAgIG5vZGVfbmV4dCA+IDA7CisgICAgICAgICAgbm9kZV9uZXh0ID0gZmR0
X25leHRfc3Vibm9kZShwZmR0LCBub2RlX25leHQpICkKKyAgICB7CisgICAgICAgIGNvbnN0IGNo
YXIgKm5hbWUgPSBmZHRfZ2V0X25hbWUocGZkdCwgbm9kZV9uZXh0LCBOVUxMKTsKKworICAgICAg
ICBpZiAoIG5hbWUgPT0gTlVMTCApCisgICAgICAgICAgICBjb250aW51ZTsKKworICAgICAgICAv
KgorICAgICAgICAgKiBPbmx5IHNjYW4gL2dpYyAvYWxpYXNlcyAvcGFzc3Rocm91Z2gsIGlnbm9y
ZSB0aGUgcmVzdC4KKyAgICAgICAgICogVGhleSBkb24ndCBoYXZlIHRvIGJlIHBhcnNlZCBpbiBv
cmRlci4KKyAgICAgICAgICoKKyAgICAgICAgICogVGFrZSB0aGUgR0lDIHBoYW5kbGUgdmFsdWUg
ZnJvbSB0aGUgc3BlY2lhbCAvZ2ljIG5vZGUgaW4gdGhlCisgICAgICAgICAqIERUQiBmcmFnbWVu
dC4KKyAgICAgICAgICovCisgICAgICAgIGlmICggZHRfbm9kZV9jbXAobmFtZSwgImdpYyIpID09
IDAgKQorICAgICAgICB7CisgICAgICAgICAgICBraW5mby0+Z3Vlc3RfcGhhbmRsZV9naWMgPSBm
ZHRfZ2V0X3BoYW5kbGUocGZkdCwgbm9kZV9uZXh0KTsKKyAgICAgICAgICAgIGNvbnRpbnVlOwor
ICAgICAgICB9CisKKyAgICAgICAgaWYgKCBkdF9ub2RlX2NtcChuYW1lLCAiYWxpYXNlcyIpID09
IDAgKQorICAgICAgICB7CisgICAgICAgICAgICByZXMgPSBzY2FuX3BmZHRfbm9kZShraW5mbywg
cGZkdCwgbm9kZV9uZXh0LAorICAgICAgICAgICAgICAgICAgICBEVF9ST09UX05PREVfQUREUl9D
RUxMU19ERUZBVUxULAorICAgICAgICAgICAgICAgICAgICBEVF9ST09UX05PREVfU0laRV9DRUxM
U19ERUZBVUxULAorICAgICAgICAgICAgICAgICAgICBmYWxzZSk7CisgICAgICAgICAgICBpZiAo
IHJlcyApCisgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKKyAgICAgICAgICAgIGNvbnRpbnVl
OworICAgICAgICB9CisgICAgICAgIGlmICggZHRfbm9kZV9jbXAobmFtZSwgInBhc3N0aHJvdWdo
IikgPT0gMCApCisgICAgICAgIHsKKyAgICAgICAgICAgIHJlcyA9IHNjYW5fcGZkdF9ub2RlKGtp
bmZvLCBwZmR0LCBub2RlX25leHQsCisgICAgICAgICAgICAgICAgICAgIERUX1JPT1RfTk9ERV9B
RERSX0NFTExTX0RFRkFVTFQsCisgICAgICAgICAgICAgICAgICAgIERUX1JPT1RfTk9ERV9TSVpF
X0NFTExTX0RFRkFVTFQsCisgICAgICAgICAgICAgICAgICAgIHRydWUpOworICAgICAgICAgICAg
aWYgKCByZXMgKQorICAgICAgICAgICAgICAgIHJldHVybiByZXM7CisgICAgICAgICAgICBjb250
aW51ZTsKKyAgICAgICAgfQorICAgIH0KKworICAgIGlvdW5tYXAocGZkdCk7CisKKyAgICByZXR1
cm4gcmVzOworfQorCiAvKgogICogVGhlIG1heCBzaXplIGZvciBEVCBpcyAyTUIuIEhvd2V2ZXIs
IHRoZSBnZW5lcmF0ZWQgRFQgaXMgc21hbGwsIDRLQgogICogYXJlIGVub3VnaCBmb3Igbm93LCBi
dXQgd2UgbWlnaHQgaGF2ZSB0byBpbmNyZWFzZSBpdCBpbiB0aGUgZnV0dXJlLgpAQCAtMTc1NSw2
ICsxOTA0LDEzIEBAIHN0YXRpYyBpbnQgX19pbml0IHByZXBhcmVfZHRiX2RvbVUoc3RydWN0IGRv
bWFpbiAqZCwgc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKICAgICBpZiAoIHJldCApCiAgICAg
ICAgIGdvdG8gZXJyOwogCisgICAgaWYgKCBraW5mby0+ZHRiX2Jvb3Rtb2R1bGUgKQorICAgIHsK
KyAgICAgICAgcmV0ID0gZG9tYWluX2hhbmRsZV9kdGJfYm9vdG1vZHVsZShkLCBraW5mbyk7Cisg
ICAgICAgIGlmICggcmV0ICkKKyAgICAgICAgICAgIHJldHVybiByZXQ7CisgICAgfQorCiAgICAg
cmV0ID0gbWFrZV9naWNfZG9tVV9ub2RlKGtpbmZvKTsKICAgICBpZiAoIHJldCApCiAgICAgICAg
IGdvdG8gZXJyOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLWFybS9rZXJuZWwuaCBiL3hl
bi9pbmNsdWRlL2FzbS1hcm0va2VybmVsLmgKaW5kZXggNzYwNDM0MzY5Yi4uN2Y1ZTY1OTU2MSAx
MDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLWFybS9rZXJuZWwuaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20tYXJtL2tlcm5lbC5oCkBAIC0yOCw3ICsyOCw3IEBAIHN0cnVjdCBrZXJuZWxfaW5mbyB7
CiAgICAgcGFkZHJfdCBnbnR0YWJfc2l6ZTsKIAogICAgIC8qIGJvb3QgYmxvYiBsb2FkIGFkZHJl
c3NlcyAqLwotICAgIGNvbnN0IHN0cnVjdCBib290bW9kdWxlICprZXJuZWxfYm9vdG1vZHVsZSwg
KmluaXRyZF9ib290bW9kdWxlOworICAgIGNvbnN0IHN0cnVjdCBib290bW9kdWxlICprZXJuZWxf
Ym9vdG1vZHVsZSwgKmluaXRyZF9ib290bW9kdWxlLCAqZHRiX2Jvb3Rtb2R1bGU7CiAgICAgY29u
c3QgY2hhciogY21kbGluZTsKICAgICBwYWRkcl90IGR0Yl9wYWRkcjsKICAgICBwYWRkcl90IGlu
aXRyZF9wYWRkcjsKLS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhl
bnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5m
by94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id BA8D1BE537
	for <lists+xen-devel@lfdr.de>; Wed, 25 Sep 2019 20:53:49 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDCM4-0004Aa-4B; Wed, 25 Sep 2019 18:49:36 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Cfsh=XU=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1iDCM2-0004AB-7a
 for xen-devel@lists.xen.org; Wed, 25 Sep 2019 18:49:34 +0000
X-Inumbo-ID: 345f5c16-dfc5-11e9-963a-12813bfff9fa
Received: from mail.kernel.org (unknown [198.145.29.99])
 by localhost (Halon) with ESMTPS
 id 345f5c16-dfc5-11e9-963a-12813bfff9fa;
 Wed, 25 Sep 2019 18:49:29 +0000 (UTC)
Received: from localhost.localdomain (c-67-164-102-47.hsd1.ca.comcast.net
 [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 76BE021D80;
 Wed, 25 Sep 2019 18:49:28 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1569437368;
 bh=zBTozPMEtVKIWHnCc3be82LaVXKKJkTnTMSJuvP4C8s=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=AthQAxdwmuBhqlhzVHFFueHt/dKSqKRnvOlhh2exCFz7KXWPtjAd3gT1dhvc0CTJX
 Tvu2+GvBbZjjppZI2+GSCCVegYxWf+FCnAHn+3yoCrBf9RTsDgfCeIHH9trjQS4tpN
 oKIZx3uJdrWqiWWh9xQdI5A0aJTeL3hDjUIf9q/8=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Wed, 25 Sep 2019 11:49:19 -0700
Message-Id: <20190925184924.21691-3-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1909251146261.24909@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1909251146261.24909@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v5 3/8] xen/arm: introduce
 kinfo->guest_phandle_gic
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW5zdGVhZCBvZiBhbHdheXMgaGFyZC1jb2RpbmcgdGhlIEdJQyBwaGFuZGxlIChHVUVTVF9QSEFO
RExFX0dJQyksIHN0b3JlCml0IGluIGEgdmFyaWFibGUgdW5kZXIga2luZm8uIFRoaXMgd2F5IGl0
IGNhbiBiZSBkeW5hbWljYWxseSBjaG9zZW4gcGVyCmRvbWFpbi4gUmVtb3ZlIHRoZSBmZHQgcG9p
bnRlciBhcmd1bWVudCB0byB0aGUgbWFrZV8qX2RvbVVfbm9kZQpmdW5jdGlvbnMgYW5kIG9hc3Mg
YSBzdHJ1Y3Qga2VybmVsX2luZm8gKiBpbnN0ZWFkLiBUaGUgZmR0IHBvaW50ZXIgY2FuCmJlIGFj
Y2Vzc2VkIGZyb20ga2luZm8tPmZkdC4gUmVtb3ZlIHRoZSBzdHJ1Y3QgZG9tYWluICpkIHBhcmFt
ZXRlciB0bwp0aGUgbWFrZV8qX2RvbVVfbm9kZSBmdW5jdGlvbnMgYmVjYXVzZSBpdCBiZWNvbWVz
IHVudXNlZC4KCkluaXRpYWxpemUgZ3Vlc3RfcGhhbmRsZV9naWMgdG8gR1VFU1RfUEhBTkRMRV9H
SUMgYXQgdGhlIGJlZ2lubmluZyBvZgpwcmVwYXJlX2R0Yl9kb21VLiBMYXRlciBwYXRjaGVzIHdp
bGwgY2hhbmdlIHRoZSB2YWx1ZSBvZgpndWVzdF9waGFuZGxlX2dpYyBkZXBlbmRpbmcgb24gdXNl
ciBwcm92aWRlZCBpbmZvcm1hdGlvbi4KClNpZ25lZC1vZmYtYnk6IFN0ZWZhbm8gU3RhYmVsbGlu
aSA8c3RlZmFub3NAeGlsaW54LmNvbT4KCi0tLQpDaGFuZ2VzIGluIHY1OgotIGltcHJvdmUgY29t
bWl0IG1lc3NhZ2UKQ2hhbmdlcyBpbiB2NDoKLSBuZXcgcGF0Y2gKLS0tCiB4ZW4vYXJjaC9hcm0v
ZG9tYWluX2J1aWxkLmMgIHwgMzYgKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0t
CiB4ZW4vaW5jbHVkZS9hc20tYXJtL2tlcm5lbC5oIHwgIDMgKysrCiAyIGZpbGVzIGNoYW5nZWQs
IDI0IGluc2VydGlvbnMoKyksIDE1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNo
L2FybS9kb21haW5fYnVpbGQuYyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYwppbmRleCAy
MTk4NTYyOGYwLi4zMmY4NWNkOTU5IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vZG9tYWluX2J1
aWxkLmMKKysrIGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCkBAIC02MjcsNyArNjI3LDgg
QEAgc3RhdGljIGludCBfX2luaXQgZmR0X3Byb3BlcnR5X2ludGVycnVwdHMoY29uc3Qgc3RydWN0
IGtlcm5lbF9pbmZvICpraW5mbywKIHsKICAgICBpbnQgcmVzOwogICAgIHVpbnQzMl90IHBoYW5k
bGUgPSBpc19oYXJkd2FyZV9kb21haW4oa2luZm8tPmQpID8KLSAgICAgICAgICAgICAgICAgICAg
ICAgZHRfaW50ZXJydXB0X2NvbnRyb2xsZXItPnBoYW5kbGUgOiBHVUVTVF9QSEFORExFX0dJQzsK
KyAgICAgICAgICAgICAgICAgICAgICAgZHRfaW50ZXJydXB0X2NvbnRyb2xsZXItPnBoYW5kbGUg
OgorICAgICAgICAgICAgICAgICAgICAgICBraW5mby0+Z3Vlc3RfcGhhbmRsZV9naWM7CiAKICAg
ICByZXMgPSBmZHRfcHJvcGVydHkoa2luZm8tPmZkdCwgImludGVycnVwdHMiLAogICAgICAgICAg
ICAgICAgICAgICAgICBpbnRyLCBzaXplb2YoaW50clswXSkgKiBudW1faXJxKTsKQEAgLTE1Mzcs
OCArMTUzOCw5IEBAIHN0YXRpYyBpbnQgX19pbml0IGhhbmRsZV9ub2RlKHN0cnVjdCBkb21haW4g
KmQsIHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8sCiAgICAgcmV0dXJuIHJlczsKIH0KIAotc3Rh
dGljIGludCBfX2luaXQgbWFrZV9naWN2Ml9kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAq
ZCwgdm9pZCAqZmR0KQorc3RhdGljIGludCBfX2luaXQgbWFrZV9naWN2Ml9kb21VX25vZGUoc3Ry
dWN0IGtlcm5lbF9pbmZvICpraW5mbykKIHsKKyAgICB2b2lkICpmZHQgPSBraW5mby0+ZmR0Owog
ICAgIGludCByZXMgPSAwOwogICAgIF9fYmUzMiByZWdbKEdVRVNUX1JPT1RfQUREUkVTU19DRUxM
UyArIEdVRVNUX1JPT1RfU0laRV9DRUxMUykgKiAyXTsKICAgICBfX2JlMzIgKmNlbGxzOwpAQCAt
MTU3MywxMSArMTU3NSwxMSBAQCBzdGF0aWMgaW50IF9faW5pdCBtYWtlX2dpY3YyX2RvbVVfbm9k
ZShjb25zdCBzdHJ1Y3QgZG9tYWluICpkLCB2b2lkICpmZHQpCiAgICAgaWYgKHJlcykKICAgICAg
ICAgcmV0dXJuIHJlczsKIAotICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgImxpbnV4
LHBoYW5kbGUiLCBHVUVTVF9QSEFORExFX0dJQyk7CisgICAgcmVzID0gZmR0X3Byb3BlcnR5X2Nl
bGwoZmR0LCAibGludXgscGhhbmRsZSIsIGtpbmZvLT5ndWVzdF9waGFuZGxlX2dpYyk7CiAgICAg
aWYgKHJlcykKICAgICAgICAgcmV0dXJuIHJlczsKIAotICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9j
ZWxsKGZkdCwgInBoYW5kbGUiLCBHVUVTVF9QSEFORExFX0dJQyk7CisgICAgcmVzID0gZmR0X3By
b3BlcnR5X2NlbGwoZmR0LCAicGhhbmRsZSIsIGtpbmZvLT5ndWVzdF9waGFuZGxlX2dpYyk7CiAg
ICAgaWYgKHJlcykKICAgICAgICAgcmV0dXJuIHJlczsKIApAQCAtMTU4Niw4ICsxNTg4LDkgQEAg
c3RhdGljIGludCBfX2luaXQgbWFrZV9naWN2Ml9kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFp
biAqZCwgdm9pZCAqZmR0KQogICAgIHJldHVybiByZXM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0
IG1ha2VfZ2ljdjNfZG9tVV9ub2RlKGNvbnN0IHN0cnVjdCBkb21haW4gKmQsIHZvaWQgKmZkdCkK
K3N0YXRpYyBpbnQgX19pbml0IG1ha2VfZ2ljdjNfZG9tVV9ub2RlKHN0cnVjdCBrZXJuZWxfaW5m
byAqa2luZm8pCiB7CisgICAgdm9pZCAqZmR0ID0ga2luZm8tPmZkdDsKICAgICBpbnQgcmVzID0g
MDsKICAgICBfX2JlMzIgcmVnWyhHVUVTVF9ST09UX0FERFJFU1NfQ0VMTFMgKyBHVUVTVF9ST09U
X1NJWkVfQ0VMTFMpICogMl07CiAgICAgX19iZTMyICpjZWxsczsKQEAgLTE2MjIsMTEgKzE2MjUs
MTEgQEAgc3RhdGljIGludCBfX2luaXQgbWFrZV9naWN2M19kb21VX25vZGUoY29uc3Qgc3RydWN0
IGRvbWFpbiAqZCwgdm9pZCAqZmR0KQogICAgIGlmIChyZXMpCiAgICAgICAgIHJldHVybiByZXM7
CiAKLSAgICByZXMgPSBmZHRfcHJvcGVydHlfY2VsbChmZHQsICJsaW51eCxwaGFuZGxlIiwgR1VF
U1RfUEhBTkRMRV9HSUMpOworICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgImxpbnV4
LHBoYW5kbGUiLCBraW5mby0+Z3Vlc3RfcGhhbmRsZV9naWMpOwogICAgIGlmIChyZXMpCiAgICAg
ICAgIHJldHVybiByZXM7CiAKLSAgICByZXMgPSBmZHRfcHJvcGVydHlfY2VsbChmZHQsICJwaGFu
ZGxlIiwgR1VFU1RfUEhBTkRMRV9HSUMpOworICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZk
dCwgInBoYW5kbGUiLCBraW5mby0+Z3Vlc3RfcGhhbmRsZV9naWMpOwogICAgIGlmIChyZXMpCiAg
ICAgICAgIHJldHVybiByZXM7CiAKQEAgLTE2MzUsMjIgKzE2MzgsMjMgQEAgc3RhdGljIGludCBf
X2luaXQgbWFrZV9naWN2M19kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAq
ZmR0KQogICAgIHJldHVybiByZXM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IG1ha2VfZ2ljX2Rv
bVVfbm9kZShjb25zdCBzdHJ1Y3QgZG9tYWluICpkLCB2b2lkICpmZHQpCitzdGF0aWMgaW50IF9f
aW5pdCBtYWtlX2dpY19kb21VX25vZGUoc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKIHsKLSAg
ICBzd2l0Y2ggKCBkLT5hcmNoLnZnaWMudmVyc2lvbiApCisgICAgc3dpdGNoICgga2luZm8tPmQt
PmFyY2gudmdpYy52ZXJzaW9uICkKICAgICB7CiAgICAgY2FzZSBHSUNfVjM6Ci0gICAgICAgIHJl
dHVybiBtYWtlX2dpY3YzX2RvbVVfbm9kZShkLCBmZHQpOworICAgICAgICByZXR1cm4gbWFrZV9n
aWN2M19kb21VX25vZGUoa2luZm8pOwogICAgIGNhc2UgR0lDX1YyOgotICAgICAgICByZXR1cm4g
bWFrZV9naWN2Ml9kb21VX25vZGUoZCwgZmR0KTsKKyAgICAgICAgcmV0dXJuIG1ha2VfZ2ljdjJf
ZG9tVV9ub2RlKGtpbmZvKTsKICAgICBkZWZhdWx0OgogICAgICAgICBwYW5pYygiVW5zdXBwb3J0
ZWQgR0lDIHZlcnNpb25cbiIpOwogICAgIH0KIH0KIAogI2lmZGVmIENPTkZJR19TQlNBX1ZVQVJU
X0NPTlNPTEUKLXN0YXRpYyBpbnQgX19pbml0IG1ha2VfdnBsMDExX3VhcnRfbm9kZShjb25zdCBz
dHJ1Y3QgZG9tYWluICpkLCB2b2lkICpmZHQpCitzdGF0aWMgaW50IF9faW5pdCBtYWtlX3ZwbDAx
MV91YXJ0X25vZGUoc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKIHsKKyAgICB2b2lkICpmZHQg
PSBraW5mby0+ZmR0OwogICAgIGludCByZXM7CiAgICAgZ2ljX2ludGVycnVwdF90IGludHI7CiAg
ICAgX19iZTMyIHJlZ1tHVUVTVF9ST09UX0FERFJFU1NfQ0VMTFMgKyBHVUVTVF9ST09UX1NJWkVf
Q0VMTFNdOwpAQCAtMTY4MSw3ICsxNjg1LDcgQEAgc3RhdGljIGludCBfX2luaXQgbWFrZV92cGww
MTFfdWFydF9ub2RlKGNvbnN0IHN0cnVjdCBkb21haW4gKmQsIHZvaWQgKmZkdCkKICAgICAgICAg
cmV0dXJuIHJlczsKIAogICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgImludGVycnVw
dC1wYXJlbnQiLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdVRVNUX1BIQU5ETEVfR0lD
KTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5mby0+Z3Vlc3RfcGhhbmRsZV9naWMp
OwogICAgIGlmICggcmVzICkKICAgICAgICAgcmV0dXJuIHJlczsKIApAQCAtMTcwNiw2ICsxNzEw
LDggQEAgc3RhdGljIGludCBfX2luaXQgcHJlcGFyZV9kdGJfZG9tVShzdHJ1Y3QgZG9tYWluICpk
LCBzdHJ1Y3Qga2VybmVsX2luZm8gKmtpbmZvKQogICAgIGludCBhZGRyY2VsbHMsIHNpemVjZWxs
czsKICAgICBpbnQgcmV0OwogCisgICAga2luZm8tPmd1ZXN0X3BoYW5kbGVfZ2ljID0gR1VFU1Rf
UEhBTkRMRV9HSUM7CisKICAgICBhZGRyY2VsbHMgPSBHVUVTVF9ST09UX0FERFJFU1NfQ0VMTFM7
CiAgICAgc2l6ZWNlbGxzID0gR1VFU1RfUk9PVF9TSVpFX0NFTExTOwogCkBAIC0xNzQ5LDcgKzE3
NTUsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBwcmVwYXJlX2R0Yl9kb21VKHN0cnVjdCBkb21haW4g
KmQsIHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8pCiAgICAgaWYgKCByZXQgKQogICAgICAgICBn
b3RvIGVycjsKIAotICAgIHJldCA9IG1ha2VfZ2ljX2RvbVVfbm9kZShkLCBraW5mby0+ZmR0KTsK
KyAgICByZXQgPSBtYWtlX2dpY19kb21VX25vZGUoa2luZm8pOwogICAgIGlmICggcmV0ICkKICAg
ICAgICAgZ290byBlcnI7CiAKQEAgLTE3NjEsNyArMTc2Nyw3IEBAIHN0YXRpYyBpbnQgX19pbml0
IHByZXBhcmVfZHRiX2RvbVUoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGtlcm5lbF9pbmZvICpr
aW5mbykKICAgICB7CiAgICAgICAgIHJldCA9IC1FSU5WQUw7CiAjaWZkZWYgQ09ORklHX1NCU0Ff
VlVBUlRfQ09OU09MRQotICAgICAgICByZXQgPSBtYWtlX3ZwbDAxMV91YXJ0X25vZGUoZCwga2lu
Zm8tPmZkdCk7CisgICAgICAgIHJldCA9IG1ha2VfdnBsMDExX3VhcnRfbm9kZShraW5mbyk7CiAj
ZW5kaWYKICAgICAgICAgaWYgKCByZXQgKQogICAgICAgICAgICAgZ290byBlcnI7CmRpZmYgLS1n
aXQgYS94ZW4vaW5jbHVkZS9hc20tYXJtL2tlcm5lbC5oIGIveGVuL2luY2x1ZGUvYXNtLWFybS9r
ZXJuZWwuaAppbmRleCAzM2YzZTcyYjExLi43NjA0MzQzNjliIDEwMDY0NAotLS0gYS94ZW4vaW5j
bHVkZS9hc20tYXJtL2tlcm5lbC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS1hcm0va2VybmVsLmgK
QEAgLTM2LDYgKzM2LDkgQEAgc3RydWN0IGtlcm5lbF9pbmZvIHsKICAgICAvKiBFbmFibGUgcGww
MTEgZW11bGF0aW9uICovCiAgICAgYm9vbCB2cGwwMTE7CiAKKyAgICAvKiBHSUMgcGhhbmRsZSAq
LworICAgIHVpbnQzMl90IGd1ZXN0X3BoYW5kbGVfZ2ljOworCiAgICAgLyogbG9hZGVyIHRvIHVz
ZSBmb3IgdGhpcyBrZXJuZWwgKi8KICAgICB2b2lkICgqbG9hZCkoc3RydWN0IGtlcm5lbF9pbmZv
ICppbmZvKTsKICAgICAvKiBsb2FkZXIgc3BlY2lmaWMgc3RhdGUgKi8KLS0gCjIuMTcuMQoKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBt
YWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMu
eGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

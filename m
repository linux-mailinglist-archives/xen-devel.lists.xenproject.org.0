Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 36EA26B2FD
	for <lists+xen-devel@lfdr.de>; Wed, 17 Jul 2019 03:04:38 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hnYK2-00054d-PX; Wed, 17 Jul 2019 01:01:30 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=o+Bt=VO=invisiblethingslab.com=marmarek@srs-us1.protection.inumbo.net>)
 id 1hnYK0-00054G-Vr
 for xen-devel@lists.xenproject.org; Wed, 17 Jul 2019 01:01:29 +0000
X-Inumbo-ID: 6763abf1-a82e-11e9-8980-bc764e045a96
Received: from new3-smtp.messagingengine.com (unknown [66.111.4.229])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 6763abf1-a82e-11e9-8980-bc764e045a96;
 Wed, 17 Jul 2019 01:01:27 +0000 (UTC)
Received: from compute7.internal (compute7.nyi.internal [10.202.2.47])
 by mailnew.nyi.internal (Postfix) with ESMTP id A45702F83;
 Tue, 16 Jul 2019 21:01:26 -0400 (EDT)
Received: from mailfrontend2 ([10.202.2.163])
 by compute7.internal (MEProxy); Tue, 16 Jul 2019 21:01:26 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:in-reply-to:message-id:mime-version:references
 :subject:to:x-me-proxy:x-me-proxy:x-me-sender:x-me-sender
 :x-sasl-enc; s=fm3; bh=AC2Lao6o/QARAgAoAa4syLbv6oH/XwjaYrpSUTCEq
 wE=; b=Wyfm842xZ1m+dvPR2cxEIrNuoG+0R/3BR/T+XDRutVjK14jVFe6JHuRZd
 vVlc7OoF9FNaoilMKaELvtQl8ZMnEgXKYzCmkAUGIj4KXc0/nIidXyJjpF5v1pSd
 fkwRVcGWOOGYbV27jC6zogdKB9AR3VQ92ky6fYTZlUuLCXUjK/16Hz4yQVynQDJk
 a+TCnv8Mfu0iJKIMH9gsZDhcxOgdJ9QaTUHe7xa8MUK+vm97mT/MGqx0yYC0CNyA
 w0fTWTo6lJN+nSlb904iKbbkLGfVeLhweqsdWk46xgRRIKXWvVSvEhOIhHmNRdiL
 Ia0H01oHMxrS6Za2FFb2Lr/EKDHyg==
X-ME-Sender: <xms:ZnMuXTdAtLHqavJAJczieVpDRbIQSucvEHCujlplObMnjLisUVUxcA>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgeduvddriedugdegvdcutefuodetggdotefrodftvf
 curfhrohhfihhlvgemucfhrghsthforghilhdpqfgfvfdpuffrtefokffrpgfnqfghnecu
 uegrihhlohhuthemuceftddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenuc
 fjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeforghrvghk
 ucforghrtgiihihkohifshhkihdqifpkrhgvtghkihcuoehmrghrmhgrrhgvkhesihhnvh
 hishhisghlvghthhhinhhgshhlrggsrdgtohhmqeenucffohhmrghinhepghhithhhuhgs
 rdgtohhmnecukfhppeeluddrieehrdefgedrfeefnecurfgrrhgrmhepmhgrihhlfhhroh
 hmpehmrghrmhgrrhgvkhesihhnvhhishhisghlvghthhhinhhgshhlrggsrdgtohhmnecu
 vehluhhsthgvrhfuihiivgeptd
X-ME-Proxy: <xmx:ZnMuXcTCmbAH1VsV_pMJGqAeNdA1NMctXTwLnk0wIVschNbYEmstzA>
 <xmx:ZnMuXXLdQTcrDKCWT07mlFTmljWAaKgZJaJNNTludzYq_Eoa0Eq4Rg>
 <xmx:ZnMuXRItGo5Lp5r9Z9veiMKEcFl5XIqW7Iq_-ZGuQprIJlHQ_31PuQ>
 <xmx:ZnMuXX-Sqm-lMABMHczg2YA3qrT4-v0bBijmpK12ZSDqqHmWWwXAjA>
Received: from localhost.localdomain (ip5b412221.dynamic.kabel-deutschland.de
 [91.65.34.33])
 by mail.messagingengine.com (Postfix) with ESMTPA id 7F6A0380086;
 Tue, 16 Jul 2019 21:01:24 -0400 (EDT)
From: =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Wed, 17 Jul 2019 03:00:42 +0200
Message-Id: <bf64e46ec03145da1887cfff4c632c86784792f6.1563325215.git-series.marmarek@invisiblethingslab.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.537da3804adbe71352bed871578f3e893e2210c5.1563325215.git-series.marmarek@invisiblethingslab.com>
References: <cover.537da3804adbe71352bed871578f3e893e2210c5.1563325215.git-series.marmarek@invisiblethingslab.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v5 4/6] xen/x86: Allow stubdom access to irq
 created for msi.
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Tim Deegan <tim@xen.org>,
 Simon Gaiser <simon@invisiblethingslab.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Brian Woods <brian.woods@amd.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U3R1YmRvbWFpbnMgbmVlZCB0byBiZSBnaXZlbiBzdWZmaWNpZW50IHByaXZpbGVnZSBvdmVyIHRo
ZSBndWVzdCB3aGljaCBpdApwcm92aWRlcyBlbXVsYXRpb24gZm9yIGluIG9yZGVyIGZvciBQQ0kg
cGFzc3Rocm91Z2ggdG8gd29yayBjb3JyZWN0bHkuCldoZW4gYSBIVk0gZG9tYWluIHRyeSB0byBl
bmFibGUgTVNJLCBRRU1VIGluIHN0dWJkb21haW4gY2FsbHMKUEhZU0RFVk9QX21hcF9waXJxLCBi
dXQgbGF0ZXIgaXQgbmVlZHMgdG8gY2FsbCBYRU5fRE9NQ1RMX2JpbmRfcHRfaXJxIGFzCnBhcnQg
b2YgeGNfZG9tYWluX3VwZGF0ZV9tc2lfaXJxLiBBbGxvdyBmb3IgdGhhdCBhcyBwYXJ0IG9mClBI
WVNERVZPUF9tYXBfcGlycS4KClRoaXMgaXMgbm90IG5lZWRlZCBmb3IgUENJIElOVHgsIGJlY2F1
c2UgSVJRIGluIHRoYXQgY2FzZSBpcyBrbm93bgpiZWZvcmVoYW5kIGFuZCB0aGUgc3R1YmRvbWFp
biBpcyBnaXZlbiBwZXJtaXNzaW9ucyBvdmVyIHRoaXMgSVJRIGJ5CmxpYnhsX19kZXZpY2VfcGNp
X2FkZCAodGhlcmUncyBhIGRvX3BjaV9hZGQgYWdhaW5zdCB0aGUgc3R1YmRvbWFpbikuCgpjcmVh
dGVfaXJxKCkgYWxyZWFkeSBncmFudCBJUlEgYWNjZXNzIHRvIGhhcmR3YXJlX2RvbWFpbiwgd2l0
aAphc3N1bXB0aW9uIHRoZSBkZXZpY2UgbW9kZWwgKHNvbWV0aGluZyBtYW5hZ2luZyB0aGlzIElS
USkgbGl2ZXMgdGhlcmUuCk1vZGlmeSBjcmVhdGVfaXJxKCkgdG8gdGFrZSBhZGRpdGlvbmFsIHBh
cmFtZXRlciBwb2ludGluZyBhdCBkZXZpY2UKbW9kZWwgZG9tYWluIC0gd2hpY2ggbWF5IGJlIGRv
bTAgb3Igc3R1YmRvbWFpbi4gIFNhdmUgSUQgb2YgdGhlIGRvbWFpbgpnaXZlbiBwZXJtaXNzaW9u
LCB0byByZXZva2UgaXQgaW4gZGVzdHJveV9pcnEoKSAtIGVhc2llciBhbmQgY2xlYW5lcgp0aGFu
IHJlcGxheWluZyBsb2dpYyBvZiBjcmVhdGVfaXJxKCkgcGFyYW1ldGVyLiBVc2UgZG9taWQgaW5z
dGVhZCBvZgphY3R1YWwgcmVmZXJlbmNlIHRvIHRoZSBkb21haW4sIGJlY2F1c2UgaXQgbWlnaHQg
Z2V0IGRlc3Ryb3llZCBiZWZvcmUKZGVzdHJveWluZyBJUlEgKHN0dWJkb21haW4gaXMgZGVzdHJv
eWVkIGJlZm9yZSBpdHMgdGFyZ2V0IGRvbWFpbikuIEFuZAppdCBpcyBub3QgYW4gaXNzdWUsIGJl
Y2F1c2UgSVJRIHBlcm1pc3Npb25zIGxpdmUgd2l0aGluIGRvbWFpbgpzdHJ1Y3R1cmUsIHNvIGRl
c3Ryb3lpbmcgYSBkb21haW4gYWxzbyBpbXBsaWNpdGx5IHJldm9rZSB0aGUgcGVybWlzc2lvbi4K
UG90ZW50aWFsIGRvbWlkIHJldXNlIGlzIGRldGVjdGVkIGJ5IGJ5IGNoZWNraW5nIGlmIHRoYXQg
ZG9tYWluIGRvZXMKaGF2ZSBwZXJtaXNzaW9uIG92ZXIgdGhlIElSUSBiZWluZyBkZXN0cm95ZWQu
CgpUaGVuLCBhZGp1c3QgYWxsIGNhbGxlcnMgdG8gcHJvdmlkZSB0aGUgcGFyYW1ldGVyLiBJbiBj
YXNlIG9mIGNhbGxzIG5vdApyZWxhdGVkIHRvIHN0dWJkb21haW4taW5pdGlhdGVkIGFsbG9jYXRp
b25zLCBnaXZlIGl0IGVpdGhlcgpoYXJkd2FyZV9kb21haW4gKHNvIHRoZSBiZWhhdmlvciBpcyB1
bmNoYW5nZWQgdGhlcmUpLCBvciBOVUxMIGZvcgppbnRlcnJ1cHRzIHVzZWQgYnkgWGVuIGludGVy
bmFsbHkuCgpJbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vT3BlblhUL3hlbmNsaWVudC1v
ZS9ibG9iLzVlMGU3MzA0YTVhM2M3NWVmMDEyNDBhMWUzNjczNjY1YjJhYWYwNWUvcmVjaXBlcy1l
eHRlbmRlZC94ZW4vZmlsZXMvc3R1YmRvbWFpbi1tc2ktaXJxLWFjY2Vzcy5wYXRjaCBieSBFcmlj
IENoYW51ZGV0IDxjaGFudWRldGVAYWluZm9zZWMuY29tPi4KClNpZ25lZC1vZmYtYnk6IFNpbW9u
IEdhaXNlciA8c2ltb25AaW52aXNpYmxldGhpbmdzbGFiLmNvbT4KU2lnbmVkLW9mZi1ieTogTWFy
ZWsgTWFyY3p5a293c2tpLUfDs3JlY2tpIDxtYXJtYXJla0BpbnZpc2libGV0aGluZ3NsYWIuY29t
PgotLS0KQ2hhbmdlcyBpbiB2MzoKIC0gZXh0ZW5kIGNvbW1pdCBtZXNzYWdlCkNoYW5nZXMgaW4g
djQ6CiAtIGFkZCBtaXNzaW5nIGRlc3Ryb3lfaXJxIG9uIGVycm9yIHBhdGgKQ2hhbmdlcyBpbiB2
NToKIC0gbW92ZSBpcnFfe2dyYW50LHJldm9rZX1fYWNjZXNzKCkgdG8ge2NyZWF0ZSxkZXN0cm95
fV9pcnEoKSwgd2hpY2gKICAgYmFzaWNhbGx5IG1ha2UgaXQgYSBkaWZmZXJlbnQgcGF0Y2gKIC0g
YWRkIGdldF9kbV9kb21haW4oKSBoZWxwZXIKIC0gZG8gbm90IGdpdmUgaGFyZHdhcmVfZG9tYWlu
IHBlcm1pc3Npb24gb3ZlciBJUlFzIHVzZWQgaW4gWGVuCiAgIGludGVybmFsbHkKIC0gcmVuYW1l
IGNyZWF0ZV9pcnEgYXJndW1lbnQgdG8ganVzdCAnZCcsIHRvIGF2b2lkIGNvbmZ1c2lvbgogICB3
aGVuIGl0J3MgY2FsbGVkIGJ5IGhhcmR3YXJlIGRvbWFpbgogLSB2ZXJpZnkgdGhhdCBkZXZpY2Ug
aXMgZGUtYXNzaWduZWQgYmVmb3JlIHBjaV9yZW1vdmVfZGV2aWNlIGNhbGwKIC0gc2F2ZSBJRCBv
ZiBkb21haW4gZ2l2ZW4gcGVybWlzc2lvbiBpbiBjcmVhdGVfaXJxKCksIHRvIHJldm9rZSBpdCBp
bgogZGVzdHJveV9pcnEoKQogLSBkcm9wIGRvbWFpbiBwYXJhbWV0ZXIgZnJvbSBkZXN0cm95X2ly
cSgpIGFuZCBtc2lfZnJlZV9pcnEoKQogLSBkbyBub3QgZ2l2ZSBoYXJkd2FyZSBkb21haW4gcGVy
bWlzc2lvbiBvdmVyIElSUSBjcmVhdGVkIGluCiBpb21tdV9zZXRfaW50ZXJydXB0KCkKLS0tCiB4
ZW4vYXJjaC94ODYvaHBldC5jICAgICAgICAgICAgICAgICAgICAgIHwgIDMgKy0KIHhlbi9hcmNo
L3g4Ni9pcnEuYyAgICAgICAgICAgICAgICAgICAgICAgfCA1MSArKysrKysrKysrKysrKysrKyst
LS0tLS0tCiB4ZW4vY29tbW9uL2lycS5jICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEgKy0K
IHhlbi9kcml2ZXJzL2NoYXIvbnMxNjU1MC5jICAgICAgICAgICAgICAgfCAgMiArLQogeGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYyB8ICAyICstCiB4ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9wY2kuYyAgICAgICAgICAgIHwgIDMgKy0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jICAgICAgfCAgMyArLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9pcnEuaCAg
ICAgICAgICAgICAgICB8ICAyICstCiB4ZW4vaW5jbHVkZS94ZW4vaXJxLmggICAgICAgICAgICAg
ICAgICAgIHwgIDEgKy0KIDkgZmlsZXMgY2hhbmdlZCwgNTAgaW5zZXJ0aW9ucygrKSwgMTggZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2hwZXQuYyBiL3hlbi9hcmNoL3g4
Ni9ocGV0LmMKaW5kZXggNGIwODQ4OC4uYjQ4NTRmZiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2
L2hwZXQuYworKysgYi94ZW4vYXJjaC94ODYvaHBldC5jCkBAIC0xMSw2ICsxMSw3IEBACiAjaW5j
bHVkZSA8eGVuL3NvZnRpcnEuaD4KICNpbmNsdWRlIDx4ZW4vaXJxLmg+CiAjaW5jbHVkZSA8eGVu
L251bWEuaD4KKyNpbmNsdWRlIDx4ZW4vc2NoZWQuaD4KICNpbmNsdWRlIDxhc20vZml4bWFwLmg+
CiAjaW5jbHVkZSA8YXNtL2RpdjY0Lmg+CiAjaW5jbHVkZSA8YXNtL2hwZXQuaD4KQEAgLTM2OCw3
ICszNjksNyBAQCBzdGF0aWMgaW50IF9faW5pdCBocGV0X2Fzc2lnbl9pcnEoc3RydWN0IGhwZXRf
ZXZlbnRfY2hhbm5lbCAqY2gpCiB7CiAgICAgaW50IGlycTsKIAotICAgIGlmICggKGlycSA9IGNy
ZWF0ZV9pcnEoTlVNQV9OT19OT0RFKSkgPCAwICkKKyAgICBpZiAoIChpcnEgPSBjcmVhdGVfaXJx
KE5VTUFfTk9fTk9ERSwgaGFyZHdhcmVfZG9tYWluKSkgPCAwICkKICAgICAgICAgcmV0dXJuIGly
cTsKIAogICAgIGNoLT5tc2kuaXJxID0gaXJxOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2ly
cS5jIGIveGVuL2FyY2gveDg2L2lycS5jCmluZGV4IDJjYWMyOGEuLmRjNWQzMDIgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9pcnEuYworKysgYi94ZW4vYXJjaC94ODYvaXJxLmMKQEAgLTE2NCwx
MCArMTY0LDIxIEBAIGludCBfX2luaXQgYmluZF9pcnFfdmVjdG9yKGludCBpcnEsIGludCB2ZWN0
b3IsIGNvbnN0IGNwdW1hc2tfdCAqY3B1X21hc2spCiAgICAgcmV0dXJuIHJldDsKIH0KIAorc3Rh
dGljIHN0cnVjdCBkb21haW4gKmdldF9kbV9kb21haW4oc3RydWN0IGRvbWFpbiAqZCkKK3sKKyAg
ICByZXR1cm4gY3VycmVudC0+ZG9tYWluLT50YXJnZXQgPT0gZCA/IGN1cnJlbnQtPmRvbWFpbiA6
IGhhcmR3YXJlX2RvbWFpbjsKK30KKwogLyoKICAqIER5bmFtaWMgaXJxIGFsbG9jYXRlIGFuZCBk
ZWFsbG9jYXRpb24gZm9yIE1TSQogICovCi1pbnQgY3JlYXRlX2lycShub2RlaWRfdCBub2RlKQor
CisvKgorICogY3JlYXRlX2lycSAtIGFsbG9jYXRlIGlycSBmb3IgTVNJCisgKiBAZCBkb21haW4g
dGhhdCB3aWxsIGdldCBwZXJtaXNzaW9uIG92ZXIgdGhlIGFsbG9jYXRlZCBpcnE7IHRoaXMgcGVy
bWlzc2lvbgorICogd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHJldm9rZWQgb24gZGVzdHJveV9pcnEK
KyAqLworaW50IGNyZWF0ZV9pcnEobm9kZWlkX3Qgbm9kZSwgc3RydWN0IGRvbWFpbiAqZCkKIHsK
ICAgICBpbnQgaXJxLCByZXQ7CiAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjOwpAQCAtMjAwLDE4
ICsyMTEsMjQgQEAgaW50IGNyZWF0ZV9pcnEobm9kZWlkX3Qgbm9kZSkKICAgICAgICAgZGVzYy0+
YXJjaC51c2VkID0gSVJRX1VOVVNFRDsKICAgICAgICAgaXJxID0gcmV0OwogICAgIH0KLSAgICBl
bHNlIGlmICggaGFyZHdhcmVfZG9tYWluICkKKyAgICBlbHNlIGlmICggZCApCiAgICAgewotICAg
ICAgICByZXQgPSBpcnFfcGVybWl0X2FjY2VzcyhoYXJkd2FyZV9kb21haW4sIGlycSk7CisgICAg
ICAgIEFTU0VSVChkID09IGN1cnJlbnQtPmRvbWFpbik7CisgICAgICAgIHJldCA9IGlycV9wZXJt
aXRfYWNjZXNzKGQsIGlycSk7CiAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgIHByaW50
ayhYRU5MT0dfR19FUlIKLSAgICAgICAgICAgICAgICAgICAiQ291bGQgbm90IGdyYW50IERvbTAg
YWNjZXNzIHRvIElSUSVkIChlcnJvciAlZClcbiIsCi0gICAgICAgICAgICAgICAgICAgaXJxLCBy
ZXQpOworICAgICAgICAgICAgICAgICAgICJDb3VsZCBub3QgZ3JhbnQgRG9tJXUgYWNjZXNzIHRv
IElSUSVkIChlcnJvciAlZClcbiIsCisgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCBp
cnEsIHJldCk7CisgICAgICAgIGVsc2UKKyAgICAgICAgICAgIGRlc2MtPmNyZWF0b3JfZG9taWQg
PSBkLT5kb21haW5faWQ7CiAgICAgfQogCiAgICAgcmV0dXJuIGlycTsKIH0KIAorLyoKKyAqIGRl
c3Ryb3lfaXJxIC0gZGVhbGxvY2F0ZSBpcnEgZm9yIE1TSQorICovCiB2b2lkIGRlc3Ryb3lfaXJx
KHVuc2lnbmVkIGludCBpcnEpCiB7CiAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjID0gaXJxX3Rv
X2Rlc2MoaXJxKTsKQEAgLTIyMCwxNCArMjM3LDIyIEBAIHZvaWQgZGVzdHJveV9pcnEodW5zaWdu
ZWQgaW50IGlycSkKIAogICAgIEJVR19PTighTVNJX0lSUShpcnEpKTsKIAotICAgIGlmICggaGFy
ZHdhcmVfZG9tYWluICkKKyAgICBpZiAoIGRlc2MtPmNyZWF0b3JfZG9taWQgIT0gRE9NSURfSU5W
QUxJRCApCiAgICAgewotICAgICAgICBpbnQgZXJyID0gaXJxX2RlbnlfYWNjZXNzKGhhcmR3YXJl
X2RvbWFpbiwgaXJxKTsKKyAgICAgICAgc3RydWN0IGRvbWFpbiAqZCA9IGdldF9kb21haW5fYnlf
aWQoZGVzYy0+Y3JlYXRvcl9kb21pZCk7CiAKLSAgICAgICAgaWYgKCBlcnIgKQotICAgICAgICAg
ICAgcHJpbnRrKFhFTkxPR19HX0VSUgotICAgICAgICAgICAgICAgICAgICJDb3VsZCBub3QgcmV2
b2tlIERvbTAgYWNjZXNzIHRvIElSUSV1IChlcnJvciAlZClcbiIsCi0gICAgICAgICAgICAgICAg
ICAgaXJxLCBlcnIpOworICAgICAgICBpZiAoIGQgJiYgaXJxX2FjY2Vzc19wZXJtaXR0ZWQoZCwg
aXJxKSApIHsKKyAgICAgICAgICAgIGludCBlcnI7CisKKyAgICAgICAgICAgIGVyciA9IGlycV9k
ZW55X2FjY2VzcyhkLCBpcnEpOworICAgICAgICAgICAgaWYgKCBlcnIgKQorICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfR19FUlIKKyAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkIG5v
dCByZXZva2UgRG9tJXUgYWNjZXNzIHRvIElSUSV1IChlcnJvciAlZClcbiIsCisgICAgICAgICAg
ICAgICAgICAgICAgIGQtPmRvbWFpbl9pZCwgaXJxLCBlcnIpOworICAgICAgICB9CisKKyAgICAg
ICAgaWYgKCBkICkKKyAgICAgICAgICAgIHB1dF9kb21haW4oZCk7CiAgICAgfQogCiAgICAgc3Bp
bl9sb2NrX2lycXNhdmUoJmRlc2MtPmxvY2ssIGZsYWdzKTsKQEAgLTIwNTgsNyArMjA4Myw3IEBA
IGludCBtYXBfZG9tYWluX3BpcnEoCiAgICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZkZXNjLT5sb2NrLCBmbGFncyk7CiAKICAgICAgICAgICAgIGluZm8gPSBOVUxMOwotICAgICAg
ICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05PREUpOworICAgICAgICAgICAgaXJxID0g
Y3JlYXRlX2lycShOVU1BX05PX05PREUsIGdldF9kbV9kb21haW4oZCkpOwogICAgICAgICAgICAg
cmV0ID0gaXJxID49IDAgPyBwcmVwYXJlX2RvbWFpbl9pcnFfcGlycShkLCBpcnEsIHBpcnEgKyBu
ciwgJmluZm8pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGlycTsKICAgICAgICAgICAg
IGlmICggcmV0IDwgMCApCkBAIC0yNjkxLDcgKzI3MTYsNyBAQCBpbnQgYWxsb2NhdGVfYW5kX21h
cF9tc2lfcGlycShzdHJ1Y3QgZG9tYWluICpkLCBpbnQgaW5kZXgsIGludCAqcGlycV9wLAogICAg
ICAgICBpZiAoIGlycSA9PSAtMSApCiAgICAgICAgIHsKICAgICBjYXNlIE1BUF9QSVJRX1RZUEVf
TVVMVElfTVNJOgotICAgICAgICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05PREUpOwor
ICAgICAgICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05PREUsIGdldF9kbV9kb21haW4o
ZCkpOwogICAgICAgICB9CiAKICAgICAgICAgaWYgKCBpcnEgPCBucl9pcnFzX2dzaSB8fCBpcnEg
Pj0gbnJfaXJxcyApCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2lycS5jIGIveGVuL2NvbW1vbi9p
cnEuYwppbmRleCBmNDI1MTJkLi40MmIyN2E5IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL2lycS5j
CisrKyBiL3hlbi9jb21tb24vaXJxLmMKQEAgLTE2LDYgKzE2LDcgQEAgaW50IGluaXRfb25lX2ly
cV9kZXNjKHN0cnVjdCBpcnFfZGVzYyAqZGVzYykKICAgICBzcGluX2xvY2tfaW5pdCgmZGVzYy0+
bG9jayk7CiAgICAgY3B1bWFza19zZXRhbGwoZGVzYy0+YWZmaW5pdHkpOwogICAgIElOSVRfTElT
VF9IRUFEKCZkZXNjLT5ybF9saW5rKTsKKyAgICBkZXNjLT5jcmVhdG9yX2RvbWlkID0gRE9NSURf
SU5WQUxJRDsKIAogICAgIGVyciA9IGFyY2hfaW5pdF9vbmVfaXJxX2Rlc2MoZGVzYyk7CiAgICAg
aWYgKCBlcnIgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMgYi94ZW4v
ZHJpdmVycy9jaGFyL25zMTY1NTAuYwppbmRleCAxODllMTIxLi5jY2M4YjA0IDEwMDY0NAotLS0g
YS94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYworKysgYi94ZW4vZHJpdmVycy9jaGFyL25zMTY1
NTAuYwpAQCAtNzE5LDcgKzcxOSw3IEBAIHN0YXRpYyB2b2lkIF9faW5pdCBuczE2NTUwX2luaXRf
aXJxKHN0cnVjdCBzZXJpYWxfcG9ydCAqcG9ydCkKICAgICBzdHJ1Y3QgbnMxNjU1MCAqdWFydCA9
IHBvcnQtPnVhcnQ7CiAKICAgICBpZiAoIHVhcnQtPm1zaSApCi0gICAgICAgIHVhcnQtPmlycSA9
IGNyZWF0ZV9pcnEoMCk7CisgICAgICAgIHVhcnQtPmlycSA9IGNyZWF0ZV9pcnEoMCwgTlVMTCk7
CiAjZW5kaWYKIH0KIApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X2luaXQuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMKaW5k
ZXggNGU3NmIyNi4uNTA3ODVlMCAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVf
aW5pdC5jCkBAIC03ODEsNyArNzgxLDcgQEAgc3RhdGljIGJvb2xfdCBfX2luaXQgc2V0X2lvbW11
X2ludGVycnVwdF9oYW5kbGVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQogICAgIGh3X2lycV9j
b250cm9sbGVyICpoYW5kbGVyOwogICAgIHUxNiBjb250cm9sOwogCi0gICAgaXJxID0gY3JlYXRl
X2lycShOVU1BX05PX05PREUpOworICAgIGlycSA9IGNyZWF0ZV9pcnEoTlVNQV9OT19OT0RFLCBO
VUxMKTsKICAgICBpZiAoIGlycSA8PSAwICkKICAgICB7CiAgICAgICAgIGRwcmludGsoWEVOTE9H
X0VSUiwgIklPTU1VOiBubyBpcnFzXG4iKTsKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL3BjaS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMKaW5kZXggZTg4Njg5
NC4uNTA3YjNkMSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMKKysr
IGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMKQEAgLTg0NSw2ICs4NDUsOSBAQCBpbnQg
cGNpX3JlbW92ZV9kZXZpY2UodTE2IHNlZywgdTggYnVzLCB1OCBkZXZmbikKICAgICBsaXN0X2Zv
cl9lYWNoX2VudHJ5ICggcGRldiwgJnBzZWctPmFsbGRldnNfbGlzdCwgYWxsZGV2c19saXN0ICkK
ICAgICAgICAgaWYgKCBwZGV2LT5idXMgPT0gYnVzICYmIHBkZXYtPmRldmZuID09IGRldmZuICkK
ICAgICAgICAgeworICAgICAgICAgICAgcmV0ID0gLUVCVVNZOworICAgICAgICAgICAgaWYgKCBw
ZGV2LT5kb21haW4gJiYgcGRldi0+ZG9tYWluICE9IGhhcmR3YXJlX2RvbWFpbiApCisgICAgICAg
ICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICByZXQgPSBpb21tdV9yZW1vdmVfZGV2aWNlKHBk
ZXYpOwogICAgICAgICAgICAgaWYgKCBwZGV2LT5kb21haW4gKQogICAgICAgICAgICAgICAgIGxp
c3RfZGVsKCZwZGV2LT5kb21haW5fbGlzdCk7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5j
CmluZGV4IDhiMjdkN2UuLjc5Zjk2ODIgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5j
CkBAIC0xMTM4LDcgKzExMzgsOCBAQCBzdGF0aWMgaW50IF9faW5pdCBpb21tdV9zZXRfaW50ZXJy
dXB0KHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCkKICAgICBzdHJ1Y3QgaXJxX2Rlc2MgKmRl
c2M7CiAKICAgICBpcnEgPSBjcmVhdGVfaXJxKHJoc2EgPyBweG1fdG9fbm9kZShyaHNhLT5wcm94
aW1pdHlfZG9tYWluKQotICAgICAgICAgICAgICAgICAgICAgICAgICA6IE5VTUFfTk9fTk9ERSk7
CisgICAgICAgICAgICAgICAgICAgICAgICAgIDogTlVNQV9OT19OT0RFLAorICAgICAgICAgICAg
ICAgICAgICAgTlVMTCk7CiAgICAgaWYgKCBpcnEgPD0gMCApCiAgICAgewogICAgICAgICBkcHJp
bnRrKFhFTkxPR19FUlIgVlREUFJFRklYLCAiSU9NTVU6IG5vIGlycSBhdmFpbGFibGUhXG4iKTsK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaXJxLmggYi94ZW4vaW5jbHVkZS9hc20t
eDg2L2lycS5oCmluZGV4IGMwYzZlN2MuLjViMjQ0MjggMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRl
L2FzbS14ODYvaXJxLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9pcnEuaApAQCAtMTU1LDcg
KzE1NSw3IEBAIGludCAgaW5pdF9pcnFfZGF0YSh2b2lkKTsKIHZvaWQgY2xlYXJfaXJxX3ZlY3Rv
cihpbnQgaXJxKTsKIAogaW50IGlycV90b192ZWN0b3IoaW50IGlycSk7Ci1pbnQgY3JlYXRlX2ly
cShub2RlaWRfdCBub2RlKTsKK2ludCBjcmVhdGVfaXJxKG5vZGVpZF90IG5vZGUsIHN0cnVjdCBk
b21haW4gKmQpOwogdm9pZCBkZXN0cm95X2lycSh1bnNpZ25lZCBpbnQgaXJxKTsKIGludCBhc3Np
Z25faXJxX3ZlY3RvcihpbnQgaXJxLCBjb25zdCBjcHVtYXNrX3QgKik7CiAKZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL3hlbi9pcnEuaCBiL3hlbi9pbmNsdWRlL3hlbi9pcnEuaAppbmRleCA1ODZi
NzgzLi5jN2E2YTgzIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vaXJxLmgKKysrIGIveGVu
L2luY2x1ZGUveGVuL2lycS5oCkBAIC05MSw2ICs5MSw3IEBAIHR5cGVkZWYgc3RydWN0IGlycV9k
ZXNjIHsKICAgICBzcGlubG9ja190IGxvY2s7CiAgICAgc3RydWN0IGFyY2hfaXJxX2Rlc2MgYXJj
aDsKICAgICBjcHVtYXNrX3Zhcl90IGFmZmluaXR5OworICAgIGRvbWlkX3QgY3JlYXRvcl9kb21p
ZDsgLyogd2VhayByZWZlcmVuY2UgdG8gZG9tYWluIGhhbmRsaW5nIHRoaXMgSVJRICovCiAKICAg
ICAvKiBpcnEgcmF0ZWxpbWl0ICovCiAgICAgc190aW1lX3QgcmxfcXVhbnR1bV9zdGFydDsKLS0g
CmdpdC1zZXJpZXMgMC45LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2pl
Y3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4t
ZGV2ZWw=

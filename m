Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id F2398BFFA5
	for <lists+xen-devel@lfdr.de>; Fri, 27 Sep 2019 09:04:57 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDkFP-00033P-Nd; Fri, 27 Sep 2019 07:00:59 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=Rbpq=XW=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iDkFN-00033J-Tz
 for xen-devel@lists.xenproject.org; Fri, 27 Sep 2019 07:00:57 +0000
X-Inumbo-ID: 8d43251c-e0f4-11e9-bf31-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 8d43251c-e0f4-11e9-bf31-bc764e2007e4;
 Fri, 27 Sep 2019 07:00:56 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 48B66ACEF;
 Fri, 27 Sep 2019 07:00:55 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 27 Sep 2019 09:00:07 +0200
Message-Id: <20190927070050.12405-4-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190927070050.12405-1-jgross@suse.com>
References: <20190927070050.12405-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v4 03/46] xen/sched: build a linked list of
 struct sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gb3JkZXIgdG8gbWFrZSBpdCBlYXN5IHRvIGl0ZXJhdGUgb3ZlciBzY2hlZF91bml0IGVsZW1l
bnRzIG9mIGEKZG9tYWluLCBidWlsZCBhIHNpbmdsZSBsaW5rZWQgbGlzdCBhbmQgYWRkIGFuIGl0
ZXJhdG9yIGZvciBpdC4gVGhlIG5ldwpsaXN0IGlzIGd1YXJkZWQgYnkgdGhlIHNhbWUgbWVjaGFu
aXNtcyBhcyB0aGUgdmNwdSBsaW5rZWQgbGlzdCBhcyBpdAppcyBtb2RpZmllZCBvbmx5IHZpYSB2
Y3B1X2NyZWF0ZSgpIG9yIHZjcHVfZGVzdHJveSgpLgoKRm9yIGNvbXBsZXRlbmVzcyBhZGQgYW5v
dGhlciBpdGVyYXRvciBmb3JfZWFjaF9zY2hlZF91bml0X3ZjcHUoKSB3aGljaAp3aWxsIGl0ZXJh
dGUgb3ZlciBhbGwgdmNwdXMgb2YgYSBzY2hlZF91bml0IChyaWdodCBub3cgb25seSBvbmUpLiBU
aGlzCndpbGwgYmUgbmVlZGVkIGxhdGVyIGZvciBsYXJnZXIgc2NoZWR1bGluZyBncmFudWxhcml0
eSAoZS5nLiBjb3JlcykuCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3Vz
ZS5jb20+ClJldmlld2VkLWJ5OiBEYXJpbyBGYWdnaW9saSA8ZGZhZ2dpb2xpQHN1c2UuY29tPgot
LS0KVjI6Ci0gYWRkIGNvbW1lbnQgKERhcmlvIEZhZ2dpb2xpKQpWNDoKLSByZW5hbWUgaXRlcmF0
b3IgbWFjcm8gcGFyYW1ldGVycyAoSmFuIEJldWxpY2gpCi0gbW9kaWZ5IGZvcl9lYWNoX3NjaGVk
X3VuaXRfdmNwdSgpIGVuZCBjb25kaXRpb24gKEphbiBCZXVsaWNoKQotLS0KIHhlbi9jb21tb24v
c2NoZWR1bGUuYyAgIHwgNjEgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KystLS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggfCAxNiArKysrKysrKysrKysrCiAy
IGZpbGVzIGNoYW5nZWQsIDY4IGluc2VydGlvbnMoKyksIDkgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jIGIveGVuL2NvbW1vbi9zY2hlZHVsZS5jCmluZGV4
IDZiZTMwYzkxNjEuLmQzNGI3ODlhOGYgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWR1bGUu
YworKysgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKQEAgLTMwNSw2ICszMDUsNTUgQEAgc3RhdGlj
IHZvaWQgc2NoZWRfc3Bpbl91bmxvY2tfZG91YmxlKHNwaW5sb2NrX3QgKmxvY2sxLCBzcGlubG9j
a190ICpsb2NrMiwKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKGxvY2sxLCBmbGFncyk7CiB9
CiAKK3N0YXRpYyB2b2lkIHNjaGVkX2ZyZWVfdW5pdChzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkK
K3sKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqcHJldl91bml0OworICAgIHN0cnVjdCBkb21haW4g
KmQgPSB1bml0LT5kb21haW47CisKKyAgICBpZiAoIGQtPnNjaGVkX3VuaXRfbGlzdCA9PSB1bml0
ICkKKyAgICAgICAgZC0+c2NoZWRfdW5pdF9saXN0ID0gdW5pdC0+bmV4dF9pbl9saXN0OworICAg
IGVsc2UKKyAgICB7CisgICAgICAgIGZvcl9lYWNoX3NjaGVkX3VuaXQgKCBkLCBwcmV2X3VuaXQg
KQorICAgICAgICB7CisgICAgICAgICAgICBpZiAoIHByZXZfdW5pdC0+bmV4dF9pbl9saXN0ID09
IHVuaXQgKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHByZXZfdW5pdC0+bmV4dF9p
bl9saXN0ID0gdW5pdC0+bmV4dF9pbl9saXN0OworICAgICAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICAgICAgfQorICAgICAgICB9CisgICAgfQorCisgICAgdW5pdC0+dmNwdV9saXN0LT5zY2hl
ZF91bml0ID0gTlVMTDsKKyAgICB4ZnJlZSh1bml0KTsKK30KKworc3RhdGljIHN0cnVjdCBzY2hl
ZF91bml0ICpzY2hlZF9hbGxvY191bml0KHN0cnVjdCB2Y3B1ICp2KQoreworICAgIHN0cnVjdCBz
Y2hlZF91bml0ICp1bml0LCAqKnByZXZfdW5pdDsKKyAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+
ZG9tYWluOworCisgICAgaWYgKCAodW5pdCA9IHh6YWxsb2Moc3RydWN0IHNjaGVkX3VuaXQpKSA9
PSBOVUxMICkKKyAgICAgICAgcmV0dXJuIE5VTEw7CisKKyAgICB1bml0LT52Y3B1X2xpc3QgPSB2
OworICAgIHVuaXQtPnVuaXRfaWQgPSB2LT52Y3B1X2lkOworICAgIHVuaXQtPmRvbWFpbiA9IGQ7
CisKKyAgICBmb3IgKCBwcmV2X3VuaXQgPSAmZC0+c2NoZWRfdW5pdF9saXN0OyAqcHJldl91bml0
OworICAgICAgICAgIHByZXZfdW5pdCA9ICYoKnByZXZfdW5pdCktPm5leHRfaW5fbGlzdCApCisg
ICAgICAgIGlmICggKCpwcmV2X3VuaXQpLT5uZXh0X2luX2xpc3QgJiYKKyAgICAgICAgICAgICAo
KnByZXZfdW5pdCktPm5leHRfaW5fbGlzdC0+dW5pdF9pZCA+IHVuaXQtPnVuaXRfaWQgKQorICAg
ICAgICAgICAgYnJlYWs7CisKKyAgICB1bml0LT5uZXh0X2luX2xpc3QgPSAqcHJldl91bml0Owor
ICAgICpwcmV2X3VuaXQgPSB1bml0OworCisgICAgdi0+c2NoZWRfdW5pdCA9IHVuaXQ7CisKKyAg
ICByZXR1cm4gdW5pdDsKK30KKwogaW50IHNjaGVkX2luaXRfdmNwdShzdHJ1Y3QgdmNwdSAqdiwg
dW5zaWduZWQgaW50IHByb2Nlc3NvcikKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+ZG9t
YWluOwpAQCAtMzEyLDExICszNjEsOCBAQCBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1
ICp2LCB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yKQogCiAgICAgdi0+cHJvY2Vzc29yID0gcHJvY2Vz
c29yOwogCi0gICAgaWYgKCAodW5pdCA9IHh6YWxsb2Moc3RydWN0IHNjaGVkX3VuaXQpKSA9PSBO
VUxMICkKKyAgICBpZiAoICh1bml0ID0gc2NoZWRfYWxsb2NfdW5pdCh2KSkgPT0gTlVMTCApCiAg
ICAgICAgIHJldHVybiAxOwotICAgIHVuaXQtPnZjcHVfbGlzdCA9IHY7Ci0gICAgdW5pdC0+dW5p
dF9pZCA9IHYtPnZjcHVfaWQ7Ci0gICAgdW5pdC0+ZG9tYWluID0gZDsKIAogICAgIC8qIEluaXRp
YWxpc2UgdGhlIHBlci12Y3B1IHRpbWVycy4gKi8KICAgICBzcGluX2xvY2tfaW5pdCgmdi0+cGVy
aW9kaWNfdGltZXJfbG9jayk7CkBAIC0zMzAsMTIgKzM3NiwxMCBAQCBpbnQgc2NoZWRfaW5pdF92
Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yKQogICAgIHVuaXQtPnBy
aXYgPSBzY2hlZF9hbGxvY191ZGF0YShkb21fc2NoZWR1bGVyKGQpLCB1bml0LCBkLT5zY2hlZF9w
cml2KTsKICAgICBpZiAoIHVuaXQtPnByaXYgPT0gTlVMTCApCiAgICAgewotICAgICAgICB4ZnJl
ZSh1bml0KTsKKyAgICAgICAgc2NoZWRfZnJlZV91bml0KHVuaXQpOwogICAgICAgICByZXR1cm4g
MTsKICAgICB9CiAKLSAgICB2LT5zY2hlZF91bml0ID0gdW5pdDsKLQogICAgIC8qCiAgICAgICog
SW5pdGlhbGl6ZSBhZmZpbml0eSBzZXR0aW5ncy4gVGhlIGlkbGVyLCBhbmQgcG90ZW50aWFsbHkK
ICAgICAgKiBkb21haW4tMCBWQ1BVcywgYXJlIHBpbm5lZCBvbnRvIHRoZWlyIHJlc3BlY3RpdmUg
cGh5c2ljYWwgQ1BVcy4KQEAgLTQ3NSw4ICs1MTksNyBAQCB2b2lkIHNjaGVkX2Rlc3Ryb3lfdmNw
dShzdHJ1Y3QgdmNwdSAqdikKICAgICAgICAgYXRvbWljX2RlYygmcGVyX2NwdShzY2hlZHVsZV9k
YXRhLCB2LT5wcm9jZXNzb3IpLnVyZ2VudF9jb3VudCk7CiAgICAgc2NoZWRfcmVtb3ZlX3VuaXQo
dmNwdV9zY2hlZHVsZXIodiksIHVuaXQpOwogICAgIHNjaGVkX2ZyZWVfdWRhdGEodmNwdV9zY2hl
ZHVsZXIodiksIHVuaXQtPnByaXYpOwotICAgIHYtPnNjaGVkX3VuaXQgPSBOVUxMOwotICAgIHhm
cmVlKHVuaXQpOworICAgIHNjaGVkX2ZyZWVfdW5pdCh1bml0KTsKIH0KIAogaW50IHNjaGVkX2lu
aXRfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIGludCBwb29saWQpCmRpZmYgLS1naXQgYS94ZW4v
aW5jbHVkZS94ZW4vc2NoZWQuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCmluZGV4IGZiNDVk
YTA1ZWUuLjM2YjFjM2IwMTAgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCisr
KyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCkBAIC0yNzcsOSArMjc3LDI0IEBAIHN0cnVjdCBz
Y2hlZF91bml0IHsKICAgICBzdHJ1Y3QgZG9tYWluICAgICAgICAgKmRvbWFpbjsKICAgICBzdHJ1
Y3QgdmNwdSAgICAgICAgICAgKnZjcHVfbGlzdDsKICAgICB2b2lkICAgICAgICAgICAgICAgICAg
KnByaXY7ICAgICAgLyogc2NoZWR1bGVyIHByaXZhdGUgZGF0YSAqLworICAgIHN0cnVjdCBzY2hl
ZF91bml0ICAgICAqbmV4dF9pbl9saXN0OwogICAgIHVuc2lnbmVkIGludCAgICAgICAgICAgdW5p
dF9pZDsKIH07CiAKKyNkZWZpbmUgZm9yX2VhY2hfc2NoZWRfdW5pdChkLCB1KSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIGZvciAoICh1KSA9IChkKS0+c2No
ZWRfdW5pdF9saXN0OyAodSkgIT0gTlVMTDsgKHUpID0gKHUpLT5uZXh0X2luX2xpc3QgKQorCisv
KgorICogQWxsIHZjcHVzIG9mIGEgZG9tYWluIGFyZSBpbiBhIHNpbmdsZSBsaW5rZWQgbGlzdCB3
aXRoIHVuaXQtPnZjcHVfbGlzdAorICogcG9pbnRpbmcgdG8gdGhlIGZpcnN0IHZjcHUgb2YgdGhl
IHVuaXQuIFRoZSBsb29wIG11c3QgYmUgdGVybWluYXRlZCB3aGVuCisgKiBhIHZjcHUgaXMgaGl0
IG5vdCBiZWluZyBwYXJ0IG9mIHRoZSB1bml0IHRvIGxvb3Agb3Zlci4KKyAqLworI2RlZmluZSBm
b3JfZWFjaF9zY2hlZF91bml0X3ZjcHUodSwgdikgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgZm9yICggKHYpID0gKHUpLT52Y3B1X2xpc3Q7ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAodikgIT0gTlVMTCAmJiAo
ISh1KS0+bmV4dF9pbl9saXN0IHx8ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAodiktPnZjcHVfaWQgPCAodSktPm5leHRfaW5fbGlzdC0+dW5p
dF9pZCk7ICAgICBcCisgICAgICAgICAgKHYpID0gKHYpLT5uZXh0X2luX2xpc3QgKQorCiAvKiBQ
ZXItZG9tYWluIGxvY2sgY2FuIGJlIHJlY3Vyc2l2ZWx5IGFjcXVpcmVkIGluIGZhdWx0IGhhbmRs
ZXJzLiAqLwogI2RlZmluZSBkb21haW5fbG9jayhkKSBzcGluX2xvY2tfcmVjdXJzaXZlKCYoZCkt
PmRvbWFpbl9sb2NrKQogI2RlZmluZSBkb21haW5fdW5sb2NrKGQpIHNwaW5fdW5sb2NrX3JlY3Vy
c2l2ZSgmKGQpLT5kb21haW5fbG9jaykKQEAgLTMzMyw2ICszNDgsNyBAQCBzdHJ1Y3QgZG9tYWlu
CiAKICAgICAvKiBTY2hlZHVsaW5nLiAqLwogICAgIHZvaWQgICAgICAgICAgICAqc2NoZWRfcHJp
djsgICAgLyogc2NoZWR1bGVyLXNwZWNpZmljIGRhdGEgKi8KKyAgICBzdHJ1Y3Qgc2NoZWRfdW5p
dCAqc2NoZWRfdW5pdF9saXN0OwogICAgIHN0cnVjdCBjcHVwb29sICAqY3B1cG9vbDsKIAogICAg
IHN0cnVjdCBkb21haW4gICAqbmV4dF9pbl9saXN0OwotLSAKMi4xNi40CgoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlz
dApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

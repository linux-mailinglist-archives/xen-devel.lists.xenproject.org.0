Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D49E5E4BEE
	for <lists+xen-devel@lfdr.de>; Fri, 25 Oct 2019 15:21:14 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iNzSu-0002Z7-Df; Fri, 25 Oct 2019 13:17:16 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=/YrW=YS=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1iNzSs-0002Z2-QS
 for xen-devel@lists.xenproject.org; Fri, 25 Oct 2019 13:17:14 +0000
X-Inumbo-ID: c193ed1a-f729-11e9-beca-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id c193ed1a-f729-11e9-beca-bc764e2007e4;
 Fri, 25 Oct 2019 13:17:13 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 0442BB675;
 Fri, 25 Oct 2019 13:17:11 +0000 (UTC)
To: Roger Pau Monne <roger.pau@citrix.com>
References: <20191015154736.19882-1-roger.pau@citrix.com>
 <20191015154736.19882-2-roger.pau@citrix.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <5f3372dc-7fe6-ac12-c54e-84ff0d4257fa@suse.com>
Date: Fri, 25 Oct 2019 15:17:28 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20191015154736.19882-2-roger.pau@citrix.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v3 1/4] iommu/amd: support all delivery
 modes with x2APIC
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: xen-devel@lists.xenproject.org,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMTUuMTAuMjAxOSAxNzo0NywgUm9nZXIgUGF1IE1vbm5lIHdyb3RlOgo+IEN1cnJlbnQgQU1E
IElPTU1VIGNvZGUgd2lsbCBhdHRlbXB0IHRvIGNyZWF0ZSByZW1hcHBpbmcgZW50cmllcyBmb3IK
PiBhbGwgSU8tQVBJQyBwaW5zLCByZWdhcmRsZXNzIG9mIHRoZSBkZWxpdmVyeSBtb2RlLiBBTUQg
SU9NTVUKPiBpbXBsZW1lbnRhdGlvbiBkb2Vzbid0IHN1cHBvcnQgcmVtYXBwaW5nIGVudHJpZXMg
Zm9yIElPLUFQSUMgcGlucyB3aXRoCj4gZGVsaXZlcnkgbW9kZSBzZXQgdG8gU01JLCBNTkksIElO
SVQgb3IgRXh0SU5ULCBpbnN0ZWFkIHRob3NlIGVudHJpZXMKCk5pdDogIk5NSSIKCj4gYXJlIG5v
dCB0cmFuc2xhdGVkIHByb3ZpZGVkIHRoZSByaWdodCBiaXRzIGFyZSBzZXQgaW4gdGhlIGRldmlj
ZSB0YWJsZQo+IGVudHJ5Lgo+IAo+IFRoaXMgY2hhbmdlIGNoZWNrcyB3aGV0aGVyIHRoZSBkZXZp
Y2UgdGFibGUgZW50cnkgaGFzIHRoZSBjb3JyZWN0IGJpdHMKPiBzZXQgaW4gb3JkZXIgdG8gZGVs
aXZlcnkgdGhlIHJlcXVlc3RlZCBpbnRlcnJ1cHQgb3IgYSB3YXJuaW5nIG1lc3NhZ2UKPiBpcyBw
cmludGVkLiBJdCBhbHNvIHRyYW5zbGF0ZXMgdGhlIDMyYml0IGRlc3RpbmF0aW9uIGZpZWxkIGlu
dG8gYQo+IHBoeXNpY2FsIG9yIGxvZ2ljYWwgSU8tQVBJQyBlbnRyeSBmb3JtYXQuIE5vdGUgdGhh
dCBpZiB0aGUgMzJiaXQKPiBkZXN0aW5hdGlvbiBjYW5ub3QgZml0IGludG8gdGhlIGxlZ2FjeSBm
b3JtYXQgYSBtZXNzYWdlIGlzIHByaW50ZWQgYW5kCj4gdGhlIGVudHJ5IGlzIG1hc2tlZC4KPiAK
PiBTaWduZWQtb2ZmLWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4K
CkZvciB0aGlzIHRvIGhhdmUgYW4gZWZmZWN0IG9uIGZpcm13YXJlIGluaXRpYWxpemVkIFJURXMs
IGl0IGFsc28KcmVxdWlyZXMgcGF0Y2ggNCBhaXVpLiBJbiBmYWN0IEkgdGhpbmsgaXQgc2hvdWxk
IGJlIF9vbmx5XyB0aGlzCmNhc2Ugd2hlcmUgd2UgYWxsb3cgZGVsaXZlcnkgbW9kZXMgb3RoZXIg
dGhhbiBmaXhlZCBhbmQgbG93ZXN0CnByaW9yaXR5ICgiYXJiaXRyYXRlZCIgaW4gQU1EIHRlcm1p
bm9sb2d5KS4gSGVuY2UgSSB0aGluayB0aGlzCnBhdGNoIHdhbnRzIHRvIGdvIGxhc3QgaW4gdGhl
IHNlcmllcywgYW5kIHRoZSBjb2RlIGJlIGNoYW5nZWQgdG8KcmVqZWN0IHJ1bnRpbWUgcmVxdWVz
dHMgdG8gZmlkZGxlIHdpdGggbm9uLSJub3JtYWwiIGRlbGl2ZXJ5Cm1vZGVzICh0aGlzIG1heSBn
byBmdXJ0aGVyIGFuZCBhY3R1YWxseSBkaXNhbGxvdyBjaGFuZ2luZyBzdWNoClJURXMgYXQgcnVu
dGltZSBhbG9uZ3NpZGUgZGlzYWxsb3dpbmcgdGhlaXIgcHJvZHVjdGlvbikuCgo+IC0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMKPiArKysgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50ci5jCj4gQEAgLTQzOSw2ICs0MzksODAgQEAgaW50
IF9faW5pdCBhbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFwcGluZyh2b2lkKQo+ICAgICAgcmV0
dXJuIDA7Cj4gIH0KPiAgCj4gK3ZvaWQgc2V0dXBfZm9yY2VkX2lvYXBpY19ydGUodW5zaWduZWQg
aW50IGFwaWMsIHVuc2lnbmVkIGludCBwaW4sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IElPX0FQSUNfcm91dGVfZW50cnkgKnJ0ZSkKPiArewo+ICsgICAgdW5zaWduZWQg
aW50IGlkeCA9IGlvYXBpY19pZF90b19pbmRleChJT19BUElDX0lEKGFwaWMpKTsKPiArICAgIHN0
cnVjdCBhbWRfaW9tbXVfZHRlICp0YWJsZSA9IGlvbW11LT5kZXZfdGFibGUuYnVmZmVyOwo+ICsg
ICAgdW5zaWduZWQgaW50IHJlcV9pZCwgZGVzdCwgb2Zmc2V0Owo+ICsgICAgdW5pb24gaXJ0ZV9w
dHIgZW50cnk7Cj4gKwo+ICsgICAgQVNTRVJUKHgyYXBpY19lbmFibGVkKTsKPiArCj4gKyAgICBp
ZiAoIGlkeCA9PSBNQVhfSU9fQVBJQ1MgKQoKQmV0dGVyID49ID8KCj4gKyAgICB7Cj4gKyAgICAg
ICAgcnRlLT5tYXNrID0gdHJ1ZTsKPiArICAgICAgICByZXR1cm47Cj4gKyAgICB9Cj4gKwo+ICsg
ICAgcmVxX2lkID0gZ2V0X2ludHJlbWFwX3JlcXVlc3Rvcl9pZChpb2FwaWNfc2JkZltpZHhdLnNl
ZywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9hcGljX3NiZGZb
aWR4XS5iZGYpOwo+ICsKPiArICAgIHN3aXRjaCAoIHJ0ZS0+ZGVsaXZlcnlfbW9kZSApCj4gKyAg
ICB7Cj4gKyAgICBjYXNlIGRlc3RfU01JOgo+ICsgICAgICAgIGJyZWFrOwoKRG9uJ3QgeW91IHdh
bnQgdG8gY2hlY2sgdGhlIHN5c19tZ3QgZmllbGQgaGVyZSwgYWxvbmcgdGhlIGxpbmVzIG9mIHRo
ZQpvdGhlciBvbmVzIGJlbG93PwoKPiArI2RlZmluZSBERUxfQ0hFQ0sodHlwZSwgZHRlX2ZpZWxk
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAgY2FzZSBkZXN0
XyAjIyB0eXBlOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCj4gKyAgICAgICAgaWYgKCAhdGFibGVbcmVxX2lkXS5kdGVfZmllbGQgKSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKPiArICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJO
SU5HICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAgICAgICAg
ICAgICAgICAgU1RSKHR5cGUpICIgb24gSU8tQVBJQyAldSBwaW4gJXUgd2lsbCBiZSBhYm9ydGVk
XG4iLCBcCj4gKyAgICAgICAgICAgICAgICAgICBhcGljLCBwaW4pOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKPiArICAgICAgICBicmVhazsKClBsZWFzZSBvbWl0
IHRoZSBmaW5hbCA7IGhlcmUsIHN1Y2ggdGhhdCAuLi4KCj4gKyAgICBERUxfQ0hFQ0soTk1JLCBu
bWlfcGFzcyk7Cj4gKyAgICBERUxfQ0hFQ0soSU5JVCwgaW5pdF9wYXNzKTsKPiArICAgIERFTF9D
SEVDSyhFeHRJTlQsIGV4dF9pbnRfcGFzcyk7CgouLi4gdGhlIG9uZXMgaGVyZSBiZWNvbWUgYW4g
YWN0dWFsIHJlcXVpcmVtZW50LgoKPiArI3VuZGVmIERFTF9DSEVDSwo+ICsKPiArICAgIGRlZmF1
bHQ6Cj4gKyAgICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7Cj4gKyAgICAgICAgcmV0dXJuOwo+
ICsgICAgfQo+ICsKPiArICAgIG9mZnNldCA9IGlvYXBpY19zYmRmW2lkeF0ucGluXzJfaWR4W3Bp
bl07Cj4gKyAgICBpZiAoIG9mZnNldCA+PSBJTlRSRU1BUF9NQVhfRU5UUklFUyApCj4gKyAgICB7
Cj4gKyAgICAgICAgcnRlLT5tYXNrID0gdHJ1ZTsKPiArICAgICAgICByZXR1cm47Cj4gKyAgICB9
Cj4gKwo+ICsgICAgZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoaW9tbXUsIHJlcV9pZCwgb2Zm
c2V0KTsKPiArICAgIGRlc3QgPSBnZXRfZnVsbF9kZXN0KGVudHJ5LnB0cjEyOCk7Cj4gKwo+ICsj
ZGVmaW5lIFNFVF9ERVNUKG5hbWUsIGRlc3RfbWFzaykgeyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAgaWYgKCBkZXN0ICYgfihkZXN0X21hc2spICkg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAg
eyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAo+ICsgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAgICAg
ICAgICAgICAiSU8tQVBJQyAldSBwaW4gJXUgIiBTVFIobmFtZSkgIiBkZXN0aW5hdGlvbiAoJXgp
ID4gJXhcbiIsICAgICAgXAo+ICsgICAgICAgICAgICAgICBhcGljLCBwaW4sIGRlc3QsIGRlc3Rf
bWFzayk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAgICAgIHJ0
ZS0+bWFzayA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAo+ICsgICAgICAgIHJldHVybjsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICsgICAgfSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAo+ICsgICAgcnRlLT5kZXN0Lm5hbWUubmFtZSAjIyBfZGVzdCA9IGRlc3Q7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ICt9Cj4gKwo+ICsgICAgaWYg
KCBydGUtPmRlc3RfbW9kZSApCj4gKyAgICAgICAgU0VUX0RFU1QocGh5c2ljYWwsIDB4ZikKPiAr
ICAgIGVsc2UKPiArICAgICAgICBTRVRfREVTVChsb2dpY2FsLCAweGZmKQoKVGhpcyByZWFkcyBh
cyBpZiB0aGUgY29kZSB3YXMgYnJva2VuLiBQbGVhc2UgYWRkICgpIGFyb3VuZCB0aGUgb3V0ZXJt
b3N0Cnt9IG9mIHRoZSBtYWNybywgYWxsb3dpbmcgeW91IHRvIHB1dCA7IGhlcmUuIE9yIG90aGVy
d2lzZSwganVzdCBsaWtlCmFib3ZlIGZvciBERUxfQ0hFQ0soKSwgb21pdCB0aGUge30gYXMgd2Vs
bCBhcyB0aGUgZmluYWwgc2VtaWNvbG9uLgoKRnVydGhlcm1vcmUgLSBhcmUgeW91IHN1cmUgYWJv
dXQgdGhpcyBkaXN0aW5jdGlvbj8gU2VlIGUuZy4KdXBkYXRlX2ludHJlbWFwX2VudHJ5X2Zyb21f
aW9hcGljKCkgYW5kCmFtZF9pb21tdV9zZXR1cF9pb2FwaWNfcmVtYXBwaW5nKCksIHdoaWNoIHVu
aWxhdGVyYWxseSB1c2UKcnRlLT5kZXN0LmxvZ2ljYWwubG9naWNhbF9kZXN0LiBMaWtld2lzZSBp
b19hcGljLmMncyBTRVRfREVTVCgpIHVzZXJzLAp3aGljaCBnZW5lcmFsbHkgcGFzcyAibG9naWNh
bCIgZm9yIGFzIG1pZGRsZSBhcmd1bWVudC4gSSB0aG91Z2h0IG9uZSBvZgpteSBoYWxmIHdheSBy
ZWNlbnQgcGF0Y2hlcyAoSVJRIGhhbmRsaW5nIG9yIEFNRCBJT01NVSB3b3JrKSBoYWQgYSByZW1h
cmsKaW4gaXQgcmVnYXJkaW5nIHN1Y2ggYSBiYWRseSBkb2N1bWVudGVkIGV4dGVuc2lvbiwgYnV0
IEkgY2FuJ3Qgc2VlbSB0bwpiZSBhYmxlIHRvIGZpbmQgaXQgYW55bW9yZS4KCj4gQEAgLTQ4Miw2
ICs1NTYsMTMgQEAgdm9pZCBhbWRfaW9tbXVfaW9hcGljX3VwZGF0ZV9pcmUoCj4gICAgICAgICAg
KigodTMyICopJm5ld19ydGUpID0gdmFsdWU7Cj4gICAgICAgICAgLyogcmVhZCB1cHBlciAzMiBi
aXRzIGZyb20gaW8tYXBpYyBydGUgKi8KPiAgICAgICAgICAqKCgodTMyICopJm5ld19ydGUpICsg
MSkgPSBfX2lvX2FwaWNfcmVhZChhcGljLCByZWcgKyAxKTsKPiArCj4gKyAgICAgICAgaWYgKCBu
ZXdfcnRlLmRlbGl2ZXJ5X21vZGUgPiAxICYmIHgyYXBpY19lbmFibGVkICkKClRoZSBsaXRlcmFs
IDEgaGVyZSB3YW50cyBhdHRhY2hpbmcgb2YgYSBjb21tZW50LiBBbmQgd2h5IHRoZQp4MmFwaWNf
ZW5hYmxlZCBwYXJ0IG9mIHRoZSBjb25kaXRpb24/CgpKYW4KCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRl
dmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFp
bG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

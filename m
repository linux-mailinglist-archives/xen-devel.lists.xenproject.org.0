Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 98A40165E5C
	for <lists+xen-devel@lfdr.de>; Thu, 20 Feb 2020 14:10:09 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j4lYD-0002D8-1H; Thu, 20 Feb 2020 13:07:33 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=OTtJ=4I=redhat.com=philmd@srs-us1.protection.inumbo.net>)
 id 1j4lYB-0002CD-6T
 for xen-devel@lists.xenproject.org; Thu, 20 Feb 2020 13:07:31 +0000
X-Inumbo-ID: e867deaa-53e1-11ea-8526-12813bfff9fa
Received: from us-smtp-1.mimecast.com (unknown [205.139.110.61])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTP
 id e867deaa-53e1-11ea-8526-12813bfff9fa;
 Thu, 20 Feb 2020 13:07:12 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1582204031;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=8q7l9fCCXUXfbPVdowHNP6yaBAEoO32+ciiHpilnfds=;
 b=iuTgmODB+Kvp5y/VsVoLGFeidkTFIVW+3bgxqGLYugZy0gBU7JWnTIJviYawVJNVfhx/3t
 8RDZjPzpsediV5EBzYisTUa5j45nU7e2+X4eceD84/TMZcPr+fcOPg8O4OMM4ecKC4tUUv
 0mPj2shRDAZ+dLJo83KOrwyE3jV1YnM=
Received: from mail-wm1-f70.google.com (mail-wm1-f70.google.com
 [209.85.128.70]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-20-8XFVtp3gMEOjW6s5kleXEg-1; Thu, 20 Feb 2020 08:07:08 -0500
X-MC-Unique: 8XFVtp3gMEOjW6s5kleXEg-1
Received: by mail-wm1-f70.google.com with SMTP id f207so577815wme.6
 for <xen-devel@lists.xenproject.org>; Thu, 20 Feb 2020 05:07:08 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Du/Q9cwkYv23U8HuA6dwHrSvlC9gAA5COcpF1xlZ39I=;
 b=rty5BXdf4IQxkHA883XvgC50DYZwtMNWxiPuBxJyRu13xkKEKXErqQDAKxepWy7bEb
 k9ZKLdMwLmfBU9gfIoftPjX10NPwAany1sd+jkH4YZnX+I4rUOvB7HCSZ+spZYHa0Z8P
 8OUFB6anoU5H/AGFFPgl076tcmL0CqV7HbE4m4+uCFAKN5JN/wn2ahcRQoYsALWNLoDz
 bGWtYY0c6SGf/L2FXWWq3Xjo1d3FKHoNNg3nZPbxFJ2zEK98sNyRIt+TMvjKAGsan/mI
 3BnMC+ZyJHevaKOAIQDGXXwG7wnU4G4L0jBRCyQgUEzsDTrS4OyJ5vRZKAnGOveXo3zv
 cxLA==
X-Gm-Message-State: APjAAAXdEra3pUxlnCHqKdag4bLEVF/mFBrvVzOLnve/gFYaS48G9cEb
 +osqqMEbAVT7s5O9A6ynL8iDqbzBCVFTpS9DlnuHAd3W/nUP8tn/j7MsiSoXwOsy030e8mglhSY
 QSY0NIq7lUqgH8Nkb7Ou5aUCejKs=
X-Received: by 2002:a7b:c088:: with SMTP id r8mr4601058wmh.18.1582204025778;
 Thu, 20 Feb 2020 05:07:05 -0800 (PST)
X-Google-Smtp-Source: APXvYqzTc/nRX5CoIhTiVHPwKrtx6YNl9fhALe1YoNj6XyZHwJDsk5yvnlQRclQhspzivJLvmF3dTQ==
X-Received: by 2002:a7b:c088:: with SMTP id r8mr4601010wmh.18.1582204025361;
 Thu, 20 Feb 2020 05:07:05 -0800 (PST)
Received: from localhost.localdomain (78.red-88-21-202.staticip.rima-tde.net.
 [88.21.202.78])
 by smtp.gmail.com with ESMTPSA id b67sm4594690wmc.38.2020.02.20.05.07.01
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 20 Feb 2020 05:07:04 -0800 (PST)
From: =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>
To: Peter Maydell <peter.maydell@linaro.org>,
	qemu-devel@nongnu.org
Date: Thu, 20 Feb 2020 14:05:47 +0100
Message-Id: <20200220130548.29974-20-philmd@redhat.com>
X-Mailer: git-send-email 2.21.1
In-Reply-To: <20200220130548.29974-1-philmd@redhat.com>
References: <20200220130548.29974-1-philmd@redhat.com>
MIME-Version: 1.0
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Subject: [Xen-devel] [PATCH v3 19/20] Let cpu_[physical]_memory() calls pass
 a boolean 'is_write' argument
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Fam Zheng <fam@euphon.net>, Dmitry Fleytman <dmitry.fleytman@gmail.com>,
 kvm@vger.kernel.org, "Michael S. Tsirkin" <mst@redhat.com>,
 Jason Wang <jasowang@redhat.com>, Gerd Hoffmann <kraxel@redhat.com>,
 "Edgar E. Iglesias" <edgar.iglesias@gmail.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Matthew Rosato <mjrosato@linux.ibm.com>, qemu-block@nongnu.org,
 David Hildenbrand <david@redhat.com>, Halil Pasic <pasic@linux.ibm.com>,
 Christian Borntraeger <borntraeger@de.ibm.com>,
 =?UTF-8?q?Herv=C3=A9=20Poussineau?= <hpoussin@reactos.org>,
 Marcel Apfelbaum <marcel.apfelbaum@gmail.com>,
 Anthony Perard <anthony.perard@citrix.com>, xen-devel@lists.xenproject.org,
 Aleksandar Rikalo <aleksandar.rikalo@rt-rk.com>,
 Richard Henderson <rth@twiddle.net>,
 =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>,
 Laurent Vivier <lvivier@redhat.com>, Thomas Huth <thuth@redhat.com>,
 Eduardo Habkost <ehabkost@redhat.com>, Stefan Weil <sw@weilnetz.de>,
 Alistair Francis <alistair@alistair23.me>,
 Richard Henderson <richard.henderson@linaro.org>, Paul Durrant <paul@xen.org>,
 Eric Auger <eric.auger@redhat.com>, qemu-s390x@nongnu.org, qemu-arm@nongnu.org,
 =?UTF-8?q?C=C3=A9dric=20Le=20Goater?= <clg@kaod.org>,
 John Snow <jsnow@redhat.com>, David Gibson <david@gibson.dropbear.id.au>,
 Igor Mitsyanko <i.mitsyanko@gmail.com>, Cornelia Huck <cohuck@redhat.com>,
 Michael Walle <michael@walle.cc>, qemu-ppc@nongnu.org,
 Paolo Bonzini <pbonzini@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VXNlIGFuIGV4cGxpY2l0IGJvb2xlYW4gdHlwZS4KClRoaXMgY29tbWl0IHdhcyBwcm9kdWNlZCB3
aXRoIHRoZSBpbmNsdWRlZCBDb2NjaW5lbGxlIHNjcmlwdApzY3JpcHRzL2NvY2NpbmVsbGUvZXhl
Y19yd19jb25zdC4KClNpZ25lZC1vZmYtYnk6IFBoaWxpcHBlIE1hdGhpZXUtRGF1ZMOpIDxwaGls
bWRAcmVkaGF0LmNvbT4KLS0tCiBzY3JpcHRzL2NvY2NpbmVsbGUvZXhlY19yd19jb25zdC5jb2Nj
aSB8IDE0ICsrKysrKysrKysrKysrCiBpbmNsdWRlL2V4ZWMvY3B1LWNvbW1vbi5oICAgICAgICAg
ICAgICB8ICA0ICsrLS0KIGh3L2Rpc3BsYXkvZXh5bm9zNDIxMF9maW1kLmMgICAgICAgICAgIHwg
IDMgKystCiBody9kaXNwbGF5L21pbGt5bWlzdC10bXUyLmMgICAgICAgICAgICB8ICA4ICsrKyst
LS0tCiBody9kaXNwbGF5L29tYXBfZHNzLmMgICAgICAgICAgICAgICAgICB8ICAyICstCiBody9k
aXNwbGF5L3JhbWZiLmMgICAgICAgICAgICAgICAgICAgICB8ICAyICstCiBody9taXNjL3BjLXRl
c3RkZXYuYyAgICAgICAgICAgICAgICAgICB8ICAyICstCiBody9udnJhbS9zcGFwcl9udnJhbS5j
ICAgICAgICAgICAgICAgICB8ICA0ICsrLS0KIGh3L3BwYy9wcGM0NDBfdWMuYyAgICAgICAgICAg
ICAgICAgICAgIHwgIDYgKysrKy0tCiBody9wcGMvc3BhcHJfaGNhbGwuYyAgICAgICAgICAgICAg
ICAgICB8ICA0ICsrLS0KIGh3L3MzOTB4L2lwbC5jICAgICAgICAgICAgICAgICAgICAgICAgIHwg
IDIgKy0KIGh3L3MzOTB4L3MzOTAtcGNpLWJ1cy5jICAgICAgICAgICAgICAgIHwgIDIgKy0KIGh3
L3MzOTB4L3ZpcnRpby1jY3cuYyAgICAgICAgICAgICAgICAgIHwgIDIgKy0KIGh3L3hlbi94ZW5f
cHRfZ3JhcGhpY3MuYyAgICAgICAgICAgICAgIHwgIDIgKy0KIHRhcmdldC9pMzg2L2hheC1hbGwu
YyAgICAgICAgICAgICAgICAgIHwgIDQgKystLQogdGFyZ2V0L3MzOTB4L2V4Y3BfaGVscGVyLmMg
ICAgICAgICAgICAgfCAgMiArLQogdGFyZ2V0L3MzOTB4L2hlbHBlci5jICAgICAgICAgICAgICAg
ICAgfCAgNiArKystLS0KIDE3IGZpbGVzIGNoYW5nZWQsIDQzIGluc2VydGlvbnMoKyksIDI2IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NjcmlwdHMvY29jY2luZWxsZS9leGVjX3J3X2NvbnN0
LmNvY2NpIGIvc2NyaXB0cy9jb2NjaW5lbGxlL2V4ZWNfcndfY29uc3QuY29jY2kKaW5kZXggZWU5
OGNlOTg4ZS4uNTRiMWNhYjhjZCAxMDA2NDQKLS0tIGEvc2NyaXB0cy9jb2NjaW5lbGxlL2V4ZWNf
cndfY29uc3QuY29jY2kKKysrIGIvc2NyaXB0cy9jb2NjaW5lbGxlL2V4ZWNfcndfY29uc3QuY29j
Y2kKQEAgLTExLDYgKzExLDIwIEBAIGV4cHJlc3Npb24gRTEsIEUyLCBFMywgRTQsIEU1OwogfAog
LSBhZGRyZXNzX3NwYWNlX3J3KEUxLCBFMiwgRTMsIEU0LCBFNSwgMSkKICsgYWRkcmVzc19zcGFj
ZV9ydyhFMSwgRTIsIEUzLCBFNCwgRTUsIHRydWUpCit8CisKKy0gY3B1X3BoeXNpY2FsX21lbW9y
eV9ydyhFMSwgRTIsIEUzLCAwKQorKyBjcHVfcGh5c2ljYWxfbWVtb3J5X3J3KEUxLCBFMiwgRTMs
IGZhbHNlKQorfAorLSBjcHVfcGh5c2ljYWxfbWVtb3J5X3J3KEUxLCBFMiwgRTMsIDEpCisrIGNw
dV9waHlzaWNhbF9tZW1vcnlfcncoRTEsIEUyLCBFMywgdHJ1ZSkKK3wKKworLSBjcHVfcGh5c2lj
YWxfbWVtb3J5X21hcChFMSwgRTIsIDApCisrIGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKEUxLCBF
MiwgZmFsc2UpCit8CistIGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKEUxLCBFMiwgMSkKKysgY3B1
X3BoeXNpY2FsX21lbW9yeV9tYXAoRTEsIEUyLCB0cnVlKQogKQogCiAvLyBVc2UgYWRkcmVzc19z
cGFjZV93cml0ZSBpbnN0ZWFkIG9mIGNhc3RpbmcgdG8gbm9uLWNvbnN0CmRpZmYgLS1naXQgYS9p
bmNsdWRlL2V4ZWMvY3B1LWNvbW1vbi5oIGIvaW5jbHVkZS9leGVjL2NwdS1jb21tb24uaAppbmRl
eCA2YmZlMjAxNzc5Li5lN2ZkNTc4MWVhIDEwMDY0NAotLS0gYS9pbmNsdWRlL2V4ZWMvY3B1LWNv
bW1vbi5oCisrKyBiL2luY2x1ZGUvZXhlYy9jcHUtY29tbW9uLmgKQEAgLTc0LDEyICs3NCwxMiBA
QCB2b2lkIGNwdV9waHlzaWNhbF9tZW1vcnlfcncoaHdhZGRyIGFkZHIsIHZvaWQgKmJ1ZiwKIHN0
YXRpYyBpbmxpbmUgdm9pZCBjcHVfcGh5c2ljYWxfbWVtb3J5X3JlYWQoaHdhZGRyIGFkZHIsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmJ1ZiwgaHdh
ZGRyIGxlbikKIHsKLSAgICBjcHVfcGh5c2ljYWxfbWVtb3J5X3J3KGFkZHIsIGJ1ZiwgbGVuLCAw
KTsKKyAgICBjcHVfcGh5c2ljYWxfbWVtb3J5X3J3KGFkZHIsIGJ1ZiwgbGVuLCBmYWxzZSk7CiB9
CiBzdGF0aWMgaW5saW5lIHZvaWQgY3B1X3BoeXNpY2FsX21lbW9yeV93cml0ZShod2FkZHIgYWRk
ciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZv
aWQgKmJ1ZiwgaHdhZGRyIGxlbikKIHsKLSAgICBjcHVfcGh5c2ljYWxfbWVtb3J5X3J3KGFkZHIs
ICh2b2lkICopYnVmLCBsZW4sIDEpOworICAgIGNwdV9waHlzaWNhbF9tZW1vcnlfcncoYWRkciwg
KHZvaWQgKilidWYsIGxlbiwgdHJ1ZSk7CiB9CiB2b2lkICpjcHVfcGh5c2ljYWxfbWVtb3J5X21h
cChod2FkZHIgYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh3YWRkciAqcGxl
biwKZGlmZiAtLWdpdCBhL2h3L2Rpc3BsYXkvZXh5bm9zNDIxMF9maW1kLmMgYi9ody9kaXNwbGF5
L2V4eW5vczQyMTBfZmltZC5jCmluZGV4IGMxMDcxZWNkNDYuLmVjNjc3NjY4MGUgMTAwNjQ0Ci0t
LSBhL2h3L2Rpc3BsYXkvZXh5bm9zNDIxMF9maW1kLmMKKysrIGIvaHcvZGlzcGxheS9leHlub3M0
MjEwX2ZpbWQuYwpAQCAtMTE2NCw3ICsxMTY0LDggQEAgc3RhdGljIHZvaWQgZmltZF91cGRhdGVf
bWVtb3J5X3NlY3Rpb24oRXh5bm9zNDIxMGZpbWRTdGF0ZSAqcywgdW5zaWduZWQgd2luKQogICAg
ICAgICBnb3RvIGVycm9yX3JldHVybjsKICAgICB9CiAKLSAgICB3LT5ob3N0X2ZiX2FkZHIgPSBj
cHVfcGh5c2ljYWxfbWVtb3J5X21hcChmYl9zdGFydF9hZGRyLCAmZmJfbWFwcGVkX2xlbiwgMCk7
CisgICAgdy0+aG9zdF9mYl9hZGRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoZmJfc3RhcnRf
YWRkciwgJmZiX21hcHBlZF9sZW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZmFsc2UpOwogICAgIGlmICghdy0+aG9zdF9mYl9hZGRyKSB7CiAgICAgICAg
IERQUklOVF9FUlJPUigiRmFpbGVkIHRvIG1hcCB3aW5kb3cgJXUgZnJhbWVidWZmZXJcbiIsIHdp
bik7CiAgICAgICAgIGdvdG8gZXJyb3JfcmV0dXJuOwpkaWZmIC0tZ2l0IGEvaHcvZGlzcGxheS9t
aWxreW1pc3QtdG11Mi5jIGIvaHcvZGlzcGxheS9taWxreW1pc3QtdG11Mi5jCmluZGV4IDE5OWYx
MjI3ZTcuLjUxM2MwZDViYWIgMTAwNjQ0Ci0tLSBhL2h3L2Rpc3BsYXkvbWlsa3ltaXN0LXRtdTIu
YworKysgYi9ody9kaXNwbGF5L21pbGt5bWlzdC10bXUyLmMKQEAgLTIxOCw3ICsyMTgsNyBAQCBz
dGF0aWMgdm9pZCB0bXUyX3N0YXJ0KE1pbGt5bWlzdFRNVTJTdGF0ZSAqcykKICAgICBnbEdlblRl
eHR1cmVzKDEsICZ0ZXh0dXJlKTsKICAgICBnbEJpbmRUZXh0dXJlKEdMX1RFWFRVUkVfMkQsIHRl
eHR1cmUpOwogICAgIGZiX2xlbiA9IDJVTEwgKiBzLT5yZWdzW1JfVEVYSFJFU10gKiBzLT5yZWdz
W1JfVEVYVlJFU107Ci0gICAgZmIgPSBjcHVfcGh5c2ljYWxfbWVtb3J5X21hcChzLT5yZWdzW1Jf
VEVYRkJVRl0sICZmYl9sZW4sIDApOworICAgIGZiID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAo
cy0+cmVnc1tSX1RFWEZCVUZdLCAmZmJfbGVuLCBmYWxzZSk7CiAgICAgaWYgKGZiID09IE5VTEwp
IHsKICAgICAgICAgZ2xEZWxldGVUZXh0dXJlcygxLCAmdGV4dHVyZSk7CiAgICAgICAgIGdsWE1h
a2VDb250ZXh0Q3VycmVudChzLT5kcHksIE5vbmUsIE5vbmUsIE5VTEwpOwpAQCAtMjYyLDcgKzI2
Miw3IEBAIHN0YXRpYyB2b2lkIHRtdTJfc3RhcnQoTWlsa3ltaXN0VE1VMlN0YXRlICpzKQogCiAg
ICAgLyogUmVhZCB0aGUgUUVNVSBkZXN0LiBmcmFtZWJ1ZmZlciBpbnRvIHRoZSBPcGVuR0wgZnJh
bWVidWZmZXIgKi8KICAgICBmYl9sZW4gPSAyVUxMICogcy0+cmVnc1tSX0RTVEhSRVNdICogcy0+
cmVnc1tSX0RTVFZSRVNdOwotICAgIGZiID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAocy0+cmVn
c1tSX0RTVEZCVUZdLCAmZmJfbGVuLCAwKTsKKyAgICBmYiA9IGNwdV9waHlzaWNhbF9tZW1vcnlf
bWFwKHMtPnJlZ3NbUl9EU1RGQlVGXSwgJmZiX2xlbiwgZmFsc2UpOwogICAgIGlmIChmYiA9PSBO
VUxMKSB7CiAgICAgICAgIGdsRGVsZXRlVGV4dHVyZXMoMSwgJnRleHR1cmUpOwogICAgICAgICBn
bFhNYWtlQ29udGV4dEN1cnJlbnQocy0+ZHB5LCBOb25lLCBOb25lLCBOVUxMKTsKQEAgLTI4MSw3
ICsyODEsNyBAQCBzdGF0aWMgdm9pZCB0bXUyX3N0YXJ0KE1pbGt5bWlzdFRNVTJTdGF0ZSAqcykK
IAogICAgIC8qIE1hcCB0aGUgdGV4dHVyZSAqLwogICAgIG1lc2hfbGVuID0gTUVTSF9NQVhTSVpF
Kk1FU0hfTUFYU0laRSpzaXplb2Yoc3RydWN0IHZlcnRleCk7Ci0gICAgbWVzaCA9IGNwdV9waHlz
aWNhbF9tZW1vcnlfbWFwKHMtPnJlZ3NbUl9WRVJUSUNFU0FERFJdLCAmbWVzaF9sZW4sIDApOwor
ICAgIG1lc2ggPSBjcHVfcGh5c2ljYWxfbWVtb3J5X21hcChzLT5yZWdzW1JfVkVSVElDRVNBRERS
XSwgJm1lc2hfbGVuLCBmYWxzZSk7CiAgICAgaWYgKG1lc2ggPT0gTlVMTCkgewogICAgICAgICBn
bERlbGV0ZVRleHR1cmVzKDEsICZ0ZXh0dXJlKTsKICAgICAgICAgZ2xYTWFrZUNvbnRleHRDdXJy
ZW50KHMtPmRweSwgTm9uZSwgTm9uZSwgTlVMTCk7CkBAIC0yOTgsNyArMjk4LDcgQEAgc3RhdGlj
IHZvaWQgdG11Ml9zdGFydChNaWxreW1pc3RUTVUyU3RhdGUgKnMpCiAKICAgICAvKiBXcml0ZSBi
YWNrIHRoZSBPcGVuR0wgZnJhbWVidWZmZXIgdG8gdGhlIFFFTVUgZnJhbWVidWZmZXIgKi8KICAg
ICBmYl9sZW4gPSAyVUxMICogcy0+cmVnc1tSX0RTVEhSRVNdICogcy0+cmVnc1tSX0RTVFZSRVNd
OwotICAgIGZiID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAocy0+cmVnc1tSX0RTVEZCVUZdLCAm
ZmJfbGVuLCAxKTsKKyAgICBmYiA9IGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKHMtPnJlZ3NbUl9E
U1RGQlVGXSwgJmZiX2xlbiwgdHJ1ZSk7CiAgICAgaWYgKGZiID09IE5VTEwpIHsKICAgICAgICAg
Z2xEZWxldGVUZXh0dXJlcygxLCAmdGV4dHVyZSk7CiAgICAgICAgIGdsWE1ha2VDb250ZXh0Q3Vy
cmVudChzLT5kcHksIE5vbmUsIE5vbmUsIE5VTEwpOwpkaWZmIC0tZ2l0IGEvaHcvZGlzcGxheS9v
bWFwX2Rzcy5jIGIvaHcvZGlzcGxheS9vbWFwX2Rzcy5jCmluZGV4IDYzN2FhZThkMzkuLjMyZGMw
ZDZhYTcgMTAwNjQ0Ci0tLSBhL2h3L2Rpc3BsYXkvb21hcF9kc3MuYworKysgYi9ody9kaXNwbGF5
L29tYXBfZHNzLmMKQEAgLTYzMiw3ICs2MzIsNyBAQCBzdGF0aWMgdm9pZCBvbWFwX3JmYmlfdHJh
bnNmZXJfc3RhcnQoc3RydWN0IG9tYXBfZHNzX3MgKnMpCiAgICAgbGVuID0gcy0+cmZiaS5waXhl
bHMgKiAyOwogCiAgICAgZGF0YV9hZGRyID0gcy0+ZGlzcGMubFswXS5hZGRyWzBdOwotICAgIGRh
dGEgPSBjcHVfcGh5c2ljYWxfbWVtb3J5X21hcChkYXRhX2FkZHIsICZsZW4sIDApOworICAgIGRh
dGEgPSBjcHVfcGh5c2ljYWxfbWVtb3J5X21hcChkYXRhX2FkZHIsICZsZW4sIGZhbHNlKTsKICAg
ICBpZiAoZGF0YSAmJiBsZW4gIT0gcy0+cmZiaS5waXhlbHMgKiAyKSB7CiAgICAgICAgIGNwdV9w
aHlzaWNhbF9tZW1vcnlfdW5tYXAoZGF0YSwgbGVuLCAwLCAwKTsKICAgICAgICAgZGF0YSA9IE5V
TEw7CmRpZmYgLS1naXQgYS9ody9kaXNwbGF5L3JhbWZiLmMgYi9ody9kaXNwbGF5L3JhbWZiLmMK
aW5kZXggY2Q5NDk0MDIyMy4uN2JhMDdjODBmNiAxMDA2NDQKLS0tIGEvaHcvZGlzcGxheS9yYW1m
Yi5jCisrKyBiL2h3L2Rpc3BsYXkvcmFtZmIuYwpAQCAtNTcsNyArNTcsNyBAQCBzdGF0aWMgRGlz
cGxheVN1cmZhY2UgKnJhbWZiX2NyZWF0ZV9kaXNwbGF5X3N1cmZhY2UoaW50IHdpZHRoLCBpbnQg
aGVpZ2h0LAogICAgIH0KIAogICAgIHNpemUgPSAoaHdhZGRyKWxpbmVzaXplICogaGVpZ2h0Owot
ICAgIGRhdGEgPSBjcHVfcGh5c2ljYWxfbWVtb3J5X21hcChhZGRyLCAmc2l6ZSwgMCk7CisgICAg
ZGF0YSA9IGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKGFkZHIsICZzaXplLCBmYWxzZSk7CiAgICAg
aWYgKHNpemUgIT0gKGh3YWRkcilsaW5lc2l6ZSAqIGhlaWdodCkgewogICAgICAgICBjcHVfcGh5
c2ljYWxfbWVtb3J5X3VubWFwKGRhdGEsIHNpemUsIDAsIDApOwogICAgICAgICByZXR1cm4gTlVM
TDsKZGlmZiAtLWdpdCBhL2h3L21pc2MvcGMtdGVzdGRldi5jIGIvaHcvbWlzYy9wYy10ZXN0ZGV2
LmMKaW5kZXggMGZiODRkZGM2Yi4uOGFhOGU2NTQ5ZiAxMDA2NDQKLS0tIGEvaHcvbWlzYy9wYy10
ZXN0ZGV2LmMKKysrIGIvaHcvbWlzYy9wYy10ZXN0ZGV2LmMKQEAgLTEyNSw3ICsxMjUsNyBAQCBz
dGF0aWMgdm9pZCB0ZXN0X2ZsdXNoX3BhZ2Vfd3JpdGUodm9pZCAqb3BhcXVlLCBod2FkZHIgYWRk
ciwgdWludDY0X3QgZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBs
ZW4pCiB7CiAgICAgaHdhZGRyIHBhZ2UgPSA0MDk2OwotICAgIHZvaWQgKmEgPSBjcHVfcGh5c2lj
YWxfbWVtb3J5X21hcChkYXRhICYgfjB4ZmZmdWwsICZwYWdlLCAwKTsKKyAgICB2b2lkICphID0g
Y3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoZGF0YSAmIH4weGZmZnVsLCAmcGFnZSwgZmFsc2UpOwog
CiAgICAgLyogV2UgbWlnaHQgbm90IGJlIGFibGUgdG8gZ2V0IHRoZSBmdWxsIHBhZ2UsIG9ubHkg
bXByb3RlY3Qgd2hhdCB3ZSBhY3R1YWxseQogICAgICAgIGhhdmUgbWFwcGVkICovCmRpZmYgLS1n
aXQgYS9ody9udnJhbS9zcGFwcl9udnJhbS5jIGIvaHcvbnZyYW0vc3BhcHJfbnZyYW0uYwppbmRl
eCA4NzdkZGVmN2I5Li4xNWQwODI4MWQ0IDEwMDY0NAotLS0gYS9ody9udnJhbS9zcGFwcl9udnJh
bS5jCisrKyBiL2h3L252cmFtL3NwYXByX252cmFtLmMKQEAgLTg5LDcgKzg5LDcgQEAgc3RhdGlj
IHZvaWQgcnRhc19udnJhbV9mZXRjaChQb3dlclBDQ1BVICpjcHUsIFNwYXByTWFjaGluZVN0YXRl
ICpzcGFwciwKIAogICAgIGFzc2VydChudnJhbS0+YnVmKTsKIAotICAgIG1lbWJ1ZiA9IGNwdV9w
aHlzaWNhbF9tZW1vcnlfbWFwKGJ1ZmZlciwgJmxlbiwgMSk7CisgICAgbWVtYnVmID0gY3B1X3Bo
eXNpY2FsX21lbW9yeV9tYXAoYnVmZmVyLCAmbGVuLCB0cnVlKTsKICAgICBtZW1jcHkobWVtYnVm
LCBudnJhbS0+YnVmICsgb2Zmc2V0LCBsZW4pOwogICAgIGNwdV9waHlzaWNhbF9tZW1vcnlfdW5t
YXAobWVtYnVmLCBsZW4sIDEsIGxlbik7CiAKQEAgLTEyNyw3ICsxMjcsNyBAQCBzdGF0aWMgdm9p
ZCBydGFzX252cmFtX3N0b3JlKFBvd2VyUENDUFUgKmNwdSwgU3BhcHJNYWNoaW5lU3RhdGUgKnNw
YXByLAogICAgICAgICByZXR1cm47CiAgICAgfQogCi0gICAgbWVtYnVmID0gY3B1X3BoeXNpY2Fs
X21lbW9yeV9tYXAoYnVmZmVyLCAmbGVuLCAwKTsKKyAgICBtZW1idWYgPSBjcHVfcGh5c2ljYWxf
bWVtb3J5X21hcChidWZmZXIsICZsZW4sIGZhbHNlKTsKIAogICAgIGFsZW4gPSBsZW47CiAgICAg
aWYgKG52cmFtLT5ibGspIHsKZGlmZiAtLWdpdCBhL2h3L3BwYy9wcGM0NDBfdWMuYyBiL2h3L3Bw
Yy9wcGM0NDBfdWMuYwppbmRleCAxYTZhOGZhYzIyLi5kNWVhOTYyMjQ5IDEwMDY0NAotLS0gYS9o
dy9wcGMvcHBjNDQwX3VjLmMKKysrIGIvaHcvcHBjL3BwYzQ0MF91Yy5jCkBAIC05MDksOCArOTA5
LDEwIEBAIHN0YXRpYyB2b2lkIGRjcl93cml0ZV9kbWEodm9pZCAqb3BhcXVlLCBpbnQgZGNybiwg
dWludDMyX3QgdmFsKQogCiAgICAgICAgICAgICAgICAgICAgIHNpZHggPSBkaWR4ID0gMDsKICAg
ICAgICAgICAgICAgICAgICAgd2lkdGggPSAxIDw8ICgodmFsICYgRE1BMF9DUl9QVykgPj4gMjUp
OwotICAgICAgICAgICAgICAgICAgICBycHRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoZG1h
LT5jaFtjaG5sXS5zYSwgJnJsZW4sIDApOwotICAgICAgICAgICAgICAgICAgICB3cHRyID0gY3B1
X3BoeXNpY2FsX21lbW9yeV9tYXAoZG1hLT5jaFtjaG5sXS5kYSwgJndsZW4sIDEpOworICAgICAg
ICAgICAgICAgICAgICBycHRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoZG1hLT5jaFtjaG5s
XS5zYSwgJnJsZW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBmYWxzZSk7CisgICAgICAgICAgICAgICAgICAgIHdwdHIgPSBjcHVfcGh5c2ljYWxf
bWVtb3J5X21hcChkbWEtPmNoW2NobmxdLmRhLCAmd2xlbiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUpOwogICAgICAgICAgICAgICAgICAg
ICBpZiAocnB0ciAmJiB3cHRyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh2YWwg
JiBETUEwX0NSX0RFQykgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwgJiBETUEw
X0NSX1NBSSAmJiB2YWwgJiBETUEwX0NSX0RBSSkgewpkaWZmIC0tZ2l0IGEvaHcvcHBjL3NwYXBy
X2hjYWxsLmMgYi9ody9wcGMvc3BhcHJfaGNhbGwuYwppbmRleCBiOGJiNjZiNWMwLi5jYWY1NWFi
MDQ0IDEwMDY0NAotLS0gYS9ody9wcGMvc3BhcHJfaGNhbGwuYworKysgYi9ody9wcGMvc3BhcHJf
aGNhbGwuYwpAQCAtODMyLDcgKzgzMiw3IEBAIHN0YXRpYyB0YXJnZXRfdWxvbmcgaF9wYWdlX2lu
aXQoUG93ZXJQQ0NQVSAqY3B1LCBTcGFwck1hY2hpbmVTdGF0ZSAqc3BhcHIsCiAgICAgaWYgKCFp
c19yYW1fYWRkcmVzcyhzcGFwciwgZHN0KSB8fCAoZHN0ICYgflRBUkdFVF9QQUdFX01BU0spICE9
IDApIHsKICAgICAgICAgcmV0dXJuIEhfUEFSQU1FVEVSOwogICAgIH0KLSAgICBwZHN0ID0gY3B1
X3BoeXNpY2FsX21lbW9yeV9tYXAoZHN0LCAmbGVuLCAxKTsKKyAgICBwZHN0ID0gY3B1X3BoeXNp
Y2FsX21lbW9yeV9tYXAoZHN0LCAmbGVuLCB0cnVlKTsKICAgICBpZiAoIXBkc3QgfHwgbGVuICE9
IFRBUkdFVF9QQUdFX1NJWkUpIHsKICAgICAgICAgcmV0dXJuIEhfUEFSQU1FVEVSOwogICAgIH0K
QEAgLTg0Myw3ICs4NDMsNyBAQCBzdGF0aWMgdGFyZ2V0X3Vsb25nIGhfcGFnZV9pbml0KFBvd2Vy
UENDUFUgKmNwdSwgU3BhcHJNYWNoaW5lU3RhdGUgKnNwYXByLAogICAgICAgICAgICAgcmV0ID0g
SF9QQVJBTUVURVI7CiAgICAgICAgICAgICBnb3RvIHVubWFwX291dDsKICAgICAgICAgfQotICAg
ICAgICBwc3JjID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoc3JjLCAmbGVuLCAwKTsKKyAgICAg
ICAgcHNyYyA9IGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKHNyYywgJmxlbiwgZmFsc2UpOwogICAg
ICAgICBpZiAoIXBzcmMgfHwgbGVuICE9IFRBUkdFVF9QQUdFX1NJWkUpIHsKICAgICAgICAgICAg
IHJldCA9IEhfUEFSQU1FVEVSOwogICAgICAgICAgICAgZ290byB1bm1hcF9vdXQ7CmRpZmYgLS1n
aXQgYS9ody9zMzkweC9pcGwuYyBiL2h3L3MzOTB4L2lwbC5jCmluZGV4IDc3NzM0OTlkN2YuLjA4
MTc4NzRiNDggMTAwNjQ0Ci0tLSBhL2h3L3MzOTB4L2lwbC5jCisrKyBiL2h3L3MzOTB4L2lwbC5j
CkBAIC02MjYsNyArNjI2LDcgQEAgc3RhdGljIHZvaWQgczM5MF9pcGxfcHJlcGFyZV9xaXBsKFMz
OTBDUFUgKmNwdSkKICAgICB1aW50OF90ICphZGRyOwogICAgIHVpbnQ2NF90IGxlbiA9IDQwOTY7
CiAKLSAgICBhZGRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoY3B1LT5lbnYucHNhLCAmbGVu
LCAxKTsKKyAgICBhZGRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoY3B1LT5lbnYucHNhLCAm
bGVuLCB0cnVlKTsKICAgICBpZiAoIWFkZHIgfHwgbGVuIDwgUUlQTF9BRERSRVNTICsgc2l6ZW9m
KFFlbXVJcGxQYXJhbWV0ZXJzKSkgewogICAgICAgICBlcnJvcl9yZXBvcnQoIkNhbm5vdCBzZXQg
UUVNVSBJUEwgcGFyYW1ldGVycyIpOwogICAgICAgICByZXR1cm47CmRpZmYgLS1naXQgYS9ody9z
MzkweC9zMzkwLXBjaS1idXMuYyBiL2h3L3MzOTB4L3MzOTAtcGNpLWJ1cy5jCmluZGV4IDdjNmEy
YjNjNjMuLmVkOGJlMTI0ZGEgMTAwNjQ0Ci0tLSBhL2h3L3MzOTB4L3MzOTAtcGNpLWJ1cy5jCisr
KyBiL2h3L3MzOTB4L3MzOTAtcGNpLWJ1cy5jCkBAIC02NDEsNyArNjQxLDcgQEAgc3RhdGljIHVp
bnQ4X3Qgc2V0X2luZF9hdG9taWModWludDY0X3QgaW5kX2xvYywgdWludDhfdCB0b19iZV9zZXQp
CiAgICAgaHdhZGRyIGxlbiA9IDE7CiAgICAgdWludDhfdCAqaW5kX2FkZHI7CiAKLSAgICBpbmRf
YWRkciA9IGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKGluZF9sb2MsICZsZW4sIDEpOworICAgIGlu
ZF9hZGRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoaW5kX2xvYywgJmxlbiwgdHJ1ZSk7CiAg
ICAgaWYgKCFpbmRfYWRkcikgewogICAgICAgICBzMzkwX3BjaV9nZW5lcmF0ZV9lcnJvcl9ldmVu
dChFUlJfRVZFTlRfQUlSRVJSLCAwLCAwLCAwLCAwKTsKICAgICAgICAgcmV0dXJuIC0xOwpkaWZm
IC0tZ2l0IGEvaHcvczM5MHgvdmlydGlvLWNjdy5jIGIvaHcvczM5MHgvdmlydGlvLWNjdy5jCmlu
ZGV4IDEzZjU3ZTdiNjcuLjUwY2Y5NWI3ODEgMTAwNjQ0Ci0tLSBhL2h3L3MzOTB4L3ZpcnRpby1j
Y3cuYworKysgYi9ody9zMzkweC92aXJ0aW8tY2N3LmMKQEAgLTc5MCw3ICs3OTAsNyBAQCBzdGF0
aWMgdWludDhfdCB2aXJ0aW9fc2V0X2luZF9hdG9taWMoU3ViY2hEZXYgKnNjaCwgdWludDY0X3Qg
aW5kX2xvYywKICAgICBod2FkZHIgbGVuID0gMTsKICAgICB1aW50OF90ICppbmRfYWRkcjsKIAot
ICAgIGluZF9hZGRyID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAoaW5kX2xvYywgJmxlbiwgMSk7
CisgICAgaW5kX2FkZHIgPSBjcHVfcGh5c2ljYWxfbWVtb3J5X21hcChpbmRfbG9jLCAmbGVuLCB0
cnVlKTsKICAgICBpZiAoIWluZF9hZGRyKSB7CiAgICAgICAgIGVycm9yX3JlcG9ydCgiJXMoJXgu
JXguJTA0eCk6IHVuYWJsZSB0byBhY2Nlc3MgaW5kaWNhdG9yIiwKICAgICAgICAgICAgICAgICAg
ICAgIF9fZnVuY19fLCBzY2gtPmNzc2lkLCBzY2gtPnNzaWQsIHNjaC0+c2NoaWQpOwpkaWZmIC0t
Z2l0IGEvaHcveGVuL3hlbl9wdF9ncmFwaGljcy5jIGIvaHcveGVuL3hlbl9wdF9ncmFwaGljcy5j
CmluZGV4IGI2OTczMjcyOWIuLmIxMWU0ZTA1NDYgMTAwNjQ0Ci0tLSBhL2h3L3hlbi94ZW5fcHRf
Z3JhcGhpY3MuYworKysgYi9ody94ZW4veGVuX3B0X2dyYXBoaWNzLmMKQEAgLTIyMiw3ICsyMjIs
NyBAQCB2b2lkIHhlbl9wdF9zZXR1cF92Z2EoWGVuUENJUGFzc3Rocm91Z2hTdGF0ZSAqcywgWGVu
SG9zdFBDSURldmljZSAqZGV2LAogICAgIH0KIAogICAgIC8qIEN1cnJlbnRseSB3ZSBmaXhlZCB0
aGlzIGFkZHJlc3MgYXMgYSBwcmltYXJ5IGZvciBsZWdhY3kgQklPUy4gKi8KLSAgICBjcHVfcGh5
c2ljYWxfbWVtb3J5X3J3KDB4YzAwMDAsIGJpb3MsIGJpb3Nfc2l6ZSwgMSk7CisgICAgY3B1X3Bo
eXNpY2FsX21lbW9yeV9ydygweGMwMDAwLCBiaW9zLCBiaW9zX3NpemUsIHRydWUpOwogfQogCiB1
aW50MzJfdCBpZ2RfcmVhZF9vcHJlZ2lvbihYZW5QQ0lQYXNzdGhyb3VnaFN0YXRlICpzKQpkaWZm
IC0tZ2l0IGEvdGFyZ2V0L2kzODYvaGF4LWFsbC5jIGIvdGFyZ2V0L2kzODYvaGF4LWFsbC5jCmlu
ZGV4IGE5Y2M1MWU2Y2UuLjM4OTM2ZDdhZjYgMTAwNjQ0Ci0tLSBhL3RhcmdldC9pMzg2L2hheC1h
bGwuYworKysgYi90YXJnZXQvaTM4Ni9oYXgtYWxsLmMKQEAgLTM3Niw4ICszNzYsOCBAQCBzdGF0
aWMgaW50IGhheF9oYW5kbGVfZmFzdG1taW8oQ1BVQXJjaFN0YXRlICplbnYsIHN0cnVjdCBoYXhf
ZmFzdG1taW8gKmhmdCkKICAgICAgICAgICogIGhmdC0+ZGlyZWN0aW9uID09IDI6IGdwYSA9PT4g
Z3BhMgogICAgICAgICAgKi8KICAgICAgICAgdWludDY0X3QgdmFsdWU7Ci0gICAgICAgIGNwdV9w
aHlzaWNhbF9tZW1vcnlfcncoaGZ0LT5ncGEsICZ2YWx1ZSwgaGZ0LT5zaXplLCAwKTsKLSAgICAg
ICAgY3B1X3BoeXNpY2FsX21lbW9yeV9ydyhoZnQtPmdwYTIsICZ2YWx1ZSwgaGZ0LT5zaXplLCAx
KTsKKyAgICAgICAgY3B1X3BoeXNpY2FsX21lbW9yeV9ydyhoZnQtPmdwYSwgJnZhbHVlLCBoZnQt
PnNpemUsIGZhbHNlKTsKKyAgICAgICAgY3B1X3BoeXNpY2FsX21lbW9yeV9ydyhoZnQtPmdwYTIs
ICZ2YWx1ZSwgaGZ0LT5zaXplLCB0cnVlKTsKICAgICB9CiAKICAgICByZXR1cm4gMDsKZGlmZiAt
LWdpdCBhL3RhcmdldC9zMzkweC9leGNwX2hlbHBlci5jIGIvdGFyZ2V0L3MzOTB4L2V4Y3BfaGVs
cGVyLmMKaW5kZXggMWU5ZDZmMjBjMS4uM2I1OGQxMGRmMyAxMDA2NDQKLS0tIGEvdGFyZ2V0L3Mz
OTB4L2V4Y3BfaGVscGVyLmMKKysrIGIvdGFyZ2V0L3MzOTB4L2V4Y3BfaGVscGVyLmMKQEAgLTM5
Myw3ICszOTMsNyBAQCBzdGF0aWMgaW50IG1jaGtfc3RvcmVfdnJlZ3MoQ1BVUzM5MFhTdGF0ZSAq
ZW52LCB1aW50NjRfdCBtY2VzYW8pCiAgICAgTWNoa0V4dFNhdmVBcmVhICpzYTsKICAgICBpbnQg
aTsKIAotICAgIHNhID0gY3B1X3BoeXNpY2FsX21lbW9yeV9tYXAobWNlc2FvLCAmbGVuLCAxKTsK
KyAgICBzYSA9IGNwdV9waHlzaWNhbF9tZW1vcnlfbWFwKG1jZXNhbywgJmxlbiwgdHJ1ZSk7CiAg
ICAgaWYgKCFzYSkgewogICAgICAgICByZXR1cm4gLUVGQVVMVDsKICAgICB9CmRpZmYgLS1naXQg
YS90YXJnZXQvczM5MHgvaGVscGVyLmMgYi90YXJnZXQvczM5MHgvaGVscGVyLmMKaW5kZXggYTNh
NDkxNjRlNC4uYjgxMGFkNDMxZSAxMDA2NDQKLS0tIGEvdGFyZ2V0L3MzOTB4L2hlbHBlci5jCisr
KyBiL3RhcmdldC9zMzkweC9oZWxwZXIuYwpAQCAtMTUxLDcgKzE1MSw3IEBAIExvd0NvcmUgKmNw
dV9tYXBfbG93Y29yZShDUFVTMzkwWFN0YXRlICplbnYpCiAgICAgTG93Q29yZSAqbG93Y29yZTsK
ICAgICBod2FkZHIgbGVuID0gc2l6ZW9mKExvd0NvcmUpOwogCi0gICAgbG93Y29yZSA9IGNwdV9w
aHlzaWNhbF9tZW1vcnlfbWFwKGVudi0+cHNhLCAmbGVuLCAxKTsKKyAgICBsb3djb3JlID0gY3B1
X3BoeXNpY2FsX21lbW9yeV9tYXAoZW52LT5wc2EsICZsZW4sIHRydWUpOwogCiAgICAgaWYgKGxl
biA8IHNpemVvZihMb3dDb3JlKSkgewogICAgICAgICBjcHVfYWJvcnQoZW52X2NwdShlbnYpLCAi
Q291bGQgbm90IG1hcCBsb3djb3JlXG4iKTsKQEAgLTI0Niw3ICsyNDYsNyBAQCBpbnQgczM5MF9z
dG9yZV9zdGF0dXMoUzM5MENQVSAqY3B1LCBod2FkZHIgYWRkciwgYm9vbCBzdG9yZV9hcmNoKQog
ICAgIGh3YWRkciBsZW4gPSBzaXplb2YoKnNhKTsKICAgICBpbnQgaTsKIAotICAgIHNhID0gY3B1
X3BoeXNpY2FsX21lbW9yeV9tYXAoYWRkciwgJmxlbiwgMSk7CisgICAgc2EgPSBjcHVfcGh5c2lj
YWxfbWVtb3J5X21hcChhZGRyLCAmbGVuLCB0cnVlKTsKICAgICBpZiAoIXNhKSB7CiAgICAgICAg
IHJldHVybiAtRUZBVUxUOwogICAgIH0KQEAgLTI5OCw3ICsyOTgsNyBAQCBpbnQgczM5MF9zdG9y
ZV9hZHRsX3N0YXR1cyhTMzkwQ1BVICpjcHUsIGh3YWRkciBhZGRyLCBod2FkZHIgbGVuKQogICAg
IGh3YWRkciBzYXZlID0gbGVuOwogICAgIGludCBpOwogCi0gICAgc2EgPSBjcHVfcGh5c2ljYWxf
bWVtb3J5X21hcChhZGRyLCAmc2F2ZSwgMSk7CisgICAgc2EgPSBjcHVfcGh5c2ljYWxfbWVtb3J5
X21hcChhZGRyLCAmc2F2ZSwgdHJ1ZSk7CiAgICAgaWYgKCFzYSkgewogICAgICAgICByZXR1cm4g
LUVGQVVMVDsKICAgICB9Ci0tIAoyLjIxLjEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0
cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlz
dGluZm8veGVuLWRldmVs

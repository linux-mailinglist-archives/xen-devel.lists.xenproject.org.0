Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 35347125701
	for <lists+xen-devel@lfdr.de>; Wed, 18 Dec 2019 23:36:47 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ihhu1-0007Uw-01; Wed, 18 Dec 2019 22:34:45 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=5UKC=2I=tklengyel.com=bounce+e181d6.cd840-xen-devel=lists.xenproject.org@srs-us1.protection.inumbo.net>)
 id 1ihhtz-0007Uq-Il
 for xen-devel@lists.xenproject.org; Wed, 18 Dec 2019 22:34:43 +0000
X-Inumbo-ID: 90e4da66-21e6-11ea-a914-bc764e2007e4
Received: from rs224.mailgun.us (unknown [209.61.151.224])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 90e4da66-21e6-11ea-a914-bc764e2007e4;
 Wed, 18 Dec 2019 22:34:34 +0000 (UTC)
DKIM-Signature: a=rsa-sha256; v=1; c=relaxed/relaxed; d=tklengyel.com;
 q=dns/txt; 
 s=krs; t=1576708474; h=Content-Type: Cc: To: Subject: Message-ID: Date:
 From: In-Reply-To: References: MIME-Version: Sender;
 bh=XHb7ij37/2TPgbjVCYWww54RtSbGQkGvhdf08lps+m8=;
 b=jo7tdmvIiEbbSfQZ7FDC+6WbCkrPSXv3GP69tDhzKnSD1oem51XRcviRUrROqa/741gsZH1x
 yiDdWWrEygXTe5/K89KijbkCpc+N5r6RFevrGqONnHnDd7cJn8rX0cvNuscSjog/opY+/CKC
 GivJRK24ON2O4CbovfO1dqjY/08=
X-Mailgun-Sending-Ip: 209.61.151.224
X-Mailgun-Sid: WyIyYTNmOCIsICJ4ZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmciLCAiY2Q4NDAiXQ==
Received: from mail-wm1-f43.google.com (mail-wm1-f43.google.com
 [209.85.128.43])
 by mxa.mailgun.org with ESMTP id 5dfaa977.7f9b44d362b0-smtp-out-n01;
 Wed, 18 Dec 2019 22:34:31 -0000 (UTC)
Received: by mail-wm1-f43.google.com with SMTP id 20so3524214wmj.4
 for <xen-devel@lists.xenproject.org>; Wed, 18 Dec 2019 14:34:30 -0800 (PST)
X-Gm-Message-State: APjAAAVEc+M8Xh6SGb9NbFKY0Us8GlmwUcavobdkGjn3yLfQDn96VctD
 kvt8gA0IxXuc0onCZV9GE+EG6g3dnvFi+K9qJmg=
X-Google-Smtp-Source: APXvYqxAIC7o2dRYEQ30x0CQsFf/3UJk8OwTc4nedoXFnse2daJsTTRrjXhQpyyNxog35C1V7bf2nx1ReoMriqQ1oCM=
X-Received: by 2002:a1c:22c6:: with SMTP id i189mr6314387wmi.15.1576708470010; 
 Wed, 18 Dec 2019 14:34:30 -0800 (PST)
MIME-Version: 1.0
References: <cover.1576697796.git.tamas.lengyel@intel.com>
 <22a6cb7bd5593ed38cf6f66c26c4734a04718e1a.1576697796.git.tamas.lengyel@intel.com>
 <c6d975b9-638f-355d-79f8-1c1fae4c6007@xen.org>
In-Reply-To: <c6d975b9-638f-355d-79f8-1c1fae4c6007@xen.org>
From: Tamas K Lengyel <tamas@tklengyel.com>
Date: Wed, 18 Dec 2019 15:33:53 -0700
X-Gmail-Original-Message-ID: <CABfawhnVbzv4UEQFQoRwYurKOWB4Vw=OtsxXUDtFX1HRxr-sWA@mail.gmail.com>
Message-ID: <CABfawhnVbzv4UEQFQoRwYurKOWB4Vw=OtsxXUDtFX1HRxr-sWA@mail.gmail.com>
To: Julien Grall <julien@xen.org>
Subject: Re: [Xen-devel] [PATCH v2 19/20] x86/mem_sharing: reset a fork
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>,
 Tamas K Lengyel <tamas.lengyel@intel.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Jan Beulich <jbeulich@suse.com>,
 Xen-devel <xen-devel@lists.xenproject.org>,
 =?UTF-8?Q?Roger_Pau_Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gV2VkLCBEZWMgMTgsIDIwMTkgYXQgMzowMCBQTSBKdWxpZW4gR3JhbGwgPGp1bGllbkB4ZW4u
b3JnPiB3cm90ZToKPgo+IEhpIFRhbWFzLAo+Cj4gT24gMTgvMTIvMjAxOSAxOTo0MCwgVGFtYXMg
SyBMZW5neWVsIHdyb3RlOgo+ID4gSW1wbGVtZW50IGh5cGVyY2FsbCB0aGF0IGFsbG93cyBhIGZv
cmsgdG8gc2hlZCBhbGwgbWVtb3J5IHRoYXQgZ290IGFsbG9jYXRlZAo+ID4gZm9yIGl0IGR1cmlu
ZyBpdHMgZXhlY3V0aW9uIGFuZCByZS1sb2FkIGl0cyB2Q1BVIGNvbnRleHQgZnJvbSB0aGUgcGFy
ZW50IFZNLgo+ID4gVGhpcyBhbGxvd3MgdGhlIGZvcmtlZCBWTSB0byByZXNldCBpbnRvIHRoZSBz
YW1lIHN0YXRlIHRoZSBwYXJlbnQgVk0gaXMgaW4gYQo+ID4gZmFzdGVyIHdheSB0aGVuIGNyZWF0
aW5nIGEgbmV3IGZvcmsgd291bGQgYmUuIE1lYXN1cmVtZW50cyBzaG93IGFib3V0IGEgMngKPiA+
IHNwZWVkdXAgZHVyaW5nIG5vcm1hbCBmdXp6aW5nIG9wZXJhdGlvbnMuIFBlcmZvcm1hbmNlIG1h
eSB2YXJ5IGRlcGVuZGluZyBob3cKPiA+IG11Y2ggbWVtb3J5IGdvdCBhbGxvY2F0ZWQgZm9yIHRo
ZSBmb3JrZWQgVk0uIElmIGl0IGhhcyBiZWVuIGNvbXBsZXRlbHkKPiA+IGRlZHVwbGljYXRlZCBm
cm9tIHRoZSBwYXJlbnQgVk0gdGhlbiBjcmVhdGluZyBhIG5ldyBmb3JrIHdvdWxkIGxpa2VseSBi
ZSBtb3JlCj4gPiBwZXJmb3JtYW50Lgo+ID4KPiA+IFNpZ25lZC1vZmYtYnk6IFRhbWFzIEsgTGVu
Z3llbCA8dGFtYXMubGVuZ3llbEBpbnRlbC5jb20+Cj4gPiAtLS0KPiA+ICAgeGVuL2FyY2gveDg2
L21tL21lbV9zaGFyaW5nLmMgfCAxMDUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
Kwo+ID4gICB4ZW4vaW5jbHVkZS9wdWJsaWMvbWVtb3J5LmggICB8ICAgMSArCj4gPiAgIDIgZmls
ZXMgY2hhbmdlZCwgMTA2IGluc2VydGlvbnMoKykKPiA+Cj4gPiBkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tL21lbV9zaGFyaW5nLmMgYi94ZW4vYXJjaC94ODYvbW0vbWVtX3NoYXJpbmcuYwo+
ID4gaW5kZXggZTkzYWQyZWM1YS4uNDczNWEzMzRiOSAxMDA2NDQKPiA+IC0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS9tZW1fc2hhcmluZy5jCj4gPiArKysgYi94ZW4vYXJjaC94ODYvbW0vbWVtX3NoYXJp
bmcuYwo+ID4gQEAgLTE2MjIsNiArMTYyMiw4NyBAQCBzdGF0aWMgaW50IG1lbV9zaGFyaW5nX2Zv
cmsoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGRvbWFpbiAqY2QpCj4gPiAgICAgICByZXR1cm4g
MDsKPiA+ICAgfQo+ID4KPiA+ICtzdHJ1Y3QgZ2ZuX2ZyZWU7Cj4gPiArc3RydWN0IGdmbl9mcmVl
IHsKPiA+ICsgICAgc3RydWN0IGdmbl9mcmVlICpuZXh0Owo+ID4gKyAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlOwo+ID4gKyAgICBnZm5fdCBnZm47Cj4gPiArfTsKPiA+ICsKPiA+ICtzdGF0aWMg
aW50IG1lbV9zaGFyaW5nX2ZvcmtfcmVzZXQoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGRvbWFp
biAqY2QpCj4gPiArewo+ID4gKyAgICBpbnQgcmM7Cj4gPiArCj4gPiArICAgIHN0cnVjdCBwMm1f
ZG9tYWluKiBwMm0gPSBwMm1fZ2V0X2hvc3RwMm0oY2QpOwo+ID4gKyAgICBzdHJ1Y3QgZ2ZuX2Zy
ZWUgKmxpc3QgPSBOVUxMOwo+ID4gKyAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOwo+ID4gKwo+
ID4gKyAgICBwYWdlX2xpc3RfZm9yX2VhY2gocGFnZSwgJmNkLT5wYWdlX2xpc3QpCj4KPiBBRkFJ
Q1QsIHlvdXIgZG9tYWluIGlzIG5vdCBwYXVzZWQsIHNvIGl0IHdvdWxkIGJlIHBvc3NpYmxlIHRv
IGhhdmUgcGFnZQo+IGFkZGVkL3JlbW92ZSBpbiB0aGF0IGxpc3QgYmVoaW5kIHlvdXIgYmFjay4K
CldlbGwsIGl0J3Mgbm90IHRoYXQgaXQncyBub3QgcGF1c2VkLCBpdCdzIGp1c3QgdGhhdCBJIGhh
dmVuJ3QgYWRkZWQgYQpzYW5pdHkgY2hlY2sgdG8gbWFrZSBzdXJlIGl0IGlzLiBUaGUgdG9vbHN0
YWNrIGNhbiAoYW5kIHNob3VsZCkgcGF1c2UKaXQsIHNvIHRoYXQgc2FuaXR5IGNoZWNrIHdvdWxk
IGJlIHdhcnJhbnRlZC4KCj4KPiBZb3UgYWxzbyBoYXZlIG11bHRpcGxlIGxvb3Agb24gdGhlIHBh
Z2VfbGlzdCBpbiB0aGlzIGZ1bmN0aW9uLiBHaXZlbiB0aGUKPiBudW1iZXIgb2YgcGFnZV9saXN0
IGNhbiBiZSBxdWl0ZSBiaWcsIHRoaXMgaXMgYSBjYWxsIGZvciBob2dnaW5nIHRoZQo+IHBDUFUg
YW5kIGFuIFJDVSBsb2NrIG9uIHRoZSBkb21haW4gdkNQVSBydW5uaW5nIHRoaXMgY2FsbC4KClRo
ZXJlIGlzIGp1c3Qgb25lIGxvb3Agb3ZlciBwYWdlX2xpc3QgaXRzZWxmLCB0aGUgc2Vjb25kIGxv
b3AgaXMgb24KdGhlIGludGVybmFsIGxpc3QgdGhhdCBpcyBiZWluZyBidWlsdCBoZXJlIHdoaWNo
IHdpbGwgYmUgYSBzdWJzZXQuIFRoZQpsaXN0IGl0c2VsZiBpbiBmYWN0IHNob3VsZCBiZSBzbWFs
bCAoaW4gb3VyIHRlc3RzIHVzdWFsbHkgPDEwMCkuCkdyYW50ZWQgdGhlIGxpc3QgY2FuIGdyb3cg
bGFyZ2VyLCBidXQgaW4gdGhvc2UgY2FzZXMgaXRzIGxpa2VseSBiZXR0ZXIKdG8ganVzdCBkaXNj
YXJkIHRoZSBmb3JrIGFuZCBjcmVhdGUgYSBuZXcgb25lLiBTbyBpbiBteSBvcGluaW9uIGFkZGlu
ZwphIGh5cGVyY2FsbCBjb250aW51YXRpb24gdG8gdGhpcyBub3QgbmVlZGVkLgoKPgo+ID4gKyAg
ICB7Cj4gPiArICAgICAgICBtZm5fdCBtZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKPiA+ICsgICAg
ICAgIGlmICggbWZuX3ZhbGlkKG1mbikgKQo+ID4gKyAgICAgICAgewo+ID4gKyAgICAgICAgICAg
IHAybV90eXBlX3QgcDJtdDsKPiA+ICsgICAgICAgICAgICBwMm1fYWNjZXNzX3QgcDJtYTsKPiA+
ICsgICAgICAgICAgICBnZm5fdCBnZm4gPSBtZm5fdG9fZ2ZuKGNkLCBtZm4pOwo+ID4gKyAgICAg
ICAgICAgIG1mbiA9IF9fZ2V0X2dmbl90eXBlX2FjY2VzcyhwMm0sIGdmbl94KGdmbiksICZwMm10
LCAmcDJtYSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwg
TlVMTCwgZmFsc2UpOwo+ID4gKyAgICAgICAgICAgIGlmICggcDJtX2lzX3JhbShwMm10KSApCj4g
PiArICAgICAgICAgICAgewo+ID4gKyAgICAgICAgICAgICAgICBzdHJ1Y3QgZ2ZuX2ZyZWUgKmdm
bl9mcmVlOwo+ID4gKyAgICAgICAgICAgICAgICBpZiAoICFnZXRfcGFnZShwYWdlLCBjZCkgKQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfcmVzZXQ7Cj4gPiArCj4gPiArICAgICAg
ICAgICAgICAgIC8qCj4gPiArICAgICAgICAgICAgICAgICAqIFdlIGNhbid0IGZyZWUgdGhlIHBh
Z2Ugd2hpbGUgaXRlcmF0aW5nIG92ZXIgdGhlIHBhZ2VfbGlzdAo+ID4gKyAgICAgICAgICAgICAg
ICAgKiBzbyB3ZSBidWlsZCBhIHNlcGFyYXRlIGxpc3QgdG8gbG9vcCBvdmVyLgo+ID4gKyAgICAg
ICAgICAgICAgICAgKgo+ID4gKyAgICAgICAgICAgICAgICAgKiBXZSB3YW50IHRvIGl0ZXJhdGUg
b3ZlciB0aGUgcGFnZV9saXN0IGluc3RlYWQgb2YgY2hlY2tpbmcKPiA+ICsgICAgICAgICAgICAg
ICAgICogZ2ZuIGZyb20gMCB0byBtYXhfZ2ZuIGJlY2F1c2UgdGhpcyBpcyB+MTB4IGZhc3Rlci4K
PiA+ICsgICAgICAgICAgICAgICAgICovCj4gPiArICAgICAgICAgICAgICAgIGdmbl9mcmVlID0g
eG1hbGxvYyhzdHJ1Y3QgZ2ZuX2ZyZWUpOwo+Cj4gSWYgSSBkaWQgdGhlIG1hdGggcmlnaHQsIGZv
ciBhIDRHIGd1ZXN0IHRoaXMgd2lsbCByZXF1aXJlIGF0IH4yNE1CIG9mCj4gbWVtb3J5LiBBY3R1
YWxseSwgaXMgaXQgcmVhbGx5IG5lY2Vzc2FyeSB0byBkbyB0aGUgYWxsb2NhdGlvbiBmb3IgYQo+
IHNob3J0IHBlcmlvZCBvZiB0aW1lPwoKSWYgeW91IGhhdmUgYSBmdWxseSBkZWR1cGxpY2F0ZWQg
Zm9yayB0aGVuIHlvdSBzaG91bGQgbm90IGJlIHVzaW5nCnRoaXMgZnVuY3Rpb24gdG8gYmVnaW4g
d2l0aC4gWW91IGdldCBiZXR0ZXIgcGVyZm9ybWFuY2UgbXkgdGhyb3dpbmcKdGhhdCBvbmUgYXdh
eSBhbmQgY3JlYXRpbmcgYSBuZXcgb25lLiBBcyBmb3IgdXNpbmcgeG1hbGxvYyBoZXJlLCBJJ20K
bm90IHN1cmUgd2hhdCBvdGhlciB3YXkgSSBoYXZlIHRvIGJ1aWxkIGEgbGlzdCBvZiBwYWdlcyB0
aGF0IG5lZWQgdG8KYmUgZnJlZWQuIEkgY2FuJ3QgZnJlZSB0aGUgcGFnZSBpdHNlbGYgd2hpbGUg
SSdtIGl0ZXJhdGluZyBvbgpwYWdlX2xpc3QgKHRoYXQgSSdtIGF3YXJlIG9mKS4gVGhlIG9ubHkg
b3RoZXIgb3B0aW9uIGF2YWlsYWJsZSBpcwpjYWxsaW5nIF9fZ2V0X2dmbl90eXBlX2FjY2VzcyB3
aXRoIGdmbj0wLi5tYXhfZ2ZuIHdoaWNoIHdpbGwgYmUKZXh0cmVtZWx5IHNsb3cgYmVjYXVzZSB5
b3UgaGF2ZSB0byBsb29wIG92ZXIgYSBsb3Qgb2YgaG9sZXMuCgo+Cj4gV2hhdCBhcmUgeW91IHRy
eWluZyB0byBhY2hpZXZlIGJ5IGl0ZXJhdGluZyB0d2ljZSBvbiB0aGUgR0ZOPyBXb3VsZG4ndAo+
IGl0IGJlIGVhc2llciB0byBwYXVzZSB0aGUgZG9tYWluPwoKSSdtIG5vdCBzdXJlIHdoYXQgeW91
IG1lYW4sIHdoZXJlIGRvIHlvdSBzZWUgbWUgaXRlcmF0aW5nIHR3aWNlIG9uIHRoZQpnZm4/IEFu
ZCB3aGF0IGRvZXMgcGF1c2luZyBoYXZlIHRvIGRvIHdpdGggaXQ/CgpUaGFuCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBs
aXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2pl
Y3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

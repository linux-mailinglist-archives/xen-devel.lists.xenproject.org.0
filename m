Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 798E9614A4B
	for <lists+xen-devel@lfdr.de>; Tue,  1 Nov 2022 13:07:43 +0100 (CET)
Received: from list by lists.xenproject.org with outflank-mailman.433670.686792 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1opq2m-0007kx-9y; Tue, 01 Nov 2022 12:07:00 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 433670.686792; Tue, 01 Nov 2022 12:07:00 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1opq2m-0007hD-3H; Tue, 01 Nov 2022 12:07:00 +0000
Received: by outflank-mailman (input) for mailman id 433670;
 Tue, 01 Nov 2022 12:05:09 +0000
Received: from se1-gles-sth1-in.inumbo.com ([159.253.27.254]
 helo=se1-gles-sth1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=Lfjo=3B=xenbits.xen.org=jgross@srs-se1.protection.inumbo.net>)
 id 1oppxN-0004vc-VG
 for xen-devel@lists.xen.org; Tue, 01 Nov 2022 12:01:26 +0000
Received: from mail.xenproject.org (mail.xenproject.org [104.130.215.37])
 by se1-gles-sth1.inumbo.com (Halon) with ESMTPS
 id d8314b20-59dc-11ed-91b5-6bf2151ebd3b;
 Tue, 01 Nov 2022 13:00:57 +0100 (CET)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <jgross@xenbits.xen.org>)
 id 1oppwX-0005Wm-QW; Tue, 01 Nov 2022 12:00:33 +0000
Received: from jgross by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <jgross@xenbits.xen.org>)
 id 1oppwX-0005Mu-KO; Tue, 01 Nov 2022 12:00:33 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: d8314b20-59dc-11ed-91b5-6bf2151ebd3b
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=Y3sX+miHJ9pbCRo6V9bOybFfQ+2ooMH2mCcZpQotb48=; b=TtQOcaK+Tx+bV0Oju/n1WREyU5
	Z22ykYdBJt1ECXEG0K36YCx5gR/sMUbegxOSDEHknIyRPEDHmzySeSyujfvmai7ieTqfSKF0DCaCk
	AQtRQS+OGhl8HOuCEd04JjZXr2lr4xTj7pYYAiWW2qdpolPpouKTyNgtlK8CYywb5Kvg=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 326 v4 (CVE-2022-42311,CVE-2022-42312,CVE-2022-42313,CVE-2022-42314,CVE-2022-42315,CVE-2022-42316,CVE-2022-42317,CVE-2022-42318)
 - Xenstore: guests can let run xenstored out of memory
Message-Id: <E1oppwX-0005Mu-KO@xenbits.xenproject.org>
Date: Tue, 01 Nov 2022 12:00:33 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

 Xen Security Advisory CVE-2022-42311,CVE-2022-42312,CVE-2022-42313,CVE-2022-42314,CVE-2022-42315,CVE-2022-42316,CVE-2022-42317,CVE-2022-42318 / XSA-326
                                                                        version 4

         Xenstore: guests can let run xenstored out of memory

UPDATES IN VERSION 4
====================

Public release.

ISSUE DESCRIPTION
=================

Malicious guests can cause xenstored to allocate vast amounts of memory,
eventually resulting in a Denial of Service (DoS) of xenstored.

There are multiple ways how guests can cause large memory allocations
in xenstored:

- - by issuing new requests to xenstored without reading the responses,
  causing the responses to be buffered in memory

- - by causing large number of watch events to be generated via setting up
  multiple xenstore watches and then e.g. deleting many xenstore nodes
  below the watched path

- - by creating as many nodes as allowed with the maximum allowed size and
  path length in as many transactions as possible

- - by accessing many nodes inside a transaction

IMPACT
======

Unprivileged guests can cause a DoS of xenstored, resulting in the
inability to create new guests or modify the configuration of running
guests.

VULNERABLE SYSTEMS
==================

All Xen versions are vulnerable.

Both Xenstore implementations (C and Ocaml) are vulnerable.

MITIGATION
==========

There is no mitigation available.

CREDITS
=======

This issue was discovered by Julien Grall of Amazon.

RESOLUTION
==========

Applying the appropriate attached patches resolve this issue.

Note that the final oxenstored patch (7 or 8, as applicable) is limiting
the security support for oxenstored to trusted driver domains only.

C xenstored Patches 15 and 16 are not part of the XSA, but are useful
for administrators to change current xenstored quota settings and to
audit per-guest resource usage in xenstored.

Note that the patches are based on top of the patches for XSA-414 and
XSA-415. There is a subtle dependency on XSA-419, which can't be resolved
easily, so the patches of XSA-326 should always be applied together with
those of XSA-419.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa326/xsa326-xenstored-??.patch           xen-unstable
xsa326/xsa326-oxenstored-??.patch          xen-unstable
xsa326/xsa326-4.16-xenstored-??.patch      Xen 4.16.x
xsa326/xsa326-4.16-oxenstored-??.patch     Xen 4.16.x
xsa326/xsa326-4.15-xenstored-??.patch      Xen 4.15.x
xsa326/xsa326-4.15-oxenstored-??.patch     Xen 4.15.x
xsa326/xsa326-4.14-xenstored-??.patch      Xen 4.14.x
xsa326/xsa326-4.14-oxenstored-??.patch     Xen 4.14.x
xsa326/xsa326-4.13-xenstored-??.patch      Xen 4.13.x
xsa326/xsa326-4.13-oxenstored-??.patch     Xen 4.13.x

$ sha256sum xsa326* xsa326*/*
fbeb48f2137ead7e933d487b95d819b4adec29e33141655dfb40e66861f8d005  xsa326.meta
5da5e9d053a51faba9a553970d53736b333ce713793ed3cf3fefc19943a3ba3d  xsa326/xsa326-4.13-oxenstored-01.patch
6c65b043f5a9a8963c74b22df2187be7936c1228b1dee7b3cd32ea2f207520d0  xsa326/xsa326-4.13-oxenstored-02.patch
f04f4c29f8a63ff7f08af4d9a99b5da9c44eface3523e2dd9da7119d85445d42  xsa326/xsa326-4.13-oxenstored-03.patch
438ddd4a5fb1b4c9bb5bc911052cbb84b3fbe2ce4c2559ec112b7e9cd6c3c436  xsa326/xsa326-4.13-oxenstored-04.patch
e57d98b53c5b03e34a2e554097b634bbf568d9e336ee0ef7ec703d3ff153dd8a  xsa326/xsa326-4.13-oxenstored-05.patch
0b13429993ab1bb5a2a58edeeebfc8bc50987e5d86dddfd6f7108259c31aed97  xsa326/xsa326-4.13-oxenstored-06.patch
e5c995a8eeea776e57c9878b612f17f2d8cad2538897d8cf385a9f9570ecd076  xsa326/xsa326-4.13-oxenstored-07.patch
247d2461b80884a1bbc063074b89beb769243f82f0de61fe0a45fb438b4a6d38  xsa326/xsa326-4.13-oxenstored-08.patch
928c1b4d624b73fab33af936ba520402d0010956939ed4f17f42c8a476e7dd02  xsa326/xsa326-4.13-xenstored-01.patch
4918eab37b70914a01b3277d83d56a20a877982fac8c5c9533afcdc8c16c4123  xsa326/xsa326-4.13-xenstored-02.patch
1b2df2030bbb91729b16174026127f1a056e011814e2c0b14e6b9430c00f6c41  xsa326/xsa326-4.13-xenstored-03.patch
e05aec57d8cdc1f3151cf6a2cfd8fdf10b9776e3ba564ff934d1dd51692c2f12  xsa326/xsa326-4.13-xenstored-04.patch
197e76c74166fc686fd5b1faf6e025abd9a3e1019ebc7954f63d3561b50aa13c  xsa326/xsa326-4.13-xenstored-05.patch
75dd40b36c3c8f43c8387402221caf05c7dd3b842caf88f59a5420039f63279f  xsa326/xsa326-4.13-xenstored-06.patch
979224585e94d6ba01c8faf2ce4378993aace0057b2377a3ef65aea522912787  xsa326/xsa326-4.13-xenstored-07.patch
ca15279f2d11ca693c1bf4f716835e029f200dab7ad07a12c5d4e9a9199d35ea  xsa326/xsa326-4.13-xenstored-08.patch
7a041894a74bed53ed9951b62725535915398a1dd90d825514d338264b80f3cc  xsa326/xsa326-4.13-xenstored-09.patch
19273b8a79da99ebfbe166e7eb2ec2ea4e68352d90535cc9e1ca154b6cdcab42  xsa326/xsa326-4.13-xenstored-10.patch
4fa07eb6d5fe1d0d49c1e7ad28e106a57f5785cae3a1ff8fd81a0192f0e1ed70  xsa326/xsa326-4.13-xenstored-11.patch
750984eee04854a09ea053213a7b3d411dc487a45056295e943ff4c5e7c8fa10  xsa326/xsa326-4.13-xenstored-12.patch
1aa1458b82fac3b1dbf71f0ad2d8f29203e95ffc8bbe61e3f8aa0895613cb5f8  xsa326/xsa326-4.13-xenstored-13.patch
791f86db3611e226801bf562cf93a4bcd5dd25070e65b6490d1a520e5570cda4  xsa326/xsa326-4.13-xenstored-14.patch
e78ea12c7446a773fb670d674d40cef195bb98f2776c4b43e3737f9cb2742182  xsa326/xsa326-4.13-xenstored-15.patch
3dc9ceed291b414931984952c9bc506e4686cf780a33cd338e1cec254831dc35  xsa326/xsa326-4.13-xenstored-16.patch
19952c1d5a9979cea871323a14ab390e239865e1323193eb46891b365ec4ed9c  xsa326/xsa326-4.14-oxenstored-01.patch
d29ad0d60c3fb07b0f6004bca7cb2457d88c4dd589ccf60261954905f27da982  xsa326/xsa326-4.14-oxenstored-02.patch
124ebbbd5e240113ee0b17fd45d0b8b8ab2fa185197bee9293be109ff209cedb  xsa326/xsa326-4.14-oxenstored-03.patch
8dc1e435dbe7b8ba439117c37e5115784942f0c9724b2976eb9b71eaaf4dacc4  xsa326/xsa326-4.14-oxenstored-04.patch
601dd879e100eb73d13018ba7f36a9e7b1e3d1fa82e0b09ab2e9e5eb9f1d901e  xsa326/xsa326-4.14-oxenstored-05.patch
1744a454249f2e93ca3b01442f9efe3ed699764780a58a99b23358f752d46b1c  xsa326/xsa326-4.14-oxenstored-06.patch
54cd2c156db841c66a1081c8c66b87442bf47d7e0375a311f786527a17feada5  xsa326/xsa326-4.14-oxenstored-07.patch
d6560f5aef9e8e28a4f9773bcc8dd89fd81be1d0a7267b6eba9e9b200c65d4df  xsa326/xsa326-4.14-oxenstored-08.patch
981c67cad44b33660e9e0e7fb6877659da05266a31affb54916cdbf2670ae435  xsa326/xsa326-4.14-xenstored-01.patch
0defc4dc7007d67d217de657305c9f3dce84dc8f9905fe82db5460cfdab48e8a  xsa326/xsa326-4.14-xenstored-02.patch
3b885e855debf116585f27e5c8a9e6e77575c25b4c729b8b50a9457ea815204e  xsa326/xsa326-4.14-xenstored-03.patch
167f178880e606f914bbd6a12cb0e6f56b4551d441d4ca4afa341978973e0fcc  xsa326/xsa326-4.14-xenstored-04.patch
101dda8679ca2c22a0cc7c38d8701dfb6a082e7bfc67846cf48d4eb9e35bfdc9  xsa326/xsa326-4.14-xenstored-05.patch
ad28cc050cdc76c8db6bacefe5d2084ec5ca2f0023ed6a463b9843f8a835173e  xsa326/xsa326-4.14-xenstored-06.patch
29c234ea29713c997e4686a13c8c6ef1eaa12cc0ba6ed49e729922435e3902f3  xsa326/xsa326-4.14-xenstored-07.patch
b20de5fd7d00218eb8f1e5014c06bc8397c6f93876a7328c61e99b010ad0814d  xsa326/xsa326-4.14-xenstored-08.patch
c1568765f386a9d70b9fb59d532c239c7ef9af5fda544518de13f6b16806e099  xsa326/xsa326-4.14-xenstored-09.patch
a99500c0d25f61c3bf4a29dc4c3a3d9457476c014c279267e2acea7714f5b92e  xsa326/xsa326-4.14-xenstored-10.patch
efa8ec1b0e8ff5f3bcb951e1838641480bb67af68fa6dddeed9a6ea6af45ac7b  xsa326/xsa326-4.14-xenstored-11.patch
fd40770a8cf1365034c76c99c26170ae23055000fbcad389ddad1b2d16426768  xsa326/xsa326-4.14-xenstored-12.patch
905525ab516cdc5104558667810ec0de8626e495ba70d571fc4afc8159768cee  xsa326/xsa326-4.14-xenstored-13.patch
4d1037a90a345ae71719abcacee274cbed35d05838659a0a4ab33951ee2418b5  xsa326/xsa326-4.14-xenstored-14.patch
bea121de03b5c2e4736020264b949c66bb5c18edfc3f17c5591cb9a42499f469  xsa326/xsa326-4.14-xenstored-15.patch
86376255e4b514ec77ce759321131271b8aa0075ac14116a7d49a36ac5debcc0  xsa326/xsa326-4.14-xenstored-16.patch
30d14a68dcd80fb3f9d4df12aed6897c0ddce12e5155ac844a42b776611769cc  xsa326/xsa326-4.15-oxenstored-01.patch
958e12676110ce2ad79103ac69c1b468dc792c40ebeb4a7898878d05661b865f  xsa326/xsa326-4.15-oxenstored-02.patch
5f9bd4a0bc12db5c9bf89259f1d2ea76b28308ac6f1a74292284c45d88dadd30  xsa326/xsa326-4.15-oxenstored-03.patch
b02baaad64ea00e3e05ab8de2b5c0bb1047792870f57c1974ae9cef43fc3201e  xsa326/xsa326-4.15-oxenstored-04.patch
644d84f59dca4d55894ec4851c11d4fc0a15203319a9016fd5476fb4a4c43ca7  xsa326/xsa326-4.15-oxenstored-05.patch
9a93874c9c63bd5a418160d2973517302c926cfaeaa22afab5dbe9da54399697  xsa326/xsa326-4.15-oxenstored-06.patch
7dbf0a1d70aa943ea7b0be69d16027239d7f965e3994a95b47d8822d7b0c3d84  xsa326/xsa326-4.15-oxenstored-07.patch
3809e21e09ff741448b3126bb2fb7979a67e430ca6d5b2a70fd22bd210ca276d  xsa326/xsa326-4.15-oxenstored-08.patch
b05a06e5f29c97192710376ce89e80962a893827a30911087a6b883ff644cef6  xsa326/xsa326-4.15-xenstored-01.patch
e0b3249792c03b9dd0e8820e5db9f6e08b38ea5182a60baff1d9264dcf6f1b16  xsa326/xsa326-4.15-xenstored-02.patch
d94f34802f4ed302f44823b1a47c25792b5e1d040d3e04878a53b006339b4654  xsa326/xsa326-4.15-xenstored-03.patch
ec414451bbec7229282e4db650b0b298d89c1881720886569b2a1210576398bd  xsa326/xsa326-4.15-xenstored-04.patch
ab25a8817732f5e9f4dd3cb3cf2130de50dbe39d284c0ac80ce210b738a6a3fa  xsa326/xsa326-4.15-xenstored-05.patch
a7c0151d34d7b340ccb02780dfc3267e654b4423cdfff32650577a4da519677e  xsa326/xsa326-4.15-xenstored-06.patch
a4933e62317428fc8d8a5ba12a653613ee3e54ad89f26831736f0b12bb18d68e  xsa326/xsa326-4.15-xenstored-07.patch
0b365ea9d0dfd2b2773b42a19826e369bb6e79c88f118ec41a80570be93d2c26  xsa326/xsa326-4.15-xenstored-08.patch
dd04f56f28a6943a141f425ce3b45ebc370c559e33dab2db48f89d077cde24bf  xsa326/xsa326-4.15-xenstored-09.patch
d2260693e4d94b4707459bf277c6a23f322fcd3fa58091cdac896b39a61a890f  xsa326/xsa326-4.15-xenstored-10.patch
97dfa89180a20cc3e3d03edaf2cc48a343d4f07e7982b5ee1e4c61afa3103a6f  xsa326/xsa326-4.15-xenstored-11.patch
acd6041a412fc584ccd9376f1e17f51cf40708ec3fa1c0ce64a9c9cdb393e727  xsa326/xsa326-4.15-xenstored-12.patch
ef00a409abfeb078a1e29abf3bd12c017440cb4db09b00a7cab875bb7a920788  xsa326/xsa326-4.15-xenstored-13.patch
e33042c8f63426a3ef75a884b00aaddd7f143324efbb216dae92155b3a6d23c8  xsa326/xsa326-4.15-xenstored-14.patch
e2ab4d46a6d836f485a062eddae2ea3e554da55c68551db22c40b19edc366a56  xsa326/xsa326-4.15-xenstored-15.patch
fb5eac62c4dd11e1a7e998a1b293e1b36998ec7540137790c66ee3e756ee7d7b  xsa326/xsa326-4.15-xenstored-16.patch
22188213c6caf1a9f84e0babdb3c35e9e828424e3bfced237036856291ec86c5  xsa326/xsa326-4.16-oxenstored-01.patch
631891588ca285eb44ebc393a13bfb7fd3da473db031aca612770ccb6e502447  xsa326/xsa326-4.16-oxenstored-02.patch
32f43582d2f25c46a837f36cca54d85a14afe0c04489597fe564bc688ead1dba  xsa326/xsa326-4.16-oxenstored-03.patch
9ea1efcf2260b2170318467a1ae99e898024a3ee139b61570838115a1de8b956  xsa326/xsa326-4.16-oxenstored-04.patch
03eb654ebacfef7e3a91234deb7bc4687f80762ca68b00b7fe23eb273ef8b9f1  xsa326/xsa326-4.16-oxenstored-05.patch
5b771df5d23ecd6a66de93b6d5a5ab3821a3f57770d6a8d9473eb18f4bf1ee9c  xsa326/xsa326-4.16-oxenstored-06.patch
eddf43db08e7c46a15f589f7be3ac64c3967c345b520dd5b4813117332da4b1a  xsa326/xsa326-4.16-oxenstored-07.patch
8c5b11c0a0af8f5f9dff4d64482377f0706c455e65a106f309c9ad56eea1adc6  xsa326/xsa326-4.16-oxenstored-08.patch
a4542bd9278ac83c0e633bbff7d3f446a03b4dac70269c0f079c980d58d9a5ae  xsa326/xsa326-4.16-xenstored-01.patch
6f7b7d523b0b085d2b7f371ec4477859212a265ae9a52f1f8c8f54e62f02a05e  xsa326/xsa326-4.16-xenstored-02.patch
2b9a3f2e1764fedc08aa335603fe7c253e67496534a29ffae8fe6e9c1ba0ce19  xsa326/xsa326-4.16-xenstored-03.patch
0fc9759eb7e6504b9f54090b5d249d602968df8db6de6dff32a84a9134317e72  xsa326/xsa326-4.16-xenstored-04.patch
6962f7381bc11df4fdccb89013968c583c708677d14f5ef57c07e945eaa7bcc6  xsa326/xsa326-4.16-xenstored-05.patch
d30bdd689b0a32b09ec8916917fe5297a1b3dd2f6c93e39fad2864fcd862b4bf  xsa326/xsa326-4.16-xenstored-06.patch
ecc07fc6f1ae78ea8455344e785d1c359fe0c5b3c4be97346812b5aa5dd3a19f  xsa326/xsa326-4.16-xenstored-07.patch
a0f0316c955a7a8a8e74509d9db052ab1560dd132b2e931121368338cd65e5b5  xsa326/xsa326-4.16-xenstored-08.patch
ccced498d856519df82836acb7dccd155b858c62cdab84d95e6aac12ca7e9963  xsa326/xsa326-4.16-xenstored-09.patch
5bc89ffba64be315264cf695a62e27ebb55879eff9d97e8bf0d71ee01eff78af  xsa326/xsa326-4.16-xenstored-10.patch
c25bd21bc05f93622dd9025e787ba60955dc6df0c74db915acd821ab7ecea733  xsa326/xsa326-4.16-xenstored-11.patch
5eec3bb81c5d3a3588bf30a754f630b3d08628c66c35a8d00823d1726591bae0  xsa326/xsa326-4.16-xenstored-12.patch
6f484f7c237c7e92d3ff225e4732b0496a5e899de02812fedfbbcdc5712fff03  xsa326/xsa326-4.16-xenstored-13.patch
e8382b1f37177d3dca5e66adce13e1cec4a320b0865f09535bf51a1d4662bb1c  xsa326/xsa326-4.16-xenstored-14.patch
274708be8a5951eaaa2adb61974c3a1529c35dc1f293cc2e9d4759a2d8e20693  xsa326/xsa326-4.16-xenstored-15.patch
cebadbd9b303551e0208eaefd831608c47056d27f05dcea97cee3cd761eb3f70  xsa326/xsa326-4.16-xenstored-16.patch
16248584282597dd5b405c8ced0d7d8ad644b68b9dbe13dbaa65ad9080fbbbc4  xsa326/xsa326-oxenstored-01.patch
8f1346250c54accdd4da3cbfb29c98bdf8511974e75e6433374e772c4a7f3b88  xsa326/xsa326-oxenstored-02.patch
bc59dbfbd41a95d73c81ecd011c3a3d2cc62f373e1ea0f79792a78572ca06af1  xsa326/xsa326-oxenstored-03.patch
b3e383389d3743809422a4e5a364bad10249531bd64d0af2873294cb9abbcb10  xsa326/xsa326-oxenstored-04.patch
ad9160630efefece9eb59e144e01911dc69d625acca2a5562a1640bc8823bcf0  xsa326/xsa326-oxenstored-05.patch
4279925ed16d89d3f26ecb4a71d2215547088c8f733c4bce596e29b1916e01cf  xsa326/xsa326-oxenstored-06.patch
de8faa4b114faef576024da5f99b7a961efd9f7de5fa6ba60160fe932af36494  xsa326/xsa326-oxenstored-07.patch
b4582a663bf5cc8ef7ab5dccaab1e5b686da6584a5cab3339319c66726535e8e  xsa326/xsa326-xenstored-01.patch
8a5699af6c6d0497f6b16030db31c59cf8b172c21a78d1d2d36f0c590a5f2319  xsa326/xsa326-xenstored-02.patch
b8a9286af5d14e35a9ec541afc20b2ca40550ac0a6e83fc012be396ba42a939b  xsa326/xsa326-xenstored-03.patch
10d4c34475550c7dcf808747a4a44ce74ed42d8c0b0c209c6dc318c397a4ba8f  xsa326/xsa326-xenstored-04.patch
3fba2fc49d5af5466452d4ddfa730194686ff8dbb5a96b29e4d89032e0135a78  xsa326/xsa326-xenstored-05.patch
57e008a2a8921186b797abe068f0ef9d39ea23dcd0f4cb8a4c20a022d17aff77  xsa326/xsa326-xenstored-06.patch
da69f7577dd38fc109e6271d583b3cd19197b6777e70191e079e2e120631d6cf  xsa326/xsa326-xenstored-07.patch
a2ab8f1307609dcfb66abf12c82e8f273f12e1c92f05b350933a73794b02ad73  xsa326/xsa326-xenstored-08.patch
417baecd2b6e10456ef6501619ba617e2c24a32bcad025df3f683f17334e42f9  xsa326/xsa326-xenstored-09.patch
2ccd4bd9524971d140568d9d0cee49931bcf85596744a13ac3520e1e67c71fd8  xsa326/xsa326-xenstored-10.patch
bf119e0c13e4f77d1029410be71987b51c48eb5bfa72c445394e2e2eea004e9c  xsa326/xsa326-xenstored-11.patch
70dadf62eca8bd119ff84d4efdb0c863f8ddaf58e25e29ef6d3b7bc92fc2f0fa  xsa326/xsa326-xenstored-12.patch
6fdd871d77b699fbb4df8efc18fd772131a216e9ac9387832ae66a3af6d58e07  xsa326/xsa326-xenstored-13.patch
49a22d518921be7688cbe5dced9c842b3f0c67f678f3d113bbe5fce36a59d775  xsa326/xsa326-xenstored-14.patch
a8ef297722bb4c5778d3e0f80ab16cdb6024cdb3a349789182d2167409cf1aa2  xsa326/xsa326-xenstored-15.patch
bf20cd4808cba1506ed7404af050d9b05619b48d2d8eda7e166050540b8f25e2  xsa326/xsa326-xenstored-16.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmNg+5QMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZrb0IAKWuWJpPThwmSEFjzNMwdQ+L/xip0AEnl3aVC5UD
DEGtB7mETVnwsUYZYee9+OEWOjHJJ//4eENeaziGvzfPG5scGUjcdMeNrIhPtdqB
jgjrjfE/z+pTQvbQhu5vvjR/m0K+PHgBejiSfKC7K87+yhcuTaMFoUejBoQ2ZzZ0
h5UfEiTktdWRTwQ4HrofgJKKIfhXGBRRXJbzNysNZ2k8eSpq6ALjgEPpmhalBS/t
n1UPKGyToXhVnAwDkV8Bo54EOjhkppIwYuOiGEi4O+weHIq0Oqi9pqpkzCC5QO3q
muUGHYRjJ7yDWzo+gpr27O8949gPXPfDMTKLiWYCXGaw4CA=
=Eyn8
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa326.meta"
Content-Disposition: attachment; filename="xsa326.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAzMjYsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xNiIsCiAgICAiNC4xNSIsCiAgICAiNC4xNCIs
CiAgICAiNC4xMyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4ZW4iCiAgXSwK
ICAiUmVjaXBlcyI6IHsKICAgICI0LjEzIjogewogICAgICAiUmVjaXBlcyI6
IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICIw
YmU2M2MyNjE1YjI2ODAwMWY3Y2M5YjcyY2UyNWVlZDk1MjczN2RjIiwKICAg
ICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICA0MTQsCiAgICAgICAg
ICAgIDQxNQogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwog
ICAgICAgICAgICAieHNhMzI2L3hzYTMyNi00LjEzLXhlbnN0b3JlZC0/Py5w
YXRjaCIsCiAgICAgICAgICAgICJ4c2EzMjYveHNhMzI2LTQuMTMtb3hlbnN0
b3JlZC0/Py5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0K
ICAgIH0sCiAgICAiNC4xNCI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAgICAg
ICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYiOiAiMDE2ZGU2Mjc0
N2IyNmVhZDVhNWM3NjNiNjQwZmU4ZTIwNWNkMTgyYiIsCiAgICAgICAgICAi
UHJlcmVxcyI6IFsKICAgICAgICAgICAgNDE0LAogICAgICAgICAgICA0MTUK
ICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAg
ICAgInhzYTMyNi94c2EzMjYtNC4xNC14ZW5zdG9yZWQtPz8ucGF0Y2giLAog
ICAgICAgICAgICAieHNhMzI2L3hzYTMyNi00LjE0LW94ZW5zdG9yZWQtPz8u
cGF0Y2giCiAgICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAog
ICAgIjQuMTUiOiB7CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4i
OiB7CiAgICAgICAgICAiU3RhYmxlUmVmIjogIjgxNjU4MGFmZGQxNzMwZDRm
ODVmNjQ0NzdhMjQyYTQzOWFmMWNkZjgiLAogICAgICAgICAgIlByZXJlcXMi
OiBbCiAgICAgICAgICAgIDQxNCwKICAgICAgICAgICAgNDE1CiAgICAgICAg
ICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2Ez
MjYveHNhMzI2LTQuMTUteGVuc3RvcmVkLT8/LnBhdGNoIiwKICAgICAgICAg
ICAgInhzYTMyNi94c2EzMjYtNC4xNS1veGVuc3RvcmVkLT8/LnBhdGNoIgog
ICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjE2
IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAg
ICAgICAgIlN0YWJsZVJlZiI6ICIxYmNlN2ZiMWY3MDJkYTRmN2E3NDljNmYx
NDU3ZWNiMjBiZjc0ZmNhIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAg
ICAgICAgICA0MTIsCiAgICAgICAgICAgIDQxNCwKICAgICAgICAgICAgNDE1
CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAg
ICAgICJ4c2EzMjYveHNhMzI2LTQuMTYteGVuc3RvcmVkLT8/LnBhdGNoIiwK
ICAgICAgICAgICAgInhzYTMyNi94c2EzMjYtNC4xNi1veGVuc3RvcmVkLT8/
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICJtYXN0ZXIiOiB7CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4
ZW4iOiB7CiAgICAgICAgICAiU3RhYmxlUmVmIjogImNjNDc0N2JlOGJhMTU3
YTNiMzEwOTIxZTllZTA3ZmI4NTQ1YWEyMDYiLAogICAgICAgICAgIlByZXJl
cXMiOiBbCiAgICAgICAgICAgIDQxMiwKICAgICAgICAgICAgNDE0LAogICAg
ICAgICAgICA0MTUKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6
IFsKICAgICAgICAgICAgInhzYTMyNi94c2EzMjYteGVuc3RvcmVkLT8/LnBh
dGNoIiwKICAgICAgICAgICAgInhzYTMyNi94c2EzMjYtb3hlbnN0b3JlZC0/
Py5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0K
ICB9Cn0=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSAyNGQ2ZTkxMjYyMWRiMjQyYThmZGZmMjliODM1MmI1MTZlMWU5ZDFl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IFN5bmNocm9uaXNlIGRlZmF1
bHRzIHdpdGggb3hlbnN0b3JlLmNvbmYuaW4KTUlNRS1WZXJzaW9uOiAxLjAK
Q29udGVudC1UeXBlOiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRl
bnQtVHJhbnNmZXItRW5jb2Rpbmc6IDhiaXQKCldlIGN1cnJlbnRseSBoYXZl
IDIgZGlmZmVyZW50IHNldCBvZiBkZWZhdWx0cyBpbiB1cHN0cmVhbSBYZW4g
Z2l0IHRyZWU6CiogZGVmaW5lZCBpbiB0aGUgc291cmNlIGNvZGUsIG9ubHkg
dXNlZCBpZiB0aGVyZSBpcyBubyBjb25maWcgZmlsZQoqIGRlZmluZWQgaW4g
dGhlIG94ZW5zdG9yZWQuY29uZi5pbiB1cHN0cmVhbSBYZW4KCkFuIG94ZW5z
dG9yZWQuY29uZiBmaWxlIGlzIG5vdCBtYW5kYXRvcnksIGFuZCBpZiBtaXNz
aW5nLCBtYXhyZXF1ZXN0cyBpbgpwYXJ0aWN1bGFyIGhhcyBhbiB1bnNhZmUg
ZGVmYXVsdC4KClJlc3luYyB0aGUgZGVmYXVsdHMgZnJvbSBveGVuc3RvcmVk
LmNvbmYuaW4gaW50byB0aGUgc291cmNlIGNvZGUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE2LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEVkd2luIFTDtnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2Vk
LWJ5OiBDaHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJp
eC5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Rl
ZmluZS5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5k
ZXggZjU3NDM5N2E0YzBiLi45NmMxMjVhOTY5ZGEgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2Nh
bWwveGVuc3RvcmVkL2RlZmluZS5tbApAQCAtMjIsOSArMjIsOSBAQCBsZXQg
eHNfZGFlbW9uX3NvY2tldF9ybyA9IFBhdGhzLnhlbl9ydW5fc3RvcmVkIF4g
Ii9zb2NrZXRfcm8iCiAKIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRo
cy54ZW5fY29uZmlnX2RpcgogCi1sZXQgbWF4d2F0Y2ggPSByZWYgKDUwKQot
bGV0IG1heHRyYW5zYWN0aW9uID0gcmVmICgyMCkKLWxldCBtYXhyZXF1ZXN0
cyA9IHJlZiAoLTEpICAgKCogbWF4aW11bSByZXF1ZXN0cyBwZXIgdHJhbnNh
Y3Rpb24gKikKK2xldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQorbGV0IG1heHRy
YW5zYWN0aW9uID0gcmVmICgxMCkKK2xldCBtYXhyZXF1ZXN0cyA9IHJlZiAo
MTAyNCkgICAoKiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAq
KQogCiBsZXQgY29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCiBsZXQg
Y29uZmxpY3RfbWF4X2hpc3Rvcnlfc2Vjb25kcyA9IHJlZiAwLjA1CmRpZmYg
LS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwgYi90b29s
cy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwKaW5kZXggYWJjYWM5MTI4MDVh
Li42ZTNkNjQwMWFlODkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0
b3JlZC9xdW90YS5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVv
dGEubWwKQEAgLTIwLDggKzIwLDggQEAgZXhjZXB0aW9uIFRyYW5zYWN0aW9u
X29wZW5lZAogCiBsZXQgd2FybiBmbXQgPSBMb2dnaW5nLndhcm4gInF1b3Rh
IiBmbXQKIGxldCBhY3RpdmF0ZSA9IHJlZiB0cnVlCi1sZXQgbWF4ZW50ID0g
cmVmICgxMDAwMCkKLWxldCBtYXhzaXplID0gcmVmICg0MDk2KQorbGV0IG1h
eGVudCA9IHJlZiAoMTAwMCkKK2xldCBtYXhzaXplID0gcmVmICgyMDQ4KQog
CiB0eXBlIHQgPSB7CiAJbWF4ZW50OiBpbnQ7ICAgICAgICAgICAgICAgKCog
bWF4IGVudGl0aWVzIHBlciBkb21VICopCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSBlMzM1NzJmMjg1ZDNlNGI0YWFjODQ5MzAwMDQ0ODMwOTQzMjAxZDk0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogVGh1LCAyOCBKdWwgMjAyMiAxNzowODoxNSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IENoZWNrIGZvciBtYXhyZXF1
ZXN0cyBiZWZvcmUgcGVyZm9ybWluZwogb3BlcmF0aW9ucwpNSU1FLVZlcnNp
b246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRG
LTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKUHJldmlvdXNs
eSB3ZSdkIHBlcmZvcm0gdGhlIG9wZXJhdGlvbiwgcmVjb3JkIHRoZSB1cGRh
dGVkIHRyZWUgaW4gdGhlCnRyYW5zYWN0aW9uIHJlY29yZCwgdGhlbiB0cnkg
dG8gaW5zZXJ0IGEgd2F0Y2hvcCBwYXRoIGFuZCB0aGUgcmVwbHkgcGFja2V0
LgoKSWYgd2UgZXhjZWVkZWQgbWF4IHJlcXVlc3RzIHdlIHdvdWxkJ3ZlIHJl
dHVybmVkIEVRVU9UQSwgYnV0IHN0aWxsOgoqIGhhdmUgcGVyZm9ybWVkIHRo
ZSBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uJ3MgdHJlZQoqIGhhdmUg
cmVjb3JkZWQgdGhlIHdhdGNob3AsIG1ha2luZyB0aGlzIHF1ZXVlIGVmZmVj
dGl2ZWx5IHVuYm91bmRlZAoKSXQgaXMgYmV0dGVyIGlmIHdlIGNoZWNrIHdo
ZXRoZXIgd2UnZCBoYXZlIHJvb20gdG8gc3RvcmUgdGhlIG9wZXJhdGlvbiBi
ZWZvcmUKcGVyZm9ybWluZyB0aGUgdHJhbnNhY3Rpb24sIGFuZCByYWlzZSBF
UVVPVEEgdGhlcmUuICBUaGVuIHRoZSB0cmFuc2FjdGlvbgpyZWNvcmQgd29u
J3QgZ3Jvdy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2IC8gQ1ZFLTIwMjIt
NDIzMTcuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1h
em9uLmNvbT4KU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbCBiL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDNhYjA5YzZjZTkyNi4uMzI3
OWIxOWIxYmZmIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vz
cy5tbApAQCAtMjUzLDYgKzI1Myw3IEBAIGxldCBpbnB1dF9oYW5kbGVfZXJy
b3IgfmNvbnMgfmRvbXMgfmZjdCB+Y29uIH50IH5yZXEgPQogCWxldCByZXBs
eV9lcnJvciBlID0KIAkJUGFja2V0LkVycm9yIGUgaW4KIAl0cnkKKwkJVHJh
bnNhY3Rpb24uY2hlY2tfcXVvdGFfZXhuIH5wZXJtOihDb25uZWN0aW9uLmdl
dF9wZXJtIGNvbikgdDsKIAkJZmN0IGNvbiB0IGRvbXMgY29ucyByZXEuUGFj
a2V0LmRhdGEKIAl3aXRoCiAJfCBEZWZpbmUuSW52YWxpZF9wYXRoICAgICAg
ICAgIC0+IHJlcGx5X2Vycm9yICJFSU5WQUwiCkBAIC01NDUsOSArNTQ2LDEw
IEBAIGxldCBwcm9jZXNzX3BhY2tldCB+c3RvcmUgfmNvbnMgfmRvbXMgfmNv
biB+cmVxID0KIAkJaW4KIAogCQlsZXQgcmVzcG9uc2UgPSB0cnkKKwkJCVRy
YW5zYWN0aW9uLmNoZWNrX3F1b3RhX2V4biB+cGVybTooQ29ubmVjdGlvbi5n
ZXRfcGVybSBjb24pIHQ7CiAJCQlpZiB0aWQgPD4gVHJhbnNhY3Rpb24ubm9u
ZSB0aGVuCiAJCQkJKCogUmVtZW1iZXIgdGhlIHJlcXVlc3QgYW5kIHJlc3Bv
bnNlIGZvciB0aGlzIG9wZXJhdGlvbiBpbiBjYXNlIHdlIG5lZWQgdG8gcmVw
bGF5IHRoZSB0cmFuc2FjdGlvbiAqKQotCQkJCVRyYW5zYWN0aW9uLmFkZF9v
cGVyYXRpb24gfnBlcm06KENvbm5lY3Rpb24uZ2V0X3Blcm0gY29uKSB0IHJl
cSByZXNwb25zZTsKKwkJCQlUcmFuc2FjdGlvbi5hZGRfb3BlcmF0aW9uIHQg
cmVxIHJlc3BvbnNlOwogCQkJcmVzcG9uc2UKIAkJd2l0aCBRdW90YS5MaW1p
dF9yZWFjaGVkIC0+CiAJCQlQYWNrZXQuRXJyb3IgIkVRVU9UQSIKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbAppbmRleCAx
N2IxYmRmMmVhZjkuLjI5NDE0M2UyMzM1YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3RyYW5zYWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbApAQCAtODUsNiArODUsNyBA
QCB0eXBlIHQgPSB7CiAJb2xkcm9vdDogU3RvcmUuTm9kZS50OwogCW11dGFi
bGUgcGF0aHM6IChYZW5idXMuWGIuT3Aub3BlcmF0aW9uICogU3RvcmUuUGF0
aC50KSBsaXN0OwogCW11dGFibGUgb3BlcmF0aW9uczogKFBhY2tldC5yZXF1
ZXN0ICogUGFja2V0LnJlc3BvbnNlKSBsaXN0OworCW11dGFibGUgcXVvdGFf
cmVhY2hlZDogYm9vbDsKIAltdXRhYmxlIHJlYWRfbG93cGF0aDogU3RvcmUu
UGF0aC50IG9wdGlvbjsKIAltdXRhYmxlIHdyaXRlX2xvd3BhdGg6IFN0b3Jl
LlBhdGgudCBvcHRpb247CiB9CkBAIC0xMjcsNiArMTI4LDcgQEAgbGV0IG1h
a2UgPyhpbnRlcm5hbD1mYWxzZSkgaWQgc3RvcmUgPQogCQlvbGRyb290ID0g
U3RvcmUuZ2V0X3Jvb3Qgc3RvcmU7CiAJCXBhdGhzID0gW107CiAJCW9wZXJh
dGlvbnMgPSBbXTsKKwkJcXVvdGFfcmVhY2hlZCA9IGZhbHNlOwogCQlyZWFk
X2xvd3BhdGggPSBOb25lOwogCQl3cml0ZV9sb3dwYXRoID0gTm9uZTsKIAl9
IGluCkBAIC0xNDMsMTMgKzE0NSwxOSBAQCBsZXQgZ2V0X3Jvb3QgdCA9IFN0
b3JlLmdldF9yb290IHQuc3RvcmUKIAogbGV0IGlzX3JlYWRfb25seSB0ID0g
dC5wYXRocyA9IFtdCiBsZXQgYWRkX3dvcCB0IHR5IHBhdGggPSB0LnBhdGhz
IDwtICh0eSwgcGF0aCkgOjogdC5wYXRocwotbGV0IGFkZF9vcGVyYXRpb24g
fnBlcm0gdCByZXF1ZXN0IHJlc3BvbnNlID0KK2xldCBnZXRfb3BlcmF0aW9u
cyB0ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCisKK2xldCBjaGVja19xdW90
YV9leG4gfnBlcm0gdCA9CiAJaWYgIURlZmluZS5tYXhyZXF1ZXN0cyA+PSAw
CiAJCSYmIG5vdCAoUGVybXMuQ29ubmVjdGlvbi5pc19kb20wIHBlcm0pCi0J
CSYmIExpc3QubGVuZ3RoIHQub3BlcmF0aW9ucyA+PSAhRGVmaW5lLm1heHJl
cXVlc3RzCi0JCXRoZW4gcmFpc2UgUXVvdGEuTGltaXRfcmVhY2hlZDsKKwkJ
JiYgKHQucXVvdGFfcmVhY2hlZCB8fCBMaXN0Lmxlbmd0aCB0Lm9wZXJhdGlv
bnMgPj0gIURlZmluZS5tYXhyZXF1ZXN0cykKKwkJdGhlbiBiZWdpbgorCQkJ
dC5xdW90YV9yZWFjaGVkIDwtIHRydWU7CisJCQlyYWlzZSBRdW90YS5MaW1p
dF9yZWFjaGVkOworCQllbmQKKworbGV0IGFkZF9vcGVyYXRpb24gdCByZXF1
ZXN0IHJlc3BvbnNlID0KIAl0Lm9wZXJhdGlvbnMgPC0gKHJlcXVlc3QsIHJl
c3BvbnNlKSA6OiB0Lm9wZXJhdGlvbnMKLWxldCBnZXRfb3BlcmF0aW9ucyB0
ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCiBsZXQgc2V0X3JlYWRfbG93cGF0
aCB0IHBhdGggPSB0LnJlYWRfbG93cGF0aCA8LSBnZXRfbG93ZXN0IHBhdGgg
dC5yZWFkX2xvd3BhdGgKIGxldCBzZXRfd3JpdGVfbG93cGF0aCB0IHBhdGgg
PSB0LndyaXRlX2xvd3BhdGggPC0gZ2V0X2xvd2VzdCBwYXRoIHQud3JpdGVf
bG93cGF0aAogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSA5YjFkNTc5NTU2M2FkMjMxNTVhYmM5NWIwNTMwODFmZjZlODUwZDNh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogR0MgcGFyYW1ldGVyIHR1bmluZwpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKQnkgZGVm
YXVsdCB0aGUgT0NhbWwgZ2FyYmFnZSBjb2xsZWN0b3Igd291bGQgcmV0dXJu
IG1lbW9yeSB0byB0aGUgT1Mgb25seQphZnRlciB1bnVzZWQgbWVtb3J5IGlz
IDV4IGxpdmUgbWVtb3J5LiAgVHdlYWsgdGhpcyB0byAxMjAlIGluc3RlYWQs
IHdoaWNoCndvdWxkIG1hdGNoIHRoZSBtYWpvciBHQyBzcGVlZC4KClRoaXMg
aXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTD
tnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJp
c3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+Cgpk
aWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5kZXggOTZjMTI1
YTk2OWRhLi4xYTVkMmYzNGE2NzggMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL2RlZmluZS5tbApAQCAtMjYsNiArMjYsNyBAQCBsZXQgbWF4d2F0Y2gg
PSByZWYgKDEwMCkKIGxldCBtYXh0cmFuc2FjdGlvbiA9IHJlZiAoMTApCiBs
ZXQgbWF4cmVxdWVzdHMgPSByZWYgKDEwMjQpICAgKCogbWF4aW11bSByZXF1
ZXN0cyBwZXIgdHJhbnNhY3Rpb24gKikKIAorbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKIGxl
dCBjb25mbGljdF9tYXhfaGlzdG9yeV9zZWNvbmRzID0gcmVmIDAuMDUKIGxl
dCBjb25mbGljdF9yYXRlX2xpbWl0X2lzX2FnZ3JlZ2F0ZSA9IHJlZiB0cnVl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVk
Lm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAppbmRl
eCAzNjliNTAzNmY0M2QuLjBiNjM0M2RmYzc4OSAxMDA2NDQKLS0tIGEvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCkBAIC0xMDMsNiArMTAzLDcg
QEAgbGV0IHBhcnNlX2NvbmZpZyBmaWxlbmFtZSA9CiAJCSgicXVvdGEtbWF4
c2l6ZSIsIENvbmZpZy5TZXRfaW50IFF1b3RhLm1heHNpemUpOwogCQkoInF1
b3RhLW1heHJlcXVlc3RzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHJl
cXVlc3RzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CisJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwogCQkoInBlcnNpc3RlbnQiLCBDb25maWcuU2V0X2Jvb2wgRGlz
ay5lbmFibGUpOwogCQkoInhlbnN0b3JlZC1sb2ctZmlsZSIsIENvbmZpZy5T
dHJpbmcgTG9nZ2luZy5zZXRfeGVuc3RvcmVkX2xvZ19kZXN0aW5hdGlvbik7
CkBAIC0yMjksNiArMjMwLDY3IEBAIGxldCB0b19maWxlIHN0b3JlIGNvbnMg
ZmlsZSA9CiAJICAgICAgICAoZnVuICgpIC0+IGNsb3NlX291dCBjaGFubmVs
KQogZW5kCiAKKygqCisJQnkgZGVmYXVsdCBPQ2FtbCdzIEdDIG9ubHkgcmV0
dXJucyBtZW1vcnkgdG8gdGhlIE9TIHdoZW4gaXQgZXhjZWVkcyBhCisJY29u
ZmlndXJhYmxlICdtYXggb3ZlcmhlYWQnIHNldHRpbmcuCisJVGhlIGRlZmF1
bHQgaXMgNTAwJSwgdGhhdCBpcyA1LzZ0aCBvZiB0aGUgT0NhbWwgaGVhcCBu
ZWVkcyB0byBiZSBmcmVlCisJYW5kIG9ubHkgMS82dGggbGl2ZSBmb3IgYSBj
b21wYWN0aW9uIHRvIGJlIHRyaWdnZXJyZWQgdGhhdCB3b3VsZAorCXJlbGVh
c2UgbWVtb3J5IGJhY2sgdG8gdGhlIE9TLgorCUlmIHRoZSBsaW1pdCBpcyBu
b3QgaGl0IHRoZW4gdGhlIE9DYW1sIHByb2Nlc3MgY2FuIHJldXNlIHRoYXQg
bWVtb3J5CisJZm9yIGl0cyBvd24gcHVycG9zZXMsIGJ1dCBvdGhlciBwcm9j
ZXNzZXMgd29uJ3QgYmUgYWJsZSB0byB1c2UgaXQuCisKKwlUaGVyZSBpcyBh
bHNvIGEgJ3NwYWNlIG92ZXJoZWFkJyBzZXR0aW5nIHRoYXQgY29udHJvbHMg
aG93IG11Y2ggd29yaworCWVhY2ggbWFqb3IgR0Mgc2xpY2UgZG9lcywgYW5k
IGJ5IGRlZmF1bHQgYWltcyBhdCBoYXZpbmcgbm8gbW9yZSB0aGFuCisJODAl
IG9yIDEyMCUgKGRlcGVuZGluZyBvbiB2ZXJzaW9uKSBnYXJiYWdlIHZhbHVl
cyBjb21wYXJlZCB0byBsaXZlCisJdmFsdWVzLgorCVRoaXMgZG9lc24ndCBo
YXZlIGFzIG11Y2ggcmVsZXZhbmNlIHRvIG1lbW9yeSByZXR1cm5lZCB0byB0
aGUgT1MgYXMKKwlsb25nIGFzIHNwYWNlX292ZXJoZWFkIDw9IG1heF9vdmVy
aGVhZCwgYmVjYXVzZSBjb21wYWN0aW9uIGlzIG9ubHkKKwl0cmlnZ2VycmVk
IGF0IHRoZSBlbmQgb2YgbWFqb3IgR0MgY3ljbGVzLgorCisJVGhlIGRlZmF1
bHRzIGFyZSB0b28gbGFyZ2Ugb25jZSB0aGUgcHJvZ3JhbSBzdGFydHMgdXNp
bmcgfjEwME1pQiBvZgorCW1lbW9yeSwgYXQgd2hpY2ggcG9pbnQgfjUwME1p
QiB3b3VsZCBiZSB1bmF2YWlsYWJsZSB0byBvdGhlciBwcm9jZXNzZXMKKwko
d2hpY2ggd291bGQgYmUgZmluZSBpZiB0aGlzIHdhcyB0aGUgbWFpbiBwcm9j
ZXNzIGluIHRoaXMgVk0sIGJ1dCBpdCBpcworCW5vdCkuCisKKwlNYXggb3Zl
cmhlYWQgY2FuIGFsc28gYmUgc2V0IHRvIDAsIGhvd2V2ZXIgdGhpcyBpcyBm
b3IgdGVzdGluZyBwdXJwb3NlcworCW9ubHkgKHNldHRpbmcgaXQgbG93ZXIg
dGhhbiAnc3BhY2Ugb3ZlcmhlYWQnIHdvdWxkbid0IGhlbHAgYmVjYXVzZSB0
aGUKKwltYWpvciBHQyB3b3VsZG4ndCBydW4gZmFzdCBlbm91Z2gsIGFuZCBj
b21wYWN0aW9uIGRvZXMgaGF2ZSBhCisJcGVyZm9ybWFuY2UgY29zdDogd2Ug
Y2FuIG9ubHkgY29tcGFjdCBjb250aWd1b3VzIHJlZ2lvbnMsIHNvIG1lbW9y
eSBoYXMKKwl0byBiZSBtb3ZlZCBhcm91bmQpLgorCisJTWF4IG92ZXJoZWFk
IGNvbnRyb2xzIGhvdyBvZnRlbiB0aGUgaGVhcCBpcyBjb21wYWN0ZWQsIHdo
aWNoIGlzIHVzZWZ1bAorCWlmIHRoZXJlIGFyZSBidXJzdCBvZiBhY3Rpdml0
eSBmb2xsb3dlZCBieSBsb25nIHBlcmlvZHMgb2YgaWRsZSBzdGF0ZSwKKwlv
ciBpZiBhIGRvbWFpbiBxdWl0cywgZXRjLiBDb21wYWN0aW9uIHJldHVybnMg
bWVtb3J5IHRvIHRoZSBPUy4KKworCXdhc3RlZCA9IGxpdmUgKiBzcGFjZV9v
dmVyaGVhZCAvIDEwMAorCisJRm9yIGdsb2JhbGx5IG92ZXJyaWRpbmcgdGhl
IEdDIHNldHRpbmdzIG9uZSBjYW4gdXNlIE9DQU1MUlVOUEFSQU0sCisJaG93
ZXZlciB3ZSBwcm92aWRlIGEgY29uZmlnIGZpbGUgb3ZlcnJpZGUgdG8gYmUg
Y29uc2lzdGVudCB3aXRoIG90aGVyCisJb3hlbnN0b3JlZCBzZXR0aW5ncy4K
KworCU9uZSBtaWdodCB3YW50IHRvIGR5bmFtaWNhbGx5IGFkanVzdCB0aGUg
b3ZlcmhlYWQgc2V0dGluZyBiYXNlZCBvbiB1c2VkCisJbWVtb3J5LCBpLmUu
IHRvIHVzZSBhIGZpeGVkIHVwcGVyIGJvdW5kIGluIGJ5dGVzLCBub3QgcGVy
Y2VudGFnZS4gSG93ZXZlcgorCW1lYXN1cmVtZW50cyBzaG93IHRoYXQgc3Vj
aCBhZGp1c3RtZW50cyBpbmNyZWFzZSBHQyBvdmVyaGVhZCBtYXNzaXZlbHks
CisJd2hpbGUgc3RpbGwgbm90IGd1YXJhbnRlZWluZyB0aGF0IG1lbW9yeSBp
cyByZXR1cm5lZCBhbnkgbW9yZSBxdWlja2x5CisJdGhhbiB3aXRoIGEgcGVy
Y2VudGFnZSBiYXNlZCBzZXR0aW5nLgorCisJVGhlIGFsbG9jYXRpb24gcG9s
aWN5IGNvdWxkIGFsc28gYmUgdHdlYWtlZCwgZS5nLiBmaXJzdCBmaXQgd291
bGQgcmVkdWNlCisJZnJhZ21lbnRhdGlvbiBhbmQgdGh1cyBtZW1vcnkgdXNh
Z2UsIGJ1dCB0aGUgZG9jdW1lbnRhdGlvbiB3YXJucyB0aGF0IGl0CisJY2Fu
IGJlIHNlbnNpYmx5IHNsb3dlciwgYW5kIGluZGVlZCBvbmUgb2Ygb3VyIG93
biB0ZXN0Y2FzZXMgY2FuIHRyaWdnZXIKKwlzdWNoIGEgY29ybmVyIGNhc2Ug
d2hlcmUgaXQgaXMgbXVsdGlwbGUgdGltZXMgc2xvd2VyLCBzbyBpdCBpcyBi
ZXN0IHRvIGtlZXAKKwl0aGUgZGVmYXVsdCBhbGxvY2F0aW9uIHBvbGljeSAo
bmV4dC1maXQvYmVzdC1maXQgZGVwZW5kaW5nIG9uIHZlcnNpb24pLgorCisJ
VGhlcmUgYXJlIG90aGVyIHR3ZWFrcyB0aGF0IGNhbiBiZSBhdHRlbXB0ZWQg
aW4gdGhlIGZ1dHVyZSwgZS5nLiBzZXR0aW5nCisJJ3VsaW1pdCAtdicgdG8g
NzUlIG9mIFJBTSwgaG93ZXZlciBnZXR0aW5nIHRoZSBrZXJuZWwgdG8gYWN0
dWFsbHkgcmV0dXJuCisJTlVMTCBmcm9tIGFsbG9jYXRpb25zIGlzIGRpZmZp
Y3VsdCBldmVuIHdpdGggdGhhdCBzZXR0aW5nLCBhbmQgd2l0aG91dCBhCisJ
TlVMTCB0aGUgZW1lcmdlbmN5IEdDIHdvbid0IGJlIHRyaWdnZXJyZWQuCisJ
UGVyaGFwcyBjZ3JvdXAgbGltaXRzIGNvdWxkIGhlbHAsIGJ1dCBmb3Igbm93
IHR3ZWFrIHRoZSBzYWZlc3Qgb25seS4KKyopCisKK2xldCB0d2Vha19nYyAo
KSA9CisJR2Muc2V0IHsgKEdjLmdldCAoKSkgd2l0aCBHYy5tYXhfb3Zlcmhl
YWQgPSAhRGVmaW5lLmdjX21heF9vdmVyaGVhZCB9CisKKwogbGV0IF8gPQog
CWxldCBjZiA9IGRvX2FyZ3YgaW4KIAlsZXQgcGlkZmlsZSA9CkBAIC0yMzgs
NiArMzAwLDggQEAgbGV0IF8gPQogCQkJZGVmYXVsdF9waWRmaWxlCiAJCWlu
CiAKKwl0d2Vha19nYyAoKTsKKwogCSh0cnkKIAkJVW5peGV4dC5ta2Rpcl9y
ZWMgKEZpbGVuYW1lLmRpcm5hbWUgcGlkZmlsZSkgMG83NTUKIAl3aXRoIF8g
LT4K

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSA3NmZkMjk0YzkzNGEzMjRhNjYxMjUwZjU3ZTI2MDJlY2E5NjNjNDlk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogRnJpLCAyOSBKdWwgMjAyMiAxODo1MzoyOSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC9saWJzL3hiOiBoaWRlIHR5cGUgb2YgWGIudApN
SU1FLVZlcnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNo
YXJzZXQ9VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoK
SGlkaW5nIHRoZSB0eXBlIHdpbGwgbWFrZSBpdCBlYXNpZXIgdG8gY2hhbmdl
IHRoZSBpbXBsZW1lbnRhdGlvbgppbiB0aGUgZnV0dXJlIHdpdGhvdXQgYnJl
YWtpbmcgY29kZSB0aGF0IHJlbGllcyBvbiBpdC4KCk5vIGZ1bmN0aW9uYWwg
Y2hhbmdlLgoKU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KKGNoZXJyeSBwaWNrZWQg
ZnJvbSBjb21taXQgN2FkZTMwYTE0NTE3MzRkMDQxMzYzYzc1MGE2NWQzMjJl
MjViNDdiYSkKClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94
Yi5tbCBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwKaW5kZXggMTA0ZDMx
OWQ3NzQ3Li44NDA0ZGRkOGE2ODIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L2xpYnMveGIveGIubWwKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5t
bApAQCAtMTk2LDYgKzE5Niw5IEBAIGxldCBwZWVrX291dHB1dCBjb24gPSBR
dWV1ZS5wZWVrIGNvbi5wa3Rfb3V0CiBsZXQgaW5wdXRfbGVuIGNvbiA9IFF1
ZXVlLmxlbmd0aCBjb24ucGt0X2luCiBsZXQgaGFzX2luX3BhY2tldCBjb24g
PSBRdWV1ZS5sZW5ndGggY29uLnBrdF9pbiA+IDAKIGxldCBnZXRfaW5fcGFj
a2V0IGNvbiA9IFF1ZXVlLnBvcCBjb24ucGt0X2luCitsZXQgaGFzX3BhcnRp
YWxfaW5wdXQgY29uID0gbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAorCXwg
SGF2ZUhkciBfIC0+IHRydWUKKwl8IE5vSGRyIChuLCBfKSAtPiBuIDwgUGFy
dGlhbC5oZWFkZXJfc2l6ZSAoKQogbGV0IGhhc19tb3JlX2lucHV0IGNvbiA9
CiAJbWF0Y2ggY29uLmJhY2tlbmQgd2l0aAogCXwgRmQgXyAgICAgICAgIC0+
IGZhbHNlCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDNhMDBkYTZj
ZGRjMS4uNzk0ZTM1YmIzNDNlIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNjYsMTMgKzY2LDcgQEAgdHlwZSBiYWNrZW5kX21tYXAgPSB7CiB0
eXBlIGJhY2tlbmRfZmQgPSB7IGZkIDogVW5peC5maWxlX2Rlc2NyOyB9CiB0
eXBlIGJhY2tlbmQgPSBGZCBvZiBiYWNrZW5kX2ZkIHwgWGVubW1hcCBvZiBi
YWNrZW5kX21tYXAKIHR5cGUgcGFydGlhbF9idWYgPSBIYXZlSGRyIG9mIFBh
cnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMKLXR5cGUgdCA9IHsK
LSAgYmFja2VuZCA6IGJhY2tlbmQ7Ci0gIHBrdF9pbiA6IFBhY2tldC50IFF1
ZXVlLnQ7Ci0gIHBrdF9vdXQgOiBQYWNrZXQudCBRdWV1ZS50OwotICBtdXRh
YmxlIHBhcnRpYWxfaW4gOiBwYXJ0aWFsX2J1ZjsKLSAgbXV0YWJsZSBwYXJ0
aWFsX291dCA6IHN0cmluZzsKLX0KK3R5cGUgdAogdmFsIGluaXRfcGFydGlh
bF9pbiA6IHVuaXQgLT4gcGFydGlhbF9idWYKIHZhbCByZWNvbm5lY3QgOiB0
IC0+IHVuaXQKIHZhbCBxdWV1ZSA6IHQgLT4gUGFja2V0LnQgLT4gdW5pdApA
QCAtOTcsNiArOTEsNyBAQCB2YWwgaGFzX291dHB1dCA6IHQgLT4gYm9vbAog
dmFsIHBlZWtfb3V0cHV0IDogdCAtPiBQYWNrZXQudAogdmFsIGlucHV0X2xl
biA6IHQgLT4gaW50CiB2YWwgaGFzX2luX3BhY2tldCA6IHQgLT4gYm9vbAor
dmFsIGhhc19wYXJ0aWFsX2lucHV0IDogdCAtPiBib29sCiB2YWwgZ2V0X2lu
X3BhY2tldCA6IHQgLT4gUGFja2V0LnQKIHZhbCBoYXNfbW9yZV9pbnB1dCA6
IHQgLT4gYm9vbAogdmFsIGlzX3NlbGVjdGFibGUgOiB0IC0+IGJvb2wKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1s
IGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb24ubWwKaW5kZXgg
ZGFmOGQ4MDRmN2VmLi43MGM0MzQ4NTUyOGMgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCkBAIC0xMjUsOSArMTI1LDcg
QEAgbGV0IGdldF9wZXJtIGNvbiA9CiBsZXQgc2V0X3RhcmdldCBjb24gdGFy
Z2V0X2RvbWlkID0KIAljb24ucGVybSA8LSBQZXJtcy5Db25uZWN0aW9uLnNl
dF90YXJnZXQgKGdldF9wZXJtIGNvbikgfnBlcm1zOltQZXJtcy5SRUFEOyBQ
ZXJtcy5XUklURV0gdGFyZ2V0X2RvbWlkCiAKLWxldCBpc19iYWNrZW5kX21t
YXAgY29uID0gbWF0Y2ggY29uLnhiLlhlbmJ1cy5YYi5iYWNrZW5kIHdpdGgK
LQl8IFhlbmJ1cy5YYi5YZW5tbWFwIF8gLT4gdHJ1ZQotCXwgXyAtPiBmYWxz
ZQorbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBYZW5idXMuWGIuaXNfbW1h
cCBjb24ueGIKIAogbGV0IHNlbmRfcmVwbHkgY29uIHRpZCByaWQgdHkgZGF0
YSA9CiAJaWYgKFN0cmluZy5sZW5ndGggZGF0YSkgPiB4ZW5zdG9yZV9wYXls
b2FkX21heCAmJiAoaXNfYmFja2VuZF9tbWFwIGNvbikgdGhlbgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSA3NjkyOTM4MGQ5MTAxYTcwN2E0YTUzMjdkMjQwOWJjMWZmNTkwMGY1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogQ2hhbmdlIFhiLmlucHV0IHRvIHJldHVybiBQ
YWNrZXQudCBvcHRpb24KTUlNRS1WZXJzaW9uOiAxLjAKQ29udGVudC1UeXBl
OiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRlbnQtVHJhbnNmZXIt
RW5jb2Rpbmc6IDhiaXQKClRoZSBxdWV1ZSBoZXJlIHdvdWxkIG9ubHkgZXZl
ciBob2xkIGF0IG1vc3Qgb25lIGVsZW1lbnQuICBUaGlzIHdpbGwgc2ltcGxp
ZnkKZm9sbG93LXVwIHBhdGNoZXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
Ni4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24u
Y29tPgpTaWduZWQtb2ZmLWJ5OiBFZHdpbiBUw7Zyw7ZrIDxlZHZpbi50b3Jv
a0BjaXRyaXguY29tPgpBY2tlZC1ieTogQ2hyaXN0aWFuIExpbmRpZyA8Y2hy
aXN0aWFuLmxpbmRpZ0BjaXRyaXguY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL2xpYnMveGIveGIubWwgYi90b29scy9vY2FtbC9saWJzL3hiL3hi
Lm1sCmluZGV4IDg0MDRkZGQ4YTY4Mi4uMTY1ZmQ0YTFlZGY0IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1sCisrKyBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKQEAgLTQ1LDcgKzQ1LDYgQEAgdHlwZSBwYXJ0
aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlhbC5wa3QgfCBOb0hkciBvZiBp
bnQgKiBieXRlcwogdHlwZSB0ID0KIHsKIAliYWNrZW5kOiBiYWNrZW5kOwot
CXBrdF9pbjogUGFja2V0LnQgUXVldWUudDsKIAlwa3Rfb3V0OiBQYWNrZXQu
dCBRdWV1ZS50OwogCW11dGFibGUgcGFydGlhbF9pbjogcGFydGlhbF9idWY7
CiAJbXV0YWJsZSBwYXJ0aWFsX291dDogc3RyaW5nOwpAQCAtNjIsNyArNjEs
NiBAQCBsZXQgcmVjb25uZWN0IHQgPSBtYXRjaCB0LmJhY2tlbmQgd2l0aAog
CQlYc19yaW5nLmNsb3NlIGJhY2tlbmQubW1hcDsKIAkJYmFja2VuZC5ldmVu
dGNobl9ub3RpZnkgKCk7CiAJCSgqIENsZWFyIG91ciBvbGQgY29ubmVjdGlv
biBzdGF0ZSAqKQotCQlRdWV1ZS5jbGVhciB0LnBrdF9pbjsKIAkJUXVldWUu
Y2xlYXIgdC5wa3Rfb3V0OwogCQl0LnBhcnRpYWxfaW4gPC0gaW5pdF9wYXJ0
aWFsX2luICgpOwogCQl0LnBhcnRpYWxfb3V0IDwtICIiCkBAIC0xMjQsNyAr
MTIyLDYgQEAgbGV0IG91dHB1dCBjb24gPQogCiAoKiBOQjogY2FuIHRocm93
IFJlY29ubmVjdCAqKQogbGV0IGlucHV0IGNvbiA9Ci0JbGV0IG5ld3BhY2tl
dCA9IHJlZiBmYWxzZSBpbgogCWxldCB0b19yZWFkID0KIAkJbWF0Y2ggY29u
LnBhcnRpYWxfaW4gd2l0aAogCQl8IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4g
UGFydGlhbC50b19jb21wbGV0ZSBwYXJ0aWFsX3BrdApAQCAtMTQzLDIxICsx
NDAsMTkgQEAgbGV0IGlucHV0IGNvbiA9CiAJCWlmIFBhcnRpYWwudG9fY29t
cGxldGUgcGFydGlhbF9wa3QgPSAwIHRoZW4gKAogCQkJbGV0IHBrdCA9IFBh
Y2tldC5vZl9wYXJ0aWFscGt0IHBhcnRpYWxfcGt0IGluCiAJCQljb24ucGFy
dGlhbF9pbiA8LSBpbml0X3BhcnRpYWxfaW4gKCk7Ci0JCQlRdWV1ZS5wdXNo
IHBrdCBjb24ucGt0X2luOwotCQkJbmV3cGFja2V0IDo9IHRydWUKLQkJKQor
CQkJU29tZSBwa3QKKwkJKSBlbHNlIE5vbmUKIAl8IE5vSGRyIChpLCBidWYp
ICAgICAgLT4KIAkJKCogd2UgY29tcGxldGUgdGhlIHBhcnRpYWwgaGVhZGVy
ICopCiAJCWlmIHN6ID4gMCB0aGVuCiAJCQlCeXRlcy5ibGl0IGIgMCBidWYg
KFBhcnRpYWwuaGVhZGVyX3NpemUgKCkgLSBpKSBzejsKIAkJY29uLnBhcnRp
YWxfaW4gPC0gaWYgc3ogPSBpIHRoZW4KLQkJCUhhdmVIZHIgKFBhcnRpYWwu
b2Zfc3RyaW5nIChCeXRlcy50b19zdHJpbmcgYnVmKSkgZWxzZSBOb0hkciAo
aSAtIHN6LCBidWYpCi0JKTsKLQkhbmV3cGFja2V0CisJCQlIYXZlSGRyIChQ
YXJ0aWFsLm9mX3N0cmluZyAoQnl0ZXMudG9fc3RyaW5nIGJ1ZikpIGVsc2Ug
Tm9IZHIgKGkgLSBzeiwgYnVmKTsKKwkJTm9uZQorCSkKIAogbGV0IG5ld2Nv
biBiYWNrZW5kID0gewogCWJhY2tlbmQgPSBiYWNrZW5kOwotCXBrdF9pbiA9
IFF1ZXVlLmNyZWF0ZSAoKTsKIAlwa3Rfb3V0ID0gUXVldWUuY3JlYXRlICgp
OwogCXBhcnRpYWxfaW4gPSBpbml0X3BhcnRpYWxfaW4gKCk7CiAJcGFydGlh
bF9vdXQgPSAiIjsKQEAgLTE5Myw5ICsxODgsNiBAQCBsZXQgaGFzX291dHB1
dCBjb24gPSBoYXNfbmV3X291dHB1dCBjb24gfHwgaGFzX29sZF9vdXRwdXQg
Y29uCiAKIGxldCBwZWVrX291dHB1dCBjb24gPSBRdWV1ZS5wZWVrIGNvbi5w
a3Rfb3V0CiAKLWxldCBpbnB1dF9sZW4gY29uID0gUXVldWUubGVuZ3RoIGNv
bi5wa3RfaW4KLWxldCBoYXNfaW5fcGFja2V0IGNvbiA9IFF1ZXVlLmxlbmd0
aCBjb24ucGt0X2luID4gMAotbGV0IGdldF9pbl9wYWNrZXQgY29uID0gUXVl
dWUucG9wIGNvbi5wa3RfaW4KIGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24g
PSBtYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCiAJfCBIYXZlSGRyIF8gLT4g
dHJ1ZQogCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBQYXJ0aWFsLmhlYWRlcl9z
aXplICgpCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDc5NGUzNWJi
MzQzZS4uOTFjNjgyMTYyY2VhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNzcsNyArNzcsNyBAQCB2YWwgd3JpdGVfZmQgOiBiYWNrZW5kX2Zk
IC0+ICdhIC0+IHN0cmluZyAtPiBpbnQgLT4gaW50CiB2YWwgd3JpdGVfbW1h
cCA6IGJhY2tlbmRfbW1hcCAtPiAnYSAtPiBzdHJpbmcgLT4gaW50IC0+IGlu
dAogdmFsIHdyaXRlIDogdCAtPiBzdHJpbmcgLT4gaW50IC0+IGludAogdmFs
IG91dHB1dCA6IHQgLT4gYm9vbAotdmFsIGlucHV0IDogdCAtPiBib29sCit2
YWwgaW5wdXQgOiB0IC0+IFBhY2tldC50IG9wdGlvbgogdmFsIG5ld2NvbiA6
IGJhY2tlbmQgLT4gdAogdmFsIG9wZW5fZmQgOiBVbml4LmZpbGVfZGVzY3Ig
LT4gdAogdmFsIG9wZW5fbW1hcCA6IFhlbm1tYXAubW1hcF9pbnRlcmZhY2Ug
LT4gKHVuaXQgLT4gdW5pdCkgLT4gdApAQCAtODksMTAgKzg5LDcgQEAgdmFs
IGhhc19uZXdfb3V0cHV0IDogdCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRw
dXQgOiB0IC0+IGJvb2wKIHZhbCBoYXNfb3V0cHV0IDogdCAtPiBib29sCiB2
YWwgcGVla19vdXRwdXQgOiB0IC0+IFBhY2tldC50Ci12YWwgaW5wdXRfbGVu
IDogdCAtPiBpbnQKLXZhbCBoYXNfaW5fcGFja2V0IDogdCAtPiBib29sCiB2
YWwgaGFzX3BhcnRpYWxfaW5wdXQgOiB0IC0+IGJvb2wKLXZhbCBnZXRfaW5f
cGFja2V0IDogdCAtPiBQYWNrZXQudAogdmFsIGhhc19tb3JlX2lucHV0IDog
dCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4gYm9vbAogdmFs
IGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sIGIvdG9vbHMvb2NhbWwvbGli
cy94cy94c3Jhdy5tbAppbmRleCBkOTgyZmIyNGRiYjEuLjQ1MWY4YjM4ZGJj
YyAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94cy94c3Jhdy5tbAor
KysgYi90b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sCkBAIC05NCwyNiAr
OTQsMTggQEAgbGV0IHBrdF9zZW5kIGNvbiA9CiAJZG9uZQogCiAoKiByZWNl
aXZlIG9uZSBwYWNrZXQgLSBjYW4gc2xlZXAgKikKLWxldCBwa3RfcmVjdiBj
b24gPQotCWxldCB3b3JrZG9uZSA9IHJlZiBmYWxzZSBpbgotCXdoaWxlIG5v
dCAhd29ya2RvbmUKLQlkbwotCQl3b3JrZG9uZSA6PSBYYi5pbnB1dCBjb24u
eGIKLQlkb25lOwotCVhiLmdldF9pbl9wYWNrZXQgY29uLnhiCitsZXQgcmVj
IHBrdF9yZWN2IGNvbiA9CisJbWF0Y2ggWGIuaW5wdXQgY29uLnhiIHdpdGgK
Kwl8IFNvbWUgcGFja2V0IC0+IHBhY2tldAorCXwgTm9uZSAtPiBwa3RfcmVj
diBjb24KIAogbGV0IHBrdF9yZWN2X3RpbWVvdXQgY29uIHRpbWVvdXQgPQog
CWxldCBmZCA9IFhiLmdldF9mZCBjb24ueGIgaW4KIAlsZXQgciwgXywgXyA9
IFVuaXguc2VsZWN0IFsgZmQgXSBbXSBbXSB0aW1lb3V0IGluCiAJaWYgciA9
IFtdIHRoZW4KIAkJdHJ1ZSwgTm9uZQotCWVsc2UgKAotCQlsZXQgd29ya2Rv
bmUgPSBYYi5pbnB1dCBjb24ueGIgaW4KLQkJaWYgd29ya2RvbmUgdGhlbgot
CQkJZmFsc2UsIChTb21lIChYYi5nZXRfaW5fcGFja2V0IGNvbi54YikpCi0J
CWVsc2UKLQkJCWZhbHNlLCBOb25lCi0JKQorCWVsc2UKKwkJZmFsc2UsIFhi
LmlucHV0IGNvbi54YgogCiBsZXQgcXVldWVfd2F0Y2hldmVudCBjb24gZGF0
YSA9CiAJbGV0IGxzID0gc3BsaXRfc3RyaW5nIH5saW1pdDoyICdcMDAwJyBk
YXRhIGluCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbi5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCmluZGV4IDcwYzQzNDg1NTI4Yy4uYWNlMmFhNWI0ZjUzIDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbAorKysg
Yi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbApAQCAtMjc3
LDggKzI3Nyw2IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAJ
SGFzaHRibC5maW5kIGNvbi50cmFuc2FjdGlvbnMgdGlkCiAKIGxldCBkb19p
bnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCi1sZXQgaGFzX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNvbi54YgotbGV0
IHBvcF9pbiBjb24gPSBYZW5idXMuWGIuZ2V0X2luX3BhY2tldCBjb24ueGIK
IGxldCBoYXNfbW9yZV9pbnB1dCBjb24gPSBYZW5idXMuWGIuaGFzX21vcmVf
aW5wdXQgY29uLnhiCiAKIGxldCBoYXNfb3V0cHV0IGNvbiA9IFhlbmJ1cy5Y
Yi5oYXNfb3V0cHV0IGNvbi54YgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwv
eGVuc3RvcmVkL3Byb2Nlc3MubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAppbmRleCAwZGYzZGY0MDFkYjYuLmE3MjgxMGQwNmY0MyAx
MDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Byb2Nlc3MubWwK
KysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Byb2Nlc3MubWwKQEAgLTU2
OSwxNiArNTY5LDE3IEBAIGxldCBkb19pbnB1dCBzdG9yZSBjb25zIGRvbXMg
Y29uID0KIAkJCWluZm8gIiVzIHJlcXVlc3RzIGEgcmVjb25uZWN0IiAoQ29u
bmVjdGlvbi5nZXRfZG9tc3RyIGNvbik7CiAJCQlIaXN0b3J5LnJlY29ubmVj
dCBjb247CiAJCQlpbmZvICIlcyByZWNvbm5lY3Rpb24gY29tcGxldGUiIChD
b25uZWN0aW9uLmdldF9kb21zdHIgY29uKTsKLQkJCWZhbHNlCisJCQlOb25l
CiAJCXwgRmFpbHVyZSBleHAgLT4KIAkJCWVycm9yICJjYXVnaHQgZXhjZXB0
aW9uICVzIiBleHA7CiAJCQllcnJvciAiZ290IGEgYmFkIGNsaWVudCAlcyIg
KHNwcmludGYgIiUtOHMiIChDb25uZWN0aW9uLmdldF9kb21zdHIgY29uKSk7
CiAJCQlDb25uZWN0aW9uLm1hcmtfYXNfYmFkIGNvbjsKLQkJCWZhbHNlCisJ
CQlOb25lCiAJaW4KIAotCWlmIG5ld3BhY2tldCB0aGVuICgKLQkJbGV0IHBh
Y2tldCA9IENvbm5lY3Rpb24ucG9wX2luIGNvbiBpbgorCW1hdGNoIG5ld3Bh
Y2tldCB3aXRoCisJfCBOb25lIC0+ICgpCisJfCBTb21lIHBhY2tldCAtPgog
CQlsZXQgdGlkLCByaWQsIHR5LCBkYXRhID0gWGVuYnVzLlhiLlBhY2tldC51
bnBhY2sgcGFja2V0IGluCiAJCWxldCByZXEgPSB7UGFja2V0LnRpZD10aWQ7
IFBhY2tldC5yaWQ9cmlkOyBQYWNrZXQudHk9dHk7IFBhY2tldC5kYXRhPWRh
dGF9IGluCiAKQEAgLTU4OCw4ICs1ODksNyBAQCBsZXQgZG9faW5wdXQgc3Rv
cmUgY29ucyBkb21zIGNvbiA9CiAJCSAgICAgICAgIChYZW5idXMuWGIuT3Au
dG9fc3RyaW5nIHR5KSAoc2FuaXRpemVfZGF0YSBkYXRhKTsgKikKIAkJcHJv
Y2Vzc19wYWNrZXQgfnN0b3JlIH5jb25zIH5kb21zIH5jb24gfnJlcTsKIAkJ
d3JpdGVfYWNjZXNzX2xvZyB+dHkgfnRpZCB+Y29uOihDb25uZWN0aW9uLmdl
dF9kb21zdHIgY29uKSB+ZGF0YTsKLQkJQ29ubmVjdGlvbi5pbmNyX29wcyBj
b247Ci0JKQorCQlDb25uZWN0aW9uLmluY3Jfb3BzIGNvbgogCiBsZXQgZG9f
b3V0cHV0IF9zdG9yZSBfY29ucyBfZG9tcyBjb24gPQogCWlmIENvbm5lY3Rp
b24uaGFzX291dHB1dCBjb24gdGhlbiAoCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSBmYjU2MTA5YTcwMDRkZTkyOWM2NTk2ZTEyNGViYjBmMTYyZmI1ODU2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94YjogQWRkIEJvdW5kZWRRdWV1ZQpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKRW5zdXJl
cyB3ZSBjYW5ub3Qgc3RvcmUgbW9yZSB0aGFuIFtjYXBhY2l0eV0gZWxlbWVu
dHMgaW4gYSBbUXVldWVdLiAgUmVwbGFjaW5nCmFsbCBRdWV1ZSB3aXRoIHRo
aXMgbW9kdWxlIHdpbGwgdGhlbiBlbnN1cmUgYXQgY29tcGlsZSB0aW1lIHRo
YXQgYWxsIFF1ZXVlcwphcmUgY29ycmVjdGx5IGJvdW5kIGNoZWNrZWQuCgpF
YWNoIGVsZW1lbnQgaW4gdGhlIHF1ZXVlIGhhcyBhIGNsYXNzIHdpdGggaXRz
IG93biBsaW1pdHMuICBUaGlzLCBpbiBhCnN1YnNlcXVlbnQgY2hhbmdlLCB3
aWxsIGVuc3VyZSB0aGF0IGNvbW1hbmQgcmVzcG9uc2VzIGNhbiBwcm9jZWVk
IGR1cmluZyBhCmZsb29kIG9mIHdhdGNoIGV2ZW50cy4KCk5vIGZ1bmN0aW9u
YWwgY2hhbmdlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRl
ZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVk
LW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcgPGNocmlzdGlhbi5saW5k
aWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJz
L3hiL3hiLm1sIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbAppbmRleCAx
NjVmZDRhMWVkZjQuLjQxOTdhMzg4OGE2OCAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwvbGlicy94Yi94Yi5tbAorKysgYi90b29scy9vY2FtbC9saWJzL3hi
L3hiLm1sCkBAIC0xNyw2ICsxNyw5OCBAQAogbW9kdWxlIE9wID0gc3RydWN0
IGluY2x1ZGUgT3AgZW5kCiBtb2R1bGUgUGFja2V0ID0gc3RydWN0IGluY2x1
ZGUgUGFja2V0IGVuZAogCittb2R1bGUgQm91bmRlZFF1ZXVlIDogc2lnCisJ
dHlwZSAoJ2EsICdiKSB0CisKKwkoKiogW2NyZWF0ZSB+Y2FwYWNpdHkgfmNs
YXNzaWZ5IH5saW1pdF0gY3JlYXRlcyBhIHF1ZXVlIHdpdGggbWF4aW11bSBb
Y2FwYWNpdHldIGVsZW1lbnRzLgorCSAgICBUaGlzIGlzIGJ1cnN0IGNhcGFj
aXR5LCBlYWNoIGVsZW1lbnQgaXMgZnVydGhlciBjbGFzc2lmaWVkIGFjY29y
ZGluZyB0byBbY2xhc3NpZnldLAorCSAgICBhbmQgZWFjaCBjbGFzcyBjYW4g
aGF2ZSBpdHMgb3duIFtsaW1pdF0uCisJICAgIFtjYXBhY2l0eV0gaXMgZW5m
b3JjZWQgYXMgYW4gb3ZlcmFsbCBsaW1pdC4KKwkgICAgVGhlIFtsaW1pdF0g
Y2FuIGJlIGR5bmFtaWMsIGFuZCBjYW4gYmUgc21hbGxlciB0aGFuIHRoZSBu
dW1iZXIgb2YgZWxlbWVudHMgYWxyZWFkeSBxdWV1ZWQgb2YgdGhhdCBjbGFz
cywKKwkgICAgaW4gd2hpY2ggY2FzZSB0aG9zZSBlbGVtZW50cyBhcmUgY29u
c2lkZXJlZCB0byB1c2UgImJ1cnN0IGNhcGFjaXR5Ii4KKwkgICopCisJdmFs
IGNyZWF0ZTogY2FwYWNpdHk6aW50IC0+IGNsYXNzaWZ5OignYSAtPiAnYikg
LT4gbGltaXQ6KCdiIC0+IGludCkgLT4gKCdhLCAnYikgdAorCisJKCoqIFtj
bGVhciBxXSBkaXNjYXJkcyBhbGwgZWxlbWVudHMgZnJvbSBbcV0gKikKKwl2
YWwgY2xlYXI6ICgnYSwgJ2IpIHQgLT4gdW5pdAorCisJKCoqIFtjYW5fcHVz
aCBxXSB3aGVuIFtsZW5ndGggcSA8IGNhcGFjaXR5XS4JKikKKwl2YWwgY2Fu
X3B1c2g6ICgnYSwgJ2IpIHQgLT4gJ2IgLT4gYm9vbAorCisJKCoqIFtwdXNo
IGUgcV0gYWRkcyBbZV0gYXQgdGhlIGVuZCBvZiBxdWV1ZSBbcV0gaWYgW2Nh
bl9wdXNoIHFdLCBvciByZXR1cm5zIFtOb25lXS4gKikKKwl2YWwgcHVzaDog
J2EgLT4gKCdhLCAnYikgdCAtPiB1bml0IG9wdGlvbgorCisJKCoqIFtwb3Ag
cV0gcmVtb3ZlcyBhbmQgcmV0dXJucyBmaXJzdCBlbGVtZW50IGluIFtxXSwg
b3IgcmFpc2VzIFtRdWV1ZS5FbXB0eV0uICopCisJdmFsIHBvcDogKCdhLCAn
YikgdCAtPiAnYQorCisJKCoqIFtwZWVrIHFdIHJldHVybnMgdGhlIGZpcnN0
IGVsZW1lbnQgaW4gW3FdLCBvciByYWlzZXMgW1F1ZXVlLkVtcHR5XS4gICop
CisJdmFsIHBlZWsgOiAoJ2EsICdiKSB0IC0+ICdhCisKKwkoKiogW2xlbmd0
aCBxXSByZXR1cm5zIHRoZSBjdXJyZW50IG51bWJlciBvZiBlbGVtZW50cyBp
biBbcV0gKikKKwl2YWwgbGVuZ3RoOiAoJ2EsICdiKSB0IC0+IGludAorCisJ
KCoqIFtkZWJ1ZyBzdHJpbmdfb2ZfY2xhc3MgcV0gcHJpbnRzIHF1ZXVlIHVz
YWdlIHN0YXRpc3RpY3MgaW4gYW4gdW5zcGVjaWZpZWQgaW50ZXJuYWwgZm9y
bWF0LiAqKQorCXZhbCBkZWJ1ZzogKCdiIC0+IHN0cmluZykgLT4gKF8sICdi
KSB0IC0+IHN0cmluZworZW5kID0gc3RydWN0CisJdHlwZSAoJ2EsICdiKSB0
ID0KKwkJeyBxOiAnYSBRdWV1ZS50CisJCTsgY2FwYWNpdHk6IGludAorCQk7
IGNsYXNzaWZ5OiAnYSAtPiAnYgorCQk7IGxpbWl0OiAnYiAtPiBpbnQKKwkJ
OyBjbGFzc19jb3VudDogKCdiLCBpbnQpIEhhc2h0YmwudAorCQl9CisKKwls
ZXQgY3JlYXRlIH5jYXBhY2l0eSB+Y2xhc3NpZnkgfmxpbWl0ID0KKwkJeyBj
YXBhY2l0eTsgcSA9IFF1ZXVlLmNyZWF0ZSAoKTsgY2xhc3NpZnk7IGxpbWl0
OyBjbGFzc19jb3VudCA9IEhhc2h0YmwuY3JlYXRlIDMgfQorCisJbGV0IGdl
dF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uID0gdHJ5IEhhc2h0YmwuZmluZCB0
LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIHdpdGggTm90X2ZvdW5kIC0+
IDAKKworCWxldCBjYW5fcHVzaF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9u
IGNsYXNzX2NvdW50ID0KKwkJUXVldWUubGVuZ3RoIHQucSA8IHQuY2FwYWNp
dHkgJiYgY2xhc3NfY291bnQgPCB0LmxpbWl0IGNsYXNzaWZpY2F0aW9uCisK
KwlsZXQgb2sgPSBTb21lICgpCisKKwlsZXQgcHVzaCBlIHQgPQorCQlsZXQg
Y2xhc3NpZmljYXRpb24gPSB0LmNsYXNzaWZ5IGUgaW4KKwkJbGV0IGNsYXNz
X2NvdW50ID0gZ2V0X2NvdW50IHQgY2xhc3NpZmljYXRpb24gaW4KKwkJaWYg
Y2FuX3B1c2hfaW50ZXJuYWwgdCBjbGFzc2lmaWNhdGlvbiBjbGFzc19jb3Vu
dCB0aGVuIGJlZ2luCisJCQlRdWV1ZS5wdXNoIGUgdC5xOworCQkJSGFzaHRi
bC5yZXBsYWNlIHQuY2xhc3NfY291bnQgY2xhc3NpZmljYXRpb24gKGNsYXNz
X2NvdW50ICsgMSk7CisJCQlvaworCQllbmQKKwkJZWxzZQorCQkJTm9uZQor
CisJbGV0IGNhbl9wdXNoIHQgY2xhc3NpZmljYXRpb24gPQorCQljYW5fcHVz
aF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9uIEBAIGdldF9jb3VudCB0IGNs
YXNzaWZpY2F0aW9uCisKKwlsZXQgY2xlYXIgdCA9CisJCVF1ZXVlLmNsZWFy
IHQucTsKKwkJSGFzaHRibC5yZXNldCB0LmNsYXNzX2NvdW50CisKKwlsZXQg
cG9wIHQgPQorCQlsZXQgZSA9IFF1ZXVlLnBvcCB0LnEgaW4KKwkJbGV0IGNs
YXNzaWZpY2F0aW9uID0gdC5jbGFzc2lmeSBlIGluCisJCWxldCAoKSA9IG1h
dGNoIGdldF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uIC0gMSB3aXRoCisJCXwg
MCAtPiBIYXNodGJsLnJlbW92ZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0
aW9uICgqIHJlZHVjZXMgbWVtdXNhZ2UgKikKKwkJfCBuIC0+IEhhc2h0Ymwu
cmVwbGFjZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIG4KKwkJaW4K
KwkJZQorCisJbGV0IHBlZWsgdCA9IFF1ZXVlLnBlZWsgdC5xCisJbGV0IGxl
bmd0aCB0ID0gUXVldWUubGVuZ3RoIHQucQorCisJbGV0IGRlYnVnIHN0cmlu
Z19vZl9jbGFzcyB0ID0KKwkJbGV0IGIgPSBCdWZmZXIuY3JlYXRlIDEyOCBp
bgorCQlQcmludGYuYnByaW50ZiBiICJCb3VuZGVkUXVldWUgY2FwYWNpdHk6
ICVkLCB1c2VkOiB7IiB0LmNhcGFjaXR5OworCQlIYXNodGJsLml0ZXIgKGZ1
biBwYWNrZXRfY2xhc3MgY291bnQgLT4KKwkJCVByaW50Zi5icHJpbnRmIGIg
IgklczogJWQiIChzdHJpbmdfb2ZfY2xhc3MgcGFja2V0X2NsYXNzKSBjb3Vu
dAorCQkpIHQuY2xhc3NfY291bnQ7CisJCVByaW50Zi5icHJpbnRmIGIgIn0i
OworCQlCdWZmZXIuY29udGVudHMgYgorZW5kCisKKwogZXhjZXB0aW9uIEVu
ZF9vZl9maWxlCiBleGNlcHRpb24gRWFnYWluCiBleGNlcHRpb24gTm9lbnQK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSA5ZDU1YWViZGFmYzBkYzQ4NjBkYThmMDBhZDQ4NDQwNzg1MGQzNjQ3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNCArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogTGltaXQgbWF4aW11bSBpbi1mbGlnaHQgcmVx
dWVzdHMgLyBvdXRzdGFuZGluZyByZXBsaWVzCk1JTUUtVmVyc2lvbjogMS4w
CkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250
ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA4Yml0CgpJbnRyb2R1Y2UgYSBsaW1p
dCBvbiB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcGx5IHBhY2tldHMg
aW4gdGhlIHhlbmJ1cwpxdWV1ZS4gIFRoaXMgbGltaXRzIHRoZSBudW1iZXIg
b2YgaW4tZmxpZ2h0IHJlcXVlc3RzOiB3aGVuIHRoZSBvdXRwdXQgcXVldWUg
aXMKZnVsbCB3ZSdsbCBzdG9wIHByb2Nlc3NpbmcgaW5wdXRzIHVudGlsIHRo
ZSBvdXRwdXQgcXVldWUgaGFzIHJvb20gYWdhaW4uCgpUbyBhdm9pZCBhIGJ1
c3kgbG9vcCBvbiB0aGUgVW5peCBzb2NrZXQgd2Ugb25seSBhZGQgaXQgdG8g
dGhlIHdhdGNoZWQgaW5wdXQKZmlsZSBkZXNjcmlwdG9yIHNldCBpZiB3ZSdk
IGJlIGFibGUgdG8gY2FsbCBgaW5wdXRgIG9uIGl0LiAgRXZlbiB0aG91Z2gg
RG9tMAppcyB0cnVzdGVkIGFuZCBleGVtcHQgZnJvbSBxdW90YXMgYSBmbG9v
ZCBvZiBldmVudHMgbWlnaHQgY2F1c2UgYSBiYWNrbG9nCndoZXJlIGV2ZW50
cyBhcmUgcHJvZHVjZWQgZmFzdGVyIHRoYW4gZGFlbW9ucyBpbiBEb20wIGNh
biBjb25zdW1lIHRoZW0sIHdoaWNoCmNvdWxkIGxlYWQgdG8gYW4gdW5ib3Vu
ZGVkIHF1ZXVlIHNpemUgYW5kIE9PTS4KClRoZXJlZm9yZSB0aGUgeGVuYnVz
IHF1ZXVlIGxpbWl0IG11c3QgYXBwbHkgdG8gYWxsIGNvbm5lY3Rpb25zLCBE
b20wIGlzIG5vdApleGVtcHQgZnJvbSBpdCwgYWx0aG91Z2ggaWYgZXZlcnl0
aGluZyB3b3JrcyBjb3JyZWN0bHkgaXQgd2lsbCBldmVudHVhbGx5CmNhdGNo
IHVwLgoKVGhpcyBwcmV2ZW50cyBhIG1hbGljaW91cyBndWVzdCBmcm9tIHNl
bmRpbmcgbW9yZSBjb21tYW5kcyB3aGlsZSBpdCBoYXMKb3V0c3RhbmRpbmcg
d2F0Y2ggZXZlbnRzIG9yIGNvbW1hbmQgcmVwbGllcyBpbiBpdHMgaW5wdXQg
cmluZy4gIEhvd2V2ZXIgaWYgaXQKY2FuIGNhdXNlIHRoZSBnZW5lcmF0aW9u
IG9mIHdhdGNoIGV2ZW50cyBieSBvdGhlciBtZWFucyAoZS5nLiBieSBEb20w
LCBvcgphbm90aGVyIGNvb3BlcmF0aXZlIGd1ZXN0KSBhbmQgc3RvcCByZWFk
aW5nIGl0cyBvd24gcmluZyB0aGVuIHdhdGNoIGV2ZW50cwp3b3VsZCd2ZSBx
dWV1ZWQgdXAgd2l0aG91dCBsaW1pdC4KClRoZSB4ZW5zdG9yZSBwcm90b2Nv
bCBkb2Vzbid0IGhhdmUgYSBiYWNrLXByZXNzdXJlIG1lY2hhbmlzbSwgYW5k
IGRvZXNuJ3QKYWxsb3cgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzLiAgSW4gZmFj
dCwgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzIGlzIGtub3duIHRvIGJyZWFrCnNv
bWUgcGllY2VzIG9mIG5vcm1hbCBmdW5jdGlvbmFsaXR5LiAgVGhpcyBsZWF2
ZXMgbGl0dGxlIGNob2ljZSB0byBzYWZlbHkKaW1wbGVtZW50IHRoZSB4ZW5z
dG9yZSBwcm90b2NvbCB3aXRob3V0IGV4cG9zaW5nIHRoZSB4ZW5zdG9yZSBk
YWVtb24gdG8Kb3V0LW9mLW1lbW9yeSBhdHRhY2tzLgoKSW1wbGVtZW50IHRo
ZSBmaXggYXMgcGlwZXMgd2l0aCBib3VuZGVkIGJ1ZmZlcnM6CiogVXNlIGEg
Ym91bmRlZCBidWZmZXIgZm9yIHdhdGNoIGV2ZW50cwoqIFRoZSB3YXRjaCBz
dHJ1Y3R1cmUgd2lsbCBoYXZlIGEgYm91bmRlZCByZWNlaXZpbmcgcGlwZSBv
ZiB3YXRjaCBldmVudHMKKiBUaGUgc291cmNlIHdpbGwgaGF2ZSBhbiAib3Zl
cmZsb3ciIHBpcGUgb2YgcGVuZGluZyB3YXRjaCBldmVudHMgaXQgY291bGRu
J3QKICBkZWxpdmVyCgpJdGVtcyBhcmUgcXVldWVkIHVwIG9uIG9uZSBlbmQg
YW5kIGFyZSBzZW50IGFzIGZhciBhbG9uZyB0aGUgcGlwZSBhcyBwb3NzaWJs
ZToKCiAgc291cmNlIGRvbWFpbiAtPiB3YXRjaCAtPiB4ZW5idXMgb2YgdGFy
Z2V0IC0+IHhlbnN0b3JlIHJpbmcvc29ja2V0IG9mIHRhcmdldAoKSWYgdGhl
IHBpcGUgaXMgImZ1bGwiIGF0IGFueSBwb2ludCB0aGVuIGJhY2stcHJlc3N1
cmUgaXMgYXBwbGllZCBhbmQgd2UgcHJldmVudAptb3JlIGl0ZW1zIGZyb20g
YmVpbmcgcXVldWVkIHVwLiAgRm9yIHRoZSBzb3VyY2UgZG9tYWluIHRoaXMg
bWVhbnMgdGhhdCB3ZSdsbApzdG9wIGFjY2VwdGluZyBuZXcgY29tbWFuZHMg
YXMgbG9uZyBhcyBpdHMgcGlwZSBidWZmZXIgaXMgbm90IGVtcHR5LgoKQmVm
b3JlIHdlIHRyeSB0byBlbnF1ZXVlIGFuIGl0ZW0gd2UgZmlyc3QgY2hlY2sg
d2hldGhlciBpdCBpcyBwb3NzaWJsZSB0byBzZW5kCml0IGZ1cnRoZXIgZG93
biB0aGUgcGlwZSwgYnkgYXR0ZW1wdGluZyB0byByZWN1cnNpdmVseSBmbHVz
aCB0aGUgcGlwZXMuIFRoaXMKZW5zdXJlcyB0aGF0IHdlIHJldGFpbiB0aGUg
b3JkZXIgb2YgZXZlbnRzIGFzIG11Y2ggYXMgcG9zc2libGUuCgpXZSBtaWdo
dCBicmVhayBjYXVzYWxpdHkgb2Ygd2F0Y2ggZXZlbnRzIGlmIHRoZSB0YXJn
ZXQgZG9tYWluJ3MgcXVldWUgaXMgZnVsbAphbmQgd2UgbmVlZCB0byBzdGFy
dCB1c2luZyB0aGUgd2F0Y2gncyBxdWV1ZS4gIFRoaXMgaXMgYSBicmVha2lu
ZyBjaGFuZ2UgaW4KdGhlIHhlbnN0b3JlIHByb3RvY29sLCBidXQgb25seSBm
b3IgZG9tYWlucyB3aGljaCBhcmUgbm90IHByb2Nlc3NpbmcgdGhlaXIKaW5j
b21pbmcgcmluZyBhcyBleHBlY3RlZC4KCldoZW4gYSB3YXRjaCBpcyBkZWxl
dGVkIGl0cyBlbnRpcmUgcGVuZGluZyBxdWV1ZSBpcyBkcm9wcGVkIChubyBj
b2RlIGlzIG5lZWRlZApmb3IgdGhhdCwgYmVjYXVzZSBpdCBpcyBwYXJ0IG9m
IHRoZSAnd2F0Y2gnIHR5cGUpLgoKVGhlcmUgaXMgYSBjYWNoZSBvZiB3YXRj
aGVzIHRoYXQgaGF2ZSBwZW5kaW5nIGV2ZW50cyB0aGF0IHdlIGF0dGVtcHQg
dG8gZmx1c2gKYXQgZXZlcnkgY3ljbGUgaWYgcG9zc2libGUuCgpJbnRyb2R1
Y2UgMyBsaW1pdHMgaGVyZToKKiBxdW90YS1tYXh3YXRjaGV2ZW50cyBvbiB3
YXRjaCBldmVudCBkZXN0aW5hdGlvbjogd2hlbiB0aGlzIGlzIGhpdCB0aGUK
ICBzb3VyY2Ugd2lsbCBub3QgYmUgYWxsb3dlZCB0byBxdWV1ZSB1cCBtb3Jl
IHdhdGNoIGV2ZW50cy4KKiBxdW90YS1tYXhvdXN0YW5kaW5nIHdoaWNoIGlz
IHRoZSBudW1iZXIgb2YgcmVzcG9uc2VzIG5vdCByZWFkIGZyb20gdGhlIHJp
bmc6CiAgb25jZSBleGNlZWRlZCwgbm8gbW9yZSBpbnB1dHMgYXJlIHByb2Nl
c3NlZCB1bnRpbCBhbGwgb3V0c3RhbmRpbmcgcmVwbGllcwogIGFyZSBjb25z
dW1lZCBieSB0aGUgY2xpZW50LgoqIG92ZXJmbG93IHF1ZXVlIG9uIHRoZSB3
YXRjaCBldmVudCBzb3VyY2U6IGFsbCB3YXRjaGVzIHRoYXQgY2Fubm90IGJl
IHN0b3JlZAogIG9uIGRlc3RpbmF0aW9uIGFyZSBxdWV1ZWQgdXAgaGVyZSwg
YSBzaW5nbGUgY29tbWFuZCBjYW4gdHJpZ2dlciBtdWx0aXBsZQogIHdhdGNo
ZXMgKGUuZy4gZHVlIHRvIHJlY3Vyc2lvbikuCgpUaGUgb3ZlcmZsb3cgcXVl
dWUgY3VycmVudGx5IGRvZXNuJ3QgaGF2ZSBhbiB1cHBlciBib3VuZCwgaXQg
aXMgZGlmZmljdWx0IHRvCmFjY3VyYXRlbHkgY2FsY3VsYXRlIG9uZSBhcyBp
dCBkZXBlbmRzIG9uIHdoZXRoZXIgeW91IGFyZSBEb20wIGFuZCBob3cgbWFu
eQp3YXRjaGVzIGVhY2ggcGF0aCBoYXMgcmVnaXN0ZXJlZCBhbmQgaG93IG1h
bnkgd2F0Y2ggZXZlbnRzIHlvdSBjYW4gdHJpZ2dlcgp3aXRoIGEgc2luZ2xl
IGNvbW1hbmQgKGUuZy4gYSBjb21taXQpLiAgSG93ZXZlciB0aGVzZSBldmVu
dHMgd2VyZSBhbHJlYWR5CnVzaW5nIG1lbW9yeSwgdGhpcyBqdXN0IG1vdmVz
IHRoZW0gZWxzZXdoZXJlLCBhbmQgYXMgbG9uZyBhcyB3ZSBjb3JyZWN0bHkK
YmxvY2sgYSBkb21haW4gaXQgc2hvdWxkbid0IHJlc3VsdCBpbiB1bmJvdW5k
ZWQgbWVtb3J5IHVzYWdlLgoKTm90ZSB0aGF0IERvbTAgaXMgbm90IGV4Y2x1
ZGVkIGZyb20gdGhlc2UgY2hlY2tzLCBpdCBpcyBpbXBvcnRhbnQgdGhhdCBE
b20wIGlzCmVzcGVjaWFsbHkgbm90IGV4Y2x1ZGVkIHdoZW4gaXQgaXMgdGhl
IHNvdXJjZSwgc2luY2UgdGhlcmUgYXJlIG1hbnkgd2F5cyBpbgp3aGljaCBh
IGd1ZXN0IGNvdWxkIHRyaWdnZXIgRG9tMCB0byBzZW5kIGl0IHdhdGNoIGV2
ZW50cy4KClRoaXMgc2hvdWxkIHByb3RlY3QgYWdhaW5zdCBtYWxpY2lvdXMg
ZnJvbnRlbmRzIGFzIGxvbmcgYXMgdGhlIGJhY2tlbmQgZm9sbG93cwp0aGUg
UFYgeGVuc3RvcmUgcHJvdG9jb2wgYW5kIG9ubHkgZXhwb3NlcyBwYXRocyBu
ZWVkZWQgYnkgdGhlIGZyb250ZW5kLCBhbmQKY2hhbmdlcyB0aG9zZSBwYXRo
cyBhdCBtb3N0IG9uY2UgYXMgYSByZWFjdGlvbiB0byBndWVzdCBldmVudHMs
IG9yIHByb3RvY29sCnN0YXRlLgoKVGhlIHF1ZXVlIGxpbWl0cyBhcmUgcGVy
IHdhdGNoLCBhbmQgcGVyIGRvbWFpbi1wYWlyLCBzbyBldmVuIGlmIG9uZQpj
b21tdW5pY2F0aW9uIGNoYW5uZWwgd291bGQgYmUgImJsb2NrZWQiLCBvdGhl
cnMgd291bGQga2VlcCB3b3JraW5nLCBhbmQgdGhlCmRvbWFpbiBpdHNlbGYg
d29uJ3QgZ2V0IGJsb2NrZWQgYXMgbG9uZyBhcyBpdCBkb2Vzbid0IG92ZXJm
bG93IHRoZSBxdWV1ZSBvZgp3YXRjaCBldmVudHMuCgpTaW1pbGFybHkgYSBt
YWxpY2lvdXMgYmFja2VuZCBjb3VsZCBjYXVzZSB0aGUgZnJvbnRlbmQgdG8g
Z2V0IGJsb2NrZWQsIGJ1dAp0aGlzIHdhdGNoIHF1ZXVlIHByb3RlY3RzIHRo
ZSBmcm9udGVuZCBhcyB3ZWxsIGFzIGxvbmcgYXMgaXQgZm9sbG93cyB0aGUg
UFYKcHJvdG9jb2wuICAoQWx0aG91Z2ggbm90ZSB0aGF0IHByb3RlY3Rpb24g
YWdhaW5zdCBtYWxpY2lvdXMgYmFja2VuZHMgaXMgb25seSBhCmJlc3QgZWZm
b3J0IGF0IHRoZSBtb21lbnQpCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAv
IENWRS0yMDIyLTQyMzE4LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLD
tmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3Rp
YW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbCBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKaW5kZXggNDE5N2EzODg4YTY4Li5iMjkyZWQ3
YTg3NGQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwK
KysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbApAQCAtMTM0LDE0ICsx
MzQsNDQgQEAgdHlwZSBiYWNrZW5kID0gRmQgb2YgYmFja2VuZF9mZCB8IFhl
bm1tYXAgb2YgYmFja2VuZF9tbWFwCiAKIHR5cGUgcGFydGlhbF9idWYgPSBI
YXZlSGRyIG9mIFBhcnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMK
IAorKCoKKwlzZXBhcmF0ZSBjYXBhY2l0eSByZXNlcnZhdGlvbiBmb3IgcmVw
bGllcyBhbmQgd2F0Y2ggZXZlbnRzOgorCXRoaXMgYWxsb3dzIGEgZG9tYWlu
IHRvIGtlZXAgd29ya2luZyBldmVuIHdoZW4gdW5kZXIgYSBjb25zdGFudCBm
bG9vZCBvZgorCXdhdGNoIGV2ZW50cworKikKK3R5cGUgY2FwYWNpdHkgPSB7
IG1heG91dHN0YW5kaW5nOiBpbnQ7IG1heHdhdGNoZXZlbnRzOiBpbnQgfQor
Cittb2R1bGUgUXVldWUgPSBCb3VuZGVkUXVldWUKKwordHlwZSBwYWNrZXRf
Y2xhc3MgPQorCXwgQ29tbWFuZFJlcGx5CisJfCBXYXRjaGV2ZW50CisKK2xl
dCBzdHJpbmdfb2ZfcGFja2V0X2NsYXNzID0gZnVuY3Rpb24KKwl8IENvbW1h
bmRSZXBseSAtPiAiY29tbWFuZF9yZXBseSIKKwl8IFdhdGNoZXZlbnQgLT4g
IndhdGNoX2V2ZW50IgorCiB0eXBlIHQgPQogewogCWJhY2tlbmQ6IGJhY2tl
bmQ7Ci0JcGt0X291dDogUGFja2V0LnQgUXVldWUudDsKKwlwa3Rfb3V0OiAo
UGFja2V0LnQsIHBhY2tldF9jbGFzcykgUXVldWUudDsKIAltdXRhYmxlIHBh
cnRpYWxfaW46IHBhcnRpYWxfYnVmOwogCW11dGFibGUgcGFydGlhbF9vdXQ6
IHN0cmluZzsKKwljYXBhY2l0eTogY2FwYWNpdHkKIH0KIAorbGV0IHRvX3Jl
YWQgY29uID0KKwltYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCisJCXwgSGF2
ZUhkciBwYXJ0aWFsX3BrdCAtPiBQYXJ0aWFsLnRvX2NvbXBsZXRlIHBhcnRp
YWxfcGt0CisJCXwgTm9IZHIgICAoaSwgXykgICAgLT4gaQorCitsZXQgZGVi
dWcgdCA9CisJUHJpbnRmLnNwcmludGYgIlhlbkJ1cyBzdGF0ZTogcGFydGlh
bF9pbjogJWQgbmVlZGVkLCBwYXJ0aWFsX291dDogJWQgYnl0ZXMsIHBrdF9v
dXQ6ICVkIHBhY2tldHMsICVzIgorCQkodG9fcmVhZCB0KQorCQkoU3RyaW5n
Lmxlbmd0aCB0LnBhcnRpYWxfb3V0KQorCQkoUXVldWUubGVuZ3RoIHQucGt0
X291dCkKKwkJKEJvdW5kZWRRdWV1ZS5kZWJ1ZyBzdHJpbmdfb2ZfcGFja2V0
X2NsYXNzIHQucGt0X291dCkKKwogbGV0IGluaXRfcGFydGlhbF9pbiAoKSA9
IE5vSGRyCiAJKFBhcnRpYWwuaGVhZGVyX3NpemUgKCksIEJ5dGVzLm1ha2Ug
KFBhcnRpYWwuaGVhZGVyX3NpemUoKSkgJ1wwMDAnKQogCkBAIC0xOTksNyAr
MjI5LDggQEAgbGV0IG91dHB1dCBjb24gPQogCWxldCBzID0gaWYgU3RyaW5n
Lmxlbmd0aCBjb24ucGFydGlhbF9vdXQgPiAwIHRoZW4KIAkJCWNvbi5wYXJ0
aWFsX291dAogCQllbHNlIGlmIFF1ZXVlLmxlbmd0aCBjb24ucGt0X291dCA+
IDAgdGhlbgotCQkJUGFja2V0LnRvX3N0cmluZyAoUXVldWUucG9wIGNvbi5w
a3Rfb3V0KQorCQkJbGV0IHBrdCA9IFF1ZXVlLnBvcCBjb24ucGt0X291dCBp
bgorCQkJUGFja2V0LnRvX3N0cmluZyBwa3QKIAkJZWxzZQogCQkJIiIgaW4K
IAkoKiBzZW5kIGRhdGEgZnJvbSBzLCBhbmQgc2F2ZSB0aGUgdW5zZW50IGRh
dGEgdG8gcGFydGlhbF9vdXQgKikKQEAgLTIxMiwxMiArMjQzLDE1IEBAIGxl
dCBvdXRwdXQgY29uID0KIAkoKiBhZnRlciBzZW5kaW5nIG9uZSBwYWNrZXQs
IHBhcnRpYWwgaXMgZW1wdHkgKikKIAljb24ucGFydGlhbF9vdXQgPSAiIgog
CisoKiB3ZSBjYW4gb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCBpZiB3
ZSdyZSBndWFyYW50ZWVkIHRvIGhhdmUgcm9vbQorICAgdG8gc3RvcmUgdGhl
IHJlc3BvbnNlIHBhY2tldCAqKQorbGV0IGNhbl9pbnB1dCBjb24gPSBRdWV1
ZS5jYW5fcHVzaCBjb24ucGt0X291dCBDb21tYW5kUmVwbHkKKwogKCogTkI6
IGNhbiB0aHJvdyBSZWNvbm5lY3QgKikKIGxldCBpbnB1dCBjb24gPQotCWxl
dCB0b19yZWFkID0KLQkJbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAotCQl8
IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4gUGFydGlhbC50b19jb21wbGV0ZSBw
YXJ0aWFsX3BrdAotCQl8IE5vSGRyICAgKGksIF8pICAgIC0+IGkgaW4KKwlp
ZiBub3QgKGNhbl9pbnB1dCBjb24pIHRoZW4gTm9uZQorCWVsc2UKKwlsZXQg
dG9fcmVhZCA9IHRvX3JlYWQgY29uIGluCiAKIAkoKiB0cnkgdG8gZ2V0IG1v
cmUgZGF0YSBmcm9tIGlucHV0IHN0cmVhbSAqKQogCWxldCBiID0gQnl0ZXMu
bWFrZSB0b19yZWFkICdcMDAwJyBpbgpAQCAtMjQzLDExICsyNzcsMjIgQEAg
bGV0IGlucHV0IGNvbiA9CiAJCU5vbmUKIAkpCiAKLWxldCBuZXdjb24gYmFj
a2VuZCA9IHsKK2xldCBjbGFzc2lmeSB0ID0KKwltYXRjaCB0LlBhY2tldC50
eSB3aXRoCisJfCBPcC5XYXRjaGV2ZW50IC0+IFdhdGNoZXZlbnQKKwl8IF8g
LT4gQ29tbWFuZFJlcGx5CisKK2xldCBuZXdjb24gfmNhcGFjaXR5IGJhY2tl
bmQgPQorCWxldCBsaW1pdCA9IGZ1bmN0aW9uCisJCXwgQ29tbWFuZFJlcGx5
IC0+IGNhcGFjaXR5Lm1heG91dHN0YW5kaW5nCisJCXwgV2F0Y2hldmVudCAt
PiBjYXBhY2l0eS5tYXh3YXRjaGV2ZW50cworCWluCisJewogCWJhY2tlbmQg
PSBiYWNrZW5kOwotCXBrdF9vdXQgPSBRdWV1ZS5jcmVhdGUgKCk7CisJcGt0
X291dCA9IFF1ZXVlLmNyZWF0ZSB+Y2FwYWNpdHk6KGNhcGFjaXR5Lm1heG91
dHN0YW5kaW5nICsgY2FwYWNpdHkubWF4d2F0Y2hldmVudHMpIH5jbGFzc2lm
eSB+bGltaXQ7CiAJcGFydGlhbF9pbiA9IGluaXRfcGFydGlhbF9pbiAoKTsK
IAlwYXJ0aWFsX291dCA9ICIiOworCWNhcGFjaXR5ID0gY2FwYWNpdHk7CiAJ
fQogCiBsZXQgb3Blbl9mZCBmZCA9IG5ld2NvbiAoRmQgeyBmZCA9IGZkOyB9
KQpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkgYi90
b29scy9vY2FtbC9saWJzL3hiL3hiLm1saQppbmRleCA5MWM2ODIxNjJjZWEu
LjcxYjI3NTRjYTc4OCAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94
Yi94Yi5tbGkKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkKQEAg
LTY2LDEwICs2NiwxMSBAQCB0eXBlIGJhY2tlbmRfbW1hcCA9IHsKIHR5cGUg
YmFja2VuZF9mZCA9IHsgZmQgOiBVbml4LmZpbGVfZGVzY3I7IH0KIHR5cGUg
YmFja2VuZCA9IEZkIG9mIGJhY2tlbmRfZmQgfCBYZW5tbWFwIG9mIGJhY2tl
bmRfbW1hcAogdHlwZSBwYXJ0aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlh
bC5wa3QgfCBOb0hkciBvZiBpbnQgKiBieXRlcwordHlwZSBjYXBhY2l0eSA9
IHsgbWF4b3V0c3RhbmRpbmc6IGludDsgbWF4d2F0Y2hldmVudHM6IGludCB9
CiB0eXBlIHQKIHZhbCBpbml0X3BhcnRpYWxfaW4gOiB1bml0IC0+IHBhcnRp
YWxfYnVmCiB2YWwgcmVjb25uZWN0IDogdCAtPiB1bml0Ci12YWwgcXVldWUg
OiB0IC0+IFBhY2tldC50IC0+IHVuaXQKK3ZhbCBxdWV1ZSA6IHQgLT4gUGFj
a2V0LnQgLT4gdW5pdCBvcHRpb24KIHZhbCByZWFkX2ZkIDogYmFja2VuZF9m
ZCAtPiAnYSAtPiBieXRlcyAtPiBpbnQgLT4gaW50CiB2YWwgcmVhZF9tbWFw
IDogYmFja2VuZF9tbWFwIC0+ICdhIC0+IGJ5dGVzIC0+IGludCAtPiBpbnQK
IHZhbCByZWFkIDogdCAtPiBieXRlcyAtPiBpbnQgLT4gaW50CkBAIC03OCwx
MyArNzksMTQgQEAgdmFsIHdyaXRlX21tYXAgOiBiYWNrZW5kX21tYXAgLT4g
J2EgLT4gc3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCB3cml0ZSA6IHQgLT4g
c3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCBvdXRwdXQgOiB0IC0+IGJvb2wK
IHZhbCBpbnB1dCA6IHQgLT4gUGFja2V0LnQgb3B0aW9uCi12YWwgbmV3Y29u
IDogYmFja2VuZCAtPiB0Ci12YWwgb3Blbl9mZCA6IFVuaXguZmlsZV9kZXNj
ciAtPiB0Ci12YWwgb3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFj
ZSAtPiAodW5pdCAtPiB1bml0KSAtPiB0Cit2YWwgbmV3Y29uIDogY2FwYWNp
dHk6Y2FwYWNpdHkgLT4gYmFja2VuZCAtPiB0Cit2YWwgb3Blbl9mZCA6IFVu
aXguZmlsZV9kZXNjciAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0Cit2YWwg
b3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFjZSAtPiAodW5pdCAt
PiB1bml0KSAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0CiB2YWwgY2xvc2Ug
OiB0IC0+IHVuaXQKIHZhbCBpc19mZCA6IHQgLT4gYm9vbAogdmFsIGlzX21t
YXAgOiB0IC0+IGJvb2wKIHZhbCBvdXRwdXRfbGVuIDogdCAtPiBpbnQKK3Zh
bCBjYW5faW5wdXQ6IHQgLT4gYm9vbAogdmFsIGhhc19uZXdfb3V0cHV0IDog
dCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRwdXQgOiB0IC0+IGJvb2wKIHZh
bCBoYXNfb3V0cHV0IDogdCAtPiBib29sCkBAIC05MywzICs5NSw0IEBAIHZh
bCBoYXNfcGFydGlhbF9pbnB1dCA6IHQgLT4gYm9vbAogdmFsIGhhc19tb3Jl
X2lucHV0IDogdCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4g
Ym9vbAogdmFsIGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCit2YWwg
ZGVidWc6IHQgLT4gc3RyaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9s
aWJzL3hzL3F1ZXVlb3AubWwgYi90b29scy9vY2FtbC9saWJzL3hzL3F1ZXVl
b3AubWwKaW5kZXggOWZmNWJiZDUyOWNlLi40ZTUzMmNkYWVhY2IgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveHMvcXVldWVvcC5tbAorKysgYi90
b29scy9vY2FtbC9saWJzL3hzL3F1ZXVlb3AubWwKQEAgLTE2LDkgKzE2LDEw
IEBACiBvcGVuIFhlbmJ1cwogCiBsZXQgZGF0YV9jb25jYXQgbHMgPSAoU3Ry
aW5nLmNvbmNhdCAiXDAwMCIgbHMpIF4gIlwwMDAiCitsZXQgcXVldWUgY29u
IHBrdCA9IGxldCByID0gWGIucXVldWUgY29uIHBrdCBpbiBhc3NlcnQgKHIg
PD4gTm9uZSkKIGxldCBxdWV1ZV9wYXRoIHR5ICh0aWQ6IGludCkgKHBhdGg6
IHN0cmluZykgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0
aDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQogCiAoKiBvcGVyYXRpb25zICopCiBsZXQgZGlyZWN0b3J5
IHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuRGlyZWN0b3J5IHRp
ZCBwYXRoIGNvbgpAQCAtMjcsNDggKzI4LDQ4IEBAIGxldCByZWFkIHRpZCBw
YXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuUmVhZCB0aWQgcGF0aCBjb24K
IGxldCBnZXRwZXJtcyB0aWQgcGF0aCBjb24gPSBxdWV1ZV9wYXRoIFhiLk9w
LkdldHBlcm1zIHRpZCBwYXRoIGNvbgogCiBsZXQgZGVidWcgY29tbWFuZHMg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLkRlYnVnIChkYXRhX2NvbmNhdCBjb21tYW5kcykpCisJcXVldWUgY29u
IChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5EZWJ1ZyAoZGF0YV9jb25j
YXQgY29tbWFuZHMpKQogCiBsZXQgd2F0Y2ggcGF0aCBkYXRhIGNvbiA9CiAJ
bGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7IGRhdGE7IF0gaW4KLQlY
Yi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhiLk9wLldhdGNo
IGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5P
cC5XYXRjaCBkYXRhKQogCiBsZXQgdW53YXRjaCBwYXRoIGRhdGEgY29uID0K
IAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0aDsgZGF0YTsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuVW53
YXRjaCBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAg
WGIuT3AuVW53YXRjaCBkYXRhKQogCiBsZXQgdHJhbnNhY3Rpb25fc3RhcnQg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLlRyYW5zYWN0aW9uX3N0YXJ0IChkYXRhX2NvbmNhdCBbXSkpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5UcmFuc2FjdGlv
bl9zdGFydCAoZGF0YV9jb25jYXQgW10pKQogCiBsZXQgdHJhbnNhY3Rpb25f
ZW5kIHRpZCBjb21taXQgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0
IFsgKGlmIGNvbW1pdCB0aGVuICJUIiBlbHNlICJGIik7IF0gaW4KLQlYYi5x
dWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuVHJhbnNh
Y3Rpb25fZW5kIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRl
IHRpZCAwIFhiLk9wLlRyYW5zYWN0aW9uX2VuZCBkYXRhKQogCiBsZXQgaW50
cm9kdWNlIGRvbWlkIG1mbiBwb3J0IGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRh
X2NvbmNhdCBbIFByaW50Zi5zcHJpbnRmICIldSIgZG9taWQ7CiAJICAgICAg
ICAgICAgICAgICAgICAgICAgIFByaW50Zi5zcHJpbnRmICIlbnUiIG1mbjsK
IAkgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nX29mX2ludCBwb3J0
OyBdIGluCi0JWGIucXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5JbnRyb2R1Y2UgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBhY2tldC5j
cmVhdGUgMCAwIFhiLk9wLkludHJvZHVjZSBkYXRhKQogCiBsZXQgcmVsZWFz
ZSBkb21pZCBjb24gPQogCWxldCBkYXRhID0gZGF0YV9jb25jYXQgWyBQcmlu
dGYuc3ByaW50ZiAiJXUiIGRvbWlkOyBdIGluCi0JWGIucXVldWUgY29uIChY
Yi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRhdGEpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRh
dGEpCiAKIGxldCByZXN1bWUgZG9taWQgY29uID0KIAlsZXQgZGF0YSA9IGRh
dGFfY29uY2F0IFsgUHJpbnRmLnNwcmludGYgIiV1IiBkb21pZDsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuUmVz
dW1lIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5SZXN1bWUgZGF0YSkKIAogbGV0IGdldGRvbWFpbnBhdGggZG9taWQg
Y29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgUHJpbnRmLnNwcmlu
dGYgIiV1IiBkb21pZDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0
LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0aCBkYXRhKQorCXF1ZXVl
IGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0
aCBkYXRhKQogCiBsZXQgd3JpdGUgdGlkIHBhdGggdmFsdWUgY29uID0KIAls
ZXQgZGF0YSA9IHBhdGggXiAiXDAwMCIgXiB2YWx1ZSAoKiBubyBOVUxMIGF0
IHRoZSBlbmQgKikgaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVh
dGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKIAogbGV0IG1r
ZGlyIHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuTWtkaXIgdGlk
IHBhdGggY29uCiBsZXQgcm0gdGlkIHBhdGggY29uID0gcXVldWVfcGF0aCBY
Yi5PcC5SbSB0aWQgcGF0aCBjb24KIAogbGV0IHNldHBlcm1zIHRpZCBwYXRo
IHBlcm1zIGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7
IHBlcm1zIF0gaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUg
dGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwgYi90b29scy9v
Y2FtbC9saWJzL3hzL3hzcmF3Lm1sCmluZGV4IDQ1MWY4YjM4ZGJjYy4uY2Jk
MTcyODA2MDBjIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9saWJzL3hzL3hz
cmF3Lm1sCisrKyBiL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwKQEAg
LTM2LDggKzM2LDEwIEBAIHR5cGUgY29uID0gewogbGV0IGNsb3NlIGNvbiA9
CiAJWGIuY2xvc2UgY29uLnhiCiAKK2xldCBjYXBhY2l0eSA9IHsgWGIubWF4
b3V0c3RhbmRpbmcgPSAxOyBtYXh3YXRjaGV2ZW50cyA9IDA7IH0KKwogbGV0
IG9wZW5fZmQgZmQgPSB7Ci0JeGIgPSBYYi5vcGVuX2ZkIGZkOworCXhiID0g
WGIub3Blbl9mZCB+Y2FwYWNpdHkgZmQ7CiAJd2F0Y2hldmVudHMgPSBRdWV1
ZS5jcmVhdGUgKCk7CiB9CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC9jb25uZWN0aW9uLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVk
L2Nvbm5lY3Rpb24ubWwKaW5kZXggYWNlMmFhNWI0ZjUzLi45YWFkNDUxYTJk
YmQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0
aW9uLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCkBAIC0yMCwxMiArMjAsODQgQEAgb3BlbiBTdGRleHQKIAogbGV0IHhl
bnN0b3JlX3BheWxvYWRfbWF4ID0gNDA5NiAoKiB4ZW4vaW5jbHVkZS9wdWJs
aWMvaW8veHNfd2lyZS5oICopCiAKK3R5cGUgJ2EgYm91bmRlZF9zZW5kZXIg
PSAnYSAtPiB1bml0IG9wdGlvbgorKCoqIGEgYm91bmRlZCBzZW5kZXIgYWNj
ZXB0cyBhbiBbJ2FdIGl0ZW0gYW5kIHJldHVybnM6CisgICAgTm9uZSAtIGlm
IHRoZXJlIGlzIG5vIHJvb20gdG8gYWNjZXB0IHRoZSBpdGVtCisgICAgU29t
ZSAoKSAtICBpZiBpdCBoYXMgc3VjY2Vzc2Z1bGx5IGFjY2VwdGVkL3NlbnQg
dGhlIGl0ZW0KKyAqKQorCittb2R1bGUgQm91bmRlZFBpcGUgOiBzaWcKKwl0
eXBlICdhIHQKKworCSgqKiBbY3JlYXRlIH5jYXBhY2l0eSB+ZGVzdGluYXRp
b25dIGNyZWF0ZXMgYSBib3VuZGVkIHBpcGUgd2l0aCBhCisJICAgIGxvY2Fs
IGJ1ZmZlciBob2xkaW5nIGF0IG1vc3QgW2NhcGFjaXR5XSBpdGVtcy4gIE9u
Y2UgdGhlIGJ1ZmZlciBpcworCSAgICBmdWxsIGl0IHdpbGwgbm90IGFjY2Vw
dCBmdXJ0aGVyIGl0ZW1zLiAgaXRlbXMgZnJvbSB0aGUgcGlwZSBhcmUKKwkg
ICAgZmx1c2hlZCBpbnRvIFtkZXN0aW5hdGlvbl0gYXMgbG9uZyBhcyBpdCBh
Y2NlcHRzIGl0ZW1zLiAgVGhlCisJICAgIGRlc3RpbmF0aW9uIGNvdWxkIGJl
IGFub3RoZXIgcGlwZS4KKwkgKikKKwl2YWwgY3JlYXRlOiBjYXBhY2l0eTpp
bnQgLT4gZGVzdGluYXRpb246J2EgYm91bmRlZF9zZW5kZXIgLT4gJ2EgdAor
CisJKCoqIFtpc19lbXB0eSB0XSByZXR1cm5zIHdoZXRoZXIgdGhlIGxvY2Fs
IGJ1ZmZlciBvZiBbdF0gaXMgZW1wdHkuICopCisJdmFsIGlzX2VtcHR5IDog
XyB0IC0+IGJvb2wKKworCSgqKiBbbGVuZ3RoIHRdIHRoZSBudW1iZXIgb2Yg
aXRlbXMgaW4gdGhlIGludGVybmFsIGJ1ZmZlciAqKQorCXZhbCBsZW5ndGg6
IF8gdCAtPiBpbnQKKworCSgqKiBbZmx1c2hfcGlwZSB0XSBzZW5kcyBhcyBt
YW55IGl0ZW1zIGZyb20gdGhlIGxvY2FsIGJ1ZmZlciBhcyBwb3NzaWJsZSwK
KwkJCXdoaWNoIGNvdWxkIGJlIG5vbmUuICopCisJdmFsIGZsdXNoX3BpcGU6
IF8gdCAtPiB1bml0CisKKwkoKiogW3B1c2ggdCBpdGVtXSB0cmllcyB0byBb
Zmx1c2hfcGlwZV0gYW5kIHRoZW4gcHVzaCBbaXRlbV0KKwkgICAgaW50byB0
aGUgcGlwZSBpZiBpdHMgW2NhcGFjaXR5XSBhbGxvd3MuCisJICAgIFJldHVy
bnMgW05vbmVdIGlmIHRoZXJlIGlzIG5vIG1vcmUgcm9vbQorCSAqKQorCXZh
bCBwdXNoIDogJ2EgdCAtPiAnYSBib3VuZGVkX3NlbmRlcgorZW5kID0gc3Ry
dWN0CisJKCogaXRlbXMgYXJlIGVucXVldWVkIGluIFtxXSwgYW5kIHRoZW4g
Zmx1c2hlZCB0byBbY29ubmVjdF90b10gKikKKwl0eXBlICdhIHQgPQorCQl7
IHE6ICdhIFF1ZXVlLnQKKwkJOyBkZXN0aW5hdGlvbjogJ2EgYm91bmRlZF9z
ZW5kZXIKKwkJOyBjYXBhY2l0eTogaW50CisJCX0KKworCWxldCBjcmVhdGUg
fmNhcGFjaXR5IH5kZXN0aW5hdGlvbiA9CisJCXsgcSA9IFF1ZXVlLmNyZWF0
ZSAoKTsgY2FwYWNpdHk7IGRlc3RpbmF0aW9uIH0KKworCWxldCByZWMgZmx1
c2hfcGlwZSB0ID0KKwkJaWYgbm90IFF1ZXVlLihpc19lbXB0eSB0LnEpIHRo
ZW4KKwkJCWxldCBpdGVtID0gUXVldWUucGVlayB0LnEgaW4KKwkJCW1hdGNo
IHQuZGVzdGluYXRpb24gaXRlbSB3aXRoCisJCQl8IE5vbmUgLT4gKCkgKCog
bm8gcm9vbSAqKQorCQkJfCBTb21lICgpIC0+CisJCQkJKCogc3VjY2Vzc2Z1
bGx5IHNlbnQgaXRlbSB0byBuZXh0IHN0YWdlICopCisJCQkJbGV0IF8gPSBR
dWV1ZS5wb3AgdC5xIGluCisJCQkJKCogY29udGludWUgdHJ5aW5nIHRvIHNl
bmQgbW9yZSBpdGVtcyAqKQorCQkJCWZsdXNoX3BpcGUgdAorCisJbGV0IHB1
c2ggdCBpdGVtID0KKwkJKCogZmlyc3QgdHJ5IHRvIGZsdXNoIGFzIG1hbnkg
aXRlbXMgZnJvbSB0aGlzIHBpcGUgYXMgcG9zc2libGUgdG8gbWFrZSByb29t
LAorCQkgICBpdCBpcyBpbXBvcnRhbnQgdG8gZG8gdGhpcyBmaXJzdCB0byBw
cmVzZXJ2ZSB0aGUgb3JkZXIgb2YgdGhlIGl0ZW1zCisJCSAqKQorCQlmbHVz
aF9waXBlIHQ7CisJCWlmIFF1ZXVlLmxlbmd0aCB0LnEgPCB0LmNhcGFjaXR5
IHRoZW4gYmVnaW4KKwkJCSgqIGVucXVldWUsIGluc3RlYWQgb2Ygc2VuZGlu
ZyBkaXJlY3RseS4KKwkJCSAgIHRoaXMgZW5zdXJlcyB0aGF0IFtvdXRdIHNl
ZXMgdGhlIGl0ZW1zIGluIHRoZSBzYW1lIG9yZGVyIGFzIHdlIHJlY2VpdmUg
dGhlbQorCQkJICopCisJCQlRdWV1ZS5wdXNoIGl0ZW0gdC5xOworCQkJU29t
ZSAoZmx1c2hfcGlwZSB0KQorCQllbmQgZWxzZSBOb25lCisKKwlsZXQgaXNf
ZW1wdHkgdCA9IFF1ZXVlLmlzX2VtcHR5IHQucQorCWxldCBsZW5ndGggdCA9
IFF1ZXVlLmxlbmd0aCB0LnEKK2VuZAorCiB0eXBlIHdhdGNoID0gewogCWNv
bjogdDsKIAl0b2tlbjogc3RyaW5nOwogCXBhdGg6IHN0cmluZzsKIAliYXNl
OiBzdHJpbmc7CiAJaXNfcmVsYXRpdmU6IGJvb2w7CisJcGVuZGluZ193YXRj
aGV2ZW50czogWGVuYnVzLlhiLlBhY2tldC50IEJvdW5kZWRQaXBlLnQ7CiB9
CiAKIGFuZCB0ID0gewpAQCAtMzgsOCArMTEwLDM2IEBAIGFuZCB0ID0gewog
CWFub25pZDogaW50OwogCW11dGFibGUgc3RhdF9uYl9vcHM6IGludDsKIAlt
dXRhYmxlIHBlcm06IFBlcm1zLkNvbm5lY3Rpb24udDsKKwlwZW5kaW5nX3Nv
dXJjZV93YXRjaGV2ZW50czogKHdhdGNoICogWGVuYnVzLlhiLlBhY2tldC50
KSBCb3VuZGVkUGlwZS50CiB9CiAKK21vZHVsZSBXYXRjaCA9IHN0cnVjdAor
CW1vZHVsZSBUID0gc3RydWN0CisJCXR5cGUgdCA9IHdhdGNoCisKKwkJbGV0
IGNvbXBhcmUgdzEgdzIgPQorCQkJKCogY2Fubm90IGNvbXBhcmUgd2F0Y2hl
cyBmcm9tIGRpZmZlcmVudCBjb25uZWN0aW9ucyAqKQorCQkJYXNzZXJ0ICh3
MS5jb24gPT0gdzIuY29uKTsKKwkJCW1hdGNoIFN0cmluZy5jb21wYXJlIHcx
LnRva2VuIHcyLnRva2VuIHdpdGgKKwkJCXwgMCAtPiBTdHJpbmcuY29tcGFy
ZSB3MS5wYXRoIHcyLnBhdGgKKwkJCXwgbiAtPiBuCisJZW5kCisJbW9kdWxl
IFNldCA9IFNldC5NYWtlKFQpCisKKwlsZXQgZmx1c2hfZXZlbnRzIHQgPQor
CQlCb3VuZGVkUGlwZS5mbHVzaF9waXBlIHQucGVuZGluZ193YXRjaGV2ZW50
czsKKwkJbm90IChCb3VuZGVkUGlwZS5pc19lbXB0eSB0LnBlbmRpbmdfd2F0
Y2hldmVudHMpCisKKwlsZXQgcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwkJ
Qm91bmRlZFBpcGUubGVuZ3RoIHQucGVuZGluZ193YXRjaGV2ZW50cworZW5k
CisKK2xldCBzb3VyY2VfZmx1c2hfd2F0Y2hldmVudHMgdCA9CisJQm91bmRl
ZFBpcGUuZmx1c2hfcGlwZSB0LnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRz
CisKK2xldCBzb3VyY2VfcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwlCb3Vu
ZGVkUGlwZS5sZW5ndGggdC5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50cwor
CiBsZXQgbWFya19hc19iYWQgY29uID0KIAltYXRjaCBjb24uZG9tIHdpdGgK
IAl8Tm9uZSAtPiAoKQpAQCAtNjcsNyArMTY3LDggQEAgbGV0IHdhdGNoX2Ny
ZWF0ZSB+Y29uIH5wYXRoIH50b2tlbiA9IHsKIAl0b2tlbiA9IHRva2VuOwog
CXBhdGggPSBwYXRoOwogCWJhc2UgPSBnZXRfcGF0aCBjb247Ci0JaXNfcmVs
YXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4gJ0AnCisJ
aXNfcmVsYXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4g
J0AnOworCXBlbmRpbmdfd2F0Y2hldmVudHMgPSBCb3VuZGVkUGlwZS5jcmVh
dGUgfmNhcGFjaXR5OiFEZWZpbmUubWF4d2F0Y2hldmVudHMgfmRlc3RpbmF0
aW9uOihYZW5idXMuWGIucXVldWUgY29uLnhiKQogfQogCiBsZXQgZ2V0X2Nv
biB3ID0gdy5jb24KQEAgLTkzLDYgKzE5NCw5IEBAIGxldCBtYWtlX3Blcm0g
ZG9tID0KIAlQZXJtcy5Db25uZWN0aW9uLmNyZWF0ZSB+cGVybXM6W1Blcm1z
LlJFQUQ7IFBlcm1zLldSSVRFXSBkb21pZAogCiBsZXQgY3JlYXRlIHhiY29u
IGRvbSA9CisJbGV0IGRlc3RpbmF0aW9uICh3YXRjaCwgcGt0KSA9CisJCUJv
dW5kZWRQaXBlLnB1c2ggd2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyBwa3QK
KwlpbgogCWxldCBpZCA9CiAJCW1hdGNoIGRvbSB3aXRoCiAJCXwgTm9uZSAt
PiBsZXQgb2xkID0gIWFub25faWRfbmV4dCBpbiBpbmNyIGFub25faWRfbmV4
dDsgb2xkCkBAIC0xMDksNiArMjEzLDE2IEBAIGxldCBjcmVhdGUgeGJjb24g
ZG9tID0KIAlhbm9uaWQgPSBpZDsKIAlzdGF0X25iX29wcyA9IDA7CiAJcGVy
bSA9IG1ha2VfcGVybSBkb207CisKKwkoKiB0aGUgYWN0dWFsIGNhcGFjaXR5
IHdpbGwgYmUgbG93ZXIsIHRoaXMgaXMgdXNlZCBhcyBhbiBvdmVyZmxvdwor
CSAgIGJ1ZmZlcjogYW55dGhpbmcgdGhhdCBkb2Vzbid0IGZpdCBlbHNld2hl
cmUgZ2V0cyBwdXQgaGVyZSwgb25seQorCSAgIGxpbWl0ZWQgYnkgdGhlIGFt
b3VudCBvZiB3YXRjaGVzIHRoYXQgeW91IGNhbiBnZW5lcmF0ZSB3aXRoIGEK
KwkgICBzaW5nbGUgeGVuc3RvcmUgY29tbWFuZCAod2hpY2ggaXMgZmluaXRl
LCBhbHRob3VnaCBwb3NzaWJseSB2ZXJ5CisJICAgbGFyZ2UgaW4gdGhlb3J5
IGZvciBEb20wKS4gIE9uY2UgdGhlIHBpcGUgaGVyZSBoYXMgYW55IGNvbnRl
bnRzIHRoZQorCSAgIGRvbWFpbiBpcyBibG9ja2VkIGZyb20gc2VuZGluZyBt
b3JlIGNvbW1hbmRzIHVudGlsIGl0IGlzIGVtcHR5CisJICAgYWdhaW4gdGhv
dWdoLgorCSAqKQorCXBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzID0gQm91
bmRlZFBpcGUuY3JlYXRlIH5jYXBhY2l0eTpTeXMubWF4X2FycmF5X2xlbmd0
aCB+ZGVzdGluYXRpb24KIAl9CiAJaW4KIAlMb2dnaW5nLm5ld19jb25uZWN0
aW9uIH50aWQ6VHJhbnNhY3Rpb24ubm9uZSB+Y29uOihnZXRfZG9tc3RyIGNv
bik7CkBAIC0xMjcsMTEgKzI0MSwxNyBAQCBsZXQgc2V0X3RhcmdldCBjb24g
dGFyZ2V0X2RvbWlkID0KIAogbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBY
ZW5idXMuWGIuaXNfbW1hcCBjb24ueGIKIAotbGV0IHNlbmRfcmVwbHkgY29u
IHRpZCByaWQgdHkgZGF0YSA9CitsZXQgcGFja2V0X29mIGNvbiB0aWQgcmlk
IHR5IGRhdGEgPQogCWlmIChTdHJpbmcubGVuZ3RoIGRhdGEpID4geGVuc3Rv
cmVfcGF5bG9hZF9tYXggJiYgKGlzX2JhY2tlbmRfbW1hcCBjb24pIHRoZW4K
LQkJWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAoWGVuYnVzLlhiLlBhY2tldC5j
cmVhdGUgdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgIkUyQklHXDAwMCIp
CisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgWGVuYnVzLlhi
Lk9wLkVycm9yICJFMkJJR1wwMDAiCiAJZWxzZQotCQlYZW5idXMuWGIucXVl
dWUgY29uLnhiIChYZW5idXMuWGIuUGFja2V0LmNyZWF0ZSB0aWQgcmlkIHR5
IGRhdGEpCisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgdHkg
ZGF0YQorCitsZXQgc2VuZF9yZXBseSBjb24gdGlkIHJpZCB0eSBkYXRhID0K
KwlsZXQgcmVzdWx0ID0gWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAocGFja2V0
X29mIGNvbiB0aWQgcmlkIHR5IGRhdGEpIGluCisJKCogc2hvdWxkIG5ldmVy
IGhhcHBlbjogd2Ugb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCB3aGVu
IHRoZXJlIGlzIHJvb20gZm9yIGFuIG91dHB1dCBwYWNrZXQgKikKKwkoKiBh
bmQgdGhlIGxpbWl0IGZvciByZXBsaWVzIGlzIGRpZmZlcmVudCBmcm9tIHRo
ZSBsaW1pdCBmb3Igd2F0Y2ggZXZlbnRzICopCisJYXNzZXJ0IChyZXN1bHQg
PD4gTm9uZSkKIAogbGV0IHNlbmRfZXJyb3IgY29uIHRpZCByaWQgZXJyID0g
c2VuZF9yZXBseSBjb24gdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgKGVy
ciBeICJcMDAwIikKIGxldCBzZW5kX2FjayBjb24gdGlkIHJpZCB0eSA9IHNl
bmRfcmVwbHkgY29uIHRpZCByaWQgdHkgIk9LXDAwMCIKQEAgLTE4MSwxMSAr
MzAxLDExIEBAIGxldCBkZWxfd2F0Y2ggY29uIHBhdGggdG9rZW4gPQogCWFw
YXRoLCB3CiAKIGxldCBkZWxfd2F0Y2hlcyBjb24gPQotICBIYXNodGJsLmNs
ZWFyIGNvbi53YXRjaGVzOworICBIYXNodGJsLnJlc2V0IGNvbi53YXRjaGVz
OwogICBjb24ubmJfd2F0Y2hlcyA8LSAwCiAKIGxldCBkZWxfdHJhbnNhY3Rp
b25zIGNvbiA9Ci0gIEhhc2h0YmwuY2xlYXIgY29uLnRyYW5zYWN0aW9ucwor
ICBIYXNodGJsLnJlc2V0IGNvbi50cmFuc2FjdGlvbnMKIAogbGV0IGxpc3Rf
d2F0Y2hlcyBjb24gPQogCWxldCBsbCA9IEhhc2h0YmwuZm9sZApAQCAtMjA4
LDIxICszMjgsMjkgQEAgbGV0IGxvb2t1cF93YXRjaF9wZXJtIHBhdGggPSBm
dW5jdGlvbgogbGV0IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3Qg
cGF0aCA9CiAJbG9va3VwX3dhdGNoX3Blcm0gcGF0aCBvbGRyb290IEAgbG9v
a3VwX3dhdGNoX3Blcm0gcGF0aCAoU29tZSByb290KQogCi1sZXQgZmlyZV9z
aW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdhdGNoID0KK2xldCBmaXJlX3Npbmds
ZV93YXRjaF91bmNoZWNrZWQgc291cmNlIHdhdGNoID0KIAlsZXQgZGF0YSA9
IFV0aWxzLmpvaW5fYnlfbnVsbCBbd2F0Y2gucGF0aDsgd2F0Y2gudG9rZW47
ICIiXSBpbgotCXNlbmRfcmVwbHkgd2F0Y2guY29uIFRyYW5zYWN0aW9uLm5v
bmUgMCBYZW5idXMuWGIuT3AuV2F0Y2hldmVudCBkYXRhCisJbGV0IHBrdCA9
IHBhY2tldF9vZiB3YXRjaC5jb24gVHJhbnNhY3Rpb24ubm9uZSAwIFhlbmJ1
cy5YYi5PcC5XYXRjaGV2ZW50IGRhdGEgaW4KKworCW1hdGNoIEJvdW5kZWRQ
aXBlLnB1c2ggc291cmNlLnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzICh3
YXRjaCwgcGt0KSB3aXRoCisJfCBTb21lICgpIC0+ICgpICgqIHBhY2tldCBx
dWV1ZWQgKikKKwl8IE5vbmUgLT4KKwkJCSgqIGEgd2VsbCBiZWhhdmVkIERv
bTAgc2hvdWxkbid0IGJlIGFibGUgdG8gdHJpZ2dlciB0aGlzLAorCQkJICAg
aWYgaXQgaGFwcGVucyBpdCBpcyBsaWtlbHkgYSBEb20wIGJ1ZyBjYXVzaW5n
IHJ1bmF3YXkgbWVtb3J5IHVzYWdlCisJCQkgKikKKwkJCWZhaWx3aXRoICJ3
YXRjaCBldmVudCBvdmVyZmxvdywgY2Fubm90IGhhcHBlbiIKIAotbGV0IGZp
cmVfc2luZ2xlX3dhdGNoIChvbGRyb290LCByb290KSB3YXRjaCA9CitsZXQg
ZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIChvbGRyb290LCByb290KSB3YXRj
aCA9CiAJbGV0IGFic3BhdGggPSBnZXRfd2F0Y2hfcGF0aCB3YXRjaC5jb24g
d2F0Y2gucGF0aCB8PiBTdG9yZS5QYXRoLm9mX3N0cmluZyBpbgogCWxldCBw
ZXJtcyA9IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3QgYWJzcGF0
aCBpbgogCWlmIFBlcm1zLmNhbl9maXJlX3dhdGNoIHdhdGNoLmNvbi5wZXJt
IHBlcm1zIHRoZW4KLQkJZmlyZV9zaW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdh
dGNoCisJCWZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCBzb3VyY2Ugd2F0
Y2gKIAllbHNlCiAJCWxldCBwZXJtcyA9IHBlcm1zIHw+IExpc3QubWFwIChQ
ZXJtcy5Ob2RlLnRvX3N0cmluZyB+c2VwOiIgIikgfD4gU3RyaW5nLmNvbmNh
dCAiLCAiIGluCiAJCWxldCBjb24gPSBnZXRfZG9tc3RyIHdhdGNoLmNvbiBp
bgogCQlMb2dnaW5nLndhdGNoX25vdF9maXJlZCB+Y29uIHBlcm1zIChTdG9y
ZS5QYXRoLnRvX3N0cmluZyBhYnNwYXRoKQogCi1sZXQgZmlyZV93YXRjaCBy
b290cyB3YXRjaCBwYXRoID0KK2xldCBmaXJlX3dhdGNoIHNvdXJjZSByb290
cyB3YXRjaCBwYXRoID0KIAlsZXQgbmV3X3BhdGggPQogCQlpZiB3YXRjaC5p
c19yZWxhdGl2ZSAmJiBwYXRoLlswXSA9ICcvJwogCQl0aGVuIGJlZ2luCkBA
IC0yMzIsNyArMzYwLDcgQEAgbGV0IGZpcmVfd2F0Y2ggcm9vdHMgd2F0Y2gg
cGF0aCA9CiAJCWVuZCBlbHNlCiAJCQlwYXRoCiAJaW4KLQlmaXJlX3Npbmds
ZV93YXRjaCByb290cyB7IHdhdGNoIHdpdGggcGF0aCA9IG5ld19wYXRoIH0K
KwlmaXJlX3NpbmdsZV93YXRjaCBzb3VyY2Ugcm9vdHMgeyB3YXRjaCB3aXRo
IHBhdGggPSBuZXdfcGF0aCB9CiAKICgqIFNlYXJjaCBmb3IgYSB2YWxpZCB1
bnVzZWQgdHJhbnNhY3Rpb24gaWQuICopCiBsZXQgcmVjIHZhbGlkX3RyYW5z
YWN0aW9uX2lkIGNvbiBwcm9wb3NlZF9pZCA9CkBAIC0yNzksNiArNDA3LDcg
QEAgbGV0IGdldF90cmFuc2FjdGlvbiBjb24gdGlkID0KIGxldCBkb19pbnB1
dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCiBsZXQgaGFzX21vcmVf
aW5wdXQgY29uID0gWGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54Ygog
CitsZXQgY2FuX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5jYW5faW5wdXQgY29u
LnhiICYmIEJvdW5kZWRQaXBlLmlzX2VtcHR5IGNvbi5wZW5kaW5nX3NvdXJj
ZV93YXRjaGV2ZW50cwogbGV0IGhhc19vdXRwdXQgY29uID0gWGVuYnVzLlhi
Lmhhc19vdXRwdXQgY29uLnhiCiBsZXQgaGFzX29sZF9vdXRwdXQgY29uID0g
WGVuYnVzLlhiLmhhc19vbGRfb3V0cHV0IGNvbi54YgogbGV0IGhhc19uZXdf
b3V0cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfbmV3X291dHB1dCBjb24ueGIK
QEAgLTI4Niw3ICs0MTUsNyBAQCBsZXQgcGVla19vdXRwdXQgY29uID0gWGVu
YnVzLlhiLnBlZWtfb3V0cHV0IGNvbi54YgogbGV0IGRvX291dHB1dCBjb24g
PSBYZW5idXMuWGIub3V0cHV0IGNvbi54YgogCiBsZXQgaGFzX21vcmVfd29y
ayBjb24gPQotCWhhc19tb3JlX2lucHV0IGNvbiB8fCBub3QgKGhhc19vbGRf
b3V0cHV0IGNvbikgJiYgaGFzX25ld19vdXRwdXQgY29uCisJKGhhc19tb3Jl
X2lucHV0IGNvbiAmJiBjYW5faW5wdXQgY29uKSB8fCBub3QgKGhhc19vbGRf
b3V0cHV0IGNvbikgJiYgaGFzX25ld19vdXRwdXQgY29uCiAKIGxldCBpbmNy
X29wcyBjb24gPSBjb24uc3RhdF9uYl9vcHMgPC0gY29uLnN0YXRfbmJfb3Bz
ICsgMQogCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbnMubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlv
bnMubWwKaW5kZXggN2VmZGYzZTVlMDVlLi4zOTE5MGMxOWVjNTggMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9ucy5tbAor
KysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbnMubWwKQEAg
LTIyLDIyICsyMiwzMCBAQCB0eXBlIHQgPSB7CiAJZG9tYWluczogKGludCwg
Q29ubmVjdGlvbi50KSBIYXNodGJsLnQ7CiAJcG9ydHM6IChYZW5ldmVudGNo
bi50LCBDb25uZWN0aW9uLnQpIEhhc2h0YmwudDsKIAltdXRhYmxlIHdhdGNo
ZXM6IChzdHJpbmcsIENvbm5lY3Rpb24ud2F0Y2ggbGlzdCkgVHJpZS50Owor
CW11dGFibGUgaGFzX3BlbmRpbmdfd2F0Y2hldmVudHM6IENvbm5lY3Rpb24u
V2F0Y2guU2V0LnQKIH0KIAogbGV0IGNyZWF0ZSAoKSA9IHsKIAlhbm9ueW1v
dXMgPSBIYXNodGJsLmNyZWF0ZSAzNzsKIAlkb21haW5zID0gSGFzaHRibC5j
cmVhdGUgMzc7CiAJcG9ydHMgPSBIYXNodGJsLmNyZWF0ZSAzNzsKLQl3YXRj
aGVzID0gVHJpZS5jcmVhdGUgKCkKKwl3YXRjaGVzID0gVHJpZS5jcmVhdGUg
KCk7CisJaGFzX3BlbmRpbmdfd2F0Y2hldmVudHMgPSBDb25uZWN0aW9uLldh
dGNoLlNldC5lbXB0eTsKIH0KIAorbGV0IGdldF9jYXBhY2l0eSAoKSA9CisJ
KCogbm90IG11bHRpcGxpZWQgYnkgbWF4d2F0Y2ggb24gcHVycG9zZTogMm5k
IHF1ZXVlIGluIHdhdGNoIGl0c2VsZiEgKikKKwl7IFhlbmJ1cy5YYi5tYXhv
dXRzdGFuZGluZyA9ICFEZWZpbmUubWF4b3V0c3RhbmRpbmc7IG1heHdhdGNo
ZXZlbnRzID0gIURlZmluZS5tYXh3YXRjaGV2ZW50cyB9CisKIGxldCBhZGRf
YW5vbnltb3VzIGNvbnMgZmQgX2Nhbl93cml0ZSA9Ci0JbGV0IHhiY29uID0g
WGVuYnVzLlhiLm9wZW5fZmQgZmQgaW4KKwlsZXQgY2FwYWNpdHkgPSBnZXRf
Y2FwYWNpdHkgKCkgaW4KKwlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9m
ZCBmZCB+Y2FwYWNpdHkgaW4KIAlsZXQgY29uID0gQ29ubmVjdGlvbi5jcmVh
dGUgeGJjb24gTm9uZSBpbgogCUhhc2h0YmwuYWRkIGNvbnMuYW5vbnltb3Vz
IChYZW5idXMuWGIuZ2V0X2ZkIHhiY29uKSBjb24KIAogbGV0IGFkZF9kb21h
aW4gY29ucyBkb20gPQotCWxldCB4YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX21t
YXAgKERvbWFpbi5nZXRfaW50ZXJmYWNlIGRvbSkgKGZ1biAoKSAtPiBEb21h
aW4ubm90aWZ5IGRvbSkgaW4KKwlsZXQgY2FwYWNpdHkgPSBnZXRfY2FwYWNp
dHkgKCkgaW4KKwlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9tbWFwIH5j
YXBhY2l0eSAoRG9tYWluLmdldF9pbnRlcmZhY2UgZG9tKSAoZnVuICgpIC0+
IERvbWFpbi5ub3RpZnkgZG9tKSBpbgogCWxldCBjb24gPSBDb25uZWN0aW9u
LmNyZWF0ZSB4YmNvbiAoU29tZSBkb20pIGluCiAJSGFzaHRibC5hZGQgY29u
cy5kb21haW5zIChEb21haW4uZ2V0X2lkIGRvbSkgY29uOwogCW1hdGNoIERv
bWFpbi5nZXRfcG9ydCBkb20gd2l0aApAQCAtNDgsNyArNTYsOSBAQCBsZXQg
c2VsZWN0ID8ob25seV9pZiA9IChmdW4gXyAtPiB0cnVlKSkgY29ucyA9CiAJ
SGFzaHRibC5mb2xkIChmdW4gXyBjb24gKGlucywgb3V0cykgLT4KIAkJaWYg
KG9ubHlfaWYgY29uKSB0aGVuICgKIAkJCWxldCBmZCA9IENvbm5lY3Rpb24u
Z2V0X2ZkIGNvbiBpbgotCQkJKGZkIDo6IGlucywgIGlmIENvbm5lY3Rpb24u
aGFzX291dHB1dCBjb24gdGhlbiBmZCA6OiBvdXRzIGVsc2Ugb3V0cykKKwkJ
CWxldCBpbl9mZHMgPSBpZiBDb25uZWN0aW9uLmNhbl9pbnB1dCBjb24gdGhl
biBmZCA6OiBpbnMgZWxzZSBpbnMgaW4KKwkJCWxldCBvdXRfZmRzID0gaWYg
Q29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0aGVuIGZkIDo6IG91dHMgZWxz
ZSBvdXRzIGluCisJCQlpbl9mZHMsIG91dF9mZHMKIAkJKSBlbHNlIChpbnMs
IG91dHMpCiAJKQogCWNvbnMuYW5vbnltb3VzIChbXSwgW10pCkBAIC02Nywx
MCArNzcsMTcgQEAgbGV0IGRlbF93YXRjaGVzX29mX2NvbiBjb24gd2F0Y2hl
cyA9CiAJfCBbXSAtPiBOb25lCiAJfCB3cyAtPiBTb21lIHdzCiAKK2xldCBk
ZWxfd2F0Y2hlcyBjb25zIGNvbiA9CisJQ29ubmVjdGlvbi5kZWxfd2F0Y2hl
cyBjb247CisJY29ucy53YXRjaGVzIDwtIFRyaWUubWFwIChkZWxfd2F0Y2hl
c19vZl9jb24gY29uKSBjb25zLndhdGNoZXM7CisJY29ucy5oYXNfcGVuZGlu
Z193YXRjaGV2ZW50cyA8LQorCQljb25zLmhhc19wZW5kaW5nX3dhdGNoZXZl
bnRzIHw+IENvbm5lY3Rpb24uV2F0Y2guU2V0LmZpbHRlciBAQCBmdW4gdyAt
PgorCQlDb25uZWN0aW9uLmdldF9jb24gdyAhPSBjb24KKwogbGV0IGRlbF9h
bm9ueW1vdXMgY29ucyBjb24gPQogCXRyeQogCQlIYXNodGJsLnJlbW92ZSBj
b25zLmFub255bW91cyAoQ29ubmVjdGlvbi5nZXRfZmQgY29uKTsKLQkJY29u
cy53YXRjaGVzIDwtIFRyaWUubWFwIChkZWxfd2F0Y2hlc19vZl9jb24gY29u
KSBjb25zLndhdGNoZXM7CisJCWRlbF93YXRjaGVzIGNvbnMgY29uOwogCQlD
b25uZWN0aW9uLmNsb3NlIGNvbgogCXdpdGggZXhuIC0+CiAJCWRlYnVnICJk
ZWwgYW5vbnltb3VzICVzIiAoUHJpbnRleGMudG9fc3RyaW5nIGV4bikKQEAg
LTg1LDcgKzEwMiw3IEBAIGxldCBkZWxfZG9tYWluIGNvbnMgaWQgPQogCQkg
ICAgfCBTb21lIHAgLT4gSGFzaHRibC5yZW1vdmUgY29ucy5wb3J0cyBwCiAJ
CSAgICB8IE5vbmUgLT4gKCkpCiAJCSB8IE5vbmUgLT4gKCkpOwotCQljb25z
LndhdGNoZXMgPC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24p
IGNvbnMud2F0Y2hlczsKKwkJZGVsX3dhdGNoZXMgY29ucyBjb247CiAJCUNv
bm5lY3Rpb24uY2xvc2UgY29uCiAJd2l0aCBleG4gLT4KIAkJZGVidWcgImRl
bCBkb21haW4gJXU6ICVzIiBpZCAoUHJpbnRleGMudG9fc3RyaW5nIGV4bikK
QEAgLTEzNiwzMSArMTUzLDMzIEBAIGxldCBkZWxfd2F0Y2ggY29ucyBjb24g
cGF0aCB0b2tlbiA9CiAJCWNvbnMud2F0Y2hlcyA8LSBUcmllLnNldCBjb25z
LndhdGNoZXMga2V5IHdhdGNoZXM7CiAgCXdhdGNoCiAKLWxldCBkZWxfd2F0
Y2hlcyBjb25zIGNvbiA9Ci0JQ29ubmVjdGlvbi5kZWxfd2F0Y2hlcyBjb247
Ci0JY29ucy53YXRjaGVzIDwtIFRyaWUubWFwIChkZWxfd2F0Y2hlc19vZl9j
b24gY29uKSBjb25zLndhdGNoZXMKLQogKCogcGF0aCBpcyBhYnNvbHV0ZSAq
KQotbGV0IGZpcmVfd2F0Y2hlcyA/b2xkcm9vdCByb290IGNvbnMgcGF0aCBy
ZWN1cnNlID0KK2xldCBmaXJlX3dhdGNoZXMgP29sZHJvb3Qgc291cmNlIHJv
b3QgY29ucyBwYXRoIHJlY3Vyc2UgPQogCWxldCBrZXkgPSBrZXlfb2ZfcGF0
aCBwYXRoIGluCiAJbGV0IHBhdGggPSBTdG9yZS5QYXRoLnRvX3N0cmluZyBw
YXRoIGluCiAJbGV0IHJvb3RzID0gb2xkcm9vdCwgcm9vdCBpbgogCWxldCBm
aXJlX3dhdGNoIF8gPSBmdW5jdGlvbgogCQl8IE5vbmUgICAgICAgICAtPiAo
KQotCQl8IFNvbWUgd2F0Y2hlcyAtPiBMaXN0Lml0ZXIgKGZ1biB3IC0+IENv
bm5lY3Rpb24uZmlyZV93YXRjaCByb290cyB3IHBhdGgpIHdhdGNoZXMKKwkJ
fCBTb21lIHdhdGNoZXMgLT4gTGlzdC5pdGVyIChmdW4gdyAtPiBDb25uZWN0
aW9uLmZpcmVfd2F0Y2ggc291cmNlIHJvb3RzIHcgcGF0aCkgd2F0Y2hlcwog
CWluCiAJbGV0IGZpcmVfcmVjIF94ID0gZnVuY3Rpb24KIAkJfCBOb25lICAg
ICAgICAgLT4gKCkKIAkJfCBTb21lIHdhdGNoZXMgLT4KLQkJCUxpc3QuaXRl
ciAoQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRjaCByb290cykgd2F0Y2hl
cworCQkJTGlzdC5pdGVyIChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNo
IHNvdXJjZSByb290cykgd2F0Y2hlcwogCWluCiAJVHJpZS5pdGVyX3BhdGgg
ZmlyZV93YXRjaCBjb25zLndhdGNoZXMga2V5OwogCWlmIHJlY3Vyc2UgdGhl
bgogCQlUcmllLml0ZXIgZmlyZV9yZWMgKFRyaWUuc3ViIGNvbnMud2F0Y2hl
cyBrZXkpCiAKK2xldCBzZW5kX3dhdGNoZXZlbnRzIGNvbnMgY29uID0KKwlj
b25zLmhhc19wZW5kaW5nX3dhdGNoZXZlbnRzIDwtCisJCWNvbnMuaGFzX3Bl
bmRpbmdfd2F0Y2hldmVudHMgfD4gQ29ubmVjdGlvbi5XYXRjaC5TZXQuZmls
dGVyIENvbm5lY3Rpb24uV2F0Y2guZmx1c2hfZXZlbnRzOworCUNvbm5lY3Rp
b24uc291cmNlX2ZsdXNoX3dhdGNoZXZlbnRzIGNvbgorCiBsZXQgZmlyZV9z
cGVjX3dhdGNoZXMgcm9vdCBjb25zIHNwZWNwYXRoID0KKwlsZXQgc291cmNl
ID0gZmluZF9kb21haW4gY29ucyAwIGluCiAJaXRlciBjb25zIChmdW4gY29u
IC0+Ci0JCUxpc3QuaXRlciAoQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRj
aCAoTm9uZSwgcm9vdCkpIChDb25uZWN0aW9uLmdldF93YXRjaGVzIGNvbiBz
cGVjcGF0aCkpCisJCUxpc3QuaXRlciAoQ29ubmVjdGlvbi5maXJlX3Npbmds
ZV93YXRjaCBzb3VyY2UgKE5vbmUsIHJvb3QpKSAoQ29ubmVjdGlvbi5nZXRf
d2F0Y2hlcyBjb24gc3BlY3BhdGgpKQogCiBsZXQgc2V0X3RhcmdldCBjb25z
IGRvbWFpbiB0YXJnZXRfZG9tYWluID0KIAlsZXQgY29uID0gZmluZF9kb21h
aW4gY29ucyBkb21haW4gaW4KQEAgLTE5NiwzICsyMTUsMTMgQEAgbGV0IGRl
YnVnIGNvbnMgPQogCWxldCBhbm9ueW1vdXMgPSBIYXNodGJsLmZvbGQgKGZ1
biBfIGNvbiBhY2N1IC0+IENvbm5lY3Rpb24uZGVidWcgY29uIDo6IGFjY3Up
IGNvbnMuYW5vbnltb3VzIFtdIGluCiAJbGV0IGRvbWFpbnMgPSBIYXNodGJs
LmZvbGQgKGZ1biBfIGNvbiBhY2N1IC0+IENvbm5lY3Rpb24uZGVidWcgY29u
IDo6IGFjY3UpIGNvbnMuZG9tYWlucyBbXSBpbgogCVN0cmluZy5jb25jYXQg
IiIgKGRvbWFpbnMgQCBhbm9ueW1vdXMpCisKK2xldCBkZWJ1Z193YXRjaGV2
ZW50cyBjb25zIGNvbiA9CisJKCogPT0gKHBoeXNpY2FsIGVxdWFsaXR5KQor
CSAgIGhhcyB0byBiZSB1c2VkIGhlcmUgYmVjYXVzZSB3LmNvbi54Yi5iYWNr
ZW5kIG1pZ2h0IGNvbnRhaW4gYSBbdW5pdC0+dW5pdF0gdmFsdWUgY2F1c2lu
ZyByZWd1bGFyCisJICAgY29tcGFyaXNvbiB0byBmYWlsIGR1ZSB0byBoYXZp
bmcgYSAnZnVuY3Rpb25hbCB2YWx1ZScgd2hpY2ggY2Fubm90IGJlIGNvbXBh
cmVkLgorCSAqKQorCWxldCBzID0gY29ucy5oYXNfcGVuZGluZ193YXRjaGV2
ZW50cyB8PiBDb25uZWN0aW9uLldhdGNoLlNldC5maWx0ZXIgKGZ1biB3IC0+
IHcuY29uID09IGNvbikgaW4KKwlsZXQgcGVuZGluZyA9IHMgfD4gQ29ubmVj
dGlvbi5XYXRjaC5TZXQuZWxlbWVudHMKKwkJfD4gTGlzdC5tYXAgKGZ1biB3
IC0+IENvbm5lY3Rpb24uV2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyB3KSB8
PiBMaXN0LmZvbGRfbGVmdCAoKykgMCBpbgorCVByaW50Zi5zcHJpbnRmICJX
YXRjaGVzIHdpdGggcGVuZGluZyBldmVudHM6ICVkLCBwZW5kaW5nIGV2ZW50
cyB0b3RhbDogJWQiIChDb25uZWN0aW9uLldhdGNoLlNldC5jYXJkaW5hbCBz
KSBwZW5kaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
ZGVmaW5lLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbApp
bmRleCAxYTVkMmYzNGE2NzguLjllNTIzNjcwOTQ3NCAxMDA2NDQKLS0tIGEv
dG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQvZGVmaW5lLm1sCkBAIC0yNSw2ICsyNSwxMyBAQCBs
ZXQgZGVmYXVsdF9jb25maWdfZGlyID0gUGF0aHMueGVuX2NvbmZpZ19kaXIK
IGxldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQogbGV0IG1heHRyYW5zYWN0aW9u
ID0gcmVmICgxMCkKIGxldCBtYXhyZXF1ZXN0cyA9IHJlZiAoMTAyNCkgICAo
KiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAqKQorbGV0IG1h
eG91dHN0YW5kaW5nID0gcmVmICgxMDI0KSAoKiBtYXhpbXVtIG91dHN0YW5k
aW5nIHJlcXVlc3RzLCBpLmUuIGluLWZsaWdodCByZXF1ZXN0cyAvIGRvbWFp
biAqKQorbGV0IG1heHdhdGNoZXZlbnRzID0gcmVmICgxMDI0KQorKCoKKwlt
YXhpbXVtIG91dHN0YW5kaW5nIHdhdGNoIGV2ZW50cyBwZXIgd2F0Y2gsCisJ
cmVjb21tZW5kZWQgPj0gbWF4b3V0c3RhbmRpbmcgdG8gYXZvaWQgYmxvY2tp
bmcgYmFja2VuZCB0cmFuc2FjdGlvbnMgZHVlIHRvCisJbWFsaWNpb3VzIGZy
b250ZW5kcworICopCiAKIGxldCBnY19tYXhfb3ZlcmhlYWQgPSByZWYgMTIw
ICgqIDEyMCUgc2VlIGNvbW1lbnQgaW4geGVuc3RvcmVkLm1sICopCiBsZXQg
Y29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmluIGIvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL294ZW5zdG9yZWQuY29uZi5pbgppbmRleCA0
YWU0OGU0MmQ0N2QuLjlkMDM0ZTc0NGI0YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL294ZW5zdG9yZWQuY29uZi5pbgorKysgYi90b29s
cy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmluCkBAIC02Miw2
ICs2Miw4IEBAIHF1b3RhLW1heHdhdGNoID0gMTAwCiBxdW90YS10cmFuc2Fj
dGlvbiA9IDEwCiBxdW90YS1tYXhyZXF1ZXN0cyA9IDEwMjQKIHF1b3RhLXBh
dGgtbWF4ID0gMTAyNAorcXVvdGEtbWF4b3V0c3RhbmRpbmcgPSAxMDI0Citx
dW90YS1tYXh3YXRjaGV2ZW50cyA9IDEwMjQKIAogIyBBY3RpdmF0ZSBmaWxl
ZCBiYXNlIGJhY2tlbmQKIHBlcnNpc3RlbnQgPSBmYWxzZQpkaWZmIC0tZ2l0
IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Byb2Nlc3MubWwgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbAppbmRleCBhNzI4MTBkMDZmNDMu
LjA4MmM5M2ZhOWQzZiAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL3Byb2Nlc3MubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3By
b2Nlc3MubWwKQEAgLTU2LDcgKzU2LDcgQEAgbGV0IHNwbGl0X29uZV9wYXRo
IGRhdGEgY29uID0KIAl8IHBhdGggOjogIiIgOjogW10gLT4gU3RvcmUuUGF0
aC5jcmVhdGUgcGF0aCAoQ29ubmVjdGlvbi5nZXRfcGF0aCBjb24pCiAJfCBf
ICAgICAgICAgICAgICAgIC0+IHJhaXNlIEludmFsaWRfQ21kX0FyZ3MKIAot
bGV0IHByb2Nlc3Nfd2F0Y2ggdCBjb25zID0KK2xldCBwcm9jZXNzX3dhdGNo
IHNvdXJjZSB0IGNvbnMgPQogCWxldCBvbGRyb290ID0gdC5UcmFuc2FjdGlv
bi5vbGRyb290IGluCiAJbGV0IG5ld3Jvb3QgPSBTdG9yZS5nZXRfcm9vdCB0
LnN0b3JlIGluCiAJbGV0IG9wcyA9IFRyYW5zYWN0aW9uLmdldF9wYXRocyB0
IHw+IExpc3QucmV2IGluCkBAIC02Niw4ICs2Niw5IEBAIGxldCBwcm9jZXNz
X3dhdGNoIHQgY29ucyA9CiAJCXwgWGVuYnVzLlhiLk9wLlJtICAgICAgIC0+
IHRydWUsIE5vbmUsIG9sZHJvb3QKIAkJfCBYZW5idXMuWGIuT3AuU2V0cGVy
bXMgLT4gZmFsc2UsIFNvbWUgb2xkcm9vdCwgbmV3cm9vdAogCQl8IF8gICAg
ICAgICAgICAgIC0+IHJhaXNlIChGYWlsdXJlICJodWggPyIpIGluCi0JCUNv
bm5lY3Rpb25zLmZpcmVfd2F0Y2hlcyA/b2xkcm9vdCByb290IGNvbnMgKHNu
ZCBvcCkgcmVjdXJzZSBpbgotCUxpc3QuaXRlciAoZnVuIG9wIC0+IGRvX29w
X3dhdGNoIG9wIGNvbnMpIG9wcworCQlDb25uZWN0aW9ucy5maXJlX3dhdGNo
ZXMgP29sZHJvb3Qgc291cmNlIHJvb3QgY29ucyAoc25kIG9wKSByZWN1cnNl
IGluCisJTGlzdC5pdGVyIChmdW4gb3AgLT4gZG9fb3Bfd2F0Y2ggb3AgY29u
cykgb3BzOworCUNvbm5lY3Rpb25zLnNlbmRfd2F0Y2hldmVudHMgY29ucyBz
b3VyY2UKIAogbGV0IGNyZWF0ZV9pbXBsaWNpdF9wYXRoIHQgcGVybSBwYXRo
ID0KIAlsZXQgZGlybmFtZSA9IFN0b3JlLlBhdGguZ2V0X3BhcmVudCBwYXRo
IGluCkBAIC05OSw2ICsxMDAsMjAgQEAgbGV0IGRvX2RlYnVnIGNvbiB0IF9k
b21haW5zIGNvbnMgZGF0YSA9CiAJfCAid2F0Y2hlcyIgOjogXyAtPgogCQls
ZXQgd2F0Y2hlcyA9IENvbm5lY3Rpb25zLmRlYnVnIGNvbnMgaW4KIAkJU29t
ZSAod2F0Y2hlcyBeICJcMDAwIikKKwl8ICJ4ZW5idXMiIDo6IGRvbWlkIDo6
IF8gLT4KKwkJbGV0IGRvbWlkID0gaW50X29mX3N0cmluZyBkb21pZCBpbgor
CQlsZXQgY29uID0gQ29ubmVjdGlvbnMuZmluZF9kb21haW4gY29ucyBkb21p
ZCBpbgorCQlsZXQgcyA9IFByaW50Zi5zcHJpbnRmICJ4ZW5idXM6ICVzOyBv
dmVyZmxvdyBxdWV1ZSBsZW5ndGg6ICVkLCBjYW5faW5wdXQ6ICViLCBoYXNf
bW9yZV9pbnB1dDogJWIsIGhhc19vbGRfb3V0cHV0OiAlYiwgaGFzX25ld19v
dXRwdXQ6ICViLCBoYXNfbW9yZV93b3JrOiAlYi4gcGVuZGluZzogJXMiCisJ
CQkoWGVuYnVzLlhiLmRlYnVnIGNvbi54YikKKwkJCShDb25uZWN0aW9uLnNv
dXJjZV9wZW5kaW5nX3dhdGNoZXZlbnRzIGNvbikKKwkJCShDb25uZWN0aW9u
LmNhbl9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfbW9yZV9pbnB1
dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfb2xkX291dHB1dCBjb24pCisJ
CQkoQ29ubmVjdGlvbi5oYXNfbmV3X291dHB1dCBjb24pCisJCQkoQ29ubmVj
dGlvbi5oYXNfbW9yZV93b3JrIGNvbikKKwkJCShDb25uZWN0aW9ucy5kZWJ1
Z193YXRjaGV2ZW50cyBjb25zIGNvbikKKwkJaW4KKwkJU29tZSBzCiAJfCAi
bWZuIiA6OiBkb21pZCA6OiBfIC0+CiAJCWxldCBkb21pZCA9IGludF9vZl9z
dHJpbmcgZG9taWQgaW4KIAkJbGV0IGNvbiA9IENvbm5lY3Rpb25zLmZpbmRf
ZG9tYWluIGNvbnMgZG9taWQgaW4KQEAgLTIwNyw3ICsyMjIsNyBAQCBsZXQg
cmVwbHlfYWNrIGZjdCBjb24gdCBkb21zIGNvbnMgZGF0YSA9CiAJZmN0IGNv
biB0IGRvbXMgY29ucyBkYXRhOwogCVBhY2tldC5BY2sgKGZ1biAoKSAtPgog
CQlpZiBUcmFuc2FjdGlvbi5nZXRfaWQgdCA9IFRyYW5zYWN0aW9uLm5vbmUg
dGhlbgotCQkJcHJvY2Vzc193YXRjaCB0IGNvbnMKKwkJCXByb2Nlc3Nfd2F0
Y2ggY29uIHQgY29ucwogCSkKIAogbGV0IHJlcGx5X2RhdGEgZmN0IGNvbiB0
IGRvbXMgY29ucyBkYXRhID0KQEAgLTM2Niw3ICszODEsNyBAQCBsZXQgZG9f
d2F0Y2ggY29uIHQgX2RvbWFpbnMgY29ucyBkYXRhID0KIAlQYWNrZXQuQWNr
IChmdW4gKCkgLT4KIAkJKCogeGVuc3RvcmUudHh0IHNheXMgdGhpcyB3YXRj
aCBpcyBmaXJlZCBpbW1lZGlhdGVseSwKIAkJICAgaW1wbHlpbmcgZXZlbiBp
ZiBwYXRoIGRvZXNuJ3QgZXhpc3Qgb3IgaXMgdW5yZWFkYWJsZSAqKQotCQlD
b25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCB3YXRjaCkK
KwkJQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRjaF91bmNoZWNrZWQgY29u
IHdhdGNoKQogCiBsZXQgZG9fdW53YXRjaCBjb24gX3QgX2RvbWFpbnMgY29u
cyBkYXRhID0KIAlsZXQgKG5vZGUsIHRva2VuKSA9CkBAIC0zOTcsNyArNDEy
LDcgQEAgbGV0IGRvX3RyYW5zYWN0aW9uX2VuZCBjb24gdCBkb21haW5zIGNv
bnMgZGF0YSA9CiAJaWYgbm90IHN1Y2Nlc3MgdGhlbgogCQlyYWlzZSBUcmFu
c2FjdGlvbl9hZ2FpbjsKIAlpZiBjb21taXQgdGhlbiBiZWdpbgotCQlwcm9j
ZXNzX3dhdGNoIHQgY29uczsKKwkJcHJvY2Vzc193YXRjaCBjb24gdCBjb25z
OwogCQltYXRjaCB0LlRyYW5zYWN0aW9uLnR5IHdpdGgKIAkJfCBUcmFuc2Fj
dGlvbi5ObyAtPgogCQkJKCkgKCogbm8gbmVlZCB0byByZWNvcmQgYW55dGhp
bmcgKikKQEAgLTU2NCw3ICs1NzksOCBAQCBsZXQgcHJvY2Vzc19wYWNrZXQg
fnN0b3JlIH5jb25zIH5kb21zIH5jb24gfnJlcSA9CiBsZXQgZG9faW5wdXQg
c3RvcmUgY29ucyBkb21zIGNvbiA9CiAJbGV0IG5ld3BhY2tldCA9CiAJCXRy
eQotCQkJQ29ubmVjdGlvbi5kb19pbnB1dCBjb24KKwkJCWlmIENvbm5lY3Rp
b24uY2FuX2lucHV0IGNvbiB0aGVuIENvbm5lY3Rpb24uZG9faW5wdXQgY29u
CisJCQllbHNlIE5vbmUKIAkJd2l0aCBYZW5idXMuWGIuUmVjb25uZWN0IC0+
CiAJCQlpbmZvICIlcyByZXF1ZXN0cyBhIHJlY29ubmVjdCIgKENvbm5lY3Rp
b24uZ2V0X2RvbXN0ciBjb24pOwogCQkJSGlzdG9yeS5yZWNvbm5lY3QgY29u
OwpAQCAtNTkyLDYgKzYwOCw3IEBAIGxldCBkb19pbnB1dCBzdG9yZSBjb25z
IGRvbXMgY29uID0KIAkJQ29ubmVjdGlvbi5pbmNyX29wcyBjb24KIAogbGV0
IGRvX291dHB1dCBfc3RvcmUgX2NvbnMgX2RvbXMgY29uID0KKwlDb25uZWN0
aW9uLnNvdXJjZV9mbHVzaF93YXRjaGV2ZW50cyBjb247CiAJaWYgQ29ubmVj
dGlvbi5oYXNfb3V0cHV0IGNvbiB0aGVuICgKIAkJaWYgQ29ubmVjdGlvbi5o
YXNfbmV3X291dHB1dCBjb24gdGhlbiAoCiAJCQlsZXQgcGFja2V0ID0gQ29u
bmVjdGlvbi5wZWVrX291dHB1dCBjb24gaW4KZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL3hlbnN0b3JlZC94ZW5zdG9yZWQubWwgYi90b29scy9vY2FtbC94
ZW5zdG9yZWQveGVuc3RvcmVkLm1sCmluZGV4IDBiNjM0M2RmYzc4OS4uNGY4
ZmFiMmRkMTNhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
eGVuc3RvcmVkLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC94ZW5z
dG9yZWQubWwKQEAgLTEwMiw2ICsxMDIsOCBAQCBsZXQgcGFyc2VfY29uZmln
IGZpbGVuYW1lID0KIAkJKCJxdW90YS1tYXhlbnRpdHkiLCBDb25maWcuU2V0
X2ludCBRdW90YS5tYXhlbnQpOwogCQkoInF1b3RhLW1heHNpemUiLCBDb25m
aWcuU2V0X2ludCBRdW90YS5tYXhzaXplKTsKIAkJKCJxdW90YS1tYXhyZXF1
ZXN0cyIsIENvbmZpZy5TZXRfaW50IERlZmluZS5tYXhyZXF1ZXN0cyk7CisJ
CSgicXVvdGEtbWF4b3V0c3RhbmRpbmciLCBDb25maWcuU2V0X2ludCBEZWZp
bmUubWF4b3V0c3RhbmRpbmcpOworCQkoInF1b3RhLW1heHdhdGNoZXZlbnRz
IiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHdhdGNoZXZlbnRzKTsKIAkJ
KCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50IERlZmluZS5wYXRo
X21heCk7CiAJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29uZmlnLlNldF9pbnQg
RGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVzdC1lYWdhaW4iLCBD
b25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9lYWdhaW4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-oxenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-oxenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSBiNWJiODBhMGFkMTliZDE1ZjYxMTU4NjFlYmIzMWY0MWFkNzliYTAw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFRodSwgMjkgU2VwIDIwMjIgMTM6
MDc6MzUgKzAyMDAKU3ViamVjdDogU1VQUE9SVC5tZDogY2xhcmlmeSBzdXBw
b3J0IG9mIHVudHJ1c3RlZCBkcml2ZXIgZG9tYWlucyB3aXRoCiBveGVuc3Rv
cmVkCgpBZGQgYSBzdXBwb3J0IHN0YXRlbWVudCBmb3IgdGhlIHNjb3BlIG9m
IHN1cHBvcnQgcmVnYXJkaW5nIGRpZmZlcmVudApYZW5zdG9yZSB2YXJpYW50
cy4gRXNwZWNpYWxseSBveGVuc3RvcmVkIGRvZXMgbm90ICh5ZXQpIGhhdmUg
c2VjdXJpdHkKc3VwcG9ydCBvZiB1bnRydXN0ZWQgZHJpdmVyIGRvbWFpbnMs
IGFzIHRob3NlIG1pZ2h0IGRyaXZlIG94ZW5zdG9yZWQKb3V0IG9mIG1lbW9y
eSBieSBjcmVhdGluZyBsb3RzIG9mIHdhdGNoIGV2ZW50cyBmb3IgdGhlIGd1
ZXN0cyB0aGV5IGFyZQpzZXJ2aWNpbmcuCgpBZGQgYSBzdGF0ZW1lbnQgcmVn
YXJkaW5nIExpdmUgVXBkYXRlIHN1cHBvcnQgb2Ygb3hlbnN0b3JlZC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBD
aHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+
CgpkaWZmIC0tZ2l0IGEvU1VQUE9SVC5tZCBiL1NVUFBPUlQubWQKaW5kZXgg
M2Y0YTAxMTAxZTUzLi4yZGIzNDFjMWQ4NTMgMTAwNjQ0Ci0tLSBhL1NVUFBP
UlQubWQKKysrIGIvU1VQUE9SVC5tZApAQCAtMTQ5LDYgKzE0OSwxNyBAQCBP
dXRwdXQgb2YgaW5mb3JtYXRpb24gaW4gbWFjaGluZS1wYXJzZWFibGUgSlNP
TiBmb3JtYXQKIAogICAgIFN0YXR1czogU3VwcG9ydGVkCiAKKyMjIFhlbnN0
b3JlCisKKyMjIyBDIHhlbnN0b3JlZCBkYWVtb24KKworICAgIFN0YXR1czog
U3VwcG9ydGVkCisKKyMjIyBPQ2FtbCB4ZW5zdG9yZWQgZGFlbW9uCisKKyAg
ICBTdGF0dXM6IFN1cHBvcnRlZAorICAgIFN0YXR1cywgdW50cnVzdGVkIGRy
aXZlciBkb21haW5zOiBTdXBwb3J0ZWQsIG5vdCBzZWN1cml0eSBzdXBwb3J0
ZWQKKwogIyMgVG9vbHN0YWNrLzNyZCBwYXJ0eQogCiAjIyMgbGlidmlydCBk
cml2ZXIgZm9yIHhsCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSA0MTc2M2NhNGM3ODg2Mzg3NTFmYjU1NTJiNjBjYzkzMmMzNzViYmI5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNwbGl0IHVw
IHNlbmRfcmVwbHkoKQoKVG9kYXkgc2VuZF9yZXBseSgpIGlzIHVzZWQgZm9y
IGJvdGgsIG5vcm1hbCByZXF1ZXN0IHJlcGxpZXMgYW5kIHdhdGNoCmV2ZW50
cy4KClNwbGl0IGl0IHVwIGludG8gc2VuZF9yZXBseSgpIGFuZCBzZW5kX2V2
ZW50KCkuIFRoaXMgd2lsbCBiZSB1c2VkIHRvCmFkZCBzb21lIGV2ZW50IHNw
ZWNpZmljIGhhbmRsaW5nLgoKYWRkX2V2ZW50KCkgY2FuIGJlIG1lcmdlZCBp
bnRvIHNlbmRfZXZlbnQoKSwgcmVtb3ZpbmcgdGhlIG5lZWQgZm9yIGFuCmlu
dGVybWVkaWF0ZSBtZW1vcnkgYWxsb2NhdGlvbi4KClRoaXMgaXMgcGFydCBv
ZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdy
YWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9j
b3JlLmMKaW5kZXggZTBkNmQyM2YzYjc2Li45N2ZmMzVjZDJiMTEgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNjcyLDQ5ICs2
NzIsMzIgQEAgc3RhdGljIHZvaWQgc2VuZF9lcnJvcihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgaW50IGVycm9yKQogdm9pZCBzZW5kX3JlcGx5KHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlw
ZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbikKIHsK
LQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7CisJc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmJkYXRhID0gY29ubi0+aW47CisKKwlhc3NlcnQodHlwZSAh
PSBYU19XQVRDSF9FVkVOVCk7CiAKIAlpZiAoIGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYICkgewogCQlzZW5kX2Vycm9yKGNvbm4sIEUyQklHKTsKIAkJ
cmV0dXJuOwogCX0KIAotCS8qIFJlcGxpZXMgcmV1c2UgdGhlIHJlcXVlc3Qg
YnVmZmVyLCBldmVudHMgbmVlZCBhIG5ldyBvbmUuICovCi0JaWYgKHR5cGUg
IT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJYmRhdGEgPSBjb25uLT5pbjsKLQkJ
LyogRHJvcCBhc3luY2hyb25vdXMgcmVzcG9uc2VzLCBlLmcuIGVycm9ycyBm
b3Igd2F0Y2ggZXZlbnRzLiAqLwotCQlpZiAoIWJkYXRhKQotCQkJcmV0dXJu
OwotCQliZGF0YS0+aW5oZHIgPSB0cnVlOwotCQliZGF0YS0+dXNlZCA9IDA7
Ci0JCWNvbm4tPmluID0gTlVMTDsKLQl9IGVsc2UgewotCQkvKiBNZXNzYWdl
IGlzIGEgY2hpbGQgb2YgdGhlIGNvbm5lY3Rpb24gZm9yIGF1dG8tY2xlYW51
cC4gKi8KLQkJYmRhdGEgPSBuZXdfYnVmZmVyKGNvbm4pOworCWlmICghYmRh
dGEpCisJCXJldHVybjsKKwliZGF0YS0+aW5oZHIgPSB0cnVlOworCWJkYXRh
LT51c2VkID0gMDsKIAotCQkvKgotCQkgKiBBbGxvY2F0aW9uIGZhaWx1cmUg
aGVyZSBpcyB1bmZvcnR1bmF0ZTogd2UgaGF2ZSBubyB3YXkgdG8KLQkJICog
dGVsbCBhbnlib2R5IGFib3V0IGl0LgotCQkgKi8KLQkJaWYgKCFiZGF0YSkK
LQkJCXJldHVybjsKLQl9CiAJaWYgKGxlbiA8PSBERUZBVUxUX0JVRkZFUl9T
SVpFKQogCQliZGF0YS0+YnVmZmVyID0gYmRhdGEtPmRlZmF1bHRfYnVmZmVy
OwotCWVsc2UKKwllbHNlIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IHRhbGxvY19h
cnJheShiZGF0YSwgY2hhciwgbGVuKTsKLQlpZiAoIWJkYXRhLT5idWZmZXIp
IHsKLQkJaWYgKHR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJCS8qIFNh
bWUgYXMgYWJvdmU6IG5vIHdheSB0byB0ZWxsIHNvbWVvbmUuICovCi0JCQl0
YWxsb2NfZnJlZShiZGF0YSk7CisJCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQkJc2VuZF9lcnJvcihjb25uLCBFTk9NRU0pOwogCQkJcmV0dXJuOwogCQl9
Ci0JCS8qIHJlLWVzdGFibGlzaCByZXF1ZXN0IGJ1ZmZlciBmb3Igc2VuZGlu
ZyBFTk9NRU0uICovCi0JCWNvbm4tPmluID0gYmRhdGE7Ci0JCXNlbmRfZXJy
b3IoY29ubiwgRU5PTUVNKTsKLQkJcmV0dXJuOwogCX0KIAorCWNvbm4tPmlu
ID0gTlVMTDsKKwogCS8qIFVwZGF0ZSByZWxldmFudCBoZWFkZXIgZmllbGRz
IGFuZCBmaWxsIGluIHRoZSBtZXNzYWdlIGJvZHkuICovCiAJYmRhdGEtPmhk
ci5tc2cudHlwZSA9IHR5cGU7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVu
OwpAQCAtNzIyLDggKzcwNSwzOSBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBl
LAogCiAJLyogUXVldWUgZm9yIGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAls
aXN0X2FkZF90YWlsKCZiZGF0YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsK
K30KIAotCXJldHVybjsKKy8qCisgKiBTZW5kIGEgd2F0Y2ggZXZlbnQuCisg
KiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSByZWxhdGVkIHRvIHRoZSBjdXJy
ZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBiZQorICogcmVwb3J0ZWQuCisg
Ki8KK3ZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pCit7CisJc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhOworCXVuc2lnbmVkIGludCBsZW47
CisKKwlsZW4gPSBzdHJsZW4ocGF0aCkgKyAxICsgc3RybGVuKHRva2VuKSAr
IDE7CisJLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4g
Ki8KKwlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCisJCXJldHVy
bjsKKworCWJkYXRhID0gbmV3X2J1ZmZlcihjb25uKTsKKwlpZiAoIWJkYXRh
KQorCQlyZXR1cm47CisKKwliZGF0YS0+YnVmZmVyID0gdGFsbG9jX2FycmF5
KGJkYXRhLCBjaGFyLCBsZW4pOworCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQl0YWxsb2NfZnJlZShiZGF0YSk7CisJCXJldHVybjsKKwl9CisJc3RyY3B5
KGJkYXRhLT5idWZmZXIsIHBhdGgpOworCXN0cmNweShiZGF0YS0+YnVmZmVy
ICsgc3RybGVuKHBhdGgpICsgMSwgdG9rZW4pOworCWJkYXRhLT5oZHIubXNn
LnR5cGUgPSBYU19XQVRDSF9FVkVOVDsKKwliZGF0YS0+aGRyLm1zZy5sZW4g
PSBsZW47CisKKwkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAq
LworCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xp
c3QpOwogfQogCiAvKiBTb21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0
YykganVzdCBuZWVkIGEgbm9uLWVycm9yIHJldHVybiAqLwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggOTM2OWM0Y2JmZDI2Li4y
YjBmNzk2ZDliYjEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaApAQCAtMTUwLDYgKzE1MCw3IEBAIHVuc2lnbmVkIGludCBnZXRfc3Ry
aW5ncyhzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqZGF0YSwKIAogdm9pZCBzZW5k
X3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2Nr
bXNnX3R5cGUgdHlwZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQg
aW50IGxlbik7Cit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsK
IAogLyogU29tZSByb3V0aW5lcyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3Qg
bmVlZCBhIG5vbi1lcnJvciByZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0
eXBlKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5k
ZXggOWZmMjA2OTBjMDAwLi42ZDgwOTczNzZlNDcgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCkBAIC03MiwzNyArNzIsMTcgQEAg
c3RhdGljIGJvb2wgaXNfY2hpbGQoY29uc3QgY2hhciAqY2hpbGQsIGNvbnN0
IGNoYXIgKnBhcmVudCkKIAlyZXR1cm4gY2hpbGRbbGVuXSA9PSAnLycgfHwg
Y2hpbGRbbGVuXSA9PSAnXDAnOwogfQogCi0vKgotICogU2VuZCBhIHdhdGNo
IGV2ZW50LgotICogVGVtcG9yYXJ5IG1lbW9yeSBhbGxvY2F0aW9ucyBhcmUg
ZG9uZSB3aXRoIGN0eC4KLSAqLwotc3RhdGljIHZvaWQgYWRkX2V2ZW50KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLAotCQkgICAgICBjb25zdCB2b2lkICpj
dHgsCi0JCSAgICAgIHN0cnVjdCB3YXRjaCAqd2F0Y2gsCi0JCSAgICAgIGNv
bnN0IGNoYXIgKm5hbWUpCitzdGF0aWMgY29uc3QgY2hhciAqZ2V0X3dhdGNo
X3BhdGgoY29uc3Qgc3RydWN0IHdhdGNoICp3YXRjaCwgY29uc3QgY2hhciAq
bmFtZSkKIHsKLQkvKiBEYXRhIHRvIHNlbmQgKG5vZGVcMHRva2VuXDApLiAq
LwotCXVuc2lnbmVkIGludCBsZW47Ci0JY2hhciAqZGF0YTsKKwljb25zdCBj
aGFyICpwYXRoID0gbmFtZTsKIAogCWlmICh3YXRjaC0+cmVsYXRpdmVfcGF0
aCkgewotCQluYW1lICs9IHN0cmxlbih3YXRjaC0+cmVsYXRpdmVfcGF0aCk7
Ci0JCWlmICgqbmFtZSA9PSAnLycpIC8qIENvdWxkIGJlICIiICovCi0JCQlu
YW1lKys7CisJCXBhdGggKz0gc3RybGVuKHdhdGNoLT5yZWxhdGl2ZV9wYXRo
KTsKKwkJaWYgKCpwYXRoID09ICcvJykgLyogQ291bGQgYmUgIiIgKi8KKwkJ
CXBhdGgrKzsKIAl9CiAKLQlsZW4gPSBzdHJsZW4obmFtZSkgKyAxICsgc3Ry
bGVuKHdhdGNoLT50b2tlbikgKyAxOwotCS8qIERvbid0IHRyeSB0byBzZW5k
IG92ZXItbG9uZyBldmVudHMuICovCi0JaWYgKGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYKQotCQlyZXR1cm47Ci0KLQlkYXRhID0gdGFsbG9jX2FycmF5
KGN0eCwgY2hhciwgbGVuKTsKLQlpZiAoIWRhdGEpCi0JCXJldHVybjsKLQlz
dHJjcHkoZGF0YSwgbmFtZSk7Ci0Jc3RyY3B5KGRhdGEgKyBzdHJsZW4obmFt
ZSkgKyAxLCB3YXRjaC0+dG9rZW4pOwotCXNlbmRfcmVwbHkoY29ubiwgWFNf
V0FUQ0hfRVZFTlQsIGRhdGEsIGxlbik7Ci0JdGFsbG9jX2ZyZWUoZGF0YSk7
CisJcmV0dXJuIHBhdGg7CiB9CiAKIC8qCkBAIC0xODEsMTAgKzE2MSwxNCBA
QCB2b2lkIGZpcmVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3Qgdm9pZCAqY3R4LCBjb25zdCBjaGFyICpuYW1lLAogCQlsaXN0X2Zv
cl9lYWNoX2VudHJ5KHdhdGNoLCAmaS0+d2F0Y2hlcywgbGlzdCkgewogCQkJ
aWYgKGV4YWN0KSB7CiAJCQkJaWYgKHN0cmVxKG5hbWUsIHdhdGNoLT5ub2Rl
KSkKLQkJCQkJYWRkX2V2ZW50KGksIGN0eCwgd2F0Y2gsIG5hbWUpOworCQkJ
CQlzZW5kX2V2ZW50KGksCisJCQkJCQkgICBnZXRfd2F0Y2hfcGF0aCh3YXRj
aCwgbmFtZSksCisJCQkJCQkgICB3YXRjaC0+dG9rZW4pOwogCQkJfSBlbHNl
IHsKIAkJCQlpZiAoaXNfY2hpbGQobmFtZSwgd2F0Y2gtPm5vZGUpKQotCQkJ
CQlhZGRfZXZlbnQoaSwgY3R4LCB3YXRjaCwgbmFtZSk7CisJCQkJCXNlbmRf
ZXZlbnQoaSwKKwkJCQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1l
KSwKKwkJCQkJCSAgIHdhdGNoLT50b2tlbik7CiAJCQl9CiAJCX0KIAl9CkBA
IC0yNTIsNyArMjM2LDcgQEAgaW50IGRvX3dhdGNoKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJc2VuZF9h
Y2soY29ubiwgWFNfV0FUQ0gpOwogCiAJLyogV2UgZmlyZSBvbmNlIHVwIGZy
b250OiBzaW1wbGlmaWVzIGNsaWVudHMgYW5kIHJlc3RhcnQuICovCi0JYWRk
X2V2ZW50KGNvbm4sIGluLCB3YXRjaCwgd2F0Y2gtPm5vZGUpOworCXNlbmRf
ZXZlbnQoY29ubiwgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2Rl
KSwgd2F0Y2gtPnRva2VuKTsKIAogCXJldHVybiAwOwogfQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSBlY2EzMTA4ODM0YmYxZDExNWIyNDAyOGY5NDNlYWE3ZTkyNDAzMGNk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBoZWxw
ZXJzIHRvIGZyZWUgc3RydWN0IGJ1ZmZlcmVkX2RhdGEKCkFkZCB0d28gaGVs
cGVycyBmb3IgZnJlZWluZyBzdHJ1Y3QgYnVmZmVyZWRfZGF0YTogZnJlZV9i
dWZmZXJlZF9kYXRhKCkKZm9yIGZyZWVpbmcgb25lIGluc3RhbmNlIGFuZCBj
b25uX2ZyZWVfYnVmZmVyZWRfZGF0YSgpIGZvciBmcmVlaW5nIGFsbAppbnN0
YW5jZXMgZm9yIGEgY29ubmVjdGlvbi4KClRoaXMgaXMgYXZvaWRpbmcgZHVw
bGljYXRlZCBjb2RlIGFuZCB3aWxsIGhlbHAgbGF0ZXIgd2hlbiBtb3JlIGFj
dGlvbnMKYXJlIG5lZWRlZCB3aGVuIGZyZWVpbmcgYSBzdHJ1Y3QgYnVmZmVy
ZWRfZGF0YS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggOTdmZjM1Y2Qy
YjExLi4xMWI4ZDk4NjM0MGYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMjA1LDYgKzIwNSwyMSBAQCB2b2lkIHJlb3Blbl9s
b2codm9pZCkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRf
ZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAorCQkJICAgICAgIHN0
cnVjdCBjb25uZWN0aW9uICpjb25uKQoreworCWxpc3RfZGVsKCZvdXQtPmxp
c3QpOworCXRhbGxvY19mcmVlKG91dCk7Cit9CisKK3ZvaWQgY29ubl9mcmVl
X2J1ZmZlcmVkX2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJ
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKKworCXdoaWxlICgob3V0ID0g
bGlzdF90b3AoJmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSwgbGlzdCkpKQorCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
K30KKwogc3RhdGljIGJvb2wgd3JpdGVfbWVzc2FnZXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaW50IHJldDsKQEAgLTI0OCw4ICsyNjMsNyBA
QCBzdGF0aWMgYm9vbCB3cml0ZV9tZXNzYWdlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXRyYWNlX2lvKGNvbm4sIG91dCwgMSk7CiAKLQlsaXN0
X2RlbCgmb3V0LT5saXN0KTsKLQl0YWxsb2NfZnJlZShvdXQpOworCWZyZWVf
YnVmZmVyZWRfZGF0YShvdXQsIGNvbm4pOwogCiAJcmV0dXJuIHRydWU7CiB9
CkBAIC0xMzg5LDE4ICsxNDAzLDEyIEBAIHN0YXRpYyBzdHJ1Y3QgewogICov
CiBzdGF0aWMgdm9pZCBpZ25vcmVfY29ubmVjdGlvbihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LCAq
dG1wOwotCiAJdHJhY2UoIkNPTk4gJXAgaWdub3JlZFxuIiwgY29ubik7CiAK
IAljb25uLT5pc19pZ25vcmVkID0gdHJ1ZTsKIAljb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcyhjb25uKTsKIAljb25uX2RlbGV0ZV9hbGxfdHJhbnNhY3Rpb25z
KGNvbm4pOwotCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG91dCwgdG1w
LCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsKLQkJbGlzdF9kZWwoJm91dC0+
bGlzdCk7Ci0JCXRhbGxvY19mcmVlKG91dCk7Ci0JfQorCWNvbm5fZnJlZV9i
dWZmZXJlZF9kYXRhKGNvbm4pOwogCiAJdGFsbG9jX2ZyZWUoY29ubi0+aW4p
OwogCWNvbm4tPmluID0gTlVMTDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oCmluZGV4IDJiMGY3OTZkOWJiMS4uODNkNDk2OTNmYzE5IDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKQEAgLTIyNiw2
ICsyMjYsOCBAQCBleHRlcm4geGVuZ250dGFiX2hhbmRsZSAqKnhndF9oYW5k
bGU7CiAKIGludCByZW1lbWJlcl9zdHJpbmcoc3RydWN0IGhhc2h0YWJsZSAq
aGFzaCwgY29uc3QgY2hhciAqc3RyKTsKIAordm9pZCBjb25uX2ZyZWVfYnVm
ZmVyZWRfZGF0YShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CisKICNlbmRp
ZiAvKiBfWEVOU1RPUkVEX0NPUkVfSCAqLwogCiAvKgpkaWZmIC0tZ2l0IGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IGNiZDhlNmI3NDdiZC4u
NDE2YjkyY2FkNGIyIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2RvbWFpbi5jCkBAIC00MDYsMTUgKzQwNiwxMCBAQCBzdGF0aWMgc3RydWN0
IGRvbWFpbiAqZmluZF9kb21haW5fYnlfZG9taWQodW5zaWduZWQgaW50IGRv
bWlkKQogc3RhdGljIHZvaWQgZG9tYWluX2Nvbm5fcmVzZXQoc3RydWN0IGRv
bWFpbiAqZG9tYWluKQogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25uID0g
ZG9tYWluLT5jb25uOwotCXN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQ7CiAK
IAljb25uX2RlbGV0ZV9hbGxfd2F0Y2hlcyhjb25uKTsKIAljb25uX2RlbGV0
ZV9hbGxfdHJhbnNhY3Rpb25zKGNvbm4pOwotCi0Jd2hpbGUgKChvdXQgPSBs
aXN0X3RvcCgmY29ubi0+b3V0X2xpc3QsIHN0cnVjdCBidWZmZXJlZF9kYXRh
LCBsaXN0KSkpIHsKLQkJbGlzdF9kZWwoJm91dC0+bGlzdCk7Ci0JCXRhbGxv
Y19mcmVlKG91dCk7Ci0JfQorCWNvbm5fZnJlZV9idWZmZXJlZF9kYXRhKGNv
bm4pOwogCiAJdGFsbG9jX2ZyZWUoY29ubi0+aW4pOwogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBmMDA4MWRhOWRkNzIxOGY0ODY4NDFkYzZjYWNiZTcxZDJmYzc2MWU4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlZHVjZSBu
dW1iZXIgb2Ygd2F0Y2ggZXZlbnRzCgpXaGVuIHJlbW92aW5nIGEgd2F0Y2hl
ZCBub2RlIG91dHNpZGUgb2YgYSB0cmFuc2FjdGlvbiwgdHdvIHdhdGNoIGV2
ZW50cwphcmUgYmVpbmcgcHJvZHVjZWQgaW5zdGVhZCBvZiBqdXN0IGEgc2lu
Z2xlIG9uZS4KCldoZW4gZmluYWxpemluZyBhIHRyYW5zYWN0aW9uIHdhdGNo
IGV2ZW50cyBjYW4gYmUgZ2VuZXJhdGVkIGZvciBlYWNoCm5vZGUgd2hpY2gg
aXMgYmVpbmcgbW9kaWZpZWQsIGV2ZW4gaWYgb3V0c2lkZSBhIHRyYW5zYWN0
aW9uIHN1Y2gKbW9kaWZpY2F0aW9ucyBtaWdodCBub3QgaGF2ZSByZXN1bHRl
ZCBpbiBhIHdhdGNoIGV2ZW50LgoKVGhpcyBoYXBwZW5zIGUuZy46CgotIGZv
ciBub2RlcyB3aGljaCBhcmUgb25seSBtb2RpZmllZCBkdWUgdG8gYWRkZWQv
cmVtb3ZlZCBjaGlsZCBlbnRyaWVzCi0gZm9yIG5vZGVzIGJlaW5nIHJlbW92
ZWQgb3IgY3JlYXRlZCBpbXBsaWNpdGx5IChlLmcuIGNyZWF0aW9uIG9mIGEv
Yi9jCiAgaXMgaW1wbGljaXRseSBjcmVhdGluZyBhL2IsIHJlc3VsdGluZyBp
biB3YXRjaCBldmVudHMgZm9yIGEsIGEvYiBhbmQKICBhL2IvYyBpbnN0ZWFk
IG9mIGEvYi9jIG9ubHkpCgpBdm9pZCB0aGVzZSBhZGRpdGlvbmFsIHdhdGNo
IGV2ZW50cywgaW4gb3JkZXIgdG8gcmVkdWNlIHRoZSBuZWVkZWQKbWVtb3J5
IGluc2lkZSBYZW5zdG9yZSBmb3IgcXVldWVpbmcgdGhlbS4KClRoaXMgaXMg
YmVpbmcgYWNoaWV2ZWQgYnkgYWRkaW5nIGV2ZW50IGZsYWdzIHRvIHN0cnVj
dCBhY2Nlc3NlZF9ub2RlCnNwZWNpZnlpbmcgd2hldGhlciBhbiBldmVudCBz
aG91bGQgYmUgdHJpZ2dlcmVkLCBhbmQgd2hldGhlciBpdCBzaG91bGQKYmUg
YW4gZXhhY3QgbWF0Y2ggb2YgdGhlIG1vZGlmaWVkIHBhdGguIEJvdGggZmxh
Z3MgY2FuIGJlIHNldCBmcm9tCmZpcmVfd2F0Y2hlcygpIGluc3RlYWQgb2Yg
aW1wbHlpbmcgdGhlbSBvbmx5LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCAxMWI4ZDk4NjM0MGYuLjhmOGQxMGNlZTk1ZSAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMTgwLDcgKzExODAsNyBAQCBz
dGF0aWMgdm9pZCBkZWxldGVfY2hpbGQoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiB9CiAKIHN0YXRpYyBpbnQgZGVsZXRlX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKLQkJICAgICAgIHN0cnVj
dCBub2RlICpwYXJlbnQsIHN0cnVjdCBub2RlICpub2RlKQorCQkgICAgICAg
c3RydWN0IG5vZGUgKnBhcmVudCwgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wg
d2F0Y2hfZXhhY3QpCiB7CiAJY2hhciAqbmFtZTsKIApAQCAtMTE5Miw3ICsx
MTkyLDcgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkJCSAgICAgICBub2Rl
LT5jaGlsZHJlbik7CiAJCWNoaWxkID0gbmFtZSA/IHJlYWRfbm9kZShjb25u
LCBub2RlLCBuYW1lKSA6IE5VTEw7CiAJCWlmIChjaGlsZCkgewotCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQpKQorCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQsIHRydWUpKQog
CQkJCXJldHVybiBlcnJubzsKIAkJfSBlbHNlIHsKIAkJCXRyYWNlKCJkZWxl
dGVfbm9kZTogRXJyb3IgZGVsZXRpbmcgY2hpbGQgJyVzLyVzJyFcbiIsCkBA
IC0xMjA0LDcgKzEyMDQsMTIgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQl0
YWxsb2NfZnJlZShuYW1lKTsKIAl9CiAKLQlmaXJlX3dhdGNoZXMoY29ubiwg
Y3R4LCBub2RlLT5uYW1lLCBub2RlLCB0cnVlLCBOVUxMKTsKKwkvKgorCSAq
IEZpcmUgdGhlIHdhdGNoZXMgbm93LCB3aGVuIHdlIGNhbiBzdGlsbCBzZWUg
dGhlIG5vZGUgcGVybWlzc2lvbnMuCisJICogVGhpcyBmaW5lIGFzIHdlIGFy
ZSBzaW5nbGUgdGhyZWFkZWQgYW5kIHRoZSBuZXh0IHBvc3NpYmxlIHJlYWQg
d2lsbAorCSAqIGJlIGhhbmRsZWQgb25seSBhZnRlciB0aGUgbm9kZSBoYXMg
YmVlbiByZWFsbHkgcmVtb3ZlZC4KKwkgKi8KKwlmaXJlX3dhdGNoZXMoY29u
biwgY3R4LCBub2RlLT5uYW1lLCBub2RlLCB3YXRjaF9leGFjdCwgTlVMTCk7
CiAJZGVsZXRlX25vZGVfc2luZ2xlKGNvbm4sIG5vZGUpOwogCWRlbGV0ZV9j
aGlsZChjb25uLCBwYXJlbnQsIGJhc2VuYW1lKG5vZGUtPm5hbWUpKTsKIAl0
YWxsb2NfZnJlZShub2RlKTsKQEAgLTEyMzAsMTMgKzEyMzUsNyBAQCBzdGF0
aWMgaW50IF9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAkJcmV0dXJuIChlcnJubyA9
PSBFTk9NRU0pID8gRU5PTUVNIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9
IHBhcmVudDsKIAotCS8qCi0JICogRmlyZSB0aGUgd2F0Y2hlcyBub3csIHdo
ZW4gd2UgY2FuIHN0aWxsIHNlZSB0aGUgbm9kZSBwZXJtaXNzaW9ucy4KLQkg
KiBUaGlzIGZpbmUgYXMgd2UgYXJlIHNpbmdsZSB0aHJlYWRlZCBhbmQgdGhl
IG5leHQgcG9zc2libGUgcmVhZCB3aWxsCi0JICogYmUgaGFuZGxlZCBvbmx5
IGFmdGVyIHRoZSBub2RlIGhhcyBiZWVuIHJlYWxseSByZW1vdmVkLgotCSAq
LwotCWZpcmVfd2F0Y2hlcyhjb25uLCBjdHgsIG5hbWUsIG5vZGUsIGZhbHNl
LCBOVUxMKTsKLQlyZXR1cm4gZGVsZXRlX25vZGUoY29ubiwgY3R4LCBwYXJl
bnQsIG5vZGUpOworCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBh
cmVudCwgbm9kZSwgZmFsc2UpOwogfQogCiAKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKaW5kZXggNGZmYTE4MzEx
MTIwLi42ZmJkYjI5ZGNkZDcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCkBAIC0xMzAsNiArMTMwLDEwIEBA
IHN0cnVjdCBhY2Nlc3NlZF9ub2RlCiAKIAkvKiBUcmFuc2FjdGlvbiBub2Rl
IGluIGRhdGEgYmFzZT8gKi8KIAlib29sIHRhX25vZGU7CisKKwkvKiBXYXRj
aCBldmVudCBmbGFncy4gKi8KKwlib29sIGZpcmVfd2F0Y2g7CisJYm9vbCB3
YXRjaF9leGFjdDsKIH07CiAKIHN0cnVjdCBjaGFuZ2VkX2RvbWFpbgpAQCAt
MzMwLDYgKzMzNCwyOSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogfQogCiAvKgorICog
QSB3YXRjaCBldmVudCBzaG91bGQgYmUgZmlyZWQgZm9yIGEgbm9kZSBtb2Rp
ZmllZCBpbnNpZGUgYSB0cmFuc2FjdGlvbi4KKyAqIFNldCB0aGUgY29ycmVz
cG9uZGluZyBpbmZvcm1hdGlvbi4gQSBub24tZXhhY3QgZXZlbnQgaXMgcmVw
bGFjaW5nIGFuIGV4YWN0CisgKiBvbmUsIGJ1dCBub3QgdGhlIG90aGVyIHdh
eSByb3VuZC4KKyAqLwordm9pZCBxdWV1ZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBib29sIHdhdGNoX2V4
YWN0KQoreworCXN0cnVjdCBhY2Nlc3NlZF9ub2RlICppOworCisJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZShjb25uLT50cmFuc2FjdGlvbiwgbmFtZSk7CisJ
aWYgKCFpKSB7CisJCWNvbm4tPnRyYW5zYWN0aW9uLT5mYWlsID0gdHJ1ZTsK
KwkJcmV0dXJuOworCX0KKworCWlmICghaS0+ZmlyZV93YXRjaCkgeworCQlp
LT5maXJlX3dhdGNoID0gdHJ1ZTsKKwkJaS0+d2F0Y2hfZXhhY3QgPSB3YXRj
aF9leGFjdDsKKwl9IGVsc2UgaWYgKCF3YXRjaF9leGFjdCkgeworCQlpLT53
YXRjaF9leGFjdCA9IGZhbHNlOworCX0KK30KKworLyoKICAqIEZpbmFsaXpl
IHRyYW5zYWN0aW9uOgogICogV2FsayB0aHJvdWdoIGFjY2Vzc2VkIG5vZGVz
IGFuZCBjaGVjayBnZW5lcmF0aW9uIGFnYWluc3QgZ2xvYmFsIGRhdGEuCiAg
KiBJZiBhbGwgZW50cmllcyBtYXRjaCwgcmVhZCB0aGUgdHJhbnNhY3Rpb24g
ZW50cmllcyBhbmQgd3JpdGUgdGhlbSB3aXRob3V0CkBAIC0zODMsMTUgKzQx
MCwxNSBAQCBzdGF0aWMgaW50IGZpbmFsaXplX3RyYW5zYWN0aW9uKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJf
Y3R4LCBrZXksIGRhdGEsCiAJCQkJCQlUREJfUkVQTEFDRSk7CiAJCQkJdGFs
bG9jX2ZyZWUoZGF0YS5kcHRyKTsKLQkJCQlpZiAocmV0KQotCQkJCQlnb3Rv
IGVycjsKLQkJCQlmaXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUs
IE5VTEwsIGZhbHNlLAotCQkJCQkgICAgIGktPnBlcm1zLnAgPyAmaS0+cGVy
bXMgOiBOVUxMKTsKIAkJCX0gZWxzZSB7Ci0JCQkJZmlyZV93YXRjaGVzKGNv
bm4sIHRyYW5zLCBpLT5ub2RlLCBOVUxMLCBmYWxzZSwKKwkJCQlyZXQgPSB0
ZGJfZGVsZXRlKHRkYl9jdHgsIGtleSk7CisJCQl9CisJCQlpZiAocmV0KQor
CQkJCWdvdG8gZXJyOworCQkJaWYgKGktPmZpcmVfd2F0Y2gpIHsKKwkJCQlm
aXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUsIE5VTEwsCisJCQkJ
CSAgICAgaS0+d2F0Y2hfZXhhY3QsCiAJCQkJCSAgICAgaS0+cGVybXMucCA/
ICZpLT5wZXJtcyA6IE5VTEwpOwotCQkJCWlmICh0ZGJfZGVsZXRlKHRkYl9j
dHgsIGtleSkpCi0JCQkJCWdvdG8gZXJyOwogCQkJfQogCQl9CiAKZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKaW5k
ZXggMTQwNjI3MzBlM2M5Li4wMDkzY2FjODA3ZTMgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCkBAIC00Miw2
ICs0Miw5IEBAIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlfZGVjKHN0cnVjdCB0
cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBkb21pZCk7CiBpbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAogICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKIAorLyogUXVldWUgd2F0Y2hl
cyBmb3IgYSBtb2RpZmllZCBub2RlLiAqLwordm9pZCBxdWV1ZV93YXRjaGVz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBi
b29sIHdhdGNoX2V4YWN0KTsKKwogLyogUHJlcGVuZCB0aGUgdHJhbnNhY3Rp
b24gdG8gbmFtZSBpZiBhcHByb3ByaWF0ZS4gKi8KIGludCB0cmFuc2FjdGlv
bl9wcmVwZW5kKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgVERCX0RBVEEgKmtl
eSk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0
Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCmluZGV4
IDZkODA5NzM3NmU0Ny4uMmY5MzY3NzY3ZTQ0IDEwMDY0NAotLS0gYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMjksNiArMjksNyBAQAogI2lu
Y2x1ZGUgInhlbnN0b3JlX2xpYi5oIgogI2luY2x1ZGUgInV0aWxzLmgiCiAj
aW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgorI2luY2x1ZGUgInhlbnN0
b3JlZF90cmFuc2FjdGlvbi5oIgogCiBleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CiAKQEAgLTE0Myw5ICsxNDQsMTEgQEAgdm9pZCBm
aXJlX3dhdGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwKIAlzdHJ1Y3QgY29ubmVjdGlv
biAqaTsKIAlzdHJ1Y3Qgd2F0Y2ggKndhdGNoOwogCi0JLyogRHVyaW5nIHRy
YW5zYWN0aW9ucywgZG9uJ3QgZmlyZSB3YXRjaGVzLiAqLwotCWlmIChjb25u
ICYmIGNvbm4tPnRyYW5zYWN0aW9uKQorCS8qIER1cmluZyB0cmFuc2FjdGlv
bnMsIGRvbid0IGZpcmUgd2F0Y2hlcywgYnV0IHF1ZXVlIHRoZW0uICovCisJ
aWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24pIHsKKwkJcXVldWVfd2F0
Y2hlcyhjb25uLCBuYW1lLCBleGFjdCk7CiAJCXJldHVybjsKKwl9CiAKIAkv
KiBDcmVhdGUgYW4gZXZlbnQgZm9yIGVhY2ggd2F0Y2guICovCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeShpLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSBkYzg5ZTI3MTcyMzdkYWQ1NDg4YjUwOTRkNmRlZjBkYjU0MzhhZmJh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxldCB1bnJl
YWQgd2F0Y2ggZXZlbnRzIHRpbWUgb3V0CgpBIGZ1dHVyZSBtb2RpZmljYXRp
b24gd2lsbCBsaW1pdCB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzCmZvciBhIGRvbWFpbiwgd2hlcmUgIm91dHN0YW5kaW5nIiBtZWFucyB0
aGF0IHRoZSByZXNwb25zZSBvZiB0aGUKcmVxdWVzdCBvciBhbnkgcmVzdWx0
aW5nIHdhdGNoIGV2ZW50IGhhc24ndCBiZWVuIGNvbnN1bWVkIHlldC4KCklu
IG9yZGVyIHRvIGF2b2lkIGEgbWFsaWNpb3VzIGd1ZXN0IGJlaW5nIGNhcGFi
bGUgdG8gYmxvY2sgb3RoZXIgZ3Vlc3RzCmJ5IG5vdCByZWFkaW5nIHdhdGNo
IGV2ZW50cywgYWRkIGEgdGltZW91dCBmb3Igd2F0Y2ggZXZlbnRzLiBJbiBj
YXNlIGEKd2F0Y2ggZXZlbnQgaGFzbid0IGJlZW4gY29uc3VtZWQgYWZ0ZXIg
dGhpcyB0aW1lb3V0LCBpdCBpcyBiZWluZwpkZWxldGVkLiBTZXQgdGhlIGRl
ZmF1bHQgdGltZW91dCB0byAyMCBzZWNvbmRzIChhIHJhbmRvbSB2YWx1ZSBi
ZWluZwpub3QgdG9vIGhpZ2gpLgoKSW4gb3JkZXIgdG8gc3VwcG9ydCB0byBz
cGVjaWZ5IG90aGVyIHRpbWVvdXQgdmFsdWVzIGluIGZ1dHVyZSwgdXNlIGEK
Z2VuZXJpYyBjb21tYW5kIGxpbmUgb3B0aW9uIGZvciB0aGF0IHB1cnBvc2U6
CgotLXRpbWVvdXR8LXcgd2F0Y2gtZXZlbnQ9PHNlY29uZHM+CgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzExLgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggOGY4ZDEwY2Vl
OTVlLi41ZmI0NzE0YjM1NmYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMTAzLDYgKzEwMyw4IEBAIGludCBxdW90YV9tYXhf
ZW50cnlfc2l6ZSA9IDIwNDg7IC8qIDJLICovCiBpbnQgcXVvdGFfbWF4X3Ry
YW5zYWN0aW9uID0gMTA7CiBpbnQgcXVvdGFfbmJfcGVybXNfcGVyX25vZGUg
PSA1OwogCit1bnNpZ25lZCBpbnQgdGltZW91dF93YXRjaF9ldmVudF9tc2Vj
ID0gMjAwMDA7CisKIHZvaWQgdHJhY2UoY29uc3QgY2hhciAqZm10LCAuLi4p
CiB7CiAJdmFfbGlzdCBhcmdsaXN0OwpAQCAtMjA1LDE5ICsyMDcsOTIgQEAg
dm9pZCByZW9wZW5fbG9nKHZvaWQpCiAJfQogfQogCitzdGF0aWMgdWludDY0
X3QgZ2V0X25vd19tc2VjKHZvaWQpCit7CisJc3RydWN0IHRpbWVzcGVjIG5v
d190czsKKworCWlmIChjbG9ja19nZXR0aW1lKENMT0NLX01PTk9UT05JQywg
Jm5vd190cykpCisJCWJhcmZfcGVycm9yKCJDb3VsZCBub3QgZmluZCB0aW1l
IChjbG9ja19nZXR0aW1lIGZhaWxlZCkiKTsKKworCXJldHVybiBub3dfdHMu
dHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAwMDsKK30K
Kwogc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBidWZm
ZXJlZF9kYXRhICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pCiB7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKKwogCWxp
c3RfZGVsKCZvdXQtPmxpc3QpOworCisJLyoKKwkgKiBVcGRhdGUgY29ubi0+
dGltZW91dF9tc2VjIHdpdGggdGhlIG5leHQgZm91bmQgdGltZW91dCB2YWx1
ZSBpbiB0aGUKKwkgKiBxdWV1ZWQgcGVuZGluZyByZXF1ZXN0cy4KKwkgKi8K
KwlpZiAob3V0LT50aW1lb3V0X21zZWMpIHsKKwkJY29ubi0+dGltZW91dF9t
c2VjID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShyZXEsICZjb25uLT5v
dXRfbGlzdCwgbGlzdCkgeworCQkJaWYgKHJlcS0+dGltZW91dF9tc2VjKSB7
CisJCQkJY29ubi0+dGltZW91dF9tc2VjID0gcmVxLT50aW1lb3V0X21zZWM7
CisJCQkJYnJlYWs7CisJCQl9CisJCX0KKwl9CisKIAl0YWxsb2NfZnJlZShv
dXQpOwogfQogCitzdGF0aWMgdm9pZCBjaGVja19ldmVudF90aW1lb3V0KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCB1aW50NjRfdCBtc2VjcywKKwkJCQlp
bnQgKnB0aW1lb3V0KQoreworCXVpbnQ2NF90IGRlbHRhOworCXN0cnVjdCBi
dWZmZXJlZF9kYXRhICpvdXQsICp0bXA7CisKKwlpZiAoIWNvbm4tPnRpbWVv
dXRfbXNlYykKKwkJcmV0dXJuOworCisJZGVsdGEgPSBjb25uLT50aW1lb3V0
X21zZWMgLSBtc2VjczsKKwlpZiAoY29ubi0+dGltZW91dF9tc2VjIDw9IG1z
ZWNzKSB7CisJCWRlbHRhID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9z
YWZlKG91dCwgdG1wLCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsKKwkJCS8q
CisJCQkgKiBPbmx5IGxvb2sgYXQgYnVmZmVycyB3aXRoIHRpbWVvdXQgYW5k
IG5vIGRhdGEKKwkJCSAqIGFscmVhZHkgd3JpdHRlbiB0byB0aGUgcmluZy4K
KwkJCSAqLworCQkJaWYgKG91dC0+dGltZW91dF9tc2VjICYmIG91dC0+aW5o
ZHIgJiYgIW91dC0+dXNlZCkgeworCQkJCWlmIChvdXQtPnRpbWVvdXRfbXNl
YyA+IG1zZWNzKSB7CisJCQkJCWNvbm4tPnRpbWVvdXRfbXNlYyA9IG91dC0+
dGltZW91dF9tc2VjOworCQkJCQlkZWx0YSA9IGNvbm4tPnRpbWVvdXRfbXNl
YyAtIG1zZWNzOworCQkJCQlicmVhazsKKwkJCQl9CisKKwkJCQkvKgorCQkJ
CSAqIEZyZWUgb3V0IHdpdGhvdXQgdXBkYXRpbmcgY29ubi0+dGltZW91dF9t
c2VjLAorCQkJCSAqIGFzIHRoZSB1cGRhdGUgaXMgZG9uZSBpbiB0aGlzIGxv
b3AgYWxyZWFkeS4KKwkJCQkgKi8KKwkJCQlvdXQtPnRpbWVvdXRfbXNlYyA9
IDA7CisJCQkJdHJhY2UoIndhdGNoIGV2ZW50IHBhdGggJXMgZm9yIGRvbWFp
biAldSB0aW1lZCBvdXRcbiIsCisJCQkJICAgICAgb3V0LT5idWZmZXIsIGNv
bm4tPmlkKTsKKwkJCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
KwkJCX0KKwkJfQorCQlpZiAoIWRlbHRhKSB7CisJCQljb25uLT50aW1lb3V0
X21zZWMgPSAwOworCQkJcmV0dXJuOworCQl9CisJfQorCisJaWYgKCpwdGlt
ZW91dCA9PSAtMSB8fCAqcHRpbWVvdXQgPiBkZWx0YSkKKwkJKnB0aW1lb3V0
ID0gZGVsdGE7Cit9CisKIHZvaWQgY29ubl9mcmVlX2J1ZmZlcmVkX2RhdGEo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7CiAJc3RydWN0IGJ1ZmZlcmVk
X2RhdGEgKm91dDsKIAogCXdoaWxlICgob3V0ID0gbGlzdF90b3AoJmNvbm4t
Pm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSwgbGlzdCkpKQogCQlm
cmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsKKworCWNvbm4tPnRpbWVv
dXRfbXNlYyA9IDA7CiB9CiAKIHN0YXRpYyBib29sIHdyaXRlX21lc3NhZ2Vz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQpAQCAtMzMxLDYgKzQwNiw3IEBA
IHN0YXRpYyB2b2lkIGluaXRpYWxpemVfZmRzKGludCBzb2NrLCBpbnQgKnBf
c29ja19wb2xsZmRfaWR4LAogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25u
OwogCXN0cnVjdCB3cmxfdGltZXN0YW1wdCBub3c7CisJdWludDY0X3QgbXNl
Y3M7CiAKIAlpZiAoZmRzKQogCQltZW1zZXQoZmRzLCAwLCBzaXplb2Yoc3Ry
dWN0IHBvbGxmZCkgKiBjdXJyZW50X2FycmF5X3NpemUpOwpAQCAtMzUyLDEw
ICs0MjgsMTIgQEAgc3RhdGljIHZvaWQgaW5pdGlhbGl6ZV9mZHMoaW50IHNv
Y2ssIGludCAqcF9zb2NrX3BvbGxmZF9pZHgsCiAKIAl3cmxfZ2V0dGltZV9u
b3coJm5vdyk7CiAJd3JsX2xvZ19wZXJpb2RpYyhub3cpOworCW1zZWNzID0g
Z2V0X25vd19tc2VjKCk7CiAKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KGNvbm4s
ICZjb25uZWN0aW9ucywgbGlzdCkgewogCQlpZiAoY29ubi0+ZG9tYWluKSB7
CiAJCQl3cmxfY2hlY2tfdGltZW91dChjb25uLT5kb21haW4sIG5vdywgcHRp
bWVvdXQpOworCQkJY2hlY2tfZXZlbnRfdGltZW91dChjb25uLCBtc2Vjcywg
cHRpbWVvdXQpOwogCQkJaWYgKGRvbWFpbl9jYW5fcmVhZChjb25uKSB8fAog
CQkJICAgIChkb21haW5fY2FuX3dyaXRlKGNvbm4pICYmCiAJCQkgICAgICFs
aXN0X2VtcHR5KCZjb25uLT5vdXRfbGlzdCkpKQpAQCAtNjk5LDYgKzc3Nyw3
IEBAIHZvaWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
ZW51bSB4c2Rfc29ja21zZ190eXBlIHR5cGUsCiAJCXJldHVybjsKIAliZGF0
YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0gMDsKKwliZGF0YS0+
dGltZW91dF9tc2VjID0gMDsKIAogCWlmIChsZW4gPD0gREVGQVVMVF9CVUZG
RVJfU0laRSkKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZhdWx0X2J1
ZmZlcjsKQEAgLTc1MCw2ICs4MjksMTIgQEAgdm9pZCBzZW5kX2V2ZW50KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp0b2tlbikKIAliZGF0YS0+aGRyLm1zZy50eXBlID0gWFNfV0FU
Q0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVuOwogCisJaWYg
KHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5faXNfdW5wcml2
aWxlZ2VkKGNvbm4pKSB7CisJCWJkYXRhLT50aW1lb3V0X21zZWMgPSBnZXRf
bm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKKwkJaWYg
KCFjb25uLT50aW1lb3V0X21zZWMpCisJCQljb25uLT50aW1lb3V0X21zZWMg
PSBiZGF0YS0+dGltZW91dF9tc2VjOworCX0KKwogCS8qIFF1ZXVlIGZvciBs
YXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRfdGFpbCgmYmRhdGEt
Pmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CiB9CkBAIC0yMDA5LDYgKzIwOTQs
OSBAQCBzdGF0aWMgdm9pZCB1c2FnZSh2b2lkKQogIiAgLVcsIC0td2F0Y2gt
bmIgPG5iPiAgICAgbGltaXQgdGhlIG51bWJlciBvZiB3YXRjaGVzIHBlciBk
b21haW4sXG4iCiAiICAtdCwgLS10cmFuc2FjdGlvbiA8bmI+ICBsaW1pdCB0
aGUgbnVtYmVyIG9mIHRyYW5zYWN0aW9uIGFsbG93ZWQgcGVyIGRvbWFpbixc
biIKICIgIC1BLCAtLXBlcm0tbmIgPG5iPiAgICAgIGxpbWl0IHRoZSBudW1i
ZXIgb2YgcGVybWlzc2lvbnMgcGVyIG5vZGUsXG4iCisiICAtdywgLS10aW1l
b3V0IDx3aGF0Pj08c2Vjb25kcz4gICBzZXQgdGhlIHRpbWVvdXQgaW4gc2Vj
b25kcyBmb3IgPHdoYXQ+LFxuIgorIiAgICAgICAgICAgICAgICAgICAgICAg
ICAgYWxsb3dlZCB0aW1lb3V0IGNhbmRpZGF0ZXMgYXJlOlxuIgorIiAgICAg
ICAgICAgICAgICAgICAgICAgICAgd2F0Y2gtZXZlbnQ6IHRpbWUgYSB3YXRj
aC1ldmVudCBpcyBrZXB0IHBlbmRpbmdcbiIKICIgIC1SLCAtLW5vLXJlY292
ZXJ5ICAgICAgIHRvIHJlcXVlc3QgdGhhdCBubyByZWNvdmVyeSBzaG91bGQg
YmUgYXR0ZW1wdGVkIHdoZW5cbiIKICIgICAgICAgICAgICAgICAgICAgICAg
ICAgIHRoZSBzdG9yZSBpcyBjb3JydXB0ZWQgKGRlYnVnIG9ubHkpLFxuIgog
IiAgLUksIC0taW50ZXJuYWwtZGIgICAgICAgc3RvcmUgZGF0YWJhc2UgaW4g
bWVtb3J5LCBub3Qgb24gZGlza1xuIgpAQCAtMjAzMCw2ICsyMTE4LDcgQEAg
c3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRyYWNl
LWZpbGUiLCAxLCBOVUxMLCAnVCcgfSwKIAl7ICJ0cmFuc2FjdGlvbiIsIDEs
IE5VTEwsICd0JyB9LAogCXsgInBlcm0tbmIiLCAxLCBOVUxMLCAnQScgfSwK
Kwl7ICJ0aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3Zl
cnkiLCAwLCBOVUxMLCAnUicgfSwKIAl7ICJpbnRlcm5hbC1kYiIsIDAsIE5V
TEwsICdJJyB9LAogCXsgInZlcmJvc2UiLCAwLCBOVUxMLCAnVicgfSwKQEAg
LTIwNDEsNiArMjEzMCwzOSBAQCBpbnQgZG9tMF9kb21pZCA9IDA7CiBpbnQg
ZG9tMF9ldmVudCA9IDA7CiBpbnQgcHJpdl9kb21pZCA9IDA7CiAKK3N0YXRp
YyBpbnQgZ2V0X29wdHZhbF9pbnQoY29uc3QgY2hhciAqYXJnKQoreworCWNo
YXIgKmVuZDsKKwlsb25nIHZhbDsKKworCXZhbCA9IHN0cnRvbChhcmcsICZl
bmQsIDEwKTsKKwlpZiAoISphcmcgfHwgKmVuZCB8fCB2YWwgPCAwIHx8IHZh
bCA+IElOVF9NQVgpCisJCWJhcmYoImludmFsaWQgcGFyYW1ldGVyIHZhbHVl
IFwiJXNcIlxuIiwgYXJnKTsKKworCXJldHVybiB2YWw7Cit9CisKK3N0YXRp
YyBib29sIHdoYXRfbWF0Y2hlcyhjb25zdCBjaGFyICphcmcsIGNvbnN0IGNo
YXIgKndoYXQpCit7CisJdW5zaWduZWQgaW50IHdoYXRfbGVuID0gc3RybGVu
KHdoYXQpOworCisJcmV0dXJuICFzdHJuY21wKGFyZywgd2hhdCwgd2hhdF9s
ZW4pICYmIGFyZ1t3aGF0X2xlbl0gPT0gJz0nOworfQorCitzdGF0aWMgdm9p
ZCBzZXRfdGltZW91dChjb25zdCBjaGFyICphcmcpCit7CisJY29uc3QgY2hh
ciAqZXEgPSBzdHJjaHIoYXJnLCAnPScpOworCWludCB2YWw7CisKKwlpZiAo
IWVxKQorCQliYXJmKCJxdW90YXMgbXVzdCBiZSBzcGVjaWZpZWQgdmlhIDx3
aGF0Pj08c2Vjb25kcz5cbiIpOworCXZhbCA9IGdldF9vcHR2YWxfaW50KGVx
ICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ3YXRjaC1ldmVudCIp
KQorCQl0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMgPSB2YWwgKiAxMDAwOwor
CWVsc2UKKwkJYmFyZigidW5rbm93biB0aW1lb3V0IFwiJXNcIlxuIiwgYXJn
KTsKK30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIHsK
IAlpbnQgb3B0LCAqc29jayA9IE5VTEwsICpyb19zb2NrID0gTlVMTDsKQEAg
LTIwNTIsNyArMjE3NCw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICph
cmd2W10pCiAJaW50IHRpbWVvdXQ7CiAKIAotCXdoaWxlICgob3B0ID0gZ2V0
b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6VDpSVlc6Iiwg
b3B0aW9ucywKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFy
Z3YsICJERTpGOkhOUFM6dDpBOlQ6UlZXOnc6Iiwgb3B0aW9ucywKIAkJCQkg
IE5VTEwpKSAhPSAtMSkgewogCQlzd2l0Y2ggKG9wdCkgewogCQljYXNlICdE
JzoKQEAgLTIwOTcsNiArMjIxOSw5IEBAIGludCBtYWluKGludCBhcmdjLCBj
aGFyICphcmd2W10pCiAJCWNhc2UgJ0EnOgogCQkJcXVvdGFfbmJfcGVybXNf
cGVyX25vZGUgPSBzdHJ0b2wob3B0YXJnLCBOVUxMLCAxMCk7CiAJCQlicmVh
azsKKwkJY2FzZSAndyc6CisJCQlzZXRfdGltZW91dChvcHRhcmcpOworCQkJ
YnJlYWs7CiAJCWNhc2UgJ2UnOgogCQkJZG9tMF9ldmVudCA9IHN0cnRvbChv
cHRhcmcsIE5VTEwsIDEwKTsKIAkJCWJyZWFrOwpkaWZmIC0tZ2l0IGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggODNkNDk2OTNmYzE5Li4zMTEyYzEx
ODExZTUgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9j
b3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApA
QCAtMjcsNiArMjcsNyBAQAogI2luY2x1ZGUgPGRpcmVudC5oPgogI2luY2x1
ZGUgPHN0ZGJvb2wuaD4KICNpbmNsdWRlIDxzdGRpbnQuaD4KKyNpbmNsdWRl
IDx0aW1lLmg+CiAjaW5jbHVkZSA8ZXJybm8uaD4KIAogI2luY2x1ZGUgInhl
bnN0b3JlX2xpYi5oIgpAQCAtNTYsNiArNTcsOCBAQCBzdHJ1Y3QgYnVmZmVy
ZWRfZGF0YQogCQljaGFyIHJhd1tzaXplb2Yoc3RydWN0IHhzZF9zb2NrbXNn
KV07CiAJfSBoZHI7CiAKKwl1aW50NjRfdCB0aW1lb3V0X21zZWM7CisKIAkv
KiBUaGUgYWN0dWFsIGRhdGEuICovCiAJY2hhciAqYnVmZmVyOwogCWNoYXIg
ZGVmYXVsdF9idWZmZXJbREVGQVVMVF9CVUZGRVJfU0laRV07CkBAIC04OCw2
ICs5MSw3IEBAIHN0cnVjdCBjb25uZWN0aW9uCiAKIAkvKiBCdWZmZXJlZCBv
dXRwdXQgZGF0YSAqLwogCXN0cnVjdCBsaXN0X2hlYWQgb3V0X2xpc3Q7CisJ
dWludDY0X3QgdGltZW91dF9tc2VjOwogCiAJLyogVHJhbnNhY3Rpb24gY29u
dGV4dCBmb3IgY3VycmVudCByZXF1ZXN0IChOVUxMIGlmIG5vbmUpLiAqLwog
CXN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnNhY3Rpb247CkBAIC0xOTksNiAr
MjAzLDggQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0ZXJuIGludCBw
cml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9wZXJfZG9t
YWluOwogCitleHRlcm4gdW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZl
bnRfbXNlYzsKKwogLyogTWFwIHRoZSBrZXJuZWwncyB4ZW5zdG9yZSBwYWdl
LiAqLwogdm9pZCAqeGVuYnVzX21hcCh2b2lkKTsKIHZvaWQgdW5tYXBfeGVu
YnVzKHZvaWQgKmludGVyZmFjZSk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSBjM2UzOTdmMmQ3NzY0NTU4NGNjOTU1YzIyM2IyODk0YTQyMzllYTRj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG91
dHN0YW5kaW5nIHJlcXVlc3RzCgpBZGQgYW5vdGhlciBxdW90YSBmb3IgbGlt
aXRpbmcgdGhlIG51bWJlciBvZiBvdXRzdGFuZGluZyByZXF1ZXN0cyBvZiBh
Cmd1ZXN0LiBBcyB0aGUgd2F5IHRvIHNwZWNpZnkgcXVvdGFzIG9uIHRoZSBj
b21tYW5kIGxpbmUgaXMgYmVjb21pbmcKcmF0aGVyIG5hc3R5LCBzd2l0Y2gg
dG8gYSBuZXcgc2NoZW1lIHVzaW5nIFstLXF1b3RhfC1RXSA8d2hhdD49PHZh
bD4KYWxsb3dpbmcgdG8gYWRkIG1vcmUgcXVvdGFzIGluIGZ1dHVyZSBlYXNp
bHkuCgpTZXQgdGhlIGRlZmF1bHQgdmFsdWUgdG8gMjAgKGJhc2ljYWxseSBh
IHJhbmRvbSB2YWx1ZSBub3Qgc2VlbWluZyB0bwpiZSB0b28gaGlnaCBvciB0
b28gbG93KS4KCkEgcmVxdWVzdCBpcyBzYWlkIHRvIGJlIG91dHN0YW5kaW5n
IGlmIGFueSBtZXNzYWdlIGdlbmVyYXRlZCBieSB0aGlzCnJlcXVlc3QgKHRo
ZSBkaXJlY3QgcmVzcG9uc2UgcGx1cyBwb3RlbnRpYWwgd2F0Y2ggZXZlbnRz
KSBpcyBub3QgeWV0CmNvbXBsZXRlbHkgc3RvcmVkIGludG8gYSByaW5nIGJ1
ZmZlci4gVGhlIGluaXRpYWwgd2F0Y2ggZXZlbnQgc2VudCBhcwphIHJlc3Vs
dCBvZiByZWdpc3RlcmluZyBhIHdhdGNoIGlzIGFuIGV4Y2VwdGlvbi4KCk5v
dGUgdGhhdCBhY3Jvc3MgYSBsaXZlIHVwZGF0ZSB0aGUgcmVsYXRpb24gdG8g
YnVmZmVyZWQgd2F0Y2ggZXZlbnRzCmZvciBvdGhlciBkb21haW5zIGlzIGxv
c3QuCgpVc2UgdGFsbG9jX3plcm8oKSBmb3IgYWxsb2NhdGluZyB0aGUgZG9t
YWluIHN0cnVjdHVyZSBpbiBvcmRlciB0byBoYXZlCmFsbCBwZXItZG9tYWlu
IHF1b3RhIHplcm9lZCBpbml0aWFsbHkuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTMyNiAvIENWRS0yMDIyLTQyMzEyLgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggNWZiNDcxNGIzNTZmLi41ZjE3MzMxMTJh
NGYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MTAyLDYgKzEwMiw3IEBAIGludCBxdW90YV9uYl93YXRjaF9wZXJfZG9tYWlu
ID0gMTI4OwogaW50IHF1b3RhX21heF9lbnRyeV9zaXplID0gMjA0ODsgLyog
MksgKi8KIGludCBxdW90YV9tYXhfdHJhbnNhY3Rpb24gPSAxMDsKIGludCBx
dW90YV9uYl9wZXJtc19wZXJfbm9kZSA9IDU7CitpbnQgcXVvdGFfcmVxX291
dHN0YW5kaW5nID0gMjA7CiAKIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNo
X2V2ZW50X21zZWMgPSAyMDAwMDsKIApAQCAtMjE3LDEyICsyMTgsMjQgQEAg
c3RhdGljIHVpbnQ2NF90IGdldF9ub3dfbXNlYyh2b2lkKQogCXJldHVybiBu
b3dfdHMudHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAw
MDsKIH0KIAorLyoKKyAqIFJlbW92ZSBhIHN0cnVjdCBidWZmZXJlZF9kYXRh
IGZyb20gdGhlIGxpc3Qgb2Ygb3V0Z29pbmcgZGF0YS4KKyAqIEEgc3RydWN0
IGJ1ZmZlcmVkX2RhdGEgcmVsYXRlZCB0byBhIHJlcXVlc3QgaGF2aW5nIGNh
dXNlZCB3YXRjaCBldmVudHMgdG8gYmUKKyAqIHNlbnQgaXMga2VwdCB1bnRp
bCBhbGwgdGhvc2UgZXZlbnRzIGhhdmUgYmVlbiB3cml0dGVuIG91dC4KKyAq
IEVhY2ggd2F0Y2ggZXZlbnQgaXMgcmVmZXJlbmNpbmcgdGhlIHJlbGF0ZWQg
cmVxdWVzdCB2aWEgcGVuZC5yZXEsIHdoaWxlIHRoZQorICogbnVtYmVyIG9m
IHdhdGNoIGV2ZW50cyBjYXVzZWQgYnkgYSByZXF1ZXN0IGlzIGtlcHQgaW4g
cGVuZC5yZWYuZXZlbnRfY250CisgKiAodGhvc2UgdHdvIGNhc2VzIGFyZSBt
dXR1YWxseSBleGNsdXNpdmUsIHNvIHRoZSB0d28gZmllbGRzIGNhbiBzaGFy
ZSBtZW1vcnkKKyAqIHZpYSBhIHVuaW9uKS4KKyAqIFRoZSBzdHJ1Y3QgYnVm
ZmVyZWRfZGF0YSBpcyBmcmVlZCBvbmx5IGlmIG5vIHJlbGF0ZWQgd2F0Y2gg
ZXZlbnQgaXMKKyAqIHJlZmVyZW5jaW5nIGl0LiBUaGUgcmVsYXRlZCByZXR1
cm4gZGF0YSBjYW4gYmUgZnJlZWQgcmlnaHQgYXdheS4KKyAqLwogc3RhdGlj
IHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBidWZmZXJlZF9kYXRh
ICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7
CiAJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKIAogCWxpc3RfZGVsKCZv
dXQtPmxpc3QpOworCW91dC0+b25fb3V0X2xpc3QgPSBmYWxzZTsKIAogCS8q
CiAJICogVXBkYXRlIGNvbm4tPnRpbWVvdXRfbXNlYyB3aXRoIHRoZSBuZXh0
IGZvdW5kIHRpbWVvdXQgdmFsdWUgaW4gdGhlCkBAIC0yMzgsNiArMjUxLDMw
IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0YShzdHJ1Y3QgYnVm
ZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJaWYgKG91dC0+aGRyLm1z
Zy50eXBlID09IFhTX1dBVENIX0VWRU5UKSB7CisJCXJlcSA9IG91dC0+cGVu
ZC5yZXE7CisJCWlmIChyZXEpIHsKKwkJCXJlcS0+cGVuZC5yZWYuZXZlbnRf
Y250LS07CisJCQlpZiAoIXJlcS0+cGVuZC5yZWYuZXZlbnRfY250ICYmICFy
ZXEtPm9uX291dF9saXN0KSB7CisJCQkJaWYgKHJlcS0+b25fcmVmX2xpc3Qp
IHsKKwkJCQkJZG9tYWluX291dHN0YW5kaW5nX2RvbWlkX2RlYygKKwkJCQkJ
CXJlcS0+cGVuZC5yZWYuZG9taWQpOworCQkJCQlsaXN0X2RlbCgmcmVxLT5s
aXN0KTsKKwkJCQl9CisJCQkJdGFsbG9jX2ZyZWUocmVxKTsKKwkJCX0KKwkJ
fQorCX0gZWxzZSBpZiAob3V0LT5wZW5kLnJlZi5ldmVudF9jbnQpIHsKKwkJ
LyogSGFuZyBvdXQgb2ZmIGZyb20gY29ubi4gKi8KKwkJdGFsbG9jX3N0ZWFs
KE5VTEwsIG91dCk7CisJCWlmIChvdXQtPmJ1ZmZlciAhPSBvdXQtPmRlZmF1
bHRfYnVmZmVyKQorCQkJdGFsbG9jX2ZyZWUob3V0LT5idWZmZXIpOworCQls
aXN0X2FkZCgmb3V0LT5saXN0LCAmY29ubi0+cmVmX2xpc3QpOworCQlvdXQt
Pm9uX3JlZl9saXN0ID0gdHJ1ZTsKKwkJcmV0dXJuOworCX0gZWxzZQorCQlk
b21haW5fb3V0c3RhbmRpbmdfZGVjKGNvbm4pOworCiAJdGFsbG9jX2ZyZWUo
b3V0KTsKIH0KIApAQCAtMzQ2LDYgKzM4Myw3IEBAIHN0YXRpYyBib29sIHdy
aXRlX21lc3NhZ2VzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQogc3RhdGlj
IGludCBkZXN0cm95X2Nvbm4odm9pZCAqX2Nvbm4pCiB7CiAJc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4gPSBfY29ubjsKKwlzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSAqcmVxOwogCiAJLyogRmx1c2ggb3V0Z29pbmcgaWYgcG9zc2libGUsIGJ1
dCBkb24ndCBibG9jay4gKi8KIAlpZiAoIWNvbm4tPmRvbWFpbikgewpAQCAt
MzU5LDYgKzM5NywxMSBAQCBzdGF0aWMgaW50IGRlc3Ryb3lfY29ubih2b2lk
ICpfY29ubikKIAkJCQlicmVhazsKIAkJY2xvc2UoY29ubi0+ZmQpOwogCX0K
KworCWNvbm5fZnJlZV9idWZmZXJlZF9kYXRhKGNvbm4pOworCWxpc3RfZm9y
X2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxpc3QpCisJCXJl
cS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKKwogICAgICAgICBpZiAoY29ubi0+
dGFyZ2V0KQogICAgICAgICAgICAgICAgIHRhbGxvY191bmxpbmsoY29ubiwg
Y29ubi0+dGFyZ2V0KTsKIAlsaXN0X2RlbCgmY29ubi0+bGlzdCk7CkBAIC03
OTgsNiArODQxLDggQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAogCS8q
IFF1ZXVlIGZvciBsYXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRf
dGFpbCgmYmRhdGEtPmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CisJYmRhdGEt
Pm9uX291dF9saXN0ID0gdHJ1ZTsKKwlkb21haW5fb3V0c3RhbmRpbmdfaW5j
KGNvbm4pOwogfQogCiAvKgpAQCAtODA1LDcgKzg1MCw4IEBAIHZvaWQgc2Vu
ZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4c2Rfc29j
a21zZ190eXBlIHR5cGUsCiAgKiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSBy
ZWxhdGVkIHRvIHRoZSBjdXJyZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBi
ZQogICogcmVwb3J0ZWQuCiAgKi8KLXZvaWQgc2VuZF9ldmVudChzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwgY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hh
ciAqdG9rZW4pCit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGJ1ZmZlcmVkX2Rh
dGEgKnJlcSwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCWNvbnN0IGNo
YXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKQogewogCXN0cnVjdCBidWZm
ZXJlZF9kYXRhICpiZGF0YTsKIAl1bnNpZ25lZCBpbnQgbGVuOwpAQCAtODM1
LDggKzg4MSwxMyBAQCB2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2Vu
KQogCQkJY29ubi0+dGltZW91dF9tc2VjID0gYmRhdGEtPnRpbWVvdXRfbXNl
YzsKIAl9CiAKKwliZGF0YS0+cGVuZC5yZXEgPSByZXE7CisJaWYgKHJlcSkK
KwkJcmVxLT5wZW5kLnJlZi5ldmVudF9jbnQrKzsKKwogCS8qIFF1ZXVlIGZv
ciBsYXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRfdGFpbCgmYmRh
dGEtPmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CisJYmRhdGEtPm9uX291dF9s
aXN0ID0gdHJ1ZTsKIH0KIAogLyogU29tZSByb3V0aW5lcyAod3JpdGUsIG1r
ZGlyLCBldGMpIGp1c3QgbmVlZCBhIG5vbi1lcnJvciByZXR1cm4gKi8KQEAg
LTE1NzIsNiArMTYyMyw3IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV9pbnB1dChz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKIAkJCXJldHVybjsKIAl9CiAJaW4g
PSBjb25uLT5pbjsKKwlpbi0+cGVuZC5yZWYuZG9taWQgPSBjb25uLT5pZDsK
IAogCS8qIE5vdCBmaW5pc2hlZCBoZWFkZXIgeWV0PyAqLwogCWlmIChpbi0+
aW5oZHIpIHsKQEAgLTE2NDIsNiArMTY5NCw3IEBAIHN0cnVjdCBjb25uZWN0
aW9uICpuZXdfY29ubmVjdGlvbihjb25ud3JpdGVmbl90ICp3cml0ZSwgY29u
bnJlYWRmbl90ICpyZWFkKQogCW5ldy0+aXNfaWdub3JlZCA9IGZhbHNlOwog
CW5ldy0+dHJhbnNhY3Rpb25fc3RhcnRlZCA9IDA7CiAJSU5JVF9MSVNUX0hF
QUQoJm5ldy0+b3V0X2xpc3QpOworCUlOSVRfTElTVF9IRUFEKCZuZXctPnJl
Zl9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmbmV3LT53YXRjaGVzKTsKIAlJ
TklUX0xJU1RfSEVBRCgmbmV3LT50cmFuc2FjdGlvbl9saXN0KTsKIApAQCAt
MjA5NCw2ICsyMTQ3LDkgQEAgc3RhdGljIHZvaWQgdXNhZ2Uodm9pZCkKICIg
IC1XLCAtLXdhdGNoLW5iIDxuYj4gICAgIGxpbWl0IHRoZSBudW1iZXIgb2Yg
d2F0Y2hlcyBwZXIgZG9tYWluLFxuIgogIiAgLXQsIC0tdHJhbnNhY3Rpb24g
PG5iPiAgbGltaXQgdGhlIG51bWJlciBvZiB0cmFuc2FjdGlvbiBhbGxvd2Vk
IHBlciBkb21haW4sXG4iCiAiICAtQSwgLS1wZXJtLW5iIDxuYj4gICAgICBs
aW1pdCB0aGUgbnVtYmVyIG9mIHBlcm1pc3Npb25zIHBlciBub2RlLFxuIgor
IiAgLVEsIC0tcXVvdGEgPHdoYXQ+PTxuYj4gc2V0IHRoZSBxdW90YSA8d2hh
dD4gdG8gdGhlIHZhbHVlIDxuYj4sIGFsbG93ZWRcbiIKKyIgICAgICAgICAg
ICAgICAgICAgICAgICAgIHF1b3RhcyBhcmU6XG4iCisiICAgICAgICAgICAg
ICAgICAgICAgICAgICBvdXRzdGFuZGluZzogbnVtYmVyIG9mIG91dHN0YW5k
aW5nIHJlcXVlc3RzXG4iCiAiICAtdywgLS10aW1lb3V0IDx3aGF0Pj08c2Vj
b25kcz4gICBzZXQgdGhlIHRpbWVvdXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+
LFxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZCB0aW1l
b3V0IGNhbmRpZGF0ZXMgYXJlOlxuIgogIiAgICAgICAgICAgICAgICAgICAg
ICAgICAgd2F0Y2gtZXZlbnQ6IHRpbWUgYSB3YXRjaC1ldmVudCBpcyBrZXB0
IHBlbmRpbmdcbiIKQEAgLTIxMTgsNiArMjE3NCw3IEBAIHN0YXRpYyBzdHJ1
Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsKIAl7ICJ0cmFjZS1maWxlIiwgMSwg
TlVMTCwgJ1QnIH0sCiAJeyAidHJhbnNhY3Rpb24iLCAxLCBOVUxMLCAndCcg
fSwKIAl7ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCisJeyAicXVvdGEi
LCAxLCBOVUxMLCAnUScgfSwKIAl7ICJ0aW1lb3V0IiwgMSwgTlVMTCwgJ3cn
IH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAwLCBOVUxMLCAnUicgfSwKIAl7ICJp
bnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJJyB9LApAQCAtMjE2Myw2ICsyMjIw
LDIwIEBAIHN0YXRpYyB2b2lkIHNldF90aW1lb3V0KGNvbnN0IGNoYXIgKmFy
ZykKIAkJYmFyZigidW5rbm93biB0aW1lb3V0IFwiJXNcIlxuIiwgYXJnKTsK
IH0KIAorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNvbnN0IGNoYXIgKmFyZykK
K3sKKwljb25zdCBjaGFyICplcSA9IHN0cmNocihhcmcsICc9Jyk7CisJaW50
IHZhbDsKKworCWlmICghZXEpCisJCWJhcmYoInF1b3RhcyBtdXN0IGJlIHNw
ZWNpZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOworCXZhbCA9IGdldF9vcHR2
YWxfaW50KGVxICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRz
dGFuZGluZyIpKQorCQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7CisJ
ZWxzZQorCQliYXJmKCJ1bmtub3duIHF1b3RhIFwiJXNcIlxuIiwgYXJnKTsK
K30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIHsKIAlp
bnQgb3B0LCAqc29jayA9IE5VTEwsICpyb19zb2NrID0gTlVMTDsKQEAgLTIx
NzQsNyArMjI0NSw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2
W10pCiAJaW50IHRpbWVvdXQ7CiAKIAotCXdoaWxlICgob3B0ID0gZ2V0b3B0
X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6VDpSVlc6dzoiLCBv
cHRpb25zLAorCXdoaWxlICgob3B0ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJn
diwgIkRFOkY6SE5QUzp0OkE6UTpUOlJWVzp3OiIsIG9wdGlvbnMsCiAJCQkJ
ICBOVUxMKSkgIT0gLTEpIHsKIAkJc3dpdGNoIChvcHQpIHsKIAkJY2FzZSAn
RCc6CkBAIC0yMjE5LDYgKzIyOTAsOSBAQCBpbnQgbWFpbihpbnQgYXJnYywg
Y2hhciAqYXJndltdKQogCQljYXNlICdBJzoKIAkJCXF1b3RhX25iX3Blcm1z
X3Blcl9ub2RlID0gc3RydG9sKG9wdGFyZywgTlVMTCwgMTApOwogCQkJYnJl
YWs7CisJCWNhc2UgJ1EnOgorCQkJc2V0X3F1b3RhKG9wdGFyZyk7CisJCQli
cmVhazsKIAkJY2FzZSAndyc6CiAJCQlzZXRfdGltZW91dChvcHRhcmcpOwog
CQkJYnJlYWs7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApp
bmRleCAzMTEyYzExODExZTUuLmVkZWFhOTZkZDEwYiAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC00NSw2ICs0NSw4IEBAIHR5
cGVkZWYgaW50MzJfdCB3cmxfY3JlZGl0dDsKIHN0cnVjdCBidWZmZXJlZF9k
YXRhCiB7CiAJc3RydWN0IGxpc3RfaGVhZCBsaXN0OworCWJvb2wgb25fb3V0
X2xpc3Q7CisJYm9vbCBvbl9yZWZfbGlzdDsKIAogCS8qIEFyZSB3ZSBzdGls
bCBkb2luZyB0aGUgaGVhZGVyPyAqLwogCWJvb2wgaW5oZHI7CkBAIC01Miw2
ICs1NCwxNyBAQCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YQogCS8qIEhvdyBmYXIg
YXJlIHdlPyAqLwogCXVuc2lnbmVkIGludCB1c2VkOwogCisJLyogT3V0c3Rh
bmRpbmcgcmVxdWVzdCBhY2NvdW50aW5nLiAqLworCXVuaW9uIHsKKwkJLyog
cmVmIGlzIGJlaW5nIHVzZWQgZm9yIHJlcXVlc3RzLiAqLworCQlzdHJ1Y3Qg
eworCQkJdW5zaWduZWQgaW50IGV2ZW50X2NudDsgLyogIyBvZiBvdXRzdGFu
ZGluZyBldmVudHMuICovCisJCQl1bnNpZ25lZCBpbnQgZG9taWQ7ICAgICAv
KiBkb21pZCBvZiByZXF1ZXN0LiAqLworCQl9IHJlZjsKKwkJLyogcmVxIGlz
IGJlaW5nIHVzZWQgZm9yIHdhdGNoIGV2ZW50cy4gKi8KKwkJc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKnJlcTsgICAgICAvKiByZXF1ZXN0IGNhdXNpbmcgZXZl
bnQuICovCisJfSBwZW5kOworCiAJdW5pb24gewogCQlzdHJ1Y3QgeHNkX3Nv
Y2ttc2cgbXNnOwogCQljaGFyIHJhd1tzaXplb2Yoc3RydWN0IHhzZF9zb2Nr
bXNnKV07CkBAIC05Myw2ICsxMDYsOSBAQCBzdHJ1Y3QgY29ubmVjdGlvbgog
CXN0cnVjdCBsaXN0X2hlYWQgb3V0X2xpc3Q7CiAJdWludDY0X3QgdGltZW91
dF9tc2VjOwogCisJLyogUmVmZXJlbmNlZCByZXF1ZXN0cyBubyBsb25nZXIg
cGVuZGluZy4gKi8KKwlzdHJ1Y3QgbGlzdF9oZWFkIHJlZl9saXN0OworCiAJ
LyogVHJhbnNhY3Rpb24gY29udGV4dCBmb3IgY3VycmVudCByZXF1ZXN0IChO
VUxMIGlmIG5vbmUpLiAqLwogCXN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnNh
Y3Rpb247CiAKQEAgLTE1NCw3ICsxNzAsOCBAQCB1bnNpZ25lZCBpbnQgZ2V0
X3N0cmluZ3Moc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmRhdGEsCiAKIHZvaWQg
c2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4c2Rf
c29ja21zZ190eXBlIHR5cGUsCiAJCWNvbnN0IHZvaWQgKmRhdGEsIHVuc2ln
bmVkIGludCBsZW4pOwotdm9pZCBzZW5kX2V2ZW50KHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBjb25zdCBjaGFyICpwYXRoLCBjb25zdCBjaGFyICp0b2tl
bik7Cit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJl
cSwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCWNvbnN0IGNoYXIgKnBh
dGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKIAogLyogU29tZSByb3V0aW5lcyAo
d3JpdGUsIG1rZGlyLCBldGMpIGp1c3QgbmVlZCBhIG5vbi1lcnJvciByZXR1
cm4gKi8KIHZvaWQgc2VuZF9hY2soc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlKTsKQEAgLTIwMiw2ICsyMTks
NyBAQCBleHRlcm4gaW50IGRvbTBfZG9taWQ7CiBleHRlcm4gaW50IGRvbTBf
ZXZlbnQ7CiBleHRlcm4gaW50IHByaXZfZG9taWQ7CiBleHRlcm4gaW50IHF1
b3RhX25iX2VudHJ5X3Blcl9kb21haW47CitleHRlcm4gaW50IHF1b3RhX3Jl
cV9vdXRzdGFuZGluZzsKIAogZXh0ZXJuIHVuc2lnbmVkIGludCB0aW1lb3V0
X3dhdGNoX2V2ZW50X21zZWM7CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9kb21haW4uYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uYwppbmRleCA0MTZiOTJjYWQ0YjIuLjU4YjdlMGZlMmZh
NyAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFp
bi5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwpA
QCAtODYsNiArODYsOSBAQCBzdHJ1Y3QgZG9tYWluCiAJLyogbnVtYmVyIG9m
IHdhdGNoIGZvciB0aGlzIGRvbWFpbiAqLwogCWludCBuYndhdGNoOwogCisJ
LyogTnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVlc3RzLiAqLworCWludCBu
Ym91dHN0YW5kaW5nOworCiAJLyogd3JpdGUgcmF0ZSBsaW1pdCAqLwogCXdy
bF9jcmVkaXR0IHdybF9jcmVkaXQ7IC8qIFsgLXdybF9jb25maWdfd3JpdGVj
b3N0LCArX2RidXJzdCBdICovCiAJc3RydWN0IHdybF90aW1lc3RhbXB0IHdy
bF90aW1lc3RhbXA7CkBAIC0yODgsOCArMjkxLDEyIEBAIGJvb2wgZG9tYWlu
X2Nhbl9yZWFkKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQogewogCXN0cnVj
dCB4ZW5zdG9yZV9kb21haW5faW50ZXJmYWNlICppbnRmID0gY29ubi0+ZG9t
YWluLT5pbnRlcmZhY2U7CiAKLQlpZiAoZG9tYWluX2lzX3VucHJpdmlsZWdl
ZChjb25uKSAmJiBjb25uLT5kb21haW4tPndybF9jcmVkaXQgPCAwKQotCQly
ZXR1cm4gZmFsc2U7CisJaWYgKGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29u
bikpIHsKKwkJaWYgKGNvbm4tPmRvbWFpbi0+d3JsX2NyZWRpdCA8IDApCisJ
CQlyZXR1cm4gZmFsc2U7CisJCWlmIChjb25uLT5kb21haW4tPm5ib3V0c3Rh
bmRpbmcgPj0gcXVvdGFfcmVxX291dHN0YW5kaW5nKQorCQkJcmV0dXJuIGZh
bHNlOworCX0KIAogCWlmIChjb25uLT5pc19pZ25vcmVkKQogCQlyZXR1cm4g
ZmFsc2U7CkBAIC0zMzgsNyArMzQ1LDcgQEAgc3RhdGljIHN0cnVjdCBkb21h
aW4gKmFsbG9jX2RvbWFpbih2b2lkICpjb250ZXh0LCB1bnNpZ25lZCBpbnQg
ZG9taWQpCiB7CiAJc3RydWN0IGRvbWFpbiAqZG9tYWluOwogCi0JZG9tYWlu
ID0gdGFsbG9jKGNvbnRleHQsIHN0cnVjdCBkb21haW4pOworCWRvbWFpbiA9
IHRhbGxvY196ZXJvKGNvbnRleHQsIHN0cnVjdCBkb21haW4pOwogCWlmICgh
ZG9tYWluKSB7CiAJCWVycm5vID0gRU5PTUVNOwogCQlyZXR1cm4gTlVMTDsK
QEAgLTM4Nyw4ICszOTQsNiBAQCBzdGF0aWMgaW50IG5ld19kb21haW4oc3Ry
dWN0IGRvbWFpbiAqZG9tYWluLCBpbnQgcG9ydCkKIAlkb21haW4tPmNvbm4t
PmlkID0gZG9tYWluLT5kb21pZDsKIAogCWRvbWFpbi0+cmVtb3RlX3BvcnQg
PSBwb3J0OwotCWRvbWFpbi0+bmJlbnRyeSA9IDA7Ci0JZG9tYWluLT5uYndh
dGNoID0gMDsKIAogCXJldHVybiAwOwogfQpAQCAtOTI5LDYgKzkzNCwyOCBA
QCBpbnQgZG9tYWluX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQog
CQk6IDA7CiB9CiAKK3ZvaWQgZG9tYWluX291dHN0YW5kaW5nX2luYyhzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubikKK3sKKwlpZiAoIWNvbm4gfHwgIWNvbm4t
PmRvbWFpbikKKwkJcmV0dXJuOworCWNvbm4tPmRvbWFpbi0+bmJvdXRzdGFu
ZGluZysrOworfQorCit2b2lkIGRvbWFpbl9vdXRzdGFuZGluZ19kZWMoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJaWYgKCFjb25uIHx8ICFjb25u
LT5kb21haW4pCisJCXJldHVybjsKKwljb25uLT5kb21haW4tPm5ib3V0c3Rh
bmRpbmctLTsKK30KKwordm9pZCBkb21haW5fb3V0c3RhbmRpbmdfZG9taWRf
ZGVjKHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1Y3QgZG9tYWluICpk
ID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9taWQpOworCisJaWYgKGQpCisJ
CWQtPm5ib3V0c3RhbmRpbmctLTsKK30KKwogc3RhdGljIHdybF9jcmVkaXR0
IHdybF9jb25maWdfd3JpdGVjb3N0ICAgICAgPSBXUkxfRkFDVE9SOwogc3Rh
dGljIHdybF9jcmVkaXR0IHdybF9jb25maWdfcmF0ZSAgICAgICAgICAgPSBX
UkxfUkFURSAgICogV1JMX0ZBQ1RPUjsKIHN0YXRpYyB3cmxfY3JlZGl0dCB3
cmxfY29uZmlnX2RidXJzdCAgICAgICAgID0gV1JMX0RCVVJTVCAqIFdSTF9G
QUNUT1I7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
aW5kZXggNWUwMDA4NzIwNmM3Li40YmZmMmU2NTViOWIgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAorKysgYi90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY3LDYgKzY3LDkg
QEAgaW50IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7
CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwordm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5jKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKK3ZvaWQgZG9tYWluX291dHN0YW5kaW5nX2Rl
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7Cit2b2lkIGRvbWFpbl9vdXRz
dGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKTsKIAogLyog
U3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICovCiBpbnQgc2V0
X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0
IGNoYXIgKm5hbWUsCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfd2F0Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRj
aC5jCmluZGV4IDJmOTM2Nzc2N2U0NC4uYzUwYzA1NzVmMGYxIDEwMDY0NAot
LS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMTQyLDYgKzE0
Miw3IEBAIHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCSAg
c3RydWN0IG5vZGUgKm5vZGUsIGJvb2wgZXhhY3QsIHN0cnVjdCBub2RlX3Bl
cm1zICpwZXJtcykKIHsKIAlzdHJ1Y3QgY29ubmVjdGlvbiAqaTsKKwlzdHJ1
Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCXN0cnVjdCB3YXRjaCAqd2F0Y2g7
CiAKIAkvKiBEdXJpbmcgdHJhbnNhY3Rpb25zLCBkb24ndCBmaXJlIHdhdGNo
ZXMsIGJ1dCBxdWV1ZSB0aGVtLiAqLwpAQCAtMTUwLDYgKzE1MSw4IEBAIHZv
aWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCXJldHVybjsKIAl9
CiAKKwlyZXEgPSBkb21haW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pID8gY29u
bi0+aW4gOiBOVUxMOworCiAJLyogQ3JlYXRlIGFuIGV2ZW50IGZvciBlYWNo
IHdhdGNoLiAqLwogCWxpc3RfZm9yX2VhY2hfZW50cnkoaSwgJmNvbm5lY3Rp
b25zLCBsaXN0KSB7CiAJCS8qIGludHJvZHVjZS9yZWxlYXNlIGRvbWFpbiB3
YXRjaGVzICovCkBAIC0xNjQsMTIgKzE2NywxMiBAQCB2b2lkIGZpcmVfd2F0
Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4
LCBjb25zdCBjaGFyICpuYW1lLAogCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KHdh
dGNoLCAmaS0+d2F0Y2hlcywgbGlzdCkgewogCQkJaWYgKGV4YWN0KSB7CiAJ
CQkJaWYgKHN0cmVxKG5hbWUsIHdhdGNoLT5ub2RlKSkKLQkJCQkJc2VuZF9l
dmVudChpLAorCQkJCQlzZW5kX2V2ZW50KHJlcSwgaSwKIAkJCQkJCSAgIGdl
dF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKIAkJCQkJCSAgIHdhdGNoLT50
b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChpc19jaGlsZChuYW1lLCB3
YXRjaC0+bm9kZSkpCi0JCQkJCXNlbmRfZXZlbnQoaSwKKwkJCQkJc2VuZF9l
dmVudChyZXEsIGksCiAJCQkJCQkgICBnZXRfd2F0Y2hfcGF0aCh3YXRjaCwg
bmFtZSksCiAJCQkJCQkgICB3YXRjaC0+dG9rZW4pOwogCQkJfQpAQCAtMjM4
LDggKzI0MSwxMiBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAl0YWxsb2Nfc2V0
X2Rlc3RydWN0b3Iod2F0Y2gsIGRlc3Ryb3lfd2F0Y2gpOwogCXNlbmRfYWNr
KGNvbm4sIFhTX1dBVENIKTsKIAotCS8qIFdlIGZpcmUgb25jZSB1cCBmcm9u
dDogc2ltcGxpZmllcyBjbGllbnRzIGFuZCByZXN0YXJ0LiAqLwotCXNlbmRf
ZXZlbnQoY29ubiwgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2Rl
KSwgd2F0Y2gtPnRva2VuKTsKKwkvKgorCSAqIFdlIGZpcmUgb25jZSB1cCBm
cm9udDogc2ltcGxpZmllcyBjbGllbnRzIGFuZCByZXN0YXJ0LgorCSAqIFRo
aXMgZXZlbnQgd2lsbCBub3QgYmUgbGlua2VkIHRvIHRoZSBYU19XQVRDSCBy
ZXF1ZXN0LgorCSAqLworCXNlbmRfZXZlbnQoTlVMTCwgY29ubiwgZ2V0X3dh
dGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2RlKSwKKwkJICAgd2F0Y2gtPnRv
a2VuKTsKIAogCXJldHVybiAwOwogfQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSA1YzE4YWU1ZWQ5NmZkNjJmNDYyYjRiZTlhOTUwMjJmMTQzZjZkZWU0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGRvbid0IGJ1
ZmZlciBtdWx0aXBsZSBpZGVudGljYWwgd2F0Y2ggZXZlbnRzCgpBIGd1ZXN0
IG5vdCByZWFkaW5nIGl0cyBYZW5zdG9yZSByZXNwb25zZSBidWZmZXIgZmFz
dCBlbm91Z2ggbWlnaHQKcGlsZSB1cCBsb3RzIG9mIFhlbnN0b3JlIHdhdGNo
IGV2ZW50cyBidWZmZXJlZC4gUmVkdWNlIHRoZSBnZW5lcmF0ZWQKbG9hZCBi
eSBkcm9wcGluZyBuZXcgZXZlbnRzIHdoaWNoIGFscmVhZHkgaGF2ZSBhbiBp
ZGVudGljYWwgY29weQpwZW5kaW5nLgoKVGhlIHNwZWNpYWwgZXZlbnRzICJA
Li4uIiBhcmUgZXhjbHVkZWQgZnJvbSB0aGF0IGhhbmRsaW5nIGFzIHRoZXJl
IGFyZQprbm93biB1c2UgY2FzZXMgd2hlcmUgdGhlIGhhbmRsZXIgaXMgcmVs
eWluZyBvbiBlYWNoIGV2ZW50IHRvIGJlIHNlbnQKaW5kaXZpZHVhbGx5LgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCA1ZjE3MzMxMTJhNGYuLjA2MjEw
MjNiY2ExNiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CkBAIC04MjEsNiArODIxLDcgQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwK
IAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0gMDsKIAli
ZGF0YS0+dGltZW91dF9tc2VjID0gMDsKKwliZGF0YS0+d2F0Y2hfZXZlbnQg
PSBmYWxzZTsKIAogCWlmIChsZW4gPD0gREVGQVVMVF9CVUZGRVJfU0laRSkK
IAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZhdWx0X2J1ZmZlcjsKQEAg
LTg1Myw3ICs4NTQsNyBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAogdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQljb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp0b2tlbikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRh
dGE7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLCAqYmQ7CiAJdW5z
aWduZWQgaW50IGxlbjsKIAogCWxlbiA9IHN0cmxlbihwYXRoKSArIDEgKyBz
dHJsZW4odG9rZW4pICsgMTsKQEAgLTg3NSwxMiArODc2LDI5IEBAIHZvaWQg
c2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKIAliZGF0YS0+aGRyLm1zZy50eXBlID0gWFNf
V0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVuOwogCisJ
LyoKKwkgKiBDaGVjayB3aGV0aGVyIGFuIGlkZW50aWNhbCBldmVudCBpcyBw
ZW5kaW5nIGFscmVhZHkuCisJICogU3BlY2lhbCBldmVudHMgYXJlIGV4Y2x1
ZGVkIGZyb20gdGhhdCBjaGVjay4KKwkgKi8KKwlpZiAocGF0aFswXSAhPSAn
QCcpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShiZCwgJmNvbm4tPm91dF9s
aXN0LCBsaXN0KSB7CisJCQlpZiAoYmQtPndhdGNoX2V2ZW50ICYmIGJkLT5o
ZHIubXNnLmxlbiA9PSBsZW4gJiYKKwkJCSAgICAhbWVtY21wKGJkYXRhLT5i
dWZmZXIsIGJkLT5idWZmZXIsIGxlbikpIHsKKwkJCQl0cmFjZSgiZHJvcHBp
bmcgZHVwbGljYXRlIHdhdGNoICVzICVzIGZvciBkb21haW4gJXVcbiIsCisJ
CQkJICAgICAgcGF0aCwgdG9rZW4sIGNvbm4tPmlkKTsKKwkJCQl0YWxsb2Nf
ZnJlZShiZGF0YSk7CisJCQkJcmV0dXJuOworCQkJfQorCQl9CisJfQorCiAJ
aWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5faXNfdW5w
cml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21zZWMgPSBn
ZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIAkJ
aWYgKCFjb25uLT50aW1lb3V0X21zZWMpCiAJCQljb25uLT50aW1lb3V0X21z
ZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOwogCX0KIAorCWJkYXRhLT53YXRj
aF9ldmVudCA9IHRydWU7CiAJYmRhdGEtPnBlbmQucmVxID0gcmVxOwogCWlm
IChyZXEpCiAJCXJlcS0+cGVuZC5yZWYuZXZlbnRfY250Kys7CmRpZmYgLS1n
aXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBlZGVhYTk2ZGQxMGIu
LjFlYjYxMzFmYzg4ZCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCkBAIC01MSw2ICs1MSw5IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBoZWFkZXI/ICovCiAJYm9v
bCBpbmhkcjsKIAorCS8qIElzIHRoaXMgYSB3YXRjaCBldmVudD8gKi8KKwli
b29sIHdhdGNoX2V2ZW50OworCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSA2NjVhNmFlN2E0ZWIzOTc3NTY0YTZmMDBjOTE3NThmOTg4ZTM1YmU4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGZpeCBjb25u
ZWN0aW9uLT5pZCB1c2FnZQoKRG9uJ3QgdXNlIGNvbm4tPmlkIGZvciBwcml2
aWxlZ2UgY2hlY2tzLCBidXQgZG9tYWluX2lzX3VucHJpdmlsZWdlZCgpLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvbnRyb2wuYwppbmRleCBlNGI4YWE5NWFiZmQu
LmQzMjcyZTJlZjliNSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvbnRyb2wuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCkBAIC0xODAsNyArMTgwLDcgQEAgaW50IGRvX2NvbnRy
b2woc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9k
YXRhICppbikKIAlpbnQgY21kOwogCWNoYXIgKip2ZWM7CiAKLQlpZiAoY29u
bi0+aWQgIT0gMCkKKwlpZiAoZG9tYWluX2lzX3VucHJpdmlsZWdlZChjb25u
KSkKIAkJcmV0dXJuIEVBQ0NFUzsKIAogCW51bSA9IHhzX2NvdW50X3N0cmlu
Z3MoaW4tPmJ1ZmZlciwgaW4tPnVzZWQpOwpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmgKaW5kZXggMWViNjEzMWZjODhkLi45OGRiNGFmY2Fh
YmYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAt
OTMsNyArOTMsNyBAQCBzdHJ1Y3QgY29ubmVjdGlvbgogCS8qIFRoZSBpbmRl
eCBvZiBwb2xsZmQgaW4gZ2xvYmFsIHBvbGxmZCBhcnJheSAqLwogCWludCBw
b2xsZmRfaWR4OwogCi0JLyogV2hvIGFtIEk/IDAgZm9yIHNvY2tldCBjb25u
ZWN0aW9ucy4gKi8KKwkvKiBXaG8gYW0gST8gRG9taWQgb2YgY29ubmVjdGlv
bi4gKi8KIAl1bnNpZ25lZCBpbnQgaWQ7CiAKIAkvKiBJcyB0aGlzIGEgcmVh
ZC1vbmx5IGNvbm5lY3Rpb24/ICovCmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IDZmYmRiMjlkY2RkNy4u
OWJlZjZlNzJhNTY2IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNDgzLDcgKzQ4Myw4IEBAIGludCBk
b190cmFuc2FjdGlvbl9zdGFydChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmluKQogCWlmIChjb25uLT50cmFuc2Fj
dGlvbikKIAkJcmV0dXJuIEVCVVNZOwogCi0JaWYgKGNvbm4tPmlkICYmIGNv
bm4tPnRyYW5zYWN0aW9uX3N0YXJ0ZWQgPiBxdW90YV9tYXhfdHJhbnNhY3Rp
b24pCisJaWYgKGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYKKwkg
ICAgY29ubi0+dHJhbnNhY3Rpb25fc3RhcnRlZCA+IHF1b3RhX21heF90cmFu
c2FjdGlvbikKIAkJcmV0dXJuIEVOT1NQQzsKIAogCS8qIEF0dGFjaCB0cmFu
c2FjdGlvbiB0byBpbnB1dCBmb3IgYXV0b2ZyZWUgdW50aWwgaXQncyBjb21w
bGV0ZSAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSBiZmRhYjM5NWIwODk5M2M2YmRhN2M1NDZkNmQxOTMyZDdjYWI4ODM0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNpbXBsaWZ5
IGFuZCBmaXggcGVyIGRvbWFpbiBub2RlIGFjY291bnRpbmcKClRoZSBhY2Nv
dW50aW5nIG9mIG5vZGVzIGNhbiBiZSBzaW1wbGlmaWVkIG5vdyB0aGF0IGVh
Y2ggY29ubmVjdGlvbgpob2xkcyB0aGUgYXNzb2NpYXRlZCBkb21pZC4KCkZp
eCB0aGUgbm9kZSBhY2NvdW50aW5nIHRvIGNvdmVyIG5vZGVzIGNyZWF0ZWQg
Zm9yIGEgZG9tYWluIGJlZm9yZSBpdApoYXMgYmVlbiBpbnRyb2R1Y2VkLiBU
aGlzIHJlcXVpcmVzIHRvIHJlYWN0IHByb3Blcmx5IHRvIGFuIGFsbG9jYXRp
b24KZmFpbHVyZSBpbnNpZGUgZG9tYWluX2VudHJ5X2luYygpIGJ5IHJldHVy
bmluZyBhbiBlcnJvciBjb2RlLgoKRXNwZWNpYWxseSBpbiBlcnJvciBwYXRo
cyB0aGUgbm9kZSBhY2NvdW50aW5nIGhhcyB0byBiZSBmaXhlZCBpbiBzb21l
CmNhc2VzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYgLyBDVkUtMjAyMi00
MjMxMy4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6
b24uY29tPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29u
dHJvbC5jCmluZGV4IGQzMjcyZTJlZjliNS4uNzE1ZTBkMmE5ZTAzIDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMKQEAgLTI1
LDYgKzI1LDcgQEAKICNpbmNsdWRlICJ0YWxsb2MuaCIKICNpbmNsdWRlICJ4
ZW5zdG9yZWRfY29yZS5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF9jb250cm9s
LmgiCisjaW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgogCiBzdHJ1Y3Qg
Y21kX3MgewogCWNoYXIgKmNtZDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5jCmluZGV4IDA2MjEwMjNiY2ExNi4uOThkMjQyZTA2MjQxIDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTU0Myw3
ICs1NDMsNyBAQCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBQZXJtaXNz
aW9ucyBhcmUgc3RydWN0IHhzX3Blcm1pc3Npb25zLiAqLwogCW5vZGUtPnBl
cm1zLnAgPSBoZHItPnBlcm1zOwotCWlmIChkb21haW5fYWRqdXN0X25vZGVf
cGVybXMobm9kZSkpIHsKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1z
KGNvbm4sIG5vZGUpKSB7CiAJCXRhbGxvY19mcmVlKG5vZGUpOwogCQlyZXR1
cm4gTlVMTDsKIAl9CkBAIC01NjUsNyArNTY1LDcgQEAgaW50IHdyaXRlX25v
ZGVfcmF3KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5
LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAl2b2lkICpwOwogCXN0cnVjdCB4c190
ZGJfcmVjb3JkX2hkciAqaGRyOwogCi0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhub2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1z
KGNvbm4sIG5vZGUpKQogCQlyZXR1cm4gZXJybm87CiAKIAlkYXRhLmRzaXpl
ID0gc2l6ZW9mKCpoZHIpCkBAIC0xMTU5LDEzICsxMTU5LDE3IEBAIHN0YXRp
YyBzdHJ1Y3Qgbm9kZSAqY29uc3RydWN0X25vZGUoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0K
IAotc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQorc3RhdGljIHZvaWQgZGVzdHJv
eV9ub2RlX3JtKHN0cnVjdCBub2RlICpub2RlKQogewogCWlmIChzdHJlcShu
b2RlLT5uYW1lLCAiLyIpKQogCQljb3JydXB0KE5VTEwsICJEZXN0cm95aW5n
IHJvb3Qgbm9kZSEiKTsKIAogCXRkYl9kZWxldGUodGRiX2N0eCwgbm9kZS0+
a2V5KTsKK30KIAorc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoreworCWRlc3Ry
b3lfbm9kZV9ybShub2RlKTsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5v
ZGUpOwogCiAJLyoKQEAgLTEyMTUsOCArMTIxOSwxMiBAQCBzdGF0aWMgc3Ry
dWN0IG5vZGUgKmNyZWF0ZV9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LCBjb25zdCB2b2lkICpjdHgsCiAJCQlnb3RvIGVycjsKIAogCQkvKiBBY2Nv
dW50IGZvciBuZXcgbm9kZSAqLwotCQlpZiAoaS0+cGFyZW50KQotCQkJZG9t
YWluX2VudHJ5X2luYyhjb25uLCBpKTsKKwkJaWYgKGktPnBhcmVudCkgewor
CQkJaWYgKGRvbWFpbl9lbnRyeV9pbmMoY29ubiwgaSkpIHsKKwkJCQlkZXN0
cm95X25vZGVfcm0oaSk7CisJCQkJcmV0dXJuIE5VTEw7CisJCQl9CisJCX0K
IAl9CiAKIAlyZXR1cm4gbm9kZTsKQEAgLTE0OTcsMTAgKzE1MDUsMjcgQEAg
c3RhdGljIGludCBkb19zZXRfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAlvbGRfcGVybXMgPSBu
b2RlLT5wZXJtczsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwog
CW5vZGUtPnBlcm1zID0gcGVybXM7Ci0JZG9tYWluX2VudHJ5X2luYyhjb25u
LCBub2RlKTsKKwlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKSkg
eworCQlub2RlLT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyoKKwkJICogVGhp
cyBzaG91bGQgbmV2ZXIgZmFpbCBiZWNhdXNlIHdlIGhhZCBhIHJlZmVyZW5j
ZSBvbiB0aGUKKwkJICogZG9tYWluIGJlZm9yZSBhbmQgWGVuc3RvcmVkIGlz
IHNpbmdsZS10aHJlYWRlZC4KKwkJICovCisJCWRvbWFpbl9lbnRyeV9pbmMo
Y29ubiwgbm9kZSk7CisJCXJldHVybiBFTk9NRU07CisJfQogCi0JaWYgKHdy
aXRlX25vZGUoY29ubiwgbm9kZSwgZmFsc2UpKQorCWlmICh3cml0ZV9ub2Rl
KGNvbm4sIG5vZGUsIGZhbHNlKSkgeworCQlpbnQgc2F2ZWRfZXJybm8gPSBl
cnJubzsKKworCQlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOworCQlu
b2RlLT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyogTm8gZmFpbHVyZSBwb3Nz
aWJsZSBhcyBhYm92ZS4gKi8KKwkJZG9tYWluX2VudHJ5X2luYyhjb25uLCBu
b2RlKTsKKworCQllcnJubyA9IHNhdmVkX2Vycm5vOwogCQlyZXR1cm4gZXJy
bm87CisJfQogCiAJZmlyZV93YXRjaGVzKGNvbm4sIGluLCBuYW1lLCBub2Rl
LCBmYWxzZSwgJm9sZF9wZXJtcyk7CiAJc2VuZF9hY2soY29ubiwgWFNfU0VU
X1BFUk1TKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9kb21haW4uYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4u
YwppbmRleCA1OGI3ZTBmZTJmYTcuLmY0MTM0ZGIzZTczYSAxMDA2NDQKLS0t
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwpAQCAtMTYsNiArMTYs
NyBAQAogICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNl
ZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCiAqLwogCisjaW5j
bHVkZSA8YXNzZXJ0Lmg+CiAjaW5jbHVkZSA8c3RkaW8uaD4KICNpbmNsdWRl
IDxzeXMvbW1hbi5oPgogI2luY2x1ZGUgPHVuaXN0ZC5oPgpAQCAtMzYyLDYg
KzM2MywxOCBAQCBzdGF0aWMgc3RydWN0IGRvbWFpbiAqYWxsb2NfZG9tYWlu
KHZvaWQgKmNvbnRleHQsIHVuc2lnbmVkIGludCBkb21pZCkKIAlyZXR1cm4g
ZG9tYWluOwogfQogCitzdGF0aWMgc3RydWN0IGRvbWFpbiAqZmluZF9vcl9h
bGxvY19leGlzdGluZ19kb21haW4odW5zaWduZWQgaW50IGRvbWlkKQorewor
CXN0cnVjdCBkb21haW4gKmRvbWFpbjsKKwl4Y19kb21pbmZvX3QgZG9taW5m
bzsKKworCWRvbWFpbiA9IGZpbmRfZG9tYWluX3N0cnVjdChkb21pZCk7CisJ
aWYgKCFkb21haW4gJiYgZ2V0X2RvbWFpbl9pbmZvKGRvbWlkLCAmZG9taW5m
bykpCisJCWRvbWFpbiA9IGFsbG9jX2RvbWFpbihOVUxMLCBkb21pZCk7CisK
KwlyZXR1cm4gZG9tYWluOworfQorCiBzdGF0aWMgaW50IG5ld19kb21haW4o
c3RydWN0IGRvbWFpbiAqZG9tYWluLCBpbnQgcG9ydCkKIHsKIAlpbnQgcmM7
CkBAIC03NzQsMzAgKzc4NywyOCBAQCB2b2lkIGRvbWFpbl9pbml0KHZvaWQp
CiAJdmlycV9wb3J0ID0gcmM7CiB9CiAKLXZvaWQgZG9tYWluX2VudHJ5X2lu
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKm5vZGUp
CitpbnQgZG9tYWluX2VudHJ5X2luYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgc3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJc3RydWN0IGRvbWFpbiAqZDsK
Kwl1bnNpZ25lZCBpbnQgZG9taWQ7CiAKIAlpZiAoIWNvbm4pCi0JCXJldHVy
bjsKKwkJcmV0dXJuIDA7CiAKLQlpZiAobm9kZS0+cGVybXMucCAmJiBub2Rl
LT5wZXJtcy5wWzBdLmlkICE9IGNvbm4tPmlkKSB7Ci0JCWlmIChjb25uLT50
cmFuc2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfaW5jKGNvbm4t
PnRyYW5zYWN0aW9uLAotCQkJCW5vZGUtPnBlcm1zLnBbMF0uaWQpOwotCQl9
IGVsc2UgewotCQkJZCA9IGZpbmRfZG9tYWluX2J5X2RvbWlkKG5vZGUtPnBl
cm1zLnBbMF0uaWQpOwotCQkJaWYgKGQpCi0JCQkJZC0+bmJlbnRyeSsrOwot
CQl9Ci0JfSBlbHNlIGlmIChjb25uLT5kb21haW4pIHsKLQkJaWYgKGNvbm4t
PnRyYW5zYWN0aW9uKSB7Ci0JCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29u
bi0+dHJhbnNhY3Rpb24sCi0JCQkJY29ubi0+ZG9tYWluLT5kb21pZCk7Ci0g
CQl9IGVsc2UgewotIAkJCWNvbm4tPmRvbWFpbi0+bmJlbnRyeSsrOwotCQl9
CisJZG9taWQgPSBub2RlLT5wZXJtcy5wID8gbm9kZS0+cGVybXMucFswXS5p
ZCA6IGNvbm4tPmlkOworCisJaWYgKGNvbm4tPnRyYW5zYWN0aW9uKSB7CisJ
CXRyYW5zYWN0aW9uX2VudHJ5X2luYyhjb25uLT50cmFuc2FjdGlvbiwgZG9t
aWQpOworCX0gZWxzZSB7CisJCWQgPSAoZG9taWQgPT0gY29ubi0+aWQgJiYg
Y29ubi0+ZG9tYWluKSA/IGNvbm4tPmRvbWFpbgorCQkgICAgOiBmaW5kX29y
X2FsbG9jX2V4aXN0aW5nX2RvbWFpbihkb21pZCk7CisJCWlmIChkKQorCQkJ
ZC0+bmJlbnRyeSsrOworCQllbHNlCisJCQlyZXR1cm4gRU5PTUVNOwogCX0K
KworCXJldHVybiAwOwogfQogCiAvKgpAQCAtODMzLDcgKzg0NCw3IEBAIHN0
YXRpYyBpbnQgY2hrX2RvbWFpbl9nZW5lcmF0aW9uKHVuc2lnbmVkIGludCBk
b21pZCwgdWludDY0X3QgZ2VuKQogICogUmVtb3ZlIHBlcm1pc3Npb25zIGZv
ciBubyBsb25nZXIgZXhpc3RpbmcgZG9tYWlucyBpbiBvcmRlciB0byBhdm9p
ZCBhIG5ldwogICogZG9tYWluIHdpdGggdGhlIHNhbWUgZG9taWQgaW5oZXJp
dGluZyB0aGUgcGVybWlzc2lvbnMuCiAgKi8KLWludCBkb21haW5fYWRqdXN0
X25vZGVfcGVybXMoc3RydWN0IG5vZGUgKm5vZGUpCitpbnQgZG9tYWluX2Fk
anVzdF9ub2RlX3Blcm1zKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1
Y3Qgbm9kZSAqbm9kZSkKIHsKIAl1bnNpZ25lZCBpbnQgaTsKIAlpbnQgcmV0
OwpAQCAtODQzLDggKzg1NCwxNCBAQCBpbnQgZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKHN0cnVjdCBub2RlICpub2RlKQogCQlyZXR1cm4gZXJybm87CiAK
IAkvKiBJZiB0aGUgb3duZXIgZG9lc24ndCBleGlzdCBhbnkgbG9uZ2VyIGdp
dmUgaXQgdG8gcHJpdiBkb21haW4uICovCi0JaWYgKCFyZXQpCisJaWYgKCFy
ZXQpIHsKKwkJLyoKKwkJICogSW4gdGhlb3J5IHdlJ2QgbmVlZCB0byB1cGRh
dGUgdGhlIG51bWJlciBvZiBkb20wIG5vZGVzIGhlcmUsCisJCSAqIGJ1dCB3
ZSBjb3VsZCBiZSBjYWxsZWQgZm9yIGEgcmVhZCBvZiB0aGUgbm9kZS4gU28g
YmV0dGVyCisJCSAqIGF2b2lkIHRoZSByaXNrIHRvIG92ZXJmbG93IHRoZSBu
b2RlIGNvdW50IG9mIGRvbTAuCisJCSAqLwogCQlub2RlLT5wZXJtcy5wWzBd
LmlkID0gcHJpdl9kb21pZDsKKwl9CiAKIAlmb3IgKGkgPSAxOyBpIDwgbm9k
ZS0+cGVybXMubnVtOyBpKyspIHsKIAkJaWYgKG5vZGUtPnBlcm1zLnBbaV0u
cGVybXMgJiBYU19QRVJNX0lHTk9SRSkKQEAgLTg2MywyNSArODgwLDI1IEBA
IGludCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMoc3RydWN0IG5vZGUgKm5v
ZGUpCiB2b2lkIGRvbWFpbl9lbnRyeV9kZWMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogewogCXN0cnVjdCBkb21haW4g
KmQ7CisJdW5zaWduZWQgaW50IGRvbWlkOwogCiAJaWYgKCFjb25uKQogCQly
ZXR1cm47CiAKLQlpZiAobm9kZS0+cGVybXMucCAmJiBub2RlLT5wZXJtcy5w
WzBdLmlkICE9IGNvbm4tPmlkKSB7Ci0JCWlmIChjb25uLT50cmFuc2FjdGlv
bikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfZGVjKGNvbm4tPnRyYW5zYWN0
aW9uLAotCQkJCW5vZGUtPnBlcm1zLnBbMF0uaWQpOwotCQl9IGVsc2Ugewot
CQkJZCA9IGZpbmRfZG9tYWluX2J5X2RvbWlkKG5vZGUtPnBlcm1zLnBbMF0u
aWQpOwotCQkJaWYgKGQgJiYgZC0+bmJlbnRyeSkKLQkJCQlkLT5uYmVudHJ5
LS07Ci0JCX0KLQl9IGVsc2UgaWYgKGNvbm4tPmRvbWFpbiAmJiBjb25uLT5k
b21haW4tPm5iZW50cnkpIHsKLQkJaWYgKGNvbm4tPnRyYW5zYWN0aW9uKSB7
Ci0JCQl0cmFuc2FjdGlvbl9lbnRyeV9kZWMoY29ubi0+dHJhbnNhY3Rpb24s
Ci0JCQkJY29ubi0+ZG9tYWluLT5kb21pZCk7CisJZG9taWQgPSBub2RlLT5w
ZXJtcy5wID8gbm9kZS0+cGVybXMucFswXS5pZCA6IGNvbm4tPmlkOworCisJ
aWYgKGNvbm4tPnRyYW5zYWN0aW9uKSB7CisJCXRyYW5zYWN0aW9uX2VudHJ5
X2RlYyhjb25uLT50cmFuc2FjdGlvbiwgZG9taWQpOworCX0gZWxzZSB7CisJ
CWQgPSAoZG9taWQgPT0gY29ubi0+aWQgJiYgY29ubi0+ZG9tYWluKSA/IGNv
bm4tPmRvbWFpbgorCQkgICAgOiBmaW5kX2RvbWFpbl9zdHJ1Y3QoZG9taWQp
OworCQlpZiAoZCkgeworCQkJZC0+bmJlbnRyeS0tOwogCQl9IGVsc2Ugewot
CQkJY29ubi0+ZG9tYWluLT5uYmVudHJ5LS07CisJCQllcnJubyA9IEVOT0VO
VDsKKwkJCWNvcnJ1cHQoY29ubiwKKwkJCQkiTm9kZSBcIiVzXCIgb3duZWQg
Ynkgbm9uLWV4aXN0aW5nIGRvbWFpbiAldVxuIiwKKwkJCQlub2RlLT5uYW1l
LCBkb21pZCk7CiAJCX0KIAl9CiB9CkBAIC04OTEsMTMgKzkwOCwyMyBAQCBp
bnQgZG9tYWluX2VudHJ5X2ZpeCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBu
dW0sIGJvb2wgdXBkYXRlKQogCXN0cnVjdCBkb21haW4gKmQ7CiAJaW50IGNu
dDsKIAotCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21pZChkb21pZCk7Ci0JaWYg
KCFkKQotCQlyZXR1cm4gMDsKKwlpZiAodXBkYXRlKSB7CisJCWQgPSBmaW5k
X2RvbWFpbl9zdHJ1Y3QoZG9taWQpOworCQlhc3NlcnQoZCk7CisJfSBlbHNl
IHsKKwkJLyoKKwkJICogV2UgYXJlIGNhbGxlZCBmaXJzdCB3aXRoIHVwZGF0
ZSA9PSBmYWxzZSBpbiBvcmRlciB0byBjYXRjaAorCQkgKiBhbnkgZXJyb3Iu
IFNvIGRvIGEgcG9zc2libGUgYWxsb2NhdGlvbiBhbmQgY2hlY2sgZm9yIGVy
cm9yCisJCSAqIG9ubHkgaW4gdGhpcyBjYXNlLCBhcyBpbiB0aGUgY2FzZSBv
ZiB1cGRhdGUgPT0gdHJ1ZSBub3RoaW5nCisJCSAqIGNhbiBnbyB3cm9uZyBh
bnltb3JlIGFzIHRoZSBhbGxvY2F0aW9uIGFscmVhZHkgaGFwcGVuZWQuCisJ
CSAqLworCQlkID0gZmluZF9vcl9hbGxvY19leGlzdGluZ19kb21haW4oZG9t
aWQpOworCQlpZiAoIWQpCisJCQlyZXR1cm4gLTE7CisJfQogCiAJY250ID0g
ZC0+bmJlbnRyeSArIG51bTsKLQlpZiAoY250IDwgMCkKLQkJY250ID0gMDsK
Kwlhc3NlcnQoY250ID49IDApOwogCiAJaWYgKHVwZGF0ZSkKIAkJZC0+bmJl
bnRyeSA9IGNudDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21h
aW4uaAppbmRleCA0YmZmMmU2NTViOWIuLjRlZGYxZGJhOTQyNSAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCisrKyBi
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaApAQCAtNTcsMTAg
KzU3LDEwIEBAIGJvb2wgZG9tYWluX2Nhbl93cml0ZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubik7CiBib29sIGRvbWFpbl9pc191bnByaXZpbGVnZWQoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogCiAvKiBSZW1vdmUgbm9kZSBwZXJt
aXNzaW9ucyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5nIGRvbWFpbnMuICovCi1p
bnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVjdCBub2RlICpub2Rl
KTsKK2ludCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKTsKIAogLyogUXVvdGEg
bWFuaXB1bGF0aW9uICovCi12b2lkIGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICopOworaW50IGRvbWFp
bl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICopOwogdm9pZCBkb21haW5fZW50cnlfZGVjKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqKTsKIGludCBkb21haW5fZW50cnlf
Zml4KHVuc2lnbmVkIGludCBkb21pZCwgaW50IG51bSwgYm9vbCB1cGRhdGUp
OwogaW50IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNh
Y3Rpb24uYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlv
bi5jCmluZGV4IDliZWY2ZTcyYTU2Ni4uYmYyZmRhODIzNGIzIDEwMDY0NAot
LS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwor
KysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpA
QCAtNTIzLDggKzUyMywxMiBAQCBzdGF0aWMgaW50IHRyYW5zYWN0aW9uX2Zp
eF9kb21haW5zKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIGJvb2wgdXBk
YXRlKQogCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShkLCAmdHJhbnMtPmNoYW5n
ZWRfZG9tYWlucywgbGlzdCkgewogCQljbnQgPSBkb21haW5fZW50cnlfZml4
KGQtPmRvbWlkLCBkLT5uYmVudHJ5LCB1cGRhdGUpOwotCQlpZiAoIXVwZGF0
ZSAmJiBjbnQgPj0gcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbikKLQkJCXJl
dHVybiBFTk9TUEM7CisJCWlmICghdXBkYXRlKSB7CisJCQlpZiAoY250ID49
IHF1b3RhX25iX2VudHJ5X3Blcl9kb21haW4pCisJCQkJcmV0dXJuIEVOT1NQ
QzsKKwkJCWlmIChjbnQgPCAwKQorCQkJCXJldHVybiBFTk9NRU07CisJCX0K
IAl9CiAKIAlyZXR1cm4gMDsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-09.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-09.patch"
Content-Transfer-Encoding: base64

RnJvbSA3ZDMxM2Y0MzIyZTQ0NDI1ODgyYjIxNzY0YmM5YzQyYTc5MGQwMzBh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG1h
eCBudW1iZXIgb2Ygbm9kZXMgYWNjZXNzZWQgaW4gYSB0cmFuc2FjdGlvbgoK
VG9kYXkgYSBndWVzdCBpcyBmcmVlIHRvIGFjY2VzcyBhcyBtYW55IG5vZGVz
IGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uCmFzIGl0IHdhbnRzLiBUaGlzIGNh
biBsZWFkIHRvIHVuYm91bmRlZCBtZW1vcnkgY29uc3VtcHRpb24gaW4gWGVu
c3RvcmUKYXMgdGhlcmUgaXMgdGhlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiBh
bGwgbm9kZXMgaGF2aW5nIGJlZW4gYWNjZXNzZWQKZHVyaW5nIGEgdHJhbnNh
Y3Rpb24uCgpJbiBveGVuc3RvcmVkIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMg
aW4gYSB0cmFuc2FjdGlvbiBpcyBiZWluZyBsaW1pdGVkCnZpYSBhIHF1b3Rh
IG1heHJlcXVlc3RzIChkZWZhdWx0IGlzIDEwMjQpLiBBcyBtdWx0aXBsZSBh
Y2Nlc3NlcyBvZiBhCm5vZGUgYXJlIG5vdCBwcm9ibGVtYXRpYyBpbiBDIFhl
bnN0b3JlLCBsaW1pdCB0aGUgbnVtYmVyIG9mIGFjY2Vzc2VkCm5vZGVzLgoK
SW4gb3JkZXIgdG8gbGV0IHJlYWRfbm9kZSgpIGRldGVjdCBhIHF1b3RhIGVy
cm9yIGluIGNhc2UgdG9vIG1hbnkgbm9kZXMKYXJlIGJlaW5nIGFjY2Vzc2Vk
LCBjaGVjayB0aGUgcmV0dXJuIHZhbHVlIG9mIGFjY2Vzc19ub2RlKCkgYW5k
IHJldHVybgpOVUxMIGluIGNhc2UgYW4gZXJyb3IgaGFzIGJlZW4gc2Vlbi4g
SW50cm9kdWNlIF9fbXVzdF9jaGVjayBhbmQgYWRkIGl0CnRvIHRoZSBhY2Nl
c3Nfbm9kZSgpIHByb3RvdHlwZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2
IC8gQ1ZFLTIwMjItNDIzMTQuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxs
IDxqZ3JhbGxAYW1hem9uLmNvbT4KU3VnZ2VzdGVkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGp1bGllbkB4ZW4ub3JnPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdy
b3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL2lu
Y2x1ZGUveGVuLXRvb2xzL2xpYnMuaCBiL3Rvb2xzL2luY2x1ZGUveGVuLXRv
b2xzL2xpYnMuaAppbmRleCBjYzdkZmM4YzY0NTMuLjM0ZGIzYjc4NDczMiAx
MDA2NDQKLS0tIGEvdG9vbHMvaW5jbHVkZS94ZW4tdG9vbHMvbGlicy5oCisr
KyBiL3Rvb2xzL2luY2x1ZGUveGVuLXRvb2xzL2xpYnMuaApAQCAtNTksNCAr
NTksOCBAQAogICAgIH0pCiAjZW5kaWYKIAorI2lmbmRlZiBfX211c3RfY2hl
Y2sKKyNkZWZpbmUgX19tdXN0X2NoZWNrIF9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKQorI2VuZGlmCisKICNlbmRpZgkvKiBfX1hF
Tl9UT09MU19MSUJTX18gKi8KZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jCmluZGV4IDk4ZDI0MmUwNjI0MS4uNTdjOTk5MTI5MjE1IDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisrKyBi
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTEwMiw2ICsx
MDIsNyBAQCBpbnQgcXVvdGFfbmJfd2F0Y2hfcGVyX2RvbWFpbiA9IDEyODsK
IGludCBxdW90YV9tYXhfZW50cnlfc2l6ZSA9IDIwNDg7IC8qIDJLICovCiBp
bnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uID0gMTA7CiBpbnQgcXVvdGFfbmJf
cGVybXNfcGVyX25vZGUgPSA1OworaW50IHF1b3RhX3RyYW5zX25vZGVzID0g
MTAyNDsKIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSAyMDsKIAogdW5z
aWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIwMDAwOwpA
QCAtNTAwLDYgKzUwMSw3IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlUREJf
REFUQSBrZXksIGRhdGE7CiAJc3RydWN0IHhzX3RkYl9yZWNvcmRfaGRyICpo
ZHI7CiAJc3RydWN0IG5vZGUgKm5vZGU7CisJaW50IGVycjsKIAogCW5vZGUg
PSB0YWxsb2MoY3R4LCBzdHJ1Y3Qgbm9kZSk7CiAJaWYgKCFub2RlKSB7CkBA
IC01MjEsMTQgKzUyMywxMyBAQCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAJaWYg
KGRhdGEuZHB0ciA9PSBOVUxMKSB7CiAJCWlmICh0ZGJfZXJyb3IodGRiX2N0
eCkgPT0gVERCX0VSUl9OT0VYSVNUKSB7CiAJCQlub2RlLT5nZW5lcmF0aW9u
ID0gTk9fR0VORVJBVElPTjsKLQkJCWFjY2Vzc19ub2RlKGNvbm4sIG5vZGUs
IE5PREVfQUNDRVNTX1JFQUQsIE5VTEwpOwotCQkJZXJybm8gPSBFTk9FTlQ7
CisJCQllcnIgPSBhY2Nlc3Nfbm9kZShjb25uLCBub2RlLCBOT0RFX0FDQ0VT
U19SRUFELCBOVUxMKTsKKwkJCWVycm5vID0gZXJyID8gOiBFTk9FTlQ7CiAJ
CX0gZWxzZSB7CiAJCQlsb2coIlREQiBlcnJvciBvbiByZWFkOiAlcyIsIHRk
Yl9lcnJvcnN0cih0ZGJfY3R4KSk7CiAJCQllcnJubyA9IEVJTzsKIAkJfQot
CQl0YWxsb2NfZnJlZShub2RlKTsKLQkJcmV0dXJuIE5VTEw7CisJCWdvdG8g
ZXJyb3I7CiAJfQogCiAJbm9kZS0+cGFyZW50ID0gTlVMTDsKQEAgLTU0Mywx
OSArNTQ0LDM2IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAogCS8qIFBlcm1p
c3Npb25zIGFyZSBzdHJ1Y3QgeHNfcGVybWlzc2lvbnMuICovCiAJbm9kZS0+
cGVybXMucCA9IGhkci0+cGVybXM7Ci0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhjb25uLCBub2RlKSkgewotCQl0YWxsb2NfZnJlZShub2RlKTsK
LQkJcmV0dXJuIE5VTEw7Ci0JfQorCWlmIChkb21haW5fYWRqdXN0X25vZGVf
cGVybXMoY29ubiwgbm9kZSkpCisJCWdvdG8gZXJyb3I7CiAKIAkvKiBEYXRh
IGlzIGJpbmFyeSBibG9iICh1c3VhbGx5IGFzY2lpLCBubyBudWwpLiAqLwog
CW5vZGUtPmRhdGEgPSBub2RlLT5wZXJtcy5wICsgaGRyLT5udW1fcGVybXM7
CiAJLyogQ2hpbGRyZW4gaXMgc3RyaW5ncywgbnVsIHNlcGFyYXRlZC4gKi8K
IAlub2RlLT5jaGlsZHJlbiA9IG5vZGUtPmRhdGEgKyBub2RlLT5kYXRhbGVu
OwogCi0JYWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVB
RCwgTlVMTCk7CisJaWYgKGFjY2Vzc19ub2RlKGNvbm4sIG5vZGUsIE5PREVf
QUNDRVNTX1JFQUQsIE5VTEwpKQorCQlnb3RvIGVycm9yOwogCiAJcmV0dXJu
IG5vZGU7CisKKyBlcnJvcjoKKwllcnIgPSBlcnJubzsKKwl0YWxsb2NfZnJl
ZShub2RlKTsKKwllcnJubyA9IGVycjsKKwlyZXR1cm4gTlVMTDsKK30KKwor
c3RhdGljIGJvb2wgcmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJybm8odm9p
ZCkKK3sKKwkvKgorCSAqIDIgZXJyb3IgY2FzZXMgZm9yIHJlYWRfbm9kZSgp
IGNhbiBhbHdheXMgYmUgcHJvcGFnYXRlZCB1cDoKKwkgKiBFTk9NRU0sIGJl
Y2F1c2UgdGhpcyBoYXMgbm90aGluZyB0byBkbyB3aXRoIHRoZSBub2RlIGJl
aW5nIGluIHRoZQorCSAqIGRhdGEgYmFzZSBvciBub3QsIGJ1dCBpcyBjYXVz
ZWQgYnkgYSBnZW5lcmFsIGxhY2sgb2YgbWVtb3J5LgorCSAqIEVOT1NQQywg
YmVjYXVzZSB0aGlzIGlzIHJlbGF0ZWQgdG8gaGl0dGluZyBxdW90YSBsaW1p
dHMgd2hpY2ggbmVlZAorCSAqIHRvIGJlIHJlc3BlY3RlZC4KKwkgKi8KKwly
ZXR1cm4gZXJybm8gPT0gRU5PTUVNIHx8IGVycm5vID09IEVOT1NQQzsKIH0K
IAogaW50IHdyaXRlX25vZGVfcmF3KHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKQEAgLTY3MCw3
ICs2ODgsNyBAQCBzdGF0aWMgaW50IGFza19wYXJlbnRzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAJCW5vZGUgPSByZWFk
X25vZGUoY29ubiwgY3R4LCBuYW1lKTsKIAkJaWYgKG5vZGUpCiAJCQlicmVh
azsKLQkJaWYgKGVycm5vID09IEVOT01FTSkKKwkJaWYgKHJlYWRfbm9kZV9j
YW5fcHJvcGFnYXRlX2Vycm5vKCkpCiAJCQlyZXR1cm4gZXJybm87CiAJfSB3
aGlsZSAoIXN0cmVxKG5hbWUsICIvIikpOwogCkBAIC03MzMsNyArNzUxLDcg
QEAgc3RhdGljIHN0cnVjdCBub2RlICpnZXRfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwKIAkJfQogCX0KIAkvKiBDbGVhbiB1cCBlcnJubyBpZiB0
aGV5IHdlcmVuJ3Qgc3VwcG9zZWQgdG8ga25vdy4gKi8KLQlpZiAoIW5vZGUg
JiYgZXJybm8gIT0gRU5PTUVNKQorCWlmICghbm9kZSAmJiAhcmVhZF9ub2Rl
X2Nhbl9wcm9wYWdhdGVfZXJybm8oKSkKIAkJZXJybm8gPSBlcnJub19mcm9t
X3BhcmVudHMoY29ubiwgY3R4LCBuYW1lLCBlcnJubywgcGVybSk7CiAJcmV0
dXJuIG5vZGU7CiB9CkBAIC0xMTE1LDcgKzExMzMsNyBAQCBzdGF0aWMgc3Ry
dWN0IG5vZGUgKmNvbnN0cnVjdF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBJZiBwYXJlbnQgZG9lc24n
dCBleGlzdCwgY3JlYXRlIGl0LiAqLwogCXBhcmVudCA9IHJlYWRfbm9kZShj
b25uLCBwYXJlbnRuYW1lLCBwYXJlbnRuYW1lKTsKLQlpZiAoIXBhcmVudCkK
KwlpZiAoIXBhcmVudCAmJiBlcnJubyA9PSBFTk9FTlQpCiAJCXBhcmVudCA9
IGNvbnN0cnVjdF9ub2RlKGNvbm4sIGN0eCwgcGFyZW50bmFtZSk7CiAJaWYg
KCFwYXJlbnQpCiAJCXJldHVybiBOVUxMOwpAQCAtMTM5NCw3ICsxNDEyLDcg
QEAgc3RhdGljIGludCBfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IHZvaWQgKmN0eCwgc3RydWN0IG5vZGUgKm5vZGUsCiAKIAlwYXJlbnQg
PSByZWFkX25vZGUoY29ubiwgY3R4LCBwYXJlbnRuYW1lKTsKIAlpZiAoIXBh
cmVudCkKLQkJcmV0dXJuIChlcnJubyA9PSBFTk9NRU0pID8gRU5PTUVNIDog
RUlOVkFMOworCQlyZXR1cm4gcmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSA/IGVycm5vIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9IHBhcmVu
dDsKIAogCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBhcmVudCwg
bm9kZSwgZmFsc2UpOwpAQCAtMTQyMiw3ICsxNDQwLDcgQEAgc3RhdGljIGlu
dCBkb19ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmluKQogCQkJCXJldHVybiAwOwogCQkJfQogCQkJLyogUmVz
dG9yZSBlcnJubywganVzdCBpbiBjYXNlLiAqLwotCQkJaWYgKGVycm5vICE9
IEVOT01FTSkKKwkJCWlmICghcmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSkKIAkJCQllcnJubyA9IEVOT0VOVDsKIAkJfQogCQlyZXR1cm4gZXJy
bm87CkBAIC0yMTkyLDYgKzIyMTAsOCBAQCBzdGF0aWMgdm9pZCB1c2FnZSh2
b2lkKQogIiAgLUEsIC0tcGVybS1uYiA8bmI+ICAgICAgbGltaXQgdGhlIG51
bWJlciBvZiBwZXJtaXNzaW9ucyBwZXIgbm9kZSxcbiIKICIgIC1RLCAtLXF1
b3RhIDx3aGF0Pj08bmI+IHNldCB0aGUgcXVvdGEgPHdoYXQ+IHRvIHRoZSB2
YWx1ZSA8bmI+LCBhbGxvd2VkXG4iCiAiICAgICAgICAgICAgICAgICAgICAg
ICAgICBxdW90YXMgYXJlOlxuIgorIiAgICAgICAgICAgICAgICAgICAgICAg
ICAgdHJhbnNhY3Rpb24tbm9kZXM6IG51bWJlciBvZiBhY2Nlc3NlZCBub2Rl
IHBlclxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHRyYW5zYWN0aW9uXG4iCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICBvdXRzdGFuZGluZzogbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJl
cXVlc3RzXG4iCiAiICAtdywgLS10aW1lb3V0IDx3aGF0Pj08c2Vjb25kcz4g
ICBzZXQgdGhlIHRpbWVvdXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+LFxuIgog
IiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZCB0aW1lb3V0IGNh
bmRpZGF0ZXMgYXJlOlxuIgpAQCAtMjI3Myw2ICsyMjkzLDggQEAgc3RhdGlj
IHZvaWQgc2V0X3F1b3RhKGNvbnN0IGNoYXIgKmFyZykKIAl2YWwgPSBnZXRf
b3B0dmFsX2ludChlcSArIDEpOwogCWlmICh3aGF0X21hdGNoZXMoYXJnLCAi
b3V0c3RhbmRpbmciKSkKIAkJcXVvdGFfcmVxX291dHN0YW5kaW5nID0gdmFs
OworCWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlvbi1u
b2RlcyIpKQorCQlxdW90YV90cmFuc19ub2RlcyA9IHZhbDsKIAllbHNlCiAJ
CWJhcmYoInVua25vd24gcXVvdGEgXCIlc1wiXG4iLCBhcmcpOwogfQpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggOThkYjRhZmNh
YWJmLi43ZTM3MTI1M2QyZDEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuaApAQCAtMzQsNiArMzQsNyBAQAogI2luY2x1ZGUgImxpc3Qu
aCIKICNpbmNsdWRlICJ0ZGIuaCIKICNpbmNsdWRlICJoYXNodGFibGUuaCIK
KyNpbmNsdWRlICJ1dGlscy5oIgogCiAvKiBERUZBVUxUX0JVRkZFUl9TSVpF
IHNob3VsZCBiZSBsYXJnZSBlbm91Z2ggZm9yIGVhY2ggZXJybm8gc3RyaW5n
LiAqLwogI2RlZmluZSBERUZBVUxUX0JVRkZFUl9TSVpFIDE2CkBAIC0yMjMs
NiArMjI0LDcgQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0ZXJuIGlu
dCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9wZXJf
ZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmc7Citl
eHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOwogCiBleHRlcm4gdW5zaWdu
ZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwppbmRleCBi
ZjJmZGE4MjM0YjMuLjc3OGI3ZTQzOWNiMyAxMDA2NDQKLS0tIGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKKysrIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKQEAgLTE1Niw2ICsx
NTYsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBDb25uZWN0aW9uLWxv
Y2FsIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNhY3Rpb24uICovCiAJdWlu
dDMyX3QgaWQ7CiAKKwkvKiBOb2RlIGNvdW50ZXIuICovCisJdW5zaWduZWQg
aW50IG5vZGVzOworCiAJLyogR2VuZXJhdGlvbiB3aGVuIHRyYW5zYWN0aW9u
IHN0YXJ0ZWQuICovCiAJdWludDY0X3QgZ2VuZXJhdGlvbjsKIApAQCAtMjY2
LDYgKzI2OSwxMSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogCiAJaSA9IGZpbmRfYWNj
ZXNzZWRfbm9kZSh0cmFucywgbm9kZS0+bmFtZSk7CiAJaWYgKCFpKSB7CisJ
CWlmICh0cmFucy0+bm9kZXMgPj0gcXVvdGFfdHJhbnNfbm9kZXMgJiYKKwkJ
ICAgIGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikpIHsKKwkJCXJldCA9
IEVOT1NQQzsKKwkJCWdvdG8gZXJyOworCQl9CiAJCWkgPSB0YWxsb2NfemVy
byh0cmFucywgc3RydWN0IGFjY2Vzc2VkX25vZGUpOwogCQlpZiAoIWkpCiAJ
CQlnb3RvIG5vbWVtOwpAQCAtMzAzLDYgKzMxMSw3IEBAIGludCBhY2Nlc3Nf
bm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKm5v
ZGUsCiAJCQkJaS0+dGFfbm9kZSA9IHRydWU7CiAJCQl9CiAJCX0KKwkJdHJh
bnMtPm5vZGVzKys7CiAJCWxpc3RfYWRkX3RhaWwoJmktPmxpc3QsICZ0cmFu
cy0+YWNjZXNzZWQpOwogCX0KIApkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmggYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uaAppbmRleCAwMDkzY2FjODA3ZTMuLmUz
Y2JkNmIyMzA5NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX3RyYW5zYWN0aW9uLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX3RyYW5zYWN0aW9uLmgKQEAgLTM5LDggKzM5LDggQEAgdm9pZCB0cmFu
c2FjdGlvbl9lbnRyeV9pbmMoc3RydWN0IHRyYW5zYWN0aW9uICp0cmFucywg
dW5zaWduZWQgaW50IGRvbWlkKTsKIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlf
ZGVjKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBk
b21pZCk7CiAKIC8qIFRoaXMgbm9kZSB3YXMgYWNjZXNzZWQuICovCi1pbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAotICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKK2ludCBfX211c3RfY2hlY2sg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVt
IG5vZGVfYWNjZXNzX3R5cGUgdHlwZSwgVERCX0RBVEEgKmtleSk7CiAKIC8q
IFF1ZXVlIHdhdGNoZXMgZm9yIGEgbW9kaWZpZWQgbm9kZS4gKi8KIHZvaWQg
cXVldWVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
Y2hhciAqbmFtZSwgYm9vbCB3YXRjaF9leGFjdCk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-10.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-10.patch"
Content-Transfer-Encoding: base64

RnJvbSBhMGQzYmNlODI3Y2E2NTZmYjVkOGY0NjJiYjY3ODZmOTU2N2RkZGZh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1vdmUgdGhl
IGNhbGwgb2Ygc2V0dXBfc3RydWN0dXJlKCkgdG8gZG9tMAogaW50cm9kdWN0
aW9uCgpTZXR0aW5nIHVwIHRoZSBiYXNpYyBzdHJ1Y3R1cmUgd2hlbiBpbnRy
b2R1Y2luZyBkb20wIGhhcyB0aGUgYWR2YW50YWdlCnRvIGJlIGFibGUgdG8g
YWRkIHByb3BlciBub2RlIG1lbW9yeSBhY2NvdW50aW5nIGZvciB0aGUgYWRk
ZWQgbm9kZXMKbGF0ZXIuCgpUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIGRv
IHByb3BlciBub2RlIGFjY291bnRpbmcsIHRvby4KCkFuIGFkZGl0aW9uYWwg
cmVxdWlyZW1lbnQgdG8gbWFrZSB0aGF0IHdvcmsgZmluZSBpcyB0byBjb3Jy
ZWN0IHRoZQpvd25lciBvZiB0aGUgY3JlYXRlZCBub2RlcyB0byBiZSBkb20w
X2RvbWlkIGluc3RlYWQgb2YgZG9taWQgMC4KClRoaXMgaXMgcGFydCBvZiBY
U0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMK
aW5kZXggNTdjOTk5MTI5Mi4uMTMzNTA1MWE1MyAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xODMyLDcgKzE4MzIsOCBAQCBz
dGF0aWMgaW50IHRkYl9mbGFnczsKIHN0YXRpYyB2b2lkIG1hbnVhbF9ub2Rl
KGNvbnN0IGNoYXIgKm5hbWUsIGNvbnN0IGNoYXIgKmNoaWxkKQogewogCXN0
cnVjdCBub2RlICpub2RlOwotCXN0cnVjdCB4c19wZXJtaXNzaW9ucyBwZXJt
cyA9IHsgLmlkID0gMCwgLnBlcm1zID0gWFNfUEVSTV9OT05FIH07CisJc3Ry
dWN0IHhzX3Blcm1pc3Npb25zIHBlcm1zID0geyAuaWQgPSBkb20wX2RvbWlk
LAorCQkJCQkucGVybXMgPSBYU19QRVJNX05PTkUgfTsKIAogCW5vZGUgPSB0
YWxsb2NfemVybyhOVUxMLCBzdHJ1Y3Qgbm9kZSk7CiAJaWYgKCFub2RlKQpA
QCAtMTg3MSw3ICsxODcyLDcgQEAgc3RhdGljIHZvaWQgdGRiX2xvZ2dlcihU
REJfQ09OVEVYVCAqdGRiLCBpbnQgbGV2ZWwsIGNvbnN0IGNoYXIgKiBmbXQs
IC4uLikKIAl9CiB9CiAKLXN0YXRpYyB2b2lkIHNldHVwX3N0cnVjdHVyZSh2
b2lkKQordm9pZCBzZXR1cF9zdHJ1Y3R1cmUodm9pZCkKIHsKIAljaGFyICp0
ZGJuYW1lOwogCXRkYm5hbWUgPSB0YWxsb2Nfc3RyZHVwKHRhbGxvY19hdXRv
ZnJlZV9jb250ZXh0KCksIHhzX2RhZW1vbl90ZGIoKSk7CkBAIC0xODg5LDYg
KzE4OTAsNyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9zdHJ1Y3R1cmUodm9pZCkK
IAltYW51YWxfbm9kZSgiLyIsICJ0b29sIik7CiAJbWFudWFsX25vZGUoIi90
b29sIiwgInhlbnN0b3JlZCIpOwogCW1hbnVhbF9ub2RlKCIvdG9vbC94ZW5z
dG9yZWQiLCBOVUxMKTsKKwlkb21haW5fZW50cnlfZml4KGRvbTBfZG9taWQs
IDMsIHRydWUpOwogCiAJY2hlY2tfc3RvcmUoKTsKIH0KQEAgLTI0MDIsOSAr
MjQwNCw2IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAK
IAlpbml0X3BpcGUocmVvcGVuX2xvZ19waXBlKTsKIAotCS8qIFNldHVwIHRo
ZSBkYXRhYmFzZSAqLwotCXNldHVwX3N0cnVjdHVyZSgpOwotCiAJLyogTGlz
dGVuIHRvIGh5cGVydmlzb3IuICovCiAJaWYgKCFub19kb21haW5faW5pdCkK
IAkJZG9tYWluX2luaXQoKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCmluZGV4IDdlMzcxMjUzZDIuLmQ5NWU0MjYyYTkgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMTk1LDYgKzE5NSw3
IEBAIGludCB3cml0ZV9ub2RlX3JhdyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgVERCX0RBVEEgKmtleSwgc3RydWN0IG5vZGUgKm5vZGUsCiBzdHJ1Y3Qg
bm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJCSAgICAgICBjb25zdCBjaGFyICpuYW1lKTsKIAor
dm9pZCBzZXR1cF9zdHJ1Y3R1cmUodm9pZCk7CiBzdHJ1Y3QgY29ubmVjdGlv
biAqbmV3X2Nvbm5lY3Rpb24oY29ubndyaXRlZm5fdCAqd3JpdGUsIGNvbm5y
ZWFkZm5fdCAqcmVhZCk7CiB2b2lkIGNoZWNrX3N0b3JlKHZvaWQpOwogdm9p
ZCBjb3JydXB0KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpmbXQsIC4uLik7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKaW5kZXggZjQxMzRkYjNlNy4uOGJmOWRiMmQ5NiAxMDA2NDQKLS0t
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwpAQCAtNzM5LDYgKzcz
OSw4IEBAIHN0YXRpYyBpbnQgZG9tMF9pbml0KHZvaWQpCiAJaWYgKGRvbTAt
PmludGVyZmFjZSA9PSBOVUxMKQogCQlyZXR1cm4gLTE7CiAKKwlzZXR1cF9z
dHJ1Y3R1cmUoKTsKKwogCXRhbGxvY19zdGVhbChkb20wLT5jb25uLCBkb20w
KTsgCiAKIAl4ZW5ldnRjaG5fbm90aWZ5KHhjZV9oYW5kbGUsIGRvbTAtPnBv
cnQpOwotLSAKMi4zNS4zCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-11.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-11.patch"
Content-Transfer-Encoding: base64

RnJvbSBhYzM2MzU0YzhmYWJmNThiMTI3ODEzNThkZWMzOWFlY2MzYTYzNzZi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBpbmZy
YXN0cnVjdHVyZSB0byBrZWVwIHRyYWNrIG9mIHBlciBkb21haW4gbWVtb3J5
CiB1c2FnZQoKVGhlIGFtb3VudCBvZiBtZW1vcnkgYSBkb21haW4gY2FuIGNv
bnN1bWUgaW4gWGVuc3RvcmUgaXMgbGltaXRlZCBieQp2YXJpb3VzIHF1b3Rh
IHRvZGF5LCBidXQgZXZlbiB3aXRoIHNhbmUgcXVvdGEgYSBkb21haW4gY2Fu
IHN0aWxsCmNvbnN1bWUgcmF0aGVyIGxhcmdlIG1lbW9yeSBxdWFudGl0aWVz
LgoKQWRkIHRoZSBpbmZyYXN0cnVjdHVyZSBmb3Iga2VlcGluZyB0cmFjayBv
ZiB0aGUgYW1vdW50IG9mIG1lbW9yeSBhCmRvbWFpbiBpcyBjb25zdW1pbmcg
aW4gWGVuc3RvcmUuIE5vdGUgdGhhdCB0aGlzIGlzIG9ubHkgdGhlIG1lbW9y
eSBhCmRvbWFpbiBoYXMgZGlyZWN0IGNvbnRyb2wgb3Zlciwgc28gYW55IGlu
dGVybmFsIGFkbWluaXN0cmF0aW9uIGRhdGEKbmVlZGVkIGJ5IFhlbnN0b3Jl
IG9ubHkgaXMgbm90IGJlaW5nIGFjY291bnRlZCBmb3IuCgpUaGVyZSBhcmUg
dHdvIHF1b3RhcyBkZWZpbmVkOiBhIHNvZnQgcXVvdGEgd2hpY2ggd2lsbCBy
ZXN1bHQgaW4gYQp3YXJuaW5nIGlzc3VlZCB2aWEgc3lzbG9nKCkgd2hlbiBp
dCBpcyBleGNlZWRlZCwgYW5kIGEgaGFyZCBxdW90YQpyZXN1bHRpbmcgaW4g
YSBzdG9wIG9mIGFjY2VwdGluZyBmdXJ0aGVyIHJlcXVlc3RzIG9yIHdhdGNo
IGV2ZW50cyBhcwpsb25nIGFzIHRoZSBoYXJkIHF1b3RhIHdvdWxkIGJlIHZp
b2xhdGVkIGJ5IGFjY2VwdGluZyB0aG9zZS4KClNldHRpbmcgYW55IG9mIHRo
b3NlIHF1b3RhcyB0byAwIHdpbGwgZGlzYWJsZSBpdC4KCkFzIGRlZmF1bHQg
dmFsdWVzIHVzZSAyTUIgcGVyIGRvbWFpbiBmb3IgdGhlIHNvZnQgbGltaXQg
KHRoaXMgYmFzaWNhbGx5CmNvdmVycyB0aGUgYWxsb3dlZCBjYXNlIHRvIGNy
ZWF0ZSAxMDAwIG5vZGVzIG5lZWRpbmcgMmtCIGVhY2gpLCBhbmQKMi41TUIg
Zm9yIHRoZSBoYXJkIGxpbWl0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCAxMzM1MDUxYTUzZjMuLjIxNzA5NmQ5MWE5ZCAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDQsNiArMTA0LDggQEAgaW50
IHF1b3RhX21heF90cmFuc2FjdGlvbiA9IDEwOwogaW50IHF1b3RhX25iX3Bl
cm1zX3Blcl9ub2RlID0gNTsKIGludCBxdW90YV90cmFuc19ub2RlcyA9IDEw
MjQ7CiBpbnQgcXVvdGFfcmVxX291dHN0YW5kaW5nID0gMjA7CitpbnQgcXVv
dGFfbWVtb3J5X3Blcl9kb21haW5fc29mdCA9IDIgKiAxMDI0ICogMTAyNDsg
LyogMiBNQiAqLworaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX2hhcmQg
PSAyICogMTAyNCAqIDEwMjQgKyA1MTIgKiAxMDI0OyAvKiAyLjUgTUIgKi8K
IAogdW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIw
MDAwOwogCkBAIC0yMjE0LDcgKzIyMTYsMTQgQEAgc3RhdGljIHZvaWQgdXNh
Z2Uodm9pZCkKICIgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RhcyBh
cmU6XG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlv
bi1ub2RlczogbnVtYmVyIG9mIGFjY2Vzc2VkIG5vZGUgcGVyXG4iCiAiICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJh
bnNhY3Rpb25cbiIKKyIgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbW9y
eTogdG90YWwgdXNlZCBtZW1vcnkgcGVyIGRvbWFpbiBmb3Igbm9kZXMsXG4i
CisiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0
aW9ucywgd2F0Y2hlcyBhbmQgcmVxdWVzdHMsIGFib3ZlXG4iCisiICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWNoIFhlbnN0b3JlIHdp
bGwgc3RvcCB0YWxraW5nIHRvIGRvbWFpblxuIgogIiAgICAgICAgICAgICAg
ICAgICAgICAgICAgb3V0c3RhbmRpbmc6IG51bWJlciBvZiBvdXRzdGFuZGlu
ZyByZXF1ZXN0c1xuIgorIiAgLXEsIC0tcXVvdGEtc29mdCA8d2hhdD49PG5i
PiBzZXQgYSBzb2Z0IHF1b3RhIDx3aGF0PiB0byB0aGUgdmFsdWUgPG5iPixc
biIKKyIgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdXNpbmcgYSB3YXJu
aW5nIHRvIGJlIGlzc3VlZCB2aWEgc3lzbG9nKCkgaWYgdGhlXG4iCisiICAg
ICAgICAgICAgICAgICAgICAgICAgICBsaW1pdCBpcyB2aW9sYXRlZCwgYWxs
b3dlZCBxdW90YXMgYXJlOlxuIgorIiAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWVtb3J5OiBzZWUgYWJvdmVcbiIKICIgIC13LCAtLXRpbWVvdXQgPHdo
YXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGltZW91dCBpbiBzZWNvbmRzIGZv
ciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxv
d2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6XG4iCiAiICAgICAgICAgICAg
ICAgICAgICAgICAgICB3YXRjaC1ldmVudDogdGltZSBhIHdhdGNoLWV2ZW50
IGlzIGtlcHQgcGVuZGluZ1xuIgpAQCAtMjI0MCw2ICsyMjQ5LDcgQEAgc3Rh
dGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRyYW5zYWN0
aW9uIiwgMSwgTlVMTCwgJ3QnIH0sCiAJeyAicGVybS1uYiIsIDEsIE5VTEws
ICdBJyB9LAogCXsgInF1b3RhIiwgMSwgTlVMTCwgJ1EnIH0sCisJeyAicXVv
dGEtc29mdCIsIDEsIE5VTEwsICdxJyB9LAogCXsgInRpbWVvdXQiLCAxLCBO
VUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5VTEwsICdSJyB9
LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0sCkBAIC0yMjg1
LDcgKzIyOTUsNyBAQCBzdGF0aWMgdm9pZCBzZXRfdGltZW91dChjb25zdCBj
aGFyICphcmcpCiAJCWJhcmYoInVua25vd24gdGltZW91dCBcIiVzXCJcbiIs
IGFyZyk7CiB9CiAKLXN0YXRpYyB2b2lkIHNldF9xdW90YShjb25zdCBjaGFy
ICphcmcpCitzdGF0aWMgdm9pZCBzZXRfcXVvdGEoY29uc3QgY2hhciAqYXJn
LCBib29sIHNvZnQpCiB7CiAJY29uc3QgY2hhciAqZXEgPSBzdHJjaHIoYXJn
LCAnPScpOwogCWludCB2YWw7CkBAIC0yMjkzLDExICsyMzAzLDE2IEBAIHN0
YXRpYyB2b2lkIHNldF9xdW90YShjb25zdCBjaGFyICphcmcpCiAJaWYgKCFl
cSkKIAkJYmFyZigicXVvdGFzIG11c3QgYmUgc3BlY2lmaWVkIHZpYSA8d2hh
dD49PG5iPlxuIik7CiAJdmFsID0gZ2V0X29wdHZhbF9pbnQoZXEgKyAxKTsK
LQlpZiAod2hhdF9tYXRjaGVzKGFyZywgIm91dHN0YW5kaW5nIikpCisJaWYg
KHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFuZGluZyIpICYmICFzb2Z0KQog
CQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7Ci0JZWxzZSBpZiAod2hh
dF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikpCisJZWxzZSBp
ZiAod2hhdF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikgJiYg
IXNvZnQpCiAJCXF1b3RhX3RyYW5zX25vZGVzID0gdmFsOwotCWVsc2UKKwll
bHNlIGlmICh3aGF0X21hdGNoZXMoYXJnLCAibWVtb3J5IikpIHsKKwkJaWYg
KHNvZnQpCisJCQlxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ID0gdmFs
OworCQllbHNlCisJCQlxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkID0g
dmFsOworCX0gZWxzZQogCQliYXJmKCJ1bmtub3duIHF1b3RhIFwiJXNcIlxu
IiwgYXJnKTsKIH0KIApAQCAtMjMxMiw3ICsyMzI3LDcgQEAgaW50IG1haW4o
aW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlpbnQgdGltZW91dDsKIAogCi0J
d2hpbGUgKChvcHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpI
TlBTOnQ6QTpROlQ6UlZXOnc6Iiwgb3B0aW9ucywKKwl3aGlsZSAoKG9wdCA9
IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOlE6cTpU
OlJWVzp3OiIsIG9wdGlvbnMsCiAJCQkJICBOVUxMKSkgIT0gLTEpIHsKIAkJ
c3dpdGNoIChvcHQpIHsKIAkJY2FzZSAnRCc6CkBAIC0yMzU4LDcgKzIzNzMs
MTAgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCXF1
b3RhX25iX3Blcm1zX3Blcl9ub2RlID0gc3RydG9sKG9wdGFyZywgTlVMTCwg
MTApOwogCQkJYnJlYWs7CiAJCWNhc2UgJ1EnOgotCQkJc2V0X3F1b3RhKG9w
dGFyZyk7CisJCQlzZXRfcXVvdGEob3B0YXJnLCBmYWxzZSk7CisJCQlicmVh
azsKKwkJY2FzZSAncSc6CisJCQlzZXRfcXVvdGEob3B0YXJnLCB0cnVlKTsK
IAkJCWJyZWFrOwogCQljYXNlICd3JzoKIAkJCXNldF90aW1lb3V0KG9wdGFy
Zyk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29y
ZS5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBk
OTVlNDI2MmE5MWUuLjRlNTMwNzJlNjM3YyAxMDA2NDQKLS0tIGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0yMjYsNiArMjI2LDggQEAgZXh0ZXJu
IGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9w
ZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmc7
CiBleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOworZXh0ZXJuIGludCBx
dW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0OworZXh0ZXJuIGludCBxdW90
YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkOwogCiBleHRlcm4gdW5zaWduZWQg
aW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0tZ2l0IGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IGU0MTFjNzlkNThhNy4u
MTEyZmI0NTc1ODFlIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2RvbWFpbi5jCkBAIC04NCw2ICs4NCwxMyBAQCBzdHJ1Y3QgZG9tYWluCiAJ
LyogbnVtYmVyIG9mIGVudHJ5IGZyb20gdGhpcyBkb21haW4gaW4gdGhlIHN0
b3JlICovCiAJaW50IG5iZW50cnk7CiAKKwkvKiBBbW91bnQgb2YgbWVtb3J5
IGFsbG9jYXRlZCBmb3IgdGhpcyBkb21haW4uICovCisJaW50IG1lbW9yeTsK
Kwlib29sIHNvZnRfcXVvdGFfcmVwb3J0ZWQ7CisJYm9vbCBoYXJkX3F1b3Rh
X3JlcG9ydGVkOworCXRpbWVfdCBtZW1fbGFzdF9tc2c7CisjZGVmaW5lIE1F
TV9XQVJOX01JTlRJTUVfU0VDIDEwCisKIAkvKiBudW1iZXIgb2Ygd2F0Y2gg
Zm9yIHRoaXMgZG9tYWluICovCiAJaW50IG5id2F0Y2g7CiAKQEAgLTI5Nyw2
ICszMDQsOSBAQCBib29sIGRvbWFpbl9jYW5fcmVhZChzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIAkJCXJldHVybiBmYWxzZTsKIAkJaWYgKGNvbm4tPmRv
bWFpbi0+bmJvdXRzdGFuZGluZyA+PSBxdW90YV9yZXFfb3V0c3RhbmRpbmcp
CiAJCQlyZXR1cm4gZmFsc2U7CisJCWlmIChjb25uLT5kb21haW4tPm1lbW9y
eSA+PSBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkICYmCisJCSAgICBx
dW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkKQorCQkJcmV0dXJuIGZhbHNl
OwogCX0KIAogCWlmIChjb25uLT5pc19pZ25vcmVkKQpAQCAtOTQ0LDYgKzk1
NCw4OSBAQCBpbnQgZG9tYWluX2VudHJ5KHN0cnVjdCBjb25uZWN0aW9uICpj
b25uKQogCQk6IDA7CiB9CiAKK3N0YXRpYyBib29sIGRvbWFpbl9jaGtfcXVv
dGEoc3RydWN0IGRvbWFpbiAqZG9tYWluLCBpbnQgbWVtKQoreworCXRpbWVf
dCBub3c7CisKKwlpZiAoIWRvbWFpbiB8fCAhZG9taWRfaXNfdW5wcml2aWxl
Z2VkKGRvbWFpbi0+ZG9taWQpIHx8CisJICAgIChkb21haW4tPmNvbm4gJiYg
ZG9tYWluLT5jb25uLT5pc19pZ25vcmVkKSkKKwkJcmV0dXJuIGZhbHNlOwor
CisJbm93ID0gdGltZShOVUxMKTsKKworCWlmIChtZW0gPj0gcXVvdGFfbWVt
b3J5X3Blcl9kb21haW5faGFyZCAmJgorCSAgICBxdW90YV9tZW1vcnlfcGVy
X2RvbWFpbl9oYXJkKSB7CisJCWlmIChkb21haW4tPmhhcmRfcXVvdGFfcmVw
b3J0ZWQpCisJCQlyZXR1cm4gdHJ1ZTsKKwkJc3lzbG9nKExPR19FUlIsICJE
b21haW4gJXUgZXhjZWVkcyBoYXJkIG1lbW9yeSBxdW90YSwgWGVuc3RvcmUg
aW50ZXJmYWNlIHRvIGRvbWFpbiBzdGFsbGVkXG4iLAorCQkgICAgICAgZG9t
YWluLT5kb21pZCk7CisJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93Owor
CQlkb21haW4tPmhhcmRfcXVvdGFfcmVwb3J0ZWQgPSB0cnVlOworCQlyZXR1
cm4gdHJ1ZTsKKwl9CisKKwlpZiAobm93IC0gZG9tYWluLT5tZW1fbGFzdF9t
c2cgPj0gTUVNX1dBUk5fTUlOVElNRV9TRUMpIHsKKwkJaWYgKGRvbWFpbi0+
aGFyZF9xdW90YV9yZXBvcnRlZCkgeworCQkJZG9tYWluLT5tZW1fbGFzdF9t
c2cgPSBub3c7CisJCQlkb21haW4tPmhhcmRfcXVvdGFfcmVwb3J0ZWQgPSBm
YWxzZTsKKwkJCXN5c2xvZyhMT0dfSU5GTywgIkRvbWFpbiAldSBiZWxvdyBo
YXJkIG1lbW9yeSBxdW90YSBhZ2FpblxuIiwKKwkJCSAgICAgICBkb21haW4t
PmRvbWlkKTsKKwkJfQorCQlpZiAobWVtID49IHF1b3RhX21lbW9yeV9wZXJf
ZG9tYWluX3NvZnQgJiYKKwkJICAgIHF1b3RhX21lbW9yeV9wZXJfZG9tYWlu
X3NvZnQgJiYKKwkJICAgICFkb21haW4tPnNvZnRfcXVvdGFfcmVwb3J0ZWQp
IHsKKwkJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93OworCQkJZG9tYWlu
LT5zb2Z0X3F1b3RhX3JlcG9ydGVkID0gdHJ1ZTsKKwkJCXN5c2xvZyhMT0df
V0FSTklORywgIkRvbWFpbiAldSBleGNlZWRzIHNvZnQgbWVtb3J5IHF1b3Rh
XG4iLAorCQkJICAgICAgIGRvbWFpbi0+ZG9taWQpOworCQl9CisJCWlmICht
ZW0gPCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ICYmCisJCSAgICBk
b21haW4tPnNvZnRfcXVvdGFfcmVwb3J0ZWQpIHsKKwkJCWRvbWFpbi0+bWVt
X2xhc3RfbXNnID0gbm93OworCQkJZG9tYWluLT5zb2Z0X3F1b3RhX3JlcG9y
dGVkID0gZmFsc2U7CisJCQlzeXNsb2coTE9HX0lORk8sICJEb21haW4gJXUg
YmVsb3cgc29mdCBtZW1vcnkgcXVvdGEgYWdhaW5cbiIsCisJCQkgICAgICAg
ZG9tYWluLT5kb21pZCk7CisJCX0KKworCX0KKworCXJldHVybiBmYWxzZTsK
K30KKworaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVkIGludCBkb21p
ZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjaykKK3sKKwlzdHJ1Y3Qg
ZG9tYWluICpkb21haW47CisKKwlkb21haW4gPSBmaW5kX2RvbWFpbl9zdHJ1
Y3QoZG9taWQpOworCWlmIChkb21haW4pIHsKKwkJLyoKKwkJICogZG9tYWlu
X2Noa19xdW90YSgpIHdpbGwgcHJpbnQgd2FybmluZyBhbmQgYWxzbyBzdG9y
ZSB3aGV0aGVyCisJCSAqIHRoZSBzb2Z0L2hhcmQgcXVvdGEgaGFzIGJlZW4g
aGl0LiBTbyBjaGVjayBub19xdW90YV9jaGVjaworCQkgKiAqYWZ0ZXIqLgor
CQkgKi8KKwkJaWYgKGRvbWFpbl9jaGtfcXVvdGEoZG9tYWluLCBkb21haW4t
Pm1lbW9yeSArIG1lbSkgJiYKKwkJICAgICFub19xdW90YV9jaGVjaykKKwkJ
CXJldHVybiBFTk9NRU07CisJCWRvbWFpbi0+bWVtb3J5ICs9IG1lbTsKKwl9
IGVsc2UgeworCQkvKgorCQkgKiBUaGUgZG9tYWluIHRoZSBtZW1vcnkgaXMg
dG8gYmUgYWNjb3VudGVkIGZvciBzaG91bGQgYWx3YXlzCisJCSAqIGV4aXN0
LCBhcyBhY2NvdW50aW5nIGlzIGRvbmUgZWl0aGVyIGZvciBhIGRvbWFpbiBy
ZWxhdGVkIHRvCisJCSAqIHRoZSBjdXJyZW50IGNvbm5lY3Rpb24sIG9yIGZv
ciB0aGUgZG9tYWluIG93bmluZyBhIG5vZGUKKwkJICogKHdoaWNoIGlzIGFs
d2F5cyBleGlzdGluZywgYXMgdGhlIG93bmVyIG9mIHRoZSBub2RlIGlzCisJ
CSAqIHRlc3RlZCB0byBleGlzdCBhbmQgcmVwbGFjZWQgYnkgZG9taWQgMCBp
ZiBub3QpLgorCQkgKiBTbyBub3QgZmluZGluZyB0aGUgcmVsYXRlZCBkb21h
aW4gTVVTVCBiZSBhbiBlcnJvciBpbiB0aGUKKwkJICogZGF0YSBiYXNlLgor
CQkgKi8KKwkJZXJybm8gPSBFTk9FTlQ7CisJCWNvcnJ1cHQoTlVMTCwgIkFj
Y291bnRpbmcgY2FsbGVkIGZvciBub24tZXhpc3RpbmcgZG9tYWluICV1XG4i
LAorCQkJZG9taWQpOworCQlyZXR1cm4gRU5PRU5UOworCX0KKworCXJldHVy
biAwOworfQorCiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaWYgKCFjb25uIHx8ICFjb25uLT5kb21haW4p
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWlu
LmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKaW5kZXgg
NGVkZjFkYmE5NDI1Li4zYThjNmJhYjQ4YmEgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAorKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY0LDYgKzY0LDI2IEBAIGlu
dCBkb21haW5fZW50cnlfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBz
dHJ1Y3Qgbm9kZSAqKTsKIHZvaWQgZG9tYWluX2VudHJ5X2RlYyhzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKik7CiBpbnQgZG9tYWlu
X2VudHJ5X2ZpeCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBudW0sIGJvb2wg
dXBkYXRlKTsKIGludCBkb21haW5fZW50cnkoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOworaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVkIGludCBk
b21pZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjayk7CisKKy8qCisg
KiBkb21haW5fbWVtb3J5X2FkZF9jaGsoKTogdG8gYmUgdXNlZCB3aGVuIG1l
bW9yeSBxdW90YSBzaG91bGQgYmUgY2hlY2tlZC4KKyAqIE5vdCB0byBiZSB1
c2VkIHdoZW4gc3BlY2lmeWluZyBhIG5lZ2F0aXZlIG1lbSB2YWx1ZSwgYXMg
bG93ZXJpbmcgdGhlIHVzZWQKKyAqIG1lbW9yeSBzaG91bGQgYWx3YXlzIGJl
IGFsbG93ZWQuCisgKi8KK3N0YXRpYyBpbmxpbmUgaW50IGRvbWFpbl9tZW1v
cnlfYWRkX2Noayh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0pCit7CisJ
cmV0dXJuIGRvbWFpbl9tZW1vcnlfYWRkKGRvbWlkLCBtZW0sIGZhbHNlKTsK
K30KKy8qCisgKiBkb21haW5fbWVtb3J5X2FkZF9ub2NoaygpOiB0byBiZSB1
c2VkIHdoZW4gbWVtb3J5IHF1b3RhIHNob3VsZCBub3QgYmUKKyAqIGNoZWNr
ZWQsIGUuZy4gd2hlbiBsb3dlcmluZyBtZW1vcnkgdXNhZ2UsIG9yIGluIGFu
IGVycm9yIGNhc2UgZm9yIHVuZG9pbmcKKyAqIGEgcHJldmlvdXMgbWVtb3J5
IGFkanVzdG1lbnQuCisgKi8KK3N0YXRpYyBpbmxpbmUgdm9pZCBkb21haW5f
bWVtb3J5X2FkZF9ub2Noayh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0p
Cit7CisJZG9tYWluX21lbW9yeV9hZGQoZG9taWQsIG1lbSwgdHJ1ZSk7Cit9
CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-12.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-12.patch"
Content-Transfer-Encoding: base64

RnJvbSBmYmQ5Y2FlMDMyYjQ1MmYwNGQ5MzgyM2Q0ODk3NGQ5NTdkODYzYmVi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3IgcmVzcG9uc2VzCgpBZGQgdGhlIG1lbW9yeSBh
Y2NvdW50aW5nIGZvciBxdWV1ZWQgcmVzcG9uc2VzLgoKSW4gY2FzZSBhZGRp
bmcgYSB3YXRjaCBldmVudCBmb3IgYSBndWVzdCBpcyBjYXVzaW5nIHRoZSBo
YXJkIG1lbW9yeQpxdW90YSBvZiB0aGF0IGd1ZXN0IHRvIGJlIHZpb2xhdGVk
LCB0aGUgZXZlbnQgaXMgZHJvcHBlZC4gVGhpcyB3aWxsCmVuc3VyZSB0aGF0
IGl0IGlzIGltcG9zc2libGUgdG8gZHJpdmUgYW5vdGhlciBndWVzdCBwYXN0
IGl0cyBtZW1vcnkKcXVvdGEgYnkgZ2VuZXJhdGluZyBpbnNhbmUgYW1vdW50
cyBvZiBldmVudHMgZm9yIHRoYXQgZ3Vlc3QuIFRoaXMgaXMKZXNwZWNpYWxs
eSBpbXBvcnRhbnQgZm9yIHByb3RlY3RpbmcgZHJpdmVyIGRvbWFpbnMgZnJv
bSB0aGF0IGF0dGFjawp2ZWN0b3IuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
NiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4g
R3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggMjE3MDk2ZDkxYTlkLi40ZjI5NDM5YWQ4
MjUgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MjU0LDYgKzI1NCw4IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0
YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIC1vdXQtPmhkci5tc2cu
bGVuIC0gc2l6ZW9mKG91dC0+aGRyKSk7CisKIAlpZiAob3V0LT5oZHIubXNn
LnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKIAkJcmVxID0gb3V0LT5wZW5k
LnJlcTsKIAkJaWYgKHJlcSkgewpAQCAtODQzLDExICs4NDUsMTQgQEAgdm9p
ZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhz
ZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAliZGF0YS0+dGltZW91dF9tc2VjID0g
MDsKIAliZGF0YS0+d2F0Y2hfZXZlbnQgPSBmYWxzZTsKIAotCWlmIChsZW4g
PD0gREVGQVVMVF9CVUZGRVJfU0laRSkKKwlpZiAobGVuIDw9IERFRkFVTFRf
QlVGRkVSX1NJWkUpIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZh
dWx0X2J1ZmZlcjsKLQllbHNlIHsKKwkJLyogRG9uJ3QgY2hlY2sgcXVvdGEs
IHBhdGggbWlnaHQgYmUgdXNlZCBmb3IgcmV0dXJuaW5nIGVycm9yLiAqLwor
CQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgbGVuICsgc2l6
ZW9mKGJkYXRhLT5oZHIpKTsKKwl9IGVsc2UgewogCQliZGF0YS0+YnVmZmVy
ID0gdGFsbG9jX2FycmF5KGJkYXRhLCBjaGFyLCBsZW4pOwotCQlpZiAoIWJk
YXRhLT5idWZmZXIpIHsKKwkJaWYgKCFiZGF0YS0+YnVmZmVyIHx8CisJCSAg
ICBkb21haW5fbWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVv
ZihiZGF0YS0+aGRyKSkpIHsKIAkJCXNlbmRfZXJyb3IoY29ubiwgRU5PTUVN
KTsKIAkJCXJldHVybjsKIAkJfQpAQCAtOTEyLDYgKzkxNywxMSBAQCB2b2lk
IHNlbmRfZXZlbnQoc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcSwgc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sCiAJCX0KIAl9CiAKKwlpZiAoZG9tYWluX21l
bW9yeV9hZGRfY2hrKGNvbm4tPmlkLCBsZW4gKyBzaXplb2YoYmRhdGEtPmhk
cikpKSB7CisJCXRhbGxvY19mcmVlKGJkYXRhKTsKKwkJcmV0dXJuOworCX0K
KwogCWlmICh0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMgJiYgZG9tYWluX2lz
X3VucHJpdmlsZWdlZChjb25uKSkgewogCQliZGF0YS0+dGltZW91dF9tc2Vj
ID0gZ2V0X25vd19tc2VjKCkgKyB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7
CiAJCWlmICghY29ubi0+dGltZW91dF9tc2VjKQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-13.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-13.patch"
Content-Transfer-Encoding: base64

RnJvbSBmYTIwMTlmZjJjMDcyNWMwZDkzZjRiZTc5YTcyOTUxNWY3MGExYTQw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igd2F0Y2hlcwoKQWRkIHRoZSBtZW1vcnkgYWNj
b3VudGluZyBmb3IgcmVnaXN0ZXJlZCB3YXRjaGVzLgoKV2hlbiBhIHNvY2tl
dCBjb25uZWN0aW9uIGlzIGRlc3Ryb3llZCwgdGhlIGFzc29jaWF0ZWQgd2F0
Y2hlcyBhcmUKcmVtb3ZlZCwgdG9vLiBJbiBvcmRlciB0byBrZWVwIG1lbW9y
eSBhY2NvdW50aW5nIGNvcnJlY3QgdGhlIHdhdGNoZXMKbXVzdCBiZSByZW1v
dmVkIGV4cGxpY2l0bHkgdmlhIGEgY2FsbCBvZiBjb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcygpIGZyb20KZGVzdHJveV9jb25uKCkuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggNGYyOTQzOWFkODI1Li5l
Y2EwNGU3MzRhODMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwpAQCAtNDA0LDYgKzQwNCw3IEBAIHN0YXRpYyBpbnQgZGVzdHJveV9j
b25uKHZvaWQgKl9jb25uKQogCX0KIAogCWNvbm5fZnJlZV9idWZmZXJlZF9k
YXRhKGNvbm4pOworCWNvbm5fZGVsZXRlX2FsbF93YXRjaGVzKGNvbm4pOwog
CWxpc3RfZm9yX2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxp
c3QpCiAJCXJlcS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwppbmRleCBjNTBjMDU3NWYwZjEu
LjcxMThjMzBlOGMzMiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX3dhdGNoLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X3dhdGNoLmMKQEAgLTIyNCw3ICsyMjQsOCBAQCBpbnQgZG9fd2F0Y2goc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICpp
bikKIAkJcmV0dXJuIEVOT01FTTsKIAl3YXRjaC0+bm9kZSA9IHRhbGxvY19z
dHJkdXAod2F0Y2gsIHZlY1swXSk7CiAJd2F0Y2gtPnRva2VuID0gdGFsbG9j
X3N0cmR1cCh3YXRjaCwgdmVjWzFdKTsKLQlpZiAoIXdhdGNoLT5ub2RlIHx8
ICF3YXRjaC0+dG9rZW4pIHsKKwlpZiAoIXdhdGNoLT5ub2RlIHx8ICF3YXRj
aC0+dG9rZW4gfHwKKwkgICAgZG9tYWluX21lbW9yeV9hZGRfY2hrKGNvbm4t
PmlkLCBzdHJsZW4odmVjWzBdKSArIHN0cmxlbih2ZWNbMV0pKSkgewogCQl0
YWxsb2NfZnJlZSh3YXRjaCk7CiAJCXJldHVybiBFTk9NRU07CiAJfQpAQCAt
MjY1LDYgKzI2Niw4IEBAIGludCBkb191bndhdGNoKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeSh3YXRjaCwgJmNvbm4tPndhdGNoZXMsIGxpc3QpIHsK
IAkJaWYgKHN0cmVxKHdhdGNoLT5ub2RlLCBub2RlKSAmJiBzdHJlcSh3YXRj
aC0+dG9rZW4sIHZlY1sxXSkpIHsKIAkJCWxpc3RfZGVsKCZ3YXRjaC0+bGlz
dCk7CisJCQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgLXN0
cmxlbih3YXRjaC0+bm9kZSkgLQorCQkJCQkJCSAgc3RybGVuKHdhdGNoLT50
b2tlbikpOwogCQkJdGFsbG9jX2ZyZWUod2F0Y2gpOwogCQkJZG9tYWluX3dh
dGNoX2RlYyhjb25uKTsKIAkJCXNlbmRfYWNrKGNvbm4sIFhTX1VOV0FUQ0gp
OwpAQCAtMjgwLDYgKzI4Myw4IEBAIHZvaWQgY29ubl9kZWxldGVfYWxsX3dh
dGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiAKIAl3aGlsZSAoKHdh
dGNoID0gbGlzdF90b3AoJmNvbm4tPndhdGNoZXMsIHN0cnVjdCB3YXRjaCwg
bGlzdCkpKSB7CiAJCWxpc3RfZGVsKCZ3YXRjaC0+bGlzdCk7CisJCWRvbWFp
bl9tZW1vcnlfYWRkX25vY2hrKGNvbm4tPmlkLCAtc3RybGVuKHdhdGNoLT5u
b2RlKSAtCisJCQkJCQkgIHN0cmxlbih3YXRjaC0+dG9rZW4pKTsKIAkJdGFs
bG9jX2ZyZWUod2F0Y2gpOwogCQlkb21haW5fd2F0Y2hfZGVjKGNvbm4pOwog
CX0K

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-14.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-14.patch"
Content-Transfer-Encoding: base64

RnJvbSAxNDVjODM3NWYzODJmZTg1MzVkNjMzODkxY2ZkYjQ3ZWMyOWE0OTBh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igbm9kZXMKCkFkZCB0aGUgbWVtb3J5IGFjY291
bnRpbmcgZm9yIFhlbnN0b3JlIG5vZGVzLiBJbiBvcmRlciB0byBtYWtlIHRo
aXMKbm90IHRvbyBjb21wbGljYXRlZCBhbGxvdyBmb3Igc29tZSBzbG9wcGlu
ZXNzIHdoZW4gd3JpdGluZyBub2Rlcy4gQW55CmhhcmQgcXVvdGEgdmlvbGF0
aW9uIHdpbGwgcmVzdWx0IGluIG5vIGZ1cnRoZXIgcmVxdWVzdHMgdG8gYmUg
YWNjZXB0ZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIy
LTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKaW5kZXggZWNhMDRlNzM0YTgzLi4yYzBmOGZkOTliYmQgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNDk2LDYgKzQ5Niwx
MTcgQEAgc3RhdGljIHZvaWQgaW5pdGlhbGl6ZV9mZHMoaW50IHNvY2ssIGlu
dCAqcF9zb2NrX3BvbGxmZF9pZHgsCiAJfQogfQogCitzdGF0aWMgdm9pZCBn
ZXRfYWNjX2RhdGEoVERCX0RBVEEgKmtleSwgc3RydWN0IG5vZGVfYWNjb3Vu
dF9kYXRhICphY2MpCit7CisJVERCX0RBVEEgb2xkX2RhdGE7CisJc3RydWN0
IHhzX3RkYl9yZWNvcmRfaGRyICpoZHI7CisKKwlpZiAoYWNjLT5tZW1vcnkg
PCAwKSB7CisJCW9sZF9kYXRhID0gdGRiX2ZldGNoKHRkYl9jdHgsICprZXkp
OworCQkvKiBObyBjaGVjayBmb3IgZXJyb3IsIGFzIHRoZSBub2RlIG1pZ2h0
IG5vdCBleGlzdC4gKi8KKwkJaWYgKG9sZF9kYXRhLmRwdHIgPT0gTlVMTCkg
eworCQkJYWNjLT5tZW1vcnkgPSAwOworCQl9IGVsc2UgeworCQkJaGRyID0g
KHZvaWQgKilvbGRfZGF0YS5kcHRyOworCQkJYWNjLT5tZW1vcnkgPSBvbGRf
ZGF0YS5kc2l6ZTsKKwkJCWFjYy0+ZG9taWQgPSBoZHItPnBlcm1zWzBdLmlk
OworCQl9CisJCXRhbGxvY19mcmVlKG9sZF9kYXRhLmRwdHIpOworCX0KK30K
KworLyoKKyAqIFBlci10cmFuc2FjdGlvbiBub2RlcyBuZWVkIHRvIGJlIGFj
Y291bnRlZCBmb3IgdGhlIHRyYW5zYWN0aW9uIG93bmVyLgorICogVGhvc2Ug
bm9kZXMgYXJlIHN0b3JlZCBpbiB0aGUgZGF0YSBiYXNlIHdpdGggdGhlIHRy
YW5zYWN0aW9uIGdlbmVyYXRpb24KKyAqIGNvdW50IHByZXBlbmRlZCAoZS5n
LiAxMjMvbG9jYWwvZG9tYWluLy4uLikuIFNvIHRlc3RpbmcgZm9yIHRoZSBu
b2RlJ3MKKyAqIGtleSBub3QgdG8gc3RhcnQgd2l0aCAiLyIgaXMgc3VmZmlj
aWVudC4KKyAqLworc3RhdGljIHVuc2lnbmVkIGludCBnZXRfYWNjX2RvbWlk
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LAorCQkJ
CSAgdW5zaWduZWQgaW50IGRvbWlkKQoreworCXJldHVybiAoIWNvbm4gfHwg
a2V5LT5kcHRyWzBdID09ICcvJykgPyBkb21pZCA6IGNvbm4tPmlkOworfQor
CitpbnQgZG9fdGRiX3dyaXRlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBU
REJfREFUQSAqa2V5LCBUREJfREFUQSAqZGF0YSwKKwkJIHN0cnVjdCBub2Rl
X2FjY291bnRfZGF0YSAqYWNjLCBib29sIG5vX3F1b3RhX2NoZWNrKQorewor
CXN0cnVjdCB4c190ZGJfcmVjb3JkX2hkciAqaGRyID0gKHZvaWQgKilkYXRh
LT5kcHRyOworCXN0cnVjdCBub2RlX2FjY291bnRfZGF0YSBvbGRfYWNjID0g
e307CisJdW5zaWduZWQgaW50IG9sZF9kb21pZCwgbmV3X2RvbWlkOworCWlu
dCByZXQ7CisKKwlpZiAoIWFjYykKKwkJb2xkX2FjYy5tZW1vcnkgPSAtMTsK
KwllbHNlCisJCW9sZF9hY2MgPSAqYWNjOworCisJZ2V0X2FjY19kYXRhKGtl
eSwgJm9sZF9hY2MpOworCW9sZF9kb21pZCA9IGdldF9hY2NfZG9taWQoY29u
biwga2V5LCBvbGRfYWNjLmRvbWlkKTsKKwluZXdfZG9taWQgPSBnZXRfYWNj
X2RvbWlkKGNvbm4sIGtleSwgaGRyLT5wZXJtc1swXS5pZCk7CisKKwkvKgor
CSAqIERvbid0IGNoZWNrIGZvciBFTk9FTlQsIGFzIHdlIHdhbnQgdG8gYmUg
YWJsZSB0byBzd2l0Y2ggb3JwaGFuZWQKKwkgKiBub2RlcyB0byBuZXcgb3du
ZXJzLgorCSAqLworCWlmIChvbGRfYWNjLm1lbW9yeSkKKwkJZG9tYWluX21l
bW9yeV9hZGRfbm9jaGsob2xkX2RvbWlkLAorCQkJCQktb2xkX2FjYy5tZW1v
cnkgLSBrZXktPmRzaXplKTsKKwlyZXQgPSBkb21haW5fbWVtb3J5X2FkZChu
ZXdfZG9taWQsIGRhdGEtPmRzaXplICsga2V5LT5kc2l6ZSwKKwkJCQlub19x
dW90YV9jaGVjayk7CisJaWYgKHJldCkgeworCQkvKiBFcnJvciBwYXRoLCBz
byBubyBxdW90YSBjaGVjay4gKi8KKwkJaWYgKG9sZF9hY2MubWVtb3J5KQor
CQkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsob2xkX2RvbWlkLAorCQkJCQkJ
b2xkX2FjYy5tZW1vcnkgKyBrZXktPmRzaXplKTsKKwkJcmV0dXJuIHJldDsK
Kwl9CisKKwkvKiBUREIgc2hvdWxkIHNldCBlcnJubywgYnV0IGRvZXNuJ3Qg
ZXZlbiBzZXQgZWNvZGUgQUZBSUNULiAqLworCWlmICh0ZGJfc3RvcmUodGRi
X2N0eCwgKmtleSwgKmRhdGEsIFREQl9SRVBMQUNFKSAhPSAwKSB7CisJCWRv
bWFpbl9tZW1vcnlfYWRkX25vY2hrKG5ld19kb21pZCwgLWRhdGEtPmRzaXpl
IC0ga2V5LT5kc2l6ZSk7CisJCS8qIEVycm9yIHBhdGgsIHNvIG5vIHF1b3Rh
IGNoZWNrLiAqLworCQlpZiAob2xkX2FjYy5tZW1vcnkpCisJCQlkb21haW5f
bWVtb3J5X2FkZF9ub2NoayhvbGRfZG9taWQsCisJCQkJCQlvbGRfYWNjLm1l
bW9yeSArIGtleS0+ZHNpemUpOworCQllcnJubyA9IEVJTzsKKwkJcmV0dXJu
IGVycm5vOworCX0KKworCWlmIChhY2MpIHsKKwkJLyogRG9uJ3QgdXNlIG5l
d19kb21pZCwgYXMgaXQgbWlnaHQgYmUgYSB0cmFuc2FjdGlvbiBub2RlLiAq
LworCQlhY2MtPmRvbWlkID0gaGRyLT5wZXJtc1swXS5pZDsKKwkJYWNjLT5t
ZW1vcnkgPSBkYXRhLT5kc2l6ZTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
aW50IGRvX3RkYl9kZWxldGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFRE
Ql9EQVRBICprZXksCisJCSAgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICph
Y2MpCit7CisJc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhIHRtcF9hY2M7CisJ
dW5zaWduZWQgaW50IGRvbWlkOworCisJaWYgKCFhY2MpIHsKKwkJYWNjID0g
JnRtcF9hY2M7CisJCWFjYy0+bWVtb3J5ID0gLTE7CisJfQorCisJZ2V0X2Fj
Y19kYXRhKGtleSwgYWNjKTsKKworCWlmICh0ZGJfZGVsZXRlKHRkYl9jdHgs
ICprZXkpKSB7CisJCWVycm5vID0gRUlPOworCQlyZXR1cm4gZXJybm87CisJ
fQorCisJaWYgKGFjYy0+bWVtb3J5KSB7CisJCWRvbWlkID0gZ2V0X2FjY19k
b21pZChjb25uLCBrZXksIGFjYy0+ZG9taWQpOworCQlkb21haW5fbWVtb3J5
X2FkZF9ub2Noayhkb21pZCwgLWFjYy0+bWVtb3J5IC0ga2V5LT5kc2l6ZSk7
CisJfQorCisJcmV0dXJuIDA7Cit9CisKIC8qCiAgKiBJZiBpdCBmYWlscywg
cmV0dXJucyBOVUxMIGFuZCBzZXRzIGVycm5vLgogICogVGVtcG9yYXJ5IG1l
bW9yeSBhbGxvY2F0aW9ucyB3aWxsIGJlIGRvbmUgd2l0aCBjdHguCkBAIC01
NDksOSArNjYwLDE1IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAogCS8qIFBl
cm1pc3Npb25zIGFyZSBzdHJ1Y3QgeHNfcGVybWlzc2lvbnMuICovCiAJbm9k
ZS0+cGVybXMucCA9IGhkci0+cGVybXM7CisJbm9kZS0+YWNjLmRvbWlkID0g
bm9kZS0+cGVybXMucFswXS5pZDsKKwlub2RlLT5hY2MubWVtb3J5ID0gZGF0
YS5kc2l6ZTsKIAlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4s
IG5vZGUpKQogCQlnb3RvIGVycm9yOwogCisJLyogSWYgb3duZXIgaXMgZ29u
ZSByZXNldCBjdXJyZW50bHkgYWNjb3VudGVkIG1lbW9yeSBzaXplLiAqLwor
CWlmIChub2RlLT5hY2MuZG9taWQgIT0gbm9kZS0+cGVybXMucFswXS5pZCkK
KwkJbm9kZS0+YWNjLm1lbW9yeSA9IDA7CisKIAkvKiBEYXRhIGlzIGJpbmFy
eSBibG9iICh1c3VhbGx5IGFzY2lpLCBubyBudWwpLiAqLwogCW5vZGUtPmRh
dGEgPSBub2RlLT5wZXJtcy5wICsgaGRyLT5udW1fcGVybXM7CiAJLyogQ2hp
bGRyZW4gaXMgc3RyaW5ncywgbnVsIHNlcGFyYXRlZC4gKi8KQEAgLTYxNSwx
MiArNzMyLDkgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwK
IAlwICs9IG5vZGUtPmRhdGFsZW47CiAJbWVtY3B5KHAsIG5vZGUtPmNoaWxk
cmVuLCBub2RlLT5jaGlsZGxlbik7CiAKLQkvKiBUREIgc2hvdWxkIHNldCBl
cnJubywgYnV0IGRvZXNuJ3QgZXZlbiBzZXQgZWNvZGUgQUZBSUNULiAqLwot
CWlmICh0ZGJfc3RvcmUodGRiX2N0eCwgKmtleSwgZGF0YSwgVERCX1JFUExB
Q0UpICE9IDApIHsKLQkJY29ycnVwdChjb25uLCAiV3JpdGUgb2YgJXMgZmFp
bGVkIiwga2V5LT5kcHRyKTsKLQkJZXJybm8gPSBFSU87Ci0JCXJldHVybiBl
cnJubzsKLQl9CisJaWYgKGRvX3RkYl93cml0ZShjb25uLCBrZXksICZkYXRh
LCAmbm9kZS0+YWNjLCBub19xdW90YV9jaGVjaykpCisJCXJldHVybiBFSU87
CisKIAlyZXR1cm4gMDsKIH0KIApAQCAtMTExOSw3ICsxMjMzLDcgQEAgc3Rh
dGljIHZvaWQgZGVsZXRlX25vZGVfc2luZ2xlKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIAlpZiAoYWNjZXNzX25vZGUo
Y29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfREVMRVRFLCAma2V5KSkKIAkJcmV0
dXJuOwogCi0JaWYgKHRkYl9kZWxldGUodGRiX2N0eCwga2V5KSAhPSAwKSB7
CisJaWYgKGRvX3RkYl9kZWxldGUoY29ubiwgJmtleSwgJm5vZGUtPmFjYykg
IT0gMCkgewogCQljb3JydXB0KGNvbm4sICJDb3VsZCBub3QgZGVsZXRlICcl
cyciLCBub2RlLT5uYW1lKTsKIAkJcmV0dXJuOwogCX0KQEAgLTExODIsNiAr
MTI5Niw3IEBAIHN0YXRpYyBzdHJ1Y3Qgbm9kZSAqY29uc3RydWN0X25vZGUo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAkv
KiBObyBjaGlsZHJlbiwgbm8gZGF0YSAqLwogCW5vZGUtPmNoaWxkcmVuID0g
bm9kZS0+ZGF0YSA9IE5VTEw7CiAJbm9kZS0+Y2hpbGRsZW4gPSBub2RlLT5k
YXRhbGVuID0gMDsKKwlub2RlLT5hY2MubWVtb3J5ID0gMDsKIAlub2RlLT5w
YXJlbnQgPSBwYXJlbnQ7CiAJcmV0dXJuIG5vZGU7CiAKQEAgLTExOTAsMTcg
KzEzMDUsMTcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpjb25zdHJ1Y3Rfbm9k
ZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAog
CXJldHVybiBOVUxMOwogfQogCi1zdGF0aWMgdm9pZCBkZXN0cm95X25vZGVf
cm0oc3RydWN0IG5vZGUgKm5vZGUpCitzdGF0aWMgdm9pZCBkZXN0cm95X25v
ZGVfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpu
b2RlKQogewogCWlmIChzdHJlcShub2RlLT5uYW1lLCAiLyIpKQogCQljb3Jy
dXB0KE5VTEwsICJEZXN0cm95aW5nIHJvb3Qgbm9kZSEiKTsKIAotCXRkYl9k
ZWxldGUodGRiX2N0eCwgbm9kZS0+a2V5KTsKKwlkb190ZGJfZGVsZXRlKGNv
bm4sICZub2RlLT5rZXksICZub2RlLT5hY2MpOwogfQogCiBzdGF0aWMgaW50
IGRlc3Ryb3lfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0
IG5vZGUgKm5vZGUpCiB7Ci0JZGVzdHJveV9ub2RlX3JtKG5vZGUpOworCWRl
c3Ryb3lfbm9kZV9ybShjb25uLCBub2RlKTsKIAlkb21haW5fZW50cnlfZGVj
KGNvbm4sIG5vZGUpOwogCiAJLyoKQEAgLTEyNTIsNyArMTM2Nyw3IEBAIHN0
YXRpYyBzdHJ1Y3Qgbm9kZSAqY3JlYXRlX25vZGUoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAkJLyogQWNjb3VudCBmb3Ig
bmV3IG5vZGUgKi8KIAkJaWYgKGktPnBhcmVudCkgewogCQkJaWYgKGRvbWFp
bl9lbnRyeV9pbmMoY29ubiwgaSkpIHsKLQkJCQlkZXN0cm95X25vZGVfcm0o
aSk7CisJCQkJZGVzdHJveV9ub2RlX3JtKGNvbm4sIGkpOwogCQkJCXJldHVy
biBOVUxMOwogCQkJfQogCQl9CkBAIC0yMDc1LDcgKzIxOTAsNyBAQCBzdGF0
aWMgaW50IGNsZWFuX3N0b3JlXyhUREJfQ09OVEVYVCAqdGRiLCBUREJfREFU
QSBrZXksIFREQl9EQVRBIHZhbCwKIAlpZiAoIWhhc2h0YWJsZV9zZWFyY2go
cmVhY2hhYmxlLCBuYW1lKSkgewogCQlsb2coImNsZWFuX3N0b3JlOiAnJXMn
IGlzIG9ycGhhbmVkISIsIG5hbWUpOwogCQlpZiAocmVjb3ZlcnkpIHsKLQkJ
CXRkYl9kZWxldGUodGRiLCBrZXkpOworCQkJZG9fdGRiX2RlbGV0ZShOVUxM
LCAma2V5LCBOVUxMKTsKIAkJfQogCX0KIApkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmgKaW5kZXggNGU1MzA3MmU2MzdjLi41MjFiYzgwMzg0
ZTUgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAt
MTQxLDYgKzE0MSwxMSBAQCBzdHJ1Y3Qgbm9kZV9wZXJtcyB7CiAJc3RydWN0
IHhzX3Blcm1pc3Npb25zICpwOwogfTsKIAorc3RydWN0IG5vZGVfYWNjb3Vu
dF9kYXRhIHsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisJaW50IG1lbW9yeTsJ
CS8qIC0xIGlmIHVua25vd24gKi8KK307CisKIHN0cnVjdCBub2RlIHsKIAlj
b25zdCBjaGFyICpuYW1lOwogCS8qIEtleSB1c2VkIHRvIHVwZGF0ZSBUREIg
Ki8KQEAgLTE2Myw2ICsxNjgsOSBAQCBzdHJ1Y3Qgbm9kZSB7CiAJLyogQ2hp
bGRyZW4sIGVhY2ggbnVsLXRlcm1pbmF0ZWQuICovCiAJdW5zaWduZWQgaW50
IGNoaWxkbGVuOwogCWNoYXIgKmNoaWxkcmVuOworCisJLyogQWxsb2NhdGlv
biBpbmZvcm1hdGlvbiBmb3Igbm9kZSBjdXJyZW50bHkgaW4gc3RvcmUuICov
CisJc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhIGFjYzsKIH07CiAKIC8qIFJl
dHVybiB0aGUgb25seSBhcmd1bWVudCBpbiB0aGUgaW5wdXQuICovCkBAIC0y
NTgsNiArMjY2LDExIEBAIGV4dGVybiB4ZW5nbnR0YWJfaGFuZGxlICoqeGd0
X2hhbmRsZTsKIAogaW50IHJlbWVtYmVyX3N0cmluZyhzdHJ1Y3QgaGFzaHRh
YmxlICpoYXNoLCBjb25zdCBjaGFyICpzdHIpOwogCitpbnQgZG9fdGRiX3dy
aXRlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBU
REJfREFUQSAqZGF0YSwKKwkJIHN0cnVjdCBub2RlX2FjY291bnRfZGF0YSAq
YWNjLCBib29sIG5vX3F1b3RhX2NoZWNrKTsKK2ludCBkb190ZGJfZGVsZXRl
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LAorCQkg
IHN0cnVjdCBub2RlX2FjY291bnRfZGF0YSAqYWNjKTsKKwogdm9pZCBjb25u
X2ZyZWVfYnVmZmVyZWRfZGF0YShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7
CiAKICNlbmRpZiAvKiBfWEVOU1RPUkVEX0NPUkVfSCAqLwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwppbmRleCA3
NzhiN2U0MzljYjMuLmMxYmViNDBhM2Q1MSAxMDA2NDQKLS0tIGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKKysrIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKQEAgLTE1Myw2ICsx
NTMsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBMaXN0IG9mIGFsbCB0
cmFuc2FjdGlvbnMgYWN0aXZlIG9uIHRoaXMgY29ubmVjdGlvbi4gKi8KIAlz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CiAKKwkvKiBDb25uZWN0aW9uIHRoaXMg
dHJhbnNhY3Rpb24gaXMgYXNzb2NpYXRlZCB3aXRoLiAqLworCXN0cnVjdCBj
b25uZWN0aW9uICpjb25uOworCiAJLyogQ29ubmVjdGlvbi1sb2NhbCBpZGVu
dGlmaWVyIGZvciB0aGlzIHRyYW5zYWN0aW9uLiAqLwogCXVpbnQzMl90IGlk
OwogCkBAIC0yOTIsNiArMjk1LDggQEAgaW50IGFjY2Vzc19ub2RlKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAogCQlp
bnRyb2R1Y2UgPSB0cnVlOwogCQlpLT50YV9ub2RlID0gZmFsc2U7CisJCS8q
IGFjYy5tZW1vcnkgPCAwIG1lYW5zICJ1bmtub3duLCBnZXQgc2l6ZSBmcm9t
IFREQiIuICovCisJCW5vZGUtPmFjYy5tZW1vcnkgPSAtMTsKIAogCQkvKgog
CQkgKiBBZGRpdGlvbmFsIHRyYW5zYWN0aW9uLXNwZWNpZmljIG5vZGUgZm9y
IHJlYWQgdHlwZS4gV2Ugb25seQpAQCAtNDE2LDExICs0MjEsMTEgQEAgc3Rh
dGljIGludCBmaW5hbGl6ZV90cmFuc2FjdGlvbihzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubiwKIAkJCQkJZ290byBlcnI7CiAJCQkJaGRyID0gKHZvaWQgKilk
YXRhLmRwdHI7CiAJCQkJaGRyLT5nZW5lcmF0aW9uID0gKytnZW5lcmF0aW9u
OwotCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJfY3R4LCBrZXksIGRhdGEsCi0J
CQkJCQlUREJfUkVQTEFDRSk7CisJCQkJcmV0ID0gZG9fdGRiX3dyaXRlKGNv
bm4sICZrZXksICZkYXRhLCBOVUxMLAorCQkJCQkJICAgdHJ1ZSk7CiAJCQkJ
dGFsbG9jX2ZyZWUoZGF0YS5kcHRyKTsKIAkJCX0gZWxzZSB7Ci0JCQkJcmV0
ID0gdGRiX2RlbGV0ZSh0ZGJfY3R4LCBrZXkpOworCQkJCXJldCA9IGRvX3Rk
Yl9kZWxldGUoY29ubiwgJmtleSwgTlVMTCk7CiAJCQl9CiAJCQlpZiAocmV0
KQogCQkJCWdvdG8gZXJyOwpAQCAtNDMxLDcgKzQzNiw3IEBAIHN0YXRpYyBp
bnQgZmluYWxpemVfdHJhbnNhY3Rpb24oc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiAJCQl9CiAJCX0KIAotCQlpZiAoaS0+dGFfbm9kZSAmJiB0ZGJfZGVs
ZXRlKHRkYl9jdHgsIHRhX2tleSkpCisJCWlmIChpLT50YV9ub2RlICYmIGRv
X3RkYl9kZWxldGUoY29ubiwgJnRhX2tleSwgTlVMTCkpCiAJCQlnb3RvIGVy
cjsKIAkJbGlzdF9kZWwoJmktPmxpc3QpOwogCQl0YWxsb2NfZnJlZShpKTsK
QEAgLTQ1OSw3ICs0NjQsNyBAQCBzdGF0aWMgaW50IGRlc3Ryb3lfdHJhbnNh
Y3Rpb24odm9pZCAqX3RyYW5zYWN0aW9uKQogCQkJCQkJCSAgICAgICBpLT5u
b2RlKTsKIAkJCWlmICh0cmFuc19uYW1lKSB7CiAJCQkJc2V0X3RkYl9rZXko
dHJhbnNfbmFtZSwgJmtleSk7Ci0JCQkJdGRiX2RlbGV0ZSh0ZGJfY3R4LCBr
ZXkpOworCQkJCWRvX3RkYl9kZWxldGUodHJhbnMtPmNvbm4sICZrZXksIE5V
TEwpOwogCQkJfQogCQl9CiAJCWxpc3RfZGVsKCZpLT5saXN0KTsKQEAgLTUw
Myw2ICs1MDgsNyBAQCBpbnQgZG9fdHJhbnNhY3Rpb25fc3RhcnQoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikK
IAogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+YWNjZXNzZWQpOwogCUlOSVRf
TElTVF9IRUFEKCZ0cmFucy0+Y2hhbmdlZF9kb21haW5zKTsKKwl0cmFucy0+
Y29ubiA9IGNvbm47CiAJdHJhbnMtPmZhaWwgPSBmYWxzZTsKIAl0cmFucy0+
Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-15.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-15.patch"
Content-Transfer-Encoding: base64

RnJvbSA3Yzg2ODhmMTJiOGE2NGM3N2NiNTA4NDg4OTdmYzlhYzY2Y2Y0MjYw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBleHBv
cnRzIGZvciBxdW90YSB2YXJpYWJsZXMKClNvbWUgcXVvdGEgdmFyaWFibGVz
IGFyZSBub3QgZXhwb3J0ZWQgdmlhIGhlYWRlciBmaWxlcy4KClRoaXMgaXMg
cGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggNTIxYmM4MDM4NGU1Li41YWJmMDZjMjFjOTggMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjMxLDYg
KzIzMSwxMSBAQCBleHRlcm4gVERCX0NPTlRFWFQgKnRkYl9jdHg7CiBleHRl
cm4gaW50IGRvbTBfZG9taWQ7CiBleHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBl
eHRlcm4gaW50IHByaXZfZG9taWQ7CitleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CitleHRlcm4gaW50IHF1b3RhX21heF90cmFuc2Fj
dGlvbjsKK2V4dGVybiBpbnQgcXVvdGFfbWF4X2VudHJ5X3NpemU7CitleHRl
cm4gaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlOworZXh0ZXJuIGludCBx
dW90YV9tYXhfcGF0aF9sZW47CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5
X3Blcl9kb21haW47CiBleHRlcm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CmRpZmYgLS1naXQg
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGMx
YmViNDBhM2Q1MS4uNmUyOTExOGM4MDBkIDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtMTc1LDcgKzE3
NSw2IEBAIHN0cnVjdCB0cmFuc2FjdGlvbgogCWJvb2wgZmFpbDsKIH07CiAK
LWV4dGVybiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uOwogdWludDY0X3Qg
Z2VuZXJhdGlvbjsKIAogc3RhdGljIHZvaWQgc2V0X3RkYl9rZXkoY29uc3Qg
Y2hhciAqbmFtZSwgVERCX0RBVEEgKmtleSkKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggNzExOGMzMGU4YzMyLi4xOWQwZmIw
MWIxYzQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5j
CkBAIC0zMSw4ICszMSw2IEBACiAjaW5jbHVkZSAieGVuc3RvcmVkX2RvbWFp
bi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90cmFuc2FjdGlvbi5oIgogCi1l
eHRlcm4gaW50IHF1b3RhX25iX3dhdGNoX3Blcl9kb21haW47Ci0KIHN0cnVj
dCB3YXRjaAogewogCS8qIFdhdGNoZXMgb24gdGhpcyBjb25uZWN0aW9uICov
Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.13-xenstored-16.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.13-xenstored-16.patch"
Content-Transfer-Encoding: base64

RnJvbSAzY2MyMzZkM2Y2MmMwMTVhOTVkM2Q2ZGM1NzhhZDdmY2ZhMTk2MDdh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBjb250
cm9sIGNvbW1hbmQgZm9yIHNldHRpbmcgYW5kIHNob3dpbmcgcXVvdGEKCkFk
ZCBhIHhlbnN0b3JlLWNvbnRyb2wgY29tbWFuZCAicXVvdGEiIHRvOgotIHNo
b3cgY3VycmVudCBxdW90YSBzZXR0aW5ncwotIGNoYW5nZSBxdW90YSBzZXR0
aW5ncwotIHNob3cgY3VycmVudCBxdW90YSByZWxhdGVkIHZhbHVlcyBvZiBh
IGRvbWFpbgoKTm90ZSB0aGF0IGluIHRoZSBjYXNlIHRoZSBuZXcgcXVvdGEg
aXMgbG93ZXIgdGhhbiBleGlzdGluZyBvbmUsClhlbnN0b3JlZCBtYXkgY29u
dGludWUgdG8gaGFuZGxlIHJlcXVlc3RzIGZyb20gYSBkb21haW4gZXhjZWVk
aW5nIHRoZQpuZXcgbGltaXQgKGRlcGVuZHMgb24gd2hpY2ggb25lIGhhcyBi
ZWVuIGJyb2tlbikgYW5kIHRoZSBhbW91bnQgb2YKcmVzb3VyY2UgdXNlZCB3
aWxsIG5vdCBjaGFuZ2UuIEhvd2V2ZXIgdGhlIGRvbWFpbiB3aWxsIG5vdCBi
ZSBhYmxlIHRvCmNyZWF0ZSBtb3JlIHJlc291cmNlIChhc3NvY2lhdGVkIHRv
IHRoZSBxdW90YSkgdW50aWwgaXQgaXMgYmFjayB0byBiZWxvdwp0aGUgbGlt
aXQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNi4KClJlcG9ydGVkLWJ5OiBK
dWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5
OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdp
dCBhL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQgYi9kb2NzL21pc2MveGVuc3Rv
cmUudHh0CmluZGV4IDMyOTY5ZWIzZmVjZC4uMGRiYWM0NDJkNzlkIDEwMDY0
NAotLS0gYS9kb2NzL21pc2MveGVuc3RvcmUudHh0CisrKyBiL2RvY3MvbWlz
Yy94ZW5zdG9yZS50eHQKQEAgLTM0Niw2ICszNDYsMTcgQEAgQ09OVFJPTAkJ
CTxjb21tYW5kPnxbPHBhcmFtZXRlcnM+fF0KIAlwcmludHw8c3RyaW5nPgog
CQlwcmludCA8c3RyaW5nPiB0byBzeXNsb2cgKHhlbnN0b3JlIHJ1bnMgYXMg
ZGFlbW9uKSBvcgogCQl0byBjb25zb2xlICh4ZW5zdG9yZSBydW5zIGFzIHN0
dWJkb20pCisJcXVvdGF8W3NldCA8bmFtZT4gPHZhbD58PGRvbWlkPl0KKwkJ
d2l0aG91dCBwYXJhbWV0ZXJzOiBwcmludCB0aGUgY3VycmVudCBxdW90YSBz
ZXR0aW5ncworCQl3aXRoICJzZXQgPG5hbWU+IDx2YWw+Ijogc2V0IHRoZSBx
dW90YSA8bmFtZT4gdG8gbmV3IHZhbHVlCisJCTx2YWw+IChUaGUgYWRtaW4g
c2hvdWxkIG1ha2Ugc3VyZSBhbGwgdGhlIGRvbWFpbiB1c2FnZSBpcworCQli
ZWxvdyB0aGUgcXVvdGEuIElmIGl0IGlzIG5vdCwgdGhlbiBYZW5zdG9yZWQg
bWF5IGNvbnRpbnVlIHRvCisJCWhhbmRsZSByZXF1ZXN0cyBmcm9tIHRoZSBk
b21haW4gYXMgbG9uZyBhcyB0aGUgcmVzb3VyY2UKKwkJdmlvbGF0aW5nIHRo
ZSBuZXcgcXVvdGEgc2V0dGluZyBpc24ndCBpbmNyZWFzZWQgZnVydGhlcikK
KwkJd2l0aCAiPGRvbWlkPiI6IHByaW50IHF1b3RhIHJlbGF0ZWQgYWNjb3Vu
dGluZyBkYXRhIGZvcgorCQl0aGUgZG9tYWluIDxkb21pZD4KKwlxdW90YS1z
b2Z0fFtzZXQgPG5hbWU+IDx2YWw+XQorCQlsaWtlIHRoZSAicXVvdGEiIGNv
bW1hbmQsIGJ1dCBmb3Igc29mdC1xdW90YS4KIAloZWxwCQkJPHN1cHBvcnRl
ZC1jb21tYW5kcz4KIAkJcmV0dXJuIGxpc3Qgb2Ygc3VwcG9ydGVkIGNvbW1h
bmRzIGZvciBDT05UUk9MCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCmluZGV4IDcxNWUwZDJhOWUwMy4uNDU0ZmU5ZDVhYjE4
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJv
bC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMK
QEAgLTE5LDYgKzE5LDcgQEAKICNpbmNsdWRlIDxlcnJuby5oPgogI2luY2x1
ZGUgPHN0ZGFyZy5oPgogI2luY2x1ZGUgPHN0ZGlvLmg+CisjaW5jbHVkZSA8
c3RkbGliLmg+CiAjaW5jbHVkZSA8c3RyaW5nLmg+CiAKICNpbmNsdWRlICJ1
dGlscy5oIgpAQCAtNzcsNiArNzgsMTE0IEBAIHN0YXRpYyBpbnQgZG9fY29u
dHJvbF9sb2dmaWxlKHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiAJcmV0dXJuIDA7CiB9CiAKK3N0cnVjdCBxdW90YSB7CisJY29uc3Qg
Y2hhciAqbmFtZTsKKwlpbnQgKnF1b3RhOworCWNvbnN0IGNoYXIgKmRlc2Ny
OworfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBxdW90YSBoYXJkX3F1b3Rh
c1tdID0geworCXsgIm5vZGVzIiwgJnF1b3RhX25iX2VudHJ5X3Blcl9kb21h
aW4sICJOb2RlcyBwZXIgZG9tYWluIiB9LAorCXsgIndhdGNoZXMiLCAmcXVv
dGFfbmJfd2F0Y2hfcGVyX2RvbWFpbiwgIldhdGNoZXMgcGVyIGRvbWFpbiIg
fSwKKwl7ICJ0cmFuc2FjdGlvbnMiLCAmcXVvdGFfbWF4X3RyYW5zYWN0aW9u
LCAiVHJhbnNhY3Rpb25zIHBlciBkb21haW4iIH0sCisJeyAib3V0c3RhbmRp
bmciLCAmcXVvdGFfcmVxX291dHN0YW5kaW5nLAorCQkiT3V0c3RhbmRpbmcg
cmVxdWVzdHMgcGVyIGRvbWFpbiIgfSwKKwl7ICJ0cmFuc2FjdGlvbi1ub2Rl
cyIsICZxdW90YV90cmFuc19ub2RlcywKKwkJIk1heC4gbnVtYmVyIG9mIGFj
Y2Vzc2VkIG5vZGVzIHBlciB0cmFuc2FjdGlvbiIgfSwKKwl7ICJtZW1vcnki
LCAmcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFyZCwKKwkJIlRvdGFsIFhl
bnN0b3JlIG1lbW9yeSBwZXIgZG9tYWluIChlcnJvciBsZXZlbCkiIH0sCisJ
eyAibm9kZS1zaXplIiwgJnF1b3RhX21heF9lbnRyeV9zaXplLCAiTWF4LiBz
aXplIG9mIGEgbm9kZSIgfSwKKwl7ICJwZXJtaXNzaW9ucyIsICZxdW90YV9u
Yl9wZXJtc19wZXJfbm9kZSwKKwkJIk1heC4gbnVtYmVyIG9mIHBlcm1pc3Np
b25zIHBlciBub2RlIiB9LAorCXsgTlVMTCwgTlVMTCwgTlVMTCB9Cit9Owor
CitzdGF0aWMgY29uc3Qgc3RydWN0IHF1b3RhIHNvZnRfcXVvdGFzW10gPSB7
CisJeyAibWVtb3J5IiwgJnF1b3RhX21lbW9yeV9wZXJfZG9tYWluX3NvZnQs
CisJCSJUb3RhbCBYZW5zdG9yZSBtZW1vcnkgcGVyIGRvbWFpbiAod2Fybmlu
ZyBsZXZlbCkiIH0sCisJeyBOVUxMLCBOVUxMLCBOVUxMIH0KK307CisKK3N0
YXRpYyBpbnQgcXVvdGFfc2hvd19jdXJyZW50KGNvbnN0IHZvaWQgKmN0eCwg
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCQkgICAgICBjb25zdCBzdHJ1
Y3QgcXVvdGEgKnF1b3RhcykKK3sKKwljaGFyICpyZXNwOworCXVuc2lnbmVk
IGludCBpOworCisJcmVzcCA9IHRhbGxvY19zdHJkdXAoY3R4LCAiUXVvdGEg
c2V0dGluZ3M6XG4iKTsKKwlpZiAoIXJlc3ApCisJCXJldHVybiBFTk9NRU07
CisKKwlmb3IgKGkgPSAwOyBxdW90YXNbaV0ucXVvdGE7IGkrKykgeworCQly
ZXNwID0gdGFsbG9jX2FzcHJpbnRmX2FwcGVuZChyZXNwLCAiJS0xN3M6ICU4
ZCAlc1xuIiwKKwkJCQkJICAgICAgcXVvdGFzW2ldLm5hbWUsICpxdW90YXNb
aV0ucXVvdGEsCisJCQkJCSAgICAgIHF1b3Rhc1tpXS5kZXNjcik7CisJCWlm
ICghcmVzcCkKKwkJCXJldHVybiBFTk9NRU07CisJfQorCisJc2VuZF9yZXBs
eShjb25uLCBYU19DT05UUk9MLCByZXNwLCBzdHJsZW4ocmVzcCkgKyAxKTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHF1b3RhX3NldChjb25z
dCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAorCQkgICAg
IGNoYXIgKip2ZWMsIGludCBudW0sIGNvbnN0IHN0cnVjdCBxdW90YSAqcXVv
dGFzKQoreworCXVuc2lnbmVkIGludCBpOworCWludCB2YWw7CisKKwlpZiAo
bnVtICE9IDIpCisJCXJldHVybiBFSU5WQUw7CisKKwl2YWwgPSBhdG9pKHZl
Y1sxXSk7CisJaWYgKHZhbCA8IDEpCisJCXJldHVybiBFSU5WQUw7CisKKwlm
b3IgKGkgPSAwOyBxdW90YXNbaV0ucXVvdGE7IGkrKykgeworCQlpZiAoIXN0
cmNtcCh2ZWNbMF0sIHF1b3Rhc1tpXS5uYW1lKSkgeworCQkJKnF1b3Rhc1tp
XS5xdW90YSA9IHZhbDsKKwkJCXNlbmRfYWNrKGNvbm4sIFhTX0NPTlRST0wp
OworCQkJcmV0dXJuIDA7CisJCX0KKwl9CisKKwlyZXR1cm4gRUlOVkFMOwor
fQorCitzdGF0aWMgaW50IHF1b3RhX2dldChjb25zdCB2b2lkICpjdHgsIHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLAorCQkgICAgIGNoYXIgKip2ZWMsIGlu
dCBudW0pCit7CisJaWYgKG51bSAhPSAxKQorCQlyZXR1cm4gRUlOVkFMOwor
CisJcmV0dXJuIGRvbWFpbl9nZXRfcXVvdGEoY3R4LCBjb25uLCBhdG9pKHZl
Y1swXSkpOworfQorCitzdGF0aWMgaW50IGRvX2NvbnRyb2xfcXVvdGEodm9p
ZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJCSAgICBjaGFy
ICoqdmVjLCBpbnQgbnVtKQoreworCWlmIChudW0gPT0gMCkKKwkJcmV0dXJu
IHF1b3RhX3Nob3dfY3VycmVudChjdHgsIGNvbm4sIGhhcmRfcXVvdGFzKTsK
KworCWlmICghc3RyY21wKHZlY1swXSwgInNldCIpKQorCQlyZXR1cm4gcXVv
dGFfc2V0KGN0eCwgY29ubiwgdmVjICsgMSwgbnVtIC0gMSwgaGFyZF9xdW90
YXMpOworCisJcmV0dXJuIHF1b3RhX2dldChjdHgsIGNvbm4sIHZlYywgbnVt
KTsKK30KKworc3RhdGljIGludCBkb19jb250cm9sX3F1b3RhX3Modm9pZCAq
Y3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJCSAgICAgIGNoYXIg
Kip2ZWMsIGludCBudW0pCit7CisJaWYgKG51bSA9PSAwKQorCQlyZXR1cm4g
cXVvdGFfc2hvd19jdXJyZW50KGN0eCwgY29ubiwgc29mdF9xdW90YXMpOwor
CisJaWYgKCFzdHJjbXAodmVjWzBdLCAic2V0IikpCisJCXJldHVybiBxdW90
YV9zZXQoY3R4LCBjb25uLCB2ZWMgKyAxLCBudW0gLSAxLCBzb2Z0X3F1b3Rh
cyk7CisKKwlyZXR1cm4gRUlOVkFMOworfQorCiBzdGF0aWMgaW50IGRvX2Nv
bnRyb2xfbWVtcmVwb3J0KHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sCiAJCQkJY2hhciAqKnZlYywgaW50IG51bSkKIHsKQEAgLTEzNiw2
ICsyNDUsOCBAQCBzdGF0aWMgc3RydWN0IGNtZF9zIGNtZHNbXSA9IHsKIAl7
ICJsb2dmaWxlIiwgZG9fY29udHJvbF9sb2dmaWxlLCAiPGZpbGU+IiB9LAog
CXsgIm1lbXJlcG9ydCIsIGRvX2NvbnRyb2xfbWVtcmVwb3J0LCAiWzxmaWxl
Pl0iIH0sCiAJeyAicHJpbnQiLCBkb19jb250cm9sX3ByaW50LCAiPHN0cmlu
Zz4iIH0sCisJeyAicXVvdGEiLCBkb19jb250cm9sX3F1b3RhLCAiW3NldCA8
bmFtZT4gPHZhbD58PGRvbWlkPl0iIH0sCisJeyAicXVvdGEtc29mdCIsIGRv
X2NvbnRyb2xfcXVvdGFfcywgIltzZXQgPG5hbWU+IDx2YWw+XSIgfSwKIAl7
ICJoZWxwIiwgZG9fY29udHJvbF9oZWxwLCAiIiB9LAogfTsKIApkaWZmIC0t
Z2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDExMmZiNDU3
NTgxZS4uZjQ1ODMxNGM4ZTAxIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5jCkBAIC0zMSw2ICszMSw3IEBACiAjaW5jbHVkZSAi
eGVuc3RvcmVkX2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90cmFu
c2FjdGlvbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF93YXRjaC5oIgorI2lu
Y2x1ZGUgInhlbnN0b3JlZF9jb250cm9sLmgiCiAKICNpbmNsdWRlIDx4ZW5l
dnRjaG4uaD4KICNpbmNsdWRlIDx4ZW5jdHJsLmg+CkBAIC0zNTIsNiArMzUz
LDM4IEBAIHN0YXRpYyBzdHJ1Y3QgZG9tYWluICpmaW5kX2RvbWFpbl9zdHJ1
Y3QodW5zaWduZWQgaW50IGRvbWlkKQogCXJldHVybiBOVUxMOwogfQogCitp
bnQgZG9tYWluX2dldF9xdW90YShjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLAorCQkgICAgIHVuc2lnbmVkIGludCBkb21pZCkK
K3sKKwlzdHJ1Y3QgZG9tYWluICpkID0gZmluZF9kb21haW5fc3RydWN0KGRv
bWlkKTsKKwljaGFyICpyZXNwOworCWludCB0YTsKKworCWlmICghZCkKKwkJ
cmV0dXJuIEVOT0VOVDsKKworCXRhID0gZC0+Y29ubiA/IGQtPmNvbm4tPnRy
YW5zYWN0aW9uX3N0YXJ0ZWQgOiAwOworCXJlc3AgPSB0YWxsb2NfYXNwcmlu
dGYoY3R4LCAiRG9tYWluICV1OlxuIiwgZG9taWQpOworCWlmICghcmVzcCkK
KwkJcmV0dXJuIEVOT01FTTsKKworI2RlZmluZSBlbnQodCwgZSkgXAorCXJl
c3AgPSB0YWxsb2NfYXNwcmludGZfYXBwZW5kKHJlc3AsICIlLTE2czogJThk
XG4iLCAjdCwgZSk7IFwKKwlpZiAoIXJlc3ApIHJldHVybiBFTk9NRU0KKwor
CWVudChub2RlcywgZC0+bmJlbnRyeSk7CisJZW50KHdhdGNoZXMsIGQtPm5i
d2F0Y2gpOworCWVudCh0cmFuc2FjdGlvbnMsIHRhKTsKKwllbnQob3V0c3Rh
bmRpbmcsIGQtPm5ib3V0c3RhbmRpbmcpOworCWVudChtZW1vcnksIGQtPm1l
bW9yeSk7CisKKyN1bmRlZiBlbnQKKworCXNlbmRfcmVwbHkoY29ubiwgWFNf
Q09OVFJPTCwgcmVzcCwgc3RybGVuKHJlc3ApICsgMSk7CisKKwlyZXR1cm4g
MDsKK30KKwogc3RhdGljIHN0cnVjdCBkb21haW4gKmFsbG9jX2RvbWFpbih2
b2lkICpjb250ZXh0LCB1bnNpZ25lZCBpbnQgZG9taWQpCiB7CiAJc3RydWN0
IGRvbWFpbiAqZG9tYWluOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2RvbWFpbi5oCmluZGV4IDNhOGM2YmFiNDhiYS4uZTAxM2E5OTkxY2E4IDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
KysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCkBAIC05
MCw2ICs5MCw4IEBAIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4pOwogdm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5jKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uKTsKIHZvaWQgZG9tYWluX291dHN0YW5kaW5n
X2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiB2b2lkIGRvbWFpbl9v
dXRzdGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKTsKK2lu
dCBkb21haW5fZ2V0X3F1b3RhKGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sCisJCSAgICAgdW5zaWduZWQgaW50IGRvbWlkKTsK
IAogLyogU3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICovCiBp
bnQgc2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IGNoYXIgKm5hbWUsCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSBhYTY1ZTU3MmI1NWVlNTE1ZjAxZDdlMDgwNDRjMmIwZjBhMTVhMjkz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IFN5bmNocm9uaXNlIGRlZmF1
bHRzIHdpdGggb3hlbnN0b3JlLmNvbmYuaW4KTUlNRS1WZXJzaW9uOiAxLjAK
Q29udGVudC1UeXBlOiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRl
bnQtVHJhbnNmZXItRW5jb2Rpbmc6IDhiaXQKCldlIGN1cnJlbnRseSBoYXZl
IDIgZGlmZmVyZW50IHNldCBvZiBkZWZhdWx0cyBpbiB1cHN0cmVhbSBYZW4g
Z2l0IHRyZWU6CiogZGVmaW5lZCBpbiB0aGUgc291cmNlIGNvZGUsIG9ubHkg
dXNlZCBpZiB0aGVyZSBpcyBubyBjb25maWcgZmlsZQoqIGRlZmluZWQgaW4g
dGhlIG94ZW5zdG9yZWQuY29uZi5pbiB1cHN0cmVhbSBYZW4KCkFuIG94ZW5z
dG9yZWQuY29uZiBmaWxlIGlzIG5vdCBtYW5kYXRvcnksIGFuZCBpZiBtaXNz
aW5nLCBtYXhyZXF1ZXN0cyBpbgpwYXJ0aWN1bGFyIGhhcyBhbiB1bnNhZmUg
ZGVmYXVsdC4KClJlc3luYyB0aGUgZGVmYXVsdHMgZnJvbSBveGVuc3RvcmVk
LmNvbmYuaW4gaW50byB0aGUgc291cmNlIGNvZGUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE2LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEVkd2luIFTDtnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2Vk
LWJ5OiBDaHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJp
eC5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Rl
ZmluZS5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5k
ZXggZjU3NDM5N2E0YzBiLi45NmMxMjVhOTY5ZGEgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2Nh
bWwveGVuc3RvcmVkL2RlZmluZS5tbApAQCAtMjIsOSArMjIsOSBAQCBsZXQg
eHNfZGFlbW9uX3NvY2tldF9ybyA9IFBhdGhzLnhlbl9ydW5fc3RvcmVkIF4g
Ii9zb2NrZXRfcm8iCiAKIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRo
cy54ZW5fY29uZmlnX2RpcgogCi1sZXQgbWF4d2F0Y2ggPSByZWYgKDUwKQot
bGV0IG1heHRyYW5zYWN0aW9uID0gcmVmICgyMCkKLWxldCBtYXhyZXF1ZXN0
cyA9IHJlZiAoLTEpICAgKCogbWF4aW11bSByZXF1ZXN0cyBwZXIgdHJhbnNh
Y3Rpb24gKikKK2xldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQorbGV0IG1heHRy
YW5zYWN0aW9uID0gcmVmICgxMCkKK2xldCBtYXhyZXF1ZXN0cyA9IHJlZiAo
MTAyNCkgICAoKiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAq
KQogCiBsZXQgY29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCiBsZXQg
Y29uZmxpY3RfbWF4X2hpc3Rvcnlfc2Vjb25kcyA9IHJlZiAwLjA1CmRpZmYg
LS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwgYi90b29s
cy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwKaW5kZXggYWJjYWM5MTI4MDVh
Li42ZTNkNjQwMWFlODkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0
b3JlZC9xdW90YS5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVv
dGEubWwKQEAgLTIwLDggKzIwLDggQEAgZXhjZXB0aW9uIFRyYW5zYWN0aW9u
X29wZW5lZAogCiBsZXQgd2FybiBmbXQgPSBMb2dnaW5nLndhcm4gInF1b3Rh
IiBmbXQKIGxldCBhY3RpdmF0ZSA9IHJlZiB0cnVlCi1sZXQgbWF4ZW50ID0g
cmVmICgxMDAwMCkKLWxldCBtYXhzaXplID0gcmVmICg0MDk2KQorbGV0IG1h
eGVudCA9IHJlZiAoMTAwMCkKK2xldCBtYXhzaXplID0gcmVmICgyMDQ4KQog
CiB0eXBlIHQgPSB7CiAJbWF4ZW50OiBpbnQ7ICAgICAgICAgICAgICAgKCog
bWF4IGVudGl0aWVzIHBlciBkb21VICopCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSAwNTk0ZTEzMmYxNmY3ODBkN2E3YzJhMjA2OGU3YzI3OGYwNzliYjY5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogVGh1LCAyOCBKdWwgMjAyMiAxNzowODoxNSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IENoZWNrIGZvciBtYXhyZXF1
ZXN0cyBiZWZvcmUgcGVyZm9ybWluZwogb3BlcmF0aW9ucwpNSU1FLVZlcnNp
b246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRG
LTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKUHJldmlvdXNs
eSB3ZSdkIHBlcmZvcm0gdGhlIG9wZXJhdGlvbiwgcmVjb3JkIHRoZSB1cGRh
dGVkIHRyZWUgaW4gdGhlCnRyYW5zYWN0aW9uIHJlY29yZCwgdGhlbiB0cnkg
dG8gaW5zZXJ0IGEgd2F0Y2hvcCBwYXRoIGFuZCB0aGUgcmVwbHkgcGFja2V0
LgoKSWYgd2UgZXhjZWVkZWQgbWF4IHJlcXVlc3RzIHdlIHdvdWxkJ3ZlIHJl
dHVybmVkIEVRVU9UQSwgYnV0IHN0aWxsOgoqIGhhdmUgcGVyZm9ybWVkIHRo
ZSBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uJ3MgdHJlZQoqIGhhdmUg
cmVjb3JkZWQgdGhlIHdhdGNob3AsIG1ha2luZyB0aGlzIHF1ZXVlIGVmZmVj
dGl2ZWx5IHVuYm91bmRlZAoKSXQgaXMgYmV0dGVyIGlmIHdlIGNoZWNrIHdo
ZXRoZXIgd2UnZCBoYXZlIHJvb20gdG8gc3RvcmUgdGhlIG9wZXJhdGlvbiBi
ZWZvcmUKcGVyZm9ybWluZyB0aGUgdHJhbnNhY3Rpb24sIGFuZCByYWlzZSBF
UVVPVEEgdGhlcmUuICBUaGVuIHRoZSB0cmFuc2FjdGlvbgpyZWNvcmQgd29u
J3QgZ3Jvdy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2IC8gQ1ZFLTIwMjIt
NDIzMTcuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1h
em9uLmNvbT4KU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbCBiL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDNhYjA5YzZjZTkyNi4uMzI3
OWIxOWIxYmZmIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vz
cy5tbApAQCAtMjUzLDYgKzI1Myw3IEBAIGxldCBpbnB1dF9oYW5kbGVfZXJy
b3IgfmNvbnMgfmRvbXMgfmZjdCB+Y29uIH50IH5yZXEgPQogCWxldCByZXBs
eV9lcnJvciBlID0KIAkJUGFja2V0LkVycm9yIGUgaW4KIAl0cnkKKwkJVHJh
bnNhY3Rpb24uY2hlY2tfcXVvdGFfZXhuIH5wZXJtOihDb25uZWN0aW9uLmdl
dF9wZXJtIGNvbikgdDsKIAkJZmN0IGNvbiB0IGRvbXMgY29ucyByZXEuUGFj
a2V0LmRhdGEKIAl3aXRoCiAJfCBEZWZpbmUuSW52YWxpZF9wYXRoICAgICAg
ICAgIC0+IHJlcGx5X2Vycm9yICJFSU5WQUwiCkBAIC01NDUsOSArNTQ2LDEw
IEBAIGxldCBwcm9jZXNzX3BhY2tldCB+c3RvcmUgfmNvbnMgfmRvbXMgfmNv
biB+cmVxID0KIAkJaW4KIAogCQlsZXQgcmVzcG9uc2UgPSB0cnkKKwkJCVRy
YW5zYWN0aW9uLmNoZWNrX3F1b3RhX2V4biB+cGVybTooQ29ubmVjdGlvbi5n
ZXRfcGVybSBjb24pIHQ7CiAJCQlpZiB0aWQgPD4gVHJhbnNhY3Rpb24ubm9u
ZSB0aGVuCiAJCQkJKCogUmVtZW1iZXIgdGhlIHJlcXVlc3QgYW5kIHJlc3Bv
bnNlIGZvciB0aGlzIG9wZXJhdGlvbiBpbiBjYXNlIHdlIG5lZWQgdG8gcmVw
bGF5IHRoZSB0cmFuc2FjdGlvbiAqKQotCQkJCVRyYW5zYWN0aW9uLmFkZF9v
cGVyYXRpb24gfnBlcm06KENvbm5lY3Rpb24uZ2V0X3Blcm0gY29uKSB0IHJl
cSByZXNwb25zZTsKKwkJCQlUcmFuc2FjdGlvbi5hZGRfb3BlcmF0aW9uIHQg
cmVxIHJlc3BvbnNlOwogCQkJcmVzcG9uc2UKIAkJd2l0aCBRdW90YS5MaW1p
dF9yZWFjaGVkIC0+CiAJCQlQYWNrZXQuRXJyb3IgIkVRVU9UQSIKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbAppbmRleCAx
N2IxYmRmMmVhZjkuLjI5NDE0M2UyMzM1YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3RyYW5zYWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbApAQCAtODUsNiArODUsNyBA
QCB0eXBlIHQgPSB7CiAJb2xkcm9vdDogU3RvcmUuTm9kZS50OwogCW11dGFi
bGUgcGF0aHM6IChYZW5idXMuWGIuT3Aub3BlcmF0aW9uICogU3RvcmUuUGF0
aC50KSBsaXN0OwogCW11dGFibGUgb3BlcmF0aW9uczogKFBhY2tldC5yZXF1
ZXN0ICogUGFja2V0LnJlc3BvbnNlKSBsaXN0OworCW11dGFibGUgcXVvdGFf
cmVhY2hlZDogYm9vbDsKIAltdXRhYmxlIHJlYWRfbG93cGF0aDogU3RvcmUu
UGF0aC50IG9wdGlvbjsKIAltdXRhYmxlIHdyaXRlX2xvd3BhdGg6IFN0b3Jl
LlBhdGgudCBvcHRpb247CiB9CkBAIC0xMjcsNiArMTI4LDcgQEAgbGV0IG1h
a2UgPyhpbnRlcm5hbD1mYWxzZSkgaWQgc3RvcmUgPQogCQlvbGRyb290ID0g
U3RvcmUuZ2V0X3Jvb3Qgc3RvcmU7CiAJCXBhdGhzID0gW107CiAJCW9wZXJh
dGlvbnMgPSBbXTsKKwkJcXVvdGFfcmVhY2hlZCA9IGZhbHNlOwogCQlyZWFk
X2xvd3BhdGggPSBOb25lOwogCQl3cml0ZV9sb3dwYXRoID0gTm9uZTsKIAl9
IGluCkBAIC0xNDMsMTMgKzE0NSwxOSBAQCBsZXQgZ2V0X3Jvb3QgdCA9IFN0
b3JlLmdldF9yb290IHQuc3RvcmUKIAogbGV0IGlzX3JlYWRfb25seSB0ID0g
dC5wYXRocyA9IFtdCiBsZXQgYWRkX3dvcCB0IHR5IHBhdGggPSB0LnBhdGhz
IDwtICh0eSwgcGF0aCkgOjogdC5wYXRocwotbGV0IGFkZF9vcGVyYXRpb24g
fnBlcm0gdCByZXF1ZXN0IHJlc3BvbnNlID0KK2xldCBnZXRfb3BlcmF0aW9u
cyB0ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCisKK2xldCBjaGVja19xdW90
YV9leG4gfnBlcm0gdCA9CiAJaWYgIURlZmluZS5tYXhyZXF1ZXN0cyA+PSAw
CiAJCSYmIG5vdCAoUGVybXMuQ29ubmVjdGlvbi5pc19kb20wIHBlcm0pCi0J
CSYmIExpc3QubGVuZ3RoIHQub3BlcmF0aW9ucyA+PSAhRGVmaW5lLm1heHJl
cXVlc3RzCi0JCXRoZW4gcmFpc2UgUXVvdGEuTGltaXRfcmVhY2hlZDsKKwkJ
JiYgKHQucXVvdGFfcmVhY2hlZCB8fCBMaXN0Lmxlbmd0aCB0Lm9wZXJhdGlv
bnMgPj0gIURlZmluZS5tYXhyZXF1ZXN0cykKKwkJdGhlbiBiZWdpbgorCQkJ
dC5xdW90YV9yZWFjaGVkIDwtIHRydWU7CisJCQlyYWlzZSBRdW90YS5MaW1p
dF9yZWFjaGVkOworCQllbmQKKworbGV0IGFkZF9vcGVyYXRpb24gdCByZXF1
ZXN0IHJlc3BvbnNlID0KIAl0Lm9wZXJhdGlvbnMgPC0gKHJlcXVlc3QsIHJl
c3BvbnNlKSA6OiB0Lm9wZXJhdGlvbnMKLWxldCBnZXRfb3BlcmF0aW9ucyB0
ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCiBsZXQgc2V0X3JlYWRfbG93cGF0
aCB0IHBhdGggPSB0LnJlYWRfbG93cGF0aCA8LSBnZXRfbG93ZXN0IHBhdGgg
dC5yZWFkX2xvd3BhdGgKIGxldCBzZXRfd3JpdGVfbG93cGF0aCB0IHBhdGgg
PSB0LndyaXRlX2xvd3BhdGggPC0gZ2V0X2xvd2VzdCBwYXRoIHQud3JpdGVf
bG93cGF0aAogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSAwMDUxZDU5ZmYyZDc1ZjkyOTVhNzJjNzgzNzNhMWVkMTZhMjVlN2Ix
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogR0MgcGFyYW1ldGVyIHR1bmluZwpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKQnkgZGVm
YXVsdCB0aGUgT0NhbWwgZ2FyYmFnZSBjb2xsZWN0b3Igd291bGQgcmV0dXJu
IG1lbW9yeSB0byB0aGUgT1Mgb25seQphZnRlciB1bnVzZWQgbWVtb3J5IGlz
IDV4IGxpdmUgbWVtb3J5LiAgVHdlYWsgdGhpcyB0byAxMjAlIGluc3RlYWQs
IHdoaWNoCndvdWxkIG1hdGNoIHRoZSBtYWpvciBHQyBzcGVlZC4KClRoaXMg
aXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTD
tnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJp
c3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+Cgpk
aWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5kZXggOTZjMTI1
YTk2OWRhLi4xYTVkMmYzNGE2NzggMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL2RlZmluZS5tbApAQCAtMjYsNiArMjYsNyBAQCBsZXQgbWF4d2F0Y2gg
PSByZWYgKDEwMCkKIGxldCBtYXh0cmFuc2FjdGlvbiA9IHJlZiAoMTApCiBs
ZXQgbWF4cmVxdWVzdHMgPSByZWYgKDEwMjQpICAgKCogbWF4aW11bSByZXF1
ZXN0cyBwZXIgdHJhbnNhY3Rpb24gKikKIAorbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKIGxl
dCBjb25mbGljdF9tYXhfaGlzdG9yeV9zZWNvbmRzID0gcmVmIDAuMDUKIGxl
dCBjb25mbGljdF9yYXRlX2xpbWl0X2lzX2FnZ3JlZ2F0ZSA9IHJlZiB0cnVl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVk
Lm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAppbmRl
eCAzNjliNTAzNmY0M2QuLjBiNjM0M2RmYzc4OSAxMDA2NDQKLS0tIGEvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCkBAIC0xMDMsNiArMTAzLDcg
QEAgbGV0IHBhcnNlX2NvbmZpZyBmaWxlbmFtZSA9CiAJCSgicXVvdGEtbWF4
c2l6ZSIsIENvbmZpZy5TZXRfaW50IFF1b3RhLm1heHNpemUpOwogCQkoInF1
b3RhLW1heHJlcXVlc3RzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHJl
cXVlc3RzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CisJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwogCQkoInBlcnNpc3RlbnQiLCBDb25maWcuU2V0X2Jvb2wgRGlz
ay5lbmFibGUpOwogCQkoInhlbnN0b3JlZC1sb2ctZmlsZSIsIENvbmZpZy5T
dHJpbmcgTG9nZ2luZy5zZXRfeGVuc3RvcmVkX2xvZ19kZXN0aW5hdGlvbik7
CkBAIC0yMjksNiArMjMwLDY3IEBAIGxldCB0b19maWxlIHN0b3JlIGNvbnMg
ZmlsZSA9CiAJICAgICAgICAoZnVuICgpIC0+IGNsb3NlX291dCBjaGFubmVs
KQogZW5kCiAKKygqCisJQnkgZGVmYXVsdCBPQ2FtbCdzIEdDIG9ubHkgcmV0
dXJucyBtZW1vcnkgdG8gdGhlIE9TIHdoZW4gaXQgZXhjZWVkcyBhCisJY29u
ZmlndXJhYmxlICdtYXggb3ZlcmhlYWQnIHNldHRpbmcuCisJVGhlIGRlZmF1
bHQgaXMgNTAwJSwgdGhhdCBpcyA1LzZ0aCBvZiB0aGUgT0NhbWwgaGVhcCBu
ZWVkcyB0byBiZSBmcmVlCisJYW5kIG9ubHkgMS82dGggbGl2ZSBmb3IgYSBj
b21wYWN0aW9uIHRvIGJlIHRyaWdnZXJyZWQgdGhhdCB3b3VsZAorCXJlbGVh
c2UgbWVtb3J5IGJhY2sgdG8gdGhlIE9TLgorCUlmIHRoZSBsaW1pdCBpcyBu
b3QgaGl0IHRoZW4gdGhlIE9DYW1sIHByb2Nlc3MgY2FuIHJldXNlIHRoYXQg
bWVtb3J5CisJZm9yIGl0cyBvd24gcHVycG9zZXMsIGJ1dCBvdGhlciBwcm9j
ZXNzZXMgd29uJ3QgYmUgYWJsZSB0byB1c2UgaXQuCisKKwlUaGVyZSBpcyBh
bHNvIGEgJ3NwYWNlIG92ZXJoZWFkJyBzZXR0aW5nIHRoYXQgY29udHJvbHMg
aG93IG11Y2ggd29yaworCWVhY2ggbWFqb3IgR0Mgc2xpY2UgZG9lcywgYW5k
IGJ5IGRlZmF1bHQgYWltcyBhdCBoYXZpbmcgbm8gbW9yZSB0aGFuCisJODAl
IG9yIDEyMCUgKGRlcGVuZGluZyBvbiB2ZXJzaW9uKSBnYXJiYWdlIHZhbHVl
cyBjb21wYXJlZCB0byBsaXZlCisJdmFsdWVzLgorCVRoaXMgZG9lc24ndCBo
YXZlIGFzIG11Y2ggcmVsZXZhbmNlIHRvIG1lbW9yeSByZXR1cm5lZCB0byB0
aGUgT1MgYXMKKwlsb25nIGFzIHNwYWNlX292ZXJoZWFkIDw9IG1heF9vdmVy
aGVhZCwgYmVjYXVzZSBjb21wYWN0aW9uIGlzIG9ubHkKKwl0cmlnZ2VycmVk
IGF0IHRoZSBlbmQgb2YgbWFqb3IgR0MgY3ljbGVzLgorCisJVGhlIGRlZmF1
bHRzIGFyZSB0b28gbGFyZ2Ugb25jZSB0aGUgcHJvZ3JhbSBzdGFydHMgdXNp
bmcgfjEwME1pQiBvZgorCW1lbW9yeSwgYXQgd2hpY2ggcG9pbnQgfjUwME1p
QiB3b3VsZCBiZSB1bmF2YWlsYWJsZSB0byBvdGhlciBwcm9jZXNzZXMKKwko
d2hpY2ggd291bGQgYmUgZmluZSBpZiB0aGlzIHdhcyB0aGUgbWFpbiBwcm9j
ZXNzIGluIHRoaXMgVk0sIGJ1dCBpdCBpcworCW5vdCkuCisKKwlNYXggb3Zl
cmhlYWQgY2FuIGFsc28gYmUgc2V0IHRvIDAsIGhvd2V2ZXIgdGhpcyBpcyBm
b3IgdGVzdGluZyBwdXJwb3NlcworCW9ubHkgKHNldHRpbmcgaXQgbG93ZXIg
dGhhbiAnc3BhY2Ugb3ZlcmhlYWQnIHdvdWxkbid0IGhlbHAgYmVjYXVzZSB0
aGUKKwltYWpvciBHQyB3b3VsZG4ndCBydW4gZmFzdCBlbm91Z2gsIGFuZCBj
b21wYWN0aW9uIGRvZXMgaGF2ZSBhCisJcGVyZm9ybWFuY2UgY29zdDogd2Ug
Y2FuIG9ubHkgY29tcGFjdCBjb250aWd1b3VzIHJlZ2lvbnMsIHNvIG1lbW9y
eSBoYXMKKwl0byBiZSBtb3ZlZCBhcm91bmQpLgorCisJTWF4IG92ZXJoZWFk
IGNvbnRyb2xzIGhvdyBvZnRlbiB0aGUgaGVhcCBpcyBjb21wYWN0ZWQsIHdo
aWNoIGlzIHVzZWZ1bAorCWlmIHRoZXJlIGFyZSBidXJzdCBvZiBhY3Rpdml0
eSBmb2xsb3dlZCBieSBsb25nIHBlcmlvZHMgb2YgaWRsZSBzdGF0ZSwKKwlv
ciBpZiBhIGRvbWFpbiBxdWl0cywgZXRjLiBDb21wYWN0aW9uIHJldHVybnMg
bWVtb3J5IHRvIHRoZSBPUy4KKworCXdhc3RlZCA9IGxpdmUgKiBzcGFjZV9v
dmVyaGVhZCAvIDEwMAorCisJRm9yIGdsb2JhbGx5IG92ZXJyaWRpbmcgdGhl
IEdDIHNldHRpbmdzIG9uZSBjYW4gdXNlIE9DQU1MUlVOUEFSQU0sCisJaG93
ZXZlciB3ZSBwcm92aWRlIGEgY29uZmlnIGZpbGUgb3ZlcnJpZGUgdG8gYmUg
Y29uc2lzdGVudCB3aXRoIG90aGVyCisJb3hlbnN0b3JlZCBzZXR0aW5ncy4K
KworCU9uZSBtaWdodCB3YW50IHRvIGR5bmFtaWNhbGx5IGFkanVzdCB0aGUg
b3ZlcmhlYWQgc2V0dGluZyBiYXNlZCBvbiB1c2VkCisJbWVtb3J5LCBpLmUu
IHRvIHVzZSBhIGZpeGVkIHVwcGVyIGJvdW5kIGluIGJ5dGVzLCBub3QgcGVy
Y2VudGFnZS4gSG93ZXZlcgorCW1lYXN1cmVtZW50cyBzaG93IHRoYXQgc3Vj
aCBhZGp1c3RtZW50cyBpbmNyZWFzZSBHQyBvdmVyaGVhZCBtYXNzaXZlbHks
CisJd2hpbGUgc3RpbGwgbm90IGd1YXJhbnRlZWluZyB0aGF0IG1lbW9yeSBp
cyByZXR1cm5lZCBhbnkgbW9yZSBxdWlja2x5CisJdGhhbiB3aXRoIGEgcGVy
Y2VudGFnZSBiYXNlZCBzZXR0aW5nLgorCisJVGhlIGFsbG9jYXRpb24gcG9s
aWN5IGNvdWxkIGFsc28gYmUgdHdlYWtlZCwgZS5nLiBmaXJzdCBmaXQgd291
bGQgcmVkdWNlCisJZnJhZ21lbnRhdGlvbiBhbmQgdGh1cyBtZW1vcnkgdXNh
Z2UsIGJ1dCB0aGUgZG9jdW1lbnRhdGlvbiB3YXJucyB0aGF0IGl0CisJY2Fu
IGJlIHNlbnNpYmx5IHNsb3dlciwgYW5kIGluZGVlZCBvbmUgb2Ygb3VyIG93
biB0ZXN0Y2FzZXMgY2FuIHRyaWdnZXIKKwlzdWNoIGEgY29ybmVyIGNhc2Ug
d2hlcmUgaXQgaXMgbXVsdGlwbGUgdGltZXMgc2xvd2VyLCBzbyBpdCBpcyBi
ZXN0IHRvIGtlZXAKKwl0aGUgZGVmYXVsdCBhbGxvY2F0aW9uIHBvbGljeSAo
bmV4dC1maXQvYmVzdC1maXQgZGVwZW5kaW5nIG9uIHZlcnNpb24pLgorCisJ
VGhlcmUgYXJlIG90aGVyIHR3ZWFrcyB0aGF0IGNhbiBiZSBhdHRlbXB0ZWQg
aW4gdGhlIGZ1dHVyZSwgZS5nLiBzZXR0aW5nCisJJ3VsaW1pdCAtdicgdG8g
NzUlIG9mIFJBTSwgaG93ZXZlciBnZXR0aW5nIHRoZSBrZXJuZWwgdG8gYWN0
dWFsbHkgcmV0dXJuCisJTlVMTCBmcm9tIGFsbG9jYXRpb25zIGlzIGRpZmZp
Y3VsdCBldmVuIHdpdGggdGhhdCBzZXR0aW5nLCBhbmQgd2l0aG91dCBhCisJ
TlVMTCB0aGUgZW1lcmdlbmN5IEdDIHdvbid0IGJlIHRyaWdnZXJyZWQuCisJ
UGVyaGFwcyBjZ3JvdXAgbGltaXRzIGNvdWxkIGhlbHAsIGJ1dCBmb3Igbm93
IHR3ZWFrIHRoZSBzYWZlc3Qgb25seS4KKyopCisKK2xldCB0d2Vha19nYyAo
KSA9CisJR2Muc2V0IHsgKEdjLmdldCAoKSkgd2l0aCBHYy5tYXhfb3Zlcmhl
YWQgPSAhRGVmaW5lLmdjX21heF9vdmVyaGVhZCB9CisKKwogbGV0IF8gPQog
CWxldCBjZiA9IGRvX2FyZ3YgaW4KIAlsZXQgcGlkZmlsZSA9CkBAIC0yMzgs
NiArMzAwLDggQEAgbGV0IF8gPQogCQkJZGVmYXVsdF9waWRmaWxlCiAJCWlu
CiAKKwl0d2Vha19nYyAoKTsKKwogCSh0cnkKIAkJVW5peGV4dC5ta2Rpcl9y
ZWMgKEZpbGVuYW1lLmRpcm5hbWUgcGlkZmlsZSkgMG83NTUKIAl3aXRoIF8g
LT4K

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSBlNDQ0ZmY1ZjE0NzIzYzc3NGU5OTkzZDRlYTRlZGM0NjcxY2RjYzM0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogRnJpLCAyOSBKdWwgMjAyMiAxODo1MzoyOSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC9saWJzL3hiOiBoaWRlIHR5cGUgb2YgWGIudApN
SU1FLVZlcnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNo
YXJzZXQ9VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoK
SGlkaW5nIHRoZSB0eXBlIHdpbGwgbWFrZSBpdCBlYXNpZXIgdG8gY2hhbmdl
IHRoZSBpbXBsZW1lbnRhdGlvbgppbiB0aGUgZnV0dXJlIHdpdGhvdXQgYnJl
YWtpbmcgY29kZSB0aGF0IHJlbGllcyBvbiBpdC4KCk5vIGZ1bmN0aW9uYWwg
Y2hhbmdlLgoKU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KKGNoZXJyeSBwaWNrZWQg
ZnJvbSBjb21taXQgN2FkZTMwYTE0NTE3MzRkMDQxMzYzYzc1MGE2NWQzMjJl
MjViNDdiYSkKClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94
Yi5tbCBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwKaW5kZXggMTA0ZDMx
OWQ3NzQ3Li44NDA0ZGRkOGE2ODIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L2xpYnMveGIveGIubWwKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5t
bApAQCAtMTk2LDYgKzE5Niw5IEBAIGxldCBwZWVrX291dHB1dCBjb24gPSBR
dWV1ZS5wZWVrIGNvbi5wa3Rfb3V0CiBsZXQgaW5wdXRfbGVuIGNvbiA9IFF1
ZXVlLmxlbmd0aCBjb24ucGt0X2luCiBsZXQgaGFzX2luX3BhY2tldCBjb24g
PSBRdWV1ZS5sZW5ndGggY29uLnBrdF9pbiA+IDAKIGxldCBnZXRfaW5fcGFj
a2V0IGNvbiA9IFF1ZXVlLnBvcCBjb24ucGt0X2luCitsZXQgaGFzX3BhcnRp
YWxfaW5wdXQgY29uID0gbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAorCXwg
SGF2ZUhkciBfIC0+IHRydWUKKwl8IE5vSGRyIChuLCBfKSAtPiBuIDwgUGFy
dGlhbC5oZWFkZXJfc2l6ZSAoKQogbGV0IGhhc19tb3JlX2lucHV0IGNvbiA9
CiAJbWF0Y2ggY29uLmJhY2tlbmQgd2l0aAogCXwgRmQgXyAgICAgICAgIC0+
IGZhbHNlCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDNhMDBkYTZj
ZGRjMS4uNzk0ZTM1YmIzNDNlIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNjYsMTMgKzY2LDcgQEAgdHlwZSBiYWNrZW5kX21tYXAgPSB7CiB0
eXBlIGJhY2tlbmRfZmQgPSB7IGZkIDogVW5peC5maWxlX2Rlc2NyOyB9CiB0
eXBlIGJhY2tlbmQgPSBGZCBvZiBiYWNrZW5kX2ZkIHwgWGVubW1hcCBvZiBi
YWNrZW5kX21tYXAKIHR5cGUgcGFydGlhbF9idWYgPSBIYXZlSGRyIG9mIFBh
cnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMKLXR5cGUgdCA9IHsK
LSAgYmFja2VuZCA6IGJhY2tlbmQ7Ci0gIHBrdF9pbiA6IFBhY2tldC50IFF1
ZXVlLnQ7Ci0gIHBrdF9vdXQgOiBQYWNrZXQudCBRdWV1ZS50OwotICBtdXRh
YmxlIHBhcnRpYWxfaW4gOiBwYXJ0aWFsX2J1ZjsKLSAgbXV0YWJsZSBwYXJ0
aWFsX291dCA6IHN0cmluZzsKLX0KK3R5cGUgdAogdmFsIGluaXRfcGFydGlh
bF9pbiA6IHVuaXQgLT4gcGFydGlhbF9idWYKIHZhbCByZWNvbm5lY3QgOiB0
IC0+IHVuaXQKIHZhbCBxdWV1ZSA6IHQgLT4gUGFja2V0LnQgLT4gdW5pdApA
QCAtOTcsNiArOTEsNyBAQCB2YWwgaGFzX291dHB1dCA6IHQgLT4gYm9vbAog
dmFsIHBlZWtfb3V0cHV0IDogdCAtPiBQYWNrZXQudAogdmFsIGlucHV0X2xl
biA6IHQgLT4gaW50CiB2YWwgaGFzX2luX3BhY2tldCA6IHQgLT4gYm9vbAor
dmFsIGhhc19wYXJ0aWFsX2lucHV0IDogdCAtPiBib29sCiB2YWwgZ2V0X2lu
X3BhY2tldCA6IHQgLT4gUGFja2V0LnQKIHZhbCBoYXNfbW9yZV9pbnB1dCA6
IHQgLT4gYm9vbAogdmFsIGlzX3NlbGVjdGFibGUgOiB0IC0+IGJvb2wKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1s
IGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb24ubWwKaW5kZXgg
ZGFmOGQ4MDRmN2VmLi43MGM0MzQ4NTUyOGMgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCkBAIC0xMjUsOSArMTI1LDcg
QEAgbGV0IGdldF9wZXJtIGNvbiA9CiBsZXQgc2V0X3RhcmdldCBjb24gdGFy
Z2V0X2RvbWlkID0KIAljb24ucGVybSA8LSBQZXJtcy5Db25uZWN0aW9uLnNl
dF90YXJnZXQgKGdldF9wZXJtIGNvbikgfnBlcm1zOltQZXJtcy5SRUFEOyBQ
ZXJtcy5XUklURV0gdGFyZ2V0X2RvbWlkCiAKLWxldCBpc19iYWNrZW5kX21t
YXAgY29uID0gbWF0Y2ggY29uLnhiLlhlbmJ1cy5YYi5iYWNrZW5kIHdpdGgK
LQl8IFhlbmJ1cy5YYi5YZW5tbWFwIF8gLT4gdHJ1ZQotCXwgXyAtPiBmYWxz
ZQorbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBYZW5idXMuWGIuaXNfbW1h
cCBjb24ueGIKIAogbGV0IHNlbmRfcmVwbHkgY29uIHRpZCByaWQgdHkgZGF0
YSA9CiAJaWYgKFN0cmluZy5sZW5ndGggZGF0YSkgPiB4ZW5zdG9yZV9wYXls
b2FkX21heCAmJiAoaXNfYmFja2VuZF9tbWFwIGNvbikgdGhlbgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSA0YTA2MjlmNzQ3MjM3Y2Q2ZmJiMjMwZjk0N2VmMjczZGI3N2NjODFl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogQ2hhbmdlIFhiLmlucHV0IHRvIHJldHVybiBQ
YWNrZXQudCBvcHRpb24KTUlNRS1WZXJzaW9uOiAxLjAKQ29udGVudC1UeXBl
OiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRlbnQtVHJhbnNmZXIt
RW5jb2Rpbmc6IDhiaXQKClRoZSBxdWV1ZSBoZXJlIHdvdWxkIG9ubHkgZXZl
ciBob2xkIGF0IG1vc3Qgb25lIGVsZW1lbnQuICBUaGlzIHdpbGwgc2ltcGxp
ZnkKZm9sbG93LXVwIHBhdGNoZXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
Ni4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24u
Y29tPgpTaWduZWQtb2ZmLWJ5OiBFZHdpbiBUw7Zyw7ZrIDxlZHZpbi50b3Jv
a0BjaXRyaXguY29tPgpBY2tlZC1ieTogQ2hyaXN0aWFuIExpbmRpZyA8Y2hy
aXN0aWFuLmxpbmRpZ0BjaXRyaXguY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL2xpYnMveGIveGIubWwgYi90b29scy9vY2FtbC9saWJzL3hiL3hi
Lm1sCmluZGV4IDg0MDRkZGQ4YTY4Mi4uMTY1ZmQ0YTFlZGY0IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1sCisrKyBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKQEAgLTQ1LDcgKzQ1LDYgQEAgdHlwZSBwYXJ0
aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlhbC5wa3QgfCBOb0hkciBvZiBp
bnQgKiBieXRlcwogdHlwZSB0ID0KIHsKIAliYWNrZW5kOiBiYWNrZW5kOwot
CXBrdF9pbjogUGFja2V0LnQgUXVldWUudDsKIAlwa3Rfb3V0OiBQYWNrZXQu
dCBRdWV1ZS50OwogCW11dGFibGUgcGFydGlhbF9pbjogcGFydGlhbF9idWY7
CiAJbXV0YWJsZSBwYXJ0aWFsX291dDogc3RyaW5nOwpAQCAtNjIsNyArNjEs
NiBAQCBsZXQgcmVjb25uZWN0IHQgPSBtYXRjaCB0LmJhY2tlbmQgd2l0aAog
CQlYc19yaW5nLmNsb3NlIGJhY2tlbmQubW1hcDsKIAkJYmFja2VuZC5ldmVu
dGNobl9ub3RpZnkgKCk7CiAJCSgqIENsZWFyIG91ciBvbGQgY29ubmVjdGlv
biBzdGF0ZSAqKQotCQlRdWV1ZS5jbGVhciB0LnBrdF9pbjsKIAkJUXVldWUu
Y2xlYXIgdC5wa3Rfb3V0OwogCQl0LnBhcnRpYWxfaW4gPC0gaW5pdF9wYXJ0
aWFsX2luICgpOwogCQl0LnBhcnRpYWxfb3V0IDwtICIiCkBAIC0xMjQsNyAr
MTIyLDYgQEAgbGV0IG91dHB1dCBjb24gPQogCiAoKiBOQjogY2FuIHRocm93
IFJlY29ubmVjdCAqKQogbGV0IGlucHV0IGNvbiA9Ci0JbGV0IG5ld3BhY2tl
dCA9IHJlZiBmYWxzZSBpbgogCWxldCB0b19yZWFkID0KIAkJbWF0Y2ggY29u
LnBhcnRpYWxfaW4gd2l0aAogCQl8IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4g
UGFydGlhbC50b19jb21wbGV0ZSBwYXJ0aWFsX3BrdApAQCAtMTQzLDIxICsx
NDAsMTkgQEAgbGV0IGlucHV0IGNvbiA9CiAJCWlmIFBhcnRpYWwudG9fY29t
cGxldGUgcGFydGlhbF9wa3QgPSAwIHRoZW4gKAogCQkJbGV0IHBrdCA9IFBh
Y2tldC5vZl9wYXJ0aWFscGt0IHBhcnRpYWxfcGt0IGluCiAJCQljb24ucGFy
dGlhbF9pbiA8LSBpbml0X3BhcnRpYWxfaW4gKCk7Ci0JCQlRdWV1ZS5wdXNo
IHBrdCBjb24ucGt0X2luOwotCQkJbmV3cGFja2V0IDo9IHRydWUKLQkJKQor
CQkJU29tZSBwa3QKKwkJKSBlbHNlIE5vbmUKIAl8IE5vSGRyIChpLCBidWYp
ICAgICAgLT4KIAkJKCogd2UgY29tcGxldGUgdGhlIHBhcnRpYWwgaGVhZGVy
ICopCiAJCWlmIHN6ID4gMCB0aGVuCiAJCQlCeXRlcy5ibGl0IGIgMCBidWYg
KFBhcnRpYWwuaGVhZGVyX3NpemUgKCkgLSBpKSBzejsKIAkJY29uLnBhcnRp
YWxfaW4gPC0gaWYgc3ogPSBpIHRoZW4KLQkJCUhhdmVIZHIgKFBhcnRpYWwu
b2Zfc3RyaW5nIChCeXRlcy50b19zdHJpbmcgYnVmKSkgZWxzZSBOb0hkciAo
aSAtIHN6LCBidWYpCi0JKTsKLQkhbmV3cGFja2V0CisJCQlIYXZlSGRyIChQ
YXJ0aWFsLm9mX3N0cmluZyAoQnl0ZXMudG9fc3RyaW5nIGJ1ZikpIGVsc2Ug
Tm9IZHIgKGkgLSBzeiwgYnVmKTsKKwkJTm9uZQorCSkKIAogbGV0IG5ld2Nv
biBiYWNrZW5kID0gewogCWJhY2tlbmQgPSBiYWNrZW5kOwotCXBrdF9pbiA9
IFF1ZXVlLmNyZWF0ZSAoKTsKIAlwa3Rfb3V0ID0gUXVldWUuY3JlYXRlICgp
OwogCXBhcnRpYWxfaW4gPSBpbml0X3BhcnRpYWxfaW4gKCk7CiAJcGFydGlh
bF9vdXQgPSAiIjsKQEAgLTE5Myw5ICsxODgsNiBAQCBsZXQgaGFzX291dHB1
dCBjb24gPSBoYXNfbmV3X291dHB1dCBjb24gfHwgaGFzX29sZF9vdXRwdXQg
Y29uCiAKIGxldCBwZWVrX291dHB1dCBjb24gPSBRdWV1ZS5wZWVrIGNvbi5w
a3Rfb3V0CiAKLWxldCBpbnB1dF9sZW4gY29uID0gUXVldWUubGVuZ3RoIGNv
bi5wa3RfaW4KLWxldCBoYXNfaW5fcGFja2V0IGNvbiA9IFF1ZXVlLmxlbmd0
aCBjb24ucGt0X2luID4gMAotbGV0IGdldF9pbl9wYWNrZXQgY29uID0gUXVl
dWUucG9wIGNvbi5wa3RfaW4KIGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24g
PSBtYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCiAJfCBIYXZlSGRyIF8gLT4g
dHJ1ZQogCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBQYXJ0aWFsLmhlYWRlcl9z
aXplICgpCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDc5NGUzNWJi
MzQzZS4uOTFjNjgyMTYyY2VhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNzcsNyArNzcsNyBAQCB2YWwgd3JpdGVfZmQgOiBiYWNrZW5kX2Zk
IC0+ICdhIC0+IHN0cmluZyAtPiBpbnQgLT4gaW50CiB2YWwgd3JpdGVfbW1h
cCA6IGJhY2tlbmRfbW1hcCAtPiAnYSAtPiBzdHJpbmcgLT4gaW50IC0+IGlu
dAogdmFsIHdyaXRlIDogdCAtPiBzdHJpbmcgLT4gaW50IC0+IGludAogdmFs
IG91dHB1dCA6IHQgLT4gYm9vbAotdmFsIGlucHV0IDogdCAtPiBib29sCit2
YWwgaW5wdXQgOiB0IC0+IFBhY2tldC50IG9wdGlvbgogdmFsIG5ld2NvbiA6
IGJhY2tlbmQgLT4gdAogdmFsIG9wZW5fZmQgOiBVbml4LmZpbGVfZGVzY3Ig
LT4gdAogdmFsIG9wZW5fbW1hcCA6IFhlbm1tYXAubW1hcF9pbnRlcmZhY2Ug
LT4gKHVuaXQgLT4gdW5pdCkgLT4gdApAQCAtODksMTAgKzg5LDcgQEAgdmFs
IGhhc19uZXdfb3V0cHV0IDogdCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRw
dXQgOiB0IC0+IGJvb2wKIHZhbCBoYXNfb3V0cHV0IDogdCAtPiBib29sCiB2
YWwgcGVla19vdXRwdXQgOiB0IC0+IFBhY2tldC50Ci12YWwgaW5wdXRfbGVu
IDogdCAtPiBpbnQKLXZhbCBoYXNfaW5fcGFja2V0IDogdCAtPiBib29sCiB2
YWwgaGFzX3BhcnRpYWxfaW5wdXQgOiB0IC0+IGJvb2wKLXZhbCBnZXRfaW5f
cGFja2V0IDogdCAtPiBQYWNrZXQudAogdmFsIGhhc19tb3JlX2lucHV0IDog
dCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4gYm9vbAogdmFs
IGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sIGIvdG9vbHMvb2NhbWwvbGli
cy94cy94c3Jhdy5tbAppbmRleCBkOTgyZmIyNGRiYjEuLjQ1MWY4YjM4ZGJj
YyAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94cy94c3Jhdy5tbAor
KysgYi90b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sCkBAIC05NCwyNiAr
OTQsMTggQEAgbGV0IHBrdF9zZW5kIGNvbiA9CiAJZG9uZQogCiAoKiByZWNl
aXZlIG9uZSBwYWNrZXQgLSBjYW4gc2xlZXAgKikKLWxldCBwa3RfcmVjdiBj
b24gPQotCWxldCB3b3JrZG9uZSA9IHJlZiBmYWxzZSBpbgotCXdoaWxlIG5v
dCAhd29ya2RvbmUKLQlkbwotCQl3b3JrZG9uZSA6PSBYYi5pbnB1dCBjb24u
eGIKLQlkb25lOwotCVhiLmdldF9pbl9wYWNrZXQgY29uLnhiCitsZXQgcmVj
IHBrdF9yZWN2IGNvbiA9CisJbWF0Y2ggWGIuaW5wdXQgY29uLnhiIHdpdGgK
Kwl8IFNvbWUgcGFja2V0IC0+IHBhY2tldAorCXwgTm9uZSAtPiBwa3RfcmVj
diBjb24KIAogbGV0IHBrdF9yZWN2X3RpbWVvdXQgY29uIHRpbWVvdXQgPQog
CWxldCBmZCA9IFhiLmdldF9mZCBjb24ueGIgaW4KIAlsZXQgciwgXywgXyA9
IFVuaXguc2VsZWN0IFsgZmQgXSBbXSBbXSB0aW1lb3V0IGluCiAJaWYgciA9
IFtdIHRoZW4KIAkJdHJ1ZSwgTm9uZQotCWVsc2UgKAotCQlsZXQgd29ya2Rv
bmUgPSBYYi5pbnB1dCBjb24ueGIgaW4KLQkJaWYgd29ya2RvbmUgdGhlbgot
CQkJZmFsc2UsIChTb21lIChYYi5nZXRfaW5fcGFja2V0IGNvbi54YikpCi0J
CWVsc2UKLQkJCWZhbHNlLCBOb25lCi0JKQorCWVsc2UKKwkJZmFsc2UsIFhi
LmlucHV0IGNvbi54YgogCiBsZXQgcXVldWVfd2F0Y2hldmVudCBjb24gZGF0
YSA9CiAJbGV0IGxzID0gc3BsaXRfc3RyaW5nIH5saW1pdDoyICdcMDAwJyBk
YXRhIGluCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbi5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCmluZGV4IDcwYzQzNDg1NTI4Yy4uYWNlMmFhNWI0ZjUzIDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbAorKysg
Yi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbApAQCAtMjc3
LDggKzI3Nyw2IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAJ
SGFzaHRibC5maW5kIGNvbi50cmFuc2FjdGlvbnMgdGlkCiAKIGxldCBkb19p
bnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCi1sZXQgaGFzX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNvbi54YgotbGV0
IHBvcF9pbiBjb24gPSBYZW5idXMuWGIuZ2V0X2luX3BhY2tldCBjb24ueGIK
IGxldCBoYXNfbW9yZV9pbnB1dCBjb24gPSBYZW5idXMuWGIuaGFzX21vcmVf
aW5wdXQgY29uLnhiCiAKIGxldCBoYXNfb3V0cHV0IGNvbiA9IFhlbmJ1cy5Y
Yi5oYXNfb3V0cHV0IGNvbi54YgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwv
eGVuc3RvcmVkL3Byb2Nlc3MubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAppbmRleCAwZGYzZGY0MDFkYjYuLmE3MjgxMGQwNmY0MyAx
MDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Byb2Nlc3MubWwK
KysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Byb2Nlc3MubWwKQEAgLTU2
OSwxNiArNTY5LDE3IEBAIGxldCBkb19pbnB1dCBzdG9yZSBjb25zIGRvbXMg
Y29uID0KIAkJCWluZm8gIiVzIHJlcXVlc3RzIGEgcmVjb25uZWN0IiAoQ29u
bmVjdGlvbi5nZXRfZG9tc3RyIGNvbik7CiAJCQlIaXN0b3J5LnJlY29ubmVj
dCBjb247CiAJCQlpbmZvICIlcyByZWNvbm5lY3Rpb24gY29tcGxldGUiIChD
b25uZWN0aW9uLmdldF9kb21zdHIgY29uKTsKLQkJCWZhbHNlCisJCQlOb25l
CiAJCXwgRmFpbHVyZSBleHAgLT4KIAkJCWVycm9yICJjYXVnaHQgZXhjZXB0
aW9uICVzIiBleHA7CiAJCQllcnJvciAiZ290IGEgYmFkIGNsaWVudCAlcyIg
KHNwcmludGYgIiUtOHMiIChDb25uZWN0aW9uLmdldF9kb21zdHIgY29uKSk7
CiAJCQlDb25uZWN0aW9uLm1hcmtfYXNfYmFkIGNvbjsKLQkJCWZhbHNlCisJ
CQlOb25lCiAJaW4KIAotCWlmIG5ld3BhY2tldCB0aGVuICgKLQkJbGV0IHBh
Y2tldCA9IENvbm5lY3Rpb24ucG9wX2luIGNvbiBpbgorCW1hdGNoIG5ld3Bh
Y2tldCB3aXRoCisJfCBOb25lIC0+ICgpCisJfCBTb21lIHBhY2tldCAtPgog
CQlsZXQgdGlkLCByaWQsIHR5LCBkYXRhID0gWGVuYnVzLlhiLlBhY2tldC51
bnBhY2sgcGFja2V0IGluCiAJCWxldCByZXEgPSB7UGFja2V0LnRpZD10aWQ7
IFBhY2tldC5yaWQ9cmlkOyBQYWNrZXQudHk9dHk7IFBhY2tldC5kYXRhPWRh
dGF9IGluCiAKQEAgLTU4OCw4ICs1ODksNyBAQCBsZXQgZG9faW5wdXQgc3Rv
cmUgY29ucyBkb21zIGNvbiA9CiAJCSAgICAgICAgIChYZW5idXMuWGIuT3Au
dG9fc3RyaW5nIHR5KSAoc2FuaXRpemVfZGF0YSBkYXRhKTsgKikKIAkJcHJv
Y2Vzc19wYWNrZXQgfnN0b3JlIH5jb25zIH5kb21zIH5jb24gfnJlcTsKIAkJ
d3JpdGVfYWNjZXNzX2xvZyB+dHkgfnRpZCB+Y29uOihDb25uZWN0aW9uLmdl
dF9kb21zdHIgY29uKSB+ZGF0YTsKLQkJQ29ubmVjdGlvbi5pbmNyX29wcyBj
b247Ci0JKQorCQlDb25uZWN0aW9uLmluY3Jfb3BzIGNvbgogCiBsZXQgZG9f
b3V0cHV0IF9zdG9yZSBfY29ucyBfZG9tcyBjb24gPQogCWlmIENvbm5lY3Rp
b24uaGFzX291dHB1dCBjb24gdGhlbiAoCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSBmYWVkMGVlM2NjYzI5NDBiMDFiMGM1MGQzYWRjODRlYWYyMDYxOGVk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94YjogQWRkIEJvdW5kZWRRdWV1ZQpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKRW5zdXJl
cyB3ZSBjYW5ub3Qgc3RvcmUgbW9yZSB0aGFuIFtjYXBhY2l0eV0gZWxlbWVu
dHMgaW4gYSBbUXVldWVdLiAgUmVwbGFjaW5nCmFsbCBRdWV1ZSB3aXRoIHRo
aXMgbW9kdWxlIHdpbGwgdGhlbiBlbnN1cmUgYXQgY29tcGlsZSB0aW1lIHRo
YXQgYWxsIFF1ZXVlcwphcmUgY29ycmVjdGx5IGJvdW5kIGNoZWNrZWQuCgpF
YWNoIGVsZW1lbnQgaW4gdGhlIHF1ZXVlIGhhcyBhIGNsYXNzIHdpdGggaXRz
IG93biBsaW1pdHMuICBUaGlzLCBpbiBhCnN1YnNlcXVlbnQgY2hhbmdlLCB3
aWxsIGVuc3VyZSB0aGF0IGNvbW1hbmQgcmVzcG9uc2VzIGNhbiBwcm9jZWVk
IGR1cmluZyBhCmZsb29kIG9mIHdhdGNoIGV2ZW50cy4KCk5vIGZ1bmN0aW9u
YWwgY2hhbmdlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRl
ZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVk
LW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcgPGNocmlzdGlhbi5saW5k
aWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJz
L3hiL3hiLm1sIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbAppbmRleCAx
NjVmZDRhMWVkZjQuLjQxOTdhMzg4OGE2OCAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwvbGlicy94Yi94Yi5tbAorKysgYi90b29scy9vY2FtbC9saWJzL3hi
L3hiLm1sCkBAIC0xNyw2ICsxNyw5OCBAQAogbW9kdWxlIE9wID0gc3RydWN0
IGluY2x1ZGUgT3AgZW5kCiBtb2R1bGUgUGFja2V0ID0gc3RydWN0IGluY2x1
ZGUgUGFja2V0IGVuZAogCittb2R1bGUgQm91bmRlZFF1ZXVlIDogc2lnCisJ
dHlwZSAoJ2EsICdiKSB0CisKKwkoKiogW2NyZWF0ZSB+Y2FwYWNpdHkgfmNs
YXNzaWZ5IH5saW1pdF0gY3JlYXRlcyBhIHF1ZXVlIHdpdGggbWF4aW11bSBb
Y2FwYWNpdHldIGVsZW1lbnRzLgorCSAgICBUaGlzIGlzIGJ1cnN0IGNhcGFj
aXR5LCBlYWNoIGVsZW1lbnQgaXMgZnVydGhlciBjbGFzc2lmaWVkIGFjY29y
ZGluZyB0byBbY2xhc3NpZnldLAorCSAgICBhbmQgZWFjaCBjbGFzcyBjYW4g
aGF2ZSBpdHMgb3duIFtsaW1pdF0uCisJICAgIFtjYXBhY2l0eV0gaXMgZW5m
b3JjZWQgYXMgYW4gb3ZlcmFsbCBsaW1pdC4KKwkgICAgVGhlIFtsaW1pdF0g
Y2FuIGJlIGR5bmFtaWMsIGFuZCBjYW4gYmUgc21hbGxlciB0aGFuIHRoZSBu
dW1iZXIgb2YgZWxlbWVudHMgYWxyZWFkeSBxdWV1ZWQgb2YgdGhhdCBjbGFz
cywKKwkgICAgaW4gd2hpY2ggY2FzZSB0aG9zZSBlbGVtZW50cyBhcmUgY29u
c2lkZXJlZCB0byB1c2UgImJ1cnN0IGNhcGFjaXR5Ii4KKwkgICopCisJdmFs
IGNyZWF0ZTogY2FwYWNpdHk6aW50IC0+IGNsYXNzaWZ5OignYSAtPiAnYikg
LT4gbGltaXQ6KCdiIC0+IGludCkgLT4gKCdhLCAnYikgdAorCisJKCoqIFtj
bGVhciBxXSBkaXNjYXJkcyBhbGwgZWxlbWVudHMgZnJvbSBbcV0gKikKKwl2
YWwgY2xlYXI6ICgnYSwgJ2IpIHQgLT4gdW5pdAorCisJKCoqIFtjYW5fcHVz
aCBxXSB3aGVuIFtsZW5ndGggcSA8IGNhcGFjaXR5XS4JKikKKwl2YWwgY2Fu
X3B1c2g6ICgnYSwgJ2IpIHQgLT4gJ2IgLT4gYm9vbAorCisJKCoqIFtwdXNo
IGUgcV0gYWRkcyBbZV0gYXQgdGhlIGVuZCBvZiBxdWV1ZSBbcV0gaWYgW2Nh
bl9wdXNoIHFdLCBvciByZXR1cm5zIFtOb25lXS4gKikKKwl2YWwgcHVzaDog
J2EgLT4gKCdhLCAnYikgdCAtPiB1bml0IG9wdGlvbgorCisJKCoqIFtwb3Ag
cV0gcmVtb3ZlcyBhbmQgcmV0dXJucyBmaXJzdCBlbGVtZW50IGluIFtxXSwg
b3IgcmFpc2VzIFtRdWV1ZS5FbXB0eV0uICopCisJdmFsIHBvcDogKCdhLCAn
YikgdCAtPiAnYQorCisJKCoqIFtwZWVrIHFdIHJldHVybnMgdGhlIGZpcnN0
IGVsZW1lbnQgaW4gW3FdLCBvciByYWlzZXMgW1F1ZXVlLkVtcHR5XS4gICop
CisJdmFsIHBlZWsgOiAoJ2EsICdiKSB0IC0+ICdhCisKKwkoKiogW2xlbmd0
aCBxXSByZXR1cm5zIHRoZSBjdXJyZW50IG51bWJlciBvZiBlbGVtZW50cyBp
biBbcV0gKikKKwl2YWwgbGVuZ3RoOiAoJ2EsICdiKSB0IC0+IGludAorCisJ
KCoqIFtkZWJ1ZyBzdHJpbmdfb2ZfY2xhc3MgcV0gcHJpbnRzIHF1ZXVlIHVz
YWdlIHN0YXRpc3RpY3MgaW4gYW4gdW5zcGVjaWZpZWQgaW50ZXJuYWwgZm9y
bWF0LiAqKQorCXZhbCBkZWJ1ZzogKCdiIC0+IHN0cmluZykgLT4gKF8sICdi
KSB0IC0+IHN0cmluZworZW5kID0gc3RydWN0CisJdHlwZSAoJ2EsICdiKSB0
ID0KKwkJeyBxOiAnYSBRdWV1ZS50CisJCTsgY2FwYWNpdHk6IGludAorCQk7
IGNsYXNzaWZ5OiAnYSAtPiAnYgorCQk7IGxpbWl0OiAnYiAtPiBpbnQKKwkJ
OyBjbGFzc19jb3VudDogKCdiLCBpbnQpIEhhc2h0YmwudAorCQl9CisKKwls
ZXQgY3JlYXRlIH5jYXBhY2l0eSB+Y2xhc3NpZnkgfmxpbWl0ID0KKwkJeyBj
YXBhY2l0eTsgcSA9IFF1ZXVlLmNyZWF0ZSAoKTsgY2xhc3NpZnk7IGxpbWl0
OyBjbGFzc19jb3VudCA9IEhhc2h0YmwuY3JlYXRlIDMgfQorCisJbGV0IGdl
dF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uID0gdHJ5IEhhc2h0YmwuZmluZCB0
LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIHdpdGggTm90X2ZvdW5kIC0+
IDAKKworCWxldCBjYW5fcHVzaF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9u
IGNsYXNzX2NvdW50ID0KKwkJUXVldWUubGVuZ3RoIHQucSA8IHQuY2FwYWNp
dHkgJiYgY2xhc3NfY291bnQgPCB0LmxpbWl0IGNsYXNzaWZpY2F0aW9uCisK
KwlsZXQgb2sgPSBTb21lICgpCisKKwlsZXQgcHVzaCBlIHQgPQorCQlsZXQg
Y2xhc3NpZmljYXRpb24gPSB0LmNsYXNzaWZ5IGUgaW4KKwkJbGV0IGNsYXNz
X2NvdW50ID0gZ2V0X2NvdW50IHQgY2xhc3NpZmljYXRpb24gaW4KKwkJaWYg
Y2FuX3B1c2hfaW50ZXJuYWwgdCBjbGFzc2lmaWNhdGlvbiBjbGFzc19jb3Vu
dCB0aGVuIGJlZ2luCisJCQlRdWV1ZS5wdXNoIGUgdC5xOworCQkJSGFzaHRi
bC5yZXBsYWNlIHQuY2xhc3NfY291bnQgY2xhc3NpZmljYXRpb24gKGNsYXNz
X2NvdW50ICsgMSk7CisJCQlvaworCQllbmQKKwkJZWxzZQorCQkJTm9uZQor
CisJbGV0IGNhbl9wdXNoIHQgY2xhc3NpZmljYXRpb24gPQorCQljYW5fcHVz
aF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9uIEBAIGdldF9jb3VudCB0IGNs
YXNzaWZpY2F0aW9uCisKKwlsZXQgY2xlYXIgdCA9CisJCVF1ZXVlLmNsZWFy
IHQucTsKKwkJSGFzaHRibC5yZXNldCB0LmNsYXNzX2NvdW50CisKKwlsZXQg
cG9wIHQgPQorCQlsZXQgZSA9IFF1ZXVlLnBvcCB0LnEgaW4KKwkJbGV0IGNs
YXNzaWZpY2F0aW9uID0gdC5jbGFzc2lmeSBlIGluCisJCWxldCAoKSA9IG1h
dGNoIGdldF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uIC0gMSB3aXRoCisJCXwg
MCAtPiBIYXNodGJsLnJlbW92ZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0
aW9uICgqIHJlZHVjZXMgbWVtdXNhZ2UgKikKKwkJfCBuIC0+IEhhc2h0Ymwu
cmVwbGFjZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIG4KKwkJaW4K
KwkJZQorCisJbGV0IHBlZWsgdCA9IFF1ZXVlLnBlZWsgdC5xCisJbGV0IGxl
bmd0aCB0ID0gUXVldWUubGVuZ3RoIHQucQorCisJbGV0IGRlYnVnIHN0cmlu
Z19vZl9jbGFzcyB0ID0KKwkJbGV0IGIgPSBCdWZmZXIuY3JlYXRlIDEyOCBp
bgorCQlQcmludGYuYnByaW50ZiBiICJCb3VuZGVkUXVldWUgY2FwYWNpdHk6
ICVkLCB1c2VkOiB7IiB0LmNhcGFjaXR5OworCQlIYXNodGJsLml0ZXIgKGZ1
biBwYWNrZXRfY2xhc3MgY291bnQgLT4KKwkJCVByaW50Zi5icHJpbnRmIGIg
IgklczogJWQiIChzdHJpbmdfb2ZfY2xhc3MgcGFja2V0X2NsYXNzKSBjb3Vu
dAorCQkpIHQuY2xhc3NfY291bnQ7CisJCVByaW50Zi5icHJpbnRmIGIgIn0i
OworCQlCdWZmZXIuY29udGVudHMgYgorZW5kCisKKwogZXhjZXB0aW9uIEVu
ZF9vZl9maWxlCiBleGNlcHRpb24gRWFnYWluCiBleGNlcHRpb24gTm9lbnQK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSAzNzQ1NTRjOTJhODI5NDcyZWM0MjZmZDE1NjJkMDI4ZmQyZTMzMjY4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNCArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogTGltaXQgbWF4aW11bSBpbi1mbGlnaHQgcmVx
dWVzdHMgLyBvdXRzdGFuZGluZyByZXBsaWVzCk1JTUUtVmVyc2lvbjogMS4w
CkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250
ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA4Yml0CgpJbnRyb2R1Y2UgYSBsaW1p
dCBvbiB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcGx5IHBhY2tldHMg
aW4gdGhlIHhlbmJ1cwpxdWV1ZS4gIFRoaXMgbGltaXRzIHRoZSBudW1iZXIg
b2YgaW4tZmxpZ2h0IHJlcXVlc3RzOiB3aGVuIHRoZSBvdXRwdXQgcXVldWUg
aXMKZnVsbCB3ZSdsbCBzdG9wIHByb2Nlc3NpbmcgaW5wdXRzIHVudGlsIHRo
ZSBvdXRwdXQgcXVldWUgaGFzIHJvb20gYWdhaW4uCgpUbyBhdm9pZCBhIGJ1
c3kgbG9vcCBvbiB0aGUgVW5peCBzb2NrZXQgd2Ugb25seSBhZGQgaXQgdG8g
dGhlIHdhdGNoZWQgaW5wdXQKZmlsZSBkZXNjcmlwdG9yIHNldCBpZiB3ZSdk
IGJlIGFibGUgdG8gY2FsbCBgaW5wdXRgIG9uIGl0LiAgRXZlbiB0aG91Z2gg
RG9tMAppcyB0cnVzdGVkIGFuZCBleGVtcHQgZnJvbSBxdW90YXMgYSBmbG9v
ZCBvZiBldmVudHMgbWlnaHQgY2F1c2UgYSBiYWNrbG9nCndoZXJlIGV2ZW50
cyBhcmUgcHJvZHVjZWQgZmFzdGVyIHRoYW4gZGFlbW9ucyBpbiBEb20wIGNh
biBjb25zdW1lIHRoZW0sIHdoaWNoCmNvdWxkIGxlYWQgdG8gYW4gdW5ib3Vu
ZGVkIHF1ZXVlIHNpemUgYW5kIE9PTS4KClRoZXJlZm9yZSB0aGUgeGVuYnVz
IHF1ZXVlIGxpbWl0IG11c3QgYXBwbHkgdG8gYWxsIGNvbm5lY3Rpb25zLCBE
b20wIGlzIG5vdApleGVtcHQgZnJvbSBpdCwgYWx0aG91Z2ggaWYgZXZlcnl0
aGluZyB3b3JrcyBjb3JyZWN0bHkgaXQgd2lsbCBldmVudHVhbGx5CmNhdGNo
IHVwLgoKVGhpcyBwcmV2ZW50cyBhIG1hbGljaW91cyBndWVzdCBmcm9tIHNl
bmRpbmcgbW9yZSBjb21tYW5kcyB3aGlsZSBpdCBoYXMKb3V0c3RhbmRpbmcg
d2F0Y2ggZXZlbnRzIG9yIGNvbW1hbmQgcmVwbGllcyBpbiBpdHMgaW5wdXQg
cmluZy4gIEhvd2V2ZXIgaWYgaXQKY2FuIGNhdXNlIHRoZSBnZW5lcmF0aW9u
IG9mIHdhdGNoIGV2ZW50cyBieSBvdGhlciBtZWFucyAoZS5nLiBieSBEb20w
LCBvcgphbm90aGVyIGNvb3BlcmF0aXZlIGd1ZXN0KSBhbmQgc3RvcCByZWFk
aW5nIGl0cyBvd24gcmluZyB0aGVuIHdhdGNoIGV2ZW50cwp3b3VsZCd2ZSBx
dWV1ZWQgdXAgd2l0aG91dCBsaW1pdC4KClRoZSB4ZW5zdG9yZSBwcm90b2Nv
bCBkb2Vzbid0IGhhdmUgYSBiYWNrLXByZXNzdXJlIG1lY2hhbmlzbSwgYW5k
IGRvZXNuJ3QKYWxsb3cgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzLiAgSW4gZmFj
dCwgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzIGlzIGtub3duIHRvIGJyZWFrCnNv
bWUgcGllY2VzIG9mIG5vcm1hbCBmdW5jdGlvbmFsaXR5LiAgVGhpcyBsZWF2
ZXMgbGl0dGxlIGNob2ljZSB0byBzYWZlbHkKaW1wbGVtZW50IHRoZSB4ZW5z
dG9yZSBwcm90b2NvbCB3aXRob3V0IGV4cG9zaW5nIHRoZSB4ZW5zdG9yZSBk
YWVtb24gdG8Kb3V0LW9mLW1lbW9yeSBhdHRhY2tzLgoKSW1wbGVtZW50IHRo
ZSBmaXggYXMgcGlwZXMgd2l0aCBib3VuZGVkIGJ1ZmZlcnM6CiogVXNlIGEg
Ym91bmRlZCBidWZmZXIgZm9yIHdhdGNoIGV2ZW50cwoqIFRoZSB3YXRjaCBz
dHJ1Y3R1cmUgd2lsbCBoYXZlIGEgYm91bmRlZCByZWNlaXZpbmcgcGlwZSBv
ZiB3YXRjaCBldmVudHMKKiBUaGUgc291cmNlIHdpbGwgaGF2ZSBhbiAib3Zl
cmZsb3ciIHBpcGUgb2YgcGVuZGluZyB3YXRjaCBldmVudHMgaXQgY291bGRu
J3QKICBkZWxpdmVyCgpJdGVtcyBhcmUgcXVldWVkIHVwIG9uIG9uZSBlbmQg
YW5kIGFyZSBzZW50IGFzIGZhciBhbG9uZyB0aGUgcGlwZSBhcyBwb3NzaWJs
ZToKCiAgc291cmNlIGRvbWFpbiAtPiB3YXRjaCAtPiB4ZW5idXMgb2YgdGFy
Z2V0IC0+IHhlbnN0b3JlIHJpbmcvc29ja2V0IG9mIHRhcmdldAoKSWYgdGhl
IHBpcGUgaXMgImZ1bGwiIGF0IGFueSBwb2ludCB0aGVuIGJhY2stcHJlc3N1
cmUgaXMgYXBwbGllZCBhbmQgd2UgcHJldmVudAptb3JlIGl0ZW1zIGZyb20g
YmVpbmcgcXVldWVkIHVwLiAgRm9yIHRoZSBzb3VyY2UgZG9tYWluIHRoaXMg
bWVhbnMgdGhhdCB3ZSdsbApzdG9wIGFjY2VwdGluZyBuZXcgY29tbWFuZHMg
YXMgbG9uZyBhcyBpdHMgcGlwZSBidWZmZXIgaXMgbm90IGVtcHR5LgoKQmVm
b3JlIHdlIHRyeSB0byBlbnF1ZXVlIGFuIGl0ZW0gd2UgZmlyc3QgY2hlY2sg
d2hldGhlciBpdCBpcyBwb3NzaWJsZSB0byBzZW5kCml0IGZ1cnRoZXIgZG93
biB0aGUgcGlwZSwgYnkgYXR0ZW1wdGluZyB0byByZWN1cnNpdmVseSBmbHVz
aCB0aGUgcGlwZXMuIFRoaXMKZW5zdXJlcyB0aGF0IHdlIHJldGFpbiB0aGUg
b3JkZXIgb2YgZXZlbnRzIGFzIG11Y2ggYXMgcG9zc2libGUuCgpXZSBtaWdo
dCBicmVhayBjYXVzYWxpdHkgb2Ygd2F0Y2ggZXZlbnRzIGlmIHRoZSB0YXJn
ZXQgZG9tYWluJ3MgcXVldWUgaXMgZnVsbAphbmQgd2UgbmVlZCB0byBzdGFy
dCB1c2luZyB0aGUgd2F0Y2gncyBxdWV1ZS4gIFRoaXMgaXMgYSBicmVha2lu
ZyBjaGFuZ2UgaW4KdGhlIHhlbnN0b3JlIHByb3RvY29sLCBidXQgb25seSBm
b3IgZG9tYWlucyB3aGljaCBhcmUgbm90IHByb2Nlc3NpbmcgdGhlaXIKaW5j
b21pbmcgcmluZyBhcyBleHBlY3RlZC4KCldoZW4gYSB3YXRjaCBpcyBkZWxl
dGVkIGl0cyBlbnRpcmUgcGVuZGluZyBxdWV1ZSBpcyBkcm9wcGVkIChubyBj
b2RlIGlzIG5lZWRlZApmb3IgdGhhdCwgYmVjYXVzZSBpdCBpcyBwYXJ0IG9m
IHRoZSAnd2F0Y2gnIHR5cGUpLgoKVGhlcmUgaXMgYSBjYWNoZSBvZiB3YXRj
aGVzIHRoYXQgaGF2ZSBwZW5kaW5nIGV2ZW50cyB0aGF0IHdlIGF0dGVtcHQg
dG8gZmx1c2gKYXQgZXZlcnkgY3ljbGUgaWYgcG9zc2libGUuCgpJbnRyb2R1
Y2UgMyBsaW1pdHMgaGVyZToKKiBxdW90YS1tYXh3YXRjaGV2ZW50cyBvbiB3
YXRjaCBldmVudCBkZXN0aW5hdGlvbjogd2hlbiB0aGlzIGlzIGhpdCB0aGUK
ICBzb3VyY2Ugd2lsbCBub3QgYmUgYWxsb3dlZCB0byBxdWV1ZSB1cCBtb3Jl
IHdhdGNoIGV2ZW50cy4KKiBxdW90YS1tYXhvdXN0YW5kaW5nIHdoaWNoIGlz
IHRoZSBudW1iZXIgb2YgcmVzcG9uc2VzIG5vdCByZWFkIGZyb20gdGhlIHJp
bmc6CiAgb25jZSBleGNlZWRlZCwgbm8gbW9yZSBpbnB1dHMgYXJlIHByb2Nl
c3NlZCB1bnRpbCBhbGwgb3V0c3RhbmRpbmcgcmVwbGllcwogIGFyZSBjb25z
dW1lZCBieSB0aGUgY2xpZW50LgoqIG92ZXJmbG93IHF1ZXVlIG9uIHRoZSB3
YXRjaCBldmVudCBzb3VyY2U6IGFsbCB3YXRjaGVzIHRoYXQgY2Fubm90IGJl
IHN0b3JlZAogIG9uIGRlc3RpbmF0aW9uIGFyZSBxdWV1ZWQgdXAgaGVyZSwg
YSBzaW5nbGUgY29tbWFuZCBjYW4gdHJpZ2dlciBtdWx0aXBsZQogIHdhdGNo
ZXMgKGUuZy4gZHVlIHRvIHJlY3Vyc2lvbikuCgpUaGUgb3ZlcmZsb3cgcXVl
dWUgY3VycmVudGx5IGRvZXNuJ3QgaGF2ZSBhbiB1cHBlciBib3VuZCwgaXQg
aXMgZGlmZmljdWx0IHRvCmFjY3VyYXRlbHkgY2FsY3VsYXRlIG9uZSBhcyBp
dCBkZXBlbmRzIG9uIHdoZXRoZXIgeW91IGFyZSBEb20wIGFuZCBob3cgbWFu
eQp3YXRjaGVzIGVhY2ggcGF0aCBoYXMgcmVnaXN0ZXJlZCBhbmQgaG93IG1h
bnkgd2F0Y2ggZXZlbnRzIHlvdSBjYW4gdHJpZ2dlcgp3aXRoIGEgc2luZ2xl
IGNvbW1hbmQgKGUuZy4gYSBjb21taXQpLiAgSG93ZXZlciB0aGVzZSBldmVu
dHMgd2VyZSBhbHJlYWR5CnVzaW5nIG1lbW9yeSwgdGhpcyBqdXN0IG1vdmVz
IHRoZW0gZWxzZXdoZXJlLCBhbmQgYXMgbG9uZyBhcyB3ZSBjb3JyZWN0bHkK
YmxvY2sgYSBkb21haW4gaXQgc2hvdWxkbid0IHJlc3VsdCBpbiB1bmJvdW5k
ZWQgbWVtb3J5IHVzYWdlLgoKTm90ZSB0aGF0IERvbTAgaXMgbm90IGV4Y2x1
ZGVkIGZyb20gdGhlc2UgY2hlY2tzLCBpdCBpcyBpbXBvcnRhbnQgdGhhdCBE
b20wIGlzCmVzcGVjaWFsbHkgbm90IGV4Y2x1ZGVkIHdoZW4gaXQgaXMgdGhl
IHNvdXJjZSwgc2luY2UgdGhlcmUgYXJlIG1hbnkgd2F5cyBpbgp3aGljaCBh
IGd1ZXN0IGNvdWxkIHRyaWdnZXIgRG9tMCB0byBzZW5kIGl0IHdhdGNoIGV2
ZW50cy4KClRoaXMgc2hvdWxkIHByb3RlY3QgYWdhaW5zdCBtYWxpY2lvdXMg
ZnJvbnRlbmRzIGFzIGxvbmcgYXMgdGhlIGJhY2tlbmQgZm9sbG93cwp0aGUg
UFYgeGVuc3RvcmUgcHJvdG9jb2wgYW5kIG9ubHkgZXhwb3NlcyBwYXRocyBu
ZWVkZWQgYnkgdGhlIGZyb250ZW5kLCBhbmQKY2hhbmdlcyB0aG9zZSBwYXRo
cyBhdCBtb3N0IG9uY2UgYXMgYSByZWFjdGlvbiB0byBndWVzdCBldmVudHMs
IG9yIHByb3RvY29sCnN0YXRlLgoKVGhlIHF1ZXVlIGxpbWl0cyBhcmUgcGVy
IHdhdGNoLCBhbmQgcGVyIGRvbWFpbi1wYWlyLCBzbyBldmVuIGlmIG9uZQpj
b21tdW5pY2F0aW9uIGNoYW5uZWwgd291bGQgYmUgImJsb2NrZWQiLCBvdGhl
cnMgd291bGQga2VlcCB3b3JraW5nLCBhbmQgdGhlCmRvbWFpbiBpdHNlbGYg
d29uJ3QgZ2V0IGJsb2NrZWQgYXMgbG9uZyBhcyBpdCBkb2Vzbid0IG92ZXJm
bG93IHRoZSBxdWV1ZSBvZgp3YXRjaCBldmVudHMuCgpTaW1pbGFybHkgYSBt
YWxpY2lvdXMgYmFja2VuZCBjb3VsZCBjYXVzZSB0aGUgZnJvbnRlbmQgdG8g
Z2V0IGJsb2NrZWQsIGJ1dAp0aGlzIHdhdGNoIHF1ZXVlIHByb3RlY3RzIHRo
ZSBmcm9udGVuZCBhcyB3ZWxsIGFzIGxvbmcgYXMgaXQgZm9sbG93cyB0aGUg
UFYKcHJvdG9jb2wuICAoQWx0aG91Z2ggbm90ZSB0aGF0IHByb3RlY3Rpb24g
YWdhaW5zdCBtYWxpY2lvdXMgYmFja2VuZHMgaXMgb25seSBhCmJlc3QgZWZm
b3J0IGF0IHRoZSBtb21lbnQpCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAv
IENWRS0yMDIyLTQyMzE4LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLD
tmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3Rp
YW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbCBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKaW5kZXggNDE5N2EzODg4YTY4Li5iMjkyZWQ3
YTg3NGQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwK
KysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbApAQCAtMTM0LDE0ICsx
MzQsNDQgQEAgdHlwZSBiYWNrZW5kID0gRmQgb2YgYmFja2VuZF9mZCB8IFhl
bm1tYXAgb2YgYmFja2VuZF9tbWFwCiAKIHR5cGUgcGFydGlhbF9idWYgPSBI
YXZlSGRyIG9mIFBhcnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMK
IAorKCoKKwlzZXBhcmF0ZSBjYXBhY2l0eSByZXNlcnZhdGlvbiBmb3IgcmVw
bGllcyBhbmQgd2F0Y2ggZXZlbnRzOgorCXRoaXMgYWxsb3dzIGEgZG9tYWlu
IHRvIGtlZXAgd29ya2luZyBldmVuIHdoZW4gdW5kZXIgYSBjb25zdGFudCBm
bG9vZCBvZgorCXdhdGNoIGV2ZW50cworKikKK3R5cGUgY2FwYWNpdHkgPSB7
IG1heG91dHN0YW5kaW5nOiBpbnQ7IG1heHdhdGNoZXZlbnRzOiBpbnQgfQor
Cittb2R1bGUgUXVldWUgPSBCb3VuZGVkUXVldWUKKwordHlwZSBwYWNrZXRf
Y2xhc3MgPQorCXwgQ29tbWFuZFJlcGx5CisJfCBXYXRjaGV2ZW50CisKK2xl
dCBzdHJpbmdfb2ZfcGFja2V0X2NsYXNzID0gZnVuY3Rpb24KKwl8IENvbW1h
bmRSZXBseSAtPiAiY29tbWFuZF9yZXBseSIKKwl8IFdhdGNoZXZlbnQgLT4g
IndhdGNoX2V2ZW50IgorCiB0eXBlIHQgPQogewogCWJhY2tlbmQ6IGJhY2tl
bmQ7Ci0JcGt0X291dDogUGFja2V0LnQgUXVldWUudDsKKwlwa3Rfb3V0OiAo
UGFja2V0LnQsIHBhY2tldF9jbGFzcykgUXVldWUudDsKIAltdXRhYmxlIHBh
cnRpYWxfaW46IHBhcnRpYWxfYnVmOwogCW11dGFibGUgcGFydGlhbF9vdXQ6
IHN0cmluZzsKKwljYXBhY2l0eTogY2FwYWNpdHkKIH0KIAorbGV0IHRvX3Jl
YWQgY29uID0KKwltYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCisJCXwgSGF2
ZUhkciBwYXJ0aWFsX3BrdCAtPiBQYXJ0aWFsLnRvX2NvbXBsZXRlIHBhcnRp
YWxfcGt0CisJCXwgTm9IZHIgICAoaSwgXykgICAgLT4gaQorCitsZXQgZGVi
dWcgdCA9CisJUHJpbnRmLnNwcmludGYgIlhlbkJ1cyBzdGF0ZTogcGFydGlh
bF9pbjogJWQgbmVlZGVkLCBwYXJ0aWFsX291dDogJWQgYnl0ZXMsIHBrdF9v
dXQ6ICVkIHBhY2tldHMsICVzIgorCQkodG9fcmVhZCB0KQorCQkoU3RyaW5n
Lmxlbmd0aCB0LnBhcnRpYWxfb3V0KQorCQkoUXVldWUubGVuZ3RoIHQucGt0
X291dCkKKwkJKEJvdW5kZWRRdWV1ZS5kZWJ1ZyBzdHJpbmdfb2ZfcGFja2V0
X2NsYXNzIHQucGt0X291dCkKKwogbGV0IGluaXRfcGFydGlhbF9pbiAoKSA9
IE5vSGRyCiAJKFBhcnRpYWwuaGVhZGVyX3NpemUgKCksIEJ5dGVzLm1ha2Ug
KFBhcnRpYWwuaGVhZGVyX3NpemUoKSkgJ1wwMDAnKQogCkBAIC0xOTksNyAr
MjI5LDggQEAgbGV0IG91dHB1dCBjb24gPQogCWxldCBzID0gaWYgU3RyaW5n
Lmxlbmd0aCBjb24ucGFydGlhbF9vdXQgPiAwIHRoZW4KIAkJCWNvbi5wYXJ0
aWFsX291dAogCQllbHNlIGlmIFF1ZXVlLmxlbmd0aCBjb24ucGt0X291dCA+
IDAgdGhlbgotCQkJUGFja2V0LnRvX3N0cmluZyAoUXVldWUucG9wIGNvbi5w
a3Rfb3V0KQorCQkJbGV0IHBrdCA9IFF1ZXVlLnBvcCBjb24ucGt0X291dCBp
bgorCQkJUGFja2V0LnRvX3N0cmluZyBwa3QKIAkJZWxzZQogCQkJIiIgaW4K
IAkoKiBzZW5kIGRhdGEgZnJvbSBzLCBhbmQgc2F2ZSB0aGUgdW5zZW50IGRh
dGEgdG8gcGFydGlhbF9vdXQgKikKQEAgLTIxMiwxMiArMjQzLDE1IEBAIGxl
dCBvdXRwdXQgY29uID0KIAkoKiBhZnRlciBzZW5kaW5nIG9uZSBwYWNrZXQs
IHBhcnRpYWwgaXMgZW1wdHkgKikKIAljb24ucGFydGlhbF9vdXQgPSAiIgog
CisoKiB3ZSBjYW4gb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCBpZiB3
ZSdyZSBndWFyYW50ZWVkIHRvIGhhdmUgcm9vbQorICAgdG8gc3RvcmUgdGhl
IHJlc3BvbnNlIHBhY2tldCAqKQorbGV0IGNhbl9pbnB1dCBjb24gPSBRdWV1
ZS5jYW5fcHVzaCBjb24ucGt0X291dCBDb21tYW5kUmVwbHkKKwogKCogTkI6
IGNhbiB0aHJvdyBSZWNvbm5lY3QgKikKIGxldCBpbnB1dCBjb24gPQotCWxl
dCB0b19yZWFkID0KLQkJbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAotCQl8
IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4gUGFydGlhbC50b19jb21wbGV0ZSBw
YXJ0aWFsX3BrdAotCQl8IE5vSGRyICAgKGksIF8pICAgIC0+IGkgaW4KKwlp
ZiBub3QgKGNhbl9pbnB1dCBjb24pIHRoZW4gTm9uZQorCWVsc2UKKwlsZXQg
dG9fcmVhZCA9IHRvX3JlYWQgY29uIGluCiAKIAkoKiB0cnkgdG8gZ2V0IG1v
cmUgZGF0YSBmcm9tIGlucHV0IHN0cmVhbSAqKQogCWxldCBiID0gQnl0ZXMu
bWFrZSB0b19yZWFkICdcMDAwJyBpbgpAQCAtMjQzLDExICsyNzcsMjIgQEAg
bGV0IGlucHV0IGNvbiA9CiAJCU5vbmUKIAkpCiAKLWxldCBuZXdjb24gYmFj
a2VuZCA9IHsKK2xldCBjbGFzc2lmeSB0ID0KKwltYXRjaCB0LlBhY2tldC50
eSB3aXRoCisJfCBPcC5XYXRjaGV2ZW50IC0+IFdhdGNoZXZlbnQKKwl8IF8g
LT4gQ29tbWFuZFJlcGx5CisKK2xldCBuZXdjb24gfmNhcGFjaXR5IGJhY2tl
bmQgPQorCWxldCBsaW1pdCA9IGZ1bmN0aW9uCisJCXwgQ29tbWFuZFJlcGx5
IC0+IGNhcGFjaXR5Lm1heG91dHN0YW5kaW5nCisJCXwgV2F0Y2hldmVudCAt
PiBjYXBhY2l0eS5tYXh3YXRjaGV2ZW50cworCWluCisJewogCWJhY2tlbmQg
PSBiYWNrZW5kOwotCXBrdF9vdXQgPSBRdWV1ZS5jcmVhdGUgKCk7CisJcGt0
X291dCA9IFF1ZXVlLmNyZWF0ZSB+Y2FwYWNpdHk6KGNhcGFjaXR5Lm1heG91
dHN0YW5kaW5nICsgY2FwYWNpdHkubWF4d2F0Y2hldmVudHMpIH5jbGFzc2lm
eSB+bGltaXQ7CiAJcGFydGlhbF9pbiA9IGluaXRfcGFydGlhbF9pbiAoKTsK
IAlwYXJ0aWFsX291dCA9ICIiOworCWNhcGFjaXR5ID0gY2FwYWNpdHk7CiAJ
fQogCiBsZXQgb3Blbl9mZCBmZCA9IG5ld2NvbiAoRmQgeyBmZCA9IGZkOyB9
KQpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkgYi90
b29scy9vY2FtbC9saWJzL3hiL3hiLm1saQppbmRleCA5MWM2ODIxNjJjZWEu
LjcxYjI3NTRjYTc4OCAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94
Yi94Yi5tbGkKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkKQEAg
LTY2LDEwICs2NiwxMSBAQCB0eXBlIGJhY2tlbmRfbW1hcCA9IHsKIHR5cGUg
YmFja2VuZF9mZCA9IHsgZmQgOiBVbml4LmZpbGVfZGVzY3I7IH0KIHR5cGUg
YmFja2VuZCA9IEZkIG9mIGJhY2tlbmRfZmQgfCBYZW5tbWFwIG9mIGJhY2tl
bmRfbW1hcAogdHlwZSBwYXJ0aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlh
bC5wa3QgfCBOb0hkciBvZiBpbnQgKiBieXRlcwordHlwZSBjYXBhY2l0eSA9
IHsgbWF4b3V0c3RhbmRpbmc6IGludDsgbWF4d2F0Y2hldmVudHM6IGludCB9
CiB0eXBlIHQKIHZhbCBpbml0X3BhcnRpYWxfaW4gOiB1bml0IC0+IHBhcnRp
YWxfYnVmCiB2YWwgcmVjb25uZWN0IDogdCAtPiB1bml0Ci12YWwgcXVldWUg
OiB0IC0+IFBhY2tldC50IC0+IHVuaXQKK3ZhbCBxdWV1ZSA6IHQgLT4gUGFj
a2V0LnQgLT4gdW5pdCBvcHRpb24KIHZhbCByZWFkX2ZkIDogYmFja2VuZF9m
ZCAtPiAnYSAtPiBieXRlcyAtPiBpbnQgLT4gaW50CiB2YWwgcmVhZF9tbWFw
IDogYmFja2VuZF9tbWFwIC0+ICdhIC0+IGJ5dGVzIC0+IGludCAtPiBpbnQK
IHZhbCByZWFkIDogdCAtPiBieXRlcyAtPiBpbnQgLT4gaW50CkBAIC03OCwx
MyArNzksMTQgQEAgdmFsIHdyaXRlX21tYXAgOiBiYWNrZW5kX21tYXAgLT4g
J2EgLT4gc3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCB3cml0ZSA6IHQgLT4g
c3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCBvdXRwdXQgOiB0IC0+IGJvb2wK
IHZhbCBpbnB1dCA6IHQgLT4gUGFja2V0LnQgb3B0aW9uCi12YWwgbmV3Y29u
IDogYmFja2VuZCAtPiB0Ci12YWwgb3Blbl9mZCA6IFVuaXguZmlsZV9kZXNj
ciAtPiB0Ci12YWwgb3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFj
ZSAtPiAodW5pdCAtPiB1bml0KSAtPiB0Cit2YWwgbmV3Y29uIDogY2FwYWNp
dHk6Y2FwYWNpdHkgLT4gYmFja2VuZCAtPiB0Cit2YWwgb3Blbl9mZCA6IFVu
aXguZmlsZV9kZXNjciAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0Cit2YWwg
b3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFjZSAtPiAodW5pdCAt
PiB1bml0KSAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0CiB2YWwgY2xvc2Ug
OiB0IC0+IHVuaXQKIHZhbCBpc19mZCA6IHQgLT4gYm9vbAogdmFsIGlzX21t
YXAgOiB0IC0+IGJvb2wKIHZhbCBvdXRwdXRfbGVuIDogdCAtPiBpbnQKK3Zh
bCBjYW5faW5wdXQ6IHQgLT4gYm9vbAogdmFsIGhhc19uZXdfb3V0cHV0IDog
dCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRwdXQgOiB0IC0+IGJvb2wKIHZh
bCBoYXNfb3V0cHV0IDogdCAtPiBib29sCkBAIC05MywzICs5NSw0IEBAIHZh
bCBoYXNfcGFydGlhbF9pbnB1dCA6IHQgLT4gYm9vbAogdmFsIGhhc19tb3Jl
X2lucHV0IDogdCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4g
Ym9vbAogdmFsIGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCit2YWwg
ZGVidWc6IHQgLT4gc3RyaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9s
aWJzL3hzL3F1ZXVlb3AubWwgYi90b29scy9vY2FtbC9saWJzL3hzL3F1ZXVl
b3AubWwKaW5kZXggOWZmNWJiZDUyOWNlLi40ZTUzMmNkYWVhY2IgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveHMvcXVldWVvcC5tbAorKysgYi90
b29scy9vY2FtbC9saWJzL3hzL3F1ZXVlb3AubWwKQEAgLTE2LDkgKzE2LDEw
IEBACiBvcGVuIFhlbmJ1cwogCiBsZXQgZGF0YV9jb25jYXQgbHMgPSAoU3Ry
aW5nLmNvbmNhdCAiXDAwMCIgbHMpIF4gIlwwMDAiCitsZXQgcXVldWUgY29u
IHBrdCA9IGxldCByID0gWGIucXVldWUgY29uIHBrdCBpbiBhc3NlcnQgKHIg
PD4gTm9uZSkKIGxldCBxdWV1ZV9wYXRoIHR5ICh0aWQ6IGludCkgKHBhdGg6
IHN0cmluZykgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0
aDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQogCiAoKiBvcGVyYXRpb25zICopCiBsZXQgZGlyZWN0b3J5
IHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuRGlyZWN0b3J5IHRp
ZCBwYXRoIGNvbgpAQCAtMjcsNDggKzI4LDQ4IEBAIGxldCByZWFkIHRpZCBw
YXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuUmVhZCB0aWQgcGF0aCBjb24K
IGxldCBnZXRwZXJtcyB0aWQgcGF0aCBjb24gPSBxdWV1ZV9wYXRoIFhiLk9w
LkdldHBlcm1zIHRpZCBwYXRoIGNvbgogCiBsZXQgZGVidWcgY29tbWFuZHMg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLkRlYnVnIChkYXRhX2NvbmNhdCBjb21tYW5kcykpCisJcXVldWUgY29u
IChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5EZWJ1ZyAoZGF0YV9jb25j
YXQgY29tbWFuZHMpKQogCiBsZXQgd2F0Y2ggcGF0aCBkYXRhIGNvbiA9CiAJ
bGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7IGRhdGE7IF0gaW4KLQlY
Yi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhiLk9wLldhdGNo
IGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5P
cC5XYXRjaCBkYXRhKQogCiBsZXQgdW53YXRjaCBwYXRoIGRhdGEgY29uID0K
IAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0aDsgZGF0YTsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuVW53
YXRjaCBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAg
WGIuT3AuVW53YXRjaCBkYXRhKQogCiBsZXQgdHJhbnNhY3Rpb25fc3RhcnQg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLlRyYW5zYWN0aW9uX3N0YXJ0IChkYXRhX2NvbmNhdCBbXSkpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5UcmFuc2FjdGlv
bl9zdGFydCAoZGF0YV9jb25jYXQgW10pKQogCiBsZXQgdHJhbnNhY3Rpb25f
ZW5kIHRpZCBjb21taXQgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0
IFsgKGlmIGNvbW1pdCB0aGVuICJUIiBlbHNlICJGIik7IF0gaW4KLQlYYi5x
dWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuVHJhbnNh
Y3Rpb25fZW5kIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRl
IHRpZCAwIFhiLk9wLlRyYW5zYWN0aW9uX2VuZCBkYXRhKQogCiBsZXQgaW50
cm9kdWNlIGRvbWlkIG1mbiBwb3J0IGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRh
X2NvbmNhdCBbIFByaW50Zi5zcHJpbnRmICIldSIgZG9taWQ7CiAJICAgICAg
ICAgICAgICAgICAgICAgICAgIFByaW50Zi5zcHJpbnRmICIlbnUiIG1mbjsK
IAkgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nX29mX2ludCBwb3J0
OyBdIGluCi0JWGIucXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5JbnRyb2R1Y2UgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBhY2tldC5j
cmVhdGUgMCAwIFhiLk9wLkludHJvZHVjZSBkYXRhKQogCiBsZXQgcmVsZWFz
ZSBkb21pZCBjb24gPQogCWxldCBkYXRhID0gZGF0YV9jb25jYXQgWyBQcmlu
dGYuc3ByaW50ZiAiJXUiIGRvbWlkOyBdIGluCi0JWGIucXVldWUgY29uIChY
Yi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRhdGEpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRh
dGEpCiAKIGxldCByZXN1bWUgZG9taWQgY29uID0KIAlsZXQgZGF0YSA9IGRh
dGFfY29uY2F0IFsgUHJpbnRmLnNwcmludGYgIiV1IiBkb21pZDsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuUmVz
dW1lIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5SZXN1bWUgZGF0YSkKIAogbGV0IGdldGRvbWFpbnBhdGggZG9taWQg
Y29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgUHJpbnRmLnNwcmlu
dGYgIiV1IiBkb21pZDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0
LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0aCBkYXRhKQorCXF1ZXVl
IGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0
aCBkYXRhKQogCiBsZXQgd3JpdGUgdGlkIHBhdGggdmFsdWUgY29uID0KIAls
ZXQgZGF0YSA9IHBhdGggXiAiXDAwMCIgXiB2YWx1ZSAoKiBubyBOVUxMIGF0
IHRoZSBlbmQgKikgaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVh
dGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKIAogbGV0IG1r
ZGlyIHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuTWtkaXIgdGlk
IHBhdGggY29uCiBsZXQgcm0gdGlkIHBhdGggY29uID0gcXVldWVfcGF0aCBY
Yi5PcC5SbSB0aWQgcGF0aCBjb24KIAogbGV0IHNldHBlcm1zIHRpZCBwYXRo
IHBlcm1zIGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7
IHBlcm1zIF0gaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUg
dGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwgYi90b29scy9v
Y2FtbC9saWJzL3hzL3hzcmF3Lm1sCmluZGV4IDQ1MWY4YjM4ZGJjYy4uY2Jk
MTcyODA2MDBjIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9saWJzL3hzL3hz
cmF3Lm1sCisrKyBiL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwKQEAg
LTM2LDggKzM2LDEwIEBAIHR5cGUgY29uID0gewogbGV0IGNsb3NlIGNvbiA9
CiAJWGIuY2xvc2UgY29uLnhiCiAKK2xldCBjYXBhY2l0eSA9IHsgWGIubWF4
b3V0c3RhbmRpbmcgPSAxOyBtYXh3YXRjaGV2ZW50cyA9IDA7IH0KKwogbGV0
IG9wZW5fZmQgZmQgPSB7Ci0JeGIgPSBYYi5vcGVuX2ZkIGZkOworCXhiID0g
WGIub3Blbl9mZCB+Y2FwYWNpdHkgZmQ7CiAJd2F0Y2hldmVudHMgPSBRdWV1
ZS5jcmVhdGUgKCk7CiB9CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC9jb25uZWN0aW9uLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVk
L2Nvbm5lY3Rpb24ubWwKaW5kZXggYWNlMmFhNWI0ZjUzLi45YWFkNDUxYTJk
YmQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0
aW9uLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCkBAIC0yMCwxMiArMjAsODQgQEAgb3BlbiBTdGRleHQKIAogbGV0IHhl
bnN0b3JlX3BheWxvYWRfbWF4ID0gNDA5NiAoKiB4ZW4vaW5jbHVkZS9wdWJs
aWMvaW8veHNfd2lyZS5oICopCiAKK3R5cGUgJ2EgYm91bmRlZF9zZW5kZXIg
PSAnYSAtPiB1bml0IG9wdGlvbgorKCoqIGEgYm91bmRlZCBzZW5kZXIgYWNj
ZXB0cyBhbiBbJ2FdIGl0ZW0gYW5kIHJldHVybnM6CisgICAgTm9uZSAtIGlm
IHRoZXJlIGlzIG5vIHJvb20gdG8gYWNjZXB0IHRoZSBpdGVtCisgICAgU29t
ZSAoKSAtICBpZiBpdCBoYXMgc3VjY2Vzc2Z1bGx5IGFjY2VwdGVkL3NlbnQg
dGhlIGl0ZW0KKyAqKQorCittb2R1bGUgQm91bmRlZFBpcGUgOiBzaWcKKwl0
eXBlICdhIHQKKworCSgqKiBbY3JlYXRlIH5jYXBhY2l0eSB+ZGVzdGluYXRp
b25dIGNyZWF0ZXMgYSBib3VuZGVkIHBpcGUgd2l0aCBhCisJICAgIGxvY2Fs
IGJ1ZmZlciBob2xkaW5nIGF0IG1vc3QgW2NhcGFjaXR5XSBpdGVtcy4gIE9u
Y2UgdGhlIGJ1ZmZlciBpcworCSAgICBmdWxsIGl0IHdpbGwgbm90IGFjY2Vw
dCBmdXJ0aGVyIGl0ZW1zLiAgaXRlbXMgZnJvbSB0aGUgcGlwZSBhcmUKKwkg
ICAgZmx1c2hlZCBpbnRvIFtkZXN0aW5hdGlvbl0gYXMgbG9uZyBhcyBpdCBh
Y2NlcHRzIGl0ZW1zLiAgVGhlCisJICAgIGRlc3RpbmF0aW9uIGNvdWxkIGJl
IGFub3RoZXIgcGlwZS4KKwkgKikKKwl2YWwgY3JlYXRlOiBjYXBhY2l0eTpp
bnQgLT4gZGVzdGluYXRpb246J2EgYm91bmRlZF9zZW5kZXIgLT4gJ2EgdAor
CisJKCoqIFtpc19lbXB0eSB0XSByZXR1cm5zIHdoZXRoZXIgdGhlIGxvY2Fs
IGJ1ZmZlciBvZiBbdF0gaXMgZW1wdHkuICopCisJdmFsIGlzX2VtcHR5IDog
XyB0IC0+IGJvb2wKKworCSgqKiBbbGVuZ3RoIHRdIHRoZSBudW1iZXIgb2Yg
aXRlbXMgaW4gdGhlIGludGVybmFsIGJ1ZmZlciAqKQorCXZhbCBsZW5ndGg6
IF8gdCAtPiBpbnQKKworCSgqKiBbZmx1c2hfcGlwZSB0XSBzZW5kcyBhcyBt
YW55IGl0ZW1zIGZyb20gdGhlIGxvY2FsIGJ1ZmZlciBhcyBwb3NzaWJsZSwK
KwkJCXdoaWNoIGNvdWxkIGJlIG5vbmUuICopCisJdmFsIGZsdXNoX3BpcGU6
IF8gdCAtPiB1bml0CisKKwkoKiogW3B1c2ggdCBpdGVtXSB0cmllcyB0byBb
Zmx1c2hfcGlwZV0gYW5kIHRoZW4gcHVzaCBbaXRlbV0KKwkgICAgaW50byB0
aGUgcGlwZSBpZiBpdHMgW2NhcGFjaXR5XSBhbGxvd3MuCisJICAgIFJldHVy
bnMgW05vbmVdIGlmIHRoZXJlIGlzIG5vIG1vcmUgcm9vbQorCSAqKQorCXZh
bCBwdXNoIDogJ2EgdCAtPiAnYSBib3VuZGVkX3NlbmRlcgorZW5kID0gc3Ry
dWN0CisJKCogaXRlbXMgYXJlIGVucXVldWVkIGluIFtxXSwgYW5kIHRoZW4g
Zmx1c2hlZCB0byBbY29ubmVjdF90b10gKikKKwl0eXBlICdhIHQgPQorCQl7
IHE6ICdhIFF1ZXVlLnQKKwkJOyBkZXN0aW5hdGlvbjogJ2EgYm91bmRlZF9z
ZW5kZXIKKwkJOyBjYXBhY2l0eTogaW50CisJCX0KKworCWxldCBjcmVhdGUg
fmNhcGFjaXR5IH5kZXN0aW5hdGlvbiA9CisJCXsgcSA9IFF1ZXVlLmNyZWF0
ZSAoKTsgY2FwYWNpdHk7IGRlc3RpbmF0aW9uIH0KKworCWxldCByZWMgZmx1
c2hfcGlwZSB0ID0KKwkJaWYgbm90IFF1ZXVlLihpc19lbXB0eSB0LnEpIHRo
ZW4KKwkJCWxldCBpdGVtID0gUXVldWUucGVlayB0LnEgaW4KKwkJCW1hdGNo
IHQuZGVzdGluYXRpb24gaXRlbSB3aXRoCisJCQl8IE5vbmUgLT4gKCkgKCog
bm8gcm9vbSAqKQorCQkJfCBTb21lICgpIC0+CisJCQkJKCogc3VjY2Vzc2Z1
bGx5IHNlbnQgaXRlbSB0byBuZXh0IHN0YWdlICopCisJCQkJbGV0IF8gPSBR
dWV1ZS5wb3AgdC5xIGluCisJCQkJKCogY29udGludWUgdHJ5aW5nIHRvIHNl
bmQgbW9yZSBpdGVtcyAqKQorCQkJCWZsdXNoX3BpcGUgdAorCisJbGV0IHB1
c2ggdCBpdGVtID0KKwkJKCogZmlyc3QgdHJ5IHRvIGZsdXNoIGFzIG1hbnkg
aXRlbXMgZnJvbSB0aGlzIHBpcGUgYXMgcG9zc2libGUgdG8gbWFrZSByb29t
LAorCQkgICBpdCBpcyBpbXBvcnRhbnQgdG8gZG8gdGhpcyBmaXJzdCB0byBw
cmVzZXJ2ZSB0aGUgb3JkZXIgb2YgdGhlIGl0ZW1zCisJCSAqKQorCQlmbHVz
aF9waXBlIHQ7CisJCWlmIFF1ZXVlLmxlbmd0aCB0LnEgPCB0LmNhcGFjaXR5
IHRoZW4gYmVnaW4KKwkJCSgqIGVucXVldWUsIGluc3RlYWQgb2Ygc2VuZGlu
ZyBkaXJlY3RseS4KKwkJCSAgIHRoaXMgZW5zdXJlcyB0aGF0IFtvdXRdIHNl
ZXMgdGhlIGl0ZW1zIGluIHRoZSBzYW1lIG9yZGVyIGFzIHdlIHJlY2VpdmUg
dGhlbQorCQkJICopCisJCQlRdWV1ZS5wdXNoIGl0ZW0gdC5xOworCQkJU29t
ZSAoZmx1c2hfcGlwZSB0KQorCQllbmQgZWxzZSBOb25lCisKKwlsZXQgaXNf
ZW1wdHkgdCA9IFF1ZXVlLmlzX2VtcHR5IHQucQorCWxldCBsZW5ndGggdCA9
IFF1ZXVlLmxlbmd0aCB0LnEKK2VuZAorCiB0eXBlIHdhdGNoID0gewogCWNv
bjogdDsKIAl0b2tlbjogc3RyaW5nOwogCXBhdGg6IHN0cmluZzsKIAliYXNl
OiBzdHJpbmc7CiAJaXNfcmVsYXRpdmU6IGJvb2w7CisJcGVuZGluZ193YXRj
aGV2ZW50czogWGVuYnVzLlhiLlBhY2tldC50IEJvdW5kZWRQaXBlLnQ7CiB9
CiAKIGFuZCB0ID0gewpAQCAtMzgsOCArMTEwLDM2IEBAIGFuZCB0ID0gewog
CWFub25pZDogaW50OwogCW11dGFibGUgc3RhdF9uYl9vcHM6IGludDsKIAlt
dXRhYmxlIHBlcm06IFBlcm1zLkNvbm5lY3Rpb24udDsKKwlwZW5kaW5nX3Nv
dXJjZV93YXRjaGV2ZW50czogKHdhdGNoICogWGVuYnVzLlhiLlBhY2tldC50
KSBCb3VuZGVkUGlwZS50CiB9CiAKK21vZHVsZSBXYXRjaCA9IHN0cnVjdAor
CW1vZHVsZSBUID0gc3RydWN0CisJCXR5cGUgdCA9IHdhdGNoCisKKwkJbGV0
IGNvbXBhcmUgdzEgdzIgPQorCQkJKCogY2Fubm90IGNvbXBhcmUgd2F0Y2hl
cyBmcm9tIGRpZmZlcmVudCBjb25uZWN0aW9ucyAqKQorCQkJYXNzZXJ0ICh3
MS5jb24gPT0gdzIuY29uKTsKKwkJCW1hdGNoIFN0cmluZy5jb21wYXJlIHcx
LnRva2VuIHcyLnRva2VuIHdpdGgKKwkJCXwgMCAtPiBTdHJpbmcuY29tcGFy
ZSB3MS5wYXRoIHcyLnBhdGgKKwkJCXwgbiAtPiBuCisJZW5kCisJbW9kdWxl
IFNldCA9IFNldC5NYWtlKFQpCisKKwlsZXQgZmx1c2hfZXZlbnRzIHQgPQor
CQlCb3VuZGVkUGlwZS5mbHVzaF9waXBlIHQucGVuZGluZ193YXRjaGV2ZW50
czsKKwkJbm90IChCb3VuZGVkUGlwZS5pc19lbXB0eSB0LnBlbmRpbmdfd2F0
Y2hldmVudHMpCisKKwlsZXQgcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwkJ
Qm91bmRlZFBpcGUubGVuZ3RoIHQucGVuZGluZ193YXRjaGV2ZW50cworZW5k
CisKK2xldCBzb3VyY2VfZmx1c2hfd2F0Y2hldmVudHMgdCA9CisJQm91bmRl
ZFBpcGUuZmx1c2hfcGlwZSB0LnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRz
CisKK2xldCBzb3VyY2VfcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwlCb3Vu
ZGVkUGlwZS5sZW5ndGggdC5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50cwor
CiBsZXQgbWFya19hc19iYWQgY29uID0KIAltYXRjaCBjb24uZG9tIHdpdGgK
IAl8Tm9uZSAtPiAoKQpAQCAtNjcsNyArMTY3LDggQEAgbGV0IHdhdGNoX2Ny
ZWF0ZSB+Y29uIH5wYXRoIH50b2tlbiA9IHsKIAl0b2tlbiA9IHRva2VuOwog
CXBhdGggPSBwYXRoOwogCWJhc2UgPSBnZXRfcGF0aCBjb247Ci0JaXNfcmVs
YXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4gJ0AnCisJ
aXNfcmVsYXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4g
J0AnOworCXBlbmRpbmdfd2F0Y2hldmVudHMgPSBCb3VuZGVkUGlwZS5jcmVh
dGUgfmNhcGFjaXR5OiFEZWZpbmUubWF4d2F0Y2hldmVudHMgfmRlc3RpbmF0
aW9uOihYZW5idXMuWGIucXVldWUgY29uLnhiKQogfQogCiBsZXQgZ2V0X2Nv
biB3ID0gdy5jb24KQEAgLTkzLDYgKzE5NCw5IEBAIGxldCBtYWtlX3Blcm0g
ZG9tID0KIAlQZXJtcy5Db25uZWN0aW9uLmNyZWF0ZSB+cGVybXM6W1Blcm1z
LlJFQUQ7IFBlcm1zLldSSVRFXSBkb21pZAogCiBsZXQgY3JlYXRlIHhiY29u
IGRvbSA9CisJbGV0IGRlc3RpbmF0aW9uICh3YXRjaCwgcGt0KSA9CisJCUJv
dW5kZWRQaXBlLnB1c2ggd2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyBwa3QK
KwlpbgogCWxldCBpZCA9CiAJCW1hdGNoIGRvbSB3aXRoCiAJCXwgTm9uZSAt
PiBsZXQgb2xkID0gIWFub25faWRfbmV4dCBpbiBpbmNyIGFub25faWRfbmV4
dDsgb2xkCkBAIC0xMDksNiArMjEzLDE2IEBAIGxldCBjcmVhdGUgeGJjb24g
ZG9tID0KIAlhbm9uaWQgPSBpZDsKIAlzdGF0X25iX29wcyA9IDA7CiAJcGVy
bSA9IG1ha2VfcGVybSBkb207CisKKwkoKiB0aGUgYWN0dWFsIGNhcGFjaXR5
IHdpbGwgYmUgbG93ZXIsIHRoaXMgaXMgdXNlZCBhcyBhbiBvdmVyZmxvdwor
CSAgIGJ1ZmZlcjogYW55dGhpbmcgdGhhdCBkb2Vzbid0IGZpdCBlbHNld2hl
cmUgZ2V0cyBwdXQgaGVyZSwgb25seQorCSAgIGxpbWl0ZWQgYnkgdGhlIGFt
b3VudCBvZiB3YXRjaGVzIHRoYXQgeW91IGNhbiBnZW5lcmF0ZSB3aXRoIGEK
KwkgICBzaW5nbGUgeGVuc3RvcmUgY29tbWFuZCAod2hpY2ggaXMgZmluaXRl
LCBhbHRob3VnaCBwb3NzaWJseSB2ZXJ5CisJICAgbGFyZ2UgaW4gdGhlb3J5
IGZvciBEb20wKS4gIE9uY2UgdGhlIHBpcGUgaGVyZSBoYXMgYW55IGNvbnRl
bnRzIHRoZQorCSAgIGRvbWFpbiBpcyBibG9ja2VkIGZyb20gc2VuZGluZyBt
b3JlIGNvbW1hbmRzIHVudGlsIGl0IGlzIGVtcHR5CisJICAgYWdhaW4gdGhv
dWdoLgorCSAqKQorCXBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzID0gQm91
bmRlZFBpcGUuY3JlYXRlIH5jYXBhY2l0eTpTeXMubWF4X2FycmF5X2xlbmd0
aCB+ZGVzdGluYXRpb24KIAl9CiAJaW4KIAlMb2dnaW5nLm5ld19jb25uZWN0
aW9uIH50aWQ6VHJhbnNhY3Rpb24ubm9uZSB+Y29uOihnZXRfZG9tc3RyIGNv
bik7CkBAIC0xMjcsMTEgKzI0MSwxNyBAQCBsZXQgc2V0X3RhcmdldCBjb24g
dGFyZ2V0X2RvbWlkID0KIAogbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBY
ZW5idXMuWGIuaXNfbW1hcCBjb24ueGIKIAotbGV0IHNlbmRfcmVwbHkgY29u
IHRpZCByaWQgdHkgZGF0YSA9CitsZXQgcGFja2V0X29mIGNvbiB0aWQgcmlk
IHR5IGRhdGEgPQogCWlmIChTdHJpbmcubGVuZ3RoIGRhdGEpID4geGVuc3Rv
cmVfcGF5bG9hZF9tYXggJiYgKGlzX2JhY2tlbmRfbW1hcCBjb24pIHRoZW4K
LQkJWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAoWGVuYnVzLlhiLlBhY2tldC5j
cmVhdGUgdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgIkUyQklHXDAwMCIp
CisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgWGVuYnVzLlhi
Lk9wLkVycm9yICJFMkJJR1wwMDAiCiAJZWxzZQotCQlYZW5idXMuWGIucXVl
dWUgY29uLnhiIChYZW5idXMuWGIuUGFja2V0LmNyZWF0ZSB0aWQgcmlkIHR5
IGRhdGEpCisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgdHkg
ZGF0YQorCitsZXQgc2VuZF9yZXBseSBjb24gdGlkIHJpZCB0eSBkYXRhID0K
KwlsZXQgcmVzdWx0ID0gWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAocGFja2V0
X29mIGNvbiB0aWQgcmlkIHR5IGRhdGEpIGluCisJKCogc2hvdWxkIG5ldmVy
IGhhcHBlbjogd2Ugb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCB3aGVu
IHRoZXJlIGlzIHJvb20gZm9yIGFuIG91dHB1dCBwYWNrZXQgKikKKwkoKiBh
bmQgdGhlIGxpbWl0IGZvciByZXBsaWVzIGlzIGRpZmZlcmVudCBmcm9tIHRo
ZSBsaW1pdCBmb3Igd2F0Y2ggZXZlbnRzICopCisJYXNzZXJ0IChyZXN1bHQg
PD4gTm9uZSkKIAogbGV0IHNlbmRfZXJyb3IgY29uIHRpZCByaWQgZXJyID0g
c2VuZF9yZXBseSBjb24gdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgKGVy
ciBeICJcMDAwIikKIGxldCBzZW5kX2FjayBjb24gdGlkIHJpZCB0eSA9IHNl
bmRfcmVwbHkgY29uIHRpZCByaWQgdHkgIk9LXDAwMCIKQEAgLTE4MSwxMSAr
MzAxLDExIEBAIGxldCBkZWxfd2F0Y2ggY29uIHBhdGggdG9rZW4gPQogCWFw
YXRoLCB3CiAKIGxldCBkZWxfd2F0Y2hlcyBjb24gPQotICBIYXNodGJsLmNs
ZWFyIGNvbi53YXRjaGVzOworICBIYXNodGJsLnJlc2V0IGNvbi53YXRjaGVz
OwogICBjb24ubmJfd2F0Y2hlcyA8LSAwCiAKIGxldCBkZWxfdHJhbnNhY3Rp
b25zIGNvbiA9Ci0gIEhhc2h0YmwuY2xlYXIgY29uLnRyYW5zYWN0aW9ucwor
ICBIYXNodGJsLnJlc2V0IGNvbi50cmFuc2FjdGlvbnMKIAogbGV0IGxpc3Rf
d2F0Y2hlcyBjb24gPQogCWxldCBsbCA9IEhhc2h0YmwuZm9sZApAQCAtMjA4
LDIxICszMjgsMjkgQEAgbGV0IGxvb2t1cF93YXRjaF9wZXJtIHBhdGggPSBm
dW5jdGlvbgogbGV0IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3Qg
cGF0aCA9CiAJbG9va3VwX3dhdGNoX3Blcm0gcGF0aCBvbGRyb290IEAgbG9v
a3VwX3dhdGNoX3Blcm0gcGF0aCAoU29tZSByb290KQogCi1sZXQgZmlyZV9z
aW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdhdGNoID0KK2xldCBmaXJlX3Npbmds
ZV93YXRjaF91bmNoZWNrZWQgc291cmNlIHdhdGNoID0KIAlsZXQgZGF0YSA9
IFV0aWxzLmpvaW5fYnlfbnVsbCBbd2F0Y2gucGF0aDsgd2F0Y2gudG9rZW47
ICIiXSBpbgotCXNlbmRfcmVwbHkgd2F0Y2guY29uIFRyYW5zYWN0aW9uLm5v
bmUgMCBYZW5idXMuWGIuT3AuV2F0Y2hldmVudCBkYXRhCisJbGV0IHBrdCA9
IHBhY2tldF9vZiB3YXRjaC5jb24gVHJhbnNhY3Rpb24ubm9uZSAwIFhlbmJ1
cy5YYi5PcC5XYXRjaGV2ZW50IGRhdGEgaW4KKworCW1hdGNoIEJvdW5kZWRQ
aXBlLnB1c2ggc291cmNlLnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzICh3
YXRjaCwgcGt0KSB3aXRoCisJfCBTb21lICgpIC0+ICgpICgqIHBhY2tldCBx
dWV1ZWQgKikKKwl8IE5vbmUgLT4KKwkJCSgqIGEgd2VsbCBiZWhhdmVkIERv
bTAgc2hvdWxkbid0IGJlIGFibGUgdG8gdHJpZ2dlciB0aGlzLAorCQkJICAg
aWYgaXQgaGFwcGVucyBpdCBpcyBsaWtlbHkgYSBEb20wIGJ1ZyBjYXVzaW5n
IHJ1bmF3YXkgbWVtb3J5IHVzYWdlCisJCQkgKikKKwkJCWZhaWx3aXRoICJ3
YXRjaCBldmVudCBvdmVyZmxvdywgY2Fubm90IGhhcHBlbiIKIAotbGV0IGZp
cmVfc2luZ2xlX3dhdGNoIChvbGRyb290LCByb290KSB3YXRjaCA9CitsZXQg
ZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIChvbGRyb290LCByb290KSB3YXRj
aCA9CiAJbGV0IGFic3BhdGggPSBnZXRfd2F0Y2hfcGF0aCB3YXRjaC5jb24g
d2F0Y2gucGF0aCB8PiBTdG9yZS5QYXRoLm9mX3N0cmluZyBpbgogCWxldCBw
ZXJtcyA9IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3QgYWJzcGF0
aCBpbgogCWlmIFBlcm1zLmNhbl9maXJlX3dhdGNoIHdhdGNoLmNvbi5wZXJt
IHBlcm1zIHRoZW4KLQkJZmlyZV9zaW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdh
dGNoCisJCWZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCBzb3VyY2Ugd2F0
Y2gKIAllbHNlCiAJCWxldCBwZXJtcyA9IHBlcm1zIHw+IExpc3QubWFwIChQ
ZXJtcy5Ob2RlLnRvX3N0cmluZyB+c2VwOiIgIikgfD4gU3RyaW5nLmNvbmNh
dCAiLCAiIGluCiAJCWxldCBjb24gPSBnZXRfZG9tc3RyIHdhdGNoLmNvbiBp
bgogCQlMb2dnaW5nLndhdGNoX25vdF9maXJlZCB+Y29uIHBlcm1zIChTdG9y
ZS5QYXRoLnRvX3N0cmluZyBhYnNwYXRoKQogCi1sZXQgZmlyZV93YXRjaCBy
b290cyB3YXRjaCBwYXRoID0KK2xldCBmaXJlX3dhdGNoIHNvdXJjZSByb290
cyB3YXRjaCBwYXRoID0KIAlsZXQgbmV3X3BhdGggPQogCQlpZiB3YXRjaC5p
c19yZWxhdGl2ZSAmJiBwYXRoLlswXSA9ICcvJwogCQl0aGVuIGJlZ2luCkBA
IC0yMzIsNyArMzYwLDcgQEAgbGV0IGZpcmVfd2F0Y2ggcm9vdHMgd2F0Y2gg
cGF0aCA9CiAJCWVuZCBlbHNlCiAJCQlwYXRoCiAJaW4KLQlmaXJlX3Npbmds
ZV93YXRjaCByb290cyB7IHdhdGNoIHdpdGggcGF0aCA9IG5ld19wYXRoIH0K
KwlmaXJlX3NpbmdsZV93YXRjaCBzb3VyY2Ugcm9vdHMgeyB3YXRjaCB3aXRo
IHBhdGggPSBuZXdfcGF0aCB9CiAKICgqIFNlYXJjaCBmb3IgYSB2YWxpZCB1
bnVzZWQgdHJhbnNhY3Rpb24gaWQuICopCiBsZXQgcmVjIHZhbGlkX3RyYW5z
YWN0aW9uX2lkIGNvbiBwcm9wb3NlZF9pZCA9CkBAIC0yNzksNiArNDA3LDcg
QEAgbGV0IGdldF90cmFuc2FjdGlvbiBjb24gdGlkID0KIGxldCBkb19pbnB1
dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCiBsZXQgaGFzX21vcmVf
aW5wdXQgY29uID0gWGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54Ygog
CitsZXQgY2FuX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5jYW5faW5wdXQgY29u
LnhiICYmIEJvdW5kZWRQaXBlLmlzX2VtcHR5IGNvbi5wZW5kaW5nX3NvdXJj
ZV93YXRjaGV2ZW50cwogbGV0IGhhc19vdXRwdXQgY29uID0gWGVuYnVzLlhi
Lmhhc19vdXRwdXQgY29uLnhiCiBsZXQgaGFzX29sZF9vdXRwdXQgY29uID0g
WGVuYnVzLlhiLmhhc19vbGRfb3V0cHV0IGNvbi54YgogbGV0IGhhc19uZXdf
b3V0cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfbmV3X291dHB1dCBjb24ueGIK
QEAgLTI4Niw3ICs0MTUsNyBAQCBsZXQgcGVla19vdXRwdXQgY29uID0gWGVu
YnVzLlhiLnBlZWtfb3V0cHV0IGNvbi54YgogbGV0IGRvX291dHB1dCBjb24g
PSBYZW5idXMuWGIub3V0cHV0IGNvbi54YgogCiBsZXQgaGFzX21vcmVfd29y
ayBjb24gPQotCWhhc19tb3JlX2lucHV0IGNvbiB8fCBub3QgKGhhc19vbGRf
b3V0cHV0IGNvbikgJiYgaGFzX25ld19vdXRwdXQgY29uCisJKGhhc19tb3Jl
X2lucHV0IGNvbiAmJiBjYW5faW5wdXQgY29uKSB8fCBub3QgKGhhc19vbGRf
b3V0cHV0IGNvbikgJiYgaGFzX25ld19vdXRwdXQgY29uCiAKIGxldCBpbmNy
X29wcyBjb24gPSBjb24uc3RhdF9uYl9vcHMgPC0gY29uLnN0YXRfbmJfb3Bz
ICsgMQogCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbnMubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlv
bnMubWwKaW5kZXggN2VmZGYzZTVlMDVlLi4zOTE5MGMxOWVjNTggMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9ucy5tbAor
KysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbnMubWwKQEAg
LTIyLDIyICsyMiwzMCBAQCB0eXBlIHQgPSB7CiAJZG9tYWluczogKGludCwg
Q29ubmVjdGlvbi50KSBIYXNodGJsLnQ7CiAJcG9ydHM6IChYZW5ldmVudGNo
bi50LCBDb25uZWN0aW9uLnQpIEhhc2h0YmwudDsKIAltdXRhYmxlIHdhdGNo
ZXM6IChzdHJpbmcsIENvbm5lY3Rpb24ud2F0Y2ggbGlzdCkgVHJpZS50Owor
CW11dGFibGUgaGFzX3BlbmRpbmdfd2F0Y2hldmVudHM6IENvbm5lY3Rpb24u
V2F0Y2guU2V0LnQKIH0KIAogbGV0IGNyZWF0ZSAoKSA9IHsKIAlhbm9ueW1v
dXMgPSBIYXNodGJsLmNyZWF0ZSAzNzsKIAlkb21haW5zID0gSGFzaHRibC5j
cmVhdGUgMzc7CiAJcG9ydHMgPSBIYXNodGJsLmNyZWF0ZSAzNzsKLQl3YXRj
aGVzID0gVHJpZS5jcmVhdGUgKCkKKwl3YXRjaGVzID0gVHJpZS5jcmVhdGUg
KCk7CisJaGFzX3BlbmRpbmdfd2F0Y2hldmVudHMgPSBDb25uZWN0aW9uLldh
dGNoLlNldC5lbXB0eTsKIH0KIAorbGV0IGdldF9jYXBhY2l0eSAoKSA9CisJ
KCogbm90IG11bHRpcGxpZWQgYnkgbWF4d2F0Y2ggb24gcHVycG9zZTogMm5k
IHF1ZXVlIGluIHdhdGNoIGl0c2VsZiEgKikKKwl7IFhlbmJ1cy5YYi5tYXhv
dXRzdGFuZGluZyA9ICFEZWZpbmUubWF4b3V0c3RhbmRpbmc7IG1heHdhdGNo
ZXZlbnRzID0gIURlZmluZS5tYXh3YXRjaGV2ZW50cyB9CisKIGxldCBhZGRf
YW5vbnltb3VzIGNvbnMgZmQgX2Nhbl93cml0ZSA9Ci0JbGV0IHhiY29uID0g
WGVuYnVzLlhiLm9wZW5fZmQgZmQgaW4KKwlsZXQgY2FwYWNpdHkgPSBnZXRf
Y2FwYWNpdHkgKCkgaW4KKwlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9m
ZCBmZCB+Y2FwYWNpdHkgaW4KIAlsZXQgY29uID0gQ29ubmVjdGlvbi5jcmVh
dGUgeGJjb24gTm9uZSBpbgogCUhhc2h0YmwuYWRkIGNvbnMuYW5vbnltb3Vz
IChYZW5idXMuWGIuZ2V0X2ZkIHhiY29uKSBjb24KIAogbGV0IGFkZF9kb21h
aW4gY29ucyBkb20gPQotCWxldCB4YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX21t
YXAgKERvbWFpbi5nZXRfaW50ZXJmYWNlIGRvbSkgKGZ1biAoKSAtPiBEb21h
aW4ubm90aWZ5IGRvbSkgaW4KKwlsZXQgY2FwYWNpdHkgPSBnZXRfY2FwYWNp
dHkgKCkgaW4KKwlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9tbWFwIH5j
YXBhY2l0eSAoRG9tYWluLmdldF9pbnRlcmZhY2UgZG9tKSAoZnVuICgpIC0+
IERvbWFpbi5ub3RpZnkgZG9tKSBpbgogCWxldCBjb24gPSBDb25uZWN0aW9u
LmNyZWF0ZSB4YmNvbiAoU29tZSBkb20pIGluCiAJSGFzaHRibC5hZGQgY29u
cy5kb21haW5zIChEb21haW4uZ2V0X2lkIGRvbSkgY29uOwogCW1hdGNoIERv
bWFpbi5nZXRfcG9ydCBkb20gd2l0aApAQCAtNDgsNyArNTYsOSBAQCBsZXQg
c2VsZWN0ID8ob25seV9pZiA9IChmdW4gXyAtPiB0cnVlKSkgY29ucyA9CiAJ
SGFzaHRibC5mb2xkIChmdW4gXyBjb24gKGlucywgb3V0cykgLT4KIAkJaWYg
KG9ubHlfaWYgY29uKSB0aGVuICgKIAkJCWxldCBmZCA9IENvbm5lY3Rpb24u
Z2V0X2ZkIGNvbiBpbgotCQkJKGZkIDo6IGlucywgIGlmIENvbm5lY3Rpb24u
aGFzX291dHB1dCBjb24gdGhlbiBmZCA6OiBvdXRzIGVsc2Ugb3V0cykKKwkJ
CWxldCBpbl9mZHMgPSBpZiBDb25uZWN0aW9uLmNhbl9pbnB1dCBjb24gdGhl
biBmZCA6OiBpbnMgZWxzZSBpbnMgaW4KKwkJCWxldCBvdXRfZmRzID0gaWYg
Q29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0aGVuIGZkIDo6IG91dHMgZWxz
ZSBvdXRzIGluCisJCQlpbl9mZHMsIG91dF9mZHMKIAkJKSBlbHNlIChpbnMs
IG91dHMpCiAJKQogCWNvbnMuYW5vbnltb3VzIChbXSwgW10pCkBAIC02Nywx
MCArNzcsMTcgQEAgbGV0IGRlbF93YXRjaGVzX29mX2NvbiBjb24gd2F0Y2hl
cyA9CiAJfCBbXSAtPiBOb25lCiAJfCB3cyAtPiBTb21lIHdzCiAKK2xldCBk
ZWxfd2F0Y2hlcyBjb25zIGNvbiA9CisJQ29ubmVjdGlvbi5kZWxfd2F0Y2hl
cyBjb247CisJY29ucy53YXRjaGVzIDwtIFRyaWUubWFwIChkZWxfd2F0Y2hl
c19vZl9jb24gY29uKSBjb25zLndhdGNoZXM7CisJY29ucy5oYXNfcGVuZGlu
Z193YXRjaGV2ZW50cyA8LQorCQljb25zLmhhc19wZW5kaW5nX3dhdGNoZXZl
bnRzIHw+IENvbm5lY3Rpb24uV2F0Y2guU2V0LmZpbHRlciBAQCBmdW4gdyAt
PgorCQlDb25uZWN0aW9uLmdldF9jb24gdyAhPSBjb24KKwogbGV0IGRlbF9h
bm9ueW1vdXMgY29ucyBjb24gPQogCXRyeQogCQlIYXNodGJsLnJlbW92ZSBj
b25zLmFub255bW91cyAoQ29ubmVjdGlvbi5nZXRfZmQgY29uKTsKLQkJY29u
cy53YXRjaGVzIDwtIFRyaWUubWFwIChkZWxfd2F0Y2hlc19vZl9jb24gY29u
KSBjb25zLndhdGNoZXM7CisJCWRlbF93YXRjaGVzIGNvbnMgY29uOwogCQlD
b25uZWN0aW9uLmNsb3NlIGNvbgogCXdpdGggZXhuIC0+CiAJCWRlYnVnICJk
ZWwgYW5vbnltb3VzICVzIiAoUHJpbnRleGMudG9fc3RyaW5nIGV4bikKQEAg
LTg1LDcgKzEwMiw3IEBAIGxldCBkZWxfZG9tYWluIGNvbnMgaWQgPQogCQkg
ICAgfCBTb21lIHAgLT4gSGFzaHRibC5yZW1vdmUgY29ucy5wb3J0cyBwCiAJ
CSAgICB8IE5vbmUgLT4gKCkpCiAJCSB8IE5vbmUgLT4gKCkpOwotCQljb25z
LndhdGNoZXMgPC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24p
IGNvbnMud2F0Y2hlczsKKwkJZGVsX3dhdGNoZXMgY29ucyBjb247CiAJCUNv
bm5lY3Rpb24uY2xvc2UgY29uCiAJd2l0aCBleG4gLT4KIAkJZGVidWcgImRl
bCBkb21haW4gJXU6ICVzIiBpZCAoUHJpbnRleGMudG9fc3RyaW5nIGV4bikK
QEAgLTEzNiwzMSArMTUzLDMzIEBAIGxldCBkZWxfd2F0Y2ggY29ucyBjb24g
cGF0aCB0b2tlbiA9CiAJCWNvbnMud2F0Y2hlcyA8LSBUcmllLnNldCBjb25z
LndhdGNoZXMga2V5IHdhdGNoZXM7CiAgCXdhdGNoCiAKLWxldCBkZWxfd2F0
Y2hlcyBjb25zIGNvbiA9Ci0JQ29ubmVjdGlvbi5kZWxfd2F0Y2hlcyBjb247
Ci0JY29ucy53YXRjaGVzIDwtIFRyaWUubWFwIChkZWxfd2F0Y2hlc19vZl9j
b24gY29uKSBjb25zLndhdGNoZXMKLQogKCogcGF0aCBpcyBhYnNvbHV0ZSAq
KQotbGV0IGZpcmVfd2F0Y2hlcyA/b2xkcm9vdCByb290IGNvbnMgcGF0aCBy
ZWN1cnNlID0KK2xldCBmaXJlX3dhdGNoZXMgP29sZHJvb3Qgc291cmNlIHJv
b3QgY29ucyBwYXRoIHJlY3Vyc2UgPQogCWxldCBrZXkgPSBrZXlfb2ZfcGF0
aCBwYXRoIGluCiAJbGV0IHBhdGggPSBTdG9yZS5QYXRoLnRvX3N0cmluZyBw
YXRoIGluCiAJbGV0IHJvb3RzID0gb2xkcm9vdCwgcm9vdCBpbgogCWxldCBm
aXJlX3dhdGNoIF8gPSBmdW5jdGlvbgogCQl8IE5vbmUgICAgICAgICAtPiAo
KQotCQl8IFNvbWUgd2F0Y2hlcyAtPiBMaXN0Lml0ZXIgKGZ1biB3IC0+IENv
bm5lY3Rpb24uZmlyZV93YXRjaCByb290cyB3IHBhdGgpIHdhdGNoZXMKKwkJ
fCBTb21lIHdhdGNoZXMgLT4gTGlzdC5pdGVyIChmdW4gdyAtPiBDb25uZWN0
aW9uLmZpcmVfd2F0Y2ggc291cmNlIHJvb3RzIHcgcGF0aCkgd2F0Y2hlcwog
CWluCiAJbGV0IGZpcmVfcmVjIF94ID0gZnVuY3Rpb24KIAkJfCBOb25lICAg
ICAgICAgLT4gKCkKIAkJfCBTb21lIHdhdGNoZXMgLT4KLQkJCUxpc3QuaXRl
ciAoQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRjaCByb290cykgd2F0Y2hl
cworCQkJTGlzdC5pdGVyIChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNo
IHNvdXJjZSByb290cykgd2F0Y2hlcwogCWluCiAJVHJpZS5pdGVyX3BhdGgg
ZmlyZV93YXRjaCBjb25zLndhdGNoZXMga2V5OwogCWlmIHJlY3Vyc2UgdGhl
bgogCQlUcmllLml0ZXIgZmlyZV9yZWMgKFRyaWUuc3ViIGNvbnMud2F0Y2hl
cyBrZXkpCiAKK2xldCBzZW5kX3dhdGNoZXZlbnRzIGNvbnMgY29uID0KKwlj
b25zLmhhc19wZW5kaW5nX3dhdGNoZXZlbnRzIDwtCisJCWNvbnMuaGFzX3Bl
bmRpbmdfd2F0Y2hldmVudHMgfD4gQ29ubmVjdGlvbi5XYXRjaC5TZXQuZmls
dGVyIENvbm5lY3Rpb24uV2F0Y2guZmx1c2hfZXZlbnRzOworCUNvbm5lY3Rp
b24uc291cmNlX2ZsdXNoX3dhdGNoZXZlbnRzIGNvbgorCiBsZXQgZmlyZV9z
cGVjX3dhdGNoZXMgcm9vdCBjb25zIHNwZWNwYXRoID0KKwlsZXQgc291cmNl
ID0gZmluZF9kb21haW4gY29ucyAwIGluCiAJaXRlciBjb25zIChmdW4gY29u
IC0+Ci0JCUxpc3QuaXRlciAoQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRj
aCAoTm9uZSwgcm9vdCkpIChDb25uZWN0aW9uLmdldF93YXRjaGVzIGNvbiBz
cGVjcGF0aCkpCisJCUxpc3QuaXRlciAoQ29ubmVjdGlvbi5maXJlX3Npbmds
ZV93YXRjaCBzb3VyY2UgKE5vbmUsIHJvb3QpKSAoQ29ubmVjdGlvbi5nZXRf
d2F0Y2hlcyBjb24gc3BlY3BhdGgpKQogCiBsZXQgc2V0X3RhcmdldCBjb25z
IGRvbWFpbiB0YXJnZXRfZG9tYWluID0KIAlsZXQgY29uID0gZmluZF9kb21h
aW4gY29ucyBkb21haW4gaW4KQEAgLTE5NiwzICsyMTUsMTMgQEAgbGV0IGRl
YnVnIGNvbnMgPQogCWxldCBhbm9ueW1vdXMgPSBIYXNodGJsLmZvbGQgKGZ1
biBfIGNvbiBhY2N1IC0+IENvbm5lY3Rpb24uZGVidWcgY29uIDo6IGFjY3Up
IGNvbnMuYW5vbnltb3VzIFtdIGluCiAJbGV0IGRvbWFpbnMgPSBIYXNodGJs
LmZvbGQgKGZ1biBfIGNvbiBhY2N1IC0+IENvbm5lY3Rpb24uZGVidWcgY29u
IDo6IGFjY3UpIGNvbnMuZG9tYWlucyBbXSBpbgogCVN0cmluZy5jb25jYXQg
IiIgKGRvbWFpbnMgQCBhbm9ueW1vdXMpCisKK2xldCBkZWJ1Z193YXRjaGV2
ZW50cyBjb25zIGNvbiA9CisJKCogPT0gKHBoeXNpY2FsIGVxdWFsaXR5KQor
CSAgIGhhcyB0byBiZSB1c2VkIGhlcmUgYmVjYXVzZSB3LmNvbi54Yi5iYWNr
ZW5kIG1pZ2h0IGNvbnRhaW4gYSBbdW5pdC0+dW5pdF0gdmFsdWUgY2F1c2lu
ZyByZWd1bGFyCisJICAgY29tcGFyaXNvbiB0byBmYWlsIGR1ZSB0byBoYXZp
bmcgYSAnZnVuY3Rpb25hbCB2YWx1ZScgd2hpY2ggY2Fubm90IGJlIGNvbXBh
cmVkLgorCSAqKQorCWxldCBzID0gY29ucy5oYXNfcGVuZGluZ193YXRjaGV2
ZW50cyB8PiBDb25uZWN0aW9uLldhdGNoLlNldC5maWx0ZXIgKGZ1biB3IC0+
IHcuY29uID09IGNvbikgaW4KKwlsZXQgcGVuZGluZyA9IHMgfD4gQ29ubmVj
dGlvbi5XYXRjaC5TZXQuZWxlbWVudHMKKwkJfD4gTGlzdC5tYXAgKGZ1biB3
IC0+IENvbm5lY3Rpb24uV2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyB3KSB8
PiBMaXN0LmZvbGRfbGVmdCAoKykgMCBpbgorCVByaW50Zi5zcHJpbnRmICJX
YXRjaGVzIHdpdGggcGVuZGluZyBldmVudHM6ICVkLCBwZW5kaW5nIGV2ZW50
cyB0b3RhbDogJWQiIChDb25uZWN0aW9uLldhdGNoLlNldC5jYXJkaW5hbCBz
KSBwZW5kaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
ZGVmaW5lLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbApp
bmRleCAxYTVkMmYzNGE2NzguLjllNTIzNjcwOTQ3NCAxMDA2NDQKLS0tIGEv
dG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQvZGVmaW5lLm1sCkBAIC0yNSw2ICsyNSwxMyBAQCBs
ZXQgZGVmYXVsdF9jb25maWdfZGlyID0gUGF0aHMueGVuX2NvbmZpZ19kaXIK
IGxldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQogbGV0IG1heHRyYW5zYWN0aW9u
ID0gcmVmICgxMCkKIGxldCBtYXhyZXF1ZXN0cyA9IHJlZiAoMTAyNCkgICAo
KiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAqKQorbGV0IG1h
eG91dHN0YW5kaW5nID0gcmVmICgxMDI0KSAoKiBtYXhpbXVtIG91dHN0YW5k
aW5nIHJlcXVlc3RzLCBpLmUuIGluLWZsaWdodCByZXF1ZXN0cyAvIGRvbWFp
biAqKQorbGV0IG1heHdhdGNoZXZlbnRzID0gcmVmICgxMDI0KQorKCoKKwlt
YXhpbXVtIG91dHN0YW5kaW5nIHdhdGNoIGV2ZW50cyBwZXIgd2F0Y2gsCisJ
cmVjb21tZW5kZWQgPj0gbWF4b3V0c3RhbmRpbmcgdG8gYXZvaWQgYmxvY2tp
bmcgYmFja2VuZCB0cmFuc2FjdGlvbnMgZHVlIHRvCisJbWFsaWNpb3VzIGZy
b250ZW5kcworICopCiAKIGxldCBnY19tYXhfb3ZlcmhlYWQgPSByZWYgMTIw
ICgqIDEyMCUgc2VlIGNvbW1lbnQgaW4geGVuc3RvcmVkLm1sICopCiBsZXQg
Y29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmluIGIvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL294ZW5zdG9yZWQuY29uZi5pbgppbmRleCA0
YWU0OGU0MmQ0N2QuLjlkMDM0ZTc0NGI0YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL294ZW5zdG9yZWQuY29uZi5pbgorKysgYi90b29s
cy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmluCkBAIC02Miw2
ICs2Miw4IEBAIHF1b3RhLW1heHdhdGNoID0gMTAwCiBxdW90YS10cmFuc2Fj
dGlvbiA9IDEwCiBxdW90YS1tYXhyZXF1ZXN0cyA9IDEwMjQKIHF1b3RhLXBh
dGgtbWF4ID0gMTAyNAorcXVvdGEtbWF4b3V0c3RhbmRpbmcgPSAxMDI0Citx
dW90YS1tYXh3YXRjaGV2ZW50cyA9IDEwMjQKIAogIyBBY3RpdmF0ZSBmaWxl
ZCBiYXNlIGJhY2tlbmQKIHBlcnNpc3RlbnQgPSBmYWxzZQpkaWZmIC0tZ2l0
IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Byb2Nlc3MubWwgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbAppbmRleCBhNzI4MTBkMDZmNDMu
LjA4MmM5M2ZhOWQzZiAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL3Byb2Nlc3MubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3By
b2Nlc3MubWwKQEAgLTU2LDcgKzU2LDcgQEAgbGV0IHNwbGl0X29uZV9wYXRo
IGRhdGEgY29uID0KIAl8IHBhdGggOjogIiIgOjogW10gLT4gU3RvcmUuUGF0
aC5jcmVhdGUgcGF0aCAoQ29ubmVjdGlvbi5nZXRfcGF0aCBjb24pCiAJfCBf
ICAgICAgICAgICAgICAgIC0+IHJhaXNlIEludmFsaWRfQ21kX0FyZ3MKIAot
bGV0IHByb2Nlc3Nfd2F0Y2ggdCBjb25zID0KK2xldCBwcm9jZXNzX3dhdGNo
IHNvdXJjZSB0IGNvbnMgPQogCWxldCBvbGRyb290ID0gdC5UcmFuc2FjdGlv
bi5vbGRyb290IGluCiAJbGV0IG5ld3Jvb3QgPSBTdG9yZS5nZXRfcm9vdCB0
LnN0b3JlIGluCiAJbGV0IG9wcyA9IFRyYW5zYWN0aW9uLmdldF9wYXRocyB0
IHw+IExpc3QucmV2IGluCkBAIC02Niw4ICs2Niw5IEBAIGxldCBwcm9jZXNz
X3dhdGNoIHQgY29ucyA9CiAJCXwgWGVuYnVzLlhiLk9wLlJtICAgICAgIC0+
IHRydWUsIE5vbmUsIG9sZHJvb3QKIAkJfCBYZW5idXMuWGIuT3AuU2V0cGVy
bXMgLT4gZmFsc2UsIFNvbWUgb2xkcm9vdCwgbmV3cm9vdAogCQl8IF8gICAg
ICAgICAgICAgIC0+IHJhaXNlIChGYWlsdXJlICJodWggPyIpIGluCi0JCUNv
bm5lY3Rpb25zLmZpcmVfd2F0Y2hlcyA/b2xkcm9vdCByb290IGNvbnMgKHNu
ZCBvcCkgcmVjdXJzZSBpbgotCUxpc3QuaXRlciAoZnVuIG9wIC0+IGRvX29w
X3dhdGNoIG9wIGNvbnMpIG9wcworCQlDb25uZWN0aW9ucy5maXJlX3dhdGNo
ZXMgP29sZHJvb3Qgc291cmNlIHJvb3QgY29ucyAoc25kIG9wKSByZWN1cnNl
IGluCisJTGlzdC5pdGVyIChmdW4gb3AgLT4gZG9fb3Bfd2F0Y2ggb3AgY29u
cykgb3BzOworCUNvbm5lY3Rpb25zLnNlbmRfd2F0Y2hldmVudHMgY29ucyBz
b3VyY2UKIAogbGV0IGNyZWF0ZV9pbXBsaWNpdF9wYXRoIHQgcGVybSBwYXRo
ID0KIAlsZXQgZGlybmFtZSA9IFN0b3JlLlBhdGguZ2V0X3BhcmVudCBwYXRo
IGluCkBAIC05OSw2ICsxMDAsMjAgQEAgbGV0IGRvX2RlYnVnIGNvbiB0IF9k
b21haW5zIGNvbnMgZGF0YSA9CiAJfCAid2F0Y2hlcyIgOjogXyAtPgogCQls
ZXQgd2F0Y2hlcyA9IENvbm5lY3Rpb25zLmRlYnVnIGNvbnMgaW4KIAkJU29t
ZSAod2F0Y2hlcyBeICJcMDAwIikKKwl8ICJ4ZW5idXMiIDo6IGRvbWlkIDo6
IF8gLT4KKwkJbGV0IGRvbWlkID0gaW50X29mX3N0cmluZyBkb21pZCBpbgor
CQlsZXQgY29uID0gQ29ubmVjdGlvbnMuZmluZF9kb21haW4gY29ucyBkb21p
ZCBpbgorCQlsZXQgcyA9IFByaW50Zi5zcHJpbnRmICJ4ZW5idXM6ICVzOyBv
dmVyZmxvdyBxdWV1ZSBsZW5ndGg6ICVkLCBjYW5faW5wdXQ6ICViLCBoYXNf
bW9yZV9pbnB1dDogJWIsIGhhc19vbGRfb3V0cHV0OiAlYiwgaGFzX25ld19v
dXRwdXQ6ICViLCBoYXNfbW9yZV93b3JrOiAlYi4gcGVuZGluZzogJXMiCisJ
CQkoWGVuYnVzLlhiLmRlYnVnIGNvbi54YikKKwkJCShDb25uZWN0aW9uLnNv
dXJjZV9wZW5kaW5nX3dhdGNoZXZlbnRzIGNvbikKKwkJCShDb25uZWN0aW9u
LmNhbl9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfbW9yZV9pbnB1
dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfb2xkX291dHB1dCBjb24pCisJ
CQkoQ29ubmVjdGlvbi5oYXNfbmV3X291dHB1dCBjb24pCisJCQkoQ29ubmVj
dGlvbi5oYXNfbW9yZV93b3JrIGNvbikKKwkJCShDb25uZWN0aW9ucy5kZWJ1
Z193YXRjaGV2ZW50cyBjb25zIGNvbikKKwkJaW4KKwkJU29tZSBzCiAJfCAi
bWZuIiA6OiBkb21pZCA6OiBfIC0+CiAJCWxldCBkb21pZCA9IGludF9vZl9z
dHJpbmcgZG9taWQgaW4KIAkJbGV0IGNvbiA9IENvbm5lY3Rpb25zLmZpbmRf
ZG9tYWluIGNvbnMgZG9taWQgaW4KQEAgLTIwNyw3ICsyMjIsNyBAQCBsZXQg
cmVwbHlfYWNrIGZjdCBjb24gdCBkb21zIGNvbnMgZGF0YSA9CiAJZmN0IGNv
biB0IGRvbXMgY29ucyBkYXRhOwogCVBhY2tldC5BY2sgKGZ1biAoKSAtPgog
CQlpZiBUcmFuc2FjdGlvbi5nZXRfaWQgdCA9IFRyYW5zYWN0aW9uLm5vbmUg
dGhlbgotCQkJcHJvY2Vzc193YXRjaCB0IGNvbnMKKwkJCXByb2Nlc3Nfd2F0
Y2ggY29uIHQgY29ucwogCSkKIAogbGV0IHJlcGx5X2RhdGEgZmN0IGNvbiB0
IGRvbXMgY29ucyBkYXRhID0KQEAgLTM2Niw3ICszODEsNyBAQCBsZXQgZG9f
d2F0Y2ggY29uIHQgX2RvbWFpbnMgY29ucyBkYXRhID0KIAlQYWNrZXQuQWNr
IChmdW4gKCkgLT4KIAkJKCogeGVuc3RvcmUudHh0IHNheXMgdGhpcyB3YXRj
aCBpcyBmaXJlZCBpbW1lZGlhdGVseSwKIAkJICAgaW1wbHlpbmcgZXZlbiBp
ZiBwYXRoIGRvZXNuJ3QgZXhpc3Qgb3IgaXMgdW5yZWFkYWJsZSAqKQotCQlD
b25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCB3YXRjaCkK
KwkJQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRjaF91bmNoZWNrZWQgY29u
IHdhdGNoKQogCiBsZXQgZG9fdW53YXRjaCBjb24gX3QgX2RvbWFpbnMgY29u
cyBkYXRhID0KIAlsZXQgKG5vZGUsIHRva2VuKSA9CkBAIC0zOTcsNyArNDEy
LDcgQEAgbGV0IGRvX3RyYW5zYWN0aW9uX2VuZCBjb24gdCBkb21haW5zIGNv
bnMgZGF0YSA9CiAJaWYgbm90IHN1Y2Nlc3MgdGhlbgogCQlyYWlzZSBUcmFu
c2FjdGlvbl9hZ2FpbjsKIAlpZiBjb21taXQgdGhlbiBiZWdpbgotCQlwcm9j
ZXNzX3dhdGNoIHQgY29uczsKKwkJcHJvY2Vzc193YXRjaCBjb24gdCBjb25z
OwogCQltYXRjaCB0LlRyYW5zYWN0aW9uLnR5IHdpdGgKIAkJfCBUcmFuc2Fj
dGlvbi5ObyAtPgogCQkJKCkgKCogbm8gbmVlZCB0byByZWNvcmQgYW55dGhp
bmcgKikKQEAgLTU2NCw3ICs1NzksOCBAQCBsZXQgcHJvY2Vzc19wYWNrZXQg
fnN0b3JlIH5jb25zIH5kb21zIH5jb24gfnJlcSA9CiBsZXQgZG9faW5wdXQg
c3RvcmUgY29ucyBkb21zIGNvbiA9CiAJbGV0IG5ld3BhY2tldCA9CiAJCXRy
eQotCQkJQ29ubmVjdGlvbi5kb19pbnB1dCBjb24KKwkJCWlmIENvbm5lY3Rp
b24uY2FuX2lucHV0IGNvbiB0aGVuIENvbm5lY3Rpb24uZG9faW5wdXQgY29u
CisJCQllbHNlIE5vbmUKIAkJd2l0aCBYZW5idXMuWGIuUmVjb25uZWN0IC0+
CiAJCQlpbmZvICIlcyByZXF1ZXN0cyBhIHJlY29ubmVjdCIgKENvbm5lY3Rp
b24uZ2V0X2RvbXN0ciBjb24pOwogCQkJSGlzdG9yeS5yZWNvbm5lY3QgY29u
OwpAQCAtNTkyLDYgKzYwOCw3IEBAIGxldCBkb19pbnB1dCBzdG9yZSBjb25z
IGRvbXMgY29uID0KIAkJQ29ubmVjdGlvbi5pbmNyX29wcyBjb24KIAogbGV0
IGRvX291dHB1dCBfc3RvcmUgX2NvbnMgX2RvbXMgY29uID0KKwlDb25uZWN0
aW9uLnNvdXJjZV9mbHVzaF93YXRjaGV2ZW50cyBjb247CiAJaWYgQ29ubmVj
dGlvbi5oYXNfb3V0cHV0IGNvbiB0aGVuICgKIAkJaWYgQ29ubmVjdGlvbi5o
YXNfbmV3X291dHB1dCBjb24gdGhlbiAoCiAJCQlsZXQgcGFja2V0ID0gQ29u
bmVjdGlvbi5wZWVrX291dHB1dCBjb24gaW4KZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL3hlbnN0b3JlZC94ZW5zdG9yZWQubWwgYi90b29scy9vY2FtbC94
ZW5zdG9yZWQveGVuc3RvcmVkLm1sCmluZGV4IDBiNjM0M2RmYzc4OS4uNGY4
ZmFiMmRkMTNhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
eGVuc3RvcmVkLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC94ZW5z
dG9yZWQubWwKQEAgLTEwMiw2ICsxMDIsOCBAQCBsZXQgcGFyc2VfY29uZmln
IGZpbGVuYW1lID0KIAkJKCJxdW90YS1tYXhlbnRpdHkiLCBDb25maWcuU2V0
X2ludCBRdW90YS5tYXhlbnQpOwogCQkoInF1b3RhLW1heHNpemUiLCBDb25m
aWcuU2V0X2ludCBRdW90YS5tYXhzaXplKTsKIAkJKCJxdW90YS1tYXhyZXF1
ZXN0cyIsIENvbmZpZy5TZXRfaW50IERlZmluZS5tYXhyZXF1ZXN0cyk7CisJ
CSgicXVvdGEtbWF4b3V0c3RhbmRpbmciLCBDb25maWcuU2V0X2ludCBEZWZp
bmUubWF4b3V0c3RhbmRpbmcpOworCQkoInF1b3RhLW1heHdhdGNoZXZlbnRz
IiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHdhdGNoZXZlbnRzKTsKIAkJ
KCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50IERlZmluZS5wYXRo
X21heCk7CiAJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29uZmlnLlNldF9pbnQg
RGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVzdC1lYWdhaW4iLCBD
b25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9lYWdhaW4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-oxenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-oxenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSA2NmVjMzAzZTY1YjE2ZTI4YTUzYWYwOTdmNWI3Mjk1NDU4ZWE4YjQ5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFRodSwgMjkgU2VwIDIwMjIgMTM6
MDc6MzUgKzAyMDAKU3ViamVjdDogU1VQUE9SVC5tZDogY2xhcmlmeSBzdXBw
b3J0IG9mIHVudHJ1c3RlZCBkcml2ZXIgZG9tYWlucyB3aXRoCiBveGVuc3Rv
cmVkCgpBZGQgYSBzdXBwb3J0IHN0YXRlbWVudCBmb3IgdGhlIHNjb3BlIG9m
IHN1cHBvcnQgcmVnYXJkaW5nIGRpZmZlcmVudApYZW5zdG9yZSB2YXJpYW50
cy4gRXNwZWNpYWxseSBveGVuc3RvcmVkIGRvZXMgbm90ICh5ZXQpIGhhdmUg
c2VjdXJpdHkKc3VwcG9ydCBvZiB1bnRydXN0ZWQgZHJpdmVyIGRvbWFpbnMs
IGFzIHRob3NlIG1pZ2h0IGRyaXZlIG94ZW5zdG9yZWQKb3V0IG9mIG1lbW9y
eSBieSBjcmVhdGluZyBsb3RzIG9mIHdhdGNoIGV2ZW50cyBmb3IgdGhlIGd1
ZXN0cyB0aGV5IGFyZQpzZXJ2aWNpbmcuCgpBZGQgYSBzdGF0ZW1lbnQgcmVn
YXJkaW5nIExpdmUgVXBkYXRlIHN1cHBvcnQgb2Ygb3hlbnN0b3JlZC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBD
aHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+
CgpkaWZmIC0tZ2l0IGEvU1VQUE9SVC5tZCBiL1NVUFBPUlQubWQKaW5kZXgg
YzQ1MzkwYTI0NWMwLi5kZDk3MDJiZmU0MmYgMTAwNjQ0Ci0tLSBhL1NVUFBP
UlQubWQKKysrIGIvU1VQUE9SVC5tZApAQCAtMTc1LDYgKzE3NSwxNyBAQCBT
dXBwb3J0IGZvciBydW5uaW5nIHFlbXUteGVuIGRldmljZSBtb2RlbCBpbiBh
IGxpbnV4IHN0dWJkb21haW4uCiAKICAgICBTdGF0dXM6IFRlY2ggUHJldmll
dwogCisjIyBYZW5zdG9yZQorCisjIyMgQyB4ZW5zdG9yZWQgZGFlbW9uCisK
KyAgICBTdGF0dXM6IFN1cHBvcnRlZAorCisjIyMgT0NhbWwgeGVuc3RvcmVk
IGRhZW1vbgorCisgICAgU3RhdHVzOiBTdXBwb3J0ZWQKKyAgICBTdGF0dXMs
IHVudHJ1c3RlZCBkcml2ZXIgZG9tYWluczogU3VwcG9ydGVkLCBub3Qgc2Vj
dXJpdHkgc3VwcG9ydGVkCisKICMjIFRvb2xzdGFjay8zcmQgcGFydHkKIAog
IyMjIGxpYnZpcnQgZHJpdmVyIGZvciB4bAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSBiZTI5YjM5MzRmZDVhNGQyYmNlNTU3MzFmMjRlNzQ0MTVlYmM0YjEz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNwbGl0IHVw
IHNlbmRfcmVwbHkoKQoKVG9kYXkgc2VuZF9yZXBseSgpIGlzIHVzZWQgZm9y
IGJvdGgsIG5vcm1hbCByZXF1ZXN0IHJlcGxpZXMgYW5kIHdhdGNoCmV2ZW50
cy4KClNwbGl0IGl0IHVwIGludG8gc2VuZF9yZXBseSgpIGFuZCBzZW5kX2V2
ZW50KCkuIFRoaXMgd2lsbCBiZSB1c2VkIHRvCmFkZCBzb21lIGV2ZW50IHNw
ZWNpZmljIGhhbmRsaW5nLgoKYWRkX2V2ZW50KCkgY2FuIGJlIG1lcmdlZCBp
bnRvIHNlbmRfZXZlbnQoKSwgcmVtb3ZpbmcgdGhlIG5lZWQgZm9yIGFuCmlu
dGVybWVkaWF0ZSBtZW1vcnkgYWxsb2NhdGlvbi4KClRoaXMgaXMgcGFydCBv
ZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdy
YWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9j
b3JlLmMKaW5kZXggOGU5MWI1NTQ5ODRkLi5lNjc3NmJhZThmOTkgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNjc0LDQ5ICs2
NzQsMzIgQEAgc3RhdGljIHZvaWQgc2VuZF9lcnJvcihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgaW50IGVycm9yKQogdm9pZCBzZW5kX3JlcGx5KHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlw
ZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbikKIHsK
LQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7CisJc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmJkYXRhID0gY29ubi0+aW47CisKKwlhc3NlcnQodHlwZSAh
PSBYU19XQVRDSF9FVkVOVCk7CiAKIAlpZiAoIGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYICkgewogCQlzZW5kX2Vycm9yKGNvbm4sIEUyQklHKTsKIAkJ
cmV0dXJuOwogCX0KIAotCS8qIFJlcGxpZXMgcmV1c2UgdGhlIHJlcXVlc3Qg
YnVmZmVyLCBldmVudHMgbmVlZCBhIG5ldyBvbmUuICovCi0JaWYgKHR5cGUg
IT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJYmRhdGEgPSBjb25uLT5pbjsKLQkJ
LyogRHJvcCBhc3luY2hyb25vdXMgcmVzcG9uc2VzLCBlLmcuIGVycm9ycyBm
b3Igd2F0Y2ggZXZlbnRzLiAqLwotCQlpZiAoIWJkYXRhKQotCQkJcmV0dXJu
OwotCQliZGF0YS0+aW5oZHIgPSB0cnVlOwotCQliZGF0YS0+dXNlZCA9IDA7
Ci0JCWNvbm4tPmluID0gTlVMTDsKLQl9IGVsc2UgewotCQkvKiBNZXNzYWdl
IGlzIGEgY2hpbGQgb2YgdGhlIGNvbm5lY3Rpb24gZm9yIGF1dG8tY2xlYW51
cC4gKi8KLQkJYmRhdGEgPSBuZXdfYnVmZmVyKGNvbm4pOworCWlmICghYmRh
dGEpCisJCXJldHVybjsKKwliZGF0YS0+aW5oZHIgPSB0cnVlOworCWJkYXRh
LT51c2VkID0gMDsKIAotCQkvKgotCQkgKiBBbGxvY2F0aW9uIGZhaWx1cmUg
aGVyZSBpcyB1bmZvcnR1bmF0ZTogd2UgaGF2ZSBubyB3YXkgdG8KLQkJICog
dGVsbCBhbnlib2R5IGFib3V0IGl0LgotCQkgKi8KLQkJaWYgKCFiZGF0YSkK
LQkJCXJldHVybjsKLQl9CiAJaWYgKGxlbiA8PSBERUZBVUxUX0JVRkZFUl9T
SVpFKQogCQliZGF0YS0+YnVmZmVyID0gYmRhdGEtPmRlZmF1bHRfYnVmZmVy
OwotCWVsc2UKKwllbHNlIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IHRhbGxvY19h
cnJheShiZGF0YSwgY2hhciwgbGVuKTsKLQlpZiAoIWJkYXRhLT5idWZmZXIp
IHsKLQkJaWYgKHR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJCS8qIFNh
bWUgYXMgYWJvdmU6IG5vIHdheSB0byB0ZWxsIHNvbWVvbmUuICovCi0JCQl0
YWxsb2NfZnJlZShiZGF0YSk7CisJCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQkJc2VuZF9lcnJvcihjb25uLCBFTk9NRU0pOwogCQkJcmV0dXJuOwogCQl9
Ci0JCS8qIHJlLWVzdGFibGlzaCByZXF1ZXN0IGJ1ZmZlciBmb3Igc2VuZGlu
ZyBFTk9NRU0uICovCi0JCWNvbm4tPmluID0gYmRhdGE7Ci0JCXNlbmRfZXJy
b3IoY29ubiwgRU5PTUVNKTsKLQkJcmV0dXJuOwogCX0KIAorCWNvbm4tPmlu
ID0gTlVMTDsKKwogCS8qIFVwZGF0ZSByZWxldmFudCBoZWFkZXIgZmllbGRz
IGFuZCBmaWxsIGluIHRoZSBtZXNzYWdlIGJvZHkuICovCiAJYmRhdGEtPmhk
ci5tc2cudHlwZSA9IHR5cGU7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVu
OwpAQCAtNzI0LDggKzcwNywzOSBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBl
LAogCiAJLyogUXVldWUgZm9yIGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAls
aXN0X2FkZF90YWlsKCZiZGF0YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsK
K30KIAotCXJldHVybjsKKy8qCisgKiBTZW5kIGEgd2F0Y2ggZXZlbnQuCisg
KiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSByZWxhdGVkIHRvIHRoZSBjdXJy
ZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBiZQorICogcmVwb3J0ZWQuCisg
Ki8KK3ZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pCit7CisJc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhOworCXVuc2lnbmVkIGludCBsZW47
CisKKwlsZW4gPSBzdHJsZW4ocGF0aCkgKyAxICsgc3RybGVuKHRva2VuKSAr
IDE7CisJLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4g
Ki8KKwlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCisJCXJldHVy
bjsKKworCWJkYXRhID0gbmV3X2J1ZmZlcihjb25uKTsKKwlpZiAoIWJkYXRh
KQorCQlyZXR1cm47CisKKwliZGF0YS0+YnVmZmVyID0gdGFsbG9jX2FycmF5
KGJkYXRhLCBjaGFyLCBsZW4pOworCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQl0YWxsb2NfZnJlZShiZGF0YSk7CisJCXJldHVybjsKKwl9CisJc3RyY3B5
KGJkYXRhLT5idWZmZXIsIHBhdGgpOworCXN0cmNweShiZGF0YS0+YnVmZmVy
ICsgc3RybGVuKHBhdGgpICsgMSwgdG9rZW4pOworCWJkYXRhLT5oZHIubXNn
LnR5cGUgPSBYU19XQVRDSF9FVkVOVDsKKwliZGF0YS0+aGRyLm1zZy5sZW4g
PSBsZW47CisKKwkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAq
LworCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xp
c3QpOwogfQogCiAvKiBTb21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0
YykganVzdCBuZWVkIGEgbm9uLWVycm9yIHJldHVybiAqLwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggOTM2OWM0Y2JmZDI2Li4y
YjBmNzk2ZDliYjEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaApAQCAtMTUwLDYgKzE1MCw3IEBAIHVuc2lnbmVkIGludCBnZXRfc3Ry
aW5ncyhzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqZGF0YSwKIAogdm9pZCBzZW5k
X3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2Nr
bXNnX3R5cGUgdHlwZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQg
aW50IGxlbik7Cit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsK
IAogLyogU29tZSByb3V0aW5lcyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3Qg
bmVlZCBhIG5vbi1lcnJvciByZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0
eXBlKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5k
ZXggOWZmMjA2OTBjMDAwLi42ZDgwOTczNzZlNDcgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCkBAIC03MiwzNyArNzIsMTcgQEAg
c3RhdGljIGJvb2wgaXNfY2hpbGQoY29uc3QgY2hhciAqY2hpbGQsIGNvbnN0
IGNoYXIgKnBhcmVudCkKIAlyZXR1cm4gY2hpbGRbbGVuXSA9PSAnLycgfHwg
Y2hpbGRbbGVuXSA9PSAnXDAnOwogfQogCi0vKgotICogU2VuZCBhIHdhdGNo
IGV2ZW50LgotICogVGVtcG9yYXJ5IG1lbW9yeSBhbGxvY2F0aW9ucyBhcmUg
ZG9uZSB3aXRoIGN0eC4KLSAqLwotc3RhdGljIHZvaWQgYWRkX2V2ZW50KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLAotCQkgICAgICBjb25zdCB2b2lkICpj
dHgsCi0JCSAgICAgIHN0cnVjdCB3YXRjaCAqd2F0Y2gsCi0JCSAgICAgIGNv
bnN0IGNoYXIgKm5hbWUpCitzdGF0aWMgY29uc3QgY2hhciAqZ2V0X3dhdGNo
X3BhdGgoY29uc3Qgc3RydWN0IHdhdGNoICp3YXRjaCwgY29uc3QgY2hhciAq
bmFtZSkKIHsKLQkvKiBEYXRhIHRvIHNlbmQgKG5vZGVcMHRva2VuXDApLiAq
LwotCXVuc2lnbmVkIGludCBsZW47Ci0JY2hhciAqZGF0YTsKKwljb25zdCBj
aGFyICpwYXRoID0gbmFtZTsKIAogCWlmICh3YXRjaC0+cmVsYXRpdmVfcGF0
aCkgewotCQluYW1lICs9IHN0cmxlbih3YXRjaC0+cmVsYXRpdmVfcGF0aCk7
Ci0JCWlmICgqbmFtZSA9PSAnLycpIC8qIENvdWxkIGJlICIiICovCi0JCQlu
YW1lKys7CisJCXBhdGggKz0gc3RybGVuKHdhdGNoLT5yZWxhdGl2ZV9wYXRo
KTsKKwkJaWYgKCpwYXRoID09ICcvJykgLyogQ291bGQgYmUgIiIgKi8KKwkJ
CXBhdGgrKzsKIAl9CiAKLQlsZW4gPSBzdHJsZW4obmFtZSkgKyAxICsgc3Ry
bGVuKHdhdGNoLT50b2tlbikgKyAxOwotCS8qIERvbid0IHRyeSB0byBzZW5k
IG92ZXItbG9uZyBldmVudHMuICovCi0JaWYgKGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYKQotCQlyZXR1cm47Ci0KLQlkYXRhID0gdGFsbG9jX2FycmF5
KGN0eCwgY2hhciwgbGVuKTsKLQlpZiAoIWRhdGEpCi0JCXJldHVybjsKLQlz
dHJjcHkoZGF0YSwgbmFtZSk7Ci0Jc3RyY3B5KGRhdGEgKyBzdHJsZW4obmFt
ZSkgKyAxLCB3YXRjaC0+dG9rZW4pOwotCXNlbmRfcmVwbHkoY29ubiwgWFNf
V0FUQ0hfRVZFTlQsIGRhdGEsIGxlbik7Ci0JdGFsbG9jX2ZyZWUoZGF0YSk7
CisJcmV0dXJuIHBhdGg7CiB9CiAKIC8qCkBAIC0xODEsMTAgKzE2MSwxNCBA
QCB2b2lkIGZpcmVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3Qgdm9pZCAqY3R4LCBjb25zdCBjaGFyICpuYW1lLAogCQlsaXN0X2Zv
cl9lYWNoX2VudHJ5KHdhdGNoLCAmaS0+d2F0Y2hlcywgbGlzdCkgewogCQkJ
aWYgKGV4YWN0KSB7CiAJCQkJaWYgKHN0cmVxKG5hbWUsIHdhdGNoLT5ub2Rl
KSkKLQkJCQkJYWRkX2V2ZW50KGksIGN0eCwgd2F0Y2gsIG5hbWUpOworCQkJ
CQlzZW5kX2V2ZW50KGksCisJCQkJCQkgICBnZXRfd2F0Y2hfcGF0aCh3YXRj
aCwgbmFtZSksCisJCQkJCQkgICB3YXRjaC0+dG9rZW4pOwogCQkJfSBlbHNl
IHsKIAkJCQlpZiAoaXNfY2hpbGQobmFtZSwgd2F0Y2gtPm5vZGUpKQotCQkJ
CQlhZGRfZXZlbnQoaSwgY3R4LCB3YXRjaCwgbmFtZSk7CisJCQkJCXNlbmRf
ZXZlbnQoaSwKKwkJCQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1l
KSwKKwkJCQkJCSAgIHdhdGNoLT50b2tlbik7CiAJCQl9CiAJCX0KIAl9CkBA
IC0yNTIsNyArMjM2LDcgQEAgaW50IGRvX3dhdGNoKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJc2VuZF9h
Y2soY29ubiwgWFNfV0FUQ0gpOwogCiAJLyogV2UgZmlyZSBvbmNlIHVwIGZy
b250OiBzaW1wbGlmaWVzIGNsaWVudHMgYW5kIHJlc3RhcnQuICovCi0JYWRk
X2V2ZW50KGNvbm4sIGluLCB3YXRjaCwgd2F0Y2gtPm5vZGUpOworCXNlbmRf
ZXZlbnQoY29ubiwgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2Rl
KSwgd2F0Y2gtPnRva2VuKTsKIAogCXJldHVybiAwOwogfQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSBiM2RmODk3ZjZiYWIxNTc0ZDIyYWYxMGU3NmM1MzE4YzJlODM1ZGFl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBoZWxw
ZXJzIHRvIGZyZWUgc3RydWN0IGJ1ZmZlcmVkX2RhdGEKCkFkZCB0d28gaGVs
cGVycyBmb3IgZnJlZWluZyBzdHJ1Y3QgYnVmZmVyZWRfZGF0YTogZnJlZV9i
dWZmZXJlZF9kYXRhKCkKZm9yIGZyZWVpbmcgb25lIGluc3RhbmNlIGFuZCBj
b25uX2ZyZWVfYnVmZmVyZWRfZGF0YSgpIGZvciBmcmVlaW5nIGFsbAppbnN0
YW5jZXMgZm9yIGEgY29ubmVjdGlvbi4KClRoaXMgaXMgYXZvaWRpbmcgZHVw
bGljYXRlZCBjb2RlIGFuZCB3aWxsIGhlbHAgbGF0ZXIgd2hlbiBtb3JlIGFj
dGlvbnMKYXJlIG5lZWRlZCB3aGVuIGZyZWVpbmcgYSBzdHJ1Y3QgYnVmZmVy
ZWRfZGF0YS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggZTY3NzZiYWU4
Zjk5Li41ZDU0Nzc5ZDQwOWIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMjA4LDYgKzIwOCwyMSBAQCB2b2lkIHJlb3Blbl9s
b2codm9pZCkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRf
ZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAorCQkJICAgICAgIHN0
cnVjdCBjb25uZWN0aW9uICpjb25uKQoreworCWxpc3RfZGVsKCZvdXQtPmxp
c3QpOworCXRhbGxvY19mcmVlKG91dCk7Cit9CisKK3ZvaWQgY29ubl9mcmVl
X2J1ZmZlcmVkX2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJ
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKKworCXdoaWxlICgob3V0ID0g
bGlzdF90b3AoJmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSwgbGlzdCkpKQorCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
K30KKwogc3RhdGljIGJvb2wgd3JpdGVfbWVzc2FnZXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaW50IHJldDsKQEAgLTI1MSw4ICsyNjYsNyBA
QCBzdGF0aWMgYm9vbCB3cml0ZV9tZXNzYWdlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXRyYWNlX2lvKGNvbm4sIG91dCwgMSk7CiAKLQlsaXN0
X2RlbCgmb3V0LT5saXN0KTsKLQl0YWxsb2NfZnJlZShvdXQpOworCWZyZWVf
YnVmZmVyZWRfZGF0YShvdXQsIGNvbm4pOwogCiAJcmV0dXJuIHRydWU7CiB9
CkBAIC0xMzkxLDE4ICsxNDA1LDEyIEBAIHN0YXRpYyBzdHJ1Y3QgewogICov
CiBzdGF0aWMgdm9pZCBpZ25vcmVfY29ubmVjdGlvbihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LCAq
dG1wOwotCiAJdHJhY2UoIkNPTk4gJXAgaWdub3JlZFxuIiwgY29ubik7CiAK
IAljb25uLT5pc19pZ25vcmVkID0gdHJ1ZTsKIAljb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcyhjb25uKTsKIAljb25uX2RlbGV0ZV9hbGxfdHJhbnNhY3Rpb25z
KGNvbm4pOwotCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG91dCwgdG1w
LCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsKLQkJbGlzdF9kZWwoJm91dC0+
bGlzdCk7Ci0JCXRhbGxvY19mcmVlKG91dCk7Ci0JfQorCWNvbm5fZnJlZV9i
dWZmZXJlZF9kYXRhKGNvbm4pOwogCiAJdGFsbG9jX2ZyZWUoY29ubi0+aW4p
OwogCWNvbm4tPmluID0gTlVMTDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oCmluZGV4IDJiMGY3OTZkOWJiMS4uODNkNDk2OTNmYzE5IDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKQEAgLTIyNiw2
ICsyMjYsOCBAQCBleHRlcm4geGVuZ250dGFiX2hhbmRsZSAqKnhndF9oYW5k
bGU7CiAKIGludCByZW1lbWJlcl9zdHJpbmcoc3RydWN0IGhhc2h0YWJsZSAq
aGFzaCwgY29uc3QgY2hhciAqc3RyKTsKIAordm9pZCBjb25uX2ZyZWVfYnVm
ZmVyZWRfZGF0YShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CisKICNlbmRp
ZiAvKiBfWEVOU1RPUkVEX0NPUkVfSCAqLwogCiAvKgpkaWZmIC0tZ2l0IGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IGQ1ZTFlM2U5ZDQyZC4u
M2JmZjMyMmQwMjRkIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2RvbWFpbi5jCkBAIC00MDIsMTUgKzQwMiwxMCBAQCBzdGF0aWMgc3RydWN0
IGRvbWFpbiAqZmluZF9kb21haW5fYnlfZG9taWQodW5zaWduZWQgaW50IGRv
bWlkKQogc3RhdGljIHZvaWQgZG9tYWluX2Nvbm5fcmVzZXQoc3RydWN0IGRv
bWFpbiAqZG9tYWluKQogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25uID0g
ZG9tYWluLT5jb25uOwotCXN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQ7CiAK
IAljb25uX2RlbGV0ZV9hbGxfd2F0Y2hlcyhjb25uKTsKIAljb25uX2RlbGV0
ZV9hbGxfdHJhbnNhY3Rpb25zKGNvbm4pOwotCi0Jd2hpbGUgKChvdXQgPSBs
aXN0X3RvcCgmY29ubi0+b3V0X2xpc3QsIHN0cnVjdCBidWZmZXJlZF9kYXRh
LCBsaXN0KSkpIHsKLQkJbGlzdF9kZWwoJm91dC0+bGlzdCk7Ci0JCXRhbGxv
Y19mcmVlKG91dCk7Ci0JfQorCWNvbm5fZnJlZV9idWZmZXJlZF9kYXRhKGNv
bm4pOwogCiAJdGFsbG9jX2ZyZWUoY29ubi0+aW4pOwogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSA4OWMwMjY2NDc0NWNkZDYyYWE1NTZhNzg3MGNkZjQ5NTc2YTkwMWEx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlZHVjZSBu
dW1iZXIgb2Ygd2F0Y2ggZXZlbnRzCgpXaGVuIHJlbW92aW5nIGEgd2F0Y2hl
ZCBub2RlIG91dHNpZGUgb2YgYSB0cmFuc2FjdGlvbiwgdHdvIHdhdGNoIGV2
ZW50cwphcmUgYmVpbmcgcHJvZHVjZWQgaW5zdGVhZCBvZiBqdXN0IGEgc2lu
Z2xlIG9uZS4KCldoZW4gZmluYWxpemluZyBhIHRyYW5zYWN0aW9uIHdhdGNo
IGV2ZW50cyBjYW4gYmUgZ2VuZXJhdGVkIGZvciBlYWNoCm5vZGUgd2hpY2gg
aXMgYmVpbmcgbW9kaWZpZWQsIGV2ZW4gaWYgb3V0c2lkZSBhIHRyYW5zYWN0
aW9uIHN1Y2gKbW9kaWZpY2F0aW9ucyBtaWdodCBub3QgaGF2ZSByZXN1bHRl
ZCBpbiBhIHdhdGNoIGV2ZW50LgoKVGhpcyBoYXBwZW5zIGUuZy46CgotIGZv
ciBub2RlcyB3aGljaCBhcmUgb25seSBtb2RpZmllZCBkdWUgdG8gYWRkZWQv
cmVtb3ZlZCBjaGlsZCBlbnRyaWVzCi0gZm9yIG5vZGVzIGJlaW5nIHJlbW92
ZWQgb3IgY3JlYXRlZCBpbXBsaWNpdGx5IChlLmcuIGNyZWF0aW9uIG9mIGEv
Yi9jCiAgaXMgaW1wbGljaXRseSBjcmVhdGluZyBhL2IsIHJlc3VsdGluZyBp
biB3YXRjaCBldmVudHMgZm9yIGEsIGEvYiBhbmQKICBhL2IvYyBpbnN0ZWFk
IG9mIGEvYi9jIG9ubHkpCgpBdm9pZCB0aGVzZSBhZGRpdGlvbmFsIHdhdGNo
IGV2ZW50cywgaW4gb3JkZXIgdG8gcmVkdWNlIHRoZSBuZWVkZWQKbWVtb3J5
IGluc2lkZSBYZW5zdG9yZSBmb3IgcXVldWVpbmcgdGhlbS4KClRoaXMgaXMg
YmVpbmcgYWNoaWV2ZWQgYnkgYWRkaW5nIGV2ZW50IGZsYWdzIHRvIHN0cnVj
dCBhY2Nlc3NlZF9ub2RlCnNwZWNpZnlpbmcgd2hldGhlciBhbiBldmVudCBz
aG91bGQgYmUgdHJpZ2dlcmVkLCBhbmQgd2hldGhlciBpdCBzaG91bGQKYmUg
YW4gZXhhY3QgbWF0Y2ggb2YgdGhlIG1vZGlmaWVkIHBhdGguIEJvdGggZmxh
Z3MgY2FuIGJlIHNldCBmcm9tCmZpcmVfd2F0Y2hlcygpIGluc3RlYWQgb2Yg
aW1wbHlpbmcgdGhlbSBvbmx5LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA1ZDU0Nzc5ZDQwOWIuLjUzZDAwM2FlYmZmYiAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMTgyLDcgKzExODIsNyBAQCBz
dGF0aWMgdm9pZCBkZWxldGVfY2hpbGQoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiB9CiAKIHN0YXRpYyBpbnQgZGVsZXRlX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKLQkJICAgICAgIHN0cnVj
dCBub2RlICpwYXJlbnQsIHN0cnVjdCBub2RlICpub2RlKQorCQkgICAgICAg
c3RydWN0IG5vZGUgKnBhcmVudCwgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wg
d2F0Y2hfZXhhY3QpCiB7CiAJY2hhciAqbmFtZTsKIApAQCAtMTE5NCw3ICsx
MTk0LDcgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkJCSAgICAgICBub2Rl
LT5jaGlsZHJlbik7CiAJCWNoaWxkID0gbmFtZSA/IHJlYWRfbm9kZShjb25u
LCBub2RlLCBuYW1lKSA6IE5VTEw7CiAJCWlmIChjaGlsZCkgewotCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQpKQorCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQsIHRydWUpKQog
CQkJCXJldHVybiBlcnJubzsKIAkJfSBlbHNlIHsKIAkJCXRyYWNlKCJkZWxl
dGVfbm9kZTogRXJyb3IgZGVsZXRpbmcgY2hpbGQgJyVzLyVzJyFcbiIsCkBA
IC0xMjA2LDcgKzEyMDYsMTIgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQl0
YWxsb2NfZnJlZShuYW1lKTsKIAl9CiAKLQlmaXJlX3dhdGNoZXMoY29ubiwg
Y3R4LCBub2RlLT5uYW1lLCBub2RlLCB0cnVlLCBOVUxMKTsKKwkvKgorCSAq
IEZpcmUgdGhlIHdhdGNoZXMgbm93LCB3aGVuIHdlIGNhbiBzdGlsbCBzZWUg
dGhlIG5vZGUgcGVybWlzc2lvbnMuCisJICogVGhpcyBmaW5lIGFzIHdlIGFy
ZSBzaW5nbGUgdGhyZWFkZWQgYW5kIHRoZSBuZXh0IHBvc3NpYmxlIHJlYWQg
d2lsbAorCSAqIGJlIGhhbmRsZWQgb25seSBhZnRlciB0aGUgbm9kZSBoYXMg
YmVlbiByZWFsbHkgcmVtb3ZlZC4KKwkgKi8KKwlmaXJlX3dhdGNoZXMoY29u
biwgY3R4LCBub2RlLT5uYW1lLCBub2RlLCB3YXRjaF9leGFjdCwgTlVMTCk7
CiAJZGVsZXRlX25vZGVfc2luZ2xlKGNvbm4sIG5vZGUpOwogCWRlbGV0ZV9j
aGlsZChjb25uLCBwYXJlbnQsIGJhc2VuYW1lKG5vZGUtPm5hbWUpKTsKIAl0
YWxsb2NfZnJlZShub2RlKTsKQEAgLTEyMzIsMTMgKzEyMzcsNyBAQCBzdGF0
aWMgaW50IF9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAkJcmV0dXJuIChlcnJubyA9
PSBFTk9NRU0pID8gRU5PTUVNIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9
IHBhcmVudDsKIAotCS8qCi0JICogRmlyZSB0aGUgd2F0Y2hlcyBub3csIHdo
ZW4gd2UgY2FuIHN0aWxsIHNlZSB0aGUgbm9kZSBwZXJtaXNzaW9ucy4KLQkg
KiBUaGlzIGZpbmUgYXMgd2UgYXJlIHNpbmdsZSB0aHJlYWRlZCBhbmQgdGhl
IG5leHQgcG9zc2libGUgcmVhZCB3aWxsCi0JICogYmUgaGFuZGxlZCBvbmx5
IGFmdGVyIHRoZSBub2RlIGhhcyBiZWVuIHJlYWxseSByZW1vdmVkLgotCSAq
LwotCWZpcmVfd2F0Y2hlcyhjb25uLCBjdHgsIG5hbWUsIG5vZGUsIGZhbHNl
LCBOVUxMKTsKLQlyZXR1cm4gZGVsZXRlX25vZGUoY29ubiwgY3R4LCBwYXJl
bnQsIG5vZGUpOworCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBh
cmVudCwgbm9kZSwgZmFsc2UpOwogfQogCiAKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKaW5kZXggNGZmYTE4MzEx
MTIwLi42ZmJkYjI5ZGNkZDcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCkBAIC0xMzAsNiArMTMwLDEwIEBA
IHN0cnVjdCBhY2Nlc3NlZF9ub2RlCiAKIAkvKiBUcmFuc2FjdGlvbiBub2Rl
IGluIGRhdGEgYmFzZT8gKi8KIAlib29sIHRhX25vZGU7CisKKwkvKiBXYXRj
aCBldmVudCBmbGFncy4gKi8KKwlib29sIGZpcmVfd2F0Y2g7CisJYm9vbCB3
YXRjaF9leGFjdDsKIH07CiAKIHN0cnVjdCBjaGFuZ2VkX2RvbWFpbgpAQCAt
MzMwLDYgKzMzNCwyOSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogfQogCiAvKgorICog
QSB3YXRjaCBldmVudCBzaG91bGQgYmUgZmlyZWQgZm9yIGEgbm9kZSBtb2Rp
ZmllZCBpbnNpZGUgYSB0cmFuc2FjdGlvbi4KKyAqIFNldCB0aGUgY29ycmVz
cG9uZGluZyBpbmZvcm1hdGlvbi4gQSBub24tZXhhY3QgZXZlbnQgaXMgcmVw
bGFjaW5nIGFuIGV4YWN0CisgKiBvbmUsIGJ1dCBub3QgdGhlIG90aGVyIHdh
eSByb3VuZC4KKyAqLwordm9pZCBxdWV1ZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBib29sIHdhdGNoX2V4
YWN0KQoreworCXN0cnVjdCBhY2Nlc3NlZF9ub2RlICppOworCisJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZShjb25uLT50cmFuc2FjdGlvbiwgbmFtZSk7CisJ
aWYgKCFpKSB7CisJCWNvbm4tPnRyYW5zYWN0aW9uLT5mYWlsID0gdHJ1ZTsK
KwkJcmV0dXJuOworCX0KKworCWlmICghaS0+ZmlyZV93YXRjaCkgeworCQlp
LT5maXJlX3dhdGNoID0gdHJ1ZTsKKwkJaS0+d2F0Y2hfZXhhY3QgPSB3YXRj
aF9leGFjdDsKKwl9IGVsc2UgaWYgKCF3YXRjaF9leGFjdCkgeworCQlpLT53
YXRjaF9leGFjdCA9IGZhbHNlOworCX0KK30KKworLyoKICAqIEZpbmFsaXpl
IHRyYW5zYWN0aW9uOgogICogV2FsayB0aHJvdWdoIGFjY2Vzc2VkIG5vZGVz
IGFuZCBjaGVjayBnZW5lcmF0aW9uIGFnYWluc3QgZ2xvYmFsIGRhdGEuCiAg
KiBJZiBhbGwgZW50cmllcyBtYXRjaCwgcmVhZCB0aGUgdHJhbnNhY3Rpb24g
ZW50cmllcyBhbmQgd3JpdGUgdGhlbSB3aXRob3V0CkBAIC0zODMsMTUgKzQx
MCwxNSBAQCBzdGF0aWMgaW50IGZpbmFsaXplX3RyYW5zYWN0aW9uKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJf
Y3R4LCBrZXksIGRhdGEsCiAJCQkJCQlUREJfUkVQTEFDRSk7CiAJCQkJdGFs
bG9jX2ZyZWUoZGF0YS5kcHRyKTsKLQkJCQlpZiAocmV0KQotCQkJCQlnb3Rv
IGVycjsKLQkJCQlmaXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUs
IE5VTEwsIGZhbHNlLAotCQkJCQkgICAgIGktPnBlcm1zLnAgPyAmaS0+cGVy
bXMgOiBOVUxMKTsKIAkJCX0gZWxzZSB7Ci0JCQkJZmlyZV93YXRjaGVzKGNv
bm4sIHRyYW5zLCBpLT5ub2RlLCBOVUxMLCBmYWxzZSwKKwkJCQlyZXQgPSB0
ZGJfZGVsZXRlKHRkYl9jdHgsIGtleSk7CisJCQl9CisJCQlpZiAocmV0KQor
CQkJCWdvdG8gZXJyOworCQkJaWYgKGktPmZpcmVfd2F0Y2gpIHsKKwkJCQlm
aXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUsIE5VTEwsCisJCQkJ
CSAgICAgaS0+d2F0Y2hfZXhhY3QsCiAJCQkJCSAgICAgaS0+cGVybXMucCA/
ICZpLT5wZXJtcyA6IE5VTEwpOwotCQkJCWlmICh0ZGJfZGVsZXRlKHRkYl9j
dHgsIGtleSkpCi0JCQkJCWdvdG8gZXJyOwogCQkJfQogCQl9CiAKZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKaW5k
ZXggMTQwNjI3MzBlM2M5Li4wMDkzY2FjODA3ZTMgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCkBAIC00Miw2
ICs0Miw5IEBAIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlfZGVjKHN0cnVjdCB0
cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBkb21pZCk7CiBpbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAogICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKIAorLyogUXVldWUgd2F0Y2hl
cyBmb3IgYSBtb2RpZmllZCBub2RlLiAqLwordm9pZCBxdWV1ZV93YXRjaGVz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBi
b29sIHdhdGNoX2V4YWN0KTsKKwogLyogUHJlcGVuZCB0aGUgdHJhbnNhY3Rp
b24gdG8gbmFtZSBpZiBhcHByb3ByaWF0ZS4gKi8KIGludCB0cmFuc2FjdGlv
bl9wcmVwZW5kKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgVERCX0RBVEEgKmtl
eSk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0
Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCmluZGV4
IDZkODA5NzM3NmU0Ny4uMmY5MzY3NzY3ZTQ0IDEwMDY0NAotLS0gYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMjksNiArMjksNyBAQAogI2lu
Y2x1ZGUgInhlbnN0b3JlX2xpYi5oIgogI2luY2x1ZGUgInV0aWxzLmgiCiAj
aW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgorI2luY2x1ZGUgInhlbnN0
b3JlZF90cmFuc2FjdGlvbi5oIgogCiBleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CiAKQEAgLTE0Myw5ICsxNDQsMTEgQEAgdm9pZCBm
aXJlX3dhdGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwKIAlzdHJ1Y3QgY29ubmVjdGlv
biAqaTsKIAlzdHJ1Y3Qgd2F0Y2ggKndhdGNoOwogCi0JLyogRHVyaW5nIHRy
YW5zYWN0aW9ucywgZG9uJ3QgZmlyZSB3YXRjaGVzLiAqLwotCWlmIChjb25u
ICYmIGNvbm4tPnRyYW5zYWN0aW9uKQorCS8qIER1cmluZyB0cmFuc2FjdGlv
bnMsIGRvbid0IGZpcmUgd2F0Y2hlcywgYnV0IHF1ZXVlIHRoZW0uICovCisJ
aWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24pIHsKKwkJcXVldWVfd2F0
Y2hlcyhjb25uLCBuYW1lLCBleGFjdCk7CiAJCXJldHVybjsKKwl9CiAKIAkv
KiBDcmVhdGUgYW4gZXZlbnQgZm9yIGVhY2ggd2F0Y2guICovCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeShpLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSA3OWE4OGIzOGNiOGI4Zjg3MDg5MzViYzQzYjFlOTM4MjY2MjZhYmFm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxldCB1bnJl
YWQgd2F0Y2ggZXZlbnRzIHRpbWUgb3V0CgpBIGZ1dHVyZSBtb2RpZmljYXRp
b24gd2lsbCBsaW1pdCB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzCmZvciBhIGRvbWFpbiwgd2hlcmUgIm91dHN0YW5kaW5nIiBtZWFucyB0
aGF0IHRoZSByZXNwb25zZSBvZiB0aGUKcmVxdWVzdCBvciBhbnkgcmVzdWx0
aW5nIHdhdGNoIGV2ZW50IGhhc24ndCBiZWVuIGNvbnN1bWVkIHlldC4KCklu
IG9yZGVyIHRvIGF2b2lkIGEgbWFsaWNpb3VzIGd1ZXN0IGJlaW5nIGNhcGFi
bGUgdG8gYmxvY2sgb3RoZXIgZ3Vlc3RzCmJ5IG5vdCByZWFkaW5nIHdhdGNo
IGV2ZW50cywgYWRkIGEgdGltZW91dCBmb3Igd2F0Y2ggZXZlbnRzLiBJbiBj
YXNlIGEKd2F0Y2ggZXZlbnQgaGFzbid0IGJlZW4gY29uc3VtZWQgYWZ0ZXIg
dGhpcyB0aW1lb3V0LCBpdCBpcyBiZWluZwpkZWxldGVkLiBTZXQgdGhlIGRl
ZmF1bHQgdGltZW91dCB0byAyMCBzZWNvbmRzIChhIHJhbmRvbSB2YWx1ZSBi
ZWluZwpub3QgdG9vIGhpZ2gpLgoKSW4gb3JkZXIgdG8gc3VwcG9ydCB0byBz
cGVjaWZ5IG90aGVyIHRpbWVvdXQgdmFsdWVzIGluIGZ1dHVyZSwgdXNlIGEK
Z2VuZXJpYyBjb21tYW5kIGxpbmUgb3B0aW9uIGZvciB0aGF0IHB1cnBvc2U6
CgotLXRpbWVvdXR8LXcgd2F0Y2gtZXZlbnQ9PHNlY29uZHM+CgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzExLgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggNTNkMDAzYWVi
ZmZiLi45ODgzN2VmMmU5Y2YgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMTA2LDYgKzEwNiw4IEBAIGludCBxdW90YV9tYXhf
ZW50cnlfc2l6ZSA9IDIwNDg7IC8qIDJLICovCiBpbnQgcXVvdGFfbWF4X3Ry
YW5zYWN0aW9uID0gMTA7CiBpbnQgcXVvdGFfbmJfcGVybXNfcGVyX25vZGUg
PSA1OwogCit1bnNpZ25lZCBpbnQgdGltZW91dF93YXRjaF9ldmVudF9tc2Vj
ID0gMjAwMDA7CisKIHZvaWQgdHJhY2UoY29uc3QgY2hhciAqZm10LCAuLi4p
CiB7CiAJdmFfbGlzdCBhcmdsaXN0OwpAQCAtMjA4LDE5ICsyMTAsOTIgQEAg
dm9pZCByZW9wZW5fbG9nKHZvaWQpCiAJfQogfQogCitzdGF0aWMgdWludDY0
X3QgZ2V0X25vd19tc2VjKHZvaWQpCit7CisJc3RydWN0IHRpbWVzcGVjIG5v
d190czsKKworCWlmIChjbG9ja19nZXR0aW1lKENMT0NLX01PTk9UT05JQywg
Jm5vd190cykpCisJCWJhcmZfcGVycm9yKCJDb3VsZCBub3QgZmluZCB0aW1l
IChjbG9ja19nZXR0aW1lIGZhaWxlZCkiKTsKKworCXJldHVybiBub3dfdHMu
dHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAwMDsKK30K
Kwogc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBidWZm
ZXJlZF9kYXRhICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pCiB7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKKwogCWxp
c3RfZGVsKCZvdXQtPmxpc3QpOworCisJLyoKKwkgKiBVcGRhdGUgY29ubi0+
dGltZW91dF9tc2VjIHdpdGggdGhlIG5leHQgZm91bmQgdGltZW91dCB2YWx1
ZSBpbiB0aGUKKwkgKiBxdWV1ZWQgcGVuZGluZyByZXF1ZXN0cy4KKwkgKi8K
KwlpZiAob3V0LT50aW1lb3V0X21zZWMpIHsKKwkJY29ubi0+dGltZW91dF9t
c2VjID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShyZXEsICZjb25uLT5v
dXRfbGlzdCwgbGlzdCkgeworCQkJaWYgKHJlcS0+dGltZW91dF9tc2VjKSB7
CisJCQkJY29ubi0+dGltZW91dF9tc2VjID0gcmVxLT50aW1lb3V0X21zZWM7
CisJCQkJYnJlYWs7CisJCQl9CisJCX0KKwl9CisKIAl0YWxsb2NfZnJlZShv
dXQpOwogfQogCitzdGF0aWMgdm9pZCBjaGVja19ldmVudF90aW1lb3V0KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCB1aW50NjRfdCBtc2VjcywKKwkJCQlp
bnQgKnB0aW1lb3V0KQoreworCXVpbnQ2NF90IGRlbHRhOworCXN0cnVjdCBi
dWZmZXJlZF9kYXRhICpvdXQsICp0bXA7CisKKwlpZiAoIWNvbm4tPnRpbWVv
dXRfbXNlYykKKwkJcmV0dXJuOworCisJZGVsdGEgPSBjb25uLT50aW1lb3V0
X21zZWMgLSBtc2VjczsKKwlpZiAoY29ubi0+dGltZW91dF9tc2VjIDw9IG1z
ZWNzKSB7CisJCWRlbHRhID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeV9z
YWZlKG91dCwgdG1wLCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsKKwkJCS8q
CisJCQkgKiBPbmx5IGxvb2sgYXQgYnVmZmVycyB3aXRoIHRpbWVvdXQgYW5k
IG5vIGRhdGEKKwkJCSAqIGFscmVhZHkgd3JpdHRlbiB0byB0aGUgcmluZy4K
KwkJCSAqLworCQkJaWYgKG91dC0+dGltZW91dF9tc2VjICYmIG91dC0+aW5o
ZHIgJiYgIW91dC0+dXNlZCkgeworCQkJCWlmIChvdXQtPnRpbWVvdXRfbXNl
YyA+IG1zZWNzKSB7CisJCQkJCWNvbm4tPnRpbWVvdXRfbXNlYyA9IG91dC0+
dGltZW91dF9tc2VjOworCQkJCQlkZWx0YSA9IGNvbm4tPnRpbWVvdXRfbXNl
YyAtIG1zZWNzOworCQkJCQlicmVhazsKKwkJCQl9CisKKwkJCQkvKgorCQkJ
CSAqIEZyZWUgb3V0IHdpdGhvdXQgdXBkYXRpbmcgY29ubi0+dGltZW91dF9t
c2VjLAorCQkJCSAqIGFzIHRoZSB1cGRhdGUgaXMgZG9uZSBpbiB0aGlzIGxv
b3AgYWxyZWFkeS4KKwkJCQkgKi8KKwkJCQlvdXQtPnRpbWVvdXRfbXNlYyA9
IDA7CisJCQkJdHJhY2UoIndhdGNoIGV2ZW50IHBhdGggJXMgZm9yIGRvbWFp
biAldSB0aW1lZCBvdXRcbiIsCisJCQkJICAgICAgb3V0LT5idWZmZXIsIGNv
bm4tPmlkKTsKKwkJCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
KwkJCX0KKwkJfQorCQlpZiAoIWRlbHRhKSB7CisJCQljb25uLT50aW1lb3V0
X21zZWMgPSAwOworCQkJcmV0dXJuOworCQl9CisJfQorCisJaWYgKCpwdGlt
ZW91dCA9PSAtMSB8fCAqcHRpbWVvdXQgPiBkZWx0YSkKKwkJKnB0aW1lb3V0
ID0gZGVsdGE7Cit9CisKIHZvaWQgY29ubl9mcmVlX2J1ZmZlcmVkX2RhdGEo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7CiAJc3RydWN0IGJ1ZmZlcmVk
X2RhdGEgKm91dDsKIAogCXdoaWxlICgob3V0ID0gbGlzdF90b3AoJmNvbm4t
Pm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSwgbGlzdCkpKQogCQlm
cmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsKKworCWNvbm4tPnRpbWVv
dXRfbXNlYyA9IDA7CiB9CiAKIHN0YXRpYyBib29sIHdyaXRlX21lc3NhZ2Vz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQpAQCAtMzMzLDYgKzQwOCw3IEBA
IHN0YXRpYyB2b2lkIGluaXRpYWxpemVfZmRzKGludCAqcF9zb2NrX3BvbGxm
ZF9pZHgsIGludCAqcF9yb19zb2NrX3BvbGxmZF9pZHgsCiB7CiAJc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm47CiAJc3RydWN0IHdybF90aW1lc3RhbXB0IG5v
dzsKKwl1aW50NjRfdCBtc2VjczsKIAogCWlmIChmZHMpCiAJCW1lbXNldChm
ZHMsIDAsIHNpemVvZihzdHJ1Y3QgcG9sbGZkKSAqIGN1cnJlbnRfYXJyYXlf
c2l6ZSk7CkBAIC0zNTQsMTAgKzQzMCwxMiBAQCBzdGF0aWMgdm9pZCBpbml0
aWFsaXplX2ZkcyhpbnQgKnBfc29ja19wb2xsZmRfaWR4LCBpbnQgKnBfcm9f
c29ja19wb2xsZmRfaWR4LAogCiAJd3JsX2dldHRpbWVfbm93KCZub3cpOwog
CXdybF9sb2dfcGVyaW9kaWMobm93KTsKKwltc2VjcyA9IGdldF9ub3dfbXNl
YygpOwogCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShjb25uLCAmY29ubmVjdGlv
bnMsIGxpc3QpIHsKIAkJaWYgKGNvbm4tPmRvbWFpbikgewogCQkJd3JsX2No
ZWNrX3RpbWVvdXQoY29ubi0+ZG9tYWluLCBub3csIHB0aW1lb3V0KTsKKwkJ
CWNoZWNrX2V2ZW50X3RpbWVvdXQoY29ubiwgbXNlY3MsIHB0aW1lb3V0KTsK
IAkJCWlmIChkb21haW5fY2FuX3JlYWQoY29ubikgfHwKIAkJCSAgICAoZG9t
YWluX2Nhbl93cml0ZShjb25uKSAmJgogCQkJICAgICAhbGlzdF9lbXB0eSgm
Y29ubi0+b3V0X2xpc3QpKSkKQEAgLTcwMSw2ICs3NzksNyBAQCB2b2lkIHNl
bmRfcmVwbHkoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3Nv
Y2ttc2dfdHlwZSB0eXBlLAogCQlyZXR1cm47CiAJYmRhdGEtPmluaGRyID0g
dHJ1ZTsKIAliZGF0YS0+dXNlZCA9IDA7CisJYmRhdGEtPnRpbWVvdXRfbXNl
YyA9IDA7CiAKIAlpZiAobGVuIDw9IERFRkFVTFRfQlVGRkVSX1NJWkUpCiAJ
CWJkYXRhLT5idWZmZXIgPSBiZGF0YS0+ZGVmYXVsdF9idWZmZXI7CkBAIC03
NTIsNiArODMxLDEyIEBAIHZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9r
ZW4pCiAJYmRhdGEtPmhkci5tc2cudHlwZSA9IFhTX1dBVENIX0VWRU5UOwog
CWJkYXRhLT5oZHIubXNnLmxlbiA9IGxlbjsKIAorCWlmICh0aW1lb3V0X3dh
dGNoX2V2ZW50X21zZWMgJiYgZG9tYWluX2lzX3VucHJpdmlsZWdlZChjb25u
KSkgeworCQliZGF0YS0+dGltZW91dF9tc2VjID0gZ2V0X25vd19tc2VjKCkg
KyB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7CisJCWlmICghY29ubi0+dGlt
ZW91dF9tc2VjKQorCQkJY29ubi0+dGltZW91dF9tc2VjID0gYmRhdGEtPnRp
bWVvdXRfbXNlYzsKKwl9CisKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNt
aXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29u
bi0+b3V0X2xpc3QpOwogfQpAQCAtMTk5NCw2ICsyMDc5LDkgQEAgc3RhdGlj
IHZvaWQgdXNhZ2Uodm9pZCkKICIgIC1XLCAtLXdhdGNoLW5iIDxuYj4gICAg
IGxpbWl0IHRoZSBudW1iZXIgb2Ygd2F0Y2hlcyBwZXIgZG9tYWluLFxuIgog
IiAgLXQsIC0tdHJhbnNhY3Rpb24gPG5iPiAgbGltaXQgdGhlIG51bWJlciBv
ZiB0cmFuc2FjdGlvbiBhbGxvd2VkIHBlciBkb21haW4sXG4iCiAiICAtQSwg
LS1wZXJtLW5iIDxuYj4gICAgICBsaW1pdCB0aGUgbnVtYmVyIG9mIHBlcm1p
c3Npb25zIHBlciBub2RlLFxuIgorIiAgLXcsIC0tdGltZW91dCA8d2hhdD49
PHNlY29uZHM+ICAgc2V0IHRoZSB0aW1lb3V0IGluIHNlY29uZHMgZm9yIDx3
aGF0PixcbiIKKyIgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWQg
dGltZW91dCBjYW5kaWRhdGVzIGFyZTpcbiIKKyIgICAgICAgICAgICAgICAg
ICAgICAgICAgIHdhdGNoLWV2ZW50OiB0aW1lIGEgd2F0Y2gtZXZlbnQgaXMg
a2VwdCBwZW5kaW5nXG4iCiAiICAtUiwgLS1uby1yZWNvdmVyeSAgICAgICB0
byByZXF1ZXN0IHRoYXQgbm8gcmVjb3Zlcnkgc2hvdWxkIGJlIGF0dGVtcHRl
ZCB3aGVuXG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgc3Rv
cmUgaXMgY29ycnVwdGVkIChkZWJ1ZyBvbmx5KSxcbiIKICIgIC1JLCAtLWlu
dGVybmFsLWRiICAgICAgIHN0b3JlIGRhdGFiYXNlIGluIG1lbW9yeSwgbm90
IG9uIGRpc2tcbiIKQEAgLTIwMTUsNiArMjEwMyw3IEBAIHN0YXRpYyBzdHJ1
Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsKIAl7ICJ0cmFjZS1maWxlIiwgMSwg
TlVMTCwgJ1QnIH0sCiAJeyAidHJhbnNhY3Rpb24iLCAxLCBOVUxMLCAndCcg
fSwKIAl7ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCisJeyAidGltZW91
dCIsIDEsIE5VTEwsICd3JyB9LAogCXsgIm5vLXJlY292ZXJ5IiwgMCwgTlVM
TCwgJ1InIH0sCiAJeyAiaW50ZXJuYWwtZGIiLCAwLCBOVUxMLCAnSScgfSwK
IAl7ICJ2ZXJib3NlIiwgMCwgTlVMTCwgJ1YnIH0sCkBAIC0yMDI2LDYgKzIx
MTUsMzkgQEAgaW50IGRvbTBfZG9taWQgPSAwOwogaW50IGRvbTBfZXZlbnQg
PSAwOwogaW50IHByaXZfZG9taWQgPSAwOwogCitzdGF0aWMgaW50IGdldF9v
cHR2YWxfaW50KGNvbnN0IGNoYXIgKmFyZykKK3sKKwljaGFyICplbmQ7CisJ
bG9uZyB2YWw7CisKKwl2YWwgPSBzdHJ0b2woYXJnLCAmZW5kLCAxMCk7CisJ
aWYgKCEqYXJnIHx8ICplbmQgfHwgdmFsIDwgMCB8fCB2YWwgPiBJTlRfTUFY
KQorCQliYXJmKCJpbnZhbGlkIHBhcmFtZXRlciB2YWx1ZSBcIiVzXCJcbiIs
IGFyZyk7CisKKwlyZXR1cm4gdmFsOworfQorCitzdGF0aWMgYm9vbCB3aGF0
X21hdGNoZXMoY29uc3QgY2hhciAqYXJnLCBjb25zdCBjaGFyICp3aGF0KQor
eworCXVuc2lnbmVkIGludCB3aGF0X2xlbiA9IHN0cmxlbih3aGF0KTsKKwor
CXJldHVybiAhc3RybmNtcChhcmcsIHdoYXQsIHdoYXRfbGVuKSAmJiBhcmdb
d2hhdF9sZW5dID09ICc9JzsKK30KKworc3RhdGljIHZvaWQgc2V0X3RpbWVv
dXQoY29uc3QgY2hhciAqYXJnKQoreworCWNvbnN0IGNoYXIgKmVxID0gc3Ry
Y2hyKGFyZywgJz0nKTsKKwlpbnQgdmFsOworCisJaWYgKCFlcSkKKwkJYmFy
ZigicXVvdGFzIG11c3QgYmUgc3BlY2lmaWVkIHZpYSA8d2hhdD49PHNlY29u
ZHM+XG4iKTsKKwl2YWwgPSBnZXRfb3B0dmFsX2ludChlcSArIDEpOworCWlm
ICh3aGF0X21hdGNoZXMoYXJnLCAid2F0Y2gtZXZlbnQiKSkKKwkJdGltZW91
dF93YXRjaF9ldmVudF9tc2VjID0gdmFsICogMTAwMDsKKwllbHNlCisJCWJh
cmYoInVua25vd24gdGltZW91dCBcIiVzXCJcbiIsIGFyZyk7Cit9CisKIGlu
dCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiB7CiAJaW50IG9wdDsK
QEAgLTIwMzcsNyArMjE1OSw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFy
ICphcmd2W10pCiAJaW50IHRpbWVvdXQ7CiAKIAotCXdoaWxlICgob3B0ID0g
Z2V0b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6VDpSVlc6
Iiwgb3B0aW9ucywKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFyZ2Ms
IGFyZ3YsICJERTpGOkhOUFM6dDpBOlQ6UlZXOnc6Iiwgb3B0aW9ucywKIAkJ
CQkgIE5VTEwpKSAhPSAtMSkgewogCQlzd2l0Y2ggKG9wdCkgewogCQljYXNl
ICdEJzoKQEAgLTIwODIsNiArMjIwNCw5IEBAIGludCBtYWluKGludCBhcmdj
LCBjaGFyICphcmd2W10pCiAJCWNhc2UgJ0EnOgogCQkJcXVvdGFfbmJfcGVy
bXNfcGVyX25vZGUgPSBzdHJ0b2wob3B0YXJnLCBOVUxMLCAxMCk7CiAJCQli
cmVhazsKKwkJY2FzZSAndyc6CisJCQlzZXRfdGltZW91dChvcHRhcmcpOwor
CQkJYnJlYWs7CiAJCWNhc2UgJ2UnOgogCQkJZG9tMF9ldmVudCA9IHN0cnRv
bChvcHRhcmcsIE5VTEwsIDEwKTsKIAkJCWJyZWFrOwpkaWZmIC0tZ2l0IGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggODNkNDk2OTNmYzE5Li4zMTEy
YzExODExZTUgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUu
aApAQCAtMjcsNiArMjcsNyBAQAogI2luY2x1ZGUgPGRpcmVudC5oPgogI2lu
Y2x1ZGUgPHN0ZGJvb2wuaD4KICNpbmNsdWRlIDxzdGRpbnQuaD4KKyNpbmNs
dWRlIDx0aW1lLmg+CiAjaW5jbHVkZSA8ZXJybm8uaD4KIAogI2luY2x1ZGUg
InhlbnN0b3JlX2xpYi5oIgpAQCAtNTYsNiArNTcsOCBAQCBzdHJ1Y3QgYnVm
ZmVyZWRfZGF0YQogCQljaGFyIHJhd1tzaXplb2Yoc3RydWN0IHhzZF9zb2Nr
bXNnKV07CiAJfSBoZHI7CiAKKwl1aW50NjRfdCB0aW1lb3V0X21zZWM7CisK
IAkvKiBUaGUgYWN0dWFsIGRhdGEuICovCiAJY2hhciAqYnVmZmVyOwogCWNo
YXIgZGVmYXVsdF9idWZmZXJbREVGQVVMVF9CVUZGRVJfU0laRV07CkBAIC04
OCw2ICs5MSw3IEBAIHN0cnVjdCBjb25uZWN0aW9uCiAKIAkvKiBCdWZmZXJl
ZCBvdXRwdXQgZGF0YSAqLwogCXN0cnVjdCBsaXN0X2hlYWQgb3V0X2xpc3Q7
CisJdWludDY0X3QgdGltZW91dF9tc2VjOwogCiAJLyogVHJhbnNhY3Rpb24g
Y29udGV4dCBmb3IgY3VycmVudCByZXF1ZXN0IChOVUxMIGlmIG5vbmUpLiAq
LwogCXN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnNhY3Rpb247CkBAIC0xOTks
NiArMjAzLDggQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0ZXJuIGlu
dCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9wZXJf
ZG9tYWluOwogCitleHRlcm4gdW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hf
ZXZlbnRfbXNlYzsKKwogLyogTWFwIHRoZSBrZXJuZWwncyB4ZW5zdG9yZSBw
YWdlLiAqLwogdm9pZCAqeGVuYnVzX21hcCh2b2lkKTsKIHZvaWQgdW5tYXBf
eGVuYnVzKHZvaWQgKmludGVyZmFjZSk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSA2MTAyZWM0ZDIxNTM1OWRiYzk0MzNiYzJiZmJiZjYzZTI0ZjkxNzYx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG91
dHN0YW5kaW5nIHJlcXVlc3RzCgpBZGQgYW5vdGhlciBxdW90YSBmb3IgbGlt
aXRpbmcgdGhlIG51bWJlciBvZiBvdXRzdGFuZGluZyByZXF1ZXN0cyBvZiBh
Cmd1ZXN0LiBBcyB0aGUgd2F5IHRvIHNwZWNpZnkgcXVvdGFzIG9uIHRoZSBj
b21tYW5kIGxpbmUgaXMgYmVjb21pbmcKcmF0aGVyIG5hc3R5LCBzd2l0Y2gg
dG8gYSBuZXcgc2NoZW1lIHVzaW5nIFstLXF1b3RhfC1RXSA8d2hhdD49PHZh
bD4KYWxsb3dpbmcgdG8gYWRkIG1vcmUgcXVvdGFzIGluIGZ1dHVyZSBlYXNp
bHkuCgpTZXQgdGhlIGRlZmF1bHQgdmFsdWUgdG8gMjAgKGJhc2ljYWxseSBh
IHJhbmRvbSB2YWx1ZSBub3Qgc2VlbWluZyB0bwpiZSB0b28gaGlnaCBvciB0
b28gbG93KS4KCkEgcmVxdWVzdCBpcyBzYWlkIHRvIGJlIG91dHN0YW5kaW5n
IGlmIGFueSBtZXNzYWdlIGdlbmVyYXRlZCBieSB0aGlzCnJlcXVlc3QgKHRo
ZSBkaXJlY3QgcmVzcG9uc2UgcGx1cyBwb3RlbnRpYWwgd2F0Y2ggZXZlbnRz
KSBpcyBub3QgeWV0CmNvbXBsZXRlbHkgc3RvcmVkIGludG8gYSByaW5nIGJ1
ZmZlci4gVGhlIGluaXRpYWwgd2F0Y2ggZXZlbnQgc2VudCBhcwphIHJlc3Vs
dCBvZiByZWdpc3RlcmluZyBhIHdhdGNoIGlzIGFuIGV4Y2VwdGlvbi4KCk5v
dGUgdGhhdCBhY3Jvc3MgYSBsaXZlIHVwZGF0ZSB0aGUgcmVsYXRpb24gdG8g
YnVmZmVyZWQgd2F0Y2ggZXZlbnRzCmZvciBvdGhlciBkb21haW5zIGlzIGxv
c3QuCgpVc2UgdGFsbG9jX3plcm8oKSBmb3IgYWxsb2NhdGluZyB0aGUgZG9t
YWluIHN0cnVjdHVyZSBpbiBvcmRlciB0byBoYXZlCmFsbCBwZXItZG9tYWlu
IHF1b3RhIHplcm9lZCBpbml0aWFsbHkuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTMyNiAvIENWRS0yMDIyLTQyMzEyLgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggOTg4MzdlZjJlOWNmLi4yZWQ5MWQxMzI5
N2IgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MTA1LDYgKzEwNSw3IEBAIGludCBxdW90YV9uYl93YXRjaF9wZXJfZG9tYWlu
ID0gMTI4OwogaW50IHF1b3RhX21heF9lbnRyeV9zaXplID0gMjA0ODsgLyog
MksgKi8KIGludCBxdW90YV9tYXhfdHJhbnNhY3Rpb24gPSAxMDsKIGludCBx
dW90YV9uYl9wZXJtc19wZXJfbm9kZSA9IDU7CitpbnQgcXVvdGFfcmVxX291
dHN0YW5kaW5nID0gMjA7CiAKIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNo
X2V2ZW50X21zZWMgPSAyMDAwMDsKIApAQCAtMjIwLDEyICsyMjEsMjQgQEAg
c3RhdGljIHVpbnQ2NF90IGdldF9ub3dfbXNlYyh2b2lkKQogCXJldHVybiBu
b3dfdHMudHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAw
MDsKIH0KIAorLyoKKyAqIFJlbW92ZSBhIHN0cnVjdCBidWZmZXJlZF9kYXRh
IGZyb20gdGhlIGxpc3Qgb2Ygb3V0Z29pbmcgZGF0YS4KKyAqIEEgc3RydWN0
IGJ1ZmZlcmVkX2RhdGEgcmVsYXRlZCB0byBhIHJlcXVlc3QgaGF2aW5nIGNh
dXNlZCB3YXRjaCBldmVudHMgdG8gYmUKKyAqIHNlbnQgaXMga2VwdCB1bnRp
bCBhbGwgdGhvc2UgZXZlbnRzIGhhdmUgYmVlbiB3cml0dGVuIG91dC4KKyAq
IEVhY2ggd2F0Y2ggZXZlbnQgaXMgcmVmZXJlbmNpbmcgdGhlIHJlbGF0ZWQg
cmVxdWVzdCB2aWEgcGVuZC5yZXEsIHdoaWxlIHRoZQorICogbnVtYmVyIG9m
IHdhdGNoIGV2ZW50cyBjYXVzZWQgYnkgYSByZXF1ZXN0IGlzIGtlcHQgaW4g
cGVuZC5yZWYuZXZlbnRfY250CisgKiAodGhvc2UgdHdvIGNhc2VzIGFyZSBt
dXR1YWxseSBleGNsdXNpdmUsIHNvIHRoZSB0d28gZmllbGRzIGNhbiBzaGFy
ZSBtZW1vcnkKKyAqIHZpYSBhIHVuaW9uKS4KKyAqIFRoZSBzdHJ1Y3QgYnVm
ZmVyZWRfZGF0YSBpcyBmcmVlZCBvbmx5IGlmIG5vIHJlbGF0ZWQgd2F0Y2gg
ZXZlbnQgaXMKKyAqIHJlZmVyZW5jaW5nIGl0LiBUaGUgcmVsYXRlZCByZXR1
cm4gZGF0YSBjYW4gYmUgZnJlZWQgcmlnaHQgYXdheS4KKyAqLwogc3RhdGlj
IHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBidWZmZXJlZF9kYXRh
ICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7
CiAJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKIAogCWxpc3RfZGVsKCZv
dXQtPmxpc3QpOworCW91dC0+b25fb3V0X2xpc3QgPSBmYWxzZTsKIAogCS8q
CiAJICogVXBkYXRlIGNvbm4tPnRpbWVvdXRfbXNlYyB3aXRoIHRoZSBuZXh0
IGZvdW5kIHRpbWVvdXQgdmFsdWUgaW4gdGhlCkBAIC0yNDEsNiArMjU0LDMw
IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0YShzdHJ1Y3QgYnVm
ZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJaWYgKG91dC0+aGRyLm1z
Zy50eXBlID09IFhTX1dBVENIX0VWRU5UKSB7CisJCXJlcSA9IG91dC0+cGVu
ZC5yZXE7CisJCWlmIChyZXEpIHsKKwkJCXJlcS0+cGVuZC5yZWYuZXZlbnRf
Y250LS07CisJCQlpZiAoIXJlcS0+cGVuZC5yZWYuZXZlbnRfY250ICYmICFy
ZXEtPm9uX291dF9saXN0KSB7CisJCQkJaWYgKHJlcS0+b25fcmVmX2xpc3Qp
IHsKKwkJCQkJZG9tYWluX291dHN0YW5kaW5nX2RvbWlkX2RlYygKKwkJCQkJ
CXJlcS0+cGVuZC5yZWYuZG9taWQpOworCQkJCQlsaXN0X2RlbCgmcmVxLT5s
aXN0KTsKKwkJCQl9CisJCQkJdGFsbG9jX2ZyZWUocmVxKTsKKwkJCX0KKwkJ
fQorCX0gZWxzZSBpZiAob3V0LT5wZW5kLnJlZi5ldmVudF9jbnQpIHsKKwkJ
LyogSGFuZyBvdXQgb2ZmIGZyb20gY29ubi4gKi8KKwkJdGFsbG9jX3N0ZWFs
KE5VTEwsIG91dCk7CisJCWlmIChvdXQtPmJ1ZmZlciAhPSBvdXQtPmRlZmF1
bHRfYnVmZmVyKQorCQkJdGFsbG9jX2ZyZWUob3V0LT5idWZmZXIpOworCQls
aXN0X2FkZCgmb3V0LT5saXN0LCAmY29ubi0+cmVmX2xpc3QpOworCQlvdXQt
Pm9uX3JlZl9saXN0ID0gdHJ1ZTsKKwkJcmV0dXJuOworCX0gZWxzZQorCQlk
b21haW5fb3V0c3RhbmRpbmdfZGVjKGNvbm4pOworCiAJdGFsbG9jX2ZyZWUo
b3V0KTsKIH0KIApAQCAtMzQ5LDYgKzM4Niw3IEBAIHN0YXRpYyBib29sIHdy
aXRlX21lc3NhZ2VzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQogc3RhdGlj
IGludCBkZXN0cm95X2Nvbm4odm9pZCAqX2Nvbm4pCiB7CiAJc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4gPSBfY29ubjsKKwlzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSAqcmVxOwogCiAJLyogRmx1c2ggb3V0Z29pbmcgaWYgcG9zc2libGUsIGJ1
dCBkb24ndCBibG9jay4gKi8KIAlpZiAoIWNvbm4tPmRvbWFpbikgewpAQCAt
MzYyLDYgKzQwMCwxMSBAQCBzdGF0aWMgaW50IGRlc3Ryb3lfY29ubih2b2lk
ICpfY29ubikKIAkJCQlicmVhazsKIAkJY2xvc2UoY29ubi0+ZmQpOwogCX0K
KworCWNvbm5fZnJlZV9idWZmZXJlZF9kYXRhKGNvbm4pOworCWxpc3RfZm9y
X2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxpc3QpCisJCXJl
cS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKKwogICAgICAgICBpZiAoY29ubi0+
dGFyZ2V0KQogICAgICAgICAgICAgICAgIHRhbGxvY191bmxpbmsoY29ubiwg
Y29ubi0+dGFyZ2V0KTsKIAlsaXN0X2RlbCgmY29ubi0+bGlzdCk7CkBAIC04
MDAsNiArODQzLDggQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAogCS8q
IFF1ZXVlIGZvciBsYXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRf
dGFpbCgmYmRhdGEtPmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CisJYmRhdGEt
Pm9uX291dF9saXN0ID0gdHJ1ZTsKKwlkb21haW5fb3V0c3RhbmRpbmdfaW5j
KGNvbm4pOwogfQogCiAvKgpAQCAtODA3LDcgKzg1Miw4IEBAIHZvaWQgc2Vu
ZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4c2Rfc29j
a21zZ190eXBlIHR5cGUsCiAgKiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSBy
ZWxhdGVkIHRvIHRoZSBjdXJyZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBi
ZQogICogcmVwb3J0ZWQuCiAgKi8KLXZvaWQgc2VuZF9ldmVudChzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwgY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hh
ciAqdG9rZW4pCit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGJ1ZmZlcmVkX2Rh
dGEgKnJlcSwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCWNvbnN0IGNo
YXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKQogewogCXN0cnVjdCBidWZm
ZXJlZF9kYXRhICpiZGF0YTsKIAl1bnNpZ25lZCBpbnQgbGVuOwpAQCAtODM3
LDggKzg4MywxMyBAQCB2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2Vu
KQogCQkJY29ubi0+dGltZW91dF9tc2VjID0gYmRhdGEtPnRpbWVvdXRfbXNl
YzsKIAl9CiAKKwliZGF0YS0+cGVuZC5yZXEgPSByZXE7CisJaWYgKHJlcSkK
KwkJcmVxLT5wZW5kLnJlZi5ldmVudF9jbnQrKzsKKwogCS8qIFF1ZXVlIGZv
ciBsYXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRfdGFpbCgmYmRh
dGEtPmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CisJYmRhdGEtPm9uX291dF9s
aXN0ID0gdHJ1ZTsKIH0KIAogLyogU29tZSByb3V0aW5lcyAod3JpdGUsIG1r
ZGlyLCBldGMpIGp1c3QgbmVlZCBhIG5vbi1lcnJvciByZXR1cm4gKi8KQEAg
LTE1NzQsNiArMTYyNSw3IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV9pbnB1dChz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKIAkJCXJldHVybjsKIAl9CiAJaW4g
PSBjb25uLT5pbjsKKwlpbi0+cGVuZC5yZWYuZG9taWQgPSBjb25uLT5pZDsK
IAogCS8qIE5vdCBmaW5pc2hlZCBoZWFkZXIgeWV0PyAqLwogCWlmIChpbi0+
aW5oZHIpIHsKQEAgLTE2NDQsNiArMTY5Niw3IEBAIHN0cnVjdCBjb25uZWN0
aW9uICpuZXdfY29ubmVjdGlvbihjb25ud3JpdGVmbl90ICp3cml0ZSwgY29u
bnJlYWRmbl90ICpyZWFkKQogCW5ldy0+aXNfaWdub3JlZCA9IGZhbHNlOwog
CW5ldy0+dHJhbnNhY3Rpb25fc3RhcnRlZCA9IDA7CiAJSU5JVF9MSVNUX0hF
QUQoJm5ldy0+b3V0X2xpc3QpOworCUlOSVRfTElTVF9IRUFEKCZuZXctPnJl
Zl9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmbmV3LT53YXRjaGVzKTsKIAlJ
TklUX0xJU1RfSEVBRCgmbmV3LT50cmFuc2FjdGlvbl9saXN0KTsKIApAQCAt
MjA3OSw2ICsyMTMyLDkgQEAgc3RhdGljIHZvaWQgdXNhZ2Uodm9pZCkKICIg
IC1XLCAtLXdhdGNoLW5iIDxuYj4gICAgIGxpbWl0IHRoZSBudW1iZXIgb2Yg
d2F0Y2hlcyBwZXIgZG9tYWluLFxuIgogIiAgLXQsIC0tdHJhbnNhY3Rpb24g
PG5iPiAgbGltaXQgdGhlIG51bWJlciBvZiB0cmFuc2FjdGlvbiBhbGxvd2Vk
IHBlciBkb21haW4sXG4iCiAiICAtQSwgLS1wZXJtLW5iIDxuYj4gICAgICBs
aW1pdCB0aGUgbnVtYmVyIG9mIHBlcm1pc3Npb25zIHBlciBub2RlLFxuIgor
IiAgLVEsIC0tcXVvdGEgPHdoYXQ+PTxuYj4gc2V0IHRoZSBxdW90YSA8d2hh
dD4gdG8gdGhlIHZhbHVlIDxuYj4sIGFsbG93ZWRcbiIKKyIgICAgICAgICAg
ICAgICAgICAgICAgICAgIHF1b3RhcyBhcmU6XG4iCisiICAgICAgICAgICAg
ICAgICAgICAgICAgICBvdXRzdGFuZGluZzogbnVtYmVyIG9mIG91dHN0YW5k
aW5nIHJlcXVlc3RzXG4iCiAiICAtdywgLS10aW1lb3V0IDx3aGF0Pj08c2Vj
b25kcz4gICBzZXQgdGhlIHRpbWVvdXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+
LFxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZCB0aW1l
b3V0IGNhbmRpZGF0ZXMgYXJlOlxuIgogIiAgICAgICAgICAgICAgICAgICAg
ICAgICAgd2F0Y2gtZXZlbnQ6IHRpbWUgYSB3YXRjaC1ldmVudCBpcyBrZXB0
IHBlbmRpbmdcbiIKQEAgLTIxMDMsNiArMjE1OSw3IEBAIHN0YXRpYyBzdHJ1
Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsKIAl7ICJ0cmFjZS1maWxlIiwgMSwg
TlVMTCwgJ1QnIH0sCiAJeyAidHJhbnNhY3Rpb24iLCAxLCBOVUxMLCAndCcg
fSwKIAl7ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCisJeyAicXVvdGEi
LCAxLCBOVUxMLCAnUScgfSwKIAl7ICJ0aW1lb3V0IiwgMSwgTlVMTCwgJ3cn
IH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAwLCBOVUxMLCAnUicgfSwKIAl7ICJp
bnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJJyB9LApAQCAtMjE0OCw2ICsyMjA1
LDIwIEBAIHN0YXRpYyB2b2lkIHNldF90aW1lb3V0KGNvbnN0IGNoYXIgKmFy
ZykKIAkJYmFyZigidW5rbm93biB0aW1lb3V0IFwiJXNcIlxuIiwgYXJnKTsK
IH0KIAorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNvbnN0IGNoYXIgKmFyZykK
K3sKKwljb25zdCBjaGFyICplcSA9IHN0cmNocihhcmcsICc9Jyk7CisJaW50
IHZhbDsKKworCWlmICghZXEpCisJCWJhcmYoInF1b3RhcyBtdXN0IGJlIHNw
ZWNpZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOworCXZhbCA9IGdldF9vcHR2
YWxfaW50KGVxICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRz
dGFuZGluZyIpKQorCQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7CisJ
ZWxzZQorCQliYXJmKCJ1bmtub3duIHF1b3RhIFwiJXNcIlxuIiwgYXJnKTsK
K30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIHsKIAlp
bnQgb3B0OwpAQCAtMjE1OSw3ICsyMjMwLDcgQEAgaW50IG1haW4oaW50IGFy
Z2MsIGNoYXIgKmFyZ3ZbXSkKIAlpbnQgdGltZW91dDsKIAogCi0Jd2hpbGUg
KChvcHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6
QTpUOlJWVzp3OiIsIG9wdGlvbnMsCisJd2hpbGUgKChvcHQgPSBnZXRvcHRf
bG9uZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6QTpROlQ6UlZXOnc6Iiwg
b3B0aW9ucywKIAkJCQkgIE5VTEwpKSAhPSAtMSkgewogCQlzd2l0Y2ggKG9w
dCkgewogCQljYXNlICdEJzoKQEAgLTIyMDQsNiArMjI3NSw5IEBAIGludCBt
YWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAJCWNhc2UgJ0EnOgogCQkJ
cXVvdGFfbmJfcGVybXNfcGVyX25vZGUgPSBzdHJ0b2wob3B0YXJnLCBOVUxM
LCAxMCk7CiAJCQlicmVhazsKKwkJY2FzZSAnUSc6CisJCQlzZXRfcXVvdGEo
b3B0YXJnKTsKKwkJCWJyZWFrOwogCQljYXNlICd3JzoKIAkJCXNldF90aW1l
b3V0KG9wdGFyZyk7CiAJCQlicmVhazsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfY29yZS5oCmluZGV4IDMxMTJjMTE4MTFlNS4uZWRlYWE5NmRkMTBi
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5o
CisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKQEAgLTQ1
LDYgKzQ1LDggQEAgdHlwZWRlZiBpbnQzMl90IHdybF9jcmVkaXR0Owogc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEKIHsKIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7
CisJYm9vbCBvbl9vdXRfbGlzdDsKKwlib29sIG9uX3JlZl9saXN0OwogCiAJ
LyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBoZWFkZXI/ICovCiAJYm9vbCBp
bmhkcjsKQEAgLTUyLDYgKzU0LDE3IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJdW5zaWduZWQgaW50IHVzZWQ7
CiAKKwkvKiBPdXRzdGFuZGluZyByZXF1ZXN0IGFjY291bnRpbmcuICovCisJ
dW5pb24geworCQkvKiByZWYgaXMgYmVpbmcgdXNlZCBmb3IgcmVxdWVzdHMu
ICovCisJCXN0cnVjdCB7CisJCQl1bnNpZ25lZCBpbnQgZXZlbnRfY250OyAv
KiAjIG9mIG91dHN0YW5kaW5nIGV2ZW50cy4gKi8KKwkJCXVuc2lnbmVkIGlu
dCBkb21pZDsgICAgIC8qIGRvbWlkIG9mIHJlcXVlc3QuICovCisJCX0gcmVm
OworCQkvKiByZXEgaXMgYmVpbmcgdXNlZCBmb3Igd2F0Y2ggZXZlbnRzLiAq
LworCQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOyAgICAgIC8qIHJlcXVl
c3QgY2F1c2luZyBldmVudC4gKi8KKwl9IHBlbmQ7CisKIAl1bmlvbiB7CiAJ
CXN0cnVjdCB4c2Rfc29ja21zZyBtc2c7CiAJCWNoYXIgcmF3W3NpemVvZihz
dHJ1Y3QgeHNkX3NvY2ttc2cpXTsKQEAgLTkzLDYgKzEwNiw5IEBAIHN0cnVj
dCBjb25uZWN0aW9uCiAJc3RydWN0IGxpc3RfaGVhZCBvdXRfbGlzdDsKIAl1
aW50NjRfdCB0aW1lb3V0X21zZWM7CiAKKwkvKiBSZWZlcmVuY2VkIHJlcXVl
c3RzIG5vIGxvbmdlciBwZW5kaW5nLiAqLworCXN0cnVjdCBsaXN0X2hlYWQg
cmVmX2xpc3Q7CisKIAkvKiBUcmFuc2FjdGlvbiBjb250ZXh0IGZvciBjdXJy
ZW50IHJlcXVlc3QgKE5VTEwgaWYgbm9uZSkuICovCiAJc3RydWN0IHRyYW5z
YWN0aW9uICp0cmFuc2FjdGlvbjsKIApAQCAtMTU0LDcgKzE3MCw4IEBAIHVu
c2lnbmVkIGludCBnZXRfc3RyaW5ncyhzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAq
ZGF0YSwKIAogdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAkJY29uc3Qgdm9p
ZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbik7Ci12b2lkIHNlbmRfZXZlbnQo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IGNoYXIgKnBhdGgsIGNv
bnN0IGNoYXIgKnRva2VuKTsKK3ZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgYnVm
ZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJ
Y29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pOwogCiAvKiBT
b21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0YykganVzdCBuZWVkIGEg
bm9uLWVycm9yIHJldHVybiAqLwogdm9pZCBzZW5kX2FjayhzdHJ1Y3QgY29u
bmVjdGlvbiAqY29ubiwgZW51bSB4c2Rfc29ja21zZ190eXBlIHR5cGUpOwpA
QCAtMjAyLDYgKzIxOSw3IEBAIGV4dGVybiBpbnQgZG9tMF9kb21pZDsKIGV4
dGVybiBpbnQgZG9tMF9ldmVudDsKIGV4dGVybiBpbnQgcHJpdl9kb21pZDsK
IGV4dGVybiBpbnQgcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbjsKK2V4dGVy
biBpbnQgcXVvdGFfcmVxX291dHN0YW5kaW5nOwogCiBleHRlcm4gdW5zaWdu
ZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDNiZmYzMjJkMDI0
ZC4uMmRkODBlYjFhN2JiIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2RvbWFpbi5jCkBAIC04Miw2ICs4Miw5IEBAIHN0cnVjdCBkb21haW4K
IAkvKiBudW1iZXIgb2Ygd2F0Y2ggZm9yIHRoaXMgZG9tYWluICovCiAJaW50
IG5id2F0Y2g7CiAKKwkvKiBOdW1iZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVz
dHMuICovCisJaW50IG5ib3V0c3RhbmRpbmc7CisKIAkvKiB3cml0ZSByYXRl
IGxpbWl0ICovCiAJd3JsX2NyZWRpdHQgd3JsX2NyZWRpdDsgLyogWyAtd3Js
X2NvbmZpZ193cml0ZWNvc3QsICtfZGJ1cnN0IF0gKi8KIAlzdHJ1Y3Qgd3Js
X3RpbWVzdGFtcHQgd3JsX3RpbWVzdGFtcDsKQEAgLTI4NCw4ICsyODcsMTIg
QEAgYm9vbCBkb21haW5fY2FuX3JlYWQoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4pCiB7CiAJc3RydWN0IHhlbnN0b3JlX2RvbWFpbl9pbnRlcmZhY2UgKmlu
dGYgPSBjb25uLT5kb21haW4tPmludGVyZmFjZTsKIAotCWlmIChkb21haW5f
aXNfdW5wcml2aWxlZ2VkKGNvbm4pICYmIGNvbm4tPmRvbWFpbi0+d3JsX2Ny
ZWRpdCA8IDApCi0JCXJldHVybiBmYWxzZTsKKwlpZiAoZG9tYWluX2lzX3Vu
cHJpdmlsZWdlZChjb25uKSkgeworCQlpZiAoY29ubi0+ZG9tYWluLT53cmxf
Y3JlZGl0IDwgMCkKKwkJCXJldHVybiBmYWxzZTsKKwkJaWYgKGNvbm4tPmRv
bWFpbi0+bmJvdXRzdGFuZGluZyA+PSBxdW90YV9yZXFfb3V0c3RhbmRpbmcp
CisJCQlyZXR1cm4gZmFsc2U7CisJfQogCiAJaWYgKGNvbm4tPmlzX2lnbm9y
ZWQpCiAJCXJldHVybiBmYWxzZTsKQEAgLTMzNCw3ICszNDEsNyBAQCBzdGF0
aWMgc3RydWN0IGRvbWFpbiAqYWxsb2NfZG9tYWluKHZvaWQgKmNvbnRleHQs
IHVuc2lnbmVkIGludCBkb21pZCkKIHsKIAlzdHJ1Y3QgZG9tYWluICpkb21h
aW47CiAKLQlkb21haW4gPSB0YWxsb2MoY29udGV4dCwgc3RydWN0IGRvbWFp
bik7CisJZG9tYWluID0gdGFsbG9jX3plcm8oY29udGV4dCwgc3RydWN0IGRv
bWFpbik7CiAJaWYgKCFkb21haW4pIHsKIAkJZXJybm8gPSBFTk9NRU07CiAJ
CXJldHVybiBOVUxMOwpAQCAtMzgzLDggKzM5MCw2IEBAIHN0YXRpYyBpbnQg
bmV3X2RvbWFpbihzdHJ1Y3QgZG9tYWluICpkb21haW4sIGludCBwb3J0KQog
CWRvbWFpbi0+Y29ubi0+aWQgPSBkb21haW4tPmRvbWlkOwogCiAJZG9tYWlu
LT5yZW1vdGVfcG9ydCA9IHBvcnQ7Ci0JZG9tYWluLT5uYmVudHJ5ID0gMDsK
LQlkb21haW4tPm5id2F0Y2ggPSAwOwogCiAJcmV0dXJuIDA7CiB9CkBAIC05
MjIsNiArOTI3LDI4IEBAIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiAJCTogMDsKIH0KIAordm9pZCBkb21haW5fb3V0c3Rh
bmRpbmdfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQoreworCWlmICgh
Y29ubiB8fCAhY29ubi0+ZG9tYWluKQorCQlyZXR1cm47CisJY29ubi0+ZG9t
YWluLT5uYm91dHN0YW5kaW5nKys7Cit9CisKK3ZvaWQgZG9tYWluX291dHN0
YW5kaW5nX2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKK3sKKwlpZiAo
IWNvbm4gfHwgIWNvbm4tPmRvbWFpbikKKwkJcmV0dXJuOworCWNvbm4tPmRv
bWFpbi0+bmJvdXRzdGFuZGluZy0tOworfQorCit2b2lkIGRvbWFpbl9vdXRz
dGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKQoreworCXN0
cnVjdCBkb21haW4gKmQgPSBmaW5kX2RvbWFpbl9ieV9kb21pZChkb21pZCk7
CisKKwlpZiAoZCkKKwkJZC0+bmJvdXRzdGFuZGluZy0tOworfQorCiBzdGF0
aWMgd3JsX2NyZWRpdHQgd3JsX2NvbmZpZ193cml0ZWNvc3QgICAgICA9IFdS
TF9GQUNUT1I7CiBzdGF0aWMgd3JsX2NyZWRpdHQgd3JsX2NvbmZpZ19yYXRl
ICAgICAgICAgICA9IFdSTF9SQVRFICAgKiBXUkxfRkFDVE9SOwogc3RhdGlj
IHdybF9jcmVkaXR0IHdybF9jb25maWdfZGJ1cnN0ICAgICAgICAgPSBXUkxf
REJVUlNUICogV1JMX0ZBQ1RPUjsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9kb21haW4uaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uaAppbmRleCA1ZTAwMDg3MjA2YzcuLjRiZmYyZTY1NWI5
YiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFp
bi5oCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaApA
QCAtNjcsNiArNjcsOSBAQCBpbnQgZG9tYWluX2VudHJ5KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uKTsKIHZvaWQgZG9tYWluX3dhdGNoX2luYyhzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubik7CiB2b2lkIGRvbWFpbl93YXRjaF9kZWMoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogaW50IGRvbWFpbl93YXRjaChzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubik7Cit2b2lkIGRvbWFpbl9vdXRzdGFuZGlu
Z19pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pOwordm9pZCBkb21haW5f
b3V0c3RhbmRpbmdfZGVjKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKK3Zv
aWQgZG9tYWluX291dHN0YW5kaW5nX2RvbWlkX2RlYyh1bnNpZ25lZCBpbnQg
ZG9taWQpOwogCiAvKiBTcGVjaWFsIG5vZGUgcGVybWlzc2lvbiBoYW5kbGlu
Zy4gKi8KIGludCBzZXRfcGVybXNfc3BlY2lhbChzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubiwgY29uc3QgY2hhciAqbmFtZSwKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggMmY5MzY3NzY3ZTQ0Li5jNTBjMDU3
NWYwZjEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5j
CkBAIC0xNDIsNiArMTQyLDcgQEAgdm9pZCBmaXJlX3dhdGNoZXMoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwgY29uc3QgY2hh
ciAqbmFtZSwKIAkJICBzdHJ1Y3Qgbm9kZSAqbm9kZSwgYm9vbCBleGFjdCwg
c3RydWN0IG5vZGVfcGVybXMgKnBlcm1zKQogewogCXN0cnVjdCBjb25uZWN0
aW9uICppOworCXN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXE7CiAJc3RydWN0
IHdhdGNoICp3YXRjaDsKIAogCS8qIER1cmluZyB0cmFuc2FjdGlvbnMsIGRv
bid0IGZpcmUgd2F0Y2hlcywgYnV0IHF1ZXVlIHRoZW0uICovCkBAIC0xNTAs
NiArMTUxLDggQEAgdm9pZCBmaXJlX3dhdGNoZXMoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwK
IAkJcmV0dXJuOwogCX0KIAorCXJlcSA9IGRvbWFpbl9pc191bnByaXZpbGVn
ZWQoY29ubikgPyBjb25uLT5pbiA6IE5VTEw7CisKIAkvKiBDcmVhdGUgYW4g
ZXZlbnQgZm9yIGVhY2ggd2F0Y2guICovCiAJbGlzdF9mb3JfZWFjaF9lbnRy
eShpLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsKIAkJLyogaW50cm9kdWNlL3Jl
bGVhc2UgZG9tYWluIHdhdGNoZXMgKi8KQEAgLTE2NCwxMiArMTY3LDEyIEBA
IHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBj
b25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCWxpc3RfZm9y
X2VhY2hfZW50cnkod2F0Y2gsICZpLT53YXRjaGVzLCBsaXN0KSB7CiAJCQlp
ZiAoZXhhY3QpIHsKIAkJCQlpZiAoc3RyZXEobmFtZSwgd2F0Y2gtPm5vZGUp
KQotCQkJCQlzZW5kX2V2ZW50KGksCisJCQkJCXNlbmRfZXZlbnQocmVxLCBp
LAogCQkJCQkJICAgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIG5hbWUpLAogCQkJ
CQkJICAgd2F0Y2gtPnRva2VuKTsKIAkJCX0gZWxzZSB7CiAJCQkJaWYgKGlz
X2NoaWxkKG5hbWUsIHdhdGNoLT5ub2RlKSkKLQkJCQkJc2VuZF9ldmVudChp
LAorCQkJCQlzZW5kX2V2ZW50KHJlcSwgaSwKIAkJCQkJCSAgIGdldF93YXRj
aF9wYXRoKHdhdGNoLCBuYW1lKSwKIAkJCQkJCSAgIHdhdGNoLT50b2tlbik7
CiAJCQl9CkBAIC0yMzgsOCArMjQxLDEyIEBAIGludCBkb193YXRjaChzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmlu
KQogCXRhbGxvY19zZXRfZGVzdHJ1Y3Rvcih3YXRjaCwgZGVzdHJveV93YXRj
aCk7CiAJc2VuZF9hY2soY29ubiwgWFNfV0FUQ0gpOwogCi0JLyogV2UgZmly
ZSBvbmNlIHVwIGZyb250OiBzaW1wbGlmaWVzIGNsaWVudHMgYW5kIHJlc3Rh
cnQuICovCi0Jc2VuZF9ldmVudChjb25uLCBnZXRfd2F0Y2hfcGF0aCh3YXRj
aCwgd2F0Y2gtPm5vZGUpLCB3YXRjaC0+dG9rZW4pOworCS8qCisJICogV2Ug
ZmlyZSBvbmNlIHVwIGZyb250OiBzaW1wbGlmaWVzIGNsaWVudHMgYW5kIHJl
c3RhcnQuCisJICogVGhpcyBldmVudCB3aWxsIG5vdCBiZSBsaW5rZWQgdG8g
dGhlIFhTX1dBVENIIHJlcXVlc3QuCisJICovCisJc2VuZF9ldmVudChOVUxM
LCBjb25uLCBnZXRfd2F0Y2hfcGF0aCh3YXRjaCwgd2F0Y2gtPm5vZGUpLAor
CQkgICB3YXRjaC0+dG9rZW4pOwogCiAJcmV0dXJuIDA7CiB9Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSAzOTAwYmI0MzUwM2Y5OGM0YjUyY2IxOTRlMGY0YmEzYWVkZTg4OWU0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGRvbid0IGJ1
ZmZlciBtdWx0aXBsZSBpZGVudGljYWwgd2F0Y2ggZXZlbnRzCgpBIGd1ZXN0
IG5vdCByZWFkaW5nIGl0cyBYZW5zdG9yZSByZXNwb25zZSBidWZmZXIgZmFz
dCBlbm91Z2ggbWlnaHQKcGlsZSB1cCBsb3RzIG9mIFhlbnN0b3JlIHdhdGNo
IGV2ZW50cyBidWZmZXJlZC4gUmVkdWNlIHRoZSBnZW5lcmF0ZWQKbG9hZCBi
eSBkcm9wcGluZyBuZXcgZXZlbnRzIHdoaWNoIGFscmVhZHkgaGF2ZSBhbiBp
ZGVudGljYWwgY29weQpwZW5kaW5nLgoKVGhlIHNwZWNpYWwgZXZlbnRzICJA
Li4uIiBhcmUgZXhjbHVkZWQgZnJvbSB0aGF0IGhhbmRsaW5nIGFzIHRoZXJl
IGFyZQprbm93biB1c2UgY2FzZXMgd2hlcmUgdGhlIGhhbmRsZXIgaXMgcmVs
eWluZyBvbiBlYWNoIGV2ZW50IHRvIGJlIHNlbnQKaW5kaXZpZHVhbGx5LgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCAyZWQ5MWQxMzI5N2IuLmM2ZjFk
NDE4OWNmZSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CkBAIC04MjMsNiArODIzLDcgQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwK
IAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0gMDsKIAli
ZGF0YS0+dGltZW91dF9tc2VjID0gMDsKKwliZGF0YS0+d2F0Y2hfZXZlbnQg
PSBmYWxzZTsKIAogCWlmIChsZW4gPD0gREVGQVVMVF9CVUZGRVJfU0laRSkK
IAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZhdWx0X2J1ZmZlcjsKQEAg
LTg1NSw3ICs4NTYsNyBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAogdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQljb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp0b2tlbikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRh
dGE7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLCAqYmQ7CiAJdW5z
aWduZWQgaW50IGxlbjsKIAogCWxlbiA9IHN0cmxlbihwYXRoKSArIDEgKyBz
dHJsZW4odG9rZW4pICsgMTsKQEAgLTg3NywxMiArODc4LDI5IEBAIHZvaWQg
c2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKIAliZGF0YS0+aGRyLm1zZy50eXBlID0gWFNf
V0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVuOwogCisJ
LyoKKwkgKiBDaGVjayB3aGV0aGVyIGFuIGlkZW50aWNhbCBldmVudCBpcyBw
ZW5kaW5nIGFscmVhZHkuCisJICogU3BlY2lhbCBldmVudHMgYXJlIGV4Y2x1
ZGVkIGZyb20gdGhhdCBjaGVjay4KKwkgKi8KKwlpZiAocGF0aFswXSAhPSAn
QCcpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShiZCwgJmNvbm4tPm91dF9s
aXN0LCBsaXN0KSB7CisJCQlpZiAoYmQtPndhdGNoX2V2ZW50ICYmIGJkLT5o
ZHIubXNnLmxlbiA9PSBsZW4gJiYKKwkJCSAgICAhbWVtY21wKGJkYXRhLT5i
dWZmZXIsIGJkLT5idWZmZXIsIGxlbikpIHsKKwkJCQl0cmFjZSgiZHJvcHBp
bmcgZHVwbGljYXRlIHdhdGNoICVzICVzIGZvciBkb21haW4gJXVcbiIsCisJ
CQkJICAgICAgcGF0aCwgdG9rZW4sIGNvbm4tPmlkKTsKKwkJCQl0YWxsb2Nf
ZnJlZShiZGF0YSk7CisJCQkJcmV0dXJuOworCQkJfQorCQl9CisJfQorCiAJ
aWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5faXNfdW5w
cml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21zZWMgPSBn
ZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIAkJ
aWYgKCFjb25uLT50aW1lb3V0X21zZWMpCiAJCQljb25uLT50aW1lb3V0X21z
ZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOwogCX0KIAorCWJkYXRhLT53YXRj
aF9ldmVudCA9IHRydWU7CiAJYmRhdGEtPnBlbmQucmVxID0gcmVxOwogCWlm
IChyZXEpCiAJCXJlcS0+cGVuZC5yZWYuZXZlbnRfY250Kys7CmRpZmYgLS1n
aXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBlZGVhYTk2ZGQxMGIu
LjFlYjYxMzFmYzg4ZCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCkBAIC01MSw2ICs1MSw5IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBoZWFkZXI/ICovCiAJYm9v
bCBpbmhkcjsKIAorCS8qIElzIHRoaXMgYSB3YXRjaCBldmVudD8gKi8KKwli
b29sIHdhdGNoX2V2ZW50OworCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSA5ZWRmZDdmYWIxMTE4MzNmYmExZDZlYTVkMjZmZDE0NzFjMDkwZTgz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGZpeCBjb25u
ZWN0aW9uLT5pZCB1c2FnZQoKRG9uJ3QgdXNlIGNvbm4tPmlkIGZvciBwcml2
aWxlZ2UgY2hlY2tzLCBidXQgZG9tYWluX2lzX3VucHJpdmlsZWdlZCgpLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvbnRyb2wuYwppbmRleCA4ZDQ4YWI0ODIwMWIu
LmJjZTY2NjJmNmU0NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvbnRyb2wuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCkBAIC0xOTgsNyArMTk4LDcgQEAgaW50IGRvX2NvbnRy
b2woc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9k
YXRhICppbikKIAlpbnQgY21kOwogCWNoYXIgKip2ZWM7CiAKLQlpZiAoY29u
bi0+aWQgIT0gMCkKKwlpZiAoZG9tYWluX2lzX3VucHJpdmlsZWdlZChjb25u
KSkKIAkJcmV0dXJuIEVBQ0NFUzsKIAogCW51bSA9IHhzX2NvdW50X3N0cmlu
Z3MoaW4tPmJ1ZmZlciwgaW4tPnVzZWQpOwpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmgKaW5kZXggMWViNjEzMWZjODhkLi45OGRiNGFmY2Fh
YmYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAt
OTMsNyArOTMsNyBAQCBzdHJ1Y3QgY29ubmVjdGlvbgogCS8qIFRoZSBpbmRl
eCBvZiBwb2xsZmQgaW4gZ2xvYmFsIHBvbGxmZCBhcnJheSAqLwogCWludCBw
b2xsZmRfaWR4OwogCi0JLyogV2hvIGFtIEk/IDAgZm9yIHNvY2tldCBjb25u
ZWN0aW9ucy4gKi8KKwkvKiBXaG8gYW0gST8gRG9taWQgb2YgY29ubmVjdGlv
bi4gKi8KIAl1bnNpZ25lZCBpbnQgaWQ7CiAKIAkvKiBJcyB0aGlzIGEgcmVh
ZC1vbmx5IGNvbm5lY3Rpb24/ICovCmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IDZmYmRiMjlkY2RkNy4u
OWJlZjZlNzJhNTY2IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNDgzLDcgKzQ4Myw4IEBAIGludCBk
b190cmFuc2FjdGlvbl9zdGFydChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmluKQogCWlmIChjb25uLT50cmFuc2Fj
dGlvbikKIAkJcmV0dXJuIEVCVVNZOwogCi0JaWYgKGNvbm4tPmlkICYmIGNv
bm4tPnRyYW5zYWN0aW9uX3N0YXJ0ZWQgPiBxdW90YV9tYXhfdHJhbnNhY3Rp
b24pCisJaWYgKGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYKKwkg
ICAgY29ubi0+dHJhbnNhY3Rpb25fc3RhcnRlZCA+IHF1b3RhX21heF90cmFu
c2FjdGlvbikKIAkJcmV0dXJuIEVOT1NQQzsKIAogCS8qIEF0dGFjaCB0cmFu
c2FjdGlvbiB0byBpbnB1dCBmb3IgYXV0b2ZyZWUgdW50aWwgaXQncyBjb21w
bGV0ZSAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSA1YWI4OTMwOGY0NjQ1MjU2NzQyNWNiMzJhODQzZjlmMzdlZDQ1ODhi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNpbXBsaWZ5
IGFuZCBmaXggcGVyIGRvbWFpbiBub2RlIGFjY291bnRpbmcKClRoZSBhY2Nv
dW50aW5nIG9mIG5vZGVzIGNhbiBiZSBzaW1wbGlmaWVkIG5vdyB0aGF0IGVh
Y2ggY29ubmVjdGlvbgpob2xkcyB0aGUgYXNzb2NpYXRlZCBkb21pZC4KCkZp
eCB0aGUgbm9kZSBhY2NvdW50aW5nIHRvIGNvdmVyIG5vZGVzIGNyZWF0ZWQg
Zm9yIGEgZG9tYWluIGJlZm9yZSBpdApoYXMgYmVlbiBpbnRyb2R1Y2VkLiBU
aGlzIHJlcXVpcmVzIHRvIHJlYWN0IHByb3Blcmx5IHRvIGFuIGFsbG9jYXRp
b24KZmFpbHVyZSBpbnNpZGUgZG9tYWluX2VudHJ5X2luYygpIGJ5IHJldHVy
bmluZyBhbiBlcnJvciBjb2RlLgoKRXNwZWNpYWxseSBpbiBlcnJvciBwYXRo
cyB0aGUgbm9kZSBhY2NvdW50aW5nIGhhcyB0byBiZSBmaXhlZCBpbiBzb21l
CmNhc2VzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYgLyBDVkUtMjAyMi00
MjMxMy4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6
b24uY29tPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29u
dHJvbC5jCmluZGV4IGJjZTY2NjJmNmU0NS4uYWIwNzk0ZGVlZGM4IDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMKQEAgLTI1
LDYgKzI1LDcgQEAKICNpbmNsdWRlICJ0YWxsb2MuaCIKICNpbmNsdWRlICJ4
ZW5zdG9yZWRfY29yZS5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF9jb250cm9s
LmgiCisjaW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgogCiBzdHJ1Y3Qg
Y21kX3MgewogCWNoYXIgKmNtZDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5jCmluZGV4IGM2ZjFkNDE4OWNmZS4uMTJkMDEzZDI0OTQ5IDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTU0NSw3
ICs1NDUsNyBAQCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBQZXJtaXNz
aW9ucyBhcmUgc3RydWN0IHhzX3Blcm1pc3Npb25zLiAqLwogCW5vZGUtPnBl
cm1zLnAgPSBoZHItPnBlcm1zOwotCWlmIChkb21haW5fYWRqdXN0X25vZGVf
cGVybXMobm9kZSkpIHsKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1z
KGNvbm4sIG5vZGUpKSB7CiAJCXRhbGxvY19mcmVlKG5vZGUpOwogCQlyZXR1
cm4gTlVMTDsKIAl9CkBAIC01NjcsNyArNTY3LDcgQEAgaW50IHdyaXRlX25v
ZGVfcmF3KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5
LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAl2b2lkICpwOwogCXN0cnVjdCB4c190
ZGJfcmVjb3JkX2hkciAqaGRyOwogCi0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhub2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1z
KGNvbm4sIG5vZGUpKQogCQlyZXR1cm4gZXJybm87CiAKIAlkYXRhLmRzaXpl
ID0gc2l6ZW9mKCpoZHIpCkBAIC0xMTYxLDEzICsxMTYxLDE3IEBAIHN0YXRp
YyBzdHJ1Y3Qgbm9kZSAqY29uc3RydWN0X25vZGUoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0K
IAotc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQorc3RhdGljIHZvaWQgZGVzdHJv
eV9ub2RlX3JtKHN0cnVjdCBub2RlICpub2RlKQogewogCWlmIChzdHJlcShu
b2RlLT5uYW1lLCAiLyIpKQogCQljb3JydXB0KE5VTEwsICJEZXN0cm95aW5n
IHJvb3Qgbm9kZSEiKTsKIAogCXRkYl9kZWxldGUodGRiX2N0eCwgbm9kZS0+
a2V5KTsKK30KIAorc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoreworCWRlc3Ry
b3lfbm9kZV9ybShub2RlKTsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5v
ZGUpOwogCiAJLyoKQEAgLTEyMTcsOCArMTIyMSwxMiBAQCBzdGF0aWMgc3Ry
dWN0IG5vZGUgKmNyZWF0ZV9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LCBjb25zdCB2b2lkICpjdHgsCiAJCQlnb3RvIGVycjsKIAogCQkvKiBBY2Nv
dW50IGZvciBuZXcgbm9kZSAqLwotCQlpZiAoaS0+cGFyZW50KQotCQkJZG9t
YWluX2VudHJ5X2luYyhjb25uLCBpKTsKKwkJaWYgKGktPnBhcmVudCkgewor
CQkJaWYgKGRvbWFpbl9lbnRyeV9pbmMoY29ubiwgaSkpIHsKKwkJCQlkZXN0
cm95X25vZGVfcm0oaSk7CisJCQkJcmV0dXJuIE5VTEw7CisJCQl9CisJCX0K
IAl9CiAKIAlyZXR1cm4gbm9kZTsKQEAgLTE0OTksMTAgKzE1MDcsMjcgQEAg
c3RhdGljIGludCBkb19zZXRfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAlvbGRfcGVybXMgPSBu
b2RlLT5wZXJtczsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwog
CW5vZGUtPnBlcm1zID0gcGVybXM7Ci0JZG9tYWluX2VudHJ5X2luYyhjb25u
LCBub2RlKTsKKwlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKSkg
eworCQlub2RlLT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyoKKwkJICogVGhp
cyBzaG91bGQgbmV2ZXIgZmFpbCBiZWNhdXNlIHdlIGhhZCBhIHJlZmVyZW5j
ZSBvbiB0aGUKKwkJICogZG9tYWluIGJlZm9yZSBhbmQgWGVuc3RvcmVkIGlz
IHNpbmdsZS10aHJlYWRlZC4KKwkJICovCisJCWRvbWFpbl9lbnRyeV9pbmMo
Y29ubiwgbm9kZSk7CisJCXJldHVybiBFTk9NRU07CisJfQogCi0JaWYgKHdy
aXRlX25vZGUoY29ubiwgbm9kZSwgZmFsc2UpKQorCWlmICh3cml0ZV9ub2Rl
KGNvbm4sIG5vZGUsIGZhbHNlKSkgeworCQlpbnQgc2F2ZWRfZXJybm8gPSBl
cnJubzsKKworCQlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOworCQlu
b2RlLT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyogTm8gZmFpbHVyZSBwb3Nz
aWJsZSBhcyBhYm92ZS4gKi8KKwkJZG9tYWluX2VudHJ5X2luYyhjb25uLCBu
b2RlKTsKKworCQllcnJubyA9IHNhdmVkX2Vycm5vOwogCQlyZXR1cm4gZXJy
bm87CisJfQogCiAJZmlyZV93YXRjaGVzKGNvbm4sIGluLCBuYW1lLCBub2Rl
LCBmYWxzZSwgJm9sZF9wZXJtcyk7CiAJc2VuZF9hY2soY29ubiwgWFNfU0VU
X1BFUk1TKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9kb21haW4uYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4u
YwppbmRleCAyZGQ4MGViMWE3YmIuLjMwNmUxMjM1OGJmOSAxMDA2NDQKLS0t
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwpAQCAtMTYsNiArMTYs
NyBAQAogICAgIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNl
ZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCiAqLwogCisjaW5j
bHVkZSA8YXNzZXJ0Lmg+CiAjaW5jbHVkZSA8c3RkaW8uaD4KICNpbmNsdWRl
IDxzeXMvbW1hbi5oPgogI2luY2x1ZGUgPHVuaXN0ZC5oPgpAQCAtMzU4LDYg
KzM1OSwxOCBAQCBzdGF0aWMgc3RydWN0IGRvbWFpbiAqYWxsb2NfZG9tYWlu
KHZvaWQgKmNvbnRleHQsIHVuc2lnbmVkIGludCBkb21pZCkKIAlyZXR1cm4g
ZG9tYWluOwogfQogCitzdGF0aWMgc3RydWN0IGRvbWFpbiAqZmluZF9vcl9h
bGxvY19leGlzdGluZ19kb21haW4odW5zaWduZWQgaW50IGRvbWlkKQorewor
CXN0cnVjdCBkb21haW4gKmRvbWFpbjsKKwl4Y19kb21pbmZvX3QgZG9taW5m
bzsKKworCWRvbWFpbiA9IGZpbmRfZG9tYWluX3N0cnVjdChkb21pZCk7CisJ
aWYgKCFkb21haW4gJiYgZ2V0X2RvbWFpbl9pbmZvKGRvbWlkLCAmZG9taW5m
bykpCisJCWRvbWFpbiA9IGFsbG9jX2RvbWFpbihOVUxMLCBkb21pZCk7CisK
KwlyZXR1cm4gZG9tYWluOworfQorCiBzdGF0aWMgaW50IG5ld19kb21haW4o
c3RydWN0IGRvbWFpbiAqZG9tYWluLCBpbnQgcG9ydCkKIHsKIAlpbnQgcmM7
CkBAIC03NjcsMzAgKzc4MCwyOCBAQCB2b2lkIGRvbWFpbl9pbml0KHZvaWQp
CiAJdmlycV9wb3J0ID0gcmM7CiB9CiAKLXZvaWQgZG9tYWluX2VudHJ5X2lu
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKm5vZGUp
CitpbnQgZG9tYWluX2VudHJ5X2luYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgc3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJc3RydWN0IGRvbWFpbiAqZDsK
Kwl1bnNpZ25lZCBpbnQgZG9taWQ7CiAKIAlpZiAoIWNvbm4pCi0JCXJldHVy
bjsKKwkJcmV0dXJuIDA7CiAKLQlpZiAobm9kZS0+cGVybXMucCAmJiBub2Rl
LT5wZXJtcy5wWzBdLmlkICE9IGNvbm4tPmlkKSB7Ci0JCWlmIChjb25uLT50
cmFuc2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfaW5jKGNvbm4t
PnRyYW5zYWN0aW9uLAotCQkJCW5vZGUtPnBlcm1zLnBbMF0uaWQpOwotCQl9
IGVsc2UgewotCQkJZCA9IGZpbmRfZG9tYWluX2J5X2RvbWlkKG5vZGUtPnBl
cm1zLnBbMF0uaWQpOwotCQkJaWYgKGQpCi0JCQkJZC0+bmJlbnRyeSsrOwot
CQl9Ci0JfSBlbHNlIGlmIChjb25uLT5kb21haW4pIHsKLQkJaWYgKGNvbm4t
PnRyYW5zYWN0aW9uKSB7Ci0JCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29u
bi0+dHJhbnNhY3Rpb24sCi0JCQkJY29ubi0+ZG9tYWluLT5kb21pZCk7Ci0g
CQl9IGVsc2UgewotIAkJCWNvbm4tPmRvbWFpbi0+bmJlbnRyeSsrOwotCQl9
CisJZG9taWQgPSBub2RlLT5wZXJtcy5wID8gbm9kZS0+cGVybXMucFswXS5p
ZCA6IGNvbm4tPmlkOworCisJaWYgKGNvbm4tPnRyYW5zYWN0aW9uKSB7CisJ
CXRyYW5zYWN0aW9uX2VudHJ5X2luYyhjb25uLT50cmFuc2FjdGlvbiwgZG9t
aWQpOworCX0gZWxzZSB7CisJCWQgPSAoZG9taWQgPT0gY29ubi0+aWQgJiYg
Y29ubi0+ZG9tYWluKSA/IGNvbm4tPmRvbWFpbgorCQkgICAgOiBmaW5kX29y
X2FsbG9jX2V4aXN0aW5nX2RvbWFpbihkb21pZCk7CisJCWlmIChkKQorCQkJ
ZC0+bmJlbnRyeSsrOworCQllbHNlCisJCQlyZXR1cm4gRU5PTUVNOwogCX0K
KworCXJldHVybiAwOwogfQogCiAvKgpAQCAtODI2LDcgKzgzNyw3IEBAIHN0
YXRpYyBpbnQgY2hrX2RvbWFpbl9nZW5lcmF0aW9uKHVuc2lnbmVkIGludCBk
b21pZCwgdWludDY0X3QgZ2VuKQogICogUmVtb3ZlIHBlcm1pc3Npb25zIGZv
ciBubyBsb25nZXIgZXhpc3RpbmcgZG9tYWlucyBpbiBvcmRlciB0byBhdm9p
ZCBhIG5ldwogICogZG9tYWluIHdpdGggdGhlIHNhbWUgZG9taWQgaW5oZXJp
dGluZyB0aGUgcGVybWlzc2lvbnMuCiAgKi8KLWludCBkb21haW5fYWRqdXN0
X25vZGVfcGVybXMoc3RydWN0IG5vZGUgKm5vZGUpCitpbnQgZG9tYWluX2Fk
anVzdF9ub2RlX3Blcm1zKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1
Y3Qgbm9kZSAqbm9kZSkKIHsKIAl1bnNpZ25lZCBpbnQgaTsKIAlpbnQgcmV0
OwpAQCAtODM2LDggKzg0NywxNCBAQCBpbnQgZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKHN0cnVjdCBub2RlICpub2RlKQogCQlyZXR1cm4gZXJybm87CiAK
IAkvKiBJZiB0aGUgb3duZXIgZG9lc24ndCBleGlzdCBhbnkgbG9uZ2VyIGdp
dmUgaXQgdG8gcHJpdiBkb21haW4uICovCi0JaWYgKCFyZXQpCisJaWYgKCFy
ZXQpIHsKKwkJLyoKKwkJICogSW4gdGhlb3J5IHdlJ2QgbmVlZCB0byB1cGRh
dGUgdGhlIG51bWJlciBvZiBkb20wIG5vZGVzIGhlcmUsCisJCSAqIGJ1dCB3
ZSBjb3VsZCBiZSBjYWxsZWQgZm9yIGEgcmVhZCBvZiB0aGUgbm9kZS4gU28g
YmV0dGVyCisJCSAqIGF2b2lkIHRoZSByaXNrIHRvIG92ZXJmbG93IHRoZSBu
b2RlIGNvdW50IG9mIGRvbTAuCisJCSAqLwogCQlub2RlLT5wZXJtcy5wWzBd
LmlkID0gcHJpdl9kb21pZDsKKwl9CiAKIAlmb3IgKGkgPSAxOyBpIDwgbm9k
ZS0+cGVybXMubnVtOyBpKyspIHsKIAkJaWYgKG5vZGUtPnBlcm1zLnBbaV0u
cGVybXMgJiBYU19QRVJNX0lHTk9SRSkKQEAgLTg1NiwyNSArODczLDI1IEBA
IGludCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMoc3RydWN0IG5vZGUgKm5v
ZGUpCiB2b2lkIGRvbWFpbl9lbnRyeV9kZWMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogewogCXN0cnVjdCBkb21haW4g
KmQ7CisJdW5zaWduZWQgaW50IGRvbWlkOwogCiAJaWYgKCFjb25uKQogCQly
ZXR1cm47CiAKLQlpZiAobm9kZS0+cGVybXMucCAmJiBub2RlLT5wZXJtcy5w
WzBdLmlkICE9IGNvbm4tPmlkKSB7Ci0JCWlmIChjb25uLT50cmFuc2FjdGlv
bikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfZGVjKGNvbm4tPnRyYW5zYWN0
aW9uLAotCQkJCW5vZGUtPnBlcm1zLnBbMF0uaWQpOwotCQl9IGVsc2Ugewot
CQkJZCA9IGZpbmRfZG9tYWluX2J5X2RvbWlkKG5vZGUtPnBlcm1zLnBbMF0u
aWQpOwotCQkJaWYgKGQgJiYgZC0+bmJlbnRyeSkKLQkJCQlkLT5uYmVudHJ5
LS07Ci0JCX0KLQl9IGVsc2UgaWYgKGNvbm4tPmRvbWFpbiAmJiBjb25uLT5k
b21haW4tPm5iZW50cnkpIHsKLQkJaWYgKGNvbm4tPnRyYW5zYWN0aW9uKSB7
Ci0JCQl0cmFuc2FjdGlvbl9lbnRyeV9kZWMoY29ubi0+dHJhbnNhY3Rpb24s
Ci0JCQkJY29ubi0+ZG9tYWluLT5kb21pZCk7CisJZG9taWQgPSBub2RlLT5w
ZXJtcy5wID8gbm9kZS0+cGVybXMucFswXS5pZCA6IGNvbm4tPmlkOworCisJ
aWYgKGNvbm4tPnRyYW5zYWN0aW9uKSB7CisJCXRyYW5zYWN0aW9uX2VudHJ5
X2RlYyhjb25uLT50cmFuc2FjdGlvbiwgZG9taWQpOworCX0gZWxzZSB7CisJ
CWQgPSAoZG9taWQgPT0gY29ubi0+aWQgJiYgY29ubi0+ZG9tYWluKSA/IGNv
bm4tPmRvbWFpbgorCQkgICAgOiBmaW5kX2RvbWFpbl9zdHJ1Y3QoZG9taWQp
OworCQlpZiAoZCkgeworCQkJZC0+bmJlbnRyeS0tOwogCQl9IGVsc2Ugewot
CQkJY29ubi0+ZG9tYWluLT5uYmVudHJ5LS07CisJCQllcnJubyA9IEVOT0VO
VDsKKwkJCWNvcnJ1cHQoY29ubiwKKwkJCQkiTm9kZSBcIiVzXCIgb3duZWQg
Ynkgbm9uLWV4aXN0aW5nIGRvbWFpbiAldVxuIiwKKwkJCQlub2RlLT5uYW1l
LCBkb21pZCk7CiAJCX0KIAl9CiB9CkBAIC04ODQsMTMgKzkwMSwyMyBAQCBp
bnQgZG9tYWluX2VudHJ5X2ZpeCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBu
dW0sIGJvb2wgdXBkYXRlKQogCXN0cnVjdCBkb21haW4gKmQ7CiAJaW50IGNu
dDsKIAotCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21pZChkb21pZCk7Ci0JaWYg
KCFkKQotCQlyZXR1cm4gMDsKKwlpZiAodXBkYXRlKSB7CisJCWQgPSBmaW5k
X2RvbWFpbl9zdHJ1Y3QoZG9taWQpOworCQlhc3NlcnQoZCk7CisJfSBlbHNl
IHsKKwkJLyoKKwkJICogV2UgYXJlIGNhbGxlZCBmaXJzdCB3aXRoIHVwZGF0
ZSA9PSBmYWxzZSBpbiBvcmRlciB0byBjYXRjaAorCQkgKiBhbnkgZXJyb3Iu
IFNvIGRvIGEgcG9zc2libGUgYWxsb2NhdGlvbiBhbmQgY2hlY2sgZm9yIGVy
cm9yCisJCSAqIG9ubHkgaW4gdGhpcyBjYXNlLCBhcyBpbiB0aGUgY2FzZSBv
ZiB1cGRhdGUgPT0gdHJ1ZSBub3RoaW5nCisJCSAqIGNhbiBnbyB3cm9uZyBh
bnltb3JlIGFzIHRoZSBhbGxvY2F0aW9uIGFscmVhZHkgaGFwcGVuZWQuCisJ
CSAqLworCQlkID0gZmluZF9vcl9hbGxvY19leGlzdGluZ19kb21haW4oZG9t
aWQpOworCQlpZiAoIWQpCisJCQlyZXR1cm4gLTE7CisJfQogCiAJY250ID0g
ZC0+bmJlbnRyeSArIG51bTsKLQlpZiAoY250IDwgMCkKLQkJY250ID0gMDsK
Kwlhc3NlcnQoY250ID49IDApOwogCiAJaWYgKHVwZGF0ZSkKIAkJZC0+bmJl
bnRyeSA9IGNudDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21h
aW4uaAppbmRleCA0YmZmMmU2NTViOWIuLjRlZGYxZGJhOTQyNSAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCisrKyBi
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaApAQCAtNTcsMTAg
KzU3LDEwIEBAIGJvb2wgZG9tYWluX2Nhbl93cml0ZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubik7CiBib29sIGRvbWFpbl9pc191bnByaXZpbGVnZWQoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogCiAvKiBSZW1vdmUgbm9kZSBwZXJt
aXNzaW9ucyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5nIGRvbWFpbnMuICovCi1p
bnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVjdCBub2RlICpub2Rl
KTsKK2ludCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKTsKIAogLyogUXVvdGEg
bWFuaXB1bGF0aW9uICovCi12b2lkIGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICopOworaW50IGRvbWFp
bl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICopOwogdm9pZCBkb21haW5fZW50cnlfZGVjKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqKTsKIGludCBkb21haW5fZW50cnlf
Zml4KHVuc2lnbmVkIGludCBkb21pZCwgaW50IG51bSwgYm9vbCB1cGRhdGUp
OwogaW50IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNh
Y3Rpb24uYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlv
bi5jCmluZGV4IDliZWY2ZTcyYTU2Ni4uYmYyZmRhODIzNGIzIDEwMDY0NAot
LS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwor
KysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpA
QCAtNTIzLDggKzUyMywxMiBAQCBzdGF0aWMgaW50IHRyYW5zYWN0aW9uX2Zp
eF9kb21haW5zKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIGJvb2wgdXBk
YXRlKQogCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShkLCAmdHJhbnMtPmNoYW5n
ZWRfZG9tYWlucywgbGlzdCkgewogCQljbnQgPSBkb21haW5fZW50cnlfZml4
KGQtPmRvbWlkLCBkLT5uYmVudHJ5LCB1cGRhdGUpOwotCQlpZiAoIXVwZGF0
ZSAmJiBjbnQgPj0gcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbikKLQkJCXJl
dHVybiBFTk9TUEM7CisJCWlmICghdXBkYXRlKSB7CisJCQlpZiAoY250ID49
IHF1b3RhX25iX2VudHJ5X3Blcl9kb21haW4pCisJCQkJcmV0dXJuIEVOT1NQ
QzsKKwkJCWlmIChjbnQgPCAwKQorCQkJCXJldHVybiBFTk9NRU07CisJCX0K
IAl9CiAKIAlyZXR1cm4gMDsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-09.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-09.patch"
Content-Transfer-Encoding: base64

RnJvbSBmMGI4NTZmNmQ2NDAzZDMyNTYzYWM3ZjZiODA3YTU4YWQ1NjgyZTkz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG1h
eCBudW1iZXIgb2Ygbm9kZXMgYWNjZXNzZWQgaW4gYSB0cmFuc2FjdGlvbgoK
VG9kYXkgYSBndWVzdCBpcyBmcmVlIHRvIGFjY2VzcyBhcyBtYW55IG5vZGVz
IGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uCmFzIGl0IHdhbnRzLiBUaGlzIGNh
biBsZWFkIHRvIHVuYm91bmRlZCBtZW1vcnkgY29uc3VtcHRpb24gaW4gWGVu
c3RvcmUKYXMgdGhlcmUgaXMgdGhlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiBh
bGwgbm9kZXMgaGF2aW5nIGJlZW4gYWNjZXNzZWQKZHVyaW5nIGEgdHJhbnNh
Y3Rpb24uCgpJbiBveGVuc3RvcmVkIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMg
aW4gYSB0cmFuc2FjdGlvbiBpcyBiZWluZyBsaW1pdGVkCnZpYSBhIHF1b3Rh
IG1heHJlcXVlc3RzIChkZWZhdWx0IGlzIDEwMjQpLiBBcyBtdWx0aXBsZSBh
Y2Nlc3NlcyBvZiBhCm5vZGUgYXJlIG5vdCBwcm9ibGVtYXRpYyBpbiBDIFhl
bnN0b3JlLCBsaW1pdCB0aGUgbnVtYmVyIG9mIGFjY2Vzc2VkCm5vZGVzLgoK
SW4gb3JkZXIgdG8gbGV0IHJlYWRfbm9kZSgpIGRldGVjdCBhIHF1b3RhIGVy
cm9yIGluIGNhc2UgdG9vIG1hbnkgbm9kZXMKYXJlIGJlaW5nIGFjY2Vzc2Vk
LCBjaGVjayB0aGUgcmV0dXJuIHZhbHVlIG9mIGFjY2Vzc19ub2RlKCkgYW5k
IHJldHVybgpOVUxMIGluIGNhc2UgYW4gZXJyb3IgaGFzIGJlZW4gc2Vlbi4g
SW50cm9kdWNlIF9fbXVzdF9jaGVjayBhbmQgYWRkIGl0CnRvIHRoZSBhY2Nl
c3Nfbm9kZSgpIHByb3RvdHlwZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2
IC8gQ1ZFLTIwMjItNDIzMTQuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxs
IDxqZ3JhbGxAYW1hem9uLmNvbT4KU3VnZ2VzdGVkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGp1bGllbkB4ZW4ub3JnPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdy
b3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL2lu
Y2x1ZGUveGVuLXRvb2xzL2xpYnMuaCBiL3Rvb2xzL2luY2x1ZGUveGVuLXRv
b2xzL2xpYnMuaAppbmRleCBjYzdkZmM4YzY0NTMuLjM0ZGIzYjc4NDczMiAx
MDA2NDQKLS0tIGEvdG9vbHMvaW5jbHVkZS94ZW4tdG9vbHMvbGlicy5oCisr
KyBiL3Rvb2xzL2luY2x1ZGUveGVuLXRvb2xzL2xpYnMuaApAQCAtNTksNCAr
NTksOCBAQAogICAgIH0pCiAjZW5kaWYKIAorI2lmbmRlZiBfX211c3RfY2hl
Y2sKKyNkZWZpbmUgX19tdXN0X2NoZWNrIF9fYXR0cmlidXRlX18oKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKQorI2VuZGlmCisKICNlbmRpZgkvKiBfX1hF
Tl9UT09MU19MSUJTX18gKi8KZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jCmluZGV4IDEyZDAxM2QyNDk0OS4uZmY2NDliNzU0NGRiIDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisrKyBi
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTEwNSw2ICsx
MDUsNyBAQCBpbnQgcXVvdGFfbmJfd2F0Y2hfcGVyX2RvbWFpbiA9IDEyODsK
IGludCBxdW90YV9tYXhfZW50cnlfc2l6ZSA9IDIwNDg7IC8qIDJLICovCiBp
bnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uID0gMTA7CiBpbnQgcXVvdGFfbmJf
cGVybXNfcGVyX25vZGUgPSA1OworaW50IHF1b3RhX3RyYW5zX25vZGVzID0g
MTAyNDsKIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSAyMDsKIAogdW5z
aWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIwMDAwOwpA
QCAtNTAyLDYgKzUwMyw3IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlUREJf
REFUQSBrZXksIGRhdGE7CiAJc3RydWN0IHhzX3RkYl9yZWNvcmRfaGRyICpo
ZHI7CiAJc3RydWN0IG5vZGUgKm5vZGU7CisJaW50IGVycjsKIAogCW5vZGUg
PSB0YWxsb2MoY3R4LCBzdHJ1Y3Qgbm9kZSk7CiAJaWYgKCFub2RlKSB7CkBA
IC01MjMsMTQgKzUyNSwxMyBAQCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAJaWYg
KGRhdGEuZHB0ciA9PSBOVUxMKSB7CiAJCWlmICh0ZGJfZXJyb3IodGRiX2N0
eCkgPT0gVERCX0VSUl9OT0VYSVNUKSB7CiAJCQlub2RlLT5nZW5lcmF0aW9u
ID0gTk9fR0VORVJBVElPTjsKLQkJCWFjY2Vzc19ub2RlKGNvbm4sIG5vZGUs
IE5PREVfQUNDRVNTX1JFQUQsIE5VTEwpOwotCQkJZXJybm8gPSBFTk9FTlQ7
CisJCQllcnIgPSBhY2Nlc3Nfbm9kZShjb25uLCBub2RlLCBOT0RFX0FDQ0VT
U19SRUFELCBOVUxMKTsKKwkJCWVycm5vID0gZXJyID8gOiBFTk9FTlQ7CiAJ
CX0gZWxzZSB7CiAJCQlsb2coIlREQiBlcnJvciBvbiByZWFkOiAlcyIsIHRk
Yl9lcnJvcnN0cih0ZGJfY3R4KSk7CiAJCQllcnJubyA9IEVJTzsKIAkJfQot
CQl0YWxsb2NfZnJlZShub2RlKTsKLQkJcmV0dXJuIE5VTEw7CisJCWdvdG8g
ZXJyb3I7CiAJfQogCiAJbm9kZS0+cGFyZW50ID0gTlVMTDsKQEAgLTU0NSwx
OSArNTQ2LDM2IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAogCS8qIFBlcm1p
c3Npb25zIGFyZSBzdHJ1Y3QgeHNfcGVybWlzc2lvbnMuICovCiAJbm9kZS0+
cGVybXMucCA9IGhkci0+cGVybXM7Ci0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhjb25uLCBub2RlKSkgewotCQl0YWxsb2NfZnJlZShub2RlKTsK
LQkJcmV0dXJuIE5VTEw7Ci0JfQorCWlmIChkb21haW5fYWRqdXN0X25vZGVf
cGVybXMoY29ubiwgbm9kZSkpCisJCWdvdG8gZXJyb3I7CiAKIAkvKiBEYXRh
IGlzIGJpbmFyeSBibG9iICh1c3VhbGx5IGFzY2lpLCBubyBudWwpLiAqLwog
CW5vZGUtPmRhdGEgPSBub2RlLT5wZXJtcy5wICsgaGRyLT5udW1fcGVybXM7
CiAJLyogQ2hpbGRyZW4gaXMgc3RyaW5ncywgbnVsIHNlcGFyYXRlZC4gKi8K
IAlub2RlLT5jaGlsZHJlbiA9IG5vZGUtPmRhdGEgKyBub2RlLT5kYXRhbGVu
OwogCi0JYWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVB
RCwgTlVMTCk7CisJaWYgKGFjY2Vzc19ub2RlKGNvbm4sIG5vZGUsIE5PREVf
QUNDRVNTX1JFQUQsIE5VTEwpKQorCQlnb3RvIGVycm9yOwogCiAJcmV0dXJu
IG5vZGU7CisKKyBlcnJvcjoKKwllcnIgPSBlcnJubzsKKwl0YWxsb2NfZnJl
ZShub2RlKTsKKwllcnJubyA9IGVycjsKKwlyZXR1cm4gTlVMTDsKK30KKwor
c3RhdGljIGJvb2wgcmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJybm8odm9p
ZCkKK3sKKwkvKgorCSAqIDIgZXJyb3IgY2FzZXMgZm9yIHJlYWRfbm9kZSgp
IGNhbiBhbHdheXMgYmUgcHJvcGFnYXRlZCB1cDoKKwkgKiBFTk9NRU0sIGJl
Y2F1c2UgdGhpcyBoYXMgbm90aGluZyB0byBkbyB3aXRoIHRoZSBub2RlIGJl
aW5nIGluIHRoZQorCSAqIGRhdGEgYmFzZSBvciBub3QsIGJ1dCBpcyBjYXVz
ZWQgYnkgYSBnZW5lcmFsIGxhY2sgb2YgbWVtb3J5LgorCSAqIEVOT1NQQywg
YmVjYXVzZSB0aGlzIGlzIHJlbGF0ZWQgdG8gaGl0dGluZyBxdW90YSBsaW1p
dHMgd2hpY2ggbmVlZAorCSAqIHRvIGJlIHJlc3BlY3RlZC4KKwkgKi8KKwly
ZXR1cm4gZXJybm8gPT0gRU5PTUVNIHx8IGVycm5vID09IEVOT1NQQzsKIH0K
IAogaW50IHdyaXRlX25vZGVfcmF3KHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKQEAgLTY3Miw3
ICs2OTAsNyBAQCBzdGF0aWMgaW50IGFza19wYXJlbnRzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAJCW5vZGUgPSByZWFk
X25vZGUoY29ubiwgY3R4LCBuYW1lKTsKIAkJaWYgKG5vZGUpCiAJCQlicmVh
azsKLQkJaWYgKGVycm5vID09IEVOT01FTSkKKwkJaWYgKHJlYWRfbm9kZV9j
YW5fcHJvcGFnYXRlX2Vycm5vKCkpCiAJCQlyZXR1cm4gZXJybm87CiAJfSB3
aGlsZSAoIXN0cmVxKG5hbWUsICIvIikpOwogCkBAIC03MzUsNyArNzUzLDcg
QEAgc3RhdGljIHN0cnVjdCBub2RlICpnZXRfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwKIAkJfQogCX0KIAkvKiBDbGVhbiB1cCBlcnJubyBpZiB0
aGV5IHdlcmVuJ3Qgc3VwcG9zZWQgdG8ga25vdy4gKi8KLQlpZiAoIW5vZGUg
JiYgZXJybm8gIT0gRU5PTUVNKQorCWlmICghbm9kZSAmJiAhcmVhZF9ub2Rl
X2Nhbl9wcm9wYWdhdGVfZXJybm8oKSkKIAkJZXJybm8gPSBlcnJub19mcm9t
X3BhcmVudHMoY29ubiwgY3R4LCBuYW1lLCBlcnJubywgcGVybSk7CiAJcmV0
dXJuIG5vZGU7CiB9CkBAIC0xMTE3LDcgKzExMzUsNyBAQCBzdGF0aWMgc3Ry
dWN0IG5vZGUgKmNvbnN0cnVjdF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBJZiBwYXJlbnQgZG9lc24n
dCBleGlzdCwgY3JlYXRlIGl0LiAqLwogCXBhcmVudCA9IHJlYWRfbm9kZShj
b25uLCBwYXJlbnRuYW1lLCBwYXJlbnRuYW1lKTsKLQlpZiAoIXBhcmVudCkK
KwlpZiAoIXBhcmVudCAmJiBlcnJubyA9PSBFTk9FTlQpCiAJCXBhcmVudCA9
IGNvbnN0cnVjdF9ub2RlKGNvbm4sIGN0eCwgcGFyZW50bmFtZSk7CiAJaWYg
KCFwYXJlbnQpCiAJCXJldHVybiBOVUxMOwpAQCAtMTM5Niw3ICsxNDE0LDcg
QEAgc3RhdGljIGludCBfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IHZvaWQgKmN0eCwgc3RydWN0IG5vZGUgKm5vZGUsCiAKIAlwYXJlbnQg
PSByZWFkX25vZGUoY29ubiwgY3R4LCBwYXJlbnRuYW1lKTsKIAlpZiAoIXBh
cmVudCkKLQkJcmV0dXJuIChlcnJubyA9PSBFTk9NRU0pID8gRU5PTUVNIDog
RUlOVkFMOworCQlyZXR1cm4gcmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSA/IGVycm5vIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9IHBhcmVu
dDsKIAogCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBhcmVudCwg
bm9kZSwgZmFsc2UpOwpAQCAtMTQyNCw3ICsxNDQyLDcgQEAgc3RhdGljIGlu
dCBkb19ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmluKQogCQkJCXJldHVybiAwOwogCQkJfQogCQkJLyogUmVz
dG9yZSBlcnJubywganVzdCBpbiBjYXNlLiAqLwotCQkJaWYgKGVycm5vICE9
IEVOT01FTSkKKwkJCWlmICghcmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSkKIAkJCQllcnJubyA9IEVOT0VOVDsKIAkJfQogCQlyZXR1cm4gZXJy
bm87CkBAIC0yMTc3LDYgKzIxOTUsOCBAQCBzdGF0aWMgdm9pZCB1c2FnZSh2
b2lkKQogIiAgLUEsIC0tcGVybS1uYiA8bmI+ICAgICAgbGltaXQgdGhlIG51
bWJlciBvZiBwZXJtaXNzaW9ucyBwZXIgbm9kZSxcbiIKICIgIC1RLCAtLXF1
b3RhIDx3aGF0Pj08bmI+IHNldCB0aGUgcXVvdGEgPHdoYXQ+IHRvIHRoZSB2
YWx1ZSA8bmI+LCBhbGxvd2VkXG4iCiAiICAgICAgICAgICAgICAgICAgICAg
ICAgICBxdW90YXMgYXJlOlxuIgorIiAgICAgICAgICAgICAgICAgICAgICAg
ICAgdHJhbnNhY3Rpb24tbm9kZXM6IG51bWJlciBvZiBhY2Nlc3NlZCBub2Rl
IHBlclxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHRyYW5zYWN0aW9uXG4iCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICBvdXRzdGFuZGluZzogbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJl
cXVlc3RzXG4iCiAiICAtdywgLS10aW1lb3V0IDx3aGF0Pj08c2Vjb25kcz4g
ICBzZXQgdGhlIHRpbWVvdXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+LFxuIgog
IiAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZCB0aW1lb3V0IGNh
bmRpZGF0ZXMgYXJlOlxuIgpAQCAtMjI1OCw2ICsyMjc4LDggQEAgc3RhdGlj
IHZvaWQgc2V0X3F1b3RhKGNvbnN0IGNoYXIgKmFyZykKIAl2YWwgPSBnZXRf
b3B0dmFsX2ludChlcSArIDEpOwogCWlmICh3aGF0X21hdGNoZXMoYXJnLCAi
b3V0c3RhbmRpbmciKSkKIAkJcXVvdGFfcmVxX291dHN0YW5kaW5nID0gdmFs
OworCWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlvbi1u
b2RlcyIpKQorCQlxdW90YV90cmFuc19ub2RlcyA9IHZhbDsKIAllbHNlCiAJ
CWJhcmYoInVua25vd24gcXVvdGEgXCIlc1wiXG4iLCBhcmcpOwogfQpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggOThkYjRhZmNh
YWJmLi43ZTM3MTI1M2QyZDEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuaApAQCAtMzQsNiArMzQsNyBAQAogI2luY2x1ZGUgImxpc3Qu
aCIKICNpbmNsdWRlICJ0ZGIuaCIKICNpbmNsdWRlICJoYXNodGFibGUuaCIK
KyNpbmNsdWRlICJ1dGlscy5oIgogCiAvKiBERUZBVUxUX0JVRkZFUl9TSVpF
IHNob3VsZCBiZSBsYXJnZSBlbm91Z2ggZm9yIGVhY2ggZXJybm8gc3RyaW5n
LiAqLwogI2RlZmluZSBERUZBVUxUX0JVRkZFUl9TSVpFIDE2CkBAIC0yMjMs
NiArMjI0LDcgQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0ZXJuIGlu
dCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9wZXJf
ZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmc7Citl
eHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOwogCiBleHRlcm4gdW5zaWdu
ZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwppbmRleCBi
ZjJmZGE4MjM0YjMuLjc3OGI3ZTQzOWNiMyAxMDA2NDQKLS0tIGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKKysrIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKQEAgLTE1Niw2ICsx
NTYsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBDb25uZWN0aW9uLWxv
Y2FsIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNhY3Rpb24uICovCiAJdWlu
dDMyX3QgaWQ7CiAKKwkvKiBOb2RlIGNvdW50ZXIuICovCisJdW5zaWduZWQg
aW50IG5vZGVzOworCiAJLyogR2VuZXJhdGlvbiB3aGVuIHRyYW5zYWN0aW9u
IHN0YXJ0ZWQuICovCiAJdWludDY0X3QgZ2VuZXJhdGlvbjsKIApAQCAtMjY2
LDYgKzI2OSwxMSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogCiAJaSA9IGZpbmRfYWNj
ZXNzZWRfbm9kZSh0cmFucywgbm9kZS0+bmFtZSk7CiAJaWYgKCFpKSB7CisJ
CWlmICh0cmFucy0+bm9kZXMgPj0gcXVvdGFfdHJhbnNfbm9kZXMgJiYKKwkJ
ICAgIGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikpIHsKKwkJCXJldCA9
IEVOT1NQQzsKKwkJCWdvdG8gZXJyOworCQl9CiAJCWkgPSB0YWxsb2NfemVy
byh0cmFucywgc3RydWN0IGFjY2Vzc2VkX25vZGUpOwogCQlpZiAoIWkpCiAJ
CQlnb3RvIG5vbWVtOwpAQCAtMzAzLDYgKzMxMSw3IEBAIGludCBhY2Nlc3Nf
bm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKm5v
ZGUsCiAJCQkJaS0+dGFfbm9kZSA9IHRydWU7CiAJCQl9CiAJCX0KKwkJdHJh
bnMtPm5vZGVzKys7CiAJCWxpc3RfYWRkX3RhaWwoJmktPmxpc3QsICZ0cmFu
cy0+YWNjZXNzZWQpOwogCX0KIApkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmggYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uaAppbmRleCAwMDkzY2FjODA3ZTMuLmUz
Y2JkNmIyMzA5NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX3RyYW5zYWN0aW9uLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX3RyYW5zYWN0aW9uLmgKQEAgLTM5LDggKzM5LDggQEAgdm9pZCB0cmFu
c2FjdGlvbl9lbnRyeV9pbmMoc3RydWN0IHRyYW5zYWN0aW9uICp0cmFucywg
dW5zaWduZWQgaW50IGRvbWlkKTsKIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlf
ZGVjKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBk
b21pZCk7CiAKIC8qIFRoaXMgbm9kZSB3YXMgYWNjZXNzZWQuICovCi1pbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAotICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKK2ludCBfX211c3RfY2hlY2sg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVt
IG5vZGVfYWNjZXNzX3R5cGUgdHlwZSwgVERCX0RBVEEgKmtleSk7CiAKIC8q
IFF1ZXVlIHdhdGNoZXMgZm9yIGEgbW9kaWZpZWQgbm9kZS4gKi8KIHZvaWQg
cXVldWVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
Y2hhciAqbmFtZSwgYm9vbCB3YXRjaF9leGFjdCk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-10.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-10.patch"
Content-Transfer-Encoding: base64

RnJvbSA4M2RhOTM4ZTdkNjZhODZmZDJlMDZhMThhYmE1YTkwYzUyYWM0YmNi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1vdmUgdGhl
IGNhbGwgb2Ygc2V0dXBfc3RydWN0dXJlKCkgdG8gZG9tMAogaW50cm9kdWN0
aW9uCgpTZXR0aW5nIHVwIHRoZSBiYXNpYyBzdHJ1Y3R1cmUgd2hlbiBpbnRy
b2R1Y2luZyBkb20wIGhhcyB0aGUgYWR2YW50YWdlCnRvIGJlIGFibGUgdG8g
YWRkIHByb3BlciBub2RlIG1lbW9yeSBhY2NvdW50aW5nIGZvciB0aGUgYWRk
ZWQgbm9kZXMKbGF0ZXIuCgpUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIGRv
IHByb3BlciBub2RlIGFjY291bnRpbmcsIHRvby4KCkFuIGFkZGl0aW9uYWwg
cmVxdWlyZW1lbnQgdG8gbWFrZSB0aGF0IHdvcmsgZmluZSBpcyB0byBjb3Jy
ZWN0IHRoZQpvd25lciBvZiB0aGUgY3JlYXRlZCBub2RlcyB0byBiZSBkb20w
X2RvbWlkIGluc3RlYWQgb2YgZG9taWQgMC4KClRoaXMgaXMgcGFydCBvZiBY
U0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMK
aW5kZXggZmY2NDliNzU0NC4uODEyM2E2NWE1OCAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xODM0LDcgKzE4MzQsOCBAQCBz
dGF0aWMgaW50IHRkYl9mbGFnczsKIHN0YXRpYyB2b2lkIG1hbnVhbF9ub2Rl
KGNvbnN0IGNoYXIgKm5hbWUsIGNvbnN0IGNoYXIgKmNoaWxkKQogewogCXN0
cnVjdCBub2RlICpub2RlOwotCXN0cnVjdCB4c19wZXJtaXNzaW9ucyBwZXJt
cyA9IHsgLmlkID0gMCwgLnBlcm1zID0gWFNfUEVSTV9OT05FIH07CisJc3Ry
dWN0IHhzX3Blcm1pc3Npb25zIHBlcm1zID0geyAuaWQgPSBkb20wX2RvbWlk
LAorCQkJCQkucGVybXMgPSBYU19QRVJNX05PTkUgfTsKIAogCW5vZGUgPSB0
YWxsb2NfemVybyhOVUxMLCBzdHJ1Y3Qgbm9kZSk7CiAJaWYgKCFub2RlKQpA
QCAtMTg3Myw3ICsxODc0LDcgQEAgc3RhdGljIHZvaWQgdGRiX2xvZ2dlcihU
REJfQ09OVEVYVCAqdGRiLCBpbnQgbGV2ZWwsIGNvbnN0IGNoYXIgKiBmbXQs
IC4uLikKIAl9CiB9CiAKLXN0YXRpYyB2b2lkIHNldHVwX3N0cnVjdHVyZSh2
b2lkKQordm9pZCBzZXR1cF9zdHJ1Y3R1cmUodm9pZCkKIHsKIAljaGFyICp0
ZGJuYW1lOwogCXRkYm5hbWUgPSB0YWxsb2Nfc3RyZHVwKHRhbGxvY19hdXRv
ZnJlZV9jb250ZXh0KCksIHhzX2RhZW1vbl90ZGIoKSk7CkBAIC0xODkxLDYg
KzE4OTIsNyBAQCBzdGF0aWMgdm9pZCBzZXR1cF9zdHJ1Y3R1cmUodm9pZCkK
IAltYW51YWxfbm9kZSgiLyIsICJ0b29sIik7CiAJbWFudWFsX25vZGUoIi90
b29sIiwgInhlbnN0b3JlZCIpOwogCW1hbnVhbF9ub2RlKCIvdG9vbC94ZW5z
dG9yZWQiLCBOVUxMKTsKKwlkb21haW5fZW50cnlfZml4KGRvbTBfZG9taWQs
IDMsIHRydWUpOwogCiAJY2hlY2tfc3RvcmUoKTsKIH0KQEAgLTIzODksOSAr
MjM5MSw2IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAK
IAlpbml0X3BpcGUocmVvcGVuX2xvZ19waXBlKTsKIAotCS8qIFNldHVwIHRo
ZSBkYXRhYmFzZSAqLwotCXNldHVwX3N0cnVjdHVyZSgpOwotCiAJLyogTGlz
dGVuIHRvIGh5cGVydmlzb3IuICovCiAJaWYgKCFub19kb21haW5faW5pdCkK
IAkJZG9tYWluX2luaXQoKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCmluZGV4IDdlMzcxMjUzZDIuLmQ5NWU0MjYyYTkgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMTk1LDYgKzE5NSw3
IEBAIGludCB3cml0ZV9ub2RlX3JhdyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgVERCX0RBVEEgKmtleSwgc3RydWN0IG5vZGUgKm5vZGUsCiBzdHJ1Y3Qg
bm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJCSAgICAgICBjb25zdCBjaGFyICpuYW1lKTsKIAor
dm9pZCBzZXR1cF9zdHJ1Y3R1cmUodm9pZCk7CiBzdHJ1Y3QgY29ubmVjdGlv
biAqbmV3X2Nvbm5lY3Rpb24oY29ubndyaXRlZm5fdCAqd3JpdGUsIGNvbm5y
ZWFkZm5fdCAqcmVhZCk7CiB2b2lkIGNoZWNrX3N0b3JlKHZvaWQpOwogdm9p
ZCBjb3JydXB0KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpmbXQsIC4uLik7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKaW5kZXggMzA2ZTEyMzU4Yi4uYmVkNmM0ZTA1YSAxMDA2NDQKLS0t
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwpAQCAtNzMyLDYgKzcz
Miw4IEBAIHN0YXRpYyBpbnQgZG9tMF9pbml0KHZvaWQpCiAJaWYgKGRvbTAt
PmludGVyZmFjZSA9PSBOVUxMKQogCQlyZXR1cm4gLTE7CiAKKwlzZXR1cF9z
dHJ1Y3R1cmUoKTsKKwogCXRhbGxvY19zdGVhbChkb20wLT5jb25uLCBkb20w
KTsgCiAKIAl4ZW5ldnRjaG5fbm90aWZ5KHhjZV9oYW5kbGUsIGRvbTAtPnBv
cnQpOwotLSAKMi4zNS4zCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-11.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-11.patch"
Content-Transfer-Encoding: base64

RnJvbSA1NmJiMDMwNjc4NDNiODBmZmQ4NWQ4OTYxMGU3MjgzZDgwZDQyMzM1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBpbmZy
YXN0cnVjdHVyZSB0byBrZWVwIHRyYWNrIG9mIHBlciBkb21haW4gbWVtb3J5
CiB1c2FnZQoKVGhlIGFtb3VudCBvZiBtZW1vcnkgYSBkb21haW4gY2FuIGNv
bnN1bWUgaW4gWGVuc3RvcmUgaXMgbGltaXRlZCBieQp2YXJpb3VzIHF1b3Rh
IHRvZGF5LCBidXQgZXZlbiB3aXRoIHNhbmUgcXVvdGEgYSBkb21haW4gY2Fu
IHN0aWxsCmNvbnN1bWUgcmF0aGVyIGxhcmdlIG1lbW9yeSBxdWFudGl0aWVz
LgoKQWRkIHRoZSBpbmZyYXN0cnVjdHVyZSBmb3Iga2VlcGluZyB0cmFjayBv
ZiB0aGUgYW1vdW50IG9mIG1lbW9yeSBhCmRvbWFpbiBpcyBjb25zdW1pbmcg
aW4gWGVuc3RvcmUuIE5vdGUgdGhhdCB0aGlzIGlzIG9ubHkgdGhlIG1lbW9y
eSBhCmRvbWFpbiBoYXMgZGlyZWN0IGNvbnRyb2wgb3Zlciwgc28gYW55IGlu
dGVybmFsIGFkbWluaXN0cmF0aW9uIGRhdGEKbmVlZGVkIGJ5IFhlbnN0b3Jl
IG9ubHkgaXMgbm90IGJlaW5nIGFjY291bnRlZCBmb3IuCgpUaGVyZSBhcmUg
dHdvIHF1b3RhcyBkZWZpbmVkOiBhIHNvZnQgcXVvdGEgd2hpY2ggd2lsbCBy
ZXN1bHQgaW4gYQp3YXJuaW5nIGlzc3VlZCB2aWEgc3lzbG9nKCkgd2hlbiBp
dCBpcyBleGNlZWRlZCwgYW5kIGEgaGFyZCBxdW90YQpyZXN1bHRpbmcgaW4g
YSBzdG9wIG9mIGFjY2VwdGluZyBmdXJ0aGVyIHJlcXVlc3RzIG9yIHdhdGNo
IGV2ZW50cyBhcwpsb25nIGFzIHRoZSBoYXJkIHF1b3RhIHdvdWxkIGJlIHZp
b2xhdGVkIGJ5IGFjY2VwdGluZyB0aG9zZS4KClNldHRpbmcgYW55IG9mIHRo
b3NlIHF1b3RhcyB0byAwIHdpbGwgZGlzYWJsZSBpdC4KCkFzIGRlZmF1bHQg
dmFsdWVzIHVzZSAyTUIgcGVyIGRvbWFpbiBmb3IgdGhlIHNvZnQgbGltaXQg
KHRoaXMgYmFzaWNhbGx5CmNvdmVycyB0aGUgYWxsb3dlZCBjYXNlIHRvIGNy
ZWF0ZSAxMDAwIG5vZGVzIG5lZWRpbmcgMmtCIGVhY2gpLCBhbmQKMi41TUIg
Zm9yIHRoZSBoYXJkIGxpbWl0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA4MTIzYTY1YTU4YmYuLjlmZDgzZWEwMjU5YSAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDcsNiArMTA3LDggQEAgaW50
IHF1b3RhX21heF90cmFuc2FjdGlvbiA9IDEwOwogaW50IHF1b3RhX25iX3Bl
cm1zX3Blcl9ub2RlID0gNTsKIGludCBxdW90YV90cmFuc19ub2RlcyA9IDEw
MjQ7CiBpbnQgcXVvdGFfcmVxX291dHN0YW5kaW5nID0gMjA7CitpbnQgcXVv
dGFfbWVtb3J5X3Blcl9kb21haW5fc29mdCA9IDIgKiAxMDI0ICogMTAyNDsg
LyogMiBNQiAqLworaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX2hhcmQg
PSAyICogMTAyNCAqIDEwMjQgKyA1MTIgKiAxMDI0OyAvKiAyLjUgTUIgKi8K
IAogdW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIw
MDAwOwogCkBAIC0yMTk5LDcgKzIyMDEsMTQgQEAgc3RhdGljIHZvaWQgdXNh
Z2Uodm9pZCkKICIgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RhcyBh
cmU6XG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlv
bi1ub2RlczogbnVtYmVyIG9mIGFjY2Vzc2VkIG5vZGUgcGVyXG4iCiAiICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJh
bnNhY3Rpb25cbiIKKyIgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbW9y
eTogdG90YWwgdXNlZCBtZW1vcnkgcGVyIGRvbWFpbiBmb3Igbm9kZXMsXG4i
CisiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0
aW9ucywgd2F0Y2hlcyBhbmQgcmVxdWVzdHMsIGFib3ZlXG4iCisiICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWNoIFhlbnN0b3JlIHdp
bGwgc3RvcCB0YWxraW5nIHRvIGRvbWFpblxuIgogIiAgICAgICAgICAgICAg
ICAgICAgICAgICAgb3V0c3RhbmRpbmc6IG51bWJlciBvZiBvdXRzdGFuZGlu
ZyByZXF1ZXN0c1xuIgorIiAgLXEsIC0tcXVvdGEtc29mdCA8d2hhdD49PG5i
PiBzZXQgYSBzb2Z0IHF1b3RhIDx3aGF0PiB0byB0aGUgdmFsdWUgPG5iPixc
biIKKyIgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdXNpbmcgYSB3YXJu
aW5nIHRvIGJlIGlzc3VlZCB2aWEgc3lzbG9nKCkgaWYgdGhlXG4iCisiICAg
ICAgICAgICAgICAgICAgICAgICAgICBsaW1pdCBpcyB2aW9sYXRlZCwgYWxs
b3dlZCBxdW90YXMgYXJlOlxuIgorIiAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWVtb3J5OiBzZWUgYWJvdmVcbiIKICIgIC13LCAtLXRpbWVvdXQgPHdo
YXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGltZW91dCBpbiBzZWNvbmRzIGZv
ciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxv
d2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6XG4iCiAiICAgICAgICAgICAg
ICAgICAgICAgICAgICB3YXRjaC1ldmVudDogdGltZSBhIHdhdGNoLWV2ZW50
IGlzIGtlcHQgcGVuZGluZ1xuIgpAQCAtMjIyNSw2ICsyMjM0LDcgQEAgc3Rh
dGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRyYW5zYWN0
aW9uIiwgMSwgTlVMTCwgJ3QnIH0sCiAJeyAicGVybS1uYiIsIDEsIE5VTEws
ICdBJyB9LAogCXsgInF1b3RhIiwgMSwgTlVMTCwgJ1EnIH0sCisJeyAicXVv
dGEtc29mdCIsIDEsIE5VTEwsICdxJyB9LAogCXsgInRpbWVvdXQiLCAxLCBO
VUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5VTEwsICdSJyB9
LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0sCkBAIC0yMjcw
LDcgKzIyODAsNyBAQCBzdGF0aWMgdm9pZCBzZXRfdGltZW91dChjb25zdCBj
aGFyICphcmcpCiAJCWJhcmYoInVua25vd24gdGltZW91dCBcIiVzXCJcbiIs
IGFyZyk7CiB9CiAKLXN0YXRpYyB2b2lkIHNldF9xdW90YShjb25zdCBjaGFy
ICphcmcpCitzdGF0aWMgdm9pZCBzZXRfcXVvdGEoY29uc3QgY2hhciAqYXJn
LCBib29sIHNvZnQpCiB7CiAJY29uc3QgY2hhciAqZXEgPSBzdHJjaHIoYXJn
LCAnPScpOwogCWludCB2YWw7CkBAIC0yMjc4LDExICsyMjg4LDE2IEBAIHN0
YXRpYyB2b2lkIHNldF9xdW90YShjb25zdCBjaGFyICphcmcpCiAJaWYgKCFl
cSkKIAkJYmFyZigicXVvdGFzIG11c3QgYmUgc3BlY2lmaWVkIHZpYSA8d2hh
dD49PG5iPlxuIik7CiAJdmFsID0gZ2V0X29wdHZhbF9pbnQoZXEgKyAxKTsK
LQlpZiAod2hhdF9tYXRjaGVzKGFyZywgIm91dHN0YW5kaW5nIikpCisJaWYg
KHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFuZGluZyIpICYmICFzb2Z0KQog
CQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7Ci0JZWxzZSBpZiAod2hh
dF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikpCisJZWxzZSBp
ZiAod2hhdF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikgJiYg
IXNvZnQpCiAJCXF1b3RhX3RyYW5zX25vZGVzID0gdmFsOwotCWVsc2UKKwll
bHNlIGlmICh3aGF0X21hdGNoZXMoYXJnLCAibWVtb3J5IikpIHsKKwkJaWYg
KHNvZnQpCisJCQlxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ID0gdmFs
OworCQllbHNlCisJCQlxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkID0g
dmFsOworCX0gZWxzZQogCQliYXJmKCJ1bmtub3duIHF1b3RhIFwiJXNcIlxu
IiwgYXJnKTsKIH0KIApAQCAtMjI5Nyw3ICsyMzEyLDcgQEAgaW50IG1haW4o
aW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlpbnQgdGltZW91dDsKIAogCi0J
d2hpbGUgKChvcHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpI
TlBTOnQ6QTpROlQ6UlZXOnc6Iiwgb3B0aW9ucywKKwl3aGlsZSAoKG9wdCA9
IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOlE6cTpU
OlJWVzp3OiIsIG9wdGlvbnMsCiAJCQkJICBOVUxMKSkgIT0gLTEpIHsKIAkJ
c3dpdGNoIChvcHQpIHsKIAkJY2FzZSAnRCc6CkBAIC0yMzQzLDcgKzIzNTgs
MTAgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCXF1
b3RhX25iX3Blcm1zX3Blcl9ub2RlID0gc3RydG9sKG9wdGFyZywgTlVMTCwg
MTApOwogCQkJYnJlYWs7CiAJCWNhc2UgJ1EnOgotCQkJc2V0X3F1b3RhKG9w
dGFyZyk7CisJCQlzZXRfcXVvdGEob3B0YXJnLCBmYWxzZSk7CisJCQlicmVh
azsKKwkJY2FzZSAncSc6CisJCQlzZXRfcXVvdGEob3B0YXJnLCB0cnVlKTsK
IAkJCWJyZWFrOwogCQljYXNlICd3JzoKIAkJCXNldF90aW1lb3V0KG9wdGFy
Zyk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29y
ZS5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBk
OTVlNDI2MmE5MWUuLjRlNTMwNzJlNjM3YyAxMDA2NDQKLS0tIGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0yMjYsNiArMjI2LDggQEAgZXh0ZXJu
IGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9w
ZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmc7
CiBleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOworZXh0ZXJuIGludCBx
dW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0OworZXh0ZXJuIGludCBxdW90
YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkOwogCiBleHRlcm4gdW5zaWduZWQg
aW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0tZ2l0IGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDBlMTE2ZTVjM2Q2My4u
Nzg2M2ZhNTU0ODdkIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2RvbWFpbi5jCkBAIC04MCw2ICs4MCwxMyBAQCBzdHJ1Y3QgZG9tYWluCiAJ
LyogbnVtYmVyIG9mIGVudHJ5IGZyb20gdGhpcyBkb21haW4gaW4gdGhlIHN0
b3JlICovCiAJaW50IG5iZW50cnk7CiAKKwkvKiBBbW91bnQgb2YgbWVtb3J5
IGFsbG9jYXRlZCBmb3IgdGhpcyBkb21haW4uICovCisJaW50IG1lbW9yeTsK
Kwlib29sIHNvZnRfcXVvdGFfcmVwb3J0ZWQ7CisJYm9vbCBoYXJkX3F1b3Rh
X3JlcG9ydGVkOworCXRpbWVfdCBtZW1fbGFzdF9tc2c7CisjZGVmaW5lIE1F
TV9XQVJOX01JTlRJTUVfU0VDIDEwCisKIAkvKiBudW1iZXIgb2Ygd2F0Y2gg
Zm9yIHRoaXMgZG9tYWluICovCiAJaW50IG5id2F0Y2g7CiAKQEAgLTI5Myw2
ICszMDAsOSBAQCBib29sIGRvbWFpbl9jYW5fcmVhZChzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIAkJCXJldHVybiBmYWxzZTsKIAkJaWYgKGNvbm4tPmRv
bWFpbi0+bmJvdXRzdGFuZGluZyA+PSBxdW90YV9yZXFfb3V0c3RhbmRpbmcp
CiAJCQlyZXR1cm4gZmFsc2U7CisJCWlmIChjb25uLT5kb21haW4tPm1lbW9y
eSA+PSBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkICYmCisJCSAgICBx
dW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkKQorCQkJcmV0dXJuIGZhbHNl
OwogCX0KIAogCWlmIChjb25uLT5pc19pZ25vcmVkKQpAQCAtOTM3LDYgKzk0
Nyw4OSBAQCBpbnQgZG9tYWluX2VudHJ5KHN0cnVjdCBjb25uZWN0aW9uICpj
b25uKQogCQk6IDA7CiB9CiAKK3N0YXRpYyBib29sIGRvbWFpbl9jaGtfcXVv
dGEoc3RydWN0IGRvbWFpbiAqZG9tYWluLCBpbnQgbWVtKQoreworCXRpbWVf
dCBub3c7CisKKwlpZiAoIWRvbWFpbiB8fCAhZG9taWRfaXNfdW5wcml2aWxl
Z2VkKGRvbWFpbi0+ZG9taWQpIHx8CisJICAgIChkb21haW4tPmNvbm4gJiYg
ZG9tYWluLT5jb25uLT5pc19pZ25vcmVkKSkKKwkJcmV0dXJuIGZhbHNlOwor
CisJbm93ID0gdGltZShOVUxMKTsKKworCWlmIChtZW0gPj0gcXVvdGFfbWVt
b3J5X3Blcl9kb21haW5faGFyZCAmJgorCSAgICBxdW90YV9tZW1vcnlfcGVy
X2RvbWFpbl9oYXJkKSB7CisJCWlmIChkb21haW4tPmhhcmRfcXVvdGFfcmVw
b3J0ZWQpCisJCQlyZXR1cm4gdHJ1ZTsKKwkJc3lzbG9nKExPR19FUlIsICJE
b21haW4gJXUgZXhjZWVkcyBoYXJkIG1lbW9yeSBxdW90YSwgWGVuc3RvcmUg
aW50ZXJmYWNlIHRvIGRvbWFpbiBzdGFsbGVkXG4iLAorCQkgICAgICAgZG9t
YWluLT5kb21pZCk7CisJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93Owor
CQlkb21haW4tPmhhcmRfcXVvdGFfcmVwb3J0ZWQgPSB0cnVlOworCQlyZXR1
cm4gdHJ1ZTsKKwl9CisKKwlpZiAobm93IC0gZG9tYWluLT5tZW1fbGFzdF9t
c2cgPj0gTUVNX1dBUk5fTUlOVElNRV9TRUMpIHsKKwkJaWYgKGRvbWFpbi0+
aGFyZF9xdW90YV9yZXBvcnRlZCkgeworCQkJZG9tYWluLT5tZW1fbGFzdF9t
c2cgPSBub3c7CisJCQlkb21haW4tPmhhcmRfcXVvdGFfcmVwb3J0ZWQgPSBm
YWxzZTsKKwkJCXN5c2xvZyhMT0dfSU5GTywgIkRvbWFpbiAldSBiZWxvdyBo
YXJkIG1lbW9yeSBxdW90YSBhZ2FpblxuIiwKKwkJCSAgICAgICBkb21haW4t
PmRvbWlkKTsKKwkJfQorCQlpZiAobWVtID49IHF1b3RhX21lbW9yeV9wZXJf
ZG9tYWluX3NvZnQgJiYKKwkJICAgIHF1b3RhX21lbW9yeV9wZXJfZG9tYWlu
X3NvZnQgJiYKKwkJICAgICFkb21haW4tPnNvZnRfcXVvdGFfcmVwb3J0ZWQp
IHsKKwkJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93OworCQkJZG9tYWlu
LT5zb2Z0X3F1b3RhX3JlcG9ydGVkID0gdHJ1ZTsKKwkJCXN5c2xvZyhMT0df
V0FSTklORywgIkRvbWFpbiAldSBleGNlZWRzIHNvZnQgbWVtb3J5IHF1b3Rh
XG4iLAorCQkJICAgICAgIGRvbWFpbi0+ZG9taWQpOworCQl9CisJCWlmICht
ZW0gPCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ICYmCisJCSAgICBk
b21haW4tPnNvZnRfcXVvdGFfcmVwb3J0ZWQpIHsKKwkJCWRvbWFpbi0+bWVt
X2xhc3RfbXNnID0gbm93OworCQkJZG9tYWluLT5zb2Z0X3F1b3RhX3JlcG9y
dGVkID0gZmFsc2U7CisJCQlzeXNsb2coTE9HX0lORk8sICJEb21haW4gJXUg
YmVsb3cgc29mdCBtZW1vcnkgcXVvdGEgYWdhaW5cbiIsCisJCQkgICAgICAg
ZG9tYWluLT5kb21pZCk7CisJCX0KKworCX0KKworCXJldHVybiBmYWxzZTsK
K30KKworaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVkIGludCBkb21p
ZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjaykKK3sKKwlzdHJ1Y3Qg
ZG9tYWluICpkb21haW47CisKKwlkb21haW4gPSBmaW5kX2RvbWFpbl9zdHJ1
Y3QoZG9taWQpOworCWlmIChkb21haW4pIHsKKwkJLyoKKwkJICogZG9tYWlu
X2Noa19xdW90YSgpIHdpbGwgcHJpbnQgd2FybmluZyBhbmQgYWxzbyBzdG9y
ZSB3aGV0aGVyCisJCSAqIHRoZSBzb2Z0L2hhcmQgcXVvdGEgaGFzIGJlZW4g
aGl0LiBTbyBjaGVjayBub19xdW90YV9jaGVjaworCQkgKiAqYWZ0ZXIqLgor
CQkgKi8KKwkJaWYgKGRvbWFpbl9jaGtfcXVvdGEoZG9tYWluLCBkb21haW4t
Pm1lbW9yeSArIG1lbSkgJiYKKwkJICAgICFub19xdW90YV9jaGVjaykKKwkJ
CXJldHVybiBFTk9NRU07CisJCWRvbWFpbi0+bWVtb3J5ICs9IG1lbTsKKwl9
IGVsc2UgeworCQkvKgorCQkgKiBUaGUgZG9tYWluIHRoZSBtZW1vcnkgaXMg
dG8gYmUgYWNjb3VudGVkIGZvciBzaG91bGQgYWx3YXlzCisJCSAqIGV4aXN0
LCBhcyBhY2NvdW50aW5nIGlzIGRvbmUgZWl0aGVyIGZvciBhIGRvbWFpbiBy
ZWxhdGVkIHRvCisJCSAqIHRoZSBjdXJyZW50IGNvbm5lY3Rpb24sIG9yIGZv
ciB0aGUgZG9tYWluIG93bmluZyBhIG5vZGUKKwkJICogKHdoaWNoIGlzIGFs
d2F5cyBleGlzdGluZywgYXMgdGhlIG93bmVyIG9mIHRoZSBub2RlIGlzCisJ
CSAqIHRlc3RlZCB0byBleGlzdCBhbmQgcmVwbGFjZWQgYnkgZG9taWQgMCBp
ZiBub3QpLgorCQkgKiBTbyBub3QgZmluZGluZyB0aGUgcmVsYXRlZCBkb21h
aW4gTVVTVCBiZSBhbiBlcnJvciBpbiB0aGUKKwkJICogZGF0YSBiYXNlLgor
CQkgKi8KKwkJZXJybm8gPSBFTk9FTlQ7CisJCWNvcnJ1cHQoTlVMTCwgIkFj
Y291bnRpbmcgY2FsbGVkIGZvciBub24tZXhpc3RpbmcgZG9tYWluICV1XG4i
LAorCQkJZG9taWQpOworCQlyZXR1cm4gRU5PRU5UOworCX0KKworCXJldHVy
biAwOworfQorCiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaWYgKCFjb25uIHx8ICFjb25uLT5kb21haW4p
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWlu
LmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKaW5kZXgg
NGVkZjFkYmE5NDI1Li4zYThjNmJhYjQ4YmEgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAorKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY0LDYgKzY0LDI2IEBAIGlu
dCBkb21haW5fZW50cnlfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBz
dHJ1Y3Qgbm9kZSAqKTsKIHZvaWQgZG9tYWluX2VudHJ5X2RlYyhzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKik7CiBpbnQgZG9tYWlu
X2VudHJ5X2ZpeCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBudW0sIGJvb2wg
dXBkYXRlKTsKIGludCBkb21haW5fZW50cnkoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOworaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVkIGludCBk
b21pZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjayk7CisKKy8qCisg
KiBkb21haW5fbWVtb3J5X2FkZF9jaGsoKTogdG8gYmUgdXNlZCB3aGVuIG1l
bW9yeSBxdW90YSBzaG91bGQgYmUgY2hlY2tlZC4KKyAqIE5vdCB0byBiZSB1
c2VkIHdoZW4gc3BlY2lmeWluZyBhIG5lZ2F0aXZlIG1lbSB2YWx1ZSwgYXMg
bG93ZXJpbmcgdGhlIHVzZWQKKyAqIG1lbW9yeSBzaG91bGQgYWx3YXlzIGJl
IGFsbG93ZWQuCisgKi8KK3N0YXRpYyBpbmxpbmUgaW50IGRvbWFpbl9tZW1v
cnlfYWRkX2Noayh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0pCit7CisJ
cmV0dXJuIGRvbWFpbl9tZW1vcnlfYWRkKGRvbWlkLCBtZW0sIGZhbHNlKTsK
K30KKy8qCisgKiBkb21haW5fbWVtb3J5X2FkZF9ub2NoaygpOiB0byBiZSB1
c2VkIHdoZW4gbWVtb3J5IHF1b3RhIHNob3VsZCBub3QgYmUKKyAqIGNoZWNr
ZWQsIGUuZy4gd2hlbiBsb3dlcmluZyBtZW1vcnkgdXNhZ2UsIG9yIGluIGFu
IGVycm9yIGNhc2UgZm9yIHVuZG9pbmcKKyAqIGEgcHJldmlvdXMgbWVtb3J5
IGFkanVzdG1lbnQuCisgKi8KK3N0YXRpYyBpbmxpbmUgdm9pZCBkb21haW5f
bWVtb3J5X2FkZF9ub2Noayh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0p
Cit7CisJZG9tYWluX21lbW9yeV9hZGQoZG9taWQsIG1lbSwgdHJ1ZSk7Cit9
CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-12.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-12.patch"
Content-Transfer-Encoding: base64

RnJvbSAzZWNmMTU3MjhkNzUxNmU3NTY0ZjI5ZDJkZDc2NzI0YTNlZDk2Y2M0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3IgcmVzcG9uc2VzCgpBZGQgdGhlIG1lbW9yeSBh
Y2NvdW50aW5nIGZvciBxdWV1ZWQgcmVzcG9uc2VzLgoKSW4gY2FzZSBhZGRp
bmcgYSB3YXRjaCBldmVudCBmb3IgYSBndWVzdCBpcyBjYXVzaW5nIHRoZSBo
YXJkIG1lbW9yeQpxdW90YSBvZiB0aGF0IGd1ZXN0IHRvIGJlIHZpb2xhdGVk
LCB0aGUgZXZlbnQgaXMgZHJvcHBlZC4gVGhpcyB3aWxsCmVuc3VyZSB0aGF0
IGl0IGlzIGltcG9zc2libGUgdG8gZHJpdmUgYW5vdGhlciBndWVzdCBwYXN0
IGl0cyBtZW1vcnkKcXVvdGEgYnkgZ2VuZXJhdGluZyBpbnNhbmUgYW1vdW50
cyBvZiBldmVudHMgZm9yIHRoYXQgZ3Vlc3QuIFRoaXMgaXMKZXNwZWNpYWxs
eSBpbXBvcnRhbnQgZm9yIHByb3RlY3RpbmcgZHJpdmVyIGRvbWFpbnMgZnJv
bSB0aGF0IGF0dGFjawp2ZWN0b3IuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
NiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4g
R3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggOWZkODNlYTAyNTlhLi40MzIyZDNjZjYz
YTEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MjU3LDYgKzI1Nyw4IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0
YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIC1vdXQtPmhkci5tc2cu
bGVuIC0gc2l6ZW9mKG91dC0+aGRyKSk7CisKIAlpZiAob3V0LT5oZHIubXNn
LnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKIAkJcmVxID0gb3V0LT5wZW5k
LnJlcTsKIAkJaWYgKHJlcSkgewpAQCAtODQ1LDExICs4NDcsMTQgQEAgdm9p
ZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhz
ZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAliZGF0YS0+dGltZW91dF9tc2VjID0g
MDsKIAliZGF0YS0+d2F0Y2hfZXZlbnQgPSBmYWxzZTsKIAotCWlmIChsZW4g
PD0gREVGQVVMVF9CVUZGRVJfU0laRSkKKwlpZiAobGVuIDw9IERFRkFVTFRf
QlVGRkVSX1NJWkUpIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZh
dWx0X2J1ZmZlcjsKLQllbHNlIHsKKwkJLyogRG9uJ3QgY2hlY2sgcXVvdGEs
IHBhdGggbWlnaHQgYmUgdXNlZCBmb3IgcmV0dXJuaW5nIGVycm9yLiAqLwor
CQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgbGVuICsgc2l6
ZW9mKGJkYXRhLT5oZHIpKTsKKwl9IGVsc2UgewogCQliZGF0YS0+YnVmZmVy
ID0gdGFsbG9jX2FycmF5KGJkYXRhLCBjaGFyLCBsZW4pOwotCQlpZiAoIWJk
YXRhLT5idWZmZXIpIHsKKwkJaWYgKCFiZGF0YS0+YnVmZmVyIHx8CisJCSAg
ICBkb21haW5fbWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVv
ZihiZGF0YS0+aGRyKSkpIHsKIAkJCXNlbmRfZXJyb3IoY29ubiwgRU5PTUVN
KTsKIAkJCXJldHVybjsKIAkJfQpAQCAtOTE0LDYgKzkxOSwxMSBAQCB2b2lk
IHNlbmRfZXZlbnQoc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcSwgc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sCiAJCX0KIAl9CiAKKwlpZiAoZG9tYWluX21l
bW9yeV9hZGRfY2hrKGNvbm4tPmlkLCBsZW4gKyBzaXplb2YoYmRhdGEtPmhk
cikpKSB7CisJCXRhbGxvY19mcmVlKGJkYXRhKTsKKwkJcmV0dXJuOworCX0K
KwogCWlmICh0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMgJiYgZG9tYWluX2lz
X3VucHJpdmlsZWdlZChjb25uKSkgewogCQliZGF0YS0+dGltZW91dF9tc2Vj
ID0gZ2V0X25vd19tc2VjKCkgKyB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7
CiAJCWlmICghY29ubi0+dGltZW91dF9tc2VjKQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-13.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-13.patch"
Content-Transfer-Encoding: base64

RnJvbSA2YWI5YzFkZThiZTE4MTA1ODk1YjU0NWU2MWQ2ZTE1NTAxODc1OTUx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igd2F0Y2hlcwoKQWRkIHRoZSBtZW1vcnkgYWNj
b3VudGluZyBmb3IgcmVnaXN0ZXJlZCB3YXRjaGVzLgoKV2hlbiBhIHNvY2tl
dCBjb25uZWN0aW9uIGlzIGRlc3Ryb3llZCwgdGhlIGFzc29jaWF0ZWQgd2F0
Y2hlcyBhcmUKcmVtb3ZlZCwgdG9vLiBJbiBvcmRlciB0byBrZWVwIG1lbW9y
eSBhY2NvdW50aW5nIGNvcnJlY3QgdGhlIHdhdGNoZXMKbXVzdCBiZSByZW1v
dmVkIGV4cGxpY2l0bHkgdmlhIGEgY2FsbCBvZiBjb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcygpIGZyb20KZGVzdHJveV9jb25uKCkuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggNDMyMmQzY2Y2M2ExLi4w
ZjU4OWExZjYzYTAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwpAQCAtNDA3LDYgKzQwNyw3IEBAIHN0YXRpYyBpbnQgZGVzdHJveV9j
b25uKHZvaWQgKl9jb25uKQogCX0KIAogCWNvbm5fZnJlZV9idWZmZXJlZF9k
YXRhKGNvbm4pOworCWNvbm5fZGVsZXRlX2FsbF93YXRjaGVzKGNvbm4pOwog
CWxpc3RfZm9yX2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxp
c3QpCiAJCXJlcS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwppbmRleCBjNTBjMDU3NWYwZjEu
LjcxMThjMzBlOGMzMiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX3dhdGNoLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X3dhdGNoLmMKQEAgLTIyNCw3ICsyMjQsOCBAQCBpbnQgZG9fd2F0Y2goc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICpp
bikKIAkJcmV0dXJuIEVOT01FTTsKIAl3YXRjaC0+bm9kZSA9IHRhbGxvY19z
dHJkdXAod2F0Y2gsIHZlY1swXSk7CiAJd2F0Y2gtPnRva2VuID0gdGFsbG9j
X3N0cmR1cCh3YXRjaCwgdmVjWzFdKTsKLQlpZiAoIXdhdGNoLT5ub2RlIHx8
ICF3YXRjaC0+dG9rZW4pIHsKKwlpZiAoIXdhdGNoLT5ub2RlIHx8ICF3YXRj
aC0+dG9rZW4gfHwKKwkgICAgZG9tYWluX21lbW9yeV9hZGRfY2hrKGNvbm4t
PmlkLCBzdHJsZW4odmVjWzBdKSArIHN0cmxlbih2ZWNbMV0pKSkgewogCQl0
YWxsb2NfZnJlZSh3YXRjaCk7CiAJCXJldHVybiBFTk9NRU07CiAJfQpAQCAt
MjY1LDYgKzI2Niw4IEBAIGludCBkb191bndhdGNoKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeSh3YXRjaCwgJmNvbm4tPndhdGNoZXMsIGxpc3QpIHsK
IAkJaWYgKHN0cmVxKHdhdGNoLT5ub2RlLCBub2RlKSAmJiBzdHJlcSh3YXRj
aC0+dG9rZW4sIHZlY1sxXSkpIHsKIAkJCWxpc3RfZGVsKCZ3YXRjaC0+bGlz
dCk7CisJCQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgLXN0
cmxlbih3YXRjaC0+bm9kZSkgLQorCQkJCQkJCSAgc3RybGVuKHdhdGNoLT50
b2tlbikpOwogCQkJdGFsbG9jX2ZyZWUod2F0Y2gpOwogCQkJZG9tYWluX3dh
dGNoX2RlYyhjb25uKTsKIAkJCXNlbmRfYWNrKGNvbm4sIFhTX1VOV0FUQ0gp
OwpAQCAtMjgwLDYgKzI4Myw4IEBAIHZvaWQgY29ubl9kZWxldGVfYWxsX3dh
dGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiAKIAl3aGlsZSAoKHdh
dGNoID0gbGlzdF90b3AoJmNvbm4tPndhdGNoZXMsIHN0cnVjdCB3YXRjaCwg
bGlzdCkpKSB7CiAJCWxpc3RfZGVsKCZ3YXRjaC0+bGlzdCk7CisJCWRvbWFp
bl9tZW1vcnlfYWRkX25vY2hrKGNvbm4tPmlkLCAtc3RybGVuKHdhdGNoLT5u
b2RlKSAtCisJCQkJCQkgIHN0cmxlbih3YXRjaC0+dG9rZW4pKTsKIAkJdGFs
bG9jX2ZyZWUod2F0Y2gpOwogCQlkb21haW5fd2F0Y2hfZGVjKGNvbm4pOwog
CX0K

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-14.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-14.patch"
Content-Transfer-Encoding: base64

RnJvbSAyM2E2OGIzMzhkMzZjMjFmYWU1MDk3NjFmZjllZDExN2FkOTZlNDZi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igbm9kZXMKCkFkZCB0aGUgbWVtb3J5IGFjY291
bnRpbmcgZm9yIFhlbnN0b3JlIG5vZGVzLiBJbiBvcmRlciB0byBtYWtlIHRo
aXMKbm90IHRvbyBjb21wbGljYXRlZCBhbGxvdyBmb3Igc29tZSBzbG9wcGlu
ZXNzIHdoZW4gd3JpdGluZyBub2Rlcy4gQW55CmhhcmQgcXVvdGEgdmlvbGF0
aW9uIHdpbGwgcmVzdWx0IGluIG5vIGZ1cnRoZXIgcmVxdWVzdHMgdG8gYmUg
YWNjZXB0ZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIy
LTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKaW5kZXggMGY1ODlhMWY2M2EwLi42ZWQxYWUyNjE0NzAgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNDk4LDYgKzQ5OCwx
MTcgQEAgc3RhdGljIHZvaWQgaW5pdGlhbGl6ZV9mZHMoaW50ICpwX3NvY2tf
cG9sbGZkX2lkeCwgaW50ICpwX3JvX3NvY2tfcG9sbGZkX2lkeCwKIAl9CiB9
CiAKK3N0YXRpYyB2b2lkIGdldF9hY2NfZGF0YShUREJfREFUQSAqa2V5LCBz
dHJ1Y3Qgbm9kZV9hY2NvdW50X2RhdGEgKmFjYykKK3sKKwlUREJfREFUQSBv
bGRfZGF0YTsKKwlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKKwor
CWlmIChhY2MtPm1lbW9yeSA8IDApIHsKKwkJb2xkX2RhdGEgPSB0ZGJfZmV0
Y2godGRiX2N0eCwgKmtleSk7CisJCS8qIE5vIGNoZWNrIGZvciBlcnJvciwg
YXMgdGhlIG5vZGUgbWlnaHQgbm90IGV4aXN0LiAqLworCQlpZiAob2xkX2Rh
dGEuZHB0ciA9PSBOVUxMKSB7CisJCQlhY2MtPm1lbW9yeSA9IDA7CisJCX0g
ZWxzZSB7CisJCQloZHIgPSAodm9pZCAqKW9sZF9kYXRhLmRwdHI7CisJCQlh
Y2MtPm1lbW9yeSA9IG9sZF9kYXRhLmRzaXplOworCQkJYWNjLT5kb21pZCA9
IGhkci0+cGVybXNbMF0uaWQ7CisJCX0KKwkJdGFsbG9jX2ZyZWUob2xkX2Rh
dGEuZHB0cik7CisJfQorfQorCisvKgorICogUGVyLXRyYW5zYWN0aW9uIG5v
ZGVzIG5lZWQgdG8gYmUgYWNjb3VudGVkIGZvciB0aGUgdHJhbnNhY3Rpb24g
b3duZXIuCisgKiBUaG9zZSBub2RlcyBhcmUgc3RvcmVkIGluIHRoZSBkYXRh
IGJhc2Ugd2l0aCB0aGUgdHJhbnNhY3Rpb24gZ2VuZXJhdGlvbgorICogY291
bnQgcHJlcGVuZGVkIChlLmcuIDEyMy9sb2NhbC9kb21haW4vLi4uKS4gU28g
dGVzdGluZyBmb3IgdGhlIG5vZGUncworICoga2V5IG5vdCB0byBzdGFydCB3
aXRoICIvIiBpcyBzdWZmaWNpZW50LgorICovCitzdGF0aWMgdW5zaWduZWQg
aW50IGdldF9hY2NfZG9taWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFRE
Ql9EQVRBICprZXksCisJCQkJICB1bnNpZ25lZCBpbnQgZG9taWQpCit7CisJ
cmV0dXJuICghY29ubiB8fCBrZXktPmRwdHJbMF0gPT0gJy8nKSA/IGRvbWlk
IDogY29ubi0+aWQ7Cit9CisKK2ludCBkb190ZGJfd3JpdGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFREQl9EQVRBICpkYXRh
LAorCQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MsIGJvb2wgbm9f
cXVvdGFfY2hlY2spCit7CisJc3RydWN0IHhzX3RkYl9yZWNvcmRfaGRyICpo
ZHIgPSAodm9pZCAqKWRhdGEtPmRwdHI7CisJc3RydWN0IG5vZGVfYWNjb3Vu
dF9kYXRhIG9sZF9hY2MgPSB7fTsKKwl1bnNpZ25lZCBpbnQgb2xkX2RvbWlk
LCBuZXdfZG9taWQ7CisJaW50IHJldDsKKworCWlmICghYWNjKQorCQlvbGRf
YWNjLm1lbW9yeSA9IC0xOworCWVsc2UKKwkJb2xkX2FjYyA9ICphY2M7CisK
KwlnZXRfYWNjX2RhdGEoa2V5LCAmb2xkX2FjYyk7CisJb2xkX2RvbWlkID0g
Z2V0X2FjY19kb21pZChjb25uLCBrZXksIG9sZF9hY2MuZG9taWQpOworCW5l
d19kb21pZCA9IGdldF9hY2NfZG9taWQoY29ubiwga2V5LCBoZHItPnBlcm1z
WzBdLmlkKTsKKworCS8qCisJICogRG9uJ3QgY2hlY2sgZm9yIEVOT0VOVCwg
YXMgd2Ugd2FudCB0byBiZSBhYmxlIHRvIHN3aXRjaCBvcnBoYW5lZAorCSAq
IG5vZGVzIHRvIG5ldyBvd25lcnMuCisJICovCisJaWYgKG9sZF9hY2MubWVt
b3J5KQorCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRfZG9taWQsCisJ
CQkJCS1vbGRfYWNjLm1lbW9yeSAtIGtleS0+ZHNpemUpOworCXJldCA9IGRv
bWFpbl9tZW1vcnlfYWRkKG5ld19kb21pZCwgZGF0YS0+ZHNpemUgKyBrZXkt
PmRzaXplLAorCQkJCW5vX3F1b3RhX2NoZWNrKTsKKwlpZiAocmV0KSB7CisJ
CS8qIEVycm9yIHBhdGgsIHNvIG5vIHF1b3RhIGNoZWNrLiAqLworCQlpZiAo
b2xkX2FjYy5tZW1vcnkpCisJCQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhv
bGRfZG9taWQsCisJCQkJCQlvbGRfYWNjLm1lbW9yeSArIGtleS0+ZHNpemUp
OworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIFREQiBzaG91bGQgc2V0IGVy
cm5vLCBidXQgZG9lc24ndCBldmVuIHNldCBlY29kZSBBRkFJQ1QuICovCisJ
aWYgKHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCAqZGF0YSwgVERCX1JFUExB
Q0UpICE9IDApIHsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsobmV3X2Rv
bWlkLCAtZGF0YS0+ZHNpemUgLSBrZXktPmRzaXplKTsKKwkJLyogRXJyb3Ig
cGF0aCwgc28gbm8gcXVvdGEgY2hlY2suICovCisJCWlmIChvbGRfYWNjLm1l
bW9yeSkKKwkJCWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKG9sZF9kb21pZCwK
KwkJCQkJCW9sZF9hY2MubWVtb3J5ICsga2V5LT5kc2l6ZSk7CisJCWVycm5v
ID0gRUlPOworCQlyZXR1cm4gZXJybm87CisJfQorCisJaWYgKGFjYykgewor
CQkvKiBEb24ndCB1c2UgbmV3X2RvbWlkLCBhcyBpdCBtaWdodCBiZSBhIHRy
YW5zYWN0aW9uIG5vZGUuICovCisJCWFjYy0+ZG9taWQgPSBoZHItPnBlcm1z
WzBdLmlkOworCQlhY2MtPm1lbW9yeSA9IGRhdGEtPmRzaXplOworCX0KKwor
CXJldHVybiAwOworfQorCitpbnQgZG9fdGRiX2RlbGV0ZShzdHJ1Y3QgY29u
bmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwKKwkJICBzdHJ1Y3Qgbm9k
ZV9hY2NvdW50X2RhdGEgKmFjYykKK3sKKwlzdHJ1Y3Qgbm9kZV9hY2NvdW50
X2RhdGEgdG1wX2FjYzsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisKKwlpZiAo
IWFjYykgeworCQlhY2MgPSAmdG1wX2FjYzsKKwkJYWNjLT5tZW1vcnkgPSAt
MTsKKwl9CisKKwlnZXRfYWNjX2RhdGEoa2V5LCBhY2MpOworCisJaWYgKHRk
Yl9kZWxldGUodGRiX2N0eCwgKmtleSkpIHsKKwkJZXJybm8gPSBFSU87CisJ
CXJldHVybiBlcnJubzsKKwl9CisKKwlpZiAoYWNjLT5tZW1vcnkpIHsKKwkJ
ZG9taWQgPSBnZXRfYWNjX2RvbWlkKGNvbm4sIGtleSwgYWNjLT5kb21pZCk7
CisJCWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKGRvbWlkLCAtYWNjLT5tZW1v
cnkgLSBrZXktPmRzaXplKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwogLyoK
ICAqIElmIGl0IGZhaWxzLCByZXR1cm5zIE5VTEwgYW5kIHNldHMgZXJybm8u
CiAgKiBUZW1wb3JhcnkgbWVtb3J5IGFsbG9jYXRpb25zIHdpbGwgYmUgZG9u
ZSB3aXRoIGN0eC4KQEAgLTU1MSw5ICs2NjIsMTUgQEAgc3RydWN0IG5vZGUg
KnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVjdCB4c19wZXJt
aXNzaW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5wZXJtczsKKwlu
b2RlLT5hY2MuZG9taWQgPSBub2RlLT5wZXJtcy5wWzBdLmlkOworCW5vZGUt
PmFjYy5tZW1vcnkgPSBkYXRhLmRzaXplOwogCWlmIChkb21haW5fYWRqdXN0
X25vZGVfcGVybXMoY29ubiwgbm9kZSkpCiAJCWdvdG8gZXJyb3I7CiAKKwkv
KiBJZiBvd25lciBpcyBnb25lIHJlc2V0IGN1cnJlbnRseSBhY2NvdW50ZWQg
bWVtb3J5IHNpemUuICovCisJaWYgKG5vZGUtPmFjYy5kb21pZCAhPSBub2Rl
LT5wZXJtcy5wWzBdLmlkKQorCQlub2RlLT5hY2MubWVtb3J5ID0gMDsKKwog
CS8qIERhdGEgaXMgYmluYXJ5IGJsb2IgKHVzdWFsbHkgYXNjaWksIG5vIG51
bCkuICovCiAJbm9kZS0+ZGF0YSA9IG5vZGUtPnBlcm1zLnAgKyBoZHItPm51
bV9wZXJtczsKIAkvKiBDaGlsZHJlbiBpcyBzdHJpbmdzLCBudWwgc2VwYXJh
dGVkLiAqLwpAQCAtNjE3LDEyICs3MzQsOSBAQCBpbnQgd3JpdGVfbm9kZV9y
YXcoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIHN0
cnVjdCBub2RlICpub2RlLAogCXAgKz0gbm9kZS0+ZGF0YWxlbjsKIAltZW1j
cHkocCwgbm9kZS0+Y2hpbGRyZW4sIG5vZGUtPmNoaWxkbGVuKTsKIAotCS8q
IFREQiBzaG91bGQgc2V0IGVycm5vLCBidXQgZG9lc24ndCBldmVuIHNldCBl
Y29kZSBBRkFJQ1QuICovCi0JaWYgKHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5
LCBkYXRhLCBUREJfUkVQTEFDRSkgIT0gMCkgewotCQljb3JydXB0KGNvbm4s
ICJXcml0ZSBvZiAlcyBmYWlsZWQiLCBrZXktPmRwdHIpOwotCQllcnJubyA9
IEVJTzsKLQkJcmV0dXJuIGVycm5vOwotCX0KKwlpZiAoZG9fdGRiX3dyaXRl
KGNvbm4sIGtleSwgJmRhdGEsICZub2RlLT5hY2MsIG5vX3F1b3RhX2NoZWNr
KSkKKwkJcmV0dXJuIEVJTzsKKwogCXJldHVybiAwOwogfQogCkBAIC0xMTIx
LDcgKzEyMzUsNyBAQCBzdGF0aWMgdm9pZCBkZWxldGVfbm9kZV9zaW5nbGUo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQog
CWlmIChhY2Nlc3Nfbm9kZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19ERUxF
VEUsICZrZXkpKQogCQlyZXR1cm47CiAKLQlpZiAodGRiX2RlbGV0ZSh0ZGJf
Y3R4LCBrZXkpICE9IDApIHsKKwlpZiAoZG9fdGRiX2RlbGV0ZShjb25uLCAm
a2V5LCAmbm9kZS0+YWNjKSAhPSAwKSB7CiAJCWNvcnJ1cHQoY29ubiwgIkNv
dWxkIG5vdCBkZWxldGUgJyVzJyIsIG5vZGUtPm5hbWUpOwogCQlyZXR1cm47
CiAJfQpAQCAtMTE4NCw2ICsxMjk4LDcgQEAgc3RhdGljIHN0cnVjdCBub2Rl
ICpjb25zdHJ1Y3Rfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29u
c3Qgdm9pZCAqY3R4LAogCS8qIE5vIGNoaWxkcmVuLCBubyBkYXRhICovCiAJ
bm9kZS0+Y2hpbGRyZW4gPSBub2RlLT5kYXRhID0gTlVMTDsKIAlub2RlLT5j
aGlsZGxlbiA9IG5vZGUtPmRhdGFsZW4gPSAwOworCW5vZGUtPmFjYy5tZW1v
cnkgPSAwOwogCW5vZGUtPnBhcmVudCA9IHBhcmVudDsKIAlyZXR1cm4gbm9k
ZTsKIApAQCAtMTE5MiwxNyArMTMwNywxNyBAQCBzdGF0aWMgc3RydWN0IG5v
ZGUgKmNvbnN0cnVjdF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBj
b25zdCB2b2lkICpjdHgsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRpYyB2
b2lkIGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3Qgbm9kZSAqbm9kZSkKK3N0YXRp
YyB2b2lkIGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgc3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJaWYgKHN0cmVxKG5vZGUtPm5h
bWUsICIvIikpCiAJCWNvcnJ1cHQoTlVMTCwgIkRlc3Ryb3lpbmcgcm9vdCBu
b2RlISIpOwogCi0JdGRiX2RlbGV0ZSh0ZGJfY3R4LCBub2RlLT5rZXkpOwor
CWRvX3RkYl9kZWxldGUoY29ubiwgJm5vZGUtPmtleSwgJm5vZGUtPmFjYyk7
CiB9CiAKIHN0YXRpYyBpbnQgZGVzdHJveV9ub2RlKHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKLQlkZXN0cm95X25v
ZGVfcm0obm9kZSk7CisJZGVzdHJveV9ub2RlX3JtKGNvbm4sIG5vZGUpOwog
CWRvbWFpbl9lbnRyeV9kZWMoY29ubiwgbm9kZSk7CiAKIAkvKgpAQCAtMTI1
NCw3ICsxMzY5LDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpjcmVhdGVfbm9k
ZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAog
CQkvKiBBY2NvdW50IGZvciBuZXcgbm9kZSAqLwogCQlpZiAoaS0+cGFyZW50
KSB7CiAJCQlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBpKSkgewotCQkJ
CWRlc3Ryb3lfbm9kZV9ybShpKTsKKwkJCQlkZXN0cm95X25vZGVfcm0oY29u
biwgaSk7CiAJCQkJcmV0dXJuIE5VTEw7CiAJCQl9CiAJCX0KQEAgLTIwNzcs
NyArMjE5Miw3IEBAIHN0YXRpYyBpbnQgY2xlYW5fc3RvcmVfKFREQl9DT05U
RVhUICp0ZGIsIFREQl9EQVRBIGtleSwgVERCX0RBVEEgdmFsLAogCWlmICgh
aGFzaHRhYmxlX3NlYXJjaChyZWFjaGFibGUsIG5hbWUpKSB7CiAJCWxvZygi
Y2xlYW5fc3RvcmU6ICclcycgaXMgb3JwaGFuZWQhIiwgbmFtZSk7CiAJCWlm
IChyZWNvdmVyeSkgewotCQkJdGRiX2RlbGV0ZSh0ZGIsIGtleSk7CisJCQlk
b190ZGJfZGVsZXRlKE5VTEwsICZrZXksIE5VTEwpOwogCQl9CiAJfQogCmRp
ZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCA0ZTUzMDcy
ZTYzN2MuLjUyMWJjODAzODRlNSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfY29yZS5oCkBAIC0xNDEsNiArMTQxLDExIEBAIHN0cnVjdCBub2Rl
X3Blcm1zIHsKIAlzdHJ1Y3QgeHNfcGVybWlzc2lvbnMgKnA7CiB9OwogCitz
dHJ1Y3Qgbm9kZV9hY2NvdW50X2RhdGEgeworCXVuc2lnbmVkIGludCBkb21p
ZDsKKwlpbnQgbWVtb3J5OwkJLyogLTEgaWYgdW5rbm93biAqLworfTsKKwog
c3RydWN0IG5vZGUgewogCWNvbnN0IGNoYXIgKm5hbWU7CiAJLyogS2V5IHVz
ZWQgdG8gdXBkYXRlIFREQiAqLwpAQCAtMTYzLDYgKzE2OCw5IEBAIHN0cnVj
dCBub2RlIHsKIAkvKiBDaGlsZHJlbiwgZWFjaCBudWwtdGVybWluYXRlZC4g
Ki8KIAl1bnNpZ25lZCBpbnQgY2hpbGRsZW47CiAJY2hhciAqY2hpbGRyZW47
CisKKwkvKiBBbGxvY2F0aW9uIGluZm9ybWF0aW9uIGZvciBub2RlIGN1cnJl
bnRseSBpbiBzdG9yZS4gKi8KKwlzdHJ1Y3Qgbm9kZV9hY2NvdW50X2RhdGEg
YWNjOwogfTsKIAogLyogUmV0dXJuIHRoZSBvbmx5IGFyZ3VtZW50IGluIHRo
ZSBpbnB1dC4gKi8KQEAgLTI1OCw2ICsyNjYsMTEgQEAgZXh0ZXJuIHhlbmdu
dHRhYl9oYW5kbGUgKip4Z3RfaGFuZGxlOwogCiBpbnQgcmVtZW1iZXJfc3Ry
aW5nKHN0cnVjdCBoYXNodGFibGUgKmhhc2gsIGNvbnN0IGNoYXIgKnN0cik7
CiAKK2ludCBkb190ZGJfd3JpdGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IFREQl9EQVRBICprZXksIFREQl9EQVRBICpkYXRhLAorCQkgc3RydWN0IG5v
ZGVfYWNjb3VudF9kYXRhICphY2MsIGJvb2wgbm9fcXVvdGFfY2hlY2spOwor
aW50IGRvX3RkYl9kZWxldGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFRE
Ql9EQVRBICprZXksCisJCSAgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICph
Y2MpOworCiB2b2lkIGNvbm5fZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKIAogI2VuZGlmIC8qIF9YRU5TVE9SRURfQ09S
RV9IICovCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
dHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFu
c2FjdGlvbi5jCmluZGV4IDc3OGI3ZTQzOWNiMy4uYzFiZWI0MGEzZDUxIDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rp
b24uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rp
b24uYwpAQCAtMTUzLDYgKzE1Myw5IEBAIHN0cnVjdCB0cmFuc2FjdGlvbgog
CS8qIExpc3Qgb2YgYWxsIHRyYW5zYWN0aW9ucyBhY3RpdmUgb24gdGhpcyBj
b25uZWN0aW9uLiAqLwogCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKIAorCS8q
IENvbm5lY3Rpb24gdGhpcyB0cmFuc2FjdGlvbiBpcyBhc3NvY2lhdGVkIHdp
dGguICovCisJc3RydWN0IGNvbm5lY3Rpb24gKmNvbm47CisKIAkvKiBDb25u
ZWN0aW9uLWxvY2FsIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNhY3Rpb24u
ICovCiAJdWludDMyX3QgaWQ7CiAKQEAgLTI5Miw2ICsyOTUsOCBAQCBpbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAogCiAJCWludHJvZHVjZSA9IHRydWU7CiAJCWktPnRhX25v
ZGUgPSBmYWxzZTsKKwkJLyogYWNjLm1lbW9yeSA8IDAgbWVhbnMgInVua25v
d24sIGdldCBzaXplIGZyb20gVERCIi4gKi8KKwkJbm9kZS0+YWNjLm1lbW9y
eSA9IC0xOwogCiAJCS8qCiAJCSAqIEFkZGl0aW9uYWwgdHJhbnNhY3Rpb24t
c3BlY2lmaWMgbm9kZSBmb3IgcmVhZCB0eXBlLiBXZSBvbmx5CkBAIC00MTYs
MTEgKzQyMSwxMSBAQCBzdGF0aWMgaW50IGZpbmFsaXplX3RyYW5zYWN0aW9u
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCQkJCQlnb3RvIGVycjsKIAkJ
CQloZHIgPSAodm9pZCAqKWRhdGEuZHB0cjsKIAkJCQloZHItPmdlbmVyYXRp
b24gPSArK2dlbmVyYXRpb247Ci0JCQkJcmV0ID0gdGRiX3N0b3JlKHRkYl9j
dHgsIGtleSwgZGF0YSwKLQkJCQkJCVREQl9SRVBMQUNFKTsKKwkJCQlyZXQg
PSBkb190ZGJfd3JpdGUoY29ubiwgJmtleSwgJmRhdGEsIE5VTEwsCisJCQkJ
CQkgICB0cnVlKTsKIAkJCQl0YWxsb2NfZnJlZShkYXRhLmRwdHIpOwogCQkJ
fSBlbHNlIHsKLQkJCQlyZXQgPSB0ZGJfZGVsZXRlKHRkYl9jdHgsIGtleSk7
CisJCQkJcmV0ID0gZG9fdGRiX2RlbGV0ZShjb25uLCAma2V5LCBOVUxMKTsK
IAkJCX0KIAkJCWlmIChyZXQpCiAJCQkJZ290byBlcnI7CkBAIC00MzEsNyAr
NDM2LDcgQEAgc3RhdGljIGludCBmaW5hbGl6ZV90cmFuc2FjdGlvbihzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKIAkJCX0KIAkJfQogCi0JCWlmIChpLT50
YV9ub2RlICYmIHRkYl9kZWxldGUodGRiX2N0eCwgdGFfa2V5KSkKKwkJaWYg
KGktPnRhX25vZGUgJiYgZG9fdGRiX2RlbGV0ZShjb25uLCAmdGFfa2V5LCBO
VUxMKSkKIAkJCWdvdG8gZXJyOwogCQlsaXN0X2RlbCgmaS0+bGlzdCk7CiAJ
CXRhbGxvY19mcmVlKGkpOwpAQCAtNDU5LDcgKzQ2NCw3IEBAIHN0YXRpYyBp
bnQgZGVzdHJveV90cmFuc2FjdGlvbih2b2lkICpfdHJhbnNhY3Rpb24pCiAJ
CQkJCQkJICAgICAgIGktPm5vZGUpOwogCQkJaWYgKHRyYW5zX25hbWUpIHsK
IAkJCQlzZXRfdGRiX2tleSh0cmFuc19uYW1lLCAma2V5KTsKLQkJCQl0ZGJf
ZGVsZXRlKHRkYl9jdHgsIGtleSk7CisJCQkJZG9fdGRiX2RlbGV0ZSh0cmFu
cy0+Y29ubiwgJmtleSwgTlVMTCk7CiAJCQl9CiAJCX0KIAkJbGlzdF9kZWwo
JmktPmxpc3QpOwpAQCAtNTAzLDYgKzUwOCw3IEBAIGludCBkb190cmFuc2Fj
dGlvbl9zdGFydChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKmluKQogCiAJSU5JVF9MSVNUX0hFQUQoJnRyYW5zLT5h
Y2Nlc3NlZCk7CiAJSU5JVF9MSVNUX0hFQUQoJnRyYW5zLT5jaGFuZ2VkX2Rv
bWFpbnMpOworCXRyYW5zLT5jb25uID0gY29ubjsKIAl0cmFucy0+ZmFpbCA9
IGZhbHNlOwogCXRyYW5zLT5nZW5lcmF0aW9uID0gKytnZW5lcmF0aW9uOwog
Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-15.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-15.patch"
Content-Transfer-Encoding: base64

RnJvbSBlYWNjMDMyZTllNjY4ZGNkY2JhY2I4N2JiYjYxYTdiYTJlMzk4Y2Rk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBleHBv
cnRzIGZvciBxdW90YSB2YXJpYWJsZXMKClNvbWUgcXVvdGEgdmFyaWFibGVz
IGFyZSBub3QgZXhwb3J0ZWQgdmlhIGhlYWRlciBmaWxlcy4KClRoaXMgaXMg
cGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggNTIxYmM4MDM4NGU1Li41YWJmMDZjMjFjOTggMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjMxLDYg
KzIzMSwxMSBAQCBleHRlcm4gVERCX0NPTlRFWFQgKnRkYl9jdHg7CiBleHRl
cm4gaW50IGRvbTBfZG9taWQ7CiBleHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBl
eHRlcm4gaW50IHByaXZfZG9taWQ7CitleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CitleHRlcm4gaW50IHF1b3RhX21heF90cmFuc2Fj
dGlvbjsKK2V4dGVybiBpbnQgcXVvdGFfbWF4X2VudHJ5X3NpemU7CitleHRl
cm4gaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlOworZXh0ZXJuIGludCBx
dW90YV9tYXhfcGF0aF9sZW47CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5
X3Blcl9kb21haW47CiBleHRlcm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CmRpZmYgLS1naXQg
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGMx
YmViNDBhM2Q1MS4uNmUyOTExOGM4MDBkIDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtMTc1LDcgKzE3
NSw2IEBAIHN0cnVjdCB0cmFuc2FjdGlvbgogCWJvb2wgZmFpbDsKIH07CiAK
LWV4dGVybiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uOwogdWludDY0X3Qg
Z2VuZXJhdGlvbjsKIAogc3RhdGljIHZvaWQgc2V0X3RkYl9rZXkoY29uc3Qg
Y2hhciAqbmFtZSwgVERCX0RBVEEgKmtleSkKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggNzExOGMzMGU4YzMyLi4xOWQwZmIw
MWIxYzQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5j
CkBAIC0zMSw4ICszMSw2IEBACiAjaW5jbHVkZSAieGVuc3RvcmVkX2RvbWFp
bi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90cmFuc2FjdGlvbi5oIgogCi1l
eHRlcm4gaW50IHF1b3RhX25iX3dhdGNoX3Blcl9kb21haW47Ci0KIHN0cnVj
dCB3YXRjaAogewogCS8qIFdhdGNoZXMgb24gdGhpcyBjb25uZWN0aW9uICov
Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.14-xenstored-16.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.14-xenstored-16.patch"
Content-Transfer-Encoding: base64

RnJvbSA1NzM0ZmI2NTVlODdlYzM4YzRlMGFmOTAyM2I1NGUxM2Q4MjdjN2U2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBjb250
cm9sIGNvbW1hbmQgZm9yIHNldHRpbmcgYW5kIHNob3dpbmcgcXVvdGEKCkFk
ZCBhIHhlbnN0b3JlLWNvbnRyb2wgY29tbWFuZCAicXVvdGEiIHRvOgotIHNo
b3cgY3VycmVudCBxdW90YSBzZXR0aW5ncwotIGNoYW5nZSBxdW90YSBzZXR0
aW5ncwotIHNob3cgY3VycmVudCBxdW90YSByZWxhdGVkIHZhbHVlcyBvZiBh
IGRvbWFpbgoKTm90ZSB0aGF0IGluIHRoZSBjYXNlIHRoZSBuZXcgcXVvdGEg
aXMgbG93ZXIgdGhhbiBleGlzdGluZyBvbmUsClhlbnN0b3JlZCBtYXkgY29u
dGludWUgdG8gaGFuZGxlIHJlcXVlc3RzIGZyb20gYSBkb21haW4gZXhjZWVk
aW5nIHRoZQpuZXcgbGltaXQgKGRlcGVuZHMgb24gd2hpY2ggb25lIGhhcyBi
ZWVuIGJyb2tlbikgYW5kIHRoZSBhbW91bnQgb2YKcmVzb3VyY2UgdXNlZCB3
aWxsIG5vdCBjaGFuZ2UuIEhvd2V2ZXIgdGhlIGRvbWFpbiB3aWxsIG5vdCBi
ZSBhYmxlIHRvCmNyZWF0ZSBtb3JlIHJlc291cmNlIChhc3NvY2lhdGVkIHRv
IHRoZSBxdW90YSkgdW50aWwgaXQgaXMgYmFjayB0byBiZWxvdwp0aGUgbGlt
aXQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNi4KClJlcG9ydGVkLWJ5OiBK
dWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5
OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdp
dCBhL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQgYi9kb2NzL21pc2MveGVuc3Rv
cmUudHh0CmluZGV4IDIwODFmMjBmNTVlNC4uMWY0MmEzNzdjMTBmIDEwMDY0
NAotLS0gYS9kb2NzL21pc2MveGVuc3RvcmUudHh0CisrKyBiL2RvY3MvbWlz
Yy94ZW5zdG9yZS50eHQKQEAgLTMyOSw2ICszMjksMTcgQEAgQ09OVFJPTAkJ
CTxjb21tYW5kPnxbPHBhcmFtZXRlcnM+fF0KIAlwcmludHw8c3RyaW5nPgog
CQlwcmludCA8c3RyaW5nPiB0byBzeXNsb2cgKHhlbnN0b3JlIHJ1bnMgYXMg
ZGFlbW9uKSBvcgogCQl0byBjb25zb2xlICh4ZW5zdG9yZSBydW5zIGFzIHN0
dWJkb20pCisJcXVvdGF8W3NldCA8bmFtZT4gPHZhbD58PGRvbWlkPl0KKwkJ
d2l0aG91dCBwYXJhbWV0ZXJzOiBwcmludCB0aGUgY3VycmVudCBxdW90YSBz
ZXR0aW5ncworCQl3aXRoICJzZXQgPG5hbWU+IDx2YWw+Ijogc2V0IHRoZSBx
dW90YSA8bmFtZT4gdG8gbmV3IHZhbHVlCisJCTx2YWw+IChUaGUgYWRtaW4g
c2hvdWxkIG1ha2Ugc3VyZSBhbGwgdGhlIGRvbWFpbiB1c2FnZSBpcworCQli
ZWxvdyB0aGUgcXVvdGEuIElmIGl0IGlzIG5vdCwgdGhlbiBYZW5zdG9yZWQg
bWF5IGNvbnRpbnVlIHRvCisJCWhhbmRsZSByZXF1ZXN0cyBmcm9tIHRoZSBk
b21haW4gYXMgbG9uZyBhcyB0aGUgcmVzb3VyY2UKKwkJdmlvbGF0aW5nIHRo
ZSBuZXcgcXVvdGEgc2V0dGluZyBpc24ndCBpbmNyZWFzZWQgZnVydGhlcikK
KwkJd2l0aCAiPGRvbWlkPiI6IHByaW50IHF1b3RhIHJlbGF0ZWQgYWNjb3Vu
dGluZyBkYXRhIGZvcgorCQl0aGUgZG9tYWluIDxkb21pZD4KKwlxdW90YS1z
b2Z0fFtzZXQgPG5hbWU+IDx2YWw+XQorCQlsaWtlIHRoZSAicXVvdGEiIGNv
bW1hbmQsIGJ1dCBmb3Igc29mdC1xdW90YS4KIAloZWxwCQkJPHN1cHBvcnRl
ZC1jb21tYW5kcz4KIAkJcmV0dXJuIGxpc3Qgb2Ygc3VwcG9ydGVkIGNvbW1h
bmRzIGZvciBDT05UUk9MCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCmluZGV4IGFiMDc5NGRlZWRjOC4uMDIyN2E1NTY1NjU3
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJv
bC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMK
QEAgLTE5LDYgKzE5LDcgQEAKICNpbmNsdWRlIDxlcnJuby5oPgogI2luY2x1
ZGUgPHN0ZGFyZy5oPgogI2luY2x1ZGUgPHN0ZGlvLmg+CisjaW5jbHVkZSA8
c3RkbGliLmg+CiAjaW5jbHVkZSA8c3RyaW5nLmg+CiAKICNpbmNsdWRlICJ1
dGlscy5oIgpAQCAtNjIsNiArNjMsMTE0IEBAIHN0YXRpYyBpbnQgZG9fY29u
dHJvbF9sb2codm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwK
IAlyZXR1cm4gMDsKIH0KIAorc3RydWN0IHF1b3RhIHsKKwljb25zdCBjaGFy
ICpuYW1lOworCWludCAqcXVvdGE7CisJY29uc3QgY2hhciAqZGVzY3I7Cit9
OworCitzdGF0aWMgY29uc3Qgc3RydWN0IHF1b3RhIGhhcmRfcXVvdGFzW10g
PSB7CisJeyAibm9kZXMiLCAmcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbiwg
Ik5vZGVzIHBlciBkb21haW4iIH0sCisJeyAid2F0Y2hlcyIsICZxdW90YV9u
Yl93YXRjaF9wZXJfZG9tYWluLCAiV2F0Y2hlcyBwZXIgZG9tYWluIiB9LAor
CXsgInRyYW5zYWN0aW9ucyIsICZxdW90YV9tYXhfdHJhbnNhY3Rpb24sICJU
cmFuc2FjdGlvbnMgcGVyIGRvbWFpbiIgfSwKKwl7ICJvdXRzdGFuZGluZyIs
ICZxdW90YV9yZXFfb3V0c3RhbmRpbmcsCisJCSJPdXRzdGFuZGluZyByZXF1
ZXN0cyBwZXIgZG9tYWluIiB9LAorCXsgInRyYW5zYWN0aW9uLW5vZGVzIiwg
JnF1b3RhX3RyYW5zX25vZGVzLAorCQkiTWF4LiBudW1iZXIgb2YgYWNjZXNz
ZWQgbm9kZXMgcGVyIHRyYW5zYWN0aW9uIiB9LAorCXsgIm1lbW9yeSIsICZx
dW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkLAorCQkiVG90YWwgWGVuc3Rv
cmUgbWVtb3J5IHBlciBkb21haW4gKGVycm9yIGxldmVsKSIgfSwKKwl7ICJu
b2RlLXNpemUiLCAmcXVvdGFfbWF4X2VudHJ5X3NpemUsICJNYXguIHNpemUg
b2YgYSBub2RlIiB9LAorCXsgInBlcm1pc3Npb25zIiwgJnF1b3RhX25iX3Bl
cm1zX3Blcl9ub2RlLAorCQkiTWF4LiBudW1iZXIgb2YgcGVybWlzc2lvbnMg
cGVyIG5vZGUiIH0sCisJeyBOVUxMLCBOVUxMLCBOVUxMIH0KK307CisKK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgcXVvdGEgc29mdF9xdW90YXNbXSA9IHsKKwl7
ICJtZW1vcnkiLCAmcXVvdGFfbWVtb3J5X3Blcl9kb21haW5fc29mdCwKKwkJ
IlRvdGFsIFhlbnN0b3JlIG1lbW9yeSBwZXIgZG9tYWluICh3YXJuaW5nIGxl
dmVsKSIgfSwKKwl7IE5VTEwsIE5VTEwsIE5VTEwgfQorfTsKKworc3RhdGlj
IGludCBxdW90YV9zaG93X2N1cnJlbnQoY29uc3Qgdm9pZCAqY3R4LCBzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJCSAgICAgIGNvbnN0IHN0cnVjdCBx
dW90YSAqcXVvdGFzKQoreworCWNoYXIgKnJlc3A7CisJdW5zaWduZWQgaW50
IGk7CisKKwlyZXNwID0gdGFsbG9jX3N0cmR1cChjdHgsICJRdW90YSBzZXR0
aW5nczpcbiIpOworCWlmICghcmVzcCkKKwkJcmV0dXJuIEVOT01FTTsKKwor
CWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90YTsgaSsrKSB7CisJCXJlc3Ag
PSB0YWxsb2NfYXNwcmludGZfYXBwZW5kKHJlc3AsICIlLTE3czogJThkICVz
XG4iLAorCQkJCQkgICAgICBxdW90YXNbaV0ubmFtZSwgKnF1b3Rhc1tpXS5x
dW90YSwKKwkJCQkJICAgICAgcXVvdGFzW2ldLmRlc2NyKTsKKwkJaWYgKCFy
ZXNwKQorCQkJcmV0dXJuIEVOT01FTTsKKwl9CisKKwlzZW5kX3JlcGx5KGNv
bm4sIFhTX0NPTlRST0wsIHJlc3AsIHN0cmxlbihyZXNwKSArIDEpOworCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcXVvdGFfc2V0KGNvbnN0IHZv
aWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCSAgICAgY2hh
ciAqKnZlYywgaW50IG51bSwgY29uc3Qgc3RydWN0IHF1b3RhICpxdW90YXMp
Cit7CisJdW5zaWduZWQgaW50IGk7CisJaW50IHZhbDsKKworCWlmIChudW0g
IT0gMikKKwkJcmV0dXJuIEVJTlZBTDsKKworCXZhbCA9IGF0b2kodmVjWzFd
KTsKKwlpZiAodmFsIDwgMSkKKwkJcmV0dXJuIEVJTlZBTDsKKworCWZvciAo
aSA9IDA7IHF1b3Rhc1tpXS5xdW90YTsgaSsrKSB7CisJCWlmICghc3RyY21w
KHZlY1swXSwgcXVvdGFzW2ldLm5hbWUpKSB7CisJCQkqcXVvdGFzW2ldLnF1
b3RhID0gdmFsOworCQkJc2VuZF9hY2soY29ubiwgWFNfQ09OVFJPTCk7CisJ
CQlyZXR1cm4gMDsKKwkJfQorCX0KKworCXJldHVybiBFSU5WQUw7Cit9CisK
K3N0YXRpYyBpbnQgcXVvdGFfZ2V0KGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sCisJCSAgICAgY2hhciAqKnZlYywgaW50IG51
bSkKK3sKKwlpZiAobnVtICE9IDEpCisJCXJldHVybiBFSU5WQUw7CisKKwly
ZXR1cm4gZG9tYWluX2dldF9xdW90YShjdHgsIGNvbm4sIGF0b2kodmVjWzBd
KSk7Cit9CisKK3N0YXRpYyBpbnQgZG9fY29udHJvbF9xdW90YSh2b2lkICpj
dHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAorCQkJICAgIGNoYXIgKip2
ZWMsIGludCBudW0pCit7CisJaWYgKG51bSA9PSAwKQorCQlyZXR1cm4gcXVv
dGFfc2hvd19jdXJyZW50KGN0eCwgY29ubiwgaGFyZF9xdW90YXMpOworCisJ
aWYgKCFzdHJjbXAodmVjWzBdLCAic2V0IikpCisJCXJldHVybiBxdW90YV9z
ZXQoY3R4LCBjb25uLCB2ZWMgKyAxLCBudW0gLSAxLCBoYXJkX3F1b3Rhcyk7
CisKKwlyZXR1cm4gcXVvdGFfZ2V0KGN0eCwgY29ubiwgdmVjLCBudW0pOwor
fQorCitzdGF0aWMgaW50IGRvX2NvbnRyb2xfcXVvdGFfcyh2b2lkICpjdHgs
IHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAorCQkJICAgICAgY2hhciAqKnZl
YywgaW50IG51bSkKK3sKKwlpZiAobnVtID09IDApCisJCXJldHVybiBxdW90
YV9zaG93X2N1cnJlbnQoY3R4LCBjb25uLCBzb2Z0X3F1b3Rhcyk7CisKKwlp
ZiAoIXN0cmNtcCh2ZWNbMF0sICJzZXQiKSkKKwkJcmV0dXJuIHF1b3RhX3Nl
dChjdHgsIGNvbm4sIHZlYyArIDEsIG51bSAtIDEsIHNvZnRfcXVvdGFzKTsK
KworCXJldHVybiBFSU5WQUw7Cit9CisKICNpZmRlZiBfX01JTklPU19fCiBz
dGF0aWMgaW50IGRvX2NvbnRyb2xfbWVtcmVwb3J0KHZvaWQgKmN0eCwgc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sCiAJCQkJY2hhciAqKnZlYywgaW50IG51
bSkKQEAgLTE1NCw2ICsyNjMsOCBAQCBzdGF0aWMgc3RydWN0IGNtZF9zIGNt
ZHNbXSA9IHsKIAl7ICJtZW1yZXBvcnQiLCBkb19jb250cm9sX21lbXJlcG9y
dCwgIls8ZmlsZT5dIiB9LAogI2VuZGlmCiAJeyAicHJpbnQiLCBkb19jb250
cm9sX3ByaW50LCAiPHN0cmluZz4iIH0sCisJeyAicXVvdGEiLCBkb19jb250
cm9sX3F1b3RhLCAiW3NldCA8bmFtZT4gPHZhbD58PGRvbWlkPl0iIH0sCisJ
eyAicXVvdGEtc29mdCIsIGRvX2NvbnRyb2xfcXVvdGFfcywgIltzZXQgPG5h
bWU+IDx2YWw+XSIgfSwKIAl7ICJoZWxwIiwgZG9fY29udHJvbF9oZWxwLCAi
IiB9LAogfTsKIApkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2RvbWFpbi5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFp
bi5jCmluZGV4IDc4NjNmYTU1NDg3ZC4uZGQzYWUxNWVhNGZkIDEwMDY0NAot
LS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCkBAIC0zMSw2ICsz
MSw3IEBACiAjaW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgogI2luY2x1
ZGUgInhlbnN0b3JlZF90cmFuc2FjdGlvbi5oIgogI2luY2x1ZGUgInhlbnN0
b3JlZF93YXRjaC5oIgorI2luY2x1ZGUgInhlbnN0b3JlZF9jb250cm9sLmgi
CiAKICNpbmNsdWRlIDx4ZW5ldnRjaG4uaD4KICNpbmNsdWRlIDx4ZW5jdHJs
Lmg+CkBAIC0zNDgsNiArMzQ5LDM4IEBAIHN0YXRpYyBzdHJ1Y3QgZG9tYWlu
ICpmaW5kX2RvbWFpbl9zdHJ1Y3QodW5zaWduZWQgaW50IGRvbWlkKQogCXJl
dHVybiBOVUxMOwogfQogCitpbnQgZG9tYWluX2dldF9xdW90YShjb25zdCB2
b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAorCQkgICAgIHVu
c2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1Y3QgZG9tYWluICpkID0gZmlu
ZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwljaGFyICpyZXNwOworCWludCB0
YTsKKworCWlmICghZCkKKwkJcmV0dXJuIEVOT0VOVDsKKworCXRhID0gZC0+
Y29ubiA/IGQtPmNvbm4tPnRyYW5zYWN0aW9uX3N0YXJ0ZWQgOiAwOworCXJl
c3AgPSB0YWxsb2NfYXNwcmludGYoY3R4LCAiRG9tYWluICV1OlxuIiwgZG9t
aWQpOworCWlmICghcmVzcCkKKwkJcmV0dXJuIEVOT01FTTsKKworI2RlZmlu
ZSBlbnQodCwgZSkgXAorCXJlc3AgPSB0YWxsb2NfYXNwcmludGZfYXBwZW5k
KHJlc3AsICIlLTE2czogJThkXG4iLCAjdCwgZSk7IFwKKwlpZiAoIXJlc3Ap
IHJldHVybiBFTk9NRU0KKworCWVudChub2RlcywgZC0+bmJlbnRyeSk7CisJ
ZW50KHdhdGNoZXMsIGQtPm5id2F0Y2gpOworCWVudCh0cmFuc2FjdGlvbnMs
IHRhKTsKKwllbnQob3V0c3RhbmRpbmcsIGQtPm5ib3V0c3RhbmRpbmcpOwor
CWVudChtZW1vcnksIGQtPm1lbW9yeSk7CisKKyN1bmRlZiBlbnQKKworCXNl
bmRfcmVwbHkoY29ubiwgWFNfQ09OVFJPTCwgcmVzcCwgc3RybGVuKHJlc3Ap
ICsgMSk7CisKKwlyZXR1cm4gMDsKK30KKwogc3RhdGljIHN0cnVjdCBkb21h
aW4gKmFsbG9jX2RvbWFpbih2b2lkICpjb250ZXh0LCB1bnNpZ25lZCBpbnQg
ZG9taWQpCiB7CiAJc3RydWN0IGRvbWFpbiAqZG9tYWluOwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCmluZGV4IDNhOGM2YmFiNDhi
YS4uZTAxM2E5OTkxY2E4IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2RvbWFpbi5oCkBAIC05MCw2ICs5MCw4IEBAIGludCBkb21haW5fd2F0
Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogdm9pZCBkb21haW5fb3V0
c3RhbmRpbmdfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKIHZvaWQg
ZG9tYWluX291dHN0YW5kaW5nX2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
bik7CiB2b2lkIGRvbWFpbl9vdXRzdGFuZGluZ19kb21pZF9kZWModW5zaWdu
ZWQgaW50IGRvbWlkKTsKK2ludCBkb21haW5fZ2V0X3F1b3RhKGNvbnN0IHZv
aWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCSAgICAgdW5z
aWduZWQgaW50IGRvbWlkKTsKIAogLyogU3BlY2lhbCBub2RlIHBlcm1pc3Np
b24gaGFuZGxpbmcuICovCiBpbnQgc2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IGNoYXIgKm5hbWUsCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSBlM2QwYWFjYWY1MzIxYjkyMDRkMmVjNjI4Zjk4YmE2OTQ5NjIzYjIy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IFN5bmNocm9uaXNlIGRlZmF1
bHRzIHdpdGggb3hlbnN0b3JlLmNvbmYuaW4KTUlNRS1WZXJzaW9uOiAxLjAK
Q29udGVudC1UeXBlOiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRl
bnQtVHJhbnNmZXItRW5jb2Rpbmc6IDhiaXQKCldlIGN1cnJlbnRseSBoYXZl
IDIgZGlmZmVyZW50IHNldCBvZiBkZWZhdWx0cyBpbiB1cHN0cmVhbSBYZW4g
Z2l0IHRyZWU6CiogZGVmaW5lZCBpbiB0aGUgc291cmNlIGNvZGUsIG9ubHkg
dXNlZCBpZiB0aGVyZSBpcyBubyBjb25maWcgZmlsZQoqIGRlZmluZWQgaW4g
dGhlIG94ZW5zdG9yZWQuY29uZi5pbiB1cHN0cmVhbSBYZW4KCkFuIG94ZW5z
dG9yZWQuY29uZiBmaWxlIGlzIG5vdCBtYW5kYXRvcnksIGFuZCBpZiBtaXNz
aW5nLCBtYXhyZXF1ZXN0cyBpbgpwYXJ0aWN1bGFyIGhhcyBhbiB1bnNhZmUg
ZGVmYXVsdC4KClJlc3luYyB0aGUgZGVmYXVsdHMgZnJvbSBveGVuc3RvcmVk
LmNvbmYuaW4gaW50byB0aGUgc291cmNlIGNvZGUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE2LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEVkd2luIFTDtnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2Vk
LWJ5OiBDaHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJp
eC5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Rl
ZmluZS5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5k
ZXggZWJlMThiOGUzMTJjLi42YjA2ZjgwODU5NWIgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2Nh
bWwveGVuc3RvcmVkL2RlZmluZS5tbApAQCAtMjEsOSArMjEsOSBAQCBsZXQg
eHNfZGFlbW9uX3NvY2tldCA9IFBhdGhzLnhlbl9ydW5fc3RvcmVkIF4gIi9z
b2NrZXQiCiAKIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRocy54ZW5f
Y29uZmlnX2RpcgogCi1sZXQgbWF4d2F0Y2ggPSByZWYgKDUwKQotbGV0IG1h
eHRyYW5zYWN0aW9uID0gcmVmICgyMCkKLWxldCBtYXhyZXF1ZXN0cyA9IHJl
ZiAoLTEpICAgKCogbWF4aW11bSByZXF1ZXN0cyBwZXIgdHJhbnNhY3Rpb24g
KikKK2xldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQorbGV0IG1heHRyYW5zYWN0
aW9uID0gcmVmICgxMCkKK2xldCBtYXhyZXF1ZXN0cyA9IHJlZiAoMTAyNCkg
ICAoKiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAqKQogCiBs
ZXQgY29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCiBsZXQgY29uZmxp
Y3RfbWF4X2hpc3Rvcnlfc2Vjb25kcyA9IHJlZiAwLjA1CmRpZmYgLS1naXQg
YS90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwgYi90b29scy9vY2Ft
bC94ZW5zdG9yZWQvcXVvdGEubWwKaW5kZXggYWJjYWM5MTI4MDVhLi42ZTNk
NjQwMWFlODkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9x
dW90YS5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwK
QEAgLTIwLDggKzIwLDggQEAgZXhjZXB0aW9uIFRyYW5zYWN0aW9uX29wZW5l
ZAogCiBsZXQgd2FybiBmbXQgPSBMb2dnaW5nLndhcm4gInF1b3RhIiBmbXQK
IGxldCBhY3RpdmF0ZSA9IHJlZiB0cnVlCi1sZXQgbWF4ZW50ID0gcmVmICgx
MDAwMCkKLWxldCBtYXhzaXplID0gcmVmICg0MDk2KQorbGV0IG1heGVudCA9
IHJlZiAoMTAwMCkKK2xldCBtYXhzaXplID0gcmVmICgyMDQ4KQogCiB0eXBl
IHQgPSB7CiAJbWF4ZW50OiBpbnQ7ICAgICAgICAgICAgICAgKCogbWF4IGVu
dGl0aWVzIHBlciBkb21VICopCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSBiM2IyN2UwY2I2NmI2OWUwYTdkMzU2MmQ3ODQ2YTNlYWZkZDAyYTgw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogVGh1LCAyOCBKdWwgMjAyMiAxNzowODoxNSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IENoZWNrIGZvciBtYXhyZXF1
ZXN0cyBiZWZvcmUgcGVyZm9ybWluZwogb3BlcmF0aW9ucwpNSU1FLVZlcnNp
b246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRG
LTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKUHJldmlvdXNs
eSB3ZSdkIHBlcmZvcm0gdGhlIG9wZXJhdGlvbiwgcmVjb3JkIHRoZSB1cGRh
dGVkIHRyZWUgaW4gdGhlCnRyYW5zYWN0aW9uIHJlY29yZCwgdGhlbiB0cnkg
dG8gaW5zZXJ0IGEgd2F0Y2hvcCBwYXRoIGFuZCB0aGUgcmVwbHkgcGFja2V0
LgoKSWYgd2UgZXhjZWVkZWQgbWF4IHJlcXVlc3RzIHdlIHdvdWxkJ3ZlIHJl
dHVybmVkIEVRVU9UQSwgYnV0IHN0aWxsOgoqIGhhdmUgcGVyZm9ybWVkIHRo
ZSBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uJ3MgdHJlZQoqIGhhdmUg
cmVjb3JkZWQgdGhlIHdhdGNob3AsIG1ha2luZyB0aGlzIHF1ZXVlIGVmZmVj
dGl2ZWx5IHVuYm91bmRlZAoKSXQgaXMgYmV0dGVyIGlmIHdlIGNoZWNrIHdo
ZXRoZXIgd2UnZCBoYXZlIHJvb20gdG8gc3RvcmUgdGhlIG9wZXJhdGlvbiBi
ZWZvcmUKcGVyZm9ybWluZyB0aGUgdHJhbnNhY3Rpb24sIGFuZCByYWlzZSBF
UVVPVEEgdGhlcmUuICBUaGVuIHRoZSB0cmFuc2FjdGlvbgpyZWNvcmQgd29u
J3QgZ3Jvdy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2IC8gQ1ZFLTIwMjIt
NDIzMTcuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1h
em9uLmNvbT4KU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbCBiL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDI3NzkwZDRhNWM0MS4uZGQ1
OGU2OTc5Y2Y5IDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vz
cy5tbApAQCAtMzg5LDYgKzM4OSw3IEBAIGxldCBpbnB1dF9oYW5kbGVfZXJy
b3IgfmNvbnMgfmRvbXMgfmZjdCB+Y29uIH50IH5yZXEgPQogCWxldCByZXBs
eV9lcnJvciBlID0KIAkJUGFja2V0LkVycm9yIGUgaW4KIAl0cnkKKwkJVHJh
bnNhY3Rpb24uY2hlY2tfcXVvdGFfZXhuIH5wZXJtOihDb25uZWN0aW9uLmdl
dF9wZXJtIGNvbikgdDsKIAkJZmN0IGNvbiB0IGRvbXMgY29ucyByZXEuUGFj
a2V0LmRhdGEKIAl3aXRoCiAJfCBEZWZpbmUuSW52YWxpZF9wYXRoICAgICAg
ICAgIC0+IHJlcGx5X2Vycm9yICJFSU5WQUwiCkBAIC02ODEsOSArNjgyLDEw
IEBAIGxldCBwcm9jZXNzX3BhY2tldCB+c3RvcmUgfmNvbnMgfmRvbXMgfmNv
biB+cmVxID0KIAkJaW4KIAogCQlsZXQgcmVzcG9uc2UgPSB0cnkKKwkJCVRy
YW5zYWN0aW9uLmNoZWNrX3F1b3RhX2V4biB+cGVybTooQ29ubmVjdGlvbi5n
ZXRfcGVybSBjb24pIHQ7CiAJCQlpZiB0aWQgPD4gVHJhbnNhY3Rpb24ubm9u
ZSB0aGVuCiAJCQkJKCogUmVtZW1iZXIgdGhlIHJlcXVlc3QgYW5kIHJlc3Bv
bnNlIGZvciB0aGlzIG9wZXJhdGlvbiBpbiBjYXNlIHdlIG5lZWQgdG8gcmVw
bGF5IHRoZSB0cmFuc2FjdGlvbiAqKQotCQkJCVRyYW5zYWN0aW9uLmFkZF9v
cGVyYXRpb24gfnBlcm06KENvbm5lY3Rpb24uZ2V0X3Blcm0gY29uKSB0IHJl
cSByZXNwb25zZTsKKwkJCQlUcmFuc2FjdGlvbi5hZGRfb3BlcmF0aW9uIHQg
cmVxIHJlc3BvbnNlOwogCQkJcmVzcG9uc2UKIAkJd2l0aCBRdW90YS5MaW1p
dF9yZWFjaGVkIC0+CiAJCQlQYWNrZXQuRXJyb3IgIkVRVU9UQSIKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbAppbmRleCAx
N2IxYmRmMmVhZjkuLjI5NDE0M2UyMzM1YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3RyYW5zYWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbApAQCAtODUsNiArODUsNyBA
QCB0eXBlIHQgPSB7CiAJb2xkcm9vdDogU3RvcmUuTm9kZS50OwogCW11dGFi
bGUgcGF0aHM6IChYZW5idXMuWGIuT3Aub3BlcmF0aW9uICogU3RvcmUuUGF0
aC50KSBsaXN0OwogCW11dGFibGUgb3BlcmF0aW9uczogKFBhY2tldC5yZXF1
ZXN0ICogUGFja2V0LnJlc3BvbnNlKSBsaXN0OworCW11dGFibGUgcXVvdGFf
cmVhY2hlZDogYm9vbDsKIAltdXRhYmxlIHJlYWRfbG93cGF0aDogU3RvcmUu
UGF0aC50IG9wdGlvbjsKIAltdXRhYmxlIHdyaXRlX2xvd3BhdGg6IFN0b3Jl
LlBhdGgudCBvcHRpb247CiB9CkBAIC0xMjcsNiArMTI4LDcgQEAgbGV0IG1h
a2UgPyhpbnRlcm5hbD1mYWxzZSkgaWQgc3RvcmUgPQogCQlvbGRyb290ID0g
U3RvcmUuZ2V0X3Jvb3Qgc3RvcmU7CiAJCXBhdGhzID0gW107CiAJCW9wZXJh
dGlvbnMgPSBbXTsKKwkJcXVvdGFfcmVhY2hlZCA9IGZhbHNlOwogCQlyZWFk
X2xvd3BhdGggPSBOb25lOwogCQl3cml0ZV9sb3dwYXRoID0gTm9uZTsKIAl9
IGluCkBAIC0xNDMsMTMgKzE0NSwxOSBAQCBsZXQgZ2V0X3Jvb3QgdCA9IFN0
b3JlLmdldF9yb290IHQuc3RvcmUKIAogbGV0IGlzX3JlYWRfb25seSB0ID0g
dC5wYXRocyA9IFtdCiBsZXQgYWRkX3dvcCB0IHR5IHBhdGggPSB0LnBhdGhz
IDwtICh0eSwgcGF0aCkgOjogdC5wYXRocwotbGV0IGFkZF9vcGVyYXRpb24g
fnBlcm0gdCByZXF1ZXN0IHJlc3BvbnNlID0KK2xldCBnZXRfb3BlcmF0aW9u
cyB0ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCisKK2xldCBjaGVja19xdW90
YV9leG4gfnBlcm0gdCA9CiAJaWYgIURlZmluZS5tYXhyZXF1ZXN0cyA+PSAw
CiAJCSYmIG5vdCAoUGVybXMuQ29ubmVjdGlvbi5pc19kb20wIHBlcm0pCi0J
CSYmIExpc3QubGVuZ3RoIHQub3BlcmF0aW9ucyA+PSAhRGVmaW5lLm1heHJl
cXVlc3RzCi0JCXRoZW4gcmFpc2UgUXVvdGEuTGltaXRfcmVhY2hlZDsKKwkJ
JiYgKHQucXVvdGFfcmVhY2hlZCB8fCBMaXN0Lmxlbmd0aCB0Lm9wZXJhdGlv
bnMgPj0gIURlZmluZS5tYXhyZXF1ZXN0cykKKwkJdGhlbiBiZWdpbgorCQkJ
dC5xdW90YV9yZWFjaGVkIDwtIHRydWU7CisJCQlyYWlzZSBRdW90YS5MaW1p
dF9yZWFjaGVkOworCQllbmQKKworbGV0IGFkZF9vcGVyYXRpb24gdCByZXF1
ZXN0IHJlc3BvbnNlID0KIAl0Lm9wZXJhdGlvbnMgPC0gKHJlcXVlc3QsIHJl
c3BvbnNlKSA6OiB0Lm9wZXJhdGlvbnMKLWxldCBnZXRfb3BlcmF0aW9ucyB0
ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCiBsZXQgc2V0X3JlYWRfbG93cGF0
aCB0IHBhdGggPSB0LnJlYWRfbG93cGF0aCA8LSBnZXRfbG93ZXN0IHBhdGgg
dC5yZWFkX2xvd3BhdGgKIGxldCBzZXRfd3JpdGVfbG93cGF0aCB0IHBhdGgg
PSB0LndyaXRlX2xvd3BhdGggPC0gZ2V0X2xvd2VzdCBwYXRoIHQud3JpdGVf
bG93cGF0aAogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSA0OWNlNjY1OGFlZTc5ODFhNGUxOTI1ZTQ0OWJiZjk5ZjRlOGFmMzli
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogR0MgcGFyYW1ldGVyIHR1bmluZwpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKQnkgZGVm
YXVsdCB0aGUgT0NhbWwgZ2FyYmFnZSBjb2xsZWN0b3Igd291bGQgcmV0dXJu
IG1lbW9yeSB0byB0aGUgT1Mgb25seQphZnRlciB1bnVzZWQgbWVtb3J5IGlz
IDV4IGxpdmUgbWVtb3J5LiAgVHdlYWsgdGhpcyB0byAxMjAlIGluc3RlYWQs
IHdoaWNoCndvdWxkIG1hdGNoIHRoZSBtYWpvciBHQyBzcGVlZC4KClRoaXMg
aXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTD
tnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJp
c3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+Cgpk
aWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5kZXggNmIwNmY4
MDg1OTViLi5iYTYzYTgxNDdlMDkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL2RlZmluZS5tbApAQCAtMjUsNiArMjUsNyBAQCBsZXQgbWF4d2F0Y2gg
PSByZWYgKDEwMCkKIGxldCBtYXh0cmFuc2FjdGlvbiA9IHJlZiAoMTApCiBs
ZXQgbWF4cmVxdWVzdHMgPSByZWYgKDEwMjQpICAgKCogbWF4aW11bSByZXF1
ZXN0cyBwZXIgdHJhbnNhY3Rpb24gKikKIAorbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKIGxl
dCBjb25mbGljdF9tYXhfaGlzdG9yeV9zZWNvbmRzID0gcmVmIDAuMDUKIGxl
dCBjb25mbGljdF9yYXRlX2xpbWl0X2lzX2FnZ3JlZ2F0ZSA9IHJlZiB0cnVl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVk
Lm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAppbmRl
eCBkNDRhZTY3M2M0MmEuLjNiNTdhZDAxNmRmYiAxMDA2NDQKLS0tIGEvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCkBAIC0xMDQsNiArMTA0LDcg
QEAgbGV0IHBhcnNlX2NvbmZpZyBmaWxlbmFtZSA9CiAJCSgicXVvdGEtbWF4
c2l6ZSIsIENvbmZpZy5TZXRfaW50IFF1b3RhLm1heHNpemUpOwogCQkoInF1
b3RhLW1heHJlcXVlc3RzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHJl
cXVlc3RzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CisJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwogCQkoInBlcnNpc3RlbnQiLCBDb25maWcuU2V0X2Jvb2wgRGlz
ay5lbmFibGUpOwogCQkoInhlbnN0b3JlZC1sb2ctZmlsZSIsIENvbmZpZy5T
dHJpbmcgTG9nZ2luZy5zZXRfeGVuc3RvcmVkX2xvZ19kZXN0aW5hdGlvbik7
CkBAIC0yNjUsNiArMjY2LDY3IEBAIGxldCB0b19maWxlIHN0b3JlIGNvbnMg
ZmRzIGZpbGUgPQogCSAgICAgICAgKGZ1biAoKSAtPiBjbG9zZV9vdXQgY2hh
bm5lbCkKIGVuZAogCisoKgorCUJ5IGRlZmF1bHQgT0NhbWwncyBHQyBvbmx5
IHJldHVybnMgbWVtb3J5IHRvIHRoZSBPUyB3aGVuIGl0IGV4Y2VlZHMgYQor
CWNvbmZpZ3VyYWJsZSAnbWF4IG92ZXJoZWFkJyBzZXR0aW5nLgorCVRoZSBk
ZWZhdWx0IGlzIDUwMCUsIHRoYXQgaXMgNS82dGggb2YgdGhlIE9DYW1sIGhl
YXAgbmVlZHMgdG8gYmUgZnJlZQorCWFuZCBvbmx5IDEvNnRoIGxpdmUgZm9y
IGEgY29tcGFjdGlvbiB0byBiZSB0cmlnZ2VycmVkIHRoYXQgd291bGQKKwly
ZWxlYXNlIG1lbW9yeSBiYWNrIHRvIHRoZSBPUy4KKwlJZiB0aGUgbGltaXQg
aXMgbm90IGhpdCB0aGVuIHRoZSBPQ2FtbCBwcm9jZXNzIGNhbiByZXVzZSB0
aGF0IG1lbW9yeQorCWZvciBpdHMgb3duIHB1cnBvc2VzLCBidXQgb3RoZXIg
cHJvY2Vzc2VzIHdvbid0IGJlIGFibGUgdG8gdXNlIGl0LgorCisJVGhlcmUg
aXMgYWxzbyBhICdzcGFjZSBvdmVyaGVhZCcgc2V0dGluZyB0aGF0IGNvbnRy
b2xzIGhvdyBtdWNoIHdvcmsKKwllYWNoIG1ham9yIEdDIHNsaWNlIGRvZXMs
IGFuZCBieSBkZWZhdWx0IGFpbXMgYXQgaGF2aW5nIG5vIG1vcmUgdGhhbgor
CTgwJSBvciAxMjAlIChkZXBlbmRpbmcgb24gdmVyc2lvbikgZ2FyYmFnZSB2
YWx1ZXMgY29tcGFyZWQgdG8gbGl2ZQorCXZhbHVlcy4KKwlUaGlzIGRvZXNu
J3QgaGF2ZSBhcyBtdWNoIHJlbGV2YW5jZSB0byBtZW1vcnkgcmV0dXJuZWQg
dG8gdGhlIE9TIGFzCisJbG9uZyBhcyBzcGFjZV9vdmVyaGVhZCA8PSBtYXhf
b3ZlcmhlYWQsIGJlY2F1c2UgY29tcGFjdGlvbiBpcyBvbmx5CisJdHJpZ2dl
cnJlZCBhdCB0aGUgZW5kIG9mIG1ham9yIEdDIGN5Y2xlcy4KKworCVRoZSBk
ZWZhdWx0cyBhcmUgdG9vIGxhcmdlIG9uY2UgdGhlIHByb2dyYW0gc3RhcnRz
IHVzaW5nIH4xMDBNaUIgb2YKKwltZW1vcnksIGF0IHdoaWNoIHBvaW50IH41
MDBNaUIgd291bGQgYmUgdW5hdmFpbGFibGUgdG8gb3RoZXIgcHJvY2Vzc2Vz
CisJKHdoaWNoIHdvdWxkIGJlIGZpbmUgaWYgdGhpcyB3YXMgdGhlIG1haW4g
cHJvY2VzcyBpbiB0aGlzIFZNLCBidXQgaXQgaXMKKwlub3QpLgorCisJTWF4
IG92ZXJoZWFkIGNhbiBhbHNvIGJlIHNldCB0byAwLCBob3dldmVyIHRoaXMg
aXMgZm9yIHRlc3RpbmcgcHVycG9zZXMKKwlvbmx5IChzZXR0aW5nIGl0IGxv
d2VyIHRoYW4gJ3NwYWNlIG92ZXJoZWFkJyB3b3VsZG4ndCBoZWxwIGJlY2F1
c2UgdGhlCisJbWFqb3IgR0Mgd291bGRuJ3QgcnVuIGZhc3QgZW5vdWdoLCBh
bmQgY29tcGFjdGlvbiBkb2VzIGhhdmUgYQorCXBlcmZvcm1hbmNlIGNvc3Q6
IHdlIGNhbiBvbmx5IGNvbXBhY3QgY29udGlndW91cyByZWdpb25zLCBzbyBt
ZW1vcnkgaGFzCisJdG8gYmUgbW92ZWQgYXJvdW5kKS4KKworCU1heCBvdmVy
aGVhZCBjb250cm9scyBob3cgb2Z0ZW4gdGhlIGhlYXAgaXMgY29tcGFjdGVk
LCB3aGljaCBpcyB1c2VmdWwKKwlpZiB0aGVyZSBhcmUgYnVyc3Qgb2YgYWN0
aXZpdHkgZm9sbG93ZWQgYnkgbG9uZyBwZXJpb2RzIG9mIGlkbGUgc3RhdGUs
CisJb3IgaWYgYSBkb21haW4gcXVpdHMsIGV0Yy4gQ29tcGFjdGlvbiByZXR1
cm5zIG1lbW9yeSB0byB0aGUgT1MuCisKKwl3YXN0ZWQgPSBsaXZlICogc3Bh
Y2Vfb3ZlcmhlYWQgLyAxMDAKKworCUZvciBnbG9iYWxseSBvdmVycmlkaW5n
IHRoZSBHQyBzZXR0aW5ncyBvbmUgY2FuIHVzZSBPQ0FNTFJVTlBBUkFNLAor
CWhvd2V2ZXIgd2UgcHJvdmlkZSBhIGNvbmZpZyBmaWxlIG92ZXJyaWRlIHRv
IGJlIGNvbnNpc3RlbnQgd2l0aCBvdGhlcgorCW94ZW5zdG9yZWQgc2V0dGlu
Z3MuCisKKwlPbmUgbWlnaHQgd2FudCB0byBkeW5hbWljYWxseSBhZGp1c3Qg
dGhlIG92ZXJoZWFkIHNldHRpbmcgYmFzZWQgb24gdXNlZAorCW1lbW9yeSwg
aS5lLiB0byB1c2UgYSBmaXhlZCB1cHBlciBib3VuZCBpbiBieXRlcywgbm90
IHBlcmNlbnRhZ2UuIEhvd2V2ZXIKKwltZWFzdXJlbWVudHMgc2hvdyB0aGF0
IHN1Y2ggYWRqdXN0bWVudHMgaW5jcmVhc2UgR0Mgb3ZlcmhlYWQgbWFzc2l2
ZWx5LAorCXdoaWxlIHN0aWxsIG5vdCBndWFyYW50ZWVpbmcgdGhhdCBtZW1v
cnkgaXMgcmV0dXJuZWQgYW55IG1vcmUgcXVpY2tseQorCXRoYW4gd2l0aCBh
IHBlcmNlbnRhZ2UgYmFzZWQgc2V0dGluZy4KKworCVRoZSBhbGxvY2F0aW9u
IHBvbGljeSBjb3VsZCBhbHNvIGJlIHR3ZWFrZWQsIGUuZy4gZmlyc3QgZml0
IHdvdWxkIHJlZHVjZQorCWZyYWdtZW50YXRpb24gYW5kIHRodXMgbWVtb3J5
IHVzYWdlLCBidXQgdGhlIGRvY3VtZW50YXRpb24gd2FybnMgdGhhdCBpdAor
CWNhbiBiZSBzZW5zaWJseSBzbG93ZXIsIGFuZCBpbmRlZWQgb25lIG9mIG91
ciBvd24gdGVzdGNhc2VzIGNhbiB0cmlnZ2VyCisJc3VjaCBhIGNvcm5lciBj
YXNlIHdoZXJlIGl0IGlzIG11bHRpcGxlIHRpbWVzIHNsb3dlciwgc28gaXQg
aXMgYmVzdCB0byBrZWVwCisJdGhlIGRlZmF1bHQgYWxsb2NhdGlvbiBwb2xp
Y3kgKG5leHQtZml0L2Jlc3QtZml0IGRlcGVuZGluZyBvbiB2ZXJzaW9uKS4K
KworCVRoZXJlIGFyZSBvdGhlciB0d2Vha3MgdGhhdCBjYW4gYmUgYXR0ZW1w
dGVkIGluIHRoZSBmdXR1cmUsIGUuZy4gc2V0dGluZworCSd1bGltaXQgLXYn
IHRvIDc1JSBvZiBSQU0sIGhvd2V2ZXIgZ2V0dGluZyB0aGUga2VybmVsIHRv
IGFjdHVhbGx5IHJldHVybgorCU5VTEwgZnJvbSBhbGxvY2F0aW9ucyBpcyBk
aWZmaWN1bHQgZXZlbiB3aXRoIHRoYXQgc2V0dGluZywgYW5kIHdpdGhvdXQg
YQorCU5VTEwgdGhlIGVtZXJnZW5jeSBHQyB3b24ndCBiZSB0cmlnZ2VycmVk
LgorCVBlcmhhcHMgY2dyb3VwIGxpbWl0cyBjb3VsZCBoZWxwLCBidXQgZm9y
IG5vdyB0d2VhayB0aGUgc2FmZXN0IG9ubHkuCisqKQorCitsZXQgdHdlYWtf
Z2MgKCkgPQorCUdjLnNldCB7IChHYy5nZXQgKCkpIHdpdGggR2MubWF4X292
ZXJoZWFkID0gIURlZmluZS5nY19tYXhfb3ZlcmhlYWQgfQorCisKIGxldCBf
ID0KIAlsZXQgY2YgPSBkb19hcmd2IGluCiAJbGV0IHBpZGZpbGUgPQpAQCAt
Mjc0LDYgKzMzNiw4IEBAIGxldCBfID0KIAkJCWRlZmF1bHRfcGlkZmlsZQog
CQlpbgogCisJdHdlYWtfZ2MgKCk7CisKIAkodHJ5CiAJCVVuaXhleHQubWtk
aXJfcmVjIChGaWxlbmFtZS5kaXJuYW1lIHBpZGZpbGUpIDBvNzU1CiAJd2l0
aCBfIC0+Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSA2MmQwNWI5ZWQ1MzhjM2MxMDY0MjE1ZmIxNDMwYmI5YjFjNDlkZjRk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogRnJpLCAyOSBKdWwgMjAyMiAxODo1MzoyOSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC9saWJzL3hiOiBoaWRlIHR5cGUgb2YgWGIudApN
SU1FLVZlcnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNo
YXJzZXQ9VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoK
SGlkaW5nIHRoZSB0eXBlIHdpbGwgbWFrZSBpdCBlYXNpZXIgdG8gY2hhbmdl
IHRoZSBpbXBsZW1lbnRhdGlvbgppbiB0aGUgZnV0dXJlIHdpdGhvdXQgYnJl
YWtpbmcgY29kZSB0aGF0IHJlbGllcyBvbiBpdC4KCk5vIGZ1bmN0aW9uYWwg
Y2hhbmdlLgoKU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KKGNoZXJyeSBwaWNrZWQg
ZnJvbSBjb21taXQgN2FkZTMwYTE0NTE3MzRkMDQxMzYzYzc1MGE2NWQzMjJl
MjViNDdiYSkKClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94
Yi5tbCBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwKaW5kZXggMTA0ZDMx
OWQ3NzQ3Li44NDA0ZGRkOGE2ODIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L2xpYnMveGIveGIubWwKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5t
bApAQCAtMTk2LDYgKzE5Niw5IEBAIGxldCBwZWVrX291dHB1dCBjb24gPSBR
dWV1ZS5wZWVrIGNvbi5wa3Rfb3V0CiBsZXQgaW5wdXRfbGVuIGNvbiA9IFF1
ZXVlLmxlbmd0aCBjb24ucGt0X2luCiBsZXQgaGFzX2luX3BhY2tldCBjb24g
PSBRdWV1ZS5sZW5ndGggY29uLnBrdF9pbiA+IDAKIGxldCBnZXRfaW5fcGFj
a2V0IGNvbiA9IFF1ZXVlLnBvcCBjb24ucGt0X2luCitsZXQgaGFzX3BhcnRp
YWxfaW5wdXQgY29uID0gbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAorCXwg
SGF2ZUhkciBfIC0+IHRydWUKKwl8IE5vSGRyIChuLCBfKSAtPiBuIDwgUGFy
dGlhbC5oZWFkZXJfc2l6ZSAoKQogbGV0IGhhc19tb3JlX2lucHV0IGNvbiA9
CiAJbWF0Y2ggY29uLmJhY2tlbmQgd2l0aAogCXwgRmQgXyAgICAgICAgIC0+
IGZhbHNlCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDNhMDBkYTZj
ZGRjMS4uNzk0ZTM1YmIzNDNlIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNjYsMTMgKzY2LDcgQEAgdHlwZSBiYWNrZW5kX21tYXAgPSB7CiB0
eXBlIGJhY2tlbmRfZmQgPSB7IGZkIDogVW5peC5maWxlX2Rlc2NyOyB9CiB0
eXBlIGJhY2tlbmQgPSBGZCBvZiBiYWNrZW5kX2ZkIHwgWGVubW1hcCBvZiBi
YWNrZW5kX21tYXAKIHR5cGUgcGFydGlhbF9idWYgPSBIYXZlSGRyIG9mIFBh
cnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMKLXR5cGUgdCA9IHsK
LSAgYmFja2VuZCA6IGJhY2tlbmQ7Ci0gIHBrdF9pbiA6IFBhY2tldC50IFF1
ZXVlLnQ7Ci0gIHBrdF9vdXQgOiBQYWNrZXQudCBRdWV1ZS50OwotICBtdXRh
YmxlIHBhcnRpYWxfaW4gOiBwYXJ0aWFsX2J1ZjsKLSAgbXV0YWJsZSBwYXJ0
aWFsX291dCA6IHN0cmluZzsKLX0KK3R5cGUgdAogdmFsIGluaXRfcGFydGlh
bF9pbiA6IHVuaXQgLT4gcGFydGlhbF9idWYKIHZhbCByZWNvbm5lY3QgOiB0
IC0+IHVuaXQKIHZhbCBxdWV1ZSA6IHQgLT4gUGFja2V0LnQgLT4gdW5pdApA
QCAtOTcsNiArOTEsNyBAQCB2YWwgaGFzX291dHB1dCA6IHQgLT4gYm9vbAog
dmFsIHBlZWtfb3V0cHV0IDogdCAtPiBQYWNrZXQudAogdmFsIGlucHV0X2xl
biA6IHQgLT4gaW50CiB2YWwgaGFzX2luX3BhY2tldCA6IHQgLT4gYm9vbAor
dmFsIGhhc19wYXJ0aWFsX2lucHV0IDogdCAtPiBib29sCiB2YWwgZ2V0X2lu
X3BhY2tldCA6IHQgLT4gUGFja2V0LnQKIHZhbCBoYXNfbW9yZV9pbnB1dCA6
IHQgLT4gYm9vbAogdmFsIGlzX3NlbGVjdGFibGUgOiB0IC0+IGJvb2wKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1s
IGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb24ubWwKaW5kZXgg
NjVmOTllYTZmMjhhLi4zOGI0NzM2M2ExNzMgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCkBAIC0xMjUsOSArMTI1LDcg
QEAgbGV0IGdldF9wZXJtIGNvbiA9CiBsZXQgc2V0X3RhcmdldCBjb24gdGFy
Z2V0X2RvbWlkID0KIAljb24ucGVybSA8LSBQZXJtcy5Db25uZWN0aW9uLnNl
dF90YXJnZXQgKGdldF9wZXJtIGNvbikgfnBlcm1zOltQZXJtcy5SRUFEOyBQ
ZXJtcy5XUklURV0gdGFyZ2V0X2RvbWlkCiAKLWxldCBpc19iYWNrZW5kX21t
YXAgY29uID0gbWF0Y2ggY29uLnhiLlhlbmJ1cy5YYi5iYWNrZW5kIHdpdGgK
LQl8IFhlbmJ1cy5YYi5YZW5tbWFwIF8gLT4gdHJ1ZQotCXwgXyAtPiBmYWxz
ZQorbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBYZW5idXMuWGIuaXNfbW1h
cCBjb24ueGIKIAogbGV0IHNlbmRfcmVwbHkgY29uIHRpZCByaWQgdHkgZGF0
YSA9CiAJaWYgKFN0cmluZy5sZW5ndGggZGF0YSkgPiB4ZW5zdG9yZV9wYXls
b2FkX21heCAmJiAoaXNfYmFja2VuZF9tbWFwIGNvbikgdGhlbgpAQCAtMjgw
LDkgKzI3OCw3IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAK
IGxldCBkb19pbnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCiBs
ZXQgaGFzX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNv
bi54YgotbGV0IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IG1hdGNoIGNvbi54
Yi5YZW5idXMuWGIucGFydGlhbF9pbiB3aXRoCi0JfCBIYXZlSGRyIF8gLT4g
dHJ1ZQotCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBYZW5idXMuUGFydGlhbC5o
ZWFkZXJfc2l6ZSAoKQorbGV0IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IFhl
bmJ1cy5YYi5oYXNfcGFydGlhbF9pbnB1dCBjb24ueGIKIGxldCBwb3BfaW4g
Y29uID0gWGVuYnVzLlhiLmdldF9pbl9wYWNrZXQgY29uLnhiCiBsZXQgaGFz
X21vcmVfaW5wdXQgY29uID0gWGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNv
bi54YgogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSAxMWNlNTE5NjkzMjQ0NWNjZjY2NzlkMDRlZjJlMTk2Mzk1MTk2N2Mx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogQ2hhbmdlIFhiLmlucHV0IHRvIHJldHVybiBQ
YWNrZXQudCBvcHRpb24KTUlNRS1WZXJzaW9uOiAxLjAKQ29udGVudC1UeXBl
OiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRlbnQtVHJhbnNmZXIt
RW5jb2Rpbmc6IDhiaXQKClRoZSBxdWV1ZSBoZXJlIHdvdWxkIG9ubHkgZXZl
ciBob2xkIGF0IG1vc3Qgb25lIGVsZW1lbnQuICBUaGlzIHdpbGwgc2ltcGxp
ZnkKZm9sbG93LXVwIHBhdGNoZXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
Ni4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24u
Y29tPgpTaWduZWQtb2ZmLWJ5OiBFZHdpbiBUw7Zyw7ZrIDxlZHZpbi50b3Jv
a0BjaXRyaXguY29tPgpBY2tlZC1ieTogQ2hyaXN0aWFuIExpbmRpZyA8Y2hy
aXN0aWFuLmxpbmRpZ0BjaXRyaXguY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL2xpYnMveGIveGIubWwgYi90b29scy9vY2FtbC9saWJzL3hiL3hi
Lm1sCmluZGV4IDg0MDRkZGQ4YTY4Mi4uMTY1ZmQ0YTFlZGY0IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1sCisrKyBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKQEAgLTQ1LDcgKzQ1LDYgQEAgdHlwZSBwYXJ0
aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlhbC5wa3QgfCBOb0hkciBvZiBp
bnQgKiBieXRlcwogdHlwZSB0ID0KIHsKIAliYWNrZW5kOiBiYWNrZW5kOwot
CXBrdF9pbjogUGFja2V0LnQgUXVldWUudDsKIAlwa3Rfb3V0OiBQYWNrZXQu
dCBRdWV1ZS50OwogCW11dGFibGUgcGFydGlhbF9pbjogcGFydGlhbF9idWY7
CiAJbXV0YWJsZSBwYXJ0aWFsX291dDogc3RyaW5nOwpAQCAtNjIsNyArNjEs
NiBAQCBsZXQgcmVjb25uZWN0IHQgPSBtYXRjaCB0LmJhY2tlbmQgd2l0aAog
CQlYc19yaW5nLmNsb3NlIGJhY2tlbmQubW1hcDsKIAkJYmFja2VuZC5ldmVu
dGNobl9ub3RpZnkgKCk7CiAJCSgqIENsZWFyIG91ciBvbGQgY29ubmVjdGlv
biBzdGF0ZSAqKQotCQlRdWV1ZS5jbGVhciB0LnBrdF9pbjsKIAkJUXVldWUu
Y2xlYXIgdC5wa3Rfb3V0OwogCQl0LnBhcnRpYWxfaW4gPC0gaW5pdF9wYXJ0
aWFsX2luICgpOwogCQl0LnBhcnRpYWxfb3V0IDwtICIiCkBAIC0xMjQsNyAr
MTIyLDYgQEAgbGV0IG91dHB1dCBjb24gPQogCiAoKiBOQjogY2FuIHRocm93
IFJlY29ubmVjdCAqKQogbGV0IGlucHV0IGNvbiA9Ci0JbGV0IG5ld3BhY2tl
dCA9IHJlZiBmYWxzZSBpbgogCWxldCB0b19yZWFkID0KIAkJbWF0Y2ggY29u
LnBhcnRpYWxfaW4gd2l0aAogCQl8IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4g
UGFydGlhbC50b19jb21wbGV0ZSBwYXJ0aWFsX3BrdApAQCAtMTQzLDIxICsx
NDAsMTkgQEAgbGV0IGlucHV0IGNvbiA9CiAJCWlmIFBhcnRpYWwudG9fY29t
cGxldGUgcGFydGlhbF9wa3QgPSAwIHRoZW4gKAogCQkJbGV0IHBrdCA9IFBh
Y2tldC5vZl9wYXJ0aWFscGt0IHBhcnRpYWxfcGt0IGluCiAJCQljb24ucGFy
dGlhbF9pbiA8LSBpbml0X3BhcnRpYWxfaW4gKCk7Ci0JCQlRdWV1ZS5wdXNo
IHBrdCBjb24ucGt0X2luOwotCQkJbmV3cGFja2V0IDo9IHRydWUKLQkJKQor
CQkJU29tZSBwa3QKKwkJKSBlbHNlIE5vbmUKIAl8IE5vSGRyIChpLCBidWYp
ICAgICAgLT4KIAkJKCogd2UgY29tcGxldGUgdGhlIHBhcnRpYWwgaGVhZGVy
ICopCiAJCWlmIHN6ID4gMCB0aGVuCiAJCQlCeXRlcy5ibGl0IGIgMCBidWYg
KFBhcnRpYWwuaGVhZGVyX3NpemUgKCkgLSBpKSBzejsKIAkJY29uLnBhcnRp
YWxfaW4gPC0gaWYgc3ogPSBpIHRoZW4KLQkJCUhhdmVIZHIgKFBhcnRpYWwu
b2Zfc3RyaW5nIChCeXRlcy50b19zdHJpbmcgYnVmKSkgZWxzZSBOb0hkciAo
aSAtIHN6LCBidWYpCi0JKTsKLQkhbmV3cGFja2V0CisJCQlIYXZlSGRyIChQ
YXJ0aWFsLm9mX3N0cmluZyAoQnl0ZXMudG9fc3RyaW5nIGJ1ZikpIGVsc2Ug
Tm9IZHIgKGkgLSBzeiwgYnVmKTsKKwkJTm9uZQorCSkKIAogbGV0IG5ld2Nv
biBiYWNrZW5kID0gewogCWJhY2tlbmQgPSBiYWNrZW5kOwotCXBrdF9pbiA9
IFF1ZXVlLmNyZWF0ZSAoKTsKIAlwa3Rfb3V0ID0gUXVldWUuY3JlYXRlICgp
OwogCXBhcnRpYWxfaW4gPSBpbml0X3BhcnRpYWxfaW4gKCk7CiAJcGFydGlh
bF9vdXQgPSAiIjsKQEAgLTE5Myw5ICsxODgsNiBAQCBsZXQgaGFzX291dHB1
dCBjb24gPSBoYXNfbmV3X291dHB1dCBjb24gfHwgaGFzX29sZF9vdXRwdXQg
Y29uCiAKIGxldCBwZWVrX291dHB1dCBjb24gPSBRdWV1ZS5wZWVrIGNvbi5w
a3Rfb3V0CiAKLWxldCBpbnB1dF9sZW4gY29uID0gUXVldWUubGVuZ3RoIGNv
bi5wa3RfaW4KLWxldCBoYXNfaW5fcGFja2V0IGNvbiA9IFF1ZXVlLmxlbmd0
aCBjb24ucGt0X2luID4gMAotbGV0IGdldF9pbl9wYWNrZXQgY29uID0gUXVl
dWUucG9wIGNvbi5wa3RfaW4KIGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24g
PSBtYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCiAJfCBIYXZlSGRyIF8gLT4g
dHJ1ZQogCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBQYXJ0aWFsLmhlYWRlcl9z
aXplICgpCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDc5NGUzNWJi
MzQzZS4uOTFjNjgyMTYyY2VhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNzcsNyArNzcsNyBAQCB2YWwgd3JpdGVfZmQgOiBiYWNrZW5kX2Zk
IC0+ICdhIC0+IHN0cmluZyAtPiBpbnQgLT4gaW50CiB2YWwgd3JpdGVfbW1h
cCA6IGJhY2tlbmRfbW1hcCAtPiAnYSAtPiBzdHJpbmcgLT4gaW50IC0+IGlu
dAogdmFsIHdyaXRlIDogdCAtPiBzdHJpbmcgLT4gaW50IC0+IGludAogdmFs
IG91dHB1dCA6IHQgLT4gYm9vbAotdmFsIGlucHV0IDogdCAtPiBib29sCit2
YWwgaW5wdXQgOiB0IC0+IFBhY2tldC50IG9wdGlvbgogdmFsIG5ld2NvbiA6
IGJhY2tlbmQgLT4gdAogdmFsIG9wZW5fZmQgOiBVbml4LmZpbGVfZGVzY3Ig
LT4gdAogdmFsIG9wZW5fbW1hcCA6IFhlbm1tYXAubW1hcF9pbnRlcmZhY2Ug
LT4gKHVuaXQgLT4gdW5pdCkgLT4gdApAQCAtODksMTAgKzg5LDcgQEAgdmFs
IGhhc19uZXdfb3V0cHV0IDogdCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRw
dXQgOiB0IC0+IGJvb2wKIHZhbCBoYXNfb3V0cHV0IDogdCAtPiBib29sCiB2
YWwgcGVla19vdXRwdXQgOiB0IC0+IFBhY2tldC50Ci12YWwgaW5wdXRfbGVu
IDogdCAtPiBpbnQKLXZhbCBoYXNfaW5fcGFja2V0IDogdCAtPiBib29sCiB2
YWwgaGFzX3BhcnRpYWxfaW5wdXQgOiB0IC0+IGJvb2wKLXZhbCBnZXRfaW5f
cGFja2V0IDogdCAtPiBQYWNrZXQudAogdmFsIGhhc19tb3JlX2lucHV0IDog
dCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4gYm9vbAogdmFs
IGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sIGIvdG9vbHMvb2NhbWwvbGli
cy94cy94c3Jhdy5tbAppbmRleCBkOTgyZmIyNGRiYjEuLjQ1MWY4YjM4ZGJj
YyAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94cy94c3Jhdy5tbAor
KysgYi90b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sCkBAIC05NCwyNiAr
OTQsMTggQEAgbGV0IHBrdF9zZW5kIGNvbiA9CiAJZG9uZQogCiAoKiByZWNl
aXZlIG9uZSBwYWNrZXQgLSBjYW4gc2xlZXAgKikKLWxldCBwa3RfcmVjdiBj
b24gPQotCWxldCB3b3JrZG9uZSA9IHJlZiBmYWxzZSBpbgotCXdoaWxlIG5v
dCAhd29ya2RvbmUKLQlkbwotCQl3b3JrZG9uZSA6PSBYYi5pbnB1dCBjb24u
eGIKLQlkb25lOwotCVhiLmdldF9pbl9wYWNrZXQgY29uLnhiCitsZXQgcmVj
IHBrdF9yZWN2IGNvbiA9CisJbWF0Y2ggWGIuaW5wdXQgY29uLnhiIHdpdGgK
Kwl8IFNvbWUgcGFja2V0IC0+IHBhY2tldAorCXwgTm9uZSAtPiBwa3RfcmVj
diBjb24KIAogbGV0IHBrdF9yZWN2X3RpbWVvdXQgY29uIHRpbWVvdXQgPQog
CWxldCBmZCA9IFhiLmdldF9mZCBjb24ueGIgaW4KIAlsZXQgciwgXywgXyA9
IFVuaXguc2VsZWN0IFsgZmQgXSBbXSBbXSB0aW1lb3V0IGluCiAJaWYgciA9
IFtdIHRoZW4KIAkJdHJ1ZSwgTm9uZQotCWVsc2UgKAotCQlsZXQgd29ya2Rv
bmUgPSBYYi5pbnB1dCBjb24ueGIgaW4KLQkJaWYgd29ya2RvbmUgdGhlbgot
CQkJZmFsc2UsIChTb21lIChYYi5nZXRfaW5fcGFja2V0IGNvbi54YikpCi0J
CWVsc2UKLQkJCWZhbHNlLCBOb25lCi0JKQorCWVsc2UKKwkJZmFsc2UsIFhi
LmlucHV0IGNvbi54YgogCiBsZXQgcXVldWVfd2F0Y2hldmVudCBjb24gZGF0
YSA9CiAJbGV0IGxzID0gc3BsaXRfc3RyaW5nIH5saW1pdDoyICdcMDAwJyBk
YXRhIGluCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbi5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCmluZGV4IDM4YjQ3MzYzYTE3My4uY2MyMGUwNDdkMmI5IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbAorKysg
Yi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbApAQCAtMjc3
LDkgKzI3Nyw3IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAJ
SGFzaHRibC5maW5kIGNvbi50cmFuc2FjdGlvbnMgdGlkCiAKIGxldCBkb19p
bnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCi1sZXQgaGFzX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNvbi54YgogbGV0
IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfcGFydGlh
bF9pbnB1dCBjb24ueGIKLWxldCBwb3BfaW4gY29uID0gWGVuYnVzLlhiLmdl
dF9pbl9wYWNrZXQgY29uLnhiCiBsZXQgaGFzX21vcmVfaW5wdXQgY29uID0g
WGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54YgogCiBsZXQgaGFzX291
dHB1dCBjb24gPSBYZW5idXMuWGIuaGFzX291dHB1dCBjb24ueGIKQEAgLTMw
Nyw3ICszMDUsNyBAQCBsZXQgaXNfYmFkIGNvbiA9IG1hdGNoIGNvbi5kb20g
d2l0aCBOb25lIC0+IGZhbHNlIHwgU29tZSBkb20gLT4gRG9tYWluLmlzX2Jh
ZF9kbwogICAgUmVzdHJpY3Rpb25zIGJlbG93IGNhbiBiZSByZWxheGVkIG9u
Y2UgeGVuc3RvcmVkIGxlYXJucyB0byBkdW1wIG1vcmUKICAgIG9mIGl0cyBs
aXZlIHN0YXRlIGluIGEgc2FmZSB3YXkgKikKIGxldCBoYXNfZXh0cmFfY29u
bmVjdGlvbl9kYXRhIGNvbiA9Ci0JbGV0IGhhc19pbiA9IGhhc19pbnB1dCBj
b24gfHwgaGFzX3BhcnRpYWxfaW5wdXQgY29uIGluCisJbGV0IGhhc19pbiA9
IGhhc19wYXJ0aWFsX2lucHV0IGNvbiBpbgogCWxldCBoYXNfb3V0ID0gaGFz
X291dHB1dCBjb24gaW4KIAlsZXQgaGFzX3NvY2tldCA9IGNvbi5kb20gPSBO
b25lIGluCiAJbGV0IGhhc19ub25kZWZhdWx0X3Blcm1zID0gbWFrZV9wZXJt
IGNvbi5kb20gPD4gY29uLnBlcm0gaW4KZGlmZiAtLWdpdCBhL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL3Byb2Nlc3MubWwKaW5kZXggNmEzNDM1YzI2NWQzLi4yZDY3NDU2YTJh
YTAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNz
Lm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sCkBA
IC0xOTUsMTAgKzE5NSw5IEBAIGxldCBwYXJzZV9saXZlX3VwZGF0ZSBhcmdz
ID0KIAkJCXwgXyB3aGVuIFVuaXguZ2V0dGltZW9mZGF5ICgpIDwgdC5kZWFk
bGluZSAtPiBmYWxzZQogCQkJfCBsIC0+CiAJCQkJd2FybiAidGltZW91dCBy
ZWFjaGVkOiBoYXZlIHRvIHdhaXQsIG1pZ3JhdGUgb3Igc2h1dGRvd24gJWQg
ZG9tYWluczoiIChMaXN0Lmxlbmd0aCBsKTsKLQkJCQlsZXQgbXNncyA9IExp
c3QucmV2X21hcCAoZnVuIGNvbiAtPiBQcmludGYuc3ByaW50ZiAiJXM6ICVk
IHR4LCBpbjogJWIsIG91dDogJWIsIHBlcm06ICVzIgorCQkJCWxldCBtc2dz
ID0gTGlzdC5yZXZfbWFwIChmdW4gY29uIC0+IFByaW50Zi5zcHJpbnRmICIl
czogJWQgdHgsIG91dDogJWIsIHBlcm06ICVzIgogCQkJCQkoQ29ubmVjdGlv
bi5nZXRfZG9tc3RyIGNvbikKIAkJCQkJKENvbm5lY3Rpb24ubnVtYmVyX29m
X3RyYW5zYWN0aW9ucyBjb24pCi0JCQkJCShDb25uZWN0aW9uLmhhc19pbnB1
dCBjb24pCiAJCQkJCShDb25uZWN0aW9uLmhhc19vdXRwdXQgY29uKQogCQkJ
CQkoQ29ubmVjdGlvbi5nZXRfcGVybSBjb24gfD4gUGVybXMuQ29ubmVjdGlv
bi50b19zdHJpbmcpCiAJCQkJCSkgbCBpbgpAQCAtNzA1LDE2ICs3MDQsMTcg
QEAgbGV0IGRvX2lucHV0IHN0b3JlIGNvbnMgZG9tcyBjb24gPQogCQkJaW5m
byAiJXMgcmVxdWVzdHMgYSByZWNvbm5lY3QiIChDb25uZWN0aW9uLmdldF9k
b21zdHIgY29uKTsKIAkJCUhpc3RvcnkucmVjb25uZWN0IGNvbjsKIAkJCWlu
Zm8gIiVzIHJlY29ubmVjdGlvbiBjb21wbGV0ZSIgKENvbm5lY3Rpb24uZ2V0
X2RvbXN0ciBjb24pOwotCQkJZmFsc2UKKwkJCU5vbmUKIAkJfCBGYWlsdXJl
IGV4cCAtPgogCQkJZXJyb3IgImNhdWdodCBleGNlcHRpb24gJXMiIGV4cDsK
IAkJCWVycm9yICJnb3QgYSBiYWQgY2xpZW50ICVzIiAoc3ByaW50ZiAiJS04
cyIgKENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24pKTsKIAkJCUNvbm5lY3Rp
b24ubWFya19hc19iYWQgY29uOwotCQkJZmFsc2UKKwkJCU5vbmUKIAlpbgog
Ci0JaWYgbmV3cGFja2V0IHRoZW4gKAotCQlsZXQgcGFja2V0ID0gQ29ubmVj
dGlvbi5wb3BfaW4gY29uIGluCisJbWF0Y2ggbmV3cGFja2V0IHdpdGgKKwl8
IE5vbmUgLT4gKCkKKwl8IFNvbWUgcGFja2V0IC0+CiAJCWxldCB0aWQsIHJp
ZCwgdHksIGRhdGEgPSBYZW5idXMuWGIuUGFja2V0LnVucGFjayBwYWNrZXQg
aW4KIAkJbGV0IHJlcSA9IHtQYWNrZXQudGlkPXRpZDsgUGFja2V0LnJpZD1y
aWQ7IFBhY2tldC50eT10eTsgUGFja2V0LmRhdGE9ZGF0YX0gaW4KIApAQCAt
NzI0LDggKzcyNCw3IEBAIGxldCBkb19pbnB1dCBzdG9yZSBjb25zIGRvbXMg
Y29uID0KIAkJICAgICAgICAgKFhlbmJ1cy5YYi5PcC50b19zdHJpbmcgdHkp
IChzYW5pdGl6ZV9kYXRhIGRhdGEpOyAqKQogCQlwcm9jZXNzX3BhY2tldCB+
c3RvcmUgfmNvbnMgfmRvbXMgfmNvbiB+cmVxOwogCQl3cml0ZV9hY2Nlc3Nf
bG9nIH50eSB+dGlkIH5jb246KENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24p
IH5kYXRhOwotCQlDb25uZWN0aW9uLmluY3Jfb3BzIGNvbjsKLQkpCisJCUNv
bm5lY3Rpb24uaW5jcl9vcHMgY29uCiAKIGxldCBkb19vdXRwdXQgX3N0b3Jl
IF9jb25zIF9kb21zIGNvbiA9CiAJaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0
IGNvbiB0aGVuICgK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSA2ODI0YmQyOGI1OWVlZjg1ODI1N2RkZTgwNzZkNGY0NzAyNGJkM2Vi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94YjogQWRkIEJvdW5kZWRRdWV1ZQpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKRW5zdXJl
cyB3ZSBjYW5ub3Qgc3RvcmUgbW9yZSB0aGFuIFtjYXBhY2l0eV0gZWxlbWVu
dHMgaW4gYSBbUXVldWVdLiAgUmVwbGFjaW5nCmFsbCBRdWV1ZSB3aXRoIHRo
aXMgbW9kdWxlIHdpbGwgdGhlbiBlbnN1cmUgYXQgY29tcGlsZSB0aW1lIHRo
YXQgYWxsIFF1ZXVlcwphcmUgY29ycmVjdGx5IGJvdW5kIGNoZWNrZWQuCgpF
YWNoIGVsZW1lbnQgaW4gdGhlIHF1ZXVlIGhhcyBhIGNsYXNzIHdpdGggaXRz
IG93biBsaW1pdHMuICBUaGlzLCBpbiBhCnN1YnNlcXVlbnQgY2hhbmdlLCB3
aWxsIGVuc3VyZSB0aGF0IGNvbW1hbmQgcmVzcG9uc2VzIGNhbiBwcm9jZWVk
IGR1cmluZyBhCmZsb29kIG9mIHdhdGNoIGV2ZW50cy4KCk5vIGZ1bmN0aW9u
YWwgY2hhbmdlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRl
ZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVk
LW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcgPGNocmlzdGlhbi5saW5k
aWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJz
L3hiL3hiLm1sIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbAppbmRleCAx
NjVmZDRhMWVkZjQuLjQxOTdhMzg4OGE2OCAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwvbGlicy94Yi94Yi5tbAorKysgYi90b29scy9vY2FtbC9saWJzL3hi
L3hiLm1sCkBAIC0xNyw2ICsxNyw5OCBAQAogbW9kdWxlIE9wID0gc3RydWN0
IGluY2x1ZGUgT3AgZW5kCiBtb2R1bGUgUGFja2V0ID0gc3RydWN0IGluY2x1
ZGUgUGFja2V0IGVuZAogCittb2R1bGUgQm91bmRlZFF1ZXVlIDogc2lnCisJ
dHlwZSAoJ2EsICdiKSB0CisKKwkoKiogW2NyZWF0ZSB+Y2FwYWNpdHkgfmNs
YXNzaWZ5IH5saW1pdF0gY3JlYXRlcyBhIHF1ZXVlIHdpdGggbWF4aW11bSBb
Y2FwYWNpdHldIGVsZW1lbnRzLgorCSAgICBUaGlzIGlzIGJ1cnN0IGNhcGFj
aXR5LCBlYWNoIGVsZW1lbnQgaXMgZnVydGhlciBjbGFzc2lmaWVkIGFjY29y
ZGluZyB0byBbY2xhc3NpZnldLAorCSAgICBhbmQgZWFjaCBjbGFzcyBjYW4g
aGF2ZSBpdHMgb3duIFtsaW1pdF0uCisJICAgIFtjYXBhY2l0eV0gaXMgZW5m
b3JjZWQgYXMgYW4gb3ZlcmFsbCBsaW1pdC4KKwkgICAgVGhlIFtsaW1pdF0g
Y2FuIGJlIGR5bmFtaWMsIGFuZCBjYW4gYmUgc21hbGxlciB0aGFuIHRoZSBu
dW1iZXIgb2YgZWxlbWVudHMgYWxyZWFkeSBxdWV1ZWQgb2YgdGhhdCBjbGFz
cywKKwkgICAgaW4gd2hpY2ggY2FzZSB0aG9zZSBlbGVtZW50cyBhcmUgY29u
c2lkZXJlZCB0byB1c2UgImJ1cnN0IGNhcGFjaXR5Ii4KKwkgICopCisJdmFs
IGNyZWF0ZTogY2FwYWNpdHk6aW50IC0+IGNsYXNzaWZ5OignYSAtPiAnYikg
LT4gbGltaXQ6KCdiIC0+IGludCkgLT4gKCdhLCAnYikgdAorCisJKCoqIFtj
bGVhciBxXSBkaXNjYXJkcyBhbGwgZWxlbWVudHMgZnJvbSBbcV0gKikKKwl2
YWwgY2xlYXI6ICgnYSwgJ2IpIHQgLT4gdW5pdAorCisJKCoqIFtjYW5fcHVz
aCBxXSB3aGVuIFtsZW5ndGggcSA8IGNhcGFjaXR5XS4JKikKKwl2YWwgY2Fu
X3B1c2g6ICgnYSwgJ2IpIHQgLT4gJ2IgLT4gYm9vbAorCisJKCoqIFtwdXNo
IGUgcV0gYWRkcyBbZV0gYXQgdGhlIGVuZCBvZiBxdWV1ZSBbcV0gaWYgW2Nh
bl9wdXNoIHFdLCBvciByZXR1cm5zIFtOb25lXS4gKikKKwl2YWwgcHVzaDog
J2EgLT4gKCdhLCAnYikgdCAtPiB1bml0IG9wdGlvbgorCisJKCoqIFtwb3Ag
cV0gcmVtb3ZlcyBhbmQgcmV0dXJucyBmaXJzdCBlbGVtZW50IGluIFtxXSwg
b3IgcmFpc2VzIFtRdWV1ZS5FbXB0eV0uICopCisJdmFsIHBvcDogKCdhLCAn
YikgdCAtPiAnYQorCisJKCoqIFtwZWVrIHFdIHJldHVybnMgdGhlIGZpcnN0
IGVsZW1lbnQgaW4gW3FdLCBvciByYWlzZXMgW1F1ZXVlLkVtcHR5XS4gICop
CisJdmFsIHBlZWsgOiAoJ2EsICdiKSB0IC0+ICdhCisKKwkoKiogW2xlbmd0
aCBxXSByZXR1cm5zIHRoZSBjdXJyZW50IG51bWJlciBvZiBlbGVtZW50cyBp
biBbcV0gKikKKwl2YWwgbGVuZ3RoOiAoJ2EsICdiKSB0IC0+IGludAorCisJ
KCoqIFtkZWJ1ZyBzdHJpbmdfb2ZfY2xhc3MgcV0gcHJpbnRzIHF1ZXVlIHVz
YWdlIHN0YXRpc3RpY3MgaW4gYW4gdW5zcGVjaWZpZWQgaW50ZXJuYWwgZm9y
bWF0LiAqKQorCXZhbCBkZWJ1ZzogKCdiIC0+IHN0cmluZykgLT4gKF8sICdi
KSB0IC0+IHN0cmluZworZW5kID0gc3RydWN0CisJdHlwZSAoJ2EsICdiKSB0
ID0KKwkJeyBxOiAnYSBRdWV1ZS50CisJCTsgY2FwYWNpdHk6IGludAorCQk7
IGNsYXNzaWZ5OiAnYSAtPiAnYgorCQk7IGxpbWl0OiAnYiAtPiBpbnQKKwkJ
OyBjbGFzc19jb3VudDogKCdiLCBpbnQpIEhhc2h0YmwudAorCQl9CisKKwls
ZXQgY3JlYXRlIH5jYXBhY2l0eSB+Y2xhc3NpZnkgfmxpbWl0ID0KKwkJeyBj
YXBhY2l0eTsgcSA9IFF1ZXVlLmNyZWF0ZSAoKTsgY2xhc3NpZnk7IGxpbWl0
OyBjbGFzc19jb3VudCA9IEhhc2h0YmwuY3JlYXRlIDMgfQorCisJbGV0IGdl
dF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uID0gdHJ5IEhhc2h0YmwuZmluZCB0
LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIHdpdGggTm90X2ZvdW5kIC0+
IDAKKworCWxldCBjYW5fcHVzaF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9u
IGNsYXNzX2NvdW50ID0KKwkJUXVldWUubGVuZ3RoIHQucSA8IHQuY2FwYWNp
dHkgJiYgY2xhc3NfY291bnQgPCB0LmxpbWl0IGNsYXNzaWZpY2F0aW9uCisK
KwlsZXQgb2sgPSBTb21lICgpCisKKwlsZXQgcHVzaCBlIHQgPQorCQlsZXQg
Y2xhc3NpZmljYXRpb24gPSB0LmNsYXNzaWZ5IGUgaW4KKwkJbGV0IGNsYXNz
X2NvdW50ID0gZ2V0X2NvdW50IHQgY2xhc3NpZmljYXRpb24gaW4KKwkJaWYg
Y2FuX3B1c2hfaW50ZXJuYWwgdCBjbGFzc2lmaWNhdGlvbiBjbGFzc19jb3Vu
dCB0aGVuIGJlZ2luCisJCQlRdWV1ZS5wdXNoIGUgdC5xOworCQkJSGFzaHRi
bC5yZXBsYWNlIHQuY2xhc3NfY291bnQgY2xhc3NpZmljYXRpb24gKGNsYXNz
X2NvdW50ICsgMSk7CisJCQlvaworCQllbmQKKwkJZWxzZQorCQkJTm9uZQor
CisJbGV0IGNhbl9wdXNoIHQgY2xhc3NpZmljYXRpb24gPQorCQljYW5fcHVz
aF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9uIEBAIGdldF9jb3VudCB0IGNs
YXNzaWZpY2F0aW9uCisKKwlsZXQgY2xlYXIgdCA9CisJCVF1ZXVlLmNsZWFy
IHQucTsKKwkJSGFzaHRibC5yZXNldCB0LmNsYXNzX2NvdW50CisKKwlsZXQg
cG9wIHQgPQorCQlsZXQgZSA9IFF1ZXVlLnBvcCB0LnEgaW4KKwkJbGV0IGNs
YXNzaWZpY2F0aW9uID0gdC5jbGFzc2lmeSBlIGluCisJCWxldCAoKSA9IG1h
dGNoIGdldF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uIC0gMSB3aXRoCisJCXwg
MCAtPiBIYXNodGJsLnJlbW92ZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0
aW9uICgqIHJlZHVjZXMgbWVtdXNhZ2UgKikKKwkJfCBuIC0+IEhhc2h0Ymwu
cmVwbGFjZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIG4KKwkJaW4K
KwkJZQorCisJbGV0IHBlZWsgdCA9IFF1ZXVlLnBlZWsgdC5xCisJbGV0IGxl
bmd0aCB0ID0gUXVldWUubGVuZ3RoIHQucQorCisJbGV0IGRlYnVnIHN0cmlu
Z19vZl9jbGFzcyB0ID0KKwkJbGV0IGIgPSBCdWZmZXIuY3JlYXRlIDEyOCBp
bgorCQlQcmludGYuYnByaW50ZiBiICJCb3VuZGVkUXVldWUgY2FwYWNpdHk6
ICVkLCB1c2VkOiB7IiB0LmNhcGFjaXR5OworCQlIYXNodGJsLml0ZXIgKGZ1
biBwYWNrZXRfY2xhc3MgY291bnQgLT4KKwkJCVByaW50Zi5icHJpbnRmIGIg
IgklczogJWQiIChzdHJpbmdfb2ZfY2xhc3MgcGFja2V0X2NsYXNzKSBjb3Vu
dAorCQkpIHQuY2xhc3NfY291bnQ7CisJCVByaW50Zi5icHJpbnRmIGIgIn0i
OworCQlCdWZmZXIuY29udGVudHMgYgorZW5kCisKKwogZXhjZXB0aW9uIEVu
ZF9vZl9maWxlCiBleGNlcHRpb24gRWFnYWluCiBleGNlcHRpb24gTm9lbnQK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSAwZTBkODUzODVmNzczOTQ5MDA1ZWEyZWZhMTg5NTZkZTIzMDgxMzY0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNCArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogTGltaXQgbWF4aW11bSBpbi1mbGlnaHQgcmVx
dWVzdHMgLyBvdXRzdGFuZGluZyByZXBsaWVzCk1JTUUtVmVyc2lvbjogMS4w
CkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250
ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA4Yml0CgpJbnRyb2R1Y2UgYSBsaW1p
dCBvbiB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcGx5IHBhY2tldHMg
aW4gdGhlIHhlbmJ1cwpxdWV1ZS4gIFRoaXMgbGltaXRzIHRoZSBudW1iZXIg
b2YgaW4tZmxpZ2h0IHJlcXVlc3RzOiB3aGVuIHRoZSBvdXRwdXQgcXVldWUg
aXMKZnVsbCB3ZSdsbCBzdG9wIHByb2Nlc3NpbmcgaW5wdXRzIHVudGlsIHRo
ZSBvdXRwdXQgcXVldWUgaGFzIHJvb20gYWdhaW4uCgpUbyBhdm9pZCBhIGJ1
c3kgbG9vcCBvbiB0aGUgVW5peCBzb2NrZXQgd2Ugb25seSBhZGQgaXQgdG8g
dGhlIHdhdGNoZWQgaW5wdXQKZmlsZSBkZXNjcmlwdG9yIHNldCBpZiB3ZSdk
IGJlIGFibGUgdG8gY2FsbCBgaW5wdXRgIG9uIGl0LiAgRXZlbiB0aG91Z2gg
RG9tMAppcyB0cnVzdGVkIGFuZCBleGVtcHQgZnJvbSBxdW90YXMgYSBmbG9v
ZCBvZiBldmVudHMgbWlnaHQgY2F1c2UgYSBiYWNrbG9nCndoZXJlIGV2ZW50
cyBhcmUgcHJvZHVjZWQgZmFzdGVyIHRoYW4gZGFlbW9ucyBpbiBEb20wIGNh
biBjb25zdW1lIHRoZW0sIHdoaWNoCmNvdWxkIGxlYWQgdG8gYW4gdW5ib3Vu
ZGVkIHF1ZXVlIHNpemUgYW5kIE9PTS4KClRoZXJlZm9yZSB0aGUgeGVuYnVz
IHF1ZXVlIGxpbWl0IG11c3QgYXBwbHkgdG8gYWxsIGNvbm5lY3Rpb25zLCBE
b20wIGlzIG5vdApleGVtcHQgZnJvbSBpdCwgYWx0aG91Z2ggaWYgZXZlcnl0
aGluZyB3b3JrcyBjb3JyZWN0bHkgaXQgd2lsbCBldmVudHVhbGx5CmNhdGNo
IHVwLgoKVGhpcyBwcmV2ZW50cyBhIG1hbGljaW91cyBndWVzdCBmcm9tIHNl
bmRpbmcgbW9yZSBjb21tYW5kcyB3aGlsZSBpdCBoYXMKb3V0c3RhbmRpbmcg
d2F0Y2ggZXZlbnRzIG9yIGNvbW1hbmQgcmVwbGllcyBpbiBpdHMgaW5wdXQg
cmluZy4gIEhvd2V2ZXIgaWYgaXQKY2FuIGNhdXNlIHRoZSBnZW5lcmF0aW9u
IG9mIHdhdGNoIGV2ZW50cyBieSBvdGhlciBtZWFucyAoZS5nLiBieSBEb20w
LCBvcgphbm90aGVyIGNvb3BlcmF0aXZlIGd1ZXN0KSBhbmQgc3RvcCByZWFk
aW5nIGl0cyBvd24gcmluZyB0aGVuIHdhdGNoIGV2ZW50cwp3b3VsZCd2ZSBx
dWV1ZWQgdXAgd2l0aG91dCBsaW1pdC4KClRoZSB4ZW5zdG9yZSBwcm90b2Nv
bCBkb2Vzbid0IGhhdmUgYSBiYWNrLXByZXNzdXJlIG1lY2hhbmlzbSwgYW5k
IGRvZXNuJ3QKYWxsb3cgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzLiAgSW4gZmFj
dCwgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzIGlzIGtub3duIHRvIGJyZWFrCnNv
bWUgcGllY2VzIG9mIG5vcm1hbCBmdW5jdGlvbmFsaXR5LiAgVGhpcyBsZWF2
ZXMgbGl0dGxlIGNob2ljZSB0byBzYWZlbHkKaW1wbGVtZW50IHRoZSB4ZW5z
dG9yZSBwcm90b2NvbCB3aXRob3V0IGV4cG9zaW5nIHRoZSB4ZW5zdG9yZSBk
YWVtb24gdG8Kb3V0LW9mLW1lbW9yeSBhdHRhY2tzLgoKSW1wbGVtZW50IHRo
ZSBmaXggYXMgcGlwZXMgd2l0aCBib3VuZGVkIGJ1ZmZlcnM6CiogVXNlIGEg
Ym91bmRlZCBidWZmZXIgZm9yIHdhdGNoIGV2ZW50cwoqIFRoZSB3YXRjaCBz
dHJ1Y3R1cmUgd2lsbCBoYXZlIGEgYm91bmRlZCByZWNlaXZpbmcgcGlwZSBv
ZiB3YXRjaCBldmVudHMKKiBUaGUgc291cmNlIHdpbGwgaGF2ZSBhbiAib3Zl
cmZsb3ciIHBpcGUgb2YgcGVuZGluZyB3YXRjaCBldmVudHMgaXQgY291bGRu
J3QKICBkZWxpdmVyCgpJdGVtcyBhcmUgcXVldWVkIHVwIG9uIG9uZSBlbmQg
YW5kIGFyZSBzZW50IGFzIGZhciBhbG9uZyB0aGUgcGlwZSBhcyBwb3NzaWJs
ZToKCiAgc291cmNlIGRvbWFpbiAtPiB3YXRjaCAtPiB4ZW5idXMgb2YgdGFy
Z2V0IC0+IHhlbnN0b3JlIHJpbmcvc29ja2V0IG9mIHRhcmdldAoKSWYgdGhl
IHBpcGUgaXMgImZ1bGwiIGF0IGFueSBwb2ludCB0aGVuIGJhY2stcHJlc3N1
cmUgaXMgYXBwbGllZCBhbmQgd2UgcHJldmVudAptb3JlIGl0ZW1zIGZyb20g
YmVpbmcgcXVldWVkIHVwLiAgRm9yIHRoZSBzb3VyY2UgZG9tYWluIHRoaXMg
bWVhbnMgdGhhdCB3ZSdsbApzdG9wIGFjY2VwdGluZyBuZXcgY29tbWFuZHMg
YXMgbG9uZyBhcyBpdHMgcGlwZSBidWZmZXIgaXMgbm90IGVtcHR5LgoKQmVm
b3JlIHdlIHRyeSB0byBlbnF1ZXVlIGFuIGl0ZW0gd2UgZmlyc3QgY2hlY2sg
d2hldGhlciBpdCBpcyBwb3NzaWJsZSB0byBzZW5kCml0IGZ1cnRoZXIgZG93
biB0aGUgcGlwZSwgYnkgYXR0ZW1wdGluZyB0byByZWN1cnNpdmVseSBmbHVz
aCB0aGUgcGlwZXMuIFRoaXMKZW5zdXJlcyB0aGF0IHdlIHJldGFpbiB0aGUg
b3JkZXIgb2YgZXZlbnRzIGFzIG11Y2ggYXMgcG9zc2libGUuCgpXZSBtaWdo
dCBicmVhayBjYXVzYWxpdHkgb2Ygd2F0Y2ggZXZlbnRzIGlmIHRoZSB0YXJn
ZXQgZG9tYWluJ3MgcXVldWUgaXMgZnVsbAphbmQgd2UgbmVlZCB0byBzdGFy
dCB1c2luZyB0aGUgd2F0Y2gncyBxdWV1ZS4gIFRoaXMgaXMgYSBicmVha2lu
ZyBjaGFuZ2UgaW4KdGhlIHhlbnN0b3JlIHByb3RvY29sLCBidXQgb25seSBm
b3IgZG9tYWlucyB3aGljaCBhcmUgbm90IHByb2Nlc3NpbmcgdGhlaXIKaW5j
b21pbmcgcmluZyBhcyBleHBlY3RlZC4KCldoZW4gYSB3YXRjaCBpcyBkZWxl
dGVkIGl0cyBlbnRpcmUgcGVuZGluZyBxdWV1ZSBpcyBkcm9wcGVkIChubyBj
b2RlIGlzIG5lZWRlZApmb3IgdGhhdCwgYmVjYXVzZSBpdCBpcyBwYXJ0IG9m
IHRoZSAnd2F0Y2gnIHR5cGUpLgoKVGhlcmUgaXMgYSBjYWNoZSBvZiB3YXRj
aGVzIHRoYXQgaGF2ZSBwZW5kaW5nIGV2ZW50cyB0aGF0IHdlIGF0dGVtcHQg
dG8gZmx1c2gKYXQgZXZlcnkgY3ljbGUgaWYgcG9zc2libGUuCgpJbnRyb2R1
Y2UgMyBsaW1pdHMgaGVyZToKKiBxdW90YS1tYXh3YXRjaGV2ZW50cyBvbiB3
YXRjaCBldmVudCBkZXN0aW5hdGlvbjogd2hlbiB0aGlzIGlzIGhpdCB0aGUK
ICBzb3VyY2Ugd2lsbCBub3QgYmUgYWxsb3dlZCB0byBxdWV1ZSB1cCBtb3Jl
IHdhdGNoIGV2ZW50cy4KKiBxdW90YS1tYXhvdXN0YW5kaW5nIHdoaWNoIGlz
IHRoZSBudW1iZXIgb2YgcmVzcG9uc2VzIG5vdCByZWFkIGZyb20gdGhlIHJp
bmc6CiAgb25jZSBleGNlZWRlZCwgbm8gbW9yZSBpbnB1dHMgYXJlIHByb2Nl
c3NlZCB1bnRpbCBhbGwgb3V0c3RhbmRpbmcgcmVwbGllcwogIGFyZSBjb25z
dW1lZCBieSB0aGUgY2xpZW50LgoqIG92ZXJmbG93IHF1ZXVlIG9uIHRoZSB3
YXRjaCBldmVudCBzb3VyY2U6IGFsbCB3YXRjaGVzIHRoYXQgY2Fubm90IGJl
IHN0b3JlZAogIG9uIGRlc3RpbmF0aW9uIGFyZSBxdWV1ZWQgdXAgaGVyZSwg
YSBzaW5nbGUgY29tbWFuZCBjYW4gdHJpZ2dlciBtdWx0aXBsZQogIHdhdGNo
ZXMgKGUuZy4gZHVlIHRvIHJlY3Vyc2lvbikuCgpUaGUgb3ZlcmZsb3cgcXVl
dWUgY3VycmVudGx5IGRvZXNuJ3QgaGF2ZSBhbiB1cHBlciBib3VuZCwgaXQg
aXMgZGlmZmljdWx0IHRvCmFjY3VyYXRlbHkgY2FsY3VsYXRlIG9uZSBhcyBp
dCBkZXBlbmRzIG9uIHdoZXRoZXIgeW91IGFyZSBEb20wIGFuZCBob3cgbWFu
eQp3YXRjaGVzIGVhY2ggcGF0aCBoYXMgcmVnaXN0ZXJlZCBhbmQgaG93IG1h
bnkgd2F0Y2ggZXZlbnRzIHlvdSBjYW4gdHJpZ2dlcgp3aXRoIGEgc2luZ2xl
IGNvbW1hbmQgKGUuZy4gYSBjb21taXQpLiAgSG93ZXZlciB0aGVzZSBldmVu
dHMgd2VyZSBhbHJlYWR5CnVzaW5nIG1lbW9yeSwgdGhpcyBqdXN0IG1vdmVz
IHRoZW0gZWxzZXdoZXJlLCBhbmQgYXMgbG9uZyBhcyB3ZSBjb3JyZWN0bHkK
YmxvY2sgYSBkb21haW4gaXQgc2hvdWxkbid0IHJlc3VsdCBpbiB1bmJvdW5k
ZWQgbWVtb3J5IHVzYWdlLgoKTm90ZSB0aGF0IERvbTAgaXMgbm90IGV4Y2x1
ZGVkIGZyb20gdGhlc2UgY2hlY2tzLCBpdCBpcyBpbXBvcnRhbnQgdGhhdCBE
b20wIGlzCmVzcGVjaWFsbHkgbm90IGV4Y2x1ZGVkIHdoZW4gaXQgaXMgdGhl
IHNvdXJjZSwgc2luY2UgdGhlcmUgYXJlIG1hbnkgd2F5cyBpbgp3aGljaCBh
IGd1ZXN0IGNvdWxkIHRyaWdnZXIgRG9tMCB0byBzZW5kIGl0IHdhdGNoIGV2
ZW50cy4KClRoaXMgc2hvdWxkIHByb3RlY3QgYWdhaW5zdCBtYWxpY2lvdXMg
ZnJvbnRlbmRzIGFzIGxvbmcgYXMgdGhlIGJhY2tlbmQgZm9sbG93cwp0aGUg
UFYgeGVuc3RvcmUgcHJvdG9jb2wgYW5kIG9ubHkgZXhwb3NlcyBwYXRocyBu
ZWVkZWQgYnkgdGhlIGZyb250ZW5kLCBhbmQKY2hhbmdlcyB0aG9zZSBwYXRo
cyBhdCBtb3N0IG9uY2UgYXMgYSByZWFjdGlvbiB0byBndWVzdCBldmVudHMs
IG9yIHByb3RvY29sCnN0YXRlLgoKVGhlIHF1ZXVlIGxpbWl0cyBhcmUgcGVy
IHdhdGNoLCBhbmQgcGVyIGRvbWFpbi1wYWlyLCBzbyBldmVuIGlmIG9uZQpj
b21tdW5pY2F0aW9uIGNoYW5uZWwgd291bGQgYmUgImJsb2NrZWQiLCBvdGhl
cnMgd291bGQga2VlcCB3b3JraW5nLCBhbmQgdGhlCmRvbWFpbiBpdHNlbGYg
d29uJ3QgZ2V0IGJsb2NrZWQgYXMgbG9uZyBhcyBpdCBkb2Vzbid0IG92ZXJm
bG93IHRoZSBxdWV1ZSBvZgp3YXRjaCBldmVudHMuCgpTaW1pbGFybHkgYSBt
YWxpY2lvdXMgYmFja2VuZCBjb3VsZCBjYXVzZSB0aGUgZnJvbnRlbmQgdG8g
Z2V0IGJsb2NrZWQsIGJ1dAp0aGlzIHdhdGNoIHF1ZXVlIHByb3RlY3RzIHRo
ZSBmcm9udGVuZCBhcyB3ZWxsIGFzIGxvbmcgYXMgaXQgZm9sbG93cyB0aGUg
UFYKcHJvdG9jb2wuICAoQWx0aG91Z2ggbm90ZSB0aGF0IHByb3RlY3Rpb24g
YWdhaW5zdCBtYWxpY2lvdXMgYmFja2VuZHMgaXMgb25seSBhCmJlc3QgZWZm
b3J0IGF0IHRoZSBtb21lbnQpCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAv
IENWRS0yMDIyLTQyMzE4LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLD
tmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3Rp
YW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbCBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKaW5kZXggNDE5N2EzODg4YTY4Li5iMjkyZWQ3
YTg3NGQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwK
KysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbApAQCAtMTM0LDE0ICsx
MzQsNDQgQEAgdHlwZSBiYWNrZW5kID0gRmQgb2YgYmFja2VuZF9mZCB8IFhl
bm1tYXAgb2YgYmFja2VuZF9tbWFwCiAKIHR5cGUgcGFydGlhbF9idWYgPSBI
YXZlSGRyIG9mIFBhcnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMK
IAorKCoKKwlzZXBhcmF0ZSBjYXBhY2l0eSByZXNlcnZhdGlvbiBmb3IgcmVw
bGllcyBhbmQgd2F0Y2ggZXZlbnRzOgorCXRoaXMgYWxsb3dzIGEgZG9tYWlu
IHRvIGtlZXAgd29ya2luZyBldmVuIHdoZW4gdW5kZXIgYSBjb25zdGFudCBm
bG9vZCBvZgorCXdhdGNoIGV2ZW50cworKikKK3R5cGUgY2FwYWNpdHkgPSB7
IG1heG91dHN0YW5kaW5nOiBpbnQ7IG1heHdhdGNoZXZlbnRzOiBpbnQgfQor
Cittb2R1bGUgUXVldWUgPSBCb3VuZGVkUXVldWUKKwordHlwZSBwYWNrZXRf
Y2xhc3MgPQorCXwgQ29tbWFuZFJlcGx5CisJfCBXYXRjaGV2ZW50CisKK2xl
dCBzdHJpbmdfb2ZfcGFja2V0X2NsYXNzID0gZnVuY3Rpb24KKwl8IENvbW1h
bmRSZXBseSAtPiAiY29tbWFuZF9yZXBseSIKKwl8IFdhdGNoZXZlbnQgLT4g
IndhdGNoX2V2ZW50IgorCiB0eXBlIHQgPQogewogCWJhY2tlbmQ6IGJhY2tl
bmQ7Ci0JcGt0X291dDogUGFja2V0LnQgUXVldWUudDsKKwlwa3Rfb3V0OiAo
UGFja2V0LnQsIHBhY2tldF9jbGFzcykgUXVldWUudDsKIAltdXRhYmxlIHBh
cnRpYWxfaW46IHBhcnRpYWxfYnVmOwogCW11dGFibGUgcGFydGlhbF9vdXQ6
IHN0cmluZzsKKwljYXBhY2l0eTogY2FwYWNpdHkKIH0KIAorbGV0IHRvX3Jl
YWQgY29uID0KKwltYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCisJCXwgSGF2
ZUhkciBwYXJ0aWFsX3BrdCAtPiBQYXJ0aWFsLnRvX2NvbXBsZXRlIHBhcnRp
YWxfcGt0CisJCXwgTm9IZHIgICAoaSwgXykgICAgLT4gaQorCitsZXQgZGVi
dWcgdCA9CisJUHJpbnRmLnNwcmludGYgIlhlbkJ1cyBzdGF0ZTogcGFydGlh
bF9pbjogJWQgbmVlZGVkLCBwYXJ0aWFsX291dDogJWQgYnl0ZXMsIHBrdF9v
dXQ6ICVkIHBhY2tldHMsICVzIgorCQkodG9fcmVhZCB0KQorCQkoU3RyaW5n
Lmxlbmd0aCB0LnBhcnRpYWxfb3V0KQorCQkoUXVldWUubGVuZ3RoIHQucGt0
X291dCkKKwkJKEJvdW5kZWRRdWV1ZS5kZWJ1ZyBzdHJpbmdfb2ZfcGFja2V0
X2NsYXNzIHQucGt0X291dCkKKwogbGV0IGluaXRfcGFydGlhbF9pbiAoKSA9
IE5vSGRyCiAJKFBhcnRpYWwuaGVhZGVyX3NpemUgKCksIEJ5dGVzLm1ha2Ug
KFBhcnRpYWwuaGVhZGVyX3NpemUoKSkgJ1wwMDAnKQogCkBAIC0xOTksNyAr
MjI5LDggQEAgbGV0IG91dHB1dCBjb24gPQogCWxldCBzID0gaWYgU3RyaW5n
Lmxlbmd0aCBjb24ucGFydGlhbF9vdXQgPiAwIHRoZW4KIAkJCWNvbi5wYXJ0
aWFsX291dAogCQllbHNlIGlmIFF1ZXVlLmxlbmd0aCBjb24ucGt0X291dCA+
IDAgdGhlbgotCQkJUGFja2V0LnRvX3N0cmluZyAoUXVldWUucG9wIGNvbi5w
a3Rfb3V0KQorCQkJbGV0IHBrdCA9IFF1ZXVlLnBvcCBjb24ucGt0X291dCBp
bgorCQkJUGFja2V0LnRvX3N0cmluZyBwa3QKIAkJZWxzZQogCQkJIiIgaW4K
IAkoKiBzZW5kIGRhdGEgZnJvbSBzLCBhbmQgc2F2ZSB0aGUgdW5zZW50IGRh
dGEgdG8gcGFydGlhbF9vdXQgKikKQEAgLTIxMiwxMiArMjQzLDE1IEBAIGxl
dCBvdXRwdXQgY29uID0KIAkoKiBhZnRlciBzZW5kaW5nIG9uZSBwYWNrZXQs
IHBhcnRpYWwgaXMgZW1wdHkgKikKIAljb24ucGFydGlhbF9vdXQgPSAiIgog
CisoKiB3ZSBjYW4gb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCBpZiB3
ZSdyZSBndWFyYW50ZWVkIHRvIGhhdmUgcm9vbQorICAgdG8gc3RvcmUgdGhl
IHJlc3BvbnNlIHBhY2tldCAqKQorbGV0IGNhbl9pbnB1dCBjb24gPSBRdWV1
ZS5jYW5fcHVzaCBjb24ucGt0X291dCBDb21tYW5kUmVwbHkKKwogKCogTkI6
IGNhbiB0aHJvdyBSZWNvbm5lY3QgKikKIGxldCBpbnB1dCBjb24gPQotCWxl
dCB0b19yZWFkID0KLQkJbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAotCQl8
IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4gUGFydGlhbC50b19jb21wbGV0ZSBw
YXJ0aWFsX3BrdAotCQl8IE5vSGRyICAgKGksIF8pICAgIC0+IGkgaW4KKwlp
ZiBub3QgKGNhbl9pbnB1dCBjb24pIHRoZW4gTm9uZQorCWVsc2UKKwlsZXQg
dG9fcmVhZCA9IHRvX3JlYWQgY29uIGluCiAKIAkoKiB0cnkgdG8gZ2V0IG1v
cmUgZGF0YSBmcm9tIGlucHV0IHN0cmVhbSAqKQogCWxldCBiID0gQnl0ZXMu
bWFrZSB0b19yZWFkICdcMDAwJyBpbgpAQCAtMjQzLDExICsyNzcsMjIgQEAg
bGV0IGlucHV0IGNvbiA9CiAJCU5vbmUKIAkpCiAKLWxldCBuZXdjb24gYmFj
a2VuZCA9IHsKK2xldCBjbGFzc2lmeSB0ID0KKwltYXRjaCB0LlBhY2tldC50
eSB3aXRoCisJfCBPcC5XYXRjaGV2ZW50IC0+IFdhdGNoZXZlbnQKKwl8IF8g
LT4gQ29tbWFuZFJlcGx5CisKK2xldCBuZXdjb24gfmNhcGFjaXR5IGJhY2tl
bmQgPQorCWxldCBsaW1pdCA9IGZ1bmN0aW9uCisJCXwgQ29tbWFuZFJlcGx5
IC0+IGNhcGFjaXR5Lm1heG91dHN0YW5kaW5nCisJCXwgV2F0Y2hldmVudCAt
PiBjYXBhY2l0eS5tYXh3YXRjaGV2ZW50cworCWluCisJewogCWJhY2tlbmQg
PSBiYWNrZW5kOwotCXBrdF9vdXQgPSBRdWV1ZS5jcmVhdGUgKCk7CisJcGt0
X291dCA9IFF1ZXVlLmNyZWF0ZSB+Y2FwYWNpdHk6KGNhcGFjaXR5Lm1heG91
dHN0YW5kaW5nICsgY2FwYWNpdHkubWF4d2F0Y2hldmVudHMpIH5jbGFzc2lm
eSB+bGltaXQ7CiAJcGFydGlhbF9pbiA9IGluaXRfcGFydGlhbF9pbiAoKTsK
IAlwYXJ0aWFsX291dCA9ICIiOworCWNhcGFjaXR5ID0gY2FwYWNpdHk7CiAJ
fQogCiBsZXQgb3Blbl9mZCBmZCA9IG5ld2NvbiAoRmQgeyBmZCA9IGZkOyB9
KQpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkgYi90
b29scy9vY2FtbC9saWJzL3hiL3hiLm1saQppbmRleCA5MWM2ODIxNjJjZWEu
LjcxYjI3NTRjYTc4OCAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94
Yi94Yi5tbGkKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkKQEAg
LTY2LDEwICs2NiwxMSBAQCB0eXBlIGJhY2tlbmRfbW1hcCA9IHsKIHR5cGUg
YmFja2VuZF9mZCA9IHsgZmQgOiBVbml4LmZpbGVfZGVzY3I7IH0KIHR5cGUg
YmFja2VuZCA9IEZkIG9mIGJhY2tlbmRfZmQgfCBYZW5tbWFwIG9mIGJhY2tl
bmRfbW1hcAogdHlwZSBwYXJ0aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlh
bC5wa3QgfCBOb0hkciBvZiBpbnQgKiBieXRlcwordHlwZSBjYXBhY2l0eSA9
IHsgbWF4b3V0c3RhbmRpbmc6IGludDsgbWF4d2F0Y2hldmVudHM6IGludCB9
CiB0eXBlIHQKIHZhbCBpbml0X3BhcnRpYWxfaW4gOiB1bml0IC0+IHBhcnRp
YWxfYnVmCiB2YWwgcmVjb25uZWN0IDogdCAtPiB1bml0Ci12YWwgcXVldWUg
OiB0IC0+IFBhY2tldC50IC0+IHVuaXQKK3ZhbCBxdWV1ZSA6IHQgLT4gUGFj
a2V0LnQgLT4gdW5pdCBvcHRpb24KIHZhbCByZWFkX2ZkIDogYmFja2VuZF9m
ZCAtPiAnYSAtPiBieXRlcyAtPiBpbnQgLT4gaW50CiB2YWwgcmVhZF9tbWFw
IDogYmFja2VuZF9tbWFwIC0+ICdhIC0+IGJ5dGVzIC0+IGludCAtPiBpbnQK
IHZhbCByZWFkIDogdCAtPiBieXRlcyAtPiBpbnQgLT4gaW50CkBAIC03OCwx
MyArNzksMTQgQEAgdmFsIHdyaXRlX21tYXAgOiBiYWNrZW5kX21tYXAgLT4g
J2EgLT4gc3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCB3cml0ZSA6IHQgLT4g
c3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCBvdXRwdXQgOiB0IC0+IGJvb2wK
IHZhbCBpbnB1dCA6IHQgLT4gUGFja2V0LnQgb3B0aW9uCi12YWwgbmV3Y29u
IDogYmFja2VuZCAtPiB0Ci12YWwgb3Blbl9mZCA6IFVuaXguZmlsZV9kZXNj
ciAtPiB0Ci12YWwgb3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFj
ZSAtPiAodW5pdCAtPiB1bml0KSAtPiB0Cit2YWwgbmV3Y29uIDogY2FwYWNp
dHk6Y2FwYWNpdHkgLT4gYmFja2VuZCAtPiB0Cit2YWwgb3Blbl9mZCA6IFVu
aXguZmlsZV9kZXNjciAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0Cit2YWwg
b3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFjZSAtPiAodW5pdCAt
PiB1bml0KSAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0CiB2YWwgY2xvc2Ug
OiB0IC0+IHVuaXQKIHZhbCBpc19mZCA6IHQgLT4gYm9vbAogdmFsIGlzX21t
YXAgOiB0IC0+IGJvb2wKIHZhbCBvdXRwdXRfbGVuIDogdCAtPiBpbnQKK3Zh
bCBjYW5faW5wdXQ6IHQgLT4gYm9vbAogdmFsIGhhc19uZXdfb3V0cHV0IDog
dCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRwdXQgOiB0IC0+IGJvb2wKIHZh
bCBoYXNfb3V0cHV0IDogdCAtPiBib29sCkBAIC05MywzICs5NSw0IEBAIHZh
bCBoYXNfcGFydGlhbF9pbnB1dCA6IHQgLT4gYm9vbAogdmFsIGhhc19tb3Jl
X2lucHV0IDogdCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4g
Ym9vbAogdmFsIGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCit2YWwg
ZGVidWc6IHQgLT4gc3RyaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9s
aWJzL3hzL3F1ZXVlb3AubWwgYi90b29scy9vY2FtbC9saWJzL3hzL3F1ZXVl
b3AubWwKaW5kZXggOWZmNWJiZDUyOWNlLi40ZTUzMmNkYWVhY2IgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveHMvcXVldWVvcC5tbAorKysgYi90
b29scy9vY2FtbC9saWJzL3hzL3F1ZXVlb3AubWwKQEAgLTE2LDkgKzE2LDEw
IEBACiBvcGVuIFhlbmJ1cwogCiBsZXQgZGF0YV9jb25jYXQgbHMgPSAoU3Ry
aW5nLmNvbmNhdCAiXDAwMCIgbHMpIF4gIlwwMDAiCitsZXQgcXVldWUgY29u
IHBrdCA9IGxldCByID0gWGIucXVldWUgY29uIHBrdCBpbiBhc3NlcnQgKHIg
PD4gTm9uZSkKIGxldCBxdWV1ZV9wYXRoIHR5ICh0aWQ6IGludCkgKHBhdGg6
IHN0cmluZykgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0
aDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQogCiAoKiBvcGVyYXRpb25zICopCiBsZXQgZGlyZWN0b3J5
IHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuRGlyZWN0b3J5IHRp
ZCBwYXRoIGNvbgpAQCAtMjcsNDggKzI4LDQ4IEBAIGxldCByZWFkIHRpZCBw
YXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuUmVhZCB0aWQgcGF0aCBjb24K
IGxldCBnZXRwZXJtcyB0aWQgcGF0aCBjb24gPSBxdWV1ZV9wYXRoIFhiLk9w
LkdldHBlcm1zIHRpZCBwYXRoIGNvbgogCiBsZXQgZGVidWcgY29tbWFuZHMg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLkRlYnVnIChkYXRhX2NvbmNhdCBjb21tYW5kcykpCisJcXVldWUgY29u
IChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5EZWJ1ZyAoZGF0YV9jb25j
YXQgY29tbWFuZHMpKQogCiBsZXQgd2F0Y2ggcGF0aCBkYXRhIGNvbiA9CiAJ
bGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7IGRhdGE7IF0gaW4KLQlY
Yi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhiLk9wLldhdGNo
IGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5P
cC5XYXRjaCBkYXRhKQogCiBsZXQgdW53YXRjaCBwYXRoIGRhdGEgY29uID0K
IAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0aDsgZGF0YTsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuVW53
YXRjaCBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAg
WGIuT3AuVW53YXRjaCBkYXRhKQogCiBsZXQgdHJhbnNhY3Rpb25fc3RhcnQg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLlRyYW5zYWN0aW9uX3N0YXJ0IChkYXRhX2NvbmNhdCBbXSkpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5UcmFuc2FjdGlv
bl9zdGFydCAoZGF0YV9jb25jYXQgW10pKQogCiBsZXQgdHJhbnNhY3Rpb25f
ZW5kIHRpZCBjb21taXQgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0
IFsgKGlmIGNvbW1pdCB0aGVuICJUIiBlbHNlICJGIik7IF0gaW4KLQlYYi5x
dWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuVHJhbnNh
Y3Rpb25fZW5kIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRl
IHRpZCAwIFhiLk9wLlRyYW5zYWN0aW9uX2VuZCBkYXRhKQogCiBsZXQgaW50
cm9kdWNlIGRvbWlkIG1mbiBwb3J0IGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRh
X2NvbmNhdCBbIFByaW50Zi5zcHJpbnRmICIldSIgZG9taWQ7CiAJICAgICAg
ICAgICAgICAgICAgICAgICAgIFByaW50Zi5zcHJpbnRmICIlbnUiIG1mbjsK
IAkgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nX29mX2ludCBwb3J0
OyBdIGluCi0JWGIucXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5JbnRyb2R1Y2UgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBhY2tldC5j
cmVhdGUgMCAwIFhiLk9wLkludHJvZHVjZSBkYXRhKQogCiBsZXQgcmVsZWFz
ZSBkb21pZCBjb24gPQogCWxldCBkYXRhID0gZGF0YV9jb25jYXQgWyBQcmlu
dGYuc3ByaW50ZiAiJXUiIGRvbWlkOyBdIGluCi0JWGIucXVldWUgY29uIChY
Yi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRhdGEpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRh
dGEpCiAKIGxldCByZXN1bWUgZG9taWQgY29uID0KIAlsZXQgZGF0YSA9IGRh
dGFfY29uY2F0IFsgUHJpbnRmLnNwcmludGYgIiV1IiBkb21pZDsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuUmVz
dW1lIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5SZXN1bWUgZGF0YSkKIAogbGV0IGdldGRvbWFpbnBhdGggZG9taWQg
Y29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgUHJpbnRmLnNwcmlu
dGYgIiV1IiBkb21pZDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0
LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0aCBkYXRhKQorCXF1ZXVl
IGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0
aCBkYXRhKQogCiBsZXQgd3JpdGUgdGlkIHBhdGggdmFsdWUgY29uID0KIAls
ZXQgZGF0YSA9IHBhdGggXiAiXDAwMCIgXiB2YWx1ZSAoKiBubyBOVUxMIGF0
IHRoZSBlbmQgKikgaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVh
dGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKIAogbGV0IG1r
ZGlyIHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuTWtkaXIgdGlk
IHBhdGggY29uCiBsZXQgcm0gdGlkIHBhdGggY29uID0gcXVldWVfcGF0aCBY
Yi5PcC5SbSB0aWQgcGF0aCBjb24KIAogbGV0IHNldHBlcm1zIHRpZCBwYXRo
IHBlcm1zIGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7
IHBlcm1zIF0gaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUg
dGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwgYi90b29scy9v
Y2FtbC9saWJzL3hzL3hzcmF3Lm1sCmluZGV4IDQ1MWY4YjM4ZGJjYy4uY2Jk
MTcyODA2MDBjIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9saWJzL3hzL3hz
cmF3Lm1sCisrKyBiL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwKQEAg
LTM2LDggKzM2LDEwIEBAIHR5cGUgY29uID0gewogbGV0IGNsb3NlIGNvbiA9
CiAJWGIuY2xvc2UgY29uLnhiCiAKK2xldCBjYXBhY2l0eSA9IHsgWGIubWF4
b3V0c3RhbmRpbmcgPSAxOyBtYXh3YXRjaGV2ZW50cyA9IDA7IH0KKwogbGV0
IG9wZW5fZmQgZmQgPSB7Ci0JeGIgPSBYYi5vcGVuX2ZkIGZkOworCXhiID0g
WGIub3Blbl9mZCB+Y2FwYWNpdHkgZmQ7CiAJd2F0Y2hldmVudHMgPSBRdWV1
ZS5jcmVhdGUgKCk7CiB9CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC9jb25uZWN0aW9uLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVk
L2Nvbm5lY3Rpb24ubWwKaW5kZXggY2MyMGUwNDdkMmI5Li45NjI0YTVmOWRh
MmMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0
aW9uLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCkBAIC0yMCwxMiArMjAsODQgQEAgb3BlbiBTdGRleHQKIAogbGV0IHhl
bnN0b3JlX3BheWxvYWRfbWF4ID0gNDA5NiAoKiB4ZW4vaW5jbHVkZS9wdWJs
aWMvaW8veHNfd2lyZS5oICopCiAKK3R5cGUgJ2EgYm91bmRlZF9zZW5kZXIg
PSAnYSAtPiB1bml0IG9wdGlvbgorKCoqIGEgYm91bmRlZCBzZW5kZXIgYWNj
ZXB0cyBhbiBbJ2FdIGl0ZW0gYW5kIHJldHVybnM6CisgICAgTm9uZSAtIGlm
IHRoZXJlIGlzIG5vIHJvb20gdG8gYWNjZXB0IHRoZSBpdGVtCisgICAgU29t
ZSAoKSAtICBpZiBpdCBoYXMgc3VjY2Vzc2Z1bGx5IGFjY2VwdGVkL3NlbnQg
dGhlIGl0ZW0KKyAqKQorCittb2R1bGUgQm91bmRlZFBpcGUgOiBzaWcKKwl0
eXBlICdhIHQKKworCSgqKiBbY3JlYXRlIH5jYXBhY2l0eSB+ZGVzdGluYXRp
b25dIGNyZWF0ZXMgYSBib3VuZGVkIHBpcGUgd2l0aCBhCisJICAgIGxvY2Fs
IGJ1ZmZlciBob2xkaW5nIGF0IG1vc3QgW2NhcGFjaXR5XSBpdGVtcy4gIE9u
Y2UgdGhlIGJ1ZmZlciBpcworCSAgICBmdWxsIGl0IHdpbGwgbm90IGFjY2Vw
dCBmdXJ0aGVyIGl0ZW1zLiAgaXRlbXMgZnJvbSB0aGUgcGlwZSBhcmUKKwkg
ICAgZmx1c2hlZCBpbnRvIFtkZXN0aW5hdGlvbl0gYXMgbG9uZyBhcyBpdCBh
Y2NlcHRzIGl0ZW1zLiAgVGhlCisJICAgIGRlc3RpbmF0aW9uIGNvdWxkIGJl
IGFub3RoZXIgcGlwZS4KKwkgKikKKwl2YWwgY3JlYXRlOiBjYXBhY2l0eTpp
bnQgLT4gZGVzdGluYXRpb246J2EgYm91bmRlZF9zZW5kZXIgLT4gJ2EgdAor
CisJKCoqIFtpc19lbXB0eSB0XSByZXR1cm5zIHdoZXRoZXIgdGhlIGxvY2Fs
IGJ1ZmZlciBvZiBbdF0gaXMgZW1wdHkuICopCisJdmFsIGlzX2VtcHR5IDog
XyB0IC0+IGJvb2wKKworCSgqKiBbbGVuZ3RoIHRdIHRoZSBudW1iZXIgb2Yg
aXRlbXMgaW4gdGhlIGludGVybmFsIGJ1ZmZlciAqKQorCXZhbCBsZW5ndGg6
IF8gdCAtPiBpbnQKKworCSgqKiBbZmx1c2hfcGlwZSB0XSBzZW5kcyBhcyBt
YW55IGl0ZW1zIGZyb20gdGhlIGxvY2FsIGJ1ZmZlciBhcyBwb3NzaWJsZSwK
KwkJCXdoaWNoIGNvdWxkIGJlIG5vbmUuICopCisJdmFsIGZsdXNoX3BpcGU6
IF8gdCAtPiB1bml0CisKKwkoKiogW3B1c2ggdCBpdGVtXSB0cmllcyB0byBb
Zmx1c2hfcGlwZV0gYW5kIHRoZW4gcHVzaCBbaXRlbV0KKwkgICAgaW50byB0
aGUgcGlwZSBpZiBpdHMgW2NhcGFjaXR5XSBhbGxvd3MuCisJICAgIFJldHVy
bnMgW05vbmVdIGlmIHRoZXJlIGlzIG5vIG1vcmUgcm9vbQorCSAqKQorCXZh
bCBwdXNoIDogJ2EgdCAtPiAnYSBib3VuZGVkX3NlbmRlcgorZW5kID0gc3Ry
dWN0CisJKCogaXRlbXMgYXJlIGVucXVldWVkIGluIFtxXSwgYW5kIHRoZW4g
Zmx1c2hlZCB0byBbY29ubmVjdF90b10gKikKKwl0eXBlICdhIHQgPQorCQl7
IHE6ICdhIFF1ZXVlLnQKKwkJOyBkZXN0aW5hdGlvbjogJ2EgYm91bmRlZF9z
ZW5kZXIKKwkJOyBjYXBhY2l0eTogaW50CisJCX0KKworCWxldCBjcmVhdGUg
fmNhcGFjaXR5IH5kZXN0aW5hdGlvbiA9CisJCXsgcSA9IFF1ZXVlLmNyZWF0
ZSAoKTsgY2FwYWNpdHk7IGRlc3RpbmF0aW9uIH0KKworCWxldCByZWMgZmx1
c2hfcGlwZSB0ID0KKwkJaWYgbm90IFF1ZXVlLihpc19lbXB0eSB0LnEpIHRo
ZW4KKwkJCWxldCBpdGVtID0gUXVldWUucGVlayB0LnEgaW4KKwkJCW1hdGNo
IHQuZGVzdGluYXRpb24gaXRlbSB3aXRoCisJCQl8IE5vbmUgLT4gKCkgKCog
bm8gcm9vbSAqKQorCQkJfCBTb21lICgpIC0+CisJCQkJKCogc3VjY2Vzc2Z1
bGx5IHNlbnQgaXRlbSB0byBuZXh0IHN0YWdlICopCisJCQkJbGV0IF8gPSBR
dWV1ZS5wb3AgdC5xIGluCisJCQkJKCogY29udGludWUgdHJ5aW5nIHRvIHNl
bmQgbW9yZSBpdGVtcyAqKQorCQkJCWZsdXNoX3BpcGUgdAorCisJbGV0IHB1
c2ggdCBpdGVtID0KKwkJKCogZmlyc3QgdHJ5IHRvIGZsdXNoIGFzIG1hbnkg
aXRlbXMgZnJvbSB0aGlzIHBpcGUgYXMgcG9zc2libGUgdG8gbWFrZSByb29t
LAorCQkgICBpdCBpcyBpbXBvcnRhbnQgdG8gZG8gdGhpcyBmaXJzdCB0byBw
cmVzZXJ2ZSB0aGUgb3JkZXIgb2YgdGhlIGl0ZW1zCisJCSAqKQorCQlmbHVz
aF9waXBlIHQ7CisJCWlmIFF1ZXVlLmxlbmd0aCB0LnEgPCB0LmNhcGFjaXR5
IHRoZW4gYmVnaW4KKwkJCSgqIGVucXVldWUsIGluc3RlYWQgb2Ygc2VuZGlu
ZyBkaXJlY3RseS4KKwkJCSAgIHRoaXMgZW5zdXJlcyB0aGF0IFtvdXRdIHNl
ZXMgdGhlIGl0ZW1zIGluIHRoZSBzYW1lIG9yZGVyIGFzIHdlIHJlY2VpdmUg
dGhlbQorCQkJICopCisJCQlRdWV1ZS5wdXNoIGl0ZW0gdC5xOworCQkJU29t
ZSAoZmx1c2hfcGlwZSB0KQorCQllbmQgZWxzZSBOb25lCisKKwlsZXQgaXNf
ZW1wdHkgdCA9IFF1ZXVlLmlzX2VtcHR5IHQucQorCWxldCBsZW5ndGggdCA9
IFF1ZXVlLmxlbmd0aCB0LnEKK2VuZAorCiB0eXBlIHdhdGNoID0gewogCWNv
bjogdDsKIAl0b2tlbjogc3RyaW5nOwogCXBhdGg6IHN0cmluZzsKIAliYXNl
OiBzdHJpbmc7CiAJaXNfcmVsYXRpdmU6IGJvb2w7CisJcGVuZGluZ193YXRj
aGV2ZW50czogWGVuYnVzLlhiLlBhY2tldC50IEJvdW5kZWRQaXBlLnQ7CiB9
CiAKIGFuZCB0ID0gewpAQCAtMzgsOCArMTEwLDM2IEBAIGFuZCB0ID0gewog
CWFub25pZDogaW50OwogCW11dGFibGUgc3RhdF9uYl9vcHM6IGludDsKIAlt
dXRhYmxlIHBlcm06IFBlcm1zLkNvbm5lY3Rpb24udDsKKwlwZW5kaW5nX3Nv
dXJjZV93YXRjaGV2ZW50czogKHdhdGNoICogWGVuYnVzLlhiLlBhY2tldC50
KSBCb3VuZGVkUGlwZS50CiB9CiAKK21vZHVsZSBXYXRjaCA9IHN0cnVjdAor
CW1vZHVsZSBUID0gc3RydWN0CisJCXR5cGUgdCA9IHdhdGNoCisKKwkJbGV0
IGNvbXBhcmUgdzEgdzIgPQorCQkJKCogY2Fubm90IGNvbXBhcmUgd2F0Y2hl
cyBmcm9tIGRpZmZlcmVudCBjb25uZWN0aW9ucyAqKQorCQkJYXNzZXJ0ICh3
MS5jb24gPT0gdzIuY29uKTsKKwkJCW1hdGNoIFN0cmluZy5jb21wYXJlIHcx
LnRva2VuIHcyLnRva2VuIHdpdGgKKwkJCXwgMCAtPiBTdHJpbmcuY29tcGFy
ZSB3MS5wYXRoIHcyLnBhdGgKKwkJCXwgbiAtPiBuCisJZW5kCisJbW9kdWxl
IFNldCA9IFNldC5NYWtlKFQpCisKKwlsZXQgZmx1c2hfZXZlbnRzIHQgPQor
CQlCb3VuZGVkUGlwZS5mbHVzaF9waXBlIHQucGVuZGluZ193YXRjaGV2ZW50
czsKKwkJbm90IChCb3VuZGVkUGlwZS5pc19lbXB0eSB0LnBlbmRpbmdfd2F0
Y2hldmVudHMpCisKKwlsZXQgcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwkJ
Qm91bmRlZFBpcGUubGVuZ3RoIHQucGVuZGluZ193YXRjaGV2ZW50cworZW5k
CisKK2xldCBzb3VyY2VfZmx1c2hfd2F0Y2hldmVudHMgdCA9CisJQm91bmRl
ZFBpcGUuZmx1c2hfcGlwZSB0LnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRz
CisKK2xldCBzb3VyY2VfcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwlCb3Vu
ZGVkUGlwZS5sZW5ndGggdC5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50cwor
CiBsZXQgbWFya19hc19iYWQgY29uID0KIAltYXRjaCBjb24uZG9tIHdpdGgK
IAl8Tm9uZSAtPiAoKQpAQCAtNjcsNyArMTY3LDggQEAgbGV0IHdhdGNoX2Ny
ZWF0ZSB+Y29uIH5wYXRoIH50b2tlbiA9IHsKIAl0b2tlbiA9IHRva2VuOwog
CXBhdGggPSBwYXRoOwogCWJhc2UgPSBnZXRfcGF0aCBjb247Ci0JaXNfcmVs
YXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4gJ0AnCisJ
aXNfcmVsYXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4g
J0AnOworCXBlbmRpbmdfd2F0Y2hldmVudHMgPSBCb3VuZGVkUGlwZS5jcmVh
dGUgfmNhcGFjaXR5OiFEZWZpbmUubWF4d2F0Y2hldmVudHMgfmRlc3RpbmF0
aW9uOihYZW5idXMuWGIucXVldWUgY29uLnhiKQogfQogCiBsZXQgZ2V0X2Nv
biB3ID0gdy5jb24KQEAgLTkzLDYgKzE5NCw5IEBAIGxldCBtYWtlX3Blcm0g
ZG9tID0KIAlQZXJtcy5Db25uZWN0aW9uLmNyZWF0ZSB+cGVybXM6W1Blcm1z
LlJFQUQ7IFBlcm1zLldSSVRFXSBkb21pZAogCiBsZXQgY3JlYXRlIHhiY29u
IGRvbSA9CisJbGV0IGRlc3RpbmF0aW9uICh3YXRjaCwgcGt0KSA9CisJCUJv
dW5kZWRQaXBlLnB1c2ggd2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyBwa3QK
KwlpbgogCWxldCBpZCA9CiAJCW1hdGNoIGRvbSB3aXRoCiAJCXwgTm9uZSAt
PiBsZXQgb2xkID0gIWFub25faWRfbmV4dCBpbiBpbmNyIGFub25faWRfbmV4
dDsgb2xkCkBAIC0xMDksNiArMjEzLDE2IEBAIGxldCBjcmVhdGUgeGJjb24g
ZG9tID0KIAlhbm9uaWQgPSBpZDsKIAlzdGF0X25iX29wcyA9IDA7CiAJcGVy
bSA9IG1ha2VfcGVybSBkb207CisKKwkoKiB0aGUgYWN0dWFsIGNhcGFjaXR5
IHdpbGwgYmUgbG93ZXIsIHRoaXMgaXMgdXNlZCBhcyBhbiBvdmVyZmxvdwor
CSAgIGJ1ZmZlcjogYW55dGhpbmcgdGhhdCBkb2Vzbid0IGZpdCBlbHNld2hl
cmUgZ2V0cyBwdXQgaGVyZSwgb25seQorCSAgIGxpbWl0ZWQgYnkgdGhlIGFt
b3VudCBvZiB3YXRjaGVzIHRoYXQgeW91IGNhbiBnZW5lcmF0ZSB3aXRoIGEK
KwkgICBzaW5nbGUgeGVuc3RvcmUgY29tbWFuZCAod2hpY2ggaXMgZmluaXRl
LCBhbHRob3VnaCBwb3NzaWJseSB2ZXJ5CisJICAgbGFyZ2UgaW4gdGhlb3J5
IGZvciBEb20wKS4gIE9uY2UgdGhlIHBpcGUgaGVyZSBoYXMgYW55IGNvbnRl
bnRzIHRoZQorCSAgIGRvbWFpbiBpcyBibG9ja2VkIGZyb20gc2VuZGluZyBt
b3JlIGNvbW1hbmRzIHVudGlsIGl0IGlzIGVtcHR5CisJICAgYWdhaW4gdGhv
dWdoLgorCSAqKQorCXBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzID0gQm91
bmRlZFBpcGUuY3JlYXRlIH5jYXBhY2l0eTpTeXMubWF4X2FycmF5X2xlbmd0
aCB+ZGVzdGluYXRpb24KIAl9CiAJaW4KIAlMb2dnaW5nLm5ld19jb25uZWN0
aW9uIH50aWQ6VHJhbnNhY3Rpb24ubm9uZSB+Y29uOihnZXRfZG9tc3RyIGNv
bik7CkBAIC0xMjcsMTEgKzI0MSwxNyBAQCBsZXQgc2V0X3RhcmdldCBjb24g
dGFyZ2V0X2RvbWlkID0KIAogbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBY
ZW5idXMuWGIuaXNfbW1hcCBjb24ueGIKIAotbGV0IHNlbmRfcmVwbHkgY29u
IHRpZCByaWQgdHkgZGF0YSA9CitsZXQgcGFja2V0X29mIGNvbiB0aWQgcmlk
IHR5IGRhdGEgPQogCWlmIChTdHJpbmcubGVuZ3RoIGRhdGEpID4geGVuc3Rv
cmVfcGF5bG9hZF9tYXggJiYgKGlzX2JhY2tlbmRfbW1hcCBjb24pIHRoZW4K
LQkJWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAoWGVuYnVzLlhiLlBhY2tldC5j
cmVhdGUgdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgIkUyQklHXDAwMCIp
CisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgWGVuYnVzLlhi
Lk9wLkVycm9yICJFMkJJR1wwMDAiCiAJZWxzZQotCQlYZW5idXMuWGIucXVl
dWUgY29uLnhiIChYZW5idXMuWGIuUGFja2V0LmNyZWF0ZSB0aWQgcmlkIHR5
IGRhdGEpCisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgdHkg
ZGF0YQorCitsZXQgc2VuZF9yZXBseSBjb24gdGlkIHJpZCB0eSBkYXRhID0K
KwlsZXQgcmVzdWx0ID0gWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAocGFja2V0
X29mIGNvbiB0aWQgcmlkIHR5IGRhdGEpIGluCisJKCogc2hvdWxkIG5ldmVy
IGhhcHBlbjogd2Ugb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCB3aGVu
IHRoZXJlIGlzIHJvb20gZm9yIGFuIG91dHB1dCBwYWNrZXQgKikKKwkoKiBh
bmQgdGhlIGxpbWl0IGZvciByZXBsaWVzIGlzIGRpZmZlcmVudCBmcm9tIHRo
ZSBsaW1pdCBmb3Igd2F0Y2ggZXZlbnRzICopCisJYXNzZXJ0IChyZXN1bHQg
PD4gTm9uZSkKIAogbGV0IHNlbmRfZXJyb3IgY29uIHRpZCByaWQgZXJyID0g
c2VuZF9yZXBseSBjb24gdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgKGVy
ciBeICJcMDAwIikKIGxldCBzZW5kX2FjayBjb24gdGlkIHJpZCB0eSA9IHNl
bmRfcmVwbHkgY29uIHRpZCByaWQgdHkgIk9LXDAwMCIKQEAgLTE4MSwxMSAr
MzAxLDExIEBAIGxldCBkZWxfd2F0Y2ggY29uIHBhdGggdG9rZW4gPQogCWFw
YXRoLCB3CiAKIGxldCBkZWxfd2F0Y2hlcyBjb24gPQotICBIYXNodGJsLmNs
ZWFyIGNvbi53YXRjaGVzOworICBIYXNodGJsLnJlc2V0IGNvbi53YXRjaGVz
OwogICBjb24ubmJfd2F0Y2hlcyA8LSAwCiAKIGxldCBkZWxfdHJhbnNhY3Rp
b25zIGNvbiA9Ci0gIEhhc2h0YmwuY2xlYXIgY29uLnRyYW5zYWN0aW9ucwor
ICBIYXNodGJsLnJlc2V0IGNvbi50cmFuc2FjdGlvbnMKIAogbGV0IGxpc3Rf
d2F0Y2hlcyBjb24gPQogCWxldCBsbCA9IEhhc2h0YmwuZm9sZApAQCAtMjA4
LDIxICszMjgsMjkgQEAgbGV0IGxvb2t1cF93YXRjaF9wZXJtIHBhdGggPSBm
dW5jdGlvbgogbGV0IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3Qg
cGF0aCA9CiAJbG9va3VwX3dhdGNoX3Blcm0gcGF0aCBvbGRyb290IEAgbG9v
a3VwX3dhdGNoX3Blcm0gcGF0aCAoU29tZSByb290KQogCi1sZXQgZmlyZV9z
aW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdhdGNoID0KK2xldCBmaXJlX3Npbmds
ZV93YXRjaF91bmNoZWNrZWQgc291cmNlIHdhdGNoID0KIAlsZXQgZGF0YSA9
IFV0aWxzLmpvaW5fYnlfbnVsbCBbd2F0Y2gucGF0aDsgd2F0Y2gudG9rZW47
ICIiXSBpbgotCXNlbmRfcmVwbHkgd2F0Y2guY29uIFRyYW5zYWN0aW9uLm5v
bmUgMCBYZW5idXMuWGIuT3AuV2F0Y2hldmVudCBkYXRhCisJbGV0IHBrdCA9
IHBhY2tldF9vZiB3YXRjaC5jb24gVHJhbnNhY3Rpb24ubm9uZSAwIFhlbmJ1
cy5YYi5PcC5XYXRjaGV2ZW50IGRhdGEgaW4KKworCW1hdGNoIEJvdW5kZWRQ
aXBlLnB1c2ggc291cmNlLnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzICh3
YXRjaCwgcGt0KSB3aXRoCisJfCBTb21lICgpIC0+ICgpICgqIHBhY2tldCBx
dWV1ZWQgKikKKwl8IE5vbmUgLT4KKwkJCSgqIGEgd2VsbCBiZWhhdmVkIERv
bTAgc2hvdWxkbid0IGJlIGFibGUgdG8gdHJpZ2dlciB0aGlzLAorCQkJICAg
aWYgaXQgaGFwcGVucyBpdCBpcyBsaWtlbHkgYSBEb20wIGJ1ZyBjYXVzaW5n
IHJ1bmF3YXkgbWVtb3J5IHVzYWdlCisJCQkgKikKKwkJCWZhaWx3aXRoICJ3
YXRjaCBldmVudCBvdmVyZmxvdywgY2Fubm90IGhhcHBlbiIKIAotbGV0IGZp
cmVfc2luZ2xlX3dhdGNoIChvbGRyb290LCByb290KSB3YXRjaCA9CitsZXQg
ZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIChvbGRyb290LCByb290KSB3YXRj
aCA9CiAJbGV0IGFic3BhdGggPSBnZXRfd2F0Y2hfcGF0aCB3YXRjaC5jb24g
d2F0Y2gucGF0aCB8PiBTdG9yZS5QYXRoLm9mX3N0cmluZyBpbgogCWxldCBw
ZXJtcyA9IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3QgYWJzcGF0
aCBpbgogCWlmIFBlcm1zLmNhbl9maXJlX3dhdGNoIHdhdGNoLmNvbi5wZXJt
IHBlcm1zIHRoZW4KLQkJZmlyZV9zaW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdh
dGNoCisJCWZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCBzb3VyY2Ugd2F0
Y2gKIAllbHNlCiAJCWxldCBwZXJtcyA9IHBlcm1zIHw+IExpc3QubWFwIChQ
ZXJtcy5Ob2RlLnRvX3N0cmluZyB+c2VwOiIgIikgfD4gU3RyaW5nLmNvbmNh
dCAiLCAiIGluCiAJCWxldCBjb24gPSBnZXRfZG9tc3RyIHdhdGNoLmNvbiBp
bgogCQlMb2dnaW5nLndhdGNoX25vdF9maXJlZCB+Y29uIHBlcm1zIChTdG9y
ZS5QYXRoLnRvX3N0cmluZyBhYnNwYXRoKQogCi1sZXQgZmlyZV93YXRjaCBy
b290cyB3YXRjaCBwYXRoID0KK2xldCBmaXJlX3dhdGNoIHNvdXJjZSByb290
cyB3YXRjaCBwYXRoID0KIAlsZXQgbmV3X3BhdGggPQogCQlpZiB3YXRjaC5p
c19yZWxhdGl2ZSAmJiBwYXRoLlswXSA9ICcvJwogCQl0aGVuIGJlZ2luCkBA
IC0yMzIsNyArMzYwLDcgQEAgbGV0IGZpcmVfd2F0Y2ggcm9vdHMgd2F0Y2gg
cGF0aCA9CiAJCWVuZCBlbHNlCiAJCQlwYXRoCiAJaW4KLQlmaXJlX3Npbmds
ZV93YXRjaCByb290cyB7IHdhdGNoIHdpdGggcGF0aCA9IG5ld19wYXRoIH0K
KwlmaXJlX3NpbmdsZV93YXRjaCBzb3VyY2Ugcm9vdHMgeyB3YXRjaCB3aXRo
IHBhdGggPSBuZXdfcGF0aCB9CiAKICgqIFNlYXJjaCBmb3IgYSB2YWxpZCB1
bnVzZWQgdHJhbnNhY3Rpb24gaWQuICopCiBsZXQgcmVjIHZhbGlkX3RyYW5z
YWN0aW9uX2lkIGNvbiBwcm9wb3NlZF9pZCA9CkBAIC0yODAsNiArNDA4LDcg
QEAgbGV0IGRvX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5pbnB1dCBjb24ueGIK
IGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24gPSBYZW5idXMuWGIuaGFzX3Bh
cnRpYWxfaW5wdXQgY29uLnhiCiBsZXQgaGFzX21vcmVfaW5wdXQgY29uID0g
WGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54YgogCitsZXQgY2FuX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5jYW5faW5wdXQgY29uLnhiICYmIEJvdW5k
ZWRQaXBlLmlzX2VtcHR5IGNvbi5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50
cwogbGV0IGhhc19vdXRwdXQgY29uID0gWGVuYnVzLlhiLmhhc19vdXRwdXQg
Y29uLnhiCiBsZXQgaGFzX29sZF9vdXRwdXQgY29uID0gWGVuYnVzLlhiLmhh
c19vbGRfb3V0cHV0IGNvbi54YgogbGV0IGhhc19uZXdfb3V0cHV0IGNvbiA9
IFhlbmJ1cy5YYi5oYXNfbmV3X291dHB1dCBjb24ueGIKQEAgLTMyMyw3ICs0
NTIsNyBAQCBsZXQgcHJldmVudHNfbGl2ZV91cGRhdGUgY29uID0gbm90IChp
c19iYWQgY29uKQogCSYmIChoYXNfZXh0cmFfY29ubmVjdGlvbl9kYXRhIGNv
biB8fCBoYXNfdHJhbnNhY3Rpb25fZGF0YSBjb24pCiAKIGxldCBoYXNfbW9y
ZV93b3JrIGNvbiA9Ci0JaGFzX21vcmVfaW5wdXQgY29uIHx8IG5vdCAoaGFz
X29sZF9vdXRwdXQgY29uKSAmJiBoYXNfbmV3X291dHB1dCBjb24KKwkoaGFz
X21vcmVfaW5wdXQgY29uICYmIGNhbl9pbnB1dCBjb24pIHx8IG5vdCAoaGFz
X29sZF9vdXRwdXQgY29uKSAmJiBoYXNfbmV3X291dHB1dCBjb24KIAogbGV0
IGluY3Jfb3BzIGNvbiA9IGNvbi5zdGF0X25iX29wcyA8LSBjb24uc3RhdF9u
Yl9vcHMgKyAxCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3Jl
ZC9jb25uZWN0aW9ucy5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25u
ZWN0aW9ucy5tbAppbmRleCAzYzc0MjlmZTdmNjEuLjdkNjhjNTgzYjQzYSAx
MDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb25z
Lm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9ucy5t
bApAQCAtMjIsMjIgKzIyLDMwIEBAIHR5cGUgdCA9IHsKIAlkb21haW5zOiAo
aW50LCBDb25uZWN0aW9uLnQpIEhhc2h0YmwudDsKIAlwb3J0czogKFhlbmV2
ZW50Y2huLnQsIENvbm5lY3Rpb24udCkgSGFzaHRibC50OwogCW11dGFibGUg
d2F0Y2hlczogQ29ubmVjdGlvbi53YXRjaCBsaXN0IFRyaWUudDsKKwltdXRh
YmxlIGhhc19wZW5kaW5nX3dhdGNoZXZlbnRzOiBDb25uZWN0aW9uLldhdGNo
LlNldC50CiB9CiAKIGxldCBjcmVhdGUgKCkgPSB7CiAJYW5vbnltb3VzID0g
SGFzaHRibC5jcmVhdGUgMzc7CiAJZG9tYWlucyA9IEhhc2h0YmwuY3JlYXRl
IDM3OwogCXBvcnRzID0gSGFzaHRibC5jcmVhdGUgMzc7Ci0Jd2F0Y2hlcyA9
IFRyaWUuY3JlYXRlICgpCisJd2F0Y2hlcyA9IFRyaWUuY3JlYXRlICgpOwor
CWhhc19wZW5kaW5nX3dhdGNoZXZlbnRzID0gQ29ubmVjdGlvbi5XYXRjaC5T
ZXQuZW1wdHk7CiB9CiAKK2xldCBnZXRfY2FwYWNpdHkgKCkgPQorCSgqIG5v
dCBtdWx0aXBsaWVkIGJ5IG1heHdhdGNoIG9uIHB1cnBvc2U6IDJuZCBxdWV1
ZSBpbiB3YXRjaCBpdHNlbGYhICopCisJeyBYZW5idXMuWGIubWF4b3V0c3Rh
bmRpbmcgPSAhRGVmaW5lLm1heG91dHN0YW5kaW5nOyBtYXh3YXRjaGV2ZW50
cyA9ICFEZWZpbmUubWF4d2F0Y2hldmVudHMgfQorCiBsZXQgYWRkX2Fub255
bW91cyBjb25zIGZkID0KLQlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9m
ZCBmZCBpbgorCWxldCBjYXBhY2l0eSA9IGdldF9jYXBhY2l0eSAoKSBpbgor
CWxldCB4YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX2ZkIGZkIH5jYXBhY2l0eSBp
bgogCWxldCBjb24gPSBDb25uZWN0aW9uLmNyZWF0ZSB4YmNvbiBOb25lIGlu
CiAJSGFzaHRibC5hZGQgY29ucy5hbm9ueW1vdXMgKFhlbmJ1cy5YYi5nZXRf
ZmQgeGJjb24pIGNvbgogCiBsZXQgYWRkX2RvbWFpbiBjb25zIGRvbSA9Ci0J
bGV0IHhiY29uID0gWGVuYnVzLlhiLm9wZW5fbW1hcCAoRG9tYWluLmdldF9p
bnRlcmZhY2UgZG9tKSAoZnVuICgpIC0+IERvbWFpbi5ub3RpZnkgZG9tKSBp
bgorCWxldCBjYXBhY2l0eSA9IGdldF9jYXBhY2l0eSAoKSBpbgorCWxldCB4
YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX21tYXAgfmNhcGFjaXR5IChEb21haW4u
Z2V0X2ludGVyZmFjZSBkb20pIChmdW4gKCkgLT4gRG9tYWluLm5vdGlmeSBk
b20pIGluCiAJbGV0IGNvbiA9IENvbm5lY3Rpb24uY3JlYXRlIHhiY29uIChT
b21lIGRvbSkgaW4KIAlIYXNodGJsLmFkZCBjb25zLmRvbWFpbnMgKERvbWFp
bi5nZXRfaWQgZG9tKSBjb247CiAJbWF0Y2ggRG9tYWluLmdldF9wb3J0IGRv
bSB3aXRoCkBAIC00OCw3ICs1Niw5IEBAIGxldCBzZWxlY3QgPyhvbmx5X2lm
ID0gKGZ1biBfIC0+IHRydWUpKSBjb25zID0KIAlIYXNodGJsLmZvbGQgKGZ1
biBfIGNvbiAoaW5zLCBvdXRzKSAtPgogCQlpZiAob25seV9pZiBjb24pIHRo
ZW4gKAogCQkJbGV0IGZkID0gQ29ubmVjdGlvbi5nZXRfZmQgY29uIGluCi0J
CQkoZmQgOjogaW5zLCAgaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0
aGVuIGZkIDo6IG91dHMgZWxzZSBvdXRzKQorCQkJbGV0IGluX2ZkcyA9IGlm
IENvbm5lY3Rpb24uY2FuX2lucHV0IGNvbiB0aGVuIGZkIDo6IGlucyBlbHNl
IGlucyBpbgorCQkJbGV0IG91dF9mZHMgPSBpZiBDb25uZWN0aW9uLmhhc19v
dXRwdXQgY29uIHRoZW4gZmQgOjogb3V0cyBlbHNlIG91dHMgaW4KKwkJCWlu
X2Zkcywgb3V0X2ZkcwogCQkpIGVsc2UgKGlucywgb3V0cykKIAkpCiAJY29u
cy5hbm9ueW1vdXMgKFtdLCBbXSkKQEAgLTY3LDEwICs3NywxNyBAQCBsZXQg
ZGVsX3dhdGNoZXNfb2ZfY29uIGNvbiB3YXRjaGVzID0KIAl8IFtdIC0+IE5v
bmUKIAl8IHdzIC0+IFNvbWUgd3MKIAorbGV0IGRlbF93YXRjaGVzIGNvbnMg
Y29uID0KKwlDb25uZWN0aW9uLmRlbF93YXRjaGVzIGNvbjsKKwljb25zLndh
dGNoZXMgPC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNv
bnMud2F0Y2hlczsKKwljb25zLmhhc19wZW5kaW5nX3dhdGNoZXZlbnRzIDwt
CisJCWNvbnMuaGFzX3BlbmRpbmdfd2F0Y2hldmVudHMgfD4gQ29ubmVjdGlv
bi5XYXRjaC5TZXQuZmlsdGVyIEBAIGZ1biB3IC0+CisJCUNvbm5lY3Rpb24u
Z2V0X2NvbiB3ICE9IGNvbgorCiBsZXQgZGVsX2Fub255bW91cyBjb25zIGNv
biA9CiAJdHJ5CiAJCUhhc2h0YmwucmVtb3ZlIGNvbnMuYW5vbnltb3VzIChD
b25uZWN0aW9uLmdldF9mZCBjb24pOwotCQljb25zLndhdGNoZXMgPC0gVHJp
ZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNvbnMud2F0Y2hlczsK
KwkJZGVsX3dhdGNoZXMgY29ucyBjb247CiAJCUNvbm5lY3Rpb24uY2xvc2Ug
Y29uCiAJd2l0aCBleG4gLT4KIAkJZGVidWcgImRlbCBhbm9ueW1vdXMgJXMi
IChQcmludGV4Yy50b19zdHJpbmcgZXhuKQpAQCAtODUsNyArMTAyLDcgQEAg
bGV0IGRlbF9kb21haW4gY29ucyBpZCA9CiAJCSAgICB8IFNvbWUgcCAtPiBI
YXNodGJsLnJlbW92ZSBjb25zLnBvcnRzIHAKIAkJICAgIHwgTm9uZSAtPiAo
KSkKIAkJIHwgTm9uZSAtPiAoKSk7Ci0JCWNvbnMud2F0Y2hlcyA8LSBUcmll
Lm1hcCAoZGVsX3dhdGNoZXNfb2ZfY29uIGNvbikgY29ucy53YXRjaGVzOwor
CQlkZWxfd2F0Y2hlcyBjb25zIGNvbjsKIAkJQ29ubmVjdGlvbi5jbG9zZSBj
b24KIAl3aXRoIGV4biAtPgogCQlkZWJ1ZyAiZGVsIGRvbWFpbiAldTogJXMi
IGlkIChQcmludGV4Yy50b19zdHJpbmcgZXhuKQpAQCAtMTM2LDMxICsxNTMs
MzMgQEAgbGV0IGRlbF93YXRjaCBjb25zIGNvbiBwYXRoIHRva2VuID0KIAkJ
Y29ucy53YXRjaGVzIDwtIFRyaWUuc2V0IGNvbnMud2F0Y2hlcyBrZXkgd2F0
Y2hlczsKICAJd2F0Y2gKIAotbGV0IGRlbF93YXRjaGVzIGNvbnMgY29uID0K
LQlDb25uZWN0aW9uLmRlbF93YXRjaGVzIGNvbjsKLQljb25zLndhdGNoZXMg
PC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNvbnMud2F0
Y2hlcwotCiAoKiBwYXRoIGlzIGFic29sdXRlICopCi1sZXQgZmlyZV93YXRj
aGVzID9vbGRyb290IHJvb3QgY29ucyBwYXRoIHJlY3Vyc2UgPQorbGV0IGZp
cmVfd2F0Y2hlcyA/b2xkcm9vdCBzb3VyY2Ugcm9vdCBjb25zIHBhdGggcmVj
dXJzZSA9CiAJbGV0IGtleSA9IGtleV9vZl9wYXRoIHBhdGggaW4KIAlsZXQg
cGF0aCA9IFN0b3JlLlBhdGgudG9fc3RyaW5nIHBhdGggaW4KIAlsZXQgcm9v
dHMgPSBvbGRyb290LCByb290IGluCiAJbGV0IGZpcmVfd2F0Y2ggXyA9IGZ1
bmN0aW9uCiAJCXwgTm9uZSAgICAgICAgIC0+ICgpCi0JCXwgU29tZSB3YXRj
aGVzIC0+IExpc3QuaXRlciAoZnVuIHcgLT4gQ29ubmVjdGlvbi5maXJlX3dh
dGNoIHJvb3RzIHcgcGF0aCkgd2F0Y2hlcworCQl8IFNvbWUgd2F0Y2hlcyAt
PiBMaXN0Lml0ZXIgKGZ1biB3IC0+IENvbm5lY3Rpb24uZmlyZV93YXRjaCBz
b3VyY2Ugcm9vdHMgdyBwYXRoKSB3YXRjaGVzCiAJaW4KIAlsZXQgZmlyZV9y
ZWMgX3ggPSBmdW5jdGlvbgogCQl8IE5vbmUgICAgICAgICAtPiAoKQogCQl8
IFNvbWUgd2F0Y2hlcyAtPgotCQkJTGlzdC5pdGVyIChDb25uZWN0aW9uLmZp
cmVfc2luZ2xlX3dhdGNoIHJvb3RzKSB3YXRjaGVzCisJCQlMaXN0Lml0ZXIg
KENvbm5lY3Rpb24uZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIHJvb3RzKSB3
YXRjaGVzCiAJaW4KIAlUcmllLml0ZXJfcGF0aCBmaXJlX3dhdGNoIGNvbnMu
d2F0Y2hlcyBrZXk7CiAJaWYgcmVjdXJzZSB0aGVuCiAJCVRyaWUuaXRlciBm
aXJlX3JlYyAoVHJpZS5zdWIgY29ucy53YXRjaGVzIGtleSkKIAorbGV0IHNl
bmRfd2F0Y2hldmVudHMgY29ucyBjb24gPQorCWNvbnMuaGFzX3BlbmRpbmdf
d2F0Y2hldmVudHMgPC0KKwkJY29ucy5oYXNfcGVuZGluZ193YXRjaGV2ZW50
cyB8PiBDb25uZWN0aW9uLldhdGNoLlNldC5maWx0ZXIgQ29ubmVjdGlvbi5X
YXRjaC5mbHVzaF9ldmVudHM7CisJQ29ubmVjdGlvbi5zb3VyY2VfZmx1c2hf
d2F0Y2hldmVudHMgY29uCisKIGxldCBmaXJlX3NwZWNfd2F0Y2hlcyByb290
IGNvbnMgc3BlY3BhdGggPQorCWxldCBzb3VyY2UgPSBmaW5kX2RvbWFpbiBj
b25zIDAgaW4KIAlpdGVyIGNvbnMgKGZ1biBjb24gLT4KLQkJTGlzdC5pdGVy
IChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoIChOb25lLCByb290KSkg
KENvbm5lY3Rpb24uZ2V0X3dhdGNoZXMgY29uIHNwZWNwYXRoKSkKKwkJTGlz
dC5pdGVyIChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoIHNvdXJjZSAo
Tm9uZSwgcm9vdCkpIChDb25uZWN0aW9uLmdldF93YXRjaGVzIGNvbiBzcGVj
cGF0aCkpCiAKIGxldCBzZXRfdGFyZ2V0IGNvbnMgZG9tYWluIHRhcmdldF9k
b21haW4gPQogCWxldCBjb24gPSBmaW5kX2RvbWFpbiBjb25zIGRvbWFpbiBp
bgpAQCAtMTk3LDYgKzIxNiwxNiBAQCBsZXQgZGVidWcgY29ucyA9CiAJbGV0
IGRvbWFpbnMgPSBIYXNodGJsLmZvbGQgKGZ1biBfIGNvbiBhY2N1IC0+IENv
bm5lY3Rpb24uZGVidWcgY29uIDo6IGFjY3UpIGNvbnMuZG9tYWlucyBbXSBp
bgogCVN0cmluZy5jb25jYXQgIiIgKGRvbWFpbnMgQCBhbm9ueW1vdXMpCiAK
K2xldCBkZWJ1Z193YXRjaGV2ZW50cyBjb25zIGNvbiA9CisJKCogPT0gKHBo
eXNpY2FsIGVxdWFsaXR5KQorCSAgIGhhcyB0byBiZSB1c2VkIGhlcmUgYmVj
YXVzZSB3LmNvbi54Yi5iYWNrZW5kIG1pZ2h0IGNvbnRhaW4gYSBbdW5pdC0+
dW5pdF0gdmFsdWUgY2F1c2luZyByZWd1bGFyCisJICAgY29tcGFyaXNvbiB0
byBmYWlsIGR1ZSB0byBoYXZpbmcgYSAnZnVuY3Rpb25hbCB2YWx1ZScgd2hp
Y2ggY2Fubm90IGJlIGNvbXBhcmVkLgorCSAqKQorCWxldCBzID0gY29ucy5o
YXNfcGVuZGluZ193YXRjaGV2ZW50cyB8PiBDb25uZWN0aW9uLldhdGNoLlNl
dC5maWx0ZXIgKGZ1biB3IC0+IHcuY29uID09IGNvbikgaW4KKwlsZXQgcGVu
ZGluZyA9IHMgfD4gQ29ubmVjdGlvbi5XYXRjaC5TZXQuZWxlbWVudHMKKwkJ
fD4gTGlzdC5tYXAgKGZ1biB3IC0+IENvbm5lY3Rpb24uV2F0Y2gucGVuZGlu
Z193YXRjaGV2ZW50cyB3KSB8PiBMaXN0LmZvbGRfbGVmdCAoKykgMCBpbgor
CVByaW50Zi5zcHJpbnRmICJXYXRjaGVzIHdpdGggcGVuZGluZyBldmVudHM6
ICVkLCBwZW5kaW5nIGV2ZW50cyB0b3RhbDogJWQiIChDb25uZWN0aW9uLldh
dGNoLlNldC5jYXJkaW5hbCBzKSBwZW5kaW5nCisKIGxldCBmaWx0ZXIgfmYg
Y29ucyA9CiAJbGV0IGZvbGQgXyB2IGFjYyA9IGlmIGYgdiB0aGVuIHYgOjog
YWNjIGVsc2UgYWNjIGluCiAJW10KZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQv
ZGVmaW5lLm1sCmluZGV4IGJhNjNhODE0N2UwOS4uMzI3YjZkNzk1ZWM3IDEw
MDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvZGVmaW5lLm1sCisr
KyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKQEAgLTI0LDYg
KzI0LDEzIEBAIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRocy54ZW5f
Y29uZmlnX2RpcgogbGV0IG1heHdhdGNoID0gcmVmICgxMDApCiBsZXQgbWF4
dHJhbnNhY3Rpb24gPSByZWYgKDEwKQogbGV0IG1heHJlcXVlc3RzID0gcmVm
ICgxMDI0KSAgICgqIG1heGltdW0gcmVxdWVzdHMgcGVyIHRyYW5zYWN0aW9u
ICopCitsZXQgbWF4b3V0c3RhbmRpbmcgPSByZWYgKDEwMjQpICgqIG1heGlt
dW0gb3V0c3RhbmRpbmcgcmVxdWVzdHMsIGkuZS4gaW4tZmxpZ2h0IHJlcXVl
c3RzIC8gZG9tYWluICopCitsZXQgbWF4d2F0Y2hldmVudHMgPSByZWYgKDEw
MjQpCisoKgorCW1heGltdW0gb3V0c3RhbmRpbmcgd2F0Y2ggZXZlbnRzIHBl
ciB3YXRjaCwKKwlyZWNvbW1lbmRlZCA+PSBtYXhvdXRzdGFuZGluZyB0byBh
dm9pZCBibG9ja2luZyBiYWNrZW5kIHRyYW5zYWN0aW9ucyBkdWUgdG8KKwlt
YWxpY2lvdXMgZnJvbnRlbmRzCisgKikKIAogbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9veGVuc3RvcmVkLmNv
bmYuaW4gYi90b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25m
LmluCmluZGV4IDRhZTQ4ZTQyZDQ3ZC4uOWQwMzRlNzQ0YjRiIDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmlu
CisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9veGVuc3RvcmVkLmNvbmYu
aW4KQEAgLTYyLDYgKzYyLDggQEAgcXVvdGEtbWF4d2F0Y2ggPSAxMDAKIHF1
b3RhLXRyYW5zYWN0aW9uID0gMTAKIHF1b3RhLW1heHJlcXVlc3RzID0gMTAy
NAogcXVvdGEtcGF0aC1tYXggPSAxMDI0CitxdW90YS1tYXhvdXRzdGFuZGlu
ZyA9IDEwMjQKK3F1b3RhLW1heHdhdGNoZXZlbnRzID0gMTAyNAogCiAjIEFj
dGl2YXRlIGZpbGVkIGJhc2UgYmFja2VuZAogcGVyc2lzdGVudCA9IGZhbHNl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5t
bCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDJk
Njc0NTZhMmFhMC4uNmRjZWRmZGE4NmU0IDEwMDY0NAotLS0gYS90b29scy9v
Y2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94
ZW5zdG9yZWQvcHJvY2Vzcy5tbApAQCAtNTcsNyArNTcsNyBAQCBsZXQgc3Bs
aXRfb25lX3BhdGggZGF0YSBjb24gPQogCXwgcGF0aCA6OiAiIiA6OiBbXSAt
PiBTdG9yZS5QYXRoLmNyZWF0ZSBwYXRoIChDb25uZWN0aW9uLmdldF9wYXRo
IGNvbikKIAl8IF8gICAgICAgICAgICAgICAgLT4gcmFpc2UgSW52YWxpZF9D
bWRfQXJncwogCi1sZXQgcHJvY2Vzc193YXRjaCB0IGNvbnMgPQorbGV0IHBy
b2Nlc3Nfd2F0Y2ggc291cmNlIHQgY29ucyA9CiAJbGV0IG9sZHJvb3QgPSB0
LlRyYW5zYWN0aW9uLm9sZHJvb3QgaW4KIAlsZXQgbmV3cm9vdCA9IFN0b3Jl
LmdldF9yb290IHQuc3RvcmUgaW4KIAlsZXQgb3BzID0gVHJhbnNhY3Rpb24u
Z2V0X3BhdGhzIHQgfD4gTGlzdC5yZXYgaW4KQEAgLTY3LDggKzY3LDkgQEAg
bGV0IHByb2Nlc3Nfd2F0Y2ggdCBjb25zID0KIAkJfCBYZW5idXMuWGIuT3Au
Um0gICAgICAgLT4gdHJ1ZSwgTm9uZSwgb2xkcm9vdAogCQl8IFhlbmJ1cy5Y
Yi5PcC5TZXRwZXJtcyAtPiBmYWxzZSwgU29tZSBvbGRyb290LCBuZXdyb290
CiAJCXwgXyAgICAgICAgICAgICAgLT4gcmFpc2UgKEZhaWx1cmUgImh1aCA/
IikgaW4KLQkJQ29ubmVjdGlvbnMuZmlyZV93YXRjaGVzID9vbGRyb290IHJv
b3QgY29ucyAoc25kIG9wKSByZWN1cnNlIGluCi0JTGlzdC5pdGVyIChmdW4g
b3AgLT4gZG9fb3Bfd2F0Y2ggb3AgY29ucykgb3BzCisJCUNvbm5lY3Rpb25z
LmZpcmVfd2F0Y2hlcyA/b2xkcm9vdCBzb3VyY2Ugcm9vdCBjb25zIChzbmQg
b3ApIHJlY3Vyc2UgaW4KKwlMaXN0Lml0ZXIgKGZ1biBvcCAtPiBkb19vcF93
YXRjaCBvcCBjb25zKSBvcHM7CisJQ29ubmVjdGlvbnMuc2VuZF93YXRjaGV2
ZW50cyBjb25zIHNvdXJjZQogCiBsZXQgY3JlYXRlX2ltcGxpY2l0X3BhdGgg
dCBwZXJtIHBhdGggPQogCWxldCBkaXJuYW1lID0gU3RvcmUuUGF0aC5nZXRf
cGFyZW50IHBhdGggaW4KQEAgLTIzNCw2ICsyMzUsMjAgQEAgbGV0IGRvX2Rl
YnVnIGNvbiB0IF9kb21haW5zIGNvbnMgZGF0YSA9CiAJfCAid2F0Y2hlcyIg
OjogXyAtPgogCQlsZXQgd2F0Y2hlcyA9IENvbm5lY3Rpb25zLmRlYnVnIGNv
bnMgaW4KIAkJU29tZSAod2F0Y2hlcyBeICJcMDAwIikKKwl8ICJ4ZW5idXMi
IDo6IGRvbWlkIDo6IF8gLT4KKwkJbGV0IGRvbWlkID0gaW50X29mX3N0cmlu
ZyBkb21pZCBpbgorCQlsZXQgY29uID0gQ29ubmVjdGlvbnMuZmluZF9kb21h
aW4gY29ucyBkb21pZCBpbgorCQlsZXQgcyA9IFByaW50Zi5zcHJpbnRmICJ4
ZW5idXM6ICVzOyBvdmVyZmxvdyBxdWV1ZSBsZW5ndGg6ICVkLCBjYW5faW5w
dXQ6ICViLCBoYXNfbW9yZV9pbnB1dDogJWIsIGhhc19vbGRfb3V0cHV0OiAl
YiwgaGFzX25ld19vdXRwdXQ6ICViLCBoYXNfbW9yZV93b3JrOiAlYi4gcGVu
ZGluZzogJXMiCisJCQkoWGVuYnVzLlhiLmRlYnVnIGNvbi54YikKKwkJCShD
b25uZWN0aW9uLnNvdXJjZV9wZW5kaW5nX3dhdGNoZXZlbnRzIGNvbikKKwkJ
CShDb25uZWN0aW9uLmNhbl9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5o
YXNfbW9yZV9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfb2xkX291
dHB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfbmV3X291dHB1dCBjb24p
CisJCQkoQ29ubmVjdGlvbi5oYXNfbW9yZV93b3JrIGNvbikKKwkJCShDb25u
ZWN0aW9ucy5kZWJ1Z193YXRjaGV2ZW50cyBjb25zIGNvbikKKwkJaW4KKwkJ
U29tZSBzCiAJfCAibWZuIiA6OiBkb21pZCA6OiBfIC0+CiAJCWxldCBkb21p
ZCA9IGludF9vZl9zdHJpbmcgZG9taWQgaW4KIAkJbGV0IGNvbiA9IENvbm5l
Y3Rpb25zLmZpbmRfZG9tYWluIGNvbnMgZG9taWQgaW4KQEAgLTM0Miw3ICsz
NTcsNyBAQCBsZXQgcmVwbHlfYWNrIGZjdCBjb24gdCBkb21zIGNvbnMgZGF0
YSA9CiAJZmN0IGNvbiB0IGRvbXMgY29ucyBkYXRhOwogCVBhY2tldC5BY2sg
KGZ1biAoKSAtPgogCQlpZiBUcmFuc2FjdGlvbi5nZXRfaWQgdCA9IFRyYW5z
YWN0aW9uLm5vbmUgdGhlbgotCQkJcHJvY2Vzc193YXRjaCB0IGNvbnMKKwkJ
CXByb2Nlc3Nfd2F0Y2ggY29uIHQgY29ucwogCSkKIAogbGV0IHJlcGx5X2Rh
dGEgZmN0IGNvbiB0IGRvbXMgY29ucyBkYXRhID0KQEAgLTUwMSw3ICs1MTYs
NyBAQCBsZXQgZG9fd2F0Y2ggY29uIHQgX2RvbWFpbnMgY29ucyBkYXRhID0K
IAlQYWNrZXQuQWNrIChmdW4gKCkgLT4KIAkJKCogeGVuc3RvcmUudHh0IHNh
eXMgdGhpcyB3YXRjaCBpcyBmaXJlZCBpbW1lZGlhdGVseSwKIAkJICAgaW1w
bHlpbmcgZXZlbiBpZiBwYXRoIGRvZXNuJ3QgZXhpc3Qgb3IgaXMgdW5yZWFk
YWJsZSAqKQotCQlDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoX3VuY2hl
Y2tlZCB3YXRjaCkKKwkJQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRjaF91
bmNoZWNrZWQgY29uIHdhdGNoKQogCiBsZXQgZG9fdW53YXRjaCBjb24gX3Qg
X2RvbWFpbnMgY29ucyBkYXRhID0KIAlsZXQgKG5vZGUsIHRva2VuKSA9CkBA
IC01MzIsNyArNTQ3LDcgQEAgbGV0IGRvX3RyYW5zYWN0aW9uX2VuZCBjb24g
dCBkb21haW5zIGNvbnMgZGF0YSA9CiAJaWYgbm90IHN1Y2Nlc3MgdGhlbgog
CQlyYWlzZSBUcmFuc2FjdGlvbl9hZ2FpbjsKIAlpZiBjb21taXQgdGhlbiBi
ZWdpbgotCQlwcm9jZXNzX3dhdGNoIHQgY29uczsKKwkJcHJvY2Vzc193YXRj
aCBjb24gdCBjb25zOwogCQltYXRjaCB0LlRyYW5zYWN0aW9uLnR5IHdpdGgK
IAkJfCBUcmFuc2FjdGlvbi5ObyAtPgogCQkJKCkgKCogbm8gbmVlZCB0byBy
ZWNvcmQgYW55dGhpbmcgKikKQEAgLTY5OSw3ICs3MTQsOCBAQCBsZXQgcHJv
Y2Vzc19wYWNrZXQgfnN0b3JlIH5jb25zIH5kb21zIH5jb24gfnJlcSA9CiBs
ZXQgZG9faW5wdXQgc3RvcmUgY29ucyBkb21zIGNvbiA9CiAJbGV0IG5ld3Bh
Y2tldCA9CiAJCXRyeQotCQkJQ29ubmVjdGlvbi5kb19pbnB1dCBjb24KKwkJ
CWlmIENvbm5lY3Rpb24uY2FuX2lucHV0IGNvbiB0aGVuIENvbm5lY3Rpb24u
ZG9faW5wdXQgY29uCisJCQllbHNlIE5vbmUKIAkJd2l0aCBYZW5idXMuWGIu
UmVjb25uZWN0IC0+CiAJCQlpbmZvICIlcyByZXF1ZXN0cyBhIHJlY29ubmVj
dCIgKENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24pOwogCQkJSGlzdG9yeS5y
ZWNvbm5lY3QgY29uOwpAQCAtNzI3LDYgKzc0Myw3IEBAIGxldCBkb19pbnB1
dCBzdG9yZSBjb25zIGRvbXMgY29uID0KIAkJQ29ubmVjdGlvbi5pbmNyX29w
cyBjb24KIAogbGV0IGRvX291dHB1dCBfc3RvcmUgX2NvbnMgX2RvbXMgY29u
ID0KKwlDb25uZWN0aW9uLnNvdXJjZV9mbHVzaF93YXRjaGV2ZW50cyBjb247
CiAJaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0aGVuICgKIAkJaWYg
Q29ubmVjdGlvbi5oYXNfbmV3X291dHB1dCBjb24gdGhlbiAoCiAJCQlsZXQg
cGFja2V0ID0gQ29ubmVjdGlvbi5wZWVrX291dHB1dCBjb24gaW4KZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC94ZW5zdG9yZWQubWwgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCmluZGV4IDNiNTdh
ZDAxNmRmYi4uYzc5OWUyMGYxMTQ1IDEwMDY0NAotLS0gYS90b29scy9vY2Ft
bC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC94ZW5zdG9yZWQubWwKQEAgLTEwMyw2ICsxMDMsOCBAQCBsZXQg
cGFyc2VfY29uZmlnIGZpbGVuYW1lID0KIAkJKCJxdW90YS1tYXhlbnRpdHki
LCBDb25maWcuU2V0X2ludCBRdW90YS5tYXhlbnQpOwogCQkoInF1b3RhLW1h
eHNpemUiLCBDb25maWcuU2V0X2ludCBRdW90YS5tYXhzaXplKTsKIAkJKCJx
dW90YS1tYXhyZXF1ZXN0cyIsIENvbmZpZy5TZXRfaW50IERlZmluZS5tYXhy
ZXF1ZXN0cyk7CisJCSgicXVvdGEtbWF4b3V0c3RhbmRpbmciLCBDb25maWcu
U2V0X2ludCBEZWZpbmUubWF4b3V0c3RhbmRpbmcpOworCQkoInF1b3RhLW1h
eHdhdGNoZXZlbnRzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHdhdGNo
ZXZlbnRzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CiAJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-oxenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-oxenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSA4ZWJhMGJhYjljMzZjMDRkOTI0ZjlmZTk3YjFmYTI2NGZlMjNmMTll
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFRodSwgMjkgU2VwIDIwMjIgMTM6
MDc6MzUgKzAyMDAKU3ViamVjdDogU1VQUE9SVC5tZDogY2xhcmlmeSBzdXBw
b3J0IG9mIHVudHJ1c3RlZCBkcml2ZXIgZG9tYWlucyB3aXRoCiBveGVuc3Rv
cmVkCgpBZGQgYSBzdXBwb3J0IHN0YXRlbWVudCBmb3IgdGhlIHNjb3BlIG9m
IHN1cHBvcnQgcmVnYXJkaW5nIGRpZmZlcmVudApYZW5zdG9yZSB2YXJpYW50
cy4gRXNwZWNpYWxseSBveGVuc3RvcmVkIGRvZXMgbm90ICh5ZXQpIGhhdmUg
c2VjdXJpdHkKc3VwcG9ydCBvZiB1bnRydXN0ZWQgZHJpdmVyIGRvbWFpbnMs
IGFzIHRob3NlIG1pZ2h0IGRyaXZlIG94ZW5zdG9yZWQKb3V0IG9mIG1lbW9y
eSBieSBjcmVhdGluZyBsb3RzIG9mIHdhdGNoIGV2ZW50cyBmb3IgdGhlIGd1
ZXN0cyB0aGV5IGFyZQpzZXJ2aWNpbmcuCgpBZGQgYSBzdGF0ZW1lbnQgcmVn
YXJkaW5nIExpdmUgVXBkYXRlIHN1cHBvcnQgb2Ygb3hlbnN0b3JlZC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBD
aHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+
CgpkaWZmIC0tZ2l0IGEvU1VQUE9SVC5tZCBiL1NVUFBPUlQubWQKaW5kZXgg
MGZiMjYyZjgxZjQwLi40OGZiNDYyMjIxY2YgMTAwNjQ0Ci0tLSBhL1NVUFBP
UlQubWQKKysrIGIvU1VQUE9SVC5tZApAQCAtMTc5LDEzICsxNzksMTggQEAg
U3VwcG9ydCBmb3IgcnVubmluZyBxZW11LXhlbiBkZXZpY2UgbW9kZWwgaW4g
YSBsaW51eCBzdHViZG9tYWluLgogCiAgICAgU3RhdHVzOiBUZWNoIFByZXZp
ZXcKIAotIyMgTGl2ZXVwZGF0ZSBvZiBDIHhlbnN0b3JlZCBkYWVtb24KKyMj
IFhlbnN0b3JlCiAKLSAgICBTdGF0dXM6IFRlY2ggUHJldmlldworIyMjIEMg
eGVuc3RvcmVkIGRhZW1vbgogCi0jIyBMaXZldXBkYXRlIG9mIE9DYW1sIHhl
bnN0b3JlZCBkYWVtb24KKyAgICBTdGF0dXM6IFN1cHBvcnRlZAorICAgIFN0
YXR1cywgTGl2ZXVwZGF0ZTogVGVjaCBQcmV2aWV3CiAKLSAgICBTdGF0dXM6
IFRlY2ggUHJldmlldworIyMjIE9DYW1sIHhlbnN0b3JlZCBkYWVtb24KKwor
ICAgIFN0YXR1czogU3VwcG9ydGVkCisgICAgU3RhdHVzLCB1bnRydXN0ZWQg
ZHJpdmVyIGRvbWFpbnM6IFN1cHBvcnRlZCwgbm90IHNlY3VyaXR5IHN1cHBv
cnRlZAorICAgIFN0YXR1cywgTGl2ZXVwZGF0ZTogTm90IGZ1bmN0aW9uYWwK
IAogIyMgVG9vbHN0YWNrLzNyZCBwYXJ0eQogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSBiYjIyNzA5ZDk0ZmE5OGY1YTJhYmJhNGVlZWJhNDFlZjA5NzUzZjhl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNwbGl0IHVw
IHNlbmRfcmVwbHkoKQoKVG9kYXkgc2VuZF9yZXBseSgpIGlzIHVzZWQgZm9y
IGJvdGgsIG5vcm1hbCByZXF1ZXN0IHJlcGxpZXMgYW5kIHdhdGNoCmV2ZW50
cy4KClNwbGl0IGl0IHVwIGludG8gc2VuZF9yZXBseSgpIGFuZCBzZW5kX2V2
ZW50KCkuIFRoaXMgd2lsbCBiZSB1c2VkIHRvCmFkZCBzb21lIGV2ZW50IHNw
ZWNpZmljIGhhbmRsaW5nLgoKYWRkX2V2ZW50KCkgY2FuIGJlIG1lcmdlZCBp
bnRvIHNlbmRfZXZlbnQoKSwgcmVtb3ZpbmcgdGhlIG5lZWQgZm9yIGFuCmlu
dGVybWVkaWF0ZSBtZW1vcnkgYWxsb2NhdGlvbi4KClRoaXMgaXMgcGFydCBv
ZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdy
YWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9j
b3JlLmMKaW5kZXggYjI4YzJjNjZiNTNiLi4wMWQ0YTJlNDQwZWMgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNzMzLDQ5ICs3
MzMsMzIgQEAgc3RhdGljIHZvaWQgc2VuZF9lcnJvcihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgaW50IGVycm9yKQogdm9pZCBzZW5kX3JlcGx5KHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlw
ZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbikKIHsK
LQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7CisJc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmJkYXRhID0gY29ubi0+aW47CisKKwlhc3NlcnQodHlwZSAh
PSBYU19XQVRDSF9FVkVOVCk7CiAKIAlpZiAoIGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYICkgewogCQlzZW5kX2Vycm9yKGNvbm4sIEUyQklHKTsKIAkJ
cmV0dXJuOwogCX0KIAotCS8qIFJlcGxpZXMgcmV1c2UgdGhlIHJlcXVlc3Qg
YnVmZmVyLCBldmVudHMgbmVlZCBhIG5ldyBvbmUuICovCi0JaWYgKHR5cGUg
IT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJYmRhdGEgPSBjb25uLT5pbjsKLQkJ
LyogRHJvcCBhc3luY2hyb25vdXMgcmVzcG9uc2VzLCBlLmcuIGVycm9ycyBm
b3Igd2F0Y2ggZXZlbnRzLiAqLwotCQlpZiAoIWJkYXRhKQotCQkJcmV0dXJu
OwotCQliZGF0YS0+aW5oZHIgPSB0cnVlOwotCQliZGF0YS0+dXNlZCA9IDA7
Ci0JCWNvbm4tPmluID0gTlVMTDsKLQl9IGVsc2UgewotCQkvKiBNZXNzYWdl
IGlzIGEgY2hpbGQgb2YgdGhlIGNvbm5lY3Rpb24gZm9yIGF1dG8tY2xlYW51
cC4gKi8KLQkJYmRhdGEgPSBuZXdfYnVmZmVyKGNvbm4pOworCWlmICghYmRh
dGEpCisJCXJldHVybjsKKwliZGF0YS0+aW5oZHIgPSB0cnVlOworCWJkYXRh
LT51c2VkID0gMDsKIAotCQkvKgotCQkgKiBBbGxvY2F0aW9uIGZhaWx1cmUg
aGVyZSBpcyB1bmZvcnR1bmF0ZTogd2UgaGF2ZSBubyB3YXkgdG8KLQkJICog
dGVsbCBhbnlib2R5IGFib3V0IGl0LgotCQkgKi8KLQkJaWYgKCFiZGF0YSkK
LQkJCXJldHVybjsKLQl9CiAJaWYgKGxlbiA8PSBERUZBVUxUX0JVRkZFUl9T
SVpFKQogCQliZGF0YS0+YnVmZmVyID0gYmRhdGEtPmRlZmF1bHRfYnVmZmVy
OwotCWVsc2UKKwllbHNlIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IHRhbGxvY19h
cnJheShiZGF0YSwgY2hhciwgbGVuKTsKLQlpZiAoIWJkYXRhLT5idWZmZXIp
IHsKLQkJaWYgKHR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJCS8qIFNh
bWUgYXMgYWJvdmU6IG5vIHdheSB0byB0ZWxsIHNvbWVvbmUuICovCi0JCQl0
YWxsb2NfZnJlZShiZGF0YSk7CisJCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQkJc2VuZF9lcnJvcihjb25uLCBFTk9NRU0pOwogCQkJcmV0dXJuOwogCQl9
Ci0JCS8qIHJlLWVzdGFibGlzaCByZXF1ZXN0IGJ1ZmZlciBmb3Igc2VuZGlu
ZyBFTk9NRU0uICovCi0JCWNvbm4tPmluID0gYmRhdGE7Ci0JCXNlbmRfZXJy
b3IoY29ubiwgRU5PTUVNKTsKLQkJcmV0dXJuOwogCX0KIAorCWNvbm4tPmlu
ID0gTlVMTDsKKwogCS8qIFVwZGF0ZSByZWxldmFudCBoZWFkZXIgZmllbGRz
IGFuZCBmaWxsIGluIHRoZSBtZXNzYWdlIGJvZHkuICovCiAJYmRhdGEtPmhk
ci5tc2cudHlwZSA9IHR5cGU7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVu
OwpAQCAtNzgzLDggKzc2NiwzOSBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBl
LAogCiAJLyogUXVldWUgZm9yIGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAls
aXN0X2FkZF90YWlsKCZiZGF0YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsK
K30KIAotCXJldHVybjsKKy8qCisgKiBTZW5kIGEgd2F0Y2ggZXZlbnQuCisg
KiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSByZWxhdGVkIHRvIHRoZSBjdXJy
ZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBiZQorICogcmVwb3J0ZWQuCisg
Ki8KK3ZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pCit7CisJc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhOworCXVuc2lnbmVkIGludCBsZW47
CisKKwlsZW4gPSBzdHJsZW4ocGF0aCkgKyAxICsgc3RybGVuKHRva2VuKSAr
IDE7CisJLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4g
Ki8KKwlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCisJCXJldHVy
bjsKKworCWJkYXRhID0gbmV3X2J1ZmZlcihjb25uKTsKKwlpZiAoIWJkYXRh
KQorCQlyZXR1cm47CisKKwliZGF0YS0+YnVmZmVyID0gdGFsbG9jX2FycmF5
KGJkYXRhLCBjaGFyLCBsZW4pOworCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQl0YWxsb2NfZnJlZShiZGF0YSk7CisJCXJldHVybjsKKwl9CisJc3RyY3B5
KGJkYXRhLT5idWZmZXIsIHBhdGgpOworCXN0cmNweShiZGF0YS0+YnVmZmVy
ICsgc3RybGVuKHBhdGgpICsgMSwgdG9rZW4pOworCWJkYXRhLT5oZHIubXNn
LnR5cGUgPSBYU19XQVRDSF9FVkVOVDsKKwliZGF0YS0+aGRyLm1zZy5sZW4g
PSBsZW47CisKKwkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAq
LworCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xp
c3QpOwogfQogCiAvKiBTb21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0
YykganVzdCBuZWVkIGEgbm9uLWVycm9yIHJldHVybiAqLwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggOTAwMzM2YWZhNDI2Li4z
OGQ5N2ZhMDgxYTYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaApAQCAtMTgwLDYgKzE4MCw3IEBAIHVuc2lnbmVkIGludCBnZXRfc3Ry
aW5nKGNvbnN0IHN0cnVjdCBidWZmZXJlZF9kYXRhICpkYXRhLCB1bnNpZ25l
ZCBpbnQgb2Zmc2V0KTsKIAogdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAkJ
Y29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbik7Cit2b2lkIHNl
bmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IGNoYXIg
KnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKIAogLyogU29tZSByb3V0aW5l
cyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3QgbmVlZCBhIG5vbi1lcnJvciBy
ZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlKTsKZGlmZiAtLWdpdCBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggZGI4OWUwMTQxZmNlLi5h
MTE2Zjk2N2RjNjYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jCkBAIC04NiwzNSArODYsNiBAQCBzdGF0aWMgY29uc3QgY2hhciAq
Z2V0X3dhdGNoX3BhdGgoY29uc3Qgc3RydWN0IHdhdGNoICp3YXRjaCwgY29u
c3QgY2hhciAqbmFtZSkKIH0KIAogLyoKLSAqIFNlbmQgYSB3YXRjaCBldmVu
dC4KLSAqIFRlbXBvcmFyeSBtZW1vcnkgYWxsb2NhdGlvbnMgYXJlIGRvbmUg
d2l0aCBjdHguCi0gKi8KLXN0YXRpYyB2b2lkIGFkZF9ldmVudChzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKLQkJICAgICAgY29uc3Qgdm9pZCAqY3R4LAot
CQkgICAgICBzdHJ1Y3Qgd2F0Y2ggKndhdGNoLAotCQkgICAgICBjb25zdCBj
aGFyICpuYW1lKQotewotCS8qIERhdGEgdG8gc2VuZCAobm9kZVwwdG9rZW5c
MCkuICovCi0JdW5zaWduZWQgaW50IGxlbjsKLQljaGFyICpkYXRhOwotCi0J
bmFtZSA9IGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKTsKLQotCWxlbiA9
IHN0cmxlbihuYW1lKSArIDEgKyBzdHJsZW4od2F0Y2gtPnRva2VuKSArIDE7
Ci0JLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4gKi8K
LQlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCi0JCXJldHVybjsK
LQotCWRhdGEgPSB0YWxsb2NfYXJyYXkoY3R4LCBjaGFyLCBsZW4pOwotCWlm
ICghZGF0YSkKLQkJcmV0dXJuOwotCXN0cmNweShkYXRhLCBuYW1lKTsKLQlz
dHJjcHkoZGF0YSArIHN0cmxlbihuYW1lKSArIDEsIHdhdGNoLT50b2tlbik7
Ci0Jc2VuZF9yZXBseShjb25uLCBYU19XQVRDSF9FVkVOVCwgZGF0YSwgbGVu
KTsKLQl0YWxsb2NfZnJlZShkYXRhKTsKLX0KLQotLyoKICAqIENoZWNrIHBl
cm1pc3Npb25zIG9mIGEgc3BlY2lmaWMgd2F0Y2ggdG8gZmlyZToKICAqIEVp
dGhlciB0aGUgbm9kZSBpdHNlbGYgb3IgaXRzIHBhcmVudCBoYXZlIHRvIGJl
IHJlYWRhYmxlIGJ5IHRoZSBjb25uZWN0aW9uCiAgKiB0aGUgd2F0Y2ggaGFz
IGJlZW4gc2V0dXAgZm9yLiBJbiBjYXNlIGEgd2F0Y2ggZXZlbnQgaXMgY3Jl
YXRlZCBkdWUgdG8KQEAgLTE5MCwxMCArMTYxLDE0IEBAIHZvaWQgZmlyZV93
YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpj
dHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCWxpc3RfZm9yX2VhY2hfZW50cnko
d2F0Y2gsICZpLT53YXRjaGVzLCBsaXN0KSB7CiAJCQlpZiAoZXhhY3QpIHsK
IAkJCQlpZiAoc3RyZXEobmFtZSwgd2F0Y2gtPm5vZGUpKQotCQkJCQlhZGRf
ZXZlbnQoaSwgY3R4LCB3YXRjaCwgbmFtZSk7CisJCQkJCXNlbmRfZXZlbnQo
aSwKKwkJCQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKKwkJ
CQkJCSAgIHdhdGNoLT50b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChp
c19jaGlsZChuYW1lLCB3YXRjaC0+bm9kZSkpCi0JCQkJCWFkZF9ldmVudChp
LCBjdHgsIHdhdGNoLCBuYW1lKTsKKwkJCQkJc2VuZF9ldmVudChpLAorCQkJ
CQkJICAgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIG5hbWUpLAorCQkJCQkJICAg
d2F0Y2gtPnRva2VuKTsKIAkJCX0KIAkJfQogCX0KQEAgLTI5Miw3ICsyNjcs
NyBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAlzZW5kX2Fjayhjb25uLCBYU19X
QVRDSCk7CiAKIAkvKiBXZSBmaXJlIG9uY2UgdXAgZnJvbnQ6IHNpbXBsaWZp
ZXMgY2xpZW50cyBhbmQgcmVzdGFydC4gKi8KLQlhZGRfZXZlbnQoY29ubiwg
aW4sIHdhdGNoLCB3YXRjaC0+bm9kZSk7CisJc2VuZF9ldmVudChjb25uLCBn
ZXRfd2F0Y2hfcGF0aCh3YXRjaCwgd2F0Y2gtPm5vZGUpLCB3YXRjaC0+dG9r
ZW4pOwogCiAJcmV0dXJuIDA7CiB9Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA2YWYxNTUyNTI2MGRkZDhmNzhmNzUzMzhiMmNhOTdiNGY2ODE1ZGZi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBoZWxw
ZXJzIHRvIGZyZWUgc3RydWN0IGJ1ZmZlcmVkX2RhdGEKCkFkZCB0d28gaGVs
cGVycyBmb3IgZnJlZWluZyBzdHJ1Y3QgYnVmZmVyZWRfZGF0YTogZnJlZV9i
dWZmZXJlZF9kYXRhKCkKZm9yIGZyZWVpbmcgb25lIGluc3RhbmNlIGFuZCBj
b25uX2ZyZWVfYnVmZmVyZWRfZGF0YSgpIGZvciBmcmVlaW5nIGFsbAppbnN0
YW5jZXMgZm9yIGEgY29ubmVjdGlvbi4KClRoaXMgaXMgYXZvaWRpbmcgZHVw
bGljYXRlZCBjb2RlIGFuZCB3aWxsIGhlbHAgbGF0ZXIgd2hlbiBtb3JlIGFj
dGlvbnMKYXJlIG5lZWRlZCB3aGVuIGZyZWVpbmcgYSBzdHJ1Y3QgYnVmZmVy
ZWRfZGF0YS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggMDFkNGEyZTQ0
MGVjLi42NDk4YmY2MDM2NjYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMjExLDYgKzIxMSwyMSBAQCB2b2lkIHJlb3Blbl9s
b2codm9pZCkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRf
ZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAorCQkJICAgICAgIHN0
cnVjdCBjb25uZWN0aW9uICpjb25uKQoreworCWxpc3RfZGVsKCZvdXQtPmxp
c3QpOworCXRhbGxvY19mcmVlKG91dCk7Cit9CisKK3ZvaWQgY29ubl9mcmVl
X2J1ZmZlcmVkX2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJ
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKKworCXdoaWxlICgob3V0ID0g
bGlzdF90b3AoJmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSwgbGlzdCkpKQorCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
K30KKwogc3RhdGljIGJvb2wgd3JpdGVfbWVzc2FnZXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaW50IHJldDsKQEAgLTI1NCw4ICsyNjksNyBA
QCBzdGF0aWMgYm9vbCB3cml0ZV9tZXNzYWdlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXRyYWNlX2lvKGNvbm4sIG91dCwgMSk7CiAKLQlsaXN0
X2RlbCgmb3V0LT5saXN0KTsKLQl0YWxsb2NfZnJlZShvdXQpOworCWZyZWVf
YnVmZmVyZWRfZGF0YShvdXQsIGNvbm4pOwogCiAJcmV0dXJuIHRydWU7CiB9
CkBAIC0xNDcyLDE4ICsxNDg2LDEyIEBAIHN0YXRpYyBzdHJ1Y3QgewogICov
CiBzdGF0aWMgdm9pZCBpZ25vcmVfY29ubmVjdGlvbihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LCAq
dG1wOwotCiAJdHJhY2UoIkNPTk4gJXAgaWdub3JlZFxuIiwgY29ubik7CiAK
IAljb25uLT5pc19pZ25vcmVkID0gdHJ1ZTsKIAljb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcyhjb25uKTsKIAljb25uX2RlbGV0ZV9hbGxfdHJhbnNhY3Rpb25z
KGNvbm4pOwotCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKG91dCwgdG1w
LCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsKLQkJbGlzdF9kZWwoJm91dC0+
bGlzdCk7Ci0JCXRhbGxvY19mcmVlKG91dCk7Ci0JfQorCWNvbm5fZnJlZV9i
dWZmZXJlZF9kYXRhKGNvbm4pOwogCiAJdGFsbG9jX2ZyZWUoY29ubi0+aW4p
OwogCWNvbm4tPmluID0gTlVMTDsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oCmluZGV4IDM4ZDk3ZmEwODFhNi4uMGJhNWI3ODNkNGQxIDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKQEAgLTI3MCw2
ICsyNzAsOCBAQCBpbnQgcmVtZW1iZXJfc3RyaW5nKHN0cnVjdCBoYXNodGFi
bGUgKmhhc2gsIGNvbnN0IGNoYXIgKnN0cik7CiAKIHZvaWQgc2V0X3RkYl9r
ZXkoY29uc3QgY2hhciAqbmFtZSwgVERCX0RBVEEgKmtleSk7CiAKK3ZvaWQg
Y29ubl9mcmVlX2J1ZmZlcmVkX2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4pOworCiBjb25zdCBjaGFyICpkdW1wX3N0YXRlX2dsb2JhbChGSUxFICpm
cCk7CiBjb25zdCBjaGFyICpkdW1wX3N0YXRlX2J1ZmZlcmVkX2RhdGEoRklM
RSAqZnAsIGNvbnN0IHN0cnVjdCBjb25uZWN0aW9uICpjLAogCQkJCSAgICAg
Y29uc3Qgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKaW5kZXggM2Q0ZDA2NDlhMjQzLi43
MmE1Y2QzYjlhYWYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmMKQEAgLTQxNywxNSArNDE3LDEwIEBAIHN0YXRpYyBzdHJ1Y3Qg
ZG9tYWluICpmaW5kX2RvbWFpbl9ieV9kb21pZCh1bnNpZ25lZCBpbnQgZG9t
aWQpCiBzdGF0aWMgdm9pZCBkb21haW5fY29ubl9yZXNldChzdHJ1Y3QgZG9t
YWluICpkb21haW4pCiB7CiAJc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4gPSBk
b21haW4tPmNvbm47Ci0Jc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKIAog
CWNvbm5fZGVsZXRlX2FsbF93YXRjaGVzKGNvbm4pOwogCWNvbm5fZGVsZXRl
X2FsbF90cmFuc2FjdGlvbnMoY29ubik7Ci0KLQl3aGlsZSAoKG91dCA9IGxp
c3RfdG9wKCZjb25uLT5vdXRfbGlzdCwgc3RydWN0IGJ1ZmZlcmVkX2RhdGEs
IGxpc3QpKSkgewotCQlsaXN0X2RlbCgmb3V0LT5saXN0KTsKLQkJdGFsbG9j
X2ZyZWUob3V0KTsKLQl9CisJY29ubl9mcmVlX2J1ZmZlcmVkX2RhdGEoY29u
bik7CiAKIAl0YWxsb2NfZnJlZShjb25uLT5pbik7CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBjZGMzNzQ3Njc2YjFlNWVhNzI2NzI5Zjg4NjUwMzFiZjBmNzY0Nzc4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlZHVjZSBu
dW1iZXIgb2Ygd2F0Y2ggZXZlbnRzCgpXaGVuIHJlbW92aW5nIGEgd2F0Y2hl
ZCBub2RlIG91dHNpZGUgb2YgYSB0cmFuc2FjdGlvbiwgdHdvIHdhdGNoIGV2
ZW50cwphcmUgYmVpbmcgcHJvZHVjZWQgaW5zdGVhZCBvZiBqdXN0IGEgc2lu
Z2xlIG9uZS4KCldoZW4gZmluYWxpemluZyBhIHRyYW5zYWN0aW9uIHdhdGNo
IGV2ZW50cyBjYW4gYmUgZ2VuZXJhdGVkIGZvciBlYWNoCm5vZGUgd2hpY2gg
aXMgYmVpbmcgbW9kaWZpZWQsIGV2ZW4gaWYgb3V0c2lkZSBhIHRyYW5zYWN0
aW9uIHN1Y2gKbW9kaWZpY2F0aW9ucyBtaWdodCBub3QgaGF2ZSByZXN1bHRl
ZCBpbiBhIHdhdGNoIGV2ZW50LgoKVGhpcyBoYXBwZW5zIGUuZy46CgotIGZv
ciBub2RlcyB3aGljaCBhcmUgb25seSBtb2RpZmllZCBkdWUgdG8gYWRkZWQv
cmVtb3ZlZCBjaGlsZCBlbnRyaWVzCi0gZm9yIG5vZGVzIGJlaW5nIHJlbW92
ZWQgb3IgY3JlYXRlZCBpbXBsaWNpdGx5IChlLmcuIGNyZWF0aW9uIG9mIGEv
Yi9jCiAgaXMgaW1wbGljaXRseSBjcmVhdGluZyBhL2IsIHJlc3VsdGluZyBp
biB3YXRjaCBldmVudHMgZm9yIGEsIGEvYiBhbmQKICBhL2IvYyBpbnN0ZWFk
IG9mIGEvYi9jIG9ubHkpCgpBdm9pZCB0aGVzZSBhZGRpdGlvbmFsIHdhdGNo
IGV2ZW50cywgaW4gb3JkZXIgdG8gcmVkdWNlIHRoZSBuZWVkZWQKbWVtb3J5
IGluc2lkZSBYZW5zdG9yZSBmb3IgcXVldWVpbmcgdGhlbS4KClRoaXMgaXMg
YmVpbmcgYWNoaWV2ZWQgYnkgYWRkaW5nIGV2ZW50IGZsYWdzIHRvIHN0cnVj
dCBhY2Nlc3NlZF9ub2RlCnNwZWNpZnlpbmcgd2hldGhlciBhbiBldmVudCBz
aG91bGQgYmUgdHJpZ2dlcmVkLCBhbmQgd2hldGhlciBpdCBzaG91bGQKYmUg
YW4gZXhhY3QgbWF0Y2ggb2YgdGhlIG1vZGlmaWVkIHBhdGguIEJvdGggZmxh
Z3MgY2FuIGJlIHNldCBmcm9tCmZpcmVfd2F0Y2hlcygpIGluc3RlYWQgb2Yg
aW1wbHlpbmcgdGhlbSBvbmx5LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA2NDk4YmY2MDM2NjYuLjUxNTdhNzUyN2Y1OCAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMjYxLDcgKzEyNjEsNyBAQCBz
dGF0aWMgdm9pZCBkZWxldGVfY2hpbGQoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiB9CiAKIHN0YXRpYyBpbnQgZGVsZXRlX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKLQkJICAgICAgIHN0cnVj
dCBub2RlICpwYXJlbnQsIHN0cnVjdCBub2RlICpub2RlKQorCQkgICAgICAg
c3RydWN0IG5vZGUgKnBhcmVudCwgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wg
d2F0Y2hfZXhhY3QpCiB7CiAJY2hhciAqbmFtZTsKIApAQCAtMTI3Myw3ICsx
MjczLDcgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkJCSAgICAgICBub2Rl
LT5jaGlsZHJlbik7CiAJCWNoaWxkID0gbmFtZSA/IHJlYWRfbm9kZShjb25u
LCBub2RlLCBuYW1lKSA6IE5VTEw7CiAJCWlmIChjaGlsZCkgewotCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQpKQorCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQsIHRydWUpKQog
CQkJCXJldHVybiBlcnJubzsKIAkJfSBlbHNlIHsKIAkJCXRyYWNlKCJkZWxl
dGVfbm9kZTogRXJyb3IgZGVsZXRpbmcgY2hpbGQgJyVzLyVzJyFcbiIsCkBA
IC0xMjg1LDcgKzEyODUsMTIgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQl0
YWxsb2NfZnJlZShuYW1lKTsKIAl9CiAKLQlmaXJlX3dhdGNoZXMoY29ubiwg
Y3R4LCBub2RlLT5uYW1lLCBub2RlLCB0cnVlLCBOVUxMKTsKKwkvKgorCSAq
IEZpcmUgdGhlIHdhdGNoZXMgbm93LCB3aGVuIHdlIGNhbiBzdGlsbCBzZWUg
dGhlIG5vZGUgcGVybWlzc2lvbnMuCisJICogVGhpcyBmaW5lIGFzIHdlIGFy
ZSBzaW5nbGUgdGhyZWFkZWQgYW5kIHRoZSBuZXh0IHBvc3NpYmxlIHJlYWQg
d2lsbAorCSAqIGJlIGhhbmRsZWQgb25seSBhZnRlciB0aGUgbm9kZSBoYXMg
YmVlbiByZWFsbHkgcmVtb3ZlZC4KKwkgKi8KKwlmaXJlX3dhdGNoZXMoY29u
biwgY3R4LCBub2RlLT5uYW1lLCBub2RlLCB3YXRjaF9leGFjdCwgTlVMTCk7
CiAJZGVsZXRlX25vZGVfc2luZ2xlKGNvbm4sIG5vZGUpOwogCWRlbGV0ZV9j
aGlsZChjb25uLCBwYXJlbnQsIGJhc2VuYW1lKG5vZGUtPm5hbWUpKTsKIAl0
YWxsb2NfZnJlZShub2RlKTsKQEAgLTEzMTEsMTMgKzEzMTYsNyBAQCBzdGF0
aWMgaW50IF9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAkJcmV0dXJuIChlcnJubyA9
PSBFTk9NRU0pID8gRU5PTUVNIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9
IHBhcmVudDsKIAotCS8qCi0JICogRmlyZSB0aGUgd2F0Y2hlcyBub3csIHdo
ZW4gd2UgY2FuIHN0aWxsIHNlZSB0aGUgbm9kZSBwZXJtaXNzaW9ucy4KLQkg
KiBUaGlzIGZpbmUgYXMgd2UgYXJlIHNpbmdsZSB0aHJlYWRlZCBhbmQgdGhl
IG5leHQgcG9zc2libGUgcmVhZCB3aWxsCi0JICogYmUgaGFuZGxlZCBvbmx5
IGFmdGVyIHRoZSBub2RlIGhhcyBiZWVuIHJlYWxseSByZW1vdmVkLgotCSAq
LwotCWZpcmVfd2F0Y2hlcyhjb25uLCBjdHgsIG5hbWUsIG5vZGUsIGZhbHNl
LCBOVUxMKTsKLQlyZXR1cm4gZGVsZXRlX25vZGUoY29ubiwgY3R4LCBwYXJl
bnQsIG5vZGUpOworCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBh
cmVudCwgbm9kZSwgZmFsc2UpOwogfQogCiAKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKaW5kZXggZmFmNmM5MzBl
NDJhLi41NDQzMjkwN2ZjNzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCkBAIC0xMzAsNiArMTMwLDEwIEBA
IHN0cnVjdCBhY2Nlc3NlZF9ub2RlCiAKIAkvKiBUcmFuc2FjdGlvbiBub2Rl
IGluIGRhdGEgYmFzZT8gKi8KIAlib29sIHRhX25vZGU7CisKKwkvKiBXYXRj
aCBldmVudCBmbGFncy4gKi8KKwlib29sIGZpcmVfd2F0Y2g7CisJYm9vbCB3
YXRjaF9leGFjdDsKIH07CiAKIHN0cnVjdCBjaGFuZ2VkX2RvbWFpbgpAQCAt
MzI0LDYgKzMyOCwyOSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogfQogCiAvKgorICog
QSB3YXRjaCBldmVudCBzaG91bGQgYmUgZmlyZWQgZm9yIGEgbm9kZSBtb2Rp
ZmllZCBpbnNpZGUgYSB0cmFuc2FjdGlvbi4KKyAqIFNldCB0aGUgY29ycmVz
cG9uZGluZyBpbmZvcm1hdGlvbi4gQSBub24tZXhhY3QgZXZlbnQgaXMgcmVw
bGFjaW5nIGFuIGV4YWN0CisgKiBvbmUsIGJ1dCBub3QgdGhlIG90aGVyIHdh
eSByb3VuZC4KKyAqLwordm9pZCBxdWV1ZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBib29sIHdhdGNoX2V4
YWN0KQoreworCXN0cnVjdCBhY2Nlc3NlZF9ub2RlICppOworCisJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZShjb25uLT50cmFuc2FjdGlvbiwgbmFtZSk7CisJ
aWYgKCFpKSB7CisJCWNvbm4tPnRyYW5zYWN0aW9uLT5mYWlsID0gdHJ1ZTsK
KwkJcmV0dXJuOworCX0KKworCWlmICghaS0+ZmlyZV93YXRjaCkgeworCQlp
LT5maXJlX3dhdGNoID0gdHJ1ZTsKKwkJaS0+d2F0Y2hfZXhhY3QgPSB3YXRj
aF9leGFjdDsKKwl9IGVsc2UgaWYgKCF3YXRjaF9leGFjdCkgeworCQlpLT53
YXRjaF9leGFjdCA9IGZhbHNlOworCX0KK30KKworLyoKICAqIEZpbmFsaXpl
IHRyYW5zYWN0aW9uOgogICogV2FsayB0aHJvdWdoIGFjY2Vzc2VkIG5vZGVz
IGFuZCBjaGVjayBnZW5lcmF0aW9uIGFnYWluc3QgZ2xvYmFsIGRhdGEuCiAg
KiBJZiBhbGwgZW50cmllcyBtYXRjaCwgcmVhZCB0aGUgdHJhbnNhY3Rpb24g
ZW50cmllcyBhbmQgd3JpdGUgdGhlbSB3aXRob3V0CkBAIC0zNzcsMTUgKzQw
NCwxNSBAQCBzdGF0aWMgaW50IGZpbmFsaXplX3RyYW5zYWN0aW9uKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJf
Y3R4LCBrZXksIGRhdGEsCiAJCQkJCQlUREJfUkVQTEFDRSk7CiAJCQkJdGFs
bG9jX2ZyZWUoZGF0YS5kcHRyKTsKLQkJCQlpZiAocmV0KQotCQkJCQlnb3Rv
IGVycjsKLQkJCQlmaXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUs
IE5VTEwsIGZhbHNlLAotCQkJCQkgICAgIGktPnBlcm1zLnAgPyAmaS0+cGVy
bXMgOiBOVUxMKTsKIAkJCX0gZWxzZSB7Ci0JCQkJZmlyZV93YXRjaGVzKGNv
bm4sIHRyYW5zLCBpLT5ub2RlLCBOVUxMLCBmYWxzZSwKKwkJCQlyZXQgPSB0
ZGJfZGVsZXRlKHRkYl9jdHgsIGtleSk7CisJCQl9CisJCQlpZiAocmV0KQor
CQkJCWdvdG8gZXJyOworCQkJaWYgKGktPmZpcmVfd2F0Y2gpIHsKKwkJCQlm
aXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUsIE5VTEwsCisJCQkJ
CSAgICAgaS0+d2F0Y2hfZXhhY3QsCiAJCQkJCSAgICAgaS0+cGVybXMucCA/
ICZpLT5wZXJtcyA6IE5VTEwpOwotCQkJCWlmICh0ZGJfZGVsZXRlKHRkYl9j
dHgsIGtleSkpCi0JCQkJCWdvdG8gZXJyOwogCQkJfQogCQl9CiAKZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKaW5k
ZXggMTQwNjI3MzBlM2M5Li4wMDkzY2FjODA3ZTMgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCkBAIC00Miw2
ICs0Miw5IEBAIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlfZGVjKHN0cnVjdCB0
cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBkb21pZCk7CiBpbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAogICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKIAorLyogUXVldWUgd2F0Y2hl
cyBmb3IgYSBtb2RpZmllZCBub2RlLiAqLwordm9pZCBxdWV1ZV93YXRjaGVz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBi
b29sIHdhdGNoX2V4YWN0KTsKKwogLyogUHJlcGVuZCB0aGUgdHJhbnNhY3Rp
b24gdG8gbmFtZSBpZiBhcHByb3ByaWF0ZS4gKi8KIGludCB0cmFuc2FjdGlv
bl9wcmVwZW5kKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgVERCX0RBVEEgKmtl
eSk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0
Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCmluZGV4
IGExMTZmOTY3ZGM2Ni4uYmM2ZDgzMzAyOGEzIDEwMDY0NAotLS0gYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMjksNiArMjksNyBAQAogI2lu
Y2x1ZGUgInhlbnN0b3JlX2xpYi5oIgogI2luY2x1ZGUgInV0aWxzLmgiCiAj
aW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgorI2luY2x1ZGUgInhlbnN0
b3JlZF90cmFuc2FjdGlvbi5oIgogCiBleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CiAKQEAgLTE0Myw5ICsxNDQsMTEgQEAgdm9pZCBm
aXJlX3dhdGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwKIAlzdHJ1Y3QgY29ubmVjdGlv
biAqaTsKIAlzdHJ1Y3Qgd2F0Y2ggKndhdGNoOwogCi0JLyogRHVyaW5nIHRy
YW5zYWN0aW9ucywgZG9uJ3QgZmlyZSB3YXRjaGVzLiAqLwotCWlmIChjb25u
ICYmIGNvbm4tPnRyYW5zYWN0aW9uKQorCS8qIER1cmluZyB0cmFuc2FjdGlv
bnMsIGRvbid0IGZpcmUgd2F0Y2hlcywgYnV0IHF1ZXVlIHRoZW0uICovCisJ
aWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24pIHsKKwkJcXVldWVfd2F0
Y2hlcyhjb25uLCBuYW1lLCBleGFjdCk7CiAJCXJldHVybjsKKwl9CiAKIAkv
KiBDcmVhdGUgYW4gZXZlbnQgZm9yIGVhY2ggd2F0Y2guICovCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeShpLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSA0M2RkN2U0ZDM5NTJlNGYyMTAwZTZmMDRkZTJiOWZlYmIyYzVjNTBh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxldCB1bnJl
YWQgd2F0Y2ggZXZlbnRzIHRpbWUgb3V0CgpBIGZ1dHVyZSBtb2RpZmljYXRp
b24gd2lsbCBsaW1pdCB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzCmZvciBhIGRvbWFpbiwgd2hlcmUgIm91dHN0YW5kaW5nIiBtZWFucyB0
aGF0IHRoZSByZXNwb25zZSBvZiB0aGUKcmVxdWVzdCBvciBhbnkgcmVzdWx0
aW5nIHdhdGNoIGV2ZW50IGhhc24ndCBiZWVuIGNvbnN1bWVkIHlldC4KCklu
IG9yZGVyIHRvIGF2b2lkIGEgbWFsaWNpb3VzIGd1ZXN0IGJlaW5nIGNhcGFi
bGUgdG8gYmxvY2sgb3RoZXIgZ3Vlc3RzCmJ5IG5vdCByZWFkaW5nIHdhdGNo
IGV2ZW50cywgYWRkIGEgdGltZW91dCBmb3Igd2F0Y2ggZXZlbnRzLiBJbiBj
YXNlIGEKd2F0Y2ggZXZlbnQgaGFzbid0IGJlZW4gY29uc3VtZWQgYWZ0ZXIg
dGhpcyB0aW1lb3V0LCBpdCBpcyBiZWluZwpkZWxldGVkLiBTZXQgdGhlIGRl
ZmF1bHQgdGltZW91dCB0byAyMCBzZWNvbmRzIChhIHJhbmRvbSB2YWx1ZSBi
ZWluZwpub3QgdG9vIGhpZ2gpLgoKSW4gb3JkZXIgdG8gc3VwcG9ydCB0byBz
cGVjaWZ5IG90aGVyIHRpbWVvdXQgdmFsdWVzIGluIGZ1dHVyZSwgdXNlIGEK
Z2VuZXJpYyBjb21tYW5kIGxpbmUgb3B0aW9uIGZvciB0aGF0IHB1cnBvc2U6
CgotLXRpbWVvdXR8LXcgd2F0Y2gtZXZlbnQ9PHNlY29uZHM+CgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzExLgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggNTE1N2E3NTI3
ZjU4Li5lZTMzOTZmZWZhOTQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMTA4LDYgKzEwOCw4IEBAIGludCBxdW90YV9tYXhf
dHJhbnNhY3Rpb24gPSAxMDsKIGludCBxdW90YV9uYl9wZXJtc19wZXJfbm9k
ZSA9IDU7CiBpbnQgcXVvdGFfbWF4X3BhdGhfbGVuID0gWEVOU1RPUkVfUkVM
X1BBVEhfTUFYOwogCit1bnNpZ25lZCBpbnQgdGltZW91dF93YXRjaF9ldmVu
dF9tc2VjID0gMjAwMDA7CisKIHZvaWQgdHJhY2UoY29uc3QgY2hhciAqZm10
LCAuLi4pCiB7CiAJdmFfbGlzdCBhcmdsaXN0OwpAQCAtMjExLDE5ICsyMTMs
OTIgQEAgdm9pZCByZW9wZW5fbG9nKHZvaWQpCiAJfQogfQogCitzdGF0aWMg
dWludDY0X3QgZ2V0X25vd19tc2VjKHZvaWQpCit7CisJc3RydWN0IHRpbWVz
cGVjIG5vd190czsKKworCWlmIChjbG9ja19nZXR0aW1lKENMT0NLX01PTk9U
T05JQywgJm5vd190cykpCisJCWJhcmZfcGVycm9yKCJDb3VsZCBub3QgZmlu
ZCB0aW1lIChjbG9ja19nZXR0aW1lIGZhaWxlZCkiKTsKKworCXJldHVybiBu
b3dfdHMudHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAw
MDsKK30KKwogc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVj
dCBidWZmZXJlZF9kYXRhICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsK
KwogCWxpc3RfZGVsKCZvdXQtPmxpc3QpOworCisJLyoKKwkgKiBVcGRhdGUg
Y29ubi0+dGltZW91dF9tc2VjIHdpdGggdGhlIG5leHQgZm91bmQgdGltZW91
dCB2YWx1ZSBpbiB0aGUKKwkgKiBxdWV1ZWQgcGVuZGluZyByZXF1ZXN0cy4K
KwkgKi8KKwlpZiAob3V0LT50aW1lb3V0X21zZWMpIHsKKwkJY29ubi0+dGlt
ZW91dF9tc2VjID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShyZXEsICZj
b25uLT5vdXRfbGlzdCwgbGlzdCkgeworCQkJaWYgKHJlcS0+dGltZW91dF9t
c2VjKSB7CisJCQkJY29ubi0+dGltZW91dF9tc2VjID0gcmVxLT50aW1lb3V0
X21zZWM7CisJCQkJYnJlYWs7CisJCQl9CisJCX0KKwl9CisKIAl0YWxsb2Nf
ZnJlZShvdXQpOwogfQogCitzdGF0aWMgdm9pZCBjaGVja19ldmVudF90aW1l
b3V0KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCB1aW50NjRfdCBtc2VjcywK
KwkJCQlpbnQgKnB0aW1lb3V0KQoreworCXVpbnQ2NF90IGRlbHRhOworCXN0
cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsICp0bXA7CisKKwlpZiAoIWNvbm4t
PnRpbWVvdXRfbXNlYykKKwkJcmV0dXJuOworCisJZGVsdGEgPSBjb25uLT50
aW1lb3V0X21zZWMgLSBtc2VjczsKKwlpZiAoY29ubi0+dGltZW91dF9tc2Vj
IDw9IG1zZWNzKSB7CisJCWRlbHRhID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKG91dCwgdG1wLCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsK
KwkJCS8qCisJCQkgKiBPbmx5IGxvb2sgYXQgYnVmZmVycyB3aXRoIHRpbWVv
dXQgYW5kIG5vIGRhdGEKKwkJCSAqIGFscmVhZHkgd3JpdHRlbiB0byB0aGUg
cmluZy4KKwkJCSAqLworCQkJaWYgKG91dC0+dGltZW91dF9tc2VjICYmIG91
dC0+aW5oZHIgJiYgIW91dC0+dXNlZCkgeworCQkJCWlmIChvdXQtPnRpbWVv
dXRfbXNlYyA+IG1zZWNzKSB7CisJCQkJCWNvbm4tPnRpbWVvdXRfbXNlYyA9
IG91dC0+dGltZW91dF9tc2VjOworCQkJCQlkZWx0YSA9IGNvbm4tPnRpbWVv
dXRfbXNlYyAtIG1zZWNzOworCQkJCQlicmVhazsKKwkJCQl9CisKKwkJCQkv
KgorCQkJCSAqIEZyZWUgb3V0IHdpdGhvdXQgdXBkYXRpbmcgY29ubi0+dGlt
ZW91dF9tc2VjLAorCQkJCSAqIGFzIHRoZSB1cGRhdGUgaXMgZG9uZSBpbiB0
aGlzIGxvb3AgYWxyZWFkeS4KKwkJCQkgKi8KKwkJCQlvdXQtPnRpbWVvdXRf
bXNlYyA9IDA7CisJCQkJdHJhY2UoIndhdGNoIGV2ZW50IHBhdGggJXMgZm9y
IGRvbWFpbiAldSB0aW1lZCBvdXRcbiIsCisJCQkJICAgICAgb3V0LT5idWZm
ZXIsIGNvbm4tPmlkKTsKKwkJCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBj
b25uKTsKKwkJCX0KKwkJfQorCQlpZiAoIWRlbHRhKSB7CisJCQljb25uLT50
aW1lb3V0X21zZWMgPSAwOworCQkJcmV0dXJuOworCQl9CisJfQorCisJaWYg
KCpwdGltZW91dCA9PSAtMSB8fCAqcHRpbWVvdXQgPiBkZWx0YSkKKwkJKnB0
aW1lb3V0ID0gZGVsdGE7Cit9CisKIHZvaWQgY29ubl9mcmVlX2J1ZmZlcmVk
X2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7CiAJc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKm91dDsKIAogCXdoaWxlICgob3V0ID0gbGlzdF90b3Ao
JmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSwgbGlzdCkp
KQogCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsKKworCWNvbm4t
PnRpbWVvdXRfbXNlYyA9IDA7CiB9CiAKIHN0YXRpYyBib29sIHdyaXRlX21l
c3NhZ2VzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQpAQCAtMzgyLDYgKzQ1
Nyw3IEBAIHN0YXRpYyB2b2lkIGluaXRpYWxpemVfZmRzKGludCAqcF9zb2Nr
X3BvbGxmZF9pZHgsIGludCAqcHRpbWVvdXQpCiB7CiAJc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm47CiAJc3RydWN0IHdybF90aW1lc3RhbXB0IG5vdzsKKwl1
aW50NjRfdCBtc2VjczsKIAogCWlmIChmZHMpCiAJCW1lbXNldChmZHMsIDAs
IHNpemVvZihzdHJ1Y3QgcG9sbGZkKSAqIGN1cnJlbnRfYXJyYXlfc2l6ZSk7
CkBAIC00MDIsMTAgKzQ3OCwxMiBAQCBzdGF0aWMgdm9pZCBpbml0aWFsaXpl
X2ZkcyhpbnQgKnBfc29ja19wb2xsZmRfaWR4LCBpbnQgKnB0aW1lb3V0KQog
CiAJd3JsX2dldHRpbWVfbm93KCZub3cpOwogCXdybF9sb2dfcGVyaW9kaWMo
bm93KTsKKwltc2VjcyA9IGdldF9ub3dfbXNlYygpOwogCiAJbGlzdF9mb3Jf
ZWFjaF9lbnRyeShjb25uLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsKIAkJaWYg
KGNvbm4tPmRvbWFpbikgewogCQkJd3JsX2NoZWNrX3RpbWVvdXQoY29ubi0+
ZG9tYWluLCBub3csIHB0aW1lb3V0KTsKKwkJCWNoZWNrX2V2ZW50X3RpbWVv
dXQoY29ubiwgbXNlY3MsIHB0aW1lb3V0KTsKIAkJCWlmIChkb21haW5fY2Fu
X3JlYWQoY29ubikgfHwKIAkJCSAgICAoZG9tYWluX2Nhbl93cml0ZShjb25u
KSAmJgogCQkJICAgICAhbGlzdF9lbXB0eSgmY29ubi0+b3V0X2xpc3QpKSkK
QEAgLTc2MCw2ICs4MzgsNyBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAog
CQlyZXR1cm47CiAJYmRhdGEtPmluaGRyID0gdHJ1ZTsKIAliZGF0YS0+dXNl
ZCA9IDA7CisJYmRhdGEtPnRpbWVvdXRfbXNlYyA9IDA7CiAKIAlpZiAobGVu
IDw9IERFRkFVTFRfQlVGRkVSX1NJWkUpCiAJCWJkYXRhLT5idWZmZXIgPSBi
ZGF0YS0+ZGVmYXVsdF9idWZmZXI7CkBAIC04MTEsNiArODkwLDEyIEBAIHZv
aWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
Y2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pCiAJYmRhdGEtPmhkci5t
c2cudHlwZSA9IFhTX1dBVENIX0VWRU5UOwogCWJkYXRhLT5oZHIubXNnLmxl
biA9IGxlbjsKIAorCWlmICh0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMgJiYg
ZG9tYWluX2lzX3VucHJpdmlsZWdlZChjb25uKSkgeworCQliZGF0YS0+dGlt
ZW91dF9tc2VjID0gZ2V0X25vd19tc2VjKCkgKyB0aW1lb3V0X3dhdGNoX2V2
ZW50X21zZWM7CisJCWlmICghY29ubi0+dGltZW91dF9tc2VjKQorCQkJY29u
bi0+dGltZW91dF9tc2VjID0gYmRhdGEtPnRpbWVvdXRfbXNlYzsKKwl9CisK
IAkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAqLwogCWxpc3Rf
YWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xpc3QpOwogfQpA
QCAtMjA5OSw2ICsyMTg0LDkgQEAgc3RhdGljIHZvaWQgdXNhZ2Uodm9pZCkK
ICIgIC10LCAtLXRyYW5zYWN0aW9uIDxuYj4gIGxpbWl0IHRoZSBudW1iZXIg
b2YgdHJhbnNhY3Rpb24gYWxsb3dlZCBwZXIgZG9tYWluLFxuIgogIiAgLUEs
IC0tcGVybS1uYiA8bmI+ICAgICAgbGltaXQgdGhlIG51bWJlciBvZiBwZXJt
aXNzaW9ucyBwZXIgbm9kZSxcbiIKICIgIC1NLCAtLXBhdGgtbWF4IDxjaGFy
cz4gIGxpbWl0IHRoZSBhbGxvd2VkIFhlbnN0b3JlIG5vZGUgcGF0aCBsZW5n
dGgsXG4iCisiICAtdywgLS10aW1lb3V0IDx3aGF0Pj08c2Vjb25kcz4gICBz
ZXQgdGhlIHRpbWVvdXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+LFxuIgorIiAg
ICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZCB0aW1lb3V0IGNhbmRp
ZGF0ZXMgYXJlOlxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0
Y2gtZXZlbnQ6IHRpbWUgYSB3YXRjaC1ldmVudCBpcyBrZXB0IHBlbmRpbmdc
biIKICIgIC1SLCAtLW5vLXJlY292ZXJ5ICAgICAgIHRvIHJlcXVlc3QgdGhh
dCBubyByZWNvdmVyeSBzaG91bGQgYmUgYXR0ZW1wdGVkIHdoZW5cbiIKICIg
ICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBzdG9yZSBpcyBjb3JydXB0
ZWQgKGRlYnVnIG9ubHkpLFxuIgogIiAgLUksIC0taW50ZXJuYWwtZGIgICAg
ICAgc3RvcmUgZGF0YWJhc2UgaW4gbWVtb3J5LCBub3Qgb24gZGlza1xuIgpA
QCAtMjEyMSw2ICsyMjA5LDcgQEAgc3RhdGljIHN0cnVjdCBvcHRpb24gb3B0
aW9uc1tdID0gewogCXsgInRyYW5zYWN0aW9uIiwgMSwgTlVMTCwgJ3QnIH0s
CiAJeyAicGVybS1uYiIsIDEsIE5VTEwsICdBJyB9LAogCXsgInBhdGgtbWF4
IiwgMSwgTlVMTCwgJ00nIH0sCisJeyAidGltZW91dCIsIDEsIE5VTEwsICd3
JyB9LAogCXsgIm5vLXJlY292ZXJ5IiwgMCwgTlVMTCwgJ1InIH0sCiAJeyAi
aW50ZXJuYWwtZGIiLCAwLCBOVUxMLCAnSScgfSwKIAl7ICJ2ZXJib3NlIiwg
MCwgTlVMTCwgJ1YnIH0sCkBAIC0yMTM1LDYgKzIyMjQsMzkgQEAgaW50IGRv
bTBfZG9taWQgPSAwOwogaW50IGRvbTBfZXZlbnQgPSAwOwogaW50IHByaXZf
ZG9taWQgPSAwOwogCitzdGF0aWMgaW50IGdldF9vcHR2YWxfaW50KGNvbnN0
IGNoYXIgKmFyZykKK3sKKwljaGFyICplbmQ7CisJbG9uZyB2YWw7CisKKwl2
YWwgPSBzdHJ0b2woYXJnLCAmZW5kLCAxMCk7CisJaWYgKCEqYXJnIHx8ICpl
bmQgfHwgdmFsIDwgMCB8fCB2YWwgPiBJTlRfTUFYKQorCQliYXJmKCJpbnZh
bGlkIHBhcmFtZXRlciB2YWx1ZSBcIiVzXCJcbiIsIGFyZyk7CisKKwlyZXR1
cm4gdmFsOworfQorCitzdGF0aWMgYm9vbCB3aGF0X21hdGNoZXMoY29uc3Qg
Y2hhciAqYXJnLCBjb25zdCBjaGFyICp3aGF0KQoreworCXVuc2lnbmVkIGlu
dCB3aGF0X2xlbiA9IHN0cmxlbih3aGF0KTsKKworCXJldHVybiAhc3RybmNt
cChhcmcsIHdoYXQsIHdoYXRfbGVuKSAmJiBhcmdbd2hhdF9sZW5dID09ICc9
JzsKK30KKworc3RhdGljIHZvaWQgc2V0X3RpbWVvdXQoY29uc3QgY2hhciAq
YXJnKQoreworCWNvbnN0IGNoYXIgKmVxID0gc3RyY2hyKGFyZywgJz0nKTsK
KwlpbnQgdmFsOworCisJaWYgKCFlcSkKKwkJYmFyZigicXVvdGFzIG11c3Qg
YmUgc3BlY2lmaWVkIHZpYSA8d2hhdD49PHNlY29uZHM+XG4iKTsKKwl2YWwg
PSBnZXRfb3B0dmFsX2ludChlcSArIDEpOworCWlmICh3aGF0X21hdGNoZXMo
YXJnLCAid2F0Y2gtZXZlbnQiKSkKKwkJdGltZW91dF93YXRjaF9ldmVudF9t
c2VjID0gdmFsICogMTAwMDsKKwllbHNlCisJCWJhcmYoInVua25vd24gdGlt
ZW91dCBcIiVzXCJcbiIsIGFyZyk7Cit9CisKIGludCBtYWluKGludCBhcmdj
LCBjaGFyICphcmd2W10pCiB7CiAJaW50IG9wdDsKQEAgLTIxNDksNyArMjI3
MSw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAJb3Jp
Z19hcmdjID0gYXJnYzsKIAlvcmlnX2FyZ3YgPSBhcmd2OwogCi0Jd2hpbGUg
KChvcHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6
QTpNOlQ6UlZXOlUiLCBvcHRpb25zLAorCXdoaWxlICgob3B0ID0gZ2V0b3B0
X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6TTpUOlJWVzp3OlUi
LCBvcHRpb25zLAogCQkJCSAgTlVMTCkpICE9IC0xKSB7CiAJCXN3aXRjaCAo
b3B0KSB7CiAJCWNhc2UgJ0QnOgpAQCAtMjE5OCw2ICsyMzIwLDkgQEAgaW50
IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCXF1b3RhX21heF9w
YXRoX2xlbiA9IG1pbihYRU5TVE9SRV9SRUxfUEFUSF9NQVgsCiAJCQkJCQkg
cXVvdGFfbWF4X3BhdGhfbGVuKTsKIAkJCWJyZWFrOworCQljYXNlICd3JzoK
KwkJCXNldF90aW1lb3V0KG9wdGFyZyk7CisJCQlicmVhazsKIAkJY2FzZSAn
ZSc6CiAJCQlkb20wX2V2ZW50ID0gc3RydG9sKG9wdGFyZywgTlVMTCwgMTAp
OwogCQkJYnJlYWs7CkBAIC0yNjQyLDYgKzI3NjcsMTIgQEAgc3RhdGljIHZv
aWQgYWRkX2J1ZmZlcmVkX2RhdGEoc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJk
YXRhLAogCQliYXJmKCJlcnJvciByZXN0b3JpbmcgYnVmZmVyZWQgZGF0YSIp
OwogCiAJbWVtY3B5KGJkYXRhLT5idWZmZXIsIGRhdGEsIGxlbik7CisJaWYg
KGJkYXRhLT5oZHIubXNnLnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQgJiYgdGlt
ZW91dF93YXRjaF9ldmVudF9tc2VjICYmCisJICAgIGRvbWFpbl9pc191bnBy
aXZpbGVnZWQoY29ubikpIHsKKwkJYmRhdGEtPnRpbWVvdXRfbXNlYyA9IGdl
dF9ub3dfbXNlYygpICsgdGltZW91dF93YXRjaF9ldmVudF9tc2VjOworCQlp
ZiAoIWNvbm4tPnRpbWVvdXRfbXNlYykKKwkJCWNvbm4tPnRpbWVvdXRfbXNl
YyA9IGJkYXRhLT50aW1lb3V0X21zZWM7CisJfQogCiAJLyogUXVldWUgZm9y
IGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAlsaXN0X2FkZF90YWlsKCZiZGF0
YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmggYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5oCmluZGV4IDBiYTViNzgzZDRkMS4uMmRiNTc3OTI4
ZmM2IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29y
ZS5oCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKQEAg
LTI3LDYgKzI3LDcgQEAKICNpbmNsdWRlIDxkaXJlbnQuaD4KICNpbmNsdWRl
IDxzdGRib29sLmg+CiAjaW5jbHVkZSA8c3RkaW50Lmg+CisjaW5jbHVkZSA8
dGltZS5oPgogI2luY2x1ZGUgPGVycm5vLmg+CiAKICNpbmNsdWRlICJ4ZW5z
dG9yZV9saWIuaCIKQEAgLTY3LDYgKzY4LDggQEAgc3RydWN0IGJ1ZmZlcmVk
X2RhdGEKIAkJY2hhciByYXdbc2l6ZW9mKHN0cnVjdCB4c2Rfc29ja21zZyld
OwogCX0gaGRyOwogCisJdWludDY0X3QgdGltZW91dF9tc2VjOworCiAJLyog
VGhlIGFjdHVhbCBkYXRhLiAqLwogCWNoYXIgKmJ1ZmZlcjsKIAljaGFyIGRl
ZmF1bHRfYnVmZmVyW0RFRkFVTFRfQlVGRkVSX1NJWkVdOwpAQCAtMTEwLDYg
KzExMyw3IEBAIHN0cnVjdCBjb25uZWN0aW9uCiAKIAkvKiBCdWZmZXJlZCBv
dXRwdXQgZGF0YSAqLwogCXN0cnVjdCBsaXN0X2hlYWQgb3V0X2xpc3Q7CisJ
dWludDY0X3QgdGltZW91dF9tc2VjOwogCiAJLyogVHJhbnNhY3Rpb24gY29u
dGV4dCBmb3IgY3VycmVudCByZXF1ZXN0IChOVUxMIGlmIG5vbmUpLiAqLwog
CXN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnNhY3Rpb247CkBAIC0yMzcsNiAr
MjQxLDggQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0ZXJuIGludCBw
cml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRyeV9wZXJfZG9t
YWluOwogCitleHRlcm4gdW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZl
bnRfbXNlYzsKKwogLyogTWFwIHRoZSBrZXJuZWwncyB4ZW5zdG9yZSBwYWdl
LiAqLwogdm9pZCAqeGVuYnVzX21hcCh2b2lkKTsKIHZvaWQgdW5tYXBfeGVu
YnVzKHZvaWQgKmludGVyZmFjZSk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSA0YmZjOGIyY2YyNWYyYzQxOGRjMmM4YTExY2FiNmNkMTJkNDI4YjYx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG91
dHN0YW5kaW5nIHJlcXVlc3RzCgpBZGQgYW5vdGhlciBxdW90YSBmb3IgbGlt
aXRpbmcgdGhlIG51bWJlciBvZiBvdXRzdGFuZGluZyByZXF1ZXN0cyBvZiBh
Cmd1ZXN0LiBBcyB0aGUgd2F5IHRvIHNwZWNpZnkgcXVvdGFzIG9uIHRoZSBj
b21tYW5kIGxpbmUgaXMgYmVjb21pbmcKcmF0aGVyIG5hc3R5LCBzd2l0Y2gg
dG8gYSBuZXcgc2NoZW1lIHVzaW5nIFstLXF1b3RhfC1RXSA8d2hhdD49PHZh
bD4KYWxsb3dpbmcgdG8gYWRkIG1vcmUgcXVvdGFzIGluIGZ1dHVyZSBlYXNp
bHkuCgpTZXQgdGhlIGRlZmF1bHQgdmFsdWUgdG8gMjAgKGJhc2ljYWxseSBh
IHJhbmRvbSB2YWx1ZSBub3Qgc2VlbWluZyB0bwpiZSB0b28gaGlnaCBvciB0
b28gbG93KS4KCkEgcmVxdWVzdCBpcyBzYWlkIHRvIGJlIG91dHN0YW5kaW5n
IGlmIGFueSBtZXNzYWdlIGdlbmVyYXRlZCBieSB0aGlzCnJlcXVlc3QgKHRo
ZSBkaXJlY3QgcmVzcG9uc2UgcGx1cyBwb3RlbnRpYWwgd2F0Y2ggZXZlbnRz
KSBpcyBub3QgeWV0CmNvbXBsZXRlbHkgc3RvcmVkIGludG8gYSByaW5nIGJ1
ZmZlci4gVGhlIGluaXRpYWwgd2F0Y2ggZXZlbnQgc2VudCBhcwphIHJlc3Vs
dCBvZiByZWdpc3RlcmluZyBhIHdhdGNoIGlzIGFuIGV4Y2VwdGlvbi4KCk5v
dGUgdGhhdCBhY3Jvc3MgYSBsaXZlIHVwZGF0ZSB0aGUgcmVsYXRpb24gdG8g
YnVmZmVyZWQgd2F0Y2ggZXZlbnRzCmZvciBvdGhlciBkb21haW5zIGlzIGxv
c3QuCgpVc2UgdGFsbG9jX3plcm8oKSBmb3IgYWxsb2NhdGluZyB0aGUgZG9t
YWluIHN0cnVjdHVyZSBpbiBvcmRlciB0byBoYXZlCmFsbCBwZXItZG9tYWlu
IHF1b3RhIHplcm9lZCBpbml0aWFsbHkuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTMyNiAvIENWRS0yMDIyLTQyMzEyLgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggZWUzMzk2ZmVmYTk0Li5kODcxZjIxN2Fm
OWMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MTA3LDYgKzEwNyw3IEBAIGludCBxdW90YV9tYXhfZW50cnlfc2l6ZSA9IDIw
NDg7IC8qIDJLICovCiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uID0gMTA7
CiBpbnQgcXVvdGFfbmJfcGVybXNfcGVyX25vZGUgPSA1OwogaW50IHF1b3Rh
X21heF9wYXRoX2xlbiA9IFhFTlNUT1JFX1JFTF9QQVRIX01BWDsKK2ludCBx
dW90YV9yZXFfb3V0c3RhbmRpbmcgPSAyMDsKIAogdW5zaWduZWQgaW50IHRp
bWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIwMDAwOwogCkBAIC0yMjMsMTIg
KzIyNCwyNCBAQCBzdGF0aWMgdWludDY0X3QgZ2V0X25vd19tc2VjKHZvaWQp
CiAJcmV0dXJuIG5vd190cy50dl9zZWMgKiAxMDAwICsgbm93X3RzLnR2X25z
ZWMgLyAxMDAwMDAwOwogfQogCisvKgorICogUmVtb3ZlIGEgc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgZnJvbSB0aGUgbGlzdCBvZiBvdXRnb2luZyBkYXRhLgor
ICogQSBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSByZWxhdGVkIHRvIGEgcmVxdWVz
dCBoYXZpbmcgY2F1c2VkIHdhdGNoIGV2ZW50cyB0byBiZQorICogc2VudCBp
cyBrZXB0IHVudGlsIGFsbCB0aG9zZSBldmVudHMgaGF2ZSBiZWVuIHdyaXR0
ZW4gb3V0LgorICogRWFjaCB3YXRjaCBldmVudCBpcyByZWZlcmVuY2luZyB0
aGUgcmVsYXRlZCByZXF1ZXN0IHZpYSBwZW5kLnJlcSwgd2hpbGUgdGhlCisg
KiBudW1iZXIgb2Ygd2F0Y2ggZXZlbnRzIGNhdXNlZCBieSBhIHJlcXVlc3Qg
aXMga2VwdCBpbiBwZW5kLnJlZi5ldmVudF9jbnQKKyAqICh0aG9zZSB0d28g
Y2FzZXMgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZSwgc28gdGhlIHR3byBmaWVs
ZHMgY2FuIHNoYXJlIG1lbW9yeQorICogdmlhIGEgdW5pb24pLgorICogVGhl
IHN0cnVjdCBidWZmZXJlZF9kYXRhIGlzIGZyZWVkIG9ubHkgaWYgbm8gcmVs
YXRlZCB3YXRjaCBldmVudCBpcworICogcmVmZXJlbmNpbmcgaXQuIFRoZSBy
ZWxhdGVkIHJldHVybiBkYXRhIGNhbiBiZSBmcmVlZCByaWdodCBhd2F5Lgor
ICovCiBzdGF0aWMgdm9pZCBmcmVlX2J1ZmZlcmVkX2RhdGEoc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKm91dCwKIAkJCSAgICAgICBzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIHsKIAlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCiAJ
bGlzdF9kZWwoJm91dC0+bGlzdCk7CisJb3V0LT5vbl9vdXRfbGlzdCA9IGZh
bHNlOwogCiAJLyoKIAkgKiBVcGRhdGUgY29ubi0+dGltZW91dF9tc2VjIHdp
dGggdGhlIG5leHQgZm91bmQgdGltZW91dCB2YWx1ZSBpbiB0aGUKQEAgLTI0
NCw2ICsyNTcsMzAgQEAgc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRh
KHN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsCiAJCX0KIAl9CiAKKwlpZiAo
b3V0LT5oZHIubXNnLnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKKwkJcmVx
ID0gb3V0LT5wZW5kLnJlcTsKKwkJaWYgKHJlcSkgeworCQkJcmVxLT5wZW5k
LnJlZi5ldmVudF9jbnQtLTsKKwkJCWlmICghcmVxLT5wZW5kLnJlZi5ldmVu
dF9jbnQgJiYgIXJlcS0+b25fb3V0X2xpc3QpIHsKKwkJCQlpZiAocmVxLT5v
bl9yZWZfbGlzdCkgeworCQkJCQlkb21haW5fb3V0c3RhbmRpbmdfZG9taWRf
ZGVjKAorCQkJCQkJcmVxLT5wZW5kLnJlZi5kb21pZCk7CisJCQkJCWxpc3Rf
ZGVsKCZyZXEtPmxpc3QpOworCQkJCX0KKwkJCQl0YWxsb2NfZnJlZShyZXEp
OworCQkJfQorCQl9CisJfSBlbHNlIGlmIChvdXQtPnBlbmQucmVmLmV2ZW50
X2NudCkgeworCQkvKiBIYW5nIG91dCBvZmYgZnJvbSBjb25uLiAqLworCQl0
YWxsb2Nfc3RlYWwoTlVMTCwgb3V0KTsKKwkJaWYgKG91dC0+YnVmZmVyICE9
IG91dC0+ZGVmYXVsdF9idWZmZXIpCisJCQl0YWxsb2NfZnJlZShvdXQtPmJ1
ZmZlcik7CisJCWxpc3RfYWRkKCZvdXQtPmxpc3QsICZjb25uLT5yZWZfbGlz
dCk7CisJCW91dC0+b25fcmVmX2xpc3QgPSB0cnVlOworCQlyZXR1cm47CisJ
fSBlbHNlCisJCWRvbWFpbl9vdXRzdGFuZGluZ19kZWMoY29ubik7CisKIAl0
YWxsb2NfZnJlZShvdXQpOwogfQogCkBAIC0zOTksNiArNDM2LDcgQEAgaW50
IGRlbGF5X3JlcXVlc3Qoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVj
dCBidWZmZXJlZF9kYXRhICppbiwKIHN0YXRpYyBpbnQgZGVzdHJveV9jb25u
KHZvaWQgKl9jb25uKQogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25uID0g
X2Nvbm47CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKIAogCS8qIEZs
dXNoIG91dGdvaW5nIGlmIHBvc3NpYmxlLCBidXQgZG9uJ3QgYmxvY2suICov
CiAJaWYgKCFjb25uLT5kb21haW4pIHsKQEAgLTQxMiw2ICs0NTAsMTEgQEAg
c3RhdGljIGludCBkZXN0cm95X2Nvbm4odm9pZCAqX2Nvbm4pCiAJCQkJYnJl
YWs7CiAJCWNsb3NlKGNvbm4tPmZkKTsKIAl9CisKKwljb25uX2ZyZWVfYnVm
ZmVyZWRfZGF0YShjb25uKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHJlcSwg
JmNvbm4tPnJlZl9saXN0LCBsaXN0KQorCQlyZXEtPm9uX3JlZl9saXN0ID0g
ZmFsc2U7CisKICAgICAgICAgaWYgKGNvbm4tPnRhcmdldCkKICAgICAgICAg
ICAgICAgICB0YWxsb2NfdW5saW5rKGNvbm4sIGNvbm4tPnRhcmdldCk7CiAJ
bGlzdF9kZWwoJmNvbm4tPmxpc3QpOwpAQCAtODU5LDYgKzkwMiw4IEBAIHZv
aWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4
c2Rfc29ja21zZ190eXBlIHR5cGUsCiAKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIg
dHJhbnNtaXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0
LCAmY29ubi0+b3V0X2xpc3QpOworCWJkYXRhLT5vbl9vdXRfbGlzdCA9IHRy
dWU7CisJZG9tYWluX291dHN0YW5kaW5nX2luYyhjb25uKTsKIH0KIAogLyoK
QEAgLTg2Niw3ICs5MTEsOCBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAog
ICogQXMgdGhpcyBpcyBub3QgZGlyZWN0bHkgcmVsYXRlZCB0byB0aGUgY3Vy
cmVudCBjb21tYW5kLCBlcnJvcnMgY2FuJ3QgYmUKICAqIHJlcG9ydGVkLgog
ICovCi12b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKQordm9pZCBz
ZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLAorCQljb25zdCBjaGFyICpwYXRoLCBjb25zdCBj
aGFyICp0b2tlbikKIHsKIAlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7
CiAJdW5zaWduZWQgaW50IGxlbjsKQEAgLTg5Niw4ICs5NDIsMTMgQEAgdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBj
aGFyICpwYXRoLCBjb25zdCBjaGFyICp0b2tlbikKIAkJCWNvbm4tPnRpbWVv
dXRfbXNlYyA9IGJkYXRhLT50aW1lb3V0X21zZWM7CiAJfQogCisJYmRhdGEt
PnBlbmQucmVxID0gcmVxOworCWlmIChyZXEpCisJCXJlcS0+cGVuZC5yZWYu
ZXZlbnRfY250Kys7CisKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNz
aW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+
b3V0X2xpc3QpOworCWJkYXRhLT5vbl9vdXRfbGlzdCA9IHRydWU7CiB9CiAK
IC8qIFNvbWUgcm91dGluZXMgKHdyaXRlLCBta2RpciwgZXRjKSBqdXN0IG5l
ZWQgYSBub24tZXJyb3IgcmV0dXJuICovCkBAIC0xNjU4LDYgKzE3MDksNyBA
QCBzdGF0aWMgdm9pZCBoYW5kbGVfaW5wdXQoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pCiAJCQlyZXR1cm47CiAJfQogCWluID0gY29ubi0+aW47CisJaW4t
PnBlbmQucmVmLmRvbWlkID0gY29ubi0+aWQ7CiAKIAkvKiBOb3QgZmluaXNo
ZWQgaGVhZGVyIHlldD8gKi8KIAlpZiAoaW4tPmluaGRyKSB7CkBAIC0xNzI3
LDYgKzE3NzksNyBAQCBzdHJ1Y3QgY29ubmVjdGlvbiAqbmV3X2Nvbm5lY3Rp
b24oY29ubndyaXRlZm5fdCAqd3JpdGUsIGNvbm5yZWFkZm5fdCAqcmVhZCkK
IAluZXctPmlzX2lnbm9yZWQgPSBmYWxzZTsKIAluZXctPnRyYW5zYWN0aW9u
X3N0YXJ0ZWQgPSAwOwogCUlOSVRfTElTVF9IRUFEKCZuZXctPm91dF9saXN0
KTsKKwlJTklUX0xJU1RfSEVBRCgmbmV3LT5yZWZfbGlzdCk7CiAJSU5JVF9M
SVNUX0hFQUQoJm5ldy0+d2F0Y2hlcyk7CiAJSU5JVF9MSVNUX0hFQUQoJm5l
dy0+dHJhbnNhY3Rpb25fbGlzdCk7CiAJSU5JVF9MSVNUX0hFQUQoJm5ldy0+
ZGVsYXllZCk7CkBAIC0yMTg0LDYgKzIyMzcsOSBAQCBzdGF0aWMgdm9pZCB1
c2FnZSh2b2lkKQogIiAgLXQsIC0tdHJhbnNhY3Rpb24gPG5iPiAgbGltaXQg
dGhlIG51bWJlciBvZiB0cmFuc2FjdGlvbiBhbGxvd2VkIHBlciBkb21haW4s
XG4iCiAiICAtQSwgLS1wZXJtLW5iIDxuYj4gICAgICBsaW1pdCB0aGUgbnVt
YmVyIG9mIHBlcm1pc3Npb25zIHBlciBub2RlLFxuIgogIiAgLU0sIC0tcGF0
aC1tYXggPGNoYXJzPiAgbGltaXQgdGhlIGFsbG93ZWQgWGVuc3RvcmUgbm9k
ZSBwYXRoIGxlbmd0aCxcbiIKKyIgIC1RLCAtLXF1b3RhIDx3aGF0Pj08bmI+
IHNldCB0aGUgcXVvdGEgPHdoYXQ+IHRvIHRoZSB2YWx1ZSA8bmI+LCBhbGxv
d2VkXG4iCisiICAgICAgICAgICAgICAgICAgICAgICAgICBxdW90YXMgYXJl
OlxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0c3RhbmRpbmc6
IG51bWJlciBvZiBvdXRzdGFuZGluZyByZXF1ZXN0c1xuIgogIiAgLXcsIC0t
dGltZW91dCA8d2hhdD49PHNlY29uZHM+ICAgc2V0IHRoZSB0aW1lb3V0IGlu
IHNlY29uZHMgZm9yIDx3aGF0PixcbiIKICIgICAgICAgICAgICAgICAgICAg
ICAgICAgIGFsbG93ZWQgdGltZW91dCBjYW5kaWRhdGVzIGFyZTpcbiIKICIg
ICAgICAgICAgICAgICAgICAgICAgICAgIHdhdGNoLWV2ZW50OiB0aW1lIGEg
d2F0Y2gtZXZlbnQgaXMga2VwdCBwZW5kaW5nXG4iCkBAIC0yMjA5LDYgKzIy
NjUsNyBAQCBzdGF0aWMgc3RydWN0IG9wdGlvbiBvcHRpb25zW10gPSB7CiAJ
eyAidHJhbnNhY3Rpb24iLCAxLCBOVUxMLCAndCcgfSwKIAl7ICJwZXJtLW5i
IiwgMSwgTlVMTCwgJ0EnIH0sCiAJeyAicGF0aC1tYXgiLCAxLCBOVUxMLCAn
TScgfSwKKwl7ICJxdW90YSIsIDEsIE5VTEwsICdRJyB9LAogCXsgInRpbWVv
dXQiLCAxLCBOVUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5V
TEwsICdSJyB9LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0s
CkBAIC0yMjU3LDYgKzIzMTQsMjAgQEAgc3RhdGljIHZvaWQgc2V0X3RpbWVv
dXQoY29uc3QgY2hhciAqYXJnKQogCQliYXJmKCJ1bmtub3duIHRpbWVvdXQg
XCIlc1wiXG4iLCBhcmcpOwogfQogCitzdGF0aWMgdm9pZCBzZXRfcXVvdGEo
Y29uc3QgY2hhciAqYXJnKQoreworCWNvbnN0IGNoYXIgKmVxID0gc3RyY2hy
KGFyZywgJz0nKTsKKwlpbnQgdmFsOworCisJaWYgKCFlcSkKKwkJYmFyZigi
cXVvdGFzIG11c3QgYmUgc3BlY2lmaWVkIHZpYSA8d2hhdD49PG5iPlxuIik7
CisJdmFsID0gZ2V0X29wdHZhbF9pbnQoZXEgKyAxKTsKKwlpZiAod2hhdF9t
YXRjaGVzKGFyZywgIm91dHN0YW5kaW5nIikpCisJCXF1b3RhX3JlcV9vdXRz
dGFuZGluZyA9IHZhbDsKKwllbHNlCisJCWJhcmYoInVua25vd24gcXVvdGEg
XCIlc1wiXG4iLCBhcmcpOworfQorCiBpbnQgbWFpbihpbnQgYXJnYywgY2hh
ciAqYXJndltdKQogewogCWludCBvcHQ7CkBAIC0yMjcxLDggKzIzNDIsOCBA
QCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogCW9yaWdfYXJn
YyA9IGFyZ2M7CiAJb3JpZ19hcmd2ID0gYXJndjsKIAotCXdoaWxlICgob3B0
ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6TTpU
OlJWVzp3OlUiLCBvcHRpb25zLAotCQkJCSAgTlVMTCkpICE9IC0xKSB7CisJ
d2hpbGUgKChvcHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpI
TlBTOnQ6QTpNOlE6VDpSVlc6dzpVIiwKKwkJCQkgIG9wdGlvbnMsIE5VTEwp
KSAhPSAtMSkgewogCQlzd2l0Y2ggKG9wdCkgewogCQljYXNlICdEJzoKIAkJ
CW5vX2RvbWFpbl9pbml0ID0gdHJ1ZTsKQEAgLTIzMjAsNiArMjM5MSw5IEBA
IGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAJCQlxdW90YV9t
YXhfcGF0aF9sZW4gPSBtaW4oWEVOU1RPUkVfUkVMX1BBVEhfTUFYLAogCQkJ
CQkJIHF1b3RhX21heF9wYXRoX2xlbik7CiAJCQlicmVhazsKKwkJY2FzZSAn
USc6CisJCQlzZXRfcXVvdGEob3B0YXJnKTsKKwkJCWJyZWFrOwogCQljYXNl
ICd3JzoKIAkJCXNldF90aW1lb3V0KG9wdGFyZyk7CiAJCQlicmVhazsKQEAg
LTI3NzYsNiArMjg1MCwxNCBAQCBzdGF0aWMgdm9pZCBhZGRfYnVmZmVyZWRf
ZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGEsCiAKIAkvKiBRdWV1
ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwo
JmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xpc3QpOworCWJkYXRhLT5vbl9v
dXRfbGlzdCA9IHRydWU7CisJLyoKKwkgKiBXYXRjaCBldmVudHMgYXJlIG5l
dmVyICJvdXRzdGFuZGluZyIsIGJ1dCB0aGUgcmVxdWVzdCBjYXVzaW5nIHRo
ZW0KKwkgKiBhcmUgaW5zdGVhZCBrZXB0ICJvdXRzdGFuZGluZyIgdW50aWwg
YWxsIHdhdGNoIGV2ZW50cyBjYXVzZWQgYnkgdGhhdAorCSAqIHJlcXVlc3Qg
aGF2ZSBiZWVuIGRlbGl2ZXJlZC4KKwkgKi8KKwlpZiAoYmRhdGEtPmhkci5t
c2cudHlwZSAhPSBYU19XQVRDSF9FVkVOVCkKKwkJZG9tYWluX291dHN0YW5k
aW5nX2luYyhjb25uKTsKIH0KIAogdm9pZCByZWFkX3N0YXRlX2J1ZmZlcmVk
X2RhdGEoY29uc3Qgdm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCmluZGV4IDJk
YjU3NzkyOGZjNi4uZmNiMjczOTlmMTE2IDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmgKQEAgLTU2LDYgKzU2LDggQEAgc3RydWN0IHhz
X3N0YXRlX2Nvbm5lY3Rpb247CiBzdHJ1Y3QgYnVmZmVyZWRfZGF0YQogewog
CXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKKwlib29sIG9uX291dF9saXN0Owor
CWJvb2wgb25fcmVmX2xpc3Q7CiAKIAkvKiBBcmUgd2Ugc3RpbGwgZG9pbmcg
dGhlIGhlYWRlcj8gKi8KIAlib29sIGluaGRyOwpAQCAtNjMsNiArNjUsMTcg
QEAgc3RydWN0IGJ1ZmZlcmVkX2RhdGEKIAkvKiBIb3cgZmFyIGFyZSB3ZT8g
Ki8KIAl1bnNpZ25lZCBpbnQgdXNlZDsKIAorCS8qIE91dHN0YW5kaW5nIHJl
cXVlc3QgYWNjb3VudGluZy4gKi8KKwl1bmlvbiB7CisJCS8qIHJlZiBpcyBi
ZWluZyB1c2VkIGZvciByZXF1ZXN0cy4gKi8KKwkJc3RydWN0IHsKKwkJCXVu
c2lnbmVkIGludCBldmVudF9jbnQ7IC8qICMgb2Ygb3V0c3RhbmRpbmcgZXZl
bnRzLiAqLworCQkJdW5zaWduZWQgaW50IGRvbWlkOyAgICAgLyogZG9taWQg
b2YgcmVxdWVzdC4gKi8KKwkJfSByZWY7CisJCS8qIHJlcSBpcyBiZWluZyB1
c2VkIGZvciB3YXRjaCBldmVudHMuICovCisJCXN0cnVjdCBidWZmZXJlZF9k
YXRhICpyZXE7ICAgICAgLyogcmVxdWVzdCBjYXVzaW5nIGV2ZW50LiAqLwor
CX0gcGVuZDsKKwogCXVuaW9uIHsKIAkJc3RydWN0IHhzZF9zb2NrbXNnIG1z
ZzsKIAkJY2hhciByYXdbc2l6ZW9mKHN0cnVjdCB4c2Rfc29ja21zZyldOwpA
QCAtMTE1LDYgKzEyOCw5IEBAIHN0cnVjdCBjb25uZWN0aW9uCiAJc3RydWN0
IGxpc3RfaGVhZCBvdXRfbGlzdDsKIAl1aW50NjRfdCB0aW1lb3V0X21zZWM7
CiAKKwkvKiBSZWZlcmVuY2VkIHJlcXVlc3RzIG5vIGxvbmdlciBwZW5kaW5n
LiAqLworCXN0cnVjdCBsaXN0X2hlYWQgcmVmX2xpc3Q7CisKIAkvKiBUcmFu
c2FjdGlvbiBjb250ZXh0IGZvciBjdXJyZW50IHJlcXVlc3QgKE5VTEwgaWYg
bm9uZSkuICovCiAJc3RydWN0IHRyYW5zYWN0aW9uICp0cmFuc2FjdGlvbjsK
IApAQCAtMTg0LDcgKzIwMCw4IEBAIHVuc2lnbmVkIGludCBnZXRfc3RyaW5n
KGNvbnN0IHN0cnVjdCBidWZmZXJlZF9kYXRhICpkYXRhLCB1bnNpZ25lZCBp
bnQgb2Zmc2V0KTsKIAogdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0
aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAkJY29u
c3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbik7Ci12b2lkIHNlbmRf
ZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IGNoYXIgKnBh
dGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKK3ZvaWQgc2VuZF9ldmVudChzdHJ1
Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwKKwkJY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pOwog
CiAvKiBTb21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0YykganVzdCBu
ZWVkIGEgbm9uLWVycm9yIHJldHVybiAqLwogdm9pZCBzZW5kX2FjayhzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4c2Rfc29ja21zZ190eXBlIHR5
cGUpOwpAQCAtMjQwLDYgKzI1Nyw3IEBAIGV4dGVybiBpbnQgZG9tMF9kb21p
ZDsKIGV4dGVybiBpbnQgZG9tMF9ldmVudDsKIGV4dGVybiBpbnQgcHJpdl9k
b21pZDsKIGV4dGVybiBpbnQgcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbjsK
K2V4dGVybiBpbnQgcXVvdGFfcmVxX291dHN0YW5kaW5nOwogCiBleHRlcm4g
dW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDcyYTVj
ZDNiOWFhZi4uOTc5ZjhjNjI5ODM1IDEwMDY0NAotLS0gYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2RvbWFpbi5jCkBAIC03OCw2ICs3OCw5IEBAIHN0cnVjdCBk
b21haW4KIAkvKiBudW1iZXIgb2Ygd2F0Y2ggZm9yIHRoaXMgZG9tYWluICov
CiAJaW50IG5id2F0Y2g7CiAKKwkvKiBOdW1iZXIgb2Ygb3V0c3RhbmRpbmcg
cmVxdWVzdHMuICovCisJaW50IG5ib3V0c3RhbmRpbmc7CisKIAkvKiB3cml0
ZSByYXRlIGxpbWl0ICovCiAJd3JsX2NyZWRpdHQgd3JsX2NyZWRpdDsgLyog
WyAtd3JsX2NvbmZpZ193cml0ZWNvc3QsICtfZGJ1cnN0IF0gKi8KIAlzdHJ1
Y3Qgd3JsX3RpbWVzdGFtcHQgd3JsX3RpbWVzdGFtcDsKQEAgLTI4Nyw4ICsy
OTAsMTIgQEAgYm9vbCBkb21haW5fY2FuX3JlYWQoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4pCiB7CiAJc3RydWN0IHhlbnN0b3JlX2RvbWFpbl9pbnRlcmZh
Y2UgKmludGYgPSBjb25uLT5kb21haW4tPmludGVyZmFjZTsKIAotCWlmIChk
b21haW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pICYmIGNvbm4tPmRvbWFpbi0+
d3JsX2NyZWRpdCA8IDApCi0JCXJldHVybiBmYWxzZTsKKwlpZiAoZG9tYWlu
X2lzX3VucHJpdmlsZWdlZChjb25uKSkgeworCQlpZiAoY29ubi0+ZG9tYWlu
LT53cmxfY3JlZGl0IDwgMCkKKwkJCXJldHVybiBmYWxzZTsKKwkJaWYgKGNv
bm4tPmRvbWFpbi0+bmJvdXRzdGFuZGluZyA+PSBxdW90YV9yZXFfb3V0c3Rh
bmRpbmcpCisJCQlyZXR1cm4gZmFsc2U7CisJfQogCiAJaWYgKGNvbm4tPmlz
X2lnbm9yZWQpCiAJCXJldHVybiBmYWxzZTsKQEAgLTMzNyw3ICszNDQsNyBA
QCBzdGF0aWMgc3RydWN0IGRvbWFpbiAqYWxsb2NfZG9tYWluKGNvbnN0IHZv
aWQgKmNvbnRleHQsIHVuc2lnbmVkIGludCBkb21pZCkKIHsKIAlzdHJ1Y3Qg
ZG9tYWluICpkb21haW47CiAKLQlkb21haW4gPSB0YWxsb2MoY29udGV4dCwg
c3RydWN0IGRvbWFpbik7CisJZG9tYWluID0gdGFsbG9jX3plcm8oY29udGV4
dCwgc3RydWN0IGRvbWFpbik7CiAJaWYgKCFkb21haW4pIHsKIAkJZXJybm8g
PSBFTk9NRU07CiAJCXJldHVybiBOVUxMOwpAQCAtMzk4LDkgKzQwNSw2IEBA
IHN0YXRpYyBpbnQgbmV3X2RvbWFpbihzdHJ1Y3QgZG9tYWluICpkb21haW4s
IGludCBwb3J0LCBib29sIHJlc3RvcmUpCiAJZG9tYWluLT5jb25uLT5kb21h
aW4gPSBkb21haW47CiAJZG9tYWluLT5jb25uLT5pZCA9IGRvbWFpbi0+ZG9t
aWQ7CiAKLQlkb21haW4tPm5iZW50cnkgPSAwOwotCWRvbWFpbi0+bmJ3YXRj
aCA9IDA7Ci0KIAlyZXR1cm4gMDsKIH0KIApAQCAtOTQ0LDYgKzk0OCwyOCBA
QCBpbnQgZG9tYWluX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQog
CQk6IDA7CiB9CiAKK3ZvaWQgZG9tYWluX291dHN0YW5kaW5nX2luYyhzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubikKK3sKKwlpZiAoIWNvbm4gfHwgIWNvbm4t
PmRvbWFpbikKKwkJcmV0dXJuOworCWNvbm4tPmRvbWFpbi0+bmJvdXRzdGFu
ZGluZysrOworfQorCit2b2lkIGRvbWFpbl9vdXRzdGFuZGluZ19kZWMoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJaWYgKCFjb25uIHx8ICFjb25u
LT5kb21haW4pCisJCXJldHVybjsKKwljb25uLT5kb21haW4tPm5ib3V0c3Rh
bmRpbmctLTsKK30KKwordm9pZCBkb21haW5fb3V0c3RhbmRpbmdfZG9taWRf
ZGVjKHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1Y3QgZG9tYWluICpk
ID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9taWQpOworCisJaWYgKGQpCisJ
CWQtPm5ib3V0c3RhbmRpbmctLTsKK30KKwogc3RhdGljIHdybF9jcmVkaXR0
IHdybF9jb25maWdfd3JpdGVjb3N0ICAgICAgPSBXUkxfRkFDVE9SOwogc3Rh
dGljIHdybF9jcmVkaXR0IHdybF9jb25maWdfcmF0ZSAgICAgICAgICAgPSBX
UkxfUkFURSAgICogV1JMX0ZBQ1RPUjsKIHN0YXRpYyB3cmxfY3JlZGl0dCB3
cmxfY29uZmlnX2RidXJzdCAgICAgICAgID0gV1JMX0RCVVJTVCAqIFdSTF9G
QUNUT1I7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
aW5kZXggZGM5NzU5MTcxMzE3Li41NzU3YTY1NTcxNDYgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAorKysgYi90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY4LDYgKzY4LDkg
QEAgaW50IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7
CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwordm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5jKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKK3ZvaWQgZG9tYWluX291dHN0YW5kaW5nX2Rl
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7Cit2b2lkIGRvbWFpbl9vdXRz
dGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKTsKIAogLyog
U3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICovCiBpbnQgc2V0
X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0
IGNoYXIgKm5hbWUsCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfd2F0Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRj
aC5jCmluZGV4IGJjNmQ4MzMwMjhhMy4uMWQ2NjRlM2Q2YjcyIDEwMDY0NAot
LS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMTQyLDYgKzE0
Miw3IEBAIHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCSAg
c3RydWN0IG5vZGUgKm5vZGUsIGJvb2wgZXhhY3QsIHN0cnVjdCBub2RlX3Bl
cm1zICpwZXJtcykKIHsKIAlzdHJ1Y3QgY29ubmVjdGlvbiAqaTsKKwlzdHJ1
Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCXN0cnVjdCB3YXRjaCAqd2F0Y2g7
CiAKIAkvKiBEdXJpbmcgdHJhbnNhY3Rpb25zLCBkb24ndCBmaXJlIHdhdGNo
ZXMsIGJ1dCBxdWV1ZSB0aGVtLiAqLwpAQCAtMTUwLDYgKzE1MSw4IEBAIHZv
aWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCXJldHVybjsKIAl9
CiAKKwlyZXEgPSBkb21haW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pID8gY29u
bi0+aW4gOiBOVUxMOworCiAJLyogQ3JlYXRlIGFuIGV2ZW50IGZvciBlYWNo
IHdhdGNoLiAqLwogCWxpc3RfZm9yX2VhY2hfZW50cnkoaSwgJmNvbm5lY3Rp
b25zLCBsaXN0KSB7CiAJCS8qIGludHJvZHVjZS9yZWxlYXNlIGRvbWFpbiB3
YXRjaGVzICovCkBAIC0xNjQsMTIgKzE2NywxMiBAQCB2b2lkIGZpcmVfd2F0
Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4
LCBjb25zdCBjaGFyICpuYW1lLAogCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KHdh
dGNoLCAmaS0+d2F0Y2hlcywgbGlzdCkgewogCQkJaWYgKGV4YWN0KSB7CiAJ
CQkJaWYgKHN0cmVxKG5hbWUsIHdhdGNoLT5ub2RlKSkKLQkJCQkJc2VuZF9l
dmVudChpLAorCQkJCQlzZW5kX2V2ZW50KHJlcSwgaSwKIAkJCQkJCSAgIGdl
dF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKIAkJCQkJCSAgIHdhdGNoLT50
b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChpc19jaGlsZChuYW1lLCB3
YXRjaC0+bm9kZSkpCi0JCQkJCXNlbmRfZXZlbnQoaSwKKwkJCQkJc2VuZF9l
dmVudChyZXEsIGksCiAJCQkJCQkgICBnZXRfd2F0Y2hfcGF0aCh3YXRjaCwg
bmFtZSksCiAJCQkJCQkgICB3YXRjaC0+dG9rZW4pOwogCQkJfQpAQCAtMjY5
LDggKzI3MiwxMiBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAl0cmFjZV9jcmVh
dGUod2F0Y2gsICJ3YXRjaCIpOwogCXNlbmRfYWNrKGNvbm4sIFhTX1dBVENI
KTsKIAotCS8qIFdlIGZpcmUgb25jZSB1cCBmcm9udDogc2ltcGxpZmllcyBj
bGllbnRzIGFuZCByZXN0YXJ0LiAqLwotCXNlbmRfZXZlbnQoY29ubiwgZ2V0
X3dhdGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2RlKSwgd2F0Y2gtPnRva2Vu
KTsKKwkvKgorCSAqIFdlIGZpcmUgb25jZSB1cCBmcm9udDogc2ltcGxpZmll
cyBjbGllbnRzIGFuZCByZXN0YXJ0LgorCSAqIFRoaXMgZXZlbnQgd2lsbCBu
b3QgYmUgbGlua2VkIHRvIHRoZSBYU19XQVRDSCByZXF1ZXN0LgorCSAqLwor
CXNlbmRfZXZlbnQoTlVMTCwgY29ubiwgZ2V0X3dhdGNoX3BhdGgod2F0Y2gs
IHdhdGNoLT5ub2RlKSwKKwkJICAgd2F0Y2gtPnRva2VuKTsKIAogCXJldHVy
biAwOwogfQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSA0NTIyYjllNWMwNWYxMmJjYTBjN2QxYzJjOWZlYTE1YzdiYzQxMzU4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGRvbid0IGJ1
ZmZlciBtdWx0aXBsZSBpZGVudGljYWwgd2F0Y2ggZXZlbnRzCgpBIGd1ZXN0
IG5vdCByZWFkaW5nIGl0cyBYZW5zdG9yZSByZXNwb25zZSBidWZmZXIgZmFz
dCBlbm91Z2ggbWlnaHQKcGlsZSB1cCBsb3RzIG9mIFhlbnN0b3JlIHdhdGNo
IGV2ZW50cyBidWZmZXJlZC4gUmVkdWNlIHRoZSBnZW5lcmF0ZWQKbG9hZCBi
eSBkcm9wcGluZyBuZXcgZXZlbnRzIHdoaWNoIGFscmVhZHkgaGF2ZSBhbiBp
ZGVudGljYWwgY29weQpwZW5kaW5nLgoKVGhlIHNwZWNpYWwgZXZlbnRzICJA
Li4uIiBhcmUgZXhjbHVkZWQgZnJvbSB0aGF0IGhhbmRsaW5nIGFzIHRoZXJl
IGFyZQprbm93biB1c2UgY2FzZXMgd2hlcmUgdGhlIGhhbmRsZXIgaXMgcmVs
eWluZyBvbiBlYWNoIGV2ZW50IHRvIGJlIHNlbnQKaW5kaXZpZHVhbGx5LgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCBkODcxZjIxN2FmOWMuLjZlYTA2
ZTIwZGY5MSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CkBAIC04ODIsNiArODgyLDcgQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwK
IAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0gMDsKIAli
ZGF0YS0+dGltZW91dF9tc2VjID0gMDsKKwliZGF0YS0+d2F0Y2hfZXZlbnQg
PSBmYWxzZTsKIAogCWlmIChsZW4gPD0gREVGQVVMVF9CVUZGRVJfU0laRSkK
IAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZhdWx0X2J1ZmZlcjsKQEAg
LTkxNCw3ICs5MTUsNyBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAogdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQljb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp0b2tlbikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRh
dGE7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLCAqYmQ7CiAJdW5z
aWduZWQgaW50IGxlbjsKIAogCWxlbiA9IHN0cmxlbihwYXRoKSArIDEgKyBz
dHJsZW4odG9rZW4pICsgMTsKQEAgLTkzNiwxMiArOTM3LDI5IEBAIHZvaWQg
c2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKIAliZGF0YS0+aGRyLm1zZy50eXBlID0gWFNf
V0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVuOwogCisJ
LyoKKwkgKiBDaGVjayB3aGV0aGVyIGFuIGlkZW50aWNhbCBldmVudCBpcyBw
ZW5kaW5nIGFscmVhZHkuCisJICogU3BlY2lhbCBldmVudHMgYXJlIGV4Y2x1
ZGVkIGZyb20gdGhhdCBjaGVjay4KKwkgKi8KKwlpZiAocGF0aFswXSAhPSAn
QCcpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShiZCwgJmNvbm4tPm91dF9s
aXN0LCBsaXN0KSB7CisJCQlpZiAoYmQtPndhdGNoX2V2ZW50ICYmIGJkLT5o
ZHIubXNnLmxlbiA9PSBsZW4gJiYKKwkJCSAgICAhbWVtY21wKGJkYXRhLT5i
dWZmZXIsIGJkLT5idWZmZXIsIGxlbikpIHsKKwkJCQl0cmFjZSgiZHJvcHBp
bmcgZHVwbGljYXRlIHdhdGNoICVzICVzIGZvciBkb21haW4gJXVcbiIsCisJ
CQkJICAgICAgcGF0aCwgdG9rZW4sIGNvbm4tPmlkKTsKKwkJCQl0YWxsb2Nf
ZnJlZShiZGF0YSk7CisJCQkJcmV0dXJuOworCQkJfQorCQl9CisJfQorCiAJ
aWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5faXNfdW5w
cml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21zZWMgPSBn
ZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIAkJ
aWYgKCFjb25uLT50aW1lb3V0X21zZWMpCiAJCQljb25uLT50aW1lb3V0X21z
ZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOwogCX0KIAorCWJkYXRhLT53YXRj
aF9ldmVudCA9IHRydWU7CiAJYmRhdGEtPnBlbmQucmVxID0gcmVxOwogCWlm
IChyZXEpCiAJCXJlcS0+cGVuZC5yZWYuZXZlbnRfY250Kys7CmRpZmYgLS1n
aXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBmY2IyNzM5OWYxMTYu
LmFmYmQ5ODJjMjY1NCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCkBAIC02Miw2ICs2Miw5IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBoZWFkZXI/ICovCiAJYm9v
bCBpbmhkcjsKIAorCS8qIElzIHRoaXMgYSB3YXRjaCBldmVudD8gKi8KKwli
b29sIHdhdGNoX2V2ZW50OworCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSBiMjhhZDllYjc2MTVkMDU3MTZiZDcyOGU2YjJkZjBmODRkMDcxMWEw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGZpeCBjb25u
ZWN0aW9uLT5pZCB1c2FnZQoKRG9uJ3QgdXNlIGNvbm4tPmlkIGZvciBwcml2
aWxlZ2UgY2hlY2tzLCBidXQgZG9tYWluX2lzX3VucHJpdmlsZWdlZCgpLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvbnRyb2wuYwppbmRleCA4ZTQ3MGYyYjIwNTYu
LjIxMWZlMWZkOWIzNyAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvbnRyb2wuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCkBAIC04MjEsNyArODIxLDcgQEAgaW50IGRvX2NvbnRy
b2woc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9k
YXRhICppbikKIAl1bnNpZ25lZCBpbnQgY21kLCBudW0sIG9mZjsKIAljaGFy
ICoqdmVjID0gTlVMTDsKIAotCWlmIChjb25uLT5pZCAhPSAwKQorCWlmIChk
b21haW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKQogCQlyZXR1cm4gRUFDQ0VT
OwogCiAJb2ZmID0gZ2V0X3N0cmluZyhpbiwgMCk7CmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBhZmJkOTgyYzI2NTQuLmMwYTA1
NmNlMTNmZSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5o
CkBAIC0xMTgsNyArMTE4LDcgQEAgc3RydWN0IGNvbm5lY3Rpb24KIAkvKiBU
aGUgaW5kZXggb2YgcG9sbGZkIGluIGdsb2JhbCBwb2xsZmQgYXJyYXkgKi8K
IAlpbnQgcG9sbGZkX2lkeDsKIAotCS8qIFdobyBhbSBJPyAwIGZvciBzb2Nr
ZXQgY29ubmVjdGlvbnMuICovCisJLyogV2hvIGFtIEk/IERvbWlkIG9mIGNv
bm5lY3Rpb24uICovCiAJdW5zaWduZWQgaW50IGlkOwogCiAJLyogSXMgdGhp
cyBjb25uZWN0aW9uIGlnbm9yZWQ/ICovCmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IDU0NDMyOTA3ZmM3
Ni4uZWUxYjA5MDMxYTNiIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNDc3LDcgKzQ3Nyw4IEBAIGlu
dCBkb190cmFuc2FjdGlvbl9zdGFydChzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmluKQogCWlmIChjb25uLT50cmFu
c2FjdGlvbikKIAkJcmV0dXJuIEVCVVNZOwogCi0JaWYgKGNvbm4tPmlkICYm
IGNvbm4tPnRyYW5zYWN0aW9uX3N0YXJ0ZWQgPiBxdW90YV9tYXhfdHJhbnNh
Y3Rpb24pCisJaWYgKGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYK
KwkgICAgY29ubi0+dHJhbnNhY3Rpb25fc3RhcnRlZCA+IHF1b3RhX21heF90
cmFuc2FjdGlvbikKIAkJcmV0dXJuIEVOT1NQQzsKIAogCS8qIEF0dGFjaCB0
cmFuc2FjdGlvbiB0byBpbnB1dCBmb3IgYXV0b2ZyZWUgdW50aWwgaXQncyBj
b21wbGV0ZSAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSAwZTcyNGE3OTY0NWQwNWYxMTdmMGFmODMyYjI0YmMzMzRmNzYyZGJj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNpbXBsaWZ5
IGFuZCBmaXggcGVyIGRvbWFpbiBub2RlIGFjY291bnRpbmcKClRoZSBhY2Nv
dW50aW5nIG9mIG5vZGVzIGNhbiBiZSBzaW1wbGlmaWVkIG5vdyB0aGF0IGVh
Y2ggY29ubmVjdGlvbgpob2xkcyB0aGUgYXNzb2NpYXRlZCBkb21pZC4KCkZp
eCB0aGUgbm9kZSBhY2NvdW50aW5nIHRvIGNvdmVyIG5vZGVzIGNyZWF0ZWQg
Zm9yIGEgZG9tYWluIGJlZm9yZSBpdApoYXMgYmVlbiBpbnRyb2R1Y2VkLiBU
aGlzIHJlcXVpcmVzIHRvIHJlYWN0IHByb3Blcmx5IHRvIGFuIGFsbG9jYXRp
b24KZmFpbHVyZSBpbnNpZGUgZG9tYWluX2VudHJ5X2luYygpIGJ5IHJldHVy
bmluZyBhbiBlcnJvciBjb2RlLgoKRXNwZWNpYWxseSBpbiBlcnJvciBwYXRo
cyB0aGUgbm9kZSBhY2NvdW50aW5nIGhhcyB0byBiZSBmaXhlZCBpbiBzb21l
CmNhc2VzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYgLyBDVkUtMjAyMi00
MjMxMy4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6
b24uY29tPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CmluZGV4IDZlYTA2ZTIwZGY5MS4uODVjMGQyZjM4ZmFjIDEwMDY0NAotLS0g
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisrKyBiL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTYwMyw3ICs2MDMsNyBA
QCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBQZXJtaXNzaW9ucyBhcmUg
c3RydWN0IHhzX3Blcm1pc3Npb25zLiAqLwogCW5vZGUtPnBlcm1zLnAgPSBo
ZHItPnBlcm1zOwotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMobm9k
ZSkpIHsKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKSB7CiAJCXRhbGxvY19mcmVlKG5vZGUpOwogCQlyZXR1cm4gTlVMTDsK
IAl9CkBAIC02MjUsNyArNjI1LDcgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qg
bm9kZSAqbm9kZSwKIAl2b2lkICpwOwogCXN0cnVjdCB4c190ZGJfcmVjb3Jk
X2hkciAqaGRyOwogCi0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKQogCQlyZXR1cm4gZXJybm87CiAKIAlkYXRhLmRzaXplID0gc2l6ZW9m
KCpoZHIpCkBAIC0xMjM4LDEzICsxMjM4LDE3IEBAIHN0YXRpYyBzdHJ1Y3Qg
bm9kZSAqY29uc3RydWN0X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IHZvaWQgKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGlj
IGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlKQorc3RhdGljIHZvaWQgZGVzdHJveV9ub2RlX3Jt
KHN0cnVjdCBub2RlICpub2RlKQogewogCWlmIChzdHJlcShub2RlLT5uYW1l
LCAiLyIpKQogCQljb3JydXB0KE5VTEwsICJEZXN0cm95aW5nIHJvb3Qgbm9k
ZSEiKTsKIAogCXRkYl9kZWxldGUodGRiX2N0eCwgbm9kZS0+a2V5KTsKK30K
IAorc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoreworCWRlc3Ryb3lfbm9kZV9y
bShub2RlKTsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwogCiAJ
LyoKQEAgLTEyOTQsOCArMTI5OCwxMiBAQCBzdGF0aWMgc3RydWN0IG5vZGUg
KmNyZWF0ZV9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2
b2lkICpjdHgsCiAJCQlnb3RvIGVycjsKIAogCQkvKiBBY2NvdW50IGZvciBu
ZXcgbm9kZSAqLwotCQlpZiAoaS0+cGFyZW50KQotCQkJZG9tYWluX2VudHJ5
X2luYyhjb25uLCBpKTsKKwkJaWYgKGktPnBhcmVudCkgeworCQkJaWYgKGRv
bWFpbl9lbnRyeV9pbmMoY29ubiwgaSkpIHsKKwkJCQlkZXN0cm95X25vZGVf
cm0oaSk7CisJCQkJcmV0dXJuIE5VTEw7CisJCQl9CisJCX0KIAl9CiAKIAly
ZXR1cm4gbm9kZTsKQEAgLTE1ODAsMTAgKzE1ODgsMjcgQEAgc3RhdGljIGlu
dCBkb19zZXRfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVj
dCBidWZmZXJlZF9kYXRhICppbikKIAlvbGRfcGVybXMgPSBub2RlLT5wZXJt
czsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwogCW5vZGUtPnBl
cm1zID0gcGVybXM7Ci0JZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKTsK
KwlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKSkgeworCQlub2Rl
LT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyoKKwkJICogVGhpcyBzaG91bGQg
bmV2ZXIgZmFpbCBiZWNhdXNlIHdlIGhhZCBhIHJlZmVyZW5jZSBvbiB0aGUK
KwkJICogZG9tYWluIGJlZm9yZSBhbmQgWGVuc3RvcmVkIGlzIHNpbmdsZS10
aHJlYWRlZC4KKwkJICovCisJCWRvbWFpbl9lbnRyeV9pbmMoY29ubiwgbm9k
ZSk7CisJCXJldHVybiBFTk9NRU07CisJfQorCisJaWYgKHdyaXRlX25vZGUo
Y29ubiwgbm9kZSwgZmFsc2UpKSB7CisJCWludCBzYXZlZF9lcnJubyA9IGVy
cm5vOwogCi0JaWYgKHdyaXRlX25vZGUoY29ubiwgbm9kZSwgZmFsc2UpKQor
CQlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOworCQlub2RlLT5wZXJt
cyA9IG9sZF9wZXJtczsKKwkJLyogTm8gZmFpbHVyZSBwb3NzaWJsZSBhcyBh
Ym92ZS4gKi8KKwkJZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKTsKKwor
CQllcnJubyA9IHNhdmVkX2Vycm5vOwogCQlyZXR1cm4gZXJybm87CisJfQog
CiAJZmlyZV93YXRjaGVzKGNvbm4sIGluLCBuYW1lLCBub2RlLCBmYWxzZSwg
Jm9sZF9wZXJtcyk7CiAJc2VuZF9hY2soY29ubiwgWFNfU0VUX1BFUk1TKTsK
QEAgLTMwMDMsNyArMzAyOCw5IEBAIHZvaWQgcmVhZF9zdGF0ZV9ub2RlKGNv
bnN0IHZvaWQgKmN0eCwgY29uc3Qgdm9pZCAqc3RhdGUpCiAJc2V0X3RkYl9r
ZXkobmFtZSwgJmtleSk7CiAJaWYgKHdyaXRlX25vZGVfcmF3KE5VTEwsICZr
ZXksIG5vZGUsIHRydWUpKQogCQliYXJmKCJ3cml0ZSBub2RlIGVycm9yIHJl
c3RvcmluZyBub2RlIik7Ci0JZG9tYWluX2VudHJ5X2luYygmY29ubiwgbm9k
ZSk7CisKKwlpZiAoZG9tYWluX2VudHJ5X2luYygmY29ubiwgbm9kZSkpCisJ
CWJhcmYoIm5vZGUgYWNjb3VudGluZyBlcnJvciByZXN0b3Jpbmcgbm9kZSIp
OwogCiAJdGFsbG9jX2ZyZWUobm9kZSk7CiB9CmRpZmYgLS1naXQgYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKaW5kZXggOTc5ZjhjNjI5ODM1Li4zYzI3
OTczZmI4MzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9kb21haW4uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKQEAgLTE2LDYgKzE2LDcgQEAKICAgICBhbG9uZyB3aXRoIHRoaXMg
cHJvZ3JhbTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNl
bnNlcy8+LgogKi8KIAorI2luY2x1ZGUgPGFzc2VydC5oPgogI2luY2x1ZGUg
PHN0ZGlvLmg+CiAjaW5jbHVkZSA8c3lzL21tYW4uaD4KICNpbmNsdWRlIDx1
bmlzdGQuaD4KQEAgLTM2OSw2ICszNzAsMTggQEAgc3RhdGljIHN0cnVjdCBk
b21haW4gKmZpbmRfb3JfYWxsb2NfZG9tYWluKGNvbnN0IHZvaWQgKmN0eCwg
dW5zaWduZWQgaW50IGRvbWlkKQogCXJldHVybiBkb21haW4gPyA6IGFsbG9j
X2RvbWFpbihjdHgsIGRvbWlkKTsKIH0KIAorc3RhdGljIHN0cnVjdCBkb21h
aW4gKmZpbmRfb3JfYWxsb2NfZXhpc3RpbmdfZG9tYWluKHVuc2lnbmVkIGlu
dCBkb21pZCkKK3sKKwlzdHJ1Y3QgZG9tYWluICpkb21haW47CisJeGNfZG9t
aW5mb190IGRvbWluZm87CisKKwlkb21haW4gPSBmaW5kX2RvbWFpbl9zdHJ1
Y3QoZG9taWQpOworCWlmICghZG9tYWluICYmIGdldF9kb21haW5faW5mbyhk
b21pZCwgJmRvbWluZm8pKQorCQlkb21haW4gPSBhbGxvY19kb21haW4oTlVM
TCwgZG9taWQpOworCisJcmV0dXJuIGRvbWFpbjsKK30KKwogc3RhdGljIGlu
dCBuZXdfZG9tYWluKHN0cnVjdCBkb21haW4gKmRvbWFpbiwgaW50IHBvcnQs
IGJvb2wgcmVzdG9yZSkKIHsKIAlpbnQgcmM7CkBAIC03ODgsMzAgKzgwMSwy
OCBAQCB2b2lkIGRvbWFpbl9kZWluaXQodm9pZCkKIAkJeGVuZXZ0Y2huX3Vu
YmluZCh4Y2VfaGFuZGxlLCB2aXJxX3BvcnQpOwogfQogCi12b2lkIGRvbWFp
bl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKQoraW50IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogewogCXN0cnVjdCBk
b21haW4gKmQ7CisJdW5zaWduZWQgaW50IGRvbWlkOwogCiAJaWYgKCFjb25u
KQotCQlyZXR1cm47CisJCXJldHVybiAwOwogCi0JaWYgKG5vZGUtPnBlcm1z
LnAgJiYgbm9kZS0+cGVybXMucFswXS5pZCAhPSBjb25uLT5pZCkgewotCQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKLQkJCXRyYW5zYWN0aW9uX2VudHJ5
X2luYyhjb25uLT50cmFuc2FjdGlvbiwKLQkJCQlub2RlLT5wZXJtcy5wWzBd
LmlkKTsKLQkJfSBlbHNlIHsKLQkJCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21p
ZChub2RlLT5wZXJtcy5wWzBdLmlkKTsKLQkJCWlmIChkKQotCQkJCWQtPm5i
ZW50cnkrKzsKLQkJfQotCX0gZWxzZSBpZiAoY29ubi0+ZG9tYWluKSB7Ci0J
CWlmIChjb25uLT50cmFuc2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50
cnlfaW5jKGNvbm4tPnRyYW5zYWN0aW9uLAotCQkJCWNvbm4tPmRvbWFpbi0+
ZG9taWQpOwotIAkJfSBlbHNlIHsKLSAJCQljb25uLT5kb21haW4tPm5iZW50
cnkrKzsKLQkJfQorCWRvbWlkID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBl
cm1zLnBbMF0uaWQgOiBjb25uLT5pZDsKKworCWlmIChjb25uLT50cmFuc2Fj
dGlvbikgeworCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29ubi0+dHJhbnNh
Y3Rpb24sIGRvbWlkKTsKKwl9IGVsc2UgeworCQlkID0gKGRvbWlkID09IGNv
bm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4KKwkJICAg
IDogZmluZF9vcl9hbGxvY19leGlzdGluZ19kb21haW4oZG9taWQpOworCQlp
ZiAoZCkKKwkJCWQtPm5iZW50cnkrKzsKKwkJZWxzZQorCQkJcmV0dXJuIEVO
T01FTTsKIAl9CisKKwlyZXR1cm4gMDsKIH0KIAogLyoKQEAgLTg0Nyw3ICs4
NTgsNyBAQCBzdGF0aWMgaW50IGNoa19kb21haW5fZ2VuZXJhdGlvbih1bnNp
Z25lZCBpbnQgZG9taWQsIHVpbnQ2NF90IGdlbikKICAqIFJlbW92ZSBwZXJt
aXNzaW9ucyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5nIGRvbWFpbnMgaW4gb3Jk
ZXIgdG8gYXZvaWQgYSBuZXcKICAqIGRvbWFpbiB3aXRoIHRoZSBzYW1lIGRv
bWlkIGluaGVyaXRpbmcgdGhlIHBlcm1pc3Npb25zLgogICovCi1pbnQgZG9t
YWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVjdCBub2RlICpub2RlKQoraW50
IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJdW5zaWduZWQgaW50IGk7
CiAJaW50IHJldDsKQEAgLTg1Nyw4ICs4NjgsMTQgQEAgaW50IGRvbWFpbl9h
ZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qgbm9kZSAqbm9kZSkKIAkJcmV0dXJu
IGVycm5vOwogCiAJLyogSWYgdGhlIG93bmVyIGRvZXNuJ3QgZXhpc3QgYW55
IGxvbmdlciBnaXZlIGl0IHRvIHByaXYgZG9tYWluLiAqLwotCWlmICghcmV0
KQorCWlmICghcmV0KSB7CisJCS8qCisJCSAqIEluIHRoZW9yeSB3ZSdkIG5l
ZWQgdG8gdXBkYXRlIHRoZSBudW1iZXIgb2YgZG9tMCBub2RlcyBoZXJlLAor
CQkgKiBidXQgd2UgY291bGQgYmUgY2FsbGVkIGZvciBhIHJlYWQgb2YgdGhl
IG5vZGUuIFNvIGJldHRlcgorCQkgKiBhdm9pZCB0aGUgcmlzayB0byBvdmVy
ZmxvdyB0aGUgbm9kZSBjb3VudCBvZiBkb20wLgorCQkgKi8KIAkJbm9kZS0+
cGVybXMucFswXS5pZCA9IHByaXZfZG9taWQ7CisJfQogCiAJZm9yIChpID0g
MTsgaSA8IG5vZGUtPnBlcm1zLm51bTsgaSsrKSB7CiAJCWlmIChub2RlLT5w
ZXJtcy5wW2ldLnBlcm1zICYgWFNfUEVSTV9JR05PUkUpCkBAIC04NzcsMjUg
Kzg5NCwyNSBAQCBpbnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVj
dCBub2RlICpub2RlKQogdm9pZCBkb21haW5fZW50cnlfZGVjKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKIAlzdHJ1
Y3QgZG9tYWluICpkOworCXVuc2lnbmVkIGludCBkb21pZDsKIAogCWlmICgh
Y29ubikKIAkJcmV0dXJuOwogCi0JaWYgKG5vZGUtPnBlcm1zLnAgJiYgbm9k
ZS0+cGVybXMucFswXS5pZCAhPSBjb25uLT5pZCkgewotCQlpZiAoY29ubi0+
dHJhbnNhY3Rpb24pIHsKLQkJCXRyYW5zYWN0aW9uX2VudHJ5X2RlYyhjb25u
LT50cmFuc2FjdGlvbiwKLQkJCQlub2RlLT5wZXJtcy5wWzBdLmlkKTsKLQkJ
fSBlbHNlIHsKLQkJCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21pZChub2RlLT5w
ZXJtcy5wWzBdLmlkKTsKLQkJCWlmIChkICYmIGQtPm5iZW50cnkpCi0JCQkJ
ZC0+bmJlbnRyeS0tOwotCQl9Ci0JfSBlbHNlIGlmIChjb25uLT5kb21haW4g
JiYgY29ubi0+ZG9tYWluLT5uYmVudHJ5KSB7Ci0JCWlmIChjb25uLT50cmFu
c2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfZGVjKGNvbm4tPnRy
YW5zYWN0aW9uLAotCQkJCWNvbm4tPmRvbWFpbi0+ZG9taWQpOworCWRvbWlk
ID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBlcm1zLnBbMF0uaWQgOiBjb25u
LT5pZDsKKworCWlmIChjb25uLT50cmFuc2FjdGlvbikgeworCQl0cmFuc2Fj
dGlvbl9lbnRyeV9kZWMoY29ubi0+dHJhbnNhY3Rpb24sIGRvbWlkKTsKKwl9
IGVsc2UgeworCQlkID0gKGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KKwkJICAgIDogZmluZF9kb21haW5fc3Ry
dWN0KGRvbWlkKTsKKwkJaWYgKGQpIHsKKwkJCWQtPm5iZW50cnktLTsKIAkJ
fSBlbHNlIHsKLQkJCWNvbm4tPmRvbWFpbi0+bmJlbnRyeS0tOworCQkJZXJy
bm8gPSBFTk9FTlQ7CisJCQljb3JydXB0KGNvbm4sCisJCQkJIk5vZGUgXCIl
c1wiIG93bmVkIGJ5IG5vbi1leGlzdGluZyBkb21haW4gJXVcbiIsCisJCQkJ
bm9kZS0+bmFtZSwgZG9taWQpOwogCQl9CiAJfQogfQpAQCAtOTA1LDEzICs5
MjIsMjMgQEAgaW50IGRvbWFpbl9lbnRyeV9maXgodW5zaWduZWQgaW50IGRv
bWlkLCBpbnQgbnVtLCBib29sIHVwZGF0ZSkKIAlzdHJ1Y3QgZG9tYWluICpk
OwogCWludCBjbnQ7CiAKLQlkID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9t
aWQpOwotCWlmICghZCkKLQkJcmV0dXJuIDA7CisJaWYgKHVwZGF0ZSkgewor
CQlkID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwkJYXNzZXJ0KGQp
OworCX0gZWxzZSB7CisJCS8qCisJCSAqIFdlIGFyZSBjYWxsZWQgZmlyc3Qg
d2l0aCB1cGRhdGUgPT0gZmFsc2UgaW4gb3JkZXIgdG8gY2F0Y2gKKwkJICog
YW55IGVycm9yLiBTbyBkbyBhIHBvc3NpYmxlIGFsbG9jYXRpb24gYW5kIGNo
ZWNrIGZvciBlcnJvcgorCQkgKiBvbmx5IGluIHRoaXMgY2FzZSwgYXMgaW4g
dGhlIGNhc2Ugb2YgdXBkYXRlID09IHRydWUgbm90aGluZworCQkgKiBjYW4g
Z28gd3JvbmcgYW55bW9yZSBhcyB0aGUgYWxsb2NhdGlvbiBhbHJlYWR5IGhh
cHBlbmVkLgorCQkgKi8KKwkJZCA9IGZpbmRfb3JfYWxsb2NfZXhpc3Rpbmdf
ZG9tYWluKGRvbWlkKTsKKwkJaWYgKCFkKQorCQkJcmV0dXJuIC0xOworCX0K
IAogCWNudCA9IGQtPm5iZW50cnkgKyBudW07Ci0JaWYgKGNudCA8IDApCi0J
CWNudCA9IDA7CisJYXNzZXJ0KGNudCA+PSAwKTsKIAogCWlmICh1cGRhdGUp
CiAJCWQtPm5iZW50cnkgPSBjbnQ7CmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmgKaW5kZXggNTc1N2E2NTU3MTQ2Li5jY2UxM2QxNGYw
MTYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21h
aW4uaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
QEAgLTU4LDEwICs1OCwxMCBAQCBib29sIGRvbWFpbl9jYW5fd3JpdGUoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogYm9vbCBkb21haW5faXNfdW5wcml2
aWxlZ2VkKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKIAogLyogUmVtb3Zl
IG5vZGUgcGVybWlzc2lvbnMgZm9yIG5vIGxvbmdlciBleGlzdGluZyBkb21h
aW5zLiAqLwotaW50IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qg
bm9kZSAqbm9kZSk7CitpbnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSk7CiAK
IC8qIFF1b3RhIG1hbmlwdWxhdGlvbiAqLwotdm9pZCBkb21haW5fZW50cnlf
aW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqKTsK
K2ludCBkb21haW5fZW50cnlfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LCBzdHJ1Y3Qgbm9kZSAqKTsKIHZvaWQgZG9tYWluX2VudHJ5X2RlYyhzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKik7CiBpbnQgZG9t
YWluX2VudHJ5X2ZpeCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBudW0sIGJv
b2wgdXBkYXRlKTsKIGludCBkb21haW5fZW50cnkoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4pOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX3RyYW5zYWN0aW9uLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
dHJhbnNhY3Rpb24uYwppbmRleCBlZTFiMDkwMzFhM2IuLjg2Y2FmNmMzOThi
ZSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5z
YWN0aW9uLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5z
YWN0aW9uLmMKQEAgLTUxOSw4ICs1MTksMTIgQEAgc3RhdGljIGludCB0cmFu
c2FjdGlvbl9maXhfZG9tYWlucyhzdHJ1Y3QgdHJhbnNhY3Rpb24gKnRyYW5z
LCBib29sIHVwZGF0ZSkKIAogCWxpc3RfZm9yX2VhY2hfZW50cnkoZCwgJnRy
YW5zLT5jaGFuZ2VkX2RvbWFpbnMsIGxpc3QpIHsKIAkJY250ID0gZG9tYWlu
X2VudHJ5X2ZpeChkLT5kb21pZCwgZC0+bmJlbnRyeSwgdXBkYXRlKTsKLQkJ
aWYgKCF1cGRhdGUgJiYgY250ID49IHF1b3RhX25iX2VudHJ5X3Blcl9kb21h
aW4pCi0JCQlyZXR1cm4gRU5PU1BDOworCQlpZiAoIXVwZGF0ZSkgeworCQkJ
aWYgKGNudCA+PSBxdW90YV9uYl9lbnRyeV9wZXJfZG9tYWluKQorCQkJCXJl
dHVybiBFTk9TUEM7CisJCQlpZiAoY250IDwgMCkKKwkJCQlyZXR1cm4gRU5P
TUVNOworCQl9CiAJfQogCiAJcmV0dXJuIDA7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-09.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-09.patch"
Content-Transfer-Encoding: base64

RnJvbSBmNTZiMGFhMDQzMGQwZWU3OGU2NTgyYjMyM2E1NTIwODQzNjE5MDFh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG1h
eCBudW1iZXIgb2Ygbm9kZXMgYWNjZXNzZWQgaW4gYSB0cmFuc2FjdGlvbgoK
VG9kYXkgYSBndWVzdCBpcyBmcmVlIHRvIGFjY2VzcyBhcyBtYW55IG5vZGVz
IGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uCmFzIGl0IHdhbnRzLiBUaGlzIGNh
biBsZWFkIHRvIHVuYm91bmRlZCBtZW1vcnkgY29uc3VtcHRpb24gaW4gWGVu
c3RvcmUKYXMgdGhlcmUgaXMgdGhlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiBh
bGwgbm9kZXMgaGF2aW5nIGJlZW4gYWNjZXNzZWQKZHVyaW5nIGEgdHJhbnNh
Y3Rpb24uCgpJbiBveGVuc3RvcmVkIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMg
aW4gYSB0cmFuc2FjdGlvbiBpcyBiZWluZyBsaW1pdGVkCnZpYSBhIHF1b3Rh
IG1heHJlcXVlc3RzIChkZWZhdWx0IGlzIDEwMjQpLiBBcyBtdWx0aXBsZSBh
Y2Nlc3NlcyBvZiBhCm5vZGUgYXJlIG5vdCBwcm9ibGVtYXRpYyBpbiBDIFhl
bnN0b3JlLCBsaW1pdCB0aGUgbnVtYmVyIG9mIGFjY2Vzc2VkCm5vZGVzLgoK
SW4gb3JkZXIgdG8gbGV0IHJlYWRfbm9kZSgpIGRldGVjdCBhIHF1b3RhIGVy
cm9yIGluIGNhc2UgdG9vIG1hbnkgbm9kZXMKYXJlIGJlaW5nIGFjY2Vzc2Vk
LCBjaGVjayB0aGUgcmV0dXJuIHZhbHVlIG9mIGFjY2Vzc19ub2RlKCkgYW5k
IHJldHVybgpOVUxMIGluIGNhc2UgYW4gZXJyb3IgaGFzIGJlZW4gc2Vlbi4g
SW50cm9kdWNlIF9fbXVzdF9jaGVjayBhbmQgYWRkIGl0CnRvIHRoZSBhY2Nl
c3Nfbm9kZSgpIHByb3RvdHlwZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2
IC8gQ1ZFLTIwMjItNDIzMTQuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxs
IDxqZ3JhbGxAYW1hem9uLmNvbT4KU3VnZ2VzdGVkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGp1bGllbkB4ZW4ub3JnPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdy
b3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL2lu
Y2x1ZGUveGVuLXRvb2xzL2xpYnMuaCBiL3Rvb2xzL2luY2x1ZGUveGVuLXRv
b2xzL2xpYnMuaAppbmRleCBhMTZlMGMzODA3MDkuLmJhZmM5MGUyZjYwMyAx
MDA2NDQKLS0tIGEvdG9vbHMvaW5jbHVkZS94ZW4tdG9vbHMvbGlicy5oCisr
KyBiL3Rvb2xzL2luY2x1ZGUveGVuLXRvb2xzL2xpYnMuaApAQCAtNjMsNCAr
NjMsOCBAQAogI2RlZmluZSBST1VORFVQKF94LF93KSAoKCh1bnNpZ25lZCBs
b25nKShfeCkrKDFVTDw8KF93KSktMSkgJiB+KCgxVUw8PChfdykpLTEpKQog
I2VuZGlmCiAKKyNpZm5kZWYgX19tdXN0X2NoZWNrCisjZGVmaW5lIF9fbXVz
dF9jaGVjayBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f
KSkKKyNlbmRpZgorCiAjZW5kaWYJLyogX19YRU5fVE9PTFNfTElCU19fICov
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCA4NWMw
ZDJmMzhmYWMuLjA1MGQ2ZjY1MWFlOSAxMDA2NDQKLS0tIGEvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDYsNiArMTA2LDcgQEAgaW50IHF1b3Rh
X25iX3dhdGNoX3Blcl9kb21haW4gPSAxMjg7CiBpbnQgcXVvdGFfbWF4X2Vu
dHJ5X3NpemUgPSAyMDQ4OyAvKiAySyAqLwogaW50IHF1b3RhX21heF90cmFu
c2FjdGlvbiA9IDEwOwogaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlID0g
NTsKK2ludCBxdW90YV90cmFuc19ub2RlcyA9IDEwMjQ7CiBpbnQgcXVvdGFf
bWF4X3BhdGhfbGVuID0gWEVOU1RPUkVfUkVMX1BBVEhfTUFYOwogaW50IHF1
b3RhX3JlcV9vdXRzdGFuZGluZyA9IDIwOwogCkBAIC01NjAsNiArNTYxLDcg
QEAgc3RydWN0IG5vZGUgKnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCVREQl9EQVRBIGtleSwgZGF0YTsK
IAlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKIAlzdHJ1Y3Qgbm9k
ZSAqbm9kZTsKKwlpbnQgZXJyOwogCiAJbm9kZSA9IHRhbGxvYyhjdHgsIHN0
cnVjdCBub2RlKTsKIAlpZiAoIW5vZGUpIHsKQEAgLTU4MSwxNCArNTgzLDEz
IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlpZiAoZGF0YS5kcHRyID09IE5V
TEwpIHsKIAkJaWYgKHRkYl9lcnJvcih0ZGJfY3R4KSA9PSBUREJfRVJSX05P
RVhJU1QpIHsKIAkJCW5vZGUtPmdlbmVyYXRpb24gPSBOT19HRU5FUkFUSU9O
OwotCQkJYWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVB
RCwgTlVMTCk7Ci0JCQllcnJubyA9IEVOT0VOVDsKKwkJCWVyciA9IGFjY2Vz
c19ub2RlKGNvbm4sIG5vZGUsIE5PREVfQUNDRVNTX1JFQUQsIE5VTEwpOwor
CQkJZXJybm8gPSBlcnIgPyA6IEVOT0VOVDsKIAkJfSBlbHNlIHsKIAkJCWxv
ZygiVERCIGVycm9yIG9uIHJlYWQ6ICVzIiwgdGRiX2Vycm9yc3RyKHRkYl9j
dHgpKTsKIAkJCWVycm5vID0gRUlPOwogCQl9Ci0JCXRhbGxvY19mcmVlKG5v
ZGUpOwotCQlyZXR1cm4gTlVMTDsKKwkJZ290byBlcnJvcjsKIAl9CiAKIAlu
b2RlLT5wYXJlbnQgPSBOVUxMOwpAQCAtNjAzLDE5ICs2MDQsMzYgQEAgc3Ry
dWN0IG5vZGUgKnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3Qgdm9pZCAqY3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVj
dCB4c19wZXJtaXNzaW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5w
ZXJtczsKLQlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKSB7Ci0JCXRhbGxvY19mcmVlKG5vZGUpOwotCQlyZXR1cm4gTlVMTDsK
LQl9CisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhjb25uLCBub2Rl
KSkKKwkJZ290byBlcnJvcjsKIAogCS8qIERhdGEgaXMgYmluYXJ5IGJsb2Ig
KHVzdWFsbHkgYXNjaWksIG5vIG51bCkuICovCiAJbm9kZS0+ZGF0YSA9IG5v
ZGUtPnBlcm1zLnAgKyBoZHItPm51bV9wZXJtczsKIAkvKiBDaGlsZHJlbiBp
cyBzdHJpbmdzLCBudWwgc2VwYXJhdGVkLiAqLwogCW5vZGUtPmNoaWxkcmVu
ID0gbm9kZS0+ZGF0YSArIG5vZGUtPmRhdGFsZW47CiAKLQlhY2Nlc3Nfbm9k
ZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19SRUFELCBOVUxMKTsKKwlpZiAo
YWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVBRCwgTlVM
TCkpCisJCWdvdG8gZXJyb3I7CiAKIAlyZXR1cm4gbm9kZTsKKworIGVycm9y
OgorCWVyciA9IGVycm5vOworCXRhbGxvY19mcmVlKG5vZGUpOworCWVycm5v
ID0gZXJyOworCXJldHVybiBOVUxMOworfQorCitzdGF0aWMgYm9vbCByZWFk
X25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubyh2b2lkKQoreworCS8qCisJICog
MiBlcnJvciBjYXNlcyBmb3IgcmVhZF9ub2RlKCkgY2FuIGFsd2F5cyBiZSBw
cm9wYWdhdGVkIHVwOgorCSAqIEVOT01FTSwgYmVjYXVzZSB0aGlzIGhhcyBu
b3RoaW5nIHRvIGRvIHdpdGggdGhlIG5vZGUgYmVpbmcgaW4gdGhlCisJICog
ZGF0YSBiYXNlIG9yIG5vdCwgYnV0IGlzIGNhdXNlZCBieSBhIGdlbmVyYWwg
bGFjayBvZiBtZW1vcnkuCisJICogRU5PU1BDLCBiZWNhdXNlIHRoaXMgaXMg
cmVsYXRlZCB0byBoaXR0aW5nIHF1b3RhIGxpbWl0cyB3aGljaCBuZWVkCisJ
ICogdG8gYmUgcmVzcGVjdGVkLgorCSAqLworCXJldHVybiBlcnJubyA9PSBF
Tk9NRU0gfHwgZXJybm8gPT0gRU5PU1BDOwogfQogCiBpbnQgd3JpdGVfbm9k
ZV9yYXcoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXks
IHN0cnVjdCBub2RlICpub2RlLApAQCAtNzMyLDcgKzc1MCw3IEBAIHN0YXRp
YyBpbnQgYXNrX3BhcmVudHMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IHZvaWQgKmN0eCwKIAkJbm9kZSA9IHJlYWRfbm9kZShjb25uLCBjdHgs
IG5hbWUpOwogCQlpZiAobm9kZSkKIAkJCWJyZWFrOwotCQlpZiAoZXJybm8g
PT0gRU5PTUVNKQorCQlpZiAocmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSkKIAkJCXJldHVybiBlcnJubzsKIAl9IHdoaWxlICghc3RyZXEobmFt
ZSwgIi8iKSk7CiAKQEAgLTc5NSw3ICs4MTMsNyBAQCBzdGF0aWMgc3RydWN0
IG5vZGUgKmdldF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCQl9
CiAJfQogCS8qIENsZWFuIHVwIGVycm5vIGlmIHRoZXkgd2VyZW4ndCBzdXBw
b3NlZCB0byBrbm93LiAqLwotCWlmICghbm9kZSAmJiBlcnJubyAhPSBFTk9N
RU0pCisJaWYgKCFub2RlICYmICFyZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9l
cnJubygpKQogCQllcnJubyA9IGVycm5vX2Zyb21fcGFyZW50cyhjb25uLCBj
dHgsIG5hbWUsIGVycm5vLCBwZXJtKTsKIAlyZXR1cm4gbm9kZTsKIH0KQEAg
LTEyMDEsNyArMTIxOSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgbm9kZSAqY29uc3Ry
dWN0X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQg
KmN0eCwKIAogCS8qIElmIHBhcmVudCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUg
aXQuICovCiAJcGFyZW50ID0gcmVhZF9ub2RlKGNvbm4sIHBhcmVudG5hbWUs
IHBhcmVudG5hbWUpOwotCWlmICghcGFyZW50KQorCWlmICghcGFyZW50ICYm
IGVycm5vID09IEVOT0VOVCkKIAkJcGFyZW50ID0gY29uc3RydWN0X25vZGUo
Y29ubiwgY3R4LCBwYXJlbnRuYW1lKTsKIAlpZiAoIXBhcmVudCkKIAkJcmV0
dXJuIE5VTEw7CkBAIC0xNDc1LDcgKzE0OTMsNyBAQCBzdGF0aWMgaW50IF9y
bShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LCBz
dHJ1Y3Qgbm9kZSAqbm9kZSwKIAogCXBhcmVudCA9IHJlYWRfbm9kZShjb25u
LCBjdHgsIHBhcmVudG5hbWUpOwogCWlmICghcGFyZW50KQotCQlyZXR1cm4g
KGVycm5vID09IEVOT01FTSkgPyBFTk9NRU0gOiBFSU5WQUw7CisJCXJldHVy
biByZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubygpID8gZXJybm8gOiBF
SU5WQUw7CiAJbm9kZS0+cGFyZW50ID0gcGFyZW50OwogCiAJcmV0dXJuIGRl
bGV0ZV9ub2RlKGNvbm4sIGN0eCwgcGFyZW50LCBub2RlLCBmYWxzZSk7CkBA
IC0xNTA1LDcgKzE1MjMsNyBAQCBzdGF0aWMgaW50IGRvX3JtKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJ
CQkJcmV0dXJuIDA7CiAJCQl9CiAJCQkvKiBSZXN0b3JlIGVycm5vLCBqdXN0
IGluIGNhc2UuICovCi0JCQlpZiAoZXJybm8gIT0gRU5PTUVNKQorCQkJaWYg
KCFyZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubygpKQogCQkJCWVycm5v
ID0gRU5PRU5UOwogCQl9CiAJCXJldHVybiBlcnJubzsKQEAgLTIyODIsNiAr
MjMwMCw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtTSwgLS1w
YXRoLW1heCA8Y2hhcnM+ICBsaW1pdCB0aGUgYWxsb3dlZCBYZW5zdG9yZSBu
b2RlIHBhdGggbGVuZ3RoLFxuIgogIiAgLVEsIC0tcXVvdGEgPHdoYXQ+PTxu
Yj4gc2V0IHRoZSBxdW90YSA8d2hhdD4gdG8gdGhlIHZhbHVlIDxuYj4sIGFs
bG93ZWRcbiIKICIgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RhcyBh
cmU6XG4iCisiICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlv
bi1ub2RlczogbnVtYmVyIG9mIGFjY2Vzc2VkIG5vZGUgcGVyXG4iCisiICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJh
bnNhY3Rpb25cbiIKICIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0
YW5kaW5nOiBudW1iZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKICIg
IC13LCAtLXRpbWVvdXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGlt
ZW91dCBpbiBzZWNvbmRzIGZvciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAg
ICAgICAgICAgICAgICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6
XG4iCkBAIC0yMzY3LDYgKzIzODcsOCBAQCBzdGF0aWMgdm9pZCBzZXRfcXVv
dGEoY29uc3QgY2hhciAqYXJnKQogCXZhbCA9IGdldF9vcHR2YWxfaW50KGVx
ICsgMSk7CiAJaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFuZGluZyIp
KQogCQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7CisJZWxzZSBpZiAo
d2hhdF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikpCisJCXF1
b3RhX3RyYW5zX25vZGVzID0gdmFsOwogCWVsc2UKIAkJYmFyZigidW5rbm93
biBxdW90YSBcIiVzXCJcbiIsIGFyZyk7CiB9CmRpZmYgLS1naXQgYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuaAppbmRleCBjMGEwNTZjZTEzZmUuLjFiM2JkNWNh
NTYzYSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBA
IC0yNjEsNiArMjYxLDcgQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0
ZXJuIGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRy
eV9wZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRp
bmc7CitleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOwogCiBleHRlcm4g
dW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9u
LmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpp
bmRleCA4NmNhZjZjMzk4YmUuLjdiZDQxZWI0NzVlMyAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKQEAgLTE1
Niw2ICsxNTYsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBDb25uZWN0
aW9uLWxvY2FsIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNhY3Rpb24uICov
CiAJdWludDMyX3QgaWQ7CiAKKwkvKiBOb2RlIGNvdW50ZXIuICovCisJdW5z
aWduZWQgaW50IG5vZGVzOworCiAJLyogR2VuZXJhdGlvbiB3aGVuIHRyYW5z
YWN0aW9uIHN0YXJ0ZWQuICovCiAJdWludDY0X3QgZ2VuZXJhdGlvbjsKIApA
QCAtMjYwLDYgKzI2MywxMSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogCiAJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZSh0cmFucywgbm9kZS0+bmFtZSk7CiAJaWYgKCFp
KSB7CisJCWlmICh0cmFucy0+bm9kZXMgPj0gcXVvdGFfdHJhbnNfbm9kZXMg
JiYKKwkJICAgIGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikpIHsKKwkJ
CXJldCA9IEVOT1NQQzsKKwkJCWdvdG8gZXJyOworCQl9CiAJCWkgPSB0YWxs
b2NfemVybyh0cmFucywgc3RydWN0IGFjY2Vzc2VkX25vZGUpOwogCQlpZiAo
IWkpCiAJCQlnb3RvIG5vbWVtOwpAQCAtMjk3LDYgKzMwNSw3IEBAIGludCBh
Y2Nlc3Nfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5v
ZGUgKm5vZGUsCiAJCQkJaS0+dGFfbm9kZSA9IHRydWU7CiAJCQl9CiAJCX0K
KwkJdHJhbnMtPm5vZGVzKys7CiAJCWxpc3RfYWRkX3RhaWwoJmktPmxpc3Qs
ICZ0cmFucy0+YWNjZXNzZWQpOwogCX0KIApkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmggYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uaAppbmRleCAwMDkzY2FjODA3
ZTMuLmUzY2JkNmIyMzA5NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKKysrIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKQEAgLTM5LDggKzM5LDggQEAgdm9p
ZCB0cmFuc2FjdGlvbl9lbnRyeV9pbmMoc3RydWN0IHRyYW5zYWN0aW9uICp0
cmFucywgdW5zaWduZWQgaW50IGRvbWlkKTsKIHZvaWQgdHJhbnNhY3Rpb25f
ZW50cnlfZGVjKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVk
IGludCBkb21pZCk7CiAKIC8qIFRoaXMgbm9kZSB3YXMgYWNjZXNzZWQuICov
Ci1pbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlLAotICAgICAgICAgICAgICAgIGVudW0gbm9kZV9h
Y2Nlc3NfdHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKK2ludCBfX211c3Rf
Y2hlY2sgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBlbnVtIG5vZGVfYWNjZXNzX3R5cGUgdHlwZSwgVERCX0RBVEEgKmtleSk7
CiAKIC8qIFF1ZXVlIHdhdGNoZXMgZm9yIGEgbW9kaWZpZWQgbm9kZS4gKi8K
IHZvaWQgcXVldWVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqbmFtZSwgYm9vbCB3YXRjaF9leGFjdCk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-10.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-10.patch"
Content-Transfer-Encoding: base64

RnJvbSA3MzI3ODA2YTgzMDcxYWY0MTA1ZThjMzIzY2NlYTViNGQ0MzlkZGM4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1vdmUgdGhl
IGNhbGwgb2Ygc2V0dXBfc3RydWN0dXJlKCkgdG8gZG9tMAogaW50cm9kdWN0
aW9uCgpTZXR0aW5nIHVwIHRoZSBiYXNpYyBzdHJ1Y3R1cmUgd2hlbiBpbnRy
b2R1Y2luZyBkb20wIGhhcyB0aGUgYWR2YW50YWdlCnRvIGJlIGFibGUgdG8g
YWRkIHByb3BlciBub2RlIG1lbW9yeSBhY2NvdW50aW5nIGZvciB0aGUgYWRk
ZWQgbm9kZXMKbGF0ZXIuCgpUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIGRv
IHByb3BlciBub2RlIGFjY291bnRpbmcsIHRvby4KCkFuIGFkZGl0aW9uYWwg
cmVxdWlyZW1lbnQgdG8gbWFrZSB0aGF0IHdvcmsgZmluZSBpcyB0byBjb3Jy
ZWN0IHRoZQpvd25lciBvZiB0aGUgY3JlYXRlZCBub2RlcyB0byBiZSBkb20w
X2RvbWlkIGluc3RlYWQgb2YgZG9taWQgMC4KClRoaXMgaXMgcGFydCBvZiBY
U0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMK
aW5kZXggMDUwZDZmNjUxYWU5Li41MWFmNzQzOTBjYmUgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtMTk0MCw3ICsxOTQwLDgg
QEAgc3RhdGljIGludCB0ZGJfZmxhZ3M7CiBzdGF0aWMgdm9pZCBtYW51YWxf
bm9kZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFyICpjaGlsZCkKIHsK
IAlzdHJ1Y3Qgbm9kZSAqbm9kZTsKLQlzdHJ1Y3QgeHNfcGVybWlzc2lvbnMg
cGVybXMgPSB7IC5pZCA9IDAsIC5wZXJtcyA9IFhTX1BFUk1fTk9ORSB9Owor
CXN0cnVjdCB4c19wZXJtaXNzaW9ucyBwZXJtcyA9IHsgLmlkID0gZG9tMF9k
b21pZCwKKwkJCQkJLnBlcm1zID0gWFNfUEVSTV9OT05FIH07CiAKIAlub2Rl
ID0gdGFsbG9jX3plcm8oTlVMTCwgc3RydWN0IG5vZGUpOwogCWlmICghbm9k
ZSkKQEAgLTE5NzksNyArMTk4MCw3IEBAIHN0YXRpYyB2b2lkIHRkYl9sb2dn
ZXIoVERCX0NPTlRFWFQgKnRkYiwgaW50IGxldmVsLCBjb25zdCBjaGFyICog
Zm10LCAuLi4pCiAJfQogfQogCi1zdGF0aWMgdm9pZCBzZXR1cF9zdHJ1Y3R1
cmUoYm9vbCBsaXZlX3VwZGF0ZSkKK3ZvaWQgc2V0dXBfc3RydWN0dXJlKGJv
b2wgbGl2ZV91cGRhdGUpCiB7CiAJY2hhciAqdGRibmFtZTsKIApAQCAtMjAw
Miw2ICsyMDAzLDcgQEAgc3RhdGljIHZvaWQgc2V0dXBfc3RydWN0dXJlKGJv
b2wgbGl2ZV91cGRhdGUpCiAJCW1hbnVhbF9ub2RlKCIvIiwgInRvb2wiKTsK
IAkJbWFudWFsX25vZGUoIi90b29sIiwgInhlbnN0b3JlZCIpOwogCQltYW51
YWxfbm9kZSgiL3Rvb2wveGVuc3RvcmVkIiwgTlVMTCk7CisJCWRvbWFpbl9l
bnRyeV9maXgoZG9tMF9kb21pZCwgMywgdHJ1ZSk7CiAJfQogCiAJY2hlY2tf
c3RvcmUoKTsKQEAgLTI1MTIsOSArMjUxNCw2IEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAKIAlpbml0X3BpcGUocmVvcGVuX2xvZ19w
aXBlKTsKIAotCS8qIFNldHVwIHRoZSBkYXRhYmFzZSAqLwotCXNldHVwX3N0
cnVjdHVyZShsaXZlX3VwZGF0ZSk7Ci0KIAkvKiBMaXN0ZW4gdG8gaHlwZXJ2
aXNvci4gKi8KIAlpZiAoIW5vX2RvbWFpbl9pbml0ICYmICFsaXZlX3VwZGF0
ZSkgewogCQlkb21haW5faW5pdCgtMSk7CmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAppbmRleCAxYjNiZDVjYTU2M2EuLjQ1OTY5OGQ4NDA3
YSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUu
aAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0y
MjQsNiArMjI0LDcgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qgbm9kZSAqbm9k
ZSwKIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAkJICAgICAgIGNvbnN0IGNoYXIg
Km5hbWUpOwogCit2b2lkIHNldHVwX3N0cnVjdHVyZShib29sIGxpdmVfdXBk
YXRlKTsKIHN0cnVjdCBjb25uZWN0aW9uICpuZXdfY29ubmVjdGlvbihjb25u
d3JpdGVmbl90ICp3cml0ZSwgY29ubnJlYWRmbl90ICpyZWFkKTsKIHN0cnVj
dCBjb25uZWN0aW9uICpnZXRfY29ubmVjdGlvbl9ieV9pZCh1bnNpZ25lZCBp
bnQgY29ubl9pZCk7CiB2b2lkIGNoZWNrX3N0b3JlKHZvaWQpOwpkaWZmIC0t
Z2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDNjMjc5NzNm
YjgzNi4uMGRkNzVhNmEyMTk0IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5jCkBAIC00NzYsNiArNDc2LDkgQEAgc3RhdGljIHN0
cnVjdCBkb21haW4gKmludHJvZHVjZV9kb21haW4oY29uc3Qgdm9pZCAqY3R4
LAogCQl9CiAJCWRvbWFpbi0+aW50ZXJmYWNlID0gaW50ZXJmYWNlOwogCisJ
CWlmIChpc19tYXN0ZXJfZG9tYWluKQorCQkJc2V0dXBfc3RydWN0dXJlKHJl
c3RvcmUpOworCiAJCS8qIE5vdyBkb21haW4gYmVsb25ncyB0byBpdHMgY29u
bmVjdGlvbi4gKi8KIAkJdGFsbG9jX3N0ZWFsKGRvbWFpbi0+Y29ubiwgZG9t
YWluKTsKIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-11.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-11.patch"
Content-Transfer-Encoding: base64

RnJvbSBlOWRkNjA1MzhhYmU3MTkzZWFmMmM1ZWI3MmNjMWYxODc0OWU3YzFh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBpbmZy
YXN0cnVjdHVyZSB0byBrZWVwIHRyYWNrIG9mIHBlciBkb21haW4gbWVtb3J5
CiB1c2FnZQoKVGhlIGFtb3VudCBvZiBtZW1vcnkgYSBkb21haW4gY2FuIGNv
bnN1bWUgaW4gWGVuc3RvcmUgaXMgbGltaXRlZCBieQp2YXJpb3VzIHF1b3Rh
IHRvZGF5LCBidXQgZXZlbiB3aXRoIHNhbmUgcXVvdGEgYSBkb21haW4gY2Fu
IHN0aWxsCmNvbnN1bWUgcmF0aGVyIGxhcmdlIG1lbW9yeSBxdWFudGl0aWVz
LgoKQWRkIHRoZSBpbmZyYXN0cnVjdHVyZSBmb3Iga2VlcGluZyB0cmFjayBv
ZiB0aGUgYW1vdW50IG9mIG1lbW9yeSBhCmRvbWFpbiBpcyBjb25zdW1pbmcg
aW4gWGVuc3RvcmUuIE5vdGUgdGhhdCB0aGlzIGlzIG9ubHkgdGhlIG1lbW9y
eSBhCmRvbWFpbiBoYXMgZGlyZWN0IGNvbnRyb2wgb3Zlciwgc28gYW55IGlu
dGVybmFsIGFkbWluaXN0cmF0aW9uIGRhdGEKbmVlZGVkIGJ5IFhlbnN0b3Jl
IG9ubHkgaXMgbm90IGJlaW5nIGFjY291bnRlZCBmb3IuCgpUaGVyZSBhcmUg
dHdvIHF1b3RhcyBkZWZpbmVkOiBhIHNvZnQgcXVvdGEgd2hpY2ggd2lsbCBy
ZXN1bHQgaW4gYQp3YXJuaW5nIGlzc3VlZCB2aWEgc3lzbG9nKCkgd2hlbiBp
dCBpcyBleGNlZWRlZCwgYW5kIGEgaGFyZCBxdW90YQpyZXN1bHRpbmcgaW4g
YSBzdG9wIG9mIGFjY2VwdGluZyBmdXJ0aGVyIHJlcXVlc3RzIG9yIHdhdGNo
IGV2ZW50cyBhcwpsb25nIGFzIHRoZSBoYXJkIHF1b3RhIHdvdWxkIGJlIHZp
b2xhdGVkIGJ5IGFjY2VwdGluZyB0aG9zZS4KClNldHRpbmcgYW55IG9mIHRo
b3NlIHF1b3RhcyB0byAwIHdpbGwgZGlzYWJsZSBpdC4KCkFzIGRlZmF1bHQg
dmFsdWVzIHVzZSAyTUIgcGVyIGRvbWFpbiBmb3IgdGhlIHNvZnQgbGltaXQg
KHRoaXMgYmFzaWNhbGx5CmNvdmVycyB0aGUgYWxsb3dlZCBjYXNlIHRvIGNy
ZWF0ZSAxMDAwIG5vZGVzIG5lZWRpbmcgMmtCIGVhY2gpLCBhbmQKMi41TUIg
Zm9yIHRoZSBoYXJkIGxpbWl0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA1MWFmNzQzOTBjYmUuLmVlYjBkODkzZThjMyAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDksNiArMTA5LDggQEAgaW50
IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlID0gNTsKIGludCBxdW90YV90cmFu
c19ub2RlcyA9IDEwMjQ7CiBpbnQgcXVvdGFfbWF4X3BhdGhfbGVuID0gWEVO
U1RPUkVfUkVMX1BBVEhfTUFYOwogaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZyA9IDIwOworaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX3NvZnQgPSAy
ICogMTAyNCAqIDEwMjQ7IC8qIDIgTUIgKi8KK2ludCBxdW90YV9tZW1vcnlf
cGVyX2RvbWFpbl9oYXJkID0gMiAqIDEwMjQgKiAxMDI0ICsgNTEyICogMTAy
NDsgLyogMi41IE1CICovCiAKIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNo
X2V2ZW50X21zZWMgPSAyMDAwMDsKIApAQCAtMjMwNCw3ICsyMzA2LDE0IEBA
IHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICBxdW90YXMgYXJlOlxuIgogIiAgICAgICAgICAgICAgICAgICAg
ICAgICAgdHJhbnNhY3Rpb24tbm9kZXM6IG51bWJlciBvZiBhY2Nlc3NlZCBu
b2RlIHBlclxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRyYW5zYWN0aW9uXG4iCisiICAgICAgICAgICAgICAg
ICAgICAgICAgICBtZW1vcnk6IHRvdGFsIHVzZWQgbWVtb3J5IHBlciBkb21h
aW4gZm9yIG5vZGVzLFxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0cmFuc2FjdGlvbnMsIHdhdGNoZXMgYW5kIHJlcXVlc3RzLCBh
Ym92ZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3
aGljaCBYZW5zdG9yZSB3aWxsIHN0b3AgdGFsa2luZyB0byBkb21haW5cbiIK
ICIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nOiBudW1i
ZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKKyIgIC1xLCAtLXF1b3Rh
LXNvZnQgPHdoYXQ+PTxuYj4gc2V0IGEgc29mdCBxdW90YSA8d2hhdD4gdG8g
dGhlIHZhbHVlIDxuYj4sXG4iCisiICAgICAgICAgICAgICAgICAgICAgICAg
ICBjYXVzaW5nIGEgd2FybmluZyB0byBiZSBpc3N1ZWQgdmlhIHN5c2xvZygp
IGlmIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQg
aXMgdmlvbGF0ZWQsIGFsbG93ZWQgcXVvdGFzIGFyZTpcbiIKKyIgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1lbW9yeTogc2VlIGFib3ZlXG4iCiAiICAt
dywgLS10aW1lb3V0IDx3aGF0Pj08c2Vjb25kcz4gICBzZXQgdGhlIHRpbWVv
dXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+LFxuIgogIiAgICAgICAgICAgICAg
ICAgICAgICAgICAgYWxsb3dlZCB0aW1lb3V0IGNhbmRpZGF0ZXMgYXJlOlxu
IgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2gtZXZlbnQ6IHRp
bWUgYSB3YXRjaC1ldmVudCBpcyBrZXB0IHBlbmRpbmdcbiIKQEAgLTIzMzEs
NiArMjM0MCw3IEBAIHN0YXRpYyBzdHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9
IHsKIAl7ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCiAJeyAicGF0aC1t
YXgiLCAxLCBOVUxMLCAnTScgfSwKIAl7ICJxdW90YSIsIDEsIE5VTEwsICdR
JyB9LAorCXsgInF1b3RhLXNvZnQiLCAxLCBOVUxMLCAncScgfSwKIAl7ICJ0
aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAw
LCBOVUxMLCAnUicgfSwKIAl7ICJpbnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJ
JyB9LApAQCAtMjM3OSw3ICsyMzg5LDcgQEAgc3RhdGljIHZvaWQgc2V0X3Rp
bWVvdXQoY29uc3QgY2hhciAqYXJnKQogCQliYXJmKCJ1bmtub3duIHRpbWVv
dXQgXCIlc1wiXG4iLCBhcmcpOwogfQogCi1zdGF0aWMgdm9pZCBzZXRfcXVv
dGEoY29uc3QgY2hhciAqYXJnKQorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNv
bnN0IGNoYXIgKmFyZywgYm9vbCBzb2Z0KQogewogCWNvbnN0IGNoYXIgKmVx
ID0gc3RyY2hyKGFyZywgJz0nKTsKIAlpbnQgdmFsOwpAQCAtMjM4NywxMSAr
MjM5NywxNiBAQCBzdGF0aWMgdm9pZCBzZXRfcXVvdGEoY29uc3QgY2hhciAq
YXJnKQogCWlmICghZXEpCiAJCWJhcmYoInF1b3RhcyBtdXN0IGJlIHNwZWNp
ZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOwogCXZhbCA9IGdldF9vcHR2YWxf
aW50KGVxICsgMSk7Ci0JaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFu
ZGluZyIpKQorCWlmICh3aGF0X21hdGNoZXMoYXJnLCAib3V0c3RhbmRpbmci
KSAmJiAhc29mdCkKIAkJcXVvdGFfcmVxX291dHN0YW5kaW5nID0gdmFsOwot
CWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlvbi1ub2Rl
cyIpKQorCWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlv
bi1ub2RlcyIpICYmICFzb2Z0KQogCQlxdW90YV90cmFuc19ub2RlcyA9IHZh
bDsKLQllbHNlCisJZWxzZSBpZiAod2hhdF9tYXRjaGVzKGFyZywgIm1lbW9y
eSIpKSB7CisJCWlmIChzb2Z0KQorCQkJcXVvdGFfbWVtb3J5X3Blcl9kb21h
aW5fc29mdCA9IHZhbDsKKwkJZWxzZQorCQkJcXVvdGFfbWVtb3J5X3Blcl9k
b21haW5faGFyZCA9IHZhbDsKKwl9IGVsc2UKIAkJYmFyZigidW5rbm93biBx
dW90YSBcIiVzXCJcbiIsIGFyZyk7CiB9CiAKQEAgLTI0MDksNyArMjQyNCw3
IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAJb3JpZ19h
cmdjID0gYXJnYzsKIAlvcmlnX2FyZ3YgPSBhcmd2OwogCi0Jd2hpbGUgKChv
cHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6QTpN
OlE6VDpSVlc6dzpVIiwKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFy
Z2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06UTpxOlQ6UlZXOnc6VSIsCiAJ
CQkJICBvcHRpb25zLCBOVUxMKSkgIT0gLTEpIHsKIAkJc3dpdGNoIChvcHQp
IHsKIAkJY2FzZSAnRCc6CkBAIC0yNDU5LDcgKzI0NzQsMTAgQEAgaW50IG1h
aW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCQkJCSBxdW90YV9tYXhf
cGF0aF9sZW4pOwogCQkJYnJlYWs7CiAJCWNhc2UgJ1EnOgotCQkJc2V0X3F1
b3RhKG9wdGFyZyk7CisJCQlzZXRfcXVvdGEob3B0YXJnLCBmYWxzZSk7CisJ
CQlicmVhazsKKwkJY2FzZSAncSc6CisJCQlzZXRfcXVvdGEob3B0YXJnLCB0
cnVlKTsKIAkJCWJyZWFrOwogCQljYXNlICd3JzoKIAkJCXNldF90aW1lb3V0
KG9wdGFyZyk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApp
bmRleCA0NTk2OThkODQwN2EuLjJmYjM3ZGJmZTg0NyAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0yNjMsNiArMjYzLDggQEAg
ZXh0ZXJuIGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9l
bnRyeV9wZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3Rh
bmRpbmc7CiBleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOworZXh0ZXJu
IGludCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0OworZXh0ZXJuIGlu
dCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkOwogCiBleHRlcm4gdW5z
aWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0t
Z2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDBkZDc1YTZh
MjE5NC4uZWM1NDJkZjZhNjdlIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5jCkBAIC03Niw2ICs3NiwxMyBAQCBzdHJ1Y3QgZG9t
YWluCiAJLyogbnVtYmVyIG9mIGVudHJ5IGZyb20gdGhpcyBkb21haW4gaW4g
dGhlIHN0b3JlICovCiAJaW50IG5iZW50cnk7CiAKKwkvKiBBbW91bnQgb2Yg
bWVtb3J5IGFsbG9jYXRlZCBmb3IgdGhpcyBkb21haW4uICovCisJaW50IG1l
bW9yeTsKKwlib29sIHNvZnRfcXVvdGFfcmVwb3J0ZWQ7CisJYm9vbCBoYXJk
X3F1b3RhX3JlcG9ydGVkOworCXRpbWVfdCBtZW1fbGFzdF9tc2c7CisjZGVm
aW5lIE1FTV9XQVJOX01JTlRJTUVfU0VDIDEwCisKIAkvKiBudW1iZXIgb2Yg
d2F0Y2ggZm9yIHRoaXMgZG9tYWluICovCiAJaW50IG5id2F0Y2g7CiAKQEAg
LTI5Niw2ICszMDMsOSBAQCBib29sIGRvbWFpbl9jYW5fcmVhZChzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubikKIAkJCXJldHVybiBmYWxzZTsKIAkJaWYgKGNv
bm4tPmRvbWFpbi0+bmJvdXRzdGFuZGluZyA+PSBxdW90YV9yZXFfb3V0c3Rh
bmRpbmcpCiAJCQlyZXR1cm4gZmFsc2U7CisJCWlmIChjb25uLT5kb21haW4t
Pm1lbW9yeSA+PSBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkICYmCisJ
CSAgICBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkKQorCQkJcmV0dXJu
IGZhbHNlOwogCX0KIAogCWlmIChjb25uLT5pc19pZ25vcmVkKQpAQCAtOTU2
LDYgKzk2Niw4OSBAQCBpbnQgZG9tYWluX2VudHJ5KHN0cnVjdCBjb25uZWN0
aW9uICpjb25uKQogCQk6IDA7CiB9CiAKK3N0YXRpYyBib29sIGRvbWFpbl9j
aGtfcXVvdGEoc3RydWN0IGRvbWFpbiAqZG9tYWluLCBpbnQgbWVtKQorewor
CXRpbWVfdCBub3c7CisKKwlpZiAoIWRvbWFpbiB8fCAhZG9taWRfaXNfdW5w
cml2aWxlZ2VkKGRvbWFpbi0+ZG9taWQpIHx8CisJICAgIChkb21haW4tPmNv
bm4gJiYgZG9tYWluLT5jb25uLT5pc19pZ25vcmVkKSkKKwkJcmV0dXJuIGZh
bHNlOworCisJbm93ID0gdGltZShOVUxMKTsKKworCWlmIChtZW0gPj0gcXVv
dGFfbWVtb3J5X3Blcl9kb21haW5faGFyZCAmJgorCSAgICBxdW90YV9tZW1v
cnlfcGVyX2RvbWFpbl9oYXJkKSB7CisJCWlmIChkb21haW4tPmhhcmRfcXVv
dGFfcmVwb3J0ZWQpCisJCQlyZXR1cm4gdHJ1ZTsKKwkJc3lzbG9nKExPR19F
UlIsICJEb21haW4gJXUgZXhjZWVkcyBoYXJkIG1lbW9yeSBxdW90YSwgWGVu
c3RvcmUgaW50ZXJmYWNlIHRvIGRvbWFpbiBzdGFsbGVkXG4iLAorCQkgICAg
ICAgZG9tYWluLT5kb21pZCk7CisJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0g
bm93OworCQlkb21haW4tPmhhcmRfcXVvdGFfcmVwb3J0ZWQgPSB0cnVlOwor
CQlyZXR1cm4gdHJ1ZTsKKwl9CisKKwlpZiAobm93IC0gZG9tYWluLT5tZW1f
bGFzdF9tc2cgPj0gTUVNX1dBUk5fTUlOVElNRV9TRUMpIHsKKwkJaWYgKGRv
bWFpbi0+aGFyZF9xdW90YV9yZXBvcnRlZCkgeworCQkJZG9tYWluLT5tZW1f
bGFzdF9tc2cgPSBub3c7CisJCQlkb21haW4tPmhhcmRfcXVvdGFfcmVwb3J0
ZWQgPSBmYWxzZTsKKwkJCXN5c2xvZyhMT0dfSU5GTywgIkRvbWFpbiAldSBi
ZWxvdyBoYXJkIG1lbW9yeSBxdW90YSBhZ2FpblxuIiwKKwkJCSAgICAgICBk
b21haW4tPmRvbWlkKTsKKwkJfQorCQlpZiAobWVtID49IHF1b3RhX21lbW9y
eV9wZXJfZG9tYWluX3NvZnQgJiYKKwkJICAgIHF1b3RhX21lbW9yeV9wZXJf
ZG9tYWluX3NvZnQgJiYKKwkJICAgICFkb21haW4tPnNvZnRfcXVvdGFfcmVw
b3J0ZWQpIHsKKwkJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93OworCQkJ
ZG9tYWluLT5zb2Z0X3F1b3RhX3JlcG9ydGVkID0gdHJ1ZTsKKwkJCXN5c2xv
ZyhMT0dfV0FSTklORywgIkRvbWFpbiAldSBleGNlZWRzIHNvZnQgbWVtb3J5
IHF1b3RhXG4iLAorCQkJICAgICAgIGRvbWFpbi0+ZG9taWQpOworCQl9CisJ
CWlmIChtZW0gPCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ICYmCisJ
CSAgICBkb21haW4tPnNvZnRfcXVvdGFfcmVwb3J0ZWQpIHsKKwkJCWRvbWFp
bi0+bWVtX2xhc3RfbXNnID0gbm93OworCQkJZG9tYWluLT5zb2Z0X3F1b3Rh
X3JlcG9ydGVkID0gZmFsc2U7CisJCQlzeXNsb2coTE9HX0lORk8sICJEb21h
aW4gJXUgYmVsb3cgc29mdCBtZW1vcnkgcXVvdGEgYWdhaW5cbiIsCisJCQkg
ICAgICAgZG9tYWluLT5kb21pZCk7CisJCX0KKworCX0KKworCXJldHVybiBm
YWxzZTsKK30KKworaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVkIGlu
dCBkb21pZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjaykKK3sKKwlz
dHJ1Y3QgZG9tYWluICpkb21haW47CisKKwlkb21haW4gPSBmaW5kX2RvbWFp
bl9zdHJ1Y3QoZG9taWQpOworCWlmIChkb21haW4pIHsKKwkJLyoKKwkJICog
ZG9tYWluX2Noa19xdW90YSgpIHdpbGwgcHJpbnQgd2FybmluZyBhbmQgYWxz
byBzdG9yZSB3aGV0aGVyCisJCSAqIHRoZSBzb2Z0L2hhcmQgcXVvdGEgaGFz
IGJlZW4gaGl0LiBTbyBjaGVjayBub19xdW90YV9jaGVjaworCQkgKiAqYWZ0
ZXIqLgorCQkgKi8KKwkJaWYgKGRvbWFpbl9jaGtfcXVvdGEoZG9tYWluLCBk
b21haW4tPm1lbW9yeSArIG1lbSkgJiYKKwkJICAgICFub19xdW90YV9jaGVj
aykKKwkJCXJldHVybiBFTk9NRU07CisJCWRvbWFpbi0+bWVtb3J5ICs9IG1l
bTsKKwl9IGVsc2UgeworCQkvKgorCQkgKiBUaGUgZG9tYWluIHRoZSBtZW1v
cnkgaXMgdG8gYmUgYWNjb3VudGVkIGZvciBzaG91bGQgYWx3YXlzCisJCSAq
IGV4aXN0LCBhcyBhY2NvdW50aW5nIGlzIGRvbmUgZWl0aGVyIGZvciBhIGRv
bWFpbiByZWxhdGVkIHRvCisJCSAqIHRoZSBjdXJyZW50IGNvbm5lY3Rpb24s
IG9yIGZvciB0aGUgZG9tYWluIG93bmluZyBhIG5vZGUKKwkJICogKHdoaWNo
IGlzIGFsd2F5cyBleGlzdGluZywgYXMgdGhlIG93bmVyIG9mIHRoZSBub2Rl
IGlzCisJCSAqIHRlc3RlZCB0byBleGlzdCBhbmQgcmVwbGFjZWQgYnkgZG9t
aWQgMCBpZiBub3QpLgorCQkgKiBTbyBub3QgZmluZGluZyB0aGUgcmVsYXRl
ZCBkb21haW4gTVVTVCBiZSBhbiBlcnJvciBpbiB0aGUKKwkJICogZGF0YSBi
YXNlLgorCQkgKi8KKwkJZXJybm8gPSBFTk9FTlQ7CisJCWNvcnJ1cHQoTlVM
TCwgIkFjY291bnRpbmcgY2FsbGVkIGZvciBub24tZXhpc3RpbmcgZG9tYWlu
ICV1XG4iLAorCQkJZG9taWQpOworCQlyZXR1cm4gRU5PRU5UOworCX0KKwor
CXJldHVybiAwOworfQorCiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4pCiB7CiAJaWYgKCFjb25uIHx8ICFjb25uLT5k
b21haW4pCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
aW5kZXggY2NlMTNkMTRmMDE2Li41NzFhYTQ2ZDE1OGUgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAorKysgYi90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY1LDYgKzY1LDI2
IEBAIGludCBkb21haW5fZW50cnlfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBzdHJ1Y3Qgbm9kZSAqKTsKIHZvaWQgZG9tYWluX2VudHJ5X2RlYyhz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKik7CiBpbnQg
ZG9tYWluX2VudHJ5X2ZpeCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBudW0s
IGJvb2wgdXBkYXRlKTsKIGludCBkb21haW5fZW50cnkoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pOworaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVk
IGludCBkb21pZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjayk7CisK
Ky8qCisgKiBkb21haW5fbWVtb3J5X2FkZF9jaGsoKTogdG8gYmUgdXNlZCB3
aGVuIG1lbW9yeSBxdW90YSBzaG91bGQgYmUgY2hlY2tlZC4KKyAqIE5vdCB0
byBiZSB1c2VkIHdoZW4gc3BlY2lmeWluZyBhIG5lZ2F0aXZlIG1lbSB2YWx1
ZSwgYXMgbG93ZXJpbmcgdGhlIHVzZWQKKyAqIG1lbW9yeSBzaG91bGQgYWx3
YXlzIGJlIGFsbG93ZWQuCisgKi8KK3N0YXRpYyBpbmxpbmUgaW50IGRvbWFp
bl9tZW1vcnlfYWRkX2Noayh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0p
Cit7CisJcmV0dXJuIGRvbWFpbl9tZW1vcnlfYWRkKGRvbWlkLCBtZW0sIGZh
bHNlKTsKK30KKy8qCisgKiBkb21haW5fbWVtb3J5X2FkZF9ub2NoaygpOiB0
byBiZSB1c2VkIHdoZW4gbWVtb3J5IHF1b3RhIHNob3VsZCBub3QgYmUKKyAq
IGNoZWNrZWQsIGUuZy4gd2hlbiBsb3dlcmluZyBtZW1vcnkgdXNhZ2UsIG9y
IGluIGFuIGVycm9yIGNhc2UgZm9yIHVuZG9pbmcKKyAqIGEgcHJldmlvdXMg
bWVtb3J5IGFkanVzdG1lbnQuCisgKi8KK3N0YXRpYyBpbmxpbmUgdm9pZCBk
b21haW5fbWVtb3J5X2FkZF9ub2Noayh1bnNpZ25lZCBpbnQgZG9taWQsIGlu
dCBtZW0pCit7CisJZG9tYWluX21lbW9yeV9hZGQoZG9taWQsIG1lbSwgdHJ1
ZSk7Cit9CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-12.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-12.patch"
Content-Transfer-Encoding: base64

RnJvbSA0YjQwMzI2OGQ5ZDA3OGE4YmZkMjk1YjZhNDM3MzVhOGNiZWQ5MzQx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3IgcmVzcG9uc2VzCgpBZGQgdGhlIG1lbW9yeSBh
Y2NvdW50aW5nIGZvciBxdWV1ZWQgcmVzcG9uc2VzLgoKSW4gY2FzZSBhZGRp
bmcgYSB3YXRjaCBldmVudCBmb3IgYSBndWVzdCBpcyBjYXVzaW5nIHRoZSBo
YXJkIG1lbW9yeQpxdW90YSBvZiB0aGF0IGd1ZXN0IHRvIGJlIHZpb2xhdGVk
LCB0aGUgZXZlbnQgaXMgZHJvcHBlZC4gVGhpcyB3aWxsCmVuc3VyZSB0aGF0
IGl0IGlzIGltcG9zc2libGUgdG8gZHJpdmUgYW5vdGhlciBndWVzdCBwYXN0
IGl0cyBtZW1vcnkKcXVvdGEgYnkgZ2VuZXJhdGluZyBpbnNhbmUgYW1vdW50
cyBvZiBldmVudHMgZm9yIHRoYXQgZ3Vlc3QuIFRoaXMgaXMKZXNwZWNpYWxs
eSBpbXBvcnRhbnQgZm9yIHByb3RlY3RpbmcgZHJpdmVyIGRvbWFpbnMgZnJv
bSB0aGF0IGF0dGFjawp2ZWN0b3IuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
NiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4g
R3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggZWViMGQ4OTNlOGMzLi4yZTAyYjU3N2M5
MTIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MjYwLDYgKzI2MCw4IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0
YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIC1vdXQtPmhkci5tc2cu
bGVuIC0gc2l6ZW9mKG91dC0+aGRyKSk7CisKIAlpZiAob3V0LT5oZHIubXNn
LnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKIAkJcmVxID0gb3V0LT5wZW5k
LnJlcTsKIAkJaWYgKHJlcSkgewpAQCAtOTA0LDExICs5MDYsMTQgQEAgdm9p
ZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhz
ZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAliZGF0YS0+dGltZW91dF9tc2VjID0g
MDsKIAliZGF0YS0+d2F0Y2hfZXZlbnQgPSBmYWxzZTsKIAotCWlmIChsZW4g
PD0gREVGQVVMVF9CVUZGRVJfU0laRSkKKwlpZiAobGVuIDw9IERFRkFVTFRf
QlVGRkVSX1NJWkUpIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZh
dWx0X2J1ZmZlcjsKLQllbHNlIHsKKwkJLyogRG9uJ3QgY2hlY2sgcXVvdGEs
IHBhdGggbWlnaHQgYmUgdXNlZCBmb3IgcmV0dXJuaW5nIGVycm9yLiAqLwor
CQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgbGVuICsgc2l6
ZW9mKGJkYXRhLT5oZHIpKTsKKwl9IGVsc2UgewogCQliZGF0YS0+YnVmZmVy
ID0gdGFsbG9jX2FycmF5KGJkYXRhLCBjaGFyLCBsZW4pOwotCQlpZiAoIWJk
YXRhLT5idWZmZXIpIHsKKwkJaWYgKCFiZGF0YS0+YnVmZmVyIHx8CisJCSAg
ICBkb21haW5fbWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVv
ZihiZGF0YS0+aGRyKSkpIHsKIAkJCXNlbmRfZXJyb3IoY29ubiwgRU5PTUVN
KTsKIAkJCXJldHVybjsKIAkJfQpAQCAtOTczLDYgKzk3OCwxMSBAQCB2b2lk
IHNlbmRfZXZlbnQoc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcSwgc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sCiAJCX0KIAl9CiAKKwlpZiAoZG9tYWluX21l
bW9yeV9hZGRfY2hrKGNvbm4tPmlkLCBsZW4gKyBzaXplb2YoYmRhdGEtPmhk
cikpKSB7CisJCXRhbGxvY19mcmVlKGJkYXRhKTsKKwkJcmV0dXJuOworCX0K
KwogCWlmICh0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMgJiYgZG9tYWluX2lz
X3VucHJpdmlsZWdlZChjb25uKSkgewogCQliZGF0YS0+dGltZW91dF9tc2Vj
ID0gZ2V0X25vd19tc2VjKCkgKyB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7
CiAJCWlmICghY29ubi0+dGltZW91dF9tc2VjKQpAQCAtMjk0MCw2ICsyOTUw
LDEyIEBAIHN0YXRpYyB2b2lkIGFkZF9idWZmZXJlZF9kYXRhKHN0cnVjdCBi
dWZmZXJlZF9kYXRhICpiZGF0YSwKIAkgKi8KIAlpZiAoYmRhdGEtPmhkci5t
c2cudHlwZSAhPSBYU19XQVRDSF9FVkVOVCkKIAkJZG9tYWluX291dHN0YW5k
aW5nX2luYyhjb25uKTsKKwkvKgorCSAqIFdlIGFyZSByZXN0b3JpbmcgdGhl
IHN0YXRlIGFmdGVyIExpdmUtVXBkYXRlIGFuZCB0aGUgbmV3IHF1b3RhIG1h
eQorCSAqIGJlIHNtYWxsZXIuIFNvIGlnbm9yZSBpdC4gVGhlIGxpbWl0IHdp
bGwgYmUgYXBwbGllZCBmb3IgYW55IHJlc291cmNlCisJICogYWZ0ZXIgdGhl
IHN0YXRlIGhhcyBiZWVuIGZ1bGx5IHJlc3RvcmVkLgorCSAqLworCWRvbWFp
bl9tZW1vcnlfYWRkX25vY2hrKGNvbm4tPmlkLCBsZW4gKyBzaXplb2YoYmRh
dGEtPmhkcikpOwogfQogCiB2b2lkIHJlYWRfc3RhdGVfYnVmZmVyZWRfZGF0
YShjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-13.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-13.patch"
Content-Transfer-Encoding: base64

RnJvbSA2MWI2NGM0NTc0MzFiZTBhNDQ0YjJhNzcxYjc2NmJhZDNlNWFiZjgy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igd2F0Y2hlcwoKQWRkIHRoZSBtZW1vcnkgYWNj
b3VudGluZyBmb3IgcmVnaXN0ZXJlZCB3YXRjaGVzLgoKV2hlbiBhIHNvY2tl
dCBjb25uZWN0aW9uIGlzIGRlc3Ryb3llZCwgdGhlIGFzc29jaWF0ZWQgd2F0
Y2hlcyBhcmUKcmVtb3ZlZCwgdG9vLiBJbiBvcmRlciB0byBrZWVwIG1lbW9y
eSBhY2NvdW50aW5nIGNvcnJlY3QgdGhlIHdhdGNoZXMKbXVzdCBiZSByZW1v
dmVkIGV4cGxpY2l0bHkgdmlhIGEgY2FsbCBvZiBjb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcygpIGZyb20KZGVzdHJveV9jb25uKCkuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggMmUwMmI1NzdjOTEyLi5i
MWE0NTc1OTI5YmQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwpAQCAtNDU3LDYgKzQ1Nyw3IEBAIHN0YXRpYyBpbnQgZGVzdHJveV9j
b25uKHZvaWQgKl9jb25uKQogCX0KIAogCWNvbm5fZnJlZV9idWZmZXJlZF9k
YXRhKGNvbm4pOworCWNvbm5fZGVsZXRlX2FsbF93YXRjaGVzKGNvbm4pOwog
CWxpc3RfZm9yX2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxp
c3QpCiAJCXJlcS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwppbmRleCAxZDY2NGUzZDZiNzIu
LjBkNTg1OGRmNWJkZCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX3dhdGNoLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X3dhdGNoLmMKQEAgLTIxMSw3ICsyMTEsNyBAQCBzdGF0aWMgaW50IGNoZWNr
X3dhdGNoX3BhdGgoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwKIH0KIAogc3RhdGljIHN0cnVjdCB3YXRjaCAqYWRkX3dhdGNo
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjaGFyICpwYXRoLCBjaGFyICp0
b2tlbiwKLQkJCSAgICAgICBib29sIHJlbGF0aXZlKQorCQkJICAgICAgIGJv
b2wgcmVsYXRpdmUsIGJvb2wgbm9fcXVvdGFfY2hlY2spCiB7CiAJc3RydWN0
IHdhdGNoICp3YXRjaDsKIApAQCAtMjIyLDYgKzIyMiw5IEBAIHN0YXRpYyBz
dHJ1Y3Qgd2F0Y2ggKmFkZF93YXRjaChzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgY2hhciAqcGF0aCwgY2hhciAqdG9rZW4sCiAJd2F0Y2gtPnRva2VuID0g
dGFsbG9jX3N0cmR1cCh3YXRjaCwgdG9rZW4pOwogCWlmICghd2F0Y2gtPm5v
ZGUgfHwgIXdhdGNoLT50b2tlbikKIAkJZ290byBub21lbTsKKwlpZiAoZG9t
YWluX21lbW9yeV9hZGQoY29ubi0+aWQsIHN0cmxlbihwYXRoKSArIHN0cmxl
bih0b2tlbiksCisJCQkgICAgICBub19xdW90YV9jaGVjaykpCisJCWdvdG8g
bm9tZW07CiAKIAlpZiAocmVsYXRpdmUpCiAJCXdhdGNoLT5yZWxhdGl2ZV9w
YXRoID0gZ2V0X2ltcGxpY2l0X3BhdGgoY29ubik7CkBAIC0yNjUsNyArMjY4
LDcgQEAgaW50IGRvX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBz
dHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJaWYgKGRvbWFpbl93YXRjaChj
b25uKSA+IHF1b3RhX25iX3dhdGNoX3Blcl9kb21haW4pCiAJCXJldHVybiBF
MkJJRzsKIAotCXdhdGNoID0gYWRkX3dhdGNoKGNvbm4sIHZlY1swXSwgdmVj
WzFdLCByZWxhdGl2ZSk7CisJd2F0Y2ggPSBhZGRfd2F0Y2goY29ubiwgdmVj
WzBdLCB2ZWNbMV0sIHJlbGF0aXZlLCBmYWxzZSk7CiAJaWYgKCF3YXRjaCkK
IAkJcmV0dXJuIGVycm5vOwogCkBAIC0yOTYsNiArMjk5LDggQEAgaW50IGRv
X3Vud2F0Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZm
ZXJlZF9kYXRhICppbikKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHdhdGNoLCAm
Y29ubi0+d2F0Y2hlcywgbGlzdCkgewogCQlpZiAoc3RyZXEod2F0Y2gtPm5v
ZGUsIG5vZGUpICYmIHN0cmVxKHdhdGNoLT50b2tlbiwgdmVjWzFdKSkgewog
CQkJbGlzdF9kZWwoJndhdGNoLT5saXN0KTsKKwkJCWRvbWFpbl9tZW1vcnlf
YWRkX25vY2hrKGNvbm4tPmlkLCAtc3RybGVuKHdhdGNoLT5ub2RlKSAtCisJ
CQkJCQkJICBzdHJsZW4od2F0Y2gtPnRva2VuKSk7CiAJCQl0YWxsb2NfZnJl
ZSh3YXRjaCk7CiAJCQlkb21haW5fd2F0Y2hfZGVjKGNvbm4pOwogCQkJc2Vu
ZF9hY2soY29ubiwgWFNfVU5XQVRDSCk7CkBAIC0zMTEsNiArMzE2LDggQEAg
dm9pZCBjb25uX2RlbGV0ZV9hbGxfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXdoaWxlICgod2F0Y2ggPSBsaXN0X3RvcCgmY29ubi0+
d2F0Y2hlcywgc3RydWN0IHdhdGNoLCBsaXN0KSkpIHsKIAkJbGlzdF9kZWwo
JndhdGNoLT5saXN0KTsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsoY29u
bi0+aWQsIC1zdHJsZW4od2F0Y2gtPm5vZGUpIC0KKwkJCQkJCSAgc3RybGVu
KHdhdGNoLT50b2tlbikpOwogCQl0YWxsb2NfZnJlZSh3YXRjaCk7CiAJCWRv
bWFpbl93YXRjaF9kZWMoY29ubik7CiAJfQpAQCAtMzczLDcgKzM4MCw3IEBA
IHZvaWQgcmVhZF9zdGF0ZV93YXRjaChjb25zdCB2b2lkICpjdHgsIGNvbnN0
IHZvaWQgKnN0YXRlKQogCWlmICghcGF0aCkKIAkJYmFyZigiYWxsb2NhdGlv
biBlcnJvciBmb3IgcmVhZCB3YXRjaCIpOwogCi0JaWYgKCFhZGRfd2F0Y2go
Y29ubiwgcGF0aCwgdG9rZW4sIHJlbGF0aXZlKSkKKwlpZiAoIWFkZF93YXRj
aChjb25uLCBwYXRoLCB0b2tlbiwgcmVsYXRpdmUsIHRydWUpKQogCQliYXJm
KCJlcnJvciBhZGRpbmcgd2F0Y2giKTsKIH0KIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-14.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-14.patch"
Content-Transfer-Encoding: base64

RnJvbSA4N2JmY2NhYzU3ZjlhZGRjMWE0NWViNzIyMmM1NDAyZTQ1ZDJhODhh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igbm9kZXMKCkFkZCB0aGUgbWVtb3J5IGFjY291
bnRpbmcgZm9yIFhlbnN0b3JlIG5vZGVzLiBJbiBvcmRlciB0byBtYWtlIHRo
aXMKbm90IHRvbyBjb21wbGljYXRlZCBhbGxvdyBmb3Igc29tZSBzbG9wcGlu
ZXNzIHdoZW4gd3JpdGluZyBub2Rlcy4gQW55CmhhcmQgcXVvdGEgdmlvbGF0
aW9uIHdpbGwgcmVzdWx0IGluIG5vIGZ1cnRoZXIgcmVxdWVzdHMgdG8gYmUg
YWNjZXB0ZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIy
LTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKaW5kZXggYjFhNDU3NTkyOWJkLi5mMjdkNWMwMTAxYmMgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNTU2LDYgKzU1Niwx
MTcgQEAgdm9pZCBzZXRfdGRiX2tleShjb25zdCBjaGFyICpuYW1lLCBUREJf
REFUQSAqa2V5KQogCWtleS0+ZHNpemUgPSBzdHJsZW4obmFtZSk7CiB9CiAK
K3N0YXRpYyB2b2lkIGdldF9hY2NfZGF0YShUREJfREFUQSAqa2V5LCBzdHJ1
Y3Qgbm9kZV9hY2NvdW50X2RhdGEgKmFjYykKK3sKKwlUREJfREFUQSBvbGRf
ZGF0YTsKKwlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKKworCWlm
IChhY2MtPm1lbW9yeSA8IDApIHsKKwkJb2xkX2RhdGEgPSB0ZGJfZmV0Y2go
dGRiX2N0eCwgKmtleSk7CisJCS8qIE5vIGNoZWNrIGZvciBlcnJvciwgYXMg
dGhlIG5vZGUgbWlnaHQgbm90IGV4aXN0LiAqLworCQlpZiAob2xkX2RhdGEu
ZHB0ciA9PSBOVUxMKSB7CisJCQlhY2MtPm1lbW9yeSA9IDA7CisJCX0gZWxz
ZSB7CisJCQloZHIgPSAodm9pZCAqKW9sZF9kYXRhLmRwdHI7CisJCQlhY2Mt
Pm1lbW9yeSA9IG9sZF9kYXRhLmRzaXplOworCQkJYWNjLT5kb21pZCA9IGhk
ci0+cGVybXNbMF0uaWQ7CisJCX0KKwkJdGFsbG9jX2ZyZWUob2xkX2RhdGEu
ZHB0cik7CisJfQorfQorCisvKgorICogUGVyLXRyYW5zYWN0aW9uIG5vZGVz
IG5lZWQgdG8gYmUgYWNjb3VudGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gb3du
ZXIuCisgKiBUaG9zZSBub2RlcyBhcmUgc3RvcmVkIGluIHRoZSBkYXRhIGJh
c2Ugd2l0aCB0aGUgdHJhbnNhY3Rpb24gZ2VuZXJhdGlvbgorICogY291bnQg
cHJlcGVuZGVkIChlLmcuIDEyMy9sb2NhbC9kb21haW4vLi4uKS4gU28gdGVz
dGluZyBmb3IgdGhlIG5vZGUncworICoga2V5IG5vdCB0byBzdGFydCB3aXRo
ICIvIiBpcyBzdWZmaWNpZW50LgorICovCitzdGF0aWMgdW5zaWduZWQgaW50
IGdldF9hY2NfZG9taWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9E
QVRBICprZXksCisJCQkJICB1bnNpZ25lZCBpbnQgZG9taWQpCit7CisJcmV0
dXJuICghY29ubiB8fCBrZXktPmRwdHJbMF0gPT0gJy8nKSA/IGRvbWlkIDog
Y29ubi0+aWQ7Cit9CisKK2ludCBkb190ZGJfd3JpdGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFREQl9EQVRBICpkYXRhLAor
CQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MsIGJvb2wgbm9fcXVv
dGFfY2hlY2spCit7CisJc3RydWN0IHhzX3RkYl9yZWNvcmRfaGRyICpoZHIg
PSAodm9pZCAqKWRhdGEtPmRwdHI7CisJc3RydWN0IG5vZGVfYWNjb3VudF9k
YXRhIG9sZF9hY2MgPSB7fTsKKwl1bnNpZ25lZCBpbnQgb2xkX2RvbWlkLCBu
ZXdfZG9taWQ7CisJaW50IHJldDsKKworCWlmICghYWNjKQorCQlvbGRfYWNj
Lm1lbW9yeSA9IC0xOworCWVsc2UKKwkJb2xkX2FjYyA9ICphY2M7CisKKwln
ZXRfYWNjX2RhdGEoa2V5LCAmb2xkX2FjYyk7CisJb2xkX2RvbWlkID0gZ2V0
X2FjY19kb21pZChjb25uLCBrZXksIG9sZF9hY2MuZG9taWQpOworCW5ld19k
b21pZCA9IGdldF9hY2NfZG9taWQoY29ubiwga2V5LCBoZHItPnBlcm1zWzBd
LmlkKTsKKworCS8qCisJICogRG9uJ3QgY2hlY2sgZm9yIEVOT0VOVCwgYXMg
d2Ugd2FudCB0byBiZSBhYmxlIHRvIHN3aXRjaCBvcnBoYW5lZAorCSAqIG5v
ZGVzIHRvIG5ldyBvd25lcnMuCisJICovCisJaWYgKG9sZF9hY2MubWVtb3J5
KQorCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRfZG9taWQsCisJCQkJ
CS1vbGRfYWNjLm1lbW9yeSAtIGtleS0+ZHNpemUpOworCXJldCA9IGRvbWFp
bl9tZW1vcnlfYWRkKG5ld19kb21pZCwgZGF0YS0+ZHNpemUgKyBrZXktPmRz
aXplLAorCQkJCW5vX3F1b3RhX2NoZWNrKTsKKwlpZiAocmV0KSB7CisJCS8q
IEVycm9yIHBhdGgsIHNvIG5vIHF1b3RhIGNoZWNrLiAqLworCQlpZiAob2xk
X2FjYy5tZW1vcnkpCisJCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRf
ZG9taWQsCisJCQkJCQlvbGRfYWNjLm1lbW9yeSArIGtleS0+ZHNpemUpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCS8qIFREQiBzaG91bGQgc2V0IGVycm5v
LCBidXQgZG9lc24ndCBldmVuIHNldCBlY29kZSBBRkFJQ1QuICovCisJaWYg
KHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCAqZGF0YSwgVERCX1JFUExBQ0Up
ICE9IDApIHsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsobmV3X2RvbWlk
LCAtZGF0YS0+ZHNpemUgLSBrZXktPmRzaXplKTsKKwkJLyogRXJyb3IgcGF0
aCwgc28gbm8gcXVvdGEgY2hlY2suICovCisJCWlmIChvbGRfYWNjLm1lbW9y
eSkKKwkJCWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKG9sZF9kb21pZCwKKwkJ
CQkJCW9sZF9hY2MubWVtb3J5ICsga2V5LT5kc2l6ZSk7CisJCWVycm5vID0g
RUlPOworCQlyZXR1cm4gZXJybm87CisJfQorCisJaWYgKGFjYykgeworCQkv
KiBEb24ndCB1c2UgbmV3X2RvbWlkLCBhcyBpdCBtaWdodCBiZSBhIHRyYW5z
YWN0aW9uIG5vZGUuICovCisJCWFjYy0+ZG9taWQgPSBoZHItPnBlcm1zWzBd
LmlkOworCQlhY2MtPm1lbW9yeSA9IGRhdGEtPmRzaXplOworCX0KKworCXJl
dHVybiAwOworfQorCitpbnQgZG9fdGRiX2RlbGV0ZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwKKwkJICBzdHJ1Y3Qgbm9kZV9h
Y2NvdW50X2RhdGEgKmFjYykKK3sKKwlzdHJ1Y3Qgbm9kZV9hY2NvdW50X2Rh
dGEgdG1wX2FjYzsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisKKwlpZiAoIWFj
YykgeworCQlhY2MgPSAmdG1wX2FjYzsKKwkJYWNjLT5tZW1vcnkgPSAtMTsK
Kwl9CisKKwlnZXRfYWNjX2RhdGEoa2V5LCBhY2MpOworCisJaWYgKHRkYl9k
ZWxldGUodGRiX2N0eCwgKmtleSkpIHsKKwkJZXJybm8gPSBFSU87CisJCXJl
dHVybiBlcnJubzsKKwl9CisKKwlpZiAoYWNjLT5tZW1vcnkpIHsKKwkJZG9t
aWQgPSBnZXRfYWNjX2RvbWlkKGNvbm4sIGtleSwgYWNjLT5kb21pZCk7CisJ
CWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKGRvbWlkLCAtYWNjLT5tZW1vcnkg
LSBrZXktPmRzaXplKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwogLyoKICAq
IElmIGl0IGZhaWxzLCByZXR1cm5zIE5VTEwgYW5kIHNldHMgZXJybm8uCiAg
KiBUZW1wb3JhcnkgbWVtb3J5IGFsbG9jYXRpb25zIHdpbGwgYmUgZG9uZSB3
aXRoIGN0eC4KQEAgLTYwOSw5ICs3MjAsMTUgQEAgc3RydWN0IG5vZGUgKnJl
YWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAq
Y3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVjdCB4c19wZXJtaXNz
aW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5wZXJtczsKKwlub2Rl
LT5hY2MuZG9taWQgPSBub2RlLT5wZXJtcy5wWzBdLmlkOworCW5vZGUtPmFj
Yy5tZW1vcnkgPSBkYXRhLmRzaXplOwogCWlmIChkb21haW5fYWRqdXN0X25v
ZGVfcGVybXMoY29ubiwgbm9kZSkpCiAJCWdvdG8gZXJyb3I7CiAKKwkvKiBJ
ZiBvd25lciBpcyBnb25lIHJlc2V0IGN1cnJlbnRseSBhY2NvdW50ZWQgbWVt
b3J5IHNpemUuICovCisJaWYgKG5vZGUtPmFjYy5kb21pZCAhPSBub2RlLT5w
ZXJtcy5wWzBdLmlkKQorCQlub2RlLT5hY2MubWVtb3J5ID0gMDsKKwogCS8q
IERhdGEgaXMgYmluYXJ5IGJsb2IgKHVzdWFsbHkgYXNjaWksIG5vIG51bCku
ICovCiAJbm9kZS0+ZGF0YSA9IG5vZGUtPnBlcm1zLnAgKyBoZHItPm51bV9w
ZXJtczsKIAkvKiBDaGlsZHJlbiBpcyBzdHJpbmdzLCBudWwgc2VwYXJhdGVk
LiAqLwpAQCAtNjgwLDEyICs3OTcsOSBAQCBpbnQgd3JpdGVfbm9kZV9yYXco
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIHN0cnVj
dCBub2RlICpub2RlLAogCXAgKz0gbm9kZS0+ZGF0YWxlbjsKIAltZW1jcHko
cCwgbm9kZS0+Y2hpbGRyZW4sIG5vZGUtPmNoaWxkbGVuKTsKIAotCS8qIFRE
QiBzaG91bGQgc2V0IGVycm5vLCBidXQgZG9lc24ndCBldmVuIHNldCBlY29k
ZSBBRkFJQ1QuICovCi0JaWYgKHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCBk
YXRhLCBUREJfUkVQTEFDRSkgIT0gMCkgewotCQljb3JydXB0KGNvbm4sICJX
cml0ZSBvZiAlcyBmYWlsZWQiLCBrZXktPmRwdHIpOwotCQllcnJubyA9IEVJ
TzsKLQkJcmV0dXJuIGVycm5vOwotCX0KKwlpZiAoZG9fdGRiX3dyaXRlKGNv
bm4sIGtleSwgJmRhdGEsICZub2RlLT5hY2MsIG5vX3F1b3RhX2NoZWNrKSkK
KwkJcmV0dXJuIEVJTzsKKwogCXJldHVybiAwOwogfQogCkBAIC0xMTg4LDcg
KzEzMDIsNyBAQCBzdGF0aWMgdm9pZCBkZWxldGVfbm9kZV9zaW5nbGUoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogCWlm
IChhY2Nlc3Nfbm9kZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19ERUxFVEUs
ICZrZXkpKQogCQlyZXR1cm47CiAKLQlpZiAodGRiX2RlbGV0ZSh0ZGJfY3R4
LCBrZXkpICE9IDApIHsKKwlpZiAoZG9fdGRiX2RlbGV0ZShjb25uLCAma2V5
LCAmbm9kZS0+YWNjKSAhPSAwKSB7CiAJCWNvcnJ1cHQoY29ubiwgIkNvdWxk
IG5vdCBkZWxldGUgJyVzJyIsIG5vZGUtPm5hbWUpOwogCQlyZXR1cm47CiAJ
fQpAQCAtMTI2MSw2ICsxMzc1LDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpj
b25zdHJ1Y3Rfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
dm9pZCAqY3R4LAogCS8qIE5vIGNoaWxkcmVuLCBubyBkYXRhICovCiAJbm9k
ZS0+Y2hpbGRyZW4gPSBub2RlLT5kYXRhID0gTlVMTDsKIAlub2RlLT5jaGls
ZGxlbiA9IG5vZGUtPmRhdGFsZW4gPSAwOworCW5vZGUtPmFjYy5tZW1vcnkg
PSAwOwogCW5vZGUtPnBhcmVudCA9IHBhcmVudDsKIAlyZXR1cm4gbm9kZTsK
IApAQCAtMTI2OSwxNyArMTM4NCwxNyBAQCBzdGF0aWMgc3RydWN0IG5vZGUg
KmNvbnN0cnVjdF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRpYyB2b2lk
IGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3Qgbm9kZSAqbm9kZSkKK3N0YXRpYyB2
b2lkIGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
c3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJaWYgKHN0cmVxKG5vZGUtPm5hbWUs
ICIvIikpCiAJCWNvcnJ1cHQoTlVMTCwgIkRlc3Ryb3lpbmcgcm9vdCBub2Rl
ISIpOwogCi0JdGRiX2RlbGV0ZSh0ZGJfY3R4LCBub2RlLT5rZXkpOworCWRv
X3RkYl9kZWxldGUoY29ubiwgJm5vZGUtPmtleSwgJm5vZGUtPmFjYyk7CiB9
CiAKIHN0YXRpYyBpbnQgZGVzdHJveV9ub2RlKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKLQlkZXN0cm95X25vZGVf
cm0obm9kZSk7CisJZGVzdHJveV9ub2RlX3JtKGNvbm4sIG5vZGUpOwogCWRv
bWFpbl9lbnRyeV9kZWMoY29ubiwgbm9kZSk7CiAKIAkvKgpAQCAtMTMzMSw3
ICsxNDQ2LDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpjcmVhdGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkv
KiBBY2NvdW50IGZvciBuZXcgbm9kZSAqLwogCQlpZiAoaS0+cGFyZW50KSB7
CiAJCQlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBpKSkgewotCQkJCWRl
c3Ryb3lfbm9kZV9ybShpKTsKKwkJCQlkZXN0cm95X25vZGVfcm0oY29ubiwg
aSk7CiAJCQkJcmV0dXJuIE5VTEw7CiAJCQl9CiAJCX0KQEAgLTIxOTIsNyAr
MjMwNyw3IEBAIHN0YXRpYyBpbnQgY2xlYW5fc3RvcmVfKFREQl9DT05URVhU
ICp0ZGIsIFREQl9EQVRBIGtleSwgVERCX0RBVEEgdmFsLAogCWlmICghaGFz
aHRhYmxlX3NlYXJjaChyZWFjaGFibGUsIG5hbWUpKSB7CiAJCWxvZygiY2xl
YW5fc3RvcmU6ICclcycgaXMgb3JwaGFuZWQhIiwgbmFtZSk7CiAJCWlmIChy
ZWNvdmVyeSkgewotCQkJdGRiX2RlbGV0ZSh0ZGIsIGtleSk7CisJCQlkb190
ZGJfZGVsZXRlKE5VTEwsICZrZXksIE5VTEwpOwogCQl9CiAJfQogCkBAIC0z
MDMwLDYgKzMxNDUsNyBAQCB2b2lkIHJlYWRfc3RhdGVfbm9kZShjb25zdCB2
b2lkICpjdHgsIGNvbnN0IHZvaWQgKnN0YXRlKQogCWlmICghbm9kZSkKIAkJ
YmFyZigiYWxsb2NhdGlvbiBlcnJvciByZXN0b3Jpbmcgbm9kZSIpOwogCisJ
bm9kZS0+YWNjLm1lbW9yeSA9IDA7CiAJbm9kZS0+bmFtZSA9IG5hbWU7CiAJ
bm9kZS0+Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAlub2RlLT5kYXRh
bGVuID0gc24tPmRhdGFfbGVuOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggMmZiMzdkYmZlODQ3Li41YzFiNTc0YmZmZTYgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMTY5LDYg
KzE2OSwxMSBAQCBzdHJ1Y3Qgbm9kZV9wZXJtcyB7CiAJc3RydWN0IHhzX3Bl
cm1pc3Npb25zICpwOwogfTsKIAorc3RydWN0IG5vZGVfYWNjb3VudF9kYXRh
IHsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisJaW50IG1lbW9yeTsJCS8qIC0x
IGlmIHVua25vd24gKi8KK307CisKIHN0cnVjdCBub2RlIHsKIAljb25zdCBj
aGFyICpuYW1lOwogCS8qIEtleSB1c2VkIHRvIHVwZGF0ZSBUREIgKi8KQEAg
LTE5MSw2ICsxOTYsOSBAQCBzdHJ1Y3Qgbm9kZSB7CiAJLyogQ2hpbGRyZW4s
IGVhY2ggbnVsLXRlcm1pbmF0ZWQuICovCiAJdW5zaWduZWQgaW50IGNoaWxk
bGVuOwogCWNoYXIgKmNoaWxkcmVuOworCisJLyogQWxsb2NhdGlvbiBpbmZv
cm1hdGlvbiBmb3Igbm9kZSBjdXJyZW50bHkgaW4gc3RvcmUuICovCisJc3Ry
dWN0IG5vZGVfYWNjb3VudF9kYXRhIGFjYzsKIH07CiAKIC8qIFJldHVybiB0
aGUgb25seSBhcmd1bWVudCBpbiB0aGUgaW5wdXQuICovCkBAIC0zMDAsNiAr
MzA4LDEwIEBAIGV4dGVybiB4ZW5nbnR0YWJfaGFuZGxlICoqeGd0X2hhbmRs
ZTsKIGludCByZW1lbWJlcl9zdHJpbmcoc3RydWN0IGhhc2h0YWJsZSAqaGFz
aCwgY29uc3QgY2hhciAqc3RyKTsKIAogdm9pZCBzZXRfdGRiX2tleShjb25z
dCBjaGFyICpuYW1lLCBUREJfREFUQSAqa2V5KTsKK2ludCBkb190ZGJfd3Jp
dGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFRE
Ql9EQVRBICpkYXRhLAorCQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICph
Y2MsIGJvb2wgbm9fcXVvdGFfY2hlY2spOworaW50IGRvX3RkYl9kZWxldGUo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksCisJCSAg
c3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MpOwogCiB2b2lkIGNvbm5f
ZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsK
IApkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5z
YWN0aW9uLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rp
b24uYwppbmRleCA3YmQ0MWViNDc1ZTMuLmFjZTlhMTFkNzdiYiAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMK
KysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMK
QEAgLTE1Myw2ICsxNTMsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBM
aXN0IG9mIGFsbCB0cmFuc2FjdGlvbnMgYWN0aXZlIG9uIHRoaXMgY29ubmVj
dGlvbi4gKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CiAKKwkvKiBDb25u
ZWN0aW9uIHRoaXMgdHJhbnNhY3Rpb24gaXMgYXNzb2NpYXRlZCB3aXRoLiAq
LworCXN0cnVjdCBjb25uZWN0aW9uICpjb25uOworCiAJLyogQ29ubmVjdGlv
bi1sb2NhbCBpZGVudGlmaWVyIGZvciB0aGlzIHRyYW5zYWN0aW9uLiAqLwog
CXVpbnQzMl90IGlkOwogCkBAIC0yODYsNiArMjg5LDggQEAgaW50IGFjY2Vz
c19ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAq
bm9kZSwKIAogCQlpbnRyb2R1Y2UgPSB0cnVlOwogCQlpLT50YV9ub2RlID0g
ZmFsc2U7CisJCS8qIGFjYy5tZW1vcnkgPCAwIG1lYW5zICJ1bmtub3duLCBn
ZXQgc2l6ZSBmcm9tIFREQiIuICovCisJCW5vZGUtPmFjYy5tZW1vcnkgPSAt
MTsKIAogCQkvKgogCQkgKiBBZGRpdGlvbmFsIHRyYW5zYWN0aW9uLXNwZWNp
ZmljIG5vZGUgZm9yIHJlYWQgdHlwZS4gV2Ugb25seQpAQCAtNDEwLDExICs0
MTUsMTEgQEAgc3RhdGljIGludCBmaW5hbGl6ZV90cmFuc2FjdGlvbihzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKIAkJCQkJZ290byBlcnI7CiAJCQkJaGRy
ID0gKHZvaWQgKilkYXRhLmRwdHI7CiAJCQkJaGRyLT5nZW5lcmF0aW9uID0g
KytnZW5lcmF0aW9uOwotCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJfY3R4LCBr
ZXksIGRhdGEsCi0JCQkJCQlUREJfUkVQTEFDRSk7CisJCQkJcmV0ID0gZG9f
dGRiX3dyaXRlKGNvbm4sICZrZXksICZkYXRhLCBOVUxMLAorCQkJCQkJICAg
dHJ1ZSk7CiAJCQkJdGFsbG9jX2ZyZWUoZGF0YS5kcHRyKTsKIAkJCX0gZWxz
ZSB7Ci0JCQkJcmV0ID0gdGRiX2RlbGV0ZSh0ZGJfY3R4LCBrZXkpOworCQkJ
CXJldCA9IGRvX3RkYl9kZWxldGUoY29ubiwgJmtleSwgTlVMTCk7CiAJCQl9
CiAJCQlpZiAocmV0KQogCQkJCWdvdG8gZXJyOwpAQCAtNDI1LDcgKzQzMCw3
IEBAIHN0YXRpYyBpbnQgZmluYWxpemVfdHJhbnNhY3Rpb24oc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sCiAJCQl9CiAJCX0KIAotCQlpZiAoaS0+dGFfbm9k
ZSAmJiB0ZGJfZGVsZXRlKHRkYl9jdHgsIHRhX2tleSkpCisJCWlmIChpLT50
YV9ub2RlICYmIGRvX3RkYl9kZWxldGUoY29ubiwgJnRhX2tleSwgTlVMTCkp
CiAJCQlnb3RvIGVycjsKIAkJbGlzdF9kZWwoJmktPmxpc3QpOwogCQl0YWxs
b2NfZnJlZShpKTsKQEAgLTQ1Myw3ICs0NTgsNyBAQCBzdGF0aWMgaW50IGRl
c3Ryb3lfdHJhbnNhY3Rpb24odm9pZCAqX3RyYW5zYWN0aW9uKQogCQkJCQkJ
CSAgICAgICBpLT5ub2RlKTsKIAkJCWlmICh0cmFuc19uYW1lKSB7CiAJCQkJ
c2V0X3RkYl9rZXkodHJhbnNfbmFtZSwgJmtleSk7Ci0JCQkJdGRiX2RlbGV0
ZSh0ZGJfY3R4LCBrZXkpOworCQkJCWRvX3RkYl9kZWxldGUodHJhbnMtPmNv
bm4sICZrZXksIE5VTEwpOwogCQkJfQogCQl9CiAJCWxpc3RfZGVsKCZpLT5s
aXN0KTsKQEAgLTQ5Nyw2ICs1MDIsNyBAQCBpbnQgZG9fdHJhbnNhY3Rpb25f
c3RhcnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJl
ZF9kYXRhICppbikKIAogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+YWNjZXNz
ZWQpOwogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+Y2hhbmdlZF9kb21haW5z
KTsKKwl0cmFucy0+Y29ubiA9IGNvbm47CiAJdHJhbnMtPmZhaWwgPSBmYWxz
ZTsKIAl0cmFucy0+Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-15.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-15.patch"
Content-Transfer-Encoding: base64

RnJvbSBmZWQ2MjkyNTljNjRkOTFkZmIyNmJkNDc4YzI2MGI2NmRmYWQ0ZGFl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBleHBv
cnRzIGZvciBxdW90YSB2YXJpYWJsZXMKClNvbWUgcXVvdGEgdmFyaWFibGVz
IGFyZSBub3QgZXhwb3J0ZWQgdmlhIGhlYWRlciBmaWxlcy4KClRoaXMgaXMg
cGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggNWMxYjU3NGJmZmU2Li4xZWIzNzA4ZjgyZGQgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjY4LDYg
KzI2OCwxMSBAQCBleHRlcm4gVERCX0NPTlRFWFQgKnRkYl9jdHg7CiBleHRl
cm4gaW50IGRvbTBfZG9taWQ7CiBleHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBl
eHRlcm4gaW50IHByaXZfZG9taWQ7CitleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CitleHRlcm4gaW50IHF1b3RhX21heF90cmFuc2Fj
dGlvbjsKK2V4dGVybiBpbnQgcXVvdGFfbWF4X2VudHJ5X3NpemU7CitleHRl
cm4gaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlOworZXh0ZXJuIGludCBx
dW90YV9tYXhfcGF0aF9sZW47CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5
X3Blcl9kb21haW47CiBleHRlcm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CmRpZmYgLS1naXQg
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGFj
ZTlhMTFkNzdiYi4uMjg3NzQ4MTNkZTgzIDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtMTc1LDcgKzE3
NSw2IEBAIHN0cnVjdCB0cmFuc2FjdGlvbgogCWJvb2wgZmFpbDsKIH07CiAK
LWV4dGVybiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uOwogdWludDY0X3Qg
Z2VuZXJhdGlvbjsKIAogc3RhdGljIHN0cnVjdCBhY2Nlc3NlZF9ub2RlICpm
aW5kX2FjY2Vzc2VkX25vZGUoc3RydWN0IHRyYW5zYWN0aW9uICp0cmFucywK
ZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggMGQ1
ODU4ZGY1YmRkLi40OTcwZTlmMWExYjkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF93YXRjaC5jCkBAIC0zMSw4ICszMSw2IEBACiAjaW5jbHVk
ZSAieGVuc3RvcmVkX2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90
cmFuc2FjdGlvbi5oIgogCi1leHRlcm4gaW50IHF1b3RhX25iX3dhdGNoX3Bl
cl9kb21haW47Ci0KIHN0cnVjdCB3YXRjaAogewogCS8qIFdhdGNoZXMgb24g
dGhpcyBjb25uZWN0aW9uICovCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.15-xenstored-16.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.15-xenstored-16.patch"
Content-Transfer-Encoding: base64

RnJvbSBlN2Q4NDY3M2Y3NTdjZDM4YWQwMjM5MWZlMDc5ZjI5MWI4MTk3ZDU0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBjb250
cm9sIGNvbW1hbmQgZm9yIHNldHRpbmcgYW5kIHNob3dpbmcgcXVvdGEKCkFk
ZCBhIHhlbnN0b3JlLWNvbnRyb2wgY29tbWFuZCAicXVvdGEiIHRvOgotIHNo
b3cgY3VycmVudCBxdW90YSBzZXR0aW5ncwotIGNoYW5nZSBxdW90YSBzZXR0
aW5ncwotIHNob3cgY3VycmVudCBxdW90YSByZWxhdGVkIHZhbHVlcyBvZiBh
IGRvbWFpbgoKTm90ZSB0aGF0IGluIHRoZSBjYXNlIHRoZSBuZXcgcXVvdGEg
aXMgbG93ZXIgdGhhbiBleGlzdGluZyBvbmUsClhlbnN0b3JlZCBtYXkgY29u
dGludWUgdG8gaGFuZGxlIHJlcXVlc3RzIGZyb20gYSBkb21haW4gZXhjZWVk
aW5nIHRoZQpuZXcgbGltaXQgKGRlcGVuZHMgb24gd2hpY2ggb25lIGhhcyBi
ZWVuIGJyb2tlbikgYW5kIHRoZSBhbW91bnQgb2YKcmVzb3VyY2UgdXNlZCB3
aWxsIG5vdCBjaGFuZ2UuIEhvd2V2ZXIgdGhlIGRvbWFpbiB3aWxsIG5vdCBi
ZSBhYmxlIHRvCmNyZWF0ZSBtb3JlIHJlc291cmNlIChhc3NvY2lhdGVkIHRv
IHRoZSBxdW90YSkgdW50aWwgaXQgaXMgYmFjayB0byBiZWxvdwp0aGUgbGlt
aXQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNi4KClJlcG9ydGVkLWJ5OiBK
dWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5
OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdp
dCBhL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQgYi9kb2NzL21pc2MveGVuc3Rv
cmUudHh0CmluZGV4IDMzNGRjOGI2ZmRmNS4uYTdkMDA2NTE5YWU4IDEwMDY0
NAotLS0gYS9kb2NzL21pc2MveGVuc3RvcmUudHh0CisrKyBiL2RvY3MvbWlz
Yy94ZW5zdG9yZS50eHQKQEAgLTM2Niw2ICszNjYsMTcgQEAgQ09OVFJPTAkJ
CTxjb21tYW5kPnxbPHBhcmFtZXRlcnM+fF0KIAlwcmludHw8c3RyaW5nPgog
CQlwcmludCA8c3RyaW5nPiB0byBzeXNsb2cgKHhlbnN0b3JlIHJ1bnMgYXMg
ZGFlbW9uKSBvcgogCQl0byBjb25zb2xlICh4ZW5zdG9yZSBydW5zIGFzIHN0
dWJkb20pCisJcXVvdGF8W3NldCA8bmFtZT4gPHZhbD58PGRvbWlkPl0KKwkJ
d2l0aG91dCBwYXJhbWV0ZXJzOiBwcmludCB0aGUgY3VycmVudCBxdW90YSBz
ZXR0aW5ncworCQl3aXRoICJzZXQgPG5hbWU+IDx2YWw+Ijogc2V0IHRoZSBx
dW90YSA8bmFtZT4gdG8gbmV3IHZhbHVlCisJCTx2YWw+IChUaGUgYWRtaW4g
c2hvdWxkIG1ha2Ugc3VyZSBhbGwgdGhlIGRvbWFpbiB1c2FnZSBpcworCQli
ZWxvdyB0aGUgcXVvdGEuIElmIGl0IGlzIG5vdCwgdGhlbiBYZW5zdG9yZWQg
bWF5IGNvbnRpbnVlIHRvCisJCWhhbmRsZSByZXF1ZXN0cyBmcm9tIHRoZSBk
b21haW4gYXMgbG9uZyBhcyB0aGUgcmVzb3VyY2UKKwkJdmlvbGF0aW5nIHRo
ZSBuZXcgcXVvdGEgc2V0dGluZyBpc24ndCBpbmNyZWFzZWQgZnVydGhlcikK
KwkJd2l0aCAiPGRvbWlkPiI6IHByaW50IHF1b3RhIHJlbGF0ZWQgYWNjb3Vu
dGluZyBkYXRhIGZvcgorCQl0aGUgZG9tYWluIDxkb21pZD4KKwlxdW90YS1z
b2Z0fFtzZXQgPG5hbWU+IDx2YWw+XQorCQlsaWtlIHRoZSAicXVvdGEiIGNv
bW1hbmQsIGJ1dCBmb3Igc29mdC1xdW90YS4KIAloZWxwCQkJPHN1cHBvcnRl
ZC1jb21tYW5kcz4KIAkJcmV0dXJuIGxpc3Qgb2Ygc3VwcG9ydGVkIGNvbW1h
bmRzIGZvciBDT05UUk9MCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCmluZGV4IDIxMWZlMWZkOWIzNy4uOTgwMjc5ZmE1M2Zm
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJv
bC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMK
QEAgLTE0OCw2ICsxNDgsMTE1IEBAIHN0YXRpYyBpbnQgZG9fY29udHJvbF9s
b2codm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKIAlyZXR1
cm4gMDsKIH0KIAorc3RydWN0IHF1b3RhIHsKKwljb25zdCBjaGFyICpuYW1l
OworCWludCAqcXVvdGE7CisJY29uc3QgY2hhciAqZGVzY3I7Cit9OworCitz
dGF0aWMgY29uc3Qgc3RydWN0IHF1b3RhIGhhcmRfcXVvdGFzW10gPSB7CisJ
eyAibm9kZXMiLCAmcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbiwgIk5vZGVz
IHBlciBkb21haW4iIH0sCisJeyAid2F0Y2hlcyIsICZxdW90YV9uYl93YXRj
aF9wZXJfZG9tYWluLCAiV2F0Y2hlcyBwZXIgZG9tYWluIiB9LAorCXsgInRy
YW5zYWN0aW9ucyIsICZxdW90YV9tYXhfdHJhbnNhY3Rpb24sICJUcmFuc2Fj
dGlvbnMgcGVyIGRvbWFpbiIgfSwKKwl7ICJvdXRzdGFuZGluZyIsICZxdW90
YV9yZXFfb3V0c3RhbmRpbmcsCisJCSJPdXRzdGFuZGluZyByZXF1ZXN0cyBw
ZXIgZG9tYWluIiB9LAorCXsgInRyYW5zYWN0aW9uLW5vZGVzIiwgJnF1b3Rh
X3RyYW5zX25vZGVzLAorCQkiTWF4LiBudW1iZXIgb2YgYWNjZXNzZWQgbm9k
ZXMgcGVyIHRyYW5zYWN0aW9uIiB9LAorCXsgIm1lbW9yeSIsICZxdW90YV9t
ZW1vcnlfcGVyX2RvbWFpbl9oYXJkLAorCQkiVG90YWwgWGVuc3RvcmUgbWVt
b3J5IHBlciBkb21haW4gKGVycm9yIGxldmVsKSIgfSwKKwl7ICJub2RlLXNp
emUiLCAmcXVvdGFfbWF4X2VudHJ5X3NpemUsICJNYXguIHNpemUgb2YgYSBu
b2RlIiB9LAorCXsgInBhdGgtbWF4IiwgJnF1b3RhX21heF9wYXRoX2xlbiwg
Ik1heC4gbGVuZ3RoIG9mIGEgbm9kZSBwYXRoIiB9LAorCXsgInBlcm1pc3Np
b25zIiwgJnF1b3RhX25iX3Blcm1zX3Blcl9ub2RlLAorCQkiTWF4LiBudW1i
ZXIgb2YgcGVybWlzc2lvbnMgcGVyIG5vZGUiIH0sCisJeyBOVUxMLCBOVUxM
LCBOVUxMIH0KK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcXVvdGEgc29m
dF9xdW90YXNbXSA9IHsKKwl7ICJtZW1vcnkiLCAmcXVvdGFfbWVtb3J5X3Bl
cl9kb21haW5fc29mdCwKKwkJIlRvdGFsIFhlbnN0b3JlIG1lbW9yeSBwZXIg
ZG9tYWluICh3YXJuaW5nIGxldmVsKSIgfSwKKwl7IE5VTEwsIE5VTEwsIE5V
TEwgfQorfTsKKworc3RhdGljIGludCBxdW90YV9zaG93X2N1cnJlbnQoY29u
c3Qgdm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJCSAg
ICAgIGNvbnN0IHN0cnVjdCBxdW90YSAqcXVvdGFzKQoreworCWNoYXIgKnJl
c3A7CisJdW5zaWduZWQgaW50IGk7CisKKwlyZXNwID0gdGFsbG9jX3N0cmR1
cChjdHgsICJRdW90YSBzZXR0aW5nczpcbiIpOworCWlmICghcmVzcCkKKwkJ
cmV0dXJuIEVOT01FTTsKKworCWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90
YTsgaSsrKSB7CisJCXJlc3AgPSB0YWxsb2NfYXNwcmludGZfYXBwZW5kKHJl
c3AsICIlLTE3czogJThkICVzXG4iLAorCQkJCQkgICAgICBxdW90YXNbaV0u
bmFtZSwgKnF1b3Rhc1tpXS5xdW90YSwKKwkJCQkJICAgICAgcXVvdGFzW2ld
LmRlc2NyKTsKKwkJaWYgKCFyZXNwKQorCQkJcmV0dXJuIEVOT01FTTsKKwl9
CisKKwlzZW5kX3JlcGx5KGNvbm4sIFhTX0NPTlRST0wsIHJlc3AsIHN0cmxl
bihyZXNwKSArIDEpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQg
cXVvdGFfc2V0KGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sCisJCSAgICAgY2hhciAqKnZlYywgaW50IG51bSwgY29uc3Qgc3Ry
dWN0IHF1b3RhICpxdW90YXMpCit7CisJdW5zaWduZWQgaW50IGk7CisJaW50
IHZhbDsKKworCWlmIChudW0gIT0gMikKKwkJcmV0dXJuIEVJTlZBTDsKKwor
CXZhbCA9IGF0b2kodmVjWzFdKTsKKwlpZiAodmFsIDwgMSkKKwkJcmV0dXJu
IEVJTlZBTDsKKworCWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90YTsgaSsr
KSB7CisJCWlmICghc3RyY21wKHZlY1swXSwgcXVvdGFzW2ldLm5hbWUpKSB7
CisJCQkqcXVvdGFzW2ldLnF1b3RhID0gdmFsOworCQkJc2VuZF9hY2soY29u
biwgWFNfQ09OVFJPTCk7CisJCQlyZXR1cm4gMDsKKwkJfQorCX0KKworCXJl
dHVybiBFSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgcXVvdGFfZ2V0KGNvbnN0
IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCSAgICAg
Y2hhciAqKnZlYywgaW50IG51bSkKK3sKKwlpZiAobnVtICE9IDEpCisJCXJl
dHVybiBFSU5WQUw7CisKKwlyZXR1cm4gZG9tYWluX2dldF9xdW90YShjdHgs
IGNvbm4sIGF0b2kodmVjWzBdKSk7Cit9CisKK3N0YXRpYyBpbnQgZG9fY29u
dHJvbF9xdW90YSh2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LAorCQkJICAgIGNoYXIgKip2ZWMsIGludCBudW0pCit7CisJaWYgKG51bSA9
PSAwKQorCQlyZXR1cm4gcXVvdGFfc2hvd19jdXJyZW50KGN0eCwgY29ubiwg
aGFyZF9xdW90YXMpOworCisJaWYgKCFzdHJjbXAodmVjWzBdLCAic2V0Iikp
CisJCXJldHVybiBxdW90YV9zZXQoY3R4LCBjb25uLCB2ZWMgKyAxLCBudW0g
LSAxLCBoYXJkX3F1b3Rhcyk7CisKKwlyZXR1cm4gcXVvdGFfZ2V0KGN0eCwg
Y29ubiwgdmVjLCBudW0pOworfQorCitzdGF0aWMgaW50IGRvX2NvbnRyb2xf
cXVvdGFfcyh2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAor
CQkJICAgICAgY2hhciAqKnZlYywgaW50IG51bSkKK3sKKwlpZiAobnVtID09
IDApCisJCXJldHVybiBxdW90YV9zaG93X2N1cnJlbnQoY3R4LCBjb25uLCBz
b2Z0X3F1b3Rhcyk7CisKKwlpZiAoIXN0cmNtcCh2ZWNbMF0sICJzZXQiKSkK
KwkJcmV0dXJuIHF1b3RhX3NldChjdHgsIGNvbm4sIHZlYyArIDEsIG51bSAt
IDEsIHNvZnRfcXVvdGFzKTsKKworCXJldHVybiBFSU5WQUw7Cit9CisKICNp
ZmRlZiBfX01JTklPU19fCiBzdGF0aWMgaW50IGRvX2NvbnRyb2xfbWVtcmVw
b3J0KHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCiAJCQkJ
Y2hhciAqKnZlYywgaW50IG51bSkKQEAgLTc3Nyw2ICs4ODYsOCBAQCBzdGF0
aWMgc3RydWN0IGNtZF9zIGNtZHNbXSA9IHsKIAl7ICJtZW1yZXBvcnQiLCBk
b19jb250cm9sX21lbXJlcG9ydCwgIls8ZmlsZT5dIiB9LAogI2VuZGlmCiAJ
eyAicHJpbnQiLCBkb19jb250cm9sX3ByaW50LCAiPHN0cmluZz4iIH0sCisJ
eyAicXVvdGEiLCBkb19jb250cm9sX3F1b3RhLCAiW3NldCA8bmFtZT4gPHZh
bD58PGRvbWlkPl0iIH0sCisJeyAicXVvdGEtc29mdCIsIGRvX2NvbnRyb2xf
cXVvdGFfcywgIltzZXQgPG5hbWU+IDx2YWw+XSIgfSwKIAl7ICJoZWxwIiwg
ZG9fY29udHJvbF9oZWxwLCAiIiB9LAogfTsKIApkaWZmIC0tZ2l0IGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IGVjNTQyZGY2YTY3ZS4uM2Q1
MTQyNTgxMzMyIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5jCkBAIC0zMSw2ICszMSw3IEBACiAjaW5jbHVkZSAieGVuc3RvcmVk
X2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IgogI2luY2x1ZGUgInhlbnN0b3JlZF93YXRjaC5oIgorI2luY2x1ZGUgInhl
bnN0b3JlZF9jb250cm9sLmgiCiAKICNpbmNsdWRlIDx4ZW5ldnRjaG4uaD4K
ICNpbmNsdWRlIDx4ZW5jdHJsLmg+CkBAIC0zNTEsNiArMzUyLDM4IEBAIHN0
YXRpYyBzdHJ1Y3QgZG9tYWluICpmaW5kX2RvbWFpbl9zdHJ1Y3QodW5zaWdu
ZWQgaW50IGRvbWlkKQogCXJldHVybiBOVUxMOwogfQogCitpbnQgZG9tYWlu
X2dldF9xdW90YShjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLAorCQkgICAgIHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1
Y3QgZG9tYWluICpkID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwlj
aGFyICpyZXNwOworCWludCB0YTsKKworCWlmICghZCkKKwkJcmV0dXJuIEVO
T0VOVDsKKworCXRhID0gZC0+Y29ubiA/IGQtPmNvbm4tPnRyYW5zYWN0aW9u
X3N0YXJ0ZWQgOiAwOworCXJlc3AgPSB0YWxsb2NfYXNwcmludGYoY3R4LCAi
RG9tYWluICV1OlxuIiwgZG9taWQpOworCWlmICghcmVzcCkKKwkJcmV0dXJu
IEVOT01FTTsKKworI2RlZmluZSBlbnQodCwgZSkgXAorCXJlc3AgPSB0YWxs
b2NfYXNwcmludGZfYXBwZW5kKHJlc3AsICIlLTE2czogJThkXG4iLCAjdCwg
ZSk7IFwKKwlpZiAoIXJlc3ApIHJldHVybiBFTk9NRU0KKworCWVudChub2Rl
cywgZC0+bmJlbnRyeSk7CisJZW50KHdhdGNoZXMsIGQtPm5id2F0Y2gpOwor
CWVudCh0cmFuc2FjdGlvbnMsIHRhKTsKKwllbnQob3V0c3RhbmRpbmcsIGQt
Pm5ib3V0c3RhbmRpbmcpOworCWVudChtZW1vcnksIGQtPm1lbW9yeSk7CisK
KyN1bmRlZiBlbnQKKworCXNlbmRfcmVwbHkoY29ubiwgWFNfQ09OVFJPTCwg
cmVzcCwgc3RybGVuKHJlc3ApICsgMSk7CisKKwlyZXR1cm4gMDsKK30KKwog
c3RhdGljIHN0cnVjdCBkb21haW4gKmFsbG9jX2RvbWFpbihjb25zdCB2b2lk
ICpjb250ZXh0LCB1bnNpZ25lZCBpbnQgZG9taWQpCiB7CiAJc3RydWN0IGRv
bWFpbiAqZG9tYWluOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5oCmluZGV4IDU3MWFhNDZkMTU4ZS4uMGY4ODM5MzZmNDEzIDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCkBAIC05MSw2
ICs5MSw4IEBAIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwogdm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5jKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKIHZvaWQgZG9tYWluX291dHN0YW5kaW5nX2Rl
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiB2b2lkIGRvbWFpbl9vdXRz
dGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKTsKK2ludCBk
b21haW5fZ2V0X3F1b3RhKGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sCisJCSAgICAgdW5zaWduZWQgaW50IGRvbWlkKTsKIAog
LyogU3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICovCiBpbnQg
c2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IGNoYXIgKm5hbWUsCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSA4ZDZiYjRhYzQwNjE5ODc3MTMwNTMzYjExNjU1ODI5MTAxYjMxZDA0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IFN5bmNocm9uaXNlIGRlZmF1
bHRzIHdpdGggb3hlbnN0b3JlLmNvbmYuaW4KTUlNRS1WZXJzaW9uOiAxLjAK
Q29udGVudC1UeXBlOiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRl
bnQtVHJhbnNmZXItRW5jb2Rpbmc6IDhiaXQKCldlIGN1cnJlbnRseSBoYXZl
IDIgZGlmZmVyZW50IHNldCBvZiBkZWZhdWx0cyBpbiB1cHN0cmVhbSBYZW4g
Z2l0IHRyZWU6CiogZGVmaW5lZCBpbiB0aGUgc291cmNlIGNvZGUsIG9ubHkg
dXNlZCBpZiB0aGVyZSBpcyBubyBjb25maWcgZmlsZQoqIGRlZmluZWQgaW4g
dGhlIG94ZW5zdG9yZWQuY29uZi5pbiB1cHN0cmVhbSBYZW4KCkFuIG94ZW5z
dG9yZWQuY29uZiBmaWxlIGlzIG5vdCBtYW5kYXRvcnksIGFuZCBpZiBtaXNz
aW5nLCBtYXhyZXF1ZXN0cyBpbgpwYXJ0aWN1bGFyIGhhcyBhbiB1bnNhZmUg
ZGVmYXVsdC4KClJlc3luYyB0aGUgZGVmYXVsdHMgZnJvbSBveGVuc3RvcmVk
LmNvbmYuaW4gaW50byB0aGUgc291cmNlIGNvZGUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE2LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEVkd2luIFTDtnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2Vk
LWJ5OiBDaHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJp
eC5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Rl
ZmluZS5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5k
ZXggZWJlMThiOGUzMTJjLi42YjA2ZjgwODU5NWIgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2Nh
bWwveGVuc3RvcmVkL2RlZmluZS5tbApAQCAtMjEsOSArMjEsOSBAQCBsZXQg
eHNfZGFlbW9uX3NvY2tldCA9IFBhdGhzLnhlbl9ydW5fc3RvcmVkIF4gIi9z
b2NrZXQiCiAKIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRocy54ZW5f
Y29uZmlnX2RpcgogCi1sZXQgbWF4d2F0Y2ggPSByZWYgKDUwKQotbGV0IG1h
eHRyYW5zYWN0aW9uID0gcmVmICgyMCkKLWxldCBtYXhyZXF1ZXN0cyA9IHJl
ZiAoLTEpICAgKCogbWF4aW11bSByZXF1ZXN0cyBwZXIgdHJhbnNhY3Rpb24g
KikKK2xldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQorbGV0IG1heHRyYW5zYWN0
aW9uID0gcmVmICgxMCkKK2xldCBtYXhyZXF1ZXN0cyA9IHJlZiAoMTAyNCkg
ICAoKiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAqKQogCiBs
ZXQgY29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCiBsZXQgY29uZmxp
Y3RfbWF4X2hpc3Rvcnlfc2Vjb25kcyA9IHJlZiAwLjA1CmRpZmYgLS1naXQg
YS90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwgYi90b29scy9vY2Ft
bC94ZW5zdG9yZWQvcXVvdGEubWwKaW5kZXggYWJjYWM5MTI4MDVhLi42ZTNk
NjQwMWFlODkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9x
dW90YS5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwK
QEAgLTIwLDggKzIwLDggQEAgZXhjZXB0aW9uIFRyYW5zYWN0aW9uX29wZW5l
ZAogCiBsZXQgd2FybiBmbXQgPSBMb2dnaW5nLndhcm4gInF1b3RhIiBmbXQK
IGxldCBhY3RpdmF0ZSA9IHJlZiB0cnVlCi1sZXQgbWF4ZW50ID0gcmVmICgx
MDAwMCkKLWxldCBtYXhzaXplID0gcmVmICg0MDk2KQorbGV0IG1heGVudCA9
IHJlZiAoMTAwMCkKK2xldCBtYXhzaXplID0gcmVmICgyMDQ4KQogCiB0eXBl
IHQgPSB7CiAJbWF4ZW50OiBpbnQ7ICAgICAgICAgICAgICAgKCogbWF4IGVu
dGl0aWVzIHBlciBkb21VICopCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA3OGQ1YWY0NGFiMTNiYjE4Yzg3YjZhZDc1ZTUwNWJkMzc0Mzc5Y2Iz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogVGh1LCAyOCBKdWwgMjAyMiAxNzowODoxNSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IENoZWNrIGZvciBtYXhyZXF1
ZXN0cyBiZWZvcmUgcGVyZm9ybWluZwogb3BlcmF0aW9ucwpNSU1FLVZlcnNp
b246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRG
LTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKUHJldmlvdXNs
eSB3ZSdkIHBlcmZvcm0gdGhlIG9wZXJhdGlvbiwgcmVjb3JkIHRoZSB1cGRh
dGVkIHRyZWUgaW4gdGhlCnRyYW5zYWN0aW9uIHJlY29yZCwgdGhlbiB0cnkg
dG8gaW5zZXJ0IGEgd2F0Y2hvcCBwYXRoIGFuZCB0aGUgcmVwbHkgcGFja2V0
LgoKSWYgd2UgZXhjZWVkZWQgbWF4IHJlcXVlc3RzIHdlIHdvdWxkJ3ZlIHJl
dHVybmVkIEVRVU9UQSwgYnV0IHN0aWxsOgoqIGhhdmUgcGVyZm9ybWVkIHRo
ZSBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uJ3MgdHJlZQoqIGhhdmUg
cmVjb3JkZWQgdGhlIHdhdGNob3AsIG1ha2luZyB0aGlzIHF1ZXVlIGVmZmVj
dGl2ZWx5IHVuYm91bmRlZAoKSXQgaXMgYmV0dGVyIGlmIHdlIGNoZWNrIHdo
ZXRoZXIgd2UnZCBoYXZlIHJvb20gdG8gc3RvcmUgdGhlIG9wZXJhdGlvbiBi
ZWZvcmUKcGVyZm9ybWluZyB0aGUgdHJhbnNhY3Rpb24sIGFuZCByYWlzZSBF
UVVPVEEgdGhlcmUuICBUaGVuIHRoZSB0cmFuc2FjdGlvbgpyZWNvcmQgd29u
J3QgZ3Jvdy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2IC8gQ1ZFLTIwMjIt
NDIzMTcuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1h
em9uLmNvbT4KU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbCBiL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDI3NzkwZDRhNWM0MS4uZGQ1
OGU2OTc5Y2Y5IDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vz
cy5tbApAQCAtMzg5LDYgKzM4OSw3IEBAIGxldCBpbnB1dF9oYW5kbGVfZXJy
b3IgfmNvbnMgfmRvbXMgfmZjdCB+Y29uIH50IH5yZXEgPQogCWxldCByZXBs
eV9lcnJvciBlID0KIAkJUGFja2V0LkVycm9yIGUgaW4KIAl0cnkKKwkJVHJh
bnNhY3Rpb24uY2hlY2tfcXVvdGFfZXhuIH5wZXJtOihDb25uZWN0aW9uLmdl
dF9wZXJtIGNvbikgdDsKIAkJZmN0IGNvbiB0IGRvbXMgY29ucyByZXEuUGFj
a2V0LmRhdGEKIAl3aXRoCiAJfCBEZWZpbmUuSW52YWxpZF9wYXRoICAgICAg
ICAgIC0+IHJlcGx5X2Vycm9yICJFSU5WQUwiCkBAIC02ODEsOSArNjgyLDEw
IEBAIGxldCBwcm9jZXNzX3BhY2tldCB+c3RvcmUgfmNvbnMgfmRvbXMgfmNv
biB+cmVxID0KIAkJaW4KIAogCQlsZXQgcmVzcG9uc2UgPSB0cnkKKwkJCVRy
YW5zYWN0aW9uLmNoZWNrX3F1b3RhX2V4biB+cGVybTooQ29ubmVjdGlvbi5n
ZXRfcGVybSBjb24pIHQ7CiAJCQlpZiB0aWQgPD4gVHJhbnNhY3Rpb24ubm9u
ZSB0aGVuCiAJCQkJKCogUmVtZW1iZXIgdGhlIHJlcXVlc3QgYW5kIHJlc3Bv
bnNlIGZvciB0aGlzIG9wZXJhdGlvbiBpbiBjYXNlIHdlIG5lZWQgdG8gcmVw
bGF5IHRoZSB0cmFuc2FjdGlvbiAqKQotCQkJCVRyYW5zYWN0aW9uLmFkZF9v
cGVyYXRpb24gfnBlcm06KENvbm5lY3Rpb24uZ2V0X3Blcm0gY29uKSB0IHJl
cSByZXNwb25zZTsKKwkJCQlUcmFuc2FjdGlvbi5hZGRfb3BlcmF0aW9uIHQg
cmVxIHJlc3BvbnNlOwogCQkJcmVzcG9uc2UKIAkJd2l0aCBRdW90YS5MaW1p
dF9yZWFjaGVkIC0+CiAJCQlQYWNrZXQuRXJyb3IgIkVRVU9UQSIKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbAppbmRleCAx
N2IxYmRmMmVhZjkuLjI5NDE0M2UyMzM1YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3RyYW5zYWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbApAQCAtODUsNiArODUsNyBA
QCB0eXBlIHQgPSB7CiAJb2xkcm9vdDogU3RvcmUuTm9kZS50OwogCW11dGFi
bGUgcGF0aHM6IChYZW5idXMuWGIuT3Aub3BlcmF0aW9uICogU3RvcmUuUGF0
aC50KSBsaXN0OwogCW11dGFibGUgb3BlcmF0aW9uczogKFBhY2tldC5yZXF1
ZXN0ICogUGFja2V0LnJlc3BvbnNlKSBsaXN0OworCW11dGFibGUgcXVvdGFf
cmVhY2hlZDogYm9vbDsKIAltdXRhYmxlIHJlYWRfbG93cGF0aDogU3RvcmUu
UGF0aC50IG9wdGlvbjsKIAltdXRhYmxlIHdyaXRlX2xvd3BhdGg6IFN0b3Jl
LlBhdGgudCBvcHRpb247CiB9CkBAIC0xMjcsNiArMTI4LDcgQEAgbGV0IG1h
a2UgPyhpbnRlcm5hbD1mYWxzZSkgaWQgc3RvcmUgPQogCQlvbGRyb290ID0g
U3RvcmUuZ2V0X3Jvb3Qgc3RvcmU7CiAJCXBhdGhzID0gW107CiAJCW9wZXJh
dGlvbnMgPSBbXTsKKwkJcXVvdGFfcmVhY2hlZCA9IGZhbHNlOwogCQlyZWFk
X2xvd3BhdGggPSBOb25lOwogCQl3cml0ZV9sb3dwYXRoID0gTm9uZTsKIAl9
IGluCkBAIC0xNDMsMTMgKzE0NSwxOSBAQCBsZXQgZ2V0X3Jvb3QgdCA9IFN0
b3JlLmdldF9yb290IHQuc3RvcmUKIAogbGV0IGlzX3JlYWRfb25seSB0ID0g
dC5wYXRocyA9IFtdCiBsZXQgYWRkX3dvcCB0IHR5IHBhdGggPSB0LnBhdGhz
IDwtICh0eSwgcGF0aCkgOjogdC5wYXRocwotbGV0IGFkZF9vcGVyYXRpb24g
fnBlcm0gdCByZXF1ZXN0IHJlc3BvbnNlID0KK2xldCBnZXRfb3BlcmF0aW9u
cyB0ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCisKK2xldCBjaGVja19xdW90
YV9leG4gfnBlcm0gdCA9CiAJaWYgIURlZmluZS5tYXhyZXF1ZXN0cyA+PSAw
CiAJCSYmIG5vdCAoUGVybXMuQ29ubmVjdGlvbi5pc19kb20wIHBlcm0pCi0J
CSYmIExpc3QubGVuZ3RoIHQub3BlcmF0aW9ucyA+PSAhRGVmaW5lLm1heHJl
cXVlc3RzCi0JCXRoZW4gcmFpc2UgUXVvdGEuTGltaXRfcmVhY2hlZDsKKwkJ
JiYgKHQucXVvdGFfcmVhY2hlZCB8fCBMaXN0Lmxlbmd0aCB0Lm9wZXJhdGlv
bnMgPj0gIURlZmluZS5tYXhyZXF1ZXN0cykKKwkJdGhlbiBiZWdpbgorCQkJ
dC5xdW90YV9yZWFjaGVkIDwtIHRydWU7CisJCQlyYWlzZSBRdW90YS5MaW1p
dF9yZWFjaGVkOworCQllbmQKKworbGV0IGFkZF9vcGVyYXRpb24gdCByZXF1
ZXN0IHJlc3BvbnNlID0KIAl0Lm9wZXJhdGlvbnMgPC0gKHJlcXVlc3QsIHJl
c3BvbnNlKSA6OiB0Lm9wZXJhdGlvbnMKLWxldCBnZXRfb3BlcmF0aW9ucyB0
ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCiBsZXQgc2V0X3JlYWRfbG93cGF0
aCB0IHBhdGggPSB0LnJlYWRfbG93cGF0aCA8LSBnZXRfbG93ZXN0IHBhdGgg
dC5yZWFkX2xvd3BhdGgKIGxldCBzZXRfd3JpdGVfbG93cGF0aCB0IHBhdGgg
PSB0LndyaXRlX2xvd3BhdGggPC0gZ2V0X2xvd2VzdCBwYXRoIHQud3JpdGVf
bG93cGF0aAogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSA2MDBjNDVlNDljMjA2MGUwNzdjMDZhYjE5MDc4ZGE4OWFhOGUyZTA4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogR0MgcGFyYW1ldGVyIHR1bmluZwpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKQnkgZGVm
YXVsdCB0aGUgT0NhbWwgZ2FyYmFnZSBjb2xsZWN0b3Igd291bGQgcmV0dXJu
IG1lbW9yeSB0byB0aGUgT1Mgb25seQphZnRlciB1bnVzZWQgbWVtb3J5IGlz
IDV4IGxpdmUgbWVtb3J5LiAgVHdlYWsgdGhpcyB0byAxMjAlIGluc3RlYWQs
IHdoaWNoCndvdWxkIG1hdGNoIHRoZSBtYWpvciBHQyBzcGVlZC4KClRoaXMg
aXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTD
tnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJp
c3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+Cgpk
aWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5kZXggNmIwNmY4
MDg1OTViLi5iYTYzYTgxNDdlMDkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL2RlZmluZS5tbApAQCAtMjUsNiArMjUsNyBAQCBsZXQgbWF4d2F0Y2gg
PSByZWYgKDEwMCkKIGxldCBtYXh0cmFuc2FjdGlvbiA9IHJlZiAoMTApCiBs
ZXQgbWF4cmVxdWVzdHMgPSByZWYgKDEwMjQpICAgKCogbWF4aW11bSByZXF1
ZXN0cyBwZXIgdHJhbnNhY3Rpb24gKikKIAorbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKIGxl
dCBjb25mbGljdF9tYXhfaGlzdG9yeV9zZWNvbmRzID0gcmVmIDAuMDUKIGxl
dCBjb25mbGljdF9yYXRlX2xpbWl0X2lzX2FnZ3JlZ2F0ZSA9IHJlZiB0cnVl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVk
Lm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAppbmRl
eCBkNDRhZTY3M2M0MmEuLjNiNTdhZDAxNmRmYiAxMDA2NDQKLS0tIGEvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCkBAIC0xMDQsNiArMTA0LDcg
QEAgbGV0IHBhcnNlX2NvbmZpZyBmaWxlbmFtZSA9CiAJCSgicXVvdGEtbWF4
c2l6ZSIsIENvbmZpZy5TZXRfaW50IFF1b3RhLm1heHNpemUpOwogCQkoInF1
b3RhLW1heHJlcXVlc3RzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHJl
cXVlc3RzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CisJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwogCQkoInBlcnNpc3RlbnQiLCBDb25maWcuU2V0X2Jvb2wgRGlz
ay5lbmFibGUpOwogCQkoInhlbnN0b3JlZC1sb2ctZmlsZSIsIENvbmZpZy5T
dHJpbmcgTG9nZ2luZy5zZXRfeGVuc3RvcmVkX2xvZ19kZXN0aW5hdGlvbik7
CkBAIC0yNjUsNiArMjY2LDY3IEBAIGxldCB0b19maWxlIHN0b3JlIGNvbnMg
ZmRzIGZpbGUgPQogCSAgICAgICAgKGZ1biAoKSAtPiBjbG9zZV9vdXQgY2hh
bm5lbCkKIGVuZAogCisoKgorCUJ5IGRlZmF1bHQgT0NhbWwncyBHQyBvbmx5
IHJldHVybnMgbWVtb3J5IHRvIHRoZSBPUyB3aGVuIGl0IGV4Y2VlZHMgYQor
CWNvbmZpZ3VyYWJsZSAnbWF4IG92ZXJoZWFkJyBzZXR0aW5nLgorCVRoZSBk
ZWZhdWx0IGlzIDUwMCUsIHRoYXQgaXMgNS82dGggb2YgdGhlIE9DYW1sIGhl
YXAgbmVlZHMgdG8gYmUgZnJlZQorCWFuZCBvbmx5IDEvNnRoIGxpdmUgZm9y
IGEgY29tcGFjdGlvbiB0byBiZSB0cmlnZ2VycmVkIHRoYXQgd291bGQKKwly
ZWxlYXNlIG1lbW9yeSBiYWNrIHRvIHRoZSBPUy4KKwlJZiB0aGUgbGltaXQg
aXMgbm90IGhpdCB0aGVuIHRoZSBPQ2FtbCBwcm9jZXNzIGNhbiByZXVzZSB0
aGF0IG1lbW9yeQorCWZvciBpdHMgb3duIHB1cnBvc2VzLCBidXQgb3RoZXIg
cHJvY2Vzc2VzIHdvbid0IGJlIGFibGUgdG8gdXNlIGl0LgorCisJVGhlcmUg
aXMgYWxzbyBhICdzcGFjZSBvdmVyaGVhZCcgc2V0dGluZyB0aGF0IGNvbnRy
b2xzIGhvdyBtdWNoIHdvcmsKKwllYWNoIG1ham9yIEdDIHNsaWNlIGRvZXMs
IGFuZCBieSBkZWZhdWx0IGFpbXMgYXQgaGF2aW5nIG5vIG1vcmUgdGhhbgor
CTgwJSBvciAxMjAlIChkZXBlbmRpbmcgb24gdmVyc2lvbikgZ2FyYmFnZSB2
YWx1ZXMgY29tcGFyZWQgdG8gbGl2ZQorCXZhbHVlcy4KKwlUaGlzIGRvZXNu
J3QgaGF2ZSBhcyBtdWNoIHJlbGV2YW5jZSB0byBtZW1vcnkgcmV0dXJuZWQg
dG8gdGhlIE9TIGFzCisJbG9uZyBhcyBzcGFjZV9vdmVyaGVhZCA8PSBtYXhf
b3ZlcmhlYWQsIGJlY2F1c2UgY29tcGFjdGlvbiBpcyBvbmx5CisJdHJpZ2dl
cnJlZCBhdCB0aGUgZW5kIG9mIG1ham9yIEdDIGN5Y2xlcy4KKworCVRoZSBk
ZWZhdWx0cyBhcmUgdG9vIGxhcmdlIG9uY2UgdGhlIHByb2dyYW0gc3RhcnRz
IHVzaW5nIH4xMDBNaUIgb2YKKwltZW1vcnksIGF0IHdoaWNoIHBvaW50IH41
MDBNaUIgd291bGQgYmUgdW5hdmFpbGFibGUgdG8gb3RoZXIgcHJvY2Vzc2Vz
CisJKHdoaWNoIHdvdWxkIGJlIGZpbmUgaWYgdGhpcyB3YXMgdGhlIG1haW4g
cHJvY2VzcyBpbiB0aGlzIFZNLCBidXQgaXQgaXMKKwlub3QpLgorCisJTWF4
IG92ZXJoZWFkIGNhbiBhbHNvIGJlIHNldCB0byAwLCBob3dldmVyIHRoaXMg
aXMgZm9yIHRlc3RpbmcgcHVycG9zZXMKKwlvbmx5IChzZXR0aW5nIGl0IGxv
d2VyIHRoYW4gJ3NwYWNlIG92ZXJoZWFkJyB3b3VsZG4ndCBoZWxwIGJlY2F1
c2UgdGhlCisJbWFqb3IgR0Mgd291bGRuJ3QgcnVuIGZhc3QgZW5vdWdoLCBh
bmQgY29tcGFjdGlvbiBkb2VzIGhhdmUgYQorCXBlcmZvcm1hbmNlIGNvc3Q6
IHdlIGNhbiBvbmx5IGNvbXBhY3QgY29udGlndW91cyByZWdpb25zLCBzbyBt
ZW1vcnkgaGFzCisJdG8gYmUgbW92ZWQgYXJvdW5kKS4KKworCU1heCBvdmVy
aGVhZCBjb250cm9scyBob3cgb2Z0ZW4gdGhlIGhlYXAgaXMgY29tcGFjdGVk
LCB3aGljaCBpcyB1c2VmdWwKKwlpZiB0aGVyZSBhcmUgYnVyc3Qgb2YgYWN0
aXZpdHkgZm9sbG93ZWQgYnkgbG9uZyBwZXJpb2RzIG9mIGlkbGUgc3RhdGUs
CisJb3IgaWYgYSBkb21haW4gcXVpdHMsIGV0Yy4gQ29tcGFjdGlvbiByZXR1
cm5zIG1lbW9yeSB0byB0aGUgT1MuCisKKwl3YXN0ZWQgPSBsaXZlICogc3Bh
Y2Vfb3ZlcmhlYWQgLyAxMDAKKworCUZvciBnbG9iYWxseSBvdmVycmlkaW5n
IHRoZSBHQyBzZXR0aW5ncyBvbmUgY2FuIHVzZSBPQ0FNTFJVTlBBUkFNLAor
CWhvd2V2ZXIgd2UgcHJvdmlkZSBhIGNvbmZpZyBmaWxlIG92ZXJyaWRlIHRv
IGJlIGNvbnNpc3RlbnQgd2l0aCBvdGhlcgorCW94ZW5zdG9yZWQgc2V0dGlu
Z3MuCisKKwlPbmUgbWlnaHQgd2FudCB0byBkeW5hbWljYWxseSBhZGp1c3Qg
dGhlIG92ZXJoZWFkIHNldHRpbmcgYmFzZWQgb24gdXNlZAorCW1lbW9yeSwg
aS5lLiB0byB1c2UgYSBmaXhlZCB1cHBlciBib3VuZCBpbiBieXRlcywgbm90
IHBlcmNlbnRhZ2UuIEhvd2V2ZXIKKwltZWFzdXJlbWVudHMgc2hvdyB0aGF0
IHN1Y2ggYWRqdXN0bWVudHMgaW5jcmVhc2UgR0Mgb3ZlcmhlYWQgbWFzc2l2
ZWx5LAorCXdoaWxlIHN0aWxsIG5vdCBndWFyYW50ZWVpbmcgdGhhdCBtZW1v
cnkgaXMgcmV0dXJuZWQgYW55IG1vcmUgcXVpY2tseQorCXRoYW4gd2l0aCBh
IHBlcmNlbnRhZ2UgYmFzZWQgc2V0dGluZy4KKworCVRoZSBhbGxvY2F0aW9u
IHBvbGljeSBjb3VsZCBhbHNvIGJlIHR3ZWFrZWQsIGUuZy4gZmlyc3QgZml0
IHdvdWxkIHJlZHVjZQorCWZyYWdtZW50YXRpb24gYW5kIHRodXMgbWVtb3J5
IHVzYWdlLCBidXQgdGhlIGRvY3VtZW50YXRpb24gd2FybnMgdGhhdCBpdAor
CWNhbiBiZSBzZW5zaWJseSBzbG93ZXIsIGFuZCBpbmRlZWQgb25lIG9mIG91
ciBvd24gdGVzdGNhc2VzIGNhbiB0cmlnZ2VyCisJc3VjaCBhIGNvcm5lciBj
YXNlIHdoZXJlIGl0IGlzIG11bHRpcGxlIHRpbWVzIHNsb3dlciwgc28gaXQg
aXMgYmVzdCB0byBrZWVwCisJdGhlIGRlZmF1bHQgYWxsb2NhdGlvbiBwb2xp
Y3kgKG5leHQtZml0L2Jlc3QtZml0IGRlcGVuZGluZyBvbiB2ZXJzaW9uKS4K
KworCVRoZXJlIGFyZSBvdGhlciB0d2Vha3MgdGhhdCBjYW4gYmUgYXR0ZW1w
dGVkIGluIHRoZSBmdXR1cmUsIGUuZy4gc2V0dGluZworCSd1bGltaXQgLXYn
IHRvIDc1JSBvZiBSQU0sIGhvd2V2ZXIgZ2V0dGluZyB0aGUga2VybmVsIHRv
IGFjdHVhbGx5IHJldHVybgorCU5VTEwgZnJvbSBhbGxvY2F0aW9ucyBpcyBk
aWZmaWN1bHQgZXZlbiB3aXRoIHRoYXQgc2V0dGluZywgYW5kIHdpdGhvdXQg
YQorCU5VTEwgdGhlIGVtZXJnZW5jeSBHQyB3b24ndCBiZSB0cmlnZ2VycmVk
LgorCVBlcmhhcHMgY2dyb3VwIGxpbWl0cyBjb3VsZCBoZWxwLCBidXQgZm9y
IG5vdyB0d2VhayB0aGUgc2FmZXN0IG9ubHkuCisqKQorCitsZXQgdHdlYWtf
Z2MgKCkgPQorCUdjLnNldCB7IChHYy5nZXQgKCkpIHdpdGggR2MubWF4X292
ZXJoZWFkID0gIURlZmluZS5nY19tYXhfb3ZlcmhlYWQgfQorCisKIGxldCBf
ID0KIAlsZXQgY2YgPSBkb19hcmd2IGluCiAJbGV0IHBpZGZpbGUgPQpAQCAt
Mjc0LDYgKzMzNiw4IEBAIGxldCBfID0KIAkJCWRlZmF1bHRfcGlkZmlsZQog
CQlpbgogCisJdHdlYWtfZ2MgKCk7CisKIAkodHJ5CiAJCVVuaXhleHQubWtk
aXJfcmVjIChGaWxlbmFtZS5kaXJuYW1lIHBpZGZpbGUpIDBvNzU1CiAJd2l0
aCBfIC0+Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSBmZDZkOWNkM2QyMGU0OTZiZGJmM2UwYTA3MzU0ZjY1ZGUwYmNmNGFl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogRnJpLCAyOSBKdWwgMjAyMiAxODo1MzoyOSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC9saWJzL3hiOiBoaWRlIHR5cGUgb2YgWGIudApN
SU1FLVZlcnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNo
YXJzZXQ9VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoK
SGlkaW5nIHRoZSB0eXBlIHdpbGwgbWFrZSBpdCBlYXNpZXIgdG8gY2hhbmdl
IHRoZSBpbXBsZW1lbnRhdGlvbgppbiB0aGUgZnV0dXJlIHdpdGhvdXQgYnJl
YWtpbmcgY29kZSB0aGF0IHJlbGllcyBvbiBpdC4KCk5vIGZ1bmN0aW9uYWwg
Y2hhbmdlLgoKU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KKGNoZXJyeSBwaWNrZWQg
ZnJvbSBjb21taXQgN2FkZTMwYTE0NTE3MzRkMDQxMzYzYzc1MGE2NWQzMjJl
MjViNDdiYSkKClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94
Yi5tbCBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwKaW5kZXggMTA0ZDMx
OWQ3NzQ3Li44NDA0ZGRkOGE2ODIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L2xpYnMveGIveGIubWwKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5t
bApAQCAtMTk2LDYgKzE5Niw5IEBAIGxldCBwZWVrX291dHB1dCBjb24gPSBR
dWV1ZS5wZWVrIGNvbi5wa3Rfb3V0CiBsZXQgaW5wdXRfbGVuIGNvbiA9IFF1
ZXVlLmxlbmd0aCBjb24ucGt0X2luCiBsZXQgaGFzX2luX3BhY2tldCBjb24g
PSBRdWV1ZS5sZW5ndGggY29uLnBrdF9pbiA+IDAKIGxldCBnZXRfaW5fcGFj
a2V0IGNvbiA9IFF1ZXVlLnBvcCBjb24ucGt0X2luCitsZXQgaGFzX3BhcnRp
YWxfaW5wdXQgY29uID0gbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAorCXwg
SGF2ZUhkciBfIC0+IHRydWUKKwl8IE5vSGRyIChuLCBfKSAtPiBuIDwgUGFy
dGlhbC5oZWFkZXJfc2l6ZSAoKQogbGV0IGhhc19tb3JlX2lucHV0IGNvbiA9
CiAJbWF0Y2ggY29uLmJhY2tlbmQgd2l0aAogCXwgRmQgXyAgICAgICAgIC0+
IGZhbHNlCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDNhMDBkYTZj
ZGRjMS4uNzk0ZTM1YmIzNDNlIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNjYsMTMgKzY2LDcgQEAgdHlwZSBiYWNrZW5kX21tYXAgPSB7CiB0
eXBlIGJhY2tlbmRfZmQgPSB7IGZkIDogVW5peC5maWxlX2Rlc2NyOyB9CiB0
eXBlIGJhY2tlbmQgPSBGZCBvZiBiYWNrZW5kX2ZkIHwgWGVubW1hcCBvZiBi
YWNrZW5kX21tYXAKIHR5cGUgcGFydGlhbF9idWYgPSBIYXZlSGRyIG9mIFBh
cnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMKLXR5cGUgdCA9IHsK
LSAgYmFja2VuZCA6IGJhY2tlbmQ7Ci0gIHBrdF9pbiA6IFBhY2tldC50IFF1
ZXVlLnQ7Ci0gIHBrdF9vdXQgOiBQYWNrZXQudCBRdWV1ZS50OwotICBtdXRh
YmxlIHBhcnRpYWxfaW4gOiBwYXJ0aWFsX2J1ZjsKLSAgbXV0YWJsZSBwYXJ0
aWFsX291dCA6IHN0cmluZzsKLX0KK3R5cGUgdAogdmFsIGluaXRfcGFydGlh
bF9pbiA6IHVuaXQgLT4gcGFydGlhbF9idWYKIHZhbCByZWNvbm5lY3QgOiB0
IC0+IHVuaXQKIHZhbCBxdWV1ZSA6IHQgLT4gUGFja2V0LnQgLT4gdW5pdApA
QCAtOTcsNiArOTEsNyBAQCB2YWwgaGFzX291dHB1dCA6IHQgLT4gYm9vbAog
dmFsIHBlZWtfb3V0cHV0IDogdCAtPiBQYWNrZXQudAogdmFsIGlucHV0X2xl
biA6IHQgLT4gaW50CiB2YWwgaGFzX2luX3BhY2tldCA6IHQgLT4gYm9vbAor
dmFsIGhhc19wYXJ0aWFsX2lucHV0IDogdCAtPiBib29sCiB2YWwgZ2V0X2lu
X3BhY2tldCA6IHQgLT4gUGFja2V0LnQKIHZhbCBoYXNfbW9yZV9pbnB1dCA6
IHQgLT4gYm9vbAogdmFsIGlzX3NlbGVjdGFibGUgOiB0IC0+IGJvb2wKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1s
IGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb24ubWwKaW5kZXgg
NjVmOTllYTZmMjhhLi4zOGI0NzM2M2ExNzMgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC9jb25uZWN0aW9uLm1sCkBAIC0xMjUsOSArMTI1LDcg
QEAgbGV0IGdldF9wZXJtIGNvbiA9CiBsZXQgc2V0X3RhcmdldCBjb24gdGFy
Z2V0X2RvbWlkID0KIAljb24ucGVybSA8LSBQZXJtcy5Db25uZWN0aW9uLnNl
dF90YXJnZXQgKGdldF9wZXJtIGNvbikgfnBlcm1zOltQZXJtcy5SRUFEOyBQ
ZXJtcy5XUklURV0gdGFyZ2V0X2RvbWlkCiAKLWxldCBpc19iYWNrZW5kX21t
YXAgY29uID0gbWF0Y2ggY29uLnhiLlhlbmJ1cy5YYi5iYWNrZW5kIHdpdGgK
LQl8IFhlbmJ1cy5YYi5YZW5tbWFwIF8gLT4gdHJ1ZQotCXwgXyAtPiBmYWxz
ZQorbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBYZW5idXMuWGIuaXNfbW1h
cCBjb24ueGIKIAogbGV0IHNlbmRfcmVwbHkgY29uIHRpZCByaWQgdHkgZGF0
YSA9CiAJaWYgKFN0cmluZy5sZW5ndGggZGF0YSkgPiB4ZW5zdG9yZV9wYXls
b2FkX21heCAmJiAoaXNfYmFja2VuZF9tbWFwIGNvbikgdGhlbgpAQCAtMjgw
LDkgKzI3OCw3IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAK
IGxldCBkb19pbnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCiBs
ZXQgaGFzX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNv
bi54YgotbGV0IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IG1hdGNoIGNvbi54
Yi5YZW5idXMuWGIucGFydGlhbF9pbiB3aXRoCi0JfCBIYXZlSGRyIF8gLT4g
dHJ1ZQotCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBYZW5idXMuUGFydGlhbC5o
ZWFkZXJfc2l6ZSAoKQorbGV0IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IFhl
bmJ1cy5YYi5oYXNfcGFydGlhbF9pbnB1dCBjb24ueGIKIGxldCBwb3BfaW4g
Y29uID0gWGVuYnVzLlhiLmdldF9pbl9wYWNrZXQgY29uLnhiCiBsZXQgaGFz
X21vcmVfaW5wdXQgY29uID0gWGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNv
bi54YgogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSBmMTNmZTU5MDMzNjE5NTNlNGNjZjg2MDJiOWM4ZGY3ZTY0NTY4ZDU1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogQ2hhbmdlIFhiLmlucHV0IHRvIHJldHVybiBQ
YWNrZXQudCBvcHRpb24KTUlNRS1WZXJzaW9uOiAxLjAKQ29udGVudC1UeXBl
OiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRlbnQtVHJhbnNmZXIt
RW5jb2Rpbmc6IDhiaXQKClRoZSBxdWV1ZSBoZXJlIHdvdWxkIG9ubHkgZXZl
ciBob2xkIGF0IG1vc3Qgb25lIGVsZW1lbnQuICBUaGlzIHdpbGwgc2ltcGxp
ZnkKZm9sbG93LXVwIHBhdGNoZXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
Ni4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24u
Y29tPgpTaWduZWQtb2ZmLWJ5OiBFZHdpbiBUw7Zyw7ZrIDxlZHZpbi50b3Jv
a0BjaXRyaXguY29tPgpBY2tlZC1ieTogQ2hyaXN0aWFuIExpbmRpZyA8Y2hy
aXN0aWFuLmxpbmRpZ0BjaXRyaXguY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL2xpYnMveGIveGIubWwgYi90b29scy9vY2FtbC9saWJzL3hiL3hi
Lm1sCmluZGV4IDg0MDRkZGQ4YTY4Mi4uMTY1ZmQ0YTFlZGY0IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1sCisrKyBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKQEAgLTQ1LDcgKzQ1LDYgQEAgdHlwZSBwYXJ0
aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlhbC5wa3QgfCBOb0hkciBvZiBp
bnQgKiBieXRlcwogdHlwZSB0ID0KIHsKIAliYWNrZW5kOiBiYWNrZW5kOwot
CXBrdF9pbjogUGFja2V0LnQgUXVldWUudDsKIAlwa3Rfb3V0OiBQYWNrZXQu
dCBRdWV1ZS50OwogCW11dGFibGUgcGFydGlhbF9pbjogcGFydGlhbF9idWY7
CiAJbXV0YWJsZSBwYXJ0aWFsX291dDogc3RyaW5nOwpAQCAtNjIsNyArNjEs
NiBAQCBsZXQgcmVjb25uZWN0IHQgPSBtYXRjaCB0LmJhY2tlbmQgd2l0aAog
CQlYc19yaW5nLmNsb3NlIGJhY2tlbmQubW1hcDsKIAkJYmFja2VuZC5ldmVu
dGNobl9ub3RpZnkgKCk7CiAJCSgqIENsZWFyIG91ciBvbGQgY29ubmVjdGlv
biBzdGF0ZSAqKQotCQlRdWV1ZS5jbGVhciB0LnBrdF9pbjsKIAkJUXVldWUu
Y2xlYXIgdC5wa3Rfb3V0OwogCQl0LnBhcnRpYWxfaW4gPC0gaW5pdF9wYXJ0
aWFsX2luICgpOwogCQl0LnBhcnRpYWxfb3V0IDwtICIiCkBAIC0xMjQsNyAr
MTIyLDYgQEAgbGV0IG91dHB1dCBjb24gPQogCiAoKiBOQjogY2FuIHRocm93
IFJlY29ubmVjdCAqKQogbGV0IGlucHV0IGNvbiA9Ci0JbGV0IG5ld3BhY2tl
dCA9IHJlZiBmYWxzZSBpbgogCWxldCB0b19yZWFkID0KIAkJbWF0Y2ggY29u
LnBhcnRpYWxfaW4gd2l0aAogCQl8IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4g
UGFydGlhbC50b19jb21wbGV0ZSBwYXJ0aWFsX3BrdApAQCAtMTQzLDIxICsx
NDAsMTkgQEAgbGV0IGlucHV0IGNvbiA9CiAJCWlmIFBhcnRpYWwudG9fY29t
cGxldGUgcGFydGlhbF9wa3QgPSAwIHRoZW4gKAogCQkJbGV0IHBrdCA9IFBh
Y2tldC5vZl9wYXJ0aWFscGt0IHBhcnRpYWxfcGt0IGluCiAJCQljb24ucGFy
dGlhbF9pbiA8LSBpbml0X3BhcnRpYWxfaW4gKCk7Ci0JCQlRdWV1ZS5wdXNo
IHBrdCBjb24ucGt0X2luOwotCQkJbmV3cGFja2V0IDo9IHRydWUKLQkJKQor
CQkJU29tZSBwa3QKKwkJKSBlbHNlIE5vbmUKIAl8IE5vSGRyIChpLCBidWYp
ICAgICAgLT4KIAkJKCogd2UgY29tcGxldGUgdGhlIHBhcnRpYWwgaGVhZGVy
ICopCiAJCWlmIHN6ID4gMCB0aGVuCiAJCQlCeXRlcy5ibGl0IGIgMCBidWYg
KFBhcnRpYWwuaGVhZGVyX3NpemUgKCkgLSBpKSBzejsKIAkJY29uLnBhcnRp
YWxfaW4gPC0gaWYgc3ogPSBpIHRoZW4KLQkJCUhhdmVIZHIgKFBhcnRpYWwu
b2Zfc3RyaW5nIChCeXRlcy50b19zdHJpbmcgYnVmKSkgZWxzZSBOb0hkciAo
aSAtIHN6LCBidWYpCi0JKTsKLQkhbmV3cGFja2V0CisJCQlIYXZlSGRyIChQ
YXJ0aWFsLm9mX3N0cmluZyAoQnl0ZXMudG9fc3RyaW5nIGJ1ZikpIGVsc2Ug
Tm9IZHIgKGkgLSBzeiwgYnVmKTsKKwkJTm9uZQorCSkKIAogbGV0IG5ld2Nv
biBiYWNrZW5kID0gewogCWJhY2tlbmQgPSBiYWNrZW5kOwotCXBrdF9pbiA9
IFF1ZXVlLmNyZWF0ZSAoKTsKIAlwa3Rfb3V0ID0gUXVldWUuY3JlYXRlICgp
OwogCXBhcnRpYWxfaW4gPSBpbml0X3BhcnRpYWxfaW4gKCk7CiAJcGFydGlh
bF9vdXQgPSAiIjsKQEAgLTE5Myw5ICsxODgsNiBAQCBsZXQgaGFzX291dHB1
dCBjb24gPSBoYXNfbmV3X291dHB1dCBjb24gfHwgaGFzX29sZF9vdXRwdXQg
Y29uCiAKIGxldCBwZWVrX291dHB1dCBjb24gPSBRdWV1ZS5wZWVrIGNvbi5w
a3Rfb3V0CiAKLWxldCBpbnB1dF9sZW4gY29uID0gUXVldWUubGVuZ3RoIGNv
bi5wa3RfaW4KLWxldCBoYXNfaW5fcGFja2V0IGNvbiA9IFF1ZXVlLmxlbmd0
aCBjb24ucGt0X2luID4gMAotbGV0IGdldF9pbl9wYWNrZXQgY29uID0gUXVl
dWUucG9wIGNvbi5wa3RfaW4KIGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24g
PSBtYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCiAJfCBIYXZlSGRyIF8gLT4g
dHJ1ZQogCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBQYXJ0aWFsLmhlYWRlcl9z
aXplICgpCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDc5NGUzNWJi
MzQzZS4uOTFjNjgyMTYyY2VhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNzcsNyArNzcsNyBAQCB2YWwgd3JpdGVfZmQgOiBiYWNrZW5kX2Zk
IC0+ICdhIC0+IHN0cmluZyAtPiBpbnQgLT4gaW50CiB2YWwgd3JpdGVfbW1h
cCA6IGJhY2tlbmRfbW1hcCAtPiAnYSAtPiBzdHJpbmcgLT4gaW50IC0+IGlu
dAogdmFsIHdyaXRlIDogdCAtPiBzdHJpbmcgLT4gaW50IC0+IGludAogdmFs
IG91dHB1dCA6IHQgLT4gYm9vbAotdmFsIGlucHV0IDogdCAtPiBib29sCit2
YWwgaW5wdXQgOiB0IC0+IFBhY2tldC50IG9wdGlvbgogdmFsIG5ld2NvbiA6
IGJhY2tlbmQgLT4gdAogdmFsIG9wZW5fZmQgOiBVbml4LmZpbGVfZGVzY3Ig
LT4gdAogdmFsIG9wZW5fbW1hcCA6IFhlbm1tYXAubW1hcF9pbnRlcmZhY2Ug
LT4gKHVuaXQgLT4gdW5pdCkgLT4gdApAQCAtODksMTAgKzg5LDcgQEAgdmFs
IGhhc19uZXdfb3V0cHV0IDogdCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRw
dXQgOiB0IC0+IGJvb2wKIHZhbCBoYXNfb3V0cHV0IDogdCAtPiBib29sCiB2
YWwgcGVla19vdXRwdXQgOiB0IC0+IFBhY2tldC50Ci12YWwgaW5wdXRfbGVu
IDogdCAtPiBpbnQKLXZhbCBoYXNfaW5fcGFja2V0IDogdCAtPiBib29sCiB2
YWwgaGFzX3BhcnRpYWxfaW5wdXQgOiB0IC0+IGJvb2wKLXZhbCBnZXRfaW5f
cGFja2V0IDogdCAtPiBQYWNrZXQudAogdmFsIGhhc19tb3JlX2lucHV0IDog
dCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4gYm9vbAogdmFs
IGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sIGIvdG9vbHMvb2NhbWwvbGli
cy94cy94c3Jhdy5tbAppbmRleCBkOTgyZmIyNGRiYjEuLjQ1MWY4YjM4ZGJj
YyAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94cy94c3Jhdy5tbAor
KysgYi90b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sCkBAIC05NCwyNiAr
OTQsMTggQEAgbGV0IHBrdF9zZW5kIGNvbiA9CiAJZG9uZQogCiAoKiByZWNl
aXZlIG9uZSBwYWNrZXQgLSBjYW4gc2xlZXAgKikKLWxldCBwa3RfcmVjdiBj
b24gPQotCWxldCB3b3JrZG9uZSA9IHJlZiBmYWxzZSBpbgotCXdoaWxlIG5v
dCAhd29ya2RvbmUKLQlkbwotCQl3b3JrZG9uZSA6PSBYYi5pbnB1dCBjb24u
eGIKLQlkb25lOwotCVhiLmdldF9pbl9wYWNrZXQgY29uLnhiCitsZXQgcmVj
IHBrdF9yZWN2IGNvbiA9CisJbWF0Y2ggWGIuaW5wdXQgY29uLnhiIHdpdGgK
Kwl8IFNvbWUgcGFja2V0IC0+IHBhY2tldAorCXwgTm9uZSAtPiBwa3RfcmVj
diBjb24KIAogbGV0IHBrdF9yZWN2X3RpbWVvdXQgY29uIHRpbWVvdXQgPQog
CWxldCBmZCA9IFhiLmdldF9mZCBjb24ueGIgaW4KIAlsZXQgciwgXywgXyA9
IFVuaXguc2VsZWN0IFsgZmQgXSBbXSBbXSB0aW1lb3V0IGluCiAJaWYgciA9
IFtdIHRoZW4KIAkJdHJ1ZSwgTm9uZQotCWVsc2UgKAotCQlsZXQgd29ya2Rv
bmUgPSBYYi5pbnB1dCBjb24ueGIgaW4KLQkJaWYgd29ya2RvbmUgdGhlbgot
CQkJZmFsc2UsIChTb21lIChYYi5nZXRfaW5fcGFja2V0IGNvbi54YikpCi0J
CWVsc2UKLQkJCWZhbHNlLCBOb25lCi0JKQorCWVsc2UKKwkJZmFsc2UsIFhi
LmlucHV0IGNvbi54YgogCiBsZXQgcXVldWVfd2F0Y2hldmVudCBjb24gZGF0
YSA9CiAJbGV0IGxzID0gc3BsaXRfc3RyaW5nIH5saW1pdDoyICdcMDAwJyBk
YXRhIGluCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbi5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCmluZGV4IDM4YjQ3MzYzYTE3My4uY2MyMGUwNDdkMmI5IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbAorKysg
Yi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbApAQCAtMjc3
LDkgKzI3Nyw3IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAJ
SGFzaHRibC5maW5kIGNvbi50cmFuc2FjdGlvbnMgdGlkCiAKIGxldCBkb19p
bnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCi1sZXQgaGFzX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNvbi54YgogbGV0
IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfcGFydGlh
bF9pbnB1dCBjb24ueGIKLWxldCBwb3BfaW4gY29uID0gWGVuYnVzLlhiLmdl
dF9pbl9wYWNrZXQgY29uLnhiCiBsZXQgaGFzX21vcmVfaW5wdXQgY29uID0g
WGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54YgogCiBsZXQgaGFzX291
dHB1dCBjb24gPSBYZW5idXMuWGIuaGFzX291dHB1dCBjb24ueGIKQEAgLTMw
Nyw3ICszMDUsNyBAQCBsZXQgaXNfYmFkIGNvbiA9IG1hdGNoIGNvbi5kb20g
d2l0aCBOb25lIC0+IGZhbHNlIHwgU29tZSBkb20gLT4gRG9tYWluLmlzX2Jh
ZF9kbwogICAgUmVzdHJpY3Rpb25zIGJlbG93IGNhbiBiZSByZWxheGVkIG9u
Y2UgeGVuc3RvcmVkIGxlYXJucyB0byBkdW1wIG1vcmUKICAgIG9mIGl0cyBs
aXZlIHN0YXRlIGluIGEgc2FmZSB3YXkgKikKIGxldCBoYXNfZXh0cmFfY29u
bmVjdGlvbl9kYXRhIGNvbiA9Ci0JbGV0IGhhc19pbiA9IGhhc19pbnB1dCBj
b24gfHwgaGFzX3BhcnRpYWxfaW5wdXQgY29uIGluCisJbGV0IGhhc19pbiA9
IGhhc19wYXJ0aWFsX2lucHV0IGNvbiBpbgogCWxldCBoYXNfb3V0ID0gaGFz
X291dHB1dCBjb24gaW4KIAlsZXQgaGFzX3NvY2tldCA9IGNvbi5kb20gPSBO
b25lIGluCiAJbGV0IGhhc19ub25kZWZhdWx0X3Blcm1zID0gbWFrZV9wZXJt
IGNvbi5kb20gPD4gY29uLnBlcm0gaW4KZGlmZiAtLWdpdCBhL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL3Byb2Nlc3MubWwKaW5kZXggNmEzNDM1YzI2NWQzLi4yZDY3NDU2YTJh
YTAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNz
Lm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sCkBA
IC0xOTUsMTAgKzE5NSw5IEBAIGxldCBwYXJzZV9saXZlX3VwZGF0ZSBhcmdz
ID0KIAkJCXwgXyB3aGVuIFVuaXguZ2V0dGltZW9mZGF5ICgpIDwgdC5kZWFk
bGluZSAtPiBmYWxzZQogCQkJfCBsIC0+CiAJCQkJd2FybiAidGltZW91dCBy
ZWFjaGVkOiBoYXZlIHRvIHdhaXQsIG1pZ3JhdGUgb3Igc2h1dGRvd24gJWQg
ZG9tYWluczoiIChMaXN0Lmxlbmd0aCBsKTsKLQkJCQlsZXQgbXNncyA9IExp
c3QucmV2X21hcCAoZnVuIGNvbiAtPiBQcmludGYuc3ByaW50ZiAiJXM6ICVk
IHR4LCBpbjogJWIsIG91dDogJWIsIHBlcm06ICVzIgorCQkJCWxldCBtc2dz
ID0gTGlzdC5yZXZfbWFwIChmdW4gY29uIC0+IFByaW50Zi5zcHJpbnRmICIl
czogJWQgdHgsIG91dDogJWIsIHBlcm06ICVzIgogCQkJCQkoQ29ubmVjdGlv
bi5nZXRfZG9tc3RyIGNvbikKIAkJCQkJKENvbm5lY3Rpb24ubnVtYmVyX29m
X3RyYW5zYWN0aW9ucyBjb24pCi0JCQkJCShDb25uZWN0aW9uLmhhc19pbnB1
dCBjb24pCiAJCQkJCShDb25uZWN0aW9uLmhhc19vdXRwdXQgY29uKQogCQkJ
CQkoQ29ubmVjdGlvbi5nZXRfcGVybSBjb24gfD4gUGVybXMuQ29ubmVjdGlv
bi50b19zdHJpbmcpCiAJCQkJCSkgbCBpbgpAQCAtNzA1LDE2ICs3MDQsMTcg
QEAgbGV0IGRvX2lucHV0IHN0b3JlIGNvbnMgZG9tcyBjb24gPQogCQkJaW5m
byAiJXMgcmVxdWVzdHMgYSByZWNvbm5lY3QiIChDb25uZWN0aW9uLmdldF9k
b21zdHIgY29uKTsKIAkJCUhpc3RvcnkucmVjb25uZWN0IGNvbjsKIAkJCWlu
Zm8gIiVzIHJlY29ubmVjdGlvbiBjb21wbGV0ZSIgKENvbm5lY3Rpb24uZ2V0
X2RvbXN0ciBjb24pOwotCQkJZmFsc2UKKwkJCU5vbmUKIAkJfCBGYWlsdXJl
IGV4cCAtPgogCQkJZXJyb3IgImNhdWdodCBleGNlcHRpb24gJXMiIGV4cDsK
IAkJCWVycm9yICJnb3QgYSBiYWQgY2xpZW50ICVzIiAoc3ByaW50ZiAiJS04
cyIgKENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24pKTsKIAkJCUNvbm5lY3Rp
b24ubWFya19hc19iYWQgY29uOwotCQkJZmFsc2UKKwkJCU5vbmUKIAlpbgog
Ci0JaWYgbmV3cGFja2V0IHRoZW4gKAotCQlsZXQgcGFja2V0ID0gQ29ubmVj
dGlvbi5wb3BfaW4gY29uIGluCisJbWF0Y2ggbmV3cGFja2V0IHdpdGgKKwl8
IE5vbmUgLT4gKCkKKwl8IFNvbWUgcGFja2V0IC0+CiAJCWxldCB0aWQsIHJp
ZCwgdHksIGRhdGEgPSBYZW5idXMuWGIuUGFja2V0LnVucGFjayBwYWNrZXQg
aW4KIAkJbGV0IHJlcSA9IHtQYWNrZXQudGlkPXRpZDsgUGFja2V0LnJpZD1y
aWQ7IFBhY2tldC50eT10eTsgUGFja2V0LmRhdGE9ZGF0YX0gaW4KIApAQCAt
NzI0LDggKzcyNCw3IEBAIGxldCBkb19pbnB1dCBzdG9yZSBjb25zIGRvbXMg
Y29uID0KIAkJICAgICAgICAgKFhlbmJ1cy5YYi5PcC50b19zdHJpbmcgdHkp
IChzYW5pdGl6ZV9kYXRhIGRhdGEpOyAqKQogCQlwcm9jZXNzX3BhY2tldCB+
c3RvcmUgfmNvbnMgfmRvbXMgfmNvbiB+cmVxOwogCQl3cml0ZV9hY2Nlc3Nf
bG9nIH50eSB+dGlkIH5jb246KENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24p
IH5kYXRhOwotCQlDb25uZWN0aW9uLmluY3Jfb3BzIGNvbjsKLQkpCisJCUNv
bm5lY3Rpb24uaW5jcl9vcHMgY29uCiAKIGxldCBkb19vdXRwdXQgX3N0b3Jl
IF9jb25zIF9kb21zIGNvbiA9CiAJaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0
IGNvbiB0aGVuICgK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSAyNDQwYThiNjlhMTE4ZmUxNGU3M2ViNmNhYjRhMDUwOTIyODY2ZjFh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94YjogQWRkIEJvdW5kZWRRdWV1ZQpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKRW5zdXJl
cyB3ZSBjYW5ub3Qgc3RvcmUgbW9yZSB0aGFuIFtjYXBhY2l0eV0gZWxlbWVu
dHMgaW4gYSBbUXVldWVdLiAgUmVwbGFjaW5nCmFsbCBRdWV1ZSB3aXRoIHRo
aXMgbW9kdWxlIHdpbGwgdGhlbiBlbnN1cmUgYXQgY29tcGlsZSB0aW1lIHRo
YXQgYWxsIFF1ZXVlcwphcmUgY29ycmVjdGx5IGJvdW5kIGNoZWNrZWQuCgpF
YWNoIGVsZW1lbnQgaW4gdGhlIHF1ZXVlIGhhcyBhIGNsYXNzIHdpdGggaXRz
IG93biBsaW1pdHMuICBUaGlzLCBpbiBhCnN1YnNlcXVlbnQgY2hhbmdlLCB3
aWxsIGVuc3VyZSB0aGF0IGNvbW1hbmQgcmVzcG9uc2VzIGNhbiBwcm9jZWVk
IGR1cmluZyBhCmZsb29kIG9mIHdhdGNoIGV2ZW50cy4KCk5vIGZ1bmN0aW9u
YWwgY2hhbmdlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRl
ZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVk
LW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcgPGNocmlzdGlhbi5saW5k
aWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJz
L3hiL3hiLm1sIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbAppbmRleCAx
NjVmZDRhMWVkZjQuLjQxOTdhMzg4OGE2OCAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwvbGlicy94Yi94Yi5tbAorKysgYi90b29scy9vY2FtbC9saWJzL3hi
L3hiLm1sCkBAIC0xNyw2ICsxNyw5OCBAQAogbW9kdWxlIE9wID0gc3RydWN0
IGluY2x1ZGUgT3AgZW5kCiBtb2R1bGUgUGFja2V0ID0gc3RydWN0IGluY2x1
ZGUgUGFja2V0IGVuZAogCittb2R1bGUgQm91bmRlZFF1ZXVlIDogc2lnCisJ
dHlwZSAoJ2EsICdiKSB0CisKKwkoKiogW2NyZWF0ZSB+Y2FwYWNpdHkgfmNs
YXNzaWZ5IH5saW1pdF0gY3JlYXRlcyBhIHF1ZXVlIHdpdGggbWF4aW11bSBb
Y2FwYWNpdHldIGVsZW1lbnRzLgorCSAgICBUaGlzIGlzIGJ1cnN0IGNhcGFj
aXR5LCBlYWNoIGVsZW1lbnQgaXMgZnVydGhlciBjbGFzc2lmaWVkIGFjY29y
ZGluZyB0byBbY2xhc3NpZnldLAorCSAgICBhbmQgZWFjaCBjbGFzcyBjYW4g
aGF2ZSBpdHMgb3duIFtsaW1pdF0uCisJICAgIFtjYXBhY2l0eV0gaXMgZW5m
b3JjZWQgYXMgYW4gb3ZlcmFsbCBsaW1pdC4KKwkgICAgVGhlIFtsaW1pdF0g
Y2FuIGJlIGR5bmFtaWMsIGFuZCBjYW4gYmUgc21hbGxlciB0aGFuIHRoZSBu
dW1iZXIgb2YgZWxlbWVudHMgYWxyZWFkeSBxdWV1ZWQgb2YgdGhhdCBjbGFz
cywKKwkgICAgaW4gd2hpY2ggY2FzZSB0aG9zZSBlbGVtZW50cyBhcmUgY29u
c2lkZXJlZCB0byB1c2UgImJ1cnN0IGNhcGFjaXR5Ii4KKwkgICopCisJdmFs
IGNyZWF0ZTogY2FwYWNpdHk6aW50IC0+IGNsYXNzaWZ5OignYSAtPiAnYikg
LT4gbGltaXQ6KCdiIC0+IGludCkgLT4gKCdhLCAnYikgdAorCisJKCoqIFtj
bGVhciBxXSBkaXNjYXJkcyBhbGwgZWxlbWVudHMgZnJvbSBbcV0gKikKKwl2
YWwgY2xlYXI6ICgnYSwgJ2IpIHQgLT4gdW5pdAorCisJKCoqIFtjYW5fcHVz
aCBxXSB3aGVuIFtsZW5ndGggcSA8IGNhcGFjaXR5XS4JKikKKwl2YWwgY2Fu
X3B1c2g6ICgnYSwgJ2IpIHQgLT4gJ2IgLT4gYm9vbAorCisJKCoqIFtwdXNo
IGUgcV0gYWRkcyBbZV0gYXQgdGhlIGVuZCBvZiBxdWV1ZSBbcV0gaWYgW2Nh
bl9wdXNoIHFdLCBvciByZXR1cm5zIFtOb25lXS4gKikKKwl2YWwgcHVzaDog
J2EgLT4gKCdhLCAnYikgdCAtPiB1bml0IG9wdGlvbgorCisJKCoqIFtwb3Ag
cV0gcmVtb3ZlcyBhbmQgcmV0dXJucyBmaXJzdCBlbGVtZW50IGluIFtxXSwg
b3IgcmFpc2VzIFtRdWV1ZS5FbXB0eV0uICopCisJdmFsIHBvcDogKCdhLCAn
YikgdCAtPiAnYQorCisJKCoqIFtwZWVrIHFdIHJldHVybnMgdGhlIGZpcnN0
IGVsZW1lbnQgaW4gW3FdLCBvciByYWlzZXMgW1F1ZXVlLkVtcHR5XS4gICop
CisJdmFsIHBlZWsgOiAoJ2EsICdiKSB0IC0+ICdhCisKKwkoKiogW2xlbmd0
aCBxXSByZXR1cm5zIHRoZSBjdXJyZW50IG51bWJlciBvZiBlbGVtZW50cyBp
biBbcV0gKikKKwl2YWwgbGVuZ3RoOiAoJ2EsICdiKSB0IC0+IGludAorCisJ
KCoqIFtkZWJ1ZyBzdHJpbmdfb2ZfY2xhc3MgcV0gcHJpbnRzIHF1ZXVlIHVz
YWdlIHN0YXRpc3RpY3MgaW4gYW4gdW5zcGVjaWZpZWQgaW50ZXJuYWwgZm9y
bWF0LiAqKQorCXZhbCBkZWJ1ZzogKCdiIC0+IHN0cmluZykgLT4gKF8sICdi
KSB0IC0+IHN0cmluZworZW5kID0gc3RydWN0CisJdHlwZSAoJ2EsICdiKSB0
ID0KKwkJeyBxOiAnYSBRdWV1ZS50CisJCTsgY2FwYWNpdHk6IGludAorCQk7
IGNsYXNzaWZ5OiAnYSAtPiAnYgorCQk7IGxpbWl0OiAnYiAtPiBpbnQKKwkJ
OyBjbGFzc19jb3VudDogKCdiLCBpbnQpIEhhc2h0YmwudAorCQl9CisKKwls
ZXQgY3JlYXRlIH5jYXBhY2l0eSB+Y2xhc3NpZnkgfmxpbWl0ID0KKwkJeyBj
YXBhY2l0eTsgcSA9IFF1ZXVlLmNyZWF0ZSAoKTsgY2xhc3NpZnk7IGxpbWl0
OyBjbGFzc19jb3VudCA9IEhhc2h0YmwuY3JlYXRlIDMgfQorCisJbGV0IGdl
dF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uID0gdHJ5IEhhc2h0YmwuZmluZCB0
LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIHdpdGggTm90X2ZvdW5kIC0+
IDAKKworCWxldCBjYW5fcHVzaF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9u
IGNsYXNzX2NvdW50ID0KKwkJUXVldWUubGVuZ3RoIHQucSA8IHQuY2FwYWNp
dHkgJiYgY2xhc3NfY291bnQgPCB0LmxpbWl0IGNsYXNzaWZpY2F0aW9uCisK
KwlsZXQgb2sgPSBTb21lICgpCisKKwlsZXQgcHVzaCBlIHQgPQorCQlsZXQg
Y2xhc3NpZmljYXRpb24gPSB0LmNsYXNzaWZ5IGUgaW4KKwkJbGV0IGNsYXNz
X2NvdW50ID0gZ2V0X2NvdW50IHQgY2xhc3NpZmljYXRpb24gaW4KKwkJaWYg
Y2FuX3B1c2hfaW50ZXJuYWwgdCBjbGFzc2lmaWNhdGlvbiBjbGFzc19jb3Vu
dCB0aGVuIGJlZ2luCisJCQlRdWV1ZS5wdXNoIGUgdC5xOworCQkJSGFzaHRi
bC5yZXBsYWNlIHQuY2xhc3NfY291bnQgY2xhc3NpZmljYXRpb24gKGNsYXNz
X2NvdW50ICsgMSk7CisJCQlvaworCQllbmQKKwkJZWxzZQorCQkJTm9uZQor
CisJbGV0IGNhbl9wdXNoIHQgY2xhc3NpZmljYXRpb24gPQorCQljYW5fcHVz
aF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9uIEBAIGdldF9jb3VudCB0IGNs
YXNzaWZpY2F0aW9uCisKKwlsZXQgY2xlYXIgdCA9CisJCVF1ZXVlLmNsZWFy
IHQucTsKKwkJSGFzaHRibC5yZXNldCB0LmNsYXNzX2NvdW50CisKKwlsZXQg
cG9wIHQgPQorCQlsZXQgZSA9IFF1ZXVlLnBvcCB0LnEgaW4KKwkJbGV0IGNs
YXNzaWZpY2F0aW9uID0gdC5jbGFzc2lmeSBlIGluCisJCWxldCAoKSA9IG1h
dGNoIGdldF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uIC0gMSB3aXRoCisJCXwg
MCAtPiBIYXNodGJsLnJlbW92ZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0
aW9uICgqIHJlZHVjZXMgbWVtdXNhZ2UgKikKKwkJfCBuIC0+IEhhc2h0Ymwu
cmVwbGFjZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIG4KKwkJaW4K
KwkJZQorCisJbGV0IHBlZWsgdCA9IFF1ZXVlLnBlZWsgdC5xCisJbGV0IGxl
bmd0aCB0ID0gUXVldWUubGVuZ3RoIHQucQorCisJbGV0IGRlYnVnIHN0cmlu
Z19vZl9jbGFzcyB0ID0KKwkJbGV0IGIgPSBCdWZmZXIuY3JlYXRlIDEyOCBp
bgorCQlQcmludGYuYnByaW50ZiBiICJCb3VuZGVkUXVldWUgY2FwYWNpdHk6
ICVkLCB1c2VkOiB7IiB0LmNhcGFjaXR5OworCQlIYXNodGJsLml0ZXIgKGZ1
biBwYWNrZXRfY2xhc3MgY291bnQgLT4KKwkJCVByaW50Zi5icHJpbnRmIGIg
IgklczogJWQiIChzdHJpbmdfb2ZfY2xhc3MgcGFja2V0X2NsYXNzKSBjb3Vu
dAorCQkpIHQuY2xhc3NfY291bnQ7CisJCVByaW50Zi5icHJpbnRmIGIgIn0i
OworCQlCdWZmZXIuY29udGVudHMgYgorZW5kCisKKwogZXhjZXB0aW9uIEVu
ZF9vZl9maWxlCiBleGNlcHRpb24gRWFnYWluCiBleGNlcHRpb24gTm9lbnQK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSBiYzBmMDVlNmYzYTNjOTNjODUzY2VmZmQxZjZkMjAyMmRjMzBmYjc3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNCArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogTGltaXQgbWF4aW11bSBpbi1mbGlnaHQgcmVx
dWVzdHMgLyBvdXRzdGFuZGluZyByZXBsaWVzCk1JTUUtVmVyc2lvbjogMS4w
CkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250
ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA4Yml0CgpJbnRyb2R1Y2UgYSBsaW1p
dCBvbiB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcGx5IHBhY2tldHMg
aW4gdGhlIHhlbmJ1cwpxdWV1ZS4gIFRoaXMgbGltaXRzIHRoZSBudW1iZXIg
b2YgaW4tZmxpZ2h0IHJlcXVlc3RzOiB3aGVuIHRoZSBvdXRwdXQgcXVldWUg
aXMKZnVsbCB3ZSdsbCBzdG9wIHByb2Nlc3NpbmcgaW5wdXRzIHVudGlsIHRo
ZSBvdXRwdXQgcXVldWUgaGFzIHJvb20gYWdhaW4uCgpUbyBhdm9pZCBhIGJ1
c3kgbG9vcCBvbiB0aGUgVW5peCBzb2NrZXQgd2Ugb25seSBhZGQgaXQgdG8g
dGhlIHdhdGNoZWQgaW5wdXQKZmlsZSBkZXNjcmlwdG9yIHNldCBpZiB3ZSdk
IGJlIGFibGUgdG8gY2FsbCBgaW5wdXRgIG9uIGl0LiAgRXZlbiB0aG91Z2gg
RG9tMAppcyB0cnVzdGVkIGFuZCBleGVtcHQgZnJvbSBxdW90YXMgYSBmbG9v
ZCBvZiBldmVudHMgbWlnaHQgY2F1c2UgYSBiYWNrbG9nCndoZXJlIGV2ZW50
cyBhcmUgcHJvZHVjZWQgZmFzdGVyIHRoYW4gZGFlbW9ucyBpbiBEb20wIGNh
biBjb25zdW1lIHRoZW0sIHdoaWNoCmNvdWxkIGxlYWQgdG8gYW4gdW5ib3Vu
ZGVkIHF1ZXVlIHNpemUgYW5kIE9PTS4KClRoZXJlZm9yZSB0aGUgeGVuYnVz
IHF1ZXVlIGxpbWl0IG11c3QgYXBwbHkgdG8gYWxsIGNvbm5lY3Rpb25zLCBE
b20wIGlzIG5vdApleGVtcHQgZnJvbSBpdCwgYWx0aG91Z2ggaWYgZXZlcnl0
aGluZyB3b3JrcyBjb3JyZWN0bHkgaXQgd2lsbCBldmVudHVhbGx5CmNhdGNo
IHVwLgoKVGhpcyBwcmV2ZW50cyBhIG1hbGljaW91cyBndWVzdCBmcm9tIHNl
bmRpbmcgbW9yZSBjb21tYW5kcyB3aGlsZSBpdCBoYXMKb3V0c3RhbmRpbmcg
d2F0Y2ggZXZlbnRzIG9yIGNvbW1hbmQgcmVwbGllcyBpbiBpdHMgaW5wdXQg
cmluZy4gIEhvd2V2ZXIgaWYgaXQKY2FuIGNhdXNlIHRoZSBnZW5lcmF0aW9u
IG9mIHdhdGNoIGV2ZW50cyBieSBvdGhlciBtZWFucyAoZS5nLiBieSBEb20w
LCBvcgphbm90aGVyIGNvb3BlcmF0aXZlIGd1ZXN0KSBhbmQgc3RvcCByZWFk
aW5nIGl0cyBvd24gcmluZyB0aGVuIHdhdGNoIGV2ZW50cwp3b3VsZCd2ZSBx
dWV1ZWQgdXAgd2l0aG91dCBsaW1pdC4KClRoZSB4ZW5zdG9yZSBwcm90b2Nv
bCBkb2Vzbid0IGhhdmUgYSBiYWNrLXByZXNzdXJlIG1lY2hhbmlzbSwgYW5k
IGRvZXNuJ3QKYWxsb3cgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzLiAgSW4gZmFj
dCwgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzIGlzIGtub3duIHRvIGJyZWFrCnNv
bWUgcGllY2VzIG9mIG5vcm1hbCBmdW5jdGlvbmFsaXR5LiAgVGhpcyBsZWF2
ZXMgbGl0dGxlIGNob2ljZSB0byBzYWZlbHkKaW1wbGVtZW50IHRoZSB4ZW5z
dG9yZSBwcm90b2NvbCB3aXRob3V0IGV4cG9zaW5nIHRoZSB4ZW5zdG9yZSBk
YWVtb24gdG8Kb3V0LW9mLW1lbW9yeSBhdHRhY2tzLgoKSW1wbGVtZW50IHRo
ZSBmaXggYXMgcGlwZXMgd2l0aCBib3VuZGVkIGJ1ZmZlcnM6CiogVXNlIGEg
Ym91bmRlZCBidWZmZXIgZm9yIHdhdGNoIGV2ZW50cwoqIFRoZSB3YXRjaCBz
dHJ1Y3R1cmUgd2lsbCBoYXZlIGEgYm91bmRlZCByZWNlaXZpbmcgcGlwZSBv
ZiB3YXRjaCBldmVudHMKKiBUaGUgc291cmNlIHdpbGwgaGF2ZSBhbiAib3Zl
cmZsb3ciIHBpcGUgb2YgcGVuZGluZyB3YXRjaCBldmVudHMgaXQgY291bGRu
J3QKICBkZWxpdmVyCgpJdGVtcyBhcmUgcXVldWVkIHVwIG9uIG9uZSBlbmQg
YW5kIGFyZSBzZW50IGFzIGZhciBhbG9uZyB0aGUgcGlwZSBhcyBwb3NzaWJs
ZToKCiAgc291cmNlIGRvbWFpbiAtPiB3YXRjaCAtPiB4ZW5idXMgb2YgdGFy
Z2V0IC0+IHhlbnN0b3JlIHJpbmcvc29ja2V0IG9mIHRhcmdldAoKSWYgdGhl
IHBpcGUgaXMgImZ1bGwiIGF0IGFueSBwb2ludCB0aGVuIGJhY2stcHJlc3N1
cmUgaXMgYXBwbGllZCBhbmQgd2UgcHJldmVudAptb3JlIGl0ZW1zIGZyb20g
YmVpbmcgcXVldWVkIHVwLiAgRm9yIHRoZSBzb3VyY2UgZG9tYWluIHRoaXMg
bWVhbnMgdGhhdCB3ZSdsbApzdG9wIGFjY2VwdGluZyBuZXcgY29tbWFuZHMg
YXMgbG9uZyBhcyBpdHMgcGlwZSBidWZmZXIgaXMgbm90IGVtcHR5LgoKQmVm
b3JlIHdlIHRyeSB0byBlbnF1ZXVlIGFuIGl0ZW0gd2UgZmlyc3QgY2hlY2sg
d2hldGhlciBpdCBpcyBwb3NzaWJsZSB0byBzZW5kCml0IGZ1cnRoZXIgZG93
biB0aGUgcGlwZSwgYnkgYXR0ZW1wdGluZyB0byByZWN1cnNpdmVseSBmbHVz
aCB0aGUgcGlwZXMuIFRoaXMKZW5zdXJlcyB0aGF0IHdlIHJldGFpbiB0aGUg
b3JkZXIgb2YgZXZlbnRzIGFzIG11Y2ggYXMgcG9zc2libGUuCgpXZSBtaWdo
dCBicmVhayBjYXVzYWxpdHkgb2Ygd2F0Y2ggZXZlbnRzIGlmIHRoZSB0YXJn
ZXQgZG9tYWluJ3MgcXVldWUgaXMgZnVsbAphbmQgd2UgbmVlZCB0byBzdGFy
dCB1c2luZyB0aGUgd2F0Y2gncyBxdWV1ZS4gIFRoaXMgaXMgYSBicmVha2lu
ZyBjaGFuZ2UgaW4KdGhlIHhlbnN0b3JlIHByb3RvY29sLCBidXQgb25seSBm
b3IgZG9tYWlucyB3aGljaCBhcmUgbm90IHByb2Nlc3NpbmcgdGhlaXIKaW5j
b21pbmcgcmluZyBhcyBleHBlY3RlZC4KCldoZW4gYSB3YXRjaCBpcyBkZWxl
dGVkIGl0cyBlbnRpcmUgcGVuZGluZyBxdWV1ZSBpcyBkcm9wcGVkIChubyBj
b2RlIGlzIG5lZWRlZApmb3IgdGhhdCwgYmVjYXVzZSBpdCBpcyBwYXJ0IG9m
IHRoZSAnd2F0Y2gnIHR5cGUpLgoKVGhlcmUgaXMgYSBjYWNoZSBvZiB3YXRj
aGVzIHRoYXQgaGF2ZSBwZW5kaW5nIGV2ZW50cyB0aGF0IHdlIGF0dGVtcHQg
dG8gZmx1c2gKYXQgZXZlcnkgY3ljbGUgaWYgcG9zc2libGUuCgpJbnRyb2R1
Y2UgMyBsaW1pdHMgaGVyZToKKiBxdW90YS1tYXh3YXRjaGV2ZW50cyBvbiB3
YXRjaCBldmVudCBkZXN0aW5hdGlvbjogd2hlbiB0aGlzIGlzIGhpdCB0aGUK
ICBzb3VyY2Ugd2lsbCBub3QgYmUgYWxsb3dlZCB0byBxdWV1ZSB1cCBtb3Jl
IHdhdGNoIGV2ZW50cy4KKiBxdW90YS1tYXhvdXN0YW5kaW5nIHdoaWNoIGlz
IHRoZSBudW1iZXIgb2YgcmVzcG9uc2VzIG5vdCByZWFkIGZyb20gdGhlIHJp
bmc6CiAgb25jZSBleGNlZWRlZCwgbm8gbW9yZSBpbnB1dHMgYXJlIHByb2Nl
c3NlZCB1bnRpbCBhbGwgb3V0c3RhbmRpbmcgcmVwbGllcwogIGFyZSBjb25z
dW1lZCBieSB0aGUgY2xpZW50LgoqIG92ZXJmbG93IHF1ZXVlIG9uIHRoZSB3
YXRjaCBldmVudCBzb3VyY2U6IGFsbCB3YXRjaGVzIHRoYXQgY2Fubm90IGJl
IHN0b3JlZAogIG9uIGRlc3RpbmF0aW9uIGFyZSBxdWV1ZWQgdXAgaGVyZSwg
YSBzaW5nbGUgY29tbWFuZCBjYW4gdHJpZ2dlciBtdWx0aXBsZQogIHdhdGNo
ZXMgKGUuZy4gZHVlIHRvIHJlY3Vyc2lvbikuCgpUaGUgb3ZlcmZsb3cgcXVl
dWUgY3VycmVudGx5IGRvZXNuJ3QgaGF2ZSBhbiB1cHBlciBib3VuZCwgaXQg
aXMgZGlmZmljdWx0IHRvCmFjY3VyYXRlbHkgY2FsY3VsYXRlIG9uZSBhcyBp
dCBkZXBlbmRzIG9uIHdoZXRoZXIgeW91IGFyZSBEb20wIGFuZCBob3cgbWFu
eQp3YXRjaGVzIGVhY2ggcGF0aCBoYXMgcmVnaXN0ZXJlZCBhbmQgaG93IG1h
bnkgd2F0Y2ggZXZlbnRzIHlvdSBjYW4gdHJpZ2dlcgp3aXRoIGEgc2luZ2xl
IGNvbW1hbmQgKGUuZy4gYSBjb21taXQpLiAgSG93ZXZlciB0aGVzZSBldmVu
dHMgd2VyZSBhbHJlYWR5CnVzaW5nIG1lbW9yeSwgdGhpcyBqdXN0IG1vdmVz
IHRoZW0gZWxzZXdoZXJlLCBhbmQgYXMgbG9uZyBhcyB3ZSBjb3JyZWN0bHkK
YmxvY2sgYSBkb21haW4gaXQgc2hvdWxkbid0IHJlc3VsdCBpbiB1bmJvdW5k
ZWQgbWVtb3J5IHVzYWdlLgoKTm90ZSB0aGF0IERvbTAgaXMgbm90IGV4Y2x1
ZGVkIGZyb20gdGhlc2UgY2hlY2tzLCBpdCBpcyBpbXBvcnRhbnQgdGhhdCBE
b20wIGlzCmVzcGVjaWFsbHkgbm90IGV4Y2x1ZGVkIHdoZW4gaXQgaXMgdGhl
IHNvdXJjZSwgc2luY2UgdGhlcmUgYXJlIG1hbnkgd2F5cyBpbgp3aGljaCBh
IGd1ZXN0IGNvdWxkIHRyaWdnZXIgRG9tMCB0byBzZW5kIGl0IHdhdGNoIGV2
ZW50cy4KClRoaXMgc2hvdWxkIHByb3RlY3QgYWdhaW5zdCBtYWxpY2lvdXMg
ZnJvbnRlbmRzIGFzIGxvbmcgYXMgdGhlIGJhY2tlbmQgZm9sbG93cwp0aGUg
UFYgeGVuc3RvcmUgcHJvdG9jb2wgYW5kIG9ubHkgZXhwb3NlcyBwYXRocyBu
ZWVkZWQgYnkgdGhlIGZyb250ZW5kLCBhbmQKY2hhbmdlcyB0aG9zZSBwYXRo
cyBhdCBtb3N0IG9uY2UgYXMgYSByZWFjdGlvbiB0byBndWVzdCBldmVudHMs
IG9yIHByb3RvY29sCnN0YXRlLgoKVGhlIHF1ZXVlIGxpbWl0cyBhcmUgcGVy
IHdhdGNoLCBhbmQgcGVyIGRvbWFpbi1wYWlyLCBzbyBldmVuIGlmIG9uZQpj
b21tdW5pY2F0aW9uIGNoYW5uZWwgd291bGQgYmUgImJsb2NrZWQiLCBvdGhl
cnMgd291bGQga2VlcCB3b3JraW5nLCBhbmQgdGhlCmRvbWFpbiBpdHNlbGYg
d29uJ3QgZ2V0IGJsb2NrZWQgYXMgbG9uZyBhcyBpdCBkb2Vzbid0IG92ZXJm
bG93IHRoZSBxdWV1ZSBvZgp3YXRjaCBldmVudHMuCgpTaW1pbGFybHkgYSBt
YWxpY2lvdXMgYmFja2VuZCBjb3VsZCBjYXVzZSB0aGUgZnJvbnRlbmQgdG8g
Z2V0IGJsb2NrZWQsIGJ1dAp0aGlzIHdhdGNoIHF1ZXVlIHByb3RlY3RzIHRo
ZSBmcm9udGVuZCBhcyB3ZWxsIGFzIGxvbmcgYXMgaXQgZm9sbG93cyB0aGUg
UFYKcHJvdG9jb2wuICAoQWx0aG91Z2ggbm90ZSB0aGF0IHByb3RlY3Rpb24g
YWdhaW5zdCBtYWxpY2lvdXMgYmFja2VuZHMgaXMgb25seSBhCmJlc3QgZWZm
b3J0IGF0IHRoZSBtb21lbnQpCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAv
IENWRS0yMDIyLTQyMzE4LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLD
tmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3Rp
YW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbCBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKaW5kZXggNDE5N2EzODg4YTY4Li5iMjkyZWQ3
YTg3NGQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwK
KysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbApAQCAtMTM0LDE0ICsx
MzQsNDQgQEAgdHlwZSBiYWNrZW5kID0gRmQgb2YgYmFja2VuZF9mZCB8IFhl
bm1tYXAgb2YgYmFja2VuZF9tbWFwCiAKIHR5cGUgcGFydGlhbF9idWYgPSBI
YXZlSGRyIG9mIFBhcnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMK
IAorKCoKKwlzZXBhcmF0ZSBjYXBhY2l0eSByZXNlcnZhdGlvbiBmb3IgcmVw
bGllcyBhbmQgd2F0Y2ggZXZlbnRzOgorCXRoaXMgYWxsb3dzIGEgZG9tYWlu
IHRvIGtlZXAgd29ya2luZyBldmVuIHdoZW4gdW5kZXIgYSBjb25zdGFudCBm
bG9vZCBvZgorCXdhdGNoIGV2ZW50cworKikKK3R5cGUgY2FwYWNpdHkgPSB7
IG1heG91dHN0YW5kaW5nOiBpbnQ7IG1heHdhdGNoZXZlbnRzOiBpbnQgfQor
Cittb2R1bGUgUXVldWUgPSBCb3VuZGVkUXVldWUKKwordHlwZSBwYWNrZXRf
Y2xhc3MgPQorCXwgQ29tbWFuZFJlcGx5CisJfCBXYXRjaGV2ZW50CisKK2xl
dCBzdHJpbmdfb2ZfcGFja2V0X2NsYXNzID0gZnVuY3Rpb24KKwl8IENvbW1h
bmRSZXBseSAtPiAiY29tbWFuZF9yZXBseSIKKwl8IFdhdGNoZXZlbnQgLT4g
IndhdGNoX2V2ZW50IgorCiB0eXBlIHQgPQogewogCWJhY2tlbmQ6IGJhY2tl
bmQ7Ci0JcGt0X291dDogUGFja2V0LnQgUXVldWUudDsKKwlwa3Rfb3V0OiAo
UGFja2V0LnQsIHBhY2tldF9jbGFzcykgUXVldWUudDsKIAltdXRhYmxlIHBh
cnRpYWxfaW46IHBhcnRpYWxfYnVmOwogCW11dGFibGUgcGFydGlhbF9vdXQ6
IHN0cmluZzsKKwljYXBhY2l0eTogY2FwYWNpdHkKIH0KIAorbGV0IHRvX3Jl
YWQgY29uID0KKwltYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCisJCXwgSGF2
ZUhkciBwYXJ0aWFsX3BrdCAtPiBQYXJ0aWFsLnRvX2NvbXBsZXRlIHBhcnRp
YWxfcGt0CisJCXwgTm9IZHIgICAoaSwgXykgICAgLT4gaQorCitsZXQgZGVi
dWcgdCA9CisJUHJpbnRmLnNwcmludGYgIlhlbkJ1cyBzdGF0ZTogcGFydGlh
bF9pbjogJWQgbmVlZGVkLCBwYXJ0aWFsX291dDogJWQgYnl0ZXMsIHBrdF9v
dXQ6ICVkIHBhY2tldHMsICVzIgorCQkodG9fcmVhZCB0KQorCQkoU3RyaW5n
Lmxlbmd0aCB0LnBhcnRpYWxfb3V0KQorCQkoUXVldWUubGVuZ3RoIHQucGt0
X291dCkKKwkJKEJvdW5kZWRRdWV1ZS5kZWJ1ZyBzdHJpbmdfb2ZfcGFja2V0
X2NsYXNzIHQucGt0X291dCkKKwogbGV0IGluaXRfcGFydGlhbF9pbiAoKSA9
IE5vSGRyCiAJKFBhcnRpYWwuaGVhZGVyX3NpemUgKCksIEJ5dGVzLm1ha2Ug
KFBhcnRpYWwuaGVhZGVyX3NpemUoKSkgJ1wwMDAnKQogCkBAIC0xOTksNyAr
MjI5LDggQEAgbGV0IG91dHB1dCBjb24gPQogCWxldCBzID0gaWYgU3RyaW5n
Lmxlbmd0aCBjb24ucGFydGlhbF9vdXQgPiAwIHRoZW4KIAkJCWNvbi5wYXJ0
aWFsX291dAogCQllbHNlIGlmIFF1ZXVlLmxlbmd0aCBjb24ucGt0X291dCA+
IDAgdGhlbgotCQkJUGFja2V0LnRvX3N0cmluZyAoUXVldWUucG9wIGNvbi5w
a3Rfb3V0KQorCQkJbGV0IHBrdCA9IFF1ZXVlLnBvcCBjb24ucGt0X291dCBp
bgorCQkJUGFja2V0LnRvX3N0cmluZyBwa3QKIAkJZWxzZQogCQkJIiIgaW4K
IAkoKiBzZW5kIGRhdGEgZnJvbSBzLCBhbmQgc2F2ZSB0aGUgdW5zZW50IGRh
dGEgdG8gcGFydGlhbF9vdXQgKikKQEAgLTIxMiwxMiArMjQzLDE1IEBAIGxl
dCBvdXRwdXQgY29uID0KIAkoKiBhZnRlciBzZW5kaW5nIG9uZSBwYWNrZXQs
IHBhcnRpYWwgaXMgZW1wdHkgKikKIAljb24ucGFydGlhbF9vdXQgPSAiIgog
CisoKiB3ZSBjYW4gb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCBpZiB3
ZSdyZSBndWFyYW50ZWVkIHRvIGhhdmUgcm9vbQorICAgdG8gc3RvcmUgdGhl
IHJlc3BvbnNlIHBhY2tldCAqKQorbGV0IGNhbl9pbnB1dCBjb24gPSBRdWV1
ZS5jYW5fcHVzaCBjb24ucGt0X291dCBDb21tYW5kUmVwbHkKKwogKCogTkI6
IGNhbiB0aHJvdyBSZWNvbm5lY3QgKikKIGxldCBpbnB1dCBjb24gPQotCWxl
dCB0b19yZWFkID0KLQkJbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAotCQl8
IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4gUGFydGlhbC50b19jb21wbGV0ZSBw
YXJ0aWFsX3BrdAotCQl8IE5vSGRyICAgKGksIF8pICAgIC0+IGkgaW4KKwlp
ZiBub3QgKGNhbl9pbnB1dCBjb24pIHRoZW4gTm9uZQorCWVsc2UKKwlsZXQg
dG9fcmVhZCA9IHRvX3JlYWQgY29uIGluCiAKIAkoKiB0cnkgdG8gZ2V0IG1v
cmUgZGF0YSBmcm9tIGlucHV0IHN0cmVhbSAqKQogCWxldCBiID0gQnl0ZXMu
bWFrZSB0b19yZWFkICdcMDAwJyBpbgpAQCAtMjQzLDExICsyNzcsMjIgQEAg
bGV0IGlucHV0IGNvbiA9CiAJCU5vbmUKIAkpCiAKLWxldCBuZXdjb24gYmFj
a2VuZCA9IHsKK2xldCBjbGFzc2lmeSB0ID0KKwltYXRjaCB0LlBhY2tldC50
eSB3aXRoCisJfCBPcC5XYXRjaGV2ZW50IC0+IFdhdGNoZXZlbnQKKwl8IF8g
LT4gQ29tbWFuZFJlcGx5CisKK2xldCBuZXdjb24gfmNhcGFjaXR5IGJhY2tl
bmQgPQorCWxldCBsaW1pdCA9IGZ1bmN0aW9uCisJCXwgQ29tbWFuZFJlcGx5
IC0+IGNhcGFjaXR5Lm1heG91dHN0YW5kaW5nCisJCXwgV2F0Y2hldmVudCAt
PiBjYXBhY2l0eS5tYXh3YXRjaGV2ZW50cworCWluCisJewogCWJhY2tlbmQg
PSBiYWNrZW5kOwotCXBrdF9vdXQgPSBRdWV1ZS5jcmVhdGUgKCk7CisJcGt0
X291dCA9IFF1ZXVlLmNyZWF0ZSB+Y2FwYWNpdHk6KGNhcGFjaXR5Lm1heG91
dHN0YW5kaW5nICsgY2FwYWNpdHkubWF4d2F0Y2hldmVudHMpIH5jbGFzc2lm
eSB+bGltaXQ7CiAJcGFydGlhbF9pbiA9IGluaXRfcGFydGlhbF9pbiAoKTsK
IAlwYXJ0aWFsX291dCA9ICIiOworCWNhcGFjaXR5ID0gY2FwYWNpdHk7CiAJ
fQogCiBsZXQgb3Blbl9mZCBmZCA9IG5ld2NvbiAoRmQgeyBmZCA9IGZkOyB9
KQpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkgYi90
b29scy9vY2FtbC9saWJzL3hiL3hiLm1saQppbmRleCA5MWM2ODIxNjJjZWEu
LjcxYjI3NTRjYTc4OCAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94
Yi94Yi5tbGkKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkKQEAg
LTY2LDEwICs2NiwxMSBAQCB0eXBlIGJhY2tlbmRfbW1hcCA9IHsKIHR5cGUg
YmFja2VuZF9mZCA9IHsgZmQgOiBVbml4LmZpbGVfZGVzY3I7IH0KIHR5cGUg
YmFja2VuZCA9IEZkIG9mIGJhY2tlbmRfZmQgfCBYZW5tbWFwIG9mIGJhY2tl
bmRfbW1hcAogdHlwZSBwYXJ0aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlh
bC5wa3QgfCBOb0hkciBvZiBpbnQgKiBieXRlcwordHlwZSBjYXBhY2l0eSA9
IHsgbWF4b3V0c3RhbmRpbmc6IGludDsgbWF4d2F0Y2hldmVudHM6IGludCB9
CiB0eXBlIHQKIHZhbCBpbml0X3BhcnRpYWxfaW4gOiB1bml0IC0+IHBhcnRp
YWxfYnVmCiB2YWwgcmVjb25uZWN0IDogdCAtPiB1bml0Ci12YWwgcXVldWUg
OiB0IC0+IFBhY2tldC50IC0+IHVuaXQKK3ZhbCBxdWV1ZSA6IHQgLT4gUGFj
a2V0LnQgLT4gdW5pdCBvcHRpb24KIHZhbCByZWFkX2ZkIDogYmFja2VuZF9m
ZCAtPiAnYSAtPiBieXRlcyAtPiBpbnQgLT4gaW50CiB2YWwgcmVhZF9tbWFw
IDogYmFja2VuZF9tbWFwIC0+ICdhIC0+IGJ5dGVzIC0+IGludCAtPiBpbnQK
IHZhbCByZWFkIDogdCAtPiBieXRlcyAtPiBpbnQgLT4gaW50CkBAIC03OCwx
MyArNzksMTQgQEAgdmFsIHdyaXRlX21tYXAgOiBiYWNrZW5kX21tYXAgLT4g
J2EgLT4gc3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCB3cml0ZSA6IHQgLT4g
c3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCBvdXRwdXQgOiB0IC0+IGJvb2wK
IHZhbCBpbnB1dCA6IHQgLT4gUGFja2V0LnQgb3B0aW9uCi12YWwgbmV3Y29u
IDogYmFja2VuZCAtPiB0Ci12YWwgb3Blbl9mZCA6IFVuaXguZmlsZV9kZXNj
ciAtPiB0Ci12YWwgb3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFj
ZSAtPiAodW5pdCAtPiB1bml0KSAtPiB0Cit2YWwgbmV3Y29uIDogY2FwYWNp
dHk6Y2FwYWNpdHkgLT4gYmFja2VuZCAtPiB0Cit2YWwgb3Blbl9mZCA6IFVu
aXguZmlsZV9kZXNjciAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0Cit2YWwg
b3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFjZSAtPiAodW5pdCAt
PiB1bml0KSAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0CiB2YWwgY2xvc2Ug
OiB0IC0+IHVuaXQKIHZhbCBpc19mZCA6IHQgLT4gYm9vbAogdmFsIGlzX21t
YXAgOiB0IC0+IGJvb2wKIHZhbCBvdXRwdXRfbGVuIDogdCAtPiBpbnQKK3Zh
bCBjYW5faW5wdXQ6IHQgLT4gYm9vbAogdmFsIGhhc19uZXdfb3V0cHV0IDog
dCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRwdXQgOiB0IC0+IGJvb2wKIHZh
bCBoYXNfb3V0cHV0IDogdCAtPiBib29sCkBAIC05MywzICs5NSw0IEBAIHZh
bCBoYXNfcGFydGlhbF9pbnB1dCA6IHQgLT4gYm9vbAogdmFsIGhhc19tb3Jl
X2lucHV0IDogdCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4g
Ym9vbAogdmFsIGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCit2YWwg
ZGVidWc6IHQgLT4gc3RyaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9s
aWJzL3hzL3F1ZXVlb3AubWwgYi90b29scy9vY2FtbC9saWJzL3hzL3F1ZXVl
b3AubWwKaW5kZXggOWZmNWJiZDUyOWNlLi40ZTUzMmNkYWVhY2IgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveHMvcXVldWVvcC5tbAorKysgYi90
b29scy9vY2FtbC9saWJzL3hzL3F1ZXVlb3AubWwKQEAgLTE2LDkgKzE2LDEw
IEBACiBvcGVuIFhlbmJ1cwogCiBsZXQgZGF0YV9jb25jYXQgbHMgPSAoU3Ry
aW5nLmNvbmNhdCAiXDAwMCIgbHMpIF4gIlwwMDAiCitsZXQgcXVldWUgY29u
IHBrdCA9IGxldCByID0gWGIucXVldWUgY29uIHBrdCBpbiBhc3NlcnQgKHIg
PD4gTm9uZSkKIGxldCBxdWV1ZV9wYXRoIHR5ICh0aWQ6IGludCkgKHBhdGg6
IHN0cmluZykgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0
aDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQogCiAoKiBvcGVyYXRpb25zICopCiBsZXQgZGlyZWN0b3J5
IHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuRGlyZWN0b3J5IHRp
ZCBwYXRoIGNvbgpAQCAtMjcsNDggKzI4LDQ4IEBAIGxldCByZWFkIHRpZCBw
YXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuUmVhZCB0aWQgcGF0aCBjb24K
IGxldCBnZXRwZXJtcyB0aWQgcGF0aCBjb24gPSBxdWV1ZV9wYXRoIFhiLk9w
LkdldHBlcm1zIHRpZCBwYXRoIGNvbgogCiBsZXQgZGVidWcgY29tbWFuZHMg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLkRlYnVnIChkYXRhX2NvbmNhdCBjb21tYW5kcykpCisJcXVldWUgY29u
IChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5EZWJ1ZyAoZGF0YV9jb25j
YXQgY29tbWFuZHMpKQogCiBsZXQgd2F0Y2ggcGF0aCBkYXRhIGNvbiA9CiAJ
bGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7IGRhdGE7IF0gaW4KLQlY
Yi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhiLk9wLldhdGNo
IGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5P
cC5XYXRjaCBkYXRhKQogCiBsZXQgdW53YXRjaCBwYXRoIGRhdGEgY29uID0K
IAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0aDsgZGF0YTsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuVW53
YXRjaCBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAg
WGIuT3AuVW53YXRjaCBkYXRhKQogCiBsZXQgdHJhbnNhY3Rpb25fc3RhcnQg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLlRyYW5zYWN0aW9uX3N0YXJ0IChkYXRhX2NvbmNhdCBbXSkpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5UcmFuc2FjdGlv
bl9zdGFydCAoZGF0YV9jb25jYXQgW10pKQogCiBsZXQgdHJhbnNhY3Rpb25f
ZW5kIHRpZCBjb21taXQgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0
IFsgKGlmIGNvbW1pdCB0aGVuICJUIiBlbHNlICJGIik7IF0gaW4KLQlYYi5x
dWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuVHJhbnNh
Y3Rpb25fZW5kIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRl
IHRpZCAwIFhiLk9wLlRyYW5zYWN0aW9uX2VuZCBkYXRhKQogCiBsZXQgaW50
cm9kdWNlIGRvbWlkIG1mbiBwb3J0IGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRh
X2NvbmNhdCBbIFByaW50Zi5zcHJpbnRmICIldSIgZG9taWQ7CiAJICAgICAg
ICAgICAgICAgICAgICAgICAgIFByaW50Zi5zcHJpbnRmICIlbnUiIG1mbjsK
IAkgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nX29mX2ludCBwb3J0
OyBdIGluCi0JWGIucXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5JbnRyb2R1Y2UgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBhY2tldC5j
cmVhdGUgMCAwIFhiLk9wLkludHJvZHVjZSBkYXRhKQogCiBsZXQgcmVsZWFz
ZSBkb21pZCBjb24gPQogCWxldCBkYXRhID0gZGF0YV9jb25jYXQgWyBQcmlu
dGYuc3ByaW50ZiAiJXUiIGRvbWlkOyBdIGluCi0JWGIucXVldWUgY29uIChY
Yi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRhdGEpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRh
dGEpCiAKIGxldCByZXN1bWUgZG9taWQgY29uID0KIAlsZXQgZGF0YSA9IGRh
dGFfY29uY2F0IFsgUHJpbnRmLnNwcmludGYgIiV1IiBkb21pZDsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuUmVz
dW1lIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5SZXN1bWUgZGF0YSkKIAogbGV0IGdldGRvbWFpbnBhdGggZG9taWQg
Y29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgUHJpbnRmLnNwcmlu
dGYgIiV1IiBkb21pZDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0
LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0aCBkYXRhKQorCXF1ZXVl
IGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0
aCBkYXRhKQogCiBsZXQgd3JpdGUgdGlkIHBhdGggdmFsdWUgY29uID0KIAls
ZXQgZGF0YSA9IHBhdGggXiAiXDAwMCIgXiB2YWx1ZSAoKiBubyBOVUxMIGF0
IHRoZSBlbmQgKikgaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVh
dGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKIAogbGV0IG1r
ZGlyIHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuTWtkaXIgdGlk
IHBhdGggY29uCiBsZXQgcm0gdGlkIHBhdGggY29uID0gcXVldWVfcGF0aCBY
Yi5PcC5SbSB0aWQgcGF0aCBjb24KIAogbGV0IHNldHBlcm1zIHRpZCBwYXRo
IHBlcm1zIGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7
IHBlcm1zIF0gaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUg
dGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwgYi90b29scy9v
Y2FtbC9saWJzL3hzL3hzcmF3Lm1sCmluZGV4IDQ1MWY4YjM4ZGJjYy4uY2Jk
MTcyODA2MDBjIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9saWJzL3hzL3hz
cmF3Lm1sCisrKyBiL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwKQEAg
LTM2LDggKzM2LDEwIEBAIHR5cGUgY29uID0gewogbGV0IGNsb3NlIGNvbiA9
CiAJWGIuY2xvc2UgY29uLnhiCiAKK2xldCBjYXBhY2l0eSA9IHsgWGIubWF4
b3V0c3RhbmRpbmcgPSAxOyBtYXh3YXRjaGV2ZW50cyA9IDA7IH0KKwogbGV0
IG9wZW5fZmQgZmQgPSB7Ci0JeGIgPSBYYi5vcGVuX2ZkIGZkOworCXhiID0g
WGIub3Blbl9mZCB+Y2FwYWNpdHkgZmQ7CiAJd2F0Y2hldmVudHMgPSBRdWV1
ZS5jcmVhdGUgKCk7CiB9CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC9jb25uZWN0aW9uLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVk
L2Nvbm5lY3Rpb24ubWwKaW5kZXggY2MyMGUwNDdkMmI5Li45NjI0YTVmOWRh
MmMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0
aW9uLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCkBAIC0yMCwxMiArMjAsODQgQEAgb3BlbiBTdGRleHQKIAogbGV0IHhl
bnN0b3JlX3BheWxvYWRfbWF4ID0gNDA5NiAoKiB4ZW4vaW5jbHVkZS9wdWJs
aWMvaW8veHNfd2lyZS5oICopCiAKK3R5cGUgJ2EgYm91bmRlZF9zZW5kZXIg
PSAnYSAtPiB1bml0IG9wdGlvbgorKCoqIGEgYm91bmRlZCBzZW5kZXIgYWNj
ZXB0cyBhbiBbJ2FdIGl0ZW0gYW5kIHJldHVybnM6CisgICAgTm9uZSAtIGlm
IHRoZXJlIGlzIG5vIHJvb20gdG8gYWNjZXB0IHRoZSBpdGVtCisgICAgU29t
ZSAoKSAtICBpZiBpdCBoYXMgc3VjY2Vzc2Z1bGx5IGFjY2VwdGVkL3NlbnQg
dGhlIGl0ZW0KKyAqKQorCittb2R1bGUgQm91bmRlZFBpcGUgOiBzaWcKKwl0
eXBlICdhIHQKKworCSgqKiBbY3JlYXRlIH5jYXBhY2l0eSB+ZGVzdGluYXRp
b25dIGNyZWF0ZXMgYSBib3VuZGVkIHBpcGUgd2l0aCBhCisJICAgIGxvY2Fs
IGJ1ZmZlciBob2xkaW5nIGF0IG1vc3QgW2NhcGFjaXR5XSBpdGVtcy4gIE9u
Y2UgdGhlIGJ1ZmZlciBpcworCSAgICBmdWxsIGl0IHdpbGwgbm90IGFjY2Vw
dCBmdXJ0aGVyIGl0ZW1zLiAgaXRlbXMgZnJvbSB0aGUgcGlwZSBhcmUKKwkg
ICAgZmx1c2hlZCBpbnRvIFtkZXN0aW5hdGlvbl0gYXMgbG9uZyBhcyBpdCBh
Y2NlcHRzIGl0ZW1zLiAgVGhlCisJICAgIGRlc3RpbmF0aW9uIGNvdWxkIGJl
IGFub3RoZXIgcGlwZS4KKwkgKikKKwl2YWwgY3JlYXRlOiBjYXBhY2l0eTpp
bnQgLT4gZGVzdGluYXRpb246J2EgYm91bmRlZF9zZW5kZXIgLT4gJ2EgdAor
CisJKCoqIFtpc19lbXB0eSB0XSByZXR1cm5zIHdoZXRoZXIgdGhlIGxvY2Fs
IGJ1ZmZlciBvZiBbdF0gaXMgZW1wdHkuICopCisJdmFsIGlzX2VtcHR5IDog
XyB0IC0+IGJvb2wKKworCSgqKiBbbGVuZ3RoIHRdIHRoZSBudW1iZXIgb2Yg
aXRlbXMgaW4gdGhlIGludGVybmFsIGJ1ZmZlciAqKQorCXZhbCBsZW5ndGg6
IF8gdCAtPiBpbnQKKworCSgqKiBbZmx1c2hfcGlwZSB0XSBzZW5kcyBhcyBt
YW55IGl0ZW1zIGZyb20gdGhlIGxvY2FsIGJ1ZmZlciBhcyBwb3NzaWJsZSwK
KwkJCXdoaWNoIGNvdWxkIGJlIG5vbmUuICopCisJdmFsIGZsdXNoX3BpcGU6
IF8gdCAtPiB1bml0CisKKwkoKiogW3B1c2ggdCBpdGVtXSB0cmllcyB0byBb
Zmx1c2hfcGlwZV0gYW5kIHRoZW4gcHVzaCBbaXRlbV0KKwkgICAgaW50byB0
aGUgcGlwZSBpZiBpdHMgW2NhcGFjaXR5XSBhbGxvd3MuCisJICAgIFJldHVy
bnMgW05vbmVdIGlmIHRoZXJlIGlzIG5vIG1vcmUgcm9vbQorCSAqKQorCXZh
bCBwdXNoIDogJ2EgdCAtPiAnYSBib3VuZGVkX3NlbmRlcgorZW5kID0gc3Ry
dWN0CisJKCogaXRlbXMgYXJlIGVucXVldWVkIGluIFtxXSwgYW5kIHRoZW4g
Zmx1c2hlZCB0byBbY29ubmVjdF90b10gKikKKwl0eXBlICdhIHQgPQorCQl7
IHE6ICdhIFF1ZXVlLnQKKwkJOyBkZXN0aW5hdGlvbjogJ2EgYm91bmRlZF9z
ZW5kZXIKKwkJOyBjYXBhY2l0eTogaW50CisJCX0KKworCWxldCBjcmVhdGUg
fmNhcGFjaXR5IH5kZXN0aW5hdGlvbiA9CisJCXsgcSA9IFF1ZXVlLmNyZWF0
ZSAoKTsgY2FwYWNpdHk7IGRlc3RpbmF0aW9uIH0KKworCWxldCByZWMgZmx1
c2hfcGlwZSB0ID0KKwkJaWYgbm90IFF1ZXVlLihpc19lbXB0eSB0LnEpIHRo
ZW4KKwkJCWxldCBpdGVtID0gUXVldWUucGVlayB0LnEgaW4KKwkJCW1hdGNo
IHQuZGVzdGluYXRpb24gaXRlbSB3aXRoCisJCQl8IE5vbmUgLT4gKCkgKCog
bm8gcm9vbSAqKQorCQkJfCBTb21lICgpIC0+CisJCQkJKCogc3VjY2Vzc2Z1
bGx5IHNlbnQgaXRlbSB0byBuZXh0IHN0YWdlICopCisJCQkJbGV0IF8gPSBR
dWV1ZS5wb3AgdC5xIGluCisJCQkJKCogY29udGludWUgdHJ5aW5nIHRvIHNl
bmQgbW9yZSBpdGVtcyAqKQorCQkJCWZsdXNoX3BpcGUgdAorCisJbGV0IHB1
c2ggdCBpdGVtID0KKwkJKCogZmlyc3QgdHJ5IHRvIGZsdXNoIGFzIG1hbnkg
aXRlbXMgZnJvbSB0aGlzIHBpcGUgYXMgcG9zc2libGUgdG8gbWFrZSByb29t
LAorCQkgICBpdCBpcyBpbXBvcnRhbnQgdG8gZG8gdGhpcyBmaXJzdCB0byBw
cmVzZXJ2ZSB0aGUgb3JkZXIgb2YgdGhlIGl0ZW1zCisJCSAqKQorCQlmbHVz
aF9waXBlIHQ7CisJCWlmIFF1ZXVlLmxlbmd0aCB0LnEgPCB0LmNhcGFjaXR5
IHRoZW4gYmVnaW4KKwkJCSgqIGVucXVldWUsIGluc3RlYWQgb2Ygc2VuZGlu
ZyBkaXJlY3RseS4KKwkJCSAgIHRoaXMgZW5zdXJlcyB0aGF0IFtvdXRdIHNl
ZXMgdGhlIGl0ZW1zIGluIHRoZSBzYW1lIG9yZGVyIGFzIHdlIHJlY2VpdmUg
dGhlbQorCQkJICopCisJCQlRdWV1ZS5wdXNoIGl0ZW0gdC5xOworCQkJU29t
ZSAoZmx1c2hfcGlwZSB0KQorCQllbmQgZWxzZSBOb25lCisKKwlsZXQgaXNf
ZW1wdHkgdCA9IFF1ZXVlLmlzX2VtcHR5IHQucQorCWxldCBsZW5ndGggdCA9
IFF1ZXVlLmxlbmd0aCB0LnEKK2VuZAorCiB0eXBlIHdhdGNoID0gewogCWNv
bjogdDsKIAl0b2tlbjogc3RyaW5nOwogCXBhdGg6IHN0cmluZzsKIAliYXNl
OiBzdHJpbmc7CiAJaXNfcmVsYXRpdmU6IGJvb2w7CisJcGVuZGluZ193YXRj
aGV2ZW50czogWGVuYnVzLlhiLlBhY2tldC50IEJvdW5kZWRQaXBlLnQ7CiB9
CiAKIGFuZCB0ID0gewpAQCAtMzgsOCArMTEwLDM2IEBAIGFuZCB0ID0gewog
CWFub25pZDogaW50OwogCW11dGFibGUgc3RhdF9uYl9vcHM6IGludDsKIAlt
dXRhYmxlIHBlcm06IFBlcm1zLkNvbm5lY3Rpb24udDsKKwlwZW5kaW5nX3Nv
dXJjZV93YXRjaGV2ZW50czogKHdhdGNoICogWGVuYnVzLlhiLlBhY2tldC50
KSBCb3VuZGVkUGlwZS50CiB9CiAKK21vZHVsZSBXYXRjaCA9IHN0cnVjdAor
CW1vZHVsZSBUID0gc3RydWN0CisJCXR5cGUgdCA9IHdhdGNoCisKKwkJbGV0
IGNvbXBhcmUgdzEgdzIgPQorCQkJKCogY2Fubm90IGNvbXBhcmUgd2F0Y2hl
cyBmcm9tIGRpZmZlcmVudCBjb25uZWN0aW9ucyAqKQorCQkJYXNzZXJ0ICh3
MS5jb24gPT0gdzIuY29uKTsKKwkJCW1hdGNoIFN0cmluZy5jb21wYXJlIHcx
LnRva2VuIHcyLnRva2VuIHdpdGgKKwkJCXwgMCAtPiBTdHJpbmcuY29tcGFy
ZSB3MS5wYXRoIHcyLnBhdGgKKwkJCXwgbiAtPiBuCisJZW5kCisJbW9kdWxl
IFNldCA9IFNldC5NYWtlKFQpCisKKwlsZXQgZmx1c2hfZXZlbnRzIHQgPQor
CQlCb3VuZGVkUGlwZS5mbHVzaF9waXBlIHQucGVuZGluZ193YXRjaGV2ZW50
czsKKwkJbm90IChCb3VuZGVkUGlwZS5pc19lbXB0eSB0LnBlbmRpbmdfd2F0
Y2hldmVudHMpCisKKwlsZXQgcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwkJ
Qm91bmRlZFBpcGUubGVuZ3RoIHQucGVuZGluZ193YXRjaGV2ZW50cworZW5k
CisKK2xldCBzb3VyY2VfZmx1c2hfd2F0Y2hldmVudHMgdCA9CisJQm91bmRl
ZFBpcGUuZmx1c2hfcGlwZSB0LnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRz
CisKK2xldCBzb3VyY2VfcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwlCb3Vu
ZGVkUGlwZS5sZW5ndGggdC5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50cwor
CiBsZXQgbWFya19hc19iYWQgY29uID0KIAltYXRjaCBjb24uZG9tIHdpdGgK
IAl8Tm9uZSAtPiAoKQpAQCAtNjcsNyArMTY3LDggQEAgbGV0IHdhdGNoX2Ny
ZWF0ZSB+Y29uIH5wYXRoIH50b2tlbiA9IHsKIAl0b2tlbiA9IHRva2VuOwog
CXBhdGggPSBwYXRoOwogCWJhc2UgPSBnZXRfcGF0aCBjb247Ci0JaXNfcmVs
YXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4gJ0AnCisJ
aXNfcmVsYXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4g
J0AnOworCXBlbmRpbmdfd2F0Y2hldmVudHMgPSBCb3VuZGVkUGlwZS5jcmVh
dGUgfmNhcGFjaXR5OiFEZWZpbmUubWF4d2F0Y2hldmVudHMgfmRlc3RpbmF0
aW9uOihYZW5idXMuWGIucXVldWUgY29uLnhiKQogfQogCiBsZXQgZ2V0X2Nv
biB3ID0gdy5jb24KQEAgLTkzLDYgKzE5NCw5IEBAIGxldCBtYWtlX3Blcm0g
ZG9tID0KIAlQZXJtcy5Db25uZWN0aW9uLmNyZWF0ZSB+cGVybXM6W1Blcm1z
LlJFQUQ7IFBlcm1zLldSSVRFXSBkb21pZAogCiBsZXQgY3JlYXRlIHhiY29u
IGRvbSA9CisJbGV0IGRlc3RpbmF0aW9uICh3YXRjaCwgcGt0KSA9CisJCUJv
dW5kZWRQaXBlLnB1c2ggd2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyBwa3QK
KwlpbgogCWxldCBpZCA9CiAJCW1hdGNoIGRvbSB3aXRoCiAJCXwgTm9uZSAt
PiBsZXQgb2xkID0gIWFub25faWRfbmV4dCBpbiBpbmNyIGFub25faWRfbmV4
dDsgb2xkCkBAIC0xMDksNiArMjEzLDE2IEBAIGxldCBjcmVhdGUgeGJjb24g
ZG9tID0KIAlhbm9uaWQgPSBpZDsKIAlzdGF0X25iX29wcyA9IDA7CiAJcGVy
bSA9IG1ha2VfcGVybSBkb207CisKKwkoKiB0aGUgYWN0dWFsIGNhcGFjaXR5
IHdpbGwgYmUgbG93ZXIsIHRoaXMgaXMgdXNlZCBhcyBhbiBvdmVyZmxvdwor
CSAgIGJ1ZmZlcjogYW55dGhpbmcgdGhhdCBkb2Vzbid0IGZpdCBlbHNld2hl
cmUgZ2V0cyBwdXQgaGVyZSwgb25seQorCSAgIGxpbWl0ZWQgYnkgdGhlIGFt
b3VudCBvZiB3YXRjaGVzIHRoYXQgeW91IGNhbiBnZW5lcmF0ZSB3aXRoIGEK
KwkgICBzaW5nbGUgeGVuc3RvcmUgY29tbWFuZCAod2hpY2ggaXMgZmluaXRl
LCBhbHRob3VnaCBwb3NzaWJseSB2ZXJ5CisJICAgbGFyZ2UgaW4gdGhlb3J5
IGZvciBEb20wKS4gIE9uY2UgdGhlIHBpcGUgaGVyZSBoYXMgYW55IGNvbnRl
bnRzIHRoZQorCSAgIGRvbWFpbiBpcyBibG9ja2VkIGZyb20gc2VuZGluZyBt
b3JlIGNvbW1hbmRzIHVudGlsIGl0IGlzIGVtcHR5CisJICAgYWdhaW4gdGhv
dWdoLgorCSAqKQorCXBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzID0gQm91
bmRlZFBpcGUuY3JlYXRlIH5jYXBhY2l0eTpTeXMubWF4X2FycmF5X2xlbmd0
aCB+ZGVzdGluYXRpb24KIAl9CiAJaW4KIAlMb2dnaW5nLm5ld19jb25uZWN0
aW9uIH50aWQ6VHJhbnNhY3Rpb24ubm9uZSB+Y29uOihnZXRfZG9tc3RyIGNv
bik7CkBAIC0xMjcsMTEgKzI0MSwxNyBAQCBsZXQgc2V0X3RhcmdldCBjb24g
dGFyZ2V0X2RvbWlkID0KIAogbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBY
ZW5idXMuWGIuaXNfbW1hcCBjb24ueGIKIAotbGV0IHNlbmRfcmVwbHkgY29u
IHRpZCByaWQgdHkgZGF0YSA9CitsZXQgcGFja2V0X29mIGNvbiB0aWQgcmlk
IHR5IGRhdGEgPQogCWlmIChTdHJpbmcubGVuZ3RoIGRhdGEpID4geGVuc3Rv
cmVfcGF5bG9hZF9tYXggJiYgKGlzX2JhY2tlbmRfbW1hcCBjb24pIHRoZW4K
LQkJWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAoWGVuYnVzLlhiLlBhY2tldC5j
cmVhdGUgdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgIkUyQklHXDAwMCIp
CisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgWGVuYnVzLlhi
Lk9wLkVycm9yICJFMkJJR1wwMDAiCiAJZWxzZQotCQlYZW5idXMuWGIucXVl
dWUgY29uLnhiIChYZW5idXMuWGIuUGFja2V0LmNyZWF0ZSB0aWQgcmlkIHR5
IGRhdGEpCisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgdHkg
ZGF0YQorCitsZXQgc2VuZF9yZXBseSBjb24gdGlkIHJpZCB0eSBkYXRhID0K
KwlsZXQgcmVzdWx0ID0gWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAocGFja2V0
X29mIGNvbiB0aWQgcmlkIHR5IGRhdGEpIGluCisJKCogc2hvdWxkIG5ldmVy
IGhhcHBlbjogd2Ugb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCB3aGVu
IHRoZXJlIGlzIHJvb20gZm9yIGFuIG91dHB1dCBwYWNrZXQgKikKKwkoKiBh
bmQgdGhlIGxpbWl0IGZvciByZXBsaWVzIGlzIGRpZmZlcmVudCBmcm9tIHRo
ZSBsaW1pdCBmb3Igd2F0Y2ggZXZlbnRzICopCisJYXNzZXJ0IChyZXN1bHQg
PD4gTm9uZSkKIAogbGV0IHNlbmRfZXJyb3IgY29uIHRpZCByaWQgZXJyID0g
c2VuZF9yZXBseSBjb24gdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgKGVy
ciBeICJcMDAwIikKIGxldCBzZW5kX2FjayBjb24gdGlkIHJpZCB0eSA9IHNl
bmRfcmVwbHkgY29uIHRpZCByaWQgdHkgIk9LXDAwMCIKQEAgLTE4MSwxMSAr
MzAxLDExIEBAIGxldCBkZWxfd2F0Y2ggY29uIHBhdGggdG9rZW4gPQogCWFw
YXRoLCB3CiAKIGxldCBkZWxfd2F0Y2hlcyBjb24gPQotICBIYXNodGJsLmNs
ZWFyIGNvbi53YXRjaGVzOworICBIYXNodGJsLnJlc2V0IGNvbi53YXRjaGVz
OwogICBjb24ubmJfd2F0Y2hlcyA8LSAwCiAKIGxldCBkZWxfdHJhbnNhY3Rp
b25zIGNvbiA9Ci0gIEhhc2h0YmwuY2xlYXIgY29uLnRyYW5zYWN0aW9ucwor
ICBIYXNodGJsLnJlc2V0IGNvbi50cmFuc2FjdGlvbnMKIAogbGV0IGxpc3Rf
d2F0Y2hlcyBjb24gPQogCWxldCBsbCA9IEhhc2h0YmwuZm9sZApAQCAtMjA4
LDIxICszMjgsMjkgQEAgbGV0IGxvb2t1cF93YXRjaF9wZXJtIHBhdGggPSBm
dW5jdGlvbgogbGV0IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3Qg
cGF0aCA9CiAJbG9va3VwX3dhdGNoX3Blcm0gcGF0aCBvbGRyb290IEAgbG9v
a3VwX3dhdGNoX3Blcm0gcGF0aCAoU29tZSByb290KQogCi1sZXQgZmlyZV9z
aW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdhdGNoID0KK2xldCBmaXJlX3Npbmds
ZV93YXRjaF91bmNoZWNrZWQgc291cmNlIHdhdGNoID0KIAlsZXQgZGF0YSA9
IFV0aWxzLmpvaW5fYnlfbnVsbCBbd2F0Y2gucGF0aDsgd2F0Y2gudG9rZW47
ICIiXSBpbgotCXNlbmRfcmVwbHkgd2F0Y2guY29uIFRyYW5zYWN0aW9uLm5v
bmUgMCBYZW5idXMuWGIuT3AuV2F0Y2hldmVudCBkYXRhCisJbGV0IHBrdCA9
IHBhY2tldF9vZiB3YXRjaC5jb24gVHJhbnNhY3Rpb24ubm9uZSAwIFhlbmJ1
cy5YYi5PcC5XYXRjaGV2ZW50IGRhdGEgaW4KKworCW1hdGNoIEJvdW5kZWRQ
aXBlLnB1c2ggc291cmNlLnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzICh3
YXRjaCwgcGt0KSB3aXRoCisJfCBTb21lICgpIC0+ICgpICgqIHBhY2tldCBx
dWV1ZWQgKikKKwl8IE5vbmUgLT4KKwkJCSgqIGEgd2VsbCBiZWhhdmVkIERv
bTAgc2hvdWxkbid0IGJlIGFibGUgdG8gdHJpZ2dlciB0aGlzLAorCQkJICAg
aWYgaXQgaGFwcGVucyBpdCBpcyBsaWtlbHkgYSBEb20wIGJ1ZyBjYXVzaW5n
IHJ1bmF3YXkgbWVtb3J5IHVzYWdlCisJCQkgKikKKwkJCWZhaWx3aXRoICJ3
YXRjaCBldmVudCBvdmVyZmxvdywgY2Fubm90IGhhcHBlbiIKIAotbGV0IGZp
cmVfc2luZ2xlX3dhdGNoIChvbGRyb290LCByb290KSB3YXRjaCA9CitsZXQg
ZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIChvbGRyb290LCByb290KSB3YXRj
aCA9CiAJbGV0IGFic3BhdGggPSBnZXRfd2F0Y2hfcGF0aCB3YXRjaC5jb24g
d2F0Y2gucGF0aCB8PiBTdG9yZS5QYXRoLm9mX3N0cmluZyBpbgogCWxldCBw
ZXJtcyA9IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3QgYWJzcGF0
aCBpbgogCWlmIFBlcm1zLmNhbl9maXJlX3dhdGNoIHdhdGNoLmNvbi5wZXJt
IHBlcm1zIHRoZW4KLQkJZmlyZV9zaW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdh
dGNoCisJCWZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCBzb3VyY2Ugd2F0
Y2gKIAllbHNlCiAJCWxldCBwZXJtcyA9IHBlcm1zIHw+IExpc3QubWFwIChQ
ZXJtcy5Ob2RlLnRvX3N0cmluZyB+c2VwOiIgIikgfD4gU3RyaW5nLmNvbmNh
dCAiLCAiIGluCiAJCWxldCBjb24gPSBnZXRfZG9tc3RyIHdhdGNoLmNvbiBp
bgogCQlMb2dnaW5nLndhdGNoX25vdF9maXJlZCB+Y29uIHBlcm1zIChTdG9y
ZS5QYXRoLnRvX3N0cmluZyBhYnNwYXRoKQogCi1sZXQgZmlyZV93YXRjaCBy
b290cyB3YXRjaCBwYXRoID0KK2xldCBmaXJlX3dhdGNoIHNvdXJjZSByb290
cyB3YXRjaCBwYXRoID0KIAlsZXQgbmV3X3BhdGggPQogCQlpZiB3YXRjaC5p
c19yZWxhdGl2ZSAmJiBwYXRoLlswXSA9ICcvJwogCQl0aGVuIGJlZ2luCkBA
IC0yMzIsNyArMzYwLDcgQEAgbGV0IGZpcmVfd2F0Y2ggcm9vdHMgd2F0Y2gg
cGF0aCA9CiAJCWVuZCBlbHNlCiAJCQlwYXRoCiAJaW4KLQlmaXJlX3Npbmds
ZV93YXRjaCByb290cyB7IHdhdGNoIHdpdGggcGF0aCA9IG5ld19wYXRoIH0K
KwlmaXJlX3NpbmdsZV93YXRjaCBzb3VyY2Ugcm9vdHMgeyB3YXRjaCB3aXRo
IHBhdGggPSBuZXdfcGF0aCB9CiAKICgqIFNlYXJjaCBmb3IgYSB2YWxpZCB1
bnVzZWQgdHJhbnNhY3Rpb24gaWQuICopCiBsZXQgcmVjIHZhbGlkX3RyYW5z
YWN0aW9uX2lkIGNvbiBwcm9wb3NlZF9pZCA9CkBAIC0yODAsNiArNDA4LDcg
QEAgbGV0IGRvX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5pbnB1dCBjb24ueGIK
IGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24gPSBYZW5idXMuWGIuaGFzX3Bh
cnRpYWxfaW5wdXQgY29uLnhiCiBsZXQgaGFzX21vcmVfaW5wdXQgY29uID0g
WGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54YgogCitsZXQgY2FuX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5jYW5faW5wdXQgY29uLnhiICYmIEJvdW5k
ZWRQaXBlLmlzX2VtcHR5IGNvbi5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50
cwogbGV0IGhhc19vdXRwdXQgY29uID0gWGVuYnVzLlhiLmhhc19vdXRwdXQg
Y29uLnhiCiBsZXQgaGFzX29sZF9vdXRwdXQgY29uID0gWGVuYnVzLlhiLmhh
c19vbGRfb3V0cHV0IGNvbi54YgogbGV0IGhhc19uZXdfb3V0cHV0IGNvbiA9
IFhlbmJ1cy5YYi5oYXNfbmV3X291dHB1dCBjb24ueGIKQEAgLTMyMyw3ICs0
NTIsNyBAQCBsZXQgcHJldmVudHNfbGl2ZV91cGRhdGUgY29uID0gbm90IChp
c19iYWQgY29uKQogCSYmIChoYXNfZXh0cmFfY29ubmVjdGlvbl9kYXRhIGNv
biB8fCBoYXNfdHJhbnNhY3Rpb25fZGF0YSBjb24pCiAKIGxldCBoYXNfbW9y
ZV93b3JrIGNvbiA9Ci0JaGFzX21vcmVfaW5wdXQgY29uIHx8IG5vdCAoaGFz
X29sZF9vdXRwdXQgY29uKSAmJiBoYXNfbmV3X291dHB1dCBjb24KKwkoaGFz
X21vcmVfaW5wdXQgY29uICYmIGNhbl9pbnB1dCBjb24pIHx8IG5vdCAoaGFz
X29sZF9vdXRwdXQgY29uKSAmJiBoYXNfbmV3X291dHB1dCBjb24KIAogbGV0
IGluY3Jfb3BzIGNvbiA9IGNvbi5zdGF0X25iX29wcyA8LSBjb24uc3RhdF9u
Yl9vcHMgKyAxCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3Jl
ZC9jb25uZWN0aW9ucy5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25u
ZWN0aW9ucy5tbAppbmRleCAzYzc0MjlmZTdmNjEuLjdkNjhjNTgzYjQzYSAx
MDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb25z
Lm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9ucy5t
bApAQCAtMjIsMjIgKzIyLDMwIEBAIHR5cGUgdCA9IHsKIAlkb21haW5zOiAo
aW50LCBDb25uZWN0aW9uLnQpIEhhc2h0YmwudDsKIAlwb3J0czogKFhlbmV2
ZW50Y2huLnQsIENvbm5lY3Rpb24udCkgSGFzaHRibC50OwogCW11dGFibGUg
d2F0Y2hlczogQ29ubmVjdGlvbi53YXRjaCBsaXN0IFRyaWUudDsKKwltdXRh
YmxlIGhhc19wZW5kaW5nX3dhdGNoZXZlbnRzOiBDb25uZWN0aW9uLldhdGNo
LlNldC50CiB9CiAKIGxldCBjcmVhdGUgKCkgPSB7CiAJYW5vbnltb3VzID0g
SGFzaHRibC5jcmVhdGUgMzc7CiAJZG9tYWlucyA9IEhhc2h0YmwuY3JlYXRl
IDM3OwogCXBvcnRzID0gSGFzaHRibC5jcmVhdGUgMzc7Ci0Jd2F0Y2hlcyA9
IFRyaWUuY3JlYXRlICgpCisJd2F0Y2hlcyA9IFRyaWUuY3JlYXRlICgpOwor
CWhhc19wZW5kaW5nX3dhdGNoZXZlbnRzID0gQ29ubmVjdGlvbi5XYXRjaC5T
ZXQuZW1wdHk7CiB9CiAKK2xldCBnZXRfY2FwYWNpdHkgKCkgPQorCSgqIG5v
dCBtdWx0aXBsaWVkIGJ5IG1heHdhdGNoIG9uIHB1cnBvc2U6IDJuZCBxdWV1
ZSBpbiB3YXRjaCBpdHNlbGYhICopCisJeyBYZW5idXMuWGIubWF4b3V0c3Rh
bmRpbmcgPSAhRGVmaW5lLm1heG91dHN0YW5kaW5nOyBtYXh3YXRjaGV2ZW50
cyA9ICFEZWZpbmUubWF4d2F0Y2hldmVudHMgfQorCiBsZXQgYWRkX2Fub255
bW91cyBjb25zIGZkID0KLQlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9m
ZCBmZCBpbgorCWxldCBjYXBhY2l0eSA9IGdldF9jYXBhY2l0eSAoKSBpbgor
CWxldCB4YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX2ZkIGZkIH5jYXBhY2l0eSBp
bgogCWxldCBjb24gPSBDb25uZWN0aW9uLmNyZWF0ZSB4YmNvbiBOb25lIGlu
CiAJSGFzaHRibC5hZGQgY29ucy5hbm9ueW1vdXMgKFhlbmJ1cy5YYi5nZXRf
ZmQgeGJjb24pIGNvbgogCiBsZXQgYWRkX2RvbWFpbiBjb25zIGRvbSA9Ci0J
bGV0IHhiY29uID0gWGVuYnVzLlhiLm9wZW5fbW1hcCAoRG9tYWluLmdldF9p
bnRlcmZhY2UgZG9tKSAoZnVuICgpIC0+IERvbWFpbi5ub3RpZnkgZG9tKSBp
bgorCWxldCBjYXBhY2l0eSA9IGdldF9jYXBhY2l0eSAoKSBpbgorCWxldCB4
YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX21tYXAgfmNhcGFjaXR5IChEb21haW4u
Z2V0X2ludGVyZmFjZSBkb20pIChmdW4gKCkgLT4gRG9tYWluLm5vdGlmeSBk
b20pIGluCiAJbGV0IGNvbiA9IENvbm5lY3Rpb24uY3JlYXRlIHhiY29uIChT
b21lIGRvbSkgaW4KIAlIYXNodGJsLmFkZCBjb25zLmRvbWFpbnMgKERvbWFp
bi5nZXRfaWQgZG9tKSBjb247CiAJbWF0Y2ggRG9tYWluLmdldF9wb3J0IGRv
bSB3aXRoCkBAIC00OCw3ICs1Niw5IEBAIGxldCBzZWxlY3QgPyhvbmx5X2lm
ID0gKGZ1biBfIC0+IHRydWUpKSBjb25zID0KIAlIYXNodGJsLmZvbGQgKGZ1
biBfIGNvbiAoaW5zLCBvdXRzKSAtPgogCQlpZiAob25seV9pZiBjb24pIHRo
ZW4gKAogCQkJbGV0IGZkID0gQ29ubmVjdGlvbi5nZXRfZmQgY29uIGluCi0J
CQkoZmQgOjogaW5zLCAgaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0
aGVuIGZkIDo6IG91dHMgZWxzZSBvdXRzKQorCQkJbGV0IGluX2ZkcyA9IGlm
IENvbm5lY3Rpb24uY2FuX2lucHV0IGNvbiB0aGVuIGZkIDo6IGlucyBlbHNl
IGlucyBpbgorCQkJbGV0IG91dF9mZHMgPSBpZiBDb25uZWN0aW9uLmhhc19v
dXRwdXQgY29uIHRoZW4gZmQgOjogb3V0cyBlbHNlIG91dHMgaW4KKwkJCWlu
X2Zkcywgb3V0X2ZkcwogCQkpIGVsc2UgKGlucywgb3V0cykKIAkpCiAJY29u
cy5hbm9ueW1vdXMgKFtdLCBbXSkKQEAgLTY3LDEwICs3NywxNyBAQCBsZXQg
ZGVsX3dhdGNoZXNfb2ZfY29uIGNvbiB3YXRjaGVzID0KIAl8IFtdIC0+IE5v
bmUKIAl8IHdzIC0+IFNvbWUgd3MKIAorbGV0IGRlbF93YXRjaGVzIGNvbnMg
Y29uID0KKwlDb25uZWN0aW9uLmRlbF93YXRjaGVzIGNvbjsKKwljb25zLndh
dGNoZXMgPC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNv
bnMud2F0Y2hlczsKKwljb25zLmhhc19wZW5kaW5nX3dhdGNoZXZlbnRzIDwt
CisJCWNvbnMuaGFzX3BlbmRpbmdfd2F0Y2hldmVudHMgfD4gQ29ubmVjdGlv
bi5XYXRjaC5TZXQuZmlsdGVyIEBAIGZ1biB3IC0+CisJCUNvbm5lY3Rpb24u
Z2V0X2NvbiB3ICE9IGNvbgorCiBsZXQgZGVsX2Fub255bW91cyBjb25zIGNv
biA9CiAJdHJ5CiAJCUhhc2h0YmwucmVtb3ZlIGNvbnMuYW5vbnltb3VzIChD
b25uZWN0aW9uLmdldF9mZCBjb24pOwotCQljb25zLndhdGNoZXMgPC0gVHJp
ZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNvbnMud2F0Y2hlczsK
KwkJZGVsX3dhdGNoZXMgY29ucyBjb247CiAJCUNvbm5lY3Rpb24uY2xvc2Ug
Y29uCiAJd2l0aCBleG4gLT4KIAkJZGVidWcgImRlbCBhbm9ueW1vdXMgJXMi
IChQcmludGV4Yy50b19zdHJpbmcgZXhuKQpAQCAtODUsNyArMTAyLDcgQEAg
bGV0IGRlbF9kb21haW4gY29ucyBpZCA9CiAJCSAgICB8IFNvbWUgcCAtPiBI
YXNodGJsLnJlbW92ZSBjb25zLnBvcnRzIHAKIAkJICAgIHwgTm9uZSAtPiAo
KSkKIAkJIHwgTm9uZSAtPiAoKSk7Ci0JCWNvbnMud2F0Y2hlcyA8LSBUcmll
Lm1hcCAoZGVsX3dhdGNoZXNfb2ZfY29uIGNvbikgY29ucy53YXRjaGVzOwor
CQlkZWxfd2F0Y2hlcyBjb25zIGNvbjsKIAkJQ29ubmVjdGlvbi5jbG9zZSBj
b24KIAl3aXRoIGV4biAtPgogCQlkZWJ1ZyAiZGVsIGRvbWFpbiAldTogJXMi
IGlkIChQcmludGV4Yy50b19zdHJpbmcgZXhuKQpAQCAtMTM2LDMxICsxNTMs
MzMgQEAgbGV0IGRlbF93YXRjaCBjb25zIGNvbiBwYXRoIHRva2VuID0KIAkJ
Y29ucy53YXRjaGVzIDwtIFRyaWUuc2V0IGNvbnMud2F0Y2hlcyBrZXkgd2F0
Y2hlczsKICAJd2F0Y2gKIAotbGV0IGRlbF93YXRjaGVzIGNvbnMgY29uID0K
LQlDb25uZWN0aW9uLmRlbF93YXRjaGVzIGNvbjsKLQljb25zLndhdGNoZXMg
PC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNvbnMud2F0
Y2hlcwotCiAoKiBwYXRoIGlzIGFic29sdXRlICopCi1sZXQgZmlyZV93YXRj
aGVzID9vbGRyb290IHJvb3QgY29ucyBwYXRoIHJlY3Vyc2UgPQorbGV0IGZp
cmVfd2F0Y2hlcyA/b2xkcm9vdCBzb3VyY2Ugcm9vdCBjb25zIHBhdGggcmVj
dXJzZSA9CiAJbGV0IGtleSA9IGtleV9vZl9wYXRoIHBhdGggaW4KIAlsZXQg
cGF0aCA9IFN0b3JlLlBhdGgudG9fc3RyaW5nIHBhdGggaW4KIAlsZXQgcm9v
dHMgPSBvbGRyb290LCByb290IGluCiAJbGV0IGZpcmVfd2F0Y2ggXyA9IGZ1
bmN0aW9uCiAJCXwgTm9uZSAgICAgICAgIC0+ICgpCi0JCXwgU29tZSB3YXRj
aGVzIC0+IExpc3QuaXRlciAoZnVuIHcgLT4gQ29ubmVjdGlvbi5maXJlX3dh
dGNoIHJvb3RzIHcgcGF0aCkgd2F0Y2hlcworCQl8IFNvbWUgd2F0Y2hlcyAt
PiBMaXN0Lml0ZXIgKGZ1biB3IC0+IENvbm5lY3Rpb24uZmlyZV93YXRjaCBz
b3VyY2Ugcm9vdHMgdyBwYXRoKSB3YXRjaGVzCiAJaW4KIAlsZXQgZmlyZV9y
ZWMgX3ggPSBmdW5jdGlvbgogCQl8IE5vbmUgICAgICAgICAtPiAoKQogCQl8
IFNvbWUgd2F0Y2hlcyAtPgotCQkJTGlzdC5pdGVyIChDb25uZWN0aW9uLmZp
cmVfc2luZ2xlX3dhdGNoIHJvb3RzKSB3YXRjaGVzCisJCQlMaXN0Lml0ZXIg
KENvbm5lY3Rpb24uZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIHJvb3RzKSB3
YXRjaGVzCiAJaW4KIAlUcmllLml0ZXJfcGF0aCBmaXJlX3dhdGNoIGNvbnMu
d2F0Y2hlcyBrZXk7CiAJaWYgcmVjdXJzZSB0aGVuCiAJCVRyaWUuaXRlciBm
aXJlX3JlYyAoVHJpZS5zdWIgY29ucy53YXRjaGVzIGtleSkKIAorbGV0IHNl
bmRfd2F0Y2hldmVudHMgY29ucyBjb24gPQorCWNvbnMuaGFzX3BlbmRpbmdf
d2F0Y2hldmVudHMgPC0KKwkJY29ucy5oYXNfcGVuZGluZ193YXRjaGV2ZW50
cyB8PiBDb25uZWN0aW9uLldhdGNoLlNldC5maWx0ZXIgQ29ubmVjdGlvbi5X
YXRjaC5mbHVzaF9ldmVudHM7CisJQ29ubmVjdGlvbi5zb3VyY2VfZmx1c2hf
d2F0Y2hldmVudHMgY29uCisKIGxldCBmaXJlX3NwZWNfd2F0Y2hlcyByb290
IGNvbnMgc3BlY3BhdGggPQorCWxldCBzb3VyY2UgPSBmaW5kX2RvbWFpbiBj
b25zIDAgaW4KIAlpdGVyIGNvbnMgKGZ1biBjb24gLT4KLQkJTGlzdC5pdGVy
IChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoIChOb25lLCByb290KSkg
KENvbm5lY3Rpb24uZ2V0X3dhdGNoZXMgY29uIHNwZWNwYXRoKSkKKwkJTGlz
dC5pdGVyIChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoIHNvdXJjZSAo
Tm9uZSwgcm9vdCkpIChDb25uZWN0aW9uLmdldF93YXRjaGVzIGNvbiBzcGVj
cGF0aCkpCiAKIGxldCBzZXRfdGFyZ2V0IGNvbnMgZG9tYWluIHRhcmdldF9k
b21haW4gPQogCWxldCBjb24gPSBmaW5kX2RvbWFpbiBjb25zIGRvbWFpbiBp
bgpAQCAtMTk3LDYgKzIxNiwxNiBAQCBsZXQgZGVidWcgY29ucyA9CiAJbGV0
IGRvbWFpbnMgPSBIYXNodGJsLmZvbGQgKGZ1biBfIGNvbiBhY2N1IC0+IENv
bm5lY3Rpb24uZGVidWcgY29uIDo6IGFjY3UpIGNvbnMuZG9tYWlucyBbXSBp
bgogCVN0cmluZy5jb25jYXQgIiIgKGRvbWFpbnMgQCBhbm9ueW1vdXMpCiAK
K2xldCBkZWJ1Z193YXRjaGV2ZW50cyBjb25zIGNvbiA9CisJKCogPT0gKHBo
eXNpY2FsIGVxdWFsaXR5KQorCSAgIGhhcyB0byBiZSB1c2VkIGhlcmUgYmVj
YXVzZSB3LmNvbi54Yi5iYWNrZW5kIG1pZ2h0IGNvbnRhaW4gYSBbdW5pdC0+
dW5pdF0gdmFsdWUgY2F1c2luZyByZWd1bGFyCisJICAgY29tcGFyaXNvbiB0
byBmYWlsIGR1ZSB0byBoYXZpbmcgYSAnZnVuY3Rpb25hbCB2YWx1ZScgd2hp
Y2ggY2Fubm90IGJlIGNvbXBhcmVkLgorCSAqKQorCWxldCBzID0gY29ucy5o
YXNfcGVuZGluZ193YXRjaGV2ZW50cyB8PiBDb25uZWN0aW9uLldhdGNoLlNl
dC5maWx0ZXIgKGZ1biB3IC0+IHcuY29uID09IGNvbikgaW4KKwlsZXQgcGVu
ZGluZyA9IHMgfD4gQ29ubmVjdGlvbi5XYXRjaC5TZXQuZWxlbWVudHMKKwkJ
fD4gTGlzdC5tYXAgKGZ1biB3IC0+IENvbm5lY3Rpb24uV2F0Y2gucGVuZGlu
Z193YXRjaGV2ZW50cyB3KSB8PiBMaXN0LmZvbGRfbGVmdCAoKykgMCBpbgor
CVByaW50Zi5zcHJpbnRmICJXYXRjaGVzIHdpdGggcGVuZGluZyBldmVudHM6
ICVkLCBwZW5kaW5nIGV2ZW50cyB0b3RhbDogJWQiIChDb25uZWN0aW9uLldh
dGNoLlNldC5jYXJkaW5hbCBzKSBwZW5kaW5nCisKIGxldCBmaWx0ZXIgfmYg
Y29ucyA9CiAJbGV0IGZvbGQgXyB2IGFjYyA9IGlmIGYgdiB0aGVuIHYgOjog
YWNjIGVsc2UgYWNjIGluCiAJW10KZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQv
ZGVmaW5lLm1sCmluZGV4IGJhNjNhODE0N2UwOS4uMzI3YjZkNzk1ZWM3IDEw
MDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvZGVmaW5lLm1sCisr
KyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKQEAgLTI0LDYg
KzI0LDEzIEBAIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRocy54ZW5f
Y29uZmlnX2RpcgogbGV0IG1heHdhdGNoID0gcmVmICgxMDApCiBsZXQgbWF4
dHJhbnNhY3Rpb24gPSByZWYgKDEwKQogbGV0IG1heHJlcXVlc3RzID0gcmVm
ICgxMDI0KSAgICgqIG1heGltdW0gcmVxdWVzdHMgcGVyIHRyYW5zYWN0aW9u
ICopCitsZXQgbWF4b3V0c3RhbmRpbmcgPSByZWYgKDEwMjQpICgqIG1heGlt
dW0gb3V0c3RhbmRpbmcgcmVxdWVzdHMsIGkuZS4gaW4tZmxpZ2h0IHJlcXVl
c3RzIC8gZG9tYWluICopCitsZXQgbWF4d2F0Y2hldmVudHMgPSByZWYgKDEw
MjQpCisoKgorCW1heGltdW0gb3V0c3RhbmRpbmcgd2F0Y2ggZXZlbnRzIHBl
ciB3YXRjaCwKKwlyZWNvbW1lbmRlZCA+PSBtYXhvdXRzdGFuZGluZyB0byBh
dm9pZCBibG9ja2luZyBiYWNrZW5kIHRyYW5zYWN0aW9ucyBkdWUgdG8KKwlt
YWxpY2lvdXMgZnJvbnRlbmRzCisgKikKIAogbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9veGVuc3RvcmVkLmNv
bmYuaW4gYi90b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25m
LmluCmluZGV4IDRhZTQ4ZTQyZDQ3ZC4uOWQwMzRlNzQ0YjRiIDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmlu
CisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9veGVuc3RvcmVkLmNvbmYu
aW4KQEAgLTYyLDYgKzYyLDggQEAgcXVvdGEtbWF4d2F0Y2ggPSAxMDAKIHF1
b3RhLXRyYW5zYWN0aW9uID0gMTAKIHF1b3RhLW1heHJlcXVlc3RzID0gMTAy
NAogcXVvdGEtcGF0aC1tYXggPSAxMDI0CitxdW90YS1tYXhvdXRzdGFuZGlu
ZyA9IDEwMjQKK3F1b3RhLW1heHdhdGNoZXZlbnRzID0gMTAyNAogCiAjIEFj
dGl2YXRlIGZpbGVkIGJhc2UgYmFja2VuZAogcGVyc2lzdGVudCA9IGZhbHNl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5t
bCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDJk
Njc0NTZhMmFhMC4uNmRjZWRmZGE4NmU0IDEwMDY0NAotLS0gYS90b29scy9v
Y2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94
ZW5zdG9yZWQvcHJvY2Vzcy5tbApAQCAtNTcsNyArNTcsNyBAQCBsZXQgc3Bs
aXRfb25lX3BhdGggZGF0YSBjb24gPQogCXwgcGF0aCA6OiAiIiA6OiBbXSAt
PiBTdG9yZS5QYXRoLmNyZWF0ZSBwYXRoIChDb25uZWN0aW9uLmdldF9wYXRo
IGNvbikKIAl8IF8gICAgICAgICAgICAgICAgLT4gcmFpc2UgSW52YWxpZF9D
bWRfQXJncwogCi1sZXQgcHJvY2Vzc193YXRjaCB0IGNvbnMgPQorbGV0IHBy
b2Nlc3Nfd2F0Y2ggc291cmNlIHQgY29ucyA9CiAJbGV0IG9sZHJvb3QgPSB0
LlRyYW5zYWN0aW9uLm9sZHJvb3QgaW4KIAlsZXQgbmV3cm9vdCA9IFN0b3Jl
LmdldF9yb290IHQuc3RvcmUgaW4KIAlsZXQgb3BzID0gVHJhbnNhY3Rpb24u
Z2V0X3BhdGhzIHQgfD4gTGlzdC5yZXYgaW4KQEAgLTY3LDggKzY3LDkgQEAg
bGV0IHByb2Nlc3Nfd2F0Y2ggdCBjb25zID0KIAkJfCBYZW5idXMuWGIuT3Au
Um0gICAgICAgLT4gdHJ1ZSwgTm9uZSwgb2xkcm9vdAogCQl8IFhlbmJ1cy5Y
Yi5PcC5TZXRwZXJtcyAtPiBmYWxzZSwgU29tZSBvbGRyb290LCBuZXdyb290
CiAJCXwgXyAgICAgICAgICAgICAgLT4gcmFpc2UgKEZhaWx1cmUgImh1aCA/
IikgaW4KLQkJQ29ubmVjdGlvbnMuZmlyZV93YXRjaGVzID9vbGRyb290IHJv
b3QgY29ucyAoc25kIG9wKSByZWN1cnNlIGluCi0JTGlzdC5pdGVyIChmdW4g
b3AgLT4gZG9fb3Bfd2F0Y2ggb3AgY29ucykgb3BzCisJCUNvbm5lY3Rpb25z
LmZpcmVfd2F0Y2hlcyA/b2xkcm9vdCBzb3VyY2Ugcm9vdCBjb25zIChzbmQg
b3ApIHJlY3Vyc2UgaW4KKwlMaXN0Lml0ZXIgKGZ1biBvcCAtPiBkb19vcF93
YXRjaCBvcCBjb25zKSBvcHM7CisJQ29ubmVjdGlvbnMuc2VuZF93YXRjaGV2
ZW50cyBjb25zIHNvdXJjZQogCiBsZXQgY3JlYXRlX2ltcGxpY2l0X3BhdGgg
dCBwZXJtIHBhdGggPQogCWxldCBkaXJuYW1lID0gU3RvcmUuUGF0aC5nZXRf
cGFyZW50IHBhdGggaW4KQEAgLTIzNCw2ICsyMzUsMjAgQEAgbGV0IGRvX2Rl
YnVnIGNvbiB0IF9kb21haW5zIGNvbnMgZGF0YSA9CiAJfCAid2F0Y2hlcyIg
OjogXyAtPgogCQlsZXQgd2F0Y2hlcyA9IENvbm5lY3Rpb25zLmRlYnVnIGNv
bnMgaW4KIAkJU29tZSAod2F0Y2hlcyBeICJcMDAwIikKKwl8ICJ4ZW5idXMi
IDo6IGRvbWlkIDo6IF8gLT4KKwkJbGV0IGRvbWlkID0gaW50X29mX3N0cmlu
ZyBkb21pZCBpbgorCQlsZXQgY29uID0gQ29ubmVjdGlvbnMuZmluZF9kb21h
aW4gY29ucyBkb21pZCBpbgorCQlsZXQgcyA9IFByaW50Zi5zcHJpbnRmICJ4
ZW5idXM6ICVzOyBvdmVyZmxvdyBxdWV1ZSBsZW5ndGg6ICVkLCBjYW5faW5w
dXQ6ICViLCBoYXNfbW9yZV9pbnB1dDogJWIsIGhhc19vbGRfb3V0cHV0OiAl
YiwgaGFzX25ld19vdXRwdXQ6ICViLCBoYXNfbW9yZV93b3JrOiAlYi4gcGVu
ZGluZzogJXMiCisJCQkoWGVuYnVzLlhiLmRlYnVnIGNvbi54YikKKwkJCShD
b25uZWN0aW9uLnNvdXJjZV9wZW5kaW5nX3dhdGNoZXZlbnRzIGNvbikKKwkJ
CShDb25uZWN0aW9uLmNhbl9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5o
YXNfbW9yZV9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfb2xkX291
dHB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfbmV3X291dHB1dCBjb24p
CisJCQkoQ29ubmVjdGlvbi5oYXNfbW9yZV93b3JrIGNvbikKKwkJCShDb25u
ZWN0aW9ucy5kZWJ1Z193YXRjaGV2ZW50cyBjb25zIGNvbikKKwkJaW4KKwkJ
U29tZSBzCiAJfCAibWZuIiA6OiBkb21pZCA6OiBfIC0+CiAJCWxldCBkb21p
ZCA9IGludF9vZl9zdHJpbmcgZG9taWQgaW4KIAkJbGV0IGNvbiA9IENvbm5l
Y3Rpb25zLmZpbmRfZG9tYWluIGNvbnMgZG9taWQgaW4KQEAgLTM0Miw3ICsz
NTcsNyBAQCBsZXQgcmVwbHlfYWNrIGZjdCBjb24gdCBkb21zIGNvbnMgZGF0
YSA9CiAJZmN0IGNvbiB0IGRvbXMgY29ucyBkYXRhOwogCVBhY2tldC5BY2sg
KGZ1biAoKSAtPgogCQlpZiBUcmFuc2FjdGlvbi5nZXRfaWQgdCA9IFRyYW5z
YWN0aW9uLm5vbmUgdGhlbgotCQkJcHJvY2Vzc193YXRjaCB0IGNvbnMKKwkJ
CXByb2Nlc3Nfd2F0Y2ggY29uIHQgY29ucwogCSkKIAogbGV0IHJlcGx5X2Rh
dGEgZmN0IGNvbiB0IGRvbXMgY29ucyBkYXRhID0KQEAgLTUwMSw3ICs1MTYs
NyBAQCBsZXQgZG9fd2F0Y2ggY29uIHQgX2RvbWFpbnMgY29ucyBkYXRhID0K
IAlQYWNrZXQuQWNrIChmdW4gKCkgLT4KIAkJKCogeGVuc3RvcmUudHh0IHNh
eXMgdGhpcyB3YXRjaCBpcyBmaXJlZCBpbW1lZGlhdGVseSwKIAkJICAgaW1w
bHlpbmcgZXZlbiBpZiBwYXRoIGRvZXNuJ3QgZXhpc3Qgb3IgaXMgdW5yZWFk
YWJsZSAqKQotCQlDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoX3VuY2hl
Y2tlZCB3YXRjaCkKKwkJQ29ubmVjdGlvbi5maXJlX3NpbmdsZV93YXRjaF91
bmNoZWNrZWQgY29uIHdhdGNoKQogCiBsZXQgZG9fdW53YXRjaCBjb24gX3Qg
X2RvbWFpbnMgY29ucyBkYXRhID0KIAlsZXQgKG5vZGUsIHRva2VuKSA9CkBA
IC01MzIsNyArNTQ3LDcgQEAgbGV0IGRvX3RyYW5zYWN0aW9uX2VuZCBjb24g
dCBkb21haW5zIGNvbnMgZGF0YSA9CiAJaWYgbm90IHN1Y2Nlc3MgdGhlbgog
CQlyYWlzZSBUcmFuc2FjdGlvbl9hZ2FpbjsKIAlpZiBjb21taXQgdGhlbiBi
ZWdpbgotCQlwcm9jZXNzX3dhdGNoIHQgY29uczsKKwkJcHJvY2Vzc193YXRj
aCBjb24gdCBjb25zOwogCQltYXRjaCB0LlRyYW5zYWN0aW9uLnR5IHdpdGgK
IAkJfCBUcmFuc2FjdGlvbi5ObyAtPgogCQkJKCkgKCogbm8gbmVlZCB0byBy
ZWNvcmQgYW55dGhpbmcgKikKQEAgLTY5OSw3ICs3MTQsOCBAQCBsZXQgcHJv
Y2Vzc19wYWNrZXQgfnN0b3JlIH5jb25zIH5kb21zIH5jb24gfnJlcSA9CiBs
ZXQgZG9faW5wdXQgc3RvcmUgY29ucyBkb21zIGNvbiA9CiAJbGV0IG5ld3Bh
Y2tldCA9CiAJCXRyeQotCQkJQ29ubmVjdGlvbi5kb19pbnB1dCBjb24KKwkJ
CWlmIENvbm5lY3Rpb24uY2FuX2lucHV0IGNvbiB0aGVuIENvbm5lY3Rpb24u
ZG9faW5wdXQgY29uCisJCQllbHNlIE5vbmUKIAkJd2l0aCBYZW5idXMuWGIu
UmVjb25uZWN0IC0+CiAJCQlpbmZvICIlcyByZXF1ZXN0cyBhIHJlY29ubmVj
dCIgKENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24pOwogCQkJSGlzdG9yeS5y
ZWNvbm5lY3QgY29uOwpAQCAtNzI3LDYgKzc0Myw3IEBAIGxldCBkb19pbnB1
dCBzdG9yZSBjb25zIGRvbXMgY29uID0KIAkJQ29ubmVjdGlvbi5pbmNyX29w
cyBjb24KIAogbGV0IGRvX291dHB1dCBfc3RvcmUgX2NvbnMgX2RvbXMgY29u
ID0KKwlDb25uZWN0aW9uLnNvdXJjZV9mbHVzaF93YXRjaGV2ZW50cyBjb247
CiAJaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0aGVuICgKIAkJaWYg
Q29ubmVjdGlvbi5oYXNfbmV3X291dHB1dCBjb24gdGhlbiAoCiAJCQlsZXQg
cGFja2V0ID0gQ29ubmVjdGlvbi5wZWVrX291dHB1dCBjb24gaW4KZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC94ZW5zdG9yZWQubWwgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCmluZGV4IDNiNTdh
ZDAxNmRmYi4uYzc5OWUyMGYxMTQ1IDEwMDY0NAotLS0gYS90b29scy9vY2Ft
bC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC94ZW5zdG9yZWQubWwKQEAgLTEwMyw2ICsxMDMsOCBAQCBsZXQg
cGFyc2VfY29uZmlnIGZpbGVuYW1lID0KIAkJKCJxdW90YS1tYXhlbnRpdHki
LCBDb25maWcuU2V0X2ludCBRdW90YS5tYXhlbnQpOwogCQkoInF1b3RhLW1h
eHNpemUiLCBDb25maWcuU2V0X2ludCBRdW90YS5tYXhzaXplKTsKIAkJKCJx
dW90YS1tYXhyZXF1ZXN0cyIsIENvbmZpZy5TZXRfaW50IERlZmluZS5tYXhy
ZXF1ZXN0cyk7CisJCSgicXVvdGEtbWF4b3V0c3RhbmRpbmciLCBDb25maWcu
U2V0X2ludCBEZWZpbmUubWF4b3V0c3RhbmRpbmcpOworCQkoInF1b3RhLW1h
eHdhdGNoZXZlbnRzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHdhdGNo
ZXZlbnRzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CiAJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-oxenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-oxenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSAwOWFhMTA2NDlmNzVhMjYyMDI4ZTlhOWI3ZDg1OWVmN2VmYjIzZDU0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFRodSwgMjkgU2VwIDIwMjIgMTM6
MDc6MzUgKzAyMDAKU3ViamVjdDogU1VQUE9SVC5tZDogY2xhcmlmeSBzdXBw
b3J0IG9mIHVudHJ1c3RlZCBkcml2ZXIgZG9tYWlucyB3aXRoCiBveGVuc3Rv
cmVkCgpBZGQgYSBzdXBwb3J0IHN0YXRlbWVudCBmb3IgdGhlIHNjb3BlIG9m
IHN1cHBvcnQgcmVnYXJkaW5nIGRpZmZlcmVudApYZW5zdG9yZSB2YXJpYW50
cy4gRXNwZWNpYWxseSBveGVuc3RvcmVkIGRvZXMgbm90ICh5ZXQpIGhhdmUg
c2VjdXJpdHkKc3VwcG9ydCBvZiB1bnRydXN0ZWQgZHJpdmVyIGRvbWFpbnMs
IGFzIHRob3NlIG1pZ2h0IGRyaXZlIG94ZW5zdG9yZWQKb3V0IG9mIG1lbW9y
eSBieSBjcmVhdGluZyBsb3RzIG9mIHdhdGNoIGV2ZW50cyBmb3IgdGhlIGd1
ZXN0cyB0aGV5IGFyZQpzZXJ2aWNpbmcuCgpBZGQgYSBzdGF0ZW1lbnQgcmVn
YXJkaW5nIExpdmUgVXBkYXRlIHN1cHBvcnQgb2Ygb3hlbnN0b3JlZC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBD
aHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+
CgpkaWZmIC0tZ2l0IGEvU1VQUE9SVC5tZCBiL1NVUFBPUlQubWQKaW5kZXgg
ODU3MjYxMDJlYWI4Li43ZDBjYjM0YzhmNmYgMTAwNjQ0Ci0tLSBhL1NVUFBP
UlQubWQKKysrIGIvU1VQUE9SVC5tZApAQCAtMTc5LDEzICsxNzksMTggQEAg
U3VwcG9ydCBmb3IgcnVubmluZyBxZW11LXhlbiBkZXZpY2UgbW9kZWwgaW4g
YSBsaW51eCBzdHViZG9tYWluLgogCiAgICAgU3RhdHVzOiBUZWNoIFByZXZp
ZXcKIAotIyMgTGl2ZXVwZGF0ZSBvZiBDIHhlbnN0b3JlZCBkYWVtb24KKyMj
IFhlbnN0b3JlCiAKLSAgICBTdGF0dXM6IFRlY2ggUHJldmlldworIyMjIEMg
eGVuc3RvcmVkIGRhZW1vbgogCi0jIyBMaXZldXBkYXRlIG9mIE9DYW1sIHhl
bnN0b3JlZCBkYWVtb24KKyAgICBTdGF0dXM6IFN1cHBvcnRlZAorICAgIFN0
YXR1cywgTGl2ZXVwZGF0ZTogVGVjaCBQcmV2aWV3CiAKLSAgICBTdGF0dXM6
IFRlY2ggUHJldmlldworIyMjIE9DYW1sIHhlbnN0b3JlZCBkYWVtb24KKwor
ICAgIFN0YXR1czogU3VwcG9ydGVkCisgICAgU3RhdHVzLCB1bnRydXN0ZWQg
ZHJpdmVyIGRvbWFpbnM6IFN1cHBvcnRlZCwgbm90IHNlY3VyaXR5IHN1cHBv
cnRlZAorICAgIFN0YXR1cywgTGl2ZXVwZGF0ZTogTm90IGZ1bmN0aW9uYWwK
IAogIyMgVG9vbHN0YWNrLzNyZCBwYXJ0eQogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSA1MTkyZjEzYTQxNjYxYjFjMWI5ZTA4ODlkNTdjMGY1YjQxOTI1YzM5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNwbGl0IHVw
IHNlbmRfcmVwbHkoKQoKVG9kYXkgc2VuZF9yZXBseSgpIGlzIHVzZWQgZm9y
IGJvdGgsIG5vcm1hbCByZXF1ZXN0IHJlcGxpZXMgYW5kIHdhdGNoCmV2ZW50
cy4KClNwbGl0IGl0IHVwIGludG8gc2VuZF9yZXBseSgpIGFuZCBzZW5kX2V2
ZW50KCkuIFRoaXMgd2lsbCBiZSB1c2VkIHRvCmFkZCBzb21lIGV2ZW50IHNw
ZWNpZmljIGhhbmRsaW5nLgoKYWRkX2V2ZW50KCkgY2FuIGJlIG1lcmdlZCBp
bnRvIHNlbmRfZXZlbnQoKSwgcmVtb3ZpbmcgdGhlIG5lZWQgZm9yIGFuCmlu
dGVybWVkaWF0ZSBtZW1vcnkgYWxsb2NhdGlvbi4KClRoaXMgaXMgcGFydCBv
ZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdy
YWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9j
b3JlLmMKaW5kZXggZTljOTY5NWZkMTZlLi4yNDlhZDVlYzZmYjEgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNzY3LDQ5ICs3
NjcsMzIgQEAgc3RhdGljIHZvaWQgc2VuZF9lcnJvcihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgaW50IGVycm9yKQogdm9pZCBzZW5kX3JlcGx5KHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlw
ZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbikKIHsK
LQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7CisJc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmJkYXRhID0gY29ubi0+aW47CisKKwlhc3NlcnQodHlwZSAh
PSBYU19XQVRDSF9FVkVOVCk7CiAKIAlpZiAoIGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYICkgewogCQlzZW5kX2Vycm9yKGNvbm4sIEUyQklHKTsKIAkJ
cmV0dXJuOwogCX0KIAotCS8qIFJlcGxpZXMgcmV1c2UgdGhlIHJlcXVlc3Qg
YnVmZmVyLCBldmVudHMgbmVlZCBhIG5ldyBvbmUuICovCi0JaWYgKHR5cGUg
IT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJYmRhdGEgPSBjb25uLT5pbjsKLQkJ
LyogRHJvcCBhc3luY2hyb25vdXMgcmVzcG9uc2VzLCBlLmcuIGVycm9ycyBm
b3Igd2F0Y2ggZXZlbnRzLiAqLwotCQlpZiAoIWJkYXRhKQotCQkJcmV0dXJu
OwotCQliZGF0YS0+aW5oZHIgPSB0cnVlOwotCQliZGF0YS0+dXNlZCA9IDA7
Ci0JCWNvbm4tPmluID0gTlVMTDsKLQl9IGVsc2UgewotCQkvKiBNZXNzYWdl
IGlzIGEgY2hpbGQgb2YgdGhlIGNvbm5lY3Rpb24gZm9yIGF1dG8tY2xlYW51
cC4gKi8KLQkJYmRhdGEgPSBuZXdfYnVmZmVyKGNvbm4pOworCWlmICghYmRh
dGEpCisJCXJldHVybjsKKwliZGF0YS0+aW5oZHIgPSB0cnVlOworCWJkYXRh
LT51c2VkID0gMDsKIAotCQkvKgotCQkgKiBBbGxvY2F0aW9uIGZhaWx1cmUg
aGVyZSBpcyB1bmZvcnR1bmF0ZTogd2UgaGF2ZSBubyB3YXkgdG8KLQkJICog
dGVsbCBhbnlib2R5IGFib3V0IGl0LgotCQkgKi8KLQkJaWYgKCFiZGF0YSkK
LQkJCXJldHVybjsKLQl9CiAJaWYgKGxlbiA8PSBERUZBVUxUX0JVRkZFUl9T
SVpFKQogCQliZGF0YS0+YnVmZmVyID0gYmRhdGEtPmRlZmF1bHRfYnVmZmVy
OwotCWVsc2UKKwllbHNlIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IHRhbGxvY19h
cnJheShiZGF0YSwgY2hhciwgbGVuKTsKLQlpZiAoIWJkYXRhLT5idWZmZXIp
IHsKLQkJaWYgKHR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJCS8qIFNh
bWUgYXMgYWJvdmU6IG5vIHdheSB0byB0ZWxsIHNvbWVvbmUuICovCi0JCQl0
YWxsb2NfZnJlZShiZGF0YSk7CisJCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQkJc2VuZF9lcnJvcihjb25uLCBFTk9NRU0pOwogCQkJcmV0dXJuOwogCQl9
Ci0JCS8qIHJlLWVzdGFibGlzaCByZXF1ZXN0IGJ1ZmZlciBmb3Igc2VuZGlu
ZyBFTk9NRU0uICovCi0JCWNvbm4tPmluID0gYmRhdGE7Ci0JCXNlbmRfZXJy
b3IoY29ubiwgRU5PTUVNKTsKLQkJcmV0dXJuOwogCX0KIAorCWNvbm4tPmlu
ID0gTlVMTDsKKwogCS8qIFVwZGF0ZSByZWxldmFudCBoZWFkZXIgZmllbGRz
IGFuZCBmaWxsIGluIHRoZSBtZXNzYWdlIGJvZHkuICovCiAJYmRhdGEtPmhk
ci5tc2cudHlwZSA9IHR5cGU7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVu
OwpAQCAtODE3LDggKzgwMCwzOSBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBl
LAogCiAJLyogUXVldWUgZm9yIGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAls
aXN0X2FkZF90YWlsKCZiZGF0YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsK
K30KIAotCXJldHVybjsKKy8qCisgKiBTZW5kIGEgd2F0Y2ggZXZlbnQuCisg
KiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSByZWxhdGVkIHRvIHRoZSBjdXJy
ZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBiZQorICogcmVwb3J0ZWQuCisg
Ki8KK3ZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pCit7CisJc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhOworCXVuc2lnbmVkIGludCBsZW47
CisKKwlsZW4gPSBzdHJsZW4ocGF0aCkgKyAxICsgc3RybGVuKHRva2VuKSAr
IDE7CisJLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4g
Ki8KKwlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCisJCXJldHVy
bjsKKworCWJkYXRhID0gbmV3X2J1ZmZlcihjb25uKTsKKwlpZiAoIWJkYXRh
KQorCQlyZXR1cm47CisKKwliZGF0YS0+YnVmZmVyID0gdGFsbG9jX2FycmF5
KGJkYXRhLCBjaGFyLCBsZW4pOworCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQl0YWxsb2NfZnJlZShiZGF0YSk7CisJCXJldHVybjsKKwl9CisJc3RyY3B5
KGJkYXRhLT5idWZmZXIsIHBhdGgpOworCXN0cmNweShiZGF0YS0+YnVmZmVy
ICsgc3RybGVuKHBhdGgpICsgMSwgdG9rZW4pOworCWJkYXRhLT5oZHIubXNn
LnR5cGUgPSBYU19XQVRDSF9FVkVOVDsKKwliZGF0YS0+aGRyLm1zZy5sZW4g
PSBsZW47CisKKwkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAq
LworCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xp
c3QpOwogfQogCiAvKiBTb21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0
YykganVzdCBuZWVkIGEgbm9uLWVycm9yIHJldHVybiAqLwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggMDAwNGZhODQ4YzgzLi45
YWY5YWY0MzkwYmQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaApAQCAtMTg3LDYgKzE4Nyw3IEBAIHVuc2lnbmVkIGludCBnZXRfc3Ry
aW5nKGNvbnN0IHN0cnVjdCBidWZmZXJlZF9kYXRhICpkYXRhLCB1bnNpZ25l
ZCBpbnQgb2Zmc2V0KTsKIAogdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAkJ
Y29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbik7Cit2b2lkIHNl
bmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IGNoYXIg
KnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKIAogLyogU29tZSByb3V0aW5l
cyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3QgbmVlZCBhIG5vbi1lcnJvciBy
ZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlKTsKZGlmZiAtLWdpdCBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggYWNhMGE3MWJhZGExLi45
OWEyYzI2NmIyOGEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jCkBAIC04NiwzNSArODYsNiBAQCBzdGF0aWMgY29uc3QgY2hhciAq
Z2V0X3dhdGNoX3BhdGgoY29uc3Qgc3RydWN0IHdhdGNoICp3YXRjaCwgY29u
c3QgY2hhciAqbmFtZSkKIH0KIAogLyoKLSAqIFNlbmQgYSB3YXRjaCBldmVu
dC4KLSAqIFRlbXBvcmFyeSBtZW1vcnkgYWxsb2NhdGlvbnMgYXJlIGRvbmUg
d2l0aCBjdHguCi0gKi8KLXN0YXRpYyB2b2lkIGFkZF9ldmVudChzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKLQkJICAgICAgY29uc3Qgdm9pZCAqY3R4LAot
CQkgICAgICBzdHJ1Y3Qgd2F0Y2ggKndhdGNoLAotCQkgICAgICBjb25zdCBj
aGFyICpuYW1lKQotewotCS8qIERhdGEgdG8gc2VuZCAobm9kZVwwdG9rZW5c
MCkuICovCi0JdW5zaWduZWQgaW50IGxlbjsKLQljaGFyICpkYXRhOwotCi0J
bmFtZSA9IGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKTsKLQotCWxlbiA9
IHN0cmxlbihuYW1lKSArIDEgKyBzdHJsZW4od2F0Y2gtPnRva2VuKSArIDE7
Ci0JLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4gKi8K
LQlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCi0JCXJldHVybjsK
LQotCWRhdGEgPSB0YWxsb2NfYXJyYXkoY3R4LCBjaGFyLCBsZW4pOwotCWlm
ICghZGF0YSkKLQkJcmV0dXJuOwotCXN0cmNweShkYXRhLCBuYW1lKTsKLQlz
dHJjcHkoZGF0YSArIHN0cmxlbihuYW1lKSArIDEsIHdhdGNoLT50b2tlbik7
Ci0Jc2VuZF9yZXBseShjb25uLCBYU19XQVRDSF9FVkVOVCwgZGF0YSwgbGVu
KTsKLQl0YWxsb2NfZnJlZShkYXRhKTsKLX0KLQotLyoKICAqIENoZWNrIHBl
cm1pc3Npb25zIG9mIGEgc3BlY2lmaWMgd2F0Y2ggdG8gZmlyZToKICAqIEVp
dGhlciB0aGUgbm9kZSBpdHNlbGYgb3IgaXRzIHBhcmVudCBoYXZlIHRvIGJl
IHJlYWRhYmxlIGJ5IHRoZSBjb25uZWN0aW9uCiAgKiB0aGUgd2F0Y2ggaGFz
IGJlZW4gc2V0dXAgZm9yLiBJbiBjYXNlIGEgd2F0Y2ggZXZlbnQgaXMgY3Jl
YXRlZCBkdWUgdG8KQEAgLTE5MCwxMCArMTYxLDE0IEBAIHZvaWQgZmlyZV93
YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpj
dHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCWxpc3RfZm9yX2VhY2hfZW50cnko
d2F0Y2gsICZpLT53YXRjaGVzLCBsaXN0KSB7CiAJCQlpZiAoZXhhY3QpIHsK
IAkJCQlpZiAoc3RyZXEobmFtZSwgd2F0Y2gtPm5vZGUpKQotCQkJCQlhZGRf
ZXZlbnQoaSwgY3R4LCB3YXRjaCwgbmFtZSk7CisJCQkJCXNlbmRfZXZlbnQo
aSwKKwkJCQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKKwkJ
CQkJCSAgIHdhdGNoLT50b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChp
c19jaGlsZChuYW1lLCB3YXRjaC0+bm9kZSkpCi0JCQkJCWFkZF9ldmVudChp
LCBjdHgsIHdhdGNoLCBuYW1lKTsKKwkJCQkJc2VuZF9ldmVudChpLAorCQkJ
CQkJICAgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIG5hbWUpLAorCQkJCQkJICAg
d2F0Y2gtPnRva2VuKTsKIAkJCX0KIAkJfQogCX0KQEAgLTI5Miw3ICsyNjcs
NyBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAlzZW5kX2Fjayhjb25uLCBYU19X
QVRDSCk7CiAKIAkvKiBXZSBmaXJlIG9uY2UgdXAgZnJvbnQ6IHNpbXBsaWZp
ZXMgY2xpZW50cyBhbmQgcmVzdGFydC4gKi8KLQlhZGRfZXZlbnQoY29ubiwg
aW4sIHdhdGNoLCB3YXRjaC0+bm9kZSk7CisJc2VuZF9ldmVudChjb25uLCBn
ZXRfd2F0Y2hfcGF0aCh3YXRjaCwgd2F0Y2gtPm5vZGUpLCB3YXRjaC0+dG9r
ZW4pOwogCiAJcmV0dXJuIDA7CiB9Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSAwYTRjODZmOGE4ZmViZDg1NjEwNDk2NDcwMTIzYWRmYzRmYmMxYzVk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBoZWxw
ZXJzIHRvIGZyZWUgc3RydWN0IGJ1ZmZlcmVkX2RhdGEKCkFkZCB0d28gaGVs
cGVycyBmb3IgZnJlZWluZyBzdHJ1Y3QgYnVmZmVyZWRfZGF0YTogZnJlZV9i
dWZmZXJlZF9kYXRhKCkKZm9yIGZyZWVpbmcgb25lIGluc3RhbmNlIGFuZCBj
b25uX2ZyZWVfYnVmZmVyZWRfZGF0YSgpIGZvciBmcmVlaW5nIGFsbAppbnN0
YW5jZXMgZm9yIGEgY29ubmVjdGlvbi4KClRoaXMgaXMgYXZvaWRpbmcgZHVw
bGljYXRlZCBjb2RlIGFuZCB3aWxsIGhlbHAgbGF0ZXIgd2hlbiBtb3JlIGFj
dGlvbnMKYXJlIG5lZWRlZCB3aGVuIGZyZWVpbmcgYSBzdHJ1Y3QgYnVmZmVy
ZWRfZGF0YS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggMjQ5YWQ1ZWM2
ZmIxLi41MjdhMWViZGVkZWQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMjExLDYgKzIxMSwyMSBAQCB2b2lkIHJlb3Blbl9s
b2codm9pZCkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRf
ZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAorCQkJICAgICAgIHN0
cnVjdCBjb25uZWN0aW9uICpjb25uKQoreworCWxpc3RfZGVsKCZvdXQtPmxp
c3QpOworCXRhbGxvY19mcmVlKG91dCk7Cit9CisKK3ZvaWQgY29ubl9mcmVl
X2J1ZmZlcmVkX2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJ
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKKworCXdoaWxlICgob3V0ID0g
bGlzdF90b3AoJmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSwgbGlzdCkpKQorCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
K30KKwogc3RhdGljIGJvb2wgd3JpdGVfbWVzc2FnZXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaW50IHJldDsKQEAgLTI1NCw4ICsyNjksNyBA
QCBzdGF0aWMgYm9vbCB3cml0ZV9tZXNzYWdlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXRyYWNlX2lvKGNvbm4sIG91dCwgMSk7CiAKLQlsaXN0
X2RlbCgmb3V0LT5saXN0KTsKLQl0YWxsb2NfZnJlZShvdXQpOworCWZyZWVf
YnVmZmVyZWRfZGF0YShvdXQsIGNvbm4pOwogCiAJcmV0dXJuIHRydWU7CiB9
CkBAIC0xNTA2LDE4ICsxNTIwLDEyIEBAIHN0YXRpYyBzdHJ1Y3QgewogICov
CiB2b2lkIGlnbm9yZV9jb25uZWN0aW9uKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uKQogewotCXN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsICp0bXA7Ci0K
IAl0cmFjZSgiQ09OTiAlcCBpZ25vcmVkXG4iLCBjb25uKTsKIAogCWNvbm4t
PmlzX2lnbm9yZWQgPSB0cnVlOwogCWNvbm5fZGVsZXRlX2FsbF93YXRjaGVz
KGNvbm4pOwogCWNvbm5fZGVsZXRlX2FsbF90cmFuc2FjdGlvbnMoY29ubik7
Ci0KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUob3V0LCB0bXAsICZjb25u
LT5vdXRfbGlzdCwgbGlzdCkgewotCQlsaXN0X2RlbCgmb3V0LT5saXN0KTsK
LQkJdGFsbG9jX2ZyZWUob3V0KTsKLQl9CisJY29ubl9mcmVlX2J1ZmZlcmVk
X2RhdGEoY29ubik7CiAKIAl0YWxsb2NfZnJlZShjb25uLT5pbik7CiAJY29u
bi0+aW4gPSBOVUxMOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmgKaW5kZXggOWFmOWFmNDM5MGJkLi5lN2VlODc4MjVjM2IgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjc2LDYgKzI3Niw4
IEBAIGludCByZW1lbWJlcl9zdHJpbmcoc3RydWN0IGhhc2h0YWJsZSAqaGFz
aCwgY29uc3QgY2hhciAqc3RyKTsKIAogdm9pZCBzZXRfdGRiX2tleShjb25z
dCBjaGFyICpuYW1lLCBUREJfREFUQSAqa2V5KTsKIAordm9pZCBjb25uX2Zy
ZWVfYnVmZmVyZWRfZGF0YShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CisK
IGNvbnN0IGNoYXIgKmR1bXBfc3RhdGVfZ2xvYmFsKEZJTEUgKmZwKTsKIGNv
bnN0IGNoYXIgKmR1bXBfc3RhdGVfYnVmZmVyZWRfZGF0YShGSUxFICpmcCwg
Y29uc3Qgc3RydWN0IGNvbm5lY3Rpb24gKmMsCiAJCQkJICAgICBzdHJ1Y3Qg
eHNfc3RhdGVfY29ubmVjdGlvbiAqc2MpOwpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IGQwM2M3ZDkzYTllNy4uOTNjNGMx
ZWRjZGQxIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFp
bi5jCkBAIC00MTEsMTUgKzQxMSwxMCBAQCBzdGF0aWMgc3RydWN0IGRvbWFp
biAqZmluZF9kb21haW5fYnlfZG9taWQodW5zaWduZWQgaW50IGRvbWlkKQog
c3RhdGljIHZvaWQgZG9tYWluX2Nvbm5fcmVzZXQoc3RydWN0IGRvbWFpbiAq
ZG9tYWluKQogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25uID0gZG9tYWlu
LT5jb25uOwotCXN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQ7CiAKIAljb25u
X2RlbGV0ZV9hbGxfd2F0Y2hlcyhjb25uKTsKIAljb25uX2RlbGV0ZV9hbGxf
dHJhbnNhY3Rpb25zKGNvbm4pOwotCi0Jd2hpbGUgKChvdXQgPSBsaXN0X3Rv
cCgmY29ubi0+b3V0X2xpc3QsIHN0cnVjdCBidWZmZXJlZF9kYXRhLCBsaXN0
KSkpIHsKLQkJbGlzdF9kZWwoJm91dC0+bGlzdCk7Ci0JCXRhbGxvY19mcmVl
KG91dCk7Ci0JfQorCWNvbm5fZnJlZV9idWZmZXJlZF9kYXRhKGNvbm4pOwog
CiAJdGFsbG9jX2ZyZWUoY29ubi0+aW4pOwogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBhNmM0MTk4MjQyYmY2OWJlYTE4MjU0OTJiNzY2NWI1NTkwMjMzOTBj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlZHVjZSBu
dW1iZXIgb2Ygd2F0Y2ggZXZlbnRzCgpXaGVuIHJlbW92aW5nIGEgd2F0Y2hl
ZCBub2RlIG91dHNpZGUgb2YgYSB0cmFuc2FjdGlvbiwgdHdvIHdhdGNoIGV2
ZW50cwphcmUgYmVpbmcgcHJvZHVjZWQgaW5zdGVhZCBvZiBqdXN0IGEgc2lu
Z2xlIG9uZS4KCldoZW4gZmluYWxpemluZyBhIHRyYW5zYWN0aW9uIHdhdGNo
IGV2ZW50cyBjYW4gYmUgZ2VuZXJhdGVkIGZvciBlYWNoCm5vZGUgd2hpY2gg
aXMgYmVpbmcgbW9kaWZpZWQsIGV2ZW4gaWYgb3V0c2lkZSBhIHRyYW5zYWN0
aW9uIHN1Y2gKbW9kaWZpY2F0aW9ucyBtaWdodCBub3QgaGF2ZSByZXN1bHRl
ZCBpbiBhIHdhdGNoIGV2ZW50LgoKVGhpcyBoYXBwZW5zIGUuZy46CgotIGZv
ciBub2RlcyB3aGljaCBhcmUgb25seSBtb2RpZmllZCBkdWUgdG8gYWRkZWQv
cmVtb3ZlZCBjaGlsZCBlbnRyaWVzCi0gZm9yIG5vZGVzIGJlaW5nIHJlbW92
ZWQgb3IgY3JlYXRlZCBpbXBsaWNpdGx5IChlLmcuIGNyZWF0aW9uIG9mIGEv
Yi9jCiAgaXMgaW1wbGljaXRseSBjcmVhdGluZyBhL2IsIHJlc3VsdGluZyBp
biB3YXRjaCBldmVudHMgZm9yIGEsIGEvYiBhbmQKICBhL2IvYyBpbnN0ZWFk
IG9mIGEvYi9jIG9ubHkpCgpBdm9pZCB0aGVzZSBhZGRpdGlvbmFsIHdhdGNo
IGV2ZW50cywgaW4gb3JkZXIgdG8gcmVkdWNlIHRoZSBuZWVkZWQKbWVtb3J5
IGluc2lkZSBYZW5zdG9yZSBmb3IgcXVldWVpbmcgdGhlbS4KClRoaXMgaXMg
YmVpbmcgYWNoaWV2ZWQgYnkgYWRkaW5nIGV2ZW50IGZsYWdzIHRvIHN0cnVj
dCBhY2Nlc3NlZF9ub2RlCnNwZWNpZnlpbmcgd2hldGhlciBhbiBldmVudCBz
aG91bGQgYmUgdHJpZ2dlcmVkLCBhbmQgd2hldGhlciBpdCBzaG91bGQKYmUg
YW4gZXhhY3QgbWF0Y2ggb2YgdGhlIG1vZGlmaWVkIHBhdGguIEJvdGggZmxh
Z3MgY2FuIGJlIHNldCBmcm9tCmZpcmVfd2F0Y2hlcygpIGluc3RlYWQgb2Yg
aW1wbHlpbmcgdGhlbSBvbmx5LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA1MjdhMWViZGVkZWQuLmJmMjI0Mzg3MzkwMSAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMjk1LDcgKzEyOTUsNyBAQCBz
dGF0aWMgdm9pZCBkZWxldGVfY2hpbGQoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiB9CiAKIHN0YXRpYyBpbnQgZGVsZXRlX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKLQkJICAgICAgIHN0cnVj
dCBub2RlICpwYXJlbnQsIHN0cnVjdCBub2RlICpub2RlKQorCQkgICAgICAg
c3RydWN0IG5vZGUgKnBhcmVudCwgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wg
d2F0Y2hfZXhhY3QpCiB7CiAJY2hhciAqbmFtZTsKIApAQCAtMTMwNyw3ICsx
MzA3LDcgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkJCSAgICAgICBub2Rl
LT5jaGlsZHJlbik7CiAJCWNoaWxkID0gbmFtZSA/IHJlYWRfbm9kZShjb25u
LCBub2RlLCBuYW1lKSA6IE5VTEw7CiAJCWlmIChjaGlsZCkgewotCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQpKQorCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQsIHRydWUpKQog
CQkJCXJldHVybiBlcnJubzsKIAkJfSBlbHNlIHsKIAkJCXRyYWNlKCJkZWxl
dGVfbm9kZTogRXJyb3IgZGVsZXRpbmcgY2hpbGQgJyVzLyVzJyFcbiIsCkBA
IC0xMzE5LDcgKzEzMTksMTIgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQl0
YWxsb2NfZnJlZShuYW1lKTsKIAl9CiAKLQlmaXJlX3dhdGNoZXMoY29ubiwg
Y3R4LCBub2RlLT5uYW1lLCBub2RlLCB0cnVlLCBOVUxMKTsKKwkvKgorCSAq
IEZpcmUgdGhlIHdhdGNoZXMgbm93LCB3aGVuIHdlIGNhbiBzdGlsbCBzZWUg
dGhlIG5vZGUgcGVybWlzc2lvbnMuCisJICogVGhpcyBmaW5lIGFzIHdlIGFy
ZSBzaW5nbGUgdGhyZWFkZWQgYW5kIHRoZSBuZXh0IHBvc3NpYmxlIHJlYWQg
d2lsbAorCSAqIGJlIGhhbmRsZWQgb25seSBhZnRlciB0aGUgbm9kZSBoYXMg
YmVlbiByZWFsbHkgcmVtb3ZlZC4KKwkgKi8KKwlmaXJlX3dhdGNoZXMoY29u
biwgY3R4LCBub2RlLT5uYW1lLCBub2RlLCB3YXRjaF9leGFjdCwgTlVMTCk7
CiAJZGVsZXRlX25vZGVfc2luZ2xlKGNvbm4sIG5vZGUpOwogCWRlbGV0ZV9j
aGlsZChjb25uLCBwYXJlbnQsIGJhc2VuYW1lKG5vZGUtPm5hbWUpKTsKIAl0
YWxsb2NfZnJlZShub2RlKTsKQEAgLTEzNDUsMTMgKzEzNTAsNyBAQCBzdGF0
aWMgaW50IF9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAkJcmV0dXJuIChlcnJubyA9
PSBFTk9NRU0pID8gRU5PTUVNIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9
IHBhcmVudDsKIAotCS8qCi0JICogRmlyZSB0aGUgd2F0Y2hlcyBub3csIHdo
ZW4gd2UgY2FuIHN0aWxsIHNlZSB0aGUgbm9kZSBwZXJtaXNzaW9ucy4KLQkg
KiBUaGlzIGZpbmUgYXMgd2UgYXJlIHNpbmdsZSB0aHJlYWRlZCBhbmQgdGhl
IG5leHQgcG9zc2libGUgcmVhZCB3aWxsCi0JICogYmUgaGFuZGxlZCBvbmx5
IGFmdGVyIHRoZSBub2RlIGhhcyBiZWVuIHJlYWxseSByZW1vdmVkLgotCSAq
LwotCWZpcmVfd2F0Y2hlcyhjb25uLCBjdHgsIG5hbWUsIG5vZGUsIGZhbHNl
LCBOVUxMKTsKLQlyZXR1cm4gZGVsZXRlX25vZGUoY29ubiwgY3R4LCBwYXJl
bnQsIG5vZGUpOworCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBh
cmVudCwgbm9kZSwgZmFsc2UpOwogfQogCiAKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKaW5kZXggZmFmNmM5MzBl
NDJhLi41NDQzMjkwN2ZjNzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCkBAIC0xMzAsNiArMTMwLDEwIEBA
IHN0cnVjdCBhY2Nlc3NlZF9ub2RlCiAKIAkvKiBUcmFuc2FjdGlvbiBub2Rl
IGluIGRhdGEgYmFzZT8gKi8KIAlib29sIHRhX25vZGU7CisKKwkvKiBXYXRj
aCBldmVudCBmbGFncy4gKi8KKwlib29sIGZpcmVfd2F0Y2g7CisJYm9vbCB3
YXRjaF9leGFjdDsKIH07CiAKIHN0cnVjdCBjaGFuZ2VkX2RvbWFpbgpAQCAt
MzI0LDYgKzMyOCwyOSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogfQogCiAvKgorICog
QSB3YXRjaCBldmVudCBzaG91bGQgYmUgZmlyZWQgZm9yIGEgbm9kZSBtb2Rp
ZmllZCBpbnNpZGUgYSB0cmFuc2FjdGlvbi4KKyAqIFNldCB0aGUgY29ycmVz
cG9uZGluZyBpbmZvcm1hdGlvbi4gQSBub24tZXhhY3QgZXZlbnQgaXMgcmVw
bGFjaW5nIGFuIGV4YWN0CisgKiBvbmUsIGJ1dCBub3QgdGhlIG90aGVyIHdh
eSByb3VuZC4KKyAqLwordm9pZCBxdWV1ZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBib29sIHdhdGNoX2V4
YWN0KQoreworCXN0cnVjdCBhY2Nlc3NlZF9ub2RlICppOworCisJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZShjb25uLT50cmFuc2FjdGlvbiwgbmFtZSk7CisJ
aWYgKCFpKSB7CisJCWNvbm4tPnRyYW5zYWN0aW9uLT5mYWlsID0gdHJ1ZTsK
KwkJcmV0dXJuOworCX0KKworCWlmICghaS0+ZmlyZV93YXRjaCkgeworCQlp
LT5maXJlX3dhdGNoID0gdHJ1ZTsKKwkJaS0+d2F0Y2hfZXhhY3QgPSB3YXRj
aF9leGFjdDsKKwl9IGVsc2UgaWYgKCF3YXRjaF9leGFjdCkgeworCQlpLT53
YXRjaF9leGFjdCA9IGZhbHNlOworCX0KK30KKworLyoKICAqIEZpbmFsaXpl
IHRyYW5zYWN0aW9uOgogICogV2FsayB0aHJvdWdoIGFjY2Vzc2VkIG5vZGVz
IGFuZCBjaGVjayBnZW5lcmF0aW9uIGFnYWluc3QgZ2xvYmFsIGRhdGEuCiAg
KiBJZiBhbGwgZW50cmllcyBtYXRjaCwgcmVhZCB0aGUgdHJhbnNhY3Rpb24g
ZW50cmllcyBhbmQgd3JpdGUgdGhlbSB3aXRob3V0CkBAIC0zNzcsMTUgKzQw
NCwxNSBAQCBzdGF0aWMgaW50IGZpbmFsaXplX3RyYW5zYWN0aW9uKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJf
Y3R4LCBrZXksIGRhdGEsCiAJCQkJCQlUREJfUkVQTEFDRSk7CiAJCQkJdGFs
bG9jX2ZyZWUoZGF0YS5kcHRyKTsKLQkJCQlpZiAocmV0KQotCQkJCQlnb3Rv
IGVycjsKLQkJCQlmaXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUs
IE5VTEwsIGZhbHNlLAotCQkJCQkgICAgIGktPnBlcm1zLnAgPyAmaS0+cGVy
bXMgOiBOVUxMKTsKIAkJCX0gZWxzZSB7Ci0JCQkJZmlyZV93YXRjaGVzKGNv
bm4sIHRyYW5zLCBpLT5ub2RlLCBOVUxMLCBmYWxzZSwKKwkJCQlyZXQgPSB0
ZGJfZGVsZXRlKHRkYl9jdHgsIGtleSk7CisJCQl9CisJCQlpZiAocmV0KQor
CQkJCWdvdG8gZXJyOworCQkJaWYgKGktPmZpcmVfd2F0Y2gpIHsKKwkJCQlm
aXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUsIE5VTEwsCisJCQkJ
CSAgICAgaS0+d2F0Y2hfZXhhY3QsCiAJCQkJCSAgICAgaS0+cGVybXMucCA/
ICZpLT5wZXJtcyA6IE5VTEwpOwotCQkJCWlmICh0ZGJfZGVsZXRlKHRkYl9j
dHgsIGtleSkpCi0JCQkJCWdvdG8gZXJyOwogCQkJfQogCQl9CiAKZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKaW5k
ZXggMTQwNjI3MzBlM2M5Li4wMDkzY2FjODA3ZTMgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCkBAIC00Miw2
ICs0Miw5IEBAIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlfZGVjKHN0cnVjdCB0
cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBkb21pZCk7CiBpbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAogICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKIAorLyogUXVldWUgd2F0Y2hl
cyBmb3IgYSBtb2RpZmllZCBub2RlLiAqLwordm9pZCBxdWV1ZV93YXRjaGVz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBi
b29sIHdhdGNoX2V4YWN0KTsKKwogLyogUHJlcGVuZCB0aGUgdHJhbnNhY3Rp
b24gdG8gbmFtZSBpZiBhcHByb3ByaWF0ZS4gKi8KIGludCB0cmFuc2FjdGlv
bl9wcmVwZW5kKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgVERCX0RBVEEgKmtl
eSk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0
Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCmluZGV4
IDk5YTJjMjY2YjI4YS4uMjA1ZDlkOGVhMTE2IDEwMDY0NAotLS0gYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMjksNiArMjksNyBAQAogI2lu
Y2x1ZGUgInhlbnN0b3JlX2xpYi5oIgogI2luY2x1ZGUgInV0aWxzLmgiCiAj
aW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgorI2luY2x1ZGUgInhlbnN0
b3JlZF90cmFuc2FjdGlvbi5oIgogCiBleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CiAKQEAgLTE0Myw5ICsxNDQsMTEgQEAgdm9pZCBm
aXJlX3dhdGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwKIAlzdHJ1Y3QgY29ubmVjdGlv
biAqaTsKIAlzdHJ1Y3Qgd2F0Y2ggKndhdGNoOwogCi0JLyogRHVyaW5nIHRy
YW5zYWN0aW9ucywgZG9uJ3QgZmlyZSB3YXRjaGVzLiAqLwotCWlmIChjb25u
ICYmIGNvbm4tPnRyYW5zYWN0aW9uKQorCS8qIER1cmluZyB0cmFuc2FjdGlv
bnMsIGRvbid0IGZpcmUgd2F0Y2hlcywgYnV0IHF1ZXVlIHRoZW0uICovCisJ
aWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24pIHsKKwkJcXVldWVfd2F0
Y2hlcyhjb25uLCBuYW1lLCBleGFjdCk7CiAJCXJldHVybjsKKwl9CiAKIAkv
KiBDcmVhdGUgYW4gZXZlbnQgZm9yIGVhY2ggd2F0Y2guICovCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeShpLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-04.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSAyZmVlZDczNzUzMDU5MjY4ODM4MmM2NTU2ODA5ODJlMTA5NTFjMWVj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxldCB1bnJl
YWQgd2F0Y2ggZXZlbnRzIHRpbWUgb3V0CgpBIGZ1dHVyZSBtb2RpZmljYXRp
b24gd2lsbCBsaW1pdCB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzCmZvciBhIGRvbWFpbiwgd2hlcmUgIm91dHN0YW5kaW5nIiBtZWFucyB0
aGF0IHRoZSByZXNwb25zZSBvZiB0aGUKcmVxdWVzdCBvciBhbnkgcmVzdWx0
aW5nIHdhdGNoIGV2ZW50IGhhc24ndCBiZWVuIGNvbnN1bWVkIHlldC4KCklu
IG9yZGVyIHRvIGF2b2lkIGEgbWFsaWNpb3VzIGd1ZXN0IGJlaW5nIGNhcGFi
bGUgdG8gYmxvY2sgb3RoZXIgZ3Vlc3RzCmJ5IG5vdCByZWFkaW5nIHdhdGNo
IGV2ZW50cywgYWRkIGEgdGltZW91dCBmb3Igd2F0Y2ggZXZlbnRzLiBJbiBj
YXNlIGEKd2F0Y2ggZXZlbnQgaGFzbid0IGJlZW4gY29uc3VtZWQgYWZ0ZXIg
dGhpcyB0aW1lb3V0LCBpdCBpcyBiZWluZwpkZWxldGVkLiBTZXQgdGhlIGRl
ZmF1bHQgdGltZW91dCB0byAyMCBzZWNvbmRzIChhIHJhbmRvbSB2YWx1ZSBi
ZWluZwpub3QgdG9vIGhpZ2gpLgoKSW4gb3JkZXIgdG8gc3VwcG9ydCB0byBz
cGVjaWZ5IG90aGVyIHRpbWVvdXQgdmFsdWVzIGluIGZ1dHVyZSwgdXNlIGEK
Z2VuZXJpYyBjb21tYW5kIGxpbmUgb3B0aW9uIGZvciB0aGF0IHB1cnBvc2U6
CgotLXRpbWVvdXR8LXcgd2F0Y2gtZXZlbnQ9PHNlY29uZHM+CgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzExLgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggYmYyMjQzODcz
OTAxLi40NTI0NGMwMjFjZDMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMTA4LDYgKzEwOCw4IEBAIGludCBxdW90YV9tYXhf
dHJhbnNhY3Rpb24gPSAxMDsKIGludCBxdW90YV9uYl9wZXJtc19wZXJfbm9k
ZSA9IDU7CiBpbnQgcXVvdGFfbWF4X3BhdGhfbGVuID0gWEVOU1RPUkVfUkVM
X1BBVEhfTUFYOwogCit1bnNpZ25lZCBpbnQgdGltZW91dF93YXRjaF9ldmVu
dF9tc2VjID0gMjAwMDA7CisKIHZvaWQgdHJhY2UoY29uc3QgY2hhciAqZm10
LCAuLi4pCiB7CiAJdmFfbGlzdCBhcmdsaXN0OwpAQCAtMjExLDE5ICsyMTMs
OTIgQEAgdm9pZCByZW9wZW5fbG9nKHZvaWQpCiAJfQogfQogCitzdGF0aWMg
dWludDY0X3QgZ2V0X25vd19tc2VjKHZvaWQpCit7CisJc3RydWN0IHRpbWVz
cGVjIG5vd190czsKKworCWlmIChjbG9ja19nZXR0aW1lKENMT0NLX01PTk9U
T05JQywgJm5vd190cykpCisJCWJhcmZfcGVycm9yKCJDb3VsZCBub3QgZmlu
ZCB0aW1lIChjbG9ja19nZXR0aW1lIGZhaWxlZCkiKTsKKworCXJldHVybiBu
b3dfdHMudHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAw
MDsKK30KKwogc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVj
dCBidWZmZXJlZF9kYXRhICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsK
KwogCWxpc3RfZGVsKCZvdXQtPmxpc3QpOworCisJLyoKKwkgKiBVcGRhdGUg
Y29ubi0+dGltZW91dF9tc2VjIHdpdGggdGhlIG5leHQgZm91bmQgdGltZW91
dCB2YWx1ZSBpbiB0aGUKKwkgKiBxdWV1ZWQgcGVuZGluZyByZXF1ZXN0cy4K
KwkgKi8KKwlpZiAob3V0LT50aW1lb3V0X21zZWMpIHsKKwkJY29ubi0+dGlt
ZW91dF9tc2VjID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShyZXEsICZj
b25uLT5vdXRfbGlzdCwgbGlzdCkgeworCQkJaWYgKHJlcS0+dGltZW91dF9t
c2VjKSB7CisJCQkJY29ubi0+dGltZW91dF9tc2VjID0gcmVxLT50aW1lb3V0
X21zZWM7CisJCQkJYnJlYWs7CisJCQl9CisJCX0KKwl9CisKIAl0YWxsb2Nf
ZnJlZShvdXQpOwogfQogCitzdGF0aWMgdm9pZCBjaGVja19ldmVudF90aW1l
b3V0KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCB1aW50NjRfdCBtc2VjcywK
KwkJCQlpbnQgKnB0aW1lb3V0KQoreworCXVpbnQ2NF90IGRlbHRhOworCXN0
cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsICp0bXA7CisKKwlpZiAoIWNvbm4t
PnRpbWVvdXRfbXNlYykKKwkJcmV0dXJuOworCisJZGVsdGEgPSBjb25uLT50
aW1lb3V0X21zZWMgLSBtc2VjczsKKwlpZiAoY29ubi0+dGltZW91dF9tc2Vj
IDw9IG1zZWNzKSB7CisJCWRlbHRhID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKG91dCwgdG1wLCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsK
KwkJCS8qCisJCQkgKiBPbmx5IGxvb2sgYXQgYnVmZmVycyB3aXRoIHRpbWVv
dXQgYW5kIG5vIGRhdGEKKwkJCSAqIGFscmVhZHkgd3JpdHRlbiB0byB0aGUg
cmluZy4KKwkJCSAqLworCQkJaWYgKG91dC0+dGltZW91dF9tc2VjICYmIG91
dC0+aW5oZHIgJiYgIW91dC0+dXNlZCkgeworCQkJCWlmIChvdXQtPnRpbWVv
dXRfbXNlYyA+IG1zZWNzKSB7CisJCQkJCWNvbm4tPnRpbWVvdXRfbXNlYyA9
IG91dC0+dGltZW91dF9tc2VjOworCQkJCQlkZWx0YSA9IGNvbm4tPnRpbWVv
dXRfbXNlYyAtIG1zZWNzOworCQkJCQlicmVhazsKKwkJCQl9CisKKwkJCQkv
KgorCQkJCSAqIEZyZWUgb3V0IHdpdGhvdXQgdXBkYXRpbmcgY29ubi0+dGlt
ZW91dF9tc2VjLAorCQkJCSAqIGFzIHRoZSB1cGRhdGUgaXMgZG9uZSBpbiB0
aGlzIGxvb3AgYWxyZWFkeS4KKwkJCQkgKi8KKwkJCQlvdXQtPnRpbWVvdXRf
bXNlYyA9IDA7CisJCQkJdHJhY2UoIndhdGNoIGV2ZW50IHBhdGggJXMgZm9y
IGRvbWFpbiAldSB0aW1lZCBvdXRcbiIsCisJCQkJICAgICAgb3V0LT5idWZm
ZXIsIGNvbm4tPmlkKTsKKwkJCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBj
b25uKTsKKwkJCX0KKwkJfQorCQlpZiAoIWRlbHRhKSB7CisJCQljb25uLT50
aW1lb3V0X21zZWMgPSAwOworCQkJcmV0dXJuOworCQl9CisJfQorCisJaWYg
KCpwdGltZW91dCA9PSAtMSB8fCAqcHRpbWVvdXQgPiBkZWx0YSkKKwkJKnB0
aW1lb3V0ID0gZGVsdGE7Cit9CisKIHZvaWQgY29ubl9mcmVlX2J1ZmZlcmVk
X2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7CiAJc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKm91dDsKIAogCXdoaWxlICgob3V0ID0gbGlzdF90b3Ao
JmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSwgbGlzdCkp
KQogCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsKKworCWNvbm4t
PnRpbWVvdXRfbXNlYyA9IDA7CiB9CiAKIHN0YXRpYyBib29sIHdyaXRlX21l
c3NhZ2VzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQpAQCAtNDExLDYgKzQ4
Niw3IEBAIHN0YXRpYyB2b2lkIGluaXRpYWxpemVfZmRzKGludCAqcF9zb2Nr
X3BvbGxmZF9pZHgsIGludCAqcHRpbWVvdXQpCiB7CiAJc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm47CiAJc3RydWN0IHdybF90aW1lc3RhbXB0IG5vdzsKKwl1
aW50NjRfdCBtc2VjczsKIAogCWlmIChmZHMpCiAJCW1lbXNldChmZHMsIDAs
IHNpemVvZihzdHJ1Y3QgcG9sbGZkKSAqIGN1cnJlbnRfYXJyYXlfc2l6ZSk7
CkBAIC00MzEsMTAgKzUwNywxMiBAQCBzdGF0aWMgdm9pZCBpbml0aWFsaXpl
X2ZkcyhpbnQgKnBfc29ja19wb2xsZmRfaWR4LCBpbnQgKnB0aW1lb3V0KQog
CiAJd3JsX2dldHRpbWVfbm93KCZub3cpOwogCXdybF9sb2dfcGVyaW9kaWMo
bm93KTsKKwltc2VjcyA9IGdldF9ub3dfbXNlYygpOwogCiAJbGlzdF9mb3Jf
ZWFjaF9lbnRyeShjb25uLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsKIAkJaWYg
KGNvbm4tPmRvbWFpbikgewogCQkJd3JsX2NoZWNrX3RpbWVvdXQoY29ubi0+
ZG9tYWluLCBub3csIHB0aW1lb3V0KTsKKwkJCWNoZWNrX2V2ZW50X3RpbWVv
dXQoY29ubiwgbXNlY3MsIHB0aW1lb3V0KTsKIAkJCWlmIChjb25uX2Nhbl9y
ZWFkKGNvbm4pIHx8CiAJCQkgICAgKGNvbm5fY2FuX3dyaXRlKGNvbm4pICYm
CiAJCQkgICAgICFsaXN0X2VtcHR5KCZjb25uLT5vdXRfbGlzdCkpKQpAQCAt
Nzk0LDYgKzg3Miw3IEBAIHZvaWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgZW51bSB4c2Rfc29ja21zZ190eXBlIHR5cGUsCiAJCXJl
dHVybjsKIAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0g
MDsKKwliZGF0YS0+dGltZW91dF9tc2VjID0gMDsKIAogCWlmIChsZW4gPD0g
REVGQVVMVF9CVUZGRVJfU0laRSkKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRh
LT5kZWZhdWx0X2J1ZmZlcjsKQEAgLTg0NSw2ICs5MjQsMTIgQEAgdm9pZCBz
ZW5kX2V2ZW50KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpwYXRoLCBjb25zdCBjaGFyICp0b2tlbikKIAliZGF0YS0+aGRyLm1zZy50
eXBlID0gWFNfV0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0g
bGVuOwogCisJaWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21h
aW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKSB7CisJCWJkYXRhLT50aW1lb3V0
X21zZWMgPSBnZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRf
bXNlYzsKKwkJaWYgKCFjb25uLT50aW1lb3V0X21zZWMpCisJCQljb25uLT50
aW1lb3V0X21zZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOworCX0KKwogCS8q
IFF1ZXVlIGZvciBsYXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRf
dGFpbCgmYmRhdGEtPmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CiB9CkBAIC0y
MjAxLDYgKzIyODYsOSBAQCBzdGF0aWMgdm9pZCB1c2FnZSh2b2lkKQogIiAg
LXQsIC0tdHJhbnNhY3Rpb24gPG5iPiAgbGltaXQgdGhlIG51bWJlciBvZiB0
cmFuc2FjdGlvbiBhbGxvd2VkIHBlciBkb21haW4sXG4iCiAiICAtQSwgLS1w
ZXJtLW5iIDxuYj4gICAgICBsaW1pdCB0aGUgbnVtYmVyIG9mIHBlcm1pc3Np
b25zIHBlciBub2RlLFxuIgogIiAgLU0sIC0tcGF0aC1tYXggPGNoYXJzPiAg
bGltaXQgdGhlIGFsbG93ZWQgWGVuc3RvcmUgbm9kZSBwYXRoIGxlbmd0aCxc
biIKKyIgIC13LCAtLXRpbWVvdXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0
aGUgdGltZW91dCBpbiBzZWNvbmRzIGZvciA8d2hhdD4sXG4iCisiICAgICAg
ICAgICAgICAgICAgICAgICAgICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRl
cyBhcmU6XG4iCisiICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaC1l
dmVudDogdGltZSBhIHdhdGNoLWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xuIgog
IiAgLVIsIC0tbm8tcmVjb3ZlcnkgICAgICAgdG8gcmVxdWVzdCB0aGF0IG5v
IHJlY292ZXJ5IHNob3VsZCBiZSBhdHRlbXB0ZWQgd2hlblxuIgogIiAgICAg
ICAgICAgICAgICAgICAgICAgICAgdGhlIHN0b3JlIGlzIGNvcnJ1cHRlZCAo
ZGVidWcgb25seSksXG4iCiAiICAtSSwgLS1pbnRlcm5hbC1kYiAgICAgICBz
dG9yZSBkYXRhYmFzZSBpbiBtZW1vcnksIG5vdCBvbiBkaXNrXG4iCkBAIC0y
MjIzLDYgKzIzMTEsNyBAQCBzdGF0aWMgc3RydWN0IG9wdGlvbiBvcHRpb25z
W10gPSB7CiAJeyAidHJhbnNhY3Rpb24iLCAxLCBOVUxMLCAndCcgfSwKIAl7
ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCiAJeyAicGF0aC1tYXgiLCAx
LCBOVUxMLCAnTScgfSwKKwl7ICJ0aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0s
CiAJeyAibm8tcmVjb3ZlcnkiLCAwLCBOVUxMLCAnUicgfSwKIAl7ICJpbnRl
cm5hbC1kYiIsIDAsIE5VTEwsICdJJyB9LAogCXsgInZlcmJvc2UiLCAwLCBO
VUxMLCAnVicgfSwKQEAgLTIyMzYsNiArMjMyNSwzOSBAQCBpbnQgZG9tMF9k
b21pZCA9IDA7CiBpbnQgZG9tMF9ldmVudCA9IDA7CiBpbnQgcHJpdl9kb21p
ZCA9IDA7CiAKK3N0YXRpYyBpbnQgZ2V0X29wdHZhbF9pbnQoY29uc3QgY2hh
ciAqYXJnKQoreworCWNoYXIgKmVuZDsKKwlsb25nIHZhbDsKKworCXZhbCA9
IHN0cnRvbChhcmcsICZlbmQsIDEwKTsKKwlpZiAoISphcmcgfHwgKmVuZCB8
fCB2YWwgPCAwIHx8IHZhbCA+IElOVF9NQVgpCisJCWJhcmYoImludmFsaWQg
cGFyYW1ldGVyIHZhbHVlIFwiJXNcIlxuIiwgYXJnKTsKKworCXJldHVybiB2
YWw7Cit9CisKK3N0YXRpYyBib29sIHdoYXRfbWF0Y2hlcyhjb25zdCBjaGFy
ICphcmcsIGNvbnN0IGNoYXIgKndoYXQpCit7CisJdW5zaWduZWQgaW50IHdo
YXRfbGVuID0gc3RybGVuKHdoYXQpOworCisJcmV0dXJuICFzdHJuY21wKGFy
Zywgd2hhdCwgd2hhdF9sZW4pICYmIGFyZ1t3aGF0X2xlbl0gPT0gJz0nOwor
fQorCitzdGF0aWMgdm9pZCBzZXRfdGltZW91dChjb25zdCBjaGFyICphcmcp
Cit7CisJY29uc3QgY2hhciAqZXEgPSBzdHJjaHIoYXJnLCAnPScpOworCWlu
dCB2YWw7CisKKwlpZiAoIWVxKQorCQliYXJmKCJxdW90YXMgbXVzdCBiZSBz
cGVjaWZpZWQgdmlhIDx3aGF0Pj08c2Vjb25kcz5cbiIpOworCXZhbCA9IGdl
dF9vcHR2YWxfaW50KGVxICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hlcyhhcmcs
ICJ3YXRjaC1ldmVudCIpKQorCQl0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMg
PSB2YWwgKiAxMDAwOworCWVsc2UKKwkJYmFyZigidW5rbm93biB0aW1lb3V0
IFwiJXNcIlxuIiwgYXJnKTsKK30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNo
YXIgKmFyZ3ZbXSkKIHsKIAlpbnQgb3B0OwpAQCAtMjI1MCw3ICsyMzcyLDcg
QEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlvcmlnX2Fy
Z2MgPSBhcmdjOwogCW9yaWdfYXJndiA9IGFyZ3Y7CiAKLQl3aGlsZSAoKG9w
dCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06
VDpSVlc6VSIsIG9wdGlvbnMsCisJd2hpbGUgKChvcHQgPSBnZXRvcHRfbG9u
ZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6QTpNOlQ6UlZXOnc6VSIsIG9w
dGlvbnMsCiAJCQkJICBOVUxMKSkgIT0gLTEpIHsKIAkJc3dpdGNoIChvcHQp
IHsKIAkJY2FzZSAnRCc6CkBAIC0yMzAwLDYgKzI0MjIsOSBAQCBpbnQgbWFp
bihpbnQgYXJnYywgY2hhciAqYXJndltdKQogCQkJcXVvdGFfbWF4X3BhdGhf
bGVuID0gbWluKFhFTlNUT1JFX1JFTF9QQVRIX01BWCwKIAkJCQkJCSBxdW90
YV9tYXhfcGF0aF9sZW4pOwogCQkJYnJlYWs7CisJCWNhc2UgJ3cnOgorCQkJ
c2V0X3RpbWVvdXQob3B0YXJnKTsKKwkJCWJyZWFrOwogCQljYXNlICdlJzoK
IAkJCWRvbTBfZXZlbnQgPSBzdHJ0b2wob3B0YXJnLCBOVUxMLCAxMCk7CiAJ
CQlicmVhazsKQEAgLTI3NDEsNiArMjg2NiwxMiBAQCBzdGF0aWMgdm9pZCBh
ZGRfYnVmZmVyZWRfZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGEs
CiAJCWJhcmYoImVycm9yIHJlc3RvcmluZyBidWZmZXJlZCBkYXRhIik7CiAK
IAltZW1jcHkoYmRhdGEtPmJ1ZmZlciwgZGF0YSwgbGVuKTsKKwlpZiAoYmRh
dGEtPmhkci5tc2cudHlwZSA9PSBYU19XQVRDSF9FVkVOVCAmJiB0aW1lb3V0
X3dhdGNoX2V2ZW50X21zZWMgJiYKKwkgICAgZG9tYWluX2lzX3VucHJpdmls
ZWdlZChjb25uKSkgeworCQliZGF0YS0+dGltZW91dF9tc2VjID0gZ2V0X25v
d19tc2VjKCkgKyB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7CisJCWlmICgh
Y29ubi0+dGltZW91dF9tc2VjKQorCQkJY29ubi0+dGltZW91dF9tc2VjID0g
YmRhdGEtPnRpbWVvdXRfbXNlYzsKKwl9CiAKIAkvKiBRdWV1ZSBmb3IgbGF0
ZXIgdHJhbnNtaXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5s
aXN0LCAmY29ubi0+b3V0X2xpc3QpOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKaW5kZXggZTdlZTg3ODI1YzNiLi44YTgxZmM2OTNmMDEg
MTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgK
KysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjcs
NiArMjcsNyBAQAogI2luY2x1ZGUgPGZjbnRsLmg+CiAjaW5jbHVkZSA8c3Rk
Ym9vbC5oPgogI2luY2x1ZGUgPHN0ZGludC5oPgorI2luY2x1ZGUgPHRpbWUu
aD4KICNpbmNsdWRlIDxlcnJuby5oPgogCiAjaW5jbHVkZSAieGVuc3RvcmVf
bGliLmgiCkBAIC02Nyw2ICs2OCw4IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJCWNoYXIgcmF3W3NpemVvZihzdHJ1Y3QgeHNkX3NvY2ttc2cpXTsKIAl9
IGhkcjsKIAorCXVpbnQ2NF90IHRpbWVvdXRfbXNlYzsKKwogCS8qIFRoZSBh
Y3R1YWwgZGF0YS4gKi8KIAljaGFyICpidWZmZXI7CiAJY2hhciBkZWZhdWx0
X2J1ZmZlcltERUZBVUxUX0JVRkZFUl9TSVpFXTsKQEAgLTExOCw2ICsxMjEs
NyBAQCBzdHJ1Y3QgY29ubmVjdGlvbgogCiAJLyogQnVmZmVyZWQgb3V0cHV0
IGRhdGEgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIG91dF9saXN0OworCXVpbnQ2
NF90IHRpbWVvdXRfbXNlYzsKIAogCS8qIFRyYW5zYWN0aW9uIGNvbnRleHQg
Zm9yIGN1cnJlbnQgcmVxdWVzdCAoTlVMTCBpZiBub25lKS4gKi8KIAlzdHJ1
Y3QgdHJhbnNhY3Rpb24gKnRyYW5zYWN0aW9uOwpAQCAtMjQ0LDYgKzI0OCw4
IEBAIGV4dGVybiBpbnQgZG9tMF9ldmVudDsKIGV4dGVybiBpbnQgcHJpdl9k
b21pZDsKIGV4dGVybiBpbnQgcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbjsK
IAorZXh0ZXJuIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNoX2V2ZW50X21z
ZWM7CisKIC8qIE1hcCB0aGUga2VybmVsJ3MgeGVuc3RvcmUgcGFnZS4gKi8K
IHZvaWQgKnhlbmJ1c19tYXAodm9pZCk7CiB2b2lkIHVubWFwX3hlbmJ1cyh2
b2lkICppbnRlcmZhY2UpOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-05.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSAyZWVlMTIyYTQ1ZWI0YTIxODU5NmIxMDNjZTdmMDc1OWE4MjRjZjJl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG91
dHN0YW5kaW5nIHJlcXVlc3RzCgpBZGQgYW5vdGhlciBxdW90YSBmb3IgbGlt
aXRpbmcgdGhlIG51bWJlciBvZiBvdXRzdGFuZGluZyByZXF1ZXN0cyBvZiBh
Cmd1ZXN0LiBBcyB0aGUgd2F5IHRvIHNwZWNpZnkgcXVvdGFzIG9uIHRoZSBj
b21tYW5kIGxpbmUgaXMgYmVjb21pbmcKcmF0aGVyIG5hc3R5LCBzd2l0Y2gg
dG8gYSBuZXcgc2NoZW1lIHVzaW5nIFstLXF1b3RhfC1RXSA8d2hhdD49PHZh
bD4KYWxsb3dpbmcgdG8gYWRkIG1vcmUgcXVvdGFzIGluIGZ1dHVyZSBlYXNp
bHkuCgpTZXQgdGhlIGRlZmF1bHQgdmFsdWUgdG8gMjAgKGJhc2ljYWxseSBh
IHJhbmRvbSB2YWx1ZSBub3Qgc2VlbWluZyB0bwpiZSB0b28gaGlnaCBvciB0
b28gbG93KS4KCkEgcmVxdWVzdCBpcyBzYWlkIHRvIGJlIG91dHN0YW5kaW5n
IGlmIGFueSBtZXNzYWdlIGdlbmVyYXRlZCBieSB0aGlzCnJlcXVlc3QgKHRo
ZSBkaXJlY3QgcmVzcG9uc2UgcGx1cyBwb3RlbnRpYWwgd2F0Y2ggZXZlbnRz
KSBpcyBub3QgeWV0CmNvbXBsZXRlbHkgc3RvcmVkIGludG8gYSByaW5nIGJ1
ZmZlci4gVGhlIGluaXRpYWwgd2F0Y2ggZXZlbnQgc2VudCBhcwphIHJlc3Vs
dCBvZiByZWdpc3RlcmluZyBhIHdhdGNoIGlzIGFuIGV4Y2VwdGlvbi4KCk5v
dGUgdGhhdCBhY3Jvc3MgYSBsaXZlIHVwZGF0ZSB0aGUgcmVsYXRpb24gdG8g
YnVmZmVyZWQgd2F0Y2ggZXZlbnRzCmZvciBvdGhlciBkb21haW5zIGlzIGxv
c3QuCgpVc2UgdGFsbG9jX3plcm8oKSBmb3IgYWxsb2NhdGluZyB0aGUgZG9t
YWluIHN0cnVjdHVyZSBpbiBvcmRlciB0byBoYXZlCmFsbCBwZXItZG9tYWlu
IHF1b3RhIHplcm9lZCBpbml0aWFsbHkuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTMyNiAvIENWRS0yMDIyLTQyMzEyLgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggNDUyNDRjMDIxY2QzLi40ODhkNTQwZjNh
MzIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MTA3LDYgKzEwNyw3IEBAIGludCBxdW90YV9tYXhfZW50cnlfc2l6ZSA9IDIw
NDg7IC8qIDJLICovCiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uID0gMTA7
CiBpbnQgcXVvdGFfbmJfcGVybXNfcGVyX25vZGUgPSA1OwogaW50IHF1b3Rh
X21heF9wYXRoX2xlbiA9IFhFTlNUT1JFX1JFTF9QQVRIX01BWDsKK2ludCBx
dW90YV9yZXFfb3V0c3RhbmRpbmcgPSAyMDsKIAogdW5zaWduZWQgaW50IHRp
bWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIwMDAwOwogCkBAIC0yMjMsMTIg
KzIyNCwyNCBAQCBzdGF0aWMgdWludDY0X3QgZ2V0X25vd19tc2VjKHZvaWQp
CiAJcmV0dXJuIG5vd190cy50dl9zZWMgKiAxMDAwICsgbm93X3RzLnR2X25z
ZWMgLyAxMDAwMDAwOwogfQogCisvKgorICogUmVtb3ZlIGEgc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgZnJvbSB0aGUgbGlzdCBvZiBvdXRnb2luZyBkYXRhLgor
ICogQSBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSByZWxhdGVkIHRvIGEgcmVxdWVz
dCBoYXZpbmcgY2F1c2VkIHdhdGNoIGV2ZW50cyB0byBiZQorICogc2VudCBp
cyBrZXB0IHVudGlsIGFsbCB0aG9zZSBldmVudHMgaGF2ZSBiZWVuIHdyaXR0
ZW4gb3V0LgorICogRWFjaCB3YXRjaCBldmVudCBpcyByZWZlcmVuY2luZyB0
aGUgcmVsYXRlZCByZXF1ZXN0IHZpYSBwZW5kLnJlcSwgd2hpbGUgdGhlCisg
KiBudW1iZXIgb2Ygd2F0Y2ggZXZlbnRzIGNhdXNlZCBieSBhIHJlcXVlc3Qg
aXMga2VwdCBpbiBwZW5kLnJlZi5ldmVudF9jbnQKKyAqICh0aG9zZSB0d28g
Y2FzZXMgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZSwgc28gdGhlIHR3byBmaWVs
ZHMgY2FuIHNoYXJlIG1lbW9yeQorICogdmlhIGEgdW5pb24pLgorICogVGhl
IHN0cnVjdCBidWZmZXJlZF9kYXRhIGlzIGZyZWVkIG9ubHkgaWYgbm8gcmVs
YXRlZCB3YXRjaCBldmVudCBpcworICogcmVmZXJlbmNpbmcgaXQuIFRoZSBy
ZWxhdGVkIHJldHVybiBkYXRhIGNhbiBiZSBmcmVlZCByaWdodCBhd2F5Lgor
ICovCiBzdGF0aWMgdm9pZCBmcmVlX2J1ZmZlcmVkX2RhdGEoc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKm91dCwKIAkJCSAgICAgICBzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIHsKIAlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCiAJ
bGlzdF9kZWwoJm91dC0+bGlzdCk7CisJb3V0LT5vbl9vdXRfbGlzdCA9IGZh
bHNlOwogCiAJLyoKIAkgKiBVcGRhdGUgY29ubi0+dGltZW91dF9tc2VjIHdp
dGggdGhlIG5leHQgZm91bmQgdGltZW91dCB2YWx1ZSBpbiB0aGUKQEAgLTI0
NCw2ICsyNTcsMzAgQEAgc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRh
KHN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsCiAJCX0KIAl9CiAKKwlpZiAo
b3V0LT5oZHIubXNnLnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKKwkJcmVx
ID0gb3V0LT5wZW5kLnJlcTsKKwkJaWYgKHJlcSkgeworCQkJcmVxLT5wZW5k
LnJlZi5ldmVudF9jbnQtLTsKKwkJCWlmICghcmVxLT5wZW5kLnJlZi5ldmVu
dF9jbnQgJiYgIXJlcS0+b25fb3V0X2xpc3QpIHsKKwkJCQlpZiAocmVxLT5v
bl9yZWZfbGlzdCkgeworCQkJCQlkb21haW5fb3V0c3RhbmRpbmdfZG9taWRf
ZGVjKAorCQkJCQkJcmVxLT5wZW5kLnJlZi5kb21pZCk7CisJCQkJCWxpc3Rf
ZGVsKCZyZXEtPmxpc3QpOworCQkJCX0KKwkJCQl0YWxsb2NfZnJlZShyZXEp
OworCQkJfQorCQl9CisJfSBlbHNlIGlmIChvdXQtPnBlbmQucmVmLmV2ZW50
X2NudCkgeworCQkvKiBIYW5nIG91dCBvZmYgZnJvbSBjb25uLiAqLworCQl0
YWxsb2Nfc3RlYWwoTlVMTCwgb3V0KTsKKwkJaWYgKG91dC0+YnVmZmVyICE9
IG91dC0+ZGVmYXVsdF9idWZmZXIpCisJCQl0YWxsb2NfZnJlZShvdXQtPmJ1
ZmZlcik7CisJCWxpc3RfYWRkKCZvdXQtPmxpc3QsICZjb25uLT5yZWZfbGlz
dCk7CisJCW91dC0+b25fcmVmX2xpc3QgPSB0cnVlOworCQlyZXR1cm47CisJ
fSBlbHNlCisJCWRvbWFpbl9vdXRzdGFuZGluZ19kZWMoY29ubik7CisKIAl0
YWxsb2NfZnJlZShvdXQpOwogfQogCkBAIC00MDUsNiArNDQyLDcgQEAgaW50
IGRlbGF5X3JlcXVlc3Qoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVj
dCBidWZmZXJlZF9kYXRhICppbiwKIHN0YXRpYyBpbnQgZGVzdHJveV9jb25u
KHZvaWQgKl9jb25uKQogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25uID0g
X2Nvbm47CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKIAogCS8qIEZs
dXNoIG91dGdvaW5nIGlmIHBvc3NpYmxlLCBidXQgZG9uJ3QgYmxvY2suICov
CiAJaWYgKCFjb25uLT5kb21haW4pIHsKQEAgLTQxOCw2ICs0NTYsMTEgQEAg
c3RhdGljIGludCBkZXN0cm95X2Nvbm4odm9pZCAqX2Nvbm4pCiAJCQkJYnJl
YWs7CiAJCWNsb3NlKGNvbm4tPmZkKTsKIAl9CisKKwljb25uX2ZyZWVfYnVm
ZmVyZWRfZGF0YShjb25uKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHJlcSwg
JmNvbm4tPnJlZl9saXN0LCBsaXN0KQorCQlyZXEtPm9uX3JlZl9saXN0ID0g
ZmFsc2U7CisKICAgICAgICAgaWYgKGNvbm4tPnRhcmdldCkKICAgICAgICAg
ICAgICAgICB0YWxsb2NfdW5saW5rKGNvbm4sIGNvbm4tPnRhcmdldCk7CiAJ
bGlzdF9kZWwoJmNvbm4tPmxpc3QpOwpAQCAtODkzLDYgKzkzNiw4IEBAIHZv
aWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4
c2Rfc29ja21zZ190eXBlIHR5cGUsCiAKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIg
dHJhbnNtaXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0
LCAmY29ubi0+b3V0X2xpc3QpOworCWJkYXRhLT5vbl9vdXRfbGlzdCA9IHRy
dWU7CisJZG9tYWluX291dHN0YW5kaW5nX2luYyhjb25uKTsKIH0KIAogLyoK
QEAgLTkwMCw3ICs5NDUsOCBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAog
ICogQXMgdGhpcyBpcyBub3QgZGlyZWN0bHkgcmVsYXRlZCB0byB0aGUgY3Vy
cmVudCBjb21tYW5kLCBlcnJvcnMgY2FuJ3QgYmUKICAqIHJlcG9ydGVkLgog
ICovCi12b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKQordm9pZCBz
ZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLAorCQljb25zdCBjaGFyICpwYXRoLCBjb25zdCBj
aGFyICp0b2tlbikKIHsKIAlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7
CiAJdW5zaWduZWQgaW50IGxlbjsKQEAgLTkzMCw4ICs5NzYsMTMgQEAgdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBj
aGFyICpwYXRoLCBjb25zdCBjaGFyICp0b2tlbikKIAkJCWNvbm4tPnRpbWVv
dXRfbXNlYyA9IGJkYXRhLT50aW1lb3V0X21zZWM7CiAJfQogCisJYmRhdGEt
PnBlbmQucmVxID0gcmVxOworCWlmIChyZXEpCisJCXJlcS0+cGVuZC5yZWYu
ZXZlbnRfY250Kys7CisKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNz
aW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+
b3V0X2xpc3QpOworCWJkYXRhLT5vbl9vdXRfbGlzdCA9IHRydWU7CiB9CiAK
IC8qIFNvbWUgcm91dGluZXMgKHdyaXRlLCBta2RpciwgZXRjKSBqdXN0IG5l
ZWQgYSBub24tZXJyb3IgcmV0dXJuICovCkBAIC0xNzQwLDYgKzE3OTEsNyBA
QCBzdGF0aWMgdm9pZCBoYW5kbGVfaW5wdXQoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pCiAJCQlyZXR1cm47CiAJfQogCWluID0gY29ubi0+aW47CisJaW4t
PnBlbmQucmVmLmRvbWlkID0gY29ubi0+aWQ7CiAKIAkvKiBOb3QgZmluaXNo
ZWQgaGVhZGVyIHlldD8gKi8KIAlpZiAoaW4tPmluaGRyKSB7CkBAIC0xODA4
LDYgKzE4NjAsNyBAQCBzdHJ1Y3QgY29ubmVjdGlvbiAqbmV3X2Nvbm5lY3Rp
b24oY29uc3Qgc3RydWN0IGludGVyZmFjZV9mdW5jcyAqZnVuY3MpCiAJbmV3
LT5pc19zdGFsbGVkID0gZmFsc2U7CiAJbmV3LT50cmFuc2FjdGlvbl9zdGFy
dGVkID0gMDsKIAlJTklUX0xJU1RfSEVBRCgmbmV3LT5vdXRfbGlzdCk7CisJ
SU5JVF9MSVNUX0hFQUQoJm5ldy0+cmVmX2xpc3QpOwogCUlOSVRfTElTVF9I
RUFEKCZuZXctPndhdGNoZXMpOwogCUlOSVRfTElTVF9IRUFEKCZuZXctPnRy
YW5zYWN0aW9uX2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZuZXctPmRlbGF5
ZWQpOwpAQCAtMjI4Niw2ICsyMzM5LDkgQEAgc3RhdGljIHZvaWQgdXNhZ2Uo
dm9pZCkKICIgIC10LCAtLXRyYW5zYWN0aW9uIDxuYj4gIGxpbWl0IHRoZSBu
dW1iZXIgb2YgdHJhbnNhY3Rpb24gYWxsb3dlZCBwZXIgZG9tYWluLFxuIgog
IiAgLUEsIC0tcGVybS1uYiA8bmI+ICAgICAgbGltaXQgdGhlIG51bWJlciBv
ZiBwZXJtaXNzaW9ucyBwZXIgbm9kZSxcbiIKICIgIC1NLCAtLXBhdGgtbWF4
IDxjaGFycz4gIGxpbWl0IHRoZSBhbGxvd2VkIFhlbnN0b3JlIG5vZGUgcGF0
aCBsZW5ndGgsXG4iCisiICAtUSwgLS1xdW90YSA8d2hhdD49PG5iPiBzZXQg
dGhlIHF1b3RhIDx3aGF0PiB0byB0aGUgdmFsdWUgPG5iPiwgYWxsb3dlZFxu
IgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGFzIGFyZTpcbiIK
KyIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nOiBudW1i
ZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKICIgIC13LCAtLXRpbWVv
dXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGltZW91dCBpbiBzZWNv
bmRzIGZvciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAg
ICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6XG4iCiAiICAgICAg
ICAgICAgICAgICAgICAgICAgICB3YXRjaC1ldmVudDogdGltZSBhIHdhdGNo
LWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xuIgpAQCAtMjMxMSw2ICsyMzY3LDcg
QEAgc3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRy
YW5zYWN0aW9uIiwgMSwgTlVMTCwgJ3QnIH0sCiAJeyAicGVybS1uYiIsIDEs
IE5VTEwsICdBJyB9LAogCXsgInBhdGgtbWF4IiwgMSwgTlVMTCwgJ00nIH0s
CisJeyAicXVvdGEiLCAxLCBOVUxMLCAnUScgfSwKIAl7ICJ0aW1lb3V0Iiwg
MSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAwLCBOVUxMLCAn
UicgfSwKIAl7ICJpbnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJJyB9LApAQCAt
MjM1OCw2ICsyNDE1LDIwIEBAIHN0YXRpYyB2b2lkIHNldF90aW1lb3V0KGNv
bnN0IGNoYXIgKmFyZykKIAkJYmFyZigidW5rbm93biB0aW1lb3V0IFwiJXNc
IlxuIiwgYXJnKTsKIH0KIAorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNvbnN0
IGNoYXIgKmFyZykKK3sKKwljb25zdCBjaGFyICplcSA9IHN0cmNocihhcmcs
ICc9Jyk7CisJaW50IHZhbDsKKworCWlmICghZXEpCisJCWJhcmYoInF1b3Rh
cyBtdXN0IGJlIHNwZWNpZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOworCXZh
bCA9IGdldF9vcHR2YWxfaW50KGVxICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hl
cyhhcmcsICJvdXRzdGFuZGluZyIpKQorCQlxdW90YV9yZXFfb3V0c3RhbmRp
bmcgPSB2YWw7CisJZWxzZQorCQliYXJmKCJ1bmtub3duIHF1b3RhIFwiJXNc
IlxuIiwgYXJnKTsKK30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFy
Z3ZbXSkKIHsKIAlpbnQgb3B0OwpAQCAtMjM3Miw4ICsyNDQzLDggQEAgaW50
IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlvcmlnX2FyZ2MgPSBh
cmdjOwogCW9yaWdfYXJndiA9IGFyZ3Y7CiAKLQl3aGlsZSAoKG9wdCA9IGdl
dG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06VDpSVlc6
dzpVIiwgb3B0aW9ucywKLQkJCQkgIE5VTEwpKSAhPSAtMSkgeworCXdoaWxl
ICgob3B0ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0
OkE6TTpROlQ6UlZXOnc6VSIsCisJCQkJICBvcHRpb25zLCBOVUxMKSkgIT0g
LTEpIHsKIAkJc3dpdGNoIChvcHQpIHsKIAkJY2FzZSAnRCc6CiAJCQlub19k
b21haW5faW5pdCA9IHRydWU7CkBAIC0yNDIyLDYgKzI0OTMsOSBAQCBpbnQg
bWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogCQkJcXVvdGFfbWF4X3Bh
dGhfbGVuID0gbWluKFhFTlNUT1JFX1JFTF9QQVRIX01BWCwKIAkJCQkJCSBx
dW90YV9tYXhfcGF0aF9sZW4pOwogCQkJYnJlYWs7CisJCWNhc2UgJ1EnOgor
CQkJc2V0X3F1b3RhKG9wdGFyZyk7CisJCQlicmVhazsKIAkJY2FzZSAndyc6
CiAJCQlzZXRfdGltZW91dChvcHRhcmcpOwogCQkJYnJlYWs7CkBAIC0yODc1
LDYgKzI5NDksMTQgQEAgc3RhdGljIHZvaWQgYWRkX2J1ZmZlcmVkX2RhdGEo
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLAogCiAJLyogUXVldWUgZm9y
IGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAlsaXN0X2FkZF90YWlsKCZiZGF0
YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsKKwliZGF0YS0+b25fb3V0X2xp
c3QgPSB0cnVlOworCS8qCisJICogV2F0Y2ggZXZlbnRzIGFyZSBuZXZlciAi
b3V0c3RhbmRpbmciLCBidXQgdGhlIHJlcXVlc3QgY2F1c2luZyB0aGVtCisJ
ICogYXJlIGluc3RlYWQga2VwdCAib3V0c3RhbmRpbmciIHVudGlsIGFsbCB3
YXRjaCBldmVudHMgY2F1c2VkIGJ5IHRoYXQKKwkgKiByZXF1ZXN0IGhhdmUg
YmVlbiBkZWxpdmVyZWQuCisJICovCisJaWYgKGJkYXRhLT5oZHIubXNnLnR5
cGUgIT0gWFNfV0FUQ0hfRVZFTlQpCisJCWRvbWFpbl9vdXRzdGFuZGluZ19p
bmMoY29ubik7CiB9CiAKIHZvaWQgcmVhZF9zdGF0ZV9idWZmZXJlZF9kYXRh
KGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCmRp
ZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCA4YTgxZmM2
OTNmMDEuLmRiMDlmNDYzYTY1NyAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfY29yZS5oCkBAIC01Niw2ICs1Niw4IEBAIHN0cnVjdCB4c19zdGF0
ZV9jb25uZWN0aW9uOwogc3RydWN0IGJ1ZmZlcmVkX2RhdGEKIHsKIAlzdHJ1
Y3QgbGlzdF9oZWFkIGxpc3Q7CisJYm9vbCBvbl9vdXRfbGlzdDsKKwlib29s
IG9uX3JlZl9saXN0OwogCiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBo
ZWFkZXI/ICovCiAJYm9vbCBpbmhkcjsKQEAgLTYzLDYgKzY1LDE3IEBAIHN0
cnVjdCBidWZmZXJlZF9kYXRhCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAKKwkvKiBPdXRzdGFuZGluZyByZXF1ZXN0
IGFjY291bnRpbmcuICovCisJdW5pb24geworCQkvKiByZWYgaXMgYmVpbmcg
dXNlZCBmb3IgcmVxdWVzdHMuICovCisJCXN0cnVjdCB7CisJCQl1bnNpZ25l
ZCBpbnQgZXZlbnRfY250OyAvKiAjIG9mIG91dHN0YW5kaW5nIGV2ZW50cy4g
Ki8KKwkJCXVuc2lnbmVkIGludCBkb21pZDsgICAgIC8qIGRvbWlkIG9mIHJl
cXVlc3QuICovCisJCX0gcmVmOworCQkvKiByZXEgaXMgYmVpbmcgdXNlZCBm
b3Igd2F0Y2ggZXZlbnRzLiAqLworCQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAq
cmVxOyAgICAgIC8qIHJlcXVlc3QgY2F1c2luZyBldmVudC4gKi8KKwl9IHBl
bmQ7CisKIAl1bmlvbiB7CiAJCXN0cnVjdCB4c2Rfc29ja21zZyBtc2c7CiAJ
CWNoYXIgcmF3W3NpemVvZihzdHJ1Y3QgeHNkX3NvY2ttc2cpXTsKQEAgLTEy
Myw2ICsxMzYsOSBAQCBzdHJ1Y3QgY29ubmVjdGlvbgogCXN0cnVjdCBsaXN0
X2hlYWQgb3V0X2xpc3Q7CiAJdWludDY0X3QgdGltZW91dF9tc2VjOwogCisJ
LyogUmVmZXJlbmNlZCByZXF1ZXN0cyBubyBsb25nZXIgcGVuZGluZy4gKi8K
KwlzdHJ1Y3QgbGlzdF9oZWFkIHJlZl9saXN0OworCiAJLyogVHJhbnNhY3Rp
b24gY29udGV4dCBmb3IgY3VycmVudCByZXF1ZXN0IChOVUxMIGlmIG5vbmUp
LiAqLwogCXN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnNhY3Rpb247CiAKQEAg
LTE5MSw3ICsyMDcsOCBAQCB1bnNpZ25lZCBpbnQgZ2V0X3N0cmluZyhjb25z
dCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqZGF0YSwgdW5zaWduZWQgaW50IG9m
ZnNldCk7CiAKIHZvaWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgZW51bSB4c2Rfc29ja21zZ190eXBlIHR5cGUsCiAJCWNvbnN0IHZv
aWQgKmRhdGEsIHVuc2lnbmVkIGludCBsZW4pOwotdm9pZCBzZW5kX2V2ZW50
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpwYXRoLCBj
b25zdCBjaGFyICp0b2tlbik7Cit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKnJlcSwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJ
CWNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKIAogLyog
U29tZSByb3V0aW5lcyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3QgbmVlZCBh
IG5vbi1lcnJvciByZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlKTsK
QEAgLTI0Nyw2ICsyNjQsNyBAQCBleHRlcm4gaW50IGRvbTBfZG9taWQ7CiBl
eHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBleHRlcm4gaW50IHByaXZfZG9taWQ7
CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5X3Blcl9kb21haW47CitleHRl
cm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGluZzsKIAogZXh0ZXJuIHVuc2ln
bmVkIGludCB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7CiAKZGlmZiAtLWdp
dCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYyBiL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwppbmRleCA5M2M0YzFlZGNk
ZDEuLjg1MDA4NWE5MmM3NiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uYwpAQCAtNzgsNiArNzgsOSBAQCBzdHJ1Y3QgZG9tYWlu
CiAJLyogbnVtYmVyIG9mIHdhdGNoIGZvciB0aGlzIGRvbWFpbiAqLwogCWlu
dCBuYndhdGNoOwogCisJLyogTnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzLiAqLworCWludCBuYm91dHN0YW5kaW5nOworCiAJLyogd3JpdGUgcmF0
ZSBsaW1pdCAqLwogCXdybF9jcmVkaXR0IHdybF9jcmVkaXQ7IC8qIFsgLXdy
bF9jb25maWdfd3JpdGVjb3N0LCArX2RidXJzdCBdICovCiAJc3RydWN0IHdy
bF90aW1lc3RhbXB0IHdybF90aW1lc3RhbXA7CkBAIC0xODMsOCArMTg2LDEy
IEBAIHN0YXRpYyBib29sIGRvbWFpbl9jYW5fcmVhZChzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIHsKIAlzdHJ1Y3QgeGVuc3RvcmVfZG9tYWluX2ludGVy
ZmFjZSAqaW50ZiA9IGNvbm4tPmRvbWFpbi0+aW50ZXJmYWNlOwogCi0JaWYg
KGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYgY29ubi0+ZG9tYWlu
LT53cmxfY3JlZGl0IDwgMCkKLQkJcmV0dXJuIGZhbHNlOworCWlmIChkb21h
aW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKSB7CisJCWlmIChjb25uLT5kb21h
aW4tPndybF9jcmVkaXQgPCAwKQorCQkJcmV0dXJuIGZhbHNlOworCQlpZiAo
Y29ubi0+ZG9tYWluLT5uYm91dHN0YW5kaW5nID49IHF1b3RhX3JlcV9vdXRz
dGFuZGluZykKKwkJCXJldHVybiBmYWxzZTsKKwl9CiAKIAlyZXR1cm4gKGlu
dGYtPnJlcV9jb25zICE9IGludGYtPnJlcV9wcm9kKTsKIH0KQEAgLTMzMSw3
ICszMzgsNyBAQCBzdGF0aWMgc3RydWN0IGRvbWFpbiAqYWxsb2NfZG9tYWlu
KGNvbnN0IHZvaWQgKmNvbnRleHQsIHVuc2lnbmVkIGludCBkb21pZCkKIHsK
IAlzdHJ1Y3QgZG9tYWluICpkb21haW47CiAKLQlkb21haW4gPSB0YWxsb2Mo
Y29udGV4dCwgc3RydWN0IGRvbWFpbik7CisJZG9tYWluID0gdGFsbG9jX3pl
cm8oY29udGV4dCwgc3RydWN0IGRvbWFpbik7CiAJaWYgKCFkb21haW4pIHsK
IAkJZXJybm8gPSBFTk9NRU07CiAJCXJldHVybiBOVUxMOwpAQCAtMzkyLDkg
KzM5OSw2IEBAIHN0YXRpYyBpbnQgbmV3X2RvbWFpbihzdHJ1Y3QgZG9tYWlu
ICpkb21haW4sIGludCBwb3J0LCBib29sIHJlc3RvcmUpCiAJZG9tYWluLT5j
b25uLT5kb21haW4gPSBkb21haW47CiAJZG9tYWluLT5jb25uLT5pZCA9IGRv
bWFpbi0+ZG9taWQ7CiAKLQlkb21haW4tPm5iZW50cnkgPSAwOwotCWRvbWFp
bi0+bmJ3YXRjaCA9IDA7Ci0KIAlyZXR1cm4gMDsKIH0KIApAQCAtOTM4LDYg
Kzk0MiwyOCBAQCBpbnQgZG9tYWluX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uKQogCQk6IDA7CiB9CiAKK3ZvaWQgZG9tYWluX291dHN0YW5kaW5n
X2luYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKK3sKKwlpZiAoIWNvbm4g
fHwgIWNvbm4tPmRvbWFpbikKKwkJcmV0dXJuOworCWNvbm4tPmRvbWFpbi0+
bmJvdXRzdGFuZGluZysrOworfQorCit2b2lkIGRvbWFpbl9vdXRzdGFuZGlu
Z19kZWMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJaWYgKCFjb25u
IHx8ICFjb25uLT5kb21haW4pCisJCXJldHVybjsKKwljb25uLT5kb21haW4t
Pm5ib3V0c3RhbmRpbmctLTsKK30KKwordm9pZCBkb21haW5fb3V0c3RhbmRp
bmdfZG9taWRfZGVjKHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1Y3Qg
ZG9tYWluICpkID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9taWQpOworCisJ
aWYgKGQpCisJCWQtPm5ib3V0c3RhbmRpbmctLTsKK30KKwogc3RhdGljIHdy
bF9jcmVkaXR0IHdybF9jb25maWdfd3JpdGVjb3N0ICAgICAgPSBXUkxfRkFD
VE9SOwogc3RhdGljIHdybF9jcmVkaXR0IHdybF9jb25maWdfcmF0ZSAgICAg
ICAgICAgPSBXUkxfUkFURSAgICogV1JMX0ZBQ1RPUjsKIHN0YXRpYyB3cmxf
Y3JlZGl0dCB3cmxfY29uZmlnX2RidXJzdCAgICAgICAgID0gV1JMX0RCVVJT
VCAqIFdSTF9GQUNUT1I7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmgKaW5kZXggMWU5MjliOGY4YzZmLi40ZjUxYjAwNTI5MWEgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAor
KysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY0
LDYgKzY0LDkgQEAgaW50IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubik7CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4pOwordm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5j
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKK3ZvaWQgZG9tYWluX291dHN0
YW5kaW5nX2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7Cit2b2lkIGRv
bWFpbl9vdXRzdGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlk
KTsKIAogLyogU3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICov
CiBpbnQgc2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIGNvbnN0IGNoYXIgKm5hbWUsCmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF93YXRjaC5jCmluZGV4IDIwNWQ5ZDhlYTExNi4uMDc1NWZmYTM3NWJh
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2gu
YworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAt
MTQyLDYgKzE0Miw3IEBAIHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5h
bWUsCiAJCSAgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wgZXhhY3QsIHN0cnVj
dCBub2RlX3Blcm1zICpwZXJtcykKIHsKIAlzdHJ1Y3QgY29ubmVjdGlvbiAq
aTsKKwlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCXN0cnVjdCB3YXRj
aCAqd2F0Y2g7CiAKIAkvKiBEdXJpbmcgdHJhbnNhY3Rpb25zLCBkb24ndCBm
aXJlIHdhdGNoZXMsIGJ1dCBxdWV1ZSB0aGVtLiAqLwpAQCAtMTUwLDYgKzE1
MSw4IEBAIHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCXJl
dHVybjsKIAl9CiAKKwlyZXEgPSBkb21haW5faXNfdW5wcml2aWxlZ2VkKGNv
bm4pID8gY29ubi0+aW4gOiBOVUxMOworCiAJLyogQ3JlYXRlIGFuIGV2ZW50
IGZvciBlYWNoIHdhdGNoLiAqLwogCWxpc3RfZm9yX2VhY2hfZW50cnkoaSwg
JmNvbm5lY3Rpb25zLCBsaXN0KSB7CiAJCS8qIGludHJvZHVjZS9yZWxlYXNl
IGRvbWFpbiB3YXRjaGVzICovCkBAIC0xNjQsMTIgKzE2NywxMiBAQCB2b2lk
IGZpcmVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
dm9pZCAqY3R4LCBjb25zdCBjaGFyICpuYW1lLAogCQlsaXN0X2Zvcl9lYWNo
X2VudHJ5KHdhdGNoLCAmaS0+d2F0Y2hlcywgbGlzdCkgewogCQkJaWYgKGV4
YWN0KSB7CiAJCQkJaWYgKHN0cmVxKG5hbWUsIHdhdGNoLT5ub2RlKSkKLQkJ
CQkJc2VuZF9ldmVudChpLAorCQkJCQlzZW5kX2V2ZW50KHJlcSwgaSwKIAkJ
CQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKIAkJCQkJCSAg
IHdhdGNoLT50b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChpc19jaGls
ZChuYW1lLCB3YXRjaC0+bm9kZSkpCi0JCQkJCXNlbmRfZXZlbnQoaSwKKwkJ
CQkJc2VuZF9ldmVudChyZXEsIGksCiAJCQkJCQkgICBnZXRfd2F0Y2hfcGF0
aCh3YXRjaCwgbmFtZSksCiAJCQkJCQkgICB3YXRjaC0+dG9rZW4pOwogCQkJ
fQpAQCAtMjY5LDggKzI3MiwxMiBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAl0
cmFjZV9jcmVhdGUod2F0Y2gsICJ3YXRjaCIpOwogCXNlbmRfYWNrKGNvbm4s
IFhTX1dBVENIKTsKIAotCS8qIFdlIGZpcmUgb25jZSB1cCBmcm9udDogc2lt
cGxpZmllcyBjbGllbnRzIGFuZCByZXN0YXJ0LiAqLwotCXNlbmRfZXZlbnQo
Y29ubiwgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2RlKSwgd2F0
Y2gtPnRva2VuKTsKKwkvKgorCSAqIFdlIGZpcmUgb25jZSB1cCBmcm9udDog
c2ltcGxpZmllcyBjbGllbnRzIGFuZCByZXN0YXJ0LgorCSAqIFRoaXMgZXZl
bnQgd2lsbCBub3QgYmUgbGlua2VkIHRvIHRoZSBYU19XQVRDSCByZXF1ZXN0
LgorCSAqLworCXNlbmRfZXZlbnQoTlVMTCwgY29ubiwgZ2V0X3dhdGNoX3Bh
dGgod2F0Y2gsIHdhdGNoLT5ub2RlKSwKKwkJICAgd2F0Y2gtPnRva2VuKTsK
IAogCXJldHVybiAwOwogfQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-06.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSBjODA1N2NiNDgzYWJmMmNkNDA2MGIzOTYxNjQyM2UxOTI4M2ZiZDBh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGRvbid0IGJ1
ZmZlciBtdWx0aXBsZSBpZGVudGljYWwgd2F0Y2ggZXZlbnRzCgpBIGd1ZXN0
IG5vdCByZWFkaW5nIGl0cyBYZW5zdG9yZSByZXNwb25zZSBidWZmZXIgZmFz
dCBlbm91Z2ggbWlnaHQKcGlsZSB1cCBsb3RzIG9mIFhlbnN0b3JlIHdhdGNo
IGV2ZW50cyBidWZmZXJlZC4gUmVkdWNlIHRoZSBnZW5lcmF0ZWQKbG9hZCBi
eSBkcm9wcGluZyBuZXcgZXZlbnRzIHdoaWNoIGFscmVhZHkgaGF2ZSBhbiBp
ZGVudGljYWwgY29weQpwZW5kaW5nLgoKVGhlIHNwZWNpYWwgZXZlbnRzICJA
Li4uIiBhcmUgZXhjbHVkZWQgZnJvbSB0aGF0IGhhbmRsaW5nIGFzIHRoZXJl
IGFyZQprbm93biB1c2UgY2FzZXMgd2hlcmUgdGhlIGhhbmRsZXIgaXMgcmVs
eWluZyBvbiBlYWNoIGV2ZW50IHRvIGJlIHNlbnQKaW5kaXZpZHVhbGx5LgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCA0ODhkNTQwZjNhMzIuLmYxZmE5
N2I4Y2Y1MCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CkBAIC05MTYsNiArOTE2LDcgQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwK
IAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0gMDsKIAli
ZGF0YS0+dGltZW91dF9tc2VjID0gMDsKKwliZGF0YS0+d2F0Y2hfZXZlbnQg
PSBmYWxzZTsKIAogCWlmIChsZW4gPD0gREVGQVVMVF9CVUZGRVJfU0laRSkK
IAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZhdWx0X2J1ZmZlcjsKQEAg
LTk0OCw3ICs5NDksNyBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAogdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQljb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp0b2tlbikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRh
dGE7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLCAqYmQ7CiAJdW5z
aWduZWQgaW50IGxlbjsKIAogCWxlbiA9IHN0cmxlbihwYXRoKSArIDEgKyBz
dHJsZW4odG9rZW4pICsgMTsKQEAgLTk3MCwxMiArOTcxLDI5IEBAIHZvaWQg
c2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKIAliZGF0YS0+aGRyLm1zZy50eXBlID0gWFNf
V0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVuOwogCisJ
LyoKKwkgKiBDaGVjayB3aGV0aGVyIGFuIGlkZW50aWNhbCBldmVudCBpcyBw
ZW5kaW5nIGFscmVhZHkuCisJICogU3BlY2lhbCBldmVudHMgYXJlIGV4Y2x1
ZGVkIGZyb20gdGhhdCBjaGVjay4KKwkgKi8KKwlpZiAocGF0aFswXSAhPSAn
QCcpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShiZCwgJmNvbm4tPm91dF9s
aXN0LCBsaXN0KSB7CisJCQlpZiAoYmQtPndhdGNoX2V2ZW50ICYmIGJkLT5o
ZHIubXNnLmxlbiA9PSBsZW4gJiYKKwkJCSAgICAhbWVtY21wKGJkYXRhLT5i
dWZmZXIsIGJkLT5idWZmZXIsIGxlbikpIHsKKwkJCQl0cmFjZSgiZHJvcHBp
bmcgZHVwbGljYXRlIHdhdGNoICVzICVzIGZvciBkb21haW4gJXVcbiIsCisJ
CQkJICAgICAgcGF0aCwgdG9rZW4sIGNvbm4tPmlkKTsKKwkJCQl0YWxsb2Nf
ZnJlZShiZGF0YSk7CisJCQkJcmV0dXJuOworCQkJfQorCQl9CisJfQorCiAJ
aWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5faXNfdW5w
cml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21zZWMgPSBn
ZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIAkJ
aWYgKCFjb25uLT50aW1lb3V0X21zZWMpCiAJCQljb25uLT50aW1lb3V0X21z
ZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOwogCX0KIAorCWJkYXRhLT53YXRj
aF9ldmVudCA9IHRydWU7CiAJYmRhdGEtPnBlbmQucmVxID0gcmVxOwogCWlm
IChyZXEpCiAJCXJlcS0+cGVuZC5yZWYuZXZlbnRfY250Kys7CmRpZmYgLS1n
aXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBkYjA5ZjQ2M2E2NTcu
LmI5YjUwZTgxYzdiNCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCkBAIC02Miw2ICs2Miw5IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBoZWFkZXI/ICovCiAJYm9v
bCBpbmhkcjsKIAorCS8qIElzIHRoaXMgYSB3YXRjaCBldmVudD8gKi8KKwli
b29sIHdhdGNoX2V2ZW50OworCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-07.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSA1ZWFjNjkyYjg0MTYzM2JlM2U4NWYwMTI1YzU5ZmEwMmFmMTAzOTg5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGZpeCBjb25u
ZWN0aW9uLT5pZCB1c2FnZQoKRG9uJ3QgdXNlIGNvbm4tPmlkIGZvciBwcml2
aWxlZ2UgY2hlY2tzLCBidXQgZG9tYWluX2lzX3VucHJpdmlsZWdlZCgpLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvbnRyb2wuYwppbmRleCA3YjQzMDBlZjc3Nzcu
LmFkYjhkNTFiMDQzYiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvbnRyb2wuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCkBAIC04OTEsNyArODkxLDcgQEAgaW50IGRvX2NvbnRy
b2woc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9k
YXRhICppbikKIAl1bnNpZ25lZCBpbnQgY21kLCBudW0sIG9mZjsKIAljaGFy
ICoqdmVjID0gTlVMTDsKIAotCWlmIChjb25uLT5pZCAhPSAwKQorCWlmIChk
b21haW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKQogCQlyZXR1cm4gRUFDQ0VT
OwogCiAJb2ZmID0gZ2V0X3N0cmluZyhpbiwgMCk7CmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBiOWI1MGU4MWM3YjQuLmIxYTcw
NDg4Yjk4OSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5o
CkBAIC0xMjMsNyArMTIzLDcgQEAgc3RydWN0IGNvbm5lY3Rpb24KIAkvKiBU
aGUgaW5kZXggb2YgcG9sbGZkIGluIGdsb2JhbCBwb2xsZmQgYXJyYXkgKi8K
IAlpbnQgcG9sbGZkX2lkeDsKIAotCS8qIFdobyBhbSBJPyAwIGZvciBzb2Nr
ZXQgY29ubmVjdGlvbnMuICovCisJLyogV2hvIGFtIEk/IERvbWlkIG9mIGNv
bm5lY3Rpb24uICovCiAJdW5zaWduZWQgaW50IGlkOwogCiAJLyogSXMgdGhp
cyBjb25uZWN0aW9uIGlnbm9yZWQ/ICovCmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IDU0NDMyOTA3ZmM3
Ni4uZWUxYjA5MDMxYTNiIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNDc3LDcgKzQ3Nyw4IEBAIGlu
dCBkb190cmFuc2FjdGlvbl9zdGFydChzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmluKQogCWlmIChjb25uLT50cmFu
c2FjdGlvbikKIAkJcmV0dXJuIEVCVVNZOwogCi0JaWYgKGNvbm4tPmlkICYm
IGNvbm4tPnRyYW5zYWN0aW9uX3N0YXJ0ZWQgPiBxdW90YV9tYXhfdHJhbnNh
Y3Rpb24pCisJaWYgKGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYK
KwkgICAgY29ubi0+dHJhbnNhY3Rpb25fc3RhcnRlZCA+IHF1b3RhX21heF90
cmFuc2FjdGlvbikKIAkJcmV0dXJuIEVOT1NQQzsKIAogCS8qIEF0dGFjaCB0
cmFuc2FjdGlvbiB0byBpbnB1dCBmb3IgYXV0b2ZyZWUgdW50aWwgaXQncyBj
b21wbGV0ZSAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-08.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSBmOWYzMTcxNDQxYjVmY2IzMzM5Y2Y2MTI0MDA3OTRmYzI2Y2QyZWMy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNpbXBsaWZ5
IGFuZCBmaXggcGVyIGRvbWFpbiBub2RlIGFjY291bnRpbmcKClRoZSBhY2Nv
dW50aW5nIG9mIG5vZGVzIGNhbiBiZSBzaW1wbGlmaWVkIG5vdyB0aGF0IGVh
Y2ggY29ubmVjdGlvbgpob2xkcyB0aGUgYXNzb2NpYXRlZCBkb21pZC4KCkZp
eCB0aGUgbm9kZSBhY2NvdW50aW5nIHRvIGNvdmVyIG5vZGVzIGNyZWF0ZWQg
Zm9yIGEgZG9tYWluIGJlZm9yZSBpdApoYXMgYmVlbiBpbnRyb2R1Y2VkLiBU
aGlzIHJlcXVpcmVzIHRvIHJlYWN0IHByb3Blcmx5IHRvIGFuIGFsbG9jYXRp
b24KZmFpbHVyZSBpbnNpZGUgZG9tYWluX2VudHJ5X2luYygpIGJ5IHJldHVy
bmluZyBhbiBlcnJvciBjb2RlLgoKRXNwZWNpYWxseSBpbiBlcnJvciBwYXRo
cyB0aGUgbm9kZSBhY2NvdW50aW5nIGhhcyB0byBiZSBmaXhlZCBpbiBzb21l
CmNhc2VzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYgLyBDVkUtMjAyMi00
MjMxMy4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6
b24uY29tPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CmluZGV4IGYxZmE5N2I4Y2Y1MC4uNjkyZDg2M2ZjZTM1IDEwMDY0NAotLS0g
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisrKyBiL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTYzOCw3ICs2MzgsNyBA
QCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBQZXJtaXNzaW9ucyBhcmUg
c3RydWN0IHhzX3Blcm1pc3Npb25zLiAqLwogCW5vZGUtPnBlcm1zLnAgPSBo
ZHItPnBlcm1zOwotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMobm9k
ZSkpIHsKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKSB7CiAJCXRhbGxvY19mcmVlKG5vZGUpOwogCQlyZXR1cm4gTlVMTDsK
IAl9CkBAIC02NjAsNyArNjYwLDcgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qg
bm9kZSAqbm9kZSwKIAl2b2lkICpwOwogCXN0cnVjdCB4c190ZGJfcmVjb3Jk
X2hkciAqaGRyOwogCi0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKQogCQlyZXR1cm4gZXJybm87CiAKIAlkYXRhLmRzaXplID0gc2l6ZW9m
KCpoZHIpCkBAIC0xMjcyLDEzICsxMjcyLDE3IEBAIHN0YXRpYyBzdHJ1Y3Qg
bm9kZSAqY29uc3RydWN0X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IHZvaWQgKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGlj
IGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlKQorc3RhdGljIHZvaWQgZGVzdHJveV9ub2RlX3Jt
KHN0cnVjdCBub2RlICpub2RlKQogewogCWlmIChzdHJlcShub2RlLT5uYW1l
LCAiLyIpKQogCQljb3JydXB0KE5VTEwsICJEZXN0cm95aW5nIHJvb3Qgbm9k
ZSEiKTsKIAogCXRkYl9kZWxldGUodGRiX2N0eCwgbm9kZS0+a2V5KTsKK30K
IAorc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoreworCWRlc3Ryb3lfbm9kZV9y
bShub2RlKTsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwogCiAJ
LyoKQEAgLTEzMjgsOCArMTMzMiwxMiBAQCBzdGF0aWMgc3RydWN0IG5vZGUg
KmNyZWF0ZV9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2
b2lkICpjdHgsCiAJCQlnb3RvIGVycjsKIAogCQkvKiBBY2NvdW50IGZvciBu
ZXcgbm9kZSAqLwotCQlpZiAoaS0+cGFyZW50KQotCQkJZG9tYWluX2VudHJ5
X2luYyhjb25uLCBpKTsKKwkJaWYgKGktPnBhcmVudCkgeworCQkJaWYgKGRv
bWFpbl9lbnRyeV9pbmMoY29ubiwgaSkpIHsKKwkJCQlkZXN0cm95X25vZGVf
cm0oaSk7CisJCQkJcmV0dXJuIE5VTEw7CisJCQl9CisJCX0KIAl9CiAKIAly
ZXR1cm4gbm9kZTsKQEAgLTE2MTQsMTAgKzE2MjIsMjcgQEAgc3RhdGljIGlu
dCBkb19zZXRfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVj
dCBidWZmZXJlZF9kYXRhICppbikKIAlvbGRfcGVybXMgPSBub2RlLT5wZXJt
czsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwogCW5vZGUtPnBl
cm1zID0gcGVybXM7Ci0JZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKTsK
KwlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKSkgeworCQlub2Rl
LT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyoKKwkJICogVGhpcyBzaG91bGQg
bmV2ZXIgZmFpbCBiZWNhdXNlIHdlIGhhZCBhIHJlZmVyZW5jZSBvbiB0aGUK
KwkJICogZG9tYWluIGJlZm9yZSBhbmQgWGVuc3RvcmVkIGlzIHNpbmdsZS10
aHJlYWRlZC4KKwkJICovCisJCWRvbWFpbl9lbnRyeV9pbmMoY29ubiwgbm9k
ZSk7CisJCXJldHVybiBFTk9NRU07CisJfQorCisJaWYgKHdyaXRlX25vZGUo
Y29ubiwgbm9kZSwgZmFsc2UpKSB7CisJCWludCBzYXZlZF9lcnJubyA9IGVy
cm5vOwogCi0JaWYgKHdyaXRlX25vZGUoY29ubiwgbm9kZSwgZmFsc2UpKQor
CQlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOworCQlub2RlLT5wZXJt
cyA9IG9sZF9wZXJtczsKKwkJLyogTm8gZmFpbHVyZSBwb3NzaWJsZSBhcyBh
Ym92ZS4gKi8KKwkJZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKTsKKwor
CQllcnJubyA9IHNhdmVkX2Vycm5vOwogCQlyZXR1cm4gZXJybm87CisJfQog
CiAJZmlyZV93YXRjaGVzKGNvbm4sIGluLCBuYW1lLCBub2RlLCBmYWxzZSwg
Jm9sZF9wZXJtcyk7CiAJc2VuZF9hY2soY29ubiwgWFNfU0VUX1BFUk1TKTsK
QEAgLTMxMjIsNyArMzE0Nyw5IEBAIHZvaWQgcmVhZF9zdGF0ZV9ub2RlKGNv
bnN0IHZvaWQgKmN0eCwgY29uc3Qgdm9pZCAqc3RhdGUpCiAJc2V0X3RkYl9r
ZXkobmFtZSwgJmtleSk7CiAJaWYgKHdyaXRlX25vZGVfcmF3KE5VTEwsICZr
ZXksIG5vZGUsIHRydWUpKQogCQliYXJmKCJ3cml0ZSBub2RlIGVycm9yIHJl
c3RvcmluZyBub2RlIik7Ci0JZG9tYWluX2VudHJ5X2luYygmY29ubiwgbm9k
ZSk7CisKKwlpZiAoZG9tYWluX2VudHJ5X2luYygmY29ubiwgbm9kZSkpCisJ
CWJhcmYoIm5vZGUgYWNjb3VudGluZyBlcnJvciByZXN0b3Jpbmcgbm9kZSIp
OwogCiAJdGFsbG9jX2ZyZWUobm9kZSk7CiB9CmRpZmYgLS1naXQgYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKaW5kZXggODUwMDg1YTkyYzc2Li4yNjA5
NTJlMDkwOTYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9kb21haW4uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKQEAgLTE2LDYgKzE2LDcgQEAKICAgICBhbG9uZyB3aXRoIHRoaXMg
cHJvZ3JhbTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNl
bnNlcy8+LgogKi8KIAorI2luY2x1ZGUgPGFzc2VydC5oPgogI2luY2x1ZGUg
PHN0ZGlvLmg+CiAjaW5jbHVkZSA8c3lzL21tYW4uaD4KICNpbmNsdWRlIDx1
bmlzdGQuaD4KQEAgLTM2Myw2ICszNjQsMTggQEAgc3RhdGljIHN0cnVjdCBk
b21haW4gKmZpbmRfb3JfYWxsb2NfZG9tYWluKGNvbnN0IHZvaWQgKmN0eCwg
dW5zaWduZWQgaW50IGRvbWlkKQogCXJldHVybiBkb21haW4gPyA6IGFsbG9j
X2RvbWFpbihjdHgsIGRvbWlkKTsKIH0KIAorc3RhdGljIHN0cnVjdCBkb21h
aW4gKmZpbmRfb3JfYWxsb2NfZXhpc3RpbmdfZG9tYWluKHVuc2lnbmVkIGlu
dCBkb21pZCkKK3sKKwlzdHJ1Y3QgZG9tYWluICpkb21haW47CisJeGNfZG9t
aW5mb190IGRvbWluZm87CisKKwlkb21haW4gPSBmaW5kX2RvbWFpbl9zdHJ1
Y3QoZG9taWQpOworCWlmICghZG9tYWluICYmIGdldF9kb21haW5faW5mbyhk
b21pZCwgJmRvbWluZm8pKQorCQlkb21haW4gPSBhbGxvY19kb21haW4oTlVM
TCwgZG9taWQpOworCisJcmV0dXJuIGRvbWFpbjsKK30KKwogc3RhdGljIGlu
dCBuZXdfZG9tYWluKHN0cnVjdCBkb21haW4gKmRvbWFpbiwgaW50IHBvcnQs
IGJvb2wgcmVzdG9yZSkKIHsKIAlpbnQgcmM7CkBAIC03ODIsMzAgKzc5NSwy
OCBAQCB2b2lkIGRvbWFpbl9kZWluaXQodm9pZCkKIAkJeGVuZXZ0Y2huX3Vu
YmluZCh4Y2VfaGFuZGxlLCB2aXJxX3BvcnQpOwogfQogCi12b2lkIGRvbWFp
bl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKQoraW50IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogewogCXN0cnVjdCBk
b21haW4gKmQ7CisJdW5zaWduZWQgaW50IGRvbWlkOwogCiAJaWYgKCFjb25u
KQotCQlyZXR1cm47CisJCXJldHVybiAwOwogCi0JaWYgKG5vZGUtPnBlcm1z
LnAgJiYgbm9kZS0+cGVybXMucFswXS5pZCAhPSBjb25uLT5pZCkgewotCQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKLQkJCXRyYW5zYWN0aW9uX2VudHJ5
X2luYyhjb25uLT50cmFuc2FjdGlvbiwKLQkJCQlub2RlLT5wZXJtcy5wWzBd
LmlkKTsKLQkJfSBlbHNlIHsKLQkJCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21p
ZChub2RlLT5wZXJtcy5wWzBdLmlkKTsKLQkJCWlmIChkKQotCQkJCWQtPm5i
ZW50cnkrKzsKLQkJfQotCX0gZWxzZSBpZiAoY29ubi0+ZG9tYWluKSB7Ci0J
CWlmIChjb25uLT50cmFuc2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50
cnlfaW5jKGNvbm4tPnRyYW5zYWN0aW9uLAotCQkJCWNvbm4tPmRvbWFpbi0+
ZG9taWQpOwotIAkJfSBlbHNlIHsKLSAJCQljb25uLT5kb21haW4tPm5iZW50
cnkrKzsKLQkJfQorCWRvbWlkID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBl
cm1zLnBbMF0uaWQgOiBjb25uLT5pZDsKKworCWlmIChjb25uLT50cmFuc2Fj
dGlvbikgeworCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29ubi0+dHJhbnNh
Y3Rpb24sIGRvbWlkKTsKKwl9IGVsc2UgeworCQlkID0gKGRvbWlkID09IGNv
bm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4KKwkJICAg
IDogZmluZF9vcl9hbGxvY19leGlzdGluZ19kb21haW4oZG9taWQpOworCQlp
ZiAoZCkKKwkJCWQtPm5iZW50cnkrKzsKKwkJZWxzZQorCQkJcmV0dXJuIEVO
T01FTTsKIAl9CisKKwlyZXR1cm4gMDsKIH0KIAogLyoKQEAgLTg0MSw3ICs4
NTIsNyBAQCBzdGF0aWMgaW50IGNoa19kb21haW5fZ2VuZXJhdGlvbih1bnNp
Z25lZCBpbnQgZG9taWQsIHVpbnQ2NF90IGdlbikKICAqIFJlbW92ZSBwZXJt
aXNzaW9ucyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5nIGRvbWFpbnMgaW4gb3Jk
ZXIgdG8gYXZvaWQgYSBuZXcKICAqIGRvbWFpbiB3aXRoIHRoZSBzYW1lIGRv
bWlkIGluaGVyaXRpbmcgdGhlIHBlcm1pc3Npb25zLgogICovCi1pbnQgZG9t
YWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVjdCBub2RlICpub2RlKQoraW50
IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJdW5zaWduZWQgaW50IGk7
CiAJaW50IHJldDsKQEAgLTg1MSw4ICs4NjIsMTQgQEAgaW50IGRvbWFpbl9h
ZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qgbm9kZSAqbm9kZSkKIAkJcmV0dXJu
IGVycm5vOwogCiAJLyogSWYgdGhlIG93bmVyIGRvZXNuJ3QgZXhpc3QgYW55
IGxvbmdlciBnaXZlIGl0IHRvIHByaXYgZG9tYWluLiAqLwotCWlmICghcmV0
KQorCWlmICghcmV0KSB7CisJCS8qCisJCSAqIEluIHRoZW9yeSB3ZSdkIG5l
ZWQgdG8gdXBkYXRlIHRoZSBudW1iZXIgb2YgZG9tMCBub2RlcyBoZXJlLAor
CQkgKiBidXQgd2UgY291bGQgYmUgY2FsbGVkIGZvciBhIHJlYWQgb2YgdGhl
IG5vZGUuIFNvIGJldHRlcgorCQkgKiBhdm9pZCB0aGUgcmlzayB0byBvdmVy
ZmxvdyB0aGUgbm9kZSBjb3VudCBvZiBkb20wLgorCQkgKi8KIAkJbm9kZS0+
cGVybXMucFswXS5pZCA9IHByaXZfZG9taWQ7CisJfQogCiAJZm9yIChpID0g
MTsgaSA8IG5vZGUtPnBlcm1zLm51bTsgaSsrKSB7CiAJCWlmIChub2RlLT5w
ZXJtcy5wW2ldLnBlcm1zICYgWFNfUEVSTV9JR05PUkUpCkBAIC04NzEsMjUg
Kzg4OCwyNSBAQCBpbnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVj
dCBub2RlICpub2RlKQogdm9pZCBkb21haW5fZW50cnlfZGVjKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKIAlzdHJ1
Y3QgZG9tYWluICpkOworCXVuc2lnbmVkIGludCBkb21pZDsKIAogCWlmICgh
Y29ubikKIAkJcmV0dXJuOwogCi0JaWYgKG5vZGUtPnBlcm1zLnAgJiYgbm9k
ZS0+cGVybXMucFswXS5pZCAhPSBjb25uLT5pZCkgewotCQlpZiAoY29ubi0+
dHJhbnNhY3Rpb24pIHsKLQkJCXRyYW5zYWN0aW9uX2VudHJ5X2RlYyhjb25u
LT50cmFuc2FjdGlvbiwKLQkJCQlub2RlLT5wZXJtcy5wWzBdLmlkKTsKLQkJ
fSBlbHNlIHsKLQkJCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21pZChub2RlLT5w
ZXJtcy5wWzBdLmlkKTsKLQkJCWlmIChkICYmIGQtPm5iZW50cnkpCi0JCQkJ
ZC0+bmJlbnRyeS0tOwotCQl9Ci0JfSBlbHNlIGlmIChjb25uLT5kb21haW4g
JiYgY29ubi0+ZG9tYWluLT5uYmVudHJ5KSB7Ci0JCWlmIChjb25uLT50cmFu
c2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfZGVjKGNvbm4tPnRy
YW5zYWN0aW9uLAotCQkJCWNvbm4tPmRvbWFpbi0+ZG9taWQpOworCWRvbWlk
ID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBlcm1zLnBbMF0uaWQgOiBjb25u
LT5pZDsKKworCWlmIChjb25uLT50cmFuc2FjdGlvbikgeworCQl0cmFuc2Fj
dGlvbl9lbnRyeV9kZWMoY29ubi0+dHJhbnNhY3Rpb24sIGRvbWlkKTsKKwl9
IGVsc2UgeworCQlkID0gKGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KKwkJICAgIDogZmluZF9kb21haW5fc3Ry
dWN0KGRvbWlkKTsKKwkJaWYgKGQpIHsKKwkJCWQtPm5iZW50cnktLTsKIAkJ
fSBlbHNlIHsKLQkJCWNvbm4tPmRvbWFpbi0+bmJlbnRyeS0tOworCQkJZXJy
bm8gPSBFTk9FTlQ7CisJCQljb3JydXB0KGNvbm4sCisJCQkJIk5vZGUgXCIl
c1wiIG93bmVkIGJ5IG5vbi1leGlzdGluZyBkb21haW4gJXVcbiIsCisJCQkJ
bm9kZS0+bmFtZSwgZG9taWQpOwogCQl9CiAJfQogfQpAQCAtODk5LDEzICs5
MTYsMjMgQEAgaW50IGRvbWFpbl9lbnRyeV9maXgodW5zaWduZWQgaW50IGRv
bWlkLCBpbnQgbnVtLCBib29sIHVwZGF0ZSkKIAlzdHJ1Y3QgZG9tYWluICpk
OwogCWludCBjbnQ7CiAKLQlkID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9t
aWQpOwotCWlmICghZCkKLQkJcmV0dXJuIDA7CisJaWYgKHVwZGF0ZSkgewor
CQlkID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwkJYXNzZXJ0KGQp
OworCX0gZWxzZSB7CisJCS8qCisJCSAqIFdlIGFyZSBjYWxsZWQgZmlyc3Qg
d2l0aCB1cGRhdGUgPT0gZmFsc2UgaW4gb3JkZXIgdG8gY2F0Y2gKKwkJICog
YW55IGVycm9yLiBTbyBkbyBhIHBvc3NpYmxlIGFsbG9jYXRpb24gYW5kIGNo
ZWNrIGZvciBlcnJvcgorCQkgKiBvbmx5IGluIHRoaXMgY2FzZSwgYXMgaW4g
dGhlIGNhc2Ugb2YgdXBkYXRlID09IHRydWUgbm90aGluZworCQkgKiBjYW4g
Z28gd3JvbmcgYW55bW9yZSBhcyB0aGUgYWxsb2NhdGlvbiBhbHJlYWR5IGhh
cHBlbmVkLgorCQkgKi8KKwkJZCA9IGZpbmRfb3JfYWxsb2NfZXhpc3Rpbmdf
ZG9tYWluKGRvbWlkKTsKKwkJaWYgKCFkKQorCQkJcmV0dXJuIC0xOworCX0K
IAogCWNudCA9IGQtPm5iZW50cnkgKyBudW07Ci0JaWYgKGNudCA8IDApCi0J
CWNudCA9IDA7CisJYXNzZXJ0KGNudCA+PSAwKTsKIAogCWlmICh1cGRhdGUp
CiAJCWQtPm5iZW50cnkgPSBjbnQ7CmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmgKaW5kZXggNGY1MWIwMDUyOTFhLi5kNjUxOTkwNGQ4
MzEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21h
aW4uaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
QEAgLTU0LDEwICs1NCwxMCBAQCBjb25zdCBjaGFyICpnZXRfaW1wbGljaXRf
cGF0aChjb25zdCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiBib29sIGRv
bWFpbl9pc191bnByaXZpbGVnZWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4p
OwogCiAvKiBSZW1vdmUgbm9kZSBwZXJtaXNzaW9ucyBmb3Igbm8gbG9uZ2Vy
IGV4aXN0aW5nIGRvbWFpbnMuICovCi1pbnQgZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKHN0cnVjdCBub2RlICpub2RlKTsKK2ludCBkb21haW5fYWRqdXN0
X25vZGVfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKTsKIAogLyogUXVvdGEgbWFuaXB1bGF0aW9uICovCi12b2lk
IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICopOworaW50IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICopOwogdm9pZCBkb21haW5f
ZW50cnlfZGVjKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9k
ZSAqKTsKIGludCBkb21haW5fZW50cnlfZml4KHVuc2lnbmVkIGludCBkb21p
ZCwgaW50IG51bSwgYm9vbCB1cGRhdGUpOwogaW50IGRvbWFpbl9lbnRyeShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGVlMWIwOTAzMWEz
Yi4uODZjYWY2YzM5OGJlIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNTE5LDggKzUxOSwxMiBAQCBz
dGF0aWMgaW50IHRyYW5zYWN0aW9uX2ZpeF9kb21haW5zKHN0cnVjdCB0cmFu
c2FjdGlvbiAqdHJhbnMsIGJvb2wgdXBkYXRlKQogCiAJbGlzdF9mb3JfZWFj
aF9lbnRyeShkLCAmdHJhbnMtPmNoYW5nZWRfZG9tYWlucywgbGlzdCkgewog
CQljbnQgPSBkb21haW5fZW50cnlfZml4KGQtPmRvbWlkLCBkLT5uYmVudHJ5
LCB1cGRhdGUpOwotCQlpZiAoIXVwZGF0ZSAmJiBjbnQgPj0gcXVvdGFfbmJf
ZW50cnlfcGVyX2RvbWFpbikKLQkJCXJldHVybiBFTk9TUEM7CisJCWlmICgh
dXBkYXRlKSB7CisJCQlpZiAoY250ID49IHF1b3RhX25iX2VudHJ5X3Blcl9k
b21haW4pCisJCQkJcmV0dXJuIEVOT1NQQzsKKwkJCWlmIChjbnQgPCAwKQor
CQkJCXJldHVybiBFTk9NRU07CisJCX0KIAl9CiAKIAlyZXR1cm4gMDsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-09.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-09.patch"
Content-Transfer-Encoding: base64

RnJvbSA3MWFhYzZmN2U4OWQ1YzEwMWFkYjllODJlZWE3MDMxZTE2ZDM0ZTQ2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG1h
eCBudW1iZXIgb2Ygbm9kZXMgYWNjZXNzZWQgaW4gYSB0cmFuc2FjdGlvbgoK
VG9kYXkgYSBndWVzdCBpcyBmcmVlIHRvIGFjY2VzcyBhcyBtYW55IG5vZGVz
IGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uCmFzIGl0IHdhbnRzLiBUaGlzIGNh
biBsZWFkIHRvIHVuYm91bmRlZCBtZW1vcnkgY29uc3VtcHRpb24gaW4gWGVu
c3RvcmUKYXMgdGhlcmUgaXMgdGhlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiBh
bGwgbm9kZXMgaGF2aW5nIGJlZW4gYWNjZXNzZWQKZHVyaW5nIGEgdHJhbnNh
Y3Rpb24uCgpJbiBveGVuc3RvcmVkIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMg
aW4gYSB0cmFuc2FjdGlvbiBpcyBiZWluZyBsaW1pdGVkCnZpYSBhIHF1b3Rh
IG1heHJlcXVlc3RzIChkZWZhdWx0IGlzIDEwMjQpLiBBcyBtdWx0aXBsZSBh
Y2Nlc3NlcyBvZiBhCm5vZGUgYXJlIG5vdCBwcm9ibGVtYXRpYyBpbiBDIFhl
bnN0b3JlLCBsaW1pdCB0aGUgbnVtYmVyIG9mIGFjY2Vzc2VkCm5vZGVzLgoK
SW4gb3JkZXIgdG8gbGV0IHJlYWRfbm9kZSgpIGRldGVjdCBhIHF1b3RhIGVy
cm9yIGluIGNhc2UgdG9vIG1hbnkgbm9kZXMKYXJlIGJlaW5nIGFjY2Vzc2Vk
LCBjaGVjayB0aGUgcmV0dXJuIHZhbHVlIG9mIGFjY2Vzc19ub2RlKCkgYW5k
IHJldHVybgpOVUxMIGluIGNhc2UgYW4gZXJyb3IgaGFzIGJlZW4gc2Vlbi4g
SW50cm9kdWNlIF9fbXVzdF9jaGVjayBhbmQgYWRkIGl0CnRvIHRoZSBhY2Nl
c3Nfbm9kZSgpIHByb3RvdHlwZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2
IC8gQ1ZFLTIwMjItNDIzMTQuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxs
IDxqZ3JhbGxAYW1hem9uLmNvbT4KU3VnZ2VzdGVkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGp1bGllbkB4ZW4ub3JnPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdy
b3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL2lu
Y2x1ZGUveGVuLXRvb2xzL2xpYnMuaCBiL3Rvb2xzL2luY2x1ZGUveGVuLXRv
b2xzL2xpYnMuaAppbmRleCBhMTZlMGMzODA3MDkuLmJhZmM5MGUyZjYwMyAx
MDA2NDQKLS0tIGEvdG9vbHMvaW5jbHVkZS94ZW4tdG9vbHMvbGlicy5oCisr
KyBiL3Rvb2xzL2luY2x1ZGUveGVuLXRvb2xzL2xpYnMuaApAQCAtNjMsNCAr
NjMsOCBAQAogI2RlZmluZSBST1VORFVQKF94LF93KSAoKCh1bnNpZ25lZCBs
b25nKShfeCkrKDFVTDw8KF93KSktMSkgJiB+KCgxVUw8PChfdykpLTEpKQog
I2VuZGlmCiAKKyNpZm5kZWYgX19tdXN0X2NoZWNrCisjZGVmaW5lIF9fbXVz
dF9jaGVjayBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f
KSkKKyNlbmRpZgorCiAjZW5kaWYJLyogX19YRU5fVE9PTFNfTElCU19fICov
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCA2OTJk
ODYzZmNlMzUuLmY4MzVhYTFiMmYxZiAxMDA2NDQKLS0tIGEvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDYsNiArMTA2LDcgQEAgaW50IHF1b3Rh
X25iX3dhdGNoX3Blcl9kb21haW4gPSAxMjg7CiBpbnQgcXVvdGFfbWF4X2Vu
dHJ5X3NpemUgPSAyMDQ4OyAvKiAySyAqLwogaW50IHF1b3RhX21heF90cmFu
c2FjdGlvbiA9IDEwOwogaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlID0g
NTsKK2ludCBxdW90YV90cmFuc19ub2RlcyA9IDEwMjQ7CiBpbnQgcXVvdGFf
bWF4X3BhdGhfbGVuID0gWEVOU1RPUkVfUkVMX1BBVEhfTUFYOwogaW50IHF1
b3RhX3JlcV9vdXRzdGFuZGluZyA9IDIwOwogCkBAIC01OTUsNiArNTk2LDcg
QEAgc3RydWN0IG5vZGUgKnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCVREQl9EQVRBIGtleSwgZGF0YTsK
IAlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKIAlzdHJ1Y3Qgbm9k
ZSAqbm9kZTsKKwlpbnQgZXJyOwogCiAJbm9kZSA9IHRhbGxvYyhjdHgsIHN0
cnVjdCBub2RlKTsKIAlpZiAoIW5vZGUpIHsKQEAgLTYxNiwxNCArNjE4LDEz
IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlpZiAoZGF0YS5kcHRyID09IE5V
TEwpIHsKIAkJaWYgKHRkYl9lcnJvcih0ZGJfY3R4KSA9PSBUREJfRVJSX05P
RVhJU1QpIHsKIAkJCW5vZGUtPmdlbmVyYXRpb24gPSBOT19HRU5FUkFUSU9O
OwotCQkJYWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVB
RCwgTlVMTCk7Ci0JCQllcnJubyA9IEVOT0VOVDsKKwkJCWVyciA9IGFjY2Vz
c19ub2RlKGNvbm4sIG5vZGUsIE5PREVfQUNDRVNTX1JFQUQsIE5VTEwpOwor
CQkJZXJybm8gPSBlcnIgPyA6IEVOT0VOVDsKIAkJfSBlbHNlIHsKIAkJCWxv
ZygiVERCIGVycm9yIG9uIHJlYWQ6ICVzIiwgdGRiX2Vycm9yc3RyKHRkYl9j
dHgpKTsKIAkJCWVycm5vID0gRUlPOwogCQl9Ci0JCXRhbGxvY19mcmVlKG5v
ZGUpOwotCQlyZXR1cm4gTlVMTDsKKwkJZ290byBlcnJvcjsKIAl9CiAKIAlu
b2RlLT5wYXJlbnQgPSBOVUxMOwpAQCAtNjM4LDE5ICs2MzksMzYgQEAgc3Ry
dWN0IG5vZGUgKnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3Qgdm9pZCAqY3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVj
dCB4c19wZXJtaXNzaW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5w
ZXJtczsKLQlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKSB7Ci0JCXRhbGxvY19mcmVlKG5vZGUpOwotCQlyZXR1cm4gTlVMTDsK
LQl9CisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhjb25uLCBub2Rl
KSkKKwkJZ290byBlcnJvcjsKIAogCS8qIERhdGEgaXMgYmluYXJ5IGJsb2Ig
KHVzdWFsbHkgYXNjaWksIG5vIG51bCkuICovCiAJbm9kZS0+ZGF0YSA9IG5v
ZGUtPnBlcm1zLnAgKyBoZHItPm51bV9wZXJtczsKIAkvKiBDaGlsZHJlbiBp
cyBzdHJpbmdzLCBudWwgc2VwYXJhdGVkLiAqLwogCW5vZGUtPmNoaWxkcmVu
ID0gbm9kZS0+ZGF0YSArIG5vZGUtPmRhdGFsZW47CiAKLQlhY2Nlc3Nfbm9k
ZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19SRUFELCBOVUxMKTsKKwlpZiAo
YWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVBRCwgTlVM
TCkpCisJCWdvdG8gZXJyb3I7CiAKIAlyZXR1cm4gbm9kZTsKKworIGVycm9y
OgorCWVyciA9IGVycm5vOworCXRhbGxvY19mcmVlKG5vZGUpOworCWVycm5v
ID0gZXJyOworCXJldHVybiBOVUxMOworfQorCitzdGF0aWMgYm9vbCByZWFk
X25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubyh2b2lkKQoreworCS8qCisJICog
MiBlcnJvciBjYXNlcyBmb3IgcmVhZF9ub2RlKCkgY2FuIGFsd2F5cyBiZSBw
cm9wYWdhdGVkIHVwOgorCSAqIEVOT01FTSwgYmVjYXVzZSB0aGlzIGhhcyBu
b3RoaW5nIHRvIGRvIHdpdGggdGhlIG5vZGUgYmVpbmcgaW4gdGhlCisJICog
ZGF0YSBiYXNlIG9yIG5vdCwgYnV0IGlzIGNhdXNlZCBieSBhIGdlbmVyYWwg
bGFjayBvZiBtZW1vcnkuCisJICogRU5PU1BDLCBiZWNhdXNlIHRoaXMgaXMg
cmVsYXRlZCB0byBoaXR0aW5nIHF1b3RhIGxpbWl0cyB3aGljaCBuZWVkCisJ
ICogdG8gYmUgcmVzcGVjdGVkLgorCSAqLworCXJldHVybiBlcnJubyA9PSBF
Tk9NRU0gfHwgZXJybm8gPT0gRU5PU1BDOwogfQogCiBpbnQgd3JpdGVfbm9k
ZV9yYXcoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXks
IHN0cnVjdCBub2RlICpub2RlLApAQCAtNzY3LDcgKzc4NSw3IEBAIHN0YXRp
YyBpbnQgYXNrX3BhcmVudHMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IHZvaWQgKmN0eCwKIAkJbm9kZSA9IHJlYWRfbm9kZShjb25uLCBjdHgs
IG5hbWUpOwogCQlpZiAobm9kZSkKIAkJCWJyZWFrOwotCQlpZiAoZXJybm8g
PT0gRU5PTUVNKQorCQlpZiAocmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSkKIAkJCXJldHVybiBlcnJubzsKIAl9IHdoaWxlICghc3RyZXEobmFt
ZSwgIi8iKSk7CiAKQEAgLTgyOSw3ICs4NDcsNyBAQCBzdGF0aWMgc3RydWN0
IG5vZGUgKmdldF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCQl9
CiAJfQogCS8qIENsZWFuIHVwIGVycm5vIGlmIHRoZXkgd2VyZW4ndCBzdXBw
b3NlZCB0byBrbm93LiAqLwotCWlmICghbm9kZSAmJiBlcnJubyAhPSBFTk9N
RU0pCisJaWYgKCFub2RlICYmICFyZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9l
cnJubygpKQogCQllcnJubyA9IGVycm5vX2Zyb21fcGFyZW50cyhjb25uLCBj
dHgsIG5hbWUsIGVycm5vLCBwZXJtKTsKIAlyZXR1cm4gbm9kZTsKIH0KQEAg
LTEyMzUsNyArMTI1Myw3IEBAIHN0YXRpYyBzdHJ1Y3Qgbm9kZSAqY29uc3Ry
dWN0X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQg
KmN0eCwKIAogCS8qIElmIHBhcmVudCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUg
aXQuICovCiAJcGFyZW50ID0gcmVhZF9ub2RlKGNvbm4sIHBhcmVudG5hbWUs
IHBhcmVudG5hbWUpOwotCWlmICghcGFyZW50KQorCWlmICghcGFyZW50ICYm
IGVycm5vID09IEVOT0VOVCkKIAkJcGFyZW50ID0gY29uc3RydWN0X25vZGUo
Y29ubiwgY3R4LCBwYXJlbnRuYW1lKTsKIAlpZiAoIXBhcmVudCkKIAkJcmV0
dXJuIE5VTEw7CkBAIC0xNTA5LDcgKzE1MjcsNyBAQCBzdGF0aWMgaW50IF9y
bShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LCBz
dHJ1Y3Qgbm9kZSAqbm9kZSwKIAogCXBhcmVudCA9IHJlYWRfbm9kZShjb25u
LCBjdHgsIHBhcmVudG5hbWUpOwogCWlmICghcGFyZW50KQotCQlyZXR1cm4g
KGVycm5vID09IEVOT01FTSkgPyBFTk9NRU0gOiBFSU5WQUw7CisJCXJldHVy
biByZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubygpID8gZXJybm8gOiBF
SU5WQUw7CiAJbm9kZS0+cGFyZW50ID0gcGFyZW50OwogCiAJcmV0dXJuIGRl
bGV0ZV9ub2RlKGNvbm4sIGN0eCwgcGFyZW50LCBub2RlLCBmYWxzZSk7CkBA
IC0xNTM5LDcgKzE1NTcsNyBAQCBzdGF0aWMgaW50IGRvX3JtKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJ
CQkJcmV0dXJuIDA7CiAJCQl9CiAJCQkvKiBSZXN0b3JlIGVycm5vLCBqdXN0
IGluIGNhc2UuICovCi0JCQlpZiAoZXJybm8gIT0gRU5PTUVNKQorCQkJaWYg
KCFyZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubygpKQogCQkJCWVycm5v
ID0gRU5PRU5UOwogCQl9CiAJCXJldHVybiBlcnJubzsKQEAgLTIzODQsNiAr
MjQwMiw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtTSwgLS1w
YXRoLW1heCA8Y2hhcnM+ICBsaW1pdCB0aGUgYWxsb3dlZCBYZW5zdG9yZSBu
b2RlIHBhdGggbGVuZ3RoLFxuIgogIiAgLVEsIC0tcXVvdGEgPHdoYXQ+PTxu
Yj4gc2V0IHRoZSBxdW90YSA8d2hhdD4gdG8gdGhlIHZhbHVlIDxuYj4sIGFs
bG93ZWRcbiIKICIgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RhcyBh
cmU6XG4iCisiICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlv
bi1ub2RlczogbnVtYmVyIG9mIGFjY2Vzc2VkIG5vZGUgcGVyXG4iCisiICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJh
bnNhY3Rpb25cbiIKICIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0
YW5kaW5nOiBudW1iZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKICIg
IC13LCAtLXRpbWVvdXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGlt
ZW91dCBpbiBzZWNvbmRzIGZvciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAg
ICAgICAgICAgICAgICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6
XG4iCkBAIC0yNDY4LDYgKzI0ODgsOCBAQCBzdGF0aWMgdm9pZCBzZXRfcXVv
dGEoY29uc3QgY2hhciAqYXJnKQogCXZhbCA9IGdldF9vcHR2YWxfaW50KGVx
ICsgMSk7CiAJaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFuZGluZyIp
KQogCQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7CisJZWxzZSBpZiAo
d2hhdF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikpCisJCXF1
b3RhX3RyYW5zX25vZGVzID0gdmFsOwogCWVsc2UKIAkJYmFyZigidW5rbm93
biBxdW90YSBcIiVzXCJcbiIsIGFyZyk7CiB9CmRpZmYgLS1naXQgYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuaAppbmRleCBiMWE3MDQ4OGI5ODkuLjI0NWY5MjU4
MjM1ZiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBA
IC0yNjgsNiArMjY4LDcgQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0
ZXJuIGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRy
eV9wZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRp
bmc7CitleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOwogCiBleHRlcm4g
dW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9u
LmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpp
bmRleCA4NmNhZjZjMzk4YmUuLjdiZDQxZWI0NzVlMyAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKQEAgLTE1
Niw2ICsxNTYsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBDb25uZWN0
aW9uLWxvY2FsIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNhY3Rpb24uICov
CiAJdWludDMyX3QgaWQ7CiAKKwkvKiBOb2RlIGNvdW50ZXIuICovCisJdW5z
aWduZWQgaW50IG5vZGVzOworCiAJLyogR2VuZXJhdGlvbiB3aGVuIHRyYW5z
YWN0aW9uIHN0YXJ0ZWQuICovCiAJdWludDY0X3QgZ2VuZXJhdGlvbjsKIApA
QCAtMjYwLDYgKzI2MywxMSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogCiAJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZSh0cmFucywgbm9kZS0+bmFtZSk7CiAJaWYgKCFp
KSB7CisJCWlmICh0cmFucy0+bm9kZXMgPj0gcXVvdGFfdHJhbnNfbm9kZXMg
JiYKKwkJICAgIGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikpIHsKKwkJ
CXJldCA9IEVOT1NQQzsKKwkJCWdvdG8gZXJyOworCQl9CiAJCWkgPSB0YWxs
b2NfemVybyh0cmFucywgc3RydWN0IGFjY2Vzc2VkX25vZGUpOwogCQlpZiAo
IWkpCiAJCQlnb3RvIG5vbWVtOwpAQCAtMjk3LDYgKzMwNSw3IEBAIGludCBh
Y2Nlc3Nfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5v
ZGUgKm5vZGUsCiAJCQkJaS0+dGFfbm9kZSA9IHRydWU7CiAJCQl9CiAJCX0K
KwkJdHJhbnMtPm5vZGVzKys7CiAJCWxpc3RfYWRkX3RhaWwoJmktPmxpc3Qs
ICZ0cmFucy0+YWNjZXNzZWQpOwogCX0KIApkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmggYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uaAppbmRleCAwMDkzY2FjODA3
ZTMuLmUzY2JkNmIyMzA5NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKKysrIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKQEAgLTM5LDggKzM5LDggQEAgdm9p
ZCB0cmFuc2FjdGlvbl9lbnRyeV9pbmMoc3RydWN0IHRyYW5zYWN0aW9uICp0
cmFucywgdW5zaWduZWQgaW50IGRvbWlkKTsKIHZvaWQgdHJhbnNhY3Rpb25f
ZW50cnlfZGVjKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVk
IGludCBkb21pZCk7CiAKIC8qIFRoaXMgbm9kZSB3YXMgYWNjZXNzZWQuICov
Ci1pbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlLAotICAgICAgICAgICAgICAgIGVudW0gbm9kZV9h
Y2Nlc3NfdHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKK2ludCBfX211c3Rf
Y2hlY2sgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBlbnVtIG5vZGVfYWNjZXNzX3R5cGUgdHlwZSwgVERCX0RBVEEgKmtleSk7
CiAKIC8qIFF1ZXVlIHdhdGNoZXMgZm9yIGEgbW9kaWZpZWQgbm9kZS4gKi8K
IHZvaWQgcXVldWVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqbmFtZSwgYm9vbCB3YXRjaF9leGFjdCk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-10.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-10.patch"
Content-Transfer-Encoding: base64

RnJvbSA5MDAxM2Q2YTczNTQ5MWE3YjkzYTY4MzJlYjJhNTFlNTYzMzI1NGY1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1vdmUgdGhl
IGNhbGwgb2Ygc2V0dXBfc3RydWN0dXJlKCkgdG8gZG9tMAogaW50cm9kdWN0
aW9uCgpTZXR0aW5nIHVwIHRoZSBiYXNpYyBzdHJ1Y3R1cmUgd2hlbiBpbnRy
b2R1Y2luZyBkb20wIGhhcyB0aGUgYWR2YW50YWdlCnRvIGJlIGFibGUgdG8g
YWRkIHByb3BlciBub2RlIG1lbW9yeSBhY2NvdW50aW5nIGZvciB0aGUgYWRk
ZWQgbm9kZXMKbGF0ZXIuCgpUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIGRv
IHByb3BlciBub2RlIGFjY291bnRpbmcsIHRvby4KCkFuIGFkZGl0aW9uYWwg
cmVxdWlyZW1lbnQgdG8gbWFrZSB0aGF0IHdvcmsgZmluZSBpcyB0byBjb3Jy
ZWN0IHRoZQpvd25lciBvZiB0aGUgY3JlYXRlZCBub2RlcyB0byBiZSBkb20w
X2RvbWlkIGluc3RlYWQgb2YgZG9taWQgMC4KClRoaXMgaXMgcGFydCBvZiBY
U0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMK
aW5kZXggZjgzNWFhMWIyZjFmLi41MTcxZDM0Yzk0N2UgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtMjAzOSw3ICsyMDM5LDgg
QEAgc3RhdGljIGludCB0ZGJfZmxhZ3M7CiBzdGF0aWMgdm9pZCBtYW51YWxf
bm9kZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFyICpjaGlsZCkKIHsK
IAlzdHJ1Y3Qgbm9kZSAqbm9kZTsKLQlzdHJ1Y3QgeHNfcGVybWlzc2lvbnMg
cGVybXMgPSB7IC5pZCA9IDAsIC5wZXJtcyA9IFhTX1BFUk1fTk9ORSB9Owor
CXN0cnVjdCB4c19wZXJtaXNzaW9ucyBwZXJtcyA9IHsgLmlkID0gZG9tMF9k
b21pZCwKKwkJCQkJLnBlcm1zID0gWFNfUEVSTV9OT05FIH07CiAKIAlub2Rl
ID0gdGFsbG9jX3plcm8oTlVMTCwgc3RydWN0IG5vZGUpOwogCWlmICghbm9k
ZSkKQEAgLTIwNzgsNyArMjA3OSw3IEBAIHN0YXRpYyB2b2lkIHRkYl9sb2dn
ZXIoVERCX0NPTlRFWFQgKnRkYiwgaW50IGxldmVsLCBjb25zdCBjaGFyICog
Zm10LCAuLi4pCiAJfQogfQogCi1zdGF0aWMgdm9pZCBzZXR1cF9zdHJ1Y3R1
cmUoYm9vbCBsaXZlX3VwZGF0ZSkKK3ZvaWQgc2V0dXBfc3RydWN0dXJlKGJv
b2wgbGl2ZV91cGRhdGUpCiB7CiAJY2hhciAqdGRibmFtZTsKIApAQCAtMjEw
MSw2ICsyMTAyLDcgQEAgc3RhdGljIHZvaWQgc2V0dXBfc3RydWN0dXJlKGJv
b2wgbGl2ZV91cGRhdGUpCiAJCW1hbnVhbF9ub2RlKCIvIiwgInRvb2wiKTsK
IAkJbWFudWFsX25vZGUoIi90b29sIiwgInhlbnN0b3JlZCIpOwogCQltYW51
YWxfbm9kZSgiL3Rvb2wveGVuc3RvcmVkIiwgTlVMTCk7CisJCWRvbWFpbl9l
bnRyeV9maXgoZG9tMF9kb21pZCwgMywgdHJ1ZSk7CiAJfQogCiAJY2hlY2tf
c3RvcmUoKTsKQEAgLTI2MTQsOSArMjYxNiw2IEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAKIAlpbml0X3BpcGUocmVvcGVuX2xvZ19w
aXBlKTsKIAotCS8qIFNldHVwIHRoZSBkYXRhYmFzZSAqLwotCXNldHVwX3N0
cnVjdHVyZShsaXZlX3VwZGF0ZSk7Ci0KIAkvKiBMaXN0ZW4gdG8gaHlwZXJ2
aXNvci4gKi8KIAlpZiAoIW5vX2RvbWFpbl9pbml0ICYmICFsaXZlX3VwZGF0
ZSkgewogCQlkb21haW5faW5pdCgtMSk7CmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAppbmRleCAyNDVmOTI1ODIzNWYuLjJjNzdlYzdlZTBm
NCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUu
aAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0y
MzEsNiArMjMxLDcgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qgbm9kZSAqbm9k
ZSwKIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAkJICAgICAgIGNvbnN0IGNoYXIg
Km5hbWUpOwogCit2b2lkIHNldHVwX3N0cnVjdHVyZShib29sIGxpdmVfdXBk
YXRlKTsKIHN0cnVjdCBjb25uZWN0aW9uICpuZXdfY29ubmVjdGlvbihjb25z
dCBzdHJ1Y3QgaW50ZXJmYWNlX2Z1bmNzICpmdW5jcyk7CiBzdHJ1Y3QgY29u
bmVjdGlvbiAqZ2V0X2Nvbm5lY3Rpb25fYnlfaWQodW5zaWduZWQgaW50IGNv
bm5faWQpOwogdm9pZCBpZ25vcmVfY29ubmVjdGlvbihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubik7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKaW5kZXggMjYwOTUyZTA5MDk2Li5mMDRiN2FhZThhMzIgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYworKysg
Yi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKQEAgLTQ3MCw2
ICs0NzAsOSBAQCBzdGF0aWMgc3RydWN0IGRvbWFpbiAqaW50cm9kdWNlX2Rv
bWFpbihjb25zdCB2b2lkICpjdHgsCiAJCX0KIAkJZG9tYWluLT5pbnRlcmZh
Y2UgPSBpbnRlcmZhY2U7CiAKKwkJaWYgKGlzX21hc3Rlcl9kb21haW4pCisJ
CQlzZXR1cF9zdHJ1Y3R1cmUocmVzdG9yZSk7CisKIAkJLyogTm93IGRvbWFp
biBiZWxvbmdzIHRvIGl0cyBjb25uZWN0aW9uLiAqLwogCQl0YWxsb2Nfc3Rl
YWwoZG9tYWluLT5jb25uLCBkb21haW4pOwogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-11.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-11.patch"
Content-Transfer-Encoding: base64

RnJvbSA2YWYxN2I4YmY1MmI5ZGZkYzZhNWVjZDNlZmJjZWE5ZmRkZDU3ZDkx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBpbmZy
YXN0cnVjdHVyZSB0byBrZWVwIHRyYWNrIG9mIHBlciBkb21haW4gbWVtb3J5
CiB1c2FnZQoKVGhlIGFtb3VudCBvZiBtZW1vcnkgYSBkb21haW4gY2FuIGNv
bnN1bWUgaW4gWGVuc3RvcmUgaXMgbGltaXRlZCBieQp2YXJpb3VzIHF1b3Rh
IHRvZGF5LCBidXQgZXZlbiB3aXRoIHNhbmUgcXVvdGEgYSBkb21haW4gY2Fu
IHN0aWxsCmNvbnN1bWUgcmF0aGVyIGxhcmdlIG1lbW9yeSBxdWFudGl0aWVz
LgoKQWRkIHRoZSBpbmZyYXN0cnVjdHVyZSBmb3Iga2VlcGluZyB0cmFjayBv
ZiB0aGUgYW1vdW50IG9mIG1lbW9yeSBhCmRvbWFpbiBpcyBjb25zdW1pbmcg
aW4gWGVuc3RvcmUuIE5vdGUgdGhhdCB0aGlzIGlzIG9ubHkgdGhlIG1lbW9y
eSBhCmRvbWFpbiBoYXMgZGlyZWN0IGNvbnRyb2wgb3Zlciwgc28gYW55IGlu
dGVybmFsIGFkbWluaXN0cmF0aW9uIGRhdGEKbmVlZGVkIGJ5IFhlbnN0b3Jl
IG9ubHkgaXMgbm90IGJlaW5nIGFjY291bnRlZCBmb3IuCgpUaGVyZSBhcmUg
dHdvIHF1b3RhcyBkZWZpbmVkOiBhIHNvZnQgcXVvdGEgd2hpY2ggd2lsbCBy
ZXN1bHQgaW4gYQp3YXJuaW5nIGlzc3VlZCB2aWEgc3lzbG9nKCkgd2hlbiBp
dCBpcyBleGNlZWRlZCwgYW5kIGEgaGFyZCBxdW90YQpyZXN1bHRpbmcgaW4g
YSBzdG9wIG9mIGFjY2VwdGluZyBmdXJ0aGVyIHJlcXVlc3RzIG9yIHdhdGNo
IGV2ZW50cyBhcwpsb25nIGFzIHRoZSBoYXJkIHF1b3RhIHdvdWxkIGJlIHZp
b2xhdGVkIGJ5IGFjY2VwdGluZyB0aG9zZS4KClNldHRpbmcgYW55IG9mIHRo
b3NlIHF1b3RhcyB0byAwIHdpbGwgZGlzYWJsZSBpdC4KCkFzIGRlZmF1bHQg
dmFsdWVzIHVzZSAyTUIgcGVyIGRvbWFpbiBmb3IgdGhlIHNvZnQgbGltaXQg
KHRoaXMgYmFzaWNhbGx5CmNvdmVycyB0aGUgYWxsb3dlZCBjYXNlIHRvIGNy
ZWF0ZSAxMDAwIG5vZGVzIG5lZWRpbmcgMmtCIGVhY2gpLCBhbmQKMi41TUIg
Zm9yIHRoZSBoYXJkIGxpbWl0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA1MTcxZDM0Yzk0N2UuLmIyYmY2NzQwZDQzMCAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDksNiArMTA5LDggQEAgaW50
IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlID0gNTsKIGludCBxdW90YV90cmFu
c19ub2RlcyA9IDEwMjQ7CiBpbnQgcXVvdGFfbWF4X3BhdGhfbGVuID0gWEVO
U1RPUkVfUkVMX1BBVEhfTUFYOwogaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZyA9IDIwOworaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX3NvZnQgPSAy
ICogMTAyNCAqIDEwMjQ7IC8qIDIgTUIgKi8KK2ludCBxdW90YV9tZW1vcnlf
cGVyX2RvbWFpbl9oYXJkID0gMiAqIDEwMjQgKiAxMDI0ICsgNTEyICogMTAy
NDsgLyogMi41IE1CICovCiAKIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNo
X2V2ZW50X21zZWMgPSAyMDAwMDsKIApAQCAtMjQwNiw3ICsyNDA4LDE0IEBA
IHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICBxdW90YXMgYXJlOlxuIgogIiAgICAgICAgICAgICAgICAgICAg
ICAgICAgdHJhbnNhY3Rpb24tbm9kZXM6IG51bWJlciBvZiBhY2Nlc3NlZCBu
b2RlIHBlclxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRyYW5zYWN0aW9uXG4iCisiICAgICAgICAgICAgICAg
ICAgICAgICAgICBtZW1vcnk6IHRvdGFsIHVzZWQgbWVtb3J5IHBlciBkb21h
aW4gZm9yIG5vZGVzLFxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0cmFuc2FjdGlvbnMsIHdhdGNoZXMgYW5kIHJlcXVlc3RzLCBh
Ym92ZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3
aGljaCBYZW5zdG9yZSB3aWxsIHN0b3AgdGFsa2luZyB0byBkb21haW5cbiIK
ICIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nOiBudW1i
ZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKKyIgIC1xLCAtLXF1b3Rh
LXNvZnQgPHdoYXQ+PTxuYj4gc2V0IGEgc29mdCBxdW90YSA8d2hhdD4gdG8g
dGhlIHZhbHVlIDxuYj4sXG4iCisiICAgICAgICAgICAgICAgICAgICAgICAg
ICBjYXVzaW5nIGEgd2FybmluZyB0byBiZSBpc3N1ZWQgdmlhIHN5c2xvZygp
IGlmIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQg
aXMgdmlvbGF0ZWQsIGFsbG93ZWQgcXVvdGFzIGFyZTpcbiIKKyIgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1lbW9yeTogc2VlIGFib3ZlXG4iCiAiICAt
dywgLS10aW1lb3V0IDx3aGF0Pj08c2Vjb25kcz4gICBzZXQgdGhlIHRpbWVv
dXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+LFxuIgogIiAgICAgICAgICAgICAg
ICAgICAgICAgICAgYWxsb3dlZCB0aW1lb3V0IGNhbmRpZGF0ZXMgYXJlOlxu
IgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2gtZXZlbnQ6IHRp
bWUgYSB3YXRjaC1ldmVudCBpcyBrZXB0IHBlbmRpbmdcbiIKQEAgLTI0MzMs
NiArMjQ0Miw3IEBAIHN0YXRpYyBzdHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9
IHsKIAl7ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCiAJeyAicGF0aC1t
YXgiLCAxLCBOVUxMLCAnTScgfSwKIAl7ICJxdW90YSIsIDEsIE5VTEwsICdR
JyB9LAorCXsgInF1b3RhLXNvZnQiLCAxLCBOVUxMLCAncScgfSwKIAl7ICJ0
aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAw
LCBOVUxMLCAnUicgfSwKIAl7ICJpbnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJ
JyB9LApAQCAtMjQ4MCw3ICsyNDkwLDcgQEAgc3RhdGljIHZvaWQgc2V0X3Rp
bWVvdXQoY29uc3QgY2hhciAqYXJnKQogCQliYXJmKCJ1bmtub3duIHRpbWVv
dXQgXCIlc1wiXG4iLCBhcmcpOwogfQogCi1zdGF0aWMgdm9pZCBzZXRfcXVv
dGEoY29uc3QgY2hhciAqYXJnKQorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNv
bnN0IGNoYXIgKmFyZywgYm9vbCBzb2Z0KQogewogCWNvbnN0IGNoYXIgKmVx
ID0gc3RyY2hyKGFyZywgJz0nKTsKIAlpbnQgdmFsOwpAQCAtMjQ4OCwxMSAr
MjQ5OCwxNiBAQCBzdGF0aWMgdm9pZCBzZXRfcXVvdGEoY29uc3QgY2hhciAq
YXJnKQogCWlmICghZXEpCiAJCWJhcmYoInF1b3RhcyBtdXN0IGJlIHNwZWNp
ZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOwogCXZhbCA9IGdldF9vcHR2YWxf
aW50KGVxICsgMSk7Ci0JaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFu
ZGluZyIpKQorCWlmICh3aGF0X21hdGNoZXMoYXJnLCAib3V0c3RhbmRpbmci
KSAmJiAhc29mdCkKIAkJcXVvdGFfcmVxX291dHN0YW5kaW5nID0gdmFsOwot
CWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlvbi1ub2Rl
cyIpKQorCWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlv
bi1ub2RlcyIpICYmICFzb2Z0KQogCQlxdW90YV90cmFuc19ub2RlcyA9IHZh
bDsKLQllbHNlCisJZWxzZSBpZiAod2hhdF9tYXRjaGVzKGFyZywgIm1lbW9y
eSIpKSB7CisJCWlmIChzb2Z0KQorCQkJcXVvdGFfbWVtb3J5X3Blcl9kb21h
aW5fc29mdCA9IHZhbDsKKwkJZWxzZQorCQkJcXVvdGFfbWVtb3J5X3Blcl9k
b21haW5faGFyZCA9IHZhbDsKKwl9IGVsc2UKIAkJYmFyZigidW5rbm93biBx
dW90YSBcIiVzXCJcbiIsIGFyZyk7CiB9CiAKQEAgLTI1MTAsNyArMjUyNSw3
IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAJb3JpZ19h
cmdjID0gYXJnYzsKIAlvcmlnX2FyZ3YgPSBhcmd2OwogCi0Jd2hpbGUgKChv
cHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6QTpN
OlE6VDpSVlc6dzpVIiwKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFy
Z2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06UTpxOlQ6UlZXOnc6VSIsCiAJ
CQkJICBvcHRpb25zLCBOVUxMKSkgIT0gLTEpIHsKIAkJc3dpdGNoIChvcHQp
IHsKIAkJY2FzZSAnRCc6CkBAIC0yNTYxLDcgKzI1NzYsMTAgQEAgaW50IG1h
aW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCQkJCSBxdW90YV9tYXhf
cGF0aF9sZW4pOwogCQkJYnJlYWs7CiAJCWNhc2UgJ1EnOgotCQkJc2V0X3F1
b3RhKG9wdGFyZyk7CisJCQlzZXRfcXVvdGEob3B0YXJnLCBmYWxzZSk7CisJ
CQlicmVhazsKKwkJY2FzZSAncSc6CisJCQlzZXRfcXVvdGEob3B0YXJnLCB0
cnVlKTsKIAkJCWJyZWFrOwogCQljYXNlICd3JzoKIAkJCXNldF90aW1lb3V0
KG9wdGFyZyk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApp
bmRleCAyYzc3ZWM3ZWUwZjQuLjM3M2FmMTgyOTdiZiAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0yNzAsNiArMjcwLDggQEAg
ZXh0ZXJuIGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9l
bnRyeV9wZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3Rh
bmRpbmc7CiBleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOworZXh0ZXJu
IGludCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0OworZXh0ZXJuIGlu
dCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkOwogCiBleHRlcm4gdW5z
aWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0t
Z2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IGYwNGI3YWFl
OGEzMi4uOTRmZDU2MWU5ZGU0IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5jCkBAIC03Niw2ICs3NiwxMyBAQCBzdHJ1Y3QgZG9t
YWluCiAJLyogbnVtYmVyIG9mIGVudHJ5IGZyb20gdGhpcyBkb21haW4gaW4g
dGhlIHN0b3JlICovCiAJaW50IG5iZW50cnk7CiAKKwkvKiBBbW91bnQgb2Yg
bWVtb3J5IGFsbG9jYXRlZCBmb3IgdGhpcyBkb21haW4uICovCisJaW50IG1l
bW9yeTsKKwlib29sIHNvZnRfcXVvdGFfcmVwb3J0ZWQ7CisJYm9vbCBoYXJk
X3F1b3RhX3JlcG9ydGVkOworCXRpbWVfdCBtZW1fbGFzdF9tc2c7CisjZGVm
aW5lIE1FTV9XQVJOX01JTlRJTUVfU0VDIDEwCisKIAkvKiBudW1iZXIgb2Yg
d2F0Y2ggZm9yIHRoaXMgZG9tYWluICovCiAJaW50IG5id2F0Y2g7CiAKQEAg
LTE5Miw2ICsxOTksOSBAQCBzdGF0aWMgYm9vbCBkb21haW5fY2FuX3JlYWQo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiAJCQlyZXR1cm4gZmFsc2U7CiAJ
CWlmIChjb25uLT5kb21haW4tPm5ib3V0c3RhbmRpbmcgPj0gcXVvdGFfcmVx
X291dHN0YW5kaW5nKQogCQkJcmV0dXJuIGZhbHNlOworCQlpZiAoY29ubi0+
ZG9tYWluLT5tZW1vcnkgPj0gcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFy
ZCAmJgorCQkgICAgcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFyZCkKKwkJ
CXJldHVybiBmYWxzZTsKIAl9CiAKIAlyZXR1cm4gKGludGYtPnJlcV9jb25z
ICE9IGludGYtPnJlcV9wcm9kKTsKQEAgLTk1MCw2ICs5NjAsODkgQEAgaW50
IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKIAkJOiAw
OwogfQogCitzdGF0aWMgYm9vbCBkb21haW5fY2hrX3F1b3RhKHN0cnVjdCBk
b21haW4gKmRvbWFpbiwgaW50IG1lbSkKK3sKKwl0aW1lX3Qgbm93OworCisJ
aWYgKCFkb21haW4gfHwgIWRvbWlkX2lzX3VucHJpdmlsZWdlZChkb21haW4t
PmRvbWlkKSB8fAorCSAgICAoZG9tYWluLT5jb25uICYmIGRvbWFpbi0+Y29u
bi0+aXNfaWdub3JlZCkpCisJCXJldHVybiBmYWxzZTsKKworCW5vdyA9IHRp
bWUoTlVMTCk7CisKKwlpZiAobWVtID49IHF1b3RhX21lbW9yeV9wZXJfZG9t
YWluX2hhcmQgJiYKKwkgICAgcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFy
ZCkgeworCQlpZiAoZG9tYWluLT5oYXJkX3F1b3RhX3JlcG9ydGVkKQorCQkJ
cmV0dXJuIHRydWU7CisJCXN5c2xvZyhMT0dfRVJSLCAiRG9tYWluICV1IGV4
Y2VlZHMgaGFyZCBtZW1vcnkgcXVvdGEsIFhlbnN0b3JlIGludGVyZmFjZSB0
byBkb21haW4gc3RhbGxlZFxuIiwKKwkJICAgICAgIGRvbWFpbi0+ZG9taWQp
OworCQlkb21haW4tPm1lbV9sYXN0X21zZyA9IG5vdzsKKwkJZG9tYWluLT5o
YXJkX3F1b3RhX3JlcG9ydGVkID0gdHJ1ZTsKKwkJcmV0dXJuIHRydWU7CisJ
fQorCisJaWYgKG5vdyAtIGRvbWFpbi0+bWVtX2xhc3RfbXNnID49IE1FTV9X
QVJOX01JTlRJTUVfU0VDKSB7CisJCWlmIChkb21haW4tPmhhcmRfcXVvdGFf
cmVwb3J0ZWQpIHsKKwkJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93Owor
CQkJZG9tYWluLT5oYXJkX3F1b3RhX3JlcG9ydGVkID0gZmFsc2U7CisJCQlz
eXNsb2coTE9HX0lORk8sICJEb21haW4gJXUgYmVsb3cgaGFyZCBtZW1vcnkg
cXVvdGEgYWdhaW5cbiIsCisJCQkgICAgICAgZG9tYWluLT5kb21pZCk7CisJ
CX0KKwkJaWYgKG1lbSA+PSBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0
ICYmCisJCSAgICBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ICYmCisJ
CSAgICAhZG9tYWluLT5zb2Z0X3F1b3RhX3JlcG9ydGVkKSB7CisJCQlkb21h
aW4tPm1lbV9sYXN0X21zZyA9IG5vdzsKKwkJCWRvbWFpbi0+c29mdF9xdW90
YV9yZXBvcnRlZCA9IHRydWU7CisJCQlzeXNsb2coTE9HX1dBUk5JTkcsICJE
b21haW4gJXUgZXhjZWVkcyBzb2Z0IG1lbW9yeSBxdW90YVxuIiwKKwkJCSAg
ICAgICBkb21haW4tPmRvbWlkKTsKKwkJfQorCQlpZiAobWVtIDwgcXVvdGFf
bWVtb3J5X3Blcl9kb21haW5fc29mdCAmJgorCQkgICAgZG9tYWluLT5zb2Z0
X3F1b3RhX3JlcG9ydGVkKSB7CisJCQlkb21haW4tPm1lbV9sYXN0X21zZyA9
IG5vdzsKKwkJCWRvbWFpbi0+c29mdF9xdW90YV9yZXBvcnRlZCA9IGZhbHNl
OworCQkJc3lzbG9nKExPR19JTkZPLCAiRG9tYWluICV1IGJlbG93IHNvZnQg
bWVtb3J5IHF1b3RhIGFnYWluXG4iLAorCQkJICAgICAgIGRvbWFpbi0+ZG9t
aWQpOworCQl9CisKKwl9CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK2ludCBk
b21haW5fbWVtb3J5X2FkZCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0s
IGJvb2wgbm9fcXVvdGFfY2hlY2spCit7CisJc3RydWN0IGRvbWFpbiAqZG9t
YWluOworCisJZG9tYWluID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsK
KwlpZiAoZG9tYWluKSB7CisJCS8qCisJCSAqIGRvbWFpbl9jaGtfcXVvdGEo
KSB3aWxsIHByaW50IHdhcm5pbmcgYW5kIGFsc28gc3RvcmUgd2hldGhlcgor
CQkgKiB0aGUgc29mdC9oYXJkIHF1b3RhIGhhcyBiZWVuIGhpdC4gU28gY2hl
Y2sgbm9fcXVvdGFfY2hlY2sKKwkJICogKmFmdGVyKi4KKwkJICovCisJCWlm
IChkb21haW5fY2hrX3F1b3RhKGRvbWFpbiwgZG9tYWluLT5tZW1vcnkgKyBt
ZW0pICYmCisJCSAgICAhbm9fcXVvdGFfY2hlY2spCisJCQlyZXR1cm4gRU5P
TUVNOworCQlkb21haW4tPm1lbW9yeSArPSBtZW07CisJfSBlbHNlIHsKKwkJ
LyoKKwkJICogVGhlIGRvbWFpbiB0aGUgbWVtb3J5IGlzIHRvIGJlIGFjY291
bnRlZCBmb3Igc2hvdWxkIGFsd2F5cworCQkgKiBleGlzdCwgYXMgYWNjb3Vu
dGluZyBpcyBkb25lIGVpdGhlciBmb3IgYSBkb21haW4gcmVsYXRlZCB0bwor
CQkgKiB0aGUgY3VycmVudCBjb25uZWN0aW9uLCBvciBmb3IgdGhlIGRvbWFp
biBvd25pbmcgYSBub2RlCisJCSAqICh3aGljaCBpcyBhbHdheXMgZXhpc3Rp
bmcsIGFzIHRoZSBvd25lciBvZiB0aGUgbm9kZSBpcworCQkgKiB0ZXN0ZWQg
dG8gZXhpc3QgYW5kIHJlcGxhY2VkIGJ5IGRvbWlkIDAgaWYgbm90KS4KKwkJ
ICogU28gbm90IGZpbmRpbmcgdGhlIHJlbGF0ZWQgZG9tYWluIE1VU1QgYmUg
YW4gZXJyb3IgaW4gdGhlCisJCSAqIGRhdGEgYmFzZS4KKwkJICovCisJCWVy
cm5vID0gRU5PRU5UOworCQljb3JydXB0KE5VTEwsICJBY2NvdW50aW5nIGNh
bGxlZCBmb3Igbm9uLWV4aXN0aW5nIGRvbWFpbiAldVxuIiwKKwkJCWRvbWlk
KTsKKwkJcmV0dXJuIEVOT0VOVDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwog
dm9pZCBkb21haW5fd2F0Y2hfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
KQogewogCWlmICghY29ubiB8fCAhY29ubi0+ZG9tYWluKQpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCmluZGV4IGQ2NTE5OTA0ZDgz
MS4uNjMzYzlhMGEwYTFmIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2RvbWFpbi5oCkBAIC02MSw2ICs2MSwyNiBAQCBpbnQgZG9tYWluX2Vu
dHJ5X2luYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUg
Kik7CiB2b2lkIGRvbWFpbl9lbnRyeV9kZWMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICopOwogaW50IGRvbWFpbl9lbnRyeV9maXgo
dW5zaWduZWQgaW50IGRvbWlkLCBpbnQgbnVtLCBib29sIHVwZGF0ZSk7CiBp
bnQgZG9tYWluX2VudHJ5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKK2lu
dCBkb21haW5fbWVtb3J5X2FkZCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBt
ZW0sIGJvb2wgbm9fcXVvdGFfY2hlY2spOworCisvKgorICogZG9tYWluX21l
bW9yeV9hZGRfY2hrKCk6IHRvIGJlIHVzZWQgd2hlbiBtZW1vcnkgcXVvdGEg
c2hvdWxkIGJlIGNoZWNrZWQuCisgKiBOb3QgdG8gYmUgdXNlZCB3aGVuIHNw
ZWNpZnlpbmcgYSBuZWdhdGl2ZSBtZW0gdmFsdWUsIGFzIGxvd2VyaW5nIHRo
ZSB1c2VkCisgKiBtZW1vcnkgc2hvdWxkIGFsd2F5cyBiZSBhbGxvd2VkLgor
ICovCitzdGF0aWMgaW5saW5lIGludCBkb21haW5fbWVtb3J5X2FkZF9jaGso
dW5zaWduZWQgaW50IGRvbWlkLCBpbnQgbWVtKQoreworCXJldHVybiBkb21h
aW5fbWVtb3J5X2FkZChkb21pZCwgbWVtLCBmYWxzZSk7Cit9CisvKgorICog
ZG9tYWluX21lbW9yeV9hZGRfbm9jaGsoKTogdG8gYmUgdXNlZCB3aGVuIG1l
bW9yeSBxdW90YSBzaG91bGQgbm90IGJlCisgKiBjaGVja2VkLCBlLmcuIHdo
ZW4gbG93ZXJpbmcgbWVtb3J5IHVzYWdlLCBvciBpbiBhbiBlcnJvciBjYXNl
IGZvciB1bmRvaW5nCisgKiBhIHByZXZpb3VzIG1lbW9yeSBhZGp1c3RtZW50
LgorICovCitzdGF0aWMgaW5saW5lIHZvaWQgZG9tYWluX21lbW9yeV9hZGRf
bm9jaGsodW5zaWduZWQgaW50IGRvbWlkLCBpbnQgbWVtKQoreworCWRvbWFp
bl9tZW1vcnlfYWRkKGRvbWlkLCBtZW0sIHRydWUpOworfQogdm9pZCBkb21h
aW5fd2F0Y2hfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKIHZvaWQg
ZG9tYWluX3dhdGNoX2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiBp
bnQgZG9tYWluX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-12.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-12.patch"
Content-Transfer-Encoding: base64

RnJvbSBhZTcwNDJmMDI0YWY3NTg0MjUxZjc3NmExMmQ5YmIyNGQxM2ZlY2Fm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3IgcmVzcG9uc2VzCgpBZGQgdGhlIG1lbW9yeSBh
Y2NvdW50aW5nIGZvciBxdWV1ZWQgcmVzcG9uc2VzLgoKSW4gY2FzZSBhZGRp
bmcgYSB3YXRjaCBldmVudCBmb3IgYSBndWVzdCBpcyBjYXVzaW5nIHRoZSBo
YXJkIG1lbW9yeQpxdW90YSBvZiB0aGF0IGd1ZXN0IHRvIGJlIHZpb2xhdGVk
LCB0aGUgZXZlbnQgaXMgZHJvcHBlZC4gVGhpcyB3aWxsCmVuc3VyZSB0aGF0
IGl0IGlzIGltcG9zc2libGUgdG8gZHJpdmUgYW5vdGhlciBndWVzdCBwYXN0
IGl0cyBtZW1vcnkKcXVvdGEgYnkgZ2VuZXJhdGluZyBpbnNhbmUgYW1vdW50
cyBvZiBldmVudHMgZm9yIHRoYXQgZ3Vlc3QuIFRoaXMgaXMKZXNwZWNpYWxs
eSBpbXBvcnRhbnQgZm9yIHByb3RlY3RpbmcgZHJpdmVyIGRvbWFpbnMgZnJv
bSB0aGF0IGF0dGFjawp2ZWN0b3IuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
NiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4g
R3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggYjJiZjY3NDBkNDMwLi5lY2FiNmNmYmJl
MTUgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MjYwLDYgKzI2MCw4IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0
YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIC1vdXQtPmhkci5tc2cu
bGVuIC0gc2l6ZW9mKG91dC0+aGRyKSk7CisKIAlpZiAob3V0LT5oZHIubXNn
LnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKIAkJcmVxID0gb3V0LT5wZW5k
LnJlcTsKIAkJaWYgKHJlcSkgewpAQCAtOTM4LDExICs5NDAsMTQgQEAgdm9p
ZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhz
ZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAliZGF0YS0+dGltZW91dF9tc2VjID0g
MDsKIAliZGF0YS0+d2F0Y2hfZXZlbnQgPSBmYWxzZTsKIAotCWlmIChsZW4g
PD0gREVGQVVMVF9CVUZGRVJfU0laRSkKKwlpZiAobGVuIDw9IERFRkFVTFRf
QlVGRkVSX1NJWkUpIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZh
dWx0X2J1ZmZlcjsKLQllbHNlIHsKKwkJLyogRG9uJ3QgY2hlY2sgcXVvdGEs
IHBhdGggbWlnaHQgYmUgdXNlZCBmb3IgcmV0dXJuaW5nIGVycm9yLiAqLwor
CQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgbGVuICsgc2l6
ZW9mKGJkYXRhLT5oZHIpKTsKKwl9IGVsc2UgewogCQliZGF0YS0+YnVmZmVy
ID0gdGFsbG9jX2FycmF5KGJkYXRhLCBjaGFyLCBsZW4pOwotCQlpZiAoIWJk
YXRhLT5idWZmZXIpIHsKKwkJaWYgKCFiZGF0YS0+YnVmZmVyIHx8CisJCSAg
ICBkb21haW5fbWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVv
ZihiZGF0YS0+aGRyKSkpIHsKIAkJCXNlbmRfZXJyb3IoY29ubiwgRU5PTUVN
KTsKIAkJCXJldHVybjsKIAkJfQpAQCAtMTAwNyw2ICsxMDEyLDExIEBAIHZv
aWQgc2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKIAkJfQogCX0KIAorCWlmIChkb21haW5f
bWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVvZihiZGF0YS0+
aGRyKSkpIHsKKwkJdGFsbG9jX2ZyZWUoYmRhdGEpOworCQlyZXR1cm47CisJ
fQorCiAJaWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5f
aXNfdW5wcml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21z
ZWMgPSBnZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNl
YzsKIAkJaWYgKCFjb25uLT50aW1lb3V0X21zZWMpCkBAIC0zMDM5LDYgKzMw
NDksMTIgQEAgc3RhdGljIHZvaWQgYWRkX2J1ZmZlcmVkX2RhdGEoc3RydWN0
IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLAogCSAqLwogCWlmIChiZGF0YS0+aGRy
Lm1zZy50eXBlICE9IFhTX1dBVENIX0VWRU5UKQogCQlkb21haW5fb3V0c3Rh
bmRpbmdfaW5jKGNvbm4pOworCS8qCisJICogV2UgYXJlIHJlc3RvcmluZyB0
aGUgc3RhdGUgYWZ0ZXIgTGl2ZS1VcGRhdGUgYW5kIHRoZSBuZXcgcXVvdGEg
bWF5CisJICogYmUgc21hbGxlci4gU28gaWdub3JlIGl0LiBUaGUgbGltaXQg
d2lsbCBiZSBhcHBsaWVkIGZvciBhbnkgcmVzb3VyY2UKKwkgKiBhZnRlciB0
aGUgc3RhdGUgaGFzIGJlZW4gZnVsbHkgcmVzdG9yZWQuCisJICovCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVvZihi
ZGF0YS0+aGRyKSk7CiB9CiAKIHZvaWQgcmVhZF9zdGF0ZV9idWZmZXJlZF9k
YXRhKGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-13.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-13.patch"
Content-Transfer-Encoding: base64

RnJvbSA0NjI4YWUwYTU2YjAzN2RjZGM4YTNlNDJjNTQzYzViOWZkOTk5MGNm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igd2F0Y2hlcwoKQWRkIHRoZSBtZW1vcnkgYWNj
b3VudGluZyBmb3IgcmVnaXN0ZXJlZCB3YXRjaGVzLgoKV2hlbiBhIHNvY2tl
dCBjb25uZWN0aW9uIGlzIGRlc3Ryb3llZCwgdGhlIGFzc29jaWF0ZWQgd2F0
Y2hlcyBhcmUKcmVtb3ZlZCwgdG9vLiBJbiBvcmRlciB0byBrZWVwIG1lbW9y
eSBhY2NvdW50aW5nIGNvcnJlY3QgdGhlIHdhdGNoZXMKbXVzdCBiZSByZW1v
dmVkIGV4cGxpY2l0bHkgdmlhIGEgY2FsbCBvZiBjb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcygpIGZyb20KZGVzdHJveV9jb25uKCkuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggZWNhYjZjZmJiZTE1Li5k
ODY5NDJmNWFhNzcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwpAQCAtNDYzLDYgKzQ2Myw3IEBAIHN0YXRpYyBpbnQgZGVzdHJveV9j
b25uKHZvaWQgKl9jb25uKQogCX0KIAogCWNvbm5fZnJlZV9idWZmZXJlZF9k
YXRhKGNvbm4pOworCWNvbm5fZGVsZXRlX2FsbF93YXRjaGVzKGNvbm4pOwog
CWxpc3RfZm9yX2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxp
c3QpCiAJCXJlcS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwppbmRleCAwNzU1ZmZhMzc1YmEu
LmZkZjliMmQ2NTNhMCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX3dhdGNoLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X3dhdGNoLmMKQEAgLTIxMSw3ICsyMTEsNyBAQCBzdGF0aWMgaW50IGNoZWNr
X3dhdGNoX3BhdGgoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwKIH0KIAogc3RhdGljIHN0cnVjdCB3YXRjaCAqYWRkX3dhdGNo
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjaGFyICpwYXRoLCBjaGFyICp0
b2tlbiwKLQkJCSAgICAgICBib29sIHJlbGF0aXZlKQorCQkJICAgICAgIGJv
b2wgcmVsYXRpdmUsIGJvb2wgbm9fcXVvdGFfY2hlY2spCiB7CiAJc3RydWN0
IHdhdGNoICp3YXRjaDsKIApAQCAtMjIyLDYgKzIyMiw5IEBAIHN0YXRpYyBz
dHJ1Y3Qgd2F0Y2ggKmFkZF93YXRjaChzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgY2hhciAqcGF0aCwgY2hhciAqdG9rZW4sCiAJd2F0Y2gtPnRva2VuID0g
dGFsbG9jX3N0cmR1cCh3YXRjaCwgdG9rZW4pOwogCWlmICghd2F0Y2gtPm5v
ZGUgfHwgIXdhdGNoLT50b2tlbikKIAkJZ290byBub21lbTsKKwlpZiAoZG9t
YWluX21lbW9yeV9hZGQoY29ubi0+aWQsIHN0cmxlbihwYXRoKSArIHN0cmxl
bih0b2tlbiksCisJCQkgICAgICBub19xdW90YV9jaGVjaykpCisJCWdvdG8g
bm9tZW07CiAKIAlpZiAocmVsYXRpdmUpCiAJCXdhdGNoLT5yZWxhdGl2ZV9w
YXRoID0gZ2V0X2ltcGxpY2l0X3BhdGgoY29ubik7CkBAIC0yNjUsNyArMjY4
LDcgQEAgaW50IGRvX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBz
dHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJaWYgKGRvbWFpbl93YXRjaChj
b25uKSA+IHF1b3RhX25iX3dhdGNoX3Blcl9kb21haW4pCiAJCXJldHVybiBF
MkJJRzsKIAotCXdhdGNoID0gYWRkX3dhdGNoKGNvbm4sIHZlY1swXSwgdmVj
WzFdLCByZWxhdGl2ZSk7CisJd2F0Y2ggPSBhZGRfd2F0Y2goY29ubiwgdmVj
WzBdLCB2ZWNbMV0sIHJlbGF0aXZlLCBmYWxzZSk7CiAJaWYgKCF3YXRjaCkK
IAkJcmV0dXJuIGVycm5vOwogCkBAIC0yOTYsNiArMjk5LDggQEAgaW50IGRv
X3Vud2F0Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZm
ZXJlZF9kYXRhICppbikKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHdhdGNoLCAm
Y29ubi0+d2F0Y2hlcywgbGlzdCkgewogCQlpZiAoc3RyZXEod2F0Y2gtPm5v
ZGUsIG5vZGUpICYmIHN0cmVxKHdhdGNoLT50b2tlbiwgdmVjWzFdKSkgewog
CQkJbGlzdF9kZWwoJndhdGNoLT5saXN0KTsKKwkJCWRvbWFpbl9tZW1vcnlf
YWRkX25vY2hrKGNvbm4tPmlkLCAtc3RybGVuKHdhdGNoLT5ub2RlKSAtCisJ
CQkJCQkJICBzdHJsZW4od2F0Y2gtPnRva2VuKSk7CiAJCQl0YWxsb2NfZnJl
ZSh3YXRjaCk7CiAJCQlkb21haW5fd2F0Y2hfZGVjKGNvbm4pOwogCQkJc2Vu
ZF9hY2soY29ubiwgWFNfVU5XQVRDSCk7CkBAIC0zMTEsNiArMzE2LDggQEAg
dm9pZCBjb25uX2RlbGV0ZV9hbGxfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXdoaWxlICgod2F0Y2ggPSBsaXN0X3RvcCgmY29ubi0+
d2F0Y2hlcywgc3RydWN0IHdhdGNoLCBsaXN0KSkpIHsKIAkJbGlzdF9kZWwo
JndhdGNoLT5saXN0KTsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsoY29u
bi0+aWQsIC1zdHJsZW4od2F0Y2gtPm5vZGUpIC0KKwkJCQkJCSAgc3RybGVu
KHdhdGNoLT50b2tlbikpOwogCQl0YWxsb2NfZnJlZSh3YXRjaCk7CiAJCWRv
bWFpbl93YXRjaF9kZWMoY29ubik7CiAJfQpAQCAtMzczLDcgKzM4MCw3IEBA
IHZvaWQgcmVhZF9zdGF0ZV93YXRjaChjb25zdCB2b2lkICpjdHgsIGNvbnN0
IHZvaWQgKnN0YXRlKQogCWlmICghcGF0aCkKIAkJYmFyZigiYWxsb2NhdGlv
biBlcnJvciBmb3IgcmVhZCB3YXRjaCIpOwogCi0JaWYgKCFhZGRfd2F0Y2go
Y29ubiwgcGF0aCwgdG9rZW4sIHJlbGF0aXZlKSkKKwlpZiAoIWFkZF93YXRj
aChjb25uLCBwYXRoLCB0b2tlbiwgcmVsYXRpdmUsIHRydWUpKQogCQliYXJm
KCJlcnJvciBhZGRpbmcgd2F0Y2giKTsKIH0KIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-14.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-14.patch"
Content-Transfer-Encoding: base64

RnJvbSBiOGJkNzRlNWU5NjI5NTUyMTFhYjBjNWMxOTI0ZWJmMmJiNTI2Nzk5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igbm9kZXMKCkFkZCB0aGUgbWVtb3J5IGFjY291
bnRpbmcgZm9yIFhlbnN0b3JlIG5vZGVzLiBJbiBvcmRlciB0byBtYWtlIHRo
aXMKbm90IHRvbyBjb21wbGljYXRlZCBhbGxvdyBmb3Igc29tZSBzbG9wcGlu
ZXNzIHdoZW4gd3JpdGluZyBub2Rlcy4gQW55CmhhcmQgcXVvdGEgdmlvbGF0
aW9uIHdpbGwgcmVzdWx0IGluIG5vIGZ1cnRoZXIgcmVxdWVzdHMgdG8gYmUg
YWNjZXB0ZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIy
LTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKaW5kZXggZDg2OTQyZjVhYTc3Li4xNjUwNGRlNDIwMTcgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNTkxLDYgKzU5MSwx
MTcgQEAgdm9pZCBzZXRfdGRiX2tleShjb25zdCBjaGFyICpuYW1lLCBUREJf
REFUQSAqa2V5KQogCWtleS0+ZHNpemUgPSBzdHJsZW4obmFtZSk7CiB9CiAK
K3N0YXRpYyB2b2lkIGdldF9hY2NfZGF0YShUREJfREFUQSAqa2V5LCBzdHJ1
Y3Qgbm9kZV9hY2NvdW50X2RhdGEgKmFjYykKK3sKKwlUREJfREFUQSBvbGRf
ZGF0YTsKKwlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKKworCWlm
IChhY2MtPm1lbW9yeSA8IDApIHsKKwkJb2xkX2RhdGEgPSB0ZGJfZmV0Y2go
dGRiX2N0eCwgKmtleSk7CisJCS8qIE5vIGNoZWNrIGZvciBlcnJvciwgYXMg
dGhlIG5vZGUgbWlnaHQgbm90IGV4aXN0LiAqLworCQlpZiAob2xkX2RhdGEu
ZHB0ciA9PSBOVUxMKSB7CisJCQlhY2MtPm1lbW9yeSA9IDA7CisJCX0gZWxz
ZSB7CisJCQloZHIgPSAodm9pZCAqKW9sZF9kYXRhLmRwdHI7CisJCQlhY2Mt
Pm1lbW9yeSA9IG9sZF9kYXRhLmRzaXplOworCQkJYWNjLT5kb21pZCA9IGhk
ci0+cGVybXNbMF0uaWQ7CisJCX0KKwkJdGFsbG9jX2ZyZWUob2xkX2RhdGEu
ZHB0cik7CisJfQorfQorCisvKgorICogUGVyLXRyYW5zYWN0aW9uIG5vZGVz
IG5lZWQgdG8gYmUgYWNjb3VudGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gb3du
ZXIuCisgKiBUaG9zZSBub2RlcyBhcmUgc3RvcmVkIGluIHRoZSBkYXRhIGJh
c2Ugd2l0aCB0aGUgdHJhbnNhY3Rpb24gZ2VuZXJhdGlvbgorICogY291bnQg
cHJlcGVuZGVkIChlLmcuIDEyMy9sb2NhbC9kb21haW4vLi4uKS4gU28gdGVz
dGluZyBmb3IgdGhlIG5vZGUncworICoga2V5IG5vdCB0byBzdGFydCB3aXRo
ICIvIiBpcyBzdWZmaWNpZW50LgorICovCitzdGF0aWMgdW5zaWduZWQgaW50
IGdldF9hY2NfZG9taWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9E
QVRBICprZXksCisJCQkJICB1bnNpZ25lZCBpbnQgZG9taWQpCit7CisJcmV0
dXJuICghY29ubiB8fCBrZXktPmRwdHJbMF0gPT0gJy8nKSA/IGRvbWlkIDog
Y29ubi0+aWQ7Cit9CisKK2ludCBkb190ZGJfd3JpdGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFREQl9EQVRBICpkYXRhLAor
CQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MsIGJvb2wgbm9fcXVv
dGFfY2hlY2spCit7CisJc3RydWN0IHhzX3RkYl9yZWNvcmRfaGRyICpoZHIg
PSAodm9pZCAqKWRhdGEtPmRwdHI7CisJc3RydWN0IG5vZGVfYWNjb3VudF9k
YXRhIG9sZF9hY2MgPSB7fTsKKwl1bnNpZ25lZCBpbnQgb2xkX2RvbWlkLCBu
ZXdfZG9taWQ7CisJaW50IHJldDsKKworCWlmICghYWNjKQorCQlvbGRfYWNj
Lm1lbW9yeSA9IC0xOworCWVsc2UKKwkJb2xkX2FjYyA9ICphY2M7CisKKwln
ZXRfYWNjX2RhdGEoa2V5LCAmb2xkX2FjYyk7CisJb2xkX2RvbWlkID0gZ2V0
X2FjY19kb21pZChjb25uLCBrZXksIG9sZF9hY2MuZG9taWQpOworCW5ld19k
b21pZCA9IGdldF9hY2NfZG9taWQoY29ubiwga2V5LCBoZHItPnBlcm1zWzBd
LmlkKTsKKworCS8qCisJICogRG9uJ3QgY2hlY2sgZm9yIEVOT0VOVCwgYXMg
d2Ugd2FudCB0byBiZSBhYmxlIHRvIHN3aXRjaCBvcnBoYW5lZAorCSAqIG5v
ZGVzIHRvIG5ldyBvd25lcnMuCisJICovCisJaWYgKG9sZF9hY2MubWVtb3J5
KQorCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRfZG9taWQsCisJCQkJ
CS1vbGRfYWNjLm1lbW9yeSAtIGtleS0+ZHNpemUpOworCXJldCA9IGRvbWFp
bl9tZW1vcnlfYWRkKG5ld19kb21pZCwgZGF0YS0+ZHNpemUgKyBrZXktPmRz
aXplLAorCQkJCW5vX3F1b3RhX2NoZWNrKTsKKwlpZiAocmV0KSB7CisJCS8q
IEVycm9yIHBhdGgsIHNvIG5vIHF1b3RhIGNoZWNrLiAqLworCQlpZiAob2xk
X2FjYy5tZW1vcnkpCisJCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRf
ZG9taWQsCisJCQkJCQlvbGRfYWNjLm1lbW9yeSArIGtleS0+ZHNpemUpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCS8qIFREQiBzaG91bGQgc2V0IGVycm5v
LCBidXQgZG9lc24ndCBldmVuIHNldCBlY29kZSBBRkFJQ1QuICovCisJaWYg
KHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCAqZGF0YSwgVERCX1JFUExBQ0Up
ICE9IDApIHsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsobmV3X2RvbWlk
LCAtZGF0YS0+ZHNpemUgLSBrZXktPmRzaXplKTsKKwkJLyogRXJyb3IgcGF0
aCwgc28gbm8gcXVvdGEgY2hlY2suICovCisJCWlmIChvbGRfYWNjLm1lbW9y
eSkKKwkJCWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKG9sZF9kb21pZCwKKwkJ
CQkJCW9sZF9hY2MubWVtb3J5ICsga2V5LT5kc2l6ZSk7CisJCWVycm5vID0g
RUlPOworCQlyZXR1cm4gZXJybm87CisJfQorCisJaWYgKGFjYykgeworCQkv
KiBEb24ndCB1c2UgbmV3X2RvbWlkLCBhcyBpdCBtaWdodCBiZSBhIHRyYW5z
YWN0aW9uIG5vZGUuICovCisJCWFjYy0+ZG9taWQgPSBoZHItPnBlcm1zWzBd
LmlkOworCQlhY2MtPm1lbW9yeSA9IGRhdGEtPmRzaXplOworCX0KKworCXJl
dHVybiAwOworfQorCitpbnQgZG9fdGRiX2RlbGV0ZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwKKwkJICBzdHJ1Y3Qgbm9kZV9h
Y2NvdW50X2RhdGEgKmFjYykKK3sKKwlzdHJ1Y3Qgbm9kZV9hY2NvdW50X2Rh
dGEgdG1wX2FjYzsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisKKwlpZiAoIWFj
YykgeworCQlhY2MgPSAmdG1wX2FjYzsKKwkJYWNjLT5tZW1vcnkgPSAtMTsK
Kwl9CisKKwlnZXRfYWNjX2RhdGEoa2V5LCBhY2MpOworCisJaWYgKHRkYl9k
ZWxldGUodGRiX2N0eCwgKmtleSkpIHsKKwkJZXJybm8gPSBFSU87CisJCXJl
dHVybiBlcnJubzsKKwl9CisKKwlpZiAoYWNjLT5tZW1vcnkpIHsKKwkJZG9t
aWQgPSBnZXRfYWNjX2RvbWlkKGNvbm4sIGtleSwgYWNjLT5kb21pZCk7CisJ
CWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKGRvbWlkLCAtYWNjLT5tZW1vcnkg
LSBrZXktPmRzaXplKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwogLyoKICAq
IElmIGl0IGZhaWxzLCByZXR1cm5zIE5VTEwgYW5kIHNldHMgZXJybm8uCiAg
KiBUZW1wb3JhcnkgbWVtb3J5IGFsbG9jYXRpb25zIHdpbGwgYmUgZG9uZSB3
aXRoIGN0eC4KQEAgLTY0NCw5ICs3NTUsMTUgQEAgc3RydWN0IG5vZGUgKnJl
YWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAq
Y3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVjdCB4c19wZXJtaXNz
aW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5wZXJtczsKKwlub2Rl
LT5hY2MuZG9taWQgPSBub2RlLT5wZXJtcy5wWzBdLmlkOworCW5vZGUtPmFj
Yy5tZW1vcnkgPSBkYXRhLmRzaXplOwogCWlmIChkb21haW5fYWRqdXN0X25v
ZGVfcGVybXMoY29ubiwgbm9kZSkpCiAJCWdvdG8gZXJyb3I7CiAKKwkvKiBJ
ZiBvd25lciBpcyBnb25lIHJlc2V0IGN1cnJlbnRseSBhY2NvdW50ZWQgbWVt
b3J5IHNpemUuICovCisJaWYgKG5vZGUtPmFjYy5kb21pZCAhPSBub2RlLT5w
ZXJtcy5wWzBdLmlkKQorCQlub2RlLT5hY2MubWVtb3J5ID0gMDsKKwogCS8q
IERhdGEgaXMgYmluYXJ5IGJsb2IgKHVzdWFsbHkgYXNjaWksIG5vIG51bCku
ICovCiAJbm9kZS0+ZGF0YSA9IG5vZGUtPnBlcm1zLnAgKyBoZHItPm51bV9w
ZXJtczsKIAkvKiBDaGlsZHJlbiBpcyBzdHJpbmdzLCBudWwgc2VwYXJhdGVk
LiAqLwpAQCAtNzE1LDEyICs4MzIsOSBAQCBpbnQgd3JpdGVfbm9kZV9yYXco
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIHN0cnVj
dCBub2RlICpub2RlLAogCXAgKz0gbm9kZS0+ZGF0YWxlbjsKIAltZW1jcHko
cCwgbm9kZS0+Y2hpbGRyZW4sIG5vZGUtPmNoaWxkbGVuKTsKIAotCS8qIFRE
QiBzaG91bGQgc2V0IGVycm5vLCBidXQgZG9lc24ndCBldmVuIHNldCBlY29k
ZSBBRkFJQ1QuICovCi0JaWYgKHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCBk
YXRhLCBUREJfUkVQTEFDRSkgIT0gMCkgewotCQljb3JydXB0KGNvbm4sICJX
cml0ZSBvZiAlcyBmYWlsZWQiLCBrZXktPmRwdHIpOwotCQllcnJubyA9IEVJ
TzsKLQkJcmV0dXJuIGVycm5vOwotCX0KKwlpZiAoZG9fdGRiX3dyaXRlKGNv
bm4sIGtleSwgJmRhdGEsICZub2RlLT5hY2MsIG5vX3F1b3RhX2NoZWNrKSkK
KwkJcmV0dXJuIEVJTzsKKwogCXJldHVybiAwOwogfQogCkBAIC0xMjIyLDcg
KzEzMzYsNyBAQCBzdGF0aWMgdm9pZCBkZWxldGVfbm9kZV9zaW5nbGUoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogCWlm
IChhY2Nlc3Nfbm9kZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19ERUxFVEUs
ICZrZXkpKQogCQlyZXR1cm47CiAKLQlpZiAodGRiX2RlbGV0ZSh0ZGJfY3R4
LCBrZXkpICE9IDApIHsKKwlpZiAoZG9fdGRiX2RlbGV0ZShjb25uLCAma2V5
LCAmbm9kZS0+YWNjKSAhPSAwKSB7CiAJCWNvcnJ1cHQoY29ubiwgIkNvdWxk
IG5vdCBkZWxldGUgJyVzJyIsIG5vZGUtPm5hbWUpOwogCQlyZXR1cm47CiAJ
fQpAQCAtMTI5NSw2ICsxNDA5LDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpj
b25zdHJ1Y3Rfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
dm9pZCAqY3R4LAogCS8qIE5vIGNoaWxkcmVuLCBubyBkYXRhICovCiAJbm9k
ZS0+Y2hpbGRyZW4gPSBub2RlLT5kYXRhID0gTlVMTDsKIAlub2RlLT5jaGls
ZGxlbiA9IG5vZGUtPmRhdGFsZW4gPSAwOworCW5vZGUtPmFjYy5tZW1vcnkg
PSAwOwogCW5vZGUtPnBhcmVudCA9IHBhcmVudDsKIAlyZXR1cm4gbm9kZTsK
IApAQCAtMTMwMywxNyArMTQxOCwxNyBAQCBzdGF0aWMgc3RydWN0IG5vZGUg
KmNvbnN0cnVjdF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRpYyB2b2lk
IGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3Qgbm9kZSAqbm9kZSkKK3N0YXRpYyB2
b2lkIGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
c3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJaWYgKHN0cmVxKG5vZGUtPm5hbWUs
ICIvIikpCiAJCWNvcnJ1cHQoTlVMTCwgIkRlc3Ryb3lpbmcgcm9vdCBub2Rl
ISIpOwogCi0JdGRiX2RlbGV0ZSh0ZGJfY3R4LCBub2RlLT5rZXkpOworCWRv
X3RkYl9kZWxldGUoY29ubiwgJm5vZGUtPmtleSwgJm5vZGUtPmFjYyk7CiB9
CiAKIHN0YXRpYyBpbnQgZGVzdHJveV9ub2RlKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKLQlkZXN0cm95X25vZGVf
cm0obm9kZSk7CisJZGVzdHJveV9ub2RlX3JtKGNvbm4sIG5vZGUpOwogCWRv
bWFpbl9lbnRyeV9kZWMoY29ubiwgbm9kZSk7CiAKIAkvKgpAQCAtMTM2NSw3
ICsxNDgwLDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpjcmVhdGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkv
KiBBY2NvdW50IGZvciBuZXcgbm9kZSAqLwogCQlpZiAoaS0+cGFyZW50KSB7
CiAJCQlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBpKSkgewotCQkJCWRl
c3Ryb3lfbm9kZV9ybShpKTsKKwkJCQlkZXN0cm95X25vZGVfcm0oY29ubiwg
aSk7CiAJCQkJcmV0dXJuIE5VTEw7CiAJCQl9CiAJCX0KQEAgLTIyOTEsNyAr
MjQwNiw3IEBAIHN0YXRpYyBpbnQgY2xlYW5fc3RvcmVfKFREQl9DT05URVhU
ICp0ZGIsIFREQl9EQVRBIGtleSwgVERCX0RBVEEgdmFsLAogCWlmICghaGFz
aHRhYmxlX3NlYXJjaChyZWFjaGFibGUsIG5hbWUpKSB7CiAJCWxvZygiY2xl
YW5fc3RvcmU6ICclcycgaXMgb3JwaGFuZWQhIiwgbmFtZSk7CiAJCWlmIChy
ZWNvdmVyeSkgewotCQkJdGRiX2RlbGV0ZSh0ZGIsIGtleSk7CisJCQlkb190
ZGJfZGVsZXRlKE5VTEwsICZrZXksIE5VTEwpOwogCQl9CiAJfQogCkBAIC0z
MTQ5LDYgKzMyNjQsNyBAQCB2b2lkIHJlYWRfc3RhdGVfbm9kZShjb25zdCB2
b2lkICpjdHgsIGNvbnN0IHZvaWQgKnN0YXRlKQogCWlmICghbm9kZSkKIAkJ
YmFyZigiYWxsb2NhdGlvbiBlcnJvciByZXN0b3Jpbmcgbm9kZSIpOwogCisJ
bm9kZS0+YWNjLm1lbW9yeSA9IDA7CiAJbm9kZS0+bmFtZSA9IG5hbWU7CiAJ
bm9kZS0+Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAlub2RlLT5kYXRh
bGVuID0gc24tPmRhdGFfbGVuOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggMzczYWYxODI5N2JmLi5kYTllY2NlNjdmMzEgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMTc2LDYg
KzE3NiwxMSBAQCBzdHJ1Y3Qgbm9kZV9wZXJtcyB7CiAJc3RydWN0IHhzX3Bl
cm1pc3Npb25zICpwOwogfTsKIAorc3RydWN0IG5vZGVfYWNjb3VudF9kYXRh
IHsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisJaW50IG1lbW9yeTsJCS8qIC0x
IGlmIHVua25vd24gKi8KK307CisKIHN0cnVjdCBub2RlIHsKIAljb25zdCBj
aGFyICpuYW1lOwogCS8qIEtleSB1c2VkIHRvIHVwZGF0ZSBUREIgKi8KQEAg
LTE5OCw2ICsyMDMsOSBAQCBzdHJ1Y3Qgbm9kZSB7CiAJLyogQ2hpbGRyZW4s
IGVhY2ggbnVsLXRlcm1pbmF0ZWQuICovCiAJdW5zaWduZWQgaW50IGNoaWxk
bGVuOwogCWNoYXIgKmNoaWxkcmVuOworCisJLyogQWxsb2NhdGlvbiBpbmZv
cm1hdGlvbiBmb3Igbm9kZSBjdXJyZW50bHkgaW4gc3RvcmUuICovCisJc3Ry
dWN0IG5vZGVfYWNjb3VudF9kYXRhIGFjYzsKIH07CiAKIC8qIFJldHVybiB0
aGUgb25seSBhcmd1bWVudCBpbiB0aGUgaW5wdXQuICovCkBAIC0zMDYsNiAr
MzE0LDEwIEBAIGV4dGVybiB4ZW5nbnR0YWJfaGFuZGxlICoqeGd0X2hhbmRs
ZTsKIGludCByZW1lbWJlcl9zdHJpbmcoc3RydWN0IGhhc2h0YWJsZSAqaGFz
aCwgY29uc3QgY2hhciAqc3RyKTsKIAogdm9pZCBzZXRfdGRiX2tleShjb25z
dCBjaGFyICpuYW1lLCBUREJfREFUQSAqa2V5KTsKK2ludCBkb190ZGJfd3Jp
dGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFRE
Ql9EQVRBICpkYXRhLAorCQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICph
Y2MsIGJvb2wgbm9fcXVvdGFfY2hlY2spOworaW50IGRvX3RkYl9kZWxldGUo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksCisJCSAg
c3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MpOwogCiB2b2lkIGNvbm5f
ZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsK
IApkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5z
YWN0aW9uLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rp
b24uYwppbmRleCA3YmQ0MWViNDc1ZTMuLmFjZTlhMTFkNzdiYiAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMK
KysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMK
QEAgLTE1Myw2ICsxNTMsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBM
aXN0IG9mIGFsbCB0cmFuc2FjdGlvbnMgYWN0aXZlIG9uIHRoaXMgY29ubmVj
dGlvbi4gKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CiAKKwkvKiBDb25u
ZWN0aW9uIHRoaXMgdHJhbnNhY3Rpb24gaXMgYXNzb2NpYXRlZCB3aXRoLiAq
LworCXN0cnVjdCBjb25uZWN0aW9uICpjb25uOworCiAJLyogQ29ubmVjdGlv
bi1sb2NhbCBpZGVudGlmaWVyIGZvciB0aGlzIHRyYW5zYWN0aW9uLiAqLwog
CXVpbnQzMl90IGlkOwogCkBAIC0yODYsNiArMjg5LDggQEAgaW50IGFjY2Vz
c19ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAq
bm9kZSwKIAogCQlpbnRyb2R1Y2UgPSB0cnVlOwogCQlpLT50YV9ub2RlID0g
ZmFsc2U7CisJCS8qIGFjYy5tZW1vcnkgPCAwIG1lYW5zICJ1bmtub3duLCBn
ZXQgc2l6ZSBmcm9tIFREQiIuICovCisJCW5vZGUtPmFjYy5tZW1vcnkgPSAt
MTsKIAogCQkvKgogCQkgKiBBZGRpdGlvbmFsIHRyYW5zYWN0aW9uLXNwZWNp
ZmljIG5vZGUgZm9yIHJlYWQgdHlwZS4gV2Ugb25seQpAQCAtNDEwLDExICs0
MTUsMTEgQEAgc3RhdGljIGludCBmaW5hbGl6ZV90cmFuc2FjdGlvbihzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKIAkJCQkJZ290byBlcnI7CiAJCQkJaGRy
ID0gKHZvaWQgKilkYXRhLmRwdHI7CiAJCQkJaGRyLT5nZW5lcmF0aW9uID0g
KytnZW5lcmF0aW9uOwotCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJfY3R4LCBr
ZXksIGRhdGEsCi0JCQkJCQlUREJfUkVQTEFDRSk7CisJCQkJcmV0ID0gZG9f
dGRiX3dyaXRlKGNvbm4sICZrZXksICZkYXRhLCBOVUxMLAorCQkJCQkJICAg
dHJ1ZSk7CiAJCQkJdGFsbG9jX2ZyZWUoZGF0YS5kcHRyKTsKIAkJCX0gZWxz
ZSB7Ci0JCQkJcmV0ID0gdGRiX2RlbGV0ZSh0ZGJfY3R4LCBrZXkpOworCQkJ
CXJldCA9IGRvX3RkYl9kZWxldGUoY29ubiwgJmtleSwgTlVMTCk7CiAJCQl9
CiAJCQlpZiAocmV0KQogCQkJCWdvdG8gZXJyOwpAQCAtNDI1LDcgKzQzMCw3
IEBAIHN0YXRpYyBpbnQgZmluYWxpemVfdHJhbnNhY3Rpb24oc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sCiAJCQl9CiAJCX0KIAotCQlpZiAoaS0+dGFfbm9k
ZSAmJiB0ZGJfZGVsZXRlKHRkYl9jdHgsIHRhX2tleSkpCisJCWlmIChpLT50
YV9ub2RlICYmIGRvX3RkYl9kZWxldGUoY29ubiwgJnRhX2tleSwgTlVMTCkp
CiAJCQlnb3RvIGVycjsKIAkJbGlzdF9kZWwoJmktPmxpc3QpOwogCQl0YWxs
b2NfZnJlZShpKTsKQEAgLTQ1Myw3ICs0NTgsNyBAQCBzdGF0aWMgaW50IGRl
c3Ryb3lfdHJhbnNhY3Rpb24odm9pZCAqX3RyYW5zYWN0aW9uKQogCQkJCQkJ
CSAgICAgICBpLT5ub2RlKTsKIAkJCWlmICh0cmFuc19uYW1lKSB7CiAJCQkJ
c2V0X3RkYl9rZXkodHJhbnNfbmFtZSwgJmtleSk7Ci0JCQkJdGRiX2RlbGV0
ZSh0ZGJfY3R4LCBrZXkpOworCQkJCWRvX3RkYl9kZWxldGUodHJhbnMtPmNv
bm4sICZrZXksIE5VTEwpOwogCQkJfQogCQl9CiAJCWxpc3RfZGVsKCZpLT5s
aXN0KTsKQEAgLTQ5Nyw2ICs1MDIsNyBAQCBpbnQgZG9fdHJhbnNhY3Rpb25f
c3RhcnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJl
ZF9kYXRhICppbikKIAogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+YWNjZXNz
ZWQpOwogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+Y2hhbmdlZF9kb21haW5z
KTsKKwl0cmFucy0+Y29ubiA9IGNvbm47CiAJdHJhbnMtPmZhaWwgPSBmYWxz
ZTsKIAl0cmFucy0+Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-15.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-15.patch"
Content-Transfer-Encoding: base64

RnJvbSBjNTVhMWVhMGE1ZWE3ZjZhM2RjODUwY2IwMTVhNDliYTllYzU3MWFi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBleHBv
cnRzIGZvciBxdW90YSB2YXJpYWJsZXMKClNvbWUgcXVvdGEgdmFyaWFibGVz
IGFyZSBub3QgZXhwb3J0ZWQgdmlhIGhlYWRlciBmaWxlcy4KClRoaXMgaXMg
cGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggZGE5ZWNjZTY3ZjMxLi5iZmQzZmMxZTlkZjMgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjc1LDYg
KzI3NSwxMSBAQCBleHRlcm4gVERCX0NPTlRFWFQgKnRkYl9jdHg7CiBleHRl
cm4gaW50IGRvbTBfZG9taWQ7CiBleHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBl
eHRlcm4gaW50IHByaXZfZG9taWQ7CitleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CitleHRlcm4gaW50IHF1b3RhX21heF90cmFuc2Fj
dGlvbjsKK2V4dGVybiBpbnQgcXVvdGFfbWF4X2VudHJ5X3NpemU7CitleHRl
cm4gaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlOworZXh0ZXJuIGludCBx
dW90YV9tYXhfcGF0aF9sZW47CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5
X3Blcl9kb21haW47CiBleHRlcm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CmRpZmYgLS1naXQg
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGFj
ZTlhMTFkNzdiYi4uMjg3NzQ4MTNkZTgzIDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtMTc1LDcgKzE3
NSw2IEBAIHN0cnVjdCB0cmFuc2FjdGlvbgogCWJvb2wgZmFpbDsKIH07CiAK
LWV4dGVybiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uOwogdWludDY0X3Qg
Z2VuZXJhdGlvbjsKIAogc3RhdGljIHN0cnVjdCBhY2Nlc3NlZF9ub2RlICpm
aW5kX2FjY2Vzc2VkX25vZGUoc3RydWN0IHRyYW5zYWN0aW9uICp0cmFucywK
ZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggZmRm
OWIyZDY1M2EwLi44NTM2MmJjY2UzMTQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF93YXRjaC5jCkBAIC0zMSw4ICszMSw2IEBACiAjaW5jbHVk
ZSAieGVuc3RvcmVkX2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90
cmFuc2FjdGlvbi5oIgogCi1leHRlcm4gaW50IHF1b3RhX25iX3dhdGNoX3Bl
cl9kb21haW47Ci0KIHN0cnVjdCB3YXRjaAogewogCS8qIFdhdGNoZXMgb24g
dGhpcyBjb25uZWN0aW9uICovCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-4.16-xenstored-16.patch"
Content-Disposition: attachment;
 filename="xsa326/xsa326-4.16-xenstored-16.patch"
Content-Transfer-Encoding: base64

RnJvbSAwNWNjMmFmNTBiYTQzNDMxZDZkNTBhZmY3NThlOTY4ODMzYWFiOWM2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBjb250
cm9sIGNvbW1hbmQgZm9yIHNldHRpbmcgYW5kIHNob3dpbmcgcXVvdGEKCkFk
ZCBhIHhlbnN0b3JlLWNvbnRyb2wgY29tbWFuZCAicXVvdGEiIHRvOgotIHNo
b3cgY3VycmVudCBxdW90YSBzZXR0aW5ncwotIGNoYW5nZSBxdW90YSBzZXR0
aW5ncwotIHNob3cgY3VycmVudCBxdW90YSByZWxhdGVkIHZhbHVlcyBvZiBh
IGRvbWFpbgoKTm90ZSB0aGF0IGluIHRoZSBjYXNlIHRoZSBuZXcgcXVvdGEg
aXMgbG93ZXIgdGhhbiBleGlzdGluZyBvbmUsClhlbnN0b3JlZCBtYXkgY29u
dGludWUgdG8gaGFuZGxlIHJlcXVlc3RzIGZyb20gYSBkb21haW4gZXhjZWVk
aW5nIHRoZQpuZXcgbGltaXQgKGRlcGVuZHMgb24gd2hpY2ggb25lIGhhcyBi
ZWVuIGJyb2tlbikgYW5kIHRoZSBhbW91bnQgb2YKcmVzb3VyY2UgdXNlZCB3
aWxsIG5vdCBjaGFuZ2UuIEhvd2V2ZXIgdGhlIGRvbWFpbiB3aWxsIG5vdCBi
ZSBhYmxlIHRvCmNyZWF0ZSBtb3JlIHJlc291cmNlIChhc3NvY2lhdGVkIHRv
IHRoZSBxdW90YSkgdW50aWwgaXQgaXMgYmFjayB0byBiZWxvdwp0aGUgbGlt
aXQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNi4KClJlcG9ydGVkLWJ5OiBK
dWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5
OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdp
dCBhL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQgYi9kb2NzL21pc2MveGVuc3Rv
cmUudHh0CmluZGV4IDMzNGRjOGI2ZmRmNS4uYTdkMDA2NTE5YWU4IDEwMDY0
NAotLS0gYS9kb2NzL21pc2MveGVuc3RvcmUudHh0CisrKyBiL2RvY3MvbWlz
Yy94ZW5zdG9yZS50eHQKQEAgLTM2Niw2ICszNjYsMTcgQEAgQ09OVFJPTAkJ
CTxjb21tYW5kPnxbPHBhcmFtZXRlcnM+fF0KIAlwcmludHw8c3RyaW5nPgog
CQlwcmludCA8c3RyaW5nPiB0byBzeXNsb2cgKHhlbnN0b3JlIHJ1bnMgYXMg
ZGFlbW9uKSBvcgogCQl0byBjb25zb2xlICh4ZW5zdG9yZSBydW5zIGFzIHN0
dWJkb20pCisJcXVvdGF8W3NldCA8bmFtZT4gPHZhbD58PGRvbWlkPl0KKwkJ
d2l0aG91dCBwYXJhbWV0ZXJzOiBwcmludCB0aGUgY3VycmVudCBxdW90YSBz
ZXR0aW5ncworCQl3aXRoICJzZXQgPG5hbWU+IDx2YWw+Ijogc2V0IHRoZSBx
dW90YSA8bmFtZT4gdG8gbmV3IHZhbHVlCisJCTx2YWw+IChUaGUgYWRtaW4g
c2hvdWxkIG1ha2Ugc3VyZSBhbGwgdGhlIGRvbWFpbiB1c2FnZSBpcworCQli
ZWxvdyB0aGUgcXVvdGEuIElmIGl0IGlzIG5vdCwgdGhlbiBYZW5zdG9yZWQg
bWF5IGNvbnRpbnVlIHRvCisJCWhhbmRsZSByZXF1ZXN0cyBmcm9tIHRoZSBk
b21haW4gYXMgbG9uZyBhcyB0aGUgcmVzb3VyY2UKKwkJdmlvbGF0aW5nIHRo
ZSBuZXcgcXVvdGEgc2V0dGluZyBpc24ndCBpbmNyZWFzZWQgZnVydGhlcikK
KwkJd2l0aCAiPGRvbWlkPiI6IHByaW50IHF1b3RhIHJlbGF0ZWQgYWNjb3Vu
dGluZyBkYXRhIGZvcgorCQl0aGUgZG9tYWluIDxkb21pZD4KKwlxdW90YS1z
b2Z0fFtzZXQgPG5hbWU+IDx2YWw+XQorCQlsaWtlIHRoZSAicXVvdGEiIGNv
bW1hbmQsIGJ1dCBmb3Igc29mdC1xdW90YS4KIAloZWxwCQkJPHN1cHBvcnRl
ZC1jb21tYW5kcz4KIAkJcmV0dXJuIGxpc3Qgb2Ygc3VwcG9ydGVkIGNvbW1h
bmRzIGZvciBDT05UUk9MCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCmluZGV4IGFkYjhkNTFiMDQzYi4uMTAzMWE4MWMzODc0
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJv
bC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMK
QEAgLTE5Niw2ICsxOTYsMTE1IEBAIHN0YXRpYyBpbnQgZG9fY29udHJvbF9s
b2codm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKIAlyZXR1
cm4gMDsKIH0KIAorc3RydWN0IHF1b3RhIHsKKwljb25zdCBjaGFyICpuYW1l
OworCWludCAqcXVvdGE7CisJY29uc3QgY2hhciAqZGVzY3I7Cit9OworCitz
dGF0aWMgY29uc3Qgc3RydWN0IHF1b3RhIGhhcmRfcXVvdGFzW10gPSB7CisJ
eyAibm9kZXMiLCAmcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbiwgIk5vZGVz
IHBlciBkb21haW4iIH0sCisJeyAid2F0Y2hlcyIsICZxdW90YV9uYl93YXRj
aF9wZXJfZG9tYWluLCAiV2F0Y2hlcyBwZXIgZG9tYWluIiB9LAorCXsgInRy
YW5zYWN0aW9ucyIsICZxdW90YV9tYXhfdHJhbnNhY3Rpb24sICJUcmFuc2Fj
dGlvbnMgcGVyIGRvbWFpbiIgfSwKKwl7ICJvdXRzdGFuZGluZyIsICZxdW90
YV9yZXFfb3V0c3RhbmRpbmcsCisJCSJPdXRzdGFuZGluZyByZXF1ZXN0cyBw
ZXIgZG9tYWluIiB9LAorCXsgInRyYW5zYWN0aW9uLW5vZGVzIiwgJnF1b3Rh
X3RyYW5zX25vZGVzLAorCQkiTWF4LiBudW1iZXIgb2YgYWNjZXNzZWQgbm9k
ZXMgcGVyIHRyYW5zYWN0aW9uIiB9LAorCXsgIm1lbW9yeSIsICZxdW90YV9t
ZW1vcnlfcGVyX2RvbWFpbl9oYXJkLAorCQkiVG90YWwgWGVuc3RvcmUgbWVt
b3J5IHBlciBkb21haW4gKGVycm9yIGxldmVsKSIgfSwKKwl7ICJub2RlLXNp
emUiLCAmcXVvdGFfbWF4X2VudHJ5X3NpemUsICJNYXguIHNpemUgb2YgYSBu
b2RlIiB9LAorCXsgInBhdGgtbWF4IiwgJnF1b3RhX21heF9wYXRoX2xlbiwg
Ik1heC4gbGVuZ3RoIG9mIGEgbm9kZSBwYXRoIiB9LAorCXsgInBlcm1pc3Np
b25zIiwgJnF1b3RhX25iX3Blcm1zX3Blcl9ub2RlLAorCQkiTWF4LiBudW1i
ZXIgb2YgcGVybWlzc2lvbnMgcGVyIG5vZGUiIH0sCisJeyBOVUxMLCBOVUxM
LCBOVUxMIH0KK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcXVvdGEgc29m
dF9xdW90YXNbXSA9IHsKKwl7ICJtZW1vcnkiLCAmcXVvdGFfbWVtb3J5X3Bl
cl9kb21haW5fc29mdCwKKwkJIlRvdGFsIFhlbnN0b3JlIG1lbW9yeSBwZXIg
ZG9tYWluICh3YXJuaW5nIGxldmVsKSIgfSwKKwl7IE5VTEwsIE5VTEwsIE5V
TEwgfQorfTsKKworc3RhdGljIGludCBxdW90YV9zaG93X2N1cnJlbnQoY29u
c3Qgdm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJCSAg
ICAgIGNvbnN0IHN0cnVjdCBxdW90YSAqcXVvdGFzKQoreworCWNoYXIgKnJl
c3A7CisJdW5zaWduZWQgaW50IGk7CisKKwlyZXNwID0gdGFsbG9jX3N0cmR1
cChjdHgsICJRdW90YSBzZXR0aW5nczpcbiIpOworCWlmICghcmVzcCkKKwkJ
cmV0dXJuIEVOT01FTTsKKworCWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90
YTsgaSsrKSB7CisJCXJlc3AgPSB0YWxsb2NfYXNwcmludGZfYXBwZW5kKHJl
c3AsICIlLTE3czogJThkICVzXG4iLAorCQkJCQkgICAgICBxdW90YXNbaV0u
bmFtZSwgKnF1b3Rhc1tpXS5xdW90YSwKKwkJCQkJICAgICAgcXVvdGFzW2ld
LmRlc2NyKTsKKwkJaWYgKCFyZXNwKQorCQkJcmV0dXJuIEVOT01FTTsKKwl9
CisKKwlzZW5kX3JlcGx5KGNvbm4sIFhTX0NPTlRST0wsIHJlc3AsIHN0cmxl
bihyZXNwKSArIDEpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQg
cXVvdGFfc2V0KGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sCisJCSAgICAgY2hhciAqKnZlYywgaW50IG51bSwgY29uc3Qgc3Ry
dWN0IHF1b3RhICpxdW90YXMpCit7CisJdW5zaWduZWQgaW50IGk7CisJaW50
IHZhbDsKKworCWlmIChudW0gIT0gMikKKwkJcmV0dXJuIEVJTlZBTDsKKwor
CXZhbCA9IGF0b2kodmVjWzFdKTsKKwlpZiAodmFsIDwgMSkKKwkJcmV0dXJu
IEVJTlZBTDsKKworCWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90YTsgaSsr
KSB7CisJCWlmICghc3RyY21wKHZlY1swXSwgcXVvdGFzW2ldLm5hbWUpKSB7
CisJCQkqcXVvdGFzW2ldLnF1b3RhID0gdmFsOworCQkJc2VuZF9hY2soY29u
biwgWFNfQ09OVFJPTCk7CisJCQlyZXR1cm4gMDsKKwkJfQorCX0KKworCXJl
dHVybiBFSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgcXVvdGFfZ2V0KGNvbnN0
IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCSAgICAg
Y2hhciAqKnZlYywgaW50IG51bSkKK3sKKwlpZiAobnVtICE9IDEpCisJCXJl
dHVybiBFSU5WQUw7CisKKwlyZXR1cm4gZG9tYWluX2dldF9xdW90YShjdHgs
IGNvbm4sIGF0b2kodmVjWzBdKSk7Cit9CisKK3N0YXRpYyBpbnQgZG9fY29u
dHJvbF9xdW90YSh2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LAorCQkJICAgIGNoYXIgKip2ZWMsIGludCBudW0pCit7CisJaWYgKG51bSA9
PSAwKQorCQlyZXR1cm4gcXVvdGFfc2hvd19jdXJyZW50KGN0eCwgY29ubiwg
aGFyZF9xdW90YXMpOworCisJaWYgKCFzdHJjbXAodmVjWzBdLCAic2V0Iikp
CisJCXJldHVybiBxdW90YV9zZXQoY3R4LCBjb25uLCB2ZWMgKyAxLCBudW0g
LSAxLCBoYXJkX3F1b3Rhcyk7CisKKwlyZXR1cm4gcXVvdGFfZ2V0KGN0eCwg
Y29ubiwgdmVjLCBudW0pOworfQorCitzdGF0aWMgaW50IGRvX2NvbnRyb2xf
cXVvdGFfcyh2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAor
CQkJICAgICAgY2hhciAqKnZlYywgaW50IG51bSkKK3sKKwlpZiAobnVtID09
IDApCisJCXJldHVybiBxdW90YV9zaG93X2N1cnJlbnQoY3R4LCBjb25uLCBz
b2Z0X3F1b3Rhcyk7CisKKwlpZiAoIXN0cmNtcCh2ZWNbMF0sICJzZXQiKSkK
KwkJcmV0dXJuIHF1b3RhX3NldChjdHgsIGNvbm4sIHZlYyArIDEsIG51bSAt
IDEsIHNvZnRfcXVvdGFzKTsKKworCXJldHVybiBFSU5WQUw7Cit9CisKICNp
ZmRlZiBfX01JTklPU19fCiBzdGF0aWMgaW50IGRvX2NvbnRyb2xfbWVtcmVw
b3J0KHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCiAJCQkJ
Y2hhciAqKnZlYywgaW50IG51bSkKQEAgLTg0Nyw2ICs5NTYsOCBAQCBzdGF0
aWMgc3RydWN0IGNtZF9zIGNtZHNbXSA9IHsKIAl7ICJtZW1yZXBvcnQiLCBk
b19jb250cm9sX21lbXJlcG9ydCwgIls8ZmlsZT5dIiB9LAogI2VuZGlmCiAJ
eyAicHJpbnQiLCBkb19jb250cm9sX3ByaW50LCAiPHN0cmluZz4iIH0sCisJ
eyAicXVvdGEiLCBkb19jb250cm9sX3F1b3RhLCAiW3NldCA8bmFtZT4gPHZh
bD58PGRvbWlkPl0iIH0sCisJeyAicXVvdGEtc29mdCIsIGRvX2NvbnRyb2xf
cXVvdGFfcywgIltzZXQgPG5hbWU+IDx2YWw+XSIgfSwKIAl7ICJoZWxwIiwg
ZG9fY29udHJvbF9oZWxwLCAiIiB9LAogfTsKIApkaWZmIC0tZ2l0IGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDk0ZmQ1NjFlOWRlNC4uZTdj
Njg4NmNjZjQ3IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5jCkBAIC0zMSw2ICszMSw3IEBACiAjaW5jbHVkZSAieGVuc3RvcmVk
X2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IgogI2luY2x1ZGUgInhlbnN0b3JlZF93YXRjaC5oIgorI2luY2x1ZGUgInhl
bnN0b3JlZF9jb250cm9sLmgiCiAKICNpbmNsdWRlIDx4ZW5ldnRjaG4uaD4K
ICNpbmNsdWRlIDx4ZW5jdHJsLmg+CkBAIC0zNDUsNiArMzQ2LDM4IEBAIHN0
YXRpYyBzdHJ1Y3QgZG9tYWluICpmaW5kX2RvbWFpbl9zdHJ1Y3QodW5zaWdu
ZWQgaW50IGRvbWlkKQogCXJldHVybiBOVUxMOwogfQogCitpbnQgZG9tYWlu
X2dldF9xdW90YShjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLAorCQkgICAgIHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1
Y3QgZG9tYWluICpkID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwlj
aGFyICpyZXNwOworCWludCB0YTsKKworCWlmICghZCkKKwkJcmV0dXJuIEVO
T0VOVDsKKworCXRhID0gZC0+Y29ubiA/IGQtPmNvbm4tPnRyYW5zYWN0aW9u
X3N0YXJ0ZWQgOiAwOworCXJlc3AgPSB0YWxsb2NfYXNwcmludGYoY3R4LCAi
RG9tYWluICV1OlxuIiwgZG9taWQpOworCWlmICghcmVzcCkKKwkJcmV0dXJu
IEVOT01FTTsKKworI2RlZmluZSBlbnQodCwgZSkgXAorCXJlc3AgPSB0YWxs
b2NfYXNwcmludGZfYXBwZW5kKHJlc3AsICIlLTE2czogJThkXG4iLCAjdCwg
ZSk7IFwKKwlpZiAoIXJlc3ApIHJldHVybiBFTk9NRU0KKworCWVudChub2Rl
cywgZC0+bmJlbnRyeSk7CisJZW50KHdhdGNoZXMsIGQtPm5id2F0Y2gpOwor
CWVudCh0cmFuc2FjdGlvbnMsIHRhKTsKKwllbnQob3V0c3RhbmRpbmcsIGQt
Pm5ib3V0c3RhbmRpbmcpOworCWVudChtZW1vcnksIGQtPm1lbW9yeSk7CisK
KyN1bmRlZiBlbnQKKworCXNlbmRfcmVwbHkoY29ubiwgWFNfQ09OVFJPTCwg
cmVzcCwgc3RybGVuKHJlc3ApICsgMSk7CisKKwlyZXR1cm4gMDsKK30KKwog
c3RhdGljIHN0cnVjdCBkb21haW4gKmFsbG9jX2RvbWFpbihjb25zdCB2b2lk
ICpjb250ZXh0LCB1bnNpZ25lZCBpbnQgZG9taWQpCiB7CiAJc3RydWN0IGRv
bWFpbiAqZG9tYWluOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5oCmluZGV4IDYzM2M5YTBhMGExZi4uOTA0ZmFhOTIzYWZiIDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCkBAIC04Nyw2
ICs4Nyw4IEBAIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwogdm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5jKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKIHZvaWQgZG9tYWluX291dHN0YW5kaW5nX2Rl
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiB2b2lkIGRvbWFpbl9vdXRz
dGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKTsKK2ludCBk
b21haW5fZ2V0X3F1b3RhKGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sCisJCSAgICAgdW5zaWduZWQgaW50IGRvbWlkKTsKIAog
LyogU3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICovCiBpbnQg
c2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IGNoYXIgKm5hbWUsCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-01.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSA1YWVjMWEzN2E4Y2NjNTFlNjEzNjQxZGVjZjk5YTEwZDc3MDUyZjNm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IFN5bmNocm9uaXNlIGRlZmF1
bHRzIHdpdGggb3hlbnN0b3JlLmNvbmYuaW4KTUlNRS1WZXJzaW9uOiAxLjAK
Q29udGVudC1UeXBlOiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRl
bnQtVHJhbnNmZXItRW5jb2Rpbmc6IDhiaXQKCldlIGN1cnJlbnRseSBoYXZl
IDIgZGlmZmVyZW50IHNldCBvZiBkZWZhdWx0cyBpbiB1cHN0cmVhbSBYZW4g
Z2l0IHRyZWU6CiogZGVmaW5lZCBpbiB0aGUgc291cmNlIGNvZGUsIG9ubHkg
dXNlZCBpZiB0aGVyZSBpcyBubyBjb25maWcgZmlsZQoqIGRlZmluZWQgaW4g
dGhlIG94ZW5zdG9yZWQuY29uZi5pbiB1cHN0cmVhbSBYZW4KCkFuIG94ZW5z
dG9yZWQuY29uZiBmaWxlIGlzIG5vdCBtYW5kYXRvcnksIGFuZCBpZiBtaXNz
aW5nLCBtYXhyZXF1ZXN0cyBpbgpwYXJ0aWN1bGFyIGhhcyBhbiB1bnNhZmUg
ZGVmYXVsdC4KClJlc3luYyB0aGUgZGVmYXVsdHMgZnJvbSBveGVuc3RvcmVk
LmNvbmYuaW4gaW50byB0aGUgc291cmNlIGNvZGUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE2LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEVkd2luIFTDtnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2Vk
LWJ5OiBDaHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJp
eC5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Rl
ZmluZS5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5k
ZXggZWJlMThiOGUzMTJjLi42YjA2ZjgwODU5NWIgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2Nh
bWwveGVuc3RvcmVkL2RlZmluZS5tbApAQCAtMjEsOSArMjEsOSBAQCBsZXQg
eHNfZGFlbW9uX3NvY2tldCA9IFBhdGhzLnhlbl9ydW5fc3RvcmVkIF4gIi9z
b2NrZXQiCiAKIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRocy54ZW5f
Y29uZmlnX2RpcgogCi1sZXQgbWF4d2F0Y2ggPSByZWYgKDUwKQotbGV0IG1h
eHRyYW5zYWN0aW9uID0gcmVmICgyMCkKLWxldCBtYXhyZXF1ZXN0cyA9IHJl
ZiAoLTEpICAgKCogbWF4aW11bSByZXF1ZXN0cyBwZXIgdHJhbnNhY3Rpb24g
KikKK2xldCBtYXh3YXRjaCA9IHJlZiAoMTAwKQorbGV0IG1heHRyYW5zYWN0
aW9uID0gcmVmICgxMCkKK2xldCBtYXhyZXF1ZXN0cyA9IHJlZiAoMTAyNCkg
ICAoKiBtYXhpbXVtIHJlcXVlc3RzIHBlciB0cmFuc2FjdGlvbiAqKQogCiBs
ZXQgY29uZmxpY3RfYnVyc3RfbGltaXQgPSByZWYgNS4wCiBsZXQgY29uZmxp
Y3RfbWF4X2hpc3Rvcnlfc2Vjb25kcyA9IHJlZiAwLjA1CmRpZmYgLS1naXQg
YS90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwgYi90b29scy9vY2Ft
bC94ZW5zdG9yZWQvcXVvdGEubWwKaW5kZXggYWJjYWM5MTI4MDVhLi42ZTNk
NjQwMWFlODkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9x
dW90YS5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcXVvdGEubWwK
QEAgLTIwLDggKzIwLDggQEAgZXhjZXB0aW9uIFRyYW5zYWN0aW9uX29wZW5l
ZAogCiBsZXQgd2FybiBmbXQgPSBMb2dnaW5nLndhcm4gInF1b3RhIiBmbXQK
IGxldCBhY3RpdmF0ZSA9IHJlZiB0cnVlCi1sZXQgbWF4ZW50ID0gcmVmICgx
MDAwMCkKLWxldCBtYXhzaXplID0gcmVmICg0MDk2KQorbGV0IG1heGVudCA9
IHJlZiAoMTAwMCkKK2xldCBtYXhzaXplID0gcmVmICgyMDQ4KQogCiB0eXBl
IHQgPSB7CiAJbWF4ZW50OiBpbnQ7ICAgICAgICAgICAgICAgKCogbWF4IGVu
dGl0aWVzIHBlciBkb21VICopCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-02.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSBmOTE1NmQzYTlkZTE5OGU5ZGJiNjI3NGVlYjIzM2ExZTEyZDk2MjI5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogVGh1LCAyOCBKdWwgMjAyMiAxNzowODoxNSArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IENoZWNrIGZvciBtYXhyZXF1
ZXN0cyBiZWZvcmUgcGVyZm9ybWluZwogb3BlcmF0aW9ucwpNSU1FLVZlcnNp
b246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRG
LTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKUHJldmlvdXNs
eSB3ZSdkIHBlcmZvcm0gdGhlIG9wZXJhdGlvbiwgcmVjb3JkIHRoZSB1cGRh
dGVkIHRyZWUgaW4gdGhlCnRyYW5zYWN0aW9uIHJlY29yZCwgdGhlbiB0cnkg
dG8gaW5zZXJ0IGEgd2F0Y2hvcCBwYXRoIGFuZCB0aGUgcmVwbHkgcGFja2V0
LgoKSWYgd2UgZXhjZWVkZWQgbWF4IHJlcXVlc3RzIHdlIHdvdWxkJ3ZlIHJl
dHVybmVkIEVRVU9UQSwgYnV0IHN0aWxsOgoqIGhhdmUgcGVyZm9ybWVkIHRo
ZSBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uJ3MgdHJlZQoqIGhhdmUg
cmVjb3JkZWQgdGhlIHdhdGNob3AsIG1ha2luZyB0aGlzIHF1ZXVlIGVmZmVj
dGl2ZWx5IHVuYm91bmRlZAoKSXQgaXMgYmV0dGVyIGlmIHdlIGNoZWNrIHdo
ZXRoZXIgd2UnZCBoYXZlIHJvb20gdG8gc3RvcmUgdGhlIG9wZXJhdGlvbiBi
ZWZvcmUKcGVyZm9ybWluZyB0aGUgdHJhbnNhY3Rpb24sIGFuZCByYWlzZSBF
UVVPVEEgdGhlcmUuICBUaGVuIHRoZSB0cmFuc2FjdGlvbgpyZWNvcmQgd29u
J3QgZ3Jvdy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2IC8gQ1ZFLTIwMjIt
NDIzMTcuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1h
em9uLmNvbT4KU2lnbmVkLW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4u
dG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcg
PGNocmlzdGlhbi5saW5kaWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbCBiL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDg2ZWVkMDI0MTM3Yi4uZDA0
MDA0MTlhYjRmIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQv
cHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vz
cy5tbApAQCAtMzg5LDYgKzM4OSw3IEBAIGxldCBpbnB1dF9oYW5kbGVfZXJy
b3IgfmNvbnMgfmRvbXMgfmZjdCB+Y29uIH50IH5yZXEgPQogCWxldCByZXBs
eV9lcnJvciBlID0KIAkJUGFja2V0LkVycm9yIGUgaW4KIAl0cnkKKwkJVHJh
bnNhY3Rpb24uY2hlY2tfcXVvdGFfZXhuIH5wZXJtOihDb25uZWN0aW9uLmdl
dF9wZXJtIGNvbikgdDsKIAkJZmN0IGNvbiB0IGRvbXMgY29ucyByZXEuUGFj
a2V0LmRhdGEKIAl3aXRoCiAJfCBEZWZpbmUuSW52YWxpZF9wYXRoICAgICAg
ICAgIC0+IHJlcGx5X2Vycm9yICJFSU5WQUwiCkBAIC02ODIsOSArNjgzLDEw
IEBAIGxldCBwcm9jZXNzX3BhY2tldCB+c3RvcmUgfmNvbnMgfmRvbXMgfmNv
biB+cmVxID0KIAkJaW4KIAogCQlsZXQgcmVzcG9uc2UgPSB0cnkKKwkJCVRy
YW5zYWN0aW9uLmNoZWNrX3F1b3RhX2V4biB+cGVybTooQ29ubmVjdGlvbi5n
ZXRfcGVybSBjb24pIHQ7CiAJCQlpZiB0aWQgPD4gVHJhbnNhY3Rpb24ubm9u
ZSB0aGVuCiAJCQkJKCogUmVtZW1iZXIgdGhlIHJlcXVlc3QgYW5kIHJlc3Bv
bnNlIGZvciB0aGlzIG9wZXJhdGlvbiBpbiBjYXNlIHdlIG5lZWQgdG8gcmVw
bGF5IHRoZSB0cmFuc2FjdGlvbiAqKQotCQkJCVRyYW5zYWN0aW9uLmFkZF9v
cGVyYXRpb24gfnBlcm06KENvbm5lY3Rpb24uZ2V0X3Blcm0gY29uKSB0IHJl
cSByZXNwb25zZTsKKwkJCQlUcmFuc2FjdGlvbi5hZGRfb3BlcmF0aW9uIHQg
cmVxIHJlc3BvbnNlOwogCQkJcmVzcG9uc2UKIAkJd2l0aCBRdW90YS5MaW1p
dF9yZWFjaGVkIC0+CiAJCQlQYWNrZXQuRXJyb3IgIkVRVU9UQSIKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbAppbmRleCAx
N2IxYmRmMmVhZjkuLjI5NDE0M2UyMzM1YiAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3RyYW5zYWN0aW9uLm1sCisrKyBiL3Rvb2xzL29j
YW1sL3hlbnN0b3JlZC90cmFuc2FjdGlvbi5tbApAQCAtODUsNiArODUsNyBA
QCB0eXBlIHQgPSB7CiAJb2xkcm9vdDogU3RvcmUuTm9kZS50OwogCW11dGFi
bGUgcGF0aHM6IChYZW5idXMuWGIuT3Aub3BlcmF0aW9uICogU3RvcmUuUGF0
aC50KSBsaXN0OwogCW11dGFibGUgb3BlcmF0aW9uczogKFBhY2tldC5yZXF1
ZXN0ICogUGFja2V0LnJlc3BvbnNlKSBsaXN0OworCW11dGFibGUgcXVvdGFf
cmVhY2hlZDogYm9vbDsKIAltdXRhYmxlIHJlYWRfbG93cGF0aDogU3RvcmUu
UGF0aC50IG9wdGlvbjsKIAltdXRhYmxlIHdyaXRlX2xvd3BhdGg6IFN0b3Jl
LlBhdGgudCBvcHRpb247CiB9CkBAIC0xMjcsNiArMTI4LDcgQEAgbGV0IG1h
a2UgPyhpbnRlcm5hbD1mYWxzZSkgaWQgc3RvcmUgPQogCQlvbGRyb290ID0g
U3RvcmUuZ2V0X3Jvb3Qgc3RvcmU7CiAJCXBhdGhzID0gW107CiAJCW9wZXJh
dGlvbnMgPSBbXTsKKwkJcXVvdGFfcmVhY2hlZCA9IGZhbHNlOwogCQlyZWFk
X2xvd3BhdGggPSBOb25lOwogCQl3cml0ZV9sb3dwYXRoID0gTm9uZTsKIAl9
IGluCkBAIC0xNDMsMTMgKzE0NSwxOSBAQCBsZXQgZ2V0X3Jvb3QgdCA9IFN0
b3JlLmdldF9yb290IHQuc3RvcmUKIAogbGV0IGlzX3JlYWRfb25seSB0ID0g
dC5wYXRocyA9IFtdCiBsZXQgYWRkX3dvcCB0IHR5IHBhdGggPSB0LnBhdGhz
IDwtICh0eSwgcGF0aCkgOjogdC5wYXRocwotbGV0IGFkZF9vcGVyYXRpb24g
fnBlcm0gdCByZXF1ZXN0IHJlc3BvbnNlID0KK2xldCBnZXRfb3BlcmF0aW9u
cyB0ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCisKK2xldCBjaGVja19xdW90
YV9leG4gfnBlcm0gdCA9CiAJaWYgIURlZmluZS5tYXhyZXF1ZXN0cyA+PSAw
CiAJCSYmIG5vdCAoUGVybXMuQ29ubmVjdGlvbi5pc19kb20wIHBlcm0pCi0J
CSYmIExpc3QubGVuZ3RoIHQub3BlcmF0aW9ucyA+PSAhRGVmaW5lLm1heHJl
cXVlc3RzCi0JCXRoZW4gcmFpc2UgUXVvdGEuTGltaXRfcmVhY2hlZDsKKwkJ
JiYgKHQucXVvdGFfcmVhY2hlZCB8fCBMaXN0Lmxlbmd0aCB0Lm9wZXJhdGlv
bnMgPj0gIURlZmluZS5tYXhyZXF1ZXN0cykKKwkJdGhlbiBiZWdpbgorCQkJ
dC5xdW90YV9yZWFjaGVkIDwtIHRydWU7CisJCQlyYWlzZSBRdW90YS5MaW1p
dF9yZWFjaGVkOworCQllbmQKKworbGV0IGFkZF9vcGVyYXRpb24gdCByZXF1
ZXN0IHJlc3BvbnNlID0KIAl0Lm9wZXJhdGlvbnMgPC0gKHJlcXVlc3QsIHJl
c3BvbnNlKSA6OiB0Lm9wZXJhdGlvbnMKLWxldCBnZXRfb3BlcmF0aW9ucyB0
ID0gTGlzdC5yZXYgdC5vcGVyYXRpb25zCiBsZXQgc2V0X3JlYWRfbG93cGF0
aCB0IHBhdGggPSB0LnJlYWRfbG93cGF0aCA8LSBnZXRfbG93ZXN0IHBhdGgg
dC5yZWFkX2xvd3BhdGgKIGxldCBzZXRfd3JpdGVfbG93cGF0aCB0IHBhdGgg
PSB0LndyaXRlX2xvd3BhdGggPC0gZ2V0X2xvd2VzdCBwYXRoIHQud3JpdGVf
bG93cGF0aAogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-03.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBmZTc4M2QxZTVhNjkzNTJkYTMwNWZhZGQzNDViMjZlNDhhYWIyMzgw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogR0MgcGFyYW1ldGVyIHR1bmluZwpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKQnkgZGVm
YXVsdCB0aGUgT0NhbWwgZ2FyYmFnZSBjb2xsZWN0b3Igd291bGQgcmV0dXJu
IG1lbW9yeSB0byB0aGUgT1Mgb25seQphZnRlciB1bnVzZWQgbWVtb3J5IGlz
IDV4IGxpdmUgbWVtb3J5LiAgVHdlYWsgdGhpcyB0byAxMjAlIGluc3RlYWQs
IHdoaWNoCndvdWxkIG1hdGNoIHRoZSBtYWpvciBHQyBzcGVlZC4KClRoaXMg
aXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTD
tnLDtmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJp
c3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+Cgpk
aWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2RlZmluZS5tbCBi
L3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKaW5kZXggNmIwNmY4
MDg1OTViLi5iYTYzYTgxNDdlMDkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3Rv
cmVkL2RlZmluZS5tbApAQCAtMjUsNiArMjUsNyBAQCBsZXQgbWF4d2F0Y2gg
PSByZWYgKDEwMCkKIGxldCBtYXh0cmFuc2FjdGlvbiA9IHJlZiAoMTApCiBs
ZXQgbWF4cmVxdWVzdHMgPSByZWYgKDEwMjQpICAgKCogbWF4aW11bSByZXF1
ZXN0cyBwZXIgdHJhbnNhY3Rpb24gKikKIAorbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKIGxl
dCBjb25mbGljdF9tYXhfaGlzdG9yeV9zZWNvbmRzID0gcmVmIDAuMDUKIGxl
dCBjb25mbGljdF9yYXRlX2xpbWl0X2lzX2FnZ3JlZ2F0ZSA9IHJlZiB0cnVl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVk
Lm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAppbmRl
eCBkNDRhZTY3M2M0MmEuLjNiNTdhZDAxNmRmYiAxMDA2NDQKLS0tIGEvdG9v
bHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCkBAIC0xMDQsNiArMTA0LDcg
QEAgbGV0IHBhcnNlX2NvbmZpZyBmaWxlbmFtZSA9CiAJCSgicXVvdGEtbWF4
c2l6ZSIsIENvbmZpZy5TZXRfaW50IFF1b3RhLm1heHNpemUpOwogCQkoInF1
b3RhLW1heHJlcXVlc3RzIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heHJl
cXVlc3RzKTsKIAkJKCJxdW90YS1wYXRoLW1heCIsIENvbmZpZy5TZXRfaW50
IERlZmluZS5wYXRoX21heCk7CisJCSgiZ2MtbWF4LW92ZXJoZWFkIiwgQ29u
ZmlnLlNldF9pbnQgRGVmaW5lLmdjX21heF9vdmVyaGVhZCk7CiAJCSgidGVz
dC1lYWdhaW4iLCBDb25maWcuU2V0X2Jvb2wgVHJhbnNhY3Rpb24udGVzdF9l
YWdhaW4pOwogCQkoInBlcnNpc3RlbnQiLCBDb25maWcuU2V0X2Jvb2wgRGlz
ay5lbmFibGUpOwogCQkoInhlbnN0b3JlZC1sb2ctZmlsZSIsIENvbmZpZy5T
dHJpbmcgTG9nZ2luZy5zZXRfeGVuc3RvcmVkX2xvZ19kZXN0aW5hdGlvbik7
CkBAIC0yNjUsNiArMjY2LDY3IEBAIGxldCB0b19maWxlIHN0b3JlIGNvbnMg
ZmRzIGZpbGUgPQogCSAgICAgICAgKGZ1biAoKSAtPiBjbG9zZV9vdXQgY2hh
bm5lbCkKIGVuZAogCisoKgorCUJ5IGRlZmF1bHQgT0NhbWwncyBHQyBvbmx5
IHJldHVybnMgbWVtb3J5IHRvIHRoZSBPUyB3aGVuIGl0IGV4Y2VlZHMgYQor
CWNvbmZpZ3VyYWJsZSAnbWF4IG92ZXJoZWFkJyBzZXR0aW5nLgorCVRoZSBk
ZWZhdWx0IGlzIDUwMCUsIHRoYXQgaXMgNS82dGggb2YgdGhlIE9DYW1sIGhl
YXAgbmVlZHMgdG8gYmUgZnJlZQorCWFuZCBvbmx5IDEvNnRoIGxpdmUgZm9y
IGEgY29tcGFjdGlvbiB0byBiZSB0cmlnZ2VycmVkIHRoYXQgd291bGQKKwly
ZWxlYXNlIG1lbW9yeSBiYWNrIHRvIHRoZSBPUy4KKwlJZiB0aGUgbGltaXQg
aXMgbm90IGhpdCB0aGVuIHRoZSBPQ2FtbCBwcm9jZXNzIGNhbiByZXVzZSB0
aGF0IG1lbW9yeQorCWZvciBpdHMgb3duIHB1cnBvc2VzLCBidXQgb3RoZXIg
cHJvY2Vzc2VzIHdvbid0IGJlIGFibGUgdG8gdXNlIGl0LgorCisJVGhlcmUg
aXMgYWxzbyBhICdzcGFjZSBvdmVyaGVhZCcgc2V0dGluZyB0aGF0IGNvbnRy
b2xzIGhvdyBtdWNoIHdvcmsKKwllYWNoIG1ham9yIEdDIHNsaWNlIGRvZXMs
IGFuZCBieSBkZWZhdWx0IGFpbXMgYXQgaGF2aW5nIG5vIG1vcmUgdGhhbgor
CTgwJSBvciAxMjAlIChkZXBlbmRpbmcgb24gdmVyc2lvbikgZ2FyYmFnZSB2
YWx1ZXMgY29tcGFyZWQgdG8gbGl2ZQorCXZhbHVlcy4KKwlUaGlzIGRvZXNu
J3QgaGF2ZSBhcyBtdWNoIHJlbGV2YW5jZSB0byBtZW1vcnkgcmV0dXJuZWQg
dG8gdGhlIE9TIGFzCisJbG9uZyBhcyBzcGFjZV9vdmVyaGVhZCA8PSBtYXhf
b3ZlcmhlYWQsIGJlY2F1c2UgY29tcGFjdGlvbiBpcyBvbmx5CisJdHJpZ2dl
cnJlZCBhdCB0aGUgZW5kIG9mIG1ham9yIEdDIGN5Y2xlcy4KKworCVRoZSBk
ZWZhdWx0cyBhcmUgdG9vIGxhcmdlIG9uY2UgdGhlIHByb2dyYW0gc3RhcnRz
IHVzaW5nIH4xMDBNaUIgb2YKKwltZW1vcnksIGF0IHdoaWNoIHBvaW50IH41
MDBNaUIgd291bGQgYmUgdW5hdmFpbGFibGUgdG8gb3RoZXIgcHJvY2Vzc2Vz
CisJKHdoaWNoIHdvdWxkIGJlIGZpbmUgaWYgdGhpcyB3YXMgdGhlIG1haW4g
cHJvY2VzcyBpbiB0aGlzIFZNLCBidXQgaXQgaXMKKwlub3QpLgorCisJTWF4
IG92ZXJoZWFkIGNhbiBhbHNvIGJlIHNldCB0byAwLCBob3dldmVyIHRoaXMg
aXMgZm9yIHRlc3RpbmcgcHVycG9zZXMKKwlvbmx5IChzZXR0aW5nIGl0IGxv
d2VyIHRoYW4gJ3NwYWNlIG92ZXJoZWFkJyB3b3VsZG4ndCBoZWxwIGJlY2F1
c2UgdGhlCisJbWFqb3IgR0Mgd291bGRuJ3QgcnVuIGZhc3QgZW5vdWdoLCBh
bmQgY29tcGFjdGlvbiBkb2VzIGhhdmUgYQorCXBlcmZvcm1hbmNlIGNvc3Q6
IHdlIGNhbiBvbmx5IGNvbXBhY3QgY29udGlndW91cyByZWdpb25zLCBzbyBt
ZW1vcnkgaGFzCisJdG8gYmUgbW92ZWQgYXJvdW5kKS4KKworCU1heCBvdmVy
aGVhZCBjb250cm9scyBob3cgb2Z0ZW4gdGhlIGhlYXAgaXMgY29tcGFjdGVk
LCB3aGljaCBpcyB1c2VmdWwKKwlpZiB0aGVyZSBhcmUgYnVyc3Qgb2YgYWN0
aXZpdHkgZm9sbG93ZWQgYnkgbG9uZyBwZXJpb2RzIG9mIGlkbGUgc3RhdGUs
CisJb3IgaWYgYSBkb21haW4gcXVpdHMsIGV0Yy4gQ29tcGFjdGlvbiByZXR1
cm5zIG1lbW9yeSB0byB0aGUgT1MuCisKKwl3YXN0ZWQgPSBsaXZlICogc3Bh
Y2Vfb3ZlcmhlYWQgLyAxMDAKKworCUZvciBnbG9iYWxseSBvdmVycmlkaW5n
IHRoZSBHQyBzZXR0aW5ncyBvbmUgY2FuIHVzZSBPQ0FNTFJVTlBBUkFNLAor
CWhvd2V2ZXIgd2UgcHJvdmlkZSBhIGNvbmZpZyBmaWxlIG92ZXJyaWRlIHRv
IGJlIGNvbnNpc3RlbnQgd2l0aCBvdGhlcgorCW94ZW5zdG9yZWQgc2V0dGlu
Z3MuCisKKwlPbmUgbWlnaHQgd2FudCB0byBkeW5hbWljYWxseSBhZGp1c3Qg
dGhlIG92ZXJoZWFkIHNldHRpbmcgYmFzZWQgb24gdXNlZAorCW1lbW9yeSwg
aS5lLiB0byB1c2UgYSBmaXhlZCB1cHBlciBib3VuZCBpbiBieXRlcywgbm90
IHBlcmNlbnRhZ2UuIEhvd2V2ZXIKKwltZWFzdXJlbWVudHMgc2hvdyB0aGF0
IHN1Y2ggYWRqdXN0bWVudHMgaW5jcmVhc2UgR0Mgb3ZlcmhlYWQgbWFzc2l2
ZWx5LAorCXdoaWxlIHN0aWxsIG5vdCBndWFyYW50ZWVpbmcgdGhhdCBtZW1v
cnkgaXMgcmV0dXJuZWQgYW55IG1vcmUgcXVpY2tseQorCXRoYW4gd2l0aCBh
IHBlcmNlbnRhZ2UgYmFzZWQgc2V0dGluZy4KKworCVRoZSBhbGxvY2F0aW9u
IHBvbGljeSBjb3VsZCBhbHNvIGJlIHR3ZWFrZWQsIGUuZy4gZmlyc3QgZml0
IHdvdWxkIHJlZHVjZQorCWZyYWdtZW50YXRpb24gYW5kIHRodXMgbWVtb3J5
IHVzYWdlLCBidXQgdGhlIGRvY3VtZW50YXRpb24gd2FybnMgdGhhdCBpdAor
CWNhbiBiZSBzZW5zaWJseSBzbG93ZXIsIGFuZCBpbmRlZWQgb25lIG9mIG91
ciBvd24gdGVzdGNhc2VzIGNhbiB0cmlnZ2VyCisJc3VjaCBhIGNvcm5lciBj
YXNlIHdoZXJlIGl0IGlzIG11bHRpcGxlIHRpbWVzIHNsb3dlciwgc28gaXQg
aXMgYmVzdCB0byBrZWVwCisJdGhlIGRlZmF1bHQgYWxsb2NhdGlvbiBwb2xp
Y3kgKG5leHQtZml0L2Jlc3QtZml0IGRlcGVuZGluZyBvbiB2ZXJzaW9uKS4K
KworCVRoZXJlIGFyZSBvdGhlciB0d2Vha3MgdGhhdCBjYW4gYmUgYXR0ZW1w
dGVkIGluIHRoZSBmdXR1cmUsIGUuZy4gc2V0dGluZworCSd1bGltaXQgLXYn
IHRvIDc1JSBvZiBSQU0sIGhvd2V2ZXIgZ2V0dGluZyB0aGUga2VybmVsIHRv
IGFjdHVhbGx5IHJldHVybgorCU5VTEwgZnJvbSBhbGxvY2F0aW9ucyBpcyBk
aWZmaWN1bHQgZXZlbiB3aXRoIHRoYXQgc2V0dGluZywgYW5kIHdpdGhvdXQg
YQorCU5VTEwgdGhlIGVtZXJnZW5jeSBHQyB3b24ndCBiZSB0cmlnZ2VycmVk
LgorCVBlcmhhcHMgY2dyb3VwIGxpbWl0cyBjb3VsZCBoZWxwLCBidXQgZm9y
IG5vdyB0d2VhayB0aGUgc2FmZXN0IG9ubHkuCisqKQorCitsZXQgdHdlYWtf
Z2MgKCkgPQorCUdjLnNldCB7IChHYy5nZXQgKCkpIHdpdGggR2MubWF4X292
ZXJoZWFkID0gIURlZmluZS5nY19tYXhfb3ZlcmhlYWQgfQorCisKIGxldCBf
ID0KIAlsZXQgY2YgPSBkb19hcmd2IGluCiAJbGV0IHBpZGZpbGUgPQpAQCAt
Mjc0LDYgKzMzNiw4IEBAIGxldCBfID0KIAkJCWRlZmF1bHRfcGlkZmlsZQog
CQlpbgogCisJdHdlYWtfZ2MgKCk7CisKIAkodHJ5CiAJCVVuaXhleHQubWtk
aXJfcmVjIChGaWxlbmFtZS5kaXJuYW1lIHBpZGZpbGUpIDBvNzU1CiAJd2l0
aCBfIC0+Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-04.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSBlOWFmMzlmMGI0ZDQ3MDIyYmFiZTNkYmEzOGQ4M2Q3ZWI4MmQ4YTNl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogQ2hhbmdlIFhiLmlucHV0IHRvIHJldHVybiBQ
YWNrZXQudCBvcHRpb24KTUlNRS1WZXJzaW9uOiAxLjAKQ29udGVudC1UeXBl
OiB0ZXh0L3BsYWluOyBjaGFyc2V0PVVURi04CkNvbnRlbnQtVHJhbnNmZXIt
RW5jb2Rpbmc6IDhiaXQKClRoZSBxdWV1ZSBoZXJlIHdvdWxkIG9ubHkgZXZl
ciBob2xkIGF0IG1vc3Qgb25lIGVsZW1lbnQuICBUaGlzIHdpbGwgc2ltcGxp
ZnkKZm9sbG93LXVwIHBhdGNoZXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
Ni4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24u
Y29tPgpTaWduZWQtb2ZmLWJ5OiBFZHdpbiBUw7Zyw7ZrIDxlZHZpbi50b3Jv
a0BjaXRyaXguY29tPgpBY2tlZC1ieTogQ2hyaXN0aWFuIExpbmRpZyA8Y2hy
aXN0aWFuLmxpbmRpZ0BjaXRyaXguY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xz
L29jYW1sL2xpYnMveGIveGIubWwgYi90b29scy9vY2FtbC9saWJzL3hiL3hi
Lm1sCmluZGV4IDg0MDRkZGQ4YTY4Mi4uMTY1ZmQ0YTFlZGY0IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1sCisrKyBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKQEAgLTQ1LDcgKzQ1LDYgQEAgdHlwZSBwYXJ0
aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlhbC5wa3QgfCBOb0hkciBvZiBp
bnQgKiBieXRlcwogdHlwZSB0ID0KIHsKIAliYWNrZW5kOiBiYWNrZW5kOwot
CXBrdF9pbjogUGFja2V0LnQgUXVldWUudDsKIAlwa3Rfb3V0OiBQYWNrZXQu
dCBRdWV1ZS50OwogCW11dGFibGUgcGFydGlhbF9pbjogcGFydGlhbF9idWY7
CiAJbXV0YWJsZSBwYXJ0aWFsX291dDogc3RyaW5nOwpAQCAtNjIsNyArNjEs
NiBAQCBsZXQgcmVjb25uZWN0IHQgPSBtYXRjaCB0LmJhY2tlbmQgd2l0aAog
CQlYc19yaW5nLmNsb3NlIGJhY2tlbmQubW1hcDsKIAkJYmFja2VuZC5ldmVu
dGNobl9ub3RpZnkgKCk7CiAJCSgqIENsZWFyIG91ciBvbGQgY29ubmVjdGlv
biBzdGF0ZSAqKQotCQlRdWV1ZS5jbGVhciB0LnBrdF9pbjsKIAkJUXVldWUu
Y2xlYXIgdC5wa3Rfb3V0OwogCQl0LnBhcnRpYWxfaW4gPC0gaW5pdF9wYXJ0
aWFsX2luICgpOwogCQl0LnBhcnRpYWxfb3V0IDwtICIiCkBAIC0xMjQsNyAr
MTIyLDYgQEAgbGV0IG91dHB1dCBjb24gPQogCiAoKiBOQjogY2FuIHRocm93
IFJlY29ubmVjdCAqKQogbGV0IGlucHV0IGNvbiA9Ci0JbGV0IG5ld3BhY2tl
dCA9IHJlZiBmYWxzZSBpbgogCWxldCB0b19yZWFkID0KIAkJbWF0Y2ggY29u
LnBhcnRpYWxfaW4gd2l0aAogCQl8IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4g
UGFydGlhbC50b19jb21wbGV0ZSBwYXJ0aWFsX3BrdApAQCAtMTQzLDIxICsx
NDAsMTkgQEAgbGV0IGlucHV0IGNvbiA9CiAJCWlmIFBhcnRpYWwudG9fY29t
cGxldGUgcGFydGlhbF9wa3QgPSAwIHRoZW4gKAogCQkJbGV0IHBrdCA9IFBh
Y2tldC5vZl9wYXJ0aWFscGt0IHBhcnRpYWxfcGt0IGluCiAJCQljb24ucGFy
dGlhbF9pbiA8LSBpbml0X3BhcnRpYWxfaW4gKCk7Ci0JCQlRdWV1ZS5wdXNo
IHBrdCBjb24ucGt0X2luOwotCQkJbmV3cGFja2V0IDo9IHRydWUKLQkJKQor
CQkJU29tZSBwa3QKKwkJKSBlbHNlIE5vbmUKIAl8IE5vSGRyIChpLCBidWYp
ICAgICAgLT4KIAkJKCogd2UgY29tcGxldGUgdGhlIHBhcnRpYWwgaGVhZGVy
ICopCiAJCWlmIHN6ID4gMCB0aGVuCiAJCQlCeXRlcy5ibGl0IGIgMCBidWYg
KFBhcnRpYWwuaGVhZGVyX3NpemUgKCkgLSBpKSBzejsKIAkJY29uLnBhcnRp
YWxfaW4gPC0gaWYgc3ogPSBpIHRoZW4KLQkJCUhhdmVIZHIgKFBhcnRpYWwu
b2Zfc3RyaW5nIChCeXRlcy50b19zdHJpbmcgYnVmKSkgZWxzZSBOb0hkciAo
aSAtIHN6LCBidWYpCi0JKTsKLQkhbmV3cGFja2V0CisJCQlIYXZlSGRyIChQ
YXJ0aWFsLm9mX3N0cmluZyAoQnl0ZXMudG9fc3RyaW5nIGJ1ZikpIGVsc2Ug
Tm9IZHIgKGkgLSBzeiwgYnVmKTsKKwkJTm9uZQorCSkKIAogbGV0IG5ld2Nv
biBiYWNrZW5kID0gewogCWJhY2tlbmQgPSBiYWNrZW5kOwotCXBrdF9pbiA9
IFF1ZXVlLmNyZWF0ZSAoKTsKIAlwa3Rfb3V0ID0gUXVldWUuY3JlYXRlICgp
OwogCXBhcnRpYWxfaW4gPSBpbml0X3BhcnRpYWxfaW4gKCk7CiAJcGFydGlh
bF9vdXQgPSAiIjsKQEAgLTE5Myw5ICsxODgsNiBAQCBsZXQgaGFzX291dHB1
dCBjb24gPSBoYXNfbmV3X291dHB1dCBjb24gfHwgaGFzX29sZF9vdXRwdXQg
Y29uCiAKIGxldCBwZWVrX291dHB1dCBjb24gPSBRdWV1ZS5wZWVrIGNvbi5w
a3Rfb3V0CiAKLWxldCBpbnB1dF9sZW4gY29uID0gUXVldWUubGVuZ3RoIGNv
bi5wa3RfaW4KLWxldCBoYXNfaW5fcGFja2V0IGNvbiA9IFF1ZXVlLmxlbmd0
aCBjb24ucGt0X2luID4gMAotbGV0IGdldF9pbl9wYWNrZXQgY29uID0gUXVl
dWUucG9wIGNvbi5wa3RfaW4KIGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24g
PSBtYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCiAJfCBIYXZlSGRyIF8gLT4g
dHJ1ZQogCXwgTm9IZHIgKG4sIF8pIC0+IG4gPCBQYXJ0aWFsLmhlYWRlcl9z
aXplICgpCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aSBiL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWxpCmluZGV4IDc5NGUzNWJi
MzQzZS4uOTFjNjgyMTYyY2VhIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9s
aWJzL3hiL3hiLm1saQorKysgYi90b29scy9vY2FtbC9saWJzL3hiL3hiLm1s
aQpAQCAtNzcsNyArNzcsNyBAQCB2YWwgd3JpdGVfZmQgOiBiYWNrZW5kX2Zk
IC0+ICdhIC0+IHN0cmluZyAtPiBpbnQgLT4gaW50CiB2YWwgd3JpdGVfbW1h
cCA6IGJhY2tlbmRfbW1hcCAtPiAnYSAtPiBzdHJpbmcgLT4gaW50IC0+IGlu
dAogdmFsIHdyaXRlIDogdCAtPiBzdHJpbmcgLT4gaW50IC0+IGludAogdmFs
IG91dHB1dCA6IHQgLT4gYm9vbAotdmFsIGlucHV0IDogdCAtPiBib29sCit2
YWwgaW5wdXQgOiB0IC0+IFBhY2tldC50IG9wdGlvbgogdmFsIG5ld2NvbiA6
IGJhY2tlbmQgLT4gdAogdmFsIG9wZW5fZmQgOiBVbml4LmZpbGVfZGVzY3Ig
LT4gdAogdmFsIG9wZW5fbW1hcCA6IFhlbm1tYXAubW1hcF9pbnRlcmZhY2Ug
LT4gKHVuaXQgLT4gdW5pdCkgLT4gdApAQCAtODksMTAgKzg5LDcgQEAgdmFs
IGhhc19uZXdfb3V0cHV0IDogdCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRw
dXQgOiB0IC0+IGJvb2wKIHZhbCBoYXNfb3V0cHV0IDogdCAtPiBib29sCiB2
YWwgcGVla19vdXRwdXQgOiB0IC0+IFBhY2tldC50Ci12YWwgaW5wdXRfbGVu
IDogdCAtPiBpbnQKLXZhbCBoYXNfaW5fcGFja2V0IDogdCAtPiBib29sCiB2
YWwgaGFzX3BhcnRpYWxfaW5wdXQgOiB0IC0+IGJvb2wKLXZhbCBnZXRfaW5f
cGFja2V0IDogdCAtPiBQYWNrZXQudAogdmFsIGhhc19tb3JlX2lucHV0IDog
dCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4gYm9vbAogdmFs
IGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCmRpZmYgLS1naXQgYS90
b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sIGIvdG9vbHMvb2NhbWwvbGli
cy94cy94c3Jhdy5tbAppbmRleCBkOTgyZmIyNGRiYjEuLjQ1MWY4YjM4ZGJj
YyAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94cy94c3Jhdy5tbAor
KysgYi90b29scy9vY2FtbC9saWJzL3hzL3hzcmF3Lm1sCkBAIC05NCwyNiAr
OTQsMTggQEAgbGV0IHBrdF9zZW5kIGNvbiA9CiAJZG9uZQogCiAoKiByZWNl
aXZlIG9uZSBwYWNrZXQgLSBjYW4gc2xlZXAgKikKLWxldCBwa3RfcmVjdiBj
b24gPQotCWxldCB3b3JrZG9uZSA9IHJlZiBmYWxzZSBpbgotCXdoaWxlIG5v
dCAhd29ya2RvbmUKLQlkbwotCQl3b3JrZG9uZSA6PSBYYi5pbnB1dCBjb24u
eGIKLQlkb25lOwotCVhiLmdldF9pbl9wYWNrZXQgY29uLnhiCitsZXQgcmVj
IHBrdF9yZWN2IGNvbiA9CisJbWF0Y2ggWGIuaW5wdXQgY29uLnhiIHdpdGgK
Kwl8IFNvbWUgcGFja2V0IC0+IHBhY2tldAorCXwgTm9uZSAtPiBwa3RfcmVj
diBjb24KIAogbGV0IHBrdF9yZWN2X3RpbWVvdXQgY29uIHRpbWVvdXQgPQog
CWxldCBmZCA9IFhiLmdldF9mZCBjb24ueGIgaW4KIAlsZXQgciwgXywgXyA9
IFVuaXguc2VsZWN0IFsgZmQgXSBbXSBbXSB0aW1lb3V0IGluCiAJaWYgciA9
IFtdIHRoZW4KIAkJdHJ1ZSwgTm9uZQotCWVsc2UgKAotCQlsZXQgd29ya2Rv
bmUgPSBYYi5pbnB1dCBjb24ueGIgaW4KLQkJaWYgd29ya2RvbmUgdGhlbgot
CQkJZmFsc2UsIChTb21lIChYYi5nZXRfaW5fcGFja2V0IGNvbi54YikpCi0J
CWVsc2UKLQkJCWZhbHNlLCBOb25lCi0JKQorCWVsc2UKKwkJZmFsc2UsIFhi
LmlucHV0IGNvbi54YgogCiBsZXQgcXVldWVfd2F0Y2hldmVudCBjb24gZGF0
YSA9CiAJbGV0IGxzID0gc3BsaXRfc3RyaW5nIH5saW1pdDoyICdcMDAwJyBk
YXRhIGluCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29u
bmVjdGlvbi5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCmluZGV4IDY0MTgwYmIyZDVmNi4uM2Y2YThmMWFkMGY3IDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbAorKysg
Yi90b29scy9vY2FtbC94ZW5zdG9yZWQvY29ubmVjdGlvbi5tbApAQCAtMjc3
LDkgKzI3Nyw3IEBAIGxldCBnZXRfdHJhbnNhY3Rpb24gY29uIHRpZCA9CiAJ
SGFzaHRibC5maW5kIGNvbi50cmFuc2FjdGlvbnMgdGlkCiAKIGxldCBkb19p
bnB1dCBjb24gPSBYZW5idXMuWGIuaW5wdXQgY29uLnhiCi1sZXQgaGFzX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfaW5fcGFja2V0IGNvbi54YgogbGV0
IGhhc19wYXJ0aWFsX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5oYXNfcGFydGlh
bF9pbnB1dCBjb24ueGIKLWxldCBwb3BfaW4gY29uID0gWGVuYnVzLlhiLmdl
dF9pbl9wYWNrZXQgY29uLnhiCiBsZXQgaGFzX21vcmVfaW5wdXQgY29uID0g
WGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54YgogCiBsZXQgaGFzX291
dHB1dCBjb24gPSBYZW5idXMuWGIuaGFzX291dHB1dCBjb24ueGIKQEAgLTMw
Nyw3ICszMDUsNyBAQCBsZXQgaXNfYmFkIGNvbiA9IG1hdGNoIGNvbi5kb20g
d2l0aCBOb25lIC0+IGZhbHNlIHwgU29tZSBkb20gLT4gRG9tYWluLmlzX2Jh
ZF9kbwogICAgUmVzdHJpY3Rpb25zIGJlbG93IGNhbiBiZSByZWxheGVkIG9u
Y2UgeGVuc3RvcmVkIGxlYXJucyB0byBkdW1wIG1vcmUKICAgIG9mIGl0cyBs
aXZlIHN0YXRlIGluIGEgc2FmZSB3YXkgKikKIGxldCBoYXNfZXh0cmFfY29u
bmVjdGlvbl9kYXRhIGNvbiA9Ci0JbGV0IGhhc19pbiA9IGhhc19pbnB1dCBj
b24gfHwgaGFzX3BhcnRpYWxfaW5wdXQgY29uIGluCisJbGV0IGhhc19pbiA9
IGhhc19wYXJ0aWFsX2lucHV0IGNvbiBpbgogCWxldCBoYXNfb3V0ID0gaGFz
X291dHB1dCBjb24gaW4KIAlsZXQgaGFzX25vbmRlZmF1bHRfcGVybXMgPSBt
YWtlX3Blcm0gY29uLmRvbSA8PiBjb24ucGVybSBpbgogCWhhc19pbiB8fCBo
YXNfb3V0CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJv
Y2Vzcy5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sCmlu
ZGV4IDNhZWY0ZTQ2NzNmOS4uNjlhOTZmMmRhOGU5IDEwMDY0NAotLS0gYS90
b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbAorKysgYi90b29scy9v
Y2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbApAQCAtMTk1LDEwICsxOTUsOSBA
QCBsZXQgcGFyc2VfbGl2ZV91cGRhdGUgYXJncyA9CiAJCQl8IF8gd2hlbiBV
bml4LmdldHRpbWVvZmRheSAoKSA8IHQuZGVhZGxpbmUgLT4gZmFsc2UKIAkJ
CXwgbCAtPgogCQkJCXdhcm4gInRpbWVvdXQgcmVhY2hlZDogaGF2ZSB0byB3
YWl0LCBtaWdyYXRlIG9yIHNodXRkb3duICVkIGRvbWFpbnM6IiAoTGlzdC5s
ZW5ndGggbCk7Ci0JCQkJbGV0IG1zZ3MgPSBMaXN0LnJldl9tYXAgKGZ1biBj
b24gLT4gUHJpbnRmLnNwcmludGYgIiVzOiAlZCB0eCwgaW46ICViLCBvdXQ6
ICViLCBwZXJtOiAlcyIKKwkJCQlsZXQgbXNncyA9IExpc3QucmV2X21hcCAo
ZnVuIGNvbiAtPiBQcmludGYuc3ByaW50ZiAiJXM6ICVkIHR4LCBvdXQ6ICVi
LCBwZXJtOiAlcyIKIAkJCQkJKENvbm5lY3Rpb24uZ2V0X2RvbXN0ciBjb24p
CiAJCQkJCShDb25uZWN0aW9uLm51bWJlcl9vZl90cmFuc2FjdGlvbnMgY29u
KQotCQkJCQkoQ29ubmVjdGlvbi5oYXNfaW5wdXQgY29uKQogCQkJCQkoQ29u
bmVjdGlvbi5oYXNfb3V0cHV0IGNvbikKIAkJCQkJKENvbm5lY3Rpb24uZ2V0
X3Blcm0gY29uIHw+IFBlcm1zLkNvbm5lY3Rpb24udG9fc3RyaW5nKQogCQkJ
CQkpIGwgaW4KQEAgLTcwNiwxNiArNzA1LDE3IEBAIGxldCBkb19pbnB1dCBz
dG9yZSBjb25zIGRvbXMgY29uID0KIAkJCWluZm8gIiVzIHJlcXVlc3RzIGEg
cmVjb25uZWN0IiAoQ29ubmVjdGlvbi5nZXRfZG9tc3RyIGNvbik7CiAJCQlI
aXN0b3J5LnJlY29ubmVjdCBjb247CiAJCQlpbmZvICIlcyByZWNvbm5lY3Rp
b24gY29tcGxldGUiIChDb25uZWN0aW9uLmdldF9kb21zdHIgY29uKTsKLQkJ
CWZhbHNlCisJCQlOb25lCiAJCXwgRmFpbHVyZSBleHAgLT4KIAkJCWVycm9y
ICJjYXVnaHQgZXhjZXB0aW9uICVzIiBleHA7CiAJCQllcnJvciAiZ290IGEg
YmFkIGNsaWVudCAlcyIgKHNwcmludGYgIiUtOHMiIChDb25uZWN0aW9uLmdl
dF9kb21zdHIgY29uKSk7CiAJCQlDb25uZWN0aW9uLm1hcmtfYXNfYmFkIGNv
bjsKLQkJCWZhbHNlCisJCQlOb25lCiAJaW4KIAotCWlmIG5ld3BhY2tldCB0
aGVuICgKLQkJbGV0IHBhY2tldCA9IENvbm5lY3Rpb24ucG9wX2luIGNvbiBp
bgorCW1hdGNoIG5ld3BhY2tldCB3aXRoCisJfCBOb25lIC0+ICgpCisJfCBT
b21lIHBhY2tldCAtPgogCQlsZXQgdGlkLCByaWQsIHR5LCBkYXRhID0gWGVu
YnVzLlhiLlBhY2tldC51bnBhY2sgcGFja2V0IGluCiAJCWxldCByZXEgPSB7
UGFja2V0LnRpZD10aWQ7IFBhY2tldC5yaWQ9cmlkOyBQYWNrZXQudHk9dHk7
IFBhY2tldC5kYXRhPWRhdGF9IGluCiAKQEAgLTcyNSw4ICs3MjUsNyBAQCBs
ZXQgZG9faW5wdXQgc3RvcmUgY29ucyBkb21zIGNvbiA9CiAJCSAgICAgICAg
IChYZW5idXMuWGIuT3AudG9fc3RyaW5nIHR5KSAoc2FuaXRpemVfZGF0YSBk
YXRhKTsgKikKIAkJcHJvY2Vzc19wYWNrZXQgfnN0b3JlIH5jb25zIH5kb21z
IH5jb24gfnJlcTsKIAkJd3JpdGVfYWNjZXNzX2xvZyB+dHkgfnRpZCB+Y29u
OihDb25uZWN0aW9uLmdldF9kb21zdHIgY29uKSB+ZGF0YTsKLQkJQ29ubmVj
dGlvbi5pbmNyX29wcyBjb247Ci0JKQorCQlDb25uZWN0aW9uLmluY3Jfb3Bz
IGNvbgogCiBsZXQgZG9fb3V0cHV0IF9zdG9yZSBfY29ucyBfZG9tcyBjb24g
PQogCWlmIENvbm5lY3Rpb24uaGFzX291dHB1dCBjb24gdGhlbiAoCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-05.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSA0MDk5ODUzNWI2ZDFiOGU3NjcwZGExYzRlYTgxYjZkOGQ4OTk0YzE4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowMyArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94YjogQWRkIEJvdW5kZWRRdWV1ZQpNSU1FLVZl
cnNpb246IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9
VVRGLTgKQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKRW5zdXJl
cyB3ZSBjYW5ub3Qgc3RvcmUgbW9yZSB0aGFuIFtjYXBhY2l0eV0gZWxlbWVu
dHMgaW4gYSBbUXVldWVdLiAgUmVwbGFjaW5nCmFsbCBRdWV1ZSB3aXRoIHRo
aXMgbW9kdWxlIHdpbGwgdGhlbiBlbnN1cmUgYXQgY29tcGlsZSB0aW1lIHRo
YXQgYWxsIFF1ZXVlcwphcmUgY29ycmVjdGx5IGJvdW5kIGNoZWNrZWQuCgpF
YWNoIGVsZW1lbnQgaW4gdGhlIHF1ZXVlIGhhcyBhIGNsYXNzIHdpdGggaXRz
IG93biBsaW1pdHMuICBUaGlzLCBpbiBhCnN1YnNlcXVlbnQgY2hhbmdlLCB3
aWxsIGVuc3VyZSB0aGF0IGNvbW1hbmQgcmVzcG9uc2VzIGNhbiBwcm9jZWVk
IGR1cmluZyBhCmZsb29kIG9mIHdhdGNoIGV2ZW50cy4KCk5vIGZ1bmN0aW9u
YWwgY2hhbmdlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRl
ZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVk
LW9mZi1ieTogRWR3aW4gVMO2csO2ayA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KQWNrZWQtYnk6IENocmlzdGlhbiBMaW5kaWcgPGNocmlzdGlhbi5saW5k
aWdAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9saWJz
L3hiL3hiLm1sIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbAppbmRleCAx
NjVmZDRhMWVkZjQuLjQxOTdhMzg4OGE2OCAxMDA2NDQKLS0tIGEvdG9vbHMv
b2NhbWwvbGlicy94Yi94Yi5tbAorKysgYi90b29scy9vY2FtbC9saWJzL3hi
L3hiLm1sCkBAIC0xNyw2ICsxNyw5OCBAQAogbW9kdWxlIE9wID0gc3RydWN0
IGluY2x1ZGUgT3AgZW5kCiBtb2R1bGUgUGFja2V0ID0gc3RydWN0IGluY2x1
ZGUgUGFja2V0IGVuZAogCittb2R1bGUgQm91bmRlZFF1ZXVlIDogc2lnCisJ
dHlwZSAoJ2EsICdiKSB0CisKKwkoKiogW2NyZWF0ZSB+Y2FwYWNpdHkgfmNs
YXNzaWZ5IH5saW1pdF0gY3JlYXRlcyBhIHF1ZXVlIHdpdGggbWF4aW11bSBb
Y2FwYWNpdHldIGVsZW1lbnRzLgorCSAgICBUaGlzIGlzIGJ1cnN0IGNhcGFj
aXR5LCBlYWNoIGVsZW1lbnQgaXMgZnVydGhlciBjbGFzc2lmaWVkIGFjY29y
ZGluZyB0byBbY2xhc3NpZnldLAorCSAgICBhbmQgZWFjaCBjbGFzcyBjYW4g
aGF2ZSBpdHMgb3duIFtsaW1pdF0uCisJICAgIFtjYXBhY2l0eV0gaXMgZW5m
b3JjZWQgYXMgYW4gb3ZlcmFsbCBsaW1pdC4KKwkgICAgVGhlIFtsaW1pdF0g
Y2FuIGJlIGR5bmFtaWMsIGFuZCBjYW4gYmUgc21hbGxlciB0aGFuIHRoZSBu
dW1iZXIgb2YgZWxlbWVudHMgYWxyZWFkeSBxdWV1ZWQgb2YgdGhhdCBjbGFz
cywKKwkgICAgaW4gd2hpY2ggY2FzZSB0aG9zZSBlbGVtZW50cyBhcmUgY29u
c2lkZXJlZCB0byB1c2UgImJ1cnN0IGNhcGFjaXR5Ii4KKwkgICopCisJdmFs
IGNyZWF0ZTogY2FwYWNpdHk6aW50IC0+IGNsYXNzaWZ5OignYSAtPiAnYikg
LT4gbGltaXQ6KCdiIC0+IGludCkgLT4gKCdhLCAnYikgdAorCisJKCoqIFtj
bGVhciBxXSBkaXNjYXJkcyBhbGwgZWxlbWVudHMgZnJvbSBbcV0gKikKKwl2
YWwgY2xlYXI6ICgnYSwgJ2IpIHQgLT4gdW5pdAorCisJKCoqIFtjYW5fcHVz
aCBxXSB3aGVuIFtsZW5ndGggcSA8IGNhcGFjaXR5XS4JKikKKwl2YWwgY2Fu
X3B1c2g6ICgnYSwgJ2IpIHQgLT4gJ2IgLT4gYm9vbAorCisJKCoqIFtwdXNo
IGUgcV0gYWRkcyBbZV0gYXQgdGhlIGVuZCBvZiBxdWV1ZSBbcV0gaWYgW2Nh
bl9wdXNoIHFdLCBvciByZXR1cm5zIFtOb25lXS4gKikKKwl2YWwgcHVzaDog
J2EgLT4gKCdhLCAnYikgdCAtPiB1bml0IG9wdGlvbgorCisJKCoqIFtwb3Ag
cV0gcmVtb3ZlcyBhbmQgcmV0dXJucyBmaXJzdCBlbGVtZW50IGluIFtxXSwg
b3IgcmFpc2VzIFtRdWV1ZS5FbXB0eV0uICopCisJdmFsIHBvcDogKCdhLCAn
YikgdCAtPiAnYQorCisJKCoqIFtwZWVrIHFdIHJldHVybnMgdGhlIGZpcnN0
IGVsZW1lbnQgaW4gW3FdLCBvciByYWlzZXMgW1F1ZXVlLkVtcHR5XS4gICop
CisJdmFsIHBlZWsgOiAoJ2EsICdiKSB0IC0+ICdhCisKKwkoKiogW2xlbmd0
aCBxXSByZXR1cm5zIHRoZSBjdXJyZW50IG51bWJlciBvZiBlbGVtZW50cyBp
biBbcV0gKikKKwl2YWwgbGVuZ3RoOiAoJ2EsICdiKSB0IC0+IGludAorCisJ
KCoqIFtkZWJ1ZyBzdHJpbmdfb2ZfY2xhc3MgcV0gcHJpbnRzIHF1ZXVlIHVz
YWdlIHN0YXRpc3RpY3MgaW4gYW4gdW5zcGVjaWZpZWQgaW50ZXJuYWwgZm9y
bWF0LiAqKQorCXZhbCBkZWJ1ZzogKCdiIC0+IHN0cmluZykgLT4gKF8sICdi
KSB0IC0+IHN0cmluZworZW5kID0gc3RydWN0CisJdHlwZSAoJ2EsICdiKSB0
ID0KKwkJeyBxOiAnYSBRdWV1ZS50CisJCTsgY2FwYWNpdHk6IGludAorCQk7
IGNsYXNzaWZ5OiAnYSAtPiAnYgorCQk7IGxpbWl0OiAnYiAtPiBpbnQKKwkJ
OyBjbGFzc19jb3VudDogKCdiLCBpbnQpIEhhc2h0YmwudAorCQl9CisKKwls
ZXQgY3JlYXRlIH5jYXBhY2l0eSB+Y2xhc3NpZnkgfmxpbWl0ID0KKwkJeyBj
YXBhY2l0eTsgcSA9IFF1ZXVlLmNyZWF0ZSAoKTsgY2xhc3NpZnk7IGxpbWl0
OyBjbGFzc19jb3VudCA9IEhhc2h0YmwuY3JlYXRlIDMgfQorCisJbGV0IGdl
dF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uID0gdHJ5IEhhc2h0YmwuZmluZCB0
LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIHdpdGggTm90X2ZvdW5kIC0+
IDAKKworCWxldCBjYW5fcHVzaF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9u
IGNsYXNzX2NvdW50ID0KKwkJUXVldWUubGVuZ3RoIHQucSA8IHQuY2FwYWNp
dHkgJiYgY2xhc3NfY291bnQgPCB0LmxpbWl0IGNsYXNzaWZpY2F0aW9uCisK
KwlsZXQgb2sgPSBTb21lICgpCisKKwlsZXQgcHVzaCBlIHQgPQorCQlsZXQg
Y2xhc3NpZmljYXRpb24gPSB0LmNsYXNzaWZ5IGUgaW4KKwkJbGV0IGNsYXNz
X2NvdW50ID0gZ2V0X2NvdW50IHQgY2xhc3NpZmljYXRpb24gaW4KKwkJaWYg
Y2FuX3B1c2hfaW50ZXJuYWwgdCBjbGFzc2lmaWNhdGlvbiBjbGFzc19jb3Vu
dCB0aGVuIGJlZ2luCisJCQlRdWV1ZS5wdXNoIGUgdC5xOworCQkJSGFzaHRi
bC5yZXBsYWNlIHQuY2xhc3NfY291bnQgY2xhc3NpZmljYXRpb24gKGNsYXNz
X2NvdW50ICsgMSk7CisJCQlvaworCQllbmQKKwkJZWxzZQorCQkJTm9uZQor
CisJbGV0IGNhbl9wdXNoIHQgY2xhc3NpZmljYXRpb24gPQorCQljYW5fcHVz
aF9pbnRlcm5hbCB0IGNsYXNzaWZpY2F0aW9uIEBAIGdldF9jb3VudCB0IGNs
YXNzaWZpY2F0aW9uCisKKwlsZXQgY2xlYXIgdCA9CisJCVF1ZXVlLmNsZWFy
IHQucTsKKwkJSGFzaHRibC5yZXNldCB0LmNsYXNzX2NvdW50CisKKwlsZXQg
cG9wIHQgPQorCQlsZXQgZSA9IFF1ZXVlLnBvcCB0LnEgaW4KKwkJbGV0IGNs
YXNzaWZpY2F0aW9uID0gdC5jbGFzc2lmeSBlIGluCisJCWxldCAoKSA9IG1h
dGNoIGdldF9jb3VudCB0IGNsYXNzaWZpY2F0aW9uIC0gMSB3aXRoCisJCXwg
MCAtPiBIYXNodGJsLnJlbW92ZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0
aW9uICgqIHJlZHVjZXMgbWVtdXNhZ2UgKikKKwkJfCBuIC0+IEhhc2h0Ymwu
cmVwbGFjZSB0LmNsYXNzX2NvdW50IGNsYXNzaWZpY2F0aW9uIG4KKwkJaW4K
KwkJZQorCisJbGV0IHBlZWsgdCA9IFF1ZXVlLnBlZWsgdC5xCisJbGV0IGxl
bmd0aCB0ID0gUXVldWUubGVuZ3RoIHQucQorCisJbGV0IGRlYnVnIHN0cmlu
Z19vZl9jbGFzcyB0ID0KKwkJbGV0IGIgPSBCdWZmZXIuY3JlYXRlIDEyOCBp
bgorCQlQcmludGYuYnByaW50ZiBiICJCb3VuZGVkUXVldWUgY2FwYWNpdHk6
ICVkLCB1c2VkOiB7IiB0LmNhcGFjaXR5OworCQlIYXNodGJsLml0ZXIgKGZ1
biBwYWNrZXRfY2xhc3MgY291bnQgLT4KKwkJCVByaW50Zi5icHJpbnRmIGIg
IgklczogJWQiIChzdHJpbmdfb2ZfY2xhc3MgcGFja2V0X2NsYXNzKSBjb3Vu
dAorCQkpIHQuY2xhc3NfY291bnQ7CisJCVByaW50Zi5icHJpbnRmIGIgIn0i
OworCQlCdWZmZXIuY29udGVudHMgYgorZW5kCisKKwogZXhjZXB0aW9uIEVu
ZF9vZl9maWxlCiBleGNlcHRpb24gRWFnYWluCiBleGNlcHRpb24gTm9lbnQK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-06.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSAzNTgwOGY4NzZkNTI1NTE0Y2JjMTNkMmI4ZGFkZDM2NGZiMjA0MGMx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNCArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbDogTGltaXQgbWF4aW11bSBpbi1mbGlnaHQgcmVx
dWVzdHMgLyBvdXRzdGFuZGluZyByZXBsaWVzCk1JTUUtVmVyc2lvbjogMS4w
CkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250
ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA4Yml0CgpJbnRyb2R1Y2UgYSBsaW1p
dCBvbiB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcGx5IHBhY2tldHMg
aW4gdGhlIHhlbmJ1cwpxdWV1ZS4gIFRoaXMgbGltaXRzIHRoZSBudW1iZXIg
b2YgaW4tZmxpZ2h0IHJlcXVlc3RzOiB3aGVuIHRoZSBvdXRwdXQgcXVldWUg
aXMKZnVsbCB3ZSdsbCBzdG9wIHByb2Nlc3NpbmcgaW5wdXRzIHVudGlsIHRo
ZSBvdXRwdXQgcXVldWUgaGFzIHJvb20gYWdhaW4uCgpUbyBhdm9pZCBhIGJ1
c3kgbG9vcCBvbiB0aGUgVW5peCBzb2NrZXQgd2Ugb25seSBhZGQgaXQgdG8g
dGhlIHdhdGNoZWQgaW5wdXQKZmlsZSBkZXNjcmlwdG9yIHNldCBpZiB3ZSdk
IGJlIGFibGUgdG8gY2FsbCBgaW5wdXRgIG9uIGl0LiAgRXZlbiB0aG91Z2gg
RG9tMAppcyB0cnVzdGVkIGFuZCBleGVtcHQgZnJvbSBxdW90YXMgYSBmbG9v
ZCBvZiBldmVudHMgbWlnaHQgY2F1c2UgYSBiYWNrbG9nCndoZXJlIGV2ZW50
cyBhcmUgcHJvZHVjZWQgZmFzdGVyIHRoYW4gZGFlbW9ucyBpbiBEb20wIGNh
biBjb25zdW1lIHRoZW0sIHdoaWNoCmNvdWxkIGxlYWQgdG8gYW4gdW5ib3Vu
ZGVkIHF1ZXVlIHNpemUgYW5kIE9PTS4KClRoZXJlZm9yZSB0aGUgeGVuYnVz
IHF1ZXVlIGxpbWl0IG11c3QgYXBwbHkgdG8gYWxsIGNvbm5lY3Rpb25zLCBE
b20wIGlzIG5vdApleGVtcHQgZnJvbSBpdCwgYWx0aG91Z2ggaWYgZXZlcnl0
aGluZyB3b3JrcyBjb3JyZWN0bHkgaXQgd2lsbCBldmVudHVhbGx5CmNhdGNo
IHVwLgoKVGhpcyBwcmV2ZW50cyBhIG1hbGljaW91cyBndWVzdCBmcm9tIHNl
bmRpbmcgbW9yZSBjb21tYW5kcyB3aGlsZSBpdCBoYXMKb3V0c3RhbmRpbmcg
d2F0Y2ggZXZlbnRzIG9yIGNvbW1hbmQgcmVwbGllcyBpbiBpdHMgaW5wdXQg
cmluZy4gIEhvd2V2ZXIgaWYgaXQKY2FuIGNhdXNlIHRoZSBnZW5lcmF0aW9u
IG9mIHdhdGNoIGV2ZW50cyBieSBvdGhlciBtZWFucyAoZS5nLiBieSBEb20w
LCBvcgphbm90aGVyIGNvb3BlcmF0aXZlIGd1ZXN0KSBhbmQgc3RvcCByZWFk
aW5nIGl0cyBvd24gcmluZyB0aGVuIHdhdGNoIGV2ZW50cwp3b3VsZCd2ZSBx
dWV1ZWQgdXAgd2l0aG91dCBsaW1pdC4KClRoZSB4ZW5zdG9yZSBwcm90b2Nv
bCBkb2Vzbid0IGhhdmUgYSBiYWNrLXByZXNzdXJlIG1lY2hhbmlzbSwgYW5k
IGRvZXNuJ3QKYWxsb3cgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzLiAgSW4gZmFj
dCwgZHJvcHBpbmcgd2F0Y2ggZXZlbnRzIGlzIGtub3duIHRvIGJyZWFrCnNv
bWUgcGllY2VzIG9mIG5vcm1hbCBmdW5jdGlvbmFsaXR5LiAgVGhpcyBsZWF2
ZXMgbGl0dGxlIGNob2ljZSB0byBzYWZlbHkKaW1wbGVtZW50IHRoZSB4ZW5z
dG9yZSBwcm90b2NvbCB3aXRob3V0IGV4cG9zaW5nIHRoZSB4ZW5zdG9yZSBk
YWVtb24gdG8Kb3V0LW9mLW1lbW9yeSBhdHRhY2tzLgoKSW1wbGVtZW50IHRo
ZSBmaXggYXMgcGlwZXMgd2l0aCBib3VuZGVkIGJ1ZmZlcnM6CiogVXNlIGEg
Ym91bmRlZCBidWZmZXIgZm9yIHdhdGNoIGV2ZW50cwoqIFRoZSB3YXRjaCBz
dHJ1Y3R1cmUgd2lsbCBoYXZlIGEgYm91bmRlZCByZWNlaXZpbmcgcGlwZSBv
ZiB3YXRjaCBldmVudHMKKiBUaGUgc291cmNlIHdpbGwgaGF2ZSBhbiAib3Zl
cmZsb3ciIHBpcGUgb2YgcGVuZGluZyB3YXRjaCBldmVudHMgaXQgY291bGRu
J3QKICBkZWxpdmVyCgpJdGVtcyBhcmUgcXVldWVkIHVwIG9uIG9uZSBlbmQg
YW5kIGFyZSBzZW50IGFzIGZhciBhbG9uZyB0aGUgcGlwZSBhcyBwb3NzaWJs
ZToKCiAgc291cmNlIGRvbWFpbiAtPiB3YXRjaCAtPiB4ZW5idXMgb2YgdGFy
Z2V0IC0+IHhlbnN0b3JlIHJpbmcvc29ja2V0IG9mIHRhcmdldAoKSWYgdGhl
IHBpcGUgaXMgImZ1bGwiIGF0IGFueSBwb2ludCB0aGVuIGJhY2stcHJlc3N1
cmUgaXMgYXBwbGllZCBhbmQgd2UgcHJldmVudAptb3JlIGl0ZW1zIGZyb20g
YmVpbmcgcXVldWVkIHVwLiAgRm9yIHRoZSBzb3VyY2UgZG9tYWluIHRoaXMg
bWVhbnMgdGhhdCB3ZSdsbApzdG9wIGFjY2VwdGluZyBuZXcgY29tbWFuZHMg
YXMgbG9uZyBhcyBpdHMgcGlwZSBidWZmZXIgaXMgbm90IGVtcHR5LgoKQmVm
b3JlIHdlIHRyeSB0byBlbnF1ZXVlIGFuIGl0ZW0gd2UgZmlyc3QgY2hlY2sg
d2hldGhlciBpdCBpcyBwb3NzaWJsZSB0byBzZW5kCml0IGZ1cnRoZXIgZG93
biB0aGUgcGlwZSwgYnkgYXR0ZW1wdGluZyB0byByZWN1cnNpdmVseSBmbHVz
aCB0aGUgcGlwZXMuIFRoaXMKZW5zdXJlcyB0aGF0IHdlIHJldGFpbiB0aGUg
b3JkZXIgb2YgZXZlbnRzIGFzIG11Y2ggYXMgcG9zc2libGUuCgpXZSBtaWdo
dCBicmVhayBjYXVzYWxpdHkgb2Ygd2F0Y2ggZXZlbnRzIGlmIHRoZSB0YXJn
ZXQgZG9tYWluJ3MgcXVldWUgaXMgZnVsbAphbmQgd2UgbmVlZCB0byBzdGFy
dCB1c2luZyB0aGUgd2F0Y2gncyBxdWV1ZS4gIFRoaXMgaXMgYSBicmVha2lu
ZyBjaGFuZ2UgaW4KdGhlIHhlbnN0b3JlIHByb3RvY29sLCBidXQgb25seSBm
b3IgZG9tYWlucyB3aGljaCBhcmUgbm90IHByb2Nlc3NpbmcgdGhlaXIKaW5j
b21pbmcgcmluZyBhcyBleHBlY3RlZC4KCldoZW4gYSB3YXRjaCBpcyBkZWxl
dGVkIGl0cyBlbnRpcmUgcGVuZGluZyBxdWV1ZSBpcyBkcm9wcGVkIChubyBj
b2RlIGlzIG5lZWRlZApmb3IgdGhhdCwgYmVjYXVzZSBpdCBpcyBwYXJ0IG9m
IHRoZSAnd2F0Y2gnIHR5cGUpLgoKVGhlcmUgaXMgYSBjYWNoZSBvZiB3YXRj
aGVzIHRoYXQgaGF2ZSBwZW5kaW5nIGV2ZW50cyB0aGF0IHdlIGF0dGVtcHQg
dG8gZmx1c2gKYXQgZXZlcnkgY3ljbGUgaWYgcG9zc2libGUuCgpJbnRyb2R1
Y2UgMyBsaW1pdHMgaGVyZToKKiBxdW90YS1tYXh3YXRjaGV2ZW50cyBvbiB3
YXRjaCBldmVudCBkZXN0aW5hdGlvbjogd2hlbiB0aGlzIGlzIGhpdCB0aGUK
ICBzb3VyY2Ugd2lsbCBub3QgYmUgYWxsb3dlZCB0byBxdWV1ZSB1cCBtb3Jl
IHdhdGNoIGV2ZW50cy4KKiBxdW90YS1tYXhvdXN0YW5kaW5nIHdoaWNoIGlz
IHRoZSBudW1iZXIgb2YgcmVzcG9uc2VzIG5vdCByZWFkIGZyb20gdGhlIHJp
bmc6CiAgb25jZSBleGNlZWRlZCwgbm8gbW9yZSBpbnB1dHMgYXJlIHByb2Nl
c3NlZCB1bnRpbCBhbGwgb3V0c3RhbmRpbmcgcmVwbGllcwogIGFyZSBjb25z
dW1lZCBieSB0aGUgY2xpZW50LgoqIG92ZXJmbG93IHF1ZXVlIG9uIHRoZSB3
YXRjaCBldmVudCBzb3VyY2U6IGFsbCB3YXRjaGVzIHRoYXQgY2Fubm90IGJl
IHN0b3JlZAogIG9uIGRlc3RpbmF0aW9uIGFyZSBxdWV1ZWQgdXAgaGVyZSwg
YSBzaW5nbGUgY29tbWFuZCBjYW4gdHJpZ2dlciBtdWx0aXBsZQogIHdhdGNo
ZXMgKGUuZy4gZHVlIHRvIHJlY3Vyc2lvbikuCgpUaGUgb3ZlcmZsb3cgcXVl
dWUgY3VycmVudGx5IGRvZXNuJ3QgaGF2ZSBhbiB1cHBlciBib3VuZCwgaXQg
aXMgZGlmZmljdWx0IHRvCmFjY3VyYXRlbHkgY2FsY3VsYXRlIG9uZSBhcyBp
dCBkZXBlbmRzIG9uIHdoZXRoZXIgeW91IGFyZSBEb20wIGFuZCBob3cgbWFu
eQp3YXRjaGVzIGVhY2ggcGF0aCBoYXMgcmVnaXN0ZXJlZCBhbmQgaG93IG1h
bnkgd2F0Y2ggZXZlbnRzIHlvdSBjYW4gdHJpZ2dlcgp3aXRoIGEgc2luZ2xl
IGNvbW1hbmQgKGUuZy4gYSBjb21taXQpLiAgSG93ZXZlciB0aGVzZSBldmVu
dHMgd2VyZSBhbHJlYWR5CnVzaW5nIG1lbW9yeSwgdGhpcyBqdXN0IG1vdmVz
IHRoZW0gZWxzZXdoZXJlLCBhbmQgYXMgbG9uZyBhcyB3ZSBjb3JyZWN0bHkK
YmxvY2sgYSBkb21haW4gaXQgc2hvdWxkbid0IHJlc3VsdCBpbiB1bmJvdW5k
ZWQgbWVtb3J5IHVzYWdlLgoKTm90ZSB0aGF0IERvbTAgaXMgbm90IGV4Y2x1
ZGVkIGZyb20gdGhlc2UgY2hlY2tzLCBpdCBpcyBpbXBvcnRhbnQgdGhhdCBE
b20wIGlzCmVzcGVjaWFsbHkgbm90IGV4Y2x1ZGVkIHdoZW4gaXQgaXMgdGhl
IHNvdXJjZSwgc2luY2UgdGhlcmUgYXJlIG1hbnkgd2F5cyBpbgp3aGljaCBh
IGd1ZXN0IGNvdWxkIHRyaWdnZXIgRG9tMCB0byBzZW5kIGl0IHdhdGNoIGV2
ZW50cy4KClRoaXMgc2hvdWxkIHByb3RlY3QgYWdhaW5zdCBtYWxpY2lvdXMg
ZnJvbnRlbmRzIGFzIGxvbmcgYXMgdGhlIGJhY2tlbmQgZm9sbG93cwp0aGUg
UFYgeGVuc3RvcmUgcHJvdG9jb2wgYW5kIG9ubHkgZXhwb3NlcyBwYXRocyBu
ZWVkZWQgYnkgdGhlIGZyb250ZW5kLCBhbmQKY2hhbmdlcyB0aG9zZSBwYXRo
cyBhdCBtb3N0IG9uY2UgYXMgYSByZWFjdGlvbiB0byBndWVzdCBldmVudHMs
IG9yIHByb3RvY29sCnN0YXRlLgoKVGhlIHF1ZXVlIGxpbWl0cyBhcmUgcGVy
IHdhdGNoLCBhbmQgcGVyIGRvbWFpbi1wYWlyLCBzbyBldmVuIGlmIG9uZQpj
b21tdW5pY2F0aW9uIGNoYW5uZWwgd291bGQgYmUgImJsb2NrZWQiLCBvdGhl
cnMgd291bGQga2VlcCB3b3JraW5nLCBhbmQgdGhlCmRvbWFpbiBpdHNlbGYg
d29uJ3QgZ2V0IGJsb2NrZWQgYXMgbG9uZyBhcyBpdCBkb2Vzbid0IG92ZXJm
bG93IHRoZSBxdWV1ZSBvZgp3YXRjaCBldmVudHMuCgpTaW1pbGFybHkgYSBt
YWxpY2lvdXMgYmFja2VuZCBjb3VsZCBjYXVzZSB0aGUgZnJvbnRlbmQgdG8g
Z2V0IGJsb2NrZWQsIGJ1dAp0aGlzIHdhdGNoIHF1ZXVlIHByb3RlY3RzIHRo
ZSBmcm9udGVuZCBhcyB3ZWxsIGFzIGxvbmcgYXMgaXQgZm9sbG93cyB0aGUg
UFYKcHJvdG9jb2wuICAoQWx0aG91Z2ggbm90ZSB0aGF0IHByb3RlY3Rpb24g
YWdhaW5zdCBtYWxpY2lvdXMgYmFja2VuZHMgaXMgb25seSBhCmJlc3QgZWZm
b3J0IGF0IHRoZSBtb21lbnQpCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAv
IENWRS0yMDIyLTQyMzE4LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLD
tmsgPGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3Rp
YW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbCBiL3Rvb2xzL29j
YW1sL2xpYnMveGIveGIubWwKaW5kZXggNDE5N2EzODg4YTY4Li5iMjkyZWQ3
YTg3NGQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveGIveGIubWwK
KysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbApAQCAtMTM0LDE0ICsx
MzQsNDQgQEAgdHlwZSBiYWNrZW5kID0gRmQgb2YgYmFja2VuZF9mZCB8IFhl
bm1tYXAgb2YgYmFja2VuZF9tbWFwCiAKIHR5cGUgcGFydGlhbF9idWYgPSBI
YXZlSGRyIG9mIFBhcnRpYWwucGt0IHwgTm9IZHIgb2YgaW50ICogYnl0ZXMK
IAorKCoKKwlzZXBhcmF0ZSBjYXBhY2l0eSByZXNlcnZhdGlvbiBmb3IgcmVw
bGllcyBhbmQgd2F0Y2ggZXZlbnRzOgorCXRoaXMgYWxsb3dzIGEgZG9tYWlu
IHRvIGtlZXAgd29ya2luZyBldmVuIHdoZW4gdW5kZXIgYSBjb25zdGFudCBm
bG9vZCBvZgorCXdhdGNoIGV2ZW50cworKikKK3R5cGUgY2FwYWNpdHkgPSB7
IG1heG91dHN0YW5kaW5nOiBpbnQ7IG1heHdhdGNoZXZlbnRzOiBpbnQgfQor
Cittb2R1bGUgUXVldWUgPSBCb3VuZGVkUXVldWUKKwordHlwZSBwYWNrZXRf
Y2xhc3MgPQorCXwgQ29tbWFuZFJlcGx5CisJfCBXYXRjaGV2ZW50CisKK2xl
dCBzdHJpbmdfb2ZfcGFja2V0X2NsYXNzID0gZnVuY3Rpb24KKwl8IENvbW1h
bmRSZXBseSAtPiAiY29tbWFuZF9yZXBseSIKKwl8IFdhdGNoZXZlbnQgLT4g
IndhdGNoX2V2ZW50IgorCiB0eXBlIHQgPQogewogCWJhY2tlbmQ6IGJhY2tl
bmQ7Ci0JcGt0X291dDogUGFja2V0LnQgUXVldWUudDsKKwlwa3Rfb3V0OiAo
UGFja2V0LnQsIHBhY2tldF9jbGFzcykgUXVldWUudDsKIAltdXRhYmxlIHBh
cnRpYWxfaW46IHBhcnRpYWxfYnVmOwogCW11dGFibGUgcGFydGlhbF9vdXQ6
IHN0cmluZzsKKwljYXBhY2l0eTogY2FwYWNpdHkKIH0KIAorbGV0IHRvX3Jl
YWQgY29uID0KKwltYXRjaCBjb24ucGFydGlhbF9pbiB3aXRoCisJCXwgSGF2
ZUhkciBwYXJ0aWFsX3BrdCAtPiBQYXJ0aWFsLnRvX2NvbXBsZXRlIHBhcnRp
YWxfcGt0CisJCXwgTm9IZHIgICAoaSwgXykgICAgLT4gaQorCitsZXQgZGVi
dWcgdCA9CisJUHJpbnRmLnNwcmludGYgIlhlbkJ1cyBzdGF0ZTogcGFydGlh
bF9pbjogJWQgbmVlZGVkLCBwYXJ0aWFsX291dDogJWQgYnl0ZXMsIHBrdF9v
dXQ6ICVkIHBhY2tldHMsICVzIgorCQkodG9fcmVhZCB0KQorCQkoU3RyaW5n
Lmxlbmd0aCB0LnBhcnRpYWxfb3V0KQorCQkoUXVldWUubGVuZ3RoIHQucGt0
X291dCkKKwkJKEJvdW5kZWRRdWV1ZS5kZWJ1ZyBzdHJpbmdfb2ZfcGFja2V0
X2NsYXNzIHQucGt0X291dCkKKwogbGV0IGluaXRfcGFydGlhbF9pbiAoKSA9
IE5vSGRyCiAJKFBhcnRpYWwuaGVhZGVyX3NpemUgKCksIEJ5dGVzLm1ha2Ug
KFBhcnRpYWwuaGVhZGVyX3NpemUoKSkgJ1wwMDAnKQogCkBAIC0xOTksNyAr
MjI5LDggQEAgbGV0IG91dHB1dCBjb24gPQogCWxldCBzID0gaWYgU3RyaW5n
Lmxlbmd0aCBjb24ucGFydGlhbF9vdXQgPiAwIHRoZW4KIAkJCWNvbi5wYXJ0
aWFsX291dAogCQllbHNlIGlmIFF1ZXVlLmxlbmd0aCBjb24ucGt0X291dCA+
IDAgdGhlbgotCQkJUGFja2V0LnRvX3N0cmluZyAoUXVldWUucG9wIGNvbi5w
a3Rfb3V0KQorCQkJbGV0IHBrdCA9IFF1ZXVlLnBvcCBjb24ucGt0X291dCBp
bgorCQkJUGFja2V0LnRvX3N0cmluZyBwa3QKIAkJZWxzZQogCQkJIiIgaW4K
IAkoKiBzZW5kIGRhdGEgZnJvbSBzLCBhbmQgc2F2ZSB0aGUgdW5zZW50IGRh
dGEgdG8gcGFydGlhbF9vdXQgKikKQEAgLTIxMiwxMiArMjQzLDE1IEBAIGxl
dCBvdXRwdXQgY29uID0KIAkoKiBhZnRlciBzZW5kaW5nIG9uZSBwYWNrZXQs
IHBhcnRpYWwgaXMgZW1wdHkgKikKIAljb24ucGFydGlhbF9vdXQgPSAiIgog
CisoKiB3ZSBjYW4gb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCBpZiB3
ZSdyZSBndWFyYW50ZWVkIHRvIGhhdmUgcm9vbQorICAgdG8gc3RvcmUgdGhl
IHJlc3BvbnNlIHBhY2tldCAqKQorbGV0IGNhbl9pbnB1dCBjb24gPSBRdWV1
ZS5jYW5fcHVzaCBjb24ucGt0X291dCBDb21tYW5kUmVwbHkKKwogKCogTkI6
IGNhbiB0aHJvdyBSZWNvbm5lY3QgKikKIGxldCBpbnB1dCBjb24gPQotCWxl
dCB0b19yZWFkID0KLQkJbWF0Y2ggY29uLnBhcnRpYWxfaW4gd2l0aAotCQl8
IEhhdmVIZHIgcGFydGlhbF9wa3QgLT4gUGFydGlhbC50b19jb21wbGV0ZSBw
YXJ0aWFsX3BrdAotCQl8IE5vSGRyICAgKGksIF8pICAgIC0+IGkgaW4KKwlp
ZiBub3QgKGNhbl9pbnB1dCBjb24pIHRoZW4gTm9uZQorCWVsc2UKKwlsZXQg
dG9fcmVhZCA9IHRvX3JlYWQgY29uIGluCiAKIAkoKiB0cnkgdG8gZ2V0IG1v
cmUgZGF0YSBmcm9tIGlucHV0IHN0cmVhbSAqKQogCWxldCBiID0gQnl0ZXMu
bWFrZSB0b19yZWFkICdcMDAwJyBpbgpAQCAtMjQzLDExICsyNzcsMjIgQEAg
bGV0IGlucHV0IGNvbiA9CiAJCU5vbmUKIAkpCiAKLWxldCBuZXdjb24gYmFj
a2VuZCA9IHsKK2xldCBjbGFzc2lmeSB0ID0KKwltYXRjaCB0LlBhY2tldC50
eSB3aXRoCisJfCBPcC5XYXRjaGV2ZW50IC0+IFdhdGNoZXZlbnQKKwl8IF8g
LT4gQ29tbWFuZFJlcGx5CisKK2xldCBuZXdjb24gfmNhcGFjaXR5IGJhY2tl
bmQgPQorCWxldCBsaW1pdCA9IGZ1bmN0aW9uCisJCXwgQ29tbWFuZFJlcGx5
IC0+IGNhcGFjaXR5Lm1heG91dHN0YW5kaW5nCisJCXwgV2F0Y2hldmVudCAt
PiBjYXBhY2l0eS5tYXh3YXRjaGV2ZW50cworCWluCisJewogCWJhY2tlbmQg
PSBiYWNrZW5kOwotCXBrdF9vdXQgPSBRdWV1ZS5jcmVhdGUgKCk7CisJcGt0
X291dCA9IFF1ZXVlLmNyZWF0ZSB+Y2FwYWNpdHk6KGNhcGFjaXR5Lm1heG91
dHN0YW5kaW5nICsgY2FwYWNpdHkubWF4d2F0Y2hldmVudHMpIH5jbGFzc2lm
eSB+bGltaXQ7CiAJcGFydGlhbF9pbiA9IGluaXRfcGFydGlhbF9pbiAoKTsK
IAlwYXJ0aWFsX291dCA9ICIiOworCWNhcGFjaXR5ID0gY2FwYWNpdHk7CiAJ
fQogCiBsZXQgb3Blbl9mZCBmZCA9IG5ld2NvbiAoRmQgeyBmZCA9IGZkOyB9
KQpkaWZmIC0tZ2l0IGEvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkgYi90
b29scy9vY2FtbC9saWJzL3hiL3hiLm1saQppbmRleCA5MWM2ODIxNjJjZWEu
LjcxYjI3NTRjYTc4OCAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94
Yi94Yi5tbGkKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yi94Yi5tbGkKQEAg
LTY2LDEwICs2NiwxMSBAQCB0eXBlIGJhY2tlbmRfbW1hcCA9IHsKIHR5cGUg
YmFja2VuZF9mZCA9IHsgZmQgOiBVbml4LmZpbGVfZGVzY3I7IH0KIHR5cGUg
YmFja2VuZCA9IEZkIG9mIGJhY2tlbmRfZmQgfCBYZW5tbWFwIG9mIGJhY2tl
bmRfbW1hcAogdHlwZSBwYXJ0aWFsX2J1ZiA9IEhhdmVIZHIgb2YgUGFydGlh
bC5wa3QgfCBOb0hkciBvZiBpbnQgKiBieXRlcwordHlwZSBjYXBhY2l0eSA9
IHsgbWF4b3V0c3RhbmRpbmc6IGludDsgbWF4d2F0Y2hldmVudHM6IGludCB9
CiB0eXBlIHQKIHZhbCBpbml0X3BhcnRpYWxfaW4gOiB1bml0IC0+IHBhcnRp
YWxfYnVmCiB2YWwgcmVjb25uZWN0IDogdCAtPiB1bml0Ci12YWwgcXVldWUg
OiB0IC0+IFBhY2tldC50IC0+IHVuaXQKK3ZhbCBxdWV1ZSA6IHQgLT4gUGFj
a2V0LnQgLT4gdW5pdCBvcHRpb24KIHZhbCByZWFkX2ZkIDogYmFja2VuZF9m
ZCAtPiAnYSAtPiBieXRlcyAtPiBpbnQgLT4gaW50CiB2YWwgcmVhZF9tbWFw
IDogYmFja2VuZF9tbWFwIC0+ICdhIC0+IGJ5dGVzIC0+IGludCAtPiBpbnQK
IHZhbCByZWFkIDogdCAtPiBieXRlcyAtPiBpbnQgLT4gaW50CkBAIC03OCwx
MyArNzksMTQgQEAgdmFsIHdyaXRlX21tYXAgOiBiYWNrZW5kX21tYXAgLT4g
J2EgLT4gc3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCB3cml0ZSA6IHQgLT4g
c3RyaW5nIC0+IGludCAtPiBpbnQKIHZhbCBvdXRwdXQgOiB0IC0+IGJvb2wK
IHZhbCBpbnB1dCA6IHQgLT4gUGFja2V0LnQgb3B0aW9uCi12YWwgbmV3Y29u
IDogYmFja2VuZCAtPiB0Ci12YWwgb3Blbl9mZCA6IFVuaXguZmlsZV9kZXNj
ciAtPiB0Ci12YWwgb3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFj
ZSAtPiAodW5pdCAtPiB1bml0KSAtPiB0Cit2YWwgbmV3Y29uIDogY2FwYWNp
dHk6Y2FwYWNpdHkgLT4gYmFja2VuZCAtPiB0Cit2YWwgb3Blbl9mZCA6IFVu
aXguZmlsZV9kZXNjciAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0Cit2YWwg
b3Blbl9tbWFwIDogWGVubW1hcC5tbWFwX2ludGVyZmFjZSAtPiAodW5pdCAt
PiB1bml0KSAtPiBjYXBhY2l0eTpjYXBhY2l0eSAtPiB0CiB2YWwgY2xvc2Ug
OiB0IC0+IHVuaXQKIHZhbCBpc19mZCA6IHQgLT4gYm9vbAogdmFsIGlzX21t
YXAgOiB0IC0+IGJvb2wKIHZhbCBvdXRwdXRfbGVuIDogdCAtPiBpbnQKK3Zh
bCBjYW5faW5wdXQ6IHQgLT4gYm9vbAogdmFsIGhhc19uZXdfb3V0cHV0IDog
dCAtPiBib29sCiB2YWwgaGFzX29sZF9vdXRwdXQgOiB0IC0+IGJvb2wKIHZh
bCBoYXNfb3V0cHV0IDogdCAtPiBib29sCkBAIC05MywzICs5NSw0IEBAIHZh
bCBoYXNfcGFydGlhbF9pbnB1dCA6IHQgLT4gYm9vbAogdmFsIGhhc19tb3Jl
X2lucHV0IDogdCAtPiBib29sCiB2YWwgaXNfc2VsZWN0YWJsZSA6IHQgLT4g
Ym9vbAogdmFsIGdldF9mZCA6IHQgLT4gVW5peC5maWxlX2Rlc2NyCit2YWwg
ZGVidWc6IHQgLT4gc3RyaW5nCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC9s
aWJzL3hzL3F1ZXVlb3AubWwgYi90b29scy9vY2FtbC9saWJzL3hzL3F1ZXVl
b3AubWwKaW5kZXggOWZmNWJiZDUyOWNlLi40ZTUzMmNkYWVhY2IgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveHMvcXVldWVvcC5tbAorKysgYi90
b29scy9vY2FtbC9saWJzL3hzL3F1ZXVlb3AubWwKQEAgLTE2LDkgKzE2LDEw
IEBACiBvcGVuIFhlbmJ1cwogCiBsZXQgZGF0YV9jb25jYXQgbHMgPSAoU3Ry
aW5nLmNvbmNhdCAiXDAwMCIgbHMpIF4gIlwwMDAiCitsZXQgcXVldWUgY29u
IHBrdCA9IGxldCByID0gWGIucXVldWUgY29uIHBrdCBpbiBhc3NlcnQgKHIg
PD4gTm9uZSkKIGxldCBxdWV1ZV9wYXRoIHR5ICh0aWQ6IGludCkgKHBhdGg6
IHN0cmluZykgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0
aDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSB0aWQg
MCB0eSBkYXRhKQogCiAoKiBvcGVyYXRpb25zICopCiBsZXQgZGlyZWN0b3J5
IHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuRGlyZWN0b3J5IHRp
ZCBwYXRoIGNvbgpAQCAtMjcsNDggKzI4LDQ4IEBAIGxldCByZWFkIHRpZCBw
YXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuUmVhZCB0aWQgcGF0aCBjb24K
IGxldCBnZXRwZXJtcyB0aWQgcGF0aCBjb24gPSBxdWV1ZV9wYXRoIFhiLk9w
LkdldHBlcm1zIHRpZCBwYXRoIGNvbgogCiBsZXQgZGVidWcgY29tbWFuZHMg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLkRlYnVnIChkYXRhX2NvbmNhdCBjb21tYW5kcykpCisJcXVldWUgY29u
IChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5EZWJ1ZyAoZGF0YV9jb25j
YXQgY29tbWFuZHMpKQogCiBsZXQgd2F0Y2ggcGF0aCBkYXRhIGNvbiA9CiAJ
bGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7IGRhdGE7IF0gaW4KLQlY
Yi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhiLk9wLldhdGNo
IGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5P
cC5XYXRjaCBkYXRhKQogCiBsZXQgdW53YXRjaCBwYXRoIGRhdGEgY29uID0K
IAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgcGF0aDsgZGF0YTsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuVW53
YXRjaCBkYXRhKQorCXF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAg
WGIuT3AuVW53YXRjaCBkYXRhKQogCiBsZXQgdHJhbnNhY3Rpb25fc3RhcnQg
Y29uID0KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgMCAwIFhi
Lk9wLlRyYW5zYWN0aW9uX3N0YXJ0IChkYXRhX2NvbmNhdCBbXSkpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5UcmFuc2FjdGlv
bl9zdGFydCAoZGF0YV9jb25jYXQgW10pKQogCiBsZXQgdHJhbnNhY3Rpb25f
ZW5kIHRpZCBjb21taXQgY29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0
IFsgKGlmIGNvbW1pdCB0aGVuICJUIiBlbHNlICJGIik7IF0gaW4KLQlYYi5x
dWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuVHJhbnNh
Y3Rpb25fZW5kIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRl
IHRpZCAwIFhiLk9wLlRyYW5zYWN0aW9uX2VuZCBkYXRhKQogCiBsZXQgaW50
cm9kdWNlIGRvbWlkIG1mbiBwb3J0IGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRh
X2NvbmNhdCBbIFByaW50Zi5zcHJpbnRmICIldSIgZG9taWQ7CiAJICAgICAg
ICAgICAgICAgICAgICAgICAgIFByaW50Zi5zcHJpbnRmICIlbnUiIG1mbjsK
IAkgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nX29mX2ludCBwb3J0
OyBdIGluCi0JWGIucXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5JbnRyb2R1Y2UgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBhY2tldC5j
cmVhdGUgMCAwIFhiLk9wLkludHJvZHVjZSBkYXRhKQogCiBsZXQgcmVsZWFz
ZSBkb21pZCBjb24gPQogCWxldCBkYXRhID0gZGF0YV9jb25jYXQgWyBQcmlu
dGYuc3ByaW50ZiAiJXUiIGRvbWlkOyBdIGluCi0JWGIucXVldWUgY29uIChY
Yi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRhdGEpCisJcXVl
dWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBYYi5PcC5SZWxlYXNlIGRh
dGEpCiAKIGxldCByZXN1bWUgZG9taWQgY29uID0KIAlsZXQgZGF0YSA9IGRh
dGFfY29uY2F0IFsgUHJpbnRmLnNwcmludGYgIiV1IiBkb21pZDsgXSBpbgot
CVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuUmVz
dW1lIGRhdGEpCisJcXVldWUgY29uIChYYi5QYWNrZXQuY3JlYXRlIDAgMCBY
Yi5PcC5SZXN1bWUgZGF0YSkKIAogbGV0IGdldGRvbWFpbnBhdGggZG9taWQg
Y29uID0KIAlsZXQgZGF0YSA9IGRhdGFfY29uY2F0IFsgUHJpbnRmLnNwcmlu
dGYgIiV1IiBkb21pZDsgXSBpbgotCVhiLnF1ZXVlIGNvbiAoWGIuUGFja2V0
LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0aCBkYXRhKQorCXF1ZXVl
IGNvbiAoWGIuUGFja2V0LmNyZWF0ZSAwIDAgWGIuT3AuR2V0ZG9tYWlucGF0
aCBkYXRhKQogCiBsZXQgd3JpdGUgdGlkIHBhdGggdmFsdWUgY29uID0KIAls
ZXQgZGF0YSA9IHBhdGggXiAiXDAwMCIgXiB2YWx1ZSAoKiBubyBOVUxMIGF0
IHRoZSBlbmQgKikgaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVh
dGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuV3JpdGUgZGF0YSkKIAogbGV0IG1r
ZGlyIHRpZCBwYXRoIGNvbiA9IHF1ZXVlX3BhdGggWGIuT3AuTWtkaXIgdGlk
IHBhdGggY29uCiBsZXQgcm0gdGlkIHBhdGggY29uID0gcXVldWVfcGF0aCBY
Yi5PcC5SbSB0aWQgcGF0aCBjb24KIAogbGV0IHNldHBlcm1zIHRpZCBwYXRo
IHBlcm1zIGNvbiA9CiAJbGV0IGRhdGEgPSBkYXRhX2NvbmNhdCBbIHBhdGg7
IHBlcm1zIF0gaW4KLQlYYi5xdWV1ZSBjb24gKFhiLlBhY2tldC5jcmVhdGUg
dGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKKwlxdWV1ZSBjb24gKFhiLlBh
Y2tldC5jcmVhdGUgdGlkIDAgWGIuT3AuU2V0cGVybXMgZGF0YSkKZGlmZiAt
LWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwgYi90b29scy9v
Y2FtbC9saWJzL3hzL3hzcmF3Lm1sCmluZGV4IDQ1MWY4YjM4ZGJjYy4uY2Jk
MTcyODA2MDBjIDEwMDY0NAotLS0gYS90b29scy9vY2FtbC9saWJzL3hzL3hz
cmF3Lm1sCisrKyBiL3Rvb2xzL29jYW1sL2xpYnMveHMveHNyYXcubWwKQEAg
LTM2LDggKzM2LDEwIEBAIHR5cGUgY29uID0gewogbGV0IGNsb3NlIGNvbiA9
CiAJWGIuY2xvc2UgY29uLnhiCiAKK2xldCBjYXBhY2l0eSA9IHsgWGIubWF4
b3V0c3RhbmRpbmcgPSAxOyBtYXh3YXRjaGV2ZW50cyA9IDA7IH0KKwogbGV0
IG9wZW5fZmQgZmQgPSB7Ci0JeGIgPSBYYi5vcGVuX2ZkIGZkOworCXhiID0g
WGIub3Blbl9mZCB+Y2FwYWNpdHkgZmQ7CiAJd2F0Y2hldmVudHMgPSBRdWV1
ZS5jcmVhdGUgKCk7CiB9CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hl
bnN0b3JlZC9jb25uZWN0aW9uLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVk
L2Nvbm5lY3Rpb24ubWwKaW5kZXggM2Y2YThmMWFkMGY3Li41NGY3Zjc2NTE2
N2IgMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0
aW9uLm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9u
Lm1sCkBAIC0yMCwxMiArMjAsODQgQEAgb3BlbiBTdGRleHQKIAogbGV0IHhl
bnN0b3JlX3BheWxvYWRfbWF4ID0gNDA5NiAoKiB4ZW4vaW5jbHVkZS9wdWJs
aWMvaW8veHNfd2lyZS5oICopCiAKK3R5cGUgJ2EgYm91bmRlZF9zZW5kZXIg
PSAnYSAtPiB1bml0IG9wdGlvbgorKCoqIGEgYm91bmRlZCBzZW5kZXIgYWNj
ZXB0cyBhbiBbJ2FdIGl0ZW0gYW5kIHJldHVybnM6CisgICAgTm9uZSAtIGlm
IHRoZXJlIGlzIG5vIHJvb20gdG8gYWNjZXB0IHRoZSBpdGVtCisgICAgU29t
ZSAoKSAtICBpZiBpdCBoYXMgc3VjY2Vzc2Z1bGx5IGFjY2VwdGVkL3NlbnQg
dGhlIGl0ZW0KKyAqKQorCittb2R1bGUgQm91bmRlZFBpcGUgOiBzaWcKKwl0
eXBlICdhIHQKKworCSgqKiBbY3JlYXRlIH5jYXBhY2l0eSB+ZGVzdGluYXRp
b25dIGNyZWF0ZXMgYSBib3VuZGVkIHBpcGUgd2l0aCBhCisJICAgIGxvY2Fs
IGJ1ZmZlciBob2xkaW5nIGF0IG1vc3QgW2NhcGFjaXR5XSBpdGVtcy4gIE9u
Y2UgdGhlIGJ1ZmZlciBpcworCSAgICBmdWxsIGl0IHdpbGwgbm90IGFjY2Vw
dCBmdXJ0aGVyIGl0ZW1zLiAgaXRlbXMgZnJvbSB0aGUgcGlwZSBhcmUKKwkg
ICAgZmx1c2hlZCBpbnRvIFtkZXN0aW5hdGlvbl0gYXMgbG9uZyBhcyBpdCBh
Y2NlcHRzIGl0ZW1zLiAgVGhlCisJICAgIGRlc3RpbmF0aW9uIGNvdWxkIGJl
IGFub3RoZXIgcGlwZS4KKwkgKikKKwl2YWwgY3JlYXRlOiBjYXBhY2l0eTpp
bnQgLT4gZGVzdGluYXRpb246J2EgYm91bmRlZF9zZW5kZXIgLT4gJ2EgdAor
CisJKCoqIFtpc19lbXB0eSB0XSByZXR1cm5zIHdoZXRoZXIgdGhlIGxvY2Fs
IGJ1ZmZlciBvZiBbdF0gaXMgZW1wdHkuICopCisJdmFsIGlzX2VtcHR5IDog
XyB0IC0+IGJvb2wKKworCSgqKiBbbGVuZ3RoIHRdIHRoZSBudW1iZXIgb2Yg
aXRlbXMgaW4gdGhlIGludGVybmFsIGJ1ZmZlciAqKQorCXZhbCBsZW5ndGg6
IF8gdCAtPiBpbnQKKworCSgqKiBbZmx1c2hfcGlwZSB0XSBzZW5kcyBhcyBt
YW55IGl0ZW1zIGZyb20gdGhlIGxvY2FsIGJ1ZmZlciBhcyBwb3NzaWJsZSwK
KwkJCXdoaWNoIGNvdWxkIGJlIG5vbmUuICopCisJdmFsIGZsdXNoX3BpcGU6
IF8gdCAtPiB1bml0CisKKwkoKiogW3B1c2ggdCBpdGVtXSB0cmllcyB0byBb
Zmx1c2hfcGlwZV0gYW5kIHRoZW4gcHVzaCBbaXRlbV0KKwkgICAgaW50byB0
aGUgcGlwZSBpZiBpdHMgW2NhcGFjaXR5XSBhbGxvd3MuCisJICAgIFJldHVy
bnMgW05vbmVdIGlmIHRoZXJlIGlzIG5vIG1vcmUgcm9vbQorCSAqKQorCXZh
bCBwdXNoIDogJ2EgdCAtPiAnYSBib3VuZGVkX3NlbmRlcgorZW5kID0gc3Ry
dWN0CisJKCogaXRlbXMgYXJlIGVucXVldWVkIGluIFtxXSwgYW5kIHRoZW4g
Zmx1c2hlZCB0byBbY29ubmVjdF90b10gKikKKwl0eXBlICdhIHQgPQorCQl7
IHE6ICdhIFF1ZXVlLnQKKwkJOyBkZXN0aW5hdGlvbjogJ2EgYm91bmRlZF9z
ZW5kZXIKKwkJOyBjYXBhY2l0eTogaW50CisJCX0KKworCWxldCBjcmVhdGUg
fmNhcGFjaXR5IH5kZXN0aW5hdGlvbiA9CisJCXsgcSA9IFF1ZXVlLmNyZWF0
ZSAoKTsgY2FwYWNpdHk7IGRlc3RpbmF0aW9uIH0KKworCWxldCByZWMgZmx1
c2hfcGlwZSB0ID0KKwkJaWYgbm90IFF1ZXVlLihpc19lbXB0eSB0LnEpIHRo
ZW4KKwkJCWxldCBpdGVtID0gUXVldWUucGVlayB0LnEgaW4KKwkJCW1hdGNo
IHQuZGVzdGluYXRpb24gaXRlbSB3aXRoCisJCQl8IE5vbmUgLT4gKCkgKCog
bm8gcm9vbSAqKQorCQkJfCBTb21lICgpIC0+CisJCQkJKCogc3VjY2Vzc2Z1
bGx5IHNlbnQgaXRlbSB0byBuZXh0IHN0YWdlICopCisJCQkJbGV0IF8gPSBR
dWV1ZS5wb3AgdC5xIGluCisJCQkJKCogY29udGludWUgdHJ5aW5nIHRvIHNl
bmQgbW9yZSBpdGVtcyAqKQorCQkJCWZsdXNoX3BpcGUgdAorCisJbGV0IHB1
c2ggdCBpdGVtID0KKwkJKCogZmlyc3QgdHJ5IHRvIGZsdXNoIGFzIG1hbnkg
aXRlbXMgZnJvbSB0aGlzIHBpcGUgYXMgcG9zc2libGUgdG8gbWFrZSByb29t
LAorCQkgICBpdCBpcyBpbXBvcnRhbnQgdG8gZG8gdGhpcyBmaXJzdCB0byBw
cmVzZXJ2ZSB0aGUgb3JkZXIgb2YgdGhlIGl0ZW1zCisJCSAqKQorCQlmbHVz
aF9waXBlIHQ7CisJCWlmIFF1ZXVlLmxlbmd0aCB0LnEgPCB0LmNhcGFjaXR5
IHRoZW4gYmVnaW4KKwkJCSgqIGVucXVldWUsIGluc3RlYWQgb2Ygc2VuZGlu
ZyBkaXJlY3RseS4KKwkJCSAgIHRoaXMgZW5zdXJlcyB0aGF0IFtvdXRdIHNl
ZXMgdGhlIGl0ZW1zIGluIHRoZSBzYW1lIG9yZGVyIGFzIHdlIHJlY2VpdmUg
dGhlbQorCQkJICopCisJCQlRdWV1ZS5wdXNoIGl0ZW0gdC5xOworCQkJU29t
ZSAoZmx1c2hfcGlwZSB0KQorCQllbmQgZWxzZSBOb25lCisKKwlsZXQgaXNf
ZW1wdHkgdCA9IFF1ZXVlLmlzX2VtcHR5IHQucQorCWxldCBsZW5ndGggdCA9
IFF1ZXVlLmxlbmd0aCB0LnEKK2VuZAorCiB0eXBlIHdhdGNoID0gewogCWNv
bjogdDsKIAl0b2tlbjogc3RyaW5nOwogCXBhdGg6IHN0cmluZzsKIAliYXNl
OiBzdHJpbmc7CiAJaXNfcmVsYXRpdmU6IGJvb2w7CisJcGVuZGluZ193YXRj
aGV2ZW50czogWGVuYnVzLlhiLlBhY2tldC50IEJvdW5kZWRQaXBlLnQ7CiB9
CiAKIGFuZCB0ID0gewpAQCAtMzgsOCArMTEwLDM2IEBAIGFuZCB0ID0gewog
CWFub25pZDogaW50OwogCW11dGFibGUgc3RhdF9uYl9vcHM6IGludDsKIAlt
dXRhYmxlIHBlcm06IFBlcm1zLkNvbm5lY3Rpb24udDsKKwlwZW5kaW5nX3Nv
dXJjZV93YXRjaGV2ZW50czogKHdhdGNoICogWGVuYnVzLlhiLlBhY2tldC50
KSBCb3VuZGVkUGlwZS50CiB9CiAKK21vZHVsZSBXYXRjaCA9IHN0cnVjdAor
CW1vZHVsZSBUID0gc3RydWN0CisJCXR5cGUgdCA9IHdhdGNoCisKKwkJbGV0
IGNvbXBhcmUgdzEgdzIgPQorCQkJKCogY2Fubm90IGNvbXBhcmUgd2F0Y2hl
cyBmcm9tIGRpZmZlcmVudCBjb25uZWN0aW9ucyAqKQorCQkJYXNzZXJ0ICh3
MS5jb24gPT0gdzIuY29uKTsKKwkJCW1hdGNoIFN0cmluZy5jb21wYXJlIHcx
LnRva2VuIHcyLnRva2VuIHdpdGgKKwkJCXwgMCAtPiBTdHJpbmcuY29tcGFy
ZSB3MS5wYXRoIHcyLnBhdGgKKwkJCXwgbiAtPiBuCisJZW5kCisJbW9kdWxl
IFNldCA9IFNldC5NYWtlKFQpCisKKwlsZXQgZmx1c2hfZXZlbnRzIHQgPQor
CQlCb3VuZGVkUGlwZS5mbHVzaF9waXBlIHQucGVuZGluZ193YXRjaGV2ZW50
czsKKwkJbm90IChCb3VuZGVkUGlwZS5pc19lbXB0eSB0LnBlbmRpbmdfd2F0
Y2hldmVudHMpCisKKwlsZXQgcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwkJ
Qm91bmRlZFBpcGUubGVuZ3RoIHQucGVuZGluZ193YXRjaGV2ZW50cworZW5k
CisKK2xldCBzb3VyY2VfZmx1c2hfd2F0Y2hldmVudHMgdCA9CisJQm91bmRl
ZFBpcGUuZmx1c2hfcGlwZSB0LnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRz
CisKK2xldCBzb3VyY2VfcGVuZGluZ193YXRjaGV2ZW50cyB0ID0KKwlCb3Vu
ZGVkUGlwZS5sZW5ndGggdC5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50cwor
CiBsZXQgbWFya19hc19iYWQgY29uID0KIAltYXRjaCBjb24uZG9tIHdpdGgK
IAl8Tm9uZSAtPiAoKQpAQCAtNjcsNyArMTY3LDggQEAgbGV0IHdhdGNoX2Ny
ZWF0ZSB+Y29uIH5wYXRoIH50b2tlbiA9IHsKIAl0b2tlbiA9IHRva2VuOwog
CXBhdGggPSBwYXRoOwogCWJhc2UgPSBnZXRfcGF0aCBjb247Ci0JaXNfcmVs
YXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4gJ0AnCisJ
aXNfcmVsYXRpdmUgPSBwYXRoLlswXSA8PiAnLycgJiYgcGF0aC5bMF0gPD4g
J0AnOworCXBlbmRpbmdfd2F0Y2hldmVudHMgPSBCb3VuZGVkUGlwZS5jcmVh
dGUgfmNhcGFjaXR5OiFEZWZpbmUubWF4d2F0Y2hldmVudHMgfmRlc3RpbmF0
aW9uOihYZW5idXMuWGIucXVldWUgY29uLnhiKQogfQogCiBsZXQgZ2V0X2Nv
biB3ID0gdy5jb24KQEAgLTkzLDYgKzE5NCw5IEBAIGxldCBtYWtlX3Blcm0g
ZG9tID0KIAlQZXJtcy5Db25uZWN0aW9uLmNyZWF0ZSB+cGVybXM6W1Blcm1z
LlJFQUQ7IFBlcm1zLldSSVRFXSBkb21pZAogCiBsZXQgY3JlYXRlIHhiY29u
IGRvbSA9CisJbGV0IGRlc3RpbmF0aW9uICh3YXRjaCwgcGt0KSA9CisJCUJv
dW5kZWRQaXBlLnB1c2ggd2F0Y2gucGVuZGluZ193YXRjaGV2ZW50cyBwa3QK
KwlpbgogCWxldCBpZCA9CiAJCW1hdGNoIGRvbSB3aXRoCiAJCXwgTm9uZSAt
PiBsZXQgb2xkID0gIWFub25faWRfbmV4dCBpbiBpbmNyIGFub25faWRfbmV4
dDsgb2xkCkBAIC0xMDksNiArMjEzLDE2IEBAIGxldCBjcmVhdGUgeGJjb24g
ZG9tID0KIAlhbm9uaWQgPSBpZDsKIAlzdGF0X25iX29wcyA9IDA7CiAJcGVy
bSA9IG1ha2VfcGVybSBkb207CisKKwkoKiB0aGUgYWN0dWFsIGNhcGFjaXR5
IHdpbGwgYmUgbG93ZXIsIHRoaXMgaXMgdXNlZCBhcyBhbiBvdmVyZmxvdwor
CSAgIGJ1ZmZlcjogYW55dGhpbmcgdGhhdCBkb2Vzbid0IGZpdCBlbHNld2hl
cmUgZ2V0cyBwdXQgaGVyZSwgb25seQorCSAgIGxpbWl0ZWQgYnkgdGhlIGFt
b3VudCBvZiB3YXRjaGVzIHRoYXQgeW91IGNhbiBnZW5lcmF0ZSB3aXRoIGEK
KwkgICBzaW5nbGUgeGVuc3RvcmUgY29tbWFuZCAod2hpY2ggaXMgZmluaXRl
LCBhbHRob3VnaCBwb3NzaWJseSB2ZXJ5CisJICAgbGFyZ2UgaW4gdGhlb3J5
IGZvciBEb20wKS4gIE9uY2UgdGhlIHBpcGUgaGVyZSBoYXMgYW55IGNvbnRl
bnRzIHRoZQorCSAgIGRvbWFpbiBpcyBibG9ja2VkIGZyb20gc2VuZGluZyBt
b3JlIGNvbW1hbmRzIHVudGlsIGl0IGlzIGVtcHR5CisJICAgYWdhaW4gdGhv
dWdoLgorCSAqKQorCXBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzID0gQm91
bmRlZFBpcGUuY3JlYXRlIH5jYXBhY2l0eTpTeXMubWF4X2FycmF5X2xlbmd0
aCB+ZGVzdGluYXRpb24KIAl9CiAJaW4KIAlMb2dnaW5nLm5ld19jb25uZWN0
aW9uIH50aWQ6VHJhbnNhY3Rpb24ubm9uZSB+Y29uOihnZXRfZG9tc3RyIGNv
bik7CkBAIC0xMjcsMTEgKzI0MSwxNyBAQCBsZXQgc2V0X3RhcmdldCBjb24g
dGFyZ2V0X2RvbWlkID0KIAogbGV0IGlzX2JhY2tlbmRfbW1hcCBjb24gPSBY
ZW5idXMuWGIuaXNfbW1hcCBjb24ueGIKIAotbGV0IHNlbmRfcmVwbHkgY29u
IHRpZCByaWQgdHkgZGF0YSA9CitsZXQgcGFja2V0X29mIGNvbiB0aWQgcmlk
IHR5IGRhdGEgPQogCWlmIChTdHJpbmcubGVuZ3RoIGRhdGEpID4geGVuc3Rv
cmVfcGF5bG9hZF9tYXggJiYgKGlzX2JhY2tlbmRfbW1hcCBjb24pIHRoZW4K
LQkJWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAoWGVuYnVzLlhiLlBhY2tldC5j
cmVhdGUgdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgIkUyQklHXDAwMCIp
CisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgWGVuYnVzLlhi
Lk9wLkVycm9yICJFMkJJR1wwMDAiCiAJZWxzZQotCQlYZW5idXMuWGIucXVl
dWUgY29uLnhiIChYZW5idXMuWGIuUGFja2V0LmNyZWF0ZSB0aWQgcmlkIHR5
IGRhdGEpCisJCVhlbmJ1cy5YYi5QYWNrZXQuY3JlYXRlIHRpZCByaWQgdHkg
ZGF0YQorCitsZXQgc2VuZF9yZXBseSBjb24gdGlkIHJpZCB0eSBkYXRhID0K
KwlsZXQgcmVzdWx0ID0gWGVuYnVzLlhiLnF1ZXVlIGNvbi54YiAocGFja2V0
X29mIGNvbiB0aWQgcmlkIHR5IGRhdGEpIGluCisJKCogc2hvdWxkIG5ldmVy
IGhhcHBlbjogd2Ugb25seSBwcm9jZXNzIGFuIGlucHV0IHBhY2tldCB3aGVu
IHRoZXJlIGlzIHJvb20gZm9yIGFuIG91dHB1dCBwYWNrZXQgKikKKwkoKiBh
bmQgdGhlIGxpbWl0IGZvciByZXBsaWVzIGlzIGRpZmZlcmVudCBmcm9tIHRo
ZSBsaW1pdCBmb3Igd2F0Y2ggZXZlbnRzICopCisJYXNzZXJ0IChyZXN1bHQg
PD4gTm9uZSkKIAogbGV0IHNlbmRfZXJyb3IgY29uIHRpZCByaWQgZXJyID0g
c2VuZF9yZXBseSBjb24gdGlkIHJpZCBYZW5idXMuWGIuT3AuRXJyb3IgKGVy
ciBeICJcMDAwIikKIGxldCBzZW5kX2FjayBjb24gdGlkIHJpZCB0eSA9IHNl
bmRfcmVwbHkgY29uIHRpZCByaWQgdHkgIk9LXDAwMCIKQEAgLTE4MSwxMSAr
MzAxLDExIEBAIGxldCBkZWxfd2F0Y2ggY29uIHBhdGggdG9rZW4gPQogCWFw
YXRoLCB3CiAKIGxldCBkZWxfd2F0Y2hlcyBjb24gPQotICBIYXNodGJsLmNs
ZWFyIGNvbi53YXRjaGVzOworICBIYXNodGJsLnJlc2V0IGNvbi53YXRjaGVz
OwogICBjb24ubmJfd2F0Y2hlcyA8LSAwCiAKIGxldCBkZWxfdHJhbnNhY3Rp
b25zIGNvbiA9Ci0gIEhhc2h0YmwuY2xlYXIgY29uLnRyYW5zYWN0aW9ucwor
ICBIYXNodGJsLnJlc2V0IGNvbi50cmFuc2FjdGlvbnMKIAogbGV0IGxpc3Rf
d2F0Y2hlcyBjb24gPQogCWxldCBsbCA9IEhhc2h0YmwuZm9sZApAQCAtMjA4
LDIxICszMjgsMjkgQEAgbGV0IGxvb2t1cF93YXRjaF9wZXJtIHBhdGggPSBm
dW5jdGlvbgogbGV0IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3Qg
cGF0aCA9CiAJbG9va3VwX3dhdGNoX3Blcm0gcGF0aCBvbGRyb290IEAgbG9v
a3VwX3dhdGNoX3Blcm0gcGF0aCAoU29tZSByb290KQogCi1sZXQgZmlyZV9z
aW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdhdGNoID0KK2xldCBmaXJlX3Npbmds
ZV93YXRjaF91bmNoZWNrZWQgc291cmNlIHdhdGNoID0KIAlsZXQgZGF0YSA9
IFV0aWxzLmpvaW5fYnlfbnVsbCBbd2F0Y2gucGF0aDsgd2F0Y2gudG9rZW47
ICIiXSBpbgotCXNlbmRfcmVwbHkgd2F0Y2guY29uIFRyYW5zYWN0aW9uLm5v
bmUgMCBYZW5idXMuWGIuT3AuV2F0Y2hldmVudCBkYXRhCisJbGV0IHBrdCA9
IHBhY2tldF9vZiB3YXRjaC5jb24gVHJhbnNhY3Rpb24ubm9uZSAwIFhlbmJ1
cy5YYi5PcC5XYXRjaGV2ZW50IGRhdGEgaW4KKworCW1hdGNoIEJvdW5kZWRQ
aXBlLnB1c2ggc291cmNlLnBlbmRpbmdfc291cmNlX3dhdGNoZXZlbnRzICh3
YXRjaCwgcGt0KSB3aXRoCisJfCBTb21lICgpIC0+ICgpICgqIHBhY2tldCBx
dWV1ZWQgKikKKwl8IE5vbmUgLT4KKwkJCSgqIGEgd2VsbCBiZWhhdmVkIERv
bTAgc2hvdWxkbid0IGJlIGFibGUgdG8gdHJpZ2dlciB0aGlzLAorCQkJICAg
aWYgaXQgaGFwcGVucyBpdCBpcyBsaWtlbHkgYSBEb20wIGJ1ZyBjYXVzaW5n
IHJ1bmF3YXkgbWVtb3J5IHVzYWdlCisJCQkgKikKKwkJCWZhaWx3aXRoICJ3
YXRjaCBldmVudCBvdmVyZmxvdywgY2Fubm90IGhhcHBlbiIKIAotbGV0IGZp
cmVfc2luZ2xlX3dhdGNoIChvbGRyb290LCByb290KSB3YXRjaCA9CitsZXQg
ZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIChvbGRyb290LCByb290KSB3YXRj
aCA9CiAJbGV0IGFic3BhdGggPSBnZXRfd2F0Y2hfcGF0aCB3YXRjaC5jb24g
d2F0Y2gucGF0aCB8PiBTdG9yZS5QYXRoLm9mX3N0cmluZyBpbgogCWxldCBw
ZXJtcyA9IGxvb2t1cF93YXRjaF9wZXJtcyBvbGRyb290IHJvb3QgYWJzcGF0
aCBpbgogCWlmIFBlcm1zLmNhbl9maXJlX3dhdGNoIHdhdGNoLmNvbi5wZXJt
IHBlcm1zIHRoZW4KLQkJZmlyZV9zaW5nbGVfd2F0Y2hfdW5jaGVja2VkIHdh
dGNoCisJCWZpcmVfc2luZ2xlX3dhdGNoX3VuY2hlY2tlZCBzb3VyY2Ugd2F0
Y2gKIAllbHNlCiAJCWxldCBwZXJtcyA9IHBlcm1zIHw+IExpc3QubWFwIChQ
ZXJtcy5Ob2RlLnRvX3N0cmluZyB+c2VwOiIgIikgfD4gU3RyaW5nLmNvbmNh
dCAiLCAiIGluCiAJCWxldCBjb24gPSBnZXRfZG9tc3RyIHdhdGNoLmNvbiBp
bgogCQlMb2dnaW5nLndhdGNoX25vdF9maXJlZCB+Y29uIHBlcm1zIChTdG9y
ZS5QYXRoLnRvX3N0cmluZyBhYnNwYXRoKQogCi1sZXQgZmlyZV93YXRjaCBy
b290cyB3YXRjaCBwYXRoID0KK2xldCBmaXJlX3dhdGNoIHNvdXJjZSByb290
cyB3YXRjaCBwYXRoID0KIAlsZXQgbmV3X3BhdGggPQogCQlpZiB3YXRjaC5p
c19yZWxhdGl2ZSAmJiBwYXRoLlswXSA9ICcvJwogCQl0aGVuIGJlZ2luCkBA
IC0yMzIsNyArMzYwLDcgQEAgbGV0IGZpcmVfd2F0Y2ggcm9vdHMgd2F0Y2gg
cGF0aCA9CiAJCWVuZCBlbHNlCiAJCQlwYXRoCiAJaW4KLQlmaXJlX3Npbmds
ZV93YXRjaCByb290cyB7IHdhdGNoIHdpdGggcGF0aCA9IG5ld19wYXRoIH0K
KwlmaXJlX3NpbmdsZV93YXRjaCBzb3VyY2Ugcm9vdHMgeyB3YXRjaCB3aXRo
IHBhdGggPSBuZXdfcGF0aCB9CiAKICgqIFNlYXJjaCBmb3IgYSB2YWxpZCB1
bnVzZWQgdHJhbnNhY3Rpb24gaWQuICopCiBsZXQgcmVjIHZhbGlkX3RyYW5z
YWN0aW9uX2lkIGNvbiBwcm9wb3NlZF9pZCA9CkBAIC0yODAsNiArNDA4LDcg
QEAgbGV0IGRvX2lucHV0IGNvbiA9IFhlbmJ1cy5YYi5pbnB1dCBjb24ueGIK
IGxldCBoYXNfcGFydGlhbF9pbnB1dCBjb24gPSBYZW5idXMuWGIuaGFzX3Bh
cnRpYWxfaW5wdXQgY29uLnhiCiBsZXQgaGFzX21vcmVfaW5wdXQgY29uID0g
WGVuYnVzLlhiLmhhc19tb3JlX2lucHV0IGNvbi54YgogCitsZXQgY2FuX2lu
cHV0IGNvbiA9IFhlbmJ1cy5YYi5jYW5faW5wdXQgY29uLnhiICYmIEJvdW5k
ZWRQaXBlLmlzX2VtcHR5IGNvbi5wZW5kaW5nX3NvdXJjZV93YXRjaGV2ZW50
cwogbGV0IGhhc19vdXRwdXQgY29uID0gWGVuYnVzLlhiLmhhc19vdXRwdXQg
Y29uLnhiCiBsZXQgaGFzX29sZF9vdXRwdXQgY29uID0gWGVuYnVzLlhiLmhh
c19vbGRfb3V0cHV0IGNvbi54YgogbGV0IGhhc19uZXdfb3V0cHV0IGNvbiA9
IFhlbmJ1cy5YYi5oYXNfbmV3X291dHB1dCBjb24ueGIKQEAgLTMyMiw3ICs0
NTEsNyBAQCBsZXQgcHJldmVudHNfbGl2ZV91cGRhdGUgY29uID0gbm90IChp
c19iYWQgY29uKQogCSYmIChoYXNfZXh0cmFfY29ubmVjdGlvbl9kYXRhIGNv
biB8fCBoYXNfdHJhbnNhY3Rpb25fZGF0YSBjb24pCiAKIGxldCBoYXNfbW9y
ZV93b3JrIGNvbiA9Ci0JaGFzX21vcmVfaW5wdXQgY29uIHx8IG5vdCAoaGFz
X29sZF9vdXRwdXQgY29uKSAmJiBoYXNfbmV3X291dHB1dCBjb24KKwkoaGFz
X21vcmVfaW5wdXQgY29uICYmIGNhbl9pbnB1dCBjb24pIHx8IG5vdCAoaGFz
X29sZF9vdXRwdXQgY29uKSAmJiBoYXNfbmV3X291dHB1dCBjb24KIAogbGV0
IGluY3Jfb3BzIGNvbiA9IGNvbi5zdGF0X25iX29wcyA8LSBjb24uc3RhdF9u
Yl9vcHMgKyAxCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3Jl
ZC9jb25uZWN0aW9ucy5tbCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25u
ZWN0aW9ucy5tbAppbmRleCAzYzc0MjlmZTdmNjEuLjdkNjhjNTgzYjQzYSAx
MDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL2Nvbm5lY3Rpb25z
Lm1sCisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9jb25uZWN0aW9ucy5t
bApAQCAtMjIsMjIgKzIyLDMwIEBAIHR5cGUgdCA9IHsKIAlkb21haW5zOiAo
aW50LCBDb25uZWN0aW9uLnQpIEhhc2h0YmwudDsKIAlwb3J0czogKFhlbmV2
ZW50Y2huLnQsIENvbm5lY3Rpb24udCkgSGFzaHRibC50OwogCW11dGFibGUg
d2F0Y2hlczogQ29ubmVjdGlvbi53YXRjaCBsaXN0IFRyaWUudDsKKwltdXRh
YmxlIGhhc19wZW5kaW5nX3dhdGNoZXZlbnRzOiBDb25uZWN0aW9uLldhdGNo
LlNldC50CiB9CiAKIGxldCBjcmVhdGUgKCkgPSB7CiAJYW5vbnltb3VzID0g
SGFzaHRibC5jcmVhdGUgMzc7CiAJZG9tYWlucyA9IEhhc2h0YmwuY3JlYXRl
IDM3OwogCXBvcnRzID0gSGFzaHRibC5jcmVhdGUgMzc7Ci0Jd2F0Y2hlcyA9
IFRyaWUuY3JlYXRlICgpCisJd2F0Y2hlcyA9IFRyaWUuY3JlYXRlICgpOwor
CWhhc19wZW5kaW5nX3dhdGNoZXZlbnRzID0gQ29ubmVjdGlvbi5XYXRjaC5T
ZXQuZW1wdHk7CiB9CiAKK2xldCBnZXRfY2FwYWNpdHkgKCkgPQorCSgqIG5v
dCBtdWx0aXBsaWVkIGJ5IG1heHdhdGNoIG9uIHB1cnBvc2U6IDJuZCBxdWV1
ZSBpbiB3YXRjaCBpdHNlbGYhICopCisJeyBYZW5idXMuWGIubWF4b3V0c3Rh
bmRpbmcgPSAhRGVmaW5lLm1heG91dHN0YW5kaW5nOyBtYXh3YXRjaGV2ZW50
cyA9ICFEZWZpbmUubWF4d2F0Y2hldmVudHMgfQorCiBsZXQgYWRkX2Fub255
bW91cyBjb25zIGZkID0KLQlsZXQgeGJjb24gPSBYZW5idXMuWGIub3Blbl9m
ZCBmZCBpbgorCWxldCBjYXBhY2l0eSA9IGdldF9jYXBhY2l0eSAoKSBpbgor
CWxldCB4YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX2ZkIGZkIH5jYXBhY2l0eSBp
bgogCWxldCBjb24gPSBDb25uZWN0aW9uLmNyZWF0ZSB4YmNvbiBOb25lIGlu
CiAJSGFzaHRibC5hZGQgY29ucy5hbm9ueW1vdXMgKFhlbmJ1cy5YYi5nZXRf
ZmQgeGJjb24pIGNvbgogCiBsZXQgYWRkX2RvbWFpbiBjb25zIGRvbSA9Ci0J
bGV0IHhiY29uID0gWGVuYnVzLlhiLm9wZW5fbW1hcCAoRG9tYWluLmdldF9p
bnRlcmZhY2UgZG9tKSAoZnVuICgpIC0+IERvbWFpbi5ub3RpZnkgZG9tKSBp
bgorCWxldCBjYXBhY2l0eSA9IGdldF9jYXBhY2l0eSAoKSBpbgorCWxldCB4
YmNvbiA9IFhlbmJ1cy5YYi5vcGVuX21tYXAgfmNhcGFjaXR5IChEb21haW4u
Z2V0X2ludGVyZmFjZSBkb20pIChmdW4gKCkgLT4gRG9tYWluLm5vdGlmeSBk
b20pIGluCiAJbGV0IGNvbiA9IENvbm5lY3Rpb24uY3JlYXRlIHhiY29uIChT
b21lIGRvbSkgaW4KIAlIYXNodGJsLmFkZCBjb25zLmRvbWFpbnMgKERvbWFp
bi5nZXRfaWQgZG9tKSBjb247CiAJbWF0Y2ggRG9tYWluLmdldF9wb3J0IGRv
bSB3aXRoCkBAIC00OCw3ICs1Niw5IEBAIGxldCBzZWxlY3QgPyhvbmx5X2lm
ID0gKGZ1biBfIC0+IHRydWUpKSBjb25zID0KIAlIYXNodGJsLmZvbGQgKGZ1
biBfIGNvbiAoaW5zLCBvdXRzKSAtPgogCQlpZiAob25seV9pZiBjb24pIHRo
ZW4gKAogCQkJbGV0IGZkID0gQ29ubmVjdGlvbi5nZXRfZmQgY29uIGluCi0J
CQkoZmQgOjogaW5zLCAgaWYgQ29ubmVjdGlvbi5oYXNfb3V0cHV0IGNvbiB0
aGVuIGZkIDo6IG91dHMgZWxzZSBvdXRzKQorCQkJbGV0IGluX2ZkcyA9IGlm
IENvbm5lY3Rpb24uY2FuX2lucHV0IGNvbiB0aGVuIGZkIDo6IGlucyBlbHNl
IGlucyBpbgorCQkJbGV0IG91dF9mZHMgPSBpZiBDb25uZWN0aW9uLmhhc19v
dXRwdXQgY29uIHRoZW4gZmQgOjogb3V0cyBlbHNlIG91dHMgaW4KKwkJCWlu
X2Zkcywgb3V0X2ZkcwogCQkpIGVsc2UgKGlucywgb3V0cykKIAkpCiAJY29u
cy5hbm9ueW1vdXMgKFtdLCBbXSkKQEAgLTY3LDEwICs3NywxNyBAQCBsZXQg
ZGVsX3dhdGNoZXNfb2ZfY29uIGNvbiB3YXRjaGVzID0KIAl8IFtdIC0+IE5v
bmUKIAl8IHdzIC0+IFNvbWUgd3MKIAorbGV0IGRlbF93YXRjaGVzIGNvbnMg
Y29uID0KKwlDb25uZWN0aW9uLmRlbF93YXRjaGVzIGNvbjsKKwljb25zLndh
dGNoZXMgPC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNv
bnMud2F0Y2hlczsKKwljb25zLmhhc19wZW5kaW5nX3dhdGNoZXZlbnRzIDwt
CisJCWNvbnMuaGFzX3BlbmRpbmdfd2F0Y2hldmVudHMgfD4gQ29ubmVjdGlv
bi5XYXRjaC5TZXQuZmlsdGVyIEBAIGZ1biB3IC0+CisJCUNvbm5lY3Rpb24u
Z2V0X2NvbiB3ICE9IGNvbgorCiBsZXQgZGVsX2Fub255bW91cyBjb25zIGNv
biA9CiAJdHJ5CiAJCUhhc2h0YmwucmVtb3ZlIGNvbnMuYW5vbnltb3VzIChD
b25uZWN0aW9uLmdldF9mZCBjb24pOwotCQljb25zLndhdGNoZXMgPC0gVHJp
ZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNvbnMud2F0Y2hlczsK
KwkJZGVsX3dhdGNoZXMgY29ucyBjb247CiAJCUNvbm5lY3Rpb24uY2xvc2Ug
Y29uCiAJd2l0aCBleG4gLT4KIAkJZGVidWcgImRlbCBhbm9ueW1vdXMgJXMi
IChQcmludGV4Yy50b19zdHJpbmcgZXhuKQpAQCAtODUsNyArMTAyLDcgQEAg
bGV0IGRlbF9kb21haW4gY29ucyBpZCA9CiAJCSAgICB8IFNvbWUgcCAtPiBI
YXNodGJsLnJlbW92ZSBjb25zLnBvcnRzIHAKIAkJICAgIHwgTm9uZSAtPiAo
KSkKIAkJIHwgTm9uZSAtPiAoKSk7Ci0JCWNvbnMud2F0Y2hlcyA8LSBUcmll
Lm1hcCAoZGVsX3dhdGNoZXNfb2ZfY29uIGNvbikgY29ucy53YXRjaGVzOwor
CQlkZWxfd2F0Y2hlcyBjb25zIGNvbjsKIAkJQ29ubmVjdGlvbi5jbG9zZSBj
b24KIAl3aXRoIGV4biAtPgogCQlkZWJ1ZyAiZGVsIGRvbWFpbiAldTogJXMi
IGlkIChQcmludGV4Yy50b19zdHJpbmcgZXhuKQpAQCAtMTM2LDMxICsxNTMs
MzMgQEAgbGV0IGRlbF93YXRjaCBjb25zIGNvbiBwYXRoIHRva2VuID0KIAkJ
Y29ucy53YXRjaGVzIDwtIFRyaWUuc2V0IGNvbnMud2F0Y2hlcyBrZXkgd2F0
Y2hlczsKICAJd2F0Y2gKIAotbGV0IGRlbF93YXRjaGVzIGNvbnMgY29uID0K
LQlDb25uZWN0aW9uLmRlbF93YXRjaGVzIGNvbjsKLQljb25zLndhdGNoZXMg
PC0gVHJpZS5tYXAgKGRlbF93YXRjaGVzX29mX2NvbiBjb24pIGNvbnMud2F0
Y2hlcwotCiAoKiBwYXRoIGlzIGFic29sdXRlICopCi1sZXQgZmlyZV93YXRj
aGVzID9vbGRyb290IHJvb3QgY29ucyBwYXRoIHJlY3Vyc2UgPQorbGV0IGZp
cmVfd2F0Y2hlcyA/b2xkcm9vdCBzb3VyY2Ugcm9vdCBjb25zIHBhdGggcmVj
dXJzZSA9CiAJbGV0IGtleSA9IGtleV9vZl9wYXRoIHBhdGggaW4KIAlsZXQg
cGF0aCA9IFN0b3JlLlBhdGgudG9fc3RyaW5nIHBhdGggaW4KIAlsZXQgcm9v
dHMgPSBvbGRyb290LCByb290IGluCiAJbGV0IGZpcmVfd2F0Y2ggXyA9IGZ1
bmN0aW9uCiAJCXwgTm9uZSAgICAgICAgIC0+ICgpCi0JCXwgU29tZSB3YXRj
aGVzIC0+IExpc3QuaXRlciAoZnVuIHcgLT4gQ29ubmVjdGlvbi5maXJlX3dh
dGNoIHJvb3RzIHcgcGF0aCkgd2F0Y2hlcworCQl8IFNvbWUgd2F0Y2hlcyAt
PiBMaXN0Lml0ZXIgKGZ1biB3IC0+IENvbm5lY3Rpb24uZmlyZV93YXRjaCBz
b3VyY2Ugcm9vdHMgdyBwYXRoKSB3YXRjaGVzCiAJaW4KIAlsZXQgZmlyZV9y
ZWMgX3ggPSBmdW5jdGlvbgogCQl8IE5vbmUgICAgICAgICAtPiAoKQogCQl8
IFNvbWUgd2F0Y2hlcyAtPgotCQkJTGlzdC5pdGVyIChDb25uZWN0aW9uLmZp
cmVfc2luZ2xlX3dhdGNoIHJvb3RzKSB3YXRjaGVzCisJCQlMaXN0Lml0ZXIg
KENvbm5lY3Rpb24uZmlyZV9zaW5nbGVfd2F0Y2ggc291cmNlIHJvb3RzKSB3
YXRjaGVzCiAJaW4KIAlUcmllLml0ZXJfcGF0aCBmaXJlX3dhdGNoIGNvbnMu
d2F0Y2hlcyBrZXk7CiAJaWYgcmVjdXJzZSB0aGVuCiAJCVRyaWUuaXRlciBm
aXJlX3JlYyAoVHJpZS5zdWIgY29ucy53YXRjaGVzIGtleSkKIAorbGV0IHNl
bmRfd2F0Y2hldmVudHMgY29ucyBjb24gPQorCWNvbnMuaGFzX3BlbmRpbmdf
d2F0Y2hldmVudHMgPC0KKwkJY29ucy5oYXNfcGVuZGluZ193YXRjaGV2ZW50
cyB8PiBDb25uZWN0aW9uLldhdGNoLlNldC5maWx0ZXIgQ29ubmVjdGlvbi5X
YXRjaC5mbHVzaF9ldmVudHM7CisJQ29ubmVjdGlvbi5zb3VyY2VfZmx1c2hf
d2F0Y2hldmVudHMgY29uCisKIGxldCBmaXJlX3NwZWNfd2F0Y2hlcyByb290
IGNvbnMgc3BlY3BhdGggPQorCWxldCBzb3VyY2UgPSBmaW5kX2RvbWFpbiBj
b25zIDAgaW4KIAlpdGVyIGNvbnMgKGZ1biBjb24gLT4KLQkJTGlzdC5pdGVy
IChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoIChOb25lLCByb290KSkg
KENvbm5lY3Rpb24uZ2V0X3dhdGNoZXMgY29uIHNwZWNwYXRoKSkKKwkJTGlz
dC5pdGVyIChDb25uZWN0aW9uLmZpcmVfc2luZ2xlX3dhdGNoIHNvdXJjZSAo
Tm9uZSwgcm9vdCkpIChDb25uZWN0aW9uLmdldF93YXRjaGVzIGNvbiBzcGVj
cGF0aCkpCiAKIGxldCBzZXRfdGFyZ2V0IGNvbnMgZG9tYWluIHRhcmdldF9k
b21haW4gPQogCWxldCBjb24gPSBmaW5kX2RvbWFpbiBjb25zIGRvbWFpbiBp
bgpAQCAtMTk3LDYgKzIxNiwxNiBAQCBsZXQgZGVidWcgY29ucyA9CiAJbGV0
IGRvbWFpbnMgPSBIYXNodGJsLmZvbGQgKGZ1biBfIGNvbiBhY2N1IC0+IENv
bm5lY3Rpb24uZGVidWcgY29uIDo6IGFjY3UpIGNvbnMuZG9tYWlucyBbXSBp
bgogCVN0cmluZy5jb25jYXQgIiIgKGRvbWFpbnMgQCBhbm9ueW1vdXMpCiAK
K2xldCBkZWJ1Z193YXRjaGV2ZW50cyBjb25zIGNvbiA9CisJKCogPT0gKHBo
eXNpY2FsIGVxdWFsaXR5KQorCSAgIGhhcyB0byBiZSB1c2VkIGhlcmUgYmVj
YXVzZSB3LmNvbi54Yi5iYWNrZW5kIG1pZ2h0IGNvbnRhaW4gYSBbdW5pdC0+
dW5pdF0gdmFsdWUgY2F1c2luZyByZWd1bGFyCisJICAgY29tcGFyaXNvbiB0
byBmYWlsIGR1ZSB0byBoYXZpbmcgYSAnZnVuY3Rpb25hbCB2YWx1ZScgd2hp
Y2ggY2Fubm90IGJlIGNvbXBhcmVkLgorCSAqKQorCWxldCBzID0gY29ucy5o
YXNfcGVuZGluZ193YXRjaGV2ZW50cyB8PiBDb25uZWN0aW9uLldhdGNoLlNl
dC5maWx0ZXIgKGZ1biB3IC0+IHcuY29uID09IGNvbikgaW4KKwlsZXQgcGVu
ZGluZyA9IHMgfD4gQ29ubmVjdGlvbi5XYXRjaC5TZXQuZWxlbWVudHMKKwkJ
fD4gTGlzdC5tYXAgKGZ1biB3IC0+IENvbm5lY3Rpb24uV2F0Y2gucGVuZGlu
Z193YXRjaGV2ZW50cyB3KSB8PiBMaXN0LmZvbGRfbGVmdCAoKykgMCBpbgor
CVByaW50Zi5zcHJpbnRmICJXYXRjaGVzIHdpdGggcGVuZGluZyBldmVudHM6
ICVkLCBwZW5kaW5nIGV2ZW50cyB0b3RhbDogJWQiIChDb25uZWN0aW9uLldh
dGNoLlNldC5jYXJkaW5hbCBzKSBwZW5kaW5nCisKIGxldCBmaWx0ZXIgfmYg
Y29ucyA9CiAJbGV0IGZvbGQgXyB2IGFjYyA9IGlmIGYgdiB0aGVuIHYgOjog
YWNjIGVsc2UgYWNjIGluCiAJW10KZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1s
L3hlbnN0b3JlZC9kZWZpbmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQv
ZGVmaW5lLm1sCmluZGV4IGJhNjNhODE0N2UwOS4uMzI3YjZkNzk1ZWM3IDEw
MDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvZGVmaW5lLm1sCisr
KyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9kZWZpbmUubWwKQEAgLTI0LDYg
KzI0LDEzIEBAIGxldCBkZWZhdWx0X2NvbmZpZ19kaXIgPSBQYXRocy54ZW5f
Y29uZmlnX2RpcgogbGV0IG1heHdhdGNoID0gcmVmICgxMDApCiBsZXQgbWF4
dHJhbnNhY3Rpb24gPSByZWYgKDEwKQogbGV0IG1heHJlcXVlc3RzID0gcmVm
ICgxMDI0KSAgICgqIG1heGltdW0gcmVxdWVzdHMgcGVyIHRyYW5zYWN0aW9u
ICopCitsZXQgbWF4b3V0c3RhbmRpbmcgPSByZWYgKDEwMjQpICgqIG1heGlt
dW0gb3V0c3RhbmRpbmcgcmVxdWVzdHMsIGkuZS4gaW4tZmxpZ2h0IHJlcXVl
c3RzIC8gZG9tYWluICopCitsZXQgbWF4d2F0Y2hldmVudHMgPSByZWYgKDEw
MjQpCisoKgorCW1heGltdW0gb3V0c3RhbmRpbmcgd2F0Y2ggZXZlbnRzIHBl
ciB3YXRjaCwKKwlyZWNvbW1lbmRlZCA+PSBtYXhvdXRzdGFuZGluZyB0byBh
dm9pZCBibG9ja2luZyBiYWNrZW5kIHRyYW5zYWN0aW9ucyBkdWUgdG8KKwlt
YWxpY2lvdXMgZnJvbnRlbmRzCisgKikKIAogbGV0IGdjX21heF9vdmVyaGVh
ZCA9IHJlZiAxMjAgKCogMTIwJSBzZWUgY29tbWVudCBpbiB4ZW5zdG9yZWQu
bWwgKikKIGxldCBjb25mbGljdF9idXJzdF9saW1pdCA9IHJlZiA1LjAKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9veGVuc3RvcmVkLmNv
bmYuaW4gYi90b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25m
LmluCmluZGV4IDRhZTQ4ZTQyZDQ3ZC4uOWQwMzRlNzQ0YjRiIDEwMDY0NAot
LS0gYS90b29scy9vY2FtbC94ZW5zdG9yZWQvb3hlbnN0b3JlZC5jb25mLmlu
CisrKyBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9veGVuc3RvcmVkLmNvbmYu
aW4KQEAgLTYyLDYgKzYyLDggQEAgcXVvdGEtbWF4d2F0Y2ggPSAxMDAKIHF1
b3RhLXRyYW5zYWN0aW9uID0gMTAKIHF1b3RhLW1heHJlcXVlc3RzID0gMTAy
NAogcXVvdGEtcGF0aC1tYXggPSAxMDI0CitxdW90YS1tYXhvdXRzdGFuZGlu
ZyA9IDEwMjQKK3F1b3RhLW1heHdhdGNoZXZlbnRzID0gMTAyNAogCiAjIEFj
dGl2YXRlIGZpbGVkIGJhc2UgYmFja2VuZAogcGVyc2lzdGVudCA9IGZhbHNl
CmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5t
bCBiL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9wcm9jZXNzLm1sCmluZGV4IDY5
YTk2ZjJkYThlOS4uNWY0MzlmZTU5ZjQ3IDEwMDY0NAotLS0gYS90b29scy9v
Y2FtbC94ZW5zdG9yZWQvcHJvY2Vzcy5tbAorKysgYi90b29scy9vY2FtbC94
ZW5zdG9yZWQvcHJvY2Vzcy5tbApAQCAtNTcsNyArNTcsNyBAQCBsZXQgc3Bs
aXRfb25lX3BhdGggZGF0YSBjb24gPQogCXwgcGF0aCA6OiAiIiA6OiBbXSAt
PiBTdG9yZS5QYXRoLmNyZWF0ZSBwYXRoIChDb25uZWN0aW9uLmdldF9wYXRo
IGNvbikKIAl8IF8gICAgICAgICAgICAgICAgLT4gcmFpc2UgSW52YWxpZF9D
bWRfQXJncwogCi1sZXQgcHJvY2Vzc193YXRjaCB0IGNvbnMgPQorbGV0IHBy
b2Nlc3Nfd2F0Y2ggc291cmNlIHQgY29ucyA9CiAJbGV0IG9sZHJvb3QgPSB0
LlRyYW5zYWN0aW9uLm9sZHJvb3QgaW4KIAlsZXQgbmV3cm9vdCA9IFN0b3Jl
LmdldF9yb290IHQuVHJhbnNhY3Rpb24uc3RvcmUgaW4KIAlsZXQgb3BzID0g
VHJhbnNhY3Rpb24uZ2V0X3BhdGhzIHQgfD4gTGlzdC5yZXYgaW4KQEAgLTY3
LDggKzY3LDkgQEAgbGV0IHByb2Nlc3Nfd2F0Y2ggdCBjb25zID0KIAkJfCBY
ZW5idXMuWGIuT3AuUm0gICAgICAgLT4gdHJ1ZSwgTm9uZSwgb2xkcm9vdAog
CQl8IFhlbmJ1cy5YYi5PcC5TZXRwZXJtcyAtPiBmYWxzZSwgU29tZSBvbGRy
b290LCBuZXdyb290CiAJCXwgXyAgICAgICAgICAgICAgLT4gcmFpc2UgKEZh
aWx1cmUgImh1aCA/IikgaW4KLQkJQ29ubmVjdGlvbnMuZmlyZV93YXRjaGVz
ID9vbGRyb290IHJvb3QgY29ucyAoc25kIG9wKSByZWN1cnNlIGluCi0JTGlz
dC5pdGVyIChmdW4gb3AgLT4gZG9fb3Bfd2F0Y2ggb3AgY29ucykgb3BzCisJ
CUNvbm5lY3Rpb25zLmZpcmVfd2F0Y2hlcyA/b2xkcm9vdCBzb3VyY2Ugcm9v
dCBjb25zIChzbmQgb3ApIHJlY3Vyc2UgaW4KKwlMaXN0Lml0ZXIgKGZ1biBv
cCAtPiBkb19vcF93YXRjaCBvcCBjb25zKSBvcHM7CisJQ29ubmVjdGlvbnMu
c2VuZF93YXRjaGV2ZW50cyBjb25zIHNvdXJjZQogCiBsZXQgY3JlYXRlX2lt
cGxpY2l0X3BhdGggdCBwZXJtIHBhdGggPQogCWxldCBkaXJuYW1lID0gU3Rv
cmUuUGF0aC5nZXRfcGFyZW50IHBhdGggaW4KQEAgLTIzNCw2ICsyMzUsMjAg
QEAgbGV0IGRvX2RlYnVnIGNvbiB0IF9kb21haW5zIGNvbnMgZGF0YSA9CiAJ
fCAid2F0Y2hlcyIgOjogXyAtPgogCQlsZXQgd2F0Y2hlcyA9IENvbm5lY3Rp
b25zLmRlYnVnIGNvbnMgaW4KIAkJU29tZSAod2F0Y2hlcyBeICJcMDAwIikK
Kwl8ICJ4ZW5idXMiIDo6IGRvbWlkIDo6IF8gLT4KKwkJbGV0IGRvbWlkID0g
aW50X29mX3N0cmluZyBkb21pZCBpbgorCQlsZXQgY29uID0gQ29ubmVjdGlv
bnMuZmluZF9kb21haW4gY29ucyBkb21pZCBpbgorCQlsZXQgcyA9IFByaW50
Zi5zcHJpbnRmICJ4ZW5idXM6ICVzOyBvdmVyZmxvdyBxdWV1ZSBsZW5ndGg6
ICVkLCBjYW5faW5wdXQ6ICViLCBoYXNfbW9yZV9pbnB1dDogJWIsIGhhc19v
bGRfb3V0cHV0OiAlYiwgaGFzX25ld19vdXRwdXQ6ICViLCBoYXNfbW9yZV93
b3JrOiAlYi4gcGVuZGluZzogJXMiCisJCQkoWGVuYnVzLlhiLmRlYnVnIGNv
bi54YikKKwkJCShDb25uZWN0aW9uLnNvdXJjZV9wZW5kaW5nX3dhdGNoZXZl
bnRzIGNvbikKKwkJCShDb25uZWN0aW9uLmNhbl9pbnB1dCBjb24pCisJCQko
Q29ubmVjdGlvbi5oYXNfbW9yZV9pbnB1dCBjb24pCisJCQkoQ29ubmVjdGlv
bi5oYXNfb2xkX291dHB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfbmV3
X291dHB1dCBjb24pCisJCQkoQ29ubmVjdGlvbi5oYXNfbW9yZV93b3JrIGNv
bikKKwkJCShDb25uZWN0aW9ucy5kZWJ1Z193YXRjaGV2ZW50cyBjb25zIGNv
bikKKwkJaW4KKwkJU29tZSBzCiAJfCAibWZuIiA6OiBkb21pZCA6OiBfIC0+
CiAJCWxldCBkb21pZCA9IGludF9vZl9zdHJpbmcgZG9taWQgaW4KIAkJbGV0
IGNvbiA9IENvbm5lY3Rpb25zLmZpbmRfZG9tYWluIGNvbnMgZG9taWQgaW4K
QEAgLTM0Miw3ICszNTcsNyBAQCBsZXQgcmVwbHlfYWNrIGZjdCBjb24gdCBk
b21zIGNvbnMgZGF0YSA9CiAJZmN0IGNvbiB0IGRvbXMgY29ucyBkYXRhOwog
CVBhY2tldC5BY2sgKGZ1biAoKSAtPgogCQlpZiBUcmFuc2FjdGlvbi5nZXRf
aWQgdCA9IFRyYW5zYWN0aW9uLm5vbmUgdGhlbgotCQkJcHJvY2Vzc193YXRj
aCB0IGNvbnMKKwkJCXByb2Nlc3Nfd2F0Y2ggY29uIHQgY29ucwogCSkKIAog
bGV0IHJlcGx5X2RhdGEgZmN0IGNvbiB0IGRvbXMgY29ucyBkYXRhID0KQEAg
LTUwMSw3ICs1MTYsNyBAQCBsZXQgZG9fd2F0Y2ggY29uIF90IF9kb21haW5z
IGNvbnMgZGF0YSA9CiAJUGFja2V0LkFjayAoZnVuICgpIC0+CiAJCSgqIHhl
bnN0b3JlLnR4dCBzYXlzIHRoaXMgd2F0Y2ggaXMgZmlyZWQgaW1tZWRpYXRl
bHksCiAJCSAgIGltcGx5aW5nIGV2ZW4gaWYgcGF0aCBkb2Vzbid0IGV4aXN0
IG9yIGlzIHVucmVhZGFibGUgKikKLQkJQ29ubmVjdGlvbi5maXJlX3Npbmds
ZV93YXRjaF91bmNoZWNrZWQgd2F0Y2gpCisJCUNvbm5lY3Rpb24uZmlyZV9z
aW5nbGVfd2F0Y2hfdW5jaGVja2VkIGNvbiB3YXRjaCkKIAogbGV0IGRvX3Vu
d2F0Y2ggY29uIF90IF9kb21haW5zIGNvbnMgZGF0YSA9CiAJbGV0IChub2Rl
LCB0b2tlbikgPQpAQCAtNTMyLDcgKzU0Nyw3IEBAIGxldCBkb190cmFuc2Fj
dGlvbl9lbmQgY29uIHQgZG9tYWlucyBjb25zIGRhdGEgPQogCWlmIG5vdCBz
dWNjZXNzIHRoZW4KIAkJcmFpc2UgVHJhbnNhY3Rpb25fYWdhaW47CiAJaWYg
Y29tbWl0IHRoZW4gYmVnaW4KLQkJcHJvY2Vzc193YXRjaCB0IGNvbnM7CisJ
CXByb2Nlc3Nfd2F0Y2ggY29uIHQgY29uczsKIAkJbWF0Y2ggdC5UcmFuc2Fj
dGlvbi50eSB3aXRoCiAJCXwgVHJhbnNhY3Rpb24uTm8gLT4KIAkJCSgpICgq
IG5vIG5lZWQgdG8gcmVjb3JkIGFueXRoaW5nICopCkBAIC03MDAsNyArNzE1
LDggQEAgbGV0IHByb2Nlc3NfcGFja2V0IH5zdG9yZSB+Y29ucyB+ZG9tcyB+
Y29uIH5yZXEgPQogbGV0IGRvX2lucHV0IHN0b3JlIGNvbnMgZG9tcyBjb24g
PQogCWxldCBuZXdwYWNrZXQgPQogCQl0cnkKLQkJCUNvbm5lY3Rpb24uZG9f
aW5wdXQgY29uCisJCQlpZiBDb25uZWN0aW9uLmNhbl9pbnB1dCBjb24gdGhl
biBDb25uZWN0aW9uLmRvX2lucHV0IGNvbgorCQkJZWxzZSBOb25lCiAJCXdp
dGggWGVuYnVzLlhiLlJlY29ubmVjdCAtPgogCQkJaW5mbyAiJXMgcmVxdWVz
dHMgYSByZWNvbm5lY3QiIChDb25uZWN0aW9uLmdldF9kb21zdHIgY29uKTsK
IAkJCUhpc3RvcnkucmVjb25uZWN0IGNvbjsKQEAgLTcyOCw2ICs3NDQsNyBA
QCBsZXQgZG9faW5wdXQgc3RvcmUgY29ucyBkb21zIGNvbiA9CiAJCUNvbm5l
Y3Rpb24uaW5jcl9vcHMgY29uCiAKIGxldCBkb19vdXRwdXQgX3N0b3JlIF9j
b25zIF9kb21zIGNvbiA9CisJQ29ubmVjdGlvbi5zb3VyY2VfZmx1c2hfd2F0
Y2hldmVudHMgY29uOwogCWlmIENvbm5lY3Rpb24uaGFzX291dHB1dCBjb24g
dGhlbiAoCiAJCWlmIENvbm5lY3Rpb24uaGFzX25ld19vdXRwdXQgY29uIHRo
ZW4gKAogCQkJbGV0IHBhY2tldCA9IENvbm5lY3Rpb24ucGVla19vdXRwdXQg
Y29uIGluCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94ZW5zdG9yZWQveGVu
c3RvcmVkLm1sIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5t
bAppbmRleCAzYjU3YWQwMTZkZmIuLmM3OTllMjBmMTE0NSAxMDA2NDQKLS0t
IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3hlbnN0b3JlZC5tbAorKysgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQveGVuc3RvcmVkLm1sCkBAIC0xMDMsNiAr
MTAzLDggQEAgbGV0IHBhcnNlX2NvbmZpZyBmaWxlbmFtZSA9CiAJCSgicXVv
dGEtbWF4ZW50aXR5IiwgQ29uZmlnLlNldF9pbnQgUXVvdGEubWF4ZW50KTsK
IAkJKCJxdW90YS1tYXhzaXplIiwgQ29uZmlnLlNldF9pbnQgUXVvdGEubWF4
c2l6ZSk7CiAJCSgicXVvdGEtbWF4cmVxdWVzdHMiLCBDb25maWcuU2V0X2lu
dCBEZWZpbmUubWF4cmVxdWVzdHMpOworCQkoInF1b3RhLW1heG91dHN0YW5k
aW5nIiwgQ29uZmlnLlNldF9pbnQgRGVmaW5lLm1heG91dHN0YW5kaW5nKTsK
KwkJKCJxdW90YS1tYXh3YXRjaGV2ZW50cyIsIENvbmZpZy5TZXRfaW50IERl
ZmluZS5tYXh3YXRjaGV2ZW50cyk7CiAJCSgicXVvdGEtcGF0aC1tYXgiLCBD
b25maWcuU2V0X2ludCBEZWZpbmUucGF0aF9tYXgpOwogCQkoImdjLW1heC1v
dmVyaGVhZCIsIENvbmZpZy5TZXRfaW50IERlZmluZS5nY19tYXhfb3Zlcmhl
YWQpOwogCQkoInRlc3QtZWFnYWluIiwgQ29uZmlnLlNldF9ib29sIFRyYW5z
YWN0aW9uLnRlc3RfZWFnYWluKTsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-oxenstored-07.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-oxenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSBhNzczY2NiNjYzZjI2ZGI4MjljODEyNmQ5MmNkN2UwMzhkY2Q4OTVj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFRodSwgMjkgU2VwIDIwMjIgMTM6
MDc6MzUgKzAyMDAKU3ViamVjdDogU1VQUE9SVC5tZDogY2xhcmlmeSBzdXBw
b3J0IG9mIHVudHJ1c3RlZCBkcml2ZXIgZG9tYWlucyB3aXRoCiBveGVuc3Rv
cmVkCgpBZGQgYSBzdXBwb3J0IHN0YXRlbWVudCBmb3IgdGhlIHNjb3BlIG9m
IHN1cHBvcnQgcmVnYXJkaW5nIGRpZmZlcmVudApYZW5zdG9yZSB2YXJpYW50
cy4gRXNwZWNpYWxseSBveGVuc3RvcmVkIGRvZXMgbm90ICh5ZXQpIGhhdmUg
c2VjdXJpdHkKc3VwcG9ydCBvZiB1bnRydXN0ZWQgZHJpdmVyIGRvbWFpbnMs
IGFzIHRob3NlIG1pZ2h0IGRyaXZlIG94ZW5zdG9yZWQKb3V0IG9mIG1lbW9y
eSBieSBjcmVhdGluZyBsb3RzIG9mIHdhdGNoIGV2ZW50cyBmb3IgdGhlIGd1
ZXN0cyB0aGV5IGFyZQpzZXJ2aWNpbmcuCgpBZGQgYSBzdGF0ZW1lbnQgcmVn
YXJkaW5nIExpdmUgVXBkYXRlIHN1cHBvcnQgb2Ygb3hlbnN0b3JlZC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBD
aHJpc3RpYW4gTGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+
CgpkaWZmIC0tZ2l0IGEvU1VQUE9SVC5tZCBiL1NVUFBPUlQubWQKaW5kZXgg
Y2YyZGRmYWNhZjA5Li5hYjcxNDY0Y2Y2NzIgMTAwNjQ0Ci0tLSBhL1NVUFBP
UlQubWQKKysrIGIvU1VQUE9SVC5tZApAQCAtMTkzLDEzICsxOTMsMTggQEAg
U3VwcG9ydCBmb3IgcnVubmluZyBxZW11LXhlbiBkZXZpY2UgbW9kZWwgaW4g
YSBsaW51eCBzdHViZG9tYWluLgogCiAgICAgU3RhdHVzOiBUZWNoIFByZXZp
ZXcKIAotIyMgTGl2ZXVwZGF0ZSBvZiBDIHhlbnN0b3JlZCBkYWVtb24KKyMj
IFhlbnN0b3JlCiAKLSAgICBTdGF0dXM6IFRlY2ggUHJldmlldworIyMjIEMg
eGVuc3RvcmVkIGRhZW1vbgogCi0jIyBMaXZldXBkYXRlIG9mIE9DYW1sIHhl
bnN0b3JlZCBkYWVtb24KKyAgICBTdGF0dXM6IFN1cHBvcnRlZAorICAgIFN0
YXR1cywgTGl2ZXVwZGF0ZTogVGVjaCBQcmV2aWV3CiAKLSAgICBTdGF0dXM6
IFRlY2ggUHJldmlldworIyMjIE9DYW1sIHhlbnN0b3JlZCBkYWVtb24KKwor
ICAgIFN0YXR1czogU3VwcG9ydGVkCisgICAgU3RhdHVzLCB1bnRydXN0ZWQg
ZHJpdmVyIGRvbWFpbnM6IFN1cHBvcnRlZCwgbm90IHNlY3VyaXR5IHN1cHBv
cnRlZAorICAgIFN0YXR1cywgTGl2ZXVwZGF0ZTogTm90IGZ1bmN0aW9uYWwK
IAogIyMgVG9vbHN0YWNrLzNyZCBwYXJ0eQogCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-01.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSAyYzJhNzAzZjZiNDBhN2Q4ZmZkZTNlNDc5OWU2ZDE4YzQzOGQzMDA3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNwbGl0IHVw
IHNlbmRfcmVwbHkoKQoKVG9kYXkgc2VuZF9yZXBseSgpIGlzIHVzZWQgZm9y
IGJvdGgsIG5vcm1hbCByZXF1ZXN0IHJlcGxpZXMgYW5kIHdhdGNoCmV2ZW50
cy4KClNwbGl0IGl0IHVwIGludG8gc2VuZF9yZXBseSgpIGFuZCBzZW5kX2V2
ZW50KCkuIFRoaXMgd2lsbCBiZSB1c2VkIHRvCmFkZCBzb21lIGV2ZW50IHNw
ZWNpZmljIGhhbmRsaW5nLgoKYWRkX2V2ZW50KCkgY2FuIGJlIG1lcmdlZCBp
bnRvIHNlbmRfZXZlbnQoKSwgcmVtb3ZpbmcgdGhlIG5lZWQgZm9yIGFuCmlu
dGVybWVkaWF0ZSBtZW1vcnkgYWxsb2NhdGlvbi4KClRoaXMgaXMgcGFydCBv
ZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdy
YWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9j
b3JlLmMKaW5kZXggNTViNzllNGMwMzJlLi5lZDc0MmQ5ZGZjMmUgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNzYzLDQ5ICs3
NjMsMzIgQEAgc3RhdGljIHZvaWQgc2VuZF9lcnJvcihzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgaW50IGVycm9yKQogdm9pZCBzZW5kX3JlcGx5KHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlw
ZSwKIAkJY29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbikKIHsK
LQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7CisJc3RydWN0IGJ1ZmZl
cmVkX2RhdGEgKmJkYXRhID0gY29ubi0+aW47CisKKwlhc3NlcnQodHlwZSAh
PSBYU19XQVRDSF9FVkVOVCk7CiAKIAlpZiAoIGxlbiA+IFhFTlNUT1JFX1BB
WUxPQURfTUFYICkgewogCQlzZW5kX2Vycm9yKGNvbm4sIEUyQklHKTsKIAkJ
cmV0dXJuOwogCX0KIAotCS8qIFJlcGxpZXMgcmV1c2UgdGhlIHJlcXVlc3Qg
YnVmZmVyLCBldmVudHMgbmVlZCBhIG5ldyBvbmUuICovCi0JaWYgKHR5cGUg
IT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJYmRhdGEgPSBjb25uLT5pbjsKLQkJ
LyogRHJvcCBhc3luY2hyb25vdXMgcmVzcG9uc2VzLCBlLmcuIGVycm9ycyBm
b3Igd2F0Y2ggZXZlbnRzLiAqLwotCQlpZiAoIWJkYXRhKQotCQkJcmV0dXJu
OwotCQliZGF0YS0+aW5oZHIgPSB0cnVlOwotCQliZGF0YS0+dXNlZCA9IDA7
Ci0JCWNvbm4tPmluID0gTlVMTDsKLQl9IGVsc2UgewotCQkvKiBNZXNzYWdl
IGlzIGEgY2hpbGQgb2YgdGhlIGNvbm5lY3Rpb24gZm9yIGF1dG8tY2xlYW51
cC4gKi8KLQkJYmRhdGEgPSBuZXdfYnVmZmVyKGNvbm4pOworCWlmICghYmRh
dGEpCisJCXJldHVybjsKKwliZGF0YS0+aW5oZHIgPSB0cnVlOworCWJkYXRh
LT51c2VkID0gMDsKIAotCQkvKgotCQkgKiBBbGxvY2F0aW9uIGZhaWx1cmUg
aGVyZSBpcyB1bmZvcnR1bmF0ZTogd2UgaGF2ZSBubyB3YXkgdG8KLQkJICog
dGVsbCBhbnlib2R5IGFib3V0IGl0LgotCQkgKi8KLQkJaWYgKCFiZGF0YSkK
LQkJCXJldHVybjsKLQl9CiAJaWYgKGxlbiA8PSBERUZBVUxUX0JVRkZFUl9T
SVpFKQogCQliZGF0YS0+YnVmZmVyID0gYmRhdGEtPmRlZmF1bHRfYnVmZmVy
OwotCWVsc2UKKwllbHNlIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IHRhbGxvY19h
cnJheShiZGF0YSwgY2hhciwgbGVuKTsKLQlpZiAoIWJkYXRhLT5idWZmZXIp
IHsKLQkJaWYgKHR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKLQkJCS8qIFNh
bWUgYXMgYWJvdmU6IG5vIHdheSB0byB0ZWxsIHNvbWVvbmUuICovCi0JCQl0
YWxsb2NfZnJlZShiZGF0YSk7CisJCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQkJc2VuZF9lcnJvcihjb25uLCBFTk9NRU0pOwogCQkJcmV0dXJuOwogCQl9
Ci0JCS8qIHJlLWVzdGFibGlzaCByZXF1ZXN0IGJ1ZmZlciBmb3Igc2VuZGlu
ZyBFTk9NRU0uICovCi0JCWNvbm4tPmluID0gYmRhdGE7Ci0JCXNlbmRfZXJy
b3IoY29ubiwgRU5PTUVNKTsKLQkJcmV0dXJuOwogCX0KIAorCWNvbm4tPmlu
ID0gTlVMTDsKKwogCS8qIFVwZGF0ZSByZWxldmFudCBoZWFkZXIgZmllbGRz
IGFuZCBmaWxsIGluIHRoZSBtZXNzYWdlIGJvZHkuICovCiAJYmRhdGEtPmhk
ci5tc2cudHlwZSA9IHR5cGU7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVu
OwpAQCAtODEzLDggKzc5NiwzOSBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0
IGNvbm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBl
LAogCiAJLyogUXVldWUgZm9yIGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAls
aXN0X2FkZF90YWlsKCZiZGF0YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsK
K30KIAotCXJldHVybjsKKy8qCisgKiBTZW5kIGEgd2F0Y2ggZXZlbnQuCisg
KiBBcyB0aGlzIGlzIG5vdCBkaXJlY3RseSByZWxhdGVkIHRvIHRoZSBjdXJy
ZW50IGNvbW1hbmQsIGVycm9ycyBjYW4ndCBiZQorICogcmVwb3J0ZWQuCisg
Ki8KK3ZvaWQgc2VuZF9ldmVudChzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqdG9rZW4pCit7CisJc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhOworCXVuc2lnbmVkIGludCBsZW47
CisKKwlsZW4gPSBzdHJsZW4ocGF0aCkgKyAxICsgc3RybGVuKHRva2VuKSAr
IDE7CisJLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4g
Ki8KKwlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCisJCXJldHVy
bjsKKworCWJkYXRhID0gbmV3X2J1ZmZlcihjb25uKTsKKwlpZiAoIWJkYXRh
KQorCQlyZXR1cm47CisKKwliZGF0YS0+YnVmZmVyID0gdGFsbG9jX2FycmF5
KGJkYXRhLCBjaGFyLCBsZW4pOworCWlmICghYmRhdGEtPmJ1ZmZlcikgewor
CQl0YWxsb2NfZnJlZShiZGF0YSk7CisJCXJldHVybjsKKwl9CisJc3RyY3B5
KGJkYXRhLT5idWZmZXIsIHBhdGgpOworCXN0cmNweShiZGF0YS0+YnVmZmVy
ICsgc3RybGVuKHBhdGgpICsgMSwgdG9rZW4pOworCWJkYXRhLT5oZHIubXNn
LnR5cGUgPSBYU19XQVRDSF9FVkVOVDsKKwliZGF0YS0+aGRyLm1zZy5sZW4g
PSBsZW47CisKKwkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNzaW9uLiAq
LworCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+b3V0X2xp
c3QpOwogfQogCiAvKiBTb21lIHJvdXRpbmVzICh3cml0ZSwgbWtkaXIsIGV0
YykganVzdCBuZWVkIGEgbm9uLWVycm9yIHJldHVybiAqLwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggN2QwZmU3N2U3OTg5Li45
OWEwMzczOTQ0YjIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaApAQCAtMTg3LDYgKzE4Nyw3IEBAIHVuc2lnbmVkIGludCBnZXRfc3Ry
aW5nKGNvbnN0IHN0cnVjdCBidWZmZXJlZF9kYXRhICpkYXRhLCB1bnNpZ25l
ZCBpbnQgb2Zmc2V0KTsKIAogdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAkJ
Y29uc3Qgdm9pZCAqZGF0YSwgdW5zaWduZWQgaW50IGxlbik7Cit2b2lkIHNl
bmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IGNoYXIg
KnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKIAogLyogU29tZSByb3V0aW5l
cyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3QgbmVlZCBhIG5vbi1lcnJvciBy
ZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlKTsKZGlmZiAtLWdpdCBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggYWNhMGE3MWJhZGExLi45
OWEyYzI2NmIyOGEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93
YXRjaC5jCkBAIC04NiwzNSArODYsNiBAQCBzdGF0aWMgY29uc3QgY2hhciAq
Z2V0X3dhdGNoX3BhdGgoY29uc3Qgc3RydWN0IHdhdGNoICp3YXRjaCwgY29u
c3QgY2hhciAqbmFtZSkKIH0KIAogLyoKLSAqIFNlbmQgYSB3YXRjaCBldmVu
dC4KLSAqIFRlbXBvcmFyeSBtZW1vcnkgYWxsb2NhdGlvbnMgYXJlIGRvbmUg
d2l0aCBjdHguCi0gKi8KLXN0YXRpYyB2b2lkIGFkZF9ldmVudChzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKLQkJICAgICAgY29uc3Qgdm9pZCAqY3R4LAot
CQkgICAgICBzdHJ1Y3Qgd2F0Y2ggKndhdGNoLAotCQkgICAgICBjb25zdCBj
aGFyICpuYW1lKQotewotCS8qIERhdGEgdG8gc2VuZCAobm9kZVwwdG9rZW5c
MCkuICovCi0JdW5zaWduZWQgaW50IGxlbjsKLQljaGFyICpkYXRhOwotCi0J
bmFtZSA9IGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKTsKLQotCWxlbiA9
IHN0cmxlbihuYW1lKSArIDEgKyBzdHJsZW4od2F0Y2gtPnRva2VuKSArIDE7
Ci0JLyogRG9uJ3QgdHJ5IHRvIHNlbmQgb3Zlci1sb25nIGV2ZW50cy4gKi8K
LQlpZiAobGVuID4gWEVOU1RPUkVfUEFZTE9BRF9NQVgpCi0JCXJldHVybjsK
LQotCWRhdGEgPSB0YWxsb2NfYXJyYXkoY3R4LCBjaGFyLCBsZW4pOwotCWlm
ICghZGF0YSkKLQkJcmV0dXJuOwotCXN0cmNweShkYXRhLCBuYW1lKTsKLQlz
dHJjcHkoZGF0YSArIHN0cmxlbihuYW1lKSArIDEsIHdhdGNoLT50b2tlbik7
Ci0Jc2VuZF9yZXBseShjb25uLCBYU19XQVRDSF9FVkVOVCwgZGF0YSwgbGVu
KTsKLQl0YWxsb2NfZnJlZShkYXRhKTsKLX0KLQotLyoKICAqIENoZWNrIHBl
cm1pc3Npb25zIG9mIGEgc3BlY2lmaWMgd2F0Y2ggdG8gZmlyZToKICAqIEVp
dGhlciB0aGUgbm9kZSBpdHNlbGYgb3IgaXRzIHBhcmVudCBoYXZlIHRvIGJl
IHJlYWRhYmxlIGJ5IHRoZSBjb25uZWN0aW9uCiAgKiB0aGUgd2F0Y2ggaGFz
IGJlZW4gc2V0dXAgZm9yLiBJbiBjYXNlIGEgd2F0Y2ggZXZlbnQgaXMgY3Jl
YXRlZCBkdWUgdG8KQEAgLTE5MCwxMCArMTYxLDE0IEBAIHZvaWQgZmlyZV93
YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpj
dHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCWxpc3RfZm9yX2VhY2hfZW50cnko
d2F0Y2gsICZpLT53YXRjaGVzLCBsaXN0KSB7CiAJCQlpZiAoZXhhY3QpIHsK
IAkJCQlpZiAoc3RyZXEobmFtZSwgd2F0Y2gtPm5vZGUpKQotCQkJCQlhZGRf
ZXZlbnQoaSwgY3R4LCB3YXRjaCwgbmFtZSk7CisJCQkJCXNlbmRfZXZlbnQo
aSwKKwkJCQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKKwkJ
CQkJCSAgIHdhdGNoLT50b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChp
c19jaGlsZChuYW1lLCB3YXRjaC0+bm9kZSkpCi0JCQkJCWFkZF9ldmVudChp
LCBjdHgsIHdhdGNoLCBuYW1lKTsKKwkJCQkJc2VuZF9ldmVudChpLAorCQkJ
CQkJICAgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIG5hbWUpLAorCQkJCQkJICAg
d2F0Y2gtPnRva2VuKTsKIAkJCX0KIAkJfQogCX0KQEAgLTI5Miw3ICsyNjcs
NyBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAlzZW5kX2Fjayhjb25uLCBYU19X
QVRDSCk7CiAKIAkvKiBXZSBmaXJlIG9uY2UgdXAgZnJvbnQ6IHNpbXBsaWZp
ZXMgY2xpZW50cyBhbmQgcmVzdGFydC4gKi8KLQlhZGRfZXZlbnQoY29ubiwg
aW4sIHdhdGNoLCB3YXRjaC0+bm9kZSk7CisJc2VuZF9ldmVudChjb25uLCBn
ZXRfd2F0Y2hfcGF0aCh3YXRjaCwgd2F0Y2gtPm5vZGUpLCB3YXRjaC0+dG9r
ZW4pOwogCiAJcmV0dXJuIDA7CiB9Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-02.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSBkZjBjMTA3ZmJmNjVmNjFiYjFkMzFjOWEzNGVjZWUwNWYzODUyNmE3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBoZWxw
ZXJzIHRvIGZyZWUgc3RydWN0IGJ1ZmZlcmVkX2RhdGEKCkFkZCB0d28gaGVs
cGVycyBmb3IgZnJlZWluZyBzdHJ1Y3QgYnVmZmVyZWRfZGF0YTogZnJlZV9i
dWZmZXJlZF9kYXRhKCkKZm9yIGZyZWVpbmcgb25lIGluc3RhbmNlIGFuZCBj
b25uX2ZyZWVfYnVmZmVyZWRfZGF0YSgpIGZvciBmcmVlaW5nIGFsbAppbnN0
YW5jZXMgZm9yIGEgY29ubmVjdGlvbi4KClRoaXMgaXMgYXZvaWRpbmcgZHVw
bGljYXRlZCBjb2RlIGFuZCB3aWxsIGhlbHAgbGF0ZXIgd2hlbiBtb3JlIGFj
dGlvbnMKYXJlIG5lZWRlZCB3aGVuIGZyZWVpbmcgYSBzdHJ1Y3QgYnVmZmVy
ZWRfZGF0YS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggZWQ3NDJkOWRm
YzJlLi42MWZjMzY4ZThjMjggMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMjA3LDYgKzIwNywyMSBAQCB2b2lkIHJlb3Blbl9s
b2codm9pZCkKIAl9CiB9CiAKK3N0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRf
ZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAorCQkJICAgICAgIHN0
cnVjdCBjb25uZWN0aW9uICpjb25uKQoreworCWxpc3RfZGVsKCZvdXQtPmxp
c3QpOworCXRhbGxvY19mcmVlKG91dCk7Cit9CisKK3ZvaWQgY29ubl9mcmVl
X2J1ZmZlcmVkX2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJ
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKKworCXdoaWxlICgob3V0ID0g
bGlzdF90b3AoJmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0
YSwgbGlzdCkpKQorCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsK
K30KKwogc3RhdGljIGJvb2wgd3JpdGVfbWVzc2FnZXMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CiAJaW50IHJldDsKQEAgLTI1MCw4ICsyNjUsNyBA
QCBzdGF0aWMgYm9vbCB3cml0ZV9tZXNzYWdlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXRyYWNlX2lvKGNvbm4sIG91dCwgMSk7CiAKLQlsaXN0
X2RlbCgmb3V0LT5saXN0KTsKLQl0YWxsb2NfZnJlZShvdXQpOworCWZyZWVf
YnVmZmVyZWRfZGF0YShvdXQsIGNvbm4pOwogCiAJcmV0dXJuIHRydWU7CiB9
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5o
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCA5OWEw
MzczOTQ0YjIuLmM5ZWE3OTYxODVlOCAxMDA2NDQKLS0tIGEvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5oCkBAIC0yNzEsNiArMjcxLDggQEAgaW50IHJlbWVt
YmVyX3N0cmluZyhzdHJ1Y3QgaGFzaHRhYmxlICpoYXNoLCBjb25zdCBjaGFy
ICpzdHIpOwogCiB2b2lkIHNldF90ZGJfa2V5KGNvbnN0IGNoYXIgKm5hbWUs
IFREQl9EQVRBICprZXkpOwogCit2b2lkIGNvbm5fZnJlZV9idWZmZXJlZF9k
YXRhKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKKwogY29uc3QgY2hhciAq
ZHVtcF9zdGF0ZV9nbG9iYWwoRklMRSAqZnApOwogY29uc3QgY2hhciAqZHVt
cF9zdGF0ZV9idWZmZXJlZF9kYXRhKEZJTEUgKmZwLCBjb25zdCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqYywKIAkJCQkgICAgIHN0cnVjdCB4c19zdGF0ZV9jb25u
ZWN0aW9uICpzYyk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKaW5kZXggZWFkNGMyMzdkMjMzLi5kZTM0OWUyYTc3YTUgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYworKysg
Yi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKQEAgLTQxMSwx
NSArNDExLDEwIEBAIHN0YXRpYyBzdHJ1Y3QgZG9tYWluICpmaW5kX2RvbWFp
bl9ieV9kb21pZCh1bnNpZ25lZCBpbnQgZG9taWQpCiBzdGF0aWMgdm9pZCBk
b21haW5fY29ubl9yZXNldChzdHJ1Y3QgZG9tYWluICpkb21haW4pCiB7CiAJ
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4gPSBkb21haW4tPmNvbm47Ci0Jc3Ry
dWN0IGJ1ZmZlcmVkX2RhdGEgKm91dDsKIAogCWNvbm5fZGVsZXRlX2FsbF93
YXRjaGVzKGNvbm4pOwogCWNvbm5fZGVsZXRlX2FsbF90cmFuc2FjdGlvbnMo
Y29ubik7Ci0KLQl3aGlsZSAoKG91dCA9IGxpc3RfdG9wKCZjb25uLT5vdXRf
bGlzdCwgc3RydWN0IGJ1ZmZlcmVkX2RhdGEsIGxpc3QpKSkgewotCQlsaXN0
X2RlbCgmb3V0LT5saXN0KTsKLQkJdGFsbG9jX2ZyZWUob3V0KTsKLQl9CisJ
Y29ubl9mcmVlX2J1ZmZlcmVkX2RhdGEoY29ubik7CiAKIAl0YWxsb2NfZnJl
ZShjb25uLT5pbik7CiAKQEAgLTQzNiw4ICs0MzEsNiBAQCBzdGF0aWMgdm9p
ZCBkb21haW5fY29ubl9yZXNldChzdHJ1Y3QgZG9tYWluICpkb21haW4pCiAg
Ki8KIHZvaWQgaWdub3JlX2Nvbm5lY3Rpb24oc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHVuc2lnbmVkIGludCBlcnIpCiB7Ci0Jc3RydWN0IGJ1ZmZlcmVk
X2RhdGEgKm91dCwgKnRtcDsKLQogCXRyYWNlKCJDT05OICVwIGlnbm9yZWQs
IHJlYXNvbiAldVxuIiwgY29ubiwgZXJyKTsKIAogCWlmIChjb25uLT5kb21h
aW4gJiYgY29ubi0+ZG9tYWluLT5pbnRlcmZhY2UpCkBAIC00NDYsMTEgKzQz
OSw3IEBAIHZvaWQgaWdub3JlX2Nvbm5lY3Rpb24oc3RydWN0IGNvbm5lY3Rp
b24gKmNvbm4sIHVuc2lnbmVkIGludCBlcnIpCiAJY29ubi0+aXNfaWdub3Jl
ZCA9IHRydWU7CiAJY29ubl9kZWxldGVfYWxsX3dhdGNoZXMoY29ubik7CiAJ
Y29ubl9kZWxldGVfYWxsX3RyYW5zYWN0aW9ucyhjb25uKTsKLQotCWxpc3Rf
Zm9yX2VhY2hfZW50cnlfc2FmZShvdXQsIHRtcCwgJmNvbm4tPm91dF9saXN0
LCBsaXN0KSB7Ci0JCWxpc3RfZGVsKCZvdXQtPmxpc3QpOwotCQl0YWxsb2Nf
ZnJlZShvdXQpOwotCX0KKwljb25uX2ZyZWVfYnVmZmVyZWRfZGF0YShjb25u
KTsKIAogCXRhbGxvY19mcmVlKGNvbm4tPmluKTsKIAljb25uLT5pbiA9IE5V
TEw7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-03.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSAxNmE4YTE4NTRiYzhiMzM1ZmZiODI3ODZhOWRkOTBhZDI2OGFhNTU4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlZHVjZSBu
dW1iZXIgb2Ygd2F0Y2ggZXZlbnRzCgpXaGVuIHJlbW92aW5nIGEgd2F0Y2hl
ZCBub2RlIG91dHNpZGUgb2YgYSB0cmFuc2FjdGlvbiwgdHdvIHdhdGNoIGV2
ZW50cwphcmUgYmVpbmcgcHJvZHVjZWQgaW5zdGVhZCBvZiBqdXN0IGEgc2lu
Z2xlIG9uZS4KCldoZW4gZmluYWxpemluZyBhIHRyYW5zYWN0aW9uIHdhdGNo
IGV2ZW50cyBjYW4gYmUgZ2VuZXJhdGVkIGZvciBlYWNoCm5vZGUgd2hpY2gg
aXMgYmVpbmcgbW9kaWZpZWQsIGV2ZW4gaWYgb3V0c2lkZSBhIHRyYW5zYWN0
aW9uIHN1Y2gKbW9kaWZpY2F0aW9ucyBtaWdodCBub3QgaGF2ZSByZXN1bHRl
ZCBpbiBhIHdhdGNoIGV2ZW50LgoKVGhpcyBoYXBwZW5zIGUuZy46CgotIGZv
ciBub2RlcyB3aGljaCBhcmUgb25seSBtb2RpZmllZCBkdWUgdG8gYWRkZWQv
cmVtb3ZlZCBjaGlsZCBlbnRyaWVzCi0gZm9yIG5vZGVzIGJlaW5nIHJlbW92
ZWQgb3IgY3JlYXRlZCBpbXBsaWNpdGx5IChlLmcuIGNyZWF0aW9uIG9mIGEv
Yi9jCiAgaXMgaW1wbGljaXRseSBjcmVhdGluZyBhL2IsIHJlc3VsdGluZyBp
biB3YXRjaCBldmVudHMgZm9yIGEsIGEvYiBhbmQKICBhL2IvYyBpbnN0ZWFk
IG9mIGEvYi9jIG9ubHkpCgpBdm9pZCB0aGVzZSBhZGRpdGlvbmFsIHdhdGNo
IGV2ZW50cywgaW4gb3JkZXIgdG8gcmVkdWNlIHRoZSBuZWVkZWQKbWVtb3J5
IGluc2lkZSBYZW5zdG9yZSBmb3IgcXVldWVpbmcgdGhlbS4KClRoaXMgaXMg
YmVpbmcgYWNoaWV2ZWQgYnkgYWRkaW5nIGV2ZW50IGZsYWdzIHRvIHN0cnVj
dCBhY2Nlc3NlZF9ub2RlCnNwZWNpZnlpbmcgd2hldGhlciBhbiBldmVudCBz
aG91bGQgYmUgdHJpZ2dlcmVkLCBhbmQgd2hldGhlciBpdCBzaG91bGQKYmUg
YW4gZXhhY3QgbWF0Y2ggb2YgdGhlIG1vZGlmaWVkIHBhdGguIEJvdGggZmxh
Z3MgY2FuIGJlIHNldCBmcm9tCmZpcmVfd2F0Y2hlcygpIGluc3RlYWQgb2Yg
aW1wbHlpbmcgdGhlbSBvbmx5LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA2MWZjMzY4ZThjMjguLmI5YTBmZjVlMDVjZiAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMjkxLDcgKzEyOTEsNyBAQCBz
dGF0aWMgdm9pZCBkZWxldGVfY2hpbGQoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sCiB9CiAKIHN0YXRpYyBpbnQgZGVsZXRlX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKLQkJICAgICAgIHN0cnVj
dCBub2RlICpwYXJlbnQsIHN0cnVjdCBub2RlICpub2RlKQorCQkgICAgICAg
c3RydWN0IG5vZGUgKnBhcmVudCwgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wg
d2F0Y2hfZXhhY3QpCiB7CiAJY2hhciAqbmFtZTsKIApAQCAtMTMwMyw3ICsx
MzAzLDcgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkJCSAgICAgICBub2Rl
LT5jaGlsZHJlbik7CiAJCWNoaWxkID0gbmFtZSA/IHJlYWRfbm9kZShjb25u
LCBub2RlLCBuYW1lKSA6IE5VTEw7CiAJCWlmIChjaGlsZCkgewotCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQpKQorCQkJaWYg
KGRlbGV0ZV9ub2RlKGNvbm4sIGN0eCwgbm9kZSwgY2hpbGQsIHRydWUpKQog
CQkJCXJldHVybiBlcnJubzsKIAkJfSBlbHNlIHsKIAkJCXRyYWNlKCJkZWxl
dGVfbm9kZTogRXJyb3IgZGVsZXRpbmcgY2hpbGQgJyVzLyVzJyFcbiIsCkBA
IC0xMzE1LDcgKzEzMTUsMTIgQEAgc3RhdGljIGludCBkZWxldGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQl0
YWxsb2NfZnJlZShuYW1lKTsKIAl9CiAKLQlmaXJlX3dhdGNoZXMoY29ubiwg
Y3R4LCBub2RlLT5uYW1lLCBub2RlLCB0cnVlLCBOVUxMKTsKKwkvKgorCSAq
IEZpcmUgdGhlIHdhdGNoZXMgbm93LCB3aGVuIHdlIGNhbiBzdGlsbCBzZWUg
dGhlIG5vZGUgcGVybWlzc2lvbnMuCisJICogVGhpcyBmaW5lIGFzIHdlIGFy
ZSBzaW5nbGUgdGhyZWFkZWQgYW5kIHRoZSBuZXh0IHBvc3NpYmxlIHJlYWQg
d2lsbAorCSAqIGJlIGhhbmRsZWQgb25seSBhZnRlciB0aGUgbm9kZSBoYXMg
YmVlbiByZWFsbHkgcmVtb3ZlZC4KKwkgKi8KKwlmaXJlX3dhdGNoZXMoY29u
biwgY3R4LCBub2RlLT5uYW1lLCBub2RlLCB3YXRjaF9leGFjdCwgTlVMTCk7
CiAJZGVsZXRlX25vZGVfc2luZ2xlKGNvbm4sIG5vZGUpOwogCWRlbGV0ZV9j
aGlsZChjb25uLCBwYXJlbnQsIGJhc2VuYW1lKG5vZGUtPm5hbWUpKTsKIAl0
YWxsb2NfZnJlZShub2RlKTsKQEAgLTEzNDEsMTMgKzEzNDYsNyBAQCBzdGF0
aWMgaW50IF9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LCBzdHJ1Y3Qgbm9kZSAqbm9kZSwKIAkJcmV0dXJuIChlcnJubyA9
PSBFTk9NRU0pID8gRU5PTUVNIDogRUlOVkFMOwogCW5vZGUtPnBhcmVudCA9
IHBhcmVudDsKIAotCS8qCi0JICogRmlyZSB0aGUgd2F0Y2hlcyBub3csIHdo
ZW4gd2UgY2FuIHN0aWxsIHNlZSB0aGUgbm9kZSBwZXJtaXNzaW9ucy4KLQkg
KiBUaGlzIGZpbmUgYXMgd2UgYXJlIHNpbmdsZSB0aHJlYWRlZCBhbmQgdGhl
IG5leHQgcG9zc2libGUgcmVhZCB3aWxsCi0JICogYmUgaGFuZGxlZCBvbmx5
IGFmdGVyIHRoZSBub2RlIGhhcyBiZWVuIHJlYWxseSByZW1vdmVkLgotCSAq
LwotCWZpcmVfd2F0Y2hlcyhjb25uLCBjdHgsIG5hbWUsIG5vZGUsIGZhbHNl
LCBOVUxMKTsKLQlyZXR1cm4gZGVsZXRlX25vZGUoY29ubiwgY3R4LCBwYXJl
bnQsIG5vZGUpOworCXJldHVybiBkZWxldGVfbm9kZShjb25uLCBjdHgsIHBh
cmVudCwgbm9kZSwgZmFsc2UpOwogfQogCiAKZGlmZiAtLWdpdCBhL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKaW5kZXggZmFmNmM5MzBl
NDJhLi41NDQzMjkwN2ZjNzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCkBAIC0xMzAsNiArMTMwLDEwIEBA
IHN0cnVjdCBhY2Nlc3NlZF9ub2RlCiAKIAkvKiBUcmFuc2FjdGlvbiBub2Rl
IGluIGRhdGEgYmFzZT8gKi8KIAlib29sIHRhX25vZGU7CisKKwkvKiBXYXRj
aCBldmVudCBmbGFncy4gKi8KKwlib29sIGZpcmVfd2F0Y2g7CisJYm9vbCB3
YXRjaF9leGFjdDsKIH07CiAKIHN0cnVjdCBjaGFuZ2VkX2RvbWFpbgpAQCAt
MzI0LDYgKzMyOCwyOSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogfQogCiAvKgorICog
QSB3YXRjaCBldmVudCBzaG91bGQgYmUgZmlyZWQgZm9yIGEgbm9kZSBtb2Rp
ZmllZCBpbnNpZGUgYSB0cmFuc2FjdGlvbi4KKyAqIFNldCB0aGUgY29ycmVz
cG9uZGluZyBpbmZvcm1hdGlvbi4gQSBub24tZXhhY3QgZXZlbnQgaXMgcmVw
bGFjaW5nIGFuIGV4YWN0CisgKiBvbmUsIGJ1dCBub3QgdGhlIG90aGVyIHdh
eSByb3VuZC4KKyAqLwordm9pZCBxdWV1ZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBib29sIHdhdGNoX2V4
YWN0KQoreworCXN0cnVjdCBhY2Nlc3NlZF9ub2RlICppOworCisJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZShjb25uLT50cmFuc2FjdGlvbiwgbmFtZSk7CisJ
aWYgKCFpKSB7CisJCWNvbm4tPnRyYW5zYWN0aW9uLT5mYWlsID0gdHJ1ZTsK
KwkJcmV0dXJuOworCX0KKworCWlmICghaS0+ZmlyZV93YXRjaCkgeworCQlp
LT5maXJlX3dhdGNoID0gdHJ1ZTsKKwkJaS0+d2F0Y2hfZXhhY3QgPSB3YXRj
aF9leGFjdDsKKwl9IGVsc2UgaWYgKCF3YXRjaF9leGFjdCkgeworCQlpLT53
YXRjaF9leGFjdCA9IGZhbHNlOworCX0KK30KKworLyoKICAqIEZpbmFsaXpl
IHRyYW5zYWN0aW9uOgogICogV2FsayB0aHJvdWdoIGFjY2Vzc2VkIG5vZGVz
IGFuZCBjaGVjayBnZW5lcmF0aW9uIGFnYWluc3QgZ2xvYmFsIGRhdGEuCiAg
KiBJZiBhbGwgZW50cmllcyBtYXRjaCwgcmVhZCB0aGUgdHJhbnNhY3Rpb24g
ZW50cmllcyBhbmQgd3JpdGUgdGhlbSB3aXRob3V0CkBAIC0zNzcsMTUgKzQw
NCwxNSBAQCBzdGF0aWMgaW50IGZpbmFsaXplX3RyYW5zYWN0aW9uKHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJf
Y3R4LCBrZXksIGRhdGEsCiAJCQkJCQlUREJfUkVQTEFDRSk7CiAJCQkJdGFs
bG9jX2ZyZWUoZGF0YS5kcHRyKTsKLQkJCQlpZiAocmV0KQotCQkJCQlnb3Rv
IGVycjsKLQkJCQlmaXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUs
IE5VTEwsIGZhbHNlLAotCQkJCQkgICAgIGktPnBlcm1zLnAgPyAmaS0+cGVy
bXMgOiBOVUxMKTsKIAkJCX0gZWxzZSB7Ci0JCQkJZmlyZV93YXRjaGVzKGNv
bm4sIHRyYW5zLCBpLT5ub2RlLCBOVUxMLCBmYWxzZSwKKwkJCQlyZXQgPSB0
ZGJfZGVsZXRlKHRkYl9jdHgsIGtleSk7CisJCQl9CisJCQlpZiAocmV0KQor
CQkJCWdvdG8gZXJyOworCQkJaWYgKGktPmZpcmVfd2F0Y2gpIHsKKwkJCQlm
aXJlX3dhdGNoZXMoY29ubiwgdHJhbnMsIGktPm5vZGUsIE5VTEwsCisJCQkJ
CSAgICAgaS0+d2F0Y2hfZXhhY3QsCiAJCQkJCSAgICAgaS0+cGVybXMucCA/
ICZpLT5wZXJtcyA6IE5VTEwpOwotCQkJCWlmICh0ZGJfZGVsZXRlKHRkYl9j
dHgsIGtleSkpCi0JCQkJCWdvdG8gZXJyOwogCQkJfQogCQl9CiAKZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKaW5k
ZXggMTQwNjI3MzBlM2M5Li4wMDkzY2FjODA3ZTMgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCisrKyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5oCkBAIC00Miw2
ICs0Miw5IEBAIHZvaWQgdHJhbnNhY3Rpb25fZW50cnlfZGVjKHN0cnVjdCB0
cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVkIGludCBkb21pZCk7CiBpbnQg
YWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlLAogICAgICAgICAgICAgICAgIGVudW0gbm9kZV9hY2Nlc3Nf
dHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKIAorLyogUXVldWUgd2F0Y2hl
cyBmb3IgYSBtb2RpZmllZCBub2RlLiAqLwordm9pZCBxdWV1ZV93YXRjaGVz
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpuYW1lLCBi
b29sIHdhdGNoX2V4YWN0KTsKKwogLyogUHJlcGVuZCB0aGUgdHJhbnNhY3Rp
b24gdG8gbmFtZSBpZiBhcHByb3ByaWF0ZS4gKi8KIGludCB0cmFuc2FjdGlv
bl9wcmVwZW5kKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgVERCX0RBVEEgKmtl
eSk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0
Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCmluZGV4
IDk5YTJjMjY2YjI4YS4uMjA1ZDlkOGVhMTE2IDEwMDY0NAotLS0gYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAtMjksNiArMjksNyBAQAogI2lu
Y2x1ZGUgInhlbnN0b3JlX2xpYi5oIgogI2luY2x1ZGUgInV0aWxzLmgiCiAj
aW5jbHVkZSAieGVuc3RvcmVkX2RvbWFpbi5oIgorI2luY2x1ZGUgInhlbnN0
b3JlZF90cmFuc2FjdGlvbi5oIgogCiBleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CiAKQEAgLTE0Myw5ICsxNDQsMTEgQEAgdm9pZCBm
aXJlX3dhdGNoZXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwKIAlzdHJ1Y3QgY29ubmVjdGlv
biAqaTsKIAlzdHJ1Y3Qgd2F0Y2ggKndhdGNoOwogCi0JLyogRHVyaW5nIHRy
YW5zYWN0aW9ucywgZG9uJ3QgZmlyZSB3YXRjaGVzLiAqLwotCWlmIChjb25u
ICYmIGNvbm4tPnRyYW5zYWN0aW9uKQorCS8qIER1cmluZyB0cmFuc2FjdGlv
bnMsIGRvbid0IGZpcmUgd2F0Y2hlcywgYnV0IHF1ZXVlIHRoZW0uICovCisJ
aWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24pIHsKKwkJcXVldWVfd2F0
Y2hlcyhjb25uLCBuYW1lLCBleGFjdCk7CiAJCXJldHVybjsKKwl9CiAKIAkv
KiBDcmVhdGUgYW4gZXZlbnQgZm9yIGVhY2ggd2F0Y2guICovCiAJbGlzdF9m
b3JfZWFjaF9lbnRyeShpLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-04.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-04.patch"
Content-Transfer-Encoding: base64

RnJvbSA1MDhmNThhOTI1OTdlMmNhNzI3NzUyZWJkZjlhZGJhNTljZjNmYjIz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDcgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxldCB1bnJl
YWQgd2F0Y2ggZXZlbnRzIHRpbWUgb3V0CgpBIGZ1dHVyZSBtb2RpZmljYXRp
b24gd2lsbCBsaW1pdCB0aGUgbnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzCmZvciBhIGRvbWFpbiwgd2hlcmUgIm91dHN0YW5kaW5nIiBtZWFucyB0
aGF0IHRoZSByZXNwb25zZSBvZiB0aGUKcmVxdWVzdCBvciBhbnkgcmVzdWx0
aW5nIHdhdGNoIGV2ZW50IGhhc24ndCBiZWVuIGNvbnN1bWVkIHlldC4KCklu
IG9yZGVyIHRvIGF2b2lkIGEgbWFsaWNpb3VzIGd1ZXN0IGJlaW5nIGNhcGFi
bGUgdG8gYmxvY2sgb3RoZXIgZ3Vlc3RzCmJ5IG5vdCByZWFkaW5nIHdhdGNo
IGV2ZW50cywgYWRkIGEgdGltZW91dCBmb3Igd2F0Y2ggZXZlbnRzLiBJbiBj
YXNlIGEKd2F0Y2ggZXZlbnQgaGFzbid0IGJlZW4gY29uc3VtZWQgYWZ0ZXIg
dGhpcyB0aW1lb3V0LCBpdCBpcyBiZWluZwpkZWxldGVkLiBTZXQgdGhlIGRl
ZmF1bHQgdGltZW91dCB0byAyMCBzZWNvbmRzIChhIHJhbmRvbSB2YWx1ZSBi
ZWluZwpub3QgdG9vIGhpZ2gpLgoKSW4gb3JkZXIgdG8gc3VwcG9ydCB0byBz
cGVjaWZ5IG90aGVyIHRpbWVvdXQgdmFsdWVzIGluIGZ1dHVyZSwgdXNlIGEK
Z2VuZXJpYyBjb21tYW5kIGxpbmUgb3B0aW9uIGZvciB0aGF0IHB1cnBvc2U6
CgotLXRpbWVvdXR8LXcgd2F0Y2gtZXZlbnQ9PHNlY29uZHM+CgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzExLgoKUmVwb3J0ZWQt
Ynk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggYjlhMGZmNWUw
NWNmLi5jY2UwMmYyNGI1MWMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYwpAQCAtMTA4LDYgKzEwOCw4IEBAIGludCBxdW90YV9tYXhf
dHJhbnNhY3Rpb24gPSAxMDsKIGludCBxdW90YV9uYl9wZXJtc19wZXJfbm9k
ZSA9IDU7CiBpbnQgcXVvdGFfbWF4X3BhdGhfbGVuID0gWEVOU1RPUkVfUkVM
X1BBVEhfTUFYOwogCit1bnNpZ25lZCBpbnQgdGltZW91dF93YXRjaF9ldmVu
dF9tc2VjID0gMjAwMDA7CisKIHZvaWQgdHJhY2UoY29uc3QgY2hhciAqZm10
LCAuLi4pCiB7CiAJdmFfbGlzdCBhcmdsaXN0OwpAQCAtMjA3LDE5ICsyMDks
OTIgQEAgdm9pZCByZW9wZW5fbG9nKHZvaWQpCiAJfQogfQogCitzdGF0aWMg
dWludDY0X3QgZ2V0X25vd19tc2VjKHZvaWQpCit7CisJc3RydWN0IHRpbWVz
cGVjIG5vd190czsKKworCWlmIChjbG9ja19nZXR0aW1lKENMT0NLX01PTk9U
T05JQywgJm5vd190cykpCisJCWJhcmZfcGVycm9yKCJDb3VsZCBub3QgZmlu
ZCB0aW1lIChjbG9ja19nZXR0aW1lIGZhaWxlZCkiKTsKKworCXJldHVybiBu
b3dfdHMudHZfc2VjICogMTAwMCArIG5vd190cy50dl9uc2VjIC8gMTAwMDAw
MDsKK30KKwogc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVj
dCBidWZmZXJlZF9kYXRhICpvdXQsCiAJCQkgICAgICAgc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pCiB7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsK
KwogCWxpc3RfZGVsKCZvdXQtPmxpc3QpOworCisJLyoKKwkgKiBVcGRhdGUg
Y29ubi0+dGltZW91dF9tc2VjIHdpdGggdGhlIG5leHQgZm91bmQgdGltZW91
dCB2YWx1ZSBpbiB0aGUKKwkgKiBxdWV1ZWQgcGVuZGluZyByZXF1ZXN0cy4K
KwkgKi8KKwlpZiAob3V0LT50aW1lb3V0X21zZWMpIHsKKwkJY29ubi0+dGlt
ZW91dF9tc2VjID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShyZXEsICZj
b25uLT5vdXRfbGlzdCwgbGlzdCkgeworCQkJaWYgKHJlcS0+dGltZW91dF9t
c2VjKSB7CisJCQkJY29ubi0+dGltZW91dF9tc2VjID0gcmVxLT50aW1lb3V0
X21zZWM7CisJCQkJYnJlYWs7CisJCQl9CisJCX0KKwl9CisKIAl0YWxsb2Nf
ZnJlZShvdXQpOwogfQogCitzdGF0aWMgdm9pZCBjaGVja19ldmVudF90aW1l
b3V0KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCB1aW50NjRfdCBtc2VjcywK
KwkJCQlpbnQgKnB0aW1lb3V0KQoreworCXVpbnQ2NF90IGRlbHRhOworCXN0
cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsICp0bXA7CisKKwlpZiAoIWNvbm4t
PnRpbWVvdXRfbXNlYykKKwkJcmV0dXJuOworCisJZGVsdGEgPSBjb25uLT50
aW1lb3V0X21zZWMgLSBtc2VjczsKKwlpZiAoY29ubi0+dGltZW91dF9tc2Vj
IDw9IG1zZWNzKSB7CisJCWRlbHRhID0gMDsKKwkJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKG91dCwgdG1wLCAmY29ubi0+b3V0X2xpc3QsIGxpc3QpIHsK
KwkJCS8qCisJCQkgKiBPbmx5IGxvb2sgYXQgYnVmZmVycyB3aXRoIHRpbWVv
dXQgYW5kIG5vIGRhdGEKKwkJCSAqIGFscmVhZHkgd3JpdHRlbiB0byB0aGUg
cmluZy4KKwkJCSAqLworCQkJaWYgKG91dC0+dGltZW91dF9tc2VjICYmIG91
dC0+aW5oZHIgJiYgIW91dC0+dXNlZCkgeworCQkJCWlmIChvdXQtPnRpbWVv
dXRfbXNlYyA+IG1zZWNzKSB7CisJCQkJCWNvbm4tPnRpbWVvdXRfbXNlYyA9
IG91dC0+dGltZW91dF9tc2VjOworCQkJCQlkZWx0YSA9IGNvbm4tPnRpbWVv
dXRfbXNlYyAtIG1zZWNzOworCQkJCQlicmVhazsKKwkJCQl9CisKKwkJCQkv
KgorCQkJCSAqIEZyZWUgb3V0IHdpdGhvdXQgdXBkYXRpbmcgY29ubi0+dGlt
ZW91dF9tc2VjLAorCQkJCSAqIGFzIHRoZSB1cGRhdGUgaXMgZG9uZSBpbiB0
aGlzIGxvb3AgYWxyZWFkeS4KKwkJCQkgKi8KKwkJCQlvdXQtPnRpbWVvdXRf
bXNlYyA9IDA7CisJCQkJdHJhY2UoIndhdGNoIGV2ZW50IHBhdGggJXMgZm9y
IGRvbWFpbiAldSB0aW1lZCBvdXRcbiIsCisJCQkJICAgICAgb3V0LT5idWZm
ZXIsIGNvbm4tPmlkKTsKKwkJCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBj
b25uKTsKKwkJCX0KKwkJfQorCQlpZiAoIWRlbHRhKSB7CisJCQljb25uLT50
aW1lb3V0X21zZWMgPSAwOworCQkJcmV0dXJuOworCQl9CisJfQorCisJaWYg
KCpwdGltZW91dCA9PSAtMSB8fCAqcHRpbWVvdXQgPiBkZWx0YSkKKwkJKnB0
aW1lb3V0ID0gZGVsdGE7Cit9CisKIHZvaWQgY29ubl9mcmVlX2J1ZmZlcmVk
X2RhdGEoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiB7CiAJc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKm91dDsKIAogCXdoaWxlICgob3V0ID0gbGlzdF90b3Ao
JmNvbm4tPm91dF9saXN0LCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSwgbGlzdCkp
KQogCQlmcmVlX2J1ZmZlcmVkX2RhdGEob3V0LCBjb25uKTsKKworCWNvbm4t
PnRpbWVvdXRfbXNlYyA9IDA7CiB9CiAKIHN0YXRpYyBib29sIHdyaXRlX21l
c3NhZ2VzKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKQpAQCAtNDA3LDYgKzQ4
Miw3IEBAIHN0YXRpYyB2b2lkIGluaXRpYWxpemVfZmRzKGludCAqcF9zb2Nr
X3BvbGxmZF9pZHgsIGludCAqcHRpbWVvdXQpCiB7CiAJc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm47CiAJc3RydWN0IHdybF90aW1lc3RhbXB0IG5vdzsKKwl1
aW50NjRfdCBtc2VjczsKIAogCWlmIChmZHMpCiAJCW1lbXNldChmZHMsIDAs
IHNpemVvZihzdHJ1Y3QgcG9sbGZkKSAqIGN1cnJlbnRfYXJyYXlfc2l6ZSk7
CkBAIC00MjcsMTAgKzUwMywxMiBAQCBzdGF0aWMgdm9pZCBpbml0aWFsaXpl
X2ZkcyhpbnQgKnBfc29ja19wb2xsZmRfaWR4LCBpbnQgKnB0aW1lb3V0KQog
CiAJd3JsX2dldHRpbWVfbm93KCZub3cpOwogCXdybF9sb2dfcGVyaW9kaWMo
bm93KTsKKwltc2VjcyA9IGdldF9ub3dfbXNlYygpOwogCiAJbGlzdF9mb3Jf
ZWFjaF9lbnRyeShjb25uLCAmY29ubmVjdGlvbnMsIGxpc3QpIHsKIAkJaWYg
KGNvbm4tPmRvbWFpbikgewogCQkJd3JsX2NoZWNrX3RpbWVvdXQoY29ubi0+
ZG9tYWluLCBub3csIHB0aW1lb3V0KTsKKwkJCWNoZWNrX2V2ZW50X3RpbWVv
dXQoY29ubiwgbXNlY3MsIHB0aW1lb3V0KTsKIAkJCWlmIChjb25uX2Nhbl9y
ZWFkKGNvbm4pIHx8CiAJCQkgICAgKGNvbm5fY2FuX3dyaXRlKGNvbm4pICYm
CiAJCQkgICAgICFsaXN0X2VtcHR5KCZjb25uLT5vdXRfbGlzdCkpKQpAQCAt
NzkwLDYgKzg2OCw3IEBAIHZvaWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgZW51bSB4c2Rfc29ja21zZ190eXBlIHR5cGUsCiAJCXJl
dHVybjsKIAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0g
MDsKKwliZGF0YS0+dGltZW91dF9tc2VjID0gMDsKIAogCWlmIChsZW4gPD0g
REVGQVVMVF9CVUZGRVJfU0laRSkKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRh
LT5kZWZhdWx0X2J1ZmZlcjsKQEAgLTg0MSw2ICs5MjAsMTIgQEAgdm9pZCBz
ZW5kX2V2ZW50KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFy
ICpwYXRoLCBjb25zdCBjaGFyICp0b2tlbikKIAliZGF0YS0+aGRyLm1zZy50
eXBlID0gWFNfV0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0g
bGVuOwogCisJaWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21h
aW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKSB7CisJCWJkYXRhLT50aW1lb3V0
X21zZWMgPSBnZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRf
bXNlYzsKKwkJaWYgKCFjb25uLT50aW1lb3V0X21zZWMpCisJCQljb25uLT50
aW1lb3V0X21zZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOworCX0KKwogCS8q
IFF1ZXVlIGZvciBsYXRlciB0cmFuc21pc3Npb24uICovCiAJbGlzdF9hZGRf
dGFpbCgmYmRhdGEtPmxpc3QsICZjb25uLT5vdXRfbGlzdCk7CiB9CkBAIC0y
MTg1LDYgKzIyNzAsOSBAQCBzdGF0aWMgdm9pZCB1c2FnZSh2b2lkKQogIiAg
LXQsIC0tdHJhbnNhY3Rpb24gPG5iPiAgbGltaXQgdGhlIG51bWJlciBvZiB0
cmFuc2FjdGlvbiBhbGxvd2VkIHBlciBkb21haW4sXG4iCiAiICAtQSwgLS1w
ZXJtLW5iIDxuYj4gICAgICBsaW1pdCB0aGUgbnVtYmVyIG9mIHBlcm1pc3Np
b25zIHBlciBub2RlLFxuIgogIiAgLU0sIC0tcGF0aC1tYXggPGNoYXJzPiAg
bGltaXQgdGhlIGFsbG93ZWQgWGVuc3RvcmUgbm9kZSBwYXRoIGxlbmd0aCxc
biIKKyIgIC13LCAtLXRpbWVvdXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0
aGUgdGltZW91dCBpbiBzZWNvbmRzIGZvciA8d2hhdD4sXG4iCisiICAgICAg
ICAgICAgICAgICAgICAgICAgICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRl
cyBhcmU6XG4iCisiICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaC1l
dmVudDogdGltZSBhIHdhdGNoLWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xuIgog
IiAgLVIsIC0tbm8tcmVjb3ZlcnkgICAgICAgdG8gcmVxdWVzdCB0aGF0IG5v
IHJlY292ZXJ5IHNob3VsZCBiZSBhdHRlbXB0ZWQgd2hlblxuIgogIiAgICAg
ICAgICAgICAgICAgICAgICAgICAgdGhlIHN0b3JlIGlzIGNvcnJ1cHRlZCAo
ZGVidWcgb25seSksXG4iCiAiICAtSSwgLS1pbnRlcm5hbC1kYiAgICAgICBz
dG9yZSBkYXRhYmFzZSBpbiBtZW1vcnksIG5vdCBvbiBkaXNrXG4iCkBAIC0y
MjA3LDYgKzIyOTUsNyBAQCBzdGF0aWMgc3RydWN0IG9wdGlvbiBvcHRpb25z
W10gPSB7CiAJeyAidHJhbnNhY3Rpb24iLCAxLCBOVUxMLCAndCcgfSwKIAl7
ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCiAJeyAicGF0aC1tYXgiLCAx
LCBOVUxMLCAnTScgfSwKKwl7ICJ0aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0s
CiAJeyAibm8tcmVjb3ZlcnkiLCAwLCBOVUxMLCAnUicgfSwKIAl7ICJpbnRl
cm5hbC1kYiIsIDAsIE5VTEwsICdJJyB9LAogCXsgInZlcmJvc2UiLCAwLCBO
VUxMLCAnVicgfSwKQEAgLTIyMjAsNiArMjMwOSwzOSBAQCBpbnQgZG9tMF9k
b21pZCA9IDA7CiBpbnQgZG9tMF9ldmVudCA9IDA7CiBpbnQgcHJpdl9kb21p
ZCA9IDA7CiAKK3N0YXRpYyBpbnQgZ2V0X29wdHZhbF9pbnQoY29uc3QgY2hh
ciAqYXJnKQoreworCWNoYXIgKmVuZDsKKwlsb25nIHZhbDsKKworCXZhbCA9
IHN0cnRvbChhcmcsICZlbmQsIDEwKTsKKwlpZiAoISphcmcgfHwgKmVuZCB8
fCB2YWwgPCAwIHx8IHZhbCA+IElOVF9NQVgpCisJCWJhcmYoImludmFsaWQg
cGFyYW1ldGVyIHZhbHVlIFwiJXNcIlxuIiwgYXJnKTsKKworCXJldHVybiB2
YWw7Cit9CisKK3N0YXRpYyBib29sIHdoYXRfbWF0Y2hlcyhjb25zdCBjaGFy
ICphcmcsIGNvbnN0IGNoYXIgKndoYXQpCit7CisJdW5zaWduZWQgaW50IHdo
YXRfbGVuID0gc3RybGVuKHdoYXQpOworCisJcmV0dXJuICFzdHJuY21wKGFy
Zywgd2hhdCwgd2hhdF9sZW4pICYmIGFyZ1t3aGF0X2xlbl0gPT0gJz0nOwor
fQorCitzdGF0aWMgdm9pZCBzZXRfdGltZW91dChjb25zdCBjaGFyICphcmcp
Cit7CisJY29uc3QgY2hhciAqZXEgPSBzdHJjaHIoYXJnLCAnPScpOworCWlu
dCB2YWw7CisKKwlpZiAoIWVxKQorCQliYXJmKCJxdW90YXMgbXVzdCBiZSBz
cGVjaWZpZWQgdmlhIDx3aGF0Pj08c2Vjb25kcz5cbiIpOworCXZhbCA9IGdl
dF9vcHR2YWxfaW50KGVxICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hlcyhhcmcs
ICJ3YXRjaC1ldmVudCIpKQorCQl0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWMg
PSB2YWwgKiAxMDAwOworCWVsc2UKKwkJYmFyZigidW5rbm93biB0aW1lb3V0
IFwiJXNcIlxuIiwgYXJnKTsKK30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNo
YXIgKmFyZ3ZbXSkKIHsKIAlpbnQgb3B0OwpAQCAtMjIzNCw3ICsyMzU2LDcg
QEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlvcmlnX2Fy
Z2MgPSBhcmdjOwogCW9yaWdfYXJndiA9IGFyZ3Y7CiAKLQl3aGlsZSAoKG9w
dCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06
VDpSVlc6VSIsIG9wdGlvbnMsCisJd2hpbGUgKChvcHQgPSBnZXRvcHRfbG9u
ZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6QTpNOlQ6UlZXOnc6VSIsIG9w
dGlvbnMsCiAJCQkJICBOVUxMKSkgIT0gLTEpIHsKIAkJc3dpdGNoIChvcHQp
IHsKIAkJY2FzZSAnRCc6CkBAIC0yMjg0LDYgKzI0MDYsOSBAQCBpbnQgbWFp
bihpbnQgYXJnYywgY2hhciAqYXJndltdKQogCQkJcXVvdGFfbWF4X3BhdGhf
bGVuID0gbWluKFhFTlNUT1JFX1JFTF9QQVRIX01BWCwKIAkJCQkJCSBxdW90
YV9tYXhfcGF0aF9sZW4pOwogCQkJYnJlYWs7CisJCWNhc2UgJ3cnOgorCQkJ
c2V0X3RpbWVvdXQob3B0YXJnKTsKKwkJCWJyZWFrOwogCQljYXNlICdlJzoK
IAkJCWRvbTBfZXZlbnQgPSBzdHJ0b2wob3B0YXJnLCBOVUxMLCAxMCk7CiAJ
CQlicmVhazsKQEAgLTI3MTQsNiArMjgzOSwxMiBAQCBzdGF0aWMgdm9pZCBh
ZGRfYnVmZmVyZWRfZGF0YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGEs
CiAJCWJhcmYoImVycm9yIHJlc3RvcmluZyBidWZmZXJlZCBkYXRhIik7CiAK
IAltZW1jcHkoYmRhdGEtPmJ1ZmZlciwgZGF0YSwgbGVuKTsKKwlpZiAoYmRh
dGEtPmhkci5tc2cudHlwZSA9PSBYU19XQVRDSF9FVkVOVCAmJiB0aW1lb3V0
X3dhdGNoX2V2ZW50X21zZWMgJiYKKwkgICAgZG9tYWluX2lzX3VucHJpdmls
ZWdlZChjb25uKSkgeworCQliZGF0YS0+dGltZW91dF9tc2VjID0gZ2V0X25v
d19tc2VjKCkgKyB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7CisJCWlmICgh
Y29ubi0+dGltZW91dF9tc2VjKQorCQkJY29ubi0+dGltZW91dF9tc2VjID0g
YmRhdGEtPnRpbWVvdXRfbXNlYzsKKwl9CiAKIAkvKiBRdWV1ZSBmb3IgbGF0
ZXIgdHJhbnNtaXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5s
aXN0LCAmY29ubi0+b3V0X2xpc3QpOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmgKaW5kZXggYzllYTc5NjE4NWU4Li43NDUyNjJhZjk2ZmQg
MTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgK
KysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjcs
NiArMjcsNyBAQAogI2luY2x1ZGUgPGZjbnRsLmg+CiAjaW5jbHVkZSA8c3Rk
Ym9vbC5oPgogI2luY2x1ZGUgPHN0ZGludC5oPgorI2luY2x1ZGUgPHRpbWUu
aD4KICNpbmNsdWRlIDxlcnJuby5oPgogCiAjaW5jbHVkZSAieGVuc3RvcmVf
bGliLmgiCkBAIC02Nyw2ICs2OCw4IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJCWNoYXIgcmF3W3NpemVvZihzdHJ1Y3QgeHNkX3NvY2ttc2cpXTsKIAl9
IGhkcjsKIAorCXVpbnQ2NF90IHRpbWVvdXRfbXNlYzsKKwogCS8qIFRoZSBh
Y3R1YWwgZGF0YS4gKi8KIAljaGFyICpidWZmZXI7CiAJY2hhciBkZWZhdWx0
X2J1ZmZlcltERUZBVUxUX0JVRkZFUl9TSVpFXTsKQEAgLTExOCw2ICsxMjEs
NyBAQCBzdHJ1Y3QgY29ubmVjdGlvbgogCiAJLyogQnVmZmVyZWQgb3V0cHV0
IGRhdGEgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIG91dF9saXN0OworCXVpbnQ2
NF90IHRpbWVvdXRfbXNlYzsKIAogCS8qIFRyYW5zYWN0aW9uIGNvbnRleHQg
Zm9yIGN1cnJlbnQgcmVxdWVzdCAoTlVMTCBpZiBub25lKS4gKi8KIAlzdHJ1
Y3QgdHJhbnNhY3Rpb24gKnRyYW5zYWN0aW9uOwpAQCAtMjQyLDYgKzI0Niw4
IEBAIGV4dGVybiBpbnQgZG9tMF9ldmVudDsKIGV4dGVybiBpbnQgcHJpdl9k
b21pZDsKIGV4dGVybiBpbnQgcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbjsK
IAorZXh0ZXJuIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNoX2V2ZW50X21z
ZWM7CisKIC8qIE1hcCB0aGUga2VybmVsJ3MgeGVuc3RvcmUgcGFnZS4gKi8K
IHZvaWQgKnhlbmJ1c19tYXAodm9pZCk7CiB2b2lkIHVubWFwX3hlbmJ1cyh2
b2lkICppbnRlcmZhY2UpOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-05.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-05.patch"
Content-Transfer-Encoding: base64

RnJvbSA4MjczZDUwMTkyMzRjYmEzMDhkN2ZjOTY0NzAwNjk1NDQ5NDlmNjBk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG91
dHN0YW5kaW5nIHJlcXVlc3RzCgpBZGQgYW5vdGhlciBxdW90YSBmb3IgbGlt
aXRpbmcgdGhlIG51bWJlciBvZiBvdXRzdGFuZGluZyByZXF1ZXN0cyBvZiBh
Cmd1ZXN0LiBBcyB0aGUgd2F5IHRvIHNwZWNpZnkgcXVvdGFzIG9uIHRoZSBj
b21tYW5kIGxpbmUgaXMgYmVjb21pbmcKcmF0aGVyIG5hc3R5LCBzd2l0Y2gg
dG8gYSBuZXcgc2NoZW1lIHVzaW5nIFstLXF1b3RhfC1RXSA8d2hhdD49PHZh
bD4KYWxsb3dpbmcgdG8gYWRkIG1vcmUgcXVvdGFzIGluIGZ1dHVyZSBlYXNp
bHkuCgpTZXQgdGhlIGRlZmF1bHQgdmFsdWUgdG8gMjAgKGJhc2ljYWxseSBh
IHJhbmRvbSB2YWx1ZSBub3Qgc2VlbWluZyB0bwpiZSB0b28gaGlnaCBvciB0
b28gbG93KS4KCkEgcmVxdWVzdCBpcyBzYWlkIHRvIGJlIG91dHN0YW5kaW5n
IGlmIGFueSBtZXNzYWdlIGdlbmVyYXRlZCBieSB0aGlzCnJlcXVlc3QgKHRo
ZSBkaXJlY3QgcmVzcG9uc2UgcGx1cyBwb3RlbnRpYWwgd2F0Y2ggZXZlbnRz
KSBpcyBub3QgeWV0CmNvbXBsZXRlbHkgc3RvcmVkIGludG8gYSByaW5nIGJ1
ZmZlci4gVGhlIGluaXRpYWwgd2F0Y2ggZXZlbnQgc2VudCBhcwphIHJlc3Vs
dCBvZiByZWdpc3RlcmluZyBhIHdhdGNoIGlzIGFuIGV4Y2VwdGlvbi4KCk5v
dGUgdGhhdCBhY3Jvc3MgYSBsaXZlIHVwZGF0ZSB0aGUgcmVsYXRpb24gdG8g
YnVmZmVyZWQgd2F0Y2ggZXZlbnRzCmZvciBvdGhlciBkb21haW5zIGlzIGxv
c3QuCgpVc2UgdGFsbG9jX3plcm8oKSBmb3IgYWxsb2NhdGluZyB0aGUgZG9t
YWluIHN0cnVjdHVyZSBpbiBvcmRlciB0byBoYXZlCmFsbCBwZXItZG9tYWlu
IHF1b3RhIHplcm9lZCBpbml0aWFsbHkuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTMyNiAvIENWRS0yMDIyLTQyMzEyLgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJn
ZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggY2NlMDJmMjRiNTFjLi41NGU2YWRkMWEx
NTcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MTA3LDYgKzEwNyw3IEBAIGludCBxdW90YV9tYXhfZW50cnlfc2l6ZSA9IDIw
NDg7IC8qIDJLICovCiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uID0gMTA7
CiBpbnQgcXVvdGFfbmJfcGVybXNfcGVyX25vZGUgPSA1OwogaW50IHF1b3Rh
X21heF9wYXRoX2xlbiA9IFhFTlNUT1JFX1JFTF9QQVRIX01BWDsKK2ludCBx
dW90YV9yZXFfb3V0c3RhbmRpbmcgPSAyMDsKIAogdW5zaWduZWQgaW50IHRp
bWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyA9IDIwMDAwOwogCkBAIC0yMTksMTIg
KzIyMCwyNCBAQCBzdGF0aWMgdWludDY0X3QgZ2V0X25vd19tc2VjKHZvaWQp
CiAJcmV0dXJuIG5vd190cy50dl9zZWMgKiAxMDAwICsgbm93X3RzLnR2X25z
ZWMgLyAxMDAwMDAwOwogfQogCisvKgorICogUmVtb3ZlIGEgc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgZnJvbSB0aGUgbGlzdCBvZiBvdXRnb2luZyBkYXRhLgor
ICogQSBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSByZWxhdGVkIHRvIGEgcmVxdWVz
dCBoYXZpbmcgY2F1c2VkIHdhdGNoIGV2ZW50cyB0byBiZQorICogc2VudCBp
cyBrZXB0IHVudGlsIGFsbCB0aG9zZSBldmVudHMgaGF2ZSBiZWVuIHdyaXR0
ZW4gb3V0LgorICogRWFjaCB3YXRjaCBldmVudCBpcyByZWZlcmVuY2luZyB0
aGUgcmVsYXRlZCByZXF1ZXN0IHZpYSBwZW5kLnJlcSwgd2hpbGUgdGhlCisg
KiBudW1iZXIgb2Ygd2F0Y2ggZXZlbnRzIGNhdXNlZCBieSBhIHJlcXVlc3Qg
aXMga2VwdCBpbiBwZW5kLnJlZi5ldmVudF9jbnQKKyAqICh0aG9zZSB0d28g
Y2FzZXMgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZSwgc28gdGhlIHR3byBmaWVs
ZHMgY2FuIHNoYXJlIG1lbW9yeQorICogdmlhIGEgdW5pb24pLgorICogVGhl
IHN0cnVjdCBidWZmZXJlZF9kYXRhIGlzIGZyZWVkIG9ubHkgaWYgbm8gcmVs
YXRlZCB3YXRjaCBldmVudCBpcworICogcmVmZXJlbmNpbmcgaXQuIFRoZSBy
ZWxhdGVkIHJldHVybiBkYXRhIGNhbiBiZSBmcmVlZCByaWdodCBhd2F5Lgor
ICovCiBzdGF0aWMgdm9pZCBmcmVlX2J1ZmZlcmVkX2RhdGEoc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKm91dCwKIAkJCSAgICAgICBzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIHsKIAlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCiAJ
bGlzdF9kZWwoJm91dC0+bGlzdCk7CisJb3V0LT5vbl9vdXRfbGlzdCA9IGZh
bHNlOwogCiAJLyoKIAkgKiBVcGRhdGUgY29ubi0+dGltZW91dF9tc2VjIHdp
dGggdGhlIG5leHQgZm91bmQgdGltZW91dCB2YWx1ZSBpbiB0aGUKQEAgLTI0
MCw2ICsyNTMsMzAgQEAgc3RhdGljIHZvaWQgZnJlZV9idWZmZXJlZF9kYXRh
KHN0cnVjdCBidWZmZXJlZF9kYXRhICpvdXQsCiAJCX0KIAl9CiAKKwlpZiAo
b3V0LT5oZHIubXNnLnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKKwkJcmVx
ID0gb3V0LT5wZW5kLnJlcTsKKwkJaWYgKHJlcSkgeworCQkJcmVxLT5wZW5k
LnJlZi5ldmVudF9jbnQtLTsKKwkJCWlmICghcmVxLT5wZW5kLnJlZi5ldmVu
dF9jbnQgJiYgIXJlcS0+b25fb3V0X2xpc3QpIHsKKwkJCQlpZiAocmVxLT5v
bl9yZWZfbGlzdCkgeworCQkJCQlkb21haW5fb3V0c3RhbmRpbmdfZG9taWRf
ZGVjKAorCQkJCQkJcmVxLT5wZW5kLnJlZi5kb21pZCk7CisJCQkJCWxpc3Rf
ZGVsKCZyZXEtPmxpc3QpOworCQkJCX0KKwkJCQl0YWxsb2NfZnJlZShyZXEp
OworCQkJfQorCQl9CisJfSBlbHNlIGlmIChvdXQtPnBlbmQucmVmLmV2ZW50
X2NudCkgeworCQkvKiBIYW5nIG91dCBvZmYgZnJvbSBjb25uLiAqLworCQl0
YWxsb2Nfc3RlYWwoTlVMTCwgb3V0KTsKKwkJaWYgKG91dC0+YnVmZmVyICE9
IG91dC0+ZGVmYXVsdF9idWZmZXIpCisJCQl0YWxsb2NfZnJlZShvdXQtPmJ1
ZmZlcik7CisJCWxpc3RfYWRkKCZvdXQtPmxpc3QsICZjb25uLT5yZWZfbGlz
dCk7CisJCW91dC0+b25fcmVmX2xpc3QgPSB0cnVlOworCQlyZXR1cm47CisJ
fSBlbHNlCisJCWRvbWFpbl9vdXRzdGFuZGluZ19kZWMoY29ubik7CisKIAl0
YWxsb2NfZnJlZShvdXQpOwogfQogCkBAIC00MDEsNiArNDM4LDcgQEAgaW50
IGRlbGF5X3JlcXVlc3Qoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVj
dCBidWZmZXJlZF9kYXRhICppbiwKIHN0YXRpYyBpbnQgZGVzdHJveV9jb25u
KHZvaWQgKl9jb25uKQogewogCXN0cnVjdCBjb25uZWN0aW9uICpjb25uID0g
X2Nvbm47CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKnJlcTsKIAogCS8qIEZs
dXNoIG91dGdvaW5nIGlmIHBvc3NpYmxlLCBidXQgZG9uJ3QgYmxvY2suICov
CiAJaWYgKCFjb25uLT5kb21haW4pIHsKQEAgLTQxNCw2ICs0NTIsMTEgQEAg
c3RhdGljIGludCBkZXN0cm95X2Nvbm4odm9pZCAqX2Nvbm4pCiAJCQkJYnJl
YWs7CiAJCWNsb3NlKGNvbm4tPmZkKTsKIAl9CisKKwljb25uX2ZyZWVfYnVm
ZmVyZWRfZGF0YShjb25uKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHJlcSwg
JmNvbm4tPnJlZl9saXN0LCBsaXN0KQorCQlyZXEtPm9uX3JlZl9saXN0ID0g
ZmFsc2U7CisKICAgICAgICAgaWYgKGNvbm4tPnRhcmdldCkKICAgICAgICAg
ICAgICAgICB0YWxsb2NfdW5saW5rKGNvbm4sIGNvbm4tPnRhcmdldCk7CiAJ
bGlzdF9kZWwoJmNvbm4tPmxpc3QpOwpAQCAtODg5LDYgKzkzMiw4IEBAIHZv
aWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgZW51bSB4
c2Rfc29ja21zZ190eXBlIHR5cGUsCiAKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIg
dHJhbnNtaXNzaW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0
LCAmY29ubi0+b3V0X2xpc3QpOworCWJkYXRhLT5vbl9vdXRfbGlzdCA9IHRy
dWU7CisJZG9tYWluX291dHN0YW5kaW5nX2luYyhjb25uKTsKIH0KIAogLyoK
QEAgLTg5Niw3ICs5NDEsOCBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAog
ICogQXMgdGhpcyBpcyBub3QgZGlyZWN0bHkgcmVsYXRlZCB0byB0aGUgY3Vy
cmVudCBjb21tYW5kLCBlcnJvcnMgY2FuJ3QgYmUKICAqIHJlcG9ydGVkLgog
ICovCi12b2lkIHNlbmRfZXZlbnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKQordm9pZCBz
ZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLAorCQljb25zdCBjaGFyICpwYXRoLCBjb25zdCBj
aGFyICp0b2tlbikKIHsKIAlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRhdGE7
CiAJdW5zaWduZWQgaW50IGxlbjsKQEAgLTkyNiw4ICs5NzIsMTMgQEAgdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBj
aGFyICpwYXRoLCBjb25zdCBjaGFyICp0b2tlbikKIAkJCWNvbm4tPnRpbWVv
dXRfbXNlYyA9IGJkYXRhLT50aW1lb3V0X21zZWM7CiAJfQogCisJYmRhdGEt
PnBlbmQucmVxID0gcmVxOworCWlmIChyZXEpCisJCXJlcS0+cGVuZC5yZWYu
ZXZlbnRfY250Kys7CisKIAkvKiBRdWV1ZSBmb3IgbGF0ZXIgdHJhbnNtaXNz
aW9uLiAqLwogCWxpc3RfYWRkX3RhaWwoJmJkYXRhLT5saXN0LCAmY29ubi0+
b3V0X2xpc3QpOworCWJkYXRhLT5vbl9vdXRfbGlzdCA9IHRydWU7CiB9CiAK
IC8qIFNvbWUgcm91dGluZXMgKHdyaXRlLCBta2RpciwgZXRjKSBqdXN0IG5l
ZWQgYSBub24tZXJyb3IgcmV0dXJuICovCkBAIC0xNzE0LDYgKzE3NjUsNyBA
QCBzdGF0aWMgdm9pZCBoYW5kbGVfaW5wdXQoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pCiAJCQlyZXR1cm47CiAJfQogCWluID0gY29ubi0+aW47CisJaW4t
PnBlbmQucmVmLmRvbWlkID0gY29ubi0+aWQ7CiAKIAkvKiBOb3QgZmluaXNo
ZWQgaGVhZGVyIHlldD8gKi8KIAlpZiAoaW4tPmluaGRyKSB7CkBAIC0xNzg3
LDYgKzE4MzksNyBAQCBzdHJ1Y3QgY29ubmVjdGlvbiAqbmV3X2Nvbm5lY3Rp
b24oY29uc3Qgc3RydWN0IGludGVyZmFjZV9mdW5jcyAqZnVuY3MpCiAJbmV3
LT5pc19zdGFsbGVkID0gZmFsc2U7CiAJbmV3LT50cmFuc2FjdGlvbl9zdGFy
dGVkID0gMDsKIAlJTklUX0xJU1RfSEVBRCgmbmV3LT5vdXRfbGlzdCk7CisJ
SU5JVF9MSVNUX0hFQUQoJm5ldy0+cmVmX2xpc3QpOwogCUlOSVRfTElTVF9I
RUFEKCZuZXctPndhdGNoZXMpOwogCUlOSVRfTElTVF9IRUFEKCZuZXctPnRy
YW5zYWN0aW9uX2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZuZXctPmRlbGF5
ZWQpOwpAQCAtMjI3MCw2ICsyMzIzLDkgQEAgc3RhdGljIHZvaWQgdXNhZ2Uo
dm9pZCkKICIgIC10LCAtLXRyYW5zYWN0aW9uIDxuYj4gIGxpbWl0IHRoZSBu
dW1iZXIgb2YgdHJhbnNhY3Rpb24gYWxsb3dlZCBwZXIgZG9tYWluLFxuIgog
IiAgLUEsIC0tcGVybS1uYiA8bmI+ICAgICAgbGltaXQgdGhlIG51bWJlciBv
ZiBwZXJtaXNzaW9ucyBwZXIgbm9kZSxcbiIKICIgIC1NLCAtLXBhdGgtbWF4
IDxjaGFycz4gIGxpbWl0IHRoZSBhbGxvd2VkIFhlbnN0b3JlIG5vZGUgcGF0
aCBsZW5ndGgsXG4iCisiICAtUSwgLS1xdW90YSA8d2hhdD49PG5iPiBzZXQg
dGhlIHF1b3RhIDx3aGF0PiB0byB0aGUgdmFsdWUgPG5iPiwgYWxsb3dlZFxu
IgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGFzIGFyZTpcbiIK
KyIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nOiBudW1i
ZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKICIgIC13LCAtLXRpbWVv
dXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGltZW91dCBpbiBzZWNv
bmRzIGZvciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAg
ICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6XG4iCiAiICAgICAg
ICAgICAgICAgICAgICAgICAgICB3YXRjaC1ldmVudDogdGltZSBhIHdhdGNo
LWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xuIgpAQCAtMjI5NSw2ICsyMzUxLDcg
QEAgc3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRy
YW5zYWN0aW9uIiwgMSwgTlVMTCwgJ3QnIH0sCiAJeyAicGVybS1uYiIsIDEs
IE5VTEwsICdBJyB9LAogCXsgInBhdGgtbWF4IiwgMSwgTlVMTCwgJ00nIH0s
CisJeyAicXVvdGEiLCAxLCBOVUxMLCAnUScgfSwKIAl7ICJ0aW1lb3V0Iiwg
MSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAwLCBOVUxMLCAn
UicgfSwKIAl7ICJpbnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJJyB9LApAQCAt
MjM0Miw2ICsyMzk5LDIwIEBAIHN0YXRpYyB2b2lkIHNldF90aW1lb3V0KGNv
bnN0IGNoYXIgKmFyZykKIAkJYmFyZigidW5rbm93biB0aW1lb3V0IFwiJXNc
IlxuIiwgYXJnKTsKIH0KIAorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNvbnN0
IGNoYXIgKmFyZykKK3sKKwljb25zdCBjaGFyICplcSA9IHN0cmNocihhcmcs
ICc9Jyk7CisJaW50IHZhbDsKKworCWlmICghZXEpCisJCWJhcmYoInF1b3Rh
cyBtdXN0IGJlIHNwZWNpZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOworCXZh
bCA9IGdldF9vcHR2YWxfaW50KGVxICsgMSk7CisJaWYgKHdoYXRfbWF0Y2hl
cyhhcmcsICJvdXRzdGFuZGluZyIpKQorCQlxdW90YV9yZXFfb3V0c3RhbmRp
bmcgPSB2YWw7CisJZWxzZQorCQliYXJmKCJ1bmtub3duIHF1b3RhIFwiJXNc
IlxuIiwgYXJnKTsKK30KKwogaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFy
Z3ZbXSkKIHsKIAlpbnQgb3B0OwpAQCAtMjM1Niw4ICsyNDI3LDggQEAgaW50
IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlvcmlnX2FyZ2MgPSBh
cmdjOwogCW9yaWdfYXJndiA9IGFyZ3Y7CiAKLQl3aGlsZSAoKG9wdCA9IGdl
dG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06VDpSVlc6
dzpVIiwgb3B0aW9ucywKLQkJCQkgIE5VTEwpKSAhPSAtMSkgeworCXdoaWxl
ICgob3B0ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0
OkE6TTpROlQ6UlZXOnc6VSIsCisJCQkJICBvcHRpb25zLCBOVUxMKSkgIT0g
LTEpIHsKIAkJc3dpdGNoIChvcHQpIHsKIAkJY2FzZSAnRCc6CiAJCQlub19k
b21haW5faW5pdCA9IHRydWU7CkBAIC0yNDA2LDYgKzI0NzcsOSBAQCBpbnQg
bWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogCQkJcXVvdGFfbWF4X3Bh
dGhfbGVuID0gbWluKFhFTlNUT1JFX1JFTF9QQVRIX01BWCwKIAkJCQkJCSBx
dW90YV9tYXhfcGF0aF9sZW4pOwogCQkJYnJlYWs7CisJCWNhc2UgJ1EnOgor
CQkJc2V0X3F1b3RhKG9wdGFyZyk7CisJCQlicmVhazsKIAkJY2FzZSAndyc6
CiAJCQlzZXRfdGltZW91dChvcHRhcmcpOwogCQkJYnJlYWs7CkBAIC0yODQ4
LDYgKzI5MjIsMTQgQEAgc3RhdGljIHZvaWQgYWRkX2J1ZmZlcmVkX2RhdGEo
c3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLAogCiAJLyogUXVldWUgZm9y
IGxhdGVyIHRyYW5zbWlzc2lvbi4gKi8KIAlsaXN0X2FkZF90YWlsKCZiZGF0
YS0+bGlzdCwgJmNvbm4tPm91dF9saXN0KTsKKwliZGF0YS0+b25fb3V0X2xp
c3QgPSB0cnVlOworCS8qCisJICogV2F0Y2ggZXZlbnRzIGFyZSBuZXZlciAi
b3V0c3RhbmRpbmciLCBidXQgdGhlIHJlcXVlc3QgY2F1c2luZyB0aGVtCisJ
ICogYXJlIGluc3RlYWQga2VwdCAib3V0c3RhbmRpbmciIHVudGlsIGFsbCB3
YXRjaCBldmVudHMgY2F1c2VkIGJ5IHRoYXQKKwkgKiByZXF1ZXN0IGhhdmUg
YmVlbiBkZWxpdmVyZWQuCisJICovCisJaWYgKGJkYXRhLT5oZHIubXNnLnR5
cGUgIT0gWFNfV0FUQ0hfRVZFTlQpCisJCWRvbWFpbl9vdXRzdGFuZGluZ19p
bmMoY29ubik7CiB9CiAKIHZvaWQgcmVhZF9zdGF0ZV9idWZmZXJlZF9kYXRh
KGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCmRp
ZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCA3NDUyNjJh
Zjk2ZmQuLmFjYjZiOWZlMmFjMyAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfY29yZS5oCkBAIC01Niw2ICs1Niw4IEBAIHN0cnVjdCB4c19zdGF0
ZV9jb25uZWN0aW9uOwogc3RydWN0IGJ1ZmZlcmVkX2RhdGEKIHsKIAlzdHJ1
Y3QgbGlzdF9oZWFkIGxpc3Q7CisJYm9vbCBvbl9vdXRfbGlzdDsKKwlib29s
IG9uX3JlZl9saXN0OwogCiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBo
ZWFkZXI/ICovCiAJYm9vbCBpbmhkcjsKQEAgLTYzLDYgKzY1LDE3IEBAIHN0
cnVjdCBidWZmZXJlZF9kYXRhCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAKKwkvKiBPdXRzdGFuZGluZyByZXF1ZXN0
IGFjY291bnRpbmcuICovCisJdW5pb24geworCQkvKiByZWYgaXMgYmVpbmcg
dXNlZCBmb3IgcmVxdWVzdHMuICovCisJCXN0cnVjdCB7CisJCQl1bnNpZ25l
ZCBpbnQgZXZlbnRfY250OyAvKiAjIG9mIG91dHN0YW5kaW5nIGV2ZW50cy4g
Ki8KKwkJCXVuc2lnbmVkIGludCBkb21pZDsgICAgIC8qIGRvbWlkIG9mIHJl
cXVlc3QuICovCisJCX0gcmVmOworCQkvKiByZXEgaXMgYmVpbmcgdXNlZCBm
b3Igd2F0Y2ggZXZlbnRzLiAqLworCQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAq
cmVxOyAgICAgIC8qIHJlcXVlc3QgY2F1c2luZyBldmVudC4gKi8KKwl9IHBl
bmQ7CisKIAl1bmlvbiB7CiAJCXN0cnVjdCB4c2Rfc29ja21zZyBtc2c7CiAJ
CWNoYXIgcmF3W3NpemVvZihzdHJ1Y3QgeHNkX3NvY2ttc2cpXTsKQEAgLTEy
Myw2ICsxMzYsOSBAQCBzdHJ1Y3QgY29ubmVjdGlvbgogCXN0cnVjdCBsaXN0
X2hlYWQgb3V0X2xpc3Q7CiAJdWludDY0X3QgdGltZW91dF9tc2VjOwogCisJ
LyogUmVmZXJlbmNlZCByZXF1ZXN0cyBubyBsb25nZXIgcGVuZGluZy4gKi8K
KwlzdHJ1Y3QgbGlzdF9oZWFkIHJlZl9saXN0OworCiAJLyogVHJhbnNhY3Rp
b24gY29udGV4dCBmb3IgY3VycmVudCByZXF1ZXN0IChOVUxMIGlmIG5vbmUp
LiAqLwogCXN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnNhY3Rpb247CiAKQEAg
LTE5MSw3ICsyMDcsOCBAQCB1bnNpZ25lZCBpbnQgZ2V0X3N0cmluZyhjb25z
dCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqZGF0YSwgdW5zaWduZWQgaW50IG9m
ZnNldCk7CiAKIHZvaWQgc2VuZF9yZXBseShzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgZW51bSB4c2Rfc29ja21zZ190eXBlIHR5cGUsCiAJCWNvbnN0IHZv
aWQgKmRhdGEsIHVuc2lnbmVkIGludCBsZW4pOwotdm9pZCBzZW5kX2V2ZW50
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCBjaGFyICpwYXRoLCBj
b25zdCBjaGFyICp0b2tlbik7Cit2b2lkIHNlbmRfZXZlbnQoc3RydWN0IGJ1
ZmZlcmVkX2RhdGEgKnJlcSwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJ
CWNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnRva2VuKTsKIAogLyog
U29tZSByb3V0aW5lcyAod3JpdGUsIG1rZGlyLCBldGMpIGp1c3QgbmVlZCBh
IG5vbi1lcnJvciByZXR1cm4gKi8KIHZvaWQgc2VuZF9hY2soc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlKTsK
QEAgLTI0NSw2ICsyNjIsNyBAQCBleHRlcm4gaW50IGRvbTBfZG9taWQ7CiBl
eHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBleHRlcm4gaW50IHByaXZfZG9taWQ7
CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5X3Blcl9kb21haW47CitleHRl
cm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGluZzsKIAogZXh0ZXJuIHVuc2ln
bmVkIGludCB0aW1lb3V0X3dhdGNoX2V2ZW50X21zZWM7CiAKZGlmZiAtLWdp
dCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYyBiL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwppbmRleCBkZTM0OWUyYTc3
YTUuLmMwYTM3NzEyZjg5YiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9kb21haW4uYwpAQCAtNzgsNiArNzgsOSBAQCBzdHJ1Y3QgZG9tYWlu
CiAJLyogbnVtYmVyIG9mIHdhdGNoIGZvciB0aGlzIGRvbWFpbiAqLwogCWlu
dCBuYndhdGNoOwogCisJLyogTnVtYmVyIG9mIG91dHN0YW5kaW5nIHJlcXVl
c3RzLiAqLworCWludCBuYm91dHN0YW5kaW5nOworCiAJLyogd3JpdGUgcmF0
ZSBsaW1pdCAqLwogCXdybF9jcmVkaXR0IHdybF9jcmVkaXQ7IC8qIFsgLXdy
bF9jb25maWdfd3JpdGVjb3N0LCArX2RidXJzdCBdICovCiAJc3RydWN0IHdy
bF90aW1lc3RhbXB0IHdybF90aW1lc3RhbXA7CkBAIC0xODMsOCArMTg2LDEy
IEBAIHN0YXRpYyBib29sIGRvbWFpbl9jYW5fcmVhZChzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubikKIHsKIAlzdHJ1Y3QgeGVuc3RvcmVfZG9tYWluX2ludGVy
ZmFjZSAqaW50ZiA9IGNvbm4tPmRvbWFpbi0+aW50ZXJmYWNlOwogCi0JaWYg
KGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYgY29ubi0+ZG9tYWlu
LT53cmxfY3JlZGl0IDwgMCkKLQkJcmV0dXJuIGZhbHNlOworCWlmIChkb21h
aW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKSB7CisJCWlmIChjb25uLT5kb21h
aW4tPndybF9jcmVkaXQgPCAwKQorCQkJcmV0dXJuIGZhbHNlOworCQlpZiAo
Y29ubi0+ZG9tYWluLT5uYm91dHN0YW5kaW5nID49IHF1b3RhX3JlcV9vdXRz
dGFuZGluZykKKwkJCXJldHVybiBmYWxzZTsKKwl9CiAKIAlyZXR1cm4gKGlu
dGYtPnJlcV9jb25zICE9IGludGYtPnJlcV9wcm9kKTsKIH0KQEAgLTMzMSw3
ICszMzgsNyBAQCBzdGF0aWMgc3RydWN0IGRvbWFpbiAqYWxsb2NfZG9tYWlu
KGNvbnN0IHZvaWQgKmNvbnRleHQsIHVuc2lnbmVkIGludCBkb21pZCkKIHsK
IAlzdHJ1Y3QgZG9tYWluICpkb21haW47CiAKLQlkb21haW4gPSB0YWxsb2Mo
Y29udGV4dCwgc3RydWN0IGRvbWFpbik7CisJZG9tYWluID0gdGFsbG9jX3pl
cm8oY29udGV4dCwgc3RydWN0IGRvbWFpbik7CiAJaWYgKCFkb21haW4pIHsK
IAkJZXJybm8gPSBFTk9NRU07CiAJCXJldHVybiBOVUxMOwpAQCAtMzkyLDkg
KzM5OSw2IEBAIHN0YXRpYyBpbnQgbmV3X2RvbWFpbihzdHJ1Y3QgZG9tYWlu
ICpkb21haW4sIGludCBwb3J0LCBib29sIHJlc3RvcmUpCiAJZG9tYWluLT5j
b25uLT5kb21haW4gPSBkb21haW47CiAJZG9tYWluLT5jb25uLT5pZCA9IGRv
bWFpbi0+ZG9taWQ7CiAKLQlkb21haW4tPm5iZW50cnkgPSAwOwotCWRvbWFp
bi0+bmJ3YXRjaCA9IDA7Ci0KIAlyZXR1cm4gMDsKIH0KIApAQCAtOTcwLDYg
Kzk3NCwyOCBAQCBpbnQgZG9tYWluX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uKQogCQk6IDA7CiB9CiAKK3ZvaWQgZG9tYWluX291dHN0YW5kaW5n
X2luYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKK3sKKwlpZiAoIWNvbm4g
fHwgIWNvbm4tPmRvbWFpbikKKwkJcmV0dXJuOworCWNvbm4tPmRvbWFpbi0+
bmJvdXRzdGFuZGluZysrOworfQorCit2b2lkIGRvbWFpbl9vdXRzdGFuZGlu
Z19kZWMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCit7CisJaWYgKCFjb25u
IHx8ICFjb25uLT5kb21haW4pCisJCXJldHVybjsKKwljb25uLT5kb21haW4t
Pm5ib3V0c3RhbmRpbmctLTsKK30KKwordm9pZCBkb21haW5fb3V0c3RhbmRp
bmdfZG9taWRfZGVjKHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1Y3Qg
ZG9tYWluICpkID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9taWQpOworCisJ
aWYgKGQpCisJCWQtPm5ib3V0c3RhbmRpbmctLTsKK30KKwogc3RhdGljIHdy
bF9jcmVkaXR0IHdybF9jb25maWdfd3JpdGVjb3N0ICAgICAgPSBXUkxfRkFD
VE9SOwogc3RhdGljIHdybF9jcmVkaXR0IHdybF9jb25maWdfcmF0ZSAgICAg
ICAgICAgPSBXUkxfUkFURSAgICogV1JMX0ZBQ1RPUjsKIHN0YXRpYyB3cmxf
Y3JlZGl0dCB3cmxfY29uZmlnX2RidXJzdCAgICAgICAgID0gV1JMX0RCVVJT
VCAqIFdSTF9GQUNUT1I7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
ZG9tYWluLmgKaW5kZXggNGEzN2RlNjdhMDllLi42MTdkMGFjZmQ3NWIgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAor
KysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKQEAgLTY1
LDYgKzY1LDkgQEAgaW50IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubik7CiB2b2lkIGRvbWFpbl93YXRjaF9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4pOwogdm9pZCBkb21haW5fd2F0Y2hfZGVjKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4pOwordm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5j
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKK3ZvaWQgZG9tYWluX291dHN0
YW5kaW5nX2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7Cit2b2lkIGRv
bWFpbl9vdXRzdGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlk
KTsKIAogLyogU3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICov
CiBpbnQgc2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNv
bm4sIGNvbnN0IGNoYXIgKm5hbWUsCmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfd2F0Y2guYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF93YXRjaC5jCmluZGV4IDIwNWQ5ZDhlYTExNi4uMDc1NWZmYTM3NWJh
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2gu
YworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwpAQCAt
MTQyLDYgKzE0Miw3IEBAIHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5h
bWUsCiAJCSAgc3RydWN0IG5vZGUgKm5vZGUsIGJvb2wgZXhhY3QsIHN0cnVj
dCBub2RlX3Blcm1zICpwZXJtcykKIHsKIAlzdHJ1Y3QgY29ubmVjdGlvbiAq
aTsKKwlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxOwogCXN0cnVjdCB3YXRj
aCAqd2F0Y2g7CiAKIAkvKiBEdXJpbmcgdHJhbnNhY3Rpb25zLCBkb24ndCBm
aXJlIHdhdGNoZXMsIGJ1dCBxdWV1ZSB0aGVtLiAqLwpAQCAtMTUwLDYgKzE1
MSw4IEBAIHZvaWQgZmlyZV93YXRjaGVzKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsCiAJCXJl
dHVybjsKIAl9CiAKKwlyZXEgPSBkb21haW5faXNfdW5wcml2aWxlZ2VkKGNv
bm4pID8gY29ubi0+aW4gOiBOVUxMOworCiAJLyogQ3JlYXRlIGFuIGV2ZW50
IGZvciBlYWNoIHdhdGNoLiAqLwogCWxpc3RfZm9yX2VhY2hfZW50cnkoaSwg
JmNvbm5lY3Rpb25zLCBsaXN0KSB7CiAJCS8qIGludHJvZHVjZS9yZWxlYXNl
IGRvbWFpbiB3YXRjaGVzICovCkBAIC0xNjQsMTIgKzE2NywxMiBAQCB2b2lk
IGZpcmVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
dm9pZCAqY3R4LCBjb25zdCBjaGFyICpuYW1lLAogCQlsaXN0X2Zvcl9lYWNo
X2VudHJ5KHdhdGNoLCAmaS0+d2F0Y2hlcywgbGlzdCkgewogCQkJaWYgKGV4
YWN0KSB7CiAJCQkJaWYgKHN0cmVxKG5hbWUsIHdhdGNoLT5ub2RlKSkKLQkJ
CQkJc2VuZF9ldmVudChpLAorCQkJCQlzZW5kX2V2ZW50KHJlcSwgaSwKIAkJ
CQkJCSAgIGdldF93YXRjaF9wYXRoKHdhdGNoLCBuYW1lKSwKIAkJCQkJCSAg
IHdhdGNoLT50b2tlbik7CiAJCQl9IGVsc2UgewogCQkJCWlmIChpc19jaGls
ZChuYW1lLCB3YXRjaC0+bm9kZSkpCi0JCQkJCXNlbmRfZXZlbnQoaSwKKwkJ
CQkJc2VuZF9ldmVudChyZXEsIGksCiAJCQkJCQkgICBnZXRfd2F0Y2hfcGF0
aCh3YXRjaCwgbmFtZSksCiAJCQkJCQkgICB3YXRjaC0+dG9rZW4pOwogCQkJ
fQpAQCAtMjY5LDggKzI3MiwxMiBAQCBpbnQgZG9fd2F0Y2goc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9kYXRhICppbikKIAl0
cmFjZV9jcmVhdGUod2F0Y2gsICJ3YXRjaCIpOwogCXNlbmRfYWNrKGNvbm4s
IFhTX1dBVENIKTsKIAotCS8qIFdlIGZpcmUgb25jZSB1cCBmcm9udDogc2lt
cGxpZmllcyBjbGllbnRzIGFuZCByZXN0YXJ0LiAqLwotCXNlbmRfZXZlbnQo
Y29ubiwgZ2V0X3dhdGNoX3BhdGgod2F0Y2gsIHdhdGNoLT5ub2RlKSwgd2F0
Y2gtPnRva2VuKTsKKwkvKgorCSAqIFdlIGZpcmUgb25jZSB1cCBmcm9udDog
c2ltcGxpZmllcyBjbGllbnRzIGFuZCByZXN0YXJ0LgorCSAqIFRoaXMgZXZl
bnQgd2lsbCBub3QgYmUgbGlua2VkIHRvIHRoZSBYU19XQVRDSCByZXF1ZXN0
LgorCSAqLworCXNlbmRfZXZlbnQoTlVMTCwgY29ubiwgZ2V0X3dhdGNoX3Bh
dGgod2F0Y2gsIHdhdGNoLT5ub2RlKSwKKwkJICAgd2F0Y2gtPnRva2VuKTsK
IAogCXJldHVybiAwOwogfQo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-06.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-06.patch"
Content-Transfer-Encoding: base64

RnJvbSA3YzgyYzE5NWUwYjk3YmU0YzA3NzI4YmE3NDFiZWI1NGFmYmVlMWI3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGRvbid0IGJ1
ZmZlciBtdWx0aXBsZSBpZGVudGljYWwgd2F0Y2ggZXZlbnRzCgpBIGd1ZXN0
IG5vdCByZWFkaW5nIGl0cyBYZW5zdG9yZSByZXNwb25zZSBidWZmZXIgZmFz
dCBlbm91Z2ggbWlnaHQKcGlsZSB1cCBsb3RzIG9mIFhlbnN0b3JlIHdhdGNo
IGV2ZW50cyBidWZmZXJlZC4gUmVkdWNlIHRoZSBnZW5lcmF0ZWQKbG9hZCBi
eSBkcm9wcGluZyBuZXcgZXZlbnRzIHdoaWNoIGFscmVhZHkgaGF2ZSBhbiBp
ZGVudGljYWwgY29weQpwZW5kaW5nLgoKVGhlIHNwZWNpYWwgZXZlbnRzICJA
Li4uIiBhcmUgZXhjbHVkZWQgZnJvbSB0aGF0IGhhbmRsaW5nIGFzIHRoZXJl
IGFyZQprbm93biB1c2UgY2FzZXMgd2hlcmUgdGhlIGhhbmRsZXIgaXMgcmVs
eWluZyBvbiBlYWNoIGV2ZW50IHRvIGJlIHNlbnQKaW5kaXZpZHVhbGx5LgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCA1NGU2YWRkMWExNTcuLjQ1ZmVh
ZTMxM2FlNiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CkBAIC05MTIsNiArOTEyLDcgQEAgdm9pZCBzZW5kX3JlcGx5KHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBlbnVtIHhzZF9zb2NrbXNnX3R5cGUgdHlwZSwK
IAliZGF0YS0+aW5oZHIgPSB0cnVlOwogCWJkYXRhLT51c2VkID0gMDsKIAli
ZGF0YS0+dGltZW91dF9tc2VjID0gMDsKKwliZGF0YS0+d2F0Y2hfZXZlbnQg
PSBmYWxzZTsKIAogCWlmIChsZW4gPD0gREVGQVVMVF9CVUZGRVJfU0laRSkK
IAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZhdWx0X2J1ZmZlcjsKQEAg
LTk0NCw3ICs5NDUsNyBAQCB2b2lkIHNlbmRfcmVwbHkoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGVudW0geHNkX3NvY2ttc2dfdHlwZSB0eXBlLAogdm9p
ZCBzZW5kX2V2ZW50KHN0cnVjdCBidWZmZXJlZF9kYXRhICpyZXEsIHN0cnVj
dCBjb25uZWN0aW9uICpjb25uLAogCQljb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp0b2tlbikKIHsKLQlzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqYmRh
dGE7CisJc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLCAqYmQ7CiAJdW5z
aWduZWQgaW50IGxlbjsKIAogCWxlbiA9IHN0cmxlbihwYXRoKSArIDEgKyBz
dHJsZW4odG9rZW4pICsgMTsKQEAgLTk2NiwxMiArOTY3LDI5IEBAIHZvaWQg
c2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKIAliZGF0YS0+aGRyLm1zZy50eXBlID0gWFNf
V0FUQ0hfRVZFTlQ7CiAJYmRhdGEtPmhkci5tc2cubGVuID0gbGVuOwogCisJ
LyoKKwkgKiBDaGVjayB3aGV0aGVyIGFuIGlkZW50aWNhbCBldmVudCBpcyBw
ZW5kaW5nIGFscmVhZHkuCisJICogU3BlY2lhbCBldmVudHMgYXJlIGV4Y2x1
ZGVkIGZyb20gdGhhdCBjaGVjay4KKwkgKi8KKwlpZiAocGF0aFswXSAhPSAn
QCcpIHsKKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShiZCwgJmNvbm4tPm91dF9s
aXN0LCBsaXN0KSB7CisJCQlpZiAoYmQtPndhdGNoX2V2ZW50ICYmIGJkLT5o
ZHIubXNnLmxlbiA9PSBsZW4gJiYKKwkJCSAgICAhbWVtY21wKGJkYXRhLT5i
dWZmZXIsIGJkLT5idWZmZXIsIGxlbikpIHsKKwkJCQl0cmFjZSgiZHJvcHBp
bmcgZHVwbGljYXRlIHdhdGNoICVzICVzIGZvciBkb21haW4gJXVcbiIsCisJ
CQkJICAgICAgcGF0aCwgdG9rZW4sIGNvbm4tPmlkKTsKKwkJCQl0YWxsb2Nf
ZnJlZShiZGF0YSk7CisJCQkJcmV0dXJuOworCQkJfQorCQl9CisJfQorCiAJ
aWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5faXNfdW5w
cml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21zZWMgPSBn
ZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIAkJ
aWYgKCFjb25uLT50aW1lb3V0X21zZWMpCiAJCQljb25uLT50aW1lb3V0X21z
ZWMgPSBiZGF0YS0+dGltZW91dF9tc2VjOwogCX0KIAorCWJkYXRhLT53YXRj
aF9ldmVudCA9IHRydWU7CiAJYmRhdGEtPnBlbmQucmVxID0gcmVxOwogCWlm
IChyZXEpCiAJCXJlcS0+cGVuZC5yZWYuZXZlbnRfY250Kys7CmRpZmYgLS1n
aXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBhY2I2YjlmZTJhYzMu
LmUxZDQ3Zjg4NDQ1ZiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5oCkBAIC02Miw2ICs2Miw5IEBAIHN0cnVjdCBidWZmZXJlZF9kYXRh
CiAJLyogQXJlIHdlIHN0aWxsIGRvaW5nIHRoZSBoZWFkZXI/ICovCiAJYm9v
bCBpbmhkcjsKIAorCS8qIElzIHRoaXMgYSB3YXRjaCBldmVudD8gKi8KKwli
b29sIHdhdGNoX2V2ZW50OworCiAJLyogSG93IGZhciBhcmUgd2U/ICovCiAJ
dW5zaWduZWQgaW50IHVzZWQ7CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-07.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-07.patch"
Content-Transfer-Encoding: base64

RnJvbSA1MjU1M2I2NWY0ODM4ZTJkN2RkY2Y2OWRlN2I0ZjkwZjI4YzRjNGNh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGZpeCBjb25u
ZWN0aW9uLT5pZCB1c2FnZQoKRG9uJ3QgdXNlIGNvbm4tPmlkIGZvciBwcml2
aWxlZ2UgY2hlY2tzLCBidXQgZG9tYWluX2lzX3VucHJpdmlsZWdlZCgpLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYuCgpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVl
cmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVs
aWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJvbC5jIGIvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvbnRyb2wuYwppbmRleCBmMGUwMGRiNjMzZWMu
LjYxYmNiYzA2OWQ3NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvbnRyb2wuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCkBAIC04NzgsNyArODc4LDcgQEAgaW50IGRvX2NvbnRy
b2woc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJlZF9k
YXRhICppbikKIAl1bnNpZ25lZCBpbnQgY21kLCBudW0sIG9mZjsKIAljaGFy
ICoqdmVjID0gTlVMTDsKIAotCWlmIChjb25uLT5pZCAhPSAwKQorCWlmIChk
b21haW5faXNfdW5wcml2aWxlZ2VkKGNvbm4pKQogCQlyZXR1cm4gRUFDQ0VT
OwogCiAJb2ZmID0gZ2V0X3N0cmluZyhpbiwgMCk7CmRpZmYgLS1naXQgYS90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaAppbmRleCBlMWQ0N2Y4ODQ0NWYuLmFhMGRl
ZGRlNjQ0YiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X2NvcmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5o
CkBAIC0xMjMsNyArMTIzLDcgQEAgc3RydWN0IGNvbm5lY3Rpb24KIAkvKiBU
aGUgaW5kZXggb2YgcG9sbGZkIGluIGdsb2JhbCBwb2xsZmQgYXJyYXkgKi8K
IAlpbnQgcG9sbGZkX2lkeDsKIAotCS8qIFdobyBhbSBJPyAwIGZvciBzb2Nr
ZXQgY29ubmVjdGlvbnMuICovCisJLyogV2hvIGFtIEk/IERvbWlkIG9mIGNv
bm5lY3Rpb24uICovCiAJdW5zaWduZWQgaW50IGlkOwogCiAJLyogSXMgdGhp
cyBjb25uZWN0aW9uIGlnbm9yZWQ/ICovCmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IDU0NDMyOTA3ZmM3
Ni4uZWUxYjA5MDMxYTNiIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNDc3LDcgKzQ3Nyw4IEBAIGlu
dCBkb190cmFuc2FjdGlvbl9zdGFydChzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgc3RydWN0IGJ1ZmZlcmVkX2RhdGEgKmluKQogCWlmIChjb25uLT50cmFu
c2FjdGlvbikKIAkJcmV0dXJuIEVCVVNZOwogCi0JaWYgKGNvbm4tPmlkICYm
IGNvbm4tPnRyYW5zYWN0aW9uX3N0YXJ0ZWQgPiBxdW90YV9tYXhfdHJhbnNh
Y3Rpb24pCisJaWYgKGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikgJiYK
KwkgICAgY29ubi0+dHJhbnNhY3Rpb25fc3RhcnRlZCA+IHF1b3RhX21heF90
cmFuc2FjdGlvbikKIAkJcmV0dXJuIEVOT1NQQzsKIAogCS8qIEF0dGFjaCB0
cmFuc2FjdGlvbiB0byBpbnB1dCBmb3IgYXV0b2ZyZWUgdW50aWwgaXQncyBj
b21wbGV0ZSAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-08.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-08.patch"
Content-Transfer-Encoding: base64

RnJvbSA1YWQzNjViOWMyYThmMWExYzM1NjAwMGVlMTlkZjVkY2IyY2U1Yzg3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDggKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHNpbXBsaWZ5
IGFuZCBmaXggcGVyIGRvbWFpbiBub2RlIGFjY291bnRpbmcKClRoZSBhY2Nv
dW50aW5nIG9mIG5vZGVzIGNhbiBiZSBzaW1wbGlmaWVkIG5vdyB0aGF0IGVh
Y2ggY29ubmVjdGlvbgpob2xkcyB0aGUgYXNzb2NpYXRlZCBkb21pZC4KCkZp
eCB0aGUgbm9kZSBhY2NvdW50aW5nIHRvIGNvdmVyIG5vZGVzIGNyZWF0ZWQg
Zm9yIGEgZG9tYWluIGJlZm9yZSBpdApoYXMgYmVlbiBpbnRyb2R1Y2VkLiBU
aGlzIHJlcXVpcmVzIHRvIHJlYWN0IHByb3Blcmx5IHRvIGFuIGFsbG9jYXRp
b24KZmFpbHVyZSBpbnNpZGUgZG9tYWluX2VudHJ5X2luYygpIGJ5IHJldHVy
bmluZyBhbiBlcnJvciBjb2RlLgoKRXNwZWNpYWxseSBpbiBlcnJvciBwYXRo
cyB0aGUgbm9kZSBhY2NvdW50aW5nIGhhcyB0byBiZSBmaXhlZCBpbiBzb21l
CmNhc2VzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYgLyBDVkUtMjAyMi00
MjMxMy4KClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6
b24uY29tPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBh
bWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
CmluZGV4IDQ1ZmVhZTMxM2FlNi4uMGE2ODQ0NTBiY2E2IDEwMDY0NAotLS0g
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisrKyBiL3Rvb2xz
L3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTYzNCw3ICs2MzQsNyBA
QCBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLCBjb25zdCB2b2lkICpjdHgsCiAKIAkvKiBQZXJtaXNzaW9ucyBhcmUg
c3RydWN0IHhzX3Blcm1pc3Npb25zLiAqLwogCW5vZGUtPnBlcm1zLnAgPSBo
ZHItPnBlcm1zOwotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMobm9k
ZSkpIHsKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKSB7CiAJCXRhbGxvY19mcmVlKG5vZGUpOwogCQlyZXR1cm4gTlVMTDsK
IAl9CkBAIC02NTYsNyArNjU2LDcgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qg
bm9kZSAqbm9kZSwKIAl2b2lkICpwOwogCXN0cnVjdCB4c190ZGJfcmVjb3Jk
X2hkciAqaGRyOwogCi0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKQogCQlyZXR1cm4gZXJybm87CiAKIAlkYXRhLmRzaXplID0gc2l6ZW9m
KCpoZHIpCkBAIC0xMjY4LDEzICsxMjY4LDE3IEBAIHN0YXRpYyBzdHJ1Y3Qg
bm9kZSAqY29uc3RydWN0X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
IGNvbnN0IHZvaWQgKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGlj
IGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlKQorc3RhdGljIHZvaWQgZGVzdHJveV9ub2RlX3Jt
KHN0cnVjdCBub2RlICpub2RlKQogewogCWlmIChzdHJlcShub2RlLT5uYW1l
LCAiLyIpKQogCQljb3JydXB0KE5VTEwsICJEZXN0cm95aW5nIHJvb3Qgbm9k
ZSEiKTsKIAogCXRkYl9kZWxldGUodGRiX2N0eCwgbm9kZS0+a2V5KTsKK30K
IAorc3RhdGljIGludCBkZXN0cm95X25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoreworCWRlc3Ryb3lfbm9kZV9y
bShub2RlKTsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwogCiAJ
LyoKQEAgLTEzMjQsOCArMTMyOCwxMiBAQCBzdGF0aWMgc3RydWN0IG5vZGUg
KmNyZWF0ZV9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2
b2lkICpjdHgsCiAJCQlnb3RvIGVycjsKIAogCQkvKiBBY2NvdW50IGZvciBu
ZXcgbm9kZSAqLwotCQlpZiAoaS0+cGFyZW50KQotCQkJZG9tYWluX2VudHJ5
X2luYyhjb25uLCBpKTsKKwkJaWYgKGktPnBhcmVudCkgeworCQkJaWYgKGRv
bWFpbl9lbnRyeV9pbmMoY29ubiwgaSkpIHsKKwkJCQlkZXN0cm95X25vZGVf
cm0oaSk7CisJCQkJcmV0dXJuIE5VTEw7CisJCQl9CisJCX0KIAl9CiAKIAly
ZXR1cm4gbm9kZTsKQEAgLTE2MTAsMTAgKzE2MTgsMjcgQEAgc3RhdGljIGlu
dCBkb19zZXRfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVj
dCBidWZmZXJlZF9kYXRhICppbikKIAlvbGRfcGVybXMgPSBub2RlLT5wZXJt
czsKIAlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOwogCW5vZGUtPnBl
cm1zID0gcGVybXM7Ci0JZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKTsK
KwlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKSkgeworCQlub2Rl
LT5wZXJtcyA9IG9sZF9wZXJtczsKKwkJLyoKKwkJICogVGhpcyBzaG91bGQg
bmV2ZXIgZmFpbCBiZWNhdXNlIHdlIGhhZCBhIHJlZmVyZW5jZSBvbiB0aGUK
KwkJICogZG9tYWluIGJlZm9yZSBhbmQgWGVuc3RvcmVkIGlzIHNpbmdsZS10
aHJlYWRlZC4KKwkJICovCisJCWRvbWFpbl9lbnRyeV9pbmMoY29ubiwgbm9k
ZSk7CisJCXJldHVybiBFTk9NRU07CisJfQorCisJaWYgKHdyaXRlX25vZGUo
Y29ubiwgbm9kZSwgZmFsc2UpKSB7CisJCWludCBzYXZlZF9lcnJubyA9IGVy
cm5vOwogCi0JaWYgKHdyaXRlX25vZGUoY29ubiwgbm9kZSwgZmFsc2UpKQor
CQlkb21haW5fZW50cnlfZGVjKGNvbm4sIG5vZGUpOworCQlub2RlLT5wZXJt
cyA9IG9sZF9wZXJtczsKKwkJLyogTm8gZmFpbHVyZSBwb3NzaWJsZSBhcyBh
Ym92ZS4gKi8KKwkJZG9tYWluX2VudHJ5X2luYyhjb25uLCBub2RlKTsKKwor
CQllcnJubyA9IHNhdmVkX2Vycm5vOwogCQlyZXR1cm4gZXJybm87CisJfQog
CiAJZmlyZV93YXRjaGVzKGNvbm4sIGluLCBuYW1lLCBub2RlLCBmYWxzZSwg
Jm9sZF9wZXJtcyk7CiAJc2VuZF9hY2soY29ubiwgWFNfU0VUX1BFUk1TKTsK
QEAgLTMwOTUsNyArMzEyMCw5IEBAIHZvaWQgcmVhZF9zdGF0ZV9ub2RlKGNv
bnN0IHZvaWQgKmN0eCwgY29uc3Qgdm9pZCAqc3RhdGUpCiAJc2V0X3RkYl9r
ZXkobmFtZSwgJmtleSk7CiAJaWYgKHdyaXRlX25vZGVfcmF3KE5VTEwsICZr
ZXksIG5vZGUsIHRydWUpKQogCQliYXJmKCJ3cml0ZSBub2RlIGVycm9yIHJl
c3RvcmluZyBub2RlIik7Ci0JZG9tYWluX2VudHJ5X2luYygmY29ubiwgbm9k
ZSk7CisKKwlpZiAoZG9tYWluX2VudHJ5X2luYygmY29ubiwgbm9kZSkpCisJ
CWJhcmYoIm5vZGUgYWNjb3VudGluZyBlcnJvciByZXN0b3Jpbmcgbm9kZSIp
OwogCiAJdGFsbG9jX2ZyZWUobm9kZSk7CiB9CmRpZmYgLS1naXQgYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKaW5kZXggYzBhMzc3MTJmODliLi40NGNl
MjY3ZWM1NTcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9kb21haW4uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMKQEAgLTE2LDYgKzE2LDcgQEAKICAgICBhbG9uZyB3aXRoIHRoaXMg
cHJvZ3JhbTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNl
bnNlcy8+LgogKi8KIAorI2luY2x1ZGUgPGFzc2VydC5oPgogI2luY2x1ZGUg
PHN0ZGlvLmg+CiAjaW5jbHVkZSA8c3lzL21tYW4uaD4KICNpbmNsdWRlIDx1
bmlzdGQuaD4KQEAgLTM2Myw2ICszNjQsMTggQEAgc3RhdGljIHN0cnVjdCBk
b21haW4gKmZpbmRfb3JfYWxsb2NfZG9tYWluKGNvbnN0IHZvaWQgKmN0eCwg
dW5zaWduZWQgaW50IGRvbWlkKQogCXJldHVybiBkb21haW4gPyA6IGFsbG9j
X2RvbWFpbihjdHgsIGRvbWlkKTsKIH0KIAorc3RhdGljIHN0cnVjdCBkb21h
aW4gKmZpbmRfb3JfYWxsb2NfZXhpc3RpbmdfZG9tYWluKHVuc2lnbmVkIGlu
dCBkb21pZCkKK3sKKwlzdHJ1Y3QgZG9tYWluICpkb21haW47CisJeGNfZG9t
aW5mb190IGRvbWluZm87CisKKwlkb21haW4gPSBmaW5kX2RvbWFpbl9zdHJ1
Y3QoZG9taWQpOworCWlmICghZG9tYWluICYmIGdldF9kb21haW5faW5mbyhk
b21pZCwgJmRvbWluZm8pKQorCQlkb21haW4gPSBhbGxvY19kb21haW4oTlVM
TCwgZG9taWQpOworCisJcmV0dXJuIGRvbWFpbjsKK30KKwogc3RhdGljIGlu
dCBuZXdfZG9tYWluKHN0cnVjdCBkb21haW4gKmRvbWFpbiwgaW50IHBvcnQs
IGJvb2wgcmVzdG9yZSkKIHsKIAlpbnQgcmM7CkBAIC04MTQsMzAgKzgyNywy
OCBAQCB2b2lkIGRvbWFpbl9kZWluaXQodm9pZCkKIAkJeGVuZXZ0Y2huX3Vu
YmluZCh4Y2VfaGFuZGxlLCB2aXJxX3BvcnQpOwogfQogCi12b2lkIGRvbWFp
bl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKQoraW50IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogewogCXN0cnVjdCBk
b21haW4gKmQ7CisJdW5zaWduZWQgaW50IGRvbWlkOwogCiAJaWYgKCFjb25u
KQotCQlyZXR1cm47CisJCXJldHVybiAwOwogCi0JaWYgKG5vZGUtPnBlcm1z
LnAgJiYgbm9kZS0+cGVybXMucFswXS5pZCAhPSBjb25uLT5pZCkgewotCQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKLQkJCXRyYW5zYWN0aW9uX2VudHJ5
X2luYyhjb25uLT50cmFuc2FjdGlvbiwKLQkJCQlub2RlLT5wZXJtcy5wWzBd
LmlkKTsKLQkJfSBlbHNlIHsKLQkJCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21p
ZChub2RlLT5wZXJtcy5wWzBdLmlkKTsKLQkJCWlmIChkKQotCQkJCWQtPm5i
ZW50cnkrKzsKLQkJfQotCX0gZWxzZSBpZiAoY29ubi0+ZG9tYWluKSB7Ci0J
CWlmIChjb25uLT50cmFuc2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50
cnlfaW5jKGNvbm4tPnRyYW5zYWN0aW9uLAotCQkJCWNvbm4tPmRvbWFpbi0+
ZG9taWQpOwotIAkJfSBlbHNlIHsKLSAJCQljb25uLT5kb21haW4tPm5iZW50
cnkrKzsKLQkJfQorCWRvbWlkID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBl
cm1zLnBbMF0uaWQgOiBjb25uLT5pZDsKKworCWlmIChjb25uLT50cmFuc2Fj
dGlvbikgeworCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29ubi0+dHJhbnNh
Y3Rpb24sIGRvbWlkKTsKKwl9IGVsc2UgeworCQlkID0gKGRvbWlkID09IGNv
bm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4KKwkJICAg
IDogZmluZF9vcl9hbGxvY19leGlzdGluZ19kb21haW4oZG9taWQpOworCQlp
ZiAoZCkKKwkJCWQtPm5iZW50cnkrKzsKKwkJZWxzZQorCQkJcmV0dXJuIEVO
T01FTTsKIAl9CisKKwlyZXR1cm4gMDsKIH0KIAogLyoKQEAgLTg3Myw3ICs4
ODQsNyBAQCBzdGF0aWMgaW50IGNoa19kb21haW5fZ2VuZXJhdGlvbih1bnNp
Z25lZCBpbnQgZG9taWQsIHVpbnQ2NF90IGdlbikKICAqIFJlbW92ZSBwZXJt
aXNzaW9ucyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5nIGRvbWFpbnMgaW4gb3Jk
ZXIgdG8gYXZvaWQgYSBuZXcKICAqIGRvbWFpbiB3aXRoIHRoZSBzYW1lIGRv
bWlkIGluaGVyaXRpbmcgdGhlIHBlcm1pc3Npb25zLgogICovCi1pbnQgZG9t
YWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVjdCBub2RlICpub2RlKQoraW50
IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJdW5zaWduZWQgaW50IGk7
CiAJaW50IHJldDsKQEAgLTg4Myw4ICs4OTQsMTQgQEAgaW50IGRvbWFpbl9h
ZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qgbm9kZSAqbm9kZSkKIAkJcmV0dXJu
IGVycm5vOwogCiAJLyogSWYgdGhlIG93bmVyIGRvZXNuJ3QgZXhpc3QgYW55
IGxvbmdlciBnaXZlIGl0IHRvIHByaXYgZG9tYWluLiAqLwotCWlmICghcmV0
KQorCWlmICghcmV0KSB7CisJCS8qCisJCSAqIEluIHRoZW9yeSB3ZSdkIG5l
ZWQgdG8gdXBkYXRlIHRoZSBudW1iZXIgb2YgZG9tMCBub2RlcyBoZXJlLAor
CQkgKiBidXQgd2UgY291bGQgYmUgY2FsbGVkIGZvciBhIHJlYWQgb2YgdGhl
IG5vZGUuIFNvIGJldHRlcgorCQkgKiBhdm9pZCB0aGUgcmlzayB0byBvdmVy
ZmxvdyB0aGUgbm9kZSBjb3VudCBvZiBkb20wLgorCQkgKi8KIAkJbm9kZS0+
cGVybXMucFswXS5pZCA9IHByaXZfZG9taWQ7CisJfQogCiAJZm9yIChpID0g
MTsgaSA8IG5vZGUtPnBlcm1zLm51bTsgaSsrKSB7CiAJCWlmIChub2RlLT5w
ZXJtcy5wW2ldLnBlcm1zICYgWFNfUEVSTV9JR05PUkUpCkBAIC05MDMsMjUg
KzkyMCwyNSBAQCBpbnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVj
dCBub2RlICpub2RlKQogdm9pZCBkb21haW5fZW50cnlfZGVjKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKIAlzdHJ1
Y3QgZG9tYWluICpkOworCXVuc2lnbmVkIGludCBkb21pZDsKIAogCWlmICgh
Y29ubikKIAkJcmV0dXJuOwogCi0JaWYgKG5vZGUtPnBlcm1zLnAgJiYgbm9k
ZS0+cGVybXMucFswXS5pZCAhPSBjb25uLT5pZCkgewotCQlpZiAoY29ubi0+
dHJhbnNhY3Rpb24pIHsKLQkJCXRyYW5zYWN0aW9uX2VudHJ5X2RlYyhjb25u
LT50cmFuc2FjdGlvbiwKLQkJCQlub2RlLT5wZXJtcy5wWzBdLmlkKTsKLQkJ
fSBlbHNlIHsKLQkJCWQgPSBmaW5kX2RvbWFpbl9ieV9kb21pZChub2RlLT5w
ZXJtcy5wWzBdLmlkKTsKLQkJCWlmIChkICYmIGQtPm5iZW50cnkpCi0JCQkJ
ZC0+bmJlbnRyeS0tOwotCQl9Ci0JfSBlbHNlIGlmIChjb25uLT5kb21haW4g
JiYgY29ubi0+ZG9tYWluLT5uYmVudHJ5KSB7Ci0JCWlmIChjb25uLT50cmFu
c2FjdGlvbikgewotCQkJdHJhbnNhY3Rpb25fZW50cnlfZGVjKGNvbm4tPnRy
YW5zYWN0aW9uLAotCQkJCWNvbm4tPmRvbWFpbi0+ZG9taWQpOworCWRvbWlk
ID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBlcm1zLnBbMF0uaWQgOiBjb25u
LT5pZDsKKworCWlmIChjb25uLT50cmFuc2FjdGlvbikgeworCQl0cmFuc2Fj
dGlvbl9lbnRyeV9kZWMoY29ubi0+dHJhbnNhY3Rpb24sIGRvbWlkKTsKKwl9
IGVsc2UgeworCQlkID0gKGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KKwkJICAgIDogZmluZF9kb21haW5fc3Ry
dWN0KGRvbWlkKTsKKwkJaWYgKGQpIHsKKwkJCWQtPm5iZW50cnktLTsKIAkJ
fSBlbHNlIHsKLQkJCWNvbm4tPmRvbWFpbi0+bmJlbnRyeS0tOworCQkJZXJy
bm8gPSBFTk9FTlQ7CisJCQljb3JydXB0KGNvbm4sCisJCQkJIk5vZGUgXCIl
c1wiIG93bmVkIGJ5IG5vbi1leGlzdGluZyBkb21haW4gJXVcbiIsCisJCQkJ
bm9kZS0+bmFtZSwgZG9taWQpOwogCQl9CiAJfQogfQpAQCAtOTMxLDEzICs5
NDgsMjMgQEAgaW50IGRvbWFpbl9lbnRyeV9maXgodW5zaWduZWQgaW50IGRv
bWlkLCBpbnQgbnVtLCBib29sIHVwZGF0ZSkKIAlzdHJ1Y3QgZG9tYWluICpk
OwogCWludCBjbnQ7CiAKLQlkID0gZmluZF9kb21haW5fYnlfZG9taWQoZG9t
aWQpOwotCWlmICghZCkKLQkJcmV0dXJuIDA7CisJaWYgKHVwZGF0ZSkgewor
CQlkID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwkJYXNzZXJ0KGQp
OworCX0gZWxzZSB7CisJCS8qCisJCSAqIFdlIGFyZSBjYWxsZWQgZmlyc3Qg
d2l0aCB1cGRhdGUgPT0gZmFsc2UgaW4gb3JkZXIgdG8gY2F0Y2gKKwkJICog
YW55IGVycm9yLiBTbyBkbyBhIHBvc3NpYmxlIGFsbG9jYXRpb24gYW5kIGNo
ZWNrIGZvciBlcnJvcgorCQkgKiBvbmx5IGluIHRoaXMgY2FzZSwgYXMgaW4g
dGhlIGNhc2Ugb2YgdXBkYXRlID09IHRydWUgbm90aGluZworCQkgKiBjYW4g
Z28gd3JvbmcgYW55bW9yZSBhcyB0aGUgYWxsb2NhdGlvbiBhbHJlYWR5IGhh
cHBlbmVkLgorCQkgKi8KKwkJZCA9IGZpbmRfb3JfYWxsb2NfZXhpc3Rpbmdf
ZG9tYWluKGRvbWlkKTsKKwkJaWYgKCFkKQorCQkJcmV0dXJuIC0xOworCX0K
IAogCWNudCA9IGQtPm5iZW50cnkgKyBudW07Ci0JaWYgKGNudCA8IDApCi0J
CWNudCA9IDA7CisJYXNzZXJ0KGNudCA+PSAwKTsKIAogCWlmICh1cGRhdGUp
CiAJCWQtPm5iZW50cnkgPSBjbnQ7CmRpZmYgLS1naXQgYS90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfZG9tYWluLmgKaW5kZXggNjE3ZDBhY2ZkNzViLi41OTM3OTMxMzE0
OTQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21h
aW4uaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgK
QEAgLTU1LDEwICs1NSwxMCBAQCBjb25zdCBjaGFyICpnZXRfaW1wbGljaXRf
cGF0aChjb25zdCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiBib29sIGRv
bWFpbl9pc191bnByaXZpbGVnZWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4p
OwogCiAvKiBSZW1vdmUgbm9kZSBwZXJtaXNzaW9ucyBmb3Igbm8gbG9uZ2Vy
IGV4aXN0aW5nIGRvbWFpbnMuICovCi1pbnQgZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKHN0cnVjdCBub2RlICpub2RlKTsKK2ludCBkb21haW5fYWRqdXN0
X25vZGVfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKTsKIAogLyogUXVvdGEgbWFuaXB1bGF0aW9uICovCi12b2lk
IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICopOworaW50IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICopOwogdm9pZCBkb21haW5f
ZW50cnlfZGVjKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9k
ZSAqKTsKIGludCBkb21haW5fZW50cnlfZml4KHVuc2lnbmVkIGludCBkb21p
ZCwgaW50IG51bSwgYm9vbCB1cGRhdGUpOwogaW50IGRvbWFpbl9lbnRyeShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGVlMWIwOTAzMWEz
Yi4uODZjYWY2YzM5OGJlIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtNTE5LDggKzUxOSwxMiBAQCBz
dGF0aWMgaW50IHRyYW5zYWN0aW9uX2ZpeF9kb21haW5zKHN0cnVjdCB0cmFu
c2FjdGlvbiAqdHJhbnMsIGJvb2wgdXBkYXRlKQogCiAJbGlzdF9mb3JfZWFj
aF9lbnRyeShkLCAmdHJhbnMtPmNoYW5nZWRfZG9tYWlucywgbGlzdCkgewog
CQljbnQgPSBkb21haW5fZW50cnlfZml4KGQtPmRvbWlkLCBkLT5uYmVudHJ5
LCB1cGRhdGUpOwotCQlpZiAoIXVwZGF0ZSAmJiBjbnQgPj0gcXVvdGFfbmJf
ZW50cnlfcGVyX2RvbWFpbikKLQkJCXJldHVybiBFTk9TUEM7CisJCWlmICgh
dXBkYXRlKSB7CisJCQlpZiAoY250ID49IHF1b3RhX25iX2VudHJ5X3Blcl9k
b21haW4pCisJCQkJcmV0dXJuIEVOT1NQQzsKKwkJCWlmIChjbnQgPCAwKQor
CQkJCXJldHVybiBFTk9NRU07CisJCX0KIAl9CiAKIAlyZXR1cm4gMDsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-09.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-09.patch"
Content-Transfer-Encoding: base64

RnJvbSA1YTlkMGFlNDg3OWZiMmI1YTBkYThhNTkyYTM1NzNmZjk2ZjU3YzA1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGxpbWl0IG1h
eCBudW1iZXIgb2Ygbm9kZXMgYWNjZXNzZWQgaW4gYSB0cmFuc2FjdGlvbgoK
VG9kYXkgYSBndWVzdCBpcyBmcmVlIHRvIGFjY2VzcyBhcyBtYW55IG5vZGVz
IGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uCmFzIGl0IHdhbnRzLiBUaGlzIGNh
biBsZWFkIHRvIHVuYm91bmRlZCBtZW1vcnkgY29uc3VtcHRpb24gaW4gWGVu
c3RvcmUKYXMgdGhlcmUgaXMgdGhlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiBh
bGwgbm9kZXMgaGF2aW5nIGJlZW4gYWNjZXNzZWQKZHVyaW5nIGEgdHJhbnNh
Y3Rpb24uCgpJbiBveGVuc3RvcmVkIHRoZSBudW1iZXIgb2YgcmVxdWVzdHMg
aW4gYSB0cmFuc2FjdGlvbiBpcyBiZWluZyBsaW1pdGVkCnZpYSBhIHF1b3Rh
IG1heHJlcXVlc3RzIChkZWZhdWx0IGlzIDEwMjQpLiBBcyBtdWx0aXBsZSBh
Y2Nlc3NlcyBvZiBhCm5vZGUgYXJlIG5vdCBwcm9ibGVtYXRpYyBpbiBDIFhl
bnN0b3JlLCBsaW1pdCB0aGUgbnVtYmVyIG9mIGFjY2Vzc2VkCm5vZGVzLgoK
SW4gb3JkZXIgdG8gbGV0IHJlYWRfbm9kZSgpIGRldGVjdCBhIHF1b3RhIGVy
cm9yIGluIGNhc2UgdG9vIG1hbnkgbm9kZXMKYXJlIGJlaW5nIGFjY2Vzc2Vk
LCBjaGVjayB0aGUgcmV0dXJuIHZhbHVlIG9mIGFjY2Vzc19ub2RlKCkgYW5k
IHJldHVybgpOVUxMIGluIGNhc2UgYW4gZXJyb3IgaGFzIGJlZW4gc2Vlbi4g
SW50cm9kdWNlIF9fbXVzdF9jaGVjayBhbmQgYWRkIGl0CnRvIHRoZSBhY2Nl
c3Nfbm9kZSgpIHByb3RvdHlwZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzI2
IC8gQ1ZFLTIwMjItNDIzMTQuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxs
IDxqZ3JhbGxAYW1hem9uLmNvbT4KU3VnZ2VzdGVkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGp1bGllbkB4ZW4ub3JnPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdy
b3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBKdWxpZW4gR3Jh
bGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdpdCBhL3Rvb2xzL2lu
Y2x1ZGUveGVuLXRvb2xzL2xpYnMuaCBiL3Rvb2xzL2luY2x1ZGUveGVuLXRv
b2xzL2xpYnMuaAppbmRleCBhMTZlMGMzODA3MDkuLmJhZmM5MGUyZjYwMyAx
MDA2NDQKLS0tIGEvdG9vbHMvaW5jbHVkZS94ZW4tdG9vbHMvbGlicy5oCisr
KyBiL3Rvb2xzL2luY2x1ZGUveGVuLXRvb2xzL2xpYnMuaApAQCAtNjMsNCAr
NjMsOCBAQAogI2RlZmluZSBST1VORFVQKF94LF93KSAoKCh1bnNpZ25lZCBs
b25nKShfeCkrKDFVTDw8KF93KSktMSkgJiB+KCgxVUw8PChfdykpLTEpKQog
I2VuZGlmCiAKKyNpZm5kZWYgX19tdXN0X2NoZWNrCisjZGVmaW5lIF9fbXVz
dF9jaGVjayBfX2F0dHJpYnV0ZV9fKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f
KSkKKyNlbmRpZgorCiAjZW5kaWYJLyogX19YRU5fVE9PTFNfTElCU19fICov
CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCAwYTY4
NDQ1MGJjYTYuLmQ0ZmQwMDVmNTk5ZCAxMDA2NDQKLS0tIGEvdG9vbHMveGVu
c3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDYsNiArMTA2LDcgQEAgaW50IHF1b3Rh
X25iX3dhdGNoX3Blcl9kb21haW4gPSAxMjg7CiBpbnQgcXVvdGFfbWF4X2Vu
dHJ5X3NpemUgPSAyMDQ4OyAvKiAySyAqLwogaW50IHF1b3RhX21heF90cmFu
c2FjdGlvbiA9IDEwOwogaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlID0g
NTsKK2ludCBxdW90YV90cmFuc19ub2RlcyA9IDEwMjQ7CiBpbnQgcXVvdGFf
bWF4X3BhdGhfbGVuID0gWEVOU1RPUkVfUkVMX1BBVEhfTUFYOwogaW50IHF1
b3RhX3JlcV9vdXRzdGFuZGluZyA9IDIwOwogCkBAIC01OTEsNiArNTkyLDcg
QEAgc3RydWN0IG5vZGUgKnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCVREQl9EQVRBIGtleSwgZGF0YTsK
IAlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKIAlzdHJ1Y3Qgbm9k
ZSAqbm9kZTsKKwlpbnQgZXJyOwogCiAJbm9kZSA9IHRhbGxvYyhjdHgsIHN0
cnVjdCBub2RlKTsKIAlpZiAoIW5vZGUpIHsKQEAgLTYxMiwxNCArNjE0LDEz
IEBAIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAlpZiAoZGF0YS5kcHRyID09IE5V
TEwpIHsKIAkJaWYgKHRkYl9lcnJvcih0ZGJfY3R4KSA9PSBUREJfRVJSX05P
RVhJU1QpIHsKIAkJCW5vZGUtPmdlbmVyYXRpb24gPSBOT19HRU5FUkFUSU9O
OwotCQkJYWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVB
RCwgTlVMTCk7Ci0JCQllcnJubyA9IEVOT0VOVDsKKwkJCWVyciA9IGFjY2Vz
c19ub2RlKGNvbm4sIG5vZGUsIE5PREVfQUNDRVNTX1JFQUQsIE5VTEwpOwor
CQkJZXJybm8gPSBlcnIgPyA6IEVOT0VOVDsKIAkJfSBlbHNlIHsKIAkJCWxv
ZygiVERCIGVycm9yIG9uIHJlYWQ6ICVzIiwgdGRiX2Vycm9yc3RyKHRkYl9j
dHgpKTsKIAkJCWVycm5vID0gRUlPOwogCQl9Ci0JCXRhbGxvY19mcmVlKG5v
ZGUpOwotCQlyZXR1cm4gTlVMTDsKKwkJZ290byBlcnJvcjsKIAl9CiAKIAlu
b2RlLT5wYXJlbnQgPSBOVUxMOwpAQCAtNjM0LDE5ICs2MzUsMzYgQEAgc3Ry
dWN0IG5vZGUgKnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3Qgdm9pZCAqY3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVj
dCB4c19wZXJtaXNzaW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5w
ZXJtczsKLQlpZiAoZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKGNvbm4sIG5v
ZGUpKSB7Ci0JCXRhbGxvY19mcmVlKG5vZGUpOwotCQlyZXR1cm4gTlVMTDsK
LQl9CisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhjb25uLCBub2Rl
KSkKKwkJZ290byBlcnJvcjsKIAogCS8qIERhdGEgaXMgYmluYXJ5IGJsb2Ig
KHVzdWFsbHkgYXNjaWksIG5vIG51bCkuICovCiAJbm9kZS0+ZGF0YSA9IG5v
ZGUtPnBlcm1zLnAgKyBoZHItPm51bV9wZXJtczsKIAkvKiBDaGlsZHJlbiBp
cyBzdHJpbmdzLCBudWwgc2VwYXJhdGVkLiAqLwogCW5vZGUtPmNoaWxkcmVu
ID0gbm9kZS0+ZGF0YSArIG5vZGUtPmRhdGFsZW47CiAKLQlhY2Nlc3Nfbm9k
ZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19SRUFELCBOVUxMKTsKKwlpZiAo
YWNjZXNzX25vZGUoY29ubiwgbm9kZSwgTk9ERV9BQ0NFU1NfUkVBRCwgTlVM
TCkpCisJCWdvdG8gZXJyb3I7CiAKIAlyZXR1cm4gbm9kZTsKKworIGVycm9y
OgorCWVyciA9IGVycm5vOworCXRhbGxvY19mcmVlKG5vZGUpOworCWVycm5v
ID0gZXJyOworCXJldHVybiBOVUxMOworfQorCitzdGF0aWMgYm9vbCByZWFk
X25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubyh2b2lkKQoreworCS8qCisJICog
MiBlcnJvciBjYXNlcyBmb3IgcmVhZF9ub2RlKCkgY2FuIGFsd2F5cyBiZSBw
cm9wYWdhdGVkIHVwOgorCSAqIEVOT01FTSwgYmVjYXVzZSB0aGlzIGhhcyBu
b3RoaW5nIHRvIGRvIHdpdGggdGhlIG5vZGUgYmVpbmcgaW4gdGhlCisJICog
ZGF0YSBiYXNlIG9yIG5vdCwgYnV0IGlzIGNhdXNlZCBieSBhIGdlbmVyYWwg
bGFjayBvZiBtZW1vcnkuCisJICogRU5PU1BDLCBiZWNhdXNlIHRoaXMgaXMg
cmVsYXRlZCB0byBoaXR0aW5nIHF1b3RhIGxpbWl0cyB3aGljaCBuZWVkCisJ
ICogdG8gYmUgcmVzcGVjdGVkLgorCSAqLworCXJldHVybiBlcnJubyA9PSBF
Tk9NRU0gfHwgZXJybm8gPT0gRU5PU1BDOwogfQogCiBpbnQgd3JpdGVfbm9k
ZV9yYXcoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXks
IHN0cnVjdCBub2RlICpub2RlLApAQCAtNzYzLDcgKzc4MSw3IEBAIHN0YXRp
YyBpbnQgYXNrX3BhcmVudHMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IHZvaWQgKmN0eCwKIAkJbm9kZSA9IHJlYWRfbm9kZShjb25uLCBjdHgs
IG5hbWUpOwogCQlpZiAobm9kZSkKIAkJCWJyZWFrOwotCQlpZiAoZXJybm8g
PT0gRU5PTUVNKQorCQlpZiAocmVhZF9ub2RlX2Nhbl9wcm9wYWdhdGVfZXJy
bm8oKSkKIAkJCXJldHVybiBlcnJubzsKIAl9IHdoaWxlICghc3RyZXEobmFt
ZSwgIi8iKSk7CiAKQEAgLTgyNSw3ICs4NDMsNyBAQCBzdGF0aWMgc3RydWN0
IG5vZGUgKmdldF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCQl9
CiAJfQogCS8qIENsZWFuIHVwIGVycm5vIGlmIHRoZXkgd2VyZW4ndCBzdXBw
b3NlZCB0byBrbm93LiAqLwotCWlmICghbm9kZSAmJiBlcnJubyAhPSBFTk9N
RU0pCisJaWYgKCFub2RlICYmICFyZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9l
cnJubygpKQogCQllcnJubyA9IGVycm5vX2Zyb21fcGFyZW50cyhjb25uLCBj
dHgsIG5hbWUsIGVycm5vLCBwZXJtKTsKIAlyZXR1cm4gbm9kZTsKIH0KQEAg
LTEyMzEsNyArMTI0OSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgbm9kZSAqY29uc3Ry
dWN0X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQg
KmN0eCwKIAogCS8qIElmIHBhcmVudCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUg
aXQuICovCiAJcGFyZW50ID0gcmVhZF9ub2RlKGNvbm4sIHBhcmVudG5hbWUs
IHBhcmVudG5hbWUpOwotCWlmICghcGFyZW50KQorCWlmICghcGFyZW50ICYm
IGVycm5vID09IEVOT0VOVCkKIAkJcGFyZW50ID0gY29uc3RydWN0X25vZGUo
Y29ubiwgY3R4LCBwYXJlbnRuYW1lKTsKIAlpZiAoIXBhcmVudCkKIAkJcmV0
dXJuIE5VTEw7CkBAIC0xNTA1LDcgKzE1MjMsNyBAQCBzdGF0aWMgaW50IF9y
bShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LCBz
dHJ1Y3Qgbm9kZSAqbm9kZSwKIAogCXBhcmVudCA9IHJlYWRfbm9kZShjb25u
LCBjdHgsIHBhcmVudG5hbWUpOwogCWlmICghcGFyZW50KQotCQlyZXR1cm4g
KGVycm5vID09IEVOT01FTSkgPyBFTk9NRU0gOiBFSU5WQUw7CisJCXJldHVy
biByZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubygpID8gZXJybm8gOiBF
SU5WQUw7CiAJbm9kZS0+cGFyZW50ID0gcGFyZW50OwogCiAJcmV0dXJuIGRl
bGV0ZV9ub2RlKGNvbm4sIGN0eCwgcGFyZW50LCBub2RlLCBmYWxzZSk7CkBA
IC0xNTM1LDcgKzE1NTMsNyBAQCBzdGF0aWMgaW50IGRvX3JtKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uLCBzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJ
CQkJcmV0dXJuIDA7CiAJCQl9CiAJCQkvKiBSZXN0b3JlIGVycm5vLCBqdXN0
IGluIGNhc2UuICovCi0JCQlpZiAoZXJybm8gIT0gRU5PTUVNKQorCQkJaWYg
KCFyZWFkX25vZGVfY2FuX3Byb3BhZ2F0ZV9lcnJubygpKQogCQkJCWVycm5v
ID0gRU5PRU5UOwogCQl9CiAJCXJldHVybiBlcnJubzsKQEAgLTIzNjgsNiAr
MjM4Niw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtTSwgLS1w
YXRoLW1heCA8Y2hhcnM+ICBsaW1pdCB0aGUgYWxsb3dlZCBYZW5zdG9yZSBu
b2RlIHBhdGggbGVuZ3RoLFxuIgogIiAgLVEsIC0tcXVvdGEgPHdoYXQ+PTxu
Yj4gc2V0IHRoZSBxdW90YSA8d2hhdD4gdG8gdGhlIHZhbHVlIDxuYj4sIGFs
bG93ZWRcbiIKICIgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RhcyBh
cmU6XG4iCisiICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlv
bi1ub2RlczogbnVtYmVyIG9mIGFjY2Vzc2VkIG5vZGUgcGVyXG4iCisiICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJh
bnNhY3Rpb25cbiIKICIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0
YW5kaW5nOiBudW1iZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKICIg
IC13LCAtLXRpbWVvdXQgPHdoYXQ+PTxzZWNvbmRzPiAgIHNldCB0aGUgdGlt
ZW91dCBpbiBzZWNvbmRzIGZvciA8d2hhdD4sXG4iCiAiICAgICAgICAgICAg
ICAgICAgICAgICAgICBhbGxvd2VkIHRpbWVvdXQgY2FuZGlkYXRlcyBhcmU6
XG4iCkBAIC0yNDUyLDYgKzI0NzIsOCBAQCBzdGF0aWMgdm9pZCBzZXRfcXVv
dGEoY29uc3QgY2hhciAqYXJnKQogCXZhbCA9IGdldF9vcHR2YWxfaW50KGVx
ICsgMSk7CiAJaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFuZGluZyIp
KQogCQlxdW90YV9yZXFfb3V0c3RhbmRpbmcgPSB2YWw7CisJZWxzZSBpZiAo
d2hhdF9tYXRjaGVzKGFyZywgInRyYW5zYWN0aW9uLW5vZGVzIikpCisJCXF1
b3RhX3RyYW5zX25vZGVzID0gdmFsOwogCWVsc2UKIAkJYmFyZigidW5rbm93
biBxdW90YSBcIiVzXCJcbiIsIGFyZyk7CiB9CmRpZmYgLS1naXQgYS90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuaAppbmRleCBhYTBkZWRkZTY0NGIuLjljNTcyYTNj
NmUyYSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBA
IC0yNjYsNiArMjY2LDcgQEAgZXh0ZXJuIGludCBkb20wX2V2ZW50OwogZXh0
ZXJuIGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9lbnRy
eV9wZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRp
bmc7CitleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOwogCiBleHRlcm4g
dW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9u
LmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpp
bmRleCA4NmNhZjZjMzk4YmUuLjdiZDQxZWI0NzVlMyAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKKysrIGIv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMKQEAgLTE1
Niw2ICsxNTYsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBDb25uZWN0
aW9uLWxvY2FsIGlkZW50aWZpZXIgZm9yIHRoaXMgdHJhbnNhY3Rpb24uICov
CiAJdWludDMyX3QgaWQ7CiAKKwkvKiBOb2RlIGNvdW50ZXIuICovCisJdW5z
aWduZWQgaW50IG5vZGVzOworCiAJLyogR2VuZXJhdGlvbiB3aGVuIHRyYW5z
YWN0aW9uIHN0YXJ0ZWQuICovCiAJdWludDY0X3QgZ2VuZXJhdGlvbjsKIApA
QCAtMjYwLDYgKzI2MywxMSBAQCBpbnQgYWNjZXNzX25vZGUoc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlLAogCiAJaSA9IGZp
bmRfYWNjZXNzZWRfbm9kZSh0cmFucywgbm9kZS0+bmFtZSk7CiAJaWYgKCFp
KSB7CisJCWlmICh0cmFucy0+bm9kZXMgPj0gcXVvdGFfdHJhbnNfbm9kZXMg
JiYKKwkJICAgIGRvbWFpbl9pc191bnByaXZpbGVnZWQoY29ubikpIHsKKwkJ
CXJldCA9IEVOT1NQQzsKKwkJCWdvdG8gZXJyOworCQl9CiAJCWkgPSB0YWxs
b2NfemVybyh0cmFucywgc3RydWN0IGFjY2Vzc2VkX25vZGUpOwogCQlpZiAo
IWkpCiAJCQlnb3RvIG5vbWVtOwpAQCAtMjk3LDYgKzMwNSw3IEBAIGludCBh
Y2Nlc3Nfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5v
ZGUgKm5vZGUsCiAJCQkJaS0+dGFfbm9kZSA9IHRydWU7CiAJCQl9CiAJCX0K
KwkJdHJhbnMtPm5vZGVzKys7CiAJCWxpc3RfYWRkX3RhaWwoJmktPmxpc3Qs
ICZ0cmFucy0+YWNjZXNzZWQpOwogCX0KIApkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmggYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uaAppbmRleCAwMDkzY2FjODA3
ZTMuLmUzY2JkNmIyMzA5NSAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKKysrIGIvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX3RyYW5zYWN0aW9uLmgKQEAgLTM5LDggKzM5LDggQEAgdm9p
ZCB0cmFuc2FjdGlvbl9lbnRyeV9pbmMoc3RydWN0IHRyYW5zYWN0aW9uICp0
cmFucywgdW5zaWduZWQgaW50IGRvbWlkKTsKIHZvaWQgdHJhbnNhY3Rpb25f
ZW50cnlfZGVjKHN0cnVjdCB0cmFuc2FjdGlvbiAqdHJhbnMsIHVuc2lnbmVk
IGludCBkb21pZCk7CiAKIC8qIFRoaXMgbm9kZSB3YXMgYWNjZXNzZWQuICov
Ci1pbnQgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlLAotICAgICAgICAgICAgICAgIGVudW0gbm9kZV9h
Y2Nlc3NfdHlwZSB0eXBlLCBUREJfREFUQSAqa2V5KTsKK2ludCBfX211c3Rf
Y2hlY2sgYWNjZXNzX25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0
cnVjdCBub2RlICpub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBlbnVtIG5vZGVfYWNjZXNzX3R5cGUgdHlwZSwgVERCX0RBVEEgKmtleSk7
CiAKIC8qIFF1ZXVlIHdhdGNoZXMgZm9yIGEgbW9kaWZpZWQgbm9kZS4gKi8K
IHZvaWQgcXVldWVfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
Y29uc3QgY2hhciAqbmFtZSwgYm9vbCB3YXRjaF9leGFjdCk7Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-10.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-10.patch"
Content-Transfer-Encoding: base64

RnJvbSA0ZTFmYzFmZWYxMWI5ZWU5ZWNjMTAwZjFhYzFhN2FiYzNjZmY4YzBh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1vdmUgdGhl
IGNhbGwgb2Ygc2V0dXBfc3RydWN0dXJlKCkgdG8gZG9tMAogaW50cm9kdWN0
aW9uCgpTZXR0aW5nIHVwIHRoZSBiYXNpYyBzdHJ1Y3R1cmUgd2hlbiBpbnRy
b2R1Y2luZyBkb20wIGhhcyB0aGUgYWR2YW50YWdlCnRvIGJlIGFibGUgdG8g
YWRkIHByb3BlciBub2RlIG1lbW9yeSBhY2NvdW50aW5nIGZvciB0aGUgYWRk
ZWQgbm9kZXMKbGF0ZXIuCgpUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIGRv
IHByb3BlciBub2RlIGFjY291bnRpbmcsIHRvby4KCkFuIGFkZGl0aW9uYWwg
cmVxdWlyZW1lbnQgdG8gbWFrZSB0aGF0IHdvcmsgZmluZSBpcyB0byBjb3Jy
ZWN0IHRoZQpvd25lciBvZiB0aGUgY3JlYXRlZCBub2RlcyB0byBiZSBkb20w
X2RvbWlkIGluc3RlYWQgb2YgZG9taWQgMC4KClRoaXMgaXMgcGFydCBvZiBY
U0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMK
aW5kZXggZDRmZDAwNWY1OTlkLi44NDRhZTM5NmEwZDUgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtMjAxOCw3ICsyMDE4LDgg
QEAgc3RhdGljIGludCB0ZGJfZmxhZ3M7CiBzdGF0aWMgdm9pZCBtYW51YWxf
bm9kZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFyICpjaGlsZCkKIHsK
IAlzdHJ1Y3Qgbm9kZSAqbm9kZTsKLQlzdHJ1Y3QgeHNfcGVybWlzc2lvbnMg
cGVybXMgPSB7IC5pZCA9IDAsIC5wZXJtcyA9IFhTX1BFUk1fTk9ORSB9Owor
CXN0cnVjdCB4c19wZXJtaXNzaW9ucyBwZXJtcyA9IHsgLmlkID0gZG9tMF9k
b21pZCwKKwkJCQkJLnBlcm1zID0gWFNfUEVSTV9OT05FIH07CiAKIAlub2Rl
ID0gdGFsbG9jX3plcm8oTlVMTCwgc3RydWN0IG5vZGUpOwogCWlmICghbm9k
ZSkKQEAgLTIwNTcsNyArMjA1OCw3IEBAIHN0YXRpYyB2b2lkIHRkYl9sb2dn
ZXIoVERCX0NPTlRFWFQgKnRkYiwgaW50IGxldmVsLCBjb25zdCBjaGFyICog
Zm10LCAuLi4pCiAJfQogfQogCi1zdGF0aWMgdm9pZCBzZXR1cF9zdHJ1Y3R1
cmUoYm9vbCBsaXZlX3VwZGF0ZSkKK3ZvaWQgc2V0dXBfc3RydWN0dXJlKGJv
b2wgbGl2ZV91cGRhdGUpCiB7CiAJY2hhciAqdGRibmFtZTsKIApAQCAtMjA4
MCw2ICsyMDgxLDcgQEAgc3RhdGljIHZvaWQgc2V0dXBfc3RydWN0dXJlKGJv
b2wgbGl2ZV91cGRhdGUpCiAJCW1hbnVhbF9ub2RlKCIvIiwgInRvb2wiKTsK
IAkJbWFudWFsX25vZGUoIi90b29sIiwgInhlbnN0b3JlZCIpOwogCQltYW51
YWxfbm9kZSgiL3Rvb2wveGVuc3RvcmVkIiwgTlVMTCk7CisJCWRvbWFpbl9l
bnRyeV9maXgoZG9tMF9kb21pZCwgMywgdHJ1ZSk7CiAJfQogCiAJY2hlY2tf
c3RvcmUoKTsKQEAgLTI1OTgsOSArMjYwMCw2IEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAKIAlpbml0X3BpcGUocmVvcGVuX2xvZ19w
aXBlKTsKIAotCS8qIFNldHVwIHRoZSBkYXRhYmFzZSAqLwotCXNldHVwX3N0
cnVjdHVyZShsaXZlX3VwZGF0ZSk7Ci0KIAkvKiBMaXN0ZW4gdG8gaHlwZXJ2
aXNvci4gKi8KIAlpZiAoIW5vX2RvbWFpbl9pbml0ICYmICFsaXZlX3VwZGF0
ZSkgewogCQlkb21haW5faW5pdCgtMSk7CmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaAppbmRleCA5YzU3MmEzYzZlMmEuLmE3NzJmM2I4ZWFk
MiAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUu
aAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0y
MzEsNiArMjMxLDcgQEAgaW50IHdyaXRlX25vZGVfcmF3KHN0cnVjdCBjb25u
ZWN0aW9uICpjb25uLCBUREJfREFUQSAqa2V5LCBzdHJ1Y3Qgbm9kZSAqbm9k
ZSwKIHN0cnVjdCBub2RlICpyZWFkX25vZGUoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwKIAkJICAgICAgIGNvbnN0IGNoYXIg
Km5hbWUpOwogCit2b2lkIHNldHVwX3N0cnVjdHVyZShib29sIGxpdmVfdXBk
YXRlKTsKIHN0cnVjdCBjb25uZWN0aW9uICpuZXdfY29ubmVjdGlvbihjb25z
dCBzdHJ1Y3QgaW50ZXJmYWNlX2Z1bmNzICpmdW5jcyk7CiBzdHJ1Y3QgY29u
bmVjdGlvbiAqZ2V0X2Nvbm5lY3Rpb25fYnlfaWQodW5zaWduZWQgaW50IGNv
bm5faWQpOwogdm9pZCBjaGVja19zdG9yZSh2b2lkKTsKZGlmZiAtLWdpdCBh
L3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYwppbmRleCA0NGNlMjY3ZWM1NTcu
LjVjNzllZWQzZGMzNCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9kb21haW4uYwpAQCAtNDk2LDYgKzQ5Niw5IEBAIHN0YXRpYyBzdHJ1Y3Qg
ZG9tYWluICppbnRyb2R1Y2VfZG9tYWluKGNvbnN0IHZvaWQgKmN0eCwKIAkJ
fQogCQlkb21haW4tPmludGVyZmFjZSA9IGludGVyZmFjZTsKIAorCQlpZiAo
aXNfbWFzdGVyX2RvbWFpbikKKwkJCXNldHVwX3N0cnVjdHVyZShyZXN0b3Jl
KTsKKwogCQkvKiBOb3cgZG9tYWluIGJlbG9uZ3MgdG8gaXRzIGNvbm5lY3Rp
b24uICovCiAJCXRhbGxvY19zdGVhbChkb21haW4tPmNvbm4sIGRvbWFpbik7
CiAK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-11.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-11.patch"
Content-Transfer-Encoding: base64

RnJvbSBmMzBlZGQ1NDUyYTMyMjZkMThmZjk4NDQxMDEzYzllODZlNGUzNGYy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBpbmZy
YXN0cnVjdHVyZSB0byBrZWVwIHRyYWNrIG9mIHBlciBkb21haW4gbWVtb3J5
CiB1c2FnZQoKVGhlIGFtb3VudCBvZiBtZW1vcnkgYSBkb21haW4gY2FuIGNv
bnN1bWUgaW4gWGVuc3RvcmUgaXMgbGltaXRlZCBieQp2YXJpb3VzIHF1b3Rh
IHRvZGF5LCBidXQgZXZlbiB3aXRoIHNhbmUgcXVvdGEgYSBkb21haW4gY2Fu
IHN0aWxsCmNvbnN1bWUgcmF0aGVyIGxhcmdlIG1lbW9yeSBxdWFudGl0aWVz
LgoKQWRkIHRoZSBpbmZyYXN0cnVjdHVyZSBmb3Iga2VlcGluZyB0cmFjayBv
ZiB0aGUgYW1vdW50IG9mIG1lbW9yeSBhCmRvbWFpbiBpcyBjb25zdW1pbmcg
aW4gWGVuc3RvcmUuIE5vdGUgdGhhdCB0aGlzIGlzIG9ubHkgdGhlIG1lbW9y
eSBhCmRvbWFpbiBoYXMgZGlyZWN0IGNvbnRyb2wgb3Zlciwgc28gYW55IGlu
dGVybmFsIGFkbWluaXN0cmF0aW9uIGRhdGEKbmVlZGVkIGJ5IFhlbnN0b3Jl
IG9ubHkgaXMgbm90IGJlaW5nIGFjY291bnRlZCBmb3IuCgpUaGVyZSBhcmUg
dHdvIHF1b3RhcyBkZWZpbmVkOiBhIHNvZnQgcXVvdGEgd2hpY2ggd2lsbCBy
ZXN1bHQgaW4gYQp3YXJuaW5nIGlzc3VlZCB2aWEgc3lzbG9nKCkgd2hlbiBp
dCBpcyBleGNlZWRlZCwgYW5kIGEgaGFyZCBxdW90YQpyZXN1bHRpbmcgaW4g
YSBzdG9wIG9mIGFjY2VwdGluZyBmdXJ0aGVyIHJlcXVlc3RzIG9yIHdhdGNo
IGV2ZW50cyBhcwpsb25nIGFzIHRoZSBoYXJkIHF1b3RhIHdvdWxkIGJlIHZp
b2xhdGVkIGJ5IGFjY2VwdGluZyB0aG9zZS4KClNldHRpbmcgYW55IG9mIHRo
b3NlIHF1b3RhcyB0byAwIHdpbGwgZGlzYWJsZSBpdC4KCkFzIGRlZmF1bHQg
dmFsdWVzIHVzZSAyTUIgcGVyIGRvbWFpbiBmb3IgdGhlIHNvZnQgbGltaXQg
KHRoaXMgYmFzaWNhbGx5CmNvdmVycyB0aGUgYWxsb3dlZCBjYXNlIHRvIGNy
ZWF0ZSAxMDAwIG5vZGVzIG5lZWRpbmcgMmtCIGVhY2gpLCBhbmQKMi41TUIg
Zm9yIHRoZSBoYXJkIGxpbWl0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMjYu
CgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9u
LmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRf
Y29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRl
eCA4NDRhZTM5NmEwZDUuLmYwM2FkOTNiNDM4NSAxMDA2NDQKLS0tIGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5z
dG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0xMDksNiArMTA5LDggQEAgaW50
IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlID0gNTsKIGludCBxdW90YV90cmFu
c19ub2RlcyA9IDEwMjQ7CiBpbnQgcXVvdGFfbWF4X3BhdGhfbGVuID0gWEVO
U1RPUkVfUkVMX1BBVEhfTUFYOwogaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZyA9IDIwOworaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX3NvZnQgPSAy
ICogMTAyNCAqIDEwMjQ7IC8qIDIgTUIgKi8KK2ludCBxdW90YV9tZW1vcnlf
cGVyX2RvbWFpbl9oYXJkID0gMiAqIDEwMjQgKiAxMDI0ICsgNTEyICogMTAy
NDsgLyogMi41IE1CICovCiAKIHVuc2lnbmVkIGludCB0aW1lb3V0X3dhdGNo
X2V2ZW50X21zZWMgPSAyMDAwMDsKIApAQCAtMjM5MCw3ICsyMzkyLDE0IEBA
IHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICBxdW90YXMgYXJlOlxuIgogIiAgICAgICAgICAgICAgICAgICAg
ICAgICAgdHJhbnNhY3Rpb24tbm9kZXM6IG51bWJlciBvZiBhY2Nlc3NlZCBu
b2RlIHBlclxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRyYW5zYWN0aW9uXG4iCisiICAgICAgICAgICAgICAg
ICAgICAgICAgICBtZW1vcnk6IHRvdGFsIHVzZWQgbWVtb3J5IHBlciBkb21h
aW4gZm9yIG5vZGVzLFxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0cmFuc2FjdGlvbnMsIHdhdGNoZXMgYW5kIHJlcXVlc3RzLCBh
Ym92ZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3
aGljaCBYZW5zdG9yZSB3aWxsIHN0b3AgdGFsa2luZyB0byBkb21haW5cbiIK
ICIgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nOiBudW1i
ZXIgb2Ygb3V0c3RhbmRpbmcgcmVxdWVzdHNcbiIKKyIgIC1xLCAtLXF1b3Rh
LXNvZnQgPHdoYXQ+PTxuYj4gc2V0IGEgc29mdCBxdW90YSA8d2hhdD4gdG8g
dGhlIHZhbHVlIDxuYj4sXG4iCisiICAgICAgICAgICAgICAgICAgICAgICAg
ICBjYXVzaW5nIGEgd2FybmluZyB0byBiZSBpc3N1ZWQgdmlhIHN5c2xvZygp
IGlmIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQg
aXMgdmlvbGF0ZWQsIGFsbG93ZWQgcXVvdGFzIGFyZTpcbiIKKyIgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1lbW9yeTogc2VlIGFib3ZlXG4iCiAiICAt
dywgLS10aW1lb3V0IDx3aGF0Pj08c2Vjb25kcz4gICBzZXQgdGhlIHRpbWVv
dXQgaW4gc2Vjb25kcyBmb3IgPHdoYXQ+LFxuIgogIiAgICAgICAgICAgICAg
ICAgICAgICAgICAgYWxsb3dlZCB0aW1lb3V0IGNhbmRpZGF0ZXMgYXJlOlxu
IgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2gtZXZlbnQ6IHRp
bWUgYSB3YXRjaC1ldmVudCBpcyBrZXB0IHBlbmRpbmdcbiIKQEAgLTI0MTcs
NiArMjQyNiw3IEBAIHN0YXRpYyBzdHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9
IHsKIAl7ICJwZXJtLW5iIiwgMSwgTlVMTCwgJ0EnIH0sCiAJeyAicGF0aC1t
YXgiLCAxLCBOVUxMLCAnTScgfSwKIAl7ICJxdW90YSIsIDEsIE5VTEwsICdR
JyB9LAorCXsgInF1b3RhLXNvZnQiLCAxLCBOVUxMLCAncScgfSwKIAl7ICJ0
aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3ZlcnkiLCAw
LCBOVUxMLCAnUicgfSwKIAl7ICJpbnRlcm5hbC1kYiIsIDAsIE5VTEwsICdJ
JyB9LApAQCAtMjQ2NCw3ICsyNDc0LDcgQEAgc3RhdGljIHZvaWQgc2V0X3Rp
bWVvdXQoY29uc3QgY2hhciAqYXJnKQogCQliYXJmKCJ1bmtub3duIHRpbWVv
dXQgXCIlc1wiXG4iLCBhcmcpOwogfQogCi1zdGF0aWMgdm9pZCBzZXRfcXVv
dGEoY29uc3QgY2hhciAqYXJnKQorc3RhdGljIHZvaWQgc2V0X3F1b3RhKGNv
bnN0IGNoYXIgKmFyZywgYm9vbCBzb2Z0KQogewogCWNvbnN0IGNoYXIgKmVx
ID0gc3RyY2hyKGFyZywgJz0nKTsKIAlpbnQgdmFsOwpAQCAtMjQ3MiwxMSAr
MjQ4MiwxNiBAQCBzdGF0aWMgdm9pZCBzZXRfcXVvdGEoY29uc3QgY2hhciAq
YXJnKQogCWlmICghZXEpCiAJCWJhcmYoInF1b3RhcyBtdXN0IGJlIHNwZWNp
ZmllZCB2aWEgPHdoYXQ+PTxuYj5cbiIpOwogCXZhbCA9IGdldF9vcHR2YWxf
aW50KGVxICsgMSk7Ci0JaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJvdXRzdGFu
ZGluZyIpKQorCWlmICh3aGF0X21hdGNoZXMoYXJnLCAib3V0c3RhbmRpbmci
KSAmJiAhc29mdCkKIAkJcXVvdGFfcmVxX291dHN0YW5kaW5nID0gdmFsOwot
CWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlvbi1ub2Rl
cyIpKQorCWVsc2UgaWYgKHdoYXRfbWF0Y2hlcyhhcmcsICJ0cmFuc2FjdGlv
bi1ub2RlcyIpICYmICFzb2Z0KQogCQlxdW90YV90cmFuc19ub2RlcyA9IHZh
bDsKLQllbHNlCisJZWxzZSBpZiAod2hhdF9tYXRjaGVzKGFyZywgIm1lbW9y
eSIpKSB7CisJCWlmIChzb2Z0KQorCQkJcXVvdGFfbWVtb3J5X3Blcl9kb21h
aW5fc29mdCA9IHZhbDsKKwkJZWxzZQorCQkJcXVvdGFfbWVtb3J5X3Blcl9k
b21haW5faGFyZCA9IHZhbDsKKwl9IGVsc2UKIAkJYmFyZigidW5rbm93biBx
dW90YSBcIiVzXCJcbiIsIGFyZyk7CiB9CiAKQEAgLTI0OTQsNyArMjUwOSw3
IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAJb3JpZ19h
cmdjID0gYXJnYzsKIAlvcmlnX2FyZ3YgPSBhcmd2OwogCi0Jd2hpbGUgKChv
cHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBhcmd2LCAiREU6RjpITlBTOnQ6QTpN
OlE6VDpSVlc6dzpVIiwKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFy
Z2MsIGFyZ3YsICJERTpGOkhOUFM6dDpBOk06UTpxOlQ6UlZXOnc6VSIsCiAJ
CQkJICBvcHRpb25zLCBOVUxMKSkgIT0gLTEpIHsKIAkJc3dpdGNoIChvcHQp
IHsKIAkJY2FzZSAnRCc6CkBAIC0yNTQ1LDcgKzI1NjAsMTAgQEAgaW50IG1h
aW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCQkJCSBxdW90YV9tYXhf
cGF0aF9sZW4pOwogCQkJYnJlYWs7CiAJCWNhc2UgJ1EnOgotCQkJc2V0X3F1
b3RhKG9wdGFyZyk7CisJCQlzZXRfcXVvdGEob3B0YXJnLCBmYWxzZSk7CisJ
CQlicmVhazsKKwkJY2FzZSAncSc6CisJCQlzZXRfcXVvdGEob3B0YXJnLCB0
cnVlKTsKIAkJCWJyZWFrOwogCQljYXNlICd3JzoKIAkJCXNldF90aW1lb3V0
KG9wdGFyZyk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApp
bmRleCBhNzcyZjNiOGVhZDIuLmVjNTJkOGQzZmYwMyAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaAorKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5oCkBAIC0yNjgsNiArMjY4LDggQEAg
ZXh0ZXJuIGludCBwcml2X2RvbWlkOwogZXh0ZXJuIGludCBxdW90YV9uYl9l
bnRyeV9wZXJfZG9tYWluOwogZXh0ZXJuIGludCBxdW90YV9yZXFfb3V0c3Rh
bmRpbmc7CiBleHRlcm4gaW50IHF1b3RhX3RyYW5zX25vZGVzOworZXh0ZXJu
IGludCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0OworZXh0ZXJuIGlu
dCBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9oYXJkOwogCiBleHRlcm4gdW5z
aWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApkaWZmIC0t
Z2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDVjNzllZWQz
ZGMzNC4uNDI0MjM4MDg4NjNmIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9y
ZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5jCkBAIC03Niw2ICs3NiwxMyBAQCBzdHJ1Y3QgZG9t
YWluCiAJLyogbnVtYmVyIG9mIGVudHJ5IGZyb20gdGhpcyBkb21haW4gaW4g
dGhlIHN0b3JlICovCiAJaW50IG5iZW50cnk7CiAKKwkvKiBBbW91bnQgb2Yg
bWVtb3J5IGFsbG9jYXRlZCBmb3IgdGhpcyBkb21haW4uICovCisJaW50IG1l
bW9yeTsKKwlib29sIHNvZnRfcXVvdGFfcmVwb3J0ZWQ7CisJYm9vbCBoYXJk
X3F1b3RhX3JlcG9ydGVkOworCXRpbWVfdCBtZW1fbGFzdF9tc2c7CisjZGVm
aW5lIE1FTV9XQVJOX01JTlRJTUVfU0VDIDEwCisKIAkvKiBudW1iZXIgb2Yg
d2F0Y2ggZm9yIHRoaXMgZG9tYWluICovCiAJaW50IG5id2F0Y2g7CiAKQEAg
LTE5Miw2ICsxOTksOSBAQCBzdGF0aWMgYm9vbCBkb21haW5fY2FuX3JlYWQo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pCiAJCQlyZXR1cm4gZmFsc2U7CiAJ
CWlmIChjb25uLT5kb21haW4tPm5ib3V0c3RhbmRpbmcgPj0gcXVvdGFfcmVx
X291dHN0YW5kaW5nKQogCQkJcmV0dXJuIGZhbHNlOworCQlpZiAoY29ubi0+
ZG9tYWluLT5tZW1vcnkgPj0gcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFy
ZCAmJgorCQkgICAgcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFyZCkKKwkJ
CXJldHVybiBmYWxzZTsKIAl9CiAKIAlyZXR1cm4gKGludGYtPnJlcV9jb25z
ICE9IGludGYtPnJlcV9wcm9kKTsKQEAgLTk4Miw2ICs5OTIsODkgQEAgaW50
IGRvbWFpbl9lbnRyeShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubikKIAkJOiAw
OwogfQogCitzdGF0aWMgYm9vbCBkb21haW5fY2hrX3F1b3RhKHN0cnVjdCBk
b21haW4gKmRvbWFpbiwgaW50IG1lbSkKK3sKKwl0aW1lX3Qgbm93OworCisJ
aWYgKCFkb21haW4gfHwgIWRvbWlkX2lzX3VucHJpdmlsZWdlZChkb21haW4t
PmRvbWlkKSB8fAorCSAgICAoZG9tYWluLT5jb25uICYmIGRvbWFpbi0+Y29u
bi0+aXNfaWdub3JlZCkpCisJCXJldHVybiBmYWxzZTsKKworCW5vdyA9IHRp
bWUoTlVMTCk7CisKKwlpZiAobWVtID49IHF1b3RhX21lbW9yeV9wZXJfZG9t
YWluX2hhcmQgJiYKKwkgICAgcXVvdGFfbWVtb3J5X3Blcl9kb21haW5faGFy
ZCkgeworCQlpZiAoZG9tYWluLT5oYXJkX3F1b3RhX3JlcG9ydGVkKQorCQkJ
cmV0dXJuIHRydWU7CisJCXN5c2xvZyhMT0dfRVJSLCAiRG9tYWluICV1IGV4
Y2VlZHMgaGFyZCBtZW1vcnkgcXVvdGEsIFhlbnN0b3JlIGludGVyZmFjZSB0
byBkb21haW4gc3RhbGxlZFxuIiwKKwkJICAgICAgIGRvbWFpbi0+ZG9taWQp
OworCQlkb21haW4tPm1lbV9sYXN0X21zZyA9IG5vdzsKKwkJZG9tYWluLT5o
YXJkX3F1b3RhX3JlcG9ydGVkID0gdHJ1ZTsKKwkJcmV0dXJuIHRydWU7CisJ
fQorCisJaWYgKG5vdyAtIGRvbWFpbi0+bWVtX2xhc3RfbXNnID49IE1FTV9X
QVJOX01JTlRJTUVfU0VDKSB7CisJCWlmIChkb21haW4tPmhhcmRfcXVvdGFf
cmVwb3J0ZWQpIHsKKwkJCWRvbWFpbi0+bWVtX2xhc3RfbXNnID0gbm93Owor
CQkJZG9tYWluLT5oYXJkX3F1b3RhX3JlcG9ydGVkID0gZmFsc2U7CisJCQlz
eXNsb2coTE9HX0lORk8sICJEb21haW4gJXUgYmVsb3cgaGFyZCBtZW1vcnkg
cXVvdGEgYWdhaW5cbiIsCisJCQkgICAgICAgZG9tYWluLT5kb21pZCk7CisJ
CX0KKwkJaWYgKG1lbSA+PSBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0
ICYmCisJCSAgICBxdW90YV9tZW1vcnlfcGVyX2RvbWFpbl9zb2Z0ICYmCisJ
CSAgICAhZG9tYWluLT5zb2Z0X3F1b3RhX3JlcG9ydGVkKSB7CisJCQlkb21h
aW4tPm1lbV9sYXN0X21zZyA9IG5vdzsKKwkJCWRvbWFpbi0+c29mdF9xdW90
YV9yZXBvcnRlZCA9IHRydWU7CisJCQlzeXNsb2coTE9HX1dBUk5JTkcsICJE
b21haW4gJXUgZXhjZWVkcyBzb2Z0IG1lbW9yeSBxdW90YVxuIiwKKwkJCSAg
ICAgICBkb21haW4tPmRvbWlkKTsKKwkJfQorCQlpZiAobWVtIDwgcXVvdGFf
bWVtb3J5X3Blcl9kb21haW5fc29mdCAmJgorCQkgICAgZG9tYWluLT5zb2Z0
X3F1b3RhX3JlcG9ydGVkKSB7CisJCQlkb21haW4tPm1lbV9sYXN0X21zZyA9
IG5vdzsKKwkJCWRvbWFpbi0+c29mdF9xdW90YV9yZXBvcnRlZCA9IGZhbHNl
OworCQkJc3lzbG9nKExPR19JTkZPLCAiRG9tYWluICV1IGJlbG93IHNvZnQg
bWVtb3J5IHF1b3RhIGFnYWluXG4iLAorCQkJICAgICAgIGRvbWFpbi0+ZG9t
aWQpOworCQl9CisKKwl9CisKKwlyZXR1cm4gZmFsc2U7Cit9CisKK2ludCBk
b21haW5fbWVtb3J5X2FkZCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBtZW0s
IGJvb2wgbm9fcXVvdGFfY2hlY2spCit7CisJc3RydWN0IGRvbWFpbiAqZG9t
YWluOworCisJZG9tYWluID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsK
KwlpZiAoZG9tYWluKSB7CisJCS8qCisJCSAqIGRvbWFpbl9jaGtfcXVvdGEo
KSB3aWxsIHByaW50IHdhcm5pbmcgYW5kIGFsc28gc3RvcmUgd2hldGhlcgor
CQkgKiB0aGUgc29mdC9oYXJkIHF1b3RhIGhhcyBiZWVuIGhpdC4gU28gY2hl
Y2sgbm9fcXVvdGFfY2hlY2sKKwkJICogKmFmdGVyKi4KKwkJICovCisJCWlm
IChkb21haW5fY2hrX3F1b3RhKGRvbWFpbiwgZG9tYWluLT5tZW1vcnkgKyBt
ZW0pICYmCisJCSAgICAhbm9fcXVvdGFfY2hlY2spCisJCQlyZXR1cm4gRU5P
TUVNOworCQlkb21haW4tPm1lbW9yeSArPSBtZW07CisJfSBlbHNlIHsKKwkJ
LyoKKwkJICogVGhlIGRvbWFpbiB0aGUgbWVtb3J5IGlzIHRvIGJlIGFjY291
bnRlZCBmb3Igc2hvdWxkIGFsd2F5cworCQkgKiBleGlzdCwgYXMgYWNjb3Vu
dGluZyBpcyBkb25lIGVpdGhlciBmb3IgYSBkb21haW4gcmVsYXRlZCB0bwor
CQkgKiB0aGUgY3VycmVudCBjb25uZWN0aW9uLCBvciBmb3IgdGhlIGRvbWFp
biBvd25pbmcgYSBub2RlCisJCSAqICh3aGljaCBpcyBhbHdheXMgZXhpc3Rp
bmcsIGFzIHRoZSBvd25lciBvZiB0aGUgbm9kZSBpcworCQkgKiB0ZXN0ZWQg
dG8gZXhpc3QgYW5kIHJlcGxhY2VkIGJ5IGRvbWlkIDAgaWYgbm90KS4KKwkJ
ICogU28gbm90IGZpbmRpbmcgdGhlIHJlbGF0ZWQgZG9tYWluIE1VU1QgYmUg
YW4gZXJyb3IgaW4gdGhlCisJCSAqIGRhdGEgYmFzZS4KKwkJICovCisJCWVy
cm5vID0gRU5PRU5UOworCQljb3JydXB0KE5VTEwsICJBY2NvdW50aW5nIGNh
bGxlZCBmb3Igbm9uLWV4aXN0aW5nIGRvbWFpbiAldVxuIiwKKwkJCWRvbWlk
KTsKKwkJcmV0dXJuIEVOT0VOVDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwog
dm9pZCBkb21haW5fd2F0Y2hfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
KQogewogCWlmICghY29ubiB8fCAhY29ubi0+ZG9tYWluKQpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCmluZGV4IDU5Mzc5MzEzMTQ5
NC4uZDM0MmU1ZTg2N2VkIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2RvbWFpbi5oCkBAIC02Miw2ICs2MiwyNiBAQCBpbnQgZG9tYWluX2Vu
dHJ5X2luYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUg
Kik7CiB2b2lkIGRvbWFpbl9lbnRyeV9kZWMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICopOwogaW50IGRvbWFpbl9lbnRyeV9maXgo
dW5zaWduZWQgaW50IGRvbWlkLCBpbnQgbnVtLCBib29sIHVwZGF0ZSk7CiBp
bnQgZG9tYWluX2VudHJ5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKK2lu
dCBkb21haW5fbWVtb3J5X2FkZCh1bnNpZ25lZCBpbnQgZG9taWQsIGludCBt
ZW0sIGJvb2wgbm9fcXVvdGFfY2hlY2spOworCisvKgorICogZG9tYWluX21l
bW9yeV9hZGRfY2hrKCk6IHRvIGJlIHVzZWQgd2hlbiBtZW1vcnkgcXVvdGEg
c2hvdWxkIGJlIGNoZWNrZWQuCisgKiBOb3QgdG8gYmUgdXNlZCB3aGVuIHNw
ZWNpZnlpbmcgYSBuZWdhdGl2ZSBtZW0gdmFsdWUsIGFzIGxvd2VyaW5nIHRo
ZSB1c2VkCisgKiBtZW1vcnkgc2hvdWxkIGFsd2F5cyBiZSBhbGxvd2VkLgor
ICovCitzdGF0aWMgaW5saW5lIGludCBkb21haW5fbWVtb3J5X2FkZF9jaGso
dW5zaWduZWQgaW50IGRvbWlkLCBpbnQgbWVtKQoreworCXJldHVybiBkb21h
aW5fbWVtb3J5X2FkZChkb21pZCwgbWVtLCBmYWxzZSk7Cit9CisvKgorICog
ZG9tYWluX21lbW9yeV9hZGRfbm9jaGsoKTogdG8gYmUgdXNlZCB3aGVuIG1l
bW9yeSBxdW90YSBzaG91bGQgbm90IGJlCisgKiBjaGVja2VkLCBlLmcuIHdo
ZW4gbG93ZXJpbmcgbWVtb3J5IHVzYWdlLCBvciBpbiBhbiBlcnJvciBjYXNl
IGZvciB1bmRvaW5nCisgKiBhIHByZXZpb3VzIG1lbW9yeSBhZGp1c3RtZW50
LgorICovCitzdGF0aWMgaW5saW5lIHZvaWQgZG9tYWluX21lbW9yeV9hZGRf
bm9jaGsodW5zaWduZWQgaW50IGRvbWlkLCBpbnQgbWVtKQoreworCWRvbWFp
bl9tZW1vcnlfYWRkKGRvbWlkLCBtZW0sIHRydWUpOworfQogdm9pZCBkb21h
aW5fd2F0Y2hfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsKIHZvaWQg
ZG9tYWluX3dhdGNoX2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiBp
bnQgZG9tYWluX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsK

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-12.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-12.patch"
Content-Transfer-Encoding: base64

RnJvbSA4MzU2ZmI1MWM5OTkzYTYyNzZhZjI1ZGUzZDE4M2E5NzJjYjljNDlh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MDkgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3IgcmVzcG9uc2VzCgpBZGQgdGhlIG1lbW9yeSBh
Y2NvdW50aW5nIGZvciBxdWV1ZWQgcmVzcG9uc2VzLgoKSW4gY2FzZSBhZGRp
bmcgYSB3YXRjaCBldmVudCBmb3IgYSBndWVzdCBpcyBjYXVzaW5nIHRoZSBo
YXJkIG1lbW9yeQpxdW90YSBvZiB0aGF0IGd1ZXN0IHRvIGJlIHZpb2xhdGVk
LCB0aGUgZXZlbnQgaXMgZHJvcHBlZC4gVGhpcyB3aWxsCmVuc3VyZSB0aGF0
IGl0IGlzIGltcG9zc2libGUgdG8gZHJpdmUgYW5vdGhlciBndWVzdCBwYXN0
IGl0cyBtZW1vcnkKcXVvdGEgYnkgZ2VuZXJhdGluZyBpbnNhbmUgYW1vdW50
cyBvZiBldmVudHMgZm9yIHRoYXQgZ3Vlc3QuIFRoaXMgaXMKZXNwZWNpYWxs
eSBpbXBvcnRhbnQgZm9yIHByb3RlY3RpbmcgZHJpdmVyIGRvbWFpbnMgZnJv
bSB0aGF0IGF0dGFjawp2ZWN0b3IuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMy
NiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4g
R3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBH
cmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMv
eGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9jb3JlLmMKaW5kZXggZjAzYWQ5M2I0Mzg1Li4wMDllYWE4ZTVm
NTMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAt
MjU2LDYgKzI1Niw4IEBAIHN0YXRpYyB2b2lkIGZyZWVfYnVmZmVyZWRfZGF0
YShzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqb3V0LAogCQl9CiAJfQogCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIC1vdXQtPmhkci5tc2cu
bGVuIC0gc2l6ZW9mKG91dC0+aGRyKSk7CisKIAlpZiAob3V0LT5oZHIubXNn
LnR5cGUgPT0gWFNfV0FUQ0hfRVZFTlQpIHsKIAkJcmVxID0gb3V0LT5wZW5k
LnJlcTsKIAkJaWYgKHJlcSkgewpAQCAtOTM0LDExICs5MzYsMTQgQEAgdm9p
ZCBzZW5kX3JlcGx5KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBlbnVtIHhz
ZF9zb2NrbXNnX3R5cGUgdHlwZSwKIAliZGF0YS0+dGltZW91dF9tc2VjID0g
MDsKIAliZGF0YS0+d2F0Y2hfZXZlbnQgPSBmYWxzZTsKIAotCWlmIChsZW4g
PD0gREVGQVVMVF9CVUZGRVJfU0laRSkKKwlpZiAobGVuIDw9IERFRkFVTFRf
QlVGRkVSX1NJWkUpIHsKIAkJYmRhdGEtPmJ1ZmZlciA9IGJkYXRhLT5kZWZh
dWx0X2J1ZmZlcjsKLQllbHNlIHsKKwkJLyogRG9uJ3QgY2hlY2sgcXVvdGEs
IHBhdGggbWlnaHQgYmUgdXNlZCBmb3IgcmV0dXJuaW5nIGVycm9yLiAqLwor
CQlkb21haW5fbWVtb3J5X2FkZF9ub2Noayhjb25uLT5pZCwgbGVuICsgc2l6
ZW9mKGJkYXRhLT5oZHIpKTsKKwl9IGVsc2UgewogCQliZGF0YS0+YnVmZmVy
ID0gdGFsbG9jX2FycmF5KGJkYXRhLCBjaGFyLCBsZW4pOwotCQlpZiAoIWJk
YXRhLT5idWZmZXIpIHsKKwkJaWYgKCFiZGF0YS0+YnVmZmVyIHx8CisJCSAg
ICBkb21haW5fbWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVv
ZihiZGF0YS0+aGRyKSkpIHsKIAkJCXNlbmRfZXJyb3IoY29ubiwgRU5PTUVN
KTsKIAkJCXJldHVybjsKIAkJfQpAQCAtMTAwMyw2ICsxMDA4LDExIEBAIHZv
aWQgc2VuZF9ldmVudChzdHJ1Y3QgYnVmZmVyZWRfZGF0YSAqcmVxLCBzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKIAkJfQogCX0KIAorCWlmIChkb21haW5f
bWVtb3J5X2FkZF9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVvZihiZGF0YS0+
aGRyKSkpIHsKKwkJdGFsbG9jX2ZyZWUoYmRhdGEpOworCQlyZXR1cm47CisJ
fQorCiAJaWYgKHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYyAmJiBkb21haW5f
aXNfdW5wcml2aWxlZ2VkKGNvbm4pKSB7CiAJCWJkYXRhLT50aW1lb3V0X21z
ZWMgPSBnZXRfbm93X21zZWMoKSArIHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNl
YzsKIAkJaWYgKCFjb25uLT50aW1lb3V0X21zZWMpCkBAIC0zMDEyLDYgKzMw
MjIsMTIgQEAgc3RhdGljIHZvaWQgYWRkX2J1ZmZlcmVkX2RhdGEoc3RydWN0
IGJ1ZmZlcmVkX2RhdGEgKmJkYXRhLAogCSAqLwogCWlmIChiZGF0YS0+aGRy
Lm1zZy50eXBlICE9IFhTX1dBVENIX0VWRU5UKQogCQlkb21haW5fb3V0c3Rh
bmRpbmdfaW5jKGNvbm4pOworCS8qCisJICogV2UgYXJlIHJlc3RvcmluZyB0
aGUgc3RhdGUgYWZ0ZXIgTGl2ZS1VcGRhdGUgYW5kIHRoZSBuZXcgcXVvdGEg
bWF5CisJICogYmUgc21hbGxlci4gU28gaWdub3JlIGl0LiBUaGUgbGltaXQg
d2lsbCBiZSBhcHBsaWVkIGZvciBhbnkgcmVzb3VyY2UKKwkgKiBhZnRlciB0
aGUgc3RhdGUgaGFzIGJlZW4gZnVsbHkgcmVzdG9yZWQuCisJICovCisJZG9t
YWluX21lbW9yeV9hZGRfbm9jaGsoY29ubi0+aWQsIGxlbiArIHNpemVvZihi
ZGF0YS0+aGRyKSk7CiB9CiAKIHZvaWQgcmVhZF9zdGF0ZV9idWZmZXJlZF9k
YXRhKGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4s
Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-13.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-13.patch"
Content-Transfer-Encoding: base64

RnJvbSAwZjU3NmYzMzc2YjM4Mjk4MjM0Y2M3NGEzNzJmMGJiMmVhMTg2YTMw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igd2F0Y2hlcwoKQWRkIHRoZSBtZW1vcnkgYWNj
b3VudGluZyBmb3IgcmVnaXN0ZXJlZCB3YXRjaGVzLgoKV2hlbiBhIHNvY2tl
dCBjb25uZWN0aW9uIGlzIGRlc3Ryb3llZCwgdGhlIGFzc29jaWF0ZWQgd2F0
Y2hlcyBhcmUKcmVtb3ZlZCwgdG9vLiBJbiBvcmRlciB0byBrZWVwIG1lbW9y
eSBhY2NvdW50aW5nIGNvcnJlY3QgdGhlIHdhdGNoZXMKbXVzdCBiZSByZW1v
dmVkIGV4cGxpY2l0bHkgdmlhIGEgY2FsbCBvZiBjb25uX2RlbGV0ZV9hbGxf
d2F0Y2hlcygpIGZyb20KZGVzdHJveV9jb25uKCkuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTMyNiAvIENWRS0yMDIyLTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1
bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKaW5kZXggMDA5ZWFhOGU1ZjUzLi4x
YTViYTRhYmE4MzkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0
b3JlZF9jb3JlLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwpAQCAtNDU5LDYgKzQ1OSw3IEBAIHN0YXRpYyBpbnQgZGVzdHJveV9j
b25uKHZvaWQgKl9jb25uKQogCX0KIAogCWNvbm5fZnJlZV9idWZmZXJlZF9k
YXRhKGNvbm4pOworCWNvbm5fZGVsZXRlX2FsbF93YXRjaGVzKGNvbm4pOwog
CWxpc3RfZm9yX2VhY2hfZW50cnkocmVxLCAmY29ubi0+cmVmX2xpc3QsIGxp
c3QpCiAJCXJlcS0+b25fcmVmX2xpc3QgPSBmYWxzZTsKIApkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfd2F0Y2guYwppbmRleCAwNzU1ZmZhMzc1YmEu
LmZkZjliMmQ2NTNhMCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX3dhdGNoLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVk
X3dhdGNoLmMKQEAgLTIxMSw3ICsyMTEsNyBAQCBzdGF0aWMgaW50IGNoZWNr
X3dhdGNoX3BhdGgoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZv
aWQgKmN0eCwKIH0KIAogc3RhdGljIHN0cnVjdCB3YXRjaCAqYWRkX3dhdGNo
KHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjaGFyICpwYXRoLCBjaGFyICp0
b2tlbiwKLQkJCSAgICAgICBib29sIHJlbGF0aXZlKQorCQkJICAgICAgIGJv
b2wgcmVsYXRpdmUsIGJvb2wgbm9fcXVvdGFfY2hlY2spCiB7CiAJc3RydWN0
IHdhdGNoICp3YXRjaDsKIApAQCAtMjIyLDYgKzIyMiw5IEBAIHN0YXRpYyBz
dHJ1Y3Qgd2F0Y2ggKmFkZF93YXRjaChzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgY2hhciAqcGF0aCwgY2hhciAqdG9rZW4sCiAJd2F0Y2gtPnRva2VuID0g
dGFsbG9jX3N0cmR1cCh3YXRjaCwgdG9rZW4pOwogCWlmICghd2F0Y2gtPm5v
ZGUgfHwgIXdhdGNoLT50b2tlbikKIAkJZ290byBub21lbTsKKwlpZiAoZG9t
YWluX21lbW9yeV9hZGQoY29ubi0+aWQsIHN0cmxlbihwYXRoKSArIHN0cmxl
bih0b2tlbiksCisJCQkgICAgICBub19xdW90YV9jaGVjaykpCisJCWdvdG8g
bm9tZW07CiAKIAlpZiAocmVsYXRpdmUpCiAJCXdhdGNoLT5yZWxhdGl2ZV9w
YXRoID0gZ2V0X2ltcGxpY2l0X3BhdGgoY29ubik7CkBAIC0yNjUsNyArMjY4
LDcgQEAgaW50IGRvX3dhdGNoKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBz
dHJ1Y3QgYnVmZmVyZWRfZGF0YSAqaW4pCiAJaWYgKGRvbWFpbl93YXRjaChj
b25uKSA+IHF1b3RhX25iX3dhdGNoX3Blcl9kb21haW4pCiAJCXJldHVybiBF
MkJJRzsKIAotCXdhdGNoID0gYWRkX3dhdGNoKGNvbm4sIHZlY1swXSwgdmVj
WzFdLCByZWxhdGl2ZSk7CisJd2F0Y2ggPSBhZGRfd2F0Y2goY29ubiwgdmVj
WzBdLCB2ZWNbMV0sIHJlbGF0aXZlLCBmYWxzZSk7CiAJaWYgKCF3YXRjaCkK
IAkJcmV0dXJuIGVycm5vOwogCkBAIC0yOTYsNiArMjk5LDggQEAgaW50IGRv
X3Vud2F0Y2goc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZm
ZXJlZF9kYXRhICppbikKIAlsaXN0X2Zvcl9lYWNoX2VudHJ5KHdhdGNoLCAm
Y29ubi0+d2F0Y2hlcywgbGlzdCkgewogCQlpZiAoc3RyZXEod2F0Y2gtPm5v
ZGUsIG5vZGUpICYmIHN0cmVxKHdhdGNoLT50b2tlbiwgdmVjWzFdKSkgewog
CQkJbGlzdF9kZWwoJndhdGNoLT5saXN0KTsKKwkJCWRvbWFpbl9tZW1vcnlf
YWRkX25vY2hrKGNvbm4tPmlkLCAtc3RybGVuKHdhdGNoLT5ub2RlKSAtCisJ
CQkJCQkJICBzdHJsZW4od2F0Y2gtPnRva2VuKSk7CiAJCQl0YWxsb2NfZnJl
ZSh3YXRjaCk7CiAJCQlkb21haW5fd2F0Y2hfZGVjKGNvbm4pOwogCQkJc2Vu
ZF9hY2soY29ubiwgWFNfVU5XQVRDSCk7CkBAIC0zMTEsNiArMzE2LDggQEAg
dm9pZCBjb25uX2RlbGV0ZV9hbGxfd2F0Y2hlcyhzdHJ1Y3QgY29ubmVjdGlv
biAqY29ubikKIAogCXdoaWxlICgod2F0Y2ggPSBsaXN0X3RvcCgmY29ubi0+
d2F0Y2hlcywgc3RydWN0IHdhdGNoLCBsaXN0KSkpIHsKIAkJbGlzdF9kZWwo
JndhdGNoLT5saXN0KTsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsoY29u
bi0+aWQsIC1zdHJsZW4od2F0Y2gtPm5vZGUpIC0KKwkJCQkJCSAgc3RybGVu
KHdhdGNoLT50b2tlbikpOwogCQl0YWxsb2NfZnJlZSh3YXRjaCk7CiAJCWRv
bWFpbl93YXRjaF9kZWMoY29ubik7CiAJfQpAQCAtMzczLDcgKzM4MCw3IEBA
IHZvaWQgcmVhZF9zdGF0ZV93YXRjaChjb25zdCB2b2lkICpjdHgsIGNvbnN0
IHZvaWQgKnN0YXRlKQogCWlmICghcGF0aCkKIAkJYmFyZigiYWxsb2NhdGlv
biBlcnJvciBmb3IgcmVhZCB3YXRjaCIpOwogCi0JaWYgKCFhZGRfd2F0Y2go
Y29ubiwgcGF0aCwgdG9rZW4sIHJlbGF0aXZlKSkKKwlpZiAoIWFkZF93YXRj
aChjb25uLCBwYXRoLCB0b2tlbiwgcmVsYXRpdmUsIHRydWUpKQogCQliYXJm
KCJlcnJvciBhZGRpbmcgd2F0Y2giKTsKIH0KIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-14.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-14.patch"
Content-Transfer-Encoding: base64

RnJvbSAzYzlkZTAxODA3ZTIzZmU3ZDExZmJmMGNhYjY0ZjQyNzRkMjYwZTkx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBtZW1v
cnkgYWNjb3VudGluZyBmb3Igbm9kZXMKCkFkZCB0aGUgbWVtb3J5IGFjY291
bnRpbmcgZm9yIFhlbnN0b3JlIG5vZGVzLiBJbiBvcmRlciB0byBtYWtlIHRo
aXMKbm90IHRvbyBjb21wbGljYXRlZCBhbGxvdyBmb3Igc29tZSBzbG9wcGlu
ZXNzIHdoZW4gd3JpdGluZyBub2Rlcy4gQW55CmhhcmQgcXVvdGEgdmlvbGF0
aW9uIHdpbGwgcmVzdWx0IGluIG5vIGZ1cnRoZXIgcmVxdWVzdHMgdG8gYmUg
YWNjZXB0ZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNiAvIENWRS0yMDIy
LTQyMzE1LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFt
YXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9z
c0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxs
QGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuYyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmMKaW5kZXggMWE1YmE0YWJhODM5Li5mN2YxZTAwYzcxNWIgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpAQCAtNTg3LDYgKzU4Nywx
MTcgQEAgdm9pZCBzZXRfdGRiX2tleShjb25zdCBjaGFyICpuYW1lLCBUREJf
REFUQSAqa2V5KQogCWtleS0+ZHNpemUgPSBzdHJsZW4obmFtZSk7CiB9CiAK
K3N0YXRpYyB2b2lkIGdldF9hY2NfZGF0YShUREJfREFUQSAqa2V5LCBzdHJ1
Y3Qgbm9kZV9hY2NvdW50X2RhdGEgKmFjYykKK3sKKwlUREJfREFUQSBvbGRf
ZGF0YTsKKwlzdHJ1Y3QgeHNfdGRiX3JlY29yZF9oZHIgKmhkcjsKKworCWlm
IChhY2MtPm1lbW9yeSA8IDApIHsKKwkJb2xkX2RhdGEgPSB0ZGJfZmV0Y2go
dGRiX2N0eCwgKmtleSk7CisJCS8qIE5vIGNoZWNrIGZvciBlcnJvciwgYXMg
dGhlIG5vZGUgbWlnaHQgbm90IGV4aXN0LiAqLworCQlpZiAob2xkX2RhdGEu
ZHB0ciA9PSBOVUxMKSB7CisJCQlhY2MtPm1lbW9yeSA9IDA7CisJCX0gZWxz
ZSB7CisJCQloZHIgPSAodm9pZCAqKW9sZF9kYXRhLmRwdHI7CisJCQlhY2Mt
Pm1lbW9yeSA9IG9sZF9kYXRhLmRzaXplOworCQkJYWNjLT5kb21pZCA9IGhk
ci0+cGVybXNbMF0uaWQ7CisJCX0KKwkJdGFsbG9jX2ZyZWUob2xkX2RhdGEu
ZHB0cik7CisJfQorfQorCisvKgorICogUGVyLXRyYW5zYWN0aW9uIG5vZGVz
IG5lZWQgdG8gYmUgYWNjb3VudGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gb3du
ZXIuCisgKiBUaG9zZSBub2RlcyBhcmUgc3RvcmVkIGluIHRoZSBkYXRhIGJh
c2Ugd2l0aCB0aGUgdHJhbnNhY3Rpb24gZ2VuZXJhdGlvbgorICogY291bnQg
cHJlcGVuZGVkIChlLmcuIDEyMy9sb2NhbC9kb21haW4vLi4uKS4gU28gdGVz
dGluZyBmb3IgdGhlIG5vZGUncworICoga2V5IG5vdCB0byBzdGFydCB3aXRo
ICIvIiBpcyBzdWZmaWNpZW50LgorICovCitzdGF0aWMgdW5zaWduZWQgaW50
IGdldF9hY2NfZG9taWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9E
QVRBICprZXksCisJCQkJICB1bnNpZ25lZCBpbnQgZG9taWQpCit7CisJcmV0
dXJuICghY29ubiB8fCBrZXktPmRwdHJbMF0gPT0gJy8nKSA/IGRvbWlkIDog
Y29ubi0+aWQ7Cit9CisKK2ludCBkb190ZGJfd3JpdGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFREQl9EQVRBICpkYXRhLAor
CQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MsIGJvb2wgbm9fcXVv
dGFfY2hlY2spCit7CisJc3RydWN0IHhzX3RkYl9yZWNvcmRfaGRyICpoZHIg
PSAodm9pZCAqKWRhdGEtPmRwdHI7CisJc3RydWN0IG5vZGVfYWNjb3VudF9k
YXRhIG9sZF9hY2MgPSB7fTsKKwl1bnNpZ25lZCBpbnQgb2xkX2RvbWlkLCBu
ZXdfZG9taWQ7CisJaW50IHJldDsKKworCWlmICghYWNjKQorCQlvbGRfYWNj
Lm1lbW9yeSA9IC0xOworCWVsc2UKKwkJb2xkX2FjYyA9ICphY2M7CisKKwln
ZXRfYWNjX2RhdGEoa2V5LCAmb2xkX2FjYyk7CisJb2xkX2RvbWlkID0gZ2V0
X2FjY19kb21pZChjb25uLCBrZXksIG9sZF9hY2MuZG9taWQpOworCW5ld19k
b21pZCA9IGdldF9hY2NfZG9taWQoY29ubiwga2V5LCBoZHItPnBlcm1zWzBd
LmlkKTsKKworCS8qCisJICogRG9uJ3QgY2hlY2sgZm9yIEVOT0VOVCwgYXMg
d2Ugd2FudCB0byBiZSBhYmxlIHRvIHN3aXRjaCBvcnBoYW5lZAorCSAqIG5v
ZGVzIHRvIG5ldyBvd25lcnMuCisJICovCisJaWYgKG9sZF9hY2MubWVtb3J5
KQorCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRfZG9taWQsCisJCQkJ
CS1vbGRfYWNjLm1lbW9yeSAtIGtleS0+ZHNpemUpOworCXJldCA9IGRvbWFp
bl9tZW1vcnlfYWRkKG5ld19kb21pZCwgZGF0YS0+ZHNpemUgKyBrZXktPmRz
aXplLAorCQkJCW5vX3F1b3RhX2NoZWNrKTsKKwlpZiAocmV0KSB7CisJCS8q
IEVycm9yIHBhdGgsIHNvIG5vIHF1b3RhIGNoZWNrLiAqLworCQlpZiAob2xk
X2FjYy5tZW1vcnkpCisJCQlkb21haW5fbWVtb3J5X2FkZF9ub2NoayhvbGRf
ZG9taWQsCisJCQkJCQlvbGRfYWNjLm1lbW9yeSArIGtleS0+ZHNpemUpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCS8qIFREQiBzaG91bGQgc2V0IGVycm5v
LCBidXQgZG9lc24ndCBldmVuIHNldCBlY29kZSBBRkFJQ1QuICovCisJaWYg
KHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCAqZGF0YSwgVERCX1JFUExBQ0Up
ICE9IDApIHsKKwkJZG9tYWluX21lbW9yeV9hZGRfbm9jaGsobmV3X2RvbWlk
LCAtZGF0YS0+ZHNpemUgLSBrZXktPmRzaXplKTsKKwkJLyogRXJyb3IgcGF0
aCwgc28gbm8gcXVvdGEgY2hlY2suICovCisJCWlmIChvbGRfYWNjLm1lbW9y
eSkKKwkJCWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKG9sZF9kb21pZCwKKwkJ
CQkJCW9sZF9hY2MubWVtb3J5ICsga2V5LT5kc2l6ZSk7CisJCWVycm5vID0g
RUlPOworCQlyZXR1cm4gZXJybm87CisJfQorCisJaWYgKGFjYykgeworCQkv
KiBEb24ndCB1c2UgbmV3X2RvbWlkLCBhcyBpdCBtaWdodCBiZSBhIHRyYW5z
YWN0aW9uIG5vZGUuICovCisJCWFjYy0+ZG9taWQgPSBoZHItPnBlcm1zWzBd
LmlkOworCQlhY2MtPm1lbW9yeSA9IGRhdGEtPmRzaXplOworCX0KKworCXJl
dHVybiAwOworfQorCitpbnQgZG9fdGRiX2RlbGV0ZShzdHJ1Y3QgY29ubmVj
dGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwKKwkJICBzdHJ1Y3Qgbm9kZV9h
Y2NvdW50X2RhdGEgKmFjYykKK3sKKwlzdHJ1Y3Qgbm9kZV9hY2NvdW50X2Rh
dGEgdG1wX2FjYzsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisKKwlpZiAoIWFj
YykgeworCQlhY2MgPSAmdG1wX2FjYzsKKwkJYWNjLT5tZW1vcnkgPSAtMTsK
Kwl9CisKKwlnZXRfYWNjX2RhdGEoa2V5LCBhY2MpOworCisJaWYgKHRkYl9k
ZWxldGUodGRiX2N0eCwgKmtleSkpIHsKKwkJZXJybm8gPSBFSU87CisJCXJl
dHVybiBlcnJubzsKKwl9CisKKwlpZiAoYWNjLT5tZW1vcnkpIHsKKwkJZG9t
aWQgPSBnZXRfYWNjX2RvbWlkKGNvbm4sIGtleSwgYWNjLT5kb21pZCk7CisJ
CWRvbWFpbl9tZW1vcnlfYWRkX25vY2hrKGRvbWlkLCAtYWNjLT5tZW1vcnkg
LSBrZXktPmRzaXplKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwogLyoKICAq
IElmIGl0IGZhaWxzLCByZXR1cm5zIE5VTEwgYW5kIHNldHMgZXJybm8uCiAg
KiBUZW1wb3JhcnkgbWVtb3J5IGFsbG9jYXRpb25zIHdpbGwgYmUgZG9uZSB3
aXRoIGN0eC4KQEAgLTY0MCw5ICs3NTEsMTUgQEAgc3RydWN0IG5vZGUgKnJl
YWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAq
Y3R4LAogCiAJLyogUGVybWlzc2lvbnMgYXJlIHN0cnVjdCB4c19wZXJtaXNz
aW9ucy4gKi8KIAlub2RlLT5wZXJtcy5wID0gaGRyLT5wZXJtczsKKwlub2Rl
LT5hY2MuZG9taWQgPSBub2RlLT5wZXJtcy5wWzBdLmlkOworCW5vZGUtPmFj
Yy5tZW1vcnkgPSBkYXRhLmRzaXplOwogCWlmIChkb21haW5fYWRqdXN0X25v
ZGVfcGVybXMoY29ubiwgbm9kZSkpCiAJCWdvdG8gZXJyb3I7CiAKKwkvKiBJ
ZiBvd25lciBpcyBnb25lIHJlc2V0IGN1cnJlbnRseSBhY2NvdW50ZWQgbWVt
b3J5IHNpemUuICovCisJaWYgKG5vZGUtPmFjYy5kb21pZCAhPSBub2RlLT5w
ZXJtcy5wWzBdLmlkKQorCQlub2RlLT5hY2MubWVtb3J5ID0gMDsKKwogCS8q
IERhdGEgaXMgYmluYXJ5IGJsb2IgKHVzdWFsbHkgYXNjaWksIG5vIG51bCku
ICovCiAJbm9kZS0+ZGF0YSA9IG5vZGUtPnBlcm1zLnAgKyBoZHItPm51bV9w
ZXJtczsKIAkvKiBDaGlsZHJlbiBpcyBzdHJpbmdzLCBudWwgc2VwYXJhdGVk
LiAqLwpAQCAtNzExLDEyICs4MjgsOSBAQCBpbnQgd3JpdGVfbm9kZV9yYXco
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIHN0cnVj
dCBub2RlICpub2RlLAogCXAgKz0gbm9kZS0+ZGF0YWxlbjsKIAltZW1jcHko
cCwgbm9kZS0+Y2hpbGRyZW4sIG5vZGUtPmNoaWxkbGVuKTsKIAotCS8qIFRE
QiBzaG91bGQgc2V0IGVycm5vLCBidXQgZG9lc24ndCBldmVuIHNldCBlY29k
ZSBBRkFJQ1QuICovCi0JaWYgKHRkYl9zdG9yZSh0ZGJfY3R4LCAqa2V5LCBk
YXRhLCBUREJfUkVQTEFDRSkgIT0gMCkgewotCQljb3JydXB0KGNvbm4sICJX
cml0ZSBvZiAlcyBmYWlsZWQiLCBrZXktPmRwdHIpOwotCQllcnJubyA9IEVJ
TzsKLQkJcmV0dXJuIGVycm5vOwotCX0KKwlpZiAoZG9fdGRiX3dyaXRlKGNv
bm4sIGtleSwgJmRhdGEsICZub2RlLT5hY2MsIG5vX3F1b3RhX2NoZWNrKSkK
KwkJcmV0dXJuIEVJTzsKKwogCXJldHVybiAwOwogfQogCkBAIC0xMjE4LDcg
KzEzMzIsNyBAQCBzdGF0aWMgdm9pZCBkZWxldGVfbm9kZV9zaW5nbGUoc3Ry
dWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogCWlm
IChhY2Nlc3Nfbm9kZShjb25uLCBub2RlLCBOT0RFX0FDQ0VTU19ERUxFVEUs
ICZrZXkpKQogCQlyZXR1cm47CiAKLQlpZiAodGRiX2RlbGV0ZSh0ZGJfY3R4
LCBrZXkpICE9IDApIHsKKwlpZiAoZG9fdGRiX2RlbGV0ZShjb25uLCAma2V5
LCAmbm9kZS0+YWNjKSAhPSAwKSB7CiAJCWNvcnJ1cHQoY29ubiwgIkNvdWxk
IG5vdCBkZWxldGUgJyVzJyIsIG5vZGUtPm5hbWUpOwogCQlyZXR1cm47CiAJ
fQpAQCAtMTI5MSw2ICsxNDA1LDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpj
b25zdHJ1Y3Rfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qg
dm9pZCAqY3R4LAogCS8qIE5vIGNoaWxkcmVuLCBubyBkYXRhICovCiAJbm9k
ZS0+Y2hpbGRyZW4gPSBub2RlLT5kYXRhID0gTlVMTDsKIAlub2RlLT5jaGls
ZGxlbiA9IG5vZGUtPmRhdGFsZW4gPSAwOworCW5vZGUtPmFjYy5tZW1vcnkg
PSAwOwogCW5vZGUtPnBhcmVudCA9IHBhcmVudDsKIAlyZXR1cm4gbm9kZTsK
IApAQCAtMTI5OSwxNyArMTQxNCwxNyBAQCBzdGF0aWMgc3RydWN0IG5vZGUg
KmNvbnN0cnVjdF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRpYyB2b2lk
IGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3Qgbm9kZSAqbm9kZSkKK3N0YXRpYyB2
b2lkIGRlc3Ryb3lfbm9kZV9ybShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwg
c3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJaWYgKHN0cmVxKG5vZGUtPm5hbWUs
ICIvIikpCiAJCWNvcnJ1cHQoTlVMTCwgIkRlc3Ryb3lpbmcgcm9vdCBub2Rl
ISIpOwogCi0JdGRiX2RlbGV0ZSh0ZGJfY3R4LCBub2RlLT5rZXkpOworCWRv
X3RkYl9kZWxldGUoY29ubiwgJm5vZGUtPmtleSwgJm5vZGUtPmFjYyk7CiB9
CiAKIHN0YXRpYyBpbnQgZGVzdHJveV9ub2RlKHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKLQlkZXN0cm95X25vZGVf
cm0obm9kZSk7CisJZGVzdHJveV9ub2RlX3JtKGNvbm4sIG5vZGUpOwogCWRv
bWFpbl9lbnRyeV9kZWMoY29ubiwgbm9kZSk7CiAKIAkvKgpAQCAtMTM2MSw3
ICsxNDc2LDcgQEAgc3RhdGljIHN0cnVjdCBub2RlICpjcmVhdGVfbm9kZShz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9pZCAqY3R4LAogCQkv
KiBBY2NvdW50IGZvciBuZXcgbm9kZSAqLwogCQlpZiAoaS0+cGFyZW50KSB7
CiAJCQlpZiAoZG9tYWluX2VudHJ5X2luYyhjb25uLCBpKSkgewotCQkJCWRl
c3Ryb3lfbm9kZV9ybShpKTsKKwkJCQlkZXN0cm95X25vZGVfcm0oY29ubiwg
aSk7CiAJCQkJcmV0dXJuIE5VTEw7CiAJCQl9CiAJCX0KQEAgLTIyNzAsNyAr
MjM4NSw3IEBAIHN0YXRpYyBpbnQgY2xlYW5fc3RvcmVfKFREQl9DT05URVhU
ICp0ZGIsIFREQl9EQVRBIGtleSwgVERCX0RBVEEgdmFsLAogCWlmICghaGFz
aHRhYmxlX3NlYXJjaChyZWFjaGFibGUsIG5hbWUpKSB7CiAJCWxvZygiY2xl
YW5fc3RvcmU6ICclcycgaXMgb3JwaGFuZWQhIiwgbmFtZSk7CiAJCWlmIChy
ZWNvdmVyeSkgewotCQkJdGRiX2RlbGV0ZSh0ZGIsIGtleSk7CisJCQlkb190
ZGJfZGVsZXRlKE5VTEwsICZrZXksIE5VTEwpOwogCQl9CiAJfQogCkBAIC0z
MTIyLDYgKzMyMzcsNyBAQCB2b2lkIHJlYWRfc3RhdGVfbm9kZShjb25zdCB2
b2lkICpjdHgsIGNvbnN0IHZvaWQgKnN0YXRlKQogCWlmICghbm9kZSkKIAkJ
YmFyZigiYWxsb2NhdGlvbiBlcnJvciByZXN0b3Jpbmcgbm9kZSIpOwogCisJ
bm9kZS0+YWNjLm1lbW9yeSA9IDA7CiAJbm9kZS0+bmFtZSA9IG5hbWU7CiAJ
bm9kZS0+Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAlub2RlLT5kYXRh
bGVuID0gc24tPmRhdGFfbGVuOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggZWM1MmQ4ZDNmZjAzLi4wMzFhODIxMzU4NmMgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMTc2LDYg
KzE3NiwxMSBAQCBzdHJ1Y3Qgbm9kZV9wZXJtcyB7CiAJc3RydWN0IHhzX3Bl
cm1pc3Npb25zICpwOwogfTsKIAorc3RydWN0IG5vZGVfYWNjb3VudF9kYXRh
IHsKKwl1bnNpZ25lZCBpbnQgZG9taWQ7CisJaW50IG1lbW9yeTsJCS8qIC0x
IGlmIHVua25vd24gKi8KK307CisKIHN0cnVjdCBub2RlIHsKIAljb25zdCBj
aGFyICpuYW1lOwogCS8qIEtleSB1c2VkIHRvIHVwZGF0ZSBUREIgKi8KQEAg
LTE5OCw2ICsyMDMsOSBAQCBzdHJ1Y3Qgbm9kZSB7CiAJLyogQ2hpbGRyZW4s
IGVhY2ggbnVsLXRlcm1pbmF0ZWQuICovCiAJdW5zaWduZWQgaW50IGNoaWxk
bGVuOwogCWNoYXIgKmNoaWxkcmVuOworCisJLyogQWxsb2NhdGlvbiBpbmZv
cm1hdGlvbiBmb3Igbm9kZSBjdXJyZW50bHkgaW4gc3RvcmUuICovCisJc3Ry
dWN0IG5vZGVfYWNjb3VudF9kYXRhIGFjYzsKIH07CiAKIC8qIFJldHVybiB0
aGUgb25seSBhcmd1bWVudCBpbiB0aGUgaW5wdXQuICovCkBAIC0zMDEsNiAr
MzA5LDEwIEBAIGV4dGVybiB4ZW5nbnR0YWJfaGFuZGxlICoqeGd0X2hhbmRs
ZTsKIGludCByZW1lbWJlcl9zdHJpbmcoc3RydWN0IGhhc2h0YWJsZSAqaGFz
aCwgY29uc3QgY2hhciAqc3RyKTsKIAogdm9pZCBzZXRfdGRiX2tleShjb25z
dCBjaGFyICpuYW1lLCBUREJfREFUQSAqa2V5KTsKK2ludCBkb190ZGJfd3Jp
dGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksIFRE
Ql9EQVRBICpkYXRhLAorCQkgc3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICph
Y2MsIGJvb2wgbm9fcXVvdGFfY2hlY2spOworaW50IGRvX3RkYl9kZWxldGUo
c3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIFREQl9EQVRBICprZXksCisJCSAg
c3RydWN0IG5vZGVfYWNjb3VudF9kYXRhICphY2MpOwogCiB2b2lkIGNvbm5f
ZnJlZV9idWZmZXJlZF9kYXRhKHN0cnVjdCBjb25uZWN0aW9uICpjb25uKTsK
IApkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5z
YWN0aW9uLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rp
b24uYwppbmRleCA3YmQ0MWViNDc1ZTMuLmFjZTlhMTFkNzdiYiAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMK
KysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3RyYW5zYWN0aW9uLmMK
QEAgLTE1Myw2ICsxNTMsOSBAQCBzdHJ1Y3QgdHJhbnNhY3Rpb24KIAkvKiBM
aXN0IG9mIGFsbCB0cmFuc2FjdGlvbnMgYWN0aXZlIG9uIHRoaXMgY29ubmVj
dGlvbi4gKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7CiAKKwkvKiBDb25u
ZWN0aW9uIHRoaXMgdHJhbnNhY3Rpb24gaXMgYXNzb2NpYXRlZCB3aXRoLiAq
LworCXN0cnVjdCBjb25uZWN0aW9uICpjb25uOworCiAJLyogQ29ubmVjdGlv
bi1sb2NhbCBpZGVudGlmaWVyIGZvciB0aGlzIHRyYW5zYWN0aW9uLiAqLwog
CXVpbnQzMl90IGlkOwogCkBAIC0yODYsNiArMjg5LDggQEAgaW50IGFjY2Vz
c19ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAq
bm9kZSwKIAogCQlpbnRyb2R1Y2UgPSB0cnVlOwogCQlpLT50YV9ub2RlID0g
ZmFsc2U7CisJCS8qIGFjYy5tZW1vcnkgPCAwIG1lYW5zICJ1bmtub3duLCBn
ZXQgc2l6ZSBmcm9tIFREQiIuICovCisJCW5vZGUtPmFjYy5tZW1vcnkgPSAt
MTsKIAogCQkvKgogCQkgKiBBZGRpdGlvbmFsIHRyYW5zYWN0aW9uLXNwZWNp
ZmljIG5vZGUgZm9yIHJlYWQgdHlwZS4gV2Ugb25seQpAQCAtNDEwLDExICs0
MTUsMTEgQEAgc3RhdGljIGludCBmaW5hbGl6ZV90cmFuc2FjdGlvbihzdHJ1
Y3QgY29ubmVjdGlvbiAqY29ubiwKIAkJCQkJZ290byBlcnI7CiAJCQkJaGRy
ID0gKHZvaWQgKilkYXRhLmRwdHI7CiAJCQkJaGRyLT5nZW5lcmF0aW9uID0g
KytnZW5lcmF0aW9uOwotCQkJCXJldCA9IHRkYl9zdG9yZSh0ZGJfY3R4LCBr
ZXksIGRhdGEsCi0JCQkJCQlUREJfUkVQTEFDRSk7CisJCQkJcmV0ID0gZG9f
dGRiX3dyaXRlKGNvbm4sICZrZXksICZkYXRhLCBOVUxMLAorCQkJCQkJICAg
dHJ1ZSk7CiAJCQkJdGFsbG9jX2ZyZWUoZGF0YS5kcHRyKTsKIAkJCX0gZWxz
ZSB7Ci0JCQkJcmV0ID0gdGRiX2RlbGV0ZSh0ZGJfY3R4LCBrZXkpOworCQkJ
CXJldCA9IGRvX3RkYl9kZWxldGUoY29ubiwgJmtleSwgTlVMTCk7CiAJCQl9
CiAJCQlpZiAocmV0KQogCQkJCWdvdG8gZXJyOwpAQCAtNDI1LDcgKzQzMCw3
IEBAIHN0YXRpYyBpbnQgZmluYWxpemVfdHJhbnNhY3Rpb24oc3RydWN0IGNv
bm5lY3Rpb24gKmNvbm4sCiAJCQl9CiAJCX0KIAotCQlpZiAoaS0+dGFfbm9k
ZSAmJiB0ZGJfZGVsZXRlKHRkYl9jdHgsIHRhX2tleSkpCisJCWlmIChpLT50
YV9ub2RlICYmIGRvX3RkYl9kZWxldGUoY29ubiwgJnRhX2tleSwgTlVMTCkp
CiAJCQlnb3RvIGVycjsKIAkJbGlzdF9kZWwoJmktPmxpc3QpOwogCQl0YWxs
b2NfZnJlZShpKTsKQEAgLTQ1Myw3ICs0NTgsNyBAQCBzdGF0aWMgaW50IGRl
c3Ryb3lfdHJhbnNhY3Rpb24odm9pZCAqX3RyYW5zYWN0aW9uKQogCQkJCQkJ
CSAgICAgICBpLT5ub2RlKTsKIAkJCWlmICh0cmFuc19uYW1lKSB7CiAJCQkJ
c2V0X3RkYl9rZXkodHJhbnNfbmFtZSwgJmtleSk7Ci0JCQkJdGRiX2RlbGV0
ZSh0ZGJfY3R4LCBrZXkpOworCQkJCWRvX3RkYl9kZWxldGUodHJhbnMtPmNv
bm4sICZrZXksIE5VTEwpOwogCQkJfQogCQl9CiAJCWxpc3RfZGVsKCZpLT5s
aXN0KTsKQEAgLTQ5Nyw2ICs1MDIsNyBAQCBpbnQgZG9fdHJhbnNhY3Rpb25f
c3RhcnQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBidWZmZXJl
ZF9kYXRhICppbikKIAogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+YWNjZXNz
ZWQpOwogCUlOSVRfTElTVF9IRUFEKCZ0cmFucy0+Y2hhbmdlZF9kb21haW5z
KTsKKwl0cmFucy0+Y29ubiA9IGNvbm47CiAJdHJhbnMtPmZhaWwgPSBmYWxz
ZTsKIAl0cmFucy0+Z2VuZXJhdGlvbiA9ICsrZ2VuZXJhdGlvbjsKIAo=

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-15.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-15.patch"
Content-Transfer-Encoding: base64

RnJvbSAxMjY4YjgxMzA5OTI4ZThmNTlhNTM1OGM4ZDBiMGI1MDA3NGI1ZWVm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBleHBv
cnRzIGZvciBxdW90YSB2YXJpYWJsZXMKClNvbWUgcXVvdGEgdmFyaWFibGVz
IGFyZSBub3QgZXhwb3J0ZWQgdmlhIGhlYWRlciBmaWxlcy4KClRoaXMgaXMg
cGFydCBvZiBYU0EtMzI2LgoKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3Jl
ZF9jb3JlLmgKaW5kZXggMDMxYTgyMTM1ODZjLi5mN2MzN2ZlM2I1NjUgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjczLDYg
KzI3MywxMSBAQCBleHRlcm4gVERCX0NPTlRFWFQgKnRkYl9jdHg7CiBleHRl
cm4gaW50IGRvbTBfZG9taWQ7CiBleHRlcm4gaW50IGRvbTBfZXZlbnQ7CiBl
eHRlcm4gaW50IHByaXZfZG9taWQ7CitleHRlcm4gaW50IHF1b3RhX25iX3dh
dGNoX3Blcl9kb21haW47CitleHRlcm4gaW50IHF1b3RhX21heF90cmFuc2Fj
dGlvbjsKK2V4dGVybiBpbnQgcXVvdGFfbWF4X2VudHJ5X3NpemU7CitleHRl
cm4gaW50IHF1b3RhX25iX3Blcm1zX3Blcl9ub2RlOworZXh0ZXJuIGludCBx
dW90YV9tYXhfcGF0aF9sZW47CiBleHRlcm4gaW50IHF1b3RhX25iX2VudHJ5
X3Blcl9kb21haW47CiBleHRlcm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGlu
ZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CmRpZmYgLS1naXQg
YS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYyBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF90cmFuc2FjdGlvbi5jCmluZGV4IGFj
ZTlhMTFkNzdiYi4uMjg3NzQ4MTNkZTgzIDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfdHJhbnNhY3Rpb24uYwpAQCAtMTc1LDcgKzE3
NSw2IEBAIHN0cnVjdCB0cmFuc2FjdGlvbgogCWJvb2wgZmFpbDsKIH07CiAK
LWV4dGVybiBpbnQgcXVvdGFfbWF4X3RyYW5zYWN0aW9uOwogdWludDY0X3Qg
Z2VuZXJhdGlvbjsKIAogc3RhdGljIHN0cnVjdCBhY2Nlc3NlZF9ub2RlICpm
aW5kX2FjY2Vzc2VkX25vZGUoc3RydWN0IHRyYW5zYWN0aW9uICp0cmFucywK
ZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF93YXRjaC5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX3dhdGNoLmMKaW5kZXggZmRm
OWIyZDY1M2EwLi44NTM2MmJjY2UzMTQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hl
bnN0b3JlL3hlbnN0b3JlZF93YXRjaC5jCisrKyBiL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF93YXRjaC5jCkBAIC0zMSw4ICszMSw2IEBACiAjaW5jbHVk
ZSAieGVuc3RvcmVkX2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90
cmFuc2FjdGlvbi5oIgogCi1leHRlcm4gaW50IHF1b3RhX25iX3dhdGNoX3Bl
cl9kb21haW47Ci0KIHN0cnVjdCB3YXRjaAogewogCS8qIFdhdGNoZXMgb24g
dGhpcyBjb25uZWN0aW9uICovCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa326/xsa326-xenstored-16.patch"
Content-Disposition: attachment; filename="xsa326/xsa326-xenstored-16.patch"
Content-Transfer-Encoding: base64

RnJvbSBlOTAyOTQ2ZmIwZTQzMmI0Y2JiNThmMmU5OWFiNTYyZmUxMDBiZDc1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTAgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IGFkZCBjb250
cm9sIGNvbW1hbmQgZm9yIHNldHRpbmcgYW5kIHNob3dpbmcgcXVvdGEKCkFk
ZCBhIHhlbnN0b3JlLWNvbnRyb2wgY29tbWFuZCAicXVvdGEiIHRvOgotIHNo
b3cgY3VycmVudCBxdW90YSBzZXR0aW5ncwotIGNoYW5nZSBxdW90YSBzZXR0
aW5ncwotIHNob3cgY3VycmVudCBxdW90YSByZWxhdGVkIHZhbHVlcyBvZiBh
IGRvbWFpbgoKTm90ZSB0aGF0IGluIHRoZSBjYXNlIHRoZSBuZXcgcXVvdGEg
aXMgbG93ZXIgdGhhbiBleGlzdGluZyBvbmUsClhlbnN0b3JlZCBtYXkgY29u
dGludWUgdG8gaGFuZGxlIHJlcXVlc3RzIGZyb20gYSBkb21haW4gZXhjZWVk
aW5nIHRoZQpuZXcgbGltaXQgKGRlcGVuZHMgb24gd2hpY2ggb25lIGhhcyBi
ZWVuIGJyb2tlbikgYW5kIHRoZSBhbW91bnQgb2YKcmVzb3VyY2UgdXNlZCB3
aWxsIG5vdCBjaGFuZ2UuIEhvd2V2ZXIgdGhlIGRvbWFpbiB3aWxsIG5vdCBi
ZSBhYmxlIHRvCmNyZWF0ZSBtb3JlIHJlc291cmNlIChhc3NvY2lhdGVkIHRv
IHRoZSBxdW90YSkgdW50aWwgaXQgaXMgYmFjayB0byBiZWxvdwp0aGUgbGlt
aXQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMyNi4KClJlcG9ydGVkLWJ5OiBK
dWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2VkLWJ5
OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29tPgoKZGlmZiAtLWdp
dCBhL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQgYi9kb2NzL21pc2MveGVuc3Rv
cmUudHh0CmluZGV4IDRiYzI2MmZkNWRiMS4uOTg4ZWY4OWNiYTJkIDEwMDY0
NAotLS0gYS9kb2NzL21pc2MveGVuc3RvcmUudHh0CisrKyBiL2RvY3MvbWlz
Yy94ZW5zdG9yZS50eHQKQEAgLTQxMCw2ICs0MTAsMTcgQEAgQ09OVFJPTAkJ
CTxjb21tYW5kPnxbPHBhcmFtZXRlcnM+fF0KIAlwcmludHw8c3RyaW5nPgog
CQlwcmludCA8c3RyaW5nPiB0byBzeXNsb2cgKHhlbnN0b3JlIHJ1bnMgYXMg
ZGFlbW9uKSBvcgogCQl0byBjb25zb2xlICh4ZW5zdG9yZSBydW5zIGFzIHN0
dWJkb20pCisJcXVvdGF8W3NldCA8bmFtZT4gPHZhbD58PGRvbWlkPl0KKwkJ
d2l0aG91dCBwYXJhbWV0ZXJzOiBwcmludCB0aGUgY3VycmVudCBxdW90YSBz
ZXR0aW5ncworCQl3aXRoICJzZXQgPG5hbWU+IDx2YWw+Ijogc2V0IHRoZSBx
dW90YSA8bmFtZT4gdG8gbmV3IHZhbHVlCisJCTx2YWw+IChUaGUgYWRtaW4g
c2hvdWxkIG1ha2Ugc3VyZSBhbGwgdGhlIGRvbWFpbiB1c2FnZSBpcworCQli
ZWxvdyB0aGUgcXVvdGEuIElmIGl0IGlzIG5vdCwgdGhlbiBYZW5zdG9yZWQg
bWF5IGNvbnRpbnVlIHRvCisJCWhhbmRsZSByZXF1ZXN0cyBmcm9tIHRoZSBk
b21haW4gYXMgbG9uZyBhcyB0aGUgcmVzb3VyY2UKKwkJdmlvbGF0aW5nIHRo
ZSBuZXcgcXVvdGEgc2V0dGluZyBpc24ndCBpbmNyZWFzZWQgZnVydGhlcikK
KwkJd2l0aCAiPGRvbWlkPiI6IHByaW50IHF1b3RhIHJlbGF0ZWQgYWNjb3Vu
dGluZyBkYXRhIGZvcgorCQl0aGUgZG9tYWluIDxkb21pZD4KKwlxdW90YS1z
b2Z0fFtzZXQgPG5hbWU+IDx2YWw+XQorCQlsaWtlIHRoZSAicXVvdGEiIGNv
bW1hbmQsIGJ1dCBmb3Igc29mdC1xdW90YS4KIAloZWxwCQkJPHN1cHBvcnRl
ZC1jb21tYW5kcz4KIAkJcmV0dXJuIGxpc3Qgb2Ygc3VwcG9ydGVkIGNvbW1h
bmRzIGZvciBDT05UUk9MCiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb250cm9sLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29udHJvbC5jCmluZGV4IDYxYmNiYzA2OWQ3NS4uMjY0YmIzOWQ3YjBl
IDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29udHJv
bC5jCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb250cm9sLmMK
QEAgLTE5Niw2ICsxOTYsMTE1IEBAIHN0YXRpYyBpbnQgZG9fY29udHJvbF9s
b2codm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKIAlyZXR1
cm4gMDsKIH0KIAorc3RydWN0IHF1b3RhIHsKKwljb25zdCBjaGFyICpuYW1l
OworCWludCAqcXVvdGE7CisJY29uc3QgY2hhciAqZGVzY3I7Cit9OworCitz
dGF0aWMgY29uc3Qgc3RydWN0IHF1b3RhIGhhcmRfcXVvdGFzW10gPSB7CisJ
eyAibm9kZXMiLCAmcXVvdGFfbmJfZW50cnlfcGVyX2RvbWFpbiwgIk5vZGVz
IHBlciBkb21haW4iIH0sCisJeyAid2F0Y2hlcyIsICZxdW90YV9uYl93YXRj
aF9wZXJfZG9tYWluLCAiV2F0Y2hlcyBwZXIgZG9tYWluIiB9LAorCXsgInRy
YW5zYWN0aW9ucyIsICZxdW90YV9tYXhfdHJhbnNhY3Rpb24sICJUcmFuc2Fj
dGlvbnMgcGVyIGRvbWFpbiIgfSwKKwl7ICJvdXRzdGFuZGluZyIsICZxdW90
YV9yZXFfb3V0c3RhbmRpbmcsCisJCSJPdXRzdGFuZGluZyByZXF1ZXN0cyBw
ZXIgZG9tYWluIiB9LAorCXsgInRyYW5zYWN0aW9uLW5vZGVzIiwgJnF1b3Rh
X3RyYW5zX25vZGVzLAorCQkiTWF4LiBudW1iZXIgb2YgYWNjZXNzZWQgbm9k
ZXMgcGVyIHRyYW5zYWN0aW9uIiB9LAorCXsgIm1lbW9yeSIsICZxdW90YV9t
ZW1vcnlfcGVyX2RvbWFpbl9oYXJkLAorCQkiVG90YWwgWGVuc3RvcmUgbWVt
b3J5IHBlciBkb21haW4gKGVycm9yIGxldmVsKSIgfSwKKwl7ICJub2RlLXNp
emUiLCAmcXVvdGFfbWF4X2VudHJ5X3NpemUsICJNYXguIHNpemUgb2YgYSBu
b2RlIiB9LAorCXsgInBhdGgtbWF4IiwgJnF1b3RhX21heF9wYXRoX2xlbiwg
Ik1heC4gbGVuZ3RoIG9mIGEgbm9kZSBwYXRoIiB9LAorCXsgInBlcm1pc3Np
b25zIiwgJnF1b3RhX25iX3Blcm1zX3Blcl9ub2RlLAorCQkiTWF4LiBudW1i
ZXIgb2YgcGVybWlzc2lvbnMgcGVyIG5vZGUiIH0sCisJeyBOVUxMLCBOVUxM
LCBOVUxMIH0KK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcXVvdGEgc29m
dF9xdW90YXNbXSA9IHsKKwl7ICJtZW1vcnkiLCAmcXVvdGFfbWVtb3J5X3Bl
cl9kb21haW5fc29mdCwKKwkJIlRvdGFsIFhlbnN0b3JlIG1lbW9yeSBwZXIg
ZG9tYWluICh3YXJuaW5nIGxldmVsKSIgfSwKKwl7IE5VTEwsIE5VTEwsIE5V
TEwgfQorfTsKKworc3RhdGljIGludCBxdW90YV9zaG93X2N1cnJlbnQoY29u
c3Qgdm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJCSAg
ICAgIGNvbnN0IHN0cnVjdCBxdW90YSAqcXVvdGFzKQoreworCWNoYXIgKnJl
c3A7CisJdW5zaWduZWQgaW50IGk7CisKKwlyZXNwID0gdGFsbG9jX3N0cmR1
cChjdHgsICJRdW90YSBzZXR0aW5nczpcbiIpOworCWlmICghcmVzcCkKKwkJ
cmV0dXJuIEVOT01FTTsKKworCWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90
YTsgaSsrKSB7CisJCXJlc3AgPSB0YWxsb2NfYXNwcmludGZfYXBwZW5kKHJl
c3AsICIlLTE3czogJThkICVzXG4iLAorCQkJCQkgICAgICBxdW90YXNbaV0u
bmFtZSwgKnF1b3Rhc1tpXS5xdW90YSwKKwkJCQkJICAgICAgcXVvdGFzW2ld
LmRlc2NyKTsKKwkJaWYgKCFyZXNwKQorCQkJcmV0dXJuIEVOT01FTTsKKwl9
CisKKwlzZW5kX3JlcGx5KGNvbm4sIFhTX0NPTlRST0wsIHJlc3AsIHN0cmxl
bihyZXNwKSArIDEpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQg
cXVvdGFfc2V0KGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sCisJCSAgICAgY2hhciAqKnZlYywgaW50IG51bSwgY29uc3Qgc3Ry
dWN0IHF1b3RhICpxdW90YXMpCit7CisJdW5zaWduZWQgaW50IGk7CisJaW50
IHZhbDsKKworCWlmIChudW0gIT0gMikKKwkJcmV0dXJuIEVJTlZBTDsKKwor
CXZhbCA9IGF0b2kodmVjWzFdKTsKKwlpZiAodmFsIDwgMSkKKwkJcmV0dXJu
IEVJTlZBTDsKKworCWZvciAoaSA9IDA7IHF1b3Rhc1tpXS5xdW90YTsgaSsr
KSB7CisJCWlmICghc3RyY21wKHZlY1swXSwgcXVvdGFzW2ldLm5hbWUpKSB7
CisJCQkqcXVvdGFzW2ldLnF1b3RhID0gdmFsOworCQkJc2VuZF9hY2soY29u
biwgWFNfQ09OVFJPTCk7CisJCQlyZXR1cm4gMDsKKwkJfQorCX0KKworCXJl
dHVybiBFSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgcXVvdGFfZ2V0KGNvbnN0
IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCSAgICAg
Y2hhciAqKnZlYywgaW50IG51bSkKK3sKKwlpZiAobnVtICE9IDEpCisJCXJl
dHVybiBFSU5WQUw7CisKKwlyZXR1cm4gZG9tYWluX2dldF9xdW90YShjdHgs
IGNvbm4sIGF0b2kodmVjWzBdKSk7Cit9CisKK3N0YXRpYyBpbnQgZG9fY29u
dHJvbF9xdW90YSh2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LAorCQkJICAgIGNoYXIgKip2ZWMsIGludCBudW0pCit7CisJaWYgKG51bSA9
PSAwKQorCQlyZXR1cm4gcXVvdGFfc2hvd19jdXJyZW50KGN0eCwgY29ubiwg
aGFyZF9xdW90YXMpOworCisJaWYgKCFzdHJjbXAodmVjWzBdLCAic2V0Iikp
CisJCXJldHVybiBxdW90YV9zZXQoY3R4LCBjb25uLCB2ZWMgKyAxLCBudW0g
LSAxLCBoYXJkX3F1b3Rhcyk7CisKKwlyZXR1cm4gcXVvdGFfZ2V0KGN0eCwg
Y29ubiwgdmVjLCBudW0pOworfQorCitzdGF0aWMgaW50IGRvX2NvbnRyb2xf
cXVvdGFfcyh2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAor
CQkJICAgICAgY2hhciAqKnZlYywgaW50IG51bSkKK3sKKwlpZiAobnVtID09
IDApCisJCXJldHVybiBxdW90YV9zaG93X2N1cnJlbnQoY3R4LCBjb25uLCBz
b2Z0X3F1b3Rhcyk7CisKKwlpZiAoIXN0cmNtcCh2ZWNbMF0sICJzZXQiKSkK
KwkJcmV0dXJuIHF1b3RhX3NldChjdHgsIGNvbm4sIHZlYyArIDEsIG51bSAt
IDEsIHNvZnRfcXVvdGFzKTsKKworCXJldHVybiBFSU5WQUw7Cit9CisKICNp
ZmRlZiBfX01JTklPU19fCiBzdGF0aWMgaW50IGRvX2NvbnRyb2xfbWVtcmVw
b3J0KHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCiAJCQkJ
Y2hhciAqKnZlYywgaW50IG51bSkKQEAgLTg0Nyw2ICs5NTYsOCBAQCBzdGF0
aWMgc3RydWN0IGNtZF9zIGNtZHNbXSA9IHsKIAl7ICJtZW1yZXBvcnQiLCBk
b19jb250cm9sX21lbXJlcG9ydCwgIls8ZmlsZT5dIiB9LAogI2VuZGlmCiAJ
eyAicHJpbnQiLCBkb19jb250cm9sX3ByaW50LCAiPHN0cmluZz4iIH0sCisJ
eyAicXVvdGEiLCBkb19jb250cm9sX3F1b3RhLCAiW3NldCA8bmFtZT4gPHZh
bD58PGRvbWlkPl0iIH0sCisJeyAicXVvdGEtc29mdCIsIGRvX2NvbnRyb2xf
cXVvdGFfcywgIltzZXQgPG5hbWU+IDx2YWw+XSIgfSwKIAl7ICJoZWxwIiwg
ZG9fY29udHJvbF9oZWxwLCAiIiB9LAogfTsKIApkaWZmIC0tZ2l0IGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDQyNDIzODA4ODYzZi4uOTgz
YjM0OGVlNTljIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5jCkBAIC0zMSw2ICszMSw3IEBACiAjaW5jbHVkZSAieGVuc3RvcmVk
X2RvbWFpbi5oIgogI2luY2x1ZGUgInhlbnN0b3JlZF90cmFuc2FjdGlvbi5o
IgogI2luY2x1ZGUgInhlbnN0b3JlZF93YXRjaC5oIgorI2luY2x1ZGUgInhl
bnN0b3JlZF9jb250cm9sLmgiCiAKICNpbmNsdWRlIDx4ZW5ldnRjaG4uaD4K
ICNpbmNsdWRlIDx4ZW5jdHJsLmg+CkBAIC0zNDUsNiArMzQ2LDM4IEBAIHN0
YXRpYyBzdHJ1Y3QgZG9tYWluICpmaW5kX2RvbWFpbl9zdHJ1Y3QodW5zaWdu
ZWQgaW50IGRvbWlkKQogCXJldHVybiBOVUxMOwogfQogCitpbnQgZG9tYWlu
X2dldF9xdW90YShjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9u
ICpjb25uLAorCQkgICAgIHVuc2lnbmVkIGludCBkb21pZCkKK3sKKwlzdHJ1
Y3QgZG9tYWluICpkID0gZmluZF9kb21haW5fc3RydWN0KGRvbWlkKTsKKwlj
aGFyICpyZXNwOworCWludCB0YTsKKworCWlmICghZCkKKwkJcmV0dXJuIEVO
T0VOVDsKKworCXRhID0gZC0+Y29ubiA/IGQtPmNvbm4tPnRyYW5zYWN0aW9u
X3N0YXJ0ZWQgOiAwOworCXJlc3AgPSB0YWxsb2NfYXNwcmludGYoY3R4LCAi
RG9tYWluICV1OlxuIiwgZG9taWQpOworCWlmICghcmVzcCkKKwkJcmV0dXJu
IEVOT01FTTsKKworI2RlZmluZSBlbnQodCwgZSkgXAorCXJlc3AgPSB0YWxs
b2NfYXNwcmludGZfYXBwZW5kKHJlc3AsICIlLTE2czogJThkXG4iLCAjdCwg
ZSk7IFwKKwlpZiAoIXJlc3ApIHJldHVybiBFTk9NRU0KKworCWVudChub2Rl
cywgZC0+bmJlbnRyeSk7CisJZW50KHdhdGNoZXMsIGQtPm5id2F0Y2gpOwor
CWVudCh0cmFuc2FjdGlvbnMsIHRhKTsKKwllbnQob3V0c3RhbmRpbmcsIGQt
Pm5ib3V0c3RhbmRpbmcpOworCWVudChtZW1vcnksIGQtPm1lbW9yeSk7CisK
KyN1bmRlZiBlbnQKKworCXNlbmRfcmVwbHkoY29ubiwgWFNfQ09OVFJPTCwg
cmVzcCwgc3RybGVuKHJlc3ApICsgMSk7CisKKwlyZXR1cm4gMDsKK30KKwog
c3RhdGljIHN0cnVjdCBkb21haW4gKmFsbG9jX2RvbWFpbihjb25zdCB2b2lk
ICpjb250ZXh0LCB1bnNpZ25lZCBpbnQgZG9taWQpCiB7CiAJc3RydWN0IGRv
bWFpbiAqZG9tYWluOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5oCmluZGV4IGQzNDJlNWU4NjdlZC4uNWI4NmE5MmUxYjViIDEwMDY0
NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmgKKysr
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oCkBAIC04OCw2
ICs4OCw4IEBAIGludCBkb21haW5fd2F0Y2goc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4pOwogdm9pZCBkb21haW5fb3V0c3RhbmRpbmdfaW5jKHN0cnVjdCBj
b25uZWN0aW9uICpjb25uKTsKIHZvaWQgZG9tYWluX291dHN0YW5kaW5nX2Rl
YyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiB2b2lkIGRvbWFpbl9vdXRz
dGFuZGluZ19kb21pZF9kZWModW5zaWduZWQgaW50IGRvbWlkKTsKK2ludCBk
b21haW5fZ2V0X3F1b3RhKGNvbnN0IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sCisJCSAgICAgdW5zaWduZWQgaW50IGRvbWlkKTsKIAog
LyogU3BlY2lhbCBub2RlIHBlcm1pc3Npb24gaGFuZGxpbmcuICovCiBpbnQg
c2V0X3Blcm1zX3NwZWNpYWwoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNv
bnN0IGNoYXIgKm5hbWUsCg==

--=separator--


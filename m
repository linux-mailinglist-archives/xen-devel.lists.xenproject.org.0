Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4FB88B2AA4
	for <lists+xen-devel@lfdr.de>; Sat, 14 Sep 2019 10:56:25 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i93o0-0007jK-7e; Sat, 14 Sep 2019 08:53:20 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=rDpt=XJ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1i93ny-0007iE-KP
 for xen-devel@lists.xenproject.org; Sat, 14 Sep 2019 08:53:18 +0000
X-Inumbo-ID: 0b25a8d8-d6cd-11e9-95c1-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 0b25a8d8-d6cd-11e9-95c1-12813bfff9fa;
 Sat, 14 Sep 2019 08:52:56 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 91C16AF40;
 Sat, 14 Sep 2019 08:52:54 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 14 Sep 2019 10:52:05 +0200
Message-Id: <20190914085251.18816-2-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190914085251.18816-1-jgross@suse.com>
References: <20190914085251.18816-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v3 01/47] xen/sched: use new sched_unit instead
 of vcpu in scheduler interfaces
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gb3JkZXIgdG8gcHJlcGFyZSBjb3JlLSBhbmQgc29ja2V0LXNjaGVkdWxpbmcgdXNlIGEgbmV3
IHN0cnVjdApzY2hlZF91bml0IGluc3RlYWQgb2Ygc3RydWN0IHZjcHUgZm9yIGludGVyZmFjZXMg
b2YgdGhlIGRpZmZlcmVudApzY2hlZHVsZXJzLgoKUmVuYW1lIHRoZSBwZXItc2NoZWR1bGVyIGZ1
bmN0aW9ucyBpbnNlcnRfdmNwdSBhbmQgcmVtb3ZlX3ZjcHUgdG8KaW5zZXJ0X3VuaXQgYW5kIHJl
bW92ZV91bml0IHRvIHJlZmxlY3QgdGhlIGNoYW5nZSBvZiB0aGUgcGFyYW1ldGVyLgpJbiB0aGUg
c2NoZWR1bGVycyByZW5hbWUgbG9jYWwgZnVuY3Rpb25zIHN3aXRjaGVkIHRvIHNjaGVkX3VuaXQs
IHRvby4KCkZvciBub3cgdGhpcyBuZXcgc3RydWN0IHdpbGwgY29udGFpbiBhIGRvbWFpbiwgYSB2
Y3B1IHBvaW50ZXIgYW5kIGEKdW5pdF9pZCBvbmx5IGFuZCBpcyBhbGxvY2F0ZWQgYXQgdmNwdSBj
cmVhdGlvbiB0aW1lLgoKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogRGFyaW8gRmFnZ2lvbGkgPGRmYWdnaW9saUBzdXNlLmNvbT4KLS0t
ClJGQyBWMjoKLSBtb3ZlIGRlZmluaXRpb24gb2Ygc3RydWN0IHNjaGVkX3VuaXQgdG8gc2NoZWQu
aCAoQW5kcmV3IENvb3BlcikKVjE6Ci0gcmVuYW1lICJpdGVtIiB0byAidW5pdCIgKEdlb3JnZSBE
dW5sYXApClYyOgotIHJlbmFtZSB1bml0LT52Y3B1IHRvIHVuaXQtPnZjcHVfbGlzdCAoSmFuIEJl
dWxpY2gpCi0gbWVyZ2UgcGF0Y2ggd2l0aCBuZXh0IG9uZSBpbiBzZXJpZXMgKERhcmlvIEZhZ2dp
b2xpKQotIG1lcmdlIHBhdGNoIGludHJvZHVjaW5nIGRvbWFpbiBwb2ludGVyIGluIHNjaGVkX3Vu
aXQgaW50byB0aGlzIG9uZQogIChKYW4gQmV1bGljaCkKLSBtZXJnZSBwYXRjaCBpbnRyb2R1Y2lu
ZyB1bml0X2lkIGludG8gdGhpcyBvbmUKVjM6Ci0gbWFrZSB1bml0IHBhcmFtZXRlciBvZiBwaWNr
X2NwdSBjb25zdCAoSmFuIEJldWxpY2gpCi0gc2V0IHZjcHUtPnVuaXQgb25seSBhZnRlciBpbnRp
YWxpemluZyB1bml0aSwgZnJlZWluZyB1bml0IG9ubHkgYWZ0ZXIKICBjbGVhcmluZyB2Y3B1LT51
bml0IChKYW4gQmV1bGljaCkKLSByZW1vdmUgcHJlLWRlZmluaXRpb24gb2Ygc3RydWN0IHNjaGVk
X3VuaXQgaW4gc2NoZWQuaCAoSmFuIEJldWxpY2gpCi0gbWFrZSB1bml0X2lkIHVuc2lnbmVkIGlu
dCAoSmFuIEJldWxpY2gpCi0tLQogeGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jIHwgMzAgKysr
KysrKysrLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jICAgfCA0MSArKysrKysrKysr
KystLS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMgIHwgNTcgKysrKysrKysrKysr
KysrKy0tLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9udWxsLmMgICAgIHwgMzggKysrKysr
KysrKysrLS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9ydC5jICAgICAgIHwgMzMgKysrKysrKysr
LS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZHVsZS5jICAgICAgIHwgNTQgKysrKysrKysrKysrKysr
KystLS0tLS0tLS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oICB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVk
LmggICAgIHwgIDcgKysrKwogOCBmaWxlcyBjaGFuZ2VkLCAyMTkgaW5zZXJ0aW9ucygrKSwgMTMz
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYyBi
L3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYwppbmRleCA3MmI5ODhlYTVmLi5lOGIxM2EwMDIy
IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMKKysrIGIveGVuL2NvbW1v
bi9zY2hlZF9hcmluYzY1My5jCkBAIC0zNzYsMTMgKzM3NiwxNiBAQCBhNjUzc2NoZWRfZGVpbml0
KHN0cnVjdCBzY2hlZHVsZXIgKm9wcykKICAqIFRoaXMgZnVuY3Rpb24gYWxsb2NhdGVzIHNjaGVk
dWxlci1zcGVjaWZpYyBkYXRhIGZvciBhIFZDUFUKICAqCiAgKiBAcGFyYW0gb3BzICAgICAgIFBv
aW50ZXIgdG8gdGhpcyBpbnN0YW5jZSBvZiB0aGUgc2NoZWR1bGVyIHN0cnVjdHVyZQorICogQHBh
cmFtIHVuaXQgICAgICBQb2ludGVyIHRvIHN0cnVjdCBzY2hlZF91bml0CiAgKgogICogQHJldHVy
biAgICAgICAgICBQb2ludGVyIHRvIHRoZSBhbGxvY2F0ZWQgZGF0YQogICovCiBzdGF0aWMgdm9p
ZCAqCi1hNjUzc2NoZWRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBz
dHJ1Y3QgdmNwdSAqdmMsIHZvaWQgKmRkKQorYTY1M3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsCisgICAgICAgICAg
ICAgICAgICAgICAgdm9pZCAqZGQpCiB7CiAgICAgYTY1M3NjaGVkX3ByaXZfdCAqc2NoZWRfcHJp
diA9IFNDSEVEX1BSSVYob3BzKTsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xp
c3Q7CiAgICAgYXJpbmM2NTNfdmNwdV90ICpzdmM7CiAgICAgdW5zaWduZWQgaW50IGVudHJ5Owog
ICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CkBAIC00NTgsMTEgKzQ2MSwxMyBAQCBhNjUzc2NoZWRf
ZnJlZV92ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHZvaWQgKnByaXYpCiAgKiBY
ZW4gc2NoZWR1bGVyIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHNsZWVwIGEgVkNQVQogICoKICAqIEBw
YXJhbSBvcHMgICAgICAgUG9pbnRlciB0byB0aGlzIGluc3RhbmNlIG9mIHRoZSBzY2hlZHVsZXIg
c3RydWN0dXJlCi0gKiBAcGFyYW0gdmMgICAgICAgIFBvaW50ZXIgdG8gdGhlIFZDUFUgc3RydWN0
dXJlIGZvciB0aGUgY3VycmVudCBkb21haW4KKyAqIEBwYXJhbSB1bml0ICAgICAgUG9pbnRlciB0
byBzdHJ1Y3Qgc2NoZWRfdW5pdAogICovCiBzdGF0aWMgdm9pZAotYTY1M3NjaGVkX3ZjcHVfc2xl
ZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCithNjUzc2No
ZWRfdW5pdF9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91
bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKKwog
ICAgIGlmICggQVZDUFUodmMpICE9IE5VTEwgKQogICAgICAgICBBVkNQVSh2YyktPmF3YWtlID0g
MDsKIApAQCAtNDc4LDExICs0ODMsMTMgQEAgYTY1M3NjaGVkX3ZjcHVfc2xlZXAoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCiAgKiBYZW4gc2NoZWR1bGVyIGNh
bGxiYWNrIGZ1bmN0aW9uIHRvIHdha2UgdXAgYSBWQ1BVCiAgKgogICogQHBhcmFtIG9wcyAgICAg
ICBQb2ludGVyIHRvIHRoaXMgaW5zdGFuY2Ugb2YgdGhlIHNjaGVkdWxlciBzdHJ1Y3R1cmUKLSAq
IEBwYXJhbSB2YyAgICAgICAgUG9pbnRlciB0byB0aGUgVkNQVSBzdHJ1Y3R1cmUgZm9yIHRoZSBj
dXJyZW50IGRvbWFpbgorICogQHBhcmFtIHVuaXQgICAgICBQb2ludGVyIHRvIHN0cnVjdCBzY2hl
ZF91bml0CiAgKi8KIHN0YXRpYyB2b2lkCi1hNjUzc2NoZWRfdmNwdV93YWtlKGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorYTY1M3NjaGVkX3VuaXRfd2FrZShj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewor
ICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKKwogICAgIGlmICggQVZDUFUo
dmMpICE9IE5VTEwgKQogICAgICAgICBBVkNQVSh2YyktPmF3YWtlID0gMTsKIApAQCAtNTk3LDEz
ICs2MDQsMTQgQEAgYTY1M3NjaGVkX2RvX3NjaGVkdWxlKAogICogWGVuIHNjaGVkdWxlciBjYWxs
YmFjayBmdW5jdGlvbiB0byBzZWxlY3QgYSBDUFUgZm9yIHRoZSBWQ1BVIHRvIHJ1biBvbgogICoK
ICAqIEBwYXJhbSBvcHMgICAgICAgUG9pbnRlciB0byB0aGlzIGluc3RhbmNlIG9mIHRoZSBzY2hl
ZHVsZXIgc3RydWN0dXJlCi0gKiBAcGFyYW0gdiAgICAgICAgIFBvaW50ZXIgdG8gdGhlIFZDUFUg
c3RydWN0dXJlIGZvciB0aGUgY3VycmVudCBkb21haW4KKyAqIEBwYXJhbSB1bml0ICAgICAgUG9p
bnRlciB0byBzdHJ1Y3Qgc2NoZWRfdW5pdAogICoKICAqIEByZXR1cm4gICAgICAgICAgTnVtYmVy
IG9mIHNlbGVjdGVkIHBoeXNpY2FsIENQVQogICovCiBzdGF0aWMgaW50Ci1hNjUzc2NoZWRfcGlj
a19jcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCithNjUz
c2NoZWRfcGlja19jcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1Y3Qg
c2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xp
c3Q7CiAgICAgY3B1bWFza190ICpvbmxpbmU7CiAgICAgdW5zaWduZWQgaW50IGNwdTsKIApAQCAt
NzAyLDExICs3MTAsMTEgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgc2NoZWRfYXJp
bmM2NTNfZGVmID0gewogICAgIC5mcmVlX3ZkYXRhICAgICA9IGE2NTNzY2hlZF9mcmVlX3ZkYXRh
LAogICAgIC5hbGxvY192ZGF0YSAgICA9IGE2NTNzY2hlZF9hbGxvY192ZGF0YSwKIAotICAgIC5p
bnNlcnRfdmNwdSAgICA9IE5VTEwsCi0gICAgLnJlbW92ZV92Y3B1ICAgID0gTlVMTCwKKyAgICAu
aW5zZXJ0X3VuaXQgICAgPSBOVUxMLAorICAgIC5yZW1vdmVfdW5pdCAgICA9IE5VTEwsCiAKLSAg
ICAuc2xlZXAgICAgICAgICAgPSBhNjUzc2NoZWRfdmNwdV9zbGVlcCwKLSAgICAud2FrZSAgICAg
ICAgICAgPSBhNjUzc2NoZWRfdmNwdV93YWtlLAorICAgIC5zbGVlcCAgICAgICAgICA9IGE2NTNz
Y2hlZF91bml0X3NsZWVwLAorICAgIC53YWtlICAgICAgICAgICA9IGE2NTNzY2hlZF91bml0X3dh
a2UsCiAgICAgLnlpZWxkICAgICAgICAgID0gTlVMTCwKICAgICAuY29udGV4dF9zYXZlZCAgPSBO
VUxMLAogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jIGIveGVuL2NvbW1v
bi9zY2hlZF9jcmVkaXQuYwppbmRleCA3MGZlNzE4MTI3Li45NGQ3MzNkY2I1IDEwMDY0NAotLS0g
YS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
LmMKQEAgLTg1NCwxNSArODU0LDE2IEBAIF9jc2NoZWRfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMsIGJvb2xfdCBjb21taXQpCiB9CiAKIHN0YXRp
YyBpbnQKLWNzY2hlZF9jcHVfcGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVj
dCB2Y3B1ICp2YykKK2NzY2hlZF9jcHVfcGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMs
IGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9
IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2YyA9IENTQ0hFRF9W
Q1BVKHZjKTsKIAogICAgIC8qCiAgICAgICogV2UgaGF2ZSBiZWVuIGNhbGxlZCBieSB2Y3B1X21p
Z3JhdGUoKSAoaW4gc2NoZWR1bGUuYyksIGFzIHBhcnQKICAgICAgKiBvZiB0aGUgcHJvY2VzcyBv
ZiBzZWVpbmcgaWYgdmMgY2FuIGJlIG1pZ3JhdGVkIHRvIGFub3RoZXIgcGNwdS4KICAgICAgKiBX
ZSBtYWtlIGEgbm90ZSBhYm91dCB0aGlzIGluIHN2Yy0+ZmxhZ3Mgc28gdGhhdCBsYXRlciwgaW4K
LSAgICAgKiBjc2NoZWRfdmNwdV93YWtlKCkgKHN0aWxsIGNhbGxlZCBmcm9tIHZjcHVfbWlncmF0
ZSgpKSB3ZSB3b24ndAorICAgICAqIGNzY2hlZF91bml0X3dha2UoKSAoc3RpbGwgY2FsbGVkIGZy
b20gdmNwdV9taWdyYXRlKCkpIHdlIHdvbid0CiAgICAgICogZ2V0IGJvb3N0ZWQsIHdoaWNoIHdl
IGRvbid0IGRlc2VydmUgYXMgd2UgYXJlICJvbmx5IiBtaWdyYXRpbmcuCiAgICAgICovCiAgICAg
c2V0X2JpdChDU0NIRURfRkxBR19WQ1BVX01JR1JBVElORywgJnN2Yy0+ZmxhZ3MpOwpAQCAtOTkw
LDggKzk5MSwxMCBAQCBjc2NoZWRfdmNwdV9hY2N0KHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2
LCB1bnNpZ25lZCBpbnQgY3B1KQogfQogCiBzdGF0aWMgdm9pZCAqCi1jc2NoZWRfYWxsb2NfdmRh
dGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMsIHZvaWQgKmRk
KQorY3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0
IHNjaGVkX3VuaXQgKnVuaXQsCisgICAgICAgICAgICAgICAgICAgdm9pZCAqZGQpCiB7CisgICAg
c3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdV9saXN0OwogICAgIHN0cnVjdCBjc2NoZWRfdmNw
dSAqc3ZjOwogCiAgICAgLyogQWxsb2NhdGUgcGVyLVZDUFUgaW5mbyAqLwpAQCAtMTAxMSw4ICsx
MDE0LDkgQEAgY3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHZjcHUgKnZjLCB2b2lkICpkZCkKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZF92Y3B1
X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2Nz
Y2hlZF91bml0X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hl
ZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsK
ICAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF9wcml2OwogICAgIHNwaW5s
b2NrX3QgKmxvY2s7CiAKQEAgLTEwMjEsNyArMTAyNSw3IEBAIGNzY2hlZF92Y3B1X2luc2VydChj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKICAgICAvKiBjc2No
ZWRfY3B1X3BpY2soKSBsb29rcyBpbiB2Yy0+cHJvY2Vzc29yJ3MgcnVucSwgc28gd2UgbmVlZCB0
aGUgbG9jay4gKi8KICAgICBsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2Yyk7CiAKLSAg
ICB2Yy0+cHJvY2Vzc29yID0gY3NjaGVkX2NwdV9waWNrKG9wcywgdmMpOworICAgIHZjLT5wcm9j
ZXNzb3IgPSBjc2NoZWRfY3B1X3BpY2sob3BzLCB1bml0KTsKIAogICAgIHNwaW5fdW5sb2NrX2ly
cShsb2NrKTsKIApAQCAtMTA0Niw5ICsxMDUwLDEwIEBAIGNzY2hlZF9mcmVlX3ZkYXRhKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgdm9pZCAqcHJpdikKIH0KIAogc3RhdGljIHZvaWQKLWNz
Y2hlZF92Y3B1X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1
ICp2YykKK2NzY2hlZF91bml0X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAgIHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2
ID0gQ1NDSEVEX1BSSVYob3BzKTsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xp
c3Q7CiAgICAgc3RydWN0IGNzY2hlZF92Y3B1ICogY29uc3Qgc3ZjID0gQ1NDSEVEX1ZDUFUodmMp
OwogICAgIHN0cnVjdCBjc2NoZWRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKIApAQCAt
MTA3Myw4ICsxMDc4LDkgQEAgY3NjaGVkX3ZjcHVfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVkX3ZjcHVf
c2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2No
ZWRfdW5pdF9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91
bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKICAg
ICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKiBjb25zdCBzdmMgPSBDU0NIRURfVkNQVSh2Yyk7CiAgICAg
dW5zaWduZWQgaW50IGNwdSA9IHZjLT5wcm9jZXNzb3I7CiAKQEAgLTEwOTcsOCArMTEwMyw5IEBA
IGNzY2hlZF92Y3B1X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnZjKQogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVkX3ZjcHVfd2FrZShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2NzY2hlZF91bml0X3dha2UoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBz
dHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IGNzY2hlZF92Y3B1
ICogY29uc3Qgc3ZjID0gQ1NDSEVEX1ZDUFUodmMpOwogICAgIGJvb2xfdCBtaWdyYXRpbmc7CiAK
QEAgLTExNTgsOCArMTE2NSw5IEBAIGNzY2hlZF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWRfdmNw
dV95aWVsZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2Nz
Y2hlZF91bml0X3lpZWxkKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVk
X3VuaXQgKnVuaXQpCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdV9saXN0Owog
ICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqIGNvbnN0IHN2YyA9IENTQ0hFRF9WQ1BVKHZjKTsKIAog
ICAgIC8qIExldCB0aGUgc2NoZWR1bGVyIGtub3cgdGhhdCB0aGlzIHZjcHUgaXMgdHJ5aW5nIHRv
IHlpZWxkICovCkBAIC0xMjEyLDkgKzEyMjAsMTAgQEAgY3NjaGVkX2RvbV9jbnRsKAogfQogCiBz
dGF0aWMgdm9pZAotY3NjaGVkX2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHZjcHUgKnYsCitjc2NoZWRfYWZmX2NudGwoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwKICAgICAgICAgICAgICAgICBjb25zdCBjcHVt
YXNrX3QgKmhhcmQsIGNvbnN0IGNwdW1hc2tfdCAqc29mdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAq
diA9IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2YyA9IENTQ0hF
RF9WQ1BVKHYpOwogCiAgICAgaWYgKCAhaGFyZCApCkBAIC0xNzQzLDcgKzE3NTIsNyBAQCBjc2No
ZWRfbG9hZF9iYWxhbmNlKHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2LCBpbnQgY3B1LAogICAg
ICAgICAgICAgICAgICAqIC0gaWYgd2UgcmFjZSB3aXRoIGluY19ucl9ydW5uYWJsZSgpLCB3ZSBz
a2lwIGEgcENQVSB0aGF0IG1heQogICAgICAgICAgICAgICAgICAqICAgaGF2ZSBydW5uYWJsZSB2
Q1BVcyBpbiBpdHMgcnVucXVldWUsIGJ1dCB0aGF0J3Mgbm90IGEKICAgICAgICAgICAgICAgICAg
KiAgIHByb2JsZW0gYmVjYXVzZToKLSAgICAgICAgICAgICAgICAgKiAgICsgaWYgcmFjaW5nIHdp
dGggY3NjaGVkX3ZjcHVfaW5zZXJ0KCkgb3IgY3NjaGVkX3ZjcHVfd2FrZSgpLAorICAgICAgICAg
ICAgICAgICAqICAgKyBpZiByYWNpbmcgd2l0aCBjc2NoZWRfdW5pdF9pbnNlcnQoKSBvciBjc2No
ZWRfdW5pdF93YWtlKCksCiAgICAgICAgICAgICAgICAgICogICAgIF9fcnVucV90aWNrbGUoKSB3
aWxsIGJlIGNhbGxlZCBhZnRlcndvcmRzLCBzbyB0aGUgdkNQVQogICAgICAgICAgICAgICAgICAq
ICAgICB3b24ndCBnZXQgc3R1Y2sgaW4gdGhlIHJ1bnF1ZXVlIGZvciB0b28gbG9uZzsKICAgICAg
ICAgICAgICAgICAgKiAgICsgaWYgcmFjaW5nIHdpdGggY3NjaGVkX3J1bnFfc3RlYWwoKSwgaXQg
bWF5IGJlIHRoYXQgYQpAQCAtMjI1NiwxMiArMjI2NSwxMiBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IHNjaGVkdWxlciBzY2hlZF9jcmVkaXRfZGVmID0gewogCiAgICAgLmdsb2JhbF9pbml0ICAgID0g
Y3NjaGVkX2dsb2JhbF9pbml0LAogCi0gICAgLmluc2VydF92Y3B1ICAgID0gY3NjaGVkX3ZjcHVf
aW5zZXJ0LAotICAgIC5yZW1vdmVfdmNwdSAgICA9IGNzY2hlZF92Y3B1X3JlbW92ZSwKKyAgICAu
aW5zZXJ0X3VuaXQgICAgPSBjc2NoZWRfdW5pdF9pbnNlcnQsCisgICAgLnJlbW92ZV91bml0ICAg
ID0gY3NjaGVkX3VuaXRfcmVtb3ZlLAogCi0gICAgLnNsZWVwICAgICAgICAgID0gY3NjaGVkX3Zj
cHVfc2xlZXAsCi0gICAgLndha2UgICAgICAgICAgID0gY3NjaGVkX3ZjcHVfd2FrZSwKLSAgICAu
eWllbGQgICAgICAgICAgPSBjc2NoZWRfdmNwdV95aWVsZCwKKyAgICAuc2xlZXAgICAgICAgICAg
PSBjc2NoZWRfdW5pdF9zbGVlcCwKKyAgICAud2FrZSAgICAgICAgICAgPSBjc2NoZWRfdW5pdF93
YWtlLAorICAgIC55aWVsZCAgICAgICAgICA9IGNzY2hlZF91bml0X3lpZWxkLAogCiAgICAgLmFk
anVzdCAgICAgICAgID0gY3NjaGVkX2RvbV9jbnRsLAogICAgIC5hZGp1c3RfYWZmaW5pdHk9IGNz
Y2hlZF9hZmZfY250bCwKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jIGIv
eGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMKaW5kZXggNmI3N2RhNzQ3Ni4uMTk3M2RiZGRjYyAx
MDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMKKysrIGIveGVuL2NvbW1vbi9z
Y2hlZF9jcmVkaXQyLmMKQEAgLTI3Myw3ICsyNzMsNyBAQAogICogQ1NGTEFHX2RlbGF5ZWRfcnVu
cV9hZGQ6IERvIHdlIG5lZWQgdG8gYWRkIHRoaXMgdG8gdGhlIHJ1bnF1ZXVlIG9uY2UgaXQnZCBk
b25lCiAgKiBiZWluZyBjb250ZXh0IHN3aXRjaGVkIG91dD8KICAqICsgU2V0IHdoZW4gc2NoZWR1
bGluZyBvdXQgaW4gY3NjaGVkMl9zY2hlZHVsZSgpIGlmIHByZXYgaXMgcnVubmFibGUKLSAqICsg
U2V0IGluIGNzY2hlZDJfdmNwdV93YWtlIGlmIGl0IGZpbmRzIENTRkxBR19zY2hlZHVsZWQgc2V0
CisgKiArIFNldCBpbiBjc2NoZWQyX3VuaXRfd2FrZSBpZiBpdCBmaW5kcyBDU0ZMQUdfc2NoZWR1
bGVkIHNldAogICogKyBSZWFkIGluIGNzY2hlZDJfY29udGV4dF9zYXZlZCgpLiAgSWYgc2V0LCBp
dCBhZGRzIHByZXYgdG8gdGhlIHJ1bnF1ZXVlIGFuZAogICogICBjbGVhcnMgdGhlIGJpdC4KICAq
LwpAQCAtNjI0LDE0ICs2MjQsMTQgQEAgc3RhdGljIGlubGluZSBib29sIGhhc19jYXAoY29uc3Qg
c3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjKQogICogVGhpcyBsb2dpYyBpcyBlbnRpcmVseSBpbXBs
ZW1lbnRlZCBpbiBydW5xX3RpY2tsZSgpLCBhbmQgdGhhdCBpcyBlbm91Z2guCiAgKiBJbiBmYWN0
LCBpbiB0aGlzIHNjaGVkdWxlciwgcGxhY2VtZW50IG9mIGEgdmNwdSBvbiBvbmUgb2YgdGhlIHBj
cHVzIG9mIGEKICAqIHJ1bnEsIF9hbHdheXNfIGhhcHBlbnMgYnkgbWVhbnMgb2YgdGlja2xpbmc6
Ci0gKiAgLSB3aGVuIGEgdmNwdSB3YWtlcyB1cCwgaXQgY2FsbHMgY3NjaGVkMl92Y3B1X3dha2Uo
KSwgd2hpY2ggY2FsbHMKKyAqICAtIHdoZW4gYSB2Y3B1IHdha2VzIHVwLCBpdCBjYWxscyBjc2No
ZWQyX3VuaXRfd2FrZSgpLCB3aGljaCBjYWxscwogICogICAgcnVucV90aWNrbGUoKTsKICAqICAt
IHdoZW4gYSBtaWdyYXRpb24gaXMgaW5pdGlhdGVkIGluIHNjaGVkdWxlLmMsIHdlIGNhbGwgY3Nj
aGVkMl9jcHVfcGljaygpLAotICogICAgY3NjaGVkMl92Y3B1X21pZ3JhdGUoKSAod2hpY2ggY2Fs
bHMgbWlncmF0ZSgpKSBhbmQgY3NjaGVkMl92Y3B1X3dha2UoKS4KKyAqICAgIGNzY2hlZDJfdW5p
dF9taWdyYXRlKCkgKHdoaWNoIGNhbGxzIG1pZ3JhdGUoKSkgYW5kIGNzY2hlZDJfdW5pdF93YWtl
KCkuCiAgKiAgICBjc2NoZWQyX2NwdV9waWNrKCkgbG9va3MgZm9yIHRoZSBsZWFzdCBsb2FkZWQg
cnVucSBhbmQgcmV0dXJuIGp1c3QgYW55Ci0gKiAgICBvZiBpdHMgcHJvY2Vzc29ycy4gVGhlbiwg
Y3NjaGVkMl92Y3B1X21pZ3JhdGUoKSBqdXN0IG1vdmVzIHRoZSB2Y3B1IHRvCisgKiAgICBvZiBp
dHMgcHJvY2Vzc29ycy4gVGhlbiwgY3NjaGVkMl91bml0X21pZ3JhdGUoKSBqdXN0IG1vdmVzIHRo
ZSB2Y3B1IHRvCiAgKiAgICB0aGUgY2hvc2VuIHJ1bnEsIGFuZCBpdCBpcyBhZ2FpbiBydW5xX3Rp
Y2tsZSgpLCBjYWxsZWQgYnkKLSAqICAgIGNzY2hlZDJfdmNwdV93YWtlKCkgdGhhdCBhY3R1YWxs
eSBkZWNpZGVzIHdoYXQgcGNwdSB0byB1c2Ugd2l0aGluIHRoZQorICogICAgY3NjaGVkMl91bml0
X3dha2UoKSB0aGF0IGFjdHVhbGx5IGRlY2lkZXMgd2hhdCBwY3B1IHRvIHVzZSB3aXRoaW4gdGhl
CiAgKiAgICBjaG9zZW4gcnVucTsKICAqICAtIHdoZW4gYSBtaWdyYXRpb24gaXMgaW5pdGlhdGVk
IGluIHNjaGVkX2NyZWRpdDIuYywgYnkgY2FsbGluZyAgbWlncmF0ZSgpCiAgKiAgICBkaXJlY3Rs
eSwgdGhhdCBhZ2FpbiB0ZW1wb3JhcmlseSB1c2UgYSByYW5kb20gcGNwdSBmcm9tIHRoZSBuZXcg
cnVucSwKQEAgLTIwMjcsOCArMjAyNywxMCBAQCBjc2NoZWQyX3ZjcHVfY2hlY2soc3RydWN0IHZj
cHUgKnZjKQogI2VuZGlmCiAKIHN0YXRpYyB2b2lkICoKLWNzY2hlZDJfYWxsb2NfdmRhdGEoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMsIHZvaWQgKmRkKQorY3Nj
aGVkMl9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hl
ZF91bml0ICp1bml0LAorICAgICAgICAgICAgICAgICAgICB2b2lkICpkZCkKIHsKKyAgICBzdHJ1
Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAq
c3ZjOwogCiAgICAgLyogQWxsb2NhdGUgcGVyLVZDUFUgaW5mbyAqLwpAQCAtMjA3MCw4ICsyMDcy
LDkgQEAgY3NjaGVkMl9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCB2Y3B1ICp2Yywgdm9pZCAqZGQpCiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWQyX3ZjcHVf
c2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2No
ZWQyX3VuaXRfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRf
dW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7CiAg
ICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNzY2hlZDJfdmNwdSh2Yyk7CiAK
ICAgICBBU1NFUlQoIWlzX2lkbGVfdmNwdSh2YykpOwpAQCAtMjA5Miw4ICsyMDk1LDkgQEAgY3Nj
aGVkMl92Y3B1X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUg
KnZjKQogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVkMl92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWQyX3VuaXRfd2FrZShjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0
cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1
ICogY29uc3Qgc3ZjID0gY3NjaGVkMl92Y3B1KHZjKTsKICAgICB1bnNpZ25lZCBpbnQgY3B1ID0g
dmMtPnByb2Nlc3NvcjsKICAgICBzX3RpbWVfdCBub3c7CkBAIC0yMTQ3LDE2ICsyMTUxLDE4IEBA
IG91dDoKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZDJfdmNwdV95aWVsZChjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQorY3NjaGVkMl91bml0X3lpZWxkKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAg
c3RydWN0IHZjcHUgKnYgPSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNw
dSAqIGNvbnN0IHN2YyA9IGNzY2hlZDJfdmNwdSh2KTsKIAogICAgIF9fc2V0X2JpdChfX0NTRkxB
R192Y3B1X3lpZWxkLCAmc3ZjLT5mbGFncyk7CiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWQyX2Nv
bnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMp
Citjc2NoZWQyX2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1
Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1
X2xpc3Q7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNzY2hlZDJfdmNw
dSh2Yyk7CiAgICAgc3BpbmxvY2tfdCAqbG9jayA9IHZjcHVfc2NoZWR1bGVfbG9ja19pcnEodmMp
OwogICAgIHNfdGltZV90IG5vdyA9IE5PVygpOwpAQCAtMjE5Nyw5ICsyMjAzLDEwIEBAIGNzY2hl
ZDJfY29udGV4dF9zYXZlZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1
ICp2YykKIAogI2RlZmluZSBNQVhfTE9BRCAoU1RJTUVfTUFYKQogc3RhdGljIGludAotY3NjaGVk
Ml9jcHVfcGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykK
K2NzY2hlZDJfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1
Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpwcnYg
PSBjc2NoZWQyX3ByaXYob3BzKTsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1X2xp
c3Q7CiAgICAgaW50IGksIG1pbl9ycWkgPSAtMSwgbWluX3NfcnFpID0gLTE7CiAgICAgdW5zaWdu
ZWQgaW50IG5ld19jcHUsIGNwdSA9IHZjLT5wcm9jZXNzb3I7CiAgICAgc3RydWN0IGNzY2hlZDJf
dmNwdSAqc3ZjID0gY3NjaGVkMl92Y3B1KHZjKTsKQEAgLTI3MzQsOSArMjc0MSwxMCBAQCByZXRy
eToKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZDJfdmNwdV9taWdyYXRlKAotICAgIGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjLCB1bnNpZ25lZCBpbnQgbmV3X2Nw
dSkKK2NzY2hlZDJfdW5pdF9taWdyYXRlKAorICAgIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsIHVuc2lnbmVkIGludCBuZXdfY3B1KQogeworICAg
IHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3QgZG9tYWluICpk
ID0gdmMtPmRvbWFpbjsKICAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICogY29uc3Qgc3ZjID0gY3Nj
aGVkMl92Y3B1KHZjKTsKICAgICBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICp0cnFkOwpA
QCAtMjk5Nyw5ICszMDA1LDEwIEBAIGNzY2hlZDJfZG9tX2NudGwoCiB9CiAKIHN0YXRpYyB2b2lk
Ci1jc2NoZWQyX2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnYsCitjc2NoZWQyX2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3Ry
dWN0IHNjaGVkX3VuaXQgKnVuaXQsCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNwdW1hc2tfdCAq
aGFyZCwgY29uc3QgY3B1bWFza190ICpzb2Z0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2ID0gdW5p
dC0+dmNwdV9saXN0OwogICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IGNzY2hlZDJfdmNw
dSh2KTsKIAogICAgIGlmICggIWhhcmQgKQpAQCAtMzA5Nyw4ICszMTA2LDkgQEAgY3NjaGVkMl9m
cmVlX2RvbWRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpkYXRhKQogfQog
CiBzdGF0aWMgdm9pZAotY3NjaGVkMl92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2NzY2hlZDJfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3Qg
dmNwdSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3Zj
ID0gdmMtPnNjaGVkX3ByaXY7CiAgICAgc3RydWN0IGNzY2hlZDJfZG9tICogY29uc3Qgc2RvbSA9
IHN2Yy0+c2RvbTsKICAgICBzcGlubG9ja190ICpsb2NrOwpAQCAtMzEwOSw3ICszMTE5LDcgQEAg
Y3NjaGVkMl92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2
Y3B1ICp2YykKICAgICAvKiBjc2NoZWQyX2NwdV9waWNrKCkgZXhwZWN0cyB0aGUgcGNwdSBsb2Nr
IHRvIGJlIGhlbGQgKi8KICAgICBsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2Yyk7CiAK
LSAgICB2Yy0+cHJvY2Vzc29yID0gY3NjaGVkMl9jcHVfcGljayhvcHMsIHZjKTsKKyAgICB2Yy0+
cHJvY2Vzc29yID0gY3NjaGVkMl9jcHVfcGljayhvcHMsIHVuaXQpOwogCiAgICAgc3Bpbl91bmxv
Y2tfaXJxKGxvY2spOwogCkBAIC0zMTM2LDggKzMxNDYsOSBAQCBjc2NoZWQyX2ZyZWVfdmRhdGEo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwcml2KQogfQogCiBzdGF0aWMgdm9p
ZAotY3NjaGVkMl92Y3B1X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVj
dCB2Y3B1ICp2YykKK2NzY2hlZDJfdW5pdF9yZW1vdmUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1
bml0LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNz
Y2hlZDJfdmNwdSh2Yyk7CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKIApAQCAtNDA4MywxOSArNDA5
NCwxOSBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHNjaGVkdWxlciBzY2hlZF9jcmVkaXQyX2RlZiA9
IHsKIAogICAgIC5nbG9iYWxfaW5pdCAgICA9IGNzY2hlZDJfZ2xvYmFsX2luaXQsCiAKLSAgICAu
aW5zZXJ0X3ZjcHUgICAgPSBjc2NoZWQyX3ZjcHVfaW5zZXJ0LAotICAgIC5yZW1vdmVfdmNwdSAg
ICA9IGNzY2hlZDJfdmNwdV9yZW1vdmUsCisgICAgLmluc2VydF91bml0ICAgID0gY3NjaGVkMl91
bml0X2luc2VydCwKKyAgICAucmVtb3ZlX3VuaXQgICAgPSBjc2NoZWQyX3VuaXRfcmVtb3ZlLAog
Ci0gICAgLnNsZWVwICAgICAgICAgID0gY3NjaGVkMl92Y3B1X3NsZWVwLAotICAgIC53YWtlICAg
ICAgICAgICA9IGNzY2hlZDJfdmNwdV93YWtlLAotICAgIC55aWVsZCAgICAgICAgICA9IGNzY2hl
ZDJfdmNwdV95aWVsZCwKKyAgICAuc2xlZXAgICAgICAgICAgPSBjc2NoZWQyX3VuaXRfc2xlZXAs
CisgICAgLndha2UgICAgICAgICAgID0gY3NjaGVkMl91bml0X3dha2UsCisgICAgLnlpZWxkICAg
ICAgICAgID0gY3NjaGVkMl91bml0X3lpZWxkLAogCiAgICAgLmFkanVzdCAgICAgICAgID0gY3Nj
aGVkMl9kb21fY250bCwKICAgICAuYWRqdXN0X2FmZmluaXR5PSBjc2NoZWQyX2FmZl9jbnRsLAog
ICAgIC5hZGp1c3RfZ2xvYmFsICA9IGNzY2hlZDJfc3lzX2NudGwsCiAKICAgICAucGlja19jcHUg
ICAgICAgPSBjc2NoZWQyX2NwdV9waWNrLAotICAgIC5taWdyYXRlICAgICAgICA9IGNzY2hlZDJf
dmNwdV9taWdyYXRlLAorICAgIC5taWdyYXRlICAgICAgICA9IGNzY2hlZDJfdW5pdF9taWdyYXRl
LAogICAgIC5kb19zY2hlZHVsZSAgICA9IGNzY2hlZDJfc2NoZWR1bGUsCiAgICAgLmNvbnRleHRf
c2F2ZWQgID0gY3NjaGVkMl9jb250ZXh0X3NhdmVkLAogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9u
L3NjaGVkX251bGwuYyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCmluZGV4IDY3ODJlY2RhNWMu
LmE1YTljZTJkNTcgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCisrKyBiL3hl
bi9jb21tb24vc2NoZWRfbnVsbC5jCkBAIC0xODYsOCArMTg2LDkgQEAgc3RhdGljIHZvaWQgbnVs
bF9kZWluaXRfcGRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwY3B1LCBp
bnQgY3B1KQogfQogCiBzdGF0aWMgdm9pZCAqbnVsbF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmNw
dSAqdiwgdm9pZCAqZGQpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2No
ZWRfdW5pdCAqdW5pdCwgdm9pZCAqZGQpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSB1bml0LT52
Y3B1X2xpc3Q7CiAgICAgc3RydWN0IG51bGxfdmNwdSAqbnZjOwogCiAgICAgbnZjID0geHphbGxv
YyhzdHJ1Y3QgbnVsbF92Y3B1KTsKQEAgLTQzNSw4ICs0MzYsMTAgQEAgc3RhdGljIHNwaW5sb2Nr
X3QgKm51bGxfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsCiAgICAgcmV0
dXJuICZzZC0+X2xvY2s7CiB9CiAKLXN0YXRpYyB2b2lkIG51bGxfdmNwdV9pbnNlcnQoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdikKK3N0YXRpYyB2b2lkIG51bGxf
dW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNw
dSAqdiA9IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3QgbnVsbF9wcml2YXRlICpwcnYgPSBu
dWxsX3ByaXYob3BzKTsKICAgICBzdHJ1Y3QgbnVsbF92Y3B1ICpudmMgPSBudWxsX3ZjcHUodik7
CiAgICAgdW5zaWduZWQgaW50IGNwdTsKQEAgLTQ5Niw4ICs0OTksMTAgQEAgc3RhdGljIHZvaWQg
bnVsbF92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1
ICp2KQogICAgIFNDSEVEX1NUQVRfQ1JBTksodmNwdV9pbnNlcnQpOwogfQogCi1zdGF0aWMgdm9p
ZCBudWxsX3ZjcHVfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnYpCitzdGF0aWMgdm9pZCBudWxsX3VuaXRfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQg
KnVuaXQpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgc3Ry
dWN0IG51bGxfcHJpdmF0ZSAqcHJ2ID0gbnVsbF9wcml2KG9wcyk7CiAgICAgc3RydWN0IG51bGxf
dmNwdSAqbnZjID0gbnVsbF92Y3B1KHYpOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CkBAIC01MzIs
OCArNTM3LDEwIEBAIHN0YXRpYyB2b2lkIG51bGxfdmNwdV9yZW1vdmUoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdikKICAgICBTQ0hFRF9TVEFUX0NSQU5LKHZjcHVf
cmVtb3ZlKTsKIH0KIAotc3RhdGljIHZvaWQgbnVsbF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdikKK3N0YXRpYyB2b2lkIG51bGxfdW5pdF93YWtl
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2ID0gdW5pdC0+
dmNwdV9saXN0OwogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiA9IG51bGxfcHJpdihvcHMp
OwogICAgIHN0cnVjdCBudWxsX3ZjcHUgKm52YyA9IG51bGxfdmNwdSh2KTsKICAgICB1bnNpZ25l
ZCBpbnQgY3B1ID0gdi0+cHJvY2Vzc29yOwpAQCAtNjA0LDggKzYxMSwxMCBAQCBzdGF0aWMgdm9p
ZCBudWxsX3ZjcHVfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1
ICp2KQogICAgIGNwdV9yYWlzZV9zb2Z0aXJxKHYtPnByb2Nlc3NvciwgU0NIRURVTEVfU09GVElS
USk7CiB9CiAKLXN0YXRpYyB2b2lkIG51bGxfdmNwdV9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIHZvaWQgbnVsbF91bml0X3NsZWVwKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IHVuaXQtPnZj
cHVfbGlzdDsKICAgICBzdHJ1Y3QgbnVsbF9wcml2YXRlICpwcnYgPSBudWxsX3ByaXYob3BzKTsK
ICAgICB1bnNpZ25lZCBpbnQgY3B1ID0gdi0+cHJvY2Vzc29yOwogICAgIGJvb2wgdGlja2xlZCA9
IGZhbHNlOwpAQCAtNjM3LDE1ICs2NDYsMTggQEAgc3RhdGljIHZvaWQgbnVsbF92Y3B1X3NsZWVw
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYpCiAgICAgU0NIRURf
U1RBVF9DUkFOSyh2Y3B1X3NsZWVwKTsKIH0KIAotc3RhdGljIGludCBudWxsX2NwdV9waWNrKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgaW50IG51
bGxfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAorICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2
Y3B1ICp2ID0gdW5pdC0+dmNwdV9saXN0OwogICAgIEFTU0VSVCghaXNfaWRsZV92Y3B1KHYpKTsK
ICAgICByZXR1cm4gcGlja19jcHUobnVsbF9wcml2KG9wcyksIHYpOwogfQogCi1zdGF0aWMgdm9p
ZCBudWxsX3ZjcHVfbWlncmF0ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2
Y3B1ICp2LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG5ld19j
cHUpCitzdGF0aWMgdm9pZCBudWxsX3VuaXRfbWlncmF0ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAq
dW5pdCwgdW5zaWduZWQgaW50IG5ld19jcHUpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSB1bml0
LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IG51bGxfcHJpdmF0ZSAqcHJ2ID0gbnVsbF9wcml2KG9w
cyk7CiAgICAgc3RydWN0IG51bGxfdmNwdSAqbnZjID0gbnVsbF92Y3B1KHYpOwogCkBAIC05NjUs
MTMgKzk3NywxMyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHNjaGVkdWxlciBzY2hlZF9udWxsX2Rl
ZiA9IHsKICAgICAuYWxsb2NfZG9tZGF0YSAgPSBudWxsX2FsbG9jX2RvbWRhdGEsCiAgICAgLmZy
ZWVfZG9tZGF0YSAgID0gbnVsbF9mcmVlX2RvbWRhdGEsCiAKLSAgICAuaW5zZXJ0X3ZjcHUgICAg
PSBudWxsX3ZjcHVfaW5zZXJ0LAotICAgIC5yZW1vdmVfdmNwdSAgICA9IG51bGxfdmNwdV9yZW1v
dmUsCisgICAgLmluc2VydF91bml0ICAgID0gbnVsbF91bml0X2luc2VydCwKKyAgICAucmVtb3Zl
X3VuaXQgICAgPSBudWxsX3VuaXRfcmVtb3ZlLAogCi0gICAgLndha2UgICAgICAgICAgID0gbnVs
bF92Y3B1X3dha2UsCi0gICAgLnNsZWVwICAgICAgICAgID0gbnVsbF92Y3B1X3NsZWVwLAorICAg
IC53YWtlICAgICAgICAgICA9IG51bGxfdW5pdF93YWtlLAorICAgIC5zbGVlcCAgICAgICAgICA9
IG51bGxfdW5pdF9zbGVlcCwKICAgICAucGlja19jcHUgICAgICAgPSBudWxsX2NwdV9waWNrLAot
ICAgIC5taWdyYXRlICAgICAgICA9IG51bGxfdmNwdV9taWdyYXRlLAorICAgIC5taWdyYXRlICAg
ICAgICA9IG51bGxfdW5pdF9taWdyYXRlLAogICAgIC5kb19zY2hlZHVsZSAgICA9IG51bGxfc2No
ZWR1bGUsCiAKICAgICAuZHVtcF9jcHVfc3RhdGUgPSBudWxsX2R1bXBfcGNwdSwKZGlmZiAtLWdp
dCBhL3hlbi9jb21tb24vc2NoZWRfcnQuYyBiL3hlbi9jb21tb24vc2NoZWRfcnQuYwppbmRleCBl
MGUzNTBiZGYzLi4wZjVlMGViY2MxIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX3J0LmMK
KysrIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCkBAIC0xMzYsNyArMTM2LDcgQEAKICAqIFJURFNf
ZGVsYXllZF9ydW5xX2FkZDogRG8gd2UgbmVlZCB0byBhZGQgdGhpcyB0byB0aGUgUnVuUS9EZXBs
ZXRlZFEKICAqIG9uY2UgaXQncyBkb25lIGJlaW5nIGNvbnRleHQgc3dpdGNoaW5nIG91dD8KICAq
ICsgU2V0IHdoZW4gc2NoZWR1bGluZyBvdXQgaW4gcnRfc2NoZWR1bGUoKSBpZiBwcmV2IGlzIHJ1
bmFibGUKLSAqICsgU2V0IGluIHJ0X3ZjcHVfd2FrZSBpZiBpdCBmaW5kcyBSVERTX3NjaGVkdWxl
ZCBzZXQKKyAqICsgU2V0IGluIHJ0X3VuaXRfd2FrZSBpZiBpdCBmaW5kcyBSVERTX3NjaGVkdWxl
ZCBzZXQKICAqICsgUmVhZCBpbiBydF9jb250ZXh0X3NhdmVkKCkuIElmIHNldCwgaXQgYWRkcyBw
cmV2IHRvIHRoZSBSdW5xdWV1ZS9EZXBsZXRlZFEKICAqICAgYW5kIGNsZWFycyB0aGUgYml0Lgog
ICovCkBAIC02MzYsOCArNjM2LDkgQEAgcmVwbHFfcmVpbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3QgcnRfdmNwdSAqc3ZjKQogICogYW5kIGF2YWlsYWJsZSBjcHVzCiAg
Ki8KIHN0YXRpYyBpbnQKLXJ0X2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHZjcHUgKnZjKQorcnRfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
LCBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMg
PSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgY3B1bWFza190IGNwdXM7CiAgICAgY3B1bWFza190ICpv
bmxpbmU7CiAgICAgaW50IGNwdTsKQEAgLTgzNyw4ICs4MzgsOSBAQCBydF9mcmVlX2RvbWRhdGEo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpkYXRhKQogfQogCiBzdGF0aWMgdm9p
ZCAqCi1ydF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2
Y3B1ICp2Yywgdm9pZCAqZGQpCitydF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LCB2b2lkICpkZCkKIHsKKyAgICBzdHJ1Y3Qg
dmNwdSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7CiAgICAgc3RydWN0IHJ0X3ZjcHUgKnN2YzsKIAog
ICAgIC8qIEFsbG9jYXRlIHBlci1WQ1BVIGluZm8gKi8KQEAgLTg4MCw4ICs4ODIsOSBAQCBydF9m
cmVlX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgdm9pZCAqcHJpdikKICAqIGRl
c3QuIGNwdXBvb2wuCiAgKi8KIHN0YXRpYyB2b2lkCi1ydF92Y3B1X2luc2VydChjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK3J0X3VuaXRfaW5zZXJ0KGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAg
c3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdV9saXN0OwogICAgIHN0cnVjdCBydF92Y3B1ICpz
dmMgPSBydF92Y3B1KHZjKTsKICAgICBzX3RpbWVfdCBub3c7CiAgICAgc3BpbmxvY2tfdCAqbG9j
azsKQEAgLTg4OSw3ICs4OTIsNyBAQCBydF92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKICAgICBCVUdfT04oIGlzX2lkbGVfdmNwdSh2Yykg
KTsKIAogICAgIC8qIFRoaXMgaXMgc2FmZSBiZWNhdXNlIHZjIGlzbid0IHlldCBiZWluZyBzY2hl
ZHVsZWQgKi8KLSAgICB2Yy0+cHJvY2Vzc29yID0gcnRfY3B1X3BpY2sob3BzLCB2Yyk7CisgICAg
dmMtPnByb2Nlc3NvciA9IHJ0X2NwdV9waWNrKG9wcywgdW5pdCk7CiAKICAgICBsb2NrID0gdmNw
dV9zY2hlZHVsZV9sb2NrX2lycSh2Yyk7CiAKQEAgLTkxMyw4ICs5MTYsOSBAQCBydF92Y3B1X2lu
c2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKICAqIFJl
bW92ZSBydF92Y3B1IHN2YyBmcm9tIHRoZSBvbGQgc2NoZWR1bGVyIGluIHNvdXJjZSBjcHVwb29s
LgogICovCiBzdGF0aWMgdm9pZAotcnRfdmNwdV9yZW1vdmUoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitydF91bml0X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1
ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3QgcnRfdmNwdSAqIGNvbnN0IHN2YyA9
IHJ0X3ZjcHUodmMpOwogICAgIHN0cnVjdCBydF9kb20gKiBjb25zdCBzZG9tID0gc3ZjLT5zZG9t
OwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CkBAIC0xMTMzLDggKzExMzcsOSBAQCBydF9zY2hlZHVs
ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHNfdGltZV90IG5vdywgYm9vbF90IHRhc2ts
ZXRfd29ya19zY2hlZAogICogVGhlIGxvY2sgaXMgYWxyZWFkeSBncmFiYmVkIGluIHNjaGVkdWxl
LmMsIG5vIG5lZWQgdG8gbG9jayBoZXJlCiAgKi8KIHN0YXRpYyB2b2lkCi1ydF92Y3B1X3NsZWVw
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorcnRfdW5pdF9z
bGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0
KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKICAgICBzdHJ1Y3Qg
cnRfdmNwdSAqIGNvbnN0IHN2YyA9IHJ0X3ZjcHUodmMpOwogCiAgICAgQlVHX09OKCBpc19pZGxl
X3ZjcHUodmMpICk7CkBAIC0xMjQ4LDggKzEyNTMsOSBAQCBydW5xX3RpY2tsZShjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBydF92Y3B1ICpuZXcpCiAgKiBUT0RPOiB3aGF0IGlm
IHRoZXNlIHR3byB2Y3B1cyBiZWxvbmdzIHRvIHRoZSBzYW1lIGRvbWFpbj8KICAqLwogc3RhdGlj
IHZvaWQKLXJ0X3ZjcHVfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2
Y3B1ICp2YykKK3J0X3VuaXRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVj
dCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVf
bGlzdDsKICAgICBzdHJ1Y3QgcnRfdmNwdSAqIGNvbnN0IHN2YyA9IHJ0X3ZjcHUodmMpOwogICAg
IHNfdGltZV90IG5vdzsKICAgICBib29sX3QgbWlzc2VkOwpAQCAtMTMxOCw4ICsxMzI0LDkgQEAg
cnRfdmNwdV93YWtlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZj
KQogICogYW5kIHRoZW4gcGljayB0aGUgaGlnaGVzdCBwcmlvcml0eSB2Y3B1IGZyb20gcnVucSB0
byBydW4KICAqLwogc3RhdGljIHZvaWQKLXJ0X2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitydF9jb250ZXh0X3NhdmVkKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAgc3Ry
dWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdV9saXN0OwogICAgIHN0cnVjdCBydF92Y3B1ICpzdmMg
PSBydF92Y3B1KHZjKTsKICAgICBzcGlubG9ja190ICpsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2Nr
X2lycSh2Yyk7CiAKQEAgLTE1NDgsMTUgKzE1NTUsMTUgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgc2NoZWRfcnRkc19kZWYgPSB7CiAgICAgLmZyZWVfZG9tZGF0YSAgID0gcnRfZnJl
ZV9kb21kYXRhLAogICAgIC5hbGxvY192ZGF0YSAgICA9IHJ0X2FsbG9jX3ZkYXRhLAogICAgIC5m
cmVlX3ZkYXRhICAgICA9IHJ0X2ZyZWVfdmRhdGEsCi0gICAgLmluc2VydF92Y3B1ICAgID0gcnRf
dmNwdV9pbnNlcnQsCi0gICAgLnJlbW92ZV92Y3B1ICAgID0gcnRfdmNwdV9yZW1vdmUsCisgICAg
Lmluc2VydF91bml0ICAgID0gcnRfdW5pdF9pbnNlcnQsCisgICAgLnJlbW92ZV91bml0ICAgID0g
cnRfdW5pdF9yZW1vdmUsCiAKICAgICAuYWRqdXN0ICAgICAgICAgPSBydF9kb21fY250bCwKIAog
ICAgIC5waWNrX2NwdSAgICAgICA9IHJ0X2NwdV9waWNrLAogICAgIC5kb19zY2hlZHVsZSAgICA9
IHJ0X3NjaGVkdWxlLAotICAgIC5zbGVlcCAgICAgICAgICA9IHJ0X3ZjcHVfc2xlZXAsCi0gICAg
Lndha2UgICAgICAgICAgID0gcnRfdmNwdV93YWtlLAorICAgIC5zbGVlcCAgICAgICAgICA9IHJ0
X3VuaXRfc2xlZXAsCisgICAgLndha2UgICAgICAgICAgID0gcnRfdW5pdF93YWtlLAogICAgIC5j
b250ZXh0X3NhdmVkICA9IHJ0X2NvbnRleHRfc2F2ZWQsCiB9OwogCmRpZmYgLS1naXQgYS94ZW4v
Y29tbW9uL3NjaGVkdWxlLmMgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKaW5kZXggMTNiNWZmYzdj
Zi4uNDFhZjUyYmMyYiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jCisrKyBiL3hl
bi9jb21tb24vc2NoZWR1bGUuYwpAQCAtODcsMTMgKzg3LDEzIEBAIHNjaGVkX2lkbGVfc3dpdGNo
X3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiB9CiAK
IHN0YXRpYyBpbnQKLXNjaGVkX2lkbGVfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3QgdmNwdSAqdikKK3NjaGVkX2lkbGVfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKLSAgICByZXR1
cm4gdi0+cHJvY2Vzc29yOworICAgIHJldHVybiB1bml0LT52Y3B1X2xpc3QtPnByb2Nlc3NvcjsK
IH0KIAogc3RhdGljIHZvaWQgKgotc2NoZWRfaWRsZV9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2LAorc2NoZWRfaWRsZV9hbGxvY192ZGF0YShj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAogICAg
ICAgICAgICAgICAgICAgICAgICB2b2lkICpkZCkKIHsKICAgICAvKiBBbnkgbm9uLU5VTEwgcG9p
bnRlciBpcyBmaW5lIGhlcmUuICovCkBAIC0zMDgsOSArMzA4LDE3IEBAIHN0YXRpYyB2b2lkIHNj
aGVkX3NwaW5fdW5sb2NrX2RvdWJsZShzcGlubG9ja190ICpsb2NrMSwgc3BpbmxvY2tfdCAqbG9j
azIsCiBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgcHJv
Y2Vzc29yKQogewogICAgIHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21haW47CisgICAgc3RydWN0
IHNjaGVkX3VuaXQgKnVuaXQ7CiAKICAgICB2LT5wcm9jZXNzb3IgPSBwcm9jZXNzb3I7CiAKKyAg
ICBpZiAoICh1bml0ID0geHphbGxvYyhzdHJ1Y3Qgc2NoZWRfdW5pdCkpID09IE5VTEwgKQorICAg
ICAgICByZXR1cm4gMTsKKyAgICB1bml0LT52Y3B1X2xpc3QgPSB2OworICAgIHVuaXQtPnVuaXRf
aWQgPSB2LT52Y3B1X2lkOworICAgIHVuaXQtPmRvbWFpbiA9IGQ7CisgICAgdi0+c2NoZWRfdW5p
dCA9IHVuaXQ7CisKICAgICAvKiBJbml0aWFsaXNlIHRoZSBwZXItdmNwdSB0aW1lcnMuICovCiAg
ICAgc3Bpbl9sb2NrX2luaXQoJnYtPnBlcmlvZGljX3RpbWVyX2xvY2spOwogICAgIGluaXRfdGlt
ZXIoJnYtPnBlcmlvZGljX3RpbWVyLCB2Y3B1X3BlcmlvZGljX3RpbWVyX2ZuLApAQCAtMzIwLDkg
KzMyOCwxMyBAQCBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBp
bnQgcHJvY2Vzc29yKQogICAgIGluaXRfdGltZXIoJnYtPnBvbGxfdGltZXIsIHBvbGxfdGltZXJf
Zm4sCiAgICAgICAgICAgICAgICB2LCB2LT5wcm9jZXNzb3IpOwogCi0gICAgdi0+c2NoZWRfcHJp
diA9IHNjaGVkX2FsbG9jX3ZkYXRhKGRvbV9zY2hlZHVsZXIoZCksIHYsIGQtPnNjaGVkX3ByaXYp
OworICAgIHYtPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxvY192ZGF0YShkb21fc2NoZWR1bGVyKGQp
LCB1bml0LCBkLT5zY2hlZF9wcml2KTsKICAgICBpZiAoIHYtPnNjaGVkX3ByaXYgPT0gTlVMTCAp
CisgICAgeworICAgICAgICB2LT5zY2hlZF91bml0ID0gTlVMTDsKKyAgICAgICAgeGZyZWUodW5p
dCk7CiAgICAgICAgIHJldHVybiAxOworICAgIH0KIAogICAgIC8qCiAgICAgICogSW5pdGlhbGl6
ZSBhZmZpbml0eSBzZXR0aW5ncy4gVGhlIGlkbGVyLCBhbmQgcG90ZW50aWFsbHkKQEAgLTM0MSw3
ICszNTMsNyBAQCBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBp
bnQgcHJvY2Vzc29yKQogICAgIH0KICAgICBlbHNlCiAgICAgewotICAgICAgICBzY2hlZF9pbnNl
cnRfdmNwdShkb21fc2NoZWR1bGVyKGQpLCB2KTsKKyAgICAgICAgc2NoZWRfaW5zZXJ0X3VuaXQo
ZG9tX3NjaGVkdWxlcihkKSwgdW5pdCk7CiAgICAgfQogCiAgICAgcmV0dXJuIDA7CkBAIC0zODIs
NyArMzk0LDggQEAgaW50IHNjaGVkX21vdmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVj
dCBjcHVwb29sICpjKQogCiAgICAgZm9yX2VhY2hfdmNwdSAoIGQsIHYgKQogICAgIHsKLSAgICAg
ICAgdmNwdV9wcml2W3YtPnZjcHVfaWRdID0gc2NoZWRfYWxsb2NfdmRhdGEoYy0+c2NoZWQsIHYs
IGRvbWRhdGEpOworICAgICAgICB2Y3B1X3ByaXZbdi0+dmNwdV9pZF0gPSBzY2hlZF9hbGxvY192
ZGF0YShjLT5zY2hlZCwgdi0+c2NoZWRfdW5pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZG9tZGF0YSk7CiAgICAgICAgIGlmICggdmNwdV9wcml2
W3YtPnZjcHVfaWRdID09IE5VTEwgKQogICAgICAgICB7CiAgICAgICAgICAgICBmb3JfZWFjaF92
Y3B1ICggZCwgdiApCkBAIC00MDAsNyArNDEzLDcgQEAgaW50IHNjaGVkX21vdmVfZG9tYWluKHN0
cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogCiAgICAgZm9yX2VhY2hfdmNwdSAo
IGQsIHYgKQogICAgIHsKLSAgICAgICAgc2NoZWRfcmVtb3ZlX3ZjcHUob2xkX29wcywgdik7Cisg
ICAgICAgIHNjaGVkX3JlbW92ZV91bml0KG9sZF9vcHMsIHYtPnNjaGVkX3VuaXQpOwogICAgIH0K
IAogICAgIGQtPmNwdXBvb2wgPSBjOwpAQCAtNDM1LDcgKzQ0OCw3IEBAIGludCBzY2hlZF9tb3Zl
X2RvbWFpbihzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKIAogICAgICAgICBu
ZXdfcCA9IGNwdW1hc2tfY3ljbGUobmV3X3AsIGMtPmNwdV92YWxpZCk7CiAKLSAgICAgICAgc2No
ZWRfaW5zZXJ0X3ZjcHUoYy0+c2NoZWQsIHYpOworICAgICAgICBzY2hlZF9pbnNlcnRfdW5pdChj
LT5zY2hlZCwgdi0+c2NoZWRfdW5pdCk7CiAKICAgICAgICAgc2NoZWRfZnJlZV92ZGF0YShvbGRf
b3BzLCB2Y3B1ZGF0YSk7CiAgICAgfQpAQCAtNDUzLDEzICs0NjYsMTcgQEAgaW50IHNjaGVkX21v
dmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogCiB2b2lkIHNj
aGVkX2Rlc3Ryb3lfdmNwdShzdHJ1Y3QgdmNwdSAqdikKIHsKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5p
dCAqdW5pdCA9IHYtPnNjaGVkX3VuaXQ7CisKICAgICBraWxsX3RpbWVyKCZ2LT5wZXJpb2RpY190
aW1lcik7CiAgICAga2lsbF90aW1lcigmdi0+c2luZ2xlc2hvdF90aW1lcik7CiAgICAga2lsbF90
aW1lcigmdi0+cG9sbF90aW1lcik7CiAgICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9ib29sKHYtPmlz
X3VyZ2VudCkgKQogICAgICAgICBhdG9taWNfZGVjKCZwZXJfY3B1KHNjaGVkdWxlX2RhdGEsIHYt
PnByb2Nlc3NvcikudXJnZW50X2NvdW50KTsKLSAgICBzY2hlZF9yZW1vdmVfdmNwdSh2Y3B1X3Nj
aGVkdWxlcih2KSwgdik7CisgICAgc2NoZWRfcmVtb3ZlX3VuaXQodmNwdV9zY2hlZHVsZXIodiks
IHVuaXQpOwogICAgIHNjaGVkX2ZyZWVfdmRhdGEodmNwdV9zY2hlZHVsZXIodiksIHYtPnNjaGVk
X3ByaXYpOworICAgIHYtPnNjaGVkX3VuaXQgPSBOVUxMOworICAgIHhmcmVlKHVuaXQpOwogfQog
CiBpbnQgc2NoZWRfaW5pdF9kb21haW4oc3RydWN0IGRvbWFpbiAqZCwgaW50IHBvb2xpZCkKQEAg
LTUxMCw3ICs1MjcsNyBAQCB2b2lkIHZjcHVfc2xlZXBfbm9zeW5jX2xvY2tlZChzdHJ1Y3QgdmNw
dSAqdikKICAgICAgICAgaWYgKCB2LT5ydW5zdGF0ZS5zdGF0ZSA9PSBSVU5TVEFURV9ydW5uYWJs
ZSApCiAgICAgICAgICAgICB2Y3B1X3J1bnN0YXRlX2NoYW5nZSh2LCBSVU5TVEFURV9vZmZsaW5l
LCBOT1coKSk7CiAKLSAgICAgICAgc2NoZWRfc2xlZXAodmNwdV9zY2hlZHVsZXIodiksIHYpOwor
ICAgICAgICBzY2hlZF9zbGVlcCh2Y3B1X3NjaGVkdWxlcih2KSwgdi0+c2NoZWRfdW5pdCk7CiAg
ICAgfQogfQogCkBAIC01NTEsNyArNTY4LDcgQEAgdm9pZCB2Y3B1X3dha2Uoc3RydWN0IHZjcHUg
KnYpCiAgICAgewogICAgICAgICBpZiAoIHYtPnJ1bnN0YXRlLnN0YXRlID49IFJVTlNUQVRFX2Js
b2NrZWQgKQogICAgICAgICAgICAgdmNwdV9ydW5zdGF0ZV9jaGFuZ2UodiwgUlVOU1RBVEVfcnVu
bmFibGUsIE5PVygpKTsKLSAgICAgICAgc2NoZWRfd2FrZSh2Y3B1X3NjaGVkdWxlcih2KSwgdik7
CisgICAgICAgIHNjaGVkX3dha2UodmNwdV9zY2hlZHVsZXIodiksIHYtPnNjaGVkX3VuaXQpOwog
ICAgIH0KICAgICBlbHNlIGlmICggISh2LT5wYXVzZV9mbGFncyAmIFZQRl9ibG9ja2VkKSApCiAg
ICAgewpAQCAtNjA2LDcgKzYyMyw3IEBAIHN0YXRpYyB2b2lkIHZjcHVfbW92ZV9sb2NrZWQoc3Ry
dWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBuZXdfY3B1KQogICAgICAqIEFjdHVhbCBDUFUgc3dp
dGNoIHRvIG5ldyBDUFUuICBUaGlzIGlzIHNhZmUgYmVjYXVzZSB0aGUgbG9jawogICAgICAqIHBv
aW50ZXIgY2FuJ3QgY2hhbmdlIHdoaWxlIHRoZSBjdXJyZW50IGxvY2sgaXMgaGVsZC4KICAgICAg
Ki8KLSAgICBzY2hlZF9taWdyYXRlKHZjcHVfc2NoZWR1bGVyKHYpLCB2LCBuZXdfY3B1KTsKKyAg
ICBzY2hlZF9taWdyYXRlKHZjcHVfc2NoZWR1bGVyKHYpLCB2LT5zY2hlZF91bml0LCBuZXdfY3B1
KTsKIH0KIAogLyoKQEAgLTY4NCw3ICs3MDEsNyBAQCBzdGF0aWMgdm9pZCB2Y3B1X21pZ3JhdGVf
ZmluaXNoKHN0cnVjdCB2Y3B1ICp2KQogICAgICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAg
ICAgICAvKiBTZWxlY3QgYSBuZXcgQ1BVLiAqLwotICAgICAgICAgICAgbmV3X2NwdSA9IHNjaGVk
X3BpY2tfY3B1KHZjcHVfc2NoZWR1bGVyKHYpLCB2KTsKKyAgICAgICAgICAgIG5ld19jcHUgPSBz
Y2hlZF9waWNrX2NwdSh2Y3B1X3NjaGVkdWxlcih2KSwgdi0+c2NoZWRfdW5pdCk7CiAgICAgICAg
ICAgICBpZiAoIChuZXdfbG9jayA9PSBwZXJfY3B1KHNjaGVkdWxlX2RhdGEsIG5ld19jcHUpLnNj
aGVkdWxlX2xvY2spICYmCiAgICAgICAgICAgICAgICAgIGNwdW1hc2tfdGVzdF9jcHUobmV3X2Nw
dSwgdi0+ZG9tYWluLT5jcHVwb29sLT5jcHVfdmFsaWQpICkKICAgICAgICAgICAgICAgICBicmVh
azsKQEAgLTc3Niw3ICs3OTMsNyBAQCB2b2lkIHJlc3RvcmVfdmNwdV9hZmZpbml0eShzdHJ1Y3Qg
ZG9tYWluICpkKQogCiAgICAgICAgIC8qIHYtPnByb2Nlc3NvciBtaWdodCBoYXZlIGNoYW5nZWQs
IHNvIHJlYWNxdWlyZSB0aGUgbG9jay4gKi8KICAgICAgICAgbG9jayA9IHZjcHVfc2NoZWR1bGVf
bG9ja19pcnEodik7Ci0gICAgICAgIHYtPnByb2Nlc3NvciA9IHNjaGVkX3BpY2tfY3B1KHZjcHVf
c2NoZWR1bGVyKHYpLCB2KTsKKyAgICAgICAgdi0+cHJvY2Vzc29yID0gc2NoZWRfcGlja19jcHUo
dmNwdV9zY2hlZHVsZXIodiksIHYtPnNjaGVkX3VuaXQpOwogICAgICAgICBzcGluX3VubG9ja19p
cnEobG9jayk7CiAKICAgICAgICAgaWYgKCBvbGRfY3B1ICE9IHYtPnByb2Nlc3NvciApCkBAIC04
ODgsNyArOTA1LDcgQEAgc3RhdGljIGludCBjcHVfZGlzYWJsZV9zY2hlZHVsZXJfY2hlY2sodW5z
aWduZWQgaW50IGNwdSkKIHZvaWQgc2NoZWRfc2V0X2FmZmluaXR5KAogICAgIHN0cnVjdCB2Y3B1
ICp2LCBjb25zdCBjcHVtYXNrX3QgKmhhcmQsIGNvbnN0IGNwdW1hc2tfdCAqc29mdCkKIHsKLSAg
ICBzY2hlZF9hZGp1c3RfYWZmaW5pdHkoZG9tX3NjaGVkdWxlcih2LT5kb21haW4pLCB2LCBoYXJk
LCBzb2Z0KTsKKyAgICBzY2hlZF9hZGp1c3RfYWZmaW5pdHkoZG9tX3NjaGVkdWxlcih2LT5kb21h
aW4pLCB2LT5zY2hlZF91bml0LCBoYXJkLCBzb2Z0KTsKIAogICAgIGlmICggaGFyZCApCiAgICAg
ICAgIGNwdW1hc2tfY29weSh2LT5jcHVfaGFyZF9hZmZpbml0eSwgaGFyZCk7CkBAIC0xMDYzLDcg
KzEwODAsNyBAQCBsb25nIHZjcHVfeWllbGQodm9pZCkKICAgICBzdHJ1Y3QgdmNwdSAqIHY9Y3Vy
cmVudDsKICAgICBzcGlubG9ja190ICpsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2KTsK
IAotICAgIHNjaGVkX3lpZWxkKHZjcHVfc2NoZWR1bGVyKHYpLCB2KTsKKyAgICBzY2hlZF95aWVs
ZCh2Y3B1X3NjaGVkdWxlcih2KSwgdi0+c2NoZWRfdW5pdCk7CiAgICAgdmNwdV9zY2hlZHVsZV91
bmxvY2tfaXJxKGxvY2ssIHYpOwogCiAgICAgU0NIRURfU1RBVF9DUkFOSyh2Y3B1X3lpZWxkKTsK
QEAgLTE2MTIsNyArMTYyOSw3IEBAIHZvaWQgY29udGV4dF9zYXZlZChzdHJ1Y3QgdmNwdSAqcHJl
dikKICAgICAvKiBDaGVjayBmb3IgbWlncmF0aW9uIHJlcXVlc3QgL2FmdGVyLyBjbGVhcmluZyBy
dW5uaW5nIGZsYWcuICovCiAgICAgc21wX21iKCk7CiAKLSAgICBzY2hlZF9jb250ZXh0X3NhdmVk
KHZjcHVfc2NoZWR1bGVyKHByZXYpLCBwcmV2KTsKKyAgICBzY2hlZF9jb250ZXh0X3NhdmVkKHZj
cHVfc2NoZWR1bGVyKHByZXYpLCBwcmV2LT5zY2hlZF91bml0KTsKIAogICAgIHZjcHVfbWlncmF0
ZV9maW5pc2gocHJldik7CiB9CkBAIC0xODg4LDcgKzE5MDUsOCBAQCBpbnQgc2NoZWR1bGVfY3B1
X3N3aXRjaCh1bnNpZ25lZCBpbnQgY3B1LCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICBwcHJpdiA9
IHNjaGVkX2FsbG9jX3BkYXRhKG5ld19vcHMsIGNwdSk7CiAgICAgaWYgKCBJU19FUlIocHByaXYp
ICkKICAgICAgICAgcmV0dXJuIFBUUl9FUlIocHByaXYpOwotICAgIHZwcml2ID0gc2NoZWRfYWxs
b2NfdmRhdGEobmV3X29wcywgaWRsZSwgaWRsZS0+ZG9tYWluLT5zY2hlZF9wcml2KTsKKyAgICB2
cHJpdiA9IHNjaGVkX2FsbG9jX3ZkYXRhKG5ld19vcHMsIGlkbGUtPnNjaGVkX3VuaXQsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpZGxlLT5kb21haW4tPnNjaGVkX3ByaXYpOwogICAg
IGlmICggdnByaXYgPT0gTlVMTCApCiAgICAgewogICAgICAgICBzY2hlZF9mcmVlX3BkYXRhKG5l
d19vcHMsIHBwcml2LCBjcHUpOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlm
LmggYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaAppbmRleCBkYzI1NWIwNjRiLi4wYWY4OWZi
ZDAyIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaAorKysgYi94ZW4vaW5j
bHVkZS94ZW4vc2NoZWQtaWYuaApAQCAtMTQxLDggKzE0MSw4IEBAIHN0cnVjdCBzY2hlZHVsZXIg
ewogICAgIHZvaWQgICAgICAgICAoKmRlaW5pdCkgICAgICAgICAoc3RydWN0IHNjaGVkdWxlciAq
KTsKIAogICAgIHZvaWQgICAgICAgICAoKmZyZWVfdmRhdGEpICAgICAoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqLCB2b2lkICopOwotICAgIHZvaWQgKiAgICAgICAoKmFsbG9jX3ZkYXRhKSAgICAo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdm9pZCAqKTsKKyAgICB2b2lkICogICAgICAgKCphbGxvY192
ZGF0YSkgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICosIHZvaWQgKik7CiAgICAgdm9pZCAg
ICAgICAgICgqZnJlZV9wZGF0YSkgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHZvaWQg
KiwgaW50KTsKICAgICB2b2lkICogICAgICAgKCphbGxvY19wZGF0YSkgICAgKGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKiwgaW50KTsKICAgICB2b2lkICAgICAgICAgKCppbml0X3BkYXRhKSAgICAg
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgdm9pZCAqLCBpbnQpOwpAQCAtMTU2LDI0ICsxNTYs
MzIgQEAgc3RydWN0IHNjaGVkdWxlciB7CiAgICAgc3BpbmxvY2tfdCAqICgqc3dpdGNoX3NjaGVk
KSAgIChzdHJ1Y3Qgc2NoZWR1bGVyICosIHVuc2lnbmVkIGludCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZvaWQgKiwgdm9pZCAqKTsKIAotICAgIC8qIEFjdGl2YXRlIC8g
ZGVhY3RpdmF0ZSB2Y3B1cyBpbiBhIGNwdSBwb29sICovCi0gICAgdm9pZCAgICAgICAgICgqaW5z
ZXJ0X3ZjcHUpICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2Y3B1ICopOwot
ICAgIHZvaWQgICAgICAgICAoKnJlbW92ZV92Y3B1KSAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqLCBzdHJ1Y3QgdmNwdSAqKTsKLQotICAgIHZvaWQgICAgICAgICAoKnNsZWVwKSAgICAgICAg
ICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqKTsKLSAgICB2b2lkICAg
ICAgICAgKCp3YWtlKSAgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0
IHZjcHUgKik7Ci0gICAgdm9pZCAgICAgICAgICgqeWllbGQpICAgICAgICAgIChjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2Y3B1ICopOwotICAgIHZvaWQgICAgICAgICAoKmNvbnRl
eHRfc2F2ZWQpICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqKTsKKyAg
ICAvKiBBY3RpdmF0ZSAvIGRlYWN0aXZhdGUgdW5pdHMgaW4gYSBjcHUgcG9vbCAqLworICAgIHZv
aWQgICAgICAgICAoKmluc2VydF91bml0KSAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKik7
CisgICAgdm9pZCAgICAgICAgICgqcmVtb3ZlX3VuaXQpICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRf
dW5pdCAqKTsKKworICAgIHZvaWQgICAgICAgICAoKnNsZWVwKSAgICAgICAgICAoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHNjaGVkX3VuaXQgKik7CisgICAgdm9pZCAgICAgICAgICgqd2FrZSkgICAgICAgICAgIChj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqKTsKKyAgICB2b2lkICAgICAgICAgKCp5aWVsZCkgICAg
ICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICopOworICAgIHZvaWQgICAgICAgICAoKmNv
bnRleHRfc2F2ZWQpICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKik7CiAKICAgICBzdHJ1Y3Qg
dGFza19zbGljZSAoKmRvX3NjaGVkdWxlKSAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzX3Rp
bWVfdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbF90IHRhc2ts
ZXRfd29ya19zY2hlZHVsZWQpOwogCi0gICAgaW50ICAgICAgICAgICgqcGlja19jcHUpICAgICAg
IChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2Y3B1ICopOwotICAgIHZvaWQgICAg
ICAgICAoKm1pZ3JhdGUpICAgICAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3Qg
dmNwdSAqLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
KTsKKyAgICBpbnQgICAgICAgICAgKCpwaWNrX2NwdSkgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVj
dCBzY2hlZF91bml0ICopOworICAgIHZvaWQgICAgICAgICAoKm1pZ3JhdGUpICAgICAgICAoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHNjaGVkX3VuaXQgKiwgdW5zaWduZWQgaW50KTsKICAgICBpbnQgICAgICAgICAg
KCphZGp1c3QpICAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0IGRvbWFp
biAqLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhlbl9kb21j
dGxfc2NoZWR1bGVyX29wICopOwotICAgIHZvaWQgICAgICAgICAoKmFkanVzdF9hZmZpbml0eSko
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqLAorICAgIHZvaWQgICAgICAg
ICAoKmFkanVzdF9hZmZpbml0eSkoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKiwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBjcHVtYXNrICosCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqKTsK
ICAgICBpbnQgICAgICAgICAgKCphZGp1c3RfZ2xvYmFsKSAgKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKiwKQEAgLTI2NywxMCArMjc1LDEwIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzY2hlZF9kZWlu
aXRfcGRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywgdm9pZCAqZGF0YSwKICAgICAgICAg
cy0+ZGVpbml0X3BkYXRhKHMsIGRhdGEsIGNwdSk7CiB9CiAKLXN0YXRpYyBpbmxpbmUgdm9pZCAq
c2NoZWRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywgc3RydWN0IHZjcHUg
KnYsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmRvbV9kYXRh
KQorc3RhdGljIGlubGluZSB2b2lkICpzY2hlZF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c2NoZWRfdW5pdCAqdW5pdCwgdm9pZCAqZG9tX2RhdGEpCiB7Ci0gICAgcmV0dXJuIHMtPmFsbG9j
X3ZkYXRhKHMsIHYsIGRvbV9kYXRhKTsKKyAgICByZXR1cm4gcy0+YWxsb2NfdmRhdGEocywgdW5p
dCwgZG9tX2RhdGEpOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfZnJlZV92ZGF0YShj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpzLCB2b2lkICpkYXRhKQpAQCAtMjc4LDY0ICsyODYsNzAg
QEAgc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2ZyZWVfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqcywgdm9pZCAqZGF0YSkKICAgICBzLT5mcmVlX3ZkYXRhKHMsIGRhdGEpOwogfQogCi1z
dGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfaW5zZXJ0X3ZjcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfaW5zZXJ0X3Vu
aXQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKLSAgICBpZiAoIHMtPmluc2Vy
dF92Y3B1ICkKLSAgICAgICAgcy0+aW5zZXJ0X3ZjcHUocywgdik7CisgICAgaWYgKCBzLT5pbnNl
cnRfdW5pdCApCisgICAgICAgIHMtPmluc2VydF91bml0KHMsIHVuaXQpOwogfQogCi1zdGF0aWMg
aW5saW5lIHZvaWQgc2NoZWRfcmVtb3ZlX3ZjcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywg
c3RydWN0IHZjcHUgKnYpCitzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfcmVtb3ZlX3VuaXQoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKLSAgICBpZiAoIHMtPnJlbW92ZV92Y3B1
ICkKLSAgICAgICAgcy0+cmVtb3ZlX3ZjcHUocywgdik7CisgICAgaWYgKCBzLT5yZW1vdmVfdW5p
dCApCisgICAgICAgIHMtPnJlbW92ZV91bml0KHMsIHVuaXQpOwogfQogCi1zdGF0aWMgaW5saW5l
IHZvaWQgc2NoZWRfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywgc3RydWN0IHZjcHUg
KnYpCitzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAq
dW5pdCkKIHsKICAgICBpZiAoIHMtPnNsZWVwICkKLSAgICAgICAgcy0+c2xlZXAocywgdik7Cisg
ICAgICAgIHMtPnNsZWVwKHMsIHVuaXQpOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRf
d2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpzLCBzdHJ1Y3QgdmNwdSAqdikKK3N0YXRpYyBp
bmxpbmUgdm9pZCBzY2hlZF93YWtlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBp
ZiAoIHMtPndha2UgKQotICAgICAgICBzLT53YWtlKHMsIHYpOworICAgICAgICBzLT53YWtlKHMs
IHVuaXQpOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfeWllbGQoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRf
eWllbGQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBpZiAoIHMtPnlpZWxkICkK
LSAgICAgICAgcy0+eWllbGQocywgdik7CisgICAgICAgIHMtPnlpZWxkKHMsIHVuaXQpOwogfQog
CiBzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfY29udGV4dF9zYXZlZChjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpzLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHZjcHUgKnYpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBpZiAoIHMtPmNvbnRleHRfc2F2ZWQgKQotICAgICAg
ICBzLT5jb250ZXh0X3NhdmVkKHMsIHYpOworICAgICAgICBzLT5jb250ZXh0X3NhdmVkKHMsIHVu
aXQpOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfbWlncmF0ZShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpzLCBzdHJ1Y3QgdmNwdSAqdiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGludCBjcHUpCitzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfbWlncmF0
ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsIHVuc2lnbmVkIGludCBjcHUpCiB7CiAgICAg
aWYgKCBzLT5taWdyYXRlICkKLSAgICAgICAgcy0+bWlncmF0ZShzLCB2LCBjcHUpOworICAgICAg
ICBzLT5taWdyYXRlKHMsIHVuaXQsIGNwdSk7CiAgICAgZWxzZQotICAgICAgICB2LT5wcm9jZXNz
b3IgPSBjcHU7CisgICAgICAgIHVuaXQtPnZjcHVfbGlzdC0+cHJvY2Vzc29yID0gY3B1OwogfQog
Ci1zdGF0aWMgaW5saW5lIGludCBzY2hlZF9waWNrX2NwdShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpzLCBzdHJ1Y3QgdmNwdSAqdikKK3N0YXRpYyBpbmxpbmUgaW50IHNjaGVkX3BpY2tfY3B1KGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKLSAgICByZXR1cm4gcy0+cGlja19j
cHUocywgdik7CisgICAgcmV0dXJuIHMtPnBpY2tfY3B1KHMsIHVuaXQpOwogfQogCiBzdGF0aWMg
aW5saW5lIHZvaWQgc2NoZWRfYWRqdXN0X2FmZmluaXR5KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
KnMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1
ICp2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2No
ZWRfdW5pdCAqdW5pdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3QgY3B1bWFza190ICpoYXJkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBjcHVtYXNrX3QgKnNvZnQpCiB7CiAgICAgaWYgKCBzLT5hZGp1c3RfYWZm
aW5pdHkgKQotICAgICAgICBzLT5hZGp1c3RfYWZmaW5pdHkocywgdiwgaGFyZCwgc29mdCk7Cisg
ICAgICAgIHMtPmFkanVzdF9hZmZpbml0eShzLCB1bml0LCBoYXJkLCBzb2Z0KTsKIH0KIAogc3Rh
dGljIGlubGluZSBpbnQgc2NoZWRfYWRqdXN0X2RvbShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpz
LCBzdHJ1Y3QgZG9tYWluICpkLApkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgg
Yi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAppbmRleCA0MDA5N2ZmMzM0Li4zODY1NDllYmJiIDEw
MDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4v
c2NoZWQuaApAQCAtMTYxLDYgKzE2MSw3IEBAIHN0cnVjdCB2Y3B1CiAKICAgICBzdHJ1Y3QgdGlt
ZXIgICAgIHBvbGxfdGltZXI7ICAgIC8qIHRpbWVvdXQgZm9yIFNDSEVET1BfcG9sbCAqLwogCisg
ICAgc3RydWN0IHNjaGVkX3VuaXQgKnNjaGVkX3VuaXQ7CiAgICAgdm9pZCAgICAgICAgICAgICpz
Y2hlZF9wcml2OyAgICAvKiBzY2hlZHVsZXItc3BlY2lmaWMgZGF0YSAqLwogCiAgICAgc3RydWN0
IHZjcHVfcnVuc3RhdGVfaW5mbyBydW5zdGF0ZTsKQEAgLTI3Myw2ICsyNzQsMTIgQEAgc3RydWN0
IHZjcHUKICAgICBzdHJ1Y3QgYXJjaF92Y3B1IGFyY2g7CiB9OwogCitzdHJ1Y3Qgc2NoZWRfdW5p
dCB7CisgICAgc3RydWN0IGRvbWFpbiAgICAgICAgICpkb21haW47CisgICAgc3RydWN0IHZjcHUg
ICAgICAgICAgICp2Y3B1X2xpc3Q7CisgICAgdW5zaWduZWQgaW50ICAgICAgICAgICB1bml0X2lk
OworfTsKKwogLyogUGVyLWRvbWFpbiBsb2NrIGNhbiBiZSByZWN1cnNpdmVseSBhY3F1aXJlZCBp
biBmYXVsdCBoYW5kbGVycy4gKi8KICNkZWZpbmUgZG9tYWluX2xvY2soZCkgc3Bpbl9sb2NrX3Jl
Y3Vyc2l2ZSgmKGQpLT5kb21haW5fbG9jaykKICNkZWZpbmUgZG9tYWluX3VubG9jayhkKSBzcGlu
X3VubG9ja19yZWN1cnNpdmUoJihkKS0+ZG9tYWluX2xvY2spCi0tIAoyLjE2LjQKCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGlu
ZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnBy
b2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

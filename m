Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id AED3B2C480
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:36:54 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZQ3-0004YT-Fi; Tue, 28 May 2019 10:33:23 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZQ1-0004XJ-L7
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:33:21 +0000
X-Inumbo-ID: 02adeae0-8134-11e9-8980-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 02adeae0-8134-11e9-8980-bc764e045a96;
 Tue, 28 May 2019 10:33:20 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 9B596AF38;
 Tue, 28 May 2019 10:33:17 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:32:19 +0200
Message-Id: <20190528103313.1343-7-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 06/60] xen/sched: move per-vcpu scheduler
 private data pointer to sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBwcmVwYXJlcyBtYWtpbmcgdGhlIGRpZmZlcmVudCBzY2hlZHVsZXJzIHZjcHUgYWdub3N0
aWMuCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+Ci0tLQog
eGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jIHwgIDQgKystLQogeGVuL2NvbW1vbi9zY2hlZF9j
cmVkaXQuYyAgIHwgIDYgKysrLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyAgfCAxMCAr
KysrKy0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX251bGwuYyAgICAgfCAgNCArKy0tCiB4ZW4vY29t
bW9uL3NjaGVkX3J0LmMgICAgICAgfCAgNCArKy0tCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAg
ICAgfCAyNCArKysrKysrKysrKystLS0tLS0tLS0tLS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC5o
ICAgICB8ICAyICstCiA3IGZpbGVzIGNoYW5nZWQsIDI3IGluc2VydGlvbnMoKyksIDI3IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYyBiL3hlbi9j
b21tb24vc2NoZWRfYXJpbmM2NTMuYwppbmRleCAyODM3MzBiM2Y4Li44NDA4OTEzMThlIDEwMDY0
NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMKKysrIGIveGVuL2NvbW1vbi9zY2hl
ZF9hcmluYzY1My5jCkBAIC01Myw3ICs1Myw3IEBACiAgKiBSZXR1cm4gYSBwb2ludGVyIHRvIHRo
ZSBBUklOQyA2NTMtc3BlY2lmaWMgc2NoZWR1bGVyIGRhdGEgaW5mb3JtYXRpb24KICAqIGFzc29j
aWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gVkNQVSAodmMpCiAgKi8KLSNkZWZpbmUgQVZDUFUodmMpICgo
YXJpbmM2NTNfdmNwdV90ICopKHZjKS0+c2NoZWRfcHJpdikKKyNkZWZpbmUgQVZDUFUodmMpICgo
YXJpbmM2NTNfdmNwdV90ICopKHZjKS0+c2NoZWRfdW5pdC0+cHJpdikKIAogLyoqCiAgKiBSZXR1
cm4gdGhlIGdsb2JhbCBzY2hlZHVsZXIgcHJpdmF0ZSBkYXRhIGdpdmVuIHRoZSBzY2hlZHVsZXIg
b3BzIHBvaW50ZXIKQEAgLTY0Nyw3ICs2NDcsNyBAQCBhNjUzX3N3aXRjaF9zY2hlZChzdHJ1Y3Qg
c2NoZWR1bGVyICpuZXdfb3BzLCB1bnNpZ25lZCBpbnQgY3B1LAogCiAgICAgQVNTRVJUKCFwZGF0
YSAmJiBzdmMgJiYgaXNfaWRsZV92Y3B1KHN2Yy0+dmMpKTsKIAotICAgIGlkbGVfdmNwdVtjcHVd
LT5zY2hlZF9wcml2ID0gdmRhdGE7CisgICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3VuaXQtPnBy
aXYgPSB2ZGF0YTsKIAogICAgIHJldHVybiAmc2QtPl9sb2NrOwogfQpkaWZmIC0tZ2l0IGEveGVu
L2NvbW1vbi9zY2hlZF9jcmVkaXQuYyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKaW5kZXgg
ZWJhNGRiMzhiYi4uNGNmZWYxODlhYSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9jcmVk
aXQuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCkBAIC04Myw3ICs4Myw3IEBACiAg
ICAgKChzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKikoKF9vcHMpLT5zY2hlZF9kYXRhKSkKICNkZWZp
bmUgQ1NDSEVEX1BDUFUoX2MpICAgICBcCiAgICAgKChzdHJ1Y3QgY3NjaGVkX3BjcHUgKilwZXJf
Y3B1KHNjaGVkdWxlX2RhdGEsIF9jKS5zY2hlZF9wcml2KQotI2RlZmluZSBDU0NIRURfVkNQVShf
dmNwdSkgICgoc3RydWN0IGNzY2hlZF92Y3B1ICopIChfdmNwdSktPnNjaGVkX3ByaXYpCisjZGVm
aW5lIENTQ0hFRF9WQ1BVKF92Y3B1KSAgKChzdHJ1Y3QgY3NjaGVkX3ZjcHUgKikgKF92Y3B1KS0+
c2NoZWRfdW5pdC0+cHJpdikKICNkZWZpbmUgQ1NDSEVEX0RPTShfZG9tKSAgICAoKHN0cnVjdCBj
c2NoZWRfZG9tICopIChfZG9tKS0+c2NoZWRfcHJpdikKICNkZWZpbmUgUlVOUShfY3B1KSAgICAg
ICAgICAoJihDU0NIRURfUENQVShfY3B1KS0+cnVucSkpCiAKQEAgLTY0MSw3ICs2NDEsNyBAQCBj
c2NoZWRfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVuc2lnbmVkIGlu
dCBjcHUsCiAKICAgICBBU1NFUlQoc3ZjICYmIGlzX2lkbGVfdmNwdShzdmMtPnZjcHUpKTsKIAot
ICAgIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF9wcml2ID0gdmRhdGE7CisgICAgaWRsZV92Y3B1W2Nw
dV0tPnNjaGVkX3VuaXQtPnByaXYgPSB2ZGF0YTsKIAogICAgIC8qCiAgICAgICogV2UgYXJlIGhv
bGRpbmcgdGhlIHJ1bnF1ZXVlIGxvY2sgYWxyZWFkeSAoaXQncyBiZWVuIHRha2VuIGluCkBAIC0x
MDIyLDcgKzEwMjIsNyBAQCBzdGF0aWMgdm9pZAogY3NjaGVkX3VuaXRfaW5zZXJ0KGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAgc3Ry
dWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKLSAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2YyA9
IHZjLT5zY2hlZF9wcml2OworICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqc3ZjID0gdW5pdC0+cHJp
djsKICAgICBzcGlubG9ja190ICpsb2NrOwogCiAgICAgQlVHX09OKCBpc19pZGxlX3ZjcHUodmMp
ICk7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyBiL3hlbi9jb21tb24v
c2NoZWRfY3JlZGl0Mi5jCmluZGV4IGRlZjhkODc0ODQuLjg2YjQ0ZGM2Y2YgMTAwNjQ0Ci0tLSBh
L3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
Mi5jCkBAIC01NzIsNyArNTcyLDcgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgY3NjaGVkMl9wY3B1
ICpjc2NoZWQyX3BjcHUodW5zaWduZWQgaW50IGNwdSkKIAogc3RhdGljIGlubGluZSBzdHJ1Y3Qg
Y3NjaGVkMl92Y3B1ICpjc2NoZWQyX3ZjcHUoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiB7Ci0gICAg
cmV0dXJuIHYtPnNjaGVkX3ByaXY7CisgICAgcmV0dXJuIHYtPnNjaGVkX3VuaXQtPnByaXY7CiB9
CiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGNzY2hlZDJfZG9tICpjc2NoZWQyX2RvbShjb25zdCBz
dHJ1Y3QgZG9tYWluICpkKQpAQCAtOTcwLDcgKzk3MCw3IEBAIF9ydW5xX2Fzc2lnbihzdHJ1Y3Qg
Y3NjaGVkMl92Y3B1ICpzdmMsIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCkKIHN0
YXRpYyB2b2lkCiBydW5xX2Fzc2lnbihjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVj
dCB2Y3B1ICp2YykKIHsKLSAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2Yy0+c2NoZWRf
cHJpdjsKKyAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2Yy0+c2NoZWRfdW5pdC0+cHJp
djsKIAogICAgIEFTU0VSVChzdmMtPnJxZCA9PSBOVUxMKTsKIApAQCAtOTk3LDcgKzk5Nyw3IEBA
IF9ydW5xX2RlYXNzaWduKHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YykKIHN0YXRpYyB2b2lkCiBy
dW5xX2RlYXNzaWduKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZj
KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF9wcml2OworICAg
IHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF91bml0LT5wcml2OwogCiAgICAg
QVNTRVJUKHN2Yy0+cnFkID09IGMycnFkKG9wcywgdmMtPnByb2Nlc3NvcikpOwogCkBAIC0zMTA4
LDcgKzMxMDgsNyBAQCBzdGF0aWMgdm9pZAogY3NjaGVkMl91bml0X2luc2VydChjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAgIHN0cnVj
dCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7Ci0gICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjID0g
dmMtPnNjaGVkX3ByaXY7CisgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjID0gdW5pdC0+cHJp
djsKICAgICBzdHJ1Y3QgY3NjaGVkMl9kb20gKiBjb25zdCBzZG9tID0gc3ZjLT5zZG9tOwogICAg
IHNwaW5sb2NrX3QgKmxvY2s7CiAKQEAgLTM4ODcsNyArMzg4Nyw3IEBAIGNzY2hlZDJfc3dpdGNo
X3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAgICAg
QVNTRVJUKCFsb2NhbF9pcnFfaXNfZW5hYmxlZCgpKTsKICAgICB3cml0ZV9sb2NrKCZwcnYtPmxv
Y2spOwogCi0gICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3ByaXYgPSB2ZGF0YTsKKyAgICBpZGxl
X3ZjcHVbY3B1XS0+c2NoZWRfdW5pdC0+cHJpdiA9IHZkYXRhOwogCiAgICAgcnFpID0gaW5pdF9w
ZGF0YShwcnYsIHBkYXRhLCBjcHUpOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX251
bGwuYyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCmluZGV4IGJmNTJjODRiMGYuLmI2MjJjNGQ3
ZGMgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCisrKyBiL3hlbi9jb21tb24v
c2NoZWRfbnVsbC5jCkBAIC0xMTcsNyArMTE3LDcgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgbnVs
bF9wcml2YXRlICpudWxsX3ByaXYoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzKQogCiBzdGF0
aWMgaW5saW5lIHN0cnVjdCBudWxsX3ZjcHUgKm51bGxfdmNwdShjb25zdCBzdHJ1Y3QgdmNwdSAq
dikKIHsKLSAgICByZXR1cm4gdi0+c2NoZWRfcHJpdjsKKyAgICByZXR1cm4gdi0+c2NoZWRfdW5p
dC0+cHJpdjsKIH0KIAogc3RhdGljIGlubGluZSBib29sIHZjcHVfY2hlY2tfYWZmaW5pdHkoc3Ry
dWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBjcHUsCkBAIC0zOTIsNyArMzkyLDcgQEAgc3RhdGlj
IHNwaW5sb2NrX3QgKm51bGxfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMs
CiAKICAgICBBU1NFUlQobnZjICYmIGlzX2lkbGVfdmNwdShudmMtPnZjcHUpKTsKIAotICAgIGlk
bGVfdmNwdVtjcHVdLT5zY2hlZF9wcml2ID0gdmRhdGE7CisgICAgaWRsZV92Y3B1W2NwdV0tPnNj
aGVkX3VuaXQtPnByaXYgPSB2ZGF0YTsKIAogICAgIC8qCiAgICAgICogV2UgYXJlIGhvbGRpbmcg
dGhlIHJ1bnF1ZXVlIGxvY2sgYWxyZWFkeSAoaXQncyBiZWVuIHRha2VuIGluCmRpZmYgLS1naXQg
YS94ZW4vY29tbW9uL3NjaGVkX3J0LmMgYi94ZW4vY29tbW9uL3NjaGVkX3J0LmMKaW5kZXggNjNl
YzczMjE1Ny4uNzAwZWU5MzUzZSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9ydC5jCisr
KyBiL3hlbi9jb21tb24vc2NoZWRfcnQuYwpAQCAtMjM1LDcgKzIzNSw3IEBAIHN0YXRpYyBpbmxp
bmUgc3RydWN0IHJ0X3ByaXZhdGUgKnJ0X3ByaXYoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
KQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBydF92Y3B1ICpydF92Y3B1KGNvbnN0IHN0cnVjdCB2
Y3B1ICp2Y3B1KQogewotICAgIHJldHVybiB2Y3B1LT5zY2hlZF9wcml2OworICAgIHJldHVybiB2
Y3B1LT5zY2hlZF91bml0LT5wcml2OwogfQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBsaXN0X2hl
YWQgKnJ0X3J1bnEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzKQpAQCAtNzYxLDcgKzc2MSw3
IEBAIHJ0X3N3aXRjaF9zY2hlZChzdHJ1Y3Qgc2NoZWR1bGVyICpuZXdfb3BzLCB1bnNpZ25lZCBp
bnQgY3B1LAogICAgICAgICBkcHJpbnRrKFhFTkxPR19ERUJVRywgIlJURFM6IHRpbWVyIGluaXRp
YWxpemVkIG9uIGNwdSAldVxuIiwgY3B1KTsKICAgICB9CiAKLSAgICBpZGxlX3ZjcHVbY3B1XS0+
c2NoZWRfcHJpdiA9IHZkYXRhOworICAgIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91bml0LT5wcml2
ID0gdmRhdGE7CiAKICAgICByZXR1cm4gJnBydi0+bG9jazsKIH0KZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vc2NoZWR1bGUuYyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwppbmRleCAzZmY4ODA5NmQ4
Li44NmE0M2Y3MTkyIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMKKysrIGIveGVu
L2NvbW1vbi9zY2hlZHVsZS5jCkBAIC0yNjksOCArMjY5LDggQEAgaW50IHNjaGVkX2luaXRfdmNw
dShzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgaW50IHByb2Nlc3NvcikKICAgICBpbml0X3RpbWVy
KCZ2LT5wb2xsX3RpbWVyLCBwb2xsX3RpbWVyX2ZuLAogICAgICAgICAgICAgICAgdiwgdi0+cHJv
Y2Vzc29yKTsKIAotICAgIHYtPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxvY192ZGF0YShkb21fc2No
ZWR1bGVyKGQpLCB1bml0LCBkLT5zY2hlZF9wcml2KTsKLSAgICBpZiAoIHYtPnNjaGVkX3ByaXYg
PT0gTlVMTCApCisgICAgdW5pdC0+cHJpdiA9IHNjaGVkX2FsbG9jX3ZkYXRhKGRvbV9zY2hlZHVs
ZXIoZCksIHVuaXQsIGQtPnNjaGVkX3ByaXYpOworICAgIGlmICggdW5pdC0+cHJpdiA9PSBOVUxM
ICkKICAgICB7CiAgICAgICAgIHYtPnNjaGVkX3VuaXQgPSBOVUxMOwogICAgICAgICB4ZnJlZSh1
bml0KTsKQEAgLTM2NSw3ICszNjUsNyBAQCBpbnQgc2NoZWRfbW92ZV9kb21haW4oc3RydWN0IGRv
bWFpbiAqZCwgc3RydWN0IGNwdXBvb2wgKmMpCiAgICAgewogICAgICAgICBzcGlubG9ja190ICps
b2NrOwogCi0gICAgICAgIHZjcHVkYXRhID0gdi0+c2NoZWRfcHJpdjsKKyAgICAgICAgdmNwdWRh
dGEgPSB2LT5zY2hlZF91bml0LT5wcml2OwogCiAgICAgICAgIG1pZ3JhdGVfdGltZXIoJnYtPnBl
cmlvZGljX3RpbWVyLCBuZXdfcCk7CiAgICAgICAgIG1pZ3JhdGVfdGltZXIoJnYtPnNpbmdsZXNo
b3RfdGltZXIsIG5ld19wKTsKQEAgLTM4Myw3ICszODMsNyBAQCBpbnQgc2NoZWRfbW92ZV9kb21h
aW4oc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGNwdXBvb2wgKmMpCiAgICAgICAgICAqLwogICAg
ICAgICBzcGluX3VubG9ja19pcnEobG9jayk7CiAKLSAgICAgICAgdi0+c2NoZWRfcHJpdiA9IHZj
cHVfcHJpdlt2LT52Y3B1X2lkXTsKKyAgICAgICAgdi0+c2NoZWRfdW5pdC0+cHJpdiA9IHZjcHVf
cHJpdlt2LT52Y3B1X2lkXTsKICAgICAgICAgaWYgKCAhZC0+aXNfZHlpbmcgKQogICAgICAgICAg
ICAgc2NoZWRfbW92ZV9pcnFzKHYpOwogCkBAIC00MTUsNyArNDE1LDcgQEAgdm9pZCBzY2hlZF9k
ZXN0cm95X3ZjcHUoc3RydWN0IHZjcHUgKnYpCiAgICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9ib29s
KHYtPmlzX3VyZ2VudCkgKQogICAgICAgICBhdG9taWNfZGVjKCZwZXJfY3B1KHNjaGVkdWxlX2Rh
dGEsIHYtPnByb2Nlc3NvcikudXJnZW50X2NvdW50KTsKICAgICBzY2hlZF9yZW1vdmVfdW5pdCh2
Y3B1X3NjaGVkdWxlcih2KSwgdW5pdCk7Ci0gICAgc2NoZWRfZnJlZV92ZGF0YSh2Y3B1X3NjaGVk
dWxlcih2KSwgdi0+c2NoZWRfcHJpdik7CisgICAgc2NoZWRfZnJlZV92ZGF0YSh2Y3B1X3NjaGVk
dWxlcih2KSwgdW5pdC0+cHJpdik7CiAgICAgeGZyZWUodW5pdCk7CiAgICAgdi0+c2NoZWRfdW5p
dCA9IE5VTEw7CiB9CkBAIC0xNTkzLDYgKzE1OTMsNyBAQCBzdGF0aWMgaW50IGNwdV9zY2hlZHVs
ZV91cCh1bnNpZ25lZCBpbnQgY3B1KQogICAgIGVsc2UKICAgICB7CiAgICAgICAgIHN0cnVjdCB2
Y3B1ICppZGxlID0gaWRsZV92Y3B1W2NwdV07CisgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICp1
bml0ID0gaWRsZS0+c2NoZWRfdW5pdDsKIAogICAgICAgICAvKgogICAgICAgICAgKiBEdXJpbmcg
KEFDUEk/KSBzdXNwZW5kIHRoZSBpZGxlIHZDUFUgZm9yIHRoaXMgcENQVSBpcyBub3QgZnJlZWQs
CkBAIC0xNjA0LDExICsxNjA1LDEwIEBAIHN0YXRpYyBpbnQgY3B1X3NjaGVkdWxlX3VwKHVuc2ln
bmVkIGludCBjcHUpCiAgICAgICAgICAqIHdpdGggYSBkaWZmZXJlbnQgc2NoZWR1bGVyLCBpdCBp
cyBzY2hlZHVsZV9jcHVfc3dpdGNoKCksIGludm9rZWQKICAgICAgICAgICogbGF0ZXIsIHRoYXQg
d2lsbCBzZXQgdGhpbmdzIHVwIGFzIGFwcHJvcHJpYXRlLgogICAgICAgICAgKi8KLSAgICAgICAg
QVNTRVJUKGlkbGUtPnNjaGVkX3ByaXYgPT0gTlVMTCk7CisgICAgICAgIEFTU0VSVCh1bml0LT5w
cml2ID09IE5VTEwpOwogCi0gICAgICAgIGlkbGUtPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxvY192
ZGF0YSgmb3BzLCBpZGxlLT5zY2hlZF91bml0LAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaWRsZS0+ZG9tYWluLT5zY2hlZF9wcml2KTsKLSAgICAgICAgaWYg
KCBpZGxlLT5zY2hlZF9wcml2ID09IE5VTEwgKQorICAgICAgICB1bml0LT5wcml2ID0gc2NoZWRf
YWxsb2NfdmRhdGEoJm9wcywgdW5pdCwgaWRsZS0+ZG9tYWluLT5zY2hlZF9wcml2KTsKKyAgICAg
ICAgaWYgKCB1bml0LT5wcml2ID09IE5VTEwgKQogICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07
CiAgICAgfQogICAgIGlmICggaWRsZV92Y3B1W2NwdV0gPT0gTlVMTCApCkBAIC0xNjM0LDkgKzE2
MzQsOSBAQCBzdGF0aWMgdm9pZCBjcHVfc2NoZWR1bGVfZG93bih1bnNpZ25lZCBpbnQgY3B1KQog
ICAgIHN0cnVjdCBzY2hlZHVsZXIgKnNjaGVkID0gcGVyX2NwdShzY2hlZHVsZXIsIGNwdSk7CiAK
ICAgICBzY2hlZF9mcmVlX3BkYXRhKHNjaGVkLCBzZC0+c2NoZWRfcHJpdiwgY3B1KTsKLSAgICBz
Y2hlZF9mcmVlX3ZkYXRhKHNjaGVkLCBpZGxlX3ZjcHVbY3B1XS0+c2NoZWRfcHJpdik7CisgICAg
c2NoZWRfZnJlZV92ZGF0YShzY2hlZCwgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3VuaXQtPnByaXYp
OwogCi0gICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3ByaXYgPSBOVUxMOworICAgIGlkbGVfdmNw
dVtjcHVdLT5zY2hlZF91bml0LT5wcml2ID0gTlVMTDsKICAgICBzZC0+c2NoZWRfcHJpdiA9IE5V
TEw7CiAKICAgICBraWxsX3RpbWVyKCZzZC0+c190aW1lcik7CkBAIC0xODg2LDcgKzE4ODYsNyBA
QCBpbnQgc2NoZWR1bGVfY3B1X3N3aXRjaCh1bnNpZ25lZCBpbnQgY3B1LCBzdHJ1Y3QgY3B1cG9v
bCAqYykKICAgICAgKi8KICAgICBvbGRfbG9jayA9IHBjcHVfc2NoZWR1bGVfbG9ja19pcnEoY3B1
KTsKIAotICAgIHZwcml2X29sZCA9IGlkbGUtPnNjaGVkX3ByaXY7CisgICAgdnByaXZfb2xkID0g
aWRsZS0+c2NoZWRfdW5pdC0+cHJpdjsKICAgICBwcHJpdl9vbGQgPSBzZC0+c2NoZWRfcHJpdjsK
ICAgICBuZXdfbG9jayA9IHNjaGVkX3N3aXRjaF9zY2hlZChuZXdfb3BzLCBjcHUsIHBwcml2LCB2
cHJpdik7CiAKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oIGIveGVuL2luY2x1
ZGUveGVuL3NjaGVkLmgKaW5kZXggZThlYTQyZTg2Ny4uZjU0OWFkNjBkMSAxMDA2NDQKLS0tIGEv
eGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKQEAg
LTE2Miw3ICsxNjIsNiBAQCBzdHJ1Y3QgdmNwdQogICAgIHN0cnVjdCB0aW1lciAgICAgcG9sbF90
aW1lcjsgICAgLyogdGltZW91dCBmb3IgU0NIRURPUF9wb2xsICovCiAKICAgICBzdHJ1Y3Qgc2No
ZWRfdW5pdCAqc2NoZWRfdW5pdDsKLSAgICB2b2lkICAgICAgICAgICAgKnNjaGVkX3ByaXY7ICAg
IC8qIHNjaGVkdWxlci1zcGVjaWZpYyBkYXRhICovCiAKICAgICBzdHJ1Y3QgdmNwdV9ydW5zdGF0
ZV9pbmZvIHJ1bnN0YXRlOwogI2lmbmRlZiBDT05GSUdfQ09NUEFUCkBAIC0yNzksNiArMjc4LDcg
QEAgc3RydWN0IHZjcHUKIAogc3RydWN0IHNjaGVkX3VuaXQgewogICAgIHN0cnVjdCB2Y3B1ICAg
ICAgICAgICAqdmNwdTsKKyAgICB2b2lkICAgICAgICAgICAgICAgICAgKnByaXY7ICAgICAgLyog
c2NoZWR1bGVyIHByaXZhdGUgZGF0YSAqLwogfTsKIAogLyogUGVyLWRvbWFpbiBsb2NrIGNhbiBi
ZSByZWN1cnNpdmVseSBhY3F1aXJlZCBpbiBmYXVsdCBoYW5kbGVycy4gKi8KLS0gCjIuMTYuNAoK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZl
bCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlz
dHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

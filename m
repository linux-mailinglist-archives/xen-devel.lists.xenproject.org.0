Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E70BD1438AB
	for <lists+xen-devel@lfdr.de>; Tue, 21 Jan 2020 09:48:15 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1itp8Z-0004Ut-7A; Tue, 21 Jan 2020 08:43:51 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=4mp0=3K=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1itp8X-0004U6-5g
 for xen-devel@lists.xenproject.org; Tue, 21 Jan 2020 08:43:49 +0000
X-Inumbo-ID: 1c5ba3c4-3c2a-11ea-ba47-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 1c5ba3c4-3c2a-11ea-ba47-12813bfff9fa;
 Tue, 21 Jan 2020 08:43:35 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 84DE4B2C6;
 Tue, 21 Jan 2020 08:43:34 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 21 Jan 2020 09:43:26 +0100
Message-Id: <20200121084330.18309-6-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20200121084330.18309-1-jgross@suse.com>
References: <20200121084330.18309-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v3 5/9] libs: add libxenhypfs
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIHRoZSBuZXcgbGlicmFyeSBsaWJ4ZW5oeXBmcyBmb3IgYWNjZXNzIHRvIHRoZSBoeXBlcnZp
c29yIGZpbGVzeXN0ZW0uCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3Vz
ZS5jb20+Ci0tLQpWMToKLSByZW5hbWUgdG8gbGlieGVuaHlwZnMKLSBhZGQgeGVuaHlwZnNfd3Jp
dGUoKQoKVjM6Ci0gbWFqb3IgcmV3b3JrIGR1ZSB0byBuZXcgaHlwZXJ2aXNvciBpbnRlcmZhY2UK
LSBhZGQgZGVjb21wcmVzc2lvbiBjYXBhYmlsaXR5Ci0tLQogLmdpdGlnbm9yZSAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDIgKwogdG9vbHMvUnVsZXMubWsgICAgICAgICAgICAgICAgICAg
ICAgfCAgIDYgKwogdG9vbHMvbGlicy9NYWtlZmlsZSAgICAgICAgICAgICAgICAgfCAgIDEgKwog
dG9vbHMvbGlicy9oeXBmcy9NYWtlZmlsZSAgICAgICAgICAgfCAgMTYgKysKIHRvb2xzL2xpYnMv
aHlwZnMvY29yZS5jICAgICAgICAgICAgIHwgNTM1ICsrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKwogdG9vbHMvbGlicy9oeXBmcy9pbmNsdWRlL3hlbmh5cGZzLmggfCAgNzUgKysr
KysKIHRvb2xzL2xpYnMvaHlwZnMvbGlieGVuaHlwZnMubWFwICAgIHwgIDEwICsKIHRvb2xzL2xp
YnMvaHlwZnMveGVuaHlwZnMucGMuaW4gICAgIHwgIDEwICsKIDggZmlsZXMgY2hhbmdlZCwgNjU1
IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0b29scy9saWJzL2h5cGZzL01ha2Vm
aWxlCiBjcmVhdGUgbW9kZSAxMDA2NDQgdG9vbHMvbGlicy9oeXBmcy9jb3JlLmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCB0b29scy9saWJzL2h5cGZzL2luY2x1ZGUveGVuaHlwZnMuaAogY3JlYXRlIG1v
ZGUgMTAwNjQ0IHRvb2xzL2xpYnMvaHlwZnMvbGlieGVuaHlwZnMubWFwCiBjcmVhdGUgbW9kZSAx
MDA2NDQgdG9vbHMvbGlicy9oeXBmcy94ZW5oeXBmcy5wYy5pbgoKZGlmZiAtLWdpdCBhLy5naXRp
Z25vcmUgYi8uZ2l0aWdub3JlCmluZGV4IGIyNjI0ZGY3OWEuLmU5OGMzZjA1NmQgMTAwNjQ0Ci0t
LSBhLy5naXRpZ25vcmUKKysrIGIvLmdpdGlnbm9yZQpAQCAtMTA5LDYgKzEwOSw4IEBAIHRvb2xz
L2xpYnMvZXZ0Y2huL2hlYWRlcnMuY2hrCiB0b29scy9saWJzL2V2dGNobi94ZW5ldnRjaG4ucGMK
IHRvb2xzL2xpYnMvZ250dGFiL2hlYWRlcnMuY2hrCiB0b29scy9saWJzL2dudHRhYi94ZW5nbnR0
YWIucGMKK3Rvb2xzL2xpYnMvaHlwZnMvaGVhZGVycy5jaGsKK3Rvb2xzL2xpYnMvaHlwZnMveGVu
aHlwZnMucGMKIHRvb2xzL2xpYnMvY2FsbC9oZWFkZXJzLmNoawogdG9vbHMvbGlicy9jYWxsL3hl
bmNhbGwucGMKIHRvb2xzL2xpYnMvZm9yZWlnbm1lbW9yeS9oZWFkZXJzLmNoawpkaWZmIC0tZ2l0
IGEvdG9vbHMvUnVsZXMubWsgYi90b29scy9SdWxlcy5tawppbmRleCA1MmY0N2JlM2Y4Li5hMDQ2
OTdhMzNjIDEwMDY0NAotLS0gYS90b29scy9SdWxlcy5taworKysgYi90b29scy9SdWxlcy5tawpA
QCAtMTksNiArMTksNyBAQCBYRU5fTElCWEVOR05UVEFCICAgPSAkKFhFTl9ST09UKS90b29scy9s
aWJzL2dudHRhYgogWEVOX0xJQlhFTkNBTEwgICAgID0gJChYRU5fUk9PVCkvdG9vbHMvbGlicy9j
YWxsCiBYRU5fTElCWEVORk9SRUlHTk1FTU9SWSA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xpYnMvZm9y
ZWlnbm1lbW9yeQogWEVOX0xJQlhFTkRFVklDRU1PREVMID0gJChYRU5fUk9PVCkvdG9vbHMvbGli
cy9kZXZpY2Vtb2RlbAorWEVOX0xJQlhFTkhZUEZTICAgID0gJChYRU5fUk9PVCkvdG9vbHMvbGli
cy9oeXBmcwogWEVOX0xJQlhDICAgICAgICAgID0gJChYRU5fUk9PVCkvdG9vbHMvbGlieGMKIFhF
Tl9YRU5MSUdIVCAgICAgICA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xpYnhsCiAjIEN1cnJlbnRseSBs
aWJ4bHV0aWwgbGl2ZXMgaW4gdGhlIHNhbWUgZGlyZWN0b3J5IGFzIGxpYnhlbmxpZ2h0CkBAIC0x
MzQsNiArMTM1LDExIEBAIFNIREVQU19saWJ4ZW5kZXZpY2Vtb2RlbCA9ICQoU0hMSUJfbGlieGVu
dG9vbGxvZykgJChTSExJQl9saWJ4ZW50b29sY29yZSkgJChTSExJCiBMRExJQlNfbGlieGVuZGV2
aWNlbW9kZWwgPSAkKFNIREVQU19saWJ4ZW5kZXZpY2Vtb2RlbCkgJChYRU5fTElCWEVOREVWSUNF
TU9ERUwpL2xpYnhlbmRldmljZW1vZGVsJChsaWJleHRlbnNpb24pCiBTSExJQl9saWJ4ZW5kZXZp
Y2Vtb2RlbCAgPSAkKFNIREVQU19saWJ4ZW5kZXZpY2Vtb2RlbCkgLVdsLC1ycGF0aC1saW5rPSQo
WEVOX0xJQlhFTkRFVklDRU1PREVMKQogCitDRkxBR1NfbGlieGVuaHlwZnMgPSAtSSQoWEVOX0xJ
QlhFTkhZUEZTKS9pbmNsdWRlICQoQ0ZMQUdTX3hlbmluY2x1ZGUpCitTSERFUFNfbGlieGVuaHlw
ZnMgPSAkKFNITElCX2xpYnhlbnRvb2xsb2cpICQoU0hMSUJfbGlieGVudG9vbGNvcmUpICQoU0hM
SUJfeGVuY2FsbCkKK0xETElCU19saWJ4ZW5oeXBmcyA9ICQoU0hERVBTX2xpYnhlbmh5cGZzKSAk
KFhFTl9MSUJYRU5IWVBGUykvbGlieGVuaHlwZnMkKGxpYmV4dGVuc2lvbikKK1NITElCX2xpYnhl
bmh5cGZzICA9ICQoU0hERVBTX2xpYnhlbmh5cGZzKSAtV2wsLXJwYXRoLWxpbms9JChYRU5fTElC
WEVOSFlQRlMpCisKICMgY29kZSB3aGljaCBjb21waWxlcyBhZ2FpbnN0IGxpYnhlbmN0cmwgZ2V0
IF9fWEVOX1RPT0xTX18gYW5kCiAjIHRoZXJlZm9yZSBzZWVzIHRoZSB1bnN0YWJsZSBoeXBlcmNh
bGwgaW50ZXJmYWNlcy4KIENGTEFHU19saWJ4ZW5jdHJsID0gLUkkKFhFTl9MSUJYQykvaW5jbHVk
ZSAkKENGTEFHU19saWJ4ZW50b29sbG9nKSAkKENGTEFHU19saWJ4ZW5mb3JlaWdubWVtb3J5KSAk
KENGTEFHU19saWJ4ZW5kZXZpY2Vtb2RlbCkgJChDRkxBR1NfeGVuaW5jbHVkZSkgLURfX1hFTl9U
T09MU19fCmRpZmYgLS1naXQgYS90b29scy9saWJzL01ha2VmaWxlIGIvdG9vbHMvbGlicy9NYWtl
ZmlsZQppbmRleCA4ODkwMWU3MzQxLi42OWNkZmI1OTc1IDEwMDY0NAotLS0gYS90b29scy9saWJz
L01ha2VmaWxlCisrKyBiL3Rvb2xzL2xpYnMvTWFrZWZpbGUKQEAgLTksNiArOSw3IEBAIFNVQkRJ
UlMteSArPSBnbnR0YWIKIFNVQkRJUlMteSArPSBjYWxsCiBTVUJESVJTLXkgKz0gZm9yZWlnbm1l
bW9yeQogU1VCRElSUy15ICs9IGRldmljZW1vZGVsCitTVUJESVJTLXkgKz0gaHlwZnMKIAogaWZl
cSAoJChDT05GSUdfUlVNUCkseSkKIFNVQkRJUlMteSA6PSB0b29sY29yZQpkaWZmIC0tZ2l0IGEv
dG9vbHMvbGlicy9oeXBmcy9NYWtlZmlsZSBiL3Rvb2xzL2xpYnMvaHlwZnMvTWFrZWZpbGUKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uMDZkZDQ0OTkyOQotLS0gL2Rldi9u
dWxsCisrKyBiL3Rvb2xzL2xpYnMvaHlwZnMvTWFrZWZpbGUKQEAgLTAsMCArMSwxNiBAQAorWEVO
X1JPT1QgPSAkKENVUkRJUikvLi4vLi4vLi4KK2luY2x1ZGUgJChYRU5fUk9PVCkvdG9vbHMvUnVs
ZXMubWsKKworTUFKT1IgICAgPSAxCitNSU5PUiAgICA9IDAKK0xJQk5BTUUgIDo9IGh5cGZzCitV
U0VMSUJTICA6PSB0b29sbG9nIHRvb2xjb3JlIGNhbGwKKworQVBQRU5EX0xERkxBR1MgKz0gLWx6
CisKK1NSQ1MteSAgICAgICAgICAgICAgICAgKz0gY29yZS5jCisKK2luY2x1ZGUgLi4vbGlicy5t
aworCiskKFBLR19DT05GSUdfTE9DQUwpOiBQS0dfQ09ORklHX0lOQ0RJUiA9ICQoWEVOX0xJQlhF
TkhZUEZTKS9pbmNsdWRlCiskKFBLR19DT05GSUdfTE9DQUwpOiBQS0dfQ09ORklHX0NGTEFHU19M
T0NBTCA9ICQoQ0ZMQUdTX3hlbmluY2x1ZGUpCmRpZmYgLS1naXQgYS90b29scy9saWJzL2h5cGZz
L2NvcmUuYyBiL3Rvb2xzL2xpYnMvaHlwZnMvY29yZS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAuLjAxNDRjMjAyNjYKLS0tIC9kZXYvbnVsbAorKysgYi90b29scy9saWJz
L2h5cGZzL2NvcmUuYwpAQCAtMCwwICsxLDUzNSBAQAorLyoKKyAqIENvcHlyaWdodCAoYykgMjAx
OSBTVVNFIFNvZnR3YXJlIFNvbHV0aW9ucyBHZXJtYW55IEdtYkgKKyAqCisgKiBUaGlzIGxpYnJh
cnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgKiBt
b2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGlj
CisgKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9u
OworICogdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UuCisgKgorICogVGhpcyBsaWJyYXJ5IGlz
IGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiBidXQg
V0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBv
ZgorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NF
LiAgU2VlIHRoZSBHTlUKKyAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCisgKgorICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUg
R05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGli
cmFyeTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorICovCisK
KyNkZWZpbmUgX19YRU5fVE9PTFNfXyAxCisKKyNkZWZpbmUgX0dOVV9TT1VSQ0UKKworI2luY2x1
ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8aW50dHlwZXMuaD4KKyNpbmNsdWRlIDxzdGRsaWIuaD4K
KyNpbmNsdWRlIDxzdHJpbmcuaD4KKyNpbmNsdWRlIDx6bGliLmg+CisKKyNpbmNsdWRlIDx4ZW50
b29sbG9nLmg+CisjaW5jbHVkZSA8eGVuaHlwZnMuaD4KKyNpbmNsdWRlIDx4ZW5jYWxsLmg+Cisj
aW5jbHVkZSA8eGVudG9vbGNvcmVfaW50ZXJuYWwuaD4KKworI2luY2x1ZGUgPHhlbi94ZW4uaD4K
KyNpbmNsdWRlIDx4ZW4vaHlwZnMuaD4KKworI2RlZmluZSBCVUZfU0laRSA0MDk2CisKK3N0cnVj
dCB4ZW5oeXBmc19oYW5kbGUgeworICAgIHhlbnRvb2xsb2dfbG9nZ2VyICpsb2dnZXIsICpsb2dn
ZXJfdG9mcmVlOworICAgIHVuc2lnbmVkIGludCBmbGFnczsKKyAgICB4ZW5jYWxsX2hhbmRsZSAq
eGNhbGw7Cit9OworCit4ZW5oeXBmc19oYW5kbGUgKnhlbmh5cGZzX29wZW4oeGVudG9vbGxvZ19s
b2dnZXIgKmxvZ2dlciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBv
cGVuX2ZsYWdzKQoreworICAgIHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwgPSBjYWxsb2MoMSwgc2l6
ZW9mKCpmc2hkbCkpOworCisgICAgaWYgKCFmc2hkbCkKKyAgICAgICAgcmV0dXJuIE5VTEw7CisK
KyAgICBmc2hkbC0+ZmxhZ3MgPSBvcGVuX2ZsYWdzOworICAgIGZzaGRsLT5sb2dnZXIgPSBsb2dn
ZXI7CisgICAgZnNoZGwtPmxvZ2dlcl90b2ZyZWUgPSBOVUxMOworCisgICAgaWYgKCFmc2hkbC0+
bG9nZ2VyKSB7CisgICAgICAgIGZzaGRsLT5sb2dnZXIgPSBmc2hkbC0+bG9nZ2VyX3RvZnJlZSA9
CisgICAgICAgICAgICAoeGVudG9vbGxvZ19sb2dnZXIqKQorICAgICAgICAgICAgeHRsX2NyZWF0
ZWxvZ2dlcl9zdGRpb3N0cmVhbShzdGRlcnIsIFhUTF9QUk9HUkVTUywgMCk7CisgICAgICAgIGlm
ICghZnNoZGwtPmxvZ2dlcikKKyAgICAgICAgICAgIGdvdG8gZXJyOworICAgIH0KKworICAgIGZz
aGRsLT54Y2FsbCA9IHhlbmNhbGxfb3Blbihmc2hkbC0+bG9nZ2VyLCAwKTsKKyAgICBpZiAoIWZz
aGRsLT54Y2FsbCkKKyAgICAgICAgZ290byBlcnI7CisKKyAgICAvKiBObyBuZWVkIHRvIHJlbWVt
YmVyIHN1cHBvcnRlZCB2ZXJzaW9uLCB3ZSBvbmx5IHN1cHBvcnQgVjEuICovCisgICAgaWYgKHhl
bmNhbGwxKGZzaGRsLT54Y2FsbCwgX19IWVBFUlZJU09SX2h5cGZzX29wLAorICAgICAgICAgICAg
ICAgICBYRU5fSFlQRlNfT1BfZ2V0X3ZlcnNpb24pIDwgMCkKKyAgICAgICAgZ290byBlcnI7CisK
KyAgICByZXR1cm4gZnNoZGw7CisKK2VycjoKKyAgICB4dGxfbG9nZ2VyX2Rlc3Ryb3koZnNoZGwt
PmxvZ2dlcl90b2ZyZWUpOworICAgIHhlbmNhbGxfY2xvc2UoZnNoZGwtPnhjYWxsKTsKKyAgICBm
cmVlKGZzaGRsKTsKKyAgICByZXR1cm4gTlVMTDsKK30KKworaW50IHhlbmh5cGZzX2Nsb3NlKHhl
bmh5cGZzX2hhbmRsZSAqZnNoZGwpCit7CisgICAgaWYgKCFmc2hkbCkKKyAgICAgICAgcmV0dXJu
IDA7CisKKyAgICB4ZW5jYWxsX2Nsb3NlKGZzaGRsLT54Y2FsbCk7CisgICAgeHRsX2xvZ2dlcl9k
ZXN0cm95KGZzaGRsLT5sb2dnZXJfdG9mcmVlKTsKKyAgICBmcmVlKGZzaGRsKTsKKyAgICByZXR1
cm4gMDsKK30KKworc3RhdGljIGludCB4ZW5oeXBmc19nZXRfcGF0aGJ1Zih4ZW5oeXBmc19oYW5k
bGUgKmZzaGRsLCBjb25zdCBjaGFyICpwYXRoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjaGFyICoqcGF0aF9idWYpCit7CisgICAgaW50IHJldCA9IC0xOworICAgIGludCBwYXRo
X3N6OworCisgICAgaWYgKCFmc2hkbCkgeworICAgICAgICBlcnJubyA9IEVCQURGOworICAgICAg
ICBnb3RvIG91dDsKKyAgICB9CisKKyAgICBwYXRoX3N6ID0gc3RybGVuKHBhdGgpICsgMTsKKyAg
ICBpZiAocGF0aF9zeiA+IFhFTl9IWVBGU19NQVhfUEFUSExFTikKKyAgICB7CisgICAgICAgIGVy
cm5vID0gRU5BTUVUT09MT05HOworICAgICAgICBnb3RvIG91dDsKKyAgICB9CisKKyAgICAqcGF0
aF9idWYgPSB4ZW5jYWxsX2FsbG9jX2J1ZmZlcihmc2hkbC0+eGNhbGwsIHBhdGhfc3opOworICAg
IGlmICghKnBhdGhfYnVmKSB7CisgICAgICAgIGVycm5vID0gRU5PTUVNOworICAgICAgICBnb3Rv
IG91dDsKKyAgICB9CisgICAgc3RyY3B5KCpwYXRoX2J1ZiwgcGF0aCk7CisKKyAgICByZXQgPSBw
YXRoX3N6OworCisgb3V0OgorICAgIHJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lkICp4ZW5o
eXBmc19pbmZsYXRlKHZvaWQgKmluX2RhdGEsIHNpemVfdCAqc3opCit7CisgICAgdW5zaWduZWQg
Y2hhciAqd29ya2J1ZjsKKyAgICB2b2lkICpjb250ZW50ID0gTlVMTDsKKyAgICB1bnNpZ25lZCBp
bnQgb3V0X3N6OworICAgIHpfc3RyZWFtIHogPSB7IC5vcGFxdWUgPSBOVUxMIH07CisgICAgaW50
IHJldDsKKworICAgIHdvcmtidWYgPSBtYWxsb2MoQlVGX1NJWkUpOworICAgIGlmICghd29ya2J1
ZikKKyAgICAgICAgcmV0dXJuIE5VTEw7CisKKyAgICB6Lm5leHRfaW4gPSBpbl9kYXRhOworICAg
IHouYXZhaWxfaW4gPSAqc3o7CisgICAgcmV0ID0gaW5mbGF0ZUluaXQyKCZ6LCBNQVhfV0JJVFMg
KyAzMik7IC8qIDMyID09IGd6aXAgKi8KKworICAgIGZvciAoKnN6ID0gMDsgcmV0ID09IFpfT0s7
ICpzeiArPSBvdXRfc3opIHsKKyAgICAgICAgei5uZXh0X291dCA9IHdvcmtidWY7CisgICAgICAg
IHouYXZhaWxfb3V0ID0gQlVGX1NJWkU7CisgICAgICAgIHJldCA9IGluZmxhdGUoJnosIFpfU1lO
Q19GTFVTSCk7CisgICAgICAgIGlmIChyZXQgIT0gWl9PSyAmJiByZXQgIT0gWl9TVFJFQU1fRU5E
KQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAgb3V0X3N6ID0gei5uZXh0X291dCAtIHdv
cmtidWY7CisgICAgICAgIGNvbnRlbnQgPSByZWFsbG9jKGNvbnRlbnQsICpzeiArIG91dF9zeik7
CisgICAgICAgIGlmICghY29udGVudCkgeworICAgICAgICAgICAgcmV0ID0gWl9NRU1fRVJST1I7
CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBtZW1jcHkoY29udGVudCAr
ICpzeiwgd29ya2J1Ziwgb3V0X3N6KTsKKyAgICB9CisKKyAgICBpbmZsYXRlRW5kKCZ6KTsKKyAg
ICBpZiAocmV0ICE9IFpfU1RSRUFNX0VORCkgeworICAgICAgICBmcmVlKGNvbnRlbnQpOworICAg
ICAgICBjb250ZW50ID0gTlVMTDsKKyAgICAgICAgZXJybm8gPSBFSU87CisgICAgfQorICAgIGZy
ZWUod29ya2J1Zik7CisgICAgcmV0dXJuIGNvbnRlbnQ7Cit9CisKK3N0YXRpYyB2b2lkIHhlbmh5
cGZzX3NldF9hdHRycyhzdHJ1Y3QgeGVuX2h5cGZzX2RpcmVudHJ5ICplbnRyeSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuaHlwZnNfZGlyZW50ICpkaXJlbnQpCit7
CisgICAgZGlyZW50LT5zaXplID0gZW50cnktPmNvbnRlbnRfbGVuOworCisgICAgc3dpdGNoKGVu
dHJ5LT50eXBlKSB7CisgICAgY2FzZSBYRU5fSFlQRlNfVFlQRV9ESVI6CisgICAgICAgIGRpcmVu
dC0+dHlwZSA9IHhlbmh5cGZzX3R5cGVfZGlyOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFhF
Tl9IWVBGU19UWVBFX0JMT0I6CisgICAgICAgIGRpcmVudC0+dHlwZSA9IHhlbmh5cGZzX3R5cGVf
YmxvYjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBYRU5fSFlQRlNfVFlQRV9TVFJJTkc6Cisg
ICAgICAgIGRpcmVudC0+dHlwZSA9IHhlbmh5cGZzX3R5cGVfc3RyaW5nOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIFhFTl9IWVBGU19UWVBFX1VJTlQ6CisgICAgICAgIGRpcmVudC0+dHlwZSA9
IHhlbmh5cGZzX3R5cGVfdWludDsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBYRU5fSFlQRlNf
VFlQRV9JTlQ6CisgICAgICAgIGRpcmVudC0+dHlwZSA9IHhlbmh5cGZzX3R5cGVfaW50OworICAg
ICAgICBicmVhazsKKyAgICBjYXNlIFhFTl9IWVBGU19UWVBFX0JPT0w6CisgICAgICAgIGRpcmVu
dC0+dHlwZSA9IHhlbmh5cGZzX3R5cGVfYm9vbDsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVs
dDoKKyAgICAgICAgZGlyZW50LT50eXBlID0geGVuaHlwZnNfdHlwZV9ibG9iOworICAgIH0KKwor
ICAgIHN3aXRjaCAoZW50cnktPmVuY29kaW5nKSB7CisgICAgY2FzZSBYRU5fSFlQRlNfRU5DX1BM
QUlOOgorICAgICAgICBkaXJlbnQtPmVuY29kaW5nID0geGVuaHlwZnNfZW5jX3BsYWluOworICAg
ICAgICBicmVhazsKKyAgICBjYXNlIFhFTl9IWVBGU19FTkNfR1pJUDoKKyAgICAgICAgZGlyZW50
LT5lbmNvZGluZyA9IHhlbmh5cGZzX2VuY19nemlwOworICAgICAgICBicmVhazsKKyAgICBkZWZh
dWx0OgorICAgICAgICBkaXJlbnQtPmVuY29kaW5nID0geGVuaHlwZnNfZW5jX3BsYWluOworICAg
ICAgICBkaXJlbnQtPnR5cGUgPSB4ZW5oeXBmc190eXBlX2Jsb2I7CisgICAgfQorCisgICAgZGly
ZW50LT5pc193cml0YWJsZSA9IGVudHJ5LT5mbGFncyAmIFhFTl9IWVBGU19XUklURUFCTEU7Cit9
CisKK3ZvaWQgKnhlbmh5cGZzX3JlYWRfcmF3KHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0
IGNoYXIgKnBhdGgsCisgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuaHlwZnNfZGly
ZW50ICoqZGlyZW50KQoreworICAgIHZvaWQgKnJldGJ1ZiA9IE5VTEwsICpjb250ZW50ID0gTlVM
TDsKKyAgICBjaGFyICpwYXRoX2J1ZiA9IE5VTEw7CisgICAgY29uc3QgY2hhciAqbmFtZTsKKyAg
ICBzdHJ1Y3QgeGVuX2h5cGZzX2RpcmVudHJ5ICplbnRyeTsKKyAgICBpbnQgcmV0OworICAgIGlu
dCBzeiwgcGF0aF9zejsKKworICAgICpkaXJlbnQgPSBOVUxMOworICAgIHJldCA9IHhlbmh5cGZz
X2dldF9wYXRoYnVmKGZzaGRsLCBwYXRoLCAmcGF0aF9idWYpOworICAgIGlmIChyZXQgPCAwKQor
ICAgICAgICBnb3RvIG91dDsKKworICAgIHBhdGhfc3ogPSByZXQ7CisKKyAgICBmb3IgKHN6ID0g
QlVGX1NJWkU7OyBzeiA9IHNpemVvZigqZW50cnkpICsgZW50cnktPmNvbnRlbnRfbGVuKSB7Cisg
ICAgICAgIGlmIChyZXRidWYpCisgICAgICAgICAgICB4ZW5jYWxsX2ZyZWVfYnVmZmVyKGZzaGRs
LT54Y2FsbCwgcmV0YnVmKTsKKworICAgICAgICByZXRidWYgPSB4ZW5jYWxsX2FsbG9jX2J1ZmZl
cihmc2hkbC0+eGNhbGwsIHN6KTsKKyAgICAgICAgaWYgKCFyZXRidWYpIHsKKyAgICAgICAgICAg
IGVycm5vID0gRU5PTUVNOworICAgICAgICAgICAgZ290byBvdXQ7CisgICAgICAgIH0KKyAgICAg
ICAgZW50cnkgPSByZXRidWY7CisKKyAgICAgICAgcmV0ID0geGVuY2FsbDUoZnNoZGwtPnhjYWxs
LCBfX0hZUEVSVklTT1JfaHlwZnNfb3AsCisgICAgICAgICAgICAgICAgICAgICAgIFhFTl9IWVBG
U19PUF9yZWFkX2NvbnRlbnRzLAorICAgICAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9u
ZylwYXRoX2J1ZiwgcGF0aF9zeiwKKyAgICAgICAgICAgICAgICAgICAgICAgKHVuc2lnbmVkIGxv
bmcpcmV0YnVmLCBzeik7CisgICAgICAgIGlmIChyZXQgPCAwKSB7CisgICAgICAgICAgICBlcnJu
byA9IC1yZXQ7CisgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAgfQorCisgICAgICAgIGlm
IChzeiA8PSBzaXplb2YoKmVudHJ5KSArIGVudHJ5LT5jb250ZW50X2xlbikKKyAgICAgICAgICAg
IGJyZWFrOworICAgIH0KKworICAgIGNvbnRlbnQgPSBtYWxsb2MoZW50cnktPmNvbnRlbnRfbGVu
KTsKKyAgICBpZiAoIWNvbnRlbnQpCisgICAgICAgIGdvdG8gb3V0OworICAgIG1lbWNweShjb250
ZW50LCBlbnRyeSArIDEsIGVudHJ5LT5jb250ZW50X2xlbik7CisKKyAgICBuYW1lID0gc3RycmNo
cihwYXRoLCAnLycpOworICAgIGlmICghbmFtZSkKKyAgICAgICAgbmFtZSA9IHBhdGg7CisgICAg
ZWxzZSB7CisgICAgICAgIG5hbWUrKzsKKyAgICAgICAgaWYgKCEqbmFtZSkKKyAgICAgICAgICAg
IG5hbWUtLTsKKyAgICB9CisgICAgKmRpcmVudCA9IGNhbGxvYygxLCBzaXplb2Yoc3RydWN0IHhl
bmh5cGZzX2RpcmVudCkgKyBzdHJsZW4obmFtZSkgKyAxKTsKKyAgICBpZiAoISpkaXJlbnQpIHsK
KyAgICAgICAgZnJlZShjb250ZW50KTsKKyAgICAgICAgY29udGVudCA9IE5VTEw7CisgICAgICAg
IGVycm5vID0gRU5PTUVNOworICAgICAgICBnb3RvIG91dDsKKyAgICB9CisgICAgKCpkaXJlbnQp
LT5uYW1lID0gKGNoYXIgKikoKmRpcmVudCArIDEpOworICAgIHN0cmNweSgoKmRpcmVudCktPm5h
bWUsIG5hbWUpOworICAgIHhlbmh5cGZzX3NldF9hdHRycyhlbnRyeSwgKmRpcmVudCk7CisKKyBv
dXQ6CisgICAgcmV0ID0gZXJybm87CisgICAgeGVuY2FsbF9mcmVlX2J1ZmZlcihmc2hkbC0+eGNh
bGwsIHBhdGhfYnVmKTsKKyAgICB4ZW5jYWxsX2ZyZWVfYnVmZmVyKGZzaGRsLT54Y2FsbCwgcmV0
YnVmKTsKKyAgICBlcnJubyA9IHJldDsKKworICAgIHJldHVybiBjb250ZW50OworfQorCitjaGFy
ICp4ZW5oeXBmc19yZWFkKHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBhdGgp
Cit7CisgICAgY2hhciAqYnVmLCAqcmV0X2J1ZiA9IE5VTEw7CisgICAgc3RydWN0IHhlbmh5cGZz
X2RpcmVudCAqZGlyZW50OworICAgIGludCByZXQ7CisKKyAgICBidWYgPSB4ZW5oeXBmc19yZWFk
X3Jhdyhmc2hkbCwgcGF0aCwgJmRpcmVudCk7CisgICAgaWYgKCFidWYpCisgICAgICAgIGdvdG8g
b3V0OworCisgICAgc3dpdGNoIChkaXJlbnQtPmVuY29kaW5nKSB7CisgICAgY2FzZSB4ZW5oeXBm
c19lbmNfcGxhaW46CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgeGVuaHlwZnNfZW5jX2d6aXA6
CisgICAgICAgIHJldF9idWYgPSB4ZW5oeXBmc19pbmZsYXRlKGJ1ZiwgJmRpcmVudC0+c2l6ZSk7
CisgICAgICAgIGlmICghcmV0X2J1ZikKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAgICBm
cmVlKGJ1Zik7CisgICAgICAgIGJ1ZiA9IHJldF9idWY7CisgICAgICAgIHJldF9idWYgPSBOVUxM
OworICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBzd2l0Y2ggKGRpcmVudC0+dHlwZSkgewor
ICAgIGNhc2UgeGVuaHlwZnNfdHlwZV9kaXI6CisgICAgICAgIGVycm5vID0gRUlTRElSOworICAg
ICAgICBicmVhazsKKyAgICBjYXNlIHhlbmh5cGZzX3R5cGVfYmxvYjoKKyAgICAgICAgZXJybm8g
PSBFRE9NOworICAgICAgICBicmVhazsKKyAgICBjYXNlIHhlbmh5cGZzX3R5cGVfc3RyaW5nOgor
ICAgICAgICByZXRfYnVmID0gYnVmOworICAgICAgICBidWYgPSBOVUxMOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIHhlbmh5cGZzX3R5cGVfdWludDoKKyAgICBjYXNlIHhlbmh5cGZzX3R5cGVf
Ym9vbDoKKyAgICAgICAgc3dpdGNoIChkaXJlbnQtPnNpemUpIHsKKyAgICAgICAgY2FzZSAxOgor
ICAgICAgICAgICAgcmV0ID0gYXNwcmludGYoJnJldF9idWYsICIlIlBSSXU4LCAqKHVpbnQ4X3Qg
KilidWYpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgMjoKKyAgICAgICAgICAg
IHJldCA9IGFzcHJpbnRmKCZyZXRfYnVmLCAiJSJQUkl1MTYsICoodWludDE2X3QgKilidWYpOwor
ICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgNDoKKyAgICAgICAgICAgIHJldCA9IGFz
cHJpbnRmKCZyZXRfYnVmLCAiJSJQUkl1MzIsICoodWludDMyX3QgKilidWYpOworICAgICAgICAg
ICAgYnJlYWs7CisgICAgICAgIGNhc2UgODoKKyAgICAgICAgICAgIHJldCA9IGFzcHJpbnRmKCZy
ZXRfYnVmLCAiJSJQUkl1NjQsICoodWludDY0X3QgKilidWYpOworICAgICAgICAgICAgYnJlYWs7
CisgICAgICAgIGRlZmF1bHQ6CisgICAgICAgICAgICByZXQgPSAtMTsKKyAgICAgICAgICAgIGVy
cm5vID0gRURPTTsKKyAgICAgICAgfQorICAgICAgICBpZiAocmV0IDwgMCkKKyAgICAgICAgICAg
IHJldF9idWYgPSBOVUxMOworICAgICAgICBicmVhazsKKyAgICBjYXNlIHhlbmh5cGZzX3R5cGVf
aW50OgorICAgICAgICBzd2l0Y2ggKGRpcmVudC0+c2l6ZSkgeworICAgICAgICBjYXNlIDE6Cisg
ICAgICAgICAgICByZXQgPSBhc3ByaW50ZigmcmV0X2J1ZiwgIiUiUFJJZDgsICooaW50OF90ICop
YnVmKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIDI6CisgICAgICAgICAgICBy
ZXQgPSBhc3ByaW50ZigmcmV0X2J1ZiwgIiUiUFJJZDE2LCAqKGludDE2X3QgKilidWYpOworICAg
ICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgNDoKKyAgICAgICAgICAgIHJldCA9IGFzcHJp
bnRmKCZyZXRfYnVmLCAiJSJQUklkMzIsICooaW50MzJfdCAqKWJ1Zik7CisgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgY2FzZSA4OgorICAgICAgICAgICAgcmV0ID0gYXNwcmludGYoJnJldF9i
dWYsICIlIlBSSWQ2NCwgKihpbnQ2NF90ICopYnVmKTsKKyAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICBkZWZhdWx0OgorICAgICAgICAgICAgcmV0ID0gLTE7CisgICAgICAgICAgICBlcnJubyA9
IEVET007CisgICAgICAgIH0KKyAgICAgICAgaWYgKHJldCA8IDApCisgICAgICAgICAgICByZXRf
YnVmID0gTlVMTDsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgb3V0OgorICAgIHJldCA9IGVy
cm5vOworICAgIGZyZWUoYnVmKTsKKyAgICBmcmVlKGRpcmVudCk7CisgICAgZXJybm8gPSByZXQ7
CisKKyAgICByZXR1cm4gcmV0X2J1ZjsKK30KKworc3RydWN0IHhlbmh5cGZzX2RpcmVudCAqeGVu
aHlwZnNfcmVhZGRpcih4ZW5oeXBmc19oYW5kbGUgKmZzaGRsLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpwYXRoLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKm51bV9lbnRyaWVzKQorewor
ICAgIHZvaWQgKmJ1ZiwgKmN1cnI7CisgICAgaW50IHJldDsKKyAgICBjaGFyICpuYW1lczsKKyAg
ICBzdHJ1Y3QgeGVuaHlwZnNfZGlyZW50ICpyZXRfYnVmID0gTlVMTCwgKmRpcmVudDsKKyAgICB1
bnNpZ25lZCBpbnQgbiA9IDAsIG5hbWVfc3ogPSAwOworICAgIHN0cnVjdCB4ZW5faHlwZnNfZGly
bGlzdGVudHJ5ICplbnRyeTsKKworICAgIGJ1ZiA9IHhlbmh5cGZzX3JlYWRfcmF3KGZzaGRsLCBw
YXRoLCAmZGlyZW50KTsKKyAgICBpZiAoIWJ1ZikKKyAgICAgICAgZ290byBvdXQ7CisKKyAgICBp
ZiAoZGlyZW50LT50eXBlICE9IHhlbmh5cGZzX3R5cGVfZGlyIHx8CisgICAgICAgIGRpcmVudC0+
ZW5jb2RpbmcgIT0geGVuaHlwZnNfZW5jX3BsYWluKSB7CisgICAgICAgIGVycm5vID0gRU5PVERJ
UjsKKyAgICAgICAgZ290byBvdXQ7CisgICAgfQorCisgICAgaWYgKGRpcmVudC0+c2l6ZSkgewor
ICAgICAgICBjdXJyID0gYnVmOworICAgICAgICBmb3IgKG4gPSAxOzsgbisrKSB7CisgICAgICAg
ICAgICBlbnRyeSA9IGN1cnI7CisgICAgICAgICAgICBuYW1lX3N6ICs9IHN0cmxlbihlbnRyeS0+
bmFtZSkgKyAxOworICAgICAgICAgICAgaWYgKCFlbnRyeS0+b2ZmX25leHQpCisgICAgICAgICAg
ICAgICAgYnJlYWs7CisKKyAgICAgICAgICAgIGN1cnIgKz0gZW50cnktPm9mZl9uZXh0OworICAg
ICAgICB9CisgICAgfQorCisgICAgcmV0X2J1ZiA9IG1hbGxvYyhuICogc2l6ZW9mKCpyZXRfYnVm
KSArIG5hbWVfc3opOworICAgIGlmICghcmV0X2J1ZikKKyAgICAgICAgZ290byBvdXQ7CisKKyAg
ICAqbnVtX2VudHJpZXMgPSBuOworICAgIG5hbWVzID0gKGNoYXIgKikocmV0X2J1ZiArIG4pOwor
ICAgIGN1cnIgPSBidWY7CisgICAgZm9yIChuID0gMDsgbiA8ICpudW1fZW50cmllczsgbisrKSB7
CisgICAgICAgIGVudHJ5ID0gY3VycjsKKyAgICAgICAgeGVuaHlwZnNfc2V0X2F0dHJzKCZlbnRy
eS0+ZSwgcmV0X2J1ZiArIG4pOworICAgICAgICByZXRfYnVmW25dLm5hbWUgPSBuYW1lczsKKyAg
ICAgICAgc3RyY3B5KG5hbWVzLCBlbnRyeS0+bmFtZSk7CisgICAgICAgIG5hbWVzICs9IHN0cmxl
bihlbnRyeS0+bmFtZSkgKyAxOworICAgICAgICBjdXJyICs9IGVudHJ5LT5vZmZfbmV4dDsKKyAg
ICB9CisKKyBvdXQ6CisgICAgcmV0ID0gZXJybm87CisgICAgZnJlZShidWYpOworICAgIGZyZWUo
ZGlyZW50KTsKKyAgICBlcnJubyA9IHJldDsKKworICAgIHJldHVybiByZXRfYnVmOworfQorCitp
bnQgeGVuaHlwZnNfd3JpdGUoeGVuaHlwZnNfaGFuZGxlICpmc2hkbCwgY29uc3QgY2hhciAqcGF0
aCwgY29uc3QgY2hhciAqdmFsKQoreworICAgIHZvaWQgKmJ1ZiA9IE5VTEw7CisgICAgY2hhciAq
cGF0aF9idWYgPSBOVUxMLCAqdmFsX2VuZDsKKyAgICBpbnQgcmV0LCBzYXZlZF9lcnJubzsKKyAg
ICBpbnQgc3osIHBhdGhfc3o7CisgICAgc3RydWN0IHhlbl9oeXBmc19kaXJlbnRyeSAqZW50cnk7
CisgICAgdWludDY0X3QgbWFzazsKKworICAgIHJldCA9IHhlbmh5cGZzX2dldF9wYXRoYnVmKGZz
aGRsLCBwYXRoLCAmcGF0aF9idWYpOworICAgIGlmIChyZXQgPCAwKQorICAgICAgICBnb3RvIG91
dDsKKworICAgIHBhdGhfc3ogPSByZXQ7CisgICAgcmV0ID0gLTE7CisKKyAgICBzeiA9IEJVRl9T
SVpFOworICAgIGJ1ZiA9IHhlbmNhbGxfYWxsb2NfYnVmZmVyKGZzaGRsLT54Y2FsbCwgc3opOwor
ICAgIGlmICghYnVmKSB7CisgICAgICAgIGVycm5vID0gRU5PTUVNOworICAgICAgICBnb3RvIG91
dDsKKyAgICB9CisKKyAgICByZXQgPSB4ZW5jYWxsNShmc2hkbC0+eGNhbGwsIF9fSFlQRVJWSVNP
Ul9oeXBmc19vcCwKKyAgICAgICAgICAgICAgICAgICBYRU5fSFlQRlNfT1BfcmVhZF9jb250ZW50
cywKKyAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZylwYXRoX2J1ZiwgcGF0aF9zeiwK
KyAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZylidWYsIHNpemVvZigqZW50cnkpKTsK
KyAgICBpZiAocmV0KQorICAgICAgICBnb3RvIG91dDsKKyAgICByZXQgPSAtMTsKKyAgICBlbnRy
eSA9IGJ1ZjsKKyAgICBpZiAoIShlbnRyeS0+ZmxhZ3MgJiBYRU5fSFlQRlNfV1JJVEVBQkxFKSkg
eworICAgICAgICBlcnJubyA9IEVBQ0NFUzsKKyAgICAgICAgZ290byBvdXQ7CisgICAgfQorICAg
IGlmIChlbnRyeS0+ZW5jb2RpbmcgIT0gWEVOX0hZUEZTX0VOQ19QTEFJTikgeworICAgICAgICAv
KiBXcml0aW5nIGNvbXByZXNzZWQgZGF0YSBjdXJyZW50bHkgbm90IHN1cHBvcnRlZC4gKi8KKyAg
ICAgICAgZXJybm8gPSBFRE9NOworICAgICAgICBnb3RvIG91dDsKKyAgICB9CisKKyAgICBzd2l0
Y2ggKGVudHJ5LT50eXBlKSB7CisgICAgY2FzZSBYRU5fSFlQRlNfVFlQRV9TVFJJTkc6CisgICAg
ICAgIGlmIChzeiA8IHN0cmxlbih2YWwpICsgMSkgeworICAgICAgICAgICAgc3ogPSBzdHJsZW4o
dmFsKSArIDE7CisgICAgICAgICAgICB4ZW5jYWxsX2ZyZWVfYnVmZmVyKGZzaGRsLT54Y2FsbCwg
YnVmKTsKKyAgICAgICAgICAgIGJ1ZiA9IHhlbmNhbGxfYWxsb2NfYnVmZmVyKGZzaGRsLT54Y2Fs
bCwgc3opOworICAgICAgICAgICAgaWYgKCFidWYpIHsKKyAgICAgICAgICAgICAgICBlcnJubyA9
IEVOT01FTTsKKyAgICAgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAgICAgIH0KKyAgICAg
ICAgfQorICAgICAgICBzdHJjcHkoYnVmLCB2YWwpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IFhFTl9IWVBGU19UWVBFX1VJTlQ6CisgICAgICAgIHN6ID0gZW50cnktPmNvbnRlbnRfbGVuOwor
ICAgICAgICBlcnJubyA9IDA7CisgICAgICAgICoodW5zaWduZWQgbG9uZyBsb25nICopYnVmID0g
c3RydG91bGwodmFsLCAmdmFsX2VuZCwgMCk7CisgICAgICAgIGlmIChlcnJubyB8fCAhKnZhbCB8
fCAqdmFsX2VuZCkKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAgICBtYXNrID0gfjBVTEwg
PDwgKDggKiBzeik7CisgICAgICAgIGlmICgoKih1aW50NjRfdCAqKWJ1ZiAmIG1hc2spICYmICgo
Kih1aW50NjRfdCAqKWJ1ZiAmIG1hc2spICE9IG1hc2spKSB7CisgICAgICAgICAgICBlcnJubyA9
IEVSQU5HRTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAgICB9CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgWEVOX0hZUEZTX1RZUEVfSU5UOgorICAgICAgICBzeiA9IGVudHJ5LT5jb250
ZW50X2xlbjsKKyAgICAgICAgZXJybm8gPSAwOworICAgICAgICAqKHVuc2lnbmVkIGxvbmcgbG9u
ZyAqKWJ1ZiA9IHN0cnRvbGwodmFsLCAmdmFsX2VuZCwgMCk7CisgICAgICAgIGlmIChlcnJubyB8
fCAhKnZhbCB8fCAqdmFsX2VuZCkKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAgICBtYXNr
ID0gKHN6ID09IDgpID8gMCA6IH4wVUxMIDw8ICg4ICogc3opOworICAgICAgICBpZiAoKCoodWlu
dDY0X3QgKilidWYgJiBtYXNrKSAmJiAoKCoodWludDY0X3QgKilidWYgJiBtYXNrKSAhPSBtYXNr
KSkgeworICAgICAgICAgICAgZXJybm8gPSBFUkFOR0U7CisgICAgICAgICAgICBnb3RvIG91dDsK
KyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNlIFhFTl9IWVBGU19UWVBFX0JPT0w6
CisgICAgICAgICoodW5zaWduZWQgbG9uZyBsb25nICopYnVmID0gMDsKKyAgICAgICAgaWYgKCFz
dHJjbXAodmFsLCAiMSIpIHx8ICFzdHJjbXAodmFsLCAib24iKSB8fCAhc3RyY21wKHZhbCwgInll
cyIpIHx8CisgICAgICAgICAgICAhc3RyY21wKHZhbCwgInRydWUiKSB8fCAhc3RyY21wKHZhbCwg
ImVuYWJsZSIpKQorICAgICAgICAgICAgKih1bnNpZ25lZCBsb25nIGxvbmcgKilidWYgPSAxOwor
ICAgICAgICBlbHNlIGlmIChzdHJjbXAodmFsLCAiMCIpICYmIHN0cmNtcCh2YWwsICJubyIpICYm
IHN0cmNtcCh2YWwsICJvZmYiKSAmJgorICAgICAgICAgICAgICAgICBzdHJjbXAodmFsLCAiZmFs
c2UiKSAmJiBzdHJjbXAodmFsLCAiZGlzYWJsZSIpKSB7CisgICAgICAgICAgICBlcnJubyA9IEVE
T007CisgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAg
ICBkZWZhdWx0OgorICAgICAgICAvKiBObyBzdXBwb3J0IGZvciBvdGhlciB0eXBlcyAoeWV0KS4g
Ki8KKyAgICAgICAgZXJybm8gPSBFRE9NOworICAgICAgICBnb3RvIG91dDsKKyAgICB9CisKKyAg
ICByZXQgPSB4ZW5jYWxsNShmc2hkbC0+eGNhbGwsIF9fSFlQRVJWSVNPUl9oeXBmc19vcCwKKyAg
ICAgICAgICAgICAgICAgICBYRU5fSFlQRlNfT1Bfd3JpdGVfY29udGVudHMsCisgICAgICAgICAg
ICAgICAgICAgKHVuc2lnbmVkIGxvbmcpcGF0aF9idWYsIHBhdGhfc3osCisgICAgICAgICAgICAg
ICAgICAgKHVuc2lnbmVkIGxvbmcpYnVmLCBzeik7CisKKyBvdXQ6CisgICAgc2F2ZWRfZXJybm8g
PSBlcnJubzsKKyAgICB4ZW5jYWxsX2ZyZWVfYnVmZmVyKGZzaGRsLT54Y2FsbCwgcGF0aF9idWYp
OworICAgIHhlbmNhbGxfZnJlZV9idWZmZXIoZnNoZGwtPnhjYWxsLCBidWYpOworICAgIGVycm5v
ID0gc2F2ZWRfZXJybm87CisgICAgcmV0dXJuIHJldDsKK30KZGlmZiAtLWdpdCBhL3Rvb2xzL2xp
YnMvaHlwZnMvaW5jbHVkZS94ZW5oeXBmcy5oIGIvdG9vbHMvbGlicy9oeXBmcy9pbmNsdWRlL3hl
bmh5cGZzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uMjljNjk3MTJj
ZQotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL2xpYnMvaHlwZnMvaW5jbHVkZS94ZW5oeXBmcy5o
CkBAIC0wLDAgKzEsNzUgQEAKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTkgU1VTRSBTb2Z0d2Fy
ZSBTb2x1dGlvbnMgR2VybWFueSBHbWJICisgKgorICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29m
dHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICogbW9kaWZ5IGl0IHVuZGVy
IHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICogTGljZW5zZSBh
cyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsKKyAqIHZlcnNpb24g
Mi4xIG9mIHRoZSBMaWNlbnNlLgorICoKKyAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBp
biB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdB
UlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5U
QUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05V
CisgKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoK
KyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2Vu
ZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IElmIG5vdCwg
c2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyAqLworI2lmbmRlZiBYRU5IWVBG
U19ICisjZGVmaW5lIFhFTkhZUEZTX0gKKworI2luY2x1ZGUgPHN0ZGJvb2wuaD4KKyNpbmNsdWRl
IDxzdGRpbnQuaD4KKyNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKworLyogQ2FsbGVycyB3aG8gZG9u
J3QgY2FyZSBkb24ndCBuZWVkIHRvICNpbmNsdWRlIDx4ZW50b29sbG9nLmg+ICovCitzdHJ1Y3Qg
eGVudG9vbGxvZ19sb2dnZXI7CisKK3R5cGVkZWYgc3RydWN0IHhlbmh5cGZzX2hhbmRsZSB4ZW5o
eXBmc19oYW5kbGU7CisKK3N0cnVjdCB4ZW5oeXBmc19kaXJlbnQgeworICAgIGNoYXIgKm5hbWU7
CisgICAgc2l6ZV90IHNpemU7CisgICAgZW51bSB7CisgICAgICAgIHhlbmh5cGZzX3R5cGVfZGly
LAorICAgICAgICB4ZW5oeXBmc190eXBlX2Jsb2IsCisgICAgICAgIHhlbmh5cGZzX3R5cGVfc3Ry
aW5nLAorICAgICAgICB4ZW5oeXBmc190eXBlX3VpbnQsCisgICAgICAgIHhlbmh5cGZzX3R5cGVf
aW50LAorICAgICAgICB4ZW5oeXBmc190eXBlX2Jvb2wKKyAgICB9IHR5cGU7CisgICAgZW51bSB7
CisgICAgICAgIHhlbmh5cGZzX2VuY19wbGFpbiwKKyAgICAgICAgeGVuaHlwZnNfZW5jX2d6aXAK
KyAgICB9IGVuY29kaW5nOworICAgIGJvb2wgaXNfd3JpdGFibGU7Cit9OworCit4ZW5oeXBmc19o
YW5kbGUgKnhlbmh5cGZzX29wZW4oc3RydWN0IHhlbnRvb2xsb2dfbG9nZ2VyICpsb2dnZXIsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9wZW5fZmxhZ3MpOwor
aW50IHhlbmh5cGZzX2Nsb3NlKHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwpOworCisvKiBSZXR1cm5l
ZCBidWZmZXIgYW5kIGRpcmVudCBzaG91bGQgYmUgZnJlZWQgdmlhIGZyZWUoKS4gKi8KK3ZvaWQg
Knhlbmh5cGZzX3JlYWRfcmF3KHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBh
dGgsCisgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuaHlwZnNfZGlyZW50ICoqZGly
ZW50KTsKKworLyogUmV0dXJuZWQgYnVmZmVyIHNob3VsZCBiZSBmcmVlZCB2aWEgZnJlZSgpLiAq
LworY2hhciAqeGVuaHlwZnNfcmVhZCh4ZW5oeXBmc19oYW5kbGUgKmZzaGRsLCBjb25zdCBjaGFy
ICpwYXRoKTsKKworLyogUmV0dXJuZWQgYnVmZmVyIHNob3VsZCBiZSBmcmVlZCB2aWEgZnJlZSgp
LiAqLworc3RydWN0IHhlbmh5cGZzX2RpcmVudCAqeGVuaHlwZnNfcmVhZGRpcih4ZW5oeXBmc19o
YW5kbGUgKmZzaGRsLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBjaGFyICpwYXRoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgKm51bV9lbnRyaWVzKTsKKworaW50IHhlbmh5cGZzX3dyaXRlKHhlbmh5
cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKnZhbCk7CisK
KyNlbmRpZiAvKiBYRU5IWVBGU19IICovCisKKy8qCisgKiBMb2NhbCB2YXJpYWJsZXM6CisgKiBt
b2RlOiBDCisgKiBjLWZpbGUtc3R5bGU6ICJCU0QiCisgKiBjLWJhc2ljLW9mZnNldDogNAorICog
dGFiLXdpZHRoOiA0CisgKiBpbmRlbnQtdGFicy1tb2RlOiBuaWwKKyAqIEVuZDoKKyAqLwpkaWZm
IC0tZ2l0IGEvdG9vbHMvbGlicy9oeXBmcy9saWJ4ZW5oeXBmcy5tYXAgYi90b29scy9saWJzL2h5
cGZzL2xpYnhlbmh5cGZzLm1hcApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
Li40N2YxZWRkYTNlCi0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvbGlicy9oeXBmcy9saWJ4ZW5o
eXBmcy5tYXAKQEAgLTAsMCArMSwxMCBAQAorVkVSU18xLjAgeworCWdsb2JhbDoKKwkJeGVuaHlw
ZnNfb3BlbjsKKwkJeGVuaHlwZnNfY2xvc2U7CisJCXhlbmh5cGZzX3JlYWRfcmF3OworCQl4ZW5o
eXBmc19yZWFkOworCQl4ZW5oeXBmc19yZWFkZGlyOworCQl4ZW5oeXBmc193cml0ZTsKKwlsb2Nh
bDogKjsgLyogRG8gbm90IGV4cG9zZSBhbnl0aGluZyBieSBkZWZhdWx0ICovCit9OwpkaWZmIC0t
Z2l0IGEvdG9vbHMvbGlicy9oeXBmcy94ZW5oeXBmcy5wYy5pbiBiL3Rvb2xzL2xpYnMvaHlwZnMv
eGVuaHlwZnMucGMuaW4KbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uOWNi
OTY4ZjBkYgotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL2xpYnMvaHlwZnMveGVuaHlwZnMucGMu
aW4KQEAgLTAsMCArMSwxMCBAQAorcHJlZml4PUBAcHJlZml4QEAKK2luY2x1ZGVkaXI9QEBpbmNk
aXJAQAorbGliZGlyPUBAbGliZGlyQEAKKworTmFtZTogWGVuaHlwZnMKK0Rlc2NyaXB0aW9uOiBU
aGUgWGVuaHlwZnMgbGlicmFyeSBmb3IgWGVuIGh5cGVydmlzb3IKK1ZlcnNpb246IEBAdmVyc2lv
bkBACitDZmxhZ3M6IC1JJHtpbmNsdWRlZGlyfSBAQGNmbGFnc2xvY2FsQEAKK0xpYnM6IEBAbGli
c2ZsYWdAQCR7bGliZGlyfSAtbHhlbmh5cGZzCitSZXF1aXJlcy5wcml2YXRlOiB4ZW50b29sY29y
ZSx4ZW50b29sbG9nLHhlbmNhbGwKLS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id A0AB1AE045
	for <lists+xen-devel@lfdr.de>; Mon,  9 Sep 2019 23:28:17 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i7R9S-00026J-7b; Mon, 09 Sep 2019 21:24:46 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=fSZh=XE=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1i7R9Q-00026E-H4
 for xen-devel@lists.xenproject.org; Mon, 09 Sep 2019 21:24:44 +0000
X-Inumbo-ID: 3cd3feda-d348-11e9-b299-bc764e2007e4
Received: from foss.arm.com (unknown [217.140.110.172])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTP
 id 3cd3feda-d348-11e9-b299-bc764e2007e4;
 Mon, 09 Sep 2019 21:24:42 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 0358628;
 Mon,  9 Sep 2019 14:24:42 -0700 (PDT)
Received: from [10.37.12.117] (unknown [10.37.12.117])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 321A43F67D;
 Mon,  9 Sep 2019 14:24:40 -0700 (PDT)
To: Oleksandr Tyshchenko <olekstysh@gmail.com>, xen-devel@lists.xenproject.org
References: <1566324587-3442-1-git-send-email-olekstysh@gmail.com>
 <1566324587-3442-9-git-send-email-olekstysh@gmail.com>
From: Julien Grall <julien.grall@arm.com>
Message-ID: <2b1d815c-720d-46c1-04de-0b8eb627b22f@arm.com>
Date: Mon, 9 Sep 2019 22:24:38 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <1566324587-3442-9-git-send-email-olekstysh@gmail.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH V3 8/8] iommu/arm: Add Renesas IPMMU-VMSA
 support
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Oleksandr Tyshchenko <oleksandr_tyshchenko@epam.com>,
 Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com>, sstabellini@kernel.org,
 Volodymyr_Babchuk@epam.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SGkgT2xla3NhbmRyLAoKT24gOC8yMC8xOSA3OjA5IFBNLCBPbGVrc2FuZHIgVHlzaGNoZW5rbyB3
cm90ZToKPiBkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL3BsYXRmb3Jtcy9LY29uZmlnIGIveGVu
L2FyY2gvYXJtL3BsYXRmb3Jtcy9LY29uZmlnCj4gaW5kZXggYmMwZTljZC4uYzkzYTZiMiAxMDA2
NDQKPiAtLS0gYS94ZW4vYXJjaC9hcm0vcGxhdGZvcm1zL0tjb25maWcKPiArKysgYi94ZW4vYXJj
aC9hcm0vcGxhdGZvcm1zL0tjb25maWcKPiBAQCAtMjUsNiArMjUsNyBAQCBjb25maWcgUkNBUjMK
PiAgIAlib29sICJSZW5lc2FzIFJDYXIzIHN1cHBvcnQiCj4gICAJZGVwZW5kcyBvbiBBUk1fNjQK
PiAgIAlzZWxlY3QgSEFTX1NDSUYKPiArCXNlbGVjdCBJUE1NVV9WTVNBCgpBcyBkaXNjdXNzZWQg
cHJldmlvdXNseSwgSSB0aGluayB0aGUgSVBNTVUgZHJpdmVyIHNob3VsZCBiZSBtZXJnZWQgYXMg
CnRlY2ggcHJldmlldyBmb3IgYSBjb3VwbGUgb2YgcmVsZWFzZSB0byBhbGxvdyBtb3JlIHVzZXJz
IHRvIHRlc3QgYmVmb3JlIAp3ZSBtYXJrIGl0IGFzIHN1cHBvcnRlZC4KCkJhc2VkIG9uIHRoaXMs
IEkgd291bGQgbm90IGFkdmlzZSB0byBzZWxlY3QgSVBNTVVfVk1TQSBieSBkZWZhdWx0IGFzIAp1
c2VyIG1heSBub3Qgd2FudCB0byB1c2UgdGVjaCBwcmV2aWV3IGNvZGUgYnkgZGVmYXVsdC4gSW5z
dGVhZCBJIHdvdWxkIApvbmx5IHNlbGVjdCBpZiBFWFBFUlQgaXMgc2V0LgoKPiAgIAktLS1oZWxw
LS0tCj4gICAJRW5hYmxlIGFsbCB0aGUgcmVxdWlyZWQgZHJpdmVycyBmb3IgUmVuZXNhcyBSQ2Fy
Mwo+ICAgCj4gZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL0tjb25maWcgYi94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9LY29uZmlnCj4gaW5kZXggYTNjMDY0OS4uNDdlYWRiNCAx
MDA2NDQKPiAtLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9LY29uZmlnCj4gKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvS2NvbmZpZwo+IEBAIC0xMiw0ICsxMiwxNyBAQCBjb25maWcg
QVJNX1NNTVUKPiAgIAo+ICAgCSAgU2F5IFkgaGVyZSBpZiB5b3VyIFNvQyBpbmNsdWRlcyBhbiBJ
T01NVSBkZXZpY2UgaW1wbGVtZW50aW5nIHRoZQo+ICAgCSAgQVJNIFNNTVUgYXJjaGl0ZWN0dXJl
Lgo+ICsKPiArY29uZmlnIElQTU1VX1ZNU0EKPiArCWJvb2wgIlJlbmVzYXMgSVBNTVUtVk1TQSBm
b3VuZCBpbiBSLUNhciBHZW4zIFNvQ3MiCj4gKwlkZWZhdWx0IG4KPiArCWRlcGVuZHMgb24gQVJN
XzY0Cj4gKwktLS1oZWxwLS0tCj4gKwkgIFN1cHBvcnQgZm9yIGltcGxlbWVudGF0aW9ucyBvZiB0
aGUgUmVuZXNhcyBJUE1NVS1WTVNBIGZvdW5kCj4gKwkgIGluIFItQ2FyIEdlbjMgU29Dcy4KPiAr
Cj4gKwkgIFNheSBZIGhlcmUgaWYgeW91IGFyZSB1c2luZyBuZXdlc3QgUi1DYXIgR2VuMyBTb0Nz
IHJldmlzaW9ucwo+ICsJICAoSDMgRVMzLjAsIE0zLVcrLCBldGMpIHdoaWNoIElQTU1VIGhhcmR3
YXJlIHN1cHBvcnRzIHN0YWdlIDIKPiArCSAgdHJhbnNsYXRpb24gdGFibGUgZm9ybWF0IGFuZCBp
cyBhYmxlIHRvIHVzZSBDUFUncyBQMk0gdGFibGUgYXMgaXMuCj4gKwo+ICAgZW5kaWYKClsuLi5d
Cgo+ICsgICAgLyogV2FpdCB1bnRpbCB0aGUgUm9vdCBkZXZpY2UgaGFzIGJlZW4gcmVnaXN0ZXJl
ZCBmb3Igc3VyZS4gKi8KPiArICAgIGlmICggIW1tdS0+cm9vdCApCj4gKyAgICB7Cj4gKyAgICAg
ICAgZGV2X2Vycigmbm9kZS0+ZGV2LCAiUm9vdCBJUE1NVSBoYXNuJ3QgYmVlbiByZWdpc3RlcmVk
IHlldFxuIik7CgpUaGlzIGlzIGEgYml0IG9kZCB0byB0aHJvdyBhbiBlcnJvciBpZiB3ZSBhcmUg
Z29pbmcgdG8gZGVmZXIgdGhlIHByb2JlLgoKPiArICAgICAgICByZXQgPSAtRUFHQUlOOwo+ICsg
ICAgICAgIGdvdG8gb3V0Owo+ICsgICAgfQoKWy4uLl0KCj4gK3N0YXRpYyBfX2luaXQgYm9vbCBp
cG1tdV9zdGFnZTJfc3VwcG9ydGVkKHZvaWQpCj4gK3sKPiArICAgIHN0cnVjdCBkdF9kZXZpY2Vf
bm9kZSAqbnA7Cj4gKyAgICB1aW50NjRfdCBhZGRyLCBzaXplOwo+ICsgICAgdm9pZCBfX2lvbWVt
ICpiYXNlOwo+ICsgICAgdWludDMyX3QgcHJvZHVjdCwgY3V0Owo+ICsgICAgc3RhdGljIGVudW0K
PiArICAgIHsKPiArICAgICAgICBVTktOT1dOLAo+ICsgICAgICAgIFNVUFBPUlRFRCwKPiArICAg
ICAgICBOT1RTVVBQT1JURUQKPiArICAgIH0gc3RhZ2UyX3N1cHBvcnRlZCA9IFVOS05PV047Cj4g
Kwo+ICsgICAgLyogVXNlIHRoZSBmbGFnIHRvIGF2b2lkIGNoZWNraW5nIGZvciB0aGUgY29tcGF0
aWJpbGl0eSBtb3JlIHRoZW4gb25jZS4gKi8KClRoZXJlIGFyZSBvbmx5IG9uZSBJT01NVSByb290
IHRoYXQgd2lsbCBhbHdheXMgYmUgaW5pdGlhbGl6ZWQgZmlyc3QuIFNvIApjYW4ndCB5b3UgbW92
ZSB0aGlzIGNvZGUgaW4gdGhlIHJvb3QgSU9NTVUgcGF0aD8KCj4gKyAgICBzd2l0Y2ggKCBzdGFn
ZTJfc3VwcG9ydGVkICkKPiArICAgIHsKPiArICAgIGNhc2UgU1VQUE9SVEVEOgo+ICsgICAgICAg
IHJldHVybiB0cnVlOwo+ICsKPiArICAgIGNhc2UgTk9UU1VQUE9SVEVEOgo+ICsgICAgICAgIHJl
dHVybiBmYWxzZTsKPiArCj4gKyAgICBjYXNlIFVOS05PV046Cj4gKyAgICBkZWZhdWx0Ogo+ICsg
ICAgICAgIHN0YWdlMl9zdXBwb3J0ZWQgPSBOT1RTVVBQT1JURUQ7Cj4gKyAgICAgICAgYnJlYWs7
Cj4gKyAgICB9Cj4gKwo+ICsgICAgbnAgPSBkdF9maW5kX2NvbXBhdGlibGVfbm9kZShOVUxMLCBO
VUxMLCAicmVuZXNhcyxwcnIiKTsKPiArICAgIGlmICggIW5wICkKPiArICAgIHsKPiArICAgICAg
ICBwcmludGsoWEVOTE9HX0VSUiAiaXBtbXU6IEZhaWxlZCB0byBmaW5kIFBSUiBub2RlXG4iKTsK
PiArICAgICAgICByZXR1cm4gZmFsc2U7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYgKCBkdF9kZXZp
Y2VfZ2V0X2FkZHJlc3MobnAsIDAsICZhZGRyLCAmc2l6ZSkgKQo+ICsgICAgewo+ICsgICAgICAg
IHByaW50ayhYRU5MT0dfRVJSICJpcG1tdTogRmFpbGVkIHRvIGdldCBQUlIgTU1JT1xuIik7Cj4g
KyAgICAgICAgcmV0dXJuIGZhbHNlOwo+ICsgICAgfQo+ICsKPiArICAgIGJhc2UgPSBpb3JlbWFw
X25vY2FjaGUoYWRkciwgc2l6ZSk7Cj4gKyAgICBpZiAoICFiYXNlICkKPiArICAgIHsKPiArICAg
ICAgICBwcmludGsoWEVOTE9HX0VSUiAiaXBtbXU6IEZhaWxlZCB0byBpb3JlbWFwIFBSUiBNTUlP
XG4iKTsKPiArICAgICAgICByZXR1cm4gZmFsc2U7Cj4gKyAgICB9Cj4gKwo+ICsgICAgcHJvZHVj
dCA9IHJlYWRsKGJhc2UpOwo+ICsgICAgY3V0ID0gcHJvZHVjdCAmIFJDQVJfQ1VUX01BU0s7Cj4g
KyAgICBwcm9kdWN0ICY9IFJDQVJfUFJPRFVDVF9NQVNLOwo+ICsKPiArICAgIHN3aXRjaCAoIHBy
b2R1Y3QgKQo+ICsgICAgewo+ICsgICAgY2FzZSBSQ0FSX1BST0RVQ1RfSDM6Cj4gKyAgICBjYXNl
IFJDQVJfUFJPRFVDVF9NM1c6Cj4gKyAgICAgICAgaWYgKCBjdXQgPj0gUkNBUl9DVVRfVkVSMzAg
KQo+ICsgICAgICAgICAgICBzdGFnZTJfc3VwcG9ydGVkID0gU1VQUE9SVEVEOwo+ICsgICAgICAg
IGJyZWFrOwo+ICsKPiArICAgIGNhc2UgUkNBUl9QUk9EVUNUX00zTjoKPiArICAgICAgICBzdGFn
ZTJfc3VwcG9ydGVkID0gU1VQUE9SVEVEOwo+ICsgICAgICAgIGJyZWFrOwo+ICsKPiArICAgIGRl
ZmF1bHQ6Cj4gKyAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgImlwbW11OiBVbnN1cHBvcnRlZCBT
b0MgdmVyc2lvblxuIik7Cj4gKyAgICAgICAgYnJlYWs7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaW91
bm1hcChiYXNlKTsKPiArCj4gKyAgICByZXR1cm4gc3RhZ2UyX3N1cHBvcnRlZCA9PSBTVVBQT1JU
RUQ7Cj4gK30KPiArCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHRfZGV2aWNlX21hdGNoIGlwbW11
X2R0X21hdGNoW10gX19pbml0Y29uc3QgPQo+ICt7Cj4gKyAgICBEVF9NQVRDSF9DT01QQVRJQkxF
KCJyZW5lc2FzLGlwbW11LXI4YTc3OTUiKSwKPiArICAgIERUX01BVENIX0NPTVBBVElCTEUoInJl
bmVzYXMsaXBtbXUtcjhhNzc5NjUiKSwKPiArICAgIERUX01BVENIX0NPTVBBVElCTEUoInJlbmVz
YXMsaXBtbXUtcjhhNzc5NiIpLAo+ICsgICAgeyAvKiBzZW50aW5lbCAqLyB9LAo+ICt9Owo+ICsK
PiArc3RhdGljIF9faW5pdCBpbnQgaXBtbXVfaW5pdChzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKm5v
ZGUsIGNvbnN0IHZvaWQgKmRhdGEpCj4gK3sKPiArICAgIGludCByZXQ7Cj4gKwo+ICsgICAgLyoK
PiArICAgICAqIEV2ZW4gaWYgdGhlIGRldmljZSBjYW4ndCBiZSBpbml0aWFsaXplZCwgd2UgZG9u
J3Qgd2FudCB0byBnaXZlCj4gKyAgICAgKiB0aGUgSVBNTVUgZGV2aWNlIHRvIGRvbTAuCj4gKyAg
ICAgKi8KPiArICAgIGR0X2RldmljZV9zZXRfdXNlZF9ieShub2RlLCBET01JRF9YRU4pOwo+ICsK
PiArICAgIGlmICggIWlvbW11X2hhcF9wdF9zaGFyZSApCgppb21tdV9oYXBfcHRfc2hhcmUgd2ls
bCBzb29uIGJlIGhhcmRjb2RlZCB0byB0cnVlIG9uIEFybSAoc2VlIFsxXSkuIEV2ZW4gCndpdGhv
dXQgdGhlIHBhdGNoLCB0aGUgdmFsdWUgb2YgaW9tbXVfaGFwX3B0X3NoYXJlIHNob3VsZCBiZSBp
Z25vcmVkIGFzIApkb25lIGJ5IHRoZSBTTU1VLgoKPiArICAgIHsKPiArICAgICAgICBwcmludGtf
b25jZShYRU5MT0dfRVJSICJpcG1tdTogUDJNIHRhYmxlIG11c3QgYWx3YXlzIGJlIHNoYXJlZCBi
ZXR3ZWVuIHRoZSBDUFUgYW5kIHRoZSBJUE1NVVxuIik7Cj4gKyAgICAgICAgcmV0dXJuIC1FSU5W
QUw7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYgKCAhaXBtbXVfc3RhZ2UyX3N1cHBvcnRlZCgpICkK
PiArICAgIHsKPiArICAgICAgICBwcmludGtfb25jZShYRU5MT0dfRVJSICJpcG1tdTogUDJNIHNo
YXJpbmcgaXMgbm90IHN1cHBvcnRlZCBpbiBjdXJyZW50IFNvQyByZXZpc2lvblxuIik7Cj4gKyAg
ICAgICAgcmV0dXJuIC1FTk9ERVY7CgpUaGUgaWYgcGFydCBpcyByZXR1cm5pbmcgc28uLi4KCj4g
KyAgICB9Cj4gKyAgICBlbHNlCgouLi4gdGhlIGVsc2UgcGFydCBpcyBub3QgbmVjZXNzYXJ5IHJl
bW92aW5nIG9uZSBsYXllciBvZiBpbmRlbnRhdGlvbi4KCj4gKyAgICB7Cj4gKyAgICAgICAgLyoK
PiArICAgICAgICAgKiBBcyA0LWxldmVsIHRyYW5zbGF0aW9uIHRhYmxlIGlzIG5vdCBzdXBwb3J0
ZWQgaW4gSVBNTVUsIHdlIG5lZWQKPiArICAgICAgICAgKiB0byBjaGVjayBJUEEgc2l6ZSB1c2Vk
IGZvciBQMk0gdGFibGUgYmVmb3JlaGFuZCB0byBiZSBzdXJlIGl0IGlzCj4gKyAgICAgICAgICog
My1sZXZlbCBhbmQgdGhlIElQTU1VIHdpbGwgYmUgYWJsZSB0byB1c2UgaXQuCj4gKyAgICAgICAg
ICoKPiArICAgICAgICAgKiBUT0RPOiBGaXJzdCBpbml0aWFsaXplIHRoZSBJT01NVSBhbmQgZ2F0
aGVyIHRoZSByZXF1aXJlbWVudHMgYW5kCj4gKyAgICAgICAgICogdGhlbiBpbml0aWFsaXplIHRo
ZSBQMk0uIEluIHRoZSBQMk0gY29kZSwgdGFrZSBpbnRvIHRoZSBhY2NvdW50Cj4gKyAgICAgICAg
ICogdGhlIElPTU1VIHJlcXVpcmVtZW50cyBhbmQgcmVzdHJpY3QgInBhX3JhbmdlIiBpZiBuZWNl
c3NhcnkuCj4gKyAgICAgICAgICovCj4gKyAgICAgICAgaWYgKCBJUE1NVV9NQVhfUDJNX0lQQV9C
SVRTIDwgcDJtX2lwYV9iaXRzICkKPiArICAgICAgICB7Cj4gKyAgICAgICAgICAgIHByaW50a19v
bmNlKFhFTkxPR19FUlIgImlwbW11OiBQMk0gSVBBIHNpemUgaXMgbm90IHN1cHBvcnRlZCAoUDJN
PSV1IElQTU1VPSV1KSFcbiIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHAybV9pcGFfYml0
cywgSVBNTVVfTUFYX1AyTV9JUEFfQklUUyk7Cj4gKyAgICAgICAgICAgIHJldHVybiAtRU5PREVW
Owo+ICsgICAgICAgIH0KPiArICAgIH0KPiArCj4gKyAgICByZXQgPSBpcG1tdV9wcm9iZShub2Rl
KTsKPiArICAgIGlmICggcmV0ICkKPiArICAgIHsKPiArICAgICAgICBkZXZfZXJyKCZub2RlLT5k
ZXYsICJGYWlsZWQgdG8gaW5pdCBJUE1NVSAoJWQpXG4iLCByZXQpOwo+ICsgICAgICAgIHJldHVy
biByZXQ7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaW9tbXVfc2V0X29wcygmaXBtbXVfaW9tbXVfb3Bz
KTsKPiArCj4gKyAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArRFRfREVWSUNFX1NUQVJUKGlwbW11
LCAiUmVuZXNhcyBJUE1NVS1WTVNBIiwgREVWSUNFX0lPTU1VKQo+ICsgICAgLmR0X21hdGNoID0g
aXBtbXVfZHRfbWF0Y2gsCj4gKyAgICAuaW5pdCA9IGlwbW11X2luaXQsCj4gK0RUX0RFVklDRV9F
TkQKPiArCj4gKy8qCj4gKyAqIExvY2FsIHZhcmlhYmxlczoKPiArICogbW9kZTogQwo+ICsgKiBj
LWZpbGUtc3R5bGU6ICJCU0QiCj4gKyAqIGMtYmFzaWMtb2Zmc2V0OiA0Cj4gKyAqIGluZGVudC10
YWJzLW1vZGU6IG5pbAo+ICsgKiBFbmQ6Cj4gKyAqLwo+IAoKWzFdIDwyMDE5MDkwMjE0NTAxNC4z
NjQ0Mi02LXBhdWwuZHVycmFudEBjaXRyaXguY29tPgoKLS0gCkp1bGllbiBHcmFsbAoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxp
bmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5w
cm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

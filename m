Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 262C245A249
	for <lists+xen-devel@lfdr.de>; Tue, 23 Nov 2021 13:12:59 +0100 (CET)
Received: from list by lists.xenproject.org with outflank-mailman.229241.396724 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1mpUev-0000Il-Hy; Tue, 23 Nov 2021 12:12:25 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 229241.396724; Tue, 23 Nov 2021 12:12:25 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1mpUev-0000GT-DJ; Tue, 23 Nov 2021 12:12:25 +0000
Received: by outflank-mailman (input) for mailman id 229241;
 Tue, 23 Nov 2021 12:12:24 +0000
Received: from se1-gles-flk1-in.inumbo.com ([94.247.172.50]
 helo=se1-gles-flk1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=ayLh=QK=xenbits.xen.org=iwj@srs-se1.protection.inumbo.net>)
 id 1mpUer-0008MT-S2
 for xen-devel@lists.xen.org; Tue, 23 Nov 2021 12:12:24 +0000
Received: from mail.xenproject.org (mail.xenproject.org [104.130.215.37])
 by se1-gles-flk1.inumbo.com (Halon) with ESMTPS
 id 7c4b1d2c-4c56-11ec-a9d2-d9f7a1cc8784;
 Tue, 23 Nov 2021 13:12:00 +0100 (CET)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1mpUdm-0002TE-5M; Tue, 23 Nov 2021 12:11:14 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1mpUdm-0004Vs-4E; Tue, 23 Nov 2021 12:11:14 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: 7c4b1d2c-4c56-11ec-a9d2-d9f7a1cc8784
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=ztQrKzqJ+vewZDjPFkCb6Oy2jFYOOtZTzWA6OEgCWAw=; b=nIwu2YM4Vv4enxnzMjeAHryfrY
	Y9btjHpK1/+5UB+KO5q2hdEiIkyTsugO1APOdtxXbgMWCGwfUDUYeJpI7kQqvSYkXs66EBwfagb09
	kBiS64FzBjX2pp1EXjZQ7x8iOWrNuK9LsRpZ0Yh+vX9XU/79HsBafFSRPDiNSwzh2g9c=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 389 v3 (CVE-2021-28705,CVE-2021-28709) -
 issues with partially successful P2M updates on x86
Message-Id: <E1mpUdm-0004Vs-4E@xenbits.xenproject.org>
Date: Tue, 23 Nov 2021 12:11:14 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

     Xen Security Advisory CVE-2021-28705,CVE-2021-28709 / XSA-389
                               version 3

          issues with partially successful P2M updates on x86

UPDATES IN VERSION 3
====================

Add CVE numbers to patches.

Public release.

ISSUE DESCRIPTION
=================

x86 HVM and PVH guests may be started in populate-on-demand (PoD) mode,
to provide a way for them to later easily have more memory assigned.

Guests are permitted to control certain P2M aspects of individual
pages via hypercalls.  These hypercalls may act on ranges of pages
specified via page orders (resulting in a power-of-2 number of pages).
In some cases the hypervisor carries out the requests by splitting
them into smaller chunks.  Error handling in certain PoD cases has
been insufficient in that in particular partial success of some
operations was not properly accounted for.

There are two code paths affected - page removal (CVE-2021-28705) and
insertion of new pages (CVE-2021-28709).  (We provide one patch which
combines the fix to both issues.)

IMPACT
======

Malicious or buggy guest kernels may be able to mount a Denial of
Service (DoS) attack affecting the entire system.  Privilege escalation
and information leaks cannot be ruled out.

VULNERABLE SYSTEMS
==================

All Xen versions from 3.4 onwards are affected.  Xen versions 3.3 and
older are believed to not be affected.

Only x86 HVM and PVH guests started in populate-on-demand mode are
believed to be able to leverage the vulnerability.  Populate-on-demand
mode is activated when the guest's xl configuration file specifies a
"maxmem" value which is larger than the "memory" value.

MITIGATION
==========

Not starting x86 HVM or PVH guests in populate-on-demand mode is
believed to allow avoiding the vulnerability.

CREDITS
=======

This issue was discovered by Jan Beulich of SUSE.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa389.patch           xen-unstable
xsa389-4.15.patch      Xen 4.15.x
xsa389-4.14.patch      Xen 4.14.x
xsa389-4.13.patch      Xen 4.13.x
xsa389-4.12.patch      Xen 4.12.x

$ sha256sum xsa389*
c00f5b07594a6459bdd6f7334acc373bc3b0c14a5b0e444ec624ac60f857fc6f  xsa389.patch
bf0d66623c3239e334a17332035be5d7c7e33cfdd7f04f9b385f70ce8fa92752  xsa389-4.12.patch
2737affcf1e0fae5d412067ea8c7fe1cc91a28fa22f3f7e97a502cbd032582cc  xsa389-4.13.patch
b243284679b32ab8c817a2e41562d8694d9781fa8096c268bb41b0cd91684baa  xsa389-4.14.patch
0a213e141089fe7808eae067b3c43beed6c7d5887fa4c901e8f9352618788e5a  xsa389-4.15.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches described above (or others which are
substantially similar) is permitted during the embargo, even on public-
facing systems with untrusted guest users and administrators.

HOWEVER, deployment of the mitigation described above is NOT permitted
during the embargo on public-facing systems with untrusted guest users
and administrators.  This is because such a configuration change is
recognizable by the affected guests.

AND: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmGc2jkMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZkOAIAInsof4UP5VTDcLtiwCvGskCXZT0SwbJ5OKbmxG7
RmPJg+R5sy89aHyJ4BP4eRfgrfbG35qBSCB5zLHy2FR3oioRmDz3y4KAFP3hXJRc
B0hSNM9Al9nEfdt0YQeVxt297X0Ouz/bihLoHXKOTZ2AqKcafu9GRIdK0Kcj1v49
azcW1ndfAkIEYDGvtcdZDXYT3CyjLusQme3pweohZGwcQW6UYg7DhRKl0KPQZP/L
paQZd60walNWgDcV7qfMnWit2jYxF4AptLW8c+KFig7qorLE5z9Xj7AIJ6kGriry
fnwy/DE2xRr4IxWk/FsJgDxeAS6mv3KQ2Mpgx2bRAD0jB6I=
=3P7k
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa389.patch"
Content-Disposition: attachment; filename="xsa389.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUDJNOiBkZWFsIHdpdGggcGFydGlhbCBzdWNjZXNzIG9mIHAybV9z
ZXRfZW50cnkoKQoKTTJQIGFuZCBQb0Qgc3RhdHMgbmVlZCB0byByZW1haW4g
aW4gc3luYyB3aXRoIFAyTTsgaWYgYW4gdXBkYXRlIHN1Y2NlZWRzCm9ubHkg
cGFydGlhbGx5LCByZXNwZWN0aXZlIGFkanVzdG1lbnRzIG5lZWQgdG8gYmUg
bWFkZS4gSWYgdXBkYXRlcyBnZXQKbWFkZSBiZWZvcmUgdGhlIGNhbGwsIHRo
ZXkgbWF5IGFsc28gbmVlZCB1bmRvaW5nIHVwb24gY29tcGxldGUgZmFpbHVy
ZQooaS5lLiBpbmNsdWRpbmcgdGhlIHNpbmdsZS1wYWdlIGNhc2UpLgoKTG9n
LWRpcnR5IHN0YXRlIHdvdWxkIGJldHRlciBhbHNvIGJlIGtlcHQgaW4gc3lu
Yy4KCk5vdGUgdGhhdCB0aGUgY2hhbmdlIHRvIHNldF90eXBlZF9wMm1fZW50
cnkoKSBtYXkgbm90IGJlIHN0cmljdGx5Cm5lY2Vzc2FyeSAoZHVlIHRvIHRo
ZSBvcmRlciByZXN0cmljdGlvbiBlbmZvcmNlZCBuZWFyIHRoZSB0b3Agb2Yg
dGhlCmZ1bmN0aW9uKSwgYnV0IGlzIGJlaW5nIGtlcHQgaGVyZSB0byBiZSBv
biB0aGUgc2FmZSBzaWRlLgoKVGhpcyBpcyBDVkUtMjAyMS0yODcwNSBhbmQg
Q1ZFLTIwMjEtMjg3MDkgLyBYU0EtMzg5LgoKU2lnbmVkLW9mZi1ieTogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUm9n
ZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+Ci0tLQpJIHRo
aW5rIHRoZSBNMlAgYXNwZWN0ICh3cnQgd3JvbmdseSBhbGxvd2luZyBtdWx0
aXBsZSBHRk4gbWFwcGluZ3Mgb2YgYQpwYWdlIHRoYXQgbWF5IGxhdGVyIGdl
dCBmcmVlZCwgaS5lLiBwcmltYXJpbHkgdGhlIGdyYW50IHRhYmxlIHYyIHN0
YXR1cwpwYWdlcykgaXMgb25seSB0aGVvcmV0aWNhbCBhdCB0aGlzIHBvaW50
LiBUaGF0J3MgYmVjYXVzZSBhbnkgc3VjaApzcGVjaWFsIG1hcHBpbmdzIHdv
dWxkIG9ubHkgZXZlciBiZSA0ayBvbmVzLCBhbmQgcmVwbGFjaW5nIGV4aXN0
aW5nCnNtYWxsIG1hcHBpbmdzIGNhbid0IGZhaWwgd2l0aCAtRU5PTUVNIGZy
b20gaW50ZXJtZWRpYXRlIHBhZ2UgdGFibGUKYWxsb2NhdGlvbi4gQW5kIEkg
dGhpbmsgYWxsIG90aGVyIGVycm9yIHJldHVybnMgd291bGQsIGlmIGluIGZh
Y3QKcmVhY2hhYmxlLCByZXByZXNlbnQgKHByZXN1bWFibHkgc2VjdXJpdHkg
cmVsZXZhbnQpIGJ1Z3MgdGhlbXNlbHZlcywgc28KYWRkcmVzc2luZyB0aGlz
IHBhcnQgbWF5IGJlIG1lcmVseSBkZWZlbnNlLWluLWRlcHRoLgotLS0KdjQ6
IFJlLWJhc2UgYWhlYWQgb2YgIng4Ni9tbTogdXBkYXRlIGxvZy1kaXJ0eSBi
aXRtYXAgd2hlbiBtYW5pcHVsYXRpbmcKICAgIFAyTSIuCnYzOiBSZW1vdmUg
Ym9ndXMgc3BlY2lhbCBjYXNpbmcgb2Ygb3JkZXItMCBmcm9tIHAybV9yZW1v
dmVfcGFnZSgpIGFuZAogICAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoKS4g
QWRqdXN0IGRlc2NyaXB0aW9uIGFjY29yZGluZ2x5Lgp2MjogQ29ycmVjdCB1
bmRvIGNvbmRpdGlvbmFsIGluIHAybV9yZW1vdmVfcGFnZSgpLgoKLS0tIGEv
eGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9w
Mm0uYwpAQCAtNzk0LDYgKzc5NCw3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1
Y3QgcDJtX2RvbWFpbiAqcDJtLAogICAgIHVuc2lnbmVkIGxvbmcgaTsKICAg
ICBwMm1fdHlwZV90IHQ7CiAgICAgcDJtX2FjY2Vzc190IGE7CisgICAgaW50
IHJjOwogCiAgICAgQVNTRVJUKGdmbl9sb2NrZWRfYnlfbWUocDJtLCBnZm4p
KTsKICAgICBQMk1fREVCVUcoInJlbW92aW5nIGdmbj0lI2x4IG1mbj0lI2x4
XG4iLCBnZm5feChnZm4pLCBtZm5feChtZm4pKTsKQEAgLTgyNSw4ICs4MjYs
MjcgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0s
CiAKICAgICBpb3JlcV9yZXF1ZXN0X21hcGNhY2hlX2ludmFsaWRhdGUocDJt
LT5kb21haW4pOwogCi0gICAgcmV0dXJuIHAybV9zZXRfZW50cnkocDJtLCBn
Zm4sIElOVkFMSURfTUZOLCBwYWdlX29yZGVyLCBwMm1faW52YWxpZCwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICBwMm0tPmRlZmF1bHRfYWNjZXNzKTsK
KyAgICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIElOVkFMSURfTUZO
LCBwYWdlX29yZGVyLCBwMm1faW52YWxpZCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7CisgICAgaWYgKCBsaWtlbHko
IXJjKSB8fCAhbWZuX3ZhbGlkKG1mbikgKQorICAgICAgICByZXR1cm4gcmM7
CisKKyAgICAvKgorICAgICAqIFRoZSBvcGVyYXRpb24gbWF5IGhhdmUgcGFy
dGlhbGx5IHN1Y2NlZWRlZC4gRm9yIHRoZSBmYWlsZWQgcGFydCB3ZSBuZWVk
CisgICAgICogdG8gdW5kbyB0aGUgTTJQIHVwZGF0ZSBhbmQsIG91dCBvZiBw
cmVjYXV0aW9uLCBtYXJrIHRoZSBwYWdlcyBkaXJ0eQorICAgICAqIGFnYWlu
LgorICAgICAqLworICAgIGZvciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBwYWdl
X29yZGVyKTsgKytpICkKKyAgICB7CisgICAgICAgIHAybS0+Z2V0X2VudHJ5
KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5VTEwp
OworICAgICAgICBpZiAoICFwMm1faXNfaG9sZSh0KSAmJiAhcDJtX2lzX3Nw
ZWNpYWwodCkgJiYgIXAybV9pc19zaGFyZWQodCkgKQorICAgICAgICB7Cisg
ICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm5feChtZm4pICsgaSwg
Z2ZuX3goZ2ZuKSArIGkpOworICAgICAgICAgICAgcGFnaW5nX21hcmtfcGZu
X2RpcnR5KHAybS0+ZG9tYWluLCBfcGZuKGdmbl94KGdmbikgKyBpKSk7Cisg
ICAgICAgIH0KKyAgICB9CisKKyAgICByZXR1cm4gcmM7CiB9CiAKIGludApA
QCAtMTAyMiwxMyArMTA0Miw4IEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5
KHN0cnVjdCBkb21haW4gKmQKIAogICAgIC8qIE5vdywgYWN0dWFsbHkgZG8g
dGhlIHR3by13YXkgbWFwcGluZyAqLwogICAgIHJjID0gcDJtX3NldF9lbnRy
eShwMm0sIGdmbiwgbWZuLCBwYWdlX29yZGVyLCB0LCBwMm0tPmRlZmF1bHRf
YWNjZXNzKTsKLSAgICBpZiAoIHJjID09IDAgKQorICAgIGlmICggbGlrZWx5
KCFyYykgKQogICAgIHsKLSAgICAgICAgcG9kX2xvY2socDJtKTsKLSAgICAg
ICAgcDJtLT5wb2QuZW50cnlfY291bnQgLT0gcG9kX2NvdW50OwotICAgICAg
ICBCVUdfT04ocDJtLT5wb2QuZW50cnlfY291bnQgPCAwKTsKLSAgICAgICAg
cG9kX3VubG9jayhwMm0pOwotCiAgICAgICAgIGlmICggIXAybV9pc19ncmFu
dCh0KSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBp
IDwgKDFVTCA8PCBwYWdlX29yZGVyKTsgaSsrICkKQEAgLTEwMzYsNiArMTA1
MSw0MiBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWlu
ICpkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZuX3go
Z2ZuX2FkZChnZm4sIGkpKSk7CiAgICAgICAgIH0KICAgICB9CisgICAgZWxz
ZQorICAgIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogVGhlIG9wZXJhdGlv
biBtYXkgaGF2ZSBwYXJ0aWFsbHkgc3VjY2VlZGVkLiBGb3IgdGhlIHN1Y2Nl
c3NmdWwgcGFydAorICAgICAgICAgKiB3ZSBuZWVkIHRvIHVwZGF0ZSBNMlAg
YW5kIGRpcnR5IHN0YXRlLCB3aGlsZSBmb3IgdGhlIGZhaWxlZCBwYXJ0IHdl
CisgICAgICAgICAqIG1heSBuZWVkIHRvIGFkanVzdCBQb0Qgc3RhdHMgYXMg
d2VsbCBhcyB1bmRvIHRoZSBlYXJsaWVyIE0yUCB1cGRhdGUuCisgICAgICAg
ICAqLworICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9v
cmRlcik7ICsraSApCisgICAgICAgIHsKKyAgICAgICAgICAgIG9tZm4gPSBw
Mm0tPmdldF9lbnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBpKSwgJm90LCAmYSwg
MCwgTlVMTCwgTlVMTCk7CisgICAgICAgICAgICBpZiAoIHAybV9pc19wb2Qo
b3QpICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBCVUdfT04o
IXBvZF9jb3VudCk7CisgICAgICAgICAgICAgICAgLS1wb2RfY291bnQ7Cisg
ICAgICAgICAgICB9CisgICAgICAgICAgICBlbHNlIGlmICggbWZuX2VxKG9t
Zm4sIG1mbl9hZGQobWZuLCBpKSkgJiYgb3QgPT0gdCAmJgorICAgICAgICAg
ICAgICAgICAgICAgIGEgPT0gcDJtLT5kZWZhdWx0X2FjY2VzcyAmJiAhcDJt
X2lzX2dyYW50KHQpICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAg
ICBzZXRfZ3Bmbl9mcm9tX21mbihtZm5feChvbWZuKSwgZ2ZuX3goZ2ZuKSAr
IGkpOworICAgICAgICAgICAgICAgIHBhZ2luZ19tYXJrX3Bmbl9kaXJ0eShk
LCBfcGZuKGdmbl94KGdmbikgKyBpKSk7CisgICAgICAgICAgICB9CisgICAg
ICAgICAgICBlbHNlIGlmICggcDJtX2lzX3JhbShvdCkgJiYgIXAybV9pc19w
YWdlZChvdCkgKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIEFT
U0VSVChtZm5fdmFsaWQob21mbikpOworICAgICAgICAgICAgICAgIHNldF9n
cGZuX2Zyb21fbWZuKG1mbl94KG9tZm4pLCBnZm5feChnZm4pICsgaSk7Cisg
ICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICB9CisKKyAgICBpZiAoIHBv
ZF9jb3VudCApCisgICAgeworICAgICAgICBwb2RfbG9jayhwMm0pOworICAg
ICAgICBwMm0tPnBvZC5lbnRyeV9jb3VudCAtPSBwb2RfY291bnQ7CisgICAg
ICAgIEJVR19PTihwMm0tPnBvZC5lbnRyeV9jb3VudCA8IDApOworICAgICAg
ICBwb2RfdW5sb2NrKHAybSk7CisgICAgfQogCiBvdXQ6CiAgICAgcDJtX3Vu
bG9jayhwMm0pOwpAQCAtMTMyNSw2ICsxMzc2LDQ5IEBAIHN0YXRpYyBpbnQg
c2V0X3R5cGVkX3AybV9lbnRyeShzdHJ1Y3QgZG8KICAgICAgICAgICAgIHJl
dHVybiAwOwogICAgICAgICB9CiAgICAgfQorCisgICAgUDJNX0RFQlVHKCJz
ZXQgJWQgJWx4ICVseFxuIiwgZ2ZuX3AybXQsIGdmbl9sLCBtZm5feChtZm4p
KTsKKyAgICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwgb3Jk
ZXIsIGdmbl9wMm10LCBhY2Nlc3MpOworICAgIGlmICggdW5saWtlbHkocmMp
ICkKKyAgICB7CisgICAgICAgIGdkcHJpbnRrKFhFTkxPR19FUlIsICJwMm1f
c2V0X2VudHJ5OiAlI2x4OiV1IC0+ICVkICgweCUiUFJJX21mbiIpXG4iLAor
ICAgICAgICAgICAgICAgICBnZm5fbCwgb3JkZXIsIHJjLCBtZm5feChtZm4p
KTsKKworICAgICAgICAvKgorICAgICAgICAgKiBUaGUgb3BlcmF0aW9uIG1h
eSBoYXZlIHBhcnRpYWxseSBzdWNjZWVkZWQuIEZvciB0aGUgc3VjY2Vzc2Z1
bCBwYXJ0CisgICAgICAgICAqIHdlIG5lZWQgdG8gdXBkYXRlIFBvRCBzdGF0
cywgTTJQLCBhbmQgZGlydHkgc3RhdGUuCisgICAgICAgICAqLworICAgICAg
ICBpZiAoIG9yZGVyICE9IFBBR0VfT1JERVJfNEsgKQorICAgICAgICB7Cisg
ICAgICAgICAgICB1bnNpZ25lZCBsb25nIGk7CisKKyAgICAgICAgICAgIGZv
ciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBvcmRlcik7ICsraSApCisgICAgICAg
ICAgICB7CisgICAgICAgICAgICAgICAgcDJtX3R5cGVfdCB0OworICAgICAg
ICAgICAgICAgIG1mbl90IGNtZm4gPSBwMm0tPmdldF9lbnRyeShwMm0sIGdm
bl9hZGQoZ2ZuLCBpKSwgJnQsICZhLCAwLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCBOVUxMKTsKKworICAg
ICAgICAgICAgICAgIGlmICggIW1mbl9lcShjbWZuLCBtZm5fYWRkKG1mbiwg
aSkpIHx8IHQgIT0gZ2ZuX3AybXQgfHwKKyAgICAgICAgICAgICAgICAgICAg
IGEgIT0gYWNjZXNzICkKKyAgICAgICAgICAgICAgICAgICAgY29udGludWU7
CisKKyAgICAgICAgICAgICAgICBpZiAoIHAybV9pc19yYW0ob3QpICkKKyAg
ICAgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICAgIEFTU0VSVCht
Zm5fdmFsaWQobWZuX2FkZChvbWZuLCBpKSkpOworICAgICAgICAgICAgICAg
ICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm5feChvbWZuKSArIGksIElOVkFM
SURfTTJQX0VOVFJZKTsKKworICAgICAgICAgICAgICAgICAgICBpb3JlcV9y
ZXF1ZXN0X21hcGNhY2hlX2ludmFsaWRhdGUoZCk7CisgICAgICAgICAgICAg
ICAgfQorICAgICAgICAgICAgICAgIGVsc2UgaWYgKCBwMm1faXNfcG9kKG90
KSApCisgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICBw
b2RfbG9jayhwMm0pOworICAgICAgICAgICAgICAgICAgICBCVUdfT04oIXAy
bS0+cG9kLmVudHJ5X2NvdW50KTsKKyAgICAgICAgICAgICAgICAgICAgLS1w
Mm0tPnBvZC5lbnRyeV9jb3VudDsKKyAgICAgICAgICAgICAgICAgICAgcG9k
X3VubG9jayhwMm0pOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAg
IH0KKyAgICAgICAgfQorICAgIH0KICAgICBlbHNlIGlmICggcDJtX2lzX3Jh
bShvdCkgKQogICAgIHsKICAgICAgICAgdW5zaWduZWQgbG9uZyBpOwpAQCAt
MTMzNywxMiArMTQzMSw2IEBAIHN0YXRpYyBpbnQgc2V0X3R5cGVkX3AybV9l
bnRyeShzdHJ1Y3QgZG8KIAogICAgICAgICBpb3JlcV9yZXF1ZXN0X21hcGNh
Y2hlX2ludmFsaWRhdGUoZCk7CiAgICAgfQotCi0gICAgUDJNX0RFQlVHKCJz
ZXQgJWQgJWx4ICVseFxuIiwgZ2ZuX3AybXQsIGdmbl9sLCBtZm5feChtZm4p
KTsKLSAgICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwgb3Jk
ZXIsIGdmbl9wMm10LCBhY2Nlc3MpOwotICAgIGlmICggcmMgKQotICAgICAg
ICBnZHByaW50ayhYRU5MT0dfRVJSLCAicDJtX3NldF9lbnRyeTogJSNseDol
dSAtPiAlZCAoMHglIlBSSV9tZm4iKVxuIiwKLSAgICAgICAgICAgICAgICAg
Z2ZuX2wsIG9yZGVyLCByYywgbWZuX3gobWZuKSk7CiAgICAgZWxzZSBpZiAo
IHAybV9pc19wb2Qob3QpICkKICAgICB7CiAgICAgICAgIHBvZF9sb2NrKHAy
bSk7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa389-4.12.patch"
Content-Disposition: attachment; filename="xsa389-4.12.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUDJNOiBkZWFsIHdpdGggcGFydGlhbCBzdWNjZXNzIG9mIHAybV9z
ZXRfZW50cnkoKQoKTTJQIGFuZCBQb0Qgc3RhdHMgbmVlZCB0byByZW1haW4g
aW4gc3luYyB3aXRoIFAyTTsgaWYgYW4gdXBkYXRlIHN1Y2NlZWRzCm9ubHkg
cGFydGlhbGx5LCByZXNwZWN0aXZlIGFkanVzdG1lbnRzIG5lZWQgdG8gYmUg
bWFkZS4gSWYgdXBkYXRlcyBnZXQKbWFkZSBiZWZvcmUgdGhlIGNhbGwsIHRo
ZXkgbWF5IGFsc28gbmVlZCB1bmRvaW5nIHVwb24gY29tcGxldGUgZmFpbHVy
ZQooaS5lLiBpbmNsdWRpbmcgdGhlIHNpbmdsZS1wYWdlIGNhc2UpLgoKTG9n
LWRpcnR5IHN0YXRlIHdvdWxkIGJldHRlciBhbHNvIGJlIGtlcHQgaW4gc3lu
Yy4KCk5vdGUgdGhhdCB0aGUgY2hhbmdlIHRvIHNldF90eXBlZF9wMm1fZW50
cnkoKSBtYXkgbm90IGJlIHN0cmljdGx5Cm5lY2Vzc2FyeSAoZHVlIHRvIHRo
ZSBvcmRlciByZXN0cmljdGlvbiBlbmZvcmNlZCBuZWFyIHRoZSB0b3Agb2Yg
dGhlCmZ1bmN0aW9uKSwgYnV0IGlzIGJlaW5nIGtlcHQgaGVyZSB0byBiZSBv
biB0aGUgc2FmZSBzaWRlLgoKVGhpcyBpcyBDVkUtMjAyMS0yODcwNSBhbmQg
Q1ZFLTIwMjEtMjg3MDkgLyBYU0EtMzg5LgoKU2lnbmVkLW9mZi1ieTogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUm9n
ZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+CgotLS0gYS94
ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3Ay
bS5jCkBAIC03ODAsNiArNzgwLDcgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVj
dCBwMm1fZG9tYWluICpwMm0sCiAgICAgZ2ZuX3QgZ2ZuID0gX2dmbihnZm5f
bCk7CiAgICAgcDJtX3R5cGVfdCB0OwogICAgIHAybV9hY2Nlc3NfdCBhOwor
ICAgIGludCByYzsKIAogICAgIC8qIElPTU1VIGZvciBQViBndWVzdHMgaXMg
aGFuZGxlZCBpbiBnZXRfcGFnZV90eXBlKCkgYW5kIHB1dF9wYWdlKCkuICov
CiAgICAgaWYgKCAhcGFnaW5nX21vZGVfdHJhbnNsYXRlKHAybS0+ZG9tYWlu
KSApCkBAIC04MTEsOCArODEyLDI3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1
Y3QgcDJtX2RvbWFpbiAqcDJtLAogICAgICAgICAgICAgICAgIHNldF9ncGZu
X2Zyb21fbWZuKG1mbitpLCBJTlZBTElEX00yUF9FTlRSWSk7CiAgICAgICAg
IH0KICAgICB9Ci0gICAgcmV0dXJuIHAybV9zZXRfZW50cnkocDJtLCBnZm4s
IElOVkFMSURfTUZOLCBwYWdlX29yZGVyLCBwMm1faW52YWxpZCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICBwMm0tPmRlZmF1bHRfYWNjZXNzKTsKKyAg
ICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIElOVkFMSURfTUZOLCBw
YWdlX29yZGVyLCBwMm1faW52YWxpZCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7CisgICAgaWYgKCBsaWtlbHkoIXJj
KSB8fCAhbWZuX3ZhbGlkKF9tZm4obWZuKSkgKQorICAgICAgICByZXR1cm4g
cmM7CisKKyAgICAvKgorICAgICAqIFRoZSBvcGVyYXRpb24gbWF5IGhhdmUg
cGFydGlhbGx5IHN1Y2NlZWRlZC4gRm9yIHRoZSBmYWlsZWQgcGFydCB3ZSBu
ZWVkCisgICAgICogdG8gdW5kbyB0aGUgTTJQIHVwZGF0ZSBhbmQsIG91dCBv
ZiBwcmVjYXV0aW9uLCBtYXJrIHRoZSBwYWdlcyBkaXJ0eQorICAgICAqIGFn
YWluLgorICAgICAqLworICAgIGZvciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBw
YWdlX29yZGVyKTsgKytpICkKKyAgICB7CisgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOworICAgICAgICBpZiAoICFwMm1faXNfaG9sZSh0KSAmJiAhcDJtX2lz
X3NwZWNpYWwodCkgJiYgIXAybV9pc19zaGFyZWQodCkgKQorICAgICAgICB7
CisgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm4gKyBpLCBnZm5f
bCArIGkpOworICAgICAgICAgICAgcGFnaW5nX21hcmtfcGZuX2RpcnR5KHAy
bS0+ZG9tYWluLCBfcGZuKGdmbl9sICsgaSkpOworICAgICAgICB9CisgICAg
fQorCisgICAgcmV0dXJuIHJjOwogfQogCiBpbnQKQEAgLTk4MCwxNSArMTAw
MCw4IEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4g
KmQKIAogICAgIC8qIE5vdywgYWN0dWFsbHkgZG8gdGhlIHR3by13YXkgbWFw
cGluZyAqLwogICAgIHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgbWZu
LCBwYWdlX29yZGVyLCB0LCBwMm0tPmRlZmF1bHRfYWNjZXNzKTsKLSAgICBp
ZiAoIHJjID09IDAgKQorICAgIGlmICggbGlrZWx5KCFyYykgKQogICAgIHsK
LSNpZmRlZiBDT05GSUdfSFZNCi0gICAgICAgIHBvZF9sb2NrKHAybSk7Ci0g
ICAgICAgIHAybS0+cG9kLmVudHJ5X2NvdW50IC09IHBvZF9jb3VudDsKLSAg
ICAgICAgQlVHX09OKHAybS0+cG9kLmVudHJ5X2NvdW50IDwgMCk7Ci0gICAg
ICAgIHBvZF91bmxvY2socDJtKTsKLSNlbmRpZgotCiAgICAgICAgIGlmICgg
IXAybV9pc19ncmFudCh0KSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGZv
ciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBwYWdlX29yZGVyKTsgaSsrICkKQEAg
LTk5Niw2ICsxMDA5LDQ0IEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0
cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBnZm5feChnZm5fYWRkKGdmbiwgaSkpKTsKICAgICAgICAgfQogICAg
IH0KKyAgICBlbHNlCisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBU
aGUgb3BlcmF0aW9uIG1heSBoYXZlIHBhcnRpYWxseSBzdWNjZWVkZWQuIEZv
ciB0aGUgc3VjY2Vzc2Z1bCBwYXJ0CisgICAgICAgICAqIHdlIG5lZWQgdG8g
dXBkYXRlIE0yUCBhbmQgZGlydHkgc3RhdGUsIHdoaWxlIGZvciB0aGUgZmFp
bGVkIHBhcnQgd2UKKyAgICAgICAgICogbWF5IG5lZWQgdG8gYWRqdXN0IFBv
RCBzdGF0cyBhcyB3ZWxsIGFzIHVuZG8gdGhlIGVhcmxpZXIgTTJQIHVwZGF0
ZS4KKyAgICAgICAgICovCisgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDFV
TCA8PCBwYWdlX29yZGVyKTsgKytpICkKKyAgICAgICAgeworICAgICAgICAg
ICAgb21mbiA9IHAybS0+Z2V0X2VudHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkp
LCAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKKyAgICAgICAgICAgIGlmICgg
cDJtX2lzX3BvZChvdCkgKQorICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgIEJVR19PTighcG9kX2NvdW50KTsKKyAgICAgICAgICAgICAgICAtLXBv
ZF9jb3VudDsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGVsc2UgaWYg
KCBtZm5fZXEob21mbiwgbWZuX2FkZChtZm4sIGkpKSAmJiBvdCA9PSB0ICYm
CisgICAgICAgICAgICAgICAgICAgICAgYSA9PSBwMm0tPmRlZmF1bHRfYWNj
ZXNzICYmICFwMm1faXNfZ3JhbnQodCkgKQorICAgICAgICAgICAgeworICAg
ICAgICAgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG9tZm4pLCBn
Zm5feChnZm4pICsgaSk7CisgICAgICAgICAgICAgICAgcGFnaW5nX21hcmtf
cGZuX2RpcnR5KGQsIF9wZm4oZ2ZuX3goZ2ZuKSArIGkpKTsKKyAgICAgICAg
ICAgIH0KKyAgICAgICAgICAgIGVsc2UgaWYgKCBwMm1faXNfcmFtKG90KSAm
JiAhcDJtX2lzX3BhZ2VkKG90KSApCisgICAgICAgICAgICB7CisgICAgICAg
ICAgICAgICAgQVNTRVJUKG1mbl92YWxpZChvbWZuKSk7CisgICAgICAgICAg
ICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3gob21mbiksIGdmbl94KGdm
bikgKyBpKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0KKwor
I2lmZGVmIENPTkZJR19IVk0KKyAgICBpZiAoIHBvZF9jb3VudCApCisgICAg
eworICAgICAgICBwb2RfbG9jayhwMm0pOworICAgICAgICBwMm0tPnBvZC5l
bnRyeV9jb3VudCAtPSBwb2RfY291bnQ7CisgICAgICAgIEJVR19PTihwMm0t
PnBvZC5lbnRyeV9jb3VudCA8IDApOworICAgICAgICBwb2RfdW5sb2NrKHAy
bSk7CisgICAgfQorI2VuZGlmCiAKICBvdXQ6CiAgICAgcDJtX3VubG9jayhw
Mm0pOwpAQCAtMTI3OCw2ICsxMzI5LDQ5IEBAIHN0YXRpYyBpbnQgc2V0X3R5
cGVkX3AybV9lbnRyeShzdHJ1Y3QgZG8KICAgICAgICAgZG9tYWluX2NyYXNo
KGQpOwogICAgICAgICByZXR1cm4gLUVQRVJNOwogICAgIH0KKworICAgIFAy
TV9ERUJVRygic2V0ICVkICVseCAlbHhcbiIsIGdmbl9wMm10LCBnZm5fbCwg
bWZuX3gobWZuKSk7CisgICAgcmMgPSBwMm1fc2V0X2VudHJ5KHAybSwgZ2Zu
LCBtZm4sIG9yZGVyLCBnZm5fcDJtdCwgYWNjZXNzKTsKKyAgICBpZiAoIHVu
bGlrZWx5KHJjKSApCisgICAgeworICAgICAgICBnZHByaW50ayhYRU5MT0df
RVJSLCAicDJtX3NldF9lbnRyeTogJSNseDoldSAtPiAlZCAoMHglIlBSSV9t
Zm4iKVxuIiwKKyAgICAgICAgICAgICAgICAgZ2ZuX2wsIG9yZGVyLCByYywg
bWZuX3gobWZuKSk7CisKKyAgICAgICAgLyoKKyAgICAgICAgICogVGhlIG9w
ZXJhdGlvbiBtYXkgaGF2ZSBwYXJ0aWFsbHkgc3VjY2VlZGVkLiBGb3IgdGhl
IHN1Y2Nlc3NmdWwgcGFydAorICAgICAgICAgKiB3ZSBuZWVkIHRvIHVwZGF0
ZSBQb0Qgc3RhdHMsIE0yUCwgYW5kIGRpcnR5IHN0YXRlLgorICAgICAgICAg
Ki8KKyAgICAgICAgaWYgKCBvcmRlciAhPSBQQUdFX09SREVSXzRLICkKKyAg
ICAgICAgeworICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBpOworCisgICAg
ICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgb3JkZXIpOyArK2kg
KQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHAybV90eXBlX3Qg
dDsKKyAgICAgICAgICAgICAgICBtZm5fdCBjbWZuID0gcDJtLT5nZXRfZW50
cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwgTlVM
TCk7CisKKyAgICAgICAgICAgICAgICBpZiAoICFtZm5fZXEoY21mbiwgbWZu
X2FkZChtZm4sIGkpKSB8fCB0ICE9IGdmbl9wMm10IHx8CisgICAgICAgICAg
ICAgICAgICAgICBhICE9IGFjY2VzcyApCisgICAgICAgICAgICAgICAgICAg
IGNvbnRpbnVlOworCisgICAgICAgICAgICAgICAgaWYgKCBwMm1faXNfcmFt
KG90KSApCisgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAg
ICBBU1NFUlQobWZuX3ZhbGlkKG1mbl9hZGQob21mbiwgaSkpKTsKKyAgICAg
ICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3gob21mbikg
KyBpLCBJTlZBTElEX00yUF9FTlRSWSk7CisgICAgICAgICAgICAgICAgfQor
I2lmZGVmIENPTkZJR19IVk0KKyAgICAgICAgICAgICAgICBlbHNlIGlmICgg
cDJtX2lzX3BvZChvdCkgKQorICAgICAgICAgICAgICAgIHsKKyAgICAgICAg
ICAgICAgICAgICAgcG9kX2xvY2socDJtKTsKKyAgICAgICAgICAgICAgICAg
ICAgQlVHX09OKCFwMm0tPnBvZC5lbnRyeV9jb3VudCk7CisgICAgICAgICAg
ICAgICAgICAgIC0tcDJtLT5wb2QuZW50cnlfY291bnQ7CisgICAgICAgICAg
ICAgICAgICAgIHBvZF91bmxvY2socDJtKTsKKyAgICAgICAgICAgICAgICB9
CisjZW5kaWYKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0KICAg
ICBlbHNlIGlmICggcDJtX2lzX3JhbShvdCkgKQogICAgIHsKICAgICAgICAg
dW5zaWduZWQgbG9uZyBpOwpAQCAtMTI4OCwxMiArMTM4Miw2IEBAIHN0YXRp
YyBpbnQgc2V0X3R5cGVkX3AybV9lbnRyeShzdHJ1Y3QgZG8KICAgICAgICAg
ICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG9tZm4pICsgaSwgSU5WQUxJ
RF9NMlBfRU5UUlkpOwogICAgICAgICB9CiAgICAgfQotCi0gICAgUDJNX0RF
QlVHKCJzZXQgJWQgJWx4ICVseFxuIiwgZ2ZuX3AybXQsIGdmbl9sLCBtZm5f
eChtZm4pKTsKLSAgICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1m
biwgb3JkZXIsIGdmbl9wMm10LCBhY2Nlc3MpOwotICAgIGlmICggcmMgKQot
ICAgICAgICBnZHByaW50ayhYRU5MT0dfRVJSLCAicDJtX3NldF9lbnRyeTog
JSNseDoldSAtPiAlZCAoMHglIlBSSV9tZm4iKVxuIiwKLSAgICAgICAgICAg
ICAgICAgZ2ZuX2wsIG9yZGVyLCByYywgbWZuX3gobWZuKSk7CiAjaWZkZWYg
Q09ORklHX0hWTQogICAgIGVsc2UgaWYgKCBwMm1faXNfcG9kKG90KSApCiAg
ICAgewo=

--=separator
Content-Type: application/octet-stream; name="xsa389-4.13.patch"
Content-Disposition: attachment; filename="xsa389-4.13.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUDJNOiBkZWFsIHdpdGggcGFydGlhbCBzdWNjZXNzIG9mIHAybV9z
ZXRfZW50cnkoKQoKTTJQIGFuZCBQb0Qgc3RhdHMgbmVlZCB0byByZW1haW4g
aW4gc3luYyB3aXRoIFAyTTsgaWYgYW4gdXBkYXRlIHN1Y2NlZWRzCm9ubHkg
cGFydGlhbGx5LCByZXNwZWN0aXZlIGFkanVzdG1lbnRzIG5lZWQgdG8gYmUg
bWFkZS4gSWYgdXBkYXRlcyBnZXQKbWFkZSBiZWZvcmUgdGhlIGNhbGwsIHRo
ZXkgbWF5IGFsc28gbmVlZCB1bmRvaW5nIHVwb24gY29tcGxldGUgZmFpbHVy
ZQooaS5lLiBpbmNsdWRpbmcgdGhlIHNpbmdsZS1wYWdlIGNhc2UpLgoKTG9n
LWRpcnR5IHN0YXRlIHdvdWxkIGJldHRlciBhbHNvIGJlIGtlcHQgaW4gc3lu
Yy4KCk5vdGUgdGhhdCB0aGUgY2hhbmdlIHRvIHNldF90eXBlZF9wMm1fZW50
cnkoKSBtYXkgbm90IGJlIHN0cmljdGx5Cm5lY2Vzc2FyeSAoZHVlIHRvIHRo
ZSBvcmRlciByZXN0cmljdGlvbiBlbmZvcmNlZCBuZWFyIHRoZSB0b3Agb2Yg
dGhlCmZ1bmN0aW9uKSwgYnV0IGlzIGJlaW5nIGtlcHQgaGVyZSB0byBiZSBv
biB0aGUgc2FmZSBzaWRlLgoKVGhpcyBpcyBDVkUtMjAyMS0yODcwNSBhbmQg
Q1ZFLTIwMjEtMjg3MDkgLyBYU0EtMzg5LgoKU2lnbmVkLW9mZi1ieTogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUm9n
ZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+CgotLS0gYS94
ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3Ay
bS5jCkBAIC03ODEsNiArNzgxLDcgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVj
dCBwMm1fZG9tYWluICpwMm0sCiAgICAgZ2ZuX3QgZ2ZuID0gX2dmbihnZm5f
bCk7CiAgICAgcDJtX3R5cGVfdCB0OwogICAgIHAybV9hY2Nlc3NfdCBhOwor
ICAgIGludCByYzsKIAogICAgIC8qIElPTU1VIGZvciBQViBndWVzdHMgaXMg
aGFuZGxlZCBpbiBnZXRfcGFnZV90eXBlKCkgYW5kIHB1dF9wYWdlKCkuICov
CiAgICAgaWYgKCAhcGFnaW5nX21vZGVfdHJhbnNsYXRlKHAybS0+ZG9tYWlu
KSApCkBAIC04MTIsOCArODEzLDI3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1
Y3QgcDJtX2RvbWFpbiAqcDJtLAogICAgICAgICAgICAgICAgIHNldF9ncGZu
X2Zyb21fbWZuKG1mbitpLCBJTlZBTElEX00yUF9FTlRSWSk7CiAgICAgICAg
IH0KICAgICB9Ci0gICAgcmV0dXJuIHAybV9zZXRfZW50cnkocDJtLCBnZm4s
IElOVkFMSURfTUZOLCBwYWdlX29yZGVyLCBwMm1faW52YWxpZCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICBwMm0tPmRlZmF1bHRfYWNjZXNzKTsKKyAg
ICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIElOVkFMSURfTUZOLCBw
YWdlX29yZGVyLCBwMm1faW52YWxpZCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7CisgICAgaWYgKCBsaWtlbHkoIXJj
KSB8fCAhbWZuX3ZhbGlkKF9tZm4obWZuKSkgKQorICAgICAgICByZXR1cm4g
cmM7CisKKyAgICAvKgorICAgICAqIFRoZSBvcGVyYXRpb24gbWF5IGhhdmUg
cGFydGlhbGx5IHN1Y2NlZWRlZC4gRm9yIHRoZSBmYWlsZWQgcGFydCB3ZSBu
ZWVkCisgICAgICogdG8gdW5kbyB0aGUgTTJQIHVwZGF0ZSBhbmQsIG91dCBv
ZiBwcmVjYXV0aW9uLCBtYXJrIHRoZSBwYWdlcyBkaXJ0eQorICAgICAqIGFn
YWluLgorICAgICAqLworICAgIGZvciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBw
YWdlX29yZGVyKTsgKytpICkKKyAgICB7CisgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOworICAgICAgICBpZiAoICFwMm1faXNfaG9sZSh0KSAmJiAhcDJtX2lz
X3NwZWNpYWwodCkgJiYgIXAybV9pc19zaGFyZWQodCkgKQorICAgICAgICB7
CisgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm4gKyBpLCBnZm5f
bCArIGkpOworICAgICAgICAgICAgcGFnaW5nX21hcmtfcGZuX2RpcnR5KHAy
bS0+ZG9tYWluLCBfcGZuKGdmbl9sICsgaSkpOworICAgICAgICB9CisgICAg
fQorCisgICAgcmV0dXJuIHJjOwogfQogCiBpbnQKQEAgLTEwMDIsMTMgKzEw
MjIsOCBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWlu
ICpkCiAKICAgICAvKiBOb3csIGFjdHVhbGx5IGRvIHRoZSB0d28td2F5IG1h
cHBpbmcgKi8KICAgICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1m
biwgcGFnZV9vcmRlciwgdCwgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7Ci0gICAg
aWYgKCByYyA9PSAwICkKKyAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICB7
Ci0gICAgICAgIHBvZF9sb2NrKHAybSk7Ci0gICAgICAgIHAybS0+cG9kLmVu
dHJ5X2NvdW50IC09IHBvZF9jb3VudDsKLSAgICAgICAgQlVHX09OKHAybS0+
cG9kLmVudHJ5X2NvdW50IDwgMCk7Ci0gICAgICAgIHBvZF91bmxvY2socDJt
KTsKLQogICAgICAgICBpZiAoICFwMm1faXNfZ3JhbnQodCkgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFn
ZV9vcmRlcik7IGkrKyApCkBAIC0xMDE2LDYgKzEwMzEsNDIgQEAgZ3Vlc3Rf
cGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAqZAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGdmbl94KGdmbl9hZGQoZ2ZuLCBp
KSkpOwogICAgICAgICB9CiAgICAgfQorICAgIGVsc2UKKyAgICB7CisgICAg
ICAgIC8qCisgICAgICAgICAqIFRoZSBvcGVyYXRpb24gbWF5IGhhdmUgcGFy
dGlhbGx5IHN1Y2NlZWRlZC4gRm9yIHRoZSBzdWNjZXNzZnVsIHBhcnQKKyAg
ICAgICAgICogd2UgbmVlZCB0byB1cGRhdGUgTTJQIGFuZCBkaXJ0eSBzdGF0
ZSwgd2hpbGUgZm9yIHRoZSBmYWlsZWQgcGFydCB3ZQorICAgICAgICAgKiBt
YXkgbmVlZCB0byBhZGp1c3QgUG9EIHN0YXRzIGFzIHdlbGwgYXMgdW5kbyB0
aGUgZWFybGllciBNMlAgdXBkYXRlLgorICAgICAgICAgKi8KKyAgICAgICAg
Zm9yICggaSA9IDA7IGkgPCAoMVVMIDw8IHBhZ2Vfb3JkZXIpOyArK2kgKQor
ICAgICAgICB7CisgICAgICAgICAgICBvbWZuID0gcDJtLT5nZXRfZW50cnko
cDJtLCBnZm5fYWRkKGdmbiwgaSksICZvdCwgJmEsIDAsIE5VTEwsIE5VTEwp
OworICAgICAgICAgICAgaWYgKCBwMm1faXNfcG9kKG90KSApCisgICAgICAg
ICAgICB7CisgICAgICAgICAgICAgICAgQlVHX09OKCFwb2RfY291bnQpOwor
ICAgICAgICAgICAgICAgIC0tcG9kX2NvdW50OworICAgICAgICAgICAgfQor
ICAgICAgICAgICAgZWxzZSBpZiAoIG1mbl9lcShvbWZuLCBtZm5fYWRkKG1m
biwgaSkpICYmIG90ID09IHQgJiYKKyAgICAgICAgICAgICAgICAgICAgICBh
ID09IHAybS0+ZGVmYXVsdF9hY2Nlc3MgJiYgIXAybV9pc19ncmFudCh0KSAp
CisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJv
bV9tZm4obWZuX3gob21mbiksIGdmbl94KGdmbikgKyBpKTsKKyAgICAgICAg
ICAgICAgICBwYWdpbmdfbWFya19wZm5fZGlydHkoZCwgX3BmbihnZm5feChn
Zm4pICsgaSkpOworICAgICAgICAgICAgfQorICAgICAgICAgICAgZWxzZSBp
ZiAoIHAybV9pc19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKKyAg
ICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlk
KG9tZm4pKTsKKyAgICAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbiht
Zm5feChvbWZuKSwgZ2ZuX3goZ2ZuKSArIGkpOworICAgICAgICAgICAgfQor
ICAgICAgICB9CisgICAgfQorCisgICAgaWYgKCBwb2RfY291bnQgKQorICAg
IHsKKyAgICAgICAgcG9kX2xvY2socDJtKTsKKyAgICAgICAgcDJtLT5wb2Qu
ZW50cnlfY291bnQgLT0gcG9kX2NvdW50OworICAgICAgICBCVUdfT04ocDJt
LT5wb2QuZW50cnlfY291bnQgPCAwKTsKKyAgICAgICAgcG9kX3VubG9jayhw
Mm0pOworICAgIH0KIAogIG91dDoKICAgICBwMm1fdW5sb2NrKHAybSk7CkBA
IC0xMzA3LDYgKzEzNTgsNDkgQEAgc3RhdGljIGludCBzZXRfdHlwZWRfcDJt
X2VudHJ5KHN0cnVjdCBkbwogICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAg
ICAgIH0KICAgICB9CisKKyAgICBQMk1fREVCVUcoInNldCAlZCAlbHggJWx4
XG4iLCBnZm5fcDJtdCwgZ2ZuX2wsIG1mbl94KG1mbikpOworICAgIHJjID0g
cDJtX3NldF9lbnRyeShwMm0sIGdmbiwgbWZuLCBvcmRlciwgZ2ZuX3AybXQs
IGFjY2Vzcyk7CisgICAgaWYgKCB1bmxpa2VseShyYykgKQorICAgIHsKKyAg
ICAgICAgZ2RwcmludGsoWEVOTE9HX0VSUiwgInAybV9zZXRfZW50cnk6ICUj
bHg6JXUgLT4gJWQgKDB4JSJQUklfbWZuIilcbiIsCisgICAgICAgICAgICAg
ICAgIGdmbl9sLCBvcmRlciwgcmMsIG1mbl94KG1mbikpOworCisgICAgICAg
IC8qCisgICAgICAgICAqIFRoZSBvcGVyYXRpb24gbWF5IGhhdmUgcGFydGlh
bGx5IHN1Y2NlZWRlZC4gRm9yIHRoZSBzdWNjZXNzZnVsIHBhcnQKKyAgICAg
ICAgICogd2UgbmVlZCB0byB1cGRhdGUgUG9EIHN0YXRzLCBNMlAsIGFuZCBk
aXJ0eSBzdGF0ZS4KKyAgICAgICAgICovCisgICAgICAgIGlmICggb3JkZXIg
IT0gUEFHRV9PUkRFUl80SyApCisgICAgICAgIHsKKyAgICAgICAgICAgIHVu
c2lnbmVkIGxvbmcgaTsKKworICAgICAgICAgICAgZm9yICggaSA9IDA7IGkg
PCAoMVVMIDw8IG9yZGVyKTsgKytpICkKKyAgICAgICAgICAgIHsKKyAgICAg
ICAgICAgICAgICBwMm1fdHlwZV90IHQ7CisgICAgICAgICAgICAgICAgbWZu
X3QgY21mbiA9IHAybS0+Z2V0X2VudHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkp
LCAmdCwgJmEsIDAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE5VTEwsIE5VTEwpOworCisgICAgICAgICAgICAgICAg
aWYgKCAhbWZuX2VxKGNtZm4sIG1mbl9hZGQobWZuLCBpKSkgfHwgdCAhPSBn
Zm5fcDJtdCB8fAorICAgICAgICAgICAgICAgICAgICAgYSAhPSBhY2Nlc3Mg
KQorICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKKworICAgICAgICAg
ICAgICAgIGlmICggcDJtX2lzX3JhbShvdCkgKQorICAgICAgICAgICAgICAg
IHsKKyAgICAgICAgICAgICAgICAgICAgQVNTRVJUKG1mbl92YWxpZChtZm5f
YWRkKG9tZm4sIGkpKSk7CisgICAgICAgICAgICAgICAgICAgIHNldF9ncGZu
X2Zyb21fbWZuKG1mbl94KG9tZm4pICsgaSwgSU5WQUxJRF9NMlBfRU5UUlkp
OworICAgICAgICAgICAgICAgIH0KKyNpZmRlZiBDT05GSUdfSFZNCisgICAg
ICAgICAgICAgICAgZWxzZSBpZiAoIHAybV9pc19wb2Qob3QpICkKKyAgICAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICAgIHBvZF9sb2NrKHAy
bSk7CisgICAgICAgICAgICAgICAgICAgIEJVR19PTighcDJtLT5wb2QuZW50
cnlfY291bnQpOworICAgICAgICAgICAgICAgICAgICAtLXAybS0+cG9kLmVu
dHJ5X2NvdW50OworICAgICAgICAgICAgICAgICAgICBwb2RfdW5sb2NrKHAy
bSk7CisgICAgICAgICAgICAgICAgfQorI2VuZGlmCisgICAgICAgICAgICB9
CisgICAgICAgIH0KKyAgICB9CiAgICAgZWxzZSBpZiAoIHAybV9pc19yYW0o
b3QpICkKICAgICB7CiAgICAgICAgIHVuc2lnbmVkIGxvbmcgaTsKQEAgLTEz
MTcsMTIgKzE0MTEsNiBAQCBzdGF0aWMgaW50IHNldF90eXBlZF9wMm1fZW50
cnkoc3RydWN0IGRvCiAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbiht
Zm5feChvbWZuKSArIGksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAg
fQogICAgIH0KLQotICAgIFAyTV9ERUJVRygic2V0ICVkICVseCAlbHhcbiIs
IGdmbl9wMm10LCBnZm5fbCwgbWZuX3gobWZuKSk7Ci0gICAgcmMgPSBwMm1f
c2V0X2VudHJ5KHAybSwgZ2ZuLCBtZm4sIG9yZGVyLCBnZm5fcDJtdCwgYWNj
ZXNzKTsKLSAgICBpZiAoIHJjICkKLSAgICAgICAgZ2RwcmludGsoWEVOTE9H
X0VSUiwgInAybV9zZXRfZW50cnk6ICUjbHg6JXUgLT4gJWQgKDB4JSJQUklf
bWZuIilcbiIsCi0gICAgICAgICAgICAgICAgIGdmbl9sLCBvcmRlciwgcmMs
IG1mbl94KG1mbikpOwogI2lmZGVmIENPTkZJR19IVk0KICAgICBlbHNlIGlm
ICggcDJtX2lzX3BvZChvdCkgKQogICAgIHsK

--=separator
Content-Type: application/octet-stream; name="xsa389-4.14.patch"
Content-Disposition: attachment; filename="xsa389-4.14.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUDJNOiBkZWFsIHdpdGggcGFydGlhbCBzdWNjZXNzIG9mIHAybV9z
ZXRfZW50cnkoKQoKTTJQIGFuZCBQb0Qgc3RhdHMgbmVlZCB0byByZW1haW4g
aW4gc3luYyB3aXRoIFAyTTsgaWYgYW4gdXBkYXRlIHN1Y2NlZWRzCm9ubHkg
cGFydGlhbGx5LCByZXNwZWN0aXZlIGFkanVzdG1lbnRzIG5lZWQgdG8gYmUg
bWFkZS4gSWYgdXBkYXRlcyBnZXQKbWFkZSBiZWZvcmUgdGhlIGNhbGwsIHRo
ZXkgbWF5IGFsc28gbmVlZCB1bmRvaW5nIHVwb24gY29tcGxldGUgZmFpbHVy
ZQooaS5lLiBpbmNsdWRpbmcgdGhlIHNpbmdsZS1wYWdlIGNhc2UpLgoKTG9n
LWRpcnR5IHN0YXRlIHdvdWxkIGJldHRlciBhbHNvIGJlIGtlcHQgaW4gc3lu
Yy4KCk5vdGUgdGhhdCB0aGUgY2hhbmdlIHRvIHNldF90eXBlZF9wMm1fZW50
cnkoKSBtYXkgbm90IGJlIHN0cmljdGx5Cm5lY2Vzc2FyeSAoZHVlIHRvIHRo
ZSBvcmRlciByZXN0cmljdGlvbiBlbmZvcmNlZCBuZWFyIHRoZSB0b3Agb2Yg
dGhlCmZ1bmN0aW9uKSwgYnV0IGlzIGJlaW5nIGtlcHQgaGVyZSB0byBiZSBv
biB0aGUgc2FmZSBzaWRlLgoKVGhpcyBpcyBDVkUtMjAyMS0yODcwNSBhbmQg
Q1ZFLTIwMjEtMjg3MDkgLyBYU0EtMzg5LgoKU2lnbmVkLW9mZi1ieTogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUm9n
ZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+CgotLS0gYS94
ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3Ay
bS5jCkBAIC03ODAsNiArNzgwLDcgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVj
dCBwMm1fZG9tYWluICpwMm0sCiAgICAgdW5zaWduZWQgbG9uZyBpOwogICAg
IHAybV90eXBlX3QgdDsKICAgICBwMm1fYWNjZXNzX3QgYTsKKyAgICBpbnQg
cmM7CiAKICAgICAvKiBJT01NVSBmb3IgUFYgZ3Vlc3RzIGlzIGhhbmRsZWQg
aW4gZ2V0X3BhZ2VfdHlwZSgpIGFuZCBwdXRfcGFnZSgpLiAqLwogICAgIGlm
ICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShwMm0tPmRvbWFpbikgKQpAQCAt
ODEzLDggKzgxNCwyNyBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9k
b21haW4gKnAybSwKICAgICAgICAgfQogICAgIH0KIAotICAgIHJldHVybiBw
Mm1fc2V0X2VudHJ5KHAybSwgZ2ZuLCBJTlZBTElEX01GTiwgcGFnZV9vcmRl
ciwgcDJtX2ludmFsaWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgcDJt
LT5kZWZhdWx0X2FjY2Vzcyk7CisgICAgcmMgPSBwMm1fc2V0X2VudHJ5KHAy
bSwgZ2ZuLCBJTlZBTElEX01GTiwgcGFnZV9vcmRlciwgcDJtX2ludmFsaWQs
CisgICAgICAgICAgICAgICAgICAgICAgIHAybS0+ZGVmYXVsdF9hY2Nlc3Mp
OworICAgIGlmICggbGlrZWx5KCFyYykgfHwgIW1mbl92YWxpZChtZm4pICkK
KyAgICAgICAgcmV0dXJuIHJjOworCisgICAgLyoKKyAgICAgKiBUaGUgb3Bl
cmF0aW9uIG1heSBoYXZlIHBhcnRpYWxseSBzdWNjZWVkZWQuIEZvciB0aGUg
ZmFpbGVkIHBhcnQgd2UgbmVlZAorICAgICAqIHRvIHVuZG8gdGhlIE0yUCB1
cGRhdGUgYW5kLCBvdXQgb2YgcHJlY2F1dGlvbiwgbWFyayB0aGUgcGFnZXMg
ZGlydHkKKyAgICAgKiBhZ2Fpbi4KKyAgICAgKi8KKyAgICBmb3IgKCBpID0g
MDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRlcik7ICsraSApCisgICAgeworICAg
ICAgICBwMm0tPmdldF9lbnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBpKSwgJnQs
ICZhLCAwLCBOVUxMLCBOVUxMKTsKKyAgICAgICAgaWYgKCAhcDJtX2lzX2hv
bGUodCkgJiYgIXAybV9pc19zcGVjaWFsKHQpICYmICFwMm1faXNfc2hhcmVk
KHQpICkKKyAgICAgICAgeworICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9t
Zm4obWZuX3gobWZuKSArIGksIGdmbl94KGdmbikgKyBpKTsKKyAgICAgICAg
ICAgIHBhZ2luZ19tYXJrX3Bmbl9kaXJ0eShwMm0tPmRvbWFpbiwgX3Bmbihn
Zm5feChnZm4pICsgaSkpOworICAgICAgICB9CisgICAgfQorCisgICAgcmV0
dXJuIHJjOwogfQogCiBpbnQKQEAgLTEwMDMsMTMgKzEwMjMsOCBAQCBndWVz
dF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpkCiAKICAgICAv
KiBOb3csIGFjdHVhbGx5IGRvIHRoZSB0d28td2F5IG1hcHBpbmcgKi8KICAg
ICByYyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwgcGFnZV9vcmRl
ciwgdCwgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7Ci0gICAgaWYgKCByYyA9PSAw
ICkKKyAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICB7Ci0gICAgICAgIHBv
ZF9sb2NrKHAybSk7Ci0gICAgICAgIHAybS0+cG9kLmVudHJ5X2NvdW50IC09
IHBvZF9jb3VudDsKLSAgICAgICAgQlVHX09OKHAybS0+cG9kLmVudHJ5X2Nv
dW50IDwgMCk7Ci0gICAgICAgIHBvZF91bmxvY2socDJtKTsKLQogICAgICAg
ICBpZiAoICFwMm1faXNfZ3JhbnQodCkgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRlcik7IGkr
KyApCkBAIC0xMDE3LDYgKzEwMzIsNDIgQEAgZ3Vlc3RfcGh5c21hcF9hZGRf
ZW50cnkoc3RydWN0IGRvbWFpbiAqZAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdmbl94KGdmbl9hZGQoZ2ZuLCBpKSkpOwogICAgICAg
ICB9CiAgICAgfQorICAgIGVsc2UKKyAgICB7CisgICAgICAgIC8qCisgICAg
ICAgICAqIFRoZSBvcGVyYXRpb24gbWF5IGhhdmUgcGFydGlhbGx5IHN1Y2Nl
ZWRlZC4gRm9yIHRoZSBzdWNjZXNzZnVsIHBhcnQKKyAgICAgICAgICogd2Ug
bmVlZCB0byB1cGRhdGUgTTJQIGFuZCBkaXJ0eSBzdGF0ZSwgd2hpbGUgZm9y
IHRoZSBmYWlsZWQgcGFydCB3ZQorICAgICAgICAgKiBtYXkgbmVlZCB0byBh
ZGp1c3QgUG9EIHN0YXRzIGFzIHdlbGwgYXMgdW5kbyB0aGUgZWFybGllciBN
MlAgdXBkYXRlLgorICAgICAgICAgKi8KKyAgICAgICAgZm9yICggaSA9IDA7
IGkgPCAoMVVMIDw8IHBhZ2Vfb3JkZXIpOyArK2kgKQorICAgICAgICB7Cisg
ICAgICAgICAgICBvbWZuID0gcDJtLT5nZXRfZW50cnkocDJtLCBnZm5fYWRk
KGdmbiwgaSksICZvdCwgJmEsIDAsIE5VTEwsIE5VTEwpOworICAgICAgICAg
ICAgaWYgKCBwMm1faXNfcG9kKG90KSApCisgICAgICAgICAgICB7CisgICAg
ICAgICAgICAgICAgQlVHX09OKCFwb2RfY291bnQpOworICAgICAgICAgICAg
ICAgIC0tcG9kX2NvdW50OworICAgICAgICAgICAgfQorICAgICAgICAgICAg
ZWxzZSBpZiAoIG1mbl9lcShvbWZuLCBtZm5fYWRkKG1mbiwgaSkpICYmIG90
ID09IHQgJiYKKyAgICAgICAgICAgICAgICAgICAgICBhID09IHAybS0+ZGVm
YXVsdF9hY2Nlc3MgJiYgIXAybV9pc19ncmFudCh0KSApCisgICAgICAgICAg
ICB7CisgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3go
b21mbiksIGdmbl94KGdmbikgKyBpKTsKKyAgICAgICAgICAgICAgICBwYWdp
bmdfbWFya19wZm5fZGlydHkoZCwgX3BmbihnZm5feChnZm4pICsgaSkpOwor
ICAgICAgICAgICAgfQorICAgICAgICAgICAgZWxzZSBpZiAoIHAybV9pc19y
YW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKKyAgICAgICAgICAgIHsK
KyAgICAgICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKG9tZm4pKTsKKyAg
ICAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm5feChvbWZuKSwg
Z2ZuX3goZ2ZuKSArIGkpOworICAgICAgICAgICAgfQorICAgICAgICB9Cisg
ICAgfQorCisgICAgaWYgKCBwb2RfY291bnQgKQorICAgIHsKKyAgICAgICAg
cG9kX2xvY2socDJtKTsKKyAgICAgICAgcDJtLT5wb2QuZW50cnlfY291bnQg
LT0gcG9kX2NvdW50OworICAgICAgICBCVUdfT04ocDJtLT5wb2QuZW50cnlf
Y291bnQgPCAwKTsKKyAgICAgICAgcG9kX3VubG9jayhwMm0pOworICAgIH0K
IAogb3V0OgogICAgIHAybV91bmxvY2socDJtKTsKQEAgLTEzMDgsNiArMTM1
OSw0OSBAQCBzdGF0aWMgaW50IHNldF90eXBlZF9wMm1fZW50cnkoc3RydWN0
IGRvCiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgfQogICAgIH0K
KworICAgIFAyTV9ERUJVRygic2V0ICVkICVseCAlbHhcbiIsIGdmbl9wMm10
LCBnZm5fbCwgbWZuX3gobWZuKSk7CisgICAgcmMgPSBwMm1fc2V0X2VudHJ5
KHAybSwgZ2ZuLCBtZm4sIG9yZGVyLCBnZm5fcDJtdCwgYWNjZXNzKTsKKyAg
ICBpZiAoIHVubGlrZWx5KHJjKSApCisgICAgeworICAgICAgICBnZHByaW50
ayhYRU5MT0dfRVJSLCAicDJtX3NldF9lbnRyeTogJSNseDoldSAtPiAlZCAo
MHglIlBSSV9tZm4iKVxuIiwKKyAgICAgICAgICAgICAgICAgZ2ZuX2wsIG9y
ZGVyLCByYywgbWZuX3gobWZuKSk7CisKKyAgICAgICAgLyoKKyAgICAgICAg
ICogVGhlIG9wZXJhdGlvbiBtYXkgaGF2ZSBwYXJ0aWFsbHkgc3VjY2VlZGVk
LiBGb3IgdGhlIHN1Y2Nlc3NmdWwgcGFydAorICAgICAgICAgKiB3ZSBuZWVk
IHRvIHVwZGF0ZSBQb0Qgc3RhdHMsIE0yUCwgYW5kIGRpcnR5IHN0YXRlLgor
ICAgICAgICAgKi8KKyAgICAgICAgaWYgKCBvcmRlciAhPSBQQUdFX09SREVS
XzRLICkKKyAgICAgICAgeworICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBp
OworCisgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgb3Jk
ZXIpOyArK2kgKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHAy
bV90eXBlX3QgdDsKKyAgICAgICAgICAgICAgICBtZm5fdCBjbWZuID0gcDJt
LT5nZXRfZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
TlVMTCwgTlVMTCk7CisKKyAgICAgICAgICAgICAgICBpZiAoICFtZm5fZXEo
Y21mbiwgbWZuX2FkZChtZm4sIGkpKSB8fCB0ICE9IGdmbl9wMm10IHx8Cisg
ICAgICAgICAgICAgICAgICAgICBhICE9IGFjY2VzcyApCisgICAgICAgICAg
ICAgICAgICAgIGNvbnRpbnVlOworCisgICAgICAgICAgICAgICAgaWYgKCBw
Mm1faXNfcmFtKG90KSApCisgICAgICAgICAgICAgICAgeworICAgICAgICAg
ICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKG1mbl9hZGQob21mbiwgaSkp
KTsKKyAgICAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZu
X3gob21mbikgKyBpLCBJTlZBTElEX00yUF9FTlRSWSk7CisgICAgICAgICAg
ICAgICAgfQorI2lmZGVmIENPTkZJR19IVk0KKyAgICAgICAgICAgICAgICBl
bHNlIGlmICggcDJtX2lzX3BvZChvdCkgKQorICAgICAgICAgICAgICAgIHsK
KyAgICAgICAgICAgICAgICAgICAgcG9kX2xvY2socDJtKTsKKyAgICAgICAg
ICAgICAgICAgICAgQlVHX09OKCFwMm0tPnBvZC5lbnRyeV9jb3VudCk7Cisg
ICAgICAgICAgICAgICAgICAgIC0tcDJtLT5wb2QuZW50cnlfY291bnQ7Cisg
ICAgICAgICAgICAgICAgICAgIHBvZF91bmxvY2socDJtKTsKKyAgICAgICAg
ICAgICAgICB9CisjZW5kaWYKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQor
ICAgIH0KICAgICBlbHNlIGlmICggcDJtX2lzX3JhbShvdCkgKQogICAgIHsK
ICAgICAgICAgdW5zaWduZWQgbG9uZyBpOwpAQCAtMTMxOCwxMiArMTQxMiw2
IEBAIHN0YXRpYyBpbnQgc2V0X3R5cGVkX3AybV9lbnRyeShzdHJ1Y3QgZG8K
ICAgICAgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG9tZm4pICsg
aSwgSU5WQUxJRF9NMlBfRU5UUlkpOwogICAgICAgICB9CiAgICAgfQotCi0g
ICAgUDJNX0RFQlVHKCJzZXQgJWQgJWx4ICVseFxuIiwgZ2ZuX3AybXQsIGdm
bl9sLCBtZm5feChtZm4pKTsKLSAgICByYyA9IHAybV9zZXRfZW50cnkocDJt
LCBnZm4sIG1mbiwgb3JkZXIsIGdmbl9wMm10LCBhY2Nlc3MpOwotICAgIGlm
ICggcmMgKQotICAgICAgICBnZHByaW50ayhYRU5MT0dfRVJSLCAicDJtX3Nl
dF9lbnRyeTogJSNseDoldSAtPiAlZCAoMHglIlBSSV9tZm4iKVxuIiwKLSAg
ICAgICAgICAgICAgICAgZ2ZuX2wsIG9yZGVyLCByYywgbWZuX3gobWZuKSk7
CiAjaWZkZWYgQ09ORklHX0hWTQogICAgIGVsc2UgaWYgKCBwMm1faXNfcG9k
KG90KSApCiAgICAgewo=

--=separator
Content-Type: application/octet-stream; name="xsa389-4.15.patch"
Content-Disposition: attachment; filename="xsa389-4.15.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUDJNOiBkZWFsIHdpdGggcGFydGlhbCBzdWNjZXNzIG9mIHAybV9z
ZXRfZW50cnkoKQoKTTJQIGFuZCBQb0Qgc3RhdHMgbmVlZCB0byByZW1haW4g
aW4gc3luYyB3aXRoIFAyTTsgaWYgYW4gdXBkYXRlIHN1Y2NlZWRzCm9ubHkg
cGFydGlhbGx5LCByZXNwZWN0aXZlIGFkanVzdG1lbnRzIG5lZWQgdG8gYmUg
bWFkZS4gSWYgdXBkYXRlcyBnZXQKbWFkZSBiZWZvcmUgdGhlIGNhbGwsIHRo
ZXkgbWF5IGFsc28gbmVlZCB1bmRvaW5nIHVwb24gY29tcGxldGUgZmFpbHVy
ZQooaS5lLiBpbmNsdWRpbmcgdGhlIHNpbmdsZS1wYWdlIGNhc2UpLgoKTG9n
LWRpcnR5IHN0YXRlIHdvdWxkIGJldHRlciBhbHNvIGJlIGtlcHQgaW4gc3lu
Yy4KCk5vdGUgdGhhdCB0aGUgY2hhbmdlIHRvIHNldF90eXBlZF9wMm1fZW50
cnkoKSBtYXkgbm90IGJlIHN0cmljdGx5Cm5lY2Vzc2FyeSAoZHVlIHRvIHRo
ZSBvcmRlciByZXN0cmljdGlvbiBlbmZvcmNlZCBuZWFyIHRoZSB0b3Agb2Yg
dGhlCmZ1bmN0aW9uKSwgYnV0IGlzIGJlaW5nIGtlcHQgaGVyZSB0byBiZSBv
biB0aGUgc2FmZSBzaWRlLgoKVGhpcyBpcyBDVkUtMjAyMS0yODcwNSBhbmQg
Q1ZFLTIwMjEtMjg3MDkgLyBYU0EtMzg5LgoKU2lnbmVkLW9mZi1ieTogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUm9n
ZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+CgotLS0gYS94
ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3Ay
bS5jCkBAIC03ODQsNiArNzg0LDcgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVj
dCBwMm1fZG9tYWluICpwMm0sCiAgICAgdW5zaWduZWQgbG9uZyBpOwogICAg
IHAybV90eXBlX3QgdDsKICAgICBwMm1fYWNjZXNzX3QgYTsKKyAgICBpbnQg
cmM7CiAKICAgICAvKiBJT01NVSBmb3IgUFYgZ3Vlc3RzIGlzIGhhbmRsZWQg
aW4gZ2V0X3BhZ2VfdHlwZSgpIGFuZCBwdXRfcGFnZSgpLiAqLwogICAgIGlm
ICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShwMm0tPmRvbWFpbikgKQpAQCAt
ODE5LDggKzgyMCwyNyBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9k
b21haW4gKnAybSwKIAogICAgIGlvcmVxX3JlcXVlc3RfbWFwY2FjaGVfaW52
YWxpZGF0ZShwMm0tPmRvbWFpbik7CiAKLSAgICByZXR1cm4gcDJtX3NldF9l
bnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4sIHBhZ2Vfb3JkZXIsIHAybV9p
bnZhbGlkLAotICAgICAgICAgICAgICAgICAgICAgICAgIHAybS0+ZGVmYXVs
dF9hY2Nlc3MpOworICAgIHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwg
SU5WQUxJRF9NRk4sIHBhZ2Vfb3JkZXIsIHAybV9pbnZhbGlkLAorICAgICAg
ICAgICAgICAgICAgICAgICBwMm0tPmRlZmF1bHRfYWNjZXNzKTsKKyAgICBp
ZiAoIGxpa2VseSghcmMpIHx8ICFtZm5fdmFsaWQobWZuKSApCisgICAgICAg
IHJldHVybiByYzsKKworICAgIC8qCisgICAgICogVGhlIG9wZXJhdGlvbiBt
YXkgaGF2ZSBwYXJ0aWFsbHkgc3VjY2VlZGVkLiBGb3IgdGhlIGZhaWxlZCBw
YXJ0IHdlIG5lZWQKKyAgICAgKiB0byB1bmRvIHRoZSBNMlAgdXBkYXRlIGFu
ZCwgb3V0IG9mIHByZWNhdXRpb24sIG1hcmsgdGhlIHBhZ2VzIGRpcnR5Cisg
ICAgICogYWdhaW4uCisgICAgICovCisgICAgZm9yICggaSA9IDA7IGkgPCAo
MVVMIDw8IHBhZ2Vfb3JkZXIpOyArK2kgKQorICAgIHsKKyAgICAgICAgcDJt
LT5nZXRfZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwg
TlVMTCwgTlVMTCk7CisgICAgICAgIGlmICggIXAybV9pc19ob2xlKHQpICYm
ICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3NoYXJlZCh0KSApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94
KG1mbikgKyBpLCBnZm5feChnZm4pICsgaSk7CisgICAgICAgICAgICBwYWdp
bmdfbWFya19wZm5fZGlydHkocDJtLT5kb21haW4sIF9wZm4oZ2ZuX3goZ2Zu
KSArIGkpKTsKKyAgICAgICAgfQorICAgIH0KKworICAgIHJldHVybiByYzsK
IH0KIAogaW50CkBAIC0xMDA5LDEzICsxMDI5LDggQEAgZ3Vlc3RfcGh5c21h
cF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAqZAogCiAgICAgLyogTm93LCBh
Y3R1YWxseSBkbyB0aGUgdHdvLXdheSBtYXBwaW5nICovCiAgICAgcmMgPSBw
Mm1fc2V0X2VudHJ5KHAybSwgZ2ZuLCBtZm4sIHBhZ2Vfb3JkZXIsIHQsIHAy
bS0+ZGVmYXVsdF9hY2Nlc3MpOwotICAgIGlmICggcmMgPT0gMCApCisgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgewotICAgICAgICBwb2RfbG9jayhw
Mm0pOwotICAgICAgICBwMm0tPnBvZC5lbnRyeV9jb3VudCAtPSBwb2RfY291
bnQ7Ci0gICAgICAgIEJVR19PTihwMm0tPnBvZC5lbnRyeV9jb3VudCA8IDAp
OwotICAgICAgICBwb2RfdW5sb2NrKHAybSk7Ci0KICAgICAgICAgaWYgKCAh
cDJtX2lzX2dyYW50KHQpICkKICAgICAgICAgewogICAgICAgICAgICAgZm9y
ICggaSA9IDA7IGkgPCAoMVVMIDw8IHBhZ2Vfb3JkZXIpOyBpKysgKQpAQCAt
MTAyMyw2ICsxMDM4LDQyIEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0
cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBnZm5feChnZm5fYWRkKGdmbiwgaSkpKTsKICAgICAgICAgfQogICAg
IH0KKyAgICBlbHNlCisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBU
aGUgb3BlcmF0aW9uIG1heSBoYXZlIHBhcnRpYWxseSBzdWNjZWVkZWQuIEZv
ciB0aGUgc3VjY2Vzc2Z1bCBwYXJ0CisgICAgICAgICAqIHdlIG5lZWQgdG8g
dXBkYXRlIE0yUCBhbmQgZGlydHkgc3RhdGUsIHdoaWxlIGZvciB0aGUgZmFp
bGVkIHBhcnQgd2UKKyAgICAgICAgICogbWF5IG5lZWQgdG8gYWRqdXN0IFBv
RCBzdGF0cyBhcyB3ZWxsIGFzIHVuZG8gdGhlIGVhcmxpZXIgTTJQIHVwZGF0
ZS4KKyAgICAgICAgICovCisgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDFV
TCA8PCBwYWdlX29yZGVyKTsgKytpICkKKyAgICAgICAgeworICAgICAgICAg
ICAgb21mbiA9IHAybS0+Z2V0X2VudHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkp
LCAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKKyAgICAgICAgICAgIGlmICgg
cDJtX2lzX3BvZChvdCkgKQorICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgIEJVR19PTighcG9kX2NvdW50KTsKKyAgICAgICAgICAgICAgICAtLXBv
ZF9jb3VudDsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGVsc2UgaWYg
KCBtZm5fZXEob21mbiwgbWZuX2FkZChtZm4sIGkpKSAmJiBvdCA9PSB0ICYm
CisgICAgICAgICAgICAgICAgICAgICAgYSA9PSBwMm0tPmRlZmF1bHRfYWNj
ZXNzICYmICFwMm1faXNfZ3JhbnQodCkgKQorICAgICAgICAgICAgeworICAg
ICAgICAgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG9tZm4pLCBn
Zm5feChnZm4pICsgaSk7CisgICAgICAgICAgICAgICAgcGFnaW5nX21hcmtf
cGZuX2RpcnR5KGQsIF9wZm4oZ2ZuX3goZ2ZuKSArIGkpKTsKKyAgICAgICAg
ICAgIH0KKyAgICAgICAgICAgIGVsc2UgaWYgKCBwMm1faXNfcmFtKG90KSAm
JiAhcDJtX2lzX3BhZ2VkKG90KSApCisgICAgICAgICAgICB7CisgICAgICAg
ICAgICAgICAgQVNTRVJUKG1mbl92YWxpZChvbWZuKSk7CisgICAgICAgICAg
ICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3gob21mbiksIGdmbl94KGdm
bikgKyBpKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0KKwor
ICAgIGlmICggcG9kX2NvdW50ICkKKyAgICB7CisgICAgICAgIHBvZF9sb2Nr
KHAybSk7CisgICAgICAgIHAybS0+cG9kLmVudHJ5X2NvdW50IC09IHBvZF9j
b3VudDsKKyAgICAgICAgQlVHX09OKHAybS0+cG9kLmVudHJ5X2NvdW50IDwg
MCk7CisgICAgICAgIHBvZF91bmxvY2socDJtKTsKKyAgICB9CiAKIG91dDoK
ICAgICBwMm1fdW5sb2NrKHAybSk7CkBAIC0xMzE0LDYgKzEzNjUsNTEgQEAg
c3RhdGljIGludCBzZXRfdHlwZWRfcDJtX2VudHJ5KHN0cnVjdCBkbwogICAg
ICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgIH0KICAgICB9CisKKyAgICBQ
Mk1fREVCVUcoInNldCAlZCAlbHggJWx4XG4iLCBnZm5fcDJtdCwgZ2ZuX2ws
IG1mbl94KG1mbikpOworICAgIHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdm
biwgbWZuLCBvcmRlciwgZ2ZuX3AybXQsIGFjY2Vzcyk7CisgICAgaWYgKCB1
bmxpa2VseShyYykgKQorICAgIHsKKyAgICAgICAgZ2RwcmludGsoWEVOTE9H
X0VSUiwgInAybV9zZXRfZW50cnk6ICUjbHg6JXUgLT4gJWQgKDB4JSJQUklf
bWZuIilcbiIsCisgICAgICAgICAgICAgICAgIGdmbl9sLCBvcmRlciwgcmMs
IG1mbl94KG1mbikpOworCisgICAgICAgIC8qCisgICAgICAgICAqIFRoZSBv
cGVyYXRpb24gbWF5IGhhdmUgcGFydGlhbGx5IHN1Y2NlZWRlZC4gRm9yIHRo
ZSBzdWNjZXNzZnVsIHBhcnQKKyAgICAgICAgICogd2UgbmVlZCB0byB1cGRh
dGUgUG9EIHN0YXRzLCBNMlAsIGFuZCBkaXJ0eSBzdGF0ZS4KKyAgICAgICAg
ICovCisgICAgICAgIGlmICggb3JkZXIgIT0gUEFHRV9PUkRFUl80SyApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgaTsKKworICAg
ICAgICAgICAgZm9yICggaSA9IDA7IGkgPCAoMVVMIDw8IG9yZGVyKTsgKytp
ICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBwMm1fdHlwZV90
IHQ7CisgICAgICAgICAgICAgICAgbWZuX3QgY21mbiA9IHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIE5V
TEwpOworCisgICAgICAgICAgICAgICAgaWYgKCAhbWZuX2VxKGNtZm4sIG1m
bl9hZGQobWZuLCBpKSkgfHwgdCAhPSBnZm5fcDJtdCB8fAorICAgICAgICAg
ICAgICAgICAgICAgYSAhPSBhY2Nlc3MgKQorICAgICAgICAgICAgICAgICAg
ICBjb250aW51ZTsKKworICAgICAgICAgICAgICAgIGlmICggcDJtX2lzX3Jh
bShvdCkgKQorICAgICAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICAg
ICAgQVNTRVJUKG1mbl92YWxpZChtZm5fYWRkKG9tZm4sIGkpKSk7CisgICAg
ICAgICAgICAgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG9tZm4p
ICsgaSwgSU5WQUxJRF9NMlBfRU5UUlkpOworCisgICAgICAgICAgICAgICAg
ICAgIGlvcmVxX3JlcXVlc3RfbWFwY2FjaGVfaW52YWxpZGF0ZShkKTsKKyAg
ICAgICAgICAgICAgICB9CisjaWZkZWYgQ09ORklHX0hWTQorICAgICAgICAg
ICAgICAgIGVsc2UgaWYgKCBwMm1faXNfcG9kKG90KSApCisgICAgICAgICAg
ICAgICAgeworICAgICAgICAgICAgICAgICAgICBwb2RfbG9jayhwMm0pOwor
ICAgICAgICAgICAgICAgICAgICBCVUdfT04oIXAybS0+cG9kLmVudHJ5X2Nv
dW50KTsKKyAgICAgICAgICAgICAgICAgICAgLS1wMm0tPnBvZC5lbnRyeV9j
b3VudDsKKyAgICAgICAgICAgICAgICAgICAgcG9kX3VubG9jayhwMm0pOwor
ICAgICAgICAgICAgICAgIH0KKyNlbmRpZgorICAgICAgICAgICAgfQorICAg
ICAgICB9CisgICAgfQogICAgIGVsc2UgaWYgKCBwMm1faXNfcmFtKG90KSAp
CiAgICAgewogICAgICAgICB1bnNpZ25lZCBsb25nIGk7CkBAIC0xMzI2LDEy
ICsxNDIyLDYgQEAgc3RhdGljIGludCBzZXRfdHlwZWRfcDJtX2VudHJ5KHN0
cnVjdCBkbwogCiAgICAgICAgIGlvcmVxX3JlcXVlc3RfbWFwY2FjaGVfaW52
YWxpZGF0ZShkKTsKICAgICB9Ci0KLSAgICBQMk1fREVCVUcoInNldCAlZCAl
bHggJWx4XG4iLCBnZm5fcDJtdCwgZ2ZuX2wsIG1mbl94KG1mbikpOwotICAg
IHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgbWZuLCBvcmRlciwgZ2Zu
X3AybXQsIGFjY2Vzcyk7Ci0gICAgaWYgKCByYyApCi0gICAgICAgIGdkcHJp
bnRrKFhFTkxPR19FUlIsICJwMm1fc2V0X2VudHJ5OiAlI2x4OiV1IC0+ICVk
ICgweCUiUFJJX21mbiIpXG4iLAotICAgICAgICAgICAgICAgICBnZm5fbCwg
b3JkZXIsIHJjLCBtZm5feChtZm4pKTsKICNpZmRlZiBDT05GSUdfSFZNCiAg
ICAgZWxzZSBpZiAoIHAybV9pc19wb2Qob3QpICkKICAgICB7Cg==

--=separator--


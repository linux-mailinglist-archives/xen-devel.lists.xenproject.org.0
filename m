Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 1ADBAB7A71
	for <lists+xen-devel@lfdr.de>; Thu, 19 Sep 2019 15:26:50 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iAwPZ-0008Bg-TP; Thu, 19 Sep 2019 13:23:53 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=5hYN=XO=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1iAwPY-0008BL-QX
 for xen-devel@lists.xenproject.org; Thu, 19 Sep 2019 13:23:52 +0000
X-Inumbo-ID: b396fc62-dae0-11e9-965d-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id b396fc62-dae0-11e9-965d-12813bfff9fa;
 Thu, 19 Sep 2019 13:23:43 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id EB617B009;
 Thu, 19 Sep 2019 13:23:42 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
References: <aa62726c-5aa4-8bcd-dc35-61eb8dfeaee3@suse.com>
Message-ID: <6e78af43-45f4-b2b1-26e5-04dfb40f1858@suse.com>
Date: Thu, 19 Sep 2019 15:23:51 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <aa62726c-5aa4-8bcd-dc35-61eb8dfeaee3@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH v6 5/8] AMD/IOMMU: restrict interrupt remapping
 table sizes
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlcmUncyBubyBwb2ludCBzZXR0aW5nIHVwIHRhYmxlcyB3aXRoIG1vcmUgc3BhY2UgdGhhbiBh
IFBDSSBkZXZpY2UgY2FuCnVzZS4gRm9yIGJvdGggTVNJIGFuZCBNU0ktWCB3ZSBjYW4gZGV0ZXJt
aW5lIGhvdyBtYW55IGludGVycnVwdHMgY291bGQKYmUgc2V0IHVwIGF0IG1vc3QuIFRhYmxlcyBh
bGxvY2F0ZWQgZHVyaW5nIEFDUEkgdGFibGUgcGFyc2luZywgaG93ZXZlciwKd2lsbCAoZm9yIG5v
dyBhdCBsZWFzdCkgY29udGludWUgdG8gYmUgc2V0IHVwIHRvIGhhdmUgbWF4aW11bSBzaXplLgoK
Tm90ZSB0aGF0IHVudGlsIHdlIHdvdWxkIHdhbnQgdG8gdXNlIHN1Yi1wYWdlIGFsbG9jYXRpb25z
IGhlcmUgdGhlcmUncwpubyBwb2ludCBjaGVja2luZyB3aGV0aGVyIGJvdGggTVNJIGFuZCBNU0kt
WCBhcmUgc3VwcG9ydGVkIGJ5IGEgZGV2aWNlIC0KYW4gb3JkZXItMCBhbGxvY2F0aW9uIHdpbGwg
Zml0IHRoZSBkdWFsIGNhc2UgaW4gYW55IGV2ZW50LCBubyBtYXR0ZXIKdGhhdCB0aGUgTVNJLVgg
dmVjdG9yIGNvdW50IG1heSBiZSBzbWFsbGVyIHRoYW4gdGhlIE1TSSBvbmUuCgpPbiBteSBSb21l
IHN5c3RlbSB0aGlzIHJlZHVjZXMgc3BhY2UgbmVlZGVkIGZyb20ganVzdCBvdmVyIDFrIHBhZ2Vz
IHRvCmFib3V0IDEyNS4KClN1Z2dlc3RlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3Bl
cjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2Uu
Y29tPgotLS0KdjY6IERvbid0IGFsbG9jYXRlIGFueSBJUlQgYXQgYWxsIHdoZW4gZGV2aWNlIGlz
IG5laXRoZXIgTVNJLVggbm9yCiAgICBNU0ktY2FwYWJsZS4gUmUtYmFzZSBvdmVyIGNoYW5nZXMg
ZWFybGllciBpbiB0aGlzIHNlcmllcy4KdjU6IE5ldy4KCi0tLQogeGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvYW1kL2lvbW11X2FjcGkuYyAgICAgIHwgICAgNCArLQogeGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvYW1kL2lvbW11X2luaXQuYyAgICAgIHwgICAxMyArKysrLS0tLS0KIHhlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMgICAgICB8ICAgMzYgKysrKysrKysrKysrKysr
LS0tLS0tLS0tLS0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYyAgICAg
ICB8ICAgMjAgKysrKysrKysrKy0tLS0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lf
YW1kX2lvbW11LmMgICB8ICAgMTggKysrKysrKy0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9o
dm0vc3ZtL2FtZC1pb21tdS1kZWZzLmggIHwgICAgMyAtLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9o
dm0vc3ZtL2FtZC1pb21tdS1wcm90by5oIHwgICAgNSArKy0KIDcgZmlsZXMgY2hhbmdlZCwgNTkg
aW5zZXJ0aW9ucygrKSwgNDAgZGVsZXRpb25zKC0pCgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9hbWQvaW9tbXVfYWNwaS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9hY3BpLmMKQEAgLTc3LDcgKzc3LDcgQEAgc3RhdGljIHZvaWQgX19pbml0IGFkZF9pdnJz
X21hcHBpbmdfZW50cgogICAgICAgICB7CiAgICAgICAgICAgICBpZiAoICFzaGFyZWRfaW50cmVt
YXBfdGFibGUgKQogICAgICAgICAgICAgICAgIHNoYXJlZF9pbnRyZW1hcF90YWJsZSA9IGFtZF9p
b21tdV9hbGxvY19pbnRyZW1hcF90YWJsZSgKLSAgICAgICAgICAgICAgICAgICAgaW9tbXUsICZz
aGFyZWRfaW50cmVtYXBfaW51c2UpOworICAgICAgICAgICAgICAgICAgICBpb21tdSwgJnNoYXJl
ZF9pbnRyZW1hcF9pbnVzZSwgMCk7CiAKICAgICAgICAgICAgIGlmICggIXNoYXJlZF9pbnRyZW1h
cF90YWJsZSApCiAgICAgICAgICAgICAgICAgcGFuaWMoIk5vIG1lbW9yeSBmb3Igc2hhcmVkIElS
VFxuIik7CkBAIC04OSw3ICs4OSw3IEBAIHN0YXRpYyB2b2lkIF9faW5pdCBhZGRfaXZyc19tYXBw
aW5nX2VudHIKICAgICAgICAgewogICAgICAgICAgICAgaXZyc19tYXBwaW5nc1thbGlhc19pZF0u
aW50cmVtYXBfdGFibGUgPQogICAgICAgICAgICAgICAgIGFtZF9pb21tdV9hbGxvY19pbnRyZW1h
cF90YWJsZSgKLSAgICAgICAgICAgICAgICAgICAgaW9tbXUsICZpdnJzX21hcHBpbmdzW2FsaWFz
X2lkXS5pbnRyZW1hcF9pbnVzZSk7CisgICAgICAgICAgICAgICAgICAgIGlvbW11LCAmaXZyc19t
YXBwaW5nc1thbGlhc19pZF0uaW50cmVtYXBfaW51c2UsIDApOwogCiAgICAgICAgICAgICBpZiAo
ICFpdnJzX21hcHBpbmdzW2FsaWFzX2lkXS5pbnRyZW1hcF90YWJsZSApCiAgICAgICAgICAgICAg
ICAgcGFuaWMoIk5vIG1lbW9yeSBmb3IgJTA0eDolMDJ4OiUwMnguJXUncyBJUlRcbiIsCi0tLSBh
L3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMKKysrIGIveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYwpAQCAtMTI4NCwxMiArMTI4NCwxNCBAQCBz
dGF0aWMgaW50IF9faW5pdCBhbWRfaW9tbXVfc2V0dXBfZGV2aWNlCiAgICAgICAgICAgICAgICAg
cGNpZGV2c191bmxvY2soKTsKICAgICAgICAgICAgIH0KIAotICAgICAgICAgICAgaWYgKCBwZGV2
ICkKKyAgICAgICAgICAgIGlmICggcGRldiAmJiAocGRldi0+bXNpeCB8fCBwZGV2LT5tc2lfbWF4
dmVjKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZd
LmludHJlbWFwX3RhYmxlID0KICAgICAgICAgICAgICAgICAgICAgYW1kX2lvbW11X2FsbG9jX2lu
dHJlbWFwX3RhYmxlKAogICAgICAgICAgICAgICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZd
LmlvbW11LAotICAgICAgICAgICAgICAgICAgICAgICAgJml2cnNfbWFwcGluZ3NbYmRmXS5pbnRy
ZW1hcF9pbnVzZSk7CisgICAgICAgICAgICAgICAgICAgICAgICAmaXZyc19tYXBwaW5nc1tiZGZd
LmludHJlbWFwX2ludXNlLAorICAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+bXNpeCA/IHBk
ZXYtPm1zaXgtPm5yX2VudHJpZXMKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
OiBwZGV2LT5tc2lfbWF4dmVjKTsKICAgICAgICAgICAgICAgICBpZiAoICFpdnJzX21hcHBpbmdz
W2JkZl0uaW50cmVtYXBfdGFibGUgKQogICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01F
TTsKIApAQCAtMTMxMiwxMSArMTMxNCw4IEBAIHN0YXRpYyBpbnQgX19pbml0IGFtZF9pb21tdV9z
ZXR1cF9kZXZpY2UKICAgICAgICAgICAgIH0KIAogICAgICAgICAgICAgYW1kX2lvbW11X3NldF9p
bnRyZW1hcF90YWJsZSgKLSAgICAgICAgICAgICAgICBkdGUsCi0gICAgICAgICAgICAgICAgaXZy
c19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlCi0gICAgICAgICAgICAgICAgPyB2aXJ0X3Rv
X21hZGRyKGl2cnNfbWFwcGluZ3NbYmRmXS5pbnRyZW1hcF90YWJsZSkKLSAgICAgICAgICAgICAg
ICA6IDAsCi0gICAgICAgICAgICAgICAgaW9tbXVfaW50cmVtYXApOworICAgICAgICAgICAgICAg
IGR0ZSwgaXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlLAorICAgICAgICAgICAgICAg
IGl2cnNfbWFwcGluZ3NbYmRmXS5pb21tdSwgaW9tbXVfaW50cmVtYXApOwogICAgICAgICB9CiAg
ICAgfQogCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMKKysr
IGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2ludHIuYwpAQCAtNjksNyArNjks
OCBAQCB1bmlvbiBpcnRlX2NwdHIgewogICAgIGNvbnN0IHVuaW9uIGlydGUxMjggKnB0cjEyODsK
IH0gX190cmFuc3BhcmVudF9fOwogCi0jZGVmaW5lIElOVFJFTUFQX01BWF9FTlRSSUVTICgxIDw8
IElPTU1VX0lOVFJFTUFQX09SREVSKQorI2RlZmluZSBJTlRSRU1BUF9NQVhfT1JERVIgICAweEIK
KyNkZWZpbmUgSU5UUkVNQVBfTUFYX0VOVFJJRVMgKDEgPDwgSU5UUkVNQVBfTUFYX09SREVSKQog
CiBzdHJ1Y3QgaW9hcGljX3NiZGYgaW9hcGljX3NiZGZbTUFYX0lPX0FQSUNTXTsKIHN0cnVjdCBo
cGV0X3NiZGYgaHBldF9zYmRmOwpAQCAtODAsMTcgKzgxLDEzIEBAIHVuc2lnbmVkIGludCBucl9p
b2FwaWNfc2JkZjsKIAogc3RhdGljIHZvaWQgZHVtcF9pbnRyZW1hcF90YWJsZXModW5zaWduZWQg
Y2hhciBrZXkpOwogCi1zdGF0aWMgdW5zaWduZWQgaW50IF9faW5pdCBpbnRyZW1hcF90YWJsZV9v
cmRlcihjb25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKLXsKLSAgICByZXR1cm4gaW9tbXUt
PmN0cmwuZ2FfZW4KLSAgICAgICAgICAgPyBnZXRfb3JkZXJfZnJvbV9ieXRlcyhJTlRSRU1BUF9N
QVhfRU5UUklFUyAqIHNpemVvZih1bmlvbiBpcnRlMTI4KSkKLSAgICAgICAgICAgOiBnZXRfb3Jk
ZXJfZnJvbV9ieXRlcyhJTlRSRU1BUF9NQVhfRU5UUklFUyAqIHNpemVvZih1bmlvbiBpcnRlMzIp
KTsKLX0KKyNkZWZpbmUgaW50cmVtYXBfcGFnZV9vcmRlcihpcnQpIFBGTl9PUkRFUih2aXJ0X3Rv
X3BhZ2UoaXJ0KSkKIAogdW5zaWduZWQgaW50IGFtZF9pb21tdV9pbnRyZW1hcF90YWJsZV9vcmRl
cigKICAgICBjb25zdCB2b2lkICppcnQsIGNvbnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQog
ewotICAgIHJldHVybiBJT01NVV9JTlRSRU1BUF9PUkRFUjsKKyAgICByZXR1cm4gaW50cmVtYXBf
cGFnZV9vcmRlcihpcnQpICsgUEFHRV9TSElGVCAtCisgICAgICAgICAgIChpb21tdS0+Y3RybC5n
YV9lbiA/IDQgOiAyKTsKIH0KIAogc3RhdGljIHVuc2lnbmVkIGludCBpbnRyZW1hcF90YWJsZV9l
bnRyaWVzKApAQCAtODI1LDcgKzgyMiwxMCBAQCBpbnQgYW1kX2lvbW11X2ZyZWVfaW50cmVtYXBf
dGFibGUoCiAKICAgICBpZiAoICp0YmxwICkKICAgICB7Ci0gICAgICAgIF9fZnJlZV9hbWRfaW9t
bXVfdGFibGVzKCp0YmxwLCBpbnRyZW1hcF90YWJsZV9vcmRlcihpb21tdSkpOworICAgICAgICB1
bnNpZ25lZCBpbnQgb3JkZXIgPSBpbnRyZW1hcF9wYWdlX29yZGVyKCp0YmxwKTsKKworICAgICAg
ICBpbnRyZW1hcF9wYWdlX29yZGVyKCp0YmxwKSA9IDA7CisgICAgICAgIF9fZnJlZV9hbWRfaW9t
bXVfdGFibGVzKCp0YmxwLCBvcmRlcik7CiAgICAgICAgICp0YmxwID0gTlVMTDsKICAgICB9CiAK
QEAgLTgzMywxNSArODMzLDIzIEBAIGludCBhbWRfaW9tbXVfZnJlZV9pbnRyZW1hcF90YWJsZSgK
IH0KIAogdm9pZCAqYW1kX2lvbW11X2FsbG9jX2ludHJlbWFwX3RhYmxlKAotICAgIGNvbnN0IHN0
cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1bnNpZ25lZCBsb25nICoqaW51c2VfbWFwKQorICAgIGNv
bnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1bnNpZ25lZCBsb25nICoqaW51c2VfbWFwLCB1
bnNpZ25lZCBpbnQgbnIpCiB7Ci0gICAgdW5zaWduZWQgaW50IG9yZGVyID0gaW50cmVtYXBfdGFi
bGVfb3JkZXIoaW9tbXUpOwotICAgIHZvaWQgKnRiID0gX19hbGxvY19hbWRfaW9tbXVfdGFibGVz
KG9yZGVyKTsKKyAgICB1bnNpZ25lZCBpbnQgb3JkZXI7CisgICAgdm9pZCAqdGI7CiAKKyAgICBp
ZiAoICFuciApCisgICAgICAgIG5yID0gSU5UUkVNQVBfTUFYX0VOVFJJRVM7CisKKyAgICBvcmRl
ciA9IGlvbW11LT5jdHJsLmdhX2VuCisgICAgICAgICAgICA/IGdldF9vcmRlcl9mcm9tX2J5dGVz
KG5yICogc2l6ZW9mKHVuaW9uIGlydGUxMjgpKQorICAgICAgICAgICAgOiBnZXRfb3JkZXJfZnJv
bV9ieXRlcyhuciAqIHNpemVvZih1bmlvbiBpcnRlMzIpKTsKKworICAgIHRiID0gX19hbGxvY19h
bWRfaW9tbXVfdGFibGVzKG9yZGVyKTsKICAgICBpZiAoIHRiICkKICAgICB7Ci0gICAgICAgIHVu
c2lnbmVkIGludCBuciA9IGludHJlbWFwX3RhYmxlX2VudHJpZXModGIsIGlvbW11KTsKLQorICAg
ICAgICBpbnRyZW1hcF9wYWdlX29yZGVyKHRiKSA9IG9yZGVyOworICAgICAgICBuciA9IGludHJl
bWFwX3RhYmxlX2VudHJpZXModGIsIGlvbW11KTsKICAgICAgICAgKmludXNlX21hcCA9IHh6YWxs
b2NfYXJyYXkodW5zaWduZWQgbG9uZywgQklUU19UT19MT05HUyhucikpOwogICAgICAgICBpZiAo
ICppbnVzZV9tYXAgKQogICAgICAgICAgICAgbWVtc2V0KHRiLCAwLCBQQUdFX1NJWkUgPDwgb3Jk
ZXIpOwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKKysrIGIv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCkBAIC0xMTMsMTIgKzExMywy
MiBAQCB2b2lkIGFtZF9pb21tdV9zZXRfcm9vdF9wYWdlX3RhYmxlKHN0cnVjCiB9CiAKIHZvaWQg
X19pbml0IGFtZF9pb21tdV9zZXRfaW50cmVtYXBfdGFibGUoCi0gICAgc3RydWN0IGFtZF9pb21t
dV9kdGUgKmR0ZSwgdWludDY0X3QgaW50cmVtYXBfcHRyLCBib29sIHZhbGlkKQorICAgIHN0cnVj
dCBhbWRfaW9tbXVfZHRlICpkdGUsIGNvbnN0IHZvaWQgKnB0ciwKKyAgICBjb25zdCBzdHJ1Y3Qg
YW1kX2lvbW11ICppb21tdSwgYm9vbCB2YWxpZCkKIHsKLSAgICBkdGUtPml0X3Jvb3QgPSBpbnRy
ZW1hcF9wdHIgPj4gNjsKLSAgICBkdGUtPmludF90YWJfbGVuID0gaW50cmVtYXBfcHRyID8gSU9N
TVVfSU5UUkVNQVBfT1JERVIgOiAwOwotICAgIGR0ZS0+aW50X2N0bCA9IGludHJlbWFwX3B0ciA/
IElPTU1VX0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9UUkFOU0xBVEVECi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIDogSU9NTVVfREVWX1RBQkxFX0lOVF9DT05UUk9MX0FCT1JURUQ7Cisg
ICAgaWYgKCBwdHIgKQorICAgIHsKKyAgICAgICAgZHRlLT5pdF9yb290ID0gdmlydF90b19tYWRk
cihwdHIpID4+IDY7CisgICAgICAgIGR0ZS0+aW50X3RhYl9sZW4gPSBhbWRfaW9tbXVfaW50cmVt
YXBfdGFibGVfb3JkZXIocHRyLCBpb21tdSk7CisgICAgICAgIGR0ZS0+aW50X2N0bCA9IElPTU1V
X0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9UUkFOU0xBVEVEOworICAgIH0KKyAgICBlbHNlCisgICAg
eworICAgICAgICBkdGUtPml0X3Jvb3QgPSAwOworICAgICAgICBkdGUtPmludF90YWJfbGVuID0g
MDsKKyAgICAgICAgZHRlLT5pbnRfY3RsID0gSU9NTVVfREVWX1RBQkxFX0lOVF9DT05UUk9MX0FC
T1JURUQ7CisgICAgfQorCiAgICAgZHRlLT5pZyA9IGZhbHNlOyAvKiB1bm1hcHBlZCBpbnRlcnJ1
cHRzIHJlc3VsdCBpbiBpL28gcGFnZSBmYXVsdHMgKi8KICAgICBkdGUtPml2ID0gdmFsaWQ7CiB9
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKKysrIGIv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwpAQCAtNDcwLDE4ICs0
NzAsMjIgQEAgc3RhdGljIGludCBhbWRfaW9tbXVfYWRkX2RldmljZSh1OCBkZXZmbgogICAgIHsK
ICAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIAotICAgICAgICBpdnJzX21hcHBpbmdzW2Jk
Zl0uaW50cmVtYXBfdGFibGUgPQotICAgICAgICAgICAgYW1kX2lvbW11X2FsbG9jX2ludHJlbWFw
X3RhYmxlKAotICAgICAgICAgICAgICAgIGlvbW11LCAmaXZyc19tYXBwaW5nc1tiZGZdLmludHJl
bWFwX2ludXNlKTsKLSAgICAgICAgaWYgKCAhaXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3Rh
YmxlICkKLSAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICBpZiAoIHBkZXYtPm1z
aXggfHwgcGRldi0+bXNpX21heHZlYyApCisgICAgICAgIHsKKyAgICAgICAgICAgIGl2cnNfbWFw
cGluZ3NbYmRmXS5pbnRyZW1hcF90YWJsZSA9CisgICAgICAgICAgICAgICAgYW1kX2lvbW11X2Fs
bG9jX2ludHJlbWFwX3RhYmxlKAorICAgICAgICAgICAgICAgICAgICBpb21tdSwgJml2cnNfbWFw
cGluZ3NbYmRmXS5pbnRyZW1hcF9pbnVzZSwKKyAgICAgICAgICAgICAgICAgICAgcGRldi0+bXNp
eCA/IHBkZXYtPm1zaXgtPm5yX2VudHJpZXMKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICA6IHBkZXYtPm1zaV9tYXh2ZWMpOworICAgICAgICAgICAgaWYgKCAhaXZyc19tYXBwaW5nc1ti
ZGZdLmludHJlbWFwX3RhYmxlICkKKyAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKKyAg
ICAgICAgfQogCiAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3Mp
OwogCiAgICAgICAgIGFtZF9pb21tdV9zZXRfaW50cmVtYXBfdGFibGUoCiAgICAgICAgICAgICBp
b21tdS0+ZGV2X3RhYmxlLmJ1ZmZlciArIChiZGYgKiBJT01NVV9ERVZfVEFCTEVfRU5UUllfU0la
RSksCi0gICAgICAgICAgICB2aXJ0X3RvX21hZGRyKGl2cnNfbWFwcGluZ3NbYmRmXS5pbnRyZW1h
cF90YWJsZSksCi0gICAgICAgICAgICBpb21tdV9pbnRyZW1hcCk7CisgICAgICAgICAgICBpdnJz
X21hcHBpbmdzW2JkZl0uaW50cmVtYXBfdGFibGUsIGlvbW11LCBpb21tdV9pbnRyZW1hcCk7CiAK
ICAgICAgICAgYW1kX2lvbW11X2ZsdXNoX2RldmljZShpb21tdSwgYmRmKTsKIAotLS0gYS94ZW4v
aW5jbHVkZS9hc20teDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMuaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMuaApAQCAtMTA3LDkgKzEwNyw2IEBACiAj
ZGVmaW5lIElPTU1VX0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9GT1JXQVJERUQJMHgxCiAjZGVmaW5l
IElPTU1VX0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9UUkFOU0xBVEVECTB4MgogCi0vKiBGb3Igbm93
LCB3ZSBhbHdheXMgYWxsb2NhdGUgdGhlIG1heGltdW06IDIwNDggZW50cmllcy4gKi8KLSNkZWZp
bmUgSU9NTVVfSU5UUkVNQVBfT1JERVIJCQkweEIKLQogc3RydWN0IGFtZF9pb21tdV9kdGUgewog
ICAgIC8qIDAgLSA2MyAqLwogICAgIGJvb2wgdjoxOwotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2
L2h2bS9zdm0vYW1kLWlvbW11LXByb3RvLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0v
c3ZtL2FtZC1pb21tdS1wcm90by5oCkBAIC03Miw3ICs3Miw4IEBAIGludCBfX211c3RfY2hlY2sg
YW1kX2lvbW11X2ZsdXNoX2lvdGxiX2EKIC8qIGRldmljZSB0YWJsZSBmdW5jdGlvbnMgKi8KIGlu
dCBnZXRfZG1hX3JlcXVlc3Rvcl9pZCh1aW50MTZfdCBzZWcsIHVpbnQxNl90IGJkZik7CiB2b2lk
IGFtZF9pb21tdV9zZXRfaW50cmVtYXBfdGFibGUoc3RydWN0IGFtZF9pb21tdV9kdGUgKmR0ZSwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBpbnRyZW1hcF9wdHIs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdm9pZCAqcHRyLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdmFsaWQpOwogdm9p
ZCBhbWRfaW9tbXVfc2V0X3Jvb3RfcGFnZV90YWJsZShzdHJ1Y3QgYW1kX2lvbW11X2R0ZSAqZHRl
LAogCQkJCSAgIHVpbnQ2NF90IHJvb3RfcHRyLCB1aW50MTZfdCBkb21haW5faWQsCkBAIC05OSw3
ICsxMDAsNyBAQCBzdHJ1Y3QgYW1kX2lvbW11ICpmaW5kX2lvbW11X2Zvcl9kZXZpY2UoCiBib29s
IGlvdl9zdXBwb3J0c194dCh2b2lkKTsKIGludCBhbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFw
cGluZyh2b2lkKTsKIHZvaWQgKmFtZF9pb21tdV9hbGxvY19pbnRyZW1hcF90YWJsZSgKLSAgICBj
b25zdCBzdHJ1Y3QgYW1kX2lvbW11ICosIHVuc2lnbmVkIGxvbmcgKiopOworICAgIGNvbnN0IHN0
cnVjdCBhbWRfaW9tbXUgKiwgdW5zaWduZWQgbG9uZyAqKiwgdW5zaWduZWQgaW50IG5yKTsKIGlu
dCBhbWRfaW9tbXVfZnJlZV9pbnRyZW1hcF90YWJsZSgKICAgICBjb25zdCBzdHJ1Y3QgYW1kX2lv
bW11ICosIHN0cnVjdCBpdnJzX21hcHBpbmdzICosIHVpbnQxNl90KTsKIHVuc2lnbmVkIGludCBh
bWRfaW9tbXVfaW50cmVtYXBfdGFibGVfb3JkZXIoCgoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxA
bGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFu
L2xpc3RpbmZvL3hlbi1kZXZlbA==

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 973D5B363A
	for <lists+xen-devel@lfdr.de>; Mon, 16 Sep 2019 10:13:09 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9m5s-0004HH-6t; Mon, 16 Sep 2019 08:10:44 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=LwWr=XL=bitdefender.com=aisaila@srs-us1.protection.inumbo.net>)
 id 1i9m5p-0004HC-UZ
 for xen-devel@lists.xenproject.org; Mon, 16 Sep 2019 08:10:42 +0000
X-Inumbo-ID: 78c7b8bc-d859-11e9-978d-bc764e2007e4
Received: from EUR04-DB3-obe.outbound.protection.outlook.com (unknown
 [2a01:111:f400:fe0c::70e])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 78c7b8bc-d859-11e9-978d-bc764e2007e4;
 Mon, 16 Sep 2019 08:10:40 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=O4b6NmUeRIqLw26CPMP/P0e4GXff9w9o0NVsl2mWE+BsbSiyrYgpJCVZ762cQ4VCtGPkGo5uE3qPFHsP7Yr/u8PkHiI9iqNFM2MN5wqTixRKFL2jJoKrjNkMIFi5fd6kilHfgwGrI9YGFVu+WX51oLUVG20L6UnJQpFl7+jCo3wB8N8mRCu2bnnR/57lvAxaryhRHfV3MmFdPF07HTU7uVxnSzpp6QD0YBucsuNvnKfQJ64VTSra72OLCuj0lBfl1iFwOxBab9QBEnH5vxX/VIvIvcS6ZuaIZMiebwZB6oiAla+fcOAUX3JtEpmKmBwKcNUb43aOho/VbN6Ed1Mn6A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=E9FgZ5aXPEpG7kBK63S2BCk9TObBdch357sB1x2R1tk=;
 b=MnZkt3nJMvnxGYXAFbcxaDIsuF0qkrO3JvwxDTVO6RmteeClClfMWlXcyLr0GJA5oU9nzP3D23O0/CoAI8W7lVDS27RpxRVaO9c/mCuW4FLZ8cWBvhZVHd8ZEPk+WS7EmeJCgMcWpUAvZ+P5DTtrc/jbCxw3G6dMP+3cDlSbtBF5taBcDqxJPGTiP0vcySgv6V7pN0uQgFcu9Z8+YHeQYnSRTRT+6P8GEFaQ5CUTvWYZXOdak23P7xi92VJGd7ggs0Wf3LxSEpADsfcz5Kx1vDCLINp4C/1aChwXUWCXEie9sUOZwgDI1UNbplPfnLzDkZ6FRpc5Eu+etlz+E5diAg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=bitdefender.com; dmarc=pass action=none
 header.from=bitdefender.com; dkim=pass header.d=bitdefender.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=bitdefender.onmicrosoft.com; s=selector2-bitdefender-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=E9FgZ5aXPEpG7kBK63S2BCk9TObBdch357sB1x2R1tk=;
 b=FftQvEsfTtM+2Wgvel374QLwyFg1IcU5frGWA33cmgAM1vQhS2Y7GO2REu2Xrj9Sw3agLNrnIiHIXC+2ECxAcgPbqSiQ6UwrBoICQSmJDGn1kKrWgdPHCch2i+31J4aIi1snxoXupi2RoqIXmBQiJ+lQ/kqSY+b7uHDgx2jEYUY=
Received: from AM7PR02MB5750.eurprd02.prod.outlook.com (10.141.171.8) by
 AM7PR02MB5944.eurprd02.prod.outlook.com (10.141.175.9) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2263.14; Mon, 16 Sep 2019 08:10:39 +0000
Received: from AM7PR02MB5750.eurprd02.prod.outlook.com
 ([fe80::2d9b:67b0:d407:67b8]) by AM7PR02MB5750.eurprd02.prod.outlook.com
 ([fe80::2d9b:67b0:d407:67b8%2]) with mapi id 15.20.2263.023; Mon, 16 Sep 2019
 08:10:39 +0000
From: Alexandru Stefan ISAILA <aisaila@bitdefender.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v10] x86/emulate: Send vm_event from emulate
Thread-Index: AQHVbGY5LYraxeTPu06yM6Qe3Haipw==
Date: Mon, 16 Sep 2019 08:10:38 +0000
Message-ID: <20190916081024.20931-1-aisaila@bitdefender.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: AM0PR06CA0033.eurprd06.prod.outlook.com
 (2603:10a6:208:ab::46) To AM7PR02MB5750.eurprd02.prod.outlook.com
 (2603:10a6:20b:102::8)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=aisaila@bitdefender.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [91.199.104.6]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 3d83dfb8-2bde-44b5-406e-08d73a7d5c26
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(5600167)(711020)(4605104)(1401327)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7193020);
 SRVR:AM7PR02MB5944; 
x-ms-traffictypediagnostic: AM7PR02MB5944:|AM7PR02MB5944:|AM7PR02MB5944:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <AM7PR02MB5944DBAB16A73E17CDD55A25AB8C0@AM7PR02MB5944.eurprd02.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:9508;
x-forefront-prvs: 0162ACCC24
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(136003)(39860400002)(366004)(376002)(346002)(396003)(199004)(189003)(54906003)(36756003)(81166006)(25786009)(6916009)(81156014)(3846002)(6116002)(6506007)(14454004)(4326008)(71200400001)(71190400001)(186003)(26005)(8676002)(8936002)(53936002)(2351001)(5660300002)(6512007)(6486002)(316002)(5640700003)(1076003)(99286004)(478600001)(6436002)(66066001)(102836004)(386003)(50226002)(7736002)(305945005)(2906002)(14444005)(86362001)(66946007)(66476007)(66556008)(64756008)(66446008)(256004)(486006)(52116002)(2501003)(476003)(2616005)(309714004);
 DIR:OUT; SFP:1102; SCL:1; SRVR:AM7PR02MB5944;
 H:AM7PR02MB5750.eurprd02.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: bitdefender.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: E+1JWUWGwVAUjpr5brRgiYx/4bRwikARncoUH4tKPrru4a0IU+yhH/917QyIOT8KwXqqJi3LSaAvB4Uo0nV1+LrV3bAWETo3J8keP7rQr55qM0XMWAOnKezK37w1eEbwQW4WOi+4q4x6MwdPKzEGudAKIGIbf4IfF06Hc8xvbF8ewsd7JruFlbXUEwLPZb5aBF4BycEbtmHpToVBfWRTAi7Al8Pa3ZO/tPIhGKvhhFl0BA1CjOrXSVVbK1zEuRhxR6UKdsuQufUpcwmofsXxc6l+DNOxR2IwUkgoIimEkdUuEkQw/U4h/7sjb4r2HR+yiCIr4l3l2GXzL/UhSzFGDhhrSOcYJJEWEKzZd8G8r6LMcOu0Gp5IdOn3SzKnsjz6+NfpUAshyTkevlkR8pbPikZNpstaeQVGhed5NX/p2Ko=
MIME-Version: 1.0
X-OriginatorOrg: bitdefender.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 3d83dfb8-2bde-44b5-406e-08d73a7d5c26
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 Sep 2019 08:10:39.0040 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 487baf29-f1da-469a-9221-243f830c36f3
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Zvw7GO9YptKTWs6c7J3LCsX8KaLl40ImyUX5uyeVfYYI6yLH5RZHJPoSueTW2hBJQh/5YWgG64PJxQnr39UDQf0PZlXFgb55CDZDQzEKefQ=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM7PR02MB5944
Subject: [Xen-devel] [PATCH v10] x86/emulate: Send vm_event from emulate
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Petre Ovidiu PIRCALABU <ppircalabu@bitdefender.com>,
 "tamas@tklengyel.com" <tamas@tklengyel.com>, "wl@xen.org" <wl@xen.org>,
 Razvan COJOCARU <rcojocaru@bitdefender.com>,
 "george.dunlap@eu.citrix.com" <george.dunlap@eu.citrix.com>,
 "andrew.cooper3@citrix.com" <andrew.cooper3@citrix.com>,
 "paul.durrant@citrix.com" <paul.durrant@citrix.com>,
 "jbeulich@suse.com" <jbeulich@suse.com>,
 Alexandru Stefan ISAILA <aisaila@bitdefender.com>,
 "roger.pau@citrix.com" <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QS9EIGJpdCB3cml0ZXMgKG9uIHBhZ2Ugd2Fsa3MpIGNhbiBiZSBjb25zaWRlcmVkIGJlbmlnbiBi
eSBhbiBpbnRyb3NwZWN0aW9uCmFnZW50LCBzbyByZWNlaXZpbmcgdm1fZXZlbnRzIGZvciB0aGVt
IGlzIGEgcGVzc2ltaXphdGlvbi4gV2UgdHJ5IGhlcmUgdG8Kb3B0aW1pemUgYnkgZmlsdGVyaW5n
IHRoZXNlIGV2ZW50cyBvdXQuCkN1cnJlbnRseSwgd2UgYXJlIGZ1bGx5IGVtdWxhdGluZyB0aGUg
aW5zdHJ1Y3Rpb24gYXQgUklQIHdoZW4gdGhlIGhhcmR3YXJlIHNlZXMKYW4gRVBUIGZhdWx0IHdp
dGggbnBmZWMua2luZCAhPSBucGZlY19raW5kX3dpdGhfZ2xhLiBUaGlzIGlzLCBob3dldmVyLApp
bmNvcnJlY3QsIGJlY2F1c2UgdGhlIGluc3RydWN0aW9uIGF0IFJJUCBtaWdodCBsZWdpdGltYXRl
bHkgY2F1c2UgYW4KRVBUIGZhdWx0IG9mIGl0cyBvd24gd2hpbGUgYWNjZXNzaW5nIGEgX2RpZmZl
cmVudF8gcGFnZSBmcm9tIHRoZSBvcmlnaW5hbCBvbmUsCndoZXJlIEEvRCB3ZXJlIHNldC4KVGhl
IHNvbHV0aW9uIGlzIHRvIHBlcmZvcm0gdGhlIHdob2xlIGVtdWxhdGlvbiwgd2hpbGUgaWdub3Jp
bmcgRVBUIHJlc3RyaWN0aW9ucwpmb3IgdGhlIHdhbGsgcGFydCwgYW5kIHRha2luZyB0aGVtIGlu
dG8gYWNjb3VudCBmb3IgdGhlICJhY3R1YWwiIGVtdWxhdGluZyBvZgp0aGUgaW5zdHJ1Y3Rpb24g
YXQgUklQLiBXaGVuIHdlIHNlbmQgb3V0IGEgdm1fZXZlbnQsIHdlIGRvbid0IHdhbnQgdGhlIGVt
dWxhdGlvbgp0byBjb21wbGV0ZSwgc2luY2UgaW4gdGhhdCBjYXNlIHdlIHdvbid0IGJlIGFibGUg
dG8gdmV0byB3aGF0ZXZlciBpdCBpcyBkb2luZy4KVGhhdCB3b3VsZCBtZWFuIHRoYXQgd2UgY2Fu
J3QgYWN0dWFsbHkgcHJldmVudCBhbnkgbWFsaWNpb3VzIGFjdGl2aXR5LCBpbnN0ZWFkCndlJ2Qg
b25seSBiZSBhYmxlIHRvIHJlcG9ydCBvbiBpdC4KV2hlbiB3ZSBzZWUgYSAic2VuZC12bV9ldmVu
dCIgY2FzZSB3aGlsZSBlbXVsYXRpbmcsIHdlIG5lZWQgdG8gZmlyc3Qgc2VuZCB0aGUKZXZlbnQg
b3V0IGFuZCB0aGVuIHN1c3BlbmQgdGhlIGVtdWxhdGlvbiAocmV0dXJuIFg4NkVNVUxfUkVUUlkp
LgpBZnRlciB0aGUgZW11bGF0aW9uIHN0b3BzIHdlJ2xsIGNhbGwgaHZtX3ZtX2V2ZW50X2RvX3Jl
c3VtZSgpIGFnYWluIGFmdGVyIHRoZQppbnRyb3NwZWN0aW9uIGFnZW50IHRyZWF0cyB0aGUgZXZl
bnQgYW5kIHJlc3VtZXMgdGhlIGd1ZXN0LiBUaGVyZSwgdGhlCmluc3RydWN0aW9uIGF0IFJJUCB3
aWxsIGJlIGZ1bGx5IGVtdWxhdGVkICh3aXRoIHRoZSBFUFQgaWdub3JlZCkgaWYgdGhlCmludHJv
c3BlY3Rpb24gYXBwbGljYXRpb24gYWxsb3dzIGl0LCBhbmQgdGhlIGd1ZXN0IHdpbGwgY29udGlu
dWUgdG8gcnVuIHBhc3QKdGhlIGluc3RydWN0aW9uLgoKQSBjb21tb24gZXhhbXBsZSBpcyBpZiB0
aGUgaGFyZHdhcmUgZXhpdHMgYmVjYXVzZSBvZiBhbiBFUFQgZmF1bHQgY2F1c2VkIGJ5IGEKcGFn
ZSB3YWxrLCBwMm1fbWVtX2FjY2Vzc19jaGVjaygpIGRlY2lkZXMgaWYgaXQgaXMgZ29pbmcgdG8g
c2VuZCBhIHZtX2V2ZW50LgpJZiB0aGUgdm1fZXZlbnQgd2FzIHNlbnQgYW5kIGl0IHdvdWxkIGJl
IHRyZWF0ZWQgc28gaXQgcnVucyB0aGUgaW5zdHJ1Y3Rpb24KYXQgUklQLCB0aGF0IGluc3RydWN0
aW9uIG1pZ2h0IGFsc28gaGl0IGEgcHJvdGVjdGVkIHBhZ2UgYW5kIHByb3Zva2UgYSB2bV9ldmVu
dC4KCk5vdyBpZiBucGZlYy5raW5kID09IG5wZmVjX2tpbmRfaW5fZ3B0IGFuZCBkLT5hcmNoLm1v
bml0b3IuaW5ndWVzdF9wYWdlZmF1bHRfZGlzYWJsZWQKaXMgdHJ1ZSB0aGVuIHdlIGFyZSBpbiB0
aGUgcGFnZSB3YWxrIGNhc2UgYW5kIHdlIGNhbiBkbyB0aGlzIGVtdWxhdGlvbiBvcHRpbWl6YXRp
b24KYW5kIGVtdWxhdGUgdGhlIHBhZ2Ugd2FsayB3aGlsZSBpZ25vcmluZyB0aGUgRVBULCBidXQg
ZG9uJ3QgaWdub3JlIHRoZSBFUFQgZm9yIHRoZQplbXVsYXRpb24gb2YgdGhlIGFjdHVhbCBpbnN0
cnVjdGlvbi4KCkluIHRoZSBmaXJzdCBjYXNlIHdlIHdvdWxkIGhhdmUgMiBFUFQgZXZlbnRzLCBp
biB0aGUgc2Vjb25kIGNhc2Ugd2Ugd291bGQgaGF2ZQoxIEVQVCBldmVudCBpZiB0aGUgaW5zdHJ1
Y3Rpb24gYXQgdGhlIFJJUCB0cmlnZ2VycyBhbiBFUFQgZXZlbnQuCgpXZSB1c2UgaHZtZW11bF9t
YXBfbGluZWFyX2FkZHIoKSB0byBpbnRlcmNlcHQgd3JpdGUgYWNjZXNzIGFuZApfX2h2bV9jb3B5
KCkgdG8gaW50ZXJjZXB0IGV4ZWMgYW5kIHJlYWQgYWNjZXNzLgoKaHZtX2VtdWxhdGVfc2VuZF92
bV9ldmVudCgpIGNhbiByZXR1cm4gZmFsc2UgaWYgdGhlcmUgd2FzIG5vIHZpb2xhdGlvbiwKaWYg
dGhlcmUgd2FzIGFuIGVycm9yIGZyb20gbW9uaXRvcl90cmFwcygpIG9yIHAybV9nZXRfbWVtX2Fj
Y2VzcygpLgpSZXR1cm5pbmcgZmFsc2UgaWYgcDJtX2dldF9tZW1fYWNjZXNzKCkgZmFpbHMgaXMg
bmVlZGVkIGJlY2F1c2UgdGhlIEVQVAplbnRyeSB3aWxsIGhhdmUgcnd4IG1lbW9yeSBhY2Nlc3Mg
cmlnaHRzLgoKTk9URTogaHZtX2VtdWxhdGVfc2VuZF92bV9ldmVudCgpIGFzc3VtZXMgdGhlIGNh
bGxlciB3aWxsIGNoZWNrCmFyY2gudm1fZXZlbnQtPnNlbmRfZXZlbnQKClNpZ25lZC1vZmYtYnk6
IEFsZXhhbmRydSBJc2FpbGEgPGFpc2FpbGFAYml0ZGVmZW5kZXIuY29tPgoKLS0tCkNoYW5nZXMg
c2luY2UgVjk6CgktIFJlbW92ZSB0aGUgY2hhbmdlcyBjYXVzZWQgYnkgbW92aW5nIHRoZSAiZ290
byIgb3V0IG9mIHRoZSBsb29wCmluIGh2bWVtdWxfbWFwX2xpbmVhcl9hZGRyKCkuCgktIFVwZGF0
ZSBjb21tZW50IGFuZCBjb21taXQgbWVzc2FnZQoJLSBDaGFuZ2UgZnVuY3Rpb24gbmFtZSB0byBo
dm1fbW9uaXRvcl9jaGVja19wMm0oKS4KLS0tCiB4ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYyAg
ICAgICAgfCAxMSArKysrLQogeGVuL2FyY2gveDg2L2h2bS9odm0uYyAgICAgICAgICAgIHwgIDgg
KysrKwogeGVuL2FyY2gveDg2L2h2bS9tb25pdG9yLmMgICAgICAgIHwgNzUgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKwogeGVuL2FyY2gveDg2L21tL21lbV9hY2Nlc3MuYyAgICAgIHwg
IDggKysrLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vbW9uaXRvci5oIHwgIDMgKysKIHhlbi9p
bmNsdWRlL2FzbS14ODYvdm1fZXZlbnQuaCAgICB8ICAyICsKIDYgZmlsZXMgY2hhbmdlZCwgMTA1
IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L2h2bS9lbXVsYXRlLmMgYi94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYwppbmRleCAzNmJjYjUy
NmQzLi4yMmM4NTkzN2FkIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYwor
KysgYi94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYwpAQCAtNTQ4LDYgKzU0OCw3IEBAIHN0YXRp
YyB2b2lkICpodm1lbXVsX21hcF9saW5lYXJfYWRkcigKICAgICB1bnNpZ25lZCBpbnQgbnJfZnJh
bWVzID0gKChsaW5lYXIgKyBieXRlcyAtICEhYnl0ZXMpID4+IFBBR0VfU0hJRlQpIC0KICAgICAg
ICAgKGxpbmVhciA+PiBQQUdFX1NISUZUKSArIDE7CiAgICAgdW5zaWduZWQgaW50IGk7CisgICAg
Z2ZuX3QgZ2ZuOwogCiAgICAgLyoKICAgICAgKiBtZm4gcG9pbnRzIHRvIHRoZSBuZXh0IGZyZWUg
c2xvdC4gIEFsbCB1c2VkIHNsb3RzIGhhdmUgYSBwYWdlIHJlZmVyZW5jZQpAQCAtNTgyLDcgKzU4
Myw3IEBAIHN0YXRpYyB2b2lkICpodm1lbXVsX21hcF9saW5lYXJfYWRkcigKICAgICAgICAgQVNT
RVJUKG1mbl94KCptZm4pID09IDApOwogCiAgICAgICAgIHJlcyA9IGh2bV90cmFuc2xhdGVfZ2V0
X3BhZ2UoY3VyciwgYWRkciwgdHJ1ZSwgcGZlYywKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAmcGZpbmZvLCAmcGFnZSwgTlVMTCwgJnAybXQpOworICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICZwZmluZm8sICZwYWdlLCAmZ2ZuLCAmcDJtdCk7CiAKICAg
ICAgICAgc3dpdGNoICggcmVzICkKICAgICAgICAgewpAQCAtNjI2LDYgKzYyNywxNCBAQCBzdGF0
aWMgdm9pZCAqaHZtZW11bF9tYXBfbGluZWFyX2FkZHIoCiAKICAgICAgICAgICAgIEFTU0VSVChw
Mm10ID09IHAybV9yYW1fbG9nZGlydHkgfHwgIXAybV9pc19yZWFkb25seShwMm10KSk7CiAgICAg
ICAgIH0KKworICAgICAgICBpZiAoIHVubGlrZWx5KGN1cnItPmFyY2gudm1fZXZlbnQpICYmCisg
ICAgICAgICAgICAgY3Vyci0+YXJjaC52bV9ldmVudC0+c2VuZF9ldmVudCAmJgorICAgICAgICAg
ICAgIGh2bV9tb25pdG9yX2NoZWNrX3AybShhZGRyLCBnZm4sIHBmZWMsIG5wZmVjX2tpbmRfd2l0
aF9nbGEpICkKKyAgICAgICAgeworICAgICAgICAgICAgZXJyID0gRVJSX1BUUih+WDg2RU1VTF9S
RVRSWSk7CisgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAgfQogICAgIH0KIAogICAgIC8q
IEVudGlyZSBhY2Nlc3Mgd2l0aGluIGEgc2luZ2xlIGZyYW1lPyAqLwpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L2h2bS9odm0uYyBiL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMKaW5kZXggNDUyYWM0
ODMzZC4uMTk1YTA3YzY0ZCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2bS9odm0uYworKysg
Yi94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCkBAIC0zMjI0LDYgKzMyMjQsMTQgQEAgc3RhdGljIGVu
dW0gaHZtX3RyYW5zbGF0aW9uX3Jlc3VsdCBfX2h2bV9jb3B5KAogICAgICAgICAgICAgcmV0dXJu
IEhWTVRSQU5TX2JhZF9nZm5fdG9fbWZuOwogICAgICAgICB9CiAKKyAgICAgICAgaWYgKCB1bmxp
a2VseSh2LT5hcmNoLnZtX2V2ZW50KSAmJgorICAgICAgICAgICAgIHYtPmFyY2gudm1fZXZlbnQt
PnNlbmRfZXZlbnQgJiYKKyAgICAgICAgICAgICBodm1fbW9uaXRvcl9jaGVja19wMm0oYWRkciwg
Z2ZuLCBwZmVjLCBucGZlY19raW5kX3dpdGhfZ2xhKSApCisgICAgICAgIHsKKyAgICAgICAgICAg
IHB1dF9wYWdlKHBhZ2UpOworICAgICAgICAgICAgcmV0dXJuIEhWTVRSQU5TX2dmbl9wYWdlZF9v
dXQ7CisgICAgICAgIH0KKwogICAgICAgICBwID0gKGNoYXIgKilfX21hcF9kb21haW5fcGFnZShw
YWdlKSArIChhZGRyICYgflBBR0VfTUFTSyk7CiAKICAgICAgICAgaWYgKCBmbGFncyAmIEhWTUNP
UFlfdG9fZ3Vlc3QgKQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS9tb25pdG9yLmMgYi94
ZW4vYXJjaC94ODYvaHZtL21vbml0b3IuYwppbmRleCAyYTQxY2NjOTMwLi44YzlkMjI4NGQxIDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL21vbml0b3IuYworKysgYi94ZW4vYXJjaC94ODYv
aHZtL21vbml0b3IuYwpAQCAtMjMsOCArMjMsMTAgQEAKICAqLwogCiAjaW5jbHVkZSA8eGVuL3Zt
X2V2ZW50Lmg+CisjaW5jbHVkZSA8eGVuL21lbV9hY2Nlc3MuaD4KICNpbmNsdWRlIDx4ZW4vbW9u
aXRvci5oPgogI2luY2x1ZGUgPGFzbS9odm0vbW9uaXRvci5oPgorI2luY2x1ZGUgPGFzbS9hbHRw
Mm0uaD4KICNpbmNsdWRlIDxhc20vbW9uaXRvci5oPgogI2luY2x1ZGUgPGFzbS9wYWdpbmcuaD4K
ICNpbmNsdWRlIDxhc20vdm1fZXZlbnQuaD4KQEAgLTIxNSw2ICsyMTcsNzkgQEAgdm9pZCBodm1f
bW9uaXRvcl9pbnRlcnJ1cHQodW5zaWduZWQgaW50IHZlY3RvciwgdW5zaWduZWQgaW50IHR5cGUs
CiAgICAgbW9uaXRvcl90cmFwcyhjdXJyZW50LCAxLCAmcmVxKTsKIH0KIAorLyoKKyAqIFNlbmQg
bWVtb3J5IGFjY2VzcyB2bV9ldmVudHMgYmFzZWQgb24gcGZlYy4gUmV0dXJucyB0cnVlIGlmIHRo
ZSBldmVudCB3YXMKKyAqIHNlbnQgYW5kIGZhbHNlIGZvciBwMm1fZ2V0X21lbV9hY2Nlc3MoKSBl
cnJvciwgbm8gdmlvbGF0aW9uIGFuZCBldmVudCBzZW5kCisgKiBlcnJvci4gQXNzdW1lcyB0aGUg
Y2FsbGVyIHdpbGwgY2hlY2sgYXJjaC52bV9ldmVudC0+c2VuZF9ldmVudC4KKyAqCisgKiBOT1RF
OiBwMm1fZ2V0X21lbV9hY2Nlc3MoKSBjYW4gZmFpbCBpZiB0aGUgZW50cnkgd2FzIG5vdCBmb3Vu
ZCBpbiB0aGUgRVBUCisgKiAoaW4gd2hpY2ggY2FzZSBhY2Nlc3MgdG8gaXQgaXMgdW5yZXN0cmlj
dGVkLCBzbyBubyB2aW9sYXRpb25zIGNhbiBvY2N1cikuCisgKiBJbiB0aGlzIGNhc2VzIGl0IGlz
IGZpbmUgdG8gY29udGludWUgdGhlIGVtdWxhdGlvbi4KKyAqLworYm9vbCBodm1fbW9uaXRvcl9j
aGVja19wMm0odW5zaWduZWQgbG9uZyBnbGEsIGdmbl90IGdmbiwgdWludDMyX3QgcGZlYywKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQxNl90IGtpbmQpCit7CisgICAgeGVubWVtX2Fj
Y2Vzc190IGFjY2VzczsKKyAgICB2bV9ldmVudF9yZXF1ZXN0X3QgcmVxID0ge307CisgICAgcGFk
ZHJfdCBncGEgPSAoZ2ZuX3RvX2dhZGRyKGdmbikgfCAoZ2xhICYgflBBR0VfTUFTSykpOworCisg
ICAgQVNTRVJUKGN1cnJlbnQtPmFyY2gudm1fZXZlbnQtPnNlbmRfZXZlbnQpOworCisgICAgY3Vy
cmVudC0+YXJjaC52bV9ldmVudC0+c2VuZF9ldmVudCA9IGZhbHNlOworCisgICAgaWYgKCBwMm1f
Z2V0X21lbV9hY2Nlc3MoY3VycmVudC0+ZG9tYWluLCBnZm4sICZhY2Nlc3MsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYWx0cDJtX3ZjcHVfaWR4KGN1cnJlbnQpKSAhPSAwICkKKyAgICAg
ICAgcmV0dXJuIGZhbHNlOworCisgICAgc3dpdGNoICggYWNjZXNzICkKKyAgICB7CisgICAgY2Fz
ZSBYRU5NRU1fYWNjZXNzX3g6CisgICAgY2FzZSBYRU5NRU1fYWNjZXNzX3J4OgorICAgICAgICBp
ZiAoIHBmZWMgJiBQRkVDX3dyaXRlX2FjY2VzcyApCisgICAgICAgICAgICByZXEudS5tZW1fYWNj
ZXNzLmZsYWdzID0gTUVNX0FDQ0VTU19SIHwgTUVNX0FDQ0VTU19XOworICAgICAgICBicmVhazsK
KworICAgIGNhc2UgWEVOTUVNX2FjY2Vzc193OgorICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19ydzoK
KyAgICAgICAgaWYgKCBwZmVjICYgUEZFQ19pbnNuX2ZldGNoICkKKyAgICAgICAgICAgIHJlcS51
Lm1lbV9hY2Nlc3MuZmxhZ3MgPSBNRU1fQUNDRVNTX1g7CisgICAgICAgIGJyZWFrOworCisgICAg
Y2FzZSBYRU5NRU1fYWNjZXNzX3I6CisgICAgY2FzZSBYRU5NRU1fYWNjZXNzX246CisgICAgICAg
IGlmICggcGZlYyAmIFBGRUNfd3JpdGVfYWNjZXNzICkKKyAgICAgICAgICAgIHJlcS51Lm1lbV9h
Y2Nlc3MuZmxhZ3MgfD0gTUVNX0FDQ0VTU19SIHwgTUVNX0FDQ0VTU19XOworICAgICAgICBpZiAo
IHBmZWMgJiBQRkVDX2luc25fZmV0Y2ggKQorICAgICAgICAgICAgcmVxLnUubWVtX2FjY2Vzcy5m
bGFncyB8PSBNRU1fQUNDRVNTX1g7CisgICAgICAgIGJyZWFrOworCisgICAgY2FzZSBYRU5NRU1f
YWNjZXNzX3d4OgorICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19yd3g6CisgICAgY2FzZSBYRU5NRU1f
YWNjZXNzX3J4MnJ3OgorICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19uMnJ3eDoKKyAgICBjYXNlIFhF
Tk1FTV9hY2Nlc3NfZGVmYXVsdDoKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAgaWYgKCAh
cmVxLnUubWVtX2FjY2Vzcy5mbGFncyApCisgICAgICAgIHJldHVybiBmYWxzZTsgLyogbm8gdmlv
bGF0aW9uICovCisKKyAgICBpZiAoIGtpbmQgPT0gbnBmZWNfa2luZF93aXRoX2dsYSApCisgICAg
ICAgIHJlcS51Lm1lbV9hY2Nlc3MuZmxhZ3MgfD0gTUVNX0FDQ0VTU19GQVVMVF9XSVRIX0dMQSB8
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVNX0FDQ0VTU19HTEFfVkFMSUQ7
CisgICAgZWxzZSBpZiAoIGtpbmQgPT0gbnBmZWNfa2luZF9pbl9ncHQgKQorICAgICAgICByZXEu
dS5tZW1fYWNjZXNzLmZsYWdzIHw9IE1FTV9BQ0NFU1NfRkFVTFRfSU5fR1BUIHwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1fQUNDRVNTX0dMQV9WQUxJRDsKKworCisgICAg
cmVxLnJlYXNvbiA9IFZNX0VWRU5UX1JFQVNPTl9NRU1fQUNDRVNTOworICAgIHJlcS51Lm1lbV9h
Y2Nlc3MuZ2ZuID0gZ2ZuX3goZ2ZuKTsKKyAgICByZXEudS5tZW1fYWNjZXNzLmdsYSA9IGdsYTsK
KyAgICByZXEudS5tZW1fYWNjZXNzLm9mZnNldCA9IGdwYSAmIH5QQUdFX01BU0s7CisKKyAgICBy
ZXR1cm4gbW9uaXRvcl90cmFwcyhjdXJyZW50LCB0cnVlLCAmcmVxKSA+PSAwOworfQorCiAvKgog
ICogTG9jYWwgdmFyaWFibGVzOgogICogbW9kZTogQwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L21tL21lbV9hY2Nlc3MuYyBiL3hlbi9hcmNoL3g4Ni9tbS9tZW1fYWNjZXNzLmMKaW5kZXggMDE0
NGY5MmI5OC4uOTRjN2YyYTgwYyAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21tL21lbV9hY2Nl
c3MuYworKysgYi94ZW4vYXJjaC94ODYvbW0vbWVtX2FjY2Vzcy5jCkBAIC0yMTAsMTAgKzIxMCwx
NiBAQCBib29sIHAybV9tZW1fYWNjZXNzX2NoZWNrKHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBsb25n
IGdsYSwKICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICB9CiAgICAgfQorCisgICAg
LyoKKyAgICAgKiBUcnkgdG8gYXZvaWQgc2VuZGluZyBhIG1lbSBldmVudC4gU3VwcHJlc3MgZXZl
bnRzIGNhdXNlZCBieSBwYWdlLXdhbGtzCisgICAgICogYnkgZW11bGF0aW5nIGJ1dCBzdGlsbCBj
aGVja2luZyBtZW1fYWNjZXNzIHZpb2xhdGlvbnMuCisgICAgICovCiAgICAgaWYgKCB2bV9ldmVu
dF9jaGVja19yaW5nKGQtPnZtX2V2ZW50X21vbml0b3IpICYmCiAgICAgICAgICBkLT5hcmNoLm1v
bml0b3IuaW5ndWVzdF9wYWdlZmF1bHRfZGlzYWJsZWQgJiYKLSAgICAgICAgIG5wZmVjLmtpbmQg
IT0gbnBmZWNfa2luZF93aXRoX2dsYSApIC8qIGRvbid0IHNlbmQgYSBtZW1fZXZlbnQgKi8KKyAg
ICAgICAgIG5wZmVjLmtpbmQgPT0gbnBmZWNfa2luZF9pbl9ncHQgKQogICAgIHsKKyAgICAgICAg
di0+YXJjaC52bV9ldmVudC0+c2VuZF9ldmVudCA9IHRydWU7CiAgICAgICAgIGh2bV9lbXVsYXRl
X29uZV92bV9ldmVudChFTVVMX0tJTkRfTk9STUFMLCBUUkFQX2ludmFsaWRfb3AsIFg4Nl9FVkVO
VF9OT19FQyk7CiAKICAgICAgICAgcmV0dXJuIHRydWU7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9hc20teDg2L2h2bS9tb25pdG9yLmggYi94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9tb25pdG9y
LmgKaW5kZXggZjFhZjRmODEyYS4uMzI1YjQ0Njc0ZCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUv
YXNtLXg4Ni9odm0vbW9uaXRvci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL21vbml0
b3IuaApAQCAtNDksNiArNDksOSBAQCB2b2lkIGh2bV9tb25pdG9yX2ludGVycnVwdCh1bnNpZ25l
ZCBpbnQgdmVjdG9yLCB1bnNpZ25lZCBpbnQgdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBlcnIsIHVpbnQ2NF90IGNyMik7CiBib29sIGh2bV9tb25pdG9yX2Vt
dWxfdW5pbXBsZW1lbnRlZCh2b2lkKTsKIAorYm9vbCBodm1fbW9uaXRvcl9jaGVja19wMm0odW5z
aWduZWQgbG9uZyBnbGEsIGdmbl90IGdmbiwgdWludDMyX3QgcGZlYywKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVpbnQxNl90IGtpbmQpOworCiAjZW5kaWYgLyogX19BU01fWDg2X0hWTV9N
T05JVE9SX0hfXyAqLwogCiAvKgpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni92bV9l
dmVudC5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni92bV9ldmVudC5oCmluZGV4IDIzZTY1NTcxMGIu
LjY2ZGI5ZTFlMjUgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvdm1fZXZlbnQuaAor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3ZtX2V2ZW50LmgKQEAgLTM2LDYgKzM2LDggQEAgc3Ry
dWN0IGFyY2hfdm1fZXZlbnQgewogICAgIGJvb2wgc2V0X2dwcnM7CiAgICAgLyogQSBzeW5jIHZt
X2V2ZW50IGhhcyBiZWVuIHNlbnQgYW5kIHdlJ3JlIG5vdCBkb25lIGhhbmRsaW5nIGl0LiAqLwog
ICAgIGJvb2wgc3luY19ldmVudDsKKyAgICAvKiBTZW5kIG1lbSBhY2Nlc3MgZXZlbnRzIGZyb20g
ZW11bGF0b3IgKi8KKyAgICBib29sIHNlbmRfZXZlbnQ7CiB9OwogCiBpbnQgdm1fZXZlbnRfaW5p
dF9kb21haW4oc3RydWN0IGRvbWFpbiAqZCk7Ci0tIAoyLjE3LjEKCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhl
bi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3Jn
L21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

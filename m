Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 708A6C1133
	for <lists+xen-devel@lfdr.de>; Sat, 28 Sep 2019 17:20:00 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEET7-0001Xv-RZ; Sat, 28 Sep 2019 15:17:09 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=eHhM=XX=amazon.de=prvs=1678a297b=wipawel@srs-us1.protection.inumbo.net>)
 id 1iEET5-0001Xf-W7
 for xen-devel@lists.xenproject.org; Sat, 28 Sep 2019 15:17:08 +0000
X-Inumbo-ID: 088399e6-e203-11e9-bf31-bc764e2007e4
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by localhost (Halon) with ESMTPS
 id 088399e6-e203-11e9-bf31-bc764e2007e4;
 Sat, 28 Sep 2019 15:17:07 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1569683827; x=1601219827;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=SCOh7uYNpBvxg78vVImipiy3W/vveYwwu2WpG6XFJzg=;
 b=lwhJMArQaAB1L+jv/heuyszTA+fZB9oV9DfpMrJWoakQ33FeTFc2uSH1
 85xdtagRuHNeo3UFDaFDTO3jtKPu4KpkoVn65dPbeEHGHIb/WXUEsKMzB
 BrxCW5o6kkvIAkAOnQlZLyVL8OC1ndKe59BfS0pFXE6fc283HmEEcTSH6 8=;
X-IronPort-AV: E=Sophos;i="5.64,559,1559520000"; d="scan'208";a="705176494"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-1a-67b371d8.us-east-1.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 28 Sep 2019 15:13:57 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1a-67b371d8.us-east-1.amazon.com (Postfix) with ESMTPS
 id 7483AA221B; Sat, 28 Sep 2019 15:13:37 +0000 (UTC)
Received: from EX13D03EUA002.ant.amazon.com (10.43.165.166) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:13:28 +0000
Received: from EX13MTAUWB001.ant.amazon.com (10.43.161.207) by
 EX13D03EUA002.ant.amazon.com (10.43.165.166) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:13:27 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.161.249) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Sat, 28 Sep 2019 15:13:23 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Sat, 28 Sep 2019 15:12:54 +0000
Message-ID: <20190928151305.127380-2-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190928151305.127380-1-wipawel@amazon.de>
References: <20190928151305.127380-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v4 01/12] livepatch: Always check hypervisor
 build ID upon livepatch upload
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBjaGFuZ2UgaXMgcGFydCBvZiBhIGluZGVwZW5kYW50IHN0YWNrZWQgbGl2ZXBhdGNoIG1v
ZHVsZXMKZmVhdHVyZS4gVGhpcyBmZWF0dXJlIGFsbG93cyB0byBieXBhc3MgZGVwZW5kZW5jaWVz
IGJldHdlZW4gbW9kdWxlcwp1cG9uIGxvYWRpbmcsIGJ1dCBzdGlsbCB2ZXJpZmllcyBYZW4gYnVp
bGQgSUQgbWF0Y2hpbmcuCgpJbiBvcmRlciB0byBwcmV2ZW50ICh1cClsb2FkaW5nIGFueSBsaXZl
cGF0Y2hlcyBidWlsdCBmb3IgZGlmZmVyZW50Cmh5cGVydmlzb3IgdmVyc2lvbiBhcyBpbmRpY2F0
ZWQgYnkgdGhlIFhlbiBCdWlsZCBJRCwgYWRkIGNoZWNraW5nIGZvcgp0aGUgcGF5bG9hZCdzIHZz
IFhlbidzIGJ1aWxkIGlkIG1hdGNoLgoKVG8gYWNoaWV2ZSB0aGF0IGVtYmVkIGludG8gZXZlcnkg
bGl2ZXBhdGNoIGFub3RoZXIgc2VjdGlvbiB3aXRoIGEKZGVkaWNhdGVkIGh5cGVydmlzb3IgYnVp
bGQgaWQgaW4gaXQuIEFmdGVyIHRoZSBwYXlsb2FkIGlzIGxvYWRlZCBhbmQKdGhlIC5saXZlcGF0
Y2gueGVuX2RlcGVuZHMgc2VjdGlvbiBiZWNvbWVzIGF2YWlsYWJsZSwgcGVyZm9ybSB0aGUKY2hl
Y2sgYW5kIHJlamVjdCB0aGUgcGF5bG9hZCBpZiB0aGVyZSBpcyBubyBtYXRjaC4KClNpZ25lZC1v
ZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpvbi5kZT4KUmV2aWV3ZWQt
Ynk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9uLmNvbT4KUmV2aWV3ZWQt
Ynk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBFc2xhbSBF
bG5pa2V0eSA8ZWxuaWtldHlAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTWFydGluIFBvaGxhY2sg
PG1wb2hsYWNrQGFtYXpvbi5kZT4KU2lnbmVkLW9mZi1ieTogS29ucmFkIFJ6ZXN6dXRlayBXaWxr
IDxrb25yYWQud2lsa0BvcmFjbGUuY29tPgpSZXZpZXdlZC1ieTogUm9zcyBMYWdlcndhbGwgPHJv
c3MubGFnZXJ3YWxsQGNpdHJpeC5jb20+Ci0tLQpDaGFuZ2VkIHNpbmNlIHYzOgogICogcmVuYW1l
ZCBjaGVja194ZW5fYnVpbGRfaWQoKSB0byB4ZW5fYnVpbGRfaWRfZGVwKCkKCkNoYW5nZWQgc2lu
Y2UgdjE6CiAgKiBhbHdheXMgcHJpbnQgWEVOTE9HX0VSUiBtZXNzYWdlIGZyb20gY2hlY2tfeGVu
X2J1aWxkX2lkKCkKICAqIGZpeCB0eXBvIGluIHRlc3QvbGl2ZXBhdGNoL01ha2VmaWxlCgogLmdp
dGlnbm9yZSAgICAgICAgICAgICAgICAgIHwgIDEgKwogZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5k
b2MgIHwgMjggKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tCiB4ZW4vY29tbW9uL2xpdmVwYXRj
aC5jICAgICAgfCA0NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysKIHhlbi9pbmNsdWRlL3hlbi9saXZlcGF0Y2guaCB8ICA3ICsrKystLS0KIHhlbi90ZXN0L2xp
dmVwYXRjaC9NYWtlZmlsZSB8IDMxICsrKysrKysrKysrKysrKysrKysrKysrKystLS0tLQogNSBm
aWxlcyBjaGFuZ2VkLCA5OCBpbnNlcnRpb25zKCspLCAxNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS8uZ2l0aWdub3JlIGIvLmdpdGlnbm9yZQppbmRleCAzYzk0N2FjOTQ4Li42ZjgzZmM4NzI4
IDEwMDY0NAotLS0gYS8uZ2l0aWdub3JlCisrKyBiLy5naXRpZ25vcmUKQEAgLTMxMiw2ICszMTIs
NyBAQCB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2J5ZV93b3JsZC5saXZlcGF0Y2gKIHhlbi90ZXN0
L2xpdmVwYXRjaC94ZW5faGVsbG9fd29ybGQubGl2ZXBhdGNoCiB4ZW4vdGVzdC9saXZlcGF0Y2gv
eGVuX25vcC5saXZlcGF0Y2gKIHhlbi90ZXN0L2xpdmVwYXRjaC94ZW5fcmVwbGFjZV93b3JsZC5s
aXZlcGF0Y2gKK3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fbm9feGVuX2J1aWxkaWQubGl2ZXBhdGNo
CiB4ZW4vdG9vbHMva2NvbmZpZy8udG1wX2d0a2NoZWNrCiB4ZW4vdG9vbHMva2NvbmZpZy8udG1w
X3F0Y2hlY2sKIHhlbi90b29scy9zeW1ib2xzCmRpZmYgLS1naXQgYS9kb2NzL21pc2MvbGl2ZXBh
dGNoLnBhbmRvYyBiL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCmluZGV4IDZkOWY3MmY0OWIu
LmZkMWY1ZDAxMjYgMTAwNjQ0Ci0tLSBhL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCisrKyBi
L2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCkBAIC0yNzAsNiArMjcwLDggQEAgbGlrZSB3aGF0
IHRoZSBMaW51eCBrZXJuZWwgbW9kdWxlIGxvYWRlciBkb2VzLgogVGhlIHBheWxvYWQgY29udGFp
bnMgYXQgbGVhc3QgdGhyZWUgc2VjdGlvbnM6CiAKICAqIGAubGl2ZXBhdGNoLmZ1bmNzYCAtIHdo
aWNoIGlzIGFuIGFycmF5IG9mIGxpdmVwYXRjaF9mdW5jIHN0cnVjdHVyZXMuCisgKiBgLmxpdmVw
YXRjaC54ZW5fZGVwZW5kc2AgLSB3aGljaCBpcyBhbiBFTEYgTm90ZSB0aGF0IGRlc2NyaWJlcyB3
aGF0IFhlbgorICAgIGJ1aWxkLWlkIHRoZSBwYXlsb2FkIGRlcGVuZHMgb24uICoqTVVTVCoqIGhh
dmUgb25lLgogICogYC5saXZlcGF0Y2guZGVwZW5kc2AgLSB3aGljaCBpcyBhbiBFTEYgTm90ZSB0
aGF0IGRlc2NyaWJlcyB3aGF0IHRoZSBwYXlsb2FkCiAgICAgZGVwZW5kcyBvbi4gKipNVVNUKiog
aGF2ZSBvbmUuCiAgKiAgYC5ub3RlLmdudS5idWlsZC1pZGAgLSB0aGUgYnVpbGQtaWQgb2YgdGhp
cyBwYXlsb2FkLiAqKk1VU1QqKiBoYXZlIG9uZS4KQEAgLTM4MywxNiArMzg1LDE2IEBAIFRoZSB0
eXBlIGRlZmluaXRpb24gb2YgdGhlIGZ1bmN0aW9uIGFyZSBhcyBmb2xsb3c6CiAgICAgdHlwZWRl
ZiB2b2lkICgqbGl2ZXBhdGNoX2xvYWRjYWxsX3QpKHZvaWQpOwogICAgIHR5cGVkZWYgdm9pZCAo
KmxpdmVwYXRjaF91bmxvYWRjYWxsX3QpKHZvaWQpOwogCi0jIyMgLmxpdmVwYXRjaC5kZXBlbmRz
IGFuZCAubm90ZS5nbnUuYnVpbGQtaWQKKyMjIyAubGl2ZXBhdGNoLnhlbl9kZXBlbmRzLCAubGl2
ZXBhdGNoLmRlcGVuZHMgYW5kIC5ub3RlLmdudS5idWlsZC1pZAogCiBUbyBzdXBwb3J0IGRlcGVu
ZGVuY2llcyBjaGVja2luZyBhbmQgc2FmZSBsb2FkaW5nICh0byBsb2FkIHRoZQogYXBwcm9waWF0
ZSBwYXlsb2FkIGFnYWluc3QgdGhlIHJpZ2h0IGh5cGVydmlzb3IpIHRoZXJlIGlzIGEgbmVlZAog
dG8gZW1iYmVkIGFuIGJ1aWxkLWlkIGRlcGVuZGVuY3kuCiAKLVRoaXMgaXMgZG9uZSBieSB0aGUg
cGF5bG9hZCBjb250YWluaW5nIGFuIHNlY3Rpb24gYC5saXZlcGF0Y2guZGVwZW5kc2AKLXdoaWNo
IGZvbGxvd3MgdGhlIGZvcm1hdCBvZiBhbiBFTEYgTm90ZS4gVGhlIGNvbnRlbnRzIG9mIHRoaXMK
LShuYW1lLCBhbmQgZGVzY3JpcHRpb24pIGFyZSBzcGVjaWZpYyB0byB0aGUgbGlua2VyIHV0aWxp
emVkIHRvCi1idWlsZCB0aGUgaHlwZXZpc29yIGFuZCBwYXlsb2FkLgorVGhpcyBpcyBkb25lIGJ5
IHRoZSBwYXlsb2FkIGNvbnRhaW5pbmcgc2VjdGlvbnMgYC5saXZlcGF0Y2gueGVuX2RlcGVuZHNg
CithbmQgYC5saXZlcGF0Y2guZGVwZW5kc2Agd2hpY2ggZm9sbG93IHRoZSBmb3JtYXQgb2YgYW4g
RUxGIE5vdGUuCitUaGUgY29udGVudHMgb2YgdGhlc2UgKG5hbWUsIGFuZCBkZXNjcmlwdGlvbikg
YXJlIHNwZWNpZmljIHRvIHRoZSBsaW5rZXIKK3V0aWxpemVkIHRvIGJ1aWxkIHRoZSBoeXBldmlz
b3IgYW5kIHBheWxvYWQuCiAKIElmIEdOVSBsaW5rZXIgaXMgdXNlZCB0aGVuIHRoZSBuYW1lIGlz
IGBHTlVgIGFuZCB0aGUgZGVzY3JpcHRpb24KIGlzIGEgTlRfR05VX0JVSUxEX0lEIHR5cGUgSUQu
IFRoZSBkZXNjcmlwdGlvbiBjYW4gYmUgYW4gU0hBMQpAQCAtNDAwLDYgKzQwMiwxMyBAQCBjaGVj
a3N1bSwgTUQ1IGNoZWNrc3VtIG9yIGFueSB1bmlxdWUgdmFsdWUuCiAKIFRoZSBzaXplIG9mIHRo
ZXNlIHN0cnVjdHVyZXMgdmFyaWVzIHdpdGggdGhlIGAtLWJ1aWxkLWlkYCBsaW5rZXIgb3B0aW9u
LgogCitUaGVyZSBhcmUgdHdvIGtpbmRzIG9mIGJ1aWxkLWlkIGRlcGVuZGVuY2llczoKKworICog
WGVuIGJ1aWxkLWlkIGRlcGVuZGVuY3kgKC5saXZlcGF0Y2gueGVuX2RlcGVuZHMgc2VjdGlvbikK
KyAqIHByZXZpb3VzIHBheWxvYWQgYnVpbGQtaWQgZGVwZW5kZW5jeSAoLmxpdmVwYXRjaC5kZXBl
bmRzIHNlY3Rpb24pCisKK1NlZSAiTGl2ZSBwYXRjaCBpbnRlcmRlcGVuZGVuY2llcyIgZm9yIG1v
cmUgaW5mb3JtYXRpb24uCisKICMjIEh5cGVyY2FsbHMKIAogV2Ugd2lsbCBlbXBsb3kgdGhlIHN1
YiBvcGVyYXRpb25zIG9mIHRoZSBzeXN0ZW0gbWFuYWdlbWVudCBoeXBlcmNhbGwgKHN5c2N0bCku
CkBAIC04OTQsMTMgKzkwMywxNiBAQCBidXQgaXMgbW9yZSBjb21wbGV4IHRvIGltcGxlbWVudC4K
IFRoZSBzZWNvbmQgb3B0aW9uIHdoaWNoIHJlcXVpcmVzIGFuIGJ1aWxkLWlkIG9mIHRoZSBoeXBl
cnZpc29yCiBpcyBpbXBsZW1lbnRlZCBpbiB0aGUgWGVuIGh5cGVydmlzb3IuCiAKLVNwZWNpZmlj
YWxseSBlYWNoIHBheWxvYWQgaGFzIHR3byBidWlsZC1pZCBFTEYgbm90ZXM6CitTcGVjaWZpY2Fs
bHkgZWFjaCBwYXlsb2FkIGhhcyB0aHJlZSBidWlsZC1pZCBFTEYgbm90ZXM6CiAgKiBUaGUgYnVp
bGQtaWQgb2YgdGhlIHBheWxvYWQgaXRzZWxmIChnZW5lcmF0ZWQgdmlhIC0tYnVpbGQtaWQpLgor
ICogVGhlIGJ1aWxkLWlkIG9mIHRoZSBYZW4gaHlwZXJ2aXNvciBpdCBkZXBlbmRzIG9uIChleHRy
YWN0ZWQgZnJvbSB0aGUKKyAgIGh5cGVydmlzb3IgZHVyaW5nIGJ1aWxkIHRpbWUpLgogICogVGhl
IGJ1aWxkLWlkIG9mIHRoZSBwYXlsb2FkIGl0IGRlcGVuZHMgb24gKGV4dHJhY3RlZCBmcm9tIHRo
ZQogICAgdGhlIHByZXZpb3VzIHBheWxvYWQgb3IgaHlwZXJ2aXNvciBkdXJpbmcgYnVpbGQgdGlt
ZSkuCiAKLVRoaXMgbWVhbnMgdGhhdCB0aGUgdmVyeSBmaXJzdCBwYXlsb2FkIGRlcGVuZHMgb24g
dGhlIGh5cGVydmlzb3IKLWJ1aWxkLWlkLgorVGhpcyBtZWFucyB0aGF0IGV2ZXJ5IHBheWxvYWQg
ZGVwZW5kcyBvbiB0aGUgaHlwZXJ2aXNvciBidWlsZC1pZCBhbmQgb24KK3RoZSBidWlsZC1pZCBv
ZiB0aGUgcHJldmlvdXMgcGF5bG9hZCBpbiB0aGUgc3RhY2suCitUaGUgdmVyeSBmaXJzdCBwYXls
b2FkIGRlcGVuZHMgb24gdGhlIGh5cGVydmlzb3IgYnVpbGQtaWQgb25seS4KIAogIyBOb3QgWWV0
IERvbmUKIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9saXZlcGF0Y2guYyBiL3hlbi9jb21tb24v
bGl2ZXBhdGNoLmMKaW5kZXggN2NhYTMwYzIwMi4uMTYzYzljNzllYSAxMDA2NDQKLS0tIGEveGVu
L2NvbW1vbi9saXZlcGF0Y2guYworKysgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCkBAIC03NCw2
ICs3NCw3IEBAIHN0cnVjdCBwYXlsb2FkIHsKICAgICB1bnNpZ25lZCBpbnQgbnN5bXM7ICAgICAg
ICAgICAgICAgICAgLyogTnIgb2YgZW50cmllcyBpbiAuc3RydGFiIGFuZCBzeW1ib2xzLiAqLwog
ICAgIHN0cnVjdCBsaXZlcGF0Y2hfYnVpbGRfaWQgaWQ7ICAgICAgICAvKiBFTEZOT1RFX0RFU0Mo
Lm5vdGUuZ251LmJ1aWxkLWlkKSBvZiB0aGUgcGF5bG9hZC4gKi8KICAgICBzdHJ1Y3QgbGl2ZXBh
dGNoX2J1aWxkX2lkIGRlcDsgICAgICAgLyogRUxGTk9URV9ERVNDKC5saXZlcGF0Y2guZGVwZW5k
cykuICovCisgICAgc3RydWN0IGxpdmVwYXRjaF9idWlsZF9pZCB4ZW5fZGVwOyAgIC8qIEVMRk5P
VEVfREVTQygubGl2ZXBhdGNoLnhlbl9kZXBlbmRzKS4gKi8KICAgICBsaXZlcGF0Y2hfbG9hZGNh
bGxfdCAqY29uc3QgKmxvYWRfZnVuY3M7ICAgLyogVGhlIGFycmF5IG9mIGZ1bmNzIHRvIGNhbGwg
YWZ0ZXIgKi8KICAgICBsaXZlcGF0Y2hfdW5sb2FkY2FsbF90ICpjb25zdCAqdW5sb2FkX2Z1bmNz
Oy8qIGxvYWQgYW5kIHVubG9hZCBvZiB0aGUgcGF5bG9hZC4gKi8KICAgICB1bnNpZ25lZCBpbnQg
bl9sb2FkX2Z1bmNzOyAgICAgICAgICAgLyogTnIgb2YgdGhlIGZ1bmNzIHRvIGxvYWQgYW5kIGV4
ZWN1dGUuICovCkBAIC00NzYsMTEgKzQ3NywzNCBAQCBzdGF0aWMgYm9vbCBzZWN0aW9uX29rKGNv
bnN0IHN0cnVjdCBsaXZlcGF0Y2hfZWxmICplbGYsCiAgICAgcmV0dXJuIHRydWU7CiB9CiAKK3N0
YXRpYyBpbnQgeGVuX2J1aWxkX2lkX2RlcChjb25zdCBzdHJ1Y3QgcGF5bG9hZCAqcGF5bG9hZCkK
K3sKKyAgICBjb25zdCB2b2lkICppZCA9IE5VTEw7CisgICAgdW5zaWduZWQgaW50IGxlbiA9IDA7
CisgICAgaW50IHJjOworCisgICAgQVNTRVJUKHBheWxvYWQtPnhlbl9kZXAubGVuKTsKKyAgICBB
U1NFUlQocGF5bG9hZC0+eGVuX2RlcC5wKTsKKworICAgIHJjID0geGVuX2J1aWxkX2lkKCZpZCwg
Jmxlbik7CisgICAgaWYgKCByYyApCisgICAgICAgIHJldHVybiByYzsKKworICAgIGlmICggcGF5
bG9hZC0+eGVuX2RlcC5sZW4gIT0gbGVuIHx8IG1lbWNtcChpZCwgcGF5bG9hZC0+eGVuX2RlcC5w
LCBsZW4pICkgeworICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVzOiBjaGVj
ayBhZ2FpbnN0IGh5cGVydmlzb3IgYnVpbGQtaWQgZmFpbGVkXG4iLAorICAgICAgICAgICAgICAg
cGF5bG9hZC0+bmFtZSk7CisgICAgICAgIHJldHVybiAtRUlOVkFMOworICAgIH0KKworICAgIHJl
dHVybiAwOworfQorCiBzdGF0aWMgaW50IGNoZWNrX3NwZWNpYWxfc2VjdGlvbnMoY29uc3Qgc3Ry
dWN0IGxpdmVwYXRjaF9lbGYgKmVsZikKIHsKICAgICB1bnNpZ25lZCBpbnQgaTsKICAgICBzdGF0
aWMgY29uc3QgY2hhciAqY29uc3QgbmFtZXNbXSA9IHsgRUxGX0xJVkVQQVRDSF9GVU5DLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFTEZfTElWRVBBVENIX0RFUEVO
RFMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVMRl9MSVZFUEFU
Q0hfWEVOX0RFUEVORFMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IEVMRl9CVUlMRF9JRF9OT1RFfTsKICAgICBERUNMQVJFX0JJVE1BUChmb3VuZCwgQVJSQVlfU0la
RShuYW1lcykpID0geyAwIH07CiAKQEAgLTYzMiw2ICs2NTYsMjIgQEAgc3RhdGljIGludCBwcmVw
YXJlX3BheWxvYWQoc3RydWN0IHBheWxvYWQgKnBheWxvYWQsCiAgICAgICAgICAgICByZXR1cm4g
LUVJTlZBTDsKICAgICB9CiAKKyAgICBzZWMgPSBsaXZlcGF0Y2hfZWxmX3NlY19ieV9uYW1lKGVs
ZiwgRUxGX0xJVkVQQVRDSF9YRU5fREVQRU5EUyk7CisgICAgaWYgKCBzZWMgKQorICAgIHsKKyAg
ICAgICAgbiA9IHNlYy0+bG9hZF9hZGRyOworCisgICAgICAgIGlmICggc2VjLT5zZWMtPnNoX3Np
emUgPD0gc2l6ZW9mKCpuKSApCisgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKworICAgICAg
ICBpZiAoIHhlbl9idWlsZF9pZF9jaGVjayhuLCBzZWMtPnNlYy0+c2hfc2l6ZSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJnBheWxvYWQtPnhlbl9kZXAucCwgJnBheWxvYWQtPnhl
bl9kZXAubGVuKSApCisgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKworICAgICAgICBpZiAo
ICFwYXlsb2FkLT54ZW5fZGVwLmxlbiB8fCAhcGF5bG9hZC0+eGVuX2RlcC5wICkKKyAgICAgICAg
ICAgIHJldHVybiAtRUlOVkFMOworICAgIH0KKwogICAgIC8qIFNldHVwIHRoZSB2aXJ0dWFsIHJl
Z2lvbiB3aXRoIHByb3BlciBkYXRhLiAqLwogICAgIHJlZ2lvbiA9ICZwYXlsb2FkLT5yZWdpb247
CiAKQEAgLTg4Miw2ICs5MjIsMTAgQEAgc3RhdGljIGludCBsb2FkX3BheWxvYWRfZGF0YShzdHJ1
Y3QgcGF5bG9hZCAqcGF5bG9hZCwgdm9pZCAqcmF3LCBzaXplX3QgbGVuKQogICAgIGlmICggcmMg
KQogICAgICAgICBnb3RvIG91dDsKIAorICAgIHJjID0geGVuX2J1aWxkX2lkX2RlcChwYXlsb2Fk
KTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgZ290byBvdXQ7CisKICAgICByYyA9IGJ1aWxkX3N5
bWJvbF90YWJsZShwYXlsb2FkLCAmZWxmKTsKICAgICBpZiAoIHJjICkKICAgICAgICAgZ290byBv
dXQ7CkBAIC0xNjU1LDYgKzE2OTksOSBAQCBzdGF0aWMgdm9pZCBsaXZlcGF0Y2hfcHJpbnRhbGwo
dW5zaWduZWQgY2hhciBrZXkpCiAKICAgICAgICAgaWYgKCBkYXRhLT5kZXAubGVuICkKICAgICAg
ICAgICAgIHByaW50aygiZGVwZW5kLW9uPSUqcGhOXG4iLCBkYXRhLT5kZXAubGVuLCBkYXRhLT5k
ZXAucCk7CisKKyAgICAgICAgaWYgKCBkYXRhLT54ZW5fZGVwLmxlbiApCisgICAgICAgICAgICBw
cmludGsoImRlcGVuZC1vbi14ZW49JSpwaE5cbiIsIGRhdGEtPnhlbl9kZXAubGVuLCBkYXRhLT54
ZW5fZGVwLnApOwogICAgIH0KIAogICAgIHNwaW5fdW5sb2NrKCZwYXlsb2FkX2xvY2spOwpkaWZm
IC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL2xpdmVwYXRjaC5oIGIveGVuL2luY2x1ZGUveGVuL2xp
dmVwYXRjaC5oCmluZGV4IDFiMTgxN2NhMGQuLmVkOTk3YWE0Y2MgMTAwNjQ0Ci0tLSBhL3hlbi9p
bmNsdWRlL3hlbi9saXZlcGF0Y2guaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vbGl2ZXBhdGNoLmgK
QEAgLTI5LDkgKzI5LDEwIEBAIHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9vcDsKIC8qIENv
bnZlbmllbmNlIGRlZmluZSBmb3IgcHJpbnRrLiAqLwogI2RlZmluZSBMSVZFUEFUQ0ggICAgICAg
ICAgICAgImxpdmVwYXRjaDogIgogLyogRUxGIHBheWxvYWQgc3BlY2lhbCBzZWN0aW9uIG5hbWVz
LiAqLwotI2RlZmluZSBFTEZfTElWRVBBVENIX0ZVTkMgICAgIi5saXZlcGF0Y2guZnVuY3MiCi0j
ZGVmaW5lIEVMRl9MSVZFUEFUQ0hfREVQRU5EUyAiLmxpdmVwYXRjaC5kZXBlbmRzIgotI2RlZmlu
ZSBFTEZfQlVJTERfSURfTk9URSAgICAgICIubm90ZS5nbnUuYnVpbGQtaWQiCisjZGVmaW5lIEVM
Rl9MSVZFUEFUQ0hfRlVOQyAgICAgICAgIi5saXZlcGF0Y2guZnVuY3MiCisjZGVmaW5lIEVMRl9M
SVZFUEFUQ0hfREVQRU5EUyAgICAgIi5saXZlcGF0Y2guZGVwZW5kcyIKKyNkZWZpbmUgRUxGX0xJ
VkVQQVRDSF9YRU5fREVQRU5EUyAiLmxpdmVwYXRjaC54ZW5fZGVwZW5kcyIKKyNkZWZpbmUgRUxG
X0JVSUxEX0lEX05PVEUgICAgICAgICAiLm5vdGUuZ251LmJ1aWxkLWlkIgogLyogQXJiaXRyYXJ5
IGxpbWl0IGZvciBwYXlsb2FkIHNpemUgYW5kIC5ic3Mgc2VjdGlvbiBzaXplLiAqLwogI2RlZmlu
ZSBMSVZFUEFUQ0hfTUFYX1NJWkUgICAgIE1CKDIpCiAKZGlmZiAtLWdpdCBhL3hlbi90ZXN0L2xp
dmVwYXRjaC9NYWtlZmlsZSBiL3hlbi90ZXN0L2xpdmVwYXRjaC9NYWtlZmlsZQppbmRleCA2ODMx
MzgzZGIxLi45MzhhZWUxN2VjIDEwMDY0NAotLS0gYS94ZW4vdGVzdC9saXZlcGF0Y2gvTWFrZWZp
bGUKKysrIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL01ha2VmaWxlCkBAIC0xOSwxMSArMTksMTMgQEAg
TElWRVBBVENIIDo9IHhlbl9oZWxsb193b3JsZC5saXZlcGF0Y2gKIExJVkVQQVRDSF9CWUUgOj0g
eGVuX2J5ZV93b3JsZC5saXZlcGF0Y2gKIExJVkVQQVRDSF9SRVBMQUNFIDo9IHhlbl9yZXBsYWNl
X3dvcmxkLmxpdmVwYXRjaAogTElWRVBBVENIX05PUCA6PSB4ZW5fbm9wLmxpdmVwYXRjaAorTElW
RVBBVENIX05PX1hFTl9CVUlMRElEIDo9IHhlbl9ub194ZW5fYnVpbGRpZC5saXZlcGF0Y2gKIAog
TElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0gpCiBMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9C
WUUpCiBMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9SRVBMQUNFKQogTElWRVBBVENIRVMgKz0g
JChMSVZFUEFUQ0hfTk9QKQorTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfTk9fWEVOX0JVSUxE
SUQpCiAKIExJVkVQQVRDSF9ERUJVR19ESVIgPz0gJChERUJVR19ESVIpL3hlbi1saXZlcGF0Y2gK
IApAQCAtNTksNyArNjEsNyBAQCBjb25maWcuaDogeGVuX2hlbGxvX3dvcmxkX2Z1bmMubwogeGVu
X2hlbGxvX3dvcmxkLm86IGNvbmZpZy5oCiAKIC5QSE9OWTogJChMSVZFUEFUQ0gpCi0kKExJVkVQ
QVRDSCk6IHhlbl9oZWxsb193b3JsZF9mdW5jLm8geGVuX2hlbGxvX3dvcmxkLm8gbm90ZS5vCisk
KExJVkVQQVRDSCk6IHhlbl9oZWxsb193b3JsZF9mdW5jLm8geGVuX2hlbGxvX3dvcmxkLm8gbm90
ZS5vIHhlbl9ub3RlLm8KIAkkKExEKSAkKExERkxBR1MpICQoYnVpbGRfaWRfbGlua2VyKSAtciAt
byAkKExJVkVQQVRDSCkgJF4KIAogIwpAQCAtNzgsNiArODAsMTcgQEAgbm90ZS5vOgogCQkgICAt
LXJlbmFtZS1zZWN0aW9uPS5kYXRhPS5saXZlcGF0Y2guZGVwZW5kcyxhbGxvYyxsb2FkLHJlYWRv
bmx5LGRhdGEsY29udGVudHMgLVMgJEAuYmluICRACiAJcm0gLWYgJEAuYmluCiAKKyMKKyMgQXBw
ZW5kIC5saXZlcGF0Y2gueGVuX2RlcGVuZHMgc2VjdGlvbgorIyB3aXRoIFhlbiBidWlsZC1pZCBk
ZXJpdmVkIGZyb20geGVuLXN5bXMuCisjCisuUEhPTlk6IHhlbl9ub3RlLm8KK3hlbl9ub3RlLm86
CisJJChPQkpDT1BZKSAtTyBiaW5hcnkgLS1vbmx5LXNlY3Rpb249Lm5vdGUuZ251LmJ1aWxkLWlk
ICQoQkFTRURJUikveGVuLXN5bXMgJEAuYmluCisJJChPQkpDT1BZKSAkKE9CSkNPUFlfTUFHSUMp
IFwKKwkJICAgLS1yZW5hbWUtc2VjdGlvbj0uZGF0YT0ubGl2ZXBhdGNoLnhlbl9kZXBlbmRzLGFs
bG9jLGxvYWQscmVhZG9ubHksZGF0YSxjb250ZW50cyAtUyAkQC5iaW4gJEAKKwlybSAtZiAkQC5i
aW4KKwogIwogIyBFeHRyYWN0IHRoZSBidWlsZC1pZCBvZiB0aGUgeGVuX2hlbGxvX3dvcmxkLmxp
dmVwYXRjaAogIyAod2hpY2ggeGVuX2J5ZV93b3JsZCB3aWxsIGRlcGVuZCBvbikuCkBAIC05Miwy
MCArMTA1LDI4IEBAIGhlbGxvX3dvcmxkX25vdGUubzogJChMSVZFUEFUQ0gpCiB4ZW5fYnllX3dv
cmxkLm86IGNvbmZpZy5oCiAKIC5QSE9OWTogJChMSVZFUEFUQ0hfQllFKQotJChMSVZFUEFUQ0hf
QllFKTogeGVuX2J5ZV93b3JsZF9mdW5jLm8geGVuX2J5ZV93b3JsZC5vIGhlbGxvX3dvcmxkX25v
dGUubworJChMSVZFUEFUQ0hfQllFKTogeGVuX2J5ZV93b3JsZF9mdW5jLm8geGVuX2J5ZV93b3Js
ZC5vIGhlbGxvX3dvcmxkX25vdGUubyB4ZW5fbm90ZS5vCiAJJChMRCkgJChMREZMQUdTKSAkKGJ1
aWxkX2lkX2xpbmtlcikgLXIgLW8gJChMSVZFUEFUQ0hfQllFKSAkXgogCiB4ZW5fcmVwbGFjZV93
b3JsZC5vOiBjb25maWcuaAogCiAuUEhPTlk6ICQoTElWRVBBVENIX1JFUExBQ0UpCi0kKExJVkVQ
QVRDSF9SRVBMQUNFKTogeGVuX3JlcGxhY2Vfd29ybGRfZnVuYy5vIHhlbl9yZXBsYWNlX3dvcmxk
Lm8gbm90ZS5vCiskKExJVkVQQVRDSF9SRVBMQUNFKTogeGVuX3JlcGxhY2Vfd29ybGRfZnVuYy5v
IHhlbl9yZXBsYWNlX3dvcmxkLm8gbm90ZS5vIHhlbl9ub3RlLm8KIAkkKExEKSAkKExERkxBR1Mp
ICQoYnVpbGRfaWRfbGlua2VyKSAtciAtbyAkKExJVkVQQVRDSF9SRVBMQUNFKSAkXgogCiB4ZW5f
bm9wLm86IGNvbmZpZy5oCiAKIC5QSE9OWTogJChMSVZFUEFUQ0hfTk9QKQotJChMSVZFUEFUQ0hf
Tk9QKTogeGVuX25vcC5vIG5vdGUubworJChMSVZFUEFUQ0hfTk9QKTogeGVuX25vcC5vIG5vdGUu
byB4ZW5fbm90ZS5vCiAJJChMRCkgJChMREZMQUdTKSAkKGJ1aWxkX2lkX2xpbmtlcikgLXIgLW8g
JChMSVZFUEFUQ0hfTk9QKSAkXgogCisjIFRoaXMgb25lIGFsd2F5cyBmYWlscyB1cG9uIHVwbG9h
ZCwgYmVjYXVzZSBpdCBkZWxpYmVyYXRlbHkKKyMgZG9lcyBub3QgaGF2ZSBhIC5saXZlcGF0Y2gu
eGVuX2RlcGVuZHMgKHhlbl9ub3RlLm8pIHNlY3Rpb24uCit4ZW5fbm9feGVuX2J1aWxkaWQubzog
Y29uZmlnLmgKKworLlBIT05ZOiAkKExJVkVQQVRDSF9OT19YRU5fQlVJTERJRCkKKyQoTElWRVBB
VENIX05PX1hFTl9CVUlMRElEKTogeGVuX25vcC5vIG5vdGUubworCSQoTEQpICQoTERGTEFHUykg
JChidWlsZF9pZF9saW5rZXIpIC1yIC1vICQoTElWRVBBVENIX05PX1hFTl9CVUlMRElEKSAkXgor
CiAuUEhPTlk6IGxpdmVwYXRjaAotbGl2ZXBhdGNoOiAkKExJVkVQQVRDSCkgJChMSVZFUEFUQ0hf
QllFKSAkKExJVkVQQVRDSF9SRVBMQUNFKSAkKExJVkVQQVRDSF9OT1ApCitsaXZlcGF0Y2g6ICQo
TElWRVBBVENIKSAkKExJVkVQQVRDSF9CWUUpICQoTElWRVBBVENIX1JFUExBQ0UpICQoTElWRVBB
VENIX05PUCkgJChMSVZFUEFUQ0hfTk9fWEVOX0JVSUxESUQpCi0tIAoyLjE2LjUKCgoKCkFtYXpv
biBEZXZlbG9wbWVudCBDZW50ZXIgR2VybWFueSBHbWJICktyYXVzZW5zdHIuIDM4CjEwMTE3IEJl
cmxpbgpHZXNjaGFlZnRzZnVlaHJ1bmc6IENocmlzdGlhbiBTY2hsYWVnZXIsIFJhbGYgSGVyYnJp
Y2gKRWluZ2V0cmFnZW4gYW0gQW10c2dlcmljaHQgQ2hhcmxvdHRlbmJ1cmcgdW50ZXIgSFJCIDE0
OTE3MyBCClNpdHo6IEJlcmxpbgpVc3QtSUQ6IERFIDI4OSAyMzcgODc5CgoKCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBs
aXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2pl
Y3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

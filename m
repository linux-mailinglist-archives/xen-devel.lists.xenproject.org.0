Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B4BDDFE601
	for <lists+xen-devel@lfdr.de>; Fri, 15 Nov 2019 20:48:59 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVhXs-00022d-8i; Fri, 15 Nov 2019 19:46:16 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=1SQg=ZH=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iVhXq-00021M-Hr
 for xen-devel@lists.xenproject.org; Fri, 15 Nov 2019 19:46:14 +0000
X-Inumbo-ID: 73c0f976-07e0-11ea-b678-bc764e2007e4
Received: from mail-qt1-x833.google.com (unknown [2607:f8b0:4864:20::833])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 73c0f976-07e0-11ea-b678-bc764e2007e4;
 Fri, 15 Nov 2019 19:45:18 +0000 (UTC)
Received: by mail-qt1-x833.google.com with SMTP id i17so12035748qtq.1
 for <xen-devel@lists.xenproject.org>; Fri, 15 Nov 2019 11:45:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=IXvx47m66UhvbKvr6aI7mWEKFmqZRWq+GoUkFVW16gk=;
 b=Dhq5kanyFlBro3LUbInWbnmwkYSzt+OzsWKzdTiwd9I6FixOpdA9lM+BVbsUhZEpPd
 U0zz0Kz/1gKxgtM6kwJsnyhVe/07qbR9LenWKGGLGKgJQaG65bK3v2XNdWq3cXavQI9N
 cybWed1+u8y69tVIdOlK1m3R1TgSNZtvRoMOMWB57BDYn6FRJ9zlbzSndd+UI/WCThk5
 +zx04RtNBFSQKkjrzhwtM/k1QR/uiVhUEGmH9BnVqsILEXI1EKKF0ph45Nsw0NaRtdf0
 qetEbc11rbsdifsC8O24CJZe+3iFmsmd/5IfrOuxe+8jfDN8qvPQETmKD/cEvXWq8Khf
 68ow==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=IXvx47m66UhvbKvr6aI7mWEKFmqZRWq+GoUkFVW16gk=;
 b=VYdwif2vx7tq47MwGuFe58kscvtrwhCBQNFLPvToaDaVd92sFmnJSgnDNG6h3NEkl9
 Hr2tIb87OM4TLpxisAbSLktqVRnQg5eFhOu+sDyanXuqZ4GTyRdq7pbJYDoVNZb3nycp
 0fz0iO7bDIXRFTR3PJjSxidROGecnbdmOSL3EGCGuhqaxcXglDFOHws30E5u31EePpx5
 eqG0kqE+SJc92ZyYoluPoV7MCa3CwVity8GKtW7ChB7rnUGSbotkwDMEYuYqaSCIKuvn
 JPty1z7S91DjB2FuWWtD9AzJ3YEhSVEsC+zIVkjRjGlxRLXkEsoTE7V5X3mBXum0cSo0
 j/Sw==
X-Gm-Message-State: APjAAAV8A9E/qB0y30HnvTnFTVSQScldM6jW2bl5EuQUupY8ya9oJ9WN
 KIQrmUObzVGaixweYjTtPYIfCZsm
X-Google-Smtp-Source: APXvYqzpFq8WMep/B3duyiAtSuJq1nc8FXMl2XiKfZEE6kzZ8ZYGXS7W90kNrwWccqTom+BdI9imcw==
X-Received: by 2002:ac8:3a66:: with SMTP id w93mr15931943qte.128.1573847116954; 
 Fri, 15 Nov 2019 11:45:16 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id y10sm4649679qkb.55.2019.11.15.11.45.15
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 15 Nov 2019 11:45:16 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 15 Nov 2019 14:44:22 -0500
Message-Id: <472334f58bc435e505ad6bc392426960630fb060.1573840474.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1573840473.git.rosbrookn@ainfosec.com>
References: <cover.1573840473.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 15/22] golang/xenlight: begin C to Go type
 marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KCkltcGxlbWVudCBi
YXNpYyB0eXBlIGNvbnZlcnNpb24gaW4gZnJvbUMgZnVuY3Rpb25zIHN1Y2ggYXMgc3RyaW5ncyBh
bmQKaW50ZWdlciB0eXBlcy4gQWxzbywgcmVtb3ZlIGV4aXN0aW5nIHRvR28gZnVuY3Rpb25zIGZy
b20geGVubGlnaHQuZ28gaW4KZmF2b3Igb2YgdGhlIG5ldyBnZW5lcmF0ZWQgZnVuY3Rpb25zLgoK
U2lnbmVkLW9mZi1ieTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KLS0t
CkNoYW5nZXMgaW4gdjI6Ci0gQWRkIE1ha2VmaWxlIGNoYW5nZXMgZm9yIGhlbHBlcnMuZ2VuLmdv
LgotIFJlLWdlbmVyYXRlIGhlbHBlcnMuZ2VuLmdvIHRvIGluY2x1ZGUgbGlieGwgY2hhbmdlcyBh
ZnRlciByZWJhc2UuCgogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L01ha2VmaWxlICAgICAgIHwgICAy
ICsKIHRvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5ICB8IDEyMCArKysrCiB0b29s
cy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28gfCA5NjkgKysrKysrKysrKysrKysrKysr
KysrKysrKysrCiB0b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28gICAgfCAxMTEgKy0t
CiA0IGZpbGVzIGNoYW5nZWQsIDExMDIgaW5zZXJ0aW9ucygrKSwgMTAwIGRlbGV0aW9ucygtKQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IHRvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwoK
ZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9NYWtlZmlsZSBiL3Rvb2xzL2dvbGFu
Zy94ZW5saWdodC9NYWtlZmlsZQppbmRleCA2ODFmMzJjMjM0Li4wN2I4ODk2ZTViIDEwMDY0NAot
LS0gYS90b29scy9nb2xhbmcveGVubGlnaHQvTWFrZWZpbGUKKysrIGIvdG9vbHMvZ29sYW5nL3hl
bmxpZ2h0L01ha2VmaWxlCkBAIC0xOSw2ICsxOSw3IEBAICQoWEVOX0dPUEFUSCkvc3JjLyQoWEVO
X0dPQ09ERV9VUkwpL3hlbmxpZ2h0LzogJS5nZW4uZ28KIAkkKElOU1RBTExfRElSKSAkKFhFTl9H
T1BBVEgpJChHT1hMX1BLR19ESVIpCiAJJChJTlNUQUxMX0RBVEEpIHhlbmxpZ2h0LmdvICQoWEVO
X0dPUEFUSCkkKEdPWExfUEtHX0RJUikKIAkkKElOU1RBTExfREFUQSkgdHlwZXMuZ2VuLmdvICQo
WEVOX0dPUEFUSCkkKEdPWExfUEtHX0RJUikKKwkkKElOU1RBTExfREFUQSkgaGVscGVycy5nZW4u
Z28gJChYRU5fR09QQVRIKSQoR09YTF9QS0dfRElSKQogCiAlLmdlbi5nbzogZ2VuZ290eXBlcy5w
eSAkKFhFTl9ST09UKS90b29scy9saWJ4bC9saWJ4bF90eXBlcy5pZGwgJChYRU5fUk9PVCkvdG9v
bHMvbGlieGwvaWRsLnB5CiAJWEVOX1JPT1Q9JChYRU5fUk9PVCkgJChQWVRIT04pIGdlbmdvdHlw
ZXMucHkgLi4vLi4vbGlieGwvbGlieGxfdHlwZXMuaWRsCkBAIC0zOSw2ICs0MCw3IEBAIGluc3Rh
bGw6IGJ1aWxkCiAJJChJTlNUQUxMX0RJUikgJChERVNURElSKSQoR09YTF9JTlNUQUxMX0RJUikK
IAkkKElOU1RBTExfREFUQSkgJChYRU5fR09QQVRIKSQoR09YTF9QS0dfRElSKXhlbmxpZ2h0Lmdv
ICQoREVTVERJUikkKEdPWExfSU5TVEFMTF9ESVIpCiAJJChJTlNUQUxMX0RBVEEpICQoWEVOX0dP
UEFUSCkkKEdPWExfUEtHX0RJUil0eXBlcy5nZW4uZ28gJChERVNURElSKSQoR09YTF9JTlNUQUxM
X0RJUikKKwkkKElOU1RBTExfREFUQSkgJChYRU5fR09QQVRIKSQoR09YTF9QS0dfRElSKWhlbHBl
cnMuZ2VuLmdvICQoREVTVERJUikkKEdPWExfSU5TVEFMTF9ESVIpCiAKIC5QSE9OWTogdW5pbnN0
YWxsCiAJcm0gLXJmICQoREVTVERJUikkKEdPWExfSU5TVEFMTF9ESVIpCmRpZmYgLS1naXQgYS90
b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSBiL3Rvb2xzL2dvbGFuZy94ZW5saWdo
dC9nZW5nb3R5cGVzLnB5CmluZGV4IDg5NjNiMTRlZWUuLjBjOGExMzI3YTEgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CisrKyBiL3Rvb2xzL2dvbGFuZy94
ZW5saWdodC9nZW5nb3R5cGVzLnB5CkBAIC0xOCw2ICsxOCwxMiBAQCBidWlsdGluX3R5cGVfbmFt
ZXMgPSB7CiAgICAgaWRsLnVpbnQ2NC50eXBlbmFtZTogJ3VpbnQ2NCcsCiB9CiAKKyMgU29tZSBn
byBrZXl3b3JkcyB0aGF0IGNvbmZsaWN0IHdpdGggZmllbGQgbmFtZXMgaW4gbGlieGwgc3RydWN0
cy4KK2dvX2tleXdvcmRzID0gWyd0eXBlJywgJ2Z1bmMnXQorCitnb19idWlsdGluX3R5cGVzID0g
Wydib29sJywgJ3N0cmluZycsICdpbnQnLCAnYnl0ZScsCisgICAgICAgICAgICAgICAgICAgICd1
aW50MTYnLCAndWludDMyJywgJ3VpbnQ2NCddCisKIGRlZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJh
dGVfdHlwZXMocGF0aCA9IE5vbmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAg
ICIiIgogICAgIEdlbmVyYXRlIGEgLmdvIGZpbGUgKHR5cGVzLmdlbi5nbyBieSBkZWZhdWx0KQpA
QCAtMTc2LDYgKzE4MiwxMTggQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfdW5pb24odHkg
PSBOb25lLCBzdHJ1Y3RuYW1lID0gJycpOgogCiAgICAgcmV0dXJuIChzLGV4dHJhcykKIAorZGVm
IHhlbmxpZ2h0X2dvbGFuZ19nZW5lcmF0ZV9oZWxwZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5v
bmUsIGNvbW1lbnQgPSBOb25lKToKKyAgICAiIiIKKyAgICBHZW5lcmF0ZSBhIC5nbyBmaWxlICho
ZWxwZXJzLmdlbi5nbyBieSBkZWZhdWx0KQorICAgIHRoYXQgY29udGFpbnMgaGVscGVyIGZ1bmN0
aW9ucyBmb3IgbWFyc2hhbGluZyBiZXR3ZWVuCisgICAgQyBhbmQgR28gdHlwZXMuCisgICAgIiIi
CisgICAgaWYgcGF0aCBpcyBOb25lOgorICAgICAgICBwYXRoID0gJ2hlbHBlcnMuZ2VuLmdvJwor
CisgICAgd2l0aCBvcGVuKHBhdGgsICd3JykgYXMgZjoKKyAgICAgICAgaWYgY29tbWVudCBpcyBu
b3QgTm9uZToKKyAgICAgICAgICAgIGYud3JpdGUoY29tbWVudCkKKyAgICAgICAgZi53cml0ZSgn
cGFja2FnZSB4ZW5saWdodFxuJykKKworICAgICAgICAjIENnbyBwcmVhbWJsZQorICAgICAgICBm
LndyaXRlKCcvKlxuJykKKyAgICAgICAgZi53cml0ZSgnI2NnbyBMREZMQUdTOiAtbHhlbmxpZ2h0
XG4nKQorICAgICAgICBmLndyaXRlKCcjaW5jbHVkZSA8c3RkbGliLmg+XG4nKQorICAgICAgICBm
LndyaXRlKCcjaW5jbHVkZSA8bGlieGwuaD5cbicpCisgICAgICAgIGYud3JpdGUoJ1xuJykKKwor
ICAgICAgICBmLndyaXRlKCcqL1xuaW1wb3J0ICJDIlxuJykKKworICAgICAgICBmb3IgdHkgaW4g
dHlwZXM6CisgICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh0eSwgaWRsLlN0cnVjdCk6Cisg
ICAgICAgICAgICAgICAgY29udGludWUKKworICAgICAgICAgICAgZi53cml0ZSh4ZW5saWdodF9n
b2xhbmdfZGVmaW5lX2Zyb21fQyh0eSkpCisgICAgICAgICAgICBmLndyaXRlKCdcbicpCisKKyAg
ICBnb19mbXQocGF0aCkKKworZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5ID0g
Tm9uZSwgdHlwZW5hbWUgPSBOb25lLCBuZXN0ZWQgPSBGYWxzZSk6CisgICAgcyA9ICcnCisKKyAg
ICBnb3R5cGVuYW1lID0gY3R5cGVuYW1lID0gJycKKworICAgIGlmIHR5cGVuYW1lIGlzIG5vdCBO
b25lOgorICAgICAgICBnb3R5cGVuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKHR5cGVu
YW1lKQorICAgICAgICBjdHlwZW5hbWUgID0gdHlwZW5hbWUKKyAgICBlbHNlOgorICAgICAgICBn
b3R5cGVuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKHR5LnR5cGVuYW1lKQorICAgICAg
ICBjdHlwZW5hbWUgID0gdHkudHlwZW5hbWUKKworICAgIGlmIG5vdCBuZXN0ZWQ6CisgICAgICAg
IHMgKz0gJ2Z1bmMgKHggKnt9KSBmcm9tQyh4YyAqQy57fSkgZXJyb3Ige3tcbicuZm9ybWF0KGdv
dHlwZW5hbWUsY3R5cGVuYW1lKQorCisgICAgZm9yIGYgaW4gdHkuZmllbGRzOgorICAgICAgICBp
ZiBmLnR5cGUudHlwZW5hbWUgaXMgbm90IE5vbmU6CisgICAgICAgICAgICBpZiBpc2luc3RhbmNl
KGYudHlwZSwgaWRsLkFycmF5KToKKyAgICAgICAgICAgICAgICAjIFRPRE8KKyAgICAgICAgICAg
ICAgICBjb250aW51ZQorCisgICAgICAgICAgICBnb3R5cGVuYW1lID0geGVubGlnaHRfZ29sYW5n
X2ZtdF9uYW1lKGYudHlwZS50eXBlbmFtZSkKKyAgICAgICAgICAgIGdvZm5hbWUgICAgPSB4ZW5s
aWdodF9nb2xhbmdfZm10X25hbWUoZi5uYW1lKQorICAgICAgICAgICAgY2ZuYW1lICAgICA9IGYu
bmFtZQorCisgICAgICAgICAgICAjIEluIGNnbywgQyBuYW1lcyB0aGF0IGNvbmZsaWN0IHdpdGgg
R28ga2V5d29yZHMgY2FuIGJlCisgICAgICAgICAgICAjIGFjY2Vzc2VkIGJ5IHByZXBlbmRpbmcg
YW4gdW5kZXJzY29yZSB0byB0aGUgbmFtZS4KKyAgICAgICAgICAgIGlmIGNmbmFtZSBpbiBnb19r
ZXl3b3JkczoKKyAgICAgICAgICAgICAgICBjZm5hbWUgPSAnXycgKyBjZm5hbWUKKworICAgICAg
ICAgICAgIyBJZiB0aGlzIGlzIG5lc3RlZCwgd2UgbmVlZCB0aGUgb3V0ZXIgbmFtZSB0b28uCisg
ICAgICAgICAgICBpZiBuZXN0ZWQgYW5kIHR5cGVuYW1lIGlzIG5vdCBOb25lOgorICAgICAgICAg
ICAgICAgIGdvbmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eXBlbmFtZSkKKyAgICAg
ICAgICAgICAgICBnb25hbWUgPSAne30ue30nLmZvcm1hdChnb25hbWUsIGdvZm5hbWUpCisgICAg
ICAgICAgICAgICAgY25hbWUgID0gJ3t9Lnt9Jy5mb3JtYXQodHlwZW5hbWUsIGNmbmFtZSkKKwor
ICAgICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICBnb25hbWUgPSBnb2ZuYW1lCisgICAg
ICAgICAgICAgICAgY25hbWUgID0gY2ZuYW1lCisKKyAgICAgICAgICAgICMgVHlwZXMgdGhhdCBz
YXRpc2Z5IHRoaXMgY29uZGl0aW9uIGNhbiBiZSBlYXNpbHkgY2FzdGVkIG9yCisgICAgICAgICAg
ICAjIGNvbnZlcnRlZCB0byBhIEdvIGJ1aWx0aW4gdHlwZS4KKyAgICAgICAgICAgIGlzX2Nhc3Rh
YmxlID0gKGYudHlwZS5qc29uX3BhcnNlX3R5cGUgPT0gJ0pTT05fSU5URUdFUicgb3IKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuRW51bWVyYXRpb24p
IG9yCisgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3R5cGVuYW1lIGluIGdvX2J1aWx0aW5f
dHlwZXMpCisKKyAgICAgICAgICAgIGlmIGlzX2Nhc3RhYmxlOgorICAgICAgICAgICAgICAgICMg
VXNlIHRoZSBjZ28gaGVscGVyIGZvciBjb252ZXJ0aW5nIEMgc3RyaW5ncy4KKyAgICAgICAgICAg
ICAgICBpZiBnb3R5cGVuYW1lID09ICdzdHJpbmcnOgorICAgICAgICAgICAgICAgICAgICBzICs9
ICd4Lnt9ID0gQy5Hb1N0cmluZyh4Yy57fSlcbicuZm9ybWF0KGdvbmFtZSwgY25hbWUpCisgICAg
ICAgICAgICAgICAgICAgIGNvbnRpbnVlCisKKyAgICAgICAgICAgICAgICBzICs9ICd4Lnt9ID0g
e30oeGMue30pXG4nLmZvcm1hdChnb25hbWUsIGdvdHlwZW5hbWUsIGNuYW1lKQorCisgICAgICAg
ICAgICBlbHNlOgorICAgICAgICAgICAgICAgICMgSWYgdGhlIHR5cGUgaXMgbm90IGNhc3RhYmxl
LCB3ZSBuZWVkIHRvIGNhbGwgaXRzIGZyb21DCisgICAgICAgICAgICAgICAgIyBmdW5jdGlvbi4K
KyAgICAgICAgICAgICAgICB2YXJuYW1lID0gJ3t9X3t9Jy5mb3JtYXQoZi50eXBlLnR5cGVuYW1l
LGYubmFtZSkKKyAgICAgICAgICAgICAgICB2YXJuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9u
YW1lKHZhcm5hbWUsIGV4cG9ydGVkPUZhbHNlKQorCisgICAgICAgICAgICAgICAgcyArPSAndmFy
IHt9IHt9XG4nLmZvcm1hdCh2YXJuYW1lLCBnb3R5cGVuYW1lKQorICAgICAgICAgICAgICAgIHMg
Kz0gJ2lmIGVyciA6PSB7fS5mcm9tQygmeGMue30pOycuZm9ybWF0KHZhcm5hbWUsIGNuYW1lKQor
ICAgICAgICAgICAgICAgIHMgKz0gJ2VyciAhPSBuaWwge1xuIHJldHVybiBlcnJcbn1cbicKKyAg
ICAgICAgICAgICAgICBzICs9ICd4Lnt9ID0ge31cbicuZm9ybWF0KGdvbmFtZSwgdmFybmFtZSkK
KworICAgICAgICBlbGlmIGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuU3RydWN0KToKKyAgICAgICAg
ICAgIHMgKz0geGVubGlnaHRfZ29sYW5nX2RlZmluZV9mcm9tX0MoZi50eXBlLCB0eXBlbmFtZT1m
Lm5hbWUsIG5lc3RlZD1UcnVlKQorCisgICAgICAgIGVsaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlk
bC5LZXllZFVuaW9uKToKKyAgICAgICAgICAgIHBhc3MKKworICAgICAgICBlbHNlOgorICAgICAg
ICAgICAgcmFpc2UgRXhjZXB0aW9uKCd0eXBlIHt9IG5vdCBzdXBwb3J0ZWQnLmZvcm1hdChmLnR5
cGUpKQorCisgICAgaWYgbm90IG5lc3RlZDoKKyAgICAgICAgcyArPSAncmV0dXJuIG5pbCcKKyAg
ICAgICAgcyArPSAnfVxuJworCisgICAgcmV0dXJuIHMKKwogZGVmIHhlbmxpZ2h0X2dvbGFuZ19m
bXRfbmFtZShuYW1lLCBleHBvcnRlZCA9IFRydWUpOgogICAgICIiIgogICAgIFRha2UgYSBnaXZl
biB0eXBlIG5hbWUgYW5kIHJldHVybiBhbgpAQCAtMjE4LDMgKzMzNiw1IEBAIGlmIF9fbmFtZV9f
ID09ICdfX21haW5fXyc6CiAKICAgICB4ZW5saWdodF9nb2xhbmdfZ2VuZXJhdGVfdHlwZXModHlw
ZXM9dHlwZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ9aGVh
ZGVyX2NvbW1lbnQpCisgICAgeGVubGlnaHRfZ29sYW5nX2dlbmVyYXRlX2hlbHBlcnModHlwZXM9
dHlwZXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudD1oZWFk
ZXJfY29tbWVudCkKZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdl
bi5nbyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi4wZGU0MmVhYTZiCi0tLSAvZGV2L251bGwKKysrIGIv
dG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvCkBAIC0wLDAgKzEsOTY5IEBACisv
LyBETyBOT1QgRURJVC4KKy8vCisvLyBUaGlzIGZpbGUgaXMgZ2VuZXJhdGVkIGJ5OgorLy8gZ2Vu
Z290eXBlcy5weSAuLi8uLi9saWJ4bC9saWJ4bF90eXBlcy5pZGwKKy8vCitwYWNrYWdlIHhlbmxp
Z2h0CisKKy8qCisjY2dvIExERkxBR1M6IC1seGVubGlnaHQKKyNpbmNsdWRlIDxzdGRsaWIuaD4K
KyNpbmNsdWRlIDxsaWJ4bC5oPgorCisqLworaW1wb3J0ICJDIgorCitmdW5jICh4ICpJb3BvcnRS
YW5nZSkgZnJvbUMoeGMgKkMubGlieGxfaW9wb3J0X3JhbmdlKSBlcnJvciB7CisJeC5GaXJzdCA9
IHVpbnQzMih4Yy5maXJzdCkKKwl4Lk51bWJlciA9IHVpbnQzMih4Yy5udW1iZXIpCisJcmV0dXJu
IG5pbAorfQorCitmdW5jICh4ICpJb21lbVJhbmdlKSBmcm9tQyh4YyAqQy5saWJ4bF9pb21lbV9y
YW5nZSkgZXJyb3IgeworCXguU3RhcnQgPSB1aW50NjQoeGMuc3RhcnQpCisJeC5OdW1iZXIgPSB1
aW50NjQoeGMubnVtYmVyKQorCXguR2ZuID0gdWludDY0KHhjLmdmbikKKwlyZXR1cm4gbmlsCit9
CisKK2Z1bmMgKHggKlZnYUludGVyZmFjZUluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZnYV9pbnRl
cmZhY2VfaW5mbykgZXJyb3IgeworCXguS2luZCA9IFZnYUludGVyZmFjZVR5cGUoeGMua2luZCkK
KwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlZuY0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3Zu
Y19pbmZvKSBlcnJvciB7CisJdmFyIGRlZmJvb2xFbmFibGUgRGVmYm9vbAorCWlmIGVyciA6PSBk
ZWZib29sRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwl4LkVuYWJsZSA9IGRlZmJvb2xFbmFibGUKKwl4Lkxpc3RlbiA9IEMuR29TdHJpbmco
eGMubGlzdGVuKQorCXguUGFzc3dkID0gQy5Hb1N0cmluZyh4Yy5wYXNzd2QpCisJeC5EaXNwbGF5
ID0gaW50KHhjLmRpc3BsYXkpCisJdmFyIGRlZmJvb2xGaW5kdW51c2VkIERlZmJvb2wKKwlpZiBl
cnIgOj0gZGVmYm9vbEZpbmR1bnVzZWQuZnJvbUMoJnhjLmZpbmR1bnVzZWQpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkZpbmR1bnVzZWQgPSBkZWZib29sRmluZHVudXNlZAor
CXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqU3BpY2VJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9z
cGljZV9pbmZvKSBlcnJvciB7CisJdmFyIGRlZmJvb2xFbmFibGUgRGVmYm9vbAorCWlmIGVyciA6
PSBkZWZib29sRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJu
IGVycgorCX0KKwl4LkVuYWJsZSA9IGRlZmJvb2xFbmFibGUKKwl4LlBvcnQgPSBpbnQoeGMucG9y
dCkKKwl4LlRsc1BvcnQgPSBpbnQoeGMudGxzX3BvcnQpCisJeC5Ib3N0ID0gQy5Hb1N0cmluZyh4
Yy5ob3N0KQorCXZhciBkZWZib29sRGlzYWJsZVRpY2tldGluZyBEZWZib29sCisJaWYgZXJyIDo9
IGRlZmJvb2xEaXNhYmxlVGlja2V0aW5nLmZyb21DKCZ4Yy5kaXNhYmxlX3RpY2tldGluZyk7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguRGlzYWJsZVRpY2tldGluZyA9IGRlZmJv
b2xEaXNhYmxlVGlja2V0aW5nCisJeC5QYXNzd2QgPSBDLkdvU3RyaW5nKHhjLnBhc3N3ZCkKKwl2
YXIgZGVmYm9vbEFnZW50TW91c2UgRGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sQWdlbnRNb3Vz
ZS5mcm9tQygmeGMuYWdlbnRfbW91c2UpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
Kwl4LkFnZW50TW91c2UgPSBkZWZib29sQWdlbnRNb3VzZQorCXZhciBkZWZib29sVmRhZ2VudCBE
ZWZib29sCisJaWYgZXJyIDo9IGRlZmJvb2xWZGFnZW50LmZyb21DKCZ4Yy52ZGFnZW50KTsgZXJy
ICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5WZGFnZW50ID0gZGVmYm9vbFZkYWdlbnQK
Kwl2YXIgZGVmYm9vbENsaXBib2FyZFNoYXJpbmcgRGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29s
Q2xpcGJvYXJkU2hhcmluZy5mcm9tQygmeGMuY2xpcGJvYXJkX3NoYXJpbmcpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkNsaXBib2FyZFNoYXJpbmcgPSBkZWZib29sQ2xpcGJv
YXJkU2hhcmluZworCXguVXNicmVkaXJlY3Rpb24gPSBpbnQoeGMudXNicmVkaXJlY3Rpb24pCisJ
eC5JbWFnZUNvbXByZXNzaW9uID0gQy5Hb1N0cmluZyh4Yy5pbWFnZV9jb21wcmVzc2lvbikKKwl4
LlN0cmVhbWluZ1ZpZGVvID0gQy5Hb1N0cmluZyh4Yy5zdHJlYW1pbmdfdmlkZW8pCisJcmV0dXJu
IG5pbAorfQorCitmdW5jICh4ICpTZGxJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zZGxfaW5mbykg
ZXJyb3IgeworCXZhciBkZWZib29sRW5hYmxlIERlZmJvb2wKKwlpZiBlcnIgOj0gZGVmYm9vbEVu
YWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJ
eC5FbmFibGUgPSBkZWZib29sRW5hYmxlCisJdmFyIGRlZmJvb2xPcGVuZ2wgRGVmYm9vbAorCWlm
IGVyciA6PSBkZWZib29sT3BlbmdsLmZyb21DKCZ4Yy5vcGVuZ2wpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwl4Lk9wZW5nbCA9IGRlZmJvb2xPcGVuZ2wKKwl4LkRpc3BsYXkgPSBD
LkdvU3RyaW5nKHhjLmRpc3BsYXkpCisJeC5YYXV0aG9yaXR5ID0gQy5Hb1N0cmluZyh4Yy54YXV0
aG9yaXR5KQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRG9taW5mbykgZnJvbUMoeGMgKkMu
bGlieGxfZG9taW5mbykgZXJyb3IgeworCXZhciB1dWlkVXVpZCBVdWlkCisJaWYgZXJyIDo9IHV1
aWRVdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJ
eC5VdWlkID0gdXVpZFV1aWQKKwl4LkRvbWlkID0gRG9taWQoeGMuZG9taWQpCisJeC5Tc2lkcmVm
ID0gdWludDMyKHhjLnNzaWRyZWYpCisJeC5Tc2lkTGFiZWwgPSBDLkdvU3RyaW5nKHhjLnNzaWRf
bGFiZWwpCisJeC5SdW5uaW5nID0gYm9vbCh4Yy5ydW5uaW5nKQorCXguQmxvY2tlZCA9IGJvb2wo
eGMuYmxvY2tlZCkKKwl4LlBhdXNlZCA9IGJvb2woeGMucGF1c2VkKQorCXguU2h1dGRvd24gPSBi
b29sKHhjLnNodXRkb3duKQorCXguRHlpbmcgPSBib29sKHhjLmR5aW5nKQorCXguTmV2ZXJTdG9w
ID0gYm9vbCh4Yy5uZXZlcl9zdG9wKQorCXguU2h1dGRvd25SZWFzb24gPSBTaHV0ZG93blJlYXNv
bih4Yy5zaHV0ZG93bl9yZWFzb24pCisJeC5PdXRzdGFuZGluZ01lbWtiID0gdWludDY0KHhjLm91
dHN0YW5kaW5nX21lbWtiKQorCXguQ3VycmVudE1lbWtiID0gdWludDY0KHhjLmN1cnJlbnRfbWVt
a2IpCisJeC5TaGFyZWRNZW1rYiA9IHVpbnQ2NCh4Yy5zaGFyZWRfbWVta2IpCisJeC5QYWdlZE1l
bWtiID0gdWludDY0KHhjLnBhZ2VkX21lbWtiKQorCXguTWF4TWVta2IgPSB1aW50NjQoeGMubWF4
X21lbWtiKQorCXguQ3B1VGltZSA9IHVpbnQ2NCh4Yy5jcHVfdGltZSkKKwl4LlZjcHVNYXhJZCA9
IHVpbnQzMih4Yy52Y3B1X21heF9pZCkKKwl4LlZjcHVPbmxpbmUgPSB1aW50MzIoeGMudmNwdV9v
bmxpbmUpCisJeC5DcHVwb29sID0gdWludDMyKHhjLmNwdXBvb2wpCisJeC5Eb21haW5UeXBlID0g
RG9tYWluVHlwZSh4Yy5kb21haW5fdHlwZSkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkNw
dXBvb2xpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jcHVwb29saW5mbykgZXJyb3IgeworCXguUG9v
bGlkID0gdWludDMyKHhjLnBvb2xpZCkKKwl4LlBvb2xOYW1lID0gQy5Hb1N0cmluZyh4Yy5wb29s
X25hbWUpCisJeC5TY2hlZCA9IFNjaGVkdWxlcih4Yy5zY2hlZCkKKwl4Lk5Eb20gPSB1aW50MzIo
eGMubl9kb20pCisJdmFyIGJpdG1hcENwdW1hcCBCaXRtYXAKKwlpZiBlcnIgOj0gYml0bWFwQ3B1
bWFwLmZyb21DKCZ4Yy5jcHVtYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4
LkNwdW1hcCA9IGJpdG1hcENwdW1hcAorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqQ2hhbm5l
bGluZm8pIGZyb21DKHhjICpDLmxpYnhsX2NoYW5uZWxpbmZvKSBlcnJvciB7CisJeC5CYWNrZW5k
ID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQorCXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tl
bmRfaWQpCisJeC5Gcm9udGVuZCA9IEMuR29TdHJpbmcoeGMuZnJvbnRlbmQpCisJeC5Gcm9udGVu
ZElkID0gdWludDMyKHhjLmZyb250ZW5kX2lkKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkK
Kwl4LlN0YXRlID0gaW50KHhjLnN0YXRlKQorCXguRXZ0Y2ggPSBpbnQoeGMuZXZ0Y2gpCisJeC5S
cmVmID0gaW50KHhjLnJyZWYpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpWbWluZm8pIGZy
b21DKHhjICpDLmxpYnhsX3ZtaW5mbykgZXJyb3IgeworCXZhciB1dWlkVXVpZCBVdWlkCisJaWYg
ZXJyIDo9IHV1aWRVdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJeC5VdWlkID0gdXVpZFV1aWQKKwl4LkRvbWlkID0gRG9taWQoeGMuZG9taWQpCisJ
cmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpWZXJzaW9uSW5mbykgZnJvbUMoeGMgKkMubGlieGxf
dmVyc2lvbl9pbmZvKSBlcnJvciB7CisJeC5YZW5WZXJzaW9uTWFqb3IgPSBpbnQoeGMueGVuX3Zl
cnNpb25fbWFqb3IpCisJeC5YZW5WZXJzaW9uTWlub3IgPSBpbnQoeGMueGVuX3ZlcnNpb25fbWlu
b3IpCisJeC5YZW5WZXJzaW9uRXh0cmEgPSBDLkdvU3RyaW5nKHhjLnhlbl92ZXJzaW9uX2V4dHJh
KQorCXguQ29tcGlsZXIgPSBDLkdvU3RyaW5nKHhjLmNvbXBpbGVyKQorCXguQ29tcGlsZUJ5ID0g
Qy5Hb1N0cmluZyh4Yy5jb21waWxlX2J5KQorCXguQ29tcGlsZURvbWFpbiA9IEMuR29TdHJpbmco
eGMuY29tcGlsZV9kb21haW4pCisJeC5Db21waWxlRGF0ZSA9IEMuR29TdHJpbmcoeGMuY29tcGls
ZV9kYXRlKQorCXguQ2FwYWJpbGl0aWVzID0gQy5Hb1N0cmluZyh4Yy5jYXBhYmlsaXRpZXMpCisJ
eC5DaGFuZ2VzZXQgPSBDLkdvU3RyaW5nKHhjLmNoYW5nZXNldCkKKwl4LlZpcnRTdGFydCA9IHVp
bnQ2NCh4Yy52aXJ0X3N0YXJ0KQorCXguUGFnZXNpemUgPSBpbnQoeGMucGFnZXNpemUpCisJeC5D
b21tYW5kbGluZSA9IEMuR29TdHJpbmcoeGMuY29tbWFuZGxpbmUpCisJeC5CdWlsZElkID0gQy5H
b1N0cmluZyh4Yy5idWlsZF9pZCkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpbkNy
ZWF0ZUluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbykgZXJyb3Igewor
CXguVHlwZSA9IERvbWFpblR5cGUoeGMuX3R5cGUpCisJdmFyIGRlZmJvb2xIYXAgRGVmYm9vbAor
CWlmIGVyciA6PSBkZWZib29sSGFwLmZyb21DKCZ4Yy5oYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIGVycgorCX0KKwl4LkhhcCA9IGRlZmJvb2xIYXAKKwl2YXIgZGVmYm9vbE9vcyBEZWZib29s
CisJaWYgZXJyIDo9IGRlZmJvb2xPb3MuZnJvbUMoJnhjLm9vcyk7IGVyciAhPSBuaWwgeworCQly
ZXR1cm4gZXJyCisJfQorCXguT29zID0gZGVmYm9vbE9vcworCXguU3NpZHJlZiA9IHVpbnQzMih4
Yy5zc2lkcmVmKQorCXguU3NpZExhYmVsID0gQy5Hb1N0cmluZyh4Yy5zc2lkX2xhYmVsKQorCXgu
TmFtZSA9IEMuR29TdHJpbmcoeGMubmFtZSkKKwl2YXIgdXVpZFV1aWQgVXVpZAorCWlmIGVyciA6
PSB1dWlkVXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCXguVXVpZCA9IHV1aWRVdWlkCisJdmFyIGtleVZhbHVlTGlzdFhzZGF0YSBLZXlWYWx1ZUxp
c3QKKwlpZiBlcnIgOj0ga2V5VmFsdWVMaXN0WHNkYXRhLmZyb21DKCZ4Yy54c2RhdGEpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlhzZGF0YSA9IGtleVZhbHVlTGlzdFhzZGF0
YQorCXZhciBrZXlWYWx1ZUxpc3RQbGF0Zm9ybWRhdGEgS2V5VmFsdWVMaXN0CisJaWYgZXJyIDo9
IGtleVZhbHVlTGlzdFBsYXRmb3JtZGF0YS5mcm9tQygmeGMucGxhdGZvcm1kYXRhKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5QbGF0Zm9ybWRhdGEgPSBrZXlWYWx1ZUxpc3RQ
bGF0Zm9ybWRhdGEKKwl4LlBvb2xpZCA9IHVpbnQzMih4Yy5wb29saWQpCisJeC5Qb29sTmFtZSA9
IEMuR29TdHJpbmcoeGMucG9vbF9uYW1lKQorCXZhciBkZWZib29sUnVuSG90cGx1Z1NjcmlwdHMg
RGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sUnVuSG90cGx1Z1NjcmlwdHMuZnJvbUMoJnhjLnJ1
bl9ob3RwbHVnX3NjcmlwdHMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlJ1
bkhvdHBsdWdTY3JpcHRzID0gZGVmYm9vbFJ1bkhvdHBsdWdTY3JpcHRzCisJdmFyIGRlZmJvb2xE
cml2ZXJEb21haW4gRGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sRHJpdmVyRG9tYWluLmZyb21D
KCZ4Yy5kcml2ZXJfZG9tYWluKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5E
cml2ZXJEb21haW4gPSBkZWZib29sRHJpdmVyRG9tYWluCisJeC5QYXNzdGhyb3VnaCA9IFBhc3N0
aHJvdWdoKHhjLnBhc3N0aHJvdWdoKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRG9tYWlu
UmVzdG9yZVBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3Jlc3RvcmVfcGFyYW1zKSBl
cnJvciB7CisJeC5DaGVja3BvaW50ZWRTdHJlYW0gPSBpbnQoeGMuY2hlY2twb2ludGVkX3N0cmVh
bSkKKwl4LlN0cmVhbVZlcnNpb24gPSB1aW50MzIoeGMuc3RyZWFtX3ZlcnNpb24pCisJeC5Db2xv
UHJveHlTY3JpcHQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fcHJveHlfc2NyaXB0KQorCXZhciBkZWZi
b29sVXNlcnNwYWNlQ29sb1Byb3h5IERlZmJvb2wKKwlpZiBlcnIgOj0gZGVmYm9vbFVzZXJzcGFj
ZUNvbG9Qcm94eS5mcm9tQygmeGMudXNlcnNwYWNlX2NvbG9fcHJveHkpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIGVycgorCX0KKwl4LlVzZXJzcGFjZUNvbG9Qcm94eSA9IGRlZmJvb2xVc2Vyc3Bh
Y2VDb2xvUHJveHkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlNjaGVkUGFyYW1zKSBmcm9t
Qyh4YyAqQy5saWJ4bF9zY2hlZF9wYXJhbXMpIGVycm9yIHsKKwl4LlZjcHVpZCA9IGludCh4Yy52
Y3B1aWQpCisJeC5XZWlnaHQgPSBpbnQoeGMud2VpZ2h0KQorCXguQ2FwID0gaW50KHhjLmNhcCkK
Kwl4LlBlcmlvZCA9IGludCh4Yy5wZXJpb2QpCisJeC5FeHRyYXRpbWUgPSBpbnQoeGMuZXh0cmF0
aW1lKQorCXguQnVkZ2V0ID0gaW50KHhjLmJ1ZGdldCkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMg
KHggKlZjcHVTY2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXMp
IGVycm9yIHsKKwl4LlNjaGVkID0gU2NoZWR1bGVyKHhjLnNjaGVkKQorCXJldHVybiBuaWwKK30K
KworZnVuYyAoeCAqRG9tYWluU2NoZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9z
Y2hlZF9wYXJhbXMpIGVycm9yIHsKKwl4LlNjaGVkID0gU2NoZWR1bGVyKHhjLnNjaGVkKQorCXgu
V2VpZ2h0ID0gaW50KHhjLndlaWdodCkKKwl4LkNhcCA9IGludCh4Yy5jYXApCisJeC5QZXJpb2Qg
PSBpbnQoeGMucGVyaW9kKQorCXguQnVkZ2V0ID0gaW50KHhjLmJ1ZGdldCkKKwl4LkV4dHJhdGlt
ZSA9IGludCh4Yy5leHRyYXRpbWUpCisJeC5TbGljZSA9IGludCh4Yy5zbGljZSkKKwl4LkxhdGVu
Y3kgPSBpbnQoeGMubGF0ZW5jeSkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlZub2RlSW5m
bykgZnJvbUMoeGMgKkMubGlieGxfdm5vZGVfaW5mbykgZXJyb3IgeworCXguTWVta2IgPSB1aW50
NjQoeGMubWVta2IpCisJeC5Qbm9kZSA9IHVpbnQzMih4Yy5wbm9kZSkKKwl2YXIgYml0bWFwVmNw
dXMgQml0bWFwCisJaWYgZXJyIDo9IGJpdG1hcFZjcHVzLmZyb21DKCZ4Yy52Y3B1cyk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguVmNwdXMgPSBiaXRtYXBWY3B1cworCXJldHVy
biBuaWwKK30KKworZnVuYyAoeCAqUmRtUmVzZXJ2ZSkgZnJvbUMoeGMgKkMubGlieGxfcmRtX3Jl
c2VydmUpIGVycm9yIHsKKwl4LlN0cmF0ZWd5ID0gUmRtUmVzZXJ2ZVN0cmF0ZWd5KHhjLnN0cmF0
ZWd5KQorCXguUG9saWN5ID0gUmRtUmVzZXJ2ZVBvbGljeSh4Yy5wb2xpY3kpCisJcmV0dXJuIG5p
bAorfQorCitmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFp
bl9idWlsZF9pbmZvKSBlcnJvciB7CisJeC5NYXhWY3B1cyA9IGludCh4Yy5tYXhfdmNwdXMpCisJ
dmFyIGJpdG1hcEF2YWlsVmNwdXMgQml0bWFwCisJaWYgZXJyIDo9IGJpdG1hcEF2YWlsVmNwdXMu
ZnJvbUMoJnhjLmF2YWlsX3ZjcHVzKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJ
eC5BdmFpbFZjcHVzID0gYml0bWFwQXZhaWxWY3B1cworCXZhciBiaXRtYXBDcHVtYXAgQml0bWFw
CisJaWYgZXJyIDo9IGJpdG1hcENwdW1hcC5mcm9tQygmeGMuY3B1bWFwKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBlcnIKKwl9CisJeC5DcHVtYXAgPSBiaXRtYXBDcHVtYXAKKwl2YXIgYml0bWFw
Tm9kZW1hcCBCaXRtYXAKKwlpZiBlcnIgOj0gYml0bWFwTm9kZW1hcC5mcm9tQygmeGMubm9kZW1h
cCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguTm9kZW1hcCA9IGJpdG1hcE5v
ZGVtYXAKKwl2YXIgZGVmYm9vbE51bWFQbGFjZW1lbnQgRGVmYm9vbAorCWlmIGVyciA6PSBkZWZi
b29sTnVtYVBsYWNlbWVudC5mcm9tQygmeGMubnVtYV9wbGFjZW1lbnQpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIGVycgorCX0KKwl4Lk51bWFQbGFjZW1lbnQgPSBkZWZib29sTnVtYVBsYWNlbWVu
dAorCXguVHNjTW9kZSA9IFRzY01vZGUoeGMudHNjX21vZGUpCisJeC5NYXhNZW1rYiA9IHVpbnQ2
NCh4Yy5tYXhfbWVta2IpCisJeC5UYXJnZXRNZW1rYiA9IHVpbnQ2NCh4Yy50YXJnZXRfbWVta2Ip
CisJeC5WaWRlb01lbWtiID0gdWludDY0KHhjLnZpZGVvX21lbWtiKQorCXguU2hhZG93TWVta2Ig
PSB1aW50NjQoeGMuc2hhZG93X21lbWtiKQorCXguSW9tbXVNZW1rYiA9IHVpbnQ2NCh4Yy5pb21t
dV9tZW1rYikKKwl4LlJ0Y1RpbWVvZmZzZXQgPSB1aW50MzIoeGMucnRjX3RpbWVvZmZzZXQpCisJ
eC5FeGVjU3NpZHJlZiA9IHVpbnQzMih4Yy5leGVjX3NzaWRyZWYpCisJeC5FeGVjU3NpZExhYmVs
ID0gQy5Hb1N0cmluZyh4Yy5leGVjX3NzaWRfbGFiZWwpCisJdmFyIGRlZmJvb2xMb2NhbHRpbWUg
RGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sTG9jYWx0aW1lLmZyb21DKCZ4Yy5sb2NhbHRpbWUp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkxvY2FsdGltZSA9IGRlZmJvb2xM
b2NhbHRpbWUKKwl2YXIgZGVmYm9vbERpc2FibGVNaWdyYXRlIERlZmJvb2wKKwlpZiBlcnIgOj0g
ZGVmYm9vbERpc2FibGVNaWdyYXRlLmZyb21DKCZ4Yy5kaXNhYmxlX21pZ3JhdGUpOyBlcnIgIT0g
bmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkRpc2FibGVNaWdyYXRlID0gZGVmYm9vbERpc2Fi
bGVNaWdyYXRlCisJdmFyIGNwdWlkUG9saWN5TGlzdENwdWlkIENwdWlkUG9saWN5TGlzdAorCWlm
IGVyciA6PSBjcHVpZFBvbGljeUxpc3RDcHVpZC5mcm9tQygmeGMuY3B1aWQpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkNwdWlkID0gY3B1aWRQb2xpY3lMaXN0Q3B1aWQKKwl4
LkJsa2RldlN0YXJ0ID0gQy5Hb1N0cmluZyh4Yy5ibGtkZXZfc3RhcnQpCisJeC5NYXhHcmFudEZy
YW1lcyA9IHVpbnQzMih4Yy5tYXhfZ3JhbnRfZnJhbWVzKQorCXguTWF4TWFwdHJhY2tGcmFtZXMg
PSB1aW50MzIoeGMubWF4X21hcHRyYWNrX2ZyYW1lcykKKwl4LkRldmljZU1vZGVsVmVyc2lvbiA9
IERldmljZU1vZGVsVmVyc2lvbih4Yy5kZXZpY2VfbW9kZWxfdmVyc2lvbikKKwl2YXIgZGVmYm9v
bERldmljZU1vZGVsU3R1YmRvbWFpbiBEZWZib29sCisJaWYgZXJyIDo9IGRlZmJvb2xEZXZpY2VN
b2RlbFN0dWJkb21haW4uZnJvbUMoJnhjLmRldmljZV9tb2RlbF9zdHViZG9tYWluKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5EZXZpY2VNb2RlbFN0dWJkb21haW4gPSBkZWZi
b29sRGV2aWNlTW9kZWxTdHViZG9tYWluCisJeC5EZXZpY2VNb2RlbCA9IEMuR29TdHJpbmcoeGMu
ZGV2aWNlX21vZGVsKQorCXguRGV2aWNlTW9kZWxTc2lkcmVmID0gdWludDMyKHhjLmRldmljZV9t
b2RlbF9zc2lkcmVmKQorCXguRGV2aWNlTW9kZWxTc2lkTGFiZWwgPSBDLkdvU3RyaW5nKHhjLmRl
dmljZV9tb2RlbF9zc2lkX2xhYmVsKQorCXguRGV2aWNlTW9kZWxVc2VyID0gQy5Hb1N0cmluZyh4
Yy5kZXZpY2VfbW9kZWxfdXNlcikKKwl2YXIgc3RyaW5nTGlzdEV4dHJhIFN0cmluZ0xpc3QKKwlp
ZiBlcnIgOj0gc3RyaW5nTGlzdEV4dHJhLmZyb21DKCZ4Yy5leHRyYSk7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gZXJyCisJfQorCXguRXh0cmEgPSBzdHJpbmdMaXN0RXh0cmEKKwl2YXIgc3RyaW5n
TGlzdEV4dHJhUHYgU3RyaW5nTGlzdAorCWlmIGVyciA6PSBzdHJpbmdMaXN0RXh0cmFQdi5mcm9t
QygmeGMuZXh0cmFfcHYpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkV4dHJh
UHYgPSBzdHJpbmdMaXN0RXh0cmFQdgorCXZhciBzdHJpbmdMaXN0RXh0cmFIdm0gU3RyaW5nTGlz
dAorCWlmIGVyciA6PSBzdHJpbmdMaXN0RXh0cmFIdm0uZnJvbUMoJnhjLmV4dHJhX2h2bSk7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguRXh0cmFIdm0gPSBzdHJpbmdMaXN0RXh0
cmFIdm0KKwl2YXIgZG9tYWluU2NoZWRQYXJhbXNTY2hlZFBhcmFtcyBEb21haW5TY2hlZFBhcmFt
cworCWlmIGVyciA6PSBkb21haW5TY2hlZFBhcmFtc1NjaGVkUGFyYW1zLmZyb21DKCZ4Yy5zY2hl
ZF9wYXJhbXMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlNjaGVkUGFyYW1z
ID0gZG9tYWluU2NoZWRQYXJhbXNTY2hlZFBhcmFtcworCXZhciBkZWZib29sQ2xhaW1Nb2RlIERl
ZmJvb2wKKwlpZiBlcnIgOj0gZGVmYm9vbENsYWltTW9kZS5mcm9tQygmeGMuY2xhaW1fbW9kZSk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguQ2xhaW1Nb2RlID0gZGVmYm9vbENs
YWltTW9kZQorCXguRXZlbnRDaGFubmVscyA9IHVpbnQzMih4Yy5ldmVudF9jaGFubmVscykKKwl4
Lktlcm5lbCA9IEMuR29TdHJpbmcoeGMua2VybmVsKQorCXguQ21kbGluZSA9IEMuR29TdHJpbmco
eGMuY21kbGluZSkKKwl4LlJhbWRpc2sgPSBDLkdvU3RyaW5nKHhjLnJhbWRpc2spCisJeC5EZXZp
Y2VUcmVlID0gQy5Hb1N0cmluZyh4Yy5kZXZpY2VfdHJlZSkKKwl2YXIgZGVmYm9vbEFjcGkgRGVm
Ym9vbAorCWlmIGVyciA6PSBkZWZib29sQWNwaS5mcm9tQygmeGMuYWNwaSk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gZXJyCisJfQorCXguQWNwaSA9IGRlZmJvb2xBY3BpCisJeC5Cb290bG9hZGVy
ID0gQy5Hb1N0cmluZyh4Yy5ib290bG9hZGVyKQorCXZhciBzdHJpbmdMaXN0Qm9vdGxvYWRlckFy
Z3MgU3RyaW5nTGlzdAorCWlmIGVyciA6PSBzdHJpbmdMaXN0Qm9vdGxvYWRlckFyZ3MuZnJvbUMo
JnhjLmJvb3Rsb2FkZXJfYXJncyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXgu
Qm9vdGxvYWRlckFyZ3MgPSBzdHJpbmdMaXN0Qm9vdGxvYWRlckFyZ3MKKwl4LlRpbWVyTW9kZSA9
IFRpbWVyTW9kZSh4Yy50aW1lcl9tb2RlKQorCXZhciBkZWZib29sTmVzdGVkSHZtIERlZmJvb2wK
KwlpZiBlcnIgOj0gZGVmYm9vbE5lc3RlZEh2bS5mcm9tQygmeGMubmVzdGVkX2h2bSk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguTmVzdGVkSHZtID0gZGVmYm9vbE5lc3RlZEh2
bQorCXZhciBkZWZib29sQXBpYyBEZWZib29sCisJaWYgZXJyIDo9IGRlZmJvb2xBcGljLmZyb21D
KCZ4Yy5hcGljKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5BcGljID0gZGVm
Ym9vbEFwaWMKKwl2YXIgZGVmYm9vbERtUmVzdHJpY3QgRGVmYm9vbAorCWlmIGVyciA6PSBkZWZi
b29sRG1SZXN0cmljdC5mcm9tQygmeGMuZG1fcmVzdHJpY3QpOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIGVycgorCX0KKwl4LkRtUmVzdHJpY3QgPSBkZWZib29sRG1SZXN0cmljdAorCXguVGVlID0g
VGVlVHlwZSh4Yy50ZWUpCisJeC5BcmNoQXJtLkdpY1ZlcnNpb24gPSBHaWNWZXJzaW9uKHhjLmFy
Y2hfYXJtLmdpY192ZXJzaW9uKQorCXguQXJjaEFybS5WdWFydCA9IFZ1YXJ0VHlwZSh4Yy5hcmNo
X2FybS52dWFydCkKKwl4LkFsdHAyTSA9IEFsdHAyTU1vZGUoeGMuYWx0cDJtKQorCXJldHVybiBu
aWwKK30KKworZnVuYyAoeCAqRGV2aWNlVmZiKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmZi
KSBlcnJvciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXgu
QmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LkRldmlk
ID0gRGV2aWQoeGMuZGV2aWQpCisJdmFyIHZuY0luZm9WbmMgVm5jSW5mbworCWlmIGVyciA6PSB2
bmNJbmZvVm5jLmZyb21DKCZ4Yy52bmMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
Kwl4LlZuYyA9IHZuY0luZm9WbmMKKwl2YXIgc2RsSW5mb1NkbCBTZGxJbmZvCisJaWYgZXJyIDo9
IHNkbEluZm9TZGwuZnJvbUMoJnhjLnNkbCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCXguU2RsID0gc2RsSW5mb1NkbAorCXguS2V5bWFwID0gQy5Hb1N0cmluZyh4Yy5rZXltYXAp
CisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VWa2IpIGZyb21DKHhjICpDLmxpYnhs
X2RldmljZV92a2IpIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRf
ZG9taWQpCisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1l
KQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKwl4LkJhY2tlbmRUeXBlID0gVmtiQmFja2Vu
ZCh4Yy5iYWNrZW5kX3R5cGUpCisJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lk
KQorCXguRmVhdHVyZURpc2FibGVLZXlib2FyZCA9IGJvb2woeGMuZmVhdHVyZV9kaXNhYmxlX2tl
eWJvYXJkKQorCXguRmVhdHVyZURpc2FibGVQb2ludGVyID0gYm9vbCh4Yy5mZWF0dXJlX2Rpc2Fi
bGVfcG9pbnRlcikKKwl4LkZlYXR1cmVBYnNQb2ludGVyID0gYm9vbCh4Yy5mZWF0dXJlX2Fic19w
b2ludGVyKQorCXguRmVhdHVyZVJhd1BvaW50ZXIgPSBib29sKHhjLmZlYXR1cmVfcmF3X3BvaW50
ZXIpCisJeC5GZWF0dXJlTXVsdGlUb3VjaCA9IGJvb2woeGMuZmVhdHVyZV9tdWx0aV90b3VjaCkK
Kwl4LldpZHRoID0gdWludDMyKHhjLndpZHRoKQorCXguSGVpZ2h0ID0gdWludDMyKHhjLmhlaWdo
dCkKKwl4Lk11bHRpVG91Y2hXaWR0aCA9IHVpbnQzMih4Yy5tdWx0aV90b3VjaF93aWR0aCkKKwl4
Lk11bHRpVG91Y2hIZWlnaHQgPSB1aW50MzIoeGMubXVsdGlfdG91Y2hfaGVpZ2h0KQorCXguTXVs
dGlUb3VjaE51bUNvbnRhY3RzID0gdWludDMyKHhjLm11bHRpX3RvdWNoX251bV9jb250YWN0cykK
KwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRldmljZURpc2spIGZyb21DKHhjICpDLmxpYnhs
X2RldmljZV9kaXNrKSBlcnJvciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5k
X2RvbWlkKQorCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFt
ZSkKKwl4LlBkZXZQYXRoID0gQy5Hb1N0cmluZyh4Yy5wZGV2X3BhdGgpCisJeC5WZGV2ID0gQy5H
b1N0cmluZyh4Yy52ZGV2KQorCXguQmFja2VuZCA9IERpc2tCYWNrZW5kKHhjLmJhY2tlbmQpCisJ
eC5Gb3JtYXQgPSBEaXNrRm9ybWF0KHhjLmZvcm1hdCkKKwl4LlNjcmlwdCA9IEMuR29TdHJpbmco
eGMuc2NyaXB0KQorCXguUmVtb3ZhYmxlID0gaW50KHhjLnJlbW92YWJsZSkKKwl4LlJlYWR3cml0
ZSA9IGludCh4Yy5yZWFkd3JpdGUpCisJeC5Jc0Nkcm9tID0gaW50KHhjLmlzX2Nkcm9tKQorCXgu
RGlyZWN0SW9TYWZlID0gYm9vbCh4Yy5kaXJlY3RfaW9fc2FmZSkKKwl2YXIgZGVmYm9vbERpc2Nh
cmRFbmFibGUgRGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sRGlzY2FyZEVuYWJsZS5mcm9tQygm
eGMuZGlzY2FyZF9lbmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkRp
c2NhcmRFbmFibGUgPSBkZWZib29sRGlzY2FyZEVuYWJsZQorCXZhciBkZWZib29sQ29sb0VuYWJs
ZSBEZWZib29sCisJaWYgZXJyIDo9IGRlZmJvb2xDb2xvRW5hYmxlLmZyb21DKCZ4Yy5jb2xvX2Vu
YWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguQ29sb0VuYWJsZSA9IGRl
ZmJvb2xDb2xvRW5hYmxlCisJdmFyIGRlZmJvb2xDb2xvUmVzdG9yZUVuYWJsZSBEZWZib29sCisJ
aWYgZXJyIDo9IGRlZmJvb2xDb2xvUmVzdG9yZUVuYWJsZS5mcm9tQygmeGMuY29sb19yZXN0b3Jl
X2VuYWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguQ29sb1Jlc3RvcmVF
bmFibGUgPSBkZWZib29sQ29sb1Jlc3RvcmVFbmFibGUKKwl4LkNvbG9Ib3N0ID0gQy5Hb1N0cmlu
Zyh4Yy5jb2xvX2hvc3QpCisJeC5Db2xvUG9ydCA9IGludCh4Yy5jb2xvX3BvcnQpCisJeC5Db2xv
RXhwb3J0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX2V4cG9ydCkKKwl4LkFjdGl2ZURpc2sgPSBDLkdv
U3RyaW5nKHhjLmFjdGl2ZV9kaXNrKQorCXguSGlkZGVuRGlzayA9IEMuR29TdHJpbmcoeGMuaGlk
ZGVuX2Rpc2spCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VOaWMpIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV9uaWMpIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhj
LmJhY2tlbmRfZG9taWQpCisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2Vu
ZF9kb21uYW1lKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKwl4Lk10dSA9IGludCh4Yy5t
dHUpCisJeC5Nb2RlbCA9IEMuR29TdHJpbmcoeGMubW9kZWwpCisJdmFyIG1hY01hYyBNYWMKKwlp
ZiBlcnIgOj0gbWFjTWFjLmZyb21DKCZ4Yy5tYWMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwl4Lk1hYyA9IG1hY01hYworCXguSXAgPSBDLkdvU3RyaW5nKHhjLmlwKQorCXguQnJp
ZGdlID0gQy5Hb1N0cmluZyh4Yy5icmlkZ2UpCisJeC5JZm5hbWUgPSBDLkdvU3RyaW5nKHhjLmlm
bmFtZSkKKwl4LlNjcmlwdCA9IEMuR29TdHJpbmcoeGMuc2NyaXB0KQorCXguTmljdHlwZSA9IE5p
Y1R5cGUoeGMubmljdHlwZSkKKwl4LlJhdGVCeXRlc1BlckludGVydmFsID0gdWludDY0KHhjLnJh
dGVfYnl0ZXNfcGVyX2ludGVydmFsKQorCXguUmF0ZUludGVydmFsVXNlY3MgPSB1aW50MzIoeGMu
cmF0ZV9pbnRlcnZhbF91c2VjcykKKwl4LkdhdGV3YXlkZXYgPSBDLkdvU3RyaW5nKHhjLmdhdGV3
YXlkZXYpCisJeC5Db2xvZnRGb3J3YXJkZGV2ID0gQy5Hb1N0cmluZyh4Yy5jb2xvZnRfZm9yd2Fy
ZGRldikKKwl4LkNvbG9Tb2NrTWlycm9ySWQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19taXJy
b3JfaWQpCisJeC5Db2xvU29ja01pcnJvcklwID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfbWly
cm9yX2lwKQorCXguQ29sb1NvY2tNaXJyb3JQb3J0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tf
bWlycm9yX3BvcnQpCisJeC5Db2xvU29ja0NvbXBhcmVQcmlJbklkID0gQy5Hb1N0cmluZyh4Yy5j
b2xvX3NvY2tfY29tcGFyZV9wcmlfaW5faWQpCisJeC5Db2xvU29ja0NvbXBhcmVQcmlJbklwID0g
Qy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfY29tcGFyZV9wcmlfaW5faXApCisJeC5Db2xvU29ja0Nv
bXBhcmVQcmlJblBvcnQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19jb21wYXJlX3ByaV9pbl9w
b3J0KQorCXguQ29sb1NvY2tDb21wYXJlU2VjSW5JZCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2Nr
X2NvbXBhcmVfc2VjX2luX2lkKQorCXguQ29sb1NvY2tDb21wYXJlU2VjSW5JcCA9IEMuR29TdHJp
bmcoeGMuY29sb19zb2NrX2NvbXBhcmVfc2VjX2luX2lwKQorCXguQ29sb1NvY2tDb21wYXJlU2Vj
SW5Qb3J0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfY29tcGFyZV9zZWNfaW5fcG9ydCkKKwl4
LkNvbG9Tb2NrQ29tcGFyZU5vdGlmeUlkID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfY29tcGFy
ZV9ub3RpZnlfaWQpCisJeC5Db2xvU29ja0NvbXBhcmVOb3RpZnlJcCA9IEMuR29TdHJpbmcoeGMu
Y29sb19zb2NrX2NvbXBhcmVfbm90aWZ5X2lwKQorCXguQ29sb1NvY2tDb21wYXJlTm90aWZ5UG9y
dCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX2NvbXBhcmVfbm90aWZ5X3BvcnQpCisJeC5Db2xv
U29ja1JlZGlyZWN0b3IwSWQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19yZWRpcmVjdG9yMF9p
ZCkKKwl4LkNvbG9Tb2NrUmVkaXJlY3RvcjBJcCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3Jl
ZGlyZWN0b3IwX2lwKQorCXguQ29sb1NvY2tSZWRpcmVjdG9yMFBvcnQgPSBDLkdvU3RyaW5nKHhj
LmNvbG9fc29ja19yZWRpcmVjdG9yMF9wb3J0KQorCXguQ29sb1NvY2tSZWRpcmVjdG9yMUlkID0g
Qy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjFfaWQpCisJeC5Db2xvU29ja1JlZGly
ZWN0b3IxSXAgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19yZWRpcmVjdG9yMV9pcCkKKwl4LkNv
bG9Tb2NrUmVkaXJlY3RvcjFQb3J0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfcmVkaXJlY3Rv
cjFfcG9ydCkKKwl4LkNvbG9Tb2NrUmVkaXJlY3RvcjJJZCA9IEMuR29TdHJpbmcoeGMuY29sb19z
b2NrX3JlZGlyZWN0b3IyX2lkKQorCXguQ29sb1NvY2tSZWRpcmVjdG9yMklwID0gQy5Hb1N0cmlu
Zyh4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjJfaXApCisJeC5Db2xvU29ja1JlZGlyZWN0b3IyUG9y
dCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3JlZGlyZWN0b3IyX3BvcnQpCisJeC5Db2xvRmls
dGVyTWlycm9yUXVldWUgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX21pcnJvcl9xdWV1ZSkK
Kwl4LkNvbG9GaWx0ZXJNaXJyb3JPdXRkZXYgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX21p
cnJvcl9vdXRkZXYpCisJeC5Db2xvRmlsdGVyUmVkaXJlY3RvcjBRdWV1ZSA9IEMuR29TdHJpbmco
eGMuY29sb19maWx0ZXJfcmVkaXJlY3RvcjBfcXVldWUpCisJeC5Db2xvRmlsdGVyUmVkaXJlY3Rv
cjBJbmRldiA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJfcmVkaXJlY3RvcjBfaW5kZXYpCisJ
eC5Db2xvRmlsdGVyUmVkaXJlY3RvcjBPdXRkZXYgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVy
X3JlZGlyZWN0b3IwX291dGRldikKKwl4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMVF1ZXVlID0gQy5H
b1N0cmluZyh4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMV9xdWV1ZSkKKwl4LkNvbG9GaWx0ZXJS
ZWRpcmVjdG9yMUluZGV2ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMV9p
bmRldikKKwl4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMU91dGRldiA9IEMuR29TdHJpbmcoeGMuY29s
b19maWx0ZXJfcmVkaXJlY3RvcjFfb3V0ZGV2KQorCXguQ29sb0NvbXBhcmVQcmlJbiA9IEMuR29T
dHJpbmcoeGMuY29sb19jb21wYXJlX3ByaV9pbikKKwl4LkNvbG9Db21wYXJlU2VjSW4gPSBDLkdv
U3RyaW5nKHhjLmNvbG9fY29tcGFyZV9zZWNfaW4pCisJeC5Db2xvQ29tcGFyZU91dCA9IEMuR29T
dHJpbmcoeGMuY29sb19jb21wYXJlX291dCkKKwl4LkNvbG9Db21wYXJlTm90aWZ5RGV2ID0gQy5H
b1N0cmluZyh4Yy5jb2xvX2NvbXBhcmVfbm90aWZ5X2RldikKKwl4LkNvbG9Tb2NrU2VjUmVkaXJl
Y3RvcjBJZCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMF9pZCkKKwl4
LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjBJcCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3NlY19y
ZWRpcmVjdG9yMF9pcCkKKwl4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjBQb3J0ID0gQy5Hb1N0cmlu
Zyh4Yy5jb2xvX3NvY2tfc2VjX3JlZGlyZWN0b3IwX3BvcnQpCisJeC5Db2xvU29ja1NlY1JlZGly
ZWN0b3IxSWQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjFfaWQpCisJ
eC5Db2xvU29ja1NlY1JlZGlyZWN0b3IxSXAgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19zZWNf
cmVkaXJlY3RvcjFfaXApCisJeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IxUG9ydCA9IEMuR29TdHJp
bmcoeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMV9wb3J0KQorCXguQ29sb0ZpbHRlclNlY1Jl
ZGlyZWN0b3IwUXVldWUgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX3NlY19yZWRpcmVjdG9y
MF9xdWV1ZSkKKwl4LkNvbG9GaWx0ZXJTZWNSZWRpcmVjdG9yMEluZGV2ID0gQy5Hb1N0cmluZyh4
Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjBfaW5kZXYpCisJeC5Db2xvRmlsdGVyU2VjUmVk
aXJlY3RvcjBPdXRkZXYgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX3NlY19yZWRpcmVjdG9y
MF9vdXRkZXYpCisJeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3RvcjFRdWV1ZSA9IEMuR29TdHJpbmco
eGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IxX3F1ZXVlKQorCXguQ29sb0ZpbHRlclNlY1Jl
ZGlyZWN0b3IxSW5kZXYgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX3NlY19yZWRpcmVjdG9y
MV9pbmRldikKKwl4LkNvbG9GaWx0ZXJTZWNSZWRpcmVjdG9yMU91dGRldiA9IEMuR29TdHJpbmco
eGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IxX291dGRldikKKwl4LkNvbG9GaWx0ZXJTZWNS
ZXdyaXRlcjBRdWV1ZSA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJfc2VjX3Jld3JpdGVyMF9x
dWV1ZSkKKwl4LkNvbG9DaGVja3BvaW50SG9zdCA9IEMuR29TdHJpbmcoeGMuY29sb19jaGVja3Bv
aW50X2hvc3QpCisJeC5Db2xvQ2hlY2twb2ludFBvcnQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fY2hl
Y2twb2ludF9wb3J0KQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlUGNpKSBmcm9t
Qyh4YyAqQy5saWJ4bF9kZXZpY2VfcGNpKSBlcnJvciB7CisJeC5GdW5jID0gYnl0ZSh4Yy5fZnVu
YykKKwl4LkRldiA9IGJ5dGUoeGMuZGV2KQorCXguQnVzID0gYnl0ZSh4Yy5idXMpCisJeC5Eb21h
aW4gPSBpbnQoeGMuZG9tYWluKQorCXguVmRldmZuID0gdWludDMyKHhjLnZkZXZmbikKKwl4LlZm
dW5jTWFzayA9IHVpbnQzMih4Yy52ZnVuY19tYXNrKQorCXguTXNpdHJhbnNsYXRlID0gYm9vbCh4
Yy5tc2l0cmFuc2xhdGUpCisJeC5Qb3dlck1nbXQgPSBib29sKHhjLnBvd2VyX21nbXQpCisJeC5Q
ZXJtaXNzaXZlID0gYm9vbCh4Yy5wZXJtaXNzaXZlKQorCXguU2VpemUgPSBib29sKHhjLnNlaXpl
KQorCXguUmRtUG9saWN5ID0gUmRtUmVzZXJ2ZVBvbGljeSh4Yy5yZG1fcG9saWN5KQorCXJldHVy
biBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlUmRtKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
cmRtKSBlcnJvciB7CisJeC5TdGFydCA9IHVpbnQ2NCh4Yy5zdGFydCkKKwl4LlNpemUgPSB1aW50
NjQoeGMuc2l6ZSkKKwl4LlBvbGljeSA9IFJkbVJlc2VydmVQb2xpY3koeGMucG9saWN5KQorCXJl
dHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlVXNiY3RybCkgZnJvbUMoeGMgKkMubGlieGxf
ZGV2aWNlX3VzYmN0cmwpIGVycm9yIHsKKwl4LlR5cGUgPSBVc2JjdHJsVHlwZSh4Yy5fdHlwZSkK
Kwl4LkRldmlkID0gRGV2aWQoeGMuZGV2aWQpCisJeC5WZXJzaW9uID0gaW50KHhjLnZlcnNpb24p
CisJeC5Qb3J0cyA9IGludCh4Yy5wb3J0cykKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJh
Y2tlbmRfZG9taWQpCisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9k
b21uYW1lKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlVXNiZGV2KSBmcm9tQyh4
YyAqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSBlcnJvciB7CisJeC5DdHJsID0gRGV2aWQoeGMuY3Ry
bCkKKwl4LlBvcnQgPSBpbnQoeGMucG9ydCkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRl
dmljZUR0ZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfZHRkZXYpIGVycm9yIHsKKwl4LlBh
dGggPSBDLkdvU3RyaW5nKHhjLnBhdGgpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZp
Y2VWdHBtKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdnRwbSkgZXJyb3IgeworCXguQmFja2Vu
ZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKKwl4LkJhY2tlbmREb21uYW1lID0gQy5H
b1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQor
CXZhciB1dWlkVXVpZCBVdWlkCisJaWYgZXJyIDo9IHV1aWRVdWlkLmZyb21DKCZ4Yy51dWlkKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5VdWlkID0gdXVpZFV1aWQKKwlyZXR1
cm4gbmlsCit9CisKK2Z1bmMgKHggKkRldmljZVA5KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
cDkpIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCisJ
eC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQorCXguVGFn
ID0gQy5Hb1N0cmluZyh4Yy50YWcpCisJeC5QYXRoID0gQy5Hb1N0cmluZyh4Yy5wYXRoKQorCXgu
U2VjdXJpdHlNb2RlbCA9IEMuR29TdHJpbmcoeGMuc2VjdXJpdHlfbW9kZWwpCisJeC5EZXZpZCA9
IERldmlkKHhjLmRldmlkKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlUHZjYWxs
c2lmKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmKSBlcnJvciB7CisJeC5CYWNr
ZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXguQmFja2VuZERvbW5hbWUgPSBD
LkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LkRldmlkID0gRGV2aWQoeGMuZGV2aWQp
CisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VDaGFubmVsKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfY2hhbm5lbCkgZXJyb3IgeworCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMu
YmFja2VuZF9kb21pZCkKKwl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5k
X2RvbW5hbWUpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQorCXguTmFtZSA9IEMuR29TdHJp
bmcoeGMubmFtZSkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkNvbm5lY3RvclBhcmFtKSBm
cm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JfcGFyYW0pIGVycm9yIHsKKwl4LlVuaXF1ZUlkID0g
Qy5Hb1N0cmluZyh4Yy51bmlxdWVfaWQpCisJeC5XaWR0aCA9IHVpbnQzMih4Yy53aWR0aCkKKwl4
LkhlaWdodCA9IHVpbnQzMih4Yy5oZWlnaHQpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpE
ZXZpY2VWZGlzcGwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92ZGlzcGwpIGVycm9yIHsKKwl4
LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCisJeC5CYWNrZW5kRG9tbmFt
ZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5k
ZXZpZCkKKwl4LkJlQWxsb2MgPSBib29sKHhjLmJlX2FsbG9jKQorCXJldHVybiBuaWwKK30KKwor
ZnVuYyAoeCAqVnNuZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wYXJhbXMpIGVycm9y
IHsKKwl4LkNoYW5uZWxzTWluID0gdWludDMyKHhjLmNoYW5uZWxzX21pbikKKwl4LkNoYW5uZWxz
TWF4ID0gdWludDMyKHhjLmNoYW5uZWxzX21heCkKKwl4LkJ1ZmZlclNpemUgPSB1aW50MzIoeGMu
YnVmZmVyX3NpemUpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpWc25kU3RyZWFtKSBmcm9t
Qyh4YyAqQy5saWJ4bF92c25kX3N0cmVhbSkgZXJyb3IgeworCXguVW5pcXVlSWQgPSBDLkdvU3Ry
aW5nKHhjLnVuaXF1ZV9pZCkKKwl4LlR5cGUgPSBWc25kU3RyZWFtVHlwZSh4Yy5fdHlwZSkKKwl2
YXIgdnNuZFBhcmFtc1BhcmFtcyBWc25kUGFyYW1zCisJaWYgZXJyIDo9IHZzbmRQYXJhbXNQYXJh
bXMuZnJvbUMoJnhjLnBhcmFtcyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXgu
UGFyYW1zID0gdnNuZFBhcmFtc1BhcmFtcworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqVnNu
ZFBjbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wY20pIGVycm9yIHsKKwl4Lk5hbWUgPSBDLkdv
U3RyaW5nKHhjLm5hbWUpCisJdmFyIHZzbmRQYXJhbXNQYXJhbXMgVnNuZFBhcmFtcworCWlmIGVy
ciA6PSB2c25kUGFyYW1zUGFyYW1zLmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwl4LlBhcmFtcyA9IHZzbmRQYXJhbXNQYXJhbXMKKwlyZXR1cm4gbmls
Cit9CisKK2Z1bmMgKHggKkRldmljZVZzbmQpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92c25k
KSBlcnJvciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXgu
QmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LkRldmlk
ID0gRGV2aWQoeGMuZGV2aWQpCisJeC5TaG9ydE5hbWUgPSBDLkdvU3RyaW5nKHhjLnNob3J0X25h
bWUpCisJeC5Mb25nTmFtZSA9IEMuR29TdHJpbmcoeGMubG9uZ19uYW1lKQorCXZhciB2c25kUGFy
YW1zUGFyYW1zIFZzbmRQYXJhbXMKKwlpZiBlcnIgOj0gdnNuZFBhcmFtc1BhcmFtcy5mcm9tQygm
eGMucGFyYW1zKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5QYXJhbXMgPSB2
c25kUGFyYW1zUGFyYW1zCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEb21haW5Db25maWcp
IGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIGVycm9yIHsKKwl2YXIgZG9tYWluQ3Jl
YXRlSW5mb0NJbmZvIERvbWFpbkNyZWF0ZUluZm8KKwlpZiBlcnIgOj0gZG9tYWluQ3JlYXRlSW5m
b0NJbmZvLmZyb21DKCZ4Yy5jX2luZm8pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
Kwl4LkNJbmZvID0gZG9tYWluQ3JlYXRlSW5mb0NJbmZvCisJdmFyIGRvbWFpbkJ1aWxkSW5mb0JJ
bmZvIERvbWFpbkJ1aWxkSW5mbworCWlmIGVyciA6PSBkb21haW5CdWlsZEluZm9CSW5mby5mcm9t
QygmeGMuYl9pbmZvKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5CSW5mbyA9
IGRvbWFpbkJ1aWxkSW5mb0JJbmZvCisJeC5PblBvd2Vyb2ZmID0gQWN0aW9uT25TaHV0ZG93bih4
Yy5vbl9wb3dlcm9mZikKKwl4Lk9uUmVib290ID0gQWN0aW9uT25TaHV0ZG93bih4Yy5vbl9yZWJv
b3QpCisJeC5PbldhdGNoZG9nID0gQWN0aW9uT25TaHV0ZG93bih4Yy5vbl93YXRjaGRvZykKKwl4
Lk9uQ3Jhc2ggPSBBY3Rpb25PblNodXRkb3duKHhjLm9uX2NyYXNoKQorCXguT25Tb2Z0UmVzZXQg
PSBBY3Rpb25PblNodXRkb3duKHhjLm9uX3NvZnRfcmVzZXQpCisJcmV0dXJuIG5pbAorfQorCitm
dW5jICh4ICpEaXNraW5mbykgZnJvbUMoeGMgKkMubGlieGxfZGlza2luZm8pIGVycm9yIHsKKwl4
LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1aW50MzIo
eGMuYmFja2VuZF9pZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVuZCkKKwl4
LkZyb250ZW5kSWQgPSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5EZXZpZCA9IERldmlkKHhj
LmRldmlkKQorCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCisJeC5FdnRjaCA9IGludCh4Yy5ldnRj
aCkKKwl4LlJyZWYgPSBpbnQoeGMucnJlZikKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKk5p
Y2luZm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsKKwl4LkJhY2tlbmQgPSBD
LkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9p
ZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVuZCkKKwl4LkZyb250ZW5kSWQg
PSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQorCXgu
U3RhdGUgPSBpbnQoeGMuc3RhdGUpCisJeC5FdnRjaCA9IGludCh4Yy5ldnRjaCkKKwl4LlJyZWZU
eCA9IGludCh4Yy5ycmVmX3R4KQorCXguUnJlZlJ4ID0gaW50KHhjLnJyZWZfcngpCisJcmV0dXJu
IG5pbAorfQorCitmdW5jICh4ICpWdHBtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnRwbWluZm8p
IGVycm9yIHsKKwl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5k
SWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5m
cm9udGVuZCkKKwl4LkZyb250ZW5kSWQgPSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5EZXZp
ZCA9IERldmlkKHhjLmRldmlkKQorCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCisJeC5FdnRjaCA9
IGludCh4Yy5ldnRjaCkKKwl4LlJyZWYgPSBpbnQoeGMucnJlZikKKwl2YXIgdXVpZFV1aWQgVXVp
ZAorCWlmIGVyciA6PSB1dWlkVXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBuaWwgeworCQly
ZXR1cm4gZXJyCisJfQorCXguVXVpZCA9IHV1aWRVdWlkCisJcmV0dXJuIG5pbAorfQorCitmdW5j
ICh4ICpVc2JjdHJsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdXNiY3RybGluZm8pIGVycm9yIHsK
Kwl4LlR5cGUgPSBVc2JjdHJsVHlwZSh4Yy5fdHlwZSkKKwl4LkRldmlkID0gRGV2aWQoeGMuZGV2
aWQpCisJeC5WZXJzaW9uID0gaW50KHhjLnZlcnNpb24pCisJeC5Qb3J0cyA9IGludCh4Yy5wb3J0
cykKKwl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1
aW50MzIoeGMuYmFja2VuZF9pZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVu
ZCkKKwl4LkZyb250ZW5kSWQgPSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5TdGF0ZSA9IGlu
dCh4Yy5zdGF0ZSkKKwl4LkV2dGNoID0gaW50KHhjLmV2dGNoKQorCXguUmVmVXJiID0gaW50KHhj
LnJlZl91cmIpCisJeC5SZWZDb25uID0gaW50KHhjLnJlZl9jb25uKQorCXJldHVybiBuaWwKK30K
KworZnVuYyAoeCAqVmNwdWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZjcHVpbmZvKSBlcnJvciB7
CisJeC5WY3B1aWQgPSB1aW50MzIoeGMudmNwdWlkKQorCXguQ3B1ID0gdWludDMyKHhjLmNwdSkK
Kwl4Lk9ubGluZSA9IGJvb2woeGMub25saW5lKQorCXguQmxvY2tlZCA9IGJvb2woeGMuYmxvY2tl
ZCkKKwl4LlJ1bm5pbmcgPSBib29sKHhjLnJ1bm5pbmcpCisJeC5WY3B1VGltZSA9IHVpbnQ2NCh4
Yy52Y3B1X3RpbWUpCisJdmFyIGJpdG1hcENwdW1hcCBCaXRtYXAKKwlpZiBlcnIgOj0gYml0bWFw
Q3B1bWFwLmZyb21DKCZ4Yy5jcHVtYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
Kwl4LkNwdW1hcCA9IGJpdG1hcENwdW1hcAorCXZhciBiaXRtYXBDcHVtYXBTb2Z0IEJpdG1hcAor
CWlmIGVyciA6PSBiaXRtYXBDcHVtYXBTb2Z0LmZyb21DKCZ4Yy5jcHVtYXBfc29mdCk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguQ3B1bWFwU29mdCA9IGJpdG1hcENwdW1hcFNv
ZnQKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlBoeXNpbmZvKSBmcm9tQyh4YyAqQy5saWJ4
bF9waHlzaW5mbykgZXJyb3IgeworCXguVGhyZWFkc1BlckNvcmUgPSB1aW50MzIoeGMudGhyZWFk
c19wZXJfY29yZSkKKwl4LkNvcmVzUGVyU29ja2V0ID0gdWludDMyKHhjLmNvcmVzX3Blcl9zb2Nr
ZXQpCisJeC5NYXhDcHVJZCA9IHVpbnQzMih4Yy5tYXhfY3B1X2lkKQorCXguTnJDcHVzID0gdWlu
dDMyKHhjLm5yX2NwdXMpCisJeC5DcHVLaHogPSB1aW50MzIoeGMuY3B1X2toeikKKwl4LlRvdGFs
UGFnZXMgPSB1aW50NjQoeGMudG90YWxfcGFnZXMpCisJeC5GcmVlUGFnZXMgPSB1aW50NjQoeGMu
ZnJlZV9wYWdlcykKKwl4LlNjcnViUGFnZXMgPSB1aW50NjQoeGMuc2NydWJfcGFnZXMpCisJeC5P
dXRzdGFuZGluZ1BhZ2VzID0gdWludDY0KHhjLm91dHN0YW5kaW5nX3BhZ2VzKQorCXguU2hhcmlu
Z0ZyZWVkUGFnZXMgPSB1aW50NjQoeGMuc2hhcmluZ19mcmVlZF9wYWdlcykKKwl4LlNoYXJpbmdV
c2VkRnJhbWVzID0gdWludDY0KHhjLnNoYXJpbmdfdXNlZF9mcmFtZXMpCisJeC5NYXhQb3NzaWJs
ZU1mbiA9IHVpbnQ2NCh4Yy5tYXhfcG9zc2libGVfbWZuKQorCXguTnJOb2RlcyA9IHVpbnQzMih4
Yy5ucl9ub2RlcykKKwl2YXIgaHdjYXBId0NhcCBId2NhcAorCWlmIGVyciA6PSBod2NhcEh3Q2Fw
LmZyb21DKCZ4Yy5od19jYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4Lkh3
Q2FwID0gaHdjYXBId0NhcAorCXguQ2FwSHZtID0gYm9vbCh4Yy5jYXBfaHZtKQorCXguQ2FwUHYg
PSBib29sKHhjLmNhcF9wdikKKwl4LkNhcEh2bURpcmVjdGlvID0gYm9vbCh4Yy5jYXBfaHZtX2Rp
cmVjdGlvKQorCXguQ2FwSGFwID0gYm9vbCh4Yy5jYXBfaGFwKQorCXguQ2FwU2hhZG93ID0gYm9v
bCh4Yy5jYXBfc2hhZG93KQorCXguQ2FwSW9tbXVIYXBQdFNoYXJlID0gYm9vbCh4Yy5jYXBfaW9t
bXVfaGFwX3B0X3NoYXJlKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqQ29ubmVjdG9yaW5m
bykgZnJvbUMoeGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgZXJyb3IgeworCXguVW5pcXVlSWQg
PSBDLkdvU3RyaW5nKHhjLnVuaXF1ZV9pZCkKKwl4LldpZHRoID0gdWludDMyKHhjLndpZHRoKQor
CXguSGVpZ2h0ID0gdWludDMyKHhjLmhlaWdodCkKKwl4LlJlcUV2dGNoID0gaW50KHhjLnJlcV9l
dnRjaCkKKwl4LlJlcVJyZWYgPSBpbnQoeGMucmVxX3JyZWYpCisJeC5FdnRFdnRjaCA9IGludCh4
Yy5ldnRfZXZ0Y2gpCisJeC5FdnRScmVmID0gaW50KHhjLmV2dF9ycmVmKQorCXJldHVybiBuaWwK
K30KKworZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmRpc3BsaW5mbykg
ZXJyb3IgeworCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKKwl4LkJhY2tlbmRJ
ZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQorCXguRnJvbnRlbmQgPSBDLkdvU3RyaW5nKHhjLmZy
b250ZW5kKQorCXguRnJvbnRlbmRJZCA9IHVpbnQzMih4Yy5mcm9udGVuZF9pZCkKKwl4LkRldmlk
ID0gRGV2aWQoeGMuZGV2aWQpCisJeC5TdGF0ZSA9IGludCh4Yy5zdGF0ZSkKKwl4LkJlQWxsb2Mg
PSBib29sKHhjLmJlX2FsbG9jKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqU3RyZWFtaW5m
bykgZnJvbUMoeGMgKkMubGlieGxfc3RyZWFtaW5mbykgZXJyb3IgeworCXguUmVxRXZ0Y2ggPSBp
bnQoeGMucmVxX2V2dGNoKQorCXguUmVxUnJlZiA9IGludCh4Yy5yZXFfcnJlZikKKwlyZXR1cm4g
bmlsCit9CisKK2Z1bmMgKHggKlBjbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3BjbWluZm8pIGVy
cm9yIHsKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlZzbmRpbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF92c25kaW5mbykgZXJyb3IgeworCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2Vu
ZCkKKwl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQorCXguRnJvbnRlbmQgPSBD
LkdvU3RyaW5nKHhjLmZyb250ZW5kKQorCXguRnJvbnRlbmRJZCA9IHVpbnQzMih4Yy5mcm9udGVu
ZF9pZCkKKwl4LkRldmlkID0gRGV2aWQoeGMuZGV2aWQpCisJeC5TdGF0ZSA9IGludCh4Yy5zdGF0
ZSkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlZrYmluZm8pIGZyb21DKHhjICpDLmxpYnhs
X3ZrYmluZm8pIGVycm9yIHsKKwl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJ
eC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0
cmluZyh4Yy5mcm9udGVuZCkKKwl4LkZyb250ZW5kSWQgPSB1aW50MzIoeGMuZnJvbnRlbmRfaWQp
CisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQorCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCisJ
eC5FdnRjaCA9IGludCh4Yy5ldnRjaCkKKwl4LlJyZWYgPSBpbnQoeGMucnJlZikKKwlyZXR1cm4g
bmlsCit9CisKK2Z1bmMgKHggKk51bWFpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9udW1haW5mbykg
ZXJyb3IgeworCXguU2l6ZSA9IHVpbnQ2NCh4Yy5zaXplKQorCXguRnJlZSA9IHVpbnQ2NCh4Yy5m
cmVlKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqQ3B1dG9wb2xvZ3kpIGZyb21DKHhjICpD
LmxpYnhsX2NwdXRvcG9sb2d5KSBlcnJvciB7CisJeC5Db3JlID0gdWludDMyKHhjLmNvcmUpCisJ
eC5Tb2NrZXQgPSB1aW50MzIoeGMuc29ja2V0KQorCXguTm9kZSA9IHVpbnQzMih4Yy5ub2RlKQor
CXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqUGNpdG9wb2xvZ3kpIGZyb21DKHhjICpDLmxpYnhs
X3BjaXRvcG9sb2d5KSBlcnJvciB7CisJeC5TZWcgPSB1aW50MTYoeGMuc2VnKQorCXguQnVzID0g
Ynl0ZSh4Yy5idXMpCisJeC5EZXZmbiA9IGJ5dGUoeGMuZGV2Zm4pCisJeC5Ob2RlID0gdWludDMy
KHhjLm5vZGUpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykg
ZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtcykgZXJyb3IgeworCXguVHNsaWNl
TXMgPSBpbnQoeGMudHNsaWNlX21zKQorCXguUmF0ZWxpbWl0VXMgPSBpbnQoeGMucmF0ZWxpbWl0
X3VzKQorCXguVmNwdU1pZ3JEZWxheVVzID0gaW50KHhjLnZjcHVfbWlncl9kZWxheV91cykKKwly
ZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlNjaGVkQ3JlZGl0MlBhcmFtcykgZnJvbUMoeGMgKkMu
bGlieGxfc2NoZWRfY3JlZGl0Ml9wYXJhbXMpIGVycm9yIHsKKwl4LlJhdGVsaW1pdFVzID0gaW50
KHhjLnJhdGVsaW1pdF91cykKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpblJlbXVz
SW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIGVycm9yIHsKKwl4Lklu
dGVydmFsID0gaW50KHhjLmludGVydmFsKQorCXZhciBkZWZib29sQWxsb3dVbnNhZmUgRGVmYm9v
bAorCWlmIGVyciA6PSBkZWZib29sQWxsb3dVbnNhZmUuZnJvbUMoJnhjLmFsbG93X3Vuc2FmZSk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguQWxsb3dVbnNhZmUgPSBkZWZib29s
QWxsb3dVbnNhZmUKKwl2YXIgZGVmYm9vbEJsYWNraG9sZSBEZWZib29sCisJaWYgZXJyIDo9IGRl
ZmJvb2xCbGFja2hvbGUuZnJvbUMoJnhjLmJsYWNraG9sZSk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gZXJyCisJfQorCXguQmxhY2tob2xlID0gZGVmYm9vbEJsYWNraG9sZQorCXZhciBkZWZib29s
Q29tcHJlc3Npb24gRGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sQ29tcHJlc3Npb24uZnJvbUMo
JnhjLmNvbXByZXNzaW9uKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5Db21w
cmVzc2lvbiA9IGRlZmJvb2xDb21wcmVzc2lvbgorCXZhciBkZWZib29sTmV0YnVmIERlZmJvb2wK
KwlpZiBlcnIgOj0gZGVmYm9vbE5ldGJ1Zi5mcm9tQygmeGMubmV0YnVmKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBlcnIKKwl9CisJeC5OZXRidWYgPSBkZWZib29sTmV0YnVmCisJeC5OZXRidWZz
Y3JpcHQgPSBDLkdvU3RyaW5nKHhjLm5ldGJ1ZnNjcmlwdCkKKwl2YXIgZGVmYm9vbERpc2tidWYg
RGVmYm9vbAorCWlmIGVyciA6PSBkZWZib29sRGlza2J1Zi5mcm9tQygmeGMuZGlza2J1Zik7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguRGlza2J1ZiA9IGRlZmJvb2xEaXNrYnVm
CisJdmFyIGRlZmJvb2xDb2xvIERlZmJvb2wKKwlpZiBlcnIgOj0gZGVmYm9vbENvbG8uZnJvbUMo
JnhjLmNvbG8pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkNvbG8gPSBkZWZi
b29sQ29sbworCXZhciBkZWZib29sVXNlcnNwYWNlQ29sb1Byb3h5IERlZmJvb2wKKwlpZiBlcnIg
Oj0gZGVmYm9vbFVzZXJzcGFjZUNvbG9Qcm94eS5mcm9tQygmeGMudXNlcnNwYWNlX2NvbG9fcHJv
eHkpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlVzZXJzcGFjZUNvbG9Qcm94
eSA9IGRlZmJvb2xVc2Vyc3BhY2VDb2xvUHJveHkKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHgg
KkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9ldmVudCkgZXJyb3IgeworCXZhciBldkxpbmtMaW5r
IEV2TGluaworCWlmIGVyciA6PSBldkxpbmtMaW5rLmZyb21DKCZ4Yy5saW5rKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5MaW5rID0gZXZMaW5rTGluaworCXguRG9taWQgPSBE
b21pZCh4Yy5kb21pZCkKKwl2YXIgdXVpZERvbXV1aWQgVXVpZAorCWlmIGVyciA6PSB1dWlkRG9t
dXVpZC5mcm9tQygmeGMuZG9tdXVpZCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQor
CXguRG9tdXVpZCA9IHV1aWREb211dWlkCisJeC5Gb3JVc2VyID0gdWludDY0KHhjLmZvcl91c2Vy
KQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqUHNyQ2F0SW5mbykgZnJvbUMoeGMgKkMubGli
eGxfcHNyX2NhdF9pbmZvKSBlcnJvciB7CisJeC5JZCA9IHVpbnQzMih4Yy5pZCkKKwl4LkNvc01h
eCA9IHVpbnQzMih4Yy5jb3NfbWF4KQorCXguQ2JtTGVuID0gdWludDMyKHhjLmNibV9sZW4pCisJ
eC5DZHBFbmFibGVkID0gYm9vbCh4Yy5jZHBfZW5hYmxlZCkKKwlyZXR1cm4gbmlsCit9CisKK2Z1
bmMgKHggKlBzckh3SW5mbykgZnJvbUMoeGMgKkMubGlieGxfcHNyX2h3X2luZm8pIGVycm9yIHsK
Kwl4LklkID0gdWludDMyKHhjLmlkKQorCXJldHVybiBuaWwKK30KZGlmZiAtLWdpdCBhL3Rvb2xz
L2dvbGFuZy94ZW5saWdodC94ZW5saWdodC5nbyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC94ZW5s
aWdodC5nbwppbmRleCA5NDIwMTk3YmZiLi4yMTBhNDE4YzAyIDEwMDY0NAotLS0gYS90b29scy9n
b2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28KKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hl
bmxpZ2h0LmdvCkBAIC00MTUsNDcgKzQxNSw2IEBAIGZ1bmMgKGJtICpCaXRtYXApIHRvQygpIChD
LmxpYnhsX2JpdG1hcCwgZXJyb3IpIHsKIAlyZXR1cm4gY2JtLCBuaWwKIH0KIAotZnVuYyAoY3Bo
eXMgKkMubGlieGxfcGh5c2luZm8pIHRvR28oKSAocGh5c2luZm8gKlBoeXNpbmZvKSB7Ci0KLQlw
aHlzaW5mbyA9ICZQaHlzaW5mb3t9Ci0JcGh5c2luZm8uVGhyZWFkc1BlckNvcmUgPSB1aW50MzIo
Y3BoeXMudGhyZWFkc19wZXJfY29yZSkKLQlwaHlzaW5mby5Db3Jlc1BlclNvY2tldCA9IHVpbnQz
MihjcGh5cy5jb3Jlc19wZXJfc29ja2V0KQotCXBoeXNpbmZvLk1heENwdUlkID0gdWludDMyKGNw
aHlzLm1heF9jcHVfaWQpCi0JcGh5c2luZm8uTnJDcHVzID0gdWludDMyKGNwaHlzLm5yX2NwdXMp
Ci0JcGh5c2luZm8uQ3B1S2h6ID0gdWludDMyKGNwaHlzLmNwdV9raHopCi0JcGh5c2luZm8uVG90
YWxQYWdlcyA9IHVpbnQ2NChjcGh5cy50b3RhbF9wYWdlcykKLQlwaHlzaW5mby5GcmVlUGFnZXMg
PSB1aW50NjQoY3BoeXMuZnJlZV9wYWdlcykKLQlwaHlzaW5mby5TY3J1YlBhZ2VzID0gdWludDY0
KGNwaHlzLnNjcnViX3BhZ2VzKQotCXBoeXNpbmZvLlNjcnViUGFnZXMgPSB1aW50NjQoY3BoeXMu
c2NydWJfcGFnZXMpCi0JcGh5c2luZm8uU2hhcmluZ0ZyZWVkUGFnZXMgPSB1aW50NjQoY3BoeXMu
c2hhcmluZ19mcmVlZF9wYWdlcykKLQlwaHlzaW5mby5TaGFyaW5nVXNlZEZyYW1lcyA9IHVpbnQ2
NChjcGh5cy5zaGFyaW5nX3VzZWRfZnJhbWVzKQotCXBoeXNpbmZvLk5yTm9kZXMgPSB1aW50MzIo
Y3BoeXMubnJfbm9kZXMpCi0JcGh5c2luZm8uSHdDYXAuZnJvbUMoJmNwaHlzLmh3X2NhcCkKLQlw
aHlzaW5mby5DYXBIdm0gPSBib29sKGNwaHlzLmNhcF9odm0pCi0JcGh5c2luZm8uQ2FwSHZtRGly
ZWN0aW8gPSBib29sKGNwaHlzLmNhcF9odm1fZGlyZWN0aW8pCi0KLQlyZXR1cm4KLX0KLQotZnVu
YyAoY2luZm8gKkMubGlieGxfdmVyc2lvbl9pbmZvKSB0b0dvKCkgKGluZm8gKlZlcnNpb25JbmZv
KSB7Ci0JaW5mbyA9ICZWZXJzaW9uSW5mb3t9Ci0JaW5mby5YZW5WZXJzaW9uTWFqb3IgPSBpbnQo
Y2luZm8ueGVuX3ZlcnNpb25fbWFqb3IpCi0JaW5mby5YZW5WZXJzaW9uTWlub3IgPSBpbnQoY2lu
Zm8ueGVuX3ZlcnNpb25fbWlub3IpCi0JaW5mby5YZW5WZXJzaW9uRXh0cmEgPSBDLkdvU3RyaW5n
KGNpbmZvLnhlbl92ZXJzaW9uX2V4dHJhKQotCWluZm8uQ29tcGlsZXIgPSBDLkdvU3RyaW5nKGNp
bmZvLmNvbXBpbGVyKQotCWluZm8uQ29tcGlsZUJ5ID0gQy5Hb1N0cmluZyhjaW5mby5jb21waWxl
X2J5KQotCWluZm8uQ29tcGlsZURvbWFpbiA9IEMuR29TdHJpbmcoY2luZm8uY29tcGlsZV9kb21h
aW4pCi0JaW5mby5Db21waWxlRGF0ZSA9IEMuR29TdHJpbmcoY2luZm8uY29tcGlsZV9kYXRlKQot
CWluZm8uQ2FwYWJpbGl0aWVzID0gQy5Hb1N0cmluZyhjaW5mby5jYXBhYmlsaXRpZXMpCi0JaW5m
by5DaGFuZ2VzZXQgPSBDLkdvU3RyaW5nKGNpbmZvLmNoYW5nZXNldCkKLQlpbmZvLlZpcnRTdGFy
dCA9IHVpbnQ2NChjaW5mby52aXJ0X3N0YXJ0KQotCWluZm8uUGFnZXNpemUgPSBpbnQoY2luZm8u
cGFnZXNpemUpCi0JaW5mby5Db21tYW5kbGluZSA9IEMuR29TdHJpbmcoY2luZm8uY29tbWFuZGxp
bmUpCi0JaW5mby5CdWlsZElkID0gQy5Hb1N0cmluZyhjaW5mby5idWlsZF9pZCkKLQotCXJldHVy
bgotfQotCiBmdW5jIChzciBTaHV0ZG93blJlYXNvbikgU3RyaW5nKCkgKHN0ciBzdHJpbmcpIHsK
IAljc3RyIDo9IEMubGlieGxfc2h1dGRvd25fcmVhc29uX3RvX3N0cmluZyhDLmxpYnhsX3NodXRk
b3duX3JlYXNvbihzcikpCiAJc3RyID0gQy5Hb1N0cmluZyhjc3RyKQpAQCAtNDcwLDM0ICs0Mjks
NiBAQCBmdW5jIChkdCBEb21haW5UeXBlKSBTdHJpbmcoKSAoc3RyIHN0cmluZykgewogCXJldHVy
bgogfQogCi1mdW5jIChjZGkgKkMubGlieGxfZG9taW5mbykgdG9HbygpIChkaSAqRG9taW5mbykg
ewotCi0JZGkgPSAmRG9taW5mb3t9Ci0JZGkuVXVpZC5mcm9tQygmY2RpLnV1aWQpCi0JZGkuRG9t
aWQgPSBEb21pZChjZGkuZG9taWQpCi0JZGkuU3NpZHJlZiA9IHVpbnQzMihjZGkuc3NpZHJlZikK
LQlkaS5Tc2lkTGFiZWwgPSBDLkdvU3RyaW5nKGNkaS5zc2lkX2xhYmVsKQotCWRpLlJ1bm5pbmcg
PSBib29sKGNkaS5ydW5uaW5nKQotCWRpLkJsb2NrZWQgPSBib29sKGNkaS5ibG9ja2VkKQotCWRp
LlBhdXNlZCA9IGJvb2woY2RpLnBhdXNlZCkKLQlkaS5TaHV0ZG93biA9IGJvb2woY2RpLnNodXRk
b3duKQotCWRpLkR5aW5nID0gYm9vbChjZGkuZHlpbmcpCi0JZGkuTmV2ZXJTdG9wID0gYm9vbChj
ZGkubmV2ZXJfc3RvcCkKLQlkaS5TaHV0ZG93blJlYXNvbiA9IFNodXRkb3duUmVhc29uKGNkaS5z
aHV0ZG93bl9yZWFzb24pCi0JZGkuT3V0c3RhbmRpbmdNZW1rYiA9IHVpbnQ2NChjZGkub3V0c3Rh
bmRpbmdfbWVta2IpCi0JZGkuQ3VycmVudE1lbWtiID0gdWludDY0KGNkaS5jdXJyZW50X21lbWti
KQotCWRpLlNoYXJlZE1lbWtiID0gdWludDY0KGNkaS5zaGFyZWRfbWVta2IpCi0JZGkuUGFnZWRN
ZW1rYiA9IHVpbnQ2NChjZGkucGFnZWRfbWVta2IpCi0JZGkuTWF4TWVta2IgPSB1aW50NjQoY2Rp
Lm1heF9tZW1rYikKLQlkaS5DcHVUaW1lID0gdWludDY0KGNkaS5jcHVfdGltZSkKLQlkaS5WY3B1
TWF4SWQgPSB1aW50MzIoY2RpLnZjcHVfbWF4X2lkKQotCWRpLlZjcHVPbmxpbmUgPSB1aW50MzIo
Y2RpLnZjcHVfb25saW5lKQotCWRpLkNwdXBvb2wgPSB1aW50MzIoY2RpLmNwdXBvb2wpCi0JZGku
RG9tYWluVHlwZSA9IERvbWFpblR5cGUoY2RpLmRvbWFpbl90eXBlKQotCi0JcmV0dXJuCi19Ci0K
IC8vIGNvbnN0IGNoYXIgKmxpYnhsX3NjaGVkdWxlcl90b19zdHJpbmcobGlieGxfc2NoZWR1bGVy
IHApOwogZnVuYyAocyBTY2hlZHVsZXIpIFN0cmluZygpIHN0cmluZyB7CiAJY3MgOj0gQy5saWJ4
bF9zY2hlZHVsZXJfdG9fc3RyaW5nKEMubGlieGxfc2NoZWR1bGVyKHMpKQpAQCAtNTI5LDE2ICs0
NjAsNiBAQCBmdW5jIFNjaGVkdWxlckZyb21TdHJpbmcobmFtZSBzdHJpbmcpIChzIFNjaGVkdWxl
ciwgZXJyIGVycm9yKSB7CiAJcmV0dXJuCiB9CiAKLWZ1bmMgKGNjaSBDLmxpYnhsX2NwdXBvb2xp
bmZvKSB0b0dvKCkgKGdjaSBDcHVwb29saW5mbykgewotCWdjaS5Qb29saWQgPSB1aW50MzIoY2Np
LnBvb2xpZCkKLQlnY2kuUG9vbE5hbWUgPSBDLkdvU3RyaW5nKGNjaS5wb29sX25hbWUpCi0JZ2Np
LlNjaGVkID0gU2NoZWR1bGVyKGNjaS5zY2hlZCkKLQlnY2kuTkRvbSA9IHVpbnQzMihjY2kubl9k
b20pCi0JZ2NpLkNwdW1hcC5mcm9tQygmY2NpLmNwdW1hcCkKLQotCXJldHVybgotfQotCiAvLyBs
aWJ4bF9jcHVwb29saW5mbyAqIGxpYnhsX2xpc3RfY3B1cG9vbChsaWJ4bF9jdHgqLCBpbnQgKm5i
X3Bvb2xfb3V0KTsKIC8vIHZvaWQgbGlieGxfY3B1cG9vbGluZm9fbGlzdF9mcmVlKGxpYnhsX2Nw
dXBvb2xpbmZvICpsaXN0LCBpbnQgbmJfcG9vbCk7CiBmdW5jIChDdHggKkNvbnRleHQpIExpc3RD
cHVwb29sKCkgKGxpc3QgW11DcHVwb29saW5mbykgewpAQCAtNTYwLDcgKzQ4MSw4IEBAIGZ1bmMg
KEN0eCAqQ29udGV4dCkgTGlzdENwdXBvb2woKSAobGlzdCBbXUNwdXBvb2xpbmZvKSB7CiAJLy8g
TWFnaWMKIAljcHVwb29sTGlzdFNsaWNlIDo9ICgqWzEgPDwgMzBdQy5saWJ4bF9jcHVwb29saW5m
bykodW5zYWZlLlBvaW50ZXIoY19jcHVwb29sX2xpc3QpKVs6bmJQb29sOm5iUG9vbF0KIAlmb3Ig
aSA6PSByYW5nZSBjcHVwb29sTGlzdFNsaWNlIHsKLQkJaW5mbyA6PSBjcHVwb29sTGlzdFNsaWNl
W2ldLnRvR28oKQorCQl2YXIgaW5mbyBDcHVwb29saW5mbworCQlfID0gaW5mby5mcm9tQygmY3B1
cG9vbExpc3RTbGljZVtpXSkKIAkJbGlzdCA9IGFwcGVuZChsaXN0LCBpbmZvKQogCX0KIApAQCAt
NTgzLDcgKzUwNSw3IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbEluZm8oUG9vbGlkIHVp
bnQzMikgKHBvb2wgQ3B1cG9vbGluZm8pIHsKIAl9CiAJZGVmZXIgQy5saWJ4bF9jcHVwb29saW5m
b19kaXNwb3NlKCZjX2NwdXBvb2wpCiAKLQlwb29sID0gY19jcHVwb29sLnRvR28oKQorCV8gPSBw
b29sLmZyb21DKCZjX2NwdXBvb2wpCiAKIAlyZXR1cm4KIH0KQEAgLTEwNzQsNyArOTk2LDcgQEAg
ZnVuYyAoQ3R4ICpDb250ZXh0KSBHZXRQaHlzaW5mbygpIChwaHlzaW5mbyAqUGh5c2luZm8sIGVy
ciBlcnJvcikgewogCQllcnIgPSBFcnJvcihyZXQpCiAJCXJldHVybgogCX0KLQlwaHlzaW5mbyA9
IGNwaHlzLnRvR28oKQorCWVyciA9IHBoeXNpbmZvLmZyb21DKCZjcGh5cykKIAogCXJldHVybgog
fQpAQCAtMTA5MCw3ICsxMDEyLDcgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBHZXRWZXJzaW9uSW5m
bygpIChpbmZvICpWZXJzaW9uSW5mbywgZXJyIGVycm9yKSB7CiAKIAljaW5mbyA9IEMubGlieGxf
Z2V0X3ZlcnNpb25faW5mbyhDdHguY3R4KQogCi0JaW5mbyA9IGNpbmZvLnRvR28oKQorCWVyciA9
IGluZm8uZnJvbUMoY2luZm8pCiAKIAlyZXR1cm4KIH0KQEAgLTExMTIsNyArMTAzNCw3IEBAIGZ1
bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluSW5mbyhJZCBEb21pZCkgKGRpICpEb21pbmZvLCBlcnIg
ZXJyb3IpIHsKIAkJcmV0dXJuCiAJfQogCi0JZGkgPSBjZGkudG9HbygpCisJZXJyID0gZGkuZnJv
bUMoJmNkaSkKIAogCXJldHVybgogfQpAQCAtMTE5NCwyNiArMTExNiwxNCBAQCBmdW5jIChDdHgg
KkNvbnRleHQpIExpc3REb21haW4oKSAoZ2xpc3QgW11Eb21pbmZvKSB7CiAKIAlnc2xpY2UgOj0g
KCpbMSA8PCAzMF1DLmxpYnhsX2RvbWluZm8pKHVuc2FmZS5Qb2ludGVyKGNsaXN0KSlbOm5iRG9t
YWluOm5iRG9tYWluXQogCWZvciBpIDo9IHJhbmdlIGdzbGljZSB7Ci0JCWluZm8gOj0gZ3NsaWNl
W2ldLnRvR28oKQotCQlnbGlzdCA9IGFwcGVuZChnbGlzdCwgKmluZm8pCisJCXZhciBpbmZvIERv
bWluZm8KKwkJXyA9IGluZm8uZnJvbUMoJmdzbGljZVtpXSkKKwkJZ2xpc3QgPSBhcHBlbmQoZ2xp
c3QsIGluZm8pCiAJfQogCiAJcmV0dXJuCiB9CiAKLWZ1bmMgKGN2Y2kgQy5saWJ4bF92Y3B1aW5m
bykgdG9HbygpIChndmNpIFZjcHVpbmZvKSB7Ci0JZ3ZjaS5WY3B1aWQgPSB1aW50MzIoY3ZjaS52
Y3B1aWQpCi0JZ3ZjaS5DcHUgPSB1aW50MzIoY3ZjaS5jcHUpCi0JZ3ZjaS5PbmxpbmUgPSBib29s
KGN2Y2kub25saW5lKQotCWd2Y2kuQmxvY2tlZCA9IGJvb2woY3ZjaS5ibG9ja2VkKQotCWd2Y2ku
UnVubmluZyA9IGJvb2woY3ZjaS5ydW5uaW5nKQotCWd2Y2kuVmNwdVRpbWUgPSB1aW50NjQoY3Zj
aS52Y3B1X3RpbWUpCi0JZ3ZjaS5DcHVtYXAuZnJvbUMoJmN2Y2kuY3B1bWFwKQotCWd2Y2kuQ3B1
bWFwU29mdC5mcm9tQygmY3ZjaS5jcHVtYXBfc29mdCkKLQotCXJldHVybgotfQotCiAvL2xpYnhs
X3ZjcHVpbmZvICpsaWJ4bF9saXN0X3ZjcHUobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IGRvbWlk
LAogLy8JCQkJaW50ICpuYl92Y3B1LCBpbnQgKm5yX2NwdXNfb3V0KTsKIC8vdm9pZCBsaWJ4bF92
Y3B1aW5mb19saXN0X2ZyZWUobGlieGxfdmNwdWluZm8gKiwgaW50IG5yX3ZjcHVzKTsKQEAgLTEy
MzUsNyArMTE0NSw4IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgTGlzdFZjcHUoaWQgRG9taWQpIChn
bGlzdCBbXVZjcHVpbmZvKSB7CiAKIAlnc2xpY2UgOj0gKCpbMSA8PCAzMF1DLmxpYnhsX3ZjcHVp
bmZvKSh1bnNhZmUuUG9pbnRlcihjbGlzdCkpWzpuYlZjcHU6bmJWY3B1XQogCWZvciBpIDo9IHJh
bmdlIGdzbGljZSB7Ci0JCWluZm8gOj0gZ3NsaWNlW2ldLnRvR28oKQorCQl2YXIgaW5mbyBWY3B1
aW5mbworCQlfID0gaW5mby5mcm9tQygmZ3NsaWNlW2ldKQogCQlnbGlzdCA9IGFwcGVuZChnbGlz
dCwgaW5mbykKIAl9CiAKLS0gCjIuMTkuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3Rz
LnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0
aW5mby94ZW4tZGV2ZWw=

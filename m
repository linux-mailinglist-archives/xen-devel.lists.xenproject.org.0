Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E2C1C2AEC
	for <lists+xen-devel@lfdr.de>; Tue,  1 Oct 2019 01:31:54 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iF56V-0000lK-Us; Mon, 30 Sep 2019 23:29:19 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=/D4s=XZ=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1iF56T-0000k3-Oq
 for xen-devel@lists.xen.org; Mon, 30 Sep 2019 23:29:17 +0000
X-Inumbo-ID: 1cd65824-e3da-11e9-96ea-12813bfff9fa
Received: from mail.kernel.org (unknown [198.145.29.99])
 by localhost (Halon) with ESMTPS
 id 1cd65824-e3da-11e9-96ea-12813bfff9fa;
 Mon, 30 Sep 2019 23:29:14 +0000 (UTC)
Received: from sstabellini-ThinkPad-T480s.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 33B72218DE;
 Mon, 30 Sep 2019 23:29:13 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1569886153;
 bh=LI4s3NbSLn05GkkTyR/Pgd8dR/8rX/SnbCC3WdcRvEg=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=w6MNPV5Ge46deBe6ICHo4tY6eSWvcXhTZWahKTN5YgH3vKKxCsHch3aMYJJZZB8Fz
 3FmO2kPA2U5/9rtitGhxKjqgWAgVVuRZv4Vgy/i83J2zF5MHMhbsnd21OASurmL4Ou
 2BMgOnJorSiyQwERWP3uF5Y7OwOCZR7ZZEy8Cc3A=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Mon, 30 Sep 2019 16:28:46 -0700
Message-Id: <20190930232849.1820-5-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1909301624550.2594@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1909301624550.2594@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v7a 5/8] xen/arm: assign devices to boot domains
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U2NhbiB0aGUgdXNlciBwcm92aWRlZCBkdGIgZnJhZ21lbnQgYXQgYm9vdC4gRm9yIGVhY2ggZGV2
aWNlIG5vZGUsIG1hcAptZW1vcnkgdG8gZ3Vlc3RzLCBhbmQgcm91dGUgaW50ZXJydXB0cyBhbmQg
c2V0dXAgdGhlIGlvbW11LgoKVGhlIG1lbW9yeSByZWdpb24gdG8gcmVtYXAgaXMgc3BlY2lmaWVk
IGJ5IHRoZSAieGVuLHJlZyIgcHJvcGVydHkuCgpUaGUgaW9tbXUgaXMgc2V0dXAgYnkgcGFzc2lu
ZyB0aGUgbm9kZSBvZiB0aGUgZGV2aWNlIHRvIGFzc2lnbiBvbiB0aGUKaG9zdCBkZXZpY2UgdHJl
ZS4gVGhlIHBhdGggaXMgc3BlY2lmaWVkIGluIHRoZSBkZXZpY2UgdHJlZSBmcmFnbWVudCBhcwp0
aGUgInhlbixwYXRoIiBzdHJpbmcgcHJvcGVydHkuCgpUaGUgaW50ZXJydXB0cyBhcmUgcmVtYXBw
ZWQgYmFzZWQgb24gdGhlIGluZm9ybWF0aW9uIGZyb20gdGhlCmNvcnJlc3BvbmRpbmcgbm9kZSBv
biB0aGUgaG9zdCBkZXZpY2UgdHJlZS4gQ2FsbApoYW5kbGVfZGV2aWNlX2ludGVycnVwdHMgdG8g
cmVtYXAgaW50ZXJydXB0cy4gSW50ZXJydXB0cyByZWxhdGVkIGRldmljZQp0cmVlIHByb3BlcnRp
ZXMgYXJlIGNvcGllZCBmcm9tIHRoZSBkZXZpY2UgdHJlZSBmcmFnbWVudCwgc2FtZSBhcyBhbGwK
dGhlIG90aGVyIHByb3BlcnRpZXMuCgpBbHNvIHNldCBhZGQgdGhlIG5ldyBmbGFnIFhFTl9ET01D
VExfQ0RGX2lvbW11IHNvIHRoYXQgZG9tMGxlc3MgZG9tVQpjYW4gdXNlIHRoZSBJT01NVSBpZiBh
IHBhcnRpYWwgZHRiIGlzIHNwZWNpZmllZC4KClNpZ25lZC1vZmYtYnk6IFN0ZWZhbm8gU3RhYmVs
bGluaSA8c3RlZmFub3NAeGlsaW54LmNvbT4KLS0tCkNoYW5nZXMgaW4gdjc6Ci0gaW1wcm92ZSBp
bi1jb2RlIGNvbW1lbnQKLSBjb2RlIHN0eWxlCi0gcmV0dXJuIDEgaW5zdGVhZCBvZiBFTk9FTlQK
CkNoYW5nZXMgaW4gdjY6Ci0gdHVybiBkcHJpbnRrcyBpbnRvIHByaW50a3MKLSByZXR1cm4gZXJy
b3Igb24gcGFnZSBhbGlnbm1lbnQgY2hlY2sgZmFpbHVyZQotIHNldCBYRU5fRE9NQ1RMX0NERl9p
b21tdSBpZiBwYXJ0aWFsIGR0YiBpcyBzcGVjaWZpZWQKCkNoYW5nZXMgaW4gdjU6Ci0gdXNlIGxv
Y2FsIHZhcmlhYmxlIGZvciBuYW1lCi0gdXNlIG1hcF9yZWdpb25zX3AybXQKLSBhZGQgd2Fybmlu
ZyBmb3Igbm90IHBhZ2UgYWxpZ25lZCBhZGRyZXNzZXMvc2l6ZXMKLSBpbnRyb2R1Y2UgaGFuZGxl
X3Bhc3N0aHJvdWdoX3Byb3AKCkNoYW5nZXMgaW4gdjQ6Ci0gdXNlIHVuc2lnbmVkCi0gaW1wcm92
ZSBjb21taXQgbWVzc2FnZQotIGNvZGUgc3R5bGUKLSB1c2UgZHRfcHJvcF9jbXAKLSB1c2UgZGV2
aWNlX3RyZWVfZ2V0X3JlZwotIGRvbid0IGNvcHkgb3ZlciB4ZW4scmVnIGFuZCB4ZW4scGF0aAot
IGRvbid0IGNyZWF0ZSBzcGVjaWFsIGludGVycnVwdCBwcm9wZXJ0aWVzIGZvciBkb21VOiBjb3B5
IHRoZW0gZnJvbSB0aGUKICBmcmFnbWVudAotIGluLWNvZGUgY29tbWVudAoKQ2hhbmdlcyBpbiB2
MzoKLSBpbXByb3ZlIGNvbW1pdCBtZXNzYWdlCi0gcmVtb3ZlIHN1cGVyZmx1b3VzIGNhc3QKLSBt
ZXJnZSBjb2RlIHdpdGggdGhlIGNvcHkgY29kZQotIGFkZCBpbnRlcnJ1cC1wYXJlbnQKLSBkZW1v
dmUgZGVwdGggPiAyIGNoZWNrCi0gcmV1c2UgY29kZSBmcm9tIGhhbmRsZV9kZXZpY2VfaW50ZXJy
dXB0cwotIGNvcHkgaW50ZXJydXB0cyBmcm9tIGhvc3QgZHQKCkNoYW5nZXMgaW4gdjI6Ci0gcmVu
YW1lICJwYXRoIiB0byAieGVuLHBhdGgiCi0gZ3JhbW1hciBmaXgKLSB1c2UgZ2FkZHJfdG9fZ2Zu
IGFuZCBtYWRkcl90b19tZm4KLSByZW1vdmUgZGVwdGggPD0gMiBsaW1pdGF0aW9uIGluIHNjYW5u
aW5nIHRoZSBkdGIgZnJhZ21lbnQKLSBpbnRyb2R1Y2UgYW5kIHBhcnNlIHhlbixyZWcKLSBjb2Rl
IHN0eWxlCi0gc3VwcG9ydCBtb3JlIHRoYW4gb25lIGludGVycnVwdCBwZXIgZGV2aWNlCi0gc3Bl
Y2lmeSBvbmx5IHRoZSBHSUMgaXMgc3VwcG9ydGVkCi0tLQogeGVuL2FyY2gvYXJtL2RvbWFpbl9i
dWlsZC5jIHwgMTE1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLQogMSBmaWxl
IGNoYW5nZWQsIDExMiBpbnNlcnRpb25zKCspLCAzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQu
YwppbmRleCA4NGI2NWI4ZjI1Li44MGFjNTk3YmI2IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0v
ZG9tYWluX2J1aWxkLmMKKysrIGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCkBAIC0xNzE0
LDYgKzE3MTQsOTYgQEAgc3RhdGljIGludCBfX2luaXQgbWFrZV92cGwwMTFfdWFydF9ub2RlKHN0
cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8pCiB9CiAjZW5kaWYKIAorLyoKKyAqIFNjYW4gZGV2aWNl
IHRyZWUgcHJvcGVydGllcyBmb3IgcGFzc3Rocm91Z2ggc3BlY2lmaWMgaW5mb3JtYXRpb24uCisg
KiBSZXR1cm5zIDEgd2hlbiBubyBwYXNzdGhyb3VnaCBwcm9wZXJ0aWVzIGFyZSBmb3VuZAorICog
ICAgICAgICA8IDAgb24gZXJyb3IKKyAqICAgICAgICAgMCBvbiBzdWNjZXNzCisgKi8KK3N0YXRp
YyBpbnQgX19pbml0IGhhbmRsZV9wYXNzdGhyb3VnaF9wcm9wKHN0cnVjdCBrZXJuZWxfaW5mbyAq
a2luZm8sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBz
dHJ1Y3QgZmR0X3Byb3BlcnR5ICpwcm9wLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqbmFtZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVpbnQzMl90IGFkZHJlc3NfY2VsbHMsIHVpbnQzMl90IHNpemVfY2Vs
bHMpCit7CisgICAgY29uc3QgX19iZTMyICpjZWxsOworICAgIHVuc2lnbmVkIGludCBpLCBsZW47
CisgICAgc3RydWN0IGR0X2RldmljZV9ub2RlICpub2RlOworICAgIGludCByZXM7CisKKyAgICAv
KiB4ZW4scmVnIHNwZWNpZmllcyB3aGVyZSB0byBtYXAgdGhlIE1NSU8gcmVnaW9uICovCisgICAg
aWYgKCBkdF9wcm9wX2NtcCgieGVuLHJlZyIsIG5hbWUpID09IDAgKQorICAgIHsKKyAgICAgICAg
cGFkZHJfdCBtc3RhcnQsIHNpemUsIGdzdGFydDsKKworICAgICAgICBjZWxsID0gKGNvbnN0IF9f
YmUzMiAqKXByb3AtPmRhdGE7CisgICAgICAgIGxlbiA9IGZkdDMyX3RvX2NwdShwcm9wLT5sZW4p
IC8KKyAgICAgICAgICAgICAgKChhZGRyZXNzX2NlbGxzICogMiArIHNpemVfY2VsbHMpICogc2l6
ZW9mKHVpbnQzMl90KSk7CisKKyAgICAgICAgZm9yICggaSA9IDA7IGkgPCBsZW47IGkrKyApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIGRldmljZV90cmVlX2dldF9yZWcoJmNlbGwsIGFkZHJlc3Nf
Y2VsbHMsIHNpemVfY2VsbHMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZtc3Rh
cnQsICZzaXplKTsKKyAgICAgICAgICAgIGdzdGFydCA9IGR0X25leHRfY2VsbChhZGRyZXNzX2Nl
bGxzLCAmY2VsbCk7CisKKyAgICAgICAgICAgIGlmICggZ3N0YXJ0ICYgflBBR0VfTUFTSyB8fCBt
c3RhcnQgJiB+UEFHRV9NQVNLIHx8IHNpemUgJiB+UEFHRV9NQVNLICkKKyAgICAgICAgICAgIHsK
KyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUgorICAgICAgICAgICAgICAgICAgICAg
ICAiRG9tVSBwYXNzdGhyb3VnaCBjb25maWcgaGFzIG5vdCBwYWdlIGFsaWduZWQgYWRkcmVzc2Vz
L3NpemVzXG4iKTsKKyAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAgICAg
IH0KKworICAgICAgICAgICAgcmVzID0gbWFwX3JlZ2lvbnNfcDJtdChraW5mby0+ZCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FkZHJfdG9fZ2ZuKGdzdGFydCksCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBGTl9ET1dOKHNpemUpLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBtYWRkcl90b19tZm4obXN0YXJ0KSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX21taW9fZGlyZWN0X2Rldik7CisgICAgICAg
ICAgICBpZiAoIHJlcyA8IDAgKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHByaW50
ayhYRU5MT0dfRVJSCisgICAgICAgICAgICAgICAgICAgICAgICJGYWlsZWQgdG8gbWFwICUiUFJJ
cGFkZHIiIHRvIHRoZSBndWVzdCBhdCUiUFJJcGFkZHIiXG4iLAorICAgICAgICAgICAgICAgICAg
ICAgICBtc3RhcnQsIGdzdGFydCk7CisgICAgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7Cisg
ICAgICAgICAgICB9CisgICAgICAgIH0KKworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAg
LyoKKyAgICAgKiB4ZW4scGF0aCBzcGVjaWZpZXMgdGhlIGNvcnJlc3BvbmRpbmcgbm9kZSBpbiB0
aGUgaG9zdCBEVC4KKyAgICAgKiBCb3RoIGludGVycnVwdCBtYXBwaW5ncyBhbmQgSU9NTVUgc2V0
dGluZ3MgYXJlIGJhc2VkIG9uIGl0LAorICAgICAqIGFzIHRoZXkgYXJlIGRvbmUgYmFzZWQgb24g
dGhlIGNvcnJlc3BvbmRpbmcgaG9zdCBEVCBub2RlLgorICAgICAqLworICAgIGVsc2UgaWYgKCBk
dF9wcm9wX2NtcCgieGVuLHBhdGgiLCBuYW1lKSA9PSAwICkKKyAgICB7CisgICAgICAgIG5vZGUg
PSBkdF9maW5kX25vZGVfYnlfcGF0aChwcm9wLT5kYXRhKTsKKyAgICAgICAgaWYgKCBub2RlID09
IE5VTEwgKQorICAgICAgICB7CisgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiQ291bGRu
J3QgZmluZCBub2RlICVzIGluIGhvc3RfZHQhXG4iLAorICAgICAgICAgICAgICAgICAgIChjaGFy
ICopcHJvcC0+ZGF0YSk7CisgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAgfQor
CisgICAgICAgIHJlcyA9IGlvbW11X2FkZF9kdF9kZXZpY2Uobm9kZSk7CisgICAgICAgIGlmICgg
cmVzIDwgMCApCisgICAgICAgICAgICByZXR1cm4gcmVzOworCisgICAgICAgIGlmICggZHRfZGV2
aWNlX2lzX3Byb3RlY3RlZChub2RlKSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHJlcyA9IGlv
bW11X2Fzc2lnbl9kdF9kZXZpY2Uoa2luZm8tPmQsIG5vZGUpOworICAgICAgICAgICAgaWYgKCBy
ZXMgPCAwICkKKyAgICAgICAgICAgICAgICByZXR1cm4gcmVzOworICAgICAgICB9CisKKyAgICAg
ICAgcmVzID0gaGFuZGxlX2RldmljZV9pbnRlcnJ1cHRzKGtpbmZvLT5kLCBub2RlLCB0cnVlKTsK
KyAgICAgICAgaWYgKCByZXMgPCAwICkKKyAgICAgICAgICAgIHJldHVybiByZXM7CisKKyAgICAg
ICAgcmV0dXJuIDA7CisgICAgfQorCisgICAgcmV0dXJuIDE7Cit9CisKIHN0YXRpYyBpbnQgX19p
bml0IGhhbmRsZV9wcm9wX3BmZHQoc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbywKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdm9pZCAqcGZkdCwgaW50IG5vZGVvZmYs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGFkZHJlc3NfY2Vs
bHMsIHVpbnQzMl90IHNpemVfY2VsbHMsCkBAIC0xNzIyLDYgKzE4MTIsNyBAQCBzdGF0aWMgaW50
IF9faW5pdCBoYW5kbGVfcHJvcF9wZmR0KHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8sCiAgICAg
dm9pZCAqZmR0ID0ga2luZm8tPmZkdDsKICAgICBpbnQgcHJvcG9mZiwgbmFtZW9mZiwgcmVzOwog
ICAgIGNvbnN0IHN0cnVjdCBmZHRfcHJvcGVydHkgKnByb3A7CisgICAgY29uc3QgY2hhciAqbmFt
ZTsKIAogICAgIGZvciAoIHByb3BvZmYgPSBmZHRfZmlyc3RfcHJvcGVydHlfb2Zmc2V0KHBmZHQs
IG5vZGVvZmYpOwogICAgICAgICAgIHByb3BvZmYgPj0gMDsKQEAgLTE3MzAsMTEgKzE4MjEsMjYg
QEAgc3RhdGljIGludCBfX2luaXQgaGFuZGxlX3Byb3BfcGZkdChzdHJ1Y3Qga2VybmVsX2luZm8g
KmtpbmZvLAogICAgICAgICBpZiAoICEocHJvcCA9IGZkdF9nZXRfcHJvcGVydHlfYnlfb2Zmc2V0
KHBmZHQsIHByb3BvZmYsIE5VTEwpKSApCiAgICAgICAgICAgICByZXR1cm4gLUZEVF9FUlJfSU5U
RVJOQUw7CiAKKyAgICAgICAgcmVzID0gMDsKICAgICAgICAgbmFtZW9mZiA9IGZkdDMyX3RvX2Nw
dShwcm9wLT5uYW1lb2ZmKTsKLSAgICAgICAgcmVzID0gZmR0X3Byb3BlcnR5KGZkdCwgZmR0X3N0
cmluZyhwZmR0LCBuYW1lb2ZmKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3AtPmRh
dGEsIGZkdDMyX3RvX2NwdShwcm9wLT5sZW4pKTsKLSAgICAgICAgaWYgKCByZXMgKQorICAgICAg
ICBuYW1lID0gZmR0X3N0cmluZyhwZmR0LCBuYW1lb2ZmKTsKKworICAgICAgICBpZiAoIHNjYW5f
cGFzc3Rocm91Z2hfcHJvcCApCisgICAgICAgICAgICByZXMgPSBoYW5kbGVfcGFzc3Rocm91Z2hf
cHJvcChraW5mbywgcHJvcCwgbmFtZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGFkZHJlc3NfY2VsbHMsIHNpemVfY2VsbHMpOworICAgICAgICBpZiAoIHJlcyA8
IDAgKQogICAgICAgICAgICAgcmV0dXJuIHJlczsKKworICAgICAgICAvKgorICAgICAgICAgKiBD
b3B5IHByb3BlcnRpZXMgb3RoZXIgdGhhbiB4ZW4scmVnIGFuZCB4ZW4scGF0aCwgd2hpY2ggYXJl
CisgICAgICAgICAqIGhhbmRsZWQgYnkgaGFuZGxlX3Bhc3N0aHJvdWdoX3Byb3AuCisgICAgICAg
ICAqLworICAgICAgICBpZiAoICFzY2FuX3Bhc3N0aHJvdWdoX3Byb3AgfHwgcmVzID4gMCApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIHJlcyA9IGZkdF9wcm9wZXJ0eShmZHQsIG5hbWUsIHByb3At
PmRhdGEsIGZkdDMyX3RvX2NwdShwcm9wLT5sZW4pKTsKKyAgICAgICAgICAgIGlmICggcmVzICkK
KyAgICAgICAgICAgICAgICByZXR1cm4gcmVzOworICAgICAgICB9CiAgICAgfQogCiAgICAgLyog
RkRUX0VSUl9OT1RGT1VORCA9PiBUaGVyZSBpcyBubyBtb3JlIHByb3BlcnRpZXMgZm9yIHRoaXMg
bm9kZSAqLwpAQCAtMjI5MSw2ICsyMzk3LDkgQEAgdm9pZCBfX2luaXQgY3JlYXRlX2RvbVVzKHZv
aWQpCiAgICAgICAgICAgICBwYW5pYygiTWlzc2luZyBwcm9wZXJ0eSAnY3B1cycgZm9yIGRvbWFp
biAlc1xuIiwKICAgICAgICAgICAgICAgICAgIGR0X25vZGVfbmFtZShub2RlKSk7CiAKKyAgICAg
ICAgaWYgKCBkdF9maW5kX2NvbXBhdGlibGVfbm9kZShub2RlLCBOVUxMLCAibXVsdGlib290LGRl
dmljZS10cmVlIikgKQorICAgICAgICAgICAgZF9jZmcuZmxhZ3MgfD0gWEVOX0RPTUNUTF9DREZf
aW9tbXU7CisKICAgICAgICAgZCA9IGRvbWFpbl9jcmVhdGUoKyttYXhfaW5pdF9kb21pZCwgJmRf
Y2ZnLCBmYWxzZSk7CiAgICAgICAgIGlmICggSVNfRVJSKGQpICkKICAgICAgICAgICAgIHBhbmlj
KCJFcnJvciBjcmVhdGluZyBkb21haW4gJXNcbiIsIGR0X25vZGVfbmFtZShub2RlKSk7Ci0tIAoy
LjE3LjEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpY
ZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRw
czovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 36E88FE5F6
	for <lists+xen-devel@lfdr.de>; Fri, 15 Nov 2019 20:48:12 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVhXw-00026w-Rb; Fri, 15 Nov 2019 19:46:20 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=1SQg=ZH=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iVhXv-000267-Hz
 for xen-devel@lists.xenproject.org; Fri, 15 Nov 2019 19:46:19 +0000
X-Inumbo-ID: 74506430-07e0-11ea-984a-bc764e2007e4
Received: from mail-qk1-x72a.google.com (unknown [2607:f8b0:4864:20::72a])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 74506430-07e0-11ea-984a-bc764e2007e4;
 Fri, 15 Nov 2019 19:45:19 +0000 (UTC)
Received: by mail-qk1-x72a.google.com with SMTP id h15so9013826qka.13
 for <xen-devel@lists.xenproject.org>; Fri, 15 Nov 2019 11:45:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=e8E7ZMifBksXLCOBakwFs52aGQldhJxVpMbgFhvu6iM=;
 b=lR7GgZ+eY19BbzyRYcytHYw871UCa/OD3QKWr0BDHMv1UyBToyqrIa1+e5LR6g1xig
 mh78nJF/ls4GT6c+NcDr3M6MQ2yFjpTe23Y/6IEiaFNoAaUCl93TRYwLkAPqbNGwTfh7
 UHQE+zkzJOHTWUMjaXocQbUrjKVZNJGltYCcMSk32h+2ouu3QPboiQbg3q86gqMiSJ0C
 Wf2abDmAS5pzqK9s5EP5GQjXWIPK28giGCniTAddlvNzVxl9eh8w9lyDqeZAJkTAZktn
 LpdTmEGQQzgQFF4WMCHyF3Gfl9Smh5hNawy0+gGB3+2bPpf2f5XI5+BDCCQATFsMW+JI
 mWtA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=e8E7ZMifBksXLCOBakwFs52aGQldhJxVpMbgFhvu6iM=;
 b=Nxf6rTAqAAG/Udrlk8O7waretHdHmEKFDncIfzir0fxWTbTPJHDTUDdaYmLYCfXl9e
 21BJJiRn5iyaPfrDIt9r0Sk7rVeP51017CNi+Dm4BMVVN+1LKjCKB4OPLgL71NWDQSsG
 7jRkm0LE3WVjEKAGIxvrXC+Y2s+u1Ws1bwrWHULEG0o8nlhRa0WuVjBE1edf6vE+wGQT
 1AIKXjUa8D2x3kL/VDvQeykj4dNPo2ynUpqE0Cm/ug8eEVvSIhhEcJhqsd6zU0Hn0rwQ
 atWQ/R7UECtCiAX4B5IFh18DzmxoIIuF4vtNlc0imilf+EQ1DJOL3xXoyhdOCiMqWUYf
 jiUA==
X-Gm-Message-State: APjAAAW6rR1sRm4LE//X6u7Sfy3lfPyy6zP5+0Eq/lFDo+ScX6JASf2O
 jJ0YYgd0oLrPCn6e9rmz0FFK8pXQ
X-Google-Smtp-Source: APXvYqxyXPe6/MsRhxW33dYxYCcIvivMhmgT0mq/xUYCQxBDUs9SKoke94L2xYKBiGCf/dCGtViRJQ==
X-Received: by 2002:a05:620a:12c9:: with SMTP id
 e9mr13532684qkl.97.1573847118111; 
 Fri, 15 Nov 2019 11:45:18 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id y10sm4649679qkb.55.2019.11.15.11.45.16
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 15 Nov 2019 11:45:17 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 15 Nov 2019 14:44:23 -0500
Message-Id: <938dbf7c3a083ec050c16729805f4ce5f3f2891f.1573840474.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1573840473.git.rosbrookn@ainfosec.com>
References: <cover.1573840473.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 16/22] golang/xenlight: implement keyed union
 C to Go marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClN3aXRjaCBvdmVy
IHVuaW9uIGtleSB0byBkZXRlcm1pbmUgaG93IHRvIHBvcHVsYXRlICd1bmlvbicgaW4gR28gc3Ry
dWN0LgoKU2luY2UgdGhlIHVuaW9ucyBvZiBDIHR5cGVzIGNhbm5vdCBiZSBkaXJlY3RseSBhY2Nl
c3NlZCwgYWRkIEMgc3RydWN0cyBpbgpjZ28gcHJlYW1ibGUgdG8gYXNzaXN0IGluIG1hcnNoYWxp
bmcga2V5ZWQgdW5pb25zLiBUaGlzIGFsbG93cyB0aGUgQwp0eXBlIGRlZmluZWQgaW4gdGhlIHBy
ZWFtYmxlIHRvIGJlIHBvcHVsYXRlZCBmaXJzdCwgYW5kIHRoZW4gYWNjZXNzZWQKZGlyZWN0bHkg
dG8gcG9wdWxhdGUgdGhlIEdvIHN0cnVjdC4KClNpZ25lZC1vZmYtYnk6IE5pY2sgUm9zYnJvb2sg
PHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQpDaGFuZ2VzIGluIHYyOgotIERvIG5vdCB1c2Ug
Z2xvYmFsIHZhcmlhYmxlIGZvciBleHRyYSBoZWxwZXIgZnVuY3Rpb24gZGVmaW5pdGlvbnMuCiAg
SW5zdGVhZCwgcmV0dXJuIGEgdHVwbGUgd2hpY2ggY29udGFpbnMgYSBsaXN0IG9mIGV4dHJhIGhl
bHBlcgogIGZ1bmN0aW9ucyBhc3NvY2lhdGVkIHdpdGggdGhlIG9yaWdpbmFsLgogCiB0b29scy9n
b2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSAgfCAxNTMgKysrKysrKysrLQogdG9vbHMvZ29s
YW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvIHwgNDQwICsrKysrKysrKysrKysrKysrKysrKysr
KysrKwogMiBmaWxlcyBjaGFuZ2VkLCA1OTAgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSBiL3Rvb2xz
L2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CmluZGV4IDBjOGExMzI3YTEuLjU3Y2VjZDU5
ODkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CisrKyBi
L3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CkBAIC0yNCw2ICsyNCwxMCBAQCBn
b19rZXl3b3JkcyA9IFsndHlwZScsICdmdW5jJ10KIGdvX2J1aWx0aW5fdHlwZXMgPSBbJ2Jvb2wn
LCAnc3RyaW5nJywgJ2ludCcsICdieXRlJywKICAgICAgICAgICAgICAgICAgICAgJ3VpbnQxNics
ICd1aW50MzInLCAndWludDY0J10KIAorIyBjZ28gcHJlYW1ibGUgZm9yIHhlbmxpZ2h0X2hlbHBl
cnMuZ28sIGNyZWF0ZWQgZHVyaW5nIHR5cGUgZ2VuZXJhdGlvbiBhbmQKKyMgd3JpdHRlbiBsYXRl
ci4KK2Nnb19oZWxwZXJzX3ByZWFtYmxlID0gW10KKwogZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5l
cmF0ZV90eXBlcyhwYXRoID0gTm9uZSwgdHlwZXMgPSBOb25lLCBjb21tZW50ID0gTm9uZSk6CiAg
ICAgIiIiCiAgICAgR2VuZXJhdGUgYSAuZ28gZmlsZSAodHlwZXMuZ2VuLmdvIGJ5IGRlZmF1bHQp
CkBAIC0xNjgsNiArMTcyLDggQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfdW5pb24odHkg
PSBOb25lLCBzdHJ1Y3RuYW1lID0gJycpOgogICAgICAgICBleHRyYXMuYXBwZW5kKHJbMF0pCiAg
ICAgICAgIGV4dHJhcy5leHRlbmQoclsxXSkKIAorICAgICAgICB4ZW5saWdodF9nb2xhbmdfdW5p
b25fY2dvX3ByZWFtYmxlKGYudHlwZSwgbmFtZT1uYW1lKQorCiAgICAgICAgICMgRGVmaW5lIGZ1
bmN0aW9uIHRvIGltcGxlbWVudCAndW5pb24nIGludGVyZmFjZQogICAgICAgICBuYW1lID0geGVu
bGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG5hbWUpCiAgICAgICAgIHMgPSAnZnVuYyAoeCB7fSkgaXN7
fSgpe3t9fVxuJy5mb3JtYXQobmFtZSwgaW50ZXJmYWNlX25hbWUpCkBAIC0xODIsNiArMTg4LDE4
IEBAIGRlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX3VuaW9uKHR5ID0gTm9uZSwgc3RydWN0bmFt
ZSA9ICcnKToKIAogICAgIHJldHVybiAocyxleHRyYXMpCiAKK2RlZiB4ZW5saWdodF9nb2xhbmdf
dW5pb25fY2dvX3ByZWFtYmxlKHR5ID0gTm9uZSwgbmFtZSA9ICcnKToKKyAgICBzID0gJycKKwor
ICAgIHMgKz0gJ3R5cGVkZWYgc3RydWN0IHt9IHt7XG4nLmZvcm1hdChuYW1lKQorCisgICAgZm9y
IGYgaW4gdHkuZmllbGRzOgorICAgICAgICBzICs9ICdcdHt9IHt9O1xuJy5mb3JtYXQoZi50eXBl
LnR5cGVuYW1lLCBmLm5hbWUpCisKKyAgICBzICs9ICd9fSB7fTtcbicuZm9ybWF0KG5hbWUpCisK
KyAgICBjZ29faGVscGVyc19wcmVhbWJsZS5hcHBlbmQocykKKwogZGVmIHhlbmxpZ2h0X2dvbGFu
Z19nZW5lcmF0ZV9oZWxwZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5vbmUsIGNvbW1lbnQgPSBO
b25lKToKICAgICAiIiIKICAgICBHZW5lcmF0ZSBhIC5nbyBmaWxlIChoZWxwZXJzLmdlbi5nbyBi
eSBkZWZhdWx0KQpAQCAtMTk1LDYgKzIxMyw3IEBAIGRlZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJh
dGVfaGVscGVycyhwYXRoID0gTm9uZSwgdHlwZXMgPSBOb25lLCBjb21tZW50ID0gTm9uZSk6CiAg
ICAgICAgIGlmIGNvbW1lbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICBmLndyaXRlKGNvbW1l
bnQpCiAgICAgICAgIGYud3JpdGUoJ3BhY2thZ2UgeGVubGlnaHRcbicpCisgICAgICAgIGYud3Jp
dGUoJ2ltcG9ydCAoXG4idW5zYWZlIlxuImVycm9ycyJcbiJmbXQiXG4pXG4nKQogCiAgICAgICAg
ICMgQ2dvIHByZWFtYmxlCiAgICAgICAgIGYud3JpdGUoJy8qXG4nKQpAQCAtMjAzLDE5ICsyMjIs
MzggQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5lcmF0ZV9oZWxwZXJzKHBhdGggPSBOb25lLCB0
eXBlcyA9IE5vbmUsIGNvbW1lbnQgPSBOb25lKToKICAgICAgICAgZi53cml0ZSgnI2luY2x1ZGUg
PGxpYnhsLmg+XG4nKQogICAgICAgICBmLndyaXRlKCdcbicpCiAKKyAgICAgICAgZm9yIHMgaW4g
Y2dvX2hlbHBlcnNfcHJlYW1ibGU6CisgICAgICAgICAgICBmLndyaXRlKHMpCisgICAgICAgICAg
ICBmLndyaXRlKCdcbicpCisKICAgICAgICAgZi53cml0ZSgnKi9cbmltcG9ydCAiQyJcbicpCiAK
ICAgICAgICAgZm9yIHR5IGluIHR5cGVzOgogICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uo
dHksIGlkbC5TdHJ1Y3QpOgogICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAKLSAgICAgICAgICAg
IGYud3JpdGUoeGVubGlnaHRfZ29sYW5nX2RlZmluZV9mcm9tX0ModHkpKQorICAgICAgICAgICAg
KGZkZWYsIGV4dHJhcykgPSB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSkKKworICAg
ICAgICAgICAgZi53cml0ZShmZGVmKQogICAgICAgICAgICAgZi53cml0ZSgnXG4nKQogCisgICAg
ICAgICAgICBmb3IgZXh0cmEgaW4gZXh0cmFzOgorICAgICAgICAgICAgICAgIGYud3JpdGUoZXh0
cmEpCisgICAgICAgICAgICAgICAgZi53cml0ZSgnXG4nKQorCiAgICAgZ29fZm10KHBhdGgpCiAK
IGRlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSA9IE5vbmUsIHR5cGVuYW1lID0g
Tm9uZSwgbmVzdGVkID0gRmFsc2UpOgorICAgICIiIgorICAgIERlZmluZSB0aGUgZnJvbUMgaGVs
cGVyIGZ1bmN0aW9uIGZvciB0eS4KKworICAgIFJldHVybiBhIHR1cGxlIHRoYXQgY29udGFpbnMg
YSBzdHJpbmcgd2l0aCB0aGUKKyAgICBmdW5jdGlvbiBkZWZpbml0aW9uLCBhbmQgYSAocG90ZW50
aWFsbHkgZW1wdHkpIGxpc3QKKyAgICBvZiBleHRyYSBkZWZpbml0aW9ucyB0aGF0IGFyZSBhc3Nv
Y2lhdGVkIHdpdGgKKyAgICB0aGlzIGhlbHBlciBmdW5jdGlvbi4KKyAgICAiIiIKICAgICBzID0g
JycKKyAgICBleHRyYXMgPSBbXQogCiAgICAgZ290eXBlbmFtZSA9IGN0eXBlbmFtZSA9ICcnCiAK
QEAgLTI4MCwxMCArMzE4LDE2IEBAIGRlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0
eSA9IE5vbmUsIHR5cGVuYW1lID0gTm9uZSwgbmVzdGVkID0gRmFsc2UpOgogICAgICAgICAgICAg
ICAgIHMgKz0gJ3gue30gPSB7fVxuJy5mb3JtYXQoZ29uYW1lLCB2YXJuYW1lKQogCiAgICAgICAg
IGVsaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5TdHJ1Y3QpOgotICAgICAgICAgICAgcyArPSB4
ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyhmLnR5cGUsIHR5cGVuYW1lPWYubmFtZSwgbmVz
dGVkPVRydWUpCisgICAgICAgICAgICByID0geGVubGlnaHRfZ29sYW5nX2RlZmluZV9mcm9tX0Mo
Zi50eXBlLCB0eXBlbmFtZT1mLm5hbWUsIG5lc3RlZD1UcnVlKQorCisgICAgICAgICAgICBzICs9
IHJbMF0KKyAgICAgICAgICAgIGV4dHJhcy5leHRlbmQoclsxXSkKIAogICAgICAgICBlbGlmIGlz
aW5zdGFuY2UoZi50eXBlLCBpZGwuS2V5ZWRVbmlvbik6Ci0gICAgICAgICAgICBwYXNzCisgICAg
ICAgICAgICByID0geGVubGlnaHRfZ29sYW5nX3VuaW9uX2Zyb21fQyhmLnR5cGUsIGYubmFtZSwg
dHkudHlwZW5hbWUpCisKKyAgICAgICAgICAgIHMgKz0gclswXQorICAgICAgICAgICAgZXh0cmFz
LmV4dGVuZChyWzFdKQogCiAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICByYWlzZSBFeGNlcHRp
b24oJ3R5cGUge30gbm90IHN1cHBvcnRlZCcuZm9ybWF0KGYudHlwZSkpCkBAIC0yOTIsNiArMzM2
LDEwOSBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmluZV9mcm9tX0ModHkgPSBOb25lLCB0eXBl
bmFtZSA9IE5vbmUsIG5lc3RlZCA9IEZhbHNlKToKICAgICAgICAgcyArPSAncmV0dXJuIG5pbCcK
ICAgICAgICAgcyArPSAnfVxuJwogCisgICAgcmV0dXJuIChzLGV4dHJhcykKKworZGVmIHhlbmxp
Z2h0X2dvbGFuZ191bmlvbl9mcm9tX0ModHkgPSBOb25lLCB1bmlvbl9uYW1lID0gJycsIHN0cnVj
dF9uYW1lID0gJycpOgorICAgIGV4dHJhcyA9IFtdCisKKyAgICBrZXluYW1lICAgPSB0eS5rZXl2
YXIubmFtZQorICAgIGdva2V5bmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShrZXluYW1l
KQorICAgIGtleXR5cGUgICA9IHR5LmtleXZhci50eXBlLnR5cGVuYW1lCisgICAgZ29rZXl0eXBl
ID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGtleXR5cGUpCisKKyAgICBpbnRlcmZhY2VfbmFt
ZSA9ICd7fV97fV91bmlvbicuZm9ybWF0KHN0cnVjdF9uYW1lLCBrZXluYW1lKQorICAgIGludGVy
ZmFjZV9uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGludGVyZmFjZV9uYW1lLCBleHBv
cnRlZD1GYWxzZSkKKworICAgIGNnb19rZXluYW1lID0ga2V5bmFtZQorICAgIGlmIGNnb19rZXlu
YW1lIGluIGdvX2tleXdvcmRzOgorICAgICAgICBjZ29fa2V5bmFtZSA9ICdfJyArIGNnb19rZXlu
YW1lCisKKyAgICBjYXNlcyA9IHt9CisKKyAgICBmb3IgZiBpbiB0eS5maWVsZHM6CisgICAgICAg
IHZhbCA9ICd7fV97fScuZm9ybWF0KGtleXR5cGUsIGYubmFtZSkKKyAgICAgICAgdmFsID0geGVu
bGlnaHRfZ29sYW5nX2ZtdF9uYW1lKHZhbCkKKworICAgICAgICAjIEFkZCB0byBsaXN0IG9mIGNh
c2VzIHRvIG1ha2UgZm9yIHRoZSBzd2l0Y2gKKyAgICAgICAgIyBzdGF0ZW1lbnQgYmVsb3cuCisg
ICAgICAgIGlmIGYudHlwZSBpcyBOb25lOgorICAgICAgICAgICAgY29udGludWUKKworICAgICAg
ICBjYXNlc1tmLm5hbWVdID0gdmFsCisKKyAgICAgICAgIyBEZWZpbmUgZnJvbUMgZnVuYyBmb3Ig
J3VuaW9uJyBzdHJ1Y3QuCisgICAgICAgIHR5cGVuYW1lICAgPSAne31fe31fdW5pb25fe30nLmZv
cm1hdChzdHJ1Y3RfbmFtZSxrZXluYW1lLGYubmFtZSkKKyAgICAgICAgZ290eXBlbmFtZSA9IHhl
bmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eXBlbmFtZSkKKworICAgICAgICAjIERlZmluZSB0aGUg
ZnVuY3Rpb24gaGVyZS4gVGhlIGNhc2VzIGZvciBrZXllZCB1bmlvbnMgYXJlIGEgbGl0dGxlCisg
ICAgICAgICMgZGlmZmVyZW50LgorICAgICAgICBzID0gJ2Z1bmMgKHggKnt9KSBmcm9tQyh4YyAq
Qy57fSkgZXJyb3Ige3tcbicuZm9ybWF0KGdvdHlwZW5hbWUsc3RydWN0X25hbWUpCisgICAgICAg
IHMgKz0gJ2lmIHt9KHhjLnt9KSAhPSB7fSB7e1xuJy5mb3JtYXQoZ29rZXl0eXBlLGNnb19rZXlu
YW1lLHZhbCkKKyAgICAgICAgZXJyX3N0cmluZyA9ICciZXhwZWN0ZWQgdW5pb24ga2V5IHt9Iicu
Zm9ybWF0KHZhbCkKKyAgICAgICAgcyArPSAncmV0dXJuIGVycm9ycy5OZXcoe30pXG4nLmZvcm1h
dChlcnJfc3RyaW5nKQorICAgICAgICBzICs9ICd9XG5cbicKKyAgICAgICAgcyArPSAndG1wIDo9
ICgqQy57fSkodW5zYWZlLlBvaW50ZXIoJnhjLnt9WzBdKSlcbicuZm9ybWF0KHR5cGVuYW1lLHVu
aW9uX25hbWUpCisKKyAgICAgICAgcyArPSB4ZW5saWdodF9nb2xhbmdfdW5pb25fZmllbGRzX2Zy
b21fQyhmLnR5cGUpCisgICAgICAgIHMgKz0gJ3JldHVybiBuaWxcbicKKyAgICAgICAgcyArPSAn
fVxuJworCisgICAgICAgIGV4dHJhcy5hcHBlbmQocykKKworICAgIHMgPSAneC57fSA9IHt9KHhj
Lnt9KVxuJy5mb3JtYXQoZ29rZXluYW1lLGdva2V5dHlwZSxjZ29fa2V5bmFtZSkKKyAgICBzICs9
ICdzd2l0Y2ggeC57fXt7XG4nLmZvcm1hdChnb2tleW5hbWUpCisKKyAgICAjIENyZWF0ZSBzd2l0
Y2ggc3RhdGVtZW50IHRvIGRldGVybWluZSB3aGljaCAndW5pb24gZWxlbWVudCcKKyAgICAjIHRv
IHBvcHVsYXRlIGluIHRoZSBHbyBzdHJ1Y3QuCisgICAgZm9yIGNhc2VfbmFtZSwgY2FzZV92YWwg
aW4gY2FzZXMuaXRlbXMoKToKKyAgICAgICAgcyArPSAnY2FzZSB7fTpcbicuZm9ybWF0KGNhc2Vf
dmFsKQorCisgICAgICAgIGdvdHlwZSA9ICd7fV97fV91bmlvbl97fScuZm9ybWF0KHN0cnVjdF9u
YW1lLGtleW5hbWUsY2FzZV9uYW1lKQorICAgICAgICBnb3R5cGUgPSB4ZW5saWdodF9nb2xhbmdf
Zm10X25hbWUoZ290eXBlKQorICAgICAgICBnb25hbWUgPSAne31fe30nLmZvcm1hdChrZXluYW1l
LGNhc2VfbmFtZSkKKyAgICAgICAgZ29uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGdv
bmFtZSxleHBvcnRlZD1GYWxzZSkKKworICAgICAgICBzICs9ICd2YXIge30ge31cbicuZm9ybWF0
KGdvbmFtZSwgZ290eXBlKQorICAgICAgICBzICs9ICdpZiBlcnIgOj0ge30uZnJvbUMoeGMpOycu
Zm9ybWF0KGdvbmFtZSkKKyAgICAgICAgcyArPSAnZXJyICE9IG5pbCB7XG4gcmV0dXJuIGVyciBc
bn1cbicKKworICAgICAgICBmaWVsZF9uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKCd7
fV91bmlvbicuZm9ybWF0KGtleW5hbWUpKQorICAgICAgICBzICs9ICd4Lnt9ID0ge31cbicuZm9y
bWF0KGZpZWxkX25hbWUsIGdvbmFtZSkKKworICAgICMgRW5kIHN3aXRjaCBzdGF0ZW1lbnQKKyAg
ICBzICs9ICdkZWZhdWx0OlxuJworICAgIGVycl9zdHJpbmcgPSAnImludmFsaWQgdW5pb24ga2V5
IFwnJXZcJyIsIHgue30nLmZvcm1hdChnb2tleW5hbWUpCisgICAgcyArPSAncmV0dXJuIGZtdC5F
cnJvcmYoe30pJy5mb3JtYXQoZXJyX3N0cmluZykKKyAgICBzICs9ICd9XG4nCisKKyAgICByZXR1
cm4gKHMsZXh0cmFzKQorCitkZWYgeGVubGlnaHRfZ29sYW5nX3VuaW9uX2ZpZWxkc19mcm9tX0Mo
dHkgPSBOb25lKToKKyAgICBzID0gJycKKworICAgIGZvciBmIGluIHR5LmZpZWxkczoKKyAgICAg
ICAgZ290eXBlbmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShmLnR5cGUudHlwZW5hbWUp
CisgICAgICAgIGN0eXBlbmFtZSAgPSBmLnR5cGUudHlwZW5hbWUKKyAgICAgICAgZ29mbmFtZSAg
ICA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShmLm5hbWUpCisgICAgICAgIGNmbmFtZSAgICAg
PSBmLm5hbWUKKworICAgICAgICBpc19jYXN0YWJsZSA9IChmLnR5cGUuanNvbl9wYXJzZV90eXBl
ID09ICdKU09OX0lOVEVHRVInIG9yCisgICAgICAgICAgICAgICAgICAgICAgIGlzaW5zdGFuY2Uo
Zi50eXBlLCBpZGwuRW51bWVyYXRpb24pIG9yCisgICAgICAgICAgICAgICAgICAgICAgIGdvdHlw
ZW5hbWUgaW4gZ29fYnVpbHRpbl90eXBlcykKKworICAgICAgICBpZiBub3QgaXNfY2FzdGFibGU6
CisgICAgICAgICAgICBzICs9ICdpZiBlcnIgOj0geC57fS5mcm9tQygmdG1wLnt9KTsnLmZvcm1h
dChnb2ZuYW1lLGNmbmFtZSkKKyAgICAgICAgICAgIHMgKz0gJ2VyciAhPSBuaWwge1xuIHJldHVy
biBlcnIgXG59XG4nCisKKyAgICAgICAgIyBXZSBqdXN0IGRpZCBhbiB1bnNhZmUuUG9pbnRlciBj
YXN0IGZyb20gW11ieXRlIHRvIHRoZSAndW5pb24nIHR5cGUKKyAgICAgICAgIyBzdHJ1Y3QsIHNv
IHdlIG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYW55IHN0cmluZyBmaWVsZHMgYXJlIGFjdHVhbGx5
CisgICAgICAgICMgY29udmVydGVkIHByb3Blcmx5LgorICAgICAgICBlbGlmIGdvdHlwZW5hbWUg
PT0gJ3N0cmluZyc6CisgICAgICAgICAgICBzICs9ICd4Lnt9ID0gQy5Hb1N0cmluZyh0bXAue30p
XG4nLmZvcm1hdChnb2ZuYW1lLGNmbmFtZSkKKworICAgICAgICBlbHNlOgorICAgICAgICAgICAg
cyArPSAneC57fSA9IHt9KHRtcC57fSlcbicuZm9ybWF0KGdvZm5hbWUsZ290eXBlbmFtZSxjZm5h
bWUpCisKICAgICByZXR1cm4gcwogCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG5hbWUs
IGV4cG9ydGVkID0gVHJ1ZSk6CmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvaGVs
cGVycy5nZW4uZ28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5kZXgg
MGRlNDJlYWE2Yi4uZDJkZDlmMjUwNyAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2hlbHBlcnMuZ2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5n
bwpAQCAtNSwxMSArNSwxMjIgQEAKIC8vCiBwYWNrYWdlIHhlbmxpZ2h0CiAKK2ltcG9ydCAoCisJ
ImVycm9ycyIKKwkiZm10IgorCSJ1bnNhZmUiCispCisKIC8qCiAjY2dvIExERkxBR1M6IC1seGVu
bGlnaHQKICNpbmNsdWRlIDxzdGRsaWIuaD4KICNpbmNsdWRlIDxsaWJ4bC5oPgogCit0eXBlZGVm
IHN0cnVjdCBsaWJ4bF9jaGFubmVsaW5mb19jb25uZWN0aW9uX3VuaW9uX3B0eSB7CisJY2hhciAq
IHBhdGg7Cit9IGxpYnhsX2NoYW5uZWxpbmZvX2Nvbm5lY3Rpb25fdW5pb25fcHR5OworCit0eXBl
ZGVmIHN0cnVjdCBsaWJ4bF9kb21haW5fYnVpbGRfaW5mb190eXBlX3VuaW9uX2h2bSB7CisJY2hh
ciAqIGZpcm13YXJlOworCWxpYnhsX2Jpb3NfdHlwZSBiaW9zOworCWxpYnhsX2RlZmJvb2wgcGFl
OworCWxpYnhsX2RlZmJvb2wgYXBpYzsKKwlsaWJ4bF9kZWZib29sIGFjcGk7CisJbGlieGxfZGVm
Ym9vbCBhY3BpX3MzOworCWxpYnhsX2RlZmJvb2wgYWNwaV9zNDsKKwlsaWJ4bF9kZWZib29sIGFj
cGlfbGFwdG9wX3NsYXRlOworCWxpYnhsX2RlZmJvb2wgbng7CisJbGlieGxfZGVmYm9vbCB2aXJp
ZGlhbjsKKwlsaWJ4bF9iaXRtYXAgdmlyaWRpYW5fZW5hYmxlOworCWxpYnhsX2JpdG1hcCB2aXJp
ZGlhbl9kaXNhYmxlOworCWNoYXIgKiB0aW1lb2Zmc2V0OworCWxpYnhsX2RlZmJvb2wgaHBldDsK
KwlsaWJ4bF9kZWZib29sIHZwdF9hbGlnbjsKKwl1aW50NjRfdCBtbWlvX2hvbGVfbWVta2I7CisJ
bGlieGxfdGltZXJfbW9kZSB0aW1lcl9tb2RlOworCWxpYnhsX2RlZmJvb2wgbmVzdGVkX2h2bTsK
KwlsaWJ4bF9kZWZib29sIGFsdHAybTsKKwljaGFyICogc3lzdGVtX2Zpcm13YXJlOworCWNoYXIg
KiBzbWJpb3NfZmlybXdhcmU7CisJY2hhciAqIGFjcGlfZmlybXdhcmU7CisJbGlieGxfaGR0eXBl
IGhkdHlwZTsKKwlsaWJ4bF9kZWZib29sIG5vZ3JhcGhpYzsKKwlsaWJ4bF92Z2FfaW50ZXJmYWNl
X2luZm8gdmdhOworCWxpYnhsX3ZuY19pbmZvIHZuYzsKKwljaGFyICoga2V5bWFwOworCWxpYnhs
X3NkbF9pbmZvIHNkbDsKKwlsaWJ4bF9zcGljZV9pbmZvIHNwaWNlOworCWxpYnhsX2RlZmJvb2wg
Z2Z4X3Bhc3N0aHJ1OworCWxpYnhsX2dmeF9wYXNzdGhydV9raW5kIGdmeF9wYXNzdGhydV9raW5k
OworCWNoYXIgKiBzZXJpYWw7CisJY2hhciAqIGJvb3Q7CisJbGlieGxfZGVmYm9vbCB1c2I7CisJ
aW50IHVzYnZlcnNpb247CisJY2hhciAqIHVzYmRldmljZTsKKwlsaWJ4bF9kZWZib29sIHZrYl9k
ZXZpY2U7CisJY2hhciAqIHNvdW5kaHc7CisJbGlieGxfZGVmYm9vbCB4ZW5fcGxhdGZvcm1fcGNp
OworCWxpYnhsX3N0cmluZ19saXN0IHVzYmRldmljZV9saXN0OworCWxpYnhsX3ZlbmRvcl9kZXZp
Y2UgdmVuZG9yX2RldmljZTsKKwlsaWJ4bF9tc192bV9nZW5pZCBtc192bV9nZW5pZDsKKwlsaWJ4
bF9zdHJpbmdfbGlzdCBzZXJpYWxfbGlzdDsKKwlsaWJ4bF9yZG1fcmVzZXJ2ZSByZG07CisJdWlu
dDY0X3QgcmRtX21lbV9ib3VuZGFyeV9tZW1rYjsKKwl1aW50NjRfdCBtY2FfY2FwczsKK30gbGli
eGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9odm07CisKK3R5cGVkZWYgc3RydWN0IGxp
YnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5pb25fcHYgeworCWNoYXIgKiBrZXJuZWw7CisJ
dWludDY0X3Qgc2xhY2tfbWVta2I7CisJY2hhciAqIGJvb3Rsb2FkZXI7CisJbGlieGxfc3RyaW5n
X2xpc3QgYm9vdGxvYWRlcl9hcmdzOworCWNoYXIgKiBjbWRsaW5lOworCWNoYXIgKiByYW1kaXNr
OworCWNoYXIgKiBmZWF0dXJlczsKKwlsaWJ4bF9kZWZib29sIGU4MjBfaG9zdDsKK30gbGlieGxf
ZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9wdjsKKwordHlwZWRlZiBzdHJ1Y3QgbGlieGxf
ZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9wdmggeworCWxpYnhsX2RlZmJvb2wgcHZzaGlt
OworCWNoYXIgKiBwdnNoaW1fcGF0aDsKKwljaGFyICogcHZzaGltX2NtZGxpbmU7CisJY2hhciAq
IHB2c2hpbV9leHRyYTsKK30gbGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9wdmg7
CisKK3R5cGVkZWYgc3RydWN0IGxpYnhsX2RldmljZV91c2JkZXZfdHlwZV91bmlvbl9ob3N0ZGV2
IHsKKwl1aW50OF90IGhvc3RidXM7CisJdWludDhfdCBob3N0YWRkcjsKK30gbGlieGxfZGV2aWNl
X3VzYmRldl90eXBlX3VuaW9uX2hvc3RkZXY7CisKK3R5cGVkZWYgc3RydWN0IGxpYnhsX2Rldmlj
ZV9jaGFubmVsX2Nvbm5lY3Rpb25fdW5pb25fc29ja2V0IHsKKwljaGFyICogcGF0aDsKK30gbGli
eGxfZGV2aWNlX2NoYW5uZWxfY29ubmVjdGlvbl91bmlvbl9zb2NrZXQ7CisKK3R5cGVkZWYgc3Ry
dWN0IGxpYnhsX2V2ZW50X3R5cGVfdW5pb25fZG9tYWluX3NodXRkb3duIHsKKwl1aW50OF90IHNo
dXRkb3duX3JlYXNvbjsKK30gbGlieGxfZXZlbnRfdHlwZV91bmlvbl9kb21haW5fc2h1dGRvd247
CisKK3R5cGVkZWYgc3RydWN0IGxpYnhsX2V2ZW50X3R5cGVfdW5pb25fZGlza19lamVjdCB7CisJ
Y2hhciAqIHZkZXY7CisJbGlieGxfZGV2aWNlX2Rpc2sgZGlzazsKK30gbGlieGxfZXZlbnRfdHlw
ZV91bmlvbl9kaXNrX2VqZWN0OworCit0eXBlZGVmIHN0cnVjdCBsaWJ4bF9ldmVudF90eXBlX3Vu
aW9uX29wZXJhdGlvbl9jb21wbGV0ZSB7CisJaW50IHJjOworfSBsaWJ4bF9ldmVudF90eXBlX3Vu
aW9uX29wZXJhdGlvbl9jb21wbGV0ZTsKKwordHlwZWRlZiBzdHJ1Y3QgbGlieGxfcHNyX2h3X2lu
Zm9fdHlwZV91bmlvbl9jYXQgeworCXVpbnQzMl90IGNvc19tYXg7CisJdWludDMyX3QgY2JtX2xl
bjsKKwlib29sIGNkcF9lbmFibGVkOworfSBsaWJ4bF9wc3JfaHdfaW5mb190eXBlX3VuaW9uX2Nh
dDsKKwordHlwZWRlZiBzdHJ1Y3QgbGlieGxfcHNyX2h3X2luZm9fdHlwZV91bmlvbl9tYmEgewor
CXVpbnQzMl90IGNvc19tYXg7CisJdWludDMyX3QgdGhydGxfbWF4OworCWJvb2wgbGluZWFyOwor
fSBsaWJ4bF9wc3JfaHdfaW5mb190eXBlX3VuaW9uX21iYTsKKwogKi8KIGltcG9ydCAiQyIKIApA
QCAtMTUxLDYgKzI2MiwyNyBAQCBmdW5jICh4ICpDaGFubmVsaW5mbykgZnJvbUMoeGMgKkMubGli
eGxfY2hhbm5lbGluZm8pIGVycm9yIHsKIAl4LlN0YXRlID0gaW50KHhjLnN0YXRlKQogCXguRXZ0
Y2ggPSBpbnQoeGMuZXZ0Y2gpCiAJeC5ScmVmID0gaW50KHhjLnJyZWYpCisJeC5Db25uZWN0aW9u
ID0gQ2hhbm5lbENvbm5lY3Rpb24oeGMuY29ubmVjdGlvbikKKwlzd2l0Y2ggeC5Db25uZWN0aW9u
IHsKKwljYXNlIENoYW5uZWxDb25uZWN0aW9uUHR5OgorCQl2YXIgY29ubmVjdGlvblB0eSBDaGFu
bmVsaW5mb0Nvbm5lY3Rpb25VbmlvblB0eQorCQlpZiBlcnIgOj0gY29ubmVjdGlvblB0eS5mcm9t
Qyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguQ29ubmVjdGlvblVu
aW9uID0gY29ubmVjdGlvblB0eQorCWRlZmF1bHQ6CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZh
bGlkIHVuaW9uIGtleSAnJXYnIiwgeC5Db25uZWN0aW9uKQorCX0KKwlyZXR1cm4gbmlsCit9CisK
K2Z1bmMgKHggKkNoYW5uZWxpbmZvQ29ubmVjdGlvblVuaW9uUHR5KSBmcm9tQyh4YyAqQy5saWJ4
bF9jaGFubmVsaW5mbykgZXJyb3IgeworCWlmIENoYW5uZWxDb25uZWN0aW9uKHhjLmNvbm5lY3Rp
b24pICE9IENoYW5uZWxDb25uZWN0aW9uUHR5IHsKKwkJcmV0dXJuIGVycm9ycy5OZXcoImV4cGVj
dGVkIHVuaW9uIGtleSBDaGFubmVsQ29ubmVjdGlvblB0eSIpCisJfQorCisJdG1wIDo9ICgqQy5s
aWJ4bF9jaGFubmVsaW5mb19jb25uZWN0aW9uX3VuaW9uX3B0eSkodW5zYWZlLlBvaW50ZXIoJnhj
LnVbMF0pKQorCXguUGF0aCA9IEMuR29TdHJpbmcodG1wLnBhdGgpCiAJcmV0dXJuIG5pbAogfQog
CkBAIC00MDAsMTIgKzUzMiwxODAgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4
YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IgewogCX0KIAl4LkRtUmVzdHJpY3Qg
PSBkZWZib29sRG1SZXN0cmljdAogCXguVGVlID0gVGVlVHlwZSh4Yy50ZWUpCisJeC5UeXBlID0g
RG9tYWluVHlwZSh4Yy5fdHlwZSkKKwlzd2l0Y2ggeC5UeXBlIHsKKwljYXNlIERvbWFpblR5cGVQ
djoKKwkJdmFyIHR5cGVQdiBEb21haW5CdWlsZEluZm9UeXBlVW5pb25QdgorCQlpZiBlcnIgOj0g
dHlwZVB2LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5U
eXBlVW5pb24gPSB0eXBlUHYKKwljYXNlIERvbWFpblR5cGVIdm06CisJCXZhciB0eXBlSHZtIERv
bWFpbkJ1aWxkSW5mb1R5cGVVbmlvbkh2bQorCQlpZiBlcnIgOj0gdHlwZUh2bS5mcm9tQyh4Yyk7
IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVHlwZVVuaW9uID0gdHlwZUh2
bQorCWNhc2UgRG9tYWluVHlwZVB2aDoKKwkJdmFyIHR5cGVQdmggRG9tYWluQnVpbGRJbmZvVHlw
ZVVuaW9uUHZoCisJCWlmIGVyciA6PSB0eXBlUHZoLmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJ
CQlyZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlUHZoCisJZGVmYXVsdDoKKwkJ
cmV0dXJuIGZtdC5FcnJvcmYoImludmFsaWQgdW5pb24ga2V5ICcldiciLCB4LlR5cGUpCisJfQog
CXguQXJjaEFybS5HaWNWZXJzaW9uID0gR2ljVmVyc2lvbih4Yy5hcmNoX2FybS5naWNfdmVyc2lv
bikKIAl4LkFyY2hBcm0uVnVhcnQgPSBWdWFydFR5cGUoeGMuYXJjaF9hcm0udnVhcnQpCiAJeC5B
bHRwMk0gPSBBbHRwMk1Nb2RlKHhjLmFsdHAybSkKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHgg
KkRvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvbkh2bSkgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1
aWxkX2luZm8pIGVycm9yIHsKKwlpZiBEb21haW5UeXBlKHhjLl90eXBlKSAhPSBEb21haW5UeXBl
SHZtIHsKKwkJcmV0dXJuIGVycm9ycy5OZXcoImV4cGVjdGVkIHVuaW9uIGtleSBEb21haW5UeXBl
SHZtIikKKwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5p
b25faHZtKSh1bnNhZmUuUG9pbnRlcigmeGMudVswXSkpCisJeC5GaXJtd2FyZSA9IEMuR29TdHJp
bmcodG1wLmZpcm13YXJlKQorCXguQmlvcyA9IEJpb3NUeXBlKHRtcC5iaW9zKQorCWlmIGVyciA6
PSB4LlBhZS5mcm9tQygmdG1wLnBhZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQor
CWlmIGVyciA6PSB4LkFwaWMuZnJvbUMoJnRtcC5hcGljKTsgZXJyICE9IG5pbCB7CisJCXJldHVy
biBlcnIKKwl9CisJaWYgZXJyIDo9IHguQWNwaS5mcm9tQygmdG1wLmFjcGkpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5BY3BpUzMuZnJvbUMoJnRtcC5hY3Bp
X3MzKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguQWNwaVM0
LmZyb21DKCZ0bXAuYWNwaV9zNCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlm
IGVyciA6PSB4LkFjcGlMYXB0b3BTbGF0ZS5mcm9tQygmdG1wLmFjcGlfbGFwdG9wX3NsYXRlKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguTnguZnJvbUMoJnRt
cC5ueCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlZpcmlk
aWFuLmZyb21DKCZ0bXAudmlyaWRpYW4pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
KwlpZiBlcnIgOj0geC5WaXJpZGlhbkVuYWJsZS5mcm9tQygmdG1wLnZpcmlkaWFuX2VuYWJsZSk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlZpcmlkaWFuRGlz
YWJsZS5mcm9tQygmdG1wLnZpcmlkaWFuX2Rpc2FibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJu
IGVycgorCX0KKwl4LlRpbWVvZmZzZXQgPSBDLkdvU3RyaW5nKHRtcC50aW1lb2Zmc2V0KQorCWlm
IGVyciA6PSB4LkhwZXQuZnJvbUMoJnRtcC5ocGV0KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJaWYgZXJyIDo9IHguVnB0QWxpZ24uZnJvbUMoJnRtcC52cHRfYWxpZ24pOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4Lk1taW9Ib2xlTWVta2IgPSB1aW50NjQodG1w
Lm1taW9faG9sZV9tZW1rYikKKwl4LlRpbWVyTW9kZSA9IFRpbWVyTW9kZSh0bXAudGltZXJfbW9k
ZSkKKwlpZiBlcnIgOj0geC5OZXN0ZWRIdm0uZnJvbUMoJnRtcC5uZXN0ZWRfaHZtKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguQWx0cDJNLmZyb21DKCZ0bXAu
YWx0cDJtKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5TeXN0ZW1GaXJtd2Fy
ZSA9IEMuR29TdHJpbmcodG1wLnN5c3RlbV9maXJtd2FyZSkKKwl4LlNtYmlvc0Zpcm13YXJlID0g
Qy5Hb1N0cmluZyh0bXAuc21iaW9zX2Zpcm13YXJlKQorCXguQWNwaUZpcm13YXJlID0gQy5Hb1N0
cmluZyh0bXAuYWNwaV9maXJtd2FyZSkKKwl4LkhkdHlwZSA9IEhkdHlwZSh0bXAuaGR0eXBlKQor
CWlmIGVyciA6PSB4Lk5vZ3JhcGhpYy5mcm9tQygmdG1wLm5vZ3JhcGhpYyk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlZnYS5mcm9tQygmdG1wLnZnYSk7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlZuYy5mcm9tQygmdG1w
LnZuYyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguS2V5bWFwID0gQy5Hb1N0
cmluZyh0bXAua2V5bWFwKQorCWlmIGVyciA6PSB4LlNkbC5mcm9tQygmdG1wLnNkbCk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlNwaWNlLmZyb21DKCZ0bXAu
c3BpY2UpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5HZnhQ
YXNzdGhydS5mcm9tQygmdG1wLmdmeF9wYXNzdGhydSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4g
ZXJyCisJfQorCXguR2Z4UGFzc3RocnVLaW5kID0gR2Z4UGFzc3RocnVLaW5kKHRtcC5nZnhfcGFz
c3RocnVfa2luZCkKKwl4LlNlcmlhbCA9IEMuR29TdHJpbmcodG1wLnNlcmlhbCkKKwl4LkJvb3Qg
PSBDLkdvU3RyaW5nKHRtcC5ib290KQorCWlmIGVyciA6PSB4LlVzYi5mcm9tQygmdG1wLnVzYik7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguVXNidmVyc2lvbiA9IGludCh0bXAu
dXNidmVyc2lvbikKKwl4LlVzYmRldmljZSA9IEMuR29TdHJpbmcodG1wLnVzYmRldmljZSkKKwlp
ZiBlcnIgOj0geC5Wa2JEZXZpY2UuZnJvbUMoJnRtcC52a2JfZGV2aWNlKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBlcnIKKwl9CisJeC5Tb3VuZGh3ID0gQy5Hb1N0cmluZyh0bXAuc291bmRodykK
KwlpZiBlcnIgOj0geC5YZW5QbGF0Zm9ybVBjaS5mcm9tQygmdG1wLnhlbl9wbGF0Zm9ybV9wY2kp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5Vc2JkZXZpY2VM
aXN0LmZyb21DKCZ0bXAudXNiZGV2aWNlX2xpc3QpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwl4LlZlbmRvckRldmljZSA9IFZlbmRvckRldmljZSh0bXAudmVuZG9yX2RldmljZSkK
KwlpZiBlcnIgOj0geC5Nc1ZtR2VuaWQuZnJvbUMoJnRtcC5tc192bV9nZW5pZCk7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlNlcmlhbExpc3QuZnJvbUMoJnRt
cC5zZXJpYWxfbGlzdCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6
PSB4LlJkbS5mcm9tQygmdG1wLnJkbSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQor
CXguUmRtTWVtQm91bmRhcnlNZW1rYiA9IHVpbnQ2NCh0bXAucmRtX21lbV9ib3VuZGFyeV9tZW1r
YikKKwl4Lk1jYUNhcHMgPSB1aW50NjQodG1wLm1jYV9jYXBzKQorCXJldHVybiBuaWwKK30KKwor
ZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uUHYpIGZyb21DKHhjICpDLmxpYnhsX2Rv
bWFpbl9idWlsZF9pbmZvKSBlcnJvciB7CisJaWYgRG9tYWluVHlwZSh4Yy5fdHlwZSkgIT0gRG9t
YWluVHlwZVB2IHsKKwkJcmV0dXJuIGVycm9ycy5OZXcoImV4cGVjdGVkIHVuaW9uIGtleSBEb21h
aW5UeXBlUHYiKQorCX0KKworCXRtcCA6PSAoKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlw
ZV91bmlvbl9wdikodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCXguS2VybmVsID0gQy5Hb1N0
cmluZyh0bXAua2VybmVsKQorCXguU2xhY2tNZW1rYiA9IHVpbnQ2NCh0bXAuc2xhY2tfbWVta2Ip
CisJeC5Cb290bG9hZGVyID0gQy5Hb1N0cmluZyh0bXAuYm9vdGxvYWRlcikKKwlpZiBlcnIgOj0g
eC5Cb290bG9hZGVyQXJncy5mcm9tQygmdG1wLmJvb3Rsb2FkZXJfYXJncyk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gZXJyCisJfQorCXguQ21kbGluZSA9IEMuR29TdHJpbmcodG1wLmNtZGxpbmUp
CisJeC5SYW1kaXNrID0gQy5Hb1N0cmluZyh0bXAucmFtZGlzaykKKwl4LkZlYXR1cmVzID0gQy5H
b1N0cmluZyh0bXAuZmVhdHVyZXMpCisJaWYgZXJyIDo9IHguRTgyMEhvc3QuZnJvbUMoJnRtcC5l
ODIwX2hvc3QpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlyZXR1cm4gbmlsCit9
CisKK2Z1bmMgKHggKkRvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvblB2aCkgZnJvbUMoeGMgKkMubGli
eGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKKwlpZiBEb21haW5UeXBlKHhjLl90eXBlKSAh
PSBEb21haW5UeXBlUHZoIHsKKwkJcmV0dXJuIGVycm9ycy5OZXcoImV4cGVjdGVkIHVuaW9uIGtl
eSBEb21haW5UeXBlUHZoIikKKwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX2RvbWFpbl9idWlsZF9p
bmZvX3R5cGVfdW5pb25fcHZoKSh1bnNhZmUuUG9pbnRlcigmeGMudVswXSkpCisJaWYgZXJyIDo9
IHguUHZzaGltLmZyb21DKCZ0bXAucHZzaGltKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIK
Kwl9CisJeC5QdnNoaW1QYXRoID0gQy5Hb1N0cmluZyh0bXAucHZzaGltX3BhdGgpCisJeC5QdnNo
aW1DbWRsaW5lID0gQy5Hb1N0cmluZyh0bXAucHZzaGltX2NtZGxpbmUpCisJeC5QdnNoaW1FeHRy
YSA9IEMuR29TdHJpbmcodG1wLnB2c2hpbV9leHRyYSkKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMg
KHggKkRldmljZVZmYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgZXJyb3IgewogCXgu
QmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1l
ID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC01ODQsNiArODg0LDI4IEBAIGZ1
bmMgKHggKkRldmljZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JjdHJsKSBl
cnJvciB7CiBmdW5jICh4ICpEZXZpY2VVc2JkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91
c2JkZXYpIGVycm9yIHsKIAl4LkN0cmwgPSBEZXZpZCh4Yy5jdHJsKQogCXguUG9ydCA9IGludCh4
Yy5wb3J0KQorCXguVHlwZSA9IFVzYmRldlR5cGUoeGMuX3R5cGUpCisJc3dpdGNoIHguVHlwZSB7
CisJY2FzZSBVc2JkZXZUeXBlSG9zdGRldjoKKwkJdmFyIHR5cGVIb3N0ZGV2IERldmljZVVzYmRl
dlR5cGVVbmlvbkhvc3RkZXYKKwkJaWYgZXJyIDo9IHR5cGVIb3N0ZGV2LmZyb21DKHhjKTsgZXJy
ICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlSG9zdGRl
dgorCWRlZmF1bHQ6CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAnJXYn
IiwgeC5UeXBlKQorCX0KKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRldmljZVVzYmRldlR5
cGVVbmlvbkhvc3RkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JkZXYpIGVycm9yIHsK
KwlpZiBVc2JkZXZUeXBlKHhjLl90eXBlKSAhPSBVc2JkZXZUeXBlSG9zdGRldiB7CisJCXJldHVy
biBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgVXNiZGV2VHlwZUhvc3RkZXYiKQorCX0K
KworCXRtcCA6PSAoKkMubGlieGxfZGV2aWNlX3VzYmRldl90eXBlX3VuaW9uX2hvc3RkZXYpKHVu
c2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4Lkhvc3RidXMgPSBieXRlKHRtcC5ob3N0YnVzKQor
CXguSG9zdGFkZHIgPSBieXRlKHRtcC5ob3N0YWRkcikKIAlyZXR1cm4gbmlsCiB9CiAKQEAgLTYy
Niw2ICs5NDgsMjcgQEAgZnVuYyAoeCAqRGV2aWNlQ2hhbm5lbCkgZnJvbUMoeGMgKkMubGlieGxf
ZGV2aWNlX2NoYW5uZWwpIGVycm9yIHsKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4
Yy5iYWNrZW5kX2RvbW5hbWUpCiAJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQogCXguTmFtZSA9
IEMuR29TdHJpbmcoeGMubmFtZSkKKwl4LkNvbm5lY3Rpb24gPSBDaGFubmVsQ29ubmVjdGlvbih4
Yy5jb25uZWN0aW9uKQorCXN3aXRjaCB4LkNvbm5lY3Rpb24geworCWNhc2UgQ2hhbm5lbENvbm5l
Y3Rpb25Tb2NrZXQ6CisJCXZhciBjb25uZWN0aW9uU29ja2V0IERldmljZUNoYW5uZWxDb25uZWN0
aW9uVW5pb25Tb2NrZXQKKwkJaWYgZXJyIDo9IGNvbm5lY3Rpb25Tb2NrZXQuZnJvbUMoeGMpOyBl
cnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LkNvbm5lY3Rpb25VbmlvbiA9IGNv
bm5lY3Rpb25Tb2NrZXQKKwlkZWZhdWx0OgorCQlyZXR1cm4gZm10LkVycm9yZigiaW52YWxpZCB1
bmlvbiBrZXkgJyV2JyIsIHguQ29ubmVjdGlvbikKKwl9CisJcmV0dXJuIG5pbAorfQorCitmdW5j
ICh4ICpEZXZpY2VDaGFubmVsQ29ubmVjdGlvblVuaW9uU29ja2V0KSBmcm9tQyh4YyAqQy5saWJ4
bF9kZXZpY2VfY2hhbm5lbCkgZXJyb3IgeworCWlmIENoYW5uZWxDb25uZWN0aW9uKHhjLmNvbm5l
Y3Rpb24pICE9IENoYW5uZWxDb25uZWN0aW9uU29ja2V0IHsKKwkJcmV0dXJuIGVycm9ycy5OZXco
ImV4cGVjdGVkIHVuaW9uIGtleSBDaGFubmVsQ29ubmVjdGlvblNvY2tldCIpCisJfQorCisJdG1w
IDo9ICgqQy5saWJ4bF9kZXZpY2VfY2hhbm5lbF9jb25uZWN0aW9uX3VuaW9uX3NvY2tldCkodW5z
YWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCXguUGF0aCA9IEMuR29TdHJpbmcodG1wLnBhdGgpCiAJ
cmV0dXJuIG5pbAogfQogCkBAIC05NTIsNiArMTI5NSw2MiBAQCBmdW5jICh4ICpFdmVudCkgZnJv
bUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9yIHsKIAl9CiAJeC5Eb211dWlkID0gdXVpZERvbXV1
aWQKIAl4LkZvclVzZXIgPSB1aW50NjQoeGMuZm9yX3VzZXIpCisJeC5UeXBlID0gRXZlbnRUeXBl
KHhjLl90eXBlKQorCXN3aXRjaCB4LlR5cGUgeworCWNhc2UgRXZlbnRUeXBlT3BlcmF0aW9uQ29t
cGxldGU6CisJCXZhciB0eXBlT3BlcmF0aW9uQ29tcGxldGUgRXZlbnRUeXBlVW5pb25PcGVyYXRp
b25Db21wbGV0ZQorCQlpZiBlcnIgOj0gdHlwZU9wZXJhdGlvbkNvbXBsZXRlLmZyb21DKHhjKTsg
ZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlT3Bl
cmF0aW9uQ29tcGxldGUKKwljYXNlIEV2ZW50VHlwZURvbWFpblNodXRkb3duOgorCQl2YXIgdHlw
ZURvbWFpblNodXRkb3duIEV2ZW50VHlwZVVuaW9uRG9tYWluU2h1dGRvd24KKwkJaWYgZXJyIDo9
IHR5cGVEb21haW5TaHV0ZG93bi5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVy
cgorCQl9CisJCXguVHlwZVVuaW9uID0gdHlwZURvbWFpblNodXRkb3duCisJY2FzZSBFdmVudFR5
cGVEaXNrRWplY3Q6CisJCXZhciB0eXBlRGlza0VqZWN0IEV2ZW50VHlwZVVuaW9uRGlza0VqZWN0
CisJCWlmIGVyciA6PSB0eXBlRGlza0VqZWN0LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJCQly
ZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlRGlza0VqZWN0CisJZGVmYXVsdDoK
KwkJcmV0dXJuIGZtdC5FcnJvcmYoImludmFsaWQgdW5pb24ga2V5ICcldiciLCB4LlR5cGUpCisJ
fQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRXZlbnRUeXBlVW5pb25Eb21haW5TaHV0ZG93
bikgZnJvbUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9yIHsKKwlpZiBFdmVudFR5cGUoeGMuX3R5
cGUpICE9IEV2ZW50VHlwZURvbWFpblNodXRkb3duIHsKKwkJcmV0dXJuIGVycm9ycy5OZXcoImV4
cGVjdGVkIHVuaW9uIGtleSBFdmVudFR5cGVEb21haW5TaHV0ZG93biIpCisJfQorCisJdG1wIDo9
ICgqQy5saWJ4bF9ldmVudF90eXBlX3VuaW9uX2RvbWFpbl9zaHV0ZG93bikodW5zYWZlLlBvaW50
ZXIoJnhjLnVbMF0pKQorCXguU2h1dGRvd25SZWFzb24gPSBieXRlKHRtcC5zaHV0ZG93bl9yZWFz
b24pCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpFdmVudFR5cGVVbmlvbkRpc2tFamVjdCkg
ZnJvbUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9yIHsKKwlpZiBFdmVudFR5cGUoeGMuX3R5cGUp
ICE9IEV2ZW50VHlwZURpc2tFamVjdCB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1
bmlvbiBrZXkgRXZlbnRUeXBlRGlza0VqZWN0IikKKwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX2V2
ZW50X3R5cGVfdW5pb25fZGlza19lamVjdCkodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCXgu
VmRldiA9IEMuR29TdHJpbmcodG1wLnZkZXYpCisJaWYgZXJyIDo9IHguRGlzay5mcm9tQygmdG1w
LmRpc2spOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlyZXR1cm4gbmlsCit9CisK
K2Z1bmMgKHggKkV2ZW50VHlwZVVuaW9uT3BlcmF0aW9uQ29tcGxldGUpIGZyb21DKHhjICpDLmxp
YnhsX2V2ZW50KSBlcnJvciB7CisJaWYgRXZlbnRUeXBlKHhjLl90eXBlKSAhPSBFdmVudFR5cGVP
cGVyYXRpb25Db21wbGV0ZSB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBr
ZXkgRXZlbnRUeXBlT3BlcmF0aW9uQ29tcGxldGUiKQorCX0KKworCXRtcCA6PSAoKkMubGlieGxf
ZXZlbnRfdHlwZV91bmlvbl9vcGVyYXRpb25fY29tcGxldGUpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51
WzBdKSkKKwl4LlJjID0gaW50KHRtcC5yYykKIAlyZXR1cm4gbmlsCiB9CiAKQEAgLTk2NSw1ICsx
MzY0LDQ2IEBAIGZ1bmMgKHggKlBzckNhdEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9jYXRf
aW5mbykgZXJyb3IgewogCiBmdW5jICh4ICpQc3JId0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3Bz
cl9od19pbmZvKSBlcnJvciB7CiAJeC5JZCA9IHVpbnQzMih4Yy5pZCkKKwl4LlR5cGUgPSBQc3JG
ZWF0VHlwZSh4Yy5fdHlwZSkKKwlzd2l0Y2ggeC5UeXBlIHsKKwljYXNlIFBzckZlYXRUeXBlTWJh
OgorCQl2YXIgdHlwZU1iYSBQc3JId0luZm9UeXBlVW5pb25NYmEKKwkJaWYgZXJyIDo9IHR5cGVN
YmEuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlR5cGVV
bmlvbiA9IHR5cGVNYmEKKwljYXNlIFBzckZlYXRUeXBlQ2F0OgorCQl2YXIgdHlwZUNhdCBQc3JI
d0luZm9UeXBlVW5pb25DYXQKKwkJaWYgZXJyIDo9IHR5cGVDYXQuZnJvbUMoeGMpOyBlcnIgIT0g
bmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVDYXQKKwlkZWZh
dWx0OgorCQlyZXR1cm4gZm10LkVycm9yZigiaW52YWxpZCB1bmlvbiBrZXkgJyV2JyIsIHguVHlw
ZSkKKwl9CisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpQc3JId0luZm9UeXBlVW5pb25DYXQp
IGZyb21DKHhjICpDLmxpYnhsX3Bzcl9od19pbmZvKSBlcnJvciB7CisJaWYgUHNyRmVhdFR5cGUo
eGMuX3R5cGUpICE9IFBzckZlYXRUeXBlQ2F0IHsKKwkJcmV0dXJuIGVycm9ycy5OZXcoImV4cGVj
dGVkIHVuaW9uIGtleSBQc3JGZWF0VHlwZUNhdCIpCisJfQorCisJdG1wIDo9ICgqQy5saWJ4bF9w
c3JfaHdfaW5mb190eXBlX3VuaW9uX2NhdCkodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCXgu
Q29zTWF4ID0gdWludDMyKHRtcC5jb3NfbWF4KQorCXguQ2JtTGVuID0gdWludDMyKHRtcC5jYm1f
bGVuKQorCXguQ2RwRW5hYmxlZCA9IGJvb2wodG1wLmNkcF9lbmFibGVkKQorCXJldHVybiBuaWwK
K30KKworZnVuYyAoeCAqUHNySHdJbmZvVHlwZVVuaW9uTWJhKSBmcm9tQyh4YyAqQy5saWJ4bF9w
c3JfaHdfaW5mbykgZXJyb3IgeworCWlmIFBzckZlYXRUeXBlKHhjLl90eXBlKSAhPSBQc3JGZWF0
VHlwZU1iYSB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgUHNyRmVh
dFR5cGVNYmEiKQorCX0KKworCXRtcCA6PSAoKkMubGlieGxfcHNyX2h3X2luZm9fdHlwZV91bmlv
bl9tYmEpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4LkNvc01heCA9IHVpbnQzMih0bXAu
Y29zX21heCkKKwl4LlRocnRsTWF4ID0gdWludDMyKHRtcC50aHJ0bF9tYXgpCisJeC5MaW5lYXIg
PSBib29sKHRtcC5saW5lYXIpCiAJcmV0dXJuIG5pbAogfQotLSAKMi4xOS4xCgoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcg
bGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9q
ZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

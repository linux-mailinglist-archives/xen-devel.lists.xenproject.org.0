Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 5D6588D52A
	for <lists+xen-devel@lfdr.de>; Wed, 14 Aug 2019 15:41:57 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hxtUX-0007I2-Fo; Wed, 14 Aug 2019 13:39:05 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GkAm=WK=citrix.com=paul.durrant@srs-us1.protection.inumbo.net>)
 id 1hxtUV-0007Ha-Tp
 for xen-devel@lists.xenproject.org; Wed, 14 Aug 2019 13:39:03 +0000
X-Inumbo-ID: de266328-be98-11e9-bfcc-630aa57f3cf4
Received: from esa5.hc3370-68.iphmx.com (unknown [216.71.155.168])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id de266328-be98-11e9-bfcc-630aa57f3cf4;
 Wed, 14 Aug 2019 13:38:58 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1565789938;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=NTFZDxTjLoKZ5zgD7XkdFrQAkmbvDsmCnbzLLGYCkow=;
 b=HEri3NIYrQ9EYKNfts6tw/SGX4lu4SXFIdsbJ1e77BzQIlKz2Fj4NcTJ
 xikRFT2VApSHlfejdPQisw4ndTDHEiV0JVUoTMV0IsFn9cA7xSnoz7kgl
 4EAkc+GGVWZlvrqhjEu5SdL24j/dwBEIMn+to+WYrSU2i/0HUhZsqSjT/ s=;
Authentication-Results: esa5.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=paul.durrant@citrix.com;
 spf=Pass smtp.mailfrom=Paul.Durrant@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 paul.durrant@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="paul.durrant@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa5.hc3370-68.iphmx.com: domain of
 Paul.Durrant@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="Paul.Durrant@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: diwA1I7/c+bnPqEn5tYsP4svGbFGfk3e8svdPei5Ybf0a+VJUE2Mi6wbawj7+c+lkqm6KMxeVa
 8fKZ5q+vx6L+vt5s2EGxo0EUKnJWlF/o1Lppt83DGVrK005mRN/gtnTfl7OimFOrMK33VqFvuV
 MX7xfDSnxnrSW9RNvyYAl2Fv3NNy0+J38mOFetFLs4vVY6g/mWoJEZ27c5YsduMEsQ31Q6r/ig
 Vsv7DGYMILpz1eZL9hB4cetJ1/43HoxZ9HWgsev+BTCDHynGkbRoSi9da1ZpPjPlmOPj0FEaiE
 cqc=
X-SBRS: 2.7
X-MesageID: 4409646
X-Ironport-Server: esa5.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,385,1559534400"; 
   d="scan'208";a="4409646"
From: Paul Durrant <paul.durrant@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Wed, 14 Aug 2019 14:38:48 +0100
Message-ID: <20190814133852.20491-7-paul.durrant@citrix.com>
X-Mailer: git-send-email 2.20.1.2.gb21ebb671
In-Reply-To: <20190814133852.20491-1-paul.durrant@citrix.com>
References: <20190814133852.20491-1-paul.durrant@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v5 06/10] use is_iommu_enabled() where
 appropriate...
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Jun Nakajima <jun.nakajima@intel.com>, Wei Liu <wl@xen.org>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Brian Woods <brian.woods@amd.com>,
 Julien Grall <julien.grall@arm.com>, Paul Durrant <paul.durrant@citrix.com>,
 Jan Beulich <jbeulich@suse.com>, Daniel
 De Graaf <dgdegra@tycho.nsa.gov>, Volodymyr
 Babchuk <Volodymyr_Babchuk@epam.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Li4ucmF0aGVyIHRoYW4gdGVzdGluZyB0aGUgZ2xvYmFsIGlvbW11X2VuYWJsZWQgZmxhZyBhbmQg
b3BzIHBvaW50ZXIuCgpOb3cgdGhhdCB0aGVyZSBpcyBhIHBlci1kb21haW4gZmxhZyBpbmRpY2F0
aW5nIHdoZXRoZXIgdGhlIGRvbWFpbiBpcwpwZXJtaXR0ZWQgdG8gdXNlIHRoZSBJT01NVSAod2hp
Y2ggZGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBvcHMgcG9pbnRlciB3aWxsCmJlIHNldCksIG1hbnkg
dGVzdHMgb2YgdGhlIGdsb2JhbCBpb21tdV9lbmFibGVkIGZsYWcgYW5kIG9wcyBwb2ludGVyIGNh
bgpiZSB0cmFuc2xhdGVkIGludG8gdGVzdHMgb2YgdGhlIHBlci1kb21haW4gZmxhZy4gU29tZSBv
ZiB0aGUgb3RoZXIgdGVzdHMgb2YKcHVyZWx5IHRoZSBnbG9iYWwgaW9tbXVfZW5hYmxlZCBmbGFn
IGNhbiBhbHNvIGJlIHRyYW5zbGF0ZWQgaW50byB0ZXN0cyBvZgp0aGUgcGVyLWRvbWFpbiBmbGFn
LgoKTk9URTogVGhlIGNvbW1lbnQgaW4gaW9tbXVfc2hhcmVfcDJtX3RhYmxlKCkgaXMgYWxzbyBm
aXhlZDsgbmVlZF9pb21tdSgpCiAgICAgIGRpc2FwcGVhcmVkIHNvbWUgdGltZSBhZ28uIEFsc28s
IHdoaWxzdCB0aGUgc3R5bGUgb2YgdGhlICdpZicgaW4KICAgICAgZmxhc2tfaW9tbXVfcmVzb3Vy
Y2VfdXNlX3Blcm0oKSBpcyBmaXhlZCwgSSBoYXZlIG5vdCB0cmFuc2xhdGVkIGFueQogICAgICBp
bnN0YW5jZXMgb2YgdTMyIGludG8gdWludDMyX3QgdG8ga2VlcCBjb25zaXN0ZW5jeS4gSU1PIHN1
Y2ggYQogICAgICB0cmFuc2xhdGlvbiB3b3VsZCBiZSBiZXR0ZXIgZG9uZSBnbG9iYWxseSBmb3Ig
dGhlIHNvdXJjZSBtb2R1bGUgaW4KICAgICAgYSBzZXBhcmF0ZSBwYXRjaC4KClNpZ25lZC1vZmYt
Ynk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNpdHJpeC5jb20+Ci0tLQpDYzogU3RlZmFu
byBTdGFiZWxsaW5pIDxzc3RhYmVsbGluaUBrZXJuZWwub3JnPgpDYzogSnVsaWVuIEdyYWxsIDxq
dWxpZW4uZ3JhbGxAYXJtLmNvbT4KQ2M6IFZvbG9keW15ciBCYWJjaHVrIDxWb2xvZHlteXJfQmFi
Y2h1a0BlcGFtLmNvbT4KQ2M6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQ2M6IEFu
ZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CkNjOiBXZWkgTGl1IDx3bEB4
ZW4ub3JnPgpDYzogIlJvZ2VyIFBhdSBNb25uw6kiIDxyb2dlci5wYXVAY2l0cml4LmNvbT4KQ2M6
IEp1biBOYWthamltYSA8anVuLm5ha2FqaW1hQGludGVsLmNvbT4KQ2M6IEtldmluIFRpYW4gPGtl
dmluLnRpYW5AaW50ZWwuY29tPgpDYzogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBldS5j
aXRyaXguY29tPgpDYzogU3VyYXZlZSBTdXRoaWt1bHBhbml0IDxzdXJhdmVlLnN1dGhpa3VscGFu
aXRAYW1kLmNvbT4KQ2M6IEJyaWFuIFdvb2RzIDxicmlhbi53b29kc0BhbWQuY29tPgpDYzogRGFu
aWVsIERlIEdyYWFmIDxkZ2RlZ3JhQHR5Y2hvLm5zYS5nb3Y+CgpQcmV2aW91c2x5IHBhcnQgb2Yg
c2VyaWVzIGh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvYXJjaGl2ZXMvaHRtbC94ZW4tZGV2
ZWwvMjAxOS0wNy9tc2cwMjI2Ny5odG1sCgpUaGlzIHBhdGNoIHNob3VsZCBiZSBhcHBsaWVkIGFm
dGVyIEFsZXhhbmRydSBJc2FpbGEncyAnQ2xlYW4KaW9tbXVfaGFwX3B0X3NoYXJlIGVuYWJsZWQg
Y29kZScgcGF0Y2g6CgpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL2FyY2hpdmVzL2h0bWwv
eGVuLWRldmVsLzIwMTktMDcvbXNnMDE3MDguaHRtbAoKdjU6CiAtIEZpeCBsb2dpYyBpbiBBUk0g
cDJtX2luaXQoKQogLSBNYWtlIGlvbW11X2RvX2RvbWN0bCgpIHJldHVybiAtRU9QTk9UU1VQUCBy
YXRoZXIgdGhhbiAtRU5PU1lTIGlmIHRoZQogICBJT01NVSBpcyBub3QgZW5hYmxlZAogLSBGaXgg
dGVzdCBpbiBwY2lfZW5hYmxlX2FjcygpCiAtIEZpeCB0ZXN0IGluIGZsYXNrX2lvbW11X3Jlc291
cmNlX3VzZV9wZXJtKCkKLS0tCiB4ZW4vYXJjaC9hcm0vcDJtLmMgICAgICAgICAgICAgICAgICAg
ICAgICB8ICAyICstCiB4ZW4vYXJjaC94ODYvZG9tMF9idWlsZC5jICAgICAgICAgICAgICAgICB8
ICAyICstCiB4ZW4vYXJjaC94ODYvZG9tY3RsLmMgICAgICAgICAgICAgICAgICAgICB8ICA0ICst
LQogeGVuL2FyY2gveDg2L2h2bS9odm0uYyAgICAgICAgICAgICAgICAgICAgfCAgNiArKy0tLQog
eGVuL2FyY2gveDg2L2h2bS92aW9hcGljLmMgICAgICAgICAgICAgICAgfCAgMiArLQogeGVuL2Fy
Y2gveDg2L2h2bS92bXgvdm1jcy5jICAgICAgICAgICAgICAgfCAgMiArLQogeGVuL2FyY2gveDg2
L2h2bS92bXgvdm14LmMgICAgICAgICAgICAgICAgfCAgMiArLQogeGVuL2FyY2gveDg2L21tL3Ay
bS1lcHQuYyAgICAgICAgICAgICAgICAgfCAgNCArLS0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdV9ndWVzdC5jIHwgIDIgKy0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Rldmlj
ZV90cmVlLmMgICAgIHwgIDQgKy0tCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pby5jICAgICAg
ICAgICAgICB8ICA4ICsrKy0tLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW9tbXUuYyAgICAg
ICAgICAgfCAzMSArKysrKysrKysrLS0tLS0tLS0tLS0tLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvcGNpLmMgICAgICAgICAgICAgfCAxNiArKysrKystLS0tLS0KIHhlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL3Z0ZC9pb21tdS5jICAgICAgIHwgIDIgKy0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC94ODYvaHZtLmMgICAgIHwgIDIgKy0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9p
b21tdS5jICAgICAgIHwgIDIgKy0KIHhlbi94c20vZmxhc2svaG9va3MuYyAgICAgICAgICAgICAg
ICAgICAgIHwgMTggKysrKysrLS0tLS0tLQogMTcgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9u
cygrKSwgNTYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL3AybS5jIGIv
eGVuL2FyY2gvYXJtL3AybS5jCmluZGV4IGUyOGVhMWM4NWEuLjdmMTQ0MjkzMmEgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL2FybS9wMm0uYworKysgYi94ZW4vYXJjaC9hcm0vcDJtLmMKQEAgLTE1MzEs
NyArMTUzMSw3IEBAIGludCBwMm1faW5pdChzdHJ1Y3QgZG9tYWluICpkKQogICAgICAqIHNoYXJl
ZCB3aXRoIHRoZSBDUFUsIFhlbiBoYXMgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIFBUIGNoYW5nZXMg
aGF2ZQogICAgICAqIHJlYWNoZWQgdGhlIG1lbW9yeQogICAgICAqLwotICAgIHAybS0+Y2xlYW5f
cHRlID0gaW9tbXVfZW5hYmxlZCAmJgorICAgIHAybS0+Y2xlYW5fcHRlID0gaXNfaW9tbXVfZW5h
YmxlZChkKSAmJgogICAgICAgICAhaW9tbXVfaGFzX2ZlYXR1cmUoZCwgSU9NTVVfRkVBVF9DT0hF
UkVOVF9XQUxLKTsKIAogICAgIHJjID0gcDJtX2FsbG9jX3RhYmxlKGQpOwpkaWZmIC0tZ2l0IGEv
eGVuL2FyY2gveDg2L2RvbTBfYnVpbGQuYyBiL3hlbi9hcmNoL3g4Ni9kb20wX2J1aWxkLmMKaW5k
ZXggYzY5NTcwOTIwYy4uZDM4MTc4NGVkZCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbTBf
YnVpbGQuYworKysgYi94ZW4vYXJjaC94ODYvZG9tMF9idWlsZC5jCkBAIC0zNTYsNyArMzU2LDcg
QEAgdW5zaWduZWQgbG9uZyBfX2luaXQgZG9tMF9jb21wdXRlX25yX3BhZ2VzKAogICAgICAgICBh
dmFpbCAtPSBkLT5tYXhfdmNwdXMgLSAxOwogCiAgICAgLyogUmVzZXJ2ZSBtZW1vcnkgZm9yIGlv
bW11X2RvbTBfaW5pdCgpIChyb3VnaCBlc3RpbWF0ZSkuICovCi0gICAgaWYgKCBpb21tdV9lbmFi
bGVkICkKKyAgICBpZiAoIGlzX2lvbW11X2VuYWJsZWQoZCkgKQogICAgIHsKICAgICAgICAgdW5z
aWduZWQgaW50IHM7CiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9kb21jdGwuYyBiL3hlbi9h
cmNoL3g4Ni9kb21jdGwuYwppbmRleCAyZDQ1ZTViOGE4Li5iZTRiMjA2MDY4IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvZG9tY3RsLmMKKysrIGIveGVuL2FyY2gveDg2L2RvbWN0bC5jCkBAIC03
MTUsNyArNzE1LDcgQEAgbG9uZyBhcmNoX2RvX2RvbWN0bCgKICAgICAgICAgICAgIGJyZWFrOwog
CiAgICAgICAgIHJldCA9IC1FU1JDSDsKLSAgICAgICAgaWYgKCBpb21tdV9lbmFibGVkICkKKyAg
ICAgICAgaWYgKCBpc19pb21tdV9lbmFibGVkKGQpICkKICAgICAgICAgewogICAgICAgICAgICAg
cGNpZGV2c19sb2NrKCk7CiAgICAgICAgICAgICByZXQgPSBwdF9pcnFfY3JlYXRlX2JpbmQoZCwg
YmluZCk7CkBAIC03NDQsNyArNzQ0LDcgQEAgbG9uZyBhcmNoX2RvX2RvbWN0bCgKICAgICAgICAg
aWYgKCByZXQgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgaWYgKCBpb21tdV9lbmFi
bGVkICkKKyAgICAgICAgaWYgKCBpc19pb21tdV9lbmFibGVkKGQpICkKICAgICAgICAgewogICAg
ICAgICAgICAgcGNpZGV2c19sb2NrKCk7CiAgICAgICAgICAgICByZXQgPSBwdF9pcnFfZGVzdHJv
eV9iaW5kKGQsIGJpbmQpOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS9odm0uYyBiL3hl
bi9hcmNoL3g4Ni9odm0vaHZtLmMKaW5kZXggMDI5ZWVhM2I4NS4uMTcyYzg2MGFjYyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2h2bS9odm0uYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2h2bS5j
CkBAIC00NjUsNyArNDY1LDcgQEAgdm9pZCBodm1fbWlncmF0ZV90aW1lcnMoc3RydWN0IHZjcHUg
KnYpCiAKIHZvaWQgaHZtX21pZ3JhdGVfcGlycShzdHJ1Y3QgaHZtX3BpcnFfZHBjaSAqcGlycV9k
cGNpLCBjb25zdCBzdHJ1Y3QgdmNwdSAqdikKIHsKLSAgICBBU1NFUlQoaW9tbXVfZW5hYmxlZCAm
JgorICAgIEFTU0VSVChpc19pb21tdV9lbmFibGVkKHYtPmRvbWFpbikgJiYKICAgICAgICAgICAg
KGlzX2hhcmR3YXJlX2RvbWFpbih2LT5kb21haW4pIHx8IGh2bV9kb21haW5faXJxKHYtPmRvbWFp
biktPmRwY2kpKTsKIAogICAgIGlmICggKHBpcnFfZHBjaS0+ZmxhZ3MgJiBIVk1fSVJRX0RQQ0lf
TUFDSF9NU0kpICYmCkBAIC00OTYsNyArNDk2LDcgQEAgdm9pZCBodm1fbWlncmF0ZV9waXJxcyhz
dHJ1Y3QgdmNwdSAqdikKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+ZG9tYWluOwogCi0g
ICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAhaHZtX2RvbWFpbl9pcnEoZCktPmRwY2kgKQorICAg
IGlmICggIWlzX2lvbW11X2VuYWJsZWQoZCkgfHwgIWh2bV9kb21haW5faXJxKGQpLT5kcGNpICkK
ICAgICAgICByZXR1cm47CiAKICAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xvY2spOwpAQCAtMjI2
NCw3ICsyMjY0LDcgQEAgaW50IGh2bV9zZXRfY3IwKHVuc2lnbmVkIGxvbmcgdmFsdWUsIGJvb2wg
bWF5X2RlZmVyKQogICAgIH0KIAogICAgIGlmICggKCh2YWx1ZSBeIG9sZF92YWx1ZSkgJiBYODZf
Q1IwX0NEKSAmJgotICAgICAgICAgaW9tbXVfZW5hYmxlZCAmJiBodm1fZnVuY3MuaGFuZGxlX2Nk
ICYmCisgICAgICAgICBpc19pb21tdV9lbmFibGVkKGQpICYmIGh2bV9mdW5jcy5oYW5kbGVfY2Qg
JiYKICAgICAgICAgICghcmFuZ2VzZXRfaXNfZW1wdHkoZC0+aW9tZW1fY2FwcykgfHwKICAgICAg
ICAgICAhcmFuZ2VzZXRfaXNfZW1wdHkoZC0+YXJjaC5pb3BvcnRfY2FwcykgfHwKICAgICAgICAg
ICBoYXNfYXJjaF9wZGV2cyhkKSkgKQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS92aW9h
cGljLmMgYi94ZW4vYXJjaC94ODYvaHZtL3Zpb2FwaWMuYwppbmRleCA5YzI1ZjcyYjRkLi45YWVl
ZjMyYTE0IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3Zpb2FwaWMuYworKysgYi94ZW4v
YXJjaC94ODYvaHZtL3Zpb2FwaWMuYwpAQCAtNTM2LDcgKzUzNiw3IEBAIHZvaWQgdmlvYXBpY191
cGRhdGVfRU9JKHN0cnVjdCBkb21haW4gKmQsIHU4IHZlY3RvcikKIAogICAgICAgICAgICAgZW50
LT5maWVsZHMucmVtb3RlX2lyciA9IDA7CiAKLSAgICAgICAgICAgIGlmICggaW9tbXVfZW5hYmxl
ZCApCisgICAgICAgICAgICBpZiAoIGlzX2lvbW11X2VuYWJsZWQoZCkgKQogICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZkLT5hcmNoLmh2bS5pcnFfbG9jayk7CiAg
ICAgICAgICAgICAgICAgaHZtX2RwY2lfZW9pKGQsIHZpb2FwaWMtPmJhc2VfZ3NpICsgcGluLCBl
bnQpOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5jIGIveGVuL2FyY2gv
eDg2L2h2bS92bXgvdm1jcy5jCmluZGV4IDE2ZjE0YWJlOGYuLmVkMjdlOGRlZjcgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3MuYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3Zt
eC92bWNzLmMKQEAgLTEwODcsNyArMTA4Nyw3IEBAIHN0YXRpYyBpbnQgY29uc3RydWN0X3ZtY3Mo
c3RydWN0IHZjcHUgKnYpCiAgICAgICAgIHZteF9jbGVhcl9tc3JfaW50ZXJjZXB0KHYsIE1TUl9J
QTMyX1NZU0VOVEVSX0NTLCBWTVhfTVNSX1JXKTsKICAgICAgICAgdm14X2NsZWFyX21zcl9pbnRl
cmNlcHQodiwgTVNSX0lBMzJfU1lTRU5URVJfRVNQLCBWTVhfTVNSX1JXKTsKICAgICAgICAgdm14
X2NsZWFyX21zcl9pbnRlcmNlcHQodiwgTVNSX0lBMzJfU1lTRU5URVJfRUlQLCBWTVhfTVNSX1JX
KTsKLSAgICAgICAgaWYgKCBwYWdpbmdfbW9kZV9oYXAoZCkgJiYgKCFpb21tdV9lbmFibGVkIHx8
IGlvbW11X3Nub29wKSApCisgICAgICAgIGlmICggcGFnaW5nX21vZGVfaGFwKGQpICYmICghaXNf
aW9tbXVfZW5hYmxlZChkKSB8fCBpb21tdV9zbm9vcCkgKQogICAgICAgICAgICAgdm14X2NsZWFy
X21zcl9pbnRlcmNlcHQodiwgTVNSX0lBMzJfQ1JfUEFULCBWTVhfTVNSX1JXKTsKICAgICAgICAg
aWYgKCAodm1leGl0X2N0bCAmIFZNX0VYSVRfQ0xFQVJfQk5EQ0ZHUykgJiYKICAgICAgICAgICAg
ICAodm1lbnRyeV9jdGwgJiBWTV9FTlRSWV9MT0FEX0JORENGR1MpICkKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMKaW5k
ZXggMDA2MDMxMGQ3NC4uM2IzZDViNjI1MCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2bS92
bXgvdm14LmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMKQEAgLTEyMTAsNyArMTIx
MCw3IEBAIHN0YXRpYyB2b2lkIHZteF9oYW5kbGVfY2Qoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVk
IGxvbmcgdmFsdWUpCiAgICAgICAgIHsKICAgICAgICAgICAgIHYtPmFyY2guaHZtLmNhY2hlX21v
ZGUgPSBOT1JNQUxfQ0FDSEVfTU9ERTsKICAgICAgICAgICAgIHZteF9zZXRfZ3Vlc3RfcGF0KHYs
ICpwYXQpOwotICAgICAgICAgICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCBpb21tdV9zbm9vcCAp
CisgICAgICAgICAgICBpZiAoICFpc19pb21tdV9lbmFibGVkKHYtPmRvbWFpbikgfHwgaW9tbXVf
c25vb3AgKQogICAgICAgICAgICAgICAgIHZteF9jbGVhcl9tc3JfaW50ZXJjZXB0KHYsIE1TUl9J
QTMyX0NSX1BBVCwgVk1YX01TUl9SVyk7CiAgICAgICAgICAgICBodm1fYXNpZF9mbHVzaF92Y3B1
KHYpOyAvKiBubyBuZWVkIHRvIGZsdXNoIGNhY2hlICovCiAgICAgICAgIH0KZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0LmMgYi94ZW4vYXJjaC94ODYvbW0vcDJtLWVwdC5jCmlu
ZGV4IDZiODQ2OGM3OTMuLjkzZDAzMWNjNmMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9w
Mm0tZXB0LmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1lcHQuYwpAQCAtMjYwLDcgKzI2MCw3
IEBAIHN0YXRpYyBib29sX3QgZXB0X3NwbGl0X3N1cGVyX3BhZ2Uoc3RydWN0IHAybV9kb21haW4g
KnAybSwKICAgICAgICAgKmVwdGUgPSAqZXB0X2VudHJ5OwogICAgICAgICBlcHRlLT5zcCA9IChs
ZXZlbCA+IDEpOwogICAgICAgICBlcHRlLT5tZm4gKz0gaSAqIHRydW5rOwotICAgICAgICBlcHRl
LT5zbnAgPSAoaW9tbXVfZW5hYmxlZCAmJiBpb21tdV9zbm9vcCk7CisgICAgICAgIGVwdGUtPnNu
cCA9IGlzX2lvbW11X2VuYWJsZWQocDJtLT5kb21haW4pICYmIGlvbW11X3Nub29wOwogICAgICAg
ICBlcHRlLT5zdXBwcmVzc192ZSA9IDE7CiAKICAgICAgICAgZXB0X3AybV90eXBlX3RvX2ZsYWdz
KHAybSwgZXB0ZSwgZXB0ZS0+c2FfcDJtdCwgZXB0ZS0+YWNjZXNzKTsKQEAgLTc2Niw3ICs3NjYs
NyBAQCBlcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIGdmbl90IGdmbl8sIG1m
bl90IG1mbiwKICAgICAgICAgbmV3X2VudHJ5LnNwID0gISFpOwogICAgICAgICBuZXdfZW50cnku
c2FfcDJtdCA9IHAybXQ7CiAgICAgICAgIG5ld19lbnRyeS5hY2Nlc3MgPSBwMm1hOwotICAgICAg
ICBuZXdfZW50cnkuc25wID0gKGlvbW11X2VuYWJsZWQgJiYgaW9tbXVfc25vb3ApOworICAgICAg
ICBuZXdfZW50cnkuc25wID0gaXNfaW9tbXVfZW5hYmxlZChkKSAmJiBpb21tdV9zbm9vcDsKIAog
ICAgICAgICAvKiB0aGUgY2FsbGVyIHNob3VsZCB0YWtlIGNhcmUgb2YgdGhlIHByZXZpb3VzIHBh
Z2UgKi8KICAgICAgICAgbmV3X2VudHJ5Lm1mbiA9IG1mbl94KG1mbik7CmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfZ3Vlc3QuYyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9ndWVzdC5jCmluZGV4IDdmMmRkNjYyYWYuLjFmMmJjZmJlMTUg
MTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9ndWVzdC5jCisr
KyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9ndWVzdC5jCkBAIC04MjEsNyAr
ODIxLDcgQEAgaW50IGd1ZXN0X2lvbW11X2luaXQoc3RydWN0IGRvbWFpbiogZCkKICAgICBzdHJ1
Y3QgZ3Vlc3RfaW9tbXUgKmlvbW11OwogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOwogCi0gICAgaWYgKCAhaXNfaHZtX2RvbWFpbihkKSB8fCAhaW9tbXVfZW5hYmxl
ZCB8fCAhaW9tbXV2Ml9lbmFibGVkIHx8CisgICAgaWYgKCAhaXNfaHZtX2RvbWFpbihkKSB8fCAh
aXNfaW9tbXVfZW5hYmxlZChkKSB8fCAhaW9tbXV2Ml9lbmFibGVkIHx8CiAgICAgICAgICAhaGFz
X3Zpb21tdShkKSApCiAgICAgICAgIHJldHVybiAwOwogCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvZGV2
aWNlX3RyZWUuYwppbmRleCBkMzJiMTcyNjY0Li4xMmYyYzRjM2YyIDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL2RldmljZV90cmVlLmMKQEAgLTI5LDcgKzI5LDcgQEAgaW50IGlvbW11X2Fzc2lnbl9k
dF9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGR0X2RldmljZV9ub2RlICpkZXYpCiAg
ICAgaW50IHJjID0gLUVCVVNZOwogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9tX2lv
bW11KGQpOwogCi0gICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAhaGQtPnBsYXRmb3JtX29wcyAp
CisgICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChkKSApCiAgICAgICAgIHJldHVybiAtRUlOVkFM
OwogCiAgICAgaWYgKCAhZHRfZGV2aWNlX2lzX3Byb3RlY3RlZChkZXYpICkKQEAgLTcxLDcgKzcx
LDcgQEAgaW50IGlvbW11X2RlYXNzaWduX2R0X2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1
Y3QgZHRfZGV2aWNlX25vZGUgKmRldikKICAgICBjb25zdCBzdHJ1Y3QgZG9tYWluX2lvbW11ICpo
ZCA9IGRvbV9pb21tdShkKTsKICAgICBpbnQgcmM7CiAKLSAgICBpZiAoICFpb21tdV9lbmFibGVk
IHx8ICFoZC0+cGxhdGZvcm1fb3BzICkKKyAgICBpZiAoICFpc19pb21tdV9lbmFibGVkKGQpICkK
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKICAgICBpZiAoICFkdF9kZXZpY2VfaXNfcHJvdGVj
dGVkKGRldikgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW8uYyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2lvLmMKaW5kZXggNDI5MGM3YzcxMC4uYjI5MmU3OTM4MiAx
MDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW8uYworKysgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9pby5jCkBAIC00MzQsNyArNDM0LDcgQEAgaW50IHB0X2lycV9jcmVhdGVf
YmluZCgKICAgICAgICAgICAgIGlmICggdmNwdSApCiAgICAgICAgICAgICAgICAgcGlycV9kcGNp
LT5nbXNpLnBvc3RlZCA9IHRydWU7CiAgICAgICAgIH0KLSAgICAgICAgaWYgKCB2Y3B1ICYmIGlv
bW11X2VuYWJsZWQgKQorICAgICAgICBpZiAoIHZjcHUgJiYgaXNfaW9tbXVfZW5hYmxlZChkKSAp
CiAgICAgICAgICAgICBodm1fbWlncmF0ZV9waXJxKHBpcnFfZHBjaSwgdmNwdSk7CiAKICAgICAg
ICAgLyogVXNlIGludGVycnVwdCBwb3N0aW5nIGlmIGl0IGlzIHN1cHBvcnRlZC4gKi8KQEAgLTgx
Nyw3ICs4MTcsNyBAQCBpbnQgaHZtX2RvX0lSUV9kcGNpKHN0cnVjdCBkb21haW4gKmQsIHN0cnVj
dCBwaXJxICpwaXJxKQogCiAgICAgQVNTRVJUKGlzX2h2bV9kb21haW4oZCkpOwogCi0gICAgaWYg
KCAhaW9tbXVfZW5hYmxlZCB8fCAoIWlzX2hhcmR3YXJlX2RvbWFpbihkKSAmJiAhZHBjaSkgfHwK
KyAgICBpZiAoICFpc19pb21tdV9lbmFibGVkKGQpIHx8ICghaXNfaGFyZHdhcmVfZG9tYWluKGQp
ICYmICFkcGNpKSB8fAogICAgICAgICAgIXBpcnFfZHBjaSB8fCAhKHBpcnFfZHBjaS0+ZmxhZ3Mg
JiBIVk1fSVJRX0RQQ0lfTUFQUEVEKSApCiAgICAgICAgIHJldHVybiAwOwogCkBAIC04NjksNyAr
ODY5LDcgQEAgc3RhdGljIGludCBfaHZtX2RwY2lfbXNpX2VvaShzdHJ1Y3QgZG9tYWluICpkLAog
CiB2b2lkIGh2bV9kcGNpX21zaV9lb2koc3RydWN0IGRvbWFpbiAqZCwgaW50IHZlY3RvcikKIHsK
LSAgICBpZiAoICFpb21tdV9lbmFibGVkIHx8CisgICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChk
KSB8fAogICAgICAgICAgKCFodm1fZG9tYWluX2lycShkKS0+ZHBjaSAmJiAhaXNfaGFyZHdhcmVf
ZG9tYWluKGQpKSApCiAgICAgICAgcmV0dXJuOwogCkBAIC0xMDAxLDcgKzEwMDEsNyBAQCB2b2lk
IGh2bV9kcGNpX2VvaShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQgZ3Vlc3RfZ3NpLAog
ICAgIGNvbnN0IHN0cnVjdCBodm1faXJxX2RwY2kgKmh2bV9pcnFfZHBjaTsKICAgICBjb25zdCBz
dHJ1Y3QgaHZtX2dpcnFfZHBjaV9tYXBwaW5nICpnaXJxOwogCi0gICAgaWYgKCAhaW9tbXVfZW5h
YmxlZCApCisgICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChkKSApCiAgICAgICAgIHJldHVybjsK
IAogICAgIGlmICggaXNfaGFyZHdhcmVfZG9tYWluKGQpICkKZGlmZiAtLWdpdCBhL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2lvbW11LmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pb21tdS5j
CmluZGV4IGU2MWQzZDEzNjguLjlkYWNlNjRhZjkgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW9tbXUuYwpA
QCAtMTc5LDcgKzE3OSw3IEBAIHZvaWQgX19od2RvbV9pbml0IGlvbW11X2h3ZG9tX2luaXQoc3Ry
dWN0IGRvbWFpbiAqZCkKIAogICAgIGNoZWNrX2h3ZG9tX3JlcXMoZCk7CiAKLSAgICBpZiAoICFp
b21tdV9lbmFibGVkICkKKyAgICBpZiAoICFpc19pb21tdV9lbmFibGVkKGQpICkKICAgICAgICAg
cmV0dXJuOwogCiAgICAgcmVnaXN0ZXJfa2V5aGFuZGxlcignbycsICZpb21tdV9kdW1wX3AybV90
YWJsZSwgImR1bXAgaW9tbXUgcDJtIHRhYmxlIiwgMCk7CkBAIC0yODQsNyArMjg0LDcgQEAgaW50
IGlvbW11X2NvbnN0cnVjdChzdHJ1Y3QgZG9tYWluICpkKQogCiB2b2lkIGlvbW11X2RvbWFpbl9k
ZXN0cm95KHN0cnVjdCBkb21haW4gKmQpCiB7Ci0gICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAh
ZG9tX2lvbW11KGQpLT5wbGF0Zm9ybV9vcHMgKQorICAgIGlmICggIWlzX2lvbW11X2VuYWJsZWQo
ZCkgKQogICAgICAgICByZXR1cm47CiAKICAgICBpb21tdV90ZWFyZG93bihkKTsKQEAgLTMwMCw3
ICszMDAsNyBAQCBpbnQgaW9tbXVfbWFwKHN0cnVjdCBkb21haW4gKmQsIGRmbl90IGRmbiwgbWZu
X3QgbWZuLAogICAgIHVuc2lnbmVkIGxvbmcgaTsKICAgICBpbnQgcmMgPSAwOwogCi0gICAgaWYg
KCAhaW9tbXVfZW5hYmxlZCB8fCAhaGQtPnBsYXRmb3JtX29wcyApCisgICAgaWYgKCAhaXNfaW9t
bXVfZW5hYmxlZChkKSApCiAgICAgICAgIHJldHVybiAwOwogCiAgICAgQVNTRVJUKElTX0FMSUdO
RUQoZGZuX3goZGZuKSwgKDF1bCA8PCBwYWdlX29yZGVyKSkpOwpAQCAtMzYwLDcgKzM2MCw3IEBA
IGludCBpb21tdV91bm1hcChzdHJ1Y3QgZG9tYWluICpkLCBkZm5fdCBkZm4sIHVuc2lnbmVkIGlu
dCBwYWdlX29yZGVyLAogICAgIHVuc2lnbmVkIGxvbmcgaTsKICAgICBpbnQgcmMgPSAwOwogCi0g
ICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAhaGQtPnBsYXRmb3JtX29wcyApCisgICAgaWYgKCAh
aXNfaW9tbXVfZW5hYmxlZChkKSApCiAgICAgICAgIHJldHVybiAwOwogCiAgICAgQVNTRVJUKElT
X0FMSUdORUQoZGZuX3goZGZuKSwgKDF1bCA8PCBwYWdlX29yZGVyKSkpOwpAQCAtNDEzLDcgKzQx
Myw3IEBAIGludCBpb21tdV9sb29rdXBfcGFnZShzdHJ1Y3QgZG9tYWluICpkLCBkZm5fdCBkZm4s
IG1mbl90ICptZm4sCiB7CiAgICAgY29uc3Qgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21f
aW9tbXUoZCk7CiAKLSAgICBpZiAoICFpb21tdV9lbmFibGVkIHx8ICFoZC0+cGxhdGZvcm1fb3Bz
IHx8ICFoZC0+cGxhdGZvcm1fb3BzLT5sb29rdXBfcGFnZSApCisgICAgaWYgKCAhaXNfaW9tbXVf
ZW5hYmxlZChkKSB8fCAhaGQtPnBsYXRmb3JtX29wcy0+bG9va3VwX3BhZ2UgKQogICAgICAgICBy
ZXR1cm4gLUVPUE5PVFNVUFA7CiAKICAgICByZXR1cm4gaW9tbXVfY2FsbChoZC0+cGxhdGZvcm1f
b3BzLCBsb29rdXBfcGFnZSwgZCwgZGZuLCBtZm4sIGZsYWdzKTsKQEAgLTQ0Miw4ICs0NDIsOCBA
QCBpbnQgaW9tbXVfaW90bGJfZmx1c2goc3RydWN0IGRvbWFpbiAqZCwgZGZuX3QgZGZuLCB1bnNp
Z25lZCBpbnQgcGFnZV9jb3VudCwKICAgICBjb25zdCBzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9
IGRvbV9pb21tdShkKTsKICAgICBpbnQgcmM7CiAKLSAgICBpZiAoICFpb21tdV9lbmFibGVkIHx8
ICFoZC0+cGxhdGZvcm1fb3BzIHx8Ci0gICAgICAgICAhaGQtPnBsYXRmb3JtX29wcy0+aW90bGJf
Zmx1c2ggfHwgIXBhZ2VfY291bnQgfHwgIWZsdXNoX2ZsYWdzICkKKyAgICBpZiAoICFpc19pb21t
dV9lbmFibGVkKGQpIHx8ICFoZC0+cGxhdGZvcm1fb3BzLT5pb3RsYl9mbHVzaCB8fAorICAgICAg
ICAgIXBhZ2VfY291bnQgfHwgIWZsdXNoX2ZsYWdzICkKICAgICAgICAgcmV0dXJuIDA7CiAKICAg
ICBpZiAoIGRmbl9lcShkZm4sIElOVkFMSURfREZOKSApCkBAIC00NzAsOCArNDcwLDggQEAgaW50
IGlvbW11X2lvdGxiX2ZsdXNoX2FsbChzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQgZmx1
c2hfZmxhZ3MpCiAgICAgY29uc3Qgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUo
ZCk7CiAgICAgaW50IHJjOwogCi0gICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAhaGQtPnBsYXRm
b3JtX29wcyB8fAotICAgICAgICAgIWhkLT5wbGF0Zm9ybV9vcHMtPmlvdGxiX2ZsdXNoX2FsbCB8
fCAhZmx1c2hfZmxhZ3MgKQorICAgIGlmICggIWlzX2lvbW11X2VuYWJsZWQoZCkgfHwgIWhkLT5w
bGF0Zm9ybV9vcHMtPmlvdGxiX2ZsdXNoX2FsbCB8fAorICAgICAgICAgIWZsdXNoX2ZsYWdzICkK
ICAgICAgICAgcmV0dXJuIDA7CiAKICAgICAvKgpAQCAtNTU2LDggKzU1Niw4IEBAIGludCBpb21t
dV9kb19kb21jdGwoCiB7CiAgICAgaW50IHJldCA9IC1FTk9ERVY7CiAKLSAgICBpZiAoICFpb21t
dV9lbmFibGVkICkKLSAgICAgICAgcmV0dXJuIC1FTk9TWVM7CisgICAgaWYgKCAhaXNfaW9tbXVf
ZW5hYmxlZChkKSApCisgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsKIAogI2lmZGVmIENPTkZJ
R19IQVNfUENJCiAgICAgcmV0ID0gaW9tbXVfZG9fcGNpX2RvbWN0bChkb21jdGwsIGQsIHVfZG9t
Y3RsKTsKQEAgLTU3Niw5ICs1NzYsOSBAQCB2b2lkIGlvbW11X3NoYXJlX3AybV90YWJsZShzdHJ1
Y3QgZG9tYWluKiBkKQogICAgIEFTU0VSVChoYXBfZW5hYmxlZChkKSk7CiAgICAgLyoKICAgICAg
KiBpb21tdV91c2VfaGFwX3B0KGQpIGNhbm5vdCBiZSB1c2VkIGhlcmUgYmVjYXVzZSBkdXJpbmcg
ZG9tYWluCi0gICAgICogY29uc3RydWN0aW9uIG5lZWRfaW9tbXUoZCkgd2lsbCBhbHdheXMgcmV0
dXJuIGZhbHNlIGhlcmUuCisgICAgICogY29uc3RydWN0aW9uIGhhc19pb21tdV9wdChkKSB3aWxs
IGFsd2F5cyByZXR1cm4gZmFsc2UgaGVyZS4KICAgICAgKi8KLSAgICBpZiAoIGlvbW11X2VuYWJs
ZWQgJiYgaW9tbXVfaGFwX3B0X3NoYXJlICkKKyAgICBpZiAoIGlzX2lvbW11X2VuYWJsZWQoZCkg
JiYgaW9tbXVfaGFwX3B0X3NoYXJlICkKICAgICAgICAgaW9tbXVfZ2V0X29wcygpLT5zaGFyZV9w
Mm0oZCk7CiB9CiAKQEAgLTYwOCwxMCArNjA4LDcgQEAgaW50IGlvbW11X2dldF9yZXNlcnZlZF9k
ZXZpY2VfbWVtb3J5KGlvbW11X2dyZG1fdCAqZnVuYywgdm9pZCAqY3R4dCkKIAogYm9vbF90IGlv
bW11X2hhc19mZWF0dXJlKHN0cnVjdCBkb21haW4gKmQsIGVudW0gaW9tbXVfZmVhdHVyZSBmZWF0
dXJlKQogewotICAgIGlmICggIWlvbW11X2VuYWJsZWQgKQotICAgICAgICByZXR1cm4gMDsKLQot
ICAgIHJldHVybiB0ZXN0X2JpdChmZWF0dXJlLCBkb21faW9tbXUoZCktPmZlYXR1cmVzKTsKKyAg
ICByZXR1cm4gaXNfaW9tbXVfZW5hYmxlZChkKSAmJiB0ZXN0X2JpdChmZWF0dXJlLCBkb21faW9t
bXUoZCktPmZlYXR1cmVzKTsKIH0KIAogc3RhdGljIHZvaWQgaW9tbXVfZHVtcF9wMm1fdGFibGUo
dW5zaWduZWQgY2hhciBrZXkpCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9w
Y2kuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jCmluZGV4IDdjMTk2YmE1OGIuLmE1
NmEyN2Y1NDYgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jCisrKyBi
L3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jCkBAIC01OTUsNyArNTk1LDcgQEAgc3RhdGlj
IHZvaWQgcGNpX2VuYWJsZV9hY3Moc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgdTE2IGNhcCwg
Y3RybCwgc2VnID0gcGRldi0+c2VnOwogICAgIHU4IGJ1cyA9IHBkZXYtPmJ1czsKIAotICAgIGlm
ICggIWlvbW11X2VuYWJsZWQgKQorICAgIGlmICggIWlzX2lvbW11X2VuYWJsZWQocGRldi0+ZG9t
YWluKSApCiAgICAgICAgIHJldHVybjsKIAogICAgIHBvcyA9IHBjaV9maW5kX2V4dF9jYXBhYmls
aXR5KHNlZywgYnVzLCBwZGV2LT5kZXZmbiwgUENJX0VYVF9DQVBfSURfQUNTKTsKQEAgLTg2NCw3
ICs4NjQsNyBAQCBzdGF0aWMgaW50IHBjaV9jbGVhbl9kcGNpX2lycXMoc3RydWN0IGRvbWFpbiAq
ZCkKIHsKICAgICBzdHJ1Y3QgaHZtX2lycV9kcGNpICpodm1faXJxX2RwY2kgPSBOVUxMOwogCi0g
ICAgaWYgKCAhaW9tbXVfZW5hYmxlZCApCisgICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChkKSAp
CiAgICAgICAgIHJldHVybiAwOwogCiAgICAgaWYgKCAhaXNfaHZtX2RvbWFpbihkKSApCkBAIC0x
MzMzLDcgKzEzMzMsNyBAQCBzdGF0aWMgaW50IGlvbW11X2FkZF9kZXZpY2Uoc3RydWN0IHBjaV9k
ZXYgKnBkZXYpCiAgICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOwogCiAgICAgaGQgPSBkb21f
aW9tbXUocGRldi0+ZG9tYWluKTsKLSAgICBpZiAoICFpb21tdV9lbmFibGVkIHx8ICFoZC0+cGxh
dGZvcm1fb3BzICkKKyAgICBpZiAoICFpc19pb21tdV9lbmFibGVkKHBkZXYtPmRvbWFpbikgKQog
ICAgICAgICByZXR1cm4gMDsKIAogICAgIHJjID0gaGQtPnBsYXRmb3JtX29wcy0+YWRkX2Rldmlj
ZShwZGV2LT5kZXZmbiwgcGNpX3RvX2RldihwZGV2KSk7CkBAIC0xMzYyLDcgKzEzNjIsNyBAQCBz
dGF0aWMgaW50IGlvbW11X2VuYWJsZV9kZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAg
QVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOwogCiAgICAgaGQgPSBkb21faW9tbXUocGRldi0+ZG9t
YWluKTsKLSAgICBpZiAoICFpb21tdV9lbmFibGVkIHx8ICFoZC0+cGxhdGZvcm1fb3BzIHx8Cisg
ICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChwZGV2LT5kb21haW4pIHx8CiAgICAgICAgICAhaGQt
PnBsYXRmb3JtX29wcy0+ZW5hYmxlX2RldmljZSApCiAgICAgICAgIHJldHVybiAwOwogCkBAIC0x
Mzc4LDcgKzEzNzgsNyBAQCBzdGF0aWMgaW50IGlvbW11X3JlbW92ZV9kZXZpY2Uoc3RydWN0IHBj
aV9kZXYgKnBkZXYpCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCiAgICAgaGQgPSBkb21faW9t
bXUocGRldi0+ZG9tYWluKTsKLSAgICBpZiAoICFpb21tdV9lbmFibGVkIHx8ICFoZC0+cGxhdGZv
cm1fb3BzICkKKyAgICBpZiAoICFpc19pb21tdV9lbmFibGVkKHBkZXYtPmRvbWFpbikgKQogICAg
ICAgICByZXR1cm4gMDsKIAogICAgIGZvciAoIGRldmZuID0gcGRldi0+ZGV2Zm4gOyBwZGV2LT5w
aGFudG9tX3N0cmlkZTsgKQpAQCAtMTQyMSw3ICsxNDIxLDcgQEAgc3RhdGljIGludCBhc3NpZ25f
ZGV2aWNlKHN0cnVjdCBkb21haW4gKmQsIHUxNiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4sIHUzMiBm
bGFnKQogICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2OwogICAgIGludCByYyA9IDA7CiAKLSAgICBp
ZiAoICFpb21tdV9lbmFibGVkIHx8ICFoZC0+cGxhdGZvcm1fb3BzICkKKyAgICBpZiAoICFpc19p
b21tdV9lbmFibGVkKGQpICkKICAgICAgICAgcmV0dXJuIDA7CiAKICAgICAvKiBQcmV2ZW50IGRl
dmljZSBhc3NpZ24gaWYgbWVtIHBhZ2luZyBvciBtZW0gc2hhcmluZyBoYXZlIGJlZW4gCkBAIC0x
NDgzLDcgKzE0ODMsNyBAQCBpbnQgZGVhc3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4gKmQsIHUx
NiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4pCiAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBOVUxM
OwogICAgIGludCByZXQgPSAwOwogCi0gICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAhaGQtPnBs
YXRmb3JtX29wcyApCisgICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChkKSApCiAgICAgICAgIHJl
dHVybiAtRUlOVkFMOwogCiAgICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOwpAQCAtMTUzNiw3
ICsxNTM2LDcgQEAgc3RhdGljIGludCBpb21tdV9nZXRfZGV2aWNlX2dyb3VwKAogICAgIGludCBp
ID0gMDsKICAgICBjb25zdCBzdHJ1Y3QgaW9tbXVfb3BzICpvcHMgPSBoZC0+cGxhdGZvcm1fb3Bz
OwogCi0gICAgaWYgKCAhaW9tbXVfZW5hYmxlZCB8fCAhb3BzIHx8ICFvcHMtPmdldF9kZXZpY2Vf
Z3JvdXBfaWQgKQorICAgIGlmICggIWlzX2lvbW11X2VuYWJsZWQoZCkgfHwgIW9wcy0+Z2V0X2Rl
dmljZV9ncm91cF9pZCApCiAgICAgICAgIHJldHVybiAwOwogCiAgICAgZ3JvdXBfaWQgPSBvcHMt
PmdldF9kZXZpY2VfZ3JvdXBfaWQoc2VnLCBidXMsIGRldmZuKTsKZGlmZiAtLWdpdCBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
dnRkL2lvbW11LmMKaW5kZXggNWQ3MjI3MGM1Yi4uMDFmMGJjNDY4OSAxMDA2NDQKLS0tIGEveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL2lvbW11LmMKQEAgLTE3NTcsNyArMTc1Nyw3IEBAIHN0YXRpYyB2b2lkIGlvbW11
X2RvbWFpbl90ZWFyZG93bihzdHJ1Y3QgZG9tYWluICpkKQogICAgICAgICB4ZnJlZShtcm1ycik7
CiAgICAgfQogCi0gICAgQVNTRVJUKGlvbW11X2VuYWJsZWQpOworICAgIEFTU0VSVChpc19pb21t
dV9lbmFibGVkKGQpKTsKIAogICAgIC8qCiAgICAgICogV2UgY2FuJ3QgdXNlIGlvbW11X3VzZV9o
YXBfcHQgaGVyZSBiZWNhdXNlIGVpdGhlciBJT01NVSBzdGF0ZQpkaWZmIC0tZ2l0IGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3g4Ni9odm0uYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC94ODYvaHZtLmMKaW5kZXggNjY3NWRjYTAyNy4uZjc3YjM1ODE1YyAxMDA2NDQKLS0tIGEv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3g4Ni9odm0uYworKysgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC92dGQveDg2L2h2bS5jCkBAIC01MSw3ICs1MSw3IEBAIHZvaWQgaHZtX2RwY2lf
aXNhaXJxX2VvaShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQgaXNhaXJxKQogICAgIHN0
cnVjdCBodm1faXJxX2RwY2kgKmRwY2kgPSBOVUxMOwogCiAgICAgQVNTRVJUKGlzYWlycSA8IE5S
X0lTQUlSUVMpOwotICAgIGlmICggIWlvbW11X2VuYWJsZWQgKQorICAgIGlmICggIWlzX2lvbW11
X2VuYWJsZWQoZCkgKQogICAgICAgICByZXR1cm47CiAKICAgICBzcGluX2xvY2soJmQtPmV2ZW50
X2xvY2spOwpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2lvbW11LmMg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYwppbmRleCBmZDA1MDc1YmI1Li45
ODc5NTU4YzE3IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYwpAQCAtMTc4LDcgKzE3
OCw3IEBAIGludCBhcmNoX2lvbW11X3BvcHVsYXRlX3BhZ2VfdGFibGUoc3RydWN0IGRvbWFpbiAq
ZCkKIAogdm9pZCBfX2h3ZG9tX2luaXQgYXJjaF9pb21tdV9jaGVja19hdXRvdHJhbnNsYXRlZF9o
d2RvbShzdHJ1Y3QgZG9tYWluICpkKQogewotICAgIGlmICggIWlvbW11X2VuYWJsZWQgKQorICAg
IGlmICggIWlzX2lvbW11X2VuYWJsZWQoZCkgKQogICAgICAgICBwYW5pYygiUHJlc2VudGx5LCBp
b21tdSBtdXN0IGJlIGVuYWJsZWQgZm9yIFBWSCBoYXJkd2FyZSBkb21haW5cbiIpOwogfQogCmRp
ZmYgLS1naXQgYS94ZW4veHNtL2ZsYXNrL2hvb2tzLmMgYi94ZW4veHNtL2ZsYXNrL2hvb2tzLmMK
aW5kZXggNzkxYzFmNjZhZi4uNWEwZjJlNzIzZSAxMDA2NDQKLS0tIGEveGVuL3hzbS9mbGFzay9o
b29rcy5jCisrKyBiL3hlbi94c20vZmxhc2svaG9va3MuYwpAQCAtODg2LDcgKzg4Niw3IEBAIHN0
YXRpYyBpbnQgZmxhc2tfbWFwX2RvbWFpbl9tc2kgKHN0cnVjdCBkb21haW4gKmQsIGludCBpcnEs
IGNvbnN0IHZvaWQgKmRhdGEsCiAjZW5kaWYKIH0KIAotc3RhdGljIHUzMiBmbGFza19pb21tdV9y
ZXNvdXJjZV91c2VfcGVybSh2b2lkKQorc3RhdGljIHUzMiBmbGFza19pb21tdV9yZXNvdXJjZV91
c2VfcGVybShzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIC8qIE9idGFpbiB0aGUgcGVybWlzc2lv
biBsZXZlbCByZXF1aXJlZCBmb3IgYWxsb3dpbmcgYSBkb21haW4KICAgICAgKiB0byB1c2UgYW4g
YXNzaWduZWQgZGV2aWNlLgpAQCAtODk5LDcgKzg5OSw3IEBAIHN0YXRpYyB1MzIgZmxhc2tfaW9t
bXVfcmVzb3VyY2VfdXNlX3Blcm0odm9pZCkKICAgICAgKi8KICAgICB1MzIgcGVybSA9IFJFU09V
UkNFX19VU0VfTk9JT01NVTsKIAotICAgIGlmIChpb21tdV9lbmFibGVkKQorICAgIGlmICggaXNf
aW9tbXVfZW5hYmxlZChkKSApCiAgICAgICAgIHBlcm0gPSAoIGlvbW11X2ludHJlbWFwID8gUkVT
T1VSQ0VfX1VTRV9JT01NVSA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVT
T1VSQ0VfX1VTRV9JT01NVV9OT0lOVFJFTUFQICk7CiAgICAgcmV0dXJuIHBlcm07CkBAIC05MTAs
NyArOTEwLDcgQEAgc3RhdGljIGludCBmbGFza19tYXBfZG9tYWluX2lycSAoc3RydWN0IGRvbWFp
biAqZCwgaW50IGlycSwgY29uc3Qgdm9pZCAqZGF0YSkKICAgICB1MzIgc2lkLCBkc2lkOwogICAg
IGludCByYyA9IC1FUEVSTTsKICAgICBzdHJ1Y3QgYXZjX2F1ZGl0X2RhdGEgYWQ7Ci0gICAgdTMy
IGRwZXJtID0gZmxhc2tfaW9tbXVfcmVzb3VyY2VfdXNlX3Blcm0oKTsKKyAgICB1MzIgZHBlcm0g
PSBmbGFza19pb21tdV9yZXNvdXJjZV91c2VfcGVybShkKTsKIAogICAgIGlmICggaXJxID49IG5y
X3N0YXRpY19pcnFzICYmIGRhdGEgKSB7CiAgICAgICAgIHJjID0gZmxhc2tfbWFwX2RvbWFpbl9t
c2koZCwgaXJxLCBkYXRhLCAmc2lkLCAmYWQpOwpAQCAtOTc2LDcgKzk3Niw3IEBAIHN0YXRpYyBp
bnQgZmxhc2tfYmluZF9wdF9pcnEgKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5fZG9tY3Rs
X2JpbmRfcHRfaXJxICpiCiAgICAgaW50IHJjID0gLUVQRVJNOwogICAgIGludCBpcnE7CiAgICAg
c3RydWN0IGF2Y19hdWRpdF9kYXRhIGFkOwotICAgIHUzMiBkcGVybSA9IGZsYXNrX2lvbW11X3Jl
c291cmNlX3VzZV9wZXJtKCk7CisgICAgdTMyIGRwZXJtID0gZmxhc2tfaW9tbXVfcmVzb3VyY2Vf
dXNlX3Blcm0oZCk7CiAKICAgICByYyA9IGN1cnJlbnRfaGFzX3Blcm0oZCwgU0VDQ0xBU1NfUkVT
T1VSQ0UsIFJFU09VUkNFX19BREQpOwogICAgIGlmICggcmMgKQpAQCAtMTA0OSw3ICsxMDQ5LDcg
QEAgc3RhdGljIGludCBmbGFza19pb21lbV9wZXJtaXNzaW9uKHN0cnVjdCBkb21haW4gKmQsIHVp
bnQ2NF90IHN0YXJ0LCB1aW50NjRfdCBlbmQKIAogICAgIGRhdGEuc3NpZCA9IGRvbWFpbl9zaWQo
Y3VycmVudC0+ZG9tYWluKTsKICAgICBkYXRhLmRzaWQgPSBkb21haW5fc2lkKGQpOwotICAgIGRh
dGEudXNlX3Blcm0gPSBmbGFza19pb21tdV9yZXNvdXJjZV91c2VfcGVybSgpOworICAgIGRhdGEu
dXNlX3Blcm0gPSBmbGFza19pb21tdV9yZXNvdXJjZV91c2VfcGVybShkKTsKIAogICAgIHJldHVy
biBzZWN1cml0eV9pdGVyYXRlX2lvbWVtX3NpZHMoc3RhcnQsIGVuZCwgX2lvbWVtX2hhc19wZXJt
LCAmZGF0YSk7CiB9CkBAIC0xMDc0LDcgKzEwNzQsNyBAQCBzdGF0aWMgaW50IGZsYXNrX3BjaV9j
b25maWdfcGVybWlzc2lvbihzdHJ1Y3QgZG9tYWluICpkLCB1aW50MzJfdCBtYWNoaW5lX2JkZiwg
dQogICAgIGlmICggYWNjZXNzICYmIChlbmQgPj0gMHgxMCAmJiBzdGFydCA8IDB4MjgpICkKICAg
ICAgICAgcGVybSA9IFJFU09VUkNFX19TRVRVUDsKICAgICBlbHNlCi0gICAgICAgIHBlcm0gPSBm
bGFza19pb21tdV9yZXNvdXJjZV91c2VfcGVybSgpOworICAgICAgICBwZXJtID0gZmxhc2tfaW9t
bXVfcmVzb3VyY2VfdXNlX3Blcm0oZCk7CiAKICAgICBBVkNfQVVESVRfREFUQV9JTklUKCZhZCwg
REVWKTsKICAgICBhZC5kZXZpY2UgPSAodW5zaWduZWQgbG9uZykgbWFjaGluZV9iZGY7CkBAIC0x
Mjk5LDcgKzEyOTksNyBAQCBzdGF0aWMgaW50IGZsYXNrX2Fzc2lnbl9kZXZpY2Uoc3RydWN0IGRv
bWFpbiAqZCwgdWludDMyX3QgbWFjaGluZV9iZGYpCiAgICAgdTMyIGRzaWQsIHJzaWQ7CiAgICAg
aW50IHJjID0gLUVQRVJNOwogICAgIHN0cnVjdCBhdmNfYXVkaXRfZGF0YSBhZDsKLSAgICB1MzIg
ZHBlcm0gPSBmbGFza19pb21tdV9yZXNvdXJjZV91c2VfcGVybSgpOworICAgIHUzMiBkcGVybSA9
IGZsYXNrX2lvbW11X3Jlc291cmNlX3VzZV9wZXJtKGQpOwogCiAgICAgaWYgKCAhZCApCiAgICAg
ICAgIHJldHVybiBmbGFza190ZXN0X2Fzc2lnbl9kZXZpY2UobWFjaGluZV9iZGYpOwpAQCAtMTM1
OCw3ICsxMzU4LDcgQEAgc3RhdGljIGludCBmbGFza19hc3NpZ25fZHRkZXZpY2Uoc3RydWN0IGRv
bWFpbiAqZCwgY29uc3QgY2hhciAqZHRwYXRoKQogICAgIHUzMiBkc2lkLCByc2lkOwogICAgIGlu
dCByYyA9IC1FUEVSTTsKICAgICBzdHJ1Y3QgYXZjX2F1ZGl0X2RhdGEgYWQ7Ci0gICAgdTMyIGRw
ZXJtID0gZmxhc2tfaW9tbXVfcmVzb3VyY2VfdXNlX3Blcm0oKTsKKyAgICB1MzIgZHBlcm0gPSBm
bGFza19pb21tdV9yZXNvdXJjZV91c2VfcGVybShkKTsKIAogICAgIGlmICggIWQgKQogICAgICAg
ICByZXR1cm4gZmxhc2tfdGVzdF9hc3NpZ25fZHRkZXZpY2UoZHRwYXRoKTsKQEAgLTE1NDMsNyAr
MTU0Myw3IEBAIHN0YXRpYyBpbnQgZmxhc2tfaW9wb3J0X3Blcm1pc3Npb24oc3RydWN0IGRvbWFp
biAqZCwgdWludDMyX3Qgc3RhcnQsIHVpbnQzMl90IGVuCiAKICAgICBkYXRhLnNzaWQgPSBkb21h
aW5fc2lkKGN1cnJlbnQtPmRvbWFpbik7CiAgICAgZGF0YS5kc2lkID0gZG9tYWluX3NpZChkKTsK
LSAgICBkYXRhLnVzZV9wZXJtID0gZmxhc2tfaW9tbXVfcmVzb3VyY2VfdXNlX3Blcm0oKTsKKyAg
ICBkYXRhLnVzZV9wZXJtID0gZmxhc2tfaW9tbXVfcmVzb3VyY2VfdXNlX3Blcm0oZCk7CiAKICAg
ICByZXR1cm4gc2VjdXJpdHlfaXRlcmF0ZV9pb3BvcnRfc2lkcyhzdGFydCwgZW5kLCBfaW9wb3J0
X2hhc19wZXJtLCAmZGF0YSk7CiB9Ci0tIAoyLjIwLjEuMi5nYjIxZWJiNjcxCgoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcg
bGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9q
ZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id ACAB117E2BB
	for <lists+xen-devel@lfdr.de>; Mon,  9 Mar 2020 15:52:03 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1jBJix-0001SC-SN; Mon, 09 Mar 2020 14:49:43 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=PQZd=42=citrix.com=george.dunlap@srs-us1.protection.inumbo.net>)
 id 1jBJiw-0001Rx-J4
 for xen-devel@lists.xenproject.org; Mon, 09 Mar 2020 14:49:42 +0000
X-Inumbo-ID: 34524e68-6215-11ea-8eb5-bc764e2007e4
Received: from esa6.hc3370-68.iphmx.com (unknown [216.71.155.175])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 34524e68-6215-11ea-8eb5-bc764e2007e4;
 Mon, 09 Mar 2020 14:49:40 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1583765380;
 h=from:to:cc:subject:date:message-id:mime-version:
 content-transfer-encoding;
 bh=VMalUWW/mwd8J6AjIboGstDjtuqifUX+O/azJByuSJE=;
 b=bW8EEFDKD4yjtzI83pwpRw9V4CWOFVTBsHoO4a1G5MKYOAPERpzELpsX
 xR779d3d5ztTfCP7ZZn7c6lOMhkUCiDRvdp2Ldp5DzZn7O1Aq574FKPas
 G+gXyljBoo+ZVnWgqOTUKKzi9n5SQ3CT1EKbkXhiSCddpaUNkUwPunxv2 k=;
Authentication-Results: esa6.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=george.dunlap@citrix.com;
 spf=Pass smtp.mailfrom=George.Dunlap@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa6.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 george.dunlap@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="george.dunlap@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa6.hc3370-68.iphmx.com: domain of
 George.Dunlap@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="George.Dunlap@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa6.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: k1abInyTpTh98QElWzbpYh7AJj8MEao3MhqxK4MSGi/SrV+4VKxomcxGS6/Wa/eZiJrM8a6qVk
 ++BN4ElD89t9qZ0Va9SLNAVAzmmgTVsgV2K3Hu+RDH0NB1K8uVyQGKWM1T3CYLAnhMeyxJKIzP
 POa7X1MQkwFq946yOTKLT65UGZcmc0juRIUU8SQUP7mIV7ECxOC0SRheu7vO8taAz9dk+o2svr
 U6T/SZn8bENQq/P0jNJJPAEg6teBmNxJ3MtGRlc1PRJ6Q87pFamdQd3ryVSMxWOJ/x8tVbh2JM
 VjE=
X-SBRS: 2.7
X-MesageID: 14059255
X-Ironport-Server: esa6.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.70,533,1574139600"; d="scan'208";a="14059255"
From: George Dunlap <george.dunlap@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Mon, 9 Mar 2020 14:49:30 +0000
Message-ID: <20200309144932.866097-1-george.dunlap@citrix.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v4 1/3] golang/xenlight: Don't try to marshall
 zero-length arrays in fromC
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 George Dunlap <george.dunlap@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIGN1cnJlbnQgZnJvbUMgYXJyYXkgY29kZSB3aWxsIGRvIHRoZSAibWFnaWMiIGNhc3Rpbmcg
YW5kCm1hcnRpYWxsaW5nIGV2ZW4gd2hlbiBudW1fZm9vIHZhcmlhYmxlIGlzIDAuICBHbyBjcmFz
aGVzIHdoZW4gZG9pbmcKdGhlIGNhc3QuCgpPbmx5IGRvIGFycmF5IG1hcnNoYWxsaW5nIGlmIHRo
ZSBudW1iZXIgb2YgZWxlbWVudHMgaXMgbm9uLXplcm87Cm90aGVyd2lzZSwgbGVhdmUgdGhlIHRh
cmdldCBwb2ludGVyIGVtcHR5IChuaWwgZm9yIEdvIHNsaWNlcywgTlVMTCBmb3IKQyBhcnJheXMp
LgoKU2lnbmVkLW9mZi1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29t
PgotLS0KdjQ6Ci0gUmVwbGFjZSBmaWVsZG5hbWUtYmFzZWQgdmFyaWFibGUgd2l0aCAnbicKdjI6
Ci0gUmVtb3ZlIHRvQyBwYXJ0IG9mIHRoaXMsIHdoaWNoIGhhcyBiZWVuIGZvbGRlZCBpbnRvIE5p
Y2sncyBwYXRjaAogIHNlcmllcy4KCkNDOiBOaWNrIFJvc2Jyb29rIDxyb3Nicm9va25AYWluZm9z
ZWMuY29tPgotLS0KIHRvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5ICB8ICAxMSAr
LQogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvIHwgNDQwICsrKysrKysrKysr
KysrKy0tLS0tLS0tLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCAyNTcgaW5zZXJ0aW9ucygrKSwgMTk0
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5
cGVzLnB5IGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkKaW5kZXggNTBkYWRh
MzA5Yi4uZTlhZDkyYWZhMCAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdv
dHlwZXMucHkKKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkKQEAgLTQy
NiwxMyArNDI2LDEyIEBAIGRlZiB4ZW5saWdodF9nb2xhbmdfYXJyYXlfZnJvbV9DKHR5ID0gTm9u
ZSk6CiAgICAgY25hbWUgICAgICA9IHR5Lm5hbWUKICAgICBjc2xpY2UgICAgID0gJ2N7fScuZm9y
bWF0KGdvbmFtZSkKICAgICBjbGVudmFyICAgID0gdHkudHlwZS5sZW52YXIubmFtZQotICAgIGdv
bGVudmFyICAgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUoY2xlbnZhcixleHBvcnRlZD1GYWxz
ZSkKIAotICAgIHMgKz0gJ3t9IDo9IGludCh4Yy57fSlcbicuZm9ybWF0KGdvbGVudmFyLCBjbGVu
dmFyKQorICAgIHMgKz0gJ3gue30gPSBuaWxcbicuZm9ybWF0KGdvbmFtZSkKKyAgICBzICs9ICdp
ZiBuIDo9IGludCh4Yy57fSk7IG4gPiAwIHt7XG4nLmZvcm1hdChjbGVudmFyKQogICAgIHMgKz0g
J3t9IDo9ICcuZm9ybWF0KGNzbGljZSkKLSAgICBzICs9JygqWzE8PDI4XUMue30pKHVuc2FmZS5Q
b2ludGVyKHhjLnt9KSlbOnt9Ont9XVxuJy5mb3JtYXQoY3R5cGVuYW1lLCBjbmFtZSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBnb2xlbnZhciwgZ29sZW52YXIpCi0gICAgcyArPSAneC57fSA9IG1ha2UoW117fSwge30pXG4n
LmZvcm1hdChnb25hbWUsIGdvdHlwZW5hbWUsIGdvbGVudmFyKQorICAgIHMgKz0nKCpbMTw8Mjhd
Qy57fSkodW5zYWZlLlBvaW50ZXIoeGMue30pKVs6bjpuXVxuJy5mb3JtYXQoY3R5cGVuYW1lLCBj
bmFtZSkKKyAgICBzICs9ICd4Lnt9ID0gbWFrZShbXXt9LCBuKVxuJy5mb3JtYXQoZ29uYW1lLCBn
b3R5cGVuYW1lKQogICAgIHMgKz0gJ2ZvciBpLCB2IDo9IHJhbmdlIHt9IHt7XG4nLmZvcm1hdChj
c2xpY2UpCiAKICAgICBpc19lbnVtID0gaXNpbnN0YW5jZSh0eS50eXBlLmVsZW1fdHlwZSxpZGwu
RW51bWVyYXRpb24pCkBAIC00NDIsNyArNDQxLDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19hcnJh
eV9mcm9tX0ModHkgPSBOb25lKToKICAgICAgICAgcyArPSAnaWYgZXJyIDo9IHgue31baV0uZnJv
bUMoJnYpOyBlcnIgIT0gbmlsIHt7XG4nLmZvcm1hdChnb25hbWUpCiAgICAgICAgIHMgKz0gJ3Jl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHt9OiAldiIsIGVycikgfX1cbicuZm9y
bWF0KGdvbmFtZSkKIAotICAgIHMgKz0gJ31cbicKKyAgICBzICs9ICd9XG59XG4nCiAKICAgICBy
ZXR1cm4gcwogCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4u
Z28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5kZXggMzQ0Y2U5YTQ2
MS4uMTZlMjZkMjdmNSAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMu
Z2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwpAQCAtODg5
LDEyICs4ODksMTQgQEAgZnVuYyBOZXdWY3B1U2NoZWRQYXJhbXMoKSAoKlZjcHVTY2hlZFBhcmFt
cywgZXJyb3IpIHsKIAogZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4
bF92Y3B1X3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2No
ZWQpCi0JbnVtVmNwdXMgOj0gaW50KHhjLm51bV92Y3B1cykKLQljVmNwdXMgOj0gKCpbMSA8PCAy
OF1DLmxpYnhsX3NjaGVkX3BhcmFtcykodW5zYWZlLlBvaW50ZXIoeGMudmNwdXMpKVs6bnVtVmNw
dXM6bnVtVmNwdXNdCi0JeC5WY3B1cyA9IG1ha2UoW11TY2hlZFBhcmFtcywgbnVtVmNwdXMpCi0J
Zm9yIGksIHYgOj0gcmFuZ2UgY1ZjcHVzIHsKLQkJaWYgZXJyIDo9IHguVmNwdXNbaV0uZnJvbUMo
JnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxk
IFZjcHVzOiAldiIsIGVycikKKwl4LlZjcHVzID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX3Zj
cHVzKTsgbiA+IDAgeworCQljVmNwdXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3NjaGVkX3BhcmFt
cykodW5zYWZlLlBvaW50ZXIoeGMudmNwdXMpKVs6bjpuXQorCQl4LlZjcHVzID0gbWFrZShbXVNj
aGVkUGFyYW1zLCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBjVmNwdXMgeworCQkJaWYgZXJyIDo9
IHguVmNwdXNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCQlyZXR1cm4gZm10LkVycm9y
ZigiY29udmVydGluZyBmaWVsZCBWY3B1czogJXYiLCBlcnIpCisJCQl9CiAJCX0KIAl9CiAKQEAg
LTk5MSwxMSArOTkzLDEzIEBAIGZ1bmMgTmV3Vm5vZGVJbmZvKCkgKCpWbm9kZUluZm8sIGVycm9y
KSB7CiAKIGZ1bmMgKHggKlZub2RlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm5vZGVfaW5mbykg
ZXJyb3IgewogCXguTWVta2IgPSB1aW50NjQoeGMubWVta2IpCi0JbnVtRGlzdGFuY2VzIDo9IGlu
dCh4Yy5udW1fZGlzdGFuY2VzKQotCWNEaXN0YW5jZXMgOj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90
KSh1bnNhZmUuUG9pbnRlcih4Yy5kaXN0YW5jZXMpKVs6bnVtRGlzdGFuY2VzOm51bURpc3RhbmNl
c10KLQl4LkRpc3RhbmNlcyA9IG1ha2UoW111aW50MzIsIG51bURpc3RhbmNlcykKLQlmb3IgaSwg
diA6PSByYW5nZSBjRGlzdGFuY2VzIHsKLQkJeC5EaXN0YW5jZXNbaV0gPSB1aW50MzIodikKKwl4
LkRpc3RhbmNlcyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV9kaXN0YW5jZXMpOyBuID4gMCB7
CisJCWNEaXN0YW5jZXMgOj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4
Yy5kaXN0YW5jZXMpKVs6bjpuXQorCQl4LkRpc3RhbmNlcyA9IG1ha2UoW111aW50MzIsIG4pCisJ
CWZvciBpLCB2IDo9IHJhbmdlIGNEaXN0YW5jZXMgeworCQkJeC5EaXN0YW5jZXNbaV0gPSB1aW50
MzIodikKKwkJfQogCX0KIAl4LlBub2RlID0gdWludDMyKHhjLnBub2RlKQogCWlmIGVyciA6PSB4
LlZjcHVzLmZyb21DKCZ4Yy52Y3B1cyk7IGVyciAhPSBuaWwgewpAQCAtMTA5NSwyMCArMTA5OSwy
NCBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9i
dWlsZF9pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9IHguTm9kZW1hcC5mcm9tQygmeGMubm9kZW1h
cCk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBO
b2RlbWFwOiAldiIsIGVycikKIAl9Ci0JbnVtVmNwdUhhcmRBZmZpbml0eSA6PSBpbnQoeGMubnVt
X3ZjcHVfaGFyZF9hZmZpbml0eSkKLQljVmNwdUhhcmRBZmZpbml0eSA6PSAoKlsxIDw8IDI4XUMu
bGlieGxfYml0bWFwKSh1bnNhZmUuUG9pbnRlcih4Yy52Y3B1X2hhcmRfYWZmaW5pdHkpKVs6bnVt
VmNwdUhhcmRBZmZpbml0eTpudW1WY3B1SGFyZEFmZmluaXR5XQotCXguVmNwdUhhcmRBZmZpbml0
eSA9IG1ha2UoW11CaXRtYXAsIG51bVZjcHVIYXJkQWZmaW5pdHkpCi0JZm9yIGksIHYgOj0gcmFu
Z2UgY1ZjcHVIYXJkQWZmaW5pdHkgewotCQlpZiBlcnIgOj0geC5WY3B1SGFyZEFmZmluaXR5W2ld
LmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBWY3B1SGFyZEFmZmluaXR5OiAldiIsIGVycikKKwl4LlZjcHVIYXJkQWZmaW5pdHkg
PSBuaWwKKwlpZiBuIDo9IGludCh4Yy5udW1fdmNwdV9oYXJkX2FmZmluaXR5KTsgbiA+IDAgewor
CQljVmNwdUhhcmRBZmZpbml0eSA6PSAoKlsxIDw8IDI4XUMubGlieGxfYml0bWFwKSh1bnNhZmUu
UG9pbnRlcih4Yy52Y3B1X2hhcmRfYWZmaW5pdHkpKVs6bjpuXQorCQl4LlZjcHVIYXJkQWZmaW5p
dHkgPSBtYWtlKFtdQml0bWFwLCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBjVmNwdUhhcmRBZmZp
bml0eSB7CisJCQlpZiBlcnIgOj0geC5WY3B1SGFyZEFmZmluaXR5W2ldLmZyb21DKCZ2KTsgZXJy
ICE9IG5pbCB7CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVmNwdUhh
cmRBZmZpbml0eTogJXYiLCBlcnIpCisJCQl9CiAJCX0KIAl9Ci0JbnVtVmNwdVNvZnRBZmZpbml0
eSA6PSBpbnQoeGMubnVtX3ZjcHVfc29mdF9hZmZpbml0eSkKLQljVmNwdVNvZnRBZmZpbml0eSA6
PSAoKlsxIDw8IDI4XUMubGlieGxfYml0bWFwKSh1bnNhZmUuUG9pbnRlcih4Yy52Y3B1X3NvZnRf
YWZmaW5pdHkpKVs6bnVtVmNwdVNvZnRBZmZpbml0eTpudW1WY3B1U29mdEFmZmluaXR5XQotCXgu
VmNwdVNvZnRBZmZpbml0eSA9IG1ha2UoW11CaXRtYXAsIG51bVZjcHVTb2Z0QWZmaW5pdHkpCi0J
Zm9yIGksIHYgOj0gcmFuZ2UgY1ZjcHVTb2Z0QWZmaW5pdHkgewotCQlpZiBlcnIgOj0geC5WY3B1
U29mdEFmZmluaXR5W2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZm10LkVy
cm9yZigiY29udmVydGluZyBmaWVsZCBWY3B1U29mdEFmZmluaXR5OiAldiIsIGVycikKKwl4LlZj
cHVTb2Z0QWZmaW5pdHkgPSBuaWwKKwlpZiBuIDo9IGludCh4Yy5udW1fdmNwdV9zb2Z0X2FmZmlu
aXR5KTsgbiA+IDAgeworCQljVmNwdVNvZnRBZmZpbml0eSA6PSAoKlsxIDw8IDI4XUMubGlieGxf
Yml0bWFwKSh1bnNhZmUuUG9pbnRlcih4Yy52Y3B1X3NvZnRfYWZmaW5pdHkpKVs6bjpuXQorCQl4
LlZjcHVTb2Z0QWZmaW5pdHkgPSBtYWtlKFtdQml0bWFwLCBuKQorCQlmb3IgaSwgdiA6PSByYW5n
ZSBjVmNwdVNvZnRBZmZpbml0eSB7CisJCQlpZiBlcnIgOj0geC5WY3B1U29mdEFmZmluaXR5W2ld
LmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgVmNwdVNvZnRBZmZpbml0eTogJXYiLCBlcnIpCisJCQl9CiAJCX0KIAl9CiAJaWYg
ZXJyIDo9IHguTnVtYVBsYWNlbWVudC5mcm9tQygmeGMubnVtYV9wbGFjZW1lbnQpOyBlcnIgIT0g
bmlsIHsKQEAgLTExMzMsMTIgKzExNDEsMTQgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBm
cm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IgewogCQlyZXR1cm4gZm10
LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDcHVpZDogJXYiLCBlcnIpCiAJfQogCXguQmxrZGV2
U3RhcnQgPSBDLkdvU3RyaW5nKHhjLmJsa2Rldl9zdGFydCkKLQludW1WbnVtYU5vZGVzIDo9IGlu
dCh4Yy5udW1fdm51bWFfbm9kZXMpCi0JY1ZudW1hTm9kZXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhs
X3Zub2RlX2luZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnZudW1hX25vZGVzKSlbOm51bVZudW1hTm9k
ZXM6bnVtVm51bWFOb2Rlc10KLQl4LlZudW1hTm9kZXMgPSBtYWtlKFtdVm5vZGVJbmZvLCBudW1W
bnVtYU5vZGVzKQotCWZvciBpLCB2IDo9IHJhbmdlIGNWbnVtYU5vZGVzIHsKLQkJaWYgZXJyIDo9
IHguVm51bWFOb2Rlc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVm51bWFOb2RlczogJXYiLCBlcnIpCisJeC5WbnVtYU5v
ZGVzID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX3ZudW1hX25vZGVzKTsgbiA+IDAgeworCQlj
Vm51bWFOb2RlcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfdm5vZGVfaW5mbykodW5zYWZlLlBvaW50
ZXIoeGMudm51bWFfbm9kZXMpKVs6bjpuXQorCQl4LlZudW1hTm9kZXMgPSBtYWtlKFtdVm5vZGVJ
bmZvLCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBjVm51bWFOb2RlcyB7CisJCQlpZiBlcnIgOj0g
eC5WbnVtYU5vZGVzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVm51bWFOb2RlczogJXYiLCBlcnIpCisJCQl9CiAJCX0K
IAl9CiAJeC5NYXhHcmFudEZyYW1lcyA9IHVpbnQzMih4Yy5tYXhfZ3JhbnRfZnJhbWVzKQpAQCAt
MTE2MywyNiArMTE3MywzMiBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpD
LmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9IHguU2NoZWRQYXJh
bXMuZnJvbUMoJnhjLnNjaGVkX3BhcmFtcyk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZm10LkVy
cm9yZigiY29udmVydGluZyBmaWVsZCBTY2hlZFBhcmFtczogJXYiLCBlcnIpCiAJfQotCW51bUlv
cG9ydHMgOj0gaW50KHhjLm51bV9pb3BvcnRzKQotCWNJb3BvcnRzIDo9ICgqWzEgPDwgMjhdQy5s
aWJ4bF9pb3BvcnRfcmFuZ2UpKHVuc2FmZS5Qb2ludGVyKHhjLmlvcG9ydHMpKVs6bnVtSW9wb3J0
czpudW1Jb3BvcnRzXQotCXguSW9wb3J0cyA9IG1ha2UoW11Jb3BvcnRSYW5nZSwgbnVtSW9wb3J0
cykKLQlmb3IgaSwgdiA6PSByYW5nZSBjSW9wb3J0cyB7Ci0JCWlmIGVyciA6PSB4LklvcG9ydHNb
aV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0
aW5nIGZpZWxkIElvcG9ydHM6ICV2IiwgZXJyKQorCXguSW9wb3J0cyA9IG5pbAorCWlmIG4gOj0g
aW50KHhjLm51bV9pb3BvcnRzKTsgbiA+IDAgeworCQljSW9wb3J0cyA6PSAoKlsxIDw8IDI4XUMu
bGlieGxfaW9wb3J0X3JhbmdlKSh1bnNhZmUuUG9pbnRlcih4Yy5pb3BvcnRzKSlbOm46bl0KKwkJ
eC5Jb3BvcnRzID0gbWFrZShbXUlvcG9ydFJhbmdlLCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBj
SW9wb3J0cyB7CisJCQlpZiBlcnIgOj0geC5Jb3BvcnRzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5p
bCB7CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgSW9wb3J0czogJXYi
LCBlcnIpCisJCQl9CiAJCX0KIAl9Ci0JbnVtSXJxcyA6PSBpbnQoeGMubnVtX2lycXMpCi0JY0ly
cXMgOj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4Yy5pcnFzKSlbOm51
bUlycXM6bnVtSXJxc10KLQl4LklycXMgPSBtYWtlKFtddWludDMyLCBudW1JcnFzKQotCWZvciBp
LCB2IDo9IHJhbmdlIGNJcnFzIHsKLQkJeC5JcnFzW2ldID0gdWludDMyKHYpCisJeC5JcnFzID0g
bmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX2lycXMpOyBuID4gMCB7CisJCWNJcnFzIDo9ICgqWzEg
PDwgMjhdQy51aW50MzJfdCkodW5zYWZlLlBvaW50ZXIoeGMuaXJxcykpWzpuOm5dCisJCXguSXJx
cyA9IG1ha2UoW111aW50MzIsIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNJcnFzIHsKKwkJCXgu
SXJxc1tpXSA9IHVpbnQzMih2KQorCQl9CiAJfQotCW51bUlvbWVtIDo9IGludCh4Yy5udW1faW9t
ZW0pCi0JY0lvbWVtIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9pb21lbV9yYW5nZSkodW5zYWZlLlBv
aW50ZXIoeGMuaW9tZW0pKVs6bnVtSW9tZW06bnVtSW9tZW1dCi0JeC5Jb21lbSA9IG1ha2UoW11J
b21lbVJhbmdlLCBudW1Jb21lbSkKLQlmb3IgaSwgdiA6PSByYW5nZSBjSW9tZW0gewotCQlpZiBl
cnIgOj0geC5Jb21lbVtpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgSW9tZW06ICV2IiwgZXJyKQorCXguSW9tZW0gPSBuaWwK
KwlpZiBuIDo9IGludCh4Yy5udW1faW9tZW0pOyBuID4gMCB7CisJCWNJb21lbSA6PSAoKlsxIDw8
IDI4XUMubGlieGxfaW9tZW1fcmFuZ2UpKHVuc2FmZS5Qb2ludGVyKHhjLmlvbWVtKSlbOm46bl0K
KwkJeC5Jb21lbSA9IG1ha2UoW11Jb21lbVJhbmdlLCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBj
SW9tZW0geworCQkJaWYgZXJyIDo9IHguSW9tZW1baV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsK
KwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBJb21lbTogJXYiLCBlcnIp
CisJCQl9CiAJCX0KIAl9CiAJaWYgZXJyIDo9IHguQ2xhaW1Nb2RlLmZyb21DKCZ4Yy5jbGFpbV9t
b2RlKTsgZXJyICE9IG5pbCB7CkBAIC0yNzkxLDEyICsyODA3LDE0IEBAIGZ1bmMgKHggKkRldmlj
ZVZkaXNwbCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZkaXNwbCkgZXJyb3IgewogCXguQmFj
a2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKIAl4LkRldmlkID0g
RGV2aWQoeGMuZGV2aWQpCiAJeC5CZUFsbG9jID0gYm9vbCh4Yy5iZV9hbGxvYykKLQludW1Db25u
ZWN0b3JzIDo9IGludCh4Yy5udW1fY29ubmVjdG9ycykKLQljQ29ubmVjdG9ycyA6PSAoKlsxIDw8
IDI4XUMubGlieGxfY29ubmVjdG9yX3BhcmFtKSh1bnNhZmUuUG9pbnRlcih4Yy5jb25uZWN0b3Jz
KSlbOm51bUNvbm5lY3RvcnM6bnVtQ29ubmVjdG9yc10KLQl4LkNvbm5lY3RvcnMgPSBtYWtlKFtd
Q29ubmVjdG9yUGFyYW0sIG51bUNvbm5lY3RvcnMpCi0JZm9yIGksIHYgOj0gcmFuZ2UgY0Nvbm5l
Y3RvcnMgewotCQlpZiBlcnIgOj0geC5Db25uZWN0b3JzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5p
bCB7Ci0JCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDb25uZWN0b3JzOiAl
diIsIGVycikKKwl4LkNvbm5lY3RvcnMgPSBuaWwKKwlpZiBuIDo9IGludCh4Yy5udW1fY29ubmVj
dG9ycyk7IG4gPiAwIHsKKwkJY0Nvbm5lY3RvcnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2Nvbm5l
Y3Rvcl9wYXJhbSkodW5zYWZlLlBvaW50ZXIoeGMuY29ubmVjdG9ycykpWzpuOm5dCisJCXguQ29u
bmVjdG9ycyA9IG1ha2UoW11Db25uZWN0b3JQYXJhbSwgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2Ug
Y0Nvbm5lY3RvcnMgeworCQkJaWYgZXJyIDo9IHguQ29ubmVjdG9yc1tpXS5mcm9tQygmdik7IGVy
ciAhPSBuaWwgeworCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENvbm5l
Y3RvcnM6ICV2IiwgZXJyKQorCQkJfQogCQl9CiAJfQogCkBAIC0yODQ4LDE3ICsyODY2LDIxIEBA
IGZ1bmMgTmV3VnNuZFBhcmFtcygpICgqVnNuZFBhcmFtcywgZXJyb3IpIHsKIH0KIAogZnVuYyAo
eCAqVnNuZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wYXJhbXMpIGVycm9yIHsKLQlu
dW1TYW1wbGVSYXRlcyA6PSBpbnQoeGMubnVtX3NhbXBsZV9yYXRlcykKLQljU2FtcGxlUmF0ZXMg
Oj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4Yy5zYW1wbGVfcmF0ZXMp
KVs6bnVtU2FtcGxlUmF0ZXM6bnVtU2FtcGxlUmF0ZXNdCi0JeC5TYW1wbGVSYXRlcyA9IG1ha2Uo
W111aW50MzIsIG51bVNhbXBsZVJhdGVzKQotCWZvciBpLCB2IDo9IHJhbmdlIGNTYW1wbGVSYXRl
cyB7Ci0JCXguU2FtcGxlUmF0ZXNbaV0gPSB1aW50MzIodikKLQl9Ci0JbnVtU2FtcGxlRm9ybWF0
cyA6PSBpbnQoeGMubnVtX3NhbXBsZV9mb3JtYXRzKQotCWNTYW1wbGVGb3JtYXRzIDo9ICgqWzEg
PDwgMjhdQy5saWJ4bF92c25kX3BjbV9mb3JtYXQpKHVuc2FmZS5Qb2ludGVyKHhjLnNhbXBsZV9m
b3JtYXRzKSlbOm51bVNhbXBsZUZvcm1hdHM6bnVtU2FtcGxlRm9ybWF0c10KLQl4LlNhbXBsZUZv
cm1hdHMgPSBtYWtlKFtdVnNuZFBjbUZvcm1hdCwgbnVtU2FtcGxlRm9ybWF0cykKLQlmb3IgaSwg
diA6PSByYW5nZSBjU2FtcGxlRm9ybWF0cyB7Ci0JCXguU2FtcGxlRm9ybWF0c1tpXSA9IFZzbmRQ
Y21Gb3JtYXQodikKKwl4LlNhbXBsZVJhdGVzID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX3Nh
bXBsZV9yYXRlcyk7IG4gPiAwIHsKKwkJY1NhbXBsZVJhdGVzIDo9ICgqWzEgPDwgMjhdQy51aW50
MzJfdCkodW5zYWZlLlBvaW50ZXIoeGMuc2FtcGxlX3JhdGVzKSlbOm46bl0KKwkJeC5TYW1wbGVS
YXRlcyA9IG1ha2UoW111aW50MzIsIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNTYW1wbGVSYXRl
cyB7CisJCQl4LlNhbXBsZVJhdGVzW2ldID0gdWludDMyKHYpCisJCX0KKwl9CisJeC5TYW1wbGVG
b3JtYXRzID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX3NhbXBsZV9mb3JtYXRzKTsgbiA+IDAg
eworCQljU2FtcGxlRm9ybWF0cyA6PSAoKlsxIDw8IDI4XUMubGlieGxfdnNuZF9wY21fZm9ybWF0
KSh1bnNhZmUuUG9pbnRlcih4Yy5zYW1wbGVfZm9ybWF0cykpWzpuOm5dCisJCXguU2FtcGxlRm9y
bWF0cyA9IG1ha2UoW11Wc25kUGNtRm9ybWF0LCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBjU2Ft
cGxlRm9ybWF0cyB7CisJCQl4LlNhbXBsZUZvcm1hdHNbaV0gPSBWc25kUGNtRm9ybWF0KHYpCisJ
CX0KIAl9CiAJeC5DaGFubmVsc01pbiA9IHVpbnQzMih4Yy5jaGFubmVsc19taW4pCiAJeC5DaGFu
bmVsc01heCA9IHVpbnQzMih4Yy5jaGFubmVsc19tYXgpCkBAIC0yOTY0LDEyICsyOTg2LDE0IEBA
IGZ1bmMgKHggKlZzbmRQY20pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSBlcnJvciB7CiAJ
aWYgZXJyIDo9IHguUGFyYW1zLmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsKIAkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUGFyYW1zOiAldiIsIGVycikKIAl9Ci0J
bnVtVnNuZFN0cmVhbXMgOj0gaW50KHhjLm51bV92c25kX3N0cmVhbXMpCi0JY1N0cmVhbXMgOj0g
KCpbMSA8PCAyOF1DLmxpYnhsX3ZzbmRfc3RyZWFtKSh1bnNhZmUuUG9pbnRlcih4Yy5zdHJlYW1z
KSlbOm51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJlYW1zXQotCXguU3RyZWFtcyA9IG1ha2UoW11W
c25kU3RyZWFtLCBudW1Wc25kU3RyZWFtcykKLQlmb3IgaSwgdiA6PSByYW5nZSBjU3RyZWFtcyB7
Ci0JCWlmIGVyciA6PSB4LlN0cmVhbXNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFN0cmVhbXM6ICV2IiwgZXJyKQorCXgu
U3RyZWFtcyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV92c25kX3N0cmVhbXMpOyBuID4gMCB7
CisJCWNTdHJlYW1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF92c25kX3N0cmVhbSkodW5zYWZlLlBv
aW50ZXIoeGMuc3RyZWFtcykpWzpuOm5dCisJCXguU3RyZWFtcyA9IG1ha2UoW11Wc25kU3RyZWFt
LCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBjU3RyZWFtcyB7CisJCQlpZiBlcnIgOj0geC5TdHJl
YW1zW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgU3RyZWFtczogJXYiLCBlcnIpCisJCQl9CiAJCX0KIAl9CiAKQEAgLTMw
MjksMTIgKzMwNTMsMTQgQEAgZnVuYyAoeCAqRGV2aWNlVnNuZCkgZnJvbUMoeGMgKkMubGlieGxf
ZGV2aWNlX3ZzbmQpIGVycm9yIHsKIAlpZiBlcnIgOj0geC5QYXJhbXMuZnJvbUMoJnhjLnBhcmFt
cyk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQ
YXJhbXM6ICV2IiwgZXJyKQogCX0KLQludW1Wc25kUGNtcyA6PSBpbnQoeGMubnVtX3ZzbmRfcGNt
cykKLQljUGNtcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfdnNuZF9wY20pKHVuc2FmZS5Qb2ludGVy
KHhjLnBjbXMpKVs6bnVtVnNuZFBjbXM6bnVtVnNuZFBjbXNdCi0JeC5QY21zID0gbWFrZShbXVZz
bmRQY20sIG51bVZzbmRQY21zKQotCWZvciBpLCB2IDo9IHJhbmdlIGNQY21zIHsKLQkJaWYgZXJy
IDo9IHguUGNtc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJv
cmYoImNvbnZlcnRpbmcgZmllbGQgUGNtczogJXYiLCBlcnIpCisJeC5QY21zID0gbmlsCisJaWYg
biA6PSBpbnQoeGMubnVtX3ZzbmRfcGNtcyk7IG4gPiAwIHsKKwkJY1BjbXMgOj0gKCpbMSA8PCAy
OF1DLmxpYnhsX3ZzbmRfcGNtKSh1bnNhZmUuUG9pbnRlcih4Yy5wY21zKSlbOm46bl0KKwkJeC5Q
Y21zID0gbWFrZShbXVZzbmRQY20sIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNQY21zIHsKKwkJ
CWlmIGVyciA6PSB4LlBjbXNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQY21zOiAldiIsIGVycikKKwkJCX0KIAkJfQog
CX0KIApAQCAtMzEwMCwxMjQgKzMxMjYsMTU0IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJv
bUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCWlmIGVyciA6PSB4LkJJbmZv
LmZyb21DKCZ4Yy5iX2luZm8pOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgQkluZm86ICV2IiwgZXJyKQogCX0KLQludW1EaXNrcyA6PSBpbnQoeGMu
bnVtX2Rpc2tzKQotCWNEaXNrcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX2Rpc2spKHVu
c2FmZS5Qb2ludGVyKHhjLmRpc2tzKSlbOm51bURpc2tzOm51bURpc2tzXQotCXguRGlza3MgPSBt
YWtlKFtdRGV2aWNlRGlzaywgbnVtRGlza3MpCi0JZm9yIGksIHYgOj0gcmFuZ2UgY0Rpc2tzIHsK
LQkJaWYgZXJyIDo9IHguRGlza3NbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIERpc2tzOiAldiIsIGVycikKKwl4LkRpc2tz
ID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX2Rpc2tzKTsgbiA+IDAgeworCQljRGlza3MgOj0g
KCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV9kaXNrKSh1bnNhZmUuUG9pbnRlcih4Yy5kaXNrcykp
WzpuOm5dCisJCXguRGlza3MgPSBtYWtlKFtdRGV2aWNlRGlzaywgbikKKwkJZm9yIGksIHYgOj0g
cmFuZ2UgY0Rpc2tzIHsKKwkJCWlmIGVyciA6PSB4LkRpc2tzW2ldLmZyb21DKCZ2KTsgZXJyICE9
IG5pbCB7CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRGlza3M6ICV2
IiwgZXJyKQorCQkJfQogCQl9CiAJfQotCW51bU5pY3MgOj0gaW50KHhjLm51bV9uaWNzKQotCWNO
aWNzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfbmljKSh1bnNhZmUuUG9pbnRlcih4Yy5u
aWNzKSlbOm51bU5pY3M6bnVtTmljc10KLQl4Lk5pY3MgPSBtYWtlKFtdRGV2aWNlTmljLCBudW1O
aWNzKQotCWZvciBpLCB2IDo9IHJhbmdlIGNOaWNzIHsKLQkJaWYgZXJyIDo9IHguTmljc1tpXS5m
cm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgTmljczogJXYiLCBlcnIpCisJeC5OaWNzID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVt
X25pY3MpOyBuID4gMCB7CisJCWNOaWNzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2Vfbmlj
KSh1bnNhZmUuUG9pbnRlcih4Yy5uaWNzKSlbOm46bl0KKwkJeC5OaWNzID0gbWFrZShbXURldmlj
ZU5pYywgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2UgY05pY3MgeworCQkJaWYgZXJyIDo9IHguTmlj
c1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252
ZXJ0aW5nIGZpZWxkIE5pY3M6ICV2IiwgZXJyKQorCQkJfQogCQl9CiAJfQotCW51bVBjaWRldnMg
Oj0gaW50KHhjLm51bV9wY2lkZXZzKQotCWNQY2lkZXZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9k
ZXZpY2VfcGNpKSh1bnNhZmUuUG9pbnRlcih4Yy5wY2lkZXZzKSlbOm51bVBjaWRldnM6bnVtUGNp
ZGV2c10KLQl4LlBjaWRldnMgPSBtYWtlKFtdRGV2aWNlUGNpLCBudW1QY2lkZXZzKQotCWZvciBp
LCB2IDo9IHJhbmdlIGNQY2lkZXZzIHsKLQkJaWYgZXJyIDo9IHguUGNpZGV2c1tpXS5mcm9tQygm
dik7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQg
UGNpZGV2czogJXYiLCBlcnIpCisJeC5QY2lkZXZzID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVt
X3BjaWRldnMpOyBuID4gMCB7CisJCWNQY2lkZXZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZp
Y2VfcGNpKSh1bnNhZmUuUG9pbnRlcih4Yy5wY2lkZXZzKSlbOm46bl0KKwkJeC5QY2lkZXZzID0g
bWFrZShbXURldmljZVBjaSwgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2UgY1BjaWRldnMgeworCQkJ
aWYgZXJyIDo9IHguUGNpZGV2c1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFBjaWRldnM6ICV2IiwgZXJyKQorCQkJfQog
CQl9CiAJfQotCW51bVJkbXMgOj0gaW50KHhjLm51bV9yZG1zKQotCWNSZG1zIDo9ICgqWzEgPDwg
MjhdQy5saWJ4bF9kZXZpY2VfcmRtKSh1bnNhZmUuUG9pbnRlcih4Yy5yZG1zKSlbOm51bVJkbXM6
bnVtUmRtc10KLQl4LlJkbXMgPSBtYWtlKFtdRGV2aWNlUmRtLCBudW1SZG1zKQotCWZvciBpLCB2
IDo9IHJhbmdlIGNSZG1zIHsKLQkJaWYgZXJyIDo9IHguUmRtc1tpXS5mcm9tQygmdik7IGVyciAh
PSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUmRtczogJXYi
LCBlcnIpCisJeC5SZG1zID0gbmlsCisJaWYgbiA6PSBpbnQoeGMubnVtX3JkbXMpOyBuID4gMCB7
CisJCWNSZG1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfcmRtKSh1bnNhZmUuUG9pbnRl
cih4Yy5yZG1zKSlbOm46bl0KKwkJeC5SZG1zID0gbWFrZShbXURldmljZVJkbSwgbikKKwkJZm9y
IGksIHYgOj0gcmFuZ2UgY1JkbXMgeworCQkJaWYgZXJyIDo9IHguUmRtc1tpXS5mcm9tQygmdik7
IGVyciAhPSBuaWwgeworCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFJk
bXM6ICV2IiwgZXJyKQorCQkJfQogCQl9CiAJfQotCW51bUR0ZGV2cyA6PSBpbnQoeGMubnVtX2R0
ZGV2cykKLQljRHRkZXZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfZHRkZXYpKHVuc2Fm
ZS5Qb2ludGVyKHhjLmR0ZGV2cykpWzpudW1EdGRldnM6bnVtRHRkZXZzXQotCXguRHRkZXZzID0g
bWFrZShbXURldmljZUR0ZGV2LCBudW1EdGRldnMpCi0JZm9yIGksIHYgOj0gcmFuZ2UgY0R0ZGV2
cyB7Ci0JCWlmIGVyciA6PSB4LkR0ZGV2c1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRHRkZXZzOiAldiIsIGVycikKKwl4
LkR0ZGV2cyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV9kdGRldnMpOyBuID4gMCB7CisJCWNE
dGRldnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV9kdGRldikodW5zYWZlLlBvaW50ZXIo
eGMuZHRkZXZzKSlbOm46bl0KKwkJeC5EdGRldnMgPSBtYWtlKFtdRGV2aWNlRHRkZXYsIG4pCisJ
CWZvciBpLCB2IDo9IHJhbmdlIGNEdGRldnMgeworCQkJaWYgZXJyIDo9IHguRHRkZXZzW2ldLmZy
b21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgRHRkZXZzOiAldiIsIGVycikKKwkJCX0KIAkJfQogCX0KLQludW1WZmJzIDo9IGludCh4
Yy5udW1fdmZicykKLQljVmZicyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3ZmYikodW5z
YWZlLlBvaW50ZXIoeGMudmZicykpWzpudW1WZmJzOm51bVZmYnNdCi0JeC5WZmJzID0gbWFrZShb
XURldmljZVZmYiwgbnVtVmZicykKLQlmb3IgaSwgdiA6PSByYW5nZSBjVmZicyB7Ci0JCWlmIGVy
ciA6PSB4LlZmYnNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJy
b3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZmYnM6ICV2IiwgZXJyKQorCXguVmZicyA9IG5pbAorCWlm
IG4gOj0gaW50KHhjLm51bV92ZmJzKTsgbiA+IDAgeworCQljVmZicyA6PSAoKlsxIDw8IDI4XUMu
bGlieGxfZGV2aWNlX3ZmYikodW5zYWZlLlBvaW50ZXIoeGMudmZicykpWzpuOm5dCisJCXguVmZi
cyA9IG1ha2UoW11EZXZpY2VWZmIsIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNWZmJzIHsKKwkJ
CWlmIGVyciA6PSB4LlZmYnNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBWZmJzOiAldiIsIGVycikKKwkJCX0KIAkJfQog
CX0KLQludW1Wa2JzIDo9IGludCh4Yy5udW1fdmticykKLQljVmticyA6PSAoKlsxIDw8IDI4XUMu
bGlieGxfZGV2aWNlX3ZrYikodW5zYWZlLlBvaW50ZXIoeGMudmticykpWzpudW1Wa2JzOm51bVZr
YnNdCi0JeC5Wa2JzID0gbWFrZShbXURldmljZVZrYiwgbnVtVmticykKLQlmb3IgaSwgdiA6PSBy
YW5nZSBjVmticyB7Ci0JCWlmIGVyciA6PSB4LlZrYnNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmls
IHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZrYnM6ICV2IiwgZXJy
KQorCXguVmticyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV92a2JzKTsgbiA+IDAgeworCQlj
VmticyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3ZrYikodW5zYWZlLlBvaW50ZXIoeGMu
dmticykpWzpuOm5dCisJCXguVmticyA9IG1ha2UoW11EZXZpY2VWa2IsIG4pCisJCWZvciBpLCB2
IDo9IHJhbmdlIGNWa2JzIHsKKwkJCWlmIGVyciA6PSB4LlZrYnNbaV0uZnJvbUMoJnYpOyBlcnIg
IT0gbmlsIHsKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBWa2JzOiAl
diIsIGVycikKKwkJCX0KIAkJfQogCX0KLQludW1WdHBtcyA6PSBpbnQoeGMubnVtX3Z0cG1zKQot
CWNWdHBtcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3Z0cG0pKHVuc2FmZS5Qb2ludGVy
KHhjLnZ0cG1zKSlbOm51bVZ0cG1zOm51bVZ0cG1zXQotCXguVnRwbXMgPSBtYWtlKFtdRGV2aWNl
VnRwbSwgbnVtVnRwbXMpCi0JZm9yIGksIHYgOj0gcmFuZ2UgY1Z0cG1zIHsKLQkJaWYgZXJyIDo9
IHguVnRwbXNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIFZ0cG1zOiAldiIsIGVycikKKwl4LlZ0cG1zID0gbmlsCisJaWYg
biA6PSBpbnQoeGMubnVtX3Z0cG1zKTsgbiA+IDAgeworCQljVnRwbXMgOj0gKCpbMSA8PCAyOF1D
LmxpYnhsX2RldmljZV92dHBtKSh1bnNhZmUuUG9pbnRlcih4Yy52dHBtcykpWzpuOm5dCisJCXgu
VnRwbXMgPSBtYWtlKFtdRGV2aWNlVnRwbSwgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2UgY1Z0cG1z
IHsKKwkJCWlmIGVyciA6PSB4LlZ0cG1zW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVnRwbXM6ICV2IiwgZXJyKQorCQkJ
fQogCQl9CiAJfQotCW51bVA5UyA6PSBpbnQoeGMubnVtX3A5cykKLQljUDlTIDo9ICgqWzEgPDwg
MjhdQy5saWJ4bF9kZXZpY2VfcDkpKHVuc2FmZS5Qb2ludGVyKHhjLnA5cykpWzpudW1QOVM6bnVt
UDlTXQotCXguUDlTID0gbWFrZShbXURldmljZVA5LCBudW1QOVMpCi0JZm9yIGksIHYgOj0gcmFu
Z2UgY1A5UyB7Ci0JCWlmIGVyciA6PSB4LlA5U1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewot
CQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUDlTOiAldiIsIGVycikKKwl4
LlA5UyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV9wOXMpOyBuID4gMCB7CisJCWNQOVMgOj0g
KCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV9wOSkodW5zYWZlLlBvaW50ZXIoeGMucDlzKSlbOm46
bl0KKwkJeC5QOVMgPSBtYWtlKFtdRGV2aWNlUDksIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNQ
OVMgeworCQkJaWYgZXJyIDo9IHguUDlTW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUDlTOiAldiIsIGVycikKKwkJCX0K
IAkJfQogCX0KLQludW1QdmNhbGxzaWZzIDo9IGludCh4Yy5udW1fcHZjYWxsc2lmcykKLQljUHZj
YWxsc2lmcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZikodW5zYWZlLlBv
aW50ZXIoeGMucHZjYWxsc2lmcykpWzpudW1QdmNhbGxzaWZzOm51bVB2Y2FsbHNpZnNdCi0JeC5Q
dmNhbGxzaWZzID0gbWFrZShbXURldmljZVB2Y2FsbHNpZiwgbnVtUHZjYWxsc2lmcykKLQlmb3Ig
aSwgdiA6PSByYW5nZSBjUHZjYWxsc2lmcyB7Ci0JCWlmIGVyciA6PSB4LlB2Y2FsbHNpZnNbaV0u
ZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5n
IGZpZWxkIFB2Y2FsbHNpZnM6ICV2IiwgZXJyKQorCXguUHZjYWxsc2lmcyA9IG5pbAorCWlmIG4g
Oj0gaW50KHhjLm51bV9wdmNhbGxzaWZzKTsgbiA+IDAgeworCQljUHZjYWxsc2lmcyA6PSAoKlsx
IDw8IDI4XUMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZikodW5zYWZlLlBvaW50ZXIoeGMucHZjYWxs
c2lmcykpWzpuOm5dCisJCXguUHZjYWxsc2lmcyA9IG1ha2UoW11EZXZpY2VQdmNhbGxzaWYsIG4p
CisJCWZvciBpLCB2IDo9IHJhbmdlIGNQdmNhbGxzaWZzIHsKKwkJCWlmIGVyciA6PSB4LlB2Y2Fs
bHNpZnNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCBQdmNhbGxzaWZzOiAldiIsIGVycikKKwkJCX0KIAkJfQogCX0KLQlu
dW1WZGlzcGxzIDo9IGludCh4Yy5udW1fdmRpc3BscykKLQljVmRpc3BscyA6PSAoKlsxIDw8IDI4
XUMubGlieGxfZGV2aWNlX3ZkaXNwbCkodW5zYWZlLlBvaW50ZXIoeGMudmRpc3BscykpWzpudW1W
ZGlzcGxzOm51bVZkaXNwbHNdCi0JeC5WZGlzcGxzID0gbWFrZShbXURldmljZVZkaXNwbCwgbnVt
VmRpc3BscykKLQlmb3IgaSwgdiA6PSByYW5nZSBjVmRpc3BscyB7Ci0JCWlmIGVyciA6PSB4LlZk
aXNwbHNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIFZkaXNwbHM6ICV2IiwgZXJyKQorCXguVmRpc3BscyA9IG5pbAorCWlm
IG4gOj0gaW50KHhjLm51bV92ZGlzcGxzKTsgbiA+IDAgeworCQljVmRpc3BscyA6PSAoKlsxIDw8
IDI4XUMubGlieGxfZGV2aWNlX3ZkaXNwbCkodW5zYWZlLlBvaW50ZXIoeGMudmRpc3BscykpWzpu
Om5dCisJCXguVmRpc3BscyA9IG1ha2UoW11EZXZpY2VWZGlzcGwsIG4pCisJCWZvciBpLCB2IDo9
IHJhbmdlIGNWZGlzcGxzIHsKKwkJCWlmIGVyciA6PSB4LlZkaXNwbHNbaV0uZnJvbUMoJnYpOyBl
cnIgIT0gbmlsIHsKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBWZGlz
cGxzOiAldiIsIGVycikKKwkJCX0KIAkJfQogCX0KLQludW1Wc25kcyA6PSBpbnQoeGMubnVtX3Zz
bmRzKQotCWNWc25kcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3ZzbmQpKHVuc2FmZS5Q
b2ludGVyKHhjLnZzbmRzKSlbOm51bVZzbmRzOm51bVZzbmRzXQotCXguVnNuZHMgPSBtYWtlKFtd
RGV2aWNlVnNuZCwgbnVtVnNuZHMpCi0JZm9yIGksIHYgOj0gcmFuZ2UgY1ZzbmRzIHsKLQkJaWYg
ZXJyIDo9IHguVnNuZHNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZzbmRzOiAldiIsIGVycikKKwl4LlZzbmRzID0gbmls
CisJaWYgbiA6PSBpbnQoeGMubnVtX3ZzbmRzKTsgbiA+IDAgeworCQljVnNuZHMgOj0gKCpbMSA8
PCAyOF1DLmxpYnhsX2RldmljZV92c25kKSh1bnNhZmUuUG9pbnRlcih4Yy52c25kcykpWzpuOm5d
CisJCXguVnNuZHMgPSBtYWtlKFtdRGV2aWNlVnNuZCwgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2Ug
Y1ZzbmRzIHsKKwkJCWlmIGVyciA6PSB4LlZzbmRzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7
CisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVnNuZHM6ICV2IiwgZXJy
KQorCQkJfQogCQl9CiAJfQotCW51bUNoYW5uZWxzIDo9IGludCh4Yy5udW1fY2hhbm5lbHMpCi0J
Y0NoYW5uZWxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCkodW5zYWZlLlBv
aW50ZXIoeGMuY2hhbm5lbHMpKVs6bnVtQ2hhbm5lbHM6bnVtQ2hhbm5lbHNdCi0JeC5DaGFubmVs
cyA9IG1ha2UoW11EZXZpY2VDaGFubmVsLCBudW1DaGFubmVscykKLQlmb3IgaSwgdiA6PSByYW5n
ZSBjQ2hhbm5lbHMgewotCQlpZiBlcnIgOj0geC5DaGFubmVsc1tpXS5mcm9tQygmdik7IGVyciAh
PSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ2hhbm5lbHM6
ICV2IiwgZXJyKQorCXguQ2hhbm5lbHMgPSBuaWwKKwlpZiBuIDo9IGludCh4Yy5udW1fY2hhbm5l
bHMpOyBuID4gMCB7CisJCWNDaGFubmVscyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX2No
YW5uZWwpKHVuc2FmZS5Qb2ludGVyKHhjLmNoYW5uZWxzKSlbOm46bl0KKwkJeC5DaGFubmVscyA9
IG1ha2UoW11EZXZpY2VDaGFubmVsLCBuKQorCQlmb3IgaSwgdiA6PSByYW5nZSBjQ2hhbm5lbHMg
eworCQkJaWYgZXJyIDo9IHguQ2hhbm5lbHNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJ
CQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDaGFubmVsczogJXYiLCBlcnIp
CisJCQl9CiAJCX0KIAl9Ci0JbnVtVXNiY3RybHMgOj0gaW50KHhjLm51bV91c2JjdHJscykKLQlj
VXNiY3RybHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV91c2JjdHJsKSh1bnNhZmUuUG9p
bnRlcih4Yy51c2JjdHJscykpWzpudW1Vc2JjdHJsczpudW1Vc2JjdHJsc10KLQl4LlVzYmN0cmxz
ID0gbWFrZShbXURldmljZVVzYmN0cmwsIG51bVVzYmN0cmxzKQotCWZvciBpLCB2IDo9IHJhbmdl
IGNVc2JjdHJscyB7Ci0JCWlmIGVyciA6PSB4LlVzYmN0cmxzW2ldLmZyb21DKCZ2KTsgZXJyICE9
IG5pbCB7Ci0JCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBVc2JjdHJsczog
JXYiLCBlcnIpCisJeC5Vc2JjdHJscyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV91c2JjdHJs
cyk7IG4gPiAwIHsKKwkJY1VzYmN0cmxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdXNi
Y3RybCkodW5zYWZlLlBvaW50ZXIoeGMudXNiY3RybHMpKVs6bjpuXQorCQl4LlVzYmN0cmxzID0g
bWFrZShbXURldmljZVVzYmN0cmwsIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNVc2JjdHJscyB7
CisJCQlpZiBlcnIgOj0geC5Vc2JjdHJsc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFVzYmN0cmxzOiAldiIsIGVycikK
KwkJCX0KIAkJfQogCX0KLQludW1Vc2JkZXZzIDo9IGludCh4Yy5udW1fdXNiZGV2cykKLQljVXNi
ZGV2cyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3VzYmRldikodW5zYWZlLlBvaW50ZXIo
eGMudXNiZGV2cykpWzpudW1Vc2JkZXZzOm51bVVzYmRldnNdCi0JeC5Vc2JkZXZzID0gbWFrZShb
XURldmljZVVzYmRldiwgbnVtVXNiZGV2cykKLQlmb3IgaSwgdiA6PSByYW5nZSBjVXNiZGV2cyB7
Ci0JCWlmIGVyciA6PSB4LlVzYmRldnNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFVzYmRldnM6ICV2IiwgZXJyKQorCXgu
VXNiZGV2cyA9IG5pbAorCWlmIG4gOj0gaW50KHhjLm51bV91c2JkZXZzKTsgbiA+IDAgeworCQlj
VXNiZGV2cyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3VzYmRldikodW5zYWZlLlBvaW50
ZXIoeGMudXNiZGV2cykpWzpuOm5dCisJCXguVXNiZGV2cyA9IG1ha2UoW11EZXZpY2VVc2JkZXYs
IG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNVc2JkZXZzIHsKKwkJCWlmIGVyciA6PSB4LlVzYmRl
dnNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29u
dmVydGluZyBmaWVsZCBVc2JkZXZzOiAldiIsIGVycikKKwkJCX0KIAkJfQogCX0KIAl4Lk9uUG93
ZXJvZmYgPSBBY3Rpb25PblNodXRkb3duKHhjLm9uX3Bvd2Vyb2ZmKQpAQCAtMzgzNywxMiArMzg5
MywxNCBAQCBmdW5jICh4ICpWZGlzcGxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92ZGlzcGxpbmZv
KSBlcnJvciB7CiAJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQogCXguU3RhdGUgPSBpbnQoeGMu
c3RhdGUpCiAJeC5CZUFsbG9jID0gYm9vbCh4Yy5iZV9hbGxvYykKLQludW1Db25uZWN0b3JzIDo9
IGludCh4Yy5udW1fY29ubmVjdG9ycykKLQljQ29ubmVjdG9ycyA6PSAoKlsxIDw8IDI4XUMubGli
eGxfY29ubmVjdG9yaW5mbykodW5zYWZlLlBvaW50ZXIoeGMuY29ubmVjdG9ycykpWzpudW1Db25u
ZWN0b3JzOm51bUNvbm5lY3RvcnNdCi0JeC5Db25uZWN0b3JzID0gbWFrZShbXUNvbm5lY3Rvcmlu
Zm8sIG51bUNvbm5lY3RvcnMpCi0JZm9yIGksIHYgOj0gcmFuZ2UgY0Nvbm5lY3RvcnMgewotCQlp
ZiBlcnIgOj0geC5Db25uZWN0b3JzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDb25uZWN0b3JzOiAldiIsIGVycikKKwl4
LkNvbm5lY3RvcnMgPSBuaWwKKwlpZiBuIDo9IGludCh4Yy5udW1fY29ubmVjdG9ycyk7IG4gPiAw
IHsKKwkJY0Nvbm5lY3RvcnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2Nvbm5lY3RvcmluZm8pKHVu
c2FmZS5Qb2ludGVyKHhjLmNvbm5lY3RvcnMpKVs6bjpuXQorCQl4LkNvbm5lY3RvcnMgPSBtYWtl
KFtdQ29ubmVjdG9yaW5mbywgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2UgY0Nvbm5lY3RvcnMgewor
CQkJaWYgZXJyIDo9IHguQ29ubmVjdG9yc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENvbm5lY3RvcnM6ICV2IiwgZXJy
KQorCQkJfQogCQl9CiAJfQogCkBAIC0zOTM2LDEyICszOTk0LDE0IEBAIGZ1bmMgTmV3UGNtaW5m
bygpICgqUGNtaW5mbywgZXJyb3IpIHsKIH0KIAogZnVuYyAoeCAqUGNtaW5mbykgZnJvbUMoeGMg
KkMubGlieGxfcGNtaW5mbykgZXJyb3IgewotCW51bVZzbmRTdHJlYW1zIDo9IGludCh4Yy5udW1f
dnNuZF9zdHJlYW1zKQotCWNTdHJlYW1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9zdHJlYW1pbmZv
KSh1bnNhZmUuUG9pbnRlcih4Yy5zdHJlYW1zKSlbOm51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJl
YW1zXQotCXguU3RyZWFtcyA9IG1ha2UoW11TdHJlYW1pbmZvLCBudW1Wc25kU3RyZWFtcykKLQlm
b3IgaSwgdiA6PSByYW5nZSBjU3RyZWFtcyB7Ci0JCWlmIGVyciA6PSB4LlN0cmVhbXNbaV0uZnJv
bUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZp
ZWxkIFN0cmVhbXM6ICV2IiwgZXJyKQorCXguU3RyZWFtcyA9IG5pbAorCWlmIG4gOj0gaW50KHhj
Lm51bV92c25kX3N0cmVhbXMpOyBuID4gMCB7CisJCWNTdHJlYW1zIDo9ICgqWzEgPDwgMjhdQy5s
aWJ4bF9zdHJlYW1pbmZvKSh1bnNhZmUuUG9pbnRlcih4Yy5zdHJlYW1zKSlbOm46bl0KKwkJeC5T
dHJlYW1zID0gbWFrZShbXVN0cmVhbWluZm8sIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNTdHJl
YW1zIHsKKwkJCWlmIGVyciA6PSB4LlN0cmVhbXNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsK
KwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBTdHJlYW1zOiAldiIsIGVy
cikKKwkJCX0KIAkJfQogCX0KIApAQCAtMzk5MywxMiArNDA1MywxNCBAQCBmdW5jICh4ICpWc25k
aW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8pIGVycm9yIHsKIAl4LkZyb250ZW5kSWQg
PSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCiAJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQogCXgu
U3RhdGUgPSBpbnQoeGMuc3RhdGUpCi0JbnVtVnNuZFBjbXMgOj0gaW50KHhjLm51bV92c25kX3Bj
bXMpCi0JY1BjbXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3BjbWluZm8pKHVuc2FmZS5Qb2ludGVy
KHhjLnBjbXMpKVs6bnVtVnNuZFBjbXM6bnVtVnNuZFBjbXNdCi0JeC5QY21zID0gbWFrZShbXVBj
bWluZm8sIG51bVZzbmRQY21zKQotCWZvciBpLCB2IDo9IHJhbmdlIGNQY21zIHsKLQkJaWYgZXJy
IDo9IHguUGNtc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJv
cmYoImNvbnZlcnRpbmcgZmllbGQgUGNtczogJXYiLCBlcnIpCisJeC5QY21zID0gbmlsCisJaWYg
biA6PSBpbnQoeGMubnVtX3ZzbmRfcGNtcyk7IG4gPiAwIHsKKwkJY1BjbXMgOj0gKCpbMSA8PCAy
OF1DLmxpYnhsX3BjbWluZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnBjbXMpKVs6bjpuXQorCQl4LlBj
bXMgPSBtYWtlKFtdUGNtaW5mbywgbikKKwkJZm9yIGksIHYgOj0gcmFuZ2UgY1BjbXMgeworCQkJ
aWYgZXJyIDo9IHguUGNtc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJCXJldHVybiBm
bXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFBjbXM6ICV2IiwgZXJyKQorCQkJfQogCQl9CiAJ
fQogCkBAIC00MTA5LDExICs0MTcxLDEzIEBAIGZ1bmMgTmV3TnVtYWluZm8oKSAoKk51bWFpbmZv
LCBlcnJvcikgewogZnVuYyAoeCAqTnVtYWluZm8pIGZyb21DKHhjICpDLmxpYnhsX251bWFpbmZv
KSBlcnJvciB7CiAJeC5TaXplID0gdWludDY0KHhjLnNpemUpCiAJeC5GcmVlID0gdWludDY0KHhj
LmZyZWUpCi0JbnVtRGlzdHMgOj0gaW50KHhjLm51bV9kaXN0cykKLQljRGlzdHMgOj0gKCpbMSA8
PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4Yy5kaXN0cykpWzpudW1EaXN0czpudW1E
aXN0c10KLQl4LkRpc3RzID0gbWFrZShbXXVpbnQzMiwgbnVtRGlzdHMpCi0JZm9yIGksIHYgOj0g
cmFuZ2UgY0Rpc3RzIHsKLQkJeC5EaXN0c1tpXSA9IHVpbnQzMih2KQorCXguRGlzdHMgPSBuaWwK
KwlpZiBuIDo9IGludCh4Yy5udW1fZGlzdHMpOyBuID4gMCB7CisJCWNEaXN0cyA6PSAoKlsxIDw8
IDI4XUMudWludDMyX3QpKHVuc2FmZS5Qb2ludGVyKHhjLmRpc3RzKSlbOm46bl0KKwkJeC5EaXN0
cyA9IG1ha2UoW111aW50MzIsIG4pCisJCWZvciBpLCB2IDo9IHJhbmdlIGNEaXN0cyB7CisJCQl4
LkRpc3RzW2ldID0gdWludDMyKHYpCisJCX0KIAl9CiAKIAlyZXR1cm4gbmlsCi0tIAoyLjI1LjEK
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2
ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xp
c3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

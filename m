Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6375FBEB1B
	for <lists+xen-devel@lfdr.de>; Thu, 26 Sep 2019 06:11:00 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDL2n-0005el-Tv; Thu, 26 Sep 2019 04:06:17 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=lLXC=XV=invisiblethingslab.com=marmarek@srs-us1.protection.inumbo.net>)
 id 1iDL2m-0005eg-AN
 for xen-devel@lists.xenproject.org; Thu, 26 Sep 2019 04:06:16 +0000
X-Inumbo-ID: fbc88046-e012-11e9-9641-12813bfff9fa
Received: from new1-smtp.messagingengine.com (unknown [66.111.4.221])
 by localhost (Halon) with ESMTPS
 id fbc88046-e012-11e9-9641-12813bfff9fa;
 Thu, 26 Sep 2019 04:06:15 +0000 (UTC)
Received: from compute7.internal (compute7.nyi.internal [10.202.2.47])
 by mailnew.nyi.internal (Postfix) with ESMTP id C8FA42CBD;
 Thu, 26 Sep 2019 00:06:14 -0400 (EDT)
Received: from mailfrontend2 ([10.202.2.163])
 by compute7.internal (MEProxy); Thu, 26 Sep 2019 00:06:14 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:in-reply-to:message-id:mime-version:references
 :subject:to:x-me-proxy:x-me-proxy:x-me-sender:x-me-sender
 :x-sasl-enc; s=fm3; bh=UdghN1TsXpBNyHBdZ97o9G2tt2ZjjViWNoaOE4tuB
 0Q=; b=nEykw1h8u5K10fcJrPnsvh+MU5LGVQgVCVoFQeBXWhaygseVr61U6YWWO
 cibEsueWpMxYBOa4eDqkTVc3HkDeEpAlM2qJNls/CknTEVvbKW8/Ay2tMqtxi1K2
 W3qzHrqwODqJP1UJtev47TVcJCfwlh5FLutmETDb8MQXh4lrAHIEVg2/3tHzj1V8
 mBPdT62rZZ4HzB4Pzb2ft8i5Q0Ru/Zhq70K59BDJul9263a3sr7VyOKzH7IylPRL
 xRUQnX6+o6FT5CYXRQi/+qa2mNHx4JjLIMzGy8Vsp9y+Ytp5RlFf5BwdFK4TqBms
 I8AdY2/69u+oYiNT34dDRhdNhK74A==
X-ME-Sender: <xms:NTmMXdOsZTfkcWSqMR0yK6rJnEtGIJNJ_NN985H9v7TLFv1x5lmyQA>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgedufedrfeefgdejkecutefuodetggdotefrodftvf
 curfhrohhfihhlvgemucfhrghsthforghilhdpqfgfvfdpuffrtefokffrpgfnqfghnecu
 uegrihhlohhuthemuceftddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenuc
 fjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeforghrvghk
 ucforghrtgiihihkohifshhkihdqifpkrhgvtghkihcuoehmrghrmhgrrhgvkhesihhnvh
 hishhisghlvghthhhinhhgshhlrggsrdgtohhmqeenucffohhmrghinhepghhithhhuhgs
 rdgtohhmnecukfhppeeluddrieehrdefgedrfeefnecurfgrrhgrmhepmhgrihhlfhhroh
 hmpehmrghrmhgrrhgvkhesihhnvhhishhisghlvghthhhinhhgshhlrggsrdgtohhmnecu
 vehluhhsthgvrhfuihiivgeptd
X-ME-Proxy: <xmx:NTmMXWWmfo4_wzZMU-FOQGxIm_CmVA_lKpw9hd0ZgWI8B9MtC35V8w>
 <xmx:NTmMXYi4d-3QbAGA2BlDLkkkNvcL0WasAr4JoRAm22csHnd56ccypg>
 <xmx:NTmMXXhhkR6S54Lz2qbyJ4Aj9cuKw83uhbI8edupK-X84keS4XYzDw>
 <xmx:NjmMXUuc4WhJ2xRs5T2d89rvYy2THyiJwtcw8UQKgIzfOZuE6hIR-w>
Received: from localhost.localdomain (ip5b412221.dynamic.kabel-deutschland.de
 [91.65.34.33])
 by mail.messagingengine.com (Postfix) with ESMTPA id 52F5BD6005A;
 Thu, 26 Sep 2019 00:06:11 -0400 (EDT)
From: =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Thu, 26 Sep 2019 06:05:52 +0200
Message-Id: <c446916b9572a6425a994e9f8c6c995b8b38c518.1569470669.git-series.marmarek@invisiblethingslab.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <7d011094eed3f5c3cf6971cc8760874fd56ca443.1569379186.git-series.marmarek@invisiblethingslab.com>
References: <7d011094eed3f5c3cf6971cc8760874fd56ca443.1569379186.git-series.marmarek@invisiblethingslab.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v7.1 4/4] xen/x86: Allow stubdom access to irq
 created for msi.
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Tim Deegan <tim@xen.org>,
 Simon Gaiser <simon@invisiblethingslab.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Brian Woods <brian.woods@amd.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U3R1YmRvbWFpbnMgbmVlZCB0byBiZSBnaXZlbiBzdWZmaWNpZW50IHByaXZpbGVnZSBvdmVyIHRo
ZSBndWVzdCB3aGljaCBpdApwcm92aWRlcyBlbXVsYXRpb24gZm9yIGluIG9yZGVyIGZvciBQQ0kg
cGFzc3Rocm91Z2ggdG8gd29yayBjb3JyZWN0bHkuCldoZW4gYSBIVk0gZG9tYWluIHRyeSB0byBl
bmFibGUgTVNJLCBRRU1VIGluIHN0dWJkb21haW4gY2FsbHMKUEhZU0RFVk9QX21hcF9waXJxLCBi
dXQgbGF0ZXIgaXQgbmVlZHMgdG8gY2FsbCBYRU5fRE9NQ1RMX2JpbmRfcHRfaXJxIGFzCnBhcnQg
b2YgeGNfZG9tYWluX3VwZGF0ZV9tc2lfaXJxLiBHaXZlIHRoZSBzdHViZG9tYWluIGVub3VnaCBw
ZXJtaXNzaW9ucwpvdmVyIHRoZSBtYXBwZWQgaW50ZXJydXB0IGluIG9yZGVyIHRvIGJpbmQgaXQg
c3VjY2Vzc2Z1bGx5IHRvIGl0J3MKdGFyZ2V0IGRvbWFpbi4KClRoaXMgaXMgbm90IG5lZWRlZCBm
b3IgUENJIElOVHgsIGJlY2F1c2UgSVJRIGluIHRoYXQgY2FzZSBpcyBrbm93bgpiZWZvcmVoYW5k
IGFuZCB0aGUgc3R1YmRvbWFpbiBpcyBnaXZlbiBwZXJtaXNzaW9ucyBvdmVyIHRoaXMgSVJRIGJ5
CmxpYnhsX19kZXZpY2VfcGNpX2FkZCAodGhlcmUncyBhIGRvX3BjaV9hZGQgYWdhaW5zdCB0aGUg
c3R1YmRvbWFpbikuCgpjcmVhdGVfaXJxKCkgYWxyZWFkeSBncmFudCBJUlEgYWNjZXNzIHRvIGhh
cmR3YXJlX2RvbWFpbiwgd2l0aAphc3N1bXB0aW9uIHRoZSBkZXZpY2UgbW9kZWwgbGl2ZXMgdGhl
cmUuCk1vZGlmeSBjcmVhdGVfaXJxKCkgdG8gdGFrZSBhZGRpdGlvbmFsIHBhcmFtZXRlciwgd2hl
dGhlciB0byBncmFudApwZXJtaXNzaW9ucyB0byB0aGUgZG9tYWluIGNyZWF0aW5nIHRoZSBJUlEs
IHdoaWNoIG1heSBiZSBkb20wIG9yIGEKc3R1YmRvbWFpbi4gRG8gdGhpcyBpbnN0ZWFkIG9mIGdy
YW50aW5nIGFjY2VzcyBhbHdheXMgdG8KaGFyZHdhcmVfZG9tYWluLiBTYXZlIElEIG9mIHRoZSBk
b21haW4gZ2l2ZW4gcGVybWlzc2lvbiwgdG8gcmV2b2tlIGl0IGluCmRlc3Ryb3lfaXJxKCkgLSBl
YXNpZXIgYW5kIGNsZWFuZXIgdGhhbiByZXBsYXlpbmcgbG9naWMgb2YgY3JlYXRlX2lycSgpCnBh
cmFtZXRlci4gVXNlIGRvbWlkIGluc3RlYWQgb2YgYWN0dWFsIHJlZmVyZW5jZSB0byB0aGUgZG9t
YWluLApiZWNhdXNlIGl0IG1pZ2h0IGdldCBkZXN0cm95ZWQgYmVmb3JlIGRlc3Ryb3lpbmcgSVJR
IChzdHViZG9tYWluIGlzCmRlc3Ryb3llZCBiZWZvcmUgaXRzIHRhcmdldCBkb21haW4pLiBBbmQg
aXQgaXMgbm90IGFuIGlzc3VlLApiZWNhdXNlIElSUSBwZXJtaXNzaW9ucyBsaXZlIHdpdGhpbiBk
b21haW4gc3RydWN0dXJlLCBzbyBkZXN0cm95aW5nCmEgZG9tYWluIGFsc28gaW1wbGljaXRseSBy
ZXZva2UgdGhlIHBlcm1pc3Npb24uICBQb3RlbnRpYWwgZG9taWQKcmV1c2UgaXMgZGV0ZWN0ZWQg
YnkgY2hlY2tpbmcgaWYgdGhhdCBkb21haW4gZG9lcyBoYXZlIHBlcm1pc3Npb24Kb3ZlciB0aGUg
SVJRIGJlaW5nIGRlc3Ryb3llZC4KClRoZW4sIGFkanVzdCBhbGwgY2FsbGVycyB0byBwcm92aWRl
IHRoZSBwYXJhbWV0ZXIuIEluIGNhc2Ugb2YgWGVuCmludGVybmFsIGFsbG9jYXRpb25zLCBzZXQg
aXQgdG8gZmFsc2UsIGJ1dCBmb3IgZG9tYWluIGFjY2Vzc2libGUKaW50ZXJydXB0IHNldCBpdCB0
byB0cnVlLgoKSW5zcGlyZWQgYnkgaHR0cHM6Ly9naXRodWIuY29tL09wZW5YVC94ZW5jbGllbnQt
b2UvYmxvYi81ZTBlNzMwNGE1YTNjNzVlZjAxMjQwYTFlMzY3MzY2NWIyYWFmMDVlL3JlY2lwZXMt
ZXh0ZW5kZWQveGVuL2ZpbGVzL3N0dWJkb21haW4tbXNpLWlycS1hY2Nlc3MucGF0Y2ggYnkgRXJp
YyBDaGFudWRldCA8Y2hhbnVkZXRlQGFpbmZvc2VjLmNvbT4uCgpTaWduZWQtb2ZmLWJ5OiBTaW1v
biBHYWlzZXIgPHNpbW9uQGludmlzaWJsZXRoaW5nc2xhYi5jb20+ClNpZ25lZC1vZmYtYnk6IE1h
cmVrIE1hcmN6eWtvd3NraS1Hw7NyZWNraSA8bWFybWFyZWtAaW52aXNpYmxldGhpbmdzbGFiLmNv
bT4KUmV2aWV3ZWQtYnk6IFJvZ2VyIFBhdSBNb25uw6kgPHJvZ2VyLnBhdUBjaXRyaXguY29tPgot
LS0KQ2hhbmdlcyBpbiB2MzoKIC0gZXh0ZW5kIGNvbW1pdCBtZXNzYWdlCkNoYW5nZXMgaW4gdjQ6
CiAtIGFkZCBtaXNzaW5nIGRlc3Ryb3lfaXJxIG9uIGVycm9yIHBhdGgKQ2hhbmdlcyBpbiB2NToK
IC0gbW92ZSBpcnFfe2dyYW50LHJldm9rZX1fYWNjZXNzKCkgdG8ge2NyZWF0ZSxkZXN0cm95fV9p
cnEoKSwgd2hpY2gKICAgYmFzaWNhbGx5IG1ha2UgaXQgYSBkaWZmZXJlbnQgcGF0Y2gKIC0gYWRk
IGdldF9kbV9kb21haW4oKSBoZWxwZXIKIC0gZG8gbm90IGdpdmUgaGFyZHdhcmVfZG9tYWluIHBl
cm1pc3Npb24gb3ZlciBJUlFzIHVzZWQgaW4gWGVuCiAgIGludGVybmFsbHkKIC0gcmVuYW1lIGNy
ZWF0ZV9pcnEgYXJndW1lbnQgdG8ganVzdCAnZCcsIHRvIGF2b2lkIGNvbmZ1c2lvbgogICB3aGVu
IGl0J3MgY2FsbGVkIGJ5IGhhcmR3YXJlIGRvbWFpbgogLSB2ZXJpZnkgdGhhdCBkZXZpY2UgaXMg
ZGUtYXNzaWduZWQgYmVmb3JlIHBjaV9yZW1vdmVfZGV2aWNlIGNhbGwKIC0gc2F2ZSBJRCBvZiBk
b21haW4gZ2l2ZW4gcGVybWlzc2lvbiBpbiBjcmVhdGVfaXJxKCksIHRvIHJldm9rZSBpdCBpbgog
ZGVzdHJveV9pcnEoKQogLSBkcm9wIGRvbWFpbiBwYXJhbWV0ZXIgZnJvbSBkZXN0cm95X2lycSgp
IGFuZCBtc2lfZnJlZV9pcnEoKQogLSBkbyBub3QgZ2l2ZSBoYXJkd2FyZSBkb21haW4gcGVybWlz
c2lvbiBvdmVyIElSUSBjcmVhdGVkIGluCiBpb21tdV9zZXRfaW50ZXJydXB0KCkKQ2hhbmdlcyBp
biB2NjoKIC0gZG8gbm90IGdpdmUgcGVybWlzc2lvbiBvdmVyIGhwZXQgaXJxIHRvIGhhcmR3YXJl
X2RvbWFpbgogLSBtb3ZlIGNyZWF0b3JfZG9taWQgdG8gYXJjaF9pcnFfZGVzYwogLSBmaXggY3Jl
YXRvcl9kb21pZCBpbml0aWFsaXphdGlvbgogLSBhbHdheXMgZ2l2ZSBjdXJyZW50LT5kb21haW4g
cGVybWlzc2lvbiBpbnN0ZWFkIG9mIHVzaW5nCiBnZXRfZG1fZG9tYWluKCkgaGVscGVyLiBBbmFs
eXNpcyBvZiBhbGwgaXRzIHVzZSBjYXNlcyB0ZWxscyB0aGF0IGl0IGlzCiB0aGUgb25seSB2YWx1
ZSBpdCByZXR1cm5zLgogLSBkcm9wIHVucmVsYXRlZCBjaGFuZ2UKQ2hhbmdlcyBpbiB2NzoKIC0g
Q29kZSBzdHlsZSBpbXByb3ZlbWVudHMgKHNwYWNlcywgdXNlICVwZCBldGMpCiAtIHVzZSBib29s
IHBhcmFtZXRlciB0byBjcmVhdGVfaXJxLCBhcyBpdCdzIG9ubHkgZ2V0dGluZwogY3VycmVudC0+
ZG9tYWluIG9yIE5VTEwKIC0gcmVtb3ZlIHJlZHVuZGFudCBpcnFfYWNjZXNzX3Blcm1pdHRlZCgp
CkNoYW5nZXMgaW4gdjcuMToKIC0gYWRqdXN0IGNvbW1lbnRzLCBtZXJnZSBpZgogLSB1cGRhdGUg
Y29tbWl0IG1lc3NhZ2UKLS0tCiB4ZW4vYXJjaC94ODYvaHBldC5jICAgICAgICAgICAgICAgICAg
ICAgIHwgIDMgKy0KIHhlbi9hcmNoL3g4Ni9pcnEuYyAgICAgICAgICAgICAgICAgICAgICAgfCA0
MiArKysrKysrKysrKysrKysrKy0tLS0tLS0tCiB4ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYyAg
ICAgICAgICAgICAgIHwgIDIgKy0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9p
bml0LmMgfCAgMiArLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMgICAgICB8
ICAzICstCiB4ZW4vaW5jbHVkZS9hc20teDg2L2lycS5oICAgICAgICAgICAgICAgIHwgMTEgKysr
KysrLQogNiBmaWxlcyBjaGFuZ2VkLCA0NSBpbnNlcnRpb25zKCspLCAxOCBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHBldC5jIGIveGVuL2FyY2gveDg2L2hwZXQuYwpp
bmRleCA0YjA4NDg4Li41N2Y2OGZhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHBldC5jCisr
KyBiL3hlbi9hcmNoL3g4Ni9ocGV0LmMKQEAgLTExLDYgKzExLDcgQEAKICNpbmNsdWRlIDx4ZW4v
c29mdGlycS5oPgogI2luY2x1ZGUgPHhlbi9pcnEuaD4KICNpbmNsdWRlIDx4ZW4vbnVtYS5oPgor
I2luY2x1ZGUgPHhlbi9zY2hlZC5oPgogI2luY2x1ZGUgPGFzbS9maXhtYXAuaD4KICNpbmNsdWRl
IDxhc20vZGl2NjQuaD4KICNpbmNsdWRlIDxhc20vaHBldC5oPgpAQCAtMzY4LDcgKzM2OSw3IEBA
IHN0YXRpYyBpbnQgX19pbml0IGhwZXRfYXNzaWduX2lycShzdHJ1Y3QgaHBldF9ldmVudF9jaGFu
bmVsICpjaCkKIHsKICAgICBpbnQgaXJxOwogCi0gICAgaWYgKCAoaXJxID0gY3JlYXRlX2lycShO
VU1BX05PX05PREUpKSA8IDAgKQorICAgIGlmICggKGlycSA9IGNyZWF0ZV9pcnEoTlVNQV9OT19O
T0RFLCBmYWxzZSkpIDwgMCApCiAgICAgICAgIHJldHVybiBpcnE7CiAKICAgICBjaC0+bXNpLmly
cSA9IGlycTsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9pcnEuYyBiL3hlbi9hcmNoL3g4Ni9p
cnEuYwppbmRleCAwZWUzMzQ2Li40MzA0ODk2IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaXJx
LmMKKysrIGIveGVuL2FyY2gveDg2L2lycS5jCkBAIC0yNTQsNyArMjU0LDggQEAgdm9pZCBfX2lu
aXQgY2xlYXJfaXJxX3ZlY3RvcihpbnQgaXJxKQogLyoKICAqIER5bmFtaWMgaXJxIGFsbG9jYXRl
IGFuZCBkZWFsbG9jYXRpb24gZm9yIE1TSQogICovCi1pbnQgY3JlYXRlX2lycShub2RlaWRfdCBu
b2RlKQorCitpbnQgY3JlYXRlX2lycShub2RlaWRfdCBub2RlLCBib29sIGdyYW50X2FjY2VzcykK
IHsKICAgICBpbnQgaXJxLCByZXQ7CiAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjOwpAQCAtMjgy
LDE4ICsyODMsMjMgQEAgaW50IGNyZWF0ZV9pcnEobm9kZWlkX3Qgbm9kZSkKICAgICAgICAgfQog
ICAgICAgICByZXQgPSBhc3NpZ25faXJxX3ZlY3RvcihpcnEsIG1hc2spOwogICAgIH0KKworICAg
IEFTU0VSVChkZXNjLT5hcmNoLmNyZWF0b3JfZG9taWQgPT0gRE9NSURfSU5WQUxJRCk7CisKICAg
ICBpZiAocmV0IDwgMCkKICAgICB7CiAgICAgICAgIGRlc2MtPmFyY2gudXNlZCA9IElSUV9VTlVT
RUQ7CiAgICAgICAgIGlycSA9IHJldDsKICAgICB9Ci0gICAgZWxzZSBpZiAoIGhhcmR3YXJlX2Rv
bWFpbiApCisgICAgZWxzZSBpZiAoIGdyYW50X2FjY2VzcyApCiAgICAgewotICAgICAgICByZXQg
PSBpcnFfcGVybWl0X2FjY2VzcyhoYXJkd2FyZV9kb21haW4sIGlycSk7CisgICAgICAgIHJldCA9
IGlycV9wZXJtaXRfYWNjZXNzKGN1cnJlbnQtPmRvbWFpbiwgaXJxKTsKICAgICAgICAgaWYgKCBy
ZXQgKQogICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19HX0VSUgotICAgICAgICAgICAgICAgICAg
ICJDb3VsZCBub3QgZ3JhbnQgRG9tMCBhY2Nlc3MgdG8gSVJRJWQgKGVycm9yICVkKVxuIiwKLSAg
ICAgICAgICAgICAgICAgICBpcnEsIHJldCk7CisgICAgICAgICAgICAgICAgICAgIkNvdWxkIG5v
dCBncmFudCAlcGQgYWNjZXNzIHRvIElSUSVkIChlcnJvciAlZClcbiIsCisgICAgICAgICAgICAg
ICAgICAgY3VycmVudC0+ZG9tYWluLCBpcnEsIHJldCk7CisgICAgICAgIGVsc2UKKyAgICAgICAg
ICAgIGRlc2MtPmFyY2guY3JlYXRvcl9kb21pZCA9IGN1cnJlbnQtPmRvbWFpbi0+ZG9tYWluX2lk
OwogICAgIH0KIAogICAgIHJldHVybiBpcnE7CkBAIC0zMDcsMTQgKzMxMywyMyBAQCB2b2lkIGRl
c3Ryb3lfaXJxKHVuc2lnbmVkIGludCBpcnEpCiAKICAgICBCVUdfT04oIU1TSV9JUlEoaXJxKSk7
CiAKLSAgICBpZiAoIGhhcmR3YXJlX2RvbWFpbiApCisgICAgaWYgKCBkZXNjLT5hcmNoLmNyZWF0
b3JfZG9taWQgIT0gRE9NSURfSU5WQUxJRCApCiAgICAgewotICAgICAgICBpbnQgZXJyID0gaXJx
X2RlbnlfYWNjZXNzKGhhcmR3YXJlX2RvbWFpbiwgaXJxKTsKKyAgICAgICAgc3RydWN0IGRvbWFp
biAqZCA9IGdldF9kb21haW5fYnlfaWQoZGVzYy0+YXJjaC5jcmVhdG9yX2RvbWlkKTsKIAotICAg
ICAgICBpZiAoIGVyciApCi0gICAgICAgICAgICBwcmludGsoWEVOTE9HX0dfRVJSCi0gICAgICAg
ICAgICAgICAgICAgIkNvdWxkIG5vdCByZXZva2UgRG9tMCBhY2Nlc3MgdG8gSVJRJXUgKGVycm9y
ICVkKVxuIiwKLSAgICAgICAgICAgICAgICAgICBpcnEsIGVycik7CisgICAgICAgIGlmICggZCAp
CisgICAgICAgIHsKKyAgICAgICAgICAgIGludCBlcnIgPSBpcnFfZGVueV9hY2Nlc3MoZCwgaXJx
KTsKKyAgICAgICAgICAgIGlmICggZXJyICkKKyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9H
X0dfRVJSCisgICAgICAgICAgICAgICAgICAgICAgICJDb3VsZCBub3QgcmV2b2tlICVwZCBhY2Nl
c3MgdG8gSVJRJXUgKGVycm9yICVkKVxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgZCwgaXJx
LCBlcnIpOworCisgICAgICAgICAgICBwdXRfZG9tYWluKGQpOworCisgICAgICAgIH0KKworICAg
ICAgICBkZXNjLT5hcmNoLmNyZWF0b3JfZG9taWQgPSBET01JRF9JTlZBTElEOwogICAgIH0KIAog
ICAgIHNwaW5fbG9ja19pcnFzYXZlKCZkZXNjLT5sb2NrLCBmbGFncyk7CkBAIC0zODEsNiArMzk2
LDcgQEAgaW50IGFyY2hfaW5pdF9vbmVfaXJxX2Rlc2Moc3RydWN0IGlycV9kZXNjICpkZXNjKQog
CiAgICAgZGVzYy0+YXJjaC52ZWN0b3IgPSBJUlFfVkVDVE9SX1VOQVNTSUdORUQ7CiAgICAgZGVz
Yy0+YXJjaC5vbGRfdmVjdG9yID0gSVJRX1ZFQ1RPUl9VTkFTU0lHTkVEOworICAgIGRlc2MtPmFy
Y2guY3JlYXRvcl9kb21pZCA9IERPTUlEX0lOVkFMSUQ7CiAKICAgICByZXR1cm4gMDsKIH0KQEAg
LTIxMzMsNyArMjE0OSw3IEBAIGludCBtYXBfZG9tYWluX3BpcnEoCiAgICAgICAgICAgICBzcGlu
X3VubG9ja19pcnFyZXN0b3JlKCZkZXNjLT5sb2NrLCBmbGFncyk7CiAKICAgICAgICAgICAgIGlu
Zm8gPSBOVUxMOwotICAgICAgICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05PREUpOwor
ICAgICAgICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05PREUsIHRydWUpOwogICAgICAg
ICAgICAgcmV0ID0gaXJxID49IDAgPyBwcmVwYXJlX2RvbWFpbl9pcnFfcGlycShkLCBpcnEsIHBp
cnEgKyBuciwgJmluZm8pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGlycTsKICAgICAg
ICAgICAgIGlmICggcmV0IDwgMCApCkBAIC0yODE4LDcgKzI4MzQsNyBAQCBpbnQgYWxsb2NhdGVf
YW5kX21hcF9tc2lfcGlycShzdHJ1Y3QgZG9tYWluICpkLCBpbnQgaW5kZXgsIGludCAqcGlycV9w
LAogICAgICAgICBpZiAoIGlycSA9PSAtMSApCiAgICAgICAgIHsKICAgICBjYXNlIE1BUF9QSVJR
X1RZUEVfTVVMVElfTVNJOgotICAgICAgICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05P
REUpOworICAgICAgICAgICAgaXJxID0gY3JlYXRlX2lycShOVU1BX05PX05PREUsIHRydWUpOwog
ICAgICAgICB9CiAKICAgICAgICAgaWYgKCBpcnEgPCBucl9pcnFzX2dzaSB8fCBpcnEgPj0gbnJf
aXJxcyApCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYyBiL3hlbi9kcml2
ZXJzL2NoYXIvbnMxNjU1MC5jCmluZGV4IDg2NjdkZTYuLmZjZDM5NzkgMTAwNjQ0Ci0tLSBhL3hl
bi9kcml2ZXJzL2NoYXIvbnMxNjU1MC5jCisrKyBiL3hlbi9kcml2ZXJzL2NoYXIvbnMxNjU1MC5j
CkBAIC03MjIsNyArNzIyLDcgQEAgc3RhdGljIHZvaWQgX19pbml0IG5zMTY1NTBfaW5pdF9pcnEo
c3RydWN0IHNlcmlhbF9wb3J0ICpwb3J0KQogICAgIHN0cnVjdCBuczE2NTUwICp1YXJ0ID0gcG9y
dC0+dWFydDsKIAogICAgIGlmICggdWFydC0+bXNpICkKLSAgICAgICAgdWFydC0+aXJxID0gY3Jl
YXRlX2lycSgwKTsKKyAgICAgICAgdWFydC0+aXJxID0gY3JlYXRlX2lycSgwLCBmYWxzZSk7CiAj
ZW5kaWYKIH0KIApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X2luaXQuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMKaW5kZXgg
YmI5ZjMzZS4uMjMzYThhZSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5p
dC5jCkBAIC03NjUsNyArNzY1LDcgQEAgc3RhdGljIGJvb2xfdCBfX2luaXQgc2V0X2lvbW11X2lu
dGVycnVwdF9oYW5kbGVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQogewogICAgIGludCBpcnEs
IHJldDsKIAotICAgIGlycSA9IGNyZWF0ZV9pcnEoTlVNQV9OT19OT0RFKTsKKyAgICBpcnEgPSBj
cmVhdGVfaXJxKE5VTUFfTk9fTk9ERSwgZmFsc2UpOwogICAgIGlmICggaXJxIDw9IDAgKQogICAg
IHsKICAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSLCAiSU9NTVU6IG5vIGlycXNcbiIpOwpkaWZm
IC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYwppbmRleCA1ZDcyMjcwLi4yNGExZTkyIDEwMDY0NAot
LS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYworKysgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYwpAQCAtMTEzOCw3ICsxMTM4LDggQEAgc3RhdGljIGlu
dCBfX2luaXQgaW9tbXVfc2V0X2ludGVycnVwdChzdHJ1Y3QgYWNwaV9kcmhkX3VuaXQgKmRyaGQp
CiAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjOwogCiAgICAgaXJxID0gY3JlYXRlX2lycShyaHNh
ID8gcHhtX3RvX25vZGUocmhzYS0+cHJveGltaXR5X2RvbWFpbikKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgOiBOVU1BX05PX05PREUpOworICAgICAgICAgICAgICAgICAgICAgICAgICA6IE5V
TUFfTk9fTk9ERSwKKyAgICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICBpZiAoIGlycSA8
PSAwICkKICAgICB7CiAgICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiBWVERQUkVGSVgsICJJT01N
VTogbm8gaXJxIGF2YWlsYWJsZSFcbiIpOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9pcnEuaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaXJxLmgKaW5kZXggYmMwYzBjMS4uYTc1YzA1
NCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9pcnEuaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L2lycS5oCkBAIC00NSw2ICs0NSwxMSBAQCBzdHJ1Y3QgYXJjaF9pcnFfZGVzYyB7
CiAgICAgICAgIHVuc2lnbmVkIG1vdmVfY2xlYW51cF9jb3VudDsKICAgICAgICAgdTggbW92ZV9p
bl9wcm9ncmVzcyA6IDE7CiAgICAgICAgIHM4IHVzZWQ7CisgICAgICAgIC8qCisgICAgICAgICAq
IFdlYWsgcmVmZXJlbmNlIHRvIGRvbWFpbiBoYXZpbmcgcGVybWlzc2lvbiBvdmVyIHRoaXMgSVJR
ICh3aGljaCBjYW4KKyAgICAgICAgICogYmUgZGlmZmVyZW50IGZyb20gdGhlIGRvbWFpbiBhY3R1
YWxseSBoYXZpbmcgdGhlIElSUSBhc3NpZ25lZCkKKyAgICAgICAgICovCisgICAgICAgIGRvbWlk
X3QgY3JlYXRvcl9kb21pZDsKIH07CiAKIC8qIEZvciB1c2Ugd2l0aCBpcnFfZGVzYy5hcmNoLnVz
ZWQgKi8KQEAgLTE2MSw3ICsxNjYsMTEgQEAgaW50ICBpbml0X2lycV9kYXRhKHZvaWQpOwogdm9p
ZCBjbGVhcl9pcnFfdmVjdG9yKGludCBpcnEpOwogCiBpbnQgaXJxX3RvX3ZlY3RvcihpbnQgaXJx
KTsKLWludCBjcmVhdGVfaXJxKG5vZGVpZF90IG5vZGUpOworLyoKKyAqIElmIGdyYW50X2FjY2Vz
cyBpcyBzZXQgdGhlIGN1cnJlbnQgZG9tYWluIGlzIGdpdmVuIHBlcm1pc3Npb25zIG92ZXIKKyAq
IHRoZSBjcmVhdGVkIElSUS4KKyAqLworaW50IGNyZWF0ZV9pcnEobm9kZWlkX3Qgbm9kZSwgYm9v
bCBncmFudF9hY2Nlc3MpOwogdm9pZCBkZXN0cm95X2lycSh1bnNpZ25lZCBpbnQgaXJxKTsKIGlu
dCBhc3NpZ25faXJxX3ZlY3RvcihpbnQgaXJxLCBjb25zdCBjcHVtYXNrX3QgKik7CiAKLS0gCmdp
dC1zZXJpZXMgMC45LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=

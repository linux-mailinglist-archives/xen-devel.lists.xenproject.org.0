Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 10D6914D486
	for <lists+xen-devel@lfdr.de>; Thu, 30 Jan 2020 01:14:43 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iwxPH-0002HB-2k; Thu, 30 Jan 2020 00:10:03 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=e642=3T=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iwxPF-0002CJ-Qp
 for xen-devel@lists.xenproject.org; Thu, 30 Jan 2020 00:10:01 +0000
X-Inumbo-ID: da0e5a12-42f4-11ea-8396-bc764e2007e4
Received: from mail-yw1-xc30.google.com (unknown [2607:f8b0:4864:20::c30])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id da0e5a12-42f4-11ea-8396-bc764e2007e4;
 Thu, 30 Jan 2020 00:09:58 +0000 (UTC)
Received: by mail-yw1-xc30.google.com with SMTP id 10so1057881ywv.5
 for <xen-devel@lists.xenproject.org>; Wed, 29 Jan 2020 16:09:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id;
 bh=6hanIlAACZKCGtV6rO9p/hZ/dhbPIXlX4HbjWHdyFiw=;
 b=W7RPqZ1aL/4Dw1axFC15XcNoRhohJ4WFGtlZYaNLNd0jteTMfXc33WivaS1UY51GMH
 ZS4779WtKXfDghh0d11/fMyOlZOoLXB7al7ZVC1GJmVeWTEAXd/o90uQd7Q8A4opn16p
 X06JVCuYmrTlZymlK2wC6Maq1MmqCSrEzItxi7JHM8tWOhJspKEQNhbjtAWJHiFsg1Wl
 92BYDsifQzcaTBN3tPYpP50B7ZGBjlvaBxpKENirD7NZhxiT7uBKQrVcXD7+hC98pxEI
 1M6UeyMUmxT0apW3XliO2s/csTHBE5jEzoyX4xoZQ9AX8MstFqfi6qQqN66xKq3GNMvZ
 03fA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id;
 bh=6hanIlAACZKCGtV6rO9p/hZ/dhbPIXlX4HbjWHdyFiw=;
 b=fJ3B7FJGTevTsrKhcg8XTmtLxcFfSMg8rZ4S3bpNhryqYB7W3jWH53yvn0gRBviJPV
 S0s2qAOn9VaYdsA5d+vJ98krO04W25DJeLmFWJnYxHbYIy61gqO8mMASK5X32w9U0kxo
 NagHcuHg1abciESdvuHH6OMiMJcMXCJp7+aJPr0PLO1UYIVJkppqWkbs8Q47aUXEgIFB
 eTfyc2Kfd2SGHPU9DGxh48n3+zMlXVyf0HEaJDCpqBZ5WjcUh2uPEalYuZZbbA+MEYgv
 /9kEP6DgeDXJDTZh7pVPPR8+I/XAzoIf2s1icfySSLJoClYu7UU5Xi0zQp2Nm0ziOxLq
 PMEg==
X-Gm-Message-State: APjAAAXDampMRuhZZT6bhbf3+6ix5FKNInp3z/HJDAuQiSlZnFFkE7nt
 EQhHNrhI+y7i8vE8swxeefsIctIn
X-Google-Smtp-Source: APXvYqyx0VNhaUEiFBRxuJoE1HTDRf54yGW2vW44dMz9owTagEDYvxoggLRjYVaA1IW0AvqcLzaPLQ==
X-Received: by 2002:a25:ced4:: with SMTP id x203mr1759087ybe.419.1580342996145; 
 Wed, 29 Jan 2020 16:09:56 -0800 (PST)
Received: from four.lan (cpe-67-241-56-252.twcny.res.rr.com. [67.241.56.252])
 by smtp.gmail.com with ESMTPSA id
 o69sm1767505ywd.38.2020.01.29.16.09.54
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 29 Jan 2020 16:09:55 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
X-Google-Original-From: Nick Rosbrook <rosbrookn@ainfosec.com>
To: xen-devel@lists.xenproject.org
Date: Wed, 29 Jan 2020 19:09:50 -0500
Message-Id: <d60703d51d76417a5ba41064d66229440c3b4a50.1580342990.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.17.1
Subject: [Xen-devel] [PATCH] golang/xenlight: implement constructor
 generation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

R2VuZXJhdGUgY29uc3RydWN0b3JzIGZvciBnZW5lcmF0ZWQgR28gdHlwZXMuIENhbGwgbGlieGxf
PHR5cGU+X2luaXQgc28KdGhlIEdvIHR5cGUgY2FuIGJlIHByb3Blcmx5IGluaXRpYWxpemVkLgoK
SWYgYSB0eXBlIGhhcyBhIGtleWVkIHVuaW9uIGZpZWxkLCBhZGQgYSBwYXJhbWV0ZXIgdG8gdGhl
IGZ1bmN0aW9uCnNpZ25hdHVyZSB0byBzZXQgdGhlIGtleSB2YXJpYWJsZSwgYW5kIGNhbGwgdGhl
IGluaXQgZnVuY3Rpb24gZm9yIHRoZQprZXllZCB1bmlvbi4KClNpZ25lZC1vZmYtYnk6IE5pY2sg
Um9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2dlbmdvdHlwZXMucHkgIHwgICA2NSArKwogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBl
cnMuZ2VuLmdvIHwgMTAwMiArKysrKysrKysrKysrKysrKysrKysrKysrLQogMiBmaWxlcyBjaGFu
Z2VkLCAxMDQ5IGluc2VydGlvbnMoKyksIDE4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Rv
b2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5IGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2dlbmdvdHlwZXMucHkKaW5kZXggYjA5Y2ZmYjgyOS4uYWVjMTUzMDk4ZCAxMDA2NDQKLS0tIGEv
dG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkKKysrIGIvdG9vbHMvZ29sYW5nL3hl
bmxpZ2h0L2dlbmdvdHlwZXMucHkKQEAgLTIyNSw2ICsyMjUsOSBAQCBkZWYgeGVubGlnaHRfZ29s
YW5nX2dlbmVyYXRlX2hlbHBlcnMocGF0aCA9IE5vbmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9
IE5vbmUpOgogICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodHksIGlkbC5TdHJ1Y3QpOgog
ICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAKKyAgICAgICAgICAgIGYud3JpdGUoeGVubGlnaHRf
Z29sYW5nX2RlZmluZV9jb25zdHJ1Y3Rvcih0eSkpCisgICAgICAgICAgICBmLndyaXRlKCdcbicp
CisKICAgICAgICAgICAgIChmZGVmLCBleHRyYXMpID0geGVubGlnaHRfZ29sYW5nX2RlZmluZV9m
cm9tX0ModHkpCiAKICAgICAgICAgICAgIGYud3JpdGUoZmRlZikKQEAgLTYxOSw2ICs2MjIsNjgg
QEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19hcnJheV90b19DKHR5ID0gTm9uZSk6CiAKICAgICByZXR1
cm4gcwogCitkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmluZV9jb25zdHJ1Y3Rvcih0eSA9IE5vbmUp
OgorICAgIHMgPSAnJworCisgICAgY3R5cGVuYW1lICA9IHR5LnR5cGVuYW1lCisgICAgZ290eXBl
bmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShjdHlwZW5hbWUpCisKKyAgICAjIFNpbmNl
IHRoaXMgZnVuYyBpcyBleHBvcnRlZCwgYWRkIGEgY29tbWVudCBhcyBwZXIgR28gY29udmVudGlv
bnMuCisgICAgcyArPSAnLy8gTmV3e30gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiB7fScuZm9ybWF0
KGdvdHlwZW5hbWUsZ290eXBlbmFtZSkKKyAgICBzICs9ICcgaW5pdGlhbGl6ZWQgd2l0aCBkZWZh
dWx0cy5cbicKKworICAgICMgSWYgYSBzdHJ1Y3QgaGFzIGEga2V5ZWQgdW5pb24sIGFuIGV4dHJh
IGFyZ3VtZW50IGlzCisgICAgIyByZXF1aXJlZCBpbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlLCBh
bmQgYW4gZXh0cmEgX2luaXQKKyAgICAjIGNhbGwgaXMgbmVlZGVkLgorICAgIHBhcmFtcyAgID0g
W10KKyAgICBpbml0X2ZucyA9IFtdCisKKyAgICAjIEFkZCBjYWxsIHRvIHBhcmVudCBpbml0X2Zu
IGZpcnN0LgorICAgIGluaXRfZm5zLmFwcGVuZCgnQy57fSgmeGMpJy5mb3JtYXQodHkuaW5pdF9m
bikpCisKKyAgICBmb3IgZiBpbiB0eS5maWVsZHM6CisgICAgICAgIGlmIG5vdCBpc2luc3RhbmNl
KGYudHlwZSwgaWRsLktleWVkVW5pb24pOgorICAgICAgICAgICAgY29udGludWUKKworICAgICAg
ICBwYXJhbSA9IGYudHlwZS5rZXl2YXIKKworICAgICAgICBwYXJhbV9jdHlwZSAgPSBwYXJhbS50
eXBlLnR5cGVuYW1lCisgICAgICAgIHBhcmFtX2dvdHlwZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRf
bmFtZShwYXJhbV9jdHlwZSkKKyAgICAgICAgcGFyYW1fZ29uYW1lID0geGVubGlnaHRfZ29sYW5n
X2ZtdF9uYW1lKHBhcmFtLm5hbWUsZXhwb3J0ZWQ9RmFsc2UpCisKKyAgICAgICAgIyBTZXJ2ZXJh
bCBrZXllZCB1bmlvbnMgdXNlICd0eXBlJyBhcyB0aGUga2V5IHZhcmlhYmxlIG5hbWUuIEluCisg
ICAgICAgICMgdGhhdCBjYXNlLCBwcmVwZW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgdGhlIEdvIHR5
cGUgbmFtZS4KKyAgICAgICAgaWYgcGFyYW1fZ29uYW1lID09ICd0eXBlJzoKKyAgICAgICAgICAg
IHBhcmFtX2dvbmFtZSA9ICd7fXR5cGUnLmZvcm1hdChwYXJhbV9nb3R5cGUubG93ZXIoKVswXSkK
KworICAgICAgICAjIEFkZCBjYWxsIHRvIGtleWVkIHVuaW9uJ3MgaW5pdF9mbi4KKyAgICAgICAg
aW5pdF9mbnMuYXBwZW5kKCdDLnt9X3t9KCZ4YywgQy57fSh7fSkpJy5mb3JtYXQodHkuaW5pdF9m
biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGFyYW0ubmFtZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcGFyYW1fY3R5cGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtX2dvbmFtZSkpCisKKyAgICAgICAgIyBB
ZGQgdG8gcGFyYW1zIGxpc3QuCisgICAgICAgIHBhcmFtcy5hcHBlbmQoJ3t9IHt9Jy5mb3JtYXQo
cGFyYW1fZ29uYW1lLCBwYXJhbV9nb3R5cGUpKQorCisgICAgIyBEZWZpbmUgZnVuY3Rpb24KKyAg
ICBzICs9ICdmdW5jIE5ld3t9KHt9KSAoKnt9LCBlcnJvcikge3tcbicuZm9ybWF0KGdvdHlwZW5h
bWUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn
LCcuam9pbihwYXJhbXMpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ290eXBlbmFtZSkKKworICAgICMgRGVjbGFyZSB2YXJpYWJsZXMuCisgICAg
cyArPSAndmFyIChcbngge31cbnhjIEMue30pXG5cbicuZm9ybWF0KGdvdHlwZW5hbWUsIGN0eXBl
bmFtZSkKKworICAgICMgV3JpdGUgaW5pdF9mbiBjYWxscy4KKyAgICBzICs9ICdcbicuam9pbihp
bml0X2ZucykKKyAgICBzICs9ICdcblxuJworCisgICAgIyBDYWxsIGZyb21DIHRvIGluaXRpYWxp
emUgR28gdHlwZS4KKyAgICBzICs9ICdpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmls
IHtcbicKKyAgICBzICs9ICdyZXR1cm4gbmlsLCBlcnIgfVxuXG4nCisgICAgcyArPSAncmV0dXJu
ICZ4LCBuaWx9XG4nCisKKyAgICByZXR1cm4gcworCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9u
YW1lKG5hbWUsIGV4cG9ydGVkID0gVHJ1ZSk6CiAgICAgIiIiCiAgICAgVGFrZSBhIGdpdmVuIHR5
cGUgbmFtZSBhbmQgcmV0dXJuIGFuCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQv
aGVscGVycy5nZW4uZ28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5k
ZXggNzQ2ZDk5YjViYS4uMjI1YmE2ODY4ZSAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2hlbHBlcnMuZ2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdl
bi5nbwpAQCAtMzAsNiArMzAsMjIgQEAgdHlwZWRlZiB0eXBlb2YoKChzdHJ1Y3QgbGlieGxfcHNy
X2h3X2luZm8gKilOVUxMKS0+dS5tYmEpbGlieGxfcHNyX2h3X2luZm9fdHlwZV8KICovCiBpbXBv
cnQgIkMiCiAKKy8vIE5ld0lvcG9ydFJhbmdlIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgSW9wb3J0
UmFuZ2UgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3SW9wb3J0UmFuZ2UoKSAo
KklvcG9ydFJhbmdlLCBlcnJvcikgeworCXZhciAoCisJCXggIElvcG9ydFJhbmdlCisJCXhjIEMu
bGlieGxfaW9wb3J0X3JhbmdlCisJKQorCisJQy5saWJ4bF9pb3BvcnRfcmFuZ2VfaW5pdCgmeGMp
CisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwg
ZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqSW9wb3J0UmFuZ2UpIGZy
b21DKHhjICpDLmxpYnhsX2lvcG9ydF9yYW5nZSkgZXJyb3IgewogCXguRmlyc3QgPSB1aW50MzIo
eGMuZmlyc3QpCiAJeC5OdW1iZXIgPSB1aW50MzIoeGMubnVtYmVyKQpAQCAtNTAsNiArNjYsMjIg
QEAgZnVuYyAoeCAqSW9wb3J0UmFuZ2UpIHRvQyh4YyAqQy5saWJ4bF9pb3BvcnRfcmFuZ2UpIChl
cnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0lvbWVtUmFuZ2UgcmV0dXJucyBh
biBpbnN0YW5jZSBvZiBJb21lbVJhbmdlIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5j
IE5ld0lvbWVtUmFuZ2UoKSAoKklvbWVtUmFuZ2UsIGVycm9yKSB7CisJdmFyICgKKwkJeCAgSW9t
ZW1SYW5nZQorCQl4YyBDLmxpYnhsX2lvbWVtX3JhbmdlCisJKQorCisJQy5saWJ4bF9pb21lbV9y
YW5nZV9pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpJ
b21lbVJhbmdlKSBmcm9tQyh4YyAqQy5saWJ4bF9pb21lbV9yYW5nZSkgZXJyb3IgewogCXguU3Rh
cnQgPSB1aW50NjQoeGMuc3RhcnQpCiAJeC5OdW1iZXIgPSB1aW50NjQoeGMubnVtYmVyKQpAQCAt
NzIsNiArMTA0LDIyIEBAIGZ1bmMgKHggKklvbWVtUmFuZ2UpIHRvQyh4YyAqQy5saWJ4bF9pb21l
bV9yYW5nZSkgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3VmdhSW50ZXJm
YWNlSW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZnYUludGVyZmFjZUluZm8gaW5pdGlhbGl6
ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VmdhSW50ZXJmYWNlSW5mbygpICgqVmdhSW50ZXJm
YWNlSW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWZ2FJbnRlcmZhY2VJbmZvCisJCXhjIEMu
bGlieGxfdmdhX2ludGVyZmFjZV9pbmZvCisJKQorCisJQy5saWJ4bF92Z2FfaW50ZXJmYWNlX2lu
Zm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqVmdh
SW50ZXJmYWNlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmdhX2ludGVyZmFjZV9pbmZvKSBlcnJv
ciB7CiAJeC5LaW5kID0gVmdhSW50ZXJmYWNlVHlwZSh4Yy5raW5kKQogCkBAIC05MCw2ICsxMzgs
MjIgQEAgZnVuYyAoeCAqVmdhSW50ZXJmYWNlSW5mbykgdG9DKHhjICpDLmxpYnhsX3ZnYV9pbnRl
cmZhY2VfaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3Vm5jSW5m
byByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZuY0luZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0
cy4KK2Z1bmMgTmV3Vm5jSW5mbygpICgqVm5jSW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBW
bmNJbmZvCisJCXhjIEMubGlieGxfdm5jX2luZm8KKwkpCisKKwlDLmxpYnhsX3ZuY19pbmZvX2lu
aXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVy
biBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZuY0luZm8p
IGZyb21DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9IHguRW5hYmxl
LmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgRW5hYmxlOiAldiIsIGVycikKQEAgLTEyOCw2ICsxOTIsMjIgQEAgZnVu
YyAoeCAqVm5jSW5mbykgdG9DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSAoZXJyIGVycm9yKSB7CiAJ
cmV0dXJuIG5pbAogfQogCisvLyBOZXdTcGljZUluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBT
cGljZUluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3U3BpY2VJbmZvKCkg
KCpTcGljZUluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgU3BpY2VJbmZvCisJCXhjIEMubGli
eGxfc3BpY2VfaW5mbworCSkKKworCUMubGlieGxfc3BpY2VfaW5mb19pbml0KCZ4YykKKworCWlm
IGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9
CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpTcGljZUluZm8pIGZyb21DKHhjICpD
LmxpYnhsX3NwaWNlX2luZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJvbUMoJnhj
LmVuYWJsZSk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBm
aWVsZCBFbmFibGU6ICV2IiwgZXJyKQpAQCAtMTk2LDYgKzI3NiwyMiBAQCBmdW5jICh4ICpTcGlj
ZUluZm8pIHRvQyh4YyAqQy5saWJ4bF9zcGljZV9pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdTZGxJbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgU2RsSW5mbyBp
bml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdTZGxJbmZvKCkgKCpTZGxJbmZvLCBl
cnJvcikgeworCXZhciAoCisJCXggIFNkbEluZm8KKwkJeGMgQy5saWJ4bF9zZGxfaW5mbworCSkK
KworCUMubGlieGxfc2RsX2luZm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwK
K30KKwogZnVuYyAoeCAqU2RsSW5mbykgZnJvbUMoeGMgKkMubGlieGxfc2RsX2luZm8pIGVycm9y
IHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJvbUMoJnhjLmVuYWJsZSk7IGVyciAhPSBuaWwgewog
CQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBFbmFibGU6ICV2IiwgZXJyKQpA
QCAtMjMyLDYgKzMyOCwyMiBAQCBmdW5jICh4ICpTZGxJbmZvKSB0b0MoeGMgKkMubGlieGxfc2Rs
X2luZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RvbWluZm8gcmV0
dXJucyBhbiBpbnN0YW5jZSBvZiBEb21pbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitm
dW5jIE5ld0RvbWluZm8oKSAoKkRvbWluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgRG9taW5m
bworCQl4YyBDLmxpYnhsX2RvbWluZm8KKwkpCisKKwlDLmxpYnhsX2RvbWluZm9faW5pdCgmeGMp
CisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwg
ZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRG9taW5mbykgZnJvbUMo
eGMgKkMubGlieGxfZG9taW5mbykgZXJyb3IgewogCWlmIGVyciA6PSB4LlV1aWQuZnJvbUMoJnhj
LnV1aWQpOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgVXVpZDogJXYiLCBlcnIpCkBAIC0yOTYsNiArNDA4LDIyIEBAIGZ1bmMgKHggKkRvbWluZm8p
IHRvQyh4YyAqQy5saWJ4bF9kb21pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQog
CisvLyBOZXdDcHVwb29saW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIENwdXBvb2xpbmZvIGlu
aXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0NwdXBvb2xpbmZvKCkgKCpDcHVwb29s
aW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBDcHVwb29saW5mbworCQl4YyBDLmxpYnhsX2Nw
dXBvb2xpbmZvCisJKQorCisJQy5saWJ4bF9jcHVwb29saW5mb19pbml0KCZ4YykKKworCWlmIGVy
ciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisK
KwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpDcHVwb29saW5mbykgZnJvbUMoeGMgKkMu
bGlieGxfY3B1cG9vbGluZm8pIGVycm9yIHsKIAl4LlBvb2xpZCA9IHVpbnQzMih4Yy5wb29saWQp
CiAJeC5Qb29sTmFtZSA9IEMuR29TdHJpbmcoeGMucG9vbF9uYW1lKQpAQCAtMzI4LDYgKzQ1Niwy
MyBAQCBmdW5jICh4ICpDcHVwb29saW5mbykgdG9DKHhjICpDLmxpYnhsX2NwdXBvb2xpbmZvKSAo
ZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdDaGFubmVsaW5mbyByZXR1cm5z
IGFuIGluc3RhbmNlIG9mIENoYW5uZWxpbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitm
dW5jIE5ld0NoYW5uZWxpbmZvKGNvbm5lY3Rpb24gQ2hhbm5lbENvbm5lY3Rpb24pICgqQ2hhbm5l
bGluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgQ2hhbm5lbGluZm8KKwkJeGMgQy5saWJ4bF9j
aGFubmVsaW5mbworCSkKKworCUMubGlieGxfY2hhbm5lbGluZm9faW5pdCgmeGMpCisJQy5saWJ4
bF9jaGFubmVsaW5mb19pbml0X2Nvbm5lY3Rpb24oJnhjLCBDLmxpYnhsX2NoYW5uZWxfY29ubmVj
dGlvbihjb25uZWN0aW9uKSkKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4
ICpDaGFubmVsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfY2hhbm5lbGluZm8pIGVycm9yIHsKIAl4
LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50MzIo
eGMuYmFja2VuZF9pZCkKQEAgLTQwMSw2ICs1NDYsMjIgQEAgZnVuYyAoeCAqQ2hhbm5lbGluZm8p
IHRvQyh4YyAqQy5saWJ4bF9jaGFubmVsaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwK
IH0KIAorLy8gTmV3Vm1pbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVm1pbmZvIGluaXRpYWxp
emVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZtaW5mbygpICgqVm1pbmZvLCBlcnJvcikgewor
CXZhciAoCisJCXggIFZtaW5mbworCQl4YyBDLmxpYnhsX3ZtaW5mbworCSkKKworCUMubGlieGxf
dm1pbmZvX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHgg
KlZtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm1pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9IHgu
VXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCBVdWlkOiAldiIsIGVycikKQEAgLTQyNSw2ICs1ODYsMjIgQEAgZnVu
YyAoeCAqVm1pbmZvKSB0b0MoeGMgKkMubGlieGxfdm1pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0
dXJuIG5pbAogfQogCisvLyBOZXdWZXJzaW9uSW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZl
cnNpb25JbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZlcnNpb25JbmZv
KCkgKCpWZXJzaW9uSW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWZXJzaW9uSW5mbworCQl4
YyBDLmxpYnhsX3ZlcnNpb25faW5mbworCSkKKworCUMubGlieGxfdmVyc2lvbl9pbmZvX2luaXQo
JnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBu
aWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZlcnNpb25JbmZv
KSBmcm9tQyh4YyAqQy5saWJ4bF92ZXJzaW9uX2luZm8pIGVycm9yIHsKIAl4LlhlblZlcnNpb25N
YWpvciA9IGludCh4Yy54ZW5fdmVyc2lvbl9tYWpvcikKIAl4LlhlblZlcnNpb25NaW5vciA9IGlu
dCh4Yy54ZW5fdmVyc2lvbl9taW5vcikKQEAgLTQ4NSw2ICs2NjIsMjIgQEAgZnVuYyAoeCAqVmVy
c2lvbkluZm8pIHRvQyh4YyAqQy5saWJ4bF92ZXJzaW9uX2luZm8pIChlcnIgZXJyb3IpIHsKIAly
ZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RvbWFpbkNyZWF0ZUluZm8gcmV0dXJucyBhbiBpbnN0YW5j
ZSBvZiBEb21haW5DcmVhdGVJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5l
d0RvbWFpbkNyZWF0ZUluZm8oKSAoKkRvbWFpbkNyZWF0ZUluZm8sIGVycm9yKSB7CisJdmFyICgK
KwkJeCAgRG9tYWluQ3JlYXRlSW5mbworCQl4YyBDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbwor
CSkKKworCUMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvX2luaXQoJnhjKQorCisJaWYgZXJyIDo9
IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJl
dHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIGZyb21DKHhjICpD
LmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbykgZXJyb3IgewogCXguVHlwZSA9IERvbWFpblR5cGUo
eGMuX3R5cGUpCiAJaWYgZXJyIDo9IHguSGFwLmZyb21DKCZ4Yy5oYXApOyBlcnIgIT0gbmlsIHsK
QEAgLTU2Myw2ICs3NTYsMjIgQEAgZnVuYyAoeCAqRG9tYWluQ3JlYXRlSW5mbykgdG9DKHhjICpD
LmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3RG9tYWluUmVzdG9yZVBhcmFtcyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERvbWFp
blJlc3RvcmVQYXJhbXMgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RG9tYWlu
UmVzdG9yZVBhcmFtcygpICgqRG9tYWluUmVzdG9yZVBhcmFtcywgZXJyb3IpIHsKKwl2YXIgKAor
CQl4ICBEb21haW5SZXN0b3JlUGFyYW1zCisJCXhjIEMubGlieGxfZG9tYWluX3Jlc3RvcmVfcGFy
YW1zCisJKQorCisJQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXNfaW5pdCgmeGMpCisKKwlp
ZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJ
fQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluUmVzdG9yZVBhcmFtcykg
ZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3Jlc3RvcmVfcGFyYW1zKSBlcnJvciB7CiAJeC5DaGVj
a3BvaW50ZWRTdHJlYW0gPSBpbnQoeGMuY2hlY2twb2ludGVkX3N0cmVhbSkKIAl4LlN0cmVhbVZl
cnNpb24gPSB1aW50MzIoeGMuc3RyZWFtX3ZlcnNpb24pCkBAIC01OTMsNiArODAyLDIyIEBAIGZ1
bmMgKHggKkRvbWFpblJlc3RvcmVQYXJhbXMpIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fcmVzdG9y
ZV9wYXJhbXMpIChlcnIgZXJyb3IpCiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdTY2hlZFBhcmFt
cyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFNjaGVkUGFyYW1zIGluaXRpYWxpemVkIHdpdGggZGVm
YXVsdHMuCitmdW5jIE5ld1NjaGVkUGFyYW1zKCkgKCpTY2hlZFBhcmFtcywgZXJyb3IpIHsKKwl2
YXIgKAorCQl4ICBTY2hlZFBhcmFtcworCQl4YyBDLmxpYnhsX3NjaGVkX3BhcmFtcworCSkKKwor
CUMubGlieGxfc2NoZWRfcGFyYW1zX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhj
KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmls
Cit9CisKIGZ1bmMgKHggKlNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9wYXJh
bXMpIGVycm9yIHsKIAl4LlZjcHVpZCA9IGludCh4Yy52Y3B1aWQpCiAJeC5XZWlnaHQgPSBpbnQo
eGMud2VpZ2h0KQpAQCAtNjIxLDYgKzg0NiwyMiBAQCBmdW5jICh4ICpTY2hlZFBhcmFtcykgdG9D
KHhjICpDLmxpYnhsX3NjaGVkX3BhcmFtcykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3VmNwdVNjaGVkUGFyYW1zIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVmNwdVNjaGVk
UGFyYW1zIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZjcHVTY2hlZFBhcmFt
cygpICgqVmNwdVNjaGVkUGFyYW1zLCBlcnJvcikgeworCXZhciAoCisJCXggIFZjcHVTY2hlZFBh
cmFtcworCQl4YyBDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zCisJKQorCisJQy5saWJ4bF92Y3B1
X3NjaGVkX3BhcmFtc19pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBm
dW5jICh4ICpWY3B1U2NoZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX3ZjcHVfc2NoZWRfcGFy
YW1zKSBlcnJvciB7CiAJeC5TY2hlZCA9IFNjaGVkdWxlcih4Yy5zY2hlZCkKIAludW1WY3B1cyA6
PSBpbnQoeGMubnVtX3ZjcHVzKQpAQCAtNjU3LDYgKzg5OCwyMiBAQCBmdW5jICh4ICpWY3B1U2No
ZWRQYXJhbXMpIHRvQyh4YyAqQy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFtcykgKGVyciBlcnJvcikg
ewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RG9tYWluU2NoZWRQYXJhbXMgcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBEb21haW5TY2hlZFBhcmFtcyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgor
ZnVuYyBOZXdEb21haW5TY2hlZFBhcmFtcygpICgqRG9tYWluU2NoZWRQYXJhbXMsIGVycm9yKSB7
CisJdmFyICgKKwkJeCAgRG9tYWluU2NoZWRQYXJhbXMKKwkJeGMgQy5saWJ4bF9kb21haW5fc2No
ZWRfcGFyYW1zCisJKQorCisJQy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zX2luaXQoJnhjKQor
CisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVy
cgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpblNjaGVkUGFyYW1z
KSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zKSBlcnJvciB7CiAJeC5TY2hl
ZCA9IFNjaGVkdWxlcih4Yy5zY2hlZCkKIAl4LldlaWdodCA9IGludCh4Yy53ZWlnaHQpCkBAIC02
ODksNiArOTQ2LDIyIEBAIGZ1bmMgKHggKkRvbWFpblNjaGVkUGFyYW1zKSB0b0MoeGMgKkMubGli
eGxfZG9tYWluX3NjaGVkX3BhcmFtcykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAor
Ly8gTmV3Vm5vZGVJbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVm5vZGVJbmZvIGluaXRpYWxp
emVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1Zub2RlSW5mbygpICgqVm5vZGVJbmZvLCBlcnJv
cikgeworCXZhciAoCisJCXggIFZub2RlSW5mbworCQl4YyBDLmxpYnhsX3Zub2RlX2luZm8KKwkp
CisKKwlDLmxpYnhsX3Zub2RlX2luZm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygm
eGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBu
aWwKK30KKwogZnVuYyAoeCAqVm5vZGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZv
KSBlcnJvciB7CiAJeC5NZW1rYiA9IHVpbnQ2NCh4Yy5tZW1rYikKIAludW1EaXN0YW5jZXMgOj0g
aW50KHhjLm51bV9kaXN0YW5jZXMpCkBAIC03MjksNiArMTAwMiwyMiBAQCBmdW5jICh4ICpWbm9k
ZUluZm8pIHRvQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdSZG1SZXNlcnZlIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUmRtUmVz
ZXJ2ZSBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdSZG1SZXNlcnZlKCkgKCpS
ZG1SZXNlcnZlLCBlcnJvcikgeworCXZhciAoCisJCXggIFJkbVJlc2VydmUKKwkJeGMgQy5saWJ4
bF9yZG1fcmVzZXJ2ZQorCSkKKworCUMubGlieGxfcmRtX3Jlc2VydmVfaW5pdCgmeGMpCisKKwlp
ZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJ
fQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqUmRtUmVzZXJ2ZSkgZnJvbUMoeGMg
KkMubGlieGxfcmRtX3Jlc2VydmUpIGVycm9yIHsKIAl4LlN0cmF0ZWd5ID0gUmRtUmVzZXJ2ZVN0
cmF0ZWd5KHhjLnN0cmF0ZWd5KQogCXguUG9saWN5ID0gUmRtUmVzZXJ2ZVBvbGljeSh4Yy5wb2xp
Y3kpCkBAIC03NDksNiArMTAzOCwyMyBAQCBmdW5jICh4ICpSZG1SZXNlcnZlKSB0b0MoeGMgKkMu
bGlieGxfcmRtX3Jlc2VydmUpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5l
d0RvbWFpbkJ1aWxkSW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERvbWFpbkJ1aWxkSW5mbyBp
bml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEb21haW5CdWlsZEluZm8oZHR5cGUg
RG9tYWluVHlwZSkgKCpEb21haW5CdWlsZEluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgRG9t
YWluQnVpbGRJbmZvCisJCXhjIEMubGlieGxfZG9tYWluX2J1aWxkX2luZm8KKwkpCisKKwlDLmxp
YnhsX2RvbWFpbl9idWlsZF9pbmZvX2luaXQoJnhjKQorCUMubGlieGxfZG9tYWluX2J1aWxkX2lu
Zm9faW5pdF90eXBlKCZ4YywgQy5saWJ4bF9kb21haW5fdHlwZShkdHlwZSkpCisKKwlpZiBlcnIg
Oj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJ
cmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IgewogCXguTWF4VmNwdXMgPSBpbnQoeGMu
bWF4X3ZjcHVzKQogCWlmIGVyciA6PSB4LkF2YWlsVmNwdXMuZnJvbUMoJnhjLmF2YWlsX3ZjcHVz
KTsgZXJyICE9IG5pbCB7CkBAIC04NzgsMTggKzExODQsMTggQEAgZnVuYyAoeCAqRG9tYWluQnVp
bGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IgewogCXgu
VGVlID0gVGVlVHlwZSh4Yy50ZWUpCiAJeC5UeXBlID0gRG9tYWluVHlwZSh4Yy5fdHlwZSkKIAlz
d2l0Y2ggeC5UeXBlIHsKLQljYXNlIERvbWFpblR5cGVIdm06Ci0JCXZhciB0eXBlSHZtIERvbWFp
bkJ1aWxkSW5mb1R5cGVVbmlvbkh2bQotCQlpZiBlcnIgOj0gdHlwZUh2bS5mcm9tQyh4Yyk7IGVy
ciAhPSBuaWwgewotCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgdHlwZUh2
bTogJXYiLCBlcnIpCi0JCX0KLQkJeC5UeXBlVW5pb24gPSB0eXBlSHZtCiAJY2FzZSBEb21haW5U
eXBlUHY6CiAJCXZhciB0eXBlUHYgRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uUHYKIAkJaWYgZXJy
IDo9IHR5cGVQdi5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgewogCQkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgdHlwZVB2OiAldiIsIGVycikKIAkJfQogCQl4LlR5cGVVbmlvbiA9
IHR5cGVQdgorCWNhc2UgRG9tYWluVHlwZUh2bToKKwkJdmFyIHR5cGVIdm0gRG9tYWluQnVpbGRJ
bmZvVHlwZVVuaW9uSHZtCisJCWlmIGVyciA6PSB0eXBlSHZtLmZyb21DKHhjKTsgZXJyICE9IG5p
bCB7CisJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCB0eXBlSHZtOiAldiIs
IGVycikKKwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVIdm0KIAljYXNlIERvbWFpblR5cGVQdmg6
CiAJCXZhciB0eXBlUHZoIERvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvblB2aAogCQlpZiBlcnIgOj0g
dHlwZVB2aC5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgewpAQCAtMTQwNiw2ICsxNzEyLDIyIEBAIGZ1
bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZv
KSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdEZXZpY2VWZmIgcmV0dXJu
cyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VWZmIgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1
bmMgTmV3RGV2aWNlVmZiKCkgKCpEZXZpY2VWZmIsIGVycm9yKSB7CisJdmFyICgKKwkJeCAgRGV2
aWNlVmZiCisJCXhjIEMubGlieGxfZGV2aWNlX3ZmYgorCSkKKworCUMubGlieGxfZGV2aWNlX3Zm
Yl9pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQly
ZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpEZXZp
Y2VWZmIpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92ZmIpIGVycm9yIHsKIAl4LkJhY2tlbmRE
b21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29T
dHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtMTQ0Niw2ICsxNzY4LDIyIEBAIGZ1bmMgKHgg
KkRldmljZVZmYikgdG9DKHhjICpDLmxpYnhsX2RldmljZV92ZmIpIChlcnIgZXJyb3IpIHsKIAly
ZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RldmljZVZrYiByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERl
dmljZVZrYiBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VWa2IoKSAo
KkRldmljZVZrYiwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBEZXZpY2VWa2IKKwkJeGMgQy5saWJ4
bF9kZXZpY2VfdmtiCisJKQorCisJQy5saWJ4bF9kZXZpY2VfdmtiX2luaXQoJnhjKQorCisJaWYg
ZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0K
KworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZrYikgZnJvbUMoeGMgKkMu
bGlieGxfZGV2aWNlX3ZrYikgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFj
a2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2Rv
bW5hbWUpCkBAIC0xNDk2LDYgKzE4MzQsMjIgQEAgZnVuYyAoeCAqRGV2aWNlVmtiKSB0b0MoeGMg
KkMubGlieGxfZGV2aWNlX3ZrYikgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8g
TmV3RGV2aWNlRGlzayByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERldmljZURpc2sgaW5pdGlhbGl6
ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RGV2aWNlRGlzaygpICgqRGV2aWNlRGlzaywgZXJy
b3IpIHsKKwl2YXIgKAorCQl4ICBEZXZpY2VEaXNrCisJCXhjIEMubGlieGxfZGV2aWNlX2Rpc2sK
KwkpCisKKwlDLmxpYnhsX2RldmljZV9kaXNrX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJv
bUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAm
eCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZURpc2spIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV9kaXNrKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlk
KQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAg
LTE1NzgsNiArMTkzMiwyMiBAQCBmdW5jICh4ICpEZXZpY2VEaXNrKSB0b0MoeGMgKkMubGlieGxf
ZGV2aWNlX2Rpc2spIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0Rldmlj
ZU5pYyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERldmljZU5pYyBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VOaWMoKSAoKkRldmljZU5pYywgZXJyb3IpIHsKKwl2YXIg
KAorCQl4ICBEZXZpY2VOaWMKKwkJeGMgQy5saWJ4bF9kZXZpY2VfbmljCisJKQorCisJQy5saWJ4
bF9kZXZpY2VfbmljX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1
bmMgKHggKkRldmljZU5pYykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX25pYykgZXJyb3Igewog
CXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21u
YW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC0xODM2LDYgKzIyMDYsMjIg
QEAgZnVuYyAoeCAqRGV2aWNlTmljKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX25pYykgKGVyciBl
cnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlUGNpIHJldHVybnMgYW4gaW5z
dGFuY2Ugb2YgRGV2aWNlUGNpIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0Rl
dmljZVBjaSgpICgqRGV2aWNlUGNpLCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZVBjaQor
CQl4YyBDLmxpYnhsX2RldmljZV9wY2kKKwkpCisKKwlDLmxpYnhsX2RldmljZV9wY2lfaW5pdCgm
eGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5p
bCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlUGNpKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcGNpKSBlcnJvciB7CiAJeC5GdW5jID0gYnl0ZSh4Yy5f
ZnVuYykKIAl4LkRldiA9IGJ5dGUoeGMuZGV2KQpAQCAtMTg3NCw2ICsyMjYwLDIyIEBAIGZ1bmMg
KHggKkRldmljZVBjaSkgdG9DKHhjICpDLmxpYnhsX2RldmljZV9wY2kpIChlcnIgZXJyb3IpIHsK
IAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RldmljZVJkbSByZXR1cm5zIGFuIGluc3RhbmNlIG9m
IERldmljZVJkbSBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VSZG0o
KSAoKkRldmljZVJkbSwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBEZXZpY2VSZG0KKwkJeGMgQy5s
aWJ4bF9kZXZpY2VfcmRtCisJKQorCisJQy5saWJ4bF9kZXZpY2VfcmRtX2luaXQoJnhjKQorCisJ
aWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgor
CX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVJkbSkgZnJvbUMoeGMg
KkMubGlieGxfZGV2aWNlX3JkbSkgZXJyb3IgewogCXguU3RhcnQgPSB1aW50NjQoeGMuc3RhcnQp
CiAJeC5TaXplID0gdWludDY0KHhjLnNpemUpCkBAIC0xODk2LDYgKzIyOTgsMjIgQEAgZnVuYyAo
eCAqRGV2aWNlUmRtKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3JkbSkgKGVyciBlcnJvcikgewog
CXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlVXNiY3RybCByZXR1cm5zIGFuIGluc3RhbmNl
IG9mIERldmljZVVzYmN0cmwgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RGV2
aWNlVXNiY3RybCgpICgqRGV2aWNlVXNiY3RybCwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBEZXZp
Y2VVc2JjdHJsCisJCXhjIEMubGlieGxfZGV2aWNlX3VzYmN0cmwKKwkpCisKKwlDLmxpYnhsX2Rl
dmljZV91c2JjdHJsX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1
bmMgKHggKkRldmljZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JjdHJsKSBl
cnJvciB7CiAJeC5UeXBlID0gVXNiY3RybFR5cGUoeGMuX3R5cGUpCiAJeC5EZXZpZCA9IERldmlk
KHhjLmRldmlkKQpAQCAtMTkyNiw2ICsyMzQ0LDIzIEBAIGZ1bmMgKHggKkRldmljZVVzYmN0cmwp
IHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiY3RybCkgKGVyciBlcnJvcikgewogCXJldHVybiBu
aWwKIH0KIAorLy8gTmV3RGV2aWNlVXNiZGV2IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNl
VXNiZGV2IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RldmljZVVzYmRldih1
dHlwZSBVc2JkZXZUeXBlKSAoKkRldmljZVVzYmRldiwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBE
ZXZpY2VVc2JkZXYKKwkJeGMgQy5saWJ4bF9kZXZpY2VfdXNiZGV2CisJKQorCisJQy5saWJ4bF9k
ZXZpY2VfdXNiZGV2X2luaXQoJnhjKQorCUMubGlieGxfZGV2aWNlX3VzYmRldl9pbml0X3R5cGUo
JnhjLCBDLmxpYnhsX3VzYmRldl90eXBlKHV0eXBlKSkKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4
Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VVc2JkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91
c2JkZXYpIGVycm9yIHsKIAl4LkN0cmwgPSBEZXZpZCh4Yy5jdHJsKQogCXguUG9ydCA9IGludCh4
Yy5wb3J0KQpAQCAtMTk4Myw2ICsyNDE4LDIyIEBAIGZ1bmMgKHggKkRldmljZVVzYmRldikgdG9D
KHhjICpDLmxpYnhsX2RldmljZV91c2JkZXYpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9
CiAKKy8vIE5ld0RldmljZUR0ZGV2IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlRHRkZXYg
aW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RGV2aWNlRHRkZXYoKSAoKkRldmlj
ZUR0ZGV2LCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZUR0ZGV2CisJCXhjIEMubGlieGxf
ZGV2aWNlX2R0ZGV2CisJKQorCisJQy5saWJ4bF9kZXZpY2VfZHRkZXZfaW5pdCgmeGMpCisKKwlp
ZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJ
fQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlRHRkZXYpIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV9kdGRldikgZXJyb3IgewogCXguUGF0aCA9IEMuR29TdHJpbmcoeGMu
cGF0aCkKIApAQCAtMjAwMyw2ICsyNDU0LDIyIEBAIGZ1bmMgKHggKkRldmljZUR0ZGV2KSB0b0Mo
eGMgKkMubGlieGxfZGV2aWNlX2R0ZGV2KSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQog
CisvLyBOZXdEZXZpY2VWdHBtIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlVnRwbSBpbml0
aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VWdHBtKCkgKCpEZXZpY2VWdHBt
LCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZVZ0cG0KKwkJeGMgQy5saWJ4bF9kZXZpY2Vf
dnRwbQorCSkKKworCUMubGlieGxfZGV2aWNlX3Z0cG1faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0g
eC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0
dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlVnRwbSkgZnJvbUMoeGMgKkMubGlieGxf
ZGV2aWNlX3Z0cG0pIGVycm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRf
ZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1l
KQpAQCAtMjAzMyw2ICsyNTAwLDIyIEBAIGZ1bmMgKHggKkRldmljZVZ0cG0pIHRvQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfdnRwbSkgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3
RGV2aWNlUDkgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VQOSBpbml0aWFsaXplZCB3aXRo
IGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VQOSgpICgqRGV2aWNlUDksIGVycm9yKSB7CisJdmFy
ICgKKwkJeCAgRGV2aWNlUDkKKwkJeGMgQy5saWJ4bF9kZXZpY2VfcDkKKwkpCisKKwlDLmxpYnhs
X2RldmljZV9wOV9pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5j
ICh4ICpEZXZpY2VQOSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3A5KSBlcnJvciB7CiAJeC5C
YWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUg
PSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTIwNjksNiArMjU1MiwyMiBAQCBm
dW5jICh4ICpEZXZpY2VQOSkgdG9DKHhjICpDLmxpYnhsX2RldmljZV9wOSkgKGVyciBlcnJvcikg
ewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlUHZjYWxsc2lmIHJldHVybnMgYW4gaW5z
dGFuY2Ugb2YgRGV2aWNlUHZjYWxsc2lmIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5j
IE5ld0RldmljZVB2Y2FsbHNpZigpICgqRGV2aWNlUHZjYWxsc2lmLCBlcnJvcikgeworCXZhciAo
CisJCXggIERldmljZVB2Y2FsbHNpZgorCQl4YyBDLmxpYnhsX2RldmljZV9wdmNhbGxzaWYKKwkp
CisKKwlDLmxpYnhsX2RldmljZV9wdmNhbGxzaWZfaW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5m
cm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJu
ICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlUHZjYWxsc2lmKSBmcm9tQyh4YyAqQy5saWJ4
bF9kZXZpY2VfcHZjYWxsc2lmKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5i
YWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRf
ZG9tbmFtZSkKQEAgLTIwOTMsNiArMjU5MiwyMyBAQCBmdW5jICh4ICpEZXZpY2VQdmNhbGxzaWYp
IHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdEZXZpY2VDaGFubmVsIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2
aWNlQ2hhbm5lbCBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VDaGFu
bmVsKGNvbm5lY3Rpb24gQ2hhbm5lbENvbm5lY3Rpb24pICgqRGV2aWNlQ2hhbm5lbCwgZXJyb3Ip
IHsKKwl2YXIgKAorCQl4ICBEZXZpY2VDaGFubmVsCisJCXhjIEMubGlieGxfZGV2aWNlX2NoYW5u
ZWwKKwkpCisKKwlDLmxpYnhsX2RldmljZV9jaGFubmVsX2luaXQoJnhjKQorCUMubGlieGxfZGV2
aWNlX2NoYW5uZWxfaW5pdF9jb25uZWN0aW9uKCZ4YywgQy5saWJ4bF9jaGFubmVsX2Nvbm5lY3Rp
b24oY29ubmVjdGlvbikpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAq
RGV2aWNlQ2hhbm5lbCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX2NoYW5uZWwpIGVycm9yIHsK
IAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9t
bmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtMjE1OCw2ICsyNjc0LDIy
IEBAIGZ1bmMgKHggKkRldmljZUNoYW5uZWwpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfY2hhbm5l
bCkgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3Q29ubmVjdG9yUGFyYW0g
cmV0dXJucyBhbiBpbnN0YW5jZSBvZiBDb25uZWN0b3JQYXJhbSBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgorZnVuYyBOZXdDb25uZWN0b3JQYXJhbSgpICgqQ29ubmVjdG9yUGFyYW0sIGVycm9y
KSB7CisJdmFyICgKKwkJeCAgQ29ubmVjdG9yUGFyYW0KKwkJeGMgQy5saWJ4bF9jb25uZWN0b3Jf
cGFyYW0KKwkpCisKKwlDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbV9pbml0KCZ4YykKKworCWlmIGVy
ciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisK
KwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpDb25uZWN0b3JQYXJhbSkgZnJvbUMoeGMg
KkMubGlieGxfY29ubmVjdG9yX3BhcmFtKSBlcnJvciB7CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJp
bmcoeGMudW5pcXVlX2lkKQogCXguV2lkdGggPSB1aW50MzIoeGMud2lkdGgpCkBAIC0yMTgyLDYg
KzI3MTQsMjIgQEAgZnVuYyAoeCAqQ29ubmVjdG9yUGFyYW0pIHRvQyh4YyAqQy5saWJ4bF9jb25u
ZWN0b3JfcGFyYW0pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0Rldmlj
ZVZkaXNwbCByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERldmljZVZkaXNwbCBpbml0aWFsaXplZCB3
aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VWZGlzcGwoKSAoKkRldmljZVZkaXNwbCwgZXJy
b3IpIHsKKwl2YXIgKAorCQl4ICBEZXZpY2VWZGlzcGwKKwkJeGMgQy5saWJ4bF9kZXZpY2VfdmRp
c3BsCisJKQorCisJQy5saWJ4bF9kZXZpY2VfdmRpc3BsX2luaXQoJnhjKQorCisJaWYgZXJyIDo9
IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJl
dHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZkaXNwbCkgZnJvbUMoeGMgKkMubGli
eGxfZGV2aWNlX3ZkaXNwbCkgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFj
a2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2Rv
bW5hbWUpCkBAIC0yMjI2LDYgKzI3NzQsMjIgQEAgZnVuYyAoeCAqRGV2aWNlVmRpc3BsKSB0b0Mo
eGMgKkMubGlieGxfZGV2aWNlX3ZkaXNwbCkgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3VnNuZFBhcmFtcyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZzbmRQYXJhbXMgaW5p
dGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VnNuZFBhcmFtcygpICgqVnNuZFBhcmFt
cywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWc25kUGFyYW1zCisJCXhjIEMubGlieGxfdnNuZF9w
YXJhbXMKKwkpCisKKwlDLmxpYnhsX3ZzbmRfcGFyYW1zX2luaXQoJnhjKQorCisJaWYgZXJyIDo9
IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJl
dHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZzbmRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhs
X3ZzbmRfcGFyYW1zKSBlcnJvciB7CiAJbnVtU2FtcGxlUmF0ZXMgOj0gaW50KHhjLm51bV9zYW1w
bGVfcmF0ZXMpCiAJY1NhbXBsZVJhdGVzIDo9ICgqWzEgPDwgMjhdQy51aW50MzJfdCkodW5zYWZl
LlBvaW50ZXIoeGMuc2FtcGxlX3JhdGVzKSlbOm51bVNhbXBsZVJhdGVzOm51bVNhbXBsZVJhdGVz
XQpAQCAtMjI3Niw2ICsyODQwLDIyIEBAIGZ1bmMgKHggKlZzbmRQYXJhbXMpIHRvQyh4YyAqQy5s
aWJ4bF92c25kX3BhcmFtcykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3
VnNuZFN0cmVhbSByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZzbmRTdHJlYW0gaW5pdGlhbGl6ZWQg
d2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VnNuZFN0cmVhbSgpICgqVnNuZFN0cmVhbSwgZXJyb3Ip
IHsKKwl2YXIgKAorCQl4ICBWc25kU3RyZWFtCisJCXhjIEMubGlieGxfdnNuZF9zdHJlYW0KKwkp
CisKKwlDLmxpYnhsX3ZzbmRfc3RyZWFtX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMo
JnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwg
bmlsCit9CisKIGZ1bmMgKHggKlZzbmRTdHJlYW0pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfc3Ry
ZWFtKSBlcnJvciB7CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQogCXgu
VHlwZSA9IFZzbmRTdHJlYW1UeXBlKHhjLl90eXBlKQpAQCAtMjMwNCw2ICsyODg0LDIyIEBAIGZ1
bmMgKHggKlZzbmRTdHJlYW0pIHRvQyh4YyAqQy5saWJ4bF92c25kX3N0cmVhbSkgKGVyciBlcnJv
cikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3VnNuZFBjbSByZXR1cm5zIGFuIGluc3RhbmNl
IG9mIFZzbmRQY20gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VnNuZFBjbSgp
ICgqVnNuZFBjbSwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWc25kUGNtCisJCXhjIEMubGlieGxf
dnNuZF9wY20KKwkpCisKKwlDLmxpYnhsX3ZzbmRfcGNtX2luaXQoJnhjKQorCisJaWYgZXJyIDo9
IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJl
dHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZzbmRQY20pIGZyb21DKHhjICpDLmxpYnhsX3Zz
bmRfcGNtKSBlcnJvciB7CiAJeC5OYW1lID0gQy5Hb1N0cmluZyh4Yy5uYW1lKQogCWlmIGVyciA6
PSB4LlBhcmFtcy5mcm9tQygmeGMucGFyYW1zKTsgZXJyICE9IG5pbCB7CkBAIC0yMzQ4LDYgKzI5
NDQsMjIgQEAgZnVuYyAoeCAqVnNuZFBjbSkgdG9DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSAoZXJy
IGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdEZXZpY2VWc25kIHJldHVybnMgYW4g
aW5zdGFuY2Ugb2YgRGV2aWNlVnNuZCBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBO
ZXdEZXZpY2VWc25kKCkgKCpEZXZpY2VWc25kLCBlcnJvcikgeworCXZhciAoCisJCXggIERldmlj
ZVZzbmQKKwkJeGMgQy5saWJ4bF9kZXZpY2VfdnNuZAorCSkKKworCUMubGlieGxfZGV2aWNlX3Zz
bmRfaW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2
aWNlVnNuZCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZzbmQpIGVycm9yIHsKIAl4LkJhY2tl
bmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMu
R29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtMjQwNCw2ICszMDE2LDIyIEBAIGZ1bmMg
KHggKkRldmljZVZzbmQpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdnNuZCkgKGVyciBlcnJvcikg
ewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RG9tYWluQ29uZmlnIHJldHVybnMgYW4gaW5zdGFu
Y2Ugb2YgRG9tYWluQ29uZmlnIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0Rv
bWFpbkNvbmZpZygpICgqRG9tYWluQ29uZmlnLCBlcnJvcikgeworCXZhciAoCisJCXggIERvbWFp
bkNvbmZpZworCQl4YyBDLmxpYnhsX2RvbWFpbl9jb25maWcKKwkpCisKKwlDLmxpYnhsX2RvbWFp
bl9jb25maWdfaW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAo
eCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJvciB7
CiAJaWYgZXJyIDo9IHguQ0luZm8uZnJvbUMoJnhjLmNfaW5mbyk7IGVyciAhPSBuaWwgewogCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDSW5mbzogJXYiLCBlcnIpCkBAIC0y
NzEyLDYgKzMzNDAsMjIgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxf
ZG9tYWluX2NvbmZpZykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGlz
a2luZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEaXNraW5mbyBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgorZnVuYyBOZXdEaXNraW5mbygpICgqRGlza2luZm8sIGVycm9yKSB7CisJdmFyICgK
KwkJeCAgRGlza2luZm8KKwkJeGMgQy5saWJ4bF9kaXNraW5mbworCSkKKworCUMubGlieGxfZGlz
a2luZm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAq
RGlza2luZm8pIGZyb21DKHhjICpDLmxpYnhsX2Rpc2tpbmZvKSBlcnJvciB7CiAJeC5CYWNrZW5k
ID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQogCXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tl
bmRfaWQpCkBAIC0yNzQ4LDYgKzMzOTIsMjIgQEAgZnVuYyAoeCAqRGlza2luZm8pIHRvQyh4YyAq
Qy5saWJ4bF9kaXNraW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3
TmljaW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIE5pY2luZm8gaW5pdGlhbGl6ZWQgd2l0aCBk
ZWZhdWx0cy4KK2Z1bmMgTmV3TmljaW5mbygpICgqTmljaW5mbywgZXJyb3IpIHsKKwl2YXIgKAor
CQl4ICBOaWNpbmZvCisJCXhjIEMubGlieGxfbmljaW5mbworCSkKKworCUMubGlieGxfbmljaW5m
b19pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQly
ZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpOaWNp
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9uaWNpbmZvKSBlcnJvciB7CiAJeC5CYWNrZW5kID0gQy5H
b1N0cmluZyh4Yy5iYWNrZW5kKQogCXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQp
CkBAIC0yNzg2LDYgKzM0NDYsMjIgQEAgZnVuYyAoeCAqTmljaW5mbykgdG9DKHhjICpDLmxpYnhs
X25pY2luZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1Z0cG1pbmZv
IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVnRwbWluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0
cy4KK2Z1bmMgTmV3VnRwbWluZm8oKSAoKlZ0cG1pbmZvLCBlcnJvcikgeworCXZhciAoCisJCXgg
IFZ0cG1pbmZvCisJCXhjIEMubGlieGxfdnRwbWluZm8KKwkpCisKKwlDLmxpYnhsX3Z0cG1pbmZv
X2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZ0cG1p
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92dHBtaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMu
R29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lk
KQpAQCAtMjgyOCw2ICszNTA0LDIyIEBAIGZ1bmMgKHggKlZ0cG1pbmZvKSB0b0MoeGMgKkMubGli
eGxfdnRwbWluZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1VzYmN0
cmxpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVXNiY3RybGluZm8gaW5pdGlhbGl6ZWQgd2l0
aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VXNiY3RybGluZm8oKSAoKlVzYmN0cmxpbmZvLCBlcnJvcikg
eworCXZhciAoCisJCXggIFVzYmN0cmxpbmZvCisJCXhjIEMubGlieGxfdXNiY3RybGluZm8KKwkp
CisKKwlDLmxpYnhsX3VzYmN0cmxpbmZvX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMo
JnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwg
bmlsCit9CisKIGZ1bmMgKHggKlVzYmN0cmxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF91c2JjdHJs
aW5mbykgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90eXBlKQogCXguRGV2aWQg
PSBEZXZpZCh4Yy5kZXZpZCkKQEAgLTI4NzIsNiArMzU2NCwyMiBAQCBmdW5jICh4ICpVc2JjdHJs
aW5mbykgdG9DKHhjICpDLmxpYnhsX3VzYmN0cmxpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdWY3B1aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZjcHVpbmZv
IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZjcHVpbmZvKCkgKCpWY3B1aW5m
bywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWY3B1aW5mbworCQl4YyBDLmxpYnhsX3ZjcHVpbmZv
CisJKQorCisJQy5saWJ4bF92Y3B1aW5mb19pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21D
KCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngs
IG5pbAorfQorCiBmdW5jICh4ICpWY3B1aW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmNwdWluZm8p
IGVycm9yIHsKIAl4LlZjcHVpZCA9IHVpbnQzMih4Yy52Y3B1aWQpCiAJeC5DcHUgPSB1aW50MzIo
eGMuY3B1KQpAQCAtMjkxMiw2ICszNjIwLDIyIEBAIGZ1bmMgKHggKlZjcHVpbmZvKSB0b0MoeGMg
KkMubGlieGxfdmNwdWluZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5l
d1BoeXNpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUGh5c2luZm8gaW5pdGlhbGl6ZWQgd2l0
aCBkZWZhdWx0cy4KK2Z1bmMgTmV3UGh5c2luZm8oKSAoKlBoeXNpbmZvLCBlcnJvcikgeworCXZh
ciAoCisJCXggIFBoeXNpbmZvCisJCXhjIEMubGlieGxfcGh5c2luZm8KKwkpCisKKwlDLmxpYnhs
X3BoeXNpbmZvX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMg
KHggKlBoeXNpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9waHlzaW5mbykgZXJyb3IgewogCXguVGhy
ZWFkc1BlckNvcmUgPSB1aW50MzIoeGMudGhyZWFkc19wZXJfY29yZSkKIAl4LkNvcmVzUGVyU29j
a2V0ID0gdWludDMyKHhjLmNvcmVzX3Blcl9zb2NrZXQpCkBAIC0yOTcyLDYgKzM2OTYsMjIgQEAg
ZnVuYyAoeCAqUGh5c2luZm8pIHRvQyh4YyAqQy5saWJ4bF9waHlzaW5mbykgKGVyciBlcnJvcikg
ewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3Q29ubmVjdG9yaW5mbyByZXR1cm5zIGFuIGluc3Rh
bmNlIG9mIENvbm5lY3RvcmluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3
Q29ubmVjdG9yaW5mbygpICgqQ29ubmVjdG9yaW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBD
b25uZWN0b3JpbmZvCisJCXhjIEMubGlieGxfY29ubmVjdG9yaW5mbworCSkKKworCUMubGlieGxf
Y29ubmVjdG9yaW5mb19pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBm
dW5jICh4ICpDb25uZWN0b3JpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JpbmZvKSBl
cnJvciB7CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQogCXguV2lkdGgg
PSB1aW50MzIoeGMud2lkdGgpCkBAIC0zMDA0LDYgKzM3NDQsMjIgQEAgZnVuYyAoeCAqQ29ubmVj
dG9yaW5mbykgdG9DKHhjICpDLmxpYnhsX2Nvbm5lY3RvcmluZm8pIChlcnIgZXJyb3IpIHsKIAly
ZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1ZkaXNwbGluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBW
ZGlzcGxpbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZkaXNwbGluZm8o
KSAoKlZkaXNwbGluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgVmRpc3BsaW5mbworCQl4YyBD
LmxpYnhsX3ZkaXNwbGluZm8KKwkpCisKKwlDLmxpYnhsX3ZkaXNwbGluZm9faW5pdCgmeGMpCisK
KwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJy
CisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMo
eGMgKkMubGlieGxfdmRpc3BsaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmco
eGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMzA1
Niw2ICszODEyLDIyIEBAIGZ1bmMgKHggKlZkaXNwbGluZm8pIHRvQyh4YyAqQy5saWJ4bF92ZGlz
cGxpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdTdHJlYW1pbmZv
IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgU3RyZWFtaW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1
bHRzLgorZnVuYyBOZXdTdHJlYW1pbmZvKCkgKCpTdHJlYW1pbmZvLCBlcnJvcikgeworCXZhciAo
CisJCXggIFN0cmVhbWluZm8KKwkJeGMgQy5saWJ4bF9zdHJlYW1pbmZvCisJKQorCisJQy5saWJ4
bF9zdHJlYW1pbmZvX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1
bmMgKHggKlN0cmVhbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3N0cmVhbWluZm8pIGVycm9yIHsK
IAl4LlJlcUV2dGNoID0gaW50KHhjLnJlcV9ldnRjaCkKIAl4LlJlcVJyZWYgPSBpbnQoeGMucmVx
X3JyZWYpCkBAIC0zMDc2LDYgKzM4NDgsMjIgQEAgZnVuYyAoeCAqU3RyZWFtaW5mbykgdG9DKHhj
ICpDLmxpYnhsX3N0cmVhbWluZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8v
IE5ld1BjbWluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBQY21pbmZvIGluaXRpYWxpemVkIHdp
dGggZGVmYXVsdHMuCitmdW5jIE5ld1BjbWluZm8oKSAoKlBjbWluZm8sIGVycm9yKSB7CisJdmFy
ICgKKwkJeCAgUGNtaW5mbworCQl4YyBDLmxpYnhsX3BjbWluZm8KKwkpCisKKwlDLmxpYnhsX3Bj
bWluZm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAq
UGNtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfcGNtaW5mbykgZXJyb3IgewogCW51bVZzbmRTdHJl
YW1zIDo9IGludCh4Yy5udW1fdnNuZF9zdHJlYW1zKQogCWNTdHJlYW1zIDo9ICgqWzEgPDwgMjhd
Qy5saWJ4bF9zdHJlYW1pbmZvKSh1bnNhZmUuUG9pbnRlcih4Yy5zdHJlYW1zKSlbOm51bVZzbmRT
dHJlYW1zOm51bVZzbmRTdHJlYW1zXQpAQCAtMzExMCw2ICszODk4LDIyIEBAIGZ1bmMgKHggKlBj
bWluZm8pIHRvQyh4YyAqQy5saWJ4bF9wY21pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5p
bAogfQogCisvLyBOZXdWc25kaW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZzbmRpbmZvIGlu
aXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZzbmRpbmZvKCkgKCpWc25kaW5mbywg
ZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWc25kaW5mbworCQl4YyBDLmxpYnhsX3ZzbmRpbmZvCisJ
KQorCisJQy5saWJ4bF92c25kaW5mb19pbml0KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4
Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5p
bAorfQorCiBmdW5jICh4ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8pIGVy
cm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQg
PSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTMxNjAsNiArMzk2NCwyMiBAQCBmdW5jICh4ICpW
c25kaW5mbykgdG9DKHhjICpDLmxpYnhsX3ZzbmRpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdWa2JpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVmtiaW5mbyBp
bml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdWa2JpbmZvKCkgKCpWa2JpbmZvLCBl
cnJvcikgeworCXZhciAoCisJCXggIFZrYmluZm8KKwkJeGMgQy5saWJ4bF92a2JpbmZvCisJKQor
CisJQy5saWJ4bF92a2JpbmZvX2luaXQoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9
CisKIGZ1bmMgKHggKlZrYmluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZrYmluZm8pIGVycm9yIHsK
IAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50
MzIoeGMuYmFja2VuZF9pZCkKQEAgLTMxOTYsNiArNDAxNiwyMiBAQCBmdW5jICh4ICpWa2JpbmZv
KSB0b0MoeGMgKkMubGlieGxfdmtiaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3TnVtYWluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBOdW1haW5mbyBpbml0aWFs
aXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdOdW1haW5mbygpICgqTnVtYWluZm8sIGVycm9y
KSB7CisJdmFyICgKKwkJeCAgTnVtYWluZm8KKwkJeGMgQy5saWJ4bF9udW1haW5mbworCSkKKwor
CUMubGlieGxfbnVtYWluZm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30K
KwogZnVuYyAoeCAqTnVtYWluZm8pIGZyb21DKHhjICpDLmxpYnhsX251bWFpbmZvKSBlcnJvciB7
CiAJeC5TaXplID0gdWludDY0KHhjLnNpemUpCiAJeC5GcmVlID0gdWludDY0KHhjLmZyZWUpCkBA
IC0zMjMwLDYgKzQwNjYsMjIgQEAgZnVuYyAoeCAqTnVtYWluZm8pIHRvQyh4YyAqQy5saWJ4bF9u
dW1haW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3Q3B1dG9wb2xv
Z3kgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBDcHV0b3BvbG9neSBpbml0aWFsaXplZCB3aXRoIGRl
ZmF1bHRzLgorZnVuYyBOZXdDcHV0b3BvbG9neSgpICgqQ3B1dG9wb2xvZ3ksIGVycm9yKSB7CisJ
dmFyICgKKwkJeCAgQ3B1dG9wb2xvZ3kKKwkJeGMgQy5saWJ4bF9jcHV0b3BvbG9neQorCSkKKwor
CUMubGlieGxfY3B1dG9wb2xvZ3lfaW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwK
K30KKwogZnVuYyAoeCAqQ3B1dG9wb2xvZ3kpIGZyb21DKHhjICpDLmxpYnhsX2NwdXRvcG9sb2d5
KSBlcnJvciB7CiAJeC5Db3JlID0gdWludDMyKHhjLmNvcmUpCiAJeC5Tb2NrZXQgPSB1aW50MzIo
eGMuc29ja2V0KQpAQCAtMzI1Miw2ICs0MTA0LDIyIEBAIGZ1bmMgKHggKkNwdXRvcG9sb2d5KSB0
b0MoeGMgKkMubGlieGxfY3B1dG9wb2xvZ3kpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9
CiAKKy8vIE5ld1BjaXRvcG9sb2d5IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUGNpdG9wb2xvZ3kg
aW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3UGNpdG9wb2xvZ3koKSAoKlBjaXRv
cG9sb2d5LCBlcnJvcikgeworCXZhciAoCisJCXggIFBjaXRvcG9sb2d5CisJCXhjIEMubGlieGxf
cGNpdG9wb2xvZ3kKKwkpCisKKwlDLmxpYnhsX3BjaXRvcG9sb2d5X2luaXQoJnhjKQorCisJaWYg
ZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0K
KworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlBjaXRvcG9sb2d5KSBmcm9tQyh4YyAq
Qy5saWJ4bF9wY2l0b3BvbG9neSkgZXJyb3IgewogCXguU2VnID0gdWludDE2KHhjLnNlZykKIAl4
LkJ1cyA9IGJ5dGUoeGMuYnVzKQpAQCAtMzI3Niw2ICs0MTQ0LDIyIEBAIGZ1bmMgKHggKlBjaXRv
cG9sb2d5KSB0b0MoeGMgKkMubGlieGxfcGNpdG9wb2xvZ3kpIChlcnIgZXJyb3IpIHsKIAlyZXR1
cm4gbmlsCiB9CiAKKy8vIE5ld1NjaGVkQ3JlZGl0UGFyYW1zIHJldHVybnMgYW4gaW5zdGFuY2Ug
b2YgU2NoZWRDcmVkaXRQYXJhbXMgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3
U2NoZWRDcmVkaXRQYXJhbXMoKSAoKlNjaGVkQ3JlZGl0UGFyYW1zLCBlcnJvcikgeworCXZhciAo
CisJCXggIFNjaGVkQ3JlZGl0UGFyYW1zCisJCXhjIEMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFt
cworCSkKKworCUMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtc19pbml0KCZ4YykKKworCWlmIGVy
ciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisK
KwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykgZnJvbUMo
eGMgKkMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtcykgZXJyb3IgewogCXguVHNsaWNlTXMgPSBp
bnQoeGMudHNsaWNlX21zKQogCXguUmF0ZWxpbWl0VXMgPSBpbnQoeGMucmF0ZWxpbWl0X3VzKQpA
QCAtMzI5Miw2ICs0MTc2LDIyIEBAIGZ1bmMgKHggKlNjaGVkQ3JlZGl0UGFyYW1zKSB0b0MoeGMg
KkMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtcykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwK
IH0KIAorLy8gTmV3U2NoZWRDcmVkaXQyUGFyYW1zIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgU2No
ZWRDcmVkaXQyUGFyYW1zIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1NjaGVk
Q3JlZGl0MlBhcmFtcygpICgqU2NoZWRDcmVkaXQyUGFyYW1zLCBlcnJvcikgeworCXZhciAoCisJ
CXggIFNjaGVkQ3JlZGl0MlBhcmFtcworCQl4YyBDLmxpYnhsX3NjaGVkX2NyZWRpdDJfcGFyYW1z
CisJKQorCisJQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFtc19pbml0KCZ4YykKKworCWlmIGVy
ciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisK
KwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpTY2hlZENyZWRpdDJQYXJhbXMpIGZyb21D
KHhjICpDLmxpYnhsX3NjaGVkX2NyZWRpdDJfcGFyYW1zKSBlcnJvciB7CiAJeC5SYXRlbGltaXRV
cyA9IGludCh4Yy5yYXRlbGltaXRfdXMpCiAKQEAgLTMzMDQsNiArNDIwNCwyMiBAQCBmdW5jICh4
ICpTY2hlZENyZWRpdDJQYXJhbXMpIHRvQyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFt
cykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RG9tYWluUmVtdXNJbmZv
IHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRG9tYWluUmVtdXNJbmZvIGluaXRpYWxpemVkIHdpdGgg
ZGVmYXVsdHMuCitmdW5jIE5ld0RvbWFpblJlbXVzSW5mbygpICgqRG9tYWluUmVtdXNJbmZvLCBl
cnJvcikgeworCXZhciAoCisJCXggIERvbWFpblJlbXVzSW5mbworCQl4YyBDLmxpYnhsX2RvbWFp
bl9yZW11c19pbmZvCisJKQorCisJQy5saWJ4bF9kb21haW5fcmVtdXNfaW5mb19pbml0KCZ4YykK
KworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBl
cnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpEb21haW5SZW11c0luZm8p
IGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvKSBlcnJvciB7CiAJeC5JbnRlcnZh
bCA9IGludCh4Yy5pbnRlcnZhbCkKIAlpZiBlcnIgOj0geC5BbGxvd1Vuc2FmZS5mcm9tQygmeGMu
YWxsb3dfdW5zYWZlKTsgZXJyICE9IG5pbCB7CkBAIC0zMzY4LDYgKzQyODQsMjMgQEAgZnVuYyAo
eCAqRG9tYWluUmVtdXNJbmZvKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIChl
cnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0V2ZW50IHJldHVybnMgYW4gaW5z
dGFuY2Ugb2YgRXZlbnQgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RXZlbnQo
ZXR5cGUgRXZlbnRUeXBlKSAoKkV2ZW50LCBlcnJvcikgeworCXZhciAoCisJCXggIEV2ZW50CisJ
CXhjIEMubGlieGxfZXZlbnQKKwkpCisKKwlDLmxpYnhsX2V2ZW50X2luaXQoJnhjKQorCUMubGli
eGxfZXZlbnRfaW5pdF90eXBlKCZ4YywgQy5saWJ4bF9ldmVudF90eXBlKGV0eXBlKSkKKworCWlm
IGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9
CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpFdmVudCkgZnJvbUMoeGMgKkMubGli
eGxfZXZlbnQpIGVycm9yIHsKIAlpZiBlcnIgOj0geC5MaW5rLmZyb21DKCZ4Yy5saW5rKTsgZXJy
ICE9IG5pbCB7CiAJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIExpbms6ICV2
IiwgZXJyKQpAQCAtMzM3OSw2ICs0MzEyLDEyIEBAIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAq
Qy5saWJ4bF9ldmVudCkgZXJyb3IgewogCXguRm9yVXNlciA9IHVpbnQ2NCh4Yy5mb3JfdXNlcikK
IAl4LlR5cGUgPSBFdmVudFR5cGUoeGMuX3R5cGUpCiAJc3dpdGNoIHguVHlwZSB7CisJY2FzZSBF
dmVudFR5cGVPcGVyYXRpb25Db21wbGV0ZToKKwkJdmFyIHR5cGVPcGVyYXRpb25Db21wbGV0ZSBF
dmVudFR5cGVVbmlvbk9wZXJhdGlvbkNvbXBsZXRlCisJCWlmIGVyciA6PSB0eXBlT3BlcmF0aW9u
Q29tcGxldGUuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIHR5cGVPcGVyYXRpb25Db21wbGV0ZTogJXYiLCBlcnIpCisJCX0KKwkJ
eC5UeXBlVW5pb24gPSB0eXBlT3BlcmF0aW9uQ29tcGxldGUKIAljYXNlIEV2ZW50VHlwZURvbWFp
blNodXRkb3duOgogCQl2YXIgdHlwZURvbWFpblNodXRkb3duIEV2ZW50VHlwZVVuaW9uRG9tYWlu
U2h1dGRvd24KIAkJaWYgZXJyIDo9IHR5cGVEb21haW5TaHV0ZG93bi5mcm9tQyh4Yyk7IGVyciAh
PSBuaWwgewpAQCAtMzM5MSwxMiArNDMzMCw2IEBAIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAq
Qy5saWJ4bF9ldmVudCkgZXJyb3IgewogCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgdHlwZURpc2tFamVjdDogJXYiLCBlcnIpCiAJCX0KIAkJeC5UeXBlVW5pb24gPSB0eXBl
RGlza0VqZWN0Ci0JY2FzZSBFdmVudFR5cGVPcGVyYXRpb25Db21wbGV0ZToKLQkJdmFyIHR5cGVP
cGVyYXRpb25Db21wbGV0ZSBFdmVudFR5cGVVbmlvbk9wZXJhdGlvbkNvbXBsZXRlCi0JCWlmIGVy
ciA6PSB0eXBlT3BlcmF0aW9uQ29tcGxldGUuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVPcGVyYXRpb25Db21wbGV0ZTog
JXYiLCBlcnIpCi0JCX0KLQkJeC5UeXBlVW5pb24gPSB0eXBlT3BlcmF0aW9uQ29tcGxldGUKIAlk
ZWZhdWx0OgogCQlyZXR1cm4gZm10LkVycm9yZigiaW52YWxpZCB1bmlvbiBrZXkgJyV2JyIsIHgu
VHlwZSkKIAl9CkBAIC0zNDkzLDYgKzQ0MjYsMjIgQEAgZnVuYyAoeCAqRXZlbnQpIHRvQyh4YyAq
Qy5saWJ4bF9ldmVudCkgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3UHNy
Q2F0SW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFBzckNhdEluZm8gaW5pdGlhbGl6ZWQgd2l0
aCBkZWZhdWx0cy4KK2Z1bmMgTmV3UHNyQ2F0SW5mbygpICgqUHNyQ2F0SW5mbywgZXJyb3IpIHsK
Kwl2YXIgKAorCQl4ICBQc3JDYXRJbmZvCisJCXhjIEMubGlieGxfcHNyX2NhdF9pbmZvCisJKQor
CisJQy5saWJ4bF9wc3JfY2F0X2luZm9faW5pdCgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygm
eGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBu
aWwKK30KKwogZnVuYyAoeCAqUHNyQ2F0SW5mbykgZnJvbUMoeGMgKkMubGlieGxfcHNyX2NhdF9p
bmZvKSBlcnJvciB7CiAJeC5JZCA9IHVpbnQzMih4Yy5pZCkKIAl4LkNvc01heCA9IHVpbnQzMih4
Yy5jb3NfbWF4KQpAQCAtMzUxNywyMiArNDQ2NiwzOSBAQCBmdW5jICh4ICpQc3JDYXRJbmZvKSB0
b0MoeGMgKkMubGlieGxfcHNyX2NhdF9pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAog
fQogCisvLyBOZXdQc3JId0luZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBQc3JId0luZm8gaW5p
dGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3UHNySHdJbmZvKHB0eXBlIFBzckZlYXRU
eXBlKSAoKlBzckh3SW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBQc3JId0luZm8KKwkJeGMg
Qy5saWJ4bF9wc3JfaHdfaW5mbworCSkKKworCUMubGlieGxfcHNyX2h3X2luZm9faW5pdCgmeGMp
CisJQy5saWJ4bF9wc3JfaHdfaW5mb19pbml0X3R5cGUoJnhjLCBDLmxpYnhsX3Bzcl9mZWF0X3R5
cGUocHR5cGUpKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlBzckh3
SW5mbykgZnJvbUMoeGMgKkMubGlieGxfcHNyX2h3X2luZm8pIGVycm9yIHsKIAl4LklkID0gdWlu
dDMyKHhjLmlkKQogCXguVHlwZSA9IFBzckZlYXRUeXBlKHhjLl90eXBlKQogCXN3aXRjaCB4LlR5
cGUgewotCWNhc2UgUHNyRmVhdFR5cGVDYXQ6Ci0JCXZhciB0eXBlQ2F0IFBzckh3SW5mb1R5cGVV
bmlvbkNhdAotCQlpZiBlcnIgOj0gdHlwZUNhdC5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgewotCQkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgdHlwZUNhdDogJXYiLCBlcnIpCi0J
CX0KLQkJeC5UeXBlVW5pb24gPSB0eXBlQ2F0CiAJY2FzZSBQc3JGZWF0VHlwZU1iYToKIAkJdmFy
IHR5cGVNYmEgUHNySHdJbmZvVHlwZVVuaW9uTWJhCiAJCWlmIGVyciA6PSB0eXBlTWJhLmZyb21D
KHhjKTsgZXJyICE9IG5pbCB7CiAJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCB0eXBlTWJhOiAldiIsIGVycikKIAkJfQogCQl4LlR5cGVVbmlvbiA9IHR5cGVNYmEKKwljYXNl
IFBzckZlYXRUeXBlQ2F0OgorCQl2YXIgdHlwZUNhdCBQc3JId0luZm9UeXBlVW5pb25DYXQKKwkJ
aWYgZXJyIDo9IHR5cGVDYXQuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVDYXQ6ICV2IiwgZXJyKQorCQl9CisJCXguVHlw
ZVVuaW9uID0gdHlwZUNhdAogCWRlZmF1bHQ6CiAJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlk
IHVuaW9uIGtleSAnJXYnIiwgeC5UeXBlKQogCX0KLS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QK
WGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5v
cmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

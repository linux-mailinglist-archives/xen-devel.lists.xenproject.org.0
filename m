Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 071D3135877
	for <lists+xen-devel@lfdr.de>; Thu,  9 Jan 2020 12:51:32 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ipWIo-0000Hq-AM; Thu, 09 Jan 2020 11:48:38 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=kEnv=26=amazon.co.uk=prvs=2706230f4=pdurrant@srs-us1.protection.inumbo.net>)
 id 1ipWIn-0000Hi-2s
 for xen-devel@lists.xenproject.org; Thu, 09 Jan 2020 11:48:37 +0000
X-Inumbo-ID: f7f3dc84-32d5-11ea-b9a8-12813bfff9fa
Received: from smtp-fw-6002.amazon.com (unknown [52.95.49.90])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id f7f3dc84-32d5-11ea-b9a8-12813bfff9fa;
 Thu, 09 Jan 2020 11:48:35 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
 t=1578570516; x=1610106516;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=jyxss6pBldF+KsQbXrM8ySia03xzIwXABbl7zka5abQ=;
 b=iBP2UCoRV0xeGaT+uZON8xUSKllk+QgpWjpmctNnaRHeaRTTHAp3d3ov
 XEA5kzFTLjEF4mBF9Ia/zWmWBbD7cbqiKwuZ6MXTgxgOr8J5daYJqg9Bo
 TqUj+QFiwHHAr+j69fwpzpdY88gj0dM30iB6tGW3Qf+l8UTyxJdSQTonm w=;
IronPort-SDR: ThuL5gP4b7mPWsD0YSdzY/WOr3EWWGla063m3mi1tohkYGiAUfRyAXUrqLc1ZRH4xU1rgD6aWI
 Vqr7NrEyhNdA==
X-IronPort-AV: E=Sophos;i="5.69,413,1571702400"; d="scan'208";a="10742955"
Received: from iad12-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1e-27fb8269.us-east-1.amazon.com) ([10.43.8.6])
 by smtp-border-fw-out-6002.iad6.amazon.com with ESMTP;
 09 Jan 2020 11:48:36 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1e-27fb8269.us-east-1.amazon.com (Postfix) with ESMTPS
 id D8FBAA27DD; Thu,  9 Jan 2020 11:48:34 +0000 (UTC)
Received: from EX13D32EUB003.ant.amazon.com (10.43.166.165) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 9 Jan 2020 11:48:34 +0000
Received: from EX13MTAUWC001.ant.amazon.com (10.43.162.135) by
 EX13D32EUB003.ant.amazon.com (10.43.166.165) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 9 Jan 2020 11:48:33 +0000
Received: from u2f063a87eabd5f.cbg10.amazon.com (10.125.106.135) by
 mail-relay.amazon.com (10.43.162.232) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Thu, 9 Jan 2020 11:48:30 +0000
From: Paul Durrant <pdurrant@amazon.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 9 Jan 2020 11:48:14 +0000
Message-ID: <20200109114816.2293-5-pdurrant@amazon.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200109114816.2293-1-pdurrant@amazon.com>
References: <20200109114816.2293-1-pdurrant@amazon.com>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v2 4/6] libxl: allow creation of domains with a
 specified or random domid
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>,
 Paul Durrant <pdurrant@amazon.com>, Ian Jackson <ian.jackson@eu.citrix.com>,
 Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBwYXRjaCBhZGRzIGEgJ2RvbWlkJyBmaWVsZCB0byBsaWJ4bF9kb21haW5fY3JlYXRlX2lu
Zm8gYW5kIHRoZW4KbW9kaWZpZXMgZG9fZG9tYWluX2NyZWF0ZSgpIHRvIHVzZSB0aGF0IHZhbHVl
IGlmIGl0IGlzIHZhbGlkLiBBbnkgdmFsaWQKZG9taWQgd2lsbCBiZSBjaGVja2VkIGFnYWluc3Qg
dGhlIHJldGlyZWQgZG9taWQgbGlzdCBiZWZvcmUgYmVpbmcgcGFzc2VkCnRvIGxpYnhsX19kb21h
aW5fbWFrZSgpLgpJZiB0aGUgZG9taWQgdmFsdWUgaXMgaW52YWxpZCB0aGVuIFhlbiB3aWxsIGNo
b29zZSB0aGUgZG9taWQsIGFzIGJlZm9yZSwKdW5sZXNzIHRoZSB2YWx1ZSBpcyB0aGUgbmV3IHNw
ZWNpYWwgUkFORE9NX0RPTUlEIHZhbHVlIGFkZGVkIHRvIHRoZSBBUEkuClRoaXMgdmFsdWUgaW5z
dHJ1Y3RzIGxpYnhsX19kb21haW5fbWFrZSgpIHRvIHNlbGVjdCBhIHJhbmRvbSBkb21pZCB2YWx1
ZSwKY2hlY2sgaXQgZm9yIHZhbGlkaXR5LCB2ZXJpZnkgaXQgZG9lcyBub3QgbWF0Y2ggYSByZXRp
cmVkIGRvbWFpbiwgYW5kIHRoZW4KcGFzcyBpdCB0byBYZW4ncyBYRU5fRE9NQ1RMX2NyZWF0ZWRv
bWFpbiBvcGVyYXRpb24uIElmIFhlbiBkZXRlcm1pbmVzIHRoYXQKaXQgY28taW5jaWRlcyB3aXRo
IGFuIGV4aXN0aW5nIGRvbWFpbiwgYSBuZXcgcmFuZG9tIHZhbHVlIHdpbGwgYmUKc2VsZWN0ZWQg
YW5kIHRoZSBvcGVyYXRpb24gd2lsbCBiZSByZS10cmllZC4KCk5PVEU6IGxpYnhsX19sb2d2KCkg
aXMgYWxzbyBtb2RpZmllZCB0byBvbmx5IGxvZyB2YWxpZCBkb21pZCB2YWx1ZXMgaW4KICAgICAg
bWVzc2FnZXMgcmF0aGVyIHRoYW4gYW55IGRvbWlkLCB2YWxpZCBvciBvdGhlcndpc2UsIHRoYXQg
aXMgbm90CiAgICAgIElOVkFMSURfRE9NSUQuCgpTaWduZWQtb2ZmLWJ5OiBQYXVsIER1cnJhbnQg
PHBkdXJyYW50QGFtYXpvbi5jb20+Ci0tLQpDYzogSWFuIEphY2tzb24gPGlhbi5qYWNrc29uQGV1
LmNpdHJpeC5jb20+CkNjOiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgpDYzogQW50aG9ueSBQRVJBUkQg
PGFudGhvbnkucGVyYXJkQGNpdHJpeC5jb20+Cgp2MjoKIC0gUmUtd29ya2VkIHRvIHVzZSBhIHZh
bHVlIGZyb20gbGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvCi0tLQogdG9vbHMvbGlieGwvbGlieGwu
aCAgICAgICAgICB8ICA5ICsrKysrKysrKwogdG9vbHMvbGlieGwvbGlieGxfY3JlYXRlLmMgICB8
IDMyICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiB0b29scy9saWJ4bC9saWJ4bF9p
bnRlcm5hbC5jIHwgIDIgKy0KIHRvb2xzL2xpYnhsL2xpYnhsX3R5cGVzLmlkbCAgfCAgMSArCiA0
IGZpbGVzIGNoYW5nZWQsIDQyIGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvdG9vbHMvbGlieGwvbGlieGwuaCBiL3Rvb2xzL2xpYnhsL2xpYnhsLmgKaW5kZXggMThj
MWEyZDZiZi4uN2U2MGVlMWM4YiAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGwvbGlieGwuaAorKysg
Yi90b29scy9saWJ4bC9saWJ4bC5oCkBAIC0xMjY4LDYgKzEyNjgsMTQgQEAgdm9pZCBsaWJ4bF9t
YWNfY29weShsaWJ4bF9jdHggKmN0eCwgbGlieGxfbWFjICpkc3QsIGNvbnN0IGxpYnhsX21hYyAq
c3JjKTsKICAqLwogI2RlZmluZSBMSUJYTF9IQVZFX0RPTUFJTl9ORUVEX01FTU9SWV9DT05GSUcK
IAorLyoKKyAqIExJQlhMX0hBVkVfQ1JFQVRFSU5GT19ET01JRAorICoKKyAqIGxpYnhsX2RvbWFp
bl9jcmVhdGVfbmV3KCkgYW5kIGxpYnhsX2RvbWFpbl9jcmVhdGVfcmVzdG9yZSgpIHdpbGwgdXNl
CisgKiBhIGRvbWlkIHNwZWNpZmllZCBpbiBsaWJ4bF9kb21haW5fY3JlYXRlX2luZm8oKS4KKyAq
LworI2RlZmluZSBMSUJYTF9IQVZFX0NSRUFURUlORk9fRE9NSUQKKwogdHlwZWRlZiBjaGFyICoq
bGlieGxfc3RyaW5nX2xpc3Q7CiB2b2lkIGxpYnhsX3N0cmluZ19saXN0X2Rpc3Bvc2UobGlieGxf
c3RyaW5nX2xpc3QgKnNsKTsKIGludCBsaWJ4bF9zdHJpbmdfbGlzdF9sZW5ndGgoY29uc3QgbGli
eGxfc3RyaW5nX2xpc3QgKnNsKTsKQEAgLTE1MjgsNiArMTUzNiw3IEBAIGludCBsaWJ4bF9jdHhf
ZnJlZShsaWJ4bF9jdHggKmN0eCAvKiAwIGlzIE9LICovKTsKIC8qIGRvbWFpbiByZWxhdGVkIGZ1
bmN0aW9ucyAqLwogCiAjZGVmaW5lIElOVkFMSURfRE9NSUQgfjAKKyNkZWZpbmUgUkFORE9NX0RP
TUlEIChJTlZBTElEX0RPTUlEIC0gMSkKIAogLyogSWYgdGhlIHJlc3VsdCBpcyBFUlJPUl9BQk9S
VEVELCB0aGUgZG9tYWluIG1heSBvciBtYXkgbm90IGV4aXN0CiAgKiAoaW4gYSBoYWxmLWNyZWF0
ZWQgc3RhdGUpLiAgKmRvbWlkIHdpbGwgYmUgdmFsaWQgYW5kIHdpbGwgYmUgdGhlCmRpZmYgLS1n
aXQgYS90b29scy9saWJ4bC9saWJ4bF9jcmVhdGUuYyBiL3Rvb2xzL2xpYnhsL2xpYnhsX2NyZWF0
ZS5jCmluZGV4IDE4MzVhNTUwMmMuLmVlNzZkZWUzNjQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhs
L2xpYnhsX2NyZWF0ZS5jCisrKyBiL3Rvb2xzL2xpYnhsL2xpYnhsX2NyZWF0ZS5jCkBAIC02MDAs
OSArNjAwLDM5IEBAIGludCBsaWJ4bF9fZG9tYWluX21ha2UobGlieGxfX2djICpnYywgbGlieGxf
ZG9tYWluX2NvbmZpZyAqZF9jb25maWcsCiAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAg
fQogCi0gICAgICAgIHJldCA9IHhjX2RvbWFpbl9jcmVhdGUoY3R4LT54Y2gsIGRvbWlkLCAmY3Jl
YXRlKTsKKyAgICAgICAgaWYgKGxpYnhsX2RvbWlkX3ZhbGlkX2d1ZXN0KGluZm8tPmRvbWlkKSkg
eworICAgICAgICAgICAgKmRvbWlkID0gaW5mby0+ZG9taWQ7CisKKyAgICAgICAgICAgIGlmIChs
aWJ4bF9faXNfcmV0aXJlZF9kb21pZChnYywgKmRvbWlkKSkgeworICAgICAgICAgICAgICAgIExP
R0VEKEVSUk9SLCAqZG9taWQsICJkb21haW4gaWQgaXMgcmV0aXJlZCIpOworICAgICAgICAgICAg
ICAgIHJjID0gRVJST1JfRkFJTDsKKyAgICAgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAg
ICAgIH0KKyAgICAgICAgfSBlbHNlIGlmIChpbmZvLT5kb21pZCA9PSBSQU5ET01fRE9NSUQpIHsK
KyAgICAgICAgICAgICpkb21pZCA9IDA7IC8qIFplcm8tb3V0IGluaXRpYWwgdmFsdWUgKi8KKyAg
ICAgICAgfQorCisgICAgICAgIGZvciAoOzspIHsKKyAgICAgICAgICAgIGlmIChpbmZvLT5kb21p
ZCA9PSBSQU5ET01fRE9NSUQpIHsKKyAgICAgICAgICAgICAgICAvKiBSYW5kb21pemUgbG93ZXIg
b3JkZXIgYnl0ZXMgKi8KKyAgICAgICAgICAgICAgICByZXQgPSBsaWJ4bF9fcmFuZG9tX2J5dGVz
KGdjLCAodm9pZCAqKWRvbWlkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2l6ZW9mKHVpbnQxNl90KSk7CisgICAgICAgICAgICAgICAgaWYgKHJldCA8IDApCisg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgICAgICAgICAgaWYgKCFsaWJ4bF9k
b21pZF92YWxpZF9ndWVzdCgqZG9taWQpIHx8CisgICAgICAgICAgICAgICAgICAgIGxpYnhsX19p
c19yZXRpcmVkX2RvbWlkKGdjLCAqZG9taWQpKQorICAgICAgICAgICAgICAgICAgICBjb250aW51
ZTsKKyAgICAgICAgICAgIH0KKworICAgICAgICAgICAgcmV0ID0geGNfZG9tYWluX2NyZWF0ZShj
dHgtPnhjaCwgZG9taWQsICZjcmVhdGUpOworICAgICAgICAgICAgaWYgKHJldCA9PSAwIHx8IGVy
cm5vICE9IEVFWElTVCB8fCBpbmZvLT5kb21pZCAhPSBSQU5ET01fRE9NSUQpCisgICAgICAgICAg
ICAgICAgYnJlYWs7CisgICAgICAgIH0KKwogICAgICAgICBpZiAocmV0IDwgMCkgewogICAgICAg
ICAgICAgTE9HRUQoRVJST1IsICpkb21pZCwgImRvbWFpbiBjcmVhdGlvbiBmYWlsIik7CisgICAg
ICAgICAgICAqZG9taWQgPSBJTlZBTElEX0RPTUlEOwogICAgICAgICAgICAgcmMgPSBFUlJPUl9G
QUlMOwogICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIH0KZGlmZiAtLWdpdCBhL3Rvb2xz
L2xpYnhsL2xpYnhsX2ludGVybmFsLmMgYi90b29scy9saWJ4bC9saWJ4bF9pbnRlcm5hbC5jCmlu
ZGV4IGJhNTYzNzM1OGUuLmRjNmFhYTljOWYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhs
X2ludGVybmFsLmMKKysrIGIvdG9vbHMvbGlieGwvbGlieGxfaW50ZXJuYWwuYwpAQCAtMjM0LDcg
KzIzNCw3IEBAIHZvaWQgbGlieGxfX2xvZ3YobGlieGxfY3R4ICpjdHgsIHhlbnRvb2xsb2dfbGV2
ZWwgbXNnbGV2ZWwsIGludCBlcnJub3ZhbCwKICAgICBmaWxlbGluZVtzaXplb2YoZmlsZWxpbmUp
LTFdID0gMDsKIAogICAgIGRvbWFpblswXSA9IDA7Ci0gICAgaWYgKGRvbWlkICE9IElOVkFMSURf
RE9NSUQpCisgICAgaWYgKGxpYnhsX2RvbWlkX3ZhbGlkX2d1ZXN0KGRvbWlkKSkKICAgICAgICAg
c25wcmludGYoZG9tYWluLCBzaXplb2YoZG9tYWluKSwgIkRvbWFpbiAlIlBSSXUzMiI6IiwgZG9t
aWQpOwogIHg6CiAgICAgeHRsX2xvZyhjdHgtPmxnLCBtc2dsZXZlbCwgZXJybm92YWwsICJsaWJ4
bCIsCmRpZmYgLS1naXQgYS90b29scy9saWJ4bC9saWJ4bF90eXBlcy5pZGwgYi90b29scy9saWJ4
bC9saWJ4bF90eXBlcy5pZGwKaW5kZXggNzkyMTk1MGY2YS4uZDBkNDMxNjE0ZiAxMDA2NDQKLS0t
IGEvdG9vbHMvbGlieGwvbGlieGxfdHlwZXMuaWRsCisrKyBiL3Rvb2xzL2xpYnhsL2xpYnhsX3R5
cGVzLmlkbApAQCAtNDA5LDYgKzQwOSw3IEBAIGxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbyA9IFN0
cnVjdCgiZG9tYWluX2NyZWF0ZV9pbmZvIixbCiAgICAgKCJzc2lkcmVmIiwgICAgICB1aW50MzIp
LAogICAgICgic3NpZF9sYWJlbCIsICAgc3RyaW5nKSwKICAgICAoIm5hbWUiLCAgICAgICAgIHN0
cmluZyksCisgICAgKCJkb21pZCIsICAgICAgICBsaWJ4bF9kb21pZCksCiAgICAgKCJ1dWlkIiwg
ICAgICAgICBsaWJ4bF91dWlkKSwKICAgICAoInhzZGF0YSIsICAgICAgIGxpYnhsX2tleV92YWx1
ZV9saXN0KSwKICAgICAoInBsYXRmb3JtZGF0YSIsIGxpYnhsX2tleV92YWx1ZV9saXN0KSwKLS0g
CjIuMjAuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
Clhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0
dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

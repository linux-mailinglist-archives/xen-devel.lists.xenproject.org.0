Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8265F134622
	for <lists+xen-devel@lfdr.de>; Wed,  8 Jan 2020 16:26:19 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ipDBt-0004mX-GD; Wed, 08 Jan 2020 15:24:13 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=Mkji=25=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1ipDBr-0004l6-Iv
 for xen-devel@lists.xenproject.org; Wed, 08 Jan 2020 15:24:11 +0000
X-Inumbo-ID: d6bff4fe-322a-11ea-a38f-bc764e2007e4
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id d6bff4fe-322a-11ea-a38f-bc764e2007e4;
 Wed, 08 Jan 2020 15:23:36 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 2D579AE2E;
 Wed,  8 Jan 2020 15:23:33 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Wed,  8 Jan 2020 16:23:28 +0100
Message-Id: <20200108152328.27194-10-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20200108152328.27194-1-jgross@suse.com>
References: <20200108152328.27194-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v2 9/9] xen/sched: add const qualifier where
 appropriate
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>,
 Stewart Hildebrand <stewart.hildebrand@dornerworks.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TWFrZSB1c2Ugb2YgdGhlIGNvbnN0IHF1YWxpZmllciBtb3JlIG9mdGVuIGluIHNjaGVkdWxpbmcg
Y29kZS4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2
aWV3ZWQtYnk6IERhcmlvIEZhZ2dpb2xpIDxkZmFnZ2lvbGlAc3VzZS5jb20+Ci0tLQogeGVuL2Nv
bW1vbi9zY2hlZC9hcmluYzY1My5jIHwgIDQgKystLQogeGVuL2NvbW1vbi9zY2hlZC9jb3JlLmMg
ICAgIHwgMjUgKysrKysrKysrKystLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZC9jcHVwb29s
LmMgIHwgIDIgKy0KIHhlbi9jb21tb24vc2NoZWQvY3JlZGl0LmMgICB8IDQ0ICsrKysrKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkL2NyZWRpdDIuYyAg
fCA1MiArKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9j
b21tb24vc2NoZWQvbnVsbC5jICAgICB8IDE3ICsrKysrKysrLS0tLS0tLQogeGVuL2NvbW1vbi9z
Y2hlZC9ydC5jICAgICAgIHwgMzIgKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLQogeGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmggICAgIHwgIDkgKysrKy0tLS0KIDggZmlsZXMgY2hhbmdlZCwgOTYg
aW5zZXJ0aW9ucygrKSwgODkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9z
Y2hlZC9hcmluYzY1My5jIGIveGVuL2NvbW1vbi9zY2hlZC9hcmluYzY1My5jCmluZGV4IGJjZTgw
MjFlM2YuLjU0MjE5MTgyMjEgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWQvYXJpbmM2NTMu
YworKysgYi94ZW4vY29tbW9uL3NjaGVkL2FyaW5jNjUzLmMKQEAgLTYwOCw3ICs2MDgsNyBAQCBz
dGF0aWMgc3RydWN0IHNjaGVkX3Jlc291cmNlICoKIGE2NTNzY2hlZF9waWNrX3Jlc291cmNlKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewotICAgIGNwdW1hc2tfdCAqb25saW5lOworICAg
IGNvbnN0IGNwdW1hc2tfdCAqb25saW5lOwogICAgIHVuc2lnbmVkIGludCBjcHU7CiAKICAgICAv
KgpAQCAtNjM5LDcgKzYzOSw3IEBAIGE2NTNfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIg
Km5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAgICAgICAgICAgICAgICAgICB2b2lkICpwZGF0
YSwgdm9pZCAqdmRhdGEpCiB7CiAgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9z
Y2hlZF9yZXMoY3B1KTsKLSAgICBhcmluYzY1M191bml0X3QgKnN2YyA9IHZkYXRhOworICAgIGNv
bnN0IGFyaW5jNjUzX3VuaXRfdCAqc3ZjID0gdmRhdGE7CiAKICAgICBBU1NFUlQoIXBkYXRhICYm
IHN2YyAmJiBpc19pZGxlX3VuaXQoc3ZjLT51bml0KSk7CiAKZGlmZiAtLWdpdCBhL3hlbi9jb21t
b24vc2NoZWQvY29yZS5jIGIveGVuL2NvbW1vbi9zY2hlZC9jb3JlLmMKaW5kZXggZDMyYjliMWJh
YS4uOTQ0MTY0ZDc4YSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZC9jb3JlLmMKKysrIGIv
eGVuL2NvbW1vbi9zY2hlZC9jb3JlLmMKQEAgLTE3NSw3ICsxNzUsNyBAQCBzdGF0aWMgaW5saW5l
IHN0cnVjdCBzY2hlZHVsZXIgKmRvbV9zY2hlZHVsZXIoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCkK
IAogc3RhdGljIGlubGluZSBzdHJ1Y3Qgc2NoZWR1bGVyICp1bml0X3NjaGVkdWxlcihjb25zdCBz
dHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKLSAgICBzdHJ1Y3QgZG9tYWluICpkID0gdW5pdC0+
ZG9tYWluOworICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKmQgPSB1bml0LT5kb21haW47CiAKICAg
ICBpZiAoIGxpa2VseShkLT5jcHVwb29sICE9IE5VTEwpICkKICAgICAgICAgcmV0dXJuIGQtPmNw
dXBvb2wtPnNjaGVkOwpAQCAtMjAyLDcgKzIwMiw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHNj
aGVkdWxlciAqdmNwdV9zY2hlZHVsZXIoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiB9CiAjZGVmaW5l
IFZDUFUyT05MSU5FKF92KSBjcHVwb29sX2RvbWFpbl9tYXN0ZXJfY3B1bWFzaygoX3YpLT5kb21h
aW4pCiAKLXN0YXRpYyBpbmxpbmUgdm9pZCB0cmFjZV9ydW5zdGF0ZV9jaGFuZ2Uoc3RydWN0IHZj
cHUgKnYsIGludCBuZXdfc3RhdGUpCitzdGF0aWMgaW5saW5lIHZvaWQgdHJhY2VfcnVuc3RhdGVf
Y2hhbmdlKGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCBpbnQgbmV3X3N0YXRlKQogewogICAgIHN0cnVj
dCB7IHVpbnQzMl90IHZjcHU6MTYsIGRvbWFpbjoxNjsgfSBkOwogICAgIHVpbnQzMl90IGV2ZW50
OwpAQCAtMjIwLDcgKzIyMCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB0cmFjZV9ydW5zdGF0ZV9j
aGFuZ2Uoc3RydWN0IHZjcHUgKnYsIGludCBuZXdfc3RhdGUpCiAgICAgX190cmFjZV92YXIoZXZl
bnQsIDEvKnRzYyovLCBzaXplb2YoZCksICZkKTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHRy
YWNlX2NvbnRpbnVlX3J1bm5pbmcoc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgaW5saW5lIHZvaWQg
dHJhY2VfY29udGludWVfcnVubmluZyhjb25zdCBzdHJ1Y3QgdmNwdSAqdikKIHsKICAgICBzdHJ1
Y3QgeyB1aW50MzJfdCB2Y3B1OjE2LCBkb21haW46MTY7IH0gZDsKIApAQCAtMzAyLDcgKzMwMiw4
IEBAIHZvaWQgc2NoZWRfZ3Vlc3RfaWRsZSh2b2lkICgqaWRsZSkgKHZvaWQpLCB1bnNpZ25lZCBp
bnQgY3B1KQogICAgIGF0b21pY19kZWMoJnBlcl9jcHUoc2NoZWRfdXJnZW50X2NvdW50LCBjcHUp
KTsKIH0KIAotdm9pZCB2Y3B1X3J1bnN0YXRlX2dldChzdHJ1Y3QgdmNwdSAqdiwgc3RydWN0IHZj
cHVfcnVuc3RhdGVfaW5mbyAqcnVuc3RhdGUpCit2b2lkIHZjcHVfcnVuc3RhdGVfZ2V0KGNvbnN0
IHN0cnVjdCB2Y3B1ICp2LAorICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmNwdV9ydW5z
dGF0ZV9pbmZvICpydW5zdGF0ZSkKIHsKICAgICBzcGlubG9ja190ICpsb2NrOwogICAgIHNfdGlt
ZV90IGRlbHRhOwpAQCAtMzI0LDcgKzMyNSw3IEBAIHZvaWQgdmNwdV9ydW5zdGF0ZV9nZXQoc3Ry
dWN0IHZjcHUgKnYsIHN0cnVjdCB2Y3B1X3J1bnN0YXRlX2luZm8gKnJ1bnN0YXRlKQogdWludDY0
X3QgZ2V0X2NwdV9pZGxlX3RpbWUodW5zaWduZWQgaW50IGNwdSkKIHsKICAgICBzdHJ1Y3QgdmNw
dV9ydW5zdGF0ZV9pbmZvIHN0YXRlID0geyAwIH07Ci0gICAgc3RydWN0IHZjcHUgKnYgPSBpZGxl
X3ZjcHVbY3B1XTsKKyAgICBjb25zdCBzdHJ1Y3QgdmNwdSAqdiA9IGlkbGVfdmNwdVtjcHVdOwog
CiAgICAgaWYgKCBjcHVfb25saW5lKGNwdSkgJiYgdiApCiAgICAgICAgIHZjcHVfcnVuc3RhdGVf
Z2V0KHYsICZzdGF0ZSk7CkBAIC0zOTIsNyArMzkzLDcgQEAgc3RhdGljIHZvaWQgc2NoZWRfZnJl
ZV91bml0X21lbShzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIAogc3RhdGljIHZvaWQgc2NoZWRf
ZnJlZV91bml0KHN0cnVjdCBzY2hlZF91bml0ICp1bml0LCBzdHJ1Y3QgdmNwdSAqdikKIHsKLSAg
ICBzdHJ1Y3QgdmNwdSAqdnVuaXQ7CisgICAgY29uc3Qgc3RydWN0IHZjcHUgKnZ1bml0OwogICAg
IHVuc2lnbmVkIGludCBjbnQgPSAwOwogCiAgICAgLyogRG9uJ3QgY291bnQgdG8gYmUgcmVsZWFz
ZWQgdmNwdSwgbWlnaHQgYmUgbm90IGluIHZjcHUgbGlzdCB5ZXQuICovCkBAIC01MjIsNyArNTIz
LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCBzY2hlZF9zZWxlY3RfaW5pdGlhbF9jcHUoY29uc3Qg
c3RydWN0IHZjcHUgKnYpCiAKIGludCBzY2hlZF9pbml0X3ZjcHUoc3RydWN0IHZjcHUgKnYpCiB7
Ci0gICAgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKKyAgICBjb25zdCBzdHJ1Y3QgZG9t
YWluICpkID0gdi0+ZG9tYWluOwogICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0OwogICAgIHVu
c2lnbmVkIGludCBwcm9jZXNzb3I7CiAKQEAgLTkxMyw3ICs5MTQsNyBAQCBzdGF0aWMgdm9pZCBz
Y2hlZF91bml0X21vdmVfbG9ja2VkKHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbmV3X2NwdSkKIHsKICAgICB1
bnNpZ25lZCBpbnQgb2xkX2NwdSA9IHVuaXQtPnJlcy0+bWFzdGVyX2NwdTsKLSAgICBzdHJ1Y3Qg
dmNwdSAqdjsKKyAgICBjb25zdCBzdHJ1Y3QgdmNwdSAqdjsKIAogICAgIHJjdV9yZWFkX2xvY2so
JnNjaGVkX3Jlc19yY3Vsb2NrKTsKIApAQCAtMTA5MCw3ICsxMDkxLDcgQEAgc3RhdGljIGJvb2wg
c2NoZWRfY2hlY2tfYWZmaW5pdHlfYnJva2VuKGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0
KQogICAgIHJldHVybiBmYWxzZTsKIH0KIAotc3RhdGljIHZvaWQgc2NoZWRfcmVzZXRfYWZmaW5p
dHlfYnJva2VuKHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorc3RhdGljIHZvaWQgc2NoZWRfcmVz
ZXRfYWZmaW5pdHlfYnJva2VuKGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAg
IHN0cnVjdCB2Y3B1ICp2OwogCkBAIC0xMTc2LDcgKzExNzcsNyBAQCB2b2lkIHJlc3RvcmVfdmNw
dV9hZmZpbml0eShzdHJ1Y3QgZG9tYWluICpkKQogaW50IGNwdV9kaXNhYmxlX3NjaGVkdWxlcih1
bnNpZ25lZCBpbnQgY3B1KQogewogICAgIHN0cnVjdCBkb21haW4gKmQ7Ci0gICAgc3RydWN0IGNw
dXBvb2wgKmM7CisgICAgY29uc3Qgc3RydWN0IGNwdXBvb2wgKmM7CiAgICAgY3B1bWFza190IG9u
bGluZV9hZmZpbml0eTsKICAgICBpbnQgcmV0ID0gMDsKIApAQCAtMTI1MSw4ICsxMjUyLDggQEAg
b3V0Ogogc3RhdGljIGludCBjcHVfZGlzYWJsZV9zY2hlZHVsZXJfY2hlY2sodW5zaWduZWQgaW50
IGNwdSkKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkOwotICAgIHN0cnVjdCB2Y3B1ICp2OwotICAg
IHN0cnVjdCBjcHVwb29sICpjOworICAgIGNvbnN0IHN0cnVjdCB2Y3B1ICp2OworICAgIGNvbnN0
IHN0cnVjdCBjcHVwb29sICpjOwogCiAgICAgYyA9IGdldF9zY2hlZF9yZXMoY3B1KS0+Y3B1cG9v
bDsKICAgICBpZiAoIGMgPT0gTlVMTCApCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkL2Nw
dXBvb2wuYyBiL3hlbi9jb21tb24vc2NoZWQvY3B1cG9vbC5jCmluZGV4IGMxMzk2Y2ZmZjQuLjI4
ZDUxNDNlMzcgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWQvY3B1cG9vbC5jCisrKyBiL3hl
bi9jb21tb24vc2NoZWQvY3B1cG9vbC5jCkBAIC04ODEsNyArODgxLDcgQEAgaW50IGNwdXBvb2xf
Z2V0X2lkKGNvbnN0IHN0cnVjdCBkb21haW4gKmQpCiAgICAgcmV0dXJuIGQtPmNwdXBvb2wgPyBk
LT5jcHVwb29sLT5jcHVwb29sX2lkIDogQ1BVUE9PTElEX05PTkU7CiB9CiAKLWNwdW1hc2tfdCAq
Y3B1cG9vbF92YWxpZF9jcHVzKHN0cnVjdCBjcHVwb29sICpwb29sKQorY29uc3QgY3B1bWFza190
ICpjcHVwb29sX3ZhbGlkX2NwdXMoY29uc3Qgc3RydWN0IGNwdXBvb2wgKnBvb2wpCiB7CiAgICAg
cmV0dXJuIHBvb2wtPmNwdV92YWxpZDsKIH0KZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWQv
Y3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkL2NyZWRpdC5jCmluZGV4IGE3NWVmYmQ0M2QuLmNk
ZGE2ZmEwOWIgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWQvY3JlZGl0LmMKKysrIGIveGVu
L2NvbW1vbi9zY2hlZC9jcmVkaXQuYwpAQCAtMjMzLDcgKzIzMyw3IEBAIHN0YXRpYyB2b2lkIGNz
Y2hlZF90aWNrKHZvaWQgKl9jcHUpOwogc3RhdGljIHZvaWQgY3NjaGVkX2FjY3Qodm9pZCAqZHVt
bXkpOwogCiBzdGF0aWMgaW5saW5lIGludAotX191bml0X29uX3J1bnEoc3RydWN0IGNzY2hlZF91
bml0ICpzdmMpCitfX3VuaXRfb25fcnVucShjb25zdCBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnN2YykK
IHsKICAgICByZXR1cm4gIWxpc3RfZW1wdHkoJnN2Yy0+cnVucV9lbGVtKTsKIH0KQEAgLTM0OSwx
MSArMzQ5LDExIEBAIGJvb2xlYW5fcGFyYW0oInRpY2tsZV9vbmVfaWRsZV9jcHUiLCBvcHRfdGlj
a2xlX29uZV9pZGxlKTsKIAogREVGSU5FX1BFUl9DUFUodW5zaWduZWQgaW50LCBsYXN0X3RpY2ts
ZV9jcHUpOwogCi1zdGF0aWMgaW5saW5lIHZvaWQgX19ydW5xX3RpY2tsZShzdHJ1Y3QgY3NjaGVk
X3VuaXQgKm5ldykKK3N0YXRpYyBpbmxpbmUgdm9pZCBfX3J1bnFfdGlja2xlKGNvbnN0IHN0cnVj
dCBjc2NoZWRfdW5pdCAqbmV3KQogewogICAgIHVuc2lnbmVkIGludCBjcHUgPSBzY2hlZF91bml0
X21hc3RlcihuZXctPnVuaXQpOwotICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBnZXRf
c2NoZWRfcmVzKGNwdSk7Ci0gICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQgPSBuZXctPnVuaXQ7
CisgICAgY29uc3Qgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1
KTsKKyAgICBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCA9IG5ldy0+dW5pdDsKICAgICBz
dHJ1Y3QgY3NjaGVkX3VuaXQgKiBjb25zdCBjdXIgPSBDU0NIRURfVU5JVChjdXJyX29uX2NwdShj
cHUpKTsKICAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKHNyLT5z
Y2hlZHVsZXIpOwogICAgIGNwdW1hc2tfdCBtYXNrLCBpZGxlX21hc2ssICpvbmxpbmU7CkBAIC01
MDksNyArNTA5LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIF9fcnVucV90aWNrbGUoc3RydWN0IGNz
Y2hlZF91bml0ICpuZXcpCiBzdGF0aWMgdm9pZAogY3NjaGVkX2ZyZWVfcGRhdGEoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwY3B1LCBpbnQgY3B1KQogewotICAgIHN0cnVjdCBj
c2NoZWRfcHJpdmF0ZSAqcHJ2ID0gQ1NDSEVEX1BSSVYob3BzKTsKKyAgICBjb25zdCBzdHJ1Y3Qg
Y3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKG9wcyk7CiAKICAgICAvKgogICAgICAq
IHBjcHUgZWl0aGVyIHBvaW50cyB0byBhIHZhbGlkIHN0cnVjdCBjc2NoZWRfcGNwdSwgb3IgaXMg
TlVMTCwgaWYgd2UncmUKQEAgLTY1Miw3ICs2NTIsNyBAQCBjc2NoZWRfc3dpdGNoX3NjaGVkKHN0
cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAKICNpZm5kZWYgTkRF
QlVHCiBzdGF0aWMgaW5saW5lIHZvaWQKLV9fY3NjaGVkX3VuaXRfY2hlY2soc3RydWN0IHNjaGVk
X3VuaXQgKnVuaXQpCitfX2NzY2hlZF91bml0X2NoZWNrKGNvbnN0IHN0cnVjdCBzY2hlZF91bml0
ICp1bml0KQogewogICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqIGNvbnN0IHN2YyA9IENTQ0hFRF9V
TklUKHVuaXQpOwogICAgIHN0cnVjdCBjc2NoZWRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+c2Rv
bTsKQEAgLTcwMCw4ICs3MDAsOCBAQCBfX2NzY2hlZF92Y3B1X2lzX2NhY2hlX2hvdChjb25zdCBz
dHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwKIAogc3RhdGljIGlubGluZSBpbnQKIF9fY3NjaGVk
X3VuaXRfaXNfbWlncmF0ZWFibGUoY29uc3Qgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZGVzdF9jcHUsIGNwdW1hc2tfdCAqbWFzaykK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVu
aXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBkZXN0X2NwdSwgY29uc3QgY3B1
bWFza190ICptYXNrKQogewogICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfdW5pdCAqc3ZjID0gQ1ND
SEVEX1VOSVQodW5pdCk7CiAgICAgLyoKQEAgLTcyNSw3ICs3MjUsNyBAQCBfY3NjaGVkX2NwdV9w
aWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQg
KnVuaXQsCiAgICAgLyogV2UgbXVzdCBhbHdheXMgdXNlIGNwdSdzIHNjcmF0Y2ggc3BhY2UgKi8K
ICAgICBjcHVtYXNrX3QgKmNwdXMgPSBjcHVtYXNrX3NjcmF0Y2hfY3B1KGNwdSk7CiAgICAgY3B1
bWFza190IGlkbGVyczsKLSAgICBjcHVtYXNrX3QgKm9ubGluZSA9IGNwdXBvb2xfZG9tYWluX21h
c3Rlcl9jcHVtYXNrKHVuaXQtPmRvbWFpbik7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmUg
PSBjcHVwb29sX2RvbWFpbl9tYXN0ZXJfY3B1bWFzayh1bml0LT5kb21haW4pOwogICAgIHN0cnVj
dCBjc2NoZWRfcGNwdSAqc3BjID0gTlVMTDsKICAgICBpbnQgYmFsYW5jZV9zdGVwOwogCkBAIC05
MzIsNyArOTMyLDcgQEAgY3NjaGVkX3VuaXRfYWNjdChzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBy
diwgdW5zaWduZWQgaW50IGNwdSkKIHsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqY3VycnVuaXQg
PSBjdXJyZW50LT5zY2hlZF91bml0OwogICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqIGNvbnN0IHN2
YyA9IENTQ0hFRF9VTklUKGN1cnJ1bml0KTsKLSAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNy
ID0gZ2V0X3NjaGVkX3JlcyhjcHUpOworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAq
c3IgPSBnZXRfc2NoZWRfcmVzKGNwdSk7CiAgICAgY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
ID0gc3ItPnNjaGVkdWxlcjsKIAogICAgIEFTU0VSVCggc2NoZWRfdW5pdF9tYXN0ZXIoY3VycnVu
aXQpID09IGNwdSApOwpAQCAtMTA4NCw3ICsxMDg0LDcgQEAgY3NjaGVkX3VuaXRfc2xlZXAoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAg
ICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKiBjb25zdCBzdmMgPSBDU0NIRURfVU5JVCh1bml0KTsKICAg
ICB1bnNpZ25lZCBpbnQgY3B1ID0gc2NoZWRfdW5pdF9tYXN0ZXIodW5pdCk7Ci0gICAgc3RydWN0
IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBjb25zdCBzdHJ1
Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUpOwogCiAgICAgU0NIRURf
U1RBVF9DUkFOSyh1bml0X3NsZWVwKTsKIApAQCAtMTU3Nyw3ICsxNTc3LDcgQEAgc3RhdGljIHZv
aWQKIGNzY2hlZF90aWNrKHZvaWQgKl9jcHUpCiB7CiAgICAgdW5zaWduZWQgaW50IGNwdSA9ICh1
bnNpZ25lZCBsb25nKV9jcHU7Ci0gICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9z
Y2hlZF9yZXMoY3B1KTsKKyAgICBjb25zdCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0gZ2V0
X3NjaGVkX3JlcyhjcHUpOwogICAgIHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjID0gQ1NDSEVEX1BD
UFUoY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKHNy
LT5zY2hlZHVsZXIpOwogCkBAIC0xNjA0LDcgKzE2MDQsNyBAQCBjc2NoZWRfdGljayh2b2lkICpf
Y3B1KQogc3RhdGljIHN0cnVjdCBjc2NoZWRfdW5pdCAqCiBjc2NoZWRfcnVucV9zdGVhbChpbnQg
cGVlcl9jcHUsIGludCBjcHUsIGludCBwcmksIGludCBiYWxhbmNlX3N0ZXApCiB7Ci0gICAgc3Ry
dWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBjb25zdCBz
dHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUpOwogICAgIGNvbnN0
IHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqIGNvbnN0IHBydiA9IENTQ0hFRF9QUklWKHNyLT5zY2hl
ZHVsZXIpOwogICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfcGNwdSAqIGNvbnN0IHBlZXJfcGNwdSA9
IENTQ0hFRF9QQ1BVKHBlZXJfY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnNwZWVyOwpA
QCAtMTY4MSwxMCArMTY4MSwxMCBAQCBzdGF0aWMgc3RydWN0IGNzY2hlZF91bml0ICoKIGNzY2hl
ZF9sb2FkX2JhbGFuY2Uoc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIGludCBjcHUsCiAgICAg
c3RydWN0IGNzY2hlZF91bml0ICpzbmV4dCwgYm9vbCAqc3RvbGVuKQogewotICAgIHN0cnVjdCBj
cHVwb29sICpjID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5jcHVwb29sOworICAgIGNvbnN0IHN0cnVj
dCBjcHVwb29sICpjID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5jcHVwb29sOwogICAgIHN0cnVjdCBj
c2NoZWRfdW5pdCAqc3BlZXI7CiAgICAgY3B1bWFza190IHdvcmtlcnM7Ci0gICAgY3B1bWFza190
ICpvbmxpbmUgPSBjLT5yZXNfdmFsaWQ7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmUgPSBj
LT5yZXNfdmFsaWQ7CiAgICAgaW50IHBlZXJfY3B1LCBmaXJzdF9jcHUsIHBlZXJfbm9kZSwgYnN0
ZXA7CiAgICAgaW50IG5vZGUgPSBjcHVfdG9fbm9kZShjcHUpOwogCkBAIC0yMDA4LDcgKzIwMDgs
NyBAQCBvdXQ6CiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWRfZHVtcF91bml0KHN0cnVjdCBjc2No
ZWRfdW5pdCAqc3ZjKQorY3NjaGVkX2R1bXBfdW5pdChjb25zdCBzdHJ1Y3QgY3NjaGVkX3VuaXQg
KnN2YykKIHsKICAgICBzdHJ1Y3QgY3NjaGVkX2RvbSAqIGNvbnN0IHNkb20gPSBzdmMtPnNkb207
CiAKQEAgLTIwNDEsMTAgKzIwNDEsMTEgQEAgY3NjaGVkX2R1bXBfdW5pdChzdHJ1Y3QgY3NjaGVk
X3VuaXQgKnN2YykKIHN0YXRpYyB2b2lkCiBjc2NoZWRfZHVtcF9wY3B1KGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKm9wcywgaW50IGNwdSkKIHsKLSAgICBzdHJ1Y3QgbGlzdF9oZWFkICpydW5xLCAq
aXRlcjsKKyAgICBjb25zdCBzdHJ1Y3QgbGlzdF9oZWFkICpydW5xOworICAgIHN0cnVjdCBsaXN0
X2hlYWQgKml0ZXI7CiAgICAgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYgPSBDU0NIRURfUFJJ
VihvcHMpOwotICAgIHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjOwotICAgIHN0cnVjdCBjc2NoZWRf
dW5pdCAqc3ZjOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjOworICAgIGNvbnN0
IHN0cnVjdCBjc2NoZWRfdW5pdCAqc3ZjOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAgICAgdW5z
aWduZWQgbG9uZyBmbGFnczsKICAgICBpbnQgbG9vcDsKQEAgLTIxMzIsMTIgKzIxMzMsMTMgQEAg
Y3NjaGVkX2R1bXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzKQogICAgIGxvb3AgPSAwOwog
ICAgIGxpc3RfZm9yX2VhY2goIGl0ZXJfc2RvbSwgJnBydi0+YWN0aXZlX3Nkb20gKQogICAgIHsK
LSAgICAgICAgc3RydWN0IGNzY2hlZF9kb20gKnNkb207CisgICAgICAgIGNvbnN0IHN0cnVjdCBj
c2NoZWRfZG9tICpzZG9tOworCiAgICAgICAgIHNkb20gPSBsaXN0X2VudHJ5KGl0ZXJfc2RvbSwg
c3RydWN0IGNzY2hlZF9kb20sIGFjdGl2ZV9zZG9tX2VsZW0pOwogCiAgICAgICAgIGxpc3RfZm9y
X2VhY2goIGl0ZXJfc3ZjLCAmc2RvbS0+YWN0aXZlX3VuaXQgKQogICAgICAgICB7Ci0gICAgICAg
ICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnN2YzsKKyAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBj
c2NoZWRfdW5pdCAqc3ZjOwogICAgICAgICAgICAgc3BpbmxvY2tfdCAqbG9jazsKIAogICAgICAg
ICAgICAgc3ZjID0gbGlzdF9lbnRyeShpdGVyX3N2Yywgc3RydWN0IGNzY2hlZF91bml0LCBhY3Rp
dmVfdW5pdF9lbGVtKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWQvY3JlZGl0Mi5jIGIv
eGVuL2NvbW1vbi9zY2hlZC9jcmVkaXQyLmMKaW5kZXggODQ5ZDI1NGUwNC4uMjU2YzFjMDFmYyAx
MDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZC9jcmVkaXQyLmMKKysrIGIveGVuL2NvbW1vbi9z
Y2hlZC9jcmVkaXQyLmMKQEAgLTY5Miw3ICs2OTIsNyBAQCB2b2lkIHNtdF9pZGxlX21hc2tfY2xl
YXIodW5zaWduZWQgaW50IGNwdSwgY3B1bWFza190ICptYXNrKQogICovCiBzdGF0aWMgaW50IGdl
dF9mYWxsYmFja19jcHUoc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjKQogewotICAgIHN0cnVjdCBz
Y2hlZF91bml0ICp1bml0ID0gc3ZjLT51bml0OworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0
ICp1bml0ID0gc3ZjLT51bml0OwogICAgIHVuc2lnbmVkIGludCBiczsKIAogICAgIFNDSEVEX1NU
QVRfQ1JBTksobmVlZF9mYWxsYmFja19jcHUpOwpAQCAtNzc0LDcgKzc3NCw3IEBAIHN0YXRpYyBp
bnQgZ2V0X2ZhbGxiYWNrX2NwdShzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMpCiAgKgogICogRklY
TUU6IERvIHByZS1jYWxjdWxhdGVkIGRpdmlzaW9uPwogICovCi1zdGF0aWMgdm9pZCB0MmNfdXBk
YXRlKHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwgc190aW1lX3QgdGltZSwKK3N0
YXRpYyB2b2lkIHQyY191cGRhdGUoY29uc3Qgc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAq
cnFkLCBzX3RpbWVfdCB0aW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY3Nj
aGVkMl91bml0ICpzdmMpCiB7CiAgICAgdWludDY0X3QgdmFsID0gdGltZSAqIHJxZC0+bWF4X3dl
aWdodCArIHN2Yy0+cmVzaWR1YWw7CkBAIC03ODMsNyArNzgzLDggQEAgc3RhdGljIHZvaWQgdDJj
X3VwZGF0ZShzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQsIHNfdGltZV90IHRpbWUs
CiAgICAgc3ZjLT5jcmVkaXQgLT0gdmFsOwogfQogCi1zdGF0aWMgc190aW1lX3QgYzJ0KHN0cnVj
dCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwgc190aW1lX3QgY3JlZGl0LCBzdHJ1Y3QgY3Nj
aGVkMl91bml0ICpzdmMpCitzdGF0aWMgc190aW1lX3QgYzJ0KGNvbnN0IHN0cnVjdCBjc2NoZWQy
X3J1bnF1ZXVlX2RhdGEgKnJxZCwgc190aW1lX3QgY3JlZGl0LAorICAgICAgICAgICAgICAgICAg
ICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMpCiB7CiAgICAgcmV0dXJuIGNyZWRpdCAq
IHN2Yy0+d2VpZ2h0IC8gcnFkLT5tYXhfd2VpZ2h0OwogfQpAQCAtNzkyLDcgKzc5Myw3IEBAIHN0
YXRpYyBzX3RpbWVfdCBjMnQoc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFkLCBzX3Rp
bWVfdCBjcmVkaXQsIHN0cnVjdCBjCiAgKiBSdW5xdWV1ZSByZWxhdGVkIGNvZGUuCiAgKi8KIAot
c3RhdGljIGlubGluZSBpbnQgdW5pdF9vbl9ydW5xKHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YykK
K3N0YXRpYyBpbmxpbmUgaW50IHVuaXRfb25fcnVucShjb25zdCBzdHJ1Y3QgY3NjaGVkMl91bml0
ICpzdmMpCiB7CiAgICAgcmV0dXJuICFsaXN0X2VtcHR5KCZzdmMtPnJ1bnFfZWxlbSk7CiB9CkBA
IC04NDksOSArODUwLDkgQEAgc3RhdGljIGlubGluZSBib29sIHNhbWVfY29yZSh1bnNpZ25lZCBp
bnQgY3B1YSwgdW5zaWduZWQgaW50IGNwdWIpCiB9CiAKIHN0YXRpYyB1bnNpZ25lZCBpbnQKLWNw
dV90b19ydW5xdWV1ZShzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpwcnYsIHVuc2lnbmVkIGludCBj
cHUpCitjcHVfdG9fcnVucXVldWUoY29uc3Qgc3RydWN0IGNzY2hlZDJfcHJpdmF0ZSAqcHJ2LCB1
bnNpZ25lZCBpbnQgY3B1KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJx
ZDsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQ7CiAgICAgdW5z
aWduZWQgaW50IHJxaTsKIAogICAgIGZvciAoIHJxaSA9IDA7IHJxaSA8IG5yX2NwdV9pZHM7IHJx
aSsrICkKQEAgLTkxNyw3ICs5MTgsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfbWF4X3dlaWdodChz
dHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQsIGludCBuZXdfd2VpZ2h0LAogCiAgICAg
ICAgIGxpc3RfZm9yX2VhY2goIGl0ZXIsICZycWQtPnN2YyApCiAgICAgICAgIHsKLSAgICAgICAg
ICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKiBzdmMgPSBsaXN0X2VudHJ5KGl0ZXIsIHN0cnVjdCBj
c2NoZWQyX3VuaXQsIHJxZF9lbGVtKTsKKyAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQy
X3VuaXQgKiBzdmMgPSBsaXN0X2VudHJ5KGl0ZXIsIHN0cnVjdCBjc2NoZWQyX3VuaXQsIHJxZF9l
bGVtKTsKIAogICAgICAgICAgICAgaWYgKCBzdmMtPndlaWdodCA+IG1heF93ZWlnaHQgKQogICAg
ICAgICAgICAgICAgIG1heF93ZWlnaHQgPSBzdmMtPndlaWdodDsKQEAgLTk3MCw3ICs5NzEsNyBA
QCBfcnVucV9hc3NpZ24oc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjLCBzdHJ1Y3QgY3NjaGVkMl9y
dW5xdWV1ZV9kYXRhICpycWQpCiB9CiAKIHN0YXRpYyB2b2lkCi1ydW5xX2Fzc2lnbihjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorcnVucV9hc3Np
Z24oY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAq
dW5pdCkKIHsKICAgICBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMgPSB1bml0LT5wcml2OwogCkBA
IC05OTcsNyArOTk4LDcgQEAgX3J1bnFfZGVhc3NpZ24oc3RydWN0IGNzY2hlZDJfdW5pdCAqc3Zj
KQogfQogCiBzdGF0aWMgdm9pZAotcnVucV9kZWFzc2lnbihjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorcnVucV9kZWFzc2lnbihjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAg
IHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YyA9IHVuaXQtPnByaXY7CiAKQEAgLTEyMDMsNyArMTIw
NCw3IEBAIHN0YXRpYyB2b2lkCiB1cGRhdGVfc3ZjX2xvYWQoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqb3BzLAogICAgICAgICAgICAgICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YywgaW50IGNo
YW5nZSwgc190aW1lX3Qgbm93KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9
IGNzY2hlZDJfcHJpdihvcHMpOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBy
diA9IGNzY2hlZDJfcHJpdihvcHMpOwogICAgIHNfdGltZV90IGRlbHRhLCB1bml0X2xvYWQ7CiAg
ICAgdW5zaWduZWQgaW50IFAsIFc7CiAKQEAgLTEzNjIsMTEgKzEzNjMsMTEgQEAgc3RhdGljIGlu
bGluZSBib29sIGlzX3ByZWVtcHRhYmxlKGNvbnN0IHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YywK
ICAqIFdpdGhpbiB0aGUgc2FtZSBjbGFzcywgdGhlIGhpZ2hlc3QgZGlmZmVyZW5jZSBvZiBjcmVk
aXQuCiAgKi8KIHN0YXRpYyBzX3RpbWVfdCB0aWNrbGVfc2NvcmUoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzX3RpbWVfdCBub3csCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBjc2NoZWQyX3VuaXQgKm5ldywgdW5zaWduZWQgaW50IGNwdSkKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNzY2hlZDJfdW5pdCAqbmV3LCB1bnNpZ25lZCBp
bnQgY3B1KQogewogICAgIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCA9IGMycnFk
KG9wcywgY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkMl91bml0ICogY3VyID0gY3NjaGVkMl91bml0
KGN1cnJfb25fY3B1KGNwdSkpOwotICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNz
Y2hlZDJfcHJpdihvcHMpOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9
IGNzY2hlZDJfcHJpdihvcHMpOwogICAgIHNfdGltZV90IHNjb3JlOwogCiAgICAgLyoKQEAgLTE0
NDEsNyArMTQ0Miw3IEBAIHJ1bnFfdGlja2xlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IGNzY2hlZDJfdW5pdCAqbmV3LCBzX3RpbWVfdCBub3cpCiAgICAgc3RydWN0IHNjaGVk
X3VuaXQgKnVuaXQgPSBuZXctPnVuaXQ7CiAgICAgdW5zaWduZWQgaW50IGJzLCBjcHUgPSBzY2hl
ZF91bml0X21hc3Rlcih1bml0KTsKICAgICBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpy
cWQgPSBjMnJxZChvcHMsIGNwdSk7Ci0gICAgY3B1bWFza190ICpvbmxpbmUgPSBjcHVwb29sX2Rv
bWFpbl9tYXN0ZXJfY3B1bWFzayh1bml0LT5kb21haW4pOworICAgIGNvbnN0IGNwdW1hc2tfdCAq
b25saW5lID0gY3B1cG9vbF9kb21haW5fbWFzdGVyX2NwdW1hc2sodW5pdC0+ZG9tYWluKTsKICAg
ICBjcHVtYXNrX3QgbWFzazsKIAogICAgIEFTU0VSVChuZXctPnJxZCA9PSBycWQpOwpAQCAtMjAw
NSw3ICsyMDA2LDcgQEAgc3RhdGljIHZvaWQgcmVwbGVuaXNoX2RvbWFpbl9idWRnZXQodm9pZCog
ZGF0YSkKIAogI2lmbmRlZiBOREVCVUcKIHN0YXRpYyBpbmxpbmUgdm9pZAotY3NjaGVkMl91bml0
X2NoZWNrKHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorY3NjaGVkMl91bml0X2NoZWNrKGNvbnN0
IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKiBj
b25zdCBzdmMgPSBjc2NoZWQyX3VuaXQodW5pdCk7CiAgICAgc3RydWN0IGNzY2hlZDJfZG9tICog
Y29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKQEAgLTI1NDEsOCArMjU0Miw4IEBAIHN0YXRpYyB2b2lk
IG1pZ3JhdGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAogICogIC0gc3ZjIGlzIG5vdCBh
bHJlYWR5IGZsYWdnZWQgdG8gbWlncmF0ZSwKICAqICAtIGlmIHN2YyBpcyBhbGxvd2VkIHRvIHJ1
biBvbiBhdCBsZWFzdCBvbmUgb2YgdGhlIHBjcHVzIG9mIHJxZC4KICAqLwotc3RhdGljIGJvb2wg
dW5pdF9pc19taWdyYXRlYWJsZShzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFk
KQorc3RhdGljIGJvb2wgdW5pdF9pc19taWdyYXRlYWJsZShjb25zdCBzdHJ1Y3QgY3NjaGVkMl91
bml0ICpzdmMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBj
c2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCkKIHsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5p
dCA9IHN2Yy0+dW5pdDsKICAgICBpbnQgY3B1ID0gc2NoZWRfdW5pdF9tYXN0ZXIodW5pdCk7CkBA
IC0zMDc2LDcgKzMwNzcsNyBAQCBjc2NoZWQyX2ZyZWVfZG9tZGF0YShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHZvaWQgKmRhdGEpCiBzdGF0aWMgdm9pZAogY3NjaGVkMl91bml0X2luc2Vy
dChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQog
ewotICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YyA9IHVuaXQtPnByaXY7CisgICAgY29uc3Qg
c3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjID0gdW5pdC0+cHJpdjsKICAgICBzdHJ1Y3QgY3NjaGVk
Ml9kb20gKiBjb25zdCBzZG9tID0gc3ZjLT5zZG9tOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAK
QEAgLTMxNDIsNyArMzE0Myw3IEBAIGNzY2hlZDJfcnVudGltZShjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIGludCBjcHUsCiAgICAgaW50IHJ0X2NyZWRpdDsgLyogUHJvcG9zZWQgcnVudGlt
ZSBtZWFzdXJlZCBpbiBjcmVkaXRzICovCiAgICAgc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0
YSAqcnFkID0gYzJycWQob3BzLCBjcHUpOwogICAgIHN0cnVjdCBsaXN0X2hlYWQgKnJ1bnEgPSAm
cnFkLT5ydW5xOwotICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNzY2hlZDJfcHJp
dihvcHMpOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNzY2hlZDJf
cHJpdihvcHMpOwogCiAgICAgLyoKICAgICAgKiBJZiB3ZSdyZSBpZGxlLCBqdXN0IHN0YXkgc28u
IE90aGVycyAob3IgZXh0ZXJuYWwgZXZlbnRzKQpAQCAtMzIzOSw3ICszMjQwLDcgQEAgcnVucV9j
YW5kaWRhdGUoc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFkLAogICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50ICpza2lwcGVkKQogewogICAgIHN0cnVjdCBsaXN0X2hlYWQgKml0ZXIs
ICp0ZW1wOwotICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBnZXRfc2NoZWRfcmVzKGNw
dSk7CisgICAgY29uc3Qgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMo
Y3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzbmV4dCA9IE5VTEw7CiAgICAgc3RydWN0
IGNzY2hlZDJfcHJpdmF0ZSAqcHJ2ID0gY3NjaGVkMl9wcml2KHNyLT5zY2hlZHVsZXIpOwogICAg
IGJvb2wgeWllbGQgPSBmYWxzZSwgc29mdF9hZmZfcHJlZW1wdCA9IGZhbHNlOwpAQCAtMzYwMyw3
ICszNjA0LDggQEAgc3RhdGljIHZvaWQgY3NjaGVkMl9zY2hlZHVsZSgKIH0KIAogc3RhdGljIHZv
aWQKLWNzY2hlZDJfZHVtcF91bml0KHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiwgc3RydWN0
IGNzY2hlZDJfdW5pdCAqc3ZjKQorY3NjaGVkMl9kdW1wX3VuaXQoY29uc3Qgc3RydWN0IGNzY2hl
ZDJfcHJpdmF0ZSAqcHJ2LAorICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNzY2hlZDJf
dW5pdCAqc3ZjKQogewogICAgIHByaW50aygiWyVpLiVpXSBmbGFncz0leCBjcHU9JWkiLAogICAg
ICAgICAgICAgc3ZjLT51bml0LT5kb21haW4tPmRvbWFpbl9pZCwKQEAgLTM2MjYsOCArMzYyOCw4
IEBAIGNzY2hlZDJfZHVtcF91bml0KHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiwgc3RydWN0
IGNzY2hlZDJfdW5pdCAqc3ZjKQogc3RhdGljIGlubGluZSB2b2lkCiBkdW1wX3BjcHUoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBpbnQgY3B1KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3By
aXZhdGUgKnBydiA9IGNzY2hlZDJfcHJpdihvcHMpOwotICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQg
KnN2YzsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpwcnYgPSBjc2NoZWQyX3By
aXYob3BzKTsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmM7CiAKICAgICBwcmlu
dGsoIkNQVVslMDJkXSBydW5xPSVkLCBzaWJsaW5nPXslKnBibH0sIGNvcmU9eyUqcGJsfVxuIiwK
ICAgICAgICAgICAgY3B1LCBjMnIoY3B1KSwKQEAgLTM2OTUsOCArMzY5Nyw4IEBAIGNzY2hlZDJf
ZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgbG9vcCA9IDA7CiAgICAgbGlz
dF9mb3JfZWFjaCggaXRlcl9zZG9tLCAmcHJ2LT5zZG9tICkKICAgICB7Ci0gICAgICAgIHN0cnVj
dCBjc2NoZWQyX2RvbSAqc2RvbTsKLSAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQ7Cisg
ICAgICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX2RvbSAqc2RvbTsKKyAgICAgICAgY29uc3Qgc3Ry
dWN0IHNjaGVkX3VuaXQgKnVuaXQ7CiAKICAgICAgICAgc2RvbSA9IGxpc3RfZW50cnkoaXRlcl9z
ZG9tLCBzdHJ1Y3QgY3NjaGVkMl9kb20sIHNkb21fZWxlbSk7CiAKQEAgLTM3MzcsNyArMzczOSw3
IEBAIGNzY2hlZDJfZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgICAgIHBy
aW50aygiUlVOUTpcbiIpOwogICAgICAgICBsaXN0X2Zvcl9lYWNoKCBpdGVyLCBydW5xICkKICAg
ICAgICAgewotICAgICAgICAgICAgc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjID0gcnVucV9lbGVt
KGl0ZXIpOworICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjID0gcnVu
cV9lbGVtKGl0ZXIpOwogCiAgICAgICAgICAgICBpZiAoIHN2YyApCiAgICAgICAgICAgICB7CmRp
ZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkL251bGwuYyBiL3hlbi9jb21tb24vc2NoZWQvbnVs
bC5jCmluZGV4IDMxNjFhYzJlNjIuLjhjMzEwMTY0OWQgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
c2NoZWQvbnVsbC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWQvbnVsbC5jCkBAIC0yNzgsMTIgKzI3
OCwxMiBAQCBzdGF0aWMgdm9pZCBudWxsX2ZyZWVfZG9tZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHZvaWQgKmRhdGEpCiAgKiBTbyB0aGlzIGlzIG5vdCBwYXJ0IG9mIGFueSBob3Qg
cGF0aC4KICAqLwogc3RhdGljIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqCi1waWNrX3JlcyhzdHJ1
Y3QgbnVsbF9wcml2YXRlICpwcnYsIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorcGlj
a19yZXMoY29uc3Qgc3RydWN0IG51bGxfcHJpdmF0ZSAqcHJ2LCBjb25zdCBzdHJ1Y3Qgc2NoZWRf
dW5pdCAqdW5pdCkKIHsKICAgICB1bnNpZ25lZCBpbnQgYnM7CiAgICAgdW5zaWduZWQgaW50IGNw
dSA9IHNjaGVkX3VuaXRfbWFzdGVyKHVuaXQpLCBuZXdfY3B1OwotICAgIGNwdW1hc2tfdCAqY3B1
cyA9IGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVtYXNrKHVuaXQtPmRvbWFpbik7Ci0gICAgc3Ry
dWN0IG51bGxfcGNwdSAqbnBjID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5zY2hlZF9wcml2OworICAg
IGNvbnN0IGNwdW1hc2tfdCAqY3B1cyA9IGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVtYXNrKHVu
aXQtPmRvbWFpbik7CisgICAgY29uc3Qgc3RydWN0IG51bGxfcGNwdSAqbnBjID0gZ2V0X3NjaGVk
X3JlcyhjcHUpLT5zY2hlZF9wcml2OwogCiAgICAgQVNTRVJUKHNwaW5faXNfbG9ja2VkKGdldF9z
Y2hlZF9yZXMoY3B1KS0+c2NoZWR1bGVfbG9jaykpOwogCkBAIC0zNzUsNyArMzc1LDcgQEAgc3Rh
dGljIHZvaWQgdW5pdF9hc3NpZ24oc3RydWN0IG51bGxfcHJpdmF0ZSAqcHJ2LCBzdHJ1Y3Qgc2No
ZWRfdW5pdCAqdW5pdCwKIH0KIAogLyogUmV0dXJucyB0cnVlIGlmIGEgY3B1IHdhcyB0aWNrbGVk
ICovCi1zdGF0aWMgYm9vbCB1bml0X2RlYXNzaWduKHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiwg
c3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCitzdGF0aWMgYm9vbCB1bml0X2RlYXNzaWduKHN0cnVj
dCBudWxsX3ByaXZhdGUgKnBydiwgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAg
ICAgdW5zaWduZWQgaW50IGJzOwogICAgIHVuc2lnbmVkIGludCBjcHUgPSBzY2hlZF91bml0X21h
c3Rlcih1bml0KTsKQEAgLTQ0MSw3ICs0NDEsNyBAQCBzdGF0aWMgc3BpbmxvY2tfdCAqbnVsbF9z
d2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxlciAqbmV3X29wcywKIHsKICAgICBzdHJ1Y3Qgc2No
ZWRfcmVzb3VyY2UgKnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUpOwogICAgIHN0cnVjdCBudWxsX3By
aXZhdGUgKnBydiA9IG51bGxfcHJpdihuZXdfb3BzKTsKLSAgICBzdHJ1Y3QgbnVsbF91bml0ICpu
dmMgPSB2ZGF0YTsKKyAgICBjb25zdCBzdHJ1Y3QgbnVsbF91bml0ICpudmMgPSB2ZGF0YTsKIAog
ICAgIEFTU0VSVChudmMgJiYgaXNfaWRsZV91bml0KG52Yy0+dW5pdCkpOwogCkBAIC05NDAsNyAr
OTQwLDggQEAgc3RhdGljIHZvaWQgbnVsbF9zY2hlZHVsZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICpwcmV2LAogICAgIHByZXYtPm5leHRfdGFzay0+bWln
cmF0ZWQgPSBmYWxzZTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIGR1bXBfdW5pdChzdHJ1Y3Qg
bnVsbF9wcml2YXRlICpwcnYsIHN0cnVjdCBudWxsX3VuaXQgKm52YykKK3N0YXRpYyBpbmxpbmUg
dm9pZCBkdW1wX3VuaXQoY29uc3Qgc3RydWN0IG51bGxfcHJpdmF0ZSAqcHJ2LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgbnVsbF91bml0ICpudmMpCiB7CiAgICAg
cHJpbnRrKCJbJWkuJWldIHBjcHU9JWQiLCBudmMtPnVuaXQtPmRvbWFpbi0+ZG9tYWluX2lkLAog
ICAgICAgICAgICAgbnZjLT51bml0LT51bml0X2lkLCBsaXN0X2VtcHR5KCZudmMtPndhaXRxX2Vs
ZW0pID8KQEAgLTk1MCw4ICs5NTEsOCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZHVtcF91bml0KHN0
cnVjdCBudWxsX3ByaXZhdGUgKnBydiwgc3RydWN0IG51bGxfdW5pdCAqbnZjKQogc3RhdGljIHZv
aWQgbnVsbF9kdW1wX3BjcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBpbnQgY3B1KQog
ewogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiA9IG51bGxfcHJpdihvcHMpOwotICAgIHN0
cnVjdCBudWxsX3BjcHUgKm5wYyA9IGdldF9zY2hlZF9yZXMoY3B1KS0+c2NoZWRfcHJpdjsKLSAg
ICBzdHJ1Y3QgbnVsbF91bml0ICpudmM7CisgICAgY29uc3Qgc3RydWN0IG51bGxfcGNwdSAqbnBj
ID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5zY2hlZF9wcml2OworICAgIGNvbnN0IHN0cnVjdCBudWxs
X3VuaXQgKm52YzsKICAgICBzcGlubG9ja190ICpsb2NrOwogICAgIHVuc2lnbmVkIGxvbmcgZmxh
Z3M7CiAKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWQvcnQuYyBiL3hlbi9jb21tb24vc2No
ZWQvcnQuYwppbmRleCA2ZGM0YjZhNmU1Li5mOTBhNjA1NjQzIDEwMDY0NAotLS0gYS94ZW4vY29t
bW9uL3NjaGVkL3J0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZC9ydC5jCkBAIC0zNTIsNyArMzUy
LDcgQEAgc3RhdGljIHZvaWQKIHJ0X2R1bXBfcGNwdShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpv
cHMsIGludCBjcHUpCiB7CiAgICAgc3RydWN0IHJ0X3ByaXZhdGUgKnBydiA9IHJ0X3ByaXYob3Bz
KTsKLSAgICBzdHJ1Y3QgcnRfdW5pdCAqc3ZjOworICAgIGNvbnN0IHN0cnVjdCBydF91bml0ICpz
dmM7CiAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZw
cnYtPmxvY2ssIGZsYWdzKTsKQEAgLTM3MSw4ICszNzEsOCBAQCBydF9kdW1wKGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKm9wcykKIHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpydW5xLCAqZGVwbGV0
ZWRxLCAqcmVwbHEsICppdGVyOwogICAgIHN0cnVjdCBydF9wcml2YXRlICpwcnYgPSBydF9wcml2
KG9wcyk7Ci0gICAgc3RydWN0IHJ0X3VuaXQgKnN2YzsKLSAgICBzdHJ1Y3QgcnRfZG9tICpzZG9t
OworICAgIGNvbnN0IHN0cnVjdCBydF91bml0ICpzdmM7CisgICAgY29uc3Qgc3RydWN0IHJ0X2Rv
bSAqc2RvbTsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwogCiAgICAgc3Bpbl9sb2NrX2lycXNh
dmUoJnBydi0+bG9jaywgZmxhZ3MpOwpAQCAtNDA4LDcgKzQwOCw3IEBAIHJ0X2R1bXAoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzKQogICAgIHByaW50aygiRG9tYWluIGluZm86XG4iKTsKICAg
ICBsaXN0X2Zvcl9lYWNoICggaXRlciwgJnBydi0+c2RvbSApCiAgICAgewotICAgICAgICBzdHJ1
Y3Qgc2NoZWRfdW5pdCAqdW5pdDsKKyAgICAgICAgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVu
aXQ7CiAKICAgICAgICAgc2RvbSA9IGxpc3RfZW50cnkoaXRlciwgc3RydWN0IHJ0X2RvbSwgc2Rv
bV9lbGVtKTsKICAgICAgICAgcHJpbnRrKCJcdGRvbWFpbjogJWRcbiIsIHNkb20tPmRvbS0+ZG9t
YWluX2lkKTsKQEAgLTUwOSw3ICs1MDksNyBAQCBkZWFkbGluZV9xdWV1ZV9pbnNlcnQoc3RydWN0
IHJ0X3VuaXQgKiAoKnFlbGVtKShzdHJ1Y3QgbGlzdF9oZWFkICopLAogCiAgICAgbGlzdF9mb3Jf
ZWFjaCAoIGl0ZXIsIHF1ZXVlICkKICAgICB7Ci0gICAgICAgIHN0cnVjdCBydF91bml0ICogaXRl
cl9zdmMgPSAoKnFlbGVtKShpdGVyKTsKKyAgICAgICAgY29uc3Qgc3RydWN0IHJ0X3VuaXQgKiBp
dGVyX3N2YyA9ICgqcWVsZW0pKGl0ZXIpOwogICAgICAgICBpZiAoIGNvbXBhcmVfdW5pdF9wcmlv
cml0eShzdmMsIGl0ZXJfc3ZjKSA+IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGZp
cnN0ID0gZmFsc2U7CkBAIC01NDcsNyArNTQ3LDcgQEAgcmVwbHFfcmVtb3ZlKGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHJ0X3VuaXQgKnN2YykKICAgICAgICAgICovCiAgICAg
ICAgIGlmICggIWxpc3RfZW1wdHkocmVwbHEpICkKICAgICAgICAgewotICAgICAgICAgICAgc3Ry
dWN0IHJ0X3VuaXQgKnN2Y19uZXh0ID0gcmVwbHFfZWxlbShyZXBscS0+bmV4dCk7CisgICAgICAg
ICAgICBjb25zdCBzdHJ1Y3QgcnRfdW5pdCAqc3ZjX25leHQgPSByZXBscV9lbGVtKHJlcGxxLT5u
ZXh0KTsKICAgICAgICAgICAgIHNldF90aW1lcigmcHJ2LT5yZXBsX3RpbWVyLCBzdmNfbmV4dC0+
Y3VyX2RlYWRsaW5lKTsKICAgICAgICAgfQogICAgICAgICBlbHNlCkBAIC02MDQsNyArNjA0LDcg
QEAgc3RhdGljIHZvaWQKIHJlcGxxX3JlaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHJ0X3VuaXQgKnN2YykKIHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpyZXBscSA9
IHJ0X3JlcGxxKG9wcyk7Ci0gICAgc3RydWN0IHJ0X3VuaXQgKnJlYXJtX3N2YyA9IHN2YzsKKyAg
ICBjb25zdCBzdHJ1Y3QgcnRfdW5pdCAqcmVhcm1fc3ZjID0gc3ZjOwogICAgIGJvb2wgcmVhcm0g
PSBmYWxzZTsKIAogICAgIEFTU0VSVCggdW5pdF9vbl9yZXBscShzdmMpICk7CkBAIC02NDAsNyAr
NjQwLDcgQEAgc3RhdGljIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqCiBydF9yZXNfcGlja19sb2Nr
ZWQoY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsIHVuc2lnbmVkIGludCBsb2NrZWRfY3B1
KQogewogICAgIGNwdW1hc2tfdCAqY3B1cyA9IGNwdW1hc2tfc2NyYXRjaF9jcHUobG9ja2VkX2Nw
dSk7Ci0gICAgY3B1bWFza190ICpvbmxpbmU7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmU7
CiAgICAgaW50IGNwdTsKIAogICAgIG9ubGluZSA9IGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVt
YXNrKHVuaXQtPmRvbWFpbik7CkBAIC0xMDI4LDcgKzEwMjgsNyBAQCBydW5xX3BpY2soY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBjcHVtYXNrX3QgKm1hc2ssIHVuc2lnbmVkIGlu
dCBjcHUpCiAgICAgc3RydWN0IHJ0X3VuaXQgKnN2YyA9IE5VTEw7CiAgICAgc3RydWN0IHJ0X3Vu
aXQgKml0ZXJfc3ZjID0gTlVMTDsKICAgICBjcHVtYXNrX3QgKmNwdV9jb21tb24gPSBjcHVtYXNr
X3NjcmF0Y2hfY3B1KGNwdSk7Ci0gICAgY3B1bWFza190ICpvbmxpbmU7CisgICAgY29uc3QgY3B1
bWFza190ICpvbmxpbmU7CiAKICAgICBsaXN0X2Zvcl9lYWNoICggaXRlciwgcnVucSApCiAgICAg
ewpAQCAtMTE5NywxNSArMTE5NywxNSBAQCBydF91bml0X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiAgKiBsb2NrIGlzIGdyYWJiZWQg
YmVmb3JlIGNhbGxpbmcgdGhpcyBmdW5jdGlvbgogICovCiBzdGF0aWMgdm9pZAotcnVucV90aWNr
bGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgcnRfdW5pdCAqbmV3KQorcnVu
cV90aWNrbGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1Y3QgcnRfdW5p
dCAqbmV3KQogewogICAgIHN0cnVjdCBydF9wcml2YXRlICpwcnYgPSBydF9wcml2KG9wcyk7Ci0g
ICAgc3RydWN0IHJ0X3VuaXQgKmxhdGVzdF9kZWFkbGluZV91bml0ID0gTlVMTDsgLyogbG93ZXN0
IHByaW9yaXR5ICovCi0gICAgc3RydWN0IHJ0X3VuaXQgKml0ZXJfc3ZjOwotICAgIHN0cnVjdCBz
Y2hlZF91bml0ICppdGVyX3VuaXQ7CisgICAgY29uc3Qgc3RydWN0IHJ0X3VuaXQgKmxhdGVzdF9k
ZWFkbGluZV91bml0ID0gTlVMTDsgLyogbG93ZXN0IHByaW9yaXR5ICovCisgICAgY29uc3Qgc3Ry
dWN0IHJ0X3VuaXQgKml0ZXJfc3ZjOworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICppdGVy
X3VuaXQ7CiAgICAgaW50IGNwdSA9IDAsIGNwdV90b190aWNrbGUgPSAwOwogICAgIGNwdW1hc2tf
dCAqbm90X3RpY2tsZWQgPSBjcHVtYXNrX3NjcmF0Y2hfY3B1KHNtcF9wcm9jZXNzb3JfaWQoKSk7
Ci0gICAgY3B1bWFza190ICpvbmxpbmU7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmU7CiAK
ICAgICBpZiAoIG5ldyA9PSBOVUxMIHx8IGlzX2lkbGVfdW5pdChuZXctPnVuaXQpICkKICAgICAg
ICAgcmV0dXJuOwpAQCAtMTM3OSw3ICsxMzc5LDcgQEAgcnRfZG9tX2NudGwoCiB7CiAgICAgc3Ry
dWN0IHJ0X3ByaXZhdGUgKnBydiA9IHJ0X3ByaXYob3BzKTsKICAgICBzdHJ1Y3QgcnRfdW5pdCAq
c3ZjOwotICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0OworICAgIGNvbnN0IHN0cnVjdCBzY2hl
ZF91bml0ICp1bml0OwogICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgaW50IHJjID0gMDsK
ICAgICBzdHJ1Y3QgeGVuX2RvbWN0bF9zY2hlZHBhcmFtX3ZjcHUgbG9jYWxfc2NoZWQ7CkBAIC0x
NDg0LDcgKzE0ODQsNyBAQCBydF9kb21fY250bCgKICAqLwogc3RhdGljIHZvaWQgcmVwbF90aW1l
cl9oYW5kbGVyKHZvaWQgKmRhdGEpewogICAgIHNfdGltZV90IG5vdzsKLSAgICBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMgPSBkYXRhOworICAgIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcyA9IGRh
dGE7CiAgICAgc3RydWN0IHJ0X3ByaXZhdGUgKnBydiA9IHJ0X3ByaXYob3BzKTsKICAgICBzdHJ1
Y3QgbGlzdF9oZWFkICpyZXBscSA9IHJ0X3JlcGxxKG9wcyk7CiAgICAgc3RydWN0IGxpc3RfaGVh
ZCAqcnVucSA9IHJ0X3J1bnEob3BzKTsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hl
ZC5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKaW5kZXggY2Y3YWEzOTg0NC4uN2M1YzQzNzI0
NyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2luY2x1ZGUv
eGVuL3NjaGVkLmgKQEAgLTc3Myw3ICs3NzMsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaHlwZXJj
YWxsX2NhbmNlbF9jb250aW51YXRpb24oc3RydWN0IHZjcHUgKnYpCiBleHRlcm4gc3RydWN0IGRv
bWFpbiAqZG9tYWluX2xpc3Q7CiAKIC8qIENhbGxlciBtdXN0IGhvbGQgdGhlIGRvbWxpc3RfcmVh
ZF9sb2NrIG9yIGRvbWxpc3RfdXBkYXRlX2xvY2suICovCi1zdGF0aWMgaW5saW5lIHN0cnVjdCBk
b21haW4gKmZpcnN0X2RvbWFpbl9pbl9jcHVwb29sKCBzdHJ1Y3QgY3B1cG9vbCAqYykKK3N0YXRp
YyBpbmxpbmUgc3RydWN0IGRvbWFpbiAqZmlyc3RfZG9tYWluX2luX2NwdXBvb2woY29uc3Qgc3Ry
dWN0IGNwdXBvb2wgKmMpCiB7CiAgICAgc3RydWN0IGRvbWFpbiAqZDsKICAgICBmb3IgKGQgPSBy
Y3VfZGVyZWZlcmVuY2UoZG9tYWluX2xpc3QpOyBkICYmIGQtPmNwdXBvb2wgIT0gYzsKQEAgLTc4
MSw3ICs3ODEsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBkb21haW4gKmZpcnN0X2RvbWFpbl9p
bl9jcHVwb29sKCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICByZXR1cm4gZDsKIH0KIHN0YXRpYyBp
bmxpbmUgc3RydWN0IGRvbWFpbiAqbmV4dF9kb21haW5faW5fY3B1cG9vbCgKLSAgICBzdHJ1Y3Qg
ZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKKyAgICBzdHJ1Y3QgZG9tYWluICpkLCBjb25z
dCBzdHJ1Y3QgY3B1cG9vbCAqYykKIHsKICAgICBmb3IgKGQgPSByY3VfZGVyZWZlcmVuY2UoZC0+
bmV4dF9pbl9saXN0KTsgZCAmJiBkLT5jcHVwb29sICE9IGM7CiAgICAgICAgICBkID0gcmN1X2Rl
cmVmZXJlbmNlKGQtPm5leHRfaW5fbGlzdCkpOwpAQCAtOTI1LDcgKzkyNSw4IEBAIHZvaWQgcmVz
dG9yZV92Y3B1X2FmZmluaXR5KHN0cnVjdCBkb21haW4gKmQpOwogaW50IHZjcHVfYWZmaW5pdHlf
ZG9tY3RsKHN0cnVjdCBkb21haW4gKmQsIHVpbnQzMl90IGNtZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgeGVuX2RvbWN0bF92Y3B1YWZmaW5pdHkgKnZjcHVhZmYpOwogCi12b2lk
IHZjcHVfcnVuc3RhdGVfZ2V0KHN0cnVjdCB2Y3B1ICp2LCBzdHJ1Y3QgdmNwdV9ydW5zdGF0ZV9p
bmZvICpydW5zdGF0ZSk7Cit2b2lkIHZjcHVfcnVuc3RhdGVfZ2V0KGNvbnN0IHN0cnVjdCB2Y3B1
ICp2LAorICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmNwdV9ydW5zdGF0ZV9pbmZvICpy
dW5zdGF0ZSk7CiB1aW50NjRfdCBnZXRfY3B1X2lkbGVfdGltZSh1bnNpZ25lZCBpbnQgY3B1KTsK
IHZvaWQgc2NoZWRfZ3Vlc3RfaWRsZSh2b2lkICgqaWRsZSkgKHZvaWQpLCB1bnNpZ25lZCBpbnQg
Y3B1KTsKIHZvaWQgc2NoZWR1bGVyX2VuYWJsZSh2b2lkKTsKQEAgLTEwNTYsNyArMTA1Nyw3IEBA
IGV4dGVybiBlbnVtIGNwdWZyZXFfY29udHJvbGxlciB7CiBpbnQgY3B1cG9vbF9tb3ZlX2RvbWFp
bihzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYyk7CiBpbnQgY3B1cG9vbF9kb19z
eXNjdGwoc3RydWN0IHhlbl9zeXNjdGxfY3B1cG9vbF9vcCAqb3ApOwogaW50IGNwdXBvb2xfZ2V0
X2lkKGNvbnN0IHN0cnVjdCBkb21haW4gKmQpOwotY3B1bWFza190ICpjcHVwb29sX3ZhbGlkX2Nw
dXMoc3RydWN0IGNwdXBvb2wgKnBvb2wpOworY29uc3QgY3B1bWFza190ICpjcHVwb29sX3ZhbGlk
X2NwdXMoY29uc3Qgc3RydWN0IGNwdXBvb2wgKnBvb2wpOwogZXh0ZXJuIHZvaWQgZHVtcF9ydW5x
KHVuc2lnbmVkIGNoYXIga2V5KTsKIAogdm9pZCBhcmNoX2RvX3BoeXNpbmZvKHN0cnVjdCB4ZW5f
c3lzY3RsX3BoeXNpbmZvICpwaSk7Ci0tIAoyLjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZl
bEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxt
YW4vbGlzdGluZm8veGVuLWRldmVs

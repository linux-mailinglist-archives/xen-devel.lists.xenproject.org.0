Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 7DE75BEF07
	for <lists+xen-devel@lfdr.de>; Thu, 26 Sep 2019 11:53:40 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDQPO-0007F4-Dm; Thu, 26 Sep 2019 09:49:58 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Ph5t=XV=amazon.com=prvs=165c3e20f=hongyax@srs-us1.protection.inumbo.net>)
 id 1iDQPL-0007BU-V1
 for xen-devel@lists.xenproject.org; Thu, 26 Sep 2019 09:49:56 +0000
X-Inumbo-ID: dfc72af2-e042-11e9-964c-12813bfff9fa
Received: from smtp-fw-2101.amazon.com (unknown [72.21.196.25])
 by localhost (Halon) with ESMTPS
 id dfc72af2-e042-11e9-964c-12813bfff9fa;
 Thu, 26 Sep 2019 09:49:03 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
 t=1569491343; x=1601027343;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=SACdUBbbExS2N8tVnCoyvdJrMIaNKqA8nFeqqiztjxw=;
 b=H9XpqcXvRMU2WdWuQHXLy7tdwgiz7IxJUSnxIp7gmI6v7L/gdIq8E06W
 /b3FAdwt4JLx4c9kCbzD2YdQoJAL2EGqh5g6BvI51KaMySl+6pyplU7Ds
 k5S2j2aUOXU2OF8YnUBuTS1CS1k6IKwXzTJ9zDlPzGOg6+E0hbVJPWbMN U=;
X-IronPort-AV: E=Sophos;i="5.64,551,1559520000"; d="scan'208";a="753354302"
Received: from iad6-co-svc-p1-lb1-vlan2.amazon.com (HELO
 email-inbound-relay-1e-17c49630.us-east-1.amazon.com) ([10.124.125.2])
 by smtp-border-fw-out-2101.iad2.amazon.com with ESMTP;
 26 Sep 2019 09:49:03 +0000
Received: from EX13MTAUWA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1e-17c49630.us-east-1.amazon.com (Postfix) with ESMTPS
 id 39407A2A4A; Thu, 26 Sep 2019 09:49:03 +0000 (UTC)
Received: from EX13D27UWA003.ant.amazon.com (10.43.160.56) by
 EX13MTAUWA001.ant.amazon.com (10.43.160.118) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 26 Sep 2019 09:48:37 +0000
Received: from EX13MTAUWA001.ant.amazon.com (10.43.160.58) by
 EX13D27UWA003.ant.amazon.com (10.43.160.56) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 26 Sep 2019 09:48:36 +0000
Received: from u9d785c4ba99158.ant.amazon.com (10.125.106.58) by
 mail-relay.amazon.com (10.43.160.118) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Thu, 26 Sep 2019 09:48:35 +0000
From: <hongyax@amazon.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 26 Sep 2019 10:46:19 +0100
Message-ID: <28a37c34184073178dfc096729179b44b06baa1c.1569489002.git.hongyax@amazon.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <cover.1569489002.git.hongyax@amazon.com>
References: <cover.1569489002.git.hongyax@amazon.com>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [RFC PATCH 56/84] x86/mm: drop _new suffix for page
 table APIs
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wei.liu2@citrix.com>,
 Wei Liu <wl@xen.org>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogV2VpIExpdSA8d2VpLmxpdTJAY2l0cml4LmNvbT4KClNpZ25lZC1vZmYtYnk6IFdlaSBM
aXUgPHdlaS5saXUyQGNpdHJpeC5jb20+Ci0tLQogeGVuL2FyY2gveDg2L2RvbWFpbi5jICAgICAg
ICB8ICAgNCArLQogeGVuL2FyY2gveDg2L2RvbWFpbl9wYWdlLmMgICB8ICAgMiArLQogeGVuL2Fy
Y2gveDg2L2VmaS9ydW50aW1lLmggICB8ICAgNCArLQogeGVuL2FyY2gveDg2L21tLmMgICAgICAg
ICAgICB8IDE2NCArKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLQogeGVuL2FyY2gv
eDg2L3B2L2RvbTBfYnVpbGQuYyB8ICAyOCArKystLS0KIHhlbi9hcmNoL3g4Ni9wdi9zaGltLmMg
ICAgICAgfCAgMTIgKy0tCiB4ZW4vYXJjaC94ODYvc2V0dXAuYyAgICAgICAgIHwgICA4ICstCiB4
ZW4vYXJjaC94ODYvc21wYm9vdC5jICAgICAgIHwgIDc0ICsrKysrKysrLS0tLS0tLS0KIHhlbi9h
cmNoL3g4Ni94ODZfNjQvbW0uYyAgICAgfCAxMzYgKysrKysrKysrKysrKystLS0tLS0tLS0tLS0t
LS0KIHhlbi9jb21tb24vZWZpL2Jvb3QuYyAgICAgICAgfCAgNDIgKysrKy0tLS0tCiB4ZW4vaW5j
bHVkZS9hc20teDg2L21tLmggICAgIHwgIDE4ICsrLS0KIDExIGZpbGVzIGNoYW5nZWQsIDI0NiBp
bnNlcnRpb25zKCspLCAyNDYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L2RvbWFpbi5jIGIveGVuL2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IGExMWIwNWVhNWEuLjc1ZTg5
YjgxYmYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94ZW4vYXJjaC94
ODYvZG9tYWluLmMKQEAgLTE1ODgsMTEgKzE1ODgsMTEgQEAgdm9pZCBwYXJhdmlydF9jdHh0X3N3
aXRjaF90byhzdHJ1Y3QgdmNwdSAqdikKICAgICAgICAgcm9vdF9wZ2VudHJ5X3QgKnJwdDsKIAog
ICAgICAgICBtYXBjYWNoZV9vdmVycmlkZV9jdXJyZW50KElOVkFMSURfVkNQVSk7Ci0gICAgICAg
IHJwdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhycHRfbWZuKTsKKyAgICAgICAgcnB0ID0gbWFw
X3hlbl9wYWdldGFibGUocnB0X21mbik7CiAgICAgICAgIHJwdFtyb290X3RhYmxlX29mZnNldChQ
RVJET01BSU5fVklSVF9TVEFSVCldID0KICAgICAgICAgICAgIGw0ZV9mcm9tX3BhZ2Uodi0+ZG9t
YWluLT5hcmNoLnBlcmRvbWFpbl9sM19wZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgX19Q
QUdFX0hZUEVSVklTT1JfUlcpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhycHQp
OworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHJwdCk7CiAgICAgICAgIG1hcGNhY2hlX292
ZXJyaWRlX2N1cnJlbnQoTlVMTCk7CiAgICAgfQogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYv
ZG9tYWluX3BhZ2UuYyBiL3hlbi9hcmNoL3g4Ni9kb21haW5fcGFnZS5jCmluZGV4IGNmY2ZmZDM1
ZjMuLjllYTc0YjQ1NmMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW5fcGFnZS5jCisr
KyBiL3hlbi9hcmNoL3g4Ni9kb21haW5fcGFnZS5jCkBAIC0zNDMsNyArMzQzLDcgQEAgbWZuX3Qg
ZG9tYWluX3BhZ2VfbWFwX3RvX21mbihjb25zdCB2b2lkICpwdHIpCiAgICAgICAgIGwxX3BnZW50
cnlfdCAqcGwxZSA9IHZpcnRfdG9feGVuX2wxZSh2YSk7CiAgICAgICAgIEJVR19PTighcGwxZSk7
CiAgICAgICAgIGwxZSA9ICpwbDFlOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhw
bDFlKTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDFlKTsKICAgICB9CiAgICAgZWxz
ZQogICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9lZmkvcnVudGltZS5oIGIveGVuL2Fy
Y2gveDg2L2VmaS9ydW50aW1lLmgKaW5kZXggMjc3ZDIzNzk1My4uY2ExNWM1YWFiNyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2VmaS9ydW50aW1lLmgKKysrIGIveGVuL2FyY2gveDg2L2VmaS9y
dW50aW1lLmgKQEAgLTEwLDkgKzEwLDkgQEAgdm9pZCBlZmlfdXBkYXRlX2w0X3BndGFibGUodW5z
aWduZWQgaW50IGw0aWR4LCBsNF9wZ2VudHJ5X3QgbDRlKQogICAgIHsKICAgICAgICAgbDRfcGdl
bnRyeV90ICpsNHQ7CiAKLSAgICAgICAgbDR0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGVmaV9s
NF9tZm4pOworICAgICAgICBsNHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShlZmlfbDRfbWZuKTsKICAg
ICAgICAgbDRlX3dyaXRlKGw0dCArIGw0aWR4LCBsNGUpOwotICAgICAgICBVTk1BUF9YRU5fUEFH
RVRBQkxFX05FVyhsNHQpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGw0dCk7CiAgICAg
fQogfQogI2VuZGlmCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4
Ni9tbS5jCmluZGV4IDhlMzNjOGY0ZmUuLmIyYjJlZGJlZDEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC0zNTMsMjIgKzM1MywyMiBAQCB2
b2lkIF9faW5pdCBhcmNoX2luaXRfbWVtb3J5KHZvaWQpCiAgICAgICAgICAgICBBU1NFUlQocm9v
dF9wZ3RfcHZfeGVuX3Nsb3RzIDwgUk9PVF9QQUdFVEFCTEVfUFZfWEVOX1NMT1RTKTsKICAgICAg
ICAgICAgIGlmICggbDRfdGFibGVfb2Zmc2V0KHNwbGl0X3ZhKSA9PSBsNF90YWJsZV9vZmZzZXQo
c3BsaXRfdmEgLSAxKSApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgbWZuX3QgbDN0
YWJfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgICAgICBtZm5f
dCBsM3RhYl9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAKICAgICAgICAgICAgICAgICBp
ZiAoICFtZm5fZXEobDN0YWJfbWZuLCBJTlZBTElEX01GTikgKQogICAgICAgICAgICAgICAgIHsK
ICAgICAgICAgICAgICAgICAgICAgbDNfcGdlbnRyeV90ICpsM2lkbGUgPQotICAgICAgICAgICAg
ICAgICAgICAgICAgbWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgICAgICAgICAgICAgICAgICAg
ICAgbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbDRlX2dl
dF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9vZmZzZXQoc3BsaXRfdmEpXSkpOwotICAgICAg
ICAgICAgICAgICAgICBsM19wZ2VudHJ5X3QgKmwzdGFiID0gbWFwX3hlbl9wYWdldGFibGVfbmV3
KGwzdGFiX21mbik7CisgICAgICAgICAgICAgICAgICAgIGwzX3BnZW50cnlfdCAqbDN0YWIgPSBt
YXBfeGVuX3BhZ2V0YWJsZShsM3RhYl9tZm4pOwogCiAgICAgICAgICAgICAgICAgICAgIGZvciAo
IGkgPSAwOyBpIDwgbDNfdGFibGVfb2Zmc2V0KHNwbGl0X3ZhKTsgKytpICkKICAgICAgICAgICAg
ICAgICAgICAgICAgIGwzdGFiW2ldID0gbDNpZGxlW2ldOwogICAgICAgICAgICAgICAgICAgICBm
b3IgKCA7IGkgPCBMM19QQUdFVEFCTEVfRU5UUklFUzsgKytpICkKICAgICAgICAgICAgICAgICAg
ICAgICAgIGwzdGFiW2ldID0gbDNlX2VtcHR5KCk7CiAgICAgICAgICAgICAgICAgICAgIHNwbGl0
X2w0ZSA9IGw0ZV9mcm9tX21mbihsM3RhYl9tZm4sIF9fUEFHRV9IWVBFUlZJU09SX1JXKTsKLSAg
ICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDNpZGxlKTsKLSAgICAg
ICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0YWIpOworICAgICAgICAg
ICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzaWRsZSk7CisgICAgICAgICAgICAgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0YWIpOwogICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICsrcm9vdF9wZ3RfcHZfeGVuX3Ns
b3RzOwpAQCAtNDg1MCw3ICs0ODUwLDcgQEAgaW50IG1tY2ZnX2ludGVyY2VwdF93cml0ZSgKICAg
ICByZXR1cm4gWDg2RU1VTF9PS0FZOwogfQogCi1tZm5fdCBhbGxvY194ZW5fcGFnZXRhYmxlX25l
dyh2b2lkKQorbWZuX3QgYWxsb2NfeGVuX3BhZ2V0YWJsZSh2b2lkKQogewogICAgIGlmICggc3lz
dGVtX3N0YXRlICE9IFNZU19TVEFURV9lYXJseV9ib290ICkKICAgICB7CkBAIC00ODYzLDIwICs0
ODYzLDIwIEBAIG1mbl90IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KHZvaWQpCiAgICAgcmV0dXJu
IGFsbG9jX2Jvb3RfcGFnZXMoMSwgMSk7CiB9CiAKLXZvaWQgKm1hcF94ZW5fcGFnZXRhYmxlX25l
dyhtZm5fdCBtZm4pCit2b2lkICptYXBfeGVuX3BhZ2V0YWJsZShtZm5fdCBtZm4pCiB7CiAgICAg
cmV0dXJuIG1hcF9kb21haW5fcGFnZShtZm4pOwogfQogCiAvKiB2IGNhbiBwb2ludCB0byBhbiBl
bnRyeSB3aXRoaW4gYSB0YWJsZSBvciBiZSBOVUxMICovCi12b2lkIHVubWFwX3hlbl9wYWdldGFi
bGVfbmV3KHZvaWQgKnYpCit2b2lkIHVubWFwX3hlbl9wYWdldGFibGUodm9pZCAqdikKIHsKICAg
ICBpZiAoIHYgKQogICAgICAgICB1bm1hcF9kb21haW5fcGFnZSgoY29uc3Qgdm9pZCAqKSgodW5z
aWduZWQgbG9uZyl2ICYgUEFHRV9NQVNLKSk7CiB9CiAKIC8qIG1mbiBjYW4gYmUgSU5WQUxJRF9N
Rk4gKi8KLXZvaWQgZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhtZm5fdCBtZm4pCit2b2lkIGZyZWVf
eGVuX3BhZ2V0YWJsZShtZm5fdCBtZm4pCiB7CiAgICAgaWYgKCBzeXN0ZW1fc3RhdGUgIT0gU1lT
X1NUQVRFX2Vhcmx5X2Jvb3QgJiYgIW1mbl9lcShtZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAg
IGZyZWVfZG9taGVhcF9wYWdlKG1mbl90b19wYWdlKG1mbikpOwpAQCAtNDkwMCwxMSArNDkwMCwx
MSBAQCBzdGF0aWMgbDNfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sM2UodW5zaWduZWQgbG9uZyB2
KQogICAgICAgICBsM19wZ2VudHJ5X3QgKmwzdDsKICAgICAgICAgbWZuX3QgbWZuOwogCi0gICAg
ICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgIG1mbiA9IGFsbG9j
X3hlbl9wYWdldGFibGUoKTsKICAgICAgICAgaWYgKCBtZm5fZXEobWZuLCBJTlZBTElEX01GTikg
KQogICAgICAgICAgICAgZ290byBvdXQ7CiAKLSAgICAgICAgbDN0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KG1mbik7CisgICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlKG1mbik7CiAKICAg
ICAgICAgaWYgKCBsb2NraW5nICkKICAgICAgICAgICAgIHNwaW5fbG9jaygmbWFwX3BnZGlyX2xv
Y2spOwpAQCAtNDkyNCwxNSArNDkyNCwxNSBAQCBzdGF0aWMgbDNfcGdlbnRyeV90ICp2aXJ0X3Rv
X3hlbl9sM2UodW5zaWduZWQgbG9uZyB2KQogICAgICAgICB7CiAgICAgICAgICAgICBBU1NFUlQo
IXBsM2UpOwogICAgICAgICAgICAgQVNTRVJUKCFtZm5fZXEobWZuLCBJTlZBTElEX01GTikpOwot
ICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0KTsKLSAgICAgICAgICAgIGZy
ZWVfeGVuX3BhZ2V0YWJsZV9uZXcobWZuKTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEUobDN0KTsKKyAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShtZm4pOwogICAgICAgICB9
CiAgICAgfQogCiAgICAgaWYgKCAhcGwzZSApCiAgICAgewogICAgICAgICBBU1NFUlQobDRlX2dl
dF9mbGFncygqcGw0ZSkgJiBfUEFHRV9QUkVTRU5UKTsKLSAgICAgICAgcGwzZSA9IChsM19wZ2Vu
dHJ5X3QgKiltYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDRlX2dldF9tZm4oKnBsNGUpKQorICAgICAg
ICBwbDNlID0gKGwzX3BnZW50cnlfdCAqKW1hcF94ZW5fcGFnZXRhYmxlKGw0ZV9nZXRfbWZuKCpw
bDRlKSkKICAgICAgICAgICAgICsgbDNfdGFibGVfb2Zmc2V0KHYpOwogICAgIH0KIApAQCAtNDk1
OSwxMSArNDk1OSwxMSBAQCBzdGF0aWMgbDJfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMmUodW5z
aWduZWQgbG9uZyB2KQogICAgICAgICBsMl9wZ2VudHJ5X3QgKmwydDsKICAgICAgICAgbWZuX3Qg
bWZuOwogCi0gICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAg
IG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICAgICAgaWYgKCBtZm5fZXEobWZuLCBJ
TlZBTElEX01GTikgKQogICAgICAgICAgICAgZ290byBvdXQ7CiAKLSAgICAgICAgbDJ0ID0gbWFw
X3hlbl9wYWdldGFibGVfbmV3KG1mbik7CisgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxl
KG1mbik7CiAKICAgICAgICAgaWYgKCBsb2NraW5nICkKICAgICAgICAgICAgIHNwaW5fbG9jaygm
bWFwX3BnZGlyX2xvY2spOwpAQCAtNDk4MSw4ICs0OTgxLDggQEAgc3RhdGljIGwyX3BnZW50cnlf
dCAqdmlydF90b194ZW5fbDJlKHVuc2lnbmVkIGxvbmcgdikKICAgICAgICAgewogICAgICAgICAg
ICAgQVNTRVJUKCFwbDJlKTsKICAgICAgICAgICAgIEFTU0VSVCghbWZuX2VxKG1mbiwgSU5WQUxJ
RF9NRk4pKTsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Ci0gICAg
ICAgICAgICBmcmVlX3hlbl9wYWdldGFibGVfbmV3KG1mbik7CisgICAgICAgICAgICBVTk1BUF9Y
RU5fUEFHRVRBQkxFKGwydCk7CisgICAgICAgICAgICBmcmVlX3hlbl9wYWdldGFibGUobWZuKTsK
ICAgICAgICAgfQogICAgIH0KIApAQCAtNDk5MSwxMiArNDk5MSwxMiBAQCBzdGF0aWMgbDJfcGdl
bnRyeV90ICp2aXJ0X3RvX3hlbl9sMmUodW5zaWduZWQgbG9uZyB2KQogICAgIGlmICggIXBsMmUg
KQogICAgIHsKICAgICAgICAgQVNTRVJUKGwzZV9nZXRfZmxhZ3MoKnBsM2UpICYgX1BBR0VfUFJF
U0VOVCk7Ci0gICAgICAgIHBsMmUgPSAobDJfcGdlbnRyeV90ICopbWFwX3hlbl9wYWdldGFibGVf
bmV3KGwzZV9nZXRfbWZuKCpwbDNlKSkKKyAgICAgICAgcGwyZSA9IChsMl9wZ2VudHJ5X3QgKilt
YXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0X21mbigqcGwzZSkpCiAgICAgICAgICAgICArIGwyX3Rh
YmxlX29mZnNldCh2KTsKICAgICB9CiAKICBvdXQ6Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9O
RVcocGwzZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDNlKTsKICAgICByZXR1cm4gcGwy
ZTsKIH0KIApAQCAtNTAxNSwxMSArNTAxNSwxMSBAQCBsMV9wZ2VudHJ5X3QgKnZpcnRfdG9feGVu
X2wxZSh1bnNpZ25lZCBsb25nIHYpCiAgICAgICAgIGwxX3BnZW50cnlfdCAqbDF0OwogICAgICAg
ICBtZm5fdCBtZm47CiAKLSAgICAgICAgbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsK
KyAgICAgICAgbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICBpZiAoIG1mbl9l
cShtZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAgICAgICBnb3RvIG91dDsKIAotICAgICAgICBs
MXQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobWZuKTsKKyAgICAgICAgbDF0ID0gbWFwX3hlbl9w
YWdldGFibGUobWZuKTsKIAogICAgICAgICBpZiAoIGxvY2tpbmcgKQogICAgICAgICAgICAgc3Bp
bl9sb2NrKCZtYXBfcGdkaXJfbG9jayk7CkBAIC01MDM3LDggKzUwMzcsOCBAQCBsMV9wZ2VudHJ5
X3QgKnZpcnRfdG9feGVuX2wxZSh1bnNpZ25lZCBsb25nIHYpCiAgICAgICAgIHsKICAgICAgICAg
ICAgIEFTU0VSVCghcGwxZSk7CiAgICAgICAgICAgICBBU1NFUlQoIW1mbl9lcShtZm4sIElOVkFM
SURfTUZOKSk7Ci0gICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOwotICAg
ICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhtZm4pOworICAgICAgICAgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShsMXQpOworICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKG1mbik7
CiAgICAgICAgIH0KICAgICB9CiAKQEAgLTUwNDcsMTIgKzUwNDcsMTIgQEAgbDFfcGdlbnRyeV90
ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9uZyB2KQogICAgIGlmICggIXBsMWUgKQogICAg
IHsKICAgICAgICAgQVNTRVJUKGwyZV9nZXRfZmxhZ3MoKnBsMmUpICYgX1BBR0VfUFJFU0VOVCk7
Ci0gICAgICAgIHBsMWUgPSAobDFfcGdlbnRyeV90ICopbWFwX3hlbl9wYWdldGFibGVfbmV3KGwy
ZV9nZXRfbWZuKCpwbDJlKSkKKyAgICAgICAgcGwxZSA9IChsMV9wZ2VudHJ5X3QgKiltYXBfeGVu
X3BhZ2V0YWJsZShsMmVfZ2V0X21mbigqcGwyZSkpCiAgICAgICAgICAgICArIGwxX3RhYmxlX29m
ZnNldCh2KTsKICAgICB9CiAKICBvdXQ6Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwy
ZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDJlKTsKICAgICByZXR1cm4gcGwxZTsKIH0K
IApAQCAtNTEzMSw3ICs1MTMxLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAg
ICAgICAgICAgIGwyX3BnZW50cnlfdCAqbDJ0OwogICAgICAgICAgICAgICAgICAgICBtZm5fdCBs
MnRfbWZuID0gbDNlX2dldF9tZm4ob2wzZSk7CiAKLSAgICAgICAgICAgICAgICAgICAgbDJ0ID0g
bWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAgICAgICAgICAgICAgICAgICBsMnQg
PSBtYXBfeGVuX3BhZ2V0YWJsZShsMnRfbWZuKTsKIAogICAgICAgICAgICAgICAgICAgICBmb3Ig
KCBpID0gMDsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAg
ICAgICB7CkBAIC01MTQ2LDEwICs1MTQ2LDEwIEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGwxX3BnZW50cnlfdCAqbDF0OwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG1mbl90IGwxdF9tZm4gPSBsMmVfZ2V0X21mbihvbDJlKTsKIAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMXRf
bWZuKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJs
ZShsMXRfbWZuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKCBqID0gMDsgaiA8
IEwxX1BBR0VUQUJMRV9FTlRSSUVTOyBqKysgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmbHVzaF9mbGFncyhsMWVfZ2V0X2ZsYWdzKGwxdFtqXSkpOwotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7CisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMXQpOwogICAgICAgICAgICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgIGZs
dXNoX2FyZWEodmlydCwgZmx1c2hfZmxhZ3MpOwpAQCAtNTE1OCw5ICs1MTU4LDkgQEAgaW50IG1h
cF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAgICAgICAgICBvbDJlID0gbDJ0W2ldOwog
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAobDJlX2dldF9mbGFncyhvbDJlKSAmIF9QQUdF
X1BSRVNFTlQpICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEobDJlX2dldF9mbGFn
cyhvbDJlKSAmIF9QQUdFX1BTRSkgKQotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyZWVf
eGVuX3BhZ2V0YWJsZV9uZXcobDJlX2dldF9tZm4ob2wyZSkpOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShsMmVfZ2V0X21mbihvbDJlKSk7CiAgICAgICAg
ICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25l
dyhsMnRfbWZuKTsKKyAgICAgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwydF9t
Zm4pOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgIH0KIApAQCAtNTE5OSwxNCArNTE5
OSwxNCBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICAgICAgICAgICAgICBnb3RvIGVuZF9v
Zl9sb29wOwogICAgICAgICAgICAgfQogCi0gICAgICAgICAgICBsMnRfbWZuID0gYWxsb2NfeGVu
X3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgIGwydF9tZm4gPSBhbGxvY194ZW5fcGFnZXRh
YmxlKCk7CiAgICAgICAgICAgICBpZiAoIG1mbl9lcShsMnRfbWZuLCBJTlZBTElEX01GTikgKQog
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIEFTU0VSVChyYyA9PSAtRU5PTUVNKTsKICAg
ICAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgICAgIH0KIAotICAgICAgICAgICAgbDJ0
ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAgICAgICAgICAgbDJ0ID0gbWFw
X3hlbl9wYWdldGFibGUobDJ0X21mbik7CiAKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwg
TDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgbDJlX3dyaXRlKGwy
dCArIGksCkBAIC01MjI0LDcgKzUyMjQsNyBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgICBsM2Vfd3JpdGVfYXRvbWljKHBsM2UsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsM2VfZnJvbV9tZm4obDJ0X21mbiwgX19QQUdFX0hZ
UEVSVklTT1IpKTsKLSAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQp
OworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJ0KTsKICAgICAgICAgICAg
ICAgICBsMnQgPSBOVUxMOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgaWYgKCBsb2NraW5n
ICkKQEAgLTUyMzIsOCArNTIzMiw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICAg
ICAgZmx1c2hfYXJlYSh2aXJ0LCBmbHVzaF9mbGFncyk7CiAgICAgICAgICAgICBpZiAoIGwydCAp
CiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVco
bDJ0KTsKLSAgICAgICAgICAgICAgICBmcmVlX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOwor
ICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJ0KTsKKyAgICAgICAgICAgICAg
ICBmcmVlX3hlbl9wYWdldGFibGUobDJ0X21mbik7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0K
IApAQCAtNTI2OCwxMiArNTI2OCwxMiBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICAgICAg
ICAgICAgICAgICAgbDFfcGdlbnRyeV90ICpsMXQ7CiAgICAgICAgICAgICAgICAgICAgIG1mbl90
IGwxdF9tZm4gPSBsMmVfZ2V0X21mbihvbDJlKTsKIAotICAgICAgICAgICAgICAgICAgICBsMXQg
PSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDF0X21mbik7CisgICAgICAgICAgICAgICAgICAgIGwx
dCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgICAgICAgICBmb3Ig
KCBpID0gMDsgaSA8IEwxX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAg
ICAgICAgICAgZmx1c2hfZmxhZ3MobDFlX2dldF9mbGFncyhsMXRbaV0pKTsKICAgICAgICAgICAg
ICAgICAgICAgZmx1c2hfYXJlYSh2aXJ0LCBmbHVzaF9mbGFncyk7Ci0gICAgICAgICAgICAgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0gICAgICAgICAgICAgICAgICAgIGZy
ZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDF0X21mbik7CisgICAgICAgICAgICAgICAgICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEUobDF0KTsKKyAgICAgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRh
YmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgIH0KIApAQCAtNTI5
NCw3ICs1Mjk0LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAgICAg
IEFTU0VSVChyYyA9PSAtRU5PTUVNKTsKICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7CiAg
ICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVX
KHBsMWUpOworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwxZSk7CiAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggbDJlX2dldF9mbGFncygqcGwyZSkgJiBf
UEFHRV9QU0UgKQogICAgICAgICAgICAgewpAQCAtNTMyMSwxNCArNTMyMSwxNCBAQCBpbnQgbWFw
X3BhZ2VzX3RvX3hlbigKICAgICAgICAgICAgICAgICAgICAgZ290byBjaGVja19sMzsKICAgICAg
ICAgICAgICAgICB9CiAKLSAgICAgICAgICAgICAgICBsMXRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0
YWJsZV9uZXcoKTsKKyAgICAgICAgICAgICAgICBsMXRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJs
ZSgpOwogICAgICAgICAgICAgICAgIGlmICggbWZuX2VxKGwxdF9tZm4sIElOVkFMSURfTUZOKSAp
CiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICBBU1NFUlQocmMgPT0gLUVO
T01FTSk7CiAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICAgICAgICAgIH0K
IAotICAgICAgICAgICAgICAgIGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZuKTsK
KyAgICAgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMXRfbWZuKTsKIAogICAg
ICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyAp
CiAgICAgICAgICAgICAgICAgICAgIGwxZV93cml0ZSgmbDF0W2ldLApAQCAtNTM0NSw3ICs1MzQ1
LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgICAgICBsMmVfd3JpdGVfYXRvbWljKHBsMmUsIGwyZV9mcm9tX21mbihsMXRfbWZuLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBf
X1BBR0VfSFlQRVJWSVNPUikpOwotICAgICAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFX05FVyhsMXQpOworICAgICAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwx
dCk7CiAgICAgICAgICAgICAgICAgICAgIGwxdCA9IE5VTEw7CiAgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgIGlmICggbG9ja2luZyApCkBAIC01MzUzLDE2ICs1MzUzLDE2IEBAIGlu
dCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICAgICAgICAgIGZsdXNoX2FyZWEodmlydCwgZmx1
c2hfZmxhZ3MpOwogICAgICAgICAgICAgICAgIGlmICggbDF0ICkKICAgICAgICAgICAgICAgICB7
Ci0gICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0gICAg
ICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDF0X21mbik7CisgICAgICAg
ICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDF0KTsKKyAgICAgICAgICAgICAgICAg
ICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgIH0KIAotICAgICAgICAgICAgcGwxZSAgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJl
X2dldF9tZm4oKCpwbDJlKSkpOworICAgICAgICAgICAgcGwxZSAgPSBtYXBfeGVuX3BhZ2V0YWJs
ZShsMmVfZ2V0X21mbigoKnBsMmUpKSk7CiAgICAgICAgICAgICBwbDFlICs9IGwxX3RhYmxlX29m
ZnNldCh2aXJ0KTsKICAgICAgICAgICAgIG9sMWUgID0gKnBsMWU7CiAgICAgICAgICAgICBsMWVf
d3JpdGVfYXRvbWljKHBsMWUsIGwxZV9mcm9tX21mbihtZm4sIGZsYWdzKSk7Ci0gICAgICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDFlKTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUocGwxZSk7CiAgICAgICAgICAgICBpZiAoIChsMWVfZ2V0X2ZsYWdzKG9sMWUpICYg
X1BBR0VfUFJFU0VOVCkgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHVuc2lnbmVk
IGludCBmbHVzaF9mbGFncyA9IEZMVVNIX1RMQiB8IEZMVVNIX09SREVSKDApOwpAQCAtNTQwOCwx
NCArNTQwOCwxNCBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICAgICAgICAgICAgICB9CiAK
ICAgICAgICAgICAgICAgICBsMXRfbWZuID0gbDJlX2dldF9tZm4ob2wyZSk7Ci0gICAgICAgICAg
ICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwxdF9tZm4pOworICAgICAgICAgICAg
ICAgIGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogCiAgICAgICAgICAgICAgICAg
YmFzZV9tZm4gPSBsMWVfZ2V0X3BmbihsMXRbMF0pICYgfihMMV9QQUdFVEFCTEVfRU5UUklFUyAt
IDEpOwogICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VOVFJJ
RVM7IGkrKyApCiAgICAgICAgICAgICAgICAgICAgIGlmICggKGwxZV9nZXRfcGZuKGwxdFtpXSkg
IT0gKGJhc2VfbWZuICsgaSkpIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgKGwxZV9nZXRf
ZmxhZ3MobDF0W2ldKSAhPSBmbGFncykgKQogICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
Ci0gICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDF0KTsKKyAgICAgICAg
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CiAgICAgICAgICAgICAgICAgaWYgKCBp
ID09IEwxX1BBR0VUQUJMRV9FTlRSSUVTICkKICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAg
ICAgICAgICAgIGwyZV93cml0ZV9hdG9taWMocGwyZSwgbDJlX2Zyb21fcGZuKGJhc2VfbWZuLApA
QCAtNTQyNSw3ICs1NDI1LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAg
ICAgICAgIGZsdXNoX2FyZWEodmlydCAtIFBBR0VfU0laRSwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBGTFVTSF9UTEJfR0xPQkFMIHwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBGTFVTSF9PUkRFUihQQUdFVEFCTEVfT1JERVIpKTsKLSAgICAgICAgICAgICAgICAgICAg
ZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZuKTsKKyAgICAgICAgICAgICAgICAgICAgZnJl
ZV94ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgICBlbHNlIGlmICggbG9ja2luZyApCiAgICAgICAgICAgICAgICAgICAgIHNwaW5fdW5sb2Nr
KCZtYXBfcGdkaXJfbG9jayk7CkBAIC01NDYwLDcgKzU0NjAsNyBAQCBpbnQgbWFwX3BhZ2VzX3Rv
X3hlbigKICAgICAgICAgICAgIH0KIAogICAgICAgICAgICAgbDJ0X21mbiA9IGwzZV9nZXRfbWZu
KG9sM2UpOwotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4p
OworICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGUobDJ0X21mbik7CiAKICAgICAg
ICAgICAgIGJhc2VfbWZuID0gbDJlX2dldF9wZm4obDJ0WzBdKSAmIH4oTDJfUEFHRVRBQkxFX0VO
VFJJRVMgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEwx
X1BBR0VUQUJMRV9FTlRSSUVTIC0gMSk7CkBAIC01NDY5LDcgKzU0NjksNyBAQCBpbnQgbWFwX3Bh
Z2VzX3RvX3hlbigKICAgICAgICAgICAgICAgICAgICAgICAoYmFzZV9tZm4gKyAoaSA8PCBQQUdF
VEFCTEVfT1JERVIpKSkgfHwKICAgICAgICAgICAgICAgICAgICAgIChsMmVfZ2V0X2ZsYWdzKGwy
dFtpXSkgIT0gbDFmX3RvX2xOZihmbGFncykpICkKICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
Ci0gICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOworICAgICAgICAgICAg
VU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAgICAgICAgaWYgKCBpID09IEwyX1BBR0VU
QUJMRV9FTlRSSUVTICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBsM2Vfd3JpdGVf
YXRvbWljKHBsM2UsIGwzZV9mcm9tX3BmbihiYXNlX21mbiwKQEAgLTU0NzksMTUgKzU0NzksMTUg
QEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAgZmx1c2hfYXJlYSh2aXJ0
IC0gUEFHRV9TSVpFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRkxVU0hfVExCX0dMT0JB
TCB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGTFVTSF9PUkRFUigyKlBBR0VUQUJMRV9P
UkRFUikpOwotICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDJ0X21mbik7
CisgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogICAgICAgICAg
ICAgfQogICAgICAgICAgICAgZWxzZSBpZiAoIGxvY2tpbmcgKQogICAgICAgICAgICAgICAgIHNw
aW5fdW5sb2NrKCZtYXBfcGdkaXJfbG9jayk7CiAgICAgICAgIH0KICAgICBlbmRfb2ZfbG9vcDoK
LSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwxZSk7Ci0gICAgICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEVfTkVXKHBsMmUpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhw
bDNlKTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDFlKTsKKyAgICAgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShwbDJlKTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDNlKTsK
ICAgICB9CiAKICN1bmRlZiBmbHVzaF9mbGFncwpAQCAtNTQ5NSw5ICs1NDk1LDkgQEAgaW50IG1h
cF9wYWdlc190b194ZW4oCiAgICAgcmMgPSAwOwogCiAgb3V0OgotICAgIFVOTUFQX1hFTl9QQUdF
VEFCTEVfTkVXKHBsMWUpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKHBsMmUpOwotICAg
IFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKHBsM2UpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUo
cGwxZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDJlKTsKKyAgICBVTk1BUF9YRU5fUEFH
RVRBQkxFKHBsM2UpOwogICAgIHJldHVybiByYzsKIH0KIApAQCAtNTU2OCwxNCArNTU2OCwxNCBA
QCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcg
ZSwgdW5zaWduZWQgaW50IG5mKQogICAgICAgICAgICAgfQogCiAgICAgICAgICAgICAvKiBQQUdF
MUdCOiBzaGF0dGVyIHRoZSBzdXBlcnBhZ2UgYW5kIGZhbGwgdGhyb3VnaC4gKi8KLSAgICAgICAg
ICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgICAgICBtZm4gPSBh
bGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAgICAgICBpZiAoIG1mbl9lcShtZm4sIElOVkFM
SURfTUZOKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgQVNTRVJUKHJjID09IC1F
Tk9NRU0pOwogICAgICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICAgICAgfQogCi0gICAg
ICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobWZuKTsKKyAgICAgICAgICAgIGwy
dCA9IG1hcF94ZW5fcGFnZXRhYmxlKG1mbik7CiAKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBp
IDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgbDJlX3dyaXRl
KGwydCArIGksCkBAIC01NTg4LDE1ICs1NTg4LDE1IEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdz
KHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAg
ICAgICAgICAgICAgIChsM2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BTRSkgKQogICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgIGwzZV93cml0ZV9hdG9taWMocGwzZSwgbDNlX2Zyb21f
bWZuKG1mbiwgX19QQUdFX0hZUEVSVklTT1IpKTsKLSAgICAgICAgICAgICAgICBVTk1BUF9YRU5f
UEFHRVRBQkxFX05FVyhsMnQpOworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUo
bDJ0KTsKICAgICAgICAgICAgICAgICBsMnQgPSBOVUxMOwogICAgICAgICAgICAgfQogICAgICAg
ICAgICAgaWYgKCBsb2NraW5nICkKICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmbWFwX3Bn
ZGlyX2xvY2spOwogICAgICAgICAgICAgaWYgKCBsMnQgKQogICAgICAgICAgICAgewotICAgICAg
ICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Ci0gICAgICAgICAgICAgICAg
ZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhtZm4pOworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUobDJ0KTsKKyAgICAgICAgICAgICAgICBmcmVlX3hlbl9wYWdldGFibGUobWZuKTsK
ICAgICAgICAgICAgIH0KICAgICAgICAgfQogCkBAIC01NjA0LDcgKzU2MDQsNyBAQCBpbnQgbW9k
aWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWdu
ZWQgaW50IG5mKQogICAgICAgICAgKiBUaGUgTDMgZW50cnkgaGFzIGJlZW4gdmVyaWZpZWQgdG8g
YmUgcHJlc2VudCwgYW5kIHdlJ3ZlIGRlYWx0IHdpdGgKICAgICAgICAgICogMUcgcGFnZXMgYXMg
d2VsbCwgc28gdGhlIEwyIHRhYmxlIGNhbm5vdCByZXF1aXJlIGFsbG9jYXRpb24uCiAgICAgICAg
ICAqLwotICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKCpw
bDNlKSk7CisgICAgICAgIHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0X21mbigqcGwz
ZSkpOwogICAgICAgICBwbDJlICs9IGwyX3RhYmxlX29mZnNldCh2KTsKIAogICAgICAgICBpZiAo
ICEobDJlX2dldF9mbGFncygqcGwyZSkgJiBfUEFHRV9QUkVTRU5UKSApCkBAIC01NjM2LDE0ICs1
NjM2LDE0IEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWdu
ZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgICAgICAgICAgICAgbWZuX3QgbWZuOwog
CiAgICAgICAgICAgICAgICAgLyogUFNFOiBzaGF0dGVyIHRoZSBzdXBlcnBhZ2UgYW5kIHRyeSBh
Z2Fpbi4gKi8KLSAgICAgICAgICAgICAgICBtZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlX25ldygp
OworICAgICAgICAgICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICAgICAg
ICAgICAgICBpZiAoIG1mbl9lcShtZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgICAgICBBU1NFUlQocmMgPT0gLUVOT01FTSk7CiAgICAgICAgICAg
ICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICAgICAgICAgIH0KIAotICAgICAgICAgICAgICAg
IGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhtZm4pOworICAgICAgICAgICAgICAgIGwxdCA9
IG1hcF94ZW5fcGFnZXRhYmxlKG1mbik7CiAKICAgICAgICAgICAgICAgICBmb3IgKCBpID0gMDsg
aSA8IEwxX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgICAgICBsMWVf
d3JpdGUoJmwxdFtpXSwKQEAgLTU2NTYsMTUgKzU2NTYsMTUgQEAgaW50IG1vZGlmeV94ZW5fbWFw
cGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikK
ICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIGwyZV93cml0ZV9hdG9taWMo
cGwyZSwgbDJlX2Zyb21fbWZuKG1mbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgX19QQUdFX0hZUEVSVklTT1IpKTsKLSAgICAgICAgICAg
ICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDF0KTsKKyAgICAgICAgICAgICAgICAg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMXQpOwogICAgICAgICAgICAgICAgICAgICBsMXQgPSBO
VUxMOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBpZiAoIGxvY2tpbmcgKQog
ICAgICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmbWFwX3BnZGlyX2xvY2spOwogICAgICAg
ICAgICAgICAgIGlmICggbDF0ICkKICAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0gICAgICAgICAgICAgICAgICAgIGZy
ZWVfeGVuX3BhZ2V0YWJsZV9uZXcobWZuKTsKKyAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVO
X1BBR0VUQUJMRShsMXQpOworICAgICAgICAgICAgICAgICAgICBmcmVlX3hlbl9wYWdldGFibGUo
bWZuKTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KQEAgLTU2
NzgsNyArNTY3OCw3IEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywg
dW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgICAgICAgICAgKiBwcmVzZW50
LCBhbmQgd2UndmUgZGVhbHQgd2l0aCAyTSBwYWdlcyBhcyB3ZWxsLCBzbyB0aGUgTDEgdGFibGUK
ICAgICAgICAgICAgICAqIGNhbm5vdCByZXF1aXJlIGFsbG9jYXRpb24uCiAgICAgICAgICAgICAg
Ki8KLSAgICAgICAgICAgIHBsMWUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJlX2dldF9tZm4o
KnBsMmUpKTsKKyAgICAgICAgICAgIHBsMWUgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMmVfZ2V0X21m
bigqcGwyZSkpOwogICAgICAgICAgICAgcGwxZSArPSBsMV90YWJsZV9vZmZzZXQodik7CiAKICAg
ICAgICAgICAgIC8qIENvbmZpcm0gdGhlIGNhbGxlciBpc24ndCB0cnlpbmcgdG8gY3JlYXRlIG5l
dyBtYXBwaW5ncy4gKi8KQEAgLTU2OTAsNyArNTY5MCw3IEBAIGludCBtb2RpZnlfeGVuX21hcHBp
bmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGwxZV9nZXRfZmxhZ3MoKnBsMWUpICYgfkZM
QUdTX01BU0spIHwgbmYpOwogCiAgICAgICAgICAgICBsMWVfd3JpdGVfYXRvbWljKHBsMWUsIG5s
MWUpOwotICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwxZSk7CisgICAgICAg
ICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMWUpOwogICAgICAgICAgICAgdiArPSBQQUdFX1NJ
WkU7CiAKICAgICAgICAgICAgIC8qCkBAIC01NzIxLDExICs1NzIxLDExIEBAIGludCBtb2RpZnlf
eGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBp
bnQgbmYpCiAgICAgICAgICAgICB9CiAKICAgICAgICAgICAgIGwxdF9tZm4gPSBsMmVfZ2V0X21m
bigqcGwyZSk7Ci0gICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDF0X21m
bik7CisgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMXRfbWZuKTsKICAgICAg
ICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAgICAg
ICAgICAgICAgICAgaWYgKCBsMWVfZ2V0X2ludHB0ZShsMXRbaV0pICE9IDAgKQogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwx
dCk7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CiAgICAgICAgICAgICBp
ZiAoIGkgPT0gTDFfUEFHRVRBQkxFX0VOVFJJRVMgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIC8qIEVtcHR5OiB6YXAgdGhlIEwyRSBhbmQgZnJlZSB0aGUgTDEgcGFnZS4gKi8KQEAg
LTU3MzMsNyArNTczMyw3IEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcg
cywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgICAgICAgICAgICAgaWYg
KCBsb2NraW5nICkKICAgICAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2soJm1hcF9wZ2Rpcl9s
b2NrKTsKICAgICAgICAgICAgICAgICBmbHVzaF9hcmVhKE5VTEwsIEZMVVNIX1RMQl9HTE9CQUwp
OyAvKiBmbHVzaCBiZWZvcmUgZnJlZSAqLwotICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0
YWJsZV9uZXcobDF0X21mbik7CisgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwx
dF9tZm4pOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgZWxzZSBpZiAoIGxvY2tpbmcgKQog
ICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZtYXBfcGdkaXJfbG9jayk7CkBAIC01NzY3LDEx
ICs1NzY3LDExIEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5z
aWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgICAgICAgICBtZm5fdCBsMnRfbWZu
OwogCiAgICAgICAgICAgICBsMnRfbWZuID0gbDNlX2dldF9tZm4oKnBsM2UpOwotICAgICAgICAg
ICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAgICAgICAgICAgbDJ0
ID0gbWFwX3hlbl9wYWdldGFibGUobDJ0X21mbik7CiAgICAgICAgICAgICBmb3IgKCBpID0gMDsg
aSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgIGlmICggbDJl
X2dldF9pbnRwdGUobDJ0W2ldKSAhPSAwICkKICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ci0g
ICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOworICAgICAgICAgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAgICAgICAgaWYgKCBpID09IEwyX1BBR0VUQUJM
RV9FTlRSSUVTICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAvKiBFbXB0eTogemFw
IHRoZSBMM0UgYW5kIGZyZWUgdGhlIEwyIHBhZ2UuICovCkBAIC01Nzc5LDE0ICs1Nzc5LDE0IEBA
IGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9uZyBl
LCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgICAgICAgICAgICAgaWYgKCBsb2NraW5nICkKICAgICAg
ICAgICAgICAgICAgICAgc3Bpbl91bmxvY2soJm1hcF9wZ2Rpcl9sb2NrKTsKICAgICAgICAgICAg
ICAgICBmbHVzaF9hcmVhKE5VTEwsIEZMVVNIX1RMQl9HTE9CQUwpOyAvKiBmbHVzaCBiZWZvcmUg
ZnJlZSAqLwotICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDJ0X21mbik7
CisgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogICAgICAgICAg
ICAgfQogICAgICAgICAgICAgZWxzZSBpZiAoIGxvY2tpbmcgKQogICAgICAgICAgICAgICAgIHNw
aW5fdW5sb2NrKCZtYXBfcGdkaXJfbG9jayk7CiAgICAgICAgIH0KICAgICBlbmRfb2ZfbG9vcDoK
LSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwyZSk7Ci0gICAgICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEVfTkVXKHBsM2UpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMmUp
OworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsM2UpOwogICAgIH0KIAogICAgIGZsdXNo
X2FyZWEoTlVMTCwgRkxVU0hfVExCX0dMT0JBTCk7CkBAIC01Nzk1LDggKzU3OTUsOCBAQCBpbnQg
bW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5z
aWduZWQgaW50IG5mKQogICAgIHJjID0gMDsKIAogIG91dDoKLSAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFX05FVyhwbDJlKTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDNlKTsKKyAgICBV
Tk1BUF9YRU5fUEFHRVRBQkxFKHBsMmUpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwzZSk7
CiAgICAgcmV0dXJuIHJjOwogfQogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvcHYvZG9tMF9i
dWlsZC5jIGIveGVuL2FyY2gveDg2L3B2L2RvbTBfYnVpbGQuYwppbmRleCAzOWNiNjhmN2RhLi4w
MmQ3ZjFjMjdjIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvcHYvZG9tMF9idWlsZC5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9wdi9kb20wX2J1aWxkLmMKQEAgLTU1LDExICs1NSwxMSBAQCBzdGF0aWMg
X19pbml0IHZvaWQgbWFya19wdl9wdF9wYWdlc19yZG9ubHkoc3RydWN0IGRvbWFpbiAqZCwKICAg
ICBsMV9wZ2VudHJ5X3QgKnBsMWUsICpsMXQ7CiAKICAgICBwbDRlID0gbDRzdGFydCArIGw0X3Rh
YmxlX29mZnNldCh2cHRfc3RhcnQpOwotICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhs
NGVfZ2V0X21mbigqcGw0ZSkpOworICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGw0ZV9nZXRf
bWZuKCpwbDRlKSk7CiAgICAgcGwzZSA9IGwzdCArIGwzX3RhYmxlX29mZnNldCh2cHRfc3RhcnQp
OwotICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM2VfZ2V0X21mbigqcGwzZSkpOwor
ICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZuKCpwbDNlKSk7CiAgICAgcGwy
ZSA9IGwydCArIGwyX3RhYmxlX29mZnNldCh2cHRfc3RhcnQpOwotICAgIGwxdCA9IG1hcF94ZW5f
cGFnZXRhYmxlX25ldyhsMmVfZ2V0X21mbigqcGwyZSkpOworICAgIGwxdCA9IG1hcF94ZW5fcGFn
ZXRhYmxlKGwyZV9nZXRfbWZuKCpwbDJlKSk7CiAgICAgcGwxZSA9IGwxdCArIGwxX3RhYmxlX29m
ZnNldCh2cHRfc3RhcnQpOwogICAgIGZvciAoIGNvdW50ID0gMDsgY291bnQgPCBucl9wdF9wYWdl
czsgY291bnQrKyApCiAgICAgewpAQCAtODYsMjIgKzg2LDIyIEBAIHN0YXRpYyBfX2luaXQgdm9p
ZCBtYXJrX3B2X3B0X3BhZ2VzX3Jkb25seShzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgIGlmICggISgodW5zaWduZWQgbG9uZykrK3BsM2UgJiAoUEFHRV9T
SVpFIC0gMSkpICkKICAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEVfTkVXKGwzdCk7Ci0gICAgICAgICAgICAgICAgICAgIGwzdCA9IG1hcF94
ZW5fcGFnZXRhYmxlX25ldyhsNGVfZ2V0X21mbigqKytwbDRlKSk7CisgICAgICAgICAgICAgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0KTsKKyAgICAgICAgICAgICAgICAgICAgbDN0ID0g
bWFwX3hlbl9wYWdldGFibGUobDRlX2dldF9tZm4oKisrcGw0ZSkpOwogICAgICAgICAgICAgICAg
ICAgICBwbDNlID0gbDN0OwogICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOwotICAgICAgICAgICAgICAgIGwydCA9IG1hcF94ZW5f
cGFnZXRhYmxlX25ldyhsM2VfZ2V0X21mbigqcGwzZSkpOworICAgICAgICAgICAgICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEUobDJ0KTsKKyAgICAgICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0
YWJsZShsM2VfZ2V0X21mbigqcGwzZSkpOwogICAgICAgICAgICAgICAgIHBsMmUgPSBsMnQ7CiAg
ICAgICAgICAgICB9Ci0gICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOwot
ICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwyZV9nZXRfbWZuKCpwbDJl
KSk7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CisgICAgICAgICAgICBs
MXQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMmVfZ2V0X21mbigqcGwyZSkpOwogICAgICAgICAgICAg
cGwxZSA9IGwxdDsKICAgICAgICAgfQogICAgIH0KLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05F
VyhsMXQpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Ci0gICAgVU5NQVBfWEVO
X1BBR0VUQUJMRV9ORVcobDN0KTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CisgICAg
VU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0KTsK
IH0KIAogc3RhdGljIF9faW5pdCB2b2lkIHNldHVwX3B2X3BoeXNtYXAoc3RydWN0IGRvbWFpbiAq
ZCwgdW5zaWduZWQgbG9uZyBwZ3RibF9wZm4sCkBAIC02OTUsOSArNjk1LDkgQEAgaW50IF9faW5p
dCBkb20wX2NvbnN0cnVjdF9wdihzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICAgICAgICAgIGwz
ZV9nZXRfcGFnZSgqbDN0YWIpLT51LmludXNlLnR5cGVfaW5mbyB8PSBQR1RfcGFlX3hlbl9sMjsK
ICAgICAgICAgfQogCi0gICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM2VfZ2V0
X21mbihsM3N0YXJ0WzNdKSk7CisgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9n
ZXRfbWZuKGwzc3RhcnRbM10pKTsKICAgICAgICAgaW5pdF94ZW5fcGFlX2wyX3Nsb3RzKGwydCwg
ZCk7Ci0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7CisgICAgICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEUobDJ0KTsKICAgICB9CiAKICAgICAvKiBQYWdlcyB0aGF0IGFyZSBwYXJ0
IG9mIHBhZ2UgdGFibGVzIG11c3QgYmUgcmVhZCBvbmx5LiAqLwpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L3B2L3NoaW0uYyBiL3hlbi9hcmNoL3g4Ni9wdi9zaGltLmMKaW5kZXggY2Y2MzhmYTk2
NS4uMDljNzc2NmVjNSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3B2L3NoaW0uYworKysgYi94
ZW4vYXJjaC94ODYvcHYvc2hpbS5jCkBAIC0xNzEsMTEgKzE3MSwxMSBAQCBzdGF0aWMgdm9pZCBf
X2luaXQgcmVwbGFjZV92YV9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmQsIGw0X3BnZW50cnlfdCAq
bDRzdGFydCwKICAgICBsMl9wZ2VudHJ5X3QgKnBsMmU7CiAgICAgbDFfcGdlbnRyeV90ICpwbDFl
OwogCi0gICAgcGwzZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsNGVfZ2V0X21mbigqcGw0ZSkp
OworICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZShsNGVfZ2V0X21mbigqcGw0ZSkpOwogICAg
IHBsM2UgKz0gbDNfdGFibGVfb2Zmc2V0KHZhKTsKLSAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzZV9nZXRfbWZuKCpwbDNlKSk7CisgICAgcGwyZSA9IG1hcF94ZW5fcGFnZXRhYmxl
KGwzZV9nZXRfbWZuKCpwbDNlKSk7CiAgICAgcGwyZSArPSBsMl90YWJsZV9vZmZzZXQodmEpOwot
ICAgIHBsMWUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJlX2dldF9tZm4oKnBsMmUpKTsKKyAg
ICBwbDFlID0gbWFwX3hlbl9wYWdldGFibGUobDJlX2dldF9tZm4oKnBsMmUpKTsKICAgICBwbDFl
ICs9IGwxX3RhYmxlX29mZnNldCh2YSk7CiAKICAgICBwdXRfcGFnZV9hbmRfdHlwZShtZm5fdG9f
cGFnZShsMWVfZ2V0X21mbigqcGwxZSkpKTsKQEAgLTE4Myw5ICsxODMsOSBAQCBzdGF0aWMgdm9p
ZCBfX2luaXQgcmVwbGFjZV92YV9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmQsIGw0X3BnZW50cnlf
dCAqbDRzdGFydCwKICAgICAqcGwxZSA9IGwxZV9mcm9tX21mbihtZm4sICghaXNfcHZfMzJiaXRf
ZG9tYWluKGQpID8gTDFfUFJPVAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgOiBDT01QQVRfTDFfUFJPVCkpOwogCi0gICAgVU5NQVBfWEVOX1BB
R0VUQUJMRV9ORVcocGwxZSk7Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwyZSk7Ci0g
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwzZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJM
RShwbDFlKTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMmUpOworICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUocGwzZSk7CiB9CiAKIHN0YXRpYyB2b2lkIGV2dGNobl9yZXNlcnZlKHN0cnVjdCBk
b21haW4gKmQsIHVuc2lnbmVkIGludCBwb3J0KQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3Nl
dHVwLmMgYi94ZW4vYXJjaC94ODYvc2V0dXAuYwppbmRleCAxYzkwNTU5Mjg4Li5lOTY0YzAzMmY2
IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvc2V0dXAuYworKysgYi94ZW4vYXJjaC94ODYvc2V0
dXAuYwpAQCAtMTEwMSw3ICsxMTAxLDcgQEAgdm9pZCBfX2luaXQgbm9yZXR1cm4gX19zdGFydF94
ZW4odW5zaWduZWQgbG9uZyBtYmlfcCkKICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAg
ICAgICAgICAgICAgICAgKnBsNGUgPSBsNGVfZnJvbV9pbnRwdGUobDRlX2dldF9pbnRwdGUoKnBs
NGUpICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5fcGh5c19z
dGFydCk7Ci0gICAgICAgICAgICAgICAgcGwzZSA9IGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25l
dyhsNGVfZ2V0X21mbigqcGw0ZSkpOworICAgICAgICAgICAgICAgIHBsM2UgPSBsM3QgPSBtYXBf
eGVuX3BhZ2V0YWJsZShsNGVfZ2V0X21mbigqcGw0ZSkpOwogICAgICAgICAgICAgICAgIGZvciAo
IGogPSAwOyBqIDwgTDNfUEFHRVRBQkxFX0VOVFJJRVM7IGorKywgcGwzZSsrICkKICAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIGwyX3BnZW50cnlfdCAqbDJ0OwpAQCAtMTEx
Myw3ICsxMTEzLDcgQEAgdm9pZCBfX2luaXQgbm9yZXR1cm4gX19zdGFydF94ZW4odW5zaWduZWQg
bG9uZyBtYmlfcCkKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg
ICAgICAgICAgICAqcGwzZSA9IGwzZV9mcm9tX2ludHB0ZShsM2VfZ2V0X2ludHB0ZSgqcGwzZSkg
KwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5fcGh5c19z
dGFydCk7Ci0gICAgICAgICAgICAgICAgICAgIHBsMmUgPSBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJs
ZV9uZXcobDNlX2dldF9tZm4oKnBsM2UpKTsKKyAgICAgICAgICAgICAgICAgICAgcGwyZSA9IGwy
dCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZuKCpwbDNlKSk7CiAgICAgICAgICAgICAg
ICAgICAgIGZvciAoIGsgPSAwOyBrIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGsrKywgcGwyZSsr
ICkKICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgLyogTm90
IHByZXNlbnQsIFBTRSwgb3IgYWxyZWFkeSByZWxvY2F0ZWQ/ICovCkBAIC0xMTI0LDkgKzExMjQs
OSBAQCB2b2lkIF9faW5pdCBub3JldHVybiBfX3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9w
KQogICAgICAgICAgICAgICAgICAgICAgICAgKnBsMmUgPSBsMmVfZnJvbV9pbnRwdGUobDJlX2dl
dF9pbnRwdGUoKnBsMmUpICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHhlbl9waHlzX3N0YXJ0KTsKICAgICAgICAgICAgICAgICAgICAgfQotICAgICAg
ICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOworICAgICAgICAgICAg
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAgICAgICAgICAgICAgICAgfQotICAg
ICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwzdCk7CisgICAgICAgICAgICAg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM3QpOwogICAgICAgICAgICAgfQogCiAgICAgICAgICAg
ICAvKiBUaGUgb25seSBkYXRhIG1hcHBpbmdzIHRvIGJlIHJlbG9jYXRlZCBhcmUgaW4gdGhlIFhl
biBhcmVhLiAqLwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3NtcGJvb3QuYyBiL3hlbi9hcmNo
L3g4Ni9zbXBib290LmMKaW5kZXggZDY1N2FjMDEwOC4uNTNmOTE3M2YzNyAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gveDg2L3NtcGJvb3QuYworKysgYi94ZW4vYXJjaC94ODYvc21wYm9vdC5jCkBAIC02
ODksNyArNjg5LDcgQEAgc3RhdGljIGludCBjbG9uZV9tYXBwaW5nKGNvbnN0IHZvaWQgKnB0ciwg
cm9vdF9wZ2VudHJ5X3QgKnJwdCkKICAgICAgICAgZ290byBvdXQ7CiAgICAgfQogCi0gICAgcGwz
ZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICBwbDNlID0gbWFwX3hlbl9wYWdldGFibGUo
CiAgICAgICAgIGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbcm9vdF90YWJsZV9vZmZzZXQobGlu
ZWFyKV0pKTsKICAgICBwbDNlICs9IGwzX3RhYmxlX29mZnNldChsaW5lYXIpOwogCkBAIC03MDMs
NyArNzAzLDcgQEAgc3RhdGljIGludCBjbG9uZV9tYXBwaW5nKGNvbnN0IHZvaWQgKnB0ciwgcm9v
dF9wZ2VudHJ5X3QgKnJwdCkKICAgICB9CiAgICAgZWxzZQogICAgIHsKLSAgICAgICAgcGwyZSA9
IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM2VfZ2V0X21mbigqcGwzZSkpOworICAgICAgICBwbDJl
ID0gbWFwX3hlbl9wYWdldGFibGUobDNlX2dldF9tZm4oKnBsM2UpKTsKICAgICAgICAgcGwyZSAr
PSBsMl90YWJsZV9vZmZzZXQobGluZWFyKTsKICAgICAgICAgZmxhZ3MgPSBsMmVfZ2V0X2ZsYWdz
KCpwbDJlKTsKICAgICAgICAgQVNTRVJUKGZsYWdzICYgX1BBR0VfUFJFU0VOVCk7CkBAIC03MTUs
NyArNzE1LDcgQEAgc3RhdGljIGludCBjbG9uZV9tYXBwaW5nKGNvbnN0IHZvaWQgKnB0ciwgcm9v
dF9wZ2VudHJ5X3QgKnJwdCkKICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAgIHsKLSAg
ICAgICAgICAgIHBsMWUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJlX2dldF9tZm4oKnBsMmUp
KTsKKyAgICAgICAgICAgIHBsMWUgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMmVfZ2V0X21mbigqcGwy
ZSkpOwogICAgICAgICAgICAgcGwxZSArPSBsMV90YWJsZV9vZmZzZXQobGluZWFyKTsKICAgICAg
ICAgICAgIGZsYWdzID0gbDFlX2dldF9mbGFncygqcGwxZSk7CiAgICAgICAgICAgICBpZiAoICEo
ZmxhZ3MgJiBfUEFHRV9QUkVTRU5UKSApCkBAIC03MjcsMTMgKzcyNywxMyBAQCBzdGF0aWMgaW50
IGNsb25lX21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0KQogICAg
ICAgICB9CiAgICAgfQogCi0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwxZSk7Ci0gICAg
VU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwyZSk7Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9O
RVcocGwzZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDFlKTsKKyAgICBVTk1BUF9YRU5f
UEFHRVRBQkxFKHBsMmUpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwzZSk7CiAKICAgICBp
ZiAoICEocm9vdF9nZXRfZmxhZ3MocnB0W3Jvb3RfdGFibGVfb2Zmc2V0KGxpbmVhcildKSAmIF9Q
QUdFX1BSRVNFTlQpICkKICAgICB7Ci0gICAgICAgIG1mbl90IGwzdF9tZm4gPSBhbGxvY194ZW5f
cGFnZXRhYmxlX25ldygpOworICAgICAgICBtZm5fdCBsM3RfbWZuID0gYWxsb2NfeGVuX3BhZ2V0
YWJsZSgpOwogCiAgICAgICAgIGlmICggbWZuX2VxKGwzdF9tZm4sIElOVkFMSURfTUZOKSApCiAg
ICAgICAgIHsKQEAgLTc0MSwyMCArNzQxLDIwIEBAIHN0YXRpYyBpbnQgY2xvbmVfbWFwcGluZyhj
b25zdCB2b2lkICpwdHIsIHJvb3RfcGdlbnRyeV90ICpycHQpCiAgICAgICAgICAgICBnb3RvIG91
dDsKICAgICAgICAgfQogCi0gICAgICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDN0
X21mbik7CisgICAgICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM3RfbWZuKTsKICAgICAg
ICAgY2xlYXJfcGFnZShwbDNlKTsKICAgICAgICAgbDRlX3dyaXRlKCZycHRbcm9vdF90YWJsZV9v
ZmZzZXQobGluZWFyKV0sCiAgICAgICAgICAgICAgICAgICBsNGVfZnJvbV9tZm4obDN0X21mbiwg
X19QQUdFX0hZUEVSVklTT1IpKTsKICAgICB9CiAgICAgZWxzZQotICAgICAgICBwbDNlID0gbWFw
X3hlbl9wYWdldGFibGVfbmV3KAorICAgICAgICBwbDNlID0gbWFwX3hlbl9wYWdldGFibGUoCiAg
ICAgICAgICAgICBsNGVfZ2V0X21mbihycHRbcm9vdF90YWJsZV9vZmZzZXQobGluZWFyKV0pKTsK
IAogICAgIHBsM2UgKz0gbDNfdGFibGVfb2Zmc2V0KGxpbmVhcik7CiAKICAgICBpZiAoICEobDNl
X2dldF9mbGFncygqcGwzZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgewotICAgICAgICBtZm5f
dCBsMnRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgbWZuX3QgbDJ0
X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKIAogICAgICAgICBpZiAoIG1mbl9lcShsMnRf
bWZuLCBJTlZBTElEX01GTikgKQogICAgICAgICB7CkBAIC03NjIsMjEgKzc2MiwyMSBAQCBzdGF0
aWMgaW50IGNsb25lX21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0
KQogICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIH0KIAotICAgICAgICBwbDJlID0gbWFw
X3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdl
dGFibGUobDJ0X21mbik7CiAgICAgICAgIGNsZWFyX3BhZ2UocGwyZSk7CiAgICAgICAgIGwzZV93
cml0ZShwbDNlLCBsM2VfZnJvbV9tZm4obDJ0X21mbiwgX19QQUdFX0hZUEVSVklTT1IpKTsKICAg
ICB9CiAgICAgZWxzZQogICAgIHsKICAgICAgICAgQVNTRVJUKCEobDNlX2dldF9mbGFncygqcGwz
ZSkgJiBfUEFHRV9QU0UpKTsKLSAgICAgICAgcGwyZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhs
M2VfZ2V0X21mbigqcGwzZSkpOworICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGUobDNl
X2dldF9tZm4oKnBsM2UpKTsKICAgICB9CiAKICAgICBwbDJlICs9IGwyX3RhYmxlX29mZnNldChs
aW5lYXIpOwogCiAgICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3MoKnBsMmUpICYgX1BBR0VfUFJFU0VO
VCkgKQogICAgIHsKLSAgICAgICAgbWZuX3QgbDF0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVf
bmV3KCk7CisgICAgICAgIG1mbl90IGwxdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAK
ICAgICAgICAgaWYgKCBtZm5fZXEobDF0X21mbiwgSU5WQUxJRF9NRk4pICkKICAgICAgICAgewpA
QCAtNzg0LDE0ICs3ODQsMTQgQEAgc3RhdGljIGludCBjbG9uZV9tYXBwaW5nKGNvbnN0IHZvaWQg
KnB0ciwgcm9vdF9wZ2VudHJ5X3QgKnJwdCkKICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAg
ICB9CiAKLSAgICAgICAgcGwxZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZuKTsKKyAg
ICAgICAgcGwxZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICBjbGVhcl9w
YWdlKHBsMWUpOwogICAgICAgICBsMmVfd3JpdGUocGwyZSwgbDJlX2Zyb21fbWZuKGwxdF9tZm4s
IF9fUEFHRV9IWVBFUlZJU09SKSk7CiAgICAgfQogICAgIGVsc2UKICAgICB7CiAgICAgICAgIEFT
U0VSVCghKGwyZV9nZXRfZmxhZ3MoKnBsMmUpICYgX1BBR0VfUFNFKSk7Ci0gICAgICAgIHBsMWUg
PSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJlX2dldF9tZm4oKnBsMmUpKTsKKyAgICAgICAgcGwx
ZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwyZV9nZXRfbWZuKCpwbDJlKSk7CiAgICAgfQogCiAgICAg
cGwxZSArPSBsMV90YWJsZV9vZmZzZXQobGluZWFyKTsKQEAgLTgwNyw5ICs4MDcsOSBAQCBzdGF0
aWMgaW50IGNsb25lX21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0
KQogCiAgICAgcmMgPSAwOwogIG91dDoKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDFl
KTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDJlKTsKLSAgICBVTk1BUF9YRU5fUEFH
RVRBQkxFX05FVyhwbDNlKTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMWUpOworICAgIFVO
TUFQX1hFTl9QQUdFVEFCTEUocGwyZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDNlKTsK
ICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTgzMiwxNCArODMyLDE0IEBAIHN0YXRpYyBpbnQgc2V0
dXBfY3B1X3Jvb3RfcGd0KHVuc2lnbmVkIGludCBjcHUpCiAgICAgICAgIGdvdG8gb3V0OwogICAg
IH0KIAotICAgIHJwdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlX25ldygpOworICAgIHJwdF9t
Zm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgaWYgKCBtZm5fZXEocnB0X21mbiwgSU5W
QUxJRF9NRk4pICkKICAgICB7CiAgICAgICAgIHJjID0gLUVOT01FTTsKICAgICAgICAgZ290byBv
dXQ7CiAgICAgfQogCi0gICAgcnB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KHJwdF9tZm4pOwor
ICAgIHJwdCA9IG1hcF94ZW5fcGFnZXRhYmxlKHJwdF9tZm4pOwogICAgIGNsZWFyX3BhZ2UocnB0
KTsKICAgICBwZXJfY3B1KHJvb3RfcGd0X21mbiwgY3B1KSA9IHJwdF9tZm47CiAKQEAgLTg4NCw3
ICs4ODQsNyBAQCBzdGF0aWMgaW50IHNldHVwX2NwdV9yb290X3BndCh1bnNpZ25lZCBpbnQgY3B1
KQogICAgICAgICByYyA9IGNsb25lX21hcHBpbmcoKHZvaWQgKilwZXJfY3B1KHN0dWJzLmFkZHIs
IGNwdSksIHJwdCk7CiAKICBvdXQ6Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocnB0KTsK
KyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHJwdCk7CiAgICAgcmV0dXJuIHJjOwogfQogCkBAIC05
MDAsNyArOTAwLDcgQEAgc3RhdGljIHZvaWQgY2xlYW51cF9jcHVfcm9vdF9wZ3QodW5zaWduZWQg
aW50IGNwdSkKIAogICAgIHBlcl9jcHUocm9vdF9wZ3RfbWZuLCBjcHUpID0gSU5WQUxJRF9NRk47
CiAKLSAgICBycHQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcocnB0X21mbik7CisgICAgcnB0ID0g
bWFwX3hlbl9wYWdldGFibGUocnB0X21mbik7CiAKICAgICBmb3IgKCByID0gcm9vdF90YWJsZV9v
ZmZzZXQoRElSRUNUTUFQX1ZJUlRfU1RBUlQpOwogICAgICAgICAgIHIgPCByb290X3RhYmxlX29m
ZnNldChIWVBFUlZJU09SX1ZJUlRfRU5EKTsgKytyICkKQEAgLTkxMyw3ICs5MTMsNyBAQCBzdGF0
aWMgdm9pZCBjbGVhbnVwX2NwdV9yb290X3BndCh1bnNpZ25lZCBpbnQgY3B1KQogICAgICAgICAg
ICAgY29udGludWU7CiAKICAgICAgICAgbDN0X21mbiA9IGw0ZV9nZXRfbWZuKHJwdFtyXSk7Ci0g
ICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM3RfbWZuKTsKKyAgICAgICAgbDN0
ID0gbWFwX3hlbl9wYWdldGFibGUobDN0X21mbik7CiAKICAgICAgICAgZm9yICggaTMgPSAwOyBp
MyA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTOyArK2kzICkKICAgICAgICAgewpAQCAtOTI2LDcgKzky
Niw3IEBAIHN0YXRpYyB2b2lkIGNsZWFudXBfY3B1X3Jvb3RfcGd0KHVuc2lnbmVkIGludCBjcHUp
CiAKICAgICAgICAgICAgIEFTU0VSVCghKGwzZV9nZXRfZmxhZ3MobDN0W2kzXSkgJiBfUEFHRV9Q
U0UpKTsKICAgICAgICAgICAgIGwydF9tZm4gPSBsM2VfZ2V0X21mbihsM3RbaTNdKTsKLSAgICAg
ICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMnRfbWZuKTsKKyAgICAgICAgICAg
IGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogCiAgICAgICAgICAgICBmb3IgKCBp
MiA9IDA7IGkyIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7ICsraTIgKQogICAgICAgICAgICAgewpA
QCAtOTM0LDM0ICs5MzQsMzQgQEAgc3RhdGljIHZvaWQgY2xlYW51cF9jcHVfcm9vdF9wZ3QodW5z
aWduZWQgaW50IGNwdSkKICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAKICAgICAgICAg
ICAgICAgICBBU1NFUlQoIShsMmVfZ2V0X2ZsYWdzKGwydFtpMl0pICYgX1BBR0VfUFNFKSk7Ci0g
ICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhsMmVfZ2V0X21mbihsMnRbaTJd
KSk7CisgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwyZV9nZXRfbWZuKGwydFtp
Ml0pKTsKICAgICAgICAgICAgIH0KIAotICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9O
RVcobDJ0KTsKLSAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDJ0X21mbik7Cisg
ICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CisgICAgICAgICAgICBmcmVlX3hl
bl9wYWdldGFibGUobDJ0X21mbik7CiAgICAgICAgIH0KIAotICAgICAgICBVTk1BUF9YRU5fUEFH
RVRBQkxFX05FVyhsM3QpOwotICAgICAgICBmcmVlX3hlbl9wYWdldGFibGVfbmV3KGwzdF9tZm4p
OworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzdCk7CisgICAgICAgIGZyZWVfeGVuX3Bh
Z2V0YWJsZShsM3RfbWZuKTsKICAgICB9CiAKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhy
cHQpOwotICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcocnB0X21mbik7CisgICAgVU5NQVBfWEVO
X1BBR0VUQUJMRShycHQpOworICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShycHRfbWZuKTsKIAogICAg
IC8qIEFsc28gemFwIHRoZSBzdHViIG1hcHBpbmcgZm9yIHRoaXMgQ1BVLiAqLwogICAgIGlmICgg
c3R1Yl9saW5lYXIgKQogICAgIHsKLSAgICAgICAgbDNfcGdlbnRyeV90ICpsM3QgPSBtYXBfeGVu
X3BhZ2V0YWJsZV9uZXcobDRlX2dldF9tZm4oY29tbW9uX3BndCkpOwotICAgICAgICBsMl9wZ2Vu
dHJ5X3QgKmwydCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgbDNfcGdlbnRyeV90
ICpsM3QgPSBtYXBfeGVuX3BhZ2V0YWJsZShsNGVfZ2V0X21mbihjb21tb25fcGd0KSk7CisgICAg
ICAgIGwyX3BnZW50cnlfdCAqbDJ0ID0gbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgICAgICBs
M2VfZ2V0X21mbihsM3RbbDNfdGFibGVfb2Zmc2V0KHN0dWJfbGluZWFyKV0pKTsKLSAgICAgICAg
bDFfcGdlbnRyeV90ICpsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgICAgIGwxX3Bn
ZW50cnlfdCAqbDF0ID0gbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgICAgICBsMmVfZ2V0X21m
bihsMnRbbDJfdGFibGVfb2Zmc2V0KHN0dWJfbGluZWFyKV0pKTsKIAogICAgICAgICBsMXRbbDFf
dGFibGVfb2Zmc2V0KHN0dWJfbGluZWFyKV0gPSBsMWVfZW1wdHkoKTsKIAotICAgICAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05F
VyhsMnQpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM3QpOworICAgICAgICBV
Tk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJ0
KTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM3QpOwogICAgIH0KIH0KIApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L3g4Nl82NC9tbS5jIGIveGVuL2FyY2gveDg2L3g4Nl82NC9tbS5j
CmluZGV4IDZmMzdiYzRjMTUuLjM3ZThkNTllNWQgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni94
ODZfNjQvbW0uYworKysgYi94ZW4vYXJjaC94ODYveDg2XzY0L21tLmMKQEAgLTEzNCw3ICsxMzQs
NyBAQCBzdGF0aWMgaW50IG0ycF9tYXBwZWQodW5zaWduZWQgbG9uZyBzcGZuKQogICAgIGludCBy
YyA9IE0yUF9OT19NQVBQRUQ7CiAKICAgICB2YSA9IFJPX01QVF9WSVJUX1NUQVJUICsgc3BmbiAq
IHNpemVvZigqbWFjaGluZV90b19waHlzX21hcHBpbmcpOwotICAgIGwzX3JvX21wdCA9IG1hcF94
ZW5fcGFnZXRhYmxlX25ldygKKyAgICBsM19yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZSgKICAg
ICAgICAgbDRlX2dldF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9vZmZzZXQodmEpXSkpOwog
CiAgICAgc3dpdGNoICggbDNlX2dldF9mbGFncyhsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0KHZh
KV0pICYKQEAgLTE1MCwxNSArMTUwLDE1IEBAIHN0YXRpYyBpbnQgbTJwX21hcHBlZCh1bnNpZ25l
ZCBsb25nIHNwZm4pCiAgICAgICAgICAgICByYyA9IE0yUF9OT19NQVBQRUQ7CiAgICAgICAgICAg
ICBnb3RvIG91dDsKICAgICB9Ci0gICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3
KAorICAgIGwyX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICBsM2VfZ2V0X21m
bihsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0KHZhKV0pKTsKIAogICAgIGlmIChsMmVfZ2V0X2Zs
YWdzKGwyX3JvX21wdFtsMl90YWJsZV9vZmZzZXQodmEpXSkgJiBfUEFHRV9QUkVTRU5UKQogICAg
ICAgICByYyA9IE0yUF8yTV9NQVBQRUQ7CiAKICBvdXQ6Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJM
RV9ORVcobDJfcm9fbXB0KTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM19yb19tcHQp
OworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJfcm9fbXB0KTsKKyAgICBVTk1BUF9YRU5fUEFH
RVRBQkxFKGwzX3JvX21wdCk7CiAgICAgcmV0dXJuIHJjOwogfQogCkBAIC0xNzYsMTAgKzE3Niwx
MCBAQCBzdGF0aWMgaW50IHNoYXJlX2hvdGFkZF9tMnBfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRf
aW5mbyAqaW5mbykKICAgICB7CiAgICAgICAgIG4gPSBMMl9QQUdFVEFCTEVfRU5UUklFUyAqIEwx
X1BBR0VUQUJMRV9FTlRSSUVTOwogCi0gICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25l
dygKKyAgICAgICAgbDN0ID0gbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgICAgICBsNGVfZ2V0
X21mbihpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldCh2KV0pKTsKICAgICAgICAgbDNlID0g
bDN0W2wzX3RhYmxlX29mZnNldCh2KV07Ci0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVX
KGwzdCk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0KTsKIAogICAgICAgICBpZiAo
ICEobDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAgICAgICAgY29u
dGludWU7CkBAIC0xODcsOSArMTg3LDkgQEAgc3RhdGljIGludCBzaGFyZV9ob3RhZGRfbTJwX3Rh
YmxlKHN0cnVjdCBtZW1faG90YWRkX2luZm8gKmluZm8pCiAgICAgICAgIHsKICAgICAgICAgICAg
IG4gPSBMMV9QQUdFVEFCTEVfRU5UUklFUzsKIAotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9w
YWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAgICAgICAgbDJ0ID0gbWFwX3hl
bl9wYWdldGFibGUobDNlX2dldF9tZm4obDNlKSk7CiAgICAgICAgICAgICBsMmUgPSBsMnRbbDJf
dGFibGVfb2Zmc2V0KHYpXTsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwy
dCk7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAKICAgICAgICAgICAg
IGlmICggIShsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAgICAg
ICAgICAgY29udGludWU7CkBAIC0yMTEsMTcgKzIxMSwxNyBAQCBzdGF0aWMgaW50IHNoYXJlX2hv
dGFkZF9tMnBfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICAgICAgICB2
ICE9IFJEV1JfQ09NUEFUX01QVF9WSVJUX0VORDsKICAgICAgICAgICB2ICs9IDEgPDwgTDJfUEFH
RVRBQkxFX1NISUZUICkKICAgICB7Ci0gICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25l
dygKKyAgICAgICAgbDN0ID0gbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgICAgICBsNGVfZ2V0
X21mbihpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldCh2KV0pKTsKICAgICAgICAgbDNlID0g
bDN0W2wzX3RhYmxlX29mZnNldCh2KV07Ci0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVX
KGwzdCk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0KTsKIAogICAgICAgICBpZiAo
ICEobDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAgICAgICAgY29u
dGludWU7CiAKLSAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZu
KGwzZSkpOworICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0X21mbihsM2Up
KTsKICAgICAgICAgbDJlID0gbDJ0W2wyX3RhYmxlX29mZnNldCh2KV07Ci0gICAgICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJ0
KTsKIAogICAgICAgICBpZiAoICEobDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0VfUFJFU0VOVCkg
KQogICAgICAgICAgICAgY29udGludWU7CkBAIC0yNTIsMTIgKzI1MiwxMiBAQCBzdGF0aWMgdm9p
ZCBkZXN0cm95X2NvbXBhdF9tMnBfbWFwcGluZyhzdHJ1Y3QgbWVtX2hvdGFkZF9pbmZvICppbmZv
KQogICAgIGlmICggZW1hcCA+ICgoUkRXUl9DT01QQVRfTVBUX1ZJUlRfRU5EIC0gUkRXUl9DT01Q
QVRfTVBUX1ZJUlRfU1RBUlQpID4+IDIpICkKICAgICAgICAgZW1hcCA9IChSRFdSX0NPTVBBVF9N
UFRfVklSVF9FTkQgLSBSRFdSX0NPTVBBVF9NUFRfVklSVF9TVEFSVCkgPj4gMjsKIAotICAgIGwz
X3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICBsM19yb19tcHQgPSBtYXBfeGVu
X3BhZ2V0YWJsZSgKICAgICAgICAgbDRlX2dldF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9v
ZmZzZXQoSElST19DT01QQVRfTVBUX1ZJUlRfU1RBUlQpXSkpOwogCiAgICAgQVNTRVJUKGwzZV9n
ZXRfZmxhZ3MobDNfcm9fbXB0W2wzX3RhYmxlX29mZnNldChISVJPX0NPTVBBVF9NUFRfVklSVF9T
VEFSVCldKSAmIF9QQUdFX1BSRVNFTlQpOwogCi0gICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdl
dGFibGVfbmV3KAorICAgIGwyX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICBs
M2VfZ2V0X21mbihsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0KEhJUk9fQ09NUEFUX01QVF9WSVJU
X1NUQVJUKV0pKTsKIAogICAgIGZvciAoIGkgPSBzbWFwOyBpIDwgZW1hcDsgKQpAQCAtMjgwLDgg
KzI4MCw4IEBAIHN0YXRpYyB2b2lkIGRlc3Ryb3lfY29tcGF0X20ycF9tYXBwaW5nKHN0cnVjdCBt
ZW1faG90YWRkX2luZm8gKmluZm8pCiAgICAgICAgIGkgKz0gMVVMIDw8IChMMl9QQUdFVEFCTEVf
U0hJRlQgLSAyKTsKICAgICB9CiAKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMl9yb19t
cHQpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwzX3JvX21wdCk7CisgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDNfcm9f
bXB0KTsKIAogICAgIHJldHVybjsKIH0KQEAgLTI5Miw3ICsyOTIsNyBAQCBzdGF0aWMgdm9pZCBk
ZXN0cm95X20ycF9tYXBwaW5nKHN0cnVjdCBtZW1faG90YWRkX2luZm8gKmluZm8pCiAgICAgdW5z
aWduZWQgbG9uZyBpLCB2YSwgcnd2YTsKICAgICB1bnNpZ25lZCBsb25nIHNtYXAgPSBpbmZvLT5z
cGZuLCBlbWFwID0gaW5mby0+ZXBmbjsKIAotICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRh
YmxlX25ldygKKyAgICBsM19yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZSgKICAgICAgICAgbDRl
X2dldF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9vZmZzZXQoUk9fTVBUX1ZJUlRfU1RBUlQp
XSkpOwogCiAgICAgLyoKQEAgLTMxNSwxMyArMzE1LDEzIEBAIHN0YXRpYyB2b2lkIGRlc3Ryb3lf
bTJwX21hcHBpbmcoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICAgICAgICAgIGNv
bnRpbnVlOwogICAgICAgICB9CiAKLSAgICAgICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KAorICAgICAgICBsMl9yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZSgKICAgICAgICAg
ICAgIGwzZV9nZXRfbWZuKGwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSkpOwogICAgICAg
ICBpZiAoIShsMmVfZ2V0X2ZsYWdzKGwyX3JvX21wdFtsMl90YWJsZV9vZmZzZXQodmEpXSkgJiBf
UEFHRV9QUkVTRU5UKSkKICAgICAgICAgewogICAgICAgICAgICAgaSA9ICggaSAmIH4oKDFVTCA8
PCAoTDJfUEFHRVRBQkxFX1NISUZUIC0gMykpIC0gMSkpICsKICAgICAgICAgICAgICAgICAgICAg
KDFVTCA8PCAoTDJfUEFHRVRBQkxFX1NISUZUIC0gMykpIDsKLSAgICAgICAgICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEVfTkVXKGwyX3JvX21wdCk7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFKGwyX3JvX21wdCk7CiAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQogCkBAIC0z
MzIsMTcgKzMzMiwxNyBAQCBzdGF0aWMgdm9pZCBkZXN0cm95X20ycF9tYXBwaW5nKHN0cnVjdCBt
ZW1faG90YWRkX2luZm8gKmluZm8pCiAKICAgICAgICAgICAgIGRlc3Ryb3lfeGVuX21hcHBpbmdz
KHJ3dmEsIHJ3dmEgKyAoMVVMIDw8IEwyX1BBR0VUQUJMRV9TSElGVCkpOwogCi0gICAgICAgICAg
ICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgICAgICAgICBsMnQgPSBtYXBfeGVu
X3BhZ2V0YWJsZSgKICAgICAgICAgICAgICAgICBsM2VfZ2V0X21mbihsM19yb19tcHRbbDNfdGFi
bGVfb2Zmc2V0KHZhKV0pKTsKICAgICAgICAgICAgIGwyZV93cml0ZSgmbDJ0W2wyX3RhYmxlX29m
ZnNldCh2YSldLCBsMmVfZW1wdHkoKSk7Ci0gICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxF
X05FVyhsMnQpOworICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAg
ICB9CiAgICAgICAgIGkgPSAoIGkgJiB+KCgxVUwgPDwgKEwyX1BBR0VUQUJMRV9TSElGVCAtIDMp
KSAtIDEpKSArCiAgICAgICAgICAgICAgICgxVUwgPDwgKEwyX1BBR0VUQUJMRV9TSElGVCAtIDMp
KTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJfcm9fbXB0KTsKKyAgICAgICAg
VU5NQVBfWEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOwogICAgIH0KIAotICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEVfTkVXKGwzX3JvX21wdCk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM19yb19t
cHQpOwogCiAgICAgZGVzdHJveV9jb21wYXRfbTJwX21hcHBpbmcoaW5mbyk7CiAKQEAgLTM4Miwx
MiArMzgyLDEyIEBAIHN0YXRpYyBpbnQgc2V0dXBfY29tcGF0X20ycF90YWJsZShzdHJ1Y3QgbWVt
X2hvdGFkZF9pbmZvICppbmZvKQogCiAgICAgdmEgPSBISVJPX0NPTVBBVF9NUFRfVklSVF9TVEFS
VCArCiAgICAgICAgICBzbWFwICogc2l6ZW9mKCpjb21wYXRfbWFjaGluZV90b19waHlzX21hcHBp
bmcpOwotICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICBsM19yb19t
cHQgPSBtYXBfeGVuX3BhZ2V0YWJsZSgKICAgICAgICAgbDRlX2dldF9tZm4oaWRsZV9wZ190YWJs
ZVtsNF90YWJsZV9vZmZzZXQodmEpXSkpOwogCiAgICAgQVNTRVJUKGwzZV9nZXRfZmxhZ3MobDNf
cm9fbXB0W2wzX3RhYmxlX29mZnNldCh2YSldKSAmIF9QQUdFX1BSRVNFTlQpOwogCi0gICAgbDJf
cm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgIGwyX3JvX21wdCA9IG1hcF94ZW5f
cGFnZXRhYmxlKAogICAgICAgICBsM2VfZ2V0X21mbihsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0
KHZhKV0pKTsKIAogI2RlZmluZSBNRk4oeCkgKCgoeCkgPDwgTDJfUEFHRVRBQkxFX1NISUZUKSAv
IHNpemVvZih1bnNpZ25lZCBpbnQpKQpAQCAtNDI3LDggKzQyNyw4IEBAIHN0YXRpYyBpbnQgc2V0
dXBfY29tcGF0X20ycF90YWJsZShzdHJ1Y3QgbWVtX2hvdGFkZF9pbmZvICppbmZvKQogI3VuZGVm
IENOVAogI3VuZGVmIE1GTgogCi0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJfcm9fbXB0
KTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM19yb19tcHQpOworICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEUobDJfcm9fbXB0KTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzX3JvX21w
dCk7CiAgICAgcmV0dXJuIGVycjsKIH0KIApAQCAtNDQ5LDcgKzQ0OSw3IEBAIHN0YXRpYyBpbnQg
c2V0dXBfbTJwX3RhYmxlKHN0cnVjdCBtZW1faG90YWRkX2luZm8gKmluZm8pCiAgICAgICAgICAg
ICAmIF9QQUdFX1BSRVNFTlQpOwogICAgIGwzX3JvX21wdF9tZm4gPSBsNGVfZ2V0X21mbihpZGxl
X3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBST19NUFRfVklSVF9TVEFSVCldKTsKLSAgICBsM19yb19tcHQgPSBtYXBfeGVu
X3BhZ2V0YWJsZV9uZXcobDNfcm9fbXB0X21mbik7CisgICAgbDNfcm9fbXB0ID0gbWFwX3hlbl9w
YWdldGFibGUobDNfcm9fbXB0X21mbik7CiAKICAgICBzbWFwID0gKGluZm8tPnNwZm4gJiAofigo
MVVMIDw8IChMMl9QQUdFVEFCTEVfU0hJRlQgLSAzKSkgLTEpKSk7CiAgICAgZW1hcCA9ICgoaW5m
by0+ZXBmbiArICgoMVVMIDw8IChMMl9QQUdFVEFCTEVfU0hJRlQgLSAzKSkgLSAxICkpICYKQEAg
LTUwNSwyMyArNTA1LDIzIEBAIHN0YXRpYyBpbnQgc2V0dXBfbTJwX3RhYmxlKHN0cnVjdCBtZW1f
aG90YWRkX2luZm8gKmluZm8pCiAgICAgICAgICAgICBpZiAoIGwzZV9nZXRfZmxhZ3MobDNfcm9f
bXB0W2wzX3RhYmxlX29mZnNldCh2YSldKSAmCiAgICAgICAgICAgICAgIF9QQUdFX1BSRVNFTlQg
KQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVX
KGwyX3JvX21wdCk7CisgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMl9yb19t
cHQpOwogICAgICAgICAgICAgICAgIGwyX3JvX21wdF9tZm4gPSBsM2VfZ2V0X21mbihsM19yb19t
cHRbbDNfdGFibGVfb2Zmc2V0KHZhKV0pOwotICAgICAgICAgICAgICAgIGwyX3JvX21wdCA9IG1h
cF94ZW5fcGFnZXRhYmxlX25ldyhsMl9yb19tcHRfbWZuKTsKKyAgICAgICAgICAgICAgICBsMl9y
b19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMl9yb19tcHRfbWZuKTsKICAgICAgICAgICAgICAg
ICBBU1NFUlQobDJfcm9fbXB0KTsKICAgICAgICAgICAgICAgICBwbDJlID0gbDJfcm9fbXB0ICsg
bDJfdGFibGVfb2Zmc2V0KHZhKTsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGVsc2UKICAg
ICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMl9y
b19tcHQpOwotICAgICAgICAgICAgICAgIGwyX3JvX21wdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRh
YmxlX25ldygpOworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJfcm9fbXB0
KTsKKyAgICAgICAgICAgICAgICBsMl9yb19tcHRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgp
OwogICAgICAgICAgICAgICAgIGlmICggbWZuX2VxKGwyX3JvX21wdF9tZm4sIElOVkFMSURfTUZO
KSApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICByZXQgPSAtRU5PTUVN
OwogICAgICAgICAgICAgICAgICAgICBnb3RvIGVycm9yOwogICAgICAgICAgICAgICAgIH0KIAot
ICAgICAgICAgICAgICAgIGwyX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMl9yb19t
cHRfbWZuKTsKKyAgICAgICAgICAgICAgICBsMl9yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShs
Ml9yb19tcHRfbWZuKTsKICAgICAgICAgICAgICAgICBjbGVhcl9wYWdlKGwyX3JvX21wdCk7CiAg
ICAgICAgICAgICAgICAgbDNlX3dyaXRlKCZsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0KHZhKV0s
CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGwzZV9mcm9tX21mbihsMl9yb19tcHRfbWZuLApA
QCAtNTQxLDggKzU0MSw4IEBAIHN0YXRpYyBpbnQgc2V0dXBfbTJwX3RhYmxlKHN0cnVjdCBtZW1f
aG90YWRkX2luZm8gKmluZm8pCiAKICAgICByZXQgPSBzZXR1cF9jb21wYXRfbTJwX3RhYmxlKGlu
Zm8pOwogZXJyb3I6Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJfcm9fbXB0KTsKLSAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM19yb19tcHQpOworICAgIFVOTUFQX1hFTl9QQUdF
VEFCTEUobDJfcm9fbXB0KTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzX3JvX21wdCk7CiAg
ICAgcmV0dXJuIHJldDsKIH0KIApAQCAtNTY5LDIzICs1NjksMjMgQEAgdm9pZCBfX2luaXQgcGFn
aW5nX2luaXQodm9pZCkKICAgICAgICAgICAgIGwzX3BnZW50cnlfdCAqcGwzdDsKICAgICAgICAg
ICAgIG1mbl90IG1mbjsKIAotICAgICAgICAgICAgbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9u
ZXcoKTsKKyAgICAgICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICAgICAg
ICAgIGlmICggbWZuX2VxKG1mbiwgSU5WQUxJRF9NRk4pICkKICAgICAgICAgICAgICAgICBnb3Rv
IG5vbWVtOwogCi0gICAgICAgICAgICBwbDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KG1mbik7
CisgICAgICAgICAgICBwbDN0ID0gbWFwX3hlbl9wYWdldGFibGUobWZuKTsKICAgICAgICAgICAg
IGNsZWFyX3BhZ2UocGwzdCk7CiAgICAgICAgICAgICBsNGVfd3JpdGUoJmlkbGVfcGdfdGFibGVb
bDRfdGFibGVfb2Zmc2V0KHZhKV0sCiAgICAgICAgICAgICAgICAgICAgICAgbDRlX2Zyb21fbWZu
KG1mbiwgX19QQUdFX0hZUEVSVklTT1JfUlcpKTsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdF
VEFCTEVfTkVXKHBsM3QpOworICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDN0KTsK
ICAgICAgICAgfQogICAgIH0KIAogICAgIC8qIENyZWF0ZSB1c2VyLWFjY2Vzc2libGUgTDIgZGly
ZWN0b3J5IHRvIG1hcCB0aGUgTVBUIGZvciBndWVzdHMuICovCi0gICAgbDNfcm9fbXB0X21mbiA9
IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgbDNfcm9fbXB0X21mbiA9IGFsbG9jX3hl
bl9wYWdldGFibGUoKTsKICAgICBpZiAoIG1mbl9lcShsM19yb19tcHRfbWZuLCBJTlZBTElEX01G
TikgKQogICAgICAgICBnb3RvIG5vbWVtOwotICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRh
YmxlX25ldyhsM19yb19tcHRfbWZuKTsKKyAgICBsM19yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJs
ZShsM19yb19tcHRfbWZuKTsKICAgICBjbGVhcl9wYWdlKGwzX3JvX21wdCk7CiAgICAgbDRlX3dy
aXRlKCZpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldChST19NUFRfVklSVF9TVEFSVCldLAog
ICAgICAgICAgICAgICBsNGVfZnJvbV9tZm4obDNfcm9fbXB0X21mbiwgX19QQUdFX0hZUEVSVklT
T1JfUk8gfCBfUEFHRV9VU0VSKSk7CkBAIC02NzUsMTMgKzY3NSwxMyBAQCB2b2lkIF9faW5pdCBw
YWdpbmdfaW5pdCh2b2lkKQogICAgICAgICAgICAgICogVW5tYXAgbDJfcm9fbXB0LCB3aGljaCBj
b3VsZCd2ZSBiZWVuIG1hcHBlZCBpbiBwcmV2aW91cwogICAgICAgICAgICAgICogaXRlcmF0aW9u
LgogICAgICAgICAgICAgICovCi0gICAgICAgICAgICB1bm1hcF94ZW5fcGFnZXRhYmxlX25ldyhs
Ml9yb19tcHQpOworICAgICAgICAgICAgdW5tYXBfeGVuX3BhZ2V0YWJsZShsMl9yb19tcHQpOwog
Ci0gICAgICAgICAgICBsMl9yb19tcHRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsK
KyAgICAgICAgICAgIGwyX3JvX21wdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAg
ICAgICAgICBpZiAoIG1mbl9lcShsMl9yb19tcHRfbWZuLCBJTlZBTElEX01GTikgKQogICAgICAg
ICAgICAgICAgIGdvdG8gbm9tZW07CiAKLSAgICAgICAgICAgIGwyX3JvX21wdCA9IG1hcF94ZW5f
cGFnZXRhYmxlX25ldyhsMl9yb19tcHRfbWZuKTsKKyAgICAgICAgICAgIGwyX3JvX21wdCA9IG1h
cF94ZW5fcGFnZXRhYmxlKGwyX3JvX21wdF9tZm4pOwogICAgICAgICAgICAgY2xlYXJfcGFnZShs
Ml9yb19tcHQpOwogICAgICAgICAgICAgbDNlX3dyaXRlKCZsM19yb19tcHRbbDNfdGFibGVfb2Zm
c2V0KHZhKV0sCiAgICAgICAgICAgICAgICAgICAgICAgbDNlX2Zyb21fbWZuKGwyX3JvX21wdF9t
Zm4sCkBAIC02OTcsOCArNjk3LDggQEAgdm9pZCBfX2luaXQgcGFnaW5nX2luaXQodm9pZCkKICAg
ICB9CiAjdW5kZWYgQ05UCiAjdW5kZWYgTUZOCi0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVco
bDJfcm9fbXB0KTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM19yb19tcHQpOworICAg
IFVOTUFQX1hFTl9QQUdFVEFCTEUobDJfcm9fbXB0KTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxF
KGwzX3JvX21wdCk7CiAKICAgICAvKiBDcmVhdGUgdXNlci1hY2Nlc3NpYmxlIEwyIGRpcmVjdG9y
eSB0byBtYXAgdGhlIE1QVCBmb3IgY29tcGF0IGd1ZXN0cy4gKi8KICAgICBCVUlMRF9CVUdfT04o
bDRfdGFibGVfb2Zmc2V0KFJEV1JfTVBUX1ZJUlRfU1RBUlQpICE9CkBAIC03MDYsMTIgKzcwNiwx
MiBAQCB2b2lkIF9faW5pdCBwYWdpbmdfaW5pdCh2b2lkKQogCiAgICAgbDNfcm9fbXB0X21mbiA9
IGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbbDRfdGFibGVfb2Zmc2V0KAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhJUk9fQ09NUEFUX01QVF9WSVJUX1NUQVJUKV0p
OwotICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM19yb19tcHRfbWZuKTsK
KyAgICBsM19yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM19yb19tcHRfbWZuKTsKIAotICAg
IGwyX3JvX21wdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlX25ldygpOworICAgIGwyX3JvX21w
dF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgaWYgKCBtZm5fZXEobDJfcm9fbXB0
X21mbiwgSU5WQUxJRF9NRk4pICkKICAgICAgICAgZ290byBub21lbTsKLSAgICBsMl9yb19tcHQg
PSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJfcm9fbXB0X21mbik7CisgICAgbDJfcm9fbXB0ID0g
bWFwX3hlbl9wYWdldGFibGUobDJfcm9fbXB0X21mbik7CiAgICAgY29tcGF0X2lkbGVfcGdfdGFi
bGVfbDIgPSBsMl9yb19tcHQ7CiAgICAgY2xlYXJfcGFnZShsMl9yb19tcHQpOwogICAgIGwzZV93
cml0ZSgmbDNfcm9fbXB0W2wzX3RhYmxlX29mZnNldChISVJPX0NPTVBBVF9NUFRfVklSVF9TVEFS
VCldLApAQCAtNzU3LDggKzc1Nyw4IEBAIHZvaWQgX19pbml0IHBhZ2luZ19pbml0KHZvaWQpCiAj
dW5kZWYgQ05UCiAjdW5kZWYgTUZOCiAKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMl9y
b19tcHQpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwzX3JvX21wdCk7CisgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDNf
cm9fbXB0KTsKIAogICAgIG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nX3ZhbGlkID0gMTsKIApAQCAt
ODE2LDEwICs4MTYsMTAgQEAgc3RhdGljIHZvaWQgY2xlYW51cF9mcmFtZV90YWJsZShzdHJ1Y3Qg
bWVtX2hvdGFkZF9pbmZvICppbmZvKQogCiAgICAgd2hpbGUgKHN2YSA8IGV2YSkKICAgICB7Ci0g
ICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgbDN0ID0gbWFwX3hl
bl9wYWdldGFibGUoCiAgICAgICAgICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3RhYmxlW2w0X3Rh
YmxlX29mZnNldChzdmEpXSkpOwogICAgICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KHN2
YSldOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM3QpOworICAgICAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFKGwzdCk7CiAgICAgICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkg
JiBfUEFHRV9QUkVTRU5UKSB8fAogICAgICAgICAgICAgIChsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBf
UEFHRV9QU0UpICkKICAgICAgICAgewpAQCAtODI4LDkgKzgyOCw5IEBAIHN0YXRpYyB2b2lkIGNs
ZWFudXBfZnJhbWVfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICAgICAg
ICAgIGNvbnRpbnVlOwogICAgICAgICB9CiAKLSAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJs
ZShsM2VfZ2V0X21mbihsM2UpKTsKICAgICAgICAgbDJlID0gbDJ0W2wyX3RhYmxlX29mZnNldChz
dmEpXTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJ0KTsKKyAgICAgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAgICBBU1NFUlQobDJlX2dldF9mbGFncyhsMmUp
ICYgX1BBR0VfUFJFU0VOVCk7CiAKICAgICAgICAgaWYgKCAobDJlX2dldF9mbGFncyhsMmUpICYg
KF9QQUdFX1BSRVNFTlQgfCBfUEFHRV9QU0UpKSA9PQpAQCAtODQ4LDEwICs4NDgsMTAgQEAgc3Rh
dGljIHZvaWQgY2xlYW51cF9mcmFtZV90YWJsZShzdHJ1Y3QgbWVtX2hvdGFkZF9pbmZvICppbmZv
KQogCiAjaWZuZGVmIE5ERUJVRwogICAgICAgICB7Ci0gICAgICAgICAgICBsMV9wZ2VudHJ5X3Qg
KmwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMmVfZ2V0X21mbihsMmUpKTsKKyAgICAgICAg
ICAgIGwxX3BnZW50cnlfdCAqbDF0ID0gbWFwX3hlbl9wYWdldGFibGUobDJlX2dldF9tZm4obDJl
KSk7CiAgICAgICAgICAgICBBU1NFUlQobDFlX2dldF9mbGFncyhsMXRbbDFfdGFibGVfb2Zmc2V0
KHN2YSldKSAmCiAgICAgICAgICAgICAgICAgICAgX1BBR0VfUFJFU0VOVCk7Ci0gICAgICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOworICAgICAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShsMXQpOwogICAgICAgICB9CiAjZW5kaWYKICAgICAgICAgIHN2YSA9IChzdmEgJiB+
KCgxVUwgPDwgUEFHRV9TSElGVCkgLSAxKSkgKwpAQCAtOTQyLDEwICs5NDIsMTAgQEAgdm9pZCBf
X2luaXQgc3ViYXJjaF9pbml0X21lbW9yeSh2b2lkKQogICAgIHsKICAgICAgICAgbiA9IEwyX1BB
R0VUQUJMRV9FTlRSSUVTICogTDFfUEFHRVRBQkxFX0VOVFJJRVM7CiAKLSAgICAgICAgbDN0ID0g
bWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgICAgICBsM3QgPSBtYXBfeGVuX3BhZ2V0YWJsZSgK
ICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbbDRfdGFibGVfb2Zmc2V0KHYp
XSkpOwogICAgICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KHYpXTsKLSAgICAgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0KTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShs
M3QpOwogCiAgICAgICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QUkVTRU5U
KSApCiAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTk1Myw5ICs5NTMsOSBAQCB2b2lkIF9faW5p
dCBzdWJhcmNoX2luaXRfbWVtb3J5KHZvaWQpCiAgICAgICAgIHsKICAgICAgICAgICAgIG4gPSBM
MV9QQUdFVEFCTEVfRU5UUklFUzsKIAotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdl
dGFibGUobDNlX2dldF9tZm4obDNlKSk7CiAgICAgICAgICAgICBsMmUgPSBsMnRbbDJfdGFibGVf
b2Zmc2V0KHYpXTsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Cisg
ICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAKICAgICAgICAgICAgIGlmICgg
IShsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAgICAgICAgICAg
Y29udGludWU7CkBAIC05NzUsMTcgKzk3NSwxNyBAQCB2b2lkIF9faW5pdCBzdWJhcmNoX2luaXRf
bWVtb3J5KHZvaWQpCiAgICAgICAgICAgdiAhPSBSRFdSX0NPTVBBVF9NUFRfVklSVF9FTkQ7CiAg
ICAgICAgICAgdiArPSAxIDw8IEwyX1BBR0VUQUJMRV9TSElGVCApCiAgICAgewotICAgICAgICBs
M3QgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRh
YmxlKAogICAgICAgICAgICAgbDRlX2dldF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9vZmZz
ZXQodildKSk7CiAgICAgICAgIGwzZSA9IGwzdFtsM190YWJsZV9vZmZzZXQodildOwotICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM3QpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFKGwzdCk7CiAKICAgICAgICAgaWYgKCAhKGwzZV9nZXRfZmxhZ3MobDNlKSAmIF9QQUdFX1BS
RVNFTlQpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgIGwydCA9IG1hcF94ZW5f
cGFnZXRhYmxlX25ldyhsM2VfZ2V0X21mbihsM2UpKTsKKyAgICAgICAgbDJ0ID0gbWFwX3hlbl9w
YWdldGFibGUobDNlX2dldF9tZm4obDNlKSk7CiAgICAgICAgIGwyZSA9IGwydFtsMl90YWJsZV9v
ZmZzZXQodildOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOworICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAKICAgICAgICAgaWYgKCAhKGwyZV9nZXRfZmxh
Z3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwpAQCAtMTAz
NiwxOCArMTAzNiwxOCBAQCBsb25nIHN1YmFyY2hfbWVtb3J5X29wKHVuc2lnbmVkIGxvbmcgY21k
LCBYRU5fR1VFU1RfSEFORExFX1BBUkFNKHZvaWQpIGFyZykKICAgICAgICAgICAgICAgKHYgPCAo
dW5zaWduZWQgbG9uZykobWFjaGluZV90b19waHlzX21hcHBpbmcgKyBtYXhfcGFnZSkpOwogICAg
ICAgICAgICAgICBpKyssIHYgKz0gMVVMIDw8IEwyX1BBR0VUQUJMRV9TSElGVCApCiAgICAgICAg
IHsKLSAgICAgICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgICAg
IGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKGlk
bGVfcGdfdGFibGVbbDRfdGFibGVfb2Zmc2V0KHYpXSkpOwogICAgICAgICAgICAgbDNlID0gbDN0
W2wzX3RhYmxlX29mZnNldCh2KV07Ci0gICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05F
VyhsM3QpOworICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM3QpOwogCiAgICAgICAg
ICAgICBpZiAoICEobDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAg
ICAgICAgICAgIG1mbiA9IGxhc3RfbWZuOwogICAgICAgICAgICAgZWxzZSBpZiAoICEobDNlX2dl
dF9mbGFncyhsM2UpICYgX1BBR0VfUFNFKSApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAg
ICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAg
ICAgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZuKGwzZSkpOwogICAg
ICAgICAgICAgICAgIGwyZSA9IGwydFtsMl90YWJsZV9vZmZzZXQodildOwotICAgICAgICAgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7CisgICAgICAgICAgICAgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAgICAgICAgICAgIGlmICggbDJlX2dldF9mbGFncyhs
MmUpICYgX1BBR0VfUFJFU0VOVCApCiAgICAgICAgICAgICAgICAgICAgIG1mbiA9IGwyZV9nZXRf
cGZuKGwyZSk7CiAgICAgICAgICAgICAgICAgZWxzZQpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9l
ZmkvYm9vdC5jIGIveGVuL2NvbW1vbi9lZmkvYm9vdC5jCmluZGV4IGY1NWQ2YTZkNzYuLmQ0NzA2
N2M5OTggMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vZWZpL2Jvb3QuYworKysgYi94ZW4vY29tbW9u
L2VmaS9ib290LmMKQEAgLTE0NDMsMjAgKzE0NDMsMjAgQEAgc3RhdGljIF9faW5pdCB2b2lkIGNv
cHlfbWFwcGluZyhsNF9wZ2VudHJ5X3QgKmw0LAogICAgICAgICB7CiAgICAgICAgICAgICBtZm5f
dCBsM3RfbWZuOwogCi0gICAgICAgICAgICBsM3RfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9u
ZXcoKTsKKyAgICAgICAgICAgIGwzdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAg
ICAgICAgICBCVUdfT04obWZuX2VxKGwzdF9tZm4sIElOVkFMSURfTUZOKSk7Ci0gICAgICAgICAg
ICBsM2RzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM3RfbWZuKTsKKyAgICAgICAgICAgIGwz
ZHN0ID0gbWFwX3hlbl9wYWdldGFibGUobDN0X21mbik7CiAgICAgICAgICAgICBjbGVhcl9wYWdl
KGwzZHN0KTsKICAgICAgICAgICAgIGw0W2w0X3RhYmxlX29mZnNldChtZm4gPDwgUEFHRV9TSElG
VCldID0KICAgICAgICAgICAgICAgICBsNGVfZnJvbV9tZm4obDN0X21mbiwgX19QQUdFX0hZUEVS
VklTT1IpOwogICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAgICAgICAgIGwzZHN0ID0gbWFw
X3hlbl9wYWdldGFibGVfbmV3KGw0ZV9nZXRfbWZuKGw0ZSkpOwotICAgICAgICBsM3NyYyA9IG1h
cF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgICAgIGwzZHN0ID0gbWFwX3hlbl9wYWdldGFi
bGUobDRlX2dldF9tZm4obDRlKSk7CisgICAgICAgIGwzc3JjID0gbWFwX3hlbl9wYWdldGFibGUo
CiAgICAgICAgICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldCh2
YSldKSk7CiAgICAgICAgIGwzZHN0W2wzX3RhYmxlX29mZnNldChtZm4gPDwgUEFHRV9TSElGVCld
ID0gbDNzcmNbbDNfdGFibGVfb2Zmc2V0KHZhKV07Ci0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEVfTkVXKGwzc3JjKTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDNkc3QpOwor
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzc3JjKTsKKyAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShsM2RzdCk7CiAgICAgfQogfQogCkBAIC0xNjA0LDkgKzE2MDQsOSBAQCB2b2lkIF9f
aW5pdCBlZmlfaW5pdF9tZW1vcnkodm9pZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG1kZXNjX3ZlciwgZWZpX21lbW1hcCk7CiAjZWxzZQogICAgIC8qIFNldCB1cCAxOjEgcGFn
ZSB0YWJsZXMgdG8gZG8gcnVudGltZSBjYWxscyBpbiAicGh5c2ljYWwiIG1vZGUuICovCi0gICAg
ZWZpX2w0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgZWZpX2w0X21mbiA9
IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICBCVUdfT04obWZuX2VxKGVmaV9sNF9tZm4sIElO
VkFMSURfTUZOKSk7Ci0gICAgZWZpX2w0X3BndGFibGUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXco
ZWZpX2w0X21mbik7CisgICAgZWZpX2w0X3BndGFibGUgPSBtYXBfeGVuX3BhZ2V0YWJsZShlZmlf
bDRfbWZuKTsKICAgICBjbGVhcl9wYWdlKGVmaV9sNF9wZ3RhYmxlKTsKIAogICAgIGNvcHlfbWFw
cGluZyhlZmlfbDRfcGd0YWJsZSwgMCwgbWF4X3BhZ2UsIHJhbV9yYW5nZV92YWxpZCk7CkBAIC0x
NjQxLDMxICsxNjQxLDMxIEBAIHZvaWQgX19pbml0IGVmaV9pbml0X21lbW9yeSh2b2lkKQogICAg
ICAgICB7CiAgICAgICAgICAgICBtZm5fdCBsM3RfbWZuOwogCi0gICAgICAgICAgICBsM3RfbWZu
ID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgIGwzdF9tZm4gPSBhbGxv
Y194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAgICAgICBCVUdfT04obWZuX2VxKGwzdF9tZm4sIElO
VkFMSURfTUZOKSk7Ci0gICAgICAgICAgICBwbDNlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwz
dF9tZm4pOworICAgICAgICAgICAgcGwzZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzdF9tZm4pOwog
ICAgICAgICAgICAgY2xlYXJfcGFnZShwbDNlKTsKICAgICAgICAgICAgIGVmaV9sNF9wZ3RhYmxl
W2w0X3RhYmxlX29mZnNldChhZGRyKV0gPQogICAgICAgICAgICAgICAgIGw0ZV9mcm9tX21mbihs
M3RfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUik7CiAgICAgICAgIH0KICAgICAgICAgZWxzZQotICAg
ICAgICAgICAgcGwzZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsNGVfZ2V0X21mbihsNGUpKTsK
KyAgICAgICAgICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZShsNGVfZ2V0X21mbihsNGUpKTsK
ICAgICAgICAgcGwzZSArPSBsM190YWJsZV9vZmZzZXQoYWRkcik7CiAKICAgICAgICAgaWYgKCAh
KGwzZV9nZXRfZmxhZ3MoKnBsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAgICB7CiAgICAg
ICAgICAgICBtZm5fdCBsMnRfbWZuOwogCi0gICAgICAgICAgICBsMnRfbWZuID0gYWxsb2NfeGVu
X3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgIGwydF9tZm4gPSBhbGxvY194ZW5fcGFnZXRh
YmxlKCk7CiAgICAgICAgICAgICBCVUdfT04obWZuX2VxKGwydF9tZm4sIElOVkFMSURfTUZOKSk7
Ci0gICAgICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAg
ICAgICAgICAgcGwyZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogICAgICAgICAgICAg
Y2xlYXJfcGFnZShwbDJlKTsKICAgICAgICAgICAgICpwbDNlID0gbDNlX2Zyb21fbWZuKGwydF9t
Zm4sIF9fUEFHRV9IWVBFUlZJU09SKTsKICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAg
IHsKICAgICAgICAgICAgIEJVR19PTihsM2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BTRSk7
Ci0gICAgICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKCpw
bDNlKSk7CisgICAgICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGUobDNlX2dldF9tZm4o
KnBsM2UpKTsKICAgICAgICAgfQogICAgICAgICBwbDJlICs9IGwyX3RhYmxlX29mZnNldChhZGRy
KTsKIApAQCAtMTY3MywxNiArMTY3MywxNiBAQCB2b2lkIF9faW5pdCBlZmlfaW5pdF9tZW1vcnko
dm9pZCkKICAgICAgICAgewogICAgICAgICAgICAgbWZuX3QgbDF0X21mbjsKIAotICAgICAgICAg
ICAgbDF0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgICAgICBsMXRf
bWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAgQlVHX09OKG1mbl9lcShs
MXRfbWZuLCBJTlZBTElEX01GTikpOwotICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwxdF9tZm4pOworICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGUobDF0
X21mbik7CiAgICAgICAgICAgICBjbGVhcl9wYWdlKGwxdCk7CiAgICAgICAgICAgICAqcGwyZSA9
IGwyZV9mcm9tX21mbihsMXRfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUik7CiAgICAgICAgIH0KICAg
ICAgICAgZWxzZQogICAgICAgICB7CiAgICAgICAgICAgICBCVUdfT04obDJlX2dldF9mbGFncygq
cGwyZSkgJiBfUEFHRV9QU0UpOwotICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGVf
bmV3KGwyZV9nZXRfbWZuKCpwbDJlKSk7CisgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0
YWJsZShsMmVfZ2V0X21mbigqcGwyZSkpOwogICAgICAgICB9CiAgICAgICAgIGZvciAoIGkgPSBs
MV90YWJsZV9vZmZzZXQoYWRkcik7CiAgICAgICAgICAgICAgIGkgPCBMMV9QQUdFVEFCTEVfRU5U
UklFUyAmJiBleHRyYS0+c21mbiA8IGV4dHJhLT5lbWZuOwpAQCAtMTY5NSw5ICsxNjk1LDkgQEAg
dm9pZCBfX2luaXQgZWZpX2luaXRfbWVtb3J5KHZvaWQpCiAgICAgICAgICAgICB4ZnJlZShleHRy
YSk7CiAgICAgICAgIH0KIAotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOwot
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDJlKTsKLSAgICAgICAgVU5NQVBfWEVO
X1BBR0VUQUJMRV9ORVcocGwzZSk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDF0KTsK
KyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDJlKTsKKyAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShwbDNlKTsKICAgICB9CiAKICAgICAvKiBJbnNlcnQgWGVuIG1hcHBpbmdzLiAqLwpA
QCAtMTcwNiw3ICsxNzA2LDcgQEAgdm9pZCBfX2luaXQgZWZpX2luaXRfbWVtb3J5KHZvaWQpCiAg
ICAgICAgIGVmaV9sNF9wZ3RhYmxlW2ldID0gaWRsZV9wZ190YWJsZVtpXTsKICNlbmRpZgogCi0g
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcoZWZpX2w0X3BndGFibGUpOworICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEUoZWZpX2w0X3BndGFibGUpOwogfQogI2VuZGlmCiAKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaAppbmRleCA0
ZmI3OWFiOGYwLi5hNGIzYzliN2FmIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCkBAIC02MzEsMTUgKzYzMSwxNSBAQCBp
bnQgYXJjaF9hY3F1aXJlX3Jlc291cmNlKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGludCB0
eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbnJfZnJhbWVzLCB4
ZW5fcGZuX3QgbWZuX2xpc3RbXSk7CiAKIC8qIEFsbG9jYXRvciBmdW5jdGlvbnMgZm9yIFhlbiBw
YWdldGFibGVzLiAqLwotbWZuX3QgYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcodm9pZCk7Ci12b2lk
ICptYXBfeGVuX3BhZ2V0YWJsZV9uZXcobWZuX3QgbWZuKTsKLXZvaWQgdW5tYXBfeGVuX3BhZ2V0
YWJsZV9uZXcodm9pZCAqdik7Ci12b2lkIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobWZuX3QgbWZu
KTsKLQotI2RlZmluZSBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwdHIpICAgIFwKLSAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIHVubWFwX3hlbl9wYWdl
dGFibGVfbmV3KChwdHIpKTsgXAotICAgICAgICAocHRyKSA9IE5VTEw7ICAgICAgICAgICAgICAg
ICAgIFwKK21mbl90IGFsbG9jX3hlbl9wYWdldGFibGUodm9pZCk7Cit2b2lkICptYXBfeGVuX3Bh
Z2V0YWJsZShtZm5fdCBtZm4pOwordm9pZCB1bm1hcF94ZW5fcGFnZXRhYmxlKHZvaWQgKnYpOwor
dm9pZCBmcmVlX3hlbl9wYWdldGFibGUobWZuX3QgbWZuKTsKKworI2RlZmluZSBVTk1BUF9YRU5f
UEFHRVRBQkxFKHB0cikgICAgXAorICAgIGRvIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAorICAgICAgICB1bm1hcF94ZW5fcGFnZXRhYmxlKChwdHIpKTsgXAorICAgICAgICAocHRyKSA9
IE5VTEw7ICAgICAgICAgICAgICAgXAogICAgIH0gd2hpbGUgKDApCiAKIGwxX3BnZW50cnlfdCAq
dmlydF90b194ZW5fbDFlKHVuc2lnbmVkIGxvbmcgdik7Ci0tIAoyLjE3LjEKCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBs
aXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2pl
Y3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C6BC4151D69
	for <lists+xen-devel@lfdr.de>; Tue,  4 Feb 2020 16:40:06 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iz0Gf-0001TL-Bo; Tue, 04 Feb 2020 15:37:37 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=VjgO=3Y=gmail.com=wei.liu.xen@srs-us1.protection.inumbo.net>)
 id 1iz0Gd-0001Sd-AF
 for xen-devel@lists.xenproject.org; Tue, 04 Feb 2020 15:37:35 +0000
X-Inumbo-ID: 379c1b88-4764-11ea-b211-bc764e2007e4
Received: from mail-wr1-x443.google.com (unknown [2a00:1450:4864:20::443])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 379c1b88-4764-11ea-b211-bc764e2007e4;
 Tue, 04 Feb 2020 15:37:14 +0000 (UTC)
Received: by mail-wr1-x443.google.com with SMTP id z3so23679672wru.3
 for <xen-devel@lists.xenproject.org>; Tue, 04 Feb 2020 07:37:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=sender:from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=2o+ZbfiA0a6Wu3YZ4de0M249TmV6XmlurF8HVqhhL2Q=;
 b=oWFuSr55Wpmndzs8SN9c2Lm8sz56GbSC8F/2KL3FZRjz8eEfcSd5uhjMc65fB5slqy
 SXgmCXzheWUP4Rwm4Vd6z/Z0P7L++XeY7X0NFg7e09LkpDSN2ac6DWTP2/rJju+YQEDk
 btML7Rs+qc+07Gu5fwV5iTlINZNTOz1yPcFAxL/ExNUWbMza8ZEV36MwENVZqHWGFeQN
 GOiLG6anKwQZd+DgI8PsScz5svgaEm8t0PqIRv+wXRF7yIGSzrYaUmtKlt9wLK5ZFJti
 r820oVZz5jEE06eQ/Hwmv7b+jHCYRN13oW8IehDHIGVYSmLkZfRj5m/mAg3o3cE123mg
 k7ZQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:from:to:cc:subject:date:message-id
 :in-reply-to:references:mime-version:content-transfer-encoding;
 bh=2o+ZbfiA0a6Wu3YZ4de0M249TmV6XmlurF8HVqhhL2Q=;
 b=bGpNQ/DVt8+m64F2tm5uLlfskhcanslspMyBQs0R48+RKBDkc2CbiFzwnK/3ETA6mK
 SdVFua9glMfZenbPAGWvLrXLwURaE+lv77YEUTogCs5FCW1AQWAWlS3A0MAUngYd7yQY
 TIRLVVeQhvUEiRJi9L2dh4IV0g0/DVIQNxsWa1BFmbemsPRI0FuK4AFKjZ2Nat6Mv9H9
 Iy88+VTRObnUu3eCRP/VvDrVrFN+H3AJMPHxkMGQbsNS+dcArbHxRIywZpo7TyF//QS3
 1jVK3bXhp3u/uTcRFWTmyBkz6mqscJMDMBWy3VvDO5KasIZQxCi5e+auuRB6SOmt+1vo
 kPwg==
X-Gm-Message-State: APjAAAVSM7MaB61npQte4e68KhH2R9hmz80x9njy0kwAugkOuYrkUhUX
 Tjk2Bpqbyekuwf7oU/SKkeRrcQkxGTM=
X-Google-Smtp-Source: APXvYqzufoR5C7xLbPZeGeTwiN703d6qgtrbLKyDC4fFTo3mtRKYZor7Q+HtnQQG/l8VfX+zhoY2XQ==
X-Received: by 2002:adf:cd92:: with SMTP id q18mr22223567wrj.261.1580830633811; 
 Tue, 04 Feb 2020 07:37:13 -0800 (PST)
Received: from localhost.localdomain (41.142.6.51.dyn.plus.net. [51.6.142.41])
 by smtp.gmail.com with ESMTPSA id
 p26sm4067143wmc.24.2020.02.04.07.37.13
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 04 Feb 2020 07:37:13 -0800 (PST)
From: Wei Liu <wl@xen.org>
X-Google-Original-From: Wei Liu <liuwe@microsoft.com>
To: Xen Development List <xen-devel@lists.xenproject.org>
Date: Tue,  4 Feb 2020 15:36:59 +0000
Message-Id: <20200204153704.15934-6-liuwe@microsoft.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200204153704.15934-1-liuwe@microsoft.com>
References: <20200204153704.15934-1-liuwe@microsoft.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v7 05/10] x86/hyperv: setup hypercall page
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Wei Liu <liuwe@microsoft.com>, Wei Liu <wl@xen.org>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Paul Durrant <pdurrant@amazon.com>,
 Michael Kelley <mikelley@microsoft.com>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SHlwZXItViB1c2VzIGEgdGVjaG5pcXVlIGNhbGxlZCBvdmVybGF5IHBhZ2UgZm9yIGl0cyBoeXBl
cmNhbGwgcGFnZS4gSXQKd2lsbCBpbnNlcnQgYSBiYWNraW5nIHBhZ2UgdG8gdGhlIGd1ZXN0IHdo
ZW4gdGhlIGh5cGVyY2FsbCBmdW5jdGlvbmFsaXR5CmlzIGVuYWJsZWQuIFRoYXQgbWVhbnMgd2Ug
Y2FuIHVzZSBhIHBhZ2UgdGhhdCBpcyBub3QgYmFja2VkIGJ5IHJlYWwKbWVtb3J5IGZvciBoeXBl
cmNhbGwgcGFnZS4KClRvIGF2b2lkIHNoYXR0ZXJpbmcgTDAgc3VwZXJwYWdlcyBhbmQgdHJlYWRp
bmcgb24gYW55IE1NSU8gYXJlYXMKcmVzaWRpbmcgaW4gbG93IGFkZHJlc3NlcywgdXNlIHRoZSB0
b3AtbW9zdCBhZGRyZXNzYWJsZSBwYWdlIGZvciB0aGF0CnB1cnBvc2UuIEFkanVzdCBlODIwIG1h
cCBhY2NvcmRpbmdseS4KCldlIGFsc28gbmVlZCB0byByZWdpc3RlciBYZW4ncyBndWVzdCBPUyBJ
RCB0byBIeXBlci1WLiBVc2UgMHgzIGFzIHRoZQp2ZW5kb3IgSUQuIEZpeCB0aGUgY29tbWVudCBp
biBoeXBlcnYtdGxmcy5oIHdoaWxlIGF0IGl0LgoKU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8bGl1
d2VAbWljcm9zb2Z0LmNvbT4KLS0tCnY3OgoxLiBGaXggYSBzdHlsZSBpc3N1ZQoyLiBJbml0aWFs
aXNlIElEIHRvIDAKMy4gVXBkYXRlIGNvbW1pdCBtZXNzYWdlCgp2NjoKMS4gVXNlIGh2X2d1ZXN0
X29zX2lkCjIuIFVzZSBuZXcgZTgyMF9maXh1cCBob29rCjMuIEFkZCBhIEJVSUxEX0JVR19PTgoK
djU6CjEuIHVzZSBoeXBlcnZpc29yX3Jlc2VydmVfdG9wX3BhZ2VzCjIuIGFkZCBhIG1hY3JvIGZv
ciBoeXBlcmNhbGwgcGFnZSBtZm4KMy4gYWRkcmVzcyBvdGhlciBtaXNjIGNvbW1lbnRzCgp2NDoK
MS4gVXNlIGZpeG1hcAoyLiBGb2xsb3cgcm91dGluZXMgbGlzdGVkIGluIFRMRlMKLS0tCiB4ZW4v
YXJjaC94ODYvZ3Vlc3QvaHlwZXJ2L2h5cGVydi5jICAgICAgfCA2OSArKysrKysrKysrKysrKysr
KysrKysrKy0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2d1ZXN0L2h5cGVydi10bGZzLmggfCAgNSAr
LQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9ndWVzdC9oeXBlcnYuaCAgICAgIHwgIDMgKysKIDMgZmls
ZXMgY2hhbmdlZCwgNzIgaW5zZXJ0aW9ucygrKSwgNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvZ3Vlc3QvaHlwZXJ2L2h5cGVydi5jIGIveGVuL2FyY2gveDg2L2d1ZXN0
L2h5cGVydi9oeXBlcnYuYwppbmRleCA4ZDM4MzEzZDdhLi4yZTIwYTk2ZjMwIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvZ3Vlc3QvaHlwZXJ2L2h5cGVydi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9n
dWVzdC9oeXBlcnYvaHlwZXJ2LmMKQEAgLTE5LDE1ICsxOSwyNyBAQAogICogQ29weXJpZ2h0IChj
KSAyMDE5IE1pY3Jvc29mdC4KICAqLwogI2luY2x1ZGUgPHhlbi9pbml0Lmg+CisjaW5jbHVkZSA8
eGVuL3ZlcnNpb24uaD4KIAorI2luY2x1ZGUgPGFzbS9maXhtYXAuaD4KICNpbmNsdWRlIDxhc20v
Z3Vlc3QuaD4KICNpbmNsdWRlIDxhc20vZ3Vlc3QvaHlwZXJ2LXRsZnMuaD4KKyNpbmNsdWRlIDxh
c20vcHJvY2Vzc29yLmg+CiAKIHN0cnVjdCBtc19oeXBlcnZfaW5mbyBfX3JlYWRfbW9zdGx5IG1z
X2h5cGVydjsKIAotc3RhdGljIGNvbnN0IHN0cnVjdCBoeXBlcnZpc29yX29wcyBvcHMgPSB7Ci0g
ICAgLm5hbWUgPSAiSHlwZXItViIsCi19Oworc3RhdGljIHVpbnQ2NF90IGdlbmVyYXRlX2d1ZXN0
X2lkKHZvaWQpCit7CisgICAgdW5pb24gaHZfZ3Vlc3Rfb3NfaWQgaWQgPSB7fTsKKworICAgIGlk
LnZlbmRvciA9IEhWX1hFTl9WRU5ET1JfSUQ7CisgICAgaWQubWFqb3IgPSB4ZW5fbWFqb3JfdmVy
c2lvbigpOworICAgIGlkLm1pbm9yID0geGVuX21pbm9yX3ZlcnNpb24oKTsKKworICAgIHJldHVy
biBpZC5yYXc7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaHlwZXJ2aXNvcl9vcHMgb3BzOwog
CiBjb25zdCBzdHJ1Y3QgaHlwZXJ2aXNvcl9vcHMgKl9faW5pdCBoeXBlcnZfcHJvYmUodm9pZCkK
IHsKQEAgLTcyLDYgKzg0LDU3IEBAIGNvbnN0IHN0cnVjdCBoeXBlcnZpc29yX29wcyAqX19pbml0
IGh5cGVydl9wcm9iZSh2b2lkKQogICAgIHJldHVybiAmb3BzOwogfQogCitzdGF0aWMgdm9pZCBf
X2luaXQgc2V0dXBfaHlwZXJjYWxsX3BhZ2Uodm9pZCkKK3sKKyAgICB1bmlvbiBodl94NjRfbXNy
X2h5cGVyY2FsbF9jb250ZW50cyBoeXBlcmNhbGxfbXNyOworICAgIHVuaW9uIGh2X2d1ZXN0X29z
X2lkIGd1ZXN0X2lkOworICAgIHVuc2lnbmVkIGxvbmcgbWZuOworCisgICAgQlVJTERfQlVHX09O
KEhWX0hZUF9QQUdFX1NISUZUICE9IFBBR0VfU0hJRlQpOworCisgICAgcmRtc3JsKEhWX1g2NF9N
U1JfR1VFU1RfT1NfSUQsIGd1ZXN0X2lkLnJhdyk7CisgICAgaWYgKCAhZ3Vlc3RfaWQucmF3ICkK
KyAgICB7CisgICAgICAgIGd1ZXN0X2lkLnJhdyA9IGdlbmVyYXRlX2d1ZXN0X2lkKCk7CisgICAg
ICAgIHdybXNybChIVl9YNjRfTVNSX0dVRVNUX09TX0lELCBndWVzdF9pZC5yYXcpOworICAgIH0K
KworICAgIHJkbXNybChIVl9YNjRfTVNSX0hZUEVSQ0FMTCwgaHlwZXJjYWxsX21zci5hc191aW50
NjQpOworICAgIGlmICggIWh5cGVyY2FsbF9tc3IuZW5hYmxlICkKKyAgICB7CisgICAgICAgIG1m
biA9IEhWX0hDQUxMX01GTjsKKyAgICAgICAgaHlwZXJjYWxsX21zci5lbmFibGUgPSAxOworICAg
ICAgICBoeXBlcmNhbGxfbXNyLmd1ZXN0X3BoeXNpY2FsX2FkZHJlc3MgPSBtZm47CisgICAgICAg
IHdybXNybChIVl9YNjRfTVNSX0hZUEVSQ0FMTCwgaHlwZXJjYWxsX21zci5hc191aW50NjQpOwor
ICAgIH0KKyAgICBlbHNlCisgICAgICAgIG1mbiA9IGh5cGVyY2FsbF9tc3IuZ3Vlc3RfcGh5c2lj
YWxfYWRkcmVzczsKKworICAgIHJkbXNybChIVl9YNjRfTVNSX0hZUEVSQ0FMTCwgaHlwZXJjYWxs
X21zci5hc191aW50NjQpOworICAgIEJVR19PTighaHlwZXJjYWxsX21zci5lbmFibGUpOworCisg
ICAgc2V0X2ZpeG1hcF94KEZJWF9YX0hZUEVSVl9IQ0FMTCwgbWZuIDw8IFBBR0VfU0hJRlQpOwor
fQorCitzdGF0aWMgdm9pZCBfX2luaXQgc2V0dXAodm9pZCkKK3sKKyAgICBzZXR1cF9oeXBlcmNh
bGxfcGFnZSgpOworfQorCitzdGF0aWMgdm9pZCBfX2luaXQgZTgyMF9maXh1cChzdHJ1Y3QgZTgy
MG1hcCAqZTgyMCkKK3sKKyAgICB1aW50NjRfdCBzID0gSFZfSENBTExfTUZOIDw8IFBBR0VfU0hJ
RlQ7CisKKyAgICBpZiAoICFlODIwX2FkZF9yYW5nZShlODIwLCBzLCBzICsgUEFHRV9TSVpFLCBF
ODIwX1JFU0VSVkVEKSApCisgICAgICAgIHBhbmljKCJVbmFibGUgdG8gcmVzZXJ2ZSBIeXBlci1W
IGh5cGVyY2FsbCByYW5nZVxuIik7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaHlwZXJ2aXNv
cl9vcHMgb3BzID0geworICAgIC5uYW1lID0gIkh5cGVyLVYiLAorICAgIC5zZXR1cCA9IHNldHVw
LAorICAgIC5lODIwX2ZpeHVwID0gZTgyMF9maXh1cCwKK307CisKIC8qCiAgKiBMb2NhbCB2YXJp
YWJsZXM6CiAgKiBtb2RlOiBDCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L2d1ZXN0
L2h5cGVydi10bGZzLmggYi94ZW4vaW5jbHVkZS9hc20teDg2L2d1ZXN0L2h5cGVydi10bGZzLmgK
aW5kZXggMDkxZTI1Y2RkMS4uMGEwZjMzOThjMSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNt
LXg4Ni9ndWVzdC9oeXBlcnYtdGxmcy5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvZ3Vlc3Qv
aHlwZXJ2LXRsZnMuaApAQCAtMzE4LDE1ICszMTgsMTYgQEAgc3RydWN0IG1zX2h5cGVydl90c2Nf
cGFnZSB7CiAgKgogICogQml0KHMpCiAgKiA2MyAtIEluZGljYXRlcyBpZiB0aGUgT1MgaXMgT3Bl
biBTb3VyY2Ugb3Igbm90OyAxIGlzIE9wZW4gU291cmNlCi0gKiA2Mjo1NiAtIE9zIFR5cGU7IExp
bnV4IGlzIDB4MTAwCisgKiA2Mjo1NiAtIE9zIFR5cGU7IExpbnV4IDB4MSwgRnJlZUJTRCAweDIs
IFhlbiAweDMKICAqIDU1OjQ4IC0gRGlzdHJvIHNwZWNpZmljIGlkZW50aWZpY2F0aW9uCi0gKiA0
NzoxNiAtIExpbnV4IGtlcm5lbCB2ZXJzaW9uIG51bWJlcgorICogNDc6MTYgLSBHdWVzdCBPUyB2
ZXJzaW9uIG51bWJlcgogICogMTU6MCAgLSBEaXN0cm8gc3BlY2lmaWMgaWRlbnRpZmljYXRpb24K
ICAqCiAgKgogICovCiAKICNkZWZpbmUgSFZfTElOVVhfVkVORE9SX0lEICAgICAgICAgICAgICAw
eDgxMDAKKyNkZWZpbmUgSFZfWEVOX1ZFTkRPUl9JRCAgICAgICAgICAgICAgICAweDgzMDAKIHVu
aW9uIGh2X2d1ZXN0X29zX2lkCiB7CiAgICAgdWludDY0X3QgcmF3OwpkaWZmIC0tZ2l0IGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9ndWVzdC9oeXBlcnYuaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvZ3Vl
c3QvaHlwZXJ2LmgKaW5kZXggYzdhN2YzMmJkNS4uMWExYjQ3ODMxYyAxMDA2NDQKLS0tIGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9ndWVzdC9oeXBlcnYuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2
L2d1ZXN0L2h5cGVydi5oCkBAIC0yMSw2ICsyMSw5IEBACiAKICNpbmNsdWRlIDx4ZW4vdHlwZXMu
aD4KIAorLyogVXNlIHRvcC1tb3N0IE1GTiBmb3IgaHlwZXJjYWxsIHBhZ2UgKi8KKyNkZWZpbmUg
SFZfSENBTExfTUZOICAgKCgoMXVsbCA8PCBwYWRkcl9iaXRzKSAtIDEpID4+IEhWX0hZUF9QQUdF
X1NISUZUKQorCiAvKgogICogVGhlIHNwZWNpZmljYXRpb24gc2F5czogIlRoZSBwYXJ0aXRpb24g
cmVmZXJlbmNlIHRpbWUgaXMgY29tcHV0ZWQKICAqIGJ5IHRoZSBmb2xsb3dpbmcgZm9ybXVsYToK
LS0gCjIuMjAuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3Jn
Cmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

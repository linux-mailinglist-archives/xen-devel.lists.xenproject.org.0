Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id CFFF8109BFF
	for <lists+xen-devel@lfdr.de>; Tue, 26 Nov 2019 11:11:14 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iZXmA-0007Zm-HP; Tue, 26 Nov 2019 10:08:54 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=XQNV=ZS=amazon.de=prvs=226749d31=wipawel@srs-us1.protection.inumbo.net>)
 id 1iZXm8-0007ZN-LP
 for xen-devel@lists.xenproject.org; Tue, 26 Nov 2019 10:08:52 +0000
X-Inumbo-ID: bdcfde05-1034-11ea-a39d-12813bfff9fa
Received: from smtp-fw-6001.amazon.com (unknown [52.95.48.154])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id bdcfde05-1034-11ea-a39d-12813bfff9fa;
 Tue, 26 Nov 2019 10:08:49 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1574762930; x=1606298930;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=HHC+aO2Jx0e+kWJRWhw9lrGkVj5UGqPLet355QSEZNs=;
 b=PTdYWgkeLFr/i0nzzRME9EvwvwDoExpjyhXio/6rd5qKj1BfC+xUgr+z
 urLc8zByNTPYXAC2KsZdZqRkWBFqX32emaUjiX90icnqZFVuw1v2mz2HR
 4ytAs3p31oofb1J/xlivlwldvsiXpOj+wWvu6zCdWIpDpQ5L68gDHj18s s=;
IronPort-SDR: ZC0XYdNxBd0kkgn8GfOEn2Hd2j2axsnYxiAyuzNVwPH5Mzs3J2MMt7MoK+D+OBPp25/ffGcR22
 pW31Z//li99Q==
X-IronPort-AV: E=Sophos;i="5.69,245,1571702400"; 
   d="scan'208";a="6370282"
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-6001.iad6.amazon.com with ESMTP;
 26 Nov 2019 10:08:49 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com (Postfix) with ESMTPS
 id 2B995C060E; Tue, 26 Nov 2019 10:08:45 +0000 (UTC)
Received: from EX13D03EUC003.ant.amazon.com (10.43.164.192) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 26 Nov 2019 10:08:31 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D03EUC003.ant.amazon.com (10.43.164.192) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 26 Nov 2019 10:08:30 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Tue, 26 Nov 2019 10:08:28 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Tue, 26 Nov 2019 10:07:56 +0000
Message-ID: <20191126100801.124844-8-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20191126100801.124844-1-wipawel@amazon.de>
References: <20191126100801.124844-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v6 07/12] livepatch: Add per-function
 applied/reverted state tracking marker
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>, Andrew
 Cooper <andrew.cooper3@citrix.com>, Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Pawel Wieczorkiewicz <wipawel@amazon.de>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TGl2ZXBhdGNoIG9ubHkgdHJhY2tzIGFuIGVudGlyZSBwYXlsb2FkIGFwcGxpZWQvcmV2ZXJ0ZWQg
c3RhdGUuIEJ1dCwKd2l0aCBhbiBvcHRpb24gdG8gc3VwcGx5IHRoZSBhcHBseV9wYXlsb2FkKCkg
YW5kL29yIHJldmVydF9wYXlsb2FkKCkKZnVuY3Rpb25zIGFzIG9wdGlvbmFsIGhvb2tzLCBpdCBi
ZWNvbWVzIHBvc3NpYmxlIHRvIGludGVybWl4IHRoZQpleGVjdXRpb24gb2YgdGhlIG9yaWdpbmFs
IGFwcGx5X3BheWxvYWQoKS9yZXZlcnRfcGF5bG9hZCgpIGZ1bmN0aW9ucwp3aXRoIHRoZWlyIGR5
bmFtaWNhbGx5IHN1cHBsaWVkIGNvdW50ZXJwYXJ0cy4KSXQgaXMgaW1wb3J0YW50IHRoZW4gdG8g
dHJhY2sgdGhlIGN1cnJlbnQgc3RhdGUgb2YgZXZlcnkgZnVuY3Rpb24KYmVpbmcgcGF0Y2hlZCBh
bmQgcHJldmVudCBzaXR1YXRpb25zIG9mIHVuaW50ZW50aW9uYWwgZG91YmxlLWFwcGx5Cm9yIHVu
YXBwbGllZCByZXZlcnQuCgpUbyBzdXBwb3J0IHRoYXQsIGl0IGlzIG5lY2Vzc2FyeSB0byBleHRl
bmQgcHVibGljIGludGVyZmFjZSBvZiB0aGUKbGl2ZXBhdGNoLiBUaGUgc3RydWN0IGxpdmVwYXRj
aF9mdW5jIGdldHMgYWRkaXRpb25hbCBmaWVsZCBob2xkaW5nCnRoZSBhcHBsaWVkL3JldmVydGVk
IHN0YXRlIG1hcmtlci4KClRvIHJlZmxlY3QgdGhlIGxpdmVwYXRjaCBwYXlsb2FkIEFCSSBjaGFu
Z2UsIGJ1bXAgdGhlIHZlcnNpb24gZmxhZwpMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OIHVwIHRv
IDIuCgpbQW5kIGFsc28gdXBkYXRlIHRoZSB0b3Agb2YgdGhlIGRlc2lnbiBkb2N1bWVudF0KClNp
Z25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpvbi5kZT4KUmV2
aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9uLmNvbT4KUmV2
aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBN
YXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5OiBLb25yYWQg
Unplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+CkFja2VkLWJ5OiBKdWxpZW4g
R3JhbGwgPGp1bGllbi5ncmFsbEBhcm0uY29tPgpSZXZpZXdlZC1ieTogUm9zcyBMYWdlcndhbGwg
PHJvc3MubGFnZXJ3YWxsQGNpdHJpeC5jb20+Ci0tLQpDaGFuZ2VkIHNpbmNlIHYzOgogICogVXNl
IGNvbW1vbl9saXZlcGF0Y2hfe2FwcGx5LHJldmVydH0gaW5zdGVhZCBvZiBtb2RpZnlpbmcKICAg
IGFyY2hfbGl2ZXBhdGNoX3thcHBseSxyZXZlcnR9LgogICogcy9ib29sX3QvYm9vbC9nCgpDaGFu
Z2VkIHNpbmNlIHYyOgogICogRG9jdW1lbnRhdGlvbiBmaXhlcwoKQ2hhbmdlZCBzaW5jZSB2MToK
ICAqIHN1cHBvcnQgdGhlIGZlYXR1cmUgZm9yIGFsbCBhcmNoIChhZGQgaGFuZGxpbmcgZm9yIEFy
bSkKICAqIGFkZCBjb21tb24gaXNfZnVuY19hcHBsaWVkKCkgYW5kIGlzX2Z1bmNfcmV2ZXJ0ZWQo
KSB0byBiZQogICAgdXNlZCBieSBhbGwgYXJjaAogICogcmVtb3ZlIGV4cGxpY2l0IGVudW0gdmFs
dWVzIGZyb20gZW51bSBsaXZlcGF0Y2hfZnVuY19zdGF0ZQogICogYWRkZWQgY29ycmVzcG9uZGlu
ZyBkb2N1bWVudGF0aW9uCiAgKiBhZGRlZCB0ZXN0cwotLS0KIGRvY3MvbWlzYy9saXZlcGF0Y2gu
cGFuZG9jICAgICAgICAgICAgICAgICAgICAgfCAgMTcgKystCiB4ZW4vY29tbW9uL2xpdmVwYXRj
aC5jICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDM5ICsrKysrKy0KIHhlbi9pbmNsdWRlL3B1
YmxpYy9zeXNjdGwuaCAgICAgICAgICAgICAgICAgICAgfCAgIDkgKy0KIHhlbi9pbmNsdWRlL3hl
bi9saXZlcGF0Y2guaCAgICAgICAgICAgICAgICAgICAgfCAgMjggKysrKysKIHhlbi90ZXN0L2xp
dmVwYXRjaC9NYWtlZmlsZSAgICAgICAgICAgICAgICAgICAgfCAgMjcgKysrKy0KIHhlbi90ZXN0
L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzLmMgICAgICAgICAgfCAgIDIgKwogeGVuL3Rlc3Qv
bGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3NfbWFya2VyLmMgICB8IDExMiArKysrKysrKysrKysr
KysrKysrCiB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19ub2FwcGx5LmMgIHwg
MTM2ICsrKysrKysrKysrKysrKysrKysrKysrCiB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlv
bl9ob29rc19ub3JldmVydC5jIHwgMTQzICsrKysrKysrKysrKysrKysrKysrKysrKysKIDkgZmls
ZXMgY2hhbmdlZCwgNTA3IGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgeGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3NfbWFya2VyLmMKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19ub2Fw
cGx5LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9o
b29rc19ub3JldmVydC5jCgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2Mg
Yi9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwppbmRleCAzYzYzNWFkZDkyLi4wMjM0OGRkNDll
IDEwMDY0NAotLS0gYS9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYworKysgYi9kb2NzL21pc2Mv
bGl2ZXBhdGNoLnBhbmRvYwpAQCAtMSw0ICsxLDQgQEAKLSMgWGVuIExpdmUgUGF0Y2hpbmcgRGVz
aWduIHYxCisjIFhlbiBMaXZlIFBhdGNoaW5nIERlc2lnbiB2MgogCiAjIyBSYXRpb25hbGUKIApA
QCAtMjk3LDEwICsyOTcsMTQgQEAgd2hpY2ggZGVzY3JpYmUgdGhlIGZ1bmN0aW9ucyB0byBiZSBw
YXRjaGVkOgogICAgICAgICB1aW50MzJfdCBvbGRfc2l6ZTsKICAgICAgICAgdWludDhfdCB2ZXJz
aW9uOwogICAgICAgICB1aW50OF90IG9wYXF1ZVszMV07CisgICAgICAgIC8qIEFkZGVkIHRvIGxp
dmVwYXRjaCBwYXlsb2FkIHZlcnNpb24gMjogKi8KKyAgICAgICAgdWludDhfdCBhcHBsaWVkOwor
ICAgICAgICB1aW50OF90IF9wYWRbN107CiAgICAgfTsKIAogVGhlIHNpemUgb2YgdGhlIHN0cnVj
dHVyZSBpcyA2NCBieXRlcyBvbiA2NC1iaXQgaHlwZXJ2aXNvcnMuIEl0IHdpbGwgYmUKIDUyIG9u
IDMyLWJpdCBoeXBlcnZpc29ycy4KK1RoZSB2ZXJzaW9uIDIgb2YgdGhlIHBheWxvYWQgYWRkcyBh
ZGRpdGlvbmFsIDggYnl0ZXMgdG8gdGhlIHN0cnVjdHVyZSBzaXplLgogCiAgKiBgbmFtZWAgaXMg
dGhlIHN5bWJvbCBuYW1lIG9mIHRoZSBvbGQgZnVuY3Rpb24uIE9ubHkgdXNlZCBpZiBgb2xkX2Fk
ZHJgIGlzCiAgICB6ZXJvLCBvdGhlcndpc2Ugd2lsbCBiZSB1c2VkIGR1cmluZyBkeW5hbWljIGxp
bmtpbmcgKHdoZW4gaHlwZXJ2aXNvciBsb2FkcwpAQCAtMzI0LDkgKzMyOCwxNSBAQCBUaGUgc2l6
ZSBvZiB0aGUgc3RydWN0dXJlIGlzIDY0IGJ5dGVzIG9uIDY0LWJpdCBoeXBlcnZpc29ycy4gSXQg
d2lsbCBiZQogICAgKiBJZiB0aGUgdmFsdWUgb2YgYG5ld19hZGRyYCBpcyB6ZXJvIHRoZW4gYG5l
d19zaXplYCBkZXRlcm1pbmVzIGhvdyBtYW55CiAgICAgaW5zdHJ1Y3Rpb24gYnl0ZXMgdG8gTk9Q
ICh1cCB0byBvcGFxdWUgc2l6ZSBtb2R1bG8gc21hbGxlc3QgcGxhdGZvcm0KICAgICBpbnN0cnVj
dGlvbiAtIDEgYnl0ZSB4ODYgYW5kIDQgYnl0ZXMgb24gQVJNKS4KLSAqIGB2ZXJzaW9uYCBpcyB0
byBiZSBvbmUuCisgKiBgdmVyc2lvbmAgaW5kaWNhdGVzIHZlcnNpb24gb2YgdGhlIGdlbmVyYXRl
ZCBwYXlsb2FkLgogICogYG9wYXF1ZWAgKipNVVNUKiogYmUgemVyby4KIAorVGhlIHZlcnNpb24g
MiBvZiB0aGUgcGF5bG9hZCBhZGRzIHRoZSBmb2xsb3dpbmcgZmllbGRzIHRvIHRoZSBzdHJ1Y3R1
cmU6CisKKyAgKiBgYXBwbGllZGAgdHJhY2tzIGZ1bmN0aW9uJ3MgYXBwbGllZC9yZXZlcnRlZCBz
dGF0ZS4gSXQgaGFzIGEgYm9vbGVhbiB0eXBlCisgICAgZWl0aGVyIExJVkVQQVRDSF9GVU5DX05P
VF9BUFBMSUVEIG9yIExJVkVQQVRDSF9GVU5DX0FQUExJRUQuCisgICogYF9wYWRbN11gIGFkZHMg
cGFkZGluZyB0byBhbGlnbiB0byA4IGJ5dGVzLgorCiBUaGUgc2l6ZSBvZiB0aGUgYGxpdmVwYXRj
aF9mdW5jYCBhcnJheSBpcyBkZXRlcm1pbmVkIGZyb20gdGhlIEVMRiBzZWN0aW9uCiBzaXplLgog
CkBAIC0zNzgsNiArMzg4LDkgQEAgQSBzaW1wbGUgZXhhbXBsZSBvZiB3aGF0IGEgcGF5bG9hZCBm
aWxlIGNhbiBiZToKICAgICAgICAgdWludDMyX3Qgb2xkX3NpemU7CiAgICAgICAgIHVpbnQ4X3Qg
dmVyc2lvbjsKICAgICAgICAgdWludDhfdCBwYWRbMzFdOworICAgICAgICAvKiBBZGRlZCB0byBs
aXZlcGF0Y2ggcGF5bG9hZCB2ZXJzaW9uIDI6ICovCisgICAgICAgIHVpbnQ4X3QgYXBwbGllZDsK
KyAgICAgICAgdWludDhfdCBfcGFkWzddOwogICAgIH07CiAKICAgICAvKiBPdXIgcmVwbGFjZW1l
bnQgZnVuY3Rpb24gZm9yIHhlbl9leHRyYV92ZXJzaW9uLiAqLwpkaWZmIC0tZ2l0IGEveGVuL2Nv
bW1vbi9saXZlcGF0Y2guYyBiL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKaW5kZXggYWRkN2RhN2Zh
OS4uODFlMWI0NzRjZCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9saXZlcGF0Y2guYworKysgYi94
ZW4vY29tbW9uL2xpdmVwYXRjaC5jCkBAIC0xMTgyLDcgKzExODIsNyBAQCBzdGF0aWMgaW50IGFw
cGx5X3BheWxvYWQoc3RydWN0IHBheWxvYWQgKmRhdGEpCiAgICAgQVNTRVJUKCFsb2NhbF9pcnFf
aXNfZW5hYmxlZCgpKTsKIAogICAgIGZvciAoIGkgPSAwOyBpIDwgZGF0YS0+bmZ1bmNzOyBpKysg
KQotICAgICAgICBhcmNoX2xpdmVwYXRjaF9hcHBseSgmZGF0YS0+ZnVuY3NbaV0pOworICAgICAg
ICBjb21tb25fbGl2ZXBhdGNoX2FwcGx5KCZkYXRhLT5mdW5jc1tpXSk7CiAKICAgICBhcmNoX2xp
dmVwYXRjaF9yZXZpdmUoKTsKIApAQCAtMTIxNiw3ICsxMjE2LDcgQEAgc3RhdGljIGludCByZXZl
cnRfcGF5bG9hZChzdHJ1Y3QgcGF5bG9hZCAqZGF0YSkKICAgICB9CiAKICAgICBmb3IgKCBpID0g
MDsgaSA8IGRhdGEtPm5mdW5jczsgaSsrICkKLSAgICAgICAgYXJjaF9saXZlcGF0Y2hfcmV2ZXJ0
KCZkYXRhLT5mdW5jc1tpXSk7CisgICAgICAgIGNvbW1vbl9saXZlcGF0Y2hfcmV2ZXJ0KCZkYXRh
LT5mdW5jc1tpXSk7CiAKICAgICAvKgogICAgICAqIFNpbmNlIHdlIGFyZSBydW5uaW5nIHdpdGgg
SVJRcyBkaXNhYmxlZCBhbmQgdGhlIGhvb2tzIG1heSBjYWxsIGNvbW1vbgpAQCAtMTI0OCw2ICsx
MjQ4LDI5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCByZXZlcnRfcGF5bG9hZF90YWlsKHN0cnVjdCBw
YXlsb2FkICpkYXRhKQogICAgIGRhdGEtPnN0YXRlID0gTElWRVBBVENIX1NUQVRFX0NIRUNLRUQ7
CiB9CiAKKy8qCisgKiBDaGVjayBpZiBhbiBhY3Rpb24gaGFzIGFwcGxpZWQgdGhlIHNhbWUgc3Rh
dGUgdG8gYWxsIHBheWxvYWQncyBmdW5jdGlvbnMgY29uc2lzdGVudGx5LgorICovCitzdGF0aWMg
aW5saW5lIGJvb2wgd2FzX2FjdGlvbl9jb25zaXN0ZW50KGNvbnN0IHN0cnVjdCBwYXlsb2FkICpk
YXRhLCBsaXZlcGF0Y2hfZnVuY19zdGF0ZV90IGV4cGVjdGVkX3N0YXRlKQoreworICAgIGludCBp
OworCisgICAgZm9yICggaSA9IDA7IGkgPCBkYXRhLT5uZnVuY3M7IGkrKyApCisgICAgeworICAg
ICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmYgPSAmKGRhdGEtPmZ1bmNzW2ldKTsKKworICAg
ICAgICBpZiAoIGYtPmFwcGxpZWQgIT0gZXhwZWN0ZWRfc3RhdGUgKQorICAgICAgICB7CisgICAg
ICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVzOiBQYXlsb2FkIGhhcyBhIGZ1
bmN0aW9uOiAnJXMnIHdpdGggaW5jb25zaXN0ZW50IGFwcGxpZWQgc3RhdGUuXG4iLAorICAgICAg
ICAgICAgICAgICAgIGRhdGEtPm5hbWUsIGYtPm5hbWUgPzogIm5vbmFtZSIpOworCisgICAgICAg
ICAgICByZXR1cm4gZmFsc2U7CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXR1cm4gdHJ1ZTsK
K30KKwogLyoKICAqIFRoaXMgZnVuY3Rpb24gaXMgZXhlY3V0ZWQgaGF2aW5nIGFsbCBvdGhlciBD
UFVzIHdpdGggbm8gZGVlcCBzdGFjayAod2UgbWF5CiAgKiBoYXZlIGNwdV9pZGxlIG9uIGl0KSBh
bmQgSVJRcyBkaXNhYmxlZC4KQEAgLTEyNzQsNiArMTI5Nyw5IEBAIHN0YXRpYyB2b2lkIGxpdmVw
YXRjaF9kb19hY3Rpb24odm9pZCkKICAgICAgICAgZWxzZQogICAgICAgICAgICAgcmMgPSBhcHBs
eV9wYXlsb2FkKGRhdGEpOwogCisgICAgICAgIGlmICggIXdhc19hY3Rpb25fY29uc2lzdGVudChk
YXRhLCByYyA/IExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVEIDogTElWRVBBVENIX0ZVTkNfQVBQ
TElFRCkgKQorICAgICAgICAgICAgcGFuaWMoImxpdmVwYXRjaDogcGFydGlhbGx5IGFwcGxpZWQg
cGF5bG9hZCAnJXMnIVxuIiwgZGF0YS0+bmFtZSk7CisKICAgICAgICAgaWYgKCByYyA9PSAwICkK
ICAgICAgICAgICAgIGFwcGx5X3BheWxvYWRfdGFpbChkYXRhKTsKICAgICAgICAgYnJlYWs7CkBA
IC0xMjg4LDYgKzEzMTQsOSBAQCBzdGF0aWMgdm9pZCBsaXZlcGF0Y2hfZG9fYWN0aW9uKHZvaWQp
CiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIHJjID0gcmV2ZXJ0X3BheWxvYWQoZGF0YSk7CiAK
KyAgICAgICAgaWYgKCAhd2FzX2FjdGlvbl9jb25zaXN0ZW50KGRhdGEsIHJjID8gTElWRVBBVENI
X0ZVTkNfQVBQTElFRCA6IExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVEKSApCisgICAgICAgICAg
ICBwYW5pYygibGl2ZXBhdGNoOiBwYXJ0aWFsbHkgcmV2ZXJ0ZWQgcGF5bG9hZCAnJXMnIVxuIiwg
ZGF0YS0+bmFtZSk7CisKICAgICAgICAgaWYgKCByYyA9PSAwICkKICAgICAgICAgICAgIHJldmVy
dF9wYXlsb2FkX3RhaWwoZGF0YSk7CiAgICAgICAgIGJyZWFrOwpAQCAtMTMwOSw2ICsxMzM4LDkg
QEAgc3RhdGljIHZvaWQgbGl2ZXBhdGNoX2RvX2FjdGlvbih2b2lkKQogICAgICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgICAgIG90aGVyLT5yYyA9IHJldmVydF9wYXlsb2FkKG90aGVyKTsKIAor
ICAgICAgICAgICAgaWYgKCAhd2FzX2FjdGlvbl9jb25zaXN0ZW50KG90aGVyLCByYyA/IExJVkVQ
QVRDSF9GVU5DX0FQUExJRUQgOiBMSVZFUEFUQ0hfRlVOQ19OT1RfQVBQTElFRCkgKQorICAgICAg
ICAgICAgICAgIHBhbmljKCJsaXZlcGF0Y2g6IHBhcnRpYWxseSByZXZlcnRlZCBwYXlsb2FkICcl
cychXG4iLCBvdGhlci0+bmFtZSk7CisKICAgICAgICAgICAgIGlmICggb3RoZXItPnJjID09IDAg
KQogICAgICAgICAgICAgICAgIHJldmVydF9wYXlsb2FkX3RhaWwob3RoZXIpOwogICAgICAgICAg
ICAgZWxzZQpAQCAtMTMyOSw2ICsxMzYxLDkgQEAgc3RhdGljIHZvaWQgbGl2ZXBhdGNoX2RvX2Fj
dGlvbih2b2lkKQogICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgIHJjID0gYXBwbHlf
cGF5bG9hZChkYXRhKTsKIAorICAgICAgICAgICAgaWYgKCAhd2FzX2FjdGlvbl9jb25zaXN0ZW50
KGRhdGEsIHJjID8gTElWRVBBVENIX0ZVTkNfTk9UX0FQUExJRUQgOiBMSVZFUEFUQ0hfRlVOQ19B
UFBMSUVEKSApCisgICAgICAgICAgICAgICAgcGFuaWMoImxpdmVwYXRjaDogcGFydGlhbGx5IGFw
cGxpZWQgcGF5bG9hZCAnJXMnIVxuIiwgZGF0YS0+bmFtZSk7CisKICAgICAgICAgICAgIGlmICgg
cmMgPT0gMCApCiAgICAgICAgICAgICAgICAgYXBwbHlfcGF5bG9hZF90YWlsKGRhdGEpOwogICAg
ICAgICB9CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmggYi94ZW4vaW5j
bHVkZS9wdWJsaWMvc3lzY3RsLmgKaW5kZXggN2EwODg0YjcwYi4uNGY1MmFkNTgxZiAxMDA2NDQK
LS0tIGEveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oCisrKyBiL3hlbi9pbmNsdWRlL3B1Ymxp
Yy9zeXNjdGwuaApAQCAtODMyLDcgKzgzMiw3IEBAIHN0cnVjdCB4ZW5fc3lzY3RsX2NwdV9mZWF0
dXJlc2V0IHsKICAqICAgICBJZiB6ZXJvIGV4aXQgd2l0aCBzdWNjZXNzLgogICovCiAKLSNkZWZp
bmUgTElWRVBBVENIX1BBWUxPQURfVkVSU0lPTiAxCisjZGVmaW5lIExJVkVQQVRDSF9QQVlMT0FE
X1ZFUlNJT04gMgogLyoKICAqIC5saXZlcGF0Y2guZnVuY3Mgc3RydWN0dXJlIGxheW91dCBkZWZp
bmVkIGluIHRoZSBgUGF5bG9hZCBmb3JtYXRgCiAgKiBzZWN0aW9uIGluIHRoZSBMaXZlIFBhdGNo
IGRlc2lnbiBkb2N1bWVudC4KQEAgLTg0MCw2ICs4NDAsMTEgQEAgc3RydWN0IHhlbl9zeXNjdGxf
Y3B1X2ZlYXR1cmVzZXQgewogICogV2UgZ3VhcmQgdGhpcyB3aXRoIF9fWEVOX18gYXMgdG9vbHN0
YWNrcyBTSE9VTEQgbm90IHVzZSBpdC4KICAqLwogI2lmZGVmIF9fWEVOX18KK3R5cGVkZWYgZW51
bSBsaXZlcGF0Y2hfZnVuY19zdGF0ZSB7CisgICAgTElWRVBBVENIX0ZVTkNfTk9UX0FQUExJRUQs
CisgICAgTElWRVBBVENIX0ZVTkNfQVBQTElFRAorfSBsaXZlcGF0Y2hfZnVuY19zdGF0ZV90Owor
CiBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgewogICAgIGNvbnN0IGNoYXIgKm5hbWU7ICAgICAgIC8q
IE5hbWUgb2YgZnVuY3Rpb24gdG8gYmUgcGF0Y2hlZC4gKi8KICAgICB2b2lkICpuZXdfYWRkcjsK
QEAgLTg0OCw2ICs4NTMsOCBAQCBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgewogICAgIHVpbnQzMl90
IG9sZF9zaXplOwogICAgIHVpbnQ4X3QgdmVyc2lvbjsgICAgICAgIC8qIE1VU1QgYmUgTElWRVBB
VENIX1BBWUxPQURfVkVSU0lPTi4gKi8KICAgICB1aW50OF90IG9wYXF1ZVszMV07CisgICAgdWlu
dDhfdCBhcHBsaWVkOworICAgIHVpbnQ4X3QgX3BhZFs3XTsKIH07CiB0eXBlZGVmIHN0cnVjdCBs
aXZlcGF0Y2hfZnVuYyBsaXZlcGF0Y2hfZnVuY190OwogI2VuZGlmCmRpZmYgLS1naXQgYS94ZW4v
aW5jbHVkZS94ZW4vbGl2ZXBhdGNoLmggYi94ZW4vaW5jbHVkZS94ZW4vbGl2ZXBhdGNoLmgKaW5k
ZXggM2E5MTYyNmE3OS4uZjNhZTEwZjAwNyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL2xp
dmVwYXRjaC5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9saXZlcGF0Y2guaApAQCAtMTIzLDYgKzEy
MywzNCBAQCB2b2lkIGFyY2hfbGl2ZXBhdGNoX3Bvc3RfYWN0aW9uKHZvaWQpOwogCiB2b2lkIGFy
Y2hfbGl2ZXBhdGNoX21hc2sodm9pZCk7CiB2b2lkIGFyY2hfbGl2ZXBhdGNoX3VubWFzayh2b2lk
KTsKKworc3RhdGljIGlubGluZSB2b2lkIGNvbW1vbl9saXZlcGF0Y2hfYXBwbHkoc3RydWN0IGxp
dmVwYXRjaF9mdW5jICpmdW5jKQoreworICAgIC8qIElmIHRoZSBhY3Rpb24gaGFzIGJlZW4gYWxy
ZWFkeSBleGVjdXRlZCBvbiB0aGlzIGZ1bmN0aW9uLCBkbyBub3RoaW5nLiAqLworICAgIGlmICgg
ZnVuYy0+YXBwbGllZCA9PSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEICkKKyAgICB7CisgICAgICAg
IHByaW50ayhYRU5MT0dfV0FSTklORyBMSVZFUEFUQ0ggIiVzOiAlcyBoYXMgYmVlbiBhbHJlYWR5
IGFwcGxpZWQgYmVmb3JlXG4iLAorICAgICAgICAgICAgICAgIF9fZnVuY19fLCBmdW5jLT5uYW1l
KTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGFyY2hfbGl2ZXBhdGNoX2FwcGx5KGZ1
bmMpOworICAgIGZ1bmMtPmFwcGxpZWQgPSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEOworfQorCitz
dGF0aWMgaW5saW5lIHZvaWQgY29tbW9uX2xpdmVwYXRjaF9yZXZlcnQoc3RydWN0IGxpdmVwYXRj
aF9mdW5jICpmdW5jKQoreworICAgIC8qIElmIHRoZSBhcHBseSBhY3Rpb24gaGFzbid0IGJlZW4g
ZXhlY3V0ZWQgb24gdGhpcyBmdW5jdGlvbiwgZG8gbm90aGluZy4gKi8KKyAgICBpZiAoICFmdW5j
LT5vbGRfYWRkciB8fCBmdW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVE
ICkKKyAgICB7CisgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBMSVZFUEFUQ0ggIiVzOiAl
cyBoYXMgbm90IGJlZW4gYXBwbGllZCBiZWZvcmVcbiIsCisgICAgICAgICAgICAgICAgX19mdW5j
X18sIGZ1bmMtPm5hbWUpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgYXJjaF9saXZl
cGF0Y2hfcmV2ZXJ0KGZ1bmMpOworICAgIGZ1bmMtPmFwcGxpZWQgPSBMSVZFUEFUQ0hfRlVOQ19O
T1RfQVBQTElFRDsKK30KICNlbHNlCiAKIC8qCmRpZmYgLS1naXQgYS94ZW4vdGVzdC9saXZlcGF0
Y2gvTWFrZWZpbGUgYi94ZW4vdGVzdC9saXZlcGF0Y2gvTWFrZWZpbGUKaW5kZXggYmJjNmJkYWY2
NC4uMjMxMTNkMzQxOCAxMDA2NDQKLS0tIGEveGVuL3Rlc3QvbGl2ZXBhdGNoL01ha2VmaWxlCisr
KyBiL3hlbi90ZXN0L2xpdmVwYXRjaC9NYWtlZmlsZQpAQCAtMjQsNiArMjQsOSBAQCBMSVZFUEFU
Q0hfUFJFUE9TVF9IT09LUyA6PSB4ZW5fcHJlcG9zdF9ob29rcy5saXZlcGF0Y2gKIExJVkVQQVRD
SF9QUkVQT1NUX0hPT0tTX0ZBSUwgOj0geGVuX3ByZXBvc3RfaG9va3NfZmFpbC5saXZlcGF0Y2gK
IExJVkVQQVRDSF9BQ1RJT05fSE9PS1MgOj0geGVuX2FjdGlvbl9ob29rcy5saXZlcGF0Y2gKIExJ
VkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9GVU5DIDo9IHhlbl9hY3Rpb25faG9va3Nfbm9mdW5jLmxp
dmVwYXRjaAorTElWRVBBVENIX0FDVElPTl9IT09LU19NQVJLRVI6PSB4ZW5fYWN0aW9uX2hvb2tz
X21hcmtlci5saXZlcGF0Y2gKK0xJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9BUFBMWTo9IHhlbl9h
Y3Rpb25faG9va3Nfbm9hcHBseS5saXZlcGF0Y2gKK0xJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9S
RVZFUlQ6PSB4ZW5fYWN0aW9uX2hvb2tzX25vcmV2ZXJ0LmxpdmVwYXRjaAogCiBMSVZFUEFUQ0hF
UyArPSAkKExJVkVQQVRDSCkKIExJVkVQQVRDSEVTICs9ICQoTElWRVBBVENIX0JZRSkKQEAgLTM0
LDYgKzM3LDkgQEAgTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfUFJFUE9TVF9IT09LUykKIExJ
VkVQQVRDSEVTICs9ICQoTElWRVBBVENIX1BSRVBPU1RfSE9PS1NfRkFJTCkKIExJVkVQQVRDSEVT
ICs9ICQoTElWRVBBVENIX0FDVElPTl9IT09LUykKIExJVkVQQVRDSEVTICs9ICQoTElWRVBBVENI
X0FDVElPTl9IT09LU19OT0ZVTkMpCitMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9BQ1RJT05f
SE9PS1NfTUFSS0VSKQorTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05P
QVBQTFkpCitMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9SRVZFUlQp
CiAKIExJVkVQQVRDSF9ERUJVR19ESVIgPz0gJChERUJVR19ESVIpL3hlbi1saXZlcGF0Y2gKIApA
QCAtMTU4LDcgKzE2NCwyNiBAQCAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1MpOiB4ZW5fYWN0aW9u
X2hvb2tzLm8geGVuX2hlbGxvX3dvcmxkX2Z1bmMubyBub3RlLm8geGVuXwogJChMSVZFUEFUQ0hf
QUNUSU9OX0hPT0tTX05PRlVOQyk6IHhlbl9hY3Rpb25faG9va3Nfbm9mdW5jLm8gbm90ZS5vIHhl
bl9ub3RlLm8KIAkkKExEKSAkKExERkxBR1MpICQoYnVpbGRfaWRfbGlua2VyKSAtciAtbyAkKExJ
VkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9GVU5DKSAkXgogCit4ZW5fYWN0aW9uc19ob29rc19tYXJr
ZXIubzogY29uZmlnLmgKKworLlBIT05ZOiAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTUFSS0VS
KQorJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX01BUktFUik6IHhlbl9hY3Rpb25faG9va3NfbWFy
a2VyLm8geGVuX2hlbGxvX3dvcmxkX2Z1bmMubyBub3RlLm8geGVuX25vdGUubworCSQoTEQpICQo
TERGTEFHUykgJChidWlsZF9pZF9saW5rZXIpIC1yIC1vICQoTElWRVBBVENIX0FDVElPTl9IT09L
U19NQVJLRVIpICReCisKK3hlbl9hY3Rpb25zX2hvb2tzX25vYXBwbHkubzogY29uZmlnLmgKKwor
LlBIT05ZOiAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9BUFBMWSkKKyQoTElWRVBBVENIX0FD
VElPTl9IT09LU19OT0FQUExZKTogeGVuX2FjdGlvbl9ob29rc19tYXJrZXIubyB4ZW5faGVsbG9f
d29ybGRfZnVuYy5vIG5vdGUubyB4ZW5fbm90ZS5vCisJJChMRCkgJChMREZMQUdTKSAkKGJ1aWxk
X2lkX2xpbmtlcikgLXIgLW8gJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05PQVBQTFkpICReCisK
K3hlbl9hY3Rpb25zX2hvb2tzX25vcmV2ZXJ0Lm86IGNvbmZpZy5oCisKKy5QSE9OWTogJChMSVZF
UEFUQ0hfQUNUSU9OX0hPT0tTX05PUkVWRVJUKQorJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05P
UkVWRVJUKTogeGVuX2FjdGlvbl9ob29rc19tYXJrZXIubyB4ZW5faGVsbG9fd29ybGRfZnVuYy5v
IG5vdGUubyB4ZW5fbm90ZS5vCisJJChMRCkgJChMREZMQUdTKSAkKGJ1aWxkX2lkX2xpbmtlcikg
LXIgLW8gJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05PUkVWRVJUKSAkXgorCiAuUEhPTlk6IGxp
dmVwYXRjaAogbGl2ZXBhdGNoOiAkKExJVkVQQVRDSCkgJChMSVZFUEFUQ0hfQllFKSAkKExJVkVQ
QVRDSF9SRVBMQUNFKSAkKExJVkVQQVRDSF9OT1ApICQoTElWRVBBVENIX05PX1hFTl9CVUlMRElE
KSBcCiAgICAgICAgICAgICQoTElWRVBBVENIX1BSRVBPU1RfSE9PS1MpICQoTElWRVBBVENIX1BS
RVBPU1RfSE9PS1NfRkFJTCkgJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTKSBcCi0gICAgICAgICAg
ICQoTElWRVBBVENIX0FDVElPTl9IT09LU19OT0ZVTkMpCisgICAgICAgICAgICQoTElWRVBBVENI
X0FDVElPTl9IT09LU19OT0ZVTkMpICQoTElWRVBBVENIX0FDVElPTl9IT09LU19NQVJLRVIpICQo
TElWRVBBVENIX0FDVElPTl9IT09LU19OT0FQUExZKSBcCisgICAgICAgICAgICQoTElWRVBBVENI
X0FDVElPTl9IT09LU19OT1JFVkVSVCkKZGlmZiAtLWdpdCBhL3hlbi90ZXN0L2xpdmVwYXRjaC94
ZW5fYWN0aW9uX2hvb2tzLmMgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rcy5j
CmluZGV4IGE5NDdhZmM0MWYuLjM5YjUzMTMwMjcgMTAwNjQ0Ci0tLSBhL3hlbi90ZXN0L2xpdmVw
YXRjaC94ZW5fYWN0aW9uX2hvb2tzLmMKKysrIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rp
b25faG9va3MuYwpAQCAtMjgsNiArMjgsNyBAQCBzdGF0aWMgaW50IGFwcGx5X2hvb2sobGl2ZXBh
dGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKICAgICB7CiAgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hf
ZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKIAorICAgICAgICBmdW5jLT5hcHBsaWVk
ID0gTElWRVBBVENIX0ZVTkNfQVBQTElFRDsKICAgICAgICAgYXBwbHlfY250Kys7CiAKICAgICAg
ICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBhcHBseWluZzogJXNcbiIsIF9fZnVuY19fLCBmdW5j
LT5uYW1lKTsKQEAgLTQ4LDYgKzQ5LDcgQEAgc3RhdGljIGludCByZXZlcnRfaG9vayhsaXZlcGF0
Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQogICAgIHsKICAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9m
dW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOwogCisgICAgICAgIGZ1bmMtPmFwcGxpZWQg
PSBMSVZFUEFUQ0hfRlVOQ19OT1RfQVBQTElFRDsKICAgICAgICAgcmV2ZXJ0X2NudCsrOwogCiAg
ICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcmV2ZXJ0aW5nOiAlc1xuIiwgX19mdW5jX18s
IGZ1bmMtPm5hbWUpOwpkaWZmIC0tZ2l0IGEveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25f
aG9va3NfbWFya2VyLmMgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19tYXJr
ZXIuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi40ZjgwN2E1NzdmCi0t
LSAvZGV2L251bGwKKysrIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3NfbWFy
a2VyLmMKQEAgLTAsMCArMSwxMTIgQEAKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTkgQW1hem9u
LmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqCisg
Ki8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgPHhlbi9saWIuaD4KKyNpbmNsdWRl
IDx4ZW4vdHlwZXMuaD4KKyNpbmNsdWRlIDx4ZW4vdmVyc2lvbi5oPgorI2luY2x1ZGUgPHhlbi9s
aXZlcGF0Y2guaD4KKyNpbmNsdWRlIDx4ZW4vbGl2ZXBhdGNoX3BheWxvYWQuaD4KKworI2luY2x1
ZGUgPHB1YmxpYy9zeXNjdGwuaD4KKworc3RhdGljIGNvbnN0IGNoYXIgaGVsbG9fd29ybGRfcGF0
Y2hfdGhpc19mbmNbXSA9ICJ4ZW5fZXh0cmFfdmVyc2lvbiI7CitleHRlcm4gY29uc3QgY2hhciAq
eGVuX2hlbGxvX3dvcmxkKHZvaWQpOworCitzdGF0aWMgaW50IHByZV9hcHBseV9ob29rKGxpdmVw
YXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VS
Tl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkg
PSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2
ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09O
KGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50
ayhLRVJOX0RFQlVHICIlczogcHJlIGFwcGxpZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFt
ZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBf
X2Z1bmNfXyk7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgcG9zdF9hcHBseV9o
b29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBw
cmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAg
ICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBz
dHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAg
ICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgIT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAg
ICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcG9zdCBhcHBsaWVkOiAlc1xuIiwgX19mdW5jX18s
IGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBk
b25lLlxuIiwgX19mdW5jX18pOworfQorCitzdGF0aWMgaW50IHByZV9yZXZlcnRfaG9vayhsaXZl
cGF0Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtF
Uk5fREVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChp
ID0gMDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxp
dmVwYXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19P
TihmdW5jLT5hcHBsaWVkICE9IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAgICBwcmlu
dGsoS0VSTl9ERUJVRyAiJXM6IHByZSByZXZlcnRlZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5u
YW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIs
IF9fZnVuY19fKTsKKworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBwb3N0X3JldmVy
dF9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAg
ICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisK
KyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAg
ICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAg
ICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7Cisg
ICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcG9zdCByZXZlcnRlZDogJXNcbiIsIF9fZnVu
Y19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhv
b2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKK30KKworTElWRVBBVENIX1BSRUFQUExZX0hPT0socHJl
X2FwcGx5X2hvb2spOworTElWRVBBVENIX1BPU1RBUFBMWV9IT09LKHBvc3RfYXBwbHlfaG9vayk7
CitMSVZFUEFUQ0hfUFJFUkVWRVJUX0hPT0socHJlX3JldmVydF9ob29rKTsKK0xJVkVQQVRDSF9Q
T1NUUkVWRVJUX0hPT0socG9zdF9yZXZlcnRfaG9vayk7CisKK3N0cnVjdCBsaXZlcGF0Y2hfZnVu
YyBfX3NlY3Rpb24oIi5saXZlcGF0Y2guZnVuY3MiKSBsaXZlcGF0Y2hfeGVuX2hlbGxvX3dvcmxk
ID0geworICAgIC52ZXJzaW9uID0gTElWRVBBVENIX1BBWUxPQURfVkVSU0lPTiwKKyAgICAubmFt
ZSA9IGhlbGxvX3dvcmxkX3BhdGNoX3RoaXNfZm5jLAorICAgIC5uZXdfYWRkciA9IHhlbl9oZWxs
b193b3JsZCwKKyAgICAub2xkX2FkZHIgPSB4ZW5fZXh0cmFfdmVyc2lvbiwKKyAgICAubmV3X3Np
emUgPSBORVdfQ09ERV9TWiwKKyAgICAub2xkX3NpemUgPSBPTERfQ09ERV9TWiwKK307CisKKy8q
CisgKiBMb2NhbCB2YXJpYWJsZXM6CisgKiBtb2RlOiBDCisgKiBjLWZpbGUtc3R5bGU6ICJCU0Qi
CisgKiBjLWJhc2ljLW9mZnNldDogNAorICogdGFiLXdpZHRoOiA0CisgKiBpbmRlbnQtdGFicy1t
b2RlOiBuaWwKKyAqIEVuZDoKKyAqLwpkaWZmIC0tZ2l0IGEveGVuL3Rlc3QvbGl2ZXBhdGNoL3hl
bl9hY3Rpb25faG9va3Nfbm9hcHBseS5jIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25f
aG9va3Nfbm9hcHBseS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAuLjRj
NTVjMTU2YTYKLS0tIC9kZXYvbnVsbAorKysgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlv
bl9ob29rc19ub2FwcGx5LmMKQEAgLTAsMCArMSwxMzYgQEAKKy8qCisgKiBDb3B5cmlnaHQgKGMp
IDIwMTkgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJpZ2h0cyByZXNl
cnZlZC4KKyAqCisgKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgPHhlbi9saWIu
aD4KKyNpbmNsdWRlIDx4ZW4vdHlwZXMuaD4KKyNpbmNsdWRlIDx4ZW4vdmVyc2lvbi5oPgorI2lu
Y2x1ZGUgPHhlbi9saXZlcGF0Y2guaD4KKyNpbmNsdWRlIDx4ZW4vbGl2ZXBhdGNoX3BheWxvYWQu
aD4KKworI2luY2x1ZGUgPHB1YmxpYy9zeXNjdGwuaD4KKworc3RhdGljIGNvbnN0IGNoYXIgaGVs
bG9fd29ybGRfcGF0Y2hfdGhpc19mbmNbXSA9ICJ4ZW5fZXh0cmFfdmVyc2lvbiI7CitleHRlcm4g
Y29uc3QgY2hhciAqeGVuX2hlbGxvX3dvcmxkKHZvaWQpOworCitzdGF0aWMgdW5zaWduZWQgaW50
IGFwcGx5X2NudDsKKworc3RhdGljIGludCBwcmVfYXBwbHlfaG9vayhsaXZlcGF0Y2hfcGF5bG9h
ZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVz
OiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8IHBh
eWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5j
ICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19PTihmdW5jLT5hcHBs
aWVkID09IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAgICBwcmludGsoS0VSTl9ERUJV
RyAiJXM6IHByZSBhcHBsaWVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0K
KworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOwor
CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgYXBwbHlfaG9vayhsaXZlcGF0Y2hfcGF5
bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcg
IiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8
IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9m
dW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIGFwcGx5X2NudCsrOwor
ICAgICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IGFwcGx5aW5nOiAlc1xuIiwgX19mdW5jX18s
IGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBk
b25lLlxuIiwgX19mdW5jX18pOworCisgICAgcmV0dXJuIC1FSU5WQUw7IC8qIE1hcmsgYWN0aW9u
IGFzIGluY29uc2lzdGVudCAqLworfQorCitzdGF0aWMgdm9pZCBwb3N0X2FwcGx5X2hvb2sobGl2
ZXBhdGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhL
RVJOX0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAo
aSA9IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBs
aXZlcGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdf
T04oYXBwbHlfY250ICE9IDEpOworICAgICAgICBCVUdfT04oZnVuYy0+YXBwbGllZCA9PSBMSVZF
UEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBwb3N0
IGFwcGxpZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJp
bnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1bmNfXyk7Cit9CisKK3N0YXRp
YyBpbnQgcHJlX3JldmVydF9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7Cisg
ICAgaW50IGk7CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4i
LCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKysp
CisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+
ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZV
TkNfQVBQTElFRCk7CisgICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcHJlIHJldmVydGVk
OiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJO
X0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOworCisgICAgcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyB2b2lkIHBvc3RfcmV2ZXJ0X2hvb2sobGl2ZXBhdGNoX3BheWxvYWRfdCAqcGF5
bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBz
dGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9IDA7IGkgPCBwYXlsb2FkLT5u
ZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAqZnVuYyA9
ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04oZnVuYy0+YXBwbGllZCA9PSBM
SVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBw
b3N0IHJldmVydGVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0KKworICAg
IHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOworfQorCitM
SVZFUEFUQ0hfQVBQTFlfSE9PSyhhcHBseV9ob29rKTsKKworTElWRVBBVENIX1BSRUFQUExZX0hP
T0socHJlX2FwcGx5X2hvb2spOworTElWRVBBVENIX1BPU1RBUFBMWV9IT09LKHBvc3RfYXBwbHlf
aG9vayk7CitMSVZFUEFUQ0hfUFJFUkVWRVJUX0hPT0socHJlX3JldmVydF9ob29rKTsKK0xJVkVQ
QVRDSF9QT1NUUkVWRVJUX0hPT0socG9zdF9yZXZlcnRfaG9vayk7CisKK3N0cnVjdCBsaXZlcGF0
Y2hfZnVuYyBfX3NlY3Rpb24oIi5saXZlcGF0Y2guZnVuY3MiKSBsaXZlcGF0Y2hfeGVuX2hlbGxv
X3dvcmxkID0geworICAgIC52ZXJzaW9uID0gTElWRVBBVENIX1BBWUxPQURfVkVSU0lPTiwKKyAg
ICAubmFtZSA9IGhlbGxvX3dvcmxkX3BhdGNoX3RoaXNfZm5jLAorICAgIC5uZXdfYWRkciA9IHhl
bl9oZWxsb193b3JsZCwKKyAgICAub2xkX2FkZHIgPSB4ZW5fZXh0cmFfdmVyc2lvbiwKKyAgICAu
bmV3X3NpemUgPSBORVdfQ09ERV9TWiwKKyAgICAub2xkX3NpemUgPSBPTERfQ09ERV9TWiwKK307
CisKKy8qCisgKiBMb2NhbCB2YXJpYWJsZXM6CisgKiBtb2RlOiBDCisgKiBjLWZpbGUtc3R5bGU6
ICJCU0QiCisgKiBjLWJhc2ljLW9mZnNldDogNAorICogdGFiLXdpZHRoOiA0CisgKiBpbmRlbnQt
dGFicy1tb2RlOiBuaWwKKyAqIEVuZDoKKyAqLwpkaWZmIC0tZ2l0IGEveGVuL3Rlc3QvbGl2ZXBh
dGNoL3hlbl9hY3Rpb25faG9va3Nfbm9yZXZlcnQuYyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5f
YWN0aW9uX2hvb2tzX25vcmV2ZXJ0LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMC4uZWY3N2U3MjA3MQotLS0gL2Rldi9udWxsCisrKyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94
ZW5fYWN0aW9uX2hvb2tzX25vcmV2ZXJ0LmMKQEAgLTAsMCArMSwxNDMgQEAKKy8qCisgKiBDb3B5
cmlnaHQgKGMpIDIwMTkgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIHJp
Z2h0cyByZXNlcnZlZC4KKyAqCisgKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUg
PHhlbi9saWIuaD4KKyNpbmNsdWRlIDx4ZW4vdHlwZXMuaD4KKyNpbmNsdWRlIDx4ZW4vdmVyc2lv
bi5oPgorI2luY2x1ZGUgPHhlbi9saXZlcGF0Y2guaD4KKyNpbmNsdWRlIDx4ZW4vbGl2ZXBhdGNo
X3BheWxvYWQuaD4KKworI2luY2x1ZGUgPHB1YmxpYy9zeXNjdGwuaD4KKworc3RhdGljIGNvbnN0
IGNoYXIgaGVsbG9fd29ybGRfcGF0Y2hfdGhpc19mbmNbXSA9ICJ4ZW5fZXh0cmFfdmVyc2lvbiI7
CitleHRlcm4gY29uc3QgY2hhciAqeGVuX2hlbGxvX3dvcmxkKHZvaWQpOworCitzdGF0aWMgdW5z
aWduZWQgaW50IHJldmVydF9jbnQ7CisKK3N0YXRpYyBpbnQgcHJlX2FwcGx5X2hvb2sobGl2ZXBh
dGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJO
X0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9
IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZl
cGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04o
ZnVuYy0+YXBwbGllZCA9PSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRr
KEtFUk5fREVCVUcgIiVzOiBwcmUgYXBwbGllZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1l
KTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9f
ZnVuY19fKTsKKworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBwb3N0X2FwcGx5X2hv
b2sobGl2ZXBhdGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHBy
aW50ayhLRVJOX0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAg
IGZvciAoaSA9IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0
cnVjdCBsaXZlcGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAg
ICBCVUdfT04oZnVuYy0+YXBwbGllZCAhPSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAg
ICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBwb3N0IGFwcGxpZWQ6ICVzXG4iLCBfX2Z1bmNfXywg
ZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRv
bmUuXG4iLCBfX2Z1bmNfXyk7Cit9CisKK3N0YXRpYyBpbnQgcHJlX3JldmVydF9ob29rKGxpdmVw
YXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VS
Tl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkg
PSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2
ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09O
KGZ1bmMtPmFwcGxpZWQgIT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50
ayhLRVJOX0RFQlVHICIlczogcHJlIHJldmVydGVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5h
bWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwg
X19mdW5jX18pOworCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcmV2ZXJ0X2hvb2so
bGl2ZXBhdGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50
ayhLRVJOX0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZv
ciAoaSA9IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVj
dCBsaXZlcGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBy
ZXZlcnRfY250Kys7CisgICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcmV2ZXJ0aW5nOiAl
c1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RF
QlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOworCisgICAgcmV0dXJuIC1FSU5WQUw7
IC8qIE1hcmsgYWN0aW9uIGFzIGluY29uc2lzdGVudCAqLworfQorCitzdGF0aWMgdm9pZCBwb3N0
X3JldmVydF9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7
CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNf
Xyk7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgewor
ICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07
CisKKyAgICAgICAgQlVHX09OKHJldmVydF9jbnQgIT0gMSk7CisgICAgICAgIEJVR19PTihmdW5j
LT5hcHBsaWVkICE9IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworCisgICAgICAgIC8qIE91dHNp
ZGUgb2YgcXVpZXNjZSB6b25lOiBNQVkgVFJJR0dFUiBIT1NUIENSQVNIL1VOREVGSU5FRCBCRUhB
VklPUiAqLworICAgICAgICBhcmNoX2xpdmVwYXRjaF9xdWllc2NlKCk7CisgICAgICAgIGNvbW1v
bl9saXZlcGF0Y2hfcmV2ZXJ0KHBheWxvYWQpOworICAgICAgICBhcmNoX2xpdmVwYXRjaF9yZXZp
dmUoKTsKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNfQVBQ
TElFRCk7CisKKyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBwb3N0IHJldmVydGVkOiAl
c1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RF
QlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOworfQorCitMSVZFUEFUQ0hfQVBQTFlf
SE9PSyhyZXZlcnRfaG9vayk7CisKK0xJVkVQQVRDSF9QUkVBUFBMWV9IT09LKHByZV9hcHBseV9o
b29rKTsKK0xJVkVQQVRDSF9QT1NUQVBQTFlfSE9PSyhwb3N0X2FwcGx5X2hvb2spOworTElWRVBB
VENIX1BSRVJFVkVSVF9IT09LKHByZV9yZXZlcnRfaG9vayk7CitMSVZFUEFUQ0hfUE9TVFJFVkVS
VF9IT09LKHBvc3RfcmV2ZXJ0X2hvb2spOworCitzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgX19zZWN0
aW9uKCIubGl2ZXBhdGNoLmZ1bmNzIikgbGl2ZXBhdGNoX3hlbl9oZWxsb193b3JsZCA9IHsKKyAg
ICAudmVyc2lvbiA9IExJVkVQQVRDSF9QQVlMT0FEX1ZFUlNJT04sCisgICAgLm5hbWUgPSBoZWxs
b193b3JsZF9wYXRjaF90aGlzX2ZuYywKKyAgICAubmV3X2FkZHIgPSB4ZW5faGVsbG9fd29ybGQs
CisgICAgLm9sZF9hZGRyID0geGVuX2V4dHJhX3ZlcnNpb24sCisgICAgLm5ld19zaXplID0gTkVX
X0NPREVfU1osCisgICAgLm9sZF9zaXplID0gT0xEX0NPREVfU1osCit9OworCisvKgorICogTG9j
YWwgdmFyaWFibGVzOgorICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAiQlNEIgorICogYy1i
YXNpYy1vZmZzZXQ6IDQKKyAqIHRhYi13aWR0aDogNAorICogaW5kZW50LXRhYnMtbW9kZTogbmls
CisgKiBFbmQ6CisgKi8KLS0gCjIuMTYuNQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBH
ZXJtYW55IEdtYkgKS3JhdXNlbnN0ci4gMzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVu
ZzogQ2hyaXN0aWFuIFNjaGxhZWdlciwgUmFsZiBIZXJicmljaApFaW5nZXRyYWdlbiBhbSBBbXRz
Z2VyaWNodCBDaGFybG90dGVuYnVyZyB1bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVz
dC1JRDogREUgMjg5IDIzNyA4NzkKCgoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhl
bnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5m
by94ZW4tZGV2ZWw=

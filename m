Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 385E9649EB
	for <lists+xen-devel@lfdr.de>; Wed, 10 Jul 2019 17:44:03 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hlEi9-0006EP-7D; Wed, 10 Jul 2019 15:40:49 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=ELaq=VH=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1hlEi7-0006EK-Hz
 for xen-devel@lists.xenproject.org; Wed, 10 Jul 2019 15:40:47 +0000
X-Inumbo-ID: 157e4f7f-a329-11e9-8980-bc764e045a96
Received: from foss.arm.com (unknown [217.140.110.172])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTP
 id 157e4f7f-a329-11e9-8980-bc764e045a96;
 Wed, 10 Jul 2019 15:40:46 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 05E722B;
 Wed, 10 Jul 2019 08:40:46 -0700 (PDT)
Received: from [10.119.48.95] (unknown [10.119.48.95])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id AF0F33F246;
 Wed, 10 Jul 2019 08:40:45 -0700 (PDT)
To: Stefano Stabellini <sstabellini@kernel.org>, xen-devel@lists.xenproject.org
References: <alpine.DEB.2.21.1906211648280.25730@sstabellini-ThinkPad-T480s>
 <20190621235608.2153-3-sstabellini@kernel.org>
From: Julien Grall <julien.grall@arm.com>
Message-ID: <14057093-654b-7668-104b-a452eb2bf6be@arm.com>
Date: Wed, 10 Jul 2019 16:40:45 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190621235608.2153-3-sstabellini@kernel.org>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v3 3/6] xen/arm: keep track of
 reserved-memory regions
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SGksCgpPbiA2LzIyLzE5IDEyOjU2IEFNLCBTdGVmYW5vIFN0YWJlbGxpbmkgd3JvdGU6Cj4gQXMg
d2UgcGFyc2UgdGhlIGRldmljZSB0cmVlIGluIFhlbiwga2VlcCB0cmFjayBvZiB0aGUgcmVzZXJ2
ZWQtbWVtb3J5Cj4gcmVnaW9ucyBhcyB0aGV5IG5lZWQgc3BlY2lhbCB0cmVhdG1lbnQgKGZvbGxv
dy11cCBwYXRjaGVzIHdpbGwgbWFrZSB1c2UKPiBvZiB0aGUgc3RvcmVkIGluZm9ybWF0aW9uLikK
PiAKPiBSZXVzZSBwcm9jZXNzX21lbW9yeV9ub2RlIHRvIGFkZCByZXNlcnZlZC1tZW1vcnkgcmVn
aW9ucyB0byB0aGUKPiBib290aW5mby5yZXNlcnZlZF9tZW0gYXJyYXkuCj4gCj4gUmVmdXNlIHRv
IGNvbnRpbnVlIG9uY2Ugd2UgcmVhY2ggdGhlIG1heCBudW1iZXIgb2YgcmVzZXJ2ZWQgbWVtb3J5
Cj4gcmVnaW9ucyB0byBhdm9pZCBhY2NpZGVudGFsbHkgbWFwcGluZyBhbnkgcG9ydGlvbnMgb2Yg
dGhlbSBpbnRvIGEgVk0uCj4gCj4gU2lnbmVkLW9mZi1ieTogU3RlZmFubyBTdGFiZWxsaW5pIDxz
dGVmYW5vc0B4aWxpbnguY29tPgo+IAo+IC0tLQo+IEl0IGlzIGNsZWFuZXIgdG8gYXZvaWQgc2hh
cmluZyB0aGUgd2hvbGUgZnVuY3Rpb24gcHJvY2Vzc19tZW1vcnlfbm9kZQo+IGJldHdlZW4gdGhl
IG5vcm1hbCBtZW1vcnkgY2FzZSBhbmQgdGhlIHJlc2VydmVkLW1lbW9yeSBjYXNlLiBJJ2xsIGRv
IGl0Cj4gaW4gdGhlIG5leHQgdmVyc2lvbiBvbmNlIEkgdW5kZXJzdGFuZCB0aGUgYmVzdCB3YXkg
ZG8gdG8gaXQuCgpwYXJzZV9yZWcoLi4uLikKewoKaWYgKHJlZyBub3QgcHJlc2VudCkKICAgcmV0
dXJuIC1FTk9QUkVTRU5UCgovKiBwYXJzZSByZWdzICovCgpyZXR1cm4gKGZ1bGwpID8gLUVGVUxM
IDogMDsKfQoKcHJvY2Vzc19tZW1vcnlfbm9kZSguLi4uKQp7CiAgICByZXR1cm4gcGFyc2VfcmVn
KC4uLik7Cn0KCnByb2Nlc3NfcmVzZXJ2ZWRfcmVnaW9uKCkKewogICAgIHJldCA9IHBhcnNlX3Jl
ZyguLi4pOwogICAgIGlmICggcmV0ID09IC1FRlVMTCApCiAgICAgICBwYW5pYyguLi4uKTsKICAg
ICBlbHNlIGlmICggcmV0ICE9IC1FTk9QUkVTRU5UICkKICAgICAgIHJldHVybiByZXQ7CiAgICAg
cmV0dXJuIDA7Cn0KCj4gCj4gLS0tCj4gQ2hhbmdlcyBpbiB2MzoKPiAtIG1hdGNoIG9ubHkgL3Jl
c2VydmVkLW1lbW9yeQo+IC0gcHV0IHRoZSB3YXJuaW5nIGJhY2sgaW4gcGxhY2UgZm9yIHJlZyBu
b3QgcHJlc2VudCBvbiBhIG5vcm1hbCBtZW1vcnkKPiAgICByZWdpb24KPiAtIHJlZnVzZSB0byBj
b250aW51ZSBvbmNlIHdlIHJlYWNoIHRoZSBtYXggbnVtYmVyIG9mIHJlc2VydmVkIG1lbW9yeQo+
ICAgIHJlZ2lvbnMKPiAKPiBDaGFuZ2VzIGluIHYyOgo+IC0gY2FsbCBwcm9jZXNzX21lbW9yeV9u
b2RlIGZyb20gcHJvY2Vzc19yZXNlcnZlZF9tZW1vcnlfbm9kZSB0byBhdm9pZAo+ICAgIGR1cGxp
Y2F0aW9uCj4gLS0tCj4gICB4ZW4vYXJjaC9hcm0vYm9vdGZkdC5jICAgICAgfCAzOCArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tCj4gICB4ZW4vaW5jbHVkZS9hc20tYXJtL3Nl
dHVwLmggfCAgMSArCj4gICAyIGZpbGVzIGNoYW5nZWQsIDMzIGluc2VydGlvbnMoKyksIDYgZGVs
ZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9ib290ZmR0LmMgYi94ZW4v
YXJjaC9hcm0vYm9vdGZkdC5jCj4gaW5kZXggNjExNzI0NDMzYi4uYjI0YWIxMGNiOSAxMDA2NDQK
PiAtLS0gYS94ZW4vYXJjaC9hcm0vYm9vdGZkdC5jCj4gKysrIGIveGVuL2FyY2gvYXJtL2Jvb3Rm
ZHQuYwo+IEBAIC0xMzUsNiArMTM1LDggQEAgc3RhdGljIGludCBfX2luaXQgcHJvY2Vzc19tZW1v
cnlfbm9kZShjb25zdCB2b2lkICpmZHQsIGludCBub2RlLAo+ICAgICAgIGNvbnN0IF9fYmUzMiAq
Y2VsbDsKPiAgICAgICBwYWRkcl90IHN0YXJ0LCBzaXplOwo+ICAgICAgIHUzMiByZWdfY2VsbHMg
PSBhZGRyZXNzX2NlbGxzICsgc2l6ZV9jZWxsczsKPiArICAgIHN0cnVjdCBtZW1pbmZvICptZW07
Cj4gKyAgICBib29sIHJlc2VydmVkID0gKGJvb2wpZGF0YTsKPiAgIAo+ICAgICAgIGlmICggYWRk
cmVzc19jZWxscyA8IDEgfHwgc2l6ZV9jZWxscyA8IDEgKQo+ICAgICAgIHsKPiBAQCAtMTQzLDI5
ICsxNDUsNDkgQEAgc3RhdGljIGludCBfX2luaXQgcHJvY2Vzc19tZW1vcnlfbm9kZShjb25zdCB2
b2lkICpmZHQsIGludCBub2RlLAo+ICAgICAgICAgICByZXR1cm4gMDsKPiAgICAgICB9Cj4gICAK
PiArICAgIGlmICggcmVzZXJ2ZWQgKQo+ICsgICAgICAgIG1lbSA9ICZib290aW5mby5yZXNlcnZl
ZF9tZW07Cj4gKyAgICBlbHNlCj4gKyAgICAgICAgbWVtID0gJmJvb3RpbmZvLm1lbTsKClJhdGhl
ciB0aGFuIHBhc3NpbmcgYSBib29sLCB5b3UgY291bGQgcGFzcyBib290aW5mby57bWVtLCByZXNl
cnZlZF9tZW19IAppbiBwYXJhbWV0ZXIuCgo+ICsKPiAgICAgICBwcm9wID0gZmR0X2dldF9wcm9w
ZXJ0eShmZHQsIG5vZGUsICJyZWciLCBOVUxMKTsKPiAgICAgICBpZiAoICFwcm9wICkKPiAgICAg
ICB7Cj4gLSAgICAgICAgcHJpbnRrKCJmZHQ6IG5vZGUgYCVzJzogbWlzc2luZyBgcmVnJyBwcm9w
ZXJ0eVxuIiwgbmFtZSk7Cj4gKyAgICAgICAgaWYgKCAhcmVzZXJ2ZWQgKQo+ICsgICAgICAgICAg
ICBwcmludGsoImZkdDogbm9kZSBgJXMnOiBtaXNzaW5nIGByZWcnIHByb3BlcnR5XG4iLCBuYW1l
KTsKCkkgd291bGQganVzdCBnZXQgcmlkIG9mIHRoaXMgcHJpbnQgYW5kIHJldHVybiBhbiBlcnJv
ciB0aGFuIGFsbG93IHRoZSAKY2FsbGVyIHRvIGRlY2lkZSB3aGF0IHRvIGRvLgoKPiAgICAgICAg
ICAgcmV0dXJuIDA7Cj4gICAgICAgfQo+ICAgCj4gICAgICAgY2VsbCA9IChjb25zdCBfX2JlMzIg
Kilwcm9wLT5kYXRhOwo+ICAgICAgIGJhbmtzID0gZmR0MzJfdG9fY3B1KHByb3AtPmxlbikgLyAo
cmVnX2NlbGxzICogc2l6ZW9mICh1MzIpKTsKPiAgIAo+IC0gICAgZm9yICggaSA9IDA7IGkgPCBi
YW5rcyAmJiBib290aW5mby5tZW0ubnJfYmFua3MgPCBOUl9NRU1fQkFOS1M7IGkrKyApCj4gKyAg
ICBmb3IgKCBpID0gMDsgaSA8IGJhbmtzICYmIG1lbS0+bnJfYmFua3MgPCBOUl9NRU1fQkFOS1M7
IGkrKyApCj4gICAgICAgewo+ICAgICAgICAgICBkZXZpY2VfdHJlZV9nZXRfcmVnKCZjZWxsLCBh
ZGRyZXNzX2NlbGxzLCBzaXplX2NlbGxzLCAmc3RhcnQsICZzaXplKTsKPiAgICAgICAgICAgaWYg
KCAhc2l6ZSApCj4gICAgICAgICAgICAgICBjb250aW51ZTsKPiAtICAgICAgICBib290aW5mby5t
ZW0uYmFua1tib290aW5mby5tZW0ubnJfYmFua3NdLnN0YXJ0ID0gc3RhcnQ7Cj4gLSAgICAgICAg
Ym9vdGluZm8ubWVtLmJhbmtbYm9vdGluZm8ubWVtLm5yX2JhbmtzXS5zaXplID0gc2l6ZTsKPiAt
ICAgICAgICBib290aW5mby5tZW0ubnJfYmFua3MrKzsKPiArICAgICAgICBtZW0tPmJhbmtbbWVt
LT5ucl9iYW5rc10uc3RhcnQgPSBzdGFydDsKPiArICAgICAgICBtZW0tPmJhbmtbbWVtLT5ucl9i
YW5rc10uc2l6ZSA9IHNpemU7Cj4gKyAgICAgICAgbWVtLT5ucl9iYW5rcysrOwo+ICAgICAgIH0K
PiArICAgIC8qCj4gKyAgICAgKiBXZSByZWFjaGVkIHRoZSBtYXggbnVtYmVyIG9mIHN1cHBvcnRl
ZCByZXNlcnZlZC1tZW1vcnkgcmVnaW9ucy4KPiArICAgICAqIFN0b3AgYW5kIHJlZnVzZSB0byBj
b250aW51ZS4gV2UgZG9uJ3Qgd2FudCB0byByaXNrIFhlbiBhbGxvY2F0aW5nCj4gKyAgICAgKiB0
aG9zZSByZWdpb25zIGFzIG5vcm1hbCBtZW1vcnkgdG8gYSBWTS4KClRoZSBsYXN0IHNlbnRlbmNl
IGlzIGNvbmZ1c2luZyBiZWNhdXNlIHJlc2VydmVkLXJlZ2lvbiBhcmUgbm9ybWFsIG1lbW9yeSAK
dGhhdCBoYXZlIGJlZW4gY2FydmVkIG91dCBmb3IgYSBzcGVjaWZpYyB1c2FnZS4gQWxzbywgdGhl
IHByb2JsZW0gaXMgbm90IApvbmx5IHdpdGggVk0gYnV0IGFueSBtZW1vcnkgYWxsb2NhdGlvbi4K
ClNvIGEgYmV0dGVyIHNlbnRlbmNlIHdvdWxkIGJlOiAiV2UgZG9uJ3Qgd2FudCB0byBnaXZlIHRo
ZSBwYWdlcyB0byB0aGUgCmFsbG9jYXRvciIuCgo+ICsgICAgICovCj4gKyAgICBCVUdfT04ocmVz
ZXJ2ZWQgJiYgbWVtLT5ucl9iYW5rcyA9PSBOUl9NRU1fQkFOS1MpOwo+ICAgCj4gICAgICAgcmV0
dXJuIDA7Cj4gICB9Cj4gICAKPiArc3RhdGljIGludCBfX2luaXQgcHJvY2Vzc19yZXNlcnZlZF9t
ZW1vcnlfbm9kZShjb25zdCB2b2lkICpmZHQsIGludCBub2RlLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIGludCBkZXB0
aCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIg
YWRkcmVzc19jZWxscywgdTMyIHNpemVfY2VsbHMpCj4gK3sKPiArICAgIGRldmljZV90cmVlX2Zv
cl9lYWNoX25vZGUoZmR0LCBub2RlLCBkZXB0aCwgcHJvY2Vzc19tZW1vcnlfbm9kZSwgKHZvaWQq
KXRydWUpOwo+ICsgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gICBzdGF0aWMgdm9pZCBfX2luaXQg
cHJvY2Vzc19tdWx0aWJvb3Rfbm9kZShjb25zdCB2b2lkICpmZHQsIGludCBub2RlLAo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqbmFtZSwK
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBhZGRyZXNz
X2NlbGxzLCB1MzIgc2l6ZV9jZWxscykKPiBAQCAtMjk5LDcgKzMyMSwxMSBAQCBzdGF0aWMgaW50
IF9faW5pdCBlYXJseV9zY2FuX25vZGUoY29uc3Qgdm9pZCAqZmR0LAo+ICAgCj4gICAgICAgaWYg
KCBkZXZpY2VfdHJlZV9ub2RlX21hdGNoZXMoZmR0LCBub2RlLCAibWVtb3J5IikgKQo+ICAgICAg
ICAgICByYyA9IHByb2Nlc3NfbWVtb3J5X25vZGUoZmR0LCBub2RlLCBuYW1lLCBkZXB0aCwKPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzc19jZWxscywgc2l6ZV9jZWxs
cywgTlVMTCk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3NfY2Vs
bHMsIHNpemVfY2VsbHMsICh2b2lkKilmYWxzZSk7Cj4gKyAgICBlbHNlIGlmICggZGVwdGggPT0g
MSAmJiAhc3RyY21wKG5hbWUsICJyZXNlcnZlZC1tZW1vcnkiKSAmJgo+ICsgICAgICAgICAgICAg
IHN0cmxlbihuYW1lKSA9PSBzdHJsZW4oInJlc2VydmVkLW1lbW9yeSIpICkKPiArICAgICAgICBy
YyA9IHByb2Nlc3NfcmVzZXJ2ZWRfbWVtb3J5X25vZGUoZmR0LCBub2RlLCBuYW1lLCBkZXB0aCwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzc19jZWxs
cywgc2l6ZV9jZWxscyk7Cj4gICAgICAgZWxzZSBpZiAoIGRlcHRoIDw9IDMgJiYgKGRldmljZV90
cmVlX25vZGVfY29tcGF0aWJsZShmZHQsIG5vZGUsICJ4ZW4sbXVsdGlib290LW1vZHVsZSIgKSB8
fAo+ICAgICAgICAgICAgICAgICBkZXZpY2VfdHJlZV9ub2RlX2NvbXBhdGlibGUoZmR0LCBub2Rl
LCAibXVsdGlib290LG1vZHVsZSIgKSkpCj4gICAgICAgICAgIHByb2Nlc3NfbXVsdGlib290X25v
ZGUoZmR0LCBub2RlLCBuYW1lLCBhZGRyZXNzX2NlbGxzLCBzaXplX2NlbGxzKTsKPiBkaWZmIC0t
Z2l0IGEveGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5oIGIveGVuL2luY2x1ZGUvYXNtLWFybS9z
ZXR1cC5oCj4gaW5kZXggOGJmM2Q1OTEwYS4uZWZjYmE1NDVjMiAxMDA2NDQKPiAtLS0gYS94ZW4v
aW5jbHVkZS9hc20tYXJtL3NldHVwLmgKPiArKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL3NldHVw
LmgKPiBAQCAtNjYsNiArNjYsNyBAQCBzdHJ1Y3QgYm9vdGNtZGxpbmVzIHsKPiAgIAo+ICAgc3Ry
dWN0IGJvb3RpbmZvIHsKPiAgICAgICBzdHJ1Y3QgbWVtaW5mbyBtZW07Cj4gKyAgICBzdHJ1Y3Qg
bWVtaW5mbyByZXNlcnZlZF9tZW07Cj4gICAgICAgc3RydWN0IGJvb3Rtb2R1bGVzIG1vZHVsZXM7
Cj4gICAgICAgc3RydWN0IGJvb3RjbWRsaW5lcyBjbWRsaW5lczsKPiAgICNpZmRlZiBDT05GSUdf
QUNQSQo+IAoKQ2hlZXJzLAoKLS0gCkp1bGllbiBHcmFsbAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2
ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWls
bWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

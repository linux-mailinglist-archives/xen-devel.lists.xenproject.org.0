Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8948483CF6
	for <lists+xen-devel@lfdr.de>; Tue,  6 Aug 2019 23:52:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hv7Km-0000pW-68; Tue, 06 Aug 2019 21:49:32 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=/mMd=WC=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1hv7Kj-0000mr-Rc
 for xen-devel@lists.xenproject.org; Tue, 06 Aug 2019 21:49:29 +0000
X-Inumbo-ID: 1034bbe4-b894-11e9-8980-bc764e045a96
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 1034bbe4-b894-11e9-8980-bc764e045a96;
 Tue, 06 Aug 2019 21:49:28 +0000 (UTC)
Received: from sstabellini-ThinkPad-T480s.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 60CE7218A3;
 Tue,  6 Aug 2019 21:49:27 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1565128167;
 bh=RIE5Uq+VwgKOb50xrFjwCHCwzeOyLzPyzUh00upXqkc=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=M0mivJxuutZ2YZyw+6cn/gY+MIob/TWGr2J/oGoYM/tTdD3K/ahoO92QiVhhfFexV
 1cxZbT+uT3epatqKD+DSMaranZcmxU/GmNow1ubye53QYt8WCX3tms1kyVefutKW1Q
 KDlN3/LHN1Cy9Z4xfedIVtR76AuSPB0FP3v+saeo=
From: Stefano Stabellini <sstabellini@kernel.org>
To: xen-devel@lists.xenproject.org
Date: Tue,  6 Aug 2019 14:49:21 -0700
Message-Id: <20190806214925.7534-3-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1908061428420.2451@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1908061428420.2451@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v4 3/7] xen/arm: keep track of reserved-memory
 regions
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, julien.grall@arm.com,
 sstabellini@kernel.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QXMgd2UgcGFyc2UgdGhlIGRldmljZSB0cmVlIGluIFhlbiwga2VlcCB0cmFjayBvZiB0aGUgcmVz
ZXJ2ZWQtbWVtb3J5CnJlZ2lvbnMgYXMgdGhleSBuZWVkIHNwZWNpYWwgdHJlYXRtZW50IChmb2xs
b3ctdXAgcGF0Y2hlcyB3aWxsIG1ha2UgdXNlCm9mIHRoZSBzdG9yZWQgaW5mb3JtYXRpb24uKQoK
UmV1c2UgcHJvY2Vzc19tZW1vcnlfbm9kZSB0byBhZGQgcmVzZXJ2ZWQtbWVtb3J5IHJlZ2lvbnMg
dG8gdGhlCmJvb3RpbmZvLnJlc2VydmVkX21lbSBhcnJheS4KClJlZnVzZSB0byBjb250aW51ZSBv
bmNlIHdlIHJlYWNoIHRoZSBtYXggbnVtYmVyIG9mIHJlc2VydmVkIG1lbW9yeQpyZWdpb25zIHRv
IGF2b2lkIGFjY2lkZW50YWxseSBtYXBwaW5nIGFueSBwb3J0aW9ucyBvZiB0aGVtIGludG8gYSBW
TS4KClNpZ25lZC1vZmYtYnk6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3RlZmFub3NAeGlsaW54LmNv
bT4KCi0tLQpDaGFuZ2VzIGluIHY0OgotIGRlcHRoICsgMSBpbiBwcm9jZXNzX3Jlc2VydmVkX21l
bW9yeV9ub2RlCi0gcGFzcyBhZGRyZXNzX2NlbGxzIGFuZCBzaXplX2NlbGxzIHRvIGRldmljZV90
cmVlX2Zvcl9lYWNoX25vZGUKLSBwYXNzIHN0cnVjdCBtZW1pbmZvICogaW5zdGVhZCBvZiBhIGJv
b2xlYW4gdG8gcHJvY2Vzc19tZW1vcnlfbm9kZQotIGltcHJvdmUgaW4tY29kZSBjb21tZW50Ci0g
dXNlIGEgc2VwYXJhdGUgcHJvY2Vzc19yZXNlcnZlZF9tZW1vcnlfbm9kZSAoc2VwYXJhdGUgZnJv
bQogIHByb2Nlc3NfbWVtb3J5X25vZGUpIGZ1bmN0aW9uIHdyYXBwZXIgdG8gaGF2ZSBkaWZmZXJl
bnQgZXJyb3IgaGFuZGxpbmcKCkNoYW5nZXMgaW4gdjM6Ci0gbWF0Y2ggb25seSAvcmVzZXJ2ZWQt
bWVtb3J5Ci0gcHV0IHRoZSB3YXJuaW5nIGJhY2sgaW4gcGxhY2UgZm9yIHJlZyBub3QgcHJlc2Vu
dCBvbiBhIG5vcm1hbCBtZW1vcnkKICByZWdpb24KLSByZWZ1c2UgdG8gY29udGludWUgb25jZSB3
ZSByZWFjaCB0aGUgbWF4IG51bWJlciBvZiByZXNlcnZlZCBtZW1vcnkKICByZWdpb25zCgpDaGFu
Z2VzIGluIHYyOgotIGNhbGwgcHJvY2Vzc19tZW1vcnlfbm9kZSBmcm9tIHByb2Nlc3NfcmVzZXJ2
ZWRfbWVtb3J5X25vZGUgdG8gYXZvaWQKICBkdXBsaWNhdGlvbgotLS0KIHhlbi9hcmNoL2FybS9i
b290ZmR0LmMgICAgICB8IDQzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0K
IHhlbi9pbmNsdWRlL2FzbS1hcm0vc2V0dXAuaCB8ICAxICsKIDIgZmlsZXMgY2hhbmdlZCwgMzgg
aW5zZXJ0aW9ucygrKSwgNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0v
Ym9vdGZkdC5jIGIveGVuL2FyY2gvYXJtL2Jvb3RmZHQuYwppbmRleCBjMjJkNTdjZDcyLi4zZTZm
ZDYzYjE2IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vYm9vdGZkdC5jCisrKyBiL3hlbi9hcmNo
L2FybS9ib290ZmR0LmMKQEAgLTE0NCw2ICsxNDQsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBwcm9j
ZXNzX21lbW9yeV9ub2RlKGNvbnN0IHZvaWQgKmZkdCwgaW50IG5vZGUsCiAgICAgY29uc3QgX19i
ZTMyICpjZWxsOwogICAgIHBhZGRyX3Qgc3RhcnQsIHNpemU7CiAgICAgdTMyIHJlZ19jZWxscyA9
IGFkZHJlc3NfY2VsbHMgKyBzaXplX2NlbGxzOworICAgIHN0cnVjdCBtZW1pbmZvICptZW0gPSAo
c3RydWN0IG1lbWluZm8gKilkYXRhOwogCiAgICAgaWYgKCBhZGRyZXNzX2NlbGxzIDwgMSB8fCBz
aXplX2NlbGxzIDwgMSApCiAgICAgewpAQCAtMTU5LDIxICsxNjAsNDcgQEAgc3RhdGljIGludCBf
X2luaXQgcHJvY2Vzc19tZW1vcnlfbm9kZShjb25zdCB2b2lkICpmZHQsIGludCBub2RlLAogICAg
IGNlbGwgPSAoY29uc3QgX19iZTMyICopcHJvcC0+ZGF0YTsKICAgICBiYW5rcyA9IGZkdDMyX3Rv
X2NwdShwcm9wLT5sZW4pIC8gKHJlZ19jZWxscyAqIHNpemVvZiAodTMyKSk7CiAKLSAgICBmb3Ig
KCBpID0gMDsgaSA8IGJhbmtzICYmIGJvb3RpbmZvLm1lbS5ucl9iYW5rcyA8IE5SX01FTV9CQU5L
UzsgaSsrICkKKyAgICBmb3IgKCBpID0gMDsgaSA8IGJhbmtzICYmIG1lbS0+bnJfYmFua3MgPCBO
Ul9NRU1fQkFOS1M7IGkrKyApCiAgICAgewogICAgICAgICBkZXZpY2VfdHJlZV9nZXRfcmVnKCZj
ZWxsLCBhZGRyZXNzX2NlbGxzLCBzaXplX2NlbGxzLCAmc3RhcnQsICZzaXplKTsKICAgICAgICAg
aWYgKCAhc2l6ZSApCiAgICAgICAgICAgICBjb250aW51ZTsKLSAgICAgICAgYm9vdGluZm8ubWVt
LmJhbmtbYm9vdGluZm8ubWVtLm5yX2JhbmtzXS5zdGFydCA9IHN0YXJ0OwotICAgICAgICBib290
aW5mby5tZW0uYmFua1tib290aW5mby5tZW0ubnJfYmFua3NdLnNpemUgPSBzaXplOwotICAgICAg
ICBib290aW5mby5tZW0ubnJfYmFua3MrKzsKKyAgICAgICAgbWVtLT5iYW5rW21lbS0+bnJfYmFu
a3NdLnN0YXJ0ID0gc3RhcnQ7CisgICAgICAgIG1lbS0+YmFua1ttZW0tPm5yX2JhbmtzXS5zaXpl
ID0gc2l6ZTsKKyAgICAgICAgbWVtLT5ucl9iYW5rcysrOwogICAgIH0KIAotICAgIGlmICggYm9v
dGluZm8ubWVtLm5yX2JhbmtzID09IE5SX01FTV9CQU5LUyApCisgICAgaWYgKCBtZW0tPm5yX2Jh
bmtzID09IE5SX01FTV9CQU5LUyApCiAgICAgICAgIHJldHVybiAtRU5PU1BDOwogICAgIHJldHVy
biAwOwogfQogCitzdGF0aWMgaW50IF9faW5pdCBwcm9jZXNzX3Jlc2VydmVkX21lbW9yeV9ub2Rl
KGNvbnN0IHZvaWQgKmZkdCwgaW50IG5vZGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKm5hbWUsIGludCBkZXB0aCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTMyIGFkZHJlc3NfY2VsbHMs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBzaXpl
X2NlbGxzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
b2lkICpkYXRhKQoreworICAgIGludCByYyA9IHByb2Nlc3NfbWVtb3J5X25vZGUoZmR0LCBub2Rl
LCBuYW1lLCBkZXB0aCwgYWRkcmVzc19jZWxscywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHNpemVfY2VsbHMsIGRhdGEpOworCisgICAgaWYgKCByYyA9PSAtRU5PU1BDICkKKyAg
ICAgICAgcGFuaWMoIk1heCBudW1iZXIgb2Ygc3VwcG9ydGVkIHJlc2VydmVkLW1lbW9yeSByZWdp
b25zIHJlYWNoZWQuIik7CisgICAgZWxzZSBpZiAoIHJjICE9IC1FTk9FTlQgKQorICAgICAgICBy
ZXR1cm4gcmM7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgX19pbml0IHByb2Nlc3Nf
cmVzZXJ2ZWRfbWVtb3J5KGNvbnN0IHZvaWQgKmZkdCwgaW50IG5vZGUsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpuYW1lLCBpbnQgZGVwdGgs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgYWRkcmVzc19j
ZWxscywgdTMyIHNpemVfY2VsbHMpCit7CisgICAgcmV0dXJuIGRldmljZV90cmVlX2Zvcl9lYWNo
X25vZGUoZmR0LCBub2RlLCBkZXB0aCArIDEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYWRkcmVzc19jZWxscywgc2l6ZV9jZWxscywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwcm9jZXNzX3Jlc2VydmVkX21lbW9yeV9ub2RlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZib290aW5mby5yZXNlcnZlZF9tZW0pOworfQor
CiBzdGF0aWMgdm9pZCBfX2luaXQgcHJvY2Vzc19tdWx0aWJvb3Rfbm9kZShjb25zdCB2b2lkICpm
ZHQsIGludCBub2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3QgY2hhciAqbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHUzMiBhZGRyZXNzX2NlbGxzLCB1MzIgc2l6ZV9jZWxscykKQEAgLTMwNyw3ICszMzQsMTEg
QEAgc3RhdGljIGludCBfX2luaXQgZWFybHlfc2Nhbl9ub2RlKGNvbnN0IHZvaWQgKmZkdCwKIAog
ICAgIGlmICggZGV2aWNlX3RyZWVfbm9kZV9tYXRjaGVzKGZkdCwgbm9kZSwgIm1lbW9yeSIpICkK
ICAgICAgICAgcmMgPSBwcm9jZXNzX21lbW9yeV9ub2RlKGZkdCwgbm9kZSwgbmFtZSwgZGVwdGgs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzX2NlbGxzLCBzaXplX2Nl
bGxzLCBOVUxMKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3NfY2Vs
bHMsIHNpemVfY2VsbHMsICZib290aW5mby5tZW0pOworICAgIGVsc2UgaWYgKCBkZXB0aCA9PSAx
ICYmICFzdHJjbXAobmFtZSwgInJlc2VydmVkLW1lbW9yeSIpICYmCisgICAgICAgICAgICAgIHN0
cmxlbihuYW1lKSA9PSBzdHJsZW4oInJlc2VydmVkLW1lbW9yeSIpICkKKyAgICAgICAgcmMgPSBw
cm9jZXNzX3Jlc2VydmVkX21lbW9yeShmZHQsIG5vZGUsIG5hbWUsIGRlcHRoLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3NfY2VsbHMsIHNpemVfY2VsbHMpOwog
ICAgIGVsc2UgaWYgKCBkZXB0aCA8PSAzICYmIChkZXZpY2VfdHJlZV9ub2RlX2NvbXBhdGlibGUo
ZmR0LCBub2RlLCAieGVuLG11bHRpYm9vdC1tb2R1bGUiICkgfHwKICAgICAgICAgICAgICAgZGV2
aWNlX3RyZWVfbm9kZV9jb21wYXRpYmxlKGZkdCwgbm9kZSwgIm11bHRpYm9vdCxtb2R1bGUiICkp
KQogICAgICAgICBwcm9jZXNzX211bHRpYm9vdF9ub2RlKGZkdCwgbm9kZSwgbmFtZSwgYWRkcmVz
c19jZWxscywgc2l6ZV9jZWxscyk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20tYXJtL3Nl
dHVwLmggYi94ZW4vaW5jbHVkZS9hc20tYXJtL3NldHVwLmgKaW5kZXggOGJmM2Q1OTEwYS4uZWZj
YmE1NDVjMiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5oCisrKyBiL3hl
bi9pbmNsdWRlL2FzbS1hcm0vc2V0dXAuaApAQCAtNjYsNiArNjYsNyBAQCBzdHJ1Y3QgYm9vdGNt
ZGxpbmVzIHsKIAogc3RydWN0IGJvb3RpbmZvIHsKICAgICBzdHJ1Y3QgbWVtaW5mbyBtZW07Cisg
ICAgc3RydWN0IG1lbWluZm8gcmVzZXJ2ZWRfbWVtOwogICAgIHN0cnVjdCBib290bW9kdWxlcyBt
b2R1bGVzOwogICAgIHN0cnVjdCBib290Y21kbGluZXMgY21kbGluZXM7CiAjaWZkZWYgQ09ORklH
X0FDUEkKLS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2pl
Y3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4t
ZGV2ZWw=

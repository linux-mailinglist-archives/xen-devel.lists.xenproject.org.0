Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 239B130BC2
	for <lists+xen-devel@lfdr.de>; Fri, 31 May 2019 11:38:28 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hWdwR-0003Lk-BG; Fri, 31 May 2019 09:35:15 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=1r68=T7=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1hWdwP-0003Lf-Su
 for xen-devel@lists.xenproject.org; Fri, 31 May 2019 09:35:13 +0000
X-Inumbo-ID: 61356720-8387-11e9-ae13-fb39399f897c
Received: from prv1-mh.provo.novell.com (unknown [137.65.248.33])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 61356720-8387-11e9-ae13-fb39399f897c;
 Fri, 31 May 2019 09:35:09 +0000 (UTC)
Received: from INET-PRV1-MTA by prv1-mh.provo.novell.com
 with Novell_GroupWise; Fri, 31 May 2019 03:35:07 -0600
Message-Id: <5CF0F5460200007800233DA8@prv1-mh.provo.novell.com>
X-Mailer: Novell GroupWise Internet Agent 18.1.1 
Date: Fri, 31 May 2019 03:35:02 -0600
From: "Jan Beulich" <JBeulich@suse.com>
To: "xen-devel" <xen-devel@lists.xenproject.org>
References: <5CF0F33A0200007800233D8F@prv1-mh.provo.novell.com>
In-Reply-To: <5CF0F33A0200007800233D8F@prv1-mh.provo.novell.com>
Mime-Version: 1.0
Content-Disposition: inline
Subject: [Xen-devel] [PATCH 1/2] adjust special domain creation (and call it
 earlier on x86)
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, WeiLiu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <Ian.Jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U3BsaXQgb3V0IHRoaXMgbW9zdGx5IGFyY2gtaW5kZXBlbmRlbnQgY29kZSBpbnRvIGEgY29tbW9u
LWNvZGUgaGVscGVyCmZ1bmN0aW9uLiAoVGhpcyBkb2VzIGF3YXkgd2l0aCBBcm0ncyBhcmNoX2lu
aXRfbWVtb3J5KCkgYWx0b2dldGhlci4pCgpPbiB4ODYgdGhpcyBuZWVkcyB0byBoYXBwZW4gYmVm
b3JlIGFjcGlfYm9vdF9pbml0KCk6IENvbW1pdCA5ZmE5NGUxMDU4CigieDg2L0FDUEk6IGFsc28g
cGFyc2UgQU1EIElPTU1VIHRhYmxlcyBlYXJseSIpIG9ubHkgYXBwZWFyZWQgdG8gd29yawpmaW5l
IC0gaXQncyByZWFsbHkgYnJva2VuLCBhbmQgZG9lc24ndCBjcmFzaCAob24gbm9uLUVGSSBBTUQg
c3lzdGVtcykKb25seSBiZWNhdXNlIG9mIHRoZXJlIGJlaW5nIGEgbWFwcGluZyBvZiBsaW5lYXIg
YWRkcmVzcyAwIGR1cmluZyBlYXJseQpib290LiBPbiBFRkkgdGhlcmUgaXM6CgogRWFybHkgZmF0
YWwgcGFnZSBmYXVsdCBhdCBlMDA4OmZmZmY4MmQwODAyNGQ1OGUgKGNyMj0wMDAwMDAwMDAwMDAw
MjIwLCBlYz0wMDAwKQogLS0tLVsgWGVuLTQuMTMtdW5zdGFibGUgIHg4Nl82NCAgZGVidWc9eSAg
IE5vdCB0YWludGVkIF0tLS0tCiBDUFU6ICAgIDAKIFJJUDogICAgZTAwODpbPGZmZmY4MmQwODAy
NGQ1OGU+XSBwY2kuYyNfcGNpX2hpZGVfZGV2aWNlKzB4MTcvMHgzYQogUkZMQUdTOiAwMDAwMDAw
MDAwMDEwMDQ2ICAgQ09OVEVYVDogaHlwZXJ2aXNvcgogcmF4OiAwMDAwMDAwMDAwMDAwMDAwICAg
cmJ4OiAwMDAwMDAwMDAwMDA2MDAwICAgcmN4OiAwMDAwMDAwMDAwMDAwMDAwCiByZHg6IGZmZmY4
MzEwNGYyZWU5YjAgICByc2k6IGZmZmY4MmUwMjA5ZTVkNDggICByZGk6IGZmZmY4MzEwNGYyZWU5
YTAKIHJicDogZmZmZjgyZDA4MDgxZmNlMCAgIHJzcDogZmZmZjgyZDA4MDgxZmNiOCAgIHI4OiAg
MDAwMDAwMDAwMDAwMDAwMAogcjk6ICA4MDAwMDAwMDAwMDAwMDAwICAgcjEwOiAwMTgwMDAwMDAw
MDAwMDAwICAgcjExOiA3ZmZmZmZmZmZmZmZmZmZmCiByMTI6IGZmZmY4MzEwNGYyZWU5YTAgICBy
MTM6IDAwMDAwMDAwMDAwMDAwMDIgICByMTQ6IGZmZmY4MzEwNGYyZWU0YjAKIHIxNTogMDAwMDAw
MDAwMDAwMDA2NCAgIGNyMDogMDAwMDAwMDA4MDA1MDAzMyAgIGNyNDogMDAwMDAwMDAwMDAwMDBh
MAogY3IzOiAwMDAwMDAwMDlmNjE0MDAwICAgY3IyOiAwMDAwMDAwMDAwMDAwMjIwCiBmc2I6IDAw
MDAwMDAwMDAwMDAwMDAgICBnc2I6IDAwMDAwMDAwMDAwMDAwMDAgICBnc3M6IDAwMDAwMDAwMDAw
MDAwMDAKIGRzOiAwMDAwICAgZXM6IDAwMDAgICBmczogMDAwMCAgIGdzOiAwMDAwICAgc3M6IDAw
MDAgICBjczogZTAwOAogWGVuIGNvZGUgYXJvdW5kIDxmZmZmODJkMDgwMjRkNThlPiAocGNpLmMj
X3BjaV9oaWRlX2RldmljZSsweDE3LzB4M2EpOgogIDQ4IDg5IDQ3IDM4IDQ4IDhkIDU3IDEwIDw0
OD4gOGIgODggMjAgMDIgMDAgMDAgNDggODkgNTEgMDggNDggODkgNGYgMTAgNDgKIFhlbiBzdGFj
ayB0cmFjZSBmcm9tIHJzcD1mZmZmODJkMDgwODFmY2I4OgpbLi4uXQogWGVuIGNhbGwgdHJhY2U6
CiAgICBbPGZmZmY4MmQwODAyNGQ1OGU+XSBwY2kuYyNfcGNpX2hpZGVfZGV2aWNlKzB4MTcvMHgz
YQpbICAgWzwgICAgICAgICAgICAgICAgPl0gcGNpX3JvX2RldmljZSsuLi5dCiAgICBbPGZmZmY4
MmQwODA2MTdmZTE+XSBhbWRfaW9tbXVfZGV0ZWN0X29uZV9hY3BpKzB4MTYxLzB4MjQ5CiAgICBb
PGZmZmY4MmQwODA2MTg2YWM+XSBpb21tdV9hY3BpLmMjZGV0ZWN0X2lvbW11X2FjcGkrMHhiNS8w
eGU3CiAgICBbPGZmZmY4MmQwODA2MWNkZTA+XSBhY3BpX3RhYmxlX3BhcnNlKzB4NjEvMHg5MAog
ICAgWzxmZmZmODJkMDgwNjE5ZTdkPl0gYW1kX2lvbW11X2RldGVjdF9hY3BpKzB4MTcvMHgxOQog
ICAgWzxmZmZmODJkMDgwNjE3OTBiPl0gYWNwaV9pdnJzX2luaXQrMHgyMC8weDViCiAgICBbPGZm
ZmY4MmQwODA2MmU4Mzg+XSBhY3BpX2Jvb3RfaW5pdCsweDMwMS8weDMwZgogICAgWzxmZmZmODJk
MDgwNjI4YjEwPl0gX19zdGFydF94ZW4rMHgxZGFmLzB4MjhhMgogCiBQYWdldGFibGUgd2FsayBm
cm9tIDAwMDAwMDAwMDAwMDAyMjA6CiAgTDRbMHgwMDBdID0gMDAwMDAwMDA5ZjQ0ZjA2MyBmZmZm
ZmZmZmZmZmZmZmZmCiAgTDNbMHgwMDBdID0gMDAwMDAwMDA5ZjQ0YjA2MyBmZmZmZmZmZmZmZmZm
ZmZmCiAgTDJbMHgwMDBdID0gMDAwMDAwMDAwMDAwMDAwMCBmZmZmZmZmZmZmZmZmZmZmCiAKICoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIFBhbmljIG9uIENQVSAwOgog
RkFUQUwgVFJBUDogdmVjdG9yID0gMTQgKHBhZ2UgZmF1bHQpCiBbZXJyb3JfY29kZT0wMDAwXSAs
IElOIElOVEVSUlVQVCBDT05URVhUCiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCgpPZiBjb3Vyc2UgdGhlIGJ1ZyB3b3VsZCBuZXZlcnRoZWxlc3MgaGF2ZSBsZWFkIHRv
IHBvc3QtYm9vdCBjcmFzaGVzIGFzCnNvb24gYXMgdGhlIGxpc3Qgd291bGQgYWN0dWFsbHkgZ2V0
IHRyYXZlcnNlZC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNv
bT4KCi0tLSBhL3hlbi9hcmNoL2FybS9tbS5jCisrKyBiL3hlbi9hcmNoL2FybS9tbS5jCkBAIC00
Miw4ICs0Miw2IEBACiAjaW5jbHVkZSA8eGVuL2xpYmZkdC9saWJmZHQuaD4KICNpbmNsdWRlIDxh
c20vc2V0dXAuaD4KIAotc3RydWN0IGRvbWFpbiAqZG9tX3hlbiwgKmRvbV9pbywgKmRvbV9jb3c7
Ci0KIC8qIE92ZXJyaWRlIG1hY3JvcyBmcm9tIGFzbS9wYWdlLmggdG8gbWFrZSB0aGVtIHdvcmsg
d2l0aCBtZm5fdCAqLwogI3VuZGVmIHZpcnRfdG9fbWZuCiAjZGVmaW5lIHZpcnRfdG9fbWZuKHZh
KSBfbWZuKF9fdmlydF90b19tZm4odmEpKQpAQCAtNTEzLDMyICs1MTEsNiBAQCB2b2lkIGZsdXNo
X3BhZ2VfdG9fcmFtKHVuc2lnbmVkIGxvbmcgbWZuCiAgICAgICAgIGludmFsaWRhdGVfaWNhY2hl
KCk7CiB9CiAKLXZvaWQgX19pbml0IGFyY2hfaW5pdF9tZW1vcnkodm9pZCkKLXsKLSAgICAvKgot
ICAgICAqIEluaXRpYWxpc2Ugb3VyIERPTUlEX1hFTiBkb21haW4uCi0gICAgICogQW55IFhlbi1o
ZWFwIHBhZ2VzIHRoYXQgd2Ugd2lsbCBhbGxvdyB0byBiZSBtYXBwZWQgd2lsbCBoYXZlCi0gICAg
ICogdGhlaXIgZG9tYWluIGZpZWxkIHNldCB0byBkb21feGVuLgotICAgICAqLwotICAgIGRvbV94
ZW4gPSBkb21haW5fY3JlYXRlKERPTUlEX1hFTiwgTlVMTCwgZmFsc2UpOwotICAgIEJVR19PTihJ
U19FUlIoZG9tX3hlbikpOwotCi0gICAgLyoKLSAgICAgKiBJbml0aWFsaXNlIG91ciBET01JRF9J
TyBkb21haW4uCi0gICAgICogVGhpcyBkb21haW4gb3ducyBJL08gcGFnZXMgdGhhdCBhcmUgd2l0
aGluIHRoZSByYW5nZSBvZiB0aGUgcGFnZV9pbmZvCi0gICAgICogYXJyYXkuIE1hcHBpbmdzIG9j
Y3VyIGF0IHRoZSBwcml2IG9mIHRoZSBjYWxsZXIuCi0gICAgICovCi0gICAgZG9tX2lvID0gZG9t
YWluX2NyZWF0ZShET01JRF9JTywgTlVMTCwgZmFsc2UpOwotICAgIEJVR19PTihJU19FUlIoZG9t
X2lvKSk7Ci0KLSAgICAvKgotICAgICAqIEluaXRpYWxpc2Ugb3VyIENPVyBkb21haW4uCi0gICAg
ICogVGhpcyBkb21haW4gb3ducyBzaGFyYWJsZSBwYWdlcy4KLSAgICAgKi8KLSAgICBkb21fY293
ID0gZG9tYWluX2NyZWF0ZShET01JRF9DT1csIE5VTEwsIGZhbHNlKTsKLSAgICBCVUdfT04oSVNf
RVJSKGRvbV9jb3cpKTsKLX0KLQogc3RhdGljIGlubGluZSBscGFlX3QgcHRlX29mX3hlbmFkZHIo
dmFkZHJfdCB2YSkKIHsKICAgICBwYWRkcl90IG1hID0gdmEgKyBwaHlzX29mZnNldDsKLS0tIGEv
eGVuL2FyY2gvYXJtL3NldHVwLmMKKysrIGIveGVuL2FyY2gvYXJtL3NldHVwLmMKQEAgLTg0Niw3
ICs4NDYsNyBAQCB2b2lkIF9faW5pdCBzdGFydF94ZW4odW5zaWduZWQgbG9uZyBib290CiAKICAg
ICByY3VfaW5pdCgpOwogCi0gICAgYXJjaF9pbml0X21lbW9yeSgpOworICAgIHNldHVwX3NwZWNp
YWxfZG9tYWlucygpOwogCiAgICAgbG9jYWxfaXJxX2VuYWJsZSgpOwogICAgIGxvY2FsX2Fib3J0
X2VuYWJsZSgpOwotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0u
YwpAQCAtMTYwLDkgKzE2MCw2IEBAIGwxX3BnZW50cnlfdCBfX3NlY3Rpb24oIi5ic3MucGFnZV9h
bGlnbmUKIAogcGFkZHJfdCBfX3JlYWRfbW9zdGx5IG1lbV9ob3RwbHVnOwogCi0vKiBQcml2YXRl
IGRvbWFpbiBzdHJ1Y3RzIGZvciBET01JRF9YRU4gYW5kIERPTUlEX0lPLiAqLwotc3RydWN0IGRv
bWFpbiAqZG9tX3hlbiwgKmRvbV9pbywgKmRvbV9jb3c7Ci0KIC8qIEZyYW1lIHRhYmxlIHNpemUg
aW4gcGFnZXMuICovCiB1bnNpZ25lZCBsb25nIG1heF9wYWdlOwogdW5zaWduZWQgbG9uZyB0b3Rh
bF9wYWdlczsKQEAgLTI4MywzMiArMjgwLDYgQEAgdm9pZCBfX2luaXQgYXJjaF9pbml0X21lbW9y
eSh2b2lkKQogICAgICAgICAgIF9QQUdFX0RJUlRZIHwgX1BBR0VfQVZBSUwgfCBfUEFHRV9BVkFJ
TF9ISUdIIHwgX1BBR0VfTlgpOwogCiAgICAgLyoKLSAgICAgKiBJbml0aWFsaXNlIG91ciBET01J
RF9YRU4gZG9tYWluLgotICAgICAqIEFueSBYZW4taGVhcCBwYWdlcyB0aGF0IHdlIHdpbGwgYWxs
b3cgdG8gYmUgbWFwcGVkIHdpbGwgaGF2ZQotICAgICAqIHRoZWlyIGRvbWFpbiBmaWVsZCBzZXQg
dG8gZG9tX3hlbi4KLSAgICAgKiBIaWRkZW4gUENJIGRldmljZXMgd2lsbCBhbHNvIGJlIGFzc29j
aWF0ZWQgd2l0aCB0aGlzIGRvbWFpbgotICAgICAqIChidXQgYmUgW3BhcnRseV0gY29udHJvbGxl
ZCBieSBEb20wIG5ldmVydGhlbGVzcykuCi0gICAgICovCi0gICAgZG9tX3hlbiA9IGRvbWFpbl9j
cmVhdGUoRE9NSURfWEVOLCBOVUxMLCBmYWxzZSk7Ci0gICAgQlVHX09OKElTX0VSUihkb21feGVu
KSk7Ci0gICAgSU5JVF9MSVNUX0hFQUQoJmRvbV94ZW4tPmFyY2gucGRldl9saXN0KTsKLQotICAg
IC8qCi0gICAgICogSW5pdGlhbGlzZSBvdXIgRE9NSURfSU8gZG9tYWluLgotICAgICAqIFRoaXMg
ZG9tYWluIG93bnMgSS9PIHBhZ2VzIHRoYXQgYXJlIHdpdGhpbiB0aGUgcmFuZ2Ugb2YgdGhlIHBh
Z2VfaW5mbwotICAgICAqIGFycmF5LiBNYXBwaW5ncyBvY2N1ciBhdCB0aGUgcHJpdiBvZiB0aGUg
Y2FsbGVyLgotICAgICAqLwotICAgIGRvbV9pbyA9IGRvbWFpbl9jcmVhdGUoRE9NSURfSU8sIE5V
TEwsIGZhbHNlKTsKLSAgICBCVUdfT04oSVNfRVJSKGRvbV9pbykpOwotCi0gICAgLyoKLSAgICAg
KiBJbml0aWFsaXNlIG91ciBDT1cgZG9tYWluLgotICAgICAqIFRoaXMgZG9tYWluIG93bnMgc2hh
cmFibGUgcGFnZXMuCi0gICAgICovCi0gICAgZG9tX2NvdyA9IGRvbWFpbl9jcmVhdGUoRE9NSURf
Q09XLCBOVUxMLCBmYWxzZSk7Ci0gICAgQlVHX09OKElTX0VSUihkb21fY293KSk7Ci0KLSAgICAv
KgogICAgICAqIEZpcnN0IDFNQiBvZiBSQU0gaXMgaGlzdG9yaWNhbGx5IG1hcmtlZCBhcyBJL08u
CiAgICAgICogTm90ZSB0aGF0IGFwYXJ0IGZyb20gSU8gWGVuIGFsc28gdXNlcyB0aGUgbG93IDFN
QiB0byBzdG9yZSB0aGUgQVAgYm9vdAogICAgICAqIHRyYW1wb2xpbmUgYW5kIGJvb3QgaW5mb3Jt
YXRpb24gbWV0YWRhdGEuIER1ZSB0byB0aGlzIGFsd2F5cyBzcGVjaWFsCi0tLSBhL3hlbi9hcmNo
L3g4Ni9zZXR1cC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9zZXR1cC5jCkBAIC0xNTMzLDYgKzE1MzMs
OCBAQCB2b2lkIF9faW5pdCBub3JldHVybiBfX3N0YXJ0X3hlbih1bnNpZ25lCiAgICAgbW1pb19y
b19yYW5nZXMgPSByYW5nZXNldF9uZXcoTlVMTCwgInIvbyBtbWlvIHJhbmdlcyIsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgUkFOR0VTRVRGX3ByZXR0eXByaW50X2hleCk7CiAK
KyAgICBzZXR1cF9zcGVjaWFsX2RvbWFpbnMoKTsKKwogICAgIGFjcGlfYm9vdF9pbml0KCk7CiAK
ICAgICBpZiAoIHNtcF9mb3VuZF9jb25maWcgKQotLS0gYS94ZW4vY29tbW9uL2RvbWFpbi5jCisr
KyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTcxLDYgKzcxLDExIEBAIGRvbWlkX3QgaGFyZHdh
cmVfZG9taWQgX19yZWFkX21vc3RseTsKIGludGVnZXJfcGFyYW0oImhhcmR3YXJlX2RvbSIsIGhh
cmR3YXJlX2RvbWlkKTsKICNlbmRpZgogCisvKiBQcml2YXRlIGRvbWFpbiBzdHJ1Y3RzIGZvciBE
T01JRF9YRU4sIERPTUlEX0lPLCBldGMuICovCitzdHJ1Y3QgZG9tYWluICpfX3JlYWRfbW9zdGx5
IGRvbV94ZW47CitzdHJ1Y3QgZG9tYWluICpfX3JlYWRfbW9zdGx5IGRvbV9pbzsKK3N0cnVjdCBk
b21haW4gKl9fcmVhZF9tb3N0bHkgZG9tX2NvdzsKKwogc3RydWN0IHZjcHUgKmlkbGVfdmNwdVtO
Ul9DUFVTXSBfX3JlYWRfbW9zdGx5OwogCiB2Y3B1X2luZm9fdCBkdW1teV92Y3B1X2luZm87CkBA
IC01MTYsNiArNTIxLDM2IEBAIHN0cnVjdCBkb21haW4gKmRvbWFpbl9jcmVhdGUoZG9taWRfdCBk
b20KICAgICByZXR1cm4gRVJSX1BUUihlcnIpOwogfQogCit2b2lkIF9faW5pdCBzZXR1cF9zcGVj
aWFsX2RvbWFpbnModm9pZCkKK3sKKyAgICAvKgorICAgICAqIEluaXRpYWxpc2Ugb3VyIERPTUlE
X1hFTiBkb21haW4uCisgICAgICogQW55IFhlbi1oZWFwIHBhZ2VzIHRoYXQgd2Ugd2lsbCBhbGxv
dyB0byBiZSBtYXBwZWQgd2lsbCBoYXZlCisgICAgICogdGhlaXIgZG9tYWluIGZpZWxkIHNldCB0
byBkb21feGVuLgorICAgICAqIEhpZGRlbiBQQ0kgZGV2aWNlcyB3aWxsIGFsc28gYmUgYXNzb2Np
YXRlZCB3aXRoIHRoaXMgZG9tYWluCisgICAgICogKGJ1dCBiZSBbcGFydGx5XSBjb250cm9sbGVk
IGJ5IERvbTAgbmV2ZXJ0aGVsZXNzKS4KKyAgICAgKi8KKyAgICBkb21feGVuID0gZG9tYWluX2Ny
ZWF0ZShET01JRF9YRU4sIE5VTEwsIGZhbHNlKTsKKyAgICBCVUdfT04oSVNfRVJSKGRvbV94ZW4p
KTsKKyNpZmRlZiBDT05GSUdfSEFTX1BDSQorICAgIElOSVRfTElTVF9IRUFEKCZkb21feGVuLT5h
cmNoLnBkZXZfbGlzdCk7CisjZW5kaWYKKworICAgIC8qCisgICAgICogSW5pdGlhbGlzZSBvdXIg
RE9NSURfSU8gZG9tYWluLgorICAgICAqIFRoaXMgZG9tYWluIG93bnMgSS9PIHBhZ2VzIHRoYXQg
YXJlIHdpdGhpbiB0aGUgcmFuZ2Ugb2YgdGhlIHBhZ2VfaW5mbworICAgICAqIGFycmF5LiBNYXBw
aW5ncyBvY2N1ciBhdCB0aGUgcHJpdiBvZiB0aGUgY2FsbGVyLgorICAgICAqLworICAgIGRvbV9p
byA9IGRvbWFpbl9jcmVhdGUoRE9NSURfSU8sIE5VTEwsIGZhbHNlKTsKKyAgICBCVUdfT04oSVNf
RVJSKGRvbV9pbykpOworCisgICAgLyoKKyAgICAgKiBJbml0aWFsaXNlIG91ciBDT1cgZG9tYWlu
LgorICAgICAqIFRoaXMgZG9tYWluIG93bnMgc2hhcmFibGUgcGFnZXMuCisgICAgICovCisgICAg
ZG9tX2NvdyA9IGRvbWFpbl9jcmVhdGUoRE9NSURfQ09XLCBOVUxMLCBmYWxzZSk7CisgICAgQlVH
X09OKElTX0VSUihkb21fY293KSk7Cit9CiAKIHZvaWQgZG9tYWluX3VwZGF0ZV9ub2RlX2FmZmlu
aXR5KHN0cnVjdCBkb21haW4gKmQpCiB7Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS1hcm0vbW0uaAor
KysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL21tLmgKQEAgLTMzNCw4ICszMzQsNiBAQCBsb25nIGFy
Y2hfbWVtb3J5X29wKGludCBvcCwgWEVOX0dVRVNUX0hBCiAKIHVuc2lnbmVkIGxvbmcgZG9tYWlu
X2dldF9tYXhpbXVtX2dwZm4oc3RydWN0IGRvbWFpbiAqZCk7CiAKLWV4dGVybiBzdHJ1Y3QgZG9t
YWluICpkb21feGVuLCAqZG9tX2lvLCAqZG9tX2NvdzsKLQogI2RlZmluZSBtZW1ndWFyZF9ndWFy
ZF9zdGFjayhfcCkgICAgICAgKCh2b2lkKTApCiAjZGVmaW5lIG1lbWd1YXJkX2d1YXJkX3Jhbmdl
KF9wLF9sKSAgICAoKHZvaWQpMCkKICNkZWZpbmUgbWVtZ3VhcmRfdW5ndWFyZF9yYW5nZShfcCxf
bCkgICgodm9pZCkwKQotLS0gYS94ZW4vaW5jbHVkZS9hc20tYXJtL3NldHVwLmgKKysrIGIveGVu
L2luY2x1ZGUvYXNtLWFybS9zZXR1cC5oCkBAIC03Nyw4ICs3Nyw2IEBAIGV4dGVybiBzdHJ1Y3Qg
Ym9vdGluZm8gYm9vdGluZm87CiAKIGV4dGVybiBkb21pZF90IG1heF9pbml0X2RvbWlkOwogCi12
b2lkIGFyY2hfaW5pdF9tZW1vcnkodm9pZCk7Ci0KIHZvaWQgY29weV9mcm9tX3BhZGRyKHZvaWQg
KmRzdCwgcGFkZHJfdCBwYWRkciwgdW5zaWduZWQgbG9uZyBsZW4pOwogCiBzaXplX3QgZXN0aW1h
dGVfZWZpX3NpemUoaW50IG1lbV9ucl9iYW5rcyk7Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYv
bW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKQEAgLTU5NSw4ICs1OTUsNiBAQCB1
bnNpZ25lZCBpbnQgZG9tYWluX2NsYW1wX2FsbG9jX2JpdHNpemUoCiAKIHVuc2lnbmVkIGxvbmcg
ZG9tYWluX2dldF9tYXhpbXVtX2dwZm4oc3RydWN0IGRvbWFpbiAqZCk7CiAKLWV4dGVybiBzdHJ1
Y3QgZG9tYWluICpkb21feGVuLCAqZG9tX2lvLCAqZG9tX2NvdzsJLyogZm9yIHZtY29yZWluZm8g
Ki8KLQogLyogRGVmaW5pdGlvbiBvZiBhbiBtbSBsb2NrOiBzcGlubG9jayB3aXRoIGV4dHJhIGZp
ZWxkcyBmb3IgZGVidWdnaW5nICovCiB0eXBlZGVmIHN0cnVjdCBtbV9sb2NrIHsKICAgICBzcGlu
bG9ja190ICAgICAgICAgbG9jazsKLS0tIGEveGVuL2luY2x1ZGUveGVuL2RvbWFpbi5oCisrKyBi
L3hlbi9pbmNsdWRlL3hlbi9kb21haW4uaApAQCAtNSw2ICs1LDcgQEAKICNpbmNsdWRlIDx4ZW4v
dHlwZXMuaD4KIAogI2luY2x1ZGUgPHB1YmxpYy94ZW4uaD4KKwogI2luY2x1ZGUgPGFzbS9kb21h
aW4uaD4KICNpbmNsdWRlIDxhc20vbnVtYS5oPgogCkBAIC0yMiw2ICsyMyw4IEBAIHN0cnVjdCB2
Y3B1ICphbGxvY19kb20wX3ZjcHUwKHN0cnVjdCBkb20KIGludCB2Y3B1X3Jlc2V0KHN0cnVjdCB2
Y3B1ICopOwogaW50IHZjcHVfdXAoc3RydWN0IHZjcHUgKnYpOwogCit2b2lkIHNldHVwX3NwZWNp
YWxfZG9tYWlucyh2b2lkKTsKKwogc3RydWN0IHhlbl9kb21jdGxfZ2V0ZG9tYWluaW5mbzsKIHZv
aWQgZ2V0ZG9tYWluaW5mbyhzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgeGVuX2RvbWN0bF9nZXRk
b21haW5pbmZvICppbmZvKTsKIHZvaWQgYXJjaF9nZXRfZG9tYWluX2luZm8oY29uc3Qgc3RydWN0
IGRvbWFpbiAqZCwKLS0tIGEveGVuL2luY2x1ZGUveGVuL21tLmgKKysrIGIveGVuL2luY2x1ZGUv
eGVuL21tLmgKQEAgLTY0Miw2ICs2NDIsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZmlsdGVyZWRf
Zmx1c2hfdGxiX21hCiAgICAgfQogfQogCisvKiBQcml2YXRlIGRvbWFpbiBzdHJ1Y3RzIGZvciBE
T01JRF9YRU4sIERPTUlEX0lPLCBldGMuICovCitleHRlcm4gc3RydWN0IGRvbWFpbiAqZG9tX3hl
biwgKmRvbV9pbywgKmRvbV9jb3c7CisKIGVudW0gWEVOU0hBUkVfZmxhZ3MgewogICAgIFNIQVJF
X3J3LAogICAgIFNIQVJFX3JvLAoKCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVu
cHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZv
L3hlbi1kZXZlbA==

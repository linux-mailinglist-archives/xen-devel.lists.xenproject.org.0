Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 53C52639B9
	for <lists+xen-devel@lfdr.de>; Tue,  9 Jul 2019 18:56:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hktM6-0002BS-F7; Tue, 09 Jul 2019 16:52:38 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=BVIN=VG=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1hktM4-0002BN-VA
 for xen-devel@lists.xenproject.org; Tue, 09 Jul 2019 16:52:36 +0000
X-Inumbo-ID: f2325214-a269-11e9-a689-43393c81b3db
Received: from esa3.hc3370-68.iphmx.com (unknown [216.71.145.155])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id f2325214-a269-11e9-a689-43393c81b3db;
 Tue, 09 Jul 2019 16:52:33 +0000 (UTC)
Authentication-Results: esa3.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa3.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: 5+dWaxBHs/4XyMrslP5nGFEPdkPTctda8Nx9zFkNe41NBreO7UdQO7mghohI/KBl8GpluE8Wn4
 cApNaV7DsIy87rKQN6lQzTakC4e/9Oesn4+ok4871n1uM0SKtjp8IbXej6eSwPK0g+f2UDeEt5
 2ww5N3lRKbjN0/snyMipYgriFWFkDoqPbOPDyB+TUDdmRUQtW/nuBMdQsei3olhbistAWG+PGx
 2KeSYzEzO0AlqDaawOOgDpJtga+gA98xsle7yyBnrpDbzFEVXJtNvfs+BpjDkpaN+b5Pi3ZDYb
 xlM=
X-SBRS: 2.7
X-MesageID: 2769738
X-Ironport-Server: esa3.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,470,1557201600"; 
   d="scan'208";a="2769738"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Tue, 9 Jul 2019 17:51:57 +0100
Message-ID: <20190709165157.18983-1-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2] x86/ctxt-switch: Document and improve GDT
 handling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Wei Liu <wl@xen.org>, Jan Beulich <JBeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

d3JpdGVfZnVsbF9nZHRfcHRlcygpIGxvb2tzIHN1c3BpY2lvdXMgLSBpdCBpcyBub3QgZ2VuZXJh
bGx5IHNhZmUgdG8KaXRlcmF0ZSBvdmVyIChtZm4gKyBpKS4gIEhvd2V2ZXIsIHRoZSBsb29wIGlz
IGVudGlyZWx5IHVubmVjZXNzYXJ5LCBhcwpOUl9SRVNFUlZFRF9HRFRfUEFHRVMgaXMgMS4gIERy
b3BwaW5nIGl0IG1ha2VzIHRoZSBjb2RlIHN1YnN0YW50aWFsbHkKbW9yZSBjbGVhciwgYW5kIHdp
dGggaXQgZHJvcHBlZCwgd3JpdGVfZnVsbF9nZHRfcHRlcygpIGJlY29tZXMgbW9yZQpvYnZpb3Vz
bHkgYSBwb29yIG5hbWUsIHNvIHJlbmFtZSBpdCB0byB1cGRhdGVfeGVuX3Nsb3RfaW5fZnVsbF9n
ZHQoKS4KCkZ1cnRoZXJtb3JlLCBjYWxsaW5nIHZpcnRfdG9fbWZuKCkgaW4gdGhlIGNvbnRleHQg
c3dpdGNoIHBhdGggaXMgYSBsb3QKb2Ygd2FzdGVkIGN5Y2xlcyBmb3IgYSByZXN1bHQgd2hpY2gg
aXMgY29uc3RhbnQgYWZ0ZXIgYm9vdC4KCkJlZ2luIGJ5IGRvY3VtZW50aW5nIGhvdyBYZW4gaGFu
ZGxlcyB0aGUgR0RUcyBhY3Jvc3MgY29udGV4dCBzd2l0Y2guCgpGcm9tIHRoaXMsIHdlIG9ic2Vy
dmUgdGhhdCBsb2FkX2Z1bGxfZ2R0KCkgaXMgY29tcGxldGVseSBpbmRlcGVuZGVudCBvZgp0aGUg
Y3VycmVudCBDUFUsIGFuZCBsb2FkX2RlZmF1bHRfZ2R0KCkgb25seSBuZWVkcyB0aGUgY3VycmVu
dCBDUFUncwpyZWd1bGFyIEdEVC4gIChUaGlzIGlzIGEgY2hhbmdlIGluIGJlaGF2aW91ciwgYXMg
cHJldmlvdXNseSBpdCBtYXkgaGF2ZQp1c2VkIHRoZSBjb21wYXQgR0RULCBidXQgZWl0aGVyIHdp
bGwgZG8uKQoKQWRkIHR3byBleHRyYSBwZXItY3B1IHZhcmlhYmxlcyB3aGljaCBjYWNoZSB0aGUg
TDFlIGZvciB0aGUgcmVndWxhciBhbmQgY29tcGF0CkdEVCwgY2FsY3VsYXRlZCBpbiBjcHVfc21w
Ym9vdF9hbGxvYygpL3RyYXBfaW5pdCgpIGFzIGFwcHJvcHJpYXRlLCBzbwp1cGRhdGVfeGVuX3Ns
b3RfaW5fZnVsbF9nZHQoKSBkb2Vzbid0IG5lZWQgdG8gd2FzdGUgdGltZSBwZXJmb3JtaW5nIHRo
ZSBzYW1lCmNhbGN1bGF0aW9uIG9uIGV2ZXJ5IGNvbnRleHQgc3dpdGNoLgoKT25lIHBlcmZvcm1h
bmNlIHNjZW5hcmlvIG9mIEp1ZXJnZW4ncyAodGltZSB0byBidWlsZCB0aGUgaHlwZXJ2aXNvciBv
bgphbiA4IENQVSBzeXN0ZW0sIHdpdGggdHdvIHNpbmdsZS12Q1BVIE1pbmlPUyBWTXMgY29uc3Rh
bnRseSBpbnRlcnJ1cHRpbmcKZG9tMCB3aXRoIGV2ZW50cykgc2hvd3MgdGhlIGZvbGxvd2luZywg
YXZlcmFnZSBvdmVyIDUgbWVhc3VyZW1lbnRzOgoKICAgICAgICAgICAgZWxhcHNlZCAgdXNlciAg
IHN5c3RlbQogIFVucGF0Y2hlZCAgNjYuNTEgIDIzMi45MyAgMTA5LjIxCiAgUGF0Y2hlZCAgICA1
Ny4wMCAgMjI1LjQ3ICAxMDUuNDcKCndoaWNoIGlzIGEgc3Vic3RhbnRpYWwgaW1wcm92ZW1lbnQu
CgpTaWduZWQtb2ZmLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29t
PgpUZXN0ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KLS0tCkNDOiBKYW4gQmV1bGljaCA8SkJl
dWxpY2hAc3VzZS5jb20+CkNDOiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgpDQzogUm9nZXIgUGF1IE1v
bm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+CkNDOiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3Vz
ZS5jb20+Cgp2MjoKICogUmV3cml0dGVuIHRoZSBjb21taXQgbWVzc2FnZS4gIE5vIGNoYW5nZSB0
byB0aGUgcGF0Y2ggaXRzZWxmLgotLS0KIHhlbi9hcmNoL3g4Ni9kb21haW4uYyAgICAgIHwgNTIg
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLQogeGVuL2FyY2gv
eDg2L3NtcGJvb3QuYyAgICAgfCAgNCArKysrCiB4ZW4vYXJjaC94ODYvdHJhcHMuYyAgICAgICB8
IDEwICsrKysrKysrKwogeGVuL2luY2x1ZGUvYXNtLXg4Ni9kZXNjLmggfCAgMiArKwogNCBmaWxl
cyBjaGFuZ2VkLCA1MCBpbnNlcnRpb25zKCspLCAxOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggODRj
YWZiZTU1OC4uMTQ3Zjk2YTA5ZSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisr
KyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTYzNSwyMyArMTYzNSw0MiBAQCBzdGF0aWMg
dm9pZCBfdXBkYXRlX3J1bnN0YXRlX2FyZWEoc3RydWN0IHZjcHUgKnYpCiAgICAgICAgIHYtPmFy
Y2gucHYubmVlZF91cGRhdGVfcnVuc3RhdGVfYXJlYSA9IDE7CiB9CiAKKy8qCisgKiBPdmVydmll
dyBvZiBYZW4ncyBHRFRzLgorICoKKyAqIFhlbiBtYWludGFpbnMgcGVyLUNQVSBjb21wYXQgYW5k
IHJlZ3VsYXIgR0RUcyB3aGljaCBhcmUgYm90aCBhIHNpbmdsZSBwYWdlCisgKiBpbiBzaXplLiAg
U29tZSBjb250ZW50IGlzIHNwZWNpZmljIHRvIGVhY2ggQ1BVICh0aGUgVFNTLCB0aGUgcGVyLUNQ
VSBtYXJrZXIKKyAqIGZvciAjREYgaGFuZGxpbmcsIGFuZCBvcHRpb25hbGx5IHRoZSBMRFQpLiAg
VGhlIGNvbXBhdCBhbmQgcmVndWxhciBHRFRzCisgKiBkaWZmZXIgYnkgdGhlIGxheW91dCBhbmQg
Y29udGVudCBvZiB0aGUgZ3Vlc3QgYWNjZXNzaWJsZSBzZWxlY3RvcnMuCisgKgorICogVGhlIFhl
biBzZWxlY3RvcnMgbGl2ZSBmcm9tIDB4ZTAwMCAoc2xvdCAxNCBvZiAxNiksIGFuZCBuZWVkIHRv
IGFsd2F5cworICogYXBwZWFyIGluIHRoaXMgcG9zaXRpb24gZm9yIGludGVycnVwdC9leGNlcHRp
b24gaGFuZGxpbmcgdG8gd29yay4KKyAqCisgKiBBIFBWIGd1ZXN0IG1heSBzcGVjaWZ5IEdEVCBm
cmFtZXMgb2YgdGhlaXIgb3duIChzbG90cyAwIHRvIDEzKS4gIFJvb20gZm9yIGEKKyAqIGZ1bGwg
R0RUIGV4aXN0cyBpbiB0aGUgcGVyLWRvbWFpbiBtYXBwaW5ncy4KKyAqCisgKiBUbyBzY2hlZHVs
ZSBhIFBWIHZjcHUsIHdlIHBvaW50IHNsb3QgMTQgb2YgdGhlIGd1ZXN0J3MgZnVsbCBHRFQgYXQg
dGhlCisgKiBjdXJyZW50IENQVSdzIGNvbXBhdCBvciByZWd1bGFyIChhcyBhcHByb3ByaWF0ZSkg
R0RUIGZyYW1lLiAgVGhpcyBpcyBzbworICogdGhhdCB0aGUgcGVyLUNQVSBwYXJ0cyBzdGlsbCB3
b3JrIGNvcnJlY3RseSBhZnRlciBzd2l0Y2hpbmcgcGFnZXRhYmxlcyBhbmQKKyAqIGxvYWRpbmcg
dGhlIGd1ZXN0cyBmdWxsIEdEVCBpbnRvIEdEVFIuCisgKgorICogVG8gc2NoZWR1bGUgSWRsZSBv
ciBIVk0gdmNwdXMsIHdlIGxvYWQgYSBHRFQgYmFzZSBhZGRyZXNzIHdoaWNoIGNhdXNlcyB0aGUK
KyAqIHJlZ3VsYXIgcGVyLUNQVSBHRFQgZnJhbWUgdG8gYXBwZWFyIHdpdGggc2VsZWN0b3JzIGF0
IHRoZSBhcHByb3ByaWF0ZQorICogb2Zmc2V0LgorICovCiBzdGF0aWMgaW5saW5lIGJvb2wgbmVl
ZF9mdWxsX2dkdChjb25zdCBzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHJldHVybiBpc19wdl9k
b21haW4oZCkgJiYgIWlzX2lkbGVfZG9tYWluKGQpOwogfQogCi1zdGF0aWMgdm9pZCB3cml0ZV9m
dWxsX2dkdF9wdGVzKHNlZ19kZXNjX3QgKmdkdCwgY29uc3Qgc3RydWN0IHZjcHUgKnYpCitzdGF0
aWMgdm9pZCB1cGRhdGVfeGVuX3Nsb3RfaW5fZnVsbF9nZHQoY29uc3Qgc3RydWN0IHZjcHUgKnYs
IHVuc2lnbmVkIGludCBjcHUpCiB7Ci0gICAgdW5zaWduZWQgbG9uZyBtZm4gPSB2aXJ0X3RvX21m
bihnZHQpOwotICAgIGwxX3BnZW50cnlfdCAqcGwxZSA9IHB2X2dkdF9wdGVzKHYpOwotICAgIHVu
c2lnbmVkIGludCBpOwotCi0gICAgZm9yICggaSA9IDA7IGkgPCBOUl9SRVNFUlZFRF9HRFRfUEFH
RVM7IGkrKyApCi0gICAgICAgIGwxZV93cml0ZShwbDFlICsgRklSU1RfUkVTRVJWRURfR0RUX1BB
R0UgKyBpLAotICAgICAgICAgICAgICAgICAgbDFlX2Zyb21fcGZuKG1mbiArIGksIF9fUEFHRV9I
WVBFUlZJU09SX1JXKSk7CisgICAgbDFlX3dyaXRlKHB2X2dkdF9wdGVzKHYpICsgRklSU1RfUkVT
RVJWRURfR0RUX1BBR0UsCisgICAgICAgICAgICAgICFpc19wdl8zMmJpdF92Y3B1KHYpID8gcGVy
X2NwdShnZHRfdGFibGVfbDFlLCBjcHUpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDogcGVyX2NwdShjb21wYXRfZ2R0X3RhYmxlX2wxZSwgY3B1KSk7CiB9CiAKLXN0YXRpYyB2
b2lkIGxvYWRfZnVsbF9nZHQoY29uc3Qgc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBjcHUp
CitzdGF0aWMgdm9pZCBsb2FkX2Z1bGxfZ2R0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2KQogewogICAg
IHN0cnVjdCBkZXNjX3B0ciBnZHRfZGVzYyA9IHsKICAgICAgICAgLmxpbWl0ID0gTEFTVF9SRVNF
UlZFRF9HRFRfQllURSwKQEAgLTE2NjEsMTEgKzE2ODAsMTIgQEAgc3RhdGljIHZvaWQgbG9hZF9m
dWxsX2dkdChjb25zdCBzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgaW50IGNwdSkKICAgICBsZ2R0
KCZnZHRfZGVzYyk7CiB9CiAKLXN0YXRpYyB2b2lkIGxvYWRfZGVmYXVsdF9nZHQoY29uc3Qgc2Vn
X2Rlc2NfdCAqZ2R0LCB1bnNpZ25lZCBpbnQgY3B1KQorc3RhdGljIHZvaWQgbG9hZF9kZWZhdWx0
X2dkdCh1bnNpZ25lZCBpbnQgY3B1KQogewogICAgIHN0cnVjdCBkZXNjX3B0ciBnZHRfZGVzYyA9
IHsKICAgICAgICAgLmxpbWl0ID0gTEFTVF9SRVNFUlZFRF9HRFRfQllURSwKLSAgICAgICAgLmJh
c2UgID0gKHVuc2lnbmVkIGxvbmcpKGdkdCAtIEZJUlNUX1JFU0VSVkVEX0dEVF9FTlRSWSksCisg
ICAgICAgIC5iYXNlICA9ICh1bnNpZ25lZCBsb25nKShwZXJfY3B1KGdkdF90YWJsZSwgY3B1KSAt
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGSVJTVF9SRVNFUlZFRF9HRFRfRU5U
UlkpLAogICAgIH07CiAKICAgICBsZ2R0KCZnZHRfZGVzYyk7CkBAIC0xNjc4LDcgKzE2OTgsNiBA
QCBzdGF0aWMgdm9pZCBfX2NvbnRleHRfc3dpdGNoKHZvaWQpCiAgICAgc3RydWN0IHZjcHUgICAg
ICAgICAgKnAgPSBwZXJfY3B1KGN1cnJfdmNwdSwgY3B1KTsKICAgICBzdHJ1Y3QgdmNwdSAgICAg
ICAgICAqbiA9IGN1cnJlbnQ7CiAgICAgc3RydWN0IGRvbWFpbiAgICAgICAgKnBkID0gcC0+ZG9t
YWluLCAqbmQgPSBuLT5kb21haW47Ci0gICAgc2VnX2Rlc2NfdCAgICAgICAgICAgKmdkdDsKIAog
ICAgIEFTU0VSVChwICE9IG4pOwogICAgIEFTU0VSVCghdmNwdV9jcHVfZGlydHkobikpOwpAQCAt
MTcxOCwxNSArMTczNywxMiBAQCBzdGF0aWMgdm9pZCBfX2NvbnRleHRfc3dpdGNoKHZvaWQpCiAK
ICAgICBwc3JfY3R4dF9zd2l0Y2hfdG8obmQpOwogCi0gICAgZ2R0ID0gIWlzX3B2XzMyYml0X2Rv
bWFpbihuZCkgPyBwZXJfY3B1KGdkdF90YWJsZSwgY3B1KSA6Ci0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwZXJfY3B1KGNvbXBhdF9nZHRfdGFibGUsIGNwdSk7Ci0KICAgICBp
ZiAoIG5lZWRfZnVsbF9nZHQobmQpICkKLSAgICAgICAgd3JpdGVfZnVsbF9nZHRfcHRlcyhnZHQs
IG4pOworICAgICAgICB1cGRhdGVfeGVuX3Nsb3RfaW5fZnVsbF9nZHQobiwgY3B1KTsKIAogICAg
IGlmICggbmVlZF9mdWxsX2dkdChwZCkgJiYKICAgICAgICAgICgocC0+dmNwdV9pZCAhPSBuLT52
Y3B1X2lkKSB8fCAhbmVlZF9mdWxsX2dkdChuZCkpICkKLSAgICAgICAgbG9hZF9kZWZhdWx0X2dk
dChnZHQsIGNwdSk7CisgICAgICAgIGxvYWRfZGVmYXVsdF9nZHQoY3B1KTsKIAogICAgIHdyaXRl
X3B0YmFzZShuKTsKIApAQCAtMTczOSw3ICsxNzU1LDcgQEAgc3RhdGljIHZvaWQgX19jb250ZXh0
X3N3aXRjaCh2b2lkKQogCiAgICAgaWYgKCBuZWVkX2Z1bGxfZ2R0KG5kKSAmJgogICAgICAgICAg
KChwLT52Y3B1X2lkICE9IG4tPnZjcHVfaWQpIHx8ICFuZWVkX2Z1bGxfZ2R0KHBkKSkgKQotICAg
ICAgICBsb2FkX2Z1bGxfZ2R0KG4sIGNwdSk7CisgICAgICAgIGxvYWRfZnVsbF9nZHQobik7CiAK
ICAgICBpZiAoIHBkICE9IG5kICkKICAgICAgICAgY3B1bWFza19jbGVhcl9jcHUoY3B1LCBwZC0+
ZGlydHlfY3B1bWFzayk7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvc21wYm9vdC5jIGIveGVu
L2FyY2gveDg2L3NtcGJvb3QuYwppbmRleCA3MzBmZTE0MWZhLi4wMDQyODVkMTRjIDEwMDY0NAot
LS0gYS94ZW4vYXJjaC94ODYvc21wYm9vdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9zbXBib290LmMK
QEAgLTk4NSw2ICs5ODUsOCBAQCBzdGF0aWMgaW50IGNwdV9zbXBib290X2FsbG9jKHVuc2lnbmVk
IGludCBjcHUpCiAgICAgaWYgKCBnZHQgPT0gTlVMTCApCiAgICAgICAgIGdvdG8gb3V0OwogICAg
IHBlcl9jcHUoZ2R0X3RhYmxlLCBjcHUpID0gZ2R0OworICAgIHBlcl9jcHUoZ2R0X3RhYmxlX2wx
ZSwgY3B1KSA9CisgICAgICAgIGwxZV9mcm9tX3Bmbih2aXJ0X3RvX21mbihnZHQpLCBfX1BBR0Vf
SFlQRVJWSVNPUl9SVyk7CiAgICAgbWVtY3B5KGdkdCwgYm9vdF9jcHVfZ2R0X3RhYmxlLCBOUl9S
RVNFUlZFRF9HRFRfUEFHRVMgKiBQQUdFX1NJWkUpOwogICAgIEJVSUxEX0JVR19PTihOUl9DUFVT
ID4gMHgxMDAwMCk7CiAgICAgZ2R0W1BFUl9DUFVfR0RUX0VOVFJZIC0gRklSU1RfUkVTRVJWRURf
R0RUX0VOVFJZXS5hID0gY3B1OwpAQCAtOTkyLDYgKzk5NCw4IEBAIHN0YXRpYyBpbnQgY3B1X3Nt
cGJvb3RfYWxsb2ModW5zaWduZWQgaW50IGNwdSkKICAgICBwZXJfY3B1KGNvbXBhdF9nZHRfdGFi
bGUsIGNwdSkgPSBnZHQgPSBhbGxvY194ZW5oZWFwX3BhZ2VzKG9yZGVyLCBtZW1mbGFncyk7CiAg
ICAgaWYgKCBnZHQgPT0gTlVMTCApCiAgICAgICAgIGdvdG8gb3V0OworICAgIHBlcl9jcHUoY29t
cGF0X2dkdF90YWJsZV9sMWUsIGNwdSkgPQorICAgICAgICBsMWVfZnJvbV9wZm4odmlydF90b19t
Zm4oZ2R0KSwgX19QQUdFX0hZUEVSVklTT1JfUlcpOwogICAgIG1lbWNweShnZHQsIGJvb3RfY3B1
X2NvbXBhdF9nZHRfdGFibGUsIE5SX1JFU0VSVkVEX0dEVF9QQUdFUyAqIFBBR0VfU0laRSk7CiAg
ICAgZ2R0W1BFUl9DUFVfR0RUX0VOVFJZIC0gRklSU1RfUkVTRVJWRURfR0RUX0VOVFJZXS5hID0g
Y3B1OwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvdHJhcHMuYyBiL3hlbi9hcmNoL3g4Ni90
cmFwcy5jCmluZGV4IDgwOTdlZjNiZjUuLjI1YjRiNDdlNWUgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni90cmFwcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni90cmFwcy5jCkBAIC05Nyw3ICs5Nyw5IEBA
IERFRklORV9QRVJfQ1BVKHVpbnQ2NF90LCBlZmVyKTsKIHN0YXRpYyBERUZJTkVfUEVSX0NQVSh1
bnNpZ25lZCBsb25nLCBsYXN0X2V4dGFibGVfYWRkcik7CiAKIERFRklORV9QRVJfQ1BVX1JFQURf
TU9TVExZKHNlZ19kZXNjX3QgKiwgZ2R0X3RhYmxlKTsKK0RFRklORV9QRVJfQ1BVX1JFQURfTU9T
VExZKGwxX3BnZW50cnlfdCwgZ2R0X3RhYmxlX2wxZSk7CiBERUZJTkVfUEVSX0NQVV9SRUFEX01P
U1RMWShzZWdfZGVzY190ICosIGNvbXBhdF9nZHRfdGFibGUpOworREVGSU5FX1BFUl9DUFVfUkVB
RF9NT1NUTFkobDFfcGdlbnRyeV90LCBjb21wYXRfZ2R0X3RhYmxlX2wxZSk7CiAKIC8qIE1hc3Rl
ciB0YWJsZSwgdXNlZCBieSBDUFUwLiAqLwogaWR0X2VudHJ5X3QgX19zZWN0aW9uKCIuYnNzLnBh
Z2VfYWxpZ25lZCIpIF9fYWxpZ25lZChQQUdFX1NJWkUpCkBAIC0yMDU5LDYgKzIwNjEsMTQgQEAg
dm9pZCBfX2luaXQgdHJhcF9pbml0KHZvaWQpCiAgICAgICAgIH0KICAgICB9CiAKKyAgICAvKiBD
YWNoZSB7LGNvbXBhdF99Z2R0X3RhYmxlX2wxZSBub3cgdGhhdCBwaHlzaWNhbGx5IHJlbG9jYXRp
b24gaXMgZG9uZS4gKi8KKyAgICB0aGlzX2NwdShnZHRfdGFibGVfbDFlKSA9CisgICAgICAgIGwx
ZV9mcm9tX3Bmbih2aXJ0X3RvX21mbihib290X2NwdV9nZHRfdGFibGUpLAorICAgICAgICAgICAg
ICAgICAgICAgX19QQUdFX0hZUEVSVklTT1JfUlcpOworICAgIHRoaXNfY3B1KGNvbXBhdF9nZHRf
dGFibGVfbDFlKSA9CisgICAgICAgIGwxZV9mcm9tX3Bmbih2aXJ0X3RvX21mbihib290X2NwdV9j
b21wYXRfZ2R0X3RhYmxlKSwKKyAgICAgICAgICAgICAgICAgICAgIF9fUEFHRV9IWVBFUlZJU09S
X1JXKTsKKwogICAgIHBlcmNwdV90cmFwc19pbml0KCk7CiAKICAgICBjcHVfaW5pdCgpOwpkaWZm
IC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kZXNjLmggYi94ZW4vaW5jbHVkZS9hc20teDg2
L2Rlc2MuaAppbmRleCA4NWU4M2JjZWZiLi5lNTY1NzI3ZGMwIDEwMDY0NAotLS0gYS94ZW4vaW5j
bHVkZS9hc20teDg2L2Rlc2MuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2Rlc2MuaApAQCAt
MjA2LDggKzIwNiwxMCBAQCBzdHJ1Y3QgX19wYWNrZWQgZGVzY19wdHIgewogCiBleHRlcm4gc2Vn
X2Rlc2NfdCBib290X2NwdV9nZHRfdGFibGVbXTsKIERFQ0xBUkVfUEVSX0NQVShzZWdfZGVzY190
ICosIGdkdF90YWJsZSk7CitERUNMQVJFX1BFUl9DUFUobDFfcGdlbnRyeV90LCBnZHRfdGFibGVf
bDFlKTsKIGV4dGVybiBzZWdfZGVzY190IGJvb3RfY3B1X2NvbXBhdF9nZHRfdGFibGVbXTsKIERF
Q0xBUkVfUEVSX0NQVShzZWdfZGVzY190ICosIGNvbXBhdF9nZHRfdGFibGUpOworREVDTEFSRV9Q
RVJfQ1BVKGwxX3BnZW50cnlfdCwgY29tcGF0X2dkdF90YWJsZV9sMWUpOwogCiBleHRlcm4gdm9p
ZCBsb2FkX1RSKHZvaWQpOwogCi0tIAoyLjExLjAKCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBs
aXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4v
bGlzdGluZm8veGVuLWRldmVs

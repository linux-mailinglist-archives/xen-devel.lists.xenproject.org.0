Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 89724B1875
	for <lists+xen-devel@lfdr.de>; Fri, 13 Sep 2019 08:46:33 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i8fIt-00033O-VL; Fri, 13 Sep 2019 06:43:35 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=59Ls=XI=intel.com=chao.gao@srs-us1.protection.inumbo.net>)
 id 1i8fIt-00033J-7D
 for xen-devel@lists.xenproject.org; Fri, 13 Sep 2019 06:43:35 +0000
X-Inumbo-ID: cdb2a45a-d5f1-11e9-b299-bc764e2007e4
Received: from mga14.intel.com (unknown [192.55.52.115])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id cdb2a45a-d5f1-11e9-b299-bc764e2007e4;
 Fri, 13 Sep 2019 06:43:33 +0000 (UTC)
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 12 Sep 2019 23:43:32 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,500,1559545200"; d="scan'208";a="215287573"
Received: from gao-cwp.sh.intel.com (HELO gao-cwp) ([10.239.159.26])
 by fmsmga002.fm.intel.com with ESMTP; 12 Sep 2019 23:43:30 -0700
Date: Fri, 13 Sep 2019 14:47:34 +0800
From: Chao Gao <chao.gao@intel.com>
To: Jan Beulich <jbeulich@suse.com>
Message-ID: <20190913064732.GA14305@gao-cwp>
References: <1568272949-1086-1-git-send-email-chao.gao@intel.com>
 <1568272949-1086-10-git-send-email-chao.gao@intel.com>
 <3877cba9-4707-5fe9-3224-74f825545e1b@suse.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <3877cba9-4707-5fe9-3224-74f825545e1b@suse.com>
User-Agent: Mutt/1.5.21 (2010-09-15)
Subject: Re: [Xen-devel] [PATCH v10 09/16] microcode: split out
 apply_microcode() from cpu_request_microcode()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Sergey Dyasli <sergey.dyasli@citrix.com>, Ashok Raj <ashok.raj@intel.com>,
 Wei Liu <wl@xen.org>, Andrew Cooper <andrew.cooper3@citrix.com>,
 xen-devel@lists.xenproject.org,
 Roger Pau =?iso-8859-1?Q?Monn=E9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gVGh1LCBTZXAgMTIsIDIwMTkgYXQgMDQ6MDc6MTZQTSArMDIwMCwgSmFuIEJldWxpY2ggd3Jv
dGU6Cj5PbiAxMi4wOS4yMDE5IDA5OjIyLCBDaGFvIEdhbyB3cm90ZToKPj4gQEAgLTI0OSw0OSAr
MjQ5LDgwIEBAIGJvb2wgbWljcm9jb2RlX3VwZGF0ZV9jYWNoZShzdHJ1Y3QgbWljcm9jb2RlX3Bh
dGNoICpwYXRjaCkKPj4gICAgICByZXR1cm4gdHJ1ZTsKPj4gIH0KPj4gIAo+PiAtc3RhdGljIGlu
dCBtaWNyb2NvZGVfdXBkYXRlX2NwdShjb25zdCB2b2lkICpidWYsIHNpemVfdCBzaXplKQo+PiAr
LyoKPj4gKyAqIExvYWQgYSBtaWNyb2NvZGUgdXBkYXRlIHRvIGN1cnJlbnQgQ1BVLgo+PiArICoK
Pj4gKyAqIElmIG5vIHBhdGNoIGlzIHByb3ZpZGVkLCB0aGUgY2FjaGVkIHBhdGNoIHdpbGwgYmUg
bG9hZGVkLiBNaWNyb2NvZGUgdXBkYXRlCj4+ICsgKiBkdXJpbmcgQVBzIGJyaW5ndXAgYW5kIENQ
VSByZXN1bWluZyBmYWxscyBpbnRvIHRoaXMgY2FzZS4KPj4gKyAqLwo+PiArc3RhdGljIGludCBt
aWNyb2NvZGVfdXBkYXRlX2NwdShjb25zdCBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICpwYXRjaCkK
Pj4gIHsKPj4gLSAgICBpbnQgZXJyOwo+PiAtICAgIHVuc2lnbmVkIGludCBjcHUgPSBzbXBfcHJv
Y2Vzc29yX2lkKCk7Cj4+IC0gICAgc3RydWN0IGNwdV9zaWduYXR1cmUgKnNpZyA9ICZwZXJfY3B1
KGNwdV9zaWcsIGNwdSk7Cj4+ICsgICAgaW50IGVyciA9IG1pY3JvY29kZV9vcHMtPmNvbGxlY3Rf
Y3B1X2luZm8oJnRoaXNfY3B1KGNwdV9zaWcpKTsKPj4gIAo+PiAtICAgIHNwaW5fbG9jaygmbWlj
cm9jb2RlX211dGV4KTsKPj4gKyAgICBpZiAoIHVubGlrZWx5KGVycikgKQo+PiArICAgICAgICBy
ZXR1cm4gZXJyOwo+PiAgCj4+IC0gICAgZXJyID0gbWljcm9jb2RlX29wcy0+Y29sbGVjdF9jcHVf
aW5mbyhzaWcpOwo+PiAtICAgIGlmICggbGlrZWx5KCFlcnIpICkKPj4gLSAgICAgICAgZXJyID0g
bWljcm9jb2RlX29wcy0+Y3B1X3JlcXVlc3RfbWljcm9jb2RlKGJ1Ziwgc2l6ZSk7Cj4+IC0gICAg
c3Bpbl91bmxvY2soJm1pY3JvY29kZV9tdXRleCk7Cj4+ICsgICAgaWYgKCBwYXRjaCApCj4+ICsg
ICAgICAgIGVyciA9IG1pY3JvY29kZV9vcHMtPmFwcGx5X21pY3JvY29kZShwYXRjaCk7Cj4+ICsg
ICAgZWxzZSBpZiAoIG1pY3JvY29kZV9jYWNoZSApCj4+ICsgICAgewo+PiArICAgICAgICBzcGlu
X2xvY2soJm1pY3JvY29kZV9tdXRleCk7Cj4+ICsgICAgICAgIGVyciA9IG1pY3JvY29kZV9vcHMt
PmFwcGx5X21pY3JvY29kZShtaWNyb2NvZGVfY2FjaGUpOwo+PiArICAgICAgICBpZiAoIGVyciA9
PSAtRUlPICkKPj4gKyAgICAgICAgewo+PiArICAgICAgICAgICAgbWljcm9jb2RlX2ZyZWVfcGF0
Y2gobWljcm9jb2RlX2NhY2hlKTsKPj4gKyAgICAgICAgICAgIG1pY3JvY29kZV9jYWNoZSA9IE5V
TEw7Cj4+ICsgICAgICAgIH0KPj4gKyAgICAgICAgc3Bpbl91bmxvY2soJm1pY3JvY29kZV9tdXRl
eCk7Cj4+ICsgICAgfQo+Cj5JJ20gaGF2aW5nIHRyb3VibGUgdW5kZXJzdGFuZGluZyB0aGUgbG9j
a2luZyBkaXNjaXBsaW5lIGhlcmU6IFdoeQo+ZG8geW91IGNhbGwgLT5hcHBseV9taWNyb2NvZGUo
KSBvbmNlIHdpdGggdGhlIGxvY2sgaGVsZCBhbmQgb25jZQo+d2l0aG91dD8gSWYgdGhpcyBpcyB0
byBndWFyZCBhZ2FpbnN0IG1pY3JvY29kZV9jYWNoZSBjaGFuZ2luZywKClllcy4gbWljcm9jb2Rl
X2NhY2hlIGlzIHByb3RlY3RlZCBieSBtaWNyb2NvZGVfbXV0ZXg7Cgo+dGhlbiAoYSkgdGhlIGNo
ZWNrIG9mIGl0IGJlaW5nIG5vbi1OVUxMIHdvdWxkIG5lZWQgdG8gYmUgZG9uZSB3aXRoCj50aGUg
bG9jayBoZWxkIGFzIHdlbGwgYW5kCgpXaWxsIGRvLgoKPihiKSB5b3UnZCBuZWVkIHRvIGV4cGxh
aW4gd2h5IHRoZSBub24tCj5sb2NrZWQgY2FsbCB0byAtPmFwcGx5X21pY3JvY29kZSgpIGlzIG9r
YXkuCgotPmFwcGx5X21pY3JvY29kZSgpIHdhcyBhbHdheXMgY2FsbGVkIHdpdGggdGhpcyBsb2Nr
IGhlbGQgd2FzIGJlY2F1c2UKaXQgYWx3YXlzIHJlYWQgdGhlIG9sZCBwZXItY3B1IGNhY2hlIHdo
aWNoIHdhcyBwcm90ZWN0ZWQgYnkgdGhlIGxvY2suCkl0IGdhdmUgdXMgYW4gaW1wcmVzc2lvbiB0
aGF0IC0+YXBwbHlfbWljcm9jb2RlKCkgd2FzIHByb3RlY3RlZCBieSB0aGUKbG9jay4KClRoZSBw
YXRjaCBiZWZvcmUgdGhpcyBvbmUgbWFrZXMgLT5hcHBseV9taWNyb2NvZGUoKSBhY2NlcHQgYSBw
YXRjaApwb2ludGVyLiBXaXRoIHRoaXMgY2hhbmdlLCBpZiB0aGUgcGF0Y2ggYmVpbmcgcGFzc2Vk
IHNob3VsZCBiZSBhY2Nlc3NlZAp3aXRoIHNvbWUgbG9jayBoZWxkIChsaWtlIHRoZSBzZWNvbmRh
cnkgY2FsbCBzaXRlIGFib3ZlKSwgd2UgYWNxdWlyZQp0aGUgbG9jay4gT3RoZXJ3aXNlLCBubyBs
b2NrIGlzIHRha2VuIGFuZCB0aGUgY2FsbGVyIG9mCm1pY3JvY29kZV91cGRhdGVfY3B1KCkgaXMg
c3VwcG9zZWQgdG8gZ3VhcmFudGVlIHRoZSBwYXRjaCB3b24ndCBiZQpjaGFuZ2VkIGJ5IG90aGVy
cy4KCj4KPkl0IGNlcnRhaW5seSB3YXNuJ3QgdGhpcyB3YXkgaW4gdjgsIHlldCB0aGUgdjkgcmV2
aXNpb24gbG9nIGFsc28KPmRvZXNuJ3QgbWVudGlvbiBzdWNoIGEgKG5vdCBpbnNpZ25pZmljYW50
KSBjaGFuZ2UgKHdoaWNoIGlzIHBhcnQKPm9mIHRoZSByZWFzb24gd2h5IEkgZGlkbid0IHNwb3Qg
aXQgaW4gdjkpLgoKSXQgaXMgbXkgYmFkLgoKPgo+PiArICAgIGVsc2UKPj4gKyAgICAgICAgLyog
Tm8gcGF0Y2ggdG8gdXBkYXRlICovCj4+ICsgICAgICAgIGVyciA9IC1FTk9FTlQ7Cj4+ICAKPj4g
ICAgICByZXR1cm4gZXJyOwo+PiAgfQo+PiAgCj4+IC1zdGF0aWMgbG9uZyBkb19taWNyb2NvZGVf
dXBkYXRlKHZvaWQgKl9pbmZvKQo+PiArc3RhdGljIGxvbmcgZG9fbWljcm9jb2RlX3VwZGF0ZSh2
b2lkICpwYXRjaCkKPj4gIHsKPj4gLSAgICBzdHJ1Y3QgbWljcm9jb2RlX2luZm8gKmluZm8gPSBf
aW5mbzsKPj4gLSAgICBpbnQgZXJyb3I7Cj4+IC0KPj4gLSAgICBCVUdfT04oaW5mby0+Y3B1ICE9
IHNtcF9wcm9jZXNzb3JfaWQoKSk7Cj4+ICsgICAgdW5zaWduZWQgaW50IGNwdTsKPj4gKyAgICBp
bnQgcmV0ID0gbWljcm9jb2RlX3VwZGF0ZV9jcHUocGF0Y2gpOwo+PiAgCj4+IC0gICAgZXJyb3Ig
PSBtaWNyb2NvZGVfdXBkYXRlX2NwdShpbmZvLT5idWZmZXIsIGluZm8tPmJ1ZmZlcl9zaXplKTsK
Pj4gLSAgICBpZiAoIGVycm9yICkKPj4gLSAgICAgICAgaW5mby0+ZXJyb3IgPSBlcnJvcjsKPj4g
KyAgICAvKiBTdG9yZSB0aGUgcGF0Y2ggYWZ0ZXIgYSBzdWNjZXNzZnVsIGxvYWRpbmcgKi8KPj4g
KyAgICBpZiAoICFyZXQgJiYgcGF0Y2ggKQo+PiArICAgIHsKPj4gKyAgICAgICAgc3Bpbl9sb2Nr
KCZtaWNyb2NvZGVfbXV0ZXgpOwo+PiArICAgICAgICBtaWNyb2NvZGVfdXBkYXRlX2NhY2hlKHBh
dGNoKTsKPj4gKyAgICAgICAgc3Bpbl91bmxvY2soJm1pY3JvY29kZV9tdXRleCk7Cj4+ICsgICAg
ICAgIHBhdGNoID0gTlVMTDsKPj4gKyAgICB9Cj4+ICAKPj4gICAgICBpZiAoIG1pY3JvY29kZV9v
cHMtPmVuZF91cGRhdGVfcGVyY3B1ICkKPj4gICAgICAgICAgbWljcm9jb2RlX29wcy0+ZW5kX3Vw
ZGF0ZV9wZXJjcHUoKTsKPj4gIAo+PiAtICAgIGluZm8tPmNwdSA9IGNwdW1hc2tfbmV4dChpbmZv
LT5jcHUsICZjcHVfb25saW5lX21hcCk7Cj4+IC0gICAgaWYgKCBpbmZvLT5jcHUgPCBucl9jcHVf
aWRzICkKPj4gLSAgICAgICAgcmV0dXJuIGNvbnRpbnVlX2h5cGVyY2FsbF9vbl9jcHUoaW5mby0+
Y3B1LCBkb19taWNyb2NvZGVfdXBkYXRlLCBpbmZvKTsKPj4gKyAgICAvKgo+PiArICAgICAqIEVh
Y2ggdGhyZWFkIHRyaWVzIHRvIGxvYWQgdWNvZGUgYW5kIG9ubHkgdGhlIGZpcnN0IHRocmVhZCBv
ZiBhIGNvcmUKPj4gKyAgICAgKiB3b3VsZCBzdWNjZWVkLiBJZ25vcmUgZXJyb3Igb3RoZXIgdGhh
biAtRUlPLgo+PiArICAgICAqLwo+PiArICAgIGlmICggcmV0ICE9IC1FSU8gKQo+PiArICAgICAg
ICByZXQgPSAwOwo+Cj5JIGRvbid0IHRoaW5rIHRoaXMgaXMgYSBnb29kIGlkZWEuIElnbm9yaW5n
IGEgX3NwZWNpZmljXyBlcnJvcgo+Y29kZSAoZS5nLiBpbmRpY2F0aW5nICJhbHJlYWR5IGxvYWRl
ZCIgb3IgIm5ld2VyIHBhdGNoIGFscmVhZHkKPmxvYWRlZCIpIGlzIGZpbmUsIGJ1dCBoZXJlIHlv
dSBhbHNvIGlnbm9yZSB0aGluZ3MgbGlrZSAtRU5PTUVNCj5vciAtRUlOVkFMLgoKd2lsbCBkby4K
Cj4KPj4gKyAgICBjcHUgPSBjcHVtYXNrX25leHQoc21wX3Byb2Nlc3Nvcl9pZCgpLCAmY3B1X29u
bGluZV9tYXApOwo+PiArICAgIGlmICggY3B1IDwgbnJfY3B1X2lkcyApCj4+ICsgICAgICAgIHJl
dHVybiBjb250aW51ZV9oeXBlcmNhbGxfb25fY3B1KGNwdSwgZG9fbWljcm9jb2RlX3VwZGF0ZSwg
cGF0Y2gpID8KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiByZXQ7Cj4KPldoZW4gdGhlcmUncyBubyBt
aWRkbGUgb3BlcmFuZCBJIGRvbid0IHRoaW5rID8gYW5kIDogc2hvdWxkIGJlIG9uCj5zZXBhcmF0
ZSBsaW5lcy4KPgo+PiBAQCAtMjk5LDMyICszMzAsNDYgQEAgaW50IG1pY3JvY29kZV91cGRhdGUo
WEVOX0dVRVNUX0hBTkRMRV9QQVJBTShjb25zdF92b2lkKSBidWYsIHVuc2lnbmVkIGxvbmcgbGVu
KQo+PiAgICAgIGlmICggbWljcm9jb2RlX29wcyA9PSBOVUxMICkKPj4gICAgICAgICAgcmV0dXJu
IC1FSU5WQUw7Cj4+ICAKPj4gLSAgICBpbmZvID0geG1hbGxvY19ieXRlcyhzaXplb2YoKmluZm8p
ICsgbGVuKTsKPj4gLSAgICBpZiAoIGluZm8gPT0gTlVMTCApCj4+ICsgICAgYnVmZmVyID0geG1h
bGxvY19ieXRlcyhsZW4pOwo+PiArICAgIGlmICggIWJ1ZmZlciApCj4+ICAgICAgICAgIHJldHVy
biAtRU5PTUVNOwo+PiAgCj4+IC0gICAgcmV0ID0gY29weV9mcm9tX2d1ZXN0KGluZm8tPmJ1ZmZl
ciwgYnVmLCBsZW4pOwo+PiAtICAgIGlmICggcmV0ICE9IDAgKQo+PiArICAgIGlmICggY29weV9m
cm9tX2d1ZXN0KGJ1ZmZlciwgYnVmLCBsZW4pICkKPj4gKyAgICB7Cj4+ICsgICAgICAgIHJldCA9
IC1FRkFVTFQ7Cj4+ICsgICAgICAgIGdvdG8gZnJlZTsKPj4gKyAgICB9Cj4+ICsKPj4gKyAgICBw
YXRjaCA9IHBhcnNlX2Jsb2IoYnVmZmVyLCBsZW4pOwo+Cj5Zb3UgZG9uJ3QgbG9vayB0byBiZSB1
c2luZyBidWZmZXIgYW55bW9yZSBiZWxvdyB0aGlzIHBvaW50LiBXaHkgZG9uJ3QKPnlvdSBmcmVl
IGl0IHJpZ2h0IGhlcmUsIGF2b2lkaW5nIHRoZSBuZWVkIGZvciB0aGUgImZyZWUiIGxhYmVsIGJl
bG93Cj5hbmQgYWxzbyBmdXJ0aGVyIHJlZHVjaW5nIHRoZSBvdmVyYWxsIGNvZGUgY2h1cm4gYXMg
aXQgc2VlbXMuCgpZZXMuIEdvb2QgaWRlYS4KClRoYW5rcwpDaGFvCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhl
bi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3Jn
L21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

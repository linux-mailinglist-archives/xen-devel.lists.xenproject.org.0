Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 30819C112F
	for <lists+xen-devel@lfdr.de>; Sat, 28 Sep 2019 17:17:52 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEEQh-0000ug-2c; Sat, 28 Sep 2019 15:14:39 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=eHhM=XX=amazon.de=prvs=1678a297b=wipawel@srs-us1.protection.inumbo.net>)
 id 1iEEQg-0000uP-0E
 for xen-devel@lists.xenproject.org; Sat, 28 Sep 2019 15:14:38 +0000
X-Inumbo-ID: aec849d8-e202-11e9-8628-bc764e2007e4
Received: from smtp-fw-6001.amazon.com (unknown [52.95.48.154])
 by localhost (Halon) with ESMTPS
 id aec849d8-e202-11e9-8628-bc764e2007e4;
 Sat, 28 Sep 2019 15:14:36 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1569683676; x=1601219676;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=9zPjsB6z6ZS2J9foWj9HBCzZCj62vJcok9OIPzl7yiE=;
 b=mdUGhrsUfCpeHN6ZbQRzxyC0bqbRblvREDDA/0k4Zzn7zAj6/EM07H7N
 mmDJgNpom/nV0A4+2SfmLGfDOW3KftwxhCCeiaVZPw0jrGx0bP5kOLwnF
 n0u76z0pKkrm6lBQesa+LjVkwGufWaN0Np2ISbIhz41BrRXobxNrZgNGk I=;
X-IronPort-AV: E=Sophos;i="5.64,559,1559520000"; d="scan'208";a="418288699"
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-6001.iad6.amazon.com with ESMTP;
 28 Sep 2019 15:14:34 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com (Postfix) with ESMTPS
 id D8F2EC06BC; Sat, 28 Sep 2019 15:14:31 +0000 (UTC)
Received: from EX13D05EUC003.ant.amazon.com (10.43.164.207) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:14:04 +0000
Received: from EX13MTAUWB001.ant.amazon.com (10.43.161.207) by
 EX13D05EUC003.ant.amazon.com (10.43.164.207) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:14:03 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.161.249) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Sat, 28 Sep 2019 15:14:00 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Sat, 28 Sep 2019 15:13:04 +0000
Message-ID: <20190928151305.127380-12-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190928151305.127380-1-wipawel@amazon.de>
References: <20190928151305.127380-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v4 11/12] livepatch: Add metadata runtime
 retrieval mechanism
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RXh0ZW5kIHRoZSBsaXZlcGF0Y2ggbGlzdCBvcGVyYXRpb24gdG8gZmV0Y2ggYWxzbyBwYXlsb2Fk
cycgbWV0YWRhdGEuClRoaXMgaXMgYWNoaWV2ZWQgYnkgZXh0ZW5kaW5nIHRoZSBzeXNjdGwgbGlz
dCBpbnRlcmZhY2Ugd2l0aCAyIGV4dHJhCmd1ZXN0IGhhbmRsZXM6CiogbWV0YWRhdGEgICAgIC0g
YW4gYXJyYXkgb2YgYXJiaXRyYXJ5IHNpemUgc3RyaW5ncwoqIG1ldGFkYXRhX2xlbiAtIGFuIGFy
cmF5IG9mIG1ldGFkYXRhIHN0cmluZ3MnIGxlbmd0aHMgKHVpbjMyX3QgZWFjaCkKClBheWxvYWRz
JyBtZXRhZGF0YSBpcyBhIHN0cmluZyBvZiBhcmJpdHJhcnkgc2l6ZSBhbmQgZG9lcyBub3QgaGF2
ZSBhbgp1cHBlciBib3VuZCBsaW1pdC4gSXQgbWF5IGFsc28gdmFyeSBpbiBzaXplIGJldHdlZW4g
cGF5bG9hZHMuCgpJbiBvcmRlciB0byBsZXQgdGhlIHVzZXJsYW5kIGFsbG9jYXRlIGVub3VnaCBz
cGFjZSBmb3IgdGhlIGluY29taW5nCmRhdGEgYWRkIGEgbWV0YWRhdGEgdG90YWwgc2l6ZSBmaWVs
ZCB0byB0aGUgbGlzdCBzeXNjdGwgb3BlcmF0aW9uIGFuZApmaWxsIGl0IHdpdGggdG90YWwgc2l6
ZSBvZiBhbGwgcGF5bG9hZHMnIG1ldGFkYXRhLgoKRXh0ZW5kIHRoZSBsaWJ4YyB0byBoYW5kbGUg
dGhlIG1ldGFkYXRhIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycwphcyB3ZWxsIGFzIG1ldGFk
YXRhIGxlbmd0aCBhcnJheSBkYXRhIHRyYW5zZmVycy4KClRoZSB4ZW4tbGl2ZXBhdGNoIHVzZXJs
YW5kIHRvb2wgaXMgZXh0ZW5kZWQgdG8gYWx3YXlzIGRpc3BsYXkgdGhlCm1ldGFkYXRhIGZvciBl
YWNoIHJlY2VpdmVkIG1vZHVsZS4gVGhlIG1ldGFkYXRhIGlzIHJlY2VpdmVkIHdpdGggdGhlCmZv
bGxvd2luZyBmb3JtYXQ6IGtleT12YWx1ZVwwa2V5PXZhbHVlXDAuLi5rZXk9dmFsdWVcMC4gVGhl
IGZvcm1hdCBpcwptb2RpZmllZCB0byB0aGUgZm9sbG93aW5nIG9uZToga2V5PXZhbHVlO2tleT12
YWx1ZTsuLi5rZXk9dmFsdWUuClRoZSBuZXcgZm9ybWF0IGFsbG93cyB0byBlYXNpbHkgcGFyc2Ug
dGhlIG1ldGFkYXRhIGZvciBhIGdpdmVuIG1vZHVsZQpieSBhIG1hY2hpbmUuCgpTaWduZWQtb2Zm
LWJ5OiBQYXdlbCBXaWVjem9ya2lld2ljeiA8d2lwYXdlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5
OiBBbmRyYS1JcmluYSBQYXJhc2NoaXYgPGFuZHJhcHJzQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5
OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTm9yYmVy
dCBNYW50aGV5IDxubWFudGhleUBhbWF6b24uZGU+ClNpZ25lZC1vZmYtYnk6IEtvbnJhZCBSemVz
enV0ZWsgV2lsayA8a29ucmFkLndpbGtAb3JhY2xlLmNvbT4KLS0tCkNoYW5nZWQgc2luY2UgdjM6
CiAgKiB1c2UgdWludDMyX3QgaW5zdGVhZCBvZiB1aW50NjRfdCBhbmQgb2ZmX3QgZm9yCiAgICBt
ZXRhZGF0YV90b3RhbF9zaXplIGFuZCByZWxhdGVkIHZhcmlhYmxlcwoKQ2hhbmdlZCBzaW5jZSB2
MToKICAqIGFkZGVkIGNvcnJlc3BvbmRpbmcgZG9jdW1lbnRhdGlvbgogICogbWFrZSBtZXRhZGF0
YSBvcHRpb25hbCAoZG8gbm90IGRpc3BsYXkgaXQgd2hlbiBnaXZlbiBwYXlsb2FkCiAgICBkb2Vz
IG5vdCBoYXZlIGl0KQoKIGRvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jICAgIHwgMzEgKysrKysr
KysrKysrKysrKy0tLS0tCiB0b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaCB8IDIyICsrKysr
KysrKysrLS0tLQogdG9vbHMvbGlieGMveGNfbWlzYy5jICAgICAgICAgfCA2NCArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tCiB0b29scy9taXNjL3hlbi1saXZlcGF0
Y2guYyAgICB8IDQxICsrKysrKysrKysrKysrKysrKysrKy0tLS0tLQogeGVuL2NvbW1vbi9saXZl
cGF0Y2guYyAgICAgICAgfCAyMiArKysrKysrKysrKy0tLS0KIHhlbi9pbmNsdWRlL3B1YmxpYy9z
eXNjdGwuaCAgIHwgMTkgKysrKysrKysrLS0tLQogNiBmaWxlcyBjaGFuZ2VkLCAxNTYgaW5zZXJ0
aW9ucygrKSwgNDMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNjL2xpdmVwYXRj
aC5wYW5kb2MgYi9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwppbmRleCBlZWJkMDRlOGRmLi5l
YzczYTkzMTRlIDEwMDY0NAotLS0gYS9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYworKysgYi9k
b2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwpAQCAtNzA3LDggKzcwNyw4IEBAIFRoZSBzdHJ1Y3R1
cmUgaXMgYXMgZm9sbG93OgogCiAjIyMgWEVOX1NZU0NUTF9MSVZFUEFUQ0hfTElTVCAoMikKIAot
UmV0cmlldmUgYW4gYXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzIGFuZCBuYW1lcyBvZiBwYXls
b2FkcyB0aGF0IGFyZSBsb2FkZWQgaW4gdGhlCi1oeXBlcnZpc29yLgorUmV0cmlldmUgYW4gYXJy
YXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzLCBuYW1lcyBhbmQgbWV0YWRhdGEgb2YgcGF5bG9hZHMg
dGhhdCBhcmUKK2xvYWRlZCBpbiB0aGUgaHlwZXJ2aXNvci4KIAogVGhlIGNhbGxlciBwcm92aWRl
czoKIApAQCAtNzE3LDggKzcxNyw5IEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBgaWR4YCBJ
bmRleCBpdGVyYXRvci4gVGhlIGluZGV4IGludG8gdGhlIGh5cGVydmlzb3IncyBwYXlsb2FkIGNv
dW50LiBJdCBpcwogICAgIHJlY29tbWVuZGVkIHRoYXQgb24gZmlyc3QgaW52b2NhdGlvbiB6ZXJv
IGJlIHVzZWQgc28gdGhhdCBgbnJgICh3aGljaCB0aGUKICAgICBoeXBlcnZpc29yIHdpbGwgdXBk
YXRlIHdpdGggdGhlIHJlbWFpbmluZyBwYXlsb2FkIGNvdW50KSBiZSBwcm92aWRlZC4KLSAgICBB
bHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVyc2lvbmAgd2l0aCB0aGUgbW9zdCBj
dXJyZW50IHZhbHVlIGFuZAotICAgIGNhbGN1bGF0ZWQgdG90YWwgc2l6ZSBmb3IgYWxsIHBheWxv
YWRzJyBuYW1lcy4KKyAgICBBbHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVyc2lv
bmAgd2l0aCB0aGUgbW9zdCBjdXJyZW50IHZhbHVlLAorICAgIGNhbGN1bGF0ZWQgdG90YWwgc2l6
ZSBvZiBhbGwgcGF5bG9hZHMnIG5hbWVzIGFuZCBjYWxjdWxhdGVkIHRvdGFsIHNpemUgb2YKKyAg
ICBhbGwgcGF5bG9hZCdzIG1ldGFkYXRhLgogICogYG5yYCBUaGUgbWF4IG51bWJlciBvZiBlbnRy
aWVzIHRvIHBvcHVsYXRlLiBDYW4gYmUgemVybyB3aGljaCB3aWxsIHJlc3VsdAogICAgIGluIHRo
ZSBoeXBlcmNhbGwgYmVpbmcgYSBwcm9iaW5nIG9uZSBhbmQgcmV0dXJuIHRoZSBudW1iZXIgb2Yg
cGF5bG9hZHMKICAgICAoYW5kIHVwZGF0ZSB0aGUgYHZlcnNpb25gKS4KQEAgLTczNCwxNCArNzM1
LDIzIEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBgbGVuYCAtIFZpcnR1YWwgYWRkcmVzcyBv
ZiB3aGVyZSB0byB3cml0ZSB0aGUgbGVuZ3RoIG9mIGVhY2ggdW5pcXVlIG5hbWUKICAgIG9mIHRo
ZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4gRWFj
aCAqTVVTVCogYmUKICAgIG9mIHNpemVvZih1aW50MzJfdCkgKDQgYnl0ZXMpLgorICogYG1ldGFk
YXRhYCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgbWV0YWRhdGEgb2Yg
dGhlIHBheWxvYWRzLgorICAgQ2FsbGVyICpNVVNUKiBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgdG8g
YmUgYWJsZSB0byBzdG9yZSBhbGwgcmVjZWl2ZWQgZGF0YQorICAgKGkuZS4gdG90YWwgYWxsb2Nh
dGVkIHNwYWNlICpNVVNUKiBtYXRjaCB0aGUgYG1ldGFkYXRhX3RvdGFsX3NpemVgIHZhbHVlCisg
ICBwcm92aWRlZCBieSB0aGUgaHlwZXJ2aXNvcikuIEluZGl2aWR1YWwgcGF5bG9hZCBtZXRhZGF0
YSBzdHJpbmcgY2FuIGJlIG9mCisgICBhcmJpdHJhcnkgbGVuZ3RoLiBUaGUgbWV0YWRhdGEgc3Ry
aW5nIGZvcm1hdCBpczoga2V5PXZhbHVlXDAuLi5rZXk9dmFsdWVcMC4KKyAqIGBtZXRhZGF0YV9s
ZW5gIC0gVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdyaXRlIHRoZSBsZW5ndGggb2YgZWFj
aCBtZXRhZGF0YQorICAgc3RyaW5nIG9mIHRoZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9j
YXRlIHVwIHRvIGBucmAgb2YgdGhlbS4gRWFjaCAqTVVTVCoKKyAgIGJlIG9mIHNpemVvZih1aW50
MzJfdCkgKDQgYnl0ZXMpLgogCiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgYW4gcG9zaXRpdmUg
bnVtYmVyLCBpdCBpcyB0aGUgbnVtYmVyICh1cHRvIGBucmAKIHByb3ZpZGVkIHRvIHRoZSBoeXBl
cmNhbGwpIG9mIHRoZSBwYXlsb2FkcyByZXR1cm5lZCwgYWxvbmcgd2l0aCBgbnJgIHVwZGF0ZWQK
IHdpdGggdGhlIG51bWJlciBvZiByZW1haW5pbmcgcGF5bG9hZHMsIGB2ZXJzaW9uYCB1cGRhdGVk
IChpdCBtYXkgYmUgdGhlIHNhbWUKIGFjcm9zcyBoeXBlcmNhbGxzIC0gaWYgaXQgdmFyaWVzIHRo
ZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNvdWxkCi1mYWlsKSBhbmQgdGhlIGBu
YW1lX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZSBvZiB0cmFuc2ZlcnJlZCBkYXRh
IGZvcgotdGhlIGFycmF5LiBUaGUgYHN0YXR1c2AsIGBuYW1lYCwgYW5kIGBsZW5gIGFyZSB1cGRh
dGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4Ci12YWx1ZSAoYGlkeGApIHdpdGggdGhlIHJldHVy
bmVkIHZhbHVlIG9mIGRhdGEuCitmYWlsKSwgYG5hbWVfdG90YWxfc2l6ZWAgYW5kIGBtZXRhZGF0
YV90b3RhbF9zaXplYCBjb250YWluaW5nIHRvdGFsIHNpemVzIG9mCit0cmFuc2ZlcnJlZCBkYXRh
IGZvciBib3RoIHRoZSBhcnJheXMuCitUaGUgYHN0YXR1c2AsIGBuYW1lYCwgYGxlbmAsIGBtZXRh
ZGF0YWAgYW5kIGBtZXRhZGF0YV9sZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyCitkZXNpZ25lZCBp
bmRleCB2YWx1ZSAoYGlkeGApIHdpdGggdGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCiAKIElm
IHRoZSBoeXBlcmNhbGwgcmV0dXJucyAtWEVOX0UyQklHIHRoZSBgbnJgIGlzIHRvbyBiaWcgYW5k
IHNob3VsZCBiZQogbG93ZXJlZC4KQEAgLTc4MCw2ICs3OTAsNyBAQCBUaGUgc3RydWN0dXJlIGlz
IGFzIGZvbGxvdzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIE9VVDogSG93IG1hbnkgcGF5bG9hZHMgbGVmdC4gKi8KICAgICAgICAgdWludDMyX3Qg
cGFkOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIElOOiBNdXN0IGJlIHplcm8uICovCiAg
ICAgICAgIHVpbnQzMl90IG5hbWVfdG90YWxfc2l6ZTsgICAgICAgICAgICAgICAvKiBPVVQ6IFRv
dGFsIHNpemUgb2YgYWxsIHRyYW5zZmVyIG5hbWVzICovCisgICAgICAgIHVpbnQzMl90IG1ldGFk
YXRhX3RvdGFsX3NpemU7ICAgICAgICAgICAvKiBPVVQ6IFRvdGFsIHNpemUgb2YgYWxsIHRyYW5z
ZmVyIG1ldGFkYXRhICovCiAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoeGVuX2xpdmVwYXRj
aF9zdGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBNdXN0IGhhdmUgZW5vdWdoCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFjZSBhbGxvY2F0ZSBm
b3IgbnIgb2YgdGhlbS4gKi8KICAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBuYW1l
OyAgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVtYmVyCkBAIC03ODgsNiAr
Nzk5LDEyIEBAIFRoZSBzdHJ1Y3R1cmUgaXMgYXMgZm9sbG93OgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnIgb2YgdGhlbS4gKi8KICAgICAgICAg
WEVOX0dVRVNUX0hBTkRMRV82NCh1aW50MzIpIGxlbjsgICAgICAgIC8qIE9VVDogQXJyYXkgb2Yg
bGVuZ3RocyBvZiBuYW1lJ3MuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KKyAgICAgICAgWEVOX0dVRVNU
X0hBTkRMRV82NChjaGFyKSBtZXRhZGF0YTsgICAgIC8qIE9VVDogQXJyYXkgb2YgbWV0YWRhdGEg
c3RyaW5ncy4gRWFjaAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbWVtYmVyIG1heSBoYXZlIGFuIGFyYml0cmFyeSBsZW5ndGguCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2Yg
dGhlbS4gKi8KKyAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NCh1aW50MzIpIG1ldGFkYXRhX2xl
bjsgIC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBvZiBtZXRhZGF0YSdzLgorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9m
IHRoZW0uICovCisKICAgICB9OwogCiAjIyMgWEVOX1NZU0NUTF9MSVZFUEFUQ0hfQUNUSU9OICgz
KQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmggYi90b29scy9saWJ4
Yy9pbmNsdWRlL3hlbmN0cmwuaAppbmRleCA5MzdjYjQ3YzhiLi42NmE1YzcyZmQ2IDEwMDY0NAot
LS0gYS90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaAorKysgYi90b29scy9saWJ4Yy9pbmNs
dWRlL3hlbmN0cmwuaApAQCAtMjU1Miw3ICsyNTUyLDcgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQo
eGNfaW50ZXJmYWNlICp4Y2gsCiAKIC8qCiAgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxhYmxlIHBh
eWxvYWRzIGFuZCBnZXQgYWN0dWFsIHRvdGFsIHNpemUgb2YKLSAqIHRoZSBwYXlsb2FkcycgbmFt
ZSBhcnJheS4KKyAqIHRoZSBwYXlsb2FkcycgbmFtZSBhbmQgbWV0YWRhdGEgYXJyYXlzLgogICoK
ICAqIFRoaXMgZnVuY3Rpb25zIGlzIHR5cGljYWxseSBleGVjdXRlZCBmaXJzdCBiZWZvcmUgdGhl
IHhjX2xpdmVwYXRjaF9saXN0KCkKICAqIHRvIG9idGFpbiB0aGUgc2l6ZXMgYW5kIGNvcnJlY3Rs
eSBhbGxvY2F0ZSBhbGwgbmVjZXNzYXJ5IGRhdGEgcmVzb3VyY2VzLgpAQCAtMjU2MywxMyArMjU2
MywxNiBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdpbGwg
Y29udGFpbiB0aGUgaHlwZXJjYWxsIGVycm9yIGNvZGUgdmFsdWUuCiAgKi8KIGludCB4Y19saXZl
cGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpuYW1lX3RvdGFsX3Np
emUpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3Rh
bF9zaXplLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbWV0YWRh
dGFfdG90YWxfc2l6ZSk7CiAKIC8qCiAgKiBUaGUgaGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0
byBnZXQgYW4gYXJyYXkgb2YgdGhlIGZvbGxvd2luZyBvYmplY3RzOgogICogICAtIHhlbl9saXZl
cGF0Y2hfc3RhdHVzX3Q6IHN0YXRlcyBhbmQgcmV0dXJuIGNvZGVzIG9mIHBheWxvYWRzCiAgKiAg
IC0gbmFtZTogbmFtZXMgb2YgcGF5bG9hZHMKICAqICAgLSBsZW46IGxlbmd0aHMgb2YgY29ycmVz
cG9uZGluZyBwYXlsb2FkcycgbmFtZXMKKyAqICAgLSBtZXRhZGF0YTogcGF5bG9hZHMnIG1ldGFk
YXRhCisgKiAgIC0gbWV0YWRhdGFfbGVuOiBsZW5ndGhzIG9mIGNvcnJlc3BvbmRpbmcgcGF5bG9h
ZHMnIG1ldGFkYXRhCiAgKgogICogSG93ZXZlciBpdCBpcyBjb21wbGV4IGJlY2F1c2UgaXQgaGFz
IHRvIGRlYWwgd2l0aCB0aGUgaHlwZXJ2aXNvcgogICogcmV0dXJuaW5nIHNvbWUgb2YgdGhlIHJl
cXVlc3RlZCBkYXRhIG9yIGRhdGEgYmVpbmcgc3RhbGUKQEAgLTI1ODIsMTIgKzI1ODUsMTMgQEAg
aW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWdu
ZWQgaW50ICpuciwKICAqCiAgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIgb2YgdGhp
cyBmdW5jdGlvbiB3aWxsIGZpcnN0IGlzc3VlIHRoZQogICogeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0
X3NpemVzKCkgaW4gb3JkZXIgdG8gb2J0YWluIHRvdGFsIHNpemVzIG9mIG5hbWVzCi0gKiBhcyB3
ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJpZXMuCi0gKiBUaGUgdG90
YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhlICduYW1lX3RvdGFsX3Np
emUnCi0gKiBwYXJhbWV0ZXIuCisgKiBhbmQgYWxsIG1ldGFkYXRhIGFzIHdlbGwgYXMgdGhlIGN1
cnJlbnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcy4KKyAqIFRoZSB0b3RhbCBzaXplcyBhcmUg
cmVxdWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6ZScgYW5kCisgKiAn
bWV0YWRhdGFfdG90YWxfc2l6ZScgcGFyYW1ldGVycy4KICAqCiAgKiBUaGUgJ21heCcgaXMgdG8g
YmUgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtIG51bWJlciBvZgotICog
ZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAnbGVuJyBhcnJheXMgY2FuIGJlIGZpbGxlZCB1
cCB3aXRoLgorICogZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAnbGVuJywgJ21ldGFkYXRh
JyBhbmQgJ21ldGFkYXRhX2xlbicgYXJyYXlzCisgKiBjYW4gYmUgZmlsbGVkIHVwIHdpdGguCiAg
KgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2luZm8nIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9m
IHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QKICAqIHN0cnVjdHVyZSBzaXplLgpAQCAtMjU5Niw2ICsy
NjAwLDEwIEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4
Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicgYXJy
YXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWludDMyX3Qgc2l6ZS4KICAqCisgKiBFYWNoIGVudHJ5
IGluIHRoZSAnbWV0YWRhdGEnIGFycmF5IG1heSBoYXZlIGFuIGFyYml0cmFyeSBzaXplLgorICoK
KyAqIEVhY2ggZW50cnkgaW4gdGhlICdtZXRhZGF0YV9sZW4nIGFycmF5IGlzIGV4cGVjdGVkIHRv
IGJlIG9mIHVpbnQzMl90IHNpemUuCisgKgogICogVGhlIHJldHVybiB2YWx1ZSBpcyB6ZXJvIGlm
IHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4KICAqIE5vdGUgdGhhdCB0aGUg
cmV0dXJuIHZhbHVlIGlzIF9ub3RfIHRoZSBhbW91bnQgb2YgZW50cmllcyBmaWxsZWQKICAqIG91
dCAtIHRoYXQgaXMgc2F2ZWQgaW4gJ2RvbmUnLgpAQCAtMjYxMCw2ICsyNjE4LDggQEAgaW50IHhj
X2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4
LAogICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB4ZW5fbGl2ZXBhdGNoX3N0YXR1cyAqaW5m
bywKICAgICAgICAgICAgICAgICAgICAgICBjaGFyICpuYW1lLCB1aW50MzJfdCAqbGVuLAogICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IHVpbnQzMl90IG5hbWVfdG90YWxfc2l6ZSwKKyAgICAg
ICAgICAgICAgICAgICAgICBjaGFyICptZXRhZGF0YSwgdWludDMyX3QgKm1ldGFkYXRhX2xlbiwK
KyAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJfdCBtZXRhZGF0YV90b3RhbF9zaXpl
LAogICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqZG9uZSwgdW5zaWduZWQgaW50
ICpsZWZ0KTsKIAogLyoKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhjL3hjX21pc2MuYyBiL3Rvb2xz
L2xpYnhjL3hjX21pc2MuYwppbmRleCAyMGUwZTY2NzNiLi44MGIwOTdiODc4IDEwMDY0NAotLS0g
YS90b29scy9saWJ4Yy94Y19taXNjLmMKKysrIGIvdG9vbHMvbGlieGMveGNfbWlzYy5jCkBAIC02
NjMsNyArNjYzLDcgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAK
IC8qCiAgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxhYmxlIHBheWxvYWRzIGFuZCBnZXQgYWN0dWFs
IHRvdGFsIHNpemUgb2YKLSAqIHRoZSBwYXlsb2FkcycgbmFtZSBhcnJheS4KKyAqIHRoZSBwYXls
b2FkcycgbmFtZSBhbmQgbWV0YWRhdGEgYXJyYXlzLgogICoKICAqIFRoaXMgZnVuY3Rpb25zIGlz
IHR5cGljYWxseSBleGVjdXRlZCBmaXJzdCBiZWZvcmUgdGhlIHhjX2xpdmVwYXRjaF9saXN0KCkK
ICAqIHRvIG9idGFpbiB0aGUgc2l6ZXMgYW5kIGNvcnJlY3RseSBhbGxvY2F0ZSBhbGwgbmVjZXNz
YXJ5IGRhdGEgcmVzb3VyY2VzLgpAQCAtNjc0LDEyICs2NzQsMTMgQEAgaW50IHhjX2xpdmVwYXRj
aF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAgKiB3aWxsIGNvbnRhaW4gdGhlIGh5cGVyY2FsbCBl
cnJvciBjb2RlIHZhbHVlLgogICovCiBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhj
X2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3RhbF9zaXplKQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3RhbF9zaXplLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbWV0YWRhdGFfdG90YWxfc2l6ZSkKIHsKICAgICBE
RUNMQVJFX1NZU0NUTDsKICAgICBpbnQgcmM7CiAKLSAgICBpZiAoICFuciB8fCAhbmFtZV90b3Rh
bF9zaXplICkKKyAgICBpZiAoICFuciB8fCAhbmFtZV90b3RhbF9zaXplIHx8ICFtZXRhZGF0YV90
b3RhbF9zaXplICkKICAgICB7CiAgICAgICAgIGVycm5vID0gRUlOVkFMOwogICAgICAgICByZXR1
cm4gLTE7CkBAIC02OTUsNiArNjk2LDcgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXpl
cyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKIAogICAgICpuciA9IHN5c2N0
bC51LmxpdmVwYXRjaC51Lmxpc3QubnI7CiAgICAgKm5hbWVfdG90YWxfc2l6ZSA9IHN5c2N0bC51
LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90b3RhbF9zaXplOworICAgICptZXRhZGF0YV90b3RhbF9z
aXplID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5tZXRhZGF0YV90b3RhbF9zaXplOwogCiAg
ICAgcmV0dXJuIDA7CiB9CkBAIC03MDQsNiArNzA2LDggQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0
X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKICAqICAgLSB4
ZW5fbGl2ZXBhdGNoX3N0YXR1c190OiBzdGF0ZXMgYW5kIHJldHVybiBjb2RlcyBvZiBwYXlsb2Fk
cwogICogICAtIG5hbWU6IG5hbWVzIG9mIHBheWxvYWRzCiAgKiAgIC0gbGVuOiBsZW5ndGhzIG9m
IGNvcnJlc3BvbmRpbmcgcGF5bG9hZHMnIG5hbWVzCisgKiAgIC0gbWV0YWRhdGE6IHBheWxvYWRz
JyBtZXRhZGF0YQorICogICAtIG1ldGFkYXRhX2xlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5n
IHBheWxvYWRzJyBtZXRhZGF0YQogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNl
IGl0IGhhcyB0byBkZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBzb21lIG9m
IHRoZSByZXF1ZXN0ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC03MTYsMTIgKzcyMCwx
MyBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1
bnNpZ25lZCBpbnQgKm5yLAogICoKICAqIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBv
ZiB0aGlzIGZ1bmN0aW9uIHdpbGwgZmlyc3QgaXNzdWUgdGhlCiAgKiB4Y19saXZlcGF0Y2hfbGlz
dF9nZXRfc2l6ZXMoKSBpbiBvcmRlciB0byBvYnRhaW4gdG90YWwgc2l6ZXMgb2YgbmFtZXMKLSAq
IGFzIHdlbGwgYXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcy4KLSAqIFRo
ZSB0b3RhbCBzaXplcyBhcmUgcmVxdWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90
YWxfc2l6ZScKLSAqIHBhcmFtZXRlci4KKyAqIGFuZCBhbGwgbWV0YWRhdGEgYXMgd2VsbCBhcyB0
aGUgY3VycmVudCBudW1iZXIgb2YgcGF5bG9hZCBlbnRyaWVzLgorICogVGhlIHRvdGFsIHNpemVz
IGFyZSByZXF1aXJlZCBhbmQgc3VwcGxpZWQgdmlhIHRoZSAnbmFtZV90b3RhbF9zaXplJyBhbmQK
KyAqICdtZXRhZGF0YV90b3RhbF9zaXplJyBwYXJhbWV0ZXJzLgogICoKICAqIFRoZSAnbWF4JyBp
cyB0byBiZSBwcm92aWRlZCBieSB0aGUgY2FsbGVyIHdpdGggdGhlIG1heGltdW0gbnVtYmVyIG9m
Ci0gKiBlbnRyaWVzIHRoYXQgJ2luZm8nLCAnbmFtZScsICdsZW4nIGFycmF5cyBjYW4gYmUgZmls
bGVkIHVwIHdpdGguCisgKiBlbnRyaWVzIHRoYXQgJ2luZm8nLCAnbmFtZScsICdsZW4nLCAnbWV0
YWRhdGEnIGFuZCAnbWV0YWRhdGFfbGVuJyBhcnJheXMKKyAqIGNhbiBiZSBmaWxsZWQgdXAgd2l0
aC4KICAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnaW5mbycgYXJyYXkgaXMgZXhwZWN0ZWQgdG8g
YmUgb2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdAogICogc3RydWN0dXJlIHNpemUuCkBAIC03MzAs
NiArNzM1LDEwIEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNl
ICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicg
YXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWludDMyX3Qgc2l6ZS4KICAqCisgKiBFYWNoIGVu
dHJ5IGluIHRoZSAnbWV0YWRhdGEnIGFycmF5IG1heSBoYXZlIGFuIGFyYml0cmFyeSBzaXplLgor
ICoKKyAqIEVhY2ggZW50cnkgaW4gdGhlICdtZXRhZGF0YV9sZW4nIGFycmF5IGlzIGV4cGVjdGVk
IHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCisgKgogICogVGhlIHJldHVybiB2YWx1ZSBpcyB6ZXJv
IGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4KICAqIE5vdGUgdGhhdCB0
aGUgcmV0dXJuIHZhbHVlIGlzIF9ub3RfIHRoZSBhbW91bnQgb2YgZW50cmllcyBmaWxsZWQKICAq
IG91dCAtIHRoYXQgaXMgc2F2ZWQgaW4gJ2RvbmUnLgpAQCAtNzQ0LDYgKzc1Myw4IEBAIGludCB4
Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1h
eCwKICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmlu
Zm8sCiAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3QgKmxlbiwKICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemUsCisgICAg
ICAgICAgICAgICAgICAgICAgY2hhciAqbWV0YWRhdGEsIHVpbnQzMl90ICptZXRhZGF0YV9sZW4s
CisgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdWludDMyX3QgbWV0YWRhdGFfdG90YWxfc2l6
ZSwKICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmRvbmUsIHVuc2lnbmVkIGlu
dCAqbGVmdCkKIHsKICAgICBpbnQgcmM7CkBAIC03NTIsMTMgKzc2MywxNiBAQCBpbnQgeGNfbGl2
ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAg
ICAgREVDTEFSRV9IWVBFUkNBTExfQk9VTkNFKGluZm8sIDAsIFhDX0hZUEVSQ0FMTF9CVUZGRVJf
Qk9VTkNFX09VVCk7CiAgICAgREVDTEFSRV9IWVBFUkNBTExfQk9VTkNFKG5hbWUsIDAsIFhDX0hZ
UEVSQ0FMTF9CVUZGRVJfQk9VTkNFX09VVCk7CiAgICAgREVDTEFSRV9IWVBFUkNBTExfQk9VTkNF
KGxlbiwgMCwgWENfSFlQRVJDQUxMX0JVRkZFUl9CT1VOQ0VfT1VUKTsKKyAgICBERUNMQVJFX0hZ
UEVSQ0FMTF9CT1VOQ0UobWV0YWRhdGEsIDAsIFhDX0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNFX09V
VCk7CisgICAgREVDTEFSRV9IWVBFUkNBTExfQk9VTkNFKG1ldGFkYXRhX2xlbiwgMCwgWENfSFlQ
RVJDQUxMX0JVRkZFUl9CT1VOQ0VfT1VUKTsKICAgICB1aW50MzJfdCBtYXhfYmF0Y2hfc3osIG5y
OwogICAgIHVpbnQzMl90IHZlcnNpb24gPSAwLCByZXRyaWVzID0gMDsKICAgICB1aW50MzJfdCBh
ZGp1c3QgPSAwOwotICAgIHVpbnQzMl90IG5hbWVfb2ZmID0gMDsKLSAgICB1aW50MzJfdCBuYW1l
X3N6OworICAgIHVpbnQzMl90IG5hbWVfb2ZmID0gMCwgbWV0YWRhdGFfb2ZmID0gMDsKKyAgICB1
aW50MzJfdCBuYW1lX3N6LCBtZXRhZGF0YV9zejsKIAotICAgIGlmICggIW1heCB8fCAhaW5mbyB8
fCAhbmFtZSB8fCAhbGVuIHx8ICFkb25lIHx8ICFsZWZ0ICkKKyAgICBpZiAoICFtYXggfHwgIWlu
Zm8gfHwgIW5hbWUgfHwgIWxlbiB8fAorICAgICAgICAgIW1ldGFkYXRhIHx8ICFtZXRhZGF0YV9s
ZW4gfHwgIWRvbmUgfHwgIWxlZnQgKQogICAgIHsKICAgICAgICAgZXJybm8gPSBFSU5WQUw7CiAg
ICAgICAgIHJldHVybiAtMTsKQEAgLTc3NywxMCArNzkxLDExIEBAIGludCB4Y19saXZlcGF0Y2hf
bGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKIAogICAgIG1h
eF9iYXRjaF9zeiA9IG1heDsKICAgICBuYW1lX3N6ID0gbmFtZV90b3RhbF9zaXplOworICAgIG1l
dGFkYXRhX3N6ID0gbWV0YWRhdGFfdG90YWxfc2l6ZTsKICAgICAqZG9uZSA9IDA7CiAgICAgKmxl
ZnQgPSAwOwogICAgIGRvIHsKLSAgICAgICAgdWludDMyX3QgX25hbWVfc3o7CisgICAgICAgIHVp
bnQzMl90IF9uYW1lX3N6LCBfbWV0YWRhdGFfc3o7CiAKICAgICAgICAgLyoKICAgICAgICAgICog
VGhlIGZpcnN0IHRpbWUgd2UgZ28gaW4gdGhpcyBsb29wIG91ciAnbWF4JyBtYXkgYmUgYmlnZ2Vy
CkBAIC04MDMsMTAgKzgxOCwxNCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNl
ICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0Vf
U0VUX1NJWkUoaW5mbywgbnIgKiBzaXplb2YoKmluZm8pKTsKICAgICAgICAgSFlQRVJDQUxMX0JP
VU5DRV9TRVRfU0laRShuYW1lLCBuYW1lX3N6KTsKICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9T
RVRfU0laRShsZW4sIG5yICogc2l6ZW9mKCpsZW4pKTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5D
RV9TRVRfU0laRShtZXRhZGF0YSwgbWV0YWRhdGFfc3opOworICAgICAgICBIWVBFUkNBTExfQk9V
TkNFX1NFVF9TSVpFKG1ldGFkYXRhX2xlbiwgbnIgKiBzaXplb2YoKm1ldGFkYXRhX2xlbikpOwog
ICAgICAgICAvKiBNb3ZlIHRoZSBwb2ludGVyIHRvIHByb3BlciBvZmZzZXQgaW50byAnaW5mbycu
ICovCiAgICAgICAgIChIWVBFUkNBTExfQlVGRkVSKGluZm8pKS0+dWJ1ZiA9IGluZm8gKyAqZG9u
ZTsKICAgICAgICAgKEhZUEVSQ0FMTF9CVUZGRVIobmFtZSkpLT51YnVmID0gbmFtZSArIG5hbWVf
b2ZmOwogICAgICAgICAoSFlQRVJDQUxMX0JVRkZFUihsZW4pKS0+dWJ1ZiA9IGxlbiArICpkb25l
OworICAgICAgICAoSFlQRVJDQUxMX0JVRkZFUihtZXRhZGF0YSkpLT51YnVmID0gbWV0YWRhdGEg
KyBtZXRhZGF0YV9vZmY7CisgICAgICAgIChIWVBFUkNBTExfQlVGRkVSKG1ldGFkYXRhX2xlbikp
LT51YnVmID0gbWV0YWRhdGFfbGVuICsgKmRvbmU7CiAgICAgICAgIC8qIEFsbG9jYXRlIG1lbW9y
eS4gKi8KICAgICAgICAgcmMgPSB4Y19oeXBlcmNhbGxfYm91bmNlX3ByZSh4Y2gsIGluZm8pOwog
ICAgICAgICBpZiAoIHJjICkKQEAgLTgyMCw5ICs4MzksMTkgQEAgaW50IHhjX2xpdmVwYXRjaF9s
aXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICBp
ZiAoIHJjICkKICAgICAgICAgICAgIGJyZWFrOwogCisgICAgICAgIHJjID0geGNfaHlwZXJjYWxs
X2JvdW5jZV9wcmUoeGNoLCBtZXRhZGF0YSk7CisgICAgICAgIGlmICggcmMgKQorICAgICAgICAg
ICAgYnJlYWs7CisKKyAgICAgICAgcmMgPSB4Y19oeXBlcmNhbGxfYm91bmNlX3ByZSh4Y2gsIG1l
dGFkYXRhX2xlbik7CisgICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgYnJlYWs7CisKICAg
ICAgICAgc2V0X3hlbl9ndWVzdF9oYW5kbGUoc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5zdGF0
dXMsIGluZm8pOwogICAgICAgICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNjdGwudS5saXZlcGF0
Y2gudS5saXN0Lm5hbWUsIG5hbWUpOwogICAgICAgICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNj
dGwudS5saXZlcGF0Y2gudS5saXN0LmxlbiwgbGVuKTsKKyAgICAgICAgc2V0X3hlbl9ndWVzdF9o
YW5kbGUoc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5tZXRhZGF0YSwgbWV0YWRhdGEpOworICAg
ICAgICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0Lm1ldGFk
YXRhX2xlbiwgbWV0YWRhdGFfbGVuKTsKIAogICAgICAgICByYyA9IGRvX3N5c2N0bCh4Y2gsICZz
eXNjdGwpOwogICAgICAgICAvKgpAQCAtODM5LDYgKzg2OCw4IEBAIGludCB4Y19saXZlcGF0Y2hf
bGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICAgICAg
ICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGluZm8pOwogICAgICAgICAgICAgeGNf
aHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbmFtZSk7CiAgICAgICAgICAgICB4Y19oeXBlcmNh
bGxfYm91bmNlX3Bvc3QoeGNoLCBsZW4pOworICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5j
ZV9wb3N0KHhjaCwgbWV0YWRhdGEpOworICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9w
b3N0KHhjaCwgbWV0YWRhdGFfbGVuKTsKICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICB9
CiAgICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKSAvKiBGb3IgYWxsIG90aGVyIGVycm9ycyB3ZSBi
YWlsIG91dC4gKi8KQEAgLTg2Myw2ICs4OTQsOCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAgICAgICAgICB4Y19o
eXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBpbmZvKTsKICAgICAgICAgICAgIHhjX2h5cGVyY2Fs
bF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5j
ZV9wb3N0KHhjaCwgbGVuKTsKKyAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4
Y2gsIG1ldGFkYXRhKTsKKyAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gs
IG1ldGFkYXRhX2xlbik7CiAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQogCkBAIC04
NzUsMTcgKzkwOCwyNCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gs
IGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAgICAgIH0KICAgICAgICAgKmxlZnQgPSBzeXNj
dGwudS5saXZlcGF0Y2gudS5saXN0Lm5yOyAvKiBUb3RhbCByZW1haW5pbmcgY291bnQuICovCiAg
ICAgICAgIF9uYW1lX3N6ID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uYW1lX3RvdGFsX3Np
emU7IC8qIFRvdGFsIHJlY2VpdmVkIG5hbWUgc2l6ZS4gKi8KKyAgICAgICAgX21ldGFkYXRhX3N6
ID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5tZXRhZGF0YV90b3RhbF9zaXplOyAvKiBUb3Rh
bCByZWNlaXZlZCBtZXRhZGF0YSBzaXplLiAqLwogICAgICAgICAvKiBDb3B5IG9ubHkgdXAgJ3Jj
JyBvZiBkYXRhJyAtIHdlIGNvdWxkIGFkZCAnbWluKHJjLG5yKSBpZiBkZXNpcmVkLiAqLwogICAg
ICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGluZm8sIChyYyAqIHNpemVvZigqaW5mbykp
KTsKICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBfbmFtZV9zeik7CiAg
ICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobGVuLCAocmMgKiBzaXplb2YoKmxlbikp
KTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShtZXRhZGF0YSwgX21ldGFkYXRh
X3N6KTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShtZXRhZGF0YV9sZW4sIChy
YyAqIHNpemVvZigqbWV0YWRhdGFfbGVuKSkpOwogICAgICAgICAvKiBCb3VuY2UgdGhlIGRhdGEg
YW5kIGZyZWUgdGhlIGJvdW5jZSBidWZmZXIuICovCiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3Vu
Y2VfcG9zdCh4Y2gsIGluZm8pOwogICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNo
LCBuYW1lKTsKICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbGVuKTsKKyAg
ICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGEpOworICAgICAgICB4
Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBtZXRhZGF0YV9sZW4pOwogCiAgICAgICAgIG5h
bWVfc3ogLT0gX25hbWVfc3o7CiAgICAgICAgIG5hbWVfb2ZmICs9IF9uYW1lX3N6OworICAgICAg
ICBtZXRhZGF0YV9zeiAtPSBfbWV0YWRhdGFfc3o7CisgICAgICAgIG1ldGFkYXRhX29mZiArPSBf
bWV0YWRhdGFfc3o7CiAKICAgICAgICAgLyogQW5kIHVwZGF0ZSBob3cgbWFueSBlbGVtZW50cyBv
ZiBpbmZvIHdlIGhhdmUgY29waWVkIGludG8uICovCiAgICAgICAgICpkb25lICs9IHJjOwpAQCAt
ODk4LDYgKzkzOCw4IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwg
Y29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0
KHhjaCwgbGVuKTsKICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbmFtZSk7
CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGluZm8pOworICAgICAgICB4
Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBtZXRhZGF0YSk7CisgICAgICAgIHhjX2h5cGVy
Y2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1ldGFkYXRhX2xlbik7CiAgICAgfQogCiAgICAgcmV0dXJu
IHJjID4gMCA/IDAgOiByYzsKZGlmZiAtLWdpdCBhL3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5j
IGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKaW5kZXggNzdjMDRkMjNjMS4uNzU3NzNkMjk5
YSAxMDA2NDQKLS0tIGEvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKKysrIGIvdG9vbHMvbWlz
Yy94ZW4tbGl2ZXBhdGNoLmMKQEAgLTY5LDggKzY5LDEwIEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5j
KGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgdW5zaWduZWQgaW50IG5yLCBkb25lLCBsZWZ0
LCBpOwogICAgIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QgKmluZm8gPSBOVUxMOwogICAgIGNoYXIg
Km5hbWUgPSBOVUxMOworICAgIGNoYXIgKm1ldGFkYXRhID0gTlVMTDsKICAgICB1aW50MzJfdCAq
bGVuID0gTlVMTDsKLSAgICB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemUsIG5hbWVfb2ZmOworICAg
IHVpbnQzMl90ICptZXRhZGF0YV9sZW4gPSBOVUxMOworICAgIHVpbnQzMl90IG5hbWVfdG90YWxf
c2l6ZSwgbWV0YWRhdGFfdG90YWxfc2l6ZSwgbmFtZV9vZmYsIG1ldGFkYXRhX29mZjsKICAgICBp
bnQgcmMgPSBFTk9NRU07CiAKICAgICBpZiAoIGFyZ2MgKQpAQCAtODAsNyArODIsNyBAQCBzdGF0
aWMgaW50IGxpc3RfZnVuYyhpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAgIH0KICAgICBkb25l
ID0gbGVmdCA9IDA7CiAKLSAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y2gs
ICZuciwgJm5hbWVfdG90YWxfc2l6ZSk7CisgICAgcmMgPSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRf
c2l6ZXMoeGNoLCAmbnIsICZuYW1lX3RvdGFsX3NpemUsICZtZXRhZGF0YV90b3RhbF9zaXplKTsK
ICAgICBpZiAoIHJjICkKICAgICB7CiAgICAgICAgIHJjID0gZXJybm87CkBAIC0xMDgsMTIgKzEx
MCwyMyBAQCBzdGF0aWMgaW50IGxpc3RfZnVuYyhpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAg
IGlmICggIWxlbiApCiAgICAgICAgIGdvdG8gZXJyb3JfbGVuOwogCisgICAgbWV0YWRhdGEgPSBt
YWxsb2MobWV0YWRhdGFfdG90YWxfc2l6ZSAqIHNpemVvZigqbWV0YWRhdGEpICsgMSk7CisgICAg
aWYgKCAhbWV0YWRhdGEgKQorICAgICAgICBnb3RvIGVycm9yX21ldGFkYXRhOworCisgICAgbWV0
YWRhdGFfbGVuID0gbWFsbG9jKG5yICogc2l6ZW9mKCptZXRhZGF0YV9sZW4pKTsKKyAgICBpZiAo
ICFtZXRhZGF0YV9sZW4gKQorICAgICAgICBnb3RvIGVycm9yX21ldGFkYXRhX2xlbjsKKwogICAg
IG1lbXNldChpbmZvLCAnQScsIG5yICogc2l6ZW9mKCppbmZvKSk7CiAgICAgbWVtc2V0KG5hbWUs
ICdCJywgbmFtZV90b3RhbF9zaXplICogc2l6ZW9mKCpuYW1lKSk7CiAgICAgbWVtc2V0KGxlbiwg
J0MnLCBuciAqIHNpemVvZigqbGVuKSk7Ci0gICAgbmFtZV9vZmYgPSAwOworICAgIG1lbXNldCht
ZXRhZGF0YSwgJ0QnLCBtZXRhZGF0YV90b3RhbF9zaXplICogc2l6ZW9mKCptZXRhZGF0YSkgKyAx
KTsKKyAgICBtZW1zZXQobWV0YWRhdGFfbGVuLCAnRScsIG5yICogc2l6ZW9mKCptZXRhZGF0YV9s
ZW4pKTsKKyAgICBuYW1lX29mZiA9IG1ldGFkYXRhX29mZiA9IDA7CiAKLSAgICByYyA9IHhjX2xp
dmVwYXRjaF9saXN0KHhjaCwgbnIsIDAsIGluZm8sIG5hbWUsIGxlbiwgbmFtZV90b3RhbF9zaXpl
LCAmZG9uZSwgJmxlZnQpOworICAgIHJjID0geGNfbGl2ZXBhdGNoX2xpc3QoeGNoLCBuciwgMCwg
aW5mbywgbmFtZSwgbGVuLCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICBtZXRhZGF0YSwgbWV0YWRhdGFfbGVuLCBtZXRhZGF0YV90b3RhbF9zaXplLCAmZG9uZSwg
JmxlZnQpOwogICAgIGlmICggcmMgfHwgZG9uZSAhPSBuciB8fCBsZWZ0ID4gMCkKICAgICB7CiAg
ICAgICAgIHJjID0gZXJybm87CkBAIC0xMjMsMjMgKzEzNiwzNSBAQCBzdGF0aWMgaW50IGxpc3Rf
ZnVuYyhpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAgICAgICBnb3RvIGVycm9yOwogICAgIH0K
IAotICAgIGZwcmludGYoc3Rkb3V0LCIgSUQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCBzdGF0dXNcbiIKLSAgICAgICAgICAgICAgICAgICAiLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS1cbiIpOworICAgIGZwcmludGYoc3Rk
b3V0LCIgSUQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBzdGF0dXMgICAg
IHwgbWV0YWRhdGFcbiIKKyAgICAgICAgICAgICAgICAgICAiLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tXG4iKTsKIAog
ICAgIGZvciAoIGkgPSAwOyBpIDwgZG9uZTsgaSsrICkKICAgICB7CisgICAgICAgIHVuc2lnbmVk
IGludCBqOwogICAgICAgICBjaGFyICpuYW1lX3N0ciA9IG5hbWUgKyBuYW1lX29mZjsKKyAgICAg
ICAgY2hhciAqbWV0YWRhdGFfc3RyID0gbWV0YWRhdGEgKyBtZXRhZGF0YV9vZmY7CiAKICAgICAg
ICAgcHJpbnRmKCIlLTQwLipzfCAlcyIsIGxlbltpXSwgbmFtZV9zdHIsIHN0YXRlMnN0cihpbmZv
W2ldLnN0YXRlKSk7CiAgICAgICAgIGlmICggaW5mb1tpXS5yYyApCi0gICAgICAgICAgICBwcmlu
dGYoIiAoJWQsICVzKVxuIiwgLWluZm9baV0ucmMsIHN0cmVycm9yKC1pbmZvW2ldLnJjKSk7Cisg
ICAgICAgICAgICBwcmludGYoIiAoJWQsICVzKSAgICB8ICIsIC1pbmZvW2ldLnJjLCBzdHJlcnJv
cigtaW5mb1tpXS5yYykpOwogICAgICAgICBlbHNlCi0gICAgICAgICAgICBwdXRzKCIiKTsKKyAg
ICAgICAgICAgIHByaW50ZigiICAgIHwgIik7CisKKyAgICAgICAgLyogUmVwbGFjZSBhbGwgJ1ww
JyB3aXRoIHNlbWktY29sb25zLiAqLworICAgICAgICBmb3IgKCBqID0gMDsgbWV0YWRhdGFfbGVu
W2ldICYmIGogPCBtZXRhZGF0YV9sZW5baV0gLSAxOyBqKysgKQorICAgICAgICAgICAgbWV0YWRh
dGFfc3RyW2pdID0gKG1ldGFkYXRhX3N0cltqXSA/OiAnOycpOworICAgICAgICBwcmludGYoIiUu
KnNcbiIsIG1ldGFkYXRhX2xlbltpXSwgbWV0YWRhdGFfc3RyKTsKIAogICAgICAgICBuYW1lX29m
ZiArPSBsZW5baV07CisgICAgICAgIG1ldGFkYXRhX29mZiArPSBtZXRhZGF0YV9sZW5baV07CiAg
ICAgfQogCiBlcnJvcjoKKyAgICBmcmVlKG1ldGFkYXRhX2xlbik7CitlcnJvcl9tZXRhZGF0YV9s
ZW46CisgICAgZnJlZShtZXRhZGF0YSk7CitlcnJvcl9tZXRhZGF0YToKICAgICBmcmVlKGxlbik7
CiBlcnJvcl9sZW46CiAgICAgZnJlZShuYW1lKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vbGl2
ZXBhdGNoLmMgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCmluZGV4IDNjMTkxZWI4ODkuLjZjMzMx
MWY0ZjUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKKysrIGIveGVuL2NvbW1v
bi9saXZlcGF0Y2guYwpAQCAtMTE2NCw3ICsxMTY0LDggQEAgc3RhdGljIGludCBsaXZlcGF0Y2hf
bGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlzdCkKIAogICAgIGlmICgg
bGlzdC0+bnIgJiYKICAgICAgICAgICghZ3Vlc3RfaGFuZGxlX29rYXkobGlzdC0+c3RhdHVzLCBs
aXN0LT5ucikgfHwKLSAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlzdC0+bGVuLCBsaXN0
LT5ucikpICkKKyAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlzdC0+bGVuLCBsaXN0LT5u
cikgfHwKKyAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlzdC0+bWV0YWRhdGFfbGVuLCBs
aXN0LT5ucikpICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKICAgICBzcGluX2xvY2soJnBh
eWxvYWRfbG9jayk7CkBAIC0xMTc1LDEzICsxMTc2LDE0IEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNo
X2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAgICAgfQogCiAg
ICAgbGlzdC0+bmFtZV90b3RhbF9zaXplID0gMDsKKyAgICBsaXN0LT5tZXRhZGF0YV90b3RhbF9z
aXplID0gMDsKICAgICBpZiAoIGxpc3QtPm5yICkKICAgICB7Ci0gICAgICAgIHVpbnQ2NF90IG5h
bWVfb2Zmc2V0ID0gMDsKKyAgICAgICAgdWludDY0X3QgbmFtZV9vZmZzZXQgPSAwLCBtZXRhZGF0
YV9vZmZzZXQgPSAwOwogCiAgICAgICAgIGxpc3RfZm9yX2VhY2hfZW50cnkoIGRhdGEsICZwYXls
b2FkX2xpc3QsIGxpc3QgKQogICAgICAgICB7Ci0gICAgICAgICAgICB1aW50MzJfdCBuYW1lX2xl
bjsKKyAgICAgICAgICAgIHVpbnQzMl90IG5hbWVfbGVuLCBtZXRhZGF0YV9sZW47CiAKICAgICAg
ICAgICAgIGlmICggbGlzdC0+aWR4ID4gaSsrICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsK
QEAgLTExOTIsOCArMTE5NCwxMyBAQCBzdGF0aWMgaW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4
ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0KQogICAgICAgICAgICAgbmFtZV9sZW4gPSBz
dHJsZW4oZGF0YS0+bmFtZSkgKyAxOwogICAgICAgICAgICAgbGlzdC0+bmFtZV90b3RhbF9zaXpl
ICs9IG5hbWVfbGVuOwogCisgICAgICAgICAgICBtZXRhZGF0YV9sZW4gPSBkYXRhLT5tZXRhZGF0
YS5sZW47CisgICAgICAgICAgICBsaXN0LT5tZXRhZGF0YV90b3RhbF9zaXplICs9IG1ldGFkYXRh
X2xlbjsKKwogICAgICAgICAgICAgaWYgKCAhZ3Vlc3RfaGFuZGxlX3N1YnJhbmdlX29rYXkobGlz
dC0+bmFtZSwgbmFtZV9vZmZzZXQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBuYW1lX29mZnNldCArIG5hbWVfbGVuIC0gMSkgKQorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZV9vZmZzZXQgKyBuYW1lX2xlbiAtIDEp
IHx8CisgICAgICAgICAgICAgICAgICFndWVzdF9oYW5kbGVfc3VicmFuZ2Vfb2theShsaXN0LT5t
ZXRhZGF0YSwgbWV0YWRhdGFfb2Zmc2V0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbWV0YWRhdGFfb2Zmc2V0ICsgbWV0YWRhdGFfbGVuIC0gMSkgKQogICAg
ICAgICAgICAgewogICAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKICAgICAgICAgICAgICAg
ICBicmVhazsKQEAgLTEyMDMsNyArMTIxMCwxMCBAQCBzdGF0aWMgaW50IGxpdmVwYXRjaF9saXN0
KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0KQogICAgICAgICAgICAgaWYg
KCBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm5hbWUsIG5hbWVfb2Zmc2V0LAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPm5hbWUsIG5hbWVfbGVuKSB8
fAogICAgICAgICAgICAgICAgIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bGVuLCBpZHgs
ICZuYW1lX2xlbiwgMSkgfHwKLSAgICAgICAgICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0
KGxpc3QtPnN0YXR1cywgaWR4LCAmc3RhdHVzLCAxKSApCisgICAgICAgICAgICAgICAgX19jb3B5
X3RvX2d1ZXN0X29mZnNldChsaXN0LT5zdGF0dXMsIGlkeCwgJnN0YXR1cywgMSkgfHwKKyAgICAg
ICAgICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm1ldGFkYXRhLCBtZXRhZGF0
YV9vZmZzZXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5t
ZXRhZGF0YS5kYXRhLCBtZXRhZGF0YV9sZW4pIHx8CisgICAgICAgICAgICAgICAgX19jb3B5X3Rv
X2d1ZXN0X29mZnNldChsaXN0LT5tZXRhZGF0YV9sZW4sIGlkeCwgJm1ldGFkYXRhX2xlbiwgMSkg
KQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHJjID0gLUVGQVVMVDsKICAgICAgICAg
ICAgICAgICBicmVhazsKQEAgLTEyMTEsNiArMTIyMSw3IEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNo
X2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAKICAgICAgICAg
ICAgIGlkeCsrOwogICAgICAgICAgICAgbmFtZV9vZmZzZXQgKz0gbmFtZV9sZW47CisgICAgICAg
ICAgICBtZXRhZGF0YV9vZmZzZXQgKz0gbWV0YWRhdGFfbGVuOwogCiAgICAgICAgICAgICBpZiAo
IChpZHggPj0gbGlzdC0+bnIpIHx8IGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQogICAgICAg
ICAgICAgICAgIGJyZWFrOwpAQCAtMTIyMSw2ICsxMjMyLDcgQEAgc3RhdGljIGludCBsaXZlcGF0
Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlzdCkKICAgICAgICAg
bGlzdF9mb3JfZWFjaF9lbnRyeSggZGF0YSwgJnBheWxvYWRfbGlzdCwgbGlzdCApCiAgICAgICAg
IHsKICAgICAgICAgICAgIGxpc3QtPm5hbWVfdG90YWxfc2l6ZSArPSBzdHJsZW4oZGF0YS0+bmFt
ZSkgKyAxOworICAgICAgICAgICAgbGlzdC0+bWV0YWRhdGFfdG90YWxfc2l6ZSArPSBkYXRhLT5t
ZXRhZGF0YS5sZW47CiAgICAgICAgIH0KICAgICB9CiAgICAgbGlzdC0+bnIgPSBwYXlsb2FkX2Nu
dCAtIGk7IC8qIFJlbWFpbmluZyBhbW91bnQuICovCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9w
dWJsaWMvc3lzY3RsLmggYi94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmgKaW5kZXggMDg4MDdj
OTJhNS4uNWMzNmIzNDcxYiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5o
CisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaApAQCAtOTIwLDE2ICs5MjAsMTcgQEAg
c3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2dldCB7CiB9OwogCiAvKgotICogUmV0cmlldmUg
YW4gYXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzIGFuZCBuYW1lcyBvZiBwYXlsb2FkcyB0aGF0
IGFyZQotICogbG9hZGVkIGluIHRoZSBoeXBlcnZpc29yLgorICogUmV0cmlldmUgYW4gYXJyYXkg
b2YgYWJicmV2aWF0ZWQgc3RhdHVzLCBuYW1lcyBhbmQgbWV0YWRhdGEgb2YgcGF5bG9hZHMgdGhh
dAorICogYXJlIGxvYWRlZCBpbiB0aGUgaHlwZXJ2aXNvci4KICAqCiAgKiBJZiB0aGUgaHlwZXJj
YWxsIHJldHVybnMgYW4gcG9zaXRpdmUgbnVtYmVyLCBpdCBpcyB0aGUgbnVtYmVyICh1cCB0byBg
bnJgKQogICogb2YgdGhlIHBheWxvYWRzIHJldHVybmVkLCBhbG9uZyB3aXRoIGBucmAgdXBkYXRl
ZCB3aXRoIHRoZSBudW1iZXIgb2YgcmVtYWluaW5nCiAgKiBwYXlsb2FkcywgYHZlcnNpb25gIHVw
ZGF0ZWQgKGl0IG1heSBiZSB0aGUgc2FtZSBhY3Jvc3MgaHlwZXJjYWxscy4gSWYgaXQgdmFyaWVz
Ci0gKiB0aGUgZGF0YSBpcyBzdGFsZSBhbmQgZnVydGhlciBjYWxscyBjb3VsZCBmYWlsKSBhbmQg
dGhlIG5hbWVfdG90YWxfc2l6ZQotICogY29udGFpbmluZyB0b3RhbCBzaXplIG9mIHRyYW5zZmVy
cmVkIGRhdGEgZm9yIHRoZSBhcnJheS4KLSAqIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBgbGVuYCBh
cmUgdXBkYXRlZCBhdCB0aGVpciBkZXNpZ25lZCBpbmRleCB2YWx1ZSAoYGlkeGApCi0gKiB3aXRo
IHRoZSByZXR1cm5lZCB2YWx1ZSBvZiBkYXRhLgorICogdGhlIGRhdGEgaXMgc3RhbGUgYW5kIGZ1
cnRoZXIgY2FsbHMgY291bGQgZmFpbCksIGBuYW1lX3RvdGFsX3NpemVgIGFuZAorICogYG1ldGFk
YXRhX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZXMgb2YgdHJhbnNmZXJyZWQgZGF0
YSBmb3IgYm90aCB0aGUKKyAqIGFycmF5cy4KKyAqIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBgbGVu
YCwgYG1ldGFkYXRhYCBhbmQgYG1ldGFkYXRhX2xlbmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIKKyAq
IGRlc2lnbmVkIGluZGV4IHZhbHVlIChgaWR4YCkgd2l0aCB0aGUgcmV0dXJuZWQgdmFsdWUgb2Yg
ZGF0YS4KICAqCiAgKiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgRTJCSUcgdGhlIGBucmAgaXMg
dG9vIGJpZyBhbmQgc2hvdWxkIGJlCiAgKiBsb3dlcmVkLiBUaGUgdXBwZXIgbGltaXQgb2YgYG5y
YCBpcyBsZWZ0IHRvIHRoZSBpbXBsZW1lbnRpb24uCkBAIC05NTMsNiArOTU0LDcgQEAgc3RydWN0
IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBPVVQ6IEhvdyBtYW55IHBheWxvYWRzIGxlZnQuICovCiAgICAg
dWludDMyX3QgcGFkOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIElOOiBNdXN0IGJlIHpl
cm8uICovCiAgICAgdWludDMyX3QgbmFtZV90b3RhbF9zaXplOyAgICAgICAgICAgICAgIC8qIE9V
VDogVG90YWwgc2l6ZSBvZiBhbGwgdHJhbnNmZXIgbmFtZXMgKi8KKyAgICB1aW50MzJfdCBtZXRh
ZGF0YV90b3RhbF9zaXplOyAgICAgICAgICAgLyogT1VUOiBUb3RhbCBzaXplIG9mIGFsbCB0cmFu
c2ZlciBtZXRhZGF0YSAqLwogICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoeGVuX2xpdmVwYXRjaF9z
dGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBNdXN0IGhhdmUgZW5vdWdoCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYWNlIGFsbG9jYXRlIGZvciBuciBv
ZiB0aGVtLiAqLwogICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgbmFtZTsgICAgICAgICAv
KiBPVVQ6IEFycmF5IG9mIG5hbWVzLiBFYWNoIG1lbWJlcgpAQCAtOTYxLDYgKzk2MywxMSBAQCBz
dHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCB7CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5yIG9mIHRoZW0uICovCiAgICAgWEVOX0dVRVNUX0hB
TkRMRV82NCh1aW50MzIpIGxlbjsgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBvZiBu
YW1lJ3MuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11
c3QgaGF2ZSBuciBvZiB0aGVtLiAqLworICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgbWV0
YWRhdGE7ICAgICAvKiBPVVQ6IEFycmF5IG9mIG1ldGFkYXRhIHN0cmluZ3MuIEVhY2gKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyIG1heSBoYXZl
IGFuIGFyYml0cmFyeSBsZW5ndGguCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLworICAgIFhFTl9HVUVTVF9IQU5E
TEVfNjQodWludDMyKSBtZXRhZGF0YV9sZW47ICAvKiBPVVQ6IEFycmF5IG9mIGxlbmd0aHMgb2Yg
bWV0YWRhdGEncy4KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCiB9OwogCiAvKgotLSAKMi4xNi41CgoKCgpB
bWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkgR21iSApLcmF1c2Vuc3RyLiAzOAoxMDEx
NyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJpc3RpYW4gU2NobGFlZ2VyLCBSYWxmIEhl
cmJyaWNoCkVpbmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVudGVyIEhS
QiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3IDg3OQoKCgoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxp
bmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5w
cm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

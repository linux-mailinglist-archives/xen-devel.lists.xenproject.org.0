Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 7D5C210F778
	for <lists+xen-devel@lfdr.de>; Tue,  3 Dec 2019 06:47:38 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ic0yA-0005kn-2w; Tue, 03 Dec 2019 05:43:30 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=jJba=ZZ=invisiblethingslab.com=marmarek@srs-us1.protection.inumbo.net>)
 id 1ic0y8-0005ki-Mo
 for xen-devel@lists.xenproject.org; Tue, 03 Dec 2019 05:43:28 +0000
X-Inumbo-ID: d38f3392-158f-11ea-81cc-12813bfff9fa
Received: from wout1-smtp.messagingengine.com (unknown [64.147.123.24])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id d38f3392-158f-11ea-81cc-12813bfff9fa;
 Tue, 03 Dec 2019 05:43:26 +0000 (UTC)
Received: from compute7.internal (compute7.nyi.internal [10.202.2.47])
 by mailout.west.internal (Postfix) with ESMTP id 2D2E1C8F;
 Tue,  3 Dec 2019 00:43:25 -0500 (EST)
Received: from mailfrontend1 ([10.202.2.162])
 by compute7.internal (MEProxy); Tue, 03 Dec 2019 00:43:25 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:message-id:mime-version:subject:to:x-me-proxy
 :x-me-proxy:x-me-sender:x-me-sender:x-sasl-enc; s=fm1; bh=Au0sk+
 xl/cZ8hI+5WvyE3tKwAjfm2QQqUf4iEBuIseM=; b=KPpbG0aWTbWbuuFica4AC1
 ePvz1sgqjSuHxawCY/9vnuPNC+mOYXnUOAnTFQCNZXGH+54yZZauDnNjS6NMtbsR
 LVYj1Z+2FSKNLia1h+ezU1dJ+DpM3v9RANFCse6kUJh5o9Q9sUFwFsa4qycljS9I
 fecL8TydfmrA4aOYPp8MJf0WYLFm2ebvIet8lKsepO14Hflqslpr1a8bGwhD1qov
 bZwIhtAFjnNcrpRrVp+3UxssohYFlMU2om6yiGmCZq8Axh3LMiE6s7pd6q8bGvRy
 RIDJk89Owh6DeR6zug1c2DE4uGrFZup1zv2AXzQZWJdatholiFHBFuGIKDlm10xA
 ==
X-ME-Sender: <xms:_PXlXXfR9er6umCQBchZbkqvuPv_iwXvOTYlgyvLktd4gtEuIsIMSg>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgedufedrudejiedgkeegucetufdoteggodetrfdotf
 fvucfrrhhofhhilhgvmecuhfgrshhtofgrihhlpdfqfgfvpdfurfetoffkrfgpnffqhgen
 uceurghilhhouhhtmecufedttdenucesvcftvggtihhpihgvnhhtshculddquddttddmne
 cujfgurhephffvufffkffogggtohfgsehtkeertdertdejnecuhfhrohhmpeforghrvghk
 ucforghrtgiihihkohifshhkihdqifpkrhgvtghkihcuoehmrghrmhgrrhgvkhesihhnvh
 hishhisghlvghthhhinhhgshhlrggsrdgtohhmqeenucffohhmrghinhepmhgrrhhkmhgr
 ihhlrdhorhhgpdhinhhvihhsihgslhgvthhhihhnghhslhgrsgdrtghomhenucfkpheple
 durdeihedrfeegrdeffeenucfrrghrrghmpehmrghilhhfrhhomhepmhgrrhhmrghrvghk
 sehinhhvihhsihgslhgvthhhihhnghhslhgrsgdrtghomhenucevlhhushhtvghrufhiii
 gvpedt
X-ME-Proxy: <xmx:_PXlXYsgZ4dOqNbtQXkYZtf79T_8XzNQw7iMvptSWiZJGJajuRZQdQ>
 <xmx:_PXlXWh0-r9rq9CngzcSi4VdhmQ4hHyU6MAem2FOubaSrjBEhdgavQ>
 <xmx:_PXlXWvVoHhL1XcDapcU6N0fmhE1CiKw5vMYUYhp5DsuU-JS-7I1Jg>
 <xmx:_PXlXQHnVCrGSaS9Ww_Fq-hVBnO21H_RYTBdtFVd6TxTOqf_7-Hjcw>
Received: from localhost.localdomain (ip5b412221.dynamic.kabel-deutschland.de
 [91.65.34.33])
 by mail.messagingengine.com (Postfix) with ESMTPA id B07B980059;
 Tue,  3 Dec 2019 00:43:22 -0500 (EST)
From: =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Tue,  3 Dec 2019 06:41:56 +0100
Message-Id: <20191203054222.7966-1-marmarek@invisiblethingslab.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
Organization: Invisible Things Lab
Subject: [Xen-devel] [PATCH v1] xen-pciback: optionally allow interrupt
 enable flag writes
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 YueHaibing <yuehaibing@huawei.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, open list <linux-kernel@vger.kernel.org>,
 Simon Gaiser <simon@invisiblethingslab.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Boris Ostrovsky <boris.ostrovsky@oracle.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UUVNVSBydW5uaW5nIGluIGEgc3R1YmRvbSBuZWVkcyB0byBiZSBhYmxlIHRvIHNldCBJTlRYX0RJ
U0FCTEUsIGFuZCB0aGUKTVNJKC1YKSBlbmFibGUgZmxhZ3MgaW4gdGhlIFBDSSBjb25maWcgc3Bh
Y2UuIFRoaXMgYWRkcyBhbiBhdHRyaWJ1dGUKJ2FsbG93X2ludGVycnVwdF9jb250cm9sJyB3aGlj
aCB3aGVuIHNldCBmb3IgYSBQQ0kgZGV2aWNlIGFsbG93cyB3cml0ZXMKdG8gdGhpcyBmbGFnKHMp
LiBUaGUgdG9vbHN0YWNrIHdpbGwgbmVlZCB0byBzZXQgdGhpcyBmb3Igc3R1YmRvbXMuCldoZW4g
ZW5hYmxlZCwgZ3Vlc3QgKHN0dWJkb21haW4pIHdpbGwgYmUgYWxsb3dlZCB0byBzZXQgcmVsZXZh
bnQgZW5hYmxlCmZsYWdzLCBidXQgb25seSBvbmUgYXQgYSB0aW1lIC0gaS5lLiBpdCByZWZ1c2Vz
IHRvIGVuYWJsZSBtb3JlIHRoYW4gb25lCm9mIElOVHgsIE1TSSwgTVNJLVggYXQgYSB0aW1lLgoK
VGhpcyBmdW5jdGlvbmFsaXR5IGlzIG5lZWRlZCBvbmx5IGZvciBjb25maWcgc3BhY2UgYWNjZXNz
IGRvbmUgYnkgZGV2aWNlCm1vZGVsIChzdHViZG9tYWluKSBzZXJ2aW5nIGEgSFZNIHdpdGggdGhl
IGFjdHVhbCBQQ0kgZGV2aWNlLiBJdCBpcyBub3QKbmVjZXNzYXJ5IGFuZCB1bnNhZmUgdG8gZW5h
YmxlIGRpcmVjdCBhY2Nlc3MgdG8gdGhvc2UgYml0cyBmb3IgUFYgZG9tYWluCndpdGggdGhlIGRl
dmljZSBhdHRhY2hlZC4gRm9yIFBWIGRvbWFpbnMsIHRoZXJlIGFyZSBzZXBhcmF0ZSBwcm90b2Nv
bAptZXNzYWdlcyAoWEVOX1BDSV9PUF97ZW5hYmxlLGRpc2FibGV9X3ttc2ksbXNpeH0pIGZvciB0
aGlzIHB1cnBvc2UuClRob3NlIG9wcyBpbiBhZGRpdGlvbiB0byBzZXR0aW5nIGVuYWJsZSBiaXRz
LCBhbHNvIGNvbmZpZ3VyZSBNU0koLVgpIGluCmRvbTAga2VybmVsIC0gd2hpY2ggaXMgdW5kZXNp
cmFibGUgZm9yIFBDSSBwYXNzdGhyb3VnaCB0byBIVk0gZ3Vlc3RzLgoKVGhpcyBzaG91bGQgbm90
IGludHJvZHVjZSBhbnkgbmV3IHNlY3VyaXR5IGlzc3VlcyBzaW5jZSBhIG1hbGljaW91cwpndWVz
dCAob3Igc3R1YmRvbSkgY2FuIGFscmVhZHkgZ2VuZXJhdGUgTVNJcyB0aHJvdWdoIG90aGVyIHdh
eXMsIHNlZQpbMV0gcGFnZSA4LiBBZGRpdGlvbmFsbHksIHdoZW4gcWVtdSBydW5zIGluIGRvbTAs
IGl0IGFscmVhZHkgaGF2ZSBkaXJlY3QKYWNjZXNzIHRvIHRob3NlIGJpdHMuCgpUaGlzIGlzIHRo
ZSBzZWNvbmQgaXRlcmF0aW9uIG9mIHRoaXMgZmVhdHVyZS4gRmlyc3Qgd2FzIHByb3Bvc2VkIGFz
IGEKZGlyZWN0IFhlbiBpbnRlcmZhY2UgdGhyb3VnaCBhIG5ldyBoeXBlcmNhbGwsIGJ1dCB1bHRp
bWF0ZWx5IGl0IHdhcwpyZWplY3RlZCBieSB0aGUgbWFpbnRhaW5lciwgYmVjYXVzZSBvZiBtaXhp
bmcgcGNpYmFjayBhbmQgaHlwZXJjYWxscyBmb3IKUENJIGNvbmZpZyBzcGFjZSBhY2Nlc3MgaXNu
J3QgYSBnb29kIGRlc2lnbi4gRnVsbCBkaXNjdXNzaW9uIGF0IFsyXS4KClsxXTogaHR0cHM6Ly9p
bnZpc2libGV0aGluZ3NsYWIuY29tL3Jlc291cmNlcy8yMDExL1NvZnR3YXJlJTIwQXR0YWNrcyUy
MG9uJTIwSW50ZWwlMjBWVC1kLnBkZgpbMl06IGh0dHBzOi8veGVuLm1hcmttYWlsLm9yZy90aHJl
YWQvc21wZ3B3czR1bWR6aXp6ZQoKW3BhcnQgb2YgdGhlIGNvbW1pdCBtZXNzYWdlIGFuZCBzeXNm
cyBoYW5kbGluZ10KU2lnbmVkLW9mZi1ieTogU2ltb24gR2Fpc2VyIDxzaW1vbkBpbnZpc2libGV0
aGluZ3NsYWIuY29tPgpbdGhlIHJlc3RdClNpZ25lZC1vZmYtYnk6IE1hcmVrIE1hcmN6eWtvd3Nr
aS1Hw7NyZWNraSA8bWFybWFyZWtAaW52aXNpYmxldGhpbmdzbGFiLmNvbT4KLS0tCkknbSBub3Qg
dmVyeSBoYXBweSBhYm91dCBjb2RlIGR1cGxpY2F0aW9uIHJlZ2FyZGluZyBNU0kvTVNJLVgvSU5U
eApleGNsdXNpdml0eSB0ZXN0LCBidXQgSSBkb24ndCBoYXZlIGJldHRlciBpZGVhcyBob3cgdG8g
c3RydWN0dXJlIGl0LiBBbnkKc3VnZ2VzdGlvbnM/Ci0tLQogLi4uL3hlbi94ZW4tcGNpYmFjay9j
b25mX3NwYWNlX2NhcGFiaWxpdHkuYyAgIHwgMTEzICsrKysrKysrKysrKysrKysrKwogZHJpdmVy
cy94ZW4veGVuLXBjaWJhY2svY29uZl9zcGFjZV9oZWFkZXIuYyAgIHwgIDMwICsrKysrCiBkcml2
ZXJzL3hlbi94ZW4tcGNpYmFjay9wY2lfc3R1Yi5jICAgICAgICAgICAgfCAgNjYgKysrKysrKysr
KwogZHJpdmVycy94ZW4veGVuLXBjaWJhY2svcGNpYmFjay5oICAgICAgICAgICAgIHwgICAxICsK
IDQgZmlsZXMgY2hhbmdlZCwgMjEwIGluc2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L3hlbi94ZW4tcGNpYmFjay9jb25mX3NwYWNlX2NhcGFiaWxpdHkuYyBiL2RyaXZlcnMveGVuL3hl
bi1wY2liYWNrL2NvbmZfc3BhY2VfY2FwYWJpbGl0eS5jCmluZGV4IGU1Njk0MTMzZWJlNS4uYzVh
N2M1OGZmM2UzIDEwMDY0NAotLS0gYS9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay9jb25mX3NwYWNl
X2NhcGFiaWxpdHkuYworKysgYi9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay9jb25mX3NwYWNlX2Nh
cGFiaWxpdHkuYwpAQCAtMTg5LDYgKzE4OSwxMDkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb25m
aWdfZmllbGQgY2FwbGlzdF9wbVtdID0gewogCXt9CiB9OwogCitzdGF0aWMgc3RydWN0IG1zaV9t
c2l4X2ZpZWxkX2NvbmZpZyB7CisJdTE2IGVuYWJsZV9iaXQ7ICAvKiBiaXQgZm9yIGVuYWJsaW5n
IE1TSS9NU0ktWCAqLworCWludCBvdGhlcl9jYXA7ICAvKiB0aGUgb3RoZXIgY2FwYWJpbGl0eSBm
b3IgZXhjbHVzaXZlbmVzcyBjaGVjayAqLworfSBtc2lfZmllbGRfY29uZmlnID0geworCS5lbmFi
bGVfYml0ID0gUENJX01TSV9GTEFHU19FTkFCTEUsCisJLm90aGVyX2NhcCA9IFBDSV9DQVBfSURf
TVNJWCwKK30sIG1zaXhfZmllbGRfY29uZmlnID0geworCS5lbmFibGVfYml0ID0gUENJX01TSVhf
RkxBR1NfRU5BQkxFLAorCS5vdGhlcl9jYXAgPSBQQ0lfQ0FQX0lEX01TSSwKK307CisKK3N0YXRp
YyB2b2lkICptc2lfZmllbGRfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LCBpbnQgb2Zmc2V0KQor
eworCXJldHVybiAmbXNpX2ZpZWxkX2NvbmZpZzsKK30KKworc3RhdGljIHZvaWQgKm1zaXhfZmll
bGRfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LCBpbnQgb2Zmc2V0KQoreworCXJldHVybiAmbXNp
eF9maWVsZF9jb25maWc7Cit9CisKK3N0YXRpYyBpbnQgbXNpX21zaXhfZmxhZ3Nfd3JpdGUoc3Ry
dWN0IHBjaV9kZXYgKmRldiwgaW50IG9mZnNldCwgdTE2IG5ld192YWx1ZSwKKwkJCSB2b2lkICpk
YXRhKQoreworCWludCBlcnI7CisJdTE2IG9sZF92YWx1ZTsKKwlzdHJ1Y3QgbXNpX21zaXhfZmll
bGRfY29uZmlnICpmaWVsZF9jb25maWcgPSBkYXRhOworCXN0cnVjdCB4ZW5fcGNpYmtfZGV2X2Rh
dGEgKmRldl9kYXRhID0gcGNpX2dldF9kcnZkYXRhKGRldik7CisJaW50IG90aGVyX2NhcF9vZmZz
ZXQ7CisJdTE2IG90aGVyX2NhcF9lbmFibGVfYml0OworCXUxNiBvdGhlcl9jYXBfdmFsdWU7CisK
KwlpZiAoeGVuX3BjaWJrX3Blcm1pc3NpdmUgfHwgZGV2X2RhdGEtPnBlcm1pc3NpdmUpCisJCWdv
dG8gd3JpdGU7CisKKwllcnIgPSBwY2lfcmVhZF9jb25maWdfd29yZChkZXYsIG9mZnNldCwgJm9s
ZF92YWx1ZSk7CisJaWYgKGVycikKKwkJcmV0dXJuIGVycjsKKworCWlmIChuZXdfdmFsdWUgPT0g
b2xkX3ZhbHVlKQorCQlyZXR1cm4gMDsKKworCWlmICghZGV2X2RhdGEtPmFsbG93X2ludGVycnVw
dF9jb250cm9sIHx8CisJICAgIChuZXdfdmFsdWUgXiBvbGRfdmFsdWUpICYgfmZpZWxkX2NvbmZp
Zy0+ZW5hYmxlX2JpdCkKKwkJcmV0dXJuIFBDSUJJT1NfU0VUX0ZBSUxFRDsKKworCWlmIChuZXdf
dmFsdWUgJiBmaWVsZF9jb25maWctPmVuYWJsZV9iaXQpIHsKKwkJLyogZG9uJ3QgYWxsb3cgZW5h
YmxpbmcgdG9nZXRoZXIgd2l0aCBJTlR4ICovCisJCWVyciA9IHBjaV9yZWFkX2NvbmZpZ193b3Jk
KGRldiwgUENJX0NPTU1BTkQsICZvdGhlcl9jYXBfdmFsdWUpOworCQlpZiAoZXJyKQorCQkJcmV0
dXJuIGVycjsKKwkJaWYgKCEob3RoZXJfY2FwX3ZhbHVlICYgUENJX0NPTU1BTkRfSU5UWF9ESVNB
QkxFKSkKKwkJCXJldHVybiBQQ0lCSU9TX1NFVF9GQUlMRUQ7CisKKwkJLyogYW5kIHRoZSBvdGhl
ciBNU0koLVgpICovCisJCXN3aXRjaCAoZmllbGRfY29uZmlnLT5vdGhlcl9jYXApIHsKKwkJY2Fz
ZSBQQ0lfQ0FQX0lEX01TSToKKwkJCW90aGVyX2NhcF9vZmZzZXQgPSBkZXYtPm1zaV9jYXAgKyBQ
Q0lfTVNJX0ZMQUdTOworCQkJb3RoZXJfY2FwX2VuYWJsZV9iaXQgPSBQQ0lfTVNJX0ZMQUdTX0VO
QUJMRTsKKwkJCWJyZWFrOworCQljYXNlIFBDSV9DQVBfSURfTVNJWDoKKwkJCW90aGVyX2NhcF9v
ZmZzZXQgPSBkZXYtPm1zaXhfY2FwICsgUENJX01TSVhfRkxBR1M7CisJCQlvdGhlcl9jYXBfZW5h
YmxlX2JpdCA9IFBDSV9NU0lYX0ZMQUdTX0VOQUJMRTsKKwkJCWJyZWFrOworCQlkZWZhdWx0Ogor
CQkJQlVHX09OKDEpOworCQl9CisJCWVyciA9IHBjaV9yZWFkX2NvbmZpZ193b3JkKGRldiwKKwkJ
CQkJICAgb3RoZXJfY2FwX29mZnNldCwKKwkJCQkJICAgJm90aGVyX2NhcF92YWx1ZSk7CisJCWlm
IChlcnIpCisJCQlyZXR1cm4gZXJyOworCisJCWlmIChvdGhlcl9jYXBfdmFsdWUgJiBvdGhlcl9j
YXBfZW5hYmxlX2JpdCkKKwkJCXJldHVybiBQQ0lCSU9TX1NFVF9GQUlMRUQ7CisJfQorCit3cml0
ZToKKwlyZXR1cm4gcGNpX3dyaXRlX2NvbmZpZ193b3JkKGRldiwgb2Zmc2V0LCBuZXdfdmFsdWUp
OworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGNvbmZpZ19maWVsZCBjYXBsaXN0X21zaXhbXSA9
IHsKKwl7CisJCS5vZmZzZXQgICAgPSBQQ0lfTVNJWF9GTEFHUywKKwkJLnNpemUgICAgICA9IDIs
CisJCS5pbml0ICAgICAgPSBtc2l4X2ZpZWxkX2luaXQsCisJCS51LncucmVhZCAgPSB4ZW5fcGNp
YmtfcmVhZF9jb25maWdfd29yZCwKKwkJLnUudy53cml0ZSA9IG1zaV9tc2l4X2ZsYWdzX3dyaXRl
LAorCX0sCisJe30KK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY29uZmlnX2ZpZWxkIGNhcGxp
c3RfbXNpW10gPSB7CisJeworCQkub2Zmc2V0ICAgID0gUENJX01TSV9GTEFHUywKKwkJLnNpemUg
ICAgICA9IDIsCisJCS5pbml0ICAgICAgPSBtc2lfZmllbGRfaW5pdCwKKwkJLnUudy5yZWFkICA9
IHhlbl9wY2lia19yZWFkX2NvbmZpZ193b3JkLAorCQkudS53LndyaXRlID0gbXNpX21zaXhfZmxh
Z3Nfd3JpdGUsCisJfSwKKwl7fQorfTsKKwogc3RhdGljIHN0cnVjdCB4ZW5fcGNpYmtfY29uZmln
X2NhcGFiaWxpdHkgeGVuX3BjaWJrX2NvbmZpZ19jYXBhYmlsaXR5X3BtID0gewogCS5jYXBhYmls
aXR5ID0gUENJX0NBUF9JRF9QTSwKIAkuZmllbGRzID0gY2FwbGlzdF9wbSwKQEAgLTE5NywxMSAr
MzAwLDIxIEBAIHN0YXRpYyBzdHJ1Y3QgeGVuX3BjaWJrX2NvbmZpZ19jYXBhYmlsaXR5IHhlbl9w
Y2lia19jb25maWdfY2FwYWJpbGl0eV92cGQgPSB7CiAJLmNhcGFiaWxpdHkgPSBQQ0lfQ0FQX0lE
X1ZQRCwKIAkuZmllbGRzID0gY2FwbGlzdF92cGQsCiB9Oworc3RhdGljIHN0cnVjdCB4ZW5fcGNp
YmtfY29uZmlnX2NhcGFiaWxpdHkgeGVuX3BjaWJrX2NvbmZpZ19jYXBhYmlsaXR5X21zaSA9IHsK
KwkuY2FwYWJpbGl0eSA9IFBDSV9DQVBfSURfTVNJLAorCS5maWVsZHMgPSBjYXBsaXN0X21zaSwK
K307CitzdGF0aWMgc3RydWN0IHhlbl9wY2lia19jb25maWdfY2FwYWJpbGl0eSB4ZW5fcGNpYmtf
Y29uZmlnX2NhcGFiaWxpdHlfbXNpeCA9IHsKKwkuY2FwYWJpbGl0eSA9IFBDSV9DQVBfSURfTVNJ
WCwKKwkuZmllbGRzID0gY2FwbGlzdF9tc2l4LAorfTsKIAogaW50IHhlbl9wY2lia19jb25maWdf
Y2FwYWJpbGl0eV9pbml0KHZvaWQpCiB7CiAJcmVnaXN0ZXJfY2FwYWJpbGl0eSgmeGVuX3BjaWJr
X2NvbmZpZ19jYXBhYmlsaXR5X3ZwZCk7CiAJcmVnaXN0ZXJfY2FwYWJpbGl0eSgmeGVuX3BjaWJr
X2NvbmZpZ19jYXBhYmlsaXR5X3BtKTsKKwlyZWdpc3Rlcl9jYXBhYmlsaXR5KCZ4ZW5fcGNpYmtf
Y29uZmlnX2NhcGFiaWxpdHlfbXNpKTsKKwlyZWdpc3Rlcl9jYXBhYmlsaXR5KCZ4ZW5fcGNpYmtf
Y29uZmlnX2NhcGFiaWxpdHlfbXNpeCk7CiAKIAlyZXR1cm4gMDsKIH0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMveGVuL3hlbi1wY2liYWNrL2NvbmZfc3BhY2VfaGVhZGVyLmMgYi9kcml2ZXJzL3hlbi94
ZW4tcGNpYmFjay9jb25mX3NwYWNlX2hlYWRlci5jCmluZGV4IDEwYWUyNGI1YTc2ZS4uMWUwZmZm
MDJlMjFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay9jb25mX3NwYWNlX2hl
YWRlci5jCisrKyBiL2RyaXZlcnMveGVuL3hlbi1wY2liYWNrL2NvbmZfc3BhY2VfaGVhZGVyLmMK
QEAgLTY0LDYgKzY0LDcgQEAgc3RhdGljIGludCBjb21tYW5kX3dyaXRlKHN0cnVjdCBwY2lfZGV2
ICpkZXYsIGludCBvZmZzZXQsIHUxNiB2YWx1ZSwgdm9pZCAqZGF0YSkKIAlpbnQgZXJyOwogCXUx
NiB2YWw7CiAJc3RydWN0IHBjaV9jbWRfaW5mbyAqY21kID0gZGF0YTsKKwl1MTYgY2FwX3ZhbHVl
OwogCiAJZGV2X2RhdGEgPSBwY2lfZ2V0X2RydmRhdGEoZGV2KTsKIAlpZiAoIXBjaV9pc19lbmFi
bGVkKGRldikgJiYgaXNfZW5hYmxlX2NtZCh2YWx1ZSkpIHsKQEAgLTExNyw2ICsxMTgsMzUgQEAg
c3RhdGljIGludCBjb21tYW5kX3dyaXRlKHN0cnVjdCBwY2lfZGV2ICpkZXYsIGludCBvZmZzZXQs
IHUxNiB2YWx1ZSwgdm9pZCAqZGF0YSkKIAkJcGNpX2NsZWFyX213aShkZXYpOwogCX0KIAorCWlm
IChkZXZfZGF0YSAmJiBkZXZfZGF0YS0+YWxsb3dfaW50ZXJydXB0X2NvbnRyb2wpIHsKKwkJaWYg
KCEoY21kLT52YWwgJiBQQ0lfQ09NTUFORF9JTlRYX0RJU0FCTEUpICYmCisJCSAgICAodmFsdWUg
JiBQQ0lfQ09NTUFORF9JTlRYX0RJU0FCTEUpKSB7CisJCQlwY2lfaW50eChkZXYsIDApOworCQl9
IGVsc2UgaWYgKChjbWQtPnZhbCAmIFBDSV9DT01NQU5EX0lOVFhfRElTQUJMRSkgJiYKKwkJICAg
ICEodmFsdWUgJiBQQ0lfQ09NTUFORF9JTlRYX0RJU0FCTEUpKSB7CisJCQkvKiBEbyBub3QgYWxs
b3cgZW5hYmxpbmcgSU5UeCB0b2dldGhlciB3aXRoIE1TSSBvciBNU0ktWC4gKi8KKwkJCS8qIERv
IG5vdCB0cnVzdCBkZXYtPm1zaSh4KV9lbmFibGVkIGhlcmUsIGFzIGVuYWJsaW5nIGNvdWxkIGJl
IGRvbmUKKwkJCSAqIGJ5cGFzc2luZyB0aGUgcGNpXyptc2kqIGZ1bmN0aW9ucywgYnkgdGhlIHFl
bXUuCisJCQkgKi8KKwkJCWVyciA9IHBjaV9yZWFkX2NvbmZpZ193b3JkKGRldiwKKwkJCQkJCSAg
IGRldi0+bXNpX2NhcCArIFBDSV9NU0lfRkxBR1MsCisJCQkJCQkgICAmY2FwX3ZhbHVlKTsKKwkJ
CWlmICghZXJyICYmIChjYXBfdmFsdWUgJiBQQ0lfTVNJX0ZMQUdTX0VOQUJMRSkpCisJCQkJZXJy
ID0gLUVCVVNZOworCQkJaWYgKCFlcnIpCisJCQkJZXJyID0gcGNpX3JlYWRfY29uZmlnX3dvcmQo
ZGV2LAorCQkJCQkJCSAgIGRldi0+bXNpeF9jYXAgKyBQQ0lfTVNJWF9GTEFHUywKKwkJCQkJCQkg
ICAmY2FwX3ZhbHVlKTsKKwkJCWlmICghZXJyICYmIChjYXBfdmFsdWUgJiBQQ0lfTVNJWF9GTEFH
U19FTkFCTEUpKQorCQkJCWVyciA9IC1FQlVTWTsKKwkJCWlmIChlcnIpCisJCQkJcHJfd2Fybigi
JXM6IGNhbm5vdCBlbmFibGUgSU5UeCAoJWQpXG4iLAorCQkJCQlwY2lfbmFtZShkZXYpLCBlcnIp
OworCQkJZWxzZQorCQkJCXBjaV9pbnR4KGRldiwgMSk7CisJCX0KKwl9CisKIAljbWQtPnZhbCA9
IHZhbHVlOwogCiAJaWYgKCF4ZW5fcGNpYmtfcGVybWlzc2l2ZSAmJiAoIWRldl9kYXRhIHx8ICFk
ZXZfZGF0YS0+cGVybWlzc2l2ZSkpCmRpZmYgLS1naXQgYS9kcml2ZXJzL3hlbi94ZW4tcGNpYmFj
ay9wY2lfc3R1Yi5jIGIvZHJpdmVycy94ZW4veGVuLXBjaWJhY2svcGNpX3N0dWIuYwppbmRleCAw
OTc0MTBhN2NkYjcuLjdhZjkzZDY1ZWQ1MSAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4veGVuLXBj
aWJhY2svcGNpX3N0dWIuYworKysgYi9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay9wY2lfc3R1Yi5j
CkBAIC0zMDQsNiArMzA0LDggQEAgdm9pZCBwY2lzdHViX3B1dF9wY2lfZGV2KHN0cnVjdCBwY2lf
ZGV2ICpkZXYpCiAJeGVuX3BjaWJrX2NvbmZpZ19yZXNldF9kZXYoZGV2KTsKIAl4ZW5fcGNpYmtf
Y29uZmlnX2ZyZWVfZHluX2ZpZWxkcyhkZXYpOwogCisJZGV2X2RhdGEtPmFsbG93X2ludGVycnVw
dF9jb250cm9sID0gMDsKKwogCXhlbl91bnJlZ2lzdGVyX2RldmljZV9kb21haW5fb3duZXIoZGV2
KTsKIAogCXNwaW5fbG9ja19pcnFzYXZlKCZmb3VuZF9wc2Rldi0+bG9jaywgZmxhZ3MpOwpAQCAt
MTQzMSw2ICsxNDMzLDY1IEBAIHN0YXRpYyBzc2l6ZV90IHBlcm1pc3NpdmVfc2hvdyhzdHJ1Y3Qg
ZGV2aWNlX2RyaXZlciAqZHJ2LCBjaGFyICpidWYpCiB9CiBzdGF0aWMgRFJJVkVSX0FUVFJfUlco
cGVybWlzc2l2ZSk7CiAKK3N0YXRpYyBzc2l6ZV90IGFsbG93X2ludGVycnVwdF9jb250cm9sX3N0
b3JlKHN0cnVjdCBkZXZpY2VfZHJpdmVyICpkcnYsCisJCQkJCSAgICAgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgY291bnQpCit7CisJaW50IGRvbWFpbiwgYnVzLCBzbG90LCBmdW5jOworCWludCBl
cnI7CisJc3RydWN0IHBjaXN0dWJfZGV2aWNlICpwc2RldjsKKwlzdHJ1Y3QgeGVuX3BjaWJrX2Rl
dl9kYXRhICpkZXZfZGF0YTsKKworCWVyciA9IHN0cl90b19zbG90KGJ1ZiwgJmRvbWFpbiwgJmJ1
cywgJnNsb3QsICZmdW5jKTsKKwlpZiAoZXJyKQorCQlnb3RvIG91dDsKKworCXBzZGV2ID0gcGNp
c3R1Yl9kZXZpY2VfZmluZChkb21haW4sIGJ1cywgc2xvdCwgZnVuYyk7CisJaWYgKCFwc2Rldikg
eworCQllcnIgPSAtRU5PREVWOworCQlnb3RvIG91dDsKKwl9CisKKwlkZXZfZGF0YSA9IHBjaV9n
ZXRfZHJ2ZGF0YShwc2Rldi0+ZGV2KTsKKwkvKiB0aGUgZHJpdmVyIGRhdGEgZm9yIGEgZGV2aWNl
IHNob3VsZCBuZXZlciBiZSBudWxsIGF0IHRoaXMgcG9pbnQgKi8KKwlpZiAoIWRldl9kYXRhKSB7
CisJCWVyciA9IC1FTlhJTzsKKwkJZ290byByZWxlYXNlOworCX0KKwlkZXZfZGF0YS0+YWxsb3df
aW50ZXJydXB0X2NvbnRyb2wgPSAxOworcmVsZWFzZToKKwlwY2lzdHViX2RldmljZV9wdXQocHNk
ZXYpOworb3V0OgorCWlmICghZXJyKQorCQllcnIgPSBjb3VudDsKKwlyZXR1cm4gZXJyOworfQor
CitzdGF0aWMgc3NpemVfdCBhbGxvd19pbnRlcnJ1cHRfY29udHJvbF9zaG93KHN0cnVjdCBkZXZp
Y2VfZHJpdmVyICpkcnYsCisJCQkJCSAgICBjaGFyICpidWYpCit7CisJc3RydWN0IHBjaXN0dWJf
ZGV2aWNlICpwc2RldjsKKwlzdHJ1Y3QgeGVuX3BjaWJrX2Rldl9kYXRhICpkZXZfZGF0YTsKKwlz
aXplX3QgY291bnQgPSAwOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJx
c2F2ZSgmcGNpc3R1Yl9kZXZpY2VzX2xvY2ssIGZsYWdzKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5
KHBzZGV2LCAmcGNpc3R1Yl9kZXZpY2VzLCBkZXZfbGlzdCkgeworCQlpZiAoY291bnQgPj0gUEFH
RV9TSVpFKQorCQkJYnJlYWs7CisJCWlmICghcHNkZXYtPmRldikKKwkJCWNvbnRpbnVlOworCQlk
ZXZfZGF0YSA9IHBjaV9nZXRfZHJ2ZGF0YShwc2Rldi0+ZGV2KTsKKwkJaWYgKCFkZXZfZGF0YSB8
fCAhZGV2X2RhdGEtPmFsbG93X2ludGVycnVwdF9jb250cm9sKQorCQkJY29udGludWU7CisJCWNv
dW50ICs9CisJCSAgICBzY25wcmludGYoYnVmICsgY291bnQsIFBBR0VfU0laRSAtIGNvdW50LCAi
JXNcbiIsCisJCQkgICAgICBwY2lfbmFtZShwc2Rldi0+ZGV2KSk7CisJfQorCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJnBjaXN0dWJfZGV2aWNlc19sb2NrLCBmbGFncyk7CisJcmV0dXJuIGNvdW50
OworfQorc3RhdGljIERSSVZFUl9BVFRSX1JXKGFsbG93X2ludGVycnVwdF9jb250cm9sKTsKKwog
c3RhdGljIHZvaWQgcGNpc3R1Yl9leGl0KHZvaWQpCiB7CiAJZHJpdmVyX3JlbW92ZV9maWxlKCZ4
ZW5fcGNpYmtfcGNpX2RyaXZlci5kcml2ZXIsICZkcml2ZXJfYXR0cl9uZXdfc2xvdCk7CkBAIC0x
NDQwLDYgKzE1MDEsOCBAQCBzdGF0aWMgdm9pZCBwY2lzdHViX2V4aXQodm9pZCkKIAlkcml2ZXJf
cmVtb3ZlX2ZpbGUoJnhlbl9wY2lia19wY2lfZHJpdmVyLmRyaXZlciwgJmRyaXZlcl9hdHRyX3F1
aXJrcyk7CiAJZHJpdmVyX3JlbW92ZV9maWxlKCZ4ZW5fcGNpYmtfcGNpX2RyaXZlci5kcml2ZXIs
CiAJCQkgICAmZHJpdmVyX2F0dHJfcGVybWlzc2l2ZSk7CisJZHJpdmVyX3JlbW92ZV9maWxlKCZ4
ZW5fcGNpYmtfcGNpX2RyaXZlci5kcml2ZXIsCisJCQkgICAmZHJpdmVyX2F0dHJfYWxsb3dfaW50
ZXJydXB0X2NvbnRyb2wpOwogCWRyaXZlcl9yZW1vdmVfZmlsZSgmeGVuX3BjaWJrX3BjaV9kcml2
ZXIuZHJpdmVyLAogCQkJICAgJmRyaXZlcl9hdHRyX2lycV9oYW5kbGVycyk7CiAJZHJpdmVyX3Jl
bW92ZV9maWxlKCZ4ZW5fcGNpYmtfcGNpX2RyaXZlci5kcml2ZXIsCkBAIC0xNTMwLDYgKzE1OTMs
OSBAQCBzdGF0aWMgaW50IF9faW5pdCBwY2lzdHViX2luaXQodm9pZCkKIAlpZiAoIWVycikKIAkJ
ZXJyID0gZHJpdmVyX2NyZWF0ZV9maWxlKCZ4ZW5fcGNpYmtfcGNpX2RyaXZlci5kcml2ZXIsCiAJ
CQkJCSAmZHJpdmVyX2F0dHJfcGVybWlzc2l2ZSk7CisJaWYgKCFlcnIpCisJCWVyciA9IGRyaXZl
cl9jcmVhdGVfZmlsZSgmeGVuX3BjaWJrX3BjaV9kcml2ZXIuZHJpdmVyLAorCQkJCQkgJmRyaXZl
cl9hdHRyX2FsbG93X2ludGVycnVwdF9jb250cm9sKTsKIAogCWlmICghZXJyKQogCQllcnIgPSBk
cml2ZXJfY3JlYXRlX2ZpbGUoJnhlbl9wY2lia19wY2lfZHJpdmVyLmRyaXZlciwKZGlmZiAtLWdp
dCBhL2RyaXZlcnMveGVuL3hlbi1wY2liYWNrL3BjaWJhY2suaCBiL2RyaXZlcnMveGVuL3hlbi1w
Y2liYWNrL3BjaWJhY2suaAppbmRleCAyNjNjMDU5YmZmOTAuLmNlMTA3N2UzMjQ2NiAxMDA2NDQK
LS0tIGEvZHJpdmVycy94ZW4veGVuLXBjaWJhY2svcGNpYmFjay5oCisrKyBiL2RyaXZlcnMveGVu
L3hlbi1wY2liYWNrL3BjaWJhY2suaApAQCAtNDUsNiArNDUsNyBAQCBzdHJ1Y3QgeGVuX3BjaWJr
X2Rldl9kYXRhIHsKIAlzdHJ1Y3QgbGlzdF9oZWFkIGNvbmZpZ19maWVsZHM7CiAJc3RydWN0IHBj
aV9zYXZlZF9zdGF0ZSAqcGNpX3NhdmVkX3N0YXRlOwogCXVuc2lnbmVkIGludCBwZXJtaXNzaXZl
OjE7CisJdW5zaWduZWQgaW50IGFsbG93X2ludGVycnVwdF9jb250cm9sOjE7CiAJdW5zaWduZWQg
aW50IHdhcm5lZF9vbl93cml0ZToxOwogCXVuc2lnbmVkIGludCBlbmFibGVfaW50eDoxOwogCXVu
c2lnbmVkIGludCBpc3Jfb246MTsgLyogV2hldGhlciB0aGUgSVJRIGhhbmRsZXIgaXMgaW5zdGFs
bGVkLiAqLwotLSAKMi4yMS4wCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJv
amVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hl
bi1kZXZlbA==

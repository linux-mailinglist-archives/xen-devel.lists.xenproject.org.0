Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 00D0A112A58
	for <lists+xen-devel@lfdr.de>; Wed,  4 Dec 2019 12:39:00 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1icSvi-0006Ny-Vg; Wed, 04 Dec 2019 11:34:50 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=SvPU=Z2=amazon.com=prvs=23428832f=sjpark@srs-us1.protection.inumbo.net>)
 id 1icSvh-0006Nt-UO
 for xen-devel@lists.xenproject.org; Wed, 04 Dec 2019 11:34:49 +0000
X-Inumbo-ID: 1491cada-168a-11ea-8202-12813bfff9fa
Received: from smtp-fw-4101.amazon.com (unknown [72.21.198.25])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 1491cada-168a-11ea-8202-12813bfff9fa;
 Wed, 04 Dec 2019 11:34:49 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
 t=1575459290; x=1606995290;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=l9KPO+RfCo20qWXXb2Nj9NKT03YEvDC09jO2n9eHTpU=;
 b=cKDhii0KnRKwT3QLdnvKtqiWzVTzH59dzuWOJHMSG3UXoYcrcPoR6VL7
 jnBY+6qJcTcM/n2sz9e56z8oNBlMRV4dE4MrK/o8b0JXykXMBNapkEjKu
 gsqsDrBdeYRyH0P5CpGLJDP7UlSeyvtrLPYzAMr3NhXJOb7rRnMAsqr6D M=;
IronPort-SDR: viKll6ecnooPrmUshSbgKArxk+zTotTLwmPFV/Wv/PkUGPV6L9xCUelo4wLNJXlMTz/omLid4V
 /zTdHD3WM+lw==
X-IronPort-AV: E=Sophos;i="5.69,277,1571702400"; 
   d="scan'208";a="7009075"
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-4101.iad4.amazon.com with ESMTP;
 04 Dec 2019 11:34:45 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com (Postfix) with ESMTPS
 id 18111C0C8E; Wed,  4 Dec 2019 11:34:42 +0000 (UTC)
Received: from EX13D31EUA004.ant.amazon.com (10.43.165.161) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Wed, 4 Dec 2019 11:34:42 +0000
Received: from u886c93fd17d25d.ant.amazon.com (10.43.162.249) by
 EX13D31EUA004.ant.amazon.com (10.43.165.161) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Wed, 4 Dec 2019 11:34:38 +0000
From: SeongJae Park <sjpark@amazon.com>
To: <konrad.wilk@oracle.com>, <roger.pau@citrix.com>, <axboe@kernel.dk>
Date: Wed, 4 Dec 2019 12:34:18 +0100
Message-ID: <20191204113419.2298-2-sjpark@amazon.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191204113419.2298-1-sjpark@amazon.com>
References: <20191204113419.2298-1-sjpark@amazon.com>
MIME-Version: 1.0
X-Originating-IP: [10.43.162.249]
X-ClientProxiedBy: EX13D21UWB003.ant.amazon.com (10.43.161.212) To
 EX13D31EUA004.ant.amazon.com (10.43.165.161)
Precedence: Bulk
Subject: [Xen-devel] [PATCH 1/2] xen/blkback: Aggressively shrink page pools
 if a memory pressure is detected
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: sj38.park@gmail.com, xen-devel@lists.xenproject.org,
 linux-block@vger.kernel.org, linux-kernel@vger.kernel.org,
 SeongJae Park <sjpark@amazon.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogU2VvbmdKYWUgUGFyayA8c2pwYXJrQGFtYXpvbi5kZT4KCkVhY2ggYGJsa2lmYCBoYXMg
YSBmcmVlIHBhZ2VzIHBvb2wgZm9yIHRoZSBncmFudCBtYXBwaW5nLiAgVGhlIHNpemUgb2YKdGhl
IHBvb2wgc3RhcnRzIGZyb20gemVybyBhbmQgYmUgaW5jcmVhc2VkIG9uIGRlbWFuZCB3aGlsZSBw
cm9jZXNzaW5nCnRoZSBJL08gcmVxdWVzdHMuICBJZiBjdXJyZW50IEkvTyByZXF1ZXN0cyBoYW5k
bGluZyBpcyBmaW5pc2hlZCBvciAxMDAKbWlsbGlzZWNvbmRzIGhhcyBwYXNzZWQgc2luY2UgbGFz
dCBJL08gcmVxdWVzdHMgaGFuZGxpbmcsIGl0IGNoZWNrcyBhbmQKc2hyaW5rcyB0aGUgcG9vbCB0
byBub3QgZXhjZWVkIHRoZSBzaXplIGxpbWl0LCBgbWF4X2J1ZmZlcl9wYWdlc2AuCgpUaGVyZWZv
cmUsIGBibGtmcm9udGAgcnVubmluZyBndWVzdHMgY2FuIGNhdXNlIGEgbWVtb3J5IHByZXNzdXJl
IGluIHRoZQpgYmxrYmFja2AgcnVubmluZyBndWVzdCBieSBhdHRhY2hpbmcgYXJiaXRyYXJpbHkg
bGFyZ2UgbnVtYmVyIG9mIGJsb2NrCmRldmljZXMgYW5kIGluZHVjaW5nIEkvTy4gIFRoaXMgY29t
bWl0IGF2b2lkcyBzdWNoIHByb2JsZW1hdGljCnNpdHVhdGlvbnMgYnkgc2hyaW5raW5nIHRoZSBw
b29scyBhZ2dyZXNzaXZlbHkgKGZ1cnRoZXIgdGhlIGxpbWl0KSBmb3IgYQp3aGlsZSAob25lIG1p
bGxpc2Vjb25kKSBpZiBhIG1lbW9yeSBwcmVzc3VyZSBpcyBkZXRlY3RlZC4KCkRpc2N1c3Npb25z
Cj09PT09PT09PT09CgpUaGUgc2hyaW5raW5nIG1lY2hhbmlzbSByZXR1cm5zIG9ubHkgcGFnZXMg
aW4gdGhlIHBvb2wgd2hpY2ggYXJlIG5vdApjdXJyZW50bHkgYmUgdXNlZCBieSBibGtiYWNrLiAg
SW4gb3RoZXIgd29yZHMsIHRoZSBwYWdlcyB0aGF0IHdpbGwgYmUKc2hydW5rIGFyZSBub3QgbWFw
cGVkIHdpdGggZm9yZWlnbiBwYWdlcy4gIEJlY2F1c2UgdGhpcyBjb21taXQgaXMKY2hhbmdpbmcg
b25seSB0aGUgc2hyaW5rIGxpbWl0IGJ1dCB1c2VzIHRoZSBzaHJpbmtpbmcgbWVjaGFuaXNtIGFz
IGlzLAp0aGlzIGNvbW1pdCBkb2VzIG5vdCBpbnRyb2R1Y2Ugc2VjdXJpdHkgaXNzdWVzIHN1Y2gg
YXMgaW1wcm9wZXIKdW5tYXBwaW5ncy4KClRoaXMgY29tbWl0IGtlZXBzIHRoZSBhZ2dyZXNzaXZl
IHNocmlua2luZyBsaW1pdCBmb3Igb25lIG1pbGlzZWNvbmQgZnJvbQpsYXN0IG1lbW9yeSBwcmVz
c3VyZSBkZXRlY3RlZCB0aW1lLiAgVGhlIGR1cmF0aW9uIHNob3VsZCBiZSBuZWl0aGVyIHRvbwpz
aG9ydCBub3IgdG9vIGxvbmcuICBJZiBpdCBpcyB0b28gbG9uZywgZnJlZSBwYWdlcyBwb29sIHNo
cmlua2luZwpvdmVyaGVhZCBjYW4gcmVkdWNlIHRoZSBJL08gcGVyZm9ybWFuY2UuICBJZiBpdCBp
cyB0b28gc2hvcnQsIGJsa2JhY2sKd2lsbCBub3QgZnJlZSBlbm91Z2ggcGFnZXMgdG8gcmVkdWNl
IHRoZSBtZW1vcnkgcHJlc3N1cmUuICBJIGJlbGlldmUKdGhhdCBvbmUgbWlsbGlzZWNvbmQgaXMg
YSBzaG9ydCBkdXJhdGlvbiBpbiB0ZXJtcyBvZiBJL08gd2hpbGUgaXQgaXMgYQpsb25nIGR1cmF0
aW9uIGluIHRlcm1zIG9mIG1lbW9yeSBvcGVyYXRpb25zLiAgQWxzbywgYXMgdGhlIG9yaWdpbmFs
CnNocmlua2luZyBtZWNoYW5pc20gd29ya3MgZm9yIGV2ZXJ5IDEwMCBtaWxsaXNlY29uZHMsIHRo
aXMgMSBtaWxsaXNlY29uZApjb3VsZCBiZSBhIHNvbWV3aGF0IHJlYXNvbmFibGUgY2hvaWNlLiAg
QWxzbywgdGhpcyBkdXJhdGlvbiB3b3JrZWQgd2VsbApmb3Igb3VyIHRlc3RpbmcgZW52aXJvbm1l
bnQgc2ltdWxhdGluZyB0aGUgbWVtb3J5IHByZXNzdXJlIHNpdHVhdGlvbgood2lsbCBiZSBkZXNj
cmliZWQgaW4gZGV0YWlsIGJlbG93KS4KCk1lbW9yeSBQcmVzc3VyZSBUZXN0Cj09PT09PT09PT09
PT09PT09PT09CgpUbyBzaG93IHdoZXRoZXIgdGhpcyBjb21taXQgZml4ZXMgdGhlIGFib3ZlIG1l
bnRpb25lZCBtZW1vcnkgcHJlc3N1cmUKc2l0dWF0aW9uIHdlbGwsIEkgY29uZmlndXJlZCBhIHRl
c3QgZW52aXJvbm1lbnQuICBPbiB0aGUgYGJsa2Zyb250YApydW5uaW5nIGd1ZXN0IGluc3RhbmNl
cyBvZiBhIHZpcnR1YWxpemVkIGVudmlyb25tZW50LCBJIGF0dGFjaAphcmJpdHJhcmlseSBsYXJn
ZSBudW1iZXIgb2YgbmV0d29yay1iYWNrZWQgdm9sdW1lIGRldmljZXMgYW5kIGluZHVjZSBJL08K
dG8gdGhvc2UuICBNZWFud2hpbGUsIEkgbWVhc3VyZSB0aGUgbnVtYmVyIG9mIHBhZ2VzIHRoYXQg
c3dhcHBlZCBpbiBhbmQKb3V0IG9uIHRoZSBgYmxrYmFja2AgcnVubmluZyBndWVzdC4gIFRoZSB0
ZXN0IHJhbiB0d2ljZSwgb25jZSBmb3IgdGhlCmBibGtiYWNrYCBiZWZvcmUgdGhpcyBjb21taXQg
YW5kIG9uY2UgZm9yIHRoYXQgYWZ0ZXIgdGhpcyBjb21taXQuCgpSb3VnaGx5IHNwZWFraW5nLCB0
aGlzIGNvbW1pdCBoYXMgcmVkdWNlZCB0aG9zZSBudW1iZXJzIDEzMHggKHBzd3BpbikKYW5kIDM0
eCAocHN3cG91dCkgYXMgYmVsb3c6CgogICAgCQlwc3dwaW4JcHN3cG91dAogICAgYmVmb3JlCTc2
LDY3MgkxODUsNzk5CiAgICBhZnRlcgkgICA1ODcJICA1LDQwMgoKUGVyZm9ybWFuY2UgT3Zlcmhl
YWQgVGVzdAo9PT09PT09PT09PT09PT09PT09PT09PT09CgpUaGlzIGNvbW1pdCBjb3VsZCBpbmN1
ciBJL08gcGVyZm9ybWFuY2UgZGVncmFkYXRpb24gdW5kZXIgbWVtb3J5CnByZXNzdXJlIGJlY2F1
c2UgdGhlIGFnZ3Jlc3NpdmUgc2hyaW5raW5nIHdpbGwgcmVxdWlyZSBtb3JlIHBhZ2UKYWxsb2Nh
dGlvbnMuICBUbyBzaG93IHRoZSBvdmVyaGVhZCwgSSBhcnRpZmljaWFsbHkgbWFkZSBhbiBhZ2dy
ZXNzaXZlCnBhZ2VzIHBvb2wgc2hyaW5raW5nIHNpdHVhdGlvbiBhbmQgbWVhc3VyZWQgdGhlIEkv
TyBwZXJmb3JtYW5jZSBvZiBhCmBibGtmcm9udGAgcnVubmluZyBndWVzdC4KCkZvciB0aGUgYXJ0
aWZpY2lhbCBzaHJpbmtpbmcsIEkgc2V0IHRoZSBgYmxrYmFjay5tYXhfYnVmZmVyX3BhZ2VzYCB1
c2luZwp0aGUgYC9zeXMvbW9kdWxlL3hlbl9ibGtiYWNrL3BhcmFtZXRlcnMvbWF4X2J1ZmZlcl9w
YWdlc2AgZmlsZS4gIFdlIHNldAp0aGUgdmFsdWUgdG8gYDEwMjRgIGFuZCBgMGAuICBUaGUgYDEw
MjRgIGlzIHRoZSBkZWZhdWx0IHZhbHVlLiAgU2V0dGluZwp0aGUgdmFsdWUgYXMgYDBgIGluY3Vy
cyB0aGUgd29yc3QtY2FzZSBhZ2dyZXNzaXZlIHNocmlua2luZyBzdHJlc3MuCgpGb3IgdGhlIEkv
TyBwZXJmb3JtYW5jZSBtZWFzdXJlbWVudCwgSSB1c2UgYSBzaW1wbGUgYGRkYCBjb21tYW5kLgoK
RGVmYXVsdCBQZXJmb3JtYW5jZQotLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgW2RvbTBdIyBlY2hv
IDEwMjQgPiAgL3N5cy9tb2R1bGUveGVuX2Jsa2JhY2svcGFyYW1ldGVycy9tYXhfYnVmZmVyX3Bh
Z2VzCiAgICBbaW5zdGFuY2VdJCBmb3IgaSBpbiB7MS4uNX07IGRvIGRkIGlmPS9kZXYvemVybyBv
Zj1maWxlIGJzPTRrIGNvdW50PSQoKDI1Nio1MTIpKTsgc3luYzsgZG9uZQogICAgMTMxMDcyKzAg
cmVjb3JkcyBpbgogICAgMTMxMDcyKzAgcmVjb3JkcyBvdXQKICAgIDUzNjg3MDkxMiBieXRlcyAo
NTM3IE1CKSBjb3BpZWQsIDExLjcyNTcgcywgNDUuOCBNQi9zCiAgICAxMzEwNzIrMCByZWNvcmRz
IGluCiAgICAxMzEwNzIrMCByZWNvcmRzIG91dAogICAgNTM2ODcwOTEyIGJ5dGVzICg1MzcgTUIp
IGNvcGllZCwgMTMuODgyNyBzLCAzOC43IE1CL3MKICAgIDEzMTA3MiswIHJlY29yZHMgaW4KICAg
IDEzMTA3MiswIHJlY29yZHMgb3V0CiAgICA1MzY4NzA5MTIgYnl0ZXMgKDUzNyBNQikgY29waWVk
LCAxMy44NzgxIHMsIDM4LjcgTUIvcwogICAgMTMxMDcyKzAgcmVjb3JkcyBpbgogICAgMTMxMDcy
KzAgcmVjb3JkcyBvdXQKICAgIDUzNjg3MDkxMiBieXRlcyAoNTM3IE1CKSBjb3BpZWQsIDEzLjg3
MzcgcywgMzguNyBNQi9zCiAgICAxMzEwNzIrMCByZWNvcmRzIGluCiAgICAxMzEwNzIrMCByZWNv
cmRzIG91dAogICAgNTM2ODcwOTEyIGJ5dGVzICg1MzcgTUIpIGNvcGllZCwgMTMuODcwMiBzLCAz
OC43IE1CL3MKCldvcnN0LWNhc2UgUGVyZm9ybWFuY2UKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoK
ICAgIFtkb20wXSMgZWNobyAwID4gIC9zeXMvbW9kdWxlL3hlbl9ibGtiYWNrL3BhcmFtZXRlcnMv
bWF4X2J1ZmZlcl9wYWdlcwogICAgW2luc3RhbmNlXSQgZm9yIGkgaW4gezEuLjV9OyBkbyBkZCBp
Zj0vZGV2L3plcm8gb2Y9ZmlsZSBicz00ayBjb3VudD0kKCgyNTYqNTEyKSk7IHN5bmM7IGRvbmUK
ICAgIDEzMTA3MiswIHJlY29yZHMgaW4KICAgIDEzMTA3MiswIHJlY29yZHMgb3V0CiAgICA1MzY4
NzA5MTIgYnl0ZXMgKDUzNyBNQikgY29waWVkLCAxMS43MjU3IHMsIDQ1LjggTUIvcwogICAgMTMx
MDcyKzAgcmVjb3JkcyBpbgogICAgMTMxMDcyKzAgcmVjb3JkcyBvdXQKICAgIDUzNjg3MDkxMiBi
eXRlcyAoNTM3IE1CKSBjb3BpZWQsIDEzLjg3OCBzLCAzOC43IE1CL3MKICAgIDEzMTA3MiswIHJl
Y29yZHMgaW4KICAgIDEzMTA3MiswIHJlY29yZHMgb3V0CiAgICA1MzY4NzA5MTIgYnl0ZXMgKDUz
NyBNQikgY29waWVkLCAxMy44NzQ2IHMsIDM4LjcgTUIvcwogICAgMTMxMDcyKzAgcmVjb3JkcyBp
bgogICAgMTMxMDcyKzAgcmVjb3JkcyBvdXQKICAgIDUzNjg3MDkxMiBieXRlcyAoNTM3IE1CKSBj
b3BpZWQsIDEzLjg3ODYgcywgMzguNyBNQi9zCiAgICAxMzEwNzIrMCByZWNvcmRzIGluCiAgICAx
MzEwNzIrMCByZWNvcmRzIG91dAogICAgNTM2ODcwOTEyIGJ5dGVzICg1MzcgTUIpIGNvcGllZCwg
MTMuODc0OSBzLCAzOC43IE1CL3MKCkluIHNob3J0LCBldmVuIHdvcnN0IGNhc2UgYWdncmVzc2l2
ZSBwb29scyBzaHJpbmtpbmcgbWFrZXMgbm8gdmlzaWJsZQpwZXJmb3JtYW5jZSBkZWdyYWRhdGlv
bi4gIEkgdGhpbmsgdGhpcyBpcyBkdWUgdG8gdGhlIHNsb3cgc3BlZWQgb2YgdGhlCkkvTy4gIElu
IG90aGVyIHdvcmRzLCB0aGUgYWRkaXRpb25hbCBwYWdlIGFsbG9jYXRpb24gb3ZlcmhlYWQgaXMg
aGlkZGVuCnVuZGVyIHRoZSBtdWNoIHNsb3dlciBJL08gdGltZS4KClNpZ25lZC1vZmYtYnk6IFNl
b25nSmFlIFBhcmsgPHNqcGFya0BhbWF6b24uZGU+Ci0tLQogZHJpdmVycy9ibG9jay94ZW4tYmxr
YmFjay9ibGtiYWNrLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxl
IGNoYW5nZWQsIDI5IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ibG9jay94ZW4tYmxrYmFjay9ibGtiYWNrLmMgYi9kcml2ZXJzL2Jsb2NrL3hlbi1i
bGtiYWNrL2Jsa2JhY2suYwppbmRleCAzNjY2YWZhNjM5ZDEuLmFhMWExMjcwOTNlNSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ibG9jay94ZW4tYmxrYmFjay9ibGtiYWNrLmMKKysrIGIvZHJpdmVycy9i
bG9jay94ZW4tYmxrYmFjay9ibGtiYWNrLmMKQEAgLTEzNSw2ICsxMzUsMjcgQEAgbW9kdWxlX3Bh
cmFtKGxvZ19zdGF0cywgaW50LCAwNjQ0KTsKIC8qIE51bWJlciBvZiBmcmVlIHBhZ2VzIHRvIHJl
bW92ZSBvbiBlYWNoIGNhbGwgdG8gZ250dGFiX2ZyZWVfcGFnZXMgKi8KICNkZWZpbmUgTlVNX0JB
VENIX0ZSRUVfUEFHRVMgMTAKIAorLyoKKyAqIE9uY2UgYSBtZW1vcnkgcHJlc3N1cmUgaXMgZGV0
ZWN0ZWQsIGtlZXAgYWdncmVzc2l2ZSBzaHJpbmtpbmcgb2YgdGhlIGZyZWUKKyAqIHBhZ2UgcG9v
bHMgZm9yIHRoaXMgdGltZSAobXNlYykKKyAqLworI2RlZmluZSBBR0dSRVNTSVZFX1NIUklOS0lO
R19EVVJBVElPTgkxCisKK3N0YXRpYyB1bnNpZ25lZCBsb25nIHhlbl9ibGtfbWVtX3ByZXNzdXJl
X2VuZDsKKworc3RhdGljIHVuc2lnbmVkIGxvbmcgYmxraWZfc2hyaW5rX2NvdW50KHN0cnVjdCBz
aHJpbmtlciAqc2hyaW5rZXIsCisJCQkJc3RydWN0IHNocmlua19jb250cm9sICpzYykKK3sKKwl4
ZW5fYmxrX21lbV9wcmVzc3VyZV9lbmQgPSBqaWZmaWVzICsKKwkJbXNlY3NfdG9famlmZmllcyhB
R0dSRVNTSVZFX1NIUklOS0lOR19EVVJBVElPTik7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBz
dHJ1Y3Qgc2hyaW5rZXIgYmxraWZfc2hyaW5rZXIgPSB7CisJLmNvdW50X29iamVjdHMgPSBibGtp
Zl9zaHJpbmtfY291bnQsCisJLnNlZWtzID0gREVGQVVMVF9TRUVLUywKK307CisKIHN0YXRpYyBp
bmxpbmUgYm9vbCBwZXJzaXN0ZW50X2dudF90aW1lb3V0KHN0cnVjdCBwZXJzaXN0ZW50X2dudCAq
cGVyc2lzdGVudF9nbnQpCiB7CiAJcmV0dXJuIHhlbl9ibGtpZl9wZ3JhbnRfdGltZW91dCAmJgpA
QCAtNjU2LDggKzY3NywxMSBAQCBpbnQgeGVuX2Jsa2lmX3NjaGVkdWxlKHZvaWQgKmFyZykKIAkJ
CXJpbmctPm5leHRfbHJ1ID0gamlmZmllcyArIG1zZWNzX3RvX2ppZmZpZXMoTFJVX0lOVEVSVkFM
KTsKIAkJfQogCi0JCS8qIFNocmluayBpZiB3ZSBoYXZlIG1vcmUgdGhhbiB4ZW5fYmxraWZfbWF4
X2J1ZmZlcl9wYWdlcyAqLwotCQlzaHJpbmtfZnJlZV9wYWdlcG9vbChyaW5nLCB4ZW5fYmxraWZf
bWF4X2J1ZmZlcl9wYWdlcyk7CisJCS8qIFNocmluayB0aGUgZnJlZSBwYWdlcyBwb29sIGlmIGl0
IGlzIHRvbyBsYXJnZS4gKi8KKwkJaWYgKHRpbWVfYmVmb3JlKGppZmZpZXMsIHhlbl9ibGtfbWVt
X3ByZXNzdXJlX2VuZCkpCisJCQlzaHJpbmtfZnJlZV9wYWdlcG9vbChyaW5nLCAwKTsKKwkJZWxz
ZQorCQkJc2hyaW5rX2ZyZWVfcGFnZXBvb2wocmluZywgeGVuX2Jsa2lmX21heF9idWZmZXJfcGFn
ZXMpOwogCiAJCWlmIChsb2dfc3RhdHMgJiYgdGltZV9hZnRlcihqaWZmaWVzLCByaW5nLT5zdF9w
cmludCkpCiAJCQlwcmludF9zdGF0cyhyaW5nKTsKQEAgLTE1MDAsNiArMTUyNCw5IEBAIHN0YXRp
YyBpbnQgX19pbml0IHhlbl9ibGtpZl9pbml0KHZvaWQpCiAJaWYgKHJjKQogCQlnb3RvIGZhaWxl
ZF9pbml0OwogCisJaWYgKHJlZ2lzdGVyX3Nocmlua2VyKCZibGtpZl9zaHJpbmtlcikpCisJCXBy
X3dhcm4oInNocmlua2VyIHJlZ2lzdHJhdGlvbiBmYWlsZWRcbiIpOworCiAgZmFpbGVkX2luaXQ6
CiAJcmV0dXJuIHJjOwogfQotLSAKMi4xNy4xCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlz
dHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3hlbi1kZXZlbA==

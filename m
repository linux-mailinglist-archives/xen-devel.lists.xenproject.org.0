Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 937AB12A2EC
	for <lists+xen-devel@lfdr.de>; Tue, 24 Dec 2019 16:22:31 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ijlyk-00017Z-EY; Tue, 24 Dec 2019 15:20:10 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=AG6B=2O=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1ijlyi-000129-3p
 for xen-devel@lists.xenproject.org; Tue, 24 Dec 2019 15:20:08 +0000
X-Inumbo-ID: cf4d6646-2660-11ea-97e5-12813bfff9fa
Received: from esa5.hc3370-68.iphmx.com (unknown [216.71.155.168])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id cf4d6646-2660-11ea-97e5-12813bfff9fa;
 Tue, 24 Dec 2019 15:19:42 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1577200782;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=zj0yYgsh25BPJFzuvlT29Uyi2go0KkohGMF7jvuL9iY=;
 b=PfxnLLAj43FfFRBLYUlfB+jBxa4n77dV0VRksCjW2HCzKHuBig5B3g2a
 bxPyPd1z82dn1xWSm37dZp4whxXi1Hb+nWWEIb7RFz99Xog35QplGygYR
 lFGC+eMY6cU9+yzHIpa0vR2TPmP12WVumJvd7Voq2++R2KJeIdv9ECyYL w=;
Authentication-Results: esa5.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa5.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: Ru6WlGxjao52/3I9af3UVbf/pzm2/fRD662Kisjlivtqxhrbj97lyzjp0jKK3BR3kLRgeBglam
 jMWh/dSE99S0B200PwtYg7c/zZR+m+l/tIs3Ec89JnA807x6wuAiVEtmuE+WSJmMjTf8FpEse+
 rzCti40z0EMEmFkHASrjVKLEcBAXZ1tpvgsoQrEh5DIVq0vUUYA8hHrr/6nZZIhs/fR678LmCS
 jUk9PqMHR850E9SymREG6jYg2ty6mTWrusMQ7A2i6DctOyZ9JDd95SEgUtm1lsXktInZTOh0q0
 cao=
X-SBRS: 2.7
X-MesageID: 10482756
X-Ironport-Server: esa5.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.69,351,1571716800"; d="scan'208";a="10482756"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Tue, 24 Dec 2019 15:19:24 +0000
Message-ID: <20191224151932.6304-5-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20191224151932.6304-1-andrew.cooper3@citrix.com>
References: <20191224151932.6304-1-andrew.cooper3@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 04/12] libxc/migration: Adjust layout of struct
 xc_sr_context
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wl@xen.org>,
 Ian Jackson <Ian.Jackson@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

V2UgYXJlIHNob3J0bHkgZ29pbmcgdG8gd2FudCB0byBpbnRyb2R1Y2Ugc29tZSBjb21tb24geDg2
IGZpZWxkcywgc28gaGF2aW5nCng4Nl9wdiBhbmQgeDg2X2h2bSBhcyB0aGUgdG9wIGxldmVsIG9i
amVjdHMgaXMgYSBwcm9ibGVtLiAgSW5zZXJ0IGEKc3Vycm91bmRpbmcgc3RydWN0IHg4NiBhbmQg
ZHJvcCB0aGUgeDg2IHByZWZpeCBmcm9tIHRoZSBwdi9odm0gb2JqZWN0cy4KCk5vIGZ1bmN0aW9u
YWwgY2hhbmdlLgoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNA
Y2l0cml4LmNvbT4KLS0tCkNDOiBJYW4gSmFja3NvbiA8SWFuLkphY2tzb25AY2l0cml4LmNvbT4K
Q0M6IFdlaSBMaXUgPHdsQHhlbi5vcmc+CgpUaGlzIGlzIG11Y2ggbW9yZSBlYXNpbHkgcmV2aWV3
ZWQgd2l0aCBnaXQtZGlmZidzIC0taWdub3JlLWFsbC1zcGFjZSBvcHRpb24sCndoaWNoIGhpZ2hs
aWdodHMgdGhlIHJlbGV2YW50IHN0cnVjdCBkaWZmZXJlbmNlLgoKICBkaWZmIC0tZ2l0IGEvdG9v
bHMvbGlieGMveGNfc3JfY29tbW9uLmggYi90b29scy9saWJ4Yy94Y19zcl9jb21tb24uaAogIGlu
ZGV4IDQ5NjNiMzBjNGIuLjJkMDJlODBlZTMgMTAwNjQ0CiAgLS0tIGEvdG9vbHMvbGlieGMveGNf
c3JfY29tbW9uLmgKICArKysgYi90b29scy9saWJ4Yy94Y19zcl9jb21tb24uaAogIEBAIC0yODEs
NiArMjgxLDggQEAgc3RydWN0IHhjX3NyX2NvbnRleHQKCiAgICAgICB1bmlvbiAvKiBHdWVzdC1h
cmNoIHNwZWNpZmljIGRhdGEuICovCiAgICAgICB7CiAgKyAgICAgICAgc3RydWN0IC8qIHg4NiAq
LwogICsgICAgICAgIHsKICAgICAgICAgICAgICAgc3RydWN0IC8qIHg4NiBQViBndWVzdC4gKi8K
ICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgLyogNCBvciA4OyAzMiBvciA2NCBi
aXQgZG9tYWluICovCiAgQEAgLTMzMiw3ICszMzQsNyBAQCBzdHJ1Y3QgeGNfc3JfY29udGV4dAog
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbnJfdmNwdXM7CiAgICAgICAg
ICAgICAgICAgICAgICAgfSByZXN0b3JlOwogICAgICAgICAgICAgICAgICAgfTsKICAtICAgICAg
ICB9IHg4Nl9wdjsKICArICAgICAgICAgICAgfSBwdjsKCiAgICAgICAgICAgICAgIHN0cnVjdCAv
KiB4ODYgSFZNIGd1ZXN0LiAqLwogICAgICAgICAgICAgICB7CiAgQEAgLTM1MSw3ICszNTMsOSBA
QCBzdHJ1Y3QgeGNfc3JfY29udGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
eGNfc3JfYmxvYiBjb250ZXh0OwogICAgICAgICAgICAgICAgICAgICAgIH0gcmVzdG9yZTsKICAg
ICAgICAgICAgICAgICAgIH07CiAgLSAgICAgICAgfSB4ODZfaHZtOwogICsgICAgICAgICAgICB9
IGh2bTsKICArCiAgKyAgICAgICAgfSB4ODY7CiAgICAgICB9OwogICB9OwotLS0KIHRvb2xzL2xp
YnhjL3hjX3NyX2NvbW1vbi5oICAgICAgICAgIHwgMTMyICsrKysrKysrKystLS0tLS0tLS0tLQog
dG9vbHMvbGlieGMveGNfc3JfY29tbW9uX3g4Nl9wdi5jICAgfCAgNTAgKysrKy0tLS0KIHRvb2xz
L2xpYnhjL3hjX3NyX2NvbW1vbl94ODZfcHYuaCAgIHwgICA0ICstCiB0b29scy9saWJ4Yy94Y19z
cl9yZXN0b3JlX3g4Nl9odm0uYyB8ICAxMiArLQogdG9vbHMvbGlieGMveGNfc3JfcmVzdG9yZV94
ODZfcHYuYyAgfCAyMjQgKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tCiB0b29s
cy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9odm0uYyAgICB8ICAgNCArLQogdG9vbHMvbGlieGMveGNf
c3Jfc2F2ZV94ODZfcHYuYyAgICAgfCAxNTggKysrKysrKysrKysrLS0tLS0tLS0tLS0tLQogNyBm
aWxlcyBjaGFuZ2VkLCAyOTQgaW5zZXJ0aW9ucygrKSwgMjkwIGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1vbi5oIGIvdG9vbHMvbGlieGMveGNfc3JfY29t
bW9uLmgKaW5kZXggNGRiNjNhNjNiMi4uMDI4OWMwMWUxMyAxMDA2NDQKLS0tIGEvdG9vbHMvbGli
eGMveGNfc3JfY29tbW9uLmgKKysrIGIvdG9vbHMvbGlieGMveGNfc3JfY29tbW9uLmgKQEAgLTI4
Nyw3NyArMjg3LDgxIEBAIHN0cnVjdCB4Y19zcl9jb250ZXh0CiAKICAgICB1bmlvbiAvKiBHdWVz
dC1hcmNoIHNwZWNpZmljIGRhdGEuICovCiAgICAgewotICAgICAgICBzdHJ1Y3QgLyogeDg2IFBW
IGd1ZXN0LiAqLworICAgICAgICBzdHJ1Y3QgLyogeDg2ICovCiAgICAgICAgIHsKLSAgICAgICAg
ICAgIC8qIDQgb3IgODsgMzIgb3IgNjQgYml0IGRvbWFpbiAqLwotICAgICAgICAgICAgdW5zaWdu
ZWQgaW50IHdpZHRoOwotICAgICAgICAgICAgLyogMyBvciA0IHBhZ2V0YWJsZSBsZXZlbHMgKi8K
LSAgICAgICAgICAgIHVuc2lnbmVkIGludCBsZXZlbHM7Ci0KLSAgICAgICAgICAgIC8qIE1heGlt
dW0gWGVuIGZyYW1lICovCi0gICAgICAgICAgICB4ZW5fcGZuX3QgbWF4X21mbjsKLSAgICAgICAg
ICAgIC8qIFJlYWQtb25seSBtYWNoaW5lIHRvIHBoeXMgbWFwICovCi0gICAgICAgICAgICB4ZW5f
cGZuX3QgKm0ycDsKLSAgICAgICAgICAgIC8qIGZpcnN0IG1mbiBvZiB0aGUgY29tcGF0IG0ycCAo
T25seSBuZWVkZWQgZm9yIDMyYml0IFBWIGd1ZXN0cykgKi8KLSAgICAgICAgICAgIHhlbl9wZm5f
dCBjb21wYXRfbTJwX21mbjA7Ci0gICAgICAgICAgICAvKiBOdW1iZXIgb2YgbTJwIGZyYW1lcyBt
YXBwZWQgKi8KLSAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbnJfbTJwX2ZyYW1lczsKLQotICAg
ICAgICAgICAgLyogTWF4aW11bSBndWVzdCBmcmFtZSAqLwotICAgICAgICAgICAgeGVuX3Bmbl90
IG1heF9wZm47Ci0KLSAgICAgICAgICAgIC8qIE51bWJlciBvZiBmcmFtZXMgbWFraW5nIHVwIHRo
ZSBwMm0gKi8KLSAgICAgICAgICAgIHVuc2lnbmVkIGludCBwMm1fZnJhbWVzOwotICAgICAgICAg
ICAgLyogR3Vlc3QncyBwaHlzIHRvIG1hY2hpbmUgbWFwLiAgTWFwcGVkIHJlYWQtb25seSAoc2F2
ZSkgb3IKLSAgICAgICAgICAgICAqIGFsbG9jYXRlZCBsb2NhbGx5IChyZXN0b3JlKS4gIFVzZXMg
Z3Vlc3QgdW5zaWduZWQgbG9uZ3MuICovCi0gICAgICAgICAgICB2b2lkICpwMm07Ci0gICAgICAg
ICAgICAvKiBUaGUgZ3Vlc3QgcGZucyBjb250YWluaW5nIHRoZSBwMm0gbGVhdmVzICovCi0gICAg
ICAgICAgICB4ZW5fcGZuX3QgKnAybV9wZm5zOwotCi0gICAgICAgICAgICAvKiBSZWFkLW9ubHkg
bWFwcGluZyBvZiBndWVzdHMgc2hhcmVkIGluZm8gcGFnZSAqLwotICAgICAgICAgICAgc2hhcmVk
X2luZm9fYW55X3QgKnNoaW5mbzsKLQotICAgICAgICAgICAgLyogcDJtIGdlbmVyYXRpb24gY291
bnQgZm9yIHZlcmlmeWluZyB2YWxpZGl0eSBvZiBsb2NhbCBwMm0uICovCi0gICAgICAgICAgICB1
aW50NjRfdCBwMm1fZ2VuZXJhdGlvbjsKLQotICAgICAgICAgICAgdW5pb24KKyAgICAgICAgICAg
IHN0cnVjdCAvKiB4ODYgUFYgZ3Vlc3QuICovCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAg
ICAgc3RydWN0CisgICAgICAgICAgICAgICAgLyogNCBvciA4OyAzMiBvciA2NCBiaXQgZG9tYWlu
ICovCisgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHdpZHRoOworICAgICAgICAgICAgICAg
IC8qIDMgb3IgNCBwYWdldGFibGUgbGV2ZWxzICovCisgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IGxldmVsczsKKworICAgICAgICAgICAgICAgIC8qIE1heGltdW0gWGVuIGZyYW1lICovCisg
ICAgICAgICAgICAgICAgeGVuX3Bmbl90IG1heF9tZm47CisgICAgICAgICAgICAgICAgLyogUmVh
ZC1vbmx5IG1hY2hpbmUgdG8gcGh5cyBtYXAgKi8KKyAgICAgICAgICAgICAgICB4ZW5fcGZuX3Qg
Km0ycDsKKyAgICAgICAgICAgICAgICAvKiBmaXJzdCBtZm4gb2YgdGhlIGNvbXBhdCBtMnAgKE9u
bHkgbmVlZGVkIGZvciAzMmJpdCBQViBndWVzdHMpICovCisgICAgICAgICAgICAgICAgeGVuX3Bm
bl90IGNvbXBhdF9tMnBfbWZuMDsKKyAgICAgICAgICAgICAgICAvKiBOdW1iZXIgb2YgbTJwIGZy
YW1lcyBtYXBwZWQgKi8KKyAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIG5yX20ycF9mcmFt
ZXM7CisKKyAgICAgICAgICAgICAgICAvKiBNYXhpbXVtIGd1ZXN0IGZyYW1lICovCisgICAgICAg
ICAgICAgICAgeGVuX3Bmbl90IG1heF9wZm47CisKKyAgICAgICAgICAgICAgICAvKiBOdW1iZXIg
b2YgZnJhbWVzIG1ha2luZyB1cCB0aGUgcDJtICovCisgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IHAybV9mcmFtZXM7CisgICAgICAgICAgICAgICAgLyogR3Vlc3QncyBwaHlzIHRvIG1hY2hp
bmUgbWFwLiAgTWFwcGVkIHJlYWQtb25seSAoc2F2ZSkgb3IKKyAgICAgICAgICAgICAgICAgKiBh
bGxvY2F0ZWQgbG9jYWxseSAocmVzdG9yZSkuICBVc2VzIGd1ZXN0IHVuc2lnbmVkIGxvbmdzLiAq
LworICAgICAgICAgICAgICAgIHZvaWQgKnAybTsKKyAgICAgICAgICAgICAgICAvKiBUaGUgZ3Vl
c3QgcGZucyBjb250YWluaW5nIHRoZSBwMm0gbGVhdmVzICovCisgICAgICAgICAgICAgICAgeGVu
X3Bmbl90ICpwMm1fcGZuczsKKworICAgICAgICAgICAgICAgIC8qIFJlYWQtb25seSBtYXBwaW5n
IG9mIGd1ZXN0cyBzaGFyZWQgaW5mbyBwYWdlICovCisgICAgICAgICAgICAgICAgc2hhcmVkX2lu
Zm9fYW55X3QgKnNoaW5mbzsKKworICAgICAgICAgICAgICAgIC8qIHAybSBnZW5lcmF0aW9uIGNv
dW50IGZvciB2ZXJpZnlpbmcgdmFsaWRpdHkgb2YgbG9jYWwgcDJtLiAqLworICAgICAgICAgICAg
ICAgIHVpbnQ2NF90IHAybV9nZW5lcmF0aW9uOworCisgICAgICAgICAgICAgICAgdW5pb24KICAg
ICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIC8qIFN0YXRlIG1hY2hpbmUgZm9y
IHRoZSBvcmRlciBvZiByZWNlaXZlZCByZWNvcmRzLiAqLwotICAgICAgICAgICAgICAgICAgICBi
b29sIHNlZW5fcHZfaW5mbzsKLQotICAgICAgICAgICAgICAgICAgICAvKiBUeXBlcyBmb3IgZWFj
aCBwYWdlIChib3VuZGVkIGJ5IG1heF9wZm4pLiAqLwotICAgICAgICAgICAgICAgICAgICB1aW50
MzJfdCAqcGZuX3R5cGVzOwotCi0gICAgICAgICAgICAgICAgICAgIC8qIHg4NiBQViBwZXItdmNw
dSBzdG9yYWdlIHN0cnVjdHVyZSBmb3IgYmxvYnMuICovCi0gICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB4Y19zcl94ODZfcHZfcmVzdG9yZV92Y3B1CisgICAgICAgICAgICAgICAgICAgIHN0cnVj
dAogICAgICAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
eGNfc3JfYmxvYiBiYXNpYywgZXh0ZCwgeHNhdmUsIG1zcjsKLSAgICAgICAgICAgICAgICAgICAg
fSAqdmNwdXM7Ci0gICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBucl92Y3B1czsKLSAg
ICAgICAgICAgICAgICB9IHJlc3RvcmU7Ci0gICAgICAgICAgICB9OwotICAgICAgICB9IHg4Nl9w
djsKLQotICAgICAgICBzdHJ1Y3QgLyogeDg2IEhWTSBndWVzdC4gKi8KLSAgICAgICAgewotICAg
ICAgICAgICAgdW5pb24KKyAgICAgICAgICAgICAgICAgICAgICAgIC8qIFN0YXRlIG1hY2hpbmUg
Zm9yIHRoZSBvcmRlciBvZiByZWNlaXZlZCByZWNvcmRzLiAqLworICAgICAgICAgICAgICAgICAg
ICAgICAgYm9vbCBzZWVuX3B2X2luZm87CisKKyAgICAgICAgICAgICAgICAgICAgICAgIC8qIFR5
cGVzIGZvciBlYWNoIHBhZ2UgKGJvdW5kZWQgYnkgbWF4X3BmbikuICovCisgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50MzJfdCAqcGZuX3R5cGVzOworCisgICAgICAgICAgICAgICAgICAgICAg
ICAvKiB4ODYgUFYgcGVyLXZjcHUgc3RvcmFnZSBzdHJ1Y3R1cmUgZm9yIGJsb2JzLiAqLworICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhjX3NyX3g4Nl9wdl9yZXN0b3JlX3ZjcHUKKyAg
ICAgICAgICAgICAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgeGNfc3JfYmxvYiBiYXNpYywgZXh0ZCwgeHNhdmUsIG1zcjsKKyAgICAgICAgICAgICAgICAg
ICAgICAgIH0gKnZjcHVzOworICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG5y
X3ZjcHVzOworICAgICAgICAgICAgICAgICAgICB9IHJlc3RvcmU7CisgICAgICAgICAgICAgICAg
fTsKKyAgICAgICAgICAgIH0gcHY7CisKKyAgICAgICAgICAgIHN0cnVjdCAvKiB4ODYgSFZNIGd1
ZXN0LiAqLwogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIHN0cnVjdAorICAgICAgICAg
ICAgICAgIHVuaW9uCiAgICAgICAgICAgICAgICAgewotICAgICAgICAgICAgICAgICAgICAvKiBX
aGV0aGVyIHFlbXUgZW5hYmxlZCBsb2dkaXJ0eSBtb2RlLCBhbmQgd2Ugc2hvdWxkCi0gICAgICAg
ICAgICAgICAgICAgICAqIGRpc2FibGUgb24gY2xlYW51cC4gKi8KLSAgICAgICAgICAgICAgICAg
ICAgYm9vbCBxZW11X2VuYWJsZWRfbG9nZGlydHk7Ci0gICAgICAgICAgICAgICAgfSBzYXZlOwor
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QKKyAgICAgICAgICAgICAgICAgICAgeworICAgICAg
ICAgICAgICAgICAgICAgICAgLyogV2hldGhlciBxZW11IGVuYWJsZWQgbG9nZGlydHkgbW9kZSwg
YW5kIHdlIHNob3VsZAorICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzYWJsZSBvbiBjbGVh
bnVwLiAqLworICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBxZW11X2VuYWJsZWRfbG9nZGly
dHk7CisgICAgICAgICAgICAgICAgICAgIH0gc2F2ZTsKIAotICAgICAgICAgICAgICAgIHN0cnVj
dAotICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgLyogSFZNIGNvbnRleHQg
YmxvYi4gKi8KLSAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhjX3NyX2Jsb2IgY29udGV4dDsK
LSAgICAgICAgICAgICAgICB9IHJlc3RvcmU7Ci0gICAgICAgICAgICB9OwotICAgICAgICB9IHg4
Nl9odm07CisgICAgICAgICAgICAgICAgICAgIHN0cnVjdAorICAgICAgICAgICAgICAgICAgICB7
CisgICAgICAgICAgICAgICAgICAgICAgICAvKiBIVk0gY29udGV4dCBibG9iLiAqLworICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHhjX3NyX2Jsb2IgY29udGV4dDsKKyAgICAgICAgICAg
ICAgICAgICAgfSByZXN0b3JlOworICAgICAgICAgICAgICAgIH07CisgICAgICAgICAgICB9IGh2
bTsKKworICAgICAgICB9IHg4NjsKICAgICB9OwogfTsKIApkaWZmIC0tZ2l0IGEvdG9vbHMvbGli
eGMveGNfc3JfY29tbW9uX3g4Nl9wdi5jIGIvdG9vbHMvbGlieGMveGNfc3JfY29tbW9uX3g4Nl9w
di5jCmluZGV4IGVjNDMzZmFkNzAuLmQzZDQyNWNiODIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhj
L3hjX3NyX2NvbW1vbl94ODZfcHYuYworKysgYi90b29scy9saWJ4Yy94Y19zcl9jb21tb25feDg2
X3B2LmMKQEAgLTQsMTYgKzQsMTYgQEAKIAogeGVuX3Bmbl90IG1mbl90b19wZm4oc3RydWN0IHhj
X3NyX2NvbnRleHQgKmN0eCwgeGVuX3Bmbl90IG1mbikKIHsKLSAgICBhc3NlcnQobWZuIDw9IGN0
eC0+eDg2X3B2Lm1heF9tZm4pOwotICAgIHJldHVybiBjdHgtPng4Nl9wdi5tMnBbbWZuXTsKKyAg
ICBhc3NlcnQobWZuIDw9IGN0eC0+eDg2LnB2Lm1heF9tZm4pOworICAgIHJldHVybiBjdHgtPng4
Ni5wdi5tMnBbbWZuXTsKIH0KIAogYm9vbCBtZm5faW5fcHNldWRvcGh5c21hcChzdHJ1Y3QgeGNf
c3JfY29udGV4dCAqY3R4LCB4ZW5fcGZuX3QgbWZuKQogewotICAgIHJldHVybiAoKG1mbiA8PSBj
dHgtPng4Nl9wdi5tYXhfbWZuKSAmJgotICAgICAgICAgICAgKG1mbl90b19wZm4oY3R4LCBtZm4p
IDw9IGN0eC0+eDg2X3B2Lm1heF9wZm4pICYmCi0gICAgICAgICAgICAoeGNfcGZuX3RvX21mbiht
Zm5fdG9fcGZuKGN0eCwgbWZuKSwgY3R4LT54ODZfcHYucDJtLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY3R4LT54ODZfcHYud2lkdGgpID09IG1mbikpOworICAgIHJldHVybiAoKG1mbiA8
PSBjdHgtPng4Ni5wdi5tYXhfbWZuKSAmJgorICAgICAgICAgICAgKG1mbl90b19wZm4oY3R4LCBt
Zm4pIDw9IGN0eC0+eDg2LnB2Lm1heF9wZm4pICYmCisgICAgICAgICAgICAoeGNfcGZuX3RvX21m
bihtZm5fdG9fcGZuKGN0eCwgbWZuKSwgY3R4LT54ODYucHYucDJtLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY3R4LT54ODYucHYud2lkdGgpID09IG1mbikpOwogfQogCiB2b2lkIGR1bXBf
YmFkX3BzZXVkb3BoeXNtYXBfZW50cnkoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgeGVuX3Bm
bl90IG1mbikKQEAgLTIxLDIzICsyMSwyMyBAQCB2b2lkIGR1bXBfYmFkX3BzZXVkb3BoeXNtYXBf
ZW50cnkoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgeGVuX3Bmbl90IG1mbikKICAgICB4Y19p
bnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogICAgIHhlbl9wZm5fdCBwZm4gPSB+MFVMOwogCi0g
ICAgRVJST1IoIm1mbiAlI2x4LCBtYXggJSNseCIsIG1mbiwgY3R4LT54ODZfcHYubWF4X21mbik7
CisgICAgRVJST1IoIm1mbiAlI2x4LCBtYXggJSNseCIsIG1mbiwgY3R4LT54ODYucHYubWF4X21m
bik7CiAKLSAgICBpZiAoIChtZm4gIT0gfjBVTCkgJiYgKG1mbiA8PSBjdHgtPng4Nl9wdi5tYXhf
bWZuKSApCisgICAgaWYgKCAobWZuICE9IH4wVUwpICYmIChtZm4gPD0gY3R4LT54ODYucHYubWF4
X21mbikgKQogICAgIHsKLSAgICAgICAgcGZuID0gY3R4LT54ODZfcHYubTJwW21mbl07CisgICAg
ICAgIHBmbiA9IGN0eC0+eDg2LnB2Lm0ycFttZm5dOwogICAgICAgICBFUlJPUigiICBtMnBbJSNs
eF0gPSAlI2x4LCBtYXhfcGZuICUjbHgiLAotICAgICAgICAgICAgICBtZm4sIHBmbiwgY3R4LT54
ODZfcHYubWF4X3Bmbik7CisgICAgICAgICAgICAgIG1mbiwgcGZuLCBjdHgtPng4Ni5wdi5tYXhf
cGZuKTsKICAgICB9CiAKLSAgICBpZiAoIChwZm4gIT0gfjBVTCkgJiYgKHBmbiA8PSBjdHgtPng4
Nl9wdi5tYXhfcGZuKSApCisgICAgaWYgKCAocGZuICE9IH4wVUwpICYmIChwZm4gPD0gY3R4LT54
ODYucHYubWF4X3BmbikgKQogICAgICAgICBFUlJPUigiICBwMm1bJSNseF0gPSAlI2x4IiwKLSAg
ICAgICAgICAgICAgcGZuLCB4Y19wZm5fdG9fbWZuKHBmbiwgY3R4LT54ODZfcHYucDJtLCBjdHgt
Png4Nl9wdi53aWR0aCkpOworICAgICAgICAgICAgICBwZm4sIHhjX3Bmbl90b19tZm4ocGZuLCBj
dHgtPng4Ni5wdi5wMm0sIGN0eC0+eDg2LnB2LndpZHRoKSk7CiB9CiAKIHhlbl9wZm5fdCBjcjNf
dG9fbWZuKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVpbnQ2NF90IGNyMykKIHsKLSAgICBp
ZiAoIGN0eC0+eDg2X3B2LndpZHRoID09IDggKQorICAgIGlmICggY3R4LT54ODYucHYud2lkdGgg
PT0gOCApCiAgICAgICAgIHJldHVybiBjcjMgPj4gMTI7CiAgICAgZWxzZQogICAgIHsKQEAgLTUz
LDcgKzUzLDcgQEAgdWludDY0X3QgbWZuX3RvX2NyMyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4
LCB4ZW5fcGZuX3QgX21mbikKIHsKICAgICB1aW50NjRfdCBtZm4gPSBfbWZuOwogCi0gICAgaWYg
KCBjdHgtPng4Nl9wdi53aWR0aCA9PSA4ICkKKyAgICBpZiAoIGN0eC0+eDg2LnB2LndpZHRoID09
IDggKQogICAgICAgICByZXR1cm4gbWZuIDw8IDEyOwogICAgIGVsc2UKICAgICB7CkBAIC04Niw4
ICs4Niw4IEBAIGludCB4ODZfcHZfZG9tYWluX2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0
eCkKICAgICAgICAgRVJST1IoIkludmFsaWQgZ3Vlc3Qgd2lkdGggJWQuICBFeHBlY3RlZCAzMiBv
ciA2NCIsIGd1ZXN0X3dpZHRoICogOCk7CiAgICAgICAgIHJldHVybiAtMTsKICAgICB9Ci0gICAg
Y3R4LT54ODZfcHYud2lkdGggPSBndWVzdF93aWR0aDsKLSAgICBjdHgtPng4Nl9wdi5sZXZlbHMg
PSBndWVzdF9sZXZlbHM7CisgICAgY3R4LT54ODYucHYud2lkdGggPSBndWVzdF93aWR0aDsKKyAg
ICBjdHgtPng4Ni5wdi5sZXZlbHMgPSBndWVzdF9sZXZlbHM7CiAKICAgICBEUFJJTlRGKCIlZCBi
aXRzLCAlZCBsZXZlbHMiLCBndWVzdF93aWR0aCAqIDgsIGd1ZXN0X2xldmVscyk7CiAKQEAgLTEw
OCw5ICsxMDgsOSBAQCBpbnQgeDg2X3B2X21hcF9tMnAoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0
eCkKICAgICAgICAgZ290byBlcnI7CiAgICAgfQogCi0gICAgY3R4LT54ODZfcHYubWF4X21mbiA9
IG1heF9wYWdlOwotICAgIG0ycF9zaXplICAgPSBNMlBfU0laRShjdHgtPng4Nl9wdi5tYXhfbWZu
KTsKLSAgICBtMnBfY2h1bmtzID0gTTJQX0NIVU5LUyhjdHgtPng4Nl9wdi5tYXhfbWZuKTsKKyAg
ICBjdHgtPng4Ni5wdi5tYXhfbWZuID0gbWF4X3BhZ2U7CisgICAgbTJwX3NpemUgICA9IE0yUF9T
SVpFKGN0eC0+eDg2LnB2Lm1heF9tZm4pOworICAgIG0ycF9jaHVua3MgPSBNMlBfQ0hVTktTKGN0
eC0+eDg2LnB2Lm1heF9tZm4pOwogCiAgICAgZXh0ZW50c19zdGFydCA9IG1hbGxvYyhtMnBfY2h1
bmtzICogc2l6ZW9mKHhlbl9wZm5fdCkpOwogICAgIGlmICggIWV4dGVudHNfc3RhcnQgKQpAQCAt
MTM3LDI3ICsxMzcsMjcgQEAgaW50IHg4Nl9wdl9tYXBfbTJwKHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgpCiAgICAgZm9yICggaSA9IDA7IGkgPCBtMnBfY2h1bmtzOyArK2kgKQogICAgICAgICBl
bnRyaWVzW2ldLm1mbiA9IGV4dGVudHNfc3RhcnRbaV07CiAKLSAgICBjdHgtPng4Nl9wdi5tMnAg
PSB4Y19tYXBfZm9yZWlnbl9yYW5nZXMoCisgICAgY3R4LT54ODYucHYubTJwID0geGNfbWFwX2Zv
cmVpZ25fcmFuZ2VzKAogICAgICAgICB4Y2gsIERPTUlEX1hFTiwgbTJwX3NpemUsIFBST1RfUkVB
RCwKICAgICAgICAgTTJQX0NIVU5LX1NJWkUsIGVudHJpZXMsIG0ycF9jaHVua3MpOwogCi0gICAg
aWYgKCAhY3R4LT54ODZfcHYubTJwICkKKyAgICBpZiAoICFjdHgtPng4Ni5wdi5tMnAgKQogICAg
IHsKICAgICAgICAgUEVSUk9SKCJGYWlsZWQgdG8gbW1hcCgpIG0ycCByYW5nZXMiKTsKICAgICAg
ICAgZ290byBlcnI7CiAgICAgfQogCi0gICAgY3R4LT54ODZfcHYubnJfbTJwX2ZyYW1lcyA9IChN
MlBfQ0hVTktfU0laRSA+PiBQQUdFX1NISUZUKSAqIG0ycF9jaHVua3M7CisgICAgY3R4LT54ODYu
cHYubnJfbTJwX2ZyYW1lcyA9IChNMlBfQ0hVTktfU0laRSA+PiBQQUdFX1NISUZUKSAqIG0ycF9j
aHVua3M7CiAKICNpZmRlZiBfX2kzODZfXwogICAgIC8qIDMyIGJpdCB0b29sc3RhY2tzIGF1dG9t
YXRpY2FsbHkgZ2V0IHRoZSBjb21wYXQgbTJwICovCi0gICAgY3R4LT54ODZfcHYuY29tcGF0X20y
cF9tZm4wID0gZW50cmllc1swXS5tZm47CisgICAgY3R4LT54ODYucHYuY29tcGF0X20ycF9tZm4w
ID0gZW50cmllc1swXS5tZm47CiAjZWxzZQogICAgIC8qIDY0IGJpdCB0b29sc3RhY2tzIG5lZWQg
dG8gYXNrIFhlbiBzcGVjaWFsbHkgZm9yIGl0ICovCiAgICAgewogICAgICAgICBzdHJ1Y3QgeGVu
X21hY2hwaHlzX21mbl9saXN0IHhtbWwgPSB7CiAgICAgICAgICAgICAubWF4X2V4dGVudHMgPSAx
LAotICAgICAgICAgICAgLmV4dGVudF9zdGFydCA9IHsgJmN0eC0+eDg2X3B2LmNvbXBhdF9tMnBf
bWZuMCB9LAorICAgICAgICAgICAgLmV4dGVudF9zdGFydCA9IHsgJmN0eC0+eDg2LnB2LmNvbXBh
dF9tMnBfbWZuMCB9LAogICAgICAgICB9OwogCiAgICAgICAgIHJjID0gZG9fbWVtb3J5X29wKHhj
aCwgWEVOTUVNX21hY2hwaHlzX2NvbXBhdF9tZm5fbGlzdCwKQEAgLTE3Myw3ICsxNzMsNyBAQCBp
bnQgeDg2X3B2X21hcF9tMnAoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIAogICAgIC8qIEFs
bCBEb25lICovCiAgICAgcmMgPSAwOwotICAgIERQUklOVEYoIm1heF9tZm4gJSNseCIsIGN0eC0+
eDg2X3B2Lm1heF9tZm4pOworICAgIERQUklOVEYoIm1heF9tZm4gJSNseCIsIGN0eC0+eDg2LnB2
Lm1heF9tZm4pOwogCiAgZXJyOgogICAgIGZyZWUoZW50cmllcyk7CmRpZmYgLS1naXQgYS90b29s
cy9saWJ4Yy94Y19zcl9jb21tb25feDg2X3B2LmggYi90b29scy9saWJ4Yy94Y19zcl9jb21tb25f
eDg2X3B2LmgKaW5kZXggZjgwYzc1MzQ5YS4uMmVkMDMzMDlhZiAxMDA2NDQKLS0tIGEvdG9vbHMv
bGlieGMveGNfc3JfY29tbW9uX3g4Nl9wdi5oCisrKyBiL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1v
bl94ODZfcHYuaApAQCAtNzMsNyArNzMsNyBAQCBzdGF0aWMgaW5saW5lIHVpbnQ2NF90IG1lcmdl
X3B0ZSh1aW50NjRfdCBwdGUsIHhlbl9wZm5fdCBtZm4pCiAvKgogICogR2V0IGN1cnJlbnQgZG9t
YWluIGluZm9ybWF0aW9uLgogICoKLSAqIEZpbGxzIGN0eC0+eDg2X3B2CisgKiBGaWxscyBjdHgt
Png4Ni5wdgogICogLSAud2lkdGgKICAqIC0gLmxldmVscwogICogLSAuZnBwCkBAIC04OSw3ICs4
OSw3IEBAIGludCB4ODZfcHZfZG9tYWluX2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCk7
CiAvKgogICogTWFwcyB0aGUgWGVuIE0yUC4KICAqCi0gKiBGaWxscyBjdHgtPng4Nl9wdi4KKyAq
IEZpbGxzIGN0eC0+eDg2LnB2LgogICogLSAubWF4X21mbgogICogLSAubTJwCiAgKgpkaWZmIC0t
Z2l0IGEvdG9vbHMvbGlieGMveGNfc3JfcmVzdG9yZV94ODZfaHZtLmMgYi90b29scy9saWJ4Yy94
Y19zcl9yZXN0b3JlX3g4Nl9odm0uYwppbmRleCBmZTdiZTliZGU2Li4zZjc4MjQ4ZjMyIDEwMDY0
NAotLS0gYS90b29scy9saWJ4Yy94Y19zcl9yZXN0b3JlX3g4Nl9odm0uYworKysgYi90b29scy9s
aWJ4Yy94Y19zcl9yZXN0b3JlX3g4Nl9odm0uYwpAQCAtMTAsNyArMTAsNyBAQCBzdGF0aWMgaW50
IGhhbmRsZV9odm1fY29udGV4dChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhjX3NyX3JlY29yZCAqcmVjKQogewogICAgIHhj
X2ludGVyZmFjZSAqeGNoID0gY3R4LT54Y2g7Ci0gICAgaW50IHJjID0gdXBkYXRlX2Jsb2IoJmN0
eC0+eDg2X2h2bS5yZXN0b3JlLmNvbnRleHQsIHJlYy0+ZGF0YSwgcmVjLT5sZW5ndGgpOworICAg
IGludCByYyA9IHVwZGF0ZV9ibG9iKCZjdHgtPng4Ni5odm0ucmVzdG9yZS5jb250ZXh0LCByZWMt
PmRhdGEsIHJlYy0+bGVuZ3RoKTsKIAogICAgIGlmICggcmMgKQogICAgICAgICBFUlJPUigiVW5h
YmxlIHRvIGFsbG9jYXRlICV1IGJ5dGVzIGZvciBodm0gY29udGV4dCIsIHJlYy0+bGVuZ3RoKTsK
QEAgLTEyOSwxNCArMTI5LDE0IEBAIHN0YXRpYyBpbnQgeDg2X2h2bV9zZXR1cChzdHJ1Y3QgeGNf
c3JfY29udGV4dCAqY3R4KQogCiAgICAgaWYgKCBjdHgtPnJlc3RvcmUuZ3Vlc3RfdHlwZSAhPSBE
SERSX1RZUEVfWDg2X0hWTSApCiAgICAgewotICAgICAgICBFUlJPUigiVW5hYmxlIHRvIHJlc3Rv
cmUgJXMgZG9tYWluIGludG8gYW4geDg2X2h2bSBkb21haW4iLAorICAgICAgICBFUlJPUigiVW5h
YmxlIHRvIHJlc3RvcmUgJXMgZG9tYWluIGludG8gYW4geDg2IEhWTSBkb21haW4iLAogICAgICAg
ICAgICAgICBkaGRyX3R5cGVfdG9fc3RyKGN0eC0+cmVzdG9yZS5ndWVzdF90eXBlKSk7CiAgICAg
ICAgIHJldHVybiAtMTsKICAgICB9CiAKICAgICBpZiAoIGN0eC0+cmVzdG9yZS5ndWVzdF9wYWdl
X3NpemUgIT0gUEFHRV9TSVpFICkKICAgICB7Ci0gICAgICAgIEVSUk9SKCJJbnZhbGlkIHBhZ2Ug
c2l6ZSAldSBmb3IgeDg2X2h2bSBkb21haW5zIiwKKyAgICAgICAgRVJST1IoIkludmFsaWQgcGFn
ZSBzaXplICV1IGZvciB4ODYgSFZNIGRvbWFpbnMiLAogICAgICAgICAgICAgICBjdHgtPnJlc3Rv
cmUuZ3Vlc3RfcGFnZV9zaXplKTsKICAgICAgICAgcmV0dXJuIC0xOwogICAgIH0KQEAgLTIwMSw4
ICsyMDEsOCBAQCBzdGF0aWMgaW50IHg4Nl9odm1fc3RyZWFtX2NvbXBsZXRlKHN0cnVjdCB4Y19z
cl9jb250ZXh0ICpjdHgpCiAgICAgfQogCiAgICAgcmMgPSB4Y19kb21haW5faHZtX3NldGNvbnRl
eHQoeGNoLCBjdHgtPmRvbWlkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0
eC0+eDg2X2h2bS5yZXN0b3JlLmNvbnRleHQucHRyLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGN0eC0+eDg2X2h2bS5yZXN0b3JlLmNvbnRleHQuc2l6ZSk7CisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT54ODYuaHZtLnJlc3RvcmUuY29udGV4dC5wdHIs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT54ODYuaHZtLnJlc3RvcmUu
Y29udGV4dC5zaXplKTsKICAgICBpZiAoIHJjIDwgMCApCiAgICAgewogICAgICAgICBQRVJST1Io
IlVuYWJsZSB0byByZXN0b3JlIEhWTSBjb250ZXh0Iik7CkBAIC0yMjUsNyArMjI1LDcgQEAgc3Rh
dGljIGludCB4ODZfaHZtX3N0cmVhbV9jb21wbGV0ZShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4
KQogCiBzdGF0aWMgaW50IHg4Nl9odm1fY2xlYW51cChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4
KQogewotICAgIGZyZWUoY3R4LT54ODZfaHZtLnJlc3RvcmUuY29udGV4dC5wdHIpOworICAgIGZy
ZWUoY3R4LT54ODYuaHZtLnJlc3RvcmUuY29udGV4dC5wdHIpOwogCiAgICAgcmV0dXJuIDA7CiB9
CmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy94Y19zcl9yZXN0b3JlX3g4Nl9wdi5jIGIvdG9vbHMv
bGlieGMveGNfc3JfcmVzdG9yZV94ODZfcHYuYwppbmRleCAwZWM1MDY2MzJhLi44ZjYxYTVlOGI5
IDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94Y19zcl9yZXN0b3JlX3g4Nl9wdi5jCisrKyBiL3Rv
b2xzL2xpYnhjL3hjX3NyX3Jlc3RvcmVfeDg2X3B2LmMKQEAgLTQsOSArNCw5IEBACiAKIHN0YXRp
YyB4ZW5fcGZuX3QgcGZuX3RvX21mbihjb25zdCBzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB4
ZW5fcGZuX3QgcGZuKQogewotICAgIGFzc2VydChwZm4gPD0gY3R4LT54ODZfcHYubWF4X3Bmbik7
CisgICAgYXNzZXJ0KHBmbiA8PSBjdHgtPng4Ni5wdi5tYXhfcGZuKTsKIAotICAgIHJldHVybiB4
Y19wZm5fdG9fbWZuKHBmbiwgY3R4LT54ODZfcHYucDJtLCBjdHgtPng4Nl9wdi53aWR0aCk7Cisg
ICAgcmV0dXJuIHhjX3Bmbl90b19tZm4ocGZuLCBjdHgtPng4Ni5wdi5wMm0sIGN0eC0+eDg2LnB2
LndpZHRoKTsKIH0KIAogLyoKQEAgLTE4LDggKzE4LDggQEAgc3RhdGljIHhlbl9wZm5fdCBwZm5f
dG9fbWZuKGNvbnN0IHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHhlbl9wZm5fdCBwZm4pCiBz
dGF0aWMgaW50IGV4cGFuZF9wMm0oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgdW5zaWduZWQg
bG9uZyBtYXhfcGZuKQogewogICAgIHhjX2ludGVyZmFjZSAqeGNoID0gY3R4LT54Y2g7Ci0gICAg
dW5zaWduZWQgbG9uZyBvbGRfbWF4ID0gY3R4LT54ODZfcHYubWF4X3BmbiwgaTsKLSAgICB1bnNp
Z25lZCBpbnQgZnBwID0gUEFHRV9TSVpFIC8gY3R4LT54ODZfcHYud2lkdGg7CisgICAgdW5zaWdu
ZWQgbG9uZyBvbGRfbWF4ID0gY3R4LT54ODYucHYubWF4X3BmbiwgaTsKKyAgICB1bnNpZ25lZCBp
bnQgZnBwID0gUEFHRV9TSVpFIC8gY3R4LT54ODYucHYud2lkdGg7CiAgICAgdW5zaWduZWQgbG9u
ZyBlbmRfZnJhbWUgPSAobWF4X3BmbiAvIGZwcCkgKyAxOwogICAgIHVuc2lnbmVkIGxvbmcgb2xk
X2VuZF9mcmFtZSA9IChvbGRfbWF4IC8gZnBwKSArIDE7CiAgICAgeGVuX3Bmbl90ICpwMm0gPSBO
VUxMLCAqcDJtX3BmbnMgPSBOVUxMOwpAQCAtMjgsMzUgKzI4LDM1IEBAIHN0YXRpYyBpbnQgZXhw
YW5kX3AybShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1bnNpZ25lZCBsb25nIG1heF9wZm4p
CiAKICAgICBhc3NlcnQobWF4X3BmbiA+IG9sZF9tYXgpOwogCi0gICAgcDJtc3ogPSAobWF4X3Bm
biArIDEpICogY3R4LT54ODZfcHYud2lkdGg7Ci0gICAgcDJtID0gcmVhbGxvYyhjdHgtPng4Nl9w
di5wMm0sIHAybXN6KTsKKyAgICBwMm1zeiA9IChtYXhfcGZuICsgMSkgKiBjdHgtPng4Ni5wdi53
aWR0aDsKKyAgICBwMm0gPSByZWFsbG9jKGN0eC0+eDg2LnB2LnAybSwgcDJtc3opOwogICAgIGlm
ICggIXAybSApCiAgICAgewogICAgICAgICBFUlJPUigiRmFpbGVkIHRvIChyZSlhbGxvYyAlenUg
Ynl0ZXMgZm9yIHAybSIsIHAybXN6KTsKICAgICAgICAgcmV0dXJuIC0xOwogICAgIH0KLSAgICBj
dHgtPng4Nl9wdi5wMm0gPSBwMm07CisgICAgY3R4LT54ODYucHYucDJtID0gcDJtOwogCiAgICAg
cGZuX3R5cGVzeiA9IChtYXhfcGZuICsgMSkgKiBzaXplb2YoKnBmbl90eXBlcyk7Ci0gICAgcGZu
X3R5cGVzID0gcmVhbGxvYyhjdHgtPng4Nl9wdi5yZXN0b3JlLnBmbl90eXBlcywgcGZuX3R5cGVz
eik7CisgICAgcGZuX3R5cGVzID0gcmVhbGxvYyhjdHgtPng4Ni5wdi5yZXN0b3JlLnBmbl90eXBl
cywgcGZuX3R5cGVzeik7CiAgICAgaWYgKCAhcGZuX3R5cGVzICkKICAgICB7CiAgICAgICAgIEVS
Uk9SKCJGYWlsZWQgdG8gKHJlKWFsbG9jICV6dSBieXRlcyBmb3IgcGZuX3R5cGVzIiwgcGZuX3R5
cGVzeik7CiAgICAgICAgIHJldHVybiAtMTsKICAgICB9Ci0gICAgY3R4LT54ODZfcHYucmVzdG9y
ZS5wZm5fdHlwZXMgPSBwZm5fdHlwZXM7CisgICAgY3R4LT54ODYucHYucmVzdG9yZS5wZm5fdHlw
ZXMgPSBwZm5fdHlwZXM7CiAKICAgICBwMm1fcGZuc3ogPSAoZW5kX2ZyYW1lICsgMSkgKiBzaXpl
b2YoKnAybV9wZm5zKTsKLSAgICBwMm1fcGZucyA9IHJlYWxsb2MoY3R4LT54ODZfcHYucDJtX3Bm
bnMsIHAybV9wZm5zeik7CisgICAgcDJtX3BmbnMgPSByZWFsbG9jKGN0eC0+eDg2LnB2LnAybV9w
Zm5zLCBwMm1fcGZuc3opOwogICAgIGlmICggIXAybV9wZm5zICkKICAgICB7CiAgICAgICAgIEVS
Uk9SKCJGYWlsZWQgdG8gKHJlKWFsbG9jICV6dSBieXRlcyBmb3IgcDJtIGZyYW1lIGxpc3QiLCBw
Mm1fcGZuc3opOwogICAgICAgICByZXR1cm4gLTE7CiAgICAgfQotICAgIGN0eC0+eDg2X3B2LnAy
bV9mcmFtZXMgPSBlbmRfZnJhbWU7Ci0gICAgY3R4LT54ODZfcHYucDJtX3BmbnMgPSBwMm1fcGZu
czsKKyAgICBjdHgtPng4Ni5wdi5wMm1fZnJhbWVzID0gZW5kX2ZyYW1lOworICAgIGN0eC0+eDg2
LnB2LnAybV9wZm5zID0gcDJtX3BmbnM7CiAKLSAgICBjdHgtPng4Nl9wdi5tYXhfcGZuID0gbWF4
X3BmbjsKKyAgICBjdHgtPng4Ni5wdi5tYXhfcGZuID0gbWF4X3BmbjsKICAgICBmb3IgKCBpID0g
KG9sZF9tYXggPyBvbGRfbWF4ICsgMSA6IDApOyBpIDw9IG1heF9wZm47ICsraSApCiAgICAgewog
ICAgICAgICBjdHgtPnJlc3RvcmUub3BzLnNldF9nZm4oY3R4LCBpLCBJTlZBTElEX01GTik7CkBA
IC02NCw3ICs2NCw3IEBAIHN0YXRpYyBpbnQgZXhwYW5kX3AybShzdHJ1Y3QgeGNfc3JfY29udGV4
dCAqY3R4LCB1bnNpZ25lZCBsb25nIG1heF9wZm4pCiAgICAgfQogCiAgICAgZm9yICggaSA9IChv
bGRfZW5kX2ZyYW1lID8gb2xkX2VuZF9mcmFtZSArIDEgOiAwKTsgaSA8PSBlbmRfZnJhbWU7ICsr
aSApCi0gICAgICAgIGN0eC0+eDg2X3B2LnAybV9wZm5zW2ldID0gSU5WQUxJRF9NRk47CisgICAg
ICAgIGN0eC0+eDg2LnB2LnAybV9wZm5zW2ldID0gSU5WQUxJRF9NRk47CiAKICAgICBEUFJJTlRG
KCJDaGFuZ2VkIG1heF9wZm4gZnJvbSAlI2x4IHRvICUjbHgiLCBvbGRfbWF4LCBtYXhfcGZuKTsK
ICAgICByZXR1cm4gMDsKQEAgLTc5LDEzICs3OSwxMyBAQCBzdGF0aWMgaW50IHBpbl9wYWdldGFi
bGVzKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAgICAgdW5zaWduZWQgbG9uZyBpLCBucl9w
aW5zOwogICAgIHN0cnVjdCBtbXVleHRfb3AgcGluW01BWF9QSU5fQkFUQ0hdOwogCi0gICAgZm9y
ICggaSA9IG5yX3BpbnMgPSAwOyBpIDw9IGN0eC0+eDg2X3B2Lm1heF9wZm47ICsraSApCisgICAg
Zm9yICggaSA9IG5yX3BpbnMgPSAwOyBpIDw9IGN0eC0+eDg2LnB2Lm1heF9wZm47ICsraSApCiAg
ICAgewotICAgICAgICBpZiAoIChjdHgtPng4Nl9wdi5yZXN0b3JlLnBmbl90eXBlc1tpXSAmCisg
ICAgICAgIGlmICggKGN0eC0+eDg2LnB2LnJlc3RvcmUucGZuX3R5cGVzW2ldICYKICAgICAgICAg
ICAgICAgWEVOX0RPTUNUTF9QRklORk9fTFBJTlRBQikgPT0gMCApCiAgICAgICAgICAgICBjb250
aW51ZTsKIAotICAgICAgICBzd2l0Y2ggKCAoY3R4LT54ODZfcHYucmVzdG9yZS5wZm5fdHlwZXNb
aV0gJgorICAgICAgICBzd2l0Y2ggKCAoY3R4LT54ODYucHYucmVzdG9yZS5wZm5fdHlwZXNbaV0g
JgogICAgICAgICAgICAgICAgICAgWEVOX0RPTUNUTF9QRklORk9fTFRBQlRZUEVfTUFTSykgKQog
ICAgICAgICB7CiAgICAgICAgIGNhc2UgWEVOX0RPTUNUTF9QRklORk9fTDFUQUI6CkBAIC0xMzgs
MTggKzEzOCwxOCBAQCBzdGF0aWMgaW50IHByb2Nlc3Nfc3RhcnRfaW5mbyhzdHJ1Y3QgeGNfc3Jf
Y29udGV4dCAqY3R4LAogICAgIHN0YXJ0X2luZm9fYW55X3QgKmd1ZXN0X3N0YXJ0X2luZm8gPSBO
VUxMOwogICAgIGludCByYyA9IC0xOwogCi0gICAgcGZuID0gR0VUX0ZJRUxEKHZjcHUsIHVzZXJf
cmVncy5lZHgsIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICBwZm4gPSBHRVRfRklFTEQodmNwdSwg
dXNlcl9yZWdzLmVkeCwgY3R4LT54ODYucHYud2lkdGgpOwogCi0gICAgaWYgKCBwZm4gPiBjdHgt
Png4Nl9wdi5tYXhfcGZuICkKKyAgICBpZiAoIHBmbiA+IGN0eC0+eDg2LnB2Lm1heF9wZm4gKQog
ICAgIHsKICAgICAgICAgRVJST1IoIlN0YXJ0IEluZm8gcGZuICUjbHggb3V0IG9mIHJhbmdlIiwg
cGZuKTsKICAgICAgICAgZ290byBlcnI7CiAgICAgfQogCi0gICAgaWYgKCBjdHgtPng4Nl9wdi5y
ZXN0b3JlLnBmbl90eXBlc1twZm5dICE9IFhFTl9ET01DVExfUEZJTkZPX05PVEFCICkKKyAgICBp
ZiAoIGN0eC0+eDg2LnB2LnJlc3RvcmUucGZuX3R5cGVzW3Bmbl0gIT0gWEVOX0RPTUNUTF9QRklO
Rk9fTk9UQUIgKQogICAgIHsKICAgICAgICAgRVJST1IoIlN0YXJ0IEluZm8gcGZuICUjbHggaGFz
IGJhZCB0eXBlICV1IiwgcGZuLAotICAgICAgICAgICAgICAoY3R4LT54ODZfcHYucmVzdG9yZS5w
Zm5fdHlwZXNbcGZuXSA+PgorICAgICAgICAgICAgICAoY3R4LT54ODYucHYucmVzdG9yZS5wZm5f
dHlwZXNbcGZuXSA+PgogICAgICAgICAgICAgICAgWEVOX0RPTUNUTF9QRklORk9fTFRBQl9TSElG
VCkpOwogICAgICAgICBnb3RvIGVycjsKICAgICB9CkBAIC0xNjIsNyArMTYyLDcgQEAgc3RhdGlj
IGludCBwcm9jZXNzX3N0YXJ0X2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwKICAgICAg
ICAgZ290byBlcnI7CiAgICAgfQogCi0gICAgU0VUX0ZJRUxEKHZjcHUsIHVzZXJfcmVncy5lZHgs
IG1mbiwgY3R4LT54ODZfcHYud2lkdGgpOworICAgIFNFVF9GSUVMRCh2Y3B1LCB1c2VyX3JlZ3Mu
ZWR4LCBtZm4sIGN0eC0+eDg2LnB2LndpZHRoKTsKICAgICBndWVzdF9zdGFydF9pbmZvID0geGNf
bWFwX2ZvcmVpZ25fcmFuZ2UoCiAgICAgICAgIHhjaCwgY3R4LT5kb21pZCwgUEFHRV9TSVpFLCBQ
Uk9UX1JFQUQgfCBQUk9UX1dSSVRFLCBtZm4pOwogICAgIGlmICggIWd1ZXN0X3N0YXJ0X2luZm8g
KQpAQCAtMTcyLDggKzE3Miw4IEBAIHN0YXRpYyBpbnQgcHJvY2Vzc19zdGFydF9pbmZvKHN0cnVj
dCB4Y19zcl9jb250ZXh0ICpjdHgsCiAgICAgfQogCiAgICAgLyogRGVhbCB3aXRoIHhlbnN0b3Jl
IHN0dWZmICovCi0gICAgcGZuID0gR0VUX0ZJRUxEKGd1ZXN0X3N0YXJ0X2luZm8sIHN0b3JlX21m
biwgY3R4LT54ODZfcHYud2lkdGgpOwotICAgIGlmICggcGZuID4gY3R4LT54ODZfcHYubWF4X3Bm
biApCisgICAgcGZuID0gR0VUX0ZJRUxEKGd1ZXN0X3N0YXJ0X2luZm8sIHN0b3JlX21mbiwgY3R4
LT54ODYucHYud2lkdGgpOworICAgIGlmICggcGZuID4gY3R4LT54ODYucHYubWF4X3BmbiApCiAg
ICAgewogICAgICAgICBFUlJPUigiWGVuU3RvcmUgcGZuICUjbHggb3V0IG9mIHJhbmdlIiwgcGZu
KTsKICAgICAgICAgZ290byBlcnI7CkBAIC0xODgsMTMgKzE4OCwxMyBAQCBzdGF0aWMgaW50IHBy
b2Nlc3Nfc3RhcnRfaW5mbyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LAogICAgIH0KIAogICAg
IGN0eC0+cmVzdG9yZS54ZW5zdG9yZV9nZm4gPSBtZm47Ci0gICAgU0VUX0ZJRUxEKGd1ZXN0X3N0
YXJ0X2luZm8sIHN0b3JlX21mbiwgbWZuLCBjdHgtPng4Nl9wdi53aWR0aCk7CisgICAgU0VUX0ZJ
RUxEKGd1ZXN0X3N0YXJ0X2luZm8sIHN0b3JlX21mbiwgbWZuLCBjdHgtPng4Ni5wdi53aWR0aCk7
CiAgICAgU0VUX0ZJRUxEKGd1ZXN0X3N0YXJ0X2luZm8sIHN0b3JlX2V2dGNobiwKLSAgICAgICAg
ICAgICAgY3R4LT5yZXN0b3JlLnhlbnN0b3JlX2V2dGNobiwgY3R4LT54ODZfcHYud2lkdGgpOwor
ICAgICAgICAgICAgICBjdHgtPnJlc3RvcmUueGVuc3RvcmVfZXZ0Y2huLCBjdHgtPng4Ni5wdi53
aWR0aCk7CiAKICAgICAvKiBEZWFsIHdpdGggY29uc29sZSBzdHVmZiAqLwotICAgIHBmbiA9IEdF
VF9GSUVMRChndWVzdF9zdGFydF9pbmZvLCBjb25zb2xlLmRvbVUubWZuLCBjdHgtPng4Nl9wdi53
aWR0aCk7Ci0gICAgaWYgKCBwZm4gPiBjdHgtPng4Nl9wdi5tYXhfcGZuICkKKyAgICBwZm4gPSBH
RVRfRklFTEQoZ3Vlc3Rfc3RhcnRfaW5mbywgY29uc29sZS5kb21VLm1mbiwgY3R4LT54ODYucHYu
d2lkdGgpOworICAgIGlmICggcGZuID4gY3R4LT54ODYucHYubWF4X3BmbiApCiAgICAgewogICAg
ICAgICBFUlJPUigiQ29uc29sZSBwZm4gJSNseCBvdXQgb2YgcmFuZ2UiLCBwZm4pOwogICAgICAg
ICBnb3RvIGVycjsKQEAgLTIwOSwxNiArMjA5LDE2IEBAIHN0YXRpYyBpbnQgcHJvY2Vzc19zdGFy
dF9pbmZvKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiAgICAgfQogCiAgICAgY3R4LT5yZXN0
b3JlLmNvbnNvbGVfZ2ZuID0gbWZuOwotICAgIFNFVF9GSUVMRChndWVzdF9zdGFydF9pbmZvLCBj
b25zb2xlLmRvbVUubWZuLCBtZm4sIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICBTRVRfRklFTEQo
Z3Vlc3Rfc3RhcnRfaW5mbywgY29uc29sZS5kb21VLm1mbiwgbWZuLCBjdHgtPng4Ni5wdi53aWR0
aCk7CiAgICAgU0VUX0ZJRUxEKGd1ZXN0X3N0YXJ0X2luZm8sIGNvbnNvbGUuZG9tVS5ldnRjaG4s
Ci0gICAgICAgICAgICAgIGN0eC0+cmVzdG9yZS5jb25zb2xlX2V2dGNobiwgY3R4LT54ODZfcHYu
d2lkdGgpOworICAgICAgICAgICAgICBjdHgtPnJlc3RvcmUuY29uc29sZV9ldnRjaG4sIGN0eC0+
eDg2LnB2LndpZHRoKTsKIAogICAgIC8qIFNldCBvdGhlciBpbmZvcm1hdGlvbiAqLwogICAgIFNF
VF9GSUVMRChndWVzdF9zdGFydF9pbmZvLCBucl9wYWdlcywKLSAgICAgICAgICAgICAgY3R4LT54
ODZfcHYubWF4X3BmbiArIDEsIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICAgICAgICAgICAgY3R4
LT54ODYucHYubWF4X3BmbiArIDEsIGN0eC0+eDg2LnB2LndpZHRoKTsKICAgICBTRVRfRklFTEQo
Z3Vlc3Rfc3RhcnRfaW5mbywgc2hhcmVkX2luZm8sCi0gICAgICAgICAgICAgIGN0eC0+ZG9taW5m
by5zaGFyZWRfaW5mb19mcmFtZSA8PCBQQUdFX1NISUZULCBjdHgtPng4Nl9wdi53aWR0aCk7Ci0g
ICAgU0VUX0ZJRUxEKGd1ZXN0X3N0YXJ0X2luZm8sIGZsYWdzLCAwLCBjdHgtPng4Nl9wdi53aWR0
aCk7CisgICAgICAgICAgICAgIGN0eC0+ZG9taW5mby5zaGFyZWRfaW5mb19mcmFtZSA8PCBQQUdF
X1NISUZULCBjdHgtPng4Ni5wdi53aWR0aCk7CisgICAgU0VUX0ZJRUxEKGd1ZXN0X3N0YXJ0X2lu
Zm8sIGZsYWdzLCAwLCBjdHgtPng4Ni5wdi53aWR0aCk7CiAKICAgICByYyA9IDA7CiAKQEAgLTIz
Niw3ICsyMzYsNyBAQCBzdGF0aWMgaW50IHByb2Nlc3NfdmNwdV9iYXNpYyhzdHJ1Y3QgeGNfc3Jf
Y29udGV4dCAqY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
IHZjcHVpZCkKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwotICAgIHZjcHVf
Z3Vlc3RfY29udGV4dF9hbnlfdCAqdmNwdSA9IGN0eC0+eDg2X3B2LnJlc3RvcmUudmNwdXNbdmNw
dWlkXS5iYXNpYy5wdHI7CisgICAgdmNwdV9ndWVzdF9jb250ZXh0X2FueV90ICp2Y3B1ID0gY3R4
LT54ODYucHYucmVzdG9yZS52Y3B1c1t2Y3B1aWRdLmJhc2ljLnB0cjsKICAgICB4ZW5fcGZuX3Qg
cGZuLCBtZm47CiAgICAgdW5zaWduZWQgaW50IGksIGdkdF9jb3VudDsKICAgICBpbnQgcmMgPSAt
MTsKQEAgLTI1MSwxMCArMjUxLDEwIEBAIHN0YXRpYyBpbnQgcHJvY2Vzc192Y3B1X2Jhc2ljKHN0
cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiAgICAgfQogCiAgICAgU0VUX0ZJRUxEKHZjcHUsIGZs
YWdzLAotICAgICAgICAgICAgICBHRVRfRklFTEQodmNwdSwgZmxhZ3MsIGN0eC0+eDg2X3B2Lndp
ZHRoKSB8IFZHQ0Zfb25saW5lLAotICAgICAgICAgICAgICBjdHgtPng4Nl9wdi53aWR0aCk7Cisg
ICAgICAgICAgICAgIEdFVF9GSUVMRCh2Y3B1LCBmbGFncywgY3R4LT54ODYucHYud2lkdGgpIHwg
VkdDRl9vbmxpbmUsCisgICAgICAgICAgICAgIGN0eC0+eDg2LnB2LndpZHRoKTsKIAotICAgIGdk
dF9jb3VudCA9IEdFVF9GSUVMRCh2Y3B1LCBnZHRfZW50cywgY3R4LT54ODZfcHYud2lkdGgpOwor
ICAgIGdkdF9jb3VudCA9IEdFVF9GSUVMRCh2Y3B1LCBnZHRfZW50cywgY3R4LT54ODYucHYud2lk
dGgpOwogICAgIGlmICggZ2R0X2NvdW50ID4gRklSU1RfUkVTRVJWRURfR0RUX0VOVFJZICkKICAg
ICB7CiAgICAgICAgIEVSUk9SKCJHRFQgZW50cnkgY291bnQgKCV1KSBvdXQgb2YgcmFuZ2UgKG1h
eCAldSkiLApAQCAtMjY3LDE3ICsyNjcsMTcgQEAgc3RhdGljIGludCBwcm9jZXNzX3ZjcHVfYmFz
aWMoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwKICAgICAvKiBDb252ZXJ0IEdEVCBmcmFtZXMg
dG8gbWZucy4gKi8KICAgICBmb3IgKCBpID0gMDsgaSA8IGdkdF9jb3VudDsgKytpICkKICAgICB7
Ci0gICAgICAgIHBmbiA9IEdFVF9GSUVMRCh2Y3B1LCBnZHRfZnJhbWVzW2ldLCBjdHgtPng4Nl9w
di53aWR0aCk7Ci0gICAgICAgIGlmICggcGZuID4gY3R4LT54ODZfcHYubWF4X3BmbiApCisgICAg
ICAgIHBmbiA9IEdFVF9GSUVMRCh2Y3B1LCBnZHRfZnJhbWVzW2ldLCBjdHgtPng4Ni5wdi53aWR0
aCk7CisgICAgICAgIGlmICggcGZuID4gY3R4LT54ODYucHYubWF4X3BmbiApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIEVSUk9SKCJHRFQgZnJhbWUgJXUgKHBmbiAlI2x4KSBvdXQgb2YgcmFuZ2Ui
LCBpLCBwZm4pOwogICAgICAgICAgICAgZ290byBlcnI7CiAgICAgICAgIH0KIAotICAgICAgICBp
ZiAoIChjdHgtPng4Nl9wdi5yZXN0b3JlLnBmbl90eXBlc1twZm5dICE9IFhFTl9ET01DVExfUEZJ
TkZPX05PVEFCKSApCisgICAgICAgIGlmICggKGN0eC0+eDg2LnB2LnJlc3RvcmUucGZuX3R5cGVz
W3Bmbl0gIT0gWEVOX0RPTUNUTF9QRklORk9fTk9UQUIpICkKICAgICAgICAgewogICAgICAgICAg
ICAgRVJST1IoIkdEVCBmcmFtZSAldSAocGZuICUjbHgpIGhhcyBiYWQgdHlwZSAldSIsIGksIHBm
biwKLSAgICAgICAgICAgICAgICAgIChjdHgtPng4Nl9wdi5yZXN0b3JlLnBmbl90eXBlc1twZm5d
ID4+CisgICAgICAgICAgICAgICAgICAoY3R4LT54ODYucHYucmVzdG9yZS5wZm5fdHlwZXNbcGZu
XSA+PgogICAgICAgICAgICAgICAgICAgIFhFTl9ET01DVExfUEZJTkZPX0xUQUJfU0hJRlQpKTsK
ICAgICAgICAgICAgIGdvdG8gZXJyOwogICAgICAgICB9CkBAIC0yOTAsMjUgKzI5MCwyNSBAQCBz
dGF0aWMgaW50IHByb2Nlc3NfdmNwdV9iYXNpYyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LAog
ICAgICAgICAgICAgZ290byBlcnI7CiAgICAgICAgIH0KIAotICAgICAgICBTRVRfRklFTEQodmNw
dSwgZ2R0X2ZyYW1lc1tpXSwgbWZuLCBjdHgtPng4Nl9wdi53aWR0aCk7CisgICAgICAgIFNFVF9G
SUVMRCh2Y3B1LCBnZHRfZnJhbWVzW2ldLCBtZm4sIGN0eC0+eDg2LnB2LndpZHRoKTsKICAgICB9
CiAKICAgICAvKiBDb252ZXJ0IENSMyB0byBhbiBtZm4uICovCi0gICAgcGZuID0gY3IzX3RvX21m
bihjdHgsIEdFVF9GSUVMRCh2Y3B1LCBjdHJscmVnWzNdLCBjdHgtPng4Nl9wdi53aWR0aCkpOwot
ICAgIGlmICggcGZuID4gY3R4LT54ODZfcHYubWF4X3BmbiApCisgICAgcGZuID0gY3IzX3RvX21m
bihjdHgsIEdFVF9GSUVMRCh2Y3B1LCBjdHJscmVnWzNdLCBjdHgtPng4Ni5wdi53aWR0aCkpOwor
ICAgIGlmICggcGZuID4gY3R4LT54ODYucHYubWF4X3BmbiApCiAgICAgewogICAgICAgICBFUlJP
UigiY3IzIChwZm4gJSNseCkgb3V0IG9mIHJhbmdlIiwgcGZuKTsKICAgICAgICAgZ290byBlcnI7
CiAgICAgfQogCi0gICAgaWYgKCAoY3R4LT54ODZfcHYucmVzdG9yZS5wZm5fdHlwZXNbcGZuXSAm
CisgICAgaWYgKCAoY3R4LT54ODYucHYucmVzdG9yZS5wZm5fdHlwZXNbcGZuXSAmCiAgICAgICAg
ICAgWEVOX0RPTUNUTF9QRklORk9fTFRBQlRZUEVfTUFTSykgIT0KLSAgICAgICAgICgoKHhlbl9w
Zm5fdCljdHgtPng4Nl9wdi5sZXZlbHMpIDw8IFhFTl9ET01DVExfUEZJTkZPX0xUQUJfU0hJRlQp
ICkKKyAgICAgICAgICgoKHhlbl9wZm5fdCljdHgtPng4Ni5wdi5sZXZlbHMpIDw8IFhFTl9ET01D
VExfUEZJTkZPX0xUQUJfU0hJRlQpICkKICAgICB7CiAgICAgICAgIEVSUk9SKCJjcjMgKHBmbiAl
I2x4KSBoYXMgYmFkIHR5cGUgJXUsIGV4cGVjdGVkICV1IiwgcGZuLAotICAgICAgICAgICAgICAo
Y3R4LT54ODZfcHYucmVzdG9yZS5wZm5fdHlwZXNbcGZuXSA+PgorICAgICAgICAgICAgICAoY3R4
LT54ODYucHYucmVzdG9yZS5wZm5fdHlwZXNbcGZuXSA+PgogICAgICAgICAgICAgICAgWEVOX0RP
TUNUTF9QRklORk9fTFRBQl9TSElGVCksCi0gICAgICAgICAgICAgIGN0eC0+eDg2X3B2LmxldmVs
cyk7CisgICAgICAgICAgICAgIGN0eC0+eDg2LnB2LmxldmVscyk7CiAgICAgICAgIGdvdG8gZXJy
OwogICAgIH0KIApAQCAtMzIwLDI3ICszMjAsMjcgQEAgc3RhdGljIGludCBwcm9jZXNzX3ZjcHVf
YmFzaWMoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwKICAgICAgICAgZ290byBlcnI7CiAgICAg
fQogCi0gICAgU0VUX0ZJRUxEKHZjcHUsIGN0cmxyZWdbM10sIG1mbl90b19jcjMoY3R4LCBtZm4p
LCBjdHgtPng4Nl9wdi53aWR0aCk7CisgICAgU0VUX0ZJRUxEKHZjcHUsIGN0cmxyZWdbM10sIG1m
bl90b19jcjMoY3R4LCBtZm4pLCBjdHgtPng4Ni5wdi53aWR0aCk7CiAKICAgICAvKiA2NGJpdCBn
dWVzdHM6IENvbnZlcnQgQ1IxIChndWVzdCBwYWdldGFibGVzKSB0byBtZm4uICovCi0gICAgaWYg
KCBjdHgtPng4Nl9wdi5sZXZlbHMgPT0gNCAmJiAodmNwdS0+eDY0LmN0cmxyZWdbMV0gJiAxKSAp
CisgICAgaWYgKCBjdHgtPng4Ni5wdi5sZXZlbHMgPT0gNCAmJiAodmNwdS0+eDY0LmN0cmxyZWdb
MV0gJiAxKSApCiAgICAgewogICAgICAgICBwZm4gPSB2Y3B1LT54NjQuY3RybHJlZ1sxXSA+PiBQ
QUdFX1NISUZUOwogCi0gICAgICAgIGlmICggcGZuID4gY3R4LT54ODZfcHYubWF4X3BmbiApCisg
ICAgICAgIGlmICggcGZuID4gY3R4LT54ODYucHYubWF4X3BmbiApCiAgICAgICAgIHsKICAgICAg
ICAgICAgIEVSUk9SKCJjcjEgKHBmbiAlI2x4KSBvdXQgb2YgcmFuZ2UiLCBwZm4pOwogICAgICAg
ICAgICAgZ290byBlcnI7CiAgICAgICAgIH0KIAotICAgICAgICBpZiAoIChjdHgtPng4Nl9wdi5y
ZXN0b3JlLnBmbl90eXBlc1twZm5dICYKKyAgICAgICAgaWYgKCAoY3R4LT54ODYucHYucmVzdG9y
ZS5wZm5fdHlwZXNbcGZuXSAmCiAgICAgICAgICAgICAgIFhFTl9ET01DVExfUEZJTkZPX0xUQUJU
WVBFX01BU0spICE9Ci0gICAgICAgICAgICAgKCgoeGVuX3Bmbl90KWN0eC0+eDg2X3B2LmxldmVs
cykgPDwgWEVOX0RPTUNUTF9QRklORk9fTFRBQl9TSElGVCkgKQorICAgICAgICAgICAgICgoKHhl
bl9wZm5fdCljdHgtPng4Ni5wdi5sZXZlbHMpIDw8IFhFTl9ET01DVExfUEZJTkZPX0xUQUJfU0hJ
RlQpICkKICAgICAgICAgewogICAgICAgICAgICAgRVJST1IoImNyMSAocGZuICUjbHgpIGhhcyBi
YWQgdHlwZSAldSwgZXhwZWN0ZWQgJXUiLCBwZm4sCi0gICAgICAgICAgICAgICAgICAoY3R4LT54
ODZfcHYucmVzdG9yZS5wZm5fdHlwZXNbcGZuXSA+PgorICAgICAgICAgICAgICAgICAgKGN0eC0+
eDg2LnB2LnJlc3RvcmUucGZuX3R5cGVzW3Bmbl0gPj4KICAgICAgICAgICAgICAgICAgICBYRU5f
RE9NQ1RMX1BGSU5GT19MVEFCX1NISUZUKSwKLSAgICAgICAgICAgICAgICAgIGN0eC0+eDg2X3B2
LmxldmVscyk7CisgICAgICAgICAgICAgICAgICBjdHgtPng4Ni5wdi5sZXZlbHMpOwogICAgICAg
ICAgICAgZ290byBlcnI7CiAgICAgICAgIH0KIApAQCAtMzc1LDcgKzM3NSw3IEBAIHN0YXRpYyBp
bnQgcHJvY2Vzc192Y3B1X2V4dGVuZGVkKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiB7CiAg
ICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKICAgICBzdHJ1Y3QgeGNfc3JfeDg2X3B2
X3Jlc3RvcmVfdmNwdSAqdmNwdSA9Ci0gICAgICAgICZjdHgtPng4Nl9wdi5yZXN0b3JlLnZjcHVz
W3ZjcHVpZF07CisgICAgICAgICZjdHgtPng4Ni5wdi5yZXN0b3JlLnZjcHVzW3ZjcHVpZF07CiAg
ICAgREVDTEFSRV9ET01DVEw7CiAKICAgICBkb21jdGwuY21kID0gWEVOX0RPTUNUTF9zZXRfZXh0
X3ZjcHVjb250ZXh0OwpAQCAtMzk5LDcgKzM5OSw3IEBAIHN0YXRpYyBpbnQgcHJvY2Vzc192Y3B1
X3hzYXZlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4
Y2ggPSBjdHgtPnhjaDsKICAgICBzdHJ1Y3QgeGNfc3JfeDg2X3B2X3Jlc3RvcmVfdmNwdSAqdmNw
dSA9Ci0gICAgICAgICZjdHgtPng4Nl9wdi5yZXN0b3JlLnZjcHVzW3ZjcHVpZF07CisgICAgICAg
ICZjdHgtPng4Ni5wdi5yZXN0b3JlLnZjcHVzW3ZjcHVpZF07CiAgICAgaW50IHJjOwogICAgIERF
Q0xBUkVfRE9NQ1RMOwogICAgIERFQ0xBUkVfSFlQRVJDQUxMX0JVRkZFUih2b2lkLCBidWZmZXIp
OwpAQCAtNDM3LDcgKzQzNyw3IEBAIHN0YXRpYyBpbnQgcHJvY2Vzc192Y3B1X21zcnMoc3RydWN0
IHhjX3NyX2NvbnRleHQgKmN0eCwKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNo
OwogICAgIHN0cnVjdCB4Y19zcl94ODZfcHZfcmVzdG9yZV92Y3B1ICp2Y3B1ID0KLSAgICAgICAg
JmN0eC0+eDg2X3B2LnJlc3RvcmUudmNwdXNbdmNwdWlkXTsKKyAgICAgICAgJmN0eC0+eDg2LnB2
LnJlc3RvcmUudmNwdXNbdmNwdWlkXTsKICAgICBpbnQgcmM7CiAgICAgREVDTEFSRV9ET01DVEw7
CiAgICAgREVDTEFSRV9IWVBFUkNBTExfQlVGRkVSKHZvaWQsIGJ1ZmZlcik7CkBAIC00NzcsOSAr
NDc3LDkgQEAgc3RhdGljIGludCB1cGRhdGVfdmNwdV9jb250ZXh0KHN0cnVjdCB4Y19zcl9jb250
ZXh0ICpjdHgpCiAgICAgdW5zaWduZWQgaW50IGk7CiAgICAgaW50IHJjID0gMDsKIAotICAgIGZv
ciAoIGkgPSAwOyBpIDwgY3R4LT54ODZfcHYucmVzdG9yZS5ucl92Y3B1czsgKytpICkKKyAgICBm
b3IgKCBpID0gMDsgaSA8IGN0eC0+eDg2LnB2LnJlc3RvcmUubnJfdmNwdXM7ICsraSApCiAgICAg
ewotICAgICAgICB2Y3B1ID0gJmN0eC0+eDg2X3B2LnJlc3RvcmUudmNwdXNbaV07CisgICAgICAg
IHZjcHUgPSAmY3R4LT54ODYucHYucmVzdG9yZS52Y3B1c1tpXTsKIAogICAgICAgICBpZiAoIHZj
cHUtPmJhc2ljLnB0ciApCiAgICAgICAgIHsKQEAgLTUzMCwyMSArNTMwLDIxIEBAIHN0YXRpYyBp
bnQgdXBkYXRlX2d1ZXN0X3AybShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAgIHVuc2ln
bmVkIGludCBpOwogICAgIGludCByYyA9IC0xOwogCi0gICAgZm9yICggaSA9IDA7IGkgPCBjdHgt
Png4Nl9wdi5wMm1fZnJhbWVzOyArK2kgKQorICAgIGZvciAoIGkgPSAwOyBpIDwgY3R4LT54ODYu
cHYucDJtX2ZyYW1lczsgKytpICkKICAgICB7Ci0gICAgICAgIHBmbiA9IGN0eC0+eDg2X3B2LnAy
bV9wZm5zW2ldOworICAgICAgICBwZm4gPSBjdHgtPng4Ni5wdi5wMm1fcGZuc1tpXTsKIAotICAg
ICAgICBpZiAoIHBmbiA+IGN0eC0+eDg2X3B2Lm1heF9wZm4gKQorICAgICAgICBpZiAoIHBmbiA+
IGN0eC0+eDg2LnB2Lm1heF9wZm4gKQogICAgICAgICB7CiAgICAgICAgICAgICBFUlJPUigicGZu
ICglI2x4KSBmb3IgcDJtX2ZyYW1lX2xpc3RbJXVdIG91dCBvZiByYW5nZSIsCiAgICAgICAgICAg
ICAgICAgICBwZm4sIGkpOwogICAgICAgICAgICAgZ290byBlcnI7CiAgICAgICAgIH0KIAotICAg
ICAgICBpZiAoIChjdHgtPng4Nl9wdi5yZXN0b3JlLnBmbl90eXBlc1twZm5dICE9IFhFTl9ET01D
VExfUEZJTkZPX05PVEFCKSApCisgICAgICAgIGlmICggKGN0eC0+eDg2LnB2LnJlc3RvcmUucGZu
X3R5cGVzW3Bmbl0gIT0gWEVOX0RPTUNUTF9QRklORk9fTk9UQUIpICkKICAgICAgICAgewogICAg
ICAgICAgICAgRVJST1IoInBmbiAoJSNseCkgZm9yIHAybV9mcmFtZV9saXN0WyV1XSBoYXMgYmFk
IHR5cGUgJXUiLCBwZm4sIGksCi0gICAgICAgICAgICAgICAgICAoY3R4LT54ODZfcHYucmVzdG9y
ZS5wZm5fdHlwZXNbcGZuXSA+PgorICAgICAgICAgICAgICAgICAgKGN0eC0+eDg2LnB2LnJlc3Rv
cmUucGZuX3R5cGVzW3Bmbl0gPj4KICAgICAgICAgICAgICAgICAgICBYRU5fRE9NQ1RMX1BGSU5G
T19MVEFCX1NISUZUKSk7CiAgICAgICAgICAgICBnb3RvIGVycjsKICAgICAgICAgfQpAQCAtNTU3
LDI1ICs1NTcsMjUgQEAgc3RhdGljIGludCB1cGRhdGVfZ3Vlc3RfcDJtKHN0cnVjdCB4Y19zcl9j
b250ZXh0ICpjdHgpCiAgICAgICAgICAgICBnb3RvIGVycjsKICAgICAgICAgfQogCi0gICAgICAg
IGN0eC0+eDg2X3B2LnAybV9wZm5zW2ldID0gbWZuOworICAgICAgICBjdHgtPng4Ni5wdi5wMm1f
cGZuc1tpXSA9IG1mbjsKICAgICB9CiAKICAgICBndWVzdF9wMm0gPSB4Y19tYXBfZm9yZWlnbl9w
YWdlcyh4Y2gsIGN0eC0+ZG9taWQsIFBST1RfV1JJVEUsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY3R4LT54ODZfcHYucDJtX3BmbnMsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY3R4LT54ODZfcHYucDJtX2ZyYW1lcyk7CisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT54ODYucHYucDJtX3BmbnMsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LT54ODYucHYucDJtX2ZyYW1lcyk7CiAgICAg
aWYgKCAhZ3Vlc3RfcDJtICkKICAgICB7CiAgICAgICAgIFBFUlJPUigiRmFpbGVkIHRvIG1hcCBw
Mm0gZnJhbWVzIik7CiAgICAgICAgIGdvdG8gZXJyOwogICAgIH0KIAotICAgIG1lbWNweShndWVz
dF9wMm0sIGN0eC0+eDg2X3B2LnAybSwKLSAgICAgICAgICAgKGN0eC0+eDg2X3B2Lm1heF9wZm4g
KyAxKSAqIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICBtZW1jcHkoZ3Vlc3RfcDJtLCBjdHgtPng4
Ni5wdi5wMm0sCisgICAgICAgICAgIChjdHgtPng4Ni5wdi5tYXhfcGZuICsgMSkgKiBjdHgtPng4
Ni5wdi53aWR0aCk7CiAgICAgcmMgPSAwOwogCiAgZXJyOgogICAgIGlmICggZ3Vlc3RfcDJtICkK
LSAgICAgICAgbXVubWFwKGd1ZXN0X3AybSwgY3R4LT54ODZfcHYucDJtX2ZyYW1lcyAqIFBBR0Vf
U0laRSk7CisgICAgICAgIG11bm1hcChndWVzdF9wMm0sIGN0eC0+eDg2LnB2LnAybV9mcmFtZXMg
KiBQQUdFX1NJWkUpOwogCiAgICAgcmV0dXJuIHJjOwogfQpAQCAtNjA0LDcgKzYwNCw3IEBAIHN0
YXRpYyBpbnQgaGFuZGxlX3g4Nl9wdl9pbmZvKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiAg
ICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKICAgICBzdHJ1Y3QgeGNfc3JfcmVjX3g4
Nl9wdl9pbmZvICppbmZvID0gcmVjLT5kYXRhOwogCi0gICAgaWYgKCBjdHgtPng4Nl9wdi5yZXN0
b3JlLnNlZW5fcHZfaW5mbyApCisgICAgaWYgKCBjdHgtPng4Ni5wdi5yZXN0b3JlLnNlZW5fcHZf
aW5mbyApCiAgICAgewogICAgICAgICBFUlJPUigiQWxyZWFkeSByZWNlaXZlZCBYODZfUFZfSU5G
TyByZWNvcmQiKTsKICAgICAgICAgcmV0dXJuIC0xOwpAQCAtNjI4LDcgKzYyOCw3IEBAIHN0YXRp
YyBpbnQgaGFuZGxlX3g4Nl9wdl9pbmZvKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiAgICAg
ICogUFYgZG9tYWlucyBkZWZhdWx0IHRvIG5hdGl2ZSB3aWR0aC4gIEZvciBhbiBpbmNvbW1pbmcg
Y29tcGF0IGRvbWFpbiwgd2UKICAgICAgKiB3aWxsIHR5cGljYWxseSBiZSB0aGUgZmlyc3QgZW50
aXR5IHRvIGluZm9ybSBYZW4uCiAgICAgICovCi0gICAgaWYgKCBpbmZvLT5ndWVzdF93aWR0aCAh
PSBjdHgtPng4Nl9wdi53aWR0aCApCisgICAgaWYgKCBpbmZvLT5ndWVzdF93aWR0aCAhPSBjdHgt
Png4Ni5wdi53aWR0aCApCiAgICAgewogICAgICAgICBzdHJ1Y3QgeGVuX2RvbWN0bCBkb21jdGwg
PSB7CiAgICAgICAgICAgICAuZG9tYWluID0gY3R4LT5kb21pZCwKQEAgLTY1NCwxNiArNjU0LDE2
IEBAIHN0YXRpYyBpbnQgaGFuZGxlX3g4Nl9wdl9pbmZvKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpj
dHgsCiAgICAgfQogCiAgICAgLyogU2FuaXR5IGNoZWNrIChwb3NzaWJseSBuZXcpIGRvbWFpbiBz
ZXR0aW5ncy4gKi8KLSAgICBpZiAoIChpbmZvLT5ndWVzdF93aWR0aCAhPSBjdHgtPng4Nl9wdi53
aWR0aCkgfHwKLSAgICAgICAgIChpbmZvLT5wdF9sZXZlbHMgICAhPSBjdHgtPng4Nl9wdi5sZXZl
bHMpICkKKyAgICBpZiAoIChpbmZvLT5ndWVzdF93aWR0aCAhPSBjdHgtPng4Ni5wdi53aWR0aCkg
fHwKKyAgICAgICAgIChpbmZvLT5wdF9sZXZlbHMgICAhPSBjdHgtPng4Ni5wdi5sZXZlbHMpICkK
ICAgICB7CiAgICAgICAgIEVSUk9SKCJYODZfUFZfSU5GTyB3aWR0aC9wdF9sZXZlbHMgc2V0dGlu
Z3MgJXUvJXUgbWlzbWF0Y2ggd2l0aCBkJWQgJXUvJXUiLAogICAgICAgICAgICAgICBpbmZvLT5n
dWVzdF93aWR0aCwgaW5mby0+cHRfbGV2ZWxzLCBjdHgtPmRvbWlkLAotICAgICAgICAgICAgICBj
dHgtPng4Nl9wdi53aWR0aCwgY3R4LT54ODZfcHYubGV2ZWxzKTsKKyAgICAgICAgICAgICAgY3R4
LT54ODYucHYud2lkdGgsIGN0eC0+eDg2LnB2LmxldmVscyk7CiAgICAgICAgIHJldHVybiAtMTsK
ICAgICB9CiAKLSAgICBjdHgtPng4Nl9wdi5yZXN0b3JlLnNlZW5fcHZfaW5mbyA9IHRydWU7Cisg
ICAgY3R4LT54ODYucHYucmVzdG9yZS5zZWVuX3B2X2luZm8gPSB0cnVlOwogICAgIHJldHVybiAw
OwogfQogCkBAIC02NzYsMTAgKzY3NiwxMCBAQCBzdGF0aWMgaW50IGhhbmRsZV94ODZfcHZfcDJt
X2ZyYW1lcyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LAogewogICAgIHhjX2ludGVyZmFjZSAq
eGNoID0gY3R4LT54Y2g7CiAgICAgc3RydWN0IHhjX3NyX3JlY194ODZfcHZfcDJtX2ZyYW1lcyAq
ZGF0YSA9IHJlYy0+ZGF0YTsKLSAgICB1bnNpZ25lZCBpbnQgc3RhcnQsIGVuZCwgeCwgZnBwID0g
UEFHRV9TSVpFIC8gY3R4LT54ODZfcHYud2lkdGg7CisgICAgdW5zaWduZWQgaW50IHN0YXJ0LCBl
bmQsIHgsIGZwcCA9IFBBR0VfU0laRSAvIGN0eC0+eDg2LnB2LndpZHRoOwogICAgIGludCByYzsK
IAotICAgIGlmICggIWN0eC0+eDg2X3B2LnJlc3RvcmUuc2Vlbl9wdl9pbmZvICkKKyAgICBpZiAo
ICFjdHgtPng4Ni5wdi5yZXN0b3JlLnNlZW5fcHZfaW5mbyApCiAgICAgewogICAgICAgICBFUlJP
UigiTm90IHlldCByZWNlaXZlZCBYODZfUFZfSU5GTyByZWNvcmQiKTsKICAgICAgICAgcmV0dXJu
IC0xOwpAQCAtNzExLDcgKzcxMSw3IEBAIHN0YXRpYyBpbnQgaGFuZGxlX3g4Nl9wdl9wMm1fZnJh
bWVzKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiAgICAgICAgIHJldHVybiAtMTsKICAgICB9
CiAKLSAgICBpZiAoIGRhdGEtPmVuZF9wZm4gPiBjdHgtPng4Nl9wdi5tYXhfcGZuICkKKyAgICBp
ZiAoIGRhdGEtPmVuZF9wZm4gPiBjdHgtPng4Ni5wdi5tYXhfcGZuICkKICAgICB7CiAgICAgICAg
IHJjID0gZXhwYW5kX3AybShjdHgsIGRhdGEtPmVuZF9wZm4pOwogICAgICAgICBpZiAoIHJjICkK
QEAgLTcxOSw3ICs3MTksNyBAQCBzdGF0aWMgaW50IGhhbmRsZV94ODZfcHZfcDJtX2ZyYW1lcyhz
dHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LAogICAgIH0KIAogICAgIGZvciAoIHggPSAwOyB4IDwg
KGVuZCAtIHN0YXJ0KTsgKyt4ICkKLSAgICAgICAgY3R4LT54ODZfcHYucDJtX3BmbnNbc3RhcnQg
KyB4XSA9IGRhdGEtPnAybV9wZm5zW3hdOworICAgICAgICBjdHgtPng4Ni5wdi5wMm1fcGZuc1tz
dGFydCArIHhdID0gZGF0YS0+cDJtX3BmbnNbeF07CiAKICAgICByZXR1cm4gMDsKIH0KQEAgLTc4
OCwyMSArNzg4LDIxIEBAIHN0YXRpYyBpbnQgaGFuZGxlX3g4Nl9wdl92Y3B1X2Jsb2Ioc3RydWN0
IHhjX3NyX2NvbnRleHQgKmN0eCwKICAgICB9CiAKICAgICAvKiBDaGVjayB0aGF0IHRoZSB2Y3B1
IGlkIGlzIHdpdGhpbiByYW5nZS4gKi8KLSAgICBpZiAoIHZoZHItPnZjcHVfaWQgPj0gY3R4LT54
ODZfcHYucmVzdG9yZS5ucl92Y3B1cyApCisgICAgaWYgKCB2aGRyLT52Y3B1X2lkID49IGN0eC0+
eDg2LnB2LnJlc3RvcmUubnJfdmNwdXMgKQogICAgIHsKICAgICAgICAgRVJST1IoIiVzIHJlY29y
ZCB2Y3B1X2lkICgldSkgZXhjZWVkcyBkb21haW4gbWF4ICgldSkiLAotICAgICAgICAgICAgICBy
ZWNfbmFtZSwgdmhkci0+dmNwdV9pZCwgY3R4LT54ODZfcHYucmVzdG9yZS5ucl92Y3B1cyAtIDEp
OworICAgICAgICAgICAgICByZWNfbmFtZSwgdmhkci0+dmNwdV9pZCwgY3R4LT54ODYucHYucmVz
dG9yZS5ucl92Y3B1cyAtIDEpOwogICAgICAgICBnb3RvIG91dDsKICAgICB9CiAKLSAgICB2Y3B1
ID0gJmN0eC0+eDg2X3B2LnJlc3RvcmUudmNwdXNbdmhkci0+dmNwdV9pZF07CisgICAgdmNwdSA9
ICZjdHgtPng4Ni5wdi5yZXN0b3JlLnZjcHVzW3ZoZHItPnZjcHVfaWRdOwogCiAgICAgLyogRnVy
dGhlciBwZXItcmVjb3JkIGNoZWNrcywgd2hlcmUgcG9zc2libGUuICovCiAgICAgc3dpdGNoICgg
cmVjLT50eXBlICkKICAgICB7CiAgICAgY2FzZSBSRUNfVFlQRV9YODZfUFZfVkNQVV9CQVNJQzoK
ICAgICB7Ci0gICAgICAgIHNpemVfdCB2Y3B1c3ogPSBjdHgtPng4Nl9wdi53aWR0aCA9PSA4ID8K
KyAgICAgICAgc2l6ZV90IHZjcHVzeiA9IGN0eC0+eDg2LnB2LndpZHRoID09IDggPwogICAgICAg
ICAgICAgc2l6ZW9mKHZjcHVfZ3Vlc3RfY29udGV4dF94ODZfNjRfdCkgOgogICAgICAgICAgICAg
c2l6ZW9mKHZjcHVfZ3Vlc3RfY29udGV4dF94ODZfMzJfdCk7CiAKQEAgLTg2OCw3ICs4NjgsNyBA
QCBzdGF0aWMgaW50IGhhbmRsZV9zaGFyZWRfaW5mbyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4
LAogICAgIHNoYXJlZF9pbmZvX2FueV90ICpndWVzdF9zaGluZm8gPSBOVUxMOwogICAgIGNvbnN0
IHNoYXJlZF9pbmZvX2FueV90ICpvbGRfc2hpbmZvID0gcmVjLT5kYXRhOwogCi0gICAgaWYgKCAh
Y3R4LT54ODZfcHYucmVzdG9yZS5zZWVuX3B2X2luZm8gKQorICAgIGlmICggIWN0eC0+eDg2LnB2
LnJlc3RvcmUuc2Vlbl9wdl9pbmZvICkKICAgICB7CiAgICAgICAgIEVSUk9SKCJOb3QgeWV0IHJl
Y2VpdmVkIFg4Nl9QVl9JTkZPIHJlY29yZCIpOwogICAgICAgICByZXR1cm4gLTE7CkBAIC04OTEs
MTggKzg5MSwxOCBAQCBzdGF0aWMgaW50IGhhbmRsZV9zaGFyZWRfaW5mbyhzdHJ1Y3QgeGNfc3Jf
Y29udGV4dCAqY3R4LAogICAgICAgICBnb3RvIGVycjsKICAgICB9CiAKLSAgICBNRU1DUFlfRklF
TEQoZ3Vlc3Rfc2hpbmZvLCBvbGRfc2hpbmZvLCB2Y3B1X2luZm8sIGN0eC0+eDg2X3B2LndpZHRo
KTsKLSAgICBNRU1DUFlfRklFTEQoZ3Vlc3Rfc2hpbmZvLCBvbGRfc2hpbmZvLCBhcmNoLCBjdHgt
Png4Nl9wdi53aWR0aCk7CisgICAgTUVNQ1BZX0ZJRUxEKGd1ZXN0X3NoaW5mbywgb2xkX3NoaW5m
bywgdmNwdV9pbmZvLCBjdHgtPng4Ni5wdi53aWR0aCk7CisgICAgTUVNQ1BZX0ZJRUxEKGd1ZXN0
X3NoaW5mbywgb2xkX3NoaW5mbywgYXJjaCwgY3R4LT54ODYucHYud2lkdGgpOwogCiAgICAgU0VU
X0ZJRUxEKGd1ZXN0X3NoaW5mbywgYXJjaC5wZm5fdG9fbWZuX2ZyYW1lX2xpc3RfbGlzdCwKLSAg
ICAgICAgICAgICAgMCwgY3R4LT54ODZfcHYud2lkdGgpOworICAgICAgICAgICAgICAwLCBjdHgt
Png4Ni5wdi53aWR0aCk7CiAKLSAgICBNRU1TRVRfQVJSQVlfRklFTEQoZ3Vlc3Rfc2hpbmZvLCBl
dnRjaG5fcGVuZGluZywgMCwgY3R4LT54ODZfcHYud2lkdGgpOworICAgIE1FTVNFVF9BUlJBWV9G
SUVMRChndWVzdF9zaGluZm8sIGV2dGNobl9wZW5kaW5nLCAwLCBjdHgtPng4Ni5wdi53aWR0aCk7
CiAgICAgZm9yICggaSA9IDA7IGkgPCBYRU5fTEVHQUNZX01BWF9WQ1BVUzsgaSsrICkKICAgICAg
ICAgU0VUX0ZJRUxEKGd1ZXN0X3NoaW5mbywgdmNwdV9pbmZvW2ldLmV2dGNobl9wZW5kaW5nX3Nl
bCwKLSAgICAgICAgICAgICAgICAgIDAsIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICAgICAgICAg
ICAgICAgIDAsIGN0eC0+eDg2LnB2LndpZHRoKTsKIAotICAgIE1FTVNFVF9BUlJBWV9GSUVMRChn
dWVzdF9zaGluZm8sIGV2dGNobl9tYXNrLCAweGZmLCBjdHgtPng4Nl9wdi53aWR0aCk7CisgICAg
TUVNU0VUX0FSUkFZX0ZJRUxEKGd1ZXN0X3NoaW5mbywgZXZ0Y2huX21hc2ssIDB4ZmYsIGN0eC0+
eDg2LnB2LndpZHRoKTsKIAogICAgIHJjID0gMDsKIApAQCAtOTE2LDMwICs5MTYsMzAgQEAgc3Rh
dGljIGludCBoYW5kbGVfc2hhcmVkX2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwKIC8q
IHJlc3RvcmVfb3BzIGZ1bmN0aW9uLiAqLwogc3RhdGljIGJvb2wgeDg2X3B2X3Bmbl9pc192YWxp
ZChjb25zdCBzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB4ZW5fcGZuX3QgcGZuKQogewotICAg
IHJldHVybiBwZm4gPD0gY3R4LT54ODZfcHYubWF4X3BmbjsKKyAgICByZXR1cm4gcGZuIDw9IGN0
eC0+eDg2LnB2Lm1heF9wZm47CiB9CiAKIC8qIHJlc3RvcmVfb3BzIGZ1bmN0aW9uLiAqLwogc3Rh
dGljIHZvaWQgeDg2X3B2X3NldF9wYWdlX3R5cGUoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwg
eGVuX3Bmbl90IHBmbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVk
IGxvbmcgdHlwZSkKIHsKLSAgICBhc3NlcnQocGZuIDw9IGN0eC0+eDg2X3B2Lm1heF9wZm4pOwor
ICAgIGFzc2VydChwZm4gPD0gY3R4LT54ODYucHYubWF4X3Bmbik7CiAKLSAgICBjdHgtPng4Nl9w
di5yZXN0b3JlLnBmbl90eXBlc1twZm5dID0gdHlwZTsKKyAgICBjdHgtPng4Ni5wdi5yZXN0b3Jl
LnBmbl90eXBlc1twZm5dID0gdHlwZTsKIH0KIAogLyogcmVzdG9yZV9vcHMgZnVuY3Rpb24uICov
CiBzdGF0aWMgdm9pZCB4ODZfcHZfc2V0X2dmbihzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB4
ZW5fcGZuX3QgcGZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVuX3Bmbl90IG1mbikK
IHsKLSAgICBhc3NlcnQocGZuIDw9IGN0eC0+eDg2X3B2Lm1heF9wZm4pOworICAgIGFzc2VydChw
Zm4gPD0gY3R4LT54ODYucHYubWF4X3Bmbik7CiAKLSAgICBpZiAoIGN0eC0+eDg2X3B2LndpZHRo
ID09IHNpemVvZih1aW50NjRfdCkgKQorICAgIGlmICggY3R4LT54ODYucHYud2lkdGggPT0gc2l6
ZW9mKHVpbnQ2NF90KSApCiAgICAgICAgIC8qIDY0IGJpdCBndWVzdC4gIE5lZWQgdG8gZXhwYW5k
IElOVkFMSURfTUZOIGZvciAzMiBiaXQgdG9vbHN0YWNrcy4gKi8KLSAgICAgICAgKCh1aW50NjRf
dCAqKWN0eC0+eDg2X3B2LnAybSlbcGZuXSA9IG1mbiA9PSBJTlZBTElEX01GTiA/IH4wVUxMIDog
bWZuOworICAgICAgICAoKHVpbnQ2NF90ICopY3R4LT54ODYucHYucDJtKVtwZm5dID0gbWZuID09
IElOVkFMSURfTUZOID8gfjBVTEwgOiBtZm47CiAgICAgZWxzZQogICAgICAgICAvKiAzMiBiaXQg
Z3Vlc3QuICBDYW4gdHJ1bmNhdGUgSU5WQUxJRF9NRk4gZm9yIDY0IGJpdCB0b29sc3RhY2tzLiAq
LwotICAgICAgICAoKHVpbnQzMl90ICopY3R4LT54ODZfcHYucDJtKVtwZm5dID0gbWZuOworICAg
ICAgICAoKHVpbnQzMl90ICopY3R4LT54ODYucHYucDJtKVtwZm5dID0gbWZuOwogfQogCiAvKgpA
QCAtMTA0MywxMCArMTA0MywxMCBAQCBzdGF0aWMgaW50IHg4Nl9wdl9zZXR1cChzdHJ1Y3QgeGNf
c3JfY29udGV4dCAqY3R4KQogICAgIGlmICggcmMgKQogICAgICAgICByZXR1cm4gcmM7CiAKLSAg
ICBjdHgtPng4Nl9wdi5yZXN0b3JlLm5yX3ZjcHVzID0gY3R4LT5kb21pbmZvLm1heF92Y3B1X2lk
ICsgMTsKLSAgICBjdHgtPng4Nl9wdi5yZXN0b3JlLnZjcHVzID0gY2FsbG9jKHNpemVvZihzdHJ1
Y3QgeGNfc3JfeDg2X3B2X3Jlc3RvcmVfdmNwdSksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjdHgtPng4Nl9wdi5yZXN0b3JlLm5yX3ZjcHVzKTsKLSAgICBpZiAoICFj
dHgtPng4Nl9wdi5yZXN0b3JlLnZjcHVzICkKKyAgICBjdHgtPng4Ni5wdi5yZXN0b3JlLm5yX3Zj
cHVzID0gY3R4LT5kb21pbmZvLm1heF92Y3B1X2lkICsgMTsKKyAgICBjdHgtPng4Ni5wdi5yZXN0
b3JlLnZjcHVzID0gY2FsbG9jKHNpemVvZihzdHJ1Y3QgeGNfc3JfeDg2X3B2X3Jlc3RvcmVfdmNw
dSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPng4Ni5wdi5y
ZXN0b3JlLm5yX3ZjcHVzKTsKKyAgICBpZiAoICFjdHgtPng4Ni5wdi5yZXN0b3JlLnZjcHVzICkK
ICAgICB7CiAgICAgICAgIGVycm5vID0gRU5PTUVNOwogICAgICAgICByZXR1cm4gLTE7CkBAIC0x
MTMwLDE3ICsxMTMwLDE3IEBAIHN0YXRpYyBpbnQgeDg2X3B2X3N0cmVhbV9jb21wbGV0ZShzdHJ1
Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICovCiBzdGF0aWMgaW50IHg4Nl9wdl9jbGVhbnVwKHN0
cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiB7Ci0gICAgZnJlZShjdHgtPng4Nl9wdi5wMm0pOwot
ICAgIGZyZWUoY3R4LT54ODZfcHYucDJtX3BmbnMpOworICAgIGZyZWUoY3R4LT54ODYucHYucDJt
KTsKKyAgICBmcmVlKGN0eC0+eDg2LnB2LnAybV9wZm5zKTsKIAotICAgIGlmICggY3R4LT54ODZf
cHYucmVzdG9yZS52Y3B1cyApCisgICAgaWYgKCBjdHgtPng4Ni5wdi5yZXN0b3JlLnZjcHVzICkK
ICAgICB7CiAgICAgICAgIHVuc2lnbmVkIGludCBpOwogCi0gICAgICAgIGZvciAoIGkgPSAwOyBp
IDwgY3R4LT54ODZfcHYucmVzdG9yZS5ucl92Y3B1czsgKytpICkKKyAgICAgICAgZm9yICggaSA9
IDA7IGkgPCBjdHgtPng4Ni5wdi5yZXN0b3JlLm5yX3ZjcHVzOyArK2kgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBzdHJ1Y3QgeGNfc3JfeDg2X3B2X3Jlc3RvcmVfdmNwdSAqdmNwdSA9Ci0gICAg
ICAgICAgICAgICAgJmN0eC0+eDg2X3B2LnJlc3RvcmUudmNwdXNbaV07CisgICAgICAgICAgICAg
ICAgJmN0eC0+eDg2LnB2LnJlc3RvcmUudmNwdXNbaV07CiAKICAgICAgICAgICAgIGZyZWUodmNw
dS0+YmFzaWMucHRyKTsKICAgICAgICAgICAgIGZyZWUodmNwdS0+ZXh0ZC5wdHIpOwpAQCAtMTE0
OCwxMyArMTE0OCwxMyBAQCBzdGF0aWMgaW50IHg4Nl9wdl9jbGVhbnVwKHN0cnVjdCB4Y19zcl9j
b250ZXh0ICpjdHgpCiAgICAgICAgICAgICBmcmVlKHZjcHUtPm1zci5wdHIpOwogICAgICAgICB9
CiAKLSAgICAgICAgZnJlZShjdHgtPng4Nl9wdi5yZXN0b3JlLnZjcHVzKTsKKyAgICAgICAgZnJl
ZShjdHgtPng4Ni5wdi5yZXN0b3JlLnZjcHVzKTsKICAgICB9CiAKLSAgICBmcmVlKGN0eC0+eDg2
X3B2LnJlc3RvcmUucGZuX3R5cGVzKTsKKyAgICBmcmVlKGN0eC0+eDg2LnB2LnJlc3RvcmUucGZu
X3R5cGVzKTsKIAotICAgIGlmICggY3R4LT54ODZfcHYubTJwICkKLSAgICAgICAgbXVubWFwKGN0
eC0+eDg2X3B2Lm0ycCwgY3R4LT54ODZfcHYubnJfbTJwX2ZyYW1lcyAqIFBBR0VfU0laRSk7Cisg
ICAgaWYgKCBjdHgtPng4Ni5wdi5tMnAgKQorICAgICAgICBtdW5tYXAoY3R4LT54ODYucHYubTJw
LCBjdHgtPng4Ni5wdi5ucl9tMnBfZnJhbWVzICogUEFHRV9TSVpFKTsKIAogICAgIHJldHVybiAw
OwogfQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfc3Jfc2F2ZV94ODZfaHZtLmMgYi90b29s
cy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9odm0uYwppbmRleCBkOTI1YTgxOTk5Li41ODcyMjExOGFl
IDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9odm0uYworKysgYi90b29s
cy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9odm0uYwpAQCAtMTY1LDcgKzE2NSw3IEBAIHN0YXRpYyBp
bnQgeDg2X2h2bV9zZXR1cChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAgICAgICByZXR1
cm4gLTE7CiAgICAgfQogCi0gICAgY3R4LT54ODZfaHZtLnNhdmUucWVtdV9lbmFibGVkX2xvZ2Rp
cnR5ID0gdHJ1ZTsKKyAgICBjdHgtPng4Ni5odm0uc2F2ZS5xZW11X2VuYWJsZWRfbG9nZGlydHkg
PSB0cnVlOwogCiAgICAgcmV0dXJuIDA7CiB9CkBAIC0xOTcsNyArMTk3LDcgQEAgc3RhdGljIGlu
dCB4ODZfaHZtX2NsZWFudXAoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKICAgICB4Y19pbnRl
cmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogCiAgICAgLyogSWYgcWVtdSBzdWNjZXNzZnVsbHkgZW5h
YmxlZCBsb2dkaXJ0eSBtb2RlLCBhdHRlbXB0IHRvIGRpc2FibGUuICovCi0gICAgaWYgKCBjdHgt
Png4Nl9odm0uc2F2ZS5xZW11X2VuYWJsZWRfbG9nZGlydHkgJiYKKyAgICBpZiAoIGN0eC0+eDg2
Lmh2bS5zYXZlLnFlbXVfZW5hYmxlZF9sb2dkaXJ0eSAmJgogICAgICAgICAgY3R4LT5zYXZlLmNh
bGxiYWNrcy0+c3dpdGNoX3FlbXVfbG9nZGlydHkoCiAgICAgICAgICAgICAgY3R4LT5kb21pZCwg
MCwgY3R4LT5zYXZlLmNhbGxiYWNrcy0+ZGF0YSkgKQogICAgIHsKZGlmZiAtLWdpdCBhL3Rvb2xz
L2xpYnhjL3hjX3NyX3NhdmVfeDg2X3B2LmMgYi90b29scy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9w
di5jCmluZGV4IDk0ZDBmNjg5MTEuLmMxYzY4OTI2NjYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhj
L3hjX3NyX3NhdmVfeDg2X3B2LmMKKysrIGIvdG9vbHMvbGlieGMveGNfc3Jfc2F2ZV94ODZfcHYu
YwpAQCAtMTYsOSArMTYsOSBAQCBzdGF0aWMgaW50IG1hcF9zaGluZm8oc3RydWN0IHhjX3NyX2Nv
bnRleHQgKmN0eCkKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogCi0gICAg
Y3R4LT54ODZfcHYuc2hpbmZvID0geGNfbWFwX2ZvcmVpZ25fcmFuZ2UoCisgICAgY3R4LT54ODYu
cHYuc2hpbmZvID0geGNfbWFwX2ZvcmVpZ25fcmFuZ2UoCiAgICAgICAgIHhjaCwgY3R4LT5kb21p
ZCwgUEFHRV9TSVpFLCBQUk9UX1JFQUQsIGN0eC0+ZG9taW5mby5zaGFyZWRfaW5mb19mcmFtZSk7
Ci0gICAgaWYgKCAhY3R4LT54ODZfcHYuc2hpbmZvICkKKyAgICBpZiAoICFjdHgtPng4Ni5wdi5z
aGluZm8gKQogICAgIHsKICAgICAgICAgUEVSUk9SKCJGYWlsZWQgdG8gbWFwIHNoYXJlZCBpbmZv
IGZyYW1lIGF0IG1mbiAlI2x4IiwKICAgICAgICAgICAgICAgIGN0eC0+ZG9taW5mby5zaGFyZWRf
aW5mb19mcmFtZSk7CkBAIC0zNyw3ICszNyw3IEBAIHN0YXRpYyBpbnQgY29weV9tZm5zX2Zyb21f
Z3Vlc3QoY29uc3Qgc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwKIHsKICAgICBzaXplX3QgeDsK
IAotICAgIGlmICggY3R4LT54ODZfcHYud2lkdGggPT0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpICkK
KyAgICBpZiAoIGN0eC0+eDg2LnB2LndpZHRoID09IHNpemVvZih1bnNpZ25lZCBsb25nKSApCiAg
ICAgICAgIG1lbWNweShkc3QsIHNyYywgY291bnQgKiBzaXplb2YoKmRzdCkpOwogICAgIGVsc2UK
ICAgICB7CkBAIC04MiwxOCArODIsMTggQEAgc3RhdGljIGludCBtYXBfcDJtX2xlYXZlcyhzdHJ1
Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB4ZW5fcGZuX3QgKm1mbnMsCiAgICAgeGNfaW50ZXJmYWNl
ICp4Y2ggPSBjdHgtPnhjaDsKICAgICB1bnNpZ25lZCBpbnQgeDsKIAotICAgIGN0eC0+eDg2X3B2
LnAybSA9IHhjX21hcF9mb3JlaWduX3BhZ2VzKHhjaCwgY3R4LT5kb21pZCwgUFJPVF9SRUFELAor
ICAgIGN0eC0+eDg2LnB2LnAybSA9IHhjX21hcF9mb3JlaWduX3BhZ2VzKHhjaCwgY3R4LT5kb21p
ZCwgUFJPVF9SRUFELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG1mbnMsIG5fbWZucyk7Ci0gICAgaWYgKCAhY3R4LT54ODZfcHYucDJtICkKKyAgICBpZiAoICFj
dHgtPng4Ni5wdi5wMm0gKQogICAgIHsKICAgICAgICAgUEVSUk9SKCJGYWlsZWQgdG8gbWFwIHAy
bSBmcmFtZXMiKTsKICAgICAgICAgcmV0dXJuIC0xOwogICAgIH0KIAotICAgIGN0eC0+c2F2ZS5w
Mm1fc2l6ZSA9IGN0eC0+eDg2X3B2Lm1heF9wZm4gKyAxOwotICAgIGN0eC0+eDg2X3B2LnAybV9m
cmFtZXMgPSBuX21mbnM7Ci0gICAgY3R4LT54ODZfcHYucDJtX3BmbnMgPSBtYWxsb2Mobl9tZm5z
ICogc2l6ZW9mKCptZm5zKSk7Ci0gICAgaWYgKCAhY3R4LT54ODZfcHYucDJtX3BmbnMgKQorICAg
IGN0eC0+c2F2ZS5wMm1fc2l6ZSA9IGN0eC0+eDg2LnB2Lm1heF9wZm4gKyAxOworICAgIGN0eC0+
eDg2LnB2LnAybV9mcmFtZXMgPSBuX21mbnM7CisgICAgY3R4LT54ODYucHYucDJtX3BmbnMgPSBt
YWxsb2Mobl9tZm5zICogc2l6ZW9mKCptZm5zKSk7CisgICAgaWYgKCAhY3R4LT54ODYucHYucDJt
X3BmbnMgKQogICAgIHsKICAgICAgICAgRVJST1IoIkNhbm5vdCBhbGxvY2F0ZSAlenUgYnl0ZXMg
Zm9yIHAybSBwZm5zIGxpc3QiLAogICAgICAgICAgICAgICBuX21mbnMgKiBzaXplb2YoKm1mbnMp
KTsKQEAgLTExMSw3ICsxMTEsNyBAQCBzdGF0aWMgaW50IG1hcF9wMm1fbGVhdmVzKHN0cnVjdCB4
Y19zcl9jb250ZXh0ICpjdHgsIHhlbl9wZm5fdCAqbWZucywKICAgICAgICAgICAgIHJldHVybiAt
MTsKICAgICAgICAgfQogCi0gICAgICAgIGN0eC0+eDg2X3B2LnAybV9wZm5zW3hdID0gbWZuX3Rv
X3BmbihjdHgsIG1mbnNbeF0pOworICAgICAgICBjdHgtPng4Ni5wdi5wMm1fcGZuc1t4XSA9IG1m
bl90b19wZm4oY3R4LCBtZm5zW3hdKTsKICAgICB9CiAKICAgICByZXR1cm4gMDsKQEAgLTE0NCwx
NyArMTQ0LDE3IEBAIHN0YXRpYyBpbnQgbWFwX3AybV90cmVlKHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgpCiAgICAgdm9pZCAqZ3Vlc3RfZmwgPSBOVUxMOwogICAgIHNpemVfdCBsb2NhbF9mbF9z
aXplOwogCi0gICAgZnBwID0gUEFHRV9TSVpFIC8gY3R4LT54ODZfcHYud2lkdGg7Ci0gICAgZmxs
X2VudHJpZXMgPSAoY3R4LT54ODZfcHYubWF4X3BmbiAvIChmcHAgKiBmcHApKSArIDE7CisgICAg
ZnBwID0gUEFHRV9TSVpFIC8gY3R4LT54ODYucHYud2lkdGg7CisgICAgZmxsX2VudHJpZXMgPSAo
Y3R4LT54ODYucHYubWF4X3BmbiAvIChmcHAgKiBmcHApKSArIDE7CiAgICAgaWYgKCBmbGxfZW50
cmllcyA+IGZwcCApCiAgICAgewotICAgICAgICBFUlJPUigibWF4X3BmbiAlI2x4IHRvbyBsYXJn
ZSBmb3IgcDJtIHRyZWUiLCBjdHgtPng4Nl9wdi5tYXhfcGZuKTsKKyAgICAgICAgRVJST1IoIm1h
eF9wZm4gJSNseCB0b28gbGFyZ2UgZm9yIHAybSB0cmVlIiwgY3R4LT54ODYucHYubWF4X3Bmbik7
CiAgICAgICAgIGdvdG8gZXJyOwogICAgIH0KIAotICAgIGZsbF9tZm4gPSBHRVRfRklFTEQoY3R4
LT54ODZfcHYuc2hpbmZvLCBhcmNoLnBmbl90b19tZm5fZnJhbWVfbGlzdF9saXN0LAotICAgICAg
ICAgICAgICAgICAgICAgICAgY3R4LT54ODZfcHYud2lkdGgpOwotICAgIGlmICggZmxsX21mbiA9
PSAwIHx8IGZsbF9tZm4gPiBjdHgtPng4Nl9wdi5tYXhfbWZuICkKKyAgICBmbGxfbWZuID0gR0VU
X0ZJRUxEKGN0eC0+eDg2LnB2LnNoaW5mbywgYXJjaC5wZm5fdG9fbWZuX2ZyYW1lX2xpc3RfbGlz
dCwKKyAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+eDg2LnB2LndpZHRoKTsKKyAgICBpZiAo
IGZsbF9tZm4gPT0gMCB8fCBmbGxfbWZuID4gY3R4LT54ODYucHYubWF4X21mbiApCiAgICAgewog
ICAgICAgICBFUlJPUigiQmFkIG1mbiAlI2x4IGZvciBwMm0gZnJhbWUgbGlzdCBsaXN0IiwgZmxs
X21mbik7CiAgICAgICAgIGdvdG8gZXJyOwpAQCAtMTg5LDcgKzE4OSw3IEBAIHN0YXRpYyBpbnQg
bWFwX3AybV90cmVlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAgICAgc2F2ZWRfeCA9IDA7
CiAgICAgZm9yICggeCA9IDA7IHggPCBmbGxfZW50cmllczsgKyt4ICkKICAgICB7Ci0gICAgICAg
IGlmICggbG9jYWxfZmxsW3hdID09IDAgfHwgbG9jYWxfZmxsW3hdID4gY3R4LT54ODZfcHYubWF4
X21mbiApCisgICAgICAgIGlmICggbG9jYWxfZmxsW3hdID09IDAgfHwgbG9jYWxfZmxsW3hdID4g
Y3R4LT54ODYucHYubWF4X21mbiApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9SKCJCYWQg
bWZuICUjbHggYXQgaW5kZXggJXUgKG9mICV1KSBpbiBwMm0gZnJhbWUgbGlzdCBsaXN0IiwKICAg
ICAgICAgICAgICAgICAgIGxvY2FsX2ZsbFt4XSwgeCwgZmxsX2VudHJpZXMpOwpAQCAtMjEzLDE1
ICsyMTMsMTUgQEAgc3RhdGljIGludCBtYXBfcDJtX3RyZWUoc3RydWN0IHhjX3NyX2NvbnRleHQg
KmN0eCkKICAgICAgKiBuZWVkZWQgZm9yIHAybSBhbmQgbG9nZGlydHkgbWFwLgogICAgICAqLwog
ICAgIG1heF9wZm4gPSAoc2F2ZWRfeCArIDEpICogZnBwICogZnBwIC0gMTsKLSAgICBpZiAoIG1h
eF9wZm4gPCBjdHgtPng4Nl9wdi5tYXhfcGZuICkKKyAgICBpZiAoIG1heF9wZm4gPCBjdHgtPng4
Ni5wdi5tYXhfcGZuICkKICAgICB7Ci0gICAgICAgIGN0eC0+eDg2X3B2Lm1heF9wZm4gPSBtYXhf
cGZuOwotICAgICAgICBmbGxfZW50cmllcyA9IChjdHgtPng4Nl9wdi5tYXhfcGZuIC8gKGZwcCAq
IGZwcCkpICsgMTsKKyAgICAgICAgY3R4LT54ODYucHYubWF4X3BmbiA9IG1heF9wZm47CisgICAg
ICAgIGZsbF9lbnRyaWVzID0gKGN0eC0+eDg2LnB2Lm1heF9wZm4gLyAoZnBwICogZnBwKSkgKyAx
OwogICAgIH0KLSAgICBjdHgtPng4Nl9wdi5wMm1fZnJhbWVzID0gKGN0eC0+eDg2X3B2Lm1heF9w
Zm4gKyBmcHApIC8gZnBwOwotICAgIERQUklOVEYoIm1heF9wZm4gJSNseCwgcDJtX2ZyYW1lcyAl
ZCIsIGN0eC0+eDg2X3B2Lm1heF9wZm4sCi0gICAgICAgICAgICBjdHgtPng4Nl9wdi5wMm1fZnJh
bWVzKTsKLSAgICBmbF9lbnRyaWVzICA9IChjdHgtPng4Nl9wdi5tYXhfcGZuIC8gZnBwKSArIDE7
CisgICAgY3R4LT54ODYucHYucDJtX2ZyYW1lcyA9IChjdHgtPng4Ni5wdi5tYXhfcGZuICsgZnBw
KSAvIGZwcDsKKyAgICBEUFJJTlRGKCJtYXhfcGZuICUjbHgsIHAybV9mcmFtZXMgJWQiLCBjdHgt
Png4Ni5wdi5tYXhfcGZuLAorICAgICAgICAgICAgY3R4LT54ODYucHYucDJtX2ZyYW1lcyk7Cisg
ICAgZmxfZW50cmllcyAgPSAoY3R4LT54ODYucHYubWF4X3BmbiAvIGZwcCkgKyAxOwogCiAgICAg
LyogTWFwIHRoZSBndWVzdCBtaWQgcDJtIGZyYW1lcy4gKi8KICAgICBndWVzdF9mbCA9IHhjX21h
cF9mb3JlaWduX3BhZ2VzKHhjaCwgY3R4LT5kb21pZCwgUFJPVF9SRUFELApAQCAtMjQ5LDcgKzI0
OSw3IEBAIHN0YXRpYyBpbnQgbWFwX3AybV90cmVlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgp
CiAKICAgICBmb3IgKCB4ID0gMDsgeCA8IGZsX2VudHJpZXM7ICsreCApCiAgICAgewotICAgICAg
ICBpZiAoIGxvY2FsX2ZsW3hdID09IDAgfHwgbG9jYWxfZmxbeF0gPiBjdHgtPng4Nl9wdi5tYXhf
bWZuICkKKyAgICAgICAgaWYgKCBsb2NhbF9mbFt4XSA9PSAwIHx8IGxvY2FsX2ZsW3hdID4gY3R4
LT54ODYucHYubWF4X21mbiApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9SKCJCYWQgbWZu
ICUjbHggYXQgaW5kZXggJXUgKG9mICV1KSBpbiBwMm0gZnJhbWUgbGlzdCIsCiAgICAgICAgICAg
ICAgICAgICBsb2NhbF9mbFt4XSwgeCwgZmxfZW50cmllcyk7CkBAIC0yODEsMTEgKzI4MSwxMSBA
QCBzdGF0aWMgaW50IGdldF9wMm1fZ2VuZXJhdGlvbihzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4
KQogICAgIHVpbnQ2NF90IHAybV9nZW5lcmF0aW9uOwogICAgIGludCByYzsKIAotICAgIHAybV9n
ZW5lcmF0aW9uID0gR0VUX0ZJRUxEKGN0eC0+eDg2X3B2LnNoaW5mbywgYXJjaC5wMm1fZ2VuZXJh
dGlvbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPng4Nl9wdi53aWR0aCk7
CisgICAgcDJtX2dlbmVyYXRpb24gPSBHRVRfRklFTEQoY3R4LT54ODYucHYuc2hpbmZvLCBhcmNo
LnAybV9nZW5lcmF0aW9uLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+eDg2
LnB2LndpZHRoKTsKIAotICAgIHJjID0gKHAybV9nZW5lcmF0aW9uID09IGN0eC0+eDg2X3B2LnAy
bV9nZW5lcmF0aW9uKSA/IDAgOiAtMTsKLSAgICBjdHgtPng4Nl9wdi5wMm1fZ2VuZXJhdGlvbiA9
IHAybV9nZW5lcmF0aW9uOworICAgIHJjID0gKHAybV9nZW5lcmF0aW9uID09IGN0eC0+eDg2LnB2
LnAybV9nZW5lcmF0aW9uKSA/IDAgOiAtMTsKKyAgICBjdHgtPng4Ni5wdi5wMm1fZ2VuZXJhdGlv
biA9IHAybV9nZW5lcmF0aW9uOwogCiAgICAgcmV0dXJuIHJjOwogfQpAQCAtMzIyLDcgKzMyMiw3
IEBAIHN0YXRpYyBpbnQgbWFwX3AybV9saXN0KHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVp
bnQ2NF90IHAybV9jcjMpCiAKICAgICBwMm1fbWZuID0gY3IzX3RvX21mbihjdHgsIHAybV9jcjMp
OwogICAgIGFzc2VydChwMm1fbWZuICE9IDApOwotICAgIGlmICggcDJtX21mbiA+IGN0eC0+eDg2
X3B2Lm1heF9tZm4gKQorICAgIGlmICggcDJtX21mbiA+IGN0eC0+eDg2LnB2Lm1heF9tZm4gKQog
ICAgIHsKICAgICAgICAgRVJST1IoIkJhZCBwMm1fY3IzIHZhbHVlICUjIiBQUkl4NjQsIHAybV9j
cjMpOwogICAgICAgICBlcnJubyA9IEVSQU5HRTsKQEAgLTMzMSwxMyArMzMxLDEzIEBAIHN0YXRp
YyBpbnQgbWFwX3AybV9saXN0KHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVpbnQ2NF90IHAy
bV9jcjMpCiAKICAgICBnZXRfcDJtX2dlbmVyYXRpb24oY3R4KTsKIAotICAgIHAybV92YWRkciA9
IEdFVF9GSUVMRChjdHgtPng4Nl9wdi5zaGluZm8sIGFyY2gucDJtX3ZhZGRyLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICBjdHgtPng4Nl9wdi53aWR0aCk7Ci0gICAgZnBwID0gUEFHRV9TSVpF
IC8gY3R4LT54ODZfcHYud2lkdGg7Ci0gICAgY3R4LT54ODZfcHYucDJtX2ZyYW1lcyA9IGN0eC0+
eDg2X3B2Lm1heF9wZm4gLyBmcHAgKyAxOwotICAgIHAybV9lbmQgPSBwMm1fdmFkZHIgKyBjdHgt
Png4Nl9wdi5wMm1fZnJhbWVzICogUEFHRV9TSVpFIC0gMTsKKyAgICBwMm1fdmFkZHIgPSBHRVRf
RklFTEQoY3R4LT54ODYucHYuc2hpbmZvLCBhcmNoLnAybV92YWRkciwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgY3R4LT54ODYucHYud2lkdGgpOworICAgIGZwcCA9IFBBR0VfU0laRSAvIGN0
eC0+eDg2LnB2LndpZHRoOworICAgIGN0eC0+eDg2LnB2LnAybV9mcmFtZXMgPSBjdHgtPng4Ni5w
di5tYXhfcGZuIC8gZnBwICsgMTsKKyAgICBwMm1fZW5kID0gcDJtX3ZhZGRyICsgY3R4LT54ODYu
cHYucDJtX2ZyYW1lcyAqIFBBR0VfU0laRSAtIDE7CiAKLSAgICBpZiAoIGN0eC0+eDg2X3B2Lndp
ZHRoID09IDggKQorICAgIGlmICggY3R4LT54ODYucHYud2lkdGggPT0gOCApCiAgICAgewogICAg
ICAgICBtYXNrID0gMHgwMDAwZmZmZmZmZmZmZmZmVUxMOwogICAgICAgICBpZiAoICFpc19jYW5v
bmljYWxfYWRkcmVzcyhwMm1fdmFkZHIpIHx8CkBAIC0zNjgsOCArMzY4LDggQEAgc3RhdGljIGlu
dCBtYXBfcDJtX2xpc3Qoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgdWludDY0X3QgcDJtX2Ny
MykKIAogICAgIERQUklOVEYoInAybSBsaXN0IGZyb20gJSMiIFBSSXg2NCAiIHRvICUjIiBQUkl4
NjQgIiwgcm9vdCBhdCAlI2x4IiwKICAgICAgICAgICAgIHAybV92YWRkciwgcDJtX2VuZCwgcDJt
X21mbik7Ci0gICAgRFBSSU5URigibWF4X3BmbiAlI2x4LCBwMm1fZnJhbWVzICVkIiwgY3R4LT54
ODZfcHYubWF4X3BmbiwKLSAgICAgICAgICAgIGN0eC0+eDg2X3B2LnAybV9mcmFtZXMpOworICAg
IERQUklOVEYoIm1heF9wZm4gJSNseCwgcDJtX2ZyYW1lcyAlZCIsIGN0eC0+eDg2LnB2Lm1heF9w
Zm4sCisgICAgICAgICAgICBjdHgtPng4Ni5wdi5wMm1fZnJhbWVzKTsKIAogICAgIG1mbnMgPSBt
YWxsb2Moc2l6ZW9mKCptZm5zKSk7CiAgICAgaWYgKCAhbWZucyApCkBAIC0zODIsNyArMzgyLDcg
QEAgc3RhdGljIGludCBtYXBfcDJtX2xpc3Qoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgdWlu
dDY0X3QgcDJtX2NyMykKICAgICBzYXZlZF9tZm4gPSAwOwogICAgIGlkeF9zdGFydCA9IGlkeF9l
bmQgPSBzYXZlZF9pZHggPSAwOwogCi0gICAgZm9yICggbGV2ZWwgPSBjdHgtPng4Nl9wdi5sZXZl
bHM7IGxldmVsID4gMDsgbGV2ZWwtLSApCisgICAgZm9yICggbGV2ZWwgPSBjdHgtPng4Ni5wdi5s
ZXZlbHM7IGxldmVsID4gMDsgbGV2ZWwtLSApCiAgICAgewogICAgICAgICBuX3BhZ2VzID0gaWR4
X2VuZCAtIGlkeF9zdGFydCArIDE7CiAgICAgICAgIHB0ZXMgPSB4Y19tYXBfZm9yZWlnbl9wYWdl
cyh4Y2gsIGN0eC0+ZG9taWQsIFBST1RfUkVBRCwgbWZucywgbl9wYWdlcyk7CkBAIC00MDcsNyAr
NDA3LDcgQEAgc3RhdGljIGludCBtYXBfcDJtX2xpc3Qoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0
eCwgdWludDY0X3QgcDJtX2NyMykKICAgICAgICAgZm9yICggaWR4ID0gaWR4X3N0YXJ0OyBpZHgg
PD0gaWR4X2VuZDsgaWR4KysgKQogICAgICAgICB7CiAgICAgICAgICAgICBtZm4gPSBwdGVfdG9f
ZnJhbWUocHRlc1tpZHhdKTsKLSAgICAgICAgICAgIGlmICggbWZuID09IDAgfHwgbWZuID4gY3R4
LT54ODZfcHYubWF4X21mbiApCisgICAgICAgICAgICBpZiAoIG1mbiA9PSAwIHx8IG1mbiA+IGN0
eC0+eDg2LnB2Lm1heF9tZm4gKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIEVSUk9S
KCJCYWQgbWZuICUjbHggZHVyaW5nIHBhZ2UgdGFibGUgd2FsayBmb3IgdmFkZHIgJSMiIFBSSXg2
NCAiIGF0IGxldmVsICVkIG9mIHAybSBsaXN0IiwKICAgICAgICAgICAgICAgICAgICAgICBtZm4s
IG9mZiArICgoeGVuX3ZhZGRyX3QpaWR4IDw8IHNoaWZ0KSwgbGV2ZWwpOwpAQCAtNDMyLDExICs0
MzIsMTEgQEAgc3RhdGljIGludCBtYXBfcDJtX2xpc3Qoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0
eCwgdWludDY0X3QgcDJtX2NyMykKICAgICAgICAgICAgIGlmICggc2F2ZWRfaWR4ID09IGlkeF9l
bmQgKQogICAgICAgICAgICAgICAgIHNhdmVkX2lkeCsrOwogICAgICAgICAgICAgbWF4X3BmbiA9
ICgoeGVuX3Bmbl90KXNhdmVkX2lkeCA8PCA5KSAqIGZwcCAtIDE7Ci0gICAgICAgICAgICBpZiAo
IG1heF9wZm4gPCBjdHgtPng4Nl9wdi5tYXhfcGZuICkKKyAgICAgICAgICAgIGlmICggbWF4X3Bm
biA8IGN0eC0+eDg2LnB2Lm1heF9wZm4gKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAg
IGN0eC0+eDg2X3B2Lm1heF9wZm4gPSBtYXhfcGZuOwotICAgICAgICAgICAgICAgIGN0eC0+eDg2
X3B2LnAybV9mcmFtZXMgPSAoY3R4LT54ODZfcHYubWF4X3BmbiArIGZwcCkgLyBmcHA7Ci0gICAg
ICAgICAgICAgICAgcDJtX2VuZCA9IHAybV92YWRkciArIGN0eC0+eDg2X3B2LnAybV9mcmFtZXMg
KiBQQUdFX1NJWkUgLSAxOworICAgICAgICAgICAgICAgIGN0eC0+eDg2LnB2Lm1heF9wZm4gPSBt
YXhfcGZuOworICAgICAgICAgICAgICAgIGN0eC0+eDg2LnB2LnAybV9mcmFtZXMgPSAoY3R4LT54
ODYucHYubWF4X3BmbiArIGZwcCkgLyBmcHA7CisgICAgICAgICAgICAgICAgcDJtX2VuZCA9IHAy
bV92YWRkciArIGN0eC0+eDg2LnB2LnAybV9mcmFtZXMgKiBQQUdFX1NJWkUgLSAxOwogICAgICAg
ICAgICAgICAgIGlkeF9lbmQgPSBpZHhfc3RhcnQgKyBzYXZlZF9pZHg7CiAgICAgICAgICAgICB9
CiAgICAgICAgIH0KQEAgLTQ2NiwxMCArNDY2LDEwIEBAIHN0YXRpYyBpbnQgbWFwX3AybShzdHJ1
Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogewogICAgIHVpbnQ2NF90IHAybV9jcjM7CiAKLSAgICBj
dHgtPng4Nl9wdi5wMm1fZ2VuZXJhdGlvbiA9IH4wVUxMOwotICAgIGN0eC0+eDg2X3B2Lm1heF9w
Zm4gPSBHRVRfRklFTEQoY3R4LT54ODZfcHYuc2hpbmZvLCBhcmNoLm1heF9wZm4sCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPng4Nl9wdi53aWR0aCkgLSAxOwotICAg
IHAybV9jcjMgPSBHRVRfRklFTEQoY3R4LT54ODZfcHYuc2hpbmZvLCBhcmNoLnAybV9jcjMsIGN0
eC0+eDg2X3B2LndpZHRoKTsKKyAgICBjdHgtPng4Ni5wdi5wMm1fZ2VuZXJhdGlvbiA9IH4wVUxM
OworICAgIGN0eC0+eDg2LnB2Lm1heF9wZm4gPSBHRVRfRklFTEQoY3R4LT54ODYucHYuc2hpbmZv
LCBhcmNoLm1heF9wZm4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgt
Png4Ni5wdi53aWR0aCkgLSAxOworICAgIHAybV9jcjMgPSBHRVRfRklFTEQoY3R4LT54ODYucHYu
c2hpbmZvLCBhcmNoLnAybV9jcjMsIGN0eC0+eDg2LnB2LndpZHRoKTsKIAogICAgIHJldHVybiBw
Mm1fY3IzID8gbWFwX3AybV9saXN0KGN0eCwgcDJtX2NyMykgOiBtYXBfcDJtX3RyZWUoY3R4KTsK
IH0KQEAgLTUwMyw3ICs1MDMsNyBAQCBzdGF0aWMgaW50IHdyaXRlX29uZV92Y3B1X2Jhc2ljKHN0
cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVpbnQzMl90IGlkKQogICAgIC8qIFZjcHUwIGlzIHNw
ZWNpYWw6IENvbnZlcnQgdGhlIHN1c3BlbmQgcmVjb3JkIHRvIGEgcGZuLiAqLwogICAgIGlmICgg
aWQgPT0gMCApCiAgICAgewotICAgICAgICBtZm4gPSBHRVRfRklFTEQoJnZjcHUsIHVzZXJfcmVn
cy5lZHgsIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICAgICAgbWZuID0gR0VUX0ZJRUxEKCZ2Y3B1
LCB1c2VyX3JlZ3MuZWR4LCBjdHgtPng4Ni5wdi53aWR0aCk7CiAgICAgICAgIGlmICggIW1mbl9p
bl9wc2V1ZG9waHlzbWFwKGN0eCwgbWZuKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9S
KCJCYWQgbWZuIGZvciBzdXNwZW5kIHJlY29yZCIpOwpAQCAtNTEyLDEwICs1MTIsMTAgQEAgc3Rh
dGljIGludCB3cml0ZV9vbmVfdmNwdV9iYXNpYyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1
aW50MzJfdCBpZCkKICAgICAgICAgICAgIGdvdG8gZXJyOwogICAgICAgICB9CiAgICAgICAgIFNF
VF9GSUVMRCgmdmNwdSwgdXNlcl9yZWdzLmVkeCwgbWZuX3RvX3BmbihjdHgsIG1mbiksCi0gICAg
ICAgICAgICAgICAgICBjdHgtPng4Nl9wdi53aWR0aCk7CisgICAgICAgICAgICAgICAgICBjdHgt
Png4Ni5wdi53aWR0aCk7CiAgICAgfQogCi0gICAgZ2R0X2NvdW50ID0gR0VUX0ZJRUxEKCZ2Y3B1
LCBnZHRfZW50cywgY3R4LT54ODZfcHYud2lkdGgpOworICAgIGdkdF9jb3VudCA9IEdFVF9GSUVM
RCgmdmNwdSwgZ2R0X2VudHMsIGN0eC0+eDg2LnB2LndpZHRoKTsKICAgICBpZiAoIGdkdF9jb3Vu
dCA+IEZJUlNUX1JFU0VSVkVEX0dEVF9FTlRSWSApCiAgICAgewogICAgICAgICBFUlJPUigiR0RU
IGVudHJ5IGNvdW50ICgldSkgb3V0IG9mIHJhbmdlIChtYXggJXUpIiwKQEAgLTUyOCw3ICs1Mjgs
NyBAQCBzdGF0aWMgaW50IHdyaXRlX29uZV92Y3B1X2Jhc2ljKHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgsIHVpbnQzMl90IGlkKQogICAgIC8qIENvbnZlcnQgR0RUIGZyYW1lcyB0byBwZm5zLiAq
LwogICAgIGZvciAoIGkgPSAwOyBpIDwgZ2R0X2NvdW50OyArK2kgKQogICAgIHsKLSAgICAgICAg
bWZuID0gR0VUX0ZJRUxEKCZ2Y3B1LCBnZHRfZnJhbWVzW2ldLCBjdHgtPng4Nl9wdi53aWR0aCk7
CisgICAgICAgIG1mbiA9IEdFVF9GSUVMRCgmdmNwdSwgZ2R0X2ZyYW1lc1tpXSwgY3R4LT54ODYu
cHYud2lkdGgpOwogICAgICAgICBpZiAoICFtZm5faW5fcHNldWRvcGh5c21hcChjdHgsIG1mbikg
KQogICAgICAgICB7CiAgICAgICAgICAgICBFUlJPUigiQmFkIG1mbiBmb3IgZnJhbWUgJXUgb2Yg
dmNwdSV1J3MgR0RUIiwgaSwgaWQpOwpAQCAtNTM3LDExICs1MzcsMTEgQEAgc3RhdGljIGludCB3
cml0ZV9vbmVfdmNwdV9iYXNpYyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1aW50MzJfdCBp
ZCkKICAgICAgICAgICAgIGdvdG8gZXJyOwogICAgICAgICB9CiAgICAgICAgIFNFVF9GSUVMRCgm
dmNwdSwgZ2R0X2ZyYW1lc1tpXSwgbWZuX3RvX3BmbihjdHgsIG1mbiksCi0gICAgICAgICAgICAg
ICAgICBjdHgtPng4Nl9wdi53aWR0aCk7CisgICAgICAgICAgICAgICAgICBjdHgtPng4Ni5wdi53
aWR0aCk7CiAgICAgfQogCiAgICAgLyogQ29udmVydCBDUjMgdG8gYSBwZm4uICovCi0gICAgbWZu
ID0gY3IzX3RvX21mbihjdHgsIEdFVF9GSUVMRCgmdmNwdSwgY3RybHJlZ1szXSwgY3R4LT54ODZf
cHYud2lkdGgpKTsKKyAgICBtZm4gPSBjcjNfdG9fbWZuKGN0eCwgR0VUX0ZJRUxEKCZ2Y3B1LCBj
dHJscmVnWzNdLCBjdHgtPng4Ni5wdi53aWR0aCkpOwogICAgIGlmICggIW1mbl9pbl9wc2V1ZG9w
aHlzbWFwKGN0eCwgbWZuKSApCiAgICAgewogICAgICAgICBFUlJPUigiQmFkIG1mbiBmb3IgdmNw
dSV1J3MgY3IzIiwgaWQpOwpAQCAtNTUwLDEwICs1NTAsMTAgQEAgc3RhdGljIGludCB3cml0ZV9v
bmVfdmNwdV9iYXNpYyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1aW50MzJfdCBpZCkKICAg
ICAgICAgZ290byBlcnI7CiAgICAgfQogICAgIHBmbiA9IG1mbl90b19wZm4oY3R4LCBtZm4pOwot
ICAgIFNFVF9GSUVMRCgmdmNwdSwgY3RybHJlZ1szXSwgbWZuX3RvX2NyMyhjdHgsIHBmbiksIGN0
eC0+eDg2X3B2LndpZHRoKTsKKyAgICBTRVRfRklFTEQoJnZjcHUsIGN0cmxyZWdbM10sIG1mbl90
b19jcjMoY3R4LCBwZm4pLCBjdHgtPng4Ni5wdi53aWR0aCk7CiAKICAgICAvKiA2NGJpdCBndWVz
dHM6IENvbnZlcnQgQ1IxIChndWVzdCBwYWdldGFibGVzKSB0byBwZm4uICovCi0gICAgaWYgKCBj
dHgtPng4Nl9wdi5sZXZlbHMgPT0gNCAmJiB2Y3B1Lng2NC5jdHJscmVnWzFdICkKKyAgICBpZiAo
IGN0eC0+eDg2LnB2LmxldmVscyA9PSA0ICYmIHZjcHUueDY0LmN0cmxyZWdbMV0gKQogICAgIHsK
ICAgICAgICAgbWZuID0gdmNwdS54NjQuY3RybHJlZ1sxXSA+PiBQQUdFX1NISUZUOwogICAgICAg
ICBpZiAoICFtZm5faW5fcHNldWRvcGh5c21hcChjdHgsIG1mbikgKQpAQCAtNTY3LDcgKzU2Nyw3
IEBAIHN0YXRpYyBpbnQgd3JpdGVfb25lX3ZjcHVfYmFzaWMoc3RydWN0IHhjX3NyX2NvbnRleHQg
KmN0eCwgdWludDMyX3QgaWQpCiAgICAgICAgIHZjcHUueDY0LmN0cmxyZWdbMV0gPSAxIHwgKCh1
aW50NjRfdClwZm4gPDwgUEFHRV9TSElGVCk7CiAgICAgfQogCi0gICAgaWYgKCBjdHgtPng4Nl9w
di53aWR0aCA9PSA4ICkKKyAgICBpZiAoIGN0eC0+eDg2LnB2LndpZHRoID09IDggKQogICAgICAg
ICByYyA9IHdyaXRlX3NwbGl0X3JlY29yZChjdHgsICZyZWMsICZ2Y3B1LCBzaXplb2YodmNwdS54
NjQpKTsKICAgICBlbHNlCiAgICAgICAgIHJjID0gd3JpdGVfc3BsaXRfcmVjb3JkKGN0eCwgJnJl
YywgJnZjcHUsIHNpemVvZih2Y3B1LngzMikpOwpAQCAtNzg1LDggKzc4NSw4IEBAIHN0YXRpYyBp
bnQgd3JpdGVfYWxsX3ZjcHVfaW5mb3JtYXRpb24oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkK
IHN0YXRpYyBpbnQgd3JpdGVfeDg2X3B2X2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkK
IHsKICAgICBzdHJ1Y3QgeGNfc3JfcmVjX3g4Nl9wdl9pbmZvIGluZm8gPSB7Ci0gICAgICAgIC5n
dWVzdF93aWR0aCA9IGN0eC0+eDg2X3B2LndpZHRoLAotICAgICAgICAucHRfbGV2ZWxzID0gY3R4
LT54ODZfcHYubGV2ZWxzLAorICAgICAgICAuZ3Vlc3Rfd2lkdGggPSBjdHgtPng4Ni5wdi53aWR0
aCwKKyAgICAgICAgLnB0X2xldmVscyA9IGN0eC0+eDg2LnB2LmxldmVscywKICAgICB9OwogICAg
IHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0gewogICAgICAgICAudHlwZSA9IFJFQ19UWVBFX1g4
Nl9QVl9JTkZPLApAQCAtODA1LDEwICs4MDUsMTAgQEAgc3RhdGljIGludCB3cml0ZV94ODZfcHZf
cDJtX2ZyYW1lcyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogewogICAgIHhjX2ludGVyZmFj
ZSAqeGNoID0gY3R4LT54Y2g7CiAgICAgaW50IHJjOyB1bnNpZ25lZCBpbnQgaTsKLSAgICBzaXpl
X3QgZGF0YXN6ID0gY3R4LT54ODZfcHYucDJtX2ZyYW1lcyAqIHNpemVvZih1aW50NjRfdCk7Cisg
ICAgc2l6ZV90IGRhdGFzeiA9IGN0eC0+eDg2LnB2LnAybV9mcmFtZXMgKiBzaXplb2YodWludDY0
X3QpOwogICAgIHVpbnQ2NF90ICpkYXRhID0gTlVMTDsKICAgICBzdHJ1Y3QgeGNfc3JfcmVjX3g4
Nl9wdl9wMm1fZnJhbWVzIGhkciA9IHsKLSAgICAgICAgLmVuZF9wZm4gPSBjdHgtPng4Nl9wdi5t
YXhfcGZuLAorICAgICAgICAuZW5kX3BmbiA9IGN0eC0+eDg2LnB2Lm1heF9wZm4sCiAgICAgfTsK
ICAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIHJlYyA9IHsKICAgICAgICAgLnR5cGUgPSBSRUNfVFlQ
RV9YODZfUFZfUDJNX0ZSQU1FUywKQEAgLTgxNyw3ICs4MTcsNyBAQCBzdGF0aWMgaW50IHdyaXRl
X3g4Nl9wdl9wMm1fZnJhbWVzKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAgICAgfTsKIAog
ICAgIC8qIE5vIG5lZWQgdG8gdHJhbnNsYXRlIGlmIHNpemVvZih1aW50NjRfdCkgPT0gc2l6ZW9m
KHhlbl9wZm5fdCkuICovCi0gICAgaWYgKCBzaXplb2YodWludDY0X3QpICE9IHNpemVvZigqY3R4
LT54ODZfcHYucDJtX3BmbnMpICkKKyAgICBpZiAoIHNpemVvZih1aW50NjRfdCkgIT0gc2l6ZW9m
KCpjdHgtPng4Ni5wdi5wMm1fcGZucykgKQogICAgIHsKICAgICAgICAgaWYgKCAhKGRhdGEgPSBt
YWxsb2MoZGF0YXN6KSkgKQogICAgICAgICB7CkBAIC04MjYsMTUgKzgyNiwxNSBAQCBzdGF0aWMg
aW50IHdyaXRlX3g4Nl9wdl9wMm1fZnJhbWVzKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAg
ICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgIH0KIAotICAgICAgICBmb3IgKCBpID0gMDsg
aSA8IGN0eC0+eDg2X3B2LnAybV9mcmFtZXM7ICsraSApCi0gICAgICAgICAgICBkYXRhW2ldID0g
Y3R4LT54ODZfcHYucDJtX3BmbnNbaV07CisgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgY3R4LT54
ODYucHYucDJtX2ZyYW1lczsgKytpICkKKyAgICAgICAgICAgIGRhdGFbaV0gPSBjdHgtPng4Ni5w
di5wMm1fcGZuc1tpXTsKICAgICB9CiAgICAgZWxzZQotICAgICAgICBkYXRhID0gKHVpbnQ2NF90
ICopY3R4LT54ODZfcHYucDJtX3BmbnM7CisgICAgICAgIGRhdGEgPSAodWludDY0X3QgKiljdHgt
Png4Ni5wdi5wMm1fcGZuczsKIAogICAgIHJjID0gd3JpdGVfc3BsaXRfcmVjb3JkKGN0eCwgJnJl
YywgZGF0YSwgZGF0YXN6KTsKIAotICAgIGlmICggZGF0YSAhPSAodWludDY0X3QgKiljdHgtPng4
Nl9wdi5wMm1fcGZucyApCisgICAgaWYgKCBkYXRhICE9ICh1aW50NjRfdCAqKWN0eC0+eDg2LnB2
LnAybV9wZm5zICkKICAgICAgICAgZnJlZShkYXRhKTsKIAogICAgIHJldHVybiByYzsKQEAgLTg0
OCw3ICs4NDgsNyBAQCBzdGF0aWMgaW50IHdyaXRlX3NoYXJlZF9pbmZvKHN0cnVjdCB4Y19zcl9j
b250ZXh0ICpjdHgpCiAgICAgc3RydWN0IHhjX3NyX3JlY29yZCByZWMgPSB7CiAgICAgICAgIC50
eXBlID0gUkVDX1RZUEVfU0hBUkVEX0lORk8sCiAgICAgICAgIC5sZW5ndGggPSBQQUdFX1NJWkUs
Ci0gICAgICAgIC5kYXRhID0gY3R4LT54ODZfcHYuc2hpbmZvLAorICAgICAgICAuZGF0YSA9IGN0
eC0+eDg2LnB2LnNoaW5mbywKICAgICB9OwogCiAgICAgcmV0dXJuIHdyaXRlX3JlY29yZChjdHgs
ICZyZWMpOwpAQCAtODY3LDcgKzg2Nyw3IEBAIHN0YXRpYyBpbnQgbm9ybWFsaXNlX3BhZ2V0YWJs
ZShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCBjb25zdCB1aW50NjRfdCAqc3JjLAogCiAgICAg
dHlwZSAmPSBYRU5fRE9NQ1RMX1BGSU5GT19MVEFCVFlQRV9NQVNLOwogCi0gICAgaWYgKCBjdHgt
Png4Nl9wdi5sZXZlbHMgPT0gNCApCisgICAgaWYgKCBjdHgtPng4Ni5wdi5sZXZlbHMgPT0gNCAp
CiAgICAgewogICAgICAgICAvKiA2NGJpdCBndWVzdHMgb25seSBoYXZlIFhlbiBtYXBwaW5ncyBp
biB0aGVpciBMNCB0YWJsZXMuICovCiAgICAgICAgIGlmICggdHlwZSA9PSBYRU5fRE9NQ1RMX1BG
SU5GT19MNFRBQiApCkBAIC04OTksNyArODk5LDcgQEAgc3RhdGljIGludCBub3JtYWxpc2VfcGFn
ZXRhYmxlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIGNvbnN0IHVpbnQ2NF90ICpzcmMsCiAg
ICAgICAgICAgICAgKiBhcmUgbm9ybWFsIGJ1dCBvbmx5IGEgZmV3IHdpbGwgaGF2ZSBYZW4gbWFw
cGluZ3MuCiAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgIGkgPSAoSFlQRVJWSVNPUl9WSVJU
X1NUQVJUX1g4Nl8zMiA+PiBMMl9QQUdFVEFCTEVfU0hJRlRfUEFFKSAmIDUxMTsKLSAgICAgICAg
ICAgIGlmICggcHRlX3RvX2ZyYW1lKHNyY1tpXSkgPT0gY3R4LT54ODZfcHYuY29tcGF0X20ycF9t
Zm4wICkKKyAgICAgICAgICAgIGlmICggcHRlX3RvX2ZyYW1lKHNyY1tpXSkgPT0gY3R4LT54ODYu
cHYuY29tcGF0X20ycF9tZm4wICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICB4ZW5f
Zmlyc3QgPSBpOwogICAgICAgICAgICAgICAgIHhlbl9sYXN0ID0gKEhZUEVSVklTT1JfVklSVF9F
TkRfWDg2XzMyID4+CkBAIC05ODAsOSArOTgwLDkgQEAgc3RhdGljIGludCBub3JtYWxpc2VfcGFn
ZXRhYmxlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIGNvbnN0IHVpbnQ2NF90ICpzcmMsCiBz
dGF0aWMgeGVuX3Bmbl90IHg4Nl9wdl9wZm5fdG9fZ2ZuKGNvbnN0IHN0cnVjdCB4Y19zcl9jb250
ZXh0ICpjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhlbl9wZm5fdCBw
Zm4pCiB7Ci0gICAgYXNzZXJ0KHBmbiA8PSBjdHgtPng4Nl9wdi5tYXhfcGZuKTsKKyAgICBhc3Nl
cnQocGZuIDw9IGN0eC0+eDg2LnB2Lm1heF9wZm4pOwogCi0gICAgcmV0dXJuIHhjX3Bmbl90b19t
Zm4ocGZuLCBjdHgtPng4Nl9wdi5wMm0sIGN0eC0+eDg2X3B2LndpZHRoKTsKKyAgICByZXR1cm4g
eGNfcGZuX3RvX21mbihwZm4sIGN0eC0+eDg2LnB2LnAybSwgY3R4LT54ODYucHYud2lkdGgpOwog
fQogCiAKQEAgLTEwNjMsNyArMTA2Myw3IEBAIHN0YXRpYyBpbnQgeDg2X3B2X2VuZF9vZl9jaGVj
a3BvaW50KHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAKIHN0YXRpYyBpbnQgeDg2X3B2X2No
ZWNrX3ZtX3N0YXRlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiB7Ci0gICAgaWYgKCBjdHgt
Png4Nl9wdi5wMm1fZ2VuZXJhdGlvbiA9PSB+MFVMTCApCisgICAgaWYgKCBjdHgtPng4Ni5wdi5w
Mm1fZ2VuZXJhdGlvbiA9PSB+MFVMTCApCiAgICAgICAgIHJldHVybiAwOwogCiAgICAgcmV0dXJu
IHg4Nl9wdl9jaGVja192bV9zdGF0ZV9wMm1fbGlzdChjdHgpOwpAQCAtMTA3MSwxNiArMTA3MSwx
NiBAQCBzdGF0aWMgaW50IHg4Nl9wdl9jaGVja192bV9zdGF0ZShzdHJ1Y3QgeGNfc3JfY29udGV4
dCAqY3R4KQogCiBzdGF0aWMgaW50IHg4Nl9wdl9jbGVhbnVwKHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgpCiB7Ci0gICAgZnJlZShjdHgtPng4Nl9wdi5wMm1fcGZucyk7CisgICAgZnJlZShjdHgt
Png4Ni5wdi5wMm1fcGZucyk7CiAKLSAgICBpZiAoIGN0eC0+eDg2X3B2LnAybSApCi0gICAgICAg
IG11bm1hcChjdHgtPng4Nl9wdi5wMm0sIGN0eC0+eDg2X3B2LnAybV9mcmFtZXMgKiBQQUdFX1NJ
WkUpOworICAgIGlmICggY3R4LT54ODYucHYucDJtICkKKyAgICAgICAgbXVubWFwKGN0eC0+eDg2
LnB2LnAybSwgY3R4LT54ODYucHYucDJtX2ZyYW1lcyAqIFBBR0VfU0laRSk7CiAKLSAgICBpZiAo
IGN0eC0+eDg2X3B2LnNoaW5mbyApCi0gICAgICAgIG11bm1hcChjdHgtPng4Nl9wdi5zaGluZm8s
IFBBR0VfU0laRSk7CisgICAgaWYgKCBjdHgtPng4Ni5wdi5zaGluZm8gKQorICAgICAgICBtdW5t
YXAoY3R4LT54ODYucHYuc2hpbmZvLCBQQUdFX1NJWkUpOwogCi0gICAgaWYgKCBjdHgtPng4Nl9w
di5tMnAgKQotICAgICAgICBtdW5tYXAoY3R4LT54ODZfcHYubTJwLCBjdHgtPng4Nl9wdi5ucl9t
MnBfZnJhbWVzICogUEFHRV9TSVpFKTsKKyAgICBpZiAoIGN0eC0+eDg2LnB2Lm0ycCApCisgICAg
ICAgIG11bm1hcChjdHgtPng4Ni5wdi5tMnAsIGN0eC0+eDg2LnB2Lm5yX20ycF9mcmFtZXMgKiBQ
QUdFX1NJWkUpOwogCiAgICAgcmV0dXJuIDA7CiB9Ci0tIAoyLjExLjAKCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0
Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qu
b3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id F3168B3905
	for <lists+xen-devel@lfdr.de>; Mon, 16 Sep 2019 13:06:52 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9ons-0005o7-7X; Mon, 16 Sep 2019 11:04:20 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GGTU=XL=amazon.de=prvs=1553567f6=wipawel@srs-us1.protection.inumbo.net>)
 id 1i9onp-0005kR-RR
 for xen-devel@lists.xen.org; Mon, 16 Sep 2019 11:04:17 +0000
X-Inumbo-ID: b788d01e-d871-11e9-95df-12813bfff9fa
Received: from smtp-fw-6002.amazon.com (unknown [52.95.49.90])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id b788d01e-d871-11e9-95df-12813bfff9fa;
 Mon, 16 Sep 2019 11:04:13 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1568631852; x=1600167852;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=o0vUfFf3DyA2FXmVvvyTq8bmyKY/1P5gvzxeChX6GwA=;
 b=HWDw6L18l3VUw+NDnL6taROIeDsKsLTO+LRmm9Ot2LQX7PlOX5P4Jbql
 348+UbHr7erkCgeHYEPmsTuRaBoW9kcXoq/qbMqMtyD9Ny4Q6Oy/gFgd8
 WORt+IiUdTsBzIAwoQ3VuFRFJV6L7byDFeMsMr8cjk0eo9YZGZS+GcFG3 U=;
X-IronPort-AV: E=Sophos;i="5.64,512,1559520000"; d="scan'208";a="421362241"
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1a-7d76a15f.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-6002.iad6.amazon.com with ESMTP;
 16 Sep 2019 11:04:10 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1a-7d76a15f.us-east-1.amazon.com (Postfix) with ESMTPS
 id C692EA0566; Mon, 16 Sep 2019 11:04:07 +0000 (UTC)
Received: from EX13D03EUC002.ant.amazon.com (10.43.164.60) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:03:55 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D03EUC002.ant.amazon.com (10.43.164.60) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:03:54 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Mon, 16 Sep 2019 11:03:52 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>, <xen-devel@lists.xenproject.org>
Date: Mon, 16 Sep 2019 10:59:44 +0000
Message-ID: <20190916105945.93632-12-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190916105945.93632-1-wipawel@amazon.de>
References: <20190916105945.93632-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v3 11/12] livepatch: Add metadata runtime
 retrieval mechanism
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RXh0ZW5kIHRoZSBsaXZlcGF0Y2ggbGlzdCBvcGVyYXRpb24gdG8gZmV0Y2ggYWxzbyBwYXlsb2Fk
cycgbWV0YWRhdGEuClRoaXMgaXMgYWNoaWV2ZWQgYnkgZXh0ZW5kaW5nIHRoZSBzeXNjdGwgbGlz
dCBpbnRlcmZhY2Ugd2l0aCAyIGV4dHJhCmd1ZXN0IGhhbmRsZXM6CiogbWV0YWRhdGEgICAgIC0g
YW4gYXJyYXkgb2YgYXJiaXRyYXJ5IHNpemUgc3RyaW5ncwoqIG1ldGFkYXRhX2xlbiAtIGFuIGFy
cmF5IG9mIG1ldGFkYXRhIHN0cmluZ3MnIGxlbmd0aHMgKHVpbjMyX3QgZWFjaCkKClBheWxvYWRz
JyBtZXRhZGF0YSBpcyBhIHN0cmluZyBvZiBhcmJpdHJhcnkgc2l6ZSBhbmQgZG9lcyBub3QgaGF2
ZSBhbgp1cHBlciBib3VuZCBsaW1pdC4gSXQgbWF5IGFsc28gdmFyeSBpbiBzaXplIGJldHdlZW4g
cGF5bG9hZHMuCgpJbiBvcmRlciB0byBsZXQgdGhlIHVzZXJsYW5kIGFsbG9jYXRlIGVub3VnaCBz
cGFjZSBmb3IgdGhlIGluY29taW5nCmRhdGEgYWRkIGEgbWV0YWRhdGEgdG90YWwgc2l6ZSBmaWVs
ZCB0byB0aGUgbGlzdCBzeXNjdGwgb3BlcmF0aW9uIGFuZApmaWxsIGl0IHdpdGggdG90YWwgc2l6
ZSBvZiBhbGwgcGF5bG9hZHMnIG1ldGFkYXRhLgoKRXh0ZW5kIHRoZSBsaWJ4YyB0byBoYW5kbGUg
dGhlIG1ldGFkYXRhIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycwphcyB3ZWxsIGFzIG1ldGFk
YXRhIGxlbmd0aCBhcnJheSBkYXRhIHRyYW5zZmVycy4KClRoZSB4ZW4tbGl2ZXBhdGNoIHVzZXJs
YW5kIHRvb2wgaXMgZXh0ZW5kZWQgdG8gYWx3YXlzIGRpc3BsYXkgdGhlCm1ldGFkYXRhIGZvciBl
YWNoIHJlY2VpdmVkIG1vZHVsZS4gVGhlIG1ldGFkYXRhIGlzIHJlY2VpdmVkIHdpdGggdGhlCmZv
bGxvd2luZyBmb3JtYXQ6IGtleT12YWx1ZVwwa2V5PXZhbHVlXDAuLi5rZXk9dmFsdWVcMC4gVGhl
IGZvcm1hdCBpcwptb2RpZmllZCB0byB0aGUgZm9sbG93aW5nIG9uZToga2V5PXZhbHVlO2tleT12
YWx1ZTsuLi5rZXk9dmFsdWUuClRoZSBuZXcgZm9ybWF0IGFsbG93cyB0byBlYXNpbHkgcGFyc2Ug
dGhlIG1ldGFkYXRhIGZvciBhIGdpdmVuIG1vZHVsZQpieSBhIG1hY2hpbmUuCgpTaWduZWQtb2Zm
LWJ5OiBQYXdlbCBXaWVjem9ya2lld2ljeiA8d2lwYXdlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5
OiBBbmRyYS1JcmluYSBQYXJhc2NoaXYgPGFuZHJhcHJzQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5
OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTm9yYmVy
dCBNYW50aGV5IDxubWFudGhleUBhbWF6b24uZGU+ClNpZ25lZC1vZmYtYnk6IEtvbnJhZCBSemVz
enV0ZWsgV2lsayA8a29ucmFkLndpbGtAb3JhY2xlLmNvbT4KLS0tCkNoYW5nZWQgc2luY2UgdjE6
CiAgKiBhZGRlZCBjb3JyZXNwb25kaW5nIGRvY3VtZW50YXRpb24KICAqIG1ha2UgbWV0YWRhdGEg
b3B0aW9uYWwgKGRvIG5vdCBkaXNwbGF5IGl0IHdoZW4gZ2l2ZW4gcGF5bG9hZAogICAgZG9lcyBu
b3QgaGF2ZSBpdCkKCiBkb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYyAgICB8IDMxICsrKysrKysr
KysrKysrKystLS0tLQogdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmggfCAyMiArKysrKysr
KysrKy0tLS0KIHRvb2xzL2xpYnhjL3hjX21pc2MuYyAgICAgICAgIHwgNjQgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLQogdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNo
LmMgICAgfCA0MyArKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLQogeGVuL2NvbW1vbi9saXZl
cGF0Y2guYyAgICAgICAgfCAyMiArKysrKysrKysrKy0tLS0KIHhlbi9pbmNsdWRlL3B1YmxpYy9z
eXNjdGwuaCAgIHwgMTkgKysrKysrKysrLS0tLQogNiBmaWxlcyBjaGFuZ2VkLCAxNTcgaW5zZXJ0
aW9ucygrKSwgNDQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNjL2xpdmVwYXRj
aC5wYW5kb2MgYi9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwppbmRleCBlN2JjYzcwZjVhLi4x
NTIxN2UzNDUyIDEwMDY0NAotLS0gYS9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYworKysgYi9k
b2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwpAQCAtNzA3LDggKzcwNyw4IEBAIFRoZSBzdHJ1Y3R1
cmUgaXMgYXMgZm9sbG93OgogCiAjIyMgWEVOX1NZU0NUTF9MSVZFUEFUQ0hfTElTVCAoMikKIAot
UmV0cmlldmUgYW4gYXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzIGFuZCBuYW1lcyBvZiBwYXls
b2FkcyB0aGF0IGFyZSBsb2FkZWQgaW4gdGhlCi1oeXBlcnZpc29yLgorUmV0cmlldmUgYW4gYXJy
YXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzLCBuYW1lcyBhbmQgbWV0YWRhdGEgb2YgcGF5bG9hZHMg
dGhhdCBhcmUKK2xvYWRlZCBpbiB0aGUgaHlwZXJ2aXNvci4KIAogVGhlIGNhbGxlciBwcm92aWRl
czoKIApAQCAtNzE3LDggKzcxNyw5IEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBgaWR4YCBJ
bmRleCBpdGVyYXRvci4gVGhlIGluZGV4IGludG8gdGhlIGh5cGVydmlzb3IncyBwYXlsb2FkIGNv
dW50LiBJdCBpcwogICAgIHJlY29tbWVuZGVkIHRoYXQgb24gZmlyc3QgaW52b2NhdGlvbiB6ZXJv
IGJlIHVzZWQgc28gdGhhdCBgbnJgICh3aGljaCB0aGUKICAgICBoeXBlcnZpc29yIHdpbGwgdXBk
YXRlIHdpdGggdGhlIHJlbWFpbmluZyBwYXlsb2FkIGNvdW50KSBiZSBwcm92aWRlZC4KLSAgICBB
bHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVyc2lvbmAgd2l0aCB0aGUgbW9zdCBj
dXJyZW50IHZhbHVlIGFuZAotICAgIGNhbGN1bGF0ZWQgdG90YWwgc2l6ZSBmb3IgYWxsIHBheWxv
YWRzJyBuYW1lcy4KKyAgICBBbHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVyc2lv
bmAgd2l0aCB0aGUgbW9zdCBjdXJyZW50IHZhbHVlLAorICAgIGNhbGN1bGF0ZWQgdG90YWwgc2l6
ZSBvZiBhbGwgcGF5bG9hZHMnIG5hbWVzIGFuZCBjYWxjdWxhdGVkIHRvdGFsIHNpemUgb2YKKyAg
ICBhbGwgcGF5bG9hZCdzIG1ldGFkYXRhLgogICogYG5yYCBUaGUgbWF4IG51bWJlciBvZiBlbnRy
aWVzIHRvIHBvcHVsYXRlLiBDYW4gYmUgemVybyB3aGljaCB3aWxsIHJlc3VsdAogICAgIGluIHRo
ZSBoeXBlcmNhbGwgYmVpbmcgYSBwcm9iaW5nIG9uZSBhbmQgcmV0dXJuIHRoZSBudW1iZXIgb2Yg
cGF5bG9hZHMKICAgICAoYW5kIHVwZGF0ZSB0aGUgYHZlcnNpb25gKS4KQEAgLTczNCwxNCArNzM1
LDIzIEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBgbGVuYCAtIFZpcnR1YWwgYWRkcmVzcyBv
ZiB3aGVyZSB0byB3cml0ZSB0aGUgbGVuZ3RoIG9mIGVhY2ggdW5pcXVlIG5hbWUKICAgIG9mIHRo
ZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4gRWFj
aCAqTVVTVCogYmUKICAgIG9mIHNpemVvZih1aW50MzJfdCkgKDQgYnl0ZXMpLgorICogYG1ldGFk
YXRhYCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgbWV0YWRhdGEgb2Yg
dGhlIHBheWxvYWRzLgorICAgQ2FsbGVyICpNVVNUKiBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgdG8g
YmUgYWJsZSB0byBzdG9yZSBhbGwgcmVjZWl2ZWQgZGF0YQorICAgKGkuZS4gdG90YWwgYWxsb2Nh
dGVkIHNwYWNlICpNVVNUKiBtYXRjaCB0aGUgYG1ldGFkYXRhX3RvdGFsX3NpemVgIHZhbHVlCisg
ICBwcm92aWRlZCBieSB0aGUgaHlwZXJ2aXNvcikuIEluZGl2aWR1YWwgcGF5bG9hZCBtZXRhZGF0
YSBzdHJpbmcgY2FuIGJlIG9mCisgICBhcmJpdHJhcnkgbGVuZ3RoLiBUaGUgbWV0YWRhdGEgc3Ry
aW5nIGZvcm1hdCBpczoga2V5PXZhbHVlXDAuLi5rZXk9dmFsdWVcMC4KKyAqIGBtZXRhZGF0YV9s
ZW5gIC0gVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdyaXRlIHRoZSBsZW5ndGggb2YgZWFj
aCBtZXRhZGF0YQorICAgc3RyaW5nIG9mIHRoZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9j
YXRlIHVwIHRvIGBucmAgb2YgdGhlbS4gRWFjaCAqTVVTVCoKKyAgIGJlIG9mIHNpemVvZih1aW50
MzJfdCkgKDQgYnl0ZXMpLgogCiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgYW4gcG9zaXRpdmUg
bnVtYmVyLCBpdCBpcyB0aGUgbnVtYmVyICh1cHRvIGBucmAKIHByb3ZpZGVkIHRvIHRoZSBoeXBl
cmNhbGwpIG9mIHRoZSBwYXlsb2FkcyByZXR1cm5lZCwgYWxvbmcgd2l0aCBgbnJgIHVwZGF0ZWQK
IHdpdGggdGhlIG51bWJlciBvZiByZW1haW5pbmcgcGF5bG9hZHMsIGB2ZXJzaW9uYCB1cGRhdGVk
IChpdCBtYXkgYmUgdGhlIHNhbWUKIGFjcm9zcyBoeXBlcmNhbGxzIC0gaWYgaXQgdmFyaWVzIHRo
ZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNvdWxkCi1mYWlsKSBhbmQgdGhlIGBu
YW1lX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZSBvZiB0cmFuc2ZlcmVkIGRhdGEg
Zm9yCi10aGUgYXJyYXkuIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBhbmQgYGxlbmAgYXJlIHVwZGF0
ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgKLXZhbHVlIChgaWR4YCkgd2l0aCB0aGUgcmV0dXJu
ZWQgdmFsdWUgb2YgZGF0YS4KK2ZhaWwpLCBgbmFtZV90b3RhbF9zaXplYCBhbmQgYG1ldGFkYXRh
X3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZXMgb2YKK3RyYW5zZmVyZWQgZGF0YSBm
b3IgYm90aCB0aGUgYXJyYXlzLgorVGhlIGBzdGF0dXNgLCBgbmFtZWAsIGBsZW5gLCBgbWV0YWRh
dGFgIGFuZCBgbWV0YWRhdGFfbGVuYCBhcmUgdXBkYXRlZCBhdCB0aGVpcgorZGVzaWduZWQgaW5k
ZXggdmFsdWUgKGBpZHhgKSB3aXRoIHRoZSByZXR1cm5lZCB2YWx1ZSBvZiBkYXRhLgogCiBJZiB0
aGUgaHlwZXJjYWxsIHJldHVybnMgLVhFTl9FMkJJRyB0aGUgYG5yYCBpcyB0b28gYmlnIGFuZCBz
aG91bGQgYmUKIGxvd2VyZWQuCkBAIC03ODAsNiArNzkwLDcgQEAgVGhlIHN0cnVjdHVyZSBpcyBh
cyBmb2xsb3c6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBPVVQ6IEhvdyBtYW55IHBheWxvYWRzIGxlZnQuICovCiAgICAgICAgIHVpbnQzMl90IHBh
ZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBJTjogTXVzdCBiZSB6ZXJvLiAqLwogICAg
ICAgICB1aW50NjRfdCBuYW1lX3RvdGFsX3NpemU7ICAgICAgICAgICAgICAgLyogT1VUOiBUb3Rh
bCBzaXplIG9mIGFsbCB0cmFuc2ZlciBuYW1lcyAqLworICAgICAgICB1aW50NjRfdCBtZXRhZGF0
YV90b3RhbF9zaXplOyAgICAgICAgICAgLyogT1VUOiBUb3RhbCBzaXplIG9mIGFsbCB0cmFuc2Zl
ciBtZXRhZGF0YSAqLwogICAgICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHhlbl9saXZlcGF0Y2hf
c3RhdHVzX3QpIHN0YXR1czsgIC8qIE9VVC4gTXVzdCBoYXZlIGVub3VnaAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2UgYWxsb2NhdGUgZm9y
IG5yIG9mIHRoZW0uICovCiAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgbmFtZTsg
ICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIG5hbWVzLiBFYWNoIG1lbWJlcgpAQCAtNzg4LDYgKzc5
OSwxMiBAQCBUaGUgc3RydWN0dXJlIGlzIGFzIGZvbGxvdzoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yIG9mIHRoZW0uICovCiAgICAgICAgIFhF
Tl9HVUVTVF9IQU5ETEVfNjQodWludDMyKSBsZW47ICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIGxl
bmd0aHMgb2YgbmFtZSdzLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCisgICAgICAgIFhFTl9HVUVTVF9I
QU5ETEVfNjQoY2hhcikgbWV0YWRhdGE7ICAgICAvKiBPVVQ6IEFycmF5IG9mIG1ldGFkYXRhIHN0
cmluZ3MuIEVhY2gKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG1lbWJlciBtYXkgaGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoLgorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRo
ZW0uICovCisgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQodWludDMyKSBtZXRhZGF0YV9sZW47
ICAvKiBPVVQ6IEFycmF5IG9mIGxlbmd0aHMgb2YgbWV0YWRhdGEncy4KKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0
aGVtLiAqLworCiAgICAgfTsKIAogIyMjIFhFTl9TWVNDVExfTElWRVBBVENIX0FDVElPTiAoMykK
ZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oIGIvdG9vbHMvbGlieGMv
aW5jbHVkZS94ZW5jdHJsLmgKaW5kZXggMjUyNjc1ZjExNy4uNGJhZmQ4NTQxYSAxMDA2NDQKLS0t
IGEvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmgKKysrIGIvdG9vbHMvbGlieGMvaW5jbHVk
ZS94ZW5jdHJsLmgKQEAgLTI1NTIsNyArMjU1Miw3IEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhj
X2ludGVyZmFjZSAqeGNoLAogCiAvKgogICogR2V0IGEgbnVtYmVyIG9mIGF2YWlsYWJsZSBwYXls
b2FkcyBhbmQgZ2V0IGFjdHVhbCB0b3RhbCBzaXplIG9mCi0gKiB0aGUgcGF5bG9hZHMnIG5hbWUg
YXJyYXkuCisgKiB0aGUgcGF5bG9hZHMnIG5hbWUgYW5kIG1ldGFkYXRhIGFycmF5cy4KICAqCiAg
KiBUaGlzIGZ1bmN0aW9ucyBpcyB0eXBpY2FsbHkgZXhlY3V0ZWQgZmlyc3QgYmVmb3JlIHRoZSB4
Y19saXZlcGF0Y2hfbGlzdCgpCiAgKiB0byBvYnRhaW4gdGhlIHNpemVzIGFuZCBjb3JyZWN0bHkg
YWxsb2NhdGUgYWxsIG5lY2Vzc2FyeSBkYXRhIHJlc291cmNlcy4KQEAgLTI1NjMsMTMgKzI1NjMs
MTYgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAgKiB3aWxsIGNv
bnRhaW4gdGhlIGh5cGVyY2FsbCBlcnJvciBjb2RlIHZhbHVlLgogICovCiBpbnQgeGNfbGl2ZXBh
dGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqbmFtZV90b3RhbF9zaXpl
KTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3QgKm5hbWVfdG90YWxf
c2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3QgKm1ldGFkYXRh
X3RvdGFsX3NpemUpOwogCiAvKgogICogVGhlIGhlYXJ0IG9mIHRoaXMgZnVuY3Rpb24gaXMgdG8g
Z2V0IGFuIGFycmF5IG9mIHRoZSBmb2xsb3dpbmcgb2JqZWN0czoKICAqICAgLSB4ZW5fbGl2ZXBh
dGNoX3N0YXR1c190OiBzdGF0ZXMgYW5kIHJldHVybiBjb2RlcyBvZiBwYXlsb2FkcwogICogICAt
IG5hbWU6IG5hbWVzIG9mIHBheWxvYWRzCiAgKiAgIC0gbGVuOiBsZW5ndGhzIG9mIGNvcnJlc3Bv
bmRpbmcgcGF5bG9hZHMnIG5hbWVzCisgKiAgIC0gbWV0YWRhdGE6IHBheWxvYWRzJyBtZXRhZGF0
YQorICogICAtIG1ldGFkYXRhX2xlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxvYWRz
JyBtZXRhZGF0YQogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNlIGl0IGhhcyB0
byBkZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBzb21lIG9mIHRoZSByZXF1
ZXN0ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC0yNTgyLDEyICsyNTg1LDEzIEBAIGlu
dCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVk
IGludCAqbnIsCiAgKgogICogSXQgaXMgZXhwZWN0ZWQgdGhhdCB0aGUgY2FsbGVyIG9mIHRoaXMg
ZnVuY3Rpb24gd2lsbCBmaXJzdCBpc3N1ZSB0aGUKICAqIHhjX2xpdmVwYXRjaF9saXN0X2dldF9z
aXplcygpIGluIG9yZGVyIHRvIG9idGFpbiB0b3RhbCBzaXplcyBvZiBuYW1lcwotICogYXMgd2Vs
bCBhcyB0aGUgY3VycmVudCBudW1iZXIgb2YgcGF5bG9hZCBlbnRyaWVzLgotICogVGhlIHRvdGFs
IHNpemVzIGFyZSByZXF1aXJlZCBhbmQgc3VwcGxpZWQgdmlhIHRoZSAnbmFtZV90b3RhbF9zaXpl
JwotICogcGFyYW1ldGVyLgorICogYW5kIGFsbCBtZXRhZGF0YSBhcyB3ZWxsIGFzIHRoZSBjdXJy
ZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJpZXMuCisgKiBUaGUgdG90YWwgc2l6ZXMgYXJlIHJl
cXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhlICduYW1lX3RvdGFsX3NpemUnIGFuZAorICogJ21l
dGFkYXRhX3RvdGFsX3NpemUnIHBhcmFtZXRlcnMuCiAgKgogICogVGhlICdtYXgnIGlzIHRvIGJl
IHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4aW11bSBudW1iZXIgb2YKLSAqIGVu
dHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgJ2xlbicgYXJyYXlzIGNhbiBiZSBmaWxsZWQgdXAg
d2l0aC4KKyAqIGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgJ2xlbicsICdtZXRhZGF0YScg
YW5kICdtZXRhZGF0YV9sZW4nIGFycmF5cworICogY2FuIGJlIGZpbGxlZCB1cCB3aXRoLgogICoK
ICAqIEVhY2ggZW50cnkgaW4gdGhlICdpbmZvJyBhcnJheSBpcyBleHBlY3RlZCB0byBiZSBvZiB4
ZW5fbGl2ZXBhdGNoX3N0YXR1c190CiAgKiBzdHJ1Y3R1cmUgc2l6ZS4KQEAgLTI1OTYsNiArMjYw
MCwxMCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNo
LCB1bnNpZ25lZCBpbnQgKm5yLAogICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdsZW4nIGFycmF5
IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCiAgKgorICogRWFjaCBlbnRyeSBp
biB0aGUgJ21ldGFkYXRhJyBhcnJheSBtYXkgaGF2ZSBhbiBhcmJpdHJhcnkgc2l6ZS4KKyAqCisg
KiBFYWNoIGVudHJ5IGluIHRoZSAnbWV0YWRhdGFfbGVuJyBhcnJheSBpcyBleHBlY3RlZCB0byBi
ZSBvZiB1aW50MzJfdCBzaXplLgorICoKICAqIFRoZSByZXR1cm4gdmFsdWUgaXMgemVybyBpZiB0
aGUgaHlwZXJjYWxsIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuCiAgKiBOb3RlIHRoYXQgdGhlIHJl
dHVybiB2YWx1ZSBpcyBfbm90XyB0aGUgYW1vdW50IG9mIGVudHJpZXMgZmlsbGVkCiAgKiBvdXQg
LSB0aGF0IGlzIHNhdmVkIGluICdkb25lJy4KQEAgLTI2MTAsNiArMjYxOCw4IEBAIGludCB4Y19s
aXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwK
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmluZm8s
CiAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3QgKmxlbiwKICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCB1aW50NjRfdCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAg
ICAgICAgICAgICAgICAgY2hhciAqbWV0YWRhdGEsIHVpbnQzMl90ICptZXRhZGF0YV9sZW4sCisg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgdWludDY0X3QgbWV0YWRhdGFfdG90YWxfc2l6ZSwK
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmRvbmUsIHVuc2lnbmVkIGludCAq
bGVmdCk7CiAKIC8qCmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy94Y19taXNjLmMgYi90b29scy9s
aWJ4Yy94Y19taXNjLmMKaW5kZXggZDc4N2YzZjI5Zi4uN2RjOWZkODNlZCAxMDA2NDQKLS0tIGEv
dG9vbHMvbGlieGMveGNfbWlzYy5jCisrKyBiL3Rvb2xzL2xpYnhjL3hjX21pc2MuYwpAQCAtNjYz
LDcgKzY2Myw3IEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFjZSAqeGNoLAogCiAv
KgogICogR2V0IGEgbnVtYmVyIG9mIGF2YWlsYWJsZSBwYXlsb2FkcyBhbmQgZ2V0IGFjdHVhbCB0
b3RhbCBzaXplIG9mCi0gKiB0aGUgcGF5bG9hZHMnIG5hbWUgYXJyYXkuCisgKiB0aGUgcGF5bG9h
ZHMnIG5hbWUgYW5kIG1ldGFkYXRhIGFycmF5cy4KICAqCiAgKiBUaGlzIGZ1bmN0aW9ucyBpcyB0
eXBpY2FsbHkgZXhlY3V0ZWQgZmlyc3QgYmVmb3JlIHRoZSB4Y19saXZlcGF0Y2hfbGlzdCgpCiAg
KiB0byBvYnRhaW4gdGhlIHNpemVzIGFuZCBjb3JyZWN0bHkgYWxsb2NhdGUgYWxsIG5lY2Vzc2Fy
eSBkYXRhIHJlc291cmNlcy4KQEAgLTY3NCwxMiArNjc0LDEzIEBAIGludCB4Y19saXZlcGF0Y2hf
Z2V0KHhjX2ludGVyZmFjZSAqeGNoLAogICogd2lsbCBjb250YWluIHRoZSBoeXBlcmNhbGwgZXJy
b3IgY29kZSB2YWx1ZS4KICAqLwogaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y19p
bnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdWludDY0X3QgKm5hbWVfdG90YWxfc2l6ZSkKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdWludDY0X3QgKm5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludDY0X3QgKm1ldGFkYXRhX3RvdGFsX3NpemUpCiB7CiAgICAgREVD
TEFSRV9TWVNDVEw7CiAgICAgaW50IHJjOwogCi0gICAgaWYgKCAhbnIgfHwgIW5hbWVfdG90YWxf
c2l6ZSApCisgICAgaWYgKCAhbnIgfHwgIW5hbWVfdG90YWxfc2l6ZSB8fCAhbWV0YWRhdGFfdG90
YWxfc2l6ZSApCiAgICAgewogICAgICAgICBlcnJubyA9IEVJTlZBTDsKICAgICAgICAgcmV0dXJu
IC0xOwpAQCAtNjk1LDYgKzY5Niw3IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMo
eGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAKICAgICAqbnIgPSBzeXNjdGwu
dS5saXZlcGF0Y2gudS5saXN0Lm5yOwogICAgICpuYW1lX3RvdGFsX3NpemUgPSBzeXNjdGwudS5s
aXZlcGF0Y2gudS5saXN0Lm5hbWVfdG90YWxfc2l6ZTsKKyAgICAqbWV0YWRhdGFfdG90YWxfc2l6
ZSA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubWV0YWRhdGFfdG90YWxfc2l6ZTsKIAogICAg
IHJldHVybiAwOwogfQpAQCAtNzA0LDYgKzcwNiw4IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdF9n
ZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAgKiAgIC0geGVu
X2xpdmVwYXRjaF9zdGF0dXNfdDogc3RhdGVzIGFuZCByZXR1cm4gY29kZXMgb2YgcGF5bG9hZHMK
ICAqICAgLSBuYW1lOiBuYW1lcyBvZiBwYXlsb2FkcwogICogICAtIGxlbjogbGVuZ3RocyBvZiBj
b3JyZXNwb25kaW5nIHBheWxvYWRzJyBuYW1lcworICogICAtIG1ldGFkYXRhOiBwYXlsb2Fkcycg
bWV0YWRhdGEKKyAqICAgLSBtZXRhZGF0YV9sZW46IGxlbmd0aHMgb2YgY29ycmVzcG9uZGluZyBw
YXlsb2FkcycgbWV0YWRhdGEKICAqCiAgKiBIb3dldmVyIGl0IGlzIGNvbXBsZXggYmVjYXVzZSBp
dCBoYXMgdG8gZGVhbCB3aXRoIHRoZSBoeXBlcnZpc29yCiAgKiByZXR1cm5pbmcgc29tZSBvZiB0
aGUgcmVxdWVzdGVkIGRhdGEgb3IgZGF0YSBiZWluZyBzdGFsZQpAQCAtNzE2LDEyICs3MjAsMTMg
QEAgaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5z
aWduZWQgaW50ICpuciwKICAqCiAgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIgb2Yg
dGhpcyBmdW5jdGlvbiB3aWxsIGZpcnN0IGlzc3VlIHRoZQogICogeGNfbGl2ZXBhdGNoX2xpc3Rf
Z2V0X3NpemVzKCkgaW4gb3JkZXIgdG8gb2J0YWluIHRvdGFsIHNpemVzIG9mIG5hbWVzCi0gKiBh
cyB3ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJpZXMuCi0gKiBUaGUg
dG90YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhlICduYW1lX3RvdGFs
X3NpemUnCi0gKiBwYXJhbWV0ZXIuCisgKiBhbmQgYWxsIG1ldGFkYXRhIGFzIHdlbGwgYXMgdGhl
IGN1cnJlbnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcy4KKyAqIFRoZSB0b3RhbCBzaXplcyBh
cmUgcmVxdWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6ZScgYW5kCisg
KiAnbWV0YWRhdGFfdG90YWxfc2l6ZScgcGFyYW1ldGVycy4KICAqCiAgKiBUaGUgJ21heCcgaXMg
dG8gYmUgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtIG51bWJlciBvZgot
ICogZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAnbGVuJyBhcnJheXMgY2FuIGJlIGZpbGxl
ZCB1cCB3aXRoLgorICogZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAnbGVuJywgJ21ldGFk
YXRhJyBhbmQgJ21ldGFkYXRhX2xlbicgYXJyYXlzCisgKiBjYW4gYmUgZmlsbGVkIHVwIHdpdGgu
CiAgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2luZm8nIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJl
IG9mIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QKICAqIHN0cnVjdHVyZSBzaXplLgpAQCAtNzMwLDYg
KzczNSwxMCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAq
eGNoLCB1bnNpZ25lZCBpbnQgKm5yLAogICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdsZW4nIGFy
cmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCiAgKgorICogRWFjaCBlbnRy
eSBpbiB0aGUgJ21ldGFkYXRhJyBhcnJheSBtYXkgaGF2ZSBhbiBhcmJpdHJhcnkgc2l6ZS4KKyAq
CisgKiBFYWNoIGVudHJ5IGluIHRoZSAnbWV0YWRhdGFfbGVuJyBhcnJheSBpcyBleHBlY3RlZCB0
byBiZSBvZiB1aW50MzJfdCBzaXplLgorICoKICAqIFRoZSByZXR1cm4gdmFsdWUgaXMgemVybyBp
ZiB0aGUgaHlwZXJjYWxsIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuCiAgKiBOb3RlIHRoYXQgdGhl
IHJldHVybiB2YWx1ZSBpcyBfbm90XyB0aGUgYW1vdW50IG9mIGVudHJpZXMgZmlsbGVkCiAgKiBv
dXQgLSB0aGF0IGlzIHNhdmVkIGluICdkb25lJy4KQEAgLTc0NCw2ICs3NTMsOCBAQCBpbnQgeGNf
bGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgs
CiAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhlbl9saXZlcGF0Y2hfc3RhdHVzICppbmZv
LAogICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm5hbWUsIHVpbnQzMl90ICpsZW4sCiAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgdWludDY0X3QgbmFtZV90b3RhbF9zaXplLAorICAgICAg
ICAgICAgICAgICAgICAgIGNoYXIgKm1ldGFkYXRhLCB1aW50MzJfdCAqbWV0YWRhdGFfbGVuLAor
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVpbnQ2NF90IG1ldGFkYXRhX3RvdGFsX3NpemUs
CiAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpkb25lLCB1bnNpZ25lZCBpbnQg
KmxlZnQpCiB7CiAgICAgaW50IHJjOwpAQCAtNzUyLDEzICs3NjMsMTYgQEAgaW50IHhjX2xpdmVw
YXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAg
IERFQ0xBUkVfSFlQRVJDQUxMX0JPVU5DRShpbmZvLCAwLCBYQ19IWVBFUkNBTExfQlVGRkVSX0JP
VU5DRV9PVVQpOwogICAgIERFQ0xBUkVfSFlQRVJDQUxMX0JPVU5DRShuYW1lLCAwLCBYQ19IWVBF
UkNBTExfQlVGRkVSX0JPVU5DRV9PVVQpOwogICAgIERFQ0xBUkVfSFlQRVJDQUxMX0JPVU5DRShs
ZW4sIDAsIFhDX0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNFX09VVCk7CisgICAgREVDTEFSRV9IWVBF
UkNBTExfQk9VTkNFKG1ldGFkYXRhLCAwLCBYQ19IWVBFUkNBTExfQlVGRkVSX0JPVU5DRV9PVVQp
OworICAgIERFQ0xBUkVfSFlQRVJDQUxMX0JPVU5DRShtZXRhZGF0YV9sZW4sIDAsIFhDX0hZUEVS
Q0FMTF9CVUZGRVJfQk9VTkNFX09VVCk7CiAgICAgdWludDMyX3QgbWF4X2JhdGNoX3N6LCBucjsK
ICAgICB1aW50MzJfdCB2ZXJzaW9uID0gMCwgcmV0cmllcyA9IDA7CiAgICAgdWludDMyX3QgYWRq
dXN0ID0gMDsKLSAgICBvZmZfdCBuYW1lX29mZiA9IDA7Ci0gICAgdWludDY0X3QgbmFtZV9zejsK
KyAgICBvZmZfdCBuYW1lX29mZiA9IDAsIG1ldGFkYXRhX29mZiA9IDA7CisgICAgdWludDY0X3Qg
bmFtZV9zeiwgbWV0YWRhdGFfc3o7CiAKLSAgICBpZiAoICFtYXggfHwgIWluZm8gfHwgIW5hbWUg
fHwgIWxlbiB8fCAhZG9uZSB8fCAhbGVmdCApCisgICAgaWYgKCAhbWF4IHx8ICFpbmZvIHx8ICFu
YW1lIHx8ICFsZW4gfHwKKyAgICAgICAgICFtZXRhZGF0YSB8fCAhbWV0YWRhdGFfbGVuIHx8ICFk
b25lIHx8ICFsZWZ0ICkKICAgICB7CiAgICAgICAgIGVycm5vID0gRUlOVkFMOwogICAgICAgICBy
ZXR1cm4gLTE7CkBAIC03NzcsMTAgKzc5MSwxMSBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAKICAgICBtYXhfYmF0Y2hf
c3ogPSBtYXg7CiAgICAgbmFtZV9zeiA9IG5hbWVfdG90YWxfc2l6ZTsKKyAgICBtZXRhZGF0YV9z
eiA9IG1ldGFkYXRhX3RvdGFsX3NpemU7CiAgICAgKmRvbmUgPSAwOwogICAgICpsZWZ0ID0gMDsK
ICAgICBkbyB7Ci0gICAgICAgIHVpbnQ2NF90IF9uYW1lX3N6OworICAgICAgICB1aW50NjRfdCBf
bmFtZV9zeiwgX21ldGFkYXRhX3N6OwogCiAgICAgICAgIC8qCiAgICAgICAgICAqIFRoZSBmaXJz
dCB0aW1lIHdlIGdvIGluIHRoaXMgbG9vcCBvdXIgJ21heCcgbWF5IGJlIGJpZ2dlcgpAQCAtODAz
LDEwICs4MTgsMTQgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBj
b25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpF
KGluZm8sIG5yICogc2l6ZW9mKCppbmZvKSk7CiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VU
X1NJWkUobmFtZSwgbmFtZV9zeik7CiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUo
bGVuLCBuciAqIHNpemVvZigqbGVuKSk7CisgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJ
WkUobWV0YWRhdGEsIG1ldGFkYXRhX3N6KTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRf
U0laRShtZXRhZGF0YV9sZW4sIG5yICogc2l6ZW9mKCptZXRhZGF0YV9sZW4pKTsKICAgICAgICAg
LyogTW92ZSB0aGUgcG9pbnRlciB0byBwcm9wZXIgb2Zmc2V0IGludG8gJ2luZm8nLiAqLwogICAg
ICAgICAoSFlQRVJDQUxMX0JVRkZFUihpbmZvKSktPnVidWYgPSBpbmZvICsgKmRvbmU7CiAgICAg
ICAgIChIWVBFUkNBTExfQlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyBuYW1lX29mZjsKICAg
ICAgICAgKEhZUEVSQ0FMTF9CVUZGRVIobGVuKSktPnVidWYgPSBsZW4gKyAqZG9uZTsKKyAgICAg
ICAgKEhZUEVSQ0FMTF9CVUZGRVIobWV0YWRhdGEpKS0+dWJ1ZiA9IG1ldGFkYXRhICsgbWV0YWRh
dGFfb2ZmOworICAgICAgICAoSFlQRVJDQUxMX0JVRkZFUihtZXRhZGF0YV9sZW4pKS0+dWJ1ZiA9
IG1ldGFkYXRhX2xlbiArICpkb25lOwogICAgICAgICAvKiBBbGxvY2F0ZSBtZW1vcnkuICovCiAg
ICAgICAgIHJjID0geGNfaHlwZXJjYWxsX2JvdW5jZV9wcmUoeGNoLCBpbmZvKTsKICAgICAgICAg
aWYgKCByYyApCkBAIC04MjAsOSArODM5LDE5IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19p
bnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICAgICAgaWYgKCByYyAp
CiAgICAgICAgICAgICBicmVhazsKIAorICAgICAgICByYyA9IHhjX2h5cGVyY2FsbF9ib3VuY2Vf
cHJlKHhjaCwgbWV0YWRhdGEpOworICAgICAgICBpZiAoIHJjICkKKyAgICAgICAgICAgIGJyZWFr
OworCisgICAgICAgIHJjID0geGNfaHlwZXJjYWxsX2JvdW5jZV9wcmUoeGNoLCBtZXRhZGF0YV9s
ZW4pOworICAgICAgICBpZiAoIHJjICkKKyAgICAgICAgICAgIGJyZWFrOworCiAgICAgICAgIHNl
dF94ZW5fZ3Vlc3RfaGFuZGxlKHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3Quc3RhdHVzLCBpbmZv
KTsKICAgICAgICAgc2V0X3hlbl9ndWVzdF9oYW5kbGUoc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlz
dC5uYW1lLCBuYW1lKTsKICAgICAgICAgc2V0X3hlbl9ndWVzdF9oYW5kbGUoc3lzY3RsLnUubGl2
ZXBhdGNoLnUubGlzdC5sZW4sIGxlbik7CisgICAgICAgIHNldF94ZW5fZ3Vlc3RfaGFuZGxlKHN5
c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubWV0YWRhdGEsIG1ldGFkYXRhKTsKKyAgICAgICAgc2V0
X3hlbl9ndWVzdF9oYW5kbGUoc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5tZXRhZGF0YV9sZW4s
IG1ldGFkYXRhX2xlbik7CiAKICAgICAgICAgcmMgPSBkb19zeXNjdGwoeGNoLCAmc3lzY3RsKTsK
ICAgICAgICAgLyoKQEAgLTgzOSw2ICs4NjgsOCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAgICAgICAgICB4Y19o
eXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBpbmZvKTsKICAgICAgICAgICAgIHhjX2h5cGVyY2Fs
bF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5j
ZV9wb3N0KHhjaCwgbGVuKTsKKyAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4
Y2gsIG1ldGFkYXRhKTsKKyAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gs
IG1ldGFkYXRhX2xlbik7CiAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQogICAgICAg
ICBlbHNlIGlmICggcmMgPCAwICkgLyogRm9yIGFsbCBvdGhlciBlcnJvcnMgd2UgYmFpbCBvdXQu
ICovCkBAIC04NjMsNiArODk0LDggQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFj
ZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICAgICAgeGNfaHlwZXJjYWxs
X2JvdW5jZV9wb3N0KHhjaCwgaW5mbyk7CiAgICAgICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNl
X3Bvc3QoeGNoLCBuYW1lKTsKICAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4
Y2gsIGxlbik7CisgICAgICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBtZXRh
ZGF0YSk7CisgICAgICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBtZXRhZGF0
YV9sZW4pOwogICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgIH0KIApAQCAtODc1LDE3ICs5
MDgsMjQgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1
bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICB9CiAgICAgICAgICpsZWZ0ID0gc3lzY3RsLnUubGl2
ZXBhdGNoLnUubGlzdC5ucjsgLyogVG90YWwgcmVtYWluaW5nIGNvdW50LiAqLwogICAgICAgICBf
bmFtZV9zeiA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90b3RhbF9zaXplOyAvKiBU
b3RhbCByZWNlaXZlZCBuYW1lIHNpemUuICovCisgICAgICAgIF9tZXRhZGF0YV9zeiA9IHN5c2N0
bC51LmxpdmVwYXRjaC51Lmxpc3QubWV0YWRhdGFfdG90YWxfc2l6ZTsgLyogVG90YWwgcmVjZWl2
ZWQgbWV0YWRhdGEgc2l6ZS4gKi8KICAgICAgICAgLyogQ29weSBvbmx5IHVwICdyYycgb2YgZGF0
YScgLSB3ZSBjb3VsZCBhZGQgJ21pbihyYyxucikgaWYgZGVzaXJlZC4gKi8KICAgICAgICAgSFlQ
RVJDQUxMX0JPVU5DRV9TRVRfU0laRShpbmZvLCAocmMgKiBzaXplb2YoKmluZm8pKSk7CiAgICAg
ICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobmFtZSwgX25hbWVfc3opOwogICAgICAgICBI
WVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGxlbiwgKHJjICogc2l6ZW9mKCpsZW4pKSk7CisgICAg
ICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobWV0YWRhdGEsIF9tZXRhZGF0YV9zeik7Cisg
ICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobWV0YWRhdGFfbGVuLCAocmMgKiBzaXpl
b2YoKm1ldGFkYXRhX2xlbikpKTsKICAgICAgICAgLyogQm91bmNlIHRoZSBkYXRhIGFuZCBmcmVl
IHRoZSBib3VuY2UgYnVmZmVyLiAqLwogICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3Qo
eGNoLCBpbmZvKTsKICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbmFtZSk7
CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGxlbik7CisgICAgICAgIHhj
X2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1ldGFkYXRhKTsKKyAgICAgICAgeGNfaHlwZXJj
YWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGFfbGVuKTsKIAogICAgICAgICBuYW1lX3N6IC09
IF9uYW1lX3N6OwogICAgICAgICBuYW1lX29mZiArPSBfbmFtZV9zejsKKyAgICAgICAgbWV0YWRh
dGFfc3ogLT0gX21ldGFkYXRhX3N6OworICAgICAgICBtZXRhZGF0YV9vZmYgKz0gX21ldGFkYXRh
X3N6OwogCiAgICAgICAgIC8qIEFuZCB1cGRhdGUgaG93IG1hbnkgZWxlbWVudHMgb2YgaW5mbyB3
ZSBoYXZlIGNvcGllZCBpbnRvLiAqLwogICAgICAgICAqZG9uZSArPSByYzsKQEAgLTg5OCw2ICs5
MzgsOCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVu
c2lnbmVkIGludCBtYXgsCiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGxl
bik7CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAg
ICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBpbmZvKTsKKyAgICAgICAgeGNfaHlwZXJj
YWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGEpOworICAgICAgICB4Y19oeXBlcmNhbGxfYm91
bmNlX3Bvc3QoeGNoLCBtZXRhZGF0YV9sZW4pOwogICAgIH0KIAogICAgIHJldHVybiByYyA+IDAg
PyAwIDogcmM7CmRpZmYgLS1naXQgYS90b29scy9taXNjL3hlbi1saXZlcGF0Y2guYyBiL3Rvb2xz
L21pc2MveGVuLWxpdmVwYXRjaC5jCmluZGV4IDhhYzNkNTY3ZmMuLmYxNzM0MGEyZWUgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jCisrKyBiL3Rvb2xzL21pc2MveGVuLWxp
dmVwYXRjaC5jCkBAIC02OSw5ICs2OSwxMSBAQCBzdGF0aWMgaW50IGxpc3RfZnVuYyhpbnQgYXJn
YywgY2hhciAqYXJndltdKQogICAgIHVuc2lnbmVkIGludCBuciwgZG9uZSwgbGVmdCwgaTsKICAg
ICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICppbmZvID0gTlVMTDsKICAgICBjaGFyICpuYW1lID0g
TlVMTDsKKyAgICBjaGFyICptZXRhZGF0YSA9IE5VTEw7CiAgICAgdWludDMyX3QgKmxlbiA9IE5V
TEw7Ci0gICAgdWludDY0X3QgbmFtZV90b3RhbF9zaXplOwotICAgIG9mZl90IG5hbWVfb2ZmOwor
ICAgIHVpbnQzMl90ICptZXRhZGF0YV9sZW4gPSBOVUxMOworICAgIHVpbnQ2NF90IG5hbWVfdG90
YWxfc2l6ZSwgbWV0YWRhdGFfdG90YWxfc2l6ZTsKKyAgICBvZmZfdCBuYW1lX29mZiwgbWV0YWRh
dGFfb2ZmOwogICAgIGludCByYyA9IEVOT01FTTsKIAogICAgIGlmICggYXJnYyApCkBAIC04MSw3
ICs4Myw3IEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAg
ICAgfQogICAgIGRvbmUgPSBsZWZ0ID0gMDsKIAotICAgIHJjID0geGNfbGl2ZXBhdGNoX2xpc3Rf
Z2V0X3NpemVzKHhjaCwgJm5yLCAmbmFtZV90b3RhbF9zaXplKTsKKyAgICByYyA9IHhjX2xpdmVw
YXRjaF9saXN0X2dldF9zaXplcyh4Y2gsICZuciwgJm5hbWVfdG90YWxfc2l6ZSwgJm1ldGFkYXRh
X3RvdGFsX3NpemUpOwogICAgIGlmICggcmMgKQogICAgIHsKICAgICAgICAgcmMgPSBlcnJubzsK
QEAgLTEwOSwxMiArMTExLDIzIEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFy
ICphcmd2W10pCiAgICAgaWYgKCAhbGVuICkKICAgICAgICAgZ290byBlcnJvcl9sZW47CiAKKyAg
ICBtZXRhZGF0YSA9IG1hbGxvYyhtZXRhZGF0YV90b3RhbF9zaXplICogc2l6ZW9mKCptZXRhZGF0
YSkgKyAxKTsKKyAgICBpZiAoICFtZXRhZGF0YSApCisgICAgICAgIGdvdG8gZXJyb3JfbWV0YWRh
dGE7CisKKyAgICBtZXRhZGF0YV9sZW4gPSBtYWxsb2MobnIgKiBzaXplb2YoKm1ldGFkYXRhX2xl
bikpOworICAgIGlmICggIW1ldGFkYXRhX2xlbiApCisgICAgICAgIGdvdG8gZXJyb3JfbWV0YWRh
dGFfbGVuOworCiAgICAgbWVtc2V0KGluZm8sICdBJywgbnIgKiBzaXplb2YoKmluZm8pKTsKICAg
ICBtZW1zZXQobmFtZSwgJ0InLCBuYW1lX3RvdGFsX3NpemUgKiBzaXplb2YoKm5hbWUpKTsKICAg
ICBtZW1zZXQobGVuLCAnQycsIG5yICogc2l6ZW9mKCpsZW4pKTsKLSAgICBuYW1lX29mZiA9IDA7
CisgICAgbWVtc2V0KG1ldGFkYXRhLCAnRCcsIG1ldGFkYXRhX3RvdGFsX3NpemUgKiBzaXplb2Yo
Km1ldGFkYXRhKSArIDEpOworICAgIG1lbXNldChtZXRhZGF0YV9sZW4sICdFJywgbnIgKiBzaXpl
b2YoKm1ldGFkYXRhX2xlbikpOworICAgIG5hbWVfb2ZmID0gbWV0YWRhdGFfb2ZmID0gMDsKIAot
ICAgIHJjID0geGNfbGl2ZXBhdGNoX2xpc3QoeGNoLCBuciwgMCwgaW5mbywgbmFtZSwgbGVuLCBu
YW1lX3RvdGFsX3NpemUsICZkb25lLCAmbGVmdCk7CisgICAgcmMgPSB4Y19saXZlcGF0Y2hfbGlz
dCh4Y2gsIG5yLCAwLCBpbmZvLCBuYW1lLCBsZW4sIG5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLCBtZXRhZGF0YV9sZW4sIG1ldGFkYXRhX3RvdGFs
X3NpemUsICZkb25lLCAmbGVmdCk7CiAgICAgaWYgKCByYyB8fCBkb25lICE9IG5yIHx8IGxlZnQg
PiAwKQogICAgIHsKICAgICAgICAgcmMgPSBlcnJubzsKQEAgLTEyNCwyMyArMTM3LDM1IEBAIHN0
YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgICAgIGdvdG8g
ZXJyb3I7CiAgICAgfQogCi0gICAgZnByaW50ZihzdGRvdXQsIiBJRCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8IHN0YXR1c1xuIgotICAgICAgICAgICAgICAgICAgICItLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLVxuIik7Cisg
ICAgZnByaW50ZihzdGRvdXQsIiBJRCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8IHN0YXR1cyAgICAgfCBtZXRhZGF0YVxuIgorICAgICAgICAgICAgICAgICAgICItLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLSstLS0tLS0tLS0t
LS0tLS1cbiIpOwogCiAgICAgZm9yICggaSA9IDA7IGkgPCBkb25lOyBpKysgKQogICAgIHsKKyAg
ICAgICAgdW5zaWduZWQgaW50IGo7CiAgICAgICAgIGNoYXIgKm5hbWVfc3RyID0gbmFtZSArIG5h
bWVfb2ZmOworICAgICAgICBjaGFyICptZXRhZGF0YV9zdHIgPSBtZXRhZGF0YSArIG1ldGFkYXRh
X29mZjsKIAogICAgICAgICBwcmludGYoIiUtNDAuKnN8ICVzIiwgbGVuW2ldLCBuYW1lX3N0ciwg
c3RhdGUyc3RyKGluZm9baV0uc3RhdGUpKTsKICAgICAgICAgaWYgKCBpbmZvW2ldLnJjICkKLSAg
ICAgICAgICAgIHByaW50ZigiICglZCwgJXMpXG4iLCAtaW5mb1tpXS5yYywgc3RyZXJyb3IoLWlu
Zm9baV0ucmMpKTsKKyAgICAgICAgICAgIHByaW50ZigiICglZCwgJXMpICAgIHwgIiwgLWluZm9b
aV0ucmMsIHN0cmVycm9yKC1pbmZvW2ldLnJjKSk7CiAgICAgICAgIGVsc2UKLSAgICAgICAgICAg
IHB1dHMoIiIpOworICAgICAgICAgICAgcHJpbnRmKCIgICAgfCAiKTsKKworICAgICAgICAvKiBS
ZXBsYWNlIGFsbCAnXDAnIHdpdGggc2VtaS1jb2xvbnMuICovCisgICAgICAgIGZvciAoIGogPSAw
OyBtZXRhZGF0YV9sZW5baV0gJiYgaiA8IG1ldGFkYXRhX2xlbltpXSAtIDE7IGorKyApCisgICAg
ICAgICAgICBtZXRhZGF0YV9zdHJbal0gPSAobWV0YWRhdGFfc3RyW2pdID86ICc7Jyk7CisgICAg
ICAgIHByaW50ZigiJS4qc1xuIiwgbWV0YWRhdGFfbGVuW2ldLCBtZXRhZGF0YV9zdHIpOwogCiAg
ICAgICAgIG5hbWVfb2ZmICs9IGxlbltpXTsKKyAgICAgICAgbWV0YWRhdGFfb2ZmICs9IG1ldGFk
YXRhX2xlbltpXTsKICAgICB9CiAKIGVycm9yOgorICAgIGZyZWUobWV0YWRhdGFfbGVuKTsKK2Vy
cm9yX21ldGFkYXRhX2xlbjoKKyAgICBmcmVlKG1ldGFkYXRhKTsKK2Vycm9yX21ldGFkYXRhOgog
ICAgIGZyZWUobGVuKTsKIGVycm9yX2xlbjoKICAgICBmcmVlKG5hbWUpOwpkaWZmIC0tZ2l0IGEv
eGVuL2NvbW1vbi9saXZlcGF0Y2guYyBiL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKaW5kZXggZTgw
MDM4MjQ3OS4uYmRmMmQxZmM2ZCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9saXZlcGF0Y2guYwor
KysgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCkBAIC0xMTY0LDcgKzExNjQsOCBAQCBzdGF0aWMg
aW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0
KQogCiAgICAgaWYgKCBsaXN0LT5uciAmJgogICAgICAgICAgKCFndWVzdF9oYW5kbGVfb2theShs
aXN0LT5zdGF0dXMsIGxpc3QtPm5yKSB8fAotICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShs
aXN0LT5sZW4sIGxpc3QtPm5yKSkgKQorICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShsaXN0
LT5sZW4sIGxpc3QtPm5yKSB8fAorICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShsaXN0LT5t
ZXRhZGF0YV9sZW4sIGxpc3QtPm5yKSkgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAogICAg
IHNwaW5fbG9jaygmcGF5bG9hZF9sb2NrKTsKQEAgLTExNzUsMTMgKzExNzYsMTQgQEAgc3RhdGlj
IGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlz
dCkKICAgICB9CiAKICAgICBsaXN0LT5uYW1lX3RvdGFsX3NpemUgPSAwOworICAgIGxpc3QtPm1l
dGFkYXRhX3RvdGFsX3NpemUgPSAwOwogICAgIGlmICggbGlzdC0+bnIgKQogICAgIHsKLSAgICAg
ICAgdWludDY0X3QgbmFtZV9vZmZzZXQgPSAwOworICAgICAgICB1aW50NjRfdCBuYW1lX29mZnNl
dCA9IDAsIG1ldGFkYXRhX29mZnNldCA9IDA7CiAKICAgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRy
eSggZGF0YSwgJnBheWxvYWRfbGlzdCwgbGlzdCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHVp
bnQzMl90IG5hbWVfbGVuOworICAgICAgICAgICAgdWludDMyX3QgbmFtZV9sZW4sIG1ldGFkYXRh
X2xlbjsKIAogICAgICAgICAgICAgaWYgKCBsaXN0LT5pZHggPiBpKysgKQogICAgICAgICAgICAg
ICAgIGNvbnRpbnVlOwpAQCAtMTE5Miw4ICsxMTk0LDEzIEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNo
X2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAgICAgICAgICAg
ICBuYW1lX2xlbiA9IHN0cmxlbihkYXRhLT5uYW1lKSArIDE7CiAgICAgICAgICAgICBsaXN0LT5u
YW1lX3RvdGFsX3NpemUgKz0gbmFtZV9sZW47CiAKKyAgICAgICAgICAgIG1ldGFkYXRhX2xlbiA9
IGRhdGEtPm1ldGFkYXRhLmxlbjsKKyAgICAgICAgICAgIGxpc3QtPm1ldGFkYXRhX3RvdGFsX3Np
emUgKz0gbWV0YWRhdGFfbGVuOworCiAgICAgICAgICAgICBpZiAoICFndWVzdF9oYW5kbGVfc3Vi
cmFuZ2Vfb2theShsaXN0LT5uYW1lLCBuYW1lX29mZnNldCwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVfb2Zmc2V0ICsgbmFtZV9sZW4gLSAxKSApCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lX29mZnNldCAr
IG5hbWVfbGVuIC0gMSkgfHwKKyAgICAgICAgICAgICAgICAgIWd1ZXN0X2hhbmRsZV9zdWJyYW5n
ZV9va2F5KGxpc3QtPm1ldGFkYXRhLCBtZXRhZGF0YV9vZmZzZXQsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YV9vZmZzZXQgKyBtZXRhZGF0YV9s
ZW4gLSAxKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSAtRUlOVkFMOwog
ICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTIwMyw3ICsxMjEwLDEwIEBAIHN0YXRpYyBpbnQg
bGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAg
ICAgICAgICAgICBpZiAoIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bmFtZSwgbmFtZV9v
ZmZzZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS0+bmFt
ZSwgbmFtZV9sZW4pIHx8CiAgICAgICAgICAgICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChs
aXN0LT5sZW4sIGlkeCwgJm5hbWVfbGVuLCAxKSB8fAotICAgICAgICAgICAgICAgIF9fY29weV90
b19ndWVzdF9vZmZzZXQobGlzdC0+c3RhdHVzLCBpZHgsICZzdGF0dXMsIDEpICkKKyAgICAgICAg
ICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPnN0YXR1cywgaWR4LCAmc3RhdHVz
LCAxKSB8fAorICAgICAgICAgICAgICAgIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bWV0
YWRhdGEsIG1ldGFkYXRhX29mZnNldCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRhdGEtPm1ldGFkYXRhLmRhdGEsIG1ldGFkYXRhX2xlbikgfHwKKyAgICAgICAgICAg
ICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm1ldGFkYXRhX2xlbiwgaWR4LCAmbWV0
YWRhdGFfbGVuLCAxKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSAtRUZB
VUxUOwogICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTIxMSw2ICsxMjIxLDcgQEAgc3RhdGlj
IGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlz
dCkKIAogICAgICAgICAgICAgaWR4Kys7CiAgICAgICAgICAgICBuYW1lX29mZnNldCArPSBuYW1l
X2xlbjsKKyAgICAgICAgICAgIG1ldGFkYXRhX29mZnNldCArPSBtZXRhZGF0YV9sZW47CiAKICAg
ICAgICAgICAgIGlmICggKGlkeCA+PSBsaXN0LT5ucikgfHwgaHlwZXJjYWxsX3ByZWVtcHRfY2hl
Y2soKSApCiAgICAgICAgICAgICAgICAgYnJlYWs7CkBAIC0xMjIxLDYgKzEyMzIsNyBAQCBzdGF0
aWMgaW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICps
aXN0KQogICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KCBkYXRhLCAmcGF5bG9hZF9saXN0LCBs
aXN0ICkKICAgICAgICAgewogICAgICAgICAgICAgbGlzdC0+bmFtZV90b3RhbF9zaXplICs9IHN0
cmxlbihkYXRhLT5uYW1lKSArIDE7CisgICAgICAgICAgICBsaXN0LT5tZXRhZGF0YV90b3RhbF9z
aXplICs9IGRhdGEtPm1ldGFkYXRhLmxlbjsKICAgICAgICAgfQogICAgIH0KICAgICBsaXN0LT5u
ciA9IHBheWxvYWRfY250IC0gaTsgLyogUmVtYWluaW5nIGFtb3VudC4gKi8KZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCBiL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwu
aAppbmRleCA1MDNiZTY4MDU5Li43Nzg2ODY0OTI2IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9w
dWJsaWMvc3lzY3RsLmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oCkBAIC05MjAs
MTYgKzkyMCwxNyBAQCBzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfZ2V0IHsKIH07CiAKIC8q
Ci0gKiBSZXRyaWV2ZSBhbiBhcnJheSBvZiBhYmJyZXZpYXRlZCBzdGF0dXMgYW5kIG5hbWVzIG9m
IHBheWxvYWRzIHRoYXQgYXJlCi0gKiBsb2FkZWQgaW4gdGhlIGh5cGVydmlzb3IuCisgKiBSZXRy
aWV2ZSBhbiBhcnJheSBvZiBhYmJyZXZpYXRlZCBzdGF0dXMsIG5hbWVzIGFuZCBtZXRhZGF0YSBv
ZiBwYXlsb2FkcyB0aGF0CisgKiBhcmUgbG9hZGVkIGluIHRoZSBoeXBlcnZpc29yLgogICoKICAq
IElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBhbiBwb3NpdGl2ZSBudW1iZXIsIGl0IGlzIHRoZSBu
dW1iZXIgKHVwIHRvIGBucmApCiAgKiBvZiB0aGUgcGF5bG9hZHMgcmV0dXJuZWQsIGFsb25nIHdp
dGggYG5yYCB1cGRhdGVkIHdpdGggdGhlIG51bWJlciBvZiByZW1haW5pbmcKICAqIHBheWxvYWRz
LCBgdmVyc2lvbmAgdXBkYXRlZCAoaXQgbWF5IGJlIHRoZSBzYW1lIGFjcm9zcyBoeXBlcmNhbGxz
LiBJZiBpdCB2YXJpZXMKLSAqIHRoZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNv
dWxkIGZhaWwpIGFuZCB0aGUgbmFtZV90b3RhbF9zaXplCi0gKiBjb250YWluaW5nIHRvdGFsIHNp
emUgb2YgdHJhbnNmZXJlZCBkYXRhIGZvciB0aGUgYXJyYXkuCi0gKiBUaGUgYHN0YXR1c2AsIGBu
YW1lYCwgYGxlbmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXggdmFsdWUgKGBp
ZHhgKQotICogd2l0aCB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4KKyAqIHRoZSBkYXRhIGlz
IHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNvdWxkIGZhaWwpLCBgbmFtZV90b3RhbF9zaXplYCBh
bmQKKyAqIGBtZXRhZGF0YV90b3RhbF9zaXplYCBjb250YWluaW5nIHRvdGFsIHNpemVzIG9mIHRy
YW5zZmVyZWQgZGF0YSBmb3IgYm90aCB0aGUKKyAqIGFycmF5cy4KKyAqIFRoZSBgc3RhdHVzYCwg
YG5hbWVgLCBgbGVuYCwgYG1ldGFkYXRhYCBhbmQgYG1ldGFkYXRhX2xlbmAgYXJlIHVwZGF0ZWQg
YXQgdGhlaXIKKyAqIGRlc2lnbmVkIGluZGV4IHZhbHVlIChgaWR4YCkgd2l0aCB0aGUgcmV0dXJu
ZWQgdmFsdWUgb2YgZGF0YS4KICAqCiAgKiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgRTJCSUcg
dGhlIGBucmAgaXMgdG9vIGJpZyBhbmQgc2hvdWxkIGJlCiAgKiBsb3dlcmVkLiBUaGUgdXBwZXIg
bGltaXQgb2YgYG5yYCBpcyBsZWZ0IHRvIHRoZSBpbXBsZW1lbnRpb24uCkBAIC05NTMsNiArOTU0
LDcgQEAgc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgewogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPVVQ6IEhvdyBtYW55IHBheWxvYWRzIGxl
ZnQuICovCiAgICAgdWludDMyX3QgcGFkOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIElO
OiBNdXN0IGJlIHplcm8uICovCiAgICAgdWludDY0X3QgbmFtZV90b3RhbF9zaXplOyAgICAgICAg
ICAgICAgIC8qIE9VVDogVG90YWwgc2l6ZSBvZiBhbGwgdHJhbnNmZXIgbmFtZXMgKi8KKyAgICB1
aW50NjRfdCBtZXRhZGF0YV90b3RhbF9zaXplOyAgICAgICAgICAgLyogT1VUOiBUb3RhbCBzaXpl
IG9mIGFsbCB0cmFuc2ZlciBtZXRhZGF0YSAqLwogICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoeGVu
X2xpdmVwYXRjaF9zdGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBNdXN0IGhhdmUgZW5vdWdoCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYWNlIGFsbG9j
YXRlIGZvciBuciBvZiB0aGVtLiAqLwogICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgbmFt
ZTsgICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIG5hbWVzLiBFYWNoIG1lbWJlcgpAQCAtOTYxLDYg
Kzk2MywxMSBAQCBzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCB7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yIG9mIHRoZW0uICovCiAgICAg
WEVOX0dVRVNUX0hBTkRMRV82NCh1aW50MzIpIGxlbjsgICAgICAgIC8qIE9VVDogQXJyYXkgb2Yg
bGVuZ3RocyBvZiBuYW1lJ3MuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLworICAgIFhFTl9HVUVTVF9IQU5ETEVf
NjQoY2hhcikgbWV0YWRhdGE7ICAgICAvKiBPVVQ6IEFycmF5IG9mIG1ldGFkYXRhIHN0cmluZ3Mu
IEVhY2gKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVt
YmVyIG1heSBoYXZlIGFuIGFyYml0cmFyeSBsZW5ndGguCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLworICAgIFhF
Tl9HVUVTVF9IQU5ETEVfNjQodWludDMyKSBtZXRhZGF0YV9sZW47ICAvKiBPVVQ6IEFycmF5IG9m
IGxlbmd0aHMgb2YgbWV0YWRhdGEncy4KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCiB9OwogCiAvKgotLSAK
Mi4xNi41CgoKCgpBbWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkgR21iSApLcmF1c2Vu
c3RyLiAzOAoxMDExNyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJpc3RpYW4gU2NobGFl
Z2VyLCBSYWxmIEhlcmJyaWNoCkVpbmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5i
dXJnIHVudGVyIEhSQiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3IDg3
OQoKCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVu
LWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6
Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

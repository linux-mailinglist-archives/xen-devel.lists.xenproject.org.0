Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9DF383FD6D6
	for <lists+xen-devel@lfdr.de>; Wed,  1 Sep 2021 11:33:55 +0200 (CEST)
Received: from list by lists.xenproject.org with outflank-mailman.176159.320687 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1mLMcg-0001EO-AH; Wed, 01 Sep 2021 09:33:34 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 176159.320687; Wed, 01 Sep 2021 09:33:34 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1mLMcg-0001Av-4W; Wed, 01 Sep 2021 09:33:34 +0000
Received: by outflank-mailman (input) for mailman id 176159;
 Wed, 01 Sep 2021 09:31:09 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=tzcz=NX=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1mLMaL-00066x-L3
 for xen-devel@lists.xen.org; Wed, 01 Sep 2021 09:31:09 +0000
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 50e6d84a-0b07-11ec-adbd-12813bfff9fa;
 Wed, 01 Sep 2021 09:30:59 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1mLMZy-0006zN-V2; Wed, 01 Sep 2021 09:30:46 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1mLMZy-0006TJ-Rw; Wed, 01 Sep 2021 09:30:46 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: 50e6d84a-0b07-11ec-adbd-12813bfff9fa
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=+rCVNnLKnAbp2uXbXH1bwsbzmEqZNGPyQGmZ8gq+7kE=; b=XVzq51vovCfFiKqUSm6Ks3HKws
	fa7WW4d9ebxm6BNl1z7XocAuZjsDUp3PGUxHPto1K+pgyM7YYj1Q/MivtuVo2QCBsyn41GUVrbVWt
	9krhcgY0GfWpIxXHH9ziFnXtd1cfQL0mmP77a+nu0AzyaXr+SA2LqYsaSjXtmqxgNmtc=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 378 v3 (CVE-2021-28694,CVE-2021-28695,CVE-2021-28696)
 - IOMMU page mapping issues on x86
Message-Id: <E1mLMZy-0006TJ-Rw@xenbits.xenproject.org>
Date: Wed, 01 Sep 2021 09:30:46 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

 Xen Security Advisory CVE-2021-28694,CVE-2021-28695,CVE-2021-28696 / XSA-378
                                   version 3

                   IOMMU page mapping issues on x86

UPDATES IN VERSION 3
====================

Warn about dom0=pvh breakage in Resolution section.

ISSUE DESCRIPTION
=================

Both AMD and Intel allow ACPI tables to specify regions of memory
which should be left untranslated, which typically means these
addresses should pass the translation phase unaltered.  While these
are typically device specific ACPI properties, they can also be
specified to apply to a range of devices, or even all devices.

On all systems with such regions Xen failed to prevent guests from
undoing/replacing such mappings (CVE-2021-28694).

On AMD systems, where a discontinuous range is specified by firmware,
the supposedly-excluded middle range will also be identity-mapped
(CVE-2021-28695).

Further, on AMD systems, upon de-assigment of a physical device from a
guest, the identity mappings would be left in place, allowing a guest
continued access to ranges of memory which it shouldn't have access to
anymore (CVE-2021-28696).

IMPACT
======

The precise impact is system specific, but can - on affected systems -
be any or all of privilege escalation, denial of service, or information
leaks.

VULNERABLE SYSTEMS
==================

The vulnerability is only exploitable by guests granted access to
physical devices (ie, via PCI passthrough).

All versions of Xen are affected.

Only x86 systems with IOMMUs and with firmware specifying memory regions
to be identity mapped are affected.  Other x86 systems are not affected.

Whether a particular system whose ACPI tables declare such memory
region(s) is actually affected cannot be known without knowing when
and/or how these regions are used.  For example, if these regions were
used only during system boot, there would not be any vulnerability.
The necessary knowledge can only be obtained from, collectively, the
hardware and firmware manufacturers.

On Arm hardware IOMMU use is not security supported.  Accordingly, we
have not undertaken an analysis of these issues for Arm systems.

MITIGATION
==========

Not permitting untrusted guests access to phsyical devices will avoid
the vulnerability.

Likewise, limiting untrusted guest access to physical devices whose
firmware-provided ACPI tables declare identity mappings, will avoid
the vulnerability.  (Provided that there are no identity mapped
regions which are specified by the ACPI tables to apply globally.)

Note that a system is still vulnerable if a guest was trusted, while
it had such a device assigned, and then has the device removed in
anticipation of the guest becoming untrusted (because of, for example,
the insertion of an untrusted kernel module),

CREDITS
=======

This issue was discovered by Jan Beulich of SUSE.

RESOLUTION
==========

Applying the appropriate set of attached patches resolves this issue.

However, these patches are known to badly break PVH dom0 support.
Work is ongoing to resolve the problem, and will be committed to the
appropriate Xen trees (including backports) when ready.  PVH dom0 has
"Technical Preview" status so we do not intend to distribute the fixes
via an update to this advisory

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa378/xsa378-?.patch           xen-unstable
xsa378/xsa378-4.15-?.patch      Xen 4.15.x
xsa378/xsa378-4.14-?.patch      Xen 4.14.x
xsa378/xsa378-4.13-*.patch      Xen 4.13.x
xsa378/xsa378-4.12-*.patch      Xen 4.12.x
xsa378/xsa378-4.11-*.patch      Xen 4.11.x

$ sha256sum xsa378* xsa378*/*
b3b49681468bd2be4b95fc1d3861493bbea63bac1c115a12ece76d0313b6a81c  xsa378.meta
2560d4418e6b6d022b4e7fe1f84906ca13b3180537e746ee81cd3f97f0e86c35  xsa378/xsa378-1.patch
134b207c38f8d76bbc218220f1e61f82780e8166818ef51217716023cc27ce3c  xsa378/xsa378-2.patch
c166ef60e08a80440f79d92abe8488b123c8017e7633dbddacb95b20899f9b2b  xsa378/xsa378-3.patch
a2677e157724f57f65165f361a309c417d123ff009168f16d3a0e342b7a601eb  xsa378/xsa378-4.11-0a.patch
832f52f420bb47784bdefd75edd1ca521658327aafb94b4f3586da522d0d19c1  xsa378/xsa378-4.11-0b.patch
9eb7c53892f01424eec6b788f879b36dd75a6f89b1c8b9c973237603525d6546  xsa378/xsa378-4.11-0c.patch
48021fb9a2c52d7939fd11bbba80c67a5a5b6cae2039b4b2a2c6203eb5841260  xsa378/xsa378-4.11-1.patch
4f3fd39aa328c1e397aa2a10b92e98cc341908a8834302a4fc0f230876dd3570  xsa378/xsa378-4.11-2.patch
6e2eeecd2ccc4029f80888263f44b80acf078d69aeffda4d6accd8b2d0899182  xsa378/xsa378-4.11-3.patch
194b27510c8765f1cf8abee57624a075ab26f4f889aa8c201e126643f570f55a  xsa378/xsa378-4.11-4.patch
e8f4eab0984a7db2ca0c6c9ac0fb9107e45ddd572a36454db4a1bdb8b9a8b0c6  xsa378/xsa378-4.11-5.patch
943c7556be47b1a0f2273cf5691fe70dc65e6cb50ff0477d1d61eb3f0ba87a97  xsa378/xsa378-4.11-6.patch
2eb572e1a55caa4aca31f74a3844135a204c4e023a6776d7adc4f4043663fb99  xsa378/xsa378-4.11-7.patch
7c24ba33461d3adcb195a6611df3e9c0501e9dcacf9b8811456450b291d23edf  xsa378/xsa378-4.11-8.patch
fe14ea6699df673b787f93ff821838f2280407674df0c8c06d40efe8320e8748  xsa378/xsa378-4.12-0a.patch
1ba10aef9ea99c4455a34e61792ca65ea6b2ece56f05cd0b4adc14600a7ae346  xsa378/xsa378-4.12-0b.patch
2c2dbc0c18b695c1d2c93e4137228f82b6d21d895c3165a9e29ddea3db78e36a  xsa378/xsa378-4.12-0c.patch
48021fb9a2c52d7939fd11bbba80c67a5a5b6cae2039b4b2a2c6203eb5841260  xsa378/xsa378-4.12-1.patch
f0d62506ccdf081d0efbb553e2d33f17a084272d21f43bf95d11fda2dcc8a3fa  xsa378/xsa378-4.12-2.patch
e266512b18fc30e5bd4884cd720aa81644d3ca3323b38fe1f77d06fa98dd515d  xsa378/xsa378-4.12-3.patch
076f9955593a8ebdea5f24ed302b8a1004bbf50da4c8becf1f93764066b8981c  xsa378/xsa378-4.12-4.patch
9639bc35636ffae4e2b6dd026387347960c1fb986cb2924a18314a72e6b6ec0a  xsa378/xsa378-4.12-5.patch
32dd659aa365d9f8197d99b9334c22b33e9ce805e30376457df6e507f92282c8  xsa378/xsa378-4.12-6.patch
7eaae2fa968eb11e27277141456cc1bd657025aee738221c368e153535c7c0f4  xsa378/xsa378-4.12-7.patch
05982f43f35b580ff41f74b1280e469e0dd20176f184ec04a4874303c2aa3ad1  xsa378/xsa378-4.12-8.patch
c6f551ef9903a343b47692b34a63c70165a2dbf74878a6be6511cdffd55a7e8c  xsa378/xsa378-4.13-0a.patch
223cd63f7e1c39d862b8654da698455ded65ecb5abae0f57c330921522b7fdb4  xsa378/xsa378-4.13-0b.patch
5c33aa24f14e779dfe914e809cff11260083169a3adfb07a31ce11243d80b3ef  xsa378/xsa378-4.13-0c.patch
1d55426ff6a41f0ef4cbd2c943edafff394157703bb0b6ae751564abf93b5ee7  xsa378/xsa378-4.13-1.patch
4d5e7d5e65cd28d6bc7d1a9f2ab24f09dfaef295c4199d5f2db00915dcaa174f  xsa378/xsa378-4.13-2.patch
78df0bcb347f8bb45827f74b191aad36b6e907eb38c6d535035f2b2739645551  xsa378/xsa378-4.13-3.patch
237c33e0ae01a23db01721afb8e6a39101bfe081f8b75dbcff6b9fa9c9aaceda  xsa378/xsa378-4.13-4.patch
7d2f3ae3881d28073be54a6dfb35f13004e4efee742952788430201d86307ecf  xsa378/xsa378-4.13-5.patch
2ecd7580394667db0c41e4819025393e59ae24d6c97d54451c8e683585057367  xsa378/xsa378-4.13-6.patch
592a03d00e5d22d7a3c001681968dc469c70b3e57998b95877388e9528904ea2  xsa378/xsa378-4.13-7.patch
54e6a095f706c66dbbd74e39aa1d88031c9b537589e73ceb2925e2f0cc1854f0  xsa378/xsa378-4.13-8.patch
1d55426ff6a41f0ef4cbd2c943edafff394157703bb0b6ae751564abf93b5ee7  xsa378/xsa378-4.14-1.patch
86fbd88eb8a358575e42cf335c444b047ddb4d2f1c6a1bc6f9e57e6ac0041074  xsa378/xsa378-4.14-2.patch
0a23e5f93ff1bb55f003a56e0ef8c531384b164f0e840f5794acdb9ae3e91996  xsa378/xsa378-4.14-3.patch
e2226f7ddae1d24dbee8cf19efa8d67ebf312f3d10641cb9aec21d68a3c8f818  xsa378/xsa378-4.14-4.patch
f2cf8f7e4aa0460e606b5564adde366332ed323c4d5e3f957e64299ef1bc9baf  xsa378/xsa378-4.14-5.patch
7811426975757e3bb8c6ab3161ba2354e1780b55b9e6be7928229d5f23bf79b6  xsa378/xsa378-4.14-6.patch
58147bd6c0ea4e08e84a17afc796be4bbe53e6fbc1d393f9fe3c6191fd33eba5  xsa378/xsa378-4.14-7.patch
682a011d807a7c284faf0ec9d2cf0aabaddbc658979dea2b9ccbc007b660f9c5  xsa378/xsa378-4.14-8.patch
a00ada0cd673f0909cc7b462cb532dbd6fe17601e06bd84272f5ff1857ea4c73  xsa378/xsa378-4.15-1.patch
d74cc325be1e47d61ba3b1400837af35d044bf1d25806aa98926ec262f80bddd  xsa378/xsa378-4.15-2.patch
2ad685a04dbbdd2c81761b58146e70059b8a8a92b0c1176f36933510293ece5b  xsa378/xsa378-4.15-3.patch
18de9facccd70ce49dd839e219fe71667c43110e474e5d7b56a503a5786fc7e0  xsa378/xsa378-4.15-4.patch
296558b27ba82176f6d06b721102c8ba7c7e6e99d29b29392ea82244e88df0b9  xsa378/xsa378-4.15-5.patch
5d7cc84c66daf0aceab9407fa72f2827024c847f4ca10f8d123eee87b7451aba  xsa378/xsa378-4.15-6.patch
fd4aa4447562230a6684d17e6e4c55f1e48df4773247f66ab9d01181003bc9aa  xsa378/xsa378-4.15-7.patch
5305e3bc513bcd3e016ca3bbecc6cae38c8ed2b2eacb13e82f7b1f4401d3b67d  xsa378/xsa378-4.15-8.patch
78390bf59344ea5dcbfa5831db3634b3f1b3aabf029160c72cdbeeec2b46b2a9  xsa378/xsa378-4.patch
76fb4a1f2604b98d3a803744ad212b3984117ec8c8011ad6db3759f9337a9b5a  xsa378/xsa378-5.patch
a627f8c6b7d2ffac0b6de945189f96b718aeab8e0c8bb11476a40585d6411bd7  xsa378/xsa378-6.patch
28814b51fabd3c5cb3ca249ad291781f589cddd55fc8152fdd5668c5fcdc727c  xsa378/xsa378-7.patch
30e31749ade75fd5ab4c41fa27fe2124bdcc602ccc803a85e5eeec1b9c48a9c1  xsa378/xsa378-8.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmEvSCUMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZrUYH/iYMkjMzUpv5ik/quZ+z34uXwq/mD8x8ROZKXDev
tgojXcFo0vNlcr71R0J5KrE0YeX+3MjbjqbF7A30cnw4/bgmvhzcdP/fwOfIKFYE
JqaGoDaxFRpsIMvHFXV6OxtjgBgleUukaikUrcwWUG+L90KMmjqZU4IAlNcBAALC
J6rDB8nHqD1s+ODIPdPE149jIE7LJfVqyuu9h4r/jmLEDRJBS2YEs6zgClqnIApl
3WBpZNhp8Tk3BFtbQcu4Uh9c0itymtp+8VsY0xzF2bWsE4aoe5DKHv0DyTSLe9Md
pMG0egH7ZrI3MV4nzHdbhkA2Hn3X0rsJiI7TXpmmQPmgi4g=
=A/oT
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa378.meta"
Content-Disposition: attachment; filename="xsa378.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAzNzgsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xNSIsCiAgICAiNC4xNCIsCiAgICAiNC4xMyIs
CiAgICAiNC4xMiIsCiAgICAiNC4xMSIKICBdLAogICJUcmVlcyI6IFsKICAg
ICJ4ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjExIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICJlZjMyYzdhZmEyNzMxYjc1ODIyNmQ2ZTEwYTFlNDg5YjFh
MTVmYzQxIiwKICAgICAgICAgICJQcmVyZXFzIjogW10sCiAgICAgICAgICAi
UGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTM3OC94c2EzNzgtNC4xMS0q
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICI0LjEyIjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICJlYTIwZWVlOTdlOWUwODYx
MTI3YTgwNzBjYzdiOWFlMzU1N2IwOWZiIiwKICAgICAgICAgICJQcmVyZXFz
IjogWwogICAgICAgICAgICAzODMKICAgICAgICAgIF0sCiAgICAgICAgICAi
UGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTM3OC94c2EzNzgtNC4xMi0q
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICI0LjEzIjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICIzMmQ1ODA5MDJiOTU5MDAw
ZDc5ZDUxZGZmMDNhMzU2MDY1M2M0ZmNiIiwKICAgICAgICAgICJQcmVyZXFz
IjogWwogICAgICAgICAgICAzODMKICAgICAgICAgIF0sCiAgICAgICAgICAi
UGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTM3OC94c2EzNzgtNC4xMy0q
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICI0LjE0IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICI0OTI5OWM0ODEzYjc4NDdk
MjlkZjA3YmY3OTBmNTQ4OTA2MGYyYTljIiwKICAgICAgICAgICJQcmVyZXFz
IjogWwogICAgICAgICAgICAzODMKICAgICAgICAgIF0sCiAgICAgICAgICAi
UGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTM3OC94c2EzNzgtNC4xNC0q
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICI0LjE1IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICJkYmE3NzQ4OTZmN2RkNzQ3
NzNjMTRkNTM3NjQzYjdkNzQ3N2ZlZmNkIiwKICAgICAgICAgICJQcmVyZXFz
IjogWwogICAgICAgICAgICAzODMKICAgICAgICAgIF0sCiAgICAgICAgICAi
UGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTM3OC94c2EzNzgtNC4xNS0q
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICJtYXN0ZXIiOiB7CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4
ZW4iOiB7CiAgICAgICAgICAiU3RhYmxlUmVmIjogIjI1ZGE5NDU1ZjFiYjhh
NmQzMzAzOTU3NWE3YjI4YmRmYzRlM2ZjZmUiLAogICAgICAgICAgIlByZXJl
cXMiOiBbCiAgICAgICAgICAgIDM4MwogICAgICAgICAgXSwKICAgICAgICAg
ICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNhMzc4L3hzYTM3OC0/LnBh
dGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0K
fQ==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-1.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZ2xvYmFsIGV4Y2x1c2lvbiByYW5nZSBl
eHRlbmRpbmcKCkJlc2lkZXMgdW5pdHkgbWFwcGluZyByZWdpb25zLCB0aGUg
QU1EIElPTU1VIHNwZWMgYWxzbyBwcm92aWRlcyBmb3IKZXhjbHVzaW9uIHJh
bmdlcyAoYXJlYXMgb2YgbWVtb3J5IG5vdCB0byBiZSBzdWJqZWN0IHRvIERN
QSB0cmFuc2xhdGlvbikKdG8gYmUgc3BlY2lmaWVkIGJ5IGZpcm13YXJlIGlu
IHRoZSBBQ1BJIHRhYmxlcy4gVGhlIHNwZWMgZG9lcyBub3QgcHV0CmFueSBj
b25zdHJhaW50cyBvbiB0aGUgbnVtYmVyIG9mIHN1Y2ggcmVnaW9ucy4KCkJs
aW5kbHkgYXNzdW1pbmcgYWxsIGFkZHJlc3NlcyBiZXR3ZWVuIGFueSB0d28g
c3VjaCByYW5nZXMgc2hvdWxkIGFsc28KYmUgZXhjbHVkZWQgY2FuJ3QgYmUg
cmlnaHQuIFNpbmNlIGhhcmR3YXJlIGhhcyByb29tIGZvciBqdXN0IGEgc2lu
Z2xlCnN1Y2ggcmFuZ2UgKGNvbXByaXNlZCBvZiB0aGUgRXhjbHVzaW9uIEJh
c2UgUmVnaXN0ZXIgYW5kIHRoZSBFeGNsdXNpb24KUmFuZ2UgTGltaXQgUmVn
aXN0ZXIpLCBjb21iaW5lIG9ubHkgYWRqYWNlbnQgb3Igb3ZlcmxhcHBpbmcg
cmVnaW9ucyAoZm9yCm5vdzsgdGhpcyBtYXkgcmVxdWlyZSBmdXJ0aGVyIGFk
anVzdG1lbnQgaW4gY2FzZSB0YWJsZSBlbnRyaWVzIGFyZW4ndApzb3J0ZWQg
YnkgYWRkcmVzcykgd2l0aCBtYXRjaGluZyBleGNsdXNpb25fYWxsb3dfYWxs
IHNldHRpbmdzLiBUaGlzCnJlcXVpcmVzIGJ1YmJsaW5nIHVwIGVycm9yIGlu
ZGljYXRvcnMsIHN1Y2ggdGhhdCBJT01NVSBpbml0IGNhbiBiZQpmYWlsZWQg
d2hlbiBjb25jYXRlbmF0aW9uIHdhc24ndCBwb3NzaWJsZS4KCkZ1cnRoZXJt
b3JlLCBzaW5jZSB0aGUgZXhjbHVzaW9uIHJhbmdlIHNwZWNpZmllZCBpbiBJ
T01NVSByZWdpc3RlcnMKaW1wbGllcyBSL1cgYWNjZXNzLCByZWplY3QgcmVx
dWVzdHMgYXNraW5nIGZvciBsZXNzIHBlcm1pc3Npb25zICh0aGlzCndpbGwg
YmUgYnJvdWdodCBjbG9zZXIgdG8gdGhlIHNwZWMgYnkgYSBzdWJzZXF1ZW50
IGNoYW5nZSkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3OCAvIENWRS0yMDIx
LTI4Njk1LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+Ci0tLQp2ODogQWRkIGNvbW1lbnRzIHRvIHBsYWluIHRydWUvZmFs
c2UgZnVuY3Rpb24gYXJndW1lbnRzLgp2NDogRG9uJ3QgYWNjZXB0IHJlcXVl
c3RzIG5vdCBhbGxvd2luZyBmb3IgYm90aCByZWFkaW5nIGFuZCB3cml0aW5n
LgogICAgRG9uJ3QgYWNjZXB0IG1pc21hdGNoZXMgaW4gdGhlIGV4Y2x1c2lv
bl9hbGxvd19hbGwgc2V0dGluZy4gQ292ZXIKICAgIGZvciB0aGUgZHJvcHBp
bmcgb2YgImNvcnJlY3QgbGltaXQgY2FsY3VsYXRpb24gaW4gSVZNRCBwYXJz
aW5nIi4KdjI6IEFjY2VwdCBvdmVybGFwcGluZyByZWdpb25zIGFzIHdlbGwu
Ci0tLQpUQkQ6IFNob3VsZCB3ZSBhc3N1bWUgcmFuZG9tIG9yZGVyIG9mIGVu
dHJpZXMgcmlnaHQgYXdheT8KVEJEOiBBbmRyZXcgc3VnZ2VzdHMgdGhlcmUg
YXJlIGluZGljYXRpb25zIG9mIG9ubHkgb25lIGdsb2JhbCBleGNsdXNpb24K
ICAgICByYW5nZSBiZWluZyBhbGxvd2VkLCB3aGljaCB3b3VsZCB0aGVuIChw
cmVzdW1hYmx5KSBiZSB0aWVkIHRvCiAgICAgQUNQSV9JVk1EX0VYQ0xVU0lP
Tl9SQU5HRSAoYXMgcGVyIGFib3ZlKS4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtMTE2LDEyICsxMTYs
MjEgQEAgc3RhdGljIHN0cnVjdCBhbWRfaW9tbXUgKiBfX2luaXQgZmluZF9p
bwogICAgIHJldHVybiBOVUxMOwogfQogCi1zdGF0aWMgdm9pZCBfX2luaXQg
cmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoCi0gICAgc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXUsIHVpbnQ2NF90IGJhc2UsIHVpbnQ2NF90IGxpbWl0
KQorc3RhdGljIGludCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25f
cmFuZ2UoCisgICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsIHVpbnQ2NF90
IGJhc2UsIHVpbnQ2NF90IGxpbWl0LAorICAgIGJvb2wgYWxsLCBib29sIGl3
LCBib29sIGlyKQogeworICAgIGlmICggIWlyIHx8ICFpdyApCisgICAgICAg
IHJldHVybiAtRVBFUk07CisKICAgICAvKiBuZWVkIHRvIGV4dGVuZCBleGNs
dXNpb24gcmFuZ2U/ICovCiAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9uX2Vu
YWJsZSApCiAgICAgeworICAgICAgICBpZiAoIGlvbW11LT5leGNsdXNpb25f
bGltaXQgKyBQQUdFX1NJWkUgPCBiYXNlIHx8CisgICAgICAgICAgICAgbGlt
aXQgKyBQQUdFX1NJWkUgPCBpb21tdS0+ZXhjbHVzaW9uX2Jhc2UgfHwKKyAg
ICAgICAgICAgICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCAhPSBhbGwg
KQorICAgICAgICAgICAgcmV0dXJuIC1FQlVTWTsKKwogICAgICAgICBpZiAo
IGlvbW11LT5leGNsdXNpb25fYmFzZSA8IGJhc2UgKQogICAgICAgICAgICAg
YmFzZSA9IGlvbW11LT5leGNsdXNpb25fYmFzZTsKICAgICAgICAgaWYgKCBp
b21tdS0+ZXhjbHVzaW9uX2xpbWl0ID4gbGltaXQgKQpAQCAtMTI5LDE2ICsx
MzgsMTEgQEAgc3RhdGljIHZvaWQgX19pbml0IHJlc2VydmVfaW9tbXVfZXhj
bHVzaQogICAgIH0KIAogICAgIGlvbW11LT5leGNsdXNpb25fZW5hYmxlID0g
SU9NTVVfQ09OVFJPTF9FTkFCTEVEOworICAgIGlvbW11LT5leGNsdXNpb25f
YWxsb3dfYWxsID0gYWxsOwogICAgIGlvbW11LT5leGNsdXNpb25fYmFzZSA9
IGJhc2U7CiAgICAgaW9tbXUtPmV4Y2x1c2lvbl9saW1pdCA9IGxpbWl0Owot
fQogCi1zdGF0aWMgdm9pZCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNp
b25fcmFuZ2VfYWxsKAotICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAot
ICAgIHVuc2lnbmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCkK
LXsKLSAgICByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwg
YmFzZSwgbGltaXQpOwotICAgIGlvbW11LT5leGNsdXNpb25fYWxsb3dfYWxs
ID0gSU9NTVVfQ09OVFJPTF9FTkFCTEVEOworICAgIHJldHVybiAwOwogfQog
CiBzdGF0aWMgdm9pZCBfX2luaXQgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2Rl
dmljZSgKQEAgLTE3Niw2ICsxODAsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgdW5zaWduZWQgbG9uZyByYW5n
ZV90b3AsIGlvbW11X3RvcCwgbGVuZ3RoOwogICAgIHN0cnVjdCBhbWRfaW9t
bXUgKmlvbW11OwogICAgIHVuc2lnbmVkIGludCBiZGY7CisgICAgaW50IHJj
ID0gMDsKIAogICAgIC8qIGlzIHBhcnQgb2YgZXhjbHVzaW9uIHJhbmdlIGlu
c2lkZSBvZiBJT01NVSB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2U/ICovCiAgICAg
Lyogbm90ZTogJ2xpbWl0JyBwYXJhbWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBw
YWdlLWFsaWduZWQgKi8KQEAgLTE5NywxMCArMjAyLDE1IEBAIHN0YXRpYyBp
bnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICBpZiAoIGxp
bWl0ID49IGlvbW11X3RvcCApCiAgICAgewogICAgICAgICBmb3JfZWFjaF9h
bWRfaW9tbXUoIGlvbW11ICkKLSAgICAgICAgICAgIHJlc2VydmVfaW9tbXVf
ZXhjbHVzaW9uX3JhbmdlX2FsbChpb21tdSwgYmFzZSwgbGltaXQpOworICAg
ICAgICB7CisgICAgICAgICAgICByYyA9IHJlc2VydmVfaW9tbXVfZXhjbHVz
aW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwg
Ki8sIGl3LCBpcik7CisgICAgICAgICAgICBpZiAoIHJjICkKKyAgICAgICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgfQogICAgIH0KIAotICAgIHJldHVy
biAwOworICAgIHJldHVybiByYzsKIH0KIAogc3RhdGljIGludCBfX2luaXQg
cmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoCkBAIC0yMTEs
NiArMjIxLDcgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVz
aW9uX3JhbgogICAgIHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90
b3AsIGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdTsKICAg
ICB1MTYgcmVxOworICAgIGludCByYyA9IDA7CiAKICAgICBpb21tdSA9IGZp
bmRfaW9tbXVfZm9yX2RldmljZShzZWcsIGJkZik7CiAgICAgaWYgKCAhaW9t
bXUgKQpAQCAtMjQwLDEyICsyNTEsMTMgQEAgc3RhdGljIGludCBfX2luaXQg
cmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogICAgIC8qIHJlZ2lzdGVyIElPTU1V
IGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyBmb3IgZGV2aWNlICovCiAgICAg
aWYgKCBsaW1pdCA+PSBpb21tdV90b3AgICkKICAgICB7Ci0gICAgICAgIHJl
c2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1p
dCk7CisgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFu
Z2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGZhbHNlIC8qIGFsbCAqLywgaXcsIGly
KTsKICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmR0ZV9hbGxvd19leGNs
dXNpb24gPSB0cnVlOwogICAgICAgICBpdnJzX21hcHBpbmdzW3JlcV0uZHRl
X2FsbG93X2V4Y2x1c2lvbiA9IHRydWU7CiAgICAgfQogCi0gICAgcmV0dXJu
IDA7CisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IF9faW5pdCBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCkBA
IC0yNTUsNiArMjY3LDcgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJf
ZXhjbHVzaW9uX3JhbgogICAgIHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBp
b21tdV90b3AsIGxlbmd0aDsKICAgICB1bnNpZ25lZCBpbnQgYmRmOwogICAg
IHUxNiByZXE7CisgICAgaW50IHJjID0gMDsKIAogICAgIC8qIGlzIHBhcnQg
b2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBvZiBJT01NVSB2aXJ0dWFsIGFk
ZHJlc3Mgc3BhY2U/ICovCiAgICAgLyogbm90ZTogJ2xpbWl0JyBwYXJhbWV0
ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWduZWQgKi8KQEAgLTI4NSw4
ICsyOTgsMTAgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVz
aW9uX3JhbgogCiAgICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJh
bmdlIHNldHRpbmdzICovCiAgICAgaWYgKCBsaW1pdCA+PSBpb21tdV90b3Ag
KQotICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZV9hbGwo
aW9tbXUsIGJhc2UsIGxpbWl0KTsKLSAgICByZXR1cm4gMDsKKyAgICAgICAg
cmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFz
ZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3LCBpcik7CisKKyAgICByZXR1
cm4gcmM7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfZGV2
aWNlX3NlbGVjdCgK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-2.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZGV2aWNlIHVuaXR5IG1hcCBoYW5kbGlu
ZwoKQmxpbmRseSBhc3N1bWluZyBhbGwgYWRkcmVzc2VzIGJldHdlZW4gYW55
IHR3byBzdWNoIHJhbmdlcywgc3BlY2lmaWVkIGJ5CmZpcm13YXJlIGluIHRo
ZSBBQ1BJIHRhYmxlcywgc2hvdWxkIGFsc28gYmUgdW5pdHktbWFwcGVkIGNh
bid0IGJlIHJpZ2h0LgpOb3IgY2FuIGl0IGJlIGNvcnJlY3QgdG8gbWVyZ2Ug
cmFuZ2VzIHdpdGggZGlmZmVyaW5nIHBlcm1pc3Npb25zLiBUcmFjawpyYW5n
ZXMgaW5kaXZpZHVhbGx5OyBkb24ndCBtZXJnZSBhdCBhbGwsIGJ1dCBjaGVj
ayBmb3Igb3ZlcmxhcHMgaW5zdGVhZC4KVGhpcyByZXF1aXJlcyBidWJibGlu
ZyB1cCBlcnJvciBpbmRpY2F0b3JzLCBzdWNoIHRoYXQgSU9NTVUgaW5pdCBj
YW4gYmUKZmFpbGVkIHdoZW4gYWxsb2NhdGlvbiBvZiBhIG5ldyB0cmFja2lu
ZyBzdHJ1Y3Qgd2Fzbid0IHBvc3NpYmxlLCBvciBhbgpvdmVybGFwIHdhcyBk
ZXRlY3RlZC4KCkF0IHRoaXMgb2NjYXNpb24gYWxzbyBzdG9wIGlnbm9yaW5n
CmFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoKSdzIHJldHVy
biB2YWx1ZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4IC8gQ1ZFLTIwMjEt
Mjg2OTUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2Uu
ZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQg
PHBhdWxAeGVuLm9yZz4KLS0tClRCRDogT3ZlcmxhcHBpbmcgcmFuZ2VzIGNv
dWxkIGJlIGRlYWx0IHdpdGggKHdoZW4gdGhleSBzcGVjaWZ5IHRoZSBzYW1l
CiAgICAgcGVybWlzc2lvbnMpIGJ5IHNwbGl0dGluZyB0aGUgcmFuZ2VzIHRv
IG5vbi1vdmVybGFwcGluZyBwaWVjZXMuIFNlZQogICAgICJJT01NVTogZ2Vu
ZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVkIFJNUlIgcmVnaW9u
cyIgYW5kIGl0cwogICAgIHVzZXIgIkFNRC9JT01NVTogcmUtYXJyYW5nZS9j
b21wbGV0ZSByZS1hc3NpZ25tZW50IGhhbmRsaW5nIiBmb3IKICAgICB3aHkg
b3ZlcmxhcHMgY2FuJ3QgYmUgYWNjZXB0ZWQgd2l0aCB0aGUgY2hvc2VuIHRy
YWNraW5nIG1vZGVsLiBCdXQKICAgICB0aGUgYmFzZSBhc3N1bXB0aW9uIGlz
IGFueXdheSBmb3IgZmlybXdhcmUgdG8gbm90IHN1cmZhY2UKICAgICBvdmVy
bGFwcGluZyByYW5nZXMgaW4gdGhlIGZpcnN0IHBsYWNlLgotLS0Kdjg6IEZp
eCBidWlsZCAoZmFpbHVyZSByZXN1bHRlZCBmcm9tIGEgcGllY2Ugb2YgY29k
ZSBsaXZpbmcgaGVyZSB3aGljaAogICAgb25seSBhIGxhdGVyIHBhdGNoIHNo
b3VsZCBhZGQpLiBSZS1iYXNlIG92ZXIgYWRqdXN0bWVudHMgdG8gZWFybGll
cgogICAgcGF0Y2guCnY1OiBEb24ndCBhbGxvdyBvdmVybGFwcyAoZXhjZXB0
IGV4YWN0IG1hdGNoZXMpIGFuZCBkb24ndCBtZXJnZS4KICAgIFJlLWJhc2Uu
CnY0OiBBZGp1c3QgdGl0bGUuIFJlLWJhc2Ugb3ZlciBjaGFuZ2VzIGVhcmxp
ZXIgaW4gdGhlIHNlcmllcy4KdjI6IFJlLWJhc2Ugb3ZlciBYU0EtMzAyLgoK
LS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11LmgKKysr
IGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11LmgKQEAgLTEw
NywyMCArMTA3LDI0IEBAIHN0cnVjdCBhbWRfaW9tbXUgewogICAgIHN0cnVj
dCBsaXN0X2hlYWQgYXRzX2RldmljZXM7CiB9OwogCitzdHJ1Y3QgaXZyc191
bml0eV9tYXAgeworICAgIGJvb2wgcmVhZDoxOworICAgIGJvb2wgd3JpdGU6
MTsKKyAgICBwYWRkcl90IGFkZHI7CisgICAgdW5zaWduZWQgbG9uZyBsZW5n
dGg7CisgICAgc3RydWN0IGl2cnNfdW5pdHlfbWFwICpuZXh0OworfTsKKwog
c3RydWN0IGl2cnNfbWFwcGluZ3MgewogICAgIHVpbnQxNl90IGR0ZV9yZXF1
ZXN0b3JfaWQ7CiAgICAgYm9vbCB2YWxpZDoxOwogICAgIGJvb2wgZHRlX2Fs
bG93X2V4Y2x1c2lvbjoxOwotICAgIGJvb2wgdW5pdHlfbWFwX2VuYWJsZTox
OwotICAgIGJvb2wgd3JpdGVfcGVybWlzc2lvbjoxOwotICAgIGJvb2wgcmVh
ZF9wZXJtaXNzaW9uOjE7CiAKICAgICAvKiBpdmhkIGRldmljZSBkYXRhIHNl
dHRpbmdzICovCiAgICAgdWludDhfdCBkZXZpY2VfZmxhZ3M7CiAKLSAgICB1
bnNpZ25lZCBsb25nIGFkZHJfcmFuZ2Vfc3RhcnQ7Ci0gICAgdW5zaWduZWQg
bG9uZyBhZGRyX3JhbmdlX2xlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdTsKKyAgICBzdHJ1Y3QgaXZyc191bml0eV9tYXAgKnVuaXR5X21h
cDsKIAogICAgIC8qIHBlciBkZXZpY2UgaW50ZXJydXB0IHJlbWFwcGluZyB0
YWJsZSAqLwogICAgIHZvaWQgKmludHJlbWFwX3RhYmxlOwotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfYWNwaS5jCisrKyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3BpLmMKQEAgLTE0
NSwzMiArMTQ1LDQ4IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlc2VydmVfaW9t
bXVfZXhjbHVzaW8KICAgICByZXR1cm4gMDsKIH0KIAotc3RhdGljIHZvaWQg
X19pbml0IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoCi0gICAgdTE2
IHNlZywgdTE2IGJkZiwgdW5zaWduZWQgbG9uZyBiYXNlLAotICAgIHVuc2ln
bmVkIGxvbmcgbGVuZ3RoLCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9f
aW5pdCByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKAorICAgIHVpbnQx
Nl90IHNlZywgdWludDE2X3QgYmRmLCB1bnNpZ25lZCBsb25nIGJhc2UsCisg
ICAgdW5zaWduZWQgbG9uZyBsZW5ndGgsIGJvb2wgaXcsIGJvb2wgaXIpCiB7
CiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBn
ZXRfaXZyc19tYXBwaW5ncyhzZWcpOwotICAgIHVuc2lnbmVkIGxvbmcgb2xk
X3RvcCwgbmV3X3RvcDsKKyAgICBzdHJ1Y3QgaXZyc191bml0eV9tYXAgKnVu
aXR5X21hcCA9IGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXA7CiAKLSAg
ICAvKiBuZWVkIHRvIGV4dGVuZCB1bml0eS1tYXBwZWQgcmFuZ2U/ICovCi0g
ICAgaWYgKCBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwX2VuYWJsZSAp
CisgICAgLyogQ2hlY2sgZm9yIG92ZXJsYXBzLiAqLworICAgIGZvciAoIDsg
dW5pdHlfbWFwOyB1bml0eV9tYXAgPSB1bml0eV9tYXAtPm5leHQgKQogICAg
IHsKLSAgICAgICAgb2xkX3RvcCA9IGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRy
X3JhbmdlX3N0YXJ0ICsKLSAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRm
XS5hZGRyX3JhbmdlX2xlbmd0aDsKLSAgICAgICAgbmV3X3RvcCA9IGJhc2Ug
KyBsZW5ndGg7Ci0gICAgICAgIGlmICggb2xkX3RvcCA+IG5ld190b3AgKQot
ICAgICAgICAgICAgbmV3X3RvcCA9IG9sZF90b3A7Ci0gICAgICAgIGlmICgg
aXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2Vfc3RhcnQgPCBiYXNlICkK
LSAgICAgICAgICAgIGJhc2UgPSBpdnJzX21hcHBpbmdzW2JkZl0uYWRkcl9y
YW5nZV9zdGFydDsKLSAgICAgICAgbGVuZ3RoID0gbmV3X3RvcCAtIGJhc2U7
Ci0gICAgfQotCi0gICAgLyogZXh0ZW5kIHIvdyBwZXJtaXNzaW9tcyBhbmQg
a2VlcCBhZ2dyZWdhdGUgKi8KLSAgICBpdnJzX21hcHBpbmdzW2JkZl0ud3Jp
dGVfcGVybWlzc2lvbiA9IGl3OwotICAgIGl2cnNfbWFwcGluZ3NbYmRmXS5y
ZWFkX3Blcm1pc3Npb24gPSBpcjsKLSAgICBpdnJzX21hcHBpbmdzW2JkZl0u
dW5pdHlfbWFwX2VuYWJsZSA9IHRydWU7Ci0gICAgaXZyc19tYXBwaW5nc1ti
ZGZdLmFkZHJfcmFuZ2Vfc3RhcnQgPSBiYXNlOwotICAgIGl2cnNfbWFwcGlu
Z3NbYmRmXS5hZGRyX3JhbmdlX2xlbmd0aCA9IGxlbmd0aDsKKyAgICAgICAg
LyoKKyAgICAgICAgICogRXhhY3QgbWF0Y2hlcyBhcmUgb2theS4gVGhpcyBj
YW4gaW4gcGFydGljdWxhciBoYXBwZW4gd2hlbgorICAgICAgICAgKiByZWdp
c3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZSgpIGNhbGxzIGhlcmUg
dHdpY2UgZm9yIHRoZQorICAgICAgICAgKiBzYW1lIChzLGIsZCxmKS4KKyAg
ICAgICAgICovCisgICAgICAgIGlmICggYmFzZSA9PSB1bml0eV9tYXAtPmFk
ZHIgJiYgbGVuZ3RoID09IHVuaXR5X21hcC0+bGVuZ3RoICYmCisgICAgICAg
ICAgICAgaXIgPT0gdW5pdHlfbWFwLT5yZWFkICYmIGl3ID09IHVuaXR5X21h
cC0+d3JpdGUgKQorICAgICAgICAgICAgcmV0dXJuIDA7CisKKyAgICAgICAg
aWYgKCB1bml0eV9tYXAtPmFkZHIgKyB1bml0eV9tYXAtPmxlbmd0aCA+IGJh
c2UgJiYKKyAgICAgICAgICAgICBiYXNlICsgbGVuZ3RoID4gdW5pdHlfbWFw
LT5hZGRyICkKKyAgICAgICAgeworICAgICAgICAgICAgQU1EX0lPTU1VX0RF
QlVHKCJJVk1EIEVycm9yOiBvdmVybGFwIFslbHgsJWx4KSB2cyBbJWx4LCVs
eClcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZSwgYmFz
ZSArIGxlbmd0aCwgdW5pdHlfbWFwLT5hZGRyLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuaXR5X21hcC0+YWRkciArIHVuaXR5X21hcC0+bGVu
Z3RoKTsKKyAgICAgICAgICAgIHJldHVybiAtRVBFUk07CisgICAgICAgIH0K
KyAgICB9CisKKyAgICAvKiBQb3B1bGF0ZSBhbmQgaW5zZXJ0IGEgbmV3IHVu
aXR5IG1hcC4gKi8KKyAgICB1bml0eV9tYXAgPSB4bWFsbG9jKHN0cnVjdCBp
dnJzX3VuaXR5X21hcCk7CisgICAgaWYgKCAhdW5pdHlfbWFwICkKKyAgICAg
ICAgcmV0dXJuIC1FTk9NRU07CisKKyAgICB1bml0eV9tYXAtPnJlYWQgPSBp
cjsKKyAgICB1bml0eV9tYXAtPndyaXRlID0gaXc7CisgICAgdW5pdHlfbWFw
LT5hZGRyID0gYmFzZTsKKyAgICB1bml0eV9tYXAtPmxlbmd0aCA9IGxlbmd0
aDsKKyAgICB1bml0eV9tYXAtPm5leHQgPSBpdnJzX21hcHBpbmdzW2JkZl0u
dW5pdHlfbWFwOworICAgIGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXAg
PSB1bml0eV9tYXA7CisKKyAgICByZXR1cm4gMDsKIH0KIAogc3RhdGljIGlu
dCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9hbGxfZGV2
aWNlcygKQEAgLTE5MywxMyArMjA5LDEzIEBAIHN0YXRpYyBpbnQgX19pbml0
IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICAgICAgbGVuZ3RoID0gcmFu
Z2VfdG9wIC0gYmFzZTsKICAgICAgICAgLyogcmVzZXJ2ZSByL3cgdW5pdHkt
bWFwcGVkIHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAqLwogICAgICAgICAv
KiBub3RlOiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNp
b24gcmFuZ2UgKi8KLSAgICAgICAgZm9yICggYmRmID0gMDsgYmRmIDwgaXZy
c19iZGZfZW50cmllczsgYmRmKysgKQotICAgICAgICAgICAgcmVzZXJ2ZV91
bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBp
dywgaXIpOworICAgICAgICBmb3IgKCBiZGYgPSAwOyAhcmMgJiYgYmRmIDwg
aXZyc19iZGZfZW50cmllczsgYmRmKysgKQorICAgICAgICAgICAgcmMgPSBy
ZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywgYmRmLCBiYXNlLCBs
ZW5ndGgsIGl3LCBpcik7CiAgICAgICAgIC8qIHB1c2ggJ2Jhc2UnIGp1c3Qg
b3V0c2lkZSBvZiB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2UgKi8KICAgICAgICAg
YmFzZSA9IGlvbW11X3RvcDsKICAgICB9CiAgICAgLyogcmVnaXN0ZXIgSU9N
TVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzICovCi0gICAgaWYgKCBsaW1p
dCA+PSBpb21tdV90b3AgKQorICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlv
bW11X3RvcCApCiAgICAgewogICAgICAgICBmb3JfZWFjaF9hbWRfaW9tbXUo
IGlvbW11ICkKICAgICAgICAgewpAQCAtMjQxLDE1ICsyNTcsMTUgQEAgc3Rh
dGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogICAgICAg
ICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwogICAgICAgICAvKiByZXNl
cnZlIHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZSAqLwog
ICAgICAgICAvKiBub3RlOiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRo
ZSBleGNsdXNpb24gcmFuZ2UgKi8KLSAgICAgICAgcmVzZXJ2ZV91bml0eV9t
YXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBpdywgaXIp
OwotICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywg
cmVxLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7CisgICAgICAgIHJjID0gcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVu
Z3RoLCBpdywgaXIpID86CisgICAgICAgICAgICAgcmVzZXJ2ZV91bml0eV9t
YXBfZm9yX2RldmljZShzZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLCBpdywgaXIp
OwogCiAgICAgICAgIC8qIHB1c2ggJ2Jhc2UnIGp1c3Qgb3V0c2lkZSBvZiB2
aXJ0dWFsIGFkZHJlc3Mgc3BhY2UgKi8KICAgICAgICAgYmFzZSA9IGlvbW11
X3RvcDsKICAgICB9CiAKICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNp
b24gcmFuZ2Ugc2V0dGluZ3MgZm9yIGRldmljZSAqLwotICAgIGlmICggbGlt
aXQgPj0gaW9tbXVfdG9wICApCisgICAgaWYgKCAhcmMgJiYgbGltaXQgPj0g
aW9tbXVfdG9wICApCiAgICAgewogICAgICAgICByYyA9IHJlc2VydmVfaW9t
bXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAv
KiBhbGwgKi8sIGl3LCBpcik7CkBAIC0yODAsMTUgKzI5NiwxNSBAQCBzdGF0
aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgICAg
IGxlbmd0aCA9IHJhbmdlX3RvcCAtIGJhc2U7CiAgICAgICAgIC8qIHJlc2Vy
dmUgci93IHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZXMg
Ki8KICAgICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBv
ZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIGZvciAoIGJkZiA9
IDA7IGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKKyAgICAgICAg
Zm9yICggYmRmID0gMDsgIXJjICYmIGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7
IGJkZisrICkKICAgICAgICAgewogICAgICAgICAgICAgaWYgKCBpb21tdSA9
PSBmaW5kX2lvbW11X2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRmKSApCiAg
ICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcmVzZXJ2ZV91bml0eV9t
YXBfZm9yX2RldmljZShpb21tdS0+c2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGl3LCBpcik7CiAgICAgICAgICAgICAgICAgcmVxID0gZ2V0X2l2cnNfbWFw
cGluZ3MoaW9tbXUtPnNlZylbYmRmXS5kdGVfcmVxdWVzdG9yX2lkOwotICAg
ICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9t
bXUtPnNlZywgcmVxLCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIpOworICAgICAg
ICAgICAgICAgIHJjID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShp
b21tdS0+c2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGlyKSA/
OgorICAgICAgICAgICAgICAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBfZm9y
X2RldmljZShpb21tdS0+c2VnLCByZXEsIGJhc2UsIGxlbmd0aCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aXcsIGlyKTsKICAgICAgICAgICAgIH0KICAgICAgICAgfQogCkBAIC0yOTcs
NyArMzEzLDcgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVz
aW9uX3JhbgogICAgIH0KIAogICAgIC8qIHJlZ2lzdGVyIElPTU1VIGV4Y2x1
c2lvbiByYW5nZSBzZXR0aW5ncyAqLwotICAgIGlmICggbGltaXQgPj0gaW9t
bXVfdG9wICkKKyAgICBpZiAoICFyYyAmJiBsaW1pdCA+PSBpb21tdV90b3Ag
KQogICAgICAgICByYyA9IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3Jhbmdl
KGlvbW11LCBiYXNlLCBsaW1pdCwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB0cnVlIC8qIGFsbCAqLywgaXcsIGlyKTsK
IAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9p
b21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lf
YW1kX2lvbW11LmMKQEAgLTM4NCwxNSArMzg0LDE3IEBAIHN0YXRpYyBpbnQg
YW1kX2lvbW11X2Fzc2lnbl9kZXZpY2Uoc3RydWMKICAgICBzdHJ1Y3QgaXZy
c19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBpbmdz
KHBkZXYtPnNlZyk7CiAgICAgaW50IGJkZiA9IFBDSV9CREYyKHBkZXYtPmJ1
cywgZGV2Zm4pOwogICAgIGludCByZXFfaWQgPSBnZXRfZG1hX3JlcXVlc3Rv
cl9pZChwZGV2LT5zZWcsIGJkZik7CisgICAgY29uc3Qgc3RydWN0IGl2cnNf
dW5pdHlfbWFwICp1bml0eV9tYXA7CiAKLSAgICBpZiAoIGl2cnNfbWFwcGlu
Z3NbcmVxX2lkXS51bml0eV9tYXBfZW5hYmxlICkKKyAgICBmb3IgKCB1bml0
eV9tYXAgPSBpdnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwOyB1bml0
eV9tYXA7CisgICAgICAgICAgdW5pdHlfbWFwID0gdW5pdHlfbWFwLT5uZXh0
ICkKICAgICB7Ci0gICAgICAgIGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91
bml0eV9tYXAoCi0gICAgICAgICAgICBkLAotICAgICAgICAgICAgaXZyc19t
YXBwaW5nc1tyZXFfaWRdLmFkZHJfcmFuZ2Vfc3RhcnQsCi0gICAgICAgICAg
ICBpdnJzX21hcHBpbmdzW3JlcV9pZF0uYWRkcl9yYW5nZV9sZW5ndGgsCi0g
ICAgICAgICAgICBpdnJzX21hcHBpbmdzW3JlcV9pZF0ud3JpdGVfcGVybWlz
c2lvbiwKLSAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbcmVxX2lkXS5yZWFk
X3Blcm1pc3Npb24pOworICAgICAgICBpbnQgcmMgPSBhbWRfaW9tbXVfcmVz
ZXJ2ZV9kb21haW5fdW5pdHlfbWFwKAorICAgICAgICAgICAgICAgICAgICAg
ZCwgdW5pdHlfbWFwLT5hZGRyLCB1bml0eV9tYXAtPmxlbmd0aCwKKyAgICAg
ICAgICAgICAgICAgICAgIHVuaXR5X21hcC0+d3JpdGUsIHVuaXR5X21hcC0+
cmVhZCk7CisKKyAgICAgICAgaWYgKCByYyApCisgICAgICAgICAgICByZXR1
cm4gcmM7CiAgICAgfQogCiAgICAgcmV0dXJuIHJlYXNzaWduX2RldmljZShw
ZGV2LT5kb21haW4sIGQsIGRldmZuLCBwZGV2KTsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-3.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogYWxzbyBwYXNzIHAybV9hY2Nlc3NfdCB0byBwMm1fZ2V0X2lv
bW11X2ZsYWdzKCkKCkEgc3Vic2VxdWVudCBjaGFuZ2Ugd2lsbCB3YW50IHRv
IGN1c3RvbWl6ZSB0aGUgSU9NTVUgcGVybWlzc2lvbnMgYmFzZWQKb24gdGhp
cy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+Ci0tLQp2NTogTmV3LgoKLS0t
IGEveGVuL2FyY2gveDg2L21tL3AybS1lcHQuYworKysgYi94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCkBAIC04MDgsNyArODA4LDcgQEAgZXB0X3NldF9l
bnRyeShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCBnZgogICAgIGJvb2xfdCBl
bnRyeV93cml0dGVuID0gMDsKICAgICBib29sX3QgbmVlZF9tb2RpZnlfdnRk
X3RhYmxlID0gMTsKICAgICBib29sX3QgdnRkX3B0ZV9wcmVzZW50ID0gMDsK
LSAgICB1bnNpZ25lZCBpbnQgaW9tbXVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11
X2ZsYWdzKHAybXQsIG1mbik7CisgICAgdW5zaWduZWQgaW50IGlvbW11X2Zs
YWdzID0gcDJtX2dldF9pb21tdV9mbGFncyhwMm10LCBwMm1hLCBtZm4pOwog
ICAgIGJvb2xfdCBuZWVkc19zeW5jID0gMTsKICAgICBlcHRfZW50cnlfdCBv
bGRfZW50cnkgPSB7IC5lcHRlID0gMCB9OwogICAgIGVwdF9lbnRyeV90IG5l
d19lbnRyeSA9IHsgLmVwdGUgPSAwIH07CkBAIC05MzgsOCArOTM4LDggQEAg
ZXB0X3NldF9lbnRyeShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCBnZgogCiAg
ICAgICAgIC8qIFNhZmUgdG8gcmVhZC10aGVuLXdyaXRlIGJlY2F1c2Ugd2Ug
aG9sZCB0aGUgcDJtIGxvY2sgKi8KICAgICAgICAgaWYgKCBlcHRfZW50cnkt
Pm1mbiA9PSBuZXdfZW50cnkubWZuICYmCi0gICAgICAgICAgICAgcDJtX2dl
dF9pb21tdV9mbGFncyhlcHRfZW50cnktPnNhX3AybXQsIF9tZm4oZXB0X2Vu
dHJ5LT5tZm4pKSA9PQotICAgICAgICAgICAgIGlvbW11X2ZsYWdzICkKKyAg
ICAgICAgICAgICBwMm1fZ2V0X2lvbW11X2ZsYWdzKGVwdF9lbnRyeS0+c2Ff
cDJtdCwgZXB0X2VudHJ5LT5hY2Nlc3MsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBfbWZuKGVwdF9lbnRyeS0+bWZuKSkgPT0gaW9tbXVf
ZmxhZ3MgKQogICAgICAgICAgICAgbmVlZF9tb2RpZnlfdnRkX3RhYmxlID0g
MDsKIAogICAgICAgICBlcHRfcDJtX3R5cGVfdG9fZmxhZ3MocDJtLCAmbmV3
X2VudHJ5KTsKLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS1wdC5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9tbS9wMm0tcHQuYwpAQCAtNTQ1LDYgKzU0NSwxNiBA
QCBpbnQgcDJtX3B0X2hhbmRsZV9kZWZlcnJlZF9jaGFuZ2VzKHVpbnQ2CiAg
ICAgcmV0dXJuIHJjOwogfQogCisvKiBSZWNvbnN0cnVjdCBhIGZha2UgcDJt
X2FjY2Vzc190IGZyb20gc3RvcmVkIFBURSBmbGFncy4gKi8KK3N0YXRpYyBw
Mm1fYWNjZXNzX3QgcDJtX2ZsYWdzX3RvX2FjY2Vzcyh1bnNpZ25lZCBpbnQg
ZmxhZ3MpCit7CisgICAgaWYgKCBmbGFncyAmIF9QQUdFX1BSRVNFTlQgKQor
ICAgICAgICByZXR1cm4gcDJtX2FjY2Vzc19uOworCisgICAgLyogTm8gbmVl
ZCB0byBsb29rIGF0IF9QQUdFX05YIGZvciBub3cuICovCisgICAgcmV0dXJu
IGZsYWdzICYgX1BBR0VfUlcgPyBwMm1fYWNjZXNzX3J3IDogcDJtX2FjY2Vz
c19yOworfQorCiAvKiBDaGVja3Mgb25seSBhcHBsaWNhYmxlIHRvIGVudHJp
ZXMgd2l0aCBvcmRlciA+IFBBR0VfT1JERVJfNEsgKi8KIHN0YXRpYyB2b2lk
IGNoZWNrX2VudHJ5KG1mbl90IG1mbiwgcDJtX3R5cGVfdCBuZXcsIHAybV90
eXBlX3Qgb2xkLAogICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IG9yZGVyKQpAQCAtNTc5LDcgKzU4OSw3IEBAIHAybV9wdF9zZXRfZW50
cnkoc3RydWN0IHAybV9kb21haW4gKnAybSwKICAgICBsMl9wZ2VudHJ5X3Qg
bDJlX2NvbnRlbnQ7CiAgICAgbDNfcGdlbnRyeV90IGwzZV9jb250ZW50Owog
ICAgIGludCByYzsKLSAgICB1bnNpZ25lZCBpbnQgaW9tbXVfcHRlX2ZsYWdz
ID0gcDJtX2dldF9pb21tdV9mbGFncyhwMm10LCBtZm4pOworICAgIHVuc2ln
bmVkIGludCBpb21tdV9wdGVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdz
KHAybXQsIHAybWEsIG1mbik7CiAgICAgLyoKICAgICAgKiBvbGRfbWZuIGFu
ZCBpb21tdV9vbGRfZmxhZ3MgY29udHJvbCBwb3NzaWJsZSBmbHVzaC91cGRh
dGUgbmVlZHMgb24gdGhlCiAgICAgICogSU9NTVU6IFdlIG5lZWQgdG8gZmx1
c2ggd2hlbiBNRk4gb3IgZmxhZ3MgKGkuZS4gcGVybWlzc2lvbnMpIGNoYW5n
ZS4KQEAgLTY0Miw2ICs2NTIsNyBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVj
dCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgb2xkX21mbiA9
IGwxZV9nZXRfcGZuKCpwMm1fZW50cnkpOwogICAgICAgICAgICAgICAgIGlv
bW11X29sZF9mbGFncyA9CiAgICAgICAgICAgICAgICAgICAgIHAybV9nZXRf
aW9tbXVfZmxhZ3MocDJtX2ZsYWdzX3RvX3R5cGUoZmxhZ3MpLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9mbGFnc190
b19hY2Nlc3MoZmxhZ3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIF9tZm4ob2xkX21mbikpOwogICAgICAgICAgICAgfQog
ICAgICAgICAgICAgZWxzZQpAQCAtNjg0LDkgKzY5NSwxMCBAQCBwMm1fcHRf
c2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIDAsIEwxX1BBR0VUQUJMRV9FTlRS
SUVTKTsKICAgICAgICAgQVNTRVJUKHAybV9lbnRyeSk7CiAgICAgICAgIG9s
ZF9tZm4gPSBsMWVfZ2V0X3BmbigqcDJtX2VudHJ5KTsKKyAgICAgICAgZmxh
Z3MgPSBsMWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkpOwogICAgICAgICBpb21t
dV9vbGRfZmxhZ3MgPQotICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFn
cyhwMm1fZmxhZ3NfdG9fdHlwZShsMWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkp
KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21mbihvbGRf
bWZuKSk7CisgICAgICAgICAgICBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV9m
bGFnc190b190eXBlKGZsYWdzKSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyksIF9tZm4ob2xk
X21mbikpOwogCiAgICAgICAgIGlmICggbWZuX3ZhbGlkKG1mbikgfHwgcDJt
X2FsbG93c19pbnZhbGlkX21mbihwMm10KSApCiAgICAgICAgICAgICBlbnRy
eV9jb250ZW50ID0gcDJtX2wxZV9mcm9tX3BmbihtZm5feChtZm4pLApAQCAt
NzE0LDYgKzcyNiw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9k
b21haW4gKnAybSwKICAgICAgICAgICAgICAgICBvbGRfbWZuID0gbDFlX2dl
dF9wZm4oKnAybV9lbnRyeSk7CiAgICAgICAgICAgICAgICAgaW9tbXVfb2xk
X2ZsYWdzID0KICAgICAgICAgICAgICAgICAgICAgcDJtX2dldF9pb21tdV9m
bGFncyhwMm1fZmxhZ3NfdG9fdHlwZShmbGFncyksCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2ZsYWdzX3RvX2FjY2Vz
cyhmbGFncyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgX21mbihvbGRfbWZuKSk7CiAgICAgICAgICAgICB9CiAgICAgICAg
ICAgICBlbHNlCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysr
IGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wMm0uaApAQCAtODkxLDcgKzg5MSw4
IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBwMm1fYWx0cDJtX2NoZWNrKHN0cnUK
IC8qCiAgKiBwMm0gdHlwZSB0byBJT01NVSBmbGFncwogICovCi1zdGF0aWMg
aW5saW5lIHVuc2lnbmVkIGludCBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV90
eXBlX3QgcDJtdCwgbWZuX3QgbWZuKQorc3RhdGljIGlubGluZSB1bnNpZ25l
ZCBpbnQgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fdHlwZV90IHAybXQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHAybV9hY2Nlc3NfdCBwMm1hLCBtZm5fdCBtZm4pCiB7CiAgICAgdW5zaWdu
ZWQgaW50IGZsYWdzOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-0a.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-0a.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBmaXggUG9EIGFjY291bnRpbmcgaW4gZ3Vlc3RfcGh5c21h
cF9hZGRfZW50cnkoKQoKVGhlIGluaXRpYWwgb2JzZXJ2YXRpb24gd2FzIHRo
YXQgdGhlIG1mbl92YWxpZCgpIGNoZWNrIGNvbWVzIHRvbyBsYXRlOgpOZWl0
aGVyIG1mbl9hZGQoKSBub3IgbWZuX3RvX3BhZ2UoKSAobGV0IGFsb25lIGRl
LXJlZmVyZW5jaW5nIHRoZQpyZXN1bHQgb2YgdGhlIGxhdHRlcikgYXJlIHZh
bGlkIGZvciBNRk5zIGZhaWxpbmcgdGhpcyBjaGVjay4gTW92ZSBpdCB1cAph
bmQgLSBub3RpY2luZyB0aGF0IHRoZXJlJ3Mgbm8gY2FsbGVyIGRvaW5nIHNv
IC0gYWxzbyBhZGQgYW4gYXNzZXJ0aW9uCnRoYXQgdGhpcyBzaG91bGQgbmV2
ZXIgcHJvZHVjZSAiZmFsc2UiIGhlcmUuCgpJbiB0dXJuIHRoaXMgd291bGQg
aGF2ZSBtZWFudCB0aGF0IHRoZSAiZWxzZSIgdG8gdGhhdCBpZigpIGNvdWxk
IG5vdyBnbwphd2F5LCB3aGljaCBkaWRuJ3Qgc2VlbSByaWdodCBhdCBhbGwu
IEFuZCBpbmRlZWQsIGNvbnNpZGVyaW5nIGNhbGxlcnMKbGlrZSBtZW1vcnlf
ZXhjaGFuZ2UoKSBvciB2YXJpb3VzIGdyYW50IHRhYmxlIGZ1bmN0aW9ucywg
dGhlIFBvRAphY2NvdW50aW5nIHNob3VsZCBoYXZlIGJlZW4gb3V0c2lkZSBv
ZiB0aGF0IGlmKCkgZnJvbSB0aGUgdmVyeQpiZWdpbm5pbmcuCgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkFja2Vk
LWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29t
PgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9tbS9wMm0uYwpAQCAtNzk0LDYgKzc5NCwxMiBAQCBndWVzdF9waHlz
bWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpkCiAgICAgaWYgKCBwMm1f
aXNfZm9yZWlnbih0KSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCisg
ICAgaWYgKCAhbWZuX3ZhbGlkKG1mbikgKQorICAgIHsKKyAgICAgICAgQVNT
RVJUX1VOUkVBQ0hBQkxFKCk7CisgICAgICAgIHJldHVybiAtRUlOVkFMOwor
ICAgIH0KKwogICAgIHAybV9sb2NrKHAybSk7CiAKICAgICBQMk1fREVCVUco
ImFkZGluZyBnZm49JSNseCBtZm49JSNseFxuIiwgZ2ZuX3goZ2ZuKSwgbWZu
X3gobWZuKSk7CkBAIC04OTQsMTIgKzkwMCwxMyBAQCBndWVzdF9waHlzbWFw
X2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpkCiAgICAgfQogCiAgICAgLyog
Tm93LCBhY3R1YWxseSBkbyB0aGUgdHdvLXdheSBtYXBwaW5nICovCi0gICAg
aWYgKCBtZm5fdmFsaWQobWZuKSApCisgICAgcmMgPSBwMm1fc2V0X2VudHJ5
KHAybSwgZ2ZuLCBtZm4sIHBhZ2Vfb3JkZXIsIHQsIHAybS0+ZGVmYXVsdF9h
Y2Nlc3MpOworICAgIGlmICggcmMgPT0gMCApCiAgICAgewotICAgICAgICBy
YyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwgcGFnZV9vcmRlciwg
dCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybS0+ZGVmYXVsdF9h
Y2Nlc3MpOwotICAgICAgICBpZiAoIHJjICkKLSAgICAgICAgICAgIGdvdG8g
b3V0OyAvKiBGYWlsZWQgdG8gdXBkYXRlIHAybSwgYmFpbCB3aXRob3V0IHVw
ZGF0aW5nIG0ycC4gKi8KKyAgICAgICAgcG9kX2xvY2socDJtKTsKKyAgICAg
ICAgcDJtLT5wb2QuZW50cnlfY291bnQgLT0gcG9kX2NvdW50OworICAgICAg
ICBCVUdfT04ocDJtLT5wb2QuZW50cnlfY291bnQgPCAwKTsKKyAgICAgICAg
cG9kX3VubG9jayhwMm0pOwogCiAgICAgICAgIGlmICggIXAybV9pc19ncmFu
dCh0KSApCiAgICAgICAgIHsKQEAgLTkwOCwyMiArOTE1LDcgQEAgZ3Vlc3Rf
cGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAqZAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGdmbl94KGdmbl9hZGQoZ2ZuLCBp
KSkpOwogICAgICAgICB9CiAgICAgfQotICAgIGVsc2UKLSAgICB7Ci0gICAg
ICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiQWRkaW5nIGJhZCBtZm4g
dG8gcDJtIG1hcCAoJSNseCAtPiAlI2x4KVxuIiwKLSAgICAgICAgICAgICAg
ICAgZ2ZuX3goZ2ZuKSwgbWZuX3gobWZuKSk7Ci0gICAgICAgIHJjID0gcDJt
X3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4sIHBhZ2Vfb3JkZXIs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1faW52YWxpZCwgcDJt
LT5kZWZhdWx0X2FjY2Vzcyk7Ci0gICAgICAgIGlmICggcmMgPT0gMCApCi0g
ICAgICAgIHsKLSAgICAgICAgICAgIHBvZF9sb2NrKHAybSk7Ci0gICAgICAg
ICAgICBwMm0tPnBvZC5lbnRyeV9jb3VudCAtPSBwb2RfY291bnQ7Ci0gICAg
ICAgICAgICBCVUdfT04ocDJtLT5wb2QuZW50cnlfY291bnQgPCAwKTsKLSAg
ICAgICAgICAgIHBvZF91bmxvY2socDJtKTsKLSAgICAgICAgfQotICAgIH0K
IAotb3V0OgogICAgIHAybV91bmxvY2socDJtKTsKIAogICAgIHJldHVybiBy
YzsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-0b.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-0b.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBkb24ndCBpZ25vcmUgcDJtX3JlbW92ZV9wYWdlKCkncyBy
ZXR1cm4gdmFsdWUKCkl0J3Mgbm90IHZlcnkgbmljZSB0byByZXR1cm4gZnJv
bSBndWVzdF9waHlzbWFwX2FkZF9lbnRyeSgpIGFmdGVyCnBlcmhhcHMgYWxy
ZWFkeSBoYXZpbmcgbWFkZSBzb21lIGNoYW5nZXMgdG8gdGhlIFAyTSwgYnV0
IHRoaXMgaXMgcHJlLQpleGlzdGluZyBwcmFjdGljZSBpbiB0aGUgZnVuY3Rp
b24sIGFuZCBpbW8gYmV0dGVyIHRoYW4gaWdub3JpbmcgZXJyb3JzLgoKVGFr
ZSB0aGUgbGliZXJ0eSBhbmQgcmVwbGFjZSBhbiBtZm5fYWRkKCkgaW5zdGFu
Y2Ugd2l0aCBhIGxvY2FsIHZhcmlhYmxlCmFscmVhZHkgaG9sZGluZyB0aGUg
cmVzdWx0IChhcyBwcm92ZW4gYnkgdGhlIGNoZWNrIGltbWVkaWF0ZWx5IGFo
ZWFkKS4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBz
dXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJy
YW50QGNpdHJpeC5jb20+CkFja2VkLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRy
ZXcuY29vcGVyM0BjaXRyaXguY29tPgoKLS0tIGEveGVuL2FyY2gveDg2L21t
L3AybS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtNzAyLDgg
KzcwMiw3IEBAIHZvaWQgcDJtX2ZpbmFsX3RlYXJkb3duKHN0cnVjdCBkb21h
aW4gKmQKICAgICBwMm1fdGVhcmRvd25faG9zdHAybShkKTsKIH0KIAotCi1z
dGF0aWMgaW50CitzdGF0aWMgaW50IF9fbXVzdF9jaGVjawogcDJtX3JlbW92
ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcg
Z2ZuX2wsIHVuc2lnbmVkIGxvbmcgbWZuLAogICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBwYWdlX29yZGVyKQogewpAQCAtODkyLDkgKzg5MSw5IEBA
IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAg
ICAgICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKG9tZm4pKTsKICAgICAg
ICAgICAgICAgICBQMk1fREVCVUcoIm9sZCBnZm49JSNseCAtPiBtZm4gJSNs
eFxuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZuX3gob2dmbikg
LCBtZm5feChvbWZuKSk7Ci0gICAgICAgICAgICAgICAgaWYgKCBtZm5fZXEo
b21mbiwgbWZuX2FkZChtZm4sIGkpKSApCi0gICAgICAgICAgICAgICAgICAg
IHAybV9yZW1vdmVfcGFnZShwMm0sIGdmbl94KG9nZm4pLCBtZm5feChtZm5f
YWRkKG1mbiwgaSkpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgMCk7CisgICAgICAgICAgICAgICAgaWYgKCBtZm5fZXEob21mbiwg
bWZuX2FkZChtZm4sIGkpKSAmJgorICAgICAgICAgICAgICAgICAgICAgKHJj
ID0gcDJtX3JlbW92ZV9wYWdlKHAybSwgZ2ZuX3gob2dmbiksIG1mbl94KG9t
Zm4pLCAwKSkgKQorICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKICAg
ICAgICAgICAgIH0KICAgICAgICAgfQogICAgIH0KQEAgLTkxNiw2ICs5MTUs
NyBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpk
CiAgICAgICAgIH0KICAgICB9CiAKKyBvdXQ6CiAgICAgcDJtX3VubG9jayhw
Mm0pOwogCiAgICAgcmV0dXJuIHJjOwpAQCAtMjM4NSw5ICsyMzg1LDkgQEAg
aW50IHAybV9jaGFuZ2VfYWx0cDJtX2dmbihzdHJ1Y3QgZG9tYWluCiAKICAg
ICBpZiAoIGdmbl9lcShuZXdfZ2ZuLCBJTlZBTElEX0dGTikgKQogICAgIHsK
LSAgICAgICAgaWYgKCBtZm5fdmFsaWQobWZuKSApCi0gICAgICAgICAgICBw
Mm1fcmVtb3ZlX3BhZ2UoYXAybSwgZ2ZuX3gob2xkX2dmbiksIG1mbl94KG1m
biksIFBBR0VfT1JERVJfNEspOwotICAgICAgICByYyA9IDA7CisgICAgICAg
IHJjID0gbWZuX3ZhbGlkKG1mbikKKyAgICAgICAgICAgICA/IHAybV9yZW1v
dmVfcGFnZShhcDJtLCBnZm5feChvbGRfZ2ZuKSwgbWZuX3gobWZuKSwgUEFH
RV9PUkRFUl80SykKKyAgICAgICAgICAgICA6IDA7CiAgICAgICAgIGdvdG8g
b3V0OwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-0c.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-0c.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBkb24ndCBhc3NlcnQgdGhhdCB0aGUgcGFzc2VkIGluIE1G
TiBtYXRjaGVzIGZvciBhIHJlbW92ZQoKZ3Vlc3RfcGh5c21hcF9yZW1vdmVf
cGFnZSgpIGdldHMgaGFuZGVkIGFuIE1GTiBmcm9tIHRoZSBvdXRzaWRlLCB5
ZXQKdGFrZXMgdGhlIG5lY2Vzc2FyeSBsb2NrIHRvIHByZXZlbnQgZnVydGhl
ciBjaGFuZ2VzIHRvIHRoZSBHRk4gPC0+IE1GTgptYXBwaW5nIGl0c2VsZi4g
V2hpbGUgc29tZSBjYWxsZXJzLCBpbiBwYXJ0aWN1bGFyIGd1ZXN0X3JlbW92
ZV9wYWdlKCkKKGJ5IHdheSBvZiBoYXZpbmcgY2FsbGVkIGdldF9nZm5fcXVl
cnkoKSksIGhvbGQgdGhlIEdGTiBsb2NrIGFscmVhZHksCnZhcmlvdXMgb3Ro
ZXJzIChtb3N0IG5vdGFibHkgcGVyaGFwcyB0aGUgMm5kIGluc3RhbmNlIGlu
Cnhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUoKSkgZG9uJ3QuIFdoaWxlIGl0
IGFsc28gaXMgYW4gb3B0aW9uIHRvIGZpeAphbGwgdGhlIGNhbGxlcnMsIGRl
YWwgd2l0aCB0aGUgaXNzdWUgaW4gcDJtX3JlbW92ZV9wYWdlKCkgaW5zdGVh
ZDoKUmVwbGFjZSB0aGUgQVNTRVJUKCkgYnkgYSBjb25kaXRpb25hbCBhbmQg
c3BsaXQgdGhlIGxvb3AgaW50byB0d28sIHN1Y2gKdGhhdCBhbGwgY2hlY2tp
bmcgZ2V0cyBkb25lIGJlZm9yZSBhbnkgbW9kaWZpY2F0aW9uIHdvdWxkIG9j
Y3VyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJh
bnRAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYvbW0v
cDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC03MDgsNyAr
NzA4LDYgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpw
Mm0sCiB7CiAgICAgdW5zaWduZWQgbG9uZyBpOwogICAgIGdmbl90IGdmbiA9
IF9nZm4oZ2ZuX2wpOwotICAgIG1mbl90IG1mbl9yZXR1cm47CiAgICAgcDJt
X3R5cGVfdCB0OwogICAgIHAybV9hY2Nlc3NfdCBhOwogCkBAIC03MTksMTUg
KzcxOCwyNiBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9kb21haW4g
KnAybSwKICAgICBBU1NFUlQoZ2ZuX2xvY2tlZF9ieV9tZShwMm0sIGdmbikp
OwogICAgIFAyTV9ERUJVRygicmVtb3ZpbmcgZ2ZuPSUjbHggbWZuPSUjbHhc
biIsIGdmbl9sLCBtZm4pOwogCisgICAgZm9yICggaSA9IDA7IGkgPCAoMVVM
IDw8IHBhZ2Vfb3JkZXIpOyApCisgICAgeworICAgICAgICB1bnNpZ25lZCBp
bnQgY3VyX29yZGVyOworICAgICAgICBtZm5fdCBtZm5fcmV0dXJuID0gcDJt
LT5nZXRfZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZj
dXJfb3JkZXIsIE5VTEwpOworCisgICAgICAgIGlmICggcDJtX2lzX3ZhbGlk
KHQpICYmCisgICAgICAgICAgICAgKCFtZm5fdmFsaWQoX21mbihtZm4pKSB8
fCBtZm4gKyBpICE9IG1mbl94KG1mbl9yZXR1cm4pKSApCisgICAgICAgICAg
ICByZXR1cm4gLUVJTFNFUTsKKworICAgICAgICBpICs9ICgxVUwgPDwgY3Vy
X29yZGVyKSAtICgoZ2ZuX2wgKyBpKSAmICgoMVVMIDw8IGN1cl9vcmRlcikg
LSAxKSk7CisgICAgfQorCiAgICAgaWYgKCBtZm5fdmFsaWQoX21mbihtZm4p
KSApCiAgICAgewogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwg
cGFnZV9vcmRlcik7IGkrKyApCiAgICAgICAgIHsKLSAgICAgICAgICAgIG1m
bl9yZXR1cm4gPSBwMm0tPmdldF9lbnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBp
KSwgJnQsICZhLCAwLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE5VTEwsIE5VTEwpOworICAgICAgICAgICAgcDJtLT5nZXRf
ZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwgTlVMTCwg
TlVMTCk7CiAgICAgICAgICAgICBpZiAoICFwMm1faXNfZ3JhbnQodCkgJiYg
IXAybV9pc19zaGFyZWQodCkgJiYgIXAybV9pc19mb3JlaWduKHQpICkKICAg
ICAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm4raSwgSU5WQUxJ
RF9NMlBfRU5UUlkpOwotICAgICAgICAgICAgQVNTRVJUKCAhcDJtX2lzX3Zh
bGlkKHQpIHx8IG1mbiArIGkgPT0gbWZuX3gobWZuX3JldHVybikgKTsKICAg
ICAgICAgfQogICAgIH0KICAgICByZXR1cm4gcDJtX3NldF9lbnRyeShwMm0s
IGdmbiwgSU5WQUxJRF9NRk4sIHBhZ2Vfb3JkZXIsIHAybV9pbnZhbGlkLAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-1.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZ2xvYmFsIGV4Y2x1c2lvbiByYW5nZSBl
eHRlbmRpbmcKCkJlc2lkZXMgdW5pdHkgbWFwcGluZyByZWdpb25zLCB0aGUg
QU1EIElPTU1VIHNwZWMgYWxzbyBwcm92aWRlcyBmb3IKZXhjbHVzaW9uIHJh
bmdlcyAoYXJlYXMgb2YgbWVtb3J5IG5vdCB0byBiZSBzdWJqZWN0IHRvIERN
QSB0cmFuc2xhdGlvbikKdG8gYmUgc3BlY2lmaWVkIGJ5IGZpcm13YXJlIGlu
IHRoZSBBQ1BJIHRhYmxlcy4gVGhlIHNwZWMgZG9lcyBub3QgcHV0CmFueSBj
b25zdHJhaW50cyBvbiB0aGUgbnVtYmVyIG9mIHN1Y2ggcmVnaW9ucy4KCkJs
aW5kbHkgYXNzdW1pbmcgYWxsIGFkZHJlc3NlcyBiZXR3ZWVuIGFueSB0d28g
c3VjaCByYW5nZXMgc2hvdWxkIGFsc28KYmUgZXhjbHVkZWQgY2FuJ3QgYmUg
cmlnaHQuIFNpbmNlIGhhcmR3YXJlIGhhcyByb29tIGZvciBqdXN0IGEgc2lu
Z2xlCnN1Y2ggcmFuZ2UgKGNvbXByaXNlZCBvZiB0aGUgRXhjbHVzaW9uIEJh
c2UgUmVnaXN0ZXIgYW5kIHRoZSBFeGNsdXNpb24KUmFuZ2UgTGltaXQgUmVn
aXN0ZXIpLCBjb21iaW5lIG9ubHkgYWRqYWNlbnQgb3Igb3ZlcmxhcHBpbmcg
cmVnaW9ucyAoZm9yCm5vdzsgdGhpcyBtYXkgcmVxdWlyZSBmdXJ0aGVyIGFk
anVzdG1lbnQgaW4gY2FzZSB0YWJsZSBlbnRyaWVzIGFyZW4ndApzb3J0ZWQg
YnkgYWRkcmVzcykgd2l0aCBtYXRjaGluZyBleGNsdXNpb25fYWxsb3dfYWxs
IHNldHRpbmdzLiBUaGlzCnJlcXVpcmVzIGJ1YmJsaW5nIHVwIGVycm9yIGlu
ZGljYXRvcnMsIHN1Y2ggdGhhdCBJT01NVSBpbml0IGNhbiBiZQpmYWlsZWQg
d2hlbiBjb25jYXRlbmF0aW9uIHdhc24ndCBwb3NzaWJsZS4KCkZ1cnRoZXJt
b3JlLCBzaW5jZSB0aGUgZXhjbHVzaW9uIHJhbmdlIHNwZWNpZmllZCBpbiBJ
T01NVSByZWdpc3RlcnMKaW1wbGllcyBSL1cgYWNjZXNzLCByZWplY3QgcmVx
dWVzdHMgYXNraW5nIGZvciBsZXNzIHBlcm1pc3Npb25zICh0aGlzCndpbGwg
YmUgYnJvdWdodCBjbG9zZXIgdG8gdGhlIHNwZWMgYnkgYSBzdWJzZXF1ZW50
IGNoYW5nZSkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3OCAvIENWRS0yMDIx
LTI4Njk1LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9hY3BpLmMKQEAgLTk4LDEyICs5OCwyMSBAQCBzdGF0aWMgc3RydWN0
IGFtZF9pb21tdSAqIF9faW5pdCBmaW5kX2lvCiAgICAgcmV0dXJuIE5VTEw7
CiB9CiAKLXN0YXRpYyB2b2lkIF9faW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZSgKLSAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWlu
dDY0X3QgYmFzZSwgdWludDY0X3QgbGltaXQpCitzdGF0aWMgaW50IF9faW5p
dCByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZSgKKyAgICBzdHJ1Y3Qg
YW1kX2lvbW11ICppb21tdSwgdWludDY0X3QgYmFzZSwgdWludDY0X3QgbGlt
aXQsCisgICAgYm9vbCBhbGwsIGJvb2wgaXcsIGJvb2wgaXIpCiB7CisgICAg
aWYgKCAhaXIgfHwgIWl3ICkKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKKwog
ICAgIC8qIG5lZWQgdG8gZXh0ZW5kIGV4Y2x1c2lvbiByYW5nZT8gKi8KICAg
ICBpZiAoIGlvbW11LT5leGNsdXNpb25fZW5hYmxlICkKICAgICB7CisgICAg
ICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9saW1pdCArIFBBR0VfU0laRSA8
IGJhc2UgfHwKKyAgICAgICAgICAgICBsaW1pdCArIFBBR0VfU0laRSA8IGlv
bW11LT5leGNsdXNpb25fYmFzZSB8fAorICAgICAgICAgICAgIGlvbW11LT5l
eGNsdXNpb25fYWxsb3dfYWxsICE9IGFsbCApCisgICAgICAgICAgICByZXR1
cm4gLUVCVVNZOworCiAgICAgICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9i
YXNlIDwgYmFzZSApCiAgICAgICAgICAgICBiYXNlID0gaW9tbXUtPmV4Y2x1
c2lvbl9iYXNlOwogICAgICAgICBpZiAoIGlvbW11LT5leGNsdXNpb25fbGlt
aXQgPiBsaW1pdCApCkBAIC0xMTEsMTYgKzEyMCwxMSBAQCBzdGF0aWMgdm9p
ZCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNpCiAgICAgfQogCiAgICAg
aW9tbXUtPmV4Y2x1c2lvbl9lbmFibGUgPSBJT01NVV9DT05UUk9MX0VOQUJM
RUQ7CisgICAgaW9tbXUtPmV4Y2x1c2lvbl9hbGxvd19hbGwgPSBhbGw7CiAg
ICAgaW9tbXUtPmV4Y2x1c2lvbl9iYXNlID0gYmFzZTsKICAgICBpb21tdS0+
ZXhjbHVzaW9uX2xpbWl0ID0gbGltaXQ7Ci19CiAKLXN0YXRpYyB2b2lkIF9f
aW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZV9hbGwoCi0gICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCi0gICAgdW5zaWduZWQgbG9uZyBi
YXNlLCB1bnNpZ25lZCBsb25nIGxpbWl0KQotewotICAgIHJlc2VydmVfaW9t
bXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCk7Ci0gICAg
aW9tbXUtPmV4Y2x1c2lvbl9hbGxvd19hbGwgPSBJT01NVV9DT05UUk9MX0VO
QUJMRUQ7CisgICAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyB2b2lkIF9faW5p
dCByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKApAQCAtMTU4LDYgKzE2
Miw3IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9y
YW4KICAgICB1bnNpZ25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBs
ZW5ndGg7CiAgICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CiAgICAgdW5z
aWduZWQgaW50IGJkZjsKKyAgICBpbnQgcmMgPSAwOwogCiAgICAgLyogaXMg
cGFydCBvZiBleGNsdXNpb24gcmFuZ2UgaW5zaWRlIG9mIElPTU1VIHZpcnR1
YWwgYWRkcmVzcyBzcGFjZT8gKi8KICAgICAvKiBub3RlOiAnbGltaXQnIHBh
cmFtZXRlciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2UtYWxpZ25lZCAqLwpAQCAt
MTc5LDEwICsxODQsMTUgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJf
ZXhjbHVzaW9uX3JhbgogICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkK
ICAgICB7CiAgICAgICAgIGZvcl9lYWNoX2FtZF9pb21tdSggaW9tbXUgKQot
ICAgICAgICAgICAgcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2VfYWxs
KGlvbW11LCBiYXNlLCBsaW1pdCk7CisgICAgICAgIHsKKyAgICAgICAgICAg
IHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJh
c2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0cnVlIC8qIGFsbCAqLywgaXcsIGlyKTsKKyAgICAg
ICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICB9CiAgICAgfQogCi0gICAgcmV0dXJuIDA7CisgICAgcmV0dXJuIHJj
OwogfQogCiBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25f
cmFuZ2VfZm9yX2RldmljZSgKQEAgLTE5Myw2ICsyMDMsNyBAQCBzdGF0aWMg
aW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgdW5zaWdu
ZWQgbG9uZyByYW5nZV90b3AsIGlvbW11X3RvcCwgbGVuZ3RoOwogICAgIHN0
cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAgIHUxNiByZXE7CisgICAgaW50
IHJjID0gMDsKIAogICAgIGlvbW11ID0gZmluZF9pb21tdV9mb3JfZGV2aWNl
KHNlZywgYmRmKTsKICAgICBpZiAoICFpb21tdSApCkBAIC0yMjIsMTIgKzIz
MywxMyBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25f
cmFuCiAgICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNl
dHRpbmdzIGZvciBkZXZpY2UgKi8KICAgICBpZiAoIGxpbWl0ID49IGlvbW11
X3RvcCAgKQogICAgIHsKLSAgICAgICAgcmVzZXJ2ZV9pb21tdV9leGNsdXNp
b25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0KTsKKyAgICAgICAgcmMgPSBy
ZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGlt
aXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZmFsc2UgLyogYWxsICovLCBpdywgaXIpOwogICAgICAgICBpdnJzX21h
cHBpbmdzW2JkZl0uZHRlX2FsbG93X2V4Y2x1c2lvbiA9IElPTU1VX0NPTlRS
T0xfRU5BQkxFRDsKICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFdLmR0ZV9h
bGxvd19leGNsdXNpb24gPSBJT01NVV9DT05UUk9MX0VOQUJMRUQ7CiAgICAg
fQogCi0gICAgcmV0dXJuIDA7CisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0
aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2lv
bW11X2RldmljZXMoCkBAIC0yMzcsNiArMjQ5LDcgQEAgc3RhdGljIGludCBf
X2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogICAgIHVuc2lnbmVkIGxv
bmcgcmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAgICB1bnNpZ25l
ZCBpbnQgYmRmOwogICAgIHUxNiByZXE7CisgICAgaW50IHJjID0gMDsKIAog
ICAgIC8qIGlzIHBhcnQgb2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBvZiBJ
T01NVSB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2U/ICovCiAgICAgLyogbm90ZTog
J2xpbWl0JyBwYXJhbWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWdu
ZWQgKi8KQEAgLTI2Nyw4ICsyODAsMTAgQEAgc3RhdGljIGludCBfX2luaXQg
cmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogCiAgICAgLyogcmVnaXN0ZXIgSU9N
TVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzICovCiAgICAgaWYgKCBsaW1p
dCA+PSBpb21tdV90b3AgKQotICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZV9hbGwoaW9tbXUsIGJhc2UsIGxpbWl0KTsKLSAgICByZXR1
cm4gMDsKKyAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9y
YW5nZShpb21tdSwgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3LCBp
cik7CisKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0
IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdCgK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-2.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZGV2aWNlIHVuaXR5IG1hcCBoYW5kbGlu
ZwoKQmxpbmRseSBhc3N1bWluZyBhbGwgYWRkcmVzc2VzIGJldHdlZW4gYW55
IHR3byBzdWNoIHJhbmdlcywgc3BlY2lmaWVkIGJ5CmZpcm13YXJlIGluIHRo
ZSBBQ1BJIHRhYmxlcywgc2hvdWxkIGFsc28gYmUgdW5pdHktbWFwcGVkIGNh
bid0IGJlIHJpZ2h0LgpOb3IgY2FuIGl0IGJlIGNvcnJlY3QgdG8gbWVyZ2Ug
cmFuZ2VzIHdpdGggZGlmZmVyaW5nIHBlcm1pc3Npb25zLiBUcmFjawpyYW5n
ZXMgaW5kaXZpZHVhbGx5OyBkb24ndCBtZXJnZSBhdCBhbGwsIGJ1dCBjaGVj
ayBmb3Igb3ZlcmxhcHMgaW5zdGVhZC4KVGhpcyByZXF1aXJlcyBidWJibGlu
ZyB1cCBlcnJvciBpbmRpY2F0b3JzLCBzdWNoIHRoYXQgSU9NTVUgaW5pdCBj
YW4gYmUKZmFpbGVkIHdoZW4gYWxsb2NhdGlvbiBvZiBhIG5ldyB0cmFja2lu
ZyBzdHJ1Y3Qgd2Fzbid0IHBvc3NpYmxlLCBvciBhbgpvdmVybGFwIHdhcyBk
ZXRlY3RlZC4KCkF0IHRoaXMgb2NjYXNpb24gYWxzbyBzdG9wIGlnbm9yaW5n
CmFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoKSdzIHJldHVy
biB2YWx1ZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4IC8gQ1ZFLTIwMjEt
Mjg2OTUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2Uu
ZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQg
PHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtMTI3LDMyICsxMjcsNDggQEAgc3Rh
dGljIGludCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNpbwogICAgIHJl
dHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCBfX2luaXQgcmVzZXJ2ZV91bml0
eV9tYXBfZm9yX2RldmljZSgKLSAgICB1MTYgc2VnLCB1MTYgYmRmLCB1bnNp
Z25lZCBsb25nIGJhc2UsCi0gICAgdW5zaWduZWQgbG9uZyBsZW5ndGgsIHU4
IGl3LCB1OCBpcikKK3N0YXRpYyBpbnQgX19pbml0IHJlc2VydmVfdW5pdHlf
bWFwX2Zvcl9kZXZpY2UoCisgICAgdWludDE2X3Qgc2VnLCB1aW50MTZfdCBi
ZGYsIHVuc2lnbmVkIGxvbmcgYmFzZSwKKyAgICB1bnNpZ25lZCBsb25nIGxl
bmd0aCwgYm9vbCBpdywgYm9vbCBpcikKIHsKICAgICBzdHJ1Y3QgaXZyc19t
YXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBpbmdzKHNl
Zyk7Ci0gICAgdW5zaWduZWQgbG9uZyBvbGRfdG9wLCBuZXdfdG9wOworICAg
IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwID0gaXZyc19tYXBw
aW5nc1tiZGZdLnVuaXR5X21hcDsKIAotICAgIC8qIG5lZWQgdG8gZXh0ZW5k
IHVuaXR5LW1hcHBlZCByYW5nZT8gKi8KLSAgICBpZiAoIGl2cnNfbWFwcGlu
Z3NbYmRmXS51bml0eV9tYXBfZW5hYmxlICkKKyAgICAvKiBDaGVjayBmb3Ig
b3ZlcmxhcHMuICovCisgICAgZm9yICggOyB1bml0eV9tYXA7IHVuaXR5X21h
cCA9IHVuaXR5X21hcC0+bmV4dCApCiAgICAgewotICAgICAgICBvbGRfdG9w
ID0gaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2Vfc3RhcnQgKwotICAg
ICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2VfbGVuZ3Ro
OwotICAgICAgICBuZXdfdG9wID0gYmFzZSArIGxlbmd0aDsKLSAgICAgICAg
aWYgKCBvbGRfdG9wID4gbmV3X3RvcCApCi0gICAgICAgICAgICBuZXdfdG9w
ID0gb2xkX3RvcDsKLSAgICAgICAgaWYgKCBpdnJzX21hcHBpbmdzW2JkZl0u
YWRkcl9yYW5nZV9zdGFydCA8IGJhc2UgKQotICAgICAgICAgICAgYmFzZSA9
IGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3JhbmdlX3N0YXJ0OwotICAgICAg
ICBsZW5ndGggPSBuZXdfdG9wIC0gYmFzZTsKLSAgICB9Ci0KLSAgICAvKiBl
eHRlbmQgci93IHBlcm1pc3Npb21zIGFuZCBrZWVwIGFnZ3JlZ2F0ZSAqLwot
ICAgIGl2cnNfbWFwcGluZ3NbYmRmXS53cml0ZV9wZXJtaXNzaW9uID0gaXc7
Ci0gICAgaXZyc19tYXBwaW5nc1tiZGZdLnJlYWRfcGVybWlzc2lvbiA9IGly
OwotICAgIGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXBfZW5hYmxlID0g
SU9NTVVfQ09OVFJPTF9FTkFCTEVEOwotICAgIGl2cnNfbWFwcGluZ3NbYmRm
XS5hZGRyX3JhbmdlX3N0YXJ0ID0gYmFzZTsKLSAgICBpdnJzX21hcHBpbmdz
W2JkZl0uYWRkcl9yYW5nZV9sZW5ndGggPSBsZW5ndGg7CisgICAgICAgIC8q
CisgICAgICAgICAqIEV4YWN0IG1hdGNoZXMgYXJlIG9rYXkuIFRoaXMgY2Fu
IGluIHBhcnRpY3VsYXIgaGFwcGVuIHdoZW4KKyAgICAgICAgICogcmVnaXN0
ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoKSBjYWxscyBoZXJlIHR3
aWNlIGZvciB0aGUKKyAgICAgICAgICogc2FtZSAocyxiLGQsZikuCisgICAg
ICAgICAqLworICAgICAgICBpZiAoIGJhc2UgPT0gdW5pdHlfbWFwLT5hZGRy
ICYmIGxlbmd0aCA9PSB1bml0eV9tYXAtPmxlbmd0aCAmJgorICAgICAgICAg
ICAgIGlyID09IHVuaXR5X21hcC0+cmVhZCAmJiBpdyA9PSB1bml0eV9tYXAt
PndyaXRlICkKKyAgICAgICAgICAgIHJldHVybiAwOworCisgICAgICAgIGlm
ICggdW5pdHlfbWFwLT5hZGRyICsgdW5pdHlfbWFwLT5sZW5ndGggPiBiYXNl
ICYmCisgICAgICAgICAgICAgYmFzZSArIGxlbmd0aCA+IHVuaXR5X21hcC0+
YWRkciApCisgICAgICAgIHsKKyAgICAgICAgICAgIEFNRF9JT01NVV9ERUJV
RygiSVZNRCBFcnJvcjogb3ZlcmxhcCBbJWx4LCVseCkgdnMgWyVseCwlbHgp
XG4iLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UsIGJhc2Ug
KyBsZW5ndGgsIHVuaXR5X21hcC0+YWRkciwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bml0eV9tYXAtPmFkZHIgKyB1bml0eV9tYXAtPmxlbmd0
aCk7CisgICAgICAgICAgICByZXR1cm4gLUVQRVJNOworICAgICAgICB9Cisg
ICAgfQorCisgICAgLyogUG9wdWxhdGUgYW5kIGluc2VydCBhIG5ldyB1bml0
eSBtYXAuICovCisgICAgdW5pdHlfbWFwID0geG1hbGxvYyhzdHJ1Y3QgaXZy
c191bml0eV9tYXApOworICAgIGlmICggIXVuaXR5X21hcCApCisgICAgICAg
IHJldHVybiAtRU5PTUVNOworCisgICAgdW5pdHlfbWFwLT5yZWFkID0gaXI7
CisgICAgdW5pdHlfbWFwLT53cml0ZSA9IGl3OworICAgIHVuaXR5X21hcC0+
YWRkciA9IGJhc2U7CisgICAgdW5pdHlfbWFwLT5sZW5ndGggPSBsZW5ndGg7
CisgICAgdW5pdHlfbWFwLT5uZXh0ID0gaXZyc19tYXBwaW5nc1tiZGZdLnVu
aXR5X21hcDsKKyAgICBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwID0g
dW5pdHlfbWFwOworCisgICAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBpbnQg
X19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfYWxsX2Rldmlj
ZXMoCkBAIC0xNzUsMTMgKzE5MSwxMyBAQCBzdGF0aWMgaW50IF9faW5pdCBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgICAgIGxlbmd0aCA9IHJhbmdl
X3RvcCAtIGJhc2U7CiAgICAgICAgIC8qIHJlc2VydmUgci93IHVuaXR5LW1h
cHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZXMgKi8KICAgICAgICAgLyog
bm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9u
IHJhbmdlICovCi0gICAgICAgIGZvciAoIGJkZiA9IDA7IGJkZiA8IGl2cnNf
YmRmX2VudHJpZXM7IGJkZisrICkKLSAgICAgICAgICAgIHJlc2VydmVfdW5p
dHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcs
IGlyKTsKKyAgICAgICAgZm9yICggYmRmID0gMDsgIXJjICYmIGJkZiA8IGl2
cnNfYmRmX2VudHJpZXM7IGJkZisrICkKKyAgICAgICAgICAgIHJjID0gcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVu
Z3RoLCBpdywgaXIpOwogICAgICAgICAvKiBwdXNoICdiYXNlJyBqdXN0IG91
dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCiAgICAgICAgIGJh
c2UgPSBpb21tdV90b3A7CiAgICAgfQogICAgIC8qIHJlZ2lzdGVyIElPTU1V
IGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwotICAgIGlmICggbGltaXQg
Pj0gaW9tbXVfdG9wICkKKyAgICBpZiAoICFyYyAmJiBsaW1pdCA+PSBpb21t
dV90b3AgKQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBp
b21tdSApCiAgICAgICAgIHsKQEAgLTIyMywxNSArMjM5LDE1IEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICAgICAg
bGVuZ3RoID0gcmFuZ2VfdG9wIC0gYmFzZTsKICAgICAgICAgLyogcmVzZXJ2
ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2UgKi8KICAg
ICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUg
ZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIHJlc2VydmVfdW5pdHlfbWFw
X2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsK
LSAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIHJl
cSwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOworICAgICAgICByYyA9IHJlc2Vy
dmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0
aCwgaXcsIGlyKSA/OgorICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFw
X2Zvcl9kZXZpY2Uoc2VnLCByZXEsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsK
IAogICAgICAgICAvKiBwdXNoICdiYXNlJyBqdXN0IG91dHNpZGUgb2Ygdmly
dHVhbCBhZGRyZXNzIHNwYWNlICovCiAgICAgICAgIGJhc2UgPSBpb21tdV90
b3A7CiAgICAgfQogCiAgICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9u
IHJhbmdlIHNldHRpbmdzIGZvciBkZXZpY2UgKi8KLSAgICBpZiAoIGxpbWl0
ID49IGlvbW11X3RvcCAgKQorICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlv
bW11X3RvcCAgKQogICAgIHsKICAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgLyog
YWxsICovLCBpdywgaXIpOwpAQCAtMjYyLDE1ICsyNzgsMTUgQEAgc3RhdGlj
IGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogICAgICAgICBs
ZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwogICAgICAgICAvKiByZXNlcnZl
IHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2VzICov
CiAgICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJpZXMgYXJlIHBhcnQgb2Yg
dGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAgICAgICBmb3IgKCBiZGYgPSAw
OyBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCisgICAgICAgIGZv
ciAoIGJkZiA9IDA7ICFyYyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBi
ZGYrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggaW9tbXUgPT0g
ZmluZF9pb21tdV9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZikgKQogICAg
ICAgICAgICAgewotICAgICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFw
X2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
dywgaXIpOwogICAgICAgICAgICAgICAgIHJlcSA9IGdldF9pdnJzX21hcHBp
bmdzKGlvbW11LT5zZWcpW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZDsKLSAgICAg
ICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11
LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGlyKTsKKyAgICAgICAg
ICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9t
bXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcikgPzoK
KyAgICAgICAgICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9k
ZXZpY2UoaW9tbXUtPnNlZywgcmVxLCBiYXNlLCBsZW5ndGgsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3
LCBpcik7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KIApAQCAtMjc5LDcg
KzI5NSw3IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW4KICAgICB9CiAKICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNp
b24gcmFuZ2Ugc2V0dGluZ3MgKi8KLSAgICBpZiAoIGxpbWl0ID49IGlvbW11
X3RvcCApCisgICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICkK
ICAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShp
b21tdSwgYmFzZSwgbGltaXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3LCBpcik7CiAK
LS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5p
dC5jCkBAIC0xMTg3LDcgKzExODcsNiBAQCBzdGF0aWMgaW50IF9faW5pdCBh
bGxvY19pdnJzX21hcHBpbmdzKHUxCiAgICAgewogICAgICAgICBpdnJzX21h
cHBpbmdzW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZCA9IGJkZjsKICAgICAgICAg
aXZyc19tYXBwaW5nc1tiZGZdLmR0ZV9hbGxvd19leGNsdXNpb24gPSBJT01N
VV9DT05UUk9MX0RJU0FCTEVEOwotICAgICAgICBpdnJzX21hcHBpbmdzW2Jk
Zl0udW5pdHlfbWFwX2VuYWJsZSA9IElPTU1VX0NPTlRST0xfRElTQUJMRUQ7
CiAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRmXS5pb21tdSA9IE5VTEw7CiAK
ICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlID0g
TlVMTDsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9h
bWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
cGNpX2FtZF9pb21tdS5jCkBAIC0zNzIsMTUgKzM3MiwxNyBAQCBzdGF0aWMg
aW50IGFtZF9pb21tdV9hc3NpZ25fZGV2aWNlKHN0cnVjCiAgICAgc3RydWN0
IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBw
aW5ncyhwZGV2LT5zZWcpOwogICAgIGludCBiZGYgPSBQQ0lfQkRGMihwZGV2
LT5idXMsIGRldmZuKTsKICAgICBpbnQgcmVxX2lkID0gZ2V0X2RtYV9yZXF1
ZXN0b3JfaWQocGRldi0+c2VnLCBiZGYpOworICAgIGNvbnN0IHN0cnVjdCBp
dnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwOwogCi0gICAgaWYgKCBpdnJzX21h
cHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwX2VuYWJsZSApCisgICAgZm9yICgg
dW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21hcDsg
dW5pdHlfbWFwOworICAgICAgICAgIHVuaXR5X21hcCA9IHVuaXR5X21hcC0+
bmV4dCApCiAgICAgewotICAgICAgICBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21h
aW5fdW5pdHlfbWFwKAotICAgICAgICAgICAgZCwKLSAgICAgICAgICAgIGl2
cnNfbWFwcGluZ3NbcmVxX2lkXS5hZGRyX3JhbmdlX3N0YXJ0LAotICAgICAg
ICAgICAgaXZyc19tYXBwaW5nc1tyZXFfaWRdLmFkZHJfcmFuZ2VfbGVuZ3Ro
LAotICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFfaWRdLndyaXRlX3Bl
cm1pc3Npb24sCi0gICAgICAgICAgICBpdnJzX21hcHBpbmdzW3JlcV9pZF0u
cmVhZF9wZXJtaXNzaW9uKTsKKyAgICAgICAgaW50IHJjID0gYW1kX2lvbW11
X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAgICAgICAgICAgICAg
ICAgIGQsIHVuaXR5X21hcC0+YWRkciwgdW5pdHlfbWFwLT5sZW5ndGgsCisg
ICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPndyaXRlLCB1bml0eV9t
YXAtPnJlYWQpOworCisgICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAg
cmV0dXJuIHJjOwogICAgIH0KIAogICAgIHJldHVybiByZWFzc2lnbl9kZXZp
Y2UocGRldi0+ZG9tYWluLCBkLCBkZXZmbiwgcGRldik7Ci0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvYW1kLWlvbW11LmgKKysrIGIveGVuL2luY2x1ZGUv
YXNtLXg4Ni9hbWQtaW9tbXUuaApAQCAtMTA4LDE1ICsxMDgsMTkgQEAgc3Ry
dWN0IGFtZF9pb21tdSB7CiAgICAgc3RydWN0IGxpc3RfaGVhZCBhdHNfZGV2
aWNlczsKIH07CiAKK3N0cnVjdCBpdnJzX3VuaXR5X21hcCB7CisgICAgYm9v
bCByZWFkOjE7CisgICAgYm9vbCB3cml0ZToxOworICAgIHBhZGRyX3QgYWRk
cjsKKyAgICB1bnNpZ25lZCBsb25nIGxlbmd0aDsKKyAgICBzdHJ1Y3QgaXZy
c191bml0eV9tYXAgKm5leHQ7Cit9OworCiBzdHJ1Y3QgaXZyc19tYXBwaW5n
cyB7CiAgICAgdTE2IGR0ZV9yZXF1ZXN0b3JfaWQ7CiAgICAgdTggZHRlX2Fs
bG93X2V4Y2x1c2lvbjsKLSAgICB1OCB1bml0eV9tYXBfZW5hYmxlOwotICAg
IHU4IHdyaXRlX3Blcm1pc3Npb247Ci0gICAgdTggcmVhZF9wZXJtaXNzaW9u
OwotICAgIHVuc2lnbmVkIGxvbmcgYWRkcl9yYW5nZV9zdGFydDsKLSAgICB1
bnNpZ25lZCBsb25nIGFkZHJfcmFuZ2VfbGVuZ3RoOwogICAgIHN0cnVjdCBh
bWRfaW9tbXUgKmlvbW11OworICAgIHN0cnVjdCBpdnJzX3VuaXR5X21hcCAq
dW5pdHlfbWFwOwogCiAgICAgLyogcGVyIGRldmljZSBpbnRlcnJ1cHQgcmVt
YXBwaW5nIHRhYmxlICovCiAgICAgdm9pZCAqaW50cmVtYXBfdGFibGU7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-3.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogYWxzbyBwYXNzIHAybV9hY2Nlc3NfdCB0byBwMm1fZ2V0X2lv
bW11X2ZsYWdzKCkKCkEgc3Vic2VxdWVudCBjaGFuZ2Ugd2lsbCB3YW50IHRv
IGN1c3RvbWl6ZSB0aGUgSU9NTVUgcGVybWlzc2lvbnMgYmFzZWQKb24gdGhp
cy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTcxMSw3ICs3MTEsNyBAQCBlcHRfc2V0X2VudHJ5KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sIGdmCiAgICAgdWludDhfdCBpcGF0ID0gMDsKICAg
ICBib29sX3QgbmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMTsKICAgICBib29s
X3QgdnRkX3B0ZV9wcmVzZW50ID0gMDsKLSAgICB1bnNpZ25lZCBpbnQgaW9t
bXVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIG1mbik7Cisg
ICAgdW5zaWduZWQgaW50IGlvbW11X2ZsYWdzID0gcDJtX2dldF9pb21tdV9m
bGFncyhwMm10LCBwMm1hLCBtZm4pOwogICAgIGJvb2xfdCBuZWVkc19zeW5j
ID0gMTsKICAgICBlcHRfZW50cnlfdCBvbGRfZW50cnkgPSB7IC5lcHRlID0g
MCB9OwogICAgIGVwdF9lbnRyeV90IG5ld19lbnRyeSA9IHsgLmVwdGUgPSAw
IH07CkBAIC04MzcsOCArODM3LDggQEAgZXB0X3NldF9lbnRyeShzdHJ1Y3Qg
cDJtX2RvbWFpbiAqcDJtLCBnZgogCiAgICAgICAgIC8qIFNhZmUgdG8gcmVh
ZC10aGVuLXdyaXRlIGJlY2F1c2Ugd2UgaG9sZCB0aGUgcDJtIGxvY2sgKi8K
ICAgICAgICAgaWYgKCBlcHRfZW50cnktPm1mbiA9PSBuZXdfZW50cnkubWZu
ICYmCi0gICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhlcHRfZW50
cnktPnNhX3AybXQsIF9tZm4oZXB0X2VudHJ5LT5tZm4pKSA9PQotICAgICAg
ICAgICAgIGlvbW11X2ZsYWdzICkKKyAgICAgICAgICAgICBwMm1fZ2V0X2lv
bW11X2ZsYWdzKGVwdF9lbnRyeS0+c2FfcDJtdCwgZXB0X2VudHJ5LT5hY2Nl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWZuKGVw
dF9lbnRyeS0+bWZuKSkgPT0gaW9tbXVfZmxhZ3MgKQogICAgICAgICAgICAg
bmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMDsKIAogICAgICAgICBlcHRfcDJt
X3R5cGVfdG9fZmxhZ3MocDJtLCAmbmV3X2VudHJ5LCBwMm10LCBwMm1hKTsK
LS0tIGEveGVuL2FyY2gveDg2L21tL3AybS1wdC5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9tbS9wMm0tcHQuYwpAQCAtNDcxLDYgKzQ3MSwxNiBAQCBpbnQgcDJt
X3B0X2hhbmRsZV9kZWZlcnJlZF9jaGFuZ2VzKHVpbnQ2CiAgICAgcmV0dXJu
IHJjOwogfQogCisvKiBSZWNvbnN0cnVjdCBhIGZha2UgcDJtX2FjY2Vzc190
IGZyb20gc3RvcmVkIFBURSBmbGFncy4gKi8KK3N0YXRpYyBwMm1fYWNjZXNz
X3QgcDJtX2ZsYWdzX3RvX2FjY2Vzcyh1bnNpZ25lZCBpbnQgZmxhZ3MpCit7
CisgICAgaWYgKCBmbGFncyAmIF9QQUdFX1BSRVNFTlQgKQorICAgICAgICBy
ZXR1cm4gcDJtX2FjY2Vzc19uOworCisgICAgLyogTm8gbmVlZCB0byBsb29r
IGF0IF9QQUdFX05YIGZvciBub3cuICovCisgICAgcmV0dXJuIGZsYWdzICYg
X1BBR0VfUlcgPyBwMm1fYWNjZXNzX3J3IDogcDJtX2FjY2Vzc19yOworfQor
CiAvKiBSZXR1cm5zOiAwIGZvciBzdWNjZXNzLCAtZXJybm8gZm9yIGZhaWx1
cmUgKi8KIHN0YXRpYyBpbnQKIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAy
bV9kb21haW4gKnAybSwgZ2ZuX3QgZ2ZuXywgbWZuX3QgbWZuLApAQCAtNDg3
LDcgKzQ5Nyw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21h
aW4gKnAybSwKICAgICBsMl9wZ2VudHJ5X3QgbDJlX2NvbnRlbnQ7CiAgICAg
bDNfcGdlbnRyeV90IGwzZV9jb250ZW50OwogICAgIGludCByYzsKLSAgICB1
bnNpZ25lZCBpbnQgaW9tbXVfcHRlX2ZsYWdzID0gcDJtX2dldF9pb21tdV9m
bGFncyhwMm10LCBtZm4pOworICAgIHVuc2lnbmVkIGludCBpb21tdV9wdGVf
ZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIHAybWEsIG1mbik7
CiAgICAgLyoKICAgICAgKiBvbGRfbWZuIGFuZCBpb21tdV9vbGRfZmxhZ3Mg
Y29udHJvbCBwb3NzaWJsZSBmbHVzaC91cGRhdGUgbmVlZHMgb24gdGhlCiAg
ICAgICogSU9NTVU6IFdlIG5lZWQgdG8gZmx1c2ggd2hlbiBNRk4gb3IgZmxh
Z3MgKGkuZS4gcGVybWlzc2lvbnMpIGNoYW5nZS4KQEAgLTU1Niw2ICs1NjYs
NyBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9tYWluICpwMm0s
CiAgICAgICAgICAgICAgICAgb2xkX21mbiA9IGwxZV9nZXRfcGZuKCpwMm1f
ZW50cnkpOwogICAgICAgICAgICAgICAgIGlvbW11X29sZF9mbGFncyA9CiAg
ICAgICAgICAgICAgICAgICAgIHAybV9nZXRfaW9tbXVfZmxhZ3MocDJtX2Zs
YWdzX3RvX3R5cGUoZmxhZ3MpLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHAybV9mbGFnc190b19hY2Nlc3MoZmxhZ3MpLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZm4o
b2xkX21mbikpOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgZWxzZQpA
QCAtNjAyLDkgKzYxMywxMCBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDAsIEwxX1BBR0VUQUJMRV9FTlRSSUVTKTsKICAgICAgICAgQVNT
RVJUKHAybV9lbnRyeSk7CiAgICAgICAgIG9sZF9tZm4gPSBsMWVfZ2V0X3Bm
bigqcDJtX2VudHJ5KTsKKyAgICAgICAgZmxhZ3MgPSBsMWVfZ2V0X2ZsYWdz
KCpwMm1fZW50cnkpOwogICAgICAgICBpb21tdV9vbGRfZmxhZ3MgPQotICAg
ICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxhZ3NfdG9fdHlw
ZShsMWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkpKSwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7CisgICAgICAgICAg
ICBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV9mbGFnc190b190eXBlKGZsYWdz
KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2ZsYWdz
X3RvX2FjY2VzcyhmbGFncyksIF9tZm4ob2xkX21mbikpOwogCiAgICAgICAg
IGlmICggbWZuX3ZhbGlkKG1mbikgfHwgcDJtX2FsbG93c19pbnZhbGlkX21m
bihwMm10KSApCiAgICAgICAgICAgICBlbnRyeV9jb250ZW50ID0gcDJtX2wx
ZV9mcm9tX3BmbihtZm5feChtZm4pLApAQCAtNjQ4LDYgKzY2MCw3IEBAIHAy
bV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4gKnAybSwKICAgICAg
ICAgICAgICAgICBvbGRfbWZuID0gbDFlX2dldF9wZm4oKnAybV9lbnRyeSk7
CiAgICAgICAgICAgICAgICAgaW9tbXVfb2xkX2ZsYWdzID0KICAgICAgICAg
ICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxhZ3NfdG9f
dHlwZShmbGFncyksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyksCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21mbihvbGRfbWZu
KSk7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlCi0tLSBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNt
LXg4Ni9wMm0uaApAQCAtODM5LDcgKzgzOSw4IEBAIGludCBwMm1fYWx0cDJt
X3Byb3BhZ2F0ZV9jaGFuZ2Uoc3RydWN0IGQKIC8qCiAgKiBwMm0gdHlwZSB0
byBJT01NVSBmbGFncwogICovCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGlu
dCBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV90eXBlX3QgcDJtdCwgbWZuX3Qg
bWZuKQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJtX2dldF9pb21t
dV9mbGFncyhwMm1fdHlwZV90IHAybXQsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9hY2Nlc3NfdCBwMm1h
LCBtZm5fdCBtZm4pCiB7CiAgICAgdW5zaWduZWQgaW50IGZsYWdzOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-4.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogZ2VuZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVk
IFJNUlIgcmVnaW9ucwoKSW4gb3JkZXIgdG8gcmUtdXNlIGl0IGVsc2V3aGVy
ZSwgbW92ZSB0aGUgbG9naWMgdG8gdmVuZG9yIGluZGVwZW5kZW50CmNvZGUg
YW5kIHN0cmlwIGl0IG9mIFJNUlIgc3BlY2lmaWNzLgoKTm90ZSB0aGF0IHRo
ZSBwcmlvciAibWFwIiBwYXJhbWV0ZXIgZ2V0cyBmb2xkZWQgaW50byB0aGUg
bmV3ICJwMm1hIiBvbmUKKHdoaWNoIEFNRCBJT01NVSBjb2RlIHdpbGwgd2Fu
dCB0byBtYWtlIHVzZSBvZiksIGFzc2lnbmluZyBhbHRlcm5hdGl2ZQptZWFu
aW5nICgidW5tYXAiKSB0byBwMm1fYWNjZXNzX3guIFByZXBhcmUgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpIGFuZApwMm1fZ2V0X2lvbW11X2ZsYWdzKCkg
Zm9yIGdldHRpbmcgcGFzc2VkIGFjY2VzcyB0eXBlcyBvdGhlciB0aGFuCnAy
bV9hY2Nlc3NfcncgKGluIHRoZSBsYXR0ZXIgY2FzZSBqdXN0IGZvciBwMm1f
bW1pb19kaXJlY3QgcmVxdWVzdHMpLgoKTm90ZSBhbHNvIHRoYXQsIHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUsIGFuIG92ZXJsYXAgY2hlY2sgZ2V0cyBhZGRl
ZCB0bwp0aGUgbWFpbiBsb29wIG9mIGlvbW11X2lkZW50aXR5X21hcHBpbmco
KS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0x
MTU3LDcgKzExNTcsOCBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShz
dHJ1Y3QgZG9tYWluCiAgICAgewogICAgICAgICBpZiAoICFuZWVkX2lvbW11
KGQpICkKICAgICAgICAgICAgIHJldHVybiAwOwotICAgICAgICByZXR1cm4g
aW9tbXVfbWFwX3BhZ2UoZCwgZ2ZuX2wsIGdmbl9sLCBJT01NVUZfcmVhZGFi
bGV8SU9NTVVGX3dyaXRhYmxlKTsKKyAgICAgICAgcmV0dXJuIGlvbW11X21h
cF9wYWdlKGQsIGdmbl9sLCBnZm5fbCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHAybV9hY2Nlc3NfdG9faW9tbXVfZmxhZ3MocDJtYSkpOwog
ICAgIH0KIAogICAgIGdmbl9sb2NrKHAybSwgZ2ZuLCAwKTsKLS0tIGEveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKQEAgLTQyLDEyICs0Miw2
IEBACiAjaW5jbHVkZSAidnRkLmgiCiAjaW5jbHVkZSAiLi4vYXRzLmgiCiAK
LXN0cnVjdCBtYXBwZWRfcm1yciB7Ci0gICAgc3RydWN0IGxpc3RfaGVhZCBs
aXN0OwotICAgIHU2NCBiYXNlLCBlbmQ7Ci0gICAgdW5zaWduZWQgaW50IGNv
dW50OwotfTsKLQogLyogUG9zc2libGUgdW5maWx0ZXJlZCBMQVBJQy9NU0kg
bWVzc2FnZXMgZnJvbSB1bnRydXN0ZWQgc291cmNlcz8gKi8KIGJvb2wgX19y
ZWFkX21vc3RseSB1bnRydXN0ZWRfbXNpOwogCkBAIC0xNzg1LDE2ICsxNzc5
LDExIEBAIG91dDoKIHN0YXRpYyB2b2lkIGlvbW11X2RvbWFpbl90ZWFyZG93
bihzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHN0cnVjdCBkb21haW5faW9t
bXUgKmhkID0gZG9tX2lvbW11KGQpOwotICAgIHN0cnVjdCBtYXBwZWRfcm1y
ciAqbXJtcnIsICp0bXA7CiAKICAgICBpZiAoIGxpc3RfZW1wdHkoJmFjcGlf
ZHJoZF91bml0cykgKQogICAgICAgICByZXR1cm47CiAKLSAgICBsaXN0X2Zv
cl9lYWNoX2VudHJ5X3NhZmUgKCBtcm1yciwgdG1wLCAmaGQtPmFyY2gubWFw
cGVkX3JtcnJzLCBsaXN0ICkKLSAgICB7Ci0gICAgICAgIGxpc3RfZGVsKCZt
cm1yci0+bGlzdCk7Ci0gICAgICAgIHhmcmVlKG1ybXJyKTsKLSAgICB9Cisg
ICAgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKGQpOwogCiAgICAgaWYg
KCBpb21tdV91c2VfaGFwX3B0KGQpICkKICAgICAgICAgcmV0dXJuOwpAQCAt
MTkwMyw3NCArMTg5Miw2IEBAIHN0YXRpYyB2b2lkIGlvbW11X3NldF9wZ2Qo
c3RydWN0IGRvbWFpbgogICAgICAgICBwYWdldGFibGVfZ2V0X3BhZGRyKHBh
Z2V0YWJsZV9mcm9tX21mbihwZ2RfbWZuKSk7CiB9CiAKLXN0YXRpYyBpbnQg
cm1ycl9pZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmQsIGJvb2xf
dCBtYXAsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25z
dCBzdHJ1Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnIsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1MzIgZmxhZykKLXsKLSAgICB1bnNpZ25l
ZCBsb25nIGJhc2VfcGZuID0gcm1yci0+YmFzZV9hZGRyZXNzID4+IFBBR0Vf
U0hJRlRfNEs7Ci0gICAgdW5zaWduZWQgbG9uZyBlbmRfcGZuID0gUEFHRV9B
TElHTl80SyhybXJyLT5lbmRfYWRkcmVzcykgPj4gUEFHRV9TSElGVF80SzsK
LSAgICBzdHJ1Y3QgbWFwcGVkX3JtcnIgKm1ybXJyOwotICAgIHN0cnVjdCBk
b21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOwotCi0gICAgQVNTRVJU
KHBjaWRldnNfbG9ja2VkKCkpOwotICAgIEFTU0VSVChybXJyLT5iYXNlX2Fk
ZHJlc3MgPCBybXJyLT5lbmRfYWRkcmVzcyk7Ci0KLSAgICAvKgotICAgICAq
IE5vIG5lZWQgdG8gYWNxdWlyZSBoZC0+YXJjaC5tYXBwaW5nX2xvY2s6IEJv
dGggaW5zZXJ0aW9uIGFuZCByZW1vdmFsCi0gICAgICogZ2V0IGRvbmUgd2hp
bGUgaG9sZGluZyBwY2lkZXZzX2xvY2suCi0gICAgICovCi0gICAgbGlzdF9m
b3JfZWFjaF9lbnRyeSggbXJtcnIsICZoZC0+YXJjaC5tYXBwZWRfcm1ycnMs
IGxpc3QgKQotICAgIHsKLSAgICAgICAgaWYgKCBtcm1yci0+YmFzZSA9PSBy
bXJyLT5iYXNlX2FkZHJlc3MgJiYKLSAgICAgICAgICAgICBtcm1yci0+ZW5k
ID09IHJtcnItPmVuZF9hZGRyZXNzICkKLSAgICAgICAgewotICAgICAgICAg
ICAgaW50IHJldCA9IDA7Ci0KLSAgICAgICAgICAgIGlmICggbWFwICkKLSAg
ICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICArK21ybXJyLT5jb3VudDsK
LSAgICAgICAgICAgICAgICByZXR1cm4gMDsKLSAgICAgICAgICAgIH0KLQot
ICAgICAgICAgICAgaWYgKCAtLW1ybXJyLT5jb3VudCApCi0gICAgICAgICAg
ICAgICAgcmV0dXJuIDA7Ci0KLSAgICAgICAgICAgIHdoaWxlICggYmFzZV9w
Zm4gPCBlbmRfcGZuICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAg
ICBpZiAoIGNsZWFyX2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3Bmbikg
KQotICAgICAgICAgICAgICAgICAgICByZXQgPSAtRU5YSU87Ci0gICAgICAg
ICAgICAgICAgYmFzZV9wZm4rKzsKLSAgICAgICAgICAgIH0KLQotICAgICAg
ICAgICAgbGlzdF9kZWwoJm1ybXJyLT5saXN0KTsKLSAgICAgICAgICAgIHhm
cmVlKG1ybXJyKTsKLSAgICAgICAgICAgIHJldHVybiByZXQ7Ci0gICAgICAg
IH0KLSAgICB9Ci0KLSAgICBpZiAoICFtYXAgKQotICAgICAgICByZXR1cm4g
LUVOT0VOVDsKLQotICAgIHdoaWxlICggYmFzZV9wZm4gPCBlbmRfcGZuICkK
LSAgICB7Ci0gICAgICAgIGludCBlcnIgPSBzZXRfaWRlbnRpdHlfcDJtX2Vu
dHJ5KGQsIGJhc2VfcGZuLCBwMm1fYWNjZXNzX3J3LCBmbGFnKTsKLQotICAg
ICAgICBpZiAoIGVyciApCi0gICAgICAgICAgICByZXR1cm4gZXJyOwotICAg
ICAgICBiYXNlX3BmbisrOwotICAgIH0KLQotICAgIG1ybXJyID0geG1hbGxv
YyhzdHJ1Y3QgbWFwcGVkX3JtcnIpOwotICAgIGlmICggIW1ybXJyICkKLSAg
ICAgICAgcmV0dXJuIC1FTk9NRU07Ci0gICAgbXJtcnItPmJhc2UgPSBybXJy
LT5iYXNlX2FkZHJlc3M7Ci0gICAgbXJtcnItPmVuZCA9IHJtcnItPmVuZF9h
ZGRyZXNzOwotICAgIG1ybXJyLT5jb3VudCA9IDE7Ci0gICAgbGlzdF9hZGRf
dGFpbCgmbXJtcnItPmxpc3QsICZoZC0+YXJjaC5tYXBwZWRfcm1ycnMpOwot
Ci0gICAgcmV0dXJuIDA7Ci19Ci0KIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVf
YWRkX2RldmljZSh1OCBkZXZmbiwgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiB7
CiAgICAgc3RydWN0IGFjcGlfcm1ycl91bml0ICpybXJyOwpAQCAtMjAwMiw3
ICsxOTIzLDkgQEAgc3RhdGljIGludCBpbnRlbF9pb21tdV9hZGRfZGV2aWNl
KHU4IGRldgogICAgICAgICAgICAgICogU2luY2UgUk1SUnMgYXJlIGFsd2F5
cyByZXNlcnZlZCBpbiB0aGUgZTgyMCBtYXAgZm9yIHRoZSBoYXJkd2FyZQog
ICAgICAgICAgICAgICogZG9tYWluLCB0aGVyZSBzaG91bGRuJ3QgYmUgYSBj
b25mbGljdC4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgcmV0ID0g
cm1ycl9pZGVudGl0eV9tYXBwaW5nKHBkZXYtPmRvbWFpbiwgMSwgcm1yciwg
MCk7CisgICAgICAgICAgICByZXQgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5n
KHBkZXYtPmRvbWFpbiwgcDJtX2FjY2Vzc19ydywKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcm1yci0+YmFzZV9hZGRyZXNz
LCBybXJyLT5lbmRfYWRkcmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgMCk7CiAgICAgICAgICAgICBpZiAoIHJldCAp
CiAgICAgICAgICAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJ
WCwgImQlZDogUk1SUiBtYXBwaW5nIGZhaWxlZFxuIiwKICAgICAgICAgICAg
ICAgICAgICAgICAgIHBkZXYtPmRvbWFpbi0+ZG9tYWluX2lkKTsKQEAgLTIw
NDcsNyArMTk3MCw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfcmVtb3Zl
X2RldmljZSh1OAogICAgICAgICAgKiBBbnkgZmxhZyBpcyBub3RoaW5nIHRv
IGNsZWFyIHRoZXNlIG1hcHBpbmdzIGJ1dCBoZXJlCiAgICAgICAgICAqIGl0
cyBhbHdheXMgc2FmZSBhbmQgc3RyaWN0IHRvIHNldCAwLgogICAgICAgICAg
Ki8KLSAgICAgICAgcm1ycl9pZGVudGl0eV9tYXBwaW5nKHBkZXYtPmRvbWFp
biwgMCwgcm1yciwgMCk7CisgICAgICAgIGlvbW11X2lkZW50aXR5X21hcHBp
bmcocGRldi0+ZG9tYWluLCBwMm1fYWNjZXNzX3gsIHJtcnItPmJhc2VfYWRk
cmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5l
bmRfYWRkcmVzcywgMCk7CiAgICAgfQogCiAgICAgcmV0dXJuIGRvbWFpbl9j
b250ZXh0X3VubWFwKHBkZXYtPmRvbWFpbiwgZGV2Zm4sIHBkZXYpOwpAQCAt
MjIxNCw3ICsyMTM4LDggQEAgc3RhdGljIHZvaWQgX19od2RvbV9pbml0IHNl
dHVwX2h3ZG9tX3JtcgogICAgICAgICAgKiBkb21haW4sIHRoZXJlIHNob3Vs
ZG4ndCBiZSBhIGNvbmZsaWN0LiBTbyBpdHMgYWx3YXlzIHNhZmUgYW5kCiAg
ICAgICAgICAqIHN0cmljdCB0byBzZXQgMC4KICAgICAgICAgICovCi0gICAg
ICAgIHJldCA9IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhkLCAxLCBybXJyLCAw
KTsKKyAgICAgICAgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhkLCBw
Mm1fYWNjZXNzX3J3LCBybXJyLT5iYXNlX2FkZHJlc3MsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcm1yci0+ZW5kX2FkZHJlc3Ms
IDApOwogICAgICAgICBpZiAoIHJldCApCiAgICAgICAgICAgICBkcHJpbnRr
KFhFTkxPR19FUlIgVlREUFJFRklYLAogICAgICAgICAgICAgICAgICAgICAg
IklPTU1VOiBtYXBwaW5nIHJlc2VydmVkIHJlZ2lvbiBmYWlsZWRcbiIpOwpA
QCAtMjM3MSw3ICsyMjk2LDkgQEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZp
Y2Vfb3duZXJzaGlwKAogICAgICAgICAgICAgICAgICAqIEFueSBSTVJSIGZs
YWcgaXMgYWx3YXlzIGlnbm9yZWQgd2hlbiByZW1vdmUgYSBkZXZpY2UsCiAg
ICAgICAgICAgICAgICAgICogYnV0IGl0cyBhbHdheXMgc2FmZSBhbmQgc3Ry
aWN0IHRvIHNldCAwLgogICAgICAgICAgICAgICAgICAqLwotICAgICAgICAg
ICAgICAgIHJldCA9IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhzb3VyY2UsIDAs
IHJtcnIsIDApOworICAgICAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50
aXR5X21hcHBpbmcoc291cmNlLCBwMm1fYWNjZXNzX3gsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5iYXNl
X2FkZHJlc3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBybXJyLT5lbmRfYWRkcmVzcywgMCk7CiAgICAgICAgICAg
ICAgICAgaWYgKCByZXQgIT0gLUVOT0VOVCApCiAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiByZXQ7CiAgICAgICAgICAgICB9CkBAIC0yNDY4LDcgKzIz
OTUsOCBAQCBzdGF0aWMgaW50IGludGVsX2lvbW11X2Fzc2lnbl9kZXZpY2Uo
CiAgICAgICAgICAgICAgUENJX0JVUyhiZGYpID09IGJ1cyAmJgogICAgICAg
ICAgICAgIFBDSV9ERVZGTjIoYmRmKSA9PSBkZXZmbiApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIHJldCA9IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhkLCAx
LCBybXJyLCBmbGFnKTsKKyAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50
aXR5X21hcHBpbmcoZCwgcDJtX2FjY2Vzc19ydywgcm1yci0+YmFzZV9hZGRy
ZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBybXJyLT5lbmRfYWRkcmVzcywgZmxhZyk7CiAgICAgICAgICAgICBpZiAo
IHJldCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaW50IHJj
OwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYwor
KysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYwpAQCAt
MTQ0LDcgKzE0NCw3IEBAIGludCBhcmNoX2lvbW11X2RvbWFpbl9pbml0KHN0
cnVjdCBkb21haW4KICAgICBzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRv
bV9pb21tdShkKTsKIAogICAgIHNwaW5fbG9ja19pbml0KCZoZC0+YXJjaC5t
YXBwaW5nX2xvY2spOwotICAgIElOSVRfTElTVF9IRUFEKCZoZC0+YXJjaC5t
YXBwZWRfcm1ycnMpOworICAgIElOSVRfTElTVF9IRUFEKCZoZC0+YXJjaC5p
ZGVudGl0eV9tYXBzKTsKIAogICAgIHJldHVybiAwOwogfQpAQCAtMTUzLDYg
KzE1Myw5OSBAQCB2b2lkIGFyY2hfaW9tbXVfZG9tYWluX2Rlc3Ryb3koc3Ry
dWN0IGRvCiB7CiB9CiAKK3N0cnVjdCBpZGVudGl0eV9tYXAgeworICAgIHN0
cnVjdCBsaXN0X2hlYWQgbGlzdDsKKyAgICBwYWRkcl90IGJhc2UsIGVuZDsK
KyAgICBwMm1fYWNjZXNzX3QgYWNjZXNzOworICAgIHVuc2lnbmVkIGludCBj
b3VudDsKK307CisKK2ludCBpb21tdV9pZGVudGl0eV9tYXBwaW5nKHN0cnVj
dCBkb21haW4gKmQsIHAybV9hY2Nlc3NfdCBwMm1hLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90IGVuZCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFnKQor
eworICAgIHVuc2lnbmVkIGxvbmcgYmFzZV9wZm4gPSBiYXNlID4+IFBBR0Vf
U0hJRlRfNEs7CisgICAgdW5zaWduZWQgbG9uZyBlbmRfcGZuID0gUEFHRV9B
TElHTl80SyhlbmQpID4+IFBBR0VfU0hJRlRfNEs7CisgICAgc3RydWN0IGlk
ZW50aXR5X21hcCAqbWFwOworICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhk
ID0gZG9tX2lvbW11KGQpOworCisgICAgQVNTRVJUKHBjaWRldnNfbG9ja2Vk
KCkpOworICAgIEFTU0VSVChiYXNlIDwgZW5kKTsKKworICAgIC8qCisgICAg
ICogTm8gbmVlZCB0byBhY3F1aXJlIGhkLT5hcmNoLm1hcHBpbmdfbG9jazog
Qm90aCBpbnNlcnRpb24gYW5kIHJlbW92YWwKKyAgICAgKiBnZXQgZG9uZSB3
aGlsZSBob2xkaW5nIHBjaWRldnNfbG9jay4KKyAgICAgKi8KKyAgICBsaXN0
X2Zvcl9lYWNoX2VudHJ5KCBtYXAsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBz
LCBsaXN0ICkKKyAgICB7CisgICAgICAgIGlmICggbWFwLT5iYXNlID09IGJh
c2UgJiYgbWFwLT5lbmQgPT0gZW5kICkKKyAgICAgICAgeworICAgICAgICAg
ICAgaW50IHJldCA9IDA7CisKKyAgICAgICAgICAgIGlmICggcDJtYSAhPSBw
Mm1fYWNjZXNzX3ggKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAg
IGlmICggbWFwLT5hY2Nlc3MgIT0gcDJtYSApCisgICAgICAgICAgICAgICAg
ICAgIHJldHVybiAtRUFERFJJTlVTRTsKKyAgICAgICAgICAgICAgICArK21h
cC0+Y291bnQ7CisgICAgICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAg
ICAgICB9CisKKyAgICAgICAgICAgIGlmICggLS1tYXAtPmNvdW50ICkKKyAg
ICAgICAgICAgICAgICByZXR1cm4gMDsKKworICAgICAgICAgICAgd2hpbGUg
KCBiYXNlX3BmbiA8IGVuZF9wZm4gKQorICAgICAgICAgICAgeworICAgICAg
ICAgICAgICAgIGlmICggY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KGQsIGJh
c2VfcGZuKSApCisgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FTlhJTzsK
KyAgICAgICAgICAgICAgICBiYXNlX3BmbisrOworICAgICAgICAgICAgfQor
CisgICAgICAgICAgICBsaXN0X2RlbCgmbWFwLT5saXN0KTsKKyAgICAgICAg
ICAgIHhmcmVlKG1hcCk7CisKKyAgICAgICAgICAgIHJldHVybiByZXQ7Cisg
ICAgICAgIH0KKworICAgICAgICBpZiAoIGVuZCA+PSBtYXAtPmJhc2UgJiYg
bWFwLT5lbmQgPj0gYmFzZSApCisgICAgICAgICAgICByZXR1cm4gLUVBRERS
SU5VU0U7CisgICAgfQorCisgICAgaWYgKCBwMm1hID09IHAybV9hY2Nlc3Nf
eCApCisgICAgICAgIHJldHVybiAtRU5PRU5UOworCisgICAgd2hpbGUgKCBi
YXNlX3BmbiA8IGVuZF9wZm4gKQorICAgIHsKKyAgICAgICAgaW50IGVyciA9
IHNldF9pZGVudGl0eV9wMm1fZW50cnkoZCwgYmFzZV9wZm4sIHAybWEsIGZs
YWcpOworCisgICAgICAgIGlmICggZXJyICkKKyAgICAgICAgICAgIHJldHVy
biBlcnI7CisgICAgICAgIGJhc2VfcGZuKys7CisgICAgfQorCisgICAgbWFw
ID0geG1hbGxvYyhzdHJ1Y3QgaWRlbnRpdHlfbWFwKTsKKyAgICBpZiAoICFt
YXAgKQorICAgICAgICByZXR1cm4gLUVOT01FTTsKKyAgICBtYXAtPmJhc2Ug
PSBiYXNlOworICAgIG1hcC0+ZW5kID0gZW5kOworICAgIG1hcC0+YWNjZXNz
ID0gcDJtYTsKKyAgICBtYXAtPmNvdW50ID0gMTsKKyAgICBsaXN0X2FkZF90
YWlsKCZtYXAtPmxpc3QsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBzKTsKKwor
ICAgIHJldHVybiAwOworfQorCit2b2lkIGlvbW11X2lkZW50aXR5X21hcF90
ZWFyZG93bihzdHJ1Y3QgZG9tYWluICpkKQoreworICAgIHN0cnVjdCBkb21h
aW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOworICAgIHN0cnVjdCBpZGVu
dGl0eV9tYXAgKm1hcCwgKnRtcDsKKworICAgIGxpc3RfZm9yX2VhY2hfZW50
cnlfc2FmZSAoIG1hcCwgdG1wLCAmaGQtPmFyY2guaWRlbnRpdHlfbWFwcywg
bGlzdCApCisgICAgeworICAgICAgICBsaXN0X2RlbCgmbWFwLT5saXN0KTsK
KyAgICAgICAgeGZyZWUobWFwKTsKKyAgICB9Cit9CisKIC8qCiAgKiBMb2Nh
bCB2YXJpYWJsZXM6CiAgKiBtb2RlOiBDCi0tLSBhL3hlbi9pbmNsdWRlL2Fz
bS14ODYvaW9tbXUuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11
LmgKQEAgLTE2LDYgKzE2LDcgQEAKIAogI2luY2x1ZGUgPHhlbi9lcnJuby5o
PgogI2luY2x1ZGUgPHhlbi9saXN0Lmg+CisjaW5jbHVkZSA8eGVuL21lbV9h
Y2Nlc3MuaD4KICNpbmNsdWRlIDx4ZW4vc3BpbmxvY2suaD4KICNpbmNsdWRl
IDxhc20vcHJvY2Vzc29yLmg+CiAjaW5jbHVkZSA8YXNtL2h2bS92bXgvdm1j
cy5oPgpAQCAtMzYsNyArMzcsNyBAQCBzdHJ1Y3QgYXJjaF9pb21tdQogICAg
IHNwaW5sb2NrX3QgbWFwcGluZ19sb2NrOyAgICAgICAgICAgIC8qIGlvIHBh
Z2UgdGFibGUgbG9jayAqLwogICAgIGludCBhZ2F3OyAgICAgLyogYWRqdXN0
ZWQgZ3Vlc3QgYWRkcmVzcyB3aWR0aCwgMCBpcyBsZXZlbCAyIDMwLWJpdCAq
LwogICAgIHU2NCBpb21tdV9iaXRtYXA7ICAgICAgICAgICAgICAvKiBiaXRt
YXAgb2YgaW9tbXUocykgdGhhdCB0aGUgZG9tYWluIHVzZXMgKi8KLSAgICBz
dHJ1Y3QgbGlzdF9oZWFkIG1hcHBlZF9ybXJyczsKKyAgICBzdHJ1Y3QgbGlz
dF9oZWFkIGlkZW50aXR5X21hcHM7CiAKICAgICAvKiBhbWQgaW9tbXUgc3Vw
cG9ydCAqLwogICAgIGludCBwYWdpbmdfbW9kZTsKQEAgLTk0LDYgKzk1LDEx
IEBAIGJvb2xfdCBpb21tdV9zdXBwb3J0c19laW0odm9pZCk7CiBpbnQgaW9t
bXVfZW5hYmxlX3gyYXBpY19JUih2b2lkKTsKIHZvaWQgaW9tbXVfZGlzYWJs
ZV94MmFwaWNfSVIodm9pZCk7CiAKK2ludCBpb21tdV9pZGVudGl0eV9tYXBw
aW5nKHN0cnVjdCBkb21haW4gKmQsIHAybV9hY2Nlc3NfdCBwMm1hLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90
IGVuZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBmbGFnKTsKK3ZvaWQgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKHN0
cnVjdCBkb21haW4gKmQpOworCiBleHRlcm4gYm9vbCB1bnRydXN0ZWRfbXNp
OwogCiBpbnQgcGlfdXBkYXRlX2lydGUoY29uc3Qgc3RydWN0IHBpX2Rlc2Mg
KnBpX2Rlc2MsIGNvbnN0IHN0cnVjdCBwaXJxICpwaXJxLAotLS0gYS94ZW4v
aW5jbHVkZS9hc20teDg2L21lbV9hY2Nlc3MuaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L21lbV9hY2Nlc3MuaApAQCAtNDQsMTAgKzQ0LDggQEAgYm9v
bCBwMm1fbWVtX2FjY2Vzc19lbXVsYXRlX2NoZWNrKHN0cnVjdAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZtX2V2ZW50X3Jl
c3BvbnNlX3QgKnJzcCk7CiAKIC8qIFNhbml0eSBjaGVjayBmb3IgbWVtX2Fj
Y2VzcyBoYXJkd2FyZSBzdXBwb3J0ICovCi1zdGF0aWMgaW5saW5lIGJvb2wg
cDJtX21lbV9hY2Nlc3Nfc2FuaXR5X2NoZWNrKHN0cnVjdCBkb21haW4gKmQp
Ci17Ci0gICAgcmV0dXJuIGlzX2h2bV9kb21haW4oZCkgJiYgY3B1X2hhc192
bXggJiYgaGFwX2VuYWJsZWQoZCk7Ci19CisjZGVmaW5lIHAybV9tZW1fYWNj
ZXNzX3Nhbml0eV9jaGVjayhkKSBcCisgICAgKGlzX2h2bV9kb21haW4oZCkg
JiYgY3B1X2hhc192bXggJiYgaGFwX2VuYWJsZWQoZCkpCiAKICNlbmRpZiAv
Kl9fQVNNX1g4Nl9NRU1fQUNDRVNTX0hfXyAqLwogCi0tLSBhL3hlbi9pbmNs
dWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9w
Mm0uaApAQCAtODM2LDYgKzgzNiwzNCBAQCBpbnQgcDJtX2FsdHAybV9wcm9w
YWdhdGVfY2hhbmdlKHN0cnVjdCBkCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1mbl90IG1mbiwgdW5zaWduZWQgaW50IHBhZ2Vfb3JkZXIs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV90eXBlX3Qg
cDJtdCwgcDJtX2FjY2Vzc190IHAybWEpOwogCisvKiBwMm0gYWNjZXNzIHRv
IElPTU1VIGZsYWdzICovCitzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBw
Mm1fYWNjZXNzX3RvX2lvbW11X2ZsYWdzKHAybV9hY2Nlc3NfdCBwMm1hKQor
eworICAgIHN3aXRjaCAoIHAybWEgKQorICAgIHsKKyAgICBjYXNlIHAybV9h
Y2Nlc3Nfcnc6CisgICAgY2FzZSBwMm1fYWNjZXNzX3J3eDoKKyAgICAgICAg
cmV0dXJuIElPTU1VRl9yZWFkYWJsZSB8IElPTU1VRl93cml0YWJsZTsKKwor
ICAgIGNhc2UgcDJtX2FjY2Vzc19yOgorICAgIGNhc2UgcDJtX2FjY2Vzc19y
eDoKKyAgICBjYXNlIHAybV9hY2Nlc3Nfcngycnc6CisgICAgICAgIHJldHVy
biBJT01NVUZfcmVhZGFibGU7CisKKyAgICBjYXNlIHAybV9hY2Nlc3NfdzoK
KyAgICBjYXNlIHAybV9hY2Nlc3Nfd3g6CisgICAgICAgIHJldHVybiBJT01N
VUZfd3JpdGFibGU7CisKKyAgICBjYXNlIHAybV9hY2Nlc3NfbjoKKyAgICBj
YXNlIHAybV9hY2Nlc3NfeDoKKyAgICBjYXNlIHAybV9hY2Nlc3NfbjJyd3g6
CisgICAgICAgIHJldHVybiAwOworICAgIH0KKworICAgIEFTU0VSVF9VTlJF
QUNIQUJMRSgpOworICAgIHJldHVybiAwOworfQorCiAvKgogICogcDJtIHR5
cGUgdG8gSU9NTVUgZmxhZ3MKICAqLwpAQCAtODU3LDkgKzg4NSwxMCBAQCBz
dGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBwMm1fZ2V0X2lvbW11CiAgICAg
ICAgIGZsYWdzID0gSU9NTVVGX3JlYWRhYmxlOwogICAgICAgICBicmVhazsK
ICAgICBjYXNlIHAybV9tbWlvX2RpcmVjdDoKLSAgICAgICAgZmxhZ3MgPSBJ
T01NVUZfcmVhZGFibGU7Ci0gICAgICAgIGlmICggIXJhbmdlc2V0X2NvbnRh
aW5zX3NpbmdsZXRvbihtbWlvX3JvX3JhbmdlcywgbWZuX3gobWZuKSkgKQot
ICAgICAgICAgICAgZmxhZ3MgfD0gSU9NTVVGX3dyaXRhYmxlOworICAgICAg
ICBmbGFncyA9IHAybV9hY2Nlc3NfdG9faW9tbXVfZmxhZ3MocDJtYSk7Cisg
ICAgICAgIGlmICggKGZsYWdzICYgSU9NTVVGX3dyaXRhYmxlKSAmJgorICAg
ICAgICAgICAgIHJhbmdlc2V0X2NvbnRhaW5zX3NpbmdsZXRvbihtbWlvX3Jv
X3JhbmdlcywgbWZuX3gobWZuKSkgKQorICAgICAgICAgICAgZmxhZ3MgJj0g
fklPTU1VRl93cml0YWJsZTsKICAgICAgICAgYnJlYWs7CiAgICAgZGVmYXVs
dDoKICAgICAgICAgZmxhZ3MgPSAwOwo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-5.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UvY29tcGxldGUgcmUtYXNzaWdubWVu
dCBoYW5kbGluZwoKUHJpb3IgdG8gdGhlIGFzc2lnbm1lbnQgc3RlcCBoYXZp
bmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgZGV2aWNlcwpzaG91bGQgbm90
IGdldCBhc3NvY2lhdGVkIHdpdGggdGhlaXIgbmV3IG93bmVyLiBIYW5kIHRo
ZSBkZXZpY2UgdG8gRG9tSU8KKHBlcmhhcHMgdGVtcG9yYXJpbHkpLCB1bnRp
bCBhZnRlciB0aGUgZGUtYXNzaWdubWVudCBzdGVwIGhhcyBjb21wbGV0ZWQu
CgpEZS1hc3NpZ25tZW50IG9mIGEgZGV2aWNlIChmcm9tIG90aGVyIHRoYW4g
RG9tMCkgYXMgd2VsbCBhcyBmYWlsdXJlIG9mCnJlYXNzaWduX2RldmljZSgp
IGR1cmluZyBhc3NpZ25tZW50IHNob3VsZCByZXN1bHQgaW4gdW5pdHkgbWFw
cGluZ3MKZ2V0dGluZyB0b3JuIGRvd24uIFRoaXMgaW4gdHVybiByZXF1aXJl
cyBzd2l0Y2hpbmcgdG8gYSByZWZjb3VudGVkCm1hcHBpbmcgYXBwcm9hY2gs
IGFzIHdhcyBhbHJlYWR5IHVzZWQgYnkgVlQtZCBmb3IgaXRzIFJNUlJzLCB0
byBwcmV2ZW50CnVubWFwcGluZyBhIHJlZ2lvbiB1c2VkIGJ5IG11bHRpcGxl
IGRldmljZXMuCgpUaGlzIGlzIENWRS0yMDIxLTI4Njk2IC8gcGFydCBvZiBY
U0EtMzc4LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfbWFwLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X21hcC5jCkBAIC03MTYsMjcgKzcxNiw0OSBAQCBpbnQgYW1kX2lvbW11
X3VubWFwX3BhZ2Uoc3RydWN0IGRvbWFpbiAqCiAgICAgcmV0dXJuIDA7CiB9
CiAKLWludCBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKHN0
cnVjdCBkb21haW4gKmRvbWFpbiwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHU2NCBwaHlzX2FkZHIsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIHNpemUs
IGludCBpdywgaW50IGlyKQoraW50IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFp
bl91bml0eV9tYXAoc3RydWN0IGRvbWFpbiAqZCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBpdnJzX3Vu
aXR5X21hcCAqbWFwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IGZsYWcpCiB7Ci0gICAgdW5zaWduZWQg
bG9uZyBucGFnZXMsIGk7Ci0gICAgdW5zaWduZWQgbG9uZyBnZm47Ci0gICAg
dW5zaWduZWQgaW50IGZsYWdzID0gISFpcjsKLSAgICBpbnQgcnQgPSAwOwot
Ci0gICAgaWYgKCBpdyApCi0gICAgICAgIGZsYWdzIHw9IElPTU1VRl93cml0
YWJsZTsKLQotICAgIG5wYWdlcyA9IHJlZ2lvbl90b19wYWdlcyhwaHlzX2Fk
ZHIsIHNpemUpOwotICAgIGdmbiA9IHBoeXNfYWRkciA+PiBQQUdFX1NISUZU
OwotICAgIGZvciAoIGkgPSAwOyBpIDwgbnBhZ2VzOyBpKysgKQorICAgIGlu
dCByYzsKKworICAgIGlmICggZCA9PSBkb21faW8gKQorICAgICAgICByZXR1
cm4gMDsKKworICAgIGZvciAoIHJjID0gMDsgIXJjICYmIG1hcDsgbWFwID0g
bWFwLT5uZXh0ICkKICAgICB7Ci0gICAgICAgIHJ0ID0gYW1kX2lvbW11X21h
cF9wYWdlKGRvbWFpbiwgZ2ZuICtpLCBnZm4gK2ksIGZsYWdzKTsKLSAgICAg
ICAgaWYgKCBydCAhPSAwICkKLSAgICAgICAgICAgIHJldHVybiBydDsKKyAg
ICAgICAgcDJtX2FjY2Vzc190IHAybWEgPSBwMm1fYWNjZXNzX247CisKKyAg
ICAgICAgaWYgKCBtYXAtPnJlYWQgKQorICAgICAgICAgICAgcDJtYSB8PSBw
Mm1fYWNjZXNzX3I7CisgICAgICAgIGlmICggbWFwLT53cml0ZSApCisgICAg
ICAgICAgICBwMm1hIHw9IHAybV9hY2Nlc3NfdzsKKworICAgICAgICByYyA9
IGlvbW11X2lkZW50aXR5X21hcHBpbmcoZCwgcDJtYSwgbWFwLT5hZGRyLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLT5hZGRy
ICsgbWFwLT5sZW5ndGggLSAxLCBmbGFnKTsKICAgICB9Ci0gICAgcmV0dXJu
IDA7CisKKyAgICByZXR1cm4gcmM7Cit9CisKK2ludCBhbWRfaW9tbXVfcmVz
ZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAoc3RydWN0IGRvbWFpbiAqZCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
c3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXApCit7CisgICAgaW50IHJjOwor
CisgICAgaWYgKCBkID09IGRvbV9pbyApCisgICAgICAgIHJldHVybiAwOwor
CisgICAgZm9yICggcmMgPSAwOyBtYXA7IG1hcCA9IG1hcC0+bmV4dCApCisg
ICAgeworICAgICAgICBpbnQgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGlu
ZyhkLCBwMm1fYWNjZXNzX3gsIG1hcC0+YWRkciwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLT5hZGRyICsgbWFwLT5s
ZW5ndGggLSAxLCAwKTsKKworICAgICAgICBpZiAoIHJldCAmJiByZXQgIT0g
LUVOT0VOVCAmJiAhcmMgKQorICAgICAgICAgICAgcmMgPSByZXQ7CisgICAg
fQorCisgICAgcmV0dXJuIHJjOwogfQogCiAvKiBTaGFyZSBwMm0gdGFibGUg
d2l0aCBpb21tdS4gKi8KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0zMzMsNiArMzMzLDcgQEAg
c3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbgogICAg
IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAgIGludCBiZGYsIHJjOwog
ICAgIHN0cnVjdCBkb21haW5faW9tbXUgKnQgPSBkb21faW9tbXUodGFyZ2V0
KTsKKyAgICBjb25zdCBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBw
aW5ncyA9IGdldF9pdnJzX21hcHBpbmdzKHBkZXYtPnNlZyk7CiAKICAgICBi
ZGYgPSBQQ0lfQkRGMihwZGV2LT5idXMsIHBkZXYtPmRldmZuKTsKICAgICBp
b21tdSA9IGZpbmRfaW9tbXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7
CkBAIC0zNDcsMTAgKzM0OCwyNCBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2Rl
dmljZShzdHJ1Y3QgZG9tYWluCiAKICAgICBhbWRfaW9tbXVfZGlzYWJsZV9k
b21haW5fZGV2aWNlKHNvdXJjZSwgaW9tbXUsIGRldmZuLCBwZGV2KTsKIAot
ICAgIGlmICggZGV2Zm4gPT0gcGRldi0+ZGV2Zm4gKQorICAgIC8qCisgICAg
ICogSWYgdGhlIGRldmljZSBiZWxvbmdzIHRvIHRoZSBoYXJkd2FyZSBkb21h
aW4sIGFuZCBpdCBoYXMgYSB1bml0eSBtYXBwaW5nLAorICAgICAqIGRvbid0
IHJlbW92ZSBpdCBmcm9tIHRoZSBoYXJkd2FyZSBkb21haW4sIGJlY2F1c2Ug
QklPUyBtYXkgcmVmZXJlbmNlIHRoYXQKKyAgICAgKiBtYXBwaW5nLgorICAg
ICAqLworICAgIGlmICggIWlzX2hhcmR3YXJlX2RvbWFpbihzb3VyY2UpICkK
KyAgICB7CisgICAgICAgIHJjID0gYW1kX2lvbW11X3Jlc2VydmVfZG9tYWlu
X3VuaXR5X3VubWFwKAorICAgICAgICAgICAgICAgICBzb3VyY2UsCisgICAg
ICAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbZ2V0X2RtYV9yZXF1ZXN0b3Jf
aWQocGRldi0+c2VnLCBiZGYpXS51bml0eV9tYXApOworICAgICAgICBpZiAo
IHJjICkKKyAgICAgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBp
ZiAoIGRldmZuID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRvbWFpbiAhPSBk
b21faW8gKQogICAgIHsKLSAgICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21h
aW5fbGlzdCwgJnRhcmdldC0+YXJjaC5wZGV2X2xpc3QpOwotICAgICAgICBw
ZGV2LT5kb21haW4gPSB0YXJnZXQ7CisgICAgICAgIGxpc3RfbW92ZSgmcGRl
di0+ZG9tYWluX2xpc3QsICZkb21faW8tPmFyY2gucGRldl9saXN0KTsKKyAg
ICAgICAgcGRldi0+ZG9tYWluID0gZG9tX2lvOwogICAgIH0KIAogICAgIHJj
ID0gYWxsb2NhdGVfZG9tYWluX3Jlc291cmNlcyh0KTsKQEAgLTM2Miw2ICsz
NzcsMTIgQEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRv
bWFpbgogICAgICAgICAgICAgICAgICAgICBwZGV2LT5zZWcsIHBkZXYtPmJ1
cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbiksCiAgICAgICAg
ICAgICAgICAgICAgIHNvdXJjZS0+ZG9tYWluX2lkLCB0YXJnZXQtPmRvbWFp
bl9pZCk7CiAKKyAgICBpZiAoIGRldmZuID09IHBkZXYtPmRldmZuICYmIHBk
ZXYtPmRvbWFpbiAhPSB0YXJnZXQgKQorICAgIHsKKyAgICAgICAgbGlzdF9t
b3ZlKCZwZGV2LT5kb21haW5fbGlzdCwgJnRhcmdldC0+YXJjaC5wZGV2X2xp
c3QpOworICAgICAgICBwZGV2LT5kb21haW4gPSB0YXJnZXQ7CisgICAgfQor
CiAgICAgcmV0dXJuIDA7CiB9CiAKQEAgLTM3MiwyMCArMzkzLDI4IEBAIHN0
YXRpYyBpbnQgYW1kX2lvbW11X2Fzc2lnbl9kZXZpY2Uoc3RydWMKICAgICBz
dHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJz
X21hcHBpbmdzKHBkZXYtPnNlZyk7CiAgICAgaW50IGJkZiA9IFBDSV9CREYy
KHBkZXYtPmJ1cywgZGV2Zm4pOwogICAgIGludCByZXFfaWQgPSBnZXRfZG1h
X3JlcXVlc3Rvcl9pZChwZGV2LT5zZWcsIGJkZik7Ci0gICAgY29uc3Qgc3Ry
dWN0IGl2cnNfdW5pdHlfbWFwICp1bml0eV9tYXA7CisgICAgaW50IHJjID0g
YW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAgICAg
ICAgICAgICAgZCwgaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21hcCwg
ZmxhZyk7CisKKyAgICBpZiAoICFyYyApCisgICAgICAgIHJjID0gcmVhc3Np
Z25fZGV2aWNlKHBkZXYtPmRvbWFpbiwgZCwgZGV2Zm4sIHBkZXYpOwogCi0g
ICAgZm9yICggdW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVu
aXR5X21hcDsgdW5pdHlfbWFwOwotICAgICAgICAgIHVuaXR5X21hcCA9IHVu
aXR5X21hcC0+bmV4dCApCisgICAgaWYgKCByYyAmJiAhaXNfaGFyZHdhcmVf
ZG9tYWluKGQpICkKICAgICB7Ci0gICAgICAgIGludCByYyA9IGFtZF9pb21t
dV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoCi0gICAgICAgICAgICAgICAg
ICAgICBkLCB1bml0eV9tYXAtPmFkZHIsIHVuaXR5X21hcC0+bGVuZ3RoLAot
ICAgICAgICAgICAgICAgICAgICAgdW5pdHlfbWFwLT53cml0ZSwgdW5pdHlf
bWFwLT5yZWFkKTsKKyAgICAgICAgaW50IHJldCA9IGFtZF9pb21tdV9yZXNl
cnZlX2RvbWFpbl91bml0eV91bm1hcCgKKyAgICAgICAgICAgICAgICAgICAg
ICBkLCBpdnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwKTsKIAotICAg
ICAgICBpZiAoIHJjICkKLSAgICAgICAgICAgIHJldHVybiByYzsKKyAgICAg
ICAgaWYgKCByZXQgKQorICAgICAgICB7CisgICAgICAgICAgICBwcmludGso
WEVOTE9HX0VSUiAiQU1ELVZpOiAiCisgICAgICAgICAgICAgICAgICAgInVu
aXR5LXVubWFwIGZvciBkJWQvJTA0eDolMDJ4OiUwMnguJXUgZmFpbGVkICgl
ZClcbiIsCisgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCBwZGV2
LT5zZWcsIHBkZXYtPmJ1cywKKyAgICAgICAgICAgICAgICAgICBQQ0lfU0xP
VChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwgcmV0KTsKKyAgICAgICAgICAg
IGRvbWFpbl9jcmFzaChkKTsKKyAgICAgICAgfQogICAgIH0KIAotICAgIHJl
dHVybiByZWFzc2lnbl9kZXZpY2UocGRldi0+ZG9tYWluLCBkLCBkZXZmbiwg
cGRldik7CisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0aWMgdm9pZCBkZWFs
bG9jYXRlX25leHRfcGFnZV90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwZywg
aW50IGxldmVsKQpAQCAtNDUxLDYgKzQ4MCw3IEBAIHN0YXRpYyB2b2lkIGRl
YWxsb2NhdGVfaW9tbXVfcGFnZV90YWJsZXMKIAogc3RhdGljIHZvaWQgYW1k
X2lvbW11X2RvbWFpbl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQpCiB7Cisg
ICAgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKGQpOwogICAgIGRlYWxs
b2NhdGVfaW9tbXVfcGFnZV90YWJsZXMoZCk7CiAgICAgYW1kX2lvbW11X2Zs
dXNoX2FsbF9wYWdlcyhkKTsKIH0KLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9odm0vc3ZtL2FtZC1pb21tdS1wcm90by5oCisrKyBiL3hlbi9pbmNsdWRl
L2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtcHJvdG8uaApAQCAtNjAsOCAr
NjAsMTAgQEAgaW50IF9fbXVzdF9jaGVjayBhbWRfaW9tbXVfdW5tYXBfcGFn
ZShzdAogdTY0IGFtZF9pb21tdV9nZXRfbmV4dF90YWJsZV9mcm9tX3B0ZSh1
MzIgKmVudHJ5KTsKIGludCBfX211c3RfY2hlY2sgYW1kX2lvbW11X2FsbG9j
X3Jvb3Qoc3RydWN0IGRvbWFpbl9pb21tdSAqaGQpOwogaW50IGFtZF9pb21t
dV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoc3RydWN0IGRvbWFpbiAqZG9t
YWluLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dTY0IHBoeXNfYWRkciwgdW5zaWduZWQgbG9uZyBzaXplLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGl3LCBpbnQgaXIp
OworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3Qgc3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXAsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZyk7
CitpbnQgYW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X3VubWFwKHN0
cnVjdCBkb21haW4gKmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqbWFw
KTsKIAogLyogU2hhcmUgcDJtIHRhYmxlIHdpdGggaW9tbXUgKi8KIHZvaWQg
YW1kX2lvbW11X3NoYXJlX3AybShzdHJ1Y3QgZG9tYWluICpkKTsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-6.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-6.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UgZXhjbHVzaW9uIHJhbmdlIGFuZCB1
bml0eSBtYXAgcmVjb3JkaW5nCgpUaGUgc3BlYyBtYWtlcyBubyBwcm92aXNp
b25zIGZvciBPUyBiZWhhdmlvciBoZXJlIHRvIGRlcGVuZCBvbiB0aGUKYW1v
dW50IG9mIFJBTSBmb3VuZCBvbiB0aGUgc3lzdGVtLiBXaGlsZSB0aGUgc3Bl
YyBtYXkgbm90IHN1ZmZpY2llbnRseQpjbGVhcmx5IGRpc3Rpbmd1aXNoIGJv
dGgga2luZHMgb2YgcmVnaW9ucywgdGhleSBhcmUgc3VyZWx5IG1lYW50IHRv
IGJlCnNlcGFyYXRlIHRoaW5nczogT25seSByZWdpb25zIHdpdGggQUNQSV9J
Vk1EX0VYQ0xVU0lPTl9SQU5HRSBzZXQgc2hvdWxkCmJlIGNhbmRpZGF0ZXMg
Zm9yIHB1dHRpbmcgaW4gdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3RlcnMu
IChBcyB0aGVyZSdzCm9ubHkgYSBzaW5nbGUgc3VjaCBwYWlyIG9mIHJlZ2lz
dGVycyBwZXIgSU9NTVUsIHNlY29uZGFyeSBub24tYWRqYWNlbnQKcmVnaW9u
cyB3aXRoIHRoZSBmbGFnIHNldCBhbHJlYWR5IGdldCBjb252ZXJ0ZWQgdG8g
dW5pdHkgbWFwcGVkCnJlZ2lvbnMuKQoKRmlyc3Qgb2YgYWxsLCBkcm9wIHRo
ZSBkZXBlbmRlbmN5IG9uIG1heF9wYWdlLiBXaXRoIGNvbW1pdCBiNGYwNDIy
MzZhZTAKKCJBTUQvSU9NTVU6IENlYXNlIHVzaW5nIGEgZHluYW1pYyBoZWln
aHQgZm9yIHRoZSBJT01NVSBwYWdldGFibGVzIikgdGhlCnVzZSBvZiBpdCBo
ZXJlIHdhcyBzdGFsZSBhbnl3YXk7IGl0IHdhcyBib2d1cyBhbHJlYWR5IGJl
Zm9yZSwgYXMgaXQKZGlkbid0IGFjY291bnQgZm9yIG1heF9wYWdlIGdldHRp
bmcgaW5jcmVhc2VkIGxhdGVyIG9uLiBTaW1wbHkgdHJ5IGFuCmV4Y2x1c2lv
biByYW5nZSByZWdpc3RyYXRpb24gZmlyc3QsIGFuZCBpZiBpdCBmYWlscyAo
Zm9yIGJlaW5nCnVuc3VpdGFibGUgb3Igbm9uLW1lcmdlYWJsZSksIHJlZ2lz
dGVyIGEgdW5pdHkgbWFwcGluZyByYW5nZS4KCldpdGggdGhpcyB2YXJpb3Vz
IGxvY2FsIHZhcmlhYmxlcyBiZWNvbWUgdW5uZWNlc3NhcnkgYW5kIGhlbmNl
IGdldApkcm9wcGVkIGF0IHRoZSBzYW1lIHRpbWUuCgpXaXRoIHRoZSBtYXhf
cGFnZSBib3VuZGFyeSBkcm9wcGVkIGZvciB1c2luZyB1bml0eSBtYXBzLCB0
aGUgbWluaW11bQpwYWdlIHRhYmxlIHRyZWUgaGVpZ2h0IG5vdyBuZWVkcyBi
b3RoIHJlY29yZGluZyBhbmQgZW5mb3JjaW5nIGluCmFtZF9pb21tdV9kb21h
aW5faW5pdCgpLiBTaW5jZSB3ZSBjYW4ndCBwcmVkaWN0IHdoaWNoIGRldmlj
ZXMgbWF5IGdldAphc3NpZ25lZCB0byBhIGRvbWFpbiwgb3VyIG9ubHkgb3B0
aW9uIGlzIHRvIHVuaWZvcm1seSBmb3JjZSBhdCBsZWFzdAp0aGF0IGhlaWdo
dCBmb3IgYWxsIGRvbWFpbnMsIG5vdyB0aGF0IHRoZSBoZWlnaHQgaXNuJ3Qg
ZHluYW1pYyBhbnltb3JlLgoKRnVydGhlciBkb24ndCBtYWtlIHVzZSBvZiB0
aGUgZXhjbHVzaW9uIHJhbmdlIHVubGVzcyBBQ1BJIGRhdGEgc2F5cyBzby4K
Ck5vdGUgdGhhdCBleGNsdXNpb24gcmFuZ2UgcmVnaXN0cmF0aW9uIGluCnJl
Z2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygpIGlzIG9uIGEgYmVzdCBl
ZmZvcnQgYmFzaXMuIEhlbmNlIHVuaXR5Cm1hcCBlbnRyaWVzIGFsc28gcmVn
aXN0ZXJlZCBhcmUgcmVkdW5kYW50IHdoZW4gdGhlIGZvcm1lciBzdWNjZWVk
ZWQsIGJ1dAp0aGV5IGFsc28gZG8gbm8gaGFybS4gSW1wcm92ZW1lbnRzIGlu
IHRoaXMgYXJlYSBjYW4gYmUgZG9uZSBsYXRlciBpbW8uCgpBbHNvIGFkanVz
dCB0eXBlcyB3aGVyZSBzdWl0YWJsZSB3aXRob3V0IHRvdWNoaW5nIGV4dHJh
IGxpbmVzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zNzguCgpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBQYXVsIER1cnJhbnQgPHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtOTks
MTIgKzk5LDggQEAgc3RhdGljIHN0cnVjdCBhbWRfaW9tbXUgKiBfX2luaXQg
ZmluZF9pbwogfQogCiBzdGF0aWMgaW50IF9faW5pdCByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZSgKLSAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSwgdWludDY0X3QgYmFzZSwgdWludDY0X3QgbGltaXQsCi0gICAgYm9vbCBh
bGwsIGJvb2wgaXcsIGJvb2wgaXIpCisgICAgc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUsIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwgYm9vbCBhbGwp
CiB7Ci0gICAgaWYgKCAhaXIgfHwgIWl3ICkKLSAgICAgICAgcmV0dXJuIC1F
UEVSTTsKLQogICAgIC8qIG5lZWQgdG8gZXh0ZW5kIGV4Y2x1c2lvbiByYW5n
ZT8gKi8KICAgICBpZiAoIGlvbW11LT5leGNsdXNpb25fZW5hYmxlICkKICAg
ICB7CkBAIC0xMzMsMTQgKzEyOSwxOCBAQCBzdGF0aWMgaW50IF9faW5pdCBy
ZXNlcnZlX3VuaXR5X21hcF9mb3JfCiB7CiAgICAgc3RydWN0IGl2cnNfbWFw
cGluZ3MgKml2cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcp
OwogICAgIHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwID0gaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcDsKKyAgICBpbnQgcGFnaW5nX21v
ZGUgPSBhbWRfaW9tbXVfZ2V0X3BhZ2luZ19tb2RlKFBGTl9VUChiYXNlICsg
bGVuZ3RoKSk7CisKKyAgICBpZiAoIHBhZ2luZ19tb2RlIDwgMCApCisgICAg
ICAgIHJldHVybiBwYWdpbmdfbW9kZTsKIAogICAgIC8qIENoZWNrIGZvciBv
dmVybGFwcy4gKi8KICAgICBmb3IgKCA7IHVuaXR5X21hcDsgdW5pdHlfbWFw
ID0gdW5pdHlfbWFwLT5uZXh0ICkKICAgICB7CiAgICAgICAgIC8qCiAgICAg
ICAgICAqIEV4YWN0IG1hdGNoZXMgYXJlIG9rYXkuIFRoaXMgY2FuIGluIHBh
cnRpY3VsYXIgaGFwcGVuIHdoZW4KLSAgICAgICAgICogcmVnaXN0ZXJfZXhj
bHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoKSBjYWxscyBoZXJlIHR3aWNlIGZv
ciB0aGUKLSAgICAgICAgICogc2FtZSAocyxiLGQsZikuCisgICAgICAgICAq
IHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2UoKSBjYWxscyBoZXJlIHR3aWNl
IGZvciB0aGUgc2FtZQorICAgICAgICAgKiAocyxiLGQsZikuCiAgICAgICAg
ICAqLwogICAgICAgICBpZiAoIGJhc2UgPT0gdW5pdHlfbWFwLT5hZGRyICYm
IGxlbmd0aCA9PSB1bml0eV9tYXAtPmxlbmd0aCAmJgogICAgICAgICAgICAg
IGlyID09IHVuaXR5X21hcC0+cmVhZCAmJiBpdyA9PSB1bml0eV9tYXAtPndy
aXRlICkKQEAgLTE2OCw1NSArMTY4LDUyIEBAIHN0YXRpYyBpbnQgX19pbml0
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl8KICAgICB1bml0eV9tYXAtPm5leHQg
PSBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwOwogICAgIGl2cnNfbWFw
cGluZ3NbYmRmXS51bml0eV9tYXAgPSB1bml0eV9tYXA7CiAKKyAgICBpZiAo
IHBhZ2luZ19tb2RlID4gYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZSApCisg
ICAgICAgIGFtZF9pb21tdV9taW5fcGFnaW5nX21vZGUgPSBwYWdpbmdfbW9k
ZTsKKwogICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IF9faW5pdCBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2FsbF9kZXZpY2VzKAotICAg
IHVuc2lnbmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCwgdTgg
aXcsIHU4IGlyKQorc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfcmFuZ2Vf
Zm9yX2FsbF9kZXZpY2VzKAorICAgIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBs
aW1pdCwgYm9vbCBpdywgYm9vbCBpciwgYm9vbCBleGNsdXNpb24pCiB7CiAg
ICAgaW50IHNlZyA9IDA7IC8qIFhYWCAqLwotICAgIHVuc2lnbmVkIGxvbmcg
cmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1k
X2lvbW11ICppb21tdTsKLSAgICB1bnNpZ25lZCBpbnQgYmRmOwogICAgIGlu
dCByYyA9IDA7CiAKICAgICAvKiBpcyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5n
ZSBpbnNpZGUgb2YgSU9NTVUgdmlydHVhbCBhZGRyZXNzIHNwYWNlPyAqLwog
ICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8g
YmUgcGFnZS1hbGlnbmVkICovCi0gICAgcmFuZ2VfdG9wID0gbGltaXQgKyBQ
QUdFX1NJWkU7Ci0gICAgaW9tbXVfdG9wID0gbWF4X3BhZ2UgKiBQQUdFX1NJ
WkU7Ci0gICAgaWYgKCBiYXNlIDwgaW9tbXVfdG9wICkKLSAgICB7Ci0gICAg
ICAgIGlmICggcmFuZ2VfdG9wID4gaW9tbXVfdG9wICkKLSAgICAgICAgICAg
IHJhbmdlX3RvcCA9IGlvbW11X3RvcDsKLSAgICAgICAgbGVuZ3RoID0gcmFu
Z2VfdG9wIC0gYmFzZTsKLSAgICAgICAgLyogcmVzZXJ2ZSByL3cgdW5pdHkt
bWFwcGVkIHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAqLwotICAgICAgICAv
KiBub3RlOiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNp
b24gcmFuZ2UgKi8KLSAgICAgICAgZm9yICggYmRmID0gMDsgIXJjICYmIGJk
ZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKLSAgICAgICAgICAgIHJj
ID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFz
ZSwgbGVuZ3RoLCBpdywgaXIpOwotICAgICAgICAvKiBwdXNoICdiYXNlJyBq
dXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCi0gICAg
ICAgIGJhc2UgPSBpb21tdV90b3A7Ci0gICAgfQotICAgIC8qIHJlZ2lzdGVy
IElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwotICAgIGlmICgg
IXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCApCisgICAgaWYgKCBleGNsdXNp
b24gKQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBpb21t
dSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21t
dV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVl
IC8qIGFsbCAqLywgaXcsIGlyKTsKLSAgICAgICAgICAgIGlmICggcmMgKQot
ICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgaW50IHJldCA9
IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBs
aW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0cnVlIC8qIGFsbCAqLyk7CisKKyAgICAgICAgICAg
IGlmICggcmV0ICYmICFyYyApCisgICAgICAgICAgICAgICAgcmMgPSByZXQ7
CiAgICAgICAgIH0KICAgICB9CiAKKyAgICBpZiAoICFleGNsdXNpb24gfHwg
cmMgKQorICAgIHsKKyAgICAgICAgcGFkZHJfdCBsZW5ndGggPSBsaW1pdCAr
IFBBR0VfU0laRSAtIGJhc2U7CisgICAgICAgIHVuc2lnbmVkIGludCBiZGY7
CisKKyAgICAgICAgLyogcmVzZXJ2ZSByL3cgdW5pdHktbWFwcGVkIHBhZ2Ug
ZW50cmllcyBmb3IgZGV2aWNlcyAqLworICAgICAgICBmb3IgKCBiZGYgPSBy
YyA9IDA7ICFyYyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyAp
CisgICAgICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZp
Y2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsKKyAgICB9CisK
ICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IHJlZ2lz
dGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfZGV2aWNlKAotICAgIHUxNiBiZGYs
IHVuc2lnbmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCwgdTgg
aXcsIHU4IGlyKQorc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfcmFuZ2Vf
Zm9yX2RldmljZSgKKyAgICB1bnNpZ25lZCBpbnQgYmRmLCBwYWRkcl90IGJh
c2UsIHBhZGRyX3QgbGltaXQsCisgICAgYm9vbCBpdywgYm9vbCBpciwgYm9v
bCBleGNsdXNpb24pCiB7CiAgICAgaW50IHNlZyA9IDA7IC8qIFhYWCAqLwog
ICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX21hcHBpbmdzID0gZ2V0
X2l2cnNfbWFwcGluZ3Moc2VnKTsKLSAgICB1bnNpZ25lZCBsb25nIHJhbmdl
X3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7CiAgICAgc3RydWN0IGFtZF9pb21t
dSAqaW9tbXU7CiAgICAgdTE2IHJlcTsKICAgICBpbnQgcmMgPSAwOwpAQCAt
MjMwLDI3ICsyMjcsMTkgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJf
ZXhjbHVzaW9uX3JhbgogICAgIHJlcSA9IGl2cnNfbWFwcGluZ3NbYmRmXS5k
dGVfcmVxdWVzdG9yX2lkOwogCiAgICAgLyogbm90ZTogJ2xpbWl0JyBwYXJh
bWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWduZWQgKi8KLSAgICBy
YW5nZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsKLSAgICBpb21tdV90b3Ag
PSBtYXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBpZiAoIGJhc2UgPCBpb21t
dV90b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCByYW5nZV90b3AgPiBpb21t
dV90b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9wID0gaW9tbXVfdG9wOwot
ICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOworICAgIGlmICgg
ZXhjbHVzaW9uICkKKyAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgLyogYWxsICov
KTsKKyAgICBpZiAoICFleGNsdXNpb24gfHwgcmMgKQorICAgIHsKKyAgICAg
ICAgcGFkZHJfdCBsZW5ndGggPSBsaW1pdCArIFBBR0VfU0laRSAtIGJhc2U7
CisKICAgICAgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRy
aWVzIGZvciBkZXZpY2UgKi8KLSAgICAgICAgLyogbm90ZTogdGhlc2UgZW50
cmllcyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCiAgICAg
ICAgIHJjID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJk
ZiwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpID86CiAgICAgICAgICAgICAgcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIHJlcSwgYmFzZSwgbGVu
Z3RoLCBpdywgaXIpOwotCi0gICAgICAgIC8qIHB1c2ggJ2Jhc2UnIGp1c3Qg
b3V0c2lkZSBvZiB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2UgKi8KLSAgICAgICAg
YmFzZSA9IGlvbW11X3RvcDsKICAgICB9Ci0KLSAgICAvKiByZWdpc3RlciBJ
T01NVSBleGNsdXNpb24gcmFuZ2Ugc2V0dGluZ3MgZm9yIGRldmljZSAqLwot
ICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCAgKQorICAgIGVs
c2UKICAgICB7Ci0gICAgICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNp
b25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlIC8qIGFsbCAqLywg
aXcsIGlyKTsKICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmR0ZV9hbGxv
d19leGNsdXNpb24gPSBJT01NVV9DT05UUk9MX0VOQUJMRUQ7CiAgICAgICAg
IGl2cnNfbWFwcGluZ3NbcmVxXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gSU9N
TVVfQ09OVFJPTF9FTkFCTEVEOwogICAgIH0KQEAgLTI1OCw1MyArMjQ3LDQy
IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4K
ICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IHJlZ2lz
dGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfaW9tbXVfZGV2aWNlcygKLSAgICBz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICB1bnNpZ25lZCBsb25nIGJh
c2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3LCB1OCBpcikKK3N0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX3JhbmdlX2Zvcl9pb21tdV9kZXZpY2Vz
KAorICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCBwYWRkcl90IGJhc2Us
IHBhZGRyX3QgbGltaXQsCisgICAgYm9vbCBpdywgYm9vbCBpciwgYm9vbCBl
eGNsdXNpb24pCiB7Ci0gICAgdW5zaWduZWQgbG9uZyByYW5nZV90b3AsIGlv
bW11X3RvcCwgbGVuZ3RoOworICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1l
dGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICovCisgICAgcGFk
ZHJfdCBsZW5ndGggPSBsaW1pdCArIFBBR0VfU0laRSAtIGJhc2U7CiAgICAg
dW5zaWduZWQgaW50IGJkZjsKICAgICB1MTYgcmVxOwotICAgIGludCByYyA9
IDA7CisgICAgaW50IHJjOwogCi0gICAgLyogaXMgcGFydCBvZiBleGNsdXNp
b24gcmFuZ2UgaW5zaWRlIG9mIElPTU1VIHZpcnR1YWwgYWRkcmVzcyBzcGFj
ZT8gKi8KLSAgICAvKiBub3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1
bWVkIHRvIGJlIHBhZ2UtYWxpZ25lZCAqLwotICAgIHJhbmdlX3RvcCA9IGxp
bWl0ICsgUEFHRV9TSVpFOwotICAgIGlvbW11X3RvcCA9IG1heF9wYWdlICog
UEFHRV9TSVpFOwotICAgIGlmICggYmFzZSA8IGlvbW11X3RvcCApCi0gICAg
ewotICAgICAgICBpZiAoIHJhbmdlX3RvcCA+IGlvbW11X3RvcCApCi0gICAg
ICAgICAgICByYW5nZV90b3AgPSBpb21tdV90b3A7Ci0gICAgICAgIGxlbmd0
aCA9IHJhbmdlX3RvcCAtIGJhc2U7Ci0gICAgICAgIC8qIHJlc2VydmUgci93
IHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZXMgKi8KLSAg
ICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUg
ZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIGZvciAoIGJkZiA9IDA7ICFy
YyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCi0gICAgICAg
IHsKLSAgICAgICAgICAgIGlmICggaW9tbXUgPT0gZmluZF9pb21tdV9mb3Jf
ZGV2aWNlKGlvbW11LT5zZWcsIGJkZikgKQotICAgICAgICAgICAgewotICAg
ICAgICAgICAgICAgIHJlcSA9IGdldF9pdnJzX21hcHBpbmdzKGlvbW11LT5z
ZWcpW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZDsKLSAgICAgICAgICAgICAgICBy
YyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywg
YmRmLCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcikgPzoKLSAgICAgICAg
ICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9t
bXUtPnNlZywgcmVxLCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcik7Ci0g
ICAgICAgICAgICB9Ci0gICAgICAgIH0KLQotICAgICAgICAvKiBwdXNoICdi
YXNlJyBqdXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICov
Ci0gICAgICAgIGJhc2UgPSBpb21tdV90b3A7CisgICAgaWYgKCBleGNsdXNp
b24gKQorICAgIHsKKyAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsIHRydWUgLyogYWxsICov
KTsKKyAgICAgICAgaWYgKCAhcmMgKQorICAgICAgICAgICAgcmV0dXJuIDA7
CiAgICAgfQogCi0gICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJh
bmdlIHNldHRpbmdzICovCi0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9t
bXVfdG9wICkKLSAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lv
bl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3
LCBpcik7CisgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRy
aWVzIGZvciBkZXZpY2VzICovCisgICAgZm9yICggYmRmID0gcmMgPSAwOyAh
cmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysgKQorICAgIHsK
KyAgICAgICAgaWYgKCBpb21tdSAhPSBmaW5kX2lvbW11X2Zvcl9kZXZpY2Uo
aW9tbXUtPnNlZywgYmRmKSApCisgICAgICAgICAgICBjb250aW51ZTsKKwor
ICAgICAgICByZXEgPSBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVti
ZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7CisgICAgICAgIHJjID0gcmVzZXJ2ZV91
bml0eV9tYXBfZm9yX2RldmljZShpb21tdS0+c2VnLCBiZGYsIGJhc2UsIGxl
bmd0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGl3LCBpcikgPzoKKyAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21h
cF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcs
IGlyKTsKKyAgICB9CiAKICAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBp
bnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdCgKICAgICBjb25z
dCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9jaywKLSAgICB1
bnNpZ25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3
LCB1OCBpcikKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGltaXQsIGJv
b2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewogICAgIHUxNiBi
ZGY7CiAKQEAgLTMxNSwxMiArMjkzLDEyIEBAIHN0YXRpYyBpbnQgX19pbml0
IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGUKICAgICAgICAgcmV0dXJuIC1FTk9E
RVY7CiAgICAgfQogCi0gICAgcmV0dXJuIHJlZ2lzdGVyX2V4Y2x1c2lvbl9y
YW5nZV9mb3JfZGV2aWNlKGJkZiwgYmFzZSwgbGltaXQsIGl3LCBpcik7Cisg
ICAgcmV0dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2UoYmRmLCBiYXNl
LCBsaW1pdCwgaXcsIGlyLCBleGNsdXNpb24pOwogfQogCiBzdGF0aWMgaW50
IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9yYW5nZSgKICAgICBjb25zdCBz
dHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9jaywKLSAgICB1bnNp
Z25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3LCB1
OCBpcikKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGltaXQsIGJvb2wg
aXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewogICAgIHVuc2lnbmVk
IGludCBmaXJzdF9iZGYsIGxhc3RfYmRmLCBiZGY7CiAgICAgaW50IGVycm9y
OwpAQCAtMzQyLDE1ICszMjAsMTUgQEAgc3RhdGljIGludCBfX2luaXQgcGFy
c2VfaXZtZF9kZXZpY2VfcmFuZwogICAgIH0KIAogICAgIGZvciAoIGJkZiA9
IGZpcnN0X2JkZiwgZXJyb3IgPSAwOyAoYmRmIDw9IGxhc3RfYmRmKSAmJiAh
ZXJyb3I7IGJkZisrICkKLSAgICAgICAgZXJyb3IgPSByZWdpc3Rlcl9leGNs
dXNpb25fcmFuZ2VfZm9yX2RldmljZSgKLSAgICAgICAgICAgIGJkZiwgYmFz
ZSwgbGltaXQsIGl3LCBpcik7CisgICAgICAgIGVycm9yID0gcmVnaXN0ZXJf
cmFuZ2VfZm9yX2RldmljZSgKKyAgICAgICAgICAgIGJkZiwgYmFzZSwgbGlt
aXQsIGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIHJldHVybiBlcnJvcjsK
IH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZtZF9kZXZpY2VfaW9t
bXUoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19tZW1vcnkgKml2bWRf
YmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25n
IGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJfdCBiYXNlLCBwYWRk
cl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikK
IHsKICAgICBpbnQgc2VnID0gMDsgLyogWFhYICovCiAgICAgc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXU7CkBAIC0zNjUsMTQgKzM0MywxNCBAQCBzdGF0aWMg
aW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9pb21tCiAgICAgICAgIHJl
dHVybiAtRU5PREVWOwogICAgIH0KIAotICAgIHJldHVybiByZWdpc3Rlcl9l
eGNsdXNpb25fcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCi0gICAgICAgIGlv
bW11LCBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICByZXR1cm4gcmVnaXN0
ZXJfcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCisgICAgICAgIGlvbW11LCBi
YXNlLCBsaW1pdCwgaXcsIGlyLCBleGNsdXNpb24pOwogfQogCiBzdGF0aWMg
aW50IF9faW5pdCBwYXJzZV9pdm1kX2Jsb2NrKGNvbnN0IHN0cnVjdCBhY3Bp
X2l2cnNfbWVtb3J5ICppdm1kX2Jsb2NrKQogewogICAgIHVuc2lnbmVkIGxv
bmcgc3RhcnRfYWRkciwgbWVtX2xlbmd0aCwgYmFzZSwgbGltaXQ7Ci0gICAg
dTggaXcsIGlyOworICAgIGJvb2wgaXcgPSB0cnVlLCBpciA9IHRydWUsIGV4
Y2x1c2lvbiA9IGZhbHNlOwogCiAgICAgaWYgKCBpdm1kX2Jsb2NrLT5oZWFk
ZXIubGVuZ3RoIDwgc2l6ZW9mKCppdm1kX2Jsb2NrKSApCiAgICAgewpAQCAt
Mzg5LDEzICszNjcsMTEgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZt
ZF9ibG9jayhjb25zdAogICAgICAgICAgICAgICAgICAgICBpdm1kX2Jsb2Nr
LT5oZWFkZXIudHlwZSwgc3RhcnRfYWRkciwgbWVtX2xlbmd0aCk7CiAKICAg
ICBpZiAoIGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElfSVZNRF9F
WENMVVNJT05fUkFOR0UgKQotICAgICAgICBpdyA9IGlyID0gSU9NTVVfQ09O
VFJPTF9FTkFCTEVEOworICAgICAgICBleGNsdXNpb24gPSB0cnVlOwogICAg
IGVsc2UgaWYgKCBpdm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lW
TURfVU5JVFkgKQogICAgIHsKLSAgICAgICAgaXcgPSBpdm1kX2Jsb2NrLT5o
ZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfUkVBRCA/Ci0gICAgICAgICAgICBJ
T01NVV9DT05UUk9MX0VOQUJMRUQgOiBJT01NVV9DT05UUk9MX0RJU0FCTEVE
OwotICAgICAgICBpciA9IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFD
UElfSVZNRF9XUklURSA/Ci0gICAgICAgICAgICBJT01NVV9DT05UUk9MX0VO
QUJMRUQgOiBJT01NVV9DT05UUk9MX0RJU0FCTEVEOworICAgICAgICBpdyA9
IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElfSVZNRF9SRUFEOwor
ICAgICAgICBpciA9IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElf
SVZNRF9XUklURTsKICAgICB9CiAgICAgZWxzZQogICAgIHsKQEAgLTQwNiwy
MCArMzgyLDIwIEBAIHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfYmxv
Y2soY29uc3QKICAgICBzd2l0Y2goIGl2bWRfYmxvY2stPmhlYWRlci50eXBl
ICkKICAgICB7CiAgICAgY2FzZSBBQ1BJX0lWUlNfVFlQRV9NRU1PUllfQUxM
OgotICAgICAgICByZXR1cm4gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zv
cl9hbGxfZGV2aWNlcygKLSAgICAgICAgICAgIGJhc2UsIGxpbWl0LCBpdywg
aXIpOworICAgICAgICByZXR1cm4gcmVnaXN0ZXJfcmFuZ2VfZm9yX2FsbF9k
ZXZpY2VzKAorICAgICAgICAgICAgYmFzZSwgbGltaXQsIGl3LCBpciwgZXhj
bHVzaW9uKTsKIAogICAgIGNhc2UgQUNQSV9JVlJTX1RZUEVfTUVNT1JZX09O
RToKLSAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdChp
dm1kX2Jsb2NrLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAgICAgICByZXR1cm4g
cGFyc2VfaXZtZF9kZXZpY2Vfc2VsZWN0KGl2bWRfYmxvY2ssIGJhc2UsIGxp
bWl0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIGNhc2UgQUNQSV9JVlJTX1RZ
UEVfTUVNT1JZX1JBTkdFOgotICAgICAgICByZXR1cm4gcGFyc2VfaXZtZF9k
ZXZpY2VfcmFuZ2UoaXZtZF9ibG9jaywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAg
ICAgICByZXR1cm4gcGFyc2VfaXZtZF9kZXZpY2VfcmFuZ2UoaXZtZF9ibG9j
aywgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBjYXNlIEFD
UElfSVZSU19UWVBFX01FTU9SWV9JT01NVToKLSAgICAgICAgcmV0dXJuIHBh
cnNlX2l2bWRfZGV2aWNlX2lvbW11KGl2bWRfYmxvY2ssCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLCBsaW1pdCwgaXcs
IGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX2lvbW11
KGl2bWRfYmxvY2ssIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaXcsIGlyLCBleGNsdXNpb24pOwogCiAg
ICAgZGVmYXVsdDoKICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJJVk1EIEVy
cm9yOiBJbnZhbGlkIEJsb2NrIFR5cGUhXG4iKTsKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0y
MTgsNiArMjE4LDggQEAgc3RhdGljIGludCBfX211c3RfY2hlY2sgYWxsb2Nh
dGVfZG9tYWluXwogICAgIHJldHVybiByYzsKIH0KIAoraW50IF9fcmVhZF9t
b3N0bHkgYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZSA9IDE7CisKIHN0YXRp
YyBpbnQgYW1kX2lvbW11X2RvbWFpbl9pbml0KHN0cnVjdCBkb21haW4gKmQp
CiB7CiAgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUo
ZCk7CkBAIC0yMjksMTEgKzIzMSwxMyBAQCBzdGF0aWMgaW50IGFtZF9pb21t
dV9kb21haW5faW5pdChzdHJ1Y3QKICAgICAgKiAtIEhWTSBjb3VsZCBpbiBw
cmluY2lwbGUgdXNlIDMgb3IgNCBkZXBlbmRpbmcgb24gaG93IG11Y2ggZ3Vl
c3QKICAgICAgKiAgIHBoeXNpY2FsIGFkZHJlc3Mgc3BhY2Ugd2UgZ2l2ZSBp
dCwgYnV0IHRoaXMgaXNuJ3Qga25vd24geWV0IHNvIHVzZSA0CiAgICAgICog
ICB1bmlsYXRlcmFsbHkuCisgICAgICogLSBVbml0eSBtYXBzIG1heSByZXF1
aXJlIGFuIGV2ZW4gaGlnaGVyIG51bWJlci4KICAgICAgKi8KLSAgICBoZC0+
YXJjaC5wYWdpbmdfbW9kZSA9IGFtZF9pb21tdV9nZXRfcGFnaW5nX21vZGUo
Ci0gICAgICAgIGlzX2h2bV9kb21haW4oZCkKLSAgICAgICAgPyAxdWwgPDwg
KERFRkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEggLSBQQUdFX1NISUZUKQot
ICAgICAgICA6IGdldF91cHBlcl9tZm5fYm91bmQoKSArIDEpOworICAgIGhk
LT5hcmNoLnBhZ2luZ19tb2RlID0gbWF4KGFtZF9pb21tdV9nZXRfcGFnaW5n
X21vZGUoCisgICAgICAgICAgICBpc19odm1fZG9tYWluKGQpCisgICAgICAg
ICAgICA/IDF1bCA8PCAoREVGQVVMVF9ET01BSU5fQUREUkVTU19XSURUSCAt
IFBBR0VfU0hJRlQpCisgICAgICAgICAgICA6IGdldF91cHBlcl9tZm5fYm91
bmQoKSArIDEpLAorICAgICAgICBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2Rl
KTsKIAogICAgIHJldHVybiAwOwogfQotLS0gYS94ZW4vaW5jbHVkZS9hc20t
eDg2L2h2bS9zdm0vYW1kLWlvbW11LXByb3RvLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21tdS1wcm90by5oCkBAIC0xMjYs
NiArMTI2LDggQEAgZXh0ZXJuIHN0cnVjdCBocGV0X3NiZGYgewogICAgIH0g
aW5pdDsKIH0gaHBldF9zYmRmOwogCitleHRlcm4gaW50IGFtZF9pb21tdV9t
aW5fcGFnaW5nX21vZGU7CisKIGV4dGVybiB2b2lkICpzaGFyZWRfaW50cmVt
YXBfdGFibGU7CiBleHRlcm4gdW5zaWduZWQgbG9uZyAqc2hhcmVkX2ludHJl
bWFwX2ludXNlOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-7.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-7.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBpbnRyb2R1Y2UgcDJtX2lzX3NwZWNpYWwoKQoKU2VlaW5n
IHRoZSBzaW1pbGFyaXR5IG9mIGdyYW50LCBmb3JlaWduLCBhbmQgKHN1YnNl
cXVlbnRseSkgZGlyZWN0LU1NSU8KaGFuZGxpbmcsIGludHJvZHVjZSBhIG5l
dyBQMk0gdHlwZSBncm91cCBuYW1lZCAic3BlY2lhbCIgKGFzIGluICJuZWVk
aW5nCnNwZWNpYWwgYWNjZXNzb3JzIHRvIGNyZWF0ZS9kZXN0cm95IikuCgpB
bHNvIHVzZSAtRVBFUk0gaW5zdGVhZCBvZiBvdGhlciBlcnJvciBjb2RlcyBv
biB0aGUgdHdvIGRvbWFpbl9jcmFzaCgpCnBhdGhzIHRvdWNoZWQuCgpUaGlz
IGlzIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtNzM2LDcgKzcz
Niw3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJt
LAogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRl
cik7IGkrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOwotICAgICAgICAgICAgaWYgKCAhcDJtX2lzX2dyYW50KHQpICYmICFw
Mm1faXNfc2hhcmVkKHQpICYmICFwMm1faXNfZm9yZWlnbih0KSApCisgICAg
ICAgICAgICBpZiAoICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3No
YXJlZCh0KSApCiAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4o
bWZuK2ksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAgfQogICAgIH0K
QEAgLTg0OCwxMyArODQ4LDEzIEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5
KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKICAgICAgICAgICAg
IEFTU0VSVCghcDJtX2lzX3NoYXJlZChvdCkpOwogICAgICAgICB9Ci0gICAg
ICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1faXNfZm9yZWlnbihv
dCkgKQorICAgICAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90KSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIC8qIFJlYWxseSBzaG91bGRuJ3QgYmUgdW5t
YXBwaW5nIGdyYW50L2ZvcmVpZ24gbWFwcyB0aGlzIHdheSAqLworICAgICAg
ICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9mb3JlaWdu
IHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwog
ICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAgICAgICAgCi0g
ICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAgICAgIHJldHVy
biAtRVBFUk07CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHAybV9p
c19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKICAgICAgICAgewpA
QCAtOTQ3LDggKzk0Nyw3IEBAIGludCBwMm1fY2hhbmdlX3R5cGVfb25lKHN0
cnVjdCBkb21haW4gKmQKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtID0g
cDJtX2dldF9ob3N0cDJtKGQpOwogICAgIGludCByYzsKIAotICAgIEJVR19P
TihwMm1faXNfZ3JhbnQob3QpIHx8IHAybV9pc19ncmFudChudCkpOwotICAg
IEJVR19PTihwMm1faXNfZm9yZWlnbihvdCkgfHwgcDJtX2lzX2ZvcmVpZ24o
bnQpKTsKKyAgICBCVUdfT04ocDJtX2lzX3NwZWNpYWwob3QpIHx8IHAybV9p
c19zcGVjaWFsKG50KSk7CiAKICAgICBnZm5fbG9jayhwMm0sIGdmbiwgMCk7
CiAKQEAgLTEwOTEsMTEgKzEwOTAsMTEgQEAgc3RhdGljIGludCBzZXRfdHlw
ZWRfcDJtX2VudHJ5KHN0cnVjdCBkbwogICAgICAgICBnZm5fdW5sb2NrKHAy
bSwgZ2ZuLCBvcmRlcik7CiAgICAgICAgIHJldHVybiBjdXJfb3JkZXIgKyAx
OwogICAgIH0KLSAgICBpZiAoIHAybV9pc19ncmFudChvdCkgfHwgcDJtX2lz
X2ZvcmVpZ24ob3QpICkKKyAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90KSAp
CiAgICAgewogICAgICAgICBnZm5fdW5sb2NrKHAybSwgZ2ZuLCBvcmRlcik7
CiAgICAgICAgIGRvbWFpbl9jcmFzaChkKTsKLSAgICAgICAgcmV0dXJuIC1F
Tk9FTlQ7CisgICAgICAgIHJldHVybiAtRVBFUk07CiAgICAgfQogICAgIGVs
c2UgaWYgKCBwMm1faXNfcmFtKG90KSApCiAgICAgewotLS0gYS94ZW4vaW5j
bHVkZS9hc20teDg2L3AybS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYv
cDJtLmgKQEAgLTE0Miw2ICsxNDIsMTAgQEAgdHlwZWRlZiB1bnNpZ25lZCBp
bnQgcDJtX3F1ZXJ5X3Q7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCBwMm1fdG9fbWFzayhwMm1fcmFtX2xvZ2RpcnR5KSApCiAjZGVmaW5lIFAy
TV9TSEFSRURfVFlQRVMgICAocDJtX3RvX21hc2socDJtX3JhbV9zaGFyZWQp
KQogCisvKiBUeXBlcyBlc3RhYmxpc2hlZC9jbGVhbmVkIHVwIHZpYSBzcGVj
aWFsIGFjY2Vzc29ycy4gKi8KKyNkZWZpbmUgUDJNX1NQRUNJQUxfVFlQRVMg
KFAyTV9HUkFOVF9UWVBFUyB8IFwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHAybV90b19tYXNrKHAybV9tYXBfZm9yZWlnbikpCisKIC8qIFZhbGlk
IHR5cGVzIG5vdCBuZWNlc3NhcmlseSBhc3NvY2lhdGVkIHdpdGggYSAodmFs
aWQpIE1GTi4gKi8KICNkZWZpbmUgUDJNX0lOVkFMSURfTUZOX1RZUEVTIChQ
Mk1fUE9EX1RZUEVTICAgICAgICAgICAgICAgICAgXAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgcDJtX3RvX21hc2socDJtX21taW9fZGly
ZWN0KSBcCkBAIC0xNzAsNiArMTc0LDcgQEAgdHlwZWRlZiB1bnNpZ25lZCBp
bnQgcDJtX3F1ZXJ5X3Q7CiAjZGVmaW5lIHAybV9pc19wYWdlZChfdCkgICAg
KHAybV90b19tYXNrKF90KSAmIFAyTV9QQUdFRF9UWVBFUykKICNkZWZpbmUg
cDJtX2lzX3NoYXJhYmxlKF90KSAocDJtX3RvX21hc2soX3QpICYgUDJNX1NI
QVJBQkxFX1RZUEVTKQogI2RlZmluZSBwMm1faXNfc2hhcmVkKF90KSAgIChw
Mm1fdG9fbWFzayhfdCkgJiBQMk1fU0hBUkVEX1RZUEVTKQorI2RlZmluZSBw
Mm1faXNfc3BlY2lhbChfdCkgIChwMm1fdG9fbWFzayhfdCkgJiBQMk1fU1BF
Q0lBTF9UWVBFUykKICNkZWZpbmUgcDJtX2lzX2Jyb2tlbihfdCkgICAocDJt
X3RvX21hc2soX3QpICYgUDJNX0JST0tFTl9UWVBFUykKICNkZWZpbmUgcDJt
X2lzX2ZvcmVpZ24oX3QpICAocDJtX3RvX21hc2soX3QpICYgcDJtX3RvX21h
c2socDJtX21hcF9mb3JlaWduKSkKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.11-8.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.11-8.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBndWFyZCAoaW4gcGFydGljdWxhcikgaWRlbnRpdHkgbWFw
cGluZyBlbnRyaWVzCgpTdWNoIGVudHJpZXMsIGNyZWF0ZWQgYnkgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpLCBzaG91bGQgb25seSBiZQpkZXN0cm95ZWQg
YnkgY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KCkuIEhvd2V2ZXIsIHNpbWls
YXJseSwgZW50cmllcwpjcmVhdGVkIGJ5IHNldF9tbWlvX3AybV9lbnRyeSgp
IHNob3VsZCBvbmx5IGJlIHRvcm4gZG93biBieQpjbGVhcl9tbWlvX3AybV9l
bnRyeSgpLCBzbyB0aGUgbG9naWMgZ2V0cyBiYXNlZCB1cG9uIHAybV9tbWlv
X2RpcmVjdCBhcwp0aGUgZW50cnkgdHlwZSAoc2VwYXJhdGlvbiBiZXR3ZWVu
ICJvcmRpbmFyeSIgYW5kIDE6MSBtYXBwaW5ncyB3b3VsZApyZXF1aXJlIGEg
ZnVydGhlciBpbmRpY2F0b3IgdG8gdGVsbCBhcGFydCB0aGUgdHdvKS4KCkFz
IHRvIHRoZSBndWVzdF9yZW1vdmVfcGFnZSgpIGNoYW5nZSwgY29tbWl0IDQ4
ZGZiMjk3YTIwYSAoIng4Ni9QVkg6CmFsbG93IGd1ZXN0X3JlbW92ZV9wYWdl
IHRvIHJlbW92ZSBwMm1fbW1pb19kaXJlY3QgcGFnZXMiKSwgd2hpY2gKaW50
cm9kdWNlZCB0aGUgY2FsbCB0byBjbGVhcl9tbWlvX3AybV9lbnRyeSgpLCBj
bGFpbWVkIHRoaXMgd2FzIGRvbmUgZm9yCmh3ZG9tIG9ubHkgd2l0aG91dCB0
aGlzIGFjdHVhbGx5IGhhdmluZyBiZWVuIHRoZSBjYXNlLiBIb3dldmVyLCB0
aGlzCmNvZGUgc2hvdWxkbid0IGJlIHRoZXJlIGluIHRoZSBmaXJzdCBwbGFj
ZSwgYXMgTU1JTyBlbnRyaWVzIHNob3VsZG4ndCBiZQpkcm9wcGVkIHRoaXMg
d2F5LiBBdm9pZCB0cmlnZ2VyaW5nIHRoZSB3YXJuaW5nIGFnYWluIHRoYXQg
NDhkZmIyOTdhMjBhCnNpbGVuY2VkIGJ5IGFuIGFkanVzdG1lbnQgdG8geGVu
bWVtX2FkZF90b19waHlzbWFwX29uZSgpIGluc3RlYWQuCgpOb3RlIHRoYXQg
Z3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZCgpIGdldHMg
dGlnaHRlbmVkIGJleW9uZAp0aGUgaW1tZWRpYXRlIHB1cnBvc2Ugb2YgdGhp
cyBjaGFuZ2UuCgpOb3RlIGFsc28gdGhhdCBJIGRpZG4ndCBpbnNwZWN0IGNv
ZGUgd2hpY2ggaXNuJ3Qgc2VjdXJpdHkgc3VwcG9ydGVkLAplLmcuIHNoYXJp
bmcsIHBhZ2luZywgb3IgYWx0cDJtLgoKVGhpcyBpcyBDVkUtMjAyMS0yODY5
NCAvIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tLmMK
KysrIGIveGVuL2FyY2gveDg2L21tLmMKQEAgLTQ3ODMsNyArNDc4Myw5IEBA
IGludCB4ZW5tZW1fYWRkX3RvX3BoeXNtYXBfb25lKAogCiAgICAgLyogUmVt
b3ZlIHByZXZpb3VzbHkgbWFwcGVkIHBhZ2UgaWYgaXQgd2FzIHByZXNlbnQu
ICovCiAgICAgcHJldl9tZm4gPSBtZm5feChnZXRfZ2ZuKGQsIGdmbl94KGdw
Zm4pLCAmcDJtdCkpOwotICAgIGlmICggbWZuX3ZhbGlkKF9tZm4ocHJldl9t
Zm4pKSApCisgICAgaWYgKCBwMm10ID09IHAybV9tbWlvX2RpcmVjdCApCisg
ICAgICAgIHJjID0gLUVQRVJNOworICAgIGVsc2UgaWYgKCBtZm5fdmFsaWQo
X21mbihwcmV2X21mbikpICkKICAgICB7CiAgICAgICAgIGlmICggaXNfeGVu
X2hlYXBfbWZuKHByZXZfbWZuKSApCiAgICAgICAgICAgICAvKiBYZW4gaGVh
cCBmcmFtZXMgYXJlIHNpbXBseSB1bmhvb2tlZCBmcm9tIHRoaXMgcGh5cyBz
bG90LiAqLwotLS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVu
L2FyY2gveDg2L21tL3AybS5jCkBAIC03MjUsNyArNzI1LDggQEAgcDJtX3Jl
bW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY3VyX29yZGVyLCBO
VUxMKTsKIAogICAgICAgICBpZiAoIHAybV9pc192YWxpZCh0KSAmJgotICAg
ICAgICAgICAgICghbWZuX3ZhbGlkKF9tZm4obWZuKSkgfHwgbWZuICsgaSAh
PSBtZm5feChtZm5fcmV0dXJuKSkgKQorICAgICAgICAgICAgICghbWZuX3Zh
bGlkKF9tZm4obWZuKSkgfHwgdCA9PSBwMm1fbW1pb19kaXJlY3QgfHwKKyAg
ICAgICAgICAgICAgbWZuICsgaSAhPSBtZm5feChtZm5fcmV0dXJuKSkgKQog
ICAgICAgICAgICAgcmV0dXJuIC1FSUxTRVE7CiAKICAgICAgICAgaSArPSAo
MVVMIDw8IGN1cl9vcmRlcikgLSAoKGdmbl9sICsgaSkgJiAoKDFVTCA8PCBj
dXJfb3JkZXIpIC0gMSkpOwpAQCAtODAzLDcgKzgwNCw3IEBAIGd1ZXN0X3Bo
eXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICBpZiAoIHAy
bV9pc19mb3JlaWduKHQpICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAK
LSAgICBpZiAoICFtZm5fdmFsaWQobWZuKSApCisgICAgaWYgKCAhbWZuX3Zh
bGlkKG1mbikgfHwgdCA9PSBwMm1fbW1pb19kaXJlY3QgKQogICAgIHsKICAg
ICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgIHJldHVybiAt
RUlOVkFMOwpAQCAtODUwLDcgKzg1MSw3IEBAIGd1ZXN0X3BoeXNtYXBfYWRk
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgfQogICAgICAgICBp
ZiAoIHAybV9pc19zcGVjaWFsKG90KSApCiAgICAgICAgIHsKLSAgICAgICAg
ICAgIC8qIERvbid0IHBlcm1pdCB1bm1hcHBpbmcgZ3JhbnQvZm9yZWlnbiB0
aGlzIHdheS4gKi8KKyAgICAgICAgICAgIC8qIERvbid0IHBlcm1pdCB1bm1h
cHBpbmcgZ3JhbnQvZm9yZWlnbi9kaXJlY3QtTU1JTyB0aGlzIHdheS4gKi8K
ICAgICAgICAgICAgIGRvbWFpbl9jcmFzaChkKTsKICAgICAgICAgICAgIHAy
bV91bmxvY2socDJtKTsKICAgICAgICAgICAgIApAQCAtMTE5Miw4ICsxMTkz
LDggQEAgaW50IHNldF9pZGVudGl0eV9wMm1fZW50cnkoc3RydWN0IGRvbWFp
bgogICogICAgb3JkZXIrMSAgZm9yIGNhbGxlciB0byByZXRyeSB3aXRoIG9y
ZGVyIChndWFyYW50ZWVkIHNtYWxsZXIgdGhhbgogICogICAgICAgICAgICAg
dGhlIG9yZGVyIHZhbHVlIHBhc3NlZCBpbikKICAqLwotaW50IGNsZWFyX21t
aW9fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcg
Z2ZuX2wsIG1mbl90IG1mbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgb3JkZXIpCitzdGF0aWMgaW50IGNsZWFyX21taW9fcDJt
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuX2ws
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90IG1mbiwg
dW5zaWduZWQgaW50IG9yZGVyKQogewogICAgIGludCByYyA9IC1FSU5WQUw7
CiAgICAgZ2ZuX3QgZ2ZuID0gX2dmbihnZm5fbCk7Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS9wMm0tcG9kLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1w
b2QuYwpAQCAtMTMwMiwxNyArMTMwMiwxNyBAQCBndWVzdF9waHlzbWFwX21h
cmtfcG9wdWxhdGVfb25fZGVtYW5kKHN0CiAKICAgICAgICAgcDJtLT5nZXRf
ZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZvdCwgJmEsIDAsICZjdXJf
b3JkZXIsIE5VTEwpOwogICAgICAgICBuID0gMVVMIDw8IG1pbihvcmRlciwg
Y3VyX29yZGVyKTsKLSAgICAgICAgaWYgKCBwMm1faXNfcmFtKG90KSApCisg
ICAgICAgIGlmICggb3QgPT0gcDJtX3BvcHVsYXRlX29uX2RlbWFuZCApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qIENvdW50IGhvdyBtYW55IFBvRCBl
bnRyaWVzIHdlJ2xsIGJlIHJlcGxhY2luZyBpZiBzdWNjZXNzZnVsICovCisg
ICAgICAgICAgICBwb2RfY291bnQgKz0gbjsKKyAgICAgICAgfQorICAgICAg
ICBlbHNlIGlmICggb3QgIT0gcDJtX2ludmFsaWQgJiYgb3QgIT0gcDJtX21t
aW9fZG0gKQogICAgICAgICB7CiAgICAgICAgICAgICBQMk1fREVCVUcoImdm
bl90b19tZm4gcmV0dXJuZWQgdHlwZSAlZCFcbiIsIG90KTsKICAgICAgICAg
ICAgIHJjID0gLUVCVVNZOwogICAgICAgICAgICAgZ290byBvdXQ7CiAgICAg
ICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIG90ID09IHAybV9wb3B1bGF0ZV9v
bl9kZW1hbmQgKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBDb3VudCBo
b3cgbWFuIFBvRCBlbnRyaWVzIHdlJ2xsIGJlIHJlcGxhY2luZyBpZiBzdWNj
ZXNzZnVsICovCi0gICAgICAgICAgICBwb2RfY291bnQgKz0gbjsKLSAgICAg
ICAgfQogICAgIH0KIAogICAgIC8qIE5vdywgYWN0dWFsbHkgZG8gdGhlIHR3
by13YXkgbWFwcGluZyAqLwotLS0gYS94ZW4vY29tbW9uL21lbW9yeS5jCisr
KyBiL3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTMzNSw3ICszMzUsNyBAQCBp
bnQgZ3Vlc3RfcmVtb3ZlX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwKICAgICB9
CiAgICAgaWYgKCBwMm10ID09IHAybV9tbWlvX2RpcmVjdCApCiAgICAgewot
ICAgICAgICByYyA9IGNsZWFyX21taW9fcDJtX2VudHJ5KGQsIGdtZm4sIG1m
biwgUEFHRV9PUkRFUl80Syk7CisgICAgICAgIHJjID0gLUVQRVJNOwogICAg
ICAgICBnb3RvIG91dF9wdXRfZ2ZuOwogICAgIH0KICNlbHNlCkBAIC0xNjUx
LDYgKzE2NTEsMTUgQEAgaW50IHByZXBhcmVfcmluZ19mb3JfaGVscGVyKAog
ICAgICAgICByZXR1cm4gLUVOT0VOVDsKICAgICB9CiAjZW5kaWYKKyNpZmRl
ZiBDT05GSUdfWDg2CisgICAgaWYgKCBwMm10ID09IHAybV9tbWlvX2RpcmVj
dCApCisgICAgeworICAgICAgICBpZiAoIHBhZ2UgKQorICAgICAgICAgICAg
cHV0X3BhZ2UocGFnZSk7CisKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKKyAg
ICB9CisjZW5kaWYKIAogICAgIGlmICggIXBhZ2UgKQogICAgICAgICByZXR1
cm4gLUVJTlZBTDsKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wMm0uaAor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5oCkBAIC0xNDQsNyArMTQ0
LDggQEAgdHlwZWRlZiB1bnNpZ25lZCBpbnQgcDJtX3F1ZXJ5X3Q7CiAKIC8q
IFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQgdXAgdmlhIHNwZWNpYWwgYWNj
ZXNzb3JzLiAqLwogI2RlZmluZSBQMk1fU1BFQ0lBTF9UWVBFUyAoUDJNX0dS
QU5UX1RZUEVTIHwgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJt
X3RvX21hc2socDJtX21hcF9mb3JlaWduKSkKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHAybV90b19tYXNrKHAybV9tYXBfZm9yZWlnbikgfCBcCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1fdG9fbWFzayhwMm1fbW1p
b19kaXJlY3QpKQogCiAvKiBWYWxpZCB0eXBlcyBub3QgbmVjZXNzYXJpbHkg
YXNzb2NpYXRlZCB3aXRoIGEgKHZhbGlkKSBNRk4uICovCiAjZGVmaW5lIFAy
TV9JTlZBTElEX01GTl9UWVBFUyAoUDJNX1BPRF9UWVBFUyAgICAgICAgICAg
ICAgICAgIFwKQEAgLTYyOSw4ICs2MzAsNiBAQCBpbnQgc2V0X2ZvcmVpZ25f
cDJtX2VudHJ5KHN0cnVjdCBkb21haW4KIC8qIFNldCBtbWlvIGFkZHJlc3Nl
cyBpbiB0aGUgcDJtIHRhYmxlIChmb3IgcGFzcy10aHJvdWdoKSAqLwogaW50
IHNldF9tbWlvX3AybV9lbnRyeShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25l
ZCBsb25nIGdmbiwgbWZuX3QgbWZuLAogICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgb3JkZXIsIHAybV9hY2Nlc3NfdCBhY2Nlc3MpOwot
aW50IGNsZWFyX21taW9fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVu
c2lnbmVkIGxvbmcgZ2ZuLCBtZm5fdCBtZm4sCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKTsKIAogLyogU2V0IGlkZW50
aXR5IGFkZHJlc3NlcyBpbiB0aGUgcDJtIHRhYmxlIChmb3IgcGFzcy10aHJv
dWdoKSAqLwogaW50IHNldF9pZGVudGl0eV9wMm1fZW50cnkoc3RydWN0IGRv
bWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm4sCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-0a.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-0a.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBmaXggUG9EIGFjY291bnRpbmcgaW4gZ3Vlc3RfcGh5c21h
cF9hZGRfZW50cnkoKQoKVGhlIGluaXRpYWwgb2JzZXJ2YXRpb24gd2FzIHRo
YXQgdGhlIG1mbl92YWxpZCgpIGNoZWNrIGNvbWVzIHRvbyBsYXRlOgpOZWl0
aGVyIG1mbl9hZGQoKSBub3IgbWZuX3RvX3BhZ2UoKSAobGV0IGFsb25lIGRl
LXJlZmVyZW5jaW5nIHRoZQpyZXN1bHQgb2YgdGhlIGxhdHRlcikgYXJlIHZh
bGlkIGZvciBNRk5zIGZhaWxpbmcgdGhpcyBjaGVjay4gTW92ZSBpdCB1cAph
bmQgLSBub3RpY2luZyB0aGF0IHRoZXJlJ3Mgbm8gY2FsbGVyIGRvaW5nIHNv
IC0gYWxzbyBhZGQgYW4gYXNzZXJ0aW9uCnRoYXQgdGhpcyBzaG91bGQgbmV2
ZXIgcHJvZHVjZSAiZmFsc2UiIGhlcmUuCgpJbiB0dXJuIHRoaXMgd291bGQg
aGF2ZSBtZWFudCB0aGF0IHRoZSAiZWxzZSIgdG8gdGhhdCBpZigpIGNvdWxk
IG5vdyBnbwphd2F5LCB3aGljaCBkaWRuJ3Qgc2VlbSByaWdodCBhdCBhbGwu
IEFuZCBpbmRlZWQsIGNvbnNpZGVyaW5nIGNhbGxlcnMKbGlrZSBtZW1vcnlf
ZXhjaGFuZ2UoKSBvciB2YXJpb3VzIGdyYW50IHRhYmxlIGZ1bmN0aW9ucywg
dGhlIFBvRAphY2NvdW50aW5nIHNob3VsZCBoYXZlIGJlZW4gb3V0c2lkZSBv
ZiB0aGF0IGlmKCkgZnJvbSB0aGUgdmVyeQpiZWdpbm5pbmcuCgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkFja2Vk
LWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29t
PgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9tbS9wMm0uYwpAQCAtODY0LDYgKzg2NCwxMiBAQCBndWVzdF9waHlz
bWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpkCiAgICAgaWYgKCBwMm1f
aXNfZm9yZWlnbih0KSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCisg
ICAgaWYgKCAhbWZuX3ZhbGlkKG1mbikgKQorICAgIHsKKyAgICAgICAgQVNT
RVJUX1VOUkVBQ0hBQkxFKCk7CisgICAgICAgIHJldHVybiAtRUlOVkFMOwor
ICAgIH0KKwogICAgIHAybV9sb2NrKHAybSk7CiAKICAgICBQMk1fREVCVUco
ImFkZGluZyBnZm49JSNseCBtZm49JSNseFxuIiwgZ2ZuX3goZ2ZuKSwgbWZu
X3gobWZuKSk7CkBAIC05NjMsMTIgKzk2OSwxNSBAQCBndWVzdF9waHlzbWFw
X2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpkCiAgICAgfQogCiAgICAgLyog
Tm93LCBhY3R1YWxseSBkbyB0aGUgdHdvLXdheSBtYXBwaW5nICovCi0gICAg
aWYgKCBtZm5fdmFsaWQobWZuKSApCisgICAgcmMgPSBwMm1fc2V0X2VudHJ5
KHAybSwgZ2ZuLCBtZm4sIHBhZ2Vfb3JkZXIsIHQsIHAybS0+ZGVmYXVsdF9h
Y2Nlc3MpOworICAgIGlmICggcmMgPT0gMCApCiAgICAgewotICAgICAgICBy
YyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwgcGFnZV9vcmRlciwg
dCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybS0+ZGVmYXVsdF9h
Y2Nlc3MpOwotICAgICAgICBpZiAoIHJjICkKLSAgICAgICAgICAgIGdvdG8g
b3V0OyAvKiBGYWlsZWQgdG8gdXBkYXRlIHAybSwgYmFpbCB3aXRob3V0IHVw
ZGF0aW5nIG0ycC4gKi8KKyNpZmRlZiBDT05GSUdfSFZNCisgICAgICAgIHBv
ZF9sb2NrKHAybSk7CisgICAgICAgIHAybS0+cG9kLmVudHJ5X2NvdW50IC09
IHBvZF9jb3VudDsKKyAgICAgICAgQlVHX09OKHAybS0+cG9kLmVudHJ5X2Nv
dW50IDwgMCk7CisgICAgICAgIHBvZF91bmxvY2socDJtKTsKKyNlbmRpZgog
CiAgICAgICAgIGlmICggIXAybV9pc19ncmFudCh0KSApCiAgICAgICAgIHsK
QEAgLTk3NywyNCArOTg2LDcgQEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnko
c3RydWN0IGRvbWFpbiAqZAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGdmbl94KGdmbl9hZGQoZ2ZuLCBpKSkpOwogICAgICAgICB9CiAg
ICAgfQotICAgIGVsc2UKLSAgICB7Ci0gICAgICAgIGdkcHJpbnRrKFhFTkxP
R19XQVJOSU5HLCAiQWRkaW5nIGJhZCBtZm4gdG8gcDJtIG1hcCAoJSNseCAt
PiAlI2x4KVxuIiwKLSAgICAgICAgICAgICAgICAgZ2ZuX3goZ2ZuKSwgbWZu
X3gobWZuKSk7Ci0gICAgICAgIHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdm
biwgSU5WQUxJRF9NRk4sIHBhZ2Vfb3JkZXIsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICBwMm1faW52YWxpZCwgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7
Ci0jaWZkZWYgQ09ORklHX0hWTQotICAgICAgICBpZiAoIHJjID09IDAgKQot
ICAgICAgICB7Ci0gICAgICAgICAgICBwb2RfbG9jayhwMm0pOwotICAgICAg
ICAgICAgcDJtLT5wb2QuZW50cnlfY291bnQgLT0gcG9kX2NvdW50OwotICAg
ICAgICAgICAgQlVHX09OKHAybS0+cG9kLmVudHJ5X2NvdW50IDwgMCk7Ci0g
ICAgICAgICAgICBwb2RfdW5sb2NrKHAybSk7Ci0gICAgICAgIH0KLSNlbmRp
ZgotICAgIH0KIAotb3V0OgogICAgIHAybV91bmxvY2socDJtKTsKIAogICAg
IHJldHVybiByYzsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-0b.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-0b.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBkb24ndCBpZ25vcmUgcDJtX3JlbW92ZV9wYWdlKCkncyBy
ZXR1cm4gdmFsdWUKCkl0J3Mgbm90IHZlcnkgbmljZSB0byByZXR1cm4gZnJv
bSBndWVzdF9waHlzbWFwX2FkZF9lbnRyeSgpIGFmdGVyCnBlcmhhcHMgYWxy
ZWFkeSBoYXZpbmcgbWFkZSBzb21lIGNoYW5nZXMgdG8gdGhlIFAyTSwgYnV0
IHRoaXMgaXMgcHJlLQpleGlzdGluZyBwcmFjdGljZSBpbiB0aGUgZnVuY3Rp
b24sIGFuZCBpbW8gYmV0dGVyIHRoYW4gaWdub3JpbmcgZXJyb3JzLgoKVGFr
ZSB0aGUgbGliZXJ0eSBhbmQgcmVwbGFjZSBhbiBtZm5fYWRkKCkgaW5zdGFu
Y2Ugd2l0aCBhIGxvY2FsIHZhcmlhYmxlCmFscmVhZHkgaG9sZGluZyB0aGUg
cmVzdWx0IChhcyBwcm92ZW4gYnkgdGhlIGNoZWNrIGltbWVkaWF0ZWx5IGFo
ZWFkKS4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBz
dXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJy
YW50QGNpdHJpeC5jb20+CkFja2VkLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRy
ZXcuY29vcGVyM0BjaXRyaXguY29tPgoKLS0tIGEveGVuL2FyY2gveDg2L21t
L3AybS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtNzcyLDgg
Kzc3Miw3IEBAIHZvaWQgcDJtX2ZpbmFsX3RlYXJkb3duKHN0cnVjdCBkb21h
aW4gKmQKICAgICBwMm1fdGVhcmRvd25faG9zdHAybShkKTsKIH0KIAotCi1z
dGF0aWMgaW50CitzdGF0aWMgaW50IF9fbXVzdF9jaGVjawogcDJtX3JlbW92
ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcg
Z2ZuX2wsIHVuc2lnbmVkIGxvbmcgbWZuLAogICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBwYWdlX29yZGVyKQogewpAQCAtOTYxLDkgKzk2MCw5IEBA
IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAg
ICAgICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKG9tZm4pKTsKICAgICAg
ICAgICAgICAgICBQMk1fREVCVUcoIm9sZCBnZm49JSNseCAtPiBtZm4gJSNs
eFxuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZuX3gob2dmbikg
LCBtZm5feChvbWZuKSk7Ci0gICAgICAgICAgICAgICAgaWYgKCBtZm5fZXEo
b21mbiwgbWZuX2FkZChtZm4sIGkpKSApCi0gICAgICAgICAgICAgICAgICAg
IHAybV9yZW1vdmVfcGFnZShwMm0sIGdmbl94KG9nZm4pLCBtZm5feChtZm5f
YWRkKG1mbiwgaSkpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgMCk7CisgICAgICAgICAgICAgICAgaWYgKCBtZm5fZXEob21mbiwg
bWZuX2FkZChtZm4sIGkpKSAmJgorICAgICAgICAgICAgICAgICAgICAgKHJj
ID0gcDJtX3JlbW92ZV9wYWdlKHAybSwgZ2ZuX3gob2dmbiksIG1mbl94KG9t
Zm4pLCAwKSkgKQorICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKICAg
ICAgICAgICAgIH0KICAgICAgICAgfQogICAgIH0KQEAgLTk4Nyw2ICs5ODYs
NyBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpk
CiAgICAgICAgIH0KICAgICB9CiAKKyBvdXQ6CiAgICAgcDJtX3VubG9jayhw
Mm0pOwogCiAgICAgcmV0dXJuIHJjOwpAQCAtMjY0Niw5ICsyNjQ2LDkgQEAg
aW50IHAybV9jaGFuZ2VfYWx0cDJtX2dmbihzdHJ1Y3QgZG9tYWluCiAKICAg
ICBpZiAoIGdmbl9lcShuZXdfZ2ZuLCBJTlZBTElEX0dGTikgKQogICAgIHsK
LSAgICAgICAgaWYgKCBtZm5fdmFsaWQobWZuKSApCi0gICAgICAgICAgICBw
Mm1fcmVtb3ZlX3BhZ2UoYXAybSwgZ2ZuX3gob2xkX2dmbiksIG1mbl94KG1m
biksIFBBR0VfT1JERVJfNEspOwotICAgICAgICByYyA9IDA7CisgICAgICAg
IHJjID0gbWZuX3ZhbGlkKG1mbikKKyAgICAgICAgICAgICA/IHAybV9yZW1v
dmVfcGFnZShhcDJtLCBnZm5feChvbGRfZ2ZuKSwgbWZuX3gobWZuKSwgUEFH
RV9PUkRFUl80SykKKyAgICAgICAgICAgICA6IDA7CiAgICAgICAgIGdvdG8g
b3V0OwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-0c.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-0c.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBkb24ndCBhc3NlcnQgdGhhdCB0aGUgcGFzc2VkIGluIE1G
TiBtYXRjaGVzIGZvciBhIHJlbW92ZQoKZ3Vlc3RfcGh5c21hcF9yZW1vdmVf
cGFnZSgpIGdldHMgaGFuZGVkIGFuIE1GTiBmcm9tIHRoZSBvdXRzaWRlLCB5
ZXQKdGFrZXMgdGhlIG5lY2Vzc2FyeSBsb2NrIHRvIHByZXZlbnQgZnVydGhl
ciBjaGFuZ2VzIHRvIHRoZSBHRk4gPC0+IE1GTgptYXBwaW5nIGl0c2VsZi4g
V2hpbGUgc29tZSBjYWxsZXJzLCBpbiBwYXJ0aWN1bGFyIGd1ZXN0X3JlbW92
ZV9wYWdlKCkKKGJ5IHdheSBvZiBoYXZpbmcgY2FsbGVkIGdldF9nZm5fcXVl
cnkoKSksIGhvbGQgdGhlIEdGTiBsb2NrIGFscmVhZHksCnZhcmlvdXMgb3Ro
ZXJzIChtb3N0IG5vdGFibHkgcGVyaGFwcyB0aGUgMm5kIGluc3RhbmNlIGlu
Cnhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUoKSkgZG9uJ3QuIFdoaWxlIGl0
IGFsc28gaXMgYW4gb3B0aW9uIHRvIGZpeAphbGwgdGhlIGNhbGxlcnMsIGRl
YWwgd2l0aCB0aGUgaXNzdWUgaW4gcDJtX3JlbW92ZV9wYWdlKCkgaW5zdGVh
ZDoKUmVwbGFjZSB0aGUgQVNTRVJUKCkgYnkgYSBjb25kaXRpb25hbCBhbmQg
c3BsaXQgdGhlIGxvb3AgaW50byB0d28sIHN1Y2gKdGhhdCBhbGwgY2hlY2tp
bmcgZ2V0cyBkb25lIGJlZm9yZSBhbnkgbW9kaWZpY2F0aW9uIHdvdWxkIG9j
Y3VyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJh
bnRAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYvbW0v
cDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC03NzgsNyAr
Nzc4LDYgQEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpw
Mm0sCiB7CiAgICAgdW5zaWduZWQgbG9uZyBpOwogICAgIGdmbl90IGdmbiA9
IF9nZm4oZ2ZuX2wpOwotICAgIG1mbl90IG1mbl9yZXR1cm47CiAgICAgcDJt
X3R5cGVfdCB0OwogICAgIHAybV9hY2Nlc3NfdCBhOwogCkBAIC03ODksMTUg
Kzc4OCwyNiBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9kb21haW4g
KnAybSwKICAgICBBU1NFUlQoZ2ZuX2xvY2tlZF9ieV9tZShwMm0sIGdmbikp
OwogICAgIFAyTV9ERUJVRygicmVtb3ZpbmcgZ2ZuPSUjbHggbWZuPSUjbHhc
biIsIGdmbl9sLCBtZm4pOwogCisgICAgZm9yICggaSA9IDA7IGkgPCAoMVVM
IDw8IHBhZ2Vfb3JkZXIpOyApCisgICAgeworICAgICAgICB1bnNpZ25lZCBp
bnQgY3VyX29yZGVyOworICAgICAgICBtZm5fdCBtZm5fcmV0dXJuID0gcDJt
LT5nZXRfZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZj
dXJfb3JkZXIsIE5VTEwpOworCisgICAgICAgIGlmICggcDJtX2lzX3ZhbGlk
KHQpICYmCisgICAgICAgICAgICAgKCFtZm5fdmFsaWQoX21mbihtZm4pKSB8
fCBtZm4gKyBpICE9IG1mbl94KG1mbl9yZXR1cm4pKSApCisgICAgICAgICAg
ICByZXR1cm4gLUVJTFNFUTsKKworICAgICAgICBpICs9ICgxVUwgPDwgY3Vy
X29yZGVyKSAtICgoZ2ZuX2wgKyBpKSAmICgoMVVMIDw8IGN1cl9vcmRlcikg
LSAxKSk7CisgICAgfQorCiAgICAgaWYgKCBtZm5fdmFsaWQoX21mbihtZm4p
KSApCiAgICAgewogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwg
cGFnZV9vcmRlcik7IGkrKyApCiAgICAgICAgIHsKLSAgICAgICAgICAgIG1m
bl9yZXR1cm4gPSBwMm0tPmdldF9lbnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBp
KSwgJnQsICZhLCAwLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE5VTEwsIE5VTEwpOworICAgICAgICAgICAgcDJtLT5nZXRf
ZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZ0LCAmYSwgMCwgTlVMTCwg
TlVMTCk7CiAgICAgICAgICAgICBpZiAoICFwMm1faXNfZ3JhbnQodCkgJiYg
IXAybV9pc19zaGFyZWQodCkgJiYgIXAybV9pc19mb3JlaWduKHQpICkKICAg
ICAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm4raSwgSU5WQUxJ
RF9NMlBfRU5UUlkpOwotICAgICAgICAgICAgQVNTRVJUKCAhcDJtX2lzX3Zh
bGlkKHQpIHx8IG1mbiArIGkgPT0gbWZuX3gobWZuX3JldHVybikgKTsKICAg
ICAgICAgfQogICAgIH0KICAgICByZXR1cm4gcDJtX3NldF9lbnRyeShwMm0s
IGdmbiwgSU5WQUxJRF9NRk4sIHBhZ2Vfb3JkZXIsIHAybV9pbnZhbGlkLAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-1.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZ2xvYmFsIGV4Y2x1c2lvbiByYW5nZSBl
eHRlbmRpbmcKCkJlc2lkZXMgdW5pdHkgbWFwcGluZyByZWdpb25zLCB0aGUg
QU1EIElPTU1VIHNwZWMgYWxzbyBwcm92aWRlcyBmb3IKZXhjbHVzaW9uIHJh
bmdlcyAoYXJlYXMgb2YgbWVtb3J5IG5vdCB0byBiZSBzdWJqZWN0IHRvIERN
QSB0cmFuc2xhdGlvbikKdG8gYmUgc3BlY2lmaWVkIGJ5IGZpcm13YXJlIGlu
IHRoZSBBQ1BJIHRhYmxlcy4gVGhlIHNwZWMgZG9lcyBub3QgcHV0CmFueSBj
b25zdHJhaW50cyBvbiB0aGUgbnVtYmVyIG9mIHN1Y2ggcmVnaW9ucy4KCkJs
aW5kbHkgYXNzdW1pbmcgYWxsIGFkZHJlc3NlcyBiZXR3ZWVuIGFueSB0d28g
c3VjaCByYW5nZXMgc2hvdWxkIGFsc28KYmUgZXhjbHVkZWQgY2FuJ3QgYmUg
cmlnaHQuIFNpbmNlIGhhcmR3YXJlIGhhcyByb29tIGZvciBqdXN0IGEgc2lu
Z2xlCnN1Y2ggcmFuZ2UgKGNvbXByaXNlZCBvZiB0aGUgRXhjbHVzaW9uIEJh
c2UgUmVnaXN0ZXIgYW5kIHRoZSBFeGNsdXNpb24KUmFuZ2UgTGltaXQgUmVn
aXN0ZXIpLCBjb21iaW5lIG9ubHkgYWRqYWNlbnQgb3Igb3ZlcmxhcHBpbmcg
cmVnaW9ucyAoZm9yCm5vdzsgdGhpcyBtYXkgcmVxdWlyZSBmdXJ0aGVyIGFk
anVzdG1lbnQgaW4gY2FzZSB0YWJsZSBlbnRyaWVzIGFyZW4ndApzb3J0ZWQg
YnkgYWRkcmVzcykgd2l0aCBtYXRjaGluZyBleGNsdXNpb25fYWxsb3dfYWxs
IHNldHRpbmdzLiBUaGlzCnJlcXVpcmVzIGJ1YmJsaW5nIHVwIGVycm9yIGlu
ZGljYXRvcnMsIHN1Y2ggdGhhdCBJT01NVSBpbml0IGNhbiBiZQpmYWlsZWQg
d2hlbiBjb25jYXRlbmF0aW9uIHdhc24ndCBwb3NzaWJsZS4KCkZ1cnRoZXJt
b3JlLCBzaW5jZSB0aGUgZXhjbHVzaW9uIHJhbmdlIHNwZWNpZmllZCBpbiBJ
T01NVSByZWdpc3RlcnMKaW1wbGllcyBSL1cgYWNjZXNzLCByZWplY3QgcmVx
dWVzdHMgYXNraW5nIGZvciBsZXNzIHBlcm1pc3Npb25zICh0aGlzCndpbGwg
YmUgYnJvdWdodCBjbG9zZXIgdG8gdGhlIHNwZWMgYnkgYSBzdWJzZXF1ZW50
IGNoYW5nZSkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3OCAvIENWRS0yMDIx
LTI4Njk1LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9hY3BpLmMKQEAgLTk4LDEyICs5OCwyMSBAQCBzdGF0aWMgc3RydWN0
IGFtZF9pb21tdSAqIF9faW5pdCBmaW5kX2lvCiAgICAgcmV0dXJuIE5VTEw7
CiB9CiAKLXN0YXRpYyB2b2lkIF9faW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZSgKLSAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWlu
dDY0X3QgYmFzZSwgdWludDY0X3QgbGltaXQpCitzdGF0aWMgaW50IF9faW5p
dCByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZSgKKyAgICBzdHJ1Y3Qg
YW1kX2lvbW11ICppb21tdSwgdWludDY0X3QgYmFzZSwgdWludDY0X3QgbGlt
aXQsCisgICAgYm9vbCBhbGwsIGJvb2wgaXcsIGJvb2wgaXIpCiB7CisgICAg
aWYgKCAhaXIgfHwgIWl3ICkKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKKwog
ICAgIC8qIG5lZWQgdG8gZXh0ZW5kIGV4Y2x1c2lvbiByYW5nZT8gKi8KICAg
ICBpZiAoIGlvbW11LT5leGNsdXNpb25fZW5hYmxlICkKICAgICB7CisgICAg
ICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9saW1pdCArIFBBR0VfU0laRSA8
IGJhc2UgfHwKKyAgICAgICAgICAgICBsaW1pdCArIFBBR0VfU0laRSA8IGlv
bW11LT5leGNsdXNpb25fYmFzZSB8fAorICAgICAgICAgICAgIGlvbW11LT5l
eGNsdXNpb25fYWxsb3dfYWxsICE9IGFsbCApCisgICAgICAgICAgICByZXR1
cm4gLUVCVVNZOworCiAgICAgICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9i
YXNlIDwgYmFzZSApCiAgICAgICAgICAgICBiYXNlID0gaW9tbXUtPmV4Y2x1
c2lvbl9iYXNlOwogICAgICAgICBpZiAoIGlvbW11LT5leGNsdXNpb25fbGlt
aXQgPiBsaW1pdCApCkBAIC0xMTEsMTYgKzEyMCwxMSBAQCBzdGF0aWMgdm9p
ZCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNpCiAgICAgfQogCiAgICAg
aW9tbXUtPmV4Y2x1c2lvbl9lbmFibGUgPSBJT01NVV9DT05UUk9MX0VOQUJM
RUQ7CisgICAgaW9tbXUtPmV4Y2x1c2lvbl9hbGxvd19hbGwgPSBhbGw7CiAg
ICAgaW9tbXUtPmV4Y2x1c2lvbl9iYXNlID0gYmFzZTsKICAgICBpb21tdS0+
ZXhjbHVzaW9uX2xpbWl0ID0gbGltaXQ7Ci19CiAKLXN0YXRpYyB2b2lkIF9f
aW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZV9hbGwoCi0gICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCi0gICAgdW5zaWduZWQgbG9uZyBi
YXNlLCB1bnNpZ25lZCBsb25nIGxpbWl0KQotewotICAgIHJlc2VydmVfaW9t
bXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCk7Ci0gICAg
aW9tbXUtPmV4Y2x1c2lvbl9hbGxvd19hbGwgPSBJT01NVV9DT05UUk9MX0VO
QUJMRUQ7CisgICAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyB2b2lkIF9faW5p
dCByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKApAQCAtMTU4LDYgKzE2
Miw3IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9y
YW4KICAgICB1bnNpZ25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBs
ZW5ndGg7CiAgICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CiAgICAgdW5z
aWduZWQgaW50IGJkZjsKKyAgICBpbnQgcmMgPSAwOwogCiAgICAgLyogaXMg
cGFydCBvZiBleGNsdXNpb24gcmFuZ2UgaW5zaWRlIG9mIElPTU1VIHZpcnR1
YWwgYWRkcmVzcyBzcGFjZT8gKi8KICAgICAvKiBub3RlOiAnbGltaXQnIHBh
cmFtZXRlciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2UtYWxpZ25lZCAqLwpAQCAt
MTc5LDEwICsxODQsMTUgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJf
ZXhjbHVzaW9uX3JhbgogICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkK
ICAgICB7CiAgICAgICAgIGZvcl9lYWNoX2FtZF9pb21tdSggaW9tbXUgKQot
ICAgICAgICAgICAgcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2VfYWxs
KGlvbW11LCBiYXNlLCBsaW1pdCk7CisgICAgICAgIHsKKyAgICAgICAgICAg
IHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJh
c2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0cnVlIC8qIGFsbCAqLywgaXcsIGlyKTsKKyAgICAg
ICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICB9CiAgICAgfQogCi0gICAgcmV0dXJuIDA7CisgICAgcmV0dXJuIHJj
OwogfQogCiBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25f
cmFuZ2VfZm9yX2RldmljZSgKQEAgLTE5Myw2ICsyMDMsNyBAQCBzdGF0aWMg
aW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgdW5zaWdu
ZWQgbG9uZyByYW5nZV90b3AsIGlvbW11X3RvcCwgbGVuZ3RoOwogICAgIHN0
cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAgIHUxNiByZXE7CisgICAgaW50
IHJjID0gMDsKIAogICAgIGlvbW11ID0gZmluZF9pb21tdV9mb3JfZGV2aWNl
KHNlZywgYmRmKTsKICAgICBpZiAoICFpb21tdSApCkBAIC0yMjIsMTIgKzIz
MywxMyBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25f
cmFuCiAgICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNl
dHRpbmdzIGZvciBkZXZpY2UgKi8KICAgICBpZiAoIGxpbWl0ID49IGlvbW11
X3RvcCAgKQogICAgIHsKLSAgICAgICAgcmVzZXJ2ZV9pb21tdV9leGNsdXNp
b25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0KTsKKyAgICAgICAgcmMgPSBy
ZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGlt
aXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZmFsc2UgLyogYWxsICovLCBpdywgaXIpOwogICAgICAgICBpdnJzX21h
cHBpbmdzW2JkZl0uZHRlX2FsbG93X2V4Y2x1c2lvbiA9IElPTU1VX0NPTlRS
T0xfRU5BQkxFRDsKICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFdLmR0ZV9h
bGxvd19leGNsdXNpb24gPSBJT01NVV9DT05UUk9MX0VOQUJMRUQ7CiAgICAg
fQogCi0gICAgcmV0dXJuIDA7CisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0
aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2lv
bW11X2RldmljZXMoCkBAIC0yMzcsNiArMjQ5LDcgQEAgc3RhdGljIGludCBf
X2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogICAgIHVuc2lnbmVkIGxv
bmcgcmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAgICB1bnNpZ25l
ZCBpbnQgYmRmOwogICAgIHUxNiByZXE7CisgICAgaW50IHJjID0gMDsKIAog
ICAgIC8qIGlzIHBhcnQgb2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBvZiBJ
T01NVSB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2U/ICovCiAgICAgLyogbm90ZTog
J2xpbWl0JyBwYXJhbWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWdu
ZWQgKi8KQEAgLTI2Nyw4ICsyODAsMTAgQEAgc3RhdGljIGludCBfX2luaXQg
cmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogCiAgICAgLyogcmVnaXN0ZXIgSU9N
TVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzICovCiAgICAgaWYgKCBsaW1p
dCA+PSBpb21tdV90b3AgKQotICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZV9hbGwoaW9tbXUsIGJhc2UsIGxpbWl0KTsKLSAgICByZXR1
cm4gMDsKKyAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9y
YW5nZShpb21tdSwgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3LCBp
cik7CisKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0
IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdCgK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-2.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZGV2aWNlIHVuaXR5IG1hcCBoYW5kbGlu
ZwoKQmxpbmRseSBhc3N1bWluZyBhbGwgYWRkcmVzc2VzIGJldHdlZW4gYW55
IHR3byBzdWNoIHJhbmdlcywgc3BlY2lmaWVkIGJ5CmZpcm13YXJlIGluIHRo
ZSBBQ1BJIHRhYmxlcywgc2hvdWxkIGFsc28gYmUgdW5pdHktbWFwcGVkIGNh
bid0IGJlIHJpZ2h0LgpOb3IgY2FuIGl0IGJlIGNvcnJlY3QgdG8gbWVyZ2Ug
cmFuZ2VzIHdpdGggZGlmZmVyaW5nIHBlcm1pc3Npb25zLiBUcmFjawpyYW5n
ZXMgaW5kaXZpZHVhbGx5OyBkb24ndCBtZXJnZSBhdCBhbGwsIGJ1dCBjaGVj
ayBmb3Igb3ZlcmxhcHMgaW5zdGVhZC4KVGhpcyByZXF1aXJlcyBidWJibGlu
ZyB1cCBlcnJvciBpbmRpY2F0b3JzLCBzdWNoIHRoYXQgSU9NTVUgaW5pdCBj
YW4gYmUKZmFpbGVkIHdoZW4gYWxsb2NhdGlvbiBvZiBhIG5ldyB0cmFja2lu
ZyBzdHJ1Y3Qgd2Fzbid0IHBvc3NpYmxlLCBvciBhbgpvdmVybGFwIHdhcyBk
ZXRlY3RlZC4KCkF0IHRoaXMgb2NjYXNpb24gYWxzbyBzdG9wIGlnbm9yaW5n
CmFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoKSdzIHJldHVy
biB2YWx1ZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4IC8gQ1ZFLTIwMjEt
Mjg2OTUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2Uu
ZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQg
PHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtMTI3LDMyICsxMjcsNDggQEAgc3Rh
dGljIGludCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNpbwogICAgIHJl
dHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCBfX2luaXQgcmVzZXJ2ZV91bml0
eV9tYXBfZm9yX2RldmljZSgKLSAgICB1MTYgc2VnLCB1MTYgYmRmLCB1bnNp
Z25lZCBsb25nIGJhc2UsCi0gICAgdW5zaWduZWQgbG9uZyBsZW5ndGgsIHU4
IGl3LCB1OCBpcikKK3N0YXRpYyBpbnQgX19pbml0IHJlc2VydmVfdW5pdHlf
bWFwX2Zvcl9kZXZpY2UoCisgICAgdWludDE2X3Qgc2VnLCB1aW50MTZfdCBi
ZGYsIHVuc2lnbmVkIGxvbmcgYmFzZSwKKyAgICB1bnNpZ25lZCBsb25nIGxl
bmd0aCwgYm9vbCBpdywgYm9vbCBpcikKIHsKICAgICBzdHJ1Y3QgaXZyc19t
YXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBpbmdzKHNl
Zyk7Ci0gICAgdW5zaWduZWQgbG9uZyBvbGRfdG9wLCBuZXdfdG9wOworICAg
IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwID0gaXZyc19tYXBw
aW5nc1tiZGZdLnVuaXR5X21hcDsKIAotICAgIC8qIG5lZWQgdG8gZXh0ZW5k
IHVuaXR5LW1hcHBlZCByYW5nZT8gKi8KLSAgICBpZiAoIGl2cnNfbWFwcGlu
Z3NbYmRmXS51bml0eV9tYXBfZW5hYmxlICkKKyAgICAvKiBDaGVjayBmb3Ig
b3ZlcmxhcHMuICovCisgICAgZm9yICggOyB1bml0eV9tYXA7IHVuaXR5X21h
cCA9IHVuaXR5X21hcC0+bmV4dCApCiAgICAgewotICAgICAgICBvbGRfdG9w
ID0gaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2Vfc3RhcnQgKwotICAg
ICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2VfbGVuZ3Ro
OwotICAgICAgICBuZXdfdG9wID0gYmFzZSArIGxlbmd0aDsKLSAgICAgICAg
aWYgKCBvbGRfdG9wID4gbmV3X3RvcCApCi0gICAgICAgICAgICBuZXdfdG9w
ID0gb2xkX3RvcDsKLSAgICAgICAgaWYgKCBpdnJzX21hcHBpbmdzW2JkZl0u
YWRkcl9yYW5nZV9zdGFydCA8IGJhc2UgKQotICAgICAgICAgICAgYmFzZSA9
IGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3JhbmdlX3N0YXJ0OwotICAgICAg
ICBsZW5ndGggPSBuZXdfdG9wIC0gYmFzZTsKLSAgICB9Ci0KLSAgICAvKiBl
eHRlbmQgci93IHBlcm1pc3Npb21zIGFuZCBrZWVwIGFnZ3JlZ2F0ZSAqLwot
ICAgIGl2cnNfbWFwcGluZ3NbYmRmXS53cml0ZV9wZXJtaXNzaW9uID0gaXc7
Ci0gICAgaXZyc19tYXBwaW5nc1tiZGZdLnJlYWRfcGVybWlzc2lvbiA9IGly
OwotICAgIGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXBfZW5hYmxlID0g
SU9NTVVfQ09OVFJPTF9FTkFCTEVEOwotICAgIGl2cnNfbWFwcGluZ3NbYmRm
XS5hZGRyX3JhbmdlX3N0YXJ0ID0gYmFzZTsKLSAgICBpdnJzX21hcHBpbmdz
W2JkZl0uYWRkcl9yYW5nZV9sZW5ndGggPSBsZW5ndGg7CisgICAgICAgIC8q
CisgICAgICAgICAqIEV4YWN0IG1hdGNoZXMgYXJlIG9rYXkuIFRoaXMgY2Fu
IGluIHBhcnRpY3VsYXIgaGFwcGVuIHdoZW4KKyAgICAgICAgICogcmVnaXN0
ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoKSBjYWxscyBoZXJlIHR3
aWNlIGZvciB0aGUKKyAgICAgICAgICogc2FtZSAocyxiLGQsZikuCisgICAg
ICAgICAqLworICAgICAgICBpZiAoIGJhc2UgPT0gdW5pdHlfbWFwLT5hZGRy
ICYmIGxlbmd0aCA9PSB1bml0eV9tYXAtPmxlbmd0aCAmJgorICAgICAgICAg
ICAgIGlyID09IHVuaXR5X21hcC0+cmVhZCAmJiBpdyA9PSB1bml0eV9tYXAt
PndyaXRlICkKKyAgICAgICAgICAgIHJldHVybiAwOworCisgICAgICAgIGlm
ICggdW5pdHlfbWFwLT5hZGRyICsgdW5pdHlfbWFwLT5sZW5ndGggPiBiYXNl
ICYmCisgICAgICAgICAgICAgYmFzZSArIGxlbmd0aCA+IHVuaXR5X21hcC0+
YWRkciApCisgICAgICAgIHsKKyAgICAgICAgICAgIEFNRF9JT01NVV9ERUJV
RygiSVZNRCBFcnJvcjogb3ZlcmxhcCBbJWx4LCVseCkgdnMgWyVseCwlbHgp
XG4iLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UsIGJhc2Ug
KyBsZW5ndGgsIHVuaXR5X21hcC0+YWRkciwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bml0eV9tYXAtPmFkZHIgKyB1bml0eV9tYXAtPmxlbmd0
aCk7CisgICAgICAgICAgICByZXR1cm4gLUVQRVJNOworICAgICAgICB9Cisg
ICAgfQorCisgICAgLyogUG9wdWxhdGUgYW5kIGluc2VydCBhIG5ldyB1bml0
eSBtYXAuICovCisgICAgdW5pdHlfbWFwID0geG1hbGxvYyhzdHJ1Y3QgaXZy
c191bml0eV9tYXApOworICAgIGlmICggIXVuaXR5X21hcCApCisgICAgICAg
IHJldHVybiAtRU5PTUVNOworCisgICAgdW5pdHlfbWFwLT5yZWFkID0gaXI7
CisgICAgdW5pdHlfbWFwLT53cml0ZSA9IGl3OworICAgIHVuaXR5X21hcC0+
YWRkciA9IGJhc2U7CisgICAgdW5pdHlfbWFwLT5sZW5ndGggPSBsZW5ndGg7
CisgICAgdW5pdHlfbWFwLT5uZXh0ID0gaXZyc19tYXBwaW5nc1tiZGZdLnVu
aXR5X21hcDsKKyAgICBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwID0g
dW5pdHlfbWFwOworCisgICAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBpbnQg
X19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfYWxsX2Rldmlj
ZXMoCkBAIC0xNzUsMTMgKzE5MSwxMyBAQCBzdGF0aWMgaW50IF9faW5pdCBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgICAgIGxlbmd0aCA9IHJhbmdl
X3RvcCAtIGJhc2U7CiAgICAgICAgIC8qIHJlc2VydmUgci93IHVuaXR5LW1h
cHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZXMgKi8KICAgICAgICAgLyog
bm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9u
IHJhbmdlICovCi0gICAgICAgIGZvciAoIGJkZiA9IDA7IGJkZiA8IGl2cnNf
YmRmX2VudHJpZXM7IGJkZisrICkKLSAgICAgICAgICAgIHJlc2VydmVfdW5p
dHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcs
IGlyKTsKKyAgICAgICAgZm9yICggYmRmID0gMDsgIXJjICYmIGJkZiA8IGl2
cnNfYmRmX2VudHJpZXM7IGJkZisrICkKKyAgICAgICAgICAgIHJjID0gcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVu
Z3RoLCBpdywgaXIpOwogICAgICAgICAvKiBwdXNoICdiYXNlJyBqdXN0IG91
dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCiAgICAgICAgIGJh
c2UgPSBpb21tdV90b3A7CiAgICAgfQogICAgIC8qIHJlZ2lzdGVyIElPTU1V
IGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwotICAgIGlmICggbGltaXQg
Pj0gaW9tbXVfdG9wICkKKyAgICBpZiAoICFyYyAmJiBsaW1pdCA+PSBpb21t
dV90b3AgKQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBp
b21tdSApCiAgICAgICAgIHsKQEAgLTIyMywxNSArMjM5LDE1IEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICAgICAg
bGVuZ3RoID0gcmFuZ2VfdG9wIC0gYmFzZTsKICAgICAgICAgLyogcmVzZXJ2
ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2UgKi8KICAg
ICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUg
ZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIHJlc2VydmVfdW5pdHlfbWFw
X2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsK
LSAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIHJl
cSwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOworICAgICAgICByYyA9IHJlc2Vy
dmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0
aCwgaXcsIGlyKSA/OgorICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFw
X2Zvcl9kZXZpY2Uoc2VnLCByZXEsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsK
IAogICAgICAgICAvKiBwdXNoICdiYXNlJyBqdXN0IG91dHNpZGUgb2Ygdmly
dHVhbCBhZGRyZXNzIHNwYWNlICovCiAgICAgICAgIGJhc2UgPSBpb21tdV90
b3A7CiAgICAgfQogCiAgICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9u
IHJhbmdlIHNldHRpbmdzIGZvciBkZXZpY2UgKi8KLSAgICBpZiAoIGxpbWl0
ID49IGlvbW11X3RvcCAgKQorICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlv
bW11X3RvcCAgKQogICAgIHsKICAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgLyog
YWxsICovLCBpdywgaXIpOwpAQCAtMjYyLDE1ICsyNzgsMTUgQEAgc3RhdGlj
IGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbgogICAgICAgICBs
ZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwogICAgICAgICAvKiByZXNlcnZl
IHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2VzICov
CiAgICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJpZXMgYXJlIHBhcnQgb2Yg
dGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAgICAgICBmb3IgKCBiZGYgPSAw
OyBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCisgICAgICAgIGZv
ciAoIGJkZiA9IDA7ICFyYyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBi
ZGYrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggaW9tbXUgPT0g
ZmluZF9pb21tdV9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZikgKQogICAg
ICAgICAgICAgewotICAgICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFw
X2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
dywgaXIpOwogICAgICAgICAgICAgICAgIHJlcSA9IGdldF9pdnJzX21hcHBp
bmdzKGlvbW11LT5zZWcpW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZDsKLSAgICAg
ICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11
LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGlyKTsKKyAgICAgICAg
ICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9t
bXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcikgPzoK
KyAgICAgICAgICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9k
ZXZpY2UoaW9tbXUtPnNlZywgcmVxLCBiYXNlLCBsZW5ndGgsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3
LCBpcik7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KIApAQCAtMjc5LDcg
KzI5NSw3IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW4KICAgICB9CiAKICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNp
b24gcmFuZ2Ugc2V0dGluZ3MgKi8KLSAgICBpZiAoIGxpbWl0ID49IGlvbW11
X3RvcCApCisgICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICkK
ICAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShp
b21tdSwgYmFzZSwgbGltaXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3LCBpcik7CiAK
LS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5p
dC5jCkBAIC0xMTg5LDcgKzExODksNiBAQCBzdGF0aWMgaW50IF9faW5pdCBh
bGxvY19pdnJzX21hcHBpbmdzKHUxCiAgICAgewogICAgICAgICBpdnJzX21h
cHBpbmdzW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZCA9IGJkZjsKICAgICAgICAg
aXZyc19tYXBwaW5nc1tiZGZdLmR0ZV9hbGxvd19leGNsdXNpb24gPSBJT01N
VV9DT05UUk9MX0RJU0FCTEVEOwotICAgICAgICBpdnJzX21hcHBpbmdzW2Jk
Zl0udW5pdHlfbWFwX2VuYWJsZSA9IElPTU1VX0NPTlRST0xfRElTQUJMRUQ7
CiAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRmXS5pb21tdSA9IE5VTEw7CiAK
ICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlID0g
TlVMTDsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9h
bWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
cGNpX2FtZF9pb21tdS5jCkBAIC0zNDYsMTUgKzM0NiwxNyBAQCBzdGF0aWMg
aW50IGFtZF9pb21tdV9hc3NpZ25fZGV2aWNlKHN0cnVjCiAgICAgc3RydWN0
IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBw
aW5ncyhwZGV2LT5zZWcpOwogICAgIGludCBiZGYgPSBQQ0lfQkRGMihwZGV2
LT5idXMsIGRldmZuKTsKICAgICBpbnQgcmVxX2lkID0gZ2V0X2RtYV9yZXF1
ZXN0b3JfaWQocGRldi0+c2VnLCBiZGYpOworICAgIGNvbnN0IHN0cnVjdCBp
dnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwOwogCi0gICAgaWYgKCBpdnJzX21h
cHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwX2VuYWJsZSApCisgICAgZm9yICgg
dW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21hcDsg
dW5pdHlfbWFwOworICAgICAgICAgIHVuaXR5X21hcCA9IHVuaXR5X21hcC0+
bmV4dCApCiAgICAgewotICAgICAgICBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21h
aW5fdW5pdHlfbWFwKAotICAgICAgICAgICAgZCwKLSAgICAgICAgICAgIGl2
cnNfbWFwcGluZ3NbcmVxX2lkXS5hZGRyX3JhbmdlX3N0YXJ0LAotICAgICAg
ICAgICAgaXZyc19tYXBwaW5nc1tyZXFfaWRdLmFkZHJfcmFuZ2VfbGVuZ3Ro
LAotICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFfaWRdLndyaXRlX3Bl
cm1pc3Npb24sCi0gICAgICAgICAgICBpdnJzX21hcHBpbmdzW3JlcV9pZF0u
cmVhZF9wZXJtaXNzaW9uKTsKKyAgICAgICAgaW50IHJjID0gYW1kX2lvbW11
X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAgICAgICAgICAgICAg
ICAgIGQsIHVuaXR5X21hcC0+YWRkciwgdW5pdHlfbWFwLT5sZW5ndGgsCisg
ICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPndyaXRlLCB1bml0eV9t
YXAtPnJlYWQpOworCisgICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAg
cmV0dXJuIHJjOwogICAgIH0KIAogICAgIHJldHVybiByZWFzc2lnbl9kZXZp
Y2UocGRldi0+ZG9tYWluLCBkLCBkZXZmbiwgcGRldik7Ci0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvYW1kLWlvbW11LmgKKysrIGIveGVuL2luY2x1ZGUv
YXNtLXg4Ni9hbWQtaW9tbXUuaApAQCAtMTA4LDE1ICsxMDgsMTkgQEAgc3Ry
dWN0IGFtZF9pb21tdSB7CiAgICAgc3RydWN0IGxpc3RfaGVhZCBhdHNfZGV2
aWNlczsKIH07CiAKK3N0cnVjdCBpdnJzX3VuaXR5X21hcCB7CisgICAgYm9v
bCByZWFkOjE7CisgICAgYm9vbCB3cml0ZToxOworICAgIHBhZGRyX3QgYWRk
cjsKKyAgICB1bnNpZ25lZCBsb25nIGxlbmd0aDsKKyAgICBzdHJ1Y3QgaXZy
c191bml0eV9tYXAgKm5leHQ7Cit9OworCiBzdHJ1Y3QgaXZyc19tYXBwaW5n
cyB7CiAgICAgdTE2IGR0ZV9yZXF1ZXN0b3JfaWQ7CiAgICAgdTggZHRlX2Fs
bG93X2V4Y2x1c2lvbjsKLSAgICB1OCB1bml0eV9tYXBfZW5hYmxlOwotICAg
IHU4IHdyaXRlX3Blcm1pc3Npb247Ci0gICAgdTggcmVhZF9wZXJtaXNzaW9u
OwotICAgIHVuc2lnbmVkIGxvbmcgYWRkcl9yYW5nZV9zdGFydDsKLSAgICB1
bnNpZ25lZCBsb25nIGFkZHJfcmFuZ2VfbGVuZ3RoOwogICAgIHN0cnVjdCBh
bWRfaW9tbXUgKmlvbW11OworICAgIHN0cnVjdCBpdnJzX3VuaXR5X21hcCAq
dW5pdHlfbWFwOwogCiAgICAgLyogcGVyIGRldmljZSBpbnRlcnJ1cHQgcmVt
YXBwaW5nIHRhYmxlICovCiAgICAgdm9pZCAqaW50cmVtYXBfdGFibGU7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-3.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogYWxzbyBwYXNzIHAybV9hY2Nlc3NfdCB0byBwMm1fZ2V0X2lv
bW11X2ZsYWdzKCkKCkEgc3Vic2VxdWVudCBjaGFuZ2Ugd2lsbCB3YW50IHRv
IGN1c3RvbWl6ZSB0aGUgSU9NTVUgcGVybWlzc2lvbnMgYmFzZWQKb24gdGhp
cy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTY3Miw3ICs2NzIsNyBAQCBlcHRfc2V0X2VudHJ5KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sIGdmCiAgICAgdWludDhfdCBpcGF0ID0gMDsKICAg
ICBib29sX3QgbmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMTsKICAgICBib29s
X3QgdnRkX3B0ZV9wcmVzZW50ID0gMDsKLSAgICB1bnNpZ25lZCBpbnQgaW9t
bXVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIG1mbik7Cisg
ICAgdW5zaWduZWQgaW50IGlvbW11X2ZsYWdzID0gcDJtX2dldF9pb21tdV9m
bGFncyhwMm10LCBwMm1hLCBtZm4pOwogICAgIGJvb2xfdCBuZWVkc19zeW5j
ID0gMTsKICAgICBlcHRfZW50cnlfdCBvbGRfZW50cnkgPSB7IC5lcHRlID0g
MCB9OwogICAgIGVwdF9lbnRyeV90IG5ld19lbnRyeSA9IHsgLmVwdGUgPSAw
IH07CkBAIC03OTksOCArNzk5LDggQEAgZXB0X3NldF9lbnRyeShzdHJ1Y3Qg
cDJtX2RvbWFpbiAqcDJtLCBnZgogCiAgICAgICAgIC8qIFNhZmUgdG8gcmVh
ZC10aGVuLXdyaXRlIGJlY2F1c2Ugd2UgaG9sZCB0aGUgcDJtIGxvY2sgKi8K
ICAgICAgICAgaWYgKCBlcHRfZW50cnktPm1mbiA9PSBuZXdfZW50cnkubWZu
ICYmCi0gICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhlcHRfZW50
cnktPnNhX3AybXQsIF9tZm4oZXB0X2VudHJ5LT5tZm4pKSA9PQotICAgICAg
ICAgICAgIGlvbW11X2ZsYWdzICkKKyAgICAgICAgICAgICBwMm1fZ2V0X2lv
bW11X2ZsYWdzKGVwdF9lbnRyeS0+c2FfcDJtdCwgZXB0X2VudHJ5LT5hY2Nl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWZuKGVw
dF9lbnRyeS0+bWZuKSkgPT0gaW9tbXVfZmxhZ3MgKQogICAgICAgICAgICAg
bmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMDsKIAogICAgICAgICBlcHRfcDJt
X3R5cGVfdG9fZmxhZ3MocDJtLCAmbmV3X2VudHJ5LCBwMm10LCBwMm1hKTsK
LS0tIGEveGVuL2FyY2gveDg2L21tL3AybS1wdC5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9tbS9wMm0tcHQuYwpAQCAtNTEyLDYgKzUxMiwxNiBAQCBpbnQgcDJt
X3B0X2hhbmRsZV9kZWZlcnJlZF9jaGFuZ2VzKHVpbnQ2CiAgICAgcmV0dXJu
IHJjOwogfQogCisvKiBSZWNvbnN0cnVjdCBhIGZha2UgcDJtX2FjY2Vzc190
IGZyb20gc3RvcmVkIFBURSBmbGFncy4gKi8KK3N0YXRpYyBwMm1fYWNjZXNz
X3QgcDJtX2ZsYWdzX3RvX2FjY2Vzcyh1bnNpZ25lZCBpbnQgZmxhZ3MpCit7
CisgICAgaWYgKCBmbGFncyAmIF9QQUdFX1BSRVNFTlQgKQorICAgICAgICBy
ZXR1cm4gcDJtX2FjY2Vzc19uOworCisgICAgLyogTm8gbmVlZCB0byBsb29r
IGF0IF9QQUdFX05YIGZvciBub3cuICovCisgICAgcmV0dXJuIGZsYWdzICYg
X1BBR0VfUlcgPyBwMm1fYWNjZXNzX3J3IDogcDJtX2FjY2Vzc19yOworfQor
CiAvKiBDaGVja3Mgb25seSBhcHBsaWNhYmxlIHRvIGVudHJpZXMgd2l0aCBv
cmRlciA+IFBBR0VfT1JERVJfNEsgKi8KIHN0YXRpYyB2b2lkIGNoZWNrX2Vu
dHJ5KG1mbl90IG1mbiwgcDJtX3R5cGVfdCBuZXcsIHAybV90eXBlX3Qgb2xk
LAogICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVy
KQpAQCAtNTQ2LDcgKzU1Niw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0
IHAybV9kb21haW4gKnAybSwKICAgICBsMl9wZ2VudHJ5X3QgbDJlX2NvbnRl
bnQ7CiAgICAgbDNfcGdlbnRyeV90IGwzZV9jb250ZW50OwogICAgIGludCBy
YzsKLSAgICB1bnNpZ25lZCBpbnQgaW9tbXVfcHRlX2ZsYWdzID0gcDJtX2dl
dF9pb21tdV9mbGFncyhwMm10LCBtZm4pOworICAgIHVuc2lnbmVkIGludCBp
b21tdV9wdGVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIHAy
bWEsIG1mbik7CiAgICAgLyoKICAgICAgKiBvbGRfbWZuIGFuZCBpb21tdV9v
bGRfZmxhZ3MgY29udHJvbCBwb3NzaWJsZSBmbHVzaC91cGRhdGUgbmVlZHMg
b24gdGhlCiAgICAgICogSU9NTVU6IFdlIG5lZWQgdG8gZmx1c2ggd2hlbiBN
Rk4gb3IgZmxhZ3MgKGkuZS4gcGVybWlzc2lvbnMpIGNoYW5nZS4KQEAgLTYw
OSw2ICs2MTksNyBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9t
YWluICpwMm0sCiAgICAgICAgICAgICAgICAgb2xkX21mbiA9IGwxZV9nZXRf
cGZuKCpwMm1fZW50cnkpOwogICAgICAgICAgICAgICAgIGlvbW11X29sZF9m
bGFncyA9CiAgICAgICAgICAgICAgICAgICAgIHAybV9nZXRfaW9tbXVfZmxh
Z3MocDJtX2ZsYWdzX3RvX3R5cGUoZmxhZ3MpLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9mbGFnc190b19hY2Nlc3Mo
ZmxhZ3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIF9tZm4ob2xkX21mbikpOwogICAgICAgICAgICAgfQogICAgICAgICAg
ICAgZWxzZQpAQCAtNjU0LDkgKzY2NSwxMCBAQCBwMm1fcHRfc2V0X2VudHJ5
KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIDAsIEwxX1BBR0VUQUJMRV9FTlRSSUVTKTsKICAg
ICAgICAgQVNTRVJUKHAybV9lbnRyeSk7CiAgICAgICAgIG9sZF9tZm4gPSBs
MWVfZ2V0X3BmbigqcDJtX2VudHJ5KTsKKyAgICAgICAgZmxhZ3MgPSBsMWVf
Z2V0X2ZsYWdzKCpwMm1fZW50cnkpOwogICAgICAgICBpb21tdV9vbGRfZmxh
Z3MgPQotICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxh
Z3NfdG9fdHlwZShsMWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkpKSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7Cisg
ICAgICAgICAgICBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV9mbGFnc190b190
eXBlKGZsYWdzKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyksIF9tZm4ob2xkX21mbikpOwog
CiAgICAgICAgIGlmICggbWZuX3ZhbGlkKG1mbikgfHwgcDJtX2FsbG93c19p
bnZhbGlkX21mbihwMm10KSApCiAgICAgICAgICAgICBlbnRyeV9jb250ZW50
ID0gcDJtX2wxZV9mcm9tX3BmbihtZm5feChtZm4pLApAQCAtNjg3LDYgKzY5
OSw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4gKnAy
bSwKICAgICAgICAgICAgICAgICBvbGRfbWZuID0gbDFlX2dldF9wZm4oKnAy
bV9lbnRyeSk7CiAgICAgICAgICAgICAgICAgaW9tbXVfb2xkX2ZsYWdzID0K
ICAgICAgICAgICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1f
ZmxhZ3NfdG9fdHlwZShmbGFncyksCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyks
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21m
bihvbGRfbWZuKSk7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNl
Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9wMm0uaApAQCAtODk5LDcgKzg5OSw4IEBAIHN0YXRp
YyBpbmxpbmUgdm9pZCBwMm1fYWx0cDJtX2NoZWNrKHN0cnUKIC8qCiAgKiBw
Mm0gdHlwZSB0byBJT01NVSBmbGFncwogICovCi1zdGF0aWMgaW5saW5lIHVu
c2lnbmVkIGludCBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV90eXBlX3QgcDJt
dCwgbWZuX3QgbWZuKQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJt
X2dldF9pb21tdV9mbGFncyhwMm1fdHlwZV90IHAybXQsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9hY2Nl
c3NfdCBwMm1hLCBtZm5fdCBtZm4pCiB7CiAgICAgdW5zaWduZWQgaW50IGZs
YWdzOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-4.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogZ2VuZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVk
IFJNUlIgcmVnaW9ucwoKSW4gb3JkZXIgdG8gcmUtdXNlIGl0IGVsc2V3aGVy
ZSwgbW92ZSB0aGUgbG9naWMgdG8gdmVuZG9yIGluZGVwZW5kZW50CmNvZGUg
YW5kIHN0cmlwIGl0IG9mIFJNUlIgc3BlY2lmaWNzLgoKTm90ZSB0aGF0IHRo
ZSBwcmlvciAibWFwIiBwYXJhbWV0ZXIgZ2V0cyBmb2xkZWQgaW50byB0aGUg
bmV3ICJwMm1hIiBvbmUKKHdoaWNoIEFNRCBJT01NVSBjb2RlIHdpbGwgd2Fu
dCB0byBtYWtlIHVzZSBvZiksIGFzc2lnbmluZyBhbHRlcm5hdGl2ZQptZWFu
aW5nICgidW5tYXAiKSB0byBwMm1fYWNjZXNzX3guIFByZXBhcmUgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpIGFuZApwMm1fZ2V0X2lvbW11X2ZsYWdzKCkg
Zm9yIGdldHRpbmcgcGFzc2VkIGFjY2VzcyB0eXBlcyBvdGhlciB0aGFuCnAy
bV9hY2Nlc3NfcncgKGluIHRoZSBsYXR0ZXIgY2FzZSBqdXN0IGZvciBwMm1f
bW1pb19kaXJlY3QgcmVxdWVzdHMpLgoKTm90ZSBhbHNvIHRoYXQsIHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUsIGFuIG92ZXJsYXAgY2hlY2sgZ2V0cyBhZGRl
ZCB0bwp0aGUgbWFpbiBsb29wIG9mIGlvbW11X2lkZW50aXR5X21hcHBpbmco
KS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0x
MzQxLDcgKzEzNDEsNyBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShz
dHJ1Y3QgZG9tYWluCiAgICAgICAgIGlmICggIWhhc19pb21tdV9wdChkKSAp
CiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgcmV0dXJuIGlvbW11
X2xlZ2FjeV9tYXAoZCwgX2RmbihnZm5fbCksIF9tZm4oZ2ZuX2wpLCBQQUdF
X09SREVSXzRLLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJ
T01NVUZfcmVhZGFibGUgfCBJT01NVUZfd3JpdGFibGUpOworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwMm1fYWNjZXNzX3RvX2lvbW11X2Zs
YWdzKHAybWEpKTsKICAgICB9CiAKICAgICBnZm5fbG9jayhwMm0sIGdmbiwg
MCk7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5j
CisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCkBA
IC00MiwxMiArNDIsNiBAQAogI2luY2x1ZGUgInZ0ZC5oIgogI2luY2x1ZGUg
Ii4uL2F0cy5oIgogCi1zdHJ1Y3QgbWFwcGVkX3JtcnIgewotICAgIHN0cnVj
dCBsaXN0X2hlYWQgbGlzdDsKLSAgICB1NjQgYmFzZSwgZW5kOwotICAgIHVu
c2lnbmVkIGludCBjb3VudDsKLX07Ci0KIC8qIFBvc3NpYmxlIHVuZmlsdGVy
ZWQgTEFQSUMvTVNJIG1lc3NhZ2VzIGZyb20gdW50cnVzdGVkIHNvdXJjZXM/
ICovCiBib29sIF9fcmVhZF9tb3N0bHkgdW50cnVzdGVkX21zaTsKIApAQCAt
MTc4NywxNiArMTc4MSwxMSBAQCBvdXQ6CiBzdGF0aWMgdm9pZCBpb21tdV9k
b21haW5fdGVhcmRvd24oc3RydWN0IGRvbWFpbiAqZCkKIHsKICAgICBzdHJ1
Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRvbV9pb21tdShkKTsKLSAgICBzdHJ1
Y3QgbWFwcGVkX3JtcnIgKm1ybXJyLCAqdG1wOwogCiAgICAgaWYgKCBsaXN0
X2VtcHR5KCZhY3BpX2RyaGRfdW5pdHMpICkKICAgICAgICAgcmV0dXJuOwog
Ci0gICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlICggbXJtcnIsIHRtcCwg
JmhkLT5hcmNoLm1hcHBlZF9ybXJycywgbGlzdCApCi0gICAgewotICAgICAg
ICBsaXN0X2RlbCgmbXJtcnItPmxpc3QpOwotICAgICAgICB4ZnJlZShtcm1y
cik7Ci0gICAgfQorICAgIGlvbW11X2lkZW50aXR5X21hcF90ZWFyZG93bihk
KTsKIAogICAgIEFTU0VSVChpb21tdV9lbmFibGVkKTsKIApAQCAtMTk1NSw3
NCArMTk0NCw2IEBAIHN0YXRpYyB2b2lkIGlvbW11X3NldF9wZ2Qoc3RydWN0
IGRvbWFpbgogICAgICAgICBwYWdldGFibGVfZ2V0X3BhZGRyKHBhZ2V0YWJs
ZV9mcm9tX21mbihwZ2RfbWZuKSk7CiB9CiAKLXN0YXRpYyBpbnQgcm1ycl9p
ZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmQsIGJvb2xfdCBtYXAs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1
Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnIsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1MzIgZmxhZykKLXsKLSAgICB1bnNpZ25lZCBsb25n
IGJhc2VfcGZuID0gcm1yci0+YmFzZV9hZGRyZXNzID4+IFBBR0VfU0hJRlRf
NEs7Ci0gICAgdW5zaWduZWQgbG9uZyBlbmRfcGZuID0gUEFHRV9BTElHTl80
SyhybXJyLT5lbmRfYWRkcmVzcykgPj4gUEFHRV9TSElGVF80SzsKLSAgICBz
dHJ1Y3QgbWFwcGVkX3JtcnIgKm1ybXJyOwotICAgIHN0cnVjdCBkb21haW5f
aW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOwotCi0gICAgQVNTRVJUKHBjaWRl
dnNfbG9ja2VkKCkpOwotICAgIEFTU0VSVChybXJyLT5iYXNlX2FkZHJlc3Mg
PCBybXJyLT5lbmRfYWRkcmVzcyk7Ci0KLSAgICAvKgotICAgICAqIE5vIG5l
ZWQgdG8gYWNxdWlyZSBoZC0+YXJjaC5tYXBwaW5nX2xvY2s6IEJvdGggaW5z
ZXJ0aW9uIGFuZCByZW1vdmFsCi0gICAgICogZ2V0IGRvbmUgd2hpbGUgaG9s
ZGluZyBwY2lkZXZzX2xvY2suCi0gICAgICovCi0gICAgbGlzdF9mb3JfZWFj
aF9lbnRyeSggbXJtcnIsICZoZC0+YXJjaC5tYXBwZWRfcm1ycnMsIGxpc3Qg
KQotICAgIHsKLSAgICAgICAgaWYgKCBtcm1yci0+YmFzZSA9PSBybXJyLT5i
YXNlX2FkZHJlc3MgJiYKLSAgICAgICAgICAgICBtcm1yci0+ZW5kID09IHJt
cnItPmVuZF9hZGRyZXNzICkKLSAgICAgICAgewotICAgICAgICAgICAgaW50
IHJldCA9IDA7Ci0KLSAgICAgICAgICAgIGlmICggbWFwICkKLSAgICAgICAg
ICAgIHsKLSAgICAgICAgICAgICAgICArK21ybXJyLT5jb3VudDsKLSAgICAg
ICAgICAgICAgICByZXR1cm4gMDsKLSAgICAgICAgICAgIH0KLQotICAgICAg
ICAgICAgaWYgKCAtLW1ybXJyLT5jb3VudCApCi0gICAgICAgICAgICAgICAg
cmV0dXJuIDA7Ci0KLSAgICAgICAgICAgIHdoaWxlICggYmFzZV9wZm4gPCBl
bmRfcGZuICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICBpZiAo
IGNsZWFyX2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3BmbikgKQotICAg
ICAgICAgICAgICAgICAgICByZXQgPSAtRU5YSU87Ci0gICAgICAgICAgICAg
ICAgYmFzZV9wZm4rKzsKLSAgICAgICAgICAgIH0KLQotICAgICAgICAgICAg
bGlzdF9kZWwoJm1ybXJyLT5saXN0KTsKLSAgICAgICAgICAgIHhmcmVlKG1y
bXJyKTsKLSAgICAgICAgICAgIHJldHVybiByZXQ7Ci0gICAgICAgIH0KLSAg
ICB9Ci0KLSAgICBpZiAoICFtYXAgKQotICAgICAgICByZXR1cm4gLUVOT0VO
VDsKLQotICAgIHdoaWxlICggYmFzZV9wZm4gPCBlbmRfcGZuICkKLSAgICB7
Ci0gICAgICAgIGludCBlcnIgPSBzZXRfaWRlbnRpdHlfcDJtX2VudHJ5KGQs
IGJhc2VfcGZuLCBwMm1fYWNjZXNzX3J3LCBmbGFnKTsKLQotICAgICAgICBp
ZiAoIGVyciApCi0gICAgICAgICAgICByZXR1cm4gZXJyOwotICAgICAgICBi
YXNlX3BmbisrOwotICAgIH0KLQotICAgIG1ybXJyID0geG1hbGxvYyhzdHJ1
Y3QgbWFwcGVkX3JtcnIpOwotICAgIGlmICggIW1ybXJyICkKLSAgICAgICAg
cmV0dXJuIC1FTk9NRU07Ci0gICAgbXJtcnItPmJhc2UgPSBybXJyLT5iYXNl
X2FkZHJlc3M7Ci0gICAgbXJtcnItPmVuZCA9IHJtcnItPmVuZF9hZGRyZXNz
OwotICAgIG1ybXJyLT5jb3VudCA9IDE7Ci0gICAgbGlzdF9hZGRfdGFpbCgm
bXJtcnItPmxpc3QsICZoZC0+YXJjaC5tYXBwZWRfcm1ycnMpOwotCi0gICAg
cmV0dXJuIDA7Ci19Ci0KIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfYWRkX2Rl
dmljZSh1OCBkZXZmbiwgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiB7CiAgICAg
c3RydWN0IGFjcGlfcm1ycl91bml0ICpybXJyOwpAQCAtMjA1NCw3ICsxOTc1
LDkgQEAgc3RhdGljIGludCBpbnRlbF9pb21tdV9hZGRfZGV2aWNlKHU4IGRl
dgogICAgICAgICAgICAgICogU2luY2UgUk1SUnMgYXJlIGFsd2F5cyByZXNl
cnZlZCBpbiB0aGUgZTgyMCBtYXAgZm9yIHRoZSBoYXJkd2FyZQogICAgICAg
ICAgICAgICogZG9tYWluLCB0aGVyZSBzaG91bGRuJ3QgYmUgYSBjb25mbGlj
dC4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgcmV0ID0gcm1ycl9p
ZGVudGl0eV9tYXBwaW5nKHBkZXYtPmRvbWFpbiwgMSwgcm1yciwgMCk7Cisg
ICAgICAgICAgICByZXQgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKHBkZXYt
PmRvbWFpbiwgcDJtX2FjY2Vzc19ydywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcm1yci0+YmFzZV9hZGRyZXNzLCBybXJy
LT5lbmRfYWRkcmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgMCk7CiAgICAgICAgICAgICBpZiAoIHJldCApCiAgICAg
ICAgICAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJWCwgImQl
ZDogUk1SUiBtYXBwaW5nIGZhaWxlZFxuIiwKICAgICAgICAgICAgICAgICAg
ICAgICAgIHBkZXYtPmRvbWFpbi0+ZG9tYWluX2lkKTsKQEAgLTIwOTksNyAr
MjAyMiw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfcmVtb3ZlX2Rldmlj
ZSh1OAogICAgICAgICAgKiBBbnkgZmxhZyBpcyBub3RoaW5nIHRvIGNsZWFy
IHRoZXNlIG1hcHBpbmdzIGJ1dCBoZXJlCiAgICAgICAgICAqIGl0cyBhbHdh
eXMgc2FmZSBhbmQgc3RyaWN0IHRvIHNldCAwLgogICAgICAgICAgKi8KLSAg
ICAgICAgcm1ycl9pZGVudGl0eV9tYXBwaW5nKHBkZXYtPmRvbWFpbiwgMCwg
cm1yciwgMCk7CisgICAgICAgIGlvbW11X2lkZW50aXR5X21hcHBpbmcocGRl
di0+ZG9tYWluLCBwMm1fYWNjZXNzX3gsIHJtcnItPmJhc2VfYWRkcmVzcywK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5lbmRfYWRk
cmVzcywgMCk7CiAgICAgfQogCiAgICAgcmV0dXJuIGRvbWFpbl9jb250ZXh0
X3VubWFwKHBkZXYtPmRvbWFpbiwgZGV2Zm4sIHBkZXYpOwpAQCAtMjI2Niw3
ICsyMTkwLDggQEAgc3RhdGljIHZvaWQgX19od2RvbV9pbml0IHNldHVwX2h3
ZG9tX3JtcgogICAgICAgICAgKiBkb21haW4sIHRoZXJlIHNob3VsZG4ndCBi
ZSBhIGNvbmZsaWN0LiBTbyBpdHMgYWx3YXlzIHNhZmUgYW5kCiAgICAgICAg
ICAqIHN0cmljdCB0byBzZXQgMC4KICAgICAgICAgICovCi0gICAgICAgIHJl
dCA9IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhkLCAxLCBybXJyLCAwKTsKKyAg
ICAgICAgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhkLCBwMm1fYWNj
ZXNzX3J3LCBybXJyLT5iYXNlX2FkZHJlc3MsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcm1yci0+ZW5kX2FkZHJlc3MsIDApOwog
ICAgICAgICBpZiAoIHJldCApCiAgICAgICAgICAgICBkcHJpbnRrKFhFTkxP
R19FUlIgVlREUFJFRklYLAogICAgICAgICAgICAgICAgICAgICAgIklPTU1V
OiBtYXBwaW5nIHJlc2VydmVkIHJlZ2lvbiBmYWlsZWRcbiIpOwpAQCAtMjQy
NSw3ICsyMzUwLDkgQEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Vfb3du
ZXJzaGlwKAogICAgICAgICAgICAgICAgICAqIEFueSBSTVJSIGZsYWcgaXMg
YWx3YXlzIGlnbm9yZWQgd2hlbiByZW1vdmUgYSBkZXZpY2UsCiAgICAgICAg
ICAgICAgICAgICogYnV0IGl0cyBhbHdheXMgc2FmZSBhbmQgc3RyaWN0IHRv
IHNldCAwLgogICAgICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgICAg
IHJldCA9IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhzb3VyY2UsIDAsIHJtcnIs
IDApOworICAgICAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50aXR5X21h
cHBpbmcoc291cmNlLCBwMm1fYWNjZXNzX3gsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5iYXNlX2FkZHJl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBybXJyLT5lbmRfYWRkcmVzcywgMCk7CiAgICAgICAgICAgICAgICAg
aWYgKCByZXQgIT0gLUVOT0VOVCApCiAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiByZXQ7CiAgICAgICAgICAgICB9CkBAIC0yNTIyLDcgKzI0NDksOCBA
QCBzdGF0aWMgaW50IGludGVsX2lvbW11X2Fzc2lnbl9kZXZpY2UoCiAgICAg
ICAgICAgICAgUENJX0JVUyhiZGYpID09IGJ1cyAmJgogICAgICAgICAgICAg
IFBDSV9ERVZGTjIoYmRmKSA9PSBkZXZmbiApCiAgICAgICAgIHsKLSAgICAg
ICAgICAgIHJldCA9IHJtcnJfaWRlbnRpdHlfbWFwcGluZyhkLCAxLCBybXJy
LCBmbGFnKTsKKyAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50aXR5X21h
cHBpbmcoZCwgcDJtX2FjY2Vzc19ydywgcm1yci0+YmFzZV9hZGRyZXNzLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJy
LT5lbmRfYWRkcmVzcywgZmxhZyk7CiAgICAgICAgICAgICBpZiAoIHJldCAp
CiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaW50IHJjOwotLS0g
YS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYworKysgYi94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYwpAQCAtMTUwLDcg
KzE1MCw3IEBAIGludCBhcmNoX2lvbW11X2RvbWFpbl9pbml0KHN0cnVjdCBk
b21haW4KICAgICBzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRvbV9pb21t
dShkKTsKIAogICAgIHNwaW5fbG9ja19pbml0KCZoZC0+YXJjaC5tYXBwaW5n
X2xvY2spOwotICAgIElOSVRfTElTVF9IRUFEKCZoZC0+YXJjaC5tYXBwZWRf
cm1ycnMpOworICAgIElOSVRfTElTVF9IRUFEKCZoZC0+YXJjaC5pZGVudGl0
eV9tYXBzKTsKIAogICAgIHJldHVybiAwOwogfQpAQCAtMTU5LDYgKzE1OSw5
OSBAQCB2b2lkIGFyY2hfaW9tbXVfZG9tYWluX2Rlc3Ryb3koc3RydWN0IGRv
CiB7CiB9CiAKK3N0cnVjdCBpZGVudGl0eV9tYXAgeworICAgIHN0cnVjdCBs
aXN0X2hlYWQgbGlzdDsKKyAgICBwYWRkcl90IGJhc2UsIGVuZDsKKyAgICBw
Mm1fYWNjZXNzX3QgYWNjZXNzOworICAgIHVuc2lnbmVkIGludCBjb3VudDsK
K307CisKK2ludCBpb21tdV9pZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBkb21h
aW4gKmQsIHAybV9hY2Nlc3NfdCBwMm1hLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90IGVuZCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFnKQoreworICAg
IHVuc2lnbmVkIGxvbmcgYmFzZV9wZm4gPSBiYXNlID4+IFBBR0VfU0hJRlRf
NEs7CisgICAgdW5zaWduZWQgbG9uZyBlbmRfcGZuID0gUEFHRV9BTElHTl80
SyhlbmQpID4+IFBBR0VfU0hJRlRfNEs7CisgICAgc3RydWN0IGlkZW50aXR5
X21hcCAqbWFwOworICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOworCisgICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOwor
ICAgIEFTU0VSVChiYXNlIDwgZW5kKTsKKworICAgIC8qCisgICAgICogTm8g
bmVlZCB0byBhY3F1aXJlIGhkLT5hcmNoLm1hcHBpbmdfbG9jazogQm90aCBp
bnNlcnRpb24gYW5kIHJlbW92YWwKKyAgICAgKiBnZXQgZG9uZSB3aGlsZSBo
b2xkaW5nIHBjaWRldnNfbG9jay4KKyAgICAgKi8KKyAgICBsaXN0X2Zvcl9l
YWNoX2VudHJ5KCBtYXAsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBzLCBsaXN0
ICkKKyAgICB7CisgICAgICAgIGlmICggbWFwLT5iYXNlID09IGJhc2UgJiYg
bWFwLT5lbmQgPT0gZW5kICkKKyAgICAgICAgeworICAgICAgICAgICAgaW50
IHJldCA9IDA7CisKKyAgICAgICAgICAgIGlmICggcDJtYSAhPSBwMm1fYWNj
ZXNzX3ggKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIGlmICgg
bWFwLT5hY2Nlc3MgIT0gcDJtYSApCisgICAgICAgICAgICAgICAgICAgIHJl
dHVybiAtRUFERFJJTlVTRTsKKyAgICAgICAgICAgICAgICArK21hcC0+Y291
bnQ7CisgICAgICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAgICAgICB9
CisKKyAgICAgICAgICAgIGlmICggLS1tYXAtPmNvdW50ICkKKyAgICAgICAg
ICAgICAgICByZXR1cm4gMDsKKworICAgICAgICAgICAgd2hpbGUgKCBiYXNl
X3BmbiA8IGVuZF9wZm4gKQorICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgIGlmICggY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KGQsIGJhc2VfcGZu
KSApCisgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FTlhJTzsKKyAgICAg
ICAgICAgICAgICBiYXNlX3BmbisrOworICAgICAgICAgICAgfQorCisgICAg
ICAgICAgICBsaXN0X2RlbCgmbWFwLT5saXN0KTsKKyAgICAgICAgICAgIHhm
cmVlKG1hcCk7CisKKyAgICAgICAgICAgIHJldHVybiByZXQ7CisgICAgICAg
IH0KKworICAgICAgICBpZiAoIGVuZCA+PSBtYXAtPmJhc2UgJiYgbWFwLT5l
bmQgPj0gYmFzZSApCisgICAgICAgICAgICByZXR1cm4gLUVBRERSSU5VU0U7
CisgICAgfQorCisgICAgaWYgKCBwMm1hID09IHAybV9hY2Nlc3NfeCApCisg
ICAgICAgIHJldHVybiAtRU5PRU5UOworCisgICAgd2hpbGUgKCBiYXNlX3Bm
biA8IGVuZF9wZm4gKQorICAgIHsKKyAgICAgICAgaW50IGVyciA9IHNldF9p
ZGVudGl0eV9wMm1fZW50cnkoZCwgYmFzZV9wZm4sIHAybWEsIGZsYWcpOwor
CisgICAgICAgIGlmICggZXJyICkKKyAgICAgICAgICAgIHJldHVybiBlcnI7
CisgICAgICAgIGJhc2VfcGZuKys7CisgICAgfQorCisgICAgbWFwID0geG1h
bGxvYyhzdHJ1Y3QgaWRlbnRpdHlfbWFwKTsKKyAgICBpZiAoICFtYXAgKQor
ICAgICAgICByZXR1cm4gLUVOT01FTTsKKyAgICBtYXAtPmJhc2UgPSBiYXNl
OworICAgIG1hcC0+ZW5kID0gZW5kOworICAgIG1hcC0+YWNjZXNzID0gcDJt
YTsKKyAgICBtYXAtPmNvdW50ID0gMTsKKyAgICBsaXN0X2FkZF90YWlsKCZt
YXAtPmxpc3QsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBzKTsKKworICAgIHJl
dHVybiAwOworfQorCit2b2lkIGlvbW11X2lkZW50aXR5X21hcF90ZWFyZG93
bihzdHJ1Y3QgZG9tYWluICpkKQoreworICAgIHN0cnVjdCBkb21haW5faW9t
bXUgKmhkID0gZG9tX2lvbW11KGQpOworICAgIHN0cnVjdCBpZGVudGl0eV9t
YXAgKm1hcCwgKnRtcDsKKworICAgIGxpc3RfZm9yX2VhY2hfZW50cnlfc2Fm
ZSAoIG1hcCwgdG1wLCAmaGQtPmFyY2guaWRlbnRpdHlfbWFwcywgbGlzdCAp
CisgICAgeworICAgICAgICBsaXN0X2RlbCgmbWFwLT5saXN0KTsKKyAgICAg
ICAgeGZyZWUobWFwKTsKKyAgICB9Cit9CisKIHN0YXRpYyBib29sIF9faHdk
b21faW5pdCBod2RvbV9pb21tdV9tYXAoY29uc3Qgc3RydWN0IGRvbWFpbiAq
ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbWF4X3BmbikKLS0tIGEv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9pb21tdS5oCisrKyBiL3hlbi9pbmNsdWRl
L2FzbS14ODYvaW9tbXUuaApAQCAtMTYsNiArMTYsNyBAQAogCiAjaW5jbHVk
ZSA8eGVuL2Vycm5vLmg+CiAjaW5jbHVkZSA8eGVuL2xpc3QuaD4KKyNpbmNs
dWRlIDx4ZW4vbWVtX2FjY2Vzcy5oPgogI2luY2x1ZGUgPHhlbi9zcGlubG9j
ay5oPgogI2luY2x1ZGUgPGFzbS9wcm9jZXNzb3IuaD4KICNpbmNsdWRlIDxh
c20vaHZtL3ZteC92bWNzLmg+CkBAIC00OCw3ICs0OSw3IEBAIHN0cnVjdCBh
cmNoX2lvbW11CiAgICAgc3BpbmxvY2tfdCBtYXBwaW5nX2xvY2s7ICAgICAg
ICAgICAgLyogaW8gcGFnZSB0YWJsZSBsb2NrICovCiAgICAgaW50IGFnYXc7
ICAgICAvKiBhZGp1c3RlZCBndWVzdCBhZGRyZXNzIHdpZHRoLCAwIGlzIGxl
dmVsIDIgMzAtYml0ICovCiAgICAgdTY0IGlvbW11X2JpdG1hcDsgICAgICAg
ICAgICAgIC8qIGJpdG1hcCBvZiBpb21tdShzKSB0aGF0IHRoZSBkb21haW4g
dXNlcyAqLwotICAgIHN0cnVjdCBsaXN0X2hlYWQgbWFwcGVkX3JtcnJzOwor
ICAgIHN0cnVjdCBsaXN0X2hlYWQgaWRlbnRpdHlfbWFwczsKIAogICAgIC8q
IGFtZCBpb21tdSBzdXBwb3J0ICovCiAgICAgaW50IHBhZ2luZ19tb2RlOwpA
QCAtOTQsNiArOTUsMTEgQEAgYm9vbF90IGlvbW11X3N1cHBvcnRzX2VpbSh2
b2lkKTsKIGludCBpb21tdV9lbmFibGVfeDJhcGljX0lSKHZvaWQpOwogdm9p
ZCBpb21tdV9kaXNhYmxlX3gyYXBpY19JUih2b2lkKTsKIAoraW50IGlvbW11
X2lkZW50aXR5X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZCwgcDJtX2FjY2Vz
c190IHAybWEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90
IGJhc2UsIHBhZGRyX3QgZW5kLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IGZsYWcpOwordm9pZCBpb21tdV9pZGVudGl0eV9t
YXBfdGVhcmRvd24oc3RydWN0IGRvbWFpbiAqZCk7CisKIGV4dGVybiBib29s
IHVudHJ1c3RlZF9tc2k7CiAKIGludCBwaV91cGRhdGVfaXJ0ZShjb25zdCBz
dHJ1Y3QgcGlfZGVzYyAqcGlfZGVzYywgY29uc3Qgc3RydWN0IHBpcnEgKnBp
cnEsCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9wMm0uaApAQCAtODk2LDYgKzg5NiwzNCBAQCBz
dHJ1Y3QgcDJtX2RvbWFpbiAqcDJtX2dldF9hbHRwMm0oc3RydWN0CiBzdGF0
aWMgaW5saW5lIHZvaWQgcDJtX2FsdHAybV9jaGVjayhzdHJ1Y3QgdmNwdSAq
diwgdWludDE2X3QgaWR4KSB7fQogI2VuZGlmCiAKKy8qIHAybSBhY2Nlc3Mg
dG8gSU9NTVUgZmxhZ3MgKi8KK3N0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50
IHAybV9hY2Nlc3NfdG9faW9tbXVfZmxhZ3MocDJtX2FjY2Vzc190IHAybWEp
Cit7CisgICAgc3dpdGNoICggcDJtYSApCisgICAgeworICAgIGNhc2UgcDJt
X2FjY2Vzc19ydzoKKyAgICBjYXNlIHAybV9hY2Nlc3Nfcnd4OgorICAgICAg
ICByZXR1cm4gSU9NTVVGX3JlYWRhYmxlIHwgSU9NTVVGX3dyaXRhYmxlOwor
CisgICAgY2FzZSBwMm1fYWNjZXNzX3I6CisgICAgY2FzZSBwMm1fYWNjZXNz
X3J4OgorICAgIGNhc2UgcDJtX2FjY2Vzc19yeDJydzoKKyAgICAgICAgcmV0
dXJuIElPTU1VRl9yZWFkYWJsZTsKKworICAgIGNhc2UgcDJtX2FjY2Vzc193
OgorICAgIGNhc2UgcDJtX2FjY2Vzc193eDoKKyAgICAgICAgcmV0dXJuIElP
TU1VRl93cml0YWJsZTsKKworICAgIGNhc2UgcDJtX2FjY2Vzc19uOgorICAg
IGNhc2UgcDJtX2FjY2Vzc194OgorICAgIGNhc2UgcDJtX2FjY2Vzc19uMnJ3
eDoKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorCisgICAgQVNTRVJUX1VO
UkVBQ0hBQkxFKCk7CisgICAgcmV0dXJuIDA7Cit9CisKIC8qCiAgKiBwMm0g
dHlwZSB0byBJT01NVSBmbGFncwogICovCkBAIC05MTcsOSArOTQ1LDEwIEBA
IHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IHAybV9nZXRfaW9tbXUKICAg
ICAgICAgZmxhZ3MgPSBJT01NVUZfcmVhZGFibGU7CiAgICAgICAgIGJyZWFr
OwogICAgIGNhc2UgcDJtX21taW9fZGlyZWN0OgotICAgICAgICBmbGFncyA9
IElPTU1VRl9yZWFkYWJsZTsKLSAgICAgICAgaWYgKCAhcmFuZ2VzZXRfY29u
dGFpbnNfc2luZ2xldG9uKG1taW9fcm9fcmFuZ2VzLCBtZm5feChtZm4pKSAp
Ci0gICAgICAgICAgICBmbGFncyB8PSBJT01NVUZfd3JpdGFibGU7CisgICAg
ICAgIGZsYWdzID0gcDJtX2FjY2Vzc190b19pb21tdV9mbGFncyhwMm1hKTsK
KyAgICAgICAgaWYgKCAoZmxhZ3MgJiBJT01NVUZfd3JpdGFibGUpICYmCisg
ICAgICAgICAgICAgcmFuZ2VzZXRfY29udGFpbnNfc2luZ2xldG9uKG1taW9f
cm9fcmFuZ2VzLCBtZm5feChtZm4pKSApCisgICAgICAgICAgICBmbGFncyAm
PSB+SU9NTVVGX3dyaXRhYmxlOwogICAgICAgICBicmVhazsKICAgICBkZWZh
dWx0OgogICAgICAgICBmbGFncyA9IDA7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-5.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UvY29tcGxldGUgcmUtYXNzaWdubWVu
dCBoYW5kbGluZwoKUHJpb3IgdG8gdGhlIGFzc2lnbm1lbnQgc3RlcCBoYXZp
bmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgZGV2aWNlcwpzaG91bGQgbm90
IGdldCBhc3NvY2lhdGVkIHdpdGggdGhlaXIgbmV3IG93bmVyLiBIYW5kIHRo
ZSBkZXZpY2UgdG8gRG9tSU8KKHBlcmhhcHMgdGVtcG9yYXJpbHkpLCB1bnRp
bCBhZnRlciB0aGUgZGUtYXNzaWdubWVudCBzdGVwIGhhcyBjb21wbGV0ZWQu
CgpEZS1hc3NpZ25tZW50IG9mIGEgZGV2aWNlIChmcm9tIG90aGVyIHRoYW4g
RG9tMCkgYXMgd2VsbCBhcyBmYWlsdXJlIG9mCnJlYXNzaWduX2RldmljZSgp
IGR1cmluZyBhc3NpZ25tZW50IHNob3VsZCByZXN1bHQgaW4gdW5pdHkgbWFw
cGluZ3MKZ2V0dGluZyB0b3JuIGRvd24uIFRoaXMgaW4gdHVybiByZXF1aXJl
cyBzd2l0Y2hpbmcgdG8gYSByZWZjb3VudGVkCm1hcHBpbmcgYXBwcm9hY2gs
IGFzIHdhcyBhbHJlYWR5IHVzZWQgYnkgVlQtZCBmb3IgaXRzIFJNUlJzLCB0
byBwcmV2ZW50CnVubWFwcGluZyBhIHJlZ2lvbiB1c2VkIGJ5IG11bHRpcGxl
IGRldmljZXMuCgpUaGlzIGlzIENWRS0yMDIxLTI4Njk2IC8gcGFydCBvZiBY
U0EtMzc4LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfbWFwLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X21hcC5jCkBAIC02MTMsMzggKzYxMyw0OSBAQCBpbnQgYW1kX2lvbW11
X2ZsdXNoX2lvdGxiX2FsbChzdHJ1Y3QgZG9tCiAgICAgcmV0dXJuIDA7CiB9
CiAKLWludCBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKHN0
cnVjdCBkb21haW4gKmRvbWFpbiwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZGRyX3QgcGh5c19hZGRyLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBz
aXplLCBpbnQgaXcsIGludCBpcikKK2ludCBhbWRfaW9tbXVfcmVzZXJ2ZV9k
b21haW5fdW5pdHlfbWFwKHN0cnVjdCBkb21haW4gKmQsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaXZy
c191bml0eV9tYXAgKm1hcCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFnKQogewotICAgIHVuc2ln
bmVkIGxvbmcgbnBhZ2VzLCBpOwotICAgIHVuc2lnbmVkIGxvbmcgZ2ZuOwot
ICAgIHVuc2lnbmVkIGludCBmbGFncyA9ICEhaXI7Ci0gICAgdW5zaWduZWQg
aW50IGZsdXNoX2ZsYWdzID0gMDsKLSAgICBpbnQgcnQgPSAwOwotCi0gICAg
aWYgKCBpdyApCi0gICAgICAgIGZsYWdzIHw9IElPTU1VRl93cml0YWJsZTsK
LQotICAgIG5wYWdlcyA9IHJlZ2lvbl90b19wYWdlcyhwaHlzX2FkZHIsIHNp
emUpOwotICAgIGdmbiA9IHBoeXNfYWRkciA+PiBQQUdFX1NISUZUOwotICAg
IGZvciAoIGkgPSAwOyBpIDwgbnBhZ2VzOyBpKysgKQorICAgIGludCByYzsK
KworICAgIGlmICggZCA9PSBkb21faW8gKQorICAgICAgICByZXR1cm4gMDsK
KworICAgIGZvciAoIHJjID0gMDsgIXJjICYmIG1hcDsgbWFwID0gbWFwLT5u
ZXh0ICkKICAgICB7Ci0gICAgICAgIHVuc2lnbmVkIGxvbmcgZnJhbWUgPSBn
Zm4gKyBpOworICAgICAgICBwMm1fYWNjZXNzX3QgcDJtYSA9IHAybV9hY2Nl
c3NfbjsKKworICAgICAgICBpZiAoIG1hcC0+cmVhZCApCisgICAgICAgICAg
ICBwMm1hIHw9IHAybV9hY2Nlc3NfcjsKKyAgICAgICAgaWYgKCBtYXAtPndy
aXRlICkKKyAgICAgICAgICAgIHAybWEgfD0gcDJtX2FjY2Vzc193OwogCi0g
ICAgICAgIHJ0ID0gYW1kX2lvbW11X21hcF9wYWdlKGRvbWFpbiwgX2Rmbihm
cmFtZSksIF9tZm4oZnJhbWUpLCBmbGFncywKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJmZsdXNoX2ZsYWdzKTsKLSAgICAgICAgaWYgKCBy
dCAhPSAwICkKLSAgICAgICAgICAgIGJyZWFrOworICAgICAgICByYyA9IGlv
bW11X2lkZW50aXR5X21hcHBpbmcoZCwgcDJtYSwgbWFwLT5hZGRyLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLT5hZGRyICsg
bWFwLT5sZW5ndGggLSAxLCBmbGFnKTsKICAgICB9CiAKLSAgICAvKiBVc2Ug
d2hpbGUtYnJlYWsgdG8gYXZvaWQgY29tcGlsZXIgd2FybmluZyAqLwotICAg
IHdoaWxlICggZmx1c2hfZmxhZ3MgJiYKLSAgICAgICAgICAgIGFtZF9pb21t
dV9mbHVzaF9pb3RsYl9wYWdlcyhkb21haW4sIF9kZm4oZ2ZuKSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucGFnZXMsIGZs
dXNoX2ZsYWdzKSApCi0gICAgICAgIGJyZWFrOworICAgIHJldHVybiByYzsK
K30KKworaW50IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV91bm1h
cChzdHJ1Y3QgZG9tYWluICpkLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaXZyc191bml0eV9tYXAg
Km1hcCkKK3sKKyAgICBpbnQgcmM7CisKKyAgICBpZiAoIGQgPT0gZG9tX2lv
ICkKKyAgICAgICAgcmV0dXJuIDA7CisKKyAgICBmb3IgKCByYyA9IDA7IG1h
cDsgbWFwID0gbWFwLT5uZXh0ICkKKyAgICB7CisgICAgICAgIGludCByZXQg
PSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKGQsIHAybV9hY2Nlc3NfeCwgbWFw
LT5hZGRyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBtYXAtPmFkZHIgKyBtYXAtPmxlbmd0aCAtIDEsIDApOworCisgICAg
ICAgIGlmICggcmV0ICYmIHJldCAhPSAtRU5PRU5UICYmICFyYyApCisgICAg
ICAgICAgICByYyA9IHJldDsKKyAgICB9CiAKLSAgICByZXR1cm4gcnQ7Cisg
ICAgcmV0dXJuIHJjOwogfQogCiAvKiBTaGFyZSBwMm0gdGFibGUgd2l0aCBp
b21tdS4gKi8KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3Bj
aV9hbWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9h
bWQvcGNpX2FtZF9pb21tdS5jCkBAIC0zMDcsNiArMzA3LDcgQEAgc3RhdGlj
IGludCByZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbgogICAgIHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11OwogICAgIGludCBiZGYsIHJjOwogICAgIHN0
cnVjdCBkb21haW5faW9tbXUgKnQgPSBkb21faW9tbXUodGFyZ2V0KTsKKyAg
ICBjb25zdCBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9
IGdldF9pdnJzX21hcHBpbmdzKHBkZXYtPnNlZyk7CiAKICAgICBiZGYgPSBQ
Q0lfQkRGMihwZGV2LT5idXMsIHBkZXYtPmRldmZuKTsKICAgICBpb21tdSA9
IGZpbmRfaW9tbXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7CkBAIC0z
MjEsMTAgKzMyMiwyNCBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2RldmljZShz
dHJ1Y3QgZG9tYWluCiAKICAgICBhbWRfaW9tbXVfZGlzYWJsZV9kb21haW5f
ZGV2aWNlKHNvdXJjZSwgaW9tbXUsIGRldmZuLCBwZGV2KTsKIAotICAgIGlm
ICggZGV2Zm4gPT0gcGRldi0+ZGV2Zm4gKQorICAgIC8qCisgICAgICogSWYg
dGhlIGRldmljZSBiZWxvbmdzIHRvIHRoZSBoYXJkd2FyZSBkb21haW4sIGFu
ZCBpdCBoYXMgYSB1bml0eSBtYXBwaW5nLAorICAgICAqIGRvbid0IHJlbW92
ZSBpdCBmcm9tIHRoZSBoYXJkd2FyZSBkb21haW4sIGJlY2F1c2UgQklPUyBt
YXkgcmVmZXJlbmNlIHRoYXQKKyAgICAgKiBtYXBwaW5nLgorICAgICAqLwor
ICAgIGlmICggIWlzX2hhcmR3YXJlX2RvbWFpbihzb3VyY2UpICkKKyAgICB7
CisgICAgICAgIHJjID0gYW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5
X3VubWFwKAorICAgICAgICAgICAgICAgICBzb3VyY2UsCisgICAgICAgICAg
ICAgICAgIGl2cnNfbWFwcGluZ3NbZ2V0X2RtYV9yZXF1ZXN0b3JfaWQocGRl
di0+c2VnLCBiZGYpXS51bml0eV9tYXApOworICAgICAgICBpZiAoIHJjICkK
KyAgICAgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBpZiAoIGRl
dmZuID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRvbWFpbiAhPSBkb21faW8g
KQogICAgIHsKLSAgICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21haW5fbGlz
dCwgJnRhcmdldC0+YXJjaC5wZGV2X2xpc3QpOwotICAgICAgICBwZGV2LT5k
b21haW4gPSB0YXJnZXQ7CisgICAgICAgIGxpc3RfbW92ZSgmcGRldi0+ZG9t
YWluX2xpc3QsICZkb21faW8tPmFyY2gucGRldl9saXN0KTsKKyAgICAgICAg
cGRldi0+ZG9tYWluID0gZG9tX2lvOwogICAgIH0KIAogICAgIHJjID0gYWxs
b2NhdGVfZG9tYWluX3Jlc291cmNlcyh0KTsKQEAgLTMzNiw2ICszNTEsMTIg
QEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbgog
ICAgICAgICAgICAgICAgICAgICBwZGV2LT5zZWcsIHBkZXYtPmJ1cywgUENJ
X1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbiksCiAgICAgICAgICAgICAg
ICAgICAgIHNvdXJjZS0+ZG9tYWluX2lkLCB0YXJnZXQtPmRvbWFpbl9pZCk7
CiAKKyAgICBpZiAoIGRldmZuID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRv
bWFpbiAhPSB0YXJnZXQgKQorICAgIHsKKyAgICAgICAgbGlzdF9tb3ZlKCZw
ZGV2LT5kb21haW5fbGlzdCwgJnRhcmdldC0+YXJjaC5wZGV2X2xpc3QpOwor
ICAgICAgICBwZGV2LT5kb21haW4gPSB0YXJnZXQ7CisgICAgfQorCiAgICAg
cmV0dXJuIDA7CiB9CiAKQEAgLTM0NiwyMCArMzY3LDI4IEBAIHN0YXRpYyBp
bnQgYW1kX2lvbW11X2Fzc2lnbl9kZXZpY2Uoc3RydWMKICAgICBzdHJ1Y3Qg
aXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBp
bmdzKHBkZXYtPnNlZyk7CiAgICAgaW50IGJkZiA9IFBDSV9CREYyKHBkZXYt
PmJ1cywgZGV2Zm4pOwogICAgIGludCByZXFfaWQgPSBnZXRfZG1hX3JlcXVl
c3Rvcl9pZChwZGV2LT5zZWcsIGJkZik7Ci0gICAgY29uc3Qgc3RydWN0IGl2
cnNfdW5pdHlfbWFwICp1bml0eV9tYXA7CisgICAgaW50IHJjID0gYW1kX2lv
bW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAgICAgICAgICAg
ICAgZCwgaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21hcCwgZmxhZyk7
CisKKyAgICBpZiAoICFyYyApCisgICAgICAgIHJjID0gcmVhc3NpZ25fZGV2
aWNlKHBkZXYtPmRvbWFpbiwgZCwgZGV2Zm4sIHBkZXYpOwogCi0gICAgZm9y
ICggdW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21h
cDsgdW5pdHlfbWFwOwotICAgICAgICAgIHVuaXR5X21hcCA9IHVuaXR5X21h
cC0+bmV4dCApCisgICAgaWYgKCByYyAmJiAhaXNfaGFyZHdhcmVfZG9tYWlu
KGQpICkKICAgICB7Ci0gICAgICAgIGludCByYyA9IGFtZF9pb21tdV9yZXNl
cnZlX2RvbWFpbl91bml0eV9tYXAoCi0gICAgICAgICAgICAgICAgICAgICBk
LCB1bml0eV9tYXAtPmFkZHIsIHVuaXR5X21hcC0+bGVuZ3RoLAotICAgICAg
ICAgICAgICAgICAgICAgdW5pdHlfbWFwLT53cml0ZSwgdW5pdHlfbWFwLT5y
ZWFkKTsKKyAgICAgICAgaW50IHJldCA9IGFtZF9pb21tdV9yZXNlcnZlX2Rv
bWFpbl91bml0eV91bm1hcCgKKyAgICAgICAgICAgICAgICAgICAgICBkLCBp
dnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwKTsKIAotICAgICAgICBp
ZiAoIHJjICkKLSAgICAgICAgICAgIHJldHVybiByYzsKKyAgICAgICAgaWYg
KCByZXQgKQorICAgICAgICB7CisgICAgICAgICAgICBwcmludGsoWEVOTE9H
X0VSUiAiQU1ELVZpOiAiCisgICAgICAgICAgICAgICAgICAgInVuaXR5LXVu
bWFwIGZvciAlcGQvJTA0eDolMDJ4OiUwMnguJXUgZmFpbGVkICglZClcbiIs
CisgICAgICAgICAgICAgICAgICAgZCwgcGRldi0+c2VnLCBwZGV2LT5idXMs
CisgICAgICAgICAgICAgICAgICAgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVO
QyhkZXZmbiksIHJldCk7CisgICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7
CisgICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1cm4gcmVhc3NpZ25fZGV2
aWNlKHBkZXYtPmRvbWFpbiwgZCwgZGV2Zm4sIHBkZXYpOworICAgIHJldHVy
biByYzsKIH0KIAogc3RhdGljIHZvaWQgZGVhbGxvY2F0ZV9uZXh0X3BhZ2Vf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGcsIGludCBsZXZlbCkKQEAgLTQy
NSw2ICs0NTQsNyBAQCBzdGF0aWMgdm9pZCBkZWFsbG9jYXRlX2lvbW11X3Bh
Z2VfdGFibGVzCiAKIHN0YXRpYyB2b2lkIGFtZF9pb21tdV9kb21haW5fZGVz
dHJveShzdHJ1Y3QgZG9tYWluICpkKQogeworICAgIGlvbW11X2lkZW50aXR5
X21hcF90ZWFyZG93bihkKTsKICAgICBkZWFsbG9jYXRlX2lvbW11X3BhZ2Vf
dGFibGVzKGQpOwogICAgIGFtZF9pb21tdV9mbHVzaF9hbGxfcGFnZXMoZCk7
CiB9Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9t
bXUtcHJvdG8uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9zdm0v
YW1kLWlvbW11LXByb3RvLmgKQEAgLTYyLDggKzYyLDEwIEBAIGludCBfX211
c3RfY2hlY2sgYW1kX2lvbW11X3VubWFwX3BhZ2Uoc3QKIHVpbnQ2NF90IGFt
ZF9pb21tdV9nZXRfYWRkcmVzc19mcm9tX3B0ZSh2b2lkICplbnRyeSk7CiBp
bnQgX19tdXN0X2NoZWNrIGFtZF9pb21tdV9hbGxvY19yb290KHN0cnVjdCBk
b21haW5faW9tbXUgKmhkKTsKIGludCBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21h
aW5fdW5pdHlfbWFwKHN0cnVjdCBkb21haW4gKmRvbWFpbiwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRyX3QgcGh5c19h
ZGRyLCB1bnNpZ25lZCBsb25nIHNpemUsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpbnQgaXcsIGludCBpcik7CisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
aXZyc191bml0eV9tYXAgKm1hcCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFnKTsKK2ludCBhbWRf
aW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAoc3RydWN0IGRvbWFp
biAqZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29uc3Qgc3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXApOwogaW50IF9f
bXVzdF9jaGVjayBhbWRfaW9tbXVfZmx1c2hfaW90bGJfcGFnZXMoc3RydWN0
IGRvbWFpbiAqZCwgZGZuX3QgZGZuLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHBhZ2VfY291
bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgZmx1c2hfZmxhZ3MpOwo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-6.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-6.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UgZXhjbHVzaW9uIHJhbmdlIGFuZCB1
bml0eSBtYXAgcmVjb3JkaW5nCgpUaGUgc3BlYyBtYWtlcyBubyBwcm92aXNp
b25zIGZvciBPUyBiZWhhdmlvciBoZXJlIHRvIGRlcGVuZCBvbiB0aGUKYW1v
dW50IG9mIFJBTSBmb3VuZCBvbiB0aGUgc3lzdGVtLiBXaGlsZSB0aGUgc3Bl
YyBtYXkgbm90IHN1ZmZpY2llbnRseQpjbGVhcmx5IGRpc3Rpbmd1aXNoIGJv
dGgga2luZHMgb2YgcmVnaW9ucywgdGhleSBhcmUgc3VyZWx5IG1lYW50IHRv
IGJlCnNlcGFyYXRlIHRoaW5nczogT25seSByZWdpb25zIHdpdGggQUNQSV9J
Vk1EX0VYQ0xVU0lPTl9SQU5HRSBzZXQgc2hvdWxkCmJlIGNhbmRpZGF0ZXMg
Zm9yIHB1dHRpbmcgaW4gdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3RlcnMu
IChBcyB0aGVyZSdzCm9ubHkgYSBzaW5nbGUgc3VjaCBwYWlyIG9mIHJlZ2lz
dGVycyBwZXIgSU9NTVUsIHNlY29uZGFyeSBub24tYWRqYWNlbnQKcmVnaW9u
cyB3aXRoIHRoZSBmbGFnIHNldCBhbHJlYWR5IGdldCBjb252ZXJ0ZWQgdG8g
dW5pdHkgbWFwcGVkCnJlZ2lvbnMuKQoKRmlyc3Qgb2YgYWxsLCBkcm9wIHRo
ZSBkZXBlbmRlbmN5IG9uIG1heF9wYWdlLiBXaXRoIGNvbW1pdCBiNGYwNDIy
MzZhZTAKKCJBTUQvSU9NTVU6IENlYXNlIHVzaW5nIGEgZHluYW1pYyBoZWln
aHQgZm9yIHRoZSBJT01NVSBwYWdldGFibGVzIikgdGhlCnVzZSBvZiBpdCBo
ZXJlIHdhcyBzdGFsZSBhbnl3YXk7IGl0IHdhcyBib2d1cyBhbHJlYWR5IGJl
Zm9yZSwgYXMgaXQKZGlkbid0IGFjY291bnQgZm9yIG1heF9wYWdlIGdldHRp
bmcgaW5jcmVhc2VkIGxhdGVyIG9uLiBTaW1wbHkgdHJ5IGFuCmV4Y2x1c2lv
biByYW5nZSByZWdpc3RyYXRpb24gZmlyc3QsIGFuZCBpZiBpdCBmYWlscyAo
Zm9yIGJlaW5nCnVuc3VpdGFibGUgb3Igbm9uLW1lcmdlYWJsZSksIHJlZ2lz
dGVyIGEgdW5pdHkgbWFwcGluZyByYW5nZS4KCldpdGggdGhpcyB2YXJpb3Vz
IGxvY2FsIHZhcmlhYmxlcyBiZWNvbWUgdW5uZWNlc3NhcnkgYW5kIGhlbmNl
IGdldApkcm9wcGVkIGF0IHRoZSBzYW1lIHRpbWUuCgpXaXRoIHRoZSBtYXhf
cGFnZSBib3VuZGFyeSBkcm9wcGVkIGZvciB1c2luZyB1bml0eSBtYXBzLCB0
aGUgbWluaW11bQpwYWdlIHRhYmxlIHRyZWUgaGVpZ2h0IG5vdyBuZWVkcyBi
b3RoIHJlY29yZGluZyBhbmQgZW5mb3JjaW5nIGluCmFtZF9pb21tdV9kb21h
aW5faW5pdCgpLiBTaW5jZSB3ZSBjYW4ndCBwcmVkaWN0IHdoaWNoIGRldmlj
ZXMgbWF5IGdldAphc3NpZ25lZCB0byBhIGRvbWFpbiwgb3VyIG9ubHkgb3B0
aW9uIGlzIHRvIHVuaWZvcm1seSBmb3JjZSBhdCBsZWFzdAp0aGF0IGhlaWdo
dCBmb3IgYWxsIGRvbWFpbnMsIG5vdyB0aGF0IHRoZSBoZWlnaHQgaXNuJ3Qg
ZHluYW1pYyBhbnltb3JlLgoKRnVydGhlciBkb24ndCBtYWtlIHVzZSBvZiB0
aGUgZXhjbHVzaW9uIHJhbmdlIHVubGVzcyBBQ1BJIGRhdGEgc2F5cyBzby4K
Ck5vdGUgdGhhdCBleGNsdXNpb24gcmFuZ2UgcmVnaXN0cmF0aW9uIGluCnJl
Z2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygpIGlzIG9uIGEgYmVzdCBl
ZmZvcnQgYmFzaXMuIEhlbmNlIHVuaXR5Cm1hcCBlbnRyaWVzIGFsc28gcmVn
aXN0ZXJlZCBhcmUgcmVkdW5kYW50IHdoZW4gdGhlIGZvcm1lciBzdWNjZWVk
ZWQsIGJ1dAp0aGV5IGFsc28gZG8gbm8gaGFybS4gSW1wcm92ZW1lbnRzIGlu
IHRoaXMgYXJlYSBjYW4gYmUgZG9uZSBsYXRlciBpbW8uCgpBbHNvIGFkanVz
dCB0eXBlcyB3aGVyZSBzdWl0YWJsZSB3aXRob3V0IHRvdWNoaW5nIGV4dHJh
IGxpbmVzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zNzguCgpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBQYXVsIER1cnJhbnQgPHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtOTks
MTIgKzk5LDggQEAgc3RhdGljIHN0cnVjdCBhbWRfaW9tbXUgKiBfX2luaXQg
ZmluZF9pbwogfQogCiBzdGF0aWMgaW50IF9faW5pdCByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZSgKLSAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSwgdWludDY0X3QgYmFzZSwgdWludDY0X3QgbGltaXQsCi0gICAgYm9vbCBh
bGwsIGJvb2wgaXcsIGJvb2wgaXIpCisgICAgc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUsIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwgYm9vbCBhbGwp
CiB7Ci0gICAgaWYgKCAhaXIgfHwgIWl3ICkKLSAgICAgICAgcmV0dXJuIC1F
UEVSTTsKLQogICAgIC8qIG5lZWQgdG8gZXh0ZW5kIGV4Y2x1c2lvbiByYW5n
ZT8gKi8KICAgICBpZiAoIGlvbW11LT5leGNsdXNpb25fZW5hYmxlICkKICAg
ICB7CkBAIC0xMzMsMTQgKzEyOSwxOCBAQCBzdGF0aWMgaW50IF9faW5pdCBy
ZXNlcnZlX3VuaXR5X21hcF9mb3JfCiB7CiAgICAgc3RydWN0IGl2cnNfbWFw
cGluZ3MgKml2cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcp
OwogICAgIHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwID0gaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcDsKKyAgICBpbnQgcGFnaW5nX21v
ZGUgPSBhbWRfaW9tbXVfZ2V0X3BhZ2luZ19tb2RlKFBGTl9VUChiYXNlICsg
bGVuZ3RoKSk7CisKKyAgICBpZiAoIHBhZ2luZ19tb2RlIDwgMCApCisgICAg
ICAgIHJldHVybiBwYWdpbmdfbW9kZTsKIAogICAgIC8qIENoZWNrIGZvciBv
dmVybGFwcy4gKi8KICAgICBmb3IgKCA7IHVuaXR5X21hcDsgdW5pdHlfbWFw
ID0gdW5pdHlfbWFwLT5uZXh0ICkKICAgICB7CiAgICAgICAgIC8qCiAgICAg
ICAgICAqIEV4YWN0IG1hdGNoZXMgYXJlIG9rYXkuIFRoaXMgY2FuIGluIHBh
cnRpY3VsYXIgaGFwcGVuIHdoZW4KLSAgICAgICAgICogcmVnaXN0ZXJfZXhj
bHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoKSBjYWxscyBoZXJlIHR3aWNlIGZv
ciB0aGUKLSAgICAgICAgICogc2FtZSAocyxiLGQsZikuCisgICAgICAgICAq
IHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2UoKSBjYWxscyBoZXJlIHR3aWNl
IGZvciB0aGUgc2FtZQorICAgICAgICAgKiAocyxiLGQsZikuCiAgICAgICAg
ICAqLwogICAgICAgICBpZiAoIGJhc2UgPT0gdW5pdHlfbWFwLT5hZGRyICYm
IGxlbmd0aCA9PSB1bml0eV9tYXAtPmxlbmd0aCAmJgogICAgICAgICAgICAg
IGlyID09IHVuaXR5X21hcC0+cmVhZCAmJiBpdyA9PSB1bml0eV9tYXAtPndy
aXRlICkKQEAgLTE2OCw1NSArMTY4LDUyIEBAIHN0YXRpYyBpbnQgX19pbml0
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl8KICAgICB1bml0eV9tYXAtPm5leHQg
PSBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwOwogICAgIGl2cnNfbWFw
cGluZ3NbYmRmXS51bml0eV9tYXAgPSB1bml0eV9tYXA7CiAKKyAgICBpZiAo
IHBhZ2luZ19tb2RlID4gYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZSApCisg
ICAgICAgIGFtZF9pb21tdV9taW5fcGFnaW5nX21vZGUgPSBwYWdpbmdfbW9k
ZTsKKwogICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IF9faW5pdCBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2FsbF9kZXZpY2VzKAotICAg
IHVuc2lnbmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCwgdTgg
aXcsIHU4IGlyKQorc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfcmFuZ2Vf
Zm9yX2FsbF9kZXZpY2VzKAorICAgIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBs
aW1pdCwgYm9vbCBpdywgYm9vbCBpciwgYm9vbCBleGNsdXNpb24pCiB7CiAg
ICAgaW50IHNlZyA9IDA7IC8qIFhYWCAqLwotICAgIHVuc2lnbmVkIGxvbmcg
cmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1k
X2lvbW11ICppb21tdTsKLSAgICB1bnNpZ25lZCBpbnQgYmRmOwogICAgIGlu
dCByYyA9IDA7CiAKICAgICAvKiBpcyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5n
ZSBpbnNpZGUgb2YgSU9NTVUgdmlydHVhbCBhZGRyZXNzIHNwYWNlPyAqLwog
ICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8g
YmUgcGFnZS1hbGlnbmVkICovCi0gICAgcmFuZ2VfdG9wID0gbGltaXQgKyBQ
QUdFX1NJWkU7Ci0gICAgaW9tbXVfdG9wID0gbWF4X3BhZ2UgKiBQQUdFX1NJ
WkU7Ci0gICAgaWYgKCBiYXNlIDwgaW9tbXVfdG9wICkKLSAgICB7Ci0gICAg
ICAgIGlmICggcmFuZ2VfdG9wID4gaW9tbXVfdG9wICkKLSAgICAgICAgICAg
IHJhbmdlX3RvcCA9IGlvbW11X3RvcDsKLSAgICAgICAgbGVuZ3RoID0gcmFu
Z2VfdG9wIC0gYmFzZTsKLSAgICAgICAgLyogcmVzZXJ2ZSByL3cgdW5pdHkt
bWFwcGVkIHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAqLwotICAgICAgICAv
KiBub3RlOiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNp
b24gcmFuZ2UgKi8KLSAgICAgICAgZm9yICggYmRmID0gMDsgIXJjICYmIGJk
ZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKLSAgICAgICAgICAgIHJj
ID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFz
ZSwgbGVuZ3RoLCBpdywgaXIpOwotICAgICAgICAvKiBwdXNoICdiYXNlJyBq
dXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCi0gICAg
ICAgIGJhc2UgPSBpb21tdV90b3A7Ci0gICAgfQotICAgIC8qIHJlZ2lzdGVy
IElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwotICAgIGlmICgg
IXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCApCisgICAgaWYgKCBleGNsdXNp
b24gKQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBpb21t
dSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21t
dV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVl
IC8qIGFsbCAqLywgaXcsIGlyKTsKLSAgICAgICAgICAgIGlmICggcmMgKQot
ICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgaW50IHJldCA9
IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBs
aW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0cnVlIC8qIGFsbCAqLyk7CisKKyAgICAgICAgICAg
IGlmICggcmV0ICYmICFyYyApCisgICAgICAgICAgICAgICAgcmMgPSByZXQ7
CiAgICAgICAgIH0KICAgICB9CiAKKyAgICBpZiAoICFleGNsdXNpb24gfHwg
cmMgKQorICAgIHsKKyAgICAgICAgcGFkZHJfdCBsZW5ndGggPSBsaW1pdCAr
IFBBR0VfU0laRSAtIGJhc2U7CisgICAgICAgIHVuc2lnbmVkIGludCBiZGY7
CisKKyAgICAgICAgLyogcmVzZXJ2ZSByL3cgdW5pdHktbWFwcGVkIHBhZ2Ug
ZW50cmllcyBmb3IgZGV2aWNlcyAqLworICAgICAgICBmb3IgKCBiZGYgPSBy
YyA9IDA7ICFyYyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyAp
CisgICAgICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZp
Y2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsKKyAgICB9CisK
ICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IHJlZ2lz
dGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfZGV2aWNlKAotICAgIHUxNiBiZGYs
IHVuc2lnbmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCwgdTgg
aXcsIHU4IGlyKQorc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfcmFuZ2Vf
Zm9yX2RldmljZSgKKyAgICB1bnNpZ25lZCBpbnQgYmRmLCBwYWRkcl90IGJh
c2UsIHBhZGRyX3QgbGltaXQsCisgICAgYm9vbCBpdywgYm9vbCBpciwgYm9v
bCBleGNsdXNpb24pCiB7CiAgICAgaW50IHNlZyA9IDA7IC8qIFhYWCAqLwog
ICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX21hcHBpbmdzID0gZ2V0
X2l2cnNfbWFwcGluZ3Moc2VnKTsKLSAgICB1bnNpZ25lZCBsb25nIHJhbmdl
X3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7CiAgICAgc3RydWN0IGFtZF9pb21t
dSAqaW9tbXU7CiAgICAgdTE2IHJlcTsKICAgICBpbnQgcmMgPSAwOwpAQCAt
MjMwLDI3ICsyMjcsMTkgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJf
ZXhjbHVzaW9uX3JhbgogICAgIHJlcSA9IGl2cnNfbWFwcGluZ3NbYmRmXS5k
dGVfcmVxdWVzdG9yX2lkOwogCiAgICAgLyogbm90ZTogJ2xpbWl0JyBwYXJh
bWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWduZWQgKi8KLSAgICBy
YW5nZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsKLSAgICBpb21tdV90b3Ag
PSBtYXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBpZiAoIGJhc2UgPCBpb21t
dV90b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCByYW5nZV90b3AgPiBpb21t
dV90b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9wID0gaW9tbXVfdG9wOwot
ICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOworICAgIGlmICgg
ZXhjbHVzaW9uICkKKyAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgLyogYWxsICov
KTsKKyAgICBpZiAoICFleGNsdXNpb24gfHwgcmMgKQorICAgIHsKKyAgICAg
ICAgcGFkZHJfdCBsZW5ndGggPSBsaW1pdCArIFBBR0VfU0laRSAtIGJhc2U7
CisKICAgICAgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRy
aWVzIGZvciBkZXZpY2UgKi8KLSAgICAgICAgLyogbm90ZTogdGhlc2UgZW50
cmllcyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCiAgICAg
ICAgIHJjID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJk
ZiwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpID86CiAgICAgICAgICAgICAgcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShzZWcsIHJlcSwgYmFzZSwgbGVu
Z3RoLCBpdywgaXIpOwotCi0gICAgICAgIC8qIHB1c2ggJ2Jhc2UnIGp1c3Qg
b3V0c2lkZSBvZiB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2UgKi8KLSAgICAgICAg
YmFzZSA9IGlvbW11X3RvcDsKICAgICB9Ci0KLSAgICAvKiByZWdpc3RlciBJ
T01NVSBleGNsdXNpb24gcmFuZ2Ugc2V0dGluZ3MgZm9yIGRldmljZSAqLwot
ICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCAgKQorICAgIGVs
c2UKICAgICB7Ci0gICAgICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNp
b25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlIC8qIGFsbCAqLywg
aXcsIGlyKTsKICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmR0ZV9hbGxv
d19leGNsdXNpb24gPSBJT01NVV9DT05UUk9MX0VOQUJMRUQ7CiAgICAgICAg
IGl2cnNfbWFwcGluZ3NbcmVxXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gSU9N
TVVfQ09OVFJPTF9FTkFCTEVEOwogICAgIH0KQEAgLTI1OCw1MyArMjQ3LDQy
IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4K
ICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IHJlZ2lz
dGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfaW9tbXVfZGV2aWNlcygKLSAgICBz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICB1bnNpZ25lZCBsb25nIGJh
c2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3LCB1OCBpcikKK3N0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX3JhbmdlX2Zvcl9pb21tdV9kZXZpY2Vz
KAorICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCBwYWRkcl90IGJhc2Us
IHBhZGRyX3QgbGltaXQsCisgICAgYm9vbCBpdywgYm9vbCBpciwgYm9vbCBl
eGNsdXNpb24pCiB7Ci0gICAgdW5zaWduZWQgbG9uZyByYW5nZV90b3AsIGlv
bW11X3RvcCwgbGVuZ3RoOworICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1l
dGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICovCisgICAgcGFk
ZHJfdCBsZW5ndGggPSBsaW1pdCArIFBBR0VfU0laRSAtIGJhc2U7CiAgICAg
dW5zaWduZWQgaW50IGJkZjsKICAgICB1MTYgcmVxOwotICAgIGludCByYyA9
IDA7CisgICAgaW50IHJjOwogCi0gICAgLyogaXMgcGFydCBvZiBleGNsdXNp
b24gcmFuZ2UgaW5zaWRlIG9mIElPTU1VIHZpcnR1YWwgYWRkcmVzcyBzcGFj
ZT8gKi8KLSAgICAvKiBub3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1
bWVkIHRvIGJlIHBhZ2UtYWxpZ25lZCAqLwotICAgIHJhbmdlX3RvcCA9IGxp
bWl0ICsgUEFHRV9TSVpFOwotICAgIGlvbW11X3RvcCA9IG1heF9wYWdlICog
UEFHRV9TSVpFOwotICAgIGlmICggYmFzZSA8IGlvbW11X3RvcCApCi0gICAg
ewotICAgICAgICBpZiAoIHJhbmdlX3RvcCA+IGlvbW11X3RvcCApCi0gICAg
ICAgICAgICByYW5nZV90b3AgPSBpb21tdV90b3A7Ci0gICAgICAgIGxlbmd0
aCA9IHJhbmdlX3RvcCAtIGJhc2U7Ci0gICAgICAgIC8qIHJlc2VydmUgci93
IHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZXMgKi8KLSAg
ICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUg
ZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIGZvciAoIGJkZiA9IDA7ICFy
YyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCi0gICAgICAg
IHsKLSAgICAgICAgICAgIGlmICggaW9tbXUgPT0gZmluZF9pb21tdV9mb3Jf
ZGV2aWNlKGlvbW11LT5zZWcsIGJkZikgKQotICAgICAgICAgICAgewotICAg
ICAgICAgICAgICAgIHJlcSA9IGdldF9pdnJzX21hcHBpbmdzKGlvbW11LT5z
ZWcpW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZDsKLSAgICAgICAgICAgICAgICBy
YyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywg
YmRmLCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcikgPzoKLSAgICAgICAg
ICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9t
bXUtPnNlZywgcmVxLCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcik7Ci0g
ICAgICAgICAgICB9Ci0gICAgICAgIH0KLQotICAgICAgICAvKiBwdXNoICdi
YXNlJyBqdXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICov
Ci0gICAgICAgIGJhc2UgPSBpb21tdV90b3A7CisgICAgaWYgKCBleGNsdXNp
b24gKQorICAgIHsKKyAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsIHRydWUgLyogYWxsICov
KTsKKyAgICAgICAgaWYgKCAhcmMgKQorICAgICAgICAgICAgcmV0dXJuIDA7
CiAgICAgfQogCi0gICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJh
bmdlIHNldHRpbmdzICovCi0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9t
bXVfdG9wICkKLSAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lv
bl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8sIGl3
LCBpcik7CisgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRy
aWVzIGZvciBkZXZpY2VzICovCisgICAgZm9yICggYmRmID0gcmMgPSAwOyAh
cmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysgKQorICAgIHsK
KyAgICAgICAgaWYgKCBpb21tdSAhPSBmaW5kX2lvbW11X2Zvcl9kZXZpY2Uo
aW9tbXUtPnNlZywgYmRmKSApCisgICAgICAgICAgICBjb250aW51ZTsKKwor
ICAgICAgICByZXEgPSBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVti
ZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7CisgICAgICAgIHJjID0gcmVzZXJ2ZV91
bml0eV9tYXBfZm9yX2RldmljZShpb21tdS0+c2VnLCBiZGYsIGJhc2UsIGxl
bmd0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGl3LCBpcikgPzoKKyAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21h
cF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcs
IGlyKTsKKyAgICB9CiAKICAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBp
bnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdCgKICAgICBjb25z
dCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9jaywKLSAgICB1
bnNpZ25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3
LCB1OCBpcikKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGltaXQsIGJv
b2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewogICAgIHUxNiBi
ZGY7CiAKQEAgLTMxNSwxMiArMjkzLDEyIEBAIHN0YXRpYyBpbnQgX19pbml0
IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGUKICAgICAgICAgcmV0dXJuIC1FTk9E
RVY7CiAgICAgfQogCi0gICAgcmV0dXJuIHJlZ2lzdGVyX2V4Y2x1c2lvbl9y
YW5nZV9mb3JfZGV2aWNlKGJkZiwgYmFzZSwgbGltaXQsIGl3LCBpcik7Cisg
ICAgcmV0dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2UoYmRmLCBiYXNl
LCBsaW1pdCwgaXcsIGlyLCBleGNsdXNpb24pOwogfQogCiBzdGF0aWMgaW50
IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9yYW5nZSgKICAgICBjb25zdCBz
dHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9jaywKLSAgICB1bnNp
Z25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3LCB1
OCBpcikKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGltaXQsIGJvb2wg
aXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewogICAgIHVuc2lnbmVk
IGludCBmaXJzdF9iZGYsIGxhc3RfYmRmLCBiZGY7CiAgICAgaW50IGVycm9y
OwpAQCAtMzQyLDE1ICszMjAsMTUgQEAgc3RhdGljIGludCBfX2luaXQgcGFy
c2VfaXZtZF9kZXZpY2VfcmFuZwogICAgIH0KIAogICAgIGZvciAoIGJkZiA9
IGZpcnN0X2JkZiwgZXJyb3IgPSAwOyAoYmRmIDw9IGxhc3RfYmRmKSAmJiAh
ZXJyb3I7IGJkZisrICkKLSAgICAgICAgZXJyb3IgPSByZWdpc3Rlcl9leGNs
dXNpb25fcmFuZ2VfZm9yX2RldmljZSgKLSAgICAgICAgICAgIGJkZiwgYmFz
ZSwgbGltaXQsIGl3LCBpcik7CisgICAgICAgIGVycm9yID0gcmVnaXN0ZXJf
cmFuZ2VfZm9yX2RldmljZSgKKyAgICAgICAgICAgIGJkZiwgYmFzZSwgbGlt
aXQsIGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIHJldHVybiBlcnJvcjsK
IH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZtZF9kZXZpY2VfaW9t
bXUoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19tZW1vcnkgKml2bWRf
YmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25n
IGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJfdCBiYXNlLCBwYWRk
cl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikK
IHsKICAgICBpbnQgc2VnID0gMDsgLyogWFhYICovCiAgICAgc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXU7CkBAIC0zNjUsMTQgKzM0MywxNCBAQCBzdGF0aWMg
aW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9pb21tCiAgICAgICAgIHJl
dHVybiAtRU5PREVWOwogICAgIH0KIAotICAgIHJldHVybiByZWdpc3Rlcl9l
eGNsdXNpb25fcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCi0gICAgICAgIGlv
bW11LCBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICByZXR1cm4gcmVnaXN0
ZXJfcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCisgICAgICAgIGlvbW11LCBi
YXNlLCBsaW1pdCwgaXcsIGlyLCBleGNsdXNpb24pOwogfQogCiBzdGF0aWMg
aW50IF9faW5pdCBwYXJzZV9pdm1kX2Jsb2NrKGNvbnN0IHN0cnVjdCBhY3Bp
X2l2cnNfbWVtb3J5ICppdm1kX2Jsb2NrKQogewogICAgIHVuc2lnbmVkIGxv
bmcgc3RhcnRfYWRkciwgbWVtX2xlbmd0aCwgYmFzZSwgbGltaXQ7Ci0gICAg
dTggaXcsIGlyOworICAgIGJvb2wgaXcgPSB0cnVlLCBpciA9IHRydWUsIGV4
Y2x1c2lvbiA9IGZhbHNlOwogCiAgICAgaWYgKCBpdm1kX2Jsb2NrLT5oZWFk
ZXIubGVuZ3RoIDwgc2l6ZW9mKCppdm1kX2Jsb2NrKSApCiAgICAgewpAQCAt
Mzg5LDEzICszNjcsMTEgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZt
ZF9ibG9jayhjb25zdAogICAgICAgICAgICAgICAgICAgICBpdm1kX2Jsb2Nr
LT5oZWFkZXIudHlwZSwgc3RhcnRfYWRkciwgbWVtX2xlbmd0aCk7CiAKICAg
ICBpZiAoIGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElfSVZNRF9F
WENMVVNJT05fUkFOR0UgKQotICAgICAgICBpdyA9IGlyID0gSU9NTVVfQ09O
VFJPTF9FTkFCTEVEOworICAgICAgICBleGNsdXNpb24gPSB0cnVlOwogICAg
IGVsc2UgaWYgKCBpdm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lW
TURfVU5JVFkgKQogICAgIHsKLSAgICAgICAgaXcgPSBpdm1kX2Jsb2NrLT5o
ZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfUkVBRCA/Ci0gICAgICAgICAgICBJ
T01NVV9DT05UUk9MX0VOQUJMRUQgOiBJT01NVV9DT05UUk9MX0RJU0FCTEVE
OwotICAgICAgICBpciA9IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFD
UElfSVZNRF9XUklURSA/Ci0gICAgICAgICAgICBJT01NVV9DT05UUk9MX0VO
QUJMRUQgOiBJT01NVV9DT05UUk9MX0RJU0FCTEVEOworICAgICAgICBpdyA9
IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElfSVZNRF9SRUFEOwor
ICAgICAgICBpciA9IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElf
SVZNRF9XUklURTsKICAgICB9CiAgICAgZWxzZQogICAgIHsKQEAgLTQwNiwy
MCArMzgyLDIwIEBAIHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfYmxv
Y2soY29uc3QKICAgICBzd2l0Y2goIGl2bWRfYmxvY2stPmhlYWRlci50eXBl
ICkKICAgICB7CiAgICAgY2FzZSBBQ1BJX0lWUlNfVFlQRV9NRU1PUllfQUxM
OgotICAgICAgICByZXR1cm4gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zv
cl9hbGxfZGV2aWNlcygKLSAgICAgICAgICAgIGJhc2UsIGxpbWl0LCBpdywg
aXIpOworICAgICAgICByZXR1cm4gcmVnaXN0ZXJfcmFuZ2VfZm9yX2FsbF9k
ZXZpY2VzKAorICAgICAgICAgICAgYmFzZSwgbGltaXQsIGl3LCBpciwgZXhj
bHVzaW9uKTsKIAogICAgIGNhc2UgQUNQSV9JVlJTX1RZUEVfTUVNT1JZX09O
RToKLSAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdChp
dm1kX2Jsb2NrLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAgICAgICByZXR1cm4g
cGFyc2VfaXZtZF9kZXZpY2Vfc2VsZWN0KGl2bWRfYmxvY2ssIGJhc2UsIGxp
bWl0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIGNhc2UgQUNQSV9JVlJTX1RZ
UEVfTUVNT1JZX1JBTkdFOgotICAgICAgICByZXR1cm4gcGFyc2VfaXZtZF9k
ZXZpY2VfcmFuZ2UoaXZtZF9ibG9jaywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAg
ICAgICByZXR1cm4gcGFyc2VfaXZtZF9kZXZpY2VfcmFuZ2UoaXZtZF9ibG9j
aywgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBjYXNlIEFD
UElfSVZSU19UWVBFX01FTU9SWV9JT01NVToKLSAgICAgICAgcmV0dXJuIHBh
cnNlX2l2bWRfZGV2aWNlX2lvbW11KGl2bWRfYmxvY2ssCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLCBsaW1pdCwgaXcs
IGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX2lvbW11
KGl2bWRfYmxvY2ssIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaXcsIGlyLCBleGNsdXNpb24pOwogCiAg
ICAgZGVmYXVsdDoKICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJJVk1EIEVy
cm9yOiBJbnZhbGlkIEJsb2NrIFR5cGUhXG4iKTsKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0y
MjIsNiArMjIyLDggQEAgc3RhdGljIGludCBfX211c3RfY2hlY2sgYWxsb2Nh
dGVfZG9tYWluXwogICAgIHJldHVybiByYzsKIH0KIAoraW50IF9fcmVhZF9t
b3N0bHkgYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZSA9IDE7CisKIHN0YXRp
YyBpbnQgYW1kX2lvbW11X2RvbWFpbl9pbml0KHN0cnVjdCBkb21haW4gKmQp
CiB7CiAgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUo
ZCk7CkBAIC0yMzMsMTEgKzIzNSwxMyBAQCBzdGF0aWMgaW50IGFtZF9pb21t
dV9kb21haW5faW5pdChzdHJ1Y3QKICAgICAgKiAtIEhWTSBjb3VsZCBpbiBw
cmluY2lwbGUgdXNlIDMgb3IgNCBkZXBlbmRpbmcgb24gaG93IG11Y2ggZ3Vl
c3QKICAgICAgKiAgIHBoeXNpY2FsIGFkZHJlc3Mgc3BhY2Ugd2UgZ2l2ZSBp
dCwgYnV0IHRoaXMgaXNuJ3Qga25vd24geWV0IHNvIHVzZSA0CiAgICAgICog
ICB1bmlsYXRlcmFsbHkuCisgICAgICogLSBVbml0eSBtYXBzIG1heSByZXF1
aXJlIGFuIGV2ZW4gaGlnaGVyIG51bWJlci4KICAgICAgKi8KLSAgICBoZC0+
YXJjaC5wYWdpbmdfbW9kZSA9IGFtZF9pb21tdV9nZXRfcGFnaW5nX21vZGUo
Ci0gICAgICAgIGlzX2h2bV9kb21haW4oZCkKLSAgICAgICAgPyAxdWwgPDwg
KERFRkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEggLSBQQUdFX1NISUZUKQot
ICAgICAgICA6IGdldF91cHBlcl9tZm5fYm91bmQoKSArIDEpOworICAgIGhk
LT5hcmNoLnBhZ2luZ19tb2RlID0gbWF4KGFtZF9pb21tdV9nZXRfcGFnaW5n
X21vZGUoCisgICAgICAgICAgICBpc19odm1fZG9tYWluKGQpCisgICAgICAg
ICAgICA/IDF1bCA8PCAoREVGQVVMVF9ET01BSU5fQUREUkVTU19XSURUSCAt
IFBBR0VfU0hJRlQpCisgICAgICAgICAgICA6IGdldF91cHBlcl9tZm5fYm91
bmQoKSArIDEpLAorICAgICAgICBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2Rl
KTsKIAogICAgIHJldHVybiAwOwogfQotLS0gYS94ZW4vaW5jbHVkZS9hc20t
eDg2L2h2bS9zdm0vYW1kLWlvbW11LXByb3RvLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21tdS1wcm90by5oCkBAIC0xMzIs
NiArMTMyLDggQEAgZXh0ZXJuIHN0cnVjdCBocGV0X3NiZGYgewogICAgIH0g
aW5pdDsKIH0gaHBldF9zYmRmOwogCitleHRlcm4gaW50IGFtZF9pb21tdV9t
aW5fcGFnaW5nX21vZGU7CisKIGV4dGVybiB2b2lkICpzaGFyZWRfaW50cmVt
YXBfdGFibGU7CiBleHRlcm4gdW5zaWduZWQgbG9uZyAqc2hhcmVkX2ludHJl
bWFwX2ludXNlOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-7.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-7.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBpbnRyb2R1Y2UgcDJtX2lzX3NwZWNpYWwoKQoKU2VlaW5n
IHRoZSBzaW1pbGFyaXR5IG9mIGdyYW50LCBmb3JlaWduLCBhbmQgKHN1YnNl
cXVlbnRseSkgZGlyZWN0LU1NSU8KaGFuZGxpbmcsIGludHJvZHVjZSBhIG5l
dyBQMk0gdHlwZSBncm91cCBuYW1lZCAic3BlY2lhbCIgKGFzIGluICJuZWVk
aW5nCnNwZWNpYWwgYWNjZXNzb3JzIHRvIGNyZWF0ZS9kZXN0cm95IikuCgpB
bHNvIHVzZSAtRVBFUk0gaW5zdGVhZCBvZiBvdGhlciBlcnJvciBjb2RlcyBv
biB0aGUgdHdvIGRvbWFpbl9jcmFzaCgpCnBhdGhzIHRvdWNoZWQuCgpUaGlz
IGlzIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtODA2LDcgKzgw
Niw3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJt
LAogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRl
cik7IGkrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOwotICAgICAgICAgICAgaWYgKCAhcDJtX2lzX2dyYW50KHQpICYmICFw
Mm1faXNfc2hhcmVkKHQpICYmICFwMm1faXNfZm9yZWlnbih0KSApCisgICAg
ICAgICAgICBpZiAoICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3No
YXJlZCh0KSApCiAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4o
bWZuK2ksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAgfQogICAgIH0K
QEAgLTkxNywxMyArOTE3LDEzIEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5
KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKICAgICAgICAgICAg
IEFTU0VSVCghcDJtX2lzX3NoYXJlZChvdCkpOwogICAgICAgICB9Ci0gICAg
ICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1faXNfZm9yZWlnbihv
dCkgKQorICAgICAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90KSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIC8qIFJlYWxseSBzaG91bGRuJ3QgYmUgdW5t
YXBwaW5nIGdyYW50L2ZvcmVpZ24gbWFwcyB0aGlzIHdheSAqLworICAgICAg
ICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9mb3JlaWdu
IHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwog
ICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAgICAgICAgCi0g
ICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAgICAgIHJldHVy
biAtRVBFUk07CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHAybV9p
c19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKICAgICAgICAgewpA
QCAtMTAxOCw4ICsxMDE4LDcgQEAgaW50IHAybV9jaGFuZ2VfdHlwZV9vbmUo
c3RydWN0IGRvbWFpbiAqZAogICAgIHN0cnVjdCBwMm1fZG9tYWluICpwMm0g
PSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAgICAgaW50IHJjOwogCi0gICAgQlVH
X09OKHAybV9pc19ncmFudChvdCkgfHwgcDJtX2lzX2dyYW50KG50KSk7Ci0g
ICAgQlVHX09OKHAybV9pc19mb3JlaWduKG90KSB8fCBwMm1faXNfZm9yZWln
bihudCkpOworICAgIEJVR19PTihwMm1faXNfc3BlY2lhbChvdCkgfHwgcDJt
X2lzX3NwZWNpYWwobnQpKTsKIAogICAgIGdmbl9sb2NrKHAybSwgZ2ZuLCAw
KTsKIApAQCAtMTI3MiwxMSArMTI3MSwxMSBAQCBzdGF0aWMgaW50IHNldF90
eXBlZF9wMm1fZW50cnkoc3RydWN0IGRvCiAgICAgICAgIGdmbl91bmxvY2so
cDJtLCBnZm4sIG9yZGVyKTsKICAgICAgICAgcmV0dXJuIGN1cl9vcmRlciAr
IDE7CiAgICAgfQotICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1f
aXNfZm9yZWlnbihvdCkgKQorICAgIGlmICggcDJtX2lzX3NwZWNpYWwob3Qp
ICkKICAgICB7CiAgICAgICAgIGdmbl91bmxvY2socDJtLCBnZm4sIG9yZGVy
KTsKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAgICByZXR1cm4g
LUVOT0VOVDsKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAgICB9CiAgICAg
ZWxzZSBpZiAoIHAybV9pc19yYW0ob3QpICkKICAgICB7Ci0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9wMm0uaApAQCAtMTQxLDYgKzE0MSwxMCBAQCB0eXBlZGVmIHVuc2lnbmVk
IGludCBwMm1fcXVlcnlfdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8IHAybV90b19tYXNrKHAybV9yYW1fbG9nZGlydHkpICkKICNkZWZpbmUg
UDJNX1NIQVJFRF9UWVBFUyAgIChwMm1fdG9fbWFzayhwMm1fcmFtX3NoYXJl
ZCkpCiAKKy8qIFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQgdXAgdmlhIHNw
ZWNpYWwgYWNjZXNzb3JzLiAqLworI2RlZmluZSBQMk1fU1BFQ0lBTF9UWVBF
UyAoUDJNX0dSQU5UX1RZUEVTIHwgXAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSkKKwogLyogVmFs
aWQgdHlwZXMgbm90IG5lY2Vzc2FyaWx5IGFzc29jaWF0ZWQgd2l0aCBhICh2
YWxpZCkgTUZOLiAqLwogI2RlZmluZSBQMk1fSU5WQUxJRF9NRk5fVFlQRVMg
KFAyTV9QT0RfVFlQRVMgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfCBwMm1fdG9fbWFzayhwMm1fbW1pb19k
aXJlY3QpIFwKQEAgLTE2OSw2ICsxNzMsNyBAQCB0eXBlZGVmIHVuc2lnbmVk
IGludCBwMm1fcXVlcnlfdDsKICNkZWZpbmUgcDJtX2lzX3BhZ2VkKF90KSAg
ICAocDJtX3RvX21hc2soX3QpICYgUDJNX1BBR0VEX1RZUEVTKQogI2RlZmlu
ZSBwMm1faXNfc2hhcmFibGUoX3QpIChwMm1fdG9fbWFzayhfdCkgJiBQMk1f
U0hBUkFCTEVfVFlQRVMpCiAjZGVmaW5lIHAybV9pc19zaGFyZWQoX3QpICAg
KHAybV90b19tYXNrKF90KSAmIFAyTV9TSEFSRURfVFlQRVMpCisjZGVmaW5l
IHAybV9pc19zcGVjaWFsKF90KSAgKHAybV90b19tYXNrKF90KSAmIFAyTV9T
UEVDSUFMX1RZUEVTKQogI2RlZmluZSBwMm1faXNfYnJva2VuKF90KSAgIChw
Mm1fdG9fbWFzayhfdCkgJiBQMk1fQlJPS0VOX1RZUEVTKQogI2RlZmluZSBw
Mm1faXNfZm9yZWlnbihfdCkgIChwMm1fdG9fbWFzayhfdCkgJiBwMm1fdG9f
bWFzayhwMm1fbWFwX2ZvcmVpZ24pKQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.12-8.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.12-8.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBndWFyZCAoaW4gcGFydGljdWxhcikgaWRlbnRpdHkgbWFw
cGluZyBlbnRyaWVzCgpTdWNoIGVudHJpZXMsIGNyZWF0ZWQgYnkgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpLCBzaG91bGQgb25seSBiZQpkZXN0cm95ZWQg
YnkgY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KCkuIEhvd2V2ZXIsIHNpbWls
YXJseSwgZW50cmllcwpjcmVhdGVkIGJ5IHNldF9tbWlvX3AybV9lbnRyeSgp
IHNob3VsZCBvbmx5IGJlIHRvcm4gZG93biBieQpjbGVhcl9tbWlvX3AybV9l
bnRyeSgpLCBzbyB0aGUgbG9naWMgZ2V0cyBiYXNlZCB1cG9uIHAybV9tbWlv
X2RpcmVjdCBhcwp0aGUgZW50cnkgdHlwZSAoc2VwYXJhdGlvbiBiZXR3ZWVu
ICJvcmRpbmFyeSIgYW5kIDE6MSBtYXBwaW5ncyB3b3VsZApyZXF1aXJlIGEg
ZnVydGhlciBpbmRpY2F0b3IgdG8gdGVsbCBhcGFydCB0aGUgdHdvKS4KCkFz
IHRvIHRoZSBndWVzdF9yZW1vdmVfcGFnZSgpIGNoYW5nZSwgY29tbWl0IDQ4
ZGZiMjk3YTIwYSAoIng4Ni9QVkg6CmFsbG93IGd1ZXN0X3JlbW92ZV9wYWdl
IHRvIHJlbW92ZSBwMm1fbW1pb19kaXJlY3QgcGFnZXMiKSwgd2hpY2gKaW50
cm9kdWNlZCB0aGUgY2FsbCB0byBjbGVhcl9tbWlvX3AybV9lbnRyeSgpLCBj
bGFpbWVkIHRoaXMgd2FzIGRvbmUgZm9yCmh3ZG9tIG9ubHkgd2l0aG91dCB0
aGlzIGFjdHVhbGx5IGhhdmluZyBiZWVuIHRoZSBjYXNlLiBIb3dldmVyLCB0
aGlzCmNvZGUgc2hvdWxkbid0IGJlIHRoZXJlIGluIHRoZSBmaXJzdCBwbGFj
ZSwgYXMgTU1JTyBlbnRyaWVzIHNob3VsZG4ndCBiZQpkcm9wcGVkIHRoaXMg
d2F5LiBBdm9pZCB0cmlnZ2VyaW5nIHRoZSB3YXJuaW5nIGFnYWluIHRoYXQg
NDhkZmIyOTdhMjBhCnNpbGVuY2VkIGJ5IGFuIGFkanVzdG1lbnQgdG8geGVu
bWVtX2FkZF90b19waHlzbWFwX29uZSgpIGluc3RlYWQuCgpOb3RlIHRoYXQg
Z3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZCgpIGdldHMg
dGlnaHRlbmVkIGJleW9uZAp0aGUgaW1tZWRpYXRlIHB1cnBvc2Ugb2YgdGhp
cyBjaGFuZ2UuCgpOb3RlIGFsc28gdGhhdCBJIGRpZG4ndCBpbnNwZWN0IGNv
ZGUgd2hpY2ggaXNuJ3Qgc2VjdXJpdHkgc3VwcG9ydGVkLAplLmcuIHNoYXJp
bmcsIHBhZ2luZywgb3IgYWx0cDJtLgoKVGhpcyBpcyBDVkUtMjAyMS0yODY5
NCAvIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tLmMK
KysrIGIveGVuL2FyY2gveDg2L21tLmMKQEAgLTQ4MDksNyArNDgwOSw5IEBA
IGludCB4ZW5tZW1fYWRkX3RvX3BoeXNtYXBfb25lKAogCiAgICAgLyogUmVt
b3ZlIHByZXZpb3VzbHkgbWFwcGVkIHBhZ2UgaWYgaXQgd2FzIHByZXNlbnQu
ICovCiAgICAgcHJldl9tZm4gPSBtZm5feChnZXRfZ2ZuKGQsIGdmbl94KGdw
Zm4pLCAmcDJtdCkpOwotICAgIGlmICggbWZuX3ZhbGlkKF9tZm4ocHJldl9t
Zm4pKSApCisgICAgaWYgKCBwMm10ID09IHAybV9tbWlvX2RpcmVjdCApCisg
ICAgICAgIHJjID0gLUVQRVJNOworICAgIGVsc2UgaWYgKCBtZm5fdmFsaWQo
X21mbihwcmV2X21mbikpICkKICAgICB7CiAgICAgICAgIGlmICggaXNfeGVu
X2hlYXBfbWZuKHByZXZfbWZuKSApCiAgICAgICAgICAgICAvKiBYZW4gaGVh
cCBmcmFtZXMgYXJlIHNpbXBseSB1bmhvb2tlZCBmcm9tIHRoaXMgcGh5cyBz
bG90LiAqLwotLS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVu
L2FyY2gveDg2L21tL3AybS5jCkBAIC03OTUsNyArNzk1LDggQEAgcDJtX3Jl
bW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY3VyX29yZGVyLCBO
VUxMKTsKIAogICAgICAgICBpZiAoIHAybV9pc192YWxpZCh0KSAmJgotICAg
ICAgICAgICAgICghbWZuX3ZhbGlkKF9tZm4obWZuKSkgfHwgbWZuICsgaSAh
PSBtZm5feChtZm5fcmV0dXJuKSkgKQorICAgICAgICAgICAgICghbWZuX3Zh
bGlkKF9tZm4obWZuKSkgfHwgdCA9PSBwMm1fbW1pb19kaXJlY3QgfHwKKyAg
ICAgICAgICAgICAgbWZuICsgaSAhPSBtZm5feChtZm5fcmV0dXJuKSkgKQog
ICAgICAgICAgICAgcmV0dXJuIC1FSUxTRVE7CiAKICAgICAgICAgaSArPSAo
MVVMIDw8IGN1cl9vcmRlcikgLSAoKGdmbl9sICsgaSkgJiAoKDFVTCA8PCBj
dXJfb3JkZXIpIC0gMSkpOwpAQCAtODczLDcgKzg3NCw3IEBAIGd1ZXN0X3Bo
eXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICBpZiAoIHAy
bV9pc19mb3JlaWduKHQpICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAK
LSAgICBpZiAoICFtZm5fdmFsaWQobWZuKSApCisgICAgaWYgKCAhbWZuX3Zh
bGlkKG1mbikgfHwgdCA9PSBwMm1fbW1pb19kaXJlY3QgKQogICAgIHsKICAg
ICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgIHJldHVybiAt
RUlOVkFMOwpAQCAtOTE5LDcgKzkyMCw3IEBAIGd1ZXN0X3BoeXNtYXBfYWRk
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgfQogICAgICAgICBp
ZiAoIHAybV9pc19zcGVjaWFsKG90KSApCiAgICAgICAgIHsKLSAgICAgICAg
ICAgIC8qIERvbid0IHBlcm1pdCB1bm1hcHBpbmcgZ3JhbnQvZm9yZWlnbiB0
aGlzIHdheS4gKi8KKyAgICAgICAgICAgIC8qIERvbid0IHBlcm1pdCB1bm1h
cHBpbmcgZ3JhbnQvZm9yZWlnbi9kaXJlY3QtTU1JTyB0aGlzIHdheS4gKi8K
ICAgICAgICAgICAgIGRvbWFpbl9jcmFzaChkKTsKICAgICAgICAgICAgIHAy
bV91bmxvY2socDJtKTsKICAgICAgICAgICAgIApAQCAtMTM3NSw4ICsxMzc2
LDggQEAgaW50IHNldF9pZGVudGl0eV9wMm1fZW50cnkoc3RydWN0IGRvbWFp
bgogICogICAgb3JkZXIrMSAgZm9yIGNhbGxlciB0byByZXRyeSB3aXRoIG9y
ZGVyIChndWFyYW50ZWVkIHNtYWxsZXIgdGhhbgogICogICAgICAgICAgICAg
dGhlIG9yZGVyIHZhbHVlIHBhc3NlZCBpbikKICAqLwotaW50IGNsZWFyX21t
aW9fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcg
Z2ZuX2wsIG1mbl90IG1mbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgb3JkZXIpCitzdGF0aWMgaW50IGNsZWFyX21taW9fcDJt
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuX2ws
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90IG1mbiwg
dW5zaWduZWQgaW50IG9yZGVyKQogewogICAgIGludCByYyA9IC1FSU5WQUw7
CiAgICAgZ2ZuX3QgZ2ZuID0gX2dmbihnZm5fbCk7Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS9wMm0tcG9kLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1w
b2QuYwpAQCAtMTI5NywxNyArMTI5NywxNyBAQCBndWVzdF9waHlzbWFwX21h
cmtfcG9wdWxhdGVfb25fZGVtYW5kKHN0CiAKICAgICAgICAgcDJtLT5nZXRf
ZW50cnkocDJtLCBnZm5fYWRkKGdmbiwgaSksICZvdCwgJmEsIDAsICZjdXJf
b3JkZXIsIE5VTEwpOwogICAgICAgICBuID0gMVVMIDw8IG1pbihvcmRlciwg
Y3VyX29yZGVyKTsKLSAgICAgICAgaWYgKCBwMm1faXNfcmFtKG90KSApCisg
ICAgICAgIGlmICggb3QgPT0gcDJtX3BvcHVsYXRlX29uX2RlbWFuZCApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qIENvdW50IGhvdyBtYW55IFBvRCBl
bnRyaWVzIHdlJ2xsIGJlIHJlcGxhY2luZyBpZiBzdWNjZXNzZnVsICovCisg
ICAgICAgICAgICBwb2RfY291bnQgKz0gbjsKKyAgICAgICAgfQorICAgICAg
ICBlbHNlIGlmICggb3QgIT0gcDJtX2ludmFsaWQgJiYgb3QgIT0gcDJtX21t
aW9fZG0gKQogICAgICAgICB7CiAgICAgICAgICAgICBQMk1fREVCVUcoImdm
bl90b19tZm4gcmV0dXJuZWQgdHlwZSAlZCFcbiIsIG90KTsKICAgICAgICAg
ICAgIHJjID0gLUVCVVNZOwogICAgICAgICAgICAgZ290byBvdXQ7CiAgICAg
ICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIG90ID09IHAybV9wb3B1bGF0ZV9v
bl9kZW1hbmQgKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBDb3VudCBo
b3cgbWFuIFBvRCBlbnRyaWVzIHdlJ2xsIGJlIHJlcGxhY2luZyBpZiBzdWNj
ZXNzZnVsICovCi0gICAgICAgICAgICBwb2RfY291bnQgKz0gbjsKLSAgICAg
ICAgfQogICAgIH0KIAogICAgIC8qIE5vdywgYWN0dWFsbHkgZG8gdGhlIHR3
by13YXkgbWFwcGluZyAqLwotLS0gYS94ZW4vY29tbW9uL21lbW9yeS5jCisr
KyBiL3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTMzNiw3ICszMzYsNyBAQCBp
bnQgZ3Vlc3RfcmVtb3ZlX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwKICAgICB9
CiAgICAgaWYgKCBwMm10ID09IHAybV9tbWlvX2RpcmVjdCApCiAgICAgewot
ICAgICAgICByYyA9IGNsZWFyX21taW9fcDJtX2VudHJ5KGQsIGdtZm4sIG1m
biwgUEFHRV9PUkRFUl80Syk7CisgICAgICAgIHJjID0gLUVQRVJNOwogICAg
ICAgICBnb3RvIG91dF9wdXRfZ2ZuOwogICAgIH0KICNlbHNlCkBAIC0xNzI0
LDYgKzE3MjQsMTUgQEAgaW50IGNoZWNrX2dldF9wYWdlX2Zyb21fZ2ZuKHN0
cnVjdCBkb21haQogICAgICAgICByZXR1cm4gLUVBR0FJTjsKICAgICB9CiAj
ZW5kaWYKKyNpZmRlZiBDT05GSUdfWDg2CisgICAgaWYgKCBwMm10ID09IHAy
bV9tbWlvX2RpcmVjdCApCisgICAgeworICAgICAgICBpZiAoIHBhZ2UgKQor
ICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CisKKyAgICAgICAgcmV0dXJu
IC1FUEVSTTsKKyAgICB9CisjZW5kaWYKIAogICAgIGlmICggIXBhZ2UgKQog
ICAgICAgICByZXR1cm4gLUVJTlZBTDsKLS0tIGEveGVuL2luY2x1ZGUvYXNt
LXg4Ni9wMm0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5oCkBA
IC0xNDMsNyArMTQzLDggQEAgdHlwZWRlZiB1bnNpZ25lZCBpbnQgcDJtX3F1
ZXJ5X3Q7CiAKIC8qIFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQgdXAgdmlh
IHNwZWNpYWwgYWNjZXNzb3JzLiAqLwogI2RlZmluZSBQMk1fU1BFQ0lBTF9U
WVBFUyAoUDJNX0dSQU5UX1RZUEVTIHwgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSkKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHAybV90b19tYXNrKHAybV9tYXBfZm9y
ZWlnbikgfCBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1fdG9f
bWFzayhwMm1fbW1pb19kaXJlY3QpKQogCiAvKiBWYWxpZCB0eXBlcyBub3Qg
bmVjZXNzYXJpbHkgYXNzb2NpYXRlZCB3aXRoIGEgKHZhbGlkKSBNRk4uICov
CiAjZGVmaW5lIFAyTV9JTlZBTElEX01GTl9UWVBFUyAoUDJNX1BPRF9UWVBF
UyAgICAgICAgICAgICAgICAgIFwKQEAgLTY0MCw4ICs2NDEsNiBAQCBpbnQg
c2V0X2ZvcmVpZ25fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4KIC8qIFNldCBt
bWlvIGFkZHJlc3NlcyBpbiB0aGUgcDJtIHRhYmxlIChmb3IgcGFzcy10aHJv
dWdoKSAqLwogaW50IHNldF9tbWlvX3AybV9lbnRyeShzdHJ1Y3QgZG9tYWlu
ICpkLCB1bnNpZ25lZCBsb25nIGdmbiwgbWZuX3QgbWZuLAogICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXIsIHAybV9hY2Nlc3Nf
dCBhY2Nlc3MpOwotaW50IGNsZWFyX21taW9fcDJtX2VudHJ5KHN0cnVjdCBk
b21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLCBtZm5fdCBtZm4sCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKTsKIAog
LyogU2V0IGlkZW50aXR5IGFkZHJlc3NlcyBpbiB0aGUgcDJtIHRhYmxlIChm
b3IgcGFzcy10aHJvdWdoKSAqLwogaW50IHNldF9pZGVudGl0eV9wMm1fZW50
cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm4sCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-0a.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-0a.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBmaXggUG9EIGFjY291bnRpbmcgaW4gZ3Vlc3RfcGh5c21h
cF9hZGRfZW50cnkoKQoKVGhlIGluaXRpYWwgb2JzZXJ2YXRpb24gd2FzIHRo
YXQgdGhlIG1mbl92YWxpZCgpIGNoZWNrIGNvbWVzIHRvbyBsYXRlOgpOZWl0
aGVyIG1mbl9hZGQoKSBub3IgbWZuX3RvX3BhZ2UoKSAobGV0IGFsb25lIGRl
LXJlZmVyZW5jaW5nIHRoZQpyZXN1bHQgb2YgdGhlIGxhdHRlcikgYXJlIHZh
bGlkIGZvciBNRk5zIGZhaWxpbmcgdGhpcyBjaGVjay4gTW92ZSBpdCB1cAph
bmQgLSBub3RpY2luZyB0aGF0IHRoZXJlJ3Mgbm8gY2FsbGVyIGRvaW5nIHNv
IC0gYWxzbyBhZGQgYW4gYXNzZXJ0aW9uCnRoYXQgdGhpcyBzaG91bGQgbmV2
ZXIgcHJvZHVjZSAiZmFsc2UiIGhlcmUuCgpJbiB0dXJuIHRoaXMgd291bGQg
aGF2ZSBtZWFudCB0aGF0IHRoZSAiZWxzZSIgdG8gdGhhdCBpZigpIGNvdWxk
IG5vdyBnbwphd2F5LCB3aGljaCBkaWRuJ3Qgc2VlbSByaWdodCBhdCBhbGwu
IEFuZCBpbmRlZWQsIGNvbnNpZGVyaW5nIGNhbGxlcnMKbGlrZSBtZW1vcnlf
ZXhjaGFuZ2UoKSBvciB2YXJpb3VzIGdyYW50IHRhYmxlIGZ1bmN0aW9ucywg
dGhlIFBvRAphY2NvdW50aW5nIHNob3VsZCBoYXZlIGJlZW4gb3V0c2lkZSBv
ZiB0aGF0IGlmKCkgZnJvbSB0aGUgdmVyeQpiZWdpbm5pbmcuCgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkFja2Vk
LWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29t
PgptYXN0ZXIgY29tbWl0OiBhZWEyNzBlM2Y3YzBkYjY5NmM4OGEwZTk0YjFl
Y2U3YWJkMzM5Yzg0Cm1hc3RlciBkYXRlOiAyMDIwLTAyLTIxIDE3OjE0OjM4
ICswMTAwCgotLS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVu
L2FyY2gveDg2L21tL3AybS5jCkBAIC04ODEsNiArODgxLDEyIEBAIGd1ZXN0
X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICBpZiAo
IHAybV9pc19mb3JlaWduKHQpICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
CiAKKyAgICBpZiAoICFtZm5fdmFsaWQobWZuKSApCisgICAgeworICAgICAg
ICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICAgICAgcmV0dXJuIC1FSU5W
QUw7CisgICAgfQorCiAgICAgcDJtX2xvY2socDJtKTsKIAogICAgIFAyTV9E
RUJVRygiYWRkaW5nIGdmbj0lI2x4IG1mbj0lI2x4XG4iLCBnZm5feChnZm4p
LCBtZm5feChtZm4pKTsKQEAgLTk4MSwxMiArOTg3LDEzIEBAIGd1ZXN0X3Bo
eXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICB9CiAKICAg
ICAvKiBOb3csIGFjdHVhbGx5IGRvIHRoZSB0d28td2F5IG1hcHBpbmcgKi8K
LSAgICBpZiAoIG1mbl92YWxpZChtZm4pICkKKyAgICByYyA9IHAybV9zZXRf
ZW50cnkocDJtLCBnZm4sIG1mbiwgcGFnZV9vcmRlciwgdCwgcDJtLT5kZWZh
dWx0X2FjY2Vzcyk7CisgICAgaWYgKCByYyA9PSAwICkKICAgICB7Ci0gICAg
ICAgIHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgbWZuLCBwYWdlX29y
ZGVyLCB0LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtLT5kZWZh
dWx0X2FjY2Vzcyk7Ci0gICAgICAgIGlmICggcmMgKQotICAgICAgICAgICAg
Z290byBvdXQ7IC8qIEZhaWxlZCB0byB1cGRhdGUgcDJtLCBiYWlsIHdpdGhv
dXQgdXBkYXRpbmcgbTJwLiAqLworICAgICAgICBwb2RfbG9jayhwMm0pOwor
ICAgICAgICBwMm0tPnBvZC5lbnRyeV9jb3VudCAtPSBwb2RfY291bnQ7Cisg
ICAgICAgIEJVR19PTihwMm0tPnBvZC5lbnRyeV9jb3VudCA8IDApOworICAg
ICAgICBwb2RfdW5sb2NrKHAybSk7CiAKICAgICAgICAgaWYgKCAhcDJtX2lz
X2dyYW50KHQpICkKICAgICAgICAgewpAQCAtOTk1LDIyICsxMDAyLDcgQEAg
Z3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAqZAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmbl94KGdmbl9hZGQo
Z2ZuLCBpKSkpOwogICAgICAgICB9CiAgICAgfQotICAgIGVsc2UKLSAgICB7
Ci0gICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiQWRkaW5nIGJh
ZCBtZm4gdG8gcDJtIG1hcCAoJSNseCAtPiAlI2x4KVxuIiwKLSAgICAgICAg
ICAgICAgICAgZ2ZuX3goZ2ZuKSwgbWZuX3gobWZuKSk7Ci0gICAgICAgIHJj
ID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4sIHBhZ2Vf
b3JkZXIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1faW52YWxp
ZCwgcDJtLT5kZWZhdWx0X2FjY2Vzcyk7Ci0gICAgICAgIGlmICggcmMgPT0g
MCApCi0gICAgICAgIHsKLSAgICAgICAgICAgIHBvZF9sb2NrKHAybSk7Ci0g
ICAgICAgICAgICBwMm0tPnBvZC5lbnRyeV9jb3VudCAtPSBwb2RfY291bnQ7
Ci0gICAgICAgICAgICBCVUdfT04ocDJtLT5wb2QuZW50cnlfY291bnQgPCAw
KTsKLSAgICAgICAgICAgIHBvZF91bmxvY2socDJtKTsKLSAgICAgICAgfQot
ICAgIH0KIAotb3V0OgogICAgIHAybV91bmxvY2socDJtKTsKIAogICAgIHJl
dHVybiByYzsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-0b.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-0b.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBkb24ndCBpZ25vcmUgcDJtX3JlbW92ZV9wYWdlKCkncyBy
ZXR1cm4gdmFsdWUKCkl0J3Mgbm90IHZlcnkgbmljZSB0byByZXR1cm4gZnJv
bSBndWVzdF9waHlzbWFwX2FkZF9lbnRyeSgpIGFmdGVyCnBlcmhhcHMgYWxy
ZWFkeSBoYXZpbmcgbWFkZSBzb21lIGNoYW5nZXMgdG8gdGhlIFAyTSwgYnV0
IHRoaXMgaXMgcHJlLQpleGlzdGluZyBwcmFjdGljZSBpbiB0aGUgZnVuY3Rp
b24sIGFuZCBpbW8gYmV0dGVyIHRoYW4gaWdub3JpbmcgZXJyb3JzLgoKVGFr
ZSB0aGUgbGliZXJ0eSBhbmQgcmVwbGFjZSBhbiBtZm5fYWRkKCkgaW5zdGFu
Y2Ugd2l0aCBhIGxvY2FsIHZhcmlhYmxlCmFscmVhZHkgaG9sZGluZyB0aGUg
cmVzdWx0IChhcyBwcm92ZW4gYnkgdGhlIGNoZWNrIGltbWVkaWF0ZWx5IGFo
ZWFkKS4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBz
dXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJy
YW50QGNpdHJpeC5jb20+CkFja2VkLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRy
ZXcuY29vcGVyM0BjaXRyaXguY29tPgptYXN0ZXIgY29tbWl0OiBhNmIwNTFh
ODdhNTg2MzQ3OTY5YmZiYWE2OTI1YWMwZjBjODQ1NDEzCm1hc3RlciBkYXRl
OiAyMDIwLTA0LTAzIDEwOjU2OjEwICswMjAwCgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC03
NzMsOCArNzczLDcgQEAgdm9pZCBwMm1fZmluYWxfdGVhcmRvd24oc3RydWN0
IGRvbWFpbiAqZAogICAgIHAybV90ZWFyZG93bl9ob3N0cDJtKGQpOwogfQog
Ci0KLXN0YXRpYyBpbnQKK3N0YXRpYyBpbnQgX19tdXN0X2NoZWNrCiBwMm1f
cmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9kb21haW4gKnAybSwgdW5zaWduZWQg
bG9uZyBnZm5fbCwgdW5zaWduZWQgbG9uZyBtZm4sCiAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IHBhZ2Vfb3JkZXIpCiB7CkBAIC05NzksOSArOTc4
LDkgQEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAq
ZAogICAgICAgICAgICAgICAgIEFTU0VSVChtZm5fdmFsaWQob21mbikpOwog
ICAgICAgICAgICAgICAgIFAyTV9ERUJVRygib2xkIGdmbj0lI2x4IC0+IG1m
biAlI2x4XG4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICBnZm5feChv
Z2ZuKSAsIG1mbl94KG9tZm4pKTsKLSAgICAgICAgICAgICAgICBpZiAoIG1m
bl9lcShvbWZuLCBtZm5fYWRkKG1mbiwgaSkpICkKLSAgICAgICAgICAgICAg
ICAgICAgcDJtX3JlbW92ZV9wYWdlKHAybSwgZ2ZuX3gob2dmbiksIG1mbl94
KG1mbl9hZGQobWZuLCBpKSksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAwKTsKKyAgICAgICAgICAgICAgICBpZiAoIG1mbl9lcShv
bWZuLCBtZm5fYWRkKG1mbiwgaSkpICYmCisgICAgICAgICAgICAgICAgICAg
ICAocmMgPSBwMm1fcmVtb3ZlX3BhZ2UocDJtLCBnZm5feChvZ2ZuKSwgbWZu
X3gob21mbiksIDApKSApCisgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0
OwogICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgfQpAQCAtMTAwMyw2
ICsxMDAyLDcgQEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRv
bWFpbiAqZAogICAgICAgICB9CiAgICAgfQogCisgb3V0OgogICAgIHAybV91
bmxvY2socDJtKTsKIAogICAgIHJldHVybiByYzsKQEAgLTI2OTAsOSArMjY5
MCw5IEBAIGludCBwMm1fY2hhbmdlX2FsdHAybV9nZm4oc3RydWN0IGRvbWFp
bgogICAgIGlmICggZ2ZuX2VxKG5ld19nZm4sIElOVkFMSURfR0ZOKSApCiAg
ICAgewogICAgICAgICBtZm4gPSBhcDJtLT5nZXRfZW50cnkoYXAybSwgb2xk
X2dmbiwgJnQsICZhLCAwLCBOVUxMLCBOVUxMKTsKLSAgICAgICAgaWYgKCBt
Zm5fdmFsaWQobWZuKSApCi0gICAgICAgICAgICBwMm1fcmVtb3ZlX3BhZ2Uo
YXAybSwgZ2ZuX3gob2xkX2dmbiksIG1mbl94KG1mbiksIFBBR0VfT1JERVJf
NEspOwotICAgICAgICByYyA9IDA7CisgICAgICAgIHJjID0gbWZuX3ZhbGlk
KG1mbikKKyAgICAgICAgICAgICA/IHAybV9yZW1vdmVfcGFnZShhcDJtLCBn
Zm5feChvbGRfZ2ZuKSwgbWZuX3gobWZuKSwgUEFHRV9PUkRFUl80SykKKyAg
ICAgICAgICAgICA6IDA7CiAgICAgICAgIGdvdG8gb3V0OwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-0c.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-0c.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBkb24ndCBhc3NlcnQgdGhhdCB0aGUgcGFzc2VkIGluIE1G
TiBtYXRjaGVzIGZvciBhIHJlbW92ZQoKZ3Vlc3RfcGh5c21hcF9yZW1vdmVf
cGFnZSgpIGdldHMgaGFuZGVkIGFuIE1GTiBmcm9tIHRoZSBvdXRzaWRlLCB5
ZXQKdGFrZXMgdGhlIG5lY2Vzc2FyeSBsb2NrIHRvIHByZXZlbnQgZnVydGhl
ciBjaGFuZ2VzIHRvIHRoZSBHRk4gPC0+IE1GTgptYXBwaW5nIGl0c2VsZi4g
V2hpbGUgc29tZSBjYWxsZXJzLCBpbiBwYXJ0aWN1bGFyIGd1ZXN0X3JlbW92
ZV9wYWdlKCkKKGJ5IHdheSBvZiBoYXZpbmcgY2FsbGVkIGdldF9nZm5fcXVl
cnkoKSksIGhvbGQgdGhlIEdGTiBsb2NrIGFscmVhZHksCnZhcmlvdXMgb3Ro
ZXJzIChtb3N0IG5vdGFibHkgcGVyaGFwcyB0aGUgMm5kIGluc3RhbmNlIGlu
Cnhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUoKSkgZG9uJ3QuIFdoaWxlIGl0
IGFsc28gaXMgYW4gb3B0aW9uIHRvIGZpeAphbGwgdGhlIGNhbGxlcnMsIGRl
YWwgd2l0aCB0aGUgaXNzdWUgaW4gcDJtX3JlbW92ZV9wYWdlKCkgaW5zdGVh
ZDoKUmVwbGFjZSB0aGUgQVNTRVJUKCkgYnkgYSBjb25kaXRpb25hbCBhbmQg
c3BsaXQgdGhlIGxvb3AgaW50byB0d28sIHN1Y2gKdGhhdCBhbGwgY2hlY2tp
bmcgZ2V0cyBkb25lIGJlZm9yZSBhbnkgbW9kaWZpY2F0aW9uIHdvdWxkIG9j
Y3VyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJh
bnRAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+Cm1hc3RlciBjb21taXQ6IGM2NWVhMTZk
YmNhZmJlNGZlMjE2OTNiMThmOGMyYTNjNWQxNDYwMGUKbWFzdGVyIGRhdGU6
IDIwMjAtMDQtMDMgMTA6NTY6NTUgKzAyMDAKCi0tLSBhL3hlbi9hcmNoL3g4
Ni9tbS9wMm0uYworKysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLmMKQEAgLTc3
OSw3ICs3NzksNiBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9kb21h
aW4gKnAybSwKIHsKICAgICB1bnNpZ25lZCBsb25nIGk7CiAgICAgZ2ZuX3Qg
Z2ZuID0gX2dmbihnZm5fbCk7Ci0gICAgbWZuX3QgbWZuX3JldHVybjsKICAg
ICBwMm1fdHlwZV90IHQ7CiAgICAgcDJtX2FjY2Vzc190IGE7CiAKQEAgLTc5
MCwxNSArNzg5LDI2IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2Rv
bWFpbiAqcDJtLAogICAgIEFTU0VSVChnZm5fbG9ja2VkX2J5X21lKHAybSwg
Z2ZuKSk7CiAgICAgUDJNX0RFQlVHKCJyZW1vdmluZyBnZm49JSNseCBtZm49
JSNseFxuIiwgZ2ZuX2wsIG1mbik7CiAKKyAgICBmb3IgKCBpID0gMDsgaSA8
ICgxVUwgPDwgcGFnZV9vcmRlcik7ICkKKyAgICB7CisgICAgICAgIHVuc2ln
bmVkIGludCBjdXJfb3JkZXI7CisgICAgICAgIG1mbl90IG1mbl9yZXR1cm4g
PSBwMm0tPmdldF9lbnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBpKSwgJnQsICZh
LCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJmN1cl9vcmRlciwgTlVMTCk7CisKKyAgICAgICAgaWYgKCBwMm1faXNf
dmFsaWQodCkgJiYKKyAgICAgICAgICAgICAoIW1mbl92YWxpZChfbWZuKG1m
bikpIHx8IG1mbiArIGkgIT0gbWZuX3gobWZuX3JldHVybikpICkKKyAgICAg
ICAgICAgIHJldHVybiAtRUlMU0VROworCisgICAgICAgIGkgKz0gKDFVTCA8
PCBjdXJfb3JkZXIpIC0gKChnZm5fbCArIGkpICYgKCgxVUwgPDwgY3VyX29y
ZGVyKSAtIDEpKTsKKyAgICB9CisKICAgICBpZiAoIG1mbl92YWxpZChfbWZu
KG1mbikpICkKICAgICB7CiAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDFV
TCA8PCBwYWdlX29yZGVyKTsgaSsrICkKICAgICAgICAgewotICAgICAgICAg
ICAgbWZuX3JldHVybiA9IHAybS0+Z2V0X2VudHJ5KHAybSwgZ2ZuX2FkZChn
Zm4sIGkpLCAmdCwgJmEsIDAsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgTlVMTCwgTlVMTCk7CisgICAgICAgICAgICBwMm0t
PmdldF9lbnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBpKSwgJnQsICZhLCAwLCBO
VUxMLCBOVUxMKTsKICAgICAgICAgICAgIGlmICggIXAybV9pc19ncmFudCh0
KSAmJiAhcDJtX2lzX3NoYXJlZCh0KSAmJiAhcDJtX2lzX2ZvcmVpZ24odCkg
KQogICAgICAgICAgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbitpLCBJ
TlZBTElEX00yUF9FTlRSWSk7Ci0gICAgICAgICAgICBBU1NFUlQoICFwMm1f
aXNfdmFsaWQodCkgfHwgbWZuICsgaSA9PSBtZm5feChtZm5fcmV0dXJuKSAp
OwogICAgICAgICB9CiAgICAgfQogICAgIHJldHVybiBwMm1fc2V0X2VudHJ5
KHAybSwgZ2ZuLCBJTlZBTElEX01GTiwgcGFnZV9vcmRlciwgcDJtX2ludmFs
aWQsCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-1.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZ2xvYmFsIGV4Y2x1c2lvbiByYW5nZSBl
eHRlbmRpbmcKCkJlc2lkZXMgdW5pdHkgbWFwcGluZyByZWdpb25zLCB0aGUg
QU1EIElPTU1VIHNwZWMgYWxzbyBwcm92aWRlcyBmb3IKZXhjbHVzaW9uIHJh
bmdlcyAoYXJlYXMgb2YgbWVtb3J5IG5vdCB0byBiZSBzdWJqZWN0IHRvIERN
QSB0cmFuc2xhdGlvbikKdG8gYmUgc3BlY2lmaWVkIGJ5IGZpcm13YXJlIGlu
IHRoZSBBQ1BJIHRhYmxlcy4gVGhlIHNwZWMgZG9lcyBub3QgcHV0CmFueSBj
b25zdHJhaW50cyBvbiB0aGUgbnVtYmVyIG9mIHN1Y2ggcmVnaW9ucy4KCkJs
aW5kbHkgYXNzdW1pbmcgYWxsIGFkZHJlc3NlcyBiZXR3ZWVuIGFueSB0d28g
c3VjaCByYW5nZXMgc2hvdWxkIGFsc28KYmUgZXhjbHVkZWQgY2FuJ3QgYmUg
cmlnaHQuIFNpbmNlIGhhcmR3YXJlIGhhcyByb29tIGZvciBqdXN0IGEgc2lu
Z2xlCnN1Y2ggcmFuZ2UgKGNvbXByaXNlZCBvZiB0aGUgRXhjbHVzaW9uIEJh
c2UgUmVnaXN0ZXIgYW5kIHRoZSBFeGNsdXNpb24KUmFuZ2UgTGltaXQgUmVn
aXN0ZXIpLCBjb21iaW5lIG9ubHkgYWRqYWNlbnQgb3Igb3ZlcmxhcHBpbmcg
cmVnaW9ucyAoZm9yCm5vdzsgdGhpcyBtYXkgcmVxdWlyZSBmdXJ0aGVyIGFk
anVzdG1lbnQgaW4gY2FzZSB0YWJsZSBlbnRyaWVzIGFyZW4ndApzb3J0ZWQg
YnkgYWRkcmVzcykgd2l0aCBtYXRjaGluZyBleGNsdXNpb25fYWxsb3dfYWxs
IHNldHRpbmdzLiBUaGlzCnJlcXVpcmVzIGJ1YmJsaW5nIHVwIGVycm9yIGlu
ZGljYXRvcnMsIHN1Y2ggdGhhdCBJT01NVSBpbml0IGNhbiBiZQpmYWlsZWQg
d2hlbiBjb25jYXRlbmF0aW9uIHdhc24ndCBwb3NzaWJsZS4KCkZ1cnRoZXJt
b3JlLCBzaW5jZSB0aGUgZXhjbHVzaW9uIHJhbmdlIHNwZWNpZmllZCBpbiBJ
T01NVSByZWdpc3RlcnMKaW1wbGllcyBSL1cgYWNjZXNzLCByZWplY3QgcmVx
dWVzdHMgYXNraW5nIGZvciBsZXNzIHBlcm1pc3Npb25zICh0aGlzCndpbGwg
YmUgYnJvdWdodCBjbG9zZXIgdG8gdGhlIHNwZWMgYnkgYSBzdWJzZXF1ZW50
IGNoYW5nZSkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3OCAvIENWRS0yMDIx
LTI4Njk1LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9hY3BpLmMKQEAgLTExNywxMiArMTE3LDIxIEBAIHN0YXRpYyBzdHJ1
Y3QgYW1kX2lvbW11ICogX19pbml0IGZpbmRfaW8KICAgICByZXR1cm4gTlVM
TDsKIH0KIAotc3RhdGljIHZvaWQgX19pbml0IHJlc2VydmVfaW9tbXVfZXhj
bHVzaW9uX3JhbmdlKAotICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1
aW50NjRfdCBiYXNlLCB1aW50NjRfdCBsaW1pdCkKK3N0YXRpYyBpbnQgX19p
bml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKAorICAgIHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11LCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBs
aW1pdCwKKyAgICBib29sIGFsbCwgYm9vbCBpdywgYm9vbCBpcikKIHsKKyAg
ICBpZiAoICFpciB8fCAhaXcgKQorICAgICAgICByZXR1cm4gLUVQRVJNOwor
CiAgICAgLyogbmVlZCB0byBleHRlbmQgZXhjbHVzaW9uIHJhbmdlPyAqLwog
ICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9lbmFibGUgKQogICAgIHsKKyAg
ICAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9uX2xpbWl0ICsgUEFHRV9TSVpF
IDwgYmFzZSB8fAorICAgICAgICAgICAgIGxpbWl0ICsgUEFHRV9TSVpFIDwg
aW9tbXUtPmV4Y2x1c2lvbl9iYXNlIHx8CisgICAgICAgICAgICAgaW9tbXUt
PmV4Y2x1c2lvbl9hbGxvd19hbGwgIT0gYWxsICkKKyAgICAgICAgICAgIHJl
dHVybiAtRUJVU1k7CisKICAgICAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9u
X2Jhc2UgPCBiYXNlICkKICAgICAgICAgICAgIGJhc2UgPSBpb21tdS0+ZXhj
bHVzaW9uX2Jhc2U7CiAgICAgICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9s
aW1pdCA+IGxpbWl0ICkKQEAgLTEzMCwxNiArMTM5LDExIEBAIHN0YXRpYyB2
b2lkIF9faW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2kKICAgICB9CiAKICAg
ICBpb21tdS0+ZXhjbHVzaW9uX2VuYWJsZSA9IElPTU1VX0NPTlRST0xfRU5B
QkxFRDsKKyAgICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCA9IGFsbDsK
ICAgICBpb21tdS0+ZXhjbHVzaW9uX2Jhc2UgPSBiYXNlOwogICAgIGlvbW11
LT5leGNsdXNpb25fbGltaXQgPSBsaW1pdDsKLX0KIAotc3RhdGljIHZvaWQg
X19pbml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlX2FsbCgKLSAg
ICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICB1bnNpZ25lZCBsb25n
IGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQpCi17Ci0gICAgcmVzZXJ2ZV9p
b21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0KTsKLSAg
ICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCA9IElPTU1VX0NPTlRST0xf
RU5BQkxFRDsKKyAgICByZXR1cm4gMDsKIH0KIAogc3RhdGljIHZvaWQgX19p
bml0IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoCkBAIC0xNzcsNiAr
MTgxLDcgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbgogICAgIHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3As
IGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdTsKICAgICB1
bnNpZ25lZCBpbnQgYmRmOworICAgIGludCByYyA9IDA7CiAKICAgICAvKiBp
cyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5nZSBpbnNpZGUgb2YgSU9NTVUgdmly
dHVhbCBhZGRyZXNzIHNwYWNlPyAqLwogICAgIC8qIG5vdGU6ICdsaW1pdCcg
cGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICovCkBA
IC0xOTgsMTAgKzIwMywxNSBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rl
cl9leGNsdXNpb25fcmFuCiAgICAgaWYgKCBsaW1pdCA+PSBpb21tdV90b3Ag
KQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBpb21tdSAp
Ci0gICAgICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZV9h
bGwoaW9tbXUsIGJhc2UsIGxpbWl0KTsKKyAgICAgICAgeworICAgICAgICAg
ICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwg
YmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOworICAg
ICAgICAgICAgaWYgKCByYyApCisgICAgICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1cm4gMDsKKyAgICByZXR1cm4g
cmM7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW5nZV9mb3JfZGV2aWNlKApAQCAtMjEyLDYgKzIyMiw3IEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICB1bnNp
Z25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7CiAgICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CiAgICAgdTE2IHJlcTsKKyAgICBp
bnQgcmMgPSAwOwogCiAgICAgaW9tbXUgPSBmaW5kX2lvbW11X2Zvcl9kZXZp
Y2Uoc2VnLCBiZGYpOwogICAgIGlmICggIWlvbW11ICkKQEAgLTI0MSwxMiAr
MjUyLDEzIEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW4KICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNpb24gcmFuZ2Ug
c2V0dGluZ3MgZm9yIGRldmljZSAqLwogICAgIGlmICggbGltaXQgPj0gaW9t
bXVfdG9wICApCiAgICAgewotICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQpOworICAgICAgICByYyA9
IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBs
aW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmYWxzZSAvKiBhbGwgKi8sIGl3LCBpcik7CiAgICAgICAgIGl2cnNf
bWFwcGluZ3NbYmRmXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gdHJ1ZTsKICAg
ICAgICAgaXZyc19tYXBwaW5nc1tyZXFdLmR0ZV9hbGxvd19leGNsdXNpb24g
PSB0cnVlOwogICAgIH0KIAotICAgIHJldHVybiAwOworICAgIHJldHVybiBy
YzsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbmdlX2Zvcl9pb21tdV9kZXZpY2VzKApAQCAtMjU2LDYgKzI2OCw3IEBA
IHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAg
ICB1bnNpZ25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7
CiAgICAgdW5zaWduZWQgaW50IGJkZjsKICAgICB1MTYgcmVxOworICAgIGlu
dCByYyA9IDA7CiAKICAgICAvKiBpcyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5n
ZSBpbnNpZGUgb2YgSU9NTVUgdmlydHVhbCBhZGRyZXNzIHNwYWNlPyAqLwog
ICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8g
YmUgcGFnZS1hbGlnbmVkICovCkBAIC0yODYsOCArMjk5LDEwIEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KIAogICAgIC8q
IHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwog
ICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkKLSAgICAgICAgcmVzZXJ2
ZV9pb21tdV9leGNsdXNpb25fcmFuZ2VfYWxsKGlvbW11LCBiYXNlLCBsaW1p
dCk7Ci0gICAgcmV0dXJuIDA7CisgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21t
dV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyog
YWxsICovLCBpdywgaXIpOworCisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0
aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9zZWxlY3QoCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-2.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZGV2aWNlIHVuaXR5IG1hcCBoYW5kbGlu
ZwoKQmxpbmRseSBhc3N1bWluZyBhbGwgYWRkcmVzc2VzIGJldHdlZW4gYW55
IHR3byBzdWNoIHJhbmdlcywgc3BlY2lmaWVkIGJ5CmZpcm13YXJlIGluIHRo
ZSBBQ1BJIHRhYmxlcywgc2hvdWxkIGFsc28gYmUgdW5pdHktbWFwcGVkIGNh
bid0IGJlIHJpZ2h0LgpOb3IgY2FuIGl0IGJlIGNvcnJlY3QgdG8gbWVyZ2Ug
cmFuZ2VzIHdpdGggZGlmZmVyaW5nIHBlcm1pc3Npb25zLiBUcmFjawpyYW5n
ZXMgaW5kaXZpZHVhbGx5OyBkb24ndCBtZXJnZSBhdCBhbGwsIGJ1dCBjaGVj
ayBmb3Igb3ZlcmxhcHMgaW5zdGVhZC4KVGhpcyByZXF1aXJlcyBidWJibGlu
ZyB1cCBlcnJvciBpbmRpY2F0b3JzLCBzdWNoIHRoYXQgSU9NTVUgaW5pdCBj
YW4gYmUKZmFpbGVkIHdoZW4gYWxsb2NhdGlvbiBvZiBhIG5ldyB0cmFja2lu
ZyBzdHJ1Y3Qgd2Fzbid0IHBvc3NpYmxlLCBvciBhbgpvdmVybGFwIHdhcyBk
ZXRlY3RlZC4KCkF0IHRoaXMgb2NjYXNpb24gYWxzbyBzdG9wIGlnbm9yaW5n
CmFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoKSdzIHJldHVy
biB2YWx1ZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4IC8gQ1ZFLTIwMjEt
Mjg2OTUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2Uu
ZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQg
PHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtMTQ2LDMyICsxNDYsNDggQEAgc3Rh
dGljIGludCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9leGNsdXNpbwogICAgIHJl
dHVybiAwOwogfQogCi1zdGF0aWMgdm9pZCBfX2luaXQgcmVzZXJ2ZV91bml0
eV9tYXBfZm9yX2RldmljZSgKLSAgICB1MTYgc2VnLCB1MTYgYmRmLCB1bnNp
Z25lZCBsb25nIGJhc2UsCi0gICAgdW5zaWduZWQgbG9uZyBsZW5ndGgsIHU4
IGl3LCB1OCBpcikKK3N0YXRpYyBpbnQgX19pbml0IHJlc2VydmVfdW5pdHlf
bWFwX2Zvcl9kZXZpY2UoCisgICAgdWludDE2X3Qgc2VnLCB1aW50MTZfdCBi
ZGYsIHVuc2lnbmVkIGxvbmcgYmFzZSwKKyAgICB1bnNpZ25lZCBsb25nIGxl
bmd0aCwgYm9vbCBpdywgYm9vbCBpcikKIHsKICAgICBzdHJ1Y3QgaXZyc19t
YXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBpbmdzKHNl
Zyk7Ci0gICAgdW5zaWduZWQgbG9uZyBvbGRfdG9wLCBuZXdfdG9wOworICAg
IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwID0gaXZyc19tYXBw
aW5nc1tiZGZdLnVuaXR5X21hcDsKIAotICAgIC8qIG5lZWQgdG8gZXh0ZW5k
IHVuaXR5LW1hcHBlZCByYW5nZT8gKi8KLSAgICBpZiAoIGl2cnNfbWFwcGlu
Z3NbYmRmXS51bml0eV9tYXBfZW5hYmxlICkKKyAgICAvKiBDaGVjayBmb3Ig
b3ZlcmxhcHMuICovCisgICAgZm9yICggOyB1bml0eV9tYXA7IHVuaXR5X21h
cCA9IHVuaXR5X21hcC0+bmV4dCApCiAgICAgewotICAgICAgICBvbGRfdG9w
ID0gaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2Vfc3RhcnQgKwotICAg
ICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2VfbGVuZ3Ro
OwotICAgICAgICBuZXdfdG9wID0gYmFzZSArIGxlbmd0aDsKLSAgICAgICAg
aWYgKCBvbGRfdG9wID4gbmV3X3RvcCApCi0gICAgICAgICAgICBuZXdfdG9w
ID0gb2xkX3RvcDsKLSAgICAgICAgaWYgKCBpdnJzX21hcHBpbmdzW2JkZl0u
YWRkcl9yYW5nZV9zdGFydCA8IGJhc2UgKQotICAgICAgICAgICAgYmFzZSA9
IGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3JhbmdlX3N0YXJ0OwotICAgICAg
ICBsZW5ndGggPSBuZXdfdG9wIC0gYmFzZTsKLSAgICB9Ci0KLSAgICAvKiBl
eHRlbmQgci93IHBlcm1pc3Npb21zIGFuZCBrZWVwIGFnZ3JlZ2F0ZSAqLwot
ICAgIGl2cnNfbWFwcGluZ3NbYmRmXS53cml0ZV9wZXJtaXNzaW9uID0gaXc7
Ci0gICAgaXZyc19tYXBwaW5nc1tiZGZdLnJlYWRfcGVybWlzc2lvbiA9IGly
OwotICAgIGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXBfZW5hYmxlID0g
dHJ1ZTsKLSAgICBpdnJzX21hcHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9zdGFy
dCA9IGJhc2U7Ci0gICAgaXZyc19tYXBwaW5nc1tiZGZdLmFkZHJfcmFuZ2Vf
bGVuZ3RoID0gbGVuZ3RoOworICAgICAgICAvKgorICAgICAgICAgKiBFeGFj
dCBtYXRjaGVzIGFyZSBva2F5LiBUaGlzIGNhbiBpbiBwYXJ0aWN1bGFyIGhh
cHBlbiB3aGVuCisgICAgICAgICAqIHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5n
ZV9mb3JfZGV2aWNlKCkgY2FsbHMgaGVyZSB0d2ljZSBmb3IgdGhlCisgICAg
ICAgICAqIHNhbWUgKHMsYixkLGYpLgorICAgICAgICAgKi8KKyAgICAgICAg
aWYgKCBiYXNlID09IHVuaXR5X21hcC0+YWRkciAmJiBsZW5ndGggPT0gdW5p
dHlfbWFwLT5sZW5ndGggJiYKKyAgICAgICAgICAgICBpciA9PSB1bml0eV9t
YXAtPnJlYWQgJiYgaXcgPT0gdW5pdHlfbWFwLT53cml0ZSApCisgICAgICAg
ICAgICByZXR1cm4gMDsKKworICAgICAgICBpZiAoIHVuaXR5X21hcC0+YWRk
ciArIHVuaXR5X21hcC0+bGVuZ3RoID4gYmFzZSAmJgorICAgICAgICAgICAg
IGJhc2UgKyBsZW5ndGggPiB1bml0eV9tYXAtPmFkZHIgKQorICAgICAgICB7
CisgICAgICAgICAgICBBTURfSU9NTVVfREVCVUcoIklWTUQgRXJyb3I6IG92
ZXJsYXAgWyVseCwlbHgpIHZzIFslbHgsJWx4KVxuIiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBiYXNlLCBiYXNlICsgbGVuZ3RoLCB1bml0eV9t
YXAtPmFkZHIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdHlf
bWFwLT5hZGRyICsgdW5pdHlfbWFwLT5sZW5ndGgpOworICAgICAgICAgICAg
cmV0dXJuIC1FUEVSTTsKKyAgICAgICAgfQorICAgIH0KKworICAgIC8qIFBv
cHVsYXRlIGFuZCBpbnNlcnQgYSBuZXcgdW5pdHkgbWFwLiAqLworICAgIHVu
aXR5X21hcCA9IHhtYWxsb2Moc3RydWN0IGl2cnNfdW5pdHlfbWFwKTsKKyAg
ICBpZiAoICF1bml0eV9tYXAgKQorICAgICAgICByZXR1cm4gLUVOT01FTTsK
KworICAgIHVuaXR5X21hcC0+cmVhZCA9IGlyOworICAgIHVuaXR5X21hcC0+
d3JpdGUgPSBpdzsKKyAgICB1bml0eV9tYXAtPmFkZHIgPSBiYXNlOworICAg
IHVuaXR5X21hcC0+bGVuZ3RoID0gbGVuZ3RoOworICAgIHVuaXR5X21hcC0+
bmV4dCA9IGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXA7CisgICAgaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcCA9IHVuaXR5X21hcDsKKworICAg
IHJldHVybiAwOwogfQogCiBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9l
eGNsdXNpb25fcmFuZ2VfZm9yX2FsbF9kZXZpY2VzKApAQCAtMTk0LDEzICsy
MTAsMTMgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbgogICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwogICAg
ICAgICAvKiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVz
IGZvciBkZXZpY2VzICovCiAgICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJp
ZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAgICAg
ICBmb3IgKCBiZGYgPSAwOyBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYr
KyApCi0gICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNl
KHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7CisgICAgICAgIGZv
ciAoIGJkZiA9IDA7ICFyYyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBi
ZGYrKyApCisgICAgICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zv
cl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsKICAg
ICAgICAgLyogcHVzaCAnYmFzZScganVzdCBvdXRzaWRlIG9mIHZpcnR1YWwg
YWRkcmVzcyBzcGFjZSAqLwogICAgICAgICBiYXNlID0gaW9tbXVfdG9wOwog
ICAgIH0KICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNpb24gcmFuZ2Ug
c2V0dGluZ3MgKi8KLSAgICBpZiAoIGxpbWl0ID49IGlvbW11X3RvcCApCisg
ICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICkKICAgICB7CiAg
ICAgICAgIGZvcl9lYWNoX2FtZF9pb21tdSggaW9tbXUgKQogICAgICAgICB7
CkBAIC0yNDIsMTUgKzI1OCwxNSBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdp
c3Rlcl9leGNsdXNpb25fcmFuCiAgICAgICAgIGxlbmd0aCA9IHJhbmdlX3Rv
cCAtIGJhc2U7CiAgICAgICAgIC8qIHJlc2VydmUgdW5pdHktbWFwcGVkIHBh
Z2UgZW50cmllcyBmb3IgZGV2aWNlICovCiAgICAgICAgIC8qIG5vdGU6IHRo
ZXNlIGVudHJpZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAq
LwotICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywg
YmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7Ci0gICAgICAgIHJlc2VydmVf
dW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCByZXEsIGJhc2UsIGxlbmd0aCwg
aXcsIGlyKTsKKyAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3Jf
ZGV2aWNlKHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcikgPzoKKyAg
ICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywg
cmVxLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7CiAKICAgICAgICAgLyogcHVz
aCAnYmFzZScganVzdCBvdXRzaWRlIG9mIHZpcnR1YWwgYWRkcmVzcyBzcGFj
ZSAqLwogICAgICAgICBiYXNlID0gaW9tbXVfdG9wOwogICAgIH0KIAogICAg
IC8qIHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyBm
b3IgZGV2aWNlICovCi0gICAgaWYgKCBsaW1pdCA+PSBpb21tdV90b3AgICkK
KyAgICBpZiAoICFyYyAmJiBsaW1pdCA+PSBpb21tdV90b3AgICkKICAgICB7
CiAgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2Uo
aW9tbXUsIGJhc2UsIGxpbWl0LAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGZhbHNlIC8qIGFsbCAqLywgaXcsIGlyKTsK
QEAgLTI4MSwxNSArMjk3LDE1IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lz
dGVyX2V4Y2x1c2lvbl9yYW4KICAgICAgICAgbGVuZ3RoID0gcmFuZ2VfdG9w
IC0gYmFzZTsKICAgICAgICAgLyogcmVzZXJ2ZSByL3cgdW5pdHktbWFwcGVk
IHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAqLwogICAgICAgICAvKiBub3Rl
OiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNpb24gcmFu
Z2UgKi8KLSAgICAgICAgZm9yICggYmRmID0gMDsgYmRmIDwgaXZyc19iZGZf
ZW50cmllczsgYmRmKysgKQorICAgICAgICBmb3IgKCBiZGYgPSAwOyAhcmMg
JiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysgKQogICAgICAgICB7
CiAgICAgICAgICAgICBpZiAoIGlvbW11ID09IGZpbmRfaW9tbXVfZm9yX2Rl
dmljZShpb21tdS0+c2VnLCBiZGYpICkKICAgICAgICAgICAgIHsKLSAgICAg
ICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11
LT5zZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGlyKTsKICAgICAgICAg
ICAgICAgICByZXEgPSBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVti
ZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7Ci0gICAgICAgICAgICAgICAgcmVzZXJ2
ZV91bml0eV9tYXBfZm9yX2RldmljZShpb21tdS0+c2VnLCByZXEsIGJhc2Us
IGxlbmd0aCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGl3LCBpcik7CisgICAgICAgICAgICAgICAgcmMgPSByZXNl
cnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZiwgYmFz
ZSwgbGVuZ3RoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpdywgaXIpID86CisgICAgICAgICAgICAgICAg
ICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcs
IHJlcSwgYmFzZSwgbGVuZ3RoLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIpOwogICAgICAgICAg
ICAgfQogICAgICAgICB9CiAKQEAgLTI5OCw3ICszMTQsNyBAQCBzdGF0aWMg
aW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgfQogCiAg
ICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdz
ICovCi0gICAgaWYgKCBsaW1pdCA+PSBpb21tdV90b3AgKQorICAgIGlmICgg
IXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCApCiAgICAgICAgIHJjID0gcmVz
ZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHRydWUgLyogYWxsICovLCBpdywgaXIpOwogCi0tLSBhL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwpAQCAtMzY5
LDE1ICszNjksMTcgQEAgc3RhdGljIGludCBhbWRfaW9tbXVfYXNzaWduX2Rl
dmljZShzdHJ1YwogICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX21h
cHBpbmdzID0gZ2V0X2l2cnNfbWFwcGluZ3MocGRldi0+c2VnKTsKICAgICBp
bnQgYmRmID0gUENJX0JERjIocGRldi0+YnVzLCBkZXZmbik7CiAgICAgaW50
IHJlcV9pZCA9IGdldF9kbWFfcmVxdWVzdG9yX2lkKHBkZXYtPnNlZywgYmRm
KTsKKyAgICBjb25zdCBzdHJ1Y3QgaXZyc191bml0eV9tYXAgKnVuaXR5X21h
cDsKIAotICAgIGlmICggaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21h
cF9lbmFibGUgKQorICAgIGZvciAoIHVuaXR5X21hcCA9IGl2cnNfbWFwcGlu
Z3NbcmVxX2lkXS51bml0eV9tYXA7IHVuaXR5X21hcDsKKyAgICAgICAgICB1
bml0eV9tYXAgPSB1bml0eV9tYXAtPm5leHQgKQogICAgIHsKLSAgICAgICAg
YW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKLSAgICAgICAg
ICAgIGQsCi0gICAgICAgICAgICBpdnJzX21hcHBpbmdzW3JlcV9pZF0uYWRk
cl9yYW5nZV9zdGFydCwKLSAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbcmVx
X2lkXS5hZGRyX3JhbmdlX2xlbmd0aCwKLSAgICAgICAgICAgIGl2cnNfbWFw
cGluZ3NbcmVxX2lkXS53cml0ZV9wZXJtaXNzaW9uLAotICAgICAgICAgICAg
aXZyc19tYXBwaW5nc1tyZXFfaWRdLnJlYWRfcGVybWlzc2lvbik7CisgICAg
ICAgIGludCByYyA9IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9t
YXAoCisgICAgICAgICAgICAgICAgICAgICBkLCB1bml0eV9tYXAtPmFkZHIs
IHVuaXR5X21hcC0+bGVuZ3RoLAorICAgICAgICAgICAgICAgICAgICAgdW5p
dHlfbWFwLT53cml0ZSwgdW5pdHlfbWFwLT5yZWFkKTsKKworICAgICAgICBp
ZiAoIHJjICkKKyAgICAgICAgICAgIHJldHVybiByYzsKICAgICB9CiAKICAg
ICByZXR1cm4gcmVhc3NpZ25fZGV2aWNlKHBkZXYtPmRvbWFpbiwgZCwgZGV2
Zm4sIHBkZXYpOwotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2FtZC1pb21t
dS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvYW1kLWlvbW11LmgKQEAg
LTEwNSwyMCArMTA1LDI0IEBAIHN0cnVjdCBhbWRfaW9tbXUgewogICAgIHN0
cnVjdCBsaXN0X2hlYWQgYXRzX2RldmljZXM7CiB9OwogCitzdHJ1Y3QgaXZy
c191bml0eV9tYXAgeworICAgIGJvb2wgcmVhZDoxOworICAgIGJvb2wgd3Jp
dGU6MTsKKyAgICBwYWRkcl90IGFkZHI7CisgICAgdW5zaWduZWQgbG9uZyBs
ZW5ndGg7CisgICAgc3RydWN0IGl2cnNfdW5pdHlfbWFwICpuZXh0OworfTsK
Kwogc3RydWN0IGl2cnNfbWFwcGluZ3MgewogICAgIHVpbnQxNl90IGR0ZV9y
ZXF1ZXN0b3JfaWQ7CiAgICAgYm9vbCB2YWxpZDoxOwogICAgIGJvb2wgZHRl
X2FsbG93X2V4Y2x1c2lvbjoxOwotICAgIGJvb2wgdW5pdHlfbWFwX2VuYWJs
ZToxOwotICAgIGJvb2wgd3JpdGVfcGVybWlzc2lvbjoxOwotICAgIGJvb2wg
cmVhZF9wZXJtaXNzaW9uOjE7CiAKICAgICAvKiBpdmhkIGRldmljZSBkYXRh
IHNldHRpbmdzICovCiAgICAgdWludDhfdCBkZXZpY2VfZmxhZ3M7CiAKLSAg
ICB1bnNpZ25lZCBsb25nIGFkZHJfcmFuZ2Vfc3RhcnQ7Ci0gICAgdW5zaWdu
ZWQgbG9uZyBhZGRyX3JhbmdlX2xlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lv
bW11ICppb21tdTsKKyAgICBzdHJ1Y3QgaXZyc191bml0eV9tYXAgKnVuaXR5
X21hcDsKIAogICAgIC8qIHBlciBkZXZpY2UgaW50ZXJydXB0IHJlbWFwcGlu
ZyB0YWJsZSAqLwogICAgIHZvaWQgKmludHJlbWFwX3RhYmxlOwo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-3.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogYWxzbyBwYXNzIHAybV9hY2Nlc3NfdCB0byBwMm1fZ2V0X2lv
bW11X2ZsYWdzKCkKCkEgc3Vic2VxdWVudCBjaGFuZ2Ugd2lsbCB3YW50IHRv
IGN1c3RvbWl6ZSB0aGUgSU9NTVUgcGVybWlzc2lvbnMgYmFzZWQKb24gdGhp
cy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTY3OCw3ICs2NzgsNyBAQCBlcHRfc2V0X2VudHJ5KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sIGdmCiAgICAgdWludDhfdCBpcGF0ID0gMDsKICAg
ICBib29sX3QgbmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMTsKICAgICBib29s
X3QgdnRkX3B0ZV9wcmVzZW50ID0gMDsKLSAgICB1bnNpZ25lZCBpbnQgaW9t
bXVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIG1mbik7Cisg
ICAgdW5zaWduZWQgaW50IGlvbW11X2ZsYWdzID0gcDJtX2dldF9pb21tdV9m
bGFncyhwMm10LCBwMm1hLCBtZm4pOwogICAgIGJvb2xfdCBuZWVkc19zeW5j
ID0gMTsKICAgICBlcHRfZW50cnlfdCBvbGRfZW50cnkgPSB7IC5lcHRlID0g
MCB9OwogICAgIGVwdF9lbnRyeV90IG5ld19lbnRyeSA9IHsgLmVwdGUgPSAw
IH07CkBAIC04MDUsOCArODA1LDggQEAgZXB0X3NldF9lbnRyeShzdHJ1Y3Qg
cDJtX2RvbWFpbiAqcDJtLCBnZgogCiAgICAgICAgIC8qIFNhZmUgdG8gcmVh
ZC10aGVuLXdyaXRlIGJlY2F1c2Ugd2UgaG9sZCB0aGUgcDJtIGxvY2sgKi8K
ICAgICAgICAgaWYgKCBlcHRfZW50cnktPm1mbiA9PSBuZXdfZW50cnkubWZu
ICYmCi0gICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhlcHRfZW50
cnktPnNhX3AybXQsIF9tZm4oZXB0X2VudHJ5LT5tZm4pKSA9PQotICAgICAg
ICAgICAgIGlvbW11X2ZsYWdzICkKKyAgICAgICAgICAgICBwMm1fZ2V0X2lv
bW11X2ZsYWdzKGVwdF9lbnRyeS0+c2FfcDJtdCwgZXB0X2VudHJ5LT5hY2Nl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWZuKGVw
dF9lbnRyeS0+bWZuKSkgPT0gaW9tbXVfZmxhZ3MgKQogICAgICAgICAgICAg
bmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMDsKIAogICAgICAgICBlcHRfcDJt
X3R5cGVfdG9fZmxhZ3MocDJtLCAmbmV3X2VudHJ5LCBwMm10LCBwMm1hKTsK
LS0tIGEveGVuL2FyY2gveDg2L21tL3AybS1wdC5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9tbS9wMm0tcHQuYwpAQCAtNDgwLDYgKzQ4MCwxNiBAQCBpbnQgcDJt
X3B0X2hhbmRsZV9kZWZlcnJlZF9jaGFuZ2VzKHVpbnQ2CiAgICAgcmV0dXJu
IHJjOwogfQogCisvKiBSZWNvbnN0cnVjdCBhIGZha2UgcDJtX2FjY2Vzc190
IGZyb20gc3RvcmVkIFBURSBmbGFncy4gKi8KK3N0YXRpYyBwMm1fYWNjZXNz
X3QgcDJtX2ZsYWdzX3RvX2FjY2Vzcyh1bnNpZ25lZCBpbnQgZmxhZ3MpCit7
CisgICAgaWYgKCBmbGFncyAmIF9QQUdFX1BSRVNFTlQgKQorICAgICAgICBy
ZXR1cm4gcDJtX2FjY2Vzc19uOworCisgICAgLyogTm8gbmVlZCB0byBsb29r
IGF0IF9QQUdFX05YIGZvciBub3cuICovCisgICAgcmV0dXJuIGZsYWdzICYg
X1BBR0VfUlcgPyBwMm1fYWNjZXNzX3J3IDogcDJtX2FjY2Vzc19yOworfQor
CiAvKiBDaGVja3Mgb25seSBhcHBsaWNhYmxlIHRvIGVudHJpZXMgd2l0aCBv
cmRlciA+IFBBR0VfT1JERVJfNEsgKi8KIHN0YXRpYyB2b2lkIGNoZWNrX2Vu
dHJ5KG1mbl90IG1mbiwgcDJtX3R5cGVfdCBuZXcsIHAybV90eXBlX3Qgb2xk
LAogICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVy
KQpAQCAtNTE0LDcgKzUyNCw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0
IHAybV9kb21haW4gKnAybSwKICAgICBsMl9wZ2VudHJ5X3QgbDJlX2NvbnRl
bnQ7CiAgICAgbDNfcGdlbnRyeV90IGwzZV9jb250ZW50OwogICAgIGludCBy
YzsKLSAgICB1bnNpZ25lZCBpbnQgaW9tbXVfcHRlX2ZsYWdzID0gcDJtX2dl
dF9pb21tdV9mbGFncyhwMm10LCBtZm4pOworICAgIHVuc2lnbmVkIGludCBp
b21tdV9wdGVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIHAy
bWEsIG1mbik7CiAgICAgLyoKICAgICAgKiBvbGRfbWZuIGFuZCBpb21tdV9v
bGRfZmxhZ3MgY29udHJvbCBwb3NzaWJsZSBmbHVzaC91cGRhdGUgbmVlZHMg
b24gdGhlCiAgICAgICogSU9NTVU6IFdlIG5lZWQgdG8gZmx1c2ggd2hlbiBN
Rk4gb3IgZmxhZ3MgKGkuZS4gcGVybWlzc2lvbnMpIGNoYW5nZS4KQEAgLTU3
Nyw2ICs1ODcsNyBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9t
YWluICpwMm0sCiAgICAgICAgICAgICAgICAgb2xkX21mbiA9IGwxZV9nZXRf
cGZuKCpwMm1fZW50cnkpOwogICAgICAgICAgICAgICAgIGlvbW11X29sZF9m
bGFncyA9CiAgICAgICAgICAgICAgICAgICAgIHAybV9nZXRfaW9tbXVfZmxh
Z3MocDJtX2ZsYWdzX3RvX3R5cGUoZmxhZ3MpLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9mbGFnc190b19hY2Nlc3Mo
ZmxhZ3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIF9tZm4ob2xkX21mbikpOwogICAgICAgICAgICAgfQogICAgICAgICAg
ICAgZWxzZQpAQCAtNjE5LDkgKzYzMCwxMCBAQCBwMm1fcHRfc2V0X2VudHJ5
KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIDAsIEwxX1BBR0VUQUJMRV9FTlRSSUVTKTsKICAg
ICAgICAgQVNTRVJUKHAybV9lbnRyeSk7CiAgICAgICAgIG9sZF9tZm4gPSBs
MWVfZ2V0X3BmbigqcDJtX2VudHJ5KTsKKyAgICAgICAgZmxhZ3MgPSBsMWVf
Z2V0X2ZsYWdzKCpwMm1fZW50cnkpOwogICAgICAgICBpb21tdV9vbGRfZmxh
Z3MgPQotICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxh
Z3NfdG9fdHlwZShsMWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkpKSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7Cisg
ICAgICAgICAgICBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV9mbGFnc190b190
eXBlKGZsYWdzKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyksIF9tZm4ob2xkX21mbikpOwog
CiAgICAgICAgIGlmICggbWZuX3ZhbGlkKG1mbikgfHwgcDJtX2FsbG93c19p
bnZhbGlkX21mbihwMm10KSApCiAgICAgICAgICAgICBlbnRyeV9jb250ZW50
ID0gcDJtX2wxZV9mcm9tX3BmbihtZm5feChtZm4pLApAQCAtNjQ5LDYgKzY2
MSw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4gKnAy
bSwKICAgICAgICAgICAgICAgICBvbGRfbWZuID0gbDFlX2dldF9wZm4oKnAy
bV9lbnRyeSk7CiAgICAgICAgICAgICAgICAgaW9tbXVfb2xkX2ZsYWdzID0K
ICAgICAgICAgICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1f
ZmxhZ3NfdG9fdHlwZShmbGFncyksCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyks
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21m
bihvbGRfbWZuKSk7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNl
Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9wMm0uaApAQCAtOTA4LDcgKzkwOCw4IEBAIHN0YXRp
YyBpbmxpbmUgdm9pZCBwMm1fYWx0cDJtX2NoZWNrKHN0cnUKIC8qCiAgKiBw
Mm0gdHlwZSB0byBJT01NVSBmbGFncwogICovCi1zdGF0aWMgaW5saW5lIHVu
c2lnbmVkIGludCBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybV90eXBlX3QgcDJt
dCwgbWZuX3QgbWZuKQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJt
X2dldF9pb21tdV9mbGFncyhwMm1fdHlwZV90IHAybXQsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9hY2Nl
c3NfdCBwMm1hLCBtZm5fdCBtZm4pCiB7CiAgICAgdW5zaWduZWQgaW50IGZs
YWdzOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-4.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogZ2VuZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVk
IFJNUlIgcmVnaW9ucwoKSW4gb3JkZXIgdG8gcmUtdXNlIGl0IGVsc2V3aGVy
ZSwgbW92ZSB0aGUgbG9naWMgdG8gdmVuZG9yIGluZGVwZW5kZW50CmNvZGUg
YW5kIHN0cmlwIGl0IG9mIFJNUlIgc3BlY2lmaWNzLgoKTm90ZSB0aGF0IHRo
ZSBwcmlvciAibWFwIiBwYXJhbWV0ZXIgZ2V0cyBmb2xkZWQgaW50byB0aGUg
bmV3ICJwMm1hIiBvbmUKKHdoaWNoIEFNRCBJT01NVSBjb2RlIHdpbGwgd2Fu
dCB0byBtYWtlIHVzZSBvZiksIGFzc2lnbmluZyBhbHRlcm5hdGl2ZQptZWFu
aW5nICgidW5tYXAiKSB0byBwMm1fYWNjZXNzX3guIFByZXBhcmUgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpIGFuZApwMm1fZ2V0X2lvbW11X2ZsYWdzKCkg
Zm9yIGdldHRpbmcgcGFzc2VkIGFjY2VzcyB0eXBlcyBvdGhlciB0aGFuCnAy
bV9hY2Nlc3NfcncgKGluIHRoZSBsYXR0ZXIgY2FzZSBqdXN0IGZvciBwMm1f
bW1pb19kaXJlY3QgcmVxdWVzdHMpLgoKTm90ZSBhbHNvIHRoYXQsIHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUsIGFuIG92ZXJsYXAgY2hlY2sgZ2V0cyBhZGRl
ZCB0bwp0aGUgbWFpbiBsb29wIG9mIGlvbW11X2lkZW50aXR5X21hcHBpbmco
KS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0x
MzUxLDcgKzEzNTEsNyBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShz
dHJ1Y3QgZG9tYWluCiAgICAgICAgIGlmICggIWlzX2lvbW11X2VuYWJsZWQo
ZCkgKQogICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgIHJldHVybiBp
b21tdV9sZWdhY3lfbWFwKGQsIF9kZm4oZ2ZuX2wpLCBfbWZuKGdmbl9sKSwg
UEFHRV9PUkRFUl80SywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVGX3JlYWRhYmxlIHwgSU9NTVVGX3dyaXRhYmxlKTsKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2FjY2Vzc190b19pb21t
dV9mbGFncyhwMm1hKSk7CiAgICAgfQogCiAgICAgZ2ZuX2xvY2socDJtLCBn
Zm4sIDApOwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUu
YwpAQCAtNDIsMTIgKzQyLDYgQEAKICNpbmNsdWRlICJ2dGQuaCIKICNpbmNs
dWRlICIuLi9hdHMuaCIKIAotc3RydWN0IG1hcHBlZF9ybXJyIHsKLSAgICBz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Ci0gICAgdTY0IGJhc2UsIGVuZDsKLSAg
ICB1bnNpZ25lZCBpbnQgY291bnQ7Ci19OwotCiAvKiBQb3NzaWJsZSB1bmZp
bHRlcmVkIExBUElDL01TSSBtZXNzYWdlcyBmcm9tIHVudHJ1c3RlZCBzb3Vy
Y2VzPyAqLwogYm9vbCBfX3JlYWRfbW9zdGx5IHVudHJ1c3RlZF9tc2k7CiAK
QEAgLTE3OTksMTcgKzE3OTMsMTIgQEAgb3V0Ogogc3RhdGljIHZvaWQgaW9t
bXVfZG9tYWluX3RlYXJkb3duKHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAg
c3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0gICAg
c3RydWN0IG1hcHBlZF9ybXJyICptcm1yciwgKnRtcDsKICAgICBjb25zdCBz
dHJ1Y3QgYWNwaV9kcmhkX3VuaXQgKmRyaGQ7CiAKICAgICBpZiAoIGxpc3Rf
ZW1wdHkoJmFjcGlfZHJoZF91bml0cykgKQogICAgICAgICByZXR1cm47CiAK
LSAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUgKCBtcm1yciwgdG1wLCAm
aGQtPmFyY2gubWFwcGVkX3JtcnJzLCBsaXN0ICkKLSAgICB7Ci0gICAgICAg
IGxpc3RfZGVsKCZtcm1yci0+bGlzdCk7Ci0gICAgICAgIHhmcmVlKG1ybXJy
KTsKLSAgICB9CisgICAgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKGQp
OwogCiAgICAgQVNTRVJUKGlzX2lvbW11X2VuYWJsZWQoZCkpOwogCkBAIC0x
OTYzLDc0ICsxOTUyLDYgQEAgc3RhdGljIHZvaWQgaW9tbXVfc2V0X3BnZChz
dHJ1Y3QgZG9tYWluCiAgICAgICAgIHBhZ2V0YWJsZV9nZXRfcGFkZHIocGFn
ZXRhYmxlX2Zyb21fbWZuKHBnZF9tZm4pKTsKIH0KIAotc3RhdGljIGludCBy
bXJyX2lkZW50aXR5X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZCwgYm9vbF90
IG1hcCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBhY3BpX3JtcnJfdW5pdCAqcm1yciwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHUzMiBmbGFnKQotewotICAgIHVuc2lnbmVk
IGxvbmcgYmFzZV9wZm4gPSBybXJyLT5iYXNlX2FkZHJlc3MgPj4gUEFHRV9T
SElGVF80SzsKLSAgICB1bnNpZ25lZCBsb25nIGVuZF9wZm4gPSBQQUdFX0FM
SUdOXzRLKHJtcnItPmVuZF9hZGRyZXNzKSA+PiBQQUdFX1NISUZUXzRLOwot
ICAgIHN0cnVjdCBtYXBwZWRfcm1yciAqbXJtcnI7Ci0gICAgc3RydWN0IGRv
bWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0KLSAgICBBU1NFUlQo
cGNpZGV2c19sb2NrZWQoKSk7Ci0gICAgQVNTRVJUKHJtcnItPmJhc2VfYWRk
cmVzcyA8IHJtcnItPmVuZF9hZGRyZXNzKTsKLQotICAgIC8qCi0gICAgICog
Tm8gbmVlZCB0byBhY3F1aXJlIGhkLT5hcmNoLm1hcHBpbmdfbG9jazogQm90
aCBpbnNlcnRpb24gYW5kIHJlbW92YWwKLSAgICAgKiBnZXQgZG9uZSB3aGls
ZSBob2xkaW5nIHBjaWRldnNfbG9jay4KLSAgICAgKi8KLSAgICBsaXN0X2Zv
cl9lYWNoX2VudHJ5KCBtcm1yciwgJmhkLT5hcmNoLm1hcHBlZF9ybXJycywg
bGlzdCApCi0gICAgewotICAgICAgICBpZiAoIG1ybXJyLT5iYXNlID09IHJt
cnItPmJhc2VfYWRkcmVzcyAmJgotICAgICAgICAgICAgIG1ybXJyLT5lbmQg
PT0gcm1yci0+ZW5kX2FkZHJlc3MgKQotICAgICAgICB7Ci0gICAgICAgICAg
ICBpbnQgcmV0ID0gMDsKLQotICAgICAgICAgICAgaWYgKCBtYXAgKQotICAg
ICAgICAgICAgewotICAgICAgICAgICAgICAgICsrbXJtcnItPmNvdW50Owot
ICAgICAgICAgICAgICAgIHJldHVybiAwOwotICAgICAgICAgICAgfQotCi0g
ICAgICAgICAgICBpZiAoIC0tbXJtcnItPmNvdW50ICkKLSAgICAgICAgICAg
ICAgICByZXR1cm4gMDsKLQotICAgICAgICAgICAgd2hpbGUgKCBiYXNlX3Bm
biA8IGVuZF9wZm4gKQotICAgICAgICAgICAgewotICAgICAgICAgICAgICAg
IGlmICggY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KGQsIGJhc2VfcGZuKSAp
Ci0gICAgICAgICAgICAgICAgICAgIHJldCA9IC1FTlhJTzsKLSAgICAgICAg
ICAgICAgICBiYXNlX3BmbisrOwotICAgICAgICAgICAgfQotCi0gICAgICAg
ICAgICBsaXN0X2RlbCgmbXJtcnItPmxpc3QpOwotICAgICAgICAgICAgeGZy
ZWUobXJtcnIpOwotICAgICAgICAgICAgcmV0dXJuIHJldDsKLSAgICAgICAg
fQotICAgIH0KLQotICAgIGlmICggIW1hcCApCi0gICAgICAgIHJldHVybiAt
RU5PRU5UOwotCi0gICAgd2hpbGUgKCBiYXNlX3BmbiA8IGVuZF9wZm4gKQot
ICAgIHsKLSAgICAgICAgaW50IGVyciA9IHNldF9pZGVudGl0eV9wMm1fZW50
cnkoZCwgYmFzZV9wZm4sIHAybV9hY2Nlc3NfcncsIGZsYWcpOwotCi0gICAg
ICAgIGlmICggZXJyICkKLSAgICAgICAgICAgIHJldHVybiBlcnI7Ci0gICAg
ICAgIGJhc2VfcGZuKys7Ci0gICAgfQotCi0gICAgbXJtcnIgPSB4bWFsbG9j
KHN0cnVjdCBtYXBwZWRfcm1ycik7Ci0gICAgaWYgKCAhbXJtcnIgKQotICAg
ICAgICByZXR1cm4gLUVOT01FTTsKLSAgICBtcm1yci0+YmFzZSA9IHJtcnIt
PmJhc2VfYWRkcmVzczsKLSAgICBtcm1yci0+ZW5kID0gcm1yci0+ZW5kX2Fk
ZHJlc3M7Ci0gICAgbXJtcnItPmNvdW50ID0gMTsKLSAgICBsaXN0X2FkZF90
YWlsKCZtcm1yci0+bGlzdCwgJmhkLT5hcmNoLm1hcHBlZF9ybXJycyk7Ci0K
LSAgICByZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpbnRlbF9pb21tdV9h
ZGRfZGV2aWNlKHU4IGRldmZuLCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKIHsK
ICAgICBzdHJ1Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnI7CkBAIC0yMDYyLDcg
KzE5ODMsOSBAQCBzdGF0aWMgaW50IGludGVsX2lvbW11X2FkZF9kZXZpY2Uo
dTggZGV2CiAgICAgICAgICAgICAgKiBTaW5jZSBSTVJScyBhcmUgYWx3YXlz
IHJlc2VydmVkIGluIHRoZSBlODIwIG1hcCBmb3IgdGhlIGhhcmR3YXJlCiAg
ICAgICAgICAgICAgKiBkb21haW4sIHRoZXJlIHNob3VsZG4ndCBiZSBhIGNv
bmZsaWN0LgogICAgICAgICAgICAgICovCi0gICAgICAgICAgICByZXQgPSBy
bXJyX2lkZW50aXR5X21hcHBpbmcocGRldi0+ZG9tYWluLCAxLCBybXJyLCAw
KTsKKyAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50aXR5X21hcHBpbmco
cGRldi0+ZG9tYWluLCBwMm1fYWNjZXNzX3J3LAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5iYXNlX2FkZHJlc3Ms
IHJtcnItPmVuZF9hZGRyZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAwKTsKICAgICAgICAgICAgIGlmICggcmV0ICkK
ICAgICAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIgVlREUFJFRklY
LCAiZCVkOiBSTVJSIG1hcHBpbmcgZmFpbGVkXG4iLAogICAgICAgICAgICAg
ICAgICAgICAgICAgcGRldi0+ZG9tYWluLT5kb21haW5faWQpOwpAQCAtMjEw
Nyw3ICsyMDMwLDggQEAgc3RhdGljIGludCBpbnRlbF9pb21tdV9yZW1vdmVf
ZGV2aWNlKHU4CiAgICAgICAgICAqIEFueSBmbGFnIGlzIG5vdGhpbmcgdG8g
Y2xlYXIgdGhlc2UgbWFwcGluZ3MgYnV0IGhlcmUKICAgICAgICAgICogaXRz
IGFsd2F5cyBzYWZlIGFuZCBzdHJpY3QgdG8gc2V0IDAuCiAgICAgICAgICAq
LwotICAgICAgICBybXJyX2lkZW50aXR5X21hcHBpbmcocGRldi0+ZG9tYWlu
LCAwLCBybXJyLCAwKTsKKyAgICAgICAgaW9tbXVfaWRlbnRpdHlfbWFwcGlu
ZyhwZGV2LT5kb21haW4sIHAybV9hY2Nlc3NfeCwgcm1yci0+YmFzZV9hZGRy
ZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnItPmVu
ZF9hZGRyZXNzLCAwKTsKICAgICB9CiAKICAgICByZXR1cm4gZG9tYWluX2Nv
bnRleHRfdW5tYXAocGRldi0+ZG9tYWluLCBkZXZmbiwgcGRldik7CkBAIC0y
MzA2LDcgKzIyMzAsOCBAQCBzdGF0aWMgdm9pZCBfX2h3ZG9tX2luaXQgc2V0
dXBfaHdkb21fcm1yCiAgICAgICAgICAqIGRvbWFpbiwgdGhlcmUgc2hvdWxk
bid0IGJlIGEgY29uZmxpY3QuIFNvIGl0cyBhbHdheXMgc2FmZSBhbmQKICAg
ICAgICAgICogc3RyaWN0IHRvIHNldCAwLgogICAgICAgICAgKi8KLSAgICAg
ICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKGQsIDEsIHJtcnIsIDAp
OworICAgICAgICByZXQgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKGQsIHAy
bV9hY2Nlc3NfcncsIHJtcnItPmJhc2VfYWRkcmVzcywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5lbmRfYWRkcmVzcywg
MCk7CiAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgIGRwcmludGso
WEVOTE9HX0VSUiBWVERQUkVGSVgsCiAgICAgICAgICAgICAgICAgICAgICAi
SU9NTVU6IG1hcHBpbmcgcmVzZXJ2ZWQgcmVnaW9uIGZhaWxlZFxuIik7CkBA
IC0yNDY1LDcgKzIzOTAsOSBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2Rldmlj
ZV9vd25lcnNoaXAoCiAgICAgICAgICAgICAgICAgICogQW55IFJNUlIgZmxh
ZyBpcyBhbHdheXMgaWdub3JlZCB3aGVuIHJlbW92ZSBhIGRldmljZSwKICAg
ICAgICAgICAgICAgICAgKiBidXQgaXRzIGFsd2F5cyBzYWZlIGFuZCBzdHJp
Y3QgdG8gc2V0IDAuCiAgICAgICAgICAgICAgICAgICovCi0gICAgICAgICAg
ICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKHNvdXJjZSwgMCwg
cm1yciwgMCk7CisgICAgICAgICAgICAgICAgcmV0ID0gaW9tbXVfaWRlbnRp
dHlfbWFwcGluZyhzb3VyY2UsIHAybV9hY2Nlc3NfeCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnItPmJhc2Vf
YWRkcmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJtcnItPmVuZF9hZGRyZXNzLCAwKTsKICAgICAgICAgICAg
ICAgICBpZiAoIHJldCAhPSAtRU5PRU5UICkKICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgIH0KQEAgLTI1NjIsNyArMjQ4
OSw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfYXNzaWduX2RldmljZSgK
ICAgICAgICAgICAgICBQQ0lfQlVTKGJkZikgPT0gYnVzICYmCiAgICAgICAg
ICAgICAgUENJX0RFVkZOMihiZGYpID09IGRldmZuICkKICAgICAgICAgewot
ICAgICAgICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKGQsIDEs
IHJtcnIsIGZsYWcpOworICAgICAgICAgICAgcmV0ID0gaW9tbXVfaWRlbnRp
dHlfbWFwcGluZyhkLCBwMm1fYWNjZXNzX3J3LCBybXJyLT5iYXNlX2FkZHJl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJtcnItPmVuZF9hZGRyZXNzLCBmbGFnKTsKICAgICAgICAgICAgIGlmICgg
cmV0ICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBpbnQgcmM7
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5jCisr
KyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5jCkBAIC0x
MjcsNyArMTI3LDcgQEAgaW50IGFyY2hfaW9tbXVfZG9tYWluX2luaXQoc3Ry
dWN0IGRvbWFpbgogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOwogCiAgICAgc3Bpbl9sb2NrX2luaXQoJmhkLT5hcmNoLm1h
cHBpbmdfbG9jayk7Ci0gICAgSU5JVF9MSVNUX0hFQUQoJmhkLT5hcmNoLm1h
cHBlZF9ybXJycyk7CisgICAgSU5JVF9MSVNUX0hFQUQoJmhkLT5hcmNoLmlk
ZW50aXR5X21hcHMpOwogCiAgICAgcmV0dXJuIDA7CiB9CkBAIC0xMzYsNiAr
MTM2LDk5IEBAIHZvaWQgYXJjaF9pb21tdV9kb21haW5fZGVzdHJveShzdHJ1
Y3QgZG8KIHsKIH0KIAorc3RydWN0IGlkZW50aXR5X21hcCB7CisgICAgc3Ry
dWN0IGxpc3RfaGVhZCBsaXN0OworICAgIHBhZGRyX3QgYmFzZSwgZW5kOwor
ICAgIHAybV9hY2Nlc3NfdCBhY2Nlc3M7CisgICAgdW5zaWduZWQgaW50IGNv
dW50OworfTsKKworaW50IGlvbW11X2lkZW50aXR5X21hcHBpbmcoc3RydWN0
IGRvbWFpbiAqZCwgcDJtX2FjY2Vzc190IHAybWEsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgZW5kLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWcpCit7
CisgICAgdW5zaWduZWQgbG9uZyBiYXNlX3BmbiA9IGJhc2UgPj4gUEFHRV9T
SElGVF80SzsKKyAgICB1bnNpZ25lZCBsb25nIGVuZF9wZm4gPSBQQUdFX0FM
SUdOXzRLKGVuZCkgPj4gUEFHRV9TSElGVF80SzsKKyAgICBzdHJ1Y3QgaWRl
bnRpdHlfbWFwICptYXA7CisgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQg
PSBkb21faW9tbXUoZCk7CisKKyAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQo
KSk7CisgICAgQVNTRVJUKGJhc2UgPCBlbmQpOworCisgICAgLyoKKyAgICAg
KiBObyBuZWVkIHRvIGFjcXVpcmUgaGQtPmFyY2gubWFwcGluZ19sb2NrOiBC
b3RoIGluc2VydGlvbiBhbmQgcmVtb3ZhbAorICAgICAqIGdldCBkb25lIHdo
aWxlIGhvbGRpbmcgcGNpZGV2c19sb2NrLgorICAgICAqLworICAgIGxpc3Rf
Zm9yX2VhY2hfZW50cnkoIG1hcCwgJmhkLT5hcmNoLmlkZW50aXR5X21hcHMs
IGxpc3QgKQorICAgIHsKKyAgICAgICAgaWYgKCBtYXAtPmJhc2UgPT0gYmFz
ZSAmJiBtYXAtPmVuZCA9PSBlbmQgKQorICAgICAgICB7CisgICAgICAgICAg
ICBpbnQgcmV0ID0gMDsKKworICAgICAgICAgICAgaWYgKCBwMm1hICE9IHAy
bV9hY2Nlc3NfeCApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAg
aWYgKCBtYXAtPmFjY2VzcyAhPSBwMm1hICkKKyAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIC1FQUREUklOVVNFOworICAgICAgICAgICAgICAgICsrbWFw
LT5jb3VudDsKKyAgICAgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAg
ICAgIH0KKworICAgICAgICAgICAgaWYgKCAtLW1hcC0+Y291bnQgKQorICAg
ICAgICAgICAgICAgIHJldHVybiAwOworCisgICAgICAgICAgICB3aGlsZSAo
IGJhc2VfcGZuIDwgZW5kX3BmbiApCisgICAgICAgICAgICB7CisgICAgICAg
ICAgICAgICAgaWYgKCBjbGVhcl9pZGVudGl0eV9wMm1fZW50cnkoZCwgYmFz
ZV9wZm4pICkKKyAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVOWElPOwor
ICAgICAgICAgICAgICAgIGJhc2VfcGZuKys7CisgICAgICAgICAgICB9CisK
KyAgICAgICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3QpOworICAgICAgICAg
ICAgeGZyZWUobWFwKTsKKworICAgICAgICAgICAgcmV0dXJuIHJldDsKKyAg
ICAgICAgfQorCisgICAgICAgIGlmICggZW5kID49IG1hcC0+YmFzZSAmJiBt
YXAtPmVuZCA+PSBiYXNlICkKKyAgICAgICAgICAgIHJldHVybiAtRUFERFJJ
TlVTRTsKKyAgICB9CisKKyAgICBpZiAoIHAybWEgPT0gcDJtX2FjY2Vzc194
ICkKKyAgICAgICAgcmV0dXJuIC1FTk9FTlQ7CisKKyAgICB3aGlsZSAoIGJh
c2VfcGZuIDwgZW5kX3BmbiApCisgICAgeworICAgICAgICBpbnQgZXJyID0g
c2V0X2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3BmbiwgcDJtYSwgZmxh
Zyk7CisKKyAgICAgICAgaWYgKCBlcnIgKQorICAgICAgICAgICAgcmV0dXJu
IGVycjsKKyAgICAgICAgYmFzZV9wZm4rKzsKKyAgICB9CisKKyAgICBtYXAg
PSB4bWFsbG9jKHN0cnVjdCBpZGVudGl0eV9tYXApOworICAgIGlmICggIW1h
cCApCisgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgIG1hcC0+YmFzZSA9
IGJhc2U7CisgICAgbWFwLT5lbmQgPSBlbmQ7CisgICAgbWFwLT5hY2Nlc3Mg
PSBwMm1hOworICAgIG1hcC0+Y291bnQgPSAxOworICAgIGxpc3RfYWRkX3Rh
aWwoJm1hcC0+bGlzdCwgJmhkLT5hcmNoLmlkZW50aXR5X21hcHMpOworCisg
ICAgcmV0dXJuIDA7Cit9CisKK3ZvaWQgaW9tbXVfaWRlbnRpdHlfbWFwX3Rl
YXJkb3duKHN0cnVjdCBkb21haW4gKmQpCit7CisgICAgc3RydWN0IGRvbWFp
bl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7CisgICAgc3RydWN0IGlkZW50
aXR5X21hcCAqbWFwLCAqdG1wOworCisgICAgbGlzdF9mb3JfZWFjaF9lbnRy
eV9zYWZlICggbWFwLCB0bXAsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBzLCBs
aXN0ICkKKyAgICB7CisgICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3QpOwor
ICAgICAgICB4ZnJlZShtYXApOworICAgIH0KK30KKwogc3RhdGljIGJvb2wg
X19od2RvbV9pbml0IGh3ZG9tX2lvbW11X21hcChjb25zdCBzdHJ1Y3QgZG9t
YWluICpkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBtYXhfcGZuKQot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11LmgKKysrIGIveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9pb21tdS5oCkBAIC0xNiw2ICsxNiw3IEBACiAKICNp
bmNsdWRlIDx4ZW4vZXJybm8uaD4KICNpbmNsdWRlIDx4ZW4vbGlzdC5oPgor
I2luY2x1ZGUgPHhlbi9tZW1fYWNjZXNzLmg+CiAjaW5jbHVkZSA8eGVuL3Nw
aW5sb2NrLmg+CiAjaW5jbHVkZSA8YXNtL2FwaWNkZWYuaD4KICNpbmNsdWRl
IDxhc20vcHJvY2Vzc29yLmg+CkBAIC00OSw3ICs1MCw3IEBAIHN0cnVjdCBh
cmNoX2lvbW11CiAgICAgc3BpbmxvY2tfdCBtYXBwaW5nX2xvY2s7ICAgICAg
ICAgICAgLyogaW8gcGFnZSB0YWJsZSBsb2NrICovCiAgICAgaW50IGFnYXc7
ICAgICAvKiBhZGp1c3RlZCBndWVzdCBhZGRyZXNzIHdpZHRoLCAwIGlzIGxl
dmVsIDIgMzAtYml0ICovCiAgICAgdTY0IGlvbW11X2JpdG1hcDsgICAgICAg
ICAgICAgIC8qIGJpdG1hcCBvZiBpb21tdShzKSB0aGF0IHRoZSBkb21haW4g
dXNlcyAqLwotICAgIHN0cnVjdCBsaXN0X2hlYWQgbWFwcGVkX3JtcnJzOwor
ICAgIHN0cnVjdCBsaXN0X2hlYWQgaWRlbnRpdHlfbWFwczsKIAogICAgIC8q
IGFtZCBpb21tdSBzdXBwb3J0ICovCiAgICAgaW50IHBhZ2luZ19tb2RlOwpA
QCAtMTEyLDYgKzExMywxMSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaW9tbXVf
ZGlzYWJsZV94MmFwaWMoCiAgICAgICAgIGlvbW11X29wcy5kaXNhYmxlX3gy
YXBpYygpOwogfQogCitpbnQgaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhzdHJ1
Y3QgZG9tYWluICpkLCBwMm1fYWNjZXNzX3QgcDJtYSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBlbmQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZyk7
Cit2b2lkIGlvbW11X2lkZW50aXR5X21hcF90ZWFyZG93bihzdHJ1Y3QgZG9t
YWluICpkKTsKKwogZXh0ZXJuIGJvb2wgdW50cnVzdGVkX21zaTsKIAogaW50
IHBpX3VwZGF0ZV9pcnRlKGNvbnN0IHN0cnVjdCBwaV9kZXNjICpwaV9kZXNj
LCBjb25zdCBzdHJ1Y3QgcGlycSAqcGlycSwKLS0tIGEveGVuL2luY2x1ZGUv
YXNtLXg4Ni9wMm0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5o
CkBAIC05MDUsNiArOTA1LDM0IEBAIHN0cnVjdCBwMm1fZG9tYWluICpwMm1f
Z2V0X2FsdHAybShzdHJ1Y3QKIHN0YXRpYyBpbmxpbmUgdm9pZCBwMm1fYWx0
cDJtX2NoZWNrKHN0cnVjdCB2Y3B1ICp2LCB1aW50MTZfdCBpZHgpIHt9CiAj
ZW5kaWYKIAorLyogcDJtIGFjY2VzcyB0byBJT01NVSBmbGFncyAqLworc3Rh
dGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJtX2FjY2Vzc190b19pb21tdV9m
bGFncyhwMm1fYWNjZXNzX3QgcDJtYSkKK3sKKyAgICBzd2l0Y2ggKCBwMm1h
ICkKKyAgICB7CisgICAgY2FzZSBwMm1fYWNjZXNzX3J3OgorICAgIGNhc2Ug
cDJtX2FjY2Vzc19yd3g6CisgICAgICAgIHJldHVybiBJT01NVUZfcmVhZGFi
bGUgfCBJT01NVUZfd3JpdGFibGU7CisKKyAgICBjYXNlIHAybV9hY2Nlc3Nf
cjoKKyAgICBjYXNlIHAybV9hY2Nlc3Nfcng6CisgICAgY2FzZSBwMm1fYWNj
ZXNzX3J4MnJ3OgorICAgICAgICByZXR1cm4gSU9NTVVGX3JlYWRhYmxlOwor
CisgICAgY2FzZSBwMm1fYWNjZXNzX3c6CisgICAgY2FzZSBwMm1fYWNjZXNz
X3d4OgorICAgICAgICByZXR1cm4gSU9NTVVGX3dyaXRhYmxlOworCisgICAg
Y2FzZSBwMm1fYWNjZXNzX246CisgICAgY2FzZSBwMm1fYWNjZXNzX3g6Cisg
ICAgY2FzZSBwMm1fYWNjZXNzX24ycnd4OgorICAgICAgICByZXR1cm4gMDsK
KyAgICB9CisKKyAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICByZXR1
cm4gMDsKK30KKwogLyoKICAqIHAybSB0eXBlIHRvIElPTU1VIGZsYWdzCiAg
Ki8KQEAgLTkyNiw5ICs5NTQsMTAgQEAgc3RhdGljIGlubGluZSB1bnNpZ25l
ZCBpbnQgcDJtX2dldF9pb21tdQogICAgICAgICBmbGFncyA9IElPTU1VRl9y
ZWFkYWJsZTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSBwMm1fbW1pb19k
aXJlY3Q6Ci0gICAgICAgIGZsYWdzID0gSU9NTVVGX3JlYWRhYmxlOwotICAg
ICAgICBpZiAoICFyYW5nZXNldF9jb250YWluc19zaW5nbGV0b24obW1pb19y
b19yYW5nZXMsIG1mbl94KG1mbikpICkKLSAgICAgICAgICAgIGZsYWdzIHw9
IElPTU1VRl93cml0YWJsZTsKKyAgICAgICAgZmxhZ3MgPSBwMm1fYWNjZXNz
X3RvX2lvbW11X2ZsYWdzKHAybWEpOworICAgICAgICBpZiAoIChmbGFncyAm
IElPTU1VRl93cml0YWJsZSkgJiYKKyAgICAgICAgICAgICByYW5nZXNldF9j
b250YWluc19zaW5nbGV0b24obW1pb19yb19yYW5nZXMsIG1mbl94KG1mbikp
ICkKKyAgICAgICAgICAgIGZsYWdzICY9IH5JT01NVUZfd3JpdGFibGU7CiAg
ICAgICAgIGJyZWFrOwogICAgIGRlZmF1bHQ6CiAgICAgICAgIGZsYWdzID0g
MDsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-5.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UvY29tcGxldGUgcmUtYXNzaWdubWVu
dCBoYW5kbGluZwoKUHJpb3IgdG8gdGhlIGFzc2lnbm1lbnQgc3RlcCBoYXZp
bmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgZGV2aWNlcwpzaG91bGQgbm90
IGdldCBhc3NvY2lhdGVkIHdpdGggdGhlaXIgbmV3IG93bmVyLiBIYW5kIHRo
ZSBkZXZpY2UgdG8gRG9tSU8KKHBlcmhhcHMgdGVtcG9yYXJpbHkpLCB1bnRp
bCBhZnRlciB0aGUgZGUtYXNzaWdubWVudCBzdGVwIGhhcyBjb21wbGV0ZWQu
CgpEZS1hc3NpZ25tZW50IG9mIGEgZGV2aWNlIChmcm9tIG90aGVyIHRoYW4g
RG9tMCkgYXMgd2VsbCBhcyBmYWlsdXJlIG9mCnJlYXNzaWduX2RldmljZSgp
IGR1cmluZyBhc3NpZ25tZW50IHNob3VsZCByZXN1bHQgaW4gdW5pdHkgbWFw
cGluZ3MKZ2V0dGluZyB0b3JuIGRvd24uIFRoaXMgaW4gdHVybiByZXF1aXJl
cyBzd2l0Y2hpbmcgdG8gYSByZWZjb3VudGVkCm1hcHBpbmcgYXBwcm9hY2gs
IGFzIHdhcyBhbHJlYWR5IHVzZWQgYnkgVlQtZCBmb3IgaXRzIFJNUlJzLCB0
byBwcmV2ZW50CnVubWFwcGluZyBhIHJlZ2lvbiB1c2VkIGJ5IG11bHRpcGxl
IGRldmljZXMuCgpUaGlzIGlzIENWRS0yMDIxLTI4Njk2IC8gcGFydCBvZiBY
U0EtMzc4LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfbWFwLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X21hcC5jCkBAIC00MzAsMzggKzQzMCw0OSBAQCBpbnQgYW1kX2lvbW11
X2ZsdXNoX2lvdGxiX2FsbChzdHJ1Y3QgZG9tCiAgICAgcmV0dXJuIDA7CiB9
CiAKLWludCBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKHN0
cnVjdCBkb21haW4gKmRvbWFpbiwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZGRyX3QgcGh5c19hZGRyLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBz
aXplLCBpbnQgaXcsIGludCBpcikKK2ludCBhbWRfaW9tbXVfcmVzZXJ2ZV9k
b21haW5fdW5pdHlfbWFwKHN0cnVjdCBkb21haW4gKmQsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaXZy
c191bml0eV9tYXAgKm1hcCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFnKQogewotICAgIHVuc2ln
bmVkIGxvbmcgbnBhZ2VzLCBpOwotICAgIHVuc2lnbmVkIGxvbmcgZ2ZuOwot
ICAgIHVuc2lnbmVkIGludCBmbGFncyA9ICEhaXI7Ci0gICAgdW5zaWduZWQg
aW50IGZsdXNoX2ZsYWdzID0gMDsKLSAgICBpbnQgcnQgPSAwOwotCi0gICAg
aWYgKCBpdyApCi0gICAgICAgIGZsYWdzIHw9IElPTU1VRl93cml0YWJsZTsK
LQotICAgIG5wYWdlcyA9IHJlZ2lvbl90b19wYWdlcyhwaHlzX2FkZHIsIHNp
emUpOwotICAgIGdmbiA9IHBoeXNfYWRkciA+PiBQQUdFX1NISUZUOwotICAg
IGZvciAoIGkgPSAwOyBpIDwgbnBhZ2VzOyBpKysgKQorICAgIGludCByYzsK
KworICAgIGlmICggZCA9PSBkb21faW8gKQorICAgICAgICByZXR1cm4gMDsK
KworICAgIGZvciAoIHJjID0gMDsgIXJjICYmIG1hcDsgbWFwID0gbWFwLT5u
ZXh0ICkKICAgICB7Ci0gICAgICAgIHVuc2lnbmVkIGxvbmcgZnJhbWUgPSBn
Zm4gKyBpOworICAgICAgICBwMm1fYWNjZXNzX3QgcDJtYSA9IHAybV9hY2Nl
c3NfbjsKKworICAgICAgICBpZiAoIG1hcC0+cmVhZCApCisgICAgICAgICAg
ICBwMm1hIHw9IHAybV9hY2Nlc3NfcjsKKyAgICAgICAgaWYgKCBtYXAtPndy
aXRlICkKKyAgICAgICAgICAgIHAybWEgfD0gcDJtX2FjY2Vzc193OwogCi0g
ICAgICAgIHJ0ID0gYW1kX2lvbW11X21hcF9wYWdlKGRvbWFpbiwgX2Rmbihm
cmFtZSksIF9tZm4oZnJhbWUpLCBmbGFncywKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJmZsdXNoX2ZsYWdzKTsKLSAgICAgICAgaWYgKCBy
dCAhPSAwICkKLSAgICAgICAgICAgIGJyZWFrOworICAgICAgICByYyA9IGlv
bW11X2lkZW50aXR5X21hcHBpbmcoZCwgcDJtYSwgbWFwLT5hZGRyLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLT5hZGRyICsg
bWFwLT5sZW5ndGggLSAxLCBmbGFnKTsKICAgICB9CiAKLSAgICAvKiBVc2Ug
d2hpbGUtYnJlYWsgdG8gYXZvaWQgY29tcGlsZXIgd2FybmluZyAqLwotICAg
IHdoaWxlICggZmx1c2hfZmxhZ3MgJiYKLSAgICAgICAgICAgIGFtZF9pb21t
dV9mbHVzaF9pb3RsYl9wYWdlcyhkb21haW4sIF9kZm4oZ2ZuKSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucGFnZXMsIGZs
dXNoX2ZsYWdzKSApCi0gICAgICAgIGJyZWFrOworICAgIHJldHVybiByYzsK
K30KKworaW50IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV91bm1h
cChzdHJ1Y3QgZG9tYWluICpkLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaXZyc191bml0eV9tYXAg
Km1hcCkKK3sKKyAgICBpbnQgcmM7CisKKyAgICBpZiAoIGQgPT0gZG9tX2lv
ICkKKyAgICAgICAgcmV0dXJuIDA7CisKKyAgICBmb3IgKCByYyA9IDA7IG1h
cDsgbWFwID0gbWFwLT5uZXh0ICkKKyAgICB7CisgICAgICAgIGludCByZXQg
PSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKGQsIHAybV9hY2Nlc3NfeCwgbWFw
LT5hZGRyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBtYXAtPmFkZHIgKyBtYXAtPmxlbmd0aCAtIDEsIDApOworCisgICAg
ICAgIGlmICggcmV0ICYmIHJldCAhPSAtRU5PRU5UICYmICFyYyApCisgICAg
ICAgICAgICByYyA9IHJldDsKKyAgICB9CiAKLSAgICByZXR1cm4gcnQ7Cisg
ICAgcmV0dXJuIHJjOwogfQogCiBpbnQgX19pbml0IGFtZF9pb21tdV9xdWFy
YW50aW5lX2luaXQoc3RydWN0IGRvbWFpbiAqZCkKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0z
MzAsNiArMzMwLDcgQEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3Ry
dWN0IGRvbWFpbgogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAg
IGludCBiZGYsIHJjOwogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKnQgPSBk
b21faW9tbXUodGFyZ2V0KTsKKyAgICBjb25zdCBzdHJ1Y3QgaXZyc19tYXBw
aW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBpbmdzKHBkZXYt
PnNlZyk7CiAKICAgICBiZGYgPSBQQ0lfQkRGMihwZGV2LT5idXMsIHBkZXYt
PmRldmZuKTsKICAgICBpb21tdSA9IGZpbmRfaW9tbXVfZm9yX2RldmljZShw
ZGV2LT5zZWcsIGJkZik7CkBAIC0zNDQsMTAgKzM0NSwyNCBAQCBzdGF0aWMg
aW50IHJlYXNzaWduX2RldmljZShzdHJ1Y3QgZG9tYWluCiAKICAgICBhbWRf
aW9tbXVfZGlzYWJsZV9kb21haW5fZGV2aWNlKHNvdXJjZSwgaW9tbXUsIGRl
dmZuLCBwZGV2KTsKIAotICAgIGlmICggZGV2Zm4gPT0gcGRldi0+ZGV2Zm4g
KQorICAgIC8qCisgICAgICogSWYgdGhlIGRldmljZSBiZWxvbmdzIHRvIHRo
ZSBoYXJkd2FyZSBkb21haW4sIGFuZCBpdCBoYXMgYSB1bml0eSBtYXBwaW5n
LAorICAgICAqIGRvbid0IHJlbW92ZSBpdCBmcm9tIHRoZSBoYXJkd2FyZSBk
b21haW4sIGJlY2F1c2UgQklPUyBtYXkgcmVmZXJlbmNlIHRoYXQKKyAgICAg
KiBtYXBwaW5nLgorICAgICAqLworICAgIGlmICggIWlzX2hhcmR3YXJlX2Rv
bWFpbihzb3VyY2UpICkKKyAgICB7CisgICAgICAgIHJjID0gYW1kX2lvbW11
X3Jlc2VydmVfZG9tYWluX3VuaXR5X3VubWFwKAorICAgICAgICAgICAgICAg
ICBzb3VyY2UsCisgICAgICAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbZ2V0
X2RtYV9yZXF1ZXN0b3JfaWQocGRldi0+c2VnLCBiZGYpXS51bml0eV9tYXAp
OworICAgICAgICBpZiAoIHJjICkKKyAgICAgICAgICAgIHJldHVybiByYzsK
KyAgICB9CisKKyAgICBpZiAoIGRldmZuID09IHBkZXYtPmRldmZuICYmIHBk
ZXYtPmRvbWFpbiAhPSBkb21faW8gKQogICAgIHsKLSAgICAgICAgbGlzdF9t
b3ZlKCZwZGV2LT5kb21haW5fbGlzdCwgJnRhcmdldC0+cGRldl9saXN0KTsK
LSAgICAgICAgcGRldi0+ZG9tYWluID0gdGFyZ2V0OworICAgICAgICBsaXN0
X21vdmUoJnBkZXYtPmRvbWFpbl9saXN0LCAmZG9tX2lvLT5wZGV2X2xpc3Qp
OworICAgICAgICBwZGV2LT5kb21haW4gPSBkb21faW87CiAgICAgfQogCiAg
ICAgcmMgPSBhbGxvY2F0ZV9kb21haW5fcmVzb3VyY2VzKHQpOwpAQCAtMzU5
LDYgKzM3NCwxMiBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2RldmljZShzdHJ1
Y3QgZG9tYWluCiAgICAgICAgICAgICAgICAgICAgIHBkZXYtPnNlZywgcGRl
di0+YnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKICAg
ICAgICAgICAgICAgICAgICAgc291cmNlLT5kb21haW5faWQsIHRhcmdldC0+
ZG9tYWluX2lkKTsKIAorICAgIGlmICggZGV2Zm4gPT0gcGRldi0+ZGV2Zm4g
JiYgcGRldi0+ZG9tYWluICE9IHRhcmdldCApCisgICAgeworICAgICAgICBs
aXN0X21vdmUoJnBkZXYtPmRvbWFpbl9saXN0LCAmdGFyZ2V0LT5wZGV2X2xp
c3QpOworICAgICAgICBwZGV2LT5kb21haW4gPSB0YXJnZXQ7CisgICAgfQor
CiAgICAgcmV0dXJuIDA7CiB9CiAKQEAgLTM2OSwyMCArMzkwLDI4IEBAIHN0
YXRpYyBpbnQgYW1kX2lvbW11X2Fzc2lnbl9kZXZpY2Uoc3RydWMKICAgICBz
dHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJz
X21hcHBpbmdzKHBkZXYtPnNlZyk7CiAgICAgaW50IGJkZiA9IFBDSV9CREYy
KHBkZXYtPmJ1cywgZGV2Zm4pOwogICAgIGludCByZXFfaWQgPSBnZXRfZG1h
X3JlcXVlc3Rvcl9pZChwZGV2LT5zZWcsIGJkZik7Ci0gICAgY29uc3Qgc3Ry
dWN0IGl2cnNfdW5pdHlfbWFwICp1bml0eV9tYXA7CisgICAgaW50IHJjID0g
YW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAgICAg
ICAgICAgICAgZCwgaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21hcCwg
ZmxhZyk7CisKKyAgICBpZiAoICFyYyApCisgICAgICAgIHJjID0gcmVhc3Np
Z25fZGV2aWNlKHBkZXYtPmRvbWFpbiwgZCwgZGV2Zm4sIHBkZXYpOwogCi0g
ICAgZm9yICggdW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVu
aXR5X21hcDsgdW5pdHlfbWFwOwotICAgICAgICAgIHVuaXR5X21hcCA9IHVu
aXR5X21hcC0+bmV4dCApCisgICAgaWYgKCByYyAmJiAhaXNfaGFyZHdhcmVf
ZG9tYWluKGQpICkKICAgICB7Ci0gICAgICAgIGludCByYyA9IGFtZF9pb21t
dV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoCi0gICAgICAgICAgICAgICAg
ICAgICBkLCB1bml0eV9tYXAtPmFkZHIsIHVuaXR5X21hcC0+bGVuZ3RoLAot
ICAgICAgICAgICAgICAgICAgICAgdW5pdHlfbWFwLT53cml0ZSwgdW5pdHlf
bWFwLT5yZWFkKTsKKyAgICAgICAgaW50IHJldCA9IGFtZF9pb21tdV9yZXNl
cnZlX2RvbWFpbl91bml0eV91bm1hcCgKKyAgICAgICAgICAgICAgICAgICAg
ICBkLCBpdnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwKTsKIAotICAg
ICAgICBpZiAoIHJjICkKLSAgICAgICAgICAgIHJldHVybiByYzsKKyAgICAg
ICAgaWYgKCByZXQgKQorICAgICAgICB7CisgICAgICAgICAgICBwcmludGso
WEVOTE9HX0VSUiAiQU1ELVZpOiAiCisgICAgICAgICAgICAgICAgICAgInVu
aXR5LXVubWFwIGZvciAlcGQvJTA0eDolMDJ4OiUwMnguJXUgZmFpbGVkICgl
ZClcbiIsCisgICAgICAgICAgICAgICAgICAgZCwgcGRldi0+c2VnLCBwZGV2
LT5idXMsCisgICAgICAgICAgICAgICAgICAgUENJX1NMT1QoZGV2Zm4pLCBQ
Q0lfRlVOQyhkZXZmbiksIHJldCk7CisgICAgICAgICAgICBkb21haW5fY3Jh
c2goZCk7CisgICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1cm4gcmVhc3Np
Z25fZGV2aWNlKHBkZXYtPmRvbWFpbiwgZCwgZGV2Zm4sIHBkZXYpOworICAg
IHJldHVybiByYzsKIH0KIAogc3RhdGljIHZvaWQgZGVhbGxvY2F0ZV9uZXh0
X3BhZ2VfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGcsIGludCBsZXZlbCkK
QEAgLTQ0MSw2ICs0NzAsNyBAQCBzdGF0aWMgdm9pZCBkZWFsbG9jYXRlX2lv
bW11X3BhZ2VfdGFibGVzCiAKIHN0YXRpYyB2b2lkIGFtZF9pb21tdV9kb21h
aW5fZGVzdHJveShzdHJ1Y3QgZG9tYWluICpkKQogeworICAgIGlvbW11X2lk
ZW50aXR5X21hcF90ZWFyZG93bihkKTsKICAgICBkZWFsbG9jYXRlX2lvbW11
X3BhZ2VfdGFibGVzKGQpOwogICAgIGFtZF9pb21tdV9mbHVzaF9hbGxfcGFn
ZXMoZCk7CiB9Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9h
bWQtaW9tbXUtcHJvdG8uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2h2
bS9zdm0vYW1kLWlvbW11LXByb3RvLmgKQEAgLTY0LDggKzY0LDEwIEBAIGlu
dCBfX211c3RfY2hlY2sgYW1kX2lvbW11X3VubWFwX3BhZ2Uoc3QKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
ICpmbHVzaF9mbGFncyk7CiBpbnQgX19tdXN0X2NoZWNrIGFtZF9pb21tdV9h
bGxvY19yb290KHN0cnVjdCBkb21haW5faW9tbXUgKmhkKTsKIGludCBhbWRf
aW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKHN0cnVjdCBkb21haW4g
KmRvbWFpbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHBhZGRyX3QgcGh5c19hZGRyLCB1bnNpZ25lZCBsb25nIHNpemUsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaXcs
IGludCBpcik7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBzdHJ1Y3QgaXZyc191bml0eV9tYXAgKm1hcCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBmbGFnKTsKK2ludCBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlf
dW5tYXAoc3RydWN0IGRvbWFpbiAqZCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGl2cnNfdW5pdHlf
bWFwICptYXApOwogaW50IF9fbXVzdF9jaGVjayBhbWRfaW9tbXVfZmx1c2hf
aW90bGJfcGFnZXMoc3RydWN0IGRvbWFpbiAqZCwgZGZuX3QgZGZuLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5z
aWduZWQgaW50IHBhZ2VfY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmx1c2hfZmxh
Z3MpOwo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-6.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-6.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UgZXhjbHVzaW9uIHJhbmdlIGFuZCB1
bml0eSBtYXAgcmVjb3JkaW5nCgpUaGUgc3BlYyBtYWtlcyBubyBwcm92aXNp
b25zIGZvciBPUyBiZWhhdmlvciBoZXJlIHRvIGRlcGVuZCBvbiB0aGUKYW1v
dW50IG9mIFJBTSBmb3VuZCBvbiB0aGUgc3lzdGVtLiBXaGlsZSB0aGUgc3Bl
YyBtYXkgbm90IHN1ZmZpY2llbnRseQpjbGVhcmx5IGRpc3Rpbmd1aXNoIGJv
dGgga2luZHMgb2YgcmVnaW9ucywgdGhleSBhcmUgc3VyZWx5IG1lYW50IHRv
IGJlCnNlcGFyYXRlIHRoaW5nczogT25seSByZWdpb25zIHdpdGggQUNQSV9J
Vk1EX0VYQ0xVU0lPTl9SQU5HRSBzZXQgc2hvdWxkCmJlIGNhbmRpZGF0ZXMg
Zm9yIHB1dHRpbmcgaW4gdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3RlcnMu
IChBcyB0aGVyZSdzCm9ubHkgYSBzaW5nbGUgc3VjaCBwYWlyIG9mIHJlZ2lz
dGVycyBwZXIgSU9NTVUsIHNlY29uZGFyeSBub24tYWRqYWNlbnQKcmVnaW9u
cyB3aXRoIHRoZSBmbGFnIHNldCBhbHJlYWR5IGdldCBjb252ZXJ0ZWQgdG8g
dW5pdHkgbWFwcGVkCnJlZ2lvbnMuKQoKRmlyc3Qgb2YgYWxsLCBkcm9wIHRo
ZSBkZXBlbmRlbmN5IG9uIG1heF9wYWdlLiBXaXRoIGNvbW1pdCBiNGYwNDIy
MzZhZTAKKCJBTUQvSU9NTVU6IENlYXNlIHVzaW5nIGEgZHluYW1pYyBoZWln
aHQgZm9yIHRoZSBJT01NVSBwYWdldGFibGVzIikgdGhlCnVzZSBvZiBpdCBo
ZXJlIHdhcyBzdGFsZSBhbnl3YXk7IGl0IHdhcyBib2d1cyBhbHJlYWR5IGJl
Zm9yZSwgYXMgaXQKZGlkbid0IGFjY291bnQgZm9yIG1heF9wYWdlIGdldHRp
bmcgaW5jcmVhc2VkIGxhdGVyIG9uLiBTaW1wbHkgdHJ5IGFuCmV4Y2x1c2lv
biByYW5nZSByZWdpc3RyYXRpb24gZmlyc3QsIGFuZCBpZiBpdCBmYWlscyAo
Zm9yIGJlaW5nCnVuc3VpdGFibGUgb3Igbm9uLW1lcmdlYWJsZSksIHJlZ2lz
dGVyIGEgdW5pdHkgbWFwcGluZyByYW5nZS4KCldpdGggdGhpcyB2YXJpb3Vz
IGxvY2FsIHZhcmlhYmxlcyBiZWNvbWUgdW5uZWNlc3NhcnkgYW5kIGhlbmNl
IGdldApkcm9wcGVkIGF0IHRoZSBzYW1lIHRpbWUuCgpXaXRoIHRoZSBtYXhf
cGFnZSBib3VuZGFyeSBkcm9wcGVkIGZvciB1c2luZyB1bml0eSBtYXBzLCB0
aGUgbWluaW11bQpwYWdlIHRhYmxlIHRyZWUgaGVpZ2h0IG5vdyBuZWVkcyBi
b3RoIHJlY29yZGluZyBhbmQgZW5mb3JjaW5nIGluCmFtZF9pb21tdV9kb21h
aW5faW5pdCgpLiBTaW5jZSB3ZSBjYW4ndCBwcmVkaWN0IHdoaWNoIGRldmlj
ZXMgbWF5IGdldAphc3NpZ25lZCB0byBhIGRvbWFpbiwgb3VyIG9ubHkgb3B0
aW9uIGlzIHRvIHVuaWZvcm1seSBmb3JjZSBhdCBsZWFzdAp0aGF0IGhlaWdo
dCBmb3IgYWxsIGRvbWFpbnMsIG5vdyB0aGF0IHRoZSBoZWlnaHQgaXNuJ3Qg
ZHluYW1pYyBhbnltb3JlLgoKRnVydGhlciBkb24ndCBtYWtlIHVzZSBvZiB0
aGUgZXhjbHVzaW9uIHJhbmdlIHVubGVzcyBBQ1BJIGRhdGEgc2F5cyBzby4K
Ck5vdGUgdGhhdCBleGNsdXNpb24gcmFuZ2UgcmVnaXN0cmF0aW9uIGluCnJl
Z2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygpIGlzIG9uIGEgYmVzdCBl
ZmZvcnQgYmFzaXMuIEhlbmNlIHVuaXR5Cm1hcCBlbnRyaWVzIGFsc28gcmVn
aXN0ZXJlZCBhcmUgcmVkdW5kYW50IHdoZW4gdGhlIGZvcm1lciBzdWNjZWVk
ZWQsIGJ1dAp0aGV5IGFsc28gZG8gbm8gaGFybS4gSW1wcm92ZW1lbnRzIGlu
IHRoaXMgYXJlYSBjYW4gYmUgZG9uZSBsYXRlciBpbW8uCgpBbHNvIGFkanVz
dCB0eXBlcyB3aGVyZSBzdWl0YWJsZSB3aXRob3V0IHRvdWNoaW5nIGV4dHJh
IGxpbmVzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zNzguCgpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBQYXVsIER1cnJhbnQgPHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtMTE4
LDEyICsxMTgsOCBAQCBzdGF0aWMgc3RydWN0IGFtZF9pb21tdSAqIF9faW5p
dCBmaW5kX2lvCiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHJlc2VydmVfaW9t
bXVfZXhjbHVzaW9uX3JhbmdlKAotICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11LCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBsaW1pdCwKLSAgICBib29s
IGFsbCwgYm9vbCBpdywgYm9vbCBpcikKKyAgICBzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdSwgcGFkZHJfdCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGFs
bCkKIHsKLSAgICBpZiAoICFpciB8fCAhaXcgKQotICAgICAgICByZXR1cm4g
LUVQRVJNOwotCiAgICAgLyogbmVlZCB0byBleHRlbmQgZXhjbHVzaW9uIHJh
bmdlPyAqLwogICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9lbmFibGUgKQog
ICAgIHsKQEAgLTE1MiwxNCArMTQ4LDE4IEBAIHN0YXRpYyBpbnQgX19pbml0
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl8KIHsKICAgICBzdHJ1Y3QgaXZyc19t
YXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJzX21hcHBpbmdzKHNl
Zyk7CiAgICAgc3RydWN0IGl2cnNfdW5pdHlfbWFwICp1bml0eV9tYXAgPSBp
dnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwOworICAgIGludCBwYWdpbmdf
bW9kZSA9IGFtZF9pb21tdV9nZXRfcGFnaW5nX21vZGUoUEZOX1VQKGJhc2Ug
KyBsZW5ndGgpKTsKKworICAgIGlmICggcGFnaW5nX21vZGUgPCAwICkKKyAg
ICAgICAgcmV0dXJuIHBhZ2luZ19tb2RlOwogCiAgICAgLyogQ2hlY2sgZm9y
IG92ZXJsYXBzLiAqLwogICAgIGZvciAoIDsgdW5pdHlfbWFwOyB1bml0eV9t
YXAgPSB1bml0eV9tYXAtPm5leHQgKQogICAgIHsKICAgICAgICAgLyoKICAg
ICAgICAgICogRXhhY3QgbWF0Y2hlcyBhcmUgb2theS4gVGhpcyBjYW4gaW4g
cGFydGljdWxhciBoYXBwZW4gd2hlbgotICAgICAgICAgKiByZWdpc3Rlcl9l
eGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZSgpIGNhbGxzIGhlcmUgdHdpY2Ug
Zm9yIHRoZQotICAgICAgICAgKiBzYW1lIChzLGIsZCxmKS4KKyAgICAgICAg
ICogcmVnaXN0ZXJfcmFuZ2VfZm9yX2RldmljZSgpIGNhbGxzIGhlcmUgdHdp
Y2UgZm9yIHRoZSBzYW1lCisgICAgICAgICAqIChzLGIsZCxmKS4KICAgICAg
ICAgICovCiAgICAgICAgIGlmICggYmFzZSA9PSB1bml0eV9tYXAtPmFkZHIg
JiYgbGVuZ3RoID09IHVuaXR5X21hcC0+bGVuZ3RoICYmCiAgICAgICAgICAg
ICAgaXIgPT0gdW5pdHlfbWFwLT5yZWFkICYmIGl3ID09IHVuaXR5X21hcC0+
d3JpdGUgKQpAQCAtMTg3LDU1ICsxODcsNTIgQEAgc3RhdGljIGludCBfX2lu
aXQgcmVzZXJ2ZV91bml0eV9tYXBfZm9yXwogICAgIHVuaXR5X21hcC0+bmV4
dCA9IGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9tYXA7CiAgICAgaXZyc19t
YXBwaW5nc1tiZGZdLnVuaXR5X21hcCA9IHVuaXR5X21hcDsKIAorICAgIGlm
ICggcGFnaW5nX21vZGUgPiBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2RlICkK
KyAgICAgICAgYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZSA9IHBhZ2luZ19t
b2RlOworCiAgICAgcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0
IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfYWxsX2RldmljZXMoCi0g
ICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25nIGxpbWl0LCB1
OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9yYW5n
ZV9mb3JfYWxsX2RldmljZXMoCisgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90
IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikKIHsK
ICAgICBpbnQgc2VnID0gMDsgLyogWFhYICovCi0gICAgdW5zaWduZWQgbG9u
ZyByYW5nZV90b3AsIGlvbW11X3RvcCwgbGVuZ3RoOwogICAgIHN0cnVjdCBh
bWRfaW9tbXUgKmlvbW11OwotICAgIHVuc2lnbmVkIGludCBiZGY7CiAgICAg
aW50IHJjID0gMDsKIAogICAgIC8qIGlzIHBhcnQgb2YgZXhjbHVzaW9uIHJh
bmdlIGluc2lkZSBvZiBJT01NVSB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2U/ICov
CiAgICAgLyogbm90ZTogJ2xpbWl0JyBwYXJhbWV0ZXIgaXMgYXNzdW1lZCB0
byBiZSBwYWdlLWFsaWduZWQgKi8KLSAgICByYW5nZV90b3AgPSBsaW1pdCAr
IFBBR0VfU0laRTsKLSAgICBpb21tdV90b3AgPSBtYXhfcGFnZSAqIFBBR0Vf
U0laRTsKLSAgICBpZiAoIGJhc2UgPCBpb21tdV90b3AgKQotICAgIHsKLSAg
ICAgICAgaWYgKCByYW5nZV90b3AgPiBpb21tdV90b3AgKQotICAgICAgICAg
ICAgcmFuZ2VfdG9wID0gaW9tbXVfdG9wOwotICAgICAgICBsZW5ndGggPSBy
YW5nZV90b3AgLSBiYXNlOwotICAgICAgICAvKiByZXNlcnZlIHIvdyB1bml0
eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCi0gICAgICAg
IC8qIG5vdGU6IHRoZXNlIGVudHJpZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1
c2lvbiByYW5nZSAqLwotICAgICAgICBmb3IgKCBiZGYgPSAwOyAhcmMgJiYg
YmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysgKQotICAgICAgICAgICAg
cmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywgYmRmLCBi
YXNlLCBsZW5ndGgsIGl3LCBpcik7Ci0gICAgICAgIC8qIHB1c2ggJ2Jhc2Un
IGp1c3Qgb3V0c2lkZSBvZiB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2UgKi8KLSAg
ICAgICAgYmFzZSA9IGlvbW11X3RvcDsKLSAgICB9Ci0gICAgLyogcmVnaXN0
ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzICovCi0gICAgaWYg
KCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICkKKyAgICBpZiAoIGV4Y2x1
c2lvbiApCiAgICAgewogICAgICAgICBmb3JfZWFjaF9hbWRfaW9tbXUoIGlv
bW11ICkKICAgICAgICAgewotICAgICAgICAgICAgcmMgPSByZXNlcnZlX2lv
bW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRy
dWUgLyogYWxsICovLCBpdywgaXIpOwotICAgICAgICAgICAgaWYgKCByYyAp
Ci0gICAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICBpbnQgcmV0
ID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2Us
IGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHRydWUgLyogYWxsICovKTsKKworICAgICAgICAg
ICAgaWYgKCByZXQgJiYgIXJjICkKKyAgICAgICAgICAgICAgICByYyA9IHJl
dDsKICAgICAgICAgfQogICAgIH0KIAorICAgIGlmICggIWV4Y2x1c2lvbiB8
fCByYyApCisgICAgeworICAgICAgICBwYWRkcl90IGxlbmd0aCA9IGxpbWl0
ICsgUEFHRV9TSVpFIC0gYmFzZTsKKyAgICAgICAgdW5zaWduZWQgaW50IGJk
ZjsKKworICAgICAgICAvKiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFn
ZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCisgICAgICAgIGZvciAoIGJkZiA9
IHJjID0gMDsgIXJjICYmIGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisr
ICkKKyAgICAgICAgICAgIHJjID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2Rl
dmljZShzZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOworICAgIH0K
KwogICAgIHJldHVybiByYzsKIH0KIAotc3RhdGljIGludCBfX2luaXQgcmVn
aXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoCi0gICAgdTE2IGJk
ZiwgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25nIGxpbWl0LCB1
OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9yYW5n
ZV9mb3JfZGV2aWNlKAorICAgIHVuc2lnbmVkIGludCBiZGYsIHBhZGRyX3Qg
YmFzZSwgcGFkZHJfdCBsaW1pdCwKKyAgICBib29sIGl3LCBib29sIGlyLCBi
b29sIGV4Y2x1c2lvbikKIHsKICAgICBpbnQgc2VnID0gMDsgLyogWFhYICov
CiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBn
ZXRfaXZyc19tYXBwaW5ncyhzZWcpOwotICAgIHVuc2lnbmVkIGxvbmcgcmFu
Z2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lv
bW11ICppb21tdTsKICAgICB1MTYgcmVxOwogICAgIGludCByYyA9IDA7CkBA
IC0yNDksMjcgKzI0NiwxOSBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rl
cl9leGNsdXNpb25fcmFuCiAgICAgcmVxID0gaXZyc19tYXBwaW5nc1tiZGZd
LmR0ZV9yZXF1ZXN0b3JfaWQ7CiAKICAgICAvKiBub3RlOiAnbGltaXQnIHBh
cmFtZXRlciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2UtYWxpZ25lZCAqLwotICAg
IHJhbmdlX3RvcCA9IGxpbWl0ICsgUEFHRV9TSVpFOwotICAgIGlvbW11X3Rv
cCA9IG1heF9wYWdlICogUEFHRV9TSVpFOwotICAgIGlmICggYmFzZSA8IGlv
bW11X3RvcCApCi0gICAgewotICAgICAgICBpZiAoIHJhbmdlX3RvcCA+IGlv
bW11X3RvcCApCi0gICAgICAgICAgICByYW5nZV90b3AgPSBpb21tdV90b3A7
Ci0gICAgICAgIGxlbmd0aCA9IHJhbmdlX3RvcCAtIGJhc2U7CisgICAgaWYg
KCBleGNsdXNpb24gKQorICAgICAgICByYyA9IHJlc2VydmVfaW9tbXVfZXhj
bHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAvKiBhbGwg
Ki8pOworICAgIGlmICggIWV4Y2x1c2lvbiB8fCByYyApCisgICAgeworICAg
ICAgICBwYWRkcl90IGxlbmd0aCA9IGxpbWl0ICsgUEFHRV9TSVpFIC0gYmFz
ZTsKKwogICAgICAgICAvKiByZXNlcnZlIHVuaXR5LW1hcHBlZCBwYWdlIGVu
dHJpZXMgZm9yIGRldmljZSAqLwotICAgICAgICAvKiBub3RlOiB0aGVzZSBl
bnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNpb24gcmFuZ2UgKi8KICAg
ICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywg
YmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcikgPzoKICAgICAgICAgICAgICBy
ZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNlZywgcmVxLCBiYXNlLCBs
ZW5ndGgsIGl3LCBpcik7Ci0KLSAgICAgICAgLyogcHVzaCAnYmFzZScganVz
dCBvdXRzaWRlIG9mIHZpcnR1YWwgYWRkcmVzcyBzcGFjZSAqLwotICAgICAg
ICBiYXNlID0gaW9tbXVfdG9wOwogICAgIH0KLQotICAgIC8qIHJlZ2lzdGVy
IElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyBmb3IgZGV2aWNlICov
Ci0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICApCisgICAg
ZWxzZQogICAgIHsKLSAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgLyogYWxsICov
LCBpdywgaXIpOwogICAgICAgICBpdnJzX21hcHBpbmdzW2JkZl0uZHRlX2Fs
bG93X2V4Y2x1c2lvbiA9IHRydWU7CiAgICAgICAgIGl2cnNfbWFwcGluZ3Nb
cmVxXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gdHJ1ZTsKICAgICB9CkBAIC0y
NzcsNTMgKzI2Niw0MiBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9l
eGNsdXNpb25fcmFuCiAgICAgcmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50
IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2lvbW11X2Rl
dmljZXMoCi0gICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCi0gICAgdW5z
aWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25nIGxpbWl0LCB1OCBpdywg
dTggaXIpCitzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9yYW5nZV9mb3Jf
aW9tbXVfZGV2aWNlcygKKyAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwg
cGFkZHJfdCBiYXNlLCBwYWRkcl90IGxpbWl0LAorICAgIGJvb2wgaXcsIGJv
b2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewotICAgIHVuc2lnbmVkIGxvbmcg
cmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKKyAgICAvKiBub3RlOiAn
bGltaXQnIHBhcmFtZXRlciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2UtYWxpZ25l
ZCAqLworICAgIHBhZGRyX3QgbGVuZ3RoID0gbGltaXQgKyBQQUdFX1NJWkUg
LSBiYXNlOwogICAgIHVuc2lnbmVkIGludCBiZGY7CiAgICAgdTE2IHJlcTsK
LSAgICBpbnQgcmMgPSAwOworICAgIGludCByYzsKIAotICAgIC8qIGlzIHBh
cnQgb2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBvZiBJT01NVSB2aXJ0dWFs
IGFkZHJlc3Mgc3BhY2U/ICovCi0gICAgLyogbm90ZTogJ2xpbWl0JyBwYXJh
bWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWduZWQgKi8KLSAgICBy
YW5nZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsKLSAgICBpb21tdV90b3Ag
PSBtYXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBpZiAoIGJhc2UgPCBpb21t
dV90b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCByYW5nZV90b3AgPiBpb21t
dV90b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9wID0gaW9tbXVfdG9wOwot
ICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwotICAgICAgICAv
KiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBk
ZXZpY2VzICovCi0gICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJpZXMgYXJl
IHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAgICAgICBmb3Ig
KCBiZGYgPSAwOyAhcmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRm
KysgKQotICAgICAgICB7Ci0gICAgICAgICAgICBpZiAoIGlvbW11ID09IGZp
bmRfaW9tbXVfZm9yX2RldmljZShpb21tdS0+c2VnLCBiZGYpICkKLSAgICAg
ICAgICAgIHsKLSAgICAgICAgICAgICAgICByZXEgPSBnZXRfaXZyc19tYXBw
aW5ncyhpb21tdS0+c2VnKVtiZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7Ci0gICAg
ICAgICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNl
KGlvbW11LT5zZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIp
ID86Ci0gICAgICAgICAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9m
b3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpdywgaXIpOwotICAgICAgICAgICAgfQotICAgICAgICB9Ci0KLSAgICAg
ICAgLyogcHVzaCAnYmFzZScganVzdCBvdXRzaWRlIG9mIHZpcnR1YWwgYWRk
cmVzcyBzcGFjZSAqLwotICAgICAgICBiYXNlID0gaW9tbXVfdG9wOworICAg
IGlmICggZXhjbHVzaW9uICkKKyAgICB7CisgICAgICAgIHJjID0gcmVzZXJ2
ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LCB0
cnVlIC8qIGFsbCAqLyk7CisgICAgICAgIGlmICggIXJjICkKKyAgICAgICAg
ICAgIHJldHVybiAwOwogICAgIH0KIAotICAgIC8qIHJlZ2lzdGVyIElPTU1V
IGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwotICAgIGlmICggIXJjICYm
IGxpbWl0ID49IGlvbW11X3RvcCApCi0gICAgICAgIHJjID0gcmVzZXJ2ZV9p
b21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUg
LyogYWxsICovLCBpdywgaXIpOworICAgIC8qIHJlc2VydmUgdW5pdHktbWFw
cGVkIHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAqLworICAgIGZvciAoIGJk
ZiA9IHJjID0gMDsgIXJjICYmIGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJk
ZisrICkKKyAgICB7CisgICAgICAgIGlmICggaW9tbXUgIT0gZmluZF9pb21t
dV9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZikgKQorICAgICAgICAgICAg
Y29udGludWU7CisKKyAgICAgICAgcmVxID0gZ2V0X2l2cnNfbWFwcGluZ3Mo
aW9tbXUtPnNlZylbYmRmXS5kdGVfcmVxdWVzdG9yX2lkOworICAgICAgICBy
YyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywg
YmRmLCBiYXNlLCBsZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpdywgaXIpID86CisgICAgICAgICAgICAgcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShpb21tdS0+c2VnLCByZXEsIGJh
c2UsIGxlbmd0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGl3LCBpcik7CisgICAgfQogCiAgICAgcmV0dXJuIHJjOwog
fQogCiBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9zZWxl
Y3QoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19tZW1vcnkgKml2bWRf
YmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25n
IGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJfdCBiYXNlLCBwYWRk
cl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikK
IHsKICAgICB1MTYgYmRmOwogCkBAIC0zMzQsMTIgKzMxMiwxMiBAQCBzdGF0
aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9zZWxlCiAgICAgICAg
IHJldHVybiAtRU5PREVWOwogICAgIH0KIAotICAgIHJldHVybiByZWdpc3Rl
cl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZShiZGYsIGJhc2UsIGxpbWl0
LCBpdywgaXIpOworICAgIHJldHVybiByZWdpc3Rlcl9yYW5nZV9mb3JfZGV2
aWNlKGJkZiwgYmFzZSwgbGltaXQsIGl3LCBpciwgZXhjbHVzaW9uKTsKIH0K
IAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZtZF9kZXZpY2VfcmFuZ2Uo
CiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19tZW1vcnkgKml2bWRfYmxv
Y2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25nIGxp
bWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90
IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikKIHsK
ICAgICB1bnNpZ25lZCBpbnQgZmlyc3RfYmRmLCBsYXN0X2JkZiwgYmRmOwog
ICAgIGludCBlcnJvcjsKQEAgLTM2MSwxNSArMzM5LDE1IEBAIHN0YXRpYyBp
bnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3JhbmcKICAgICB9CiAKICAg
ICBmb3IgKCBiZGYgPSBmaXJzdF9iZGYsIGVycm9yID0gMDsgKGJkZiA8PSBs
YXN0X2JkZikgJiYgIWVycm9yOyBiZGYrKyApCi0gICAgICAgIGVycm9yID0g
cmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZpY2UoCi0gICAgICAg
ICAgICBiZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAgICAgICBlcnJv
ciA9IHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2UoCisgICAgICAgICAgICBi
ZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBy
ZXR1cm4gZXJyb3I7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2
bWRfZGV2aWNlX2lvbW11KAogICAgIGNvbnN0IHN0cnVjdCBhY3BpX2l2cnNf
bWVtb3J5ICppdm1kX2Jsb2NrLAotICAgIHVuc2lnbmVkIGxvbmcgYmFzZSwg
dW5zaWduZWQgbG9uZyBsaW1pdCwgdTggaXcsIHU4IGlyKQorICAgIHBhZGRy
X3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwgYm9vbCBpdywgYm9vbCBpciwgYm9v
bCBleGNsdXNpb24pCiB7CiAgICAgaW50IHNlZyA9IDA7IC8qIFhYWCAqLwog
ICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwpAQCAtMzg0LDE0ICszNjIs
MTQgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZtZF9kZXZpY2VfaW9t
bQogICAgICAgICByZXR1cm4gLUVOT0RFVjsKICAgICB9CiAKLSAgICByZXR1
cm4gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9pb21tdV9kZXZpY2Vz
KAotICAgICAgICBpb21tdSwgYmFzZSwgbGltaXQsIGl3LCBpcik7CisgICAg
cmV0dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9pb21tdV9kZXZpY2VzKAorICAg
ICAgICBpb21tdSwgYmFzZSwgbGltaXQsIGl3LCBpciwgZXhjbHVzaW9uKTsK
IH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZtZF9ibG9jayhjb25z
dCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9jaykKIHsKICAg
ICB1bnNpZ25lZCBsb25nIHN0YXJ0X2FkZHIsIG1lbV9sZW5ndGgsIGJhc2Us
IGxpbWl0OwotICAgIHU4IGl3LCBpcjsKKyAgICBib29sIGl3ID0gdHJ1ZSwg
aXIgPSB0cnVlLCBleGNsdXNpb24gPSBmYWxzZTsKIAogICAgIGlmICggaXZt
ZF9ibG9jay0+aGVhZGVyLmxlbmd0aCA8IHNpemVvZigqaXZtZF9ibG9jaykg
KQogICAgIHsKQEAgLTQwOCwxMyArMzg2LDExIEBAIHN0YXRpYyBpbnQgX19p
bml0IHBhcnNlX2l2bWRfYmxvY2soY29uc3QKICAgICAgICAgICAgICAgICAg
ICAgaXZtZF9ibG9jay0+aGVhZGVyLnR5cGUsIHN0YXJ0X2FkZHIsIG1lbV9s
ZW5ndGgpOwogCiAgICAgaWYgKCBpdm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3Mg
JiBBQ1BJX0lWTURfRVhDTFVTSU9OX1JBTkdFICkKLSAgICAgICAgaXcgPSBp
ciA9IElPTU1VX0NPTlRST0xfRU5BQkxFRDsKKyAgICAgICAgZXhjbHVzaW9u
ID0gdHJ1ZTsKICAgICBlbHNlIGlmICggaXZtZF9ibG9jay0+aGVhZGVyLmZs
YWdzICYgQUNQSV9JVk1EX1VOSVRZICkKICAgICB7Ci0gICAgICAgIGl3ID0g
aXZtZF9ibG9jay0+aGVhZGVyLmZsYWdzICYgQUNQSV9JVk1EX1JFQUQgPwot
ICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FTkFCTEVEIDogSU9NTVVfQ09O
VFJPTF9ESVNBQkxFRDsKLSAgICAgICAgaXIgPSBpdm1kX2Jsb2NrLT5oZWFk
ZXIuZmxhZ3MgJiBBQ1BJX0lWTURfV1JJVEUgPwotICAgICAgICAgICAgSU9N
TVVfQ09OVFJPTF9FTkFCTEVEIDogSU9NTVVfQ09OVFJPTF9ESVNBQkxFRDsK
KyAgICAgICAgaXcgPSBpdm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJ
X0lWTURfUkVBRDsKKyAgICAgICAgaXIgPSBpdm1kX2Jsb2NrLT5oZWFkZXIu
ZmxhZ3MgJiBBQ1BJX0lWTURfV1JJVEU7CiAgICAgfQogICAgIGVsc2UKICAg
ICB7CkBAIC00MjUsMjAgKzQwMSwyMCBAQCBzdGF0aWMgaW50IF9faW5pdCBw
YXJzZV9pdm1kX2Jsb2NrKGNvbnN0CiAgICAgc3dpdGNoKCBpdm1kX2Jsb2Nr
LT5oZWFkZXIudHlwZSApCiAgICAgewogICAgIGNhc2UgQUNQSV9JVlJTX1RZ
UEVfTUVNT1JZX0FMTDoKLSAgICAgICAgcmV0dXJuIHJlZ2lzdGVyX2V4Y2x1
c2lvbl9yYW5nZV9mb3JfYWxsX2RldmljZXMoCi0gICAgICAgICAgICBiYXNl
LCBsaW1pdCwgaXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHJlZ2lzdGVyX3Jh
bmdlX2Zvcl9hbGxfZGV2aWNlcygKKyAgICAgICAgICAgIGJhc2UsIGxpbWl0
LCBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBjYXNlIEFDUElfSVZSU19U
WVBFX01FTU9SWV9PTkU6Ci0gICAgICAgIHJldHVybiBwYXJzZV9pdm1kX2Rl
dmljZV9zZWxlY3QoaXZtZF9ibG9jaywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAg
ICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdChpdm1kX2Js
b2NrLCBiYXNlLCBsaW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBjYXNl
IEFDUElfSVZSU19UWVBFX01FTU9SWV9SQU5HRToKLSAgICAgICAgcmV0dXJu
IHBhcnNlX2l2bWRfZGV2aWNlX3JhbmdlKGl2bWRfYmxvY2ssCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLCBsaW1pdCwg
aXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX3Jh
bmdlKGl2bWRfYmxvY2ssIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGlyLCBleGNsdXNpb24pOwog
CiAgICAgY2FzZSBBQ1BJX0lWUlNfVFlQRV9NRU1PUllfSU9NTVU6Ci0gICAg
ICAgIHJldHVybiBwYXJzZV9pdm1kX2RldmljZV9pb21tdShpdm1kX2Jsb2Nr
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFz
ZSwgbGltaXQsIGl3LCBpcik7CisgICAgICAgIHJldHVybiBwYXJzZV9pdm1k
X2RldmljZV9pb21tdShpdm1kX2Jsb2NrLCBiYXNlLCBsaW1pdCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpciwgZXhj
bHVzaW9uKTsKIAogICAgIGRlZmF1bHQ6CiAgICAgICAgIEFNRF9JT01NVV9E
RUJVRygiSVZNRCBFcnJvcjogSW52YWxpZCBCbG9jayBUeXBlIVxuIik7Ci0t
LSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11
LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRf
aW9tbXUuYwpAQCAtMjM0LDYgKzIzNCw4IEBAIHN0YXRpYyBpbnQgX19tdXN0
X2NoZWNrIGFsbG9jYXRlX2RvbWFpbl8KICAgICByZXR1cm4gcmM7CiB9CiAK
K2ludCBfX3JlYWRfbW9zdGx5IGFtZF9pb21tdV9taW5fcGFnaW5nX21vZGUg
PSAxOworCiBzdGF0aWMgaW50IGFtZF9pb21tdV9kb21haW5faW5pdChzdHJ1
Y3QgZG9tYWluICpkKQogewogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhk
ID0gZG9tX2lvbW11KGQpOwpAQCAtMjQ1LDExICsyNDcsMTMgQEAgc3RhdGlj
IGludCBhbWRfaW9tbXVfZG9tYWluX2luaXQoc3RydWN0CiAgICAgICogLSBI
Vk0gY291bGQgaW4gcHJpbmNpcGxlIHVzZSAzIG9yIDQgZGVwZW5kaW5nIG9u
IGhvdyBtdWNoIGd1ZXN0CiAgICAgICogICBwaHlzaWNhbCBhZGRyZXNzIHNw
YWNlIHdlIGdpdmUgaXQsIGJ1dCB0aGlzIGlzbid0IGtub3duIHlldCBzbyB1
c2UgNAogICAgICAqICAgdW5pbGF0ZXJhbGx5LgorICAgICAqIC0gVW5pdHkg
bWFwcyBtYXkgcmVxdWlyZSBhbiBldmVuIGhpZ2hlciBudW1iZXIuCiAgICAg
ICovCi0gICAgaGQtPmFyY2gucGFnaW5nX21vZGUgPSBhbWRfaW9tbXVfZ2V0
X3BhZ2luZ19tb2RlKAotICAgICAgICBpc19odm1fZG9tYWluKGQpCi0gICAg
ICAgID8gMXVsIDw8IChERUZBVUxUX0RPTUFJTl9BRERSRVNTX1dJRFRIIC0g
UEFHRV9TSElGVCkKLSAgICAgICAgOiBnZXRfdXBwZXJfbWZuX2JvdW5kKCkg
KyAxKTsKKyAgICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IG1heChhbWRfaW9t
bXVfZ2V0X3BhZ2luZ19tb2RlKAorICAgICAgICAgICAgaXNfaHZtX2RvbWFp
bihkKQorICAgICAgICAgICAgPyAxdWwgPDwgKERFRkFVTFRfRE9NQUlOX0FE
RFJFU1NfV0lEVEggLSBQQUdFX1NISUZUKQorICAgICAgICAgICAgOiBnZXRf
dXBwZXJfbWZuX2JvdW5kKCkgKyAxKSwKKyAgICAgICAgYW1kX2lvbW11X21p
bl9wYWdpbmdfbW9kZSk7CiAKICAgICByZXR1cm4gMDsKIH0KLS0tIGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21tdS1wcm90by5oCisr
KyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtcHJv
dG8uaApAQCAtMTQwLDYgKzE0MCw4IEBAIGV4dGVybiBzdHJ1Y3QgaHBldF9z
YmRmIHsKICAgICB9IGluaXQ7CiB9IGhwZXRfc2JkZjsKIAorZXh0ZXJuIGlu
dCBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2RlOworCiBleHRlcm4gdm9pZCAq
c2hhcmVkX2ludHJlbWFwX3RhYmxlOwogZXh0ZXJuIHVuc2lnbmVkIGxvbmcg
KnNoYXJlZF9pbnRyZW1hcF9pbnVzZTsKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-7.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-7.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBpbnRyb2R1Y2UgcDJtX2lzX3NwZWNpYWwoKQoKU2VlaW5n
IHRoZSBzaW1pbGFyaXR5IG9mIGdyYW50LCBmb3JlaWduLCBhbmQgKHN1YnNl
cXVlbnRseSkgZGlyZWN0LU1NSU8KaGFuZGxpbmcsIGludHJvZHVjZSBhIG5l
dyBQMk0gdHlwZSBncm91cCBuYW1lZCAic3BlY2lhbCIgKGFzIGluICJuZWVk
aW5nCnNwZWNpYWwgYWNjZXNzb3JzIHRvIGNyZWF0ZS9kZXN0cm95IikuCgpB
bHNvIHVzZSAtRVBFUk0gaW5zdGVhZCBvZiBvdGhlciBlcnJvciBjb2RlcyBv
biB0aGUgdHdvIGRvbWFpbl9jcmFzaCgpCnBhdGhzIHRvdWNoZWQuCgpUaGlz
IGlzIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtODA3LDcgKzgw
Nyw3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJt
LAogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRl
cik7IGkrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOwotICAgICAgICAgICAgaWYgKCAhcDJtX2lzX2dyYW50KHQpICYmICFw
Mm1faXNfc2hhcmVkKHQpICYmICFwMm1faXNfZm9yZWlnbih0KSApCisgICAg
ICAgICAgICBpZiAoICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3No
YXJlZCh0KSApCiAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4o
bWZuK2ksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAgfQogICAgIH0K
QEAgLTkzNCwxMyArOTM0LDEzIEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5
KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKICAgICAgICAgICAg
IEFTU0VSVCghcDJtX2lzX3NoYXJlZChvdCkpOwogICAgICAgICB9Ci0gICAg
ICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1faXNfZm9yZWlnbihv
dCkgKQorICAgICAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90KSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIC8qIFJlYWxseSBzaG91bGRuJ3QgYmUgdW5t
YXBwaW5nIGdyYW50L2ZvcmVpZ24gbWFwcyB0aGlzIHdheSAqLworICAgICAg
ICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9mb3JlaWdu
IHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwog
ICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAgICAgICAgCi0g
ICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAgICAgIHJldHVy
biAtRVBFUk07CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHAybV9p
c19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKICAgICAgICAgewpA
QCAtMTAzNCw4ICsxMDM0LDcgQEAgaW50IHAybV9jaGFuZ2VfdHlwZV9vbmUo
c3RydWN0IGRvbWFpbiAqZAogICAgIHN0cnVjdCBwMm1fZG9tYWluICpwMm0g
PSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAgICAgaW50IHJjOwogCi0gICAgQlVH
X09OKHAybV9pc19ncmFudChvdCkgfHwgcDJtX2lzX2dyYW50KG50KSk7Ci0g
ICAgQlVHX09OKHAybV9pc19mb3JlaWduKG90KSB8fCBwMm1faXNfZm9yZWln
bihudCkpOworICAgIEJVR19PTihwMm1faXNfc3BlY2lhbChvdCkgfHwgcDJt
X2lzX3NwZWNpYWwobnQpKTsKIAogICAgIGdmbl9sb2NrKHAybSwgZ2ZuLCAw
KTsKIApAQCAtMTI4MiwxMSArMTI4MSwxMSBAQCBzdGF0aWMgaW50IHNldF90
eXBlZF9wMm1fZW50cnkoc3RydWN0IGRvCiAgICAgICAgIGdmbl91bmxvY2so
cDJtLCBnZm4sIG9yZGVyKTsKICAgICAgICAgcmV0dXJuIGN1cl9vcmRlciAr
IDE7CiAgICAgfQotICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1f
aXNfZm9yZWlnbihvdCkgKQorICAgIGlmICggcDJtX2lzX3NwZWNpYWwob3Qp
ICkKICAgICB7CiAgICAgICAgIGdmbl91bmxvY2socDJtLCBnZm4sIG9yZGVy
KTsKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAgICByZXR1cm4g
LUVOT0VOVDsKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAgICB9CiAgICAg
ZWxzZSBpZiAoIHAybV9pc19yYW0ob3QpICkKICAgICB7Ci0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9wMm0uaApAQCAtMTQxLDYgKzE0MSwxMCBAQCB0eXBlZGVmIHVuc2lnbmVk
IGludCBwMm1fcXVlcnlfdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8IHAybV90b19tYXNrKHAybV9yYW1fbG9nZGlydHkpICkKICNkZWZpbmUg
UDJNX1NIQVJFRF9UWVBFUyAgIChwMm1fdG9fbWFzayhwMm1fcmFtX3NoYXJl
ZCkpCiAKKy8qIFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQgdXAgdmlhIHNw
ZWNpYWwgYWNjZXNzb3JzLiAqLworI2RlZmluZSBQMk1fU1BFQ0lBTF9UWVBF
UyAoUDJNX0dSQU5UX1RZUEVTIHwgXAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSkKKwogLyogVmFs
aWQgdHlwZXMgbm90IG5lY2Vzc2FyaWx5IGFzc29jaWF0ZWQgd2l0aCBhICh2
YWxpZCkgTUZOLiAqLwogI2RlZmluZSBQMk1fSU5WQUxJRF9NRk5fVFlQRVMg
KFAyTV9QT0RfVFlQRVMgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfCBwMm1fdG9fbWFzayhwMm1fbW1pb19k
aXJlY3QpIFwKQEAgLTE2OSw2ICsxNzMsNyBAQCB0eXBlZGVmIHVuc2lnbmVk
IGludCBwMm1fcXVlcnlfdDsKICNkZWZpbmUgcDJtX2lzX3BhZ2VkKF90KSAg
ICAocDJtX3RvX21hc2soX3QpICYgUDJNX1BBR0VEX1RZUEVTKQogI2RlZmlu
ZSBwMm1faXNfc2hhcmFibGUoX3QpIChwMm1fdG9fbWFzayhfdCkgJiBQMk1f
U0hBUkFCTEVfVFlQRVMpCiAjZGVmaW5lIHAybV9pc19zaGFyZWQoX3QpICAg
KHAybV90b19tYXNrKF90KSAmIFAyTV9TSEFSRURfVFlQRVMpCisjZGVmaW5l
IHAybV9pc19zcGVjaWFsKF90KSAgKHAybV90b19tYXNrKF90KSAmIFAyTV9T
UEVDSUFMX1RZUEVTKQogI2RlZmluZSBwMm1faXNfYnJva2VuKF90KSAgIChw
Mm1fdG9fbWFzayhfdCkgJiBQMk1fQlJPS0VOX1RZUEVTKQogI2RlZmluZSBw
Mm1faXNfZm9yZWlnbihfdCkgIChwMm1fdG9fbWFzayhfdCkgJiBwMm1fdG9f
bWFzayhwMm1fbWFwX2ZvcmVpZ24pKQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.13-8.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.13-8.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBndWFyZCAoaW4gcGFydGljdWxhcikgaWRlbnRpdHkgbWFw
cGluZyBlbnRyaWVzCgpTdWNoIGVudHJpZXMsIGNyZWF0ZWQgYnkgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpLCBzaG91bGQgb25seSBiZQpkZXN0cm95ZWQg
YnkgY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KCkuIEhvd2V2ZXIsIHNpbWls
YXJseSwgZW50cmllcwpjcmVhdGVkIGJ5IHNldF9tbWlvX3AybV9lbnRyeSgp
IHNob3VsZCBvbmx5IGJlIHRvcm4gZG93biBieQpjbGVhcl9tbWlvX3AybV9l
bnRyeSgpLCBzbyB0aGUgbG9naWMgZ2V0cyBiYXNlZCB1cG9uIHAybV9tbWlv
X2RpcmVjdCBhcwp0aGUgZW50cnkgdHlwZSAoc2VwYXJhdGlvbiBiZXR3ZWVu
ICJvcmRpbmFyeSIgYW5kIDE6MSBtYXBwaW5ncyB3b3VsZApyZXF1aXJlIGEg
ZnVydGhlciBpbmRpY2F0b3IgdG8gdGVsbCBhcGFydCB0aGUgdHdvKS4KCkFz
IHRvIHRoZSBndWVzdF9yZW1vdmVfcGFnZSgpIGNoYW5nZSwgY29tbWl0IDQ4
ZGZiMjk3YTIwYSAoIng4Ni9QVkg6CmFsbG93IGd1ZXN0X3JlbW92ZV9wYWdl
IHRvIHJlbW92ZSBwMm1fbW1pb19kaXJlY3QgcGFnZXMiKSwgd2hpY2gKaW50
cm9kdWNlZCB0aGUgY2FsbCB0byBjbGVhcl9tbWlvX3AybV9lbnRyeSgpLCBj
bGFpbWVkIHRoaXMgd2FzIGRvbmUgZm9yCmh3ZG9tIG9ubHkgd2l0aG91dCB0
aGlzIGFjdHVhbGx5IGhhdmluZyBiZWVuIHRoZSBjYXNlLiBIb3dldmVyLCB0
aGlzCmNvZGUgc2hvdWxkbid0IGJlIHRoZXJlIGluIHRoZSBmaXJzdCBwbGFj
ZSwgYXMgTU1JTyBlbnRyaWVzIHNob3VsZG4ndCBiZQpkcm9wcGVkIHRoaXMg
d2F5LiBBdm9pZCB0cmlnZ2VyaW5nIHRoZSB3YXJuaW5nIGFnYWluIHRoYXQg
NDhkZmIyOTdhMjBhCnNpbGVuY2VkIGJ5IGFuIGFkanVzdG1lbnQgdG8geGVu
bWVtX2FkZF90b19waHlzbWFwX29uZSgpIGluc3RlYWQuCgpOb3RlIHRoYXQg
Z3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZCgpIGdldHMg
dGlnaHRlbmVkIGJleW9uZAp0aGUgaW1tZWRpYXRlIHB1cnBvc2Ugb2YgdGhp
cyBjaGFuZ2UuCgpOb3RlIGFsc28gdGhhdCBJIGRpZG4ndCBpbnNwZWN0IGNv
ZGUgd2hpY2ggaXNuJ3Qgc2VjdXJpdHkgc3VwcG9ydGVkLAplLmcuIHNoYXJp
bmcsIHBhZ2luZywgb3IgYWx0cDJtLgoKVGhpcyBpcyBDVkUtMjAyMS0yODY5
NCAvIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tLmMK
KysrIGIveGVuL2FyY2gveDg2L21tLmMKQEAgLTQ3NzAsNyArNDc3MCw5IEBA
IGludCB4ZW5tZW1fYWRkX3RvX3BoeXNtYXBfb25lKAogCiAgICAgLyogUmVt
b3ZlIHByZXZpb3VzbHkgbWFwcGVkIHBhZ2UgaWYgaXQgd2FzIHByZXNlbnQu
ICovCiAgICAgcHJldl9tZm4gPSBnZXRfZ2ZuKGQsIGdmbl94KGdwZm4pLCAm
cDJtdCk7Ci0gICAgaWYgKCBtZm5fdmFsaWQocHJldl9tZm4pICkKKyAgICBp
ZiAoIHAybXQgPT0gcDJtX21taW9fZGlyZWN0ICkKKyAgICAgICAgcmMgPSAt
RVBFUk07CisgICAgZWxzZSBpZiAoIG1mbl92YWxpZChwcmV2X21mbikgKQog
ICAgIHsKICAgICAgICAgaWYgKCBpc194ZW5faGVhcF9tZm4ocHJldl9tZm4p
ICkKICAgICAgICAgICAgIC8qIFhlbiBoZWFwIGZyYW1lcyBhcmUgc2ltcGx5
IHVuaG9va2VkIGZyb20gdGhpcyBwaHlzIHNsb3QuICovCi0tLSBhL3hlbi9h
cmNoL3g4Ni9tbS9wMm0uYworKysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLmMK
QEAgLTc5Niw3ICs3OTYsOCBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAy
bV9kb21haW4gKnAybSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZjdXJfb3JkZXIsIE5VTEwpOwogCiAgICAgICAgIGlm
ICggcDJtX2lzX3ZhbGlkKHQpICYmCi0gICAgICAgICAgICAgKCFtZm5fdmFs
aWQoX21mbihtZm4pKSB8fCBtZm4gKyBpICE9IG1mbl94KG1mbl9yZXR1cm4p
KSApCisgICAgICAgICAgICAgKCFtZm5fdmFsaWQoX21mbihtZm4pKSB8fCB0
ID09IHAybV9tbWlvX2RpcmVjdCB8fAorICAgICAgICAgICAgICBtZm4gKyBp
ICE9IG1mbl94KG1mbl9yZXR1cm4pKSApCiAgICAgICAgICAgICByZXR1cm4g
LUVJTFNFUTsKIAogICAgICAgICBpICs9ICgxVUwgPDwgY3VyX29yZGVyKSAt
ICgoZ2ZuX2wgKyBpKSAmICgoMVVMIDw8IGN1cl9vcmRlcikgLSAxKSk7CkBA
IC04OTAsNyArODkxLDcgQEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3Ry
dWN0IGRvbWFpbiAqZAogICAgIGlmICggcDJtX2lzX2ZvcmVpZ24odCkgKQog
ICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAotICAgIGlmICggIW1mbl92YWxp
ZChtZm4pICkKKyAgICBpZiAoICFtZm5fdmFsaWQobWZuKSB8fCB0ID09IHAy
bV9tbWlvX2RpcmVjdCApCiAgICAgewogICAgICAgICBBU1NFUlRfVU5SRUFD
SEFCTEUoKTsKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CkBAIC05MzYsNyAr
OTM3LDcgQEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFp
biAqZAogICAgICAgICB9CiAgICAgICAgIGlmICggcDJtX2lzX3NwZWNpYWwo
b3QpICkKICAgICAgICAgewotICAgICAgICAgICAgLyogRG9uJ3QgcGVybWl0
IHVubWFwcGluZyBncmFudC9mb3JlaWduIHRoaXMgd2F5LiAqLworICAgICAg
ICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9mb3JlaWdu
L2RpcmVjdC1NTUlPIHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWlu
X2NyYXNoKGQpOwogICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAg
ICAgICAgICAgCkBAIC0xMzg1LDggKzEzODYsOCBAQCBpbnQgc2V0X2lkZW50
aXR5X3AybV9lbnRyeShzdHJ1Y3QgZG9tYWluCiAgKiAgICBvcmRlcisxICBm
b3IgY2FsbGVyIHRvIHJldHJ5IHdpdGggb3JkZXIgKGd1YXJhbnRlZWQgc21h
bGxlciB0aGFuCiAgKiAgICAgICAgICAgICB0aGUgb3JkZXIgdmFsdWUgcGFz
c2VkIGluKQogICovCi1pbnQgY2xlYXJfbW1pb19wMm1fZW50cnkoc3RydWN0
IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwgbWZuX3QgbWZuLAot
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBvcmRlcikK
K3N0YXRpYyBpbnQgY2xlYXJfbW1pb19wMm1fZW50cnkoc3RydWN0IGRvbWFp
biAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbWZuX3QgbWZuLCB1bnNpZ25lZCBpbnQgb3JkZXIp
CiB7CiAgICAgaW50IHJjID0gLUVJTlZBTDsKICAgICBnZm5fdCBnZm4gPSBf
Z2ZuKGdmbl9sKTsKLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS1wb2QuYwor
KysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5jCkBAIC0xMjk1LDE3ICsx
Mjk1LDE3IEBAIGd1ZXN0X3BoeXNtYXBfbWFya19wb3B1bGF0ZV9vbl9kZW1h
bmQoc3QKIAogICAgICAgICBwMm0tPmdldF9lbnRyeShwMm0sIGdmbl9hZGQo
Z2ZuLCBpKSwgJm90LCAmYSwgMCwgJmN1cl9vcmRlciwgTlVMTCk7CiAgICAg
ICAgIG4gPSAxVUwgPDwgbWluKG9yZGVyLCBjdXJfb3JkZXIpOwotICAgICAg
ICBpZiAoIHAybV9pc19yYW0ob3QpICkKKyAgICAgICAgaWYgKCBvdCA9PSBw
Mm1fcG9wdWxhdGVfb25fZGVtYW5kICkKKyAgICAgICAgeworICAgICAgICAg
ICAgLyogQ291bnQgaG93IG1hbnkgUG9EIGVudHJpZXMgd2UnbGwgYmUgcmVw
bGFjaW5nIGlmIHN1Y2Nlc3NmdWwgKi8KKyAgICAgICAgICAgIHBvZF9jb3Vu
dCArPSBuOworICAgICAgICB9CisgICAgICAgIGVsc2UgaWYgKCBvdCAhPSBw
Mm1faW52YWxpZCAmJiBvdCAhPSBwMm1fbW1pb19kbSApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIFAyTV9ERUJVRygiZ2ZuX3RvX21mbiByZXR1cm5lZCB0
eXBlICVkIVxuIiwgb3QpOwogICAgICAgICAgICAgcmMgPSAtRUJVU1k7CiAg
ICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgfQotICAgICAgICBlbHNl
IGlmICggb3QgPT0gcDJtX3BvcHVsYXRlX29uX2RlbWFuZCApCi0gICAgICAg
IHsKLSAgICAgICAgICAgIC8qIENvdW50IGhvdyBtYW4gUG9EIGVudHJpZXMg
d2UnbGwgYmUgcmVwbGFjaW5nIGlmIHN1Y2Nlc3NmdWwgKi8KLSAgICAgICAg
ICAgIHBvZF9jb3VudCArPSBuOwotICAgICAgICB9CiAgICAgfQogCiAgICAg
LyogTm93LCBhY3R1YWxseSBkbyB0aGUgdHdvLXdheSBtYXBwaW5nICovCi0t
LSBhL3hlbi9jb21tb24vbWVtb3J5LmMKKysrIGIveGVuL2NvbW1vbi9tZW1v
cnkuYwpAQCAtMzI4LDcgKzMyOCw3IEBAIGludCBndWVzdF9yZW1vdmVfcGFn
ZShzdHJ1Y3QgZG9tYWluICpkLAogICAgIH0KICAgICBpZiAoIHAybXQgPT0g
cDJtX21taW9fZGlyZWN0ICkKICAgICB7Ci0gICAgICAgIHJjID0gY2xlYXJf
bW1pb19wMm1fZW50cnkoZCwgZ21mbiwgbWZuLCBQQUdFX09SREVSXzRLKTsK
KyAgICAgICAgcmMgPSAtRVBFUk07CiAgICAgICAgIGdvdG8gb3V0X3B1dF9n
Zm47CiAgICAgfQogI2Vsc2UKQEAgLTE3MjAsNiArMTcyMCwxNSBAQCBpbnQg
Y2hlY2tfZ2V0X3BhZ2VfZnJvbV9nZm4oc3RydWN0IGRvbWFpCiAgICAgICAg
IHJldHVybiAtRUFHQUlOOwogICAgIH0KICNlbmRpZgorI2lmZGVmIENPTkZJ
R19YODYKKyAgICBpZiAoIHAybXQgPT0gcDJtX21taW9fZGlyZWN0ICkKKyAg
ICB7CisgICAgICAgIGlmICggcGFnZSApCisgICAgICAgICAgICBwdXRfcGFn
ZShwYWdlKTsKKworICAgICAgICByZXR1cm4gLUVQRVJNOworICAgIH0KKyNl
bmRpZgogCiAgICAgaWYgKCAhcGFnZSApCiAgICAgICAgIHJldHVybiAtRUlO
VkFMOwotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5oCisrKyBiL3hl
bi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKQEAgLTE0Myw3ICsxNDMsOCBAQCB0
eXBlZGVmIHVuc2lnbmVkIGludCBwMm1fcXVlcnlfdDsKIAogLyogVHlwZXMg
ZXN0YWJsaXNoZWQvY2xlYW5lZCB1cCB2aWEgc3BlY2lhbCBhY2Nlc3NvcnMu
ICovCiAjZGVmaW5lIFAyTV9TUEVDSUFMX1RZUEVTIChQMk1fR1JBTlRfVFlQ
RVMgfCBcCi0gICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1fdG9fbWFz
ayhwMm1fbWFwX2ZvcmVpZ24pKQorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSB8IFwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHAybV90b19tYXNrKHAybV9tbWlvX2RpcmVj
dCkpCiAKIC8qIFZhbGlkIHR5cGVzIG5vdCBuZWNlc3NhcmlseSBhc3NvY2lh
dGVkIHdpdGggYSAodmFsaWQpIE1GTi4gKi8KICNkZWZpbmUgUDJNX0lOVkFM
SURfTUZOX1RZUEVTIChQMk1fUE9EX1RZUEVTICAgICAgICAgICAgICAgICAg
XApAQCAtNjQ5LDggKzY1MCw2IEBAIGludCBzZXRfZm9yZWlnbl9wMm1fZW50
cnkoc3RydWN0IGRvbWFpbgogLyogU2V0IG1taW8gYWRkcmVzc2VzIGluIHRo
ZSBwMm0gdGFibGUgKGZvciBwYXNzLXRocm91Z2gpICovCiBpbnQgc2V0X21t
aW9fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcg
Z2ZuLCBtZm5fdCBtZm4sCiAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBvcmRlciwgcDJtX2FjY2Vzc190IGFjY2Vzcyk7Ci1pbnQgY2xl
YXJfbW1pb19wMm1fZW50cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQg
bG9uZyBnZm4sIG1mbl90IG1mbiwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgb3JkZXIpOwogCiAvKiBTZXQgaWRlbnRpdHkgYWRk
cmVzc2VzIGluIHRoZSBwMm0gdGFibGUgKGZvciBwYXNzLXRocm91Z2gpICov
CiBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShzdHJ1Y3QgZG9tYWluICpk
LCB1bnNpZ25lZCBsb25nIGdmbiwK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-1.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZ2xvYmFsIGV4Y2x1c2lvbiByYW5nZSBl
eHRlbmRpbmcKCkJlc2lkZXMgdW5pdHkgbWFwcGluZyByZWdpb25zLCB0aGUg
QU1EIElPTU1VIHNwZWMgYWxzbyBwcm92aWRlcyBmb3IKZXhjbHVzaW9uIHJh
bmdlcyAoYXJlYXMgb2YgbWVtb3J5IG5vdCB0byBiZSBzdWJqZWN0IHRvIERN
QSB0cmFuc2xhdGlvbikKdG8gYmUgc3BlY2lmaWVkIGJ5IGZpcm13YXJlIGlu
IHRoZSBBQ1BJIHRhYmxlcy4gVGhlIHNwZWMgZG9lcyBub3QgcHV0CmFueSBj
b25zdHJhaW50cyBvbiB0aGUgbnVtYmVyIG9mIHN1Y2ggcmVnaW9ucy4KCkJs
aW5kbHkgYXNzdW1pbmcgYWxsIGFkZHJlc3NlcyBiZXR3ZWVuIGFueSB0d28g
c3VjaCByYW5nZXMgc2hvdWxkIGFsc28KYmUgZXhjbHVkZWQgY2FuJ3QgYmUg
cmlnaHQuIFNpbmNlIGhhcmR3YXJlIGhhcyByb29tIGZvciBqdXN0IGEgc2lu
Z2xlCnN1Y2ggcmFuZ2UgKGNvbXByaXNlZCBvZiB0aGUgRXhjbHVzaW9uIEJh
c2UgUmVnaXN0ZXIgYW5kIHRoZSBFeGNsdXNpb24KUmFuZ2UgTGltaXQgUmVn
aXN0ZXIpLCBjb21iaW5lIG9ubHkgYWRqYWNlbnQgb3Igb3ZlcmxhcHBpbmcg
cmVnaW9ucyAoZm9yCm5vdzsgdGhpcyBtYXkgcmVxdWlyZSBmdXJ0aGVyIGFk
anVzdG1lbnQgaW4gY2FzZSB0YWJsZSBlbnRyaWVzIGFyZW4ndApzb3J0ZWQg
YnkgYWRkcmVzcykgd2l0aCBtYXRjaGluZyBleGNsdXNpb25fYWxsb3dfYWxs
IHNldHRpbmdzLiBUaGlzCnJlcXVpcmVzIGJ1YmJsaW5nIHVwIGVycm9yIGlu
ZGljYXRvcnMsIHN1Y2ggdGhhdCBJT01NVSBpbml0IGNhbiBiZQpmYWlsZWQg
d2hlbiBjb25jYXRlbmF0aW9uIHdhc24ndCBwb3NzaWJsZS4KCkZ1cnRoZXJt
b3JlLCBzaW5jZSB0aGUgZXhjbHVzaW9uIHJhbmdlIHNwZWNpZmllZCBpbiBJ
T01NVSByZWdpc3RlcnMKaW1wbGllcyBSL1cgYWNjZXNzLCByZWplY3QgcmVx
dWVzdHMgYXNraW5nIGZvciBsZXNzIHBlcm1pc3Npb25zICh0aGlzCndpbGwg
YmUgYnJvdWdodCBjbG9zZXIgdG8gdGhlIHNwZWMgYnkgYSBzdWJzZXF1ZW50
IGNoYW5nZSkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3OCAvIENWRS0yMDIx
LTI4Njk1LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9hY3BpLmMKQEAgLTExNywxMiArMTE3LDIxIEBAIHN0YXRpYyBzdHJ1
Y3QgYW1kX2lvbW11ICogX19pbml0IGZpbmRfaW8KICAgICByZXR1cm4gTlVM
TDsKIH0KIAotc3RhdGljIHZvaWQgX19pbml0IHJlc2VydmVfaW9tbXVfZXhj
bHVzaW9uX3JhbmdlKAotICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1
aW50NjRfdCBiYXNlLCB1aW50NjRfdCBsaW1pdCkKK3N0YXRpYyBpbnQgX19p
bml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKAorICAgIHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11LCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBs
aW1pdCwKKyAgICBib29sIGFsbCwgYm9vbCBpdywgYm9vbCBpcikKIHsKKyAg
ICBpZiAoICFpciB8fCAhaXcgKQorICAgICAgICByZXR1cm4gLUVQRVJNOwor
CiAgICAgLyogbmVlZCB0byBleHRlbmQgZXhjbHVzaW9uIHJhbmdlPyAqLwog
ICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9lbmFibGUgKQogICAgIHsKKyAg
ICAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9uX2xpbWl0ICsgUEFHRV9TSVpF
IDwgYmFzZSB8fAorICAgICAgICAgICAgIGxpbWl0ICsgUEFHRV9TSVpFIDwg
aW9tbXUtPmV4Y2x1c2lvbl9iYXNlIHx8CisgICAgICAgICAgICAgaW9tbXUt
PmV4Y2x1c2lvbl9hbGxvd19hbGwgIT0gYWxsICkKKyAgICAgICAgICAgIHJl
dHVybiAtRUJVU1k7CisKICAgICAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9u
X2Jhc2UgPCBiYXNlICkKICAgICAgICAgICAgIGJhc2UgPSBpb21tdS0+ZXhj
bHVzaW9uX2Jhc2U7CiAgICAgICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9s
aW1pdCA+IGxpbWl0ICkKQEAgLTEzMCwxNiArMTM5LDExIEBAIHN0YXRpYyB2
b2lkIF9faW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2kKICAgICB9CiAKICAg
ICBpb21tdS0+ZXhjbHVzaW9uX2VuYWJsZSA9IElPTU1VX0NPTlRST0xfRU5B
QkxFRDsKKyAgICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCA9IGFsbDsK
ICAgICBpb21tdS0+ZXhjbHVzaW9uX2Jhc2UgPSBiYXNlOwogICAgIGlvbW11
LT5leGNsdXNpb25fbGltaXQgPSBsaW1pdDsKLX0KIAotc3RhdGljIHZvaWQg
X19pbml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlX2FsbCgKLSAg
ICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICB1bnNpZ25lZCBsb25n
IGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQpCi17Ci0gICAgcmVzZXJ2ZV9p
b21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0KTsKLSAg
ICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCA9IElPTU1VX0NPTlRST0xf
RU5BQkxFRDsKKyAgICByZXR1cm4gMDsKIH0KIAogc3RhdGljIHZvaWQgX19p
bml0IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoCkBAIC0xNzcsNiAr
MTgxLDcgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbgogICAgIHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3As
IGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdTsKICAgICB1
bnNpZ25lZCBpbnQgYmRmOworICAgIGludCByYyA9IDA7CiAKICAgICAvKiBp
cyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5nZSBpbnNpZGUgb2YgSU9NTVUgdmly
dHVhbCBhZGRyZXNzIHNwYWNlPyAqLwogICAgIC8qIG5vdGU6ICdsaW1pdCcg
cGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICovCkBA
IC0xOTgsMTAgKzIwMywxNSBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rl
cl9leGNsdXNpb25fcmFuCiAgICAgaWYgKCBsaW1pdCA+PSBpb21tdV90b3Ag
KQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBpb21tdSAp
Ci0gICAgICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZV9h
bGwoaW9tbXUsIGJhc2UsIGxpbWl0KTsKKyAgICAgICAgeworICAgICAgICAg
ICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwg
YmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOworICAg
ICAgICAgICAgaWYgKCByYyApCisgICAgICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1cm4gMDsKKyAgICByZXR1cm4g
cmM7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW5nZV9mb3JfZGV2aWNlKApAQCAtMjEyLDYgKzIyMiw3IEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICB1bnNp
Z25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7CiAgICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CiAgICAgdTE2IHJlcTsKKyAgICBp
bnQgcmMgPSAwOwogCiAgICAgaW9tbXUgPSBmaW5kX2lvbW11X2Zvcl9kZXZp
Y2Uoc2VnLCBiZGYpOwogICAgIGlmICggIWlvbW11ICkKQEAgLTI0MSwxMiAr
MjUyLDEzIEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW4KICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNpb24gcmFuZ2Ug
c2V0dGluZ3MgZm9yIGRldmljZSAqLwogICAgIGlmICggbGltaXQgPj0gaW9t
bXVfdG9wICApCiAgICAgewotICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQpOworICAgICAgICByYyA9
IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBs
aW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmYWxzZSAvKiBhbGwgKi8sIGl3LCBpcik7CiAgICAgICAgIGl2cnNf
bWFwcGluZ3NbYmRmXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gdHJ1ZTsKICAg
ICAgICAgaXZyc19tYXBwaW5nc1tyZXFdLmR0ZV9hbGxvd19leGNsdXNpb24g
PSB0cnVlOwogICAgIH0KIAotICAgIHJldHVybiAwOworICAgIHJldHVybiBy
YzsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbmdlX2Zvcl9pb21tdV9kZXZpY2VzKApAQCAtMjU2LDYgKzI2OCw3IEBA
IHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAg
ICB1bnNpZ25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7
CiAgICAgdW5zaWduZWQgaW50IGJkZjsKICAgICB1MTYgcmVxOworICAgIGlu
dCByYyA9IDA7CiAKICAgICAvKiBpcyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5n
ZSBpbnNpZGUgb2YgSU9NTVUgdmlydHVhbCBhZGRyZXNzIHNwYWNlPyAqLwog
ICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8g
YmUgcGFnZS1hbGlnbmVkICovCkBAIC0yODYsOCArMjk5LDEwIEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KIAogICAgIC8q
IHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwog
ICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkKLSAgICAgICAgcmVzZXJ2
ZV9pb21tdV9leGNsdXNpb25fcmFuZ2VfYWxsKGlvbW11LCBiYXNlLCBsaW1p
dCk7Ci0gICAgcmV0dXJuIDA7CisgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21t
dV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyog
YWxsICovLCBpdywgaXIpOworCisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0
aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9zZWxlY3QoCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-2.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZGV2aWNlIHVuaXR5IG1hcCBoYW5kbGlu
ZwoKQmxpbmRseSBhc3N1bWluZyBhbGwgYWRkcmVzc2VzIGJldHdlZW4gYW55
IHR3byBzdWNoIHJhbmdlcywgc3BlY2lmaWVkIGJ5CmZpcm13YXJlIGluIHRo
ZSBBQ1BJIHRhYmxlcywgc2hvdWxkIGFsc28gYmUgdW5pdHktbWFwcGVkIGNh
bid0IGJlIHJpZ2h0LgpOb3IgY2FuIGl0IGJlIGNvcnJlY3QgdG8gbWVyZ2Ug
cmFuZ2VzIHdpdGggZGlmZmVyaW5nIHBlcm1pc3Npb25zLiBUcmFjawpyYW5n
ZXMgaW5kaXZpZHVhbGx5OyBkb24ndCBtZXJnZSBhdCBhbGwsIGJ1dCBjaGVj
ayBmb3Igb3ZlcmxhcHMgaW5zdGVhZC4KVGhpcyByZXF1aXJlcyBidWJibGlu
ZyB1cCBlcnJvciBpbmRpY2F0b3JzLCBzdWNoIHRoYXQgSU9NTVUgaW5pdCBj
YW4gYmUKZmFpbGVkIHdoZW4gYWxsb2NhdGlvbiBvZiBhIG5ldyB0cmFja2lu
ZyBzdHJ1Y3Qgd2Fzbid0IHBvc3NpYmxlLCBvciBhbgpvdmVybGFwIHdhcyBk
ZXRlY3RlZC4KCkF0IHRoaXMgb2NjYXNpb24gYWxzbyBzdG9wIGlnbm9yaW5n
CmFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoKSdzIHJldHVy
biB2YWx1ZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4IC8gQ1ZFLTIwMjEt
Mjg2OTUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2Uu
ZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQg
PHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdS5oCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdS5oCkBAIC0xMDcsMjAgKzEwNywyNCBAQCBzdHJ1Y3QgYW1kX2lv
bW11IHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGF0c19kZXZpY2VzOwogfTsK
IAorc3RydWN0IGl2cnNfdW5pdHlfbWFwIHsKKyAgICBib29sIHJlYWQ6MTsK
KyAgICBib29sIHdyaXRlOjE7CisgICAgcGFkZHJfdCBhZGRyOworICAgIHVu
c2lnbmVkIGxvbmcgbGVuZ3RoOworICAgIHN0cnVjdCBpdnJzX3VuaXR5X21h
cCAqbmV4dDsKK307CisKIHN0cnVjdCBpdnJzX21hcHBpbmdzIHsKICAgICB1
aW50MTZfdCBkdGVfcmVxdWVzdG9yX2lkOwogICAgIGJvb2wgdmFsaWQ6MTsK
ICAgICBib29sIGR0ZV9hbGxvd19leGNsdXNpb246MTsKLSAgICBib29sIHVu
aXR5X21hcF9lbmFibGU6MTsKLSAgICBib29sIHdyaXRlX3Blcm1pc3Npb246
MTsKLSAgICBib29sIHJlYWRfcGVybWlzc2lvbjoxOwogCiAgICAgLyogaXZo
ZCBkZXZpY2UgZGF0YSBzZXR0aW5ncyAqLwogICAgIHVpbnQ4X3QgZGV2aWNl
X2ZsYWdzOwogCi0gICAgdW5zaWduZWQgbG9uZyBhZGRyX3JhbmdlX3N0YXJ0
OwotICAgIHVuc2lnbmVkIGxvbmcgYWRkcl9yYW5nZV9sZW5ndGg7CiAgICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CisgICAgc3RydWN0IGl2cnNfdW5p
dHlfbWFwICp1bml0eV9tYXA7CiAKICAgICAvKiBwZXIgZGV2aWNlIGludGVy
cnVwdCByZW1hcHBpbmcgdGFibGUgKi8KICAgICB2b2lkICppbnRyZW1hcF90
YWJsZTsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X2FjcGkuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCkBAIC0xNDYsMzIgKzE0Niw0OCBAQCBzdGF0aWMgaW50IF9f
aW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2lvCiAgICAgcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyB2b2lkIF9faW5pdCByZXNlcnZlX3VuaXR5X21hcF9mb3Jf
ZGV2aWNlKAotICAgIHUxNiBzZWcsIHUxNiBiZGYsIHVuc2lnbmVkIGxvbmcg
YmFzZSwKLSAgICB1bnNpZ25lZCBsb25nIGxlbmd0aCwgdTggaXcsIHU4IGly
KQorc3RhdGljIGludCBfX2luaXQgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2Rl
dmljZSgKKyAgICB1aW50MTZfdCBzZWcsIHVpbnQxNl90IGJkZiwgdW5zaWdu
ZWQgbG9uZyBiYXNlLAorICAgIHVuc2lnbmVkIGxvbmcgbGVuZ3RoLCBib29s
IGl3LCBib29sIGlyKQogewogICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICpp
dnJzX21hcHBpbmdzID0gZ2V0X2l2cnNfbWFwcGluZ3Moc2VnKTsKLSAgICB1
bnNpZ25lZCBsb25nIG9sZF90b3AsIG5ld190b3A7CisgICAgc3RydWN0IGl2
cnNfdW5pdHlfbWFwICp1bml0eV9tYXAgPSBpdnJzX21hcHBpbmdzW2JkZl0u
dW5pdHlfbWFwOwogCi0gICAgLyogbmVlZCB0byBleHRlbmQgdW5pdHktbWFw
cGVkIHJhbmdlPyAqLwotICAgIGlmICggaXZyc19tYXBwaW5nc1tiZGZdLnVu
aXR5X21hcF9lbmFibGUgKQorICAgIC8qIENoZWNrIGZvciBvdmVybGFwcy4g
Ki8KKyAgICBmb3IgKCA7IHVuaXR5X21hcDsgdW5pdHlfbWFwID0gdW5pdHlf
bWFwLT5uZXh0ICkKICAgICB7Ci0gICAgICAgIG9sZF90b3AgPSBpdnJzX21h
cHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9zdGFydCArCi0gICAgICAgICAgICBp
dnJzX21hcHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9sZW5ndGg7Ci0gICAgICAg
IG5ld190b3AgPSBiYXNlICsgbGVuZ3RoOwotICAgICAgICBpZiAoIG9sZF90
b3AgPiBuZXdfdG9wICkKLSAgICAgICAgICAgIG5ld190b3AgPSBvbGRfdG9w
OwotICAgICAgICBpZiAoIGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3Jhbmdl
X3N0YXJ0IDwgYmFzZSApCi0gICAgICAgICAgICBiYXNlID0gaXZyc19tYXBw
aW5nc1tiZGZdLmFkZHJfcmFuZ2Vfc3RhcnQ7Ci0gICAgICAgIGxlbmd0aCA9
IG5ld190b3AgLSBiYXNlOwotICAgIH0KLQotICAgIC8qIGV4dGVuZCByL3cg
cGVybWlzc2lvbXMgYW5kIGtlZXAgYWdncmVnYXRlICovCi0gICAgaXZyc19t
YXBwaW5nc1tiZGZdLndyaXRlX3Blcm1pc3Npb24gPSBpdzsKLSAgICBpdnJz
X21hcHBpbmdzW2JkZl0ucmVhZF9wZXJtaXNzaW9uID0gaXI7Ci0gICAgaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcF9lbmFibGUgPSB0cnVlOwotICAg
IGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3JhbmdlX3N0YXJ0ID0gYmFzZTsK
LSAgICBpdnJzX21hcHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9sZW5ndGggPSBs
ZW5ndGg7CisgICAgICAgIC8qCisgICAgICAgICAqIEV4YWN0IG1hdGNoZXMg
YXJlIG9rYXkuIFRoaXMgY2FuIGluIHBhcnRpY3VsYXIgaGFwcGVuIHdoZW4K
KyAgICAgICAgICogcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZp
Y2UoKSBjYWxscyBoZXJlIHR3aWNlIGZvciB0aGUKKyAgICAgICAgICogc2Ft
ZSAocyxiLGQsZikuCisgICAgICAgICAqLworICAgICAgICBpZiAoIGJhc2Ug
PT0gdW5pdHlfbWFwLT5hZGRyICYmIGxlbmd0aCA9PSB1bml0eV9tYXAtPmxl
bmd0aCAmJgorICAgICAgICAgICAgIGlyID09IHVuaXR5X21hcC0+cmVhZCAm
JiBpdyA9PSB1bml0eV9tYXAtPndyaXRlICkKKyAgICAgICAgICAgIHJldHVy
biAwOworCisgICAgICAgIGlmICggdW5pdHlfbWFwLT5hZGRyICsgdW5pdHlf
bWFwLT5sZW5ndGggPiBiYXNlICYmCisgICAgICAgICAgICAgYmFzZSArIGxl
bmd0aCA+IHVuaXR5X21hcC0+YWRkciApCisgICAgICAgIHsKKyAgICAgICAg
ICAgIEFNRF9JT01NVV9ERUJVRygiSVZNRCBFcnJvcjogb3ZlcmxhcCBbJWx4
LCVseCkgdnMgWyVseCwlbHgpXG4iLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJhc2UsIGJhc2UgKyBsZW5ndGgsIHVuaXR5X21hcC0+YWRkciwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPmFkZHIg
KyB1bml0eV9tYXAtPmxlbmd0aCk7CisgICAgICAgICAgICByZXR1cm4gLUVQ
RVJNOworICAgICAgICB9CisgICAgfQorCisgICAgLyogUG9wdWxhdGUgYW5k
IGluc2VydCBhIG5ldyB1bml0eSBtYXAuICovCisgICAgdW5pdHlfbWFwID0g
eG1hbGxvYyhzdHJ1Y3QgaXZyc191bml0eV9tYXApOworICAgIGlmICggIXVu
aXR5X21hcCApCisgICAgICAgIHJldHVybiAtRU5PTUVNOworCisgICAgdW5p
dHlfbWFwLT5yZWFkID0gaXI7CisgICAgdW5pdHlfbWFwLT53cml0ZSA9IGl3
OworICAgIHVuaXR5X21hcC0+YWRkciA9IGJhc2U7CisgICAgdW5pdHlfbWFw
LT5sZW5ndGggPSBsZW5ndGg7CisgICAgdW5pdHlfbWFwLT5uZXh0ID0gaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcDsKKyAgICBpdnJzX21hcHBpbmdz
W2JkZl0udW5pdHlfbWFwID0gdW5pdHlfbWFwOworCisgICAgcmV0dXJuIDA7
CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9y
YW5nZV9mb3JfYWxsX2RldmljZXMoCkBAIC0xOTQsMTMgKzIxMCwxMyBAQCBz
dGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAg
ICAgIGxlbmd0aCA9IHJhbmdlX3RvcCAtIGJhc2U7CiAgICAgICAgIC8qIHJl
c2VydmUgci93IHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmlj
ZXMgKi8KICAgICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFy
dCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIGZvciAoIGJk
ZiA9IDA7IGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKLSAgICAg
ICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYs
IGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsKKyAgICAgICAgZm9yICggYmRmID0g
MDsgIXJjICYmIGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKKyAg
ICAgICAgICAgIHJjID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShz
ZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOwogICAgICAgICAvKiBw
dXNoICdiYXNlJyBqdXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNw
YWNlICovCiAgICAgICAgIGJhc2UgPSBpb21tdV90b3A7CiAgICAgfQogICAg
IC8qIHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAq
LwotICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkKKyAgICBpZiAoICFy
YyAmJiBsaW1pdCA+PSBpb21tdV90b3AgKQogICAgIHsKICAgICAgICAgZm9y
X2VhY2hfYW1kX2lvbW11KCBpb21tdSApCiAgICAgICAgIHsKQEAgLTI0Miwx
NSArMjU4LDE1IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1
c2lvbl9yYW4KICAgICAgICAgbGVuZ3RoID0gcmFuZ2VfdG9wIC0gYmFzZTsK
ICAgICAgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVz
IGZvciBkZXZpY2UgKi8KICAgICAgICAgLyogbm90ZTogdGhlc2UgZW50cmll
cyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAg
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2Us
IGxlbmd0aCwgaXcsIGlyKTsKLSAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBf
Zm9yX2RldmljZShzZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOwor
ICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2Vn
LCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKSA/OgorICAgICAgICAgICAg
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCByZXEsIGJhc2Us
IGxlbmd0aCwgaXcsIGlyKTsKIAogICAgICAgICAvKiBwdXNoICdiYXNlJyBq
dXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCiAgICAg
ICAgIGJhc2UgPSBpb21tdV90b3A7CiAgICAgfQogCiAgICAgLyogcmVnaXN0
ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzIGZvciBkZXZpY2Ug
Ki8KLSAgICBpZiAoIGxpbWl0ID49IGlvbW11X3RvcCAgKQorICAgIGlmICgg
IXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCAgKQogICAgIHsKICAgICAgICAg
cmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFz
ZSwgbGltaXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZmFsc2UgLyogYWxsICovLCBpdywgaXIpOwpAQCAtMjgxLDE1
ICsyOTcsMTUgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVz
aW9uX3JhbgogICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwog
ICAgICAgICAvKiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRy
aWVzIGZvciBkZXZpY2VzICovCiAgICAgICAgIC8qIG5vdGU6IHRoZXNlIGVu
dHJpZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAg
ICAgICBmb3IgKCBiZGYgPSAwOyBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBi
ZGYrKyApCisgICAgICAgIGZvciAoIGJkZiA9IDA7ICFyYyAmJiBiZGYgPCBp
dnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIGlmICggaW9tbXUgPT0gZmluZF9pb21tdV9mb3JfZGV2aWNlKGlvbW11
LT5zZWcsIGJkZikgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAg
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRm
LCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpdywgaXIpOwogICAgICAgICAgICAgICAgIHJl
cSA9IGdldF9pdnJzX21hcHBpbmdzKGlvbW11LT5zZWcpW2JkZl0uZHRlX3Jl
cXVlc3Rvcl9pZDsKLSAgICAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21h
cF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aXcsIGlyKTsKKyAgICAgICAgICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlf
bWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGl3LCBpcikgPzoKKyAgICAgICAgICAgICAgICAgICAgIHJlc2Vy
dmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgcmVxLCBiYXNl
LCBsZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGl3LCBpcik7CiAgICAgICAgICAgICB9CiAgICAg
ICAgIH0KIApAQCAtMjk4LDcgKzMxNCw3IEBAIHN0YXRpYyBpbnQgX19pbml0
IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICB9CiAKICAgICAvKiByZWdp
c3RlciBJT01NVSBleGNsdXNpb24gcmFuZ2Ugc2V0dGluZ3MgKi8KLSAgICBp
ZiAoIGxpbWl0ID49IGlvbW11X3RvcCApCisgICAgaWYgKCAhcmMgJiYgbGlt
aXQgPj0gaW9tbXVfdG9wICkKICAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBh
bGwgKi8sIGl3LCBpcik7CiAKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0zNjYsMTUgKzM2Niwx
NyBAQCBzdGF0aWMgaW50IGFtZF9pb21tdV9hc3NpZ25fZGV2aWNlKHN0cnVj
CiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBn
ZXRfaXZyc19tYXBwaW5ncyhwZGV2LT5zZWcpOwogICAgIGludCBiZGYgPSBQ
Q0lfQkRGMihwZGV2LT5idXMsIGRldmZuKTsKICAgICBpbnQgcmVxX2lkID0g
Z2V0X2RtYV9yZXF1ZXN0b3JfaWQocGRldi0+c2VnLCBiZGYpOworICAgIGNv
bnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwOwogCi0gICAg
aWYgKCBpdnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwX2VuYWJsZSAp
CisgICAgZm9yICggdW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRd
LnVuaXR5X21hcDsgdW5pdHlfbWFwOworICAgICAgICAgIHVuaXR5X21hcCA9
IHVuaXR5X21hcC0+bmV4dCApCiAgICAgewotICAgICAgICBhbWRfaW9tbXVf
cmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKAotICAgICAgICAgICAgZCwKLSAg
ICAgICAgICAgIGl2cnNfbWFwcGluZ3NbcmVxX2lkXS5hZGRyX3JhbmdlX3N0
YXJ0LAotICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFfaWRdLmFkZHJf
cmFuZ2VfbGVuZ3RoLAotICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFf
aWRdLndyaXRlX3Blcm1pc3Npb24sCi0gICAgICAgICAgICBpdnJzX21hcHBp
bmdzW3JlcV9pZF0ucmVhZF9wZXJtaXNzaW9uKTsKKyAgICAgICAgaW50IHJj
ID0gYW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAg
ICAgICAgICAgICAgICAgIGQsIHVuaXR5X21hcC0+YWRkciwgdW5pdHlfbWFw
LT5sZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPndy
aXRlLCB1bml0eV9tYXAtPnJlYWQpOworCisgICAgICAgIGlmICggcmMgKQor
ICAgICAgICAgICAgcmV0dXJuIHJjOwogICAgIH0KIAogICAgIHJldHVybiBy
ZWFzc2lnbl9kZXZpY2UocGRldi0+ZG9tYWluLCBkLCBkZXZmbiwgcGRldik7
Cg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-3.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogYWxzbyBwYXNzIHAybV9hY2Nlc3NfdCB0byBwMm1fZ2V0X2lv
bW11X2ZsYWdzKCkKCkEgc3Vic2VxdWVudCBjaGFuZ2Ugd2lsbCB3YW50IHRv
IGN1c3RvbWl6ZSB0aGUgSU9NTVUgcGVybWlzc2lvbnMgYmFzZWQKb24gdGhp
cy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTY4MCw3ICs2ODAsNyBAQCBlcHRfc2V0X2VudHJ5KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sIGdmCiAgICAgdWludDhfdCBpcGF0ID0gMDsKICAg
ICBib29sX3QgbmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMTsKICAgICBib29s
X3QgdnRkX3B0ZV9wcmVzZW50ID0gMDsKLSAgICB1bnNpZ25lZCBpbnQgaW9t
bXVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIG1mbik7Cisg
ICAgdW5zaWduZWQgaW50IGlvbW11X2ZsYWdzID0gcDJtX2dldF9pb21tdV9m
bGFncyhwMm10LCBwMm1hLCBtZm4pOwogICAgIGJvb2xfdCBuZWVkc19zeW5j
ID0gMTsKICAgICBlcHRfZW50cnlfdCBvbGRfZW50cnkgPSB7IC5lcHRlID0g
MCB9OwogICAgIGVwdF9lbnRyeV90IG5ld19lbnRyeSA9IHsgLmVwdGUgPSAw
IH07CkBAIC04MDgsOCArODA4LDggQEAgZXB0X3NldF9lbnRyeShzdHJ1Y3Qg
cDJtX2RvbWFpbiAqcDJtLCBnZgogCiAgICAgICAgIC8qIFNhZmUgdG8gcmVh
ZC10aGVuLXdyaXRlIGJlY2F1c2Ugd2UgaG9sZCB0aGUgcDJtIGxvY2sgKi8K
ICAgICAgICAgaWYgKCBlcHRfZW50cnktPm1mbiA9PSBuZXdfZW50cnkubWZu
ICYmCi0gICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhlcHRfZW50
cnktPnNhX3AybXQsIF9tZm4oZXB0X2VudHJ5LT5tZm4pKSA9PQotICAgICAg
ICAgICAgIGlvbW11X2ZsYWdzICkKKyAgICAgICAgICAgICBwMm1fZ2V0X2lv
bW11X2ZsYWdzKGVwdF9lbnRyeS0+c2FfcDJtdCwgZXB0X2VudHJ5LT5hY2Nl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWZuKGVw
dF9lbnRyeS0+bWZuKSkgPT0gaW9tbXVfZmxhZ3MgKQogICAgICAgICAgICAg
bmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMDsKIAogICAgICAgICBlcHRfcDJt
X3R5cGVfdG9fZmxhZ3MocDJtLCAmbmV3X2VudHJ5KTsKLS0tIGEveGVuL2Fy
Y2gveDg2L21tL3AybS1wdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0t
cHQuYwpAQCAtNDgwLDYgKzQ4MCwxNiBAQCBpbnQgcDJtX3B0X2hhbmRsZV9k
ZWZlcnJlZF9jaGFuZ2VzKHVpbnQ2CiAgICAgcmV0dXJuIHJjOwogfQogCisv
KiBSZWNvbnN0cnVjdCBhIGZha2UgcDJtX2FjY2Vzc190IGZyb20gc3RvcmVk
IFBURSBmbGFncy4gKi8KK3N0YXRpYyBwMm1fYWNjZXNzX3QgcDJtX2ZsYWdz
X3RvX2FjY2Vzcyh1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisgICAgaWYgKCBm
bGFncyAmIF9QQUdFX1BSRVNFTlQgKQorICAgICAgICByZXR1cm4gcDJtX2Fj
Y2Vzc19uOworCisgICAgLyogTm8gbmVlZCB0byBsb29rIGF0IF9QQUdFX05Y
IGZvciBub3cuICovCisgICAgcmV0dXJuIGZsYWdzICYgX1BBR0VfUlcgPyBw
Mm1fYWNjZXNzX3J3IDogcDJtX2FjY2Vzc19yOworfQorCiAvKiBDaGVja3Mg
b25seSBhcHBsaWNhYmxlIHRvIGVudHJpZXMgd2l0aCBvcmRlciA+IFBBR0Vf
T1JERVJfNEsgKi8KIHN0YXRpYyB2b2lkIGNoZWNrX2VudHJ5KG1mbl90IG1m
biwgcDJtX3R5cGVfdCBuZXcsIHAybV90eXBlX3Qgb2xkLAogICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKQpAQCAtNTE0LDcg
KzUyNCw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4g
KnAybSwKICAgICBsMl9wZ2VudHJ5X3QgbDJlX2NvbnRlbnQ7CiAgICAgbDNf
cGdlbnRyeV90IGwzZV9jb250ZW50OwogICAgIGludCByYzsKLSAgICB1bnNp
Z25lZCBpbnQgaW9tbXVfcHRlX2ZsYWdzID0gcDJtX2dldF9pb21tdV9mbGFn
cyhwMm10LCBtZm4pOworICAgIHVuc2lnbmVkIGludCBpb21tdV9wdGVfZmxh
Z3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIHAybWEsIG1mbik7CiAg
ICAgLyoKICAgICAgKiBvbGRfbWZuIGFuZCBpb21tdV9vbGRfZmxhZ3MgY29u
dHJvbCBwb3NzaWJsZSBmbHVzaC91cGRhdGUgbmVlZHMgb24gdGhlCiAgICAg
ICogSU9NTVU6IFdlIG5lZWQgdG8gZmx1c2ggd2hlbiBNRk4gb3IgZmxhZ3Mg
KGkuZS4gcGVybWlzc2lvbnMpIGNoYW5nZS4KQEAgLTU3Nyw2ICs1ODcsNyBA
QCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAg
ICAgICAgICAgICAgICAgb2xkX21mbiA9IGwxZV9nZXRfcGZuKCpwMm1fZW50
cnkpOwogICAgICAgICAgICAgICAgIGlvbW11X29sZF9mbGFncyA9CiAgICAg
ICAgICAgICAgICAgICAgIHAybV9nZXRfaW9tbXVfZmxhZ3MocDJtX2ZsYWdz
X3RvX3R5cGUoZmxhZ3MpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAybV9mbGFnc190b19hY2Nlc3MoZmxhZ3MpLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZm4ob2xk
X21mbikpOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgZWxzZQpAQCAt
NjE5LDkgKzYzMCwxMCBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1f
ZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDAsIEwxX1BBR0VUQUJMRV9FTlRSSUVTKTsKICAgICAgICAgQVNTRVJU
KHAybV9lbnRyeSk7CiAgICAgICAgIG9sZF9tZm4gPSBsMWVfZ2V0X3Bmbigq
cDJtX2VudHJ5KTsKKyAgICAgICAgZmxhZ3MgPSBsMWVfZ2V0X2ZsYWdzKCpw
Mm1fZW50cnkpOwogICAgICAgICBpb21tdV9vbGRfZmxhZ3MgPQotICAgICAg
ICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxhZ3NfdG9fdHlwZShs
MWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkpKSwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7CisgICAgICAgICAgICBw
Mm1fZ2V0X2lvbW11X2ZsYWdzKHAybV9mbGFnc190b190eXBlKGZsYWdzKSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2ZsYWdzX3Rv
X2FjY2VzcyhmbGFncyksIF9tZm4ob2xkX21mbikpOwogCiAgICAgICAgIGlm
ICggbWZuX3ZhbGlkKG1mbikgfHwgcDJtX2FsbG93c19pbnZhbGlkX21mbihw
Mm10KSApCiAgICAgICAgICAgICBlbnRyeV9jb250ZW50ID0gcDJtX2wxZV9m
cm9tX3BmbihtZm5feChtZm4pLApAQCAtNjQ5LDYgKzY2MSw3IEBAIHAybV9w
dF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4gKnAybSwKICAgICAgICAg
ICAgICAgICBvbGRfbWZuID0gbDFlX2dldF9wZm4oKnAybV9lbnRyeSk7CiAg
ICAgICAgICAgICAgICAgaW9tbXVfb2xkX2ZsYWdzID0KICAgICAgICAgICAg
ICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxhZ3NfdG9fdHlw
ZShmbGFncyksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyksCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7
CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlCi0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9wMm0uaApAQCAtOTAzLDcgKzkwMyw4IEBAIHN0YXRpYyBpbmxpbmUgdm9p
ZCBwMm1fYWx0cDJtX2NoZWNrKHN0cnUKIC8qCiAgKiBwMm0gdHlwZSB0byBJ
T01NVSBmbGFncwogICovCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBw
Mm1fZ2V0X2lvbW11X2ZsYWdzKHAybV90eXBlX3QgcDJtdCwgbWZuX3QgbWZu
KQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJtX2dldF9pb21tdV9m
bGFncyhwMm1fdHlwZV90IHAybXQsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9hY2Nlc3NfdCBwMm1hLCBt
Zm5fdCBtZm4pCiB7CiAgICAgdW5zaWduZWQgaW50IGZsYWdzOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-4.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogZ2VuZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVk
IFJNUlIgcmVnaW9ucwoKSW4gb3JkZXIgdG8gcmUtdXNlIGl0IGVsc2V3aGVy
ZSwgbW92ZSB0aGUgbG9naWMgdG8gdmVuZG9yIGluZGVwZW5kZW50CmNvZGUg
YW5kIHN0cmlwIGl0IG9mIFJNUlIgc3BlY2lmaWNzLgoKTm90ZSB0aGF0IHRo
ZSBwcmlvciAibWFwIiBwYXJhbWV0ZXIgZ2V0cyBmb2xkZWQgaW50byB0aGUg
bmV3ICJwMm1hIiBvbmUKKHdoaWNoIEFNRCBJT01NVSBjb2RlIHdpbGwgd2Fu
dCB0byBtYWtlIHVzZSBvZiksIGFzc2lnbmluZyBhbHRlcm5hdGl2ZQptZWFu
aW5nICgidW5tYXAiKSB0byBwMm1fYWNjZXNzX3guIFByZXBhcmUgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpIGFuZApwMm1fZ2V0X2lvbW11X2ZsYWdzKCkg
Zm9yIGdldHRpbmcgcGFzc2VkIGFjY2VzcyB0eXBlcyBvdGhlciB0aGFuCnAy
bV9hY2Nlc3NfcncgKGluIHRoZSBsYXR0ZXIgY2FzZSBqdXN0IGZvciBwMm1f
bW1pb19kaXJlY3QgcmVxdWVzdHMpLgoKTm90ZSBhbHNvIHRoYXQsIHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUsIGFuIG92ZXJsYXAgY2hlY2sgZ2V0cyBhZGRl
ZCB0bwp0aGUgbWFpbiBsb29wIG9mIGlvbW11X2lkZW50aXR5X21hcHBpbmco
KS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0x
MzUzLDcgKzEzNTMsNyBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShz
dHJ1Y3QgZG9tYWluCiAgICAgICAgIGlmICggIWlzX2lvbW11X2VuYWJsZWQo
ZCkgKQogICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgIHJldHVybiBp
b21tdV9sZWdhY3lfbWFwKGQsIF9kZm4oZ2ZuX2wpLCBfbWZuKGdmbl9sKSwg
UEFHRV9PUkRFUl80SywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVGX3JlYWRhYmxlIHwgSU9NTVVGX3dyaXRhYmxlKTsKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2FjY2Vzc190b19pb21t
dV9mbGFncyhwMm1hKSk7CiAgICAgfQogCiAgICAgZ2ZuX2xvY2socDJtLCBn
Zm4sIDApOwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUu
YwpAQCAtNDIsMTIgKzQyLDYgQEAKICNpbmNsdWRlICJ2dGQuaCIKICNpbmNs
dWRlICIuLi9hdHMuaCIKIAotc3RydWN0IG1hcHBlZF9ybXJyIHsKLSAgICBz
dHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Ci0gICAgdTY0IGJhc2UsIGVuZDsKLSAg
ICB1bnNpZ25lZCBpbnQgY291bnQ7Ci19OwotCiAvKiBQb3NzaWJsZSB1bmZp
bHRlcmVkIExBUElDL01TSSBtZXNzYWdlcyBmcm9tIHVudHJ1c3RlZCBzb3Vy
Y2VzPyAqLwogYm9vbCBfX3JlYWRfbW9zdGx5IHVudHJ1c3RlZF9tc2k7CiAK
QEAgLTE4MDAsMTcgKzE3OTQsMTIgQEAgb3V0Ogogc3RhdGljIHZvaWQgaW9t
bXVfZG9tYWluX3RlYXJkb3duKHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAg
c3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0gICAg
c3RydWN0IG1hcHBlZF9ybXJyICptcm1yciwgKnRtcDsKICAgICBjb25zdCBz
dHJ1Y3QgYWNwaV9kcmhkX3VuaXQgKmRyaGQ7CiAKICAgICBpZiAoIGxpc3Rf
ZW1wdHkoJmFjcGlfZHJoZF91bml0cykgKQogICAgICAgICByZXR1cm47CiAK
LSAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUgKCBtcm1yciwgdG1wLCAm
aGQtPmFyY2gubWFwcGVkX3JtcnJzLCBsaXN0ICkKLSAgICB7Ci0gICAgICAg
IGxpc3RfZGVsKCZtcm1yci0+bGlzdCk7Ci0gICAgICAgIHhmcmVlKG1ybXJy
KTsKLSAgICB9CisgICAgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKGQp
OwogCiAgICAgQVNTRVJUKGlzX2lvbW11X2VuYWJsZWQoZCkpOwogCkBAIC0x
OTY2LDc0ICsxOTU1LDYgQEAgc3RhdGljIHZvaWQgaW9tbXVfc2V0X3BnZChz
dHJ1Y3QgZG9tYWluCiAgICAgICAgIHBhZ2V0YWJsZV9nZXRfcGFkZHIocGFn
ZXRhYmxlX2Zyb21fbWZuKHBnZF9tZm4pKTsKIH0KIAotc3RhdGljIGludCBy
bXJyX2lkZW50aXR5X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZCwgYm9vbF90
IG1hcCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBhY3BpX3JtcnJfdW5pdCAqcm1yciwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHUzMiBmbGFnKQotewotICAgIHVuc2lnbmVk
IGxvbmcgYmFzZV9wZm4gPSBybXJyLT5iYXNlX2FkZHJlc3MgPj4gUEFHRV9T
SElGVF80SzsKLSAgICB1bnNpZ25lZCBsb25nIGVuZF9wZm4gPSBQQUdFX0FM
SUdOXzRLKHJtcnItPmVuZF9hZGRyZXNzKSA+PiBQQUdFX1NISUZUXzRLOwot
ICAgIHN0cnVjdCBtYXBwZWRfcm1yciAqbXJtcnI7Ci0gICAgc3RydWN0IGRv
bWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0KLSAgICBBU1NFUlQo
cGNpZGV2c19sb2NrZWQoKSk7Ci0gICAgQVNTRVJUKHJtcnItPmJhc2VfYWRk
cmVzcyA8IHJtcnItPmVuZF9hZGRyZXNzKTsKLQotICAgIC8qCi0gICAgICog
Tm8gbmVlZCB0byBhY3F1aXJlIGhkLT5hcmNoLm1hcHBpbmdfbG9jazogQm90
aCBpbnNlcnRpb24gYW5kIHJlbW92YWwKLSAgICAgKiBnZXQgZG9uZSB3aGls
ZSBob2xkaW5nIHBjaWRldnNfbG9jay4KLSAgICAgKi8KLSAgICBsaXN0X2Zv
cl9lYWNoX2VudHJ5KCBtcm1yciwgJmhkLT5hcmNoLm1hcHBlZF9ybXJycywg
bGlzdCApCi0gICAgewotICAgICAgICBpZiAoIG1ybXJyLT5iYXNlID09IHJt
cnItPmJhc2VfYWRkcmVzcyAmJgotICAgICAgICAgICAgIG1ybXJyLT5lbmQg
PT0gcm1yci0+ZW5kX2FkZHJlc3MgKQotICAgICAgICB7Ci0gICAgICAgICAg
ICBpbnQgcmV0ID0gMDsKLQotICAgICAgICAgICAgaWYgKCBtYXAgKQotICAg
ICAgICAgICAgewotICAgICAgICAgICAgICAgICsrbXJtcnItPmNvdW50Owot
ICAgICAgICAgICAgICAgIHJldHVybiAwOwotICAgICAgICAgICAgfQotCi0g
ICAgICAgICAgICBpZiAoIC0tbXJtcnItPmNvdW50ICkKLSAgICAgICAgICAg
ICAgICByZXR1cm4gMDsKLQotICAgICAgICAgICAgd2hpbGUgKCBiYXNlX3Bm
biA8IGVuZF9wZm4gKQotICAgICAgICAgICAgewotICAgICAgICAgICAgICAg
IGlmICggY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KGQsIGJhc2VfcGZuKSAp
Ci0gICAgICAgICAgICAgICAgICAgIHJldCA9IC1FTlhJTzsKLSAgICAgICAg
ICAgICAgICBiYXNlX3BmbisrOwotICAgICAgICAgICAgfQotCi0gICAgICAg
ICAgICBsaXN0X2RlbCgmbXJtcnItPmxpc3QpOwotICAgICAgICAgICAgeGZy
ZWUobXJtcnIpOwotICAgICAgICAgICAgcmV0dXJuIHJldDsKLSAgICAgICAg
fQotICAgIH0KLQotICAgIGlmICggIW1hcCApCi0gICAgICAgIHJldHVybiAt
RU5PRU5UOwotCi0gICAgd2hpbGUgKCBiYXNlX3BmbiA8IGVuZF9wZm4gKQot
ICAgIHsKLSAgICAgICAgaW50IGVyciA9IHNldF9pZGVudGl0eV9wMm1fZW50
cnkoZCwgYmFzZV9wZm4sIHAybV9hY2Nlc3NfcncsIGZsYWcpOwotCi0gICAg
ICAgIGlmICggZXJyICkKLSAgICAgICAgICAgIHJldHVybiBlcnI7Ci0gICAg
ICAgIGJhc2VfcGZuKys7Ci0gICAgfQotCi0gICAgbXJtcnIgPSB4bWFsbG9j
KHN0cnVjdCBtYXBwZWRfcm1ycik7Ci0gICAgaWYgKCAhbXJtcnIgKQotICAg
ICAgICByZXR1cm4gLUVOT01FTTsKLSAgICBtcm1yci0+YmFzZSA9IHJtcnIt
PmJhc2VfYWRkcmVzczsKLSAgICBtcm1yci0+ZW5kID0gcm1yci0+ZW5kX2Fk
ZHJlc3M7Ci0gICAgbXJtcnItPmNvdW50ID0gMTsKLSAgICBsaXN0X2FkZF90
YWlsKCZtcm1yci0+bGlzdCwgJmhkLT5hcmNoLm1hcHBlZF9ybXJycyk7Ci0K
LSAgICByZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpbnRlbF9pb21tdV9h
ZGRfZGV2aWNlKHU4IGRldmZuLCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKIHsK
ICAgICBzdHJ1Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnI7CkBAIC0yMDY1LDcg
KzE5ODYsOSBAQCBzdGF0aWMgaW50IGludGVsX2lvbW11X2FkZF9kZXZpY2Uo
dTggZGV2CiAgICAgICAgICAgICAgKiBTaW5jZSBSTVJScyBhcmUgYWx3YXlz
IHJlc2VydmVkIGluIHRoZSBlODIwIG1hcCBmb3IgdGhlIGhhcmR3YXJlCiAg
ICAgICAgICAgICAgKiBkb21haW4sIHRoZXJlIHNob3VsZG4ndCBiZSBhIGNv
bmZsaWN0LgogICAgICAgICAgICAgICovCi0gICAgICAgICAgICByZXQgPSBy
bXJyX2lkZW50aXR5X21hcHBpbmcocGRldi0+ZG9tYWluLCAxLCBybXJyLCAw
KTsKKyAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50aXR5X21hcHBpbmco
cGRldi0+ZG9tYWluLCBwMm1fYWNjZXNzX3J3LAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5iYXNlX2FkZHJlc3Ms
IHJtcnItPmVuZF9hZGRyZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAwKTsKICAgICAgICAgICAgIGlmICggcmV0ICkK
ICAgICAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIgVlREUFJFRklY
LCAiZCVkOiBSTVJSIG1hcHBpbmcgZmFpbGVkXG4iLAogICAgICAgICAgICAg
ICAgICAgICAgICAgcGRldi0+ZG9tYWluLT5kb21haW5faWQpOwpAQCAtMjEx
MCw3ICsyMDMzLDggQEAgc3RhdGljIGludCBpbnRlbF9pb21tdV9yZW1vdmVf
ZGV2aWNlKHU4CiAgICAgICAgICAqIEFueSBmbGFnIGlzIG5vdGhpbmcgdG8g
Y2xlYXIgdGhlc2UgbWFwcGluZ3MgYnV0IGhlcmUKICAgICAgICAgICogaXRz
IGFsd2F5cyBzYWZlIGFuZCBzdHJpY3QgdG8gc2V0IDAuCiAgICAgICAgICAq
LwotICAgICAgICBybXJyX2lkZW50aXR5X21hcHBpbmcocGRldi0+ZG9tYWlu
LCAwLCBybXJyLCAwKTsKKyAgICAgICAgaW9tbXVfaWRlbnRpdHlfbWFwcGlu
ZyhwZGV2LT5kb21haW4sIHAybV9hY2Nlc3NfeCwgcm1yci0+YmFzZV9hZGRy
ZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnItPmVu
ZF9hZGRyZXNzLCAwKTsKICAgICB9CiAKICAgICByZXR1cm4gZG9tYWluX2Nv
bnRleHRfdW5tYXAocGRldi0+ZG9tYWluLCBkZXZmbiwgcGRldik7CkBAIC0y
MzA5LDcgKzIyMzMsOCBAQCBzdGF0aWMgdm9pZCBfX2h3ZG9tX2luaXQgc2V0
dXBfaHdkb21fcm1yCiAgICAgICAgICAqIGRvbWFpbiwgdGhlcmUgc2hvdWxk
bid0IGJlIGEgY29uZmxpY3QuIFNvIGl0cyBhbHdheXMgc2FmZSBhbmQKICAg
ICAgICAgICogc3RyaWN0IHRvIHNldCAwLgogICAgICAgICAgKi8KLSAgICAg
ICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKGQsIDEsIHJtcnIsIDAp
OworICAgICAgICByZXQgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKGQsIHAy
bV9hY2Nlc3NfcncsIHJtcnItPmJhc2VfYWRkcmVzcywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5lbmRfYWRkcmVzcywg
MCk7CiAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgIGRwcmludGso
WEVOTE9HX0VSUiBWVERQUkVGSVgsCiAgICAgICAgICAgICAgICAgICAgICAi
SU9NTVU6IG1hcHBpbmcgcmVzZXJ2ZWQgcmVnaW9uIGZhaWxlZFxuIik7CkBA
IC0yNDgwLDcgKzI0MDUsOSBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2Rldmlj
ZV9vd25lcnNoaXAoCiAgICAgICAgICAgICAgICAgICogQW55IFJNUlIgZmxh
ZyBpcyBhbHdheXMgaWdub3JlZCB3aGVuIHJlbW92ZSBhIGRldmljZSwKICAg
ICAgICAgICAgICAgICAgKiBidXQgaXRzIGFsd2F5cyBzYWZlIGFuZCBzdHJp
Y3QgdG8gc2V0IDAuCiAgICAgICAgICAgICAgICAgICovCi0gICAgICAgICAg
ICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKHNvdXJjZSwgMCwg
cm1yciwgMCk7CisgICAgICAgICAgICAgICAgcmV0ID0gaW9tbXVfaWRlbnRp
dHlfbWFwcGluZyhzb3VyY2UsIHAybV9hY2Nlc3NfeCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnItPmJhc2Vf
YWRkcmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJtcnItPmVuZF9hZGRyZXNzLCAwKTsKICAgICAgICAgICAg
ICAgICBpZiAoIHJldCAhPSAtRU5PRU5UICkKICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgIH0KQEAgLTI1NzcsNyArMjUw
NCw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfYXNzaWduX2RldmljZSgK
ICAgICAgICAgICAgICBQQ0lfQlVTKGJkZikgPT0gYnVzICYmCiAgICAgICAg
ICAgICAgUENJX0RFVkZOMihiZGYpID09IGRldmZuICkKICAgICAgICAgewot
ICAgICAgICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKGQsIDEs
IHJtcnIsIGZsYWcpOworICAgICAgICAgICAgcmV0ID0gaW9tbXVfaWRlbnRp
dHlfbWFwcGluZyhkLCBwMm1fYWNjZXNzX3J3LCBybXJyLT5iYXNlX2FkZHJl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJtcnItPmVuZF9hZGRyZXNzLCBmbGFnKTsKICAgICAgICAgICAgIGlmICgg
cmV0ICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBpbnQgcmM7
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5jCisr
KyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5jCkBAIC0x
MzksNyArMTM5LDcgQEAgaW50IGFyY2hfaW9tbXVfZG9tYWluX2luaXQoc3Ry
dWN0IGRvbWFpbgogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOwogCiAgICAgc3Bpbl9sb2NrX2luaXQoJmhkLT5hcmNoLm1h
cHBpbmdfbG9jayk7Ci0gICAgSU5JVF9MSVNUX0hFQUQoJmhkLT5hcmNoLm1h
cHBlZF9ybXJycyk7CisgICAgSU5JVF9MSVNUX0hFQUQoJmhkLT5hcmNoLmlk
ZW50aXR5X21hcHMpOwogCiAgICAgcmV0dXJuIDA7CiB9CkBAIC0xNDgsNiAr
MTQ4LDk5IEBAIHZvaWQgYXJjaF9pb21tdV9kb21haW5fZGVzdHJveShzdHJ1
Y3QgZG8KIHsKIH0KIAorc3RydWN0IGlkZW50aXR5X21hcCB7CisgICAgc3Ry
dWN0IGxpc3RfaGVhZCBsaXN0OworICAgIHBhZGRyX3QgYmFzZSwgZW5kOwor
ICAgIHAybV9hY2Nlc3NfdCBhY2Nlc3M7CisgICAgdW5zaWduZWQgaW50IGNv
dW50OworfTsKKworaW50IGlvbW11X2lkZW50aXR5X21hcHBpbmcoc3RydWN0
IGRvbWFpbiAqZCwgcDJtX2FjY2Vzc190IHAybWEsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgZW5kLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWcpCit7
CisgICAgdW5zaWduZWQgbG9uZyBiYXNlX3BmbiA9IGJhc2UgPj4gUEFHRV9T
SElGVF80SzsKKyAgICB1bnNpZ25lZCBsb25nIGVuZF9wZm4gPSBQQUdFX0FM
SUdOXzRLKGVuZCkgPj4gUEFHRV9TSElGVF80SzsKKyAgICBzdHJ1Y3QgaWRl
bnRpdHlfbWFwICptYXA7CisgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQg
PSBkb21faW9tbXUoZCk7CisKKyAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQo
KSk7CisgICAgQVNTRVJUKGJhc2UgPCBlbmQpOworCisgICAgLyoKKyAgICAg
KiBObyBuZWVkIHRvIGFjcXVpcmUgaGQtPmFyY2gubWFwcGluZ19sb2NrOiBC
b3RoIGluc2VydGlvbiBhbmQgcmVtb3ZhbAorICAgICAqIGdldCBkb25lIHdo
aWxlIGhvbGRpbmcgcGNpZGV2c19sb2NrLgorICAgICAqLworICAgIGxpc3Rf
Zm9yX2VhY2hfZW50cnkoIG1hcCwgJmhkLT5hcmNoLmlkZW50aXR5X21hcHMs
IGxpc3QgKQorICAgIHsKKyAgICAgICAgaWYgKCBtYXAtPmJhc2UgPT0gYmFz
ZSAmJiBtYXAtPmVuZCA9PSBlbmQgKQorICAgICAgICB7CisgICAgICAgICAg
ICBpbnQgcmV0ID0gMDsKKworICAgICAgICAgICAgaWYgKCBwMm1hICE9IHAy
bV9hY2Nlc3NfeCApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAg
aWYgKCBtYXAtPmFjY2VzcyAhPSBwMm1hICkKKyAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIC1FQUREUklOVVNFOworICAgICAgICAgICAgICAgICsrbWFw
LT5jb3VudDsKKyAgICAgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAg
ICAgIH0KKworICAgICAgICAgICAgaWYgKCAtLW1hcC0+Y291bnQgKQorICAg
ICAgICAgICAgICAgIHJldHVybiAwOworCisgICAgICAgICAgICB3aGlsZSAo
IGJhc2VfcGZuIDwgZW5kX3BmbiApCisgICAgICAgICAgICB7CisgICAgICAg
ICAgICAgICAgaWYgKCBjbGVhcl9pZGVudGl0eV9wMm1fZW50cnkoZCwgYmFz
ZV9wZm4pICkKKyAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVOWElPOwor
ICAgICAgICAgICAgICAgIGJhc2VfcGZuKys7CisgICAgICAgICAgICB9CisK
KyAgICAgICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3QpOworICAgICAgICAg
ICAgeGZyZWUobWFwKTsKKworICAgICAgICAgICAgcmV0dXJuIHJldDsKKyAg
ICAgICAgfQorCisgICAgICAgIGlmICggZW5kID49IG1hcC0+YmFzZSAmJiBt
YXAtPmVuZCA+PSBiYXNlICkKKyAgICAgICAgICAgIHJldHVybiAtRUFERFJJ
TlVTRTsKKyAgICB9CisKKyAgICBpZiAoIHAybWEgPT0gcDJtX2FjY2Vzc194
ICkKKyAgICAgICAgcmV0dXJuIC1FTk9FTlQ7CisKKyAgICB3aGlsZSAoIGJh
c2VfcGZuIDwgZW5kX3BmbiApCisgICAgeworICAgICAgICBpbnQgZXJyID0g
c2V0X2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3BmbiwgcDJtYSwgZmxh
Zyk7CisKKyAgICAgICAgaWYgKCBlcnIgKQorICAgICAgICAgICAgcmV0dXJu
IGVycjsKKyAgICAgICAgYmFzZV9wZm4rKzsKKyAgICB9CisKKyAgICBtYXAg
PSB4bWFsbG9jKHN0cnVjdCBpZGVudGl0eV9tYXApOworICAgIGlmICggIW1h
cCApCisgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgIG1hcC0+YmFzZSA9
IGJhc2U7CisgICAgbWFwLT5lbmQgPSBlbmQ7CisgICAgbWFwLT5hY2Nlc3Mg
PSBwMm1hOworICAgIG1hcC0+Y291bnQgPSAxOworICAgIGxpc3RfYWRkX3Rh
aWwoJm1hcC0+bGlzdCwgJmhkLT5hcmNoLmlkZW50aXR5X21hcHMpOworCisg
ICAgcmV0dXJuIDA7Cit9CisKK3ZvaWQgaW9tbXVfaWRlbnRpdHlfbWFwX3Rl
YXJkb3duKHN0cnVjdCBkb21haW4gKmQpCit7CisgICAgc3RydWN0IGRvbWFp
bl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7CisgICAgc3RydWN0IGlkZW50
aXR5X21hcCAqbWFwLCAqdG1wOworCisgICAgbGlzdF9mb3JfZWFjaF9lbnRy
eV9zYWZlICggbWFwLCB0bXAsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBzLCBs
aXN0ICkKKyAgICB7CisgICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3QpOwor
ICAgICAgICB4ZnJlZShtYXApOworICAgIH0KK30KKwogc3RhdGljIGJvb2wg
X19od2RvbV9pbml0IGh3ZG9tX2lvbW11X21hcChjb25zdCBzdHJ1Y3QgZG9t
YWluICpkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBtYXhfcGZuKQot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11LmgKKysrIGIveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9pb21tdS5oCkBAIC0xNiw2ICsxNiw3IEBACiAKICNp
bmNsdWRlIDx4ZW4vZXJybm8uaD4KICNpbmNsdWRlIDx4ZW4vbGlzdC5oPgor
I2luY2x1ZGUgPHhlbi9tZW1fYWNjZXNzLmg+CiAjaW5jbHVkZSA8eGVuL3Nw
aW5sb2NrLmg+CiAjaW5jbHVkZSA8YXNtL2FwaWNkZWYuaD4KICNpbmNsdWRl
IDxhc20vcHJvY2Vzc29yLmg+CkBAIC00OSw3ICs1MCw3IEBAIHN0cnVjdCBh
cmNoX2lvbW11CiAgICAgc3BpbmxvY2tfdCBtYXBwaW5nX2xvY2s7ICAgICAg
ICAgICAgLyogaW8gcGFnZSB0YWJsZSBsb2NrICovCiAgICAgaW50IGFnYXc7
ICAgICAvKiBhZGp1c3RlZCBndWVzdCBhZGRyZXNzIHdpZHRoLCAwIGlzIGxl
dmVsIDIgMzAtYml0ICovCiAgICAgdTY0IGlvbW11X2JpdG1hcDsgICAgICAg
ICAgICAgIC8qIGJpdG1hcCBvZiBpb21tdShzKSB0aGF0IHRoZSBkb21haW4g
dXNlcyAqLwotICAgIHN0cnVjdCBsaXN0X2hlYWQgbWFwcGVkX3JtcnJzOwor
ICAgIHN0cnVjdCBsaXN0X2hlYWQgaWRlbnRpdHlfbWFwczsKIAogICAgIC8q
IGFtZCBpb21tdSBzdXBwb3J0ICovCiAgICAgaW50IHBhZ2luZ19tb2RlOwpA
QCAtMTEyLDYgKzExMywxMSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaW9tbXVf
ZGlzYWJsZV94MmFwaWMoCiAgICAgICAgIGlvbW11X29wcy5kaXNhYmxlX3gy
YXBpYygpOwogfQogCitpbnQgaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhzdHJ1
Y3QgZG9tYWluICpkLCBwMm1fYWNjZXNzX3QgcDJtYSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBlbmQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZyk7
Cit2b2lkIGlvbW11X2lkZW50aXR5X21hcF90ZWFyZG93bihzdHJ1Y3QgZG9t
YWluICpkKTsKKwogZXh0ZXJuIGJvb2wgdW50cnVzdGVkX21zaTsKIAogaW50
IHBpX3VwZGF0ZV9pcnRlKGNvbnN0IHN0cnVjdCBwaV9kZXNjICpwaV9kZXNj
LCBjb25zdCBzdHJ1Y3QgcGlycSAqcGlycSwKLS0tIGEveGVuL2luY2x1ZGUv
YXNtLXg4Ni9wMm0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5o
CkBAIC05MDAsNiArOTAwLDM0IEBAIHN0cnVjdCBwMm1fZG9tYWluICpwMm1f
Z2V0X2FsdHAybShzdHJ1Y3QKIHN0YXRpYyBpbmxpbmUgdm9pZCBwMm1fYWx0
cDJtX2NoZWNrKHN0cnVjdCB2Y3B1ICp2LCB1aW50MTZfdCBpZHgpIHt9CiAj
ZW5kaWYKIAorLyogcDJtIGFjY2VzcyB0byBJT01NVSBmbGFncyAqLworc3Rh
dGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJtX2FjY2Vzc190b19pb21tdV9m
bGFncyhwMm1fYWNjZXNzX3QgcDJtYSkKK3sKKyAgICBzd2l0Y2ggKCBwMm1h
ICkKKyAgICB7CisgICAgY2FzZSBwMm1fYWNjZXNzX3J3OgorICAgIGNhc2Ug
cDJtX2FjY2Vzc19yd3g6CisgICAgICAgIHJldHVybiBJT01NVUZfcmVhZGFi
bGUgfCBJT01NVUZfd3JpdGFibGU7CisKKyAgICBjYXNlIHAybV9hY2Nlc3Nf
cjoKKyAgICBjYXNlIHAybV9hY2Nlc3Nfcng6CisgICAgY2FzZSBwMm1fYWNj
ZXNzX3J4MnJ3OgorICAgICAgICByZXR1cm4gSU9NTVVGX3JlYWRhYmxlOwor
CisgICAgY2FzZSBwMm1fYWNjZXNzX3c6CisgICAgY2FzZSBwMm1fYWNjZXNz
X3d4OgorICAgICAgICByZXR1cm4gSU9NTVVGX3dyaXRhYmxlOworCisgICAg
Y2FzZSBwMm1fYWNjZXNzX246CisgICAgY2FzZSBwMm1fYWNjZXNzX3g6Cisg
ICAgY2FzZSBwMm1fYWNjZXNzX24ycnd4OgorICAgICAgICByZXR1cm4gMDsK
KyAgICB9CisKKyAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICByZXR1
cm4gMDsKK30KKwogLyoKICAqIHAybSB0eXBlIHRvIElPTU1VIGZsYWdzCiAg
Ki8KQEAgLTkyMSw5ICs5NDksMTAgQEAgc3RhdGljIGlubGluZSB1bnNpZ25l
ZCBpbnQgcDJtX2dldF9pb21tdQogICAgICAgICBmbGFncyA9IElPTU1VRl9y
ZWFkYWJsZTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSBwMm1fbW1pb19k
aXJlY3Q6Ci0gICAgICAgIGZsYWdzID0gSU9NTVVGX3JlYWRhYmxlOwotICAg
ICAgICBpZiAoICFyYW5nZXNldF9jb250YWluc19zaW5nbGV0b24obW1pb19y
b19yYW5nZXMsIG1mbl94KG1mbikpICkKLSAgICAgICAgICAgIGZsYWdzIHw9
IElPTU1VRl93cml0YWJsZTsKKyAgICAgICAgZmxhZ3MgPSBwMm1fYWNjZXNz
X3RvX2lvbW11X2ZsYWdzKHAybWEpOworICAgICAgICBpZiAoIChmbGFncyAm
IElPTU1VRl93cml0YWJsZSkgJiYKKyAgICAgICAgICAgICByYW5nZXNldF9j
b250YWluc19zaW5nbGV0b24obW1pb19yb19yYW5nZXMsIG1mbl94KG1mbikp
ICkKKyAgICAgICAgICAgIGZsYWdzICY9IH5JT01NVUZfd3JpdGFibGU7CiAg
ICAgICAgIGJyZWFrOwogICAgIGRlZmF1bHQ6CiAgICAgICAgIGZsYWdzID0g
MDsK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-5.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UvY29tcGxldGUgcmUtYXNzaWdubWVu
dCBoYW5kbGluZwoKUHJpb3IgdG8gdGhlIGFzc2lnbm1lbnQgc3RlcCBoYXZp
bmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgZGV2aWNlcwpzaG91bGQgbm90
IGdldCBhc3NvY2lhdGVkIHdpdGggdGhlaXIgbmV3IG93bmVyLiBIYW5kIHRo
ZSBkZXZpY2UgdG8gRG9tSU8KKHBlcmhhcHMgdGVtcG9yYXJpbHkpLCB1bnRp
bCBhZnRlciB0aGUgZGUtYXNzaWdubWVudCBzdGVwIGhhcyBjb21wbGV0ZWQu
CgpEZS1hc3NpZ25tZW50IG9mIGEgZGV2aWNlIChmcm9tIG90aGVyIHRoYW4g
RG9tMCkgYXMgd2VsbCBhcyBmYWlsdXJlIG9mCnJlYXNzaWduX2RldmljZSgp
IGR1cmluZyBhc3NpZ25tZW50IHNob3VsZCByZXN1bHQgaW4gdW5pdHkgbWFw
cGluZ3MKZ2V0dGluZyB0b3JuIGRvd24uIFRoaXMgaW4gdHVybiByZXF1aXJl
cyBzd2l0Y2hpbmcgdG8gYSByZWZjb3VudGVkCm1hcHBpbmcgYXBwcm9hY2gs
IGFzIHdhcyBhbHJlYWR5IHVzZWQgYnkgVlQtZCBmb3IgaXRzIFJNUlJzLCB0
byBwcmV2ZW50CnVubWFwcGluZyBhIHJlZ2lvbiB1c2VkIGJ5IG11bHRpcGxl
IGRldmljZXMuCgpUaGlzIGlzIENWRS0yMDIxLTI4Njk2IC8gcGFydCBvZiBY
U0EtMzc4LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXUu
aApAQCAtMjMyLDggKzIzMiwxMCBAQCBpbnQgX19tdXN0X2NoZWNrIGFtZF9p
b21tdV91bm1hcF9wYWdlKHN0CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqZmx1c2hfZmxhZ3MpOwogaW50
IF9fbXVzdF9jaGVjayBhbWRfaW9tbXVfYWxsb2Nfcm9vdChzdHJ1Y3QgZG9t
YWluX2lvbW11ICpoZCk7CiBpbnQgYW1kX2lvbW11X3Jlc2VydmVfZG9tYWlu
X3VuaXR5X21hcChzdHJ1Y3QgZG9tYWluICpkb21haW4sCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90IHBoeXNfYWRk
ciwgdW5zaWduZWQgbG9uZyBzaXplLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaW50IGl3LCBpbnQgaXIpOworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGl2
cnNfdW5pdHlfbWFwICptYXAsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZyk7CitpbnQgYW1kX2lv
bW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X3VubWFwKHN0cnVjdCBkb21haW4g
KmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqbWFwKTsKIGludCBfX211
c3RfY2hlY2sgYW1kX2lvbW11X2ZsdXNoX2lvdGxiX3BhZ2VzKHN0cnVjdCBk
b21haW4gKmQsIGRmbl90IGRmbiwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBwYWdlX2NvdW50
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IGZsdXNoX2ZsYWdzKTsKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYwpAQCAtNDIwLDM4ICs0
MjAsNDkgQEAgaW50IGFtZF9pb21tdV9mbHVzaF9pb3RsYl9hbGwoc3RydWN0
IGRvbQogICAgIHJldHVybiAwOwogfQogCi1pbnQgYW1kX2lvbW11X3Jlc2Vy
dmVfZG9tYWluX3VuaXR5X21hcChzdHJ1Y3QgZG9tYWluICpkb21haW4sCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90
IHBoeXNfYWRkciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgc2l6ZSwgaW50IGl3LCBpbnQgaXIpCitp
bnQgYW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcChzdHJ1Y3Qg
ZG9tYWluICpkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3Qgc3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXAsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgZmxhZykKIHsKLSAgICB1bnNpZ25lZCBsb25nIG5wYWdlcywgaTsKLSAg
ICB1bnNpZ25lZCBsb25nIGdmbjsKLSAgICB1bnNpZ25lZCBpbnQgZmxhZ3Mg
PSAhIWlyOwotICAgIHVuc2lnbmVkIGludCBmbHVzaF9mbGFncyA9IDA7Ci0g
ICAgaW50IHJ0ID0gMDsKLQotICAgIGlmICggaXcgKQotICAgICAgICBmbGFn
cyB8PSBJT01NVUZfd3JpdGFibGU7Ci0KLSAgICBucGFnZXMgPSByZWdpb25f
dG9fcGFnZXMocGh5c19hZGRyLCBzaXplKTsKLSAgICBnZm4gPSBwaHlzX2Fk
ZHIgPj4gUEFHRV9TSElGVDsKLSAgICBmb3IgKCBpID0gMDsgaSA8IG5wYWdl
czsgaSsrICkKKyAgICBpbnQgcmM7CisKKyAgICBpZiAoIGQgPT0gZG9tX2lv
ICkKKyAgICAgICAgcmV0dXJuIDA7CisKKyAgICBmb3IgKCByYyA9IDA7ICFy
YyAmJiBtYXA7IG1hcCA9IG1hcC0+bmV4dCApCiAgICAgewotICAgICAgICB1
bnNpZ25lZCBsb25nIGZyYW1lID0gZ2ZuICsgaTsKKyAgICAgICAgcDJtX2Fj
Y2Vzc190IHAybWEgPSBwMm1fYWNjZXNzX247CisKKyAgICAgICAgaWYgKCBt
YXAtPnJlYWQgKQorICAgICAgICAgICAgcDJtYSB8PSBwMm1fYWNjZXNzX3I7
CisgICAgICAgIGlmICggbWFwLT53cml0ZSApCisgICAgICAgICAgICBwMm1h
IHw9IHAybV9hY2Nlc3NfdzsKIAotICAgICAgICBydCA9IGFtZF9pb21tdV9t
YXBfcGFnZShkb21haW4sIF9kZm4oZnJhbWUpLCBfbWZuKGZyYW1lKSwgZmxh
Z3MsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmbHVzaF9m
bGFncyk7Ci0gICAgICAgIGlmICggcnQgIT0gMCApCi0gICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgcmMgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKGQs
IHAybWEsIG1hcC0+YWRkciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1hcC0+YWRkciArIG1hcC0+bGVuZ3RoIC0gMSwgZmxhZyk7
CiAgICAgfQogCi0gICAgLyogVXNlIHdoaWxlLWJyZWFrIHRvIGF2b2lkIGNv
bXBpbGVyIHdhcm5pbmcgKi8KLSAgICB3aGlsZSAoIGZsdXNoX2ZsYWdzICYm
Ci0gICAgICAgICAgICBhbWRfaW9tbXVfZmx1c2hfaW90bGJfcGFnZXMoZG9t
YWluLCBfZGZuKGdmbiksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbnBhZ2VzLCBmbHVzaF9mbGFncykgKQotICAgICAgICBi
cmVhazsKKyAgICByZXR1cm4gcmM7Cit9CisKK2ludCBhbWRfaW9tbXVfcmVz
ZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAoc3RydWN0IGRvbWFpbiAqZCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
c3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXApCit7CisgICAgaW50IHJjOwor
CisgICAgaWYgKCBkID09IGRvbV9pbyApCisgICAgICAgIHJldHVybiAwOwor
CisgICAgZm9yICggcmMgPSAwOyBtYXA7IG1hcCA9IG1hcC0+bmV4dCApCisg
ICAgeworICAgICAgICBpbnQgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGlu
ZyhkLCBwMm1fYWNjZXNzX3gsIG1hcC0+YWRkciwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwLT5hZGRyICsgbWFwLT5s
ZW5ndGggLSAxLCAwKTsKKworICAgICAgICBpZiAoIHJldCAmJiByZXQgIT0g
LUVOT0VOVCAmJiAhcmMgKQorICAgICAgICAgICAgcmMgPSByZXQ7CisgICAg
fQogCi0gICAgcmV0dXJuIHJ0OworICAgIHJldHVybiByYzsKIH0KIAogaW50
IF9faW5pdCBhbWRfaW9tbXVfcXVhcmFudGluZV9pbml0KHN0cnVjdCBkb21h
aW4gKmQpCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lf
YW1kX2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L3BjaV9hbWRfaW9tbXUuYwpAQCAtMzI3LDYgKzMyNyw3IEBAIHN0YXRpYyBp
bnQgcmVhc3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4KICAgICBzdHJ1Y3Qg
YW1kX2lvbW11ICppb21tdTsKICAgICBpbnQgYmRmLCByYzsKICAgICBzdHJ1
Y3QgZG9tYWluX2lvbW11ICp0ID0gZG9tX2lvbW11KHRhcmdldCk7CisgICAg
Y29uc3Qgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBn
ZXRfaXZyc19tYXBwaW5ncyhwZGV2LT5zZWcpOwogCiAgICAgYmRmID0gUENJ
X0JERjIocGRldi0+YnVzLCBwZGV2LT5kZXZmbik7CiAgICAgaW9tbXUgPSBm
aW5kX2lvbW11X2Zvcl9kZXZpY2UocGRldi0+c2VnLCBiZGYpOwpAQCAtMzQx
LDEwICszNDIsMjQgQEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3Ry
dWN0IGRvbWFpbgogCiAgICAgYW1kX2lvbW11X2Rpc2FibGVfZG9tYWluX2Rl
dmljZShzb3VyY2UsIGlvbW11LCBkZXZmbiwgcGRldik7CiAKLSAgICBpZiAo
IGRldmZuID09IHBkZXYtPmRldmZuICkKKyAgICAvKgorICAgICAqIElmIHRo
ZSBkZXZpY2UgYmVsb25ncyB0byB0aGUgaGFyZHdhcmUgZG9tYWluLCBhbmQg
aXQgaGFzIGEgdW5pdHkgbWFwcGluZywKKyAgICAgKiBkb24ndCByZW1vdmUg
aXQgZnJvbSB0aGUgaGFyZHdhcmUgZG9tYWluLCBiZWNhdXNlIEJJT1MgbWF5
IHJlZmVyZW5jZSB0aGF0CisgICAgICogbWFwcGluZy4KKyAgICAgKi8KKyAg
ICBpZiAoICFpc19oYXJkd2FyZV9kb21haW4oc291cmNlKSApCisgICAgewor
ICAgICAgICByYyA9IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV91
bm1hcCgKKyAgICAgICAgICAgICAgICAgc291cmNlLAorICAgICAgICAgICAg
ICAgICBpdnJzX21hcHBpbmdzW2dldF9kbWFfcmVxdWVzdG9yX2lkKHBkZXYt
PnNlZywgYmRmKV0udW5pdHlfbWFwKTsKKyAgICAgICAgaWYgKCByYyApCisg
ICAgICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgaWYgKCBkZXZm
biA9PSBwZGV2LT5kZXZmbiAmJiBwZGV2LT5kb21haW4gIT0gZG9tX2lvICkK
ICAgICB7Ci0gICAgICAgIGxpc3RfbW92ZSgmcGRldi0+ZG9tYWluX2xpc3Qs
ICZ0YXJnZXQtPnBkZXZfbGlzdCk7Ci0gICAgICAgIHBkZXYtPmRvbWFpbiA9
IHRhcmdldDsKKyAgICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21haW5fbGlz
dCwgJmRvbV9pby0+cGRldl9saXN0KTsKKyAgICAgICAgcGRldi0+ZG9tYWlu
ID0gZG9tX2lvOwogICAgIH0KIAogICAgIHJjID0gYWxsb2NhdGVfZG9tYWlu
X3Jlc291cmNlcyh0KTsKQEAgLTM1Niw2ICszNzEsMTIgQEAgc3RhdGljIGlu
dCByZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbgogICAgICAgICAgICAg
ICAgICAgICBwZGV2LT5zZWcsIHBkZXYtPmJ1cywgUENJX1NMT1QoZGV2Zm4p
LCBQQ0lfRlVOQyhkZXZmbiksCiAgICAgICAgICAgICAgICAgICAgIHNvdXJj
ZS0+ZG9tYWluX2lkLCB0YXJnZXQtPmRvbWFpbl9pZCk7CiAKKyAgICBpZiAo
IGRldmZuID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRvbWFpbiAhPSB0YXJn
ZXQgKQorICAgIHsKKyAgICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21haW5f
bGlzdCwgJnRhcmdldC0+cGRldl9saXN0KTsKKyAgICAgICAgcGRldi0+ZG9t
YWluID0gdGFyZ2V0OworICAgIH0KKwogICAgIHJldHVybiAwOwogfQogCkBA
IC0zNjYsMjAgKzM4NywyOCBAQCBzdGF0aWMgaW50IGFtZF9pb21tdV9hc3Np
Z25fZGV2aWNlKHN0cnVjCiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2
cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBwaW5ncyhwZGV2LT5zZWcpOwog
ICAgIGludCBiZGYgPSBQQ0lfQkRGMihwZGV2LT5idXMsIGRldmZuKTsKICAg
ICBpbnQgcmVxX2lkID0gZ2V0X2RtYV9yZXF1ZXN0b3JfaWQocGRldi0+c2Vn
LCBiZGYpOwotICAgIGNvbnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5p
dHlfbWFwOworICAgIGludCByYyA9IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFp
bl91bml0eV9tYXAoCisgICAgICAgICAgICAgICAgIGQsIGl2cnNfbWFwcGlu
Z3NbcmVxX2lkXS51bml0eV9tYXAsIGZsYWcpOworCisgICAgaWYgKCAhcmMg
KQorICAgICAgICByYyA9IHJlYXNzaWduX2RldmljZShwZGV2LT5kb21haW4s
IGQsIGRldmZuLCBwZGV2KTsKIAotICAgIGZvciAoIHVuaXR5X21hcCA9IGl2
cnNfbWFwcGluZ3NbcmVxX2lkXS51bml0eV9tYXA7IHVuaXR5X21hcDsKLSAg
ICAgICAgICB1bml0eV9tYXAgPSB1bml0eV9tYXAtPm5leHQgKQorICAgIGlm
ICggcmMgJiYgIWlzX2hhcmR3YXJlX2RvbWFpbihkKSApCiAgICAgewotICAg
ICAgICBpbnQgcmMgPSBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlf
bWFwKAotICAgICAgICAgICAgICAgICAgICAgZCwgdW5pdHlfbWFwLT5hZGRy
LCB1bml0eV9tYXAtPmxlbmd0aCwKLSAgICAgICAgICAgICAgICAgICAgIHVu
aXR5X21hcC0+d3JpdGUsIHVuaXR5X21hcC0+cmVhZCk7CisgICAgICAgIGlu
dCByZXQgPSBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAo
CisgICAgICAgICAgICAgICAgICAgICAgZCwgaXZyc19tYXBwaW5nc1tyZXFf
aWRdLnVuaXR5X21hcCk7CiAKLSAgICAgICAgaWYgKCByYyApCi0gICAgICAg
ICAgICByZXR1cm4gcmM7CisgICAgICAgIGlmICggcmV0ICkKKyAgICAgICAg
eworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIkFNRC1WaTogIgor
ICAgICAgICAgICAgICAgICAgICJ1bml0eS11bm1hcCBmb3IgJXBkLyUwNHg6
JTAyeDolMDJ4LiV1IGZhaWxlZCAoJWQpXG4iLAorICAgICAgICAgICAgICAg
ICAgIGQsIHBkZXYtPnNlZywgcGRldi0+YnVzLAorICAgICAgICAgICAgICAg
ICAgIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLCByZXQpOwor
ICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOworICAgICAgICB9CiAgICAg
fQogCi0gICAgcmV0dXJuIHJlYXNzaWduX2RldmljZShwZGV2LT5kb21haW4s
IGQsIGRldmZuLCBwZGV2KTsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRp
YyB2b2lkIGRlYWxsb2NhdGVfbmV4dF9wYWdlX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBnLCBpbnQgbGV2ZWwpCkBAIC00MzgsNiArNDY3LDcgQEAgc3Rh
dGljIHZvaWQgZGVhbGxvY2F0ZV9pb21tdV9wYWdlX3RhYmxlcwogCiBzdGF0
aWMgdm9pZCBhbWRfaW9tbXVfZG9tYWluX2Rlc3Ryb3koc3RydWN0IGRvbWFp
biAqZCkKIHsKKyAgICBpb21tdV9pZGVudGl0eV9tYXBfdGVhcmRvd24oZCk7
CiAgICAgZGVhbGxvY2F0ZV9pb21tdV9wYWdlX3RhYmxlcyhkKTsKICAgICBh
bWRfaW9tbXVfZmx1c2hfYWxsX3BhZ2VzKGQpOwogfQo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-6.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-6.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UgZXhjbHVzaW9uIHJhbmdlIGFuZCB1
bml0eSBtYXAgcmVjb3JkaW5nCgpUaGUgc3BlYyBtYWtlcyBubyBwcm92aXNp
b25zIGZvciBPUyBiZWhhdmlvciBoZXJlIHRvIGRlcGVuZCBvbiB0aGUKYW1v
dW50IG9mIFJBTSBmb3VuZCBvbiB0aGUgc3lzdGVtLiBXaGlsZSB0aGUgc3Bl
YyBtYXkgbm90IHN1ZmZpY2llbnRseQpjbGVhcmx5IGRpc3Rpbmd1aXNoIGJv
dGgga2luZHMgb2YgcmVnaW9ucywgdGhleSBhcmUgc3VyZWx5IG1lYW50IHRv
IGJlCnNlcGFyYXRlIHRoaW5nczogT25seSByZWdpb25zIHdpdGggQUNQSV9J
Vk1EX0VYQ0xVU0lPTl9SQU5HRSBzZXQgc2hvdWxkCmJlIGNhbmRpZGF0ZXMg
Zm9yIHB1dHRpbmcgaW4gdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3RlcnMu
IChBcyB0aGVyZSdzCm9ubHkgYSBzaW5nbGUgc3VjaCBwYWlyIG9mIHJlZ2lz
dGVycyBwZXIgSU9NTVUsIHNlY29uZGFyeSBub24tYWRqYWNlbnQKcmVnaW9u
cyB3aXRoIHRoZSBmbGFnIHNldCBhbHJlYWR5IGdldCBjb252ZXJ0ZWQgdG8g
dW5pdHkgbWFwcGVkCnJlZ2lvbnMuKQoKRmlyc3Qgb2YgYWxsLCBkcm9wIHRo
ZSBkZXBlbmRlbmN5IG9uIG1heF9wYWdlLiBXaXRoIGNvbW1pdCBiNGYwNDIy
MzZhZTAKKCJBTUQvSU9NTVU6IENlYXNlIHVzaW5nIGEgZHluYW1pYyBoZWln
aHQgZm9yIHRoZSBJT01NVSBwYWdldGFibGVzIikgdGhlCnVzZSBvZiBpdCBo
ZXJlIHdhcyBzdGFsZSBhbnl3YXk7IGl0IHdhcyBib2d1cyBhbHJlYWR5IGJl
Zm9yZSwgYXMgaXQKZGlkbid0IGFjY291bnQgZm9yIG1heF9wYWdlIGdldHRp
bmcgaW5jcmVhc2VkIGxhdGVyIG9uLiBTaW1wbHkgdHJ5IGFuCmV4Y2x1c2lv
biByYW5nZSByZWdpc3RyYXRpb24gZmlyc3QsIGFuZCBpZiBpdCBmYWlscyAo
Zm9yIGJlaW5nCnVuc3VpdGFibGUgb3Igbm9uLW1lcmdlYWJsZSksIHJlZ2lz
dGVyIGEgdW5pdHkgbWFwcGluZyByYW5nZS4KCldpdGggdGhpcyB2YXJpb3Vz
IGxvY2FsIHZhcmlhYmxlcyBiZWNvbWUgdW5uZWNlc3NhcnkgYW5kIGhlbmNl
IGdldApkcm9wcGVkIGF0IHRoZSBzYW1lIHRpbWUuCgpXaXRoIHRoZSBtYXhf
cGFnZSBib3VuZGFyeSBkcm9wcGVkIGZvciB1c2luZyB1bml0eSBtYXBzLCB0
aGUgbWluaW11bQpwYWdlIHRhYmxlIHRyZWUgaGVpZ2h0IG5vdyBuZWVkcyBi
b3RoIHJlY29yZGluZyBhbmQgZW5mb3JjaW5nIGluCmFtZF9pb21tdV9kb21h
aW5faW5pdCgpLiBTaW5jZSB3ZSBjYW4ndCBwcmVkaWN0IHdoaWNoIGRldmlj
ZXMgbWF5IGdldAphc3NpZ25lZCB0byBhIGRvbWFpbiwgb3VyIG9ubHkgb3B0
aW9uIGlzIHRvIHVuaWZvcm1seSBmb3JjZSBhdCBsZWFzdAp0aGF0IGhlaWdo
dCBmb3IgYWxsIGRvbWFpbnMsIG5vdyB0aGF0IHRoZSBoZWlnaHQgaXNuJ3Qg
ZHluYW1pYyBhbnltb3JlLgoKRnVydGhlciBkb24ndCBtYWtlIHVzZSBvZiB0
aGUgZXhjbHVzaW9uIHJhbmdlIHVubGVzcyBBQ1BJIGRhdGEgc2F5cyBzby4K
Ck5vdGUgdGhhdCBleGNsdXNpb24gcmFuZ2UgcmVnaXN0cmF0aW9uIGluCnJl
Z2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygpIGlzIG9uIGEgYmVzdCBl
ZmZvcnQgYmFzaXMuIEhlbmNlIHVuaXR5Cm1hcCBlbnRyaWVzIGFsc28gcmVn
aXN0ZXJlZCBhcmUgcmVkdW5kYW50IHdoZW4gdGhlIGZvcm1lciBzdWNjZWVk
ZWQsIGJ1dAp0aGV5IGFsc28gZG8gbm8gaGFybS4gSW1wcm92ZW1lbnRzIGlu
IHRoaXMgYXJlYSBjYW4gYmUgZG9uZSBsYXRlciBpbW8uCgpBbHNvIGFkanVz
dCB0eXBlcyB3aGVyZSBzdWl0YWJsZSB3aXRob3V0IHRvdWNoaW5nIGV4dHJh
IGxpbmVzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zNzguCgpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBQYXVsIER1cnJhbnQgPHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdS5oCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdS5oCkBAIC0zMDgsNiArMzA4LDgg
QEAgZXh0ZXJuIHN0cnVjdCBocGV0X3NiZGYgewogICAgIH0gaW5pdDsKIH0g
aHBldF9zYmRmOwogCitleHRlcm4gaW50IGFtZF9pb21tdV9taW5fcGFnaW5n
X21vZGU7CisKIGV4dGVybiB2b2lkICpzaGFyZWRfaW50cmVtYXBfdGFibGU7
CiBleHRlcm4gdW5zaWduZWQgbG9uZyAqc2hhcmVkX2ludHJlbWFwX2ludXNl
OwogCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9h
Y3BpLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X2FjcGkuYwpAQCAtMTE4LDEyICsxMTgsOCBAQCBzdGF0aWMgc3RydWN0IGFt
ZF9pb21tdSAqIF9faW5pdCBmaW5kX2lvCiB9CiAKIHN0YXRpYyBpbnQgX19p
bml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKAotICAgIHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11LCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBs
aW1pdCwKLSAgICBib29sIGFsbCwgYm9vbCBpdywgYm9vbCBpcikKKyAgICBz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgcGFkZHJfdCBiYXNlLCBwYWRkcl90
IGxpbWl0LCBib29sIGFsbCkKIHsKLSAgICBpZiAoICFpciB8fCAhaXcgKQot
ICAgICAgICByZXR1cm4gLUVQRVJNOwotCiAgICAgLyogbmVlZCB0byBleHRl
bmQgZXhjbHVzaW9uIHJhbmdlPyAqLwogICAgIGlmICggaW9tbXUtPmV4Y2x1
c2lvbl9lbmFibGUgKQogICAgIHsKQEAgLTE1MiwxNCArMTQ4LDE4IEBAIHN0
YXRpYyBpbnQgX19pbml0IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl8KIHsKICAg
ICBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9p
dnJzX21hcHBpbmdzKHNlZyk7CiAgICAgc3RydWN0IGl2cnNfdW5pdHlfbWFw
ICp1bml0eV9tYXAgPSBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwOwor
ICAgIGludCBwYWdpbmdfbW9kZSA9IGFtZF9pb21tdV9nZXRfcGFnaW5nX21v
ZGUoUEZOX1VQKGJhc2UgKyBsZW5ndGgpKTsKKworICAgIGlmICggcGFnaW5n
X21vZGUgPCAwICkKKyAgICAgICAgcmV0dXJuIHBhZ2luZ19tb2RlOwogCiAg
ICAgLyogQ2hlY2sgZm9yIG92ZXJsYXBzLiAqLwogICAgIGZvciAoIDsgdW5p
dHlfbWFwOyB1bml0eV9tYXAgPSB1bml0eV9tYXAtPm5leHQgKQogICAgIHsK
ICAgICAgICAgLyoKICAgICAgICAgICogRXhhY3QgbWF0Y2hlcyBhcmUgb2th
eS4gVGhpcyBjYW4gaW4gcGFydGljdWxhciBoYXBwZW4gd2hlbgotICAgICAg
ICAgKiByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZSgpIGNh
bGxzIGhlcmUgdHdpY2UgZm9yIHRoZQotICAgICAgICAgKiBzYW1lIChzLGIs
ZCxmKS4KKyAgICAgICAgICogcmVnaXN0ZXJfcmFuZ2VfZm9yX2RldmljZSgp
IGNhbGxzIGhlcmUgdHdpY2UgZm9yIHRoZSBzYW1lCisgICAgICAgICAqIChz
LGIsZCxmKS4KICAgICAgICAgICovCiAgICAgICAgIGlmICggYmFzZSA9PSB1
bml0eV9tYXAtPmFkZHIgJiYgbGVuZ3RoID09IHVuaXR5X21hcC0+bGVuZ3Ro
ICYmCiAgICAgICAgICAgICAgaXIgPT0gdW5pdHlfbWFwLT5yZWFkICYmIGl3
ID09IHVuaXR5X21hcC0+d3JpdGUgKQpAQCAtMTg3LDU1ICsxODcsNTIgQEAg
c3RhdGljIGludCBfX2luaXQgcmVzZXJ2ZV91bml0eV9tYXBfZm9yXwogICAg
IHVuaXR5X21hcC0+bmV4dCA9IGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9t
YXA7CiAgICAgaXZyc19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcCA9IHVuaXR5
X21hcDsKIAorICAgIGlmICggcGFnaW5nX21vZGUgPiBhbWRfaW9tbXVfbWlu
X3BhZ2luZ19tb2RlICkKKyAgICAgICAgYW1kX2lvbW11X21pbl9wYWdpbmdf
bW9kZSA9IHBhZ2luZ19tb2RlOworCiAgICAgcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3Jf
YWxsX2RldmljZXMoCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25l
ZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5p
dCByZWdpc3Rlcl9yYW5nZV9mb3JfYWxsX2RldmljZXMoCisgICAgcGFkZHJf
dCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29s
IGV4Y2x1c2lvbikKIHsKICAgICBpbnQgc2VnID0gMDsgLyogWFhYICovCi0g
ICAgdW5zaWduZWQgbG9uZyByYW5nZV90b3AsIGlvbW11X3RvcCwgbGVuZ3Ro
OwogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwotICAgIHVuc2lnbmVk
IGludCBiZGY7CiAgICAgaW50IHJjID0gMDsKIAogICAgIC8qIGlzIHBhcnQg
b2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBvZiBJT01NVSB2aXJ0dWFsIGFk
ZHJlc3Mgc3BhY2U/ICovCiAgICAgLyogbm90ZTogJ2xpbWl0JyBwYXJhbWV0
ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWduZWQgKi8KLSAgICByYW5n
ZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsKLSAgICBpb21tdV90b3AgPSBt
YXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBpZiAoIGJhc2UgPCBpb21tdV90
b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCByYW5nZV90b3AgPiBpb21tdV90
b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9wID0gaW9tbXVfdG9wOwotICAg
ICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwotICAgICAgICAvKiBy
ZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZp
Y2VzICovCi0gICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJpZXMgYXJlIHBh
cnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAgICAgICBmb3IgKCBi
ZGYgPSAwOyAhcmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysg
KQotICAgICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2
aWNlKHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7Ci0gICAgICAg
IC8qIHB1c2ggJ2Jhc2UnIGp1c3Qgb3V0c2lkZSBvZiB2aXJ0dWFsIGFkZHJl
c3Mgc3BhY2UgKi8KLSAgICAgICAgYmFzZSA9IGlvbW11X3RvcDsKLSAgICB9
Ci0gICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNldHRp
bmdzICovCi0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICkK
KyAgICBpZiAoIGV4Y2x1c2lvbiApCiAgICAgewogICAgICAgICBmb3JfZWFj
aF9hbWRfaW9tbXUoIGlvbW11ICkKICAgICAgICAgewotICAgICAgICAgICAg
cmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFz
ZSwgbGltaXQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOwotICAgICAg
ICAgICAgaWYgKCByYyApCi0gICAgICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgICAgICBpbnQgcmV0ID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFu
Z2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyogYWxsICov
KTsKKworICAgICAgICAgICAgaWYgKCByZXQgJiYgIXJjICkKKyAgICAgICAg
ICAgICAgICByYyA9IHJldDsKICAgICAgICAgfQogICAgIH0KIAorICAgIGlm
ICggIWV4Y2x1c2lvbiB8fCByYyApCisgICAgeworICAgICAgICBwYWRkcl90
IGxlbmd0aCA9IGxpbWl0ICsgUEFHRV9TSVpFIC0gYmFzZTsKKyAgICAgICAg
dW5zaWduZWQgaW50IGJkZjsKKworICAgICAgICAvKiByZXNlcnZlIHIvdyB1
bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCisgICAg
ICAgIGZvciAoIGJkZiA9IHJjID0gMDsgIXJjICYmIGJkZiA8IGl2cnNfYmRm
X2VudHJpZXM7IGJkZisrICkKKyAgICAgICAgICAgIHJjID0gcmVzZXJ2ZV91
bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBp
dywgaXIpOworICAgIH0KKwogICAgIHJldHVybiByYzsKIH0KIAotc3RhdGlj
IGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZp
Y2UoCi0gICAgdTE2IGJkZiwgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25l
ZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5p
dCByZWdpc3Rlcl9yYW5nZV9mb3JfZGV2aWNlKAorICAgIHVuc2lnbmVkIGlu
dCBiZGYsIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwKKyAgICBib29s
IGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikKIHsKICAgICBpbnQgc2Vn
ID0gMDsgLyogWFhYICovCiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2
cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcpOwotICAgIHVu
c2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAg
ICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdTsKICAgICB1MTYgcmVxOwogICAg
IGludCByYyA9IDA7CkBAIC0yNDksMjcgKzI0NiwxOSBAQCBzdGF0aWMgaW50
IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgcmVxID0gaXZy
c19tYXBwaW5nc1tiZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7CiAKICAgICAvKiBu
b3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2Ut
YWxpZ25lZCAqLwotICAgIHJhbmdlX3RvcCA9IGxpbWl0ICsgUEFHRV9TSVpF
OwotICAgIGlvbW11X3RvcCA9IG1heF9wYWdlICogUEFHRV9TSVpFOwotICAg
IGlmICggYmFzZSA8IGlvbW11X3RvcCApCi0gICAgewotICAgICAgICBpZiAo
IHJhbmdlX3RvcCA+IGlvbW11X3RvcCApCi0gICAgICAgICAgICByYW5nZV90
b3AgPSBpb21tdV90b3A7Ci0gICAgICAgIGxlbmd0aCA9IHJhbmdlX3RvcCAt
IGJhc2U7CisgICAgaWYgKCBleGNsdXNpb24gKQorICAgICAgICByYyA9IHJl
c2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1p
dCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBmYWxzZSAvKiBhbGwgKi8pOworICAgIGlmICggIWV4Y2x1c2lvbiB8fCBy
YyApCisgICAgeworICAgICAgICBwYWRkcl90IGxlbmd0aCA9IGxpbWl0ICsg
UEFHRV9TSVpFIC0gYmFzZTsKKwogICAgICAgICAvKiByZXNlcnZlIHVuaXR5
LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZSAqLwotICAgICAgICAv
KiBub3RlOiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNp
b24gcmFuZ2UgKi8KICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9m
b3JfZGV2aWNlKHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcikgPzoK
ICAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNl
ZywgcmVxLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7Ci0KLSAgICAgICAgLyog
cHVzaCAnYmFzZScganVzdCBvdXRzaWRlIG9mIHZpcnR1YWwgYWRkcmVzcyBz
cGFjZSAqLwotICAgICAgICBiYXNlID0gaW9tbXVfdG9wOwogICAgIH0KLQot
ICAgIC8qIHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5n
cyBmb3IgZGV2aWNlICovCi0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9t
bXVfdG9wICApCisgICAgZWxzZQogICAgIHsKLSAgICAgICAgcmMgPSByZXNl
cnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZmFsc2UgLyogYWxsICovLCBpdywgaXIpOwogICAgICAgICBpdnJzX21hcHBp
bmdzW2JkZl0uZHRlX2FsbG93X2V4Y2x1c2lvbiA9IHRydWU7CiAgICAgICAg
IGl2cnNfbWFwcGluZ3NbcmVxXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gdHJ1
ZTsKICAgICB9CkBAIC0yNzcsNTMgKzI2Niw0MiBAQCBzdGF0aWMgaW50IF9f
aW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgcmV0dXJuIHJjOwog
fQogCi1zdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFu
Z2VfZm9yX2lvbW11X2RldmljZXMoCi0gICAgc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUsCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25n
IGxpbWl0LCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5pdCByZWdp
c3Rlcl9yYW5nZV9mb3JfaW9tbXVfZGV2aWNlcygKKyAgICBzdHJ1Y3QgYW1k
X2lvbW11ICppb21tdSwgcGFkZHJfdCBiYXNlLCBwYWRkcl90IGxpbWl0LAor
ICAgIGJvb2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewotICAg
IHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsK
KyAgICAvKiBub3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1bWVkIHRv
IGJlIHBhZ2UtYWxpZ25lZCAqLworICAgIHBhZGRyX3QgbGVuZ3RoID0gbGlt
aXQgKyBQQUdFX1NJWkUgLSBiYXNlOwogICAgIHVuc2lnbmVkIGludCBiZGY7
CiAgICAgdTE2IHJlcTsKLSAgICBpbnQgcmMgPSAwOworICAgIGludCByYzsK
IAotICAgIC8qIGlzIHBhcnQgb2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBv
ZiBJT01NVSB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2U/ICovCi0gICAgLyogbm90
ZTogJ2xpbWl0JyBwYXJhbWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFs
aWduZWQgKi8KLSAgICByYW5nZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsK
LSAgICBpb21tdV90b3AgPSBtYXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBp
ZiAoIGJhc2UgPCBpb21tdV90b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCBy
YW5nZV90b3AgPiBpb21tdV90b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9w
ID0gaW9tbXVfdG9wOwotICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBi
YXNlOwotICAgICAgICAvKiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFn
ZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCi0gICAgICAgIC8qIG5vdGU6IHRo
ZXNlIGVudHJpZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAq
LwotICAgICAgICBmb3IgKCBiZGYgPSAwOyAhcmMgJiYgYmRmIDwgaXZyc19i
ZGZfZW50cmllczsgYmRmKysgKQotICAgICAgICB7Ci0gICAgICAgICAgICBp
ZiAoIGlvbW11ID09IGZpbmRfaW9tbXVfZm9yX2RldmljZShpb21tdS0+c2Vn
LCBiZGYpICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICByZXEg
PSBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVtiZGZdLmR0ZV9yZXF1
ZXN0b3JfaWQ7Ci0gICAgICAgICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5
X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZiwgYmFzZSwgbGVuZ3Ro
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpdywgaXIpID86Ci0gICAgICAgICAgICAgICAgICAgICByZXNl
cnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFz
ZSwgbGVuZ3RoLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpdywgaXIpOwotICAgICAgICAgICAgfQotICAg
ICAgICB9Ci0KLSAgICAgICAgLyogcHVzaCAnYmFzZScganVzdCBvdXRzaWRl
IG9mIHZpcnR1YWwgYWRkcmVzcyBzcGFjZSAqLwotICAgICAgICBiYXNlID0g
aW9tbXVfdG9wOworICAgIGlmICggZXhjbHVzaW9uICkKKyAgICB7CisgICAg
ICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUs
IGJhc2UsIGxpbWl0LCB0cnVlIC8qIGFsbCAqLyk7CisgICAgICAgIGlmICgg
IXJjICkKKyAgICAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAotICAgIC8q
IHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwot
ICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCApCi0gICAgICAg
IHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJh
c2UsIGxpbWl0LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOworICAgIC8qIHJl
c2VydmUgdW5pdHktbWFwcGVkIHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAq
LworICAgIGZvciAoIGJkZiA9IHJjID0gMDsgIXJjICYmIGJkZiA8IGl2cnNf
YmRmX2VudHJpZXM7IGJkZisrICkKKyAgICB7CisgICAgICAgIGlmICggaW9t
bXUgIT0gZmluZF9pb21tdV9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZikg
KQorICAgICAgICAgICAgY29udGludWU7CisKKyAgICAgICAgcmVxID0gZ2V0
X2l2cnNfbWFwcGluZ3MoaW9tbXUtPnNlZylbYmRmXS5kdGVfcmVxdWVzdG9y
X2lkOworICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZp
Y2UoaW9tbXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIpID86Cisg
ICAgICAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShpb21t
dS0+c2VnLCByZXEsIGJhc2UsIGxlbmd0aCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcik7CisgICAgfQogCiAg
ICAgcmV0dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9p
dm1kX2RldmljZV9zZWxlY3QoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZy
c19tZW1vcnkgKml2bWRfYmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNl
LCB1bnNpZ25lZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFk
ZHJfdCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBi
b29sIGV4Y2x1c2lvbikKIHsKICAgICB1MTYgYmRmOwogCkBAIC0zMzQsMTIg
KzMxMiwxMiBAQCBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2Rldmlj
ZV9zZWxlCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogICAgIH0KIAotICAg
IHJldHVybiByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZShi
ZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAgIHJldHVybiByZWdpc3Rl
cl9yYW5nZV9mb3JfZGV2aWNlKGJkZiwgYmFzZSwgbGltaXQsIGl3LCBpciwg
ZXhjbHVzaW9uKTsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZt
ZF9kZXZpY2VfcmFuZ2UoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19t
ZW1vcnkgKml2bWRfYmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1
bnNpZ25lZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJf
dCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29s
IGV4Y2x1c2lvbikKIHsKICAgICB1bnNpZ25lZCBpbnQgZmlyc3RfYmRmLCBs
YXN0X2JkZiwgYmRmOwogICAgIGludCBlcnJvcjsKQEAgLTM2MSwxNSArMzM5
LDE1IEBAIHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3Jh
bmcKICAgICB9CiAKICAgICBmb3IgKCBiZGYgPSBmaXJzdF9iZGYsIGVycm9y
ID0gMDsgKGJkZiA8PSBsYXN0X2JkZikgJiYgIWVycm9yOyBiZGYrKyApCi0g
ICAgICAgIGVycm9yID0gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9k
ZXZpY2UoCi0gICAgICAgICAgICBiZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIp
OworICAgICAgICBlcnJvciA9IHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2Uo
CisgICAgICAgICAgICBiZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIsIGV4Y2x1
c2lvbik7CiAKICAgICByZXR1cm4gZXJyb3I7CiB9CiAKIHN0YXRpYyBpbnQg
X19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX2lvbW11KAogICAgIGNvbnN0IHN0
cnVjdCBhY3BpX2l2cnNfbWVtb3J5ICppdm1kX2Jsb2NrLAotICAgIHVuc2ln
bmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCwgdTggaXcsIHU4
IGlyKQorICAgIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwgYm9vbCBp
dywgYm9vbCBpciwgYm9vbCBleGNsdXNpb24pCiB7CiAgICAgaW50IHNlZyA9
IDA7IC8qIFhYWCAqLwogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwpA
QCAtMzg0LDE0ICszNjIsMTQgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2Vf
aXZtZF9kZXZpY2VfaW9tbQogICAgICAgICByZXR1cm4gLUVOT0RFVjsKICAg
ICB9CiAKLSAgICByZXR1cm4gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zv
cl9pb21tdV9kZXZpY2VzKAotICAgICAgICBpb21tdSwgYmFzZSwgbGltaXQs
IGl3LCBpcik7CisgICAgcmV0dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9pb21t
dV9kZXZpY2VzKAorICAgICAgICBpb21tdSwgYmFzZSwgbGltaXQsIGl3LCBp
ciwgZXhjbHVzaW9uKTsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2Vf
aXZtZF9ibG9jayhjb25zdCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZt
ZF9ibG9jaykKIHsKICAgICB1bnNpZ25lZCBsb25nIHN0YXJ0X2FkZHIsIG1l
bV9sZW5ndGgsIGJhc2UsIGxpbWl0OwotICAgIHU4IGl3LCBpcjsKKyAgICBi
b29sIGl3ID0gdHJ1ZSwgaXIgPSB0cnVlLCBleGNsdXNpb24gPSBmYWxzZTsK
IAogICAgIGlmICggaXZtZF9ibG9jay0+aGVhZGVyLmxlbmd0aCA8IHNpemVv
ZigqaXZtZF9ibG9jaykgKQogICAgIHsKQEAgLTQwOCwxMyArMzg2LDExIEBA
IHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfYmxvY2soY29uc3QKICAg
ICAgICAgICAgICAgICAgICAgaXZtZF9ibG9jay0+aGVhZGVyLnR5cGUsIHN0
YXJ0X2FkZHIsIG1lbV9sZW5ndGgpOwogCiAgICAgaWYgKCBpdm1kX2Jsb2Nr
LT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfRVhDTFVTSU9OX1JBTkdFICkK
LSAgICAgICAgaXcgPSBpciA9IElPTU1VX0NPTlRST0xfRU5BQkxFRDsKKyAg
ICAgICAgZXhjbHVzaW9uID0gdHJ1ZTsKICAgICBlbHNlIGlmICggaXZtZF9i
bG9jay0+aGVhZGVyLmZsYWdzICYgQUNQSV9JVk1EX1VOSVRZICkKICAgICB7
Ci0gICAgICAgIGl3ID0gaXZtZF9ibG9jay0+aGVhZGVyLmZsYWdzICYgQUNQ
SV9JVk1EX1JFQUQgPwotICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FTkFC
TEVEIDogSU9NTVVfQ09OVFJPTF9ESVNBQkxFRDsKLSAgICAgICAgaXIgPSBp
dm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfV1JJVEUgPwot
ICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FTkFCTEVEIDogSU9NTVVfQ09O
VFJPTF9ESVNBQkxFRDsKKyAgICAgICAgaXcgPSBpdm1kX2Jsb2NrLT5oZWFk
ZXIuZmxhZ3MgJiBBQ1BJX0lWTURfUkVBRDsKKyAgICAgICAgaXIgPSBpdm1k
X2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfV1JJVEU7CiAgICAg
fQogICAgIGVsc2UKICAgICB7CkBAIC00MjUsMjAgKzQwMSwyMCBAQCBzdGF0
aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2Jsb2NrKGNvbnN0CiAgICAgc3dp
dGNoKCBpdm1kX2Jsb2NrLT5oZWFkZXIudHlwZSApCiAgICAgewogICAgIGNh
c2UgQUNQSV9JVlJTX1RZUEVfTUVNT1JZX0FMTDoKLSAgICAgICAgcmV0dXJu
IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfYWxsX2RldmljZXMoCi0g
ICAgICAgICAgICBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICAgICAgcmV0
dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygKKyAgICAgICAg
ICAgIGJhc2UsIGxpbWl0LCBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBj
YXNlIEFDUElfSVZSU19UWVBFX01FTU9SWV9PTkU6Ci0gICAgICAgIHJldHVy
biBwYXJzZV9pdm1kX2RldmljZV9zZWxlY3QoaXZtZF9ibG9jaywKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLCBsaW1p
dCwgaXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNl
X3NlbGVjdChpdm1kX2Jsb2NrLCBiYXNlLCBsaW1pdCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIsIGV4Y2x1c2lv
bik7CiAKICAgICBjYXNlIEFDUElfSVZSU19UWVBFX01FTU9SWV9SQU5HRToK
LSAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX3JhbmdlKGl2bWRf
YmxvY2ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNl
X2l2bWRfZGV2aWNlX3JhbmdlKGl2bWRfYmxvY2ssIGJhc2UsIGxpbWl0LAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGly
LCBleGNsdXNpb24pOwogCiAgICAgY2FzZSBBQ1BJX0lWUlNfVFlQRV9NRU1P
UllfSU9NTVU6Ci0gICAgICAgIHJldHVybiBwYXJzZV9pdm1kX2RldmljZV9p
b21tdShpdm1kX2Jsb2NrLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYmFzZSwgbGltaXQsIGl3LCBpcik7CisgICAgICAgIHJl
dHVybiBwYXJzZV9pdm1kX2RldmljZV9pb21tdShpdm1kX2Jsb2NrLCBiYXNl
LCBsaW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIGRlZmF1bHQ6CiAgICAg
ICAgIEFNRF9JT01NVV9ERUJVRygiSVZNRCBFcnJvcjogSW52YWxpZCBCbG9j
ayBUeXBlIVxuIik7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9wY2lfYW1kX2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwpAQCAtMjMxLDYgKzIzMSw4IEBAIHN0
YXRpYyBpbnQgX19tdXN0X2NoZWNrIGFsbG9jYXRlX2RvbWFpbl8KICAgICBy
ZXR1cm4gcmM7CiB9CiAKK2ludCBfX3JlYWRfbW9zdGx5IGFtZF9pb21tdV9t
aW5fcGFnaW5nX21vZGUgPSAxOworCiBzdGF0aWMgaW50IGFtZF9pb21tdV9k
b21haW5faW5pdChzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHN0cnVjdCBk
b21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOwpAQCAtMjQyLDExICsy
NDQsMTMgQEAgc3RhdGljIGludCBhbWRfaW9tbXVfZG9tYWluX2luaXQoc3Ry
dWN0CiAgICAgICogLSBIVk0gY291bGQgaW4gcHJpbmNpcGxlIHVzZSAzIG9y
IDQgZGVwZW5kaW5nIG9uIGhvdyBtdWNoIGd1ZXN0CiAgICAgICogICBwaHlz
aWNhbCBhZGRyZXNzIHNwYWNlIHdlIGdpdmUgaXQsIGJ1dCB0aGlzIGlzbid0
IGtub3duIHlldCBzbyB1c2UgNAogICAgICAqICAgdW5pbGF0ZXJhbGx5Lgor
ICAgICAqIC0gVW5pdHkgbWFwcyBtYXkgcmVxdWlyZSBhbiBldmVuIGhpZ2hl
ciBudW1iZXIuCiAgICAgICovCi0gICAgaGQtPmFyY2gucGFnaW5nX21vZGUg
PSBhbWRfaW9tbXVfZ2V0X3BhZ2luZ19tb2RlKAotICAgICAgICBpc19odm1f
ZG9tYWluKGQpCi0gICAgICAgID8gMXVsIDw8IChERUZBVUxUX0RPTUFJTl9B
RERSRVNTX1dJRFRIIC0gUEFHRV9TSElGVCkKLSAgICAgICAgOiBnZXRfdXBw
ZXJfbWZuX2JvdW5kKCkgKyAxKTsKKyAgICBoZC0+YXJjaC5wYWdpbmdfbW9k
ZSA9IG1heChhbWRfaW9tbXVfZ2V0X3BhZ2luZ19tb2RlKAorICAgICAgICAg
ICAgaXNfaHZtX2RvbWFpbihkKQorICAgICAgICAgICAgPyAxdWwgPDwgKERF
RkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEggLSBQQUdFX1NISUZUKQorICAg
ICAgICAgICAgOiBnZXRfdXBwZXJfbWZuX2JvdW5kKCkgKyAxKSwKKyAgICAg
ICAgYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZSk7CiAKICAgICByZXR1cm4g
MDsKIH0K

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-7.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-7.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBpbnRyb2R1Y2UgcDJtX2lzX3NwZWNpYWwoKQoKU2VlaW5n
IHRoZSBzaW1pbGFyaXR5IG9mIGdyYW50LCBmb3JlaWduLCBhbmQgKHN1YnNl
cXVlbnRseSkgZGlyZWN0LU1NSU8KaGFuZGxpbmcsIGludHJvZHVjZSBhIG5l
dyBQMk0gdHlwZSBncm91cCBuYW1lZCAic3BlY2lhbCIgKGFzIGluICJuZWVk
aW5nCnNwZWNpYWwgYWNjZXNzb3JzIHRvIGNyZWF0ZS9kZXN0cm95IikuCgpB
bHNvIHVzZSAtRVBFUk0gaW5zdGVhZCBvZiBvdGhlciBlcnJvciBjb2RlcyBv
biB0aGUgdHdvIGRvbWFpbl9jcmFzaCgpCnBhdGhzIHRvdWNoZWQuCgpUaGlz
IGlzIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtODA3LDcgKzgw
Nyw3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJt
LAogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRl
cik7IGkrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOwotICAgICAgICAgICAgaWYgKCAhcDJtX2lzX2dyYW50KHQpICYmICFw
Mm1faXNfc2hhcmVkKHQpICYmICFwMm1faXNfZm9yZWlnbih0KSApCisgICAg
ICAgICAgICBpZiAoICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3No
YXJlZCh0KSApCiAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4o
bWZuX3gobWZuKSArIGksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAg
fQogICAgIH0KQEAgLTkzNSwxMyArOTM1LDEzIEBAIGd1ZXN0X3BoeXNtYXBf
YWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKICAg
ICAgICAgICAgIEFTU0VSVCghcDJtX2lzX3NoYXJlZChvdCkpOwogICAgICAg
ICB9Ci0gICAgICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1faXNf
Zm9yZWlnbihvdCkgKQorICAgICAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90
KSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIC8qIFJlYWxseSBzaG91bGRu
J3QgYmUgdW5tYXBwaW5nIGdyYW50L2ZvcmVpZ24gbWFwcyB0aGlzIHdheSAq
LworICAgICAgICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFu
dC9mb3JlaWduIHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2Ny
YXNoKGQpOwogICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAg
ICAgICAgCi0gICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAg
ICAgIHJldHVybiAtRVBFUk07CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBp
ZiAoIHAybV9pc19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKICAg
ICAgICAgewpAQCAtMTAzNSw4ICsxMDM1LDcgQEAgaW50IHAybV9jaGFuZ2Vf
dHlwZV9vbmUoc3RydWN0IGRvbWFpbiAqZAogICAgIHN0cnVjdCBwMm1fZG9t
YWluICpwMm0gPSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAgICAgaW50IHJjOwog
Ci0gICAgQlVHX09OKHAybV9pc19ncmFudChvdCkgfHwgcDJtX2lzX2dyYW50
KG50KSk7Ci0gICAgQlVHX09OKHAybV9pc19mb3JlaWduKG90KSB8fCBwMm1f
aXNfZm9yZWlnbihudCkpOworICAgIEJVR19PTihwMm1faXNfc3BlY2lhbChv
dCkgfHwgcDJtX2lzX3NwZWNpYWwobnQpKTsKIAogICAgIGdmbl9sb2NrKHAy
bSwgZ2ZuLCAwKTsKIApAQCAtMTI4MywxMSArMTI4MiwxMSBAQCBzdGF0aWMg
aW50IHNldF90eXBlZF9wMm1fZW50cnkoc3RydWN0IGRvCiAgICAgICAgIGdm
bl91bmxvY2socDJtLCBnZm4sIG9yZGVyKTsKICAgICAgICAgcmV0dXJuIGN1
cl9vcmRlciArIDE7CiAgICAgfQotICAgIGlmICggcDJtX2lzX2dyYW50KG90
KSB8fCBwMm1faXNfZm9yZWlnbihvdCkgKQorICAgIGlmICggcDJtX2lzX3Nw
ZWNpYWwob3QpICkKICAgICB7CiAgICAgICAgIGdmbl91bmxvY2socDJtLCBn
Zm4sIG9yZGVyKTsKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAg
ICByZXR1cm4gLUVOT0VOVDsKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAg
ICB9CiAgICAgZWxzZSBpZiAoIHAybV9pc19yYW0ob3QpICkKICAgICB7Ci0t
LSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9wMm0uaApAQCAtMTQxLDYgKzE0MSwxMCBAQCB0eXBlZGVm
IHVuc2lnbmVkIGludCBwMm1fcXVlcnlfdDsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8IHAybV90b19tYXNrKHAybV9yYW1fbG9nZGlydHkpICkK
ICNkZWZpbmUgUDJNX1NIQVJFRF9UWVBFUyAgIChwMm1fdG9fbWFzayhwMm1f
cmFtX3NoYXJlZCkpCiAKKy8qIFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQg
dXAgdmlhIHNwZWNpYWwgYWNjZXNzb3JzLiAqLworI2RlZmluZSBQMk1fU1BF
Q0lBTF9UWVBFUyAoUDJNX0dSQU5UX1RZUEVTIHwgXAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSkK
KwogLyogVmFsaWQgdHlwZXMgbm90IG5lY2Vzc2FyaWx5IGFzc29jaWF0ZWQg
d2l0aCBhICh2YWxpZCkgTUZOLiAqLwogI2RlZmluZSBQMk1fSU5WQUxJRF9N
Rk5fVFlQRVMgKFAyTV9QT0RfVFlQRVMgICAgICAgICAgICAgICAgICBcCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBwMm1fdG9fbWFzayhw
Mm1fbW1pb19kaXJlY3QpIFwKQEAgLTE2OSw2ICsxNzMsNyBAQCB0eXBlZGVm
IHVuc2lnbmVkIGludCBwMm1fcXVlcnlfdDsKICNkZWZpbmUgcDJtX2lzX3Bh
Z2VkKF90KSAgICAocDJtX3RvX21hc2soX3QpICYgUDJNX1BBR0VEX1RZUEVT
KQogI2RlZmluZSBwMm1faXNfc2hhcmFibGUoX3QpIChwMm1fdG9fbWFzayhf
dCkgJiBQMk1fU0hBUkFCTEVfVFlQRVMpCiAjZGVmaW5lIHAybV9pc19zaGFy
ZWQoX3QpICAgKHAybV90b19tYXNrKF90KSAmIFAyTV9TSEFSRURfVFlQRVMp
CisjZGVmaW5lIHAybV9pc19zcGVjaWFsKF90KSAgKHAybV90b19tYXNrKF90
KSAmIFAyTV9TUEVDSUFMX1RZUEVTKQogI2RlZmluZSBwMm1faXNfYnJva2Vu
KF90KSAgIChwMm1fdG9fbWFzayhfdCkgJiBQMk1fQlJPS0VOX1RZUEVTKQog
I2RlZmluZSBwMm1faXNfZm9yZWlnbihfdCkgIChwMm1fdG9fbWFzayhfdCkg
JiBwMm1fdG9fbWFzayhwMm1fbWFwX2ZvcmVpZ24pKQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.14-8.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.14-8.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBndWFyZCAoaW4gcGFydGljdWxhcikgaWRlbnRpdHkgbWFw
cGluZyBlbnRyaWVzCgpTdWNoIGVudHJpZXMsIGNyZWF0ZWQgYnkgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpLCBzaG91bGQgb25seSBiZQpkZXN0cm95ZWQg
YnkgY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KCkuIEhvd2V2ZXIsIHNpbWls
YXJseSwgZW50cmllcwpjcmVhdGVkIGJ5IHNldF9tbWlvX3AybV9lbnRyeSgp
IHNob3VsZCBvbmx5IGJlIHRvcm4gZG93biBieQpjbGVhcl9tbWlvX3AybV9l
bnRyeSgpLCBzbyB0aGUgbG9naWMgZ2V0cyBiYXNlZCB1cG9uIHAybV9tbWlv
X2RpcmVjdCBhcwp0aGUgZW50cnkgdHlwZSAoc2VwYXJhdGlvbiBiZXR3ZWVu
ICJvcmRpbmFyeSIgYW5kIDE6MSBtYXBwaW5ncyB3b3VsZApyZXF1aXJlIGEg
ZnVydGhlciBpbmRpY2F0b3IgdG8gdGVsbCBhcGFydCB0aGUgdHdvKS4KCkFz
IHRvIHRoZSBndWVzdF9yZW1vdmVfcGFnZSgpIGNoYW5nZSwgY29tbWl0IDQ4
ZGZiMjk3YTIwYSAoIng4Ni9QVkg6CmFsbG93IGd1ZXN0X3JlbW92ZV9wYWdl
IHRvIHJlbW92ZSBwMm1fbW1pb19kaXJlY3QgcGFnZXMiKSwgd2hpY2gKaW50
cm9kdWNlZCB0aGUgY2FsbCB0byBjbGVhcl9tbWlvX3AybV9lbnRyeSgpLCBj
bGFpbWVkIHRoaXMgd2FzIGRvbmUgZm9yCmh3ZG9tIG9ubHkgd2l0aG91dCB0
aGlzIGFjdHVhbGx5IGhhdmluZyBiZWVuIHRoZSBjYXNlLiBIb3dldmVyLCB0
aGlzCmNvZGUgc2hvdWxkbid0IGJlIHRoZXJlIGluIHRoZSBmaXJzdCBwbGFj
ZSwgYXMgTU1JTyBlbnRyaWVzIHNob3VsZG4ndCBiZQpkcm9wcGVkIHRoaXMg
d2F5LiBBdm9pZCB0cmlnZ2VyaW5nIHRoZSB3YXJuaW5nIGFnYWluIHRoYXQg
NDhkZmIyOTdhMjBhCnNpbGVuY2VkIGJ5IGFuIGFkanVzdG1lbnQgdG8geGVu
bWVtX2FkZF90b19waHlzbWFwX29uZSgpIGluc3RlYWQuCgpOb3RlIHRoYXQg
Z3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZCgpIGdldHMg
dGlnaHRlbmVkIGJleW9uZAp0aGUgaW1tZWRpYXRlIHB1cnBvc2Ugb2YgdGhp
cyBjaGFuZ2UuCgpOb3RlIGFsc28gdGhhdCBJIGRpZG4ndCBpbnNwZWN0IGNv
ZGUgd2hpY2ggaXNuJ3Qgc2VjdXJpdHkgc3VwcG9ydGVkLAplLmcuIHNoYXJp
bmcsIHBhZ2luZywgb3IgYWx0cDJtLgoKVGhpcyBpcyBDVkUtMjAyMS0yODY5
NCAvIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tLmMK
KysrIGIveGVuL2FyY2gveDg2L21tLmMKQEAgLTQ2NTIsNyArNDY1Miw5IEBA
IGludCB4ZW5tZW1fYWRkX3RvX3BoeXNtYXBfb25lKAogCiAgICAgLyogUmVt
b3ZlIHByZXZpb3VzbHkgbWFwcGVkIHBhZ2UgaWYgaXQgd2FzIHByZXNlbnQu
ICovCiAgICAgcHJldl9tZm4gPSBnZXRfZ2ZuKGQsIGdmbl94KGdwZm4pLCAm
cDJtdCk7Ci0gICAgaWYgKCBtZm5fdmFsaWQocHJldl9tZm4pICkKKyAgICBp
ZiAoIHAybXQgPT0gcDJtX21taW9fZGlyZWN0ICkKKyAgICAgICAgcmMgPSAt
RVBFUk07CisgICAgZWxzZSBpZiAoIG1mbl92YWxpZChwcmV2X21mbikgKQog
ICAgIHsKICAgICAgICAgaWYgKCBpc19zcGVjaWFsX3BhZ2UobWZuX3RvX3Bh
Z2UocHJldl9tZm4pKSApCiAgICAgICAgICAgICAvKiBTcGVjaWFsIHBhZ2Vz
IGFyZSBzaW1wbHkgdW5ob29rZWQgZnJvbSB0aGlzIHBoeXMgc2xvdC4gKi8K
LS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS9wMm0uYwpAQCAtNzk1LDcgKzc5NSw4IEBAIHAybV9yZW1vdmVfcGFn
ZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJmN1cl9vcmRlciwgTlVMTCk7CiAK
ICAgICAgICAgaWYgKCBwMm1faXNfdmFsaWQodCkgJiYKLSAgICAgICAgICAg
ICAoIW1mbl92YWxpZChtZm4pIHx8ICFtZm5fZXEobWZuX2FkZChtZm4sIGkp
LCBtZm5fcmV0dXJuKSkgKQorICAgICAgICAgICAgICghbWZuX3ZhbGlkKG1m
bikgfHwgdCA9PSBwMm1fbW1pb19kaXJlY3QgfHwKKyAgICAgICAgICAgICAg
IW1mbl9lcShtZm5fYWRkKG1mbiwgaSksIG1mbl9yZXR1cm4pKSApCiAgICAg
ICAgICAgICByZXR1cm4gLUVJTFNFUTsKIAogICAgICAgICBpICs9ICgxVUwg
PDwgY3VyX29yZGVyKSAtCkBAIC04OTMsNyArODk0LDcgQEAgZ3Vlc3RfcGh5
c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAqZAogICAgIGlmICggcDJt
X2lzX2ZvcmVpZ24odCkgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAot
ICAgIGlmICggIW1mbl92YWxpZChtZm4pICkKKyAgICBpZiAoICFtZm5fdmFs
aWQobWZuKSB8fCB0ID09IHAybV9tbWlvX2RpcmVjdCApCiAgICAgewogICAg
ICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7CkBAIC05MzcsNyArOTM4LDcgQEAgZ3Vlc3RfcGh5c21hcF9hZGRf
ZW50cnkoc3RydWN0IGRvbWFpbiAqZAogICAgICAgICB9CiAgICAgICAgIGlm
ICggcDJtX2lzX3NwZWNpYWwob3QpICkKICAgICAgICAgewotICAgICAgICAg
ICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9mb3JlaWduIHRo
aXMgd2F5LiAqLworICAgICAgICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFw
cGluZyBncmFudC9mb3JlaWduL2RpcmVjdC1NTUlPIHRoaXMgd2F5LiAqLwog
ICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwogICAgICAgICAgICAgcDJt
X3VubG9jayhwMm0pOwogICAgICAgICAgICAgCkBAIC0xMzg3LDggKzEzODgs
OCBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShzdHJ1Y3QgZG9tYWlu
CiAgKiAgICBvcmRlcisxICBmb3IgY2FsbGVyIHRvIHJldHJ5IHdpdGggb3Jk
ZXIgKGd1YXJhbnRlZWQgc21hbGxlciB0aGFuCiAgKiAgICAgICAgICAgICB0
aGUgb3JkZXIgdmFsdWUgcGFzc2VkIGluKQogICovCi1pbnQgY2xlYXJfbW1p
b19wMm1fZW50cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBn
Zm5fbCwgbWZuX3QgbWZuLAotICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBvcmRlcikKK3N0YXRpYyBpbnQgY2xlYXJfbW1pb19wMm1f
ZW50cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWZuX3QgbWZuLCB1
bnNpZ25lZCBpbnQgb3JkZXIpCiB7CiAgICAgaW50IHJjID0gLUVJTlZBTDsK
ICAgICBnZm5fdCBnZm4gPSBfZ2ZuKGdmbl9sKTsKLS0tIGEveGVuL2FyY2gv
eDg2L21tL3AybS1wb2QuYworKysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLXBv
ZC5jCkBAIC0xMjkyLDE3ICsxMjkyLDE3IEBAIGd1ZXN0X3BoeXNtYXBfbWFy
a19wb3B1bGF0ZV9vbl9kZW1hbmQoc3QKIAogICAgICAgICBwMm0tPmdldF9l
bnRyeShwMm0sIGdmbl9hZGQoZ2ZuLCBpKSwgJm90LCAmYSwgMCwgJmN1cl9v
cmRlciwgTlVMTCk7CiAgICAgICAgIG4gPSAxVUwgPDwgbWluKG9yZGVyLCBj
dXJfb3JkZXIpOwotICAgICAgICBpZiAoIHAybV9pc19yYW0ob3QpICkKKyAg
ICAgICAgaWYgKCBvdCA9PSBwMm1fcG9wdWxhdGVfb25fZGVtYW5kICkKKyAg
ICAgICAgeworICAgICAgICAgICAgLyogQ291bnQgaG93IG1hbnkgUG9EIGVu
dHJpZXMgd2UnbGwgYmUgcmVwbGFjaW5nIGlmIHN1Y2Nlc3NmdWwgKi8KKyAg
ICAgICAgICAgIHBvZF9jb3VudCArPSBuOworICAgICAgICB9CisgICAgICAg
IGVsc2UgaWYgKCBvdCAhPSBwMm1faW52YWxpZCAmJiBvdCAhPSBwMm1fbW1p
b19kbSApCiAgICAgICAgIHsKICAgICAgICAgICAgIFAyTV9ERUJVRygiZ2Zu
X3RvX21mbiByZXR1cm5lZCB0eXBlICVkIVxuIiwgb3QpOwogICAgICAgICAg
ICAgcmMgPSAtRUJVU1k7CiAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAg
ICAgfQotICAgICAgICBlbHNlIGlmICggb3QgPT0gcDJtX3BvcHVsYXRlX29u
X2RlbWFuZCApCi0gICAgICAgIHsKLSAgICAgICAgICAgIC8qIENvdW50IGhv
dyBtYW4gUG9EIGVudHJpZXMgd2UnbGwgYmUgcmVwbGFjaW5nIGlmIHN1Y2Nl
c3NmdWwgKi8KLSAgICAgICAgICAgIHBvZF9jb3VudCArPSBuOwotICAgICAg
ICB9CiAgICAgfQogCiAgICAgLyogTm93LCBhY3R1YWxseSBkbyB0aGUgdHdv
LXdheSBtYXBwaW5nICovCi0tLSBhL3hlbi9jb21tb24vbWVtb3J5LmMKKysr
IGIveGVuL2NvbW1vbi9tZW1vcnkuYwpAQCAtMzI5LDcgKzMyOSw3IEBAIGlu
dCBndWVzdF9yZW1vdmVfcGFnZShzdHJ1Y3QgZG9tYWluICpkLAogICAgIH0K
ICAgICBpZiAoIHAybXQgPT0gcDJtX21taW9fZGlyZWN0ICkKICAgICB7Ci0g
ICAgICAgIHJjID0gY2xlYXJfbW1pb19wMm1fZW50cnkoZCwgZ21mbiwgbWZu
LCBQQUdFX09SREVSXzRLKTsKKyAgICAgICAgcmMgPSAtRVBFUk07CiAgICAg
ICAgIGdvdG8gb3V0X3B1dF9nZm47CiAgICAgfQogI2Vsc2UKQEAgLTE3MjEs
NiArMTcyMSwxNSBAQCBpbnQgY2hlY2tfZ2V0X3BhZ2VfZnJvbV9nZm4oc3Ry
dWN0IGRvbWFpCiAgICAgICAgIHJldHVybiAtRUFHQUlOOwogICAgIH0KICNl
bmRpZgorI2lmZGVmIENPTkZJR19YODYKKyAgICBpZiAoIHAybXQgPT0gcDJt
X21taW9fZGlyZWN0ICkKKyAgICB7CisgICAgICAgIGlmICggcGFnZSApCisg
ICAgICAgICAgICBwdXRfcGFnZShwYWdlKTsKKworICAgICAgICByZXR1cm4g
LUVQRVJNOworICAgIH0KKyNlbmRpZgogCiAgICAgaWYgKCAhcGFnZSApCiAg
ICAgICAgIHJldHVybiAtRUlOVkFMOwotLS0gYS94ZW4vaW5jbHVkZS9hc20t
eDg2L3AybS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKQEAg
LTE0Myw3ICsxNDMsOCBAQCB0eXBlZGVmIHVuc2lnbmVkIGludCBwMm1fcXVl
cnlfdDsKIAogLyogVHlwZXMgZXN0YWJsaXNoZWQvY2xlYW5lZCB1cCB2aWEg
c3BlY2lhbCBhY2Nlc3NvcnMuICovCiAjZGVmaW5lIFAyTV9TUEVDSUFMX1RZ
UEVTIChQMk1fR1JBTlRfVFlQRVMgfCBcCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICBwMm1fdG9fbWFzayhwMm1fbWFwX2ZvcmVpZ24pKQorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3Jl
aWduKSB8IFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV90b19t
YXNrKHAybV9tbWlvX2RpcmVjdCkpCiAKIC8qIFZhbGlkIHR5cGVzIG5vdCBu
ZWNlc3NhcmlseSBhc3NvY2lhdGVkIHdpdGggYSAodmFsaWQpIE1GTi4gKi8K
ICNkZWZpbmUgUDJNX0lOVkFMSURfTUZOX1RZUEVTIChQMk1fUE9EX1RZUEVT
ICAgICAgICAgICAgICAgICAgXApAQCAtNjQ1LDggKzY0Niw2IEBAIGludCBz
ZXRfZm9yZWlnbl9wMm1fZW50cnkoc3RydWN0IGRvbWFpbgogLyogU2V0IG1t
aW8gYWRkcmVzc2VzIGluIHRoZSBwMm0gdGFibGUgKGZvciBwYXNzLXRocm91
Z2gpICovCiBpbnQgc2V0X21taW9fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4g
KmQsIGdmbl90IGdmbiwgbWZuX3QgbWZuLAogICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgb3JkZXIpOwotaW50IGNsZWFyX21taW9fcDJt
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLCBt
Zm5fdCBtZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IG9yZGVyKTsKIAogLyogU2V0IGlkZW50aXR5IGFkZHJlc3NlcyBpbiB0
aGUgcDJtIHRhYmxlIChmb3IgcGFzcy10aHJvdWdoKSAqLwogaW50IHNldF9p
ZGVudGl0eV9wMm1fZW50cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQg
bG9uZyBnZm4sCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-1.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZ2xvYmFsIGV4Y2x1c2lvbiByYW5nZSBl
eHRlbmRpbmcKCkJlc2lkZXMgdW5pdHkgbWFwcGluZyByZWdpb25zLCB0aGUg
QU1EIElPTU1VIHNwZWMgYWxzbyBwcm92aWRlcyBmb3IKZXhjbHVzaW9uIHJh
bmdlcyAoYXJlYXMgb2YgbWVtb3J5IG5vdCB0byBiZSBzdWJqZWN0IHRvIERN
QSB0cmFuc2xhdGlvbikKdG8gYmUgc3BlY2lmaWVkIGJ5IGZpcm13YXJlIGlu
IHRoZSBBQ1BJIHRhYmxlcy4gVGhlIHNwZWMgZG9lcyBub3QgcHV0CmFueSBj
b25zdHJhaW50cyBvbiB0aGUgbnVtYmVyIG9mIHN1Y2ggcmVnaW9ucy4KCkJs
aW5kbHkgYXNzdW1pbmcgYWxsIGFkZHJlc3NlcyBiZXR3ZWVuIGFueSB0d28g
c3VjaCByYW5nZXMgc2hvdWxkIGFsc28KYmUgZXhjbHVkZWQgY2FuJ3QgYmUg
cmlnaHQuIFNpbmNlIGhhcmR3YXJlIGhhcyByb29tIGZvciBqdXN0IGEgc2lu
Z2xlCnN1Y2ggcmFuZ2UgKGNvbXByaXNlZCBvZiB0aGUgRXhjbHVzaW9uIEJh
c2UgUmVnaXN0ZXIgYW5kIHRoZSBFeGNsdXNpb24KUmFuZ2UgTGltaXQgUmVn
aXN0ZXIpLCBjb21iaW5lIG9ubHkgYWRqYWNlbnQgb3Igb3ZlcmxhcHBpbmcg
cmVnaW9ucyAoZm9yCm5vdzsgdGhpcyBtYXkgcmVxdWlyZSBmdXJ0aGVyIGFk
anVzdG1lbnQgaW4gY2FzZSB0YWJsZSBlbnRyaWVzIGFyZW4ndApzb3J0ZWQg
YnkgYWRkcmVzcykgd2l0aCBtYXRjaGluZyBleGNsdXNpb25fYWxsb3dfYWxs
IHNldHRpbmdzLiBUaGlzCnJlcXVpcmVzIGJ1YmJsaW5nIHVwIGVycm9yIGlu
ZGljYXRvcnMsIHN1Y2ggdGhhdCBJT01NVSBpbml0IGNhbiBiZQpmYWlsZWQg
d2hlbiBjb25jYXRlbmF0aW9uIHdhc24ndCBwb3NzaWJsZS4KCkZ1cnRoZXJt
b3JlLCBzaW5jZSB0aGUgZXhjbHVzaW9uIHJhbmdlIHNwZWNpZmllZCBpbiBJ
T01NVSByZWdpc3RlcnMKaW1wbGllcyBSL1cgYWNjZXNzLCByZWplY3QgcmVx
dWVzdHMgYXNraW5nIGZvciBsZXNzIHBlcm1pc3Npb25zICh0aGlzCndpbGwg
YmUgYnJvdWdodCBjbG9zZXIgdG8gdGhlIHNwZWMgYnkgYSBzdWJzZXF1ZW50
IGNoYW5nZSkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3OCAvIENWRS0yMDIx
LTI4Njk1LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9hY3BpLmMKQEAgLTExNiwxMiArMTE2LDIxIEBAIHN0YXRpYyBzdHJ1
Y3QgYW1kX2lvbW11ICogX19pbml0IGZpbmRfaW8KICAgICByZXR1cm4gTlVM
TDsKIH0KIAotc3RhdGljIHZvaWQgX19pbml0IHJlc2VydmVfaW9tbXVfZXhj
bHVzaW9uX3JhbmdlKAotICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1
aW50NjRfdCBiYXNlLCB1aW50NjRfdCBsaW1pdCkKK3N0YXRpYyBpbnQgX19p
bml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKAorICAgIHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11LCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBs
aW1pdCwKKyAgICBib29sIGFsbCwgYm9vbCBpdywgYm9vbCBpcikKIHsKKyAg
ICBpZiAoICFpciB8fCAhaXcgKQorICAgICAgICByZXR1cm4gLUVQRVJNOwor
CiAgICAgLyogbmVlZCB0byBleHRlbmQgZXhjbHVzaW9uIHJhbmdlPyAqLwog
ICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9lbmFibGUgKQogICAgIHsKKyAg
ICAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9uX2xpbWl0ICsgUEFHRV9TSVpF
IDwgYmFzZSB8fAorICAgICAgICAgICAgIGxpbWl0ICsgUEFHRV9TSVpFIDwg
aW9tbXUtPmV4Y2x1c2lvbl9iYXNlIHx8CisgICAgICAgICAgICAgaW9tbXUt
PmV4Y2x1c2lvbl9hbGxvd19hbGwgIT0gYWxsICkKKyAgICAgICAgICAgIHJl
dHVybiAtRUJVU1k7CisKICAgICAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9u
X2Jhc2UgPCBiYXNlICkKICAgICAgICAgICAgIGJhc2UgPSBpb21tdS0+ZXhj
bHVzaW9uX2Jhc2U7CiAgICAgICAgIGlmICggaW9tbXUtPmV4Y2x1c2lvbl9s
aW1pdCA+IGxpbWl0ICkKQEAgLTEyOSwxNiArMTM4LDExIEBAIHN0YXRpYyB2
b2lkIF9faW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2kKICAgICB9CiAKICAg
ICBpb21tdS0+ZXhjbHVzaW9uX2VuYWJsZSA9IElPTU1VX0NPTlRST0xfRU5B
QkxFRDsKKyAgICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCA9IGFsbDsK
ICAgICBpb21tdS0+ZXhjbHVzaW9uX2Jhc2UgPSBiYXNlOwogICAgIGlvbW11
LT5leGNsdXNpb25fbGltaXQgPSBsaW1pdDsKLX0KIAotc3RhdGljIHZvaWQg
X19pbml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlX2FsbCgKLSAg
ICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICB1bnNpZ25lZCBsb25n
IGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQpCi17Ci0gICAgcmVzZXJ2ZV9p
b21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0KTsKLSAg
ICBpb21tdS0+ZXhjbHVzaW9uX2FsbG93X2FsbCA9IElPTU1VX0NPTlRST0xf
RU5BQkxFRDsKKyAgICByZXR1cm4gMDsKIH0KIAogc3RhdGljIHZvaWQgX19p
bml0IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoCkBAIC0xNzYsNiAr
MTgwLDcgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbgogICAgIHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3As
IGxlbmd0aDsKICAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdTsKICAgICB1
bnNpZ25lZCBpbnQgYmRmOworICAgIGludCByYyA9IDA7CiAKICAgICAvKiBp
cyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5nZSBpbnNpZGUgb2YgSU9NTVUgdmly
dHVhbCBhZGRyZXNzIHNwYWNlPyAqLwogICAgIC8qIG5vdGU6ICdsaW1pdCcg
cGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICovCkBA
IC0xOTcsMTAgKzIwMiwxNSBAQCBzdGF0aWMgaW50IF9faW5pdCByZWdpc3Rl
cl9leGNsdXNpb25fcmFuCiAgICAgaWYgKCBsaW1pdCA+PSBpb21tdV90b3Ag
KQogICAgIHsKICAgICAgICAgZm9yX2VhY2hfYW1kX2lvbW11KCBpb21tdSAp
Ci0gICAgICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZV9h
bGwoaW9tbXUsIGJhc2UsIGxpbWl0KTsKKyAgICAgICAgeworICAgICAgICAg
ICAgcmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwg
YmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOworICAg
ICAgICAgICAgaWYgKCByYyApCisgICAgICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1cm4gMDsKKyAgICByZXR1cm4g
cmM7CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW5nZV9mb3JfZGV2aWNlKApAQCAtMjExLDYgKzIyMSw3IEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICB1bnNp
Z25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7CiAgICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CiAgICAgdTE2IHJlcTsKKyAgICBp
bnQgcmMgPSAwOwogCiAgICAgaW9tbXUgPSBmaW5kX2lvbW11X2Zvcl9kZXZp
Y2Uoc2VnLCBiZGYpOwogICAgIGlmICggIWlvbW11ICkKQEAgLTI0MCwxMiAr
MjUxLDEzIEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lv
bl9yYW4KICAgICAvKiByZWdpc3RlciBJT01NVSBleGNsdXNpb24gcmFuZ2Ug
c2V0dGluZ3MgZm9yIGRldmljZSAqLwogICAgIGlmICggbGltaXQgPj0gaW9t
bXVfdG9wICApCiAgICAgewotICAgICAgICByZXNlcnZlX2lvbW11X2V4Y2x1
c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQpOworICAgICAgICByYyA9
IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBs
aW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmYWxzZSAvKiBhbGwgKi8sIGl3LCBpcik7CiAgICAgICAgIGl2cnNf
bWFwcGluZ3NbYmRmXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gdHJ1ZTsKICAg
ICAgICAgaXZyc19tYXBwaW5nc1tyZXFdLmR0ZV9hbGxvd19leGNsdXNpb24g
PSB0cnVlOwogICAgIH0KIAotICAgIHJldHVybiAwOworICAgIHJldHVybiBy
YzsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbmdlX2Zvcl9pb21tdV9kZXZpY2VzKApAQCAtMjU1LDYgKzI2Nyw3IEBA
IHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAg
ICB1bnNpZ25lZCBsb25nIHJhbmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7
CiAgICAgdW5zaWduZWQgaW50IGJkZjsKICAgICB1MTYgcmVxOworICAgIGlu
dCByYyA9IDA7CiAKICAgICAvKiBpcyBwYXJ0IG9mIGV4Y2x1c2lvbiByYW5n
ZSBpbnNpZGUgb2YgSU9NTVUgdmlydHVhbCBhZGRyZXNzIHNwYWNlPyAqLwog
ICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8g
YmUgcGFnZS1hbGlnbmVkICovCkBAIC0yODUsOCArMjk4LDEwIEBAIHN0YXRp
YyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KIAogICAgIC8q
IHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwog
ICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkKLSAgICAgICAgcmVzZXJ2
ZV9pb21tdV9leGNsdXNpb25fcmFuZ2VfYWxsKGlvbW11LCBiYXNlLCBsaW1p
dCk7Ci0gICAgcmV0dXJuIDA7CisgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21t
dV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyog
YWxsICovLCBpdywgaXIpOworCisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0
aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9zZWxlY3QoCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-2.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGNvcnJlY3QgZGV2aWNlIHVuaXR5IG1hcCBoYW5kbGlu
ZwoKQmxpbmRseSBhc3N1bWluZyBhbGwgYWRkcmVzc2VzIGJldHdlZW4gYW55
IHR3byBzdWNoIHJhbmdlcywgc3BlY2lmaWVkIGJ5CmZpcm13YXJlIGluIHRo
ZSBBQ1BJIHRhYmxlcywgc2hvdWxkIGFsc28gYmUgdW5pdHktbWFwcGVkIGNh
bid0IGJlIHJpZ2h0LgpOb3IgY2FuIGl0IGJlIGNvcnJlY3QgdG8gbWVyZ2Ug
cmFuZ2VzIHdpdGggZGlmZmVyaW5nIHBlcm1pc3Npb25zLiBUcmFjawpyYW5n
ZXMgaW5kaXZpZHVhbGx5OyBkb24ndCBtZXJnZSBhdCBhbGwsIGJ1dCBjaGVj
ayBmb3Igb3ZlcmxhcHMgaW5zdGVhZC4KVGhpcyByZXF1aXJlcyBidWJibGlu
ZyB1cCBlcnJvciBpbmRpY2F0b3JzLCBzdWNoIHRoYXQgSU9NTVUgaW5pdCBj
YW4gYmUKZmFpbGVkIHdoZW4gYWxsb2NhdGlvbiBvZiBhIG5ldyB0cmFja2lu
ZyBzdHJ1Y3Qgd2Fzbid0IHBvc3NpYmxlLCBvciBhbgpvdmVybGFwIHdhcyBk
ZXRlY3RlZC4KCkF0IHRoaXMgb2NjYXNpb24gYWxzbyBzdG9wIGlnbm9yaW5n
CmFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoKSdzIHJldHVy
biB2YWx1ZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4IC8gQ1ZFLTIwMjEt
Mjg2OTUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2Uu
ZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQg
PHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdS5oCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdS5oCkBAIC0xMDcsMjAgKzEwNywyNCBAQCBzdHJ1Y3QgYW1kX2lv
bW11IHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGF0c19kZXZpY2VzOwogfTsK
IAorc3RydWN0IGl2cnNfdW5pdHlfbWFwIHsKKyAgICBib29sIHJlYWQ6MTsK
KyAgICBib29sIHdyaXRlOjE7CisgICAgcGFkZHJfdCBhZGRyOworICAgIHVu
c2lnbmVkIGxvbmcgbGVuZ3RoOworICAgIHN0cnVjdCBpdnJzX3VuaXR5X21h
cCAqbmV4dDsKK307CisKIHN0cnVjdCBpdnJzX21hcHBpbmdzIHsKICAgICB1
aW50MTZfdCBkdGVfcmVxdWVzdG9yX2lkOwogICAgIGJvb2wgdmFsaWQ6MTsK
ICAgICBib29sIGR0ZV9hbGxvd19leGNsdXNpb246MTsKLSAgICBib29sIHVu
aXR5X21hcF9lbmFibGU6MTsKLSAgICBib29sIHdyaXRlX3Blcm1pc3Npb246
MTsKLSAgICBib29sIHJlYWRfcGVybWlzc2lvbjoxOwogCiAgICAgLyogaXZo
ZCBkZXZpY2UgZGF0YSBzZXR0aW5ncyAqLwogICAgIHVpbnQ4X3QgZGV2aWNl
X2ZsYWdzOwogCi0gICAgdW5zaWduZWQgbG9uZyBhZGRyX3JhbmdlX3N0YXJ0
OwotICAgIHVuc2lnbmVkIGxvbmcgYWRkcl9yYW5nZV9sZW5ndGg7CiAgICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CisgICAgc3RydWN0IGl2cnNfdW5p
dHlfbWFwICp1bml0eV9tYXA7CiAKICAgICAvKiBwZXIgZGV2aWNlIGludGVy
cnVwdCByZW1hcHBpbmcgdGFibGUgKi8KICAgICB2b2lkICppbnRyZW1hcF90
YWJsZTsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X2FjcGkuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfYWNwaS5jCkBAIC0xNDUsMzIgKzE0NSw0OCBAQCBzdGF0aWMgaW50IF9f
aW5pdCByZXNlcnZlX2lvbW11X2V4Y2x1c2lvCiAgICAgcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyB2b2lkIF9faW5pdCByZXNlcnZlX3VuaXR5X21hcF9mb3Jf
ZGV2aWNlKAotICAgIHUxNiBzZWcsIHUxNiBiZGYsIHVuc2lnbmVkIGxvbmcg
YmFzZSwKLSAgICB1bnNpZ25lZCBsb25nIGxlbmd0aCwgdTggaXcsIHU4IGly
KQorc3RhdGljIGludCBfX2luaXQgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2Rl
dmljZSgKKyAgICB1aW50MTZfdCBzZWcsIHVpbnQxNl90IGJkZiwgdW5zaWdu
ZWQgbG9uZyBiYXNlLAorICAgIHVuc2lnbmVkIGxvbmcgbGVuZ3RoLCBib29s
IGl3LCBib29sIGlyKQogewogICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICpp
dnJzX21hcHBpbmdzID0gZ2V0X2l2cnNfbWFwcGluZ3Moc2VnKTsKLSAgICB1
bnNpZ25lZCBsb25nIG9sZF90b3AsIG5ld190b3A7CisgICAgc3RydWN0IGl2
cnNfdW5pdHlfbWFwICp1bml0eV9tYXAgPSBpdnJzX21hcHBpbmdzW2JkZl0u
dW5pdHlfbWFwOwogCi0gICAgLyogbmVlZCB0byBleHRlbmQgdW5pdHktbWFw
cGVkIHJhbmdlPyAqLwotICAgIGlmICggaXZyc19tYXBwaW5nc1tiZGZdLnVu
aXR5X21hcF9lbmFibGUgKQorICAgIC8qIENoZWNrIGZvciBvdmVybGFwcy4g
Ki8KKyAgICBmb3IgKCA7IHVuaXR5X21hcDsgdW5pdHlfbWFwID0gdW5pdHlf
bWFwLT5uZXh0ICkKICAgICB7Ci0gICAgICAgIG9sZF90b3AgPSBpdnJzX21h
cHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9zdGFydCArCi0gICAgICAgICAgICBp
dnJzX21hcHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9sZW5ndGg7Ci0gICAgICAg
IG5ld190b3AgPSBiYXNlICsgbGVuZ3RoOwotICAgICAgICBpZiAoIG9sZF90
b3AgPiBuZXdfdG9wICkKLSAgICAgICAgICAgIG5ld190b3AgPSBvbGRfdG9w
OwotICAgICAgICBpZiAoIGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3Jhbmdl
X3N0YXJ0IDwgYmFzZSApCi0gICAgICAgICAgICBiYXNlID0gaXZyc19tYXBw
aW5nc1tiZGZdLmFkZHJfcmFuZ2Vfc3RhcnQ7Ci0gICAgICAgIGxlbmd0aCA9
IG5ld190b3AgLSBiYXNlOwotICAgIH0KLQotICAgIC8qIGV4dGVuZCByL3cg
cGVybWlzc2lvbXMgYW5kIGtlZXAgYWdncmVnYXRlICovCi0gICAgaXZyc19t
YXBwaW5nc1tiZGZdLndyaXRlX3Blcm1pc3Npb24gPSBpdzsKLSAgICBpdnJz
X21hcHBpbmdzW2JkZl0ucmVhZF9wZXJtaXNzaW9uID0gaXI7Ci0gICAgaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcF9lbmFibGUgPSB0cnVlOwotICAg
IGl2cnNfbWFwcGluZ3NbYmRmXS5hZGRyX3JhbmdlX3N0YXJ0ID0gYmFzZTsK
LSAgICBpdnJzX21hcHBpbmdzW2JkZl0uYWRkcl9yYW5nZV9sZW5ndGggPSBs
ZW5ndGg7CisgICAgICAgIC8qCisgICAgICAgICAqIEV4YWN0IG1hdGNoZXMg
YXJlIG9rYXkuIFRoaXMgY2FuIGluIHBhcnRpY3VsYXIgaGFwcGVuIHdoZW4K
KyAgICAgICAgICogcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZp
Y2UoKSBjYWxscyBoZXJlIHR3aWNlIGZvciB0aGUKKyAgICAgICAgICogc2Ft
ZSAocyxiLGQsZikuCisgICAgICAgICAqLworICAgICAgICBpZiAoIGJhc2Ug
PT0gdW5pdHlfbWFwLT5hZGRyICYmIGxlbmd0aCA9PSB1bml0eV9tYXAtPmxl
bmd0aCAmJgorICAgICAgICAgICAgIGlyID09IHVuaXR5X21hcC0+cmVhZCAm
JiBpdyA9PSB1bml0eV9tYXAtPndyaXRlICkKKyAgICAgICAgICAgIHJldHVy
biAwOworCisgICAgICAgIGlmICggdW5pdHlfbWFwLT5hZGRyICsgdW5pdHlf
bWFwLT5sZW5ndGggPiBiYXNlICYmCisgICAgICAgICAgICAgYmFzZSArIGxl
bmd0aCA+IHVuaXR5X21hcC0+YWRkciApCisgICAgICAgIHsKKyAgICAgICAg
ICAgIEFNRF9JT01NVV9ERUJVRygiSVZNRCBFcnJvcjogb3ZlcmxhcCBbJWx4
LCVseCkgdnMgWyVseCwlbHgpXG4iLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJhc2UsIGJhc2UgKyBsZW5ndGgsIHVuaXR5X21hcC0+YWRkciwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPmFkZHIg
KyB1bml0eV9tYXAtPmxlbmd0aCk7CisgICAgICAgICAgICByZXR1cm4gLUVQ
RVJNOworICAgICAgICB9CisgICAgfQorCisgICAgLyogUG9wdWxhdGUgYW5k
IGluc2VydCBhIG5ldyB1bml0eSBtYXAuICovCisgICAgdW5pdHlfbWFwID0g
eG1hbGxvYyhzdHJ1Y3QgaXZyc191bml0eV9tYXApOworICAgIGlmICggIXVu
aXR5X21hcCApCisgICAgICAgIHJldHVybiAtRU5PTUVNOworCisgICAgdW5p
dHlfbWFwLT5yZWFkID0gaXI7CisgICAgdW5pdHlfbWFwLT53cml0ZSA9IGl3
OworICAgIHVuaXR5X21hcC0+YWRkciA9IGJhc2U7CisgICAgdW5pdHlfbWFw
LT5sZW5ndGggPSBsZW5ndGg7CisgICAgdW5pdHlfbWFwLT5uZXh0ID0gaXZy
c19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcDsKKyAgICBpdnJzX21hcHBpbmdz
W2JkZl0udW5pdHlfbWFwID0gdW5pdHlfbWFwOworCisgICAgcmV0dXJuIDA7
CiB9CiAKIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9y
YW5nZV9mb3JfYWxsX2RldmljZXMoCkBAIC0xOTMsMTMgKzIwOSwxMyBAQCBz
dGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAg
ICAgIGxlbmd0aCA9IHJhbmdlX3RvcCAtIGJhc2U7CiAgICAgICAgIC8qIHJl
c2VydmUgci93IHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmlj
ZXMgKi8KICAgICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFy
dCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIGZvciAoIGJk
ZiA9IDA7IGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKLSAgICAg
ICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYs
IGJhc2UsIGxlbmd0aCwgaXcsIGlyKTsKKyAgICAgICAgZm9yICggYmRmID0g
MDsgIXJjICYmIGJkZiA8IGl2cnNfYmRmX2VudHJpZXM7IGJkZisrICkKKyAg
ICAgICAgICAgIHJjID0gcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShz
ZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOwogICAgICAgICAvKiBw
dXNoICdiYXNlJyBqdXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNw
YWNlICovCiAgICAgICAgIGJhc2UgPSBpb21tdV90b3A7CiAgICAgfQogICAg
IC8qIHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAq
LwotICAgIGlmICggbGltaXQgPj0gaW9tbXVfdG9wICkKKyAgICBpZiAoICFy
YyAmJiBsaW1pdCA+PSBpb21tdV90b3AgKQogICAgIHsKICAgICAgICAgZm9y
X2VhY2hfYW1kX2lvbW11KCBpb21tdSApCiAgICAgICAgIHsKQEAgLTI0MSwx
NSArMjU3LDE1IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1
c2lvbl9yYW4KICAgICAgICAgbGVuZ3RoID0gcmFuZ2VfdG9wIC0gYmFzZTsK
ICAgICAgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVz
IGZvciBkZXZpY2UgKi8KICAgICAgICAgLyogbm90ZTogdGhlc2UgZW50cmll
cyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAg
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2Us
IGxlbmd0aCwgaXcsIGlyKTsKLSAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBf
Zm9yX2RldmljZShzZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLCBpdywgaXIpOwor
ICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2Vn
LCBiZGYsIGJhc2UsIGxlbmd0aCwgaXcsIGlyKSA/OgorICAgICAgICAgICAg
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCByZXEsIGJhc2Us
IGxlbmd0aCwgaXcsIGlyKTsKIAogICAgICAgICAvKiBwdXNoICdiYXNlJyBq
dXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCiAgICAg
ICAgIGJhc2UgPSBpb21tdV90b3A7CiAgICAgfQogCiAgICAgLyogcmVnaXN0
ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzIGZvciBkZXZpY2Ug
Ki8KLSAgICBpZiAoIGxpbWl0ID49IGlvbW11X3RvcCAgKQorICAgIGlmICgg
IXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCAgKQogICAgIHsKICAgICAgICAg
cmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFz
ZSwgbGltaXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZmFsc2UgLyogYWxsICovLCBpdywgaXIpOwpAQCAtMjgwLDE1
ICsyOTYsMTUgQEAgc3RhdGljIGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVz
aW9uX3JhbgogICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwog
ICAgICAgICAvKiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRy
aWVzIGZvciBkZXZpY2VzICovCiAgICAgICAgIC8qIG5vdGU6IHRoZXNlIGVu
dHJpZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAg
ICAgICBmb3IgKCBiZGYgPSAwOyBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBi
ZGYrKyApCisgICAgICAgIGZvciAoIGJkZiA9IDA7ICFyYyAmJiBiZGYgPCBp
dnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIGlmICggaW9tbXUgPT0gZmluZF9pb21tdV9mb3JfZGV2aWNlKGlvbW11
LT5zZWcsIGJkZikgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAg
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRm
LCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpdywgaXIpOwogICAgICAgICAgICAgICAgIHJl
cSA9IGdldF9pdnJzX21hcHBpbmdzKGlvbW11LT5zZWcpW2JkZl0uZHRlX3Jl
cXVlc3Rvcl9pZDsKLSAgICAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21h
cF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFzZSwgbGVuZ3RoLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aXcsIGlyKTsKKyAgICAgICAgICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlf
bWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGl3LCBpcikgPzoKKyAgICAgICAgICAgICAgICAgICAgIHJlc2Vy
dmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9tbXUtPnNlZywgcmVxLCBiYXNl
LCBsZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGl3LCBpcik7CiAgICAgICAgICAgICB9CiAgICAg
ICAgIH0KIApAQCAtMjk3LDcgKzMxMyw3IEBAIHN0YXRpYyBpbnQgX19pbml0
IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW4KICAgICB9CiAKICAgICAvKiByZWdp
c3RlciBJT01NVSBleGNsdXNpb24gcmFuZ2Ugc2V0dGluZ3MgKi8KLSAgICBp
ZiAoIGxpbWl0ID49IGlvbW11X3RvcCApCisgICAgaWYgKCAhcmMgJiYgbGlt
aXQgPj0gaW9tbXVfdG9wICkKICAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBh
bGwgKi8sIGl3LCBpcik7CiAKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0zNjcsMTUgKzM2Nywx
NyBAQCBzdGF0aWMgaW50IGFtZF9pb21tdV9hc3NpZ25fZGV2aWNlKHN0cnVj
CiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBn
ZXRfaXZyc19tYXBwaW5ncyhwZGV2LT5zZWcpOwogICAgIGludCBiZGYgPSBQ
Q0lfQkRGMihwZGV2LT5idXMsIGRldmZuKTsKICAgICBpbnQgcmVxX2lkID0g
Z2V0X2RtYV9yZXF1ZXN0b3JfaWQocGRldi0+c2VnLCBiZGYpOworICAgIGNv
bnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFwOwogCi0gICAg
aWYgKCBpdnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFwX2VuYWJsZSAp
CisgICAgZm9yICggdW5pdHlfbWFwID0gaXZyc19tYXBwaW5nc1tyZXFfaWRd
LnVuaXR5X21hcDsgdW5pdHlfbWFwOworICAgICAgICAgIHVuaXR5X21hcCA9
IHVuaXR5X21hcC0+bmV4dCApCiAgICAgewotICAgICAgICBhbWRfaW9tbXVf
cmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKAotICAgICAgICAgICAgZCwKLSAg
ICAgICAgICAgIGl2cnNfbWFwcGluZ3NbcmVxX2lkXS5hZGRyX3JhbmdlX3N0
YXJ0LAotICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFfaWRdLmFkZHJf
cmFuZ2VfbGVuZ3RoLAotICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFf
aWRdLndyaXRlX3Blcm1pc3Npb24sCi0gICAgICAgICAgICBpdnJzX21hcHBp
bmdzW3JlcV9pZF0ucmVhZF9wZXJtaXNzaW9uKTsKKyAgICAgICAgaW50IHJj
ID0gYW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKKyAgICAg
ICAgICAgICAgICAgICAgIGQsIHVuaXR5X21hcC0+YWRkciwgdW5pdHlfbWFw
LT5sZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPndy
aXRlLCB1bml0eV9tYXAtPnJlYWQpOworCisgICAgICAgIGlmICggcmMgKQor
ICAgICAgICAgICAgcmV0dXJuIHJjOwogICAgIH0KIAogICAgIHJldHVybiBy
ZWFzc2lnbl9kZXZpY2UocGRldi0+ZG9tYWluLCBkLCBkZXZmbiwgcGRldik7
Cg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-3.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogYWxzbyBwYXNzIHAybV9hY2Nlc3NfdCB0byBwMm1fZ2V0X2lv
bW11X2ZsYWdzKCkKCkEgc3Vic2VxdWVudCBjaGFuZ2Ugd2lsbCB3YW50IHRv
IGN1c3RvbWl6ZSB0aGUgSU9NTVUgcGVybWlzc2lvbnMgYmFzZWQKb24gdGhp
cy4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTY4MSw3ICs2ODEsNyBAQCBlcHRfc2V0X2VudHJ5KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sIGdmCiAgICAgdWludDhfdCBpcGF0ID0gMDsKICAg
ICBib29sX3QgbmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMTsKICAgICBib29s
X3QgdnRkX3B0ZV9wcmVzZW50ID0gMDsKLSAgICB1bnNpZ25lZCBpbnQgaW9t
bXVfZmxhZ3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIG1mbik7Cisg
ICAgdW5zaWduZWQgaW50IGlvbW11X2ZsYWdzID0gcDJtX2dldF9pb21tdV9m
bGFncyhwMm10LCBwMm1hLCBtZm4pOwogICAgIGJvb2xfdCBuZWVkc19zeW5j
ID0gMTsKICAgICBlcHRfZW50cnlfdCBvbGRfZW50cnkgPSB7IC5lcHRlID0g
MCB9OwogICAgIGVwdF9lbnRyeV90IG5ld19lbnRyeSA9IHsgLmVwdGUgPSAw
IH07CkBAIC04MDksOCArODA5LDggQEAgZXB0X3NldF9lbnRyeShzdHJ1Y3Qg
cDJtX2RvbWFpbiAqcDJtLCBnZgogCiAgICAgICAgIC8qIFNhZmUgdG8gcmVh
ZC10aGVuLXdyaXRlIGJlY2F1c2Ugd2UgaG9sZCB0aGUgcDJtIGxvY2sgKi8K
ICAgICAgICAgaWYgKCBlcHRfZW50cnktPm1mbiA9PSBuZXdfZW50cnkubWZu
ICYmCi0gICAgICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhlcHRfZW50
cnktPnNhX3AybXQsIF9tZm4oZXB0X2VudHJ5LT5tZm4pKSA9PQotICAgICAg
ICAgICAgIGlvbW11X2ZsYWdzICkKKyAgICAgICAgICAgICBwMm1fZ2V0X2lv
bW11X2ZsYWdzKGVwdF9lbnRyeS0+c2FfcDJtdCwgZXB0X2VudHJ5LT5hY2Nl
c3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWZuKGVw
dF9lbnRyeS0+bWZuKSkgPT0gaW9tbXVfZmxhZ3MgKQogICAgICAgICAgICAg
bmVlZF9tb2RpZnlfdnRkX3RhYmxlID0gMDsKIAogICAgICAgICBlcHRfcDJt
X3R5cGVfdG9fZmxhZ3MocDJtLCAmbmV3X2VudHJ5KTsKLS0tIGEveGVuL2Fy
Y2gveDg2L21tL3AybS1wdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0t
cHQuYwpAQCAtNTQ1LDYgKzU0NSwxNiBAQCBpbnQgcDJtX3B0X2hhbmRsZV9k
ZWZlcnJlZF9jaGFuZ2VzKHVpbnQ2CiAgICAgcmV0dXJuIHJjOwogfQogCisv
KiBSZWNvbnN0cnVjdCBhIGZha2UgcDJtX2FjY2Vzc190IGZyb20gc3RvcmVk
IFBURSBmbGFncy4gKi8KK3N0YXRpYyBwMm1fYWNjZXNzX3QgcDJtX2ZsYWdz
X3RvX2FjY2Vzcyh1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisgICAgaWYgKCBm
bGFncyAmIF9QQUdFX1BSRVNFTlQgKQorICAgICAgICByZXR1cm4gcDJtX2Fj
Y2Vzc19uOworCisgICAgLyogTm8gbmVlZCB0byBsb29rIGF0IF9QQUdFX05Y
IGZvciBub3cuICovCisgICAgcmV0dXJuIGZsYWdzICYgX1BBR0VfUlcgPyBw
Mm1fYWNjZXNzX3J3IDogcDJtX2FjY2Vzc19yOworfQorCiAvKiBDaGVja3Mg
b25seSBhcHBsaWNhYmxlIHRvIGVudHJpZXMgd2l0aCBvcmRlciA+IFBBR0Vf
T1JERVJfNEsgKi8KIHN0YXRpYyB2b2lkIGNoZWNrX2VudHJ5KG1mbl90IG1m
biwgcDJtX3R5cGVfdCBuZXcsIHAybV90eXBlX3Qgb2xkLAogICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKQpAQCAtNTc5LDcg
KzU4OSw3IEBAIHAybV9wdF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4g
KnAybSwKICAgICBsMl9wZ2VudHJ5X3QgbDJlX2NvbnRlbnQ7CiAgICAgbDNf
cGdlbnRyeV90IGwzZV9jb250ZW50OwogICAgIGludCByYzsKLSAgICB1bnNp
Z25lZCBpbnQgaW9tbXVfcHRlX2ZsYWdzID0gcDJtX2dldF9pb21tdV9mbGFn
cyhwMm10LCBtZm4pOworICAgIHVuc2lnbmVkIGludCBpb21tdV9wdGVfZmxh
Z3MgPSBwMm1fZ2V0X2lvbW11X2ZsYWdzKHAybXQsIHAybWEsIG1mbik7CiAg
ICAgLyoKICAgICAgKiBvbGRfbWZuIGFuZCBpb21tdV9vbGRfZmxhZ3MgY29u
dHJvbCBwb3NzaWJsZSBmbHVzaC91cGRhdGUgbmVlZHMgb24gdGhlCiAgICAg
ICogSU9NTVU6IFdlIG5lZWQgdG8gZmx1c2ggd2hlbiBNRk4gb3IgZmxhZ3Mg
KGkuZS4gcGVybWlzc2lvbnMpIGNoYW5nZS4KQEAgLTY0Miw2ICs2NTIsNyBA
QCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAg
ICAgICAgICAgICAgICAgb2xkX21mbiA9IGwxZV9nZXRfcGZuKCpwMm1fZW50
cnkpOwogICAgICAgICAgICAgICAgIGlvbW11X29sZF9mbGFncyA9CiAgICAg
ICAgICAgICAgICAgICAgIHAybV9nZXRfaW9tbXVfZmxhZ3MocDJtX2ZsYWdz
X3RvX3R5cGUoZmxhZ3MpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAybV9mbGFnc190b19hY2Nlc3MoZmxhZ3MpLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZm4ob2xk
X21mbikpOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgZWxzZQpAQCAt
Njg0LDkgKzY5NSwxMCBAQCBwMm1fcHRfc2V0X2VudHJ5KHN0cnVjdCBwMm1f
ZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDAsIEwxX1BBR0VUQUJMRV9FTlRSSUVTKTsKICAgICAgICAgQVNTRVJU
KHAybV9lbnRyeSk7CiAgICAgICAgIG9sZF9tZm4gPSBsMWVfZ2V0X3Bmbigq
cDJtX2VudHJ5KTsKKyAgICAgICAgZmxhZ3MgPSBsMWVfZ2V0X2ZsYWdzKCpw
Mm1fZW50cnkpOwogICAgICAgICBpb21tdV9vbGRfZmxhZ3MgPQotICAgICAg
ICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxhZ3NfdG9fdHlwZShs
MWVfZ2V0X2ZsYWdzKCpwMm1fZW50cnkpKSwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7CisgICAgICAgICAgICBw
Mm1fZ2V0X2lvbW11X2ZsYWdzKHAybV9mbGFnc190b190eXBlKGZsYWdzKSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2ZsYWdzX3Rv
X2FjY2VzcyhmbGFncyksIF9tZm4ob2xkX21mbikpOwogCiAgICAgICAgIGlm
ICggbWZuX3ZhbGlkKG1mbikgfHwgcDJtX2FsbG93c19pbnZhbGlkX21mbihw
Mm10KSApCiAgICAgICAgICAgICBlbnRyeV9jb250ZW50ID0gcDJtX2wxZV9m
cm9tX3BmbihtZm5feChtZm4pLApAQCAtNzE0LDYgKzcyNiw3IEBAIHAybV9w
dF9zZXRfZW50cnkoc3RydWN0IHAybV9kb21haW4gKnAybSwKICAgICAgICAg
ICAgICAgICBvbGRfbWZuID0gbDFlX2dldF9wZm4oKnAybV9lbnRyeSk7CiAg
ICAgICAgICAgICAgICAgaW9tbXVfb2xkX2ZsYWdzID0KICAgICAgICAgICAg
ICAgICAgICAgcDJtX2dldF9pb21tdV9mbGFncyhwMm1fZmxhZ3NfdG9fdHlw
ZShmbGFncyksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcDJtX2ZsYWdzX3RvX2FjY2VzcyhmbGFncyksCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX21mbihvbGRfbWZuKSk7
CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlCi0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9wMm0uaApAQCAtOTE1LDcgKzkxNSw4IEBAIHN0YXRpYyBpbmxpbmUgdm9p
ZCBwMm1fYWx0cDJtX2NoZWNrKHN0cnUKIC8qCiAgKiBwMm0gdHlwZSB0byBJ
T01NVSBmbGFncwogICovCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBw
Mm1fZ2V0X2lvbW11X2ZsYWdzKHAybV90eXBlX3QgcDJtdCwgbWZuX3QgbWZu
KQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgcDJtX2dldF9pb21tdV9m
bGFncyhwMm1fdHlwZV90IHAybXQsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9hY2Nlc3NfdCBwMm1hLCBt
Zm5fdCBtZm4pCiB7CiAgICAgdW5zaWduZWQgaW50IGZsYWdzOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-4.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogZ2VuZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVk
IFJNUlIgcmVnaW9ucwoKSW4gb3JkZXIgdG8gcmUtdXNlIGl0IGVsc2V3aGVy
ZSwgbW92ZSB0aGUgbG9naWMgdG8gdmVuZG9yIGluZGVwZW5kZW50CmNvZGUg
YW5kIHN0cmlwIGl0IG9mIFJNUlIgc3BlY2lmaWNzLgoKTm90ZSB0aGF0IHRo
ZSBwcmlvciAibWFwIiBwYXJhbWV0ZXIgZ2V0cyBmb2xkZWQgaW50byB0aGUg
bmV3ICJwMm1hIiBvbmUKKHdoaWNoIEFNRCBJT01NVSBjb2RlIHdpbGwgd2Fu
dCB0byBtYWtlIHVzZSBvZiksIGFzc2lnbmluZyBhbHRlcm5hdGl2ZQptZWFu
aW5nICgidW5tYXAiKSB0byBwMm1fYWNjZXNzX3guIFByZXBhcmUgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpIGFuZApwMm1fZ2V0X2lvbW11X2ZsYWdzKCkg
Zm9yIGdldHRpbmcgcGFzc2VkIGFjY2VzcyB0eXBlcyBvdGhlciB0aGFuCnAy
bV9hY2Nlc3NfcncgKGluIHRoZSBsYXR0ZXIgY2FzZSBqdXN0IGZvciBwMm1f
bW1pb19kaXJlY3QgcmVxdWVzdHMpLgoKTm90ZSBhbHNvIHRoYXQsIHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUsIGFuIG92ZXJsYXAgY2hlY2sgZ2V0cyBhZGRl
ZCB0bwp0aGUgbWFpbiBsb29wIG9mIGlvbW11X2lkZW50aXR5X21hcHBpbmco
KS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0x
MzY1LDcgKzEzNjUsNyBAQCBpbnQgc2V0X2lkZW50aXR5X3AybV9lbnRyeShz
dHJ1Y3QgZG9tYWluCiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAg
cmV0dXJuIGlvbW11X2xlZ2FjeV9tYXAoZCwgX2RmbihnZm5fbCksIF9tZm4o
Z2ZuX2wpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxdWwg
PDwgUEFHRV9PUkRFUl80SywKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgSU9NTVVGX3JlYWRhYmxlIHwgSU9NTVVGX3dyaXRhYmxlKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX2FjY2Vzc190b19p
b21tdV9mbGFncyhwMm1hKSk7CiAgICAgfQogCiAgICAgZ2ZuX2xvY2socDJt
LCBnZm4sIDApOwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuYwpAQCAtNDIsMTIgKzQyLDYgQEAKICNpbmNsdWRlICJ2dGQuaCIKICNp
bmNsdWRlICIuLi9hdHMuaCIKIAotc3RydWN0IG1hcHBlZF9ybXJyIHsKLSAg
ICBzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Ci0gICAgdTY0IGJhc2UsIGVuZDsK
LSAgICB1bnNpZ25lZCBpbnQgY291bnQ7Ci19OwotCiAvKiBQb3NzaWJsZSB1
bmZpbHRlcmVkIExBUElDL01TSSBtZXNzYWdlcyBmcm9tIHVudHJ1c3RlZCBz
b3VyY2VzPyAqLwogYm9vbCBfX3JlYWRfbW9zdGx5IHVudHJ1c3RlZF9tc2k7
CiAKQEAgLTEzMTEsNyArMTMwNSw2IEBAIHN0YXRpYyBpbnQgaW50ZWxfaW9t
bXVfZG9tYWluX2luaXQoc3RydWMKICAgICBzdHJ1Y3QgZG9tYWluX2lvbW11
ICpoZCA9IGRvbV9pb21tdShkKTsKIAogICAgIGhkLT5hcmNoLnZ0ZC5hZ2F3
ID0gd2lkdGhfdG9fYWdhdyhERUZBVUxUX0RPTUFJTl9BRERSRVNTX1dJRFRI
KTsKLSAgICBJTklUX0xJU1RfSEVBRCgmaGQtPmFyY2gudnRkLm1hcHBlZF9y
bXJycyk7CiAKICAgICByZXR1cm4gMDsKIH0KQEAgLTE3ODgsMTcgKzE3ODEs
MTIgQEAgc3RhdGljIHZvaWQgaW9tbXVfY2xlYXJfcm9vdF9wZ3RhYmxlKHN0
cgogc3RhdGljIHZvaWQgaW9tbXVfZG9tYWluX3RlYXJkb3duKHN0cnVjdCBk
b21haW4gKmQpCiB7CiAgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBk
b21faW9tbXUoZCk7Ci0gICAgc3RydWN0IG1hcHBlZF9ybXJyICptcm1yciwg
KnRtcDsKICAgICBjb25zdCBzdHJ1Y3QgYWNwaV9kcmhkX3VuaXQgKmRyaGQ7
CiAKICAgICBpZiAoIGxpc3RfZW1wdHkoJmFjcGlfZHJoZF91bml0cykgKQog
ICAgICAgICByZXR1cm47CiAKLSAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5X3Nh
ZmUgKCBtcm1yciwgdG1wLCAmaGQtPmFyY2gudnRkLm1hcHBlZF9ybXJycywg
bGlzdCApCi0gICAgewotICAgICAgICBsaXN0X2RlbCgmbXJtcnItPmxpc3Qp
OwotICAgICAgICB4ZnJlZShtcm1ycik7Ci0gICAgfQorICAgIGlvbW11X2lk
ZW50aXR5X21hcF90ZWFyZG93bihkKTsKIAogICAgIEFTU0VSVCghaGQtPmFy
Y2gudnRkLnBnZF9tYWRkcik7CiAKQEAgLTE5NDYsNzQgKzE5MzQsNiBAQCBz
dGF0aWMgaW50IF9faW5pdCB2dGRfZXB0X3BhZ2VfY29tcGF0aWJsCiAgICAg
ICAgICAgIChlcHRfaGFzXzFnYihlcHRfY2FwKSAmJiBvcHRfaGFwXzFnYikg
PD0gY2FwX3Nwc18xZ2IodnRkX2NhcCk7CiB9CiAKLXN0YXRpYyBpbnQgcm1y
cl9pZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmQsIGJvb2xfdCBt
YXAsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBz
dHJ1Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnIsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1MzIgZmxhZykKLXsKLSAgICB1bnNpZ25lZCBs
b25nIGJhc2VfcGZuID0gcm1yci0+YmFzZV9hZGRyZXNzID4+IFBBR0VfU0hJ
RlRfNEs7Ci0gICAgdW5zaWduZWQgbG9uZyBlbmRfcGZuID0gUEFHRV9BTElH
Tl80SyhybXJyLT5lbmRfYWRkcmVzcykgPj4gUEFHRV9TSElGVF80SzsKLSAg
ICBzdHJ1Y3QgbWFwcGVkX3JtcnIgKm1ybXJyOwotICAgIHN0cnVjdCBkb21h
aW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOwotCi0gICAgQVNTRVJUKHBj
aWRldnNfbG9ja2VkKCkpOwotICAgIEFTU0VSVChybXJyLT5iYXNlX2FkZHJl
c3MgPCBybXJyLT5lbmRfYWRkcmVzcyk7Ci0KLSAgICAvKgotICAgICAqIE5v
IG5lZWQgdG8gYWNxdWlyZSBoZC0+YXJjaC5tYXBwaW5nX2xvY2s6IEJvdGgg
aW5zZXJ0aW9uIGFuZCByZW1vdmFsCi0gICAgICogZ2V0IGRvbmUgd2hpbGUg
aG9sZGluZyBwY2lkZXZzX2xvY2suCi0gICAgICovCi0gICAgbGlzdF9mb3Jf
ZWFjaF9lbnRyeSggbXJtcnIsICZoZC0+YXJjaC52dGQubWFwcGVkX3JtcnJz
LCBsaXN0ICkKLSAgICB7Ci0gICAgICAgIGlmICggbXJtcnItPmJhc2UgPT0g
cm1yci0+YmFzZV9hZGRyZXNzICYmCi0gICAgICAgICAgICAgbXJtcnItPmVu
ZCA9PSBybXJyLT5lbmRfYWRkcmVzcyApCi0gICAgICAgIHsKLSAgICAgICAg
ICAgIGludCByZXQgPSAwOwotCi0gICAgICAgICAgICBpZiAoIG1hcCApCi0g
ICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgKyttcm1yci0+Y291bnQ7
Ci0gICAgICAgICAgICAgICAgcmV0dXJuIDA7Ci0gICAgICAgICAgICB9Ci0K
LSAgICAgICAgICAgIGlmICggLS1tcm1yci0+Y291bnQgKQotICAgICAgICAg
ICAgICAgIHJldHVybiAwOwotCi0gICAgICAgICAgICB3aGlsZSAoIGJhc2Vf
cGZuIDwgZW5kX3BmbiApCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAg
ICAgaWYgKCBjbGVhcl9pZGVudGl0eV9wMm1fZW50cnkoZCwgYmFzZV9wZm4p
ICkKLSAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVOWElPOwotICAgICAg
ICAgICAgICAgIGJhc2VfcGZuKys7Ci0gICAgICAgICAgICB9Ci0KLSAgICAg
ICAgICAgIGxpc3RfZGVsKCZtcm1yci0+bGlzdCk7Ci0gICAgICAgICAgICB4
ZnJlZShtcm1ycik7Ci0gICAgICAgICAgICByZXR1cm4gcmV0OwotICAgICAg
ICB9Ci0gICAgfQotCi0gICAgaWYgKCAhbWFwICkKLSAgICAgICAgcmV0dXJu
IC1FTk9FTlQ7Ci0KLSAgICB3aGlsZSAoIGJhc2VfcGZuIDwgZW5kX3BmbiAp
Ci0gICAgewotICAgICAgICBpbnQgZXJyID0gc2V0X2lkZW50aXR5X3AybV9l
bnRyeShkLCBiYXNlX3BmbiwgcDJtX2FjY2Vzc19ydywgZmxhZyk7Ci0KLSAg
ICAgICAgaWYgKCBlcnIgKQotICAgICAgICAgICAgcmV0dXJuIGVycjsKLSAg
ICAgICAgYmFzZV9wZm4rKzsKLSAgICB9Ci0KLSAgICBtcm1yciA9IHhtYWxs
b2Moc3RydWN0IG1hcHBlZF9ybXJyKTsKLSAgICBpZiAoICFtcm1yciApCi0g
ICAgICAgIHJldHVybiAtRU5PTUVNOwotICAgIG1ybXJyLT5iYXNlID0gcm1y
ci0+YmFzZV9hZGRyZXNzOwotICAgIG1ybXJyLT5lbmQgPSBybXJyLT5lbmRf
YWRkcmVzczsKLSAgICBtcm1yci0+Y291bnQgPSAxOwotICAgIGxpc3RfYWRk
X3RhaWwoJm1ybXJyLT5saXN0LCAmaGQtPmFyY2gudnRkLm1hcHBlZF9ybXJy
cyk7Ci0KLSAgICByZXR1cm4gMDsKLX0KLQogc3RhdGljIGludCBpbnRlbF9p
b21tdV9hZGRfZGV2aWNlKHU4IGRldmZuLCBzdHJ1Y3QgcGNpX2RldiAqcGRl
dikKIHsKICAgICBzdHJ1Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnI7CkBAIC0y
MDQ1LDcgKzE5NjUsOSBAQCBzdGF0aWMgaW50IGludGVsX2lvbW11X2FkZF9k
ZXZpY2UodTggZGV2CiAgICAgICAgICAgICAgKiBTaW5jZSBSTVJScyBhcmUg
YWx3YXlzIHJlc2VydmVkIGluIHRoZSBlODIwIG1hcCBmb3IgdGhlIGhhcmR3
YXJlCiAgICAgICAgICAgICAgKiBkb21haW4sIHRoZXJlIHNob3VsZG4ndCBi
ZSBhIGNvbmZsaWN0LgogICAgICAgICAgICAgICovCi0gICAgICAgICAgICBy
ZXQgPSBybXJyX2lkZW50aXR5X21hcHBpbmcocGRldi0+ZG9tYWluLCAxLCBy
bXJyLCAwKTsKKyAgICAgICAgICAgIHJldCA9IGlvbW11X2lkZW50aXR5X21h
cHBpbmcocGRldi0+ZG9tYWluLCBwMm1fYWNjZXNzX3J3LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5iYXNlX2Fk
ZHJlc3MsIHJtcnItPmVuZF9hZGRyZXNzLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAwKTsKICAgICAgICAgICAgIGlmICgg
cmV0ICkKICAgICAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIgVlRE
UFJFRklYLCAiZCVkOiBSTVJSIG1hcHBpbmcgZmFpbGVkXG4iLAogICAgICAg
ICAgICAgICAgICAgICAgICAgcGRldi0+ZG9tYWluLT5kb21haW5faWQpOwpA
QCAtMjA5MCw3ICsyMDEyLDggQEAgc3RhdGljIGludCBpbnRlbF9pb21tdV9y
ZW1vdmVfZGV2aWNlKHU4CiAgICAgICAgICAqIEFueSBmbGFnIGlzIG5vdGhp
bmcgdG8gY2xlYXIgdGhlc2UgbWFwcGluZ3MgYnV0IGhlcmUKICAgICAgICAg
ICogaXRzIGFsd2F5cyBzYWZlIGFuZCBzdHJpY3QgdG8gc2V0IDAuCiAgICAg
ICAgICAqLwotICAgICAgICBybXJyX2lkZW50aXR5X21hcHBpbmcocGRldi0+
ZG9tYWluLCAwLCBybXJyLCAwKTsKKyAgICAgICAgaW9tbXVfaWRlbnRpdHlf
bWFwcGluZyhwZGV2LT5kb21haW4sIHAybV9hY2Nlc3NfeCwgcm1yci0+YmFz
ZV9hZGRyZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJt
cnItPmVuZF9hZGRyZXNzLCAwKTsKICAgICB9CiAKICAgICByZXR1cm4gZG9t
YWluX2NvbnRleHRfdW5tYXAocGRldi0+ZG9tYWluLCBkZXZmbiwgcGRldik7
CkBAIC0yMjg5LDcgKzIyMTIsOCBAQCBzdGF0aWMgdm9pZCBfX2h3ZG9tX2lu
aXQgc2V0dXBfaHdkb21fcm1yCiAgICAgICAgICAqIGRvbWFpbiwgdGhlcmUg
c2hvdWxkbid0IGJlIGEgY29uZmxpY3QuIFNvIGl0cyBhbHdheXMgc2FmZSBh
bmQKICAgICAgICAgICogc3RyaWN0IHRvIHNldCAwLgogICAgICAgICAgKi8K
LSAgICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKGQsIDEsIHJt
cnIsIDApOworICAgICAgICByZXQgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5n
KGQsIHAybV9hY2Nlc3NfcncsIHJtcnItPmJhc2VfYWRkcmVzcywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBybXJyLT5lbmRfYWRk
cmVzcywgMCk7CiAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgIGRw
cmludGsoWEVOTE9HX0VSUiBWVERQUkVGSVgsCiAgICAgICAgICAgICAgICAg
ICAgICAiSU9NTVU6IG1hcHBpbmcgcmVzZXJ2ZWQgcmVnaW9uIGZhaWxlZFxu
Iik7CkBAIC0yNDYwLDcgKzIzODQsOSBAQCBzdGF0aWMgaW50IHJlYXNzaWdu
X2RldmljZV9vd25lcnNoaXAoCiAgICAgICAgICAgICAgICAgICogQW55IFJN
UlIgZmxhZyBpcyBhbHdheXMgaWdub3JlZCB3aGVuIHJlbW92ZSBhIGRldmlj
ZSwKICAgICAgICAgICAgICAgICAgKiBidXQgaXRzIGFsd2F5cyBzYWZlIGFu
ZCBzdHJpY3QgdG8gc2V0IDAuCiAgICAgICAgICAgICAgICAgICovCi0gICAg
ICAgICAgICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5nKHNvdXJj
ZSwgMCwgcm1yciwgMCk7CisgICAgICAgICAgICAgICAgcmV0ID0gaW9tbXVf
aWRlbnRpdHlfbWFwcGluZyhzb3VyY2UsIHAybV9hY2Nlc3NfeCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnIt
PmJhc2VfYWRkcmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJtcnItPmVuZF9hZGRyZXNzLCAwKTsKICAgICAg
ICAgICAgICAgICBpZiAoIHJldCAhPSAtRU5PRU5UICkKICAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgIH0KQEAgLTI1NTYs
NyArMjQ4Miw4IEBAIHN0YXRpYyBpbnQgaW50ZWxfaW9tbXVfYXNzaWduX2Rl
dmljZSgKICAgICAgICAgICAgICBQQ0lfQlVTKGJkZikgPT0gYnVzICYmCiAg
ICAgICAgICAgICAgUENJX0RFVkZOMihiZGYpID09IGRldmZuICkKICAgICAg
ICAgewotICAgICAgICAgICAgcmV0ID0gcm1ycl9pZGVudGl0eV9tYXBwaW5n
KGQsIDEsIHJtcnIsIGZsYWcpOworICAgICAgICAgICAgcmV0ID0gaW9tbXVf
aWRlbnRpdHlfbWFwcGluZyhkLCBwMm1fYWNjZXNzX3J3LCBybXJyLT5iYXNl
X2FkZHJlc3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJtcnItPmVuZF9hZGRyZXNzLCBmbGFnKTsKICAgICAgICAgICAg
IGlmICggcmV0ICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBp
bnQgcmM7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21t
dS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5j
CkBAIC0xNDMsNiArMTQzLDcgQEAgaW50IGFyY2hfaW9tbXVfZG9tYWluX2lu
aXQoc3RydWN0IGRvbWFpbgogCiAgICAgSU5JVF9QQUdFX0xJU1RfSEVBRCgm
aGQtPmFyY2gucGd0YWJsZXMubGlzdCk7CiAgICAgc3Bpbl9sb2NrX2luaXQo
JmhkLT5hcmNoLnBndGFibGVzLmxvY2spOworICAgIElOSVRfTElTVF9IRUFE
KCZoZC0+YXJjaC5pZGVudGl0eV9tYXBzKTsKIAogICAgIHJldHVybiAwOwog
fQpAQCAtMTU4LDYgKzE1OSw5OSBAQCB2b2lkIGFyY2hfaW9tbXVfZG9tYWlu
X2Rlc3Ryb3koc3RydWN0IGRvCiAgICAgICAgICAgIHBhZ2VfbGlzdF9lbXB0
eSgmZG9tX2lvbW11KGQpLT5hcmNoLnBndGFibGVzLmxpc3QpKTsKIH0KIAor
c3RydWN0IGlkZW50aXR5X21hcCB7CisgICAgc3RydWN0IGxpc3RfaGVhZCBs
aXN0OworICAgIHBhZGRyX3QgYmFzZSwgZW5kOworICAgIHAybV9hY2Nlc3Nf
dCBhY2Nlc3M7CisgICAgdW5zaWduZWQgaW50IGNvdW50OworfTsKKworaW50
IGlvbW11X2lkZW50aXR5X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZCwgcDJt
X2FjY2Vzc190IHAybWEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBw
YWRkcl90IGJhc2UsIHBhZGRyX3QgZW5kLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IGZsYWcpCit7CisgICAgdW5zaWduZWQg
bG9uZyBiYXNlX3BmbiA9IGJhc2UgPj4gUEFHRV9TSElGVF80SzsKKyAgICB1
bnNpZ25lZCBsb25nIGVuZF9wZm4gPSBQQUdFX0FMSUdOXzRLKGVuZCkgPj4g
UEFHRV9TSElGVF80SzsKKyAgICBzdHJ1Y3QgaWRlbnRpdHlfbWFwICptYXA7
CisgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7
CisKKyAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQoKSk7CisgICAgQVNTRVJU
KGJhc2UgPCBlbmQpOworCisgICAgLyoKKyAgICAgKiBObyBuZWVkIHRvIGFj
cXVpcmUgaGQtPmFyY2gubWFwcGluZ19sb2NrOiBCb3RoIGluc2VydGlvbiBh
bmQgcmVtb3ZhbAorICAgICAqIGdldCBkb25lIHdoaWxlIGhvbGRpbmcgcGNp
ZGV2c19sb2NrLgorICAgICAqLworICAgIGxpc3RfZm9yX2VhY2hfZW50cnko
IG1hcCwgJmhkLT5hcmNoLmlkZW50aXR5X21hcHMsIGxpc3QgKQorICAgIHsK
KyAgICAgICAgaWYgKCBtYXAtPmJhc2UgPT0gYmFzZSAmJiBtYXAtPmVuZCA9
PSBlbmQgKQorICAgICAgICB7CisgICAgICAgICAgICBpbnQgcmV0ID0gMDsK
KworICAgICAgICAgICAgaWYgKCBwMm1hICE9IHAybV9hY2Nlc3NfeCApCisg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgaWYgKCBtYXAtPmFjY2Vz
cyAhPSBwMm1hICkKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FQURE
UklOVVNFOworICAgICAgICAgICAgICAgICsrbWFwLT5jb3VudDsKKyAgICAg
ICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgICAgIH0KKworICAgICAg
ICAgICAgaWYgKCAtLW1hcC0+Y291bnQgKQorICAgICAgICAgICAgICAgIHJl
dHVybiAwOworCisgICAgICAgICAgICB3aGlsZSAoIGJhc2VfcGZuIDwgZW5k
X3BmbiApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgaWYgKCBj
bGVhcl9pZGVudGl0eV9wMm1fZW50cnkoZCwgYmFzZV9wZm4pICkKKyAgICAg
ICAgICAgICAgICAgICAgcmV0ID0gLUVOWElPOworICAgICAgICAgICAgICAg
IGJhc2VfcGZuKys7CisgICAgICAgICAgICB9CisKKyAgICAgICAgICAgIGxp
c3RfZGVsKCZtYXAtPmxpc3QpOworICAgICAgICAgICAgeGZyZWUobWFwKTsK
KworICAgICAgICAgICAgcmV0dXJuIHJldDsKKyAgICAgICAgfQorCisgICAg
ICAgIGlmICggZW5kID49IG1hcC0+YmFzZSAmJiBtYXAtPmVuZCA+PSBiYXNl
ICkKKyAgICAgICAgICAgIHJldHVybiAtRUFERFJJTlVTRTsKKyAgICB9CisK
KyAgICBpZiAoIHAybWEgPT0gcDJtX2FjY2Vzc194ICkKKyAgICAgICAgcmV0
dXJuIC1FTk9FTlQ7CisKKyAgICB3aGlsZSAoIGJhc2VfcGZuIDwgZW5kX3Bm
biApCisgICAgeworICAgICAgICBpbnQgZXJyID0gc2V0X2lkZW50aXR5X3Ay
bV9lbnRyeShkLCBiYXNlX3BmbiwgcDJtYSwgZmxhZyk7CisKKyAgICAgICAg
aWYgKCBlcnIgKQorICAgICAgICAgICAgcmV0dXJuIGVycjsKKyAgICAgICAg
YmFzZV9wZm4rKzsKKyAgICB9CisKKyAgICBtYXAgPSB4bWFsbG9jKHN0cnVj
dCBpZGVudGl0eV9tYXApOworICAgIGlmICggIW1hcCApCisgICAgICAgIHJl
dHVybiAtRU5PTUVNOworICAgIG1hcC0+YmFzZSA9IGJhc2U7CisgICAgbWFw
LT5lbmQgPSBlbmQ7CisgICAgbWFwLT5hY2Nlc3MgPSBwMm1hOworICAgIG1h
cC0+Y291bnQgPSAxOworICAgIGxpc3RfYWRkX3RhaWwoJm1hcC0+bGlzdCwg
JmhkLT5hcmNoLmlkZW50aXR5X21hcHMpOworCisgICAgcmV0dXJuIDA7Cit9
CisKK3ZvaWQgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKHN0cnVjdCBk
b21haW4gKmQpCit7CisgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBk
b21faW9tbXUoZCk7CisgICAgc3RydWN0IGlkZW50aXR5X21hcCAqbWFwLCAq
dG1wOworCisgICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlICggbWFwLCB0
bXAsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBzLCBsaXN0ICkKKyAgICB7Cisg
ICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3QpOworICAgICAgICB4ZnJlZSht
YXApOworICAgIH0KK30KKwogc3RhdGljIGJvb2wgX19od2RvbV9pbml0IGh3
ZG9tX2lvbW11X21hcChjb25zdCBzdHJ1Y3QgZG9tYWluICpkLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBs
b25nIHBmbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyBtYXhfcGZuKQotLS0gYS94ZW4vaW5jbHVk
ZS9hc20teDg2L2lvbW11LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9p
b21tdS5oCkBAIC0xNiw2ICsxNiw3IEBACiAKICNpbmNsdWRlIDx4ZW4vZXJy
bm8uaD4KICNpbmNsdWRlIDx4ZW4vbGlzdC5oPgorI2luY2x1ZGUgPHhlbi9t
ZW1fYWNjZXNzLmg+CiAjaW5jbHVkZSA8eGVuL3NwaW5sb2NrLmg+CiAjaW5j
bHVkZSA8YXNtL2FwaWNkZWYuaD4KICNpbmNsdWRlIDxhc20vcHJvY2Vzc29y
Lmg+CkBAIC01MSwxMyArNTIsMTQgQEAgc3RydWN0IGFyY2hfaW9tbXUKICAg
ICAgICAgc3BpbmxvY2tfdCBsb2NrOwogICAgIH0gcGd0YWJsZXM7CiAKKyAg
ICBzdHJ1Y3QgbGlzdF9oZWFkIGlkZW50aXR5X21hcHM7CisKICAgICB1bmlv
biB7CiAgICAgICAgIC8qIEludGVsIFZULWQgKi8KICAgICAgICAgc3RydWN0
IHsKICAgICAgICAgICAgIHVpbnQ2NF90IHBnZF9tYWRkcjsgLyogaW8gcGFn
ZSBkaXJlY3RvcnkgbWFjaGluZSBhZGRyZXNzICovCiAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgYWdhdzsgLyogYWRqdXN0ZWQgZ3Vlc3QgYWRkcmVzcyB3
aWR0aCwgMCBpcyBsZXZlbCAyIDMwLWJpdCAqLwogICAgICAgICAgICAgdWlu
dDY0X3QgaW9tbXVfYml0bWFwOyAvKiBiaXRtYXAgb2YgaW9tbXUocykgdGhh
dCB0aGUgZG9tYWluIHVzZXMgKi8KLSAgICAgICAgICAgIHN0cnVjdCBsaXN0
X2hlYWQgbWFwcGVkX3JtcnJzOwogICAgICAgICB9IHZ0ZDsKICAgICAgICAg
LyogQU1EIElPTU1VICovCiAgICAgICAgIHN0cnVjdCB7CkBAIC0xMjMsNiAr
MTI1LDExIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpb21tdV9kaXNhYmxlX3gy
YXBpYygKICAgICAgICAgaW9tbXVfb3BzLmRpc2FibGVfeDJhcGljKCk7CiB9
CiAKK2ludCBpb21tdV9pZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBkb21haW4g
KmQsIHAybV9hY2Nlc3NfdCBwMm1hLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90IGVuZCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFnKTsKK3ZvaWQgaW9t
bXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKHN0cnVjdCBkb21haW4gKmQpOwor
CiBleHRlcm4gYm9vbCB1bnRydXN0ZWRfbXNpOwogCiBpbnQgcGlfdXBkYXRl
X2lydGUoY29uc3Qgc3RydWN0IHBpX2Rlc2MgKnBpX2Rlc2MsIGNvbnN0IHN0
cnVjdCBwaXJxICpwaXJxLAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3Ay
bS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKQEAgLTkxMiw2
ICs5MTIsMzQgQEAgc3RydWN0IHAybV9kb21haW4gKnAybV9nZXRfYWx0cDJt
KHN0cnVjdAogc3RhdGljIGlubGluZSB2b2lkIHAybV9hbHRwMm1fY2hlY2so
c3RydWN0IHZjcHUgKnYsIHVpbnQxNl90IGlkeCkge30KICNlbmRpZgogCisv
KiBwMm0gYWNjZXNzIHRvIElPTU1VIGZsYWdzICovCitzdGF0aWMgaW5saW5l
IHVuc2lnbmVkIGludCBwMm1fYWNjZXNzX3RvX2lvbW11X2ZsYWdzKHAybV9h
Y2Nlc3NfdCBwMm1hKQoreworICAgIHN3aXRjaCAoIHAybWEgKQorICAgIHsK
KyAgICBjYXNlIHAybV9hY2Nlc3Nfcnc6CisgICAgY2FzZSBwMm1fYWNjZXNz
X3J3eDoKKyAgICAgICAgcmV0dXJuIElPTU1VRl9yZWFkYWJsZSB8IElPTU1V
Rl93cml0YWJsZTsKKworICAgIGNhc2UgcDJtX2FjY2Vzc19yOgorICAgIGNh
c2UgcDJtX2FjY2Vzc19yeDoKKyAgICBjYXNlIHAybV9hY2Nlc3Nfcngycnc6
CisgICAgICAgIHJldHVybiBJT01NVUZfcmVhZGFibGU7CisKKyAgICBjYXNl
IHAybV9hY2Nlc3NfdzoKKyAgICBjYXNlIHAybV9hY2Nlc3Nfd3g6CisgICAg
ICAgIHJldHVybiBJT01NVUZfd3JpdGFibGU7CisKKyAgICBjYXNlIHAybV9h
Y2Nlc3NfbjoKKyAgICBjYXNlIHAybV9hY2Nlc3NfeDoKKyAgICBjYXNlIHAy
bV9hY2Nlc3NfbjJyd3g6CisgICAgICAgIHJldHVybiAwOworICAgIH0KKwor
ICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOworICAgIHJldHVybiAwOworfQor
CiAvKgogICogcDJtIHR5cGUgdG8gSU9NTVUgZmxhZ3MKICAqLwpAQCAtOTMz
LDkgKzk2MSwxMCBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBwMm1f
Z2V0X2lvbW11CiAgICAgICAgIGZsYWdzID0gSU9NTVVGX3JlYWRhYmxlOwog
ICAgICAgICBicmVhazsKICAgICBjYXNlIHAybV9tbWlvX2RpcmVjdDoKLSAg
ICAgICAgZmxhZ3MgPSBJT01NVUZfcmVhZGFibGU7Ci0gICAgICAgIGlmICgg
IXJhbmdlc2V0X2NvbnRhaW5zX3NpbmdsZXRvbihtbWlvX3JvX3Jhbmdlcywg
bWZuX3gobWZuKSkgKQotICAgICAgICAgICAgZmxhZ3MgfD0gSU9NTVVGX3dy
aXRhYmxlOworICAgICAgICBmbGFncyA9IHAybV9hY2Nlc3NfdG9faW9tbXVf
ZmxhZ3MocDJtYSk7CisgICAgICAgIGlmICggKGZsYWdzICYgSU9NTVVGX3dy
aXRhYmxlKSAmJgorICAgICAgICAgICAgIHJhbmdlc2V0X2NvbnRhaW5zX3Np
bmdsZXRvbihtbWlvX3JvX3JhbmdlcywgbWZuX3gobWZuKSkgKQorICAgICAg
ICAgICAgZmxhZ3MgJj0gfklPTU1VRl93cml0YWJsZTsKICAgICAgICAgYnJl
YWs7CiAgICAgZGVmYXVsdDoKICAgICAgICAgZmxhZ3MgPSAwOwo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-5.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UvY29tcGxldGUgcmUtYXNzaWdubWVu
dCBoYW5kbGluZwoKUHJpb3IgdG8gdGhlIGFzc2lnbm1lbnQgc3RlcCBoYXZp
bmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgZGV2aWNlcwpzaG91bGQgbm90
IGdldCBhc3NvY2lhdGVkIHdpdGggdGhlaXIgbmV3IG93bmVyLiBIYW5kIHRo
ZSBkZXZpY2UgdG8gRG9tSU8KKHBlcmhhcHMgdGVtcG9yYXJpbHkpLCB1bnRp
bCBhZnRlciB0aGUgZGUtYXNzaWdubWVudCBzdGVwIGhhcyBjb21wbGV0ZWQu
CgpEZS1hc3NpZ25tZW50IG9mIGEgZGV2aWNlIChmcm9tIG90aGVyIHRoYW4g
RG9tMCkgYXMgd2VsbCBhcyBmYWlsdXJlIG9mCnJlYXNzaWduX2RldmljZSgp
IGR1cmluZyBhc3NpZ25tZW50IHNob3VsZCByZXN1bHQgaW4gdW5pdHkgbWFw
cGluZ3MKZ2V0dGluZyB0b3JuIGRvd24uIFRoaXMgaW4gdHVybiByZXF1aXJl
cyBzd2l0Y2hpbmcgdG8gYSByZWZjb3VudGVkCm1hcHBpbmcgYXBwcm9hY2gs
IGFzIHdhcyBhbHJlYWR5IHVzZWQgYnkgVlQtZCBmb3IgaXRzIFJNUlJzLCB0
byBwcmV2ZW50CnVubWFwcGluZyBhIHJlZ2lvbiB1c2VkIGJ5IG11bHRpcGxl
IGRldmljZXMuCgpUaGlzIGlzIENWRS0yMDIxLTI4Njk2IC8gcGFydCBvZiBY
U0EtMzc4LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXUu
aApAQCAtMjMyLDggKzIzMiwxMCBAQCBpbnQgX19tdXN0X2NoZWNrIGFtZF9p
b21tdV91bm1hcF9wYWdlKHN0CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqZmx1c2hfZmxhZ3MpOwogaW50
IF9fbXVzdF9jaGVjayBhbWRfaW9tbXVfYWxsb2Nfcm9vdChzdHJ1Y3QgZG9t
YWluICpkKTsKIGludCBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlf
bWFwKHN0cnVjdCBkb21haW4gKmRvbWFpbiwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBhZGRyX3QgcGh5c19hZGRyLCB1bnNp
Z25lZCBsb25nIHNpemUsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgaXcsIGludCBpcik7CisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaXZyc191bml0
eV9tYXAgKm1hcCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGludCBmbGFnKTsKK2ludCBhbWRfaW9tbXVfcmVz
ZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAoc3RydWN0IGRvbWFpbiAqZCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
c3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXApOwogaW50IF9fbXVzdF9jaGVj
ayBhbWRfaW9tbXVfZmx1c2hfaW90bGJfcGFnZXMoc3RydWN0IGRvbWFpbiAq
ZCwgZGZuX3QgZGZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBwYWdlX2NvdW50LAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5z
aWduZWQgaW50IGZsdXNoX2ZsYWdzKTsKLS0tIGEveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYwpAQCAtNDE5LDM4ICs0MTksNDkg
QEAgaW50IGFtZF9pb21tdV9mbHVzaF9pb3RsYl9hbGwoc3RydWN0IGRvbQog
ICAgIHJldHVybiAwOwogfQogCi1pbnQgYW1kX2lvbW11X3Jlc2VydmVfZG9t
YWluX3VuaXR5X21hcChzdHJ1Y3QgZG9tYWluICpkb21haW4sCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90IHBoeXNf
YWRkciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVuc2lnbmVkIGxvbmcgc2l6ZSwgaW50IGl3LCBpbnQgaXIpCitpbnQgYW1k
X2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcChzdHJ1Y3QgZG9tYWlu
ICpkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3Qgc3RydWN0IGl2cnNfdW5pdHlfbWFwICptYXAsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxh
ZykKIHsKLSAgICB1bnNpZ25lZCBsb25nIG5wYWdlcywgaTsKLSAgICB1bnNp
Z25lZCBsb25nIGdmbjsKLSAgICB1bnNpZ25lZCBpbnQgZmxhZ3MgPSAhIWly
OwotICAgIHVuc2lnbmVkIGludCBmbHVzaF9mbGFncyA9IDA7Ci0gICAgaW50
IHJ0ID0gMDsKLQotICAgIGlmICggaXcgKQotICAgICAgICBmbGFncyB8PSBJ
T01NVUZfd3JpdGFibGU7Ci0KLSAgICBucGFnZXMgPSByZWdpb25fdG9fcGFn
ZXMocGh5c19hZGRyLCBzaXplKTsKLSAgICBnZm4gPSBwaHlzX2FkZHIgPj4g
UEFHRV9TSElGVDsKLSAgICBmb3IgKCBpID0gMDsgaSA8IG5wYWdlczsgaSsr
ICkKKyAgICBpbnQgcmM7CisKKyAgICBpZiAoIGQgPT0gZG9tX2lvICkKKyAg
ICAgICAgcmV0dXJuIDA7CisKKyAgICBmb3IgKCByYyA9IDA7ICFyYyAmJiBt
YXA7IG1hcCA9IG1hcC0+bmV4dCApCiAgICAgewotICAgICAgICB1bnNpZ25l
ZCBsb25nIGZyYW1lID0gZ2ZuICsgaTsKKyAgICAgICAgcDJtX2FjY2Vzc190
IHAybWEgPSBwMm1fYWNjZXNzX247CisKKyAgICAgICAgaWYgKCBtYXAtPnJl
YWQgKQorICAgICAgICAgICAgcDJtYSB8PSBwMm1fYWNjZXNzX3I7CisgICAg
ICAgIGlmICggbWFwLT53cml0ZSApCisgICAgICAgICAgICBwMm1hIHw9IHAy
bV9hY2Nlc3NfdzsKIAotICAgICAgICBydCA9IGFtZF9pb21tdV9tYXBfcGFn
ZShkb21haW4sIF9kZm4oZnJhbWUpLCBfbWZuKGZyYW1lKSwgZmxhZ3MsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmbHVzaF9mbGFncyk7
Ci0gICAgICAgIGlmICggcnQgIT0gMCApCi0gICAgICAgICAgICBicmVhazsK
KyAgICAgICAgcmMgPSBpb21tdV9pZGVudGl0eV9tYXBwaW5nKGQsIHAybWEs
IG1hcC0+YWRkciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG1hcC0+YWRkciArIG1hcC0+bGVuZ3RoIC0gMSwgZmxhZyk7CiAgICAg
fQogCi0gICAgLyogVXNlIHdoaWxlLWJyZWFrIHRvIGF2b2lkIGNvbXBpbGVy
IHdhcm5pbmcgKi8KLSAgICB3aGlsZSAoIGZsdXNoX2ZsYWdzICYmCi0gICAg
ICAgICAgICBhbWRfaW9tbXVfZmx1c2hfaW90bGJfcGFnZXMoZG9tYWluLCBf
ZGZuKGdmbiksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbnBhZ2VzLCBmbHVzaF9mbGFncykgKQotICAgICAgICBicmVhazsK
KyAgICByZXR1cm4gcmM7Cit9CisKK2ludCBhbWRfaW9tbXVfcmVzZXJ2ZV9k
b21haW5fdW5pdHlfdW5tYXAoc3RydWN0IGRvbWFpbiAqZCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0
IGl2cnNfdW5pdHlfbWFwICptYXApCit7CisgICAgaW50IHJjOworCisgICAg
aWYgKCBkID09IGRvbV9pbyApCisgICAgICAgIHJldHVybiAwOworCisgICAg
Zm9yICggcmMgPSAwOyBtYXA7IG1hcCA9IG1hcC0+bmV4dCApCisgICAgewor
ICAgICAgICBpbnQgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhkLCBw
Mm1fYWNjZXNzX3gsIG1hcC0+YWRkciwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbWFwLT5hZGRyICsgbWFwLT5sZW5ndGgg
LSAxLCAwKTsKKworICAgICAgICBpZiAoIHJldCAmJiByZXQgIT0gLUVOT0VO
VCAmJiAhcmMgKQorICAgICAgICAgICAgcmMgPSByZXQ7CisgICAgfQogCi0g
ICAgcmV0dXJuIHJ0OworICAgIHJldHVybiByYzsKIH0KIAogaW50IF9faW5p
dCBhbWRfaW9tbXVfcXVhcmFudGluZV9pbml0KHN0cnVjdCBkb21haW4gKmQp
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lv
bW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9h
bWRfaW9tbXUuYwpAQCAtMzI5LDYgKzMyOSw3IEBAIHN0YXRpYyBpbnQgcmVh
c3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4KIHsKICAgICBzdHJ1Y3QgYW1k
X2lvbW11ICppb21tdTsKICAgICBpbnQgYmRmLCByYzsKKyAgICBjb25zdCBz
dHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9pdnJz
X21hcHBpbmdzKHBkZXYtPnNlZyk7CiAKICAgICBiZGYgPSBQQ0lfQkRGMihw
ZGV2LT5idXMsIHBkZXYtPmRldmZuKTsKICAgICBpb21tdSA9IGZpbmRfaW9t
bXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7CkBAIC0zNDMsMTAgKzM0
NCwyNCBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2RldmljZShzdHJ1Y3QgZG9t
YWluCiAKICAgICBhbWRfaW9tbXVfZGlzYWJsZV9kb21haW5fZGV2aWNlKHNv
dXJjZSwgaW9tbXUsIGRldmZuLCBwZGV2KTsKIAotICAgIGlmICggZGV2Zm4g
PT0gcGRldi0+ZGV2Zm4gKQorICAgIC8qCisgICAgICogSWYgdGhlIGRldmlj
ZSBiZWxvbmdzIHRvIHRoZSBoYXJkd2FyZSBkb21haW4sIGFuZCBpdCBoYXMg
YSB1bml0eSBtYXBwaW5nLAorICAgICAqIGRvbid0IHJlbW92ZSBpdCBmcm9t
IHRoZSBoYXJkd2FyZSBkb21haW4sIGJlY2F1c2UgQklPUyBtYXkgcmVmZXJl
bmNlIHRoYXQKKyAgICAgKiBtYXBwaW5nLgorICAgICAqLworICAgIGlmICgg
IWlzX2hhcmR3YXJlX2RvbWFpbihzb3VyY2UpICkKICAgICB7Ci0gICAgICAg
IGxpc3RfbW92ZSgmcGRldi0+ZG9tYWluX2xpc3QsICZ0YXJnZXQtPnBkZXZf
bGlzdCk7Ci0gICAgICAgIHBkZXYtPmRvbWFpbiA9IHRhcmdldDsKKyAgICAg
ICAgcmMgPSBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAo
CisgICAgICAgICAgICAgICAgIHNvdXJjZSwKKyAgICAgICAgICAgICAgICAg
aXZyc19tYXBwaW5nc1tnZXRfZG1hX3JlcXVlc3Rvcl9pZChwZGV2LT5zZWcs
IGJkZildLnVuaXR5X21hcCk7CisgICAgICAgIGlmICggcmMgKQorICAgICAg
ICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIGlmICggZGV2Zm4gPT0g
cGRldi0+ZGV2Zm4gJiYgcGRldi0+ZG9tYWluICE9IGRvbV9pbyApCisgICAg
eworICAgICAgICBsaXN0X21vdmUoJnBkZXYtPmRvbWFpbl9saXN0LCAmZG9t
X2lvLT5wZGV2X2xpc3QpOworICAgICAgICBwZGV2LT5kb21haW4gPSBkb21f
aW87CiAgICAgfQogCiAgICAgcmMgPSBhbGxvY2F0ZV9kb21haW5fcmVzb3Vy
Y2VzKHRhcmdldCk7CkBAIC0zNTcsNiArMzcyLDEyIEBAIHN0YXRpYyBpbnQg
cmVhc3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4KICAgICBBTURfSU9NTVVf
REVCVUcoIlJlLWFzc2lnbiAlcHAgZnJvbSBkb20lZCB0byBkb20lZFxuIiwK
ICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHNvdXJjZS0+ZG9t
YWluX2lkLCB0YXJnZXQtPmRvbWFpbl9pZCk7CiAKKyAgICBpZiAoIGRldmZu
ID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRvbWFpbiAhPSB0YXJnZXQgKQor
ICAgIHsKKyAgICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21haW5fbGlzdCwg
JnRhcmdldC0+cGRldl9saXN0KTsKKyAgICAgICAgcGRldi0+ZG9tYWluID0g
dGFyZ2V0OworICAgIH0KKwogICAgIHJldHVybiAwOwogfQogCkBAIC0zNjcs
MjAgKzM4OCwyOCBAQCBzdGF0aWMgaW50IGFtZF9pb21tdV9hc3NpZ25fZGV2
aWNlKHN0cnVjCiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFw
cGluZ3MgPSBnZXRfaXZyc19tYXBwaW5ncyhwZGV2LT5zZWcpOwogICAgIGlu
dCBiZGYgPSBQQ0lfQkRGMihwZGV2LT5idXMsIGRldmZuKTsKICAgICBpbnQg
cmVxX2lkID0gZ2V0X2RtYV9yZXF1ZXN0b3JfaWQocGRldi0+c2VnLCBiZGYp
OwotICAgIGNvbnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqdW5pdHlfbWFw
OworICAgIGludCByYyA9IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0
eV9tYXAoCisgICAgICAgICAgICAgICAgIGQsIGl2cnNfbWFwcGluZ3NbcmVx
X2lkXS51bml0eV9tYXAsIGZsYWcpOwogCi0gICAgZm9yICggdW5pdHlfbWFw
ID0gaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVuaXR5X21hcDsgdW5pdHlfbWFw
OwotICAgICAgICAgIHVuaXR5X21hcCA9IHVuaXR5X21hcC0+bmV4dCApCisg
ICAgaWYgKCAhcmMgKQorICAgICAgICByYyA9IHJlYXNzaWduX2RldmljZShw
ZGV2LT5kb21haW4sIGQsIGRldmZuLCBwZGV2KTsKKworICAgIGlmICggcmMg
JiYgIWlzX2hhcmR3YXJlX2RvbWFpbihkKSApCiAgICAgewotICAgICAgICBp
bnQgcmMgPSBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKAot
ICAgICAgICAgICAgICAgICAgICAgZCwgdW5pdHlfbWFwLT5hZGRyLCB1bml0
eV9tYXAtPmxlbmd0aCwKLSAgICAgICAgICAgICAgICAgICAgIHVuaXR5X21h
cC0+d3JpdGUsIHVuaXR5X21hcC0+cmVhZCk7CisgICAgICAgIGludCByZXQg
PSBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfdW5tYXAoCisgICAg
ICAgICAgICAgICAgICAgICAgZCwgaXZyc19tYXBwaW5nc1tyZXFfaWRdLnVu
aXR5X21hcCk7CiAKLSAgICAgICAgaWYgKCByYyApCi0gICAgICAgICAgICBy
ZXR1cm4gcmM7CisgICAgICAgIGlmICggcmV0ICkKKyAgICAgICAgeworICAg
ICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIkFNRC1WaTogIgorICAgICAg
ICAgICAgICAgICAgICJ1bml0eS11bm1hcCBmb3IgJXBkLyUwNHg6JTAyeDol
MDJ4LiV1IGZhaWxlZCAoJWQpXG4iLAorICAgICAgICAgICAgICAgICAgIGQs
IHBkZXYtPnNlZywgcGRldi0+YnVzLAorICAgICAgICAgICAgICAgICAgIFBD
SV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLCByZXQpOworICAgICAg
ICAgICAgZG9tYWluX2NyYXNoKGQpOworICAgICAgICB9CiAgICAgfQogCi0g
ICAgcmV0dXJuIHJlYXNzaWduX2RldmljZShwZGV2LT5kb21haW4sIGQsIGRl
dmZuLCBwZGV2KTsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyB2b2lk
IGFtZF9pb21tdV9jbGVhcl9yb290X3BndGFibGUoc3RydWN0IGRvbWFpbiAq
ZCkKQEAgLTM5NCw2ICs0MjMsNyBAQCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVf
Y2xlYXJfcm9vdF9wZ3RhYmxlCiAKIHN0YXRpYyB2b2lkIGFtZF9pb21tdV9k
b21haW5fZGVzdHJveShzdHJ1Y3QgZG9tYWluICpkKQogeworICAgIGlvbW11
X2lkZW50aXR5X21hcF90ZWFyZG93bihkKTsKICAgICBBU1NFUlQoIWRvbV9p
b21tdShkKS0+YXJjaC5hbWQucm9vdF90YWJsZSk7CiB9CiAK

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-6.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-6.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UgZXhjbHVzaW9uIHJhbmdlIGFuZCB1
bml0eSBtYXAgcmVjb3JkaW5nCgpUaGUgc3BlYyBtYWtlcyBubyBwcm92aXNp
b25zIGZvciBPUyBiZWhhdmlvciBoZXJlIHRvIGRlcGVuZCBvbiB0aGUKYW1v
dW50IG9mIFJBTSBmb3VuZCBvbiB0aGUgc3lzdGVtLiBXaGlsZSB0aGUgc3Bl
YyBtYXkgbm90IHN1ZmZpY2llbnRseQpjbGVhcmx5IGRpc3Rpbmd1aXNoIGJv
dGgga2luZHMgb2YgcmVnaW9ucywgdGhleSBhcmUgc3VyZWx5IG1lYW50IHRv
IGJlCnNlcGFyYXRlIHRoaW5nczogT25seSByZWdpb25zIHdpdGggQUNQSV9J
Vk1EX0VYQ0xVU0lPTl9SQU5HRSBzZXQgc2hvdWxkCmJlIGNhbmRpZGF0ZXMg
Zm9yIHB1dHRpbmcgaW4gdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3RlcnMu
IChBcyB0aGVyZSdzCm9ubHkgYSBzaW5nbGUgc3VjaCBwYWlyIG9mIHJlZ2lz
dGVycyBwZXIgSU9NTVUsIHNlY29uZGFyeSBub24tYWRqYWNlbnQKcmVnaW9u
cyB3aXRoIHRoZSBmbGFnIHNldCBhbHJlYWR5IGdldCBjb252ZXJ0ZWQgdG8g
dW5pdHkgbWFwcGVkCnJlZ2lvbnMuKQoKRmlyc3Qgb2YgYWxsLCBkcm9wIHRo
ZSBkZXBlbmRlbmN5IG9uIG1heF9wYWdlLiBXaXRoIGNvbW1pdCBiNGYwNDIy
MzZhZTAKKCJBTUQvSU9NTVU6IENlYXNlIHVzaW5nIGEgZHluYW1pYyBoZWln
aHQgZm9yIHRoZSBJT01NVSBwYWdldGFibGVzIikgdGhlCnVzZSBvZiBpdCBo
ZXJlIHdhcyBzdGFsZSBhbnl3YXk7IGl0IHdhcyBib2d1cyBhbHJlYWR5IGJl
Zm9yZSwgYXMgaXQKZGlkbid0IGFjY291bnQgZm9yIG1heF9wYWdlIGdldHRp
bmcgaW5jcmVhc2VkIGxhdGVyIG9uLiBTaW1wbHkgdHJ5IGFuCmV4Y2x1c2lv
biByYW5nZSByZWdpc3RyYXRpb24gZmlyc3QsIGFuZCBpZiBpdCBmYWlscyAo
Zm9yIGJlaW5nCnVuc3VpdGFibGUgb3Igbm9uLW1lcmdlYWJsZSksIHJlZ2lz
dGVyIGEgdW5pdHkgbWFwcGluZyByYW5nZS4KCldpdGggdGhpcyB2YXJpb3Vz
IGxvY2FsIHZhcmlhYmxlcyBiZWNvbWUgdW5uZWNlc3NhcnkgYW5kIGhlbmNl
IGdldApkcm9wcGVkIGF0IHRoZSBzYW1lIHRpbWUuCgpXaXRoIHRoZSBtYXhf
cGFnZSBib3VuZGFyeSBkcm9wcGVkIGZvciB1c2luZyB1bml0eSBtYXBzLCB0
aGUgbWluaW11bQpwYWdlIHRhYmxlIHRyZWUgaGVpZ2h0IG5vdyBuZWVkcyBi
b3RoIHJlY29yZGluZyBhbmQgZW5mb3JjaW5nIGluCmFtZF9pb21tdV9kb21h
aW5faW5pdCgpLiBTaW5jZSB3ZSBjYW4ndCBwcmVkaWN0IHdoaWNoIGRldmlj
ZXMgbWF5IGdldAphc3NpZ25lZCB0byBhIGRvbWFpbiwgb3VyIG9ubHkgb3B0
aW9uIGlzIHRvIHVuaWZvcm1seSBmb3JjZSBhdCBsZWFzdAp0aGF0IGhlaWdo
dCBmb3IgYWxsIGRvbWFpbnMsIG5vdyB0aGF0IHRoZSBoZWlnaHQgaXNuJ3Qg
ZHluYW1pYyBhbnltb3JlLgoKRnVydGhlciBkb24ndCBtYWtlIHVzZSBvZiB0
aGUgZXhjbHVzaW9uIHJhbmdlIHVubGVzcyBBQ1BJIGRhdGEgc2F5cyBzby4K
Ck5vdGUgdGhhdCBleGNsdXNpb24gcmFuZ2UgcmVnaXN0cmF0aW9uIGluCnJl
Z2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygpIGlzIG9uIGEgYmVzdCBl
ZmZvcnQgYmFzaXMuIEhlbmNlIHVuaXR5Cm1hcCBlbnRyaWVzIGFsc28gcmVn
aXN0ZXJlZCBhcmUgcmVkdW5kYW50IHdoZW4gdGhlIGZvcm1lciBzdWNjZWVk
ZWQsIGJ1dAp0aGV5IGFsc28gZG8gbm8gaGFybS4gSW1wcm92ZW1lbnRzIGlu
IHRoaXMgYXJlYSBjYW4gYmUgZG9uZSBsYXRlciBpbW8uCgpBbHNvIGFkanVz
dCB0eXBlcyB3aGVyZSBzdWl0YWJsZSB3aXRob3V0IHRvdWNoaW5nIGV4dHJh
IGxpbmVzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zNzguCgpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBQYXVsIER1cnJhbnQgPHBhdWxAeGVuLm9yZz4KCi0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdS5oCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdS5oCkBAIC0zMDQsNiArMzA0LDgg
QEAgZXh0ZXJuIHN0cnVjdCBocGV0X3NiZGYgewogICAgIH0gaW5pdDsKIH0g
aHBldF9zYmRmOwogCitleHRlcm4gaW50IGFtZF9pb21tdV9taW5fcGFnaW5n
X21vZGU7CisKIGV4dGVybiB2b2lkICpzaGFyZWRfaW50cmVtYXBfdGFibGU7
CiBleHRlcm4gdW5zaWduZWQgbG9uZyAqc2hhcmVkX2ludHJlbWFwX2ludXNl
OwogCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9h
Y3BpLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X2FjcGkuYwpAQCAtMTE3LDEyICsxMTcsOCBAQCBzdGF0aWMgc3RydWN0IGFt
ZF9pb21tdSAqIF9faW5pdCBmaW5kX2lvCiB9CiAKIHN0YXRpYyBpbnQgX19p
bml0IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKAotICAgIHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11LCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBs
aW1pdCwKLSAgICBib29sIGFsbCwgYm9vbCBpdywgYm9vbCBpcikKKyAgICBz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgcGFkZHJfdCBiYXNlLCBwYWRkcl90
IGxpbWl0LCBib29sIGFsbCkKIHsKLSAgICBpZiAoICFpciB8fCAhaXcgKQot
ICAgICAgICByZXR1cm4gLUVQRVJNOwotCiAgICAgLyogbmVlZCB0byBleHRl
bmQgZXhjbHVzaW9uIHJhbmdlPyAqLwogICAgIGlmICggaW9tbXUtPmV4Y2x1
c2lvbl9lbmFibGUgKQogICAgIHsKQEAgLTE1MSwxNCArMTQ3LDE4IEBAIHN0
YXRpYyBpbnQgX19pbml0IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl8KIHsKICAg
ICBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9p
dnJzX21hcHBpbmdzKHNlZyk7CiAgICAgc3RydWN0IGl2cnNfdW5pdHlfbWFw
ICp1bml0eV9tYXAgPSBpdnJzX21hcHBpbmdzW2JkZl0udW5pdHlfbWFwOwor
ICAgIGludCBwYWdpbmdfbW9kZSA9IGFtZF9pb21tdV9nZXRfcGFnaW5nX21v
ZGUoUEZOX1VQKGJhc2UgKyBsZW5ndGgpKTsKKworICAgIGlmICggcGFnaW5n
X21vZGUgPCAwICkKKyAgICAgICAgcmV0dXJuIHBhZ2luZ19tb2RlOwogCiAg
ICAgLyogQ2hlY2sgZm9yIG92ZXJsYXBzLiAqLwogICAgIGZvciAoIDsgdW5p
dHlfbWFwOyB1bml0eV9tYXAgPSB1bml0eV9tYXAtPm5leHQgKQogICAgIHsK
ICAgICAgICAgLyoKICAgICAgICAgICogRXhhY3QgbWF0Y2hlcyBhcmUgb2th
eS4gVGhpcyBjYW4gaW4gcGFydGljdWxhciBoYXBwZW4gd2hlbgotICAgICAg
ICAgKiByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZSgpIGNh
bGxzIGhlcmUgdHdpY2UgZm9yIHRoZQotICAgICAgICAgKiBzYW1lIChzLGIs
ZCxmKS4KKyAgICAgICAgICogcmVnaXN0ZXJfcmFuZ2VfZm9yX2RldmljZSgp
IGNhbGxzIGhlcmUgdHdpY2UgZm9yIHRoZSBzYW1lCisgICAgICAgICAqIChz
LGIsZCxmKS4KICAgICAgICAgICovCiAgICAgICAgIGlmICggYmFzZSA9PSB1
bml0eV9tYXAtPmFkZHIgJiYgbGVuZ3RoID09IHVuaXR5X21hcC0+bGVuZ3Ro
ICYmCiAgICAgICAgICAgICAgaXIgPT0gdW5pdHlfbWFwLT5yZWFkICYmIGl3
ID09IHVuaXR5X21hcC0+d3JpdGUgKQpAQCAtMTg2LDU1ICsxODYsNTIgQEAg
c3RhdGljIGludCBfX2luaXQgcmVzZXJ2ZV91bml0eV9tYXBfZm9yXwogICAg
IHVuaXR5X21hcC0+bmV4dCA9IGl2cnNfbWFwcGluZ3NbYmRmXS51bml0eV9t
YXA7CiAgICAgaXZyc19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcCA9IHVuaXR5
X21hcDsKIAorICAgIGlmICggcGFnaW5nX21vZGUgPiBhbWRfaW9tbXVfbWlu
X3BhZ2luZ19tb2RlICkKKyAgICAgICAgYW1kX2lvbW11X21pbl9wYWdpbmdf
bW9kZSA9IHBhZ2luZ19tb2RlOworCiAgICAgcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3Jf
YWxsX2RldmljZXMoCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25l
ZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5p
dCByZWdpc3Rlcl9yYW5nZV9mb3JfYWxsX2RldmljZXMoCisgICAgcGFkZHJf
dCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29s
IGV4Y2x1c2lvbikKIHsKICAgICBpbnQgc2VnID0gMDsgLyogWFhYICovCi0g
ICAgdW5zaWduZWQgbG9uZyByYW5nZV90b3AsIGlvbW11X3RvcCwgbGVuZ3Ro
OwogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwotICAgIHVuc2lnbmVk
IGludCBiZGY7CiAgICAgaW50IHJjID0gMDsKIAogICAgIC8qIGlzIHBhcnQg
b2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBvZiBJT01NVSB2aXJ0dWFsIGFk
ZHJlc3Mgc3BhY2U/ICovCiAgICAgLyogbm90ZTogJ2xpbWl0JyBwYXJhbWV0
ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFsaWduZWQgKi8KLSAgICByYW5n
ZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsKLSAgICBpb21tdV90b3AgPSBt
YXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBpZiAoIGJhc2UgPCBpb21tdV90
b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCByYW5nZV90b3AgPiBpb21tdV90
b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9wID0gaW9tbXVfdG9wOwotICAg
ICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBiYXNlOwotICAgICAgICAvKiBy
ZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZp
Y2VzICovCi0gICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJpZXMgYXJlIHBh
cnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwotICAgICAgICBmb3IgKCBi
ZGYgPSAwOyAhcmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysg
KQotICAgICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2
aWNlKHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7Ci0gICAgICAg
IC8qIHB1c2ggJ2Jhc2UnIGp1c3Qgb3V0c2lkZSBvZiB2aXJ0dWFsIGFkZHJl
c3Mgc3BhY2UgKi8KLSAgICAgICAgYmFzZSA9IGlvbW11X3RvcDsKLSAgICB9
Ci0gICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhjbHVzaW9uIHJhbmdlIHNldHRp
bmdzICovCi0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9tbXVfdG9wICkK
KyAgICBpZiAoIGV4Y2x1c2lvbiApCiAgICAgewogICAgICAgICBmb3JfZWFj
aF9hbWRfaW9tbXUoIGlvbW11ICkKICAgICAgICAgewotICAgICAgICAgICAg
cmMgPSByZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFz
ZSwgbGltaXQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOwotICAgICAg
ICAgICAgaWYgKCByYyApCi0gICAgICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgICAgICBpbnQgcmV0ID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFu
Z2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyogYWxsICov
KTsKKworICAgICAgICAgICAgaWYgKCByZXQgJiYgIXJjICkKKyAgICAgICAg
ICAgICAgICByYyA9IHJldDsKICAgICAgICAgfQogICAgIH0KIAorICAgIGlm
ICggIWV4Y2x1c2lvbiB8fCByYyApCisgICAgeworICAgICAgICBwYWRkcl90
IGxlbmd0aCA9IGxpbWl0ICsgUEFHRV9TSVpFIC0gYmFzZTsKKyAgICAgICAg
dW5zaWduZWQgaW50IGJkZjsKKworICAgICAgICAvKiByZXNlcnZlIHIvdyB1
bml0eS1tYXBwZWQgcGFnZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCisgICAg
ICAgIGZvciAoIGJkZiA9IHJjID0gMDsgIXJjICYmIGJkZiA8IGl2cnNfYmRm
X2VudHJpZXM7IGJkZisrICkKKyAgICAgICAgICAgIHJjID0gcmVzZXJ2ZV91
bml0eV9tYXBfZm9yX2RldmljZShzZWcsIGJkZiwgYmFzZSwgbGVuZ3RoLCBp
dywgaXIpOworICAgIH0KKwogICAgIHJldHVybiByYzsKIH0KIAotc3RhdGlj
IGludCBfX2luaXQgcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9kZXZp
Y2UoCi0gICAgdTE2IGJkZiwgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25l
ZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5p
dCByZWdpc3Rlcl9yYW5nZV9mb3JfZGV2aWNlKAorICAgIHVuc2lnbmVkIGlu
dCBiZGYsIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwKKyAgICBib29s
IGl3LCBib29sIGlyLCBib29sIGV4Y2x1c2lvbikKIHsKICAgICBpbnQgc2Vn
ID0gMDsgLyogWFhYICovCiAgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2
cnNfbWFwcGluZ3MgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcpOwotICAgIHVu
c2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsKICAg
ICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdTsKICAgICB1MTYgcmVxOwogICAg
IGludCByYyA9IDA7CkBAIC0yNDgsMjcgKzI0NSwxOSBAQCBzdGF0aWMgaW50
IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgcmVxID0gaXZy
c19tYXBwaW5nc1tiZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7CiAKICAgICAvKiBu
b3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2Ut
YWxpZ25lZCAqLwotICAgIHJhbmdlX3RvcCA9IGxpbWl0ICsgUEFHRV9TSVpF
OwotICAgIGlvbW11X3RvcCA9IG1heF9wYWdlICogUEFHRV9TSVpFOwotICAg
IGlmICggYmFzZSA8IGlvbW11X3RvcCApCi0gICAgewotICAgICAgICBpZiAo
IHJhbmdlX3RvcCA+IGlvbW11X3RvcCApCi0gICAgICAgICAgICByYW5nZV90
b3AgPSBpb21tdV90b3A7Ci0gICAgICAgIGxlbmd0aCA9IHJhbmdlX3RvcCAt
IGJhc2U7CisgICAgaWYgKCBleGNsdXNpb24gKQorICAgICAgICByYyA9IHJl
c2VydmVfaW9tbXVfZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1p
dCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBmYWxzZSAvKiBhbGwgKi8pOworICAgIGlmICggIWV4Y2x1c2lvbiB8fCBy
YyApCisgICAgeworICAgICAgICBwYWRkcl90IGxlbmd0aCA9IGxpbWl0ICsg
UEFHRV9TSVpFIC0gYmFzZTsKKwogICAgICAgICAvKiByZXNlcnZlIHVuaXR5
LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZSAqLwotICAgICAgICAv
KiBub3RlOiB0aGVzZSBlbnRyaWVzIGFyZSBwYXJ0IG9mIHRoZSBleGNsdXNp
b24gcmFuZ2UgKi8KICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9m
b3JfZGV2aWNlKHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcikgPzoK
ICAgICAgICAgICAgICByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKHNl
ZywgcmVxLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7Ci0KLSAgICAgICAgLyog
cHVzaCAnYmFzZScganVzdCBvdXRzaWRlIG9mIHZpcnR1YWwgYWRkcmVzcyBz
cGFjZSAqLwotICAgICAgICBiYXNlID0gaW9tbXVfdG9wOwogICAgIH0KLQot
ICAgIC8qIHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5n
cyBmb3IgZGV2aWNlICovCi0gICAgaWYgKCAhcmMgJiYgbGltaXQgPj0gaW9t
bXVfdG9wICApCisgICAgZWxzZQogICAgIHsKLSAgICAgICAgcmMgPSByZXNl
cnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZmFsc2UgLyogYWxsICovLCBpdywgaXIpOwogICAgICAgICBpdnJzX21hcHBp
bmdzW2JkZl0uZHRlX2FsbG93X2V4Y2x1c2lvbiA9IHRydWU7CiAgICAgICAg
IGl2cnNfbWFwcGluZ3NbcmVxXS5kdGVfYWxsb3dfZXhjbHVzaW9uID0gdHJ1
ZTsKICAgICB9CkBAIC0yNzYsNTMgKzI2NSw0MiBAQCBzdGF0aWMgaW50IF9f
aW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFuCiAgICAgcmV0dXJuIHJjOwog
fQogCi1zdGF0aWMgaW50IF9faW5pdCByZWdpc3Rlcl9leGNsdXNpb25fcmFu
Z2VfZm9yX2lvbW11X2RldmljZXMoCi0gICAgc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUsCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNpZ25lZCBsb25n
IGxpbWl0LCB1OCBpdywgdTggaXIpCitzdGF0aWMgaW50IF9faW5pdCByZWdp
c3Rlcl9yYW5nZV9mb3JfaW9tbXVfZGV2aWNlcygKKyAgICBzdHJ1Y3QgYW1k
X2lvbW11ICppb21tdSwgcGFkZHJfdCBiYXNlLCBwYWRkcl90IGxpbWl0LAor
ICAgIGJvb2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewotICAg
IHVuc2lnbmVkIGxvbmcgcmFuZ2VfdG9wLCBpb21tdV90b3AsIGxlbmd0aDsK
KyAgICAvKiBub3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1bWVkIHRv
IGJlIHBhZ2UtYWxpZ25lZCAqLworICAgIHBhZGRyX3QgbGVuZ3RoID0gbGlt
aXQgKyBQQUdFX1NJWkUgLSBiYXNlOwogICAgIHVuc2lnbmVkIGludCBiZGY7
CiAgICAgdTE2IHJlcTsKLSAgICBpbnQgcmMgPSAwOworICAgIGludCByYzsK
IAotICAgIC8qIGlzIHBhcnQgb2YgZXhjbHVzaW9uIHJhbmdlIGluc2lkZSBv
ZiBJT01NVSB2aXJ0dWFsIGFkZHJlc3Mgc3BhY2U/ICovCi0gICAgLyogbm90
ZTogJ2xpbWl0JyBwYXJhbWV0ZXIgaXMgYXNzdW1lZCB0byBiZSBwYWdlLWFs
aWduZWQgKi8KLSAgICByYW5nZV90b3AgPSBsaW1pdCArIFBBR0VfU0laRTsK
LSAgICBpb21tdV90b3AgPSBtYXhfcGFnZSAqIFBBR0VfU0laRTsKLSAgICBp
ZiAoIGJhc2UgPCBpb21tdV90b3AgKQotICAgIHsKLSAgICAgICAgaWYgKCBy
YW5nZV90b3AgPiBpb21tdV90b3AgKQotICAgICAgICAgICAgcmFuZ2VfdG9w
ID0gaW9tbXVfdG9wOwotICAgICAgICBsZW5ndGggPSByYW5nZV90b3AgLSBi
YXNlOwotICAgICAgICAvKiByZXNlcnZlIHIvdyB1bml0eS1tYXBwZWQgcGFn
ZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCi0gICAgICAgIC8qIG5vdGU6IHRo
ZXNlIGVudHJpZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAq
LwotICAgICAgICBmb3IgKCBiZGYgPSAwOyAhcmMgJiYgYmRmIDwgaXZyc19i
ZGZfZW50cmllczsgYmRmKysgKQotICAgICAgICB7Ci0gICAgICAgICAgICBp
ZiAoIGlvbW11ID09IGZpbmRfaW9tbXVfZm9yX2RldmljZShpb21tdS0+c2Vn
LCBiZGYpICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICByZXEg
PSBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVtiZGZdLmR0ZV9yZXF1
ZXN0b3JfaWQ7Ci0gICAgICAgICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5
X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZiwgYmFzZSwgbGVuZ3Ro
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpdywgaXIpID86Ci0gICAgICAgICAgICAgICAgICAgICByZXNl
cnZlX3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFz
ZSwgbGVuZ3RoLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpdywgaXIpOwotICAgICAgICAgICAgfQotICAg
ICAgICB9Ci0KLSAgICAgICAgLyogcHVzaCAnYmFzZScganVzdCBvdXRzaWRl
IG9mIHZpcnR1YWwgYWRkcmVzcyBzcGFjZSAqLwotICAgICAgICBiYXNlID0g
aW9tbXVfdG9wOworICAgIGlmICggZXhjbHVzaW9uICkKKyAgICB7CisgICAg
ICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUs
IGJhc2UsIGxpbWl0LCB0cnVlIC8qIGFsbCAqLyk7CisgICAgICAgIGlmICgg
IXJjICkKKyAgICAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAotICAgIC8q
IHJlZ2lzdGVyIElPTU1VIGV4Y2x1c2lvbiByYW5nZSBzZXR0aW5ncyAqLwot
ICAgIGlmICggIXJjICYmIGxpbWl0ID49IGlvbW11X3RvcCApCi0gICAgICAg
IHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNpb25fcmFuZ2UoaW9tbXUsIGJh
c2UsIGxpbWl0LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHRydWUgLyogYWxsICovLCBpdywgaXIpOworICAgIC8qIHJl
c2VydmUgdW5pdHktbWFwcGVkIHBhZ2UgZW50cmllcyBmb3IgZGV2aWNlcyAq
LworICAgIGZvciAoIGJkZiA9IHJjID0gMDsgIXJjICYmIGJkZiA8IGl2cnNf
YmRmX2VudHJpZXM7IGJkZisrICkKKyAgICB7CisgICAgICAgIGlmICggaW9t
bXUgIT0gZmluZF9pb21tdV9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZikg
KQorICAgICAgICAgICAgY29udGludWU7CisKKyAgICAgICAgcmVxID0gZ2V0
X2l2cnNfbWFwcGluZ3MoaW9tbXUtPnNlZylbYmRmXS5kdGVfcmVxdWVzdG9y
X2lkOworICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZp
Y2UoaW9tbXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIpID86Cisg
ICAgICAgICAgICAgcmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShpb21t
dS0+c2VnLCByZXEsIGJhc2UsIGxlbmd0aCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcik7CisgICAgfQogCiAg
ICAgcmV0dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9p
dm1kX2RldmljZV9zZWxlY3QoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZy
c19tZW1vcnkgKml2bWRfYmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNl
LCB1bnNpZ25lZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFk
ZHJfdCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBi
b29sIGV4Y2x1c2lvbikKIHsKICAgICB1MTYgYmRmOwogCkBAIC0zMzMsMTIg
KzMxMSwxMiBAQCBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2Rldmlj
ZV9zZWxlCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogICAgIH0KIAotICAg
IHJldHVybiByZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZShi
ZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAgIHJldHVybiByZWdpc3Rl
cl9yYW5nZV9mb3JfZGV2aWNlKGJkZiwgYmFzZSwgbGltaXQsIGl3LCBpciwg
ZXhjbHVzaW9uKTsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZt
ZF9kZXZpY2VfcmFuZ2UoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19t
ZW1vcnkgKml2bWRfYmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1
bnNpZ25lZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJf
dCBiYXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29s
IGV4Y2x1c2lvbikKIHsKICAgICB1bnNpZ25lZCBpbnQgZmlyc3RfYmRmLCBs
YXN0X2JkZiwgYmRmOwogICAgIGludCBlcnJvcjsKQEAgLTM2MCwxNSArMzM4
LDE1IEBAIHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3Jh
bmcKICAgICB9CiAKICAgICBmb3IgKCBiZGYgPSBmaXJzdF9iZGYsIGVycm9y
ID0gMDsgKGJkZiA8PSBsYXN0X2JkZikgJiYgIWVycm9yOyBiZGYrKyApCi0g
ICAgICAgIGVycm9yID0gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9k
ZXZpY2UoCi0gICAgICAgICAgICBiZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIp
OworICAgICAgICBlcnJvciA9IHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2Uo
CisgICAgICAgICAgICBiZGYsIGJhc2UsIGxpbWl0LCBpdywgaXIsIGV4Y2x1
c2lvbik7CiAKICAgICByZXR1cm4gZXJyb3I7CiB9CiAKIHN0YXRpYyBpbnQg
X19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX2lvbW11KAogICAgIGNvbnN0IHN0
cnVjdCBhY3BpX2l2cnNfbWVtb3J5ICppdm1kX2Jsb2NrLAotICAgIHVuc2ln
bmVkIGxvbmcgYmFzZSwgdW5zaWduZWQgbG9uZyBsaW1pdCwgdTggaXcsIHU4
IGlyKQorICAgIHBhZGRyX3QgYmFzZSwgcGFkZHJfdCBsaW1pdCwgYm9vbCBp
dywgYm9vbCBpciwgYm9vbCBleGNsdXNpb24pCiB7CiAgICAgaW50IHNlZyA9
IDA7IC8qIFhYWCAqLwogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwpA
QCAtMzgzLDE0ICszNjEsMTQgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2Vf
aXZtZF9kZXZpY2VfaW9tbQogICAgICAgICByZXR1cm4gLUVOT0RFVjsKICAg
ICB9CiAKLSAgICByZXR1cm4gcmVnaXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zv
cl9pb21tdV9kZXZpY2VzKAotICAgICAgICBpb21tdSwgYmFzZSwgbGltaXQs
IGl3LCBpcik7CisgICAgcmV0dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9pb21t
dV9kZXZpY2VzKAorICAgICAgICBpb21tdSwgYmFzZSwgbGltaXQsIGl3LCBp
ciwgZXhjbHVzaW9uKTsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2Vf
aXZtZF9ibG9jayhjb25zdCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZt
ZF9ibG9jaykKIHsKICAgICB1bnNpZ25lZCBsb25nIHN0YXJ0X2FkZHIsIG1l
bV9sZW5ndGgsIGJhc2UsIGxpbWl0OwotICAgIHU4IGl3LCBpcjsKKyAgICBi
b29sIGl3ID0gdHJ1ZSwgaXIgPSB0cnVlLCBleGNsdXNpb24gPSBmYWxzZTsK
IAogICAgIGlmICggaXZtZF9ibG9jay0+aGVhZGVyLmxlbmd0aCA8IHNpemVv
ZigqaXZtZF9ibG9jaykgKQogICAgIHsKQEAgLTQwNywxMyArMzg1LDExIEBA
IHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfYmxvY2soY29uc3QKICAg
ICAgICAgICAgICAgICAgICAgaXZtZF9ibG9jay0+aGVhZGVyLnR5cGUsIHN0
YXJ0X2FkZHIsIG1lbV9sZW5ndGgpOwogCiAgICAgaWYgKCBpdm1kX2Jsb2Nr
LT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfRVhDTFVTSU9OX1JBTkdFICkK
LSAgICAgICAgaXcgPSBpciA9IElPTU1VX0NPTlRST0xfRU5BQkxFRDsKKyAg
ICAgICAgZXhjbHVzaW9uID0gdHJ1ZTsKICAgICBlbHNlIGlmICggaXZtZF9i
bG9jay0+aGVhZGVyLmZsYWdzICYgQUNQSV9JVk1EX1VOSVRZICkKICAgICB7
Ci0gICAgICAgIGl3ID0gaXZtZF9ibG9jay0+aGVhZGVyLmZsYWdzICYgQUNQ
SV9JVk1EX1JFQUQgPwotICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FTkFC
TEVEIDogSU9NTVVfQ09OVFJPTF9ESVNBQkxFRDsKLSAgICAgICAgaXIgPSBp
dm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfV1JJVEUgPwot
ICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FTkFCTEVEIDogSU9NTVVfQ09O
VFJPTF9ESVNBQkxFRDsKKyAgICAgICAgaXcgPSBpdm1kX2Jsb2NrLT5oZWFk
ZXIuZmxhZ3MgJiBBQ1BJX0lWTURfUkVBRDsKKyAgICAgICAgaXIgPSBpdm1k
X2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfV1JJVEU7CiAgICAg
fQogICAgIGVsc2UKICAgICB7CkBAIC00MjQsMjAgKzQwMCwyMCBAQCBzdGF0
aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2Jsb2NrKGNvbnN0CiAgICAgc3dp
dGNoKCBpdm1kX2Jsb2NrLT5oZWFkZXIudHlwZSApCiAgICAgewogICAgIGNh
c2UgQUNQSV9JVlJTX1RZUEVfTUVNT1JZX0FMTDoKLSAgICAgICAgcmV0dXJu
IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfYWxsX2RldmljZXMoCi0g
ICAgICAgICAgICBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICAgICAgcmV0
dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygKKyAgICAgICAg
ICAgIGJhc2UsIGxpbWl0LCBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAgICBj
YXNlIEFDUElfSVZSU19UWVBFX01FTU9SWV9PTkU6Ci0gICAgICAgIHJldHVy
biBwYXJzZV9pdm1kX2RldmljZV9zZWxlY3QoaXZtZF9ibG9jaywKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLCBsaW1p
dCwgaXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNl
X3NlbGVjdChpdm1kX2Jsb2NrLCBiYXNlLCBsaW1pdCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdywgaXIsIGV4Y2x1c2lv
bik7CiAKICAgICBjYXNlIEFDUElfSVZSU19UWVBFX01FTU9SWV9SQU5HRToK
LSAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX3JhbmdlKGl2bWRf
YmxvY2ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNl
X2l2bWRfZGV2aWNlX3JhbmdlKGl2bWRfYmxvY2ssIGJhc2UsIGxpbWl0LAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGly
LCBleGNsdXNpb24pOwogCiAgICAgY2FzZSBBQ1BJX0lWUlNfVFlQRV9NRU1P
UllfSU9NTVU6Ci0gICAgICAgIHJldHVybiBwYXJzZV9pdm1kX2RldmljZV9p
b21tdShpdm1kX2Jsb2NrLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYmFzZSwgbGltaXQsIGl3LCBpcik7CisgICAgICAgIHJl
dHVybiBwYXJzZV9pdm1kX2RldmljZV9pb21tdShpdm1kX2Jsb2NrLCBiYXNl
LCBsaW1pdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIGRlZmF1bHQ6CiAgICAg
ICAgIEFNRF9JT01NVV9ERUJVRygiSVZNRCBFcnJvcjogSW52YWxpZCBCbG9j
ayBUeXBlIVxuIik7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9wY2lfYW1kX2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwpAQCAtMjM0LDYgKzIzNCw4IEBAIHN0
YXRpYyBpbnQgX19tdXN0X2NoZWNrIGFsbG9jYXRlX2RvbWFpbl8KICAgICBy
ZXR1cm4gcmM7CiB9CiAKK2ludCBfX3JlYWRfbW9zdGx5IGFtZF9pb21tdV9t
aW5fcGFnaW5nX21vZGUgPSAxOworCiBzdGF0aWMgaW50IGFtZF9pb21tdV9k
b21haW5faW5pdChzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHN0cnVjdCBk
b21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOwpAQCAtMjQ1LDExICsy
NDcsMTMgQEAgc3RhdGljIGludCBhbWRfaW9tbXVfZG9tYWluX2luaXQoc3Ry
dWN0CiAgICAgICogLSBIVk0gY291bGQgaW4gcHJpbmNpcGxlIHVzZSAzIG9y
IDQgZGVwZW5kaW5nIG9uIGhvdyBtdWNoIGd1ZXN0CiAgICAgICogICBwaHlz
aWNhbCBhZGRyZXNzIHNwYWNlIHdlIGdpdmUgaXQsIGJ1dCB0aGlzIGlzbid0
IGtub3duIHlldCBzbyB1c2UgNAogICAgICAqICAgdW5pbGF0ZXJhbGx5Lgor
ICAgICAqIC0gVW5pdHkgbWFwcyBtYXkgcmVxdWlyZSBhbiBldmVuIGhpZ2hl
ciBudW1iZXIuCiAgICAgICovCi0gICAgaGQtPmFyY2guYW1kLnBhZ2luZ19t
b2RlID0gYW1kX2lvbW11X2dldF9wYWdpbmdfbW9kZSgKLSAgICAgICAgaXNf
aHZtX2RvbWFpbihkKQotICAgICAgICA/IDF1bCA8PCAoREVGQVVMVF9ET01B
SU5fQUREUkVTU19XSURUSCAtIFBBR0VfU0hJRlQpCi0gICAgICAgIDogZ2V0
X3VwcGVyX21mbl9ib3VuZCgpICsgMSk7CisgICAgaGQtPmFyY2guYW1kLnBh
Z2luZ19tb2RlID0gbWF4KGFtZF9pb21tdV9nZXRfcGFnaW5nX21vZGUoCisg
ICAgICAgICAgICBpc19odm1fZG9tYWluKGQpCisgICAgICAgICAgICA/IDF1
bCA8PCAoREVGQVVMVF9ET01BSU5fQUREUkVTU19XSURUSCAtIFBBR0VfU0hJ
RlQpCisgICAgICAgICAgICA6IGdldF91cHBlcl9tZm5fYm91bmQoKSArIDEp
LAorICAgICAgICBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2RlKTsKIAogICAg
IHJldHVybiAwOwogfQo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-7.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-7.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBpbnRyb2R1Y2UgcDJtX2lzX3NwZWNpYWwoKQoKU2VlaW5n
IHRoZSBzaW1pbGFyaXR5IG9mIGdyYW50LCBmb3JlaWduLCBhbmQgKHN1YnNl
cXVlbnRseSkgZGlyZWN0LU1NSU8KaGFuZGxpbmcsIGludHJvZHVjZSBhIG5l
dyBQMk0gdHlwZSBncm91cCBuYW1lZCAic3BlY2lhbCIgKGFzIGluICJuZWVk
aW5nCnNwZWNpYWwgYWNjZXNzb3JzIHRvIGNyZWF0ZS9kZXN0cm95IikuCgpB
bHNvIHVzZSAtRVBFUk0gaW5zdGVhZCBvZiBvdGhlciBlcnJvciBjb2RlcyBv
biB0aGUgdHdvIGRvbWFpbl9jcmFzaCgpCnBhdGhzIHRvdWNoZWQuCgpUaGlz
IGlzIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtODExLDcgKzgx
MSw3IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJt
LAogICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRl
cik7IGkrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIHAybS0+Z2V0X2Vu
dHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5V
TEwpOwotICAgICAgICAgICAgaWYgKCAhcDJtX2lzX2dyYW50KHQpICYmICFw
Mm1faXNfc2hhcmVkKHQpICYmICFwMm1faXNfZm9yZWlnbih0KSApCisgICAg
ICAgICAgICBpZiAoICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3No
YXJlZCh0KSApCiAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4o
bWZuX3gobWZuKSArIGksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAg
fQogICAgIH0KQEAgLTk0MSwxMyArOTQxLDEzIEBAIGd1ZXN0X3BoeXNtYXBf
YWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKICAg
ICAgICAgICAgIEFTU0VSVCghcDJtX2lzX3NoYXJlZChvdCkpOwogICAgICAg
ICB9Ci0gICAgICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1faXNf
Zm9yZWlnbihvdCkgKQorICAgICAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90
KSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIC8qIFJlYWxseSBzaG91bGRu
J3QgYmUgdW5tYXBwaW5nIGdyYW50L2ZvcmVpZ24gbWFwcyB0aGlzIHdheSAq
LworICAgICAgICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFu
dC9mb3JlaWduIHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2Ny
YXNoKGQpOwogICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAg
ICAgICAgCi0gICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAg
ICAgIHJldHVybiAtRVBFUk07CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBp
ZiAoIHAybV9pc19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKICAg
ICAgICAgewpAQCAtMTA0MSw4ICsxMDQxLDcgQEAgaW50IHAybV9jaGFuZ2Vf
dHlwZV9vbmUoc3RydWN0IGRvbWFpbiAqZAogICAgIHN0cnVjdCBwMm1fZG9t
YWluICpwMm0gPSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAgICAgaW50IHJjOwog
Ci0gICAgQlVHX09OKHAybV9pc19ncmFudChvdCkgfHwgcDJtX2lzX2dyYW50
KG50KSk7Ci0gICAgQlVHX09OKHAybV9pc19mb3JlaWduKG90KSB8fCBwMm1f
aXNfZm9yZWlnbihudCkpOworICAgIEJVR19PTihwMm1faXNfc3BlY2lhbChv
dCkgfHwgcDJtX2lzX3NwZWNpYWwobnQpKTsKIAogICAgIGdmbl9sb2NrKHAy
bSwgZ2ZuLCAwKTsKIApAQCAtMTI4OSwxMSArMTI4OCwxMSBAQCBzdGF0aWMg
aW50IHNldF90eXBlZF9wMm1fZW50cnkoc3RydWN0IGRvCiAgICAgICAgIGdm
bl91bmxvY2socDJtLCBnZm4sIG9yZGVyKTsKICAgICAgICAgcmV0dXJuIGN1
cl9vcmRlciArIDE7CiAgICAgfQotICAgIGlmICggcDJtX2lzX2dyYW50KG90
KSB8fCBwMm1faXNfZm9yZWlnbihvdCkgKQorICAgIGlmICggcDJtX2lzX3Nw
ZWNpYWwob3QpICkKICAgICB7CiAgICAgICAgIGdmbl91bmxvY2socDJtLCBn
Zm4sIG9yZGVyKTsKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAg
ICByZXR1cm4gLUVOT0VOVDsKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAg
ICB9CiAgICAgZWxzZSBpZiAoIHAybV9pc19yYW0ob3QpICkKICAgICB7Ci0t
LSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9wMm0uaApAQCAtMTQ5LDYgKzE0OSwxMCBAQCB0eXBlZGVm
IHVuc2lnbmVkIGludCBwMm1fcXVlcnlfdDsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8IHAybV90b19tYXNrKHAybV9yYW1fbG9nZGlydHkpICkK
ICNkZWZpbmUgUDJNX1NIQVJFRF9UWVBFUyAgIChwMm1fdG9fbWFzayhwMm1f
cmFtX3NoYXJlZCkpCiAKKy8qIFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQg
dXAgdmlhIHNwZWNpYWwgYWNjZXNzb3JzLiAqLworI2RlZmluZSBQMk1fU1BF
Q0lBTF9UWVBFUyAoUDJNX0dSQU5UX1RZUEVTIHwgXAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSkK
KwogLyogVmFsaWQgdHlwZXMgbm90IG5lY2Vzc2FyaWx5IGFzc29jaWF0ZWQg
d2l0aCBhICh2YWxpZCkgTUZOLiAqLwogI2RlZmluZSBQMk1fSU5WQUxJRF9N
Rk5fVFlQRVMgKFAyTV9QT0RfVFlQRVMgICAgICAgICAgICAgICAgICBcCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBwMm1fdG9fbWFzayhw
Mm1fbW1pb19kaXJlY3QpIFwKQEAgLTE3Nyw2ICsxODEsNyBAQCB0eXBlZGVm
IHVuc2lnbmVkIGludCBwMm1fcXVlcnlfdDsKICNkZWZpbmUgcDJtX2lzX3Bh
Z2VkKF90KSAgICAocDJtX3RvX21hc2soX3QpICYgUDJNX1BBR0VEX1RZUEVT
KQogI2RlZmluZSBwMm1faXNfc2hhcmFibGUoX3QpIChwMm1fdG9fbWFzayhf
dCkgJiBQMk1fU0hBUkFCTEVfVFlQRVMpCiAjZGVmaW5lIHAybV9pc19zaGFy
ZWQoX3QpICAgKHAybV90b19tYXNrKF90KSAmIFAyTV9TSEFSRURfVFlQRVMp
CisjZGVmaW5lIHAybV9pc19zcGVjaWFsKF90KSAgKHAybV90b19tYXNrKF90
KSAmIFAyTV9TUEVDSUFMX1RZUEVTKQogI2RlZmluZSBwMm1faXNfYnJva2Vu
KF90KSAgIChwMm1fdG9fbWFzayhfdCkgJiBQMk1fQlJPS0VOX1RZUEVTKQog
I2RlZmluZSBwMm1faXNfZm9yZWlnbihfdCkgIChwMm1fdG9fbWFzayhfdCkg
JiBwMm1fdG9fbWFzayhwMm1fbWFwX2ZvcmVpZ24pKQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.15-8.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.15-8.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBndWFyZCAoaW4gcGFydGljdWxhcikgaWRlbnRpdHkgbWFw
cGluZyBlbnRyaWVzCgpTdWNoIGVudHJpZXMsIGNyZWF0ZWQgYnkgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpLCBzaG91bGQgb25seSBiZQpkZXN0cm95ZWQg
YnkgY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KCkuIEhvd2V2ZXIsIHNpbWls
YXJseSwgZW50cmllcwpjcmVhdGVkIGJ5IHNldF9tbWlvX3AybV9lbnRyeSgp
IHNob3VsZCBvbmx5IGJlIHRvcm4gZG93biBieQpjbGVhcl9tbWlvX3AybV9l
bnRyeSgpLCBzbyB0aGUgbG9naWMgZ2V0cyBiYXNlZCB1cG9uIHAybV9tbWlv
X2RpcmVjdCBhcwp0aGUgZW50cnkgdHlwZSAoc2VwYXJhdGlvbiBiZXR3ZWVu
ICJvcmRpbmFyeSIgYW5kIDE6MSBtYXBwaW5ncyB3b3VsZApyZXF1aXJlIGEg
ZnVydGhlciBpbmRpY2F0b3IgdG8gdGVsbCBhcGFydCB0aGUgdHdvKS4KCkFz
IHRvIHRoZSBndWVzdF9yZW1vdmVfcGFnZSgpIGNoYW5nZSwgY29tbWl0IDQ4
ZGZiMjk3YTIwYSAoIng4Ni9QVkg6CmFsbG93IGd1ZXN0X3JlbW92ZV9wYWdl
IHRvIHJlbW92ZSBwMm1fbW1pb19kaXJlY3QgcGFnZXMiKSwgd2hpY2gKaW50
cm9kdWNlZCB0aGUgY2FsbCB0byBjbGVhcl9tbWlvX3AybV9lbnRyeSgpLCBj
bGFpbWVkIHRoaXMgd2FzIGRvbmUgZm9yCmh3ZG9tIG9ubHkgd2l0aG91dCB0
aGlzIGFjdHVhbGx5IGhhdmluZyBiZWVuIHRoZSBjYXNlLiBIb3dldmVyLCB0
aGlzCmNvZGUgc2hvdWxkbid0IGJlIHRoZXJlIGluIHRoZSBmaXJzdCBwbGFj
ZSwgYXMgTU1JTyBlbnRyaWVzIHNob3VsZG4ndCBiZQpkcm9wcGVkIHRoaXMg
d2F5LiBBdm9pZCB0cmlnZ2VyaW5nIHRoZSB3YXJuaW5nIGFnYWluIHRoYXQg
NDhkZmIyOTdhMjBhCnNpbGVuY2VkIGJ5IGFuIGFkanVzdG1lbnQgdG8geGVu
bWVtX2FkZF90b19waHlzbWFwX29uZSgpIGluc3RlYWQuCgpOb3RlIHRoYXQg
Z3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZCgpIGdldHMg
dGlnaHRlbmVkIGJleW9uZAp0aGUgaW1tZWRpYXRlIHB1cnBvc2Ugb2YgdGhp
cyBjaGFuZ2UuCgpOb3RlIGFsc28gdGhhdCBJIGRpZG4ndCBpbnNwZWN0IGNv
ZGUgd2hpY2ggaXNuJ3Qgc2VjdXJpdHkgc3VwcG9ydGVkLAplLmcuIHNoYXJp
bmcsIHBhZ2luZywgb3IgYWx0cDJtLgoKVGhpcyBpcyBDVkUtMjAyMS0yODY5
NCAvIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtNzk5LDcgKzc5
OSw4IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJt
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JmN1cl9vcmRlciwgTlVMTCk7CiAKICAgICAgICAgaWYgKCBwMm1faXNfdmFs
aWQodCkgJiYKLSAgICAgICAgICAgICAoIW1mbl92YWxpZChtZm4pIHx8ICFt
Zm5fZXEobWZuX2FkZChtZm4sIGkpLCBtZm5fcmV0dXJuKSkgKQorICAgICAg
ICAgICAgICghbWZuX3ZhbGlkKG1mbikgfHwgdCA9PSBwMm1fbW1pb19kaXJl
Y3QgfHwKKyAgICAgICAgICAgICAgIW1mbl9lcShtZm5fYWRkKG1mbiwgaSks
IG1mbl9yZXR1cm4pKSApCiAgICAgICAgICAgICByZXR1cm4gLUVJTFNFUTsK
IAogICAgICAgICBpICs9ICgxVUwgPDwgY3VyX29yZGVyKSAtCkBAIC04OTks
NyArOTAwLDcgQEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRv
bWFpbiAqZAogICAgIGlmICggcDJtX2lzX2ZvcmVpZ24odCkgKQogICAgICAg
ICByZXR1cm4gLUVJTlZBTDsKIAotICAgIGlmICggIW1mbl92YWxpZChtZm4p
ICkKKyAgICBpZiAoICFtZm5fdmFsaWQobWZuKSB8fCB0ID09IHAybV9tbWlv
X2RpcmVjdCApCiAgICAgewogICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUo
KTsKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CkBAIC05NDMsNyArOTQ0LDcg
QEAgZ3Vlc3RfcGh5c21hcF9hZGRfZW50cnkoc3RydWN0IGRvbWFpbiAqZAog
ICAgICAgICB9CiAgICAgICAgIGlmICggcDJtX2lzX3NwZWNpYWwob3QpICkK
ICAgICAgICAgewotICAgICAgICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFw
cGluZyBncmFudC9mb3JlaWduIHRoaXMgd2F5LiAqLworICAgICAgICAgICAg
LyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9mb3JlaWduL2RpcmVj
dC1NTUlPIHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2NyYXNo
KGQpOwogICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAgICAg
ICAgCkBAIC0xMzk5LDggKzE0MDAsOCBAQCBpbnQgc2V0X2lkZW50aXR5X3Ay
bV9lbnRyeShzdHJ1Y3QgZG9tYWluCiAgKiAgICBvcmRlcisxICBmb3IgY2Fs
bGVyIHRvIHJldHJ5IHdpdGggb3JkZXIgKGd1YXJhbnRlZWQgc21hbGxlciB0
aGFuCiAgKiAgICAgICAgICAgICB0aGUgb3JkZXIgdmFsdWUgcGFzc2VkIGlu
KQogICovCi1pbnQgY2xlYXJfbW1pb19wMm1fZW50cnkoc3RydWN0IGRvbWFp
biAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwgbWZuX3QgbWZuLAotICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBvcmRlcikKK3N0YXRp
YyBpbnQgY2xlYXJfbW1pb19wMm1fZW50cnkoc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgbG9uZyBnZm5fbCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbWZuX3QgbWZuLCB1bnNpZ25lZCBpbnQgb3JkZXIpCiB7CiAg
ICAgaW50IHJjID0gLUVJTlZBTDsKICAgICBnZm5fdCBnZm4gPSBfZ2ZuKGdm
bl9sKTsKQEAgLTI3MzEsNyArMjczMiw5IEBAIGludCB4ZW5tZW1fYWRkX3Rv
X3BoeXNtYXBfb25lKAogCiAgICAgLyogUmVtb3ZlIHByZXZpb3VzbHkgbWFw
cGVkIHBhZ2UgaWYgaXQgd2FzIHByZXNlbnQuICovCiAgICAgcHJldl9tZm4g
PSBnZXRfZ2ZuKGQsIGdmbl94KGdwZm4pLCAmcDJtdCk7Ci0gICAgaWYgKCBt
Zm5fdmFsaWQocHJldl9tZm4pICkKKyAgICBpZiAoIHAybXQgPT0gcDJtX21t
aW9fZGlyZWN0ICkKKyAgICAgICAgcmMgPSAtRVBFUk07CisgICAgZWxzZSBp
ZiAoIG1mbl92YWxpZChwcmV2X21mbikgKQogICAgIHsKICAgICAgICAgaWYg
KCBpc19zcGVjaWFsX3BhZ2UobWZuX3RvX3BhZ2UocHJldl9tZm4pKSApCiAg
ICAgICAgICAgICAvKiBTcGVjaWFsIHBhZ2VzIGFyZSBzaW1wbHkgdW5ob29r
ZWQgZnJvbSB0aGlzIHBoeXMgc2xvdC4gKi8KLS0tIGEveGVuL2FyY2gveDg2
L21tL3AybS1wb2QuYworKysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5j
CkBAIC0xMjk5LDE3ICsxMjk5LDE3IEBAIGd1ZXN0X3BoeXNtYXBfbWFya19w
b3B1bGF0ZV9vbl9kZW1hbmQoc3QKIAogICAgICAgICBwMm0tPmdldF9lbnRy
eShwMm0sIGdmbl9hZGQoZ2ZuLCBpKSwgJm90LCAmYSwgMCwgJmN1cl9vcmRl
ciwgTlVMTCk7CiAgICAgICAgIG4gPSAxVUwgPDwgbWluKG9yZGVyLCBjdXJf
b3JkZXIpOwotICAgICAgICBpZiAoIHAybV9pc19yYW0ob3QpICkKKyAgICAg
ICAgaWYgKCBvdCA9PSBwMm1fcG9wdWxhdGVfb25fZGVtYW5kICkKKyAgICAg
ICAgeworICAgICAgICAgICAgLyogQ291bnQgaG93IG1hbnkgUG9EIGVudHJp
ZXMgd2UnbGwgYmUgcmVwbGFjaW5nIGlmIHN1Y2Nlc3NmdWwgKi8KKyAgICAg
ICAgICAgIHBvZF9jb3VudCArPSBuOworICAgICAgICB9CisgICAgICAgIGVs
c2UgaWYgKCBvdCAhPSBwMm1faW52YWxpZCAmJiBvdCAhPSBwMm1fbW1pb19k
bSApCiAgICAgICAgIHsKICAgICAgICAgICAgIFAyTV9ERUJVRygiZ2ZuX3Rv
X21mbiByZXR1cm5lZCB0eXBlICVkIVxuIiwgb3QpOwogICAgICAgICAgICAg
cmMgPSAtRUJVU1k7CiAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAg
fQotICAgICAgICBlbHNlIGlmICggb3QgPT0gcDJtX3BvcHVsYXRlX29uX2Rl
bWFuZCApCi0gICAgICAgIHsKLSAgICAgICAgICAgIC8qIENvdW50IGhvdyBt
YW4gUG9EIGVudHJpZXMgd2UnbGwgYmUgcmVwbGFjaW5nIGlmIHN1Y2Nlc3Nm
dWwgKi8KLSAgICAgICAgICAgIHBvZF9jb3VudCArPSBuOwotICAgICAgICB9
CiAgICAgfQogCiAgICAgLyogTm93LCBhY3R1YWxseSBkbyB0aGUgdHdvLXdh
eSBtYXBwaW5nICovCi0tLSBhL3hlbi9jb21tb24vbWVtb3J5LmMKKysrIGIv
eGVuL2NvbW1vbi9tZW1vcnkuYwpAQCAtMzMwLDcgKzMzMCw3IEBAIGludCBn
dWVzdF9yZW1vdmVfcGFnZShzdHJ1Y3QgZG9tYWluICpkLAogICAgIH0KICAg
ICBpZiAoIHAybXQgPT0gcDJtX21taW9fZGlyZWN0ICkKICAgICB7Ci0gICAg
ICAgIHJjID0gY2xlYXJfbW1pb19wMm1fZW50cnkoZCwgZ21mbiwgbWZuLCBQ
QUdFX09SREVSXzRLKTsKKyAgICAgICAgcmMgPSAtRVBFUk07CiAgICAgICAg
IGdvdG8gb3V0X3B1dF9nZm47CiAgICAgfQogI2Vsc2UKQEAgLTE4NzUsNiAr
MTg3NSwxNSBAQCBpbnQgY2hlY2tfZ2V0X3BhZ2VfZnJvbV9nZm4oc3RydWN0
IGRvbWFpCiAgICAgICAgIHJldHVybiAtRUFHQUlOOwogICAgIH0KICNlbmRp
ZgorI2lmZGVmIENPTkZJR19YODYKKyAgICBpZiAoIHAybXQgPT0gcDJtX21t
aW9fZGlyZWN0ICkKKyAgICB7CisgICAgICAgIGlmICggcGFnZSApCisgICAg
ICAgICAgICBwdXRfcGFnZShwYWdlKTsKKworICAgICAgICByZXR1cm4gLUVQ
RVJNOworICAgIH0KKyNlbmRpZgogCiAgICAgaWYgKCAhcGFnZSApCiAgICAg
ICAgIHJldHVybiAtRUlOVkFMOwotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2
L3AybS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKQEAgLTE1
MSw3ICsxNTEsOCBAQCB0eXBlZGVmIHVuc2lnbmVkIGludCBwMm1fcXVlcnlf
dDsKIAogLyogVHlwZXMgZXN0YWJsaXNoZWQvY2xlYW5lZCB1cCB2aWEgc3Bl
Y2lhbCBhY2Nlc3NvcnMuICovCiAjZGVmaW5lIFAyTV9TUEVDSUFMX1RZUEVT
IChQMk1fR1JBTlRfVFlQRVMgfCBcCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICBwMm1fdG9fbWFzayhwMm1fbWFwX2ZvcmVpZ24pKQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWdu
KSB8IFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV90b19tYXNr
KHAybV9tbWlvX2RpcmVjdCkpCiAKIC8qIFZhbGlkIHR5cGVzIG5vdCBuZWNl
c3NhcmlseSBhc3NvY2lhdGVkIHdpdGggYSAodmFsaWQpIE1GTi4gKi8KICNk
ZWZpbmUgUDJNX0lOVkFMSURfTUZOX1RZUEVTIChQMk1fUE9EX1RZUEVTICAg
ICAgICAgICAgICAgICAgXApAQCAtNjY2LDggKzY2Nyw2IEBAIGludCBwMm1f
aXNfbG9nZGlydHlfcmFuZ2Uoc3RydWN0IHAybV9kb20KIC8qIFNldCBtbWlv
IGFkZHJlc3NlcyBpbiB0aGUgcDJtIHRhYmxlIChmb3IgcGFzcy10aHJvdWdo
KSAqLwogaW50IHNldF9tbWlvX3AybV9lbnRyeShzdHJ1Y3QgZG9tYWluICpk
LCBnZm5fdCBnZm4sIG1mbl90IG1mbiwKICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IG9yZGVyKTsKLWludCBjbGVhcl9tbWlvX3AybV9l
bnRyeShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbiwgbWZu
X3QgbWZuLAotICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBvcmRlcik7CiAKIC8qIFNldCBpZGVudGl0eSBhZGRyZXNzZXMgaW4gdGhl
IHAybSB0YWJsZSAoZm9yIHBhc3MtdGhyb3VnaCkgKi8KIGludCBzZXRfaWRl
bnRpdHlfcDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxv
bmcgZ2ZuLAo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-4.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBJT01NVTogZ2VuZXJhbGl6ZSBWVC1kJ3MgdHJhY2tpbmcgb2YgbWFwcGVk
IFJNUlIgcmVnaW9ucwoKSW4gb3JkZXIgdG8gcmUtdXNlIGl0IGVsc2V3aGVy
ZSwgbW92ZSB0aGUgbG9naWMgdG8gdmVuZG9yIGluZGVwZW5kZW50CmNvZGUg
YW5kIHN0cmlwIGl0IG9mIFJNUlIgc3BlY2lmaWNzLgoKTm90ZSB0aGF0IHRo
ZSBwcmlvciAibWFwIiBwYXJhbWV0ZXIgZ2V0cyBmb2xkZWQgaW50byB0aGUg
bmV3ICJwMm1hIiBvbmUKKHdoaWNoIEFNRCBJT01NVSBjb2RlIHdpbGwgd2Fu
dCB0byBtYWtlIHVzZSBvZiksIGFzc2lnbmluZyBhbHRlcm5hdGl2ZQptZWFu
aW5nICgidW5tYXAiKSB0byBwMm1fYWNjZXNzX3guIFByZXBhcmUgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpIGFuZApwMm1fZ2V0X2lvbW11X2ZsYWdzKCkg
Zm9yIGdldHRpbmcgcGFzc2VkIGFjY2VzcyB0eXBlcyBvdGhlciB0aGFuCnAy
bV9hY2Nlc3NfcncgKGluIHRoZSBsYXR0ZXIgY2FzZSBqdXN0IGZvciBwMm1f
bW1pb19kaXJlY3QgcmVxdWVzdHMpLgoKTm90ZSBhbHNvIHRoYXQsIHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUsIGFuIG92ZXJsYXAgY2hlY2sgZ2V0cyBhZGRl
ZCB0bwp0aGUgbWFpbiBsb29wIG9mIGlvbW11X2lkZW50aXR5X21hcHBpbmco
KS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMzc4LgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTog
UGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+Ci0tLQpUQkQ6IEluIHRoaXMg
Y29udGV4dCAodGhlIGxhdGVzdCkgSSBxdWVzdGlvbiB3aGV0aGVyIGl0IGlz
IGEgZ29vZCBpZGVhCiAgICAgZm9yIGNsZWFyX2lkZW50aXR5X3AybV9lbnRy
eSgpIHRvIHJldHVybiBzdWNjZXNzIHdoZW4gaXQgZGlkbid0CiAgICAgY2xl
YXIgdGhlIGVudHJ5IGJlY2F1c2Ugb2YgbWlzbWF0Y2hpbmcgdHlwZSBvciBN
Rk4uClRCRDogUXVlc3Rpb24gaXMgd2hldGhlciBwMm1fZ2V0X2lvbW11X2Zs
YWdzKCkgc2hvdWxkIGFwcGx5IHRoZSBhY2Nlc3MKICAgICByZXN0cmljdGlv
biBpbiBhbGwgY2FzZXMsIG5vdCBqdXN0IGZvciBwMm1fbW1pb19kaXJlY3Qu
ClRCRDogTmVpdGhlciBwb3NzaWJsZSBwbGFjZW1lbnQgb2YgcDJtX2FjY2Vz
c19yeDJydyBhbmQgcDJtX2FjY2Vzc19uMnJ3eAogICAgIGluIHAybV9hY2Nl
c3NfdG9faW9tbXVfZmxhZ3MoKSBsb29rcyBlbnRpcmVseSBjb3JyZWN0L3Nl
bnNpYmxlLgotLS0Kdjk6IFJlLWJhc2UuCnY3OiBzL3VuaXR5X21hcC9pZGVu
dGl0eV9tYXAvZy4gUmUtYmFzZS4KdjY6IFJlLWJhc2UuCnY1OiBOZXcuCgot
LS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2
L21tL3AybS5jCkBAIC0xNDI3LDcgKzE0MjcsNyBAQCBpbnQgc2V0X2lkZW50
aXR5X3AybV9lbnRyeShzdHJ1Y3QgZG9tYWluCiAgICAgICAgICAgICByZXR1
cm4gMDsKICAgICAgICAgcmV0dXJuIGlvbW11X2xlZ2FjeV9tYXAoZCwgX2Rm
bihnZm5fbCksIF9tZm4oZ2ZuX2wpLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAxdWwgPDwgUEFHRV9PUkRFUl80SywKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU9NTVVGX3JlYWRhYmxlIHwgSU9NTVVG
X3dyaXRhYmxlKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cDJtX2FjY2Vzc190b19pb21tdV9mbGFncyhwMm1hKSk7CiAjaWZkZWYgQ09O
RklHX0hWTQogICAgIH0KIAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC92dGQvaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92
dGQvaW9tbXUuYwpAQCAtNDUsMTIgKzQ1LDYgQEAKIC8qIGRvbV9pbyBpcyB1
c2VkIGFzIGEgc2VudGluZWwgZm9yIHF1YXJhbnRpbmVkIGRldmljZXMgKi8K
ICNkZWZpbmUgUVVBUkFOVElORV9TS0lQKGQpICgoZCkgPT0gZG9tX2lvICYm
ICFkb21faW9tbXUoZCktPmFyY2gudnRkLnBnZF9tYWRkcikKIAotc3RydWN0
IG1hcHBlZF9ybXJyIHsKLSAgICBzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7Ci0g
ICAgdTY0IGJhc2UsIGVuZDsKLSAgICB1bnNpZ25lZCBpbnQgY291bnQ7Ci19
OwotCiAvKiBQb3NzaWJsZSB1bmZpbHRlcmVkIExBUElDL01TSSBtZXNzYWdl
cyBmcm9tIHVudHJ1c3RlZCBzb3VyY2VzPyAqLwogYm9vbCBfX3JlYWRfbW9z
dGx5IHVudHJ1c3RlZF9tc2k7CiAKQEAgLTEzMDYsNyArMTMwMCw2IEBAIHN0
YXRpYyBpbnQgaW50ZWxfaW9tbXVfZG9tYWluX2luaXQoc3RydWMKICAgICBz
dHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRvbV9pb21tdShkKTsKIAogICAg
IGhkLT5hcmNoLnZ0ZC5hZ2F3ID0gd2lkdGhfdG9fYWdhdyhERUZBVUxUX0RP
TUFJTl9BRERSRVNTX1dJRFRIKTsKLSAgICBJTklUX0xJU1RfSEVBRCgmaGQt
PmFyY2gudnRkLm1hcHBlZF9ybXJycyk7CiAKICAgICByZXR1cm4gMDsKIH0K
QEAgLTE3ODUsMTcgKzE3NzgsMTIgQEAgc3RhdGljIHZvaWQgaW9tbXVfY2xl
YXJfcm9vdF9wZ3RhYmxlKHN0cgogc3RhdGljIHZvaWQgaW9tbXVfZG9tYWlu
X3RlYXJkb3duKHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAgc3RydWN0IGRv
bWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0gICAgc3RydWN0IG1h
cHBlZF9ybXJyICptcm1yciwgKnRtcDsKICAgICBjb25zdCBzdHJ1Y3QgYWNw
aV9kcmhkX3VuaXQgKmRyaGQ7CiAKICAgICBpZiAoIGxpc3RfZW1wdHkoJmFj
cGlfZHJoZF91bml0cykgKQogICAgICAgICByZXR1cm47CiAKLSAgICBsaXN0
X2Zvcl9lYWNoX2VudHJ5X3NhZmUgKCBtcm1yciwgdG1wLCAmaGQtPmFyY2gu
dnRkLm1hcHBlZF9ybXJycywgbGlzdCApCi0gICAgewotICAgICAgICBsaXN0
X2RlbCgmbXJtcnItPmxpc3QpOwotICAgICAgICB4ZnJlZShtcm1ycik7Ci0g
ICAgfQorICAgIGlvbW11X2lkZW50aXR5X21hcF90ZWFyZG93bihkKTsKIAog
ICAgIEFTU0VSVCghaGQtPmFyY2gudnRkLnBnZF9tYWRkcik7CiAKQEAgLTE5
NDMsNzQgKzE5MzEsNiBAQCBzdGF0aWMgaW50IF9faW5pdCB2dGRfZXB0X3Bh
Z2VfY29tcGF0aWJsCiAgICAgICAgICAgIChlcHRfaGFzXzFnYihlcHRfY2Fw
KSAmJiBvcHRfaGFwXzFnYikgPD0gY2FwX3Nwc18xZ2IodnRkX2NhcCk7CiB9
CiAKLXN0YXRpYyBpbnQgcm1ycl9pZGVudGl0eV9tYXBwaW5nKHN0cnVjdCBk
b21haW4gKmQsIGJvb2xfdCBtYXAsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBzdHJ1Y3QgYWNwaV9ybXJyX3VuaXQgKnJtcnIs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgZmxhZykK
LXsKLSAgICB1bnNpZ25lZCBsb25nIGJhc2VfcGZuID0gcm1yci0+YmFzZV9h
ZGRyZXNzID4+IFBBR0VfU0hJRlRfNEs7Ci0gICAgdW5zaWduZWQgbG9uZyBl
bmRfcGZuID0gUEFHRV9BTElHTl80SyhybXJyLT5lbmRfYWRkcmVzcykgPj4g
UEFHRV9TSElGVF80SzsKLSAgICBzdHJ1Y3QgbWFwcGVkX3JtcnIgKm1ybXJy
OwotICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQp
OwotCi0gICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOwotICAgIEFTU0VS
VChybXJyLT5iYXNlX2FkZHJlc3MgPCBybXJyLT5lbmRfYWRkcmVzcyk7Ci0K
LSAgICAvKgotICAgICAqIE5vIG5lZWQgdG8gYWNxdWlyZSBoZC0+YXJjaC5t
YXBwaW5nX2xvY2s6IEJvdGggaW5zZXJ0aW9uIGFuZCByZW1vdmFsCi0gICAg
ICogZ2V0IGRvbmUgd2hpbGUgaG9sZGluZyBwY2lkZXZzX2xvY2suCi0gICAg
ICovCi0gICAgbGlzdF9mb3JfZWFjaF9lbnRyeSggbXJtcnIsICZoZC0+YXJj
aC52dGQubWFwcGVkX3JtcnJzLCBsaXN0ICkKLSAgICB7Ci0gICAgICAgIGlm
ICggbXJtcnItPmJhc2UgPT0gcm1yci0+YmFzZV9hZGRyZXNzICYmCi0gICAg
ICAgICAgICAgbXJtcnItPmVuZCA9PSBybXJyLT5lbmRfYWRkcmVzcyApCi0g
ICAgICAgIHsKLSAgICAgICAgICAgIGludCByZXQgPSAwOwotCi0gICAgICAg
ICAgICBpZiAoIG1hcCApCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAg
ICAgKyttcm1yci0+Y291bnQ7Ci0gICAgICAgICAgICAgICAgcmV0dXJuIDA7
Ci0gICAgICAgICAgICB9Ci0KLSAgICAgICAgICAgIGlmICggLS1tcm1yci0+
Y291bnQgKQotICAgICAgICAgICAgICAgIHJldHVybiAwOwotCi0gICAgICAg
ICAgICB3aGlsZSAoIGJhc2VfcGZuIDwgZW5kX3BmbiApCi0gICAgICAgICAg
ICB7Ci0gICAgICAgICAgICAgICAgaWYgKCBjbGVhcl9pZGVudGl0eV9wMm1f
ZW50cnkoZCwgYmFzZV9wZm4pICkKLSAgICAgICAgICAgICAgICAgICAgcmV0
ID0gLUVOWElPOwotICAgICAgICAgICAgICAgIGJhc2VfcGZuKys7Ci0gICAg
ICAgICAgICB9Ci0KLSAgICAgICAgICAgIGxpc3RfZGVsKCZtcm1yci0+bGlz
dCk7Ci0gICAgICAgICAgICB4ZnJlZShtcm1ycik7Ci0gICAgICAgICAgICBy
ZXR1cm4gcmV0OwotICAgICAgICB9Ci0gICAgfQotCi0gICAgaWYgKCAhbWFw
ICkKLSAgICAgICAgcmV0dXJuIC1FTk9FTlQ7Ci0KLSAgICB3aGlsZSAoIGJh
c2VfcGZuIDwgZW5kX3BmbiApCi0gICAgewotICAgICAgICBpbnQgZXJyID0g
c2V0X2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3BmbiwgcDJtX2FjY2Vz
c19ydywgZmxhZyk7Ci0KLSAgICAgICAgaWYgKCBlcnIgKQotICAgICAgICAg
ICAgcmV0dXJuIGVycjsKLSAgICAgICAgYmFzZV9wZm4rKzsKLSAgICB9Ci0K
LSAgICBtcm1yciA9IHhtYWxsb2Moc3RydWN0IG1hcHBlZF9ybXJyKTsKLSAg
ICBpZiAoICFtcm1yciApCi0gICAgICAgIHJldHVybiAtRU5PTUVNOwotICAg
IG1ybXJyLT5iYXNlID0gcm1yci0+YmFzZV9hZGRyZXNzOwotICAgIG1ybXJy
LT5lbmQgPSBybXJyLT5lbmRfYWRkcmVzczsKLSAgICBtcm1yci0+Y291bnQg
PSAxOwotICAgIGxpc3RfYWRkX3RhaWwoJm1ybXJyLT5saXN0LCAmaGQtPmFy
Y2gudnRkLm1hcHBlZF9ybXJycyk7Ci0KLSAgICByZXR1cm4gMDsKLX0KLQog
c3RhdGljIGludCBpbnRlbF9pb21tdV9hZGRfZGV2aWNlKHU4IGRldmZuLCBz
dHJ1Y3QgcGNpX2RldiAqcGRldikKIHsKICAgICBzdHJ1Y3QgYWNwaV9ybXJy
X3VuaXQgKnJtcnI7CkBAIC0yMDQyLDcgKzE5NjIsOSBAQCBzdGF0aWMgaW50
IGludGVsX2lvbW11X2FkZF9kZXZpY2UodTggZGV2CiAgICAgICAgICAgICAg
KiBTaW5jZSBSTVJScyBhcmUgYWx3YXlzIHJlc2VydmVkIGluIHRoZSBlODIw
IG1hcCBmb3IgdGhlIGhhcmR3YXJlCiAgICAgICAgICAgICAgKiBkb21haW4s
IHRoZXJlIHNob3VsZG4ndCBiZSBhIGNvbmZsaWN0LgogICAgICAgICAgICAg
ICovCi0gICAgICAgICAgICByZXQgPSBybXJyX2lkZW50aXR5X21hcHBpbmco
cGRldi0+ZG9tYWluLCAxLCBybXJyLCAwKTsKKyAgICAgICAgICAgIHJldCA9
IGlvbW11X2lkZW50aXR5X21hcHBpbmcocGRldi0+ZG9tYWluLCBwMm1fYWNj
ZXNzX3J3LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBybXJyLT5iYXNlX2FkZHJlc3MsIHJtcnItPmVuZF9hZGRyZXNzLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwKTsK
ICAgICAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgICAgICBkcHJp
bnRrKFhFTkxPR19FUlIgVlREUFJFRklYLCAiZCVkOiBSTVJSIG1hcHBpbmcg
ZmFpbGVkXG4iLAogICAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+ZG9t
YWluLT5kb21haW5faWQpOwpAQCAtMjA4Nyw3ICsyMDA5LDggQEAgc3RhdGlj
IGludCBpbnRlbF9pb21tdV9yZW1vdmVfZGV2aWNlKHU4CiAgICAgICAgICAq
IEFueSBmbGFnIGlzIG5vdGhpbmcgdG8gY2xlYXIgdGhlc2UgbWFwcGluZ3Mg
YnV0IGhlcmUKICAgICAgICAgICogaXRzIGFsd2F5cyBzYWZlIGFuZCBzdHJp
Y3QgdG8gc2V0IDAuCiAgICAgICAgICAqLwotICAgICAgICBybXJyX2lkZW50
aXR5X21hcHBpbmcocGRldi0+ZG9tYWluLCAwLCBybXJyLCAwKTsKKyAgICAg
ICAgaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhwZGV2LT5kb21haW4sIHAybV9h
Y2Nlc3NfeCwgcm1yci0+YmFzZV9hZGRyZXNzLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJtcnItPmVuZF9hZGRyZXNzLCAwKTsKICAgICB9
CiAKICAgICByZXR1cm4gZG9tYWluX2NvbnRleHRfdW5tYXAocGRldi0+ZG9t
YWluLCBkZXZmbiwgcGRldik7CkBAIC0yMjg2LDcgKzIyMDksOCBAQCBzdGF0
aWMgdm9pZCBfX2h3ZG9tX2luaXQgc2V0dXBfaHdkb21fcm1yCiAgICAgICAg
ICAqIGRvbWFpbiwgdGhlcmUgc2hvdWxkbid0IGJlIGEgY29uZmxpY3QuIFNv
IGl0cyBhbHdheXMgc2FmZSBhbmQKICAgICAgICAgICogc3RyaWN0IHRvIHNl
dCAwLgogICAgICAgICAgKi8KLSAgICAgICAgcmV0ID0gcm1ycl9pZGVudGl0
eV9tYXBwaW5nKGQsIDEsIHJtcnIsIDApOworICAgICAgICByZXQgPSBpb21t
dV9pZGVudGl0eV9tYXBwaW5nKGQsIHAybV9hY2Nlc3NfcncsIHJtcnItPmJh
c2VfYWRkcmVzcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBybXJyLT5lbmRfYWRkcmVzcywgMCk7CiAgICAgICAgIGlmICggcmV0
ICkKICAgICAgICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiBWVERQUkVGSVgs
CiAgICAgICAgICAgICAgICAgICAgICAiSU9NTVU6IG1hcHBpbmcgcmVzZXJ2
ZWQgcmVnaW9uIGZhaWxlZFxuIik7CkBAIC0yNDY4LDcgKzIzOTIsOSBAQCBz
dGF0aWMgaW50IHJlYXNzaWduX2RldmljZV9vd25lcnNoaXAoCiAgICAgICAg
ICAgICAgICAgICogQW55IFJNUlIgZmxhZyBpcyBhbHdheXMgaWdub3JlZCB3
aGVuIHJlbW92ZSBhIGRldmljZSwKICAgICAgICAgICAgICAgICAgKiBidXQg
aXRzIGFsd2F5cyBzYWZlIGFuZCBzdHJpY3QgdG8gc2V0IDAuCiAgICAgICAg
ICAgICAgICAgICovCi0gICAgICAgICAgICAgICAgcmV0ID0gcm1ycl9pZGVu
dGl0eV9tYXBwaW5nKHNvdXJjZSwgMCwgcm1yciwgMCk7CisgICAgICAgICAg
ICAgICAgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhzb3VyY2UsIHAy
bV9hY2Nlc3NfeCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJtcnItPmJhc2VfYWRkcmVzcywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnItPmVuZF9h
ZGRyZXNzLCAwKTsKICAgICAgICAgICAgICAgICBpZiAoIHJldCAhPSAtRU5P
RU5UICkKICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAg
ICAgICAgIH0KQEAgLTI1NjQsNyArMjQ5MCw4IEBAIHN0YXRpYyBpbnQgaW50
ZWxfaW9tbXVfYXNzaWduX2RldmljZSgKICAgICAgICAgICAgICBQQ0lfQlVT
KGJkZikgPT0gYnVzICYmCiAgICAgICAgICAgICAgUENJX0RFVkZOMihiZGYp
ID09IGRldmZuICkKICAgICAgICAgewotICAgICAgICAgICAgcmV0ID0gcm1y
cl9pZGVudGl0eV9tYXBwaW5nKGQsIDEsIHJtcnIsIGZsYWcpOworICAgICAg
ICAgICAgcmV0ID0gaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhkLCBwMm1fYWNj
ZXNzX3J3LCBybXJyLT5iYXNlX2FkZHJlc3MsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJtcnItPmVuZF9hZGRyZXNzLCBm
bGFnKTsKICAgICAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgIHsK
ICAgICAgICAgICAgICAgICBpbnQgcmM7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3g4Ni9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL3g4Ni9pb21tdS5jCkBAIC0xNDQsNiArMTQ0LDcgQEAgaW50IGFy
Y2hfaW9tbXVfZG9tYWluX2luaXQoc3RydWN0IGRvbWFpbgogCiAgICAgSU5J
VF9QQUdFX0xJU1RfSEVBRCgmaGQtPmFyY2gucGd0YWJsZXMubGlzdCk7CiAg
ICAgc3Bpbl9sb2NrX2luaXQoJmhkLT5hcmNoLnBndGFibGVzLmxvY2spOwor
ICAgIElOSVRfTElTVF9IRUFEKCZoZC0+YXJjaC5pZGVudGl0eV9tYXBzKTsK
IAogICAgIHJldHVybiAwOwogfQpAQCAtMTU5LDYgKzE2MCw5OSBAQCB2b2lk
IGFyY2hfaW9tbXVfZG9tYWluX2Rlc3Ryb3koc3RydWN0IGRvCiAgICAgICAg
ICAgIHBhZ2VfbGlzdF9lbXB0eSgmZG9tX2lvbW11KGQpLT5hcmNoLnBndGFi
bGVzLmxpc3QpKTsKIH0KIAorc3RydWN0IGlkZW50aXR5X21hcCB7CisgICAg
c3RydWN0IGxpc3RfaGVhZCBsaXN0OworICAgIHBhZGRyX3QgYmFzZSwgZW5k
OworICAgIHAybV9hY2Nlc3NfdCBhY2Nlc3M7CisgICAgdW5zaWduZWQgaW50
IGNvdW50OworfTsKKworaW50IGlvbW11X2lkZW50aXR5X21hcHBpbmcoc3Ry
dWN0IGRvbWFpbiAqZCwgcDJtX2FjY2Vzc190IHAybWEsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgZW5kLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWcp
Cit7CisgICAgdW5zaWduZWQgbG9uZyBiYXNlX3BmbiA9IGJhc2UgPj4gUEFH
RV9TSElGVF80SzsKKyAgICB1bnNpZ25lZCBsb25nIGVuZF9wZm4gPSBQQUdF
X0FMSUdOXzRLKGVuZCkgPj4gUEFHRV9TSElGVF80SzsKKyAgICBzdHJ1Y3Qg
aWRlbnRpdHlfbWFwICptYXA7CisgICAgc3RydWN0IGRvbWFpbl9pb21tdSAq
aGQgPSBkb21faW9tbXUoZCk7CisKKyAgICBBU1NFUlQocGNpZGV2c19sb2Nr
ZWQoKSk7CisgICAgQVNTRVJUKGJhc2UgPCBlbmQpOworCisgICAgLyoKKyAg
ICAgKiBObyBuZWVkIHRvIGFjcXVpcmUgaGQtPmFyY2gubWFwcGluZ19sb2Nr
OiBCb3RoIGluc2VydGlvbiBhbmQgcmVtb3ZhbAorICAgICAqIGdldCBkb25l
IHdoaWxlIGhvbGRpbmcgcGNpZGV2c19sb2NrLgorICAgICAqLworICAgIGxp
c3RfZm9yX2VhY2hfZW50cnkoIG1hcCwgJmhkLT5hcmNoLmlkZW50aXR5X21h
cHMsIGxpc3QgKQorICAgIHsKKyAgICAgICAgaWYgKCBtYXAtPmJhc2UgPT0g
YmFzZSAmJiBtYXAtPmVuZCA9PSBlbmQgKQorICAgICAgICB7CisgICAgICAg
ICAgICBpbnQgcmV0ID0gMDsKKworICAgICAgICAgICAgaWYgKCBwMm1hICE9
IHAybV9hY2Nlc3NfeCApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAg
ICAgaWYgKCBtYXAtPmFjY2VzcyAhPSBwMm1hICkKKyAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIC1FQUREUklOVVNFOworICAgICAgICAgICAgICAgICsr
bWFwLT5jb3VudDsKKyAgICAgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAg
ICAgICAgIH0KKworICAgICAgICAgICAgaWYgKCAtLW1hcC0+Y291bnQgKQor
ICAgICAgICAgICAgICAgIHJldHVybiAwOworCisgICAgICAgICAgICB3aGls
ZSAoIGJhc2VfcGZuIDwgZW5kX3BmbiApCisgICAgICAgICAgICB7CisgICAg
ICAgICAgICAgICAgaWYgKCBjbGVhcl9pZGVudGl0eV9wMm1fZW50cnkoZCwg
YmFzZV9wZm4pICkKKyAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVOWElP
OworICAgICAgICAgICAgICAgIGJhc2VfcGZuKys7CisgICAgICAgICAgICB9
CisKKyAgICAgICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3QpOworICAgICAg
ICAgICAgeGZyZWUobWFwKTsKKworICAgICAgICAgICAgcmV0dXJuIHJldDsK
KyAgICAgICAgfQorCisgICAgICAgIGlmICggZW5kID49IG1hcC0+YmFzZSAm
JiBtYXAtPmVuZCA+PSBiYXNlICkKKyAgICAgICAgICAgIHJldHVybiAtRUFE
RFJJTlVTRTsKKyAgICB9CisKKyAgICBpZiAoIHAybWEgPT0gcDJtX2FjY2Vz
c194ICkKKyAgICAgICAgcmV0dXJuIC1FTk9FTlQ7CisKKyAgICB3aGlsZSAo
IGJhc2VfcGZuIDwgZW5kX3BmbiApCisgICAgeworICAgICAgICBpbnQgZXJy
ID0gc2V0X2lkZW50aXR5X3AybV9lbnRyeShkLCBiYXNlX3BmbiwgcDJtYSwg
ZmxhZyk7CisKKyAgICAgICAgaWYgKCBlcnIgKQorICAgICAgICAgICAgcmV0
dXJuIGVycjsKKyAgICAgICAgYmFzZV9wZm4rKzsKKyAgICB9CisKKyAgICBt
YXAgPSB4bWFsbG9jKHN0cnVjdCBpZGVudGl0eV9tYXApOworICAgIGlmICgg
IW1hcCApCisgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgIG1hcC0+YmFz
ZSA9IGJhc2U7CisgICAgbWFwLT5lbmQgPSBlbmQ7CisgICAgbWFwLT5hY2Nl
c3MgPSBwMm1hOworICAgIG1hcC0+Y291bnQgPSAxOworICAgIGxpc3RfYWRk
X3RhaWwoJm1hcC0+bGlzdCwgJmhkLT5hcmNoLmlkZW50aXR5X21hcHMpOwor
CisgICAgcmV0dXJuIDA7Cit9CisKK3ZvaWQgaW9tbXVfaWRlbnRpdHlfbWFw
X3RlYXJkb3duKHN0cnVjdCBkb21haW4gKmQpCit7CisgICAgc3RydWN0IGRv
bWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7CisgICAgc3RydWN0IGlk
ZW50aXR5X21hcCAqbWFwLCAqdG1wOworCisgICAgbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlICggbWFwLCB0bXAsICZoZC0+YXJjaC5pZGVudGl0eV9tYXBz
LCBsaXN0ICkKKyAgICB7CisgICAgICAgIGxpc3RfZGVsKCZtYXAtPmxpc3Qp
OworICAgICAgICB4ZnJlZShtYXApOworICAgIH0KK30KKwogc3RhdGljIGJv
b2wgX19od2RvbV9pbml0IGh3ZG9tX2lvbW11X21hcChjb25zdCBzdHJ1Y3Qg
ZG9tYWluICpkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBtYXhfcGZu
KQotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11LmgKKysrIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9pb21tdS5oCkBAIC0xNiw2ICsxNiw3IEBACiAK
ICNpbmNsdWRlIDx4ZW4vZXJybm8uaD4KICNpbmNsdWRlIDx4ZW4vbGlzdC5o
PgorI2luY2x1ZGUgPHhlbi9tZW1fYWNjZXNzLmg+CiAjaW5jbHVkZSA8eGVu
L3NwaW5sb2NrLmg+CiAjaW5jbHVkZSA8YXNtL2FwaWNkZWYuaD4KICNpbmNs
dWRlIDxhc20vcHJvY2Vzc29yLmg+CkBAIC01MCwxMyArNTEsMTQgQEAgc3Ry
dWN0IGFyY2hfaW9tbXUKICAgICAgICAgc3BpbmxvY2tfdCBsb2NrOwogICAg
IH0gcGd0YWJsZXM7CiAKKyAgICBzdHJ1Y3QgbGlzdF9oZWFkIGlkZW50aXR5
X21hcHM7CisKICAgICB1bmlvbiB7CiAgICAgICAgIC8qIEludGVsIFZULWQg
Ki8KICAgICAgICAgc3RydWN0IHsKICAgICAgICAgICAgIHVpbnQ2NF90IHBn
ZF9tYWRkcjsgLyogaW8gcGFnZSBkaXJlY3RvcnkgbWFjaGluZSBhZGRyZXNz
ICovCiAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYWdhdzsgLyogYWRqdXN0
ZWQgZ3Vlc3QgYWRkcmVzcyB3aWR0aCwgMCBpcyBsZXZlbCAyIDMwLWJpdCAq
LwogICAgICAgICAgICAgdWludDY0X3QgaW9tbXVfYml0bWFwOyAvKiBiaXRt
YXAgb2YgaW9tbXUocykgdGhhdCB0aGUgZG9tYWluIHVzZXMgKi8KLSAgICAg
ICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgbWFwcGVkX3JtcnJzOwogICAgICAg
ICB9IHZ0ZDsKICAgICAgICAgLyogQU1EIElPTU1VICovCiAgICAgICAgIHN0
cnVjdCB7CkBAIC0xMjIsNiArMTI0LDExIEBAIHN0YXRpYyBpbmxpbmUgdm9p
ZCBpb21tdV9kaXNhYmxlX3gyYXBpYygKICAgICAgICAgaW9tbXVfb3BzLmRp
c2FibGVfeDJhcGljKCk7CiB9CiAKK2ludCBpb21tdV9pZGVudGl0eV9tYXBw
aW5nKHN0cnVjdCBkb21haW4gKmQsIHAybV9hY2Nlc3NfdCBwMm1hLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcGFkZHJfdCBiYXNlLCBwYWRkcl90
IGVuZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBmbGFnKTsKK3ZvaWQgaW9tbXVfaWRlbnRpdHlfbWFwX3RlYXJkb3duKHN0
cnVjdCBkb21haW4gKmQpOworCiBleHRlcm4gYm9vbCB1bnRydXN0ZWRfbXNp
OwogCiBpbnQgcGlfdXBkYXRlX2lydGUoY29uc3Qgc3RydWN0IHBpX2Rlc2Mg
KnBpX2Rlc2MsIGNvbnN0IHN0cnVjdCBwaXJxICpwaXJxLAotLS0gYS94ZW4v
aW5jbHVkZS9hc20teDg2L3AybS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvcDJtLmgKQEAgLTg4OCw2ICs4ODgsMzQgQEAgc3RydWN0IHAybV9kb21h
aW4gKnAybV9nZXRfYWx0cDJtKHN0cnVjdAogc3RhdGljIGlubGluZSB2b2lk
IHAybV9hbHRwMm1fY2hlY2soc3RydWN0IHZjcHUgKnYsIHVpbnQxNl90IGlk
eCkge30KICNlbmRpZgogCisvKiBwMm0gYWNjZXNzIHRvIElPTU1VIGZsYWdz
ICovCitzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBwMm1fYWNjZXNzX3Rv
X2lvbW11X2ZsYWdzKHAybV9hY2Nlc3NfdCBwMm1hKQoreworICAgIHN3aXRj
aCAoIHAybWEgKQorICAgIHsKKyAgICBjYXNlIHAybV9hY2Nlc3Nfcnc6Cisg
ICAgY2FzZSBwMm1fYWNjZXNzX3J3eDoKKyAgICAgICAgcmV0dXJuIElPTU1V
Rl9yZWFkYWJsZSB8IElPTU1VRl93cml0YWJsZTsKKworICAgIGNhc2UgcDJt
X2FjY2Vzc19yOgorICAgIGNhc2UgcDJtX2FjY2Vzc19yeDoKKyAgICBjYXNl
IHAybV9hY2Nlc3Nfcngycnc6CisgICAgICAgIHJldHVybiBJT01NVUZfcmVh
ZGFibGU7CisKKyAgICBjYXNlIHAybV9hY2Nlc3NfdzoKKyAgICBjYXNlIHAy
bV9hY2Nlc3Nfd3g6CisgICAgICAgIHJldHVybiBJT01NVUZfd3JpdGFibGU7
CisKKyAgICBjYXNlIHAybV9hY2Nlc3NfbjoKKyAgICBjYXNlIHAybV9hY2Nl
c3NfeDoKKyAgICBjYXNlIHAybV9hY2Nlc3NfbjJyd3g6CisgICAgICAgIHJl
dHVybiAwOworICAgIH0KKworICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOwor
ICAgIHJldHVybiAwOworfQorCiAvKgogICogcDJtIHR5cGUgdG8gSU9NTVUg
ZmxhZ3MKICAqLwpAQCAtOTA5LDkgKzkzNywxMCBAQCBzdGF0aWMgaW5saW5l
IHVuc2lnbmVkIGludCBwMm1fZ2V0X2lvbW11CiAgICAgICAgIGZsYWdzID0g
SU9NTVVGX3JlYWRhYmxlOwogICAgICAgICBicmVhazsKICAgICBjYXNlIHAy
bV9tbWlvX2RpcmVjdDoKLSAgICAgICAgZmxhZ3MgPSBJT01NVUZfcmVhZGFi
bGU7Ci0gICAgICAgIGlmICggIXJhbmdlc2V0X2NvbnRhaW5zX3NpbmdsZXRv
bihtbWlvX3JvX3JhbmdlcywgbWZuX3gobWZuKSkgKQotICAgICAgICAgICAg
ZmxhZ3MgfD0gSU9NTVVGX3dyaXRhYmxlOworICAgICAgICBmbGFncyA9IHAy
bV9hY2Nlc3NfdG9faW9tbXVfZmxhZ3MocDJtYSk7CisgICAgICAgIGlmICgg
KGZsYWdzICYgSU9NTVVGX3dyaXRhYmxlKSAmJgorICAgICAgICAgICAgIHJh
bmdlc2V0X2NvbnRhaW5zX3NpbmdsZXRvbihtbWlvX3JvX3JhbmdlcywgbWZu
X3gobWZuKSkgKQorICAgICAgICAgICAgZmxhZ3MgJj0gfklPTU1VRl93cml0
YWJsZTsKICAgICAgICAgYnJlYWs7CiAgICAgZGVmYXVsdDoKICAgICAgICAg
ZmxhZ3MgPSAwOwo=

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-5.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UvY29tcGxldGUgcmUtYXNzaWdubWVu
dCBoYW5kbGluZwoKUHJpb3IgdG8gdGhlIGFzc2lnbm1lbnQgc3RlcCBoYXZp
bmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgZGV2aWNlcwpzaG91bGQgbm90
IGdldCBhc3NvY2lhdGVkIHdpdGggdGhlaXIgbmV3IG93bmVyLiBIYW5kIHRo
ZSBkZXZpY2UgdG8gRG9tSU8KKHBlcmhhcHMgdGVtcG9yYXJpbHkpLCB1bnRp
bCBhZnRlciB0aGUgZGUtYXNzaWdubWVudCBzdGVwIGhhcyBjb21wbGV0ZWQu
CgpEZS1hc3NpZ25tZW50IG9mIGEgZGV2aWNlIChmcm9tIG90aGVyIHRoYW4g
RG9tMCkgYXMgd2VsbCBhcyBmYWlsdXJlIG9mCnJlYXNzaWduX2RldmljZSgp
IGR1cmluZyBhc3NpZ25tZW50IHNob3VsZCByZXN1bHQgaW4gdW5pdHkgbWFw
cGluZ3MKZ2V0dGluZyB0b3JuIGRvd24uIFRoaXMgaW4gdHVybiByZXF1aXJl
cyBzd2l0Y2hpbmcgdG8gYSByZWZjb3VudGVkCm1hcHBpbmcgYXBwcm9hY2gs
IGFzIHdhcyBhbHJlYWR5IHVzZWQgYnkgVlQtZCBmb3IgaXRzIFJNUlJzLCB0
byBwcmV2ZW50CnVubWFwcGluZyBhIHJlZ2lvbiB1c2VkIGJ5IG11bHRpcGxl
IGRldmljZXMuCgpUaGlzIGlzIENWRS0yMDIxLTI4Njk2IC8gcGFydCBvZiBY
U0EtMzc4LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNo
QHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhl
bi5vcmc+Ci0tLQp2OTogUmUtYmFzZS4Kdjc6IFJlLWJhc2UuCnY2OiBSZS1i
YXNlLgp2NTogU3dpdGNoIHRvIHVzaW5nIGlvbW11X2lkZW50aXR5X21hcHBp
bmcoKS4gQWxzbyB1bm1hcCgpIHdoZW4gYW55CiAgICBtYXAoKSBmYWlscyBp
biBhbWRfaW9tbXVfYXNzaWduX2RldmljZSgpLCB1bmxlc3MgaXQncyBEb20w
LiBSZS1iYXNlLgp2NDogVXNlIGRhZGRyX3RvX2RmbigpLiBEcm9wIHN0cmF5
IGJsYW5rIGxpbmUuIERvbid0IGV2ZXIgdW5tYXAgZnJvbQogICAgRG9tMC4K
djM6IFVzZSBEb21JTyBpbnN0ZWFkIG9mIERvbVhFTi4KdjI6IFJlLWJhc2Ug
b3ZlciBYU0EtMzAyLgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11LmgKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11LmgKQEAgLTIzMiw4ICsyMzIsMTAgQEAgaW50IF9fbXVzdF9jaGVj
ayBhbWRfaW9tbXVfdW5tYXBfcGFnZShzdAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmZsdXNoX2ZsYWdz
KTsKIGludCBfX211c3RfY2hlY2sgYW1kX2lvbW11X2FsbG9jX3Jvb3Qoc3Ry
dWN0IGRvbWFpbiAqZCk7CiBpbnQgYW1kX2lvbW11X3Jlc2VydmVfZG9tYWlu
X3VuaXR5X21hcChzdHJ1Y3QgZG9tYWluICpkb21haW4sCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90IHBoeXNfYWRk
ciwgdW5zaWduZWQgbG9uZyBzaXplLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaW50IGl3LCBpbnQgaXIpOworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGl2
cnNfdW5pdHlfbWFwICptYXAsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZyk7CitpbnQgYW1kX2lv
bW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X3VubWFwKHN0cnVjdCBkb21haW4g
KmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqbWFwKTsKIGludCBfX211
c3RfY2hlY2sgYW1kX2lvbW11X2ZsdXNoX2lvdGxiX3BhZ2VzKHN0cnVjdCBk
b21haW4gKmQsIGRmbl90IGRmbiwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcGFnZV9jb3Vu
dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBmbHVzaF9mbGFncyk7Ci0tLSBhL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYworKysgYi94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKQEAgLTQxOSwzOCAr
NDE5LDQ5IEBAIGludCBhbWRfaW9tbXVfZmx1c2hfaW90bGJfYWxsKHN0cnVj
dCBkb20KICAgICByZXR1cm4gMDsKIH0KIAotaW50IGFtZF9pb21tdV9yZXNl
cnZlX2RvbWFpbl91bml0eV9tYXAoc3RydWN0IGRvbWFpbiAqZG9tYWluLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZHJf
dCBwaHlzX2FkZHIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nIHNpemUsIGludCBpdywgaW50IGlyKQor
aW50IGFtZF9pb21tdV9yZXNlcnZlX2RvbWFpbl91bml0eV9tYXAoc3RydWN0
IGRvbWFpbiAqZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqbWFwLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IGZsYWcpCiB7Ci0gICAgdW5zaWduZWQgbG9uZyBucGFnZXMsIGk7Ci0g
ICAgdW5zaWduZWQgbG9uZyBnZm47Ci0gICAgdW5zaWduZWQgaW50IGZsYWdz
ID0gISFpcjsKLSAgICB1bnNpZ25lZCBpbnQgZmx1c2hfZmxhZ3MgPSAwOwot
ICAgIGludCBydCA9IDA7Ci0KLSAgICBpZiAoIGl3ICkKLSAgICAgICAgZmxh
Z3MgfD0gSU9NTVVGX3dyaXRhYmxlOwotCi0gICAgbnBhZ2VzID0gcmVnaW9u
X3RvX3BhZ2VzKHBoeXNfYWRkciwgc2l6ZSk7Ci0gICAgZ2ZuID0gcGh5c19h
ZGRyID4+IFBBR0VfU0hJRlQ7Ci0gICAgZm9yICggaSA9IDA7IGkgPCBucGFn
ZXM7IGkrKyApCisgICAgaW50IHJjOworCisgICAgaWYgKCBkID09IGRvbV9p
byApCisgICAgICAgIHJldHVybiAwOworCisgICAgZm9yICggcmMgPSAwOyAh
cmMgJiYgbWFwOyBtYXAgPSBtYXAtPm5leHQgKQogICAgIHsKLSAgICAgICAg
dW5zaWduZWQgbG9uZyBmcmFtZSA9IGdmbiArIGk7CisgICAgICAgIHAybV9h
Y2Nlc3NfdCBwMm1hID0gcDJtX2FjY2Vzc19uOworCisgICAgICAgIGlmICgg
bWFwLT5yZWFkICkKKyAgICAgICAgICAgIHAybWEgfD0gcDJtX2FjY2Vzc19y
OworICAgICAgICBpZiAoIG1hcC0+d3JpdGUgKQorICAgICAgICAgICAgcDJt
YSB8PSBwMm1fYWNjZXNzX3c7CiAKLSAgICAgICAgcnQgPSBhbWRfaW9tbXVf
bWFwX3BhZ2UoZG9tYWluLCBfZGZuKGZyYW1lKSwgX21mbihmcmFtZSksIGZs
YWdzLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZmx1c2hf
ZmxhZ3MpOwotICAgICAgICBpZiAoIHJ0ICE9IDAgKQotICAgICAgICAgICAg
YnJlYWs7CisgICAgICAgIHJjID0gaW9tbXVfaWRlbnRpdHlfbWFwcGluZyhk
LCBwMm1hLCBtYXAtPmFkZHIsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBtYXAtPmFkZHIgKyBtYXAtPmxlbmd0aCAtIDEsIGZsYWcp
OwogICAgIH0KIAotICAgIC8qIFVzZSB3aGlsZS1icmVhayB0byBhdm9pZCBj
b21waWxlciB3YXJuaW5nICovCi0gICAgd2hpbGUgKCBmbHVzaF9mbGFncyAm
JgotICAgICAgICAgICAgYW1kX2lvbW11X2ZsdXNoX2lvdGxiX3BhZ2VzKGRv
bWFpbiwgX2RmbihnZm4pLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG5wYWdlcywgZmx1c2hfZmxhZ3MpICkKLSAgICAgICAg
YnJlYWs7CisgICAgcmV0dXJuIHJjOworfQorCitpbnQgYW1kX2lvbW11X3Jl
c2VydmVfZG9tYWluX3VuaXR5X3VubWFwKHN0cnVjdCBkb21haW4gKmQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBpdnJzX3VuaXR5X21hcCAqbWFwKQoreworICAgIGludCByYzsK
KworICAgIGlmICggZCA9PSBkb21faW8gKQorICAgICAgICByZXR1cm4gMDsK
KworICAgIGZvciAoIHJjID0gMDsgbWFwOyBtYXAgPSBtYXAtPm5leHQgKQor
ICAgIHsKKyAgICAgICAgaW50IHJldCA9IGlvbW11X2lkZW50aXR5X21hcHBp
bmcoZCwgcDJtX2FjY2Vzc194LCBtYXAtPmFkZHIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcC0+YWRkciArIG1hcC0+
bGVuZ3RoIC0gMSwgMCk7CisKKyAgICAgICAgaWYgKCByZXQgJiYgcmV0ICE9
IC1FTk9FTlQgJiYgIXJjICkKKyAgICAgICAgICAgIHJjID0gcmV0OworICAg
IH0KIAotICAgIHJldHVybiBydDsKKyAgICByZXR1cm4gcmM7CiB9CiAKIGlu
dCBfX2luaXQgYW1kX2lvbW11X3F1YXJhbnRpbmVfaW5pdChzdHJ1Y3QgZG9t
YWluICpkKQotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNp
X2FtZF9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9wY2lfYW1kX2lvbW11LmMKQEAgLTM0Nyw2ICszNDcsNyBAQCBzdGF0aWMg
aW50IHJlYXNzaWduX2RldmljZShzdHJ1Y3QgZG9tYWluCiB7CiAgICAgc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXU7CiAgICAgaW50IGJkZiwgcmM7CisgICAg
Y29uc3Qgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3MgPSBn
ZXRfaXZyc19tYXBwaW5ncyhwZGV2LT5zZWcpOwogCiAgICAgYmRmID0gUENJ
X0JERjIocGRldi0+YnVzLCBwZGV2LT5kZXZmbik7CiAgICAgaW9tbXUgPSBm
aW5kX2lvbW11X2Zvcl9kZXZpY2UocGRldi0+c2VnLCBiZGYpOwpAQCAtMzYx
LDEwICszNjIsMjQgQEAgc3RhdGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3Ry
dWN0IGRvbWFpbgogCiAgICAgYW1kX2lvbW11X2Rpc2FibGVfZG9tYWluX2Rl
dmljZShzb3VyY2UsIGlvbW11LCBkZXZmbiwgcGRldik7CiAKLSAgICBpZiAo
IGRldmZuID09IHBkZXYtPmRldmZuICkKKyAgICAvKgorICAgICAqIElmIHRo
ZSBkZXZpY2UgYmVsb25ncyB0byB0aGUgaGFyZHdhcmUgZG9tYWluLCBhbmQg
aXQgaGFzIGEgdW5pdHkgbWFwcGluZywKKyAgICAgKiBkb24ndCByZW1vdmUg
aXQgZnJvbSB0aGUgaGFyZHdhcmUgZG9tYWluLCBiZWNhdXNlIEJJT1MgbWF5
IHJlZmVyZW5jZSB0aGF0CisgICAgICogbWFwcGluZy4KKyAgICAgKi8KKyAg
ICBpZiAoICFpc19oYXJkd2FyZV9kb21haW4oc291cmNlKSApCiAgICAgewot
ICAgICAgICBsaXN0X21vdmUoJnBkZXYtPmRvbWFpbl9saXN0LCAmdGFyZ2V0
LT5wZGV2X2xpc3QpOwotICAgICAgICBwZGV2LT5kb21haW4gPSB0YXJnZXQ7
CisgICAgICAgIHJjID0gYW1kX2lvbW11X3Jlc2VydmVfZG9tYWluX3VuaXR5
X3VubWFwKAorICAgICAgICAgICAgICAgICBzb3VyY2UsCisgICAgICAgICAg
ICAgICAgIGl2cnNfbWFwcGluZ3NbZ2V0X2RtYV9yZXF1ZXN0b3JfaWQocGRl
di0+c2VnLCBiZGYpXS51bml0eV9tYXApOworICAgICAgICBpZiAoIHJjICkK
KyAgICAgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBpZiAoIGRl
dmZuID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRvbWFpbiAhPSBkb21faW8g
KQorICAgIHsKKyAgICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21haW5fbGlz
dCwgJmRvbV9pby0+cGRldl9saXN0KTsKKyAgICAgICAgcGRldi0+ZG9tYWlu
ID0gZG9tX2lvOwogICAgIH0KIAogICAgIHJjID0gYW1kX2lvbW11X3NldHVw
X2RvbWFpbl9kZXZpY2UodGFyZ2V0LCBpb21tdSwgZGV2Zm4sIHBkZXYpOwpA
QCAtMzc0LDYgKzM4OSwxMiBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2Rldmlj
ZShzdHJ1Y3QgZG9tYWluCiAgICAgQU1EX0lPTU1VX0RFQlVHKCJSZS1hc3Np
Z24gJXBwIGZyb20gZG9tJWQgdG8gZG9tJWRcbiIsCiAgICAgICAgICAgICAg
ICAgICAgICZwZGV2LT5zYmRmLCBzb3VyY2UtPmRvbWFpbl9pZCwgdGFyZ2V0
LT5kb21haW5faWQpOwogCisgICAgaWYgKCBkZXZmbiA9PSBwZGV2LT5kZXZm
biAmJiBwZGV2LT5kb21haW4gIT0gdGFyZ2V0ICkKKyAgICB7CisgICAgICAg
IGxpc3RfbW92ZSgmcGRldi0+ZG9tYWluX2xpc3QsICZ0YXJnZXQtPnBkZXZf
bGlzdCk7CisgICAgICAgIHBkZXYtPmRvbWFpbiA9IHRhcmdldDsKKyAgICB9
CisKICAgICByZXR1cm4gMDsKIH0KIApAQCAtMzg0LDIwICs0MDUsMjggQEAg
c3RhdGljIGludCBhbWRfaW9tbXVfYXNzaWduX2RldmljZShzdHJ1YwogICAg
IHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX21hcHBpbmdzID0gZ2V0X2l2
cnNfbWFwcGluZ3MocGRldi0+c2VnKTsKICAgICBpbnQgYmRmID0gUENJX0JE
RjIocGRldi0+YnVzLCBkZXZmbik7CiAgICAgaW50IHJlcV9pZCA9IGdldF9k
bWFfcmVxdWVzdG9yX2lkKHBkZXYtPnNlZywgYmRmKTsKLSAgICBjb25zdCBz
dHJ1Y3QgaXZyc191bml0eV9tYXAgKnVuaXR5X21hcDsKKyAgICBpbnQgcmMg
PSBhbWRfaW9tbXVfcmVzZXJ2ZV9kb21haW5fdW5pdHlfbWFwKAorICAgICAg
ICAgICAgICAgICBkLCBpdnJzX21hcHBpbmdzW3JlcV9pZF0udW5pdHlfbWFw
LCBmbGFnKTsKIAotICAgIGZvciAoIHVuaXR5X21hcCA9IGl2cnNfbWFwcGlu
Z3NbcmVxX2lkXS51bml0eV9tYXA7IHVuaXR5X21hcDsKLSAgICAgICAgICB1
bml0eV9tYXAgPSB1bml0eV9tYXAtPm5leHQgKQorICAgIGlmICggIXJjICkK
KyAgICAgICAgcmMgPSByZWFzc2lnbl9kZXZpY2UocGRldi0+ZG9tYWluLCBk
LCBkZXZmbiwgcGRldik7CisKKyAgICBpZiAoIHJjICYmICFpc19oYXJkd2Fy
ZV9kb21haW4oZCkgKQogICAgIHsKLSAgICAgICAgaW50IHJjID0gYW1kX2lv
bW11X3Jlc2VydmVfZG9tYWluX3VuaXR5X21hcCgKLSAgICAgICAgICAgICAg
ICAgICAgIGQsIHVuaXR5X21hcC0+YWRkciwgdW5pdHlfbWFwLT5sZW5ndGgs
Ci0gICAgICAgICAgICAgICAgICAgICB1bml0eV9tYXAtPndyaXRlLCB1bml0
eV9tYXAtPnJlYWQpOworICAgICAgICBpbnQgcmV0ID0gYW1kX2lvbW11X3Jl
c2VydmVfZG9tYWluX3VuaXR5X3VubWFwKAorICAgICAgICAgICAgICAgICAg
ICAgIGQsIGl2cnNfbWFwcGluZ3NbcmVxX2lkXS51bml0eV9tYXApOwogCi0g
ICAgICAgIGlmICggcmMgKQotICAgICAgICAgICAgcmV0dXJuIHJjOworICAg
ICAgICBpZiAoIHJldCApCisgICAgICAgIHsKKyAgICAgICAgICAgIHByaW50
ayhYRU5MT0dfRVJSICJBTUQtVmk6ICIKKyAgICAgICAgICAgICAgICAgICAi
dW5pdHktdW5tYXAgZm9yICVwZC8lMDR4OiUwMng6JTAyeC4ldSBmYWlsZWQg
KCVkKVxuIiwKKyAgICAgICAgICAgICAgICAgICBkLCBwZGV2LT5zZWcsIHBk
ZXYtPmJ1cywKKyAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChkZXZmbiks
IFBDSV9GVU5DKGRldmZuKSwgcmV0KTsKKyAgICAgICAgICAgIGRvbWFpbl9j
cmFzaChkKTsKKyAgICAgICAgfQogICAgIH0KIAotICAgIHJldHVybiByZWFz
c2lnbl9kZXZpY2UocGRldi0+ZG9tYWluLCBkLCBkZXZmbiwgcGRldik7Cisg
ICAgcmV0dXJuIHJjOwogfQogCiBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfY2xl
YXJfcm9vdF9wZ3RhYmxlKHN0cnVjdCBkb21haW4gKmQpCkBAIC00MTEsNiAr
NDQwLDcgQEAgc3RhdGljIHZvaWQgYW1kX2lvbW11X2NsZWFyX3Jvb3RfcGd0
YWJsZQogCiBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfZG9tYWluX2Rlc3Ryb3ko
c3RydWN0IGRvbWFpbiAqZCkKIHsKKyAgICBpb21tdV9pZGVudGl0eV9tYXBf
dGVhcmRvd24oZCk7CiAgICAgQVNTRVJUKCFkb21faW9tbXUoZCktPmFyY2gu
YW1kLnJvb3RfdGFibGUpOwogfQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-6.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-6.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHJlLWFycmFuZ2UgZXhjbHVzaW9uIHJhbmdlIGFuZCB1
bml0eSBtYXAgcmVjb3JkaW5nCgpUaGUgc3BlYyBtYWtlcyBubyBwcm92aXNp
b25zIGZvciBPUyBiZWhhdmlvciBoZXJlIHRvIGRlcGVuZCBvbiB0aGUKYW1v
dW50IG9mIFJBTSBmb3VuZCBvbiB0aGUgc3lzdGVtLiBXaGlsZSB0aGUgc3Bl
YyBtYXkgbm90IHN1ZmZpY2llbnRseQpjbGVhcmx5IGRpc3Rpbmd1aXNoIGJv
dGgga2luZHMgb2YgcmVnaW9ucywgdGhleSBhcmUgc3VyZWx5IG1lYW50IHRv
IGJlCnNlcGFyYXRlIHRoaW5nczogT25seSByZWdpb25zIHdpdGggQUNQSV9J
Vk1EX0VYQ0xVU0lPTl9SQU5HRSBzZXQgc2hvdWxkCmJlIGNhbmRpZGF0ZXMg
Zm9yIHB1dHRpbmcgaW4gdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3RlcnMu
IChBcyB0aGVyZSdzCm9ubHkgYSBzaW5nbGUgc3VjaCBwYWlyIG9mIHJlZ2lz
dGVycyBwZXIgSU9NTVUsIHNlY29uZGFyeSBub24tYWRqYWNlbnQKcmVnaW9u
cyB3aXRoIHRoZSBmbGFnIHNldCBhbHJlYWR5IGdldCBjb252ZXJ0ZWQgdG8g
dW5pdHkgbWFwcGVkCnJlZ2lvbnMuKQoKRmlyc3Qgb2YgYWxsLCBkcm9wIHRo
ZSBkZXBlbmRlbmN5IG9uIG1heF9wYWdlLiBXaXRoIGNvbW1pdCBiNGYwNDIy
MzZhZTAKKCJBTUQvSU9NTVU6IENlYXNlIHVzaW5nIGEgZHluYW1pYyBoZWln
aHQgZm9yIHRoZSBJT01NVSBwYWdldGFibGVzIikgdGhlCnVzZSBvZiBpdCBo
ZXJlIHdhcyBzdGFsZSBhbnl3YXk7IGl0IHdhcyBib2d1cyBhbHJlYWR5IGJl
Zm9yZSwgYXMgaXQKZGlkbid0IGFjY291bnQgZm9yIG1heF9wYWdlIGdldHRp
bmcgaW5jcmVhc2VkIGxhdGVyIG9uLiBTaW1wbHkgdHJ5IGFuCmV4Y2x1c2lv
biByYW5nZSByZWdpc3RyYXRpb24gZmlyc3QsIGFuZCBpZiBpdCBmYWlscyAo
Zm9yIGJlaW5nCnVuc3VpdGFibGUgb3Igbm9uLW1lcmdlYWJsZSksIHJlZ2lz
dGVyIGEgdW5pdHkgbWFwcGluZyByYW5nZS4KCldpdGggdGhpcyB2YXJpb3Vz
IGxvY2FsIHZhcmlhYmxlcyBiZWNvbWUgdW5uZWNlc3NhcnkgYW5kIGhlbmNl
IGdldApkcm9wcGVkIGF0IHRoZSBzYW1lIHRpbWUuCgpXaXRoIHRoZSBtYXhf
cGFnZSBib3VuZGFyeSBkcm9wcGVkIGZvciB1c2luZyB1bml0eSBtYXBzLCB0
aGUgbWluaW11bQpwYWdlIHRhYmxlIHRyZWUgaGVpZ2h0IG5vdyBuZWVkcyBi
b3RoIHJlY29yZGluZyBhbmQgZW5mb3JjaW5nIGluCmFtZF9pb21tdV9kb21h
aW5faW5pdCgpLiBTaW5jZSB3ZSBjYW4ndCBwcmVkaWN0IHdoaWNoIGRldmlj
ZXMgbWF5IGdldAphc3NpZ25lZCB0byBhIGRvbWFpbiwgb3VyIG9ubHkgb3B0
aW9uIGlzIHRvIHVuaWZvcm1seSBmb3JjZSBhdCBsZWFzdAp0aGF0IGhlaWdo
dCBmb3IgYWxsIGRvbWFpbnMsIG5vdyB0aGF0IHRoZSBoZWlnaHQgaXNuJ3Qg
ZHluYW1pYyBhbnltb3JlLgoKRnVydGhlciBkb24ndCBtYWtlIHVzZSBvZiB0
aGUgZXhjbHVzaW9uIHJhbmdlIHVubGVzcyBBQ1BJIGRhdGEgc2F5cyBzby4K
Ck5vdGUgdGhhdCBleGNsdXNpb24gcmFuZ2UgcmVnaXN0cmF0aW9uIGluCnJl
Z2lzdGVyX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygpIGlzIG9uIGEgYmVzdCBl
ZmZvcnQgYmFzaXMuIEhlbmNlIHVuaXR5Cm1hcCBlbnRyaWVzIGFsc28gcmVn
aXN0ZXJlZCBhcmUgcmVkdW5kYW50IHdoZW4gdGhlIGZvcm1lciBzdWNjZWVk
ZWQsIGJ1dAp0aGV5IGFsc28gZG8gbm8gaGFybS4gSW1wcm92ZW1lbnRzIGlu
IHRoaXMgYXJlYSBjYW4gYmUgZG9uZSBsYXRlciBpbW8uCgpBbHNvIGFkanVz
dCB0eXBlcyB3aGVyZSBzdWl0YWJsZSB3aXRob3V0IHRvdWNoaW5nIGV4dHJh
IGxpbmVzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zNzguCgpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBQYXVsIER1cnJhbnQgPHBhdWxAeGVuLm9yZz4KLS0tClRCRDogVGhl
IGFkanVzdG1lbnQgZG9uZSB0byBhbWRfaW9tbXVfZG9tYWluX2luaXQoKSB3
b3VsZCBzdWdnZXN0IHRoYXQKICAgICBpdCBtaWdodCBiZSB3b3J0aCBjb25z
aWRlcmluZyB0byB1c2UgdGhlIGV4Y2x1c2lvbiByYW5nZSByZWdpc3Rlcgog
ICAgIGZvciB0aGUgaGlnaGVzdCByZXBvcnRlZCAoYW5kIHN1aXRhYmxlKSBy
YW5nZSwgcmF0aGVyIHRoYW4gdGhlCiAgICAgZmlyc3Qgb25lIGZvdW5kICho
b3dldmVyIHVubGlrZWx5IGl0IG1pZ2h0IGJlIHRvIGZpbmQgbXVsdGlwbGUK
ICAgICBvbmVzIGluIHRoZSBmaXJzdCBwbGFjZSkuIFRoYXQgd2F5IHdlIG1p
Z2h0IGJlIGFibGUgdG8gbGltaXQgdGhlCiAgICAgcGFnZSB0YWJsZSB0cmVl
IGhlaWdodC4KLS0tCnY5OiBSZS1iYXNlLgp2ODogUmUtYmFzZSBvdmVyIGFk
anVzdG1lbnRzIHRvIGVhcmxpZXIgcGF0Y2guCnY3OiBEb24ndCB1c2UgZXhj
bHVzaW9uIHJhbmdlIHdoZW4gQUNQSSB0YWJsZSBlbnRyeSBkb2Vzbid0IHNh
eSBzby4KdjY6IFJlLWJhc2UuCnY1OiBOZXcuCi0tLQpCYWNrcG9ydGluZyBu
b3RlOiBUaGlzIGRlcGVuZHMgb24gYjc1YjNjNjJmZTRhICgiQU1EL0lPTU1V
OiBmaXgKb2ZmLWJ5LW9uZSBpbiBhbWRfaW9tbXVfZ2V0X3BhZ2luZ19tb2Rl
KCkgY2FsbGVycyIpLgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11LmgKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11LmgKQEAgLTMwNCw2ICszMDQsOCBAQCBleHRlcm4gc3RydWN0IGhw
ZXRfc2JkZiB7CiAgICAgfSBpbml0OwogfSBocGV0X3NiZGY7CiAKK2V4dGVy
biBpbnQgYW1kX2lvbW11X21pbl9wYWdpbmdfbW9kZTsKKwogZXh0ZXJuIHZv
aWQgKnNoYXJlZF9pbnRyZW1hcF90YWJsZTsKIGV4dGVybiB1bnNpZ25lZCBs
b25nICpzaGFyZWRfaW50cmVtYXBfaW51c2U7CiAKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYworKysgYi94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfYWNwaS5jCkBAIC0xMTcsMTIg
KzExNyw4IEBAIHN0YXRpYyBzdHJ1Y3QgYW1kX2lvbW11ICogX19pbml0IGZp
bmRfaW8KIH0KIAogc3RhdGljIGludCBfX2luaXQgcmVzZXJ2ZV9pb21tdV9l
eGNsdXNpb25fcmFuZ2UoCi0gICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUs
IHVpbnQ2NF90IGJhc2UsIHVpbnQ2NF90IGxpbWl0LAotICAgIGJvb2wgYWxs
LCBib29sIGl3LCBib29sIGlyKQorICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11LCBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGltaXQsIGJvb2wgYWxsKQog
ewotICAgIGlmICggIWlyIHx8ICFpdyApCi0gICAgICAgIHJldHVybiAtRVBF
Uk07Ci0KICAgICAvKiBuZWVkIHRvIGV4dGVuZCBleGNsdXNpb24gcmFuZ2U/
ICovCiAgICAgaWYgKCBpb21tdS0+ZXhjbHVzaW9uX2VuYWJsZSApCiAgICAg
ewpAQCAtMTUxLDE0ICsxNDcsMTggQEAgc3RhdGljIGludCBfX2luaXQgcmVz
ZXJ2ZV91bml0eV9tYXBfZm9yXwogewogICAgIHN0cnVjdCBpdnJzX21hcHBp
bmdzICppdnJzX21hcHBpbmdzID0gZ2V0X2l2cnNfbWFwcGluZ3Moc2VnKTsK
ICAgICBzdHJ1Y3QgaXZyc191bml0eV9tYXAgKnVuaXR5X21hcCA9IGl2cnNf
bWFwcGluZ3NbYmRmXS51bml0eV9tYXA7CisgICAgaW50IHBhZ2luZ19tb2Rl
ID0gYW1kX2lvbW11X2dldF9wYWdpbmdfbW9kZShQRk5fVVAoYmFzZSArIGxl
bmd0aCkpOworCisgICAgaWYgKCBwYWdpbmdfbW9kZSA8IDAgKQorICAgICAg
ICByZXR1cm4gcGFnaW5nX21vZGU7CiAKICAgICAvKiBDaGVjayBmb3Igb3Zl
cmxhcHMuICovCiAgICAgZm9yICggOyB1bml0eV9tYXA7IHVuaXR5X21hcCA9
IHVuaXR5X21hcC0+bmV4dCApCiAgICAgewogICAgICAgICAvKgogICAgICAg
ICAgKiBFeGFjdCBtYXRjaGVzIGFyZSBva2F5LiBUaGlzIGNhbiBpbiBwYXJ0
aWN1bGFyIGhhcHBlbiB3aGVuCi0gICAgICAgICAqIHJlZ2lzdGVyX2V4Y2x1
c2lvbl9yYW5nZV9mb3JfZGV2aWNlKCkgY2FsbHMgaGVyZSB0d2ljZSBmb3Ig
dGhlCi0gICAgICAgICAqIHNhbWUgKHMsYixkLGYpLgorICAgICAgICAgKiBy
ZWdpc3Rlcl9yYW5nZV9mb3JfZGV2aWNlKCkgY2FsbHMgaGVyZSB0d2ljZSBm
b3IgdGhlIHNhbWUKKyAgICAgICAgICogKHMsYixkLGYpLgogICAgICAgICAg
Ki8KICAgICAgICAgaWYgKCBiYXNlID09IHVuaXR5X21hcC0+YWRkciAmJiBs
ZW5ndGggPT0gdW5pdHlfbWFwLT5sZW5ndGggJiYKICAgICAgICAgICAgICBp
ciA9PSB1bml0eV9tYXAtPnJlYWQgJiYgaXcgPT0gdW5pdHlfbWFwLT53cml0
ZSApCkBAIC0xODYsNTUgKzE4Niw1MiBAQCBzdGF0aWMgaW50IF9faW5pdCBy
ZXNlcnZlX3VuaXR5X21hcF9mb3JfCiAgICAgdW5pdHlfbWFwLT5uZXh0ID0g
aXZyc19tYXBwaW5nc1tiZGZdLnVuaXR5X21hcDsKICAgICBpdnJzX21hcHBp
bmdzW2JkZl0udW5pdHlfbWFwID0gdW5pdHlfbWFwOwogCisgICAgaWYgKCBw
YWdpbmdfbW9kZSA+IGFtZF9pb21tdV9taW5fcGFnaW5nX21vZGUgKQorICAg
ICAgICBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2RlID0gcGFnaW5nX21vZGU7
CisKICAgICByZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBfX2luaXQgcmVn
aXN0ZXJfZXhjbHVzaW9uX3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygKLSAgICB1
bnNpZ25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3
LCB1OCBpcikKK3N0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX3JhbmdlX2Zv
cl9hbGxfZGV2aWNlcygKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGlt
aXQsIGJvb2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewogICAg
IGludCBzZWcgPSAwOyAvKiBYWFggKi8KLSAgICB1bnNpZ25lZCBsb25nIHJh
bmdlX3RvcCwgaW9tbXVfdG9wLCBsZW5ndGg7CiAgICAgc3RydWN0IGFtZF9p
b21tdSAqaW9tbXU7Ci0gICAgdW5zaWduZWQgaW50IGJkZjsKICAgICBpbnQg
cmMgPSAwOwogCiAgICAgLyogaXMgcGFydCBvZiBleGNsdXNpb24gcmFuZ2Ug
aW5zaWRlIG9mIElPTU1VIHZpcnR1YWwgYWRkcmVzcyBzcGFjZT8gKi8KICAg
ICAvKiBub3RlOiAnbGltaXQnIHBhcmFtZXRlciBpcyBhc3N1bWVkIHRvIGJl
IHBhZ2UtYWxpZ25lZCAqLwotICAgIHJhbmdlX3RvcCA9IGxpbWl0ICsgUEFH
RV9TSVpFOwotICAgIGlvbW11X3RvcCA9IG1heF9wYWdlICogUEFHRV9TSVpF
OwotICAgIGlmICggYmFzZSA8IGlvbW11X3RvcCApCi0gICAgewotICAgICAg
ICBpZiAoIHJhbmdlX3RvcCA+IGlvbW11X3RvcCApCi0gICAgICAgICAgICBy
YW5nZV90b3AgPSBpb21tdV90b3A7Ci0gICAgICAgIGxlbmd0aCA9IHJhbmdl
X3RvcCAtIGJhc2U7Ci0gICAgICAgIC8qIHJlc2VydmUgci93IHVuaXR5LW1h
cHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmljZXMgKi8KLSAgICAgICAgLyog
bm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFydCBvZiB0aGUgZXhjbHVzaW9u
IHJhbmdlICovCi0gICAgICAgIGZvciAoIGJkZiA9IDA7ICFyYyAmJiBiZGYg
PCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyApCi0gICAgICAgICAgICByYyA9
IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYsIGJhc2Us
IGxlbmd0aCwgaXcsIGlyKTsKLSAgICAgICAgLyogcHVzaCAnYmFzZScganVz
dCBvdXRzaWRlIG9mIHZpcnR1YWwgYWRkcmVzcyBzcGFjZSAqLwotICAgICAg
ICBiYXNlID0gaW9tbXVfdG9wOwotICAgIH0KLSAgICAvKiByZWdpc3RlciBJ
T01NVSBleGNsdXNpb24gcmFuZ2Ugc2V0dGluZ3MgKi8KLSAgICBpZiAoICFy
YyAmJiBsaW1pdCA+PSBpb21tdV90b3AgKQorICAgIGlmICggZXhjbHVzaW9u
ICkKICAgICB7CiAgICAgICAgIGZvcl9lYWNoX2FtZF9pb21tdSggaW9tbXUg
KQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IHJlc2VydmVfaW9tbXVf
ZXhjbHVzaW9uX3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAv
KiBhbGwgKi8sIGl3LCBpcik7Ci0gICAgICAgICAgICBpZiAoIHJjICkKLSAg
ICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIGludCByZXQgPSBy
ZXNlcnZlX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGlt
aXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdHJ1ZSAvKiBhbGwgKi8pOworCisgICAgICAgICAgICBp
ZiAoIHJldCAmJiAhcmMgKQorICAgICAgICAgICAgICAgIHJjID0gcmV0Owog
ICAgICAgICB9CiAgICAgfQogCisgICAgaWYgKCAhZXhjbHVzaW9uIHx8IHJj
ICkKKyAgICB7CisgICAgICAgIHBhZGRyX3QgbGVuZ3RoID0gbGltaXQgKyBQ
QUdFX1NJWkUgLSBiYXNlOworICAgICAgICB1bnNpZ25lZCBpbnQgYmRmOwor
CisgICAgICAgIC8qIHJlc2VydmUgci93IHVuaXR5LW1hcHBlZCBwYWdlIGVu
dHJpZXMgZm9yIGRldmljZXMgKi8KKyAgICAgICAgZm9yICggYmRmID0gcmMg
PSAwOyAhcmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysgKQor
ICAgICAgICAgICAgcmMgPSByZXNlcnZlX3VuaXR5X21hcF9mb3JfZGV2aWNl
KHNlZywgYmRmLCBiYXNlLCBsZW5ndGgsIGl3LCBpcik7CisgICAgfQorCiAg
ICAgcmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50IF9faW5pdCByZWdpc3Rl
cl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZSgKLSAgICB1MTYgYmRmLCB1
bnNpZ25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3
LCB1OCBpcikKK3N0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX3JhbmdlX2Zv
cl9kZXZpY2UoCisgICAgdW5zaWduZWQgaW50IGJkZiwgcGFkZHJfdCBiYXNl
LCBwYWRkcl90IGxpbWl0LAorICAgIGJvb2wgaXcsIGJvb2wgaXIsIGJvb2wg
ZXhjbHVzaW9uKQogewogICAgIGludCBzZWcgPSAwOyAvKiBYWFggKi8KICAg
ICBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5ncyA9IGdldF9p
dnJzX21hcHBpbmdzKHNlZyk7Ci0gICAgdW5zaWduZWQgbG9uZyByYW5nZV90
b3AsIGlvbW11X3RvcCwgbGVuZ3RoOwogICAgIHN0cnVjdCBhbWRfaW9tbXUg
KmlvbW11OwogICAgIHUxNiByZXE7CiAgICAgaW50IHJjID0gMDsKQEAgLTI0
OCwyNyArMjQ1LDE5IEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4
Y2x1c2lvbl9yYW4KICAgICByZXEgPSBpdnJzX21hcHBpbmdzW2JkZl0uZHRl
X3JlcXVlc3Rvcl9pZDsKIAogICAgIC8qIG5vdGU6ICdsaW1pdCcgcGFyYW1l
dGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICovCi0gICAgcmFu
Z2VfdG9wID0gbGltaXQgKyBQQUdFX1NJWkU7Ci0gICAgaW9tbXVfdG9wID0g
bWF4X3BhZ2UgKiBQQUdFX1NJWkU7Ci0gICAgaWYgKCBiYXNlIDwgaW9tbXVf
dG9wICkKLSAgICB7Ci0gICAgICAgIGlmICggcmFuZ2VfdG9wID4gaW9tbXVf
dG9wICkKLSAgICAgICAgICAgIHJhbmdlX3RvcCA9IGlvbW11X3RvcDsKLSAg
ICAgICAgbGVuZ3RoID0gcmFuZ2VfdG9wIC0gYmFzZTsKKyAgICBpZiAoIGV4
Y2x1c2lvbiApCisgICAgICAgIHJjID0gcmVzZXJ2ZV9pb21tdV9leGNsdXNp
b25fcmFuZ2UoaW9tbXUsIGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlIC8qIGFsbCAqLyk7
CisgICAgaWYgKCAhZXhjbHVzaW9uIHx8IHJjICkKKyAgICB7CisgICAgICAg
IHBhZGRyX3QgbGVuZ3RoID0gbGltaXQgKyBQQUdFX1NJWkUgLSBiYXNlOwor
CiAgICAgICAgIC8qIHJlc2VydmUgdW5pdHktbWFwcGVkIHBhZ2UgZW50cmll
cyBmb3IgZGV2aWNlICovCi0gICAgICAgIC8qIG5vdGU6IHRoZXNlIGVudHJp
ZXMgYXJlIHBhcnQgb2YgdGhlIGV4Y2x1c2lvbiByYW5nZSAqLwogICAgICAg
ICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCBiZGYs
IGJhc2UsIGxlbmd0aCwgaXcsIGlyKSA/OgogICAgICAgICAgICAgIHJlc2Vy
dmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2Uoc2VnLCByZXEsIGJhc2UsIGxlbmd0
aCwgaXcsIGlyKTsKLQotICAgICAgICAvKiBwdXNoICdiYXNlJyBqdXN0IG91
dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNzIHNwYWNlICovCi0gICAgICAgIGJh
c2UgPSBpb21tdV90b3A7CiAgICAgfQotCi0gICAgLyogcmVnaXN0ZXIgSU9N
TVUgZXhjbHVzaW9uIHJhbmdlIHNldHRpbmdzIGZvciBkZXZpY2UgKi8KLSAg
ICBpZiAoICFyYyAmJiBsaW1pdCA+PSBpb21tdV90b3AgICkKKyAgICBlbHNl
CiAgICAgewotICAgICAgICByYyA9IHJlc2VydmVfaW9tbXVfZXhjbHVzaW9u
X3JhbmdlKGlvbW11LCBiYXNlLCBsaW1pdCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAvKiBhbGwgKi8sIGl3
LCBpcik7CiAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRmXS5kdGVfYWxsb3df
ZXhjbHVzaW9uID0gdHJ1ZTsKICAgICAgICAgaXZyc19tYXBwaW5nc1tyZXFd
LmR0ZV9hbGxvd19leGNsdXNpb24gPSB0cnVlOwogICAgIH0KQEAgLTI3Niw1
MyArMjY1LDQyIEBAIHN0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX2V4Y2x1
c2lvbl9yYW4KICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgX19p
bml0IHJlZ2lzdGVyX2V4Y2x1c2lvbl9yYW5nZV9mb3JfaW9tbXVfZGV2aWNl
cygKLSAgICBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICB1bnNpZ25l
ZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQsIHU4IGl3LCB1OCBp
cikKK3N0YXRpYyBpbnQgX19pbml0IHJlZ2lzdGVyX3JhbmdlX2Zvcl9pb21t
dV9kZXZpY2VzKAorICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCBwYWRk
cl90IGJhc2UsIHBhZGRyX3QgbGltaXQsCisgICAgYm9vbCBpdywgYm9vbCBp
ciwgYm9vbCBleGNsdXNpb24pCiB7Ci0gICAgdW5zaWduZWQgbG9uZyByYW5n
ZV90b3AsIGlvbW11X3RvcCwgbGVuZ3RoOworICAgIC8qIG5vdGU6ICdsaW1p
dCcgcGFyYW1ldGVyIGlzIGFzc3VtZWQgdG8gYmUgcGFnZS1hbGlnbmVkICov
CisgICAgcGFkZHJfdCBsZW5ndGggPSBsaW1pdCArIFBBR0VfU0laRSAtIGJh
c2U7CiAgICAgdW5zaWduZWQgaW50IGJkZjsKICAgICB1MTYgcmVxOwotICAg
IGludCByYyA9IDA7CisgICAgaW50IHJjOwogCi0gICAgLyogaXMgcGFydCBv
ZiBleGNsdXNpb24gcmFuZ2UgaW5zaWRlIG9mIElPTU1VIHZpcnR1YWwgYWRk
cmVzcyBzcGFjZT8gKi8KLSAgICAvKiBub3RlOiAnbGltaXQnIHBhcmFtZXRl
ciBpcyBhc3N1bWVkIHRvIGJlIHBhZ2UtYWxpZ25lZCAqLwotICAgIHJhbmdl
X3RvcCA9IGxpbWl0ICsgUEFHRV9TSVpFOwotICAgIGlvbW11X3RvcCA9IG1h
eF9wYWdlICogUEFHRV9TSVpFOwotICAgIGlmICggYmFzZSA8IGlvbW11X3Rv
cCApCi0gICAgewotICAgICAgICBpZiAoIHJhbmdlX3RvcCA+IGlvbW11X3Rv
cCApCi0gICAgICAgICAgICByYW5nZV90b3AgPSBpb21tdV90b3A7Ci0gICAg
ICAgIGxlbmd0aCA9IHJhbmdlX3RvcCAtIGJhc2U7Ci0gICAgICAgIC8qIHJl
c2VydmUgci93IHVuaXR5LW1hcHBlZCBwYWdlIGVudHJpZXMgZm9yIGRldmlj
ZXMgKi8KLSAgICAgICAgLyogbm90ZTogdGhlc2UgZW50cmllcyBhcmUgcGFy
dCBvZiB0aGUgZXhjbHVzaW9uIHJhbmdlICovCi0gICAgICAgIGZvciAoIGJk
ZiA9IDA7ICFyYyAmJiBiZGYgPCBpdnJzX2JkZl9lbnRyaWVzOyBiZGYrKyAp
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIGlmICggaW9tbXUgPT0gZmluZF9p
b21tdV9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIGJkZikgKQotICAgICAgICAg
ICAgewotICAgICAgICAgICAgICAgIHJlcSA9IGdldF9pdnJzX21hcHBpbmdz
KGlvbW11LT5zZWcpW2JkZl0uZHRlX3JlcXVlc3Rvcl9pZDsKLSAgICAgICAg
ICAgICAgICByYyA9IHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9kZXZpY2UoaW9t
bXUtPnNlZywgYmRmLCBiYXNlLCBsZW5ndGgsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3LCBpcikgPzoK
LSAgICAgICAgICAgICAgICAgICAgIHJlc2VydmVfdW5pdHlfbWFwX2Zvcl9k
ZXZpY2UoaW9tbXUtPnNlZywgcmVxLCBiYXNlLCBsZW5ndGgsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl3
LCBpcik7Ci0gICAgICAgICAgICB9Ci0gICAgICAgIH0KLQotICAgICAgICAv
KiBwdXNoICdiYXNlJyBqdXN0IG91dHNpZGUgb2YgdmlydHVhbCBhZGRyZXNz
IHNwYWNlICovCi0gICAgICAgIGJhc2UgPSBpb21tdV90b3A7CisgICAgaWYg
KCBleGNsdXNpb24gKQorICAgIHsKKyAgICAgICAgcmMgPSByZXNlcnZlX2lv
bW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsIHRydWUg
LyogYWxsICovKTsKKyAgICAgICAgaWYgKCAhcmMgKQorICAgICAgICAgICAg
cmV0dXJuIDA7CiAgICAgfQogCi0gICAgLyogcmVnaXN0ZXIgSU9NTVUgZXhj
bHVzaW9uIHJhbmdlIHNldHRpbmdzICovCi0gICAgaWYgKCAhcmMgJiYgbGlt
aXQgPj0gaW9tbXVfdG9wICkKLSAgICAgICAgcmMgPSByZXNlcnZlX2lvbW11
X2V4Y2x1c2lvbl9yYW5nZShpb21tdSwgYmFzZSwgbGltaXQsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKiBh
bGwgKi8sIGl3LCBpcik7CisgICAgLyogcmVzZXJ2ZSB1bml0eS1tYXBwZWQg
cGFnZSBlbnRyaWVzIGZvciBkZXZpY2VzICovCisgICAgZm9yICggYmRmID0g
cmMgPSAwOyAhcmMgJiYgYmRmIDwgaXZyc19iZGZfZW50cmllczsgYmRmKysg
KQorICAgIHsKKyAgICAgICAgaWYgKCBpb21tdSAhPSBmaW5kX2lvbW11X2Zv
cl9kZXZpY2UoaW9tbXUtPnNlZywgYmRmKSApCisgICAgICAgICAgICBjb250
aW51ZTsKKworICAgICAgICByZXEgPSBnZXRfaXZyc19tYXBwaW5ncyhpb21t
dS0+c2VnKVtiZGZdLmR0ZV9yZXF1ZXN0b3JfaWQ7CisgICAgICAgIHJjID0g
cmVzZXJ2ZV91bml0eV9tYXBfZm9yX2RldmljZShpb21tdS0+c2VnLCBiZGYs
IGJhc2UsIGxlbmd0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGl3LCBpcikgPzoKKyAgICAgICAgICAgICByZXNlcnZl
X3VuaXR5X21hcF9mb3JfZGV2aWNlKGlvbW11LT5zZWcsIHJlcSwgYmFzZSwg
bGVuZ3RoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaXcsIGlyKTsKKyAgICB9CiAKICAgICByZXR1cm4gcmM7CiB9CiAK
IHN0YXRpYyBpbnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGVjdCgK
ICAgICBjb25zdCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9j
aywKLSAgICB1bnNpZ25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGlt
aXQsIHU4IGl3LCB1OCBpcikKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3Qg
bGltaXQsIGJvb2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewog
ICAgIHUxNiBiZGY7CiAKQEAgLTMzMywxMiArMzExLDEyIEBAIHN0YXRpYyBp
bnQgX19pbml0IHBhcnNlX2l2bWRfZGV2aWNlX3NlbGUKICAgICAgICAgcmV0
dXJuIC1FTk9ERVY7CiAgICAgfQogCi0gICAgcmV0dXJuIHJlZ2lzdGVyX2V4
Y2x1c2lvbl9yYW5nZV9mb3JfZGV2aWNlKGJkZiwgYmFzZSwgbGltaXQsIGl3
LCBpcik7CisgICAgcmV0dXJuIHJlZ2lzdGVyX3JhbmdlX2Zvcl9kZXZpY2Uo
YmRmLCBiYXNlLCBsaW1pdCwgaXcsIGlyLCBleGNsdXNpb24pOwogfQogCiBz
dGF0aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9yYW5nZSgKICAg
ICBjb25zdCBzdHJ1Y3QgYWNwaV9pdnJzX21lbW9yeSAqaXZtZF9ibG9jaywK
LSAgICB1bnNpZ25lZCBsb25nIGJhc2UsIHVuc2lnbmVkIGxvbmcgbGltaXQs
IHU4IGl3LCB1OCBpcikKKyAgICBwYWRkcl90IGJhc2UsIHBhZGRyX3QgbGlt
aXQsIGJvb2wgaXcsIGJvb2wgaXIsIGJvb2wgZXhjbHVzaW9uKQogewogICAg
IHVuc2lnbmVkIGludCBmaXJzdF9iZGYsIGxhc3RfYmRmLCBiZGY7CiAgICAg
aW50IGVycm9yOwpAQCAtMzYwLDE1ICszMzgsMTUgQEAgc3RhdGljIGludCBf
X2luaXQgcGFyc2VfaXZtZF9kZXZpY2VfcmFuZwogICAgIH0KIAogICAgIGZv
ciAoIGJkZiA9IGZpcnN0X2JkZiwgZXJyb3IgPSAwOyAoYmRmIDw9IGxhc3Rf
YmRmKSAmJiAhZXJyb3I7IGJkZisrICkKLSAgICAgICAgZXJyb3IgPSByZWdp
c3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2RldmljZSgKLSAgICAgICAgICAg
IGJkZiwgYmFzZSwgbGltaXQsIGl3LCBpcik7CisgICAgICAgIGVycm9yID0g
cmVnaXN0ZXJfcmFuZ2VfZm9yX2RldmljZSgKKyAgICAgICAgICAgIGJkZiwg
YmFzZSwgbGltaXQsIGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIHJldHVy
biBlcnJvcjsKIH0KIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfaXZtZF9k
ZXZpY2VfaW9tbXUoCiAgICAgY29uc3Qgc3RydWN0IGFjcGlfaXZyc19tZW1v
cnkgKml2bWRfYmxvY2ssCi0gICAgdW5zaWduZWQgbG9uZyBiYXNlLCB1bnNp
Z25lZCBsb25nIGxpbWl0LCB1OCBpdywgdTggaXIpCisgICAgcGFkZHJfdCBi
YXNlLCBwYWRkcl90IGxpbWl0LCBib29sIGl3LCBib29sIGlyLCBib29sIGV4
Y2x1c2lvbikKIHsKICAgICBpbnQgc2VnID0gMDsgLyogWFhYICovCiAgICAg
c3RydWN0IGFtZF9pb21tdSAqaW9tbXU7CkBAIC0zODMsMTQgKzM2MSwxNCBA
QCBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2RldmljZV9pb21tCiAg
ICAgICAgIHJldHVybiAtRU5PREVWOwogICAgIH0KIAotICAgIHJldHVybiBy
ZWdpc3Rlcl9leGNsdXNpb25fcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCi0g
ICAgICAgIGlvbW11LCBiYXNlLCBsaW1pdCwgaXcsIGlyKTsKKyAgICByZXR1
cm4gcmVnaXN0ZXJfcmFuZ2VfZm9yX2lvbW11X2RldmljZXMoCisgICAgICAg
IGlvbW11LCBiYXNlLCBsaW1pdCwgaXcsIGlyLCBleGNsdXNpb24pOwogfQog
CiBzdGF0aWMgaW50IF9faW5pdCBwYXJzZV9pdm1kX2Jsb2NrKGNvbnN0IHN0
cnVjdCBhY3BpX2l2cnNfbWVtb3J5ICppdm1kX2Jsb2NrKQogewogICAgIHVu
c2lnbmVkIGxvbmcgc3RhcnRfYWRkciwgbWVtX2xlbmd0aCwgYmFzZSwgbGlt
aXQ7Ci0gICAgdTggaXcsIGlyOworICAgIGJvb2wgaXcgPSB0cnVlLCBpciA9
IHRydWUsIGV4Y2x1c2lvbiA9IGZhbHNlOwogCiAgICAgaWYgKCBpdm1kX2Js
b2NrLT5oZWFkZXIubGVuZ3RoIDwgc2l6ZW9mKCppdm1kX2Jsb2NrKSApCiAg
ICAgewpAQCAtNDA3LDEzICszODUsMTEgQEAgc3RhdGljIGludCBfX2luaXQg
cGFyc2VfaXZtZF9ibG9jayhjb25zdAogICAgICAgICAgICAgICAgICAgICBp
dm1kX2Jsb2NrLT5oZWFkZXIudHlwZSwgc3RhcnRfYWRkciwgbWVtX2xlbmd0
aCk7CiAKICAgICBpZiAoIGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFD
UElfSVZNRF9FWENMVVNJT05fUkFOR0UgKQotICAgICAgICBpdyA9IGlyID0g
SU9NTVVfQ09OVFJPTF9FTkFCTEVEOworICAgICAgICBleGNsdXNpb24gPSB0
cnVlOwogICAgIGVsc2UgaWYgKCBpdm1kX2Jsb2NrLT5oZWFkZXIuZmxhZ3Mg
JiBBQ1BJX0lWTURfVU5JVFkgKQogICAgIHsKLSAgICAgICAgaXcgPSBpdm1k
X2Jsb2NrLT5oZWFkZXIuZmxhZ3MgJiBBQ1BJX0lWTURfUkVBRCA/Ci0gICAg
ICAgICAgICBJT01NVV9DT05UUk9MX0VOQUJMRUQgOiBJT01NVV9DT05UUk9M
X0RJU0FCTEVEOwotICAgICAgICBpciA9IGl2bWRfYmxvY2stPmhlYWRlci5m
bGFncyAmIEFDUElfSVZNRF9XUklURSA/Ci0gICAgICAgICAgICBJT01NVV9D
T05UUk9MX0VOQUJMRUQgOiBJT01NVV9DT05UUk9MX0RJU0FCTEVEOworICAg
ICAgICBpdyA9IGl2bWRfYmxvY2stPmhlYWRlci5mbGFncyAmIEFDUElfSVZN
RF9SRUFEOworICAgICAgICBpciA9IGl2bWRfYmxvY2stPmhlYWRlci5mbGFn
cyAmIEFDUElfSVZNRF9XUklURTsKICAgICB9CiAgICAgZWxzZQogICAgIHsK
QEAgLTQyNCwyMCArNDAwLDIwIEBAIHN0YXRpYyBpbnQgX19pbml0IHBhcnNl
X2l2bWRfYmxvY2soY29uc3QKICAgICBzd2l0Y2goIGl2bWRfYmxvY2stPmhl
YWRlci50eXBlICkKICAgICB7CiAgICAgY2FzZSBBQ1BJX0lWUlNfVFlQRV9N
RU1PUllfQUxMOgotICAgICAgICByZXR1cm4gcmVnaXN0ZXJfZXhjbHVzaW9u
X3JhbmdlX2Zvcl9hbGxfZGV2aWNlcygKLSAgICAgICAgICAgIGJhc2UsIGxp
bWl0LCBpdywgaXIpOworICAgICAgICByZXR1cm4gcmVnaXN0ZXJfcmFuZ2Vf
Zm9yX2FsbF9kZXZpY2VzKAorICAgICAgICAgICAgYmFzZSwgbGltaXQsIGl3
LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIGNhc2UgQUNQSV9JVlJTX1RZUEVf
TUVNT1JZX09ORToKLSAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNl
X3NlbGVjdChpdm1kX2Jsb2NrLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJhc2UsIGxpbWl0LCBpdywgaXIpOworICAgICAg
ICByZXR1cm4gcGFyc2VfaXZtZF9kZXZpY2Vfc2VsZWN0KGl2bWRfYmxvY2ss
IGJhc2UsIGxpbWl0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGl3LCBpciwgZXhjbHVzaW9uKTsKIAogICAgIGNhc2UgQUNQ
SV9JVlJTX1RZUEVfTUVNT1JZX1JBTkdFOgotICAgICAgICByZXR1cm4gcGFy
c2VfaXZtZF9kZXZpY2VfcmFuZ2UoaXZtZF9ibG9jaywKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2UsIGxpbWl0LCBpdywg
aXIpOworICAgICAgICByZXR1cm4gcGFyc2VfaXZtZF9kZXZpY2VfcmFuZ2Uo
aXZtZF9ibG9jaywgYmFzZSwgbGltaXQsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpdywgaXIsIGV4Y2x1c2lvbik7CiAKICAg
ICBjYXNlIEFDUElfSVZSU19UWVBFX01FTU9SWV9JT01NVToKLSAgICAgICAg
cmV0dXJuIHBhcnNlX2l2bWRfZGV2aWNlX2lvbW11KGl2bWRfYmxvY2ssCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlLCBs
aW1pdCwgaXcsIGlyKTsKKyAgICAgICAgcmV0dXJuIHBhcnNlX2l2bWRfZGV2
aWNlX2lvbW11KGl2bWRfYmxvY2ssIGJhc2UsIGxpbWl0LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXcsIGlyLCBleGNsdXNp
b24pOwogCiAgICAgZGVmYXVsdDoKICAgICAgICAgQU1EX0lPTU1VX0RFQlVH
KCJJVk1EIEVycm9yOiBJbnZhbGlkIEJsb2NrIFR5cGUhXG4iKTsKLS0tIGEv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwor
KysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21t
dS5jCkBAIC0yNDYsNiArMjQ2LDggQEAgaW50IGFtZF9pb21tdV9hbGxvY19y
b290KHN0cnVjdCBkb21haW4gKgogICAgIHJldHVybiAwOwogfQogCitpbnQg
X19yZWFkX21vc3RseSBhbWRfaW9tbXVfbWluX3BhZ2luZ19tb2RlID0gMTsK
Kwogc3RhdGljIGludCBhbWRfaW9tbXVfZG9tYWluX2luaXQoc3RydWN0IGRv
bWFpbiAqZCkKIHsKICAgICBzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRv
bV9pb21tdShkKTsKQEAgLTI1NywxMSArMjU5LDEzIEBAIHN0YXRpYyBpbnQg
YW1kX2lvbW11X2RvbWFpbl9pbml0KHN0cnVjdAogICAgICAqIC0gSFZNIGNv
dWxkIGluIHByaW5jaXBsZSB1c2UgMyBvciA0IGRlcGVuZGluZyBvbiBob3cg
bXVjaCBndWVzdAogICAgICAqICAgcGh5c2ljYWwgYWRkcmVzcyBzcGFjZSB3
ZSBnaXZlIGl0LCBidXQgdGhpcyBpc24ndCBrbm93biB5ZXQgc28gdXNlIDQK
ICAgICAgKiAgIHVuaWxhdGVyYWxseS4KKyAgICAgKiAtIFVuaXR5IG1hcHMg
bWF5IHJlcXVpcmUgYW4gZXZlbiBoaWdoZXIgbnVtYmVyLgogICAgICAqLwot
ICAgIGhkLT5hcmNoLmFtZC5wYWdpbmdfbW9kZSA9IGFtZF9pb21tdV9nZXRf
cGFnaW5nX21vZGUoCi0gICAgICAgIGlzX2h2bV9kb21haW4oZCkKLSAgICAg
ICAgPyAxdWwgPDwgKERFRkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEggLSBQ
QUdFX1NISUZUKQotICAgICAgICA6IGdldF91cHBlcl9tZm5fYm91bmQoKSAr
IDEpOworICAgIGhkLT5hcmNoLmFtZC5wYWdpbmdfbW9kZSA9IG1heChhbWRf
aW9tbXVfZ2V0X3BhZ2luZ19tb2RlKAorICAgICAgICAgICAgaXNfaHZtX2Rv
bWFpbihkKQorICAgICAgICAgICAgPyAxdWwgPDwgKERFRkFVTFRfRE9NQUlO
X0FERFJFU1NfV0lEVEggLSBQQUdFX1NISUZUKQorICAgICAgICAgICAgOiBn
ZXRfdXBwZXJfbWZuX2JvdW5kKCkgKyAxKSwKKyAgICAgICAgYW1kX2lvbW11
X21pbl9wYWdpbmdfbW9kZSk7CiAKICAgICByZXR1cm4gMDsKIH0K

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-7.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-7.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBpbnRyb2R1Y2UgcDJtX2lzX3NwZWNpYWwoKQoKU2VlaW5n
IHRoZSBzaW1pbGFyaXR5IG9mIGdyYW50LCBmb3JlaWduLCBhbmQgKHN1YnNl
cXVlbnRseSkgZGlyZWN0LU1NSU8KaGFuZGxpbmcsIGludHJvZHVjZSBhIG5l
dyBQMk0gdHlwZSBncm91cCBuYW1lZCAic3BlY2lhbCIgKGFzIGluICJuZWVk
aW5nCnNwZWNpYWwgYWNjZXNzb3JzIHRvIGNyZWF0ZS9kZXN0cm95IikuCgpB
bHNvIHVzZSAtRVBFUk0gaW5zdGVhZCBvZiBvdGhlciBlcnJvciBjb2RlcyBv
biB0aGUgdHdvIGRvbWFpbl9jcmFzaCgpCnBhdGhzIHRvdWNoZWQuCgpUaGlz
IGlzIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgotLS0Kdjg6IE5ldywgc3BsaXQgZnJvbSBz
dWJzZXF1ZW50IHBhdGNoLgoKLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5j
CisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtODE3LDcgKzgxNyw3
IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLAog
ICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRlcik7
IGkrKyApCiAgICAgICAgIHsKICAgICAgICAgICAgIHAybS0+Z2V0X2VudHJ5
KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAsIE5VTEwsIE5VTEwp
OwotICAgICAgICAgICAgaWYgKCAhcDJtX2lzX2dyYW50KHQpICYmICFwMm1f
aXNfc2hhcmVkKHQpICYmICFwMm1faXNfZm9yZWlnbih0KSApCisgICAgICAg
ICAgICBpZiAoICFwMm1faXNfc3BlY2lhbCh0KSAmJiAhcDJtX2lzX3NoYXJl
ZCh0KSApCiAgICAgICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZu
X3gobWZuKSArIGksIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAgfQog
ICAgIH0KQEAgLTk1NCwxMyArOTU0LDEzIEBAIGd1ZXN0X3BoeXNtYXBfYWRk
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAmb3QsICZhLCAwLCBOVUxMLCBOVUxMKTsKICAgICAg
ICAgICAgIEFTU0VSVCghcDJtX2lzX3NoYXJlZChvdCkpOwogICAgICAgICB9
Ci0gICAgICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8fCBwMm1faXNfZm9y
ZWlnbihvdCkgKQorICAgICAgICBpZiAoIHAybV9pc19zcGVjaWFsKG90KSAp
CiAgICAgICAgIHsKLSAgICAgICAgICAgIC8qIFJlYWxseSBzaG91bGRuJ3Qg
YmUgdW5tYXBwaW5nIGdyYW50L2ZvcmVpZ24gbWFwcyB0aGlzIHdheSAqLwor
ICAgICAgICAgICAgLyogRG9uJ3QgcGVybWl0IHVubWFwcGluZyBncmFudC9m
b3JlaWduIHRoaXMgd2F5LiAqLwogICAgICAgICAgICAgZG9tYWluX2NyYXNo
KGQpOwogICAgICAgICAgICAgcDJtX3VubG9jayhwMm0pOwogICAgICAgICAg
ICAgCi0gICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKKyAgICAgICAgICAg
IHJldHVybiAtRVBFUk07CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAo
IHAybV9pc19yYW0ob3QpICYmICFwMm1faXNfcGFnZWQob3QpICkKICAgICAg
ICAgewpAQCAtMTA1Myw4ICsxMDUzLDcgQEAgaW50IHAybV9jaGFuZ2VfdHlw
ZV9vbmUoc3RydWN0IGRvbWFpbiAqZAogICAgIHN0cnVjdCBwMm1fZG9tYWlu
ICpwMm0gPSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAgICAgaW50IHJjOwogCi0g
ICAgQlVHX09OKHAybV9pc19ncmFudChvdCkgfHwgcDJtX2lzX2dyYW50KG50
KSk7Ci0gICAgQlVHX09OKHAybV9pc19mb3JlaWduKG90KSB8fCBwMm1faXNf
Zm9yZWlnbihudCkpOworICAgIEJVR19PTihwMm1faXNfc3BlY2lhbChvdCkg
fHwgcDJtX2lzX3NwZWNpYWwobnQpKTsKIAogICAgIGdmbl9sb2NrKHAybSwg
Z2ZuLCAwKTsKIApAQCAtMTMwMCwxMSArMTI5OSwxMSBAQCBzdGF0aWMgaW50
IHNldF90eXBlZF9wMm1fZW50cnkoc3RydWN0IGRvCiAgICAgICAgIGdmbl91
bmxvY2socDJtLCBnZm4sIG9yZGVyKTsKICAgICAgICAgcmV0dXJuIGN1cl9v
cmRlciArIDE7CiAgICAgfQotICAgIGlmICggcDJtX2lzX2dyYW50KG90KSB8
fCBwMm1faXNfZm9yZWlnbihvdCkgKQorICAgIGlmICggcDJtX2lzX3NwZWNp
YWwob3QpICkKICAgICB7CiAgICAgICAgIGdmbl91bmxvY2socDJtLCBnZm4s
IG9yZGVyKTsKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAgICBy
ZXR1cm4gLUVOT0VOVDsKKyAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAgICB9
CiAgICAgZWxzZSBpZiAoIHAybV9pc19yYW0ob3QpICkKICAgICB7Ci0tLSBh
L3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUv
YXNtLXg4Ni9wMm0uaApAQCAtMTU0LDYgKzE1NCwxMCBAQCB0eXBlZGVmIHVu
c2lnbmVkIGludCBwMm1fcXVlcnlfdDsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8IHAybV90b19tYXNrKHAybV9yYW1fbG9nZGlydHkpICkKICNk
ZWZpbmUgUDJNX1NIQVJFRF9UWVBFUyAgIChwMm1fdG9fbWFzayhwMm1fcmFt
X3NoYXJlZCkpCiAKKy8qIFR5cGVzIGVzdGFibGlzaGVkL2NsZWFuZWQgdXAg
dmlhIHNwZWNpYWwgYWNjZXNzb3JzLiAqLworI2RlZmluZSBQMk1fU1BFQ0lB
TF9UWVBFUyAoUDJNX0dSQU5UX1RZUEVTIHwgXAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcDJtX3RvX21hc2socDJtX21hcF9mb3JlaWduKSkKKwog
LyogVmFsaWQgdHlwZXMgbm90IG5lY2Vzc2FyaWx5IGFzc29jaWF0ZWQgd2l0
aCBhICh2YWxpZCkgTUZOLiAqLwogI2RlZmluZSBQMk1fSU5WQUxJRF9NRk5f
VFlQRVMgKFAyTV9QT0RfVFlQRVMgICAgICAgICAgICAgICAgICBcCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBwMm1fdG9fbWFzayhwMm1f
bW1pb19kaXJlY3QpIFwKQEAgLTE4Miw2ICsxODYsNyBAQCB0eXBlZGVmIHVu
c2lnbmVkIGludCBwMm1fcXVlcnlfdDsKICNkZWZpbmUgcDJtX2lzX3BhZ2Vk
KF90KSAgICAocDJtX3RvX21hc2soX3QpICYgUDJNX1BBR0VEX1RZUEVTKQog
I2RlZmluZSBwMm1faXNfc2hhcmFibGUoX3QpIChwMm1fdG9fbWFzayhfdCkg
JiBQMk1fU0hBUkFCTEVfVFlQRVMpCiAjZGVmaW5lIHAybV9pc19zaGFyZWQo
X3QpICAgKHAybV90b19tYXNrKF90KSAmIFAyTV9TSEFSRURfVFlQRVMpCisj
ZGVmaW5lIHAybV9pc19zcGVjaWFsKF90KSAgKHAybV90b19tYXNrKF90KSAm
IFAyTV9TUEVDSUFMX1RZUEVTKQogI2RlZmluZSBwMm1faXNfYnJva2VuKF90
KSAgIChwMm1fdG9fbWFzayhfdCkgJiBQMk1fQlJPS0VOX1RZUEVTKQogI2Rl
ZmluZSBwMm1faXNfZm9yZWlnbihfdCkgIChwMm1fdG9fbWFzayhfdCkgJiBw
Mm1fdG9fbWFzayhwMm1fbWFwX2ZvcmVpZ24pKQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa378/xsa378-8.patch"
Content-Disposition: attachment; filename="xsa378/xsa378-8.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvcDJtOiBndWFyZCAoaW4gcGFydGljdWxhcikgaWRlbnRpdHkgbWFw
cGluZyBlbnRyaWVzCgpTdWNoIGVudHJpZXMsIGNyZWF0ZWQgYnkgc2V0X2lk
ZW50aXR5X3AybV9lbnRyeSgpLCBzaG91bGQgb25seSBiZQpkZXN0cm95ZWQg
YnkgY2xlYXJfaWRlbnRpdHlfcDJtX2VudHJ5KCkuIEhvd2V2ZXIsIHNpbWls
YXJseSwgZW50cmllcwpjcmVhdGVkIGJ5IHNldF9tbWlvX3AybV9lbnRyeSgp
IHNob3VsZCBvbmx5IGJlIHRvcm4gZG93biBieQpjbGVhcl9tbWlvX3AybV9l
bnRyeSgpLCBzbyB0aGUgbG9naWMgZ2V0cyBiYXNlZCB1cG9uIHAybV9tbWlv
X2RpcmVjdCBhcwp0aGUgZW50cnkgdHlwZSAoc2VwYXJhdGlvbiBiZXR3ZWVu
ICJvcmRpbmFyeSIgYW5kIDE6MSBtYXBwaW5ncyB3b3VsZApyZXF1aXJlIGEg
ZnVydGhlciBpbmRpY2F0b3IgdG8gdGVsbCBhcGFydCB0aGUgdHdvKS4KCkFz
IHRvIHRoZSBndWVzdF9yZW1vdmVfcGFnZSgpIGNoYW5nZSwgY29tbWl0IDQ4
ZGZiMjk3YTIwYSAoIng4Ni9QVkg6CmFsbG93IGd1ZXN0X3JlbW92ZV9wYWdl
IHRvIHJlbW92ZSBwMm1fbW1pb19kaXJlY3QgcGFnZXMiKSwgd2hpY2gKaW50
cm9kdWNlZCB0aGUgY2FsbCB0byBjbGVhcl9tbWlvX3AybV9lbnRyeSgpLCBj
bGFpbWVkIHRoaXMgd2FzIGRvbmUgZm9yCmh3ZG9tIG9ubHkgd2l0aG91dCB0
aGlzIGFjdHVhbGx5IGhhdmluZyBiZWVuIHRoZSBjYXNlLiBIb3dldmVyLCB0
aGlzCmNvZGUgc2hvdWxkbid0IGJlIHRoZXJlIGluIHRoZSBmaXJzdCBwbGFj
ZSwgYXMgTU1JTyBlbnRyaWVzIHNob3VsZG4ndCBiZQpkcm9wcGVkIHRoaXMg
d2F5LiBBdm9pZCB0cmlnZ2VyaW5nIHRoZSB3YXJuaW5nIGFnYWluIHRoYXQg
NDhkZmIyOTdhMjBhCnNpbGVuY2VkIGJ5IGFuIGFkanVzdG1lbnQgdG8geGVu
bWVtX2FkZF90b19waHlzbWFwX29uZSgpIGluc3RlYWQuCgpOb3RlIHRoYXQg
Z3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZCgpIGdldHMg
dGlnaHRlbmVkIGJleW9uZAp0aGUgaW1tZWRpYXRlIHB1cnBvc2Ugb2YgdGhp
cyBjaGFuZ2UuCgpOb3RlIGFsc28gdGhhdCBJIGRpZG4ndCBpbnNwZWN0IGNv
ZGUgd2hpY2ggaXNuJ3Qgc2VjdXJpdHkgc3VwcG9ydGVkLAplLmcuIHNoYXJp
bmcsIHBhZ2luZywgb3IgYWx0cDJtLgoKVGhpcyBpcyBDVkUtMjAyMS0yODY5
NCAvIHBhcnQgb2YgWFNBLTM3OC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVy
cmFudCA8cGF1bEB4ZW4ub3JnPgotLS0Kdjg6IFNwbGl0IG9mZiBpbnRyb2R1
Y3Rpb24gb2YgcDJtX2lzX3NwZWNpYWwoKS4Kdjc6IFJlLWJhc2UuCnY2OiBB
bHNvIGFkanVzdCB4ZW5tZW1fYWRkX3RvX3BoeXNtYXBfb25lKCkuIEZ1bGx5
IGRyb3AgcDJtX21taW9fZGlyZWN0CiAgICBzcGVjaWFsIGhhbmRsaW5nIGZy
b20gZ3Vlc3RfcmVtb3ZlX3BhZ2UoKTsganVzdCByZXR1cm4gYW4gZXJyb3Iu
CiAgICBNYWtlIGNsZWFyX21taW9fcDJtX2VudHJ5KCkgc3RhdGljLgp2NTog
TmV3LgotLS0KQmFja3BvcnRpbmcgbm90ZTogV2hpbGUgbGlrZWx5IG5vdGlj
YWJsZSBieSBwYXRjaCBjb25mbGljdHMgYW55d2F5LCB0aGlzCmRlcGVuZHMg
b24gb25lIG9yIGJvdGggb2YgYTZiMDUxYTg3YTU4ICgieDg2L3AybTogZG9u
J3QgaWdub3JlCnAybV9yZW1vdmVfcGFnZSgpJ3MgcmV0dXJuIHZhbHVlIikg
YW5kIGM2NWVhMTZkYmNhZiAoIng4Ni9wMm06IGRvbid0CmFzc2VydCB0aGF0
IHRoZSBwYXNzZWQgaW4gTUZOIG1hdGNoZXMgZm9yIGEgcmVtb3ZlIikuCgot
LS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2
L21tL3AybS5jCkBAIC04MDUsNyArODA1LDggQEAgcDJtX3JlbW92ZV9wYWdl
KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmY3VyX29yZGVyLCBOVUxMKTsKIAog
ICAgICAgICBpZiAoIHAybV9pc192YWxpZCh0KSAmJgotICAgICAgICAgICAg
ICghbWZuX3ZhbGlkKG1mbikgfHwgIW1mbl9lcShtZm5fYWRkKG1mbiwgaSks
IG1mbl9yZXR1cm4pKSApCisgICAgICAgICAgICAgKCFtZm5fdmFsaWQobWZu
KSB8fCB0ID09IHAybV9tbWlvX2RpcmVjdCB8fAorICAgICAgICAgICAgICAh
bWZuX2VxKG1mbl9hZGQobWZuLCBpKSwgbWZuX3JldHVybikpICkKICAgICAg
ICAgICAgIHJldHVybiAtRUlMU0VROwogCiAgICAgICAgIGkgKz0gKDFVTCA8
PCBjdXJfb3JkZXIpIC0KQEAgLTkxMiw3ICs5MTMsNyBAQCBndWVzdF9waHlz
bWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9tYWluICpkCiAgICAgaWYgKCBwMm1f
aXNfZm9yZWlnbih0KSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCi0g
ICAgaWYgKCAhbWZuX3ZhbGlkKG1mbikgKQorICAgIGlmICggIW1mbl92YWxp
ZChtZm4pIHx8IHQgPT0gcDJtX21taW9fZGlyZWN0ICkKICAgICB7CiAgICAg
ICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOwogICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKQEAgLTk1Niw3ICs5NTcsNyBAQCBndWVzdF9waHlzbWFwX2FkZF9l
bnRyeShzdHJ1Y3QgZG9tYWluICpkCiAgICAgICAgIH0KICAgICAgICAgaWYg
KCBwMm1faXNfc3BlY2lhbChvdCkgKQogICAgICAgICB7Ci0gICAgICAgICAg
ICAvKiBEb24ndCBwZXJtaXQgdW5tYXBwaW5nIGdyYW50L2ZvcmVpZ24gdGhp
cyB3YXkuICovCisgICAgICAgICAgICAvKiBEb24ndCBwZXJtaXQgdW5tYXBw
aW5nIGdyYW50L2ZvcmVpZ24vZGlyZWN0LU1NSU8gdGhpcyB3YXkuICovCiAg
ICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7CiAgICAgICAgICAgICBwMm1f
dW5sb2NrKHAybSk7CiAgICAgICAgICAgICAKQEAgLTEzNjQsOCArMTM2NSw4
IEBAIGludCBzZXRfbW1pb19wMm1fZW50cnkoc3RydWN0IGRvbWFpbiAqZCwK
ICAqICAgIG9yZGVyKzEgIGZvciBjYWxsZXIgdG8gcmV0cnkgd2l0aCBvcmRl
ciAoZ3VhcmFudGVlZCBzbWFsbGVyIHRoYW4KICAqICAgICAgICAgICAgIHRo
ZSBvcmRlciB2YWx1ZSBwYXNzZWQgaW4pCiAgKi8KLWludCBjbGVhcl9tbWlv
X3AybV9lbnRyeShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdm
bl9sLCBtZm5fdCBtZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgdW5z
aWduZWQgaW50IG9yZGVyKQorc3RhdGljIGludCBjbGVhcl9tbWlvX3AybV9l
bnRyeShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbl9sLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5fdCBtZm4sIHVu
c2lnbmVkIGludCBvcmRlcikKIHsKICAgICBpbnQgcmMgPSAtRUlOVkFMOwog
ICAgIGdmbl90IGdmbiA9IF9nZm4oZ2ZuX2wpOwpAQCAtMjc2Niw3ICsyNzY3
LDkgQEAgaW50IHhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUoCiAKICAgICAv
KiBSZW1vdmUgcHJldmlvdXNseSBtYXBwZWQgcGFnZSBpZiBpdCB3YXMgcHJl
c2VudC4gKi8KICAgICBwcmV2X21mbiA9IGdldF9nZm4oZCwgZ2ZuX3goZ3Bm
biksICZwMm10KTsKLSAgICBpZiAoIG1mbl92YWxpZChwcmV2X21mbikgKQor
ICAgIGlmICggcDJtdCA9PSBwMm1fbW1pb19kaXJlY3QgKQorICAgICAgICBy
YyA9IC1FUEVSTTsKKyAgICBlbHNlIGlmICggbWZuX3ZhbGlkKHByZXZfbWZu
KSApCiAgICAgewogICAgICAgICBpZiAoIGlzX3NwZWNpYWxfcGFnZShtZm5f
dG9fcGFnZShwcmV2X21mbikpICkKICAgICAgICAgICAgIC8qIFNwZWNpYWwg
cGFnZXMgYXJlIHNpbXBseSB1bmhvb2tlZCBmcm9tIHRoaXMgcGh5cyBzbG90
LiAqLwotLS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMKQEAgLTEyOTksMTcgKzEyOTksMTcg
QEAgZ3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZChzdAog
CiAgICAgICAgIHAybS0+Z2V0X2VudHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkp
LCAmb3QsICZhLCAwLCAmY3VyX29yZGVyLCBOVUxMKTsKICAgICAgICAgbiA9
IDFVTCA8PCBtaW4ob3JkZXIsIGN1cl9vcmRlcik7Ci0gICAgICAgIGlmICgg
cDJtX2lzX3JhbShvdCkgKQorICAgICAgICBpZiAoIG90ID09IHAybV9wb3B1
bGF0ZV9vbl9kZW1hbmQgKQorICAgICAgICB7CisgICAgICAgICAgICAvKiBD
b3VudCBob3cgbWFueSBQb0QgZW50cmllcyB3ZSdsbCBiZSByZXBsYWNpbmcg
aWYgc3VjY2Vzc2Z1bCAqLworICAgICAgICAgICAgcG9kX2NvdW50ICs9IG47
CisgICAgICAgIH0KKyAgICAgICAgZWxzZSBpZiAoIG90ICE9IHAybV9pbnZh
bGlkICYmIG90ICE9IHAybV9tbWlvX2RtICkKICAgICAgICAgewogICAgICAg
ICAgICAgUDJNX0RFQlVHKCJnZm5fdG9fbWZuIHJldHVybmVkIHR5cGUgJWQh
XG4iLCBvdCk7CiAgICAgICAgICAgICByYyA9IC1FQlVTWTsKICAgICAgICAg
ICAgIGdvdG8gb3V0OwogICAgICAgICB9Ci0gICAgICAgIGVsc2UgaWYgKCBv
dCA9PSBwMm1fcG9wdWxhdGVfb25fZGVtYW5kICkKLSAgICAgICAgewotICAg
ICAgICAgICAgLyogQ291bnQgaG93IG1hbiBQb0QgZW50cmllcyB3ZSdsbCBi
ZSByZXBsYWNpbmcgaWYgc3VjY2Vzc2Z1bCAqLwotICAgICAgICAgICAgcG9k
X2NvdW50ICs9IG47Ci0gICAgICAgIH0KICAgICB9CiAKICAgICAvKiBOb3cs
IGFjdHVhbGx5IGRvIHRoZSB0d28td2F5IG1hcHBpbmcgKi8KLS0tIGEveGVu
L2NvbW1vbi9tZW1vcnkuYworKysgYi94ZW4vY29tbW9uL21lbW9yeS5jCkBA
IC0zMzIsNyArMzMyLDcgQEAgaW50IGd1ZXN0X3JlbW92ZV9wYWdlKHN0cnVj
dCBkb21haW4gKmQsCiAgICAgfQogICAgIGlmICggcDJtdCA9PSBwMm1fbW1p
b19kaXJlY3QgKQogICAgIHsKLSAgICAgICAgcmMgPSBjbGVhcl9tbWlvX3Ay
bV9lbnRyeShkLCBnbWZuLCBtZm4sIFBBR0VfT1JERVJfNEspOworICAgICAg
ICByYyA9IC1FUEVSTTsKICAgICAgICAgZ290byBvdXRfcHV0X2dmbjsKICAg
ICB9CiAjZWxzZQpAQCAtMTg4OCw2ICsxODg4LDE1IEBAIGludCBjaGVja19n
ZXRfcGFnZV9mcm9tX2dmbihzdHJ1Y3QgZG9tYWkKICAgICAgICAgcmV0dXJu
IC1FQUdBSU47CiAgICAgfQogI2VuZGlmCisjaWZkZWYgQ09ORklHX1g4Ngor
ICAgIGlmICggcDJtdCA9PSBwMm1fbW1pb19kaXJlY3QgKQorICAgIHsKKyAg
ICAgICAgaWYgKCBwYWdlICkKKyAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2Up
OworCisgICAgICAgIHJldHVybiAtRVBFUk07CisgICAgfQorI2VuZGlmCiAK
ICAgICBpZiAoICFwYWdlICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Ci0t
LSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9wMm0uaApAQCAtMTU2LDcgKzE1Niw4IEBAIHR5cGVkZWYg
dW5zaWduZWQgaW50IHAybV9xdWVyeV90OwogCiAvKiBUeXBlcyBlc3RhYmxp
c2hlZC9jbGVhbmVkIHVwIHZpYSBzcGVjaWFsIGFjY2Vzc29ycy4gKi8KICNk
ZWZpbmUgUDJNX1NQRUNJQUxfVFlQRVMgKFAyTV9HUkFOVF9UWVBFUyB8IFwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV90b19tYXNrKHAybV9t
YXBfZm9yZWlnbikpCisgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1f
dG9fbWFzayhwMm1fbWFwX2ZvcmVpZ24pIHwgXAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcDJtX3RvX21hc2socDJtX21taW9fZGlyZWN0KSkKIAog
LyogVmFsaWQgdHlwZXMgbm90IG5lY2Vzc2FyaWx5IGFzc29jaWF0ZWQgd2l0
aCBhICh2YWxpZCkgTUZOLiAqLwogI2RlZmluZSBQMk1fSU5WQUxJRF9NRk5f
VFlQRVMgKFAyTV9QT0RfVFlQRVMgICAgICAgICAgICAgICAgICBcCkBAIC02
MjcsMTkgKzYyOCw5IEBAIGludCBwMm1fZmluaXNoX3R5cGVfY2hhbmdlKHN0
cnVjdCBkb21haW4KIGludCBwMm1faXNfbG9nZGlydHlfcmFuZ2Uoc3RydWN0
IHAybV9kb21haW4gKiwgdW5zaWduZWQgbG9uZyBzdGFydCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBlbmQpOwogCi0jaWZk
ZWYgQ09ORklHX0hWTQogLyogU2V0IG1taW8gYWRkcmVzc2VzIGluIHRoZSBw
Mm0gdGFibGUgKGZvciBwYXNzLXRocm91Z2gpICovCiBpbnQgc2V0X21taW9f
cDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIGdmbl90IGdmbiwgbWZuX3Qg
bWZuLAogICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgb3Jk
ZXIpOwotaW50IGNsZWFyX21taW9fcDJtX2VudHJ5KHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLCBtZm5fdCBtZm4sCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKTsKLSNlbHNlCi1z
dGF0aWMgaW5saW5lIGludCBjbGVhcl9tbWlvX3AybV9lbnRyeShzdHJ1Y3Qg
ZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbiwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90IG1mbiwgdW5zaWduZWQg
aW50IG9yZGVyKQotewotICAgIHJldHVybiAtRUlPOwotfQotI2VuZGlmCiAK
IC8qIFNldCBpZGVudGl0eSBhZGRyZXNzZXMgaW4gdGhlIHAybSB0YWJsZSAo
Zm9yIHBhc3MtdGhyb3VnaCkgKi8KIGludCBzZXRfaWRlbnRpdHlfcDJtX2Vu
dHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLAo=

--=separator--


Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 98CCF9708C
	for <lists+xen-devel@lfdr.de>; Wed, 21 Aug 2019 05:55:55 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i0Hgc-0007Xs-P8; Wed, 21 Aug 2019 03:53:26 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Tsmg=WR=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1i0Hgb-0007Xk-1o
 for xen-devel@lists.xen.org; Wed, 21 Aug 2019 03:53:25 +0000
X-Inumbo-ID: 367f4eb2-c3c7-11e9-b95f-bc764e2007e4
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 367f4eb2-c3c7-11e9-b95f-bc764e2007e4;
 Wed, 21 Aug 2019 03:53:19 +0000 (UTC)
Received: from localhost.localdomain (c-67-164-102-47.hsd1.ca.comcast.net
 [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 6EF5E2339D;
 Wed, 21 Aug 2019 03:53:18 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1566359598;
 bh=0JAGiiQQ732nc8ZspiQCbWNnIAh8yRVZZlfqy6Ku0ug=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=fxzJxZ5xNNv88PsfeBElo814cCkXryTOXdJzEWR3oONAJCg/VzNW6alHUmtH6b6Pq
 pELtq52+y/Di37RXg2KdWshN11lXGm5Pjrmt7HJxLQL9VE7DnNwp8ymK3pCjyMS1gI
 729SqGeefvGIjUyOOSn7Y2+yqYR1V4T1J4rGK4E4=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Tue, 20 Aug 2019 20:53:10 -0700
Message-Id: <20190821035315.12812-3-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1908201838370.20094@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1908201838370.20094@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v4 3/8] xen/arm: introduce
 kinfo->guest_phandle_gic
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW5zdGVhZCBvZiBhbHdheXMgaGFyZC1jb2RpbmcgdGhlIEdJQyBwaGFuZGxlIChHVUVTVF9QSEFO
RExFX0dJQyksIHN0b3JlCml0IGluIGEgdmFyaWFibGUgdW5kZXIga2luZm8uIFRoaXMgd2F5IGl0
IGNhbiBiZSBkeW5hbWljYWxseSBjaG9zZW4gcGVyCmRvbWFpbi4KCkluaXRpYWxpemUgZ3Vlc3Rf
cGhhbmRsZV9naWMgdG8gR1VFU1RfUEhBTkRMRV9HSUMgYXQgdGhlIGJlZ2lubmluZyBvZgpwcmVw
YXJlX2R0Yl9kb21VLiBMYXRlciBwYXRjaGVzIHdpbGwgY2hhbmdlIHRoZSB2YWx1ZSBvZgpndWVz
dF9waGFuZGxlX2dpYyBkZXBlbmRpbmcgb24gdXNlciBwcm92aWRlZCBpbmZvcm1hdGlvbi4KClNp
Z25lZC1vZmYtYnk6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3RlZmFub3NAeGlsaW54LmNvbT4KCi0t
LQpDaGFuZ2VzIGluIHY0OgotIG5ldyBwYXRjaAotLS0KIHhlbi9hcmNoL2FybS9kb21haW5fYnVp
bGQuYyAgfCA0MiArKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0KIHhlbi9pbmNs
dWRlL2FzbS1hcm0va2VybmVsLmggfCAgMyArKysKIDIgZmlsZXMgY2hhbmdlZCwgMjcgaW5zZXJ0
aW9ucygrKSwgMTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL2RvbWFp
bl9idWlsZC5jIGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCmluZGV4IGY5MjA2OWM4NWYu
LmNkNTg1ZjA1Y2EgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYworKysg
Yi94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKQEAgLTE1MTAsOCArMTUxMCw5IEBAIHN0YXRp
YyBpbnQgX19pbml0IGhhbmRsZV9ub2RlKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBrZXJuZWxf
aW5mbyAqa2luZm8sCiAgICAgcmV0dXJuIHJlczsKIH0KIAotc3RhdGljIGludCBfX2luaXQgbWFr
ZV9naWN2Ml9kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAqZmR0KQorc3Rh
dGljIGludCBfX2luaXQgbWFrZV9naWN2Ml9kb21VX25vZGUoc3RydWN0IGtlcm5lbF9pbmZvICpr
aW5mbykKIHsKKyAgICB2b2lkICpmZHQgPSBraW5mby0+ZmR0OwogICAgIGludCByZXMgPSAwOwog
ICAgIF9fYmUzMiByZWdbKEdVRVNUX1JPT1RfQUREUkVTU19DRUxMUyArIEdVRVNUX1JPT1RfU0la
RV9DRUxMUykgKiAyXTsKICAgICBfX2JlMzIgKmNlbGxzOwpAQCAtMTU0NiwxMSArMTU0NywxMSBA
QCBzdGF0aWMgaW50IF9faW5pdCBtYWtlX2dpY3YyX2RvbVVfbm9kZShjb25zdCBzdHJ1Y3QgZG9t
YWluICpkLCB2b2lkICpmZHQpCiAgICAgaWYgKHJlcykKICAgICAgICAgcmV0dXJuIHJlczsKIAot
ICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgImxpbnV4LHBoYW5kbGUiLCBHVUVTVF9Q
SEFORExFX0dJQyk7CisgICAgcmVzID0gZmR0X3Byb3BlcnR5X2NlbGwoZmR0LCAibGludXgscGhh
bmRsZSIsIGtpbmZvLT5ndWVzdF9waGFuZGxlX2dpYyk7CiAgICAgaWYgKHJlcykKICAgICAgICAg
cmV0dXJuIHJlczsKIAotICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgInBoYW5kbGUi
LCBHVUVTVF9QSEFORExFX0dJQyk7CisgICAgcmVzID0gZmR0X3Byb3BlcnR5X2NlbGwoZmR0LCAi
cGhhbmRsZSIsIGtpbmZvLT5ndWVzdF9waGFuZGxlX2dpYyk7CiAgICAgaWYgKHJlcykKICAgICAg
ICAgcmV0dXJuIHJlczsKIApAQCAtMTU1OSw4ICsxNTYwLDkgQEAgc3RhdGljIGludCBfX2luaXQg
bWFrZV9naWN2Ml9kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAqZmR0KQog
ICAgIHJldHVybiByZXM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IG1ha2VfZ2ljdjNfZG9tVV9u
b2RlKGNvbnN0IHN0cnVjdCBkb21haW4gKmQsIHZvaWQgKmZkdCkKK3N0YXRpYyBpbnQgX19pbml0
IG1ha2VfZ2ljdjNfZG9tVV9ub2RlKHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8pCiB7CisgICAg
dm9pZCAqZmR0ID0ga2luZm8tPmZkdDsKICAgICBpbnQgcmVzID0gMDsKICAgICBfX2JlMzIgcmVn
WyhHVUVTVF9ST09UX0FERFJFU1NfQ0VMTFMgKyBHVUVTVF9ST09UX1NJWkVfQ0VMTFMpICogMl07
CiAgICAgX19iZTMyICpjZWxsczsKQEAgLTE1OTUsMTEgKzE1OTcsMTEgQEAgc3RhdGljIGludCBf
X2luaXQgbWFrZV9naWN2M19kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAq
ZmR0KQogICAgIGlmIChyZXMpCiAgICAgICAgIHJldHVybiByZXM7CiAKLSAgICByZXMgPSBmZHRf
cHJvcGVydHlfY2VsbChmZHQsICJsaW51eCxwaGFuZGxlIiwgR1VFU1RfUEhBTkRMRV9HSUMpOwor
ICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgImxpbnV4LHBoYW5kbGUiLCBraW5mby0+
Z3Vlc3RfcGhhbmRsZV9naWMpOwogICAgIGlmIChyZXMpCiAgICAgICAgIHJldHVybiByZXM7CiAK
LSAgICByZXMgPSBmZHRfcHJvcGVydHlfY2VsbChmZHQsICJwaGFuZGxlIiwgR1VFU1RfUEhBTkRM
RV9HSUMpOworICAgIHJlcyA9IGZkdF9wcm9wZXJ0eV9jZWxsKGZkdCwgInBoYW5kbGUiLCBraW5m
by0+Z3Vlc3RfcGhhbmRsZV9naWMpOwogICAgIGlmIChyZXMpCiAgICAgICAgIHJldHVybiByZXM7
CiAKQEAgLTE2MDgsMjEgKzE2MTAsMjIgQEAgc3RhdGljIGludCBfX2luaXQgbWFrZV9naWN2M19k
b21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAqZmR0KQogICAgIHJldHVybiBy
ZXM7CiB9CiAKLXN0YXRpYyBpbnQgX19pbml0IG1ha2VfZ2ljX2RvbVVfbm9kZShjb25zdCBzdHJ1
Y3QgZG9tYWluICpkLCB2b2lkICpmZHQpCitzdGF0aWMgaW50IF9faW5pdCBtYWtlX2dpY19kb21V
X25vZGUoc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKIHsKLSAgICBzd2l0Y2ggKCBkLT5hcmNo
LnZnaWMudmVyc2lvbiApCisgICAgc3dpdGNoICgga2luZm8tPmQtPmFyY2gudmdpYy52ZXJzaW9u
ICkKICAgICB7CiAgICAgY2FzZSBHSUNfVjM6Ci0gICAgICAgIHJldHVybiBtYWtlX2dpY3YzX2Rv
bVVfbm9kZShkLCBmZHQpOworICAgICAgICByZXR1cm4gbWFrZV9naWN2M19kb21VX25vZGUoa2lu
Zm8pOwogICAgIGNhc2UgR0lDX1YyOgotICAgICAgICByZXR1cm4gbWFrZV9naWN2Ml9kb21VX25v
ZGUoZCwgZmR0KTsKKyAgICAgICAgcmV0dXJuIG1ha2VfZ2ljdjJfZG9tVV9ub2RlKGtpbmZvKTsK
ICAgICBkZWZhdWx0OgogICAgICAgICBwYW5pYygiVW5zdXBwb3J0ZWQgR0lDIHZlcnNpb25cbiIp
OwogICAgIH0KIH0KIAotc3RhdGljIGludCBfX2luaXQgbWFrZV90aW1lcl9kb21VX25vZGUoY29u
c3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAqZmR0KQorc3RhdGljIGludCBfX2luaXQgbWFrZV90
aW1lcl9kb21VX25vZGUoc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKIHsKKyAgICB2b2lkICpm
ZHQgPSBraW5mby0+ZmR0OwogICAgIGludCByZXM7CiAgICAgZ2ljX2ludGVycnVwdF90IGludHJz
WzNdOwogCkBAIC0xNjMwLDcgKzE2MzMsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBtYWtlX3RpbWVy
X2RvbVVfbm9kZShjb25zdCBzdHJ1Y3QgZG9tYWluICpkLCB2b2lkICpmZHQpCiAgICAgaWYgKCBy
ZXMgKQogICAgICAgICByZXR1cm4gcmVzOwogCi0gICAgaWYgKCAhaXNfNjRiaXRfZG9tYWluKGQp
ICkKKyAgICBpZiAoICFpc182NGJpdF9kb21haW4oa2luZm8tPmQpICkKICAgICB7CiAgICAgICAg
IHJlcyA9IGZkdF9wcm9wZXJ0eV9zdHJpbmcoZmR0LCAiY29tcGF0aWJsZSIsICJhcm0sYXJtdjct
dGltZXIiKTsKICAgICAgICAgaWYgKCByZXMgKQpAQCAtMTY1Miw3ICsxNjU1LDcgQEAgc3RhdGlj
IGludCBfX2luaXQgbWFrZV90aW1lcl9kb21VX25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwg
dm9pZCAqZmR0KQogICAgICAgICByZXR1cm4gcmVzOwogCiAgICAgcmVzID0gZmR0X3Byb3BlcnR5
X2NlbGwoZmR0LCAiaW50ZXJydXB0LXBhcmVudCIsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgR1VFU1RfUEhBTkRMRV9HSUMpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmZv
LT5ndWVzdF9waGFuZGxlX2dpYyk7CiAgICAgaWYgKHJlcykKICAgICAgICAgcmV0dXJuIHJlczsK
IApAQCAtMTY2Miw4ICsxNjY1LDkgQEAgc3RhdGljIGludCBfX2luaXQgbWFrZV90aW1lcl9kb21V
X25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAqZmR0KQogfQogCiAjaWZkZWYgQ09O
RklHX1NCU0FfVlVBUlRfQ09OU09MRQotc3RhdGljIGludCBfX2luaXQgbWFrZV92cGwwMTFfdWFy
dF9ub2RlKGNvbnN0IHN0cnVjdCBkb21haW4gKmQsIHZvaWQgKmZkdCkKK3N0YXRpYyBpbnQgX19p
bml0IG1ha2VfdnBsMDExX3VhcnRfbm9kZShzdHJ1Y3Qga2VybmVsX2luZm8gKmtpbmZvKQogewor
ICAgIHZvaWQgKmZkdCA9IGtpbmZvLT5mZHQ7CiAgICAgaW50IHJlczsKICAgICBnaWNfaW50ZXJy
dXB0X3QgaW50cjsKICAgICBfX2JlMzIgcmVnW0dVRVNUX1JPT1RfQUREUkVTU19DRUxMUyArIEdV
RVNUX1JPT1RfU0laRV9DRUxMU107CkBAIC0xNjk0LDcgKzE2OTgsNyBAQCBzdGF0aWMgaW50IF9f
aW5pdCBtYWtlX3ZwbDAxMV91YXJ0X25vZGUoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdm9pZCAq
ZmR0KQogICAgICAgICByZXR1cm4gcmVzOwogCiAgICAgcmVzID0gZmR0X3Byb3BlcnR5X2NlbGwo
ZmR0LCAiaW50ZXJydXB0LXBhcmVudCIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgR1VF
U1RfUEhBTkRMRV9HSUMpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmZvLT5ndWVz
dF9waGFuZGxlX2dpYyk7CiAgICAgaWYgKCByZXMgKQogICAgICAgICByZXR1cm4gcmVzOwogCkBA
IC0xNzE5LDYgKzE3MjMsOCBAQCBzdGF0aWMgaW50IF9faW5pdCBwcmVwYXJlX2R0Yl9kb21VKHN0
cnVjdCBkb21haW4gKmQsIHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8pCiAgICAgaW50IGFkZHJj
ZWxscywgc2l6ZWNlbGxzOwogICAgIGludCByZXQ7CiAKKyAgICBraW5mby0+Z3Vlc3RfcGhhbmRs
ZV9naWMgPSBHVUVTVF9QSEFORExFX0dJQzsKKwogICAgIGFkZHJjZWxscyA9IEdVRVNUX1JPT1Rf
QUREUkVTU19DRUxMUzsKICAgICBzaXplY2VsbHMgPSBHVUVTVF9ST09UX1NJWkVfQ0VMTFM7CiAK
QEAgLTE3NjIsMTEgKzE3NjgsMTEgQEAgc3RhdGljIGludCBfX2luaXQgcHJlcGFyZV9kdGJfZG9t
VShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3Qga2VybmVsX2luZm8gKmtpbmZvKQogICAgIGlmICgg
cmV0ICkKICAgICAgICAgZ290byBlcnI7CiAKLSAgICByZXQgPSBtYWtlX2dpY19kb21VX25vZGUo
ZCwga2luZm8tPmZkdCk7CisgICAgcmV0ID0gbWFrZV9naWNfZG9tVV9ub2RlKGtpbmZvKTsKICAg
ICBpZiAoIHJldCApCiAgICAgICAgIGdvdG8gZXJyOwogCi0gICAgcmV0ID0gbWFrZV90aW1lcl9k
b21VX25vZGUoZCwga2luZm8tPmZkdCk7CisgICAgcmV0ID0gbWFrZV90aW1lcl9kb21VX25vZGUo
a2luZm8pOwogICAgIGlmICggcmV0ICkKICAgICAgICAgZ290byBlcnI7CiAKQEAgLTE3NzQsNyAr
MTc4MCw3IEBAIHN0YXRpYyBpbnQgX19pbml0IHByZXBhcmVfZHRiX2RvbVUoc3RydWN0IGRvbWFp
biAqZCwgc3RydWN0IGtlcm5lbF9pbmZvICpraW5mbykKICAgICB7CiAgICAgICAgIHJldCA9IC1F
SU5WQUw7CiAjaWZkZWYgQ09ORklHX1NCU0FfVlVBUlRfQ09OU09MRQotICAgICAgICByZXQgPSBt
YWtlX3ZwbDAxMV91YXJ0X25vZGUoZCwga2luZm8tPmZkdCk7CisgICAgICAgIHJldCA9IG1ha2Vf
dnBsMDExX3VhcnRfbm9kZShraW5mbyk7CiAjZW5kaWYKICAgICAgICAgaWYgKCByZXQgKQogICAg
ICAgICAgICAgZ290byBlcnI7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20tYXJtL2tlcm5l
bC5oIGIveGVuL2luY2x1ZGUvYXNtLWFybS9rZXJuZWwuaAppbmRleCAzM2YzZTcyYjExLi43NjA0
MzQzNjliIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20tYXJtL2tlcm5lbC5oCisrKyBiL3hl
bi9pbmNsdWRlL2FzbS1hcm0va2VybmVsLmgKQEAgLTM2LDYgKzM2LDkgQEAgc3RydWN0IGtlcm5l
bF9pbmZvIHsKICAgICAvKiBFbmFibGUgcGwwMTEgZW11bGF0aW9uICovCiAgICAgYm9vbCB2cGww
MTE7CiAKKyAgICAvKiBHSUMgcGhhbmRsZSAqLworICAgIHVpbnQzMl90IGd1ZXN0X3BoYW5kbGVf
Z2ljOworCiAgICAgLyogbG9hZGVyIHRvIHVzZSBmb3IgdGhpcyBrZXJuZWwgKi8KICAgICB2b2lk
ICgqbG9hZCkoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvKTsKICAgICAvKiBsb2FkZXIgc3BlY2lm
aWMgc3RhdGUgKi8KLS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhl
bnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5m
by94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 0C1D5E49A6
	for <lists+xen-devel@lfdr.de>; Fri, 25 Oct 2019 13:15:16 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iNxVb-0002oT-9k; Fri, 25 Oct 2019 11:11:55 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=PbB1=YS=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iNxVZ-0002mC-8a
 for xen-devel@lists.xen.org; Fri, 25 Oct 2019 11:11:53 +0000
X-Inumbo-ID: 18ef2a50-f718-11e9-beca-bc764e2007e4
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 18ef2a50-f718-11e9-beca-bc764e2007e4;
 Fri, 25 Oct 2019 11:10:48 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUO-0001X4-7z; Fri, 25 Oct 2019 11:10:40 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUO-0002mf-4u; Fri, 25 Oct 2019 11:10:40 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iNxUO-0002mf-4u@xenbits.xenproject.org>
Date: Fri, 25 Oct 2019 11:10:40 +0000
Subject: [Xen-devel] Xen Security Advisory 293 v4 (CVE-2019-17347) - x86: PV
 kernel context switch corruption
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-17347 / XSA-293
                              version 4

                x86: PV kernel context switch corruption

UPDATES IN VERSION 4
====================

Correct affected versions statement.

CVE assigned.

ISSUE DESCRIPTION
=================

On hardware supporting the fsgsbase feature, 64bit PV guests can set and
clear the applicable control bit in its virtualised %cr4, but the
feature remains fully active in hardware.  Therefore, the associated
instructions are actually usable.

Linux, which does not currently support this feature, has various
optimisations in its context switch path which justifiably assume that
userspace can't actually make changes without a system call.

Xen's behaviour of having this feature active behind the guest kernel's
back undermines the correctness of any context switch logic which
depends on the feature being disabled.

Userspace can therefore corrupt fsbase or gsbase (commonly used for
Thread Local Storage) in the next thread to be scheduled on the
current vcpu.

IMPACT
======

A malicious unprivileged guest userspace process can escalate its
privilege to that of other userspace processes in the same guest, and
potentially thereby to that of the guest operating system.

Additionally, some guest software which attempts to use this CPU
feature may trigger the bug accidentally, leading to crashes or
corruption of other processes in the same guest.

VULNERABLE SYSTEMS
==================

Xen versions 4.4 and later are vulnerable.  Xen 4.3 and earlier are not
vulnerable.

Only x86 hardware with the fsgsbase feature is vulnerable.  This is
believed to be Intel IvyBridge and later hardware, and AMD Steamroller
and later hardware.

ARM hardware is not affected.

Only 64bit PV guests can exploit the vulnerability.  32bit PV guests,
and HVM/PVH guests cannot exploit the vulnerability.

Whether the bug is exploitable, and whether it will be triggered by
accident, depend in a complicated way on the guest operating system
and its configuration.  Most guests are vulnerable to malicious
userspace processes.

MITIGATION
==========

Running only 32bit PV or HVM/PVH guests will avoid this vulnerability.

CREDITS
=======

This issue was discovered by Andy Lutomirski.

RESOLUTION
==========

Applying the appropriate attached patches resolves this issue.

xsa293/unstable-?.patch         xen-unstable
xsa293/4.11-?.patch             Xen 4.11.x
xsa293/4.10-?.patch             Xen 4.10.x
xsa293/4.9-?.patch              Xen 4.9.x
xsa293/4.8-?.patch              Xen 4.8.x
xsa293/4.7-?.patch              Xen 4.7.x

$ sha256sum xsa293* xsa293*/*
27baf055642a3a7e9d2b1a961e15a46b592eca7c6f63e28e3bcb19e4cebfd0bd  xsa293.meta
865596b3dca81712a7d3d78f22e40aed1a08732f93b1950af6f092d893323a0f  xsa293/4.7-1.patch
032559c4bbdfe0987b9d3b15cf8661d8d8a5d4e2e989c944490ac171305fba3b  xsa293/4.7-2.patch
d3d91a1a5083b0a1992750b808aefacd0f0d4e7e92d1436e620a542e935cdadd  xsa293/4.7-3.patch
14b3db49375e353394b831a342d873d83615285d516f8cb08a0e1564d675cd51  xsa293/4.8-1.patch
1efc2ee18f54c7c41f478e944b3b708eb283bfa9de68a1046033d57784846c30  xsa293/4.8-2.patch
0d28899cad0e6798ae6a96717c15363ddf5a35e334ede02becdc81538ae589cc  xsa293/4.8-3.patch
b24210a74eb9dca5c7af902d223dba1b1b372df06a99fb1b0df8e92c9f9632f3  xsa293/4.9-1.patch
f68101f80d9843c1cdbb70188caec7009a0d52d33d811d22091e7c1f265a15e1  xsa293/4.9-2.patch
194e42599eac16afab14856760901705a0600c1308645495f30d30f8dd68734c  xsa293/4.10-1.patch
1fdee59bba66bd6b3ea4949913457dbcb1b8d5cb85fd8fb60aacac9a403ee9a9  xsa293/4.10-2.patch
277ba95e9a2276378fc9b3bcf89b694b9670256cde62278ade2e90d3fd5f7c46  xsa293/4.11-1.patch
724a0f433427a747876cbec09381dc1ca99286cea0ecbdd098c6e68fb135eeda  xsa293/4.11-2.patch
837eb67900a7c70cf7a00836cb312506925ca1fd29529144ff312316b0dbb086  xsa293/unstable-1.patch
0a6df8c8778a1c7e1fb71825695a86dee36f2e9345b39a06e3a364ad8b938de0  xsa293/unstable-2.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl2y1+8MHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZ+v0H/21IMJyzcEdBt5Ki3zJ4gWL5XKxzy7p5r8IyvLto
KulFRzMU2gopsrSji394Inl+iydSEgSRGNMytpJ6HlYmAH+O5xJe3BVsLyf4tvTO
ONTs72xin6mm3h/cUSVtLzTfLAYX6AA37uy/kqUOGH9Bn1VDNhKFDwTjwb7riaDe
cHpvCaQJGK9HBYjzD8HyAfh0nKupgLb19FdG5r2CjXqyHK1A+bC3LPdOc9jfNYrY
YP4LV0nSU5XOBi6RrOSXySadvQQTXtaFACtpcRGQEhrXKmO+bUCQiyJzn2JtmxZP
7uMN9OqR6idl3mxgBb1QiHfxIFw2NB/MC6BoTBn4+Ea7yJk=
=cxjY
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa293.meta"
Content-Disposition: attachment; filename="xsa293.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyOTMsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIsCiAgICAiNC45IiwK
ICAgICI0LjgiLAogICAgIjQuNyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4
ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICJhMDE2YjhmMjA3YzdhM2ZlOGJkZDJiNmY3YzA4MDAyMGUzZTFj
ODIzIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAyODQs
CiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAogICAgICAgICAg
ICAyODgsCiAgICAgICAgICAgIDI5MCwKICAgICAgICAgICAgMjkxLAogICAg
ICAgICAgICAyOTIKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6
IFsKICAgICAgICAgICAgInhzYTI5My80LjEwLT8ucGF0Y2giCiAgICAgICAg
ICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTEiOiB7CiAg
ICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAi
U3RhYmxlUmVmIjogIjg3ZjUxYmYzNjZjYTc5Yjk4ZTFlMjAxYmY5YmQ3YTlj
MTY0NjMxZTIiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAg
IDI4NCwKICAgICAgICAgICAgMjg1LAogICAgICAgICAgICAyODcsCiAgICAg
ICAgICAgIDI4OCwKICAgICAgICAgICAgMjkwLAogICAgICAgICAgICAyOTEs
CiAgICAgICAgICAgIDI5MgogICAgICAgICAgXSwKICAgICAgICAgICJQYXRj
aGVzIjogWwogICAgICAgICAgICAieHNhMjkzLzQuMTEtPy5wYXRjaCIKICAg
ICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC43Ijog
ewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAg
ICAgIlN0YWJsZVJlZiI6ICI3MTBjYzA5Njk3MTAxOWJjMmU1YTlhYWJiOWFm
MWFjY2EwYjViOWU3IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAg
ICAgICAyODQsCiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAog
ICAgICAgICAgICAyODgsCiAgICAgICAgICAgIDI5MCwKICAgICAgICAgICAg
MjkyCiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAg
ICAgICAgICJ4c2EyOTMvNC43LT8ucGF0Y2giCiAgICAgICAgICBdCiAgICAg
ICAgfQogICAgICB9CiAgICB9LAogICAgIjQuOCI6IHsKICAgICAgIlJlY2lw
ZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYi
OiAiOTA4ZTc2OGZhZTQ5YThkYjAwODllNjgxODg2NTIwNzllM2JmYWE2NiIs
CiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjg0LAogICAg
ICAgICAgICAyODUsCiAgICAgICAgICAgIDI4NywKICAgICAgICAgICAgMjg4
LAogICAgICAgICAgICAyOTAsCiAgICAgICAgICAgIDI5MSwKICAgICAgICAg
ICAgMjkyCiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAg
ICAgICAgICAgICJ4c2EyOTMvNC44LT8ucGF0Y2giCiAgICAgICAgICBdCiAg
ICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuOSI6IHsKICAgICAgIlJl
Y2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVS
ZWYiOiAiZjVhY2Y5N2Y2NjljNmJjOTY5MWUwMzc3MWFkMDY3MDNkYTc3ZTBk
NSIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjg0LAog
ICAgICAgICAgICAyODUsCiAgICAgICAgICAgIDI4NywKICAgICAgICAgICAg
Mjg4LAogICAgICAgICAgICAyOTAsCiAgICAgICAgICAgIDI5MSwKICAgICAg
ICAgICAgMjkyCiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBb
CiAgICAgICAgICAgICJ4c2EyOTMvNC45LT8ucGF0Y2giCiAgICAgICAgICBd
CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIm1hc3RlciI6IHsKICAg
ICAgIlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJT
dGFibGVSZWYiOiAiMjRkNTI4MjUyN2Y0NjQ3OTA3YjM1NzI4MjBiNTMzNWMx
NWNkMDM1NiIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAg
Mjg0LAogICAgICAgICAgICAyODUsCiAgICAgICAgICAgIDI4NywKICAgICAg
ICAgICAgMjg4LAogICAgICAgICAgICAyOTAsCiAgICAgICAgICAgIDI5MSwK
ICAgICAgICAgICAgMjkyCiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNo
ZXMiOiBbCiAgICAgICAgICAgICJ4c2EyOTMvdW5zdGFibGUtPy5wYXRjaCIK
ICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0=

--=separator
Content-Type: application/octet-stream; name="xsa293/4.7-1.patch"
Content-Disposition: attachment; filename="xsa293/4.7-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBJbXByb3ZlIHB2X2NwdWlkKCkncyBBUEkK
CnB2X2NwdWlkKCkncyBBUEkgaXMgYXdrd2FyZCB0byB1c2UuICBUaGVyZSBh
cmUgYWxyZWFkeSB0d28gY2FsbGVycyBqdW1waW5nCnRocm91Z2ggaG9vcHMg
dG8gdXNlIGl0LCBhbmQgYSB0aGlyZCBpcyBvbiBpdHMgd2F5LgoKQ2hhbmdl
IHRoZSBBUEkgdG8gdGFrZSBlYWNoIHBhcmFtZXRlciBpbmRpdmlkdWFsbHkg
KGxpa2UgaXRzIGNvdW50ZXJwYXJ0LApodm1fY3B1aWQoKSwgYWxyZWFkeSBk
b2VzKSwgYW5kIGludHJvZHVjZSBhIG5ldyBwdl9jcHVpZF9yZWdzKCkgd3Jh
cHBlcgppbXBsZW1lbnRpbmcgdGhlIG9sZCBBUEkuCgpObyBmdW5jdGlvbmFs
IGNoYW5nZS4KClNpZ25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gv
eDg2L2h2bS92bXgvdm14LmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXgu
YwppbmRleCA4MmUzYzJjLi41OTM5NWRkIDEwMDY0NAotLS0gYS94ZW4vYXJj
aC94ODYvaHZtL3ZteC92bXguYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3Zt
eC92bXguYwpAQCAtMzY5OCw3ICszNjk4LDcgQEAgdm9pZCB2bXhfdm1leGl0
X2hhbmRsZXIoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiAgICAgICAg
IGJyZWFrOwogICAgIH0KICAgICBjYXNlIEVYSVRfUkVBU09OX0NQVUlEOgot
ICAgICAgICBpc19wdmhfdmNwdSh2KSA/IHB2X2NwdWlkKHJlZ3MpIDogdm14
X2RvX2NwdWlkKHJlZ3MpOworICAgICAgICBpc19wdmhfdmNwdSh2KSA/IHB2
X2NwdWlkX3JlZ3MocmVncykgOiB2bXhfZG9fY3B1aWQocmVncyk7CiAgICAg
ICAgIHVwZGF0ZV9ndWVzdF9laXAoKTsgLyogU2FmZTogQ1BVSUQgKi8KICAg
ICAgICAgYnJlYWs7CiAgICAgY2FzZSBFWElUX1JFQVNPTl9ITFQ6CmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvdHJhcHMuYyBiL3hlbi9hcmNoL3g4Ni90
cmFwcy5jCmluZGV4IDEzOTczN2IuLmMwMDFmOTMgMTAwNjQ0Ci0tLSBhL3hl
bi9hcmNoL3g4Ni90cmFwcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni90cmFwcy5j
CkBAIC05MjQsMTcgKzkyNCwxNCBAQCBzdGF0aWMgdm9pZCBfZG9tYWluX2Nw
dWlkKHN0cnVjdCBkb21haW4gKmN1cnJkLAogICAgICAgICBjcHVpZF9jb3Vu
dChsZWFmLCBzdWJsZWFmLCBlYXgsIGVieCwgZWN4LCBlZHgpOwogfQogCi12
b2lkIHB2X2NwdWlkKHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQordm9p
ZCBwdl9jcHVpZCh1aW50MzJfdCBsZWFmLCB1aW50MzJfdCBzdWJsZWFmLAor
ICAgICAgICAgICAgICB1aW50MzJfdCAqZWF4LCB1aW50MzJfdCAqZWJ4LCB1
aW50MzJfdCAqZWN4LCB1aW50MzJfdCAqZWR4KQogewotICAgIHVpbnQzMl90
IGxlYWYsIHN1YmxlYWYsIGEsIGIsIGMsIGQ7CisgICAgdWludDMyX3QgYSwg
YiwgYywgZDsKKyAgICBjb25zdCBzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVn
cyA9IGd1ZXN0X2NwdV91c2VyX3JlZ3MoKTsKICAgICBzdHJ1Y3QgdmNwdSAq
Y3VyciA9IGN1cnJlbnQ7CiAgICAgc3RydWN0IGRvbWFpbiAqY3VycmQgPSBj
dXJyLT5kb21haW47CiAKLSAgICBsZWFmID0gYSA9IHJlZ3MtPmVheDsKLSAg
ICBiID0gcmVncy0+ZWJ4OwotICAgIHN1YmxlYWYgPSBjID0gcmVncy0+ZWN4
OwotICAgIGQgPSByZWdzLT5lZHg7Ci0KICAgICBpZiAoIGNwdWlkX2h5cGVy
dmlzb3JfbGVhdmVzKGxlYWYsIHN1YmxlYWYsICZhLCAmYiwgJmMsICZkKSAp
CiAgICAgICAgIGdvdG8gb3V0OwogCkBAIC0xMjAwLDE3ICsxMTk3LDIxIEBA
IHZvaWQgcHZfY3B1aWQoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiAg
ICAgY2FzZSAweDgwMDAwMDFlOiAvKiBFeHRlbmRlZCB0b3BvbG9neSByZXBv
cnRpbmcgKi8KICAgICB1bnN1cHBvcnRlZDoKICAgICAgICAgYSA9IGIgPSBj
ID0gZCA9IDA7Ci0gICAgICAgIGJyZWFrOworICAgICAgICBnb3RvIG91dDsK
ICAgICB9CiAKLSBvdXQ6CiAgICAgLyogVlBNVSBtYXkgZGVjaWRlIHRvIG1v
ZGlmeSBzb21lIG9mIHRoZSBsZWF2ZXMgKi8KICAgICB2cG11X2RvX2NwdWlk
KGxlYWYsICZhLCAmYiwgJmMsICZkKTsKIAotICAgIHJlZ3MtPmVheCA9IGE7
Ci0gICAgcmVncy0+ZWJ4ID0gYjsKLSAgICByZWdzLT5lY3ggPSBjOwotICAg
IHJlZ3MtPmVkeCA9IGQ7Cisgb3V0OgorICAgIGlmICggZWF4ICkKKyAgICAg
ICAgKmVheCA9IGE7CisgICAgaWYgKCBlYnggKQorICAgICAgICAqZWJ4ID0g
YjsKKyAgICBpZiAoIGVjeCApCisgICAgICAgICplY3ggPSBjOworICAgIGlm
ICggZWR4ICkKKyAgICAgICAgKmVkeCA9IGQ7CiB9CiAKIHN0YXRpYyBpbnQg
ZW11bGF0ZV9pbnZhbGlkX3JkdHNjcChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAq
cmVncykKQEAgLTEyNjAsNyArMTI2MSw3IEBAIHN0YXRpYyBpbnQgZW11bGF0
ZV9mb3JjZWRfaW52YWxpZF9vcChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVn
cykKICAgICAgICAgcmV0dXJuIDA7CiAgICAgZWlwICs9IHNpemVvZihpbnN0
cik7CiAKLSAgICBwdl9jcHVpZChyZWdzKTsKKyAgICBwdl9jcHVpZF9yZWdz
KHJlZ3MpOwogCiAgICAgaW5zdHJ1Y3Rpb25fZG9uZShyZWdzLCBlaXAsIDAp
OwogCkBAIC0zMTM1LDcgKzMxMzYsNyBAQCBzdGF0aWMgaW50IGVtdWxhdGVf
cHJpdmlsZWdlZF9vcChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncykKICAg
ICAgICAgYnJlYWs7CiAKICAgICBjYXNlIDB4YTI6IC8qIENQVUlEICovCi0g
ICAgICAgIHB2X2NwdWlkKHJlZ3MpOworICAgICAgICBwdl9jcHVpZF9yZWdz
KHJlZ3MpOwogICAgICAgICBicmVhazsKIAogICAgIGRlZmF1bHQ6CmRpZmYg
LS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nlc3Nvci5oIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaAppbmRleCAxNGJlZDkyLi42
YTM1Yjg5IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nl
c3Nvci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcHJvY2Vzc29yLmgK
QEAgLTY0OSw3ICs2NDksMTQgQEAgZW51bSBnZXRfY3B1X3ZlbmRvciB7CiB9
OwogCiBpbnQgZ2V0X2NwdV92ZW5kb3IoY29uc3QgY2hhciB2ZW5kb3JfaWRb
XSwgZW51bSBnZXRfY3B1X3ZlbmRvcik7Ci12b2lkIHB2X2NwdWlkKHN0cnVj
dCBjcHVfdXNlcl9yZWdzICpyZWdzKTsKK3ZvaWQgcHZfY3B1aWQodWludDMy
X3QgbGVhZiwgdWludDMyX3Qgc3VibGVhZiwKKyAgICAgICAgICAgICAgdWlu
dDMyX3QgKmVheCwgdWludDMyX3QgKmVieCwgdWludDMyX3QgKmVjeCwgdWlu
dDMyX3QgKmVkeCk7CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBwdl9jcHVpZF9y
ZWdzKHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQoreworICAgIHB2X2Nw
dWlkKHJlZ3MtPl9lYXgsIHJlZ3MtPl9lY3gsCisgICAgICAgICAgICAgJnJl
Z3MtPl9lYXgsICZyZWdzLT5fZWJ4LCAmcmVncy0+X2VjeCwgJnJlZ3MtPl9l
ZHgpOworfQogCiAjZW5kaWYgLyogIV9fQVNTRU1CTFlfXyAqLwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa293/4.7-2.patch"
Content-Disposition: attachment; filename="xsa293/4.7-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBSZXdyaXRlIGd1ZXN0ICVjcjQgaGFuZGxp
bmcgZnJvbSBzY3JhdGNoCgpUaGUgUFYgY3I0IGxvZ2ljIGlzIGFsbW9zdCBp
bXBvc3NpYmxlIHRvIGZvbGxvdywgYW5kIGxlYWtzIGJpdHMgaW50byBndWVz
dApjb250ZXh0IHdoaWNoIGRlZmluaXRlbHkgc2hvdWxkbid0IGJlIHZpc2li
bGUgKGluIHBhcnRpY3VsYXIsIFZNWEUpLgoKVGhlIGJpZ2dlc3QgcHJvYmxl
bSBob3dldmVyLCBhbmQgc291cmNlIG9mIHRoZSBjb21wbGV4aXR5LCBpcyB0
aGF0IGl0IGRlcml2ZXMKbmV3IHJlYWwgYW5kIGd1ZXN0IGNyNCB2YWx1ZXMg
ZnJvbSB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZSAtIHRoaXMgaXMK
Y29udGV4dCBkZXBlbmRlbnQgYW5kIGFuIGluYXBwcm9wcmlhdGUgc291cmNl
IG9mIGluZm9ybWF0aW9uLgoKUmV3cml0ZSB0aGUgY3I0IGxvZ2ljIHRvIGJl
IGludmFyaWFudCBvZiB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZS4K
CkZpcnN0IG9mIGFsbCwgbW9kaWZ5IHdyaXRlX3B0YmFzZSgpIHRvIGFsd2F5
cyB1c2UgbW11X2NyNF9mZWF0dXJlcyBmb3IgSURMRQphbmQgSFZNIGNvbnRl
eHRzLiAgbW11X2NyNF9mZWF0dXJlcyAqaXMqIHRoZSBjb3JyZWN0IHZhbHVl
IHRvIHVzZSwgYW5kIG1ha2VzCnRoZSBBU1NFUlQoKSBvYnZpb3VzbHkgcmVk
dW5kYW50LgoKRm9yIFBWIGd1ZXN0cywgY3Vyci0+YXJjaC5wdi5jdHJscmVn
WzRdIHJlbWFpbnMgdGhlIGd1ZXN0cyB2aWV3IG9mIGNyNCwgYnV0CmFsbCBs
b2dpYyBnZXRzIHJld29ya2VkIGluIHRlcm1zIG9mIHRoaXMgYW5kIG1tdV9j
cjRfZmVhdHVyZXMgb25seS4KClR3byBtYXNrcyBhcmUgaW50cm9kdWNlZDsg
Yml0cyB3aGljaCB0aGUgZ3Vlc3QgaGFzIGNvbnRyb2wgb3ZlciwgYW5kIGJp
dHMKd2hpY2ggYXJlIGZvcndhcmRlZCBmcm9tIFhlbidzIHNldHRpbmdzLiAg
T25lIGd1ZXN0LXZpc2libGUgY2hhbmdlIGhlcmUgaXMKdGhhdCBYZW4ncyBW
TVhFIHNldHRpbmcgaXMgbm8gbG9uZ2VyIHZpc2libGUgYXQgYWxsLgoKcHZf
bWFrZV9jcjQoKSBmb2xsb3dzIGZhaXJseSBjbG9zZWx5IGZyb20gcHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KCksIGJ1dApkZWxpYmVyYXRlbHkgc3RhcnRz
IHdpdGggbW11X2NyNF9mZWF0dXJlcywgYW5kIG9ubHkgYWx0ZXJzIHRoZSBt
aW5pbWFsIHN1YnNldApvZiBiaXRzLgoKVGhlIGJvb3QtdGltZSB7Y29tcGF0
Xyx9cHZfY3I0X21hc2sgdmFyaWFibGVzIGFyZSByZW1vdmVkLCBhcyB0aGV5
IGFyZSBhCnJlbW5hbnQgb2YgdGhlIHByZS1DUFVJRCBwb2xpY3kgZGF5cy4g
IHB2X2ZpeHVwX2d1ZXN0X2NyNCgpIGdhaW5zIGEgcmVsYXRlZApkZXJpdmF0
aW9uIGZyb20gdGhlIHBvbGljeS4KCkFub3RoZXIgZ3Vlc3QgdmlzaWJsZSBj
aGFuZ2UgaGVyZSBpcyB0aGF0IGEgMzJiaXQgUFYgZ3Vlc3QgY2FuIG5vdyBm
bGlwCkZTR1NCQVNFIGluIGl0cyB2aWV3IG9mIENSNC4gIFdoaWxlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25zIGFyZQp1bnVzYWJsZSBv
dXRzaWRlIG9mIGEgNjRiaXQgY29kZSBzZWdtZW50LCB0aGUgYWJpbGl0eSB0
byBtb2RpZnkgRlNHU0JBU0UKbWF0Y2hlcyByZWFsIGhhcmR3YXJlIGJlaGF2
aW91ciwgYW5kIGF2b2lkcyB0aGUgbmVlZCBmb3IgYW55IDMyYml0LzY0Yml0
CmRpZmZlcmVuY2VzIGluIHRoZSBsb2dpYy4KCk92ZXJhbGwsIHRoaXMgcGF0
Y2ggc2hvdWxkbid0IGhhdmUgYSBwcmFjdGljYWwgY2hhbmdlIGluIGd1ZXN0
IGJlaGF2aW91ci4KVk1YRSB3aWxsIGRpc2FwcGVhciBmcm9tIHZpZXcsIGFu
ZCBhbiBpbnF1aXNpdGl2ZSAzMmJpdCBrZXJuZWwgY2FuIG5vdyBzZWUKRlNH
U0JBU0UgY2hhbmdpbmcsIGJ1dCB0aGlzIG5ldyBsb2dpYyBpcyBvdGhlcndp
c2UgYnVnLWNvbXBhdGlibGUgd2l0aCBiZWZvcmUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTI5MwoKUmVwb3J0ZWQtYnk6IEFuZHkgTHV0b21pcnNraSA8bHV0
b0BrZXJuZWwub3JnPgpTaWduZWQtb2ZmLWJ5OiBBbmRyZXcgQ29vcGVyIDxh
bmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpSZXZpZXdlZC1ieTogSmFuIEJl
dWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9kb21haW4uYyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwppbmRl
eCA5MzhmY2UwLi44ZGRiMTJjIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
ZG9tYWluLmMKKysrIGIveGVuL2FyY2gveDg2L2RvbWFpbi5jCkBAIC0zNzcs
NiArMzc3LDYzIEBAIHN0YXRpYyB2b2lkIHJlbGVhc2VfY29tcGF0X2w0KHN0
cnVjdCB2Y3B1ICp2KQogICAgIHYtPmFyY2guZ3Vlc3RfdGFibGVfdXNlciA9
IHBhZ2V0YWJsZV9udWxsKCk7CiB9CiAKK3Vuc2lnbmVkIGxvbmcgcHZfZml4
dXBfZ3Vlc3RfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBs
b25nIGNyNCkKK3sKKyAgICB1bnNpZ25lZCBpbnQgbGVhZjFfZWN4ID0gMCwg
bGVhZjFfZWR4ID0gMDsKKyAgICB1bnNpZ25lZCBpbnQgbGVhZjdfMF9lYngg
PSAwLCBsZXZlbCA9IDA7CisKKyAgICBwdl9jcHVpZCgwLCAwLCAmbGV2ZWws
IE5VTEwsIE5VTEwsIE5VTEwpOworICAgIGlmICggbGV2ZWwgPj0gMSApCisg
ICAgICAgIHB2X2NwdWlkKDEsIDAsIE5VTEwsIE5VTEwsICZsZWFmMV9lY3gs
ICZsZWFmMV9lZHgpOworICAgIGlmICggbGV2ZWwgPj0gNyApCisgICAgICAg
IHB2X2NwdWlkKDcsIDAsIE5VTEwsICZsZWFmN18wX2VieCwgTlVMTCwgTlVM
TCk7CisKKyAgICAvKiBEaXNjYXJkIGF0dGVtcHRzIHRvIHNldCBndWVzdCBj
b250cm9sbGFibGUgYml0cyBvdXRzaWRlIG9mIHRoZSBwb2xpY3kuICovCisg
ICAgY3I0ICY9IH4oKChsZWFmMV9lZHggJiBjcHVmZWF0X21hc2soWDg2X0ZF
QVRVUkVfVFNDKSkKKyAgICAgICAgICAgICAgPyAwIDogWDg2X0NSNF9UU0Qp
IHwKKyAgICAgICAgICAgICAoKGxlYWYxX2VkeCAmIGNwdWZlYXRfbWFzayhY
ODZfRkVBVFVSRV9ERSkpCisgICAgICAgICAgICAgID8gMCA6IFg4Nl9DUjRf
REUpIHwKKyAgICAgICAgICAgICAoKGxlYWY3XzBfZWJ4ICYgY3B1ZmVhdF9t
YXNrKFg4Nl9GRUFUVVJFX0ZTR1NCQVNFKSkKKyAgICAgICAgICAgICAgPyAw
IDogWDg2X0NSNF9GU0dTQkFTRSkgfAorICAgICAgICAgICAgICgobGVhZjFf
ZWN4ICYgY3B1ZmVhdF9tYXNrKFg4Nl9GRUFUVVJFX1hTQVZFKSkKKyAgICAg
ICAgICAgICAgPyAwIDogWDg2X0NSNF9PU1hTQVZFKSk7CisKKyAgICAvKiBN
YXNrcyBleHBlY3RlZCB0byBiZSBkaXNqb2ludCBzZXRzLiAqLworICAgIEJV
SUxEX0JVR19PTihQVl9DUjRfR1VFU1RfTUFTSyAmIFBWX0NSNF9HVUVTVF9W
SVNJQkxFX01BU0spOworCisgICAgLyoKKyAgICAgKiBBIGd1ZXN0IHNlZXMg
dGhlIHBvbGljeSBzdWJzZXQgb2YgaXRzIG93biBjaG9pY2Ugb2YgZ3Vlc3Qg
Y29udHJvbGxhYmxlCisgICAgICogYml0cywgYW5kIGEgc3Vic2V0IG9mIFhl
bidzIGNob2ljZSBvZiBjZXJ0YWluIGhhcmR3YXJlIHNldHRpbmdzLgorICAg
ICAqLworICAgIHJldHVybiAoKGNyNCAmIFBWX0NSNF9HVUVTVF9NQVNLKSB8
CisgICAgICAgICAgICAobW11X2NyNF9mZWF0dXJlcyAmIFBWX0NSNF9HVUVT
VF9WSVNJQkxFX01BU0spKTsKK30KKwordW5zaWduZWQgbG9uZyBwdl9tYWtl
X2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdikKK3sKKyAgICBjb25zdCBzdHJ1
Y3QgZG9tYWluICpkID0gdi0+ZG9tYWluOworICAgIHVuc2lnbmVkIGxvbmcg
Y3I0ID0gbW11X2NyNF9mZWF0dXJlcyAmCisgICAgICAgIH4oWDg2X0NSNF9Q
Q0lERSB8IFg4Nl9DUjRfUEdFIHwgWDg2X0NSNF9UU0QpOworCisgICAgLyoK
KyAgICAgKiBQQ0lERSBvciBQR0UgZGVwZW5kcyBvbiB0aGUgUENJRC9YUFRJ
IHNldHRpbmdzLCBidXQgbXVzdCBub3QgYm90aCBiZQorICAgICAqIHNldCwg
YXMgaXQgaW1wYWN0cyB0aGUgc2FmZXR5IG9mIFRMQiBmbHVzaGluZy4KKyAg
ICAgKi8KKyAgICBpZiAoIGQtPmFyY2gucHZfZG9tYWluLnBjaWQgKQorICAg
ICAgICBjcjQgfD0gWDg2X0NSNF9QQ0lERTsKKyAgICBlbHNlIGlmICggIWQt
PmFyY2gucHZfZG9tYWluLnhwdGkgKQorICAgICAgICBjcjQgfD0gWDg2X0NS
NF9QR0U7CisKKyAgICAvKgorICAgICAqIFRTRCBpcyBuZWVkZWQgaWYgZWl0
aGVyIHRoZSBndWVzdCBoYXMgZWxlY3RlZCB0byB1c2UgaXQsIG9yIFhlbiBp
cworICAgICAqIHZpcnR1YWxpc2luZyB0aGUgVFNDIHZhbHVlIHRoZSBndWVz
dCBzZWVzLgorICAgICAqLworICAgIGlmICggZC0+YXJjaC52dHNjIHx8ICh2
LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSAmIFg4Nl9DUjRfVFNEKSApCisg
ICAgICAgIGNyNCB8PSBYODZfQ1I0X1RTRDsKKworICAgIHJldHVybiBjcjQ7
Cit9CisKIHN0YXRpYyB2b2lkIHNldF9kb21haW5feHB0aShzdHJ1Y3QgZG9t
YWluICpkKQogewogICAgIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICkK
QEAgLTU1MSw2ICs2MDgsOCBAQCBpbnQgdmNwdV9pbml0aWFsaXNlKHN0cnVj
dCB2Y3B1ICp2KQogCiAgICAgICAgIC8qIFBWIGd1ZXN0cyBieSBkZWZhdWx0
IGhhdmUgYSAxMDBIeiB0aWNrZXIuICovCiAgICAgICAgIHYtPnBlcmlvZGlj
X3BlcmlvZCA9IE1JTExJU0VDUygxMCk7CisKKyAgICAgICAgdi0+YXJjaC5w
dl92Y3B1LmN0cmxyZWdbNF0gPSBwdl9maXh1cF9ndWVzdF9jcjQodiwgMCk7
CiAgICAgfQogCiAgICAgdi0+YXJjaC5zY2hlZHVsZV90YWlsID0gY29udGlu
dWVfbm9uaWRsZV9kb21haW47CkBAIC01NjMsOCArNjIyLDYgQEAgaW50IHZj
cHVfaW5pdGlhbGlzZShzdHJ1Y3QgdmNwdSAqdikKICAgICAgICAgdi0+YXJj
aC5jcjMgICAgICAgICAgID0gX19wYShpZGxlX3BnX3RhYmxlKTsKICAgICB9
CiAKLSAgICB2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHJlYWxfY3I0
X3RvX3B2X2d1ZXN0X2NyNChtbXVfY3I0X2ZlYXR1cmVzKTsKLQogICAgIGlm
ICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICkKICAgICB7CiAgICAgICAgIGlm
ICggKHJjID0gc2V0dXBfY29tcGF0X2FyZ194bGF0KHYpKSApCkBAIC05Mzcs
NDkgKzk5NCw2IEBAIGludCBhcmNoX2RvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVj
dCBkb21haW4gKmQpCiAgICAgcmV0dXJuIHJldDsKIH0KIAotLyoKLSAqIFRo
ZXNlIGFyZSB0aGUgbWFza3Mgb2YgQ1I0IGJpdHMgKHN1YmplY3QgdG8gaGFy
ZHdhcmUgYXZhaWxhYmlsaXR5KSB3aGljaCBhCi0gKiBQViBndWVzdCBtYXkg
bm90IGxlZ2l0aW1pYXRlbHkgYXR0ZW1wdCB0byBtb2RpZnkuCi0gKi8KLXN0
YXRpYyB1bnNpZ25lZCBsb25nIF9fcmVhZF9tb3N0bHkgcHZfY3I0X21hc2ss
IGNvbXBhdF9wdl9jcjRfbWFzazsKLQotc3RhdGljIGludCBfX2luaXQgaW5p
dF9wdl9jcjRfbWFza3Modm9pZCkKLXsKLSAgICB1bnNpZ25lZCBsb25nIGNv
bW1vbl9tYXNrID0gflg4Nl9DUjRfVFNEOwotCi0gICAgLyoKLSAgICAgKiBB
bGwgUFYgZ3Vlc3RzIG1heSBhdHRlbXB0IHRvIG1vZGlmeSBUU0QsIERFIGFu
ZCBPU1hTQVZFLgotICAgICAqLwotICAgIGlmICggY3B1X2hhc19kZSApCi0g
ICAgICAgIGNvbW1vbl9tYXNrICY9IH5YODZfQ1I0X0RFOwotICAgIGlmICgg
Y3B1X2hhc194c2F2ZSApCi0gICAgICAgIGNvbW1vbl9tYXNrICY9IH5YODZf
Q1I0X09TWFNBVkU7Ci0KLSAgICBwdl9jcjRfbWFzayA9IGNvbXBhdF9wdl9j
cjRfbWFzayA9IGNvbW1vbl9tYXNrOwotCi0gICAgLyoKLSAgICAgKiA2NGJp
dCBQViBndWVzdHMgbWF5IGF0dGVtcHQgdG8gbW9kaWZ5IEZTR1NCQVNFLgot
ICAgICAqLwotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSApCi0gICAgICAg
IHB2X2NyNF9tYXNrICY9IH5YODZfQ1I0X0ZTR1NCQVNFOwotCi0gICAgcmV0
dXJuIDA7Ci19Ci1fX2luaXRjYWxsKGluaXRfcHZfY3I0X21hc2tzKTsKLQot
dW5zaWduZWQgbG9uZyBwdl9ndWVzdF9jcjRfZml4dXAoY29uc3Qgc3RydWN0
IHZjcHUgKnYsIHVuc2lnbmVkIGxvbmcgZ3Vlc3RfY3I0KQotewotICAgIHVu
c2lnbmVkIGxvbmcgaHZfY3I0ID0gcmVhbF9jcjRfdG9fcHZfZ3Vlc3RfY3I0
KHJlYWRfY3I0KCkpOwotICAgIHVuc2lnbmVkIGxvbmcgbWFzayA9IGlzX3B2
XzMyYml0X3ZjcHUodikgPyBjb21wYXRfcHZfY3I0X21hc2sgOiBwdl9jcjRf
bWFzazsKLQotICAgIGlmICggKGd1ZXN0X2NyNCAmIG1hc2spICE9IChodl9j
cjQgJiBtYXNrKSApCi0gICAgICAgIHByaW50ayhYRU5MT0dfR19XQVJOSU5H
Ci0gICAgICAgICAgICAgICAiZCVkIGF0dGVtcHRlZCB0byBjaGFuZ2UgJXB2
J3MgQ1I0IGZsYWdzICUwOGx4IC0+ICUwOGx4XG4iLAotICAgICAgICAgICAg
ICAgY3VycmVudC0+ZG9tYWluLT5kb21haW5faWQsIHYsIGh2X2NyNCwgZ3Vl
c3RfY3I0KTsKLQotICAgIHJldHVybiAoaHZfY3I0ICYgbWFzaykgfCAoZ3Vl
c3RfY3I0ICYgfm1hc2spOwotfQotCiAjZGVmaW5lIHhlbl92Y3B1X2d1ZXN0
X2NvbnRleHQgdmNwdV9ndWVzdF9jb250ZXh0CiAjZGVmaW5lIGZwdV9jdHh0
IGZwdV9jdHh0LngKIENIRUNLX0ZJRUxEXyhzdHJ1Y3QsIHZjcHVfZ3Vlc3Rf
Y29udGV4dCwgZnB1X2N0eHQpOwpAQCAtOTkzLDcgKzEwMDcsNyBAQCBpbnQg
YXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICBzdHJ1Y3QgZG9tYWluICpkID0g
di0+ZG9tYWluOwogICAgIHVuc2lnbmVkIGxvbmcgY3IzX2dmbjsKICAgICBz
dHJ1Y3QgcGFnZV9pbmZvICpjcjNfcGFnZTsKLSAgICB1bnNpZ25lZCBsb25n
IGZsYWdzLCBjcjQ7CisgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKICAgICB1
bnNpZ25lZCBpbnQgaTsKICAgICBpbnQgcmMgPSAwLCBjb21wYXQ7CiAKQEAg
LTEyMTAsOSArMTIyNCw4IEBAIGludCBhcmNoX3NldF9pbmZvX2d1ZXN0KAog
ICAgIHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzBdICY9IFg4Nl9DUjBfVFM7
CiAgICAgdi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbMF0gfD0gcmVhZF9jcjAo
KSAmIH5YODZfQ1IwX1RTOwogCi0gICAgY3I0ID0gdi0+YXJjaC5wdl92Y3B1
LmN0cmxyZWdbNF07Ci0gICAgdi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0g
PSBjcjQgPyBwdl9ndWVzdF9jcjRfZml4dXAodiwgY3I0KSA6Ci0gICAgICAg
IHJlYWxfY3I0X3RvX3B2X2d1ZXN0X2NyNChtbXVfY3I0X2ZlYXR1cmVzKTsK
KyAgICB2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9CisgICAgICAgIHB2
X2ZpeHVwX2d1ZXN0X2NyNCh2LCB2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0
XSk7CiAKICAgICBtZW1zZXQodi0+YXJjaC5kZWJ1Z3JlZywgMCwgc2l6ZW9m
KHYtPmFyY2guZGVidWdyZWcpKTsKICAgICBmb3IgKCBpID0gMDsgaSA8IDg7
IGkrKyApCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCmluZGV4IGM5YzZmYzkuLjA2ZmQ0ZTQgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5j
CkBAIC01MDEsMzMgKzUwMSwxMyBAQCB2b2lkIG1ha2VfY3IzKHN0cnVjdCB2
Y3B1ICp2LCB1bnNpZ25lZCBsb25nIG1mbikKICAgICAgICAgdi0+YXJjaC5j
cjMgfD0gZ2V0X3BjaWRfYml0cyh2LCAwKTsKIH0KIAotdW5zaWduZWQgbG9u
ZyBwdl9ndWVzdF9jcjRfdG9fcmVhbF9jcjQoY29uc3Qgc3RydWN0IHZjcHUg
KnYpCi17Ci0gICAgY29uc3Qgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFp
bjsKLSAgICB1bnNpZ25lZCBsb25nIGNyNDsKLQotICAgIGNyNCA9IHYtPmFy
Y2gucHZfdmNwdS5jdHJscmVnWzRdICYgflg4Nl9DUjRfREU7Ci0gICAgY3I0
IHw9IG1tdV9jcjRfZmVhdHVyZXMgJiAoWDg2X0NSNF9QU0UgfCBYODZfQ1I0
X1NNRVAgfCBYODZfQ1I0X1NNQVAgfAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFg4Nl9DUjRfT1NYU0FWRSB8IFg4Nl9DUjRfRlNHU0JBU0Up
OwotCi0gICAgaWYgKCBkLT5hcmNoLnB2X2RvbWFpbi5wY2lkICkKLSAgICAg
ICAgY3I0IHw9IFg4Nl9DUjRfUENJREU7Ci0gICAgZWxzZSBpZiAoICFkLT5h
cmNoLnB2X2RvbWFpbi54cHRpICkKLSAgICAgICAgY3I0IHw9IFg4Nl9DUjRf
UEdFOwotCi0gICAgY3I0IHw9IGQtPmFyY2gudnRzYyA/IFg4Nl9DUjRfVFNE
IDogMDsKLQotICAgIHJldHVybiBjcjQ7Ci19Ci0KIHZvaWQgd3JpdGVfcHRi
YXNlKHN0cnVjdCB2Y3B1ICp2KQogewogICAgIHN0cnVjdCBjcHVfaW5mbyAq
Y3B1X2luZm8gPSBnZXRfY3B1X2luZm8oKTsKICAgICB1bnNpZ25lZCBsb25n
IG5ld19jcjQ7CiAKICAgICBuZXdfY3I0ID0gKGlzX3B2X3ZjcHUodikgJiYg
IWlzX2lkbGVfdmNwdSh2KSkKLSAgICAgICAgICAgICAgPyBwdl9ndWVzdF9j
cjRfdG9fcmVhbF9jcjQodikKLSAgICAgICAgICAgICAgOiAoKHJlYWRfY3I0
KCkgJiB+KFg4Nl9DUjRfUENJREUgfCBYODZfQ1I0X1RTRCkpIHwgWDg2X0NS
NF9QR0UpOworICAgICAgICAgICAgICA/IHB2X21ha2VfY3I0KHYpIDogbW11
X2NyNF9mZWF0dXJlczsKIAogICAgIGlmICggaXNfcHZfdmNwdSh2KSAmJiB2
LT5kb21haW4tPmFyY2gucHZfZG9tYWluLnhwdGkgKQogICAgIHsKQEAgLTU0
Niw4ICs1MjYsNiBAQCB2b2lkIHdyaXRlX3B0YmFzZShzdHJ1Y3QgdmNwdSAq
dikKICAgICAgICAgc3dpdGNoX2NyM19jcjQodi0+YXJjaC5jcjMsIG5ld19j
cjQpOwogICAgICAgICBjcHVfaW5mby0+cHZfY3IzID0gMDsKICAgICB9Ci0K
LSAgICBBU1NFUlQoaXNfcHZfdmNwdSh2KSB8fCByZWFkX2NyNCgpID09IG1t
dV9jcjRfZmVhdHVyZXMpOwogfQogCiAvKgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L3RyYXBzLmMgYi94ZW4vYXJjaC94ODYvdHJhcHMuYwppbmRleCBj
MDAxZjkzLi42Y2JiZjNmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvdHJh
cHMuYworKysgYi94ZW4vYXJjaC94ODYvdHJhcHMuYwpAQCAtOTE4LDcgKzkx
OCw4IEBAIHN0YXRpYyB2b2lkIF9kb21haW5fY3B1aWQoc3RydWN0IGRvbWFp
biAqY3VycmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVk
IGludCAqZWF4LCB1bnNpZ25lZCBpbnQgKmVieCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgaW50ICplY3gsIHVuc2lnbmVkIGludCAq
ZWR4KQogewotICAgIGlmICggIWlzX2NvbnRyb2xfZG9tYWluKGN1cnJkKSAm
JiAhaXNfaGFyZHdhcmVfZG9tYWluKGN1cnJkKSApCisgICAgaWYgKCAhaXNf
Y29udHJvbF9kb21haW4oY3VycmQpICYmICFpc19oYXJkd2FyZV9kb21haW4o
Y3VycmQpICYmCisgICAgICAgICAhaXNfaWRsZV9kb21haW4oY3VycmQpICkK
ICAgICAgICAgZG9tYWluX2NwdWlkKGN1cnJkLCBsZWFmLCBzdWJsZWFmLCBl
YXgsIGVieCwgZWN4LCBlZHgpOwogICAgIGVsc2UKICAgICAgICAgY3B1aWRf
Y291bnQobGVhZiwgc3VibGVhZiwgZWF4LCBlYngsIGVjeCwgZWR4KTsKQEAg
LTI3MjEsOCArMjcyMiw4IEBAIHN0YXRpYyBpbnQgZW11bGF0ZV9wcml2aWxl
Z2VkX29wKHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQogICAgICAgICB9
CiAKICAgICAgICAgY2FzZSA0OiAvKiBXcml0ZSBDUjQgKi8KLSAgICAgICAg
ICAgIHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gcHZfZ3Vlc3RfY3I0
X2ZpeHVwKHYsICpyZWcpOwotICAgICAgICAgICAgd3JpdGVfY3I0KHB2X2d1
ZXN0X2NyNF90b19yZWFsX2NyNCh2KSk7CisgICAgICAgICAgICB2LT5hcmNo
LnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHB2X2ZpeHVwX2d1ZXN0X2NyNCh2LCAq
cmVnKTsKKyAgICAgICAgICAgIHdyaXRlX2NyNChwdl9tYWtlX2NyNCh2KSk7
CiAgICAgICAgICAgICBjdHh0X3N3aXRjaF9sZXZlbGxpbmcodik7CiAgICAg
ICAgICAgICBicmVhazsKIApkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNt
LXg4Ni9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWluLmgK
aW5kZXggMTMyYzJiMC4uM2Q2ZjU0NyAxMDA2NDQKLS0tIGEveGVuL2luY2x1
ZGUvYXNtLXg4Ni9kb21haW4uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2
L2RvbWFpbi5oCkBAIC02MzcsMTYgKzYzNywyMiBAQCBib29sX3QgdXBkYXRl
X3NlY29uZGFyeV9zeXN0ZW1fdGltZShzdHJ1Y3QgdmNwdSAqLAogdm9pZCB2
Y3B1X3Nob3dfZXhlY3V0aW9uX3N0YXRlKHN0cnVjdCB2Y3B1ICopOwogdm9p
ZCB2Y3B1X3Nob3dfcmVnaXN0ZXJzKGNvbnN0IHN0cnVjdCB2Y3B1ICopOwog
Ci0vKiBDbGVhbiB1cCBDUjQgYml0cyB0aGF0IGFyZSBub3QgdW5kZXIgZ3Vl
c3QgY29udHJvbC4gKi8KLXVuc2lnbmVkIGxvbmcgcHZfZ3Vlc3RfY3I0X2Zp
eHVwKGNvbnN0IHN0cnVjdCB2Y3B1ICosIHVuc2lnbmVkIGxvbmcgZ3Vlc3Rf
Y3I0KTsKKy8qCisgKiBCaXRzIHdoaWNoIGEgUFYgZ3Vlc3QgY2FuIHRvZ2ds
ZSBpbiBpdHMgdmlldyBvZiBjcjQuICBTb21lIGFyZSBsb2FkZWQgaW50bwor
ICogaGFyZHdhcmUsIHdoaWxlIHNvbWUgYXJlIGZ1bGx5IGVtdWxhdGVkLgor
ICovCisjZGVmaW5lIFBWX0NSNF9HVUVTVF9NQVNLIFwKKyAgICAoWDg2X0NS
NF9UU0QgfCBYODZfQ1I0X0RFIHwgWDg2X0NSNF9GU0dTQkFTRSB8IFg4Nl9D
UjRfT1NYU0FWRSkKKworLyogQml0cyB3aGljaCBhIFBWIGd1ZXN0IG1heSBv
YnNlcnZlIGZyb20gdGhlIHJlYWwgaGFyZHdhcmUgc2V0dGluZ3MuICovCisj
ZGVmaW5lIFBWX0NSNF9HVUVTVF9WSVNJQkxFX01BU0sgXAorICAgIChYODZf
Q1I0X1BBRSB8IFg4Nl9DUjRfTUNFIHwgWDg2X0NSNF9PU0ZYU1IgfCBYODZf
Q1I0X09TWE1NRVhDUFQpCiAKLS8qIENvbnZlcnQgYmV0d2VlbiBndWVzdC12
aXNpYmxlIGFuZCByZWFsIENSNCB2YWx1ZXMuICovCi11bnNpZ25lZCBsb25n
IHB2X2d1ZXN0X2NyNF90b19yZWFsX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAq
dik7CisvKiBHaXZlbiBhIG5ldyBjcjQgdmFsdWUsIGNvbnN0cnVjdCB0aGUg
cmVzdWx0aW5nIGd1ZXN0LXZpc2libGUgY3I0IHZhbHVlLiAqLwordW5zaWdu
ZWQgbG9uZyBwdl9maXh1cF9ndWVzdF9jcjQoY29uc3Qgc3RydWN0IHZjcHUg
KnYsIHVuc2lnbmVkIGxvbmcgY3I0KTsKIAotI2RlZmluZSByZWFsX2NyNF90
b19wdl9ndWVzdF9jcjQoYykgICAgICAgICAgICAgICAgICAgICAgICAgXAot
ICAgICgoYykgJiB+KFg4Nl9DUjRfUEdFIHwgWDg2X0NSNF9QU0UgfCBYODZf
Q1I0X1RTRCB8ICAgICAgXAotICAgICAgICAgICAgIFg4Nl9DUjRfT1NYU0FW
RSB8IFg4Nl9DUjRfU01FUCB8ICAgICAgICAgICAgICAgXAotICAgICAgICAg
ICAgIFg4Nl9DUjRfRlNHU0JBU0UgfCBYODZfQ1I0X1NNQVAgfCBYODZfQ1I0
X1BDSURFKSkKKy8qIENyZWF0ZSBhIGNyNCB2YWx1ZSB0byBsb2FkIGludG8g
aGFyZHdhcmUsIGJhc2VkIG9uIHZjcHUgc2V0dGluZ3MuICovCit1bnNpZ25l
ZCBsb25nIHB2X21ha2VfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2KTsKIAog
dm9pZCBkb21haW5fY3B1aWQoc3RydWN0IGRvbWFpbiAqZCwKICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGludCAgaW5wdXQsCg==

--=separator
Content-Type: application/octet-stream; name="xsa293/4.7-3.patch"
Content-Disposition: attachment; filename="xsa293/4.7-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBEb24ndCBoYXZlICVjcjQuZnNnc2Jhc2Ug
YWN0aXZlIGJlaGluZCBhIGd1ZXN0IGtlcm5lbHMgYmFjawoKQ3VycmVudGx5
LCBhIDY0Yml0IFBWIGd1ZXN0IGNhbiBhcHBlYXIgdG8gc2V0IGFuZCBjbGVh
ciBGU0dTQkFTRSBpbiAlY3I0LCBidXQKdGhlIGJpdCByZW1haW5zIHNldCBp
biBoYXJkd2FyZS4gIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17RlMsR1N9QkFT
RSBhcmUgdXNhYmxlCmV2ZW4gd2hlbiB0aGUgZ3Vlc3Qga2VybmVsIGJlbGll
dmVzIHRoYXQgdGhleSBhcmUgZGlzYWJsZWQuCgpUaGUgRlNHU0JBU0UgZmVh
dHVyZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIExpbnV4LCBhbmQg
aXRzIGNvbnRleHQKc3dpdGNoIHBhdGggaGFzIHNvbWUgb3B0aW1pc2F0aW9u
cyB3aGljaCByZWx5IG9uIHVzZXJzcGFjZSBiZWluZyB1bmFibGUgdG8gdXNl
CnRoZSBXUntGUyxHU31CQVNFIGluc3RydWN0aW9ucy4gIFhlbidzIGN1cnJl
bnQgYmVoYXZpb3VyIHVuZGVybWluZXMgdGhpcwpleHBlY3RhdGlvbi4KCklu
IDY0Yml0IFBWIGd1ZXN0IGNvbnRleHQsIGFsd2F5cyBsb2FkIHRoZSBndWVz
dCBrZXJuZWxzIHNldHRpbmcgb2YgRlNHU0JBU0UKaW50byAlY3I0LiAgVGhp
cyByZXF1aXJlcyBhZGp1c3RpbmcgaG93IFhlbiB1c2VzIHRoZSB7UkQsV1J9
e0ZTLEdTfUJBU0UKaW5zdHJ1Y3Rpb25zLgoKICogRGVsZXRlIHRoZSBjcHVf
aGFzX2ZzZ3NiYXNlIGhlbHBlci4gIEl0IGlzIG5vIGxvbmdlciBzYWZlLCBh
cyB1c2VycyBuZWVkIHRvCiAgIGNoZWNrICVjcjQgZGlyZWN0bHkuCiAqIFRo
ZSByYXcgX19yZHtmcyxnc31iYXNlKCkgaGVscGVycyBhcmUgb25seSBzYWZl
IHRvIHVzZSB3aGVuICVjcjQuZnNnc2Jhc2UKICAgaXMgc2V0LiAgQ29tbWVu
dCB0aGlzIHByb3BlcnR5LgogKiBUaGUge3JkLHdyfXtmcyxnc317YmFzZSxz
aGFkb3d9KCkgYW5kIHJlYWRfbXNyKCkgaGVscGVycyBhcmUgdXBkYXRlZCB0
byB1c2UKICAgdGhlIGN1cnJlbnQgJWNyNCB2YWx1ZSB0byBkZXRlcm1pbmUg
d2hpY2ggbWVjaGFuaXNtIHRvIHVzZS4KICogdG9nZ2xlX2d1ZXN0X21vZGUo
KSBhbmQgc2F2ZV9zZWdtZW50cygpIGFyZSB1cGRhdGUgdG8gYXZvaWQgcmVh
ZGluZwogICBmcy9nc2Jhc2UgaWYgdGhlIHZhbHVlcyBpbiBoYXJkd2FyZSBj
YW5ub3QgYmUgc3RhbGUgV1JUIHN0cnVjdCB2Y3B1LiAgQQogICBjb25zZXF1
ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHdyaXRlX2NyKCkgcGF0aCBuZWVk
cyB0byBjYWNoZSB0aGUgY3VycmVudAogICBiYXNlcywgYXMgc3Vic2VxdWVu
dCBjb250ZXh0IHN3aXRjaGVzIHdpbGwgc2tpcCBzYXZpbmcgdGhlIHZhbHVl
cy4KICogd3JpdGVfY3I0KCkgaXMgdXBkYXRlZCB0byBlbnN1cmUgdGhhdCB0
aGUgc2hhZG93ICVjcjQuZnNnc2Jhc2UgdmFsdWUgaXMKICAgb2JzZXJ2ZWQg
aW4gYSBzYWZlIHdheSBXUlQgdGhlIGhhcmR3YXJlIHNldHRpbmcsIGlmIGFu
IGludGVycnVwdCBoYXBwZW5zIHRvCiAgIGhpdCBpbiB0aGUgbWlkZGxlLgog
KiBwdl9tYWtlX2NyNCgpIGlzIHVwZGF0ZWQgZm9yIDY0Yml0IFBWIGd1ZXN0
cyB0byB1c2UgdGhlIGd1ZXN0IGtlcm5lbHMKICAgY2hvaWNlIG9mIEZTR1NC
QVNFLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTMKClNpZ25lZC1vZmYtYnk6
IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+ClJl
dmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Cgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVuL2FyY2gv
eDg2L2RvbWFpbi5jCmluZGV4IDhkZGIxMmMuLjIwYzBiZDAgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94ZW4vYXJjaC94ODYv
ZG9tYWluLmMKQEAgLTQzMSw2ICs0MzEsMTYgQEAgdW5zaWduZWQgbG9uZyBw
dl9tYWtlX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoIGQt
PmFyY2gudnRzYyB8fCAodi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gJiBY
ODZfQ1I0X1RTRCkgKQogICAgICAgICBjcjQgfD0gWDg2X0NSNF9UU0Q7CiAK
KyAgICAvKgorICAgICAqIFRoZSB7UkQsV1J9e0ZTLEdTfUJBU0UgYXJlIG9u
bHkgdXNlYWJsZSBpbiA2NGJpdCBjb2RlIHNlZ21lbnRzLiAgV2hpbGUKKyAg
ICAgKiB3ZSBtdXN0IG5vdCBoYXZlIENSNC5GU0dTQkFTRSBzZXQgYmVoaW5k
IHRoZSBiYWNrIG9mIGEgNjRiaXQgUFYga2VybmVsLAorICAgICAqIHdlIGRv
IGxlYXZlIGl0IHNldCBpbiAzMmJpdCBQViBjb250ZXh0IHRvIHNwZWVkIHVw
IFhlbidzIGNvbnRleHQgc3dpdGNoCisgICAgICogcGF0aC4KKyAgICAgKi8K
KyAgICBpZiAoICFpc19wdl8zMmJpdF9kb21haW4oZCkgJiYKKyAgICAgICAg
ICEodi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gJiBYODZfQ1I0X0ZTR1NC
QVNFKSApCisgICAgICAgIGNyNCAmPSB+WDg2X0NSNF9GU0dTQkFTRTsKKwog
ICAgIHJldHVybiBjcjQ7CiB9CiAKQEAgLTIwMTIsNyArMjAyMiw4IEBAIHN0
YXRpYyB2b2lkIHNhdmVfc2VnbWVudHMoc3RydWN0IHZjcHUgKnYpCiAgICAg
cmVncy0+ZnMgPSByZWFkX3NyZWcoZnMpOwogICAgIHJlZ3MtPmdzID0gcmVh
ZF9zcmVnKGdzKTsKIAotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSAmJiAh
aXNfcHZfMzJiaXRfdmNwdSh2KSApCisgICAgLyogJWZzLyVncyBiYXNlcyBj
YW4gb25seSBiZSBzdGFsZSBpZiBXUntGUyxHU31CQVNFIGFyZSB1c2FibGUu
ICovCisgICAgaWYgKCAocmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Up
ICYmICFpc19wdl8zMmJpdF92Y3B1KHYpICkKICAgICB7CiAgICAgICAgIHYt
PmFyY2gucHZfdmNwdS5mc19iYXNlID0gX19yZGZzYmFzZSgpOwogICAgICAg
ICBpZiAoIHYtPmFyY2guZmxhZ3MgJiBURl9rZXJuZWxfbW9kZSApCmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvc2V0dXAuYyBiL3hlbi9hcmNoL3g4Ni9z
ZXR1cC5jCmluZGV4IDAwNzJkZTcuLjllY2E1N2EgMTAwNjQ0Ci0tLSBhL3hl
bi9hcmNoL3g4Ni9zZXR1cC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9zZXR1cC5j
CkBAIC0xNDQyLDcgKzE0NDIsNyBAQCB2b2lkIF9faW5pdCBub3JldHVybiBf
X3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9wKQogCiAgICAgY3I0X3B2
MzJfbWFzayA9IG1tdV9jcjRfZmVhdHVyZXMgJiBYRU5fQ1I0X1BWMzJfQklU
UzsKIAotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCBi
b290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfRlNHU0JBU0UpICkKICAgICAgICAg
c2V0X2luX2NyNChYODZfQ1I0X0ZTR1NCQVNFKTsKIAogICAgIGlmICggb3B0
X2ludnBjaWQgJiYgY3B1X2hhc19pbnZwY2lkICkKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni90cmFwcy5jIGIveGVuL2FyY2gveDg2L3RyYXBzLmMKaW5k
ZXggNmNiYmYzZi4uNTgzOTM2ZSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2
L3RyYXBzLmMKKysrIGIveGVuL2FyY2gveDg2L3RyYXBzLmMKQEAgLTI3MjIs
NiArMjcyMiwxNyBAQCBzdGF0aWMgaW50IGVtdWxhdGVfcHJpdmlsZWdlZF9v
cChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncykKICAgICAgICAgfQogCiAg
ICAgICAgIGNhc2UgNDogLyogV3JpdGUgQ1I0ICovCisgICAgICAgICAgICAv
KgorICAgICAgICAgICAgICogSWYgdGhpcyB3cml0ZSB3aWxsIGRpc2FibGUg
RlNHU0JBU0UsIHJlZnJlc2ggWGVuJ3MgaWRlYSBvZiB0aGUKKyAgICAgICAg
ICAgICAqIGd1ZXN0IGJhc2VzIG5vdyB0aGF0IHRoZXkgY2FuIG5vIGxvbmdl
ciBjaGFuZ2UuCisgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgIGlmICgg
KHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdICYgWDg2X0NSNF9GU0dTQkFT
RSkgJiYKKyAgICAgICAgICAgICAgICAgISgqcmVnICYgWDg2X0NSNF9GU0dT
QkFTRSkgKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHYtPmFy
Y2gucHZfdmNwdS5mc19iYXNlID0gX19yZGZzYmFzZSgpOworICAgICAgICAg
ICAgICAgIHYtPmFyY2gucHZfdmNwdS5nc19iYXNlX2tlcm5lbCA9IF9fcmRn
c2Jhc2UoKTsKKyAgICAgICAgICAgIH0KKwogICAgICAgICAgICAgdi0+YXJj
aC5wdl92Y3B1LmN0cmxyZWdbNF0gPSBwdl9maXh1cF9ndWVzdF9jcjQodiwg
KnJlZyk7CiAgICAgICAgICAgICB3cml0ZV9jcjQocHZfbWFrZV9jcjQodikp
OwogICAgICAgICAgICAgY3R4dF9zd2l0Y2hfbGV2ZWxsaW5nKHYpOwpAQCAt
Mjk5MywxMyArMzAwNCwxNCBAQCBzdGF0aWMgaW50IGVtdWxhdGVfcHJpdmls
ZWdlZF9vcChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncykKICAgICAgICAg
Y2FzZSBNU1JfRlNfQkFTRToKICAgICAgICAgICAgIGlmICggaXNfcHZfMzJi
aXRfZG9tYWluKGN1cnJkKSApCiAgICAgICAgICAgICAgICAgZ290byBmYWls
OwotICAgICAgICAgICAgdmFsID0gY3B1X2hhc19mc2dzYmFzZSA/IF9fcmRm
c2Jhc2UoKSA6IHYtPmFyY2gucHZfdmNwdS5mc19iYXNlOworICAgICAgICAg
ICAgdmFsID0gKHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNFKSA/IF9f
cmRmc2Jhc2UoKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICA6IHYtPmFyY2gucHZfdmNwdS5mc19iYXNlOwog
ICAgICAgICAgICAgZ290byByZG1zcl93cml0ZWJhY2s7CiAgICAgICAgIGNh
c2UgTVNSX0dTX0JBU0U6CiAgICAgICAgICAgICBpZiAoIGlzX3B2XzMyYml0
X2RvbWFpbihjdXJyZCkgKQogICAgICAgICAgICAgICAgIGdvdG8gZmFpbDsK
LSAgICAgICAgICAgIHZhbCA9IGNwdV9oYXNfZnNnc2Jhc2UgPyBfX3JkZ3Ni
YXNlKCkKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB2
LT5hcmNoLnB2X3ZjcHUuZ3NfYmFzZV9rZXJuZWw7CisgICAgICAgICAgICB2
YWwgPSAocmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0UpID8gX19yZGdz
YmFzZSgpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDogdi0+YXJjaC5wdl92Y3B1LmdzX2Jhc2Vfa2VybmVs
OwogICAgICAgICAgICAgZ290byByZG1zcl93cml0ZWJhY2s7CiAgICAgICAg
IGNhc2UgTVNSX1NIQURPV19HU19CQVNFOgogICAgICAgICAgICAgaWYgKCBp
c19wdl8zMmJpdF9kb21haW4oY3VycmQpICkKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni94ODZfNjQvdHJhcHMuYyBiL3hlbi9hcmNoL3g4Ni94ODZfNjQv
dHJhcHMuYwppbmRleCA1NmVkMTU2Li4wNGNjNjBkIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYveDg2XzY0L3RyYXBzLmMKKysrIGIveGVuL2FyY2gveDg2
L3g4Nl82NC90cmFwcy5jCkBAIC0yNjUsNyArMjY1LDkgQEAgdm9pZCB0b2dn
bGVfZ3Vlc3RfbW9kZShzdHJ1Y3QgdmNwdSAqdikKIHsKICAgICBpZiAoIGlz
X3B2XzMyYml0X3ZjcHUodikgKQogICAgICAgICByZXR1cm47Ci0gICAgaWYg
KCBjcHVfaGFzX2ZzZ3NiYXNlICkKKworICAgIC8qICVmcy8lZ3MgYmFzZXMg
Y2FuIG9ubHkgYmUgc3RhbGUgaWYgV1J7RlMsR1N9QkFTRSBhcmUgdXNhYmxl
LiAqLworICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Ug
KQogICAgIHsKICAgICAgICAgaWYgKCB2LT5hcmNoLmZsYWdzICYgVEZfa2Vy
bmVsX21vZGUgKQogICAgICAgICAgICAgdi0+YXJjaC5wdl92Y3B1LmdzX2Jh
c2Vfa2VybmVsID0gX19yZGdzYmFzZSgpOwpkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmggYi94ZW4vaW5jbHVkZS9hc20t
eDg2L2NwdWZlYXR1cmUuaAppbmRleCAwNGQ5ZTI4Li5mOWM4MzM1IDEwMDY0
NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaAorKysg
Yi94ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaApAQCAtNzIsNyAr
NzIsNiBAQAogI2RlZmluZSBjcHVfaGFzX254CQlib290X2NwdV9oYXMoWDg2
X0ZFQVRVUkVfTlgpCiAjZGVmaW5lIGNwdV9oYXNfY2xmbHVzaAkJYm9vdF9j
cHVfaGFzKFg4Nl9GRUFUVVJFX0NMRkxVU0gpCiAjZGVmaW5lIGNwdV9oYXNf
cGFnZTFnYgkJYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX1BBR0UxR0IpCi0j
ZGVmaW5lIGNwdV9oYXNfZnNnc2Jhc2UJYm9vdF9jcHVfaGFzKFg4Nl9GRUFU
VVJFX0ZTR1NCQVNFKQogI2RlZmluZSBjcHVfaGFzX2FwZXJmbXBlcmYJYm9v
dF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0FQRVJGTVBFUkYpCiAjZGVmaW5lIGNw
dV9oYXNfc21lcCAgICAgICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVS
RV9TTUVQKQogI2RlZmluZSBjcHVfaGFzX2ludnBjaWQgICAgICAgICBib290
X2NwdV9oYXMoWDg2X0ZFQVRVUkVfSU5WUENJRCkKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbXNyLmggYi94ZW4vaW5jbHVkZS9hc20teDg2
L21zci5oCmluZGV4IDRiNGMxNTYuLjI1MmNiZGMgMTAwNjQ0Ci0tLSBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbXNyLmgKKysrIGIveGVuL2luY2x1ZGUvYXNt
LXg4Ni9tc3IuaApAQCAtOTMsNiArOTMsMTQgQEAgc3RhdGljIGlubGluZSB1
aW50NjRfdCByZHRzYyh2b2lkKQogCQkJICA6ICI9YSIgKGxvdyksICI9ZCIg
KGhpZ2gpIFwKIAkJCSAgOiAiYyIgKGNvdW50ZXIpKQogCisvKgorICogT24g
aGFyZHdhcmUgc3VwcG9ydGluZyBGU0dTQkFTRSwgdGhlIHZhbHVlIGxvYWRl
ZCBpbnRvIGhhcmR3YXJlIGlzIHRoZQorICogZ3Vlc3Qga2VybmVsJ3MgY2hv
aWNlIGZvciA2NGJpdCBQViBndWVzdHMgKFhlbidzIGNob2ljZSBmb3IgSWRs
ZSwgSFZNIGFuZAorICogMzJiaXQgUFYpLgorICoKKyAqIFRoZXJlZm9yZSwg
dGhlIHtSRCxXUn17RlMsR1N9QkFTRSBpbnN0cnVjdGlvbnMgYXJlIG9ubHkg
c2FmZSB0byB1c2UgaWYKKyAqICVjcjQuZnNnc2Jhc2UgaXMgc2V0LgorICov
CiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgX19yZGZzYmFzZSh2b2lk
KQogewogICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKQEAgLTEyMyw3ICsxMzEs
NyBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRmc2Jhc2Uodm9p
ZCkKIHsKICAgICB1bnNpZ25lZCBsb25nIGJhc2U7CiAKLSAgICBpZiAoIGNw
dV9oYXNfZnNnc2Jhc2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9D
UjRfRlNHU0JBU0UgKQogICAgICAgICByZXR1cm4gX19yZGZzYmFzZSgpOwog
CiAgICAgcmRtc3JsKE1TUl9GU19CQVNFLCBiYXNlKTsKQEAgLTEzNSw3ICsx
NDMsNyBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRnc2Jhc2Uo
dm9pZCkKIHsKICAgICB1bnNpZ25lZCBsb25nIGJhc2U7CiAKLSAgICBpZiAo
IGNwdV9oYXNfZnNnc2Jhc2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4
Nl9DUjRfRlNHU0JBU0UgKQogICAgICAgICByZXR1cm4gX19yZGdzYmFzZSgp
OwogCiAgICAgcmRtc3JsKE1TUl9HU19CQVNFLCBiYXNlKTsKQEAgLTE0NSw3
ICsxNTMsNyBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRnc2Jh
c2Uodm9pZCkKIAogc3RhdGljIGlubGluZSB2b2lkIHdyZnNiYXNlKHVuc2ln
bmVkIGxvbmcgYmFzZSkKIHsKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2Ug
KQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0UgKQog
I2lmZGVmIEhBVkVfR0FTX0ZTR1NCQVNFCiAgICAgICAgIGFzbSB2b2xhdGls
ZSAoICJ3cmZzYmFzZSAlMCIgOjogInIiIChiYXNlKSApOwogI2Vsc2UKQEAg
LTE1Nyw3ICsxNjUsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgd3Jmc2Jhc2Uo
dW5zaWduZWQgbG9uZyBiYXNlKQogCiBzdGF0aWMgaW5saW5lIHZvaWQgd3Jn
c2Jhc2UodW5zaWduZWQgbG9uZyBiYXNlKQogewotICAgIGlmICggY3B1X2hh
c19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NSNF9G
U0dTQkFTRSApCiAjaWZkZWYgSEFWRV9HQVNfRlNHU0JBU0UKICAgICAgICAg
YXNtIHZvbGF0aWxlICggIndyZ3NiYXNlICUwIiA6OiAiciIgKGJhc2UpICk7
CiAjZWxzZQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9j
ZXNzb3IuaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcHJvY2Vzc29yLmgKaW5k
ZXggNmEzNWI4OS4uNjEwYjZmMyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUv
YXNtLXg4Ni9wcm9jZXNzb3IuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2
L3Byb2Nlc3Nvci5oCkBAIC0zNjMsMTEgKzM2MywzMSBAQCBzdGF0aWMgaW5s
aW5lIHVuc2lnbmVkIGxvbmcgcmVhZF9jcjQodm9pZCkKIAogc3RhdGljIGlu
bGluZSB2b2lkIHdyaXRlX2NyNCh1bnNpZ25lZCBsb25nIHZhbCkKIHsKKyAg
ICBzdHJ1Y3QgY3B1X2luZm8gKmluZm8gPSBnZXRfY3B1X2luZm8oKTsKKwog
ICAgIC8qIE5vIGdsb2JhbCBwYWdlcyBpbiBjYXNlIG9mIFBDSURzIGVuYWJs
ZWQhICovCiAgICAgQVNTRVJUKCEodmFsICYgWDg2X0NSNF9QR0UpIHx8ICEo
dmFsICYgWDg2X0NSNF9QQ0lERSkpOwogCi0gICAgZ2V0X2NwdV9pbmZvKCkt
PmNyNCA9IHZhbDsKLSAgICBhc20gdm9sYXRpbGUgKCAibW92ICUwLCUlY3I0
IiA6IDogInIiICh2YWwpICk7CisgICAgLyoKKyAgICAgKiBPbiBoYXJkd2Fy
ZSBzdXBwb3J0aW5nIEZTR1NCQVNFLCB0aGUgdmFsdWUgaW4gJWNyNCBpcyB0
aGUga2VybmVsJ3MKKyAgICAgKiBjaG9pY2UgZm9yIDY0Yml0IFBWIGd1ZXN0
cywgd2hpY2ggaW1wYWN0cyB3aGV0aGVyIFhlbiBjYW4gdXNlIHRoZQorICAg
ICAqIGluc3RydWN0aW9ucy4KKyAgICAgKgorICAgICAqIFRoZSB7cmQsd3J9
e2ZzLGdzfWJhc2UoKSBoZWxwZXJzIHVzZSBpbmZvLT5jcjQgdG8gd29yayBv
dXQgd2hldGhlciBpdAorICAgICAqIGlzIHNhZmUgdG8gZXhlY3V0ZSB0aGUg
e1JELFdSfXtGUyxHU31CQVNFIGluc3RydWN0aW9uLCBmYWxsaW5nIGJhY2sg
dG8KKyAgICAgKiB0aGUgTVNSIHBhdGggaWYgbm90LiAgU29tZSB1c2VycyBy
ZXF1aXJlIGludGVycnVwdCBzYWZldHkuCisgICAgICoKKyAgICAgKiBJZiBG
U0dTQkFTRSBpcyBjdXJyZW50bHkgb3IgYWJvdXQgdG8gYmVjb21lIGNsZWFy
LCByZWZsZWN0IHRoaXMgaW4KKyAgICAgKiBpbmZvLT5jcjQgYmVmb3JlIHVw
ZGF0aW5nICVjcjQsIHNvIGFuIGludGVycnVwdCB3aGljaCBoaXRzIGluIHRo
ZQorICAgICAqIG1pZGRsZSB3b24ndCBvYnNlcnZlIEZTR1NCQVNFIHNldCBp
biBpbmZvLT5jcjQgYnV0IGNsZWFyIGluICVjcjQuCisgICAgICovCisgICAg
aW5mby0+Y3I0ID0gdmFsICYgKGluZm8tPmNyNCB8IH5YODZfQ1I0X0ZTR1NC
QVNFKTsKKworICAgIGFzbSB2b2xhdGlsZSAoICJtb3YgJVt2YWxdLCAlJWNy
NCIKKyAgICAgICAgICAgICAgICAgICA6ICIrbSIgKGluZm8tPmNyNCkgLyog
Rm9yY2Ugb3JkZXJpbmcgd2l0aG91dCBhIGJhcnJpZXIuICovCisgICAgICAg
ICAgICAgICAgICAgOiBbdmFsXSAiciIgKHZhbCkgKTsKKworICAgIGluZm8t
PmNyNCA9IHZhbDsKIH0KIAogLyogQ2xlYXIgYW5kIHNldCAnVFMnIGJpdCBy
ZXNwZWN0aXZlbHkgKi8K

--=separator
Content-Type: application/octet-stream; name="xsa293/4.8-1.patch"
Content-Disposition: attachment; filename="xsa293/4.8-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBJbXByb3ZlIHB2X2NwdWlkKCkncyBBUEkK
CnB2X2NwdWlkKCkncyBBUEkgaXMgYXdrd2FyZCB0byB1c2UuICBUaGVyZSBh
cmUgYWxyZWFkeSB0d28gY2FsbGVycyBqdW1waW5nCnRocm91Z2ggaG9vcHMg
dG8gdXNlIGl0LCBhbmQgYSB0aGlyZCBpcyBvbiBpdHMgd2F5LgoKQ2hhbmdl
IHRoZSBBUEkgdG8gdGFrZSBlYWNoIHBhcmFtZXRlciBpbmRpdmlkdWFsbHkg
KGxpa2UgaXRzIGNvdW50ZXJwYXJ0LApodm1fY3B1aWQoKSwgYWxyZWFkeSBk
b2VzKSwgYW5kIGludHJvZHVjZSBhIG5ldyBwdl9jcHVpZF9yZWdzKCkgd3Jh
cHBlcgppbXBsZW1lbnRpbmcgdGhlIG9sZCBBUEkuCgpObyBmdW5jdGlvbmFs
IGNoYW5nZS4KClNpZ25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gv
eDg2L2h2bS92bXgvdm14LmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXgu
YwppbmRleCBhYjM5YTQ1Li4wMDUzYWMwIDEwMDY0NAotLS0gYS94ZW4vYXJj
aC94ODYvaHZtL3ZteC92bXguYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3Zt
eC92bXguYwpAQCAtMzgwMyw3ICszODAzLDcgQEAgdm9pZCB2bXhfdm1leGl0
X2hhbmRsZXIoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiAKICAgICAg
ICAgaWYgKCBpc19wdmhfdmNwdSh2KSApCiAgICAgICAgIHsKLSAgICAgICAg
ICAgIHB2X2NwdWlkKHJlZ3MpOworICAgICAgICAgICAgcHZfY3B1aWRfcmVn
cyhyZWdzKTsKICAgICAgICAgICAgIHJjID0gMDsKICAgICAgICAgfQogICAg
ICAgICBlbHNlCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvdHJhcHMuYyBi
L3hlbi9hcmNoL3g4Ni90cmFwcy5jCmluZGV4IDFhMjI4OTUuLjc3Zjc4NmMg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni90cmFwcy5jCisrKyBiL3hlbi9h
cmNoL3g4Ni90cmFwcy5jCkBAIC05NzIsMTcgKzk3MiwxNCBAQCBzdGF0aWMg
dm9pZCBfZG9tYWluX2NwdWlkKGNvbnN0IHN0cnVjdCBkb21haW4gKmN1cnJk
LAogICAgICAgICBjcHVpZF9jb3VudChsZWFmLCBzdWJsZWFmLCBlYXgsIGVi
eCwgZWN4LCBlZHgpOwogfQogCi12b2lkIHB2X2NwdWlkKHN0cnVjdCBjcHVf
dXNlcl9yZWdzICpyZWdzKQordm9pZCBwdl9jcHVpZCh1aW50MzJfdCBsZWFm
LCB1aW50MzJfdCBzdWJsZWFmLAorICAgICAgICAgICAgICB1aW50MzJfdCAq
ZWF4LCB1aW50MzJfdCAqZWJ4LCB1aW50MzJfdCAqZWN4LCB1aW50MzJfdCAq
ZWR4KQogewotICAgIHVpbnQzMl90IGxlYWYsIHN1YmxlYWYsIGEsIGIsIGMs
IGQ7CisgICAgdWludDMyX3QgYSwgYiwgYywgZDsKKyAgICBjb25zdCBzdHJ1
Y3QgY3B1X3VzZXJfcmVncyAqcmVncyA9IGd1ZXN0X2NwdV91c2VyX3JlZ3Mo
KTsKICAgICBzdHJ1Y3QgdmNwdSAqY3VyciA9IGN1cnJlbnQ7CiAgICAgc3Ry
dWN0IGRvbWFpbiAqY3VycmQgPSBjdXJyLT5kb21haW47CiAKLSAgICBsZWFm
ID0gYSA9IHJlZ3MtPmVheDsKLSAgICBiID0gcmVncy0+ZWJ4OwotICAgIHN1
YmxlYWYgPSBjID0gcmVncy0+ZWN4OwotICAgIGQgPSByZWdzLT5lZHg7Ci0K
ICAgICBpZiAoIGNwdWlkX2h5cGVydmlzb3JfbGVhdmVzKGxlYWYsIHN1Ymxl
YWYsICZhLCAmYiwgJmMsICZkKSApCiAgICAgICAgIGdvdG8gb3V0OwogCkBA
IC05OTcsMTMgKzk5NCw3IEBAIHZvaWQgcHZfY3B1aWQoc3RydWN0IGNwdV91
c2VyX3JlZ3MgKnJlZ3MpCiAKICAgICAgICAgX2RvbWFpbl9jcHVpZChjdXJy
ZCwgbGltaXQsIDAsICZsaW1pdCwgJmR1bW15LCAmZHVtbXksICZkdW1teSk7
CiAgICAgICAgIGlmICggbGVhZiA+IGxpbWl0ICkKLSAgICAgICAgewotICAg
ICAgICAgICAgcmVncy0+ZWF4ID0gMDsKLSAgICAgICAgICAgIHJlZ3MtPmVi
eCA9IDA7Ci0gICAgICAgICAgICByZWdzLT5lY3ggPSAwOwotICAgICAgICAg
ICAgcmVncy0+ZWR4ID0gMDsKLSAgICAgICAgICAgIHJldHVybjsKLSAgICAg
ICAgfQorICAgICAgICAgICAgZ290byB1bnN1cHBvcnRlZDsKICAgICB9CiAK
ICAgICBfZG9tYWluX2NwdWlkKGN1cnJkLCBsZWFmLCBzdWJsZWFmLCAmYSwg
JmIsICZjLCAmZCk7CkBAIC0xMjg0LDE3ICsxMjc1LDIxIEBAIHZvaWQgcHZf
Y3B1aWQoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiAgICAgY2FzZSAw
eDgwMDAwMDFlOiAvKiBFeHRlbmRlZCB0b3BvbG9neSByZXBvcnRpbmcgKi8K
ICAgICB1bnN1cHBvcnRlZDoKICAgICAgICAgYSA9IGIgPSBjID0gZCA9IDA7
Ci0gICAgICAgIGJyZWFrOworICAgICAgICBnb3RvIG91dDsKICAgICB9CiAK
LSBvdXQ6CiAgICAgLyogVlBNVSBtYXkgZGVjaWRlIHRvIG1vZGlmeSBzb21l
IG9mIHRoZSBsZWF2ZXMgKi8KICAgICB2cG11X2RvX2NwdWlkKGxlYWYsICZh
LCAmYiwgJmMsICZkKTsKIAotICAgIHJlZ3MtPmVheCA9IGE7Ci0gICAgcmVn
cy0+ZWJ4ID0gYjsKLSAgICByZWdzLT5lY3ggPSBjOwotICAgIHJlZ3MtPmVk
eCA9IGQ7Cisgb3V0OgorICAgIGlmICggZWF4ICkKKyAgICAgICAgKmVheCA9
IGE7CisgICAgaWYgKCBlYnggKQorICAgICAgICAqZWJ4ID0gYjsKKyAgICBp
ZiAoIGVjeCApCisgICAgICAgICplY3ggPSBjOworICAgIGlmICggZWR4ICkK
KyAgICAgICAgKmVkeCA9IGQ7CiB9CiAKIHN0YXRpYyBpbnQgZW11bGF0ZV9p
bnZhbGlkX3JkdHNjcChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncykKQEAg
LTEzNTMsNyArMTM0OCw3IEBAIHN0YXRpYyBpbnQgZW11bGF0ZV9mb3JjZWRf
aW52YWxpZF9vcChzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncykKIAogICAg
IGVpcCArPSBzaXplb2YoaW5zdHIpOwogCi0gICAgcHZfY3B1aWQocmVncyk7
CisgICAgcHZfY3B1aWRfcmVncyhyZWdzKTsKIAogICAgIGluc3RydWN0aW9u
X2RvbmUocmVncywgZWlwLCAwKTsKIApAQCAtMjgyOCwxNyArMjgyMyw3IEBA
IHN0YXRpYyBpbnQgcHJpdl9vcF93cml0ZV9tc3IodW5zaWduZWQgaW50IHJl
ZywgdWludDY0X3QgdmFsLAogaW50IHB2X2VtdWxfY3B1aWQodW5zaWduZWQg
aW50ICplYXgsIHVuc2lnbmVkIGludCAqZWJ4LCB1bnNpZ25lZCBpbnQgKmVj
eCwKICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqZWR4LCBzdHJ1
Y3QgeDg2X2VtdWxhdGVfY3R4dCAqY3R4dCkKIHsKLSAgICBzdHJ1Y3QgY3B1
X3VzZXJfcmVncyByZWdzID0gKmN0eHQtPnJlZ3M7Ci0KLSAgICByZWdzLl9l
YXggPSAqZWF4OwotICAgIHJlZ3MuX2VjeCA9ICplY3g7Ci0KLSAgICBwdl9j
cHVpZCgmcmVncyk7Ci0KLSAgICAqZWF4ID0gcmVncy5fZWF4OwotICAgICpl
YnggPSByZWdzLl9lYng7Ci0gICAgKmVjeCA9IHJlZ3MuX2VjeDsKLSAgICAq
ZWR4ID0gcmVncy5fZWR4OworICAgIHB2X2NwdWlkKCplYXgsICplY3gsIGVh
eCwgZWJ4LCBlY3gsIGVkeCk7CiAKICAgICByZXR1cm4gWDg2RU1VTF9PS0FZ
OwogfQpAQCAtMzMyOSw3ICszMzE0LDcgQEAgc3RhdGljIGludCBlbXVsYXRl
X3ByaXZpbGVnZWRfb3Aoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiAg
ICAgICAgIGlmICggdi0+YXJjaC5jcHVpZF9mYXVsdGluZyAmJiAhZ3Vlc3Rf
a2VybmVsX21vZGUodiwgcmVncykgKQogICAgICAgICAgICAgZ290byBmYWls
OwogCi0gICAgICAgIHB2X2NwdWlkKHJlZ3MpOworICAgICAgICBwdl9jcHVp
ZF9yZWdzKHJlZ3MpOwogICAgICAgICBicmVhazsKIAogICAgIGRlZmF1bHQ6
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYveHN0YXRlLmMgYi94ZW4vYXJj
aC94ODYveHN0YXRlLmMKaW5kZXggNWM0M2VjOS4uMDlkMjVhYyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L3hzdGF0ZS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni94c3RhdGUuYwpAQCAtNjU0LDI0ICs2NTQsMTggQEAgc3RhdGljIGJvb2xf
dCB2YWxpZF94Y3IwKHU2NCB4Y3IwKQogCiBzdGF0aWMgdWludDY0X3QgZ3Vl
c3RfeGNyMF9tYXgoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCkKIHsKKyAgICB1
aW50MzJfdCBlYXgsIGVkeDsKKwogICAgIGlmICggaGFzX2h2bV9jb250YWlu
ZXJfZG9tYWluKGQpICkKICAgICB7Ci0gICAgICAgIHVpbnQzMl90IGVheCwg
ZWN4ID0gMCwgZWR4OworICAgICAgICB1aW50MzJfdCBlY3ggPSAwOwogCiAg
ICAgICAgIGh2bV9jcHVpZChYU1RBVEVfQ1BVSUQsICZlYXgsIE5VTEwsICZl
Y3gsICZlZHgpOwotCi0gICAgICAgIHJldHVybiAoKHVpbnQ2NF90KWVkeCA8
PCAzMikgfCBlYXg7CiAgICAgfQogICAgIGVsc2UKLSAgICB7Ci0gICAgICAg
IHN0cnVjdCBjcHVfdXNlcl9yZWdzIHJlZ3MgPSB7IH07CisgICAgICAgIHB2
X2NwdWlkKFhTVEFURV9DUFVJRCwgMCwgJmVheCwgTlVMTCwgTlVMTCwgJmVk
eCk7CiAKLSAgICAgICAgcmVncy5fZWF4ID0gWFNUQVRFX0NQVUlEOwotICAg
ICAgICByZWdzLl9lY3ggPSAwOwotICAgICAgICBwdl9jcHVpZCgmcmVncyk7
Ci0KLSAgICAgICAgcmV0dXJuIChyZWdzLnJkeCA8PCAzMikgfCByZWdzLl9l
YXg7Ci0gICAgfQorICAgIHJldHVybiAoKHVpbnQ2NF90KWVkeCA8PCAzMikg
fCBlYXg7CiB9CiAKIGludCB2YWxpZGF0ZV94c3RhdGUoY29uc3Qgc3RydWN0
IGRvbWFpbiAqZCwgdWludDY0X3QgeGNyMCwgdWludDY0X3QgeGNyMF9hY2N1
bSwKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcHJvY2Vzc29y
LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nlc3Nvci5oCmluZGV4IDU4
MWQ3YjAuLjUwYmFkYWIgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14
ODYvcHJvY2Vzc29yLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9j
ZXNzb3IuaApAQCAtNjYzLDcgKzY2MywxNCBAQCBlbnVtIGdldF9jcHVfdmVu
ZG9yIHsKIH07CiAKIGludCBnZXRfY3B1X3ZlbmRvcihjb25zdCBjaGFyIHZl
bmRvcl9pZFtdLCBlbnVtIGdldF9jcHVfdmVuZG9yKTsKLXZvaWQgcHZfY3B1
aWQoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpOwordm9pZCBwdl9jcHVp
ZCh1aW50MzJfdCBsZWFmLCB1aW50MzJfdCBzdWJsZWFmLAorICAgICAgICAg
ICAgICB1aW50MzJfdCAqZWF4LCB1aW50MzJfdCAqZWJ4LCB1aW50MzJfdCAq
ZWN4LCB1aW50MzJfdCAqZWR4KTsKKworc3RhdGljIGlubGluZSB2b2lkIHB2
X2NwdWlkX3JlZ3Moc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCit7Cisg
ICAgcHZfY3B1aWQocmVncy0+X2VheCwgcmVncy0+X2VjeCwKKyAgICAgICAg
ICAgICAmcmVncy0+X2VheCwgJnJlZ3MtPl9lYngsICZyZWdzLT5fZWN4LCAm
cmVncy0+X2VkeCk7Cit9CiAKICNlbmRpZiAvKiAhX19BU1NFTUJMWV9fICov
CiAK

--=separator
Content-Type: application/octet-stream; name="xsa293/4.8-2.patch"
Content-Disposition: attachment; filename="xsa293/4.8-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBSZXdyaXRlIGd1ZXN0ICVjcjQgaGFuZGxp
bmcgZnJvbSBzY3JhdGNoCgpUaGUgUFYgY3I0IGxvZ2ljIGlzIGFsbW9zdCBp
bXBvc3NpYmxlIHRvIGZvbGxvdywgYW5kIGxlYWtzIGJpdHMgaW50byBndWVz
dApjb250ZXh0IHdoaWNoIGRlZmluaXRlbHkgc2hvdWxkbid0IGJlIHZpc2li
bGUgKGluIHBhcnRpY3VsYXIsIFZNWEUpLgoKVGhlIGJpZ2dlc3QgcHJvYmxl
bSBob3dldmVyLCBhbmQgc291cmNlIG9mIHRoZSBjb21wbGV4aXR5LCBpcyB0
aGF0IGl0IGRlcml2ZXMKbmV3IHJlYWwgYW5kIGd1ZXN0IGNyNCB2YWx1ZXMg
ZnJvbSB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZSAtIHRoaXMgaXMK
Y29udGV4dCBkZXBlbmRlbnQgYW5kIGFuIGluYXBwcm9wcmlhdGUgc291cmNl
IG9mIGluZm9ybWF0aW9uLgoKUmV3cml0ZSB0aGUgY3I0IGxvZ2ljIHRvIGJl
IGludmFyaWFudCBvZiB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZS4K
CkZpcnN0IG9mIGFsbCwgbW9kaWZ5IHdyaXRlX3B0YmFzZSgpIHRvIGFsd2F5
cyB1c2UgbW11X2NyNF9mZWF0dXJlcyBmb3IgSURMRQphbmQgSFZNIGNvbnRl
eHRzLiAgbW11X2NyNF9mZWF0dXJlcyAqaXMqIHRoZSBjb3JyZWN0IHZhbHVl
IHRvIHVzZSwgYW5kIG1ha2VzCnRoZSBBU1NFUlQoKSBvYnZpb3VzbHkgcmVk
dW5kYW50LgoKRm9yIFBWIGd1ZXN0cywgY3Vyci0+YXJjaC5wdi5jdHJscmVn
WzRdIHJlbWFpbnMgdGhlIGd1ZXN0cyB2aWV3IG9mIGNyNCwgYnV0CmFsbCBs
b2dpYyBnZXRzIHJld29ya2VkIGluIHRlcm1zIG9mIHRoaXMgYW5kIG1tdV9j
cjRfZmVhdHVyZXMgb25seS4KClR3byBtYXNrcyBhcmUgaW50cm9kdWNlZDsg
Yml0cyB3aGljaCB0aGUgZ3Vlc3QgaGFzIGNvbnRyb2wgb3ZlciwgYW5kIGJp
dHMKd2hpY2ggYXJlIGZvcndhcmRlZCBmcm9tIFhlbidzIHNldHRpbmdzLiAg
T25lIGd1ZXN0LXZpc2libGUgY2hhbmdlIGhlcmUgaXMKdGhhdCBYZW4ncyBW
TVhFIHNldHRpbmcgaXMgbm8gbG9uZ2VyIHZpc2libGUgYXQgYWxsLgoKcHZf
bWFrZV9jcjQoKSBmb2xsb3dzIGZhaXJseSBjbG9zZWx5IGZyb20gcHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KCksIGJ1dApkZWxpYmVyYXRlbHkgc3RhcnRz
IHdpdGggbW11X2NyNF9mZWF0dXJlcywgYW5kIG9ubHkgYWx0ZXJzIHRoZSBt
aW5pbWFsIHN1YnNldApvZiBiaXRzLgoKVGhlIGJvb3QtdGltZSB7Y29tcGF0
Xyx9cHZfY3I0X21hc2sgdmFyaWFibGVzIGFyZSByZW1vdmVkLCBhcyB0aGV5
IGFyZSBhCnJlbW5hbnQgb2YgdGhlIHByZS1DUFVJRCBwb2xpY3kgZGF5cy4g
IHB2X2ZpeHVwX2d1ZXN0X2NyNCgpIGdhaW5zIGEgcmVsYXRlZApkZXJpdmF0
aW9uIGZyb20gdGhlIHBvbGljeS4KCkFub3RoZXIgZ3Vlc3QgdmlzaWJsZSBj
aGFuZ2UgaGVyZSBpcyB0aGF0IGEgMzJiaXQgUFYgZ3Vlc3QgY2FuIG5vdyBm
bGlwCkZTR1NCQVNFIGluIGl0cyB2aWV3IG9mIENSNC4gIFdoaWxlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25zIGFyZQp1bnVzYWJsZSBv
dXRzaWRlIG9mIGEgNjRiaXQgY29kZSBzZWdtZW50LCB0aGUgYWJpbGl0eSB0
byBtb2RpZnkgRlNHU0JBU0UKbWF0Y2hlcyByZWFsIGhhcmR3YXJlIGJlaGF2
aW91ciwgYW5kIGF2b2lkcyB0aGUgbmVlZCBmb3IgYW55IDMyYml0LzY0Yml0
CmRpZmZlcmVuY2VzIGluIHRoZSBsb2dpYy4KCk92ZXJhbGwsIHRoaXMgcGF0
Y2ggc2hvdWxkbid0IGhhdmUgYSBwcmFjdGljYWwgY2hhbmdlIGluIGd1ZXN0
IGJlaGF2aW91ci4KVk1YRSB3aWxsIGRpc2FwcGVhciBmcm9tIHZpZXcsIGFu
ZCBhbiBpbnF1aXNpdGl2ZSAzMmJpdCBrZXJuZWwgY2FuIG5vdyBzZWUKRlNH
U0JBU0UgY2hhbmdpbmcsIGJ1dCB0aGlzIG5ldyBsb2dpYyBpcyBvdGhlcndp
c2UgYnVnLWNvbXBhdGlibGUgd2l0aCBiZWZvcmUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTI5MwoKUmVwb3J0ZWQtYnk6IEFuZHkgTHV0b21pcnNraSA8bHV0
b0BrZXJuZWwub3JnPgpTaWduZWQtb2ZmLWJ5OiBBbmRyZXcgQ29vcGVyIDxh
bmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpSZXZpZXdlZC1ieTogSmFuIEJl
dWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9kb21haW4uYyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwppbmRl
eCA0MDhmYzBiLi42YzM4ZDg0IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
ZG9tYWluLmMKKysrIGIveGVuL2FyY2gveDg2L2RvbWFpbi5jCkBAIC0zNzcs
NiArMzc3LDYwIEBAIHN0YXRpYyB2b2lkIHJlbGVhc2VfY29tcGF0X2w0KHN0
cnVjdCB2Y3B1ICp2KQogICAgIHYtPmFyY2guZ3Vlc3RfdGFibGVfdXNlciA9
IHBhZ2V0YWJsZV9udWxsKCk7CiB9CiAKK3Vuc2lnbmVkIGxvbmcgcHZfZml4
dXBfZ3Vlc3RfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBs
b25nIGNyNCkKK3sKKyAgICB1bnNpZ25lZCBpbnQgbGVhZjFfZWN4ID0gMCwg
bGVhZjFfZWR4ID0gMDsKKyAgICB1bnNpZ25lZCBpbnQgbGVhZjdfMF9lYngg
PSAwOworCisgICAgcHZfY3B1aWQoMSwgMCwgTlVMTCwgTlVMTCwgJmxlYWYx
X2VjeCwgJmxlYWYxX2VkeCk7CisgICAgcHZfY3B1aWQoNywgMCwgTlVMTCwg
JmxlYWY3XzBfZWJ4LCBOVUxMLCBOVUxMKTsKKworICAgIC8qIERpc2NhcmQg
YXR0ZW1wdHMgdG8gc2V0IGd1ZXN0IGNvbnRyb2xsYWJsZSBiaXRzIG91dHNp
ZGUgb2YgdGhlIHBvbGljeS4gKi8KKyAgICBjcjQgJj0gfigoKGxlYWYxX2Vk
eCAmIGNwdWZlYXRfbWFzayhYODZfRkVBVFVSRV9UU0MpKQorICAgICAgICAg
ICAgICA/IDAgOiBYODZfQ1I0X1RTRCkgfAorICAgICAgICAgICAgICgobGVh
ZjFfZWR4ICYgY3B1ZmVhdF9tYXNrKFg4Nl9GRUFUVVJFX0RFKSkKKyAgICAg
ICAgICAgICAgPyAwIDogWDg2X0NSNF9ERSkgfAorICAgICAgICAgICAgICgo
bGVhZjdfMF9lYnggJiBjcHVmZWF0X21hc2soWDg2X0ZFQVRVUkVfRlNHU0JB
U0UpKQorICAgICAgICAgICAgICA/IDAgOiBYODZfQ1I0X0ZTR1NCQVNFKSB8
CisgICAgICAgICAgICAgKChsZWFmMV9lY3ggJiBjcHVmZWF0X21hc2soWDg2
X0ZFQVRVUkVfWFNBVkUpKQorICAgICAgICAgICAgICA/IDAgOiBYODZfQ1I0
X09TWFNBVkUpKTsKKworICAgIC8qIE1hc2tzIGV4cGVjdGVkIHRvIGJlIGRp
c2pvaW50IHNldHMuICovCisgICAgQlVJTERfQlVHX09OKFBWX0NSNF9HVUVT
VF9NQVNLICYgUFZfQ1I0X0dVRVNUX1ZJU0lCTEVfTUFTSyk7CisKKyAgICAv
KgorICAgICAqIEEgZ3Vlc3Qgc2VlcyB0aGUgcG9saWN5IHN1YnNldCBvZiBp
dHMgb3duIGNob2ljZSBvZiBndWVzdCBjb250cm9sbGFibGUKKyAgICAgKiBi
aXRzLCBhbmQgYSBzdWJzZXQgb2YgWGVuJ3MgY2hvaWNlIG9mIGNlcnRhaW4g
aGFyZHdhcmUgc2V0dGluZ3MuCisgICAgICovCisgICAgcmV0dXJuICgoY3I0
ICYgUFZfQ1I0X0dVRVNUX01BU0spIHwKKyAgICAgICAgICAgIChtbXVfY3I0
X2ZlYXR1cmVzICYgUFZfQ1I0X0dVRVNUX1ZJU0lCTEVfTUFTSykpOworfQor
Cit1bnNpZ25lZCBsb25nIHB2X21ha2VfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1
ICp2KQoreworICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21h
aW47CisgICAgdW5zaWduZWQgbG9uZyBjcjQgPSBtbXVfY3I0X2ZlYXR1cmVz
ICYKKyAgICAgICAgfihYODZfQ1I0X1BDSURFIHwgWDg2X0NSNF9QR0UgfCBY
ODZfQ1I0X1RTRCk7CisKKyAgICAvKgorICAgICAqIFBDSURFIG9yIFBHRSBk
ZXBlbmRzIG9uIHRoZSBQQ0lEL1hQVEkgc2V0dGluZ3MsIGJ1dCBtdXN0IG5v
dCBib3RoIGJlCisgICAgICogc2V0LCBhcyBpdCBpbXBhY3RzIHRoZSBzYWZl
dHkgb2YgVExCIGZsdXNoaW5nLgorICAgICAqLworICAgIGlmICggZC0+YXJj
aC5wdl9kb21haW4ucGNpZCApCisgICAgICAgIGNyNCB8PSBYODZfQ1I0X1BD
SURFOworICAgIGVsc2UgaWYgKCAhZC0+YXJjaC5wdl9kb21haW4ueHB0aSAp
CisgICAgICAgIGNyNCB8PSBYODZfQ1I0X1BHRTsKKworICAgIC8qCisgICAg
ICogVFNEIGlzIG5lZWRlZCBpZiBlaXRoZXIgdGhlIGd1ZXN0IGhhcyBlbGVj
dGVkIHRvIHVzZSBpdCwgb3IgWGVuIGlzCisgICAgICogdmlydHVhbGlzaW5n
IHRoZSBUU0MgdmFsdWUgdGhlIGd1ZXN0IHNlZXMuCisgICAgICovCisgICAg
aWYgKCBkLT5hcmNoLnZ0c2MgfHwgKHYtPmFyY2gucHZfdmNwdS5jdHJscmVn
WzRdICYgWDg2X0NSNF9UU0QpICkKKyAgICAgICAgY3I0IHw9IFg4Nl9DUjRf
VFNEOworCisgICAgcmV0dXJuIGNyNDsKK30KKwogc3RhdGljIHZvaWQgc2V0
X2RvbWFpbl94cHRpKHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAgaWYgKCBp
c19wdl8zMmJpdF9kb21haW4oZCkgKQpAQCAtNTY0LDYgKzYxOCw4IEBAIGlu
dCB2Y3B1X2luaXRpYWxpc2Uoc3RydWN0IHZjcHUgKnYpCiAKICAgICAgICAg
LyogUFYgZ3Vlc3RzIGJ5IGRlZmF1bHQgaGF2ZSBhIDEwMEh6IHRpY2tlci4g
Ki8KICAgICAgICAgdi0+cGVyaW9kaWNfcGVyaW9kID0gTUlMTElTRUNTKDEw
KTsKKworICAgICAgICB2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHB2
X2ZpeHVwX2d1ZXN0X2NyNCh2LCAwKTsKICAgICB9CiAKICAgICB2LT5hcmNo
LnNjaGVkdWxlX3RhaWwgPSBjb250aW51ZV9ub25pZGxlX2RvbWFpbjsKQEAg
LTU3Niw4ICs2MzIsNiBAQCBpbnQgdmNwdV9pbml0aWFsaXNlKHN0cnVjdCB2
Y3B1ICp2KQogICAgICAgICB2LT5hcmNoLmNyMyAgICAgICAgICAgPSBfX3Bh
KGlkbGVfcGdfdGFibGUpOwogICAgIH0KIAotICAgIHYtPmFyY2gucHZfdmNw
dS5jdHJscmVnWzRdID0gcmVhbF9jcjRfdG9fcHZfZ3Vlc3RfY3I0KG1tdV9j
cjRfZmVhdHVyZXMpOwotCiAgICAgaWYgKCBpc19wdl8zMmJpdF9kb21haW4o
ZCkgKQogICAgIHsKICAgICAgICAgaWYgKCAocmMgPSBzZXR1cF9jb21wYXRf
YXJnX3hsYXQodikpICkKQEAgLTk1NSw0OSArMTAwOSw2IEBAIGludCBhcmNo
X2RvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVjdCBkb21haW4gKmQpCiAgICAgcmV0
dXJuIHJldDsKIH0KIAotLyoKLSAqIFRoZXNlIGFyZSB0aGUgbWFza3Mgb2Yg
Q1I0IGJpdHMgKHN1YmplY3QgdG8gaGFyZHdhcmUgYXZhaWxhYmlsaXR5KSB3
aGljaCBhCi0gKiBQViBndWVzdCBtYXkgbm90IGxlZ2l0aW1pYXRlbHkgYXR0
ZW1wdCB0byBtb2RpZnkuCi0gKi8KLXN0YXRpYyB1bnNpZ25lZCBsb25nIF9f
cmVhZF9tb3N0bHkgcHZfY3I0X21hc2ssIGNvbXBhdF9wdl9jcjRfbWFzazsK
LQotc3RhdGljIGludCBfX2luaXQgaW5pdF9wdl9jcjRfbWFza3Modm9pZCkK
LXsKLSAgICB1bnNpZ25lZCBsb25nIGNvbW1vbl9tYXNrID0gflg4Nl9DUjRf
VFNEOwotCi0gICAgLyoKLSAgICAgKiBBbGwgUFYgZ3Vlc3RzIG1heSBhdHRl
bXB0IHRvIG1vZGlmeSBUU0QsIERFIGFuZCBPU1hTQVZFLgotICAgICAqLwot
ICAgIGlmICggY3B1X2hhc19kZSApCi0gICAgICAgIGNvbW1vbl9tYXNrICY9
IH5YODZfQ1I0X0RFOwotICAgIGlmICggY3B1X2hhc194c2F2ZSApCi0gICAg
ICAgIGNvbW1vbl9tYXNrICY9IH5YODZfQ1I0X09TWFNBVkU7Ci0KLSAgICBw
dl9jcjRfbWFzayA9IGNvbXBhdF9wdl9jcjRfbWFzayA9IGNvbW1vbl9tYXNr
OwotCi0gICAgLyoKLSAgICAgKiA2NGJpdCBQViBndWVzdHMgbWF5IGF0dGVt
cHQgdG8gbW9kaWZ5IEZTR1NCQVNFLgotICAgICAqLwotICAgIGlmICggY3B1
X2hhc19mc2dzYmFzZSApCi0gICAgICAgIHB2X2NyNF9tYXNrICY9IH5YODZf
Q1I0X0ZTR1NCQVNFOwotCi0gICAgcmV0dXJuIDA7Ci19Ci1fX2luaXRjYWxs
KGluaXRfcHZfY3I0X21hc2tzKTsKLQotdW5zaWduZWQgbG9uZyBwdl9ndWVz
dF9jcjRfZml4dXAoY29uc3Qgc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGxv
bmcgZ3Vlc3RfY3I0KQotewotICAgIHVuc2lnbmVkIGxvbmcgaHZfY3I0ID0g
cmVhbF9jcjRfdG9fcHZfZ3Vlc3RfY3I0KHJlYWRfY3I0KCkpOwotICAgIHVu
c2lnbmVkIGxvbmcgbWFzayA9IGlzX3B2XzMyYml0X3ZjcHUodikgPyBjb21w
YXRfcHZfY3I0X21hc2sgOiBwdl9jcjRfbWFzazsKLQotICAgIGlmICggKGd1
ZXN0X2NyNCAmIG1hc2spICE9IChodl9jcjQgJiBtYXNrKSApCi0gICAgICAg
IHByaW50ayhYRU5MT0dfR19XQVJOSU5HCi0gICAgICAgICAgICAgICAiZCVk
IGF0dGVtcHRlZCB0byBjaGFuZ2UgJXB2J3MgQ1I0IGZsYWdzICUwOGx4IC0+
ICUwOGx4XG4iLAotICAgICAgICAgICAgICAgY3VycmVudC0+ZG9tYWluLT5k
b21haW5faWQsIHYsIGh2X2NyNCwgZ3Vlc3RfY3I0KTsKLQotICAgIHJldHVy
biAoaHZfY3I0ICYgbWFzaykgfCAoZ3Vlc3RfY3I0ICYgfm1hc2spOwotfQot
CiAjZGVmaW5lIHhlbl92Y3B1X2d1ZXN0X2NvbnRleHQgdmNwdV9ndWVzdF9j
b250ZXh0CiAjZGVmaW5lIGZwdV9jdHh0IGZwdV9jdHh0LngKIENIRUNLX0ZJ
RUxEXyhzdHJ1Y3QsIHZjcHVfZ3Vlc3RfY29udGV4dCwgZnB1X2N0eHQpOwpA
QCAtMTAxMSw3ICsxMDIyLDcgQEAgaW50IGFyY2hfc2V0X2luZm9fZ3Vlc3Qo
CiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKICAgICB1bnNp
Z25lZCBsb25nIGNyM19nZm47CiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqY3Iz
X3BhZ2U7Ci0gICAgdW5zaWduZWQgbG9uZyBmbGFncywgY3I0OworICAgIHVu
c2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgdW5zaWduZWQgaW50IGk7CiAgICAg
aW50IHJjID0gMCwgY29tcGF0OwogCkBAIC0xMjI4LDkgKzEyMzksOCBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICB2LT5hcmNoLnB2X3ZjcHUu
Y3RybHJlZ1swXSAmPSBYODZfQ1IwX1RTOwogICAgIHYtPmFyY2gucHZfdmNw
dS5jdHJscmVnWzBdIHw9IHJlYWRfY3IwKCkgJiB+WDg2X0NSMF9UUzsKIAot
ICAgIGNyNCA9IHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdOwotICAgIHYt
PmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gY3I0ID8gcHZfZ3Vlc3RfY3I0
X2ZpeHVwKHYsIGNyNCkgOgotICAgICAgICByZWFsX2NyNF90b19wdl9ndWVz
dF9jcjQobW11X2NyNF9mZWF0dXJlcyk7CisgICAgdi0+YXJjaC5wdl92Y3B1
LmN0cmxyZWdbNF0gPQorICAgICAgICBwdl9maXh1cF9ndWVzdF9jcjQodiwg
di0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0pOwogCiAgICAgbWVtc2V0KHYt
PmFyY2guZGVidWdyZWcsIDAsIHNpemVvZih2LT5hcmNoLmRlYnVncmVnKSk7
CiAgICAgZm9yICggaSA9IDA7IGkgPCA4OyBpKysgKQpkaWZmIC0tZ2l0IGEv
eGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAy
YjkzZWZiLi40ZTk4ZjgyIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNTAxLDMzICs1MDEsMTMg
QEAgdm9pZCBtYWtlX2NyMyhzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgbG9u
ZyBtZm4pCiAgICAgICAgIHYtPmFyY2guY3IzIHw9IGdldF9wY2lkX2JpdHMo
diwgZmFsc2UpOwogfQogCi11bnNpZ25lZCBsb25nIHB2X2d1ZXN0X2NyNF90
b19yZWFsX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdikKLXsKLSAgICBjb25z
dCBzdHJ1Y3QgZG9tYWluICpkID0gdi0+ZG9tYWluOwotICAgIHVuc2lnbmVk
IGxvbmcgY3I0OwotCi0gICAgY3I0ID0gdi0+YXJjaC5wdl92Y3B1LmN0cmxy
ZWdbNF0gJiB+WDg2X0NSNF9ERTsKLSAgICBjcjQgfD0gbW11X2NyNF9mZWF0
dXJlcyAmIChYODZfQ1I0X1BTRSB8IFg4Nl9DUjRfU01FUCB8IFg4Nl9DUjRf
U01BUCB8Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWDg2X0NS
NF9PU1hTQVZFIHwgWDg2X0NSNF9GU0dTQkFTRSk7Ci0KLSAgICBpZiAoIGQt
PmFyY2gucHZfZG9tYWluLnBjaWQgKQotICAgICAgICBjcjQgfD0gWDg2X0NS
NF9QQ0lERTsKLSAgICBlbHNlIGlmICggIWQtPmFyY2gucHZfZG9tYWluLnhw
dGkgKQotICAgICAgICBjcjQgfD0gWDg2X0NSNF9QR0U7Ci0KLSAgICBjcjQg
fD0gZC0+YXJjaC52dHNjID8gWDg2X0NSNF9UU0QgOiAwOwotCi0gICAgcmV0
dXJuIGNyNDsKLX0KLQogdm9pZCB3cml0ZV9wdGJhc2Uoc3RydWN0IHZjcHUg
KnYpCiB7CiAgICAgc3RydWN0IGNwdV9pbmZvICpjcHVfaW5mbyA9IGdldF9j
cHVfaW5mbygpOwogICAgIHVuc2lnbmVkIGxvbmcgbmV3X2NyNDsKIAogICAg
IG5ld19jcjQgPSAoaXNfcHZfdmNwdSh2KSAmJiAhaXNfaWRsZV92Y3B1KHYp
KQotICAgICAgICAgICAgICA/IHB2X2d1ZXN0X2NyNF90b19yZWFsX2NyNCh2
KQotICAgICAgICAgICAgICA6ICgocmVhZF9jcjQoKSAmIH4oWDg2X0NSNF9Q
Q0lERSB8IFg4Nl9DUjRfVFNEKSkgfCBYODZfQ1I0X1BHRSk7CisgICAgICAg
ICAgICAgID8gcHZfbWFrZV9jcjQodikgOiBtbXVfY3I0X2ZlYXR1cmVzOwog
CiAgICAgaWYgKCBpc19wdl92Y3B1KHYpICYmIHYtPmRvbWFpbi0+YXJjaC5w
dl9kb21haW4ueHB0aSApCiAgICAgewpAQCAtNTQ2LDggKzUyNiw2IEBAIHZv
aWQgd3JpdGVfcHRiYXNlKHN0cnVjdCB2Y3B1ICp2KQogICAgICAgICBzd2l0
Y2hfY3IzX2NyNCh2LT5hcmNoLmNyMywgbmV3X2NyNCk7CiAgICAgICAgIGNw
dV9pbmZvLT5wdl9jcjMgPSAwOwogICAgIH0KLQotICAgIEFTU0VSVChpc19w
dl92Y3B1KHYpIHx8IHJlYWRfY3I0KCkgPT0gbW11X2NyNF9mZWF0dXJlcyk7
CiB9CiAKIC8qCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvdHJhcHMuYyBi
L3hlbi9hcmNoL3g4Ni90cmFwcy5jCmluZGV4IDc3Zjc4NmMuLmE4YWViZTUg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni90cmFwcy5jCisrKyBiL3hlbi9h
cmNoL3g4Ni90cmFwcy5jCkBAIC05NjYsNyArOTY2LDggQEAgc3RhdGljIHZv
aWQgX2RvbWFpbl9jcHVpZChjb25zdCBzdHJ1Y3QgZG9tYWluICpjdXJyZCwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICplYXgs
IHVuc2lnbmVkIGludCAqZWJ4LAogICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgKmVjeCwgdW5zaWduZWQgaW50ICplZHgpCiB7Ci0g
ICAgaWYgKCAhaXNfY29udHJvbF9kb21haW4oY3VycmQpICYmICFpc19oYXJk
d2FyZV9kb21haW4oY3VycmQpICkKKyAgICBpZiAoICFpc19jb250cm9sX2Rv
bWFpbihjdXJyZCkgJiYgIWlzX2hhcmR3YXJlX2RvbWFpbihjdXJyZCkgJiYK
KyAgICAgICAgICFpc19pZGxlX2RvbWFpbihjdXJyZCkgKQogICAgICAgICBk
b21haW5fY3B1aWQoY3VycmQsIGxlYWYsIHN1YmxlYWYsIGVheCwgZWJ4LCBl
Y3gsIGVkeCk7CiAgICAgZWxzZQogICAgICAgICBjcHVpZF9jb3VudChsZWFm
LCBzdWJsZWFmLCBlYXgsIGVieCwgZWN4LCBlZHgpOwpAQCAtMjM3Miw4ICsy
MzczLDggQEAgc3RhdGljIGludCBwcml2X29wX3dyaXRlX2NyKHVuc2lnbmVk
IGludCByZWcsIHVuc2lnbmVkIGxvbmcgdmFsLAogICAgIH0KIAogICAgIGNh
c2UgNDogLyogV3JpdGUgQ1I0ICovCi0gICAgICAgIGN1cnItPmFyY2gucHZf
dmNwdS5jdHJscmVnWzRdID0gcHZfZ3Vlc3RfY3I0X2ZpeHVwKGN1cnIsIHZh
bCk7Ci0gICAgICAgIHdyaXRlX2NyNChwdl9ndWVzdF9jcjRfdG9fcmVhbF9j
cjQoY3VycikpOworICAgICAgICBjdXJyLT5hcmNoLnB2X3ZjcHUuY3RybHJl
Z1s0XSA9IHB2X2ZpeHVwX2d1ZXN0X2NyNChjdXJyLCB2YWwpOworICAgICAg
ICB3cml0ZV9jcjQocHZfbWFrZV9jcjQoY3VycikpOwogICAgICAgICBjdHh0
X3N3aXRjaF9sZXZlbGxpbmcoY3Vycik7CiAgICAgICAgIHJldHVybiBYODZF
TVVMX09LQVk7CiAgICAgfQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNt
LXg4Ni9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWluLmgK
aW5kZXggZTdhYmFhZC4uMDEzNzI4MyAxMDA2NDQKLS0tIGEveGVuL2luY2x1
ZGUvYXNtLXg4Ni9kb21haW4uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2
L2RvbWFpbi5oCkBAIC02NDIsMTYgKzY0MiwyMiBAQCBib29sX3QgdXBkYXRl
X3NlY29uZGFyeV9zeXN0ZW1fdGltZShzdHJ1Y3QgdmNwdSAqLAogdm9pZCB2
Y3B1X3Nob3dfZXhlY3V0aW9uX3N0YXRlKHN0cnVjdCB2Y3B1ICopOwogdm9p
ZCB2Y3B1X3Nob3dfcmVnaXN0ZXJzKGNvbnN0IHN0cnVjdCB2Y3B1ICopOwog
Ci0vKiBDbGVhbiB1cCBDUjQgYml0cyB0aGF0IGFyZSBub3QgdW5kZXIgZ3Vl
c3QgY29udHJvbC4gKi8KLXVuc2lnbmVkIGxvbmcgcHZfZ3Vlc3RfY3I0X2Zp
eHVwKGNvbnN0IHN0cnVjdCB2Y3B1ICosIHVuc2lnbmVkIGxvbmcgZ3Vlc3Rf
Y3I0KTsKKy8qCisgKiBCaXRzIHdoaWNoIGEgUFYgZ3Vlc3QgY2FuIHRvZ2ds
ZSBpbiBpdHMgdmlldyBvZiBjcjQuICBTb21lIGFyZSBsb2FkZWQgaW50bwor
ICogaGFyZHdhcmUsIHdoaWxlIHNvbWUgYXJlIGZ1bGx5IGVtdWxhdGVkLgor
ICovCisjZGVmaW5lIFBWX0NSNF9HVUVTVF9NQVNLIFwKKyAgICAoWDg2X0NS
NF9UU0QgfCBYODZfQ1I0X0RFIHwgWDg2X0NSNF9GU0dTQkFTRSB8IFg4Nl9D
UjRfT1NYU0FWRSkKKworLyogQml0cyB3aGljaCBhIFBWIGd1ZXN0IG1heSBv
YnNlcnZlIGZyb20gdGhlIHJlYWwgaGFyZHdhcmUgc2V0dGluZ3MuICovCisj
ZGVmaW5lIFBWX0NSNF9HVUVTVF9WSVNJQkxFX01BU0sgXAorICAgIChYODZf
Q1I0X1BBRSB8IFg4Nl9DUjRfTUNFIHwgWDg2X0NSNF9PU0ZYU1IgfCBYODZf
Q1I0X09TWE1NRVhDUFQpCiAKLS8qIENvbnZlcnQgYmV0d2VlbiBndWVzdC12
aXNpYmxlIGFuZCByZWFsIENSNCB2YWx1ZXMuICovCi11bnNpZ25lZCBsb25n
IHB2X2d1ZXN0X2NyNF90b19yZWFsX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAq
dik7CisvKiBHaXZlbiBhIG5ldyBjcjQgdmFsdWUsIGNvbnN0cnVjdCB0aGUg
cmVzdWx0aW5nIGd1ZXN0LXZpc2libGUgY3I0IHZhbHVlLiAqLwordW5zaWdu
ZWQgbG9uZyBwdl9maXh1cF9ndWVzdF9jcjQoY29uc3Qgc3RydWN0IHZjcHUg
KnYsIHVuc2lnbmVkIGxvbmcgY3I0KTsKIAotI2RlZmluZSByZWFsX2NyNF90
b19wdl9ndWVzdF9jcjQoYykgICAgICAgICAgICAgICAgICAgICAgICAgXAot
ICAgICgoYykgJiB+KFg4Nl9DUjRfUEdFIHwgWDg2X0NSNF9QU0UgfCBYODZf
Q1I0X1RTRCB8ICAgICAgXAotICAgICAgICAgICAgIFg4Nl9DUjRfT1NYU0FW
RSB8IFg4Nl9DUjRfU01FUCB8ICAgICAgICAgICAgICAgXAotICAgICAgICAg
ICAgIFg4Nl9DUjRfRlNHU0JBU0UgfCBYODZfQ1I0X1NNQVAgfCBYODZfQ1I0
X1BDSURFKSkKKy8qIENyZWF0ZSBhIGNyNCB2YWx1ZSB0byBsb2FkIGludG8g
aGFyZHdhcmUsIGJhc2VkIG9uIHZjcHUgc2V0dGluZ3MuICovCit1bnNpZ25l
ZCBsb25nIHB2X21ha2VfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2KTsKIAog
dm9pZCBkb21haW5fY3B1aWQoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwKICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAgaW5wdXQsCg==

--=separator
Content-Type: application/octet-stream; name="xsa293/4.8-3.patch"
Content-Disposition: attachment; filename="xsa293/4.8-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBEb24ndCBoYXZlICVjcjQuZnNnc2Jhc2Ug
YWN0aXZlIGJlaGluZCBhIGd1ZXN0IGtlcm5lbHMgYmFjawoKQ3VycmVudGx5
LCBhIDY0Yml0IFBWIGd1ZXN0IGNhbiBhcHBlYXIgdG8gc2V0IGFuZCBjbGVh
ciBGU0dTQkFTRSBpbiAlY3I0LCBidXQKdGhlIGJpdCByZW1haW5zIHNldCBp
biBoYXJkd2FyZS4gIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17RlMsR1N9QkFT
RSBhcmUgdXNhYmxlCmV2ZW4gd2hlbiB0aGUgZ3Vlc3Qga2VybmVsIGJlbGll
dmVzIHRoYXQgdGhleSBhcmUgZGlzYWJsZWQuCgpUaGUgRlNHU0JBU0UgZmVh
dHVyZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIExpbnV4LCBhbmQg
aXRzIGNvbnRleHQKc3dpdGNoIHBhdGggaGFzIHNvbWUgb3B0aW1pc2F0aW9u
cyB3aGljaCByZWx5IG9uIHVzZXJzcGFjZSBiZWluZyB1bmFibGUgdG8gdXNl
CnRoZSBXUntGUyxHU31CQVNFIGluc3RydWN0aW9ucy4gIFhlbidzIGN1cnJl
bnQgYmVoYXZpb3VyIHVuZGVybWluZXMgdGhpcwpleHBlY3RhdGlvbi4KCklu
IDY0Yml0IFBWIGd1ZXN0IGNvbnRleHQsIGFsd2F5cyBsb2FkIHRoZSBndWVz
dCBrZXJuZWxzIHNldHRpbmcgb2YgRlNHU0JBU0UKaW50byAlY3I0LiAgVGhp
cyByZXF1aXJlcyBhZGp1c3RpbmcgaG93IFhlbiB1c2VzIHRoZSB7UkQsV1J9
e0ZTLEdTfUJBU0UKaW5zdHJ1Y3Rpb25zLgoKICogRGVsZXRlIHRoZSBjcHVf
aGFzX2ZzZ3NiYXNlIGhlbHBlci4gIEl0IGlzIG5vIGxvbmdlciBzYWZlLCBh
cyB1c2VycyBuZWVkIHRvCiAgIGNoZWNrICVjcjQgZGlyZWN0bHkuCiAqIFRo
ZSByYXcgX19yZHtmcyxnc31iYXNlKCkgaGVscGVycyBhcmUgb25seSBzYWZl
IHRvIHVzZSB3aGVuICVjcjQuZnNnc2Jhc2UKICAgaXMgc2V0LiAgQ29tbWVu
dCB0aGlzIHByb3BlcnR5LgogKiBUaGUge3JkLHdyfXtmcyxnc317YmFzZSxz
aGFkb3d9KCkgYW5kIHJlYWRfbXNyKCkgaGVscGVycyBhcmUgdXBkYXRlZCB0
byB1c2UKICAgdGhlIGN1cnJlbnQgJWNyNCB2YWx1ZSB0byBkZXRlcm1pbmUg
d2hpY2ggbWVjaGFuaXNtIHRvIHVzZS4KICogdG9nZ2xlX2d1ZXN0X21vZGUo
KSBhbmQgc2F2ZV9zZWdtZW50cygpIGFyZSB1cGRhdGUgdG8gYXZvaWQgcmVh
ZGluZwogICBmcy9nc2Jhc2UgaWYgdGhlIHZhbHVlcyBpbiBoYXJkd2FyZSBj
YW5ub3QgYmUgc3RhbGUgV1JUIHN0cnVjdCB2Y3B1LiAgQQogICBjb25zZXF1
ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHdyaXRlX2NyKCkgcGF0aCBuZWVk
cyB0byBjYWNoZSB0aGUgY3VycmVudAogICBiYXNlcywgYXMgc3Vic2VxdWVu
dCBjb250ZXh0IHN3aXRjaGVzIHdpbGwgc2tpcCBzYXZpbmcgdGhlIHZhbHVl
cy4KICogd3JpdGVfY3I0KCkgaXMgdXBkYXRlZCB0byBlbnN1cmUgdGhhdCB0
aGUgc2hhZG93ICVjcjQuZnNnc2Jhc2UgdmFsdWUgaXMKICAgb2JzZXJ2ZWQg
aW4gYSBzYWZlIHdheSBXUlQgdGhlIGhhcmR3YXJlIHNldHRpbmcsIGlmIGFu
IGludGVycnVwdCBoYXBwZW5zIHRvCiAgIGhpdCBpbiB0aGUgbWlkZGxlLgog
KiBwdl9tYWtlX2NyNCgpIGlzIHVwZGF0ZWQgZm9yIDY0Yml0IFBWIGd1ZXN0
cyB0byB1c2UgdGhlIGd1ZXN0IGtlcm5lbHMKICAgY2hvaWNlIG9mIEZTR1NC
QVNFLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTMKClNpZ25lZC1vZmYtYnk6
IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+ClJl
dmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Cgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVuL2FyY2gv
eDg2L2RvbWFpbi5jCmluZGV4IDEyMGYxZTMuLmQyNDZlNDAgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94ZW4vYXJjaC94ODYv
ZG9tYWluLmMKQEAgLTQyOCw2ICs0MjgsMTYgQEAgdW5zaWduZWQgbG9uZyBw
dl9tYWtlX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoIGQt
PmFyY2gudnRzYyB8fCAodi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gJiBY
ODZfQ1I0X1RTRCkgKQogICAgICAgICBjcjQgfD0gWDg2X0NSNF9UU0Q7CiAK
KyAgICAvKgorICAgICAqIFRoZSB7UkQsV1J9e0ZTLEdTfUJBU0UgYXJlIG9u
bHkgdXNlYWJsZSBpbiA2NGJpdCBjb2RlIHNlZ21lbnRzLiAgV2hpbGUKKyAg
ICAgKiB3ZSBtdXN0IG5vdCBoYXZlIENSNC5GU0dTQkFTRSBzZXQgYmVoaW5k
IHRoZSBiYWNrIG9mIGEgNjRiaXQgUFYga2VybmVsLAorICAgICAqIHdlIGRv
IGxlYXZlIGl0IHNldCBpbiAzMmJpdCBQViBjb250ZXh0IHRvIHNwZWVkIHVw
IFhlbidzIGNvbnRleHQgc3dpdGNoCisgICAgICogcGF0aC4KKyAgICAgKi8K
KyAgICBpZiAoICFpc19wdl8zMmJpdF9kb21haW4oZCkgJiYKKyAgICAgICAg
ICEodi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gJiBYODZfQ1I0X0ZTR1NC
QVNFKSApCisgICAgICAgIGNyNCAmPSB+WDg2X0NSNF9GU0dTQkFTRTsKKwog
ICAgIHJldHVybiBjcjQ7CiB9CiAKQEAgLTIwMjIsNyArMjAzMiw4IEBAIHN0
YXRpYyB2b2lkIHNhdmVfc2VnbWVudHMoc3RydWN0IHZjcHUgKnYpCiAgICAg
cmVncy0+ZnMgPSByZWFkX3NyZWcoZnMpOwogICAgIHJlZ3MtPmdzID0gcmVh
ZF9zcmVnKGdzKTsKIAotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSAmJiAh
aXNfcHZfMzJiaXRfdmNwdSh2KSApCisgICAgLyogJWZzLyVncyBiYXNlcyBj
YW4gb25seSBiZSBzdGFsZSBpZiBXUntGUyxHU31CQVNFIGFyZSB1c2FibGUu
ICovCisgICAgaWYgKCAocmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Up
ICYmICFpc19wdl8zMmJpdF92Y3B1KHYpICkKICAgICB7CiAgICAgICAgIHYt
PmFyY2gucHZfdmNwdS5mc19iYXNlID0gX19yZGZzYmFzZSgpOwogICAgICAg
ICBpZiAoIHYtPmFyY2guZmxhZ3MgJiBURl9rZXJuZWxfbW9kZSApCmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvc2V0dXAuYyBiL3hlbi9hcmNoL3g4Ni9z
ZXR1cC5jCmluZGV4IDU1MDQzNWMuLjNhN2IzNjIgMTAwNjQ0Ci0tLSBhL3hl
bi9hcmNoL3g4Ni9zZXR1cC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9zZXR1cC5j
CkBAIC0xNTA0LDcgKzE1MDQsNyBAQCB2b2lkIF9faW5pdCBub3JldHVybiBf
X3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9wKQogCiAgICAgY3I0X3B2
MzJfbWFzayA9IG1tdV9jcjRfZmVhdHVyZXMgJiBYRU5fQ1I0X1BWMzJfQklU
UzsKIAotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCBi
b290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfRlNHU0JBU0UpICkKICAgICAgICAg
c2V0X2luX2NyNChYODZfQ1I0X0ZTR1NCQVNFKTsKIAogICAgIGlmICggb3B0
X2ludnBjaWQgJiYgY3B1X2hhc19pbnZwY2lkICkKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni90cmFwcy5jIGIveGVuL2FyY2gveDg2L3RyYXBzLmMKaW5k
ZXggN2Q0NGE0Yy4uYjFjZmY1ZSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2
L3RyYXBzLmMKKysrIGIveGVuL2FyY2gveDg2L3RyYXBzLmMKQEAgLTIzNzIs
NiArMjM3MiwxNyBAQCBzdGF0aWMgaW50IHByaXZfb3Bfd3JpdGVfY3IodW5z
aWduZWQgaW50IHJlZywgdW5zaWduZWQgbG9uZyB2YWwsCiAgICAgfQogCiAg
ICAgY2FzZSA0OiAvKiBXcml0ZSBDUjQgKi8KKyAgICAgICAgLyoKKyAgICAg
ICAgICogSWYgdGhpcyB3cml0ZSB3aWxsIGRpc2FibGUgRlNHU0JBU0UsIHJl
ZnJlc2ggWGVuJ3MgaWRlYSBvZiB0aGUKKyAgICAgICAgICogZ3Vlc3QgYmFz
ZXMgbm93IHRoYXQgdGhleSBjYW4gbm8gbG9uZ2VyIGNoYW5nZS4KKyAgICAg
ICAgICovCisgICAgICAgIGlmICggKGN1cnItPmFyY2gucHZfdmNwdS5jdHJs
cmVnWzRdICYgWDg2X0NSNF9GU0dTQkFTRSkgJiYKKyAgICAgICAgICAgICAh
KHZhbCAmIFg4Nl9DUjRfRlNHU0JBU0UpICkKKyAgICAgICAgeworICAgICAg
ICAgICAgY3Vyci0+YXJjaC5wdl92Y3B1LmZzX2Jhc2UgPSBfX3JkZnNiYXNl
KCk7CisgICAgICAgICAgICBjdXJyLT5hcmNoLnB2X3ZjcHUuZ3NfYmFzZV9r
ZXJuZWwgPSBfX3JkZ3NiYXNlKCk7CisgICAgICAgIH0KKwogICAgICAgICBj
dXJyLT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHB2X2ZpeHVwX2d1ZXN0
X2NyNChjdXJyLCB2YWwpOwogICAgICAgICB3cml0ZV9jcjQocHZfbWFrZV9j
cjQoY3VycikpOwogICAgICAgICBjdHh0X3N3aXRjaF9sZXZlbGxpbmcoY3Vy
cik7CkBAIC0yNDMyLDE0ICsyNDQzLDE1IEBAIHN0YXRpYyBpbnQgcHJpdl9v
cF9yZWFkX21zcih1bnNpZ25lZCBpbnQgcmVnLCB1aW50NjRfdCAqdmFsLAog
ICAgIGNhc2UgTVNSX0ZTX0JBU0U6CiAgICAgICAgIGlmICggaXNfcHZfMzJi
aXRfZG9tYWluKGN1cnJkKSApCiAgICAgICAgICAgICBicmVhazsKLSAgICAg
ICAgKnZhbCA9IGNwdV9oYXNfZnNnc2Jhc2UgPyBfX3JkZnNiYXNlKCkgOiBj
dXJyLT5hcmNoLnB2X3ZjcHUuZnNfYmFzZTsKKyAgICAgICAgKnZhbCA9IChy
ZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSkgPyBfX3JkZnNiYXNlKCkK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgOiBjdXJyLT5hcmNoLnB2X3ZjcHUuZnNfYmFzZTsKICAgICAgICAgcmV0
dXJuIFg4NkVNVUxfT0tBWTsKIAogICAgIGNhc2UgTVNSX0dTX0JBU0U6CiAg
ICAgICAgIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGN1cnJkKSApCiAgICAg
ICAgICAgICBicmVhazsKLSAgICAgICAgKnZhbCA9IGNwdV9oYXNfZnNnc2Jh
c2UgPyBfX3JkZ3NiYXNlKCkKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOiBjdXJyLT5hcmNoLnB2X3ZjcHUuZ3NfYmFzZV9rZXJuZWw7Cisg
ICAgICAgICp2YWwgPSAocmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Up
ID8gX19yZGdzYmFzZSgpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDogY3Vyci0+YXJjaC5wdl92Y3B1LmdzX2Jh
c2Vfa2VybmVsOwogICAgICAgICByZXR1cm4gWDg2RU1VTF9PS0FZOwogCiAg
ICAgY2FzZSBNU1JfU0hBRE9XX0dTX0JBU0U6CmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYveDg2XzY0L3RyYXBzLmMgYi94ZW4vYXJjaC94ODYveDg2XzY0
L3RyYXBzLmMKaW5kZXggMzk2ZTY3Ny4uY2IyYWJiMSAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gveDg2L3g4Nl82NC90cmFwcy5jCisrKyBiL3hlbi9hcmNoL3g4
Ni94ODZfNjQvdHJhcHMuYwpAQCAtMjY3LDcgKzI2Nyw5IEBAIHZvaWQgdG9n
Z2xlX2d1ZXN0X21vZGUoc3RydWN0IHZjcHUgKnYpCiB7CiAgICAgaWYgKCBp
c19wdl8zMmJpdF92Y3B1KHYpICkKICAgICAgICAgcmV0dXJuOwotICAgIGlm
ICggY3B1X2hhc19mc2dzYmFzZSApCisKKyAgICAvKiAlZnMvJWdzIGJhc2Vz
IGNhbiBvbmx5IGJlIHN0YWxlIGlmIFdSe0ZTLEdTfUJBU0UgYXJlIHVzYWJs
ZS4gKi8KKyAgICBpZiAoIHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNF
ICkKICAgICB7CiAgICAgICAgIGlmICggdi0+YXJjaC5mbGFncyAmIFRGX2tl
cm5lbF9tb2RlICkKICAgICAgICAgICAgIHYtPmFyY2gucHZfdmNwdS5nc19i
YXNlX2tlcm5lbCA9IF9fcmRnc2Jhc2UoKTsKZGlmZiAtLWdpdCBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvY3B1ZmVhdHVyZS5oIGIveGVuL2luY2x1ZGUvYXNt
LXg4Ni9jcHVmZWF0dXJlLmgKaW5kZXggYWYyYTg5Mi4uODlmZjI0OSAxMDA2
NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmgKKysr
IGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmgKQEAgLTgwLDcg
KzgwLDYgQEAgWEVOX0NQVUZFQVRVUkUoWEVOX0xCUiwgICAgICAgICAoRlND
QVBJTlRTKzApKjMyKzI0KSAvKiBYZW4gdXNlcyBNU1JfREVCVUdDVEwuTEIK
ICNkZWZpbmUgY3B1X2hhc19ueAkJYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJF
X05YKQogI2RlZmluZSBjcHVfaGFzX2NsZmx1c2gJCWJvb3RfY3B1X2hhcyhY
ODZfRkVBVFVSRV9DTEZMVVNIKQogI2RlZmluZSBjcHVfaGFzX3BhZ2UxZ2IJ
CWJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9QQUdFMUdCKQotI2RlZmluZSBj
cHVfaGFzX2ZzZ3NiYXNlCWJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9GU0dT
QkFTRSkKICNkZWZpbmUgY3B1X2hhc19hcGVyZm1wZXJmCWJvb3RfY3B1X2hh
cyhYODZfRkVBVFVSRV9BUEVSRk1QRVJGKQogI2RlZmluZSBjcHVfaGFzX3Nt
ZXAgICAgICAgICAgICBib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfU01FUCkK
ICNkZWZpbmUgY3B1X2hhc19pbnZwY2lkICAgICAgICAgYm9vdF9jcHVfaGFz
KFg4Nl9GRUFUVVJFX0lOVlBDSUQpCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9hc20teDg2L21zci5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3IuaApp
bmRleCA1ZTFkZjhmLi4wOGVlYzMwIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVk
ZS9hc20teDg2L21zci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNy
LmgKQEAgLTEwOSw2ICsxMDksMTQgQEAgc3RhdGljIGlubGluZSB1aW50NjRf
dCByZHRzY19vcmRlcmVkKHZvaWQpCiAJCQkgIDogIj1hIiAobG93KSwgIj1k
IiAoaGlnaCkgXAogCQkJICA6ICJjIiAoY291bnRlcikpCiAKKy8qCisgKiBP
biBoYXJkd2FyZSBzdXBwb3J0aW5nIEZTR1NCQVNFLCB0aGUgdmFsdWUgbG9h
ZGVkIGludG8gaGFyZHdhcmUgaXMgdGhlCisgKiBndWVzdCBrZXJuZWwncyBj
aG9pY2UgZm9yIDY0Yml0IFBWIGd1ZXN0cyAoWGVuJ3MgY2hvaWNlIGZvciBJ
ZGxlLCBIVk0gYW5kCisgKiAzMmJpdCBQVikuCisgKgorICogVGhlcmVmb3Jl
LCB0aGUge1JELFdSfXtGUyxHU31CQVNFIGluc3RydWN0aW9ucyBhcmUgb25s
eSBzYWZlIHRvIHVzZSBpZgorICogJWNyNC5mc2dzYmFzZSBpcyBzZXQuCisg
Ki8KIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBfX3JkZnNiYXNlKHZv
aWQpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBiYXNlOwpAQCAtMTM5LDcgKzE0
Nyw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGZzYmFzZSh2
b2lkKQogewogICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKIAotICAgIGlmICgg
Y3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2
X0NSNF9GU0dTQkFTRSApCiAgICAgICAgIHJldHVybiBfX3JkZnNiYXNlKCk7
CiAKICAgICByZG1zcmwoTVNSX0ZTX0JBU0UsIGJhc2UpOwpAQCAtMTUxLDcg
KzE1OSw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGdzYmFz
ZSh2b2lkKQogewogICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKIAotICAgIGlm
ICggY3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYg
WDg2X0NSNF9GU0dTQkFTRSApCiAgICAgICAgIHJldHVybiBfX3JkZ3NiYXNl
KCk7CiAKICAgICByZG1zcmwoTVNSX0dTX0JBU0UsIGJhc2UpOwpAQCAtMTYx
LDcgKzE2OSw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGdz
YmFzZSh2b2lkKQogCiBzdGF0aWMgaW5saW5lIHZvaWQgd3Jmc2Jhc2UodW5z
aWduZWQgbG9uZyBiYXNlKQogewotICAgIGlmICggY3B1X2hhc19mc2dzYmFz
ZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSAp
CiAjaWZkZWYgSEFWRV9HQVNfRlNHU0JBU0UKICAgICAgICAgYXNtIHZvbGF0
aWxlICggIndyZnNiYXNlICUwIiA6OiAiciIgKGJhc2UpICk7CiAjZWxzZQpA
QCAtMTczLDcgKzE4MSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB3cmZzYmFz
ZSh1bnNpZ25lZCBsb25nIGJhc2UpCiAKIHN0YXRpYyBpbmxpbmUgdm9pZCB3
cmdzYmFzZSh1bnNpZ25lZCBsb25nIGJhc2UpCiB7Ci0gICAgaWYgKCBjcHVf
aGFzX2ZzZ3NiYXNlICkKKyAgICBpZiAoIHJlYWRfY3I0KCkgJiBYODZfQ1I0
X0ZTR1NCQVNFICkKICNpZmRlZiBIQVZFX0dBU19GU0dTQkFTRQogICAgICAg
ICBhc20gdm9sYXRpbGUgKCAid3Jnc2Jhc2UgJTAiIDo6ICJyIiAoYmFzZSkg
KTsKICNlbHNlCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L3By
b2Nlc3Nvci5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaApp
bmRleCA1MGJhZGFiLi5hNTMxOWUzIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVk
ZS9hc20teDg2L3Byb2Nlc3Nvci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvcHJvY2Vzc29yLmgKQEAgLTM4MCwxMSArMzgwLDMxIEBAIHN0YXRpYyBp
bmxpbmUgdW5zaWduZWQgbG9uZyByZWFkX2NyNCh2b2lkKQogCiBzdGF0aWMg
aW5saW5lIHZvaWQgd3JpdGVfY3I0KHVuc2lnbmVkIGxvbmcgdmFsKQogewor
ICAgIHN0cnVjdCBjcHVfaW5mbyAqaW5mbyA9IGdldF9jcHVfaW5mbygpOwor
CiAgICAgLyogTm8gZ2xvYmFsIHBhZ2VzIGluIGNhc2Ugb2YgUENJRHMgZW5h
YmxlZCEgKi8KICAgICBBU1NFUlQoISh2YWwgJiBYODZfQ1I0X1BHRSkgfHwg
ISh2YWwgJiBYODZfQ1I0X1BDSURFKSk7CiAKLSAgICBnZXRfY3B1X2luZm8o
KS0+Y3I0ID0gdmFsOwotICAgIGFzbSB2b2xhdGlsZSAoICJtb3YgJTAsJSVj
cjQiIDogOiAiciIgKHZhbCkgKTsKKyAgICAvKgorICAgICAqIE9uIGhhcmR3
YXJlIHN1cHBvcnRpbmcgRlNHU0JBU0UsIHRoZSB2YWx1ZSBpbiAlY3I0IGlz
IHRoZSBrZXJuZWwncworICAgICAqIGNob2ljZSBmb3IgNjRiaXQgUFYgZ3Vl
c3RzLCB3aGljaCBpbXBhY3RzIHdoZXRoZXIgWGVuIGNhbiB1c2UgdGhlCisg
ICAgICogaW5zdHJ1Y3Rpb25zLgorICAgICAqCisgICAgICogVGhlIHtyZCx3
cn17ZnMsZ3N9YmFzZSgpIGhlbHBlcnMgdXNlIGluZm8tPmNyNCB0byB3b3Jr
IG91dCB3aGV0aGVyIGl0CisgICAgICogaXMgc2FmZSB0byBleGVjdXRlIHRo
ZSB7UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb24sIGZhbGxpbmcgYmFj
ayB0bworICAgICAqIHRoZSBNU1IgcGF0aCBpZiBub3QuICBTb21lIHVzZXJz
IHJlcXVpcmUgaW50ZXJydXB0IHNhZmV0eS4KKyAgICAgKgorICAgICAqIElm
IEZTR1NCQVNFIGlzIGN1cnJlbnRseSBvciBhYm91dCB0byBiZWNvbWUgY2xl
YXIsIHJlZmxlY3QgdGhpcyBpbgorICAgICAqIGluZm8tPmNyNCBiZWZvcmUg
dXBkYXRpbmcgJWNyNCwgc28gYW4gaW50ZXJydXB0IHdoaWNoIGhpdHMgaW4g
dGhlCisgICAgICogbWlkZGxlIHdvbid0IG9ic2VydmUgRlNHU0JBU0Ugc2V0
IGluIGluZm8tPmNyNCBidXQgY2xlYXIgaW4gJWNyNC4KKyAgICAgKi8KKyAg
ICBpbmZvLT5jcjQgPSB2YWwgJiAoaW5mby0+Y3I0IHwgflg4Nl9DUjRfRlNH
U0JBU0UpOworCisgICAgYXNtIHZvbGF0aWxlICggIm1vdiAlW3ZhbF0sICUl
Y3I0IgorICAgICAgICAgICAgICAgICAgIDogIittIiAoaW5mby0+Y3I0KSAv
KiBGb3JjZSBvcmRlcmluZyB3aXRob3V0IGEgYmFycmllci4gKi8KKyAgICAg
ICAgICAgICAgICAgICA6IFt2YWxdICJyIiAodmFsKSApOworCisgICAgaW5m
by0+Y3I0ID0gdmFsOwogfQogCiAvKiBDbGVhciBhbmQgc2V0ICdUUycgYml0
IHJlc3BlY3RpdmVseSAqLwo=

--=separator
Content-Type: application/octet-stream; name="xsa293/4.9-1.patch"
Content-Disposition: attachment; filename="xsa293/4.9-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBSZXdyaXRlIGd1ZXN0ICVjcjQgaGFuZGxp
bmcgZnJvbSBzY3JhdGNoCgpUaGUgUFYgY3I0IGxvZ2ljIGlzIGFsbW9zdCBp
bXBvc3NpYmxlIHRvIGZvbGxvdywgYW5kIGxlYWtzIGJpdHMgaW50byBndWVz
dApjb250ZXh0IHdoaWNoIGRlZmluaXRlbHkgc2hvdWxkbid0IGJlIHZpc2li
bGUgKGluIHBhcnRpY3VsYXIsIFZNWEUpLgoKVGhlIGJpZ2dlc3QgcHJvYmxl
bSBob3dldmVyLCBhbmQgc291cmNlIG9mIHRoZSBjb21wbGV4aXR5LCBpcyB0
aGF0IGl0IGRlcml2ZXMKbmV3IHJlYWwgYW5kIGd1ZXN0IGNyNCB2YWx1ZXMg
ZnJvbSB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZSAtIHRoaXMgaXMK
Y29udGV4dCBkZXBlbmRlbnQgYW5kIGFuIGluYXBwcm9wcmlhdGUgc291cmNl
IG9mIGluZm9ybWF0aW9uLgoKUmV3cml0ZSB0aGUgY3I0IGxvZ2ljIHRvIGJl
IGludmFyaWFudCBvZiB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZS4K
CkZpcnN0IG9mIGFsbCwgbW9kaWZ5IHdyaXRlX3B0YmFzZSgpIHRvIGFsd2F5
cyB1c2UgbW11X2NyNF9mZWF0dXJlcyBmb3IgSURMRQphbmQgSFZNIGNvbnRl
eHRzLiAgbW11X2NyNF9mZWF0dXJlcyAqaXMqIHRoZSBjb3JyZWN0IHZhbHVl
IHRvIHVzZSwgYW5kIG1ha2VzCnRoZSBBU1NFUlQoKSBvYnZpb3VzbHkgcmVk
dW5kYW50LgoKRm9yIFBWIGd1ZXN0cywgY3Vyci0+YXJjaC5wdi5jdHJscmVn
WzRdIHJlbWFpbnMgdGhlIGd1ZXN0cyB2aWV3IG9mIGNyNCwgYnV0CmFsbCBs
b2dpYyBnZXRzIHJld29ya2VkIGluIHRlcm1zIG9mIHRoaXMgYW5kIG1tdV9j
cjRfZmVhdHVyZXMgb25seS4KClR3byBtYXNrcyBhcmUgaW50cm9kdWNlZDsg
Yml0cyB3aGljaCB0aGUgZ3Vlc3QgaGFzIGNvbnRyb2wgb3ZlciwgYW5kIGJp
dHMKd2hpY2ggYXJlIGZvcndhcmRlZCBmcm9tIFhlbidzIHNldHRpbmdzLiAg
T25lIGd1ZXN0LXZpc2libGUgY2hhbmdlIGhlcmUgaXMKdGhhdCBYZW4ncyBW
TVhFIHNldHRpbmcgaXMgbm8gbG9uZ2VyIHZpc2libGUgYXQgYWxsLgoKcHZf
bWFrZV9jcjQoKSBmb2xsb3dzIGZhaXJseSBjbG9zZWx5IGZyb20gcHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KCksIGJ1dApkZWxpYmVyYXRlbHkgc3RhcnRz
IHdpdGggbW11X2NyNF9mZWF0dXJlcywgYW5kIG9ubHkgYWx0ZXJzIHRoZSBt
aW5pbWFsIHN1YnNldApvZiBiaXRzLgoKVGhlIGJvb3QtdGltZSB7Y29tcGF0
Xyx9cHZfY3I0X21hc2sgdmFyaWFibGVzIGFyZSByZW1vdmVkLCBhcyB0aGV5
IGFyZSBhCnJlbW5hbnQgb2YgdGhlIHByZS1DUFVJRCBwb2xpY3kgZGF5cy4g
IHB2X2ZpeHVwX2d1ZXN0X2NyNCgpIGdhaW5zIGEgcmVsYXRlZApkZXJpdmF0
aW9uIGZyb20gdGhlIHBvbGljeS4KCkFub3RoZXIgZ3Vlc3QgdmlzaWJsZSBj
aGFuZ2UgaGVyZSBpcyB0aGF0IGEgMzJiaXQgUFYgZ3Vlc3QgY2FuIG5vdyBm
bGlwCkZTR1NCQVNFIGluIGl0cyB2aWV3IG9mIENSNC4gIFdoaWxlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25zIGFyZQp1bnVzYWJsZSBv
dXRzaWRlIG9mIGEgNjRiaXQgY29kZSBzZWdtZW50LCB0aGUgYWJpbGl0eSB0
byBtb2RpZnkgRlNHU0JBU0UKbWF0Y2hlcyByZWFsIGhhcmR3YXJlIGJlaGF2
aW91ciwgYW5kIGF2b2lkcyB0aGUgbmVlZCBmb3IgYW55IDMyYml0LzY0Yml0
CmRpZmZlcmVuY2VzIGluIHRoZSBsb2dpYy4KCk92ZXJhbGwsIHRoaXMgcGF0
Y2ggc2hvdWxkbid0IGhhdmUgYSBwcmFjdGljYWwgY2hhbmdlIGluIGd1ZXN0
IGJlaGF2aW91ci4KVk1YRSB3aWxsIGRpc2FwcGVhciBmcm9tIHZpZXcsIGFu
ZCBhbiBpbnF1aXNpdGl2ZSAzMmJpdCBrZXJuZWwgY2FuIG5vdyBzZWUKRlNH
U0JBU0UgY2hhbmdpbmcsIGJ1dCB0aGlzIG5ldyBsb2dpYyBpcyBvdGhlcndp
c2UgYnVnLWNvbXBhdGlibGUgd2l0aCBiZWZvcmUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTI5MwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5k
cmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRpZmYgLS1naXQgYS94ZW4vYXJj
aC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXgg
NjFmNjY3MS4uZTliOTVlNCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2Rv
bWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMzk4LDYg
KzM5OCw1MiBAQCBzdGF0aWMgdm9pZCByZWxlYXNlX2NvbXBhdF9sNChzdHJ1
Y3QgdmNwdSAqdikKICAgICB2LT5hcmNoLmd1ZXN0X3RhYmxlX3VzZXIgPSBw
YWdldGFibGVfbnVsbCgpOwogfQogCit1bnNpZ25lZCBsb25nIHB2X2ZpeHVw
X2d1ZXN0X2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgbG9u
ZyBjcjQpCit7CisgICAgY29uc3Qgc3RydWN0IGNwdWlkX3BvbGljeSAqcCA9
IHYtPmRvbWFpbi0+YXJjaC5jcHVpZDsKKworICAgIC8qIERpc2NhcmQgYXR0
ZW1wdHMgdG8gc2V0IGd1ZXN0IGNvbnRyb2xsYWJsZSBiaXRzIG91dHNpZGUg
b2YgdGhlIHBvbGljeS4gKi8KKyAgICBjcjQgJj0gfigocC0+YmFzaWMudHNj
ICAgICA/IDAgOiBYODZfQ1I0X1RTRCkgICAgICB8CisgICAgICAgICAgICAg
KHAtPmJhc2ljLmRlICAgICAgPyAwIDogWDg2X0NSNF9ERSkgICAgICAgfAor
ICAgICAgICAgICAgIChwLT5mZWF0LmZzZ3NiYXNlID8gMCA6IFg4Nl9DUjRf
RlNHU0JBU0UpIHwKKyAgICAgICAgICAgICAocC0+YmFzaWMueHNhdmUgICA/
IDAgOiBYODZfQ1I0X09TWFNBVkUpKTsKKworICAgIC8qIE1hc2tzIGV4cGVj
dGVkIHRvIGJlIGRpc2pvaW50IHNldHMuICovCisgICAgQlVJTERfQlVHX09O
KFBWX0NSNF9HVUVTVF9NQVNLICYgUFZfQ1I0X0dVRVNUX1ZJU0lCTEVfTUFT
Syk7CisKKyAgICAvKgorICAgICAqIEEgZ3Vlc3Qgc2VlcyB0aGUgcG9saWN5
IHN1YnNldCBvZiBpdHMgb3duIGNob2ljZSBvZiBndWVzdCBjb250cm9sbGFi
bGUKKyAgICAgKiBiaXRzLCBhbmQgYSBzdWJzZXQgb2YgWGVuJ3MgY2hvaWNl
IG9mIGNlcnRhaW4gaGFyZHdhcmUgc2V0dGluZ3MuCisgICAgICovCisgICAg
cmV0dXJuICgoY3I0ICYgUFZfQ1I0X0dVRVNUX01BU0spIHwKKyAgICAgICAg
ICAgIChtbXVfY3I0X2ZlYXR1cmVzICYgUFZfQ1I0X0dVRVNUX1ZJU0lCTEVf
TUFTSykpOworfQorCit1bnNpZ25lZCBsb25nIHB2X21ha2VfY3I0KGNvbnN0
IHN0cnVjdCB2Y3B1ICp2KQoreworICAgIGNvbnN0IHN0cnVjdCBkb21haW4g
KmQgPSB2LT5kb21haW47CisgICAgdW5zaWduZWQgbG9uZyBjcjQgPSBtbXVf
Y3I0X2ZlYXR1cmVzICYKKyAgICAgICAgfihYODZfQ1I0X1BDSURFIHwgWDg2
X0NSNF9QR0UgfCBYODZfQ1I0X1RTRCk7CisKKyAgICAvKgorICAgICAqIFBD
SURFIG9yIFBHRSBkZXBlbmRzIG9uIHRoZSBQQ0lEL1hQVEkgc2V0dGluZ3Ms
IGJ1dCBtdXN0IG5vdCBib3RoIGJlCisgICAgICogc2V0LCBhcyBpdCBpbXBh
Y3RzIHRoZSBzYWZldHkgb2YgVExCIGZsdXNoaW5nLgorICAgICAqLworICAg
IGlmICggZC0+YXJjaC5wdl9kb21haW4ucGNpZCApCisgICAgICAgIGNyNCB8
PSBYODZfQ1I0X1BDSURFOworICAgIGVsc2UgaWYgKCAhZC0+YXJjaC5wdl9k
b21haW4ueHB0aSApCisgICAgICAgIGNyNCB8PSBYODZfQ1I0X1BHRTsKKwor
ICAgIC8qCisgICAgICogVFNEIGlzIG5lZWRlZCBpZiBlaXRoZXIgdGhlIGd1
ZXN0IGhhcyBlbGVjdGVkIHRvIHVzZSBpdCwgb3IgWGVuIGlzCisgICAgICog
dmlydHVhbGlzaW5nIHRoZSBUU0MgdmFsdWUgdGhlIGd1ZXN0IHNlZXMuCisg
ICAgICovCisgICAgaWYgKCBkLT5hcmNoLnZ0c2MgfHwgKHYtPmFyY2gucHZf
dmNwdS5jdHJscmVnWzRdICYgWDg2X0NSNF9UU0QpICkKKyAgICAgICAgY3I0
IHw9IFg4Nl9DUjRfVFNEOworCisgICAgcmV0dXJuIGNyNDsKK30KKwogaW50
IHN3aXRjaF9jb21wYXQoc3RydWN0IGRvbWFpbiAqZCkKIHsKICAgICBzdHJ1
Y3QgdmNwdSAqdjsKQEAgLTUxMiwxMiArNTU4LDEyIEBAIGludCB2Y3B1X2lu
aXRpYWxpc2Uoc3RydWN0IHZjcHUgKnYpCiAKICAgICAgICAgLyogUFYgZ3Vl
c3RzIGJ5IGRlZmF1bHQgaGF2ZSBhIDEwMEh6IHRpY2tlci4gKi8KICAgICAg
ICAgdi0+cGVyaW9kaWNfcGVyaW9kID0gTUlMTElTRUNTKDEwKTsKKworICAg
ICAgICB2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHB2X2ZpeHVwX2d1
ZXN0X2NyNCh2LCAwKTsKICAgICB9CiAgICAgZWxzZQogICAgICAgICB2LT5h
cmNoLmNyMyA9IF9fcGEoaWRsZV9wZ190YWJsZSk7CiAKLSAgICB2LT5hcmNo
LnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHJlYWxfY3I0X3RvX3B2X2d1ZXN0X2Ny
NChtbXVfY3I0X2ZlYXR1cmVzKTsKLQogICAgIGlmICggaXNfcHZfMzJiaXRf
ZG9tYWluKGQpICkKICAgICB7CiAgICAgICAgIGlmICggKHJjID0gc2V0dXBf
Y29tcGF0X2FyZ194bGF0KHYpKSApCkBAIC05NTMsNDkgKzk5OSw2IEBAIGlu
dCBhcmNoX2RvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVjdCBkb21haW4gKmQpCiAg
ICAgcmV0dXJuIHJldDsKIH0KIAotLyoKLSAqIFRoZXNlIGFyZSB0aGUgbWFz
a3Mgb2YgQ1I0IGJpdHMgKHN1YmplY3QgdG8gaGFyZHdhcmUgYXZhaWxhYmls
aXR5KSB3aGljaCBhCi0gKiBQViBndWVzdCBtYXkgbm90IGxlZ2l0aW1pYXRl
bHkgYXR0ZW1wdCB0byBtb2RpZnkuCi0gKi8KLXN0YXRpYyB1bnNpZ25lZCBs
b25nIF9fcmVhZF9tb3N0bHkgcHZfY3I0X21hc2ssIGNvbXBhdF9wdl9jcjRf
bWFzazsKLQotc3RhdGljIGludCBfX2luaXQgaW5pdF9wdl9jcjRfbWFza3Mo
dm9pZCkKLXsKLSAgICB1bnNpZ25lZCBsb25nIGNvbW1vbl9tYXNrID0gflg4
Nl9DUjRfVFNEOwotCi0gICAgLyoKLSAgICAgKiBBbGwgUFYgZ3Vlc3RzIG1h
eSBhdHRlbXB0IHRvIG1vZGlmeSBUU0QsIERFIGFuZCBPU1hTQVZFLgotICAg
ICAqLwotICAgIGlmICggY3B1X2hhc19kZSApCi0gICAgICAgIGNvbW1vbl9t
YXNrICY9IH5YODZfQ1I0X0RFOwotICAgIGlmICggY3B1X2hhc194c2F2ZSAp
Ci0gICAgICAgIGNvbW1vbl9tYXNrICY9IH5YODZfQ1I0X09TWFNBVkU7Ci0K
LSAgICBwdl9jcjRfbWFzayA9IGNvbXBhdF9wdl9jcjRfbWFzayA9IGNvbW1v
bl9tYXNrOwotCi0gICAgLyoKLSAgICAgKiA2NGJpdCBQViBndWVzdHMgbWF5
IGF0dGVtcHQgdG8gbW9kaWZ5IEZTR1NCQVNFLgotICAgICAqLwotICAgIGlm
ICggY3B1X2hhc19mc2dzYmFzZSApCi0gICAgICAgIHB2X2NyNF9tYXNrICY9
IH5YODZfQ1I0X0ZTR1NCQVNFOwotCi0gICAgcmV0dXJuIDA7Ci19Ci1fX2lu
aXRjYWxsKGluaXRfcHZfY3I0X21hc2tzKTsKLQotdW5zaWduZWQgbG9uZyBw
dl9ndWVzdF9jcjRfZml4dXAoY29uc3Qgc3RydWN0IHZjcHUgKnYsIHVuc2ln
bmVkIGxvbmcgZ3Vlc3RfY3I0KQotewotICAgIHVuc2lnbmVkIGxvbmcgaHZf
Y3I0ID0gcmVhbF9jcjRfdG9fcHZfZ3Vlc3RfY3I0KHJlYWRfY3I0KCkpOwot
ICAgIHVuc2lnbmVkIGxvbmcgbWFzayA9IGlzX3B2XzMyYml0X3ZjcHUodikg
PyBjb21wYXRfcHZfY3I0X21hc2sgOiBwdl9jcjRfbWFzazsKLQotICAgIGlm
ICggKGd1ZXN0X2NyNCAmIG1hc2spICE9IChodl9jcjQgJiBtYXNrKSApCi0g
ICAgICAgIHByaW50ayhYRU5MT0dfR19XQVJOSU5HCi0gICAgICAgICAgICAg
ICAiZCVkIGF0dGVtcHRlZCB0byBjaGFuZ2UgJXB2J3MgQ1I0IGZsYWdzICUw
OGx4IC0+ICUwOGx4XG4iLAotICAgICAgICAgICAgICAgY3VycmVudC0+ZG9t
YWluLT5kb21haW5faWQsIHYsIGh2X2NyNCwgZ3Vlc3RfY3I0KTsKLQotICAg
IHJldHVybiAoaHZfY3I0ICYgbWFzaykgfCAoZ3Vlc3RfY3I0ICYgfm1hc2sp
OwotfQotCiAjZGVmaW5lIHhlbl92Y3B1X2d1ZXN0X2NvbnRleHQgdmNwdV9n
dWVzdF9jb250ZXh0CiAjZGVmaW5lIGZwdV9jdHh0IGZwdV9jdHh0LngKIENI
RUNLX0ZJRUxEXyhzdHJ1Y3QsIHZjcHVfZ3Vlc3RfY29udGV4dCwgZnB1X2N0
eHQpOwpAQCAtMTAwOSw3ICsxMDEyLDcgQEAgaW50IGFyY2hfc2V0X2luZm9f
Z3Vlc3QoCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKICAg
ICB1bnNpZ25lZCBsb25nIGNyM19nZm47CiAgICAgc3RydWN0IHBhZ2VfaW5m
byAqY3IzX3BhZ2U7Ci0gICAgdW5zaWduZWQgbG9uZyBmbGFncywgY3I0Owor
ICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgdW5zaWduZWQgaW50IGk7
CiAgICAgaW50IHJjID0gMCwgY29tcGF0OwogCkBAIC0xMjAwLDkgKzEyMDMs
OCBAQCBpbnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICB2LT5hcmNoLnB2
X3ZjcHUuY3RybHJlZ1swXSAmPSBYODZfQ1IwX1RTOwogICAgIHYtPmFyY2gu
cHZfdmNwdS5jdHJscmVnWzBdIHw9IHJlYWRfY3IwKCkgJiB+WDg2X0NSMF9U
UzsKIAotICAgIGNyNCA9IHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdOwot
ICAgIHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gY3I0ID8gcHZfZ3Vl
c3RfY3I0X2ZpeHVwKHYsIGNyNCkgOgotICAgICAgICByZWFsX2NyNF90b19w
dl9ndWVzdF9jcjQobW11X2NyNF9mZWF0dXJlcyk7CisgICAgdi0+YXJjaC5w
dl92Y3B1LmN0cmxyZWdbNF0gPQorICAgICAgICBwdl9maXh1cF9ndWVzdF9j
cjQodiwgdi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0pOwogCiAgICAgbWVt
c2V0KHYtPmFyY2guZGVidWdyZWcsIDAsIHNpemVvZih2LT5hcmNoLmRlYnVn
cmVnKSk7CiAgICAgZm9yICggaSA9IDA7IGkgPCA4OyBpKysgKQpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwpp
bmRleCAyOTgyZWVjLi4yMzQ5MTNmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94
ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNTE0LDMzICs1
MTQsMTMgQEAgdm9pZCBtYWtlX2NyMyhzdHJ1Y3QgdmNwdSAqdiwgdW5zaWdu
ZWQgbG9uZyBtZm4pCiAgICAgICAgIHYtPmFyY2guY3IzIHw9IGdldF9wY2lk
X2JpdHModiwgZmFsc2UpOwogfQogCi11bnNpZ25lZCBsb25nIHB2X2d1ZXN0
X2NyNF90b19yZWFsX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdikKLXsKLSAg
ICBjb25zdCBzdHJ1Y3QgZG9tYWluICpkID0gdi0+ZG9tYWluOwotICAgIHVu
c2lnbmVkIGxvbmcgY3I0OwotCi0gICAgY3I0ID0gdi0+YXJjaC5wdl92Y3B1
LmN0cmxyZWdbNF0gJiB+WDg2X0NSNF9ERTsKLSAgICBjcjQgfD0gbW11X2Ny
NF9mZWF0dXJlcyAmIChYODZfQ1I0X1BTRSB8IFg4Nl9DUjRfU01FUCB8IFg4
Nl9DUjRfU01BUCB8Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
WDg2X0NSNF9PU1hTQVZFIHwgWDg2X0NSNF9GU0dTQkFTRSk7Ci0KLSAgICBp
ZiAoIGQtPmFyY2gucHZfZG9tYWluLnBjaWQgKQotICAgICAgICBjcjQgfD0g
WDg2X0NSNF9QQ0lERTsKLSAgICBlbHNlIGlmICggIWQtPmFyY2gucHZfZG9t
YWluLnhwdGkgKQotICAgICAgICBjcjQgfD0gWDg2X0NSNF9QR0U7Ci0KLSAg
ICBjcjQgfD0gZC0+YXJjaC52dHNjID8gWDg2X0NSNF9UU0QgOiAwOwotCi0g
ICAgcmV0dXJuIGNyNDsKLX0KLQogdm9pZCB3cml0ZV9wdGJhc2Uoc3RydWN0
IHZjcHUgKnYpCiB7CiAgICAgc3RydWN0IGNwdV9pbmZvICpjcHVfaW5mbyA9
IGdldF9jcHVfaW5mbygpOwogICAgIHVuc2lnbmVkIGxvbmcgbmV3X2NyNDsK
IAogICAgIG5ld19jcjQgPSAoaXNfcHZfdmNwdSh2KSAmJiAhaXNfaWRsZV92
Y3B1KHYpKQotICAgICAgICAgICAgICA/IHB2X2d1ZXN0X2NyNF90b19yZWFs
X2NyNCh2KQotICAgICAgICAgICAgICA6ICgocmVhZF9jcjQoKSAmIH4oWDg2
X0NSNF9QQ0lERSB8IFg4Nl9DUjRfVFNEKSkgfCBYODZfQ1I0X1BHRSk7Cisg
ICAgICAgICAgICAgID8gcHZfbWFrZV9jcjQodikgOiBtbXVfY3I0X2ZlYXR1
cmVzOwogCiAgICAgaWYgKCBpc19wdl92Y3B1KHYpICYmIHYtPmRvbWFpbi0+
YXJjaC5wdl9kb21haW4ueHB0aSApCiAgICAgewpAQCAtNTU5LDggKzUzOSw2
IEBAIHZvaWQgd3JpdGVfcHRiYXNlKHN0cnVjdCB2Y3B1ICp2KQogICAgICAg
ICBzd2l0Y2hfY3IzX2NyNCh2LT5hcmNoLmNyMywgbmV3X2NyNCk7CiAgICAg
ICAgIGNwdV9pbmZvLT5wdl9jcjMgPSAwOwogICAgIH0KLQotICAgIEFTU0VS
VChpc19wdl92Y3B1KHYpIHx8IHJlYWRfY3I0KCkgPT0gbW11X2NyNF9mZWF0
dXJlcyk7CiB9CiAKIC8qCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvdHJh
cHMuYyBiL3hlbi9hcmNoL3g4Ni90cmFwcy5jCmluZGV4IGZlYzVlNTUuLmRj
NWEwZDYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni90cmFwcy5jCisrKyBi
L3hlbi9hcmNoL3g4Ni90cmFwcy5jCkBAIC0yNDg2LDggKzI0ODYsOCBAQCBz
dGF0aWMgaW50IHByaXZfb3Bfd3JpdGVfY3IodW5zaWduZWQgaW50IHJlZywg
dW5zaWduZWQgbG9uZyB2YWwsCiAgICAgfQogCiAgICAgY2FzZSA0OiAvKiBX
cml0ZSBDUjQgKi8KLSAgICAgICAgY3Vyci0+YXJjaC5wdl92Y3B1LmN0cmxy
ZWdbNF0gPSBwdl9ndWVzdF9jcjRfZml4dXAoY3VyciwgdmFsKTsKLSAgICAg
ICAgd3JpdGVfY3I0KHB2X2d1ZXN0X2NyNF90b19yZWFsX2NyNChjdXJyKSk7
CisgICAgICAgIGN1cnItPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gcHZf
Zml4dXBfZ3Vlc3RfY3I0KGN1cnIsIHZhbCk7CisgICAgICAgIHdyaXRlX2Ny
NChwdl9tYWtlX2NyNChjdXJyKSk7CiAgICAgICAgIGN0eHRfc3dpdGNoX2xl
dmVsbGluZyhjdXJyKTsKICAgICAgICAgcmV0dXJuIFg4NkVNVUxfT0tBWTsK
ICAgICB9CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFp
bi5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaAppbmRleCA3YzI2
ZjYwLi43ZWE2NzUzIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2
L2RvbWFpbi5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWluLmgK
QEAgLTY0OCwxNiArNjQ4LDIyIEBAIGJvb2xfdCB1cGRhdGVfc2Vjb25kYXJ5
X3N5c3RlbV90aW1lKHN0cnVjdCB2Y3B1ICosCiB2b2lkIHZjcHVfc2hvd19l
eGVjdXRpb25fc3RhdGUoc3RydWN0IHZjcHUgKik7CiB2b2lkIHZjcHVfc2hv
d19yZWdpc3RlcnMoY29uc3Qgc3RydWN0IHZjcHUgKik7CiAKLS8qIENsZWFu
IHVwIENSNCBiaXRzIHRoYXQgYXJlIG5vdCB1bmRlciBndWVzdCBjb250cm9s
LiAqLwotdW5zaWduZWQgbG9uZyBwdl9ndWVzdF9jcjRfZml4dXAoY29uc3Qg
c3RydWN0IHZjcHUgKiwgdW5zaWduZWQgbG9uZyBndWVzdF9jcjQpOworLyoK
KyAqIEJpdHMgd2hpY2ggYSBQViBndWVzdCBjYW4gdG9nZ2xlIGluIGl0cyB2
aWV3IG9mIGNyNC4gIFNvbWUgYXJlIGxvYWRlZCBpbnRvCisgKiBoYXJkd2Fy
ZSwgd2hpbGUgc29tZSBhcmUgZnVsbHkgZW11bGF0ZWQuCisgKi8KKyNkZWZp
bmUgUFZfQ1I0X0dVRVNUX01BU0sgXAorICAgIChYODZfQ1I0X1RTRCB8IFg4
Nl9DUjRfREUgfCBYODZfQ1I0X0ZTR1NCQVNFIHwgWDg2X0NSNF9PU1hTQVZF
KQorCisvKiBCaXRzIHdoaWNoIGEgUFYgZ3Vlc3QgbWF5IG9ic2VydmUgZnJv
bSB0aGUgcmVhbCBoYXJkd2FyZSBzZXR0aW5ncy4gKi8KKyNkZWZpbmUgUFZf
Q1I0X0dVRVNUX1ZJU0lCTEVfTUFTSyBcCisgICAgKFg4Nl9DUjRfUEFFIHwg
WDg2X0NSNF9NQ0UgfCBYODZfQ1I0X09TRlhTUiB8IFg4Nl9DUjRfT1NYTU1F
WENQVCkKIAotLyogQ29udmVydCBiZXR3ZWVuIGd1ZXN0LXZpc2libGUgYW5k
IHJlYWwgQ1I0IHZhbHVlcy4gKi8KLXVuc2lnbmVkIGxvbmcgcHZfZ3Vlc3Rf
Y3I0X3RvX3JlYWxfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2KTsKKy8qIEdp
dmVuIGEgbmV3IGNyNCB2YWx1ZSwgY29uc3RydWN0IHRoZSByZXN1bHRpbmcg
Z3Vlc3QtdmlzaWJsZSBjcjQgdmFsdWUuICovCit1bnNpZ25lZCBsb25nIHB2
X2ZpeHVwX2d1ZXN0X2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdiwgdW5zaWdu
ZWQgbG9uZyBjcjQpOwogCi0jZGVmaW5lIHJlYWxfY3I0X3RvX3B2X2d1ZXN0
X2NyNChjKSAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgKChjKSAm
IH4oWDg2X0NSNF9QR0UgfCBYODZfQ1I0X1BTRSB8IFg4Nl9DUjRfVFNEIHwg
ICAgICBcCi0gICAgICAgICAgICAgWDg2X0NSNF9PU1hTQVZFIHwgWDg2X0NS
NF9TTUVQIHwgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICAgWDg2X0NS
NF9GU0dTQkFTRSB8IFg4Nl9DUjRfU01BUCB8IFg4Nl9DUjRfUENJREUpKQor
LyogQ3JlYXRlIGEgY3I0IHZhbHVlIHRvIGxvYWQgaW50byBoYXJkd2FyZSwg
YmFzZWQgb24gdmNwdSBzZXR0aW5ncy4gKi8KK3Vuc2lnbmVkIGxvbmcgcHZf
bWFrZV9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpOwogCiAjZGVmaW5lIGRv
bWFpbl9tYXhfdmNwdXMoZCkgKGlzX2h2bV9kb21haW4oZCkgPyBIVk1fTUFY
X1ZDUFVTIDogTUFYX1ZJUlRfQ1BVUykKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa293/4.9-2.patch"
Content-Disposition: attachment; filename="xsa293/4.9-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBEb24ndCBoYXZlICVjcjQuZnNnc2Jhc2Ug
YWN0aXZlIGJlaGluZCBhIGd1ZXN0IGtlcm5lbHMgYmFjawoKQ3VycmVudGx5
LCBhIDY0Yml0IFBWIGd1ZXN0IGNhbiBhcHBlYXIgdG8gc2V0IGFuZCBjbGVh
ciBGU0dTQkFTRSBpbiAlY3I0LCBidXQKdGhlIGJpdCByZW1haW5zIHNldCBp
biBoYXJkd2FyZS4gIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17RlMsR1N9QkFT
RSBhcmUgdXNhYmxlCmV2ZW4gd2hlbiB0aGUgZ3Vlc3Qga2VybmVsIGJlbGll
dmVzIHRoYXQgdGhleSBhcmUgZGlzYWJsZWQuCgpUaGUgRlNHU0JBU0UgZmVh
dHVyZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIExpbnV4LCBhbmQg
aXRzIGNvbnRleHQKc3dpdGNoIHBhdGggaGFzIHNvbWUgb3B0aW1pc2F0aW9u
cyB3aGljaCByZWx5IG9uIHVzZXJzcGFjZSBiZWluZyB1bmFibGUgdG8gdXNl
CnRoZSBXUntGUyxHU31CQVNFIGluc3RydWN0aW9ucy4gIFhlbidzIGN1cnJl
bnQgYmVoYXZpb3VyIHVuZGVybWluZXMgdGhpcwpleHBlY3RhdGlvbi4KCklu
IDY0Yml0IFBWIGd1ZXN0IGNvbnRleHQsIGFsd2F5cyBsb2FkIHRoZSBndWVz
dCBrZXJuZWxzIHNldHRpbmcgb2YgRlNHU0JBU0UKaW50byAlY3I0LiAgVGhp
cyByZXF1aXJlcyBhZGp1c3RpbmcgaG93IFhlbiB1c2VzIHRoZSB7UkQsV1J9
e0ZTLEdTfUJBU0UKaW5zdHJ1Y3Rpb25zLgoKICogRGVsZXRlIHRoZSBjcHVf
aGFzX2ZzZ3NiYXNlIGhlbHBlci4gIEl0IGlzIG5vIGxvbmdlciBzYWZlLCBh
cyB1c2VycyBuZWVkIHRvCiAgIGNoZWNrICVjcjQgZGlyZWN0bHkuCiAqIFRo
ZSByYXcgX19yZHtmcyxnc31iYXNlKCkgaGVscGVycyBhcmUgb25seSBzYWZl
IHRvIHVzZSB3aGVuICVjcjQuZnNnc2Jhc2UKICAgaXMgc2V0LiAgQ29tbWVu
dCB0aGlzIHByb3BlcnR5LgogKiBUaGUge3JkLHdyfXtmcyxnc317YmFzZSxz
aGFkb3d9KCkgYW5kIHJlYWRfbXNyKCkgaGVscGVycyBhcmUgdXBkYXRlZCB0
byB1c2UKICAgdGhlIGN1cnJlbnQgJWNyNCB2YWx1ZSB0byBkZXRlcm1pbmUg
d2hpY2ggbWVjaGFuaXNtIHRvIHVzZS4KICogdG9nZ2xlX2d1ZXN0X21vZGUo
KSBhbmQgc2F2ZV9zZWdtZW50cygpIGFyZSB1cGRhdGUgdG8gYXZvaWQgcmVh
ZGluZwogICBmcy9nc2Jhc2UgaWYgdGhlIHZhbHVlcyBpbiBoYXJkd2FyZSBj
YW5ub3QgYmUgc3RhbGUgV1JUIHN0cnVjdCB2Y3B1LiAgQQogICBjb25zZXF1
ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHdyaXRlX2NyKCkgcGF0aCBuZWVk
cyB0byBjYWNoZSB0aGUgY3VycmVudAogICBiYXNlcywgYXMgc3Vic2VxdWVu
dCBjb250ZXh0IHN3aXRjaGVzIHdpbGwgc2tpcCBzYXZpbmcgdGhlIHZhbHVl
cy4KICogd3JpdGVfY3I0KCkgaXMgdXBkYXRlZCB0byBlbnN1cmUgdGhhdCB0
aGUgc2hhZG93ICVjcjQuZnNnc2Jhc2UgdmFsdWUgaXMKICAgb2JzZXJ2ZWQg
aW4gYSBzYWZlIHdheSBXUlQgdGhlIGhhcmR3YXJlIHNldHRpbmcsIGlmIGFu
IGludGVycnVwdCBoYXBwZW5zIHRvCiAgIGhpdCBpbiB0aGUgbWlkZGxlLgog
KiBwdl9tYWtlX2NyNCgpIGlzIHVwZGF0ZWQgZm9yIDY0Yml0IFBWIGd1ZXN0
cyB0byB1c2UgdGhlIGd1ZXN0IGtlcm5lbHMKICAgY2hvaWNlIG9mIEZTR1NC
QVNFLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTMKClJlcG9ydGVkLWJ5OiBB
bmR5IEx1dG9taXJza2kgPGx1dG9Aa2VybmVsLm9yZz4KU2lnbmVkLW9mZi1i
eTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4K
UmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4K
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJj
aC94ODYvZG9tYWluLmMKaW5kZXggZWZkYWIxYS4uMGVkYjEzMSAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9kb21haW4uYwpAQCAtNDQxLDYgKzQ0MSwxNiBAQCB1bnNpZ25lZCBsb25n
IHB2X21ha2VfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2KQogICAgIGlmICgg
ZC0+YXJjaC52dHNjIHx8ICh2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSAm
IFg4Nl9DUjRfVFNEKSApCiAgICAgICAgIGNyNCB8PSBYODZfQ1I0X1RTRDsK
IAorICAgIC8qCisgICAgICogVGhlIHtSRCxXUn17RlMsR1N9QkFTRSBhcmUg
b25seSB1c2VhYmxlIGluIDY0Yml0IGNvZGUgc2VnbWVudHMuICBXaGlsZQor
ICAgICAqIHdlIG11c3Qgbm90IGhhdmUgQ1I0LkZTR1NCQVNFIHNldCBiZWhp
bmQgdGhlIGJhY2sgb2YgYSA2NGJpdCBQViBrZXJuZWwsCisgICAgICogd2Ug
ZG8gbGVhdmUgaXQgc2V0IGluIDMyYml0IFBWIGNvbnRleHQgdG8gc3BlZWQg
dXAgWGVuJ3MgY29udGV4dCBzd2l0Y2gKKyAgICAgKiBwYXRoLgorICAgICAq
LworICAgIGlmICggIWlzX3B2XzMyYml0X2RvbWFpbihkKSAmJgorICAgICAg
ICAgISh2LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSAmIFg4Nl9DUjRfRlNH
U0JBU0UpICkKKyAgICAgICAgY3I0ICY9IH5YODZfQ1I0X0ZTR1NCQVNFOwor
CiAgICAgcmV0dXJuIGNyNDsKIH0KIApAQCAtMTk4Nyw3ICsxOTk3LDggQEAg
c3RhdGljIHZvaWQgc2F2ZV9zZWdtZW50cyhzdHJ1Y3QgdmNwdSAqdikKICAg
ICByZWdzLT5mcyA9IHJlYWRfc3JlZyhmcyk7CiAgICAgcmVncy0+Z3MgPSBy
ZWFkX3NyZWcoZ3MpOwogCi0gICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICYm
ICFpc19wdl8zMmJpdF92Y3B1KHYpICkKKyAgICAvKiAlZnMvJWdzIGJhc2Vz
IGNhbiBvbmx5IGJlIHN0YWxlIGlmIFdSe0ZTLEdTfUJBU0UgYXJlIHVzYWJs
ZS4gKi8KKyAgICBpZiAoIChyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFT
RSkgJiYgIWlzX3B2XzMyYml0X3ZjcHUodikgKQogICAgIHsKICAgICAgICAg
di0+YXJjaC5wdl92Y3B1LmZzX2Jhc2UgPSBfX3JkZnNiYXNlKCk7CiAgICAg
ICAgIGlmICggdi0+YXJjaC5mbGFncyAmIFRGX2tlcm5lbF9tb2RlICkKZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9zZXR1cC5jIGIveGVuL2FyY2gveDg2
L3NldHVwLmMKaW5kZXggYmY1ZWQxZi4uNDBhZjdlNiAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gveDg2L3NldHVwLmMKKysrIGIveGVuL2FyY2gveDg2L3NldHVw
LmMKQEAgLTE1MTAsNyArMTUxMCw3IEBAIHZvaWQgX19pbml0IG5vcmV0dXJu
IF9fc3RhcnRfeGVuKHVuc2lnbmVkIGxvbmcgbWJpX3ApCiAKICAgICBjcjRf
cHYzMl9tYXNrID0gbW11X2NyNF9mZWF0dXJlcyAmIFhFTl9DUjRfUFYzMl9C
SVRTOwogCi0gICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICkKKyAgICBpZiAo
IGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9GU0dTQkFTRSkgKQogICAgICAg
ICBzZXRfaW5fY3I0KFg4Nl9DUjRfRlNHU0JBU0UpOwogCiAgICAgaWYgKCBv
cHRfaW52cGNpZCAmJiBjcHVfaGFzX2ludnBjaWQgKQpkaWZmIC0tZ2l0IGEv
eGVuL2FyY2gveDg2L3RyYXBzLmMgYi94ZW4vYXJjaC94ODYvdHJhcHMuYwpp
bmRleCBkYzVhMGQ2Li4yZjlmNzVmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94
ODYvdHJhcHMuYworKysgYi94ZW4vYXJjaC94ODYvdHJhcHMuYwpAQCAtMjQ4
Niw2ICsyNDg2LDE3IEBAIHN0YXRpYyBpbnQgcHJpdl9vcF93cml0ZV9jcih1
bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBsb25nIHZhbCwKICAgICB9CiAK
ICAgICBjYXNlIDQ6IC8qIFdyaXRlIENSNCAqLworICAgICAgICAvKgorICAg
ICAgICAgKiBJZiB0aGlzIHdyaXRlIHdpbGwgZGlzYWJsZSBGU0dTQkFTRSwg
cmVmcmVzaCBYZW4ncyBpZGVhIG9mIHRoZQorICAgICAgICAgKiBndWVzdCBi
YXNlcyBub3cgdGhhdCB0aGV5IGNhbiBubyBsb25nZXIgY2hhbmdlLgorICAg
ICAgICAgKi8KKyAgICAgICAgaWYgKCAoY3Vyci0+YXJjaC5wdl92Y3B1LmN0
cmxyZWdbNF0gJiBYODZfQ1I0X0ZTR1NCQVNFKSAmJgorICAgICAgICAgICAg
ICEodmFsICYgWDg2X0NSNF9GU0dTQkFTRSkgKQorICAgICAgICB7CisgICAg
ICAgICAgICBjdXJyLT5hcmNoLnB2X3ZjcHUuZnNfYmFzZSA9IF9fcmRmc2Jh
c2UoKTsKKyAgICAgICAgICAgIGN1cnItPmFyY2gucHZfdmNwdS5nc19iYXNl
X2tlcm5lbCA9IF9fcmRnc2Jhc2UoKTsKKyAgICAgICAgfQorCiAgICAgICAg
IGN1cnItPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gcHZfZml4dXBfZ3Vl
c3RfY3I0KGN1cnIsIHZhbCk7CiAgICAgICAgIHdyaXRlX2NyNChwdl9tYWtl
X2NyNChjdXJyKSk7CiAgICAgICAgIGN0eHRfc3dpdGNoX2xldmVsbGluZyhj
dXJyKTsKQEAgLTI1MjYsMTQgKzI1MzcsMTUgQEAgc3RhdGljIGludCBwcml2
X29wX3JlYWRfbXNyKHVuc2lnbmVkIGludCByZWcsIHVpbnQ2NF90ICp2YWws
CiAgICAgY2FzZSBNU1JfRlNfQkFTRToKICAgICAgICAgaWYgKCBpc19wdl8z
MmJpdF9kb21haW4oY3VycmQpICkKICAgICAgICAgICAgIGJyZWFrOwotICAg
ICAgICAqdmFsID0gY3B1X2hhc19mc2dzYmFzZSA/IF9fcmRmc2Jhc2UoKSA6
IGN1cnItPmFyY2gucHZfdmNwdS5mc19iYXNlOworICAgICAgICAqdmFsID0g
KHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNFKSA/IF9fcmRmc2Jhc2Uo
KQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA6IGN1cnItPmFyY2gucHZfdmNwdS5mc19iYXNlOwogICAgICAgICBy
ZXR1cm4gWDg2RU1VTF9PS0FZOwogCiAgICAgY2FzZSBNU1JfR1NfQkFTRToK
ICAgICAgICAgaWYgKCBpc19wdl8zMmJpdF9kb21haW4oY3VycmQpICkKICAg
ICAgICAgICAgIGJyZWFrOwotICAgICAgICAqdmFsID0gY3B1X2hhc19mc2dz
YmFzZSA/IF9fcmRnc2Jhc2UoKQotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA6IGN1cnItPmFyY2gucHZfdmNwdS5nc19iYXNlX2tlcm5lbDsK
KyAgICAgICAgKnZhbCA9IChyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFT
RSkgPyBfX3JkZ3NiYXNlKCkKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgOiBjdXJyLT5hcmNoLnB2X3ZjcHUuZ3Nf
YmFzZV9rZXJuZWw7CiAgICAgICAgIHJldHVybiBYODZFTVVMX09LQVk7CiAK
ICAgICBjYXNlIE1TUl9TSEFET1dfR1NfQkFTRToKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni94ODZfNjQvdHJhcHMuYyBiL3hlbi9hcmNoL3g4Ni94ODZf
NjQvdHJhcHMuYwppbmRleCA4YTA2YjIxLi42N2E5OTkzIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYveDg2XzY0L3RyYXBzLmMKKysrIGIveGVuL2FyY2gv
eDg2L3g4Nl82NC90cmFwcy5jCkBAIC0yNjYsNyArMjY2LDkgQEAgdm9pZCB0
b2dnbGVfZ3Vlc3RfbW9kZShzdHJ1Y3QgdmNwdSAqdikKIHsKICAgICBpZiAo
IGlzX3B2XzMyYml0X3ZjcHUodikgKQogICAgICAgICByZXR1cm47Ci0gICAg
aWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICkKKworICAgIC8qICVmcy8lZ3MgYmFz
ZXMgY2FuIG9ubHkgYmUgc3RhbGUgaWYgV1J7RlMsR1N9QkFTRSBhcmUgdXNh
YmxlLiAqLworICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JB
U0UgKQogICAgIHsKICAgICAgICAgaWYgKCB2LT5hcmNoLmZsYWdzICYgVEZf
a2VybmVsX21vZGUgKQogICAgICAgICAgICAgdi0+YXJjaC5wdl92Y3B1Lmdz
X2Jhc2Vfa2VybmVsID0gX19yZGdzYmFzZSgpOwpkaWZmIC0tZ2l0IGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmggYi94ZW4vaW5jbHVkZS9h
c20teDg2L2NwdWZlYXR1cmUuaAppbmRleCBmZjZmOTY5Li41MDQzMjMxIDEw
MDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaAor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaApAQCAtODQs
NyArODQsNiBAQAogI2RlZmluZSBjcHVfaGFzX3hzYXZlcyAgICAgICAgICBi
b290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfWFNBVkVTKQogCiAvKiBDUFVJRCBs
ZXZlbCAweDAwMDAwMDA3OjAuZWJ4ICovCi0jZGVmaW5lIGNwdV9oYXNfZnNn
c2Jhc2UgICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9GU0dTQkFT
RSkKICNkZWZpbmUgY3B1X2hhc19ibWkxICAgICAgICAgICAgYm9vdF9jcHVf
aGFzKFg4Nl9GRUFUVVJFX0JNSTEpCiAjZGVmaW5lIGNwdV9oYXNfaGxlICAg
ICAgICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9ITEUpCiAjZGVm
aW5lIGNwdV9oYXNfYXZ4MiAgICAgICAgICAgIGJvb3RfY3B1X2hhcyhYODZf
RkVBVFVSRV9BVlgyKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tc3IuaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLmgKaW5kZXggOGQ0
ZGU2MS4uZmU2ZDVhMCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tc3IuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21zci5oCkBAIC0x
MjAsNiArMTIwLDE0IEBAIHN0YXRpYyBpbmxpbmUgdWludDY0X3QgcmR0c2Nf
b3JkZXJlZCh2b2lkKQogCQkJICA6ICI9YSIgKGxvdyksICI9ZCIgKGhpZ2gp
IFwKIAkJCSAgOiAiYyIgKGNvdW50ZXIpKQogCisvKgorICogT24gaGFyZHdh
cmUgc3VwcG9ydGluZyBGU0dTQkFTRSwgdGhlIHZhbHVlIGxvYWRlZCBpbnRv
IGhhcmR3YXJlIGlzIHRoZQorICogZ3Vlc3Qga2VybmVsJ3MgY2hvaWNlIGZv
ciA2NGJpdCBQViBndWVzdHMgKFhlbidzIGNob2ljZSBmb3IgSWRsZSwgSFZN
IGFuZAorICogMzJiaXQgUFYpLgorICoKKyAqIFRoZXJlZm9yZSwgdGhlIHtS
RCxXUn17RlMsR1N9QkFTRSBpbnN0cnVjdGlvbnMgYXJlIG9ubHkgc2FmZSB0
byB1c2UgaWYKKyAqICVjcjQuZnNnc2Jhc2UgaXMgc2V0LgorICovCiBzdGF0
aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgX19yZGZzYmFzZSh2b2lkKQogewog
ICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKQEAgLTE1MCw3ICsxNTgsNyBAQCBz
dGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRmc2Jhc2Uodm9pZCkKIHsK
ICAgICB1bnNpZ25lZCBsb25nIGJhc2U7CiAKLSAgICBpZiAoIGNwdV9oYXNf
ZnNnc2Jhc2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNH
U0JBU0UgKQogICAgICAgICByZXR1cm4gX19yZGZzYmFzZSgpOwogCiAgICAg
cmRtc3JsKE1TUl9GU19CQVNFLCBiYXNlKTsKQEAgLTE2Miw3ICsxNzAsNyBA
QCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRnc2Jhc2Uodm9pZCkK
IHsKICAgICB1bnNpZ25lZCBsb25nIGJhc2U7CiAKLSAgICBpZiAoIGNwdV9o
YXNfZnNnc2Jhc2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRf
RlNHU0JBU0UgKQogICAgICAgICByZXR1cm4gX19yZGdzYmFzZSgpOwogCiAg
ICAgcmRtc3JsKE1TUl9HU19CQVNFLCBiYXNlKTsKQEAgLTE3Miw3ICsxODAs
NyBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRnc2Jhc2Uodm9p
ZCkKIAogc3RhdGljIGlubGluZSB2b2lkIHdyZnNiYXNlKHVuc2lnbmVkIGxv
bmcgYmFzZSkKIHsKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQorICAg
IGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0UgKQogI2lmZGVm
IEhBVkVfR0FTX0ZTR1NCQVNFCiAgICAgICAgIGFzbSB2b2xhdGlsZSAoICJ3
cmZzYmFzZSAlMCIgOjogInIiIChiYXNlKSApOwogI2Vsc2UKQEAgLTE4NCw3
ICsxOTIsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgd3Jmc2Jhc2UodW5zaWdu
ZWQgbG9uZyBiYXNlKQogCiBzdGF0aWMgaW5saW5lIHZvaWQgd3Jnc2Jhc2Uo
dW5zaWduZWQgbG9uZyBiYXNlKQogewotICAgIGlmICggY3B1X2hhc19mc2dz
YmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFT
RSApCiAjaWZkZWYgSEFWRV9HQVNfRlNHU0JBU0UKICAgICAgICAgYXNtIHZv
bGF0aWxlICggIndyZ3NiYXNlICUwIiA6OiAiciIgKGJhc2UpICk7CiAjZWxz
ZQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3Iu
aCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcHJvY2Vzc29yLmgKaW5kZXggZGE0
MmU4NC4uNDQ4NzM0NyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9wcm9jZXNzb3IuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nl
c3Nvci5oCkBAIC0zMDYsMTEgKzMwNiwzMSBAQCBzdGF0aWMgaW5saW5lIHVu
c2lnbmVkIGxvbmcgcmVhZF9jcjQodm9pZCkKIAogc3RhdGljIGlubGluZSB2
b2lkIHdyaXRlX2NyNCh1bnNpZ25lZCBsb25nIHZhbCkKIHsKKyAgICBzdHJ1
Y3QgY3B1X2luZm8gKmluZm8gPSBnZXRfY3B1X2luZm8oKTsKKwogICAgIC8q
IE5vIGdsb2JhbCBwYWdlcyBpbiBjYXNlIG9mIFBDSURzIGVuYWJsZWQhICov
CiAgICAgQVNTRVJUKCEodmFsICYgWDg2X0NSNF9QR0UpIHx8ICEodmFsICYg
WDg2X0NSNF9QQ0lERSkpOwogCi0gICAgZ2V0X2NwdV9pbmZvKCktPmNyNCA9
IHZhbDsKLSAgICBhc20gdm9sYXRpbGUgKCAibW92ICUwLCUlY3I0IiA6IDog
InIiICh2YWwpICk7CisgICAgLyoKKyAgICAgKiBPbiBoYXJkd2FyZSBzdXBw
b3J0aW5nIEZTR1NCQVNFLCB0aGUgdmFsdWUgaW4gJWNyNCBpcyB0aGUga2Vy
bmVsJ3MKKyAgICAgKiBjaG9pY2UgZm9yIDY0Yml0IFBWIGd1ZXN0cywgd2hp
Y2ggaW1wYWN0cyB3aGV0aGVyIFhlbiBjYW4gdXNlIHRoZQorICAgICAqIGlu
c3RydWN0aW9ucy4KKyAgICAgKgorICAgICAqIFRoZSB7cmQsd3J9e2ZzLGdz
fWJhc2UoKSBoZWxwZXJzIHVzZSBpbmZvLT5jcjQgdG8gd29yayBvdXQgd2hl
dGhlciBpdAorICAgICAqIGlzIHNhZmUgdG8gZXhlY3V0ZSB0aGUge1JELFdS
fXtGUyxHU31CQVNFIGluc3RydWN0aW9uLCBmYWxsaW5nIGJhY2sgdG8KKyAg
ICAgKiB0aGUgTVNSIHBhdGggaWYgbm90LiAgU29tZSB1c2VycyByZXF1aXJl
IGludGVycnVwdCBzYWZldHkuCisgICAgICoKKyAgICAgKiBJZiBGU0dTQkFT
RSBpcyBjdXJyZW50bHkgb3IgYWJvdXQgdG8gYmVjb21lIGNsZWFyLCByZWZs
ZWN0IHRoaXMgaW4KKyAgICAgKiBpbmZvLT5jcjQgYmVmb3JlIHVwZGF0aW5n
ICVjcjQsIHNvIGFuIGludGVycnVwdCB3aGljaCBoaXRzIGluIHRoZQorICAg
ICAqIG1pZGRsZSB3b24ndCBvYnNlcnZlIEZTR1NCQVNFIHNldCBpbiBpbmZv
LT5jcjQgYnV0IGNsZWFyIGluICVjcjQuCisgICAgICovCisgICAgaW5mby0+
Y3I0ID0gdmFsICYgKGluZm8tPmNyNCB8IH5YODZfQ1I0X0ZTR1NCQVNFKTsK
KworICAgIGFzbSB2b2xhdGlsZSAoICJtb3YgJVt2YWxdLCAlJWNyNCIKKyAg
ICAgICAgICAgICAgICAgICA6ICIrbSIgKGluZm8tPmNyNCkgLyogRm9yY2Ug
b3JkZXJpbmcgd2l0aG91dCBhIGJhcnJpZXIuICovCisgICAgICAgICAgICAg
ICAgICAgOiBbdmFsXSAiciIgKHZhbCkgKTsKKworICAgIGluZm8tPmNyNCA9
IHZhbDsKIH0KIAogLyogQ2xlYXIgYW5kIHNldCAnVFMnIGJpdCByZXNwZWN0
aXZlbHkgKi8K

--=separator
Content-Type: application/octet-stream; name="xsa293/4.10-1.patch"
Content-Disposition: attachment; filename="xsa293/4.10-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBSZXdyaXRlIGd1ZXN0ICVjcjQgaGFuZGxp
bmcgZnJvbSBzY3JhdGNoCgpUaGUgUFYgY3I0IGxvZ2ljIGlzIGFsbW9zdCBp
bXBvc3NpYmxlIHRvIGZvbGxvdywgYW5kIGxlYWtzIGJpdHMgaW50byBndWVz
dApjb250ZXh0IHdoaWNoIGRlZmluaXRlbHkgc2hvdWxkbid0IGJlIHZpc2li
bGUgKGluIHBhcnRpY3VsYXIsIFZNWEUpLgoKVGhlIGJpZ2dlc3QgcHJvYmxl
bSBob3dldmVyLCBhbmQgc291cmNlIG9mIHRoZSBjb21wbGV4aXR5LCBpcyB0
aGF0IGl0IGRlcml2ZXMKbmV3IHJlYWwgYW5kIGd1ZXN0IGNyNCB2YWx1ZXMg
ZnJvbSB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZSAtIHRoaXMgaXMK
Y29udGV4dCBkZXBlbmRlbnQgYW5kIGFuIGluYXBwcm9wcmlhdGUgc291cmNl
IG9mIGluZm9ybWF0aW9uLgoKUmV3cml0ZSB0aGUgY3I0IGxvZ2ljIHRvIGJl
IGludmFyaWFudCBvZiB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZS4K
CkZpcnN0IG9mIGFsbCwgbW9kaWZ5IHdyaXRlX3B0YmFzZSgpIHRvIGFsd2F5
cyB1c2UgbW11X2NyNF9mZWF0dXJlcyBmb3IgSURMRQphbmQgSFZNIGNvbnRl
eHRzLiAgbW11X2NyNF9mZWF0dXJlcyAqaXMqIHRoZSBjb3JyZWN0IHZhbHVl
IHRvIHVzZSwgYW5kIG1ha2VzCnRoZSBBU1NFUlQoKSBvYnZpb3VzbHkgcmVk
dW5kYW50LgoKRm9yIFBWIGd1ZXN0cywgY3Vyci0+YXJjaC5wdi5jdHJscmVn
WzRdIHJlbWFpbnMgdGhlIGd1ZXN0cyB2aWV3IG9mIGNyNCwgYnV0CmFsbCBs
b2dpYyBnZXRzIHJld29ya2VkIGluIHRlcm1zIG9mIHRoaXMgYW5kIG1tdV9j
cjRfZmVhdHVyZXMgb25seS4KClR3byBtYXNrcyBhcmUgaW50cm9kdWNlZDsg
Yml0cyB3aGljaCB0aGUgZ3Vlc3QgaGFzIGNvbnRyb2wgb3ZlciwgYW5kIGJp
dHMKd2hpY2ggYXJlIGZvcndhcmRlZCBmcm9tIFhlbidzIHNldHRpbmdzLiAg
T25lIGd1ZXN0LXZpc2libGUgY2hhbmdlIGhlcmUgaXMKdGhhdCBYZW4ncyBW
TVhFIHNldHRpbmcgaXMgbm8gbG9uZ2VyIHZpc2libGUgYXQgYWxsLgoKcHZf
bWFrZV9jcjQoKSBmb2xsb3dzIGZhaXJseSBjbG9zZWx5IGZyb20gcHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KCksIGJ1dApkZWxpYmVyYXRlbHkgc3RhcnRz
IHdpdGggbW11X2NyNF9mZWF0dXJlcywgYW5kIG9ubHkgYWx0ZXJzIHRoZSBt
aW5pbWFsIHN1YnNldApvZiBiaXRzLgoKVGhlIGJvb3QtdGltZSB7Y29tcGF0
Xyx9cHZfY3I0X21hc2sgdmFyaWFibGVzIGFyZSByZW1vdmVkLCBhcyB0aGV5
IGFyZSBhCnJlbW5hbnQgb2YgdGhlIHByZS1DUFVJRCBwb2xpY3kgZGF5cy4g
IHB2X2ZpeHVwX2d1ZXN0X2NyNCgpIGdhaW5zIGEgcmVsYXRlZApkZXJpdmF0
aW9uIGZyb20gdGhlIHBvbGljeS4KCkFub3RoZXIgZ3Vlc3QgdmlzaWJsZSBj
aGFuZ2UgaGVyZSBpcyB0aGF0IGEgMzJiaXQgUFYgZ3Vlc3QgY2FuIG5vdyBm
bGlwCkZTR1NCQVNFIGluIGl0cyB2aWV3IG9mIENSNC4gIFdoaWxlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25zIGFyZQp1bnVzYWJsZSBv
dXRzaWRlIG9mIGEgNjRiaXQgY29kZSBzZWdtZW50LCB0aGUgYWJpbGl0eSB0
byBtb2RpZnkgRlNHU0JBU0UKbWF0Y2hlcyByZWFsIGhhcmR3YXJlIGJlaGF2
aW91ciwgYW5kIGF2b2lkcyB0aGUgbmVlZCBmb3IgYW55IDMyYml0LzY0Yml0
CmRpZmZlcmVuY2VzIGluIHRoZSBsb2dpYy4KCk92ZXJhbGwsIHRoaXMgcGF0
Y2ggc2hvdWxkbid0IGhhdmUgYSBwcmFjdGljYWwgY2hhbmdlIGluIGd1ZXN0
IGJlaGF2aW91ci4KVk1YRSB3aWxsIGRpc2FwcGVhciBmcm9tIHZpZXcsIGFu
ZCBhbiBpbnF1aXNpdGl2ZSAzMmJpdCBrZXJuZWwgY2FuIG5vdyBzZWUKRlNH
U0JBU0UgY2hhbmdpbmcsIGJ1dCB0aGlzIG5ldyBsb2dpYyBpcyBvdGhlcndp
c2UgYnVnLWNvbXBhdGlibGUgd2l0aCBiZWZvcmUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTI5MwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5k
cmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRpZmYgLS1naXQgYS94ZW4vYXJj
aC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXgg
ZmNiZTc2Ny4uODUzYjUyNCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2Rv
bWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtNzM0LDQ5
ICs3MzQsNiBAQCBpbnQgYXJjaF9kb21haW5fc29mdF9yZXNldChzdHJ1Y3Qg
ZG9tYWluICpkKQogICAgIHJldHVybiByZXQ7CiB9CiAKLS8qCi0gKiBUaGVz
ZSBhcmUgdGhlIG1hc2tzIG9mIENSNCBiaXRzIChzdWJqZWN0IHRvIGhhcmR3
YXJlIGF2YWlsYWJpbGl0eSkgd2hpY2ggYQotICogUFYgZ3Vlc3QgbWF5IG5v
dCBsZWdpdGltaWF0ZWx5IGF0dGVtcHQgdG8gbW9kaWZ5LgotICovCi1zdGF0
aWMgdW5zaWduZWQgbG9uZyBfX3JlYWRfbW9zdGx5IHB2X2NyNF9tYXNrLCBj
b21wYXRfcHZfY3I0X21hc2s7Ci0KLXN0YXRpYyBpbnQgX19pbml0IGluaXRf
cHZfY3I0X21hc2tzKHZvaWQpCi17Ci0gICAgdW5zaWduZWQgbG9uZyBjb21t
b25fbWFzayA9IH5YODZfQ1I0X1RTRDsKLQotICAgIC8qCi0gICAgICogQWxs
IFBWIGd1ZXN0cyBtYXkgYXR0ZW1wdCB0byBtb2RpZnkgVFNELCBERSBhbmQg
T1NYU0FWRS4KLSAgICAgKi8KLSAgICBpZiAoIGNwdV9oYXNfZGUgKQotICAg
ICAgICBjb21tb25fbWFzayAmPSB+WDg2X0NSNF9ERTsKLSAgICBpZiAoIGNw
dV9oYXNfeHNhdmUgKQotICAgICAgICBjb21tb25fbWFzayAmPSB+WDg2X0NS
NF9PU1hTQVZFOwotCi0gICAgcHZfY3I0X21hc2sgPSBjb21wYXRfcHZfY3I0
X21hc2sgPSBjb21tb25fbWFzazsKLQotICAgIC8qCi0gICAgICogNjRiaXQg
UFYgZ3Vlc3RzIG1heSBhdHRlbXB0IHRvIG1vZGlmeSBGU0dTQkFTRS4KLSAg
ICAgKi8KLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQotICAgICAgICBw
dl9jcjRfbWFzayAmPSB+WDg2X0NSNF9GU0dTQkFTRTsKLQotICAgIHJldHVy
biAwOwotfQotX19pbml0Y2FsbChpbml0X3B2X2NyNF9tYXNrcyk7Ci0KLXVu
c2lnbmVkIGxvbmcgcHZfZ3Vlc3RfY3I0X2ZpeHVwKGNvbnN0IHN0cnVjdCB2
Y3B1ICp2LCB1bnNpZ25lZCBsb25nIGd1ZXN0X2NyNCkKLXsKLSAgICB1bnNp
Z25lZCBsb25nIGh2X2NyNCA9IHJlYWxfY3I0X3RvX3B2X2d1ZXN0X2NyNChy
ZWFkX2NyNCgpKTsKLSAgICB1bnNpZ25lZCBsb25nIG1hc2sgPSBpc19wdl8z
MmJpdF92Y3B1KHYpID8gY29tcGF0X3B2X2NyNF9tYXNrIDogcHZfY3I0X21h
c2s7Ci0KLSAgICBpZiAoIChndWVzdF9jcjQgJiBtYXNrKSAhPSAoaHZfY3I0
ICYgbWFzaykgKQotICAgICAgICBwcmludGsoWEVOTE9HX0dfV0FSTklORwot
ICAgICAgICAgICAgICAgImQlZCBhdHRlbXB0ZWQgdG8gY2hhbmdlICVwdidz
IENSNCBmbGFncyAlMDhseCAtPiAlMDhseFxuIiwKLSAgICAgICAgICAgICAg
IGN1cnJlbnQtPmRvbWFpbi0+ZG9tYWluX2lkLCB2LCBodl9jcjQsIGd1ZXN0
X2NyNCk7Ci0KLSAgICByZXR1cm4gKGh2X2NyNCAmIG1hc2spIHwgKGd1ZXN0
X2NyNCAmIH5tYXNrKTsKLX0KLQogI2RlZmluZSB4ZW5fdmNwdV9ndWVzdF9j
b250ZXh0IHZjcHVfZ3Vlc3RfY29udGV4dAogI2RlZmluZSBmcHVfY3R4dCBm
cHVfY3R4dC54CiBDSEVDS19GSUVMRF8oc3RydWN0LCB2Y3B1X2d1ZXN0X2Nv
bnRleHQsIGZwdV9jdHh0KTsKQEAgLTc5MCw3ICs3NDcsNyBAQCBpbnQgYXJj
aF9zZXRfaW5mb19ndWVzdCgKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+
ZG9tYWluOwogICAgIHVuc2lnbmVkIGxvbmcgY3IzX2dmbjsKICAgICBzdHJ1
Y3QgcGFnZV9pbmZvICpjcjNfcGFnZTsKLSAgICB1bnNpZ25lZCBsb25nIGZs
YWdzLCBjcjQ7CisgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKICAgICB1bnNp
Z25lZCBpbnQgaTsKICAgICBpbnQgcmMgPSAwLCBjb21wYXQ7CiAKQEAgLTk4
MSw5ICs5MzgsOCBAQCBpbnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICB2
LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1swXSAmPSBYODZfQ1IwX1RTOwogICAg
IHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzBdIHw9IHJlYWRfY3IwKCkgJiB+
WDg2X0NSMF9UUzsKIAotICAgIGNyNCA9IHYtPmFyY2gucHZfdmNwdS5jdHJs
cmVnWzRdOwotICAgIHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gY3I0
ID8gcHZfZ3Vlc3RfY3I0X2ZpeHVwKHYsIGNyNCkgOgotICAgICAgICByZWFs
X2NyNF90b19wdl9ndWVzdF9jcjQobW11X2NyNF9mZWF0dXJlcyk7CisgICAg
di0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gPQorICAgICAgICBwdl9maXh1
cF9ndWVzdF9jcjQodiwgdi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0pOwog
CiAgICAgbWVtc2V0KHYtPmFyY2guZGVidWdyZWcsIDAsIHNpemVvZih2LT5h
cmNoLmRlYnVncmVnKSk7CiAgICAgZm9yICggaSA9IDA7IGkgPCA4OyBpKysg
KQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94
ODYvbW0uYwppbmRleCBjMjBlZGI5Li43MTY0OTlhIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
NTExLDMzICs1MTEsMTMgQEAgdm9pZCBtYWtlX2NyMyhzdHJ1Y3QgdmNwdSAq
diwgbWZuX3QgbWZuKQogICAgICAgICB2LT5hcmNoLmNyMyB8PSBnZXRfcGNp
ZF9iaXRzKHYsIGZhbHNlKTsKIH0KIAotdW5zaWduZWQgbG9uZyBwdl9ndWVz
dF9jcjRfdG9fcmVhbF9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpCi17Ci0g
ICAgY29uc3Qgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKLSAgICB1
bnNpZ25lZCBsb25nIGNyNDsKLQotICAgIGNyNCA9IHYtPmFyY2gucHZfdmNw
dS5jdHJscmVnWzRdICYgflg4Nl9DUjRfREU7Ci0gICAgY3I0IHw9IG1tdV9j
cjRfZmVhdHVyZXMgJiAoWDg2X0NSNF9QU0UgfCBYODZfQ1I0X1NNRVAgfCBY
ODZfQ1I0X1NNQVAgfAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFg4Nl9DUjRfT1NYU0FWRSB8IFg4Nl9DUjRfRlNHU0JBU0UpOwotCi0gICAg
aWYgKCBkLT5hcmNoLnB2X2RvbWFpbi5wY2lkICkKLSAgICAgICAgY3I0IHw9
IFg4Nl9DUjRfUENJREU7Ci0gICAgZWxzZSBpZiAoICFkLT5hcmNoLnB2X2Rv
bWFpbi54cHRpICkKLSAgICAgICAgY3I0IHw9IFg4Nl9DUjRfUEdFOwotCi0g
ICAgY3I0IHw9IGQtPmFyY2gudnRzYyA/IFg4Nl9DUjRfVFNEIDogMDsKLQot
ICAgIHJldHVybiBjcjQ7Ci19Ci0KIHZvaWQgd3JpdGVfcHRiYXNlKHN0cnVj
dCB2Y3B1ICp2KQogewogICAgIHN0cnVjdCBjcHVfaW5mbyAqY3B1X2luZm8g
PSBnZXRfY3B1X2luZm8oKTsKICAgICB1bnNpZ25lZCBsb25nIG5ld19jcjQ7
CiAKICAgICBuZXdfY3I0ID0gKGlzX3B2X3ZjcHUodikgJiYgIWlzX2lkbGVf
dmNwdSh2KSkKLSAgICAgICAgICAgICAgPyBwdl9ndWVzdF9jcjRfdG9fcmVh
bF9jcjQodikKLSAgICAgICAgICAgICAgOiAoKHJlYWRfY3I0KCkgJiB+KFg4
Nl9DUjRfUENJREUgfCBYODZfQ1I0X1RTRCkpIHwgWDg2X0NSNF9QR0UpOwor
ICAgICAgICAgICAgICA/IHB2X21ha2VfY3I0KHYpIDogbW11X2NyNF9mZWF0
dXJlczsKIAogICAgIGlmICggaXNfcHZfdmNwdSh2KSAmJiB2LT5kb21haW4t
PmFyY2gucHZfZG9tYWluLnhwdGkgKQogICAgIHsKQEAgLTU1Niw4ICs1MzYs
NiBAQCB2b2lkIHdyaXRlX3B0YmFzZShzdHJ1Y3QgdmNwdSAqdikKICAgICAg
ICAgc3dpdGNoX2NyM19jcjQodi0+YXJjaC5jcjMsIG5ld19jcjQpOwogICAg
ICAgICBjcHVfaW5mby0+cHZfY3IzID0gMDsKICAgICB9Ci0KLSAgICBBU1NF
UlQoaXNfcHZfdmNwdSh2KSB8fCByZWFkX2NyNCgpID09IG1tdV9jcjRfZmVh
dHVyZXMpOwogfQogCiAvKgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3B2
L2RvbWFpbi5jIGIveGVuL2FyY2gveDg2L3B2L2RvbWFpbi5jCmluZGV4IDk1
OGM2ZTMuLmE5Y2FhMDEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9k
b21haW4uYworKysgYi94ZW4vYXJjaC94ODYvcHYvZG9tYWluLmMKQEAgLTEw
Myw2ICsxMDMsNTIgQEAgc3RhdGljIHZvaWQgcmVsZWFzZV9jb21wYXRfbDQo
c3RydWN0IHZjcHUgKnYpCiAgICAgdi0+YXJjaC5ndWVzdF90YWJsZV91c2Vy
ID0gcGFnZXRhYmxlX251bGwoKTsKIH0KIAordW5zaWduZWQgbG9uZyBwdl9m
aXh1cF9ndWVzdF9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVk
IGxvbmcgY3I0KQoreworICAgIGNvbnN0IHN0cnVjdCBjcHVpZF9wb2xpY3kg
KnAgPSB2LT5kb21haW4tPmFyY2guY3B1aWQ7CisKKyAgICAvKiBEaXNjYXJk
IGF0dGVtcHRzIHRvIHNldCBndWVzdCBjb250cm9sbGFibGUgYml0cyBvdXRz
aWRlIG9mIHRoZSBwb2xpY3kuICovCisgICAgY3I0ICY9IH4oKHAtPmJhc2lj
LnRzYyAgICAgPyAwIDogWDg2X0NSNF9UU0QpICAgICAgfAorICAgICAgICAg
ICAgIChwLT5iYXNpYy5kZSAgICAgID8gMCA6IFg4Nl9DUjRfREUpICAgICAg
IHwKKyAgICAgICAgICAgICAocC0+ZmVhdC5mc2dzYmFzZSA/IDAgOiBYODZf
Q1I0X0ZTR1NCQVNFKSB8CisgICAgICAgICAgICAgKHAtPmJhc2ljLnhzYXZl
ICAgPyAwIDogWDg2X0NSNF9PU1hTQVZFKSk7CisKKyAgICAvKiBNYXNrcyBl
eHBlY3RlZCB0byBiZSBkaXNqb2ludCBzZXRzLiAqLworICAgIEJVSUxEX0JV
R19PTihQVl9DUjRfR1VFU1RfTUFTSyAmIFBWX0NSNF9HVUVTVF9WSVNJQkxF
X01BU0spOworCisgICAgLyoKKyAgICAgKiBBIGd1ZXN0IHNlZXMgdGhlIHBv
bGljeSBzdWJzZXQgb2YgaXRzIG93biBjaG9pY2Ugb2YgZ3Vlc3QgY29udHJv
bGxhYmxlCisgICAgICogYml0cywgYW5kIGEgc3Vic2V0IG9mIFhlbidzIGNo
b2ljZSBvZiBjZXJ0YWluIGhhcmR3YXJlIHNldHRpbmdzLgorICAgICAqLwor
ICAgIHJldHVybiAoKGNyNCAmIFBWX0NSNF9HVUVTVF9NQVNLKSB8CisgICAg
ICAgICAgICAobW11X2NyNF9mZWF0dXJlcyAmIFBWX0NSNF9HVUVTVF9WSVNJ
QkxFX01BU0spKTsKK30KKwordW5zaWduZWQgbG9uZyBwdl9tYWtlX2NyNChj
b25zdCBzdHJ1Y3QgdmNwdSAqdikKK3sKKyAgICBjb25zdCBzdHJ1Y3QgZG9t
YWluICpkID0gdi0+ZG9tYWluOworICAgIHVuc2lnbmVkIGxvbmcgY3I0ID0g
bW11X2NyNF9mZWF0dXJlcyAmCisgICAgICAgIH4oWDg2X0NSNF9QQ0lERSB8
IFg4Nl9DUjRfUEdFIHwgWDg2X0NSNF9UU0QpOworCisgICAgLyoKKyAgICAg
KiBQQ0lERSBvciBQR0UgZGVwZW5kcyBvbiB0aGUgUENJRC9YUFRJIHNldHRp
bmdzLCBidXQgbXVzdCBub3QgYm90aCBiZQorICAgICAqIHNldCwgYXMgaXQg
aW1wYWN0cyB0aGUgc2FmZXR5IG9mIFRMQiBmbHVzaGluZy4KKyAgICAgKi8K
KyAgICBpZiAoIGQtPmFyY2gucHZfZG9tYWluLnBjaWQgKQorICAgICAgICBj
cjQgfD0gWDg2X0NSNF9QQ0lERTsKKyAgICBlbHNlIGlmICggIWQtPmFyY2gu
cHZfZG9tYWluLnhwdGkgKQorICAgICAgICBjcjQgfD0gWDg2X0NSNF9QR0U7
CisKKyAgICAvKgorICAgICAqIFRTRCBpcyBuZWVkZWQgaWYgZWl0aGVyIHRo
ZSBndWVzdCBoYXMgZWxlY3RlZCB0byB1c2UgaXQsIG9yIFhlbiBpcworICAg
ICAqIHZpcnR1YWxpc2luZyB0aGUgVFNDIHZhbHVlIHRoZSBndWVzdCBzZWVz
LgorICAgICAqLworICAgIGlmICggZC0+YXJjaC52dHNjIHx8ICh2LT5hcmNo
LnB2X3ZjcHUuY3RybHJlZ1s0XSAmIFg4Nl9DUjRfVFNEKSApCisgICAgICAg
IGNyNCB8PSBYODZfQ1I0X1RTRDsKKworICAgIHJldHVybiBjcjQ7Cit9CisK
IGludCBzd2l0Y2hfY29tcGF0KHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAg
c3RydWN0IHZjcHUgKnY7CkBAIC0xOTcsNyArMjQzLDcgQEAgaW50IHB2X3Zj
cHVfaW5pdGlhbGlzZShzdHJ1Y3QgdmNwdSAqdikKICAgICAvKiBQViBndWVz
dHMgYnkgZGVmYXVsdCBoYXZlIGEgMTAwSHogdGlja2VyLiAqLwogICAgIHYt
PnBlcmlvZGljX3BlcmlvZCA9IE1JTExJU0VDUygxMCk7CiAKLSAgICB2LT5h
cmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHJlYWxfY3I0X3RvX3B2X2d1ZXN0
X2NyNChtbXVfY3I0X2ZlYXR1cmVzKTsKKyAgICB2LT5hcmNoLnB2X3ZjcHUu
Y3RybHJlZ1s0XSA9IHB2X2ZpeHVwX2d1ZXN0X2NyNCh2LCAwKTsKIAogICAg
IGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICkKICAgICB7CmRpZmYgLS1n
aXQgYS94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMgYi94ZW4vYXJj
aC94ODYvcHYvZW11bC1wcml2LW9wLmMKaW5kZXggYzI4MTkzNi4uY2QwNDU3
NCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3B2L2VtdWwtcHJpdi1vcC5j
CisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYwpAQCAtMzIs
NiArMzIsNyBAQAogI2luY2x1ZGUgPGFzbS9oeXBlcmNhbGwuaD4KICNpbmNs
dWRlIDxhc20vbWMxNDY4MThydGMuaD4KICNpbmNsdWRlIDxhc20vcDJtLmg+
CisjaW5jbHVkZSA8YXNtL3B2L2RvbWFpbi5oPgogI2luY2x1ZGUgPGFzbS9w
di90cmFwcy5oPgogI2luY2x1ZGUgPGFzbS9zaGFyZWQuaD4KICNpbmNsdWRl
IDxhc20vdHJhcHMuaD4KQEAgLTgwNCw4ICs4MDUsOCBAQCBzdGF0aWMgaW50
IHdyaXRlX2NyKHVuc2lnbmVkIGludCByZWcsIHVuc2lnbmVkIGxvbmcgdmFs
LAogICAgIH0KIAogICAgIGNhc2UgNDogLyogV3JpdGUgQ1I0ICovCi0gICAg
ICAgIGN1cnItPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gcHZfZ3Vlc3Rf
Y3I0X2ZpeHVwKGN1cnIsIHZhbCk7Ci0gICAgICAgIHdyaXRlX2NyNChwdl9n
dWVzdF9jcjRfdG9fcmVhbF9jcjQoY3VycikpOworICAgICAgICBjdXJyLT5h
cmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHB2X2ZpeHVwX2d1ZXN0X2NyNChj
dXJyLCB2YWwpOworICAgICAgICB3cml0ZV9jcjQocHZfbWFrZV9jcjQoY3Vy
cikpOwogICAgICAgICBjdHh0X3N3aXRjaF9sZXZlbGxpbmcoY3Vycik7CiAg
ICAgICAgIHJldHVybiBYODZFTVVMX09LQVk7CiAgICAgfQpkaWZmIC0tZ2l0
IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaCBiL3hlbi9pbmNsdWRl
L2FzbS14ODYvZG9tYWluLmgKaW5kZXggYjlmYTk4OC4uYWVjNjU2MyAxMDA2
NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaAorKysgYi94
ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oCkBAIC02MjMsMTcgKzYyMyw2
IEBAIGJvb2wgdXBkYXRlX3NlY29uZGFyeV9zeXN0ZW1fdGltZShzdHJ1Y3Qg
dmNwdSAqLAogdm9pZCB2Y3B1X3Nob3dfZXhlY3V0aW9uX3N0YXRlKHN0cnVj
dCB2Y3B1ICopOwogdm9pZCB2Y3B1X3Nob3dfcmVnaXN0ZXJzKGNvbnN0IHN0
cnVjdCB2Y3B1ICopOwogCi0vKiBDbGVhbiB1cCBDUjQgYml0cyB0aGF0IGFy
ZSBub3QgdW5kZXIgZ3Vlc3QgY29udHJvbC4gKi8KLXVuc2lnbmVkIGxvbmcg
cHZfZ3Vlc3RfY3I0X2ZpeHVwKGNvbnN0IHN0cnVjdCB2Y3B1ICosIHVuc2ln
bmVkIGxvbmcgZ3Vlc3RfY3I0KTsKLQotLyogQ29udmVydCBiZXR3ZWVuIGd1
ZXN0LXZpc2libGUgYW5kIHJlYWwgQ1I0IHZhbHVlcy4gKi8KLXVuc2lnbmVk
IGxvbmcgcHZfZ3Vlc3RfY3I0X3RvX3JlYWxfY3I0KGNvbnN0IHN0cnVjdCB2
Y3B1ICp2KTsKLQotI2RlZmluZSByZWFsX2NyNF90b19wdl9ndWVzdF9jcjQo
YykgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICgoYykgJiB+KFg4
Nl9DUjRfUEdFIHwgWDg2X0NSNF9QU0UgfCBYODZfQ1I0X1RTRCB8ICAgICAg
XAotICAgICAgICAgICAgIFg4Nl9DUjRfT1NYU0FWRSB8IFg4Nl9DUjRfU01F
UCB8ICAgICAgICAgICAgICAgXAotICAgICAgICAgICAgIFg4Nl9DUjRfRlNH
U0JBU0UgfCBYODZfQ1I0X1NNQVAgfCBYODZfQ1I0X1BDSURFKSkKLQogI2Rl
ZmluZSBkb21haW5fbWF4X3ZjcHVzKGQpIChpc19odm1fZG9tYWluKGQpID8g
SFZNX01BWF9WQ1BVUyA6IE1BWF9WSVJUX0NQVVMpCiAKIHN0YXRpYyBpbmxp
bmUgc3RydWN0IHZjcHVfZ3Vlc3RfY29udGV4dCAqYWxsb2NfdmNwdV9ndWVz
dF9jb250ZXh0KHZvaWQpCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20t
eDg2L3B2L2RvbWFpbi5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wdi9kb21h
aW4uaAppbmRleCA2Nzc4ZTFiLi4xZGRjNzI4IDEwMDY0NAotLS0gYS94ZW4v
aW5jbHVkZS9hc20teDg2L3B2L2RvbWFpbi5oCisrKyBiL3hlbi9pbmNsdWRl
L2FzbS14ODYvcHYvZG9tYWluLmgKQEAgLTYwLDYgKzYwLDIzIEBAIHZvaWQg
cHZfZG9tYWluX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCk7CiBpbnQgcHZf
ZG9tYWluX2luaXRpYWxpc2Uoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQg
aW50IGRvbWNyX2ZsYWdzLAogICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB4ZW5fYXJjaF9kb21haW5jb25maWcgKmNvbmZpZyk7CiAKKy8qCisg
KiBCaXRzIHdoaWNoIGEgUFYgZ3Vlc3QgY2FuIHRvZ2dsZSBpbiBpdHMgdmll
dyBvZiBjcjQuICBTb21lIGFyZSBsb2FkZWQgaW50bworICogaGFyZHdhcmUs
IHdoaWxlIHNvbWUgYXJlIGZ1bGx5IGVtdWxhdGVkLgorICovCisjZGVmaW5l
IFBWX0NSNF9HVUVTVF9NQVNLIFwKKyAgICAoWDg2X0NSNF9UU0QgfCBYODZf
Q1I0X0RFIHwgWDg2X0NSNF9GU0dTQkFTRSB8IFg4Nl9DUjRfT1NYU0FWRSkK
KworLyogQml0cyB3aGljaCBhIFBWIGd1ZXN0IG1heSBvYnNlcnZlIGZyb20g
dGhlIHJlYWwgaGFyZHdhcmUgc2V0dGluZ3MuICovCisjZGVmaW5lIFBWX0NS
NF9HVUVTVF9WSVNJQkxFX01BU0sgXAorICAgIChYODZfQ1I0X1BBRSB8IFg4
Nl9DUjRfTUNFIHwgWDg2X0NSNF9PU0ZYU1IgfCBYODZfQ1I0X09TWE1NRVhD
UFQpCisKKy8qIEdpdmVuIGEgbmV3IGNyNCB2YWx1ZSwgY29uc3RydWN0IHRo
ZSByZXN1bHRpbmcgZ3Vlc3QtdmlzaWJsZSBjcjQgdmFsdWUuICovCit1bnNp
Z25lZCBsb25nIHB2X2ZpeHVwX2d1ZXN0X2NyNChjb25zdCBzdHJ1Y3QgdmNw
dSAqdiwgdW5zaWduZWQgbG9uZyBjcjQpOworCisvKiBDcmVhdGUgYSBjcjQg
dmFsdWUgdG8gbG9hZCBpbnRvIGhhcmR3YXJlLCBiYXNlZCBvbiB2Y3B1IHNl
dHRpbmdzLiAqLwordW5zaWduZWQgbG9uZyBwdl9tYWtlX2NyNChjb25zdCBz
dHJ1Y3QgdmNwdSAqdik7CisKICNlbHNlICAvKiAhQ09ORklHX1BWICovCiAK
ICNpbmNsdWRlIDx4ZW4vZXJybm8uaD4KQEAgLTczLDYgKzkwLDkgQEAgc3Rh
dGljIGlubGluZSBpbnQgcHZfZG9tYWluX2luaXRpYWxpc2Uoc3RydWN0IGRv
bWFpbiAqZCwKIHsKICAgICByZXR1cm4gLUVPUE5PVFNVUFA7CiB9CisKK3N0
YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBwdl9tYWtlX2NyNChjb25zdCBz
dHJ1Y3QgdmNwdSAqdikgeyByZXR1cm4gfjB1bDsgfQorCiAjZW5kaWYJLyog
Q09ORklHX1BWICovCiAKIHZvaWQgcGFyYXZpcnRfY3R4dF9zd2l0Y2hfZnJv
bShzdHJ1Y3QgdmNwdSAqdik7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa293/4.10-2.patch"
Content-Disposition: attachment; filename="xsa293/4.10-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBEb24ndCBoYXZlICVjcjQuZnNnc2Jhc2Ug
YWN0aXZlIGJlaGluZCBhIGd1ZXN0IGtlcm5lbHMgYmFjawoKQ3VycmVudGx5
LCBhIDY0Yml0IFBWIGd1ZXN0IGNhbiBhcHBlYXIgdG8gc2V0IGFuZCBjbGVh
ciBGU0dTQkFTRSBpbiAlY3I0LCBidXQKdGhlIGJpdCByZW1haW5zIHNldCBp
biBoYXJkd2FyZS4gIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17RlMsR1N9QkFT
RSBhcmUgdXNhYmxlCmV2ZW4gd2hlbiB0aGUgZ3Vlc3Qga2VybmVsIGJlbGll
dmVzIHRoYXQgdGhleSBhcmUgZGlzYWJsZWQuCgpUaGUgRlNHU0JBU0UgZmVh
dHVyZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIExpbnV4LCBhbmQg
aXRzIGNvbnRleHQKc3dpdGNoIHBhdGggaGFzIHNvbWUgb3B0aW1pc2F0aW9u
cyB3aGljaCByZWx5IG9uIHVzZXJzcGFjZSBiZWluZyB1bmFibGUgdG8gdXNl
CnRoZSBXUntGUyxHU31CQVNFIGluc3RydWN0aW9ucy4gIFhlbidzIGN1cnJl
bnQgYmVoYXZpb3VyIHVuZGVybWluZXMgdGhpcwpleHBlY3RhdGlvbi4KCklu
IDY0Yml0IFBWIGd1ZXN0IGNvbnRleHQsIGFsd2F5cyBsb2FkIHRoZSBndWVz
dCBrZXJuZWxzIHNldHRpbmcgb2YgRlNHU0JBU0UKaW50byAlY3I0LiAgVGhp
cyByZXF1aXJlcyBhZGp1c3RpbmcgaG93IFhlbiB1c2VzIHRoZSB7UkQsV1J9
e0ZTLEdTfUJBU0UKaW5zdHJ1Y3Rpb25zLgoKICogRGVsZXRlIHRoZSBjcHVf
aGFzX2ZzZ3NiYXNlIGhlbHBlci4gIEl0IGlzIG5vIGxvbmdlciBzYWZlLCBh
cyB1c2VycyBuZWVkIHRvCiAgIGNoZWNrICVjcjQgZGlyZWN0bHkuCiAqIFRo
ZSByYXcgX19yZHtmcyxnc31iYXNlKCkgaGVscGVycyBhcmUgb25seSBzYWZl
IHRvIHVzZSB3aGVuICVjcjQuZnNnc2Jhc2UKICAgaXMgc2V0LiAgQ29tbWVu
dCB0aGlzIHByb3BlcnR5LgogKiBUaGUge3JkLHdyfXtmcyxnc317YmFzZSxz
aGFkb3d9KCkgYW5kIHJlYWRfbXNyKCkgaGVscGVycyBhcmUgdXBkYXRlZCB0
byB1c2UKICAgdGhlIGN1cnJlbnQgJWNyNCB2YWx1ZSB0byBkZXRlcm1pbmUg
d2hpY2ggbWVjaGFuaXNtIHRvIHVzZS4KICogdG9nZ2xlX2d1ZXN0X21vZGUo
KSBhbmQgc2F2ZV9zZWdtZW50cygpIGFyZSB1cGRhdGUgdG8gYXZvaWQgcmVh
ZGluZwogICBmcy9nc2Jhc2UgaWYgdGhlIHZhbHVlcyBpbiBoYXJkd2FyZSBj
YW5ub3QgYmUgc3RhbGUgV1JUIHN0cnVjdCB2Y3B1LiAgQQogICBjb25zZXF1
ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHdyaXRlX2NyKCkgcGF0aCBuZWVk
cyB0byBjYWNoZSB0aGUgY3VycmVudAogICBiYXNlcywgYXMgc3Vic2VxdWVu
dCBjb250ZXh0IHN3aXRjaGVzIHdpbGwgc2tpcCBzYXZpbmcgdGhlIHZhbHVl
cy4KICogd3JpdGVfY3I0KCkgaXMgdXBkYXRlZCB0byBlbnN1cmUgdGhhdCB0
aGUgc2hhZG93ICVjcjQuZnNnc2Jhc2UgdmFsdWUgaXMKICAgb2JzZXJ2ZWQg
aW4gYSBzYWZlIHdheSBXUlQgdGhlIGhhcmR3YXJlIHNldHRpbmcsIGlmIGFu
IGludGVycnVwdCBoYXBwZW5zIHRvCiAgIGhpdCBpbiB0aGUgbWlkZGxlLgog
KiBwdl9tYWtlX2NyNCgpIGlzIHVwZGF0ZWQgZm9yIDY0Yml0IFBWIGd1ZXN0
cyB0byB1c2UgdGhlIGd1ZXN0IGtlcm5lbHMKICAgY2hvaWNlIG9mIEZTR1NC
QVNFLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTMKClJlcG9ydGVkLWJ5OiBB
bmR5IEx1dG9taXJza2kgPGx1dG9Aa2VybmVsLm9yZz4KU2lnbmVkLW9mZi1i
eTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4K
UmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4K
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJj
aC94ODYvZG9tYWluLmMKaW5kZXggODUzYjUyNC4uOTFjMmIxYyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9kb21haW4uYwpAQCAtMTQzMSw3ICsxNDMxLDggQEAgc3RhdGljIHZvaWQg
c2F2ZV9zZWdtZW50cyhzdHJ1Y3QgdmNwdSAqdikKICAgICByZWdzLT5mcyA9
IHJlYWRfc3JlZyhmcyk7CiAgICAgcmVncy0+Z3MgPSByZWFkX3NyZWcoZ3Mp
OwogCi0gICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICYmICFpc19wdl8zMmJp
dF92Y3B1KHYpICkKKyAgICAvKiAlZnMvJWdzIGJhc2VzIGNhbiBvbmx5IGJl
IHN0YWxlIGlmIFdSe0ZTLEdTfUJBU0UgYXJlIHVzYWJsZS4gKi8KKyAgICBp
ZiAoIChyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSkgJiYgIWlzX3B2
XzMyYml0X3ZjcHUodikgKQogICAgIHsKICAgICAgICAgdi0+YXJjaC5wdl92
Y3B1LmZzX2Jhc2UgPSBfX3JkZnNiYXNlKCk7CiAgICAgICAgIGlmICggdi0+
YXJjaC5mbGFncyAmIFRGX2tlcm5lbF9tb2RlICkKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni9wdi9kb21haW4uYyBiL3hlbi9hcmNoL3g4Ni9wdi9kb21h
aW4uYwppbmRleCBhOWNhYTAxLi44MmM2ZTJmIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvcHYvZG9tYWluLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2Rv
bWFpbi5jCkBAIC0xNDYsNiArMTQ2LDE2IEBAIHVuc2lnbmVkIGxvbmcgcHZf
bWFrZV9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiAgICAgaWYgKCBkLT5h
cmNoLnZ0c2MgfHwgKHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdICYgWDg2
X0NSNF9UU0QpICkKICAgICAgICAgY3I0IHw9IFg4Nl9DUjRfVFNEOwogCisg
ICAgLyoKKyAgICAgKiBUaGUge1JELFdSfXtGUyxHU31CQVNFIGFyZSBvbmx5
IHVzZWFibGUgaW4gNjRiaXQgY29kZSBzZWdtZW50cy4gIFdoaWxlCisgICAg
ICogd2UgbXVzdCBub3QgaGF2ZSBDUjQuRlNHU0JBU0Ugc2V0IGJlaGluZCB0
aGUgYmFjayBvZiBhIDY0Yml0IFBWIGtlcm5lbCwKKyAgICAgKiB3ZSBkbyBs
ZWF2ZSBpdCBzZXQgaW4gMzJiaXQgUFYgY29udGV4dCB0byBzcGVlZCB1cCBY
ZW4ncyBjb250ZXh0IHN3aXRjaAorICAgICAqIHBhdGguCisgICAgICovCisg
ICAgaWYgKCAhaXNfcHZfMzJiaXRfZG9tYWluKGQpICYmCisgICAgICAgICAh
KHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdICYgWDg2X0NSNF9GU0dTQkFT
RSkgKQorICAgICAgICBjcjQgJj0gflg4Nl9DUjRfRlNHU0JBU0U7CisKICAg
ICByZXR1cm4gY3I0OwogfQogCkBAIC0zNTEsNyArMzYxLDggQEAgdm9pZCB0
b2dnbGVfZ3Vlc3RfbW9kZShzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoIGlz
X3B2XzMyYml0X3ZjcHUodikgKQogICAgICAgICByZXR1cm47CiAKLSAgICBp
ZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQorICAgIC8qICVmcy8lZ3MgYmFzZXMg
Y2FuIG9ubHkgYmUgc3RhbGUgaWYgV1J7RlMsR1N9QkFTRSBhcmUgdXNhYmxl
LiAqLworICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Ug
KQogICAgIHsKICAgICAgICAgaWYgKCB2LT5hcmNoLmZsYWdzICYgVEZfa2Vy
bmVsX21vZGUgKQogICAgICAgICAgICAgdi0+YXJjaC5wdl92Y3B1LmdzX2Jh
c2Vfa2VybmVsID0gX19yZGdzYmFzZSgpOwpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L3B2L2VtdWwtcHJpdi1vcC5jIGIveGVuL2FyY2gveDg2L3B2L2Vt
dWwtcHJpdi1vcC5jCmluZGV4IGNkMDQ1NzQuLjAzNDRjOTggMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYworKysgYi94ZW4v
YXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMKQEAgLTgwNSw2ICs4MDUsMTcg
QEAgc3RhdGljIGludCB3cml0ZV9jcih1bnNpZ25lZCBpbnQgcmVnLCB1bnNp
Z25lZCBsb25nIHZhbCwKICAgICB9CiAKICAgICBjYXNlIDQ6IC8qIFdyaXRl
IENSNCAqLworICAgICAgICAvKgorICAgICAgICAgKiBJZiB0aGlzIHdyaXRl
IHdpbGwgZGlzYWJsZSBGU0dTQkFTRSwgcmVmcmVzaCBYZW4ncyBpZGVhIG9m
IHRoZQorICAgICAgICAgKiBndWVzdCBiYXNlcyBub3cgdGhhdCB0aGV5IGNh
biBubyBsb25nZXIgY2hhbmdlLgorICAgICAgICAgKi8KKyAgICAgICAgaWYg
KCAoY3Vyci0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gJiBYODZfQ1I0X0ZT
R1NCQVNFKSAmJgorICAgICAgICAgICAgICEodmFsICYgWDg2X0NSNF9GU0dT
QkFTRSkgKQorICAgICAgICB7CisgICAgICAgICAgICBjdXJyLT5hcmNoLnB2
X3ZjcHUuZnNfYmFzZSA9IF9fcmRmc2Jhc2UoKTsKKyAgICAgICAgICAgIGN1
cnItPmFyY2gucHZfdmNwdS5nc19iYXNlX2tlcm5lbCA9IF9fcmRnc2Jhc2Uo
KTsKKyAgICAgICAgfQorCiAgICAgICAgIGN1cnItPmFyY2gucHZfdmNwdS5j
dHJscmVnWzRdID0gcHZfZml4dXBfZ3Vlc3RfY3I0KGN1cnIsIHZhbCk7CiAg
ICAgICAgIHdyaXRlX2NyNChwdl9tYWtlX2NyNChjdXJyKSk7CiAgICAgICAg
IGN0eHRfc3dpdGNoX2xldmVsbGluZyhjdXJyKTsKQEAgLTg1NCwxNCArODY1
LDE1IEBAIHN0YXRpYyBpbnQgcmVhZF9tc3IodW5zaWduZWQgaW50IHJlZywg
dWludDY0X3QgKnZhbCwKICAgICBjYXNlIE1TUl9GU19CQVNFOgogICAgICAg
ICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihjdXJyZCkgKQogICAgICAgICAg
ICAgYnJlYWs7Ci0gICAgICAgICp2YWwgPSBjcHVfaGFzX2ZzZ3NiYXNlID8g
X19yZGZzYmFzZSgpIDogY3Vyci0+YXJjaC5wdl92Y3B1LmZzX2Jhc2U7Cisg
ICAgICAgICp2YWwgPSAocmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Up
ID8gX19yZGZzYmFzZSgpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDogY3Vyci0+YXJjaC5wdl92Y3B1LmZzX2Jh
c2U7CiAgICAgICAgIHJldHVybiBYODZFTVVMX09LQVk7CiAKICAgICBjYXNl
IE1TUl9HU19CQVNFOgogICAgICAgICBpZiAoIGlzX3B2XzMyYml0X2RvbWFp
bihjdXJyZCkgKQogICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgICp2YWwg
PSBjcHVfaGFzX2ZzZ3NiYXNlID8gX19yZGdzYmFzZSgpCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDogY3Vyci0+YXJjaC5wdl92Y3B1Lmdz
X2Jhc2Vfa2VybmVsOworICAgICAgICAqdmFsID0gKHJlYWRfY3I0KCkgJiBY
ODZfQ1I0X0ZTR1NCQVNFKSA/IF9fcmRnc2Jhc2UoKQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGN1cnItPmFy
Y2gucHZfdmNwdS5nc19iYXNlX2tlcm5lbDsKICAgICAgICAgcmV0dXJuIFg4
NkVNVUxfT0tBWTsKIAogICAgIGNhc2UgTVNSX1NIQURPV19HU19CQVNFOgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3NldHVwLmMgYi94ZW4vYXJjaC94
ODYvc2V0dXAuYwppbmRleCA2MTdkYmIxLi43OTAzMjA0IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvc2V0dXAuYworKysgYi94ZW4vYXJjaC94ODYvc2V0
dXAuYwpAQCAtMTU2MCw3ICsxNTYwLDcgQEAgdm9pZCBfX2luaXQgbm9yZXR1
cm4gX19zdGFydF94ZW4odW5zaWduZWQgbG9uZyBtYmlfcCkKIAogICAgIGNy
NF9wdjMyX21hc2sgPSBtbXVfY3I0X2ZlYXR1cmVzICYgWEVOX0NSNF9QVjMy
X0JJVFM7CiAKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQorICAgIGlm
ICggYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0ZTR1NCQVNFKSApCiAgICAg
ICAgIHNldF9pbl9jcjQoWDg2X0NSNF9GU0dTQkFTRSk7CiAKICAgICBpZiAo
IG9wdF9pbnZwY2lkICYmIGNwdV9oYXNfaW52cGNpZCApCmRpZmYgLS1naXQg
YS94ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaCBiL3hlbi9pbmNs
dWRlL2FzbS14ODYvY3B1ZmVhdHVyZS5oCmluZGV4IGZmNmY5NjkuLjUwNDMy
MzEgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvY3B1ZmVhdHVy
ZS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvY3B1ZmVhdHVyZS5oCkBA
IC04NCw3ICs4NCw2IEBACiAjZGVmaW5lIGNwdV9oYXNfeHNhdmVzICAgICAg
ICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9YU0FWRVMpCiAKIC8qIENQ
VUlEIGxldmVsIDB4MDAwMDAwMDc6MC5lYnggKi8KLSNkZWZpbmUgY3B1X2hh
c19mc2dzYmFzZSAgICAgICAgYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0ZT
R1NCQVNFKQogI2RlZmluZSBjcHVfaGFzX2JtaTEgICAgICAgICAgICBib290
X2NwdV9oYXMoWDg2X0ZFQVRVUkVfQk1JMSkKICNkZWZpbmUgY3B1X2hhc19o
bGUgICAgICAgICAgICAgYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0hMRSkK
ICNkZWZpbmUgY3B1X2hhc19hdngyICAgICAgICAgICAgYm9vdF9jcHVfaGFz
KFg4Nl9GRUFUVVJFX0FWWDIpCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9h
c20teDg2L21zci5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3IuaAppbmRl
eCAyMmQ1YjcxLi4xNDNlZWEzIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9h
c20teDg2L21zci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLmgK
QEAgLTEyMCw2ICsxMjAsMTQgQEAgc3RhdGljIGlubGluZSB1aW50NjRfdCBy
ZHRzY19vcmRlcmVkKHZvaWQpCiAJCQkgIDogIj1hIiAobG93KSwgIj1kIiAo
aGlnaCkgXAogCQkJICA6ICJjIiAoY291bnRlcikpCiAKKy8qCisgKiBPbiBo
YXJkd2FyZSBzdXBwb3J0aW5nIEZTR1NCQVNFLCB0aGUgdmFsdWUgbG9hZGVk
IGludG8gaGFyZHdhcmUgaXMgdGhlCisgKiBndWVzdCBrZXJuZWwncyBjaG9p
Y2UgZm9yIDY0Yml0IFBWIGd1ZXN0cyAoWGVuJ3MgY2hvaWNlIGZvciBJZGxl
LCBIVk0gYW5kCisgKiAzMmJpdCBQVikuCisgKgorICogVGhlcmVmb3JlLCB0
aGUge1JELFdSfXtGUyxHU31CQVNFIGluc3RydWN0aW9ucyBhcmUgb25seSBz
YWZlIHRvIHVzZSBpZgorICogJWNyNC5mc2dzYmFzZSBpcyBzZXQuCisgKi8K
IHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBfX3JkZnNiYXNlKHZvaWQp
CiB7CiAgICAgdW5zaWduZWQgbG9uZyBiYXNlOwpAQCAtMTUwLDcgKzE1OCw3
IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGZzYmFzZSh2b2lk
KQogewogICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKIAotICAgIGlmICggY3B1
X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NS
NF9GU0dTQkFTRSApCiAgICAgICAgIHJldHVybiBfX3JkZnNiYXNlKCk7CiAK
ICAgICByZG1zcmwoTVNSX0ZTX0JBU0UsIGJhc2UpOwpAQCAtMTYyLDcgKzE3
MCw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGdzYmFzZSh2
b2lkKQogewogICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKIAotICAgIGlmICgg
Y3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2
X0NSNF9GU0dTQkFTRSApCiAgICAgICAgIHJldHVybiBfX3JkZ3NiYXNlKCk7
CiAKICAgICByZG1zcmwoTVNSX0dTX0JBU0UsIGJhc2UpOwpAQCAtMTcyLDcg
KzE4MCw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGdzYmFz
ZSh2b2lkKQogCiBzdGF0aWMgaW5saW5lIHZvaWQgd3Jmc2Jhc2UodW5zaWdu
ZWQgbG9uZyBiYXNlKQogewotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSAp
CisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSApCiAj
aWZkZWYgSEFWRV9HQVNfRlNHU0JBU0UKICAgICAgICAgYXNtIHZvbGF0aWxl
ICggIndyZnNiYXNlICUwIiA6OiAiciIgKGJhc2UpICk7CiAjZWxzZQpAQCAt
MTg0LDcgKzE5Miw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB3cmZzYmFzZSh1
bnNpZ25lZCBsb25nIGJhc2UpCiAKIHN0YXRpYyBpbmxpbmUgdm9pZCB3cmdz
YmFzZSh1bnNpZ25lZCBsb25nIGJhc2UpCiB7Ci0gICAgaWYgKCBjcHVfaGFz
X2ZzZ3NiYXNlICkKKyAgICBpZiAoIHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZT
R1NCQVNFICkKICNpZmRlZiBIQVZFX0dBU19GU0dTQkFTRQogICAgICAgICBh
c20gdm9sYXRpbGUgKCAid3Jnc2Jhc2UgJTAiIDo6ICJyIiAoYmFzZSkgKTsK
ICNlbHNlCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nl
c3Nvci5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaAppbmRl
eCA5MGEyNzAxLi5hMGY4YmY0IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9h
c20teDg2L3Byb2Nlc3Nvci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYv
cHJvY2Vzc29yLmgKQEAgLTMxNSwxMSArMzE1LDMxIEBAIHN0YXRpYyBpbmxp
bmUgdW5zaWduZWQgbG9uZyByZWFkX2NyNCh2b2lkKQogCiBzdGF0aWMgaW5s
aW5lIHZvaWQgd3JpdGVfY3I0KHVuc2lnbmVkIGxvbmcgdmFsKQogeworICAg
IHN0cnVjdCBjcHVfaW5mbyAqaW5mbyA9IGdldF9jcHVfaW5mbygpOworCiAg
ICAgLyogTm8gZ2xvYmFsIHBhZ2VzIGluIGNhc2Ugb2YgUENJRHMgZW5hYmxl
ZCEgKi8KICAgICBBU1NFUlQoISh2YWwgJiBYODZfQ1I0X1BHRSkgfHwgISh2
YWwgJiBYODZfQ1I0X1BDSURFKSk7CiAKLSAgICBnZXRfY3B1X2luZm8oKS0+
Y3I0ID0gdmFsOwotICAgIGFzbSB2b2xhdGlsZSAoICJtb3YgJTAsJSVjcjQi
IDogOiAiciIgKHZhbCkgKTsKKyAgICAvKgorICAgICAqIE9uIGhhcmR3YXJl
IHN1cHBvcnRpbmcgRlNHU0JBU0UsIHRoZSB2YWx1ZSBpbiAlY3I0IGlzIHRo
ZSBrZXJuZWwncworICAgICAqIGNob2ljZSBmb3IgNjRiaXQgUFYgZ3Vlc3Rz
LCB3aGljaCBpbXBhY3RzIHdoZXRoZXIgWGVuIGNhbiB1c2UgdGhlCisgICAg
ICogaW5zdHJ1Y3Rpb25zLgorICAgICAqCisgICAgICogVGhlIHtyZCx3cn17
ZnMsZ3N9YmFzZSgpIGhlbHBlcnMgdXNlIGluZm8tPmNyNCB0byB3b3JrIG91
dCB3aGV0aGVyIGl0CisgICAgICogaXMgc2FmZSB0byBleGVjdXRlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb24sIGZhbGxpbmcgYmFjayB0
bworICAgICAqIHRoZSBNU1IgcGF0aCBpZiBub3QuICBTb21lIHVzZXJzIHJl
cXVpcmUgaW50ZXJydXB0IHNhZmV0eS4KKyAgICAgKgorICAgICAqIElmIEZT
R1NCQVNFIGlzIGN1cnJlbnRseSBvciBhYm91dCB0byBiZWNvbWUgY2xlYXIs
IHJlZmxlY3QgdGhpcyBpbgorICAgICAqIGluZm8tPmNyNCBiZWZvcmUgdXBk
YXRpbmcgJWNyNCwgc28gYW4gaW50ZXJydXB0IHdoaWNoIGhpdHMgaW4gdGhl
CisgICAgICogbWlkZGxlIHdvbid0IG9ic2VydmUgRlNHU0JBU0Ugc2V0IGlu
IGluZm8tPmNyNCBidXQgY2xlYXIgaW4gJWNyNC4KKyAgICAgKi8KKyAgICBp
bmZvLT5jcjQgPSB2YWwgJiAoaW5mby0+Y3I0IHwgflg4Nl9DUjRfRlNHU0JB
U0UpOworCisgICAgYXNtIHZvbGF0aWxlICggIm1vdiAlW3ZhbF0sICUlY3I0
IgorICAgICAgICAgICAgICAgICAgIDogIittIiAoaW5mby0+Y3I0KSAvKiBG
b3JjZSBvcmRlcmluZyB3aXRob3V0IGEgYmFycmllci4gKi8KKyAgICAgICAg
ICAgICAgICAgICA6IFt2YWxdICJyIiAodmFsKSApOworCisgICAgaW5mby0+
Y3I0ID0gdmFsOwogfQogCiAvKiBDbGVhciBhbmQgc2V0ICdUUycgYml0IHJl
c3BlY3RpdmVseSAqLwo=

--=separator
Content-Type: application/octet-stream; name="xsa293/4.11-1.patch"
Content-Disposition: attachment; filename="xsa293/4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBSZXdyaXRlIGd1ZXN0ICVjcjQgaGFuZGxp
bmcgZnJvbSBzY3JhdGNoCgpUaGUgUFYgY3I0IGxvZ2ljIGlzIGFsbW9zdCBp
bXBvc3NpYmxlIHRvIGZvbGxvdywgYW5kIGxlYWtzIGJpdHMgaW50byBndWVz
dApjb250ZXh0IHdoaWNoIGRlZmluaXRlbHkgc2hvdWxkbid0IGJlIHZpc2li
bGUgKGluIHBhcnRpY3VsYXIsIFZNWEUpLgoKVGhlIGJpZ2dlc3QgcHJvYmxl
bSBob3dldmVyLCBhbmQgc291cmNlIG9mIHRoZSBjb21wbGV4aXR5LCBpcyB0
aGF0IGl0IGRlcml2ZXMKbmV3IHJlYWwgYW5kIGd1ZXN0IGNyNCB2YWx1ZXMg
ZnJvbSB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZSAtIHRoaXMgaXMK
Y29udGV4dCBkZXBlbmRlbnQgYW5kIGFuIGluYXBwcm9wcmlhdGUgc291cmNl
IG9mIGluZm9ybWF0aW9uLgoKUmV3cml0ZSB0aGUgY3I0IGxvZ2ljIHRvIGJl
IGludmFyaWFudCBvZiB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZS4K
CkZpcnN0IG9mIGFsbCwgbW9kaWZ5IHdyaXRlX3B0YmFzZSgpIHRvIGFsd2F5
cyB1c2UgbW11X2NyNF9mZWF0dXJlcyBmb3IgSURMRQphbmQgSFZNIGNvbnRl
eHRzLiAgbW11X2NyNF9mZWF0dXJlcyAqaXMqIHRoZSBjb3JyZWN0IHZhbHVl
IHRvIHVzZSwgYW5kIG1ha2VzCnRoZSBBU1NFUlQoKSBvYnZpb3VzbHkgcmVk
dW5kYW50LgoKRm9yIFBWIGd1ZXN0cywgY3Vyci0+YXJjaC5wdi5jdHJscmVn
WzRdIHJlbWFpbnMgdGhlIGd1ZXN0cyB2aWV3IG9mIGNyNCwgYnV0CmFsbCBs
b2dpYyBnZXRzIHJld29ya2VkIGluIHRlcm1zIG9mIHRoaXMgYW5kIG1tdV9j
cjRfZmVhdHVyZXMgb25seS4KClR3byBtYXNrcyBhcmUgaW50cm9kdWNlZDsg
Yml0cyB3aGljaCB0aGUgZ3Vlc3QgaGFzIGNvbnRyb2wgb3ZlciwgYW5kIGJp
dHMKd2hpY2ggYXJlIGZvcndhcmRlZCBmcm9tIFhlbidzIHNldHRpbmdzLiAg
T25lIGd1ZXN0LXZpc2libGUgY2hhbmdlIGhlcmUgaXMKdGhhdCBYZW4ncyBW
TVhFIHNldHRpbmcgaXMgbm8gbG9uZ2VyIHZpc2libGUgYXQgYWxsLgoKcHZf
bWFrZV9jcjQoKSBmb2xsb3dzIGZhaXJseSBjbG9zZWx5IGZyb20gcHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KCksIGJ1dApkZWxpYmVyYXRlbHkgc3RhcnRz
IHdpdGggbW11X2NyNF9mZWF0dXJlcywgYW5kIG9ubHkgYWx0ZXJzIHRoZSBt
aW5pbWFsIHN1YnNldApvZiBiaXRzLgoKVGhlIGJvb3QtdGltZSB7Y29tcGF0
Xyx9cHZfY3I0X21hc2sgdmFyaWFibGVzIGFyZSByZW1vdmVkLCBhcyB0aGV5
IGFyZSBhCnJlbW5hbnQgb2YgdGhlIHByZS1DUFVJRCBwb2xpY3kgZGF5cy4g
IHB2X2ZpeHVwX2d1ZXN0X2NyNCgpIGdhaW5zIGEgcmVsYXRlZApkZXJpdmF0
aW9uIGZyb20gdGhlIHBvbGljeS4KCkFub3RoZXIgZ3Vlc3QgdmlzaWJsZSBj
aGFuZ2UgaGVyZSBpcyB0aGF0IGEgMzJiaXQgUFYgZ3Vlc3QgY2FuIG5vdyBm
bGlwCkZTR1NCQVNFIGluIGl0cyB2aWV3IG9mIENSNC4gIFdoaWxlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25zIGFyZQp1bnVzYWJsZSBv
dXRzaWRlIG9mIGEgNjRiaXQgY29kZSBzZWdtZW50LCB0aGUgYWJpbGl0eSB0
byBtb2RpZnkgRlNHU0JBU0UKbWF0Y2hlcyByZWFsIGhhcmR3YXJlIGJlaGF2
aW91ciwgYW5kIGF2b2lkcyB0aGUgbmVlZCBmb3IgYW55IDMyYml0LzY0Yml0
CmRpZmZlcmVuY2VzIGluIHRoZSBsb2dpYy4KCk92ZXJhbGwsIHRoaXMgcGF0
Y2ggc2hvdWxkbid0IGhhdmUgYSBwcmFjdGljYWwgY2hhbmdlIGluIGd1ZXN0
IGJlaGF2aW91ci4KVk1YRSB3aWxsIGRpc2FwcGVhciBmcm9tIHZpZXcsIGFu
ZCBhbiBpbnF1aXNpdGl2ZSAzMmJpdCBrZXJuZWwgY2FuIG5vdyBzZWUKRlNH
U0JBU0UgY2hhbmdpbmcsIGJ1dCB0aGlzIG5ldyBsb2dpYyBpcyBvdGhlcndp
c2UgYnVnLWNvbXBhdGlibGUgd2l0aCBiZWZvcmUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTI5MwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5k
cmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRpZmYgLS1naXQgYS94ZW4vYXJj
aC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXgg
YjFlNTBkMS4uNjc1MTUyYSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2Rv
bWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtNzMzLDQ5
ICs3MzMsNiBAQCBpbnQgYXJjaF9kb21haW5fc29mdF9yZXNldChzdHJ1Y3Qg
ZG9tYWluICpkKQogICAgIHJldHVybiByZXQ7CiB9CiAKLS8qCi0gKiBUaGVz
ZSBhcmUgdGhlIG1hc2tzIG9mIENSNCBiaXRzIChzdWJqZWN0IHRvIGhhcmR3
YXJlIGF2YWlsYWJpbGl0eSkgd2hpY2ggYQotICogUFYgZ3Vlc3QgbWF5IG5v
dCBsZWdpdGltaWF0ZWx5IGF0dGVtcHQgdG8gbW9kaWZ5LgotICovCi1zdGF0
aWMgdW5zaWduZWQgbG9uZyBfX3JlYWRfbW9zdGx5IHB2X2NyNF9tYXNrLCBj
b21wYXRfcHZfY3I0X21hc2s7Ci0KLXN0YXRpYyBpbnQgX19pbml0IGluaXRf
cHZfY3I0X21hc2tzKHZvaWQpCi17Ci0gICAgdW5zaWduZWQgbG9uZyBjb21t
b25fbWFzayA9IH5YODZfQ1I0X1RTRDsKLQotICAgIC8qCi0gICAgICogQWxs
IFBWIGd1ZXN0cyBtYXkgYXR0ZW1wdCB0byBtb2RpZnkgVFNELCBERSBhbmQg
T1NYU0FWRS4KLSAgICAgKi8KLSAgICBpZiAoIGNwdV9oYXNfZGUgKQotICAg
ICAgICBjb21tb25fbWFzayAmPSB+WDg2X0NSNF9ERTsKLSAgICBpZiAoIGNw
dV9oYXNfeHNhdmUgKQotICAgICAgICBjb21tb25fbWFzayAmPSB+WDg2X0NS
NF9PU1hTQVZFOwotCi0gICAgcHZfY3I0X21hc2sgPSBjb21wYXRfcHZfY3I0
X21hc2sgPSBjb21tb25fbWFzazsKLQotICAgIC8qCi0gICAgICogNjRiaXQg
UFYgZ3Vlc3RzIG1heSBhdHRlbXB0IHRvIG1vZGlmeSBGU0dTQkFTRS4KLSAg
ICAgKi8KLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQotICAgICAgICBw
dl9jcjRfbWFzayAmPSB+WDg2X0NSNF9GU0dTQkFTRTsKLQotICAgIHJldHVy
biAwOwotfQotX19pbml0Y2FsbChpbml0X3B2X2NyNF9tYXNrcyk7Ci0KLXVu
c2lnbmVkIGxvbmcgcHZfZ3Vlc3RfY3I0X2ZpeHVwKGNvbnN0IHN0cnVjdCB2
Y3B1ICp2LCB1bnNpZ25lZCBsb25nIGd1ZXN0X2NyNCkKLXsKLSAgICB1bnNp
Z25lZCBsb25nIGh2X2NyNCA9IHJlYWxfY3I0X3RvX3B2X2d1ZXN0X2NyNChy
ZWFkX2NyNCgpKTsKLSAgICB1bnNpZ25lZCBsb25nIG1hc2sgPSBpc19wdl8z
MmJpdF92Y3B1KHYpID8gY29tcGF0X3B2X2NyNF9tYXNrIDogcHZfY3I0X21h
c2s7Ci0KLSAgICBpZiAoIChndWVzdF9jcjQgJiBtYXNrKSAhPSAoaHZfY3I0
ICYgbWFzaykgKQotICAgICAgICBwcmludGsoWEVOTE9HX0dfV0FSTklORwot
ICAgICAgICAgICAgICAgImQlZCBhdHRlbXB0ZWQgdG8gY2hhbmdlICVwdidz
IENSNCBmbGFncyAlMDhseCAtPiAlMDhseFxuIiwKLSAgICAgICAgICAgICAg
IGN1cnJlbnQtPmRvbWFpbi0+ZG9tYWluX2lkLCB2LCBodl9jcjQsIGd1ZXN0
X2NyNCk7Ci0KLSAgICByZXR1cm4gKGh2X2NyNCAmIG1hc2spIHwgKGd1ZXN0
X2NyNCAmIH5tYXNrKTsKLX0KLQogI2RlZmluZSB4ZW5fdmNwdV9ndWVzdF9j
b250ZXh0IHZjcHVfZ3Vlc3RfY29udGV4dAogI2RlZmluZSBmcHVfY3R4dCBm
cHVfY3R4dC54CiBDSEVDS19GSUVMRF8oc3RydWN0LCB2Y3B1X2d1ZXN0X2Nv
bnRleHQsIGZwdV9jdHh0KTsKQEAgLTc4OSw3ICs3NDYsNyBAQCBpbnQgYXJj
aF9zZXRfaW5mb19ndWVzdCgKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+
ZG9tYWluOwogICAgIHVuc2lnbmVkIGxvbmcgY3IzX2dmbjsKICAgICBzdHJ1
Y3QgcGFnZV9pbmZvICpjcjNfcGFnZTsKLSAgICB1bnNpZ25lZCBsb25nIGZs
YWdzLCBjcjQ7CisgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKICAgICB1bnNp
Z25lZCBpbnQgaTsKICAgICBpbnQgcmMgPSAwLCBjb21wYXQ7CiAKQEAgLTk3
OCw5ICs5MzUsOCBAQCBpbnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICB2
LT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1swXSAmPSBYODZfQ1IwX1RTOwogICAg
IHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzBdIHw9IHJlYWRfY3IwKCkgJiB+
WDg2X0NSMF9UUzsKIAotICAgIGNyNCA9IHYtPmFyY2gucHZfdmNwdS5jdHJs
cmVnWzRdOwotICAgIHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdID0gY3I0
ID8gcHZfZ3Vlc3RfY3I0X2ZpeHVwKHYsIGNyNCkgOgotICAgICAgICByZWFs
X2NyNF90b19wdl9ndWVzdF9jcjQobW11X2NyNF9mZWF0dXJlcyk7CisgICAg
di0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0gPQorICAgICAgICBwdl9maXh1
cF9ndWVzdF9jcjQodiwgdi0+YXJjaC5wdl92Y3B1LmN0cmxyZWdbNF0pOwog
CiAgICAgbWVtc2V0KHYtPmFyY2guZGVidWdyZWcsIDAsIHNpemVvZih2LT5h
cmNoLmRlYnVncmVnKSk7CiAgICAgZm9yICggaSA9IDA7IGkgPCA4OyBpKysg
KQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94
ODYvbW0uYwppbmRleCA2NTA5MDM1Li4wODYzNGI3IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
NTA1LDMzICs1MDUsMTMgQEAgdm9pZCBtYWtlX2NyMyhzdHJ1Y3QgdmNwdSAq
diwgbWZuX3QgbWZuKQogICAgICAgICB2LT5hcmNoLmNyMyB8PSBnZXRfcGNp
ZF9iaXRzKHYsIGZhbHNlKTsKIH0KIAotdW5zaWduZWQgbG9uZyBwdl9ndWVz
dF9jcjRfdG9fcmVhbF9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpCi17Ci0g
ICAgY29uc3Qgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKLSAgICB1
bnNpZ25lZCBsb25nIGNyNDsKLQotICAgIGNyNCA9IHYtPmFyY2gucHZfdmNw
dS5jdHJscmVnWzRdICYgflg4Nl9DUjRfREU7Ci0gICAgY3I0IHw9IG1tdV9j
cjRfZmVhdHVyZXMgJiAoWDg2X0NSNF9QU0UgfCBYODZfQ1I0X1NNRVAgfCBY
ODZfQ1I0X1NNQVAgfAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFg4Nl9DUjRfT1NYU0FWRSB8IFg4Nl9DUjRfRlNHU0JBU0UpOwotCi0gICAg
aWYgKCBkLT5hcmNoLnB2X2RvbWFpbi5wY2lkICkKLSAgICAgICAgY3I0IHw9
IFg4Nl9DUjRfUENJREU7Ci0gICAgZWxzZSBpZiAoICFkLT5hcmNoLnB2X2Rv
bWFpbi54cHRpICkKLSAgICAgICAgY3I0IHw9IFg4Nl9DUjRfUEdFOwotCi0g
ICAgY3I0IHw9IGQtPmFyY2gudnRzYyA/IFg4Nl9DUjRfVFNEIDogMDsKLQot
ICAgIHJldHVybiBjcjQ7Ci19Ci0KIHZvaWQgd3JpdGVfcHRiYXNlKHN0cnVj
dCB2Y3B1ICp2KQogewogICAgIHN0cnVjdCBjcHVfaW5mbyAqY3B1X2luZm8g
PSBnZXRfY3B1X2luZm8oKTsKICAgICB1bnNpZ25lZCBsb25nIG5ld19jcjQ7
CiAKICAgICBuZXdfY3I0ID0gKGlzX3B2X3ZjcHUodikgJiYgIWlzX2lkbGVf
dmNwdSh2KSkKLSAgICAgICAgICAgICAgPyBwdl9ndWVzdF9jcjRfdG9fcmVh
bF9jcjQodikKLSAgICAgICAgICAgICAgOiAoKHJlYWRfY3I0KCkgJiB+KFg4
Nl9DUjRfUENJREUgfCBYODZfQ1I0X1RTRCkpIHwgWDg2X0NSNF9QR0UpOwor
ICAgICAgICAgICAgICA/IHB2X21ha2VfY3I0KHYpIDogbW11X2NyNF9mZWF0
dXJlczsKIAogICAgIGlmICggaXNfcHZfdmNwdSh2KSAmJiB2LT5kb21haW4t
PmFyY2gucHZfZG9tYWluLnhwdGkgKQogICAgIHsKQEAgLTU1MCw4ICs1MzAs
NiBAQCB2b2lkIHdyaXRlX3B0YmFzZShzdHJ1Y3QgdmNwdSAqdikKICAgICAg
ICAgc3dpdGNoX2NyM19jcjQodi0+YXJjaC5jcjMsIG5ld19jcjQpOwogICAg
ICAgICBjcHVfaW5mby0+cHZfY3IzID0gMDsKICAgICB9Ci0KLSAgICBBU1NF
UlQoaXNfcHZfdmNwdSh2KSB8fCByZWFkX2NyNCgpID09IG1tdV9jcjRfZmVh
dHVyZXMpOwogfQogCiAvKgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3B2
L2RvbWFpbi5jIGIveGVuL2FyY2gveDg2L3B2L2RvbWFpbi5jCmluZGV4IGI3
NWZmNmIuLjM5NjU5NTkgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9k
b21haW4uYworKysgYi94ZW4vYXJjaC94ODYvcHYvZG9tYWluLmMKQEAgLTk3
LDYgKzk3LDUyIEBAIHN0YXRpYyB2b2lkIHJlbGVhc2VfY29tcGF0X2w0KHN0
cnVjdCB2Y3B1ICp2KQogICAgIHYtPmFyY2guZ3Vlc3RfdGFibGVfdXNlciA9
IHBhZ2V0YWJsZV9udWxsKCk7CiB9CiAKK3Vuc2lnbmVkIGxvbmcgcHZfZml4
dXBfZ3Vlc3RfY3I0KGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBs
b25nIGNyNCkKK3sKKyAgICBjb25zdCBzdHJ1Y3QgY3B1aWRfcG9saWN5ICpw
ID0gdi0+ZG9tYWluLT5hcmNoLmNwdWlkOworCisgICAgLyogRGlzY2FyZCBh
dHRlbXB0cyB0byBzZXQgZ3Vlc3QgY29udHJvbGxhYmxlIGJpdHMgb3V0c2lk
ZSBvZiB0aGUgcG9saWN5LiAqLworICAgIGNyNCAmPSB+KChwLT5iYXNpYy50
c2MgICAgID8gMCA6IFg4Nl9DUjRfVFNEKSAgICAgIHwKKyAgICAgICAgICAg
ICAocC0+YmFzaWMuZGUgICAgICA/IDAgOiBYODZfQ1I0X0RFKSAgICAgICB8
CisgICAgICAgICAgICAgKHAtPmZlYXQuZnNnc2Jhc2UgPyAwIDogWDg2X0NS
NF9GU0dTQkFTRSkgfAorICAgICAgICAgICAgIChwLT5iYXNpYy54c2F2ZSAg
ID8gMCA6IFg4Nl9DUjRfT1NYU0FWRSkpOworCisgICAgLyogTWFza3MgZXhw
ZWN0ZWQgdG8gYmUgZGlzam9pbnQgc2V0cy4gKi8KKyAgICBCVUlMRF9CVUdf
T04oUFZfQ1I0X0dVRVNUX01BU0sgJiBQVl9DUjRfR1VFU1RfVklTSUJMRV9N
QVNLKTsKKworICAgIC8qCisgICAgICogQSBndWVzdCBzZWVzIHRoZSBwb2xp
Y3kgc3Vic2V0IG9mIGl0cyBvd24gY2hvaWNlIG9mIGd1ZXN0IGNvbnRyb2xs
YWJsZQorICAgICAqIGJpdHMsIGFuZCBhIHN1YnNldCBvZiBYZW4ncyBjaG9p
Y2Ugb2YgY2VydGFpbiBoYXJkd2FyZSBzZXR0aW5ncy4KKyAgICAgKi8KKyAg
ICByZXR1cm4gKChjcjQgJiBQVl9DUjRfR1VFU1RfTUFTSykgfAorICAgICAg
ICAgICAgKG1tdV9jcjRfZmVhdHVyZXMgJiBQVl9DUjRfR1VFU1RfVklTSUJM
RV9NQVNLKSk7Cit9CisKK3Vuc2lnbmVkIGxvbmcgcHZfbWFrZV9jcjQoY29u
c3Qgc3RydWN0IHZjcHUgKnYpCit7CisgICAgY29uc3Qgc3RydWN0IGRvbWFp
biAqZCA9IHYtPmRvbWFpbjsKKyAgICB1bnNpZ25lZCBsb25nIGNyNCA9IG1t
dV9jcjRfZmVhdHVyZXMgJgorICAgICAgICB+KFg4Nl9DUjRfUENJREUgfCBY
ODZfQ1I0X1BHRSB8IFg4Nl9DUjRfVFNEKTsKKworICAgIC8qCisgICAgICog
UENJREUgb3IgUEdFIGRlcGVuZHMgb24gdGhlIFBDSUQvWFBUSSBzZXR0aW5n
cywgYnV0IG11c3Qgbm90IGJvdGggYmUKKyAgICAgKiBzZXQsIGFzIGl0IGlt
cGFjdHMgdGhlIHNhZmV0eSBvZiBUTEIgZmx1c2hpbmcuCisgICAgICovCisg
ICAgaWYgKCBkLT5hcmNoLnB2X2RvbWFpbi5wY2lkICkKKyAgICAgICAgY3I0
IHw9IFg4Nl9DUjRfUENJREU7CisgICAgZWxzZSBpZiAoICFkLT5hcmNoLnB2
X2RvbWFpbi54cHRpICkKKyAgICAgICAgY3I0IHw9IFg4Nl9DUjRfUEdFOwor
CisgICAgLyoKKyAgICAgKiBUU0QgaXMgbmVlZGVkIGlmIGVpdGhlciB0aGUg
Z3Vlc3QgaGFzIGVsZWN0ZWQgdG8gdXNlIGl0LCBvciBYZW4gaXMKKyAgICAg
KiB2aXJ0dWFsaXNpbmcgdGhlIFRTQyB2YWx1ZSB0aGUgZ3Vlc3Qgc2Vlcy4K
KyAgICAgKi8KKyAgICBpZiAoIGQtPmFyY2gudnRzYyB8fCAodi0+YXJjaC5w
dl92Y3B1LmN0cmxyZWdbNF0gJiBYODZfQ1I0X1RTRCkgKQorICAgICAgICBj
cjQgfD0gWDg2X0NSNF9UU0Q7CisKKyAgICByZXR1cm4gY3I0OworfQorCiBp
bnQgc3dpdGNoX2NvbXBhdChzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHN0
cnVjdCB2Y3B1ICp2OwpAQCAtMTkxLDcgKzIzNyw3IEBAIGludCBwdl92Y3B1
X2luaXRpYWxpc2Uoc3RydWN0IHZjcHUgKnYpCiAgICAgLyogUFYgZ3Vlc3Rz
IGJ5IGRlZmF1bHQgaGF2ZSBhIDEwMEh6IHRpY2tlci4gKi8KICAgICB2LT5w
ZXJpb2RpY19wZXJpb2QgPSBNSUxMSVNFQ1MoMTApOwogCi0gICAgdi0+YXJj
aC5wdl92Y3B1LmN0cmxyZWdbNF0gPSByZWFsX2NyNF90b19wdl9ndWVzdF9j
cjQobW11X2NyNF9mZWF0dXJlcyk7CisgICAgdi0+YXJjaC5wdl92Y3B1LmN0
cmxyZWdbNF0gPSBwdl9maXh1cF9ndWVzdF9jcjQodiwgMCk7CiAKICAgICBp
ZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSApCiAgICAgewpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L3B2L2VtdWwtcHJpdi1vcC5jIGIveGVuL2FyY2gv
eDg2L3B2L2VtdWwtcHJpdi1vcC5jCmluZGV4IGNlMmVjNzYuLjRhYmJjMTQg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYwor
KysgYi94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMKQEAgLTMyLDYg
KzMyLDcgQEAKICNpbmNsdWRlIDxhc20vaHlwZXJjYWxsLmg+CiAjaW5jbHVk
ZSA8YXNtL21jMTQ2ODE4cnRjLmg+CiAjaW5jbHVkZSA8YXNtL3AybS5oPgor
I2luY2x1ZGUgPGFzbS9wdi9kb21haW4uaD4KICNpbmNsdWRlIDxhc20vcHYv
dHJhcHMuaD4KICNpbmNsdWRlIDxhc20vc2hhcmVkLmg+CiAjaW5jbHVkZSA8
YXNtL3RyYXBzLmg+CkBAIC03ODUsOCArNzg2LDggQEAgc3RhdGljIGludCB3
cml0ZV9jcih1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBsb25nIHZhbCwK
ICAgICB9CiAKICAgICBjYXNlIDQ6IC8qIFdyaXRlIENSNCAqLwotICAgICAg
ICBjdXJyLT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9IHB2X2d1ZXN0X2Ny
NF9maXh1cChjdXJyLCB2YWwpOwotICAgICAgICB3cml0ZV9jcjQocHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KGN1cnIpKTsKKyAgICAgICAgY3Vyci0+YXJj
aC5wdl92Y3B1LmN0cmxyZWdbNF0gPSBwdl9maXh1cF9ndWVzdF9jcjQoY3Vy
ciwgdmFsKTsKKyAgICAgICAgd3JpdGVfY3I0KHB2X21ha2VfY3I0KGN1cnIp
KTsKICAgICAgICAgY3R4dF9zd2l0Y2hfbGV2ZWxsaW5nKGN1cnIpOwogICAg
ICAgICByZXR1cm4gWDg2RU1VTF9PS0FZOwogICAgIH0KZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWluLmggYi94ZW4vaW5jbHVkZS9h
c20teDg2L2RvbWFpbi5oCmluZGV4IGVjODFkNzguLmM4YWE4YTUgMTAwNjQ0
Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWluLmgKKysrIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaApAQCAtNjEwLDE3ICs2MTAsNiBA
QCBib29sIHVwZGF0ZV9zZWNvbmRhcnlfc3lzdGVtX3RpbWUoc3RydWN0IHZj
cHUgKiwKIHZvaWQgdmNwdV9zaG93X2V4ZWN1dGlvbl9zdGF0ZShzdHJ1Y3Qg
dmNwdSAqKTsKIHZvaWQgdmNwdV9zaG93X3JlZ2lzdGVycyhjb25zdCBzdHJ1
Y3QgdmNwdSAqKTsKIAotLyogQ2xlYW4gdXAgQ1I0IGJpdHMgdGhhdCBhcmUg
bm90IHVuZGVyIGd1ZXN0IGNvbnRyb2wuICovCi11bnNpZ25lZCBsb25nIHB2
X2d1ZXN0X2NyNF9maXh1cChjb25zdCBzdHJ1Y3QgdmNwdSAqLCB1bnNpZ25l
ZCBsb25nIGd1ZXN0X2NyNCk7Ci0KLS8qIENvbnZlcnQgYmV0d2VlbiBndWVz
dC12aXNpYmxlIGFuZCByZWFsIENSNCB2YWx1ZXMuICovCi11bnNpZ25lZCBs
b25nIHB2X2d1ZXN0X2NyNF90b19yZWFsX2NyNChjb25zdCBzdHJ1Y3QgdmNw
dSAqdik7Ci0KLSNkZWZpbmUgcmVhbF9jcjRfdG9fcHZfZ3Vlc3RfY3I0KGMp
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAoKGMpICYgfihYODZf
Q1I0X1BHRSB8IFg4Nl9DUjRfUFNFIHwgWDg2X0NSNF9UU0QgfCAgICAgIFwK
LSAgICAgICAgICAgICBYODZfQ1I0X09TWFNBVkUgfCBYODZfQ1I0X1NNRVAg
fCAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAgICBYODZfQ1I0X0ZTR1NC
QVNFIHwgWDg2X0NSNF9TTUFQIHwgWDg2X0NSNF9QQ0lERSkpCi0KICNkZWZp
bmUgZG9tYWluX21heF92Y3B1cyhkKSAoaXNfaHZtX2RvbWFpbihkKSA/IEhW
TV9NQVhfVkNQVVMgOiBNQVhfVklSVF9DUFVTKQogCiBzdGF0aWMgaW5saW5l
IHN0cnVjdCB2Y3B1X2d1ZXN0X2NvbnRleHQgKmFsbG9jX3ZjcHVfZ3Vlc3Rf
Y29udGV4dCh2b2lkKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9wdi9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcHYvZG9tYWlu
LmgKaW5kZXggNGZlYTc2NC4uNGU0NzEwYyAxMDA2NDQKLS0tIGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9wdi9kb21haW4uaAorKysgYi94ZW4vaW5jbHVkZS9h
c20teDg2L3B2L2RvbWFpbi5oCkBAIC01OSw2ICs1OSwyMyBAQCBpbnQgcHZf
dmNwdV9pbml0aWFsaXNlKHN0cnVjdCB2Y3B1ICp2KTsKIHZvaWQgcHZfZG9t
YWluX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCk7CiBpbnQgcHZfZG9tYWlu
X2luaXRpYWxpc2Uoc3RydWN0IGRvbWFpbiAqZCk7CiAKKy8qCisgKiBCaXRz
IHdoaWNoIGEgUFYgZ3Vlc3QgY2FuIHRvZ2dsZSBpbiBpdHMgdmlldyBvZiBj
cjQuICBTb21lIGFyZSBsb2FkZWQgaW50bworICogaGFyZHdhcmUsIHdoaWxl
IHNvbWUgYXJlIGZ1bGx5IGVtdWxhdGVkLgorICovCisjZGVmaW5lIFBWX0NS
NF9HVUVTVF9NQVNLIFwKKyAgICAoWDg2X0NSNF9UU0QgfCBYODZfQ1I0X0RF
IHwgWDg2X0NSNF9GU0dTQkFTRSB8IFg4Nl9DUjRfT1NYU0FWRSkKKworLyog
Qml0cyB3aGljaCBhIFBWIGd1ZXN0IG1heSBvYnNlcnZlIGZyb20gdGhlIHJl
YWwgaGFyZHdhcmUgc2V0dGluZ3MuICovCisjZGVmaW5lIFBWX0NSNF9HVUVT
VF9WSVNJQkxFX01BU0sgXAorICAgIChYODZfQ1I0X1BBRSB8IFg4Nl9DUjRf
TUNFIHwgWDg2X0NSNF9PU0ZYU1IgfCBYODZfQ1I0X09TWE1NRVhDUFQpCisK
Ky8qIEdpdmVuIGEgbmV3IGNyNCB2YWx1ZSwgY29uc3RydWN0IHRoZSByZXN1
bHRpbmcgZ3Vlc3QtdmlzaWJsZSBjcjQgdmFsdWUuICovCit1bnNpZ25lZCBs
b25nIHB2X2ZpeHVwX2d1ZXN0X2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdiwg
dW5zaWduZWQgbG9uZyBjcjQpOworCisvKiBDcmVhdGUgYSBjcjQgdmFsdWUg
dG8gbG9hZCBpbnRvIGhhcmR3YXJlLCBiYXNlZCBvbiB2Y3B1IHNldHRpbmdz
LiAqLwordW5zaWduZWQgbG9uZyBwdl9tYWtlX2NyNChjb25zdCBzdHJ1Y3Qg
dmNwdSAqdik7CisKICNlbHNlICAvKiAhQ09ORklHX1BWICovCiAKICNpbmNs
dWRlIDx4ZW4vZXJybm8uaD4KQEAgLTY4LDYgKzg1LDggQEAgc3RhdGljIGlu
bGluZSBpbnQgcHZfdmNwdV9pbml0aWFsaXNlKHN0cnVjdCB2Y3B1ICp2KSB7
IHJldHVybiAtRU9QTk9UU1VQUDsgfQogc3RhdGljIGlubGluZSB2b2lkIHB2
X2RvbWFpbl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQpIHt9CiBzdGF0aWMg
aW5saW5lIGludCBwdl9kb21haW5faW5pdGlhbGlzZShzdHJ1Y3QgZG9tYWlu
ICpkKSB7IHJldHVybiAtRU9QTk9UU1VQUDsgfQogCitzdGF0aWMgaW5saW5l
IHVuc2lnbmVkIGxvbmcgcHZfbWFrZV9jcjQoY29uc3Qgc3RydWN0IHZjcHUg
KnYpIHsgcmV0dXJuIH4wdWw7IH0KKwogI2VuZGlmCS8qIENPTkZJR19QViAq
LwogCiB2b2lkIHBhcmF2aXJ0X2N0eHRfc3dpdGNoX2Zyb20oc3RydWN0IHZj
cHUgKnYpOwo=

--=separator
Content-Type: application/octet-stream; name="xsa293/4.11-2.patch"
Content-Disposition: attachment; filename="xsa293/4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBEb24ndCBoYXZlICVjcjQuZnNnc2Jhc2Ug
YWN0aXZlIGJlaGluZCBhIGd1ZXN0IGtlcm5lbHMgYmFjawoKQ3VycmVudGx5
LCBhIDY0Yml0IFBWIGd1ZXN0IGNhbiBhcHBlYXIgdG8gc2V0IGFuZCBjbGVh
ciBGU0dTQkFTRSBpbiAlY3I0LCBidXQKdGhlIGJpdCByZW1haW5zIHNldCBp
biBoYXJkd2FyZS4gIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17RlMsR1N9QkFT
RSBhcmUgdXNhYmxlCmV2ZW4gd2hlbiB0aGUgZ3Vlc3Qga2VybmVsIGJlbGll
dmVzIHRoYXQgdGhleSBhcmUgZGlzYWJsZWQuCgpUaGUgRlNHU0JBU0UgZmVh
dHVyZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIExpbnV4LCBhbmQg
aXRzIGNvbnRleHQKc3dpdGNoIHBhdGggaGFzIHNvbWUgb3B0aW1pc2F0aW9u
cyB3aGljaCByZWx5IG9uIHVzZXJzcGFjZSBiZWluZyB1bmFibGUgdG8gdXNl
CnRoZSBXUntGUyxHU31CQVNFIGluc3RydWN0aW9ucy4gIFhlbidzIGN1cnJl
bnQgYmVoYXZpb3VyIHVuZGVybWluZXMgdGhpcwpleHBlY3RhdGlvbi4KCklu
IDY0Yml0IFBWIGd1ZXN0IGNvbnRleHQsIGFsd2F5cyBsb2FkIHRoZSBndWVz
dCBrZXJuZWxzIHNldHRpbmcgb2YgRlNHU0JBU0UKaW50byAlY3I0LiAgVGhp
cyByZXF1aXJlcyBhZGp1c3RpbmcgaG93IFhlbiB1c2VzIHRoZSB7UkQsV1J9
e0ZTLEdTfUJBU0UKaW5zdHJ1Y3Rpb25zLgoKICogRGVsZXRlIHRoZSBjcHVf
aGFzX2ZzZ3NiYXNlIGhlbHBlci4gIEl0IGlzIG5vIGxvbmdlciBzYWZlLCBh
cyB1c2VycyBuZWVkIHRvCiAgIGNoZWNrICVjcjQgZGlyZWN0bHkuCiAqIFRo
ZSByYXcgX19yZHtmcyxnc31iYXNlKCkgaGVscGVycyBhcmUgb25seSBzYWZl
IHRvIHVzZSB3aGVuICVjcjQuZnNnc2Jhc2UKICAgaXMgc2V0LiAgQ29tbWVu
dCB0aGlzIHByb3BlcnR5LgogKiBUaGUge3JkLHdyfXtmcyxnc317YmFzZSxz
aGFkb3d9KCkgYW5kIHJlYWRfbXNyKCkgaGVscGVycyBhcmUgdXBkYXRlZCB0
byB1c2UKICAgdGhlIGN1cnJlbnQgJWNyNCB2YWx1ZSB0byBkZXRlcm1pbmUg
d2hpY2ggbWVjaGFuaXNtIHRvIHVzZS4KICogdG9nZ2xlX2d1ZXN0X21vZGUo
KSBhbmQgc2F2ZV9zZWdtZW50cygpIGFyZSB1cGRhdGUgdG8gYXZvaWQgcmVh
ZGluZwogICBmcy9nc2Jhc2UgaWYgdGhlIHZhbHVlcyBpbiBoYXJkd2FyZSBj
YW5ub3QgYmUgc3RhbGUgV1JUIHN0cnVjdCB2Y3B1LiAgQQogICBjb25zZXF1
ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHdyaXRlX2NyKCkgcGF0aCBuZWVk
cyB0byBjYWNoZSB0aGUgY3VycmVudAogICBiYXNlcywgYXMgc3Vic2VxdWVu
dCBjb250ZXh0IHN3aXRjaGVzIHdpbGwgc2tpcCBzYXZpbmcgdGhlIHZhbHVl
cy4KICogd3JpdGVfY3I0KCkgaXMgdXBkYXRlZCB0byBlbnN1cmUgdGhhdCB0
aGUgc2hhZG93ICVjcjQuZnNnc2Jhc2UgdmFsdWUgaXMKICAgb2JzZXJ2ZWQg
aW4gYSBzYWZlIHdheSBXUlQgdGhlIGhhcmR3YXJlIHNldHRpbmcsIGlmIGFu
IGludGVycnVwdCBoYXBwZW5zIHRvCiAgIGhpdCBpbiB0aGUgbWlkZGxlLgog
KiBwdl9tYWtlX2NyNCgpIGlzIHVwZGF0ZWQgZm9yIDY0Yml0IFBWIGd1ZXN0
cyB0byB1c2UgdGhlIGd1ZXN0IGtlcm5lbHMKICAgY2hvaWNlIG9mIEZTR1NC
QVNFLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTMKClJlcG9ydGVkLWJ5OiBB
bmR5IEx1dG9taXJza2kgPGx1dG9Aa2VybmVsLm9yZz4KU2lnbmVkLW9mZi1i
eTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4K
UmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4K
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJj
aC94ODYvZG9tYWluLmMKaW5kZXggNjc1MTUyYS4uMjlmODkyYyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9kb21haW4uYwpAQCAtMTQzMyw3ICsxNDMzLDggQEAgc3RhdGljIHZvaWQg
c2F2ZV9zZWdtZW50cyhzdHJ1Y3QgdmNwdSAqdikKICAgICByZWdzLT5mcyA9
IHJlYWRfc3JlZyhmcyk7CiAgICAgcmVncy0+Z3MgPSByZWFkX3NyZWcoZ3Mp
OwogCi0gICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICYmICFpc19wdl8zMmJp
dF92Y3B1KHYpICkKKyAgICAvKiAlZnMvJWdzIGJhc2VzIGNhbiBvbmx5IGJl
IHN0YWxlIGlmIFdSe0ZTLEdTfUJBU0UgYXJlIHVzYWJsZS4gKi8KKyAgICBp
ZiAoIChyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSkgJiYgIWlzX3B2
XzMyYml0X3ZjcHUodikgKQogICAgIHsKICAgICAgICAgdi0+YXJjaC5wdl92
Y3B1LmZzX2Jhc2UgPSBfX3JkZnNiYXNlKCk7CiAgICAgICAgIGlmICggdi0+
YXJjaC5mbGFncyAmIFRGX2tlcm5lbF9tb2RlICkKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni9wdi9kb21haW4uYyBiL3hlbi9hcmNoL3g4Ni9wdi9kb21h
aW4uYwppbmRleCAzOTY1OTU5Li4yMjhhMTc0IDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvcHYvZG9tYWluLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2Rv
bWFpbi5jCkBAIC0xNDAsNiArMTQwLDE2IEBAIHVuc2lnbmVkIGxvbmcgcHZf
bWFrZV9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiAgICAgaWYgKCBkLT5h
cmNoLnZ0c2MgfHwgKHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdICYgWDg2
X0NSNF9UU0QpICkKICAgICAgICAgY3I0IHw9IFg4Nl9DUjRfVFNEOwogCisg
ICAgLyoKKyAgICAgKiBUaGUge1JELFdSfXtGUyxHU31CQVNFIGFyZSBvbmx5
IHVzZWFibGUgaW4gNjRiaXQgY29kZSBzZWdtZW50cy4gIFdoaWxlCisgICAg
ICogd2UgbXVzdCBub3QgaGF2ZSBDUjQuRlNHU0JBU0Ugc2V0IGJlaGluZCB0
aGUgYmFjayBvZiBhIDY0Yml0IFBWIGtlcm5lbCwKKyAgICAgKiB3ZSBkbyBs
ZWF2ZSBpdCBzZXQgaW4gMzJiaXQgUFYgY29udGV4dCB0byBzcGVlZCB1cCBY
ZW4ncyBjb250ZXh0IHN3aXRjaAorICAgICAqIHBhdGguCisgICAgICovCisg
ICAgaWYgKCAhaXNfcHZfMzJiaXRfZG9tYWluKGQpICYmCisgICAgICAgICAh
KHYtPmFyY2gucHZfdmNwdS5jdHJscmVnWzRdICYgWDg2X0NSNF9GU0dTQkFT
RSkgKQorICAgICAgICBjcjQgJj0gflg4Nl9DUjRfRlNHU0JBU0U7CisKICAg
ICByZXR1cm4gY3I0OwogfQogCkBAIC0zNzUsNyArMzg1LDggQEAgdm9pZCB0
b2dnbGVfZ3Vlc3RfbW9kZShzdHJ1Y3QgdmNwdSAqdikKIHsKICAgICBBU1NF
UlQoIWlzX3B2XzMyYml0X3ZjcHUodikpOwogCi0gICAgaWYgKCBjcHVfaGFz
X2ZzZ3NiYXNlICkKKyAgICAvKiAlZnMvJWdzIGJhc2VzIGNhbiBvbmx5IGJl
IHN0YWxlIGlmIFdSe0ZTLEdTfUJBU0UgYXJlIHVzYWJsZS4gKi8KKyAgICBp
ZiAoIHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNFICkKICAgICB7CiAg
ICAgICAgIGlmICggdi0+YXJjaC5mbGFncyAmIFRGX2tlcm5lbF9tb2RlICkK
ICAgICAgICAgICAgIHYtPmFyY2gucHZfdmNwdS5nc19iYXNlX2tlcm5lbCA9
IF9fcmRnc2Jhc2UoKTsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9wdi9l
bXVsLXByaXYtb3AuYyBiL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3Au
YwppbmRleCA0YWJiYzE0Li4zMTJjMWVlIDEwMDY0NAotLS0gYS94ZW4vYXJj
aC94ODYvcHYvZW11bC1wcml2LW9wLmMKKysrIGIveGVuL2FyY2gveDg2L3B2
L2VtdWwtcHJpdi1vcC5jCkBAIC03ODYsNiArNzg2LDE3IEBAIHN0YXRpYyBp
bnQgd3JpdGVfY3IodW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQgbG9uZyB2
YWwsCiAgICAgfQogCiAgICAgY2FzZSA0OiAvKiBXcml0ZSBDUjQgKi8KKyAg
ICAgICAgLyoKKyAgICAgICAgICogSWYgdGhpcyB3cml0ZSB3aWxsIGRpc2Fi
bGUgRlNHU0JBU0UsIHJlZnJlc2ggWGVuJ3MgaWRlYSBvZiB0aGUKKyAgICAg
ICAgICogZ3Vlc3QgYmFzZXMgbm93IHRoYXQgdGhleSBjYW4gbm8gbG9uZ2Vy
IGNoYW5nZS4KKyAgICAgICAgICovCisgICAgICAgIGlmICggKGN1cnItPmFy
Y2gucHZfdmNwdS5jdHJscmVnWzRdICYgWDg2X0NSNF9GU0dTQkFTRSkgJiYK
KyAgICAgICAgICAgICAhKHZhbCAmIFg4Nl9DUjRfRlNHU0JBU0UpICkKKyAg
ICAgICAgeworICAgICAgICAgICAgY3Vyci0+YXJjaC5wdl92Y3B1LmZzX2Jh
c2UgPSBfX3JkZnNiYXNlKCk7CisgICAgICAgICAgICBjdXJyLT5hcmNoLnB2
X3ZjcHUuZ3NfYmFzZV9rZXJuZWwgPSBfX3JkZ3NiYXNlKCk7CisgICAgICAg
IH0KKwogICAgICAgICBjdXJyLT5hcmNoLnB2X3ZjcHUuY3RybHJlZ1s0XSA9
IHB2X2ZpeHVwX2d1ZXN0X2NyNChjdXJyLCB2YWwpOwogICAgICAgICB3cml0
ZV9jcjQocHZfbWFrZV9jcjQoY3VycikpOwogICAgICAgICBjdHh0X3N3aXRj
aF9sZXZlbGxpbmcoY3Vycik7CkBAIC04MzUsMTQgKzg0NiwxNSBAQCBzdGF0
aWMgaW50IHJlYWRfbXNyKHVuc2lnbmVkIGludCByZWcsIHVpbnQ2NF90ICp2
YWwsCiAgICAgY2FzZSBNU1JfRlNfQkFTRToKICAgICAgICAgaWYgKCBpc19w
dl8zMmJpdF9kb21haW4oY3VycmQpICkKICAgICAgICAgICAgIGJyZWFrOwot
ICAgICAgICAqdmFsID0gY3B1X2hhc19mc2dzYmFzZSA/IF9fcmRmc2Jhc2Uo
KSA6IGN1cnItPmFyY2gucHZfdmNwdS5mc19iYXNlOworICAgICAgICAqdmFs
ID0gKHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNFKSA/IF9fcmRmc2Jh
c2UoKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA6IGN1cnItPmFyY2gucHZfdmNwdS5mc19iYXNlOwogICAgICAg
ICByZXR1cm4gWDg2RU1VTF9PS0FZOwogCiAgICAgY2FzZSBNU1JfR1NfQkFT
RToKICAgICAgICAgaWYgKCBpc19wdl8zMmJpdF9kb21haW4oY3VycmQpICkK
ICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICAqdmFsID0gY3B1X2hhc19m
c2dzYmFzZSA/IF9fcmRnc2Jhc2UoKQotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICA6IGN1cnItPmFyY2gucHZfdmNwdS5nc19iYXNlX2tlcm5l
bDsKKyAgICAgICAgKnZhbCA9IChyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dT
QkFTRSkgPyBfX3JkZ3NiYXNlKCkKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgOiBjdXJyLT5hcmNoLnB2X3ZjcHUu
Z3NfYmFzZV9rZXJuZWw7CiAgICAgICAgIHJldHVybiBYODZFTVVMX09LQVk7
CiAKICAgICBjYXNlIE1TUl9TSEFET1dfR1NfQkFTRToKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL3g4Ni9zZXR1cC5jIGIveGVuL2FyY2gveDg2L3NldHVwLmMK
aW5kZXggZWNiMDE0OS4uYTM1M2Q3NiAxMDA2NDQKLS0tIGEveGVuL2FyY2gv
eDg2L3NldHVwLmMKKysrIGIveGVuL2FyY2gveDg2L3NldHVwLmMKQEAgLTE1
NjcsNyArMTU2Nyw3IEBAIHZvaWQgX19pbml0IG5vcmV0dXJuIF9fc3RhcnRf
eGVuKHVuc2lnbmVkIGxvbmcgbWJpX3ApCiAKICAgICBjcjRfcHYzMl9tYXNr
ID0gbW11X2NyNF9mZWF0dXJlcyAmIFhFTl9DUjRfUFYzMl9CSVRTOwogCi0g
ICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICkKKyAgICBpZiAoIGJvb3RfY3B1
X2hhcyhYODZfRkVBVFVSRV9GU0dTQkFTRSkgKQogICAgICAgICBzZXRfaW5f
Y3I0KFg4Nl9DUjRfRlNHU0JBU0UpOwogCiAgICAgaWYgKCBvcHRfaW52cGNp
ZCAmJiBjcHVfaGFzX2ludnBjaWQgKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1
ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmggYi94ZW4vaW5jbHVkZS9hc20teDg2
L2NwdWZlYXR1cmUuaAppbmRleCBiMjM3ZGExLi44NjFjYjBhIDEwMDY0NAot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaAorKysgYi94
ZW4vaW5jbHVkZS9hc20teDg2L2NwdWZlYXR1cmUuaApAQCAtOTAsNyArOTAs
NiBAQAogI2RlZmluZSBjcHVfaGFzX3hzYXZlcyAgICAgICAgICBib290X2Nw
dV9oYXMoWDg2X0ZFQVRVUkVfWFNBVkVTKQogCiAvKiBDUFVJRCBsZXZlbCAw
eDAwMDAwMDA3OjAuZWJ4ICovCi0jZGVmaW5lIGNwdV9oYXNfZnNnc2Jhc2Ug
ICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9GU0dTQkFTRSkKICNk
ZWZpbmUgY3B1X2hhc19ibWkxICAgICAgICAgICAgYm9vdF9jcHVfaGFzKFg4
Nl9GRUFUVVJFX0JNSTEpCiAjZGVmaW5lIGNwdV9oYXNfaGxlICAgICAgICAg
ICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9ITEUpCiAjZGVmaW5lIGNw
dV9oYXNfYXZ4MiAgICAgICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVS
RV9BVlgyKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3Iu
aCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLmgKaW5kZXggYWZiZWI3Zi4u
MWJhNmVlMyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3Iu
aAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21zci5oCkBAIC0xMjAsNiAr
MTIwLDE0IEBAIHN0YXRpYyBpbmxpbmUgdWludDY0X3QgcmR0c2Nfb3JkZXJl
ZCh2b2lkKQogCQkJICA6ICI9YSIgKGxvdyksICI9ZCIgKGhpZ2gpIFwKIAkJ
CSAgOiAiYyIgKGNvdW50ZXIpKQogCisvKgorICogT24gaGFyZHdhcmUgc3Vw
cG9ydGluZyBGU0dTQkFTRSwgdGhlIHZhbHVlIGxvYWRlZCBpbnRvIGhhcmR3
YXJlIGlzIHRoZQorICogZ3Vlc3Qga2VybmVsJ3MgY2hvaWNlIGZvciA2NGJp
dCBQViBndWVzdHMgKFhlbidzIGNob2ljZSBmb3IgSWRsZSwgSFZNIGFuZAor
ICogMzJiaXQgUFYpLgorICoKKyAqIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17
RlMsR1N9QkFTRSBpbnN0cnVjdGlvbnMgYXJlIG9ubHkgc2FmZSB0byB1c2Ug
aWYKKyAqICVjcjQuZnNnc2Jhc2UgaXMgc2V0LgorICovCiBzdGF0aWMgaW5s
aW5lIHVuc2lnbmVkIGxvbmcgX19yZGZzYmFzZSh2b2lkKQogewogICAgIHVu
c2lnbmVkIGxvbmcgYmFzZTsKQEAgLTE1MCw3ICsxNTgsNyBAQCBzdGF0aWMg
aW5saW5lIHVuc2lnbmVkIGxvbmcgcmRmc2Jhc2Uodm9pZCkKIHsKICAgICB1
bnNpZ25lZCBsb25nIGJhc2U7CiAKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jh
c2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Ug
KQogICAgICAgICByZXR1cm4gX19yZGZzYmFzZSgpOwogCiAgICAgcmRtc3Js
KE1TUl9GU19CQVNFLCBiYXNlKTsKQEAgLTE2Miw3ICsxNzAsNyBAQCBzdGF0
aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRnc2Jhc2Uodm9pZCkKIHsKICAg
ICB1bnNpZ25lZCBsb25nIGJhc2U7CiAKLSAgICBpZiAoIGNwdV9oYXNfZnNn
c2Jhc2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JB
U0UgKQogICAgICAgICByZXR1cm4gX19yZGdzYmFzZSgpOwogCiAgICAgcmRt
c3JsKE1TUl9HU19CQVNFLCBiYXNlKTsKQEAgLTE3NCw3ICsxODIsNyBAQCBz
dGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmRnc3NoYWRvdyh2b2lkKQog
ewogICAgIHVuc2lnbmVkIGxvbmcgYmFzZTsKIAotICAgIGlmICggY3B1X2hh
c19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NSNF9G
U0dTQkFTRSApCiAgICAgewogICAgICAgICBhc20gdm9sYXRpbGUgKCAic3dh
cGdzIiApOwogICAgICAgICBiYXNlID0gX19yZGdzYmFzZSgpOwpAQCAtMTg4
LDcgKzE5Niw3IEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyByZGdz
c2hhZG93KHZvaWQpCiAKIHN0YXRpYyBpbmxpbmUgdm9pZCB3cmZzYmFzZSh1
bnNpZ25lZCBsb25nIGJhc2UpCiB7Ci0gICAgaWYgKCBjcHVfaGFzX2ZzZ3Ni
YXNlICkKKyAgICBpZiAoIHJlYWRfY3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNF
ICkKICNpZmRlZiBIQVZFX0FTX0ZTR1NCQVNFCiAgICAgICAgIGFzbSB2b2xh
dGlsZSAoICJ3cmZzYmFzZSAlMCIgOjogInIiIChiYXNlKSApOwogI2Vsc2UK
QEAgLTIwMCw3ICsyMDgsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgd3Jmc2Jh
c2UodW5zaWduZWQgbG9uZyBiYXNlKQogCiBzdGF0aWMgaW5saW5lIHZvaWQg
d3Jnc2Jhc2UodW5zaWduZWQgbG9uZyBiYXNlKQogewotICAgIGlmICggY3B1
X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NS
NF9GU0dTQkFTRSApCiAjaWZkZWYgSEFWRV9BU19GU0dTQkFTRQogICAgICAg
ICBhc20gdm9sYXRpbGUgKCAid3Jnc2Jhc2UgJTAiIDo6ICJyIiAoYmFzZSkg
KTsKICNlbHNlCkBAIC0yMTIsNyArMjIwLDcgQEAgc3RhdGljIGlubGluZSB2
b2lkIHdyZ3NiYXNlKHVuc2lnbmVkIGxvbmcgYmFzZSkKIAogc3RhdGljIGlu
bGluZSB2b2lkIHdyZ3NzaGFkb3codW5zaWduZWQgbG9uZyBiYXNlKQogewot
ICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2Ny
NCgpICYgWDg2X0NSNF9GU0dTQkFTRSApCiAgICAgewogICAgICAgICBhc20g
dm9sYXRpbGUgKCAic3dhcGdzXG5cdCIKICNpZmRlZiBIQVZFX0FTX0ZTR1NC
QVNFCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nlc3Nv
ci5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaAppbmRleCAy
YmQ5ZTY5Li44ZTI1M2RjIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20t
eDg2L3Byb2Nlc3Nvci5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcHJv
Y2Vzc29yLmgKQEAgLTMwNSwxMSArMzA1LDMxIEBAIHN0YXRpYyBpbmxpbmUg
dW5zaWduZWQgbG9uZyByZWFkX2NyNCh2b2lkKQogCiBzdGF0aWMgaW5saW5l
IHZvaWQgd3JpdGVfY3I0KHVuc2lnbmVkIGxvbmcgdmFsKQogeworICAgIHN0
cnVjdCBjcHVfaW5mbyAqaW5mbyA9IGdldF9jcHVfaW5mbygpOworCiAgICAg
LyogTm8gZ2xvYmFsIHBhZ2VzIGluIGNhc2Ugb2YgUENJRHMgZW5hYmxlZCEg
Ki8KICAgICBBU1NFUlQoISh2YWwgJiBYODZfQ1I0X1BHRSkgfHwgISh2YWwg
JiBYODZfQ1I0X1BDSURFKSk7CiAKLSAgICBnZXRfY3B1X2luZm8oKS0+Y3I0
ID0gdmFsOwotICAgIGFzbSB2b2xhdGlsZSAoICJtb3YgJTAsJSVjcjQiIDog
OiAiciIgKHZhbCkgKTsKKyAgICAvKgorICAgICAqIE9uIGhhcmR3YXJlIHN1
cHBvcnRpbmcgRlNHU0JBU0UsIHRoZSB2YWx1ZSBpbiAlY3I0IGlzIHRoZSBr
ZXJuZWwncworICAgICAqIGNob2ljZSBmb3IgNjRiaXQgUFYgZ3Vlc3RzLCB3
aGljaCBpbXBhY3RzIHdoZXRoZXIgWGVuIGNhbiB1c2UgdGhlCisgICAgICog
aW5zdHJ1Y3Rpb25zLgorICAgICAqCisgICAgICogVGhlIHtyZCx3cn17ZnMs
Z3N9YmFzZSgpIGhlbHBlcnMgdXNlIGluZm8tPmNyNCB0byB3b3JrIG91dCB3
aGV0aGVyIGl0CisgICAgICogaXMgc2FmZSB0byBleGVjdXRlIHRoZSB7UkQs
V1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb24sIGZhbGxpbmcgYmFjayB0bwor
ICAgICAqIHRoZSBNU1IgcGF0aCBpZiBub3QuICBTb21lIHVzZXJzIHJlcXVp
cmUgaW50ZXJydXB0IHNhZmV0eS4KKyAgICAgKgorICAgICAqIElmIEZTR1NC
QVNFIGlzIGN1cnJlbnRseSBvciBhYm91dCB0byBiZWNvbWUgY2xlYXIsIHJl
ZmxlY3QgdGhpcyBpbgorICAgICAqIGluZm8tPmNyNCBiZWZvcmUgdXBkYXRp
bmcgJWNyNCwgc28gYW4gaW50ZXJydXB0IHdoaWNoIGhpdHMgaW4gdGhlCisg
ICAgICogbWlkZGxlIHdvbid0IG9ic2VydmUgRlNHU0JBU0Ugc2V0IGluIGlu
Zm8tPmNyNCBidXQgY2xlYXIgaW4gJWNyNC4KKyAgICAgKi8KKyAgICBpbmZv
LT5jcjQgPSB2YWwgJiAoaW5mby0+Y3I0IHwgflg4Nl9DUjRfRlNHU0JBU0Up
OworCisgICAgYXNtIHZvbGF0aWxlICggIm1vdiAlW3ZhbF0sICUlY3I0Igor
ICAgICAgICAgICAgICAgICAgIDogIittIiAoaW5mby0+Y3I0KSAvKiBGb3Jj
ZSBvcmRlcmluZyB3aXRob3V0IGEgYmFycmllci4gKi8KKyAgICAgICAgICAg
ICAgICAgICA6IFt2YWxdICJyIiAodmFsKSApOworCisgICAgaW5mby0+Y3I0
ID0gdmFsOwogfQogCiAvKiBDbGVhciBhbmQgc2V0ICdUUycgYml0IHJlc3Bl
Y3RpdmVseSAqLwo=

--=separator
Content-Type: application/octet-stream; name="xsa293/unstable-1.patch"
Content-Disposition: attachment; filename="xsa293/unstable-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBSZXdyaXRlIGd1ZXN0ICVjcjQgaGFuZGxp
bmcgZnJvbSBzY3JhdGNoCgpUaGUgUFYgY3I0IGxvZ2ljIGlzIGFsbW9zdCBp
bXBvc3NpYmxlIHRvIGZvbGxvdywgYW5kIGxlYWtzIGJpdHMgaW50byBndWVz
dApjb250ZXh0IHdoaWNoIGRlZmluaXRlbHkgc2hvdWxkbid0IGJlIHZpc2li
bGUgKGluIHBhcnRpY3VsYXIsIFZNWEUpLgoKVGhlIGJpZ2dlc3QgcHJvYmxl
bSBob3dldmVyLCBhbmQgc291cmNlIG9mIHRoZSBjb21wbGV4aXR5LCBpcyB0
aGF0IGl0IGRlcml2ZXMKbmV3IHJlYWwgYW5kIGd1ZXN0IGNyNCB2YWx1ZXMg
ZnJvbSB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZSAtIHRoaXMgaXMK
Y29udGV4dCBkZXBlbmRlbnQgYW5kIGFuIGluYXBwcm9wcmlhdGUgc291cmNl
IG9mIGluZm9ybWF0aW9uLgoKUmV3cml0ZSB0aGUgY3I0IGxvZ2ljIHRvIGJl
IGludmFyaWFudCBvZiB0aGUgY3VycmVudCB2YWx1ZSBpbiBoYXJkd2FyZS4K
CkZpcnN0IG9mIGFsbCwgbW9kaWZ5IHdyaXRlX3B0YmFzZSgpIHRvIGFsd2F5
cyB1c2UgbW11X2NyNF9mZWF0dXJlcyBmb3IgSURMRQphbmQgSFZNIGNvbnRl
eHRzLiAgbW11X2NyNF9mZWF0dXJlcyAqaXMqIHRoZSBjb3JyZWN0IHZhbHVl
IHRvIHVzZSwgYW5kIG1ha2VzCnRoZSBBU1NFUlQoKSBvYnZpb3VzbHkgcmVk
dW5kYW50LgoKRm9yIFBWIGd1ZXN0cywgY3Vyci0+YXJjaC5wdi5jdHJscmVn
WzRdIHJlbWFpbnMgdGhlIGd1ZXN0cyB2aWV3IG9mIGNyNCwgYnV0CmFsbCBs
b2dpYyBnZXRzIHJld29ya2VkIGluIHRlcm1zIG9mIHRoaXMgYW5kIG1tdV9j
cjRfZmVhdHVyZXMgb25seS4KClR3byBtYXNrcyBhcmUgaW50cm9kdWNlZDsg
Yml0cyB3aGljaCB0aGUgZ3Vlc3QgaGFzIGNvbnRyb2wgb3ZlciwgYW5kIGJp
dHMKd2hpY2ggYXJlIGZvcndhcmRlZCBmcm9tIFhlbidzIHNldHRpbmdzLiAg
T25lIGd1ZXN0LXZpc2libGUgY2hhbmdlIGhlcmUgaXMKdGhhdCBYZW4ncyBW
TVhFIHNldHRpbmcgaXMgbm8gbG9uZ2VyIHZpc2libGUgYXQgYWxsLgoKcHZf
bWFrZV9jcjQoKSBmb2xsb3dzIGZhaXJseSBjbG9zZWx5IGZyb20gcHZfZ3Vl
c3RfY3I0X3RvX3JlYWxfY3I0KCksIGJ1dApkZWxpYmVyYXRlbHkgc3RhcnRz
IHdpdGggbW11X2NyNF9mZWF0dXJlcywgYW5kIG9ubHkgYWx0ZXJzIHRoZSBt
aW5pbWFsIHN1YnNldApvZiBiaXRzLgoKVGhlIGJvb3QtdGltZSB7Y29tcGF0
Xyx9cHZfY3I0X21hc2sgdmFyaWFibGVzIGFyZSByZW1vdmVkLCBhcyB0aGV5
IGFyZSBhCnJlbW5hbnQgb2YgdGhlIHByZS1DUFVJRCBwb2xpY3kgZGF5cy4g
IHB2X2ZpeHVwX2d1ZXN0X2NyNCgpIGdhaW5zIGEgcmVsYXRlZApkZXJpdmF0
aW9uIGZyb20gdGhlIHBvbGljeS4KCkFub3RoZXIgZ3Vlc3QgdmlzaWJsZSBj
aGFuZ2UgaGVyZSBpcyB0aGF0IGEgMzJiaXQgUFYgZ3Vlc3QgY2FuIG5vdyBm
bGlwCkZTR1NCQVNFIGluIGl0cyB2aWV3IG9mIENSNC4gIFdoaWxlIHRoZSB7
UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25zIGFyZQp1bnVzYWJsZSBv
dXRzaWRlIG9mIGEgNjRiaXQgY29kZSBzZWdtZW50LCB0aGUgYWJpbGl0eSB0
byBtb2RpZnkgRlNHU0JBU0UKbWF0Y2hlcyByZWFsIGhhcmR3YXJlIGJlaGF2
aW91ciwgYW5kIGF2b2lkcyB0aGUgbmVlZCBmb3IgYW55IDMyYml0LzY0Yml0
CmRpZmZlcmVuY2VzIGluIHRoZSBsb2dpYy4KCk92ZXJhbGwsIHRoaXMgcGF0
Y2ggc2hvdWxkbid0IGhhdmUgYSBwcmFjdGljYWwgY2hhbmdlIGluIGd1ZXN0
IGJlaGF2aW91ci4KVk1YRSB3aWxsIGRpc2FwcGVhciBmcm9tIHZpZXcsIGFu
ZCBhbiBpbnF1aXNpdGl2ZSAzMmJpdCBrZXJuZWwgY2FuIG5vdyBzZWUKRlNH
U0JBU0UgY2hhbmdpbmcsIGJ1dCB0aGlzIG5ldyBsb2dpYyBpcyBvdGhlcndp
c2UgYnVnLWNvbXBhdGlibGUgd2l0aCBiZWZvcmUuCgpUaGlzIGlzIHBhcnQg
b2YgWFNBLTI5MwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5k
cmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVs
aWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRpZmYgLS1naXQgYS94ZW4vYXJj
aC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXgg
MzJkYzQyNTMuLjdmZjBmMTAgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9k
b21haW4uYworKysgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTc2OSw0
OSArNzY5LDYgQEAgdm9pZCBhcmNoX2RvbWFpbl9jcmVhdGlvbl9maW5pc2hl
ZChzdHJ1Y3QgZG9tYWluICpkKQogewogfQogCi0vKgotICogVGhlc2UgYXJl
IHRoZSBtYXNrcyBvZiBDUjQgYml0cyAoc3ViamVjdCB0byBoYXJkd2FyZSBh
dmFpbGFiaWxpdHkpIHdoaWNoIGEKLSAqIFBWIGd1ZXN0IG1heSBub3QgbGVn
aXRpbWlhdGVseSBhdHRlbXB0IHRvIG1vZGlmeS4KLSAqLwotc3RhdGljIHVu
c2lnbmVkIGxvbmcgX19yZWFkX21vc3RseSBwdl9jcjRfbWFzaywgY29tcGF0
X3B2X2NyNF9tYXNrOwotCi1zdGF0aWMgaW50IF9faW5pdCBpbml0X3B2X2Ny
NF9tYXNrcyh2b2lkKQotewotICAgIHVuc2lnbmVkIGxvbmcgY29tbW9uX21h
c2sgPSB+WDg2X0NSNF9UU0Q7Ci0KLSAgICAvKgotICAgICAqIEFsbCBQViBn
dWVzdHMgbWF5IGF0dGVtcHQgdG8gbW9kaWZ5IFRTRCwgREUgYW5kIE9TWFNB
VkUuCi0gICAgICovCi0gICAgaWYgKCBjcHVfaGFzX2RlICkKLSAgICAgICAg
Y29tbW9uX21hc2sgJj0gflg4Nl9DUjRfREU7Ci0gICAgaWYgKCBjcHVfaGFz
X3hzYXZlICkKLSAgICAgICAgY29tbW9uX21hc2sgJj0gflg4Nl9DUjRfT1NY
U0FWRTsKLQotICAgIHB2X2NyNF9tYXNrID0gY29tcGF0X3B2X2NyNF9tYXNr
ID0gY29tbW9uX21hc2s7Ci0KLSAgICAvKgotICAgICAqIDY0Yml0IFBWIGd1
ZXN0cyBtYXkgYXR0ZW1wdCB0byBtb2RpZnkgRlNHU0JBU0UuCi0gICAgICov
Ci0gICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICkKLSAgICAgICAgcHZfY3I0
X21hc2sgJj0gflg4Nl9DUjRfRlNHU0JBU0U7Ci0KLSAgICByZXR1cm4gMDsK
LX0KLV9faW5pdGNhbGwoaW5pdF9wdl9jcjRfbWFza3MpOwotCi11bnNpZ25l
ZCBsb25nIHB2X2d1ZXN0X2NyNF9maXh1cChjb25zdCBzdHJ1Y3QgdmNwdSAq
diwgdW5zaWduZWQgbG9uZyBndWVzdF9jcjQpCi17Ci0gICAgdW5zaWduZWQg
bG9uZyBodl9jcjQgPSByZWFsX2NyNF90b19wdl9ndWVzdF9jcjQocmVhZF9j
cjQoKSk7Ci0gICAgdW5zaWduZWQgbG9uZyBtYXNrID0gaXNfcHZfMzJiaXRf
dmNwdSh2KSA/IGNvbXBhdF9wdl9jcjRfbWFzayA6IHB2X2NyNF9tYXNrOwot
Ci0gICAgaWYgKCAoZ3Vlc3RfY3I0ICYgbWFzaykgIT0gKGh2X2NyNCAmIG1h
c2spICkKLSAgICAgICAgcHJpbnRrKFhFTkxPR19HX1dBUk5JTkcKLSAgICAg
ICAgICAgICAgICJkJWQgYXR0ZW1wdGVkIHRvIGNoYW5nZSAlcHYncyBDUjQg
ZmxhZ3MgJTA4bHggLT4gJTA4bHhcbiIsCi0gICAgICAgICAgICAgICBjdXJy
ZW50LT5kb21haW4tPmRvbWFpbl9pZCwgdiwgaHZfY3I0LCBndWVzdF9jcjQp
OwotCi0gICAgcmV0dXJuIChodl9jcjQgJiBtYXNrKSB8IChndWVzdF9jcjQg
JiB+bWFzayk7Ci19Ci0KICNkZWZpbmUgeGVuX3ZjcHVfZ3Vlc3RfY29udGV4
dCB2Y3B1X2d1ZXN0X2NvbnRleHQKICNkZWZpbmUgZnB1X2N0eHQgZnB1X2N0
eHQueAogQ0hFQ0tfRklFTERfKHN0cnVjdCwgdmNwdV9ndWVzdF9jb250ZXh0
LCBmcHVfY3R4dCk7CkBAIC04MjksNyArNzg2LDYgQEAgaW50IGFyY2hfc2V0
X2luZm9fZ3Vlc3QoCiAjaWZkZWYgQ09ORklHX1BWCiAgICAgdW5zaWduZWQg
bG9uZyBjcjNfZ2ZuOwogICAgIHN0cnVjdCBwYWdlX2luZm8gKmNyM19wYWdl
OwotICAgIHVuc2lnbmVkIGxvbmcgY3I0OwogICAgIGludCByYyA9IDA7CiAj
ZW5kaWYKIApAQCAtMTAwNSw5ICs5NjEsNyBAQCBpbnQgYXJjaF9zZXRfaW5m
b19ndWVzdCgKICAgICB2LT5hcmNoLnB2LmN0cmxyZWdbMF0gJj0gWDg2X0NS
MF9UUzsKICAgICB2LT5hcmNoLnB2LmN0cmxyZWdbMF0gfD0gcmVhZF9jcjAo
KSAmIH5YODZfQ1IwX1RTOwogCi0gICAgY3I0ID0gdi0+YXJjaC5wdi5jdHJs
cmVnWzRdOwotICAgIHYtPmFyY2gucHYuY3RybHJlZ1s0XSA9IGNyNCA/IHB2
X2d1ZXN0X2NyNF9maXh1cCh2LCBjcjQpIDoKLSAgICAgICAgcmVhbF9jcjRf
dG9fcHZfZ3Vlc3RfY3I0KG1tdV9jcjRfZmVhdHVyZXMpOworICAgIHYtPmFy
Y2gucHYuY3RybHJlZ1s0XSA9IHB2X2ZpeHVwX2d1ZXN0X2NyNCh2LCB2LT5h
cmNoLnB2LmN0cmxyZWdbNF0pOwogCiAgICAgbWVtc2V0KHYtPmFyY2guZHIs
IDAsIHNpemVvZih2LT5hcmNoLmRyKSk7CiAgICAgdi0+YXJjaC5kcjYgPSBY
ODZfRFI2X0RFRkFVTFQ7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0u
YyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IDdlYzU5NTQuLmJhNDQ0ZDIg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9tbS5jCkBAIC01MjksMzMgKzUyOSwxMyBAQCB2b2lkIG1ha2VfY3Iz
KHN0cnVjdCB2Y3B1ICp2LCBtZm5fdCBtZm4pCiAgICAgICAgIHYtPmFyY2gu
Y3IzIHw9IGdldF9wY2lkX2JpdHModiwgZmFsc2UpOwogfQogCi11bnNpZ25l
ZCBsb25nIHB2X2d1ZXN0X2NyNF90b19yZWFsX2NyNChjb25zdCBzdHJ1Y3Qg
dmNwdSAqdikKLXsKLSAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpkID0gdi0+
ZG9tYWluOwotICAgIHVuc2lnbmVkIGxvbmcgY3I0OwotCi0gICAgY3I0ID0g
di0+YXJjaC5wdi5jdHJscmVnWzRdICYgflg4Nl9DUjRfREU7Ci0gICAgY3I0
IHw9IG1tdV9jcjRfZmVhdHVyZXMgJiAoWDg2X0NSNF9QU0UgfCBYODZfQ1I0
X1NNRVAgfCBYODZfQ1I0X1NNQVAgfAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFg4Nl9DUjRfT1NYU0FWRSB8IFg4Nl9DUjRfRlNHU0JBU0Up
OwotCi0gICAgaWYgKCBkLT5hcmNoLnB2LnBjaWQgKQotICAgICAgICBjcjQg
fD0gWDg2X0NSNF9QQ0lERTsKLSAgICBlbHNlIGlmICggIWQtPmFyY2gucHYu
eHB0aSApCi0gICAgICAgIGNyNCB8PSBYODZfQ1I0X1BHRTsKLQotICAgIGNy
NCB8PSBkLT5hcmNoLnZ0c2MgPyBYODZfQ1I0X1RTRCA6IDA7Ci0KLSAgICBy
ZXR1cm4gY3I0OwotfQotCiB2b2lkIHdyaXRlX3B0YmFzZShzdHJ1Y3QgdmNw
dSAqdikKIHsKICAgICBzdHJ1Y3QgY3B1X2luZm8gKmNwdV9pbmZvID0gZ2V0
X2NwdV9pbmZvKCk7CiAgICAgdW5zaWduZWQgbG9uZyBuZXdfY3I0OwogCiAg
ICAgbmV3X2NyNCA9IChpc19wdl92Y3B1KHYpICYmICFpc19pZGxlX3ZjcHUo
dikpCi0gICAgICAgICAgICAgID8gcHZfZ3Vlc3RfY3I0X3RvX3JlYWxfY3I0
KHYpCi0gICAgICAgICAgICAgIDogKChyZWFkX2NyNCgpICYgfihYODZfQ1I0
X1BDSURFIHwgWDg2X0NSNF9UU0QpKSB8IFg4Nl9DUjRfUEdFKTsKKyAgICAg
ICAgICAgICAgPyBwdl9tYWtlX2NyNCh2KSA6IG1tdV9jcjRfZmVhdHVyZXM7
CiAKICAgICBpZiAoIGlzX3B2X3ZjcHUodikgJiYgdi0+ZG9tYWluLT5hcmNo
LnB2LnhwdGkgKQogICAgIHsKQEAgLTU3NCw4ICs1NTQsNiBAQCB2b2lkIHdy
aXRlX3B0YmFzZShzdHJ1Y3QgdmNwdSAqdikKICAgICAgICAgc3dpdGNoX2Ny
M19jcjQodi0+YXJjaC5jcjMsIG5ld19jcjQpOwogICAgICAgICBjcHVfaW5m
by0+cHZfY3IzID0gMDsKICAgICB9Ci0KLSAgICBBU1NFUlQoaXNfcHZfdmNw
dSh2KSB8fCByZWFkX2NyNCgpID09IG1tdV9jcjRfZmVhdHVyZXMpOwogfQog
CiAvKgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3B2L2RvbWFpbi5jIGIv
eGVuL2FyY2gveDg2L3B2L2RvbWFpbi5jCmluZGV4IDdlODRiMDQuLjkxMTIz
YTggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9kb21haW4uYworKysg
Yi94ZW4vYXJjaC94ODYvcHYvZG9tYWluLmMKQEAgLTk3LDYgKzk3LDUyIEBA
IHN0YXRpYyB2b2lkIHJlbGVhc2VfY29tcGF0X2w0KHN0cnVjdCB2Y3B1ICp2
KQogICAgIHYtPmFyY2guZ3Vlc3RfdGFibGVfdXNlciA9IHBhZ2V0YWJsZV9u
dWxsKCk7CiB9CiAKK3Vuc2lnbmVkIGxvbmcgcHZfZml4dXBfZ3Vlc3RfY3I0
KGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBsb25nIGNyNCkKK3sK
KyAgICBjb25zdCBzdHJ1Y3QgY3B1aWRfcG9saWN5ICpwID0gdi0+ZG9tYWlu
LT5hcmNoLmNwdWlkOworCisgICAgLyogRGlzY2FyZCBhdHRlbXB0cyB0byBz
ZXQgZ3Vlc3QgY29udHJvbGxhYmxlIGJpdHMgb3V0c2lkZSBvZiB0aGUgcG9s
aWN5LiAqLworICAgIGNyNCAmPSB+KChwLT5iYXNpYy50c2MgICAgID8gMCA6
IFg4Nl9DUjRfVFNEKSAgICAgIHwKKyAgICAgICAgICAgICAocC0+YmFzaWMu
ZGUgICAgICA/IDAgOiBYODZfQ1I0X0RFKSAgICAgICB8CisgICAgICAgICAg
ICAgKHAtPmZlYXQuZnNnc2Jhc2UgPyAwIDogWDg2X0NSNF9GU0dTQkFTRSkg
fAorICAgICAgICAgICAgIChwLT5iYXNpYy54c2F2ZSAgID8gMCA6IFg4Nl9D
UjRfT1NYU0FWRSkpOworCisgICAgLyogTWFza3MgZXhwZWN0ZWQgdG8gYmUg
ZGlzam9pbnQgc2V0cy4gKi8KKyAgICBCVUlMRF9CVUdfT04oUFZfQ1I0X0dV
RVNUX01BU0sgJiBQVl9DUjRfR1VFU1RfVklTSUJMRV9NQVNLKTsKKworICAg
IC8qCisgICAgICogQSBndWVzdCBzZWVzIHRoZSBwb2xpY3kgc3Vic2V0IG9m
IGl0cyBvd24gY2hvaWNlIG9mIGd1ZXN0IGNvbnRyb2xsYWJsZQorICAgICAq
IGJpdHMsIGFuZCBhIHN1YnNldCBvZiBYZW4ncyBjaG9pY2Ugb2YgY2VydGFp
biBoYXJkd2FyZSBzZXR0aW5ncy4KKyAgICAgKi8KKyAgICByZXR1cm4gKChj
cjQgJiBQVl9DUjRfR1VFU1RfTUFTSykgfAorICAgICAgICAgICAgKG1tdV9j
cjRfZmVhdHVyZXMgJiBQVl9DUjRfR1VFU1RfVklTSUJMRV9NQVNLKSk7Cit9
CisKK3Vuc2lnbmVkIGxvbmcgcHZfbWFrZV9jcjQoY29uc3Qgc3RydWN0IHZj
cHUgKnYpCit7CisgICAgY29uc3Qgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRv
bWFpbjsKKyAgICB1bnNpZ25lZCBsb25nIGNyNCA9IG1tdV9jcjRfZmVhdHVy
ZXMgJgorICAgICAgICB+KFg4Nl9DUjRfUENJREUgfCBYODZfQ1I0X1BHRSB8
IFg4Nl9DUjRfVFNEKTsKKworICAgIC8qCisgICAgICogUENJREUgb3IgUEdF
IGRlcGVuZHMgb24gdGhlIFBDSUQvWFBUSSBzZXR0aW5ncywgYnV0IG11c3Qg
bm90IGJvdGggYmUKKyAgICAgKiBzZXQsIGFzIGl0IGltcGFjdHMgdGhlIHNh
ZmV0eSBvZiBUTEIgZmx1c2hpbmcuCisgICAgICovCisgICAgaWYgKCBkLT5h
cmNoLnB2LnBjaWQgKQorICAgICAgICBjcjQgfD0gWDg2X0NSNF9QQ0lERTsK
KyAgICBlbHNlIGlmICggIWQtPmFyY2gucHYueHB0aSApCisgICAgICAgIGNy
NCB8PSBYODZfQ1I0X1BHRTsKKworICAgIC8qCisgICAgICogVFNEIGlzIG5l
ZWRlZCBpZiBlaXRoZXIgdGhlIGd1ZXN0IGhhcyBlbGVjdGVkIHRvIHVzZSBp
dCwgb3IgWGVuIGlzCisgICAgICogdmlydHVhbGlzaW5nIHRoZSBUU0MgdmFs
dWUgdGhlIGd1ZXN0IHNlZXMuCisgICAgICovCisgICAgaWYgKCBkLT5hcmNo
LnZ0c2MgfHwgKHYtPmFyY2gucHYuY3RybHJlZ1s0XSAmIFg4Nl9DUjRfVFNE
KSApCisgICAgICAgIGNyNCB8PSBYODZfQ1I0X1RTRDsKKworICAgIHJldHVy
biBjcjQ7Cit9CisKIGludCBzd2l0Y2hfY29tcGF0KHN0cnVjdCBkb21haW4g
KmQpCiB7CiAgICAgc3RydWN0IHZjcHUgKnY7CkBAIC0xOTEsNyArMjM3LDcg
QEAgaW50IHB2X3ZjcHVfaW5pdGlhbGlzZShzdHJ1Y3QgdmNwdSAqdikKICAg
ICAvKiBQViBndWVzdHMgYnkgZGVmYXVsdCBoYXZlIGEgMTAwSHogdGlja2Vy
LiAqLwogICAgIHYtPnBlcmlvZGljX3BlcmlvZCA9IE1JTExJU0VDUygxMCk7
CiAKLSAgICB2LT5hcmNoLnB2LmN0cmxyZWdbNF0gPSByZWFsX2NyNF90b19w
dl9ndWVzdF9jcjQobW11X2NyNF9mZWF0dXJlcyk7CisgICAgdi0+YXJjaC5w
di5jdHJscmVnWzRdID0gcHZfZml4dXBfZ3Vlc3RfY3I0KHYsIDApOwogCiAg
ICAgaWYgKCBpc19wdl8zMmJpdF9kb21haW4oZCkgKQogICAgIHsKZGlmZiAt
LWdpdCBhL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYyBiL3hlbi9h
cmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYwppbmRleCA5NDJlY2UyLi5iNGE1
NmY5IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9w
LmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2VtdWwtcHJpdi1vcC5jCkBAIC0z
Myw2ICszMyw3IEBACiAjaW5jbHVkZSA8YXNtL2h5cGVyY2FsbC5oPgogI2lu
Y2x1ZGUgPGFzbS9tYzE0NjgxOHJ0Yy5oPgogI2luY2x1ZGUgPGFzbS9wMm0u
aD4KKyNpbmNsdWRlIDxhc20vcHYvZG9tYWluLmg+CiAjaW5jbHVkZSA8YXNt
L3B2L3RyYXBzLmg+CiAjaW5jbHVkZSA8YXNtL3NoYXJlZC5oPgogI2luY2x1
ZGUgPGFzbS90cmFwcy5oPgpAQCAtNzc5LDggKzc4MCw4IEBAIHN0YXRpYyBp
bnQgd3JpdGVfY3IodW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQgbG9uZyB2
YWwsCiAgICAgfQogCiAgICAgY2FzZSA0OiAvKiBXcml0ZSBDUjQgKi8KLSAg
ICAgICAgY3Vyci0+YXJjaC5wdi5jdHJscmVnWzRdID0gcHZfZ3Vlc3RfY3I0
X2ZpeHVwKGN1cnIsIHZhbCk7Ci0gICAgICAgIHdyaXRlX2NyNChwdl9ndWVz
dF9jcjRfdG9fcmVhbF9jcjQoY3VycikpOworICAgICAgICBjdXJyLT5hcmNo
LnB2LmN0cmxyZWdbNF0gPSBwdl9maXh1cF9ndWVzdF9jcjQoY3VyciwgdmFs
KTsKKyAgICAgICAgd3JpdGVfY3I0KHB2X21ha2VfY3I0KGN1cnIpKTsKICAg
ICAgICAgY3R4dF9zd2l0Y2hfbGV2ZWxsaW5nKGN1cnIpOwogICAgICAgICBy
ZXR1cm4gWDg2RU1VTF9PS0FZOwogICAgIH0KZGlmZiAtLWdpdCBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvZG9tYWluLmggYi94ZW4vaW5jbHVkZS9hc20teDg2
L2RvbWFpbi5oCmluZGV4IDI3N2Y5OWYuLmExMzFjYTIgMTAwNjQ0Ci0tLSBh
L3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWluLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9kb21haW4uaApAQCAtNjUzLDE3ICs2NTMsNiBAQCBib29s
IHVwZGF0ZV9zZWNvbmRhcnlfc3lzdGVtX3RpbWUoc3RydWN0IHZjcHUgKiwK
IHZvaWQgdmNwdV9zaG93X2V4ZWN1dGlvbl9zdGF0ZShzdHJ1Y3QgdmNwdSAq
KTsKIHZvaWQgdmNwdV9zaG93X3JlZ2lzdGVycyhjb25zdCBzdHJ1Y3QgdmNw
dSAqKTsKIAotLyogQ2xlYW4gdXAgQ1I0IGJpdHMgdGhhdCBhcmUgbm90IHVu
ZGVyIGd1ZXN0IGNvbnRyb2wuICovCi11bnNpZ25lZCBsb25nIHB2X2d1ZXN0
X2NyNF9maXh1cChjb25zdCBzdHJ1Y3QgdmNwdSAqLCB1bnNpZ25lZCBsb25n
IGd1ZXN0X2NyNCk7Ci0KLS8qIENvbnZlcnQgYmV0d2VlbiBndWVzdC12aXNp
YmxlIGFuZCByZWFsIENSNCB2YWx1ZXMuICovCi11bnNpZ25lZCBsb25nIHB2
X2d1ZXN0X2NyNF90b19yZWFsX2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdik7
Ci0KLSNkZWZpbmUgcmVhbF9jcjRfdG9fcHZfZ3Vlc3RfY3I0KGMpICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKLSAgICAoKGMpICYgfihYODZfQ1I0X1BH
RSB8IFg4Nl9DUjRfUFNFIHwgWDg2X0NSNF9UU0QgfCAgICAgIFwKLSAgICAg
ICAgICAgICBYODZfQ1I0X09TWFNBVkUgfCBYODZfQ1I0X1NNRVAgfCAgICAg
ICAgICAgICAgIFwKLSAgICAgICAgICAgICBYODZfQ1I0X0ZTR1NCQVNFIHwg
WDg2X0NSNF9TTUFQIHwgWDg2X0NSNF9QQ0lERSkpCi0KIHN0YXRpYyBpbmxp
bmUgc3RydWN0IHZjcHVfZ3Vlc3RfY29udGV4dCAqYWxsb2NfdmNwdV9ndWVz
dF9jb250ZXh0KHZvaWQpCiB7CiAgICAgcmV0dXJuIHZtYWxsb2Moc2l6ZW9m
KHN0cnVjdCB2Y3B1X2d1ZXN0X2NvbnRleHQpKTsKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvcHYvZG9tYWluLmggYi94ZW4vaW5jbHVkZS9h
c20teDg2L3B2L2RvbWFpbi5oCmluZGV4IDdkOWQwOWQuLjk5YTBmZTcgMTAw
NjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcHYvZG9tYWluLmgKKysr
IGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wdi9kb21haW4uaApAQCAtNjEsNiAr
NjEsMjMgQEAgaW50IHB2X3ZjcHVfaW5pdGlhbGlzZShzdHJ1Y3QgdmNwdSAq
dik7CiB2b2lkIHB2X2RvbWFpbl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQp
OwogaW50IHB2X2RvbWFpbl9pbml0aWFsaXNlKHN0cnVjdCBkb21haW4gKmQp
OwogCisvKgorICogQml0cyB3aGljaCBhIFBWIGd1ZXN0IGNhbiB0b2dnbGUg
aW4gaXRzIHZpZXcgb2YgY3I0LiAgU29tZSBhcmUgbG9hZGVkIGludG8KKyAq
IGhhcmR3YXJlLCB3aGlsZSBzb21lIGFyZSBmdWxseSBlbXVsYXRlZC4KKyAq
LworI2RlZmluZSBQVl9DUjRfR1VFU1RfTUFTSyBcCisgICAgKFg4Nl9DUjRf
VFNEIHwgWDg2X0NSNF9ERSB8IFg4Nl9DUjRfRlNHU0JBU0UgfCBYODZfQ1I0
X09TWFNBVkUpCisKKy8qIEJpdHMgd2hpY2ggYSBQViBndWVzdCBtYXkgb2Jz
ZXJ2ZSBmcm9tIHRoZSByZWFsIGhhcmR3YXJlIHNldHRpbmdzLiAqLworI2Rl
ZmluZSBQVl9DUjRfR1VFU1RfVklTSUJMRV9NQVNLIFwKKyAgICAoWDg2X0NS
NF9QQUUgfCBYODZfQ1I0X01DRSB8IFg4Nl9DUjRfT1NGWFNSIHwgWDg2X0NS
NF9PU1hNTUVYQ1BUKQorCisvKiBHaXZlbiBhIG5ldyBjcjQgdmFsdWUsIGNv
bnN0cnVjdCB0aGUgcmVzdWx0aW5nIGd1ZXN0LXZpc2libGUgY3I0IHZhbHVl
LiAqLwordW5zaWduZWQgbG9uZyBwdl9maXh1cF9ndWVzdF9jcjQoY29uc3Qg
c3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGxvbmcgY3I0KTsKKworLyogQ3Jl
YXRlIGEgY3I0IHZhbHVlIHRvIGxvYWQgaW50byBoYXJkd2FyZSwgYmFzZWQg
b24gdmNwdSBzZXR0aW5ncy4gKi8KK3Vuc2lnbmVkIGxvbmcgcHZfbWFrZV9j
cjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpOworCiBib29sIHhwdGlfcGNpZF9l
bmFibGVkKHZvaWQpOwogCiAjZWxzZSAgLyogIUNPTkZJR19QViAqLwpAQCAt
NzIsNiArODksOCBAQCBzdGF0aWMgaW5saW5lIGludCBwdl92Y3B1X2luaXRp
YWxpc2Uoc3RydWN0IHZjcHUgKnYpIHsgcmV0dXJuIC1FT1BOT1RTVVBQOyB9
CiBzdGF0aWMgaW5saW5lIHZvaWQgcHZfZG9tYWluX2Rlc3Ryb3koc3RydWN0
IGRvbWFpbiAqZCkge30KIHN0YXRpYyBpbmxpbmUgaW50IHB2X2RvbWFpbl9p
bml0aWFsaXNlKHN0cnVjdCBkb21haW4gKmQpIHsgcmV0dXJuIC1FT1BOT1RT
VVBQOyB9CiAKK3N0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBwdl9tYWtl
X2NyNChjb25zdCBzdHJ1Y3QgdmNwdSAqdikgeyByZXR1cm4gfjB1bDsgfQor
CiAjZW5kaWYJLyogQ09ORklHX1BWICovCiAKIHZvaWQgcGFyYXZpcnRfY3R4
dF9zd2l0Y2hfZnJvbShzdHJ1Y3QgdmNwdSAqdik7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa293/unstable-2.patch"
Content-Disposition: attachment; filename="xsa293/unstable-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3B2OiBEb24ndCBoYXZlICVjcjQuZnNnc2Jhc2Ug
YWN0aXZlIGJlaGluZCBhIGd1ZXN0IGtlcm5lbHMgYmFjawoKQ3VycmVudGx5
LCBhIDY0Yml0IFBWIGd1ZXN0IGNhbiBhcHBlYXIgdG8gc2V0IGFuZCBjbGVh
ciBGU0dTQkFTRSBpbiAlY3I0LCBidXQKdGhlIGJpdCByZW1haW5zIHNldCBp
biBoYXJkd2FyZS4gIFRoZXJlZm9yZSwgdGhlIHtSRCxXUn17RlMsR1N9QkFT
RSBhcmUgdXNhYmxlCmV2ZW4gd2hlbiB0aGUgZ3Vlc3Qga2VybmVsIGJlbGll
dmVzIHRoYXQgdGhleSBhcmUgZGlzYWJsZWQuCgpUaGUgRlNHU0JBU0UgZmVh
dHVyZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIGluIExpbnV4LCBhbmQg
aXRzIGNvbnRleHQKc3dpdGNoIHBhdGggaGFzIHNvbWUgb3B0aW1pc2F0aW9u
cyB3aGljaCByZWx5IG9uIHVzZXJzcGFjZSBiZWluZyB1bmFibGUgdG8gdXNl
CnRoZSBXUntGUyxHU31CQVNFIGluc3RydWN0aW9ucy4gIFhlbidzIGN1cnJl
bnQgYmVoYXZpb3VyIHVuZGVybWluZXMgdGhpcwpleHBlY3RhdGlvbi4KCklu
IDY0Yml0IFBWIGd1ZXN0IGNvbnRleHQsIGFsd2F5cyBsb2FkIHRoZSBndWVz
dCBrZXJuZWxzIHNldHRpbmcgb2YgRlNHU0JBU0UKaW50byAlY3I0LiAgVGhp
cyByZXF1aXJlcyBhZGp1c3RpbmcgaG93IFhlbiB1c2VzIHRoZSB7UkQsV1J9
e0ZTLEdTfUJBU0UKaW5zdHJ1Y3Rpb25zLgoKICogRGVsZXRlIHRoZSBjcHVf
aGFzX2ZzZ3NiYXNlIGhlbHBlci4gIEl0IGlzIG5vIGxvbmdlciBzYWZlLCBh
cyB1c2VycyBuZWVkIHRvCiAgIGNoZWNrICVjcjQgZGlyZWN0bHkuCiAqIFRo
ZSByYXcgX19yZHtmcyxnc31iYXNlKCkgaGVscGVycyBhcmUgb25seSBzYWZl
IHRvIHVzZSB3aGVuICVjcjQuZnNnc2Jhc2UKICAgaXMgc2V0LiAgQ29tbWVu
dCB0aGlzIHByb3BlcnR5LgogKiBUaGUge3JkLHdyfXtmcyxnc317YmFzZSxz
aGFkb3d9KCkgYW5kIHJlYWRfbXNyKCkgaGVscGVycyBhcmUgdXBkYXRlZCB0
byB1c2UKICAgdGhlIGN1cnJlbnQgJWNyNCB2YWx1ZSB0byBkZXRlcm1pbmUg
d2hpY2ggbWVjaGFuaXNtIHRvIHVzZS4KICogdG9nZ2xlX2d1ZXN0X21vZGUo
KSBhbmQgc2F2ZV9zZWdtZW50cygpIGFyZSB1cGRhdGUgdG8gYXZvaWQgcmVh
ZGluZwogICBmcy9nc2Jhc2UgaWYgdGhlIHZhbHVlcyBpbiBoYXJkd2FyZSBj
YW5ub3QgYmUgc3RhbGUgV1JUIHN0cnVjdCB2Y3B1LiAgQQogICBjb25zZXF1
ZW5jZSBvZiB0aGlzIGlzIHRoYXQgdGhlIHdyaXRlX2NyKCkgcGF0aCBuZWVk
cyB0byBjYWNoZSB0aGUgY3VycmVudAogICBiYXNlcywgYXMgc3Vic2VxdWVu
dCBjb250ZXh0IHN3aXRjaGVzIHdpbGwgc2tpcCBzYXZpbmcgdGhlIHZhbHVl
cy4KICogd3JpdGVfY3I0KCkgaXMgdXBkYXRlZCB0byBlbnN1cmUgdGhhdCB0
aGUgc2hhZG93ICVjcjQuZnNnc2Jhc2UgdmFsdWUgaXMKICAgb2JzZXJ2ZWQg
aW4gYSBzYWZlIHdheSBXUlQgdGhlIGhhcmR3YXJlIHNldHRpbmcsIGlmIGFu
IGludGVycnVwdCBoYXBwZW5zIHRvCiAgIGhpdCBpbiB0aGUgbWlkZGxlLgog
KiBsb2FkX3NlZ21lbnRzKCkgaXMgdXBkYXRlZCB0byB1c2UgdGhlIFZNTE9B
RCBvcHRpbWlzYXRpb24gaWYgRlNHU0JBU0UgaXMKICAgdW5hdmFpbGFibGUs
IGV2ZW4gaWYgb25seSBnc19zaGFkb3cgbmVlZHMgdXBkYXRpbmcuICBBcyBh
IG1pbm9yIHBlcmYKICAgaW1wcm92ZW1lbnQsIGNoZWNrIGNwdV9oYXNfc3Zt
IGZpcnN0IHRvIHNob3J0IGNpcmN1aXQgYSBjb250ZXh0LWRlcGVuZGVudAog
ICBjb25kaXRpb25hbCBvbiBJbnRlbCBoYXJkd2FyZS4KICogcHZfbWFrZV9j
cjQoKSBpcyB1cGRhdGVkIGZvciA2NGJpdCBQViBndWVzdHMgdG8gdXNlIHRo
ZSBndWVzdCBrZXJuZWxzCiAgIGNob2ljZSBvZiBGU0dTQkFTRS4KClRoaXMg
aXMgcGFydCBvZiBYU0EtMjkzCgpSZXBvcnRlZC1ieTogQW5keSBMdXRvbWly
c2tpIDxsdXRvQGtlcm5lbC5vcmc+ClNpZ25lZC1vZmYtYnk6IEFuZHJldyBD
b29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5
OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CgpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVuL2FyY2gveDg2L2RvbWFp
bi5jCmluZGV4IDdmZjBmMTAuLmFkZWUzNWUgMTAwNjQ0Ci0tLSBhL3hlbi9h
cmNoL3g4Ni9kb21haW4uYworKysgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMK
QEAgLTEzMDMsMTMgKzEzMDMsOCBAQCBzdGF0aWMgdm9pZCBsb2FkX3NlZ21l
bnRzKHN0cnVjdCB2Y3B1ICpuKQogICAgIHBlcl9jcHUoZGlydHlfc2VnbWVu
dF9tYXNrLCBjcHUpID0gMDsKIAogI2lmZGVmIENPTkZJR19IVk0KLSAgICBp
ZiAoICFpc19wdl8zMmJpdF92Y3B1KG4pICYmICFjcHVfaGFzX2ZzZ3NiYXNl
ICYmIGNwdV9oYXNfc3ZtICYmCi0gICAgICAgICAhKCh1cmVncy0+ZnMgfCB1
cmVncy0+Z3MpICYgfjMpICYmCi0gICAgICAgICAvKgotICAgICAgICAgICog
VGhlIHJlbWFpbmluZyBwYXJ0IGlzIGp1c3QgZm9yIG9wdGltaXphdGlvbjog
SWYgb25seSBzaGFkb3cgR1MKLSAgICAgICAgICAqIG5lZWRzIGxvYWRpbmcs
IHRoZXJlJ3Mgbm90aGluZyB0byBiZSBnYWluZWQgaGVyZS4KLSAgICAgICAg
ICAqLwotICAgICAgICAgKG4tPmFyY2gucHYuZnNfYmFzZSB8IG4tPmFyY2gu
cHYuZ3NfYmFzZV91c2VyIHwgbi0+YXJjaC5wdi5sZHRfZW50cykgKQorICAg
IGlmICggY3B1X2hhc19zdm0gJiYgIWlzX3B2XzMyYml0X3ZjcHUobikgJiYK
KyAgICAgICAgICEocmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0UpICYm
ICEoKHVyZWdzLT5mcyB8IHVyZWdzLT5ncykgJiB+MykgKQogICAgIHsKICAg
ICAgICAgdW5zaWduZWQgbG9uZyBnc2IgPSBuLT5hcmNoLmZsYWdzICYgVEZf
a2VybmVsX21vZGUKICAgICAgICAgICAgID8gbi0+YXJjaC5wdi5nc19iYXNl
X2tlcm5lbCA6IG4tPmFyY2gucHYuZ3NfYmFzZV91c2VyOwpAQCAtMTQ4OCw3
ICsxNDgzLDggQEAgc3RhdGljIHZvaWQgc2F2ZV9zZWdtZW50cyhzdHJ1Y3Qg
dmNwdSAqdikKICAgICByZWdzLT5mcyA9IHJlYWRfc3JlZyhmcyk7CiAgICAg
cmVncy0+Z3MgPSByZWFkX3NyZWcoZ3MpOwogCi0gICAgaWYgKCBjcHVfaGFz
X2ZzZ3NiYXNlICYmICFpc19wdl8zMmJpdF92Y3B1KHYpICkKKyAgICAvKiAl
ZnMvJWdzIGJhc2VzIGNhbiBvbmx5IGJlIHN0YWxlIGlmIFdSe0ZTLEdTfUJB
U0UgYXJlIHVzYWJsZS4gKi8KKyAgICBpZiAoIChyZWFkX2NyNCgpICYgWDg2
X0NSNF9GU0dTQkFTRSkgJiYgIWlzX3B2XzMyYml0X3ZjcHUodikgKQogICAg
IHsKICAgICAgICAgdi0+YXJjaC5wdi5mc19iYXNlID0gX19yZGZzYmFzZSgp
OwogICAgICAgICBpZiAoIHYtPmFyY2guZmxhZ3MgJiBURl9rZXJuZWxfbW9k
ZSApCkBAIC0xNjkyLDggKzE2ODgsOCBAQCBzdGF0aWMgdm9pZCBfX2NvbnRl
eHRfc3dpdGNoKHZvaWQpCiAKICNpZiBkZWZpbmVkKENPTkZJR19QVikgJiYg
ZGVmaW5lZChDT05GSUdfSFZNKQogICAgIC8qIFByZWZldGNoIHRoZSBWTUNC
IGlmIHdlIGV4cGVjdCB0byB1c2UgaXQgbGF0ZXIgaW4gdGhlIGNvbnRleHQg
c3dpdGNoICovCi0gICAgaWYgKCBpc19wdl9kb21haW4obmQpICYmICFpc19w
dl8zMmJpdF9kb21haW4obmQpICYmICFpc19pZGxlX2RvbWFpbihuZCkgJiYK
LSAgICAgICAgICFjcHVfaGFzX2ZzZ3NiYXNlICYmIGNwdV9oYXNfc3ZtICkK
KyAgICBpZiAoIGNwdV9oYXNfc3ZtICYmIGlzX3B2X2RvbWFpbihuZCkgJiYg
IWlzX3B2XzMyYml0X2RvbWFpbihuZCkgJiYKKyAgICAgICAgICFpc19pZGxl
X2RvbWFpbihuZCkgJiYgIShyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFT
RSkgKQogICAgICAgICBzdm1fbG9hZF9zZWdzKDAsIDAsIDAsIDAsIDAsIDAs
IDApOwogI2VuZGlmCiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0v
c3ZtL3N2bS5jIGIveGVuL2FyY2gveDg2L2h2bS9zdm0vc3ZtLmMKaW5kZXgg
MjU4NGI5MC4uMjNkNzJlOCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2
bS9zdm0vc3ZtLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9zdm0vc3ZtLmMK
QEAgLTE1NzQsOCArMTU3NCw3IEBAIHN0YXRpYyBpbnQgc3ZtX2NwdV91cF9w
cmVwYXJlKHVuc2lnbmVkIGludCBjcHUpCiAgICAgICAgICAgICBnb3RvIGVy
cjsKIAogI2lmZGVmIENPTkZJR19QVgotICAgICAgICBpZiAoICFjcHVfaGFz
X2ZzZ3NiYXNlICkKLSAgICAgICAgICAgIHBlcl9jcHUoaG9zdF92bWNiX3Zh
LCBjcHUpID0gX19tYXBfZG9tYWluX3BhZ2VfZ2xvYmFsKHBnKTsKKyAgICAg
ICAgcGVyX2NwdShob3N0X3ZtY2JfdmEsIGNwdSkgPSBfX21hcF9kb21haW5f
cGFnZV9nbG9iYWwocGcpOwogI2VuZGlmCiAKICAgICAgICAgY2xlYXJfZG9t
YWluX3BhZ2UocGFnZV90b19tZm4ocGcpKTsKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9wdi9kb21haW4uYyBiL3hlbi9hcmNoL3g4Ni9wdi9kb21haW4u
YwppbmRleCA5MTEyM2E4Li4zZTgyY2ZmIDEwMDY0NAotLS0gYS94ZW4vYXJj
aC94ODYvcHYvZG9tYWluLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2RvbWFp
bi5jCkBAIC0xNDAsNiArMTQwLDE1IEBAIHVuc2lnbmVkIGxvbmcgcHZfbWFr
ZV9jcjQoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiAgICAgaWYgKCBkLT5hcmNo
LnZ0c2MgfHwgKHYtPmFyY2gucHYuY3RybHJlZ1s0XSAmIFg4Nl9DUjRfVFNE
KSApCiAgICAgICAgIGNyNCB8PSBYODZfQ1I0X1RTRDsKIAorICAgIC8qCisg
ICAgICogVGhlIHtSRCxXUn17RlMsR1N9QkFTRSBhcmUgb25seSB1c2VhYmxl
IGluIDY0Yml0IGNvZGUgc2VnbWVudHMuICBXaGlsZQorICAgICAqIHdlIG11
c3Qgbm90IGhhdmUgQ1I0LkZTR1NCQVNFIHNldCBiZWhpbmQgdGhlIGJhY2sg
b2YgYSA2NGJpdCBQViBrZXJuZWwsCisgICAgICogd2UgZG8gbGVhdmUgaXQg
c2V0IGluIDMyYml0IFBWIGNvbnRleHQgdG8gc3BlZWQgdXAgWGVuJ3MgY29u
dGV4dCBzd2l0Y2gKKyAgICAgKiBwYXRoLgorICAgICAqLworICAgIGlmICgg
IWlzX3B2XzMyYml0X2RvbWFpbihkKSAmJiAhKHYtPmFyY2gucHYuY3RybHJl
Z1s0XSAmIFg4Nl9DUjRfRlNHU0JBU0UpICkKKyAgICAgICAgY3I0ICY9IH5Y
ODZfQ1I0X0ZTR1NCQVNFOworCiAgICAgcmV0dXJuIGNyNDsKIH0KIApAQCAt
MzcxLDcgKzM4MCw4IEBAIHZvaWQgdG9nZ2xlX2d1ZXN0X21vZGUoc3RydWN0
IHZjcHUgKnYpCiB7CiAgICAgQVNTRVJUKCFpc19wdl8zMmJpdF92Y3B1KHYp
KTsKIAotICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSApCisgICAgLyogJWZz
LyVncyBiYXNlcyBjYW4gb25seSBiZSBzdGFsZSBpZiBXUntGUyxHU31CQVNF
IGFyZSB1c2FibGUuICovCisgICAgaWYgKCByZWFkX2NyNCgpICYgWDg2X0NS
NF9GU0dTQkFTRSApCiAgICAgewogICAgICAgICBpZiAoIHYtPmFyY2guZmxh
Z3MgJiBURl9rZXJuZWxfbW9kZSApCiAgICAgICAgICAgICB2LT5hcmNoLnB2
LmdzX2Jhc2Vfa2VybmVsID0gX19yZGdzYmFzZSgpOwpkaWZmIC0tZ2l0IGEv
eGVuL2FyY2gveDg2L3B2L2VtdWwtcHJpdi1vcC5jIGIveGVuL2FyY2gveDg2
L3B2L2VtdWwtcHJpdi1vcC5jCmluZGV4IGI0YTU2ZjkuLjM3NDZlMmEgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYworKysg
Yi94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMKQEAgLTc4MCw2ICs3
ODAsMTcgQEAgc3RhdGljIGludCB3cml0ZV9jcih1bnNpZ25lZCBpbnQgcmVn
LCB1bnNpZ25lZCBsb25nIHZhbCwKICAgICB9CiAKICAgICBjYXNlIDQ6IC8q
IFdyaXRlIENSNCAqLworICAgICAgICAvKgorICAgICAgICAgKiBJZiB0aGlz
IHdyaXRlIHdpbGwgZGlzYWJsZSBGU0dTQkFTRSwgcmVmcmVzaCBYZW4ncyBp
ZGVhIG9mIHRoZQorICAgICAgICAgKiBndWVzdCBiYXNlcyBub3cgdGhhdCB0
aGV5IGNhbiBubyBsb25nZXIgY2hhbmdlLgorICAgICAgICAgKi8KKyAgICAg
ICAgaWYgKCAoY3Vyci0+YXJjaC5wdi5jdHJscmVnWzRdICYgWDg2X0NSNF9G
U0dTQkFTRSkgJiYKKyAgICAgICAgICAgICAhKHZhbCAmIFg4Nl9DUjRfRlNH
U0JBU0UpICkKKyAgICAgICAgeworICAgICAgICAgICAgY3Vyci0+YXJjaC5w
di5mc19iYXNlID0gX19yZGZzYmFzZSgpOworICAgICAgICAgICAgY3Vyci0+
YXJjaC5wdi5nc19iYXNlX2tlcm5lbCA9IF9fcmRnc2Jhc2UoKTsKKyAgICAg
ICAgfQorCiAgICAgICAgIGN1cnItPmFyY2gucHYuY3RybHJlZ1s0XSA9IHB2
X2ZpeHVwX2d1ZXN0X2NyNChjdXJyLCB2YWwpOwogICAgICAgICB3cml0ZV9j
cjQocHZfbWFrZV9jcjQoY3VycikpOwogICAgICAgICBjdHh0X3N3aXRjaF9s
ZXZlbGxpbmcoY3Vycik7CkBAIC04MjgsMTQgKzgzOSwxNSBAQCBzdGF0aWMg
aW50IHJlYWRfbXNyKHVuc2lnbmVkIGludCByZWcsIHVpbnQ2NF90ICp2YWws
CiAgICAgY2FzZSBNU1JfRlNfQkFTRToKICAgICAgICAgaWYgKCBpc19wdl8z
MmJpdF9kb21haW4oY3VycmQpICkKICAgICAgICAgICAgIGJyZWFrOwotICAg
ICAgICAqdmFsID0gY3B1X2hhc19mc2dzYmFzZSA/IF9fcmRmc2Jhc2UoKSA6
IGN1cnItPmFyY2gucHYuZnNfYmFzZTsKKyAgICAgICAgKnZhbCA9IChyZWFk
X2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSkgPyBfX3JkZnNiYXNlKCkKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
OiBjdXJyLT5hcmNoLnB2LmZzX2Jhc2U7CiAgICAgICAgIHJldHVybiBYODZF
TVVMX09LQVk7CiAKICAgICBjYXNlIE1TUl9HU19CQVNFOgogICAgICAgICBp
ZiAoIGlzX3B2XzMyYml0X2RvbWFpbihjdXJyZCkgKQogICAgICAgICAgICAg
YnJlYWs7Ci0gICAgICAgICp2YWwgPSBjcHVfaGFzX2ZzZ3NiYXNlID8gX19y
ZGdzYmFzZSgpCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDog
Y3Vyci0+YXJjaC5wdi5nc19iYXNlX2tlcm5lbDsKKyAgICAgICAgKnZhbCA9
IChyZWFkX2NyNCgpICYgWDg2X0NSNF9GU0dTQkFTRSkgPyBfX3JkZ3NiYXNl
KCkKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOiBjdXJyLT5hcmNoLnB2LmdzX2Jhc2Vfa2VybmVsOwogICAgICAg
ICByZXR1cm4gWDg2RU1VTF9PS0FZOwogCiAgICAgY2FzZSBNU1JfU0hBRE9X
X0dTX0JBU0U6CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvc2V0dXAuYyBi
L3hlbi9hcmNoL3g4Ni9zZXR1cC5jCmluZGV4IDkyZGEwNjAuLjM0NDA3OTQg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9zZXR1cC5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9zZXR1cC5jCkBAIC0xNjEwLDcgKzE2MTAsNyBAQCB2b2lkIF9f
aW5pdCBub3JldHVybiBfX3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9w
KQogCiAgICAgY3I0X3B2MzJfbWFzayA9IG1tdV9jcjRfZmVhdHVyZXMgJiBY
RU5fQ1I0X1BWMzJfQklUUzsKIAotICAgIGlmICggY3B1X2hhc19mc2dzYmFz
ZSApCisgICAgaWYgKCBib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfRlNHU0JB
U0UpICkKICAgICAgICAgc2V0X2luX2NyNChYODZfQ1I0X0ZTR1NCQVNFKTsK
IAogICAgIGlmICggb3B0X2ludnBjaWQgJiYgY3B1X2hhc19pbnZwY2lkICkK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvY3B1ZmVhdHVyZS5o
IGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmgKaW5kZXggNTU5
MmUxNy4uMWZiOWFmNCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9jcHVmZWF0dXJlLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9jcHVm
ZWF0dXJlLmgKQEAgLTg5LDcgKzg5LDYgQEAKICNkZWZpbmUgY3B1X2hhc194
c2F2ZXMgICAgICAgICAgYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX1hTQVZF
UykKIAogLyogQ1BVSUQgbGV2ZWwgMHgwMDAwMDAwNzowLmVieCAqLwotI2Rl
ZmluZSBjcHVfaGFzX2ZzZ3NiYXNlICAgICAgICBib290X2NwdV9oYXMoWDg2
X0ZFQVRVUkVfRlNHU0JBU0UpCiAjZGVmaW5lIGNwdV9oYXNfYm1pMSAgICAg
ICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9CTUkxKQogI2RlZmlu
ZSBjcHVfaGFzX2hsZSAgICAgICAgICAgICBib290X2NwdV9oYXMoWDg2X0ZF
QVRVUkVfSExFKQogI2RlZmluZSBjcHVfaGFzX2F2eDIgICAgICAgICAgICBi
b290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfQVZYMikKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbXNyLmggYi94ZW4vaW5jbHVkZS9hc20teDg2
L21zci5oCmluZGV4IGFkZmEyZmEuLmE3MjQ0NzkgMTAwNjQ0Ci0tLSBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbXNyLmgKKysrIGIveGVuL2luY2x1ZGUvYXNt
LXg4Ni9tc3IuaApAQCAtMTI0LDYgKzEyNCwxNCBAQCBzdGF0aWMgaW5saW5l
IHVpbnQ2NF90IHJkdHNjX29yZGVyZWQodm9pZCkKIAkJCSAgOiAiPWEiIChs
b3cpLCAiPWQiIChoaWdoKSBcCiAJCQkgIDogImMiIChjb3VudGVyKSkKIAor
LyoKKyAqIE9uIGhhcmR3YXJlIHN1cHBvcnRpbmcgRlNHU0JBU0UsIHRoZSB2
YWx1ZSBsb2FkZWQgaW50byBoYXJkd2FyZSBpcyB0aGUKKyAqIGd1ZXN0IGtl
cm5lbCdzIGNob2ljZSBmb3IgNjRiaXQgUFYgZ3Vlc3RzIChYZW4ncyBjaG9p
Y2UgZm9yIElkbGUsIEhWTSBhbmQKKyAqIDMyYml0IFBWKS4KKyAqCisgKiBU
aGVyZWZvcmUsIHRoZSB7UkQsV1J9e0ZTLEdTfUJBU0UgaW5zdHJ1Y3Rpb25z
IGFyZSBvbmx5IHNhZmUgdG8gdXNlIGlmCisgKiAlY3I0LmZzZ3NiYXNlIGlz
IHNldC4KKyAqLwogc3RhdGljIGlubGluZSB1bnNpZ25lZCBsb25nIF9fcmRm
c2Jhc2Uodm9pZCkKIHsKICAgICB1bnNpZ25lZCBsb25nIGJhc2U7CkBAIC0x
NTQsNyArMTYyLDcgQEAgc3RhdGljIGlubGluZSB1bnNpZ25lZCBsb25nIHJk
ZnNiYXNlKHZvaWQpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBiYXNlOwogCi0g
ICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICkKKyAgICBpZiAoIHJlYWRfY3I0
KCkgJiBYODZfQ1I0X0ZTR1NCQVNFICkKICAgICAgICAgcmV0dXJuIF9fcmRm
c2Jhc2UoKTsKIAogICAgIHJkbXNybChNU1JfRlNfQkFTRSwgYmFzZSk7CkBA
IC0xNjYsNyArMTc0LDcgQEAgc3RhdGljIGlubGluZSB1bnNpZ25lZCBsb25n
IHJkZ3NiYXNlKHZvaWQpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBiYXNlOwog
Ci0gICAgaWYgKCBjcHVfaGFzX2ZzZ3NiYXNlICkKKyAgICBpZiAoIHJlYWRf
Y3I0KCkgJiBYODZfQ1I0X0ZTR1NCQVNFICkKICAgICAgICAgcmV0dXJuIF9f
cmRnc2Jhc2UoKTsKIAogICAgIHJkbXNybChNU1JfR1NfQkFTRSwgYmFzZSk7
CkBAIC0xNzgsNyArMTg2LDcgQEAgc3RhdGljIGlubGluZSB1bnNpZ25lZCBs
b25nIHJkZ3NzaGFkb3codm9pZCkKIHsKICAgICB1bnNpZ25lZCBsb25nIGJh
c2U7CiAKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQorICAgIGlmICgg
cmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0UgKQogICAgIHsKICAgICAg
ICAgYXNtIHZvbGF0aWxlICggInN3YXBncyIgKTsKICAgICAgICAgYmFzZSA9
IF9fcmRnc2Jhc2UoKTsKQEAgLTE5Miw3ICsyMDAsNyBAQCBzdGF0aWMgaW5s
aW5lIHVuc2lnbmVkIGxvbmcgcmRnc3NoYWRvdyh2b2lkKQogCiBzdGF0aWMg
aW5saW5lIHZvaWQgd3Jmc2Jhc2UodW5zaWduZWQgbG9uZyBiYXNlKQogewot
ICAgIGlmICggY3B1X2hhc19mc2dzYmFzZSApCisgICAgaWYgKCByZWFkX2Ny
NCgpICYgWDg2X0NSNF9GU0dTQkFTRSApCiAjaWZkZWYgSEFWRV9BU19GU0dT
QkFTRQogICAgICAgICBhc20gdm9sYXRpbGUgKCAid3Jmc2Jhc2UgJTAiIDo6
ICJyIiAoYmFzZSkgKTsKICNlbHNlCkBAIC0yMDQsNyArMjEyLDcgQEAgc3Rh
dGljIGlubGluZSB2b2lkIHdyZnNiYXNlKHVuc2lnbmVkIGxvbmcgYmFzZSkK
IAogc3RhdGljIGlubGluZSB2b2lkIHdyZ3NiYXNlKHVuc2lnbmVkIGxvbmcg
YmFzZSkKIHsKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jhc2UgKQorICAgIGlm
ICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0UgKQogI2lmZGVmIEhB
VkVfQVNfRlNHU0JBU0UKICAgICAgICAgYXNtIHZvbGF0aWxlICggIndyZ3Ni
YXNlICUwIiA6OiAiciIgKGJhc2UpICk7CiAjZWxzZQpAQCAtMjE2LDcgKzIy
NCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB3cmdzYmFzZSh1bnNpZ25lZCBs
b25nIGJhc2UpCiAKIHN0YXRpYyBpbmxpbmUgdm9pZCB3cmdzc2hhZG93KHVu
c2lnbmVkIGxvbmcgYmFzZSkKIHsKLSAgICBpZiAoIGNwdV9oYXNfZnNnc2Jh
c2UgKQorICAgIGlmICggcmVhZF9jcjQoKSAmIFg4Nl9DUjRfRlNHU0JBU0Ug
KQogICAgIHsKICAgICAgICAgYXNtIHZvbGF0aWxlICggInN3YXBnc1xuXHQi
CiAjaWZkZWYgSEFWRV9BU19GU0dTQkFTRQpkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaCBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvcHJvY2Vzc29yLmgKaW5kZXggZGYwMWFlMy4uZjMyNzVjYSAxMDA2NDQK
LS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaAorKysgYi94
ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nlc3Nvci5oCkBAIC0zMDQsMTEgKzMw
NCwzMSBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGxvbmcgcmVhZF9jcjQo
dm9pZCkKIAogc3RhdGljIGlubGluZSB2b2lkIHdyaXRlX2NyNCh1bnNpZ25l
ZCBsb25nIHZhbCkKIHsKKyAgICBzdHJ1Y3QgY3B1X2luZm8gKmluZm8gPSBn
ZXRfY3B1X2luZm8oKTsKKwogICAgIC8qIE5vIGdsb2JhbCBwYWdlcyBpbiBj
YXNlIG9mIFBDSURzIGVuYWJsZWQhICovCiAgICAgQVNTRVJUKCEodmFsICYg
WDg2X0NSNF9QR0UpIHx8ICEodmFsICYgWDg2X0NSNF9QQ0lERSkpOwogCi0g
ICAgZ2V0X2NwdV9pbmZvKCktPmNyNCA9IHZhbDsKLSAgICBhc20gdm9sYXRp
bGUgKCAibW92ICUwLCUlY3I0IiA6IDogInIiICh2YWwpICk7CisgICAgLyoK
KyAgICAgKiBPbiBoYXJkd2FyZSBzdXBwb3J0aW5nIEZTR1NCQVNFLCB0aGUg
dmFsdWUgaW4gJWNyNCBpcyB0aGUga2VybmVsJ3MKKyAgICAgKiBjaG9pY2Ug
Zm9yIDY0Yml0IFBWIGd1ZXN0cywgd2hpY2ggaW1wYWN0cyB3aGV0aGVyIFhl
biBjYW4gdXNlIHRoZQorICAgICAqIGluc3RydWN0aW9ucy4KKyAgICAgKgor
ICAgICAqIFRoZSB7cmQsd3J9e2ZzLGdzfWJhc2UoKSBoZWxwZXJzIHVzZSBp
bmZvLT5jcjQgdG8gd29yayBvdXQgd2hldGhlciBpdAorICAgICAqIGlzIHNh
ZmUgdG8gZXhlY3V0ZSB0aGUge1JELFdSfXtGUyxHU31CQVNFIGluc3RydWN0
aW9uLCBmYWxsaW5nIGJhY2sgdG8KKyAgICAgKiB0aGUgTVNSIHBhdGggaWYg
bm90LiAgU29tZSB1c2VycyByZXF1aXJlIGludGVycnVwdCBzYWZldHkuCisg
ICAgICoKKyAgICAgKiBJZiBGU0dTQkFTRSBpcyBjdXJyZW50bHkgb3IgYWJv
dXQgdG8gYmVjb21lIGNsZWFyLCByZWZsZWN0IHRoaXMgaW4KKyAgICAgKiBp
bmZvLT5jcjQgYmVmb3JlIHVwZGF0aW5nICVjcjQsIHNvIGFuIGludGVycnVw
dCB3aGljaCBoaXRzIGluIHRoZQorICAgICAqIG1pZGRsZSB3b24ndCBvYnNl
cnZlIEZTR1NCQVNFIHNldCBpbiBpbmZvLT5jcjQgYnV0IGNsZWFyIGluICVj
cjQuCisgICAgICovCisgICAgaW5mby0+Y3I0ID0gdmFsICYgKGluZm8tPmNy
NCB8IH5YODZfQ1I0X0ZTR1NCQVNFKTsKKworICAgIGFzbSB2b2xhdGlsZSAo
ICJtb3YgJVt2YWxdLCAlJWNyNCIKKyAgICAgICAgICAgICAgICAgICA6ICIr
bSIgKGluZm8tPmNyNCkgLyogRm9yY2Ugb3JkZXJpbmcgd2l0aG91dCBhIGJh
cnJpZXIuICovCisgICAgICAgICAgICAgICAgICAgOiBbdmFsXSAiciIgKHZh
bCkgKTsKKworICAgIGluZm8tPmNyNCA9IHZhbDsKIH0KIAogLyogQ2xlYXIg
YW5kIHNldCAnVFMnIGJpdCByZXNwZWN0aXZlbHkgKi8K

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


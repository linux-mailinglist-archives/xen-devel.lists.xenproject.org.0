Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 30EBE2B034
	for <lists+xen-devel@lfdr.de>; Mon, 27 May 2019 10:30:51 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVAyy-0004LQ-Ua; Mon, 27 May 2019 08:27:48 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Vl5o=T3=intel.com=chao.gao@srs-us1.protection.inumbo.net>)
 id 1hVAyx-0004K7-Da
 for xen-devel@lists.xenproject.org; Mon, 27 May 2019 08:27:47 +0000
X-Inumbo-ID: 4deb591e-8059-11e9-8980-bc764e045a96
Received: from mga12.intel.com (unknown [192.55.52.136])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 4deb591e-8059-11e9-8980-bc764e045a96;
 Mon, 27 May 2019 08:27:46 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga005.jf.intel.com ([10.7.209.41])
 by fmsmga106.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 27 May 2019 01:27:45 -0700
X-ExtLoop1: 1
Received: from gao-cwp.sh.intel.com ([10.239.159.26])
 by orsmga005.jf.intel.com with ESMTP; 27 May 2019 01:27:44 -0700
From: Chao Gao <chao.gao@intel.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 27 May 2019 16:31:30 +0800
Message-Id: <1558945891-3015-10-git-send-email-chao.gao@intel.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1558945891-3015-1-git-send-email-chao.gao@intel.com>
References: <1558945891-3015-1-git-send-email-chao.gao@intel.com>
Subject: [Xen-devel] [PATCH v7 09/10] microcode: remove microcode_update_lock
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Sergey Dyasli <sergey.dyasli@citrix.com>, Ashok Raj <ashok.raj@intel.com>,
 Wei Liu <wl@xen.org>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Jan Beulich <jbeulich@suse.com>, Chao Gao <chao.gao@intel.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

bWljcm9jb2RlX3VwZGF0ZV9sb2NrIGlzIHRvIHByZXZlbnQgbG9naWMgdGhyZWFkcyBvZiBhIHNh
bWUgY29yZSBmcm9tCnVwZGF0aW5nIG1pY3JvY29kZSBhdCB0aGUgc2FtZSB0aW1lLiBCdXQgZHVl
IHRvIHVzaW5nIGEgZ2xvYmFsIGxvY2ssIGl0CmFsc28gcHJldmVudGVkIHBhcmFsbGVsIG1pY3Jv
Y29kZSB1cGRhdGluZyBvbiBkaWZmZXJlbnQgY29yZXMuCgpSZW1vdmUgdGhpcyBsb2NrIGluIG9y
ZGVyIHRvIHVwZGF0ZSBtaWNyb2NvZGUgaW4gcGFyYWxsZWwuIEl0IGlzIHNhZmUKYmVjYXVzZSB3
ZSBoYXZlIGFscmVhZHkgZW5zdXJlZCBzZXJpYWxpemF0aW9uIG9mIHNpYmxpbmcgdGhyZWFkcyBh
dCB0aGUKY2FsbGVyIHNpZGUuCjEuRm9yIGxhdGUgbWljcm9jb2RlIHVwZGF0ZSwgZG9fbWljcm9j
b2RlX3VwZGF0ZSgpIGVuc3VyZXMgdGhhdCBvbmx5IG9uZQogIHNpYmlsaW5nIHRocmVhZCBvZiBh
IGNvcmUgY2FuIHVwZGF0ZSBtaWNyb2NvZGUuCjIuRm9yIG1pY3JvY29kZSB1cGRhdGUgZHVyaW5n
IHN5c3RlbSBzdGFydHVwIG9yIENQVS1ob3RwbHVnLAogIG1pY3JvY29kZV9tdXRleCgpIGd1YXJh
bnRlZXMgdXBkYXRlIHNlcmlhbGl6YXRpb24gb2YgbG9naWNhbCB0aHJlYWRzLgozLmdldC9wdXRf
Y3B1X2JpdG1hcHMoKSBwcmV2ZW50cyB0aGUgY29uY3VycmVuY3kgb2YgQ1BVLWhvdHBsdWcgYW5k
CiAgbGF0ZSBtaWNyb2NvZGUgdXBkYXRlLgoKTm90ZSB0aGF0IHByaW50ayBpbiBhcHBseV9taWNy
b2NvZGUoKSBhbmQgc3ZtX2hvc3Rfb3N2bV9pbml0KCkgKGZvciBBTUQKb25seSkgYXJlIHN0aWxs
IHByb2Nlc3NlZCBzZXF1ZW50aWFsbHkuCgpTaWduZWQtb2ZmLWJ5OiBDaGFvIEdhbyA8Y2hhby5n
YW9AaW50ZWwuY29tPgotLS0KQ2hhbmdlcyBpbiB2NzoKIC0gcmV3b3JrZWQuIFJlbW92ZSBjb21w
bGV4IGxvY2sgbG9naWNzIGludHJvZHVjZWQgaW4gdjUgYW5kIHY2LiBUaGUgbWljcm9jb2RlCiBw
YXRjaCB0byBiZSBhcHBsaWVkIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB3aXRob3V0IGFueSBn
bG9iYWwgdmFyaWFibGUuIFRodXMKIG5vIGxvY2sgaXMgYWRkZWQgdG8gc2VyaWFsaXplIHBvdGVu
dGlhbCByZWFkZXJzL3dyaXRlcnMuIENhbGxlcnMgb2YKIGFwcGx5X21pY3JvY29kZSgpIHdpbGwg
Z3VhcmFudGVlIHRoZSBjb3JyZWN0bmVzczogdGhlIHBhdGNoIHBvbmludGVkIGJ5IHRoZQogYXJn
dW1lbnRzIHdvbid0IGJlIGNoYW5nZWQgYnkgb3RoZXJzLgoKQ2hhbmdlcyBpbiB2NjoKIC0gaW50
cm9kdWNlIGVhcmx5X3Vjb2RlX3VwZGF0ZV9sb2NrIHRvIHNlcmlhbGl6ZSBlYXJseSB1Y29kZSB1
cGRhdGUuCgpDaGFuZ2VzIGluIHY1OgogLSBuZXdseSBhZGQKLS0tCiB4ZW4vYXJjaC94ODYvbWlj
cm9jb2RlX2FtZC5jICAgfCA4ICstLS0tLS0tCiB4ZW4vYXJjaC94ODYvbWljcm9jb2RlX2ludGVs
LmMgfCA4ICstLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDIgaW5zZXJ0aW9ucygrKSwgMTQgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9hbWQuYyBiL3hl
bi9hcmNoL3g4Ni9taWNyb2NvZGVfYW1kLmMKaW5kZXggYzgxOTAyOC4uYjY0YTU4ZCAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9hbWQuYworKysgYi94ZW4vYXJjaC94ODYvbWlj
cm9jb2RlX2FtZC5jCkBAIC03NCw5ICs3NCw2IEBAIHN0cnVjdCBtcGJoZHIgewogICAgIHVpbnQ4
X3QgZGF0YVtdOwogfTsKIAotLyogc2VyaWFsaXplIGFjY2VzcyB0byB0aGUgcGh5c2ljYWwgd3Jp
dGUgKi8KLXN0YXRpYyBERUZJTkVfU1BJTkxPQ0sobWljcm9jb2RlX3VwZGF0ZV9sb2NrKTsKLQog
LyogU2VlIGNvbW1lbnQgaW4gc3RhcnRfdXBkYXRlKCkgZm9yIGNhc2VzIHdoZW4gdGhpcyByb3V0
aW5lIGZhaWxzICovCiBzdGF0aWMgaW50IGNvbGxlY3RfY3B1X2luZm8oc3RydWN0IGNwdV9zaWdu
YXR1cmUgKmNzaWcpCiB7CkBAIC0yNTEsNyArMjQ4LDYgQEAgc3RhdGljIGVudW0gbWljcm9jb2Rl
X21hdGNoX3Jlc3VsdCBjb21wYXJlX3BhdGNoKAogCiBzdGF0aWMgaW50IGFwcGx5X21pY3JvY29k
ZShjb25zdCBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICpwYXRjaCkKIHsKLSAgICB1bnNpZ25lZCBs
b25nIGZsYWdzOwogICAgIHVpbnQzMl90IHJldjsKICAgICBpbnQgaHdfZXJyOwogICAgIHVuc2ln
bmVkIGludCBjcHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7CkBAIC0yNjMsMTUgKzI1OSwxMyBAQCBz
dGF0aWMgaW50IGFwcGx5X21pY3JvY29kZShjb25zdCBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICpw
YXRjaCkKIAogICAgIGhkciA9IHBhdGNoLT5tY19hbWQtPm1wYjsKIAotICAgIHNwaW5fbG9ja19p
cnFzYXZlKCZtaWNyb2NvZGVfdXBkYXRlX2xvY2ssIGZsYWdzKTsKKyAgICBCVUdfT04obG9jYWxf
aXJxX2lzX2VuYWJsZWQoKSk7CiAKICAgICBod19lcnIgPSB3cm1zcl9zYWZlKE1TUl9BTURfUEFU
Q0hMT0FERVIsICh1bnNpZ25lZCBsb25nKWhkcik7CiAKICAgICAvKiBnZXQgcGF0Y2ggaWQgYWZ0
ZXIgcGF0Y2hpbmcgKi8KICAgICByZG1zcmwoTVNSX0FNRF9QQVRDSExFVkVMLCByZXYpOwogCi0g
ICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmbWljcm9jb2RlX3VwZGF0ZV9sb2NrLCBmbGFncyk7
Ci0KICAgICAvKgogICAgICAqIFNvbWUgcHJvY2Vzc29ycyBsZWF2ZSB0aGUgdWNvZGUgYmxvYiBt
YXBwaW5nIGFzIFVDIGFmdGVyIHRoZSB1cGRhdGUuCiAgICAgICogRmx1c2ggdGhlIG1hcHBpbmcg
dG8gcmVnYWluIG5vcm1hbCBjYWNoZWFiaWxpdHkuCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYv
bWljcm9jb2RlX2ludGVsLmMgYi94ZW4vYXJjaC94ODYvbWljcm9jb2RlX2ludGVsLmMKaW5kZXgg
YmZiNDhjZS4uOTRhMTU2MSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9pbnRl
bC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9taWNyb2NvZGVfaW50ZWwuYwpAQCAtOTMsOSArOTMsNiBA
QCBzdHJ1Y3QgZXh0ZW5kZWRfc2lndGFibGUgewogCiAjZGVmaW5lIGV4dHRhYmxlX3NpemUoZXQp
ICgoZXQpLT5jb3VudCAqIEVYVF9TSUdOQVRVUkVfU0laRSArIEVYVF9IRUFERVJfU0laRSkKIAot
Lyogc2VyaWFsaXplIGFjY2VzcyB0byB0aGUgcGh5c2ljYWwgd3JpdGUgdG8gTVNSIDB4NzkgKi8K
LXN0YXRpYyBERUZJTkVfU1BJTkxPQ0sobWljcm9jb2RlX3VwZGF0ZV9sb2NrKTsKLQogc3RhdGlj
IGludCBjb2xsZWN0X2NwdV9pbmZvKHN0cnVjdCBjcHVfc2lnbmF0dXJlICpjc2lnKQogewogICAg
IHVuc2lnbmVkIGludCBjcHVfbnVtID0gc21wX3Byb2Nlc3Nvcl9pZCgpOwpAQCAtMjk1LDcgKzI5
Miw2IEBAIHN0YXRpYyBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICphbGxvd19taWNyb2NvZGVfcGF0
Y2goCiAKIHN0YXRpYyBpbnQgYXBwbHlfbWljcm9jb2RlKGNvbnN0IHN0cnVjdCBtaWNyb2NvZGVf
cGF0Y2ggKnBhdGNoKQogewotICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgdWludDY0X3Qg
bXNyX2NvbnRlbnQ7CiAgICAgdW5zaWduZWQgaW50IHZhbFsyXTsKICAgICB1bnNpZ25lZCBpbnQg
Y3B1X251bSA9IHJhd19zbXBfcHJvY2Vzc29yX2lkKCk7CkBAIC0zMDcsOCArMzAzLDcgQEAgc3Rh
dGljIGludCBhcHBseV9taWNyb2NvZGUoY29uc3Qgc3RydWN0IG1pY3JvY29kZV9wYXRjaCAqcGF0
Y2gpCiAKICAgICBtY19pbnRlbCA9IHBhdGNoLT5tY19pbnRlbDsKIAotICAgIC8qIHNlcmlhbGl6
ZSBhY2Nlc3MgdG8gdGhlIHBoeXNpY2FsIHdyaXRlIHRvIE1TUiAweDc5ICovCi0gICAgc3Bpbl9s
b2NrX2lycXNhdmUoJm1pY3JvY29kZV91cGRhdGVfbG9jaywgZmxhZ3MpOworICAgIEJVR19PTihs
b2NhbF9pcnFfaXNfZW5hYmxlZCgpKTsKIAogICAgIC8qCiAgICAgICogV3JpdGViYWNrIGFuZCBp
bnZhbGlkYXRlIGNhY2hlcyBiZWZvcmUgdXBkYXRpbmcgbWljcm9jb2RlIHRvIGF2b2lkCkBAIC0z
MjcsNyArMzIyLDYgQEAgc3RhdGljIGludCBhcHBseV9taWNyb2NvZGUoY29uc3Qgc3RydWN0IG1p
Y3JvY29kZV9wYXRjaCAqcGF0Y2gpCiAgICAgcmRtc3JsKE1TUl9JQTMyX1VDT0RFX1JFViwgbXNy
X2NvbnRlbnQpOwogICAgIHZhbFsxXSA9ICh1aW50MzJfdCkobXNyX2NvbnRlbnQgPj4gMzIpOwog
Ci0gICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmbWljcm9jb2RlX3VwZGF0ZV9sb2NrLCBmbGFn
cyk7CiAgICAgaWYgKCB2YWxbMV0gIT0gbWNfaW50ZWwtPmhkci5yZXYgKQogICAgIHsKICAgICAg
ICAgcHJpbnRrKEtFUk5fRVJSICJtaWNyb2NvZGU6IENQVSVkIHVwZGF0ZSBmcm9tIHJldmlzaW9u
ICIKLS0gCjEuOC4zLjEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0
Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRl
dmVs

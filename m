Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id A70F7F5384
	for <lists+xen-devel@lfdr.de>; Fri,  8 Nov 2019 19:27:23 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iT8vd-00053r-WB; Fri, 08 Nov 2019 18:24:13 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Sqa0=ZA=oracle.com=joe.jin@srs-us1.protection.inumbo.net>)
 id 1iT8vc-00053l-07
 for xen-devel@lists.xenproject.org; Fri, 08 Nov 2019 18:24:12 +0000
X-Inumbo-ID: f551fefe-0254-11ea-a1d6-12813bfff9fa
Received: from aserp2120.oracle.com (unknown [141.146.126.78])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id f551fefe-0254-11ea-a1d6-12813bfff9fa;
 Fri, 08 Nov 2019 18:24:10 +0000 (UTC)
Received: from pps.filterd (aserp2120.oracle.com [127.0.0.1])
 by aserp2120.oracle.com (8.16.0.27/8.16.0.27) with SMTP id xA8IO51r046533;
 Fri, 8 Nov 2019 18:24:05 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=oracle.com;
 h=subject : to : cc :
 references : from : message-id : date : mime-version : in-reply-to :
 content-type : content-transfer-encoding; s=corp-2019-08-05;
 bh=0kbNkeLPvjVEENhU1B6t2zkQos77UOlEYTTUhDk47C4=;
 b=EnFJOE/aflRaBR9wAbYcB6XzCPsXe/zvUzXhEbaRKy/tIsEqgLTQR5RAsLo2xradZHg4
 DgHB2F5zHJsEl6soeJKNqmX5OnwiAo67KfVpXXTvCYIeGAZ7KVCgNJLB/T6SietMs+e3
 LccwWRcat7HcMc0axsn87lLRSiXoIzYZzyXWwGZZjWcORB9cZTzlDXdPJo2EOTseHgNW
 ntyCflB3laM8jNzprZJLR84UrmuzA3eCUHvALqfZdxx2+zPS0s//rAnF1N/kqJDxVqA8
 XPDdT3YX1Ztmrs0+Uk3rZibyYUUOVNtMklk3Nq64dBofGMJqUwT0JM5NCOims+gwuwe7 Ig== 
Received: from aserp3020.oracle.com (aserp3020.oracle.com [141.146.126.70])
 by aserp2120.oracle.com with ESMTP id 2w41w16xyy-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Fri, 08 Nov 2019 18:24:04 +0000
Received: from pps.filterd (aserp3020.oracle.com [127.0.0.1])
 by aserp3020.oracle.com (8.16.0.27/8.16.0.27) with SMTP id xA8INJ8Z186824;
 Fri, 8 Nov 2019 18:24:04 GMT
Received: from userv0122.oracle.com (userv0122.oracle.com [156.151.31.75])
 by aserp3020.oracle.com with ESMTP id 2w4k33myj7-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Fri, 08 Nov 2019 18:24:03 +0000
Received: from abhmp0001.oracle.com (abhmp0001.oracle.com [141.146.116.7])
 by userv0122.oracle.com (8.14.4/8.14.4) with ESMTP id xA8IO1eR026563;
 Fri, 8 Nov 2019 18:24:01 GMT
Received: from [10.211.46.60] (/10.211.46.60)
 by default (Oracle Beehive Gateway v4.0)
 with ESMTP ; Fri, 08 Nov 2019 10:24:01 -0800
To: Roger Pau Monne <roger.pau@citrix.com>, xen-devel@lists.xenproject.org
References: <20191108133414.96381-1-roger.pau@citrix.com>
From: Joe Jin <joe.jin@oracle.com>
Message-ID: <8e5c0ad8-9264-3dfd-c468-694c2cf4435f@oracle.com>
Date: Fri, 8 Nov 2019 10:23:59 -0800
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:60.0)
 Gecko/20100101 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20191108133414.96381-1-roger.pau@citrix.com>
Content-Language: en-US
X-Proofpoint-Virus-Version: vendor=nai engine=6000 definitions=9435
 signatures=668685
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0 suspectscore=0
 malwarescore=0
 phishscore=0 bulkscore=0 spamscore=0 mlxscore=0 mlxlogscore=999
 adultscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.0.1-1910280000 definitions=main-1911080180
X-Proofpoint-Virus-Version: vendor=nai engine=6000 definitions=9435
 signatures=668685
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0
 priorityscore=1501 malwarescore=0
 suspectscore=0 phishscore=0 bulkscore=0 spamscore=0 clxscore=1015
 lowpriorityscore=0 mlxscore=0 impostorscore=0 mlxlogscore=999 adultscore=0
 classifier=spam adjust=0 reason=mlx scancount=1 engine=8.0.1-1910280000
 definitions=main-1911080179
Subject: Re: [Xen-devel] [PATCH for-4.13 v3] x86/passthrough: fix migration
 of MSI when using posted interrupts
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Kevin Tian <kevin.tian@intel.com>, Wei Liu <wl@xen.org>,
 Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBwYXRjaCBzeW5jZWQgUElSUiB3aXRoIElSUiB3aGVuIG1pc3ggdGFibGUgdXBkYXRlZCwg
SSByYW4gc2FtZSB0ZXN0IApvdmVyIDEuNSBob3VycyBhbmQgZGlkIG5vdCByZXByb2R1Y2VkIGl0
LCB3aXRob3V0IHRoZSBwYXRjaCwgSSBjb3VsZApyZXByb2R1Y2VkIHdpdGhpbiAxMCBtaW51dGVz
LgoKVGVzdGVkLWJ5OiBKb2UgSmluIDxqb2UuamluQG9yYWNsZS5jb20+CgpUaGFua3MsCkpvZQoK
T24gMTEvOC8xOSA1OjM0IEFNLCBSb2dlciBQYXUgTW9ubmUgd3JvdGU6Cj4gV2hlbiB1c2luZyBw
b3N0ZWQgaW50ZXJydXB0cyBhbmQgdGhlIGd1ZXN0IG1pZ3JhdGVzIE1TSSBmcm9tIHZDUFVzIFhl
bgo+IG5lZWRzIHRvIGZsdXNoIGFueSBwZW5kaW5nIFBJUlIgdmVjdG9ycyBvbiB0aGUgcHJldmlv
dXMgdkNQVSwgb3IgZWxzZQo+IHRob3NlIHZlY3RvcnMgY291bGQgZ2V0IHdyb25nbHkgaW5qZWN0
ZWQgYXQgYSBsYXRlciBwb2ludCB3aGVuIHRoZSBNU0kKPiBmaWVsZHMgYXJlIGFscmVhZHkgdXBk
YXRlZC4KPiAKPiBSZW5hbWUgc3luY19waXJfdG9faXJyIHRvIHZsYXBpY19zeW5jX3Bpcl90b19p
cnIgYW5kIGV4cG9ydCBpdCBzbyBpdAo+IGNhbiBiZSBjYWxsZWQgd2hlbiB1cGRhdGluZyB0aGUg
YmluZGluZyBvZiBwaHlzaWNhbCBpbnRlcnJ1cHRzIHRvCj4gZ3Vlc3RzLgo+IAo+IE5vdGUgdGhh
dCBQSVJSIGlzIHN5bmNlZCB0byBJUlIgYm90aCBpbiBwdF9pcnFfZGVzdHJveV9iaW5kIGFuZAo+
IHB0X2lycV9jcmVhdGVfYmluZCB3aGVuIHRoZSBpbnRlcnJ1cHQgZGVsaXZlcnkgZGF0YSBpcyBi
ZWluZyB1cGRhdGVkLgo+IAo+IEFsc28gc3RvcmUgdGhlIHZDUFUgSUQgaW4gbXVsdGktZGVzdGlu
YXRpb24gbW9kZSB3aGVuIHVzaW5nIHBvc3RlZAo+IGludGVycnVwdHMgc28gdGhhdCB0aGUgaW50
ZXJydXB0IGlzIGFsd2F5cyBpbmplY3RlZCB0byBhIGtub3duIHZDUFUgaW4KPiBvcmRlciB0byBi
ZSBhYmxlIHRvIGZsdXNoIHRoZSBQSVJSIHdoZW4gbW9kaWZ5aW5nIHRoZSBiaW5kaW5nLgo+IAo+
IFJlcG9ydGVkLWJ5OiBKb2UgSmluIDxqb2UuamluQG9yYWNsZS5jb20+Cj4gU2lnbmVkLW9mZi1i
eTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+Cj4gLS0tCj4gQ2M6IEpv
ZSBKaW4gPGpvZS5qaW5Ab3JhY2xlLmNvbT4KPiBDYzogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1
c2UuY29tPgo+IC0tLQo+IEkgd291bGQgbGlrZSB0byBzZWUgYSBidWcgZml4IGZvciB0aGlzIGlz
c3VlIGluIDQuMTMuIFRoZSBmaXggaGVyZSBvbmx5Cj4gYWZmZWN0cyBwb3N0ZWQgaW50ZXJydXB0
cywgaGVuY2UgSSB0aGluayB0aGUgcmlzayBvZiBicmVha2luZyBhbnl0aGluZwo+IGVsc2UgaXMg
bG93Lgo+IC0tLQo+IENoYW5nZXMgc2luY2UgdjI6Cj4gIC0gQWxzbyBzeW5jIFBJUlIgd2l0aCBJ
UlIgd2hlbiB1c2luZyBDUFUgcG9zdGVkIGludGVycnVwdHMuCj4gIC0gRm9yY2UgdGhlIHNlbGVj
dGlvbiBvZiBhIHNwZWNpZmljIHZDUFUgd2hlbiB1c2luZyBwb3N0ZWQgaW50ZXJydXB0cwo+ICAg
IGZvciBtdWx0aS1kZXN0Lgo+ICAtIENoYW5nZSB2bXNpX2RlbGl2ZXJfcGlycSB0byBob25vciBk
ZXN0X3ZjcHVfaWQuCj4gCj4gQ2hhbmdlcyBzaW5jZSB2MToKPiAgLSBTdG9yZSB0aGUgdmNwdSBp
ZCBhbHNvIGluIG11bHRpLWRlc3QgbW9kZSBpZiB0aGUgaW50ZXJydXB0IGlzIGJvdW5kCj4gICAg
dG8gYSB2Y3B1IGZvciBwb3N0ZWQgZGVsaXZlcnkuCj4gIC0gcy8jaWYvI2lmZGVmLy4KPiAtLS0K
PiAgeGVuL2FyY2gveDg2L2h2bS92bGFwaWMuYyAgICAgICAgfCAgNiArKystLS0KPiAgeGVuL2Fy
Y2gveDg2L2h2bS92bXNpLmMgICAgICAgICAgfCAxMSArKysrKysrKysrLQo+ICB4ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9pby5jICAgICB8IDI5ICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0t
Cj4gIHhlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZsYXBpYy5oIHwgIDIgKysKPiAgNCBmaWxlcyBj
aGFuZ2VkLCAzOCBpbnNlcnRpb25zKCspLCAxMCBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L2h2bS92bGFwaWMuYyBiL3hlbi9hcmNoL3g4Ni9odm0vdmxhcGljLmMK
PiBpbmRleCA5NDY2MjU4ZDZmLi5kMjU1YWQ4ZGI3IDEwMDY0NAo+IC0tLSBhL3hlbi9hcmNoL3g4
Ni9odm0vdmxhcGljLmMKPiArKysgYi94ZW4vYXJjaC94ODYvaHZtL3ZsYXBpYy5jCj4gQEAgLTEw
Niw3ICsxMDYsNyBAQCBzdGF0aWMgdm9pZCB2bGFwaWNfY2xlYXJfaXJyKGludCB2ZWN0b3IsIHN0
cnVjdCB2bGFwaWMgKnZsYXBpYykKPiAgICAgIHZsYXBpY19jbGVhcl92ZWN0b3IodmVjdG9yLCAm
dmxhcGljLT5yZWdzLT5kYXRhW0FQSUNfSVJSXSk7Cj4gIH0KPiAgCj4gLXN0YXRpYyB2b2lkIHN5
bmNfcGlyX3RvX2lycihzdHJ1Y3QgdmNwdSAqdikKPiArdm9pZCB2bGFwaWNfc3luY19waXJfdG9f
aXJyKHN0cnVjdCB2Y3B1ICp2KQo+ICB7Cj4gICAgICBpZiAoIGh2bV9mdW5jcy5zeW5jX3Bpcl90
b19pcnIgKQo+ICAgICAgICAgIGFsdGVybmF0aXZlX3ZjYWxsKGh2bV9mdW5jcy5zeW5jX3Bpcl90
b19pcnIsIHYpOwo+IEBAIC0xMTQsNyArMTE0LDcgQEAgc3RhdGljIHZvaWQgc3luY19waXJfdG9f
aXJyKHN0cnVjdCB2Y3B1ICp2KQo+ICAKPiAgc3RhdGljIGludCB2bGFwaWNfZmluZF9oaWdoZXN0
X2lycihzdHJ1Y3QgdmxhcGljICp2bGFwaWMpCj4gIHsKPiAtICAgIHN5bmNfcGlyX3RvX2lycih2
bGFwaWNfdmNwdSh2bGFwaWMpKTsKPiArICAgIHZsYXBpY19zeW5jX3Bpcl90b19pcnIodmxhcGlj
X3ZjcHUodmxhcGljKSk7Cj4gIAo+ICAgICAgcmV0dXJuIHZsYXBpY19maW5kX2hpZ2hlc3RfdmVj
dG9yKCZ2bGFwaWMtPnJlZ3MtPmRhdGFbQVBJQ19JUlJdKTsKPiAgfQo+IEBAIC0xNDkzLDcgKzE0
OTMsNyBAQCBzdGF0aWMgaW50IGxhcGljX3NhdmVfcmVncyhzdHJ1Y3QgdmNwdSAqdiwgaHZtX2Rv
bWFpbl9jb250ZXh0X3QgKmgpCj4gICAgICBpZiAoICFoYXNfdmxhcGljKHYtPmRvbWFpbikgKQo+
ICAgICAgICAgIHJldHVybiAwOwo+ICAKPiAtICAgIHN5bmNfcGlyX3RvX2lycih2KTsKPiArICAg
IHZsYXBpY19zeW5jX3Bpcl90b19pcnIodik7Cj4gIAo+ICAgICAgcmV0dXJuIGh2bV9zYXZlX2Vu
dHJ5KExBUElDX1JFR1MsIHYtPnZjcHVfaWQsIGgsIHZjcHVfdmxhcGljKHYpLT5yZWdzKTsKPiAg
fQo+IGRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3Ztc2kuYyBiL3hlbi9hcmNoL3g4Ni9o
dm0vdm1zaS5jCj4gaW5kZXggNjU5N2Q5ZjcxOS4uZmU0ODhjY2M3ZCAxMDA2NDQKPiAtLS0gYS94
ZW4vYXJjaC94ODYvaHZtL3Ztc2kuYwo+ICsrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm1zaS5jCj4g
QEAgLTExOCw3ICsxMTgsMTYgQEAgdm9pZCB2bXNpX2RlbGl2ZXJfcGlycShzdHJ1Y3QgZG9tYWlu
ICpkLCBjb25zdCBzdHJ1Y3QgaHZtX3BpcnFfZHBjaSAqcGlycV9kcGNpKQo+ICAKPiAgICAgIEFT
U0VSVChwaXJxX2RwY2ktPmZsYWdzICYgSFZNX0lSUV9EUENJX0dVRVNUX01TSSk7Cj4gIAo+IC0g
ICAgdm1zaV9kZWxpdmVyKGQsIHZlY3RvciwgZGVzdCwgZGVzdF9tb2RlLCBkZWxpdmVyeV9tb2Rl
LCB0cmlnX21vZGUpOwo+ICsgICAgaWYgKCBodm1fZnVuY3MuZGVsaXZlcl9wb3N0ZWRfaW50ciAm
JiBwaXJxX2RwY2ktPmdtc2kuZGVzdF92Y3B1X2lkICE9IC0xICkKPiArICAgICAgICAvKgo+ICsg
ICAgICAgICAqIFdoZW4gdXNpbmcgcG9zdGVkIGludGVycnVwdHMgbXVsdGktZGVzdGluYXRpb24g
ZGVsaXZlcnkgbW9kZSBpcwo+ICsgICAgICAgICAqIGZvcmNlZCB0byBzZWxlY3QgYSBzcGVjaWZp
YyB2Q1BVIHNvIHRoYXQgdGhlIFBJUlIgY2FuIGJlIHN5bmNlZCBpbnRvCj4gKyAgICAgICAgICog
SVJSIHdoZW4gdGhlIGludGVycnVwdCBpcyBkZXN0cm95ZWQgb3IgbW92ZWQuCj4gKyAgICAgICAg
ICovCj4gKyAgICAgICAgdm1zaV9pbmpfaXJxKHZjcHVfdmxhcGljKGQtPnZjcHVbcGlycV9kcGNp
LT5nbXNpLmRlc3RfdmNwdV9pZF0pLAo+ICsgICAgICAgICAgICAgICAgICAgICB2ZWN0b3IsIHRy
aWdfbW9kZSwgZGVsaXZlcnlfbW9kZSk7Cj4gKyAgICBlbHNlCj4gKyAgICAgICAgdm1zaV9kZWxp
dmVyKGQsIHZlY3RvciwgZGVzdCwgZGVzdF9tb2RlLCBkZWxpdmVyeV9tb2RlLCB0cmlnX21vZGUp
Owo+ICB9Cj4gIAo+ICAvKiBSZXR1cm4gdmFsdWUsIC0xIDogbXVsdGktZGVzdHMsIG5vbi1uZWdh
dGl2ZSB2YWx1ZTogZGVzdF92Y3B1X2lkICovCj4gZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2lvLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pby5jCj4gaW5kZXggYjI5
MmU3OTM4Mi4uZDNmMWFlNWMzOSAxMDA2NDQKPiAtLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9pby5jCj4gKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW8uYwo+IEBAIC0zNDEsNyAr
MzQxLDcgQEAgaW50IHB0X2lycV9jcmVhdGVfYmluZCgKPiAgICAgIHsKPiAgICAgICAgICB1aW50
OF90IGRlc3QsIGRlbGl2ZXJ5X21vZGU7Cj4gICAgICAgICAgYm9vbCBkZXN0X21vZGU7Cj4gLSAg
ICAgICAgaW50IGRlc3RfdmNwdV9pZDsKPiArICAgICAgICBpbnQgZGVzdF92Y3B1X2lkLCBwcmV2
X3ZjcHVfaWQgPSAtMTsKPiAgICAgICAgICBjb25zdCBzdHJ1Y3QgdmNwdSAqdmNwdTsKPiAgICAg
ICAgICB1aW50MzJfdCBnZmxhZ3MgPSBwdF9pcnFfYmluZC0+dS5tc2kuZ2ZsYWdzICYKPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB+WEVOX0RPTUNUTF9WTVNJX1g4Nl9VTk1BU0tFRDsKPiBA
QCAtNDExLDYgKzQxMSw3IEBAIGludCBwdF9pcnFfY3JlYXRlX2JpbmQoCj4gIAo+ICAgICAgICAg
ICAgICAgICAgcGlycV9kcGNpLT5nbXNpLmd2ZWMgPSBwdF9pcnFfYmluZC0+dS5tc2kuZ3ZlYzsK
PiAgICAgICAgICAgICAgICAgIHBpcnFfZHBjaS0+Z21zaS5nZmxhZ3MgPSBnZmxhZ3M7Cj4gKyAg
ICAgICAgICAgICAgICBwcmV2X3ZjcHVfaWQgPSBwaXJxX2RwY2ktPmdtc2kuZGVzdF92Y3B1X2lk
Owo+ICAgICAgICAgICAgICB9Cj4gICAgICAgICAgfQo+ICAgICAgICAgIC8qIENhbGN1bGF0ZSBk
ZXN0X3ZjcHVfaWQgZm9yIE1TSS10eXBlIHBpcnEgbWlncmF0aW9uLiAqLwo+IEBAIC00MjYsMTQg
KzQyNywyNCBAQCBpbnQgcHRfaXJxX2NyZWF0ZV9iaW5kKAo+ICAKPiAgICAgICAgICBwaXJxX2Rw
Y2ktPmdtc2kucG9zdGVkID0gZmFsc2U7Cj4gICAgICAgICAgdmNwdSA9IChkZXN0X3ZjcHVfaWQg
Pj0gMCkgPyBkLT52Y3B1W2Rlc3RfdmNwdV9pZF0gOiBOVUxMOwo+IC0gICAgICAgIGlmICggaW9t
bXVfaW50cG9zdCApCj4gKyAgICAgICAgaWYgKCBodm1fZnVuY3MuZGVsaXZlcl9wb3N0ZWRfaW50
ciAmJiBkZWxpdmVyeV9tb2RlID09IGRlc3RfTG93ZXN0UHJpbyApCj4gICAgICAgICAgewo+IC0g
ICAgICAgICAgICBpZiAoIGRlbGl2ZXJ5X21vZGUgPT0gZGVzdF9Mb3dlc3RQcmlvICkKPiAtICAg
ICAgICAgICAgICAgIHZjcHUgPSB2ZWN0b3JfaGFzaGluZ19kZXN0KGQsIGRlc3QsIGRlc3RfbW9k
ZSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpcnFfZHBj
aS0+Z21zaS5ndmVjKTsKPiArICAgICAgICAgICAgLyoKPiArICAgICAgICAgICAgICogTkI6IHdo
ZW4gdXNpbmcgcG9zdGVkIGludGVycnVwdHMgdGhlIHZlY3RvciBpcyBzaWduYWxlZAo+ICsgICAg
ICAgICAgICAgKiBvbiB0aGUgUElSUiwgYW5kIGhlbmNlIFhlbiBuZWVkcyB0byBmb3JjZSBpbnRl
cnJ1cHRzIHRvIGJlCj4gKyAgICAgICAgICAgICAqIGRlbGl2ZXJlZCB0byBhIHNwZWNpZmljIHZD
UFUgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBzeW5jIFBJUlIKPiArICAgICAgICAgICAgICogd2l0
aCBJUlIgd2hlbiB0aGUgaW50ZXJydXB0IGJpbmRpbmcgaXMgZGVzdHJveWVkLCBvciBlbHNlCj4g
KyAgICAgICAgICAgICAqIHBlbmRpbmcgaW50ZXJydXB0cyBpbiB0aGUgcHJldmlvdXMgdkNQVSBQ
SVJSIGZpZWxkIGNvdWxkIGJlCj4gKyAgICAgICAgICAgICAqIGRlbGl2ZXJlZCBhZnRlciB0aGUg
dXBkYXRlLgo+ICsgICAgICAgICAgICAgKi8KPiArICAgICAgICAgICAgdmNwdSA9IHZlY3Rvcl9o
YXNoaW5nX2Rlc3QoZCwgZGVzdCwgZGVzdF9tb2RlLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwaXJxX2RwY2ktPmdtc2kuZ3ZlYyk7Cj4gICAgICAgICAgICAgIGlm
ICggdmNwdSApCj4gLSAgICAgICAgICAgICAgICBwaXJxX2RwY2ktPmdtc2kucG9zdGVkID0gdHJ1
ZTsKPiArICAgICAgICAgICAgICAgIHBpcnFfZHBjaS0+Z21zaS5kZXN0X3ZjcHVfaWQgPSB2Y3B1
LT52Y3B1X2lkOwo+ICAgICAgICAgIH0KPiArICAgICAgICBpZiAoIGlvbW11X2ludHBvc3QgJiYg
dmNwdSApCj4gKyAgICAgICAgICAgIHBpcnFfZHBjaS0+Z21zaS5wb3N0ZWQgPSB0cnVlOwo+ICsK
PiAgICAgICAgICBpZiAoIHZjcHUgJiYgaXNfaW9tbXVfZW5hYmxlZChkKSApCj4gICAgICAgICAg
ICAgIGh2bV9taWdyYXRlX3BpcnEocGlycV9kcGNpLCB2Y3B1KTsKPiAgCj4gQEAgLTQ0Miw2ICs0
NTMsOSBAQCBpbnQgcHRfaXJxX2NyZWF0ZV9iaW5kKAo+ICAgICAgICAgICAgICBwaV91cGRhdGVf
aXJ0ZSh2Y3B1ID8gJnZjcHUtPmFyY2guaHZtLnZteC5waV9kZXNjIDogTlVMTCwKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW5mbywgcGlycV9kcGNpLT5nbXNpLmd2ZWMpOwo+ICAKPiAr
ICAgICAgICBpZiAoIGh2bV9mdW5jcy5kZWxpdmVyX3Bvc3RlZF9pbnRyICYmIHByZXZfdmNwdV9p
ZCA+PSAwICkKPiArICAgICAgICAgICAgdmxhcGljX3N5bmNfcGlyX3RvX2lycihkLT52Y3B1W3By
ZXZfdmNwdV9pZF0pOwo+ICsKPiAgICAgICAgICBpZiAoIHB0X2lycV9iaW5kLT51Lm1zaS5nZmxh
Z3MgJiBYRU5fRE9NQ1RMX1ZNU0lfWDg2X1VOTUFTS0VEICkKPiAgICAgICAgICB7Cj4gICAgICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gQEAgLTczMSw2ICs3NDUsOSBAQCBpbnQgcHRf
aXJxX2Rlc3Ryb3lfYmluZCgKPiAgICAgIGVsc2UgaWYgKCBwaXJxX2RwY2kgJiYgcGlycV9kcGNp
LT5nbXNpLnBvc3RlZCApCj4gICAgICAgICAgcGlfdXBkYXRlX2lydGUoTlVMTCwgcGlycSwgMCk7
Cj4gIAo+ICsgICAgaWYgKCBodm1fZnVuY3MuZGVsaXZlcl9wb3N0ZWRfaW50ciAmJiBwaXJxX2Rw
Y2ktPmdtc2kuZGVzdF92Y3B1X2lkID49IDAgKQo+ICsgICAgICAgIHZsYXBpY19zeW5jX3Bpcl90
b19pcnIoZC0+dmNwdVtwaXJxX2RwY2ktPmdtc2kuZGVzdF92Y3B1X2lkXSk7Cj4gKwo+ICAgICAg
aWYgKCBwaXJxX2RwY2kgJiYgKHBpcnFfZHBjaS0+ZmxhZ3MgJiBIVk1fSVJRX0RQQ0lfTUFQUEVE
KSAmJgo+ICAgICAgICAgICBsaXN0X2VtcHR5KCZwaXJxX2RwY2ktPmRpZ2xfbGlzdCkgKQo+ICAg
ICAgewo+IGRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS92bGFwaWMuaCBiL3hl
bi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZsYXBpYy5oCj4gaW5kZXggZGRlNjZiNGYwZi4uYjAwMTdk
MWRhZSAxMDA2NDQKPiAtLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS92bGFwaWMuaAo+ICsr
KyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZsYXBpYy5oCj4gQEAgLTE1MCw0ICsxNTAsNiBA
QCBib29sX3QgdmxhcGljX21hdGNoX2Rlc3QoCj4gICAgICBjb25zdCBzdHJ1Y3QgdmxhcGljICp0
YXJnZXQsIGNvbnN0IHN0cnVjdCB2bGFwaWMgKnNvdXJjZSwKPiAgICAgIGludCBzaG9ydF9oYW5k
LCB1aW50MzJfdCBkZXN0LCBib29sX3QgZGVzdF9tb2RlKTsKPiAgCj4gK3ZvaWQgdmxhcGljX3N5
bmNfcGlyX3RvX2lycihzdHJ1Y3QgdmNwdSAqdik7Cj4gKwo+ICAjZW5kaWYgLyogX19BU01fWDg2
X0hWTV9WTEFQSUNfSF9fICovCj4gCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVu
cHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZv
L3hlbi1kZXZlbA==

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 16D9864AE1
	for <lists+xen-devel@lfdr.de>; Wed, 10 Jul 2019 18:44:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hlFdt-0002K5-AB; Wed, 10 Jul 2019 16:40:29 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=5Wp7=VH=citrix.com=paul.durrant@srs-us1.protection.inumbo.net>)
 id 1hlFds-0002K0-ES
 for xen-devel@lists.xenproject.org; Wed, 10 Jul 2019 16:40:28 +0000
X-Inumbo-ID: 6aeb1908-a331-11e9-ab9b-e7750c63a686
Received: from esa1.hc3370-68.iphmx.com (unknown [216.71.145.142])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 6aeb1908-a331-11e9-ab9b-e7750c63a686;
 Wed, 10 Jul 2019 16:40:25 +0000 (UTC)
Authentication-Results: esa1.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=paul.durrant@citrix.com;
 spf=Pass smtp.mailfrom=Paul.Durrant@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa1.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 paul.durrant@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="paul.durrant@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa1.hc3370-68.iphmx.com: domain of
 Paul.Durrant@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="Paul.Durrant@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa1.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: BpSBvDnXEbk1DqN0miqN5IyEIk0MUQaxK8Hdk6qUp8u+WZQFrp4iGEaCcqIFHOLcm8iy62UtAf
 Wt5CDkVlgbgpy493ZcP8cVdgQDrcjUaH5/N/R70wVMuXMuKQHVqICOeAmKmaLUFC8Gq5DbjOU9
 9JIF3JeZ0nqEPE9GZ2x4mFhIW4wcXn85sqTztbMhm3Fo42h7OTkZXWx+mkHohVLb/hhHEgrLdQ
 qAghwmfK22BEbcOpdUIMsdFrSTWeulRtqhhkETQD3NnkIBz4sIiYF4K2RSXGJYUusod+oNRWeX
 MVA=
X-SBRS: 2.7
X-MesageID: 2834654
X-Ironport-Server: esa1.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,475,1557201600"; 
   d="scan'208";a="2834654"
From: Paul Durrant <paul.durrant@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Wed, 10 Jul 2019 17:17:33 +0100
Message-ID: <20190710161733.39119-1-paul.durrant@citrix.com>
X-Mailer: git-send-email 2.20.1.2.gb21ebb671
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH] xen/mm.h: add helper function to test-and-clear
 _PGC_allocated
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Paul Durrant <paul.durrant@citrix.com>,
 Tamas K Lengyel <tamas@tklengyel.com>, Jan Beulich <jbeulich@suse.com>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIF9QR0NfYWxsb2NhdGVkIGZsYWcgaXMgc2V0IG9uIGEgcGFnZSB3aGVuIGl0IGlzIGFzc2ln
bmVkIHRvIGEgZG9tYWluCmFsb25nIHdpdGggYW4gaW5pdGlhbCByZWZlcmVuY2UgY291bnQgb2Yg
MS4gVG8gY2xlYXIgdGhpcyBpbml0aWFsCnJlZmVyZW5jZSBjb3VudCBpdCBpcyBuZWNlc3Nhcnkg
dG8gdGVzdC1hbmQtY2xlYXIgX1BHQ19hbGxvY2F0ZWQgYW5kIHRoZW4Kb25seSBkcm9wIHRoZSBy
ZWZlcmVuY2UgaWYgdGhlIHRlc3QtYW5kLWNsZWFyIHN1Y2NlZWRzLiBUaGlzIGlzIG9wZW4tCmNv
ZGVkIGluIG1hbnkgcGxhY2VzLiBJdCBpcyBhbHNvIHVuc2FmZSB0byB0ZXN0LWFuZC1jbGVhciBf
UEdDX2FsbG9jYXRlZAp1bmxlc3MgdGhlIGNhbGxlciBob2xkcyBhbiBhZGRpdGlvbmFsIHJlZmVy
ZW5jZS4KClRoaXMgcGF0Y2ggYWRkcyBhIGhlbHBlciBmdW5jdGlvbiwgY2xlYXJfYXNzaWdubWVu
dF9yZWZlcmVuY2UoKSwgdG8KcmVwbGFjZSBhbGwgdGhlIG9wZW4tY29kZWQgdGVzdC1hbmQtY2xl
YXIvcHV0X3BhZ2Ugb2NjdXJyZW5jZXMgYW5kCmluY29ycG9yYXRlcyBpbiB0aGF0IGFuIEFTU0VS
VGlvbiB0aGF0IGFuIGFkZGl0aW9uYWwgcGFnZSByZWZlcmVuY2UgaXMKaGVsZC4KClNpZ25lZC1v
ZmYtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNpdHJpeC5jb20+Ci0tLQpDYzogU3Rl
ZmFubyBTdGFiZWxsaW5pIDxzc3RhYmVsbGluaUBrZXJuZWwub3JnPgpDYzogSnVsaWVuIEdyYWxs
IDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KQ2M6IFZvbG9keW15ciBCYWJjaHVrIDxWb2xvZHlteXJf
QmFiY2h1a0BlcGFtLmNvbT4KQ2M6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJp
eC5jb20+CkNjOiBHZW9yZ2UgRHVubGFwIDxHZW9yZ2UuRHVubGFwQGV1LmNpdHJpeC5jb20+CkNj
OiBJYW4gSmFja3NvbiA8aWFuLmphY2tzb25AZXUuY2l0cml4LmNvbT4KQ2M6IEphbiBCZXVsaWNo
IDxqYmV1bGljaEBzdXNlLmNvbT4KQ2M6IEtvbnJhZCBSemVzenV0ZWsgV2lsayA8a29ucmFkLndp
bGtAb3JhY2xlLmNvbT4KQ2M6IFRpbSBEZWVnYW4gPHRpbUB4ZW4ub3JnPgpDYzogV2VpIExpdSA8
d2xAeGVuLm9yZz4KQ2M6ICJSb2dlciBQYXUgTW9ubsOpIiA8cm9nZXIucGF1QGNpdHJpeC5jb20+
CkNjOiBUYW1hcyBLIExlbmd5ZWwgPHRhbWFzQHRrbGVuZ3llbC5jb20+CkNjOiBHZW9yZ2UgRHVu
bGFwIDxnZW9yZ2UuZHVubGFwQGV1LmNpdHJpeC5jb20+Ci0tLQogeGVuL2FyY2gvYXJtL2RvbWFp
bi5jICAgICAgICAgfCAgNCArLS0tCiB4ZW4vYXJjaC94ODYvZG9tYWluLmMgICAgICAgICB8ICAz
ICstLQogeGVuL2FyY2gveDg2L2h2bS9pb3JlcS5jICAgICAgfCAxMSArKy0tLS0tLS0tLQogeGVu
L2FyY2gveDg2L21tLmMgICAgICAgICAgICAgfCAgMyArLS0KIHhlbi9hcmNoL3g4Ni9tbS9tZW1f
c2hhcmluZy5jIHwgIDkgKysrLS0tLS0tCiB4ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5jICAgICB8
ICA0ICstLS0KIHhlbi9hcmNoL3g4Ni9tbS9wMm0uYyAgICAgICAgIHwgIDMgKy0tCiB4ZW4vY29t
bW9uL2dyYW50X3RhYmxlLmMgICAgICB8ICAzICstLQogeGVuL2NvbW1vbi9tZW1vcnkuYyAgICAg
ICAgICAgfCAgNSArKy0tLQogeGVuL2NvbW1vbi94ZW5vcHJvZi5jICAgICAgICAgfCAgMyArLS0K
IHhlbi9pbmNsdWRlL3hlbi9tbS5oICAgICAgICAgIHwgMTEgKysrKysrKysrKysKIDExIGZpbGVz
IGNoYW5nZWQsIDI1IGluc2VydGlvbnMoKyksIDM0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL2FybS9kb21haW4uYyBiL3hlbi9hcmNoL2FybS9kb21haW4uYwppbmRleCA0ZjQ0
ZDVjNzQyLi43ODcwMGQ2ZjA4IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vZG9tYWluLmMKKysr
IGIveGVuL2FyY2gvYXJtL2RvbWFpbi5jCkBAIC05MjYsOSArOTI2LDcgQEAgc3RhdGljIGludCBy
ZWxpbnF1aXNoX21lbW9yeShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgcGFnZV9saXN0X2hlYWQg
Kmxpc3QpCiAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAg
IGlmICggdGVzdF9hbmRfY2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRfaW5m
bykgKQotICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7Ci0KKyAgICAgICAgY2xlYXJfYXNzaWdu
bWVudF9yZWZlcmVuY2UocGFnZSk7CiAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwogCiAgICAgICAg
IGlmICggaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94
ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggMTQ3Zjk2YTA5ZS4uYzhj
NTFkNWY3NiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9kb21haW4uYwpAQCAtMTkzOSw4ICsxOTM5LDcgQEAgc3RhdGljIGludCByZWxpbnF1aXNo
X21lbW9yeSgKICAgICAgICAgICAgIEJVRygpOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKCB0
ZXN0X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZvKSApCi0g
ICAgICAgICAgICBwdXRfcGFnZShwYWdlKTsKKyAgICAgICAgY2xlYXJfYXNzaWdubWVudF9yZWZl
cmVuY2UocGFnZSk7CiAKICAgICAgICAgLyoKICAgICAgICAgICogRm9yY2libHkgaW52YWxpZGF0
ZSB0b3AtbW9zdCwgc3RpbGwgdmFsaWQgcGFnZSB0YWJsZXMgYXQgdGhpcyBwb2ludApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L2h2bS9pb3JlcS5jIGIveGVuL2FyY2gveDg2L2h2bS9pb3JlcS5j
CmluZGV4IDdhODBjZmIyOGIuLjEyOWY5ZmRkYmMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9o
dm0vaW9yZXEuYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2lvcmVxLmMKQEAgLTM5OCw4ICszOTgs
NyBAQCBzdGF0aWMgaW50IGh2bV9hbGxvY19pb3JlcV9tZm4oc3RydWN0IGh2bV9pb3JlcV9zZXJ2
ZXIgKnMsIGJvb2wgYnVmKQogICAgIHJldHVybiAwOwogCiAgZmFpbDoKLSAgICBpZiAoIHRlc3Rf
YW5kX2NsZWFyX2JpdChfUEdDX2FsbG9jYXRlZCwgJnBhZ2UtPmNvdW50X2luZm8pICkKLSAgICAg
ICAgcHV0X3BhZ2UocGFnZSk7CisgICAgY2xlYXJfYXNzaWdubWVudF9yZWZlcmVuY2UocGFnZSk7
CiAgICAgcHV0X3BhZ2VfYW5kX3R5cGUocGFnZSk7CiAKICAgICByZXR1cm4gLUVOT01FTTsKQEAg
LTQxOCwxMyArNDE3LDcgQEAgc3RhdGljIHZvaWQgaHZtX2ZyZWVfaW9yZXFfbWZuKHN0cnVjdCBo
dm1faW9yZXFfc2VydmVyICpzLCBib29sIGJ1ZikKICAgICB1bm1hcF9kb21haW5fcGFnZV9nbG9i
YWwoaW9ycC0+dmEpOwogICAgIGlvcnAtPnZhID0gTlVMTDsKIAotICAgIC8qCi0gICAgICogQ2hl
Y2sgd2hldGhlciB3ZSBuZWVkIHRvIGNsZWFyIHRoZSBhbGxvY2F0aW9uIHJlZmVyZW5jZSBiZWZv
cmUKLSAgICAgKiBkcm9wcGluZyB0aGUgZXhwbGljaXQgcmVmZXJlbmNlcyB0YWtlbiBieSBnZXRf
cGFnZV9hbmRfdHlwZSgpLgotICAgICAqLwotICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KF9Q
R0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRfaW5mbykgKQotICAgICAgICBwdXRfcGFnZShwYWdl
KTsKLQorICAgIGNsZWFyX2Fzc2lnbm1lbnRfcmVmZXJlbmNlKHBhZ2UpOwogICAgIHB1dF9wYWdl
X2FuZF90eXBlKHBhZ2UpOwogfQogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hl
bi9hcmNoL3g4Ni9tbS5jCmluZGV4IGRmMmMwMTMwZjEuLjlmZTY2YTZkMjYgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC00OTgsOCArNDk4
LDcgQEAgdm9pZCBzaGFyZV94ZW5fcGFnZV93aXRoX2d1ZXN0KHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UsIHN0cnVjdCBkb21haW4gKmQsCiAKIHZvaWQgZnJlZV9zaGFyZWRfZG9taGVhcF9wYWdlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7Ci0gICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQoX1BH
Q19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZvKSApCi0gICAgICAgIHB1dF9wYWdlKHBhZ2Up
OworICAgIGNsZWFyX2Fzc2lnbm1lbnRfcmVmZXJlbmNlKHBhZ2UpOwogICAgIGlmICggIXRlc3Rf
YW5kX2NsZWFyX2JpdChfUEdDX3hlbl9oZWFwLCAmcGFnZS0+Y291bnRfaW5mbykgKQogICAgICAg
ICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKICAgICBwYWdlLT51LmludXNlLnR5cGVfaW5mbyA9IDA7
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vbWVtX3NoYXJpbmcuYyBiL3hlbi9hcmNoL3g4
Ni9tbS9tZW1fc2hhcmluZy5jCmluZGV4IGYxNmEzZjUzMjQuLjdhNjQzYWVkNTMgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9tbS9tZW1fc2hhcmluZy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9t
ZW1fc2hhcmluZy5jCkBAIC0xMDAwLDggKzEwMDAsNyBAQCBzdGF0aWMgaW50IHNoYXJlX3BhZ2Vz
KHN0cnVjdCBkb21haW4gKnNkLCBnZm5fdCBzZ2ZuLCBzaHJfaGFuZGxlX3Qgc2gsCiAgICAgbWVt
X3NoYXJpbmdfcGFnZV91bmxvY2soZmlyc3RwZyk7CiAKICAgICAvKiBGcmVlIHRoZSBjbGllbnQg
cGFnZSAqLwotICAgIGlmKHRlc3RfYW5kX2NsZWFyX2JpdChfUEdDX2FsbG9jYXRlZCwgJmNwYWdl
LT5jb3VudF9pbmZvKSkKLSAgICAgICAgcHV0X3BhZ2UoY3BhZ2UpOworICAgIGNsZWFyX2Fzc2ln
bm1lbnRfcmVmZXJlbmNlKGNwYWdlKTsKICAgICBwdXRfcGFnZShjcGFnZSk7CiAKICAgICAvKiBX
ZSBtYW5hZ2VkIHRvIGZyZWUgYSBkb21haW4gcGFnZS4gKi8KQEAgLTEwODIsOCArMTA4MSw3IEBA
IGludCBtZW1fc2hhcmluZ19hZGRfdG9fcGh5c21hcChzdHJ1Y3QgZG9tYWluICpzZCwgdW5zaWdu
ZWQgbG9uZyBzZ2ZuLCBzaHJfaGFuZGxlCiAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FT1ZF
UkZMT1c7CiAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX3VubG9jazsKICAgICAgICAgICAg
ICAgICB9Ci0gICAgICAgICAgICAgICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxv
Y2F0ZWQsICZjcGFnZS0+Y291bnRfaW5mbykgKQotICAgICAgICAgICAgICAgICAgICBwdXRfcGFn
ZShjcGFnZSk7CisgICAgICAgICAgICAgICAgY2xlYXJfYXNzaWdubWVudF9yZWZlcmVuY2UoY3Bh
Z2UpOwogICAgICAgICAgICAgICAgIHB1dF9wYWdlKGNwYWdlKTsKICAgICAgICAgICAgIH0KICAg
ICAgICAgfQpAQCAtMTE3Nyw4ICsxMTc1LDcgQEAgaW50IF9fbWVtX3NoYXJpbmdfdW5zaGFyZV9w
YWdlKHN0cnVjdCBkb21haW4gKmQsCiAgICAgICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwog
ICAgICAgICAgICAgICAgIHJldHVybiAtRU9WRVJGTE9XOwogICAgICAgICAgICAgfQotICAgICAg
ICAgICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZwYWdlLT5jb3Vu
dF9pbmZvKSApCi0gICAgICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CisgICAgICAgICAgICBj
bGVhcl9hc3NpZ25tZW50X3JlZmVyZW5jZShwYWdlKTsKICAgICAgICAgICAgIHB1dF9wYWdlKHBh
Z2UpOwogICAgICAgICB9CiAgICAgICAgIHB1dF9nZm4oZCwgZ2ZuKTsKZGlmZiAtLWdpdCBhL3hl
bi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMgYi94ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5jCmluZGV4
IDQzMTM4NjMwNjYuLjJlMjI3NjQ5NTAgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0t
cG9kLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1wb2QuYwpAQCAtMjc0LDkgKzI3NCw3IEBA
IHAybV9wb2Rfc2V0X2NhY2hlX3RhcmdldChzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCB1bnNpZ25l
ZCBsb25nIHBvZF90YXJnZXQsIGludCBwCiAgICAgICAgICAgICBpZiAoIHRlc3RfYW5kX2NsZWFy
X2JpdChfUEdUX3Bpbm5lZCwgJihwYWdlK2kpLT51LmludXNlLnR5cGVfaW5mbykgKQogICAgICAg
ICAgICAgICAgIHB1dF9wYWdlX2FuZF90eXBlKHBhZ2UgKyBpKTsKIAotICAgICAgICAgICAgaWYg
KCB0ZXN0X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICYocGFnZStpKS0+Y291bnRfaW5m
bykgKQotICAgICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UgKyBpKTsKLQorICAgICAgICAgICAg
Y2xlYXJfYXNzaWdubWVudF9yZWZlcmVuY2UocGFnZSArIGkpOwogICAgICAgICAgICAgcHV0X3Bh
Z2UocGFnZSArIGkpOwogCiAgICAgICAgICAgICBpZiAoIHByZWVtcHRpYmxlICYmIHBvZF90YXJn
ZXQgIT0gcDJtLT5wb2QuY291bnQgJiYKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0u
YyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwppbmRleCA0Yzk5NTQ4NjdjLi5jZTY4NTlkNTFiIDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3Ay
bS5jCkBAIC0xNjA5LDggKzE2MDksNyBAQCBpbnQgcDJtX21lbV9wYWdpbmdfZXZpY3Qoc3RydWN0
IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCkKICAgICAgICAgZ290byBvdXRfcHV0Owog
CiAgICAgLyogRGVjcmVtZW50IGd1ZXN0IGRvbWFpbidzIHJlZiBjb3VudCBvZiB0aGUgcGFnZSAq
LwotICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291
bnRfaW5mbykgKQotICAgICAgICBwdXRfcGFnZShwYWdlKTsKKyAgICBjbGVhcl9hc3NpZ25tZW50
X3JlZmVyZW5jZShwYWdlKTsKIAogICAgIC8qIFJlbW92ZSBtYXBwaW5nIGZyb20gcDJtIHRhYmxl
ICovCiAgICAgcmV0ID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4sIFBBR0Vf
T1JERVJfNEssCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMgYi94ZW4vY29t
bW9uL2dyYW50X3RhYmxlLmMKaW5kZXggZTZhMGYzMGE0Yi4uNWFlODVlM2RhZCAxMDA2NDQKLS0t
IGEveGVuL2NvbW1vbi9ncmFudF90YWJsZS5jCisrKyBiL3hlbi9jb21tb24vZ3JhbnRfdGFibGUu
YwpAQCAtMTcwNyw4ICsxNzA3LDcgQEAgZ250dGFiX3VucG9wdWxhdGVfc3RhdHVzX2ZyYW1lcyhz
dHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZ3JhbnRfdGFibGUgKmd0KQogICAgICAgICB9CiAKICAg
ICAgICAgQlVHX09OKHBhZ2VfZ2V0X293bmVyKHBnKSAhPSBkKTsKLSAgICAgICAgaWYgKCB0ZXN0
X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZwZy0+Y291bnRfaW5mbykgKQotICAgICAg
ICAgICAgcHV0X3BhZ2UocGcpOworICAgICAgICBjbGVhcl9hc3NpZ25tZW50X3JlZmVyZW5jZShw
Zyk7CiAKICAgICAgICAgaWYgKCBwZy0+Y291bnRfaW5mbyAmIH5QR0NfeGVuX2hlYXAgKQogICAg
ICAgICB7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL21lbW9yeS5jIGIveGVuL2NvbW1vbi9tZW1v
cnkuYwppbmRleCAwM2RiN2JmYTllLi5hYjE5YTRjYTg2IDEwMDY0NAotLS0gYS94ZW4vY29tbW9u
L21lbW9yeS5jCisrKyBiL3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTM4OCw5ICszODgsOCBAQCBp
bnQgZ3Vlc3RfcmVtb3ZlX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnbWZu
KQogICAgICAqIEZvciB0aGlzIHB1cnBvc2UgKGFuZCB0byBtYXRjaCBwb3B1bGF0ZV9waHlzbWFw
KCkgYmVoYXZpb3IpLCB0aGUgcGFnZQogICAgICAqIGlzIGtlcHQgYWxsb2NhdGVkLgogICAgICAq
LwotICAgIGlmICggIXJjICYmICFpc19kb21haW5fZGlyZWN0X21hcHBlZChkKSAmJgotICAgICAg
ICAgdGVzdF9hbmRfY2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRfaW5mbykg
KQotICAgICAgICBwdXRfcGFnZShwYWdlKTsKKyAgICBpZiAoICFyYyAmJiAhaXNfZG9tYWluX2Rp
cmVjdF9tYXBwZWQoZCkgKQorICAgICAgICBjbGVhcl9hc3NpZ25tZW50X3JlZmVyZW5jZShwYWdl
KTsKIAogICAgIHB1dF9wYWdlKHBhZ2UpOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3hlbm9w
cm9mLmMgYi94ZW4vY29tbW9uL3hlbm9wcm9mLmMKaW5kZXggOGE3MmUzODJlNi4uMjYyZDUzNzA3
NCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi94ZW5vcHJvZi5jCisrKyBiL3hlbi9jb21tb24veGVu
b3Byb2YuYwpAQCAtMTczLDggKzE3Myw3IEBAIHVuc2hhcmVfeGVub3Byb2ZfcGFnZV93aXRoX2d1
ZXN0KHN0cnVjdCB4ZW5vcHJvZiAqeCkKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9
IG1mbl90b19wYWdlKG1mbl9hZGQobWZuLCBpKSk7CiAKICAgICAgICAgQlVHX09OKHBhZ2VfZ2V0
X293bmVyKHBhZ2UpICE9IGN1cnJlbnQtPmRvbWFpbik7Ci0gICAgICAgIGlmICggdGVzdF9hbmRf
Y2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRfaW5mbykgKQotICAgICAgICAg
ICAgcHV0X3BhZ2UocGFnZSk7CisgICAgICAgIGNsZWFyX2Fzc2lnbm1lbnRfcmVmZXJlbmNlKHBh
Z2UpOwogICAgIH0KIH0KIApkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL21tLmggYi94ZW4v
aW5jbHVkZS94ZW4vbW0uaAppbmRleCBhNTc5NzRhZTUxLi4xYzM2Yzc0YjhjIDEwMDY0NAotLS0g
YS94ZW4vaW5jbHVkZS94ZW4vbW0uaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vbW0uaApAQCAtNjU4
LDQgKzY1OCwxNSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgc2hhcmVfeGVuX3BhZ2Vfd2l0aF9wcml2
aWxlZ2VkX2d1ZXN0cygKICAgICBzaGFyZV94ZW5fcGFnZV93aXRoX2d1ZXN0KHBhZ2UsIGRvbV94
ZW4sIGZsYWdzKTsKIH0KIAorc3RhdGljIGlubGluZSB2b2lkIGNsZWFyX2Fzc2lnbm1lbnRfcmVm
ZXJlbmNlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCit7CisgICAgLyoKKyAgICAgKiBJdCBpcyB1
bnNhZmUgdG8gY2xlYXIgX1BHQ19hbGxvY2F0ZWQgd2l0aG91dCBob2xkaW5nIGFuIGFkZGl0aW9u
YWwKKyAgICAgKiByZWZlcmVuY2UuCisgICAgICovCisgICAgQVNTRVJUKChwYWdlLT5jb3VudF9p
bmZvICYgUEdDX2NvdW50X21hc2spID4gMSk7CisgICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQo
X1BHQ19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZvKSApCisgICAgICAgIHB1dF9wYWdlKHBh
Z2UpOworfQorCiAjZW5kaWYgLyogX19YRU5fTU1fSF9fICovCi0tIAoyLjIwLjEuMi5nYjIxZWJi
NjcxCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVu
LWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6
Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

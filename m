Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 712F0BF387
	for <lists+xen-devel@lfdr.de>; Thu, 26 Sep 2019 14:56:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDTGL-0003H0-Tm; Thu, 26 Sep 2019 12:52:49 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=fOM6=XV=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1iDTGK-0003Gq-9y
 for xen-devel@lists.xenproject.org; Thu, 26 Sep 2019 12:52:48 +0000
X-Inumbo-ID: 89f1497c-e05c-11e9-9651-12813bfff9fa
Received: from foss.arm.com (unknown [217.140.110.172])
 by localhost (Halon) with ESMTP
 id 89f1497c-e05c-11e9-9651-12813bfff9fa;
 Thu, 26 Sep 2019 12:52:46 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 5D013142F;
 Thu, 26 Sep 2019 05:52:46 -0700 (PDT)
Received: from [10.37.8.90] (unknown [10.37.8.90])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id AB7E33F763;
 Thu, 26 Sep 2019 05:52:44 -0700 (PDT)
To: Oleksandr Tyshchenko <olekstysh@gmail.com>, xen-devel@lists.xenproject.org
References: <1569496834-7796-1-git-send-email-olekstysh@gmail.com>
 <1569496834-7796-8-git-send-email-olekstysh@gmail.com>
From: Julien Grall <julien.grall@arm.com>
Message-ID: <55a32546-9a54-c326-f4ae-83c0dc5fb69d@arm.com>
Date: Thu, 26 Sep 2019 13:52:43 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <1569496834-7796-8-git-send-email-olekstysh@gmail.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH V6 7/8] iommu/arm: Introduce
 iommu_add_dt_device API
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Oleksandr Tyshchenko <oleksandr_tyshchenko@epam.com>,
 sstabellini@kernel.org, volodymyr_babchuk@epam.com,
 Jan Beulich <jbeulich@suse.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SGksCgpPbiA5LzI2LzE5IDEyOjIwIFBNLCBPbGVrc2FuZHIgVHlzaGNoZW5rbyB3cm90ZToKPiBG
cm9tOiBPbGVrc2FuZHIgVHlzaGNoZW5rbyA8b2xla3NhbmRyX3R5c2hjaGVua29AZXBhbS5jb20+
Cj4gCj4gVGhlIG1haW4gcHVwcm9zZSBvZiB0aGlzIHBhdGNoIGlzIHRvIGFkZCBhIHdheSB0byBy
ZWdpc3RlciBEVCBkZXZpY2UKPiAod2hpY2ggaXMgYmVoaW5kIHRoZSBJT01NVSkgdXNpbmcgdGhl
IGdlbmVyaWMgSU9NTVUgRFQgYmluZGluZ3MgWzFdCj4gYmVmb3JlIGFzc2lnbmluZyB0aGF0IGRl
dmljZSB0byBhIGRvbWFpbi4KPiAKPiBTbywgdGhpcyBwYXRjaCBhZGRzIG5ldyAiaW9tbXVfYWRk
X2R0X2RldmljZSIgQVBJIGZvciBhZGRpbmcgRFQgZGV2aWNlCj4gdG8gdGhlIElPTU1VIHVzaW5n
IGdlbmVyaWMgSU9NTVUgRFQgYmluZGluZ3MgYW5kIHByZXZpb3VzbHkgYWRkZWQKPiAiaW9tbXVf
ZndzcGVjIiBzdXBwb3J0LiBBcyBkZXZpY2VzIGNhbiBiZSBhc3NpZ25lZCB0byB0aGUgaGFyZHdh
cmUgZG9tYWluCj4gYW5kIG90aGVyIGRvbWFpbnMgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZnJv
bSB0d28gcGxhY2VzOiBoYW5kbGVfZGV2aWNlKCkKPiBhbmQgaW9tbXVfZG9fZHRfZG9tY3RsKCku
Cj4gCj4gQmVzaWRlcyB0aGF0LCB0aGlzIHBhdGNoIGFkZHMgbmV3ICJkdF94bGF0ZSIgY2FsbGJh
Y2sgKGJvcnJvd2VkIGZyb20KPiBMaW51eCAib2ZfeGxhdGUiKSBmb3IgcHJvdmlkaW5nIHRoZSBk
cml2ZXIgd2l0aCBEVCBJT01NVSBzcGVjaWZpZXIKPiB3aGljaCBkZXNjcmliZXMgdGhlIElPTU1V
IG1hc3RlciBpbnRlcmZhY2VzIG9mIHRoYXQgZGV2aWNlIChkZXZpY2UgSURzLCBldGMpLgo+IEFj
Y29yZGluZyB0byB0aGUgZ2VuZXJpYyBJT01NVSBEVCBiaW5kaW5ncyB0aGUgY29udGV4dCBvZiBy
ZXF1aXJlZAo+IHByb3BlcnRpZXMgZm9yIElPTU1VIGRldmljZS9tYXN0ZXIgbm9kZSAoI2lvbW11
LWNlbGxzLCBpb21tdXMpIGRlcGVuZHMKPiBvbiBtYW55IGZhY3RvcnMgYW5kIGlzIHJlYWxseSBk
cml2ZXIgZGVwZW5kZWQgdGhpbmcuCj4gCj4gUGxlYXNlIG5vdGUsIGFsbCBJT01NVSBkcml2ZXJz
IHdoaWNoIHN1cHBvcnQgZ2VuZXJpYyBJT01NVSBEVCBiaW5kaW5ncwo+IHNob3VsZCB1c2UgImR0
X3hsYXRlIiBhbmQgImFkZF9kZXZpY2UiIGNhbGxiYWNrcy4KPiAKPiBbMV0gaHR0cHM6Ly93d3cu
a2VybmVsLm9yZy9kb2MvRG9jdW1lbnRhdGlvbi9kZXZpY2V0cmVlL2JpbmRpbmdzL2lvbW11L2lv
bW11LnR4dAo+IAo+IFNpZ25lZC1vZmYtYnk6IE9sZWtzYW5kciBUeXNoY2hlbmtvIDxvbGVrc2Fu
ZHJfdHlzaGNoZW5rb0BlcGFtLmNvbT4KCkFja2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1bGllbi5n
cmFsbEBhcm0uY29tPgoKQ2hlZXJzLAoKPiBDQzogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxA
YXJtLmNvbT4KPiBDQzogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgo+IAo+IC0tLQo+
IENoYW5nZXMgVjUgLT4gVjY6Cj4gICAgICAgLSBhZGRlZCBjaGVjayBmb3IgdGhlIGZ1bmN0aW9u
J3MgcmV0dXJuIHZhbHVlIGluIGJvdGggY2FzZXMKPiAgICAgICAtIHJlbW92ZWQgZXh0cmEgY2hl
Y2sgZm9yIGR0X2RldmljZV9pc19wcm90ZWN0ZWQoKSBmcm9tCj4gICAgICAgICBpb21tdV9kb19k
dF9kb21jdGwoKQo+IAo+IENoYW5nZXMgVjQgLT4gVjU6Cj4gICAgICAgLSBhZGRlZCAiY29uc3Qi
IHRvIHN0cnVjdCBkdF9waGFuZGxlX2FyZ3MgKmFyZ3MgaW4gZHRfeGxhdGUKPiAgICAgICAtIG1v
dmVkIGlvbW11X2FkZF9kdF9kZXZpY2UoKSB0byB4ZW4vcGFzc3Rocm91Z2gvZGV2aWNlX3RyZWUu
Ywo+ICAgICAgIC0gbW9kaWZpZWQgbG9naWMsIGRvbid0IHRyeSB0byBhZGQgImFsbCIgZGV2aWNl
cyB0byB0aGUgSU9NTVUKPiAgICAgICAgIHdoZW4gY29uc3RydWN0aW5nIERvbTAsIGJ1dCBvbmx5
IGRldmljZXMgd2hpY2ggYXJlIGdvaW5nIHRvIGJlCj4gICAgICAgICBhc3NpZ25lZCB0byBod2Rv
bQo+ICAgICAgIC0gdXBkYXRlZCBpb21tdV9kb19kdF9kb21jdGwoKSB0byBjYWxsIGlvbW11X2Fk
ZF9kdF9kZXZpY2UoKQo+ICAgICAgIC0gY2xhcmlmaWVkIHBhdGNoIGRlc2NyaXB0aW9uCj4gICAg
ICAgLSByZW1vdmVkICJfX2luaXQiIGZyb20gaW9tbXVfYWRkX2R0X2RldmljZSgpCj4gCj4gQ2hh
bmdlcyBWMyAtPiBWNDoKPiAgICAgICAtIHNxdWFzaGVkIHdpdGggImlvbW11OiBBZGQgb2ZfeGxh
dGUgY2FsbGJhY2siIHBhdGNoCj4gICAgICAgLSByZW5hbWVkICJvZl94bGF0ZSIgdG8gImR0X3hs
YXRlIgo+ICAgICAgIC0gcmV3b3JrZWQgcGF0Y2ggZGVzY3JpcHRpb24KPiAgICAgICAtIGNsYXJp
ZmllZCBjb21tZW50cyBpbiBjb2RlLCByZW1vdmVkIGNvbmZ1c2luZyB3b3JkCj4gICAgICAgICAi
aW5pdGlhbGl6ZSBkZXZpY2UiLCBldGMKPiAgICAgICAtIHVwZGF0ZWQgZGVidWcgbWVzc2FnZSBp
biBoYW5kbGVfZGV2aWNlKCkKPiAgICAgICAtIG1vZGlmaWVkIHRvIGNoZWNrIG9wcy0+b2ZfeGxh
dGUgYW5kIG9wcy0+YWRkX2RldmljZQo+ICAgICAgICAgb25seSBpZiAiaW9tbXVzIiBwcm9wZXJ0
eSBpcyBleGlzdHMKPiAKPiBDaGFuZ2VzIFYyIC0+IFYzOgo+ICAgICAgLSBjbGFyaWZpZWQgcGF0
Y2ggZGVzY3JpcHRpb24KPiAgICAgIC0gY2xhcmlmaWVkIGNvbW1lbnRzIGluIGNvZGUKPiAgICAg
IC0gbW9kaWZpZWQgdG8gcHJvdmlkZSBEVCBJT01NVSBzcGVjaWZpZXIgdG8gdGhlIGRyaXZlcgo+
ICAgICAgICB1c2luZyAib2ZfeGxhdGUiIGNhbGxiYWNrCj4gICAgICAtIGRvY3VtZW50ZWQgZnVu
Y3Rpb24gdXNhZ2UKPiAgICAgIC0gbW9kaWZpZWQgdG8gcmV0dXJuIGFuIGVycm9yIGlmIG9wcyBp
cyBub3QgcHJlc2VudC9pbXBsZW1lbnRlZCwKPiAgICAgIC0gYWRkZWQgYWJpbGl0eSB0byByZXR1
cm4gYSBwb3NzaXRpdmUgdmFsdWUgdG8gaW5kaWNhdGUKPiAgICAgICAgdGhhdCBkZXZpY2UgZG9l
c24ndCBuZWVkIHRvIGJlIHByb3RlY3RlZAo+ICAgICAgLSByZW1vdmVkIGNoZWNrIGZvciB0aGUg
ImlvbW11IiBwcm9wZXJ0eSBwcmVzZW5jZQo+ICAgICAgICBpbiB0aGUgY29tbW9uIGNvZGUKPiAg
ICAgIC0gaW5jbHVkZWQgPGFzbS9pb21tdV9md3NwZWMuaD4gZGlyZWN0bHkKPiAtLS0KPiAgIHhl
bi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyAgICAgICAgICAgfCAyNSArKysrKysrKystLS0KPiAg
IHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVlLmMgfCA3NyArKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKwo+ICAgeGVuL2luY2x1ZGUveGVuL2lvbW11LmggICAgICAg
ICAgICAgICB8IDIxICsrKysrKysrKysKPiAgIDMgZmlsZXMgY2hhbmdlZCwgMTE4IGluc2VydGlv
bnMoKyksIDUgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9kb21h
aW5fYnVpbGQuYyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYwo+IGluZGV4IGEwZmVlMWUu
LmI4NGE0NDggMTAwNjQ0Cj4gLS0tIGEveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCj4gKysr
IGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCj4gQEAgLTEyNDMsNiArMTI0Myw3IEBAIHN0
YXRpYyBpbnQgX19pbml0IG1hcF9kZXZpY2VfY2hpbGRyZW4oc3RydWN0IGRvbWFpbiAqZCwKPiAg
ICAqICAtIEdpdmUgcGVybWlzc2lvbiB0byB0aGUgZ3Vlc3QgdG8gbWFuYWdlIElSUSBhbmQgTU1J
TyByYW5nZQo+ICAgICogIC0gUmV0cmlldmUgdGhlIElSUSBjb25maWd1cmF0aW9uIChpLmUgZWRn
ZS9sZXZlbCkgZnJvbSBkZXZpY2UgdHJlZQo+ICAgICogV2hlbiB0aGUgZGV2aWNlIGlzIG5vdCBt
YXJrZWQgZm9yIGd1ZXN0IHBhc3N0aHJvdWdoOgo+ICsgKiAgLSBUcnkgdG8gY2FsbCBpb21tdV9h
ZGRfZHRfZGV2aWNlIHRvIHByb3RlY3QgdGhlIGRldmljZSBieSBhbiBJT01NVQo+ICAgICogIC0g
QXNzaWduIHRoZSBkZXZpY2UgdG8gdGhlIGd1ZXN0IGlmIGl0J3MgcHJvdGVjdGVkIGJ5IGFuIElP
TU1VCj4gICAgKiAgLSBNYXAgdGhlIElSUXMgYW5kIGlvbWVtIHJlZ2lvbnMgdG8gRE9NMAo+ICAg
ICovCj4gQEAgLTEyNjMsMTYgKzEyNjQsMzAgQEAgc3RhdGljIGludCBfX2luaXQgaGFuZGxlX2Rl
dmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKmRldiwKPiAgICAg
ICBkdF9kcHJpbnRrKCIlcyBwYXNzdGhyb3VnaCA9ICVkIG5pcnEgPSAlZCBuYWRkciA9ICV1XG4i
LAo+ICAgICAgICAgICAgICAgICAgZHRfbm9kZV9mdWxsX25hbWUoZGV2KSwgbmVlZF9tYXBwaW5n
LCBuaXJxLCBuYWRkcik7Cj4gICAKPiAtICAgIGlmICggZHRfZGV2aWNlX2lzX3Byb3RlY3RlZChk
ZXYpICYmIG5lZWRfbWFwcGluZyApCj4gKyAgICBpZiAoIG5lZWRfbWFwcGluZyApCj4gICAgICAg
ewo+IC0gICAgICAgIGR0X2RwcmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1bGxf
bmFtZShkZXYpKTsKPiAtICAgICAgICByZXMgPSBpb21tdV9hc3NpZ25fZHRfZGV2aWNlKGQsIGRl
dik7Cj4gLSAgICAgICAgaWYgKCByZXMgKQo+ICsgICAgICAgIGR0X2RwcmludGsoIkNoZWNrIGlm
ICVzIGlzIGJlaGluZCB0aGUgSU9NTVUgYW5kIGFkZCBpdFxuIiwKPiArICAgICAgICAgICAgICAg
ICAgIGR0X25vZGVfZnVsbF9uYW1lKGRldikpOwo+ICsKPiArICAgICAgICByZXMgPSBpb21tdV9h
ZGRfZHRfZGV2aWNlKGRldik7Cj4gKyAgICAgICAgaWYgKCByZXMgPCAwICkKPiAgICAgICAgICAg
ewo+IC0gICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiRmFpbGVkIHRvIHNldHVwIHRoZSBJ
T01NVSBmb3IgJXNcbiIsCj4gKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQg
dG8gYWRkICVzIHRvIHRoZSBJT01NVVxuIiwKPiAgICAgICAgICAgICAgICAgICAgICBkdF9ub2Rl
X2Z1bGxfbmFtZShkZXYpKTsKPiAgICAgICAgICAgICAgIHJldHVybiByZXM7Cj4gICAgICAgICAg
IH0KPiArCj4gKyAgICAgICAgaWYgKCBkdF9kZXZpY2VfaXNfcHJvdGVjdGVkKGRldikgKQo+ICsg
ICAgICAgIHsKPiArICAgICAgICAgICAgZHRfZHByaW50aygiJXMgc2V0dXAgaW9tbXVcbiIsIGR0
X25vZGVfZnVsbF9uYW1lKGRldikpOwo+ICsgICAgICAgICAgICByZXMgPSBpb21tdV9hc3NpZ25f
ZHRfZGV2aWNlKGQsIGRldik7Cj4gKyAgICAgICAgICAgIGlmICggcmVzICkKPiArICAgICAgICAg
ICAgewo+ICsgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIkZhaWxlZCB0byBzZXR1
cCB0aGUgSU9NTVUgZm9yICVzXG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgIGR0X25vZGVf
ZnVsbF9uYW1lKGRldikpOwo+ICsgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKPiArICAgICAg
ICAgICAgfQo+ICsgICAgICAgIH0KPiAgICAgICB9Cj4gICAKPiAgICAgICAvKiBHaXZlIHBlcm1p
c3Npb24gYW5kIG1hcCBJUlFzICovCj4gZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2RldmljZV90cmVlLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5j
Cj4gaW5kZXggOTIxYTZlNS4uY2M5MDBiYSAxMDA2NDQKPiAtLS0gYS94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9kZXZpY2VfdHJlZS5jCj4gKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvZGV2
aWNlX3RyZWUuYwo+IEBAIC0yMiw2ICsyMiw4IEBACj4gICAjaW5jbHVkZSA8eGVuL3NjaGVkLmg+
Cj4gICAjaW5jbHVkZSA8eHNtL3hzbS5oPgo+ICAgCj4gKyNpbmNsdWRlIDxhc20vaW9tbXVfZndz
cGVjLmg+Cj4gKwo+ICAgc3RhdGljIHNwaW5sb2NrX3QgZHRkZXZzX2xvY2sgPSBTUElOX0xPQ0tf
VU5MT0NLRUQ7Cj4gICAKPiAgIGludCBpb21tdV9hc3NpZ25fZHRfZGV2aWNlKHN0cnVjdCBkb21h
aW4gKmQsIHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqZGV2KQo+IEBAIC0xMjUsNiArMTI3LDY4IEBA
IGludCBpb21tdV9yZWxlYXNlX2R0X2RldmljZXMoc3RydWN0IGRvbWFpbiAqZCkKPiAgICAgICBy
ZXR1cm4gMDsKPiAgIH0KPiAgIAo+ICtpbnQgaW9tbXVfYWRkX2R0X2RldmljZShzdHJ1Y3QgZHRf
ZGV2aWNlX25vZGUgKm5wKQo+ICt7Cj4gKyAgICBjb25zdCBzdHJ1Y3QgaW9tbXVfb3BzICpvcHMg
PSBpb21tdV9nZXRfb3BzKCk7Cj4gKyAgICBzdHJ1Y3QgZHRfcGhhbmRsZV9hcmdzIGlvbW11X3Nw
ZWM7Cj4gKyAgICBzdHJ1Y3QgZGV2aWNlICpkZXYgPSBkdF90b19kZXYobnApOwo+ICsgICAgaW50
IHJjID0gMSwgaW5kZXggPSAwOwo+ICsKPiArICAgIGlmICggIWlvbW11X2VuYWJsZWQgKQo+ICsg
ICAgICAgIHJldHVybiAxOwo+ICsKPiArICAgIGlmICggIW9wcyApCj4gKyAgICAgICAgcmV0dXJu
IC1FSU5WQUw7Cj4gKwo+ICsgICAgaWYgKCBkZXZfaW9tbXVfZndzcGVjX2dldChkZXYpICkKPiAr
ICAgICAgICByZXR1cm4gLUVFWElTVDsKPiArCj4gKyAgICAvKgo+ICsgICAgICogQWNjb3JkaW5n
IHRvIHRoZSBEb2N1bWVudGF0aW9uL2RldmljZXRyZWUvYmluZGluZ3MvaW9tbXUvaW9tbXUudHh0
Cj4gKyAgICAgKiBmcm9tIExpbnV4Lgo+ICsgICAgICovCj4gKyAgICB3aGlsZSAoICFkdF9wYXJz
ZV9waGFuZGxlX3dpdGhfYXJncyhucCwgImlvbW11cyIsICIjaW9tbXUtY2VsbHMiLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsICZpb21tdV9zcGVjKSAp
Cj4gKyAgICB7Cj4gKyAgICAgICAgLyoKPiArICAgICAgICAgKiBUaGUgZHJpdmVyIHdoaWNoIHN1
cHBvcnRzIGdlbmVyaWMgSU9NTVUgRFQgYmluZGluZ3MgbXVzdCBoYXZlCj4gKyAgICAgICAgICog
dGhlc2UgY2FsbGJhY2sgaW1wbGVtZW50ZWQuCj4gKyAgICAgICAgICovCj4gKyAgICAgICAgaWYg
KCAhb3BzLT5hZGRfZGV2aWNlIHx8ICFvcHMtPmR0X3hsYXRlICkKPiArICAgICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7Cj4gKwo+ICsgICAgICAgIGlmICggIWR0X2RldmljZV9pc19hdmFpbGFibGUo
aW9tbXVfc3BlYy5ucCkgKQo+ICsgICAgICAgICAgICBicmVhazsKPiArCj4gKyAgICAgICAgcmMg
PSBpb21tdV9md3NwZWNfaW5pdChkZXYsICZpb21tdV9zcGVjLm5wLT5kZXYpOwo+ICsgICAgICAg
IGlmICggcmMgKQo+ICsgICAgICAgICAgICBicmVhazsKPiArCj4gKyAgICAgICAgLyoKPiArICAg
ICAgICAgKiBQcm92aWRlIERUIElPTU1VIHNwZWNpZmllciB3aGljaCBkZXNjcmliZXMgdGhlIElP
TU1VIG1hc3Rlcgo+ICsgICAgICAgICAqIGludGVyZmFjZXMgb2YgdGhhdCBkZXZpY2UgKGRldmlj
ZSBJRHMsIGV0YykgdG8gdGhlIGRyaXZlci4KPiArICAgICAgICAgKiBUaGUgZHJpdmVyIGlzIHJl
c3BvbnNpYmxlIHRvIGRlY2lkZSBob3cgdG8gaW50ZXJwcmV0IHRoZW0uCj4gKyAgICAgICAgICov
Cj4gKyAgICAgICAgcmMgPSBvcHMtPmR0X3hsYXRlKGRldiwgJmlvbW11X3NwZWMpOwo+ICsgICAg
ICAgIGlmICggcmMgKQo+ICsgICAgICAgICAgICBicmVhazsKPiArCj4gKyAgICAgICAgaW5kZXgr
KzsKPiArICAgIH0KPiArCj4gKyAgICAvKgo+ICsgICAgICogQWRkIG1hc3RlciBkZXZpY2UgdG8g
dGhlIElPTU1VIGlmIGxhdHRlciBpcyBwcmVzZW50IGFuZCBhdmFpbGFibGUuCj4gKyAgICAgKiBU
aGUgZHJpdmVyIGlzIHJlc3BvbnNpYmxlIHRvIG1hcmsgdGhhdCBkZXZpY2UgYXMgcHJvdGVjdGVk
Lgo+ICsgICAgICovCj4gKyAgICBpZiAoICFyYyApCj4gKyAgICAgICAgcmMgPSBvcHMtPmFkZF9k
ZXZpY2UoMCwgZGV2KTsKPiArCj4gKyAgICBpZiAoIHJjIDwgMCApCj4gKyAgICAgICAgaW9tbXVf
ZndzcGVjX2ZyZWUoZGV2KTsKPiArCj4gKyAgICByZXR1cm4gcmM7Cj4gK30KPiArCj4gICBpbnQg
aW9tbXVfZG9fZHRfZG9tY3RsKHN0cnVjdCB4ZW5fZG9tY3RsICpkb21jdGwsIHN0cnVjdCBkb21h
aW4gKmQsCj4gICAgICAgICAgICAgICAgICAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0o
eGVuX2RvbWN0bF90KSB1X2RvbWN0bCkKPiAgIHsKPiBAQCAtMTY2LDYgKzIzMCwxOSBAQCBpbnQg
aW9tbXVfZG9fZHRfZG9tY3RsKHN0cnVjdCB4ZW5fZG9tY3RsICpkb21jdGwsIHN0cnVjdCBkb21h
aW4gKmQsCj4gICAgICAgICAgICAgICBicmVhazsKPiAgICAgICAgICAgfQo+ICAgCj4gKyAgICAg
ICAgcmV0ID0gaW9tbXVfYWRkX2R0X2RldmljZShkZXYpOwo+ICsgICAgICAgIC8qCj4gKyAgICAg
ICAgICogSWdub3JlICItRUVYSVNUIiBlcnJvciBjb2RlIGFzIGl0IHdvdWxkIG1lYW4gdGhhdCB0
aGUgZGV2aWNlIGlzCj4gKyAgICAgICAgICogYWxyZWFkeSBhZGRlZCB0byB0aGUgSU9NTVUgKHBv
c2l0aXZlIHJlc3VsdCkuIFN1Y2ggaGFwcGVucyBhZnRlcgo+ICsgICAgICAgICAqIHJlLWNyZWF0
aW5nIGd1ZXN0IGRvbWFpbi4KPiArICAgICAgICAgKi8KPiArICAgICAgICBpZiAoIHJldCA8IDAg
JiYgcmV0ICE9IC1FRVhJU1QgKQo+ICsgICAgICAgIHsKPiArICAgICAgICAgICAgcHJpbnRrKFhF
TkxPR19HX0VSUiAiRmFpbGVkIHRvIGFkZCAlcyB0byB0aGUgSU9NTVVcbiIsCj4gKyAgICAgICAg
ICAgICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKPiArICAgICAgICAgICAgYnJlYWs7
Cj4gKyAgICAgICAgfQo+ICsKPiAgICAgICAgICAgcmV0ID0gaW9tbXVfYXNzaWduX2R0X2Rldmlj
ZShkLCBkZXYpOwo+ICAgCj4gICAgICAgICAgIGlmICggcmV0ICkKPiBkaWZmIC0tZ2l0IGEveGVu
L2luY2x1ZGUveGVuL2lvbW11LmggYi94ZW4vaW5jbHVkZS94ZW4vaW9tbXUuaAo+IGluZGV4IDdj
MzAwM2YuLjk3NGJkM2YgMTAwNjQ0Cj4gLS0tIGEveGVuL2luY2x1ZGUveGVuL2lvbW11LmgKPiAr
KysgYi94ZW4vaW5jbHVkZS94ZW4vaW9tbXUuaAo+IEBAIC0xODIsNiArMTgyLDE3IEBAIGludCBp
b21tdV9kZWFzc2lnbl9kdF9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGR0X2Rldmlj
ZV9ub2RlICpkZXYpOwo+ICAgaW50IGlvbW11X2R0X2RvbWFpbl9pbml0KHN0cnVjdCBkb21haW4g
KmQpOwo+ICAgaW50IGlvbW11X3JlbGVhc2VfZHRfZGV2aWNlcyhzdHJ1Y3QgZG9tYWluICpkKTsK
PiAgIAo+ICsvKgo+ICsgKiBIZWxwZXIgdG8gYWRkIG1hc3RlciBkZXZpY2UgdG8gdGhlIElPTU1V
IHVzaW5nIGdlbmVyaWMgSU9NTVUgRFQgYmluZGluZ3MuCj4gKyAqCj4gKyAqIFJldHVybiB2YWx1
ZXM6Cj4gKyAqICAwIDogZGV2aWNlIGlzIHByb3RlY3RlZCBieSBhbiBJT01NVQo+ICsgKiA8MCA6
IGRldmljZSBpcyBub3QgcHJvdGVjdGVkIGJ5IGFuIElPTU1VLCBidXQgbXVzdCBiZSAoZXJyb3Ig
Y29uZGl0aW9uKQo+ICsgKiA+MCA6IGRldmljZSBkb2Vzbid0IG5lZWQgdG8gYmUgcHJvdGVjdGVk
IGJ5IGFuIElPTU1VCj4gKyAqICAgICAgKElPTU1VIGlzIG5vdCBlbmFibGVkL3ByZXNlbnQgb3Ig
ZGV2aWNlIGlzIG5vdCBjb25uZWN0ZWQgdG8gaXQpLgo+ICsgKi8KPiAraW50IGlvbW11X2FkZF9k
dF9kZXZpY2Uoc3RydWN0IGR0X2RldmljZV9ub2RlICpucCk7Cj4gKwo+ICAgaW50IGlvbW11X2Rv
X2R0X2RvbWN0bChzdHJ1Y3QgeGVuX2RvbWN0bCAqLCBzdHJ1Y3QgZG9tYWluICosCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0oeGVuX2RvbWN0bF90KSk7
Cj4gICAKPiBAQCAtMjUwLDYgKzI2MSwxNiBAQCBzdHJ1Y3QgaW9tbXVfb3BzIHsKPiAgICAgICBp
bnQgX19tdXN0X2NoZWNrICgqaW90bGJfZmx1c2hfYWxsKShzdHJ1Y3QgZG9tYWluICpkKTsKPiAg
ICAgICBpbnQgKCpnZXRfcmVzZXJ2ZWRfZGV2aWNlX21lbW9yeSkoaW9tbXVfZ3JkbV90ICosIHZv
aWQgKik7Cj4gICAgICAgdm9pZCAoKmR1bXBfcDJtX3RhYmxlKShzdHJ1Y3QgZG9tYWluICpkKTsK
PiArCj4gKyNpZmRlZiBDT05GSUdfSEFTX0RFVklDRV9UUkVFCj4gKyAgICAvKgo+ICsgICAgICog
QWxsIElPTU1VIGRyaXZlcnMgd2hpY2ggc3VwcG9ydCBnZW5lcmljIElPTU1VIERUIGJpbmRpbmdz
IHNob3VsZCB1c2UKPiArICAgICAqIHRoaXMgY2FsbGJhY2suIFRoaXMgaXMgYSB3YXkgZm9yIHRo
ZSBmcmFtZXdvcmsgdG8gcHJvdmlkZSB0aGUgZHJpdmVyCj4gKyAgICAgKiB3aXRoIERUIElPTU1V
IHNwZWNpZmllciB3aGljaCBkZXNjcmliZXMgdGhlIElPTU1VIG1hc3RlciBpbnRlcmZhY2VzIG9m
Cj4gKyAgICAgKiB0aGF0IGRldmljZSAoZGV2aWNlIElEcywgZXRjKS4KPiArICAgICAqLwo+ICsg
ICAgaW50ICgqZHRfeGxhdGUpKGRldmljZV90ICpkZXYsIGNvbnN0IHN0cnVjdCBkdF9waGFuZGxl
X2FyZ3MgKmFyZ3MpOwo+ICsjZW5kaWYKPiAgIH07Cj4gICAKPiAgICNpbmNsdWRlIDxhc20vaW9t
bXUuaD4KPiAKCi0tIApKdWxpZW4gR3JhbGwKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3Rz
LnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0
aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id EA32A17919D
	for <lists+xen-devel@lfdr.de>; Wed,  4 Mar 2020 14:42:54 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j9UFI-0006Wb-Go; Wed, 04 Mar 2020 13:39:32 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=FNX+=4V=yandex-team.ru=lekiravi@srs-us1.protection.inumbo.net>)
 id 1j9TkS-0003tR-IR
 for xen-devel@lists.xenproject.org; Wed, 04 Mar 2020 13:07:40 +0000
X-Inumbo-ID: 1e0fca4a-5e19-11ea-90c4-bc764e2007e4
Received: from forwardcorp1o.mail.yandex.net (unknown [2a02:6b8:0:1a2d::193])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 1e0fca4a-5e19-11ea-90c4-bc764e2007e4;
 Wed, 04 Mar 2020 13:07:36 +0000 (UTC)
Received: from mxbackcorp1o.mail.yandex.net (mxbackcorp1o.mail.yandex.net
 [IPv6:2a02:6b8:0:1a2d::301])
 by forwardcorp1o.mail.yandex.net (Yandex) with ESMTP id B6DE92E1764;
 Wed,  4 Mar 2020 16:07:35 +0300 (MSK)
Received: from sas1-9998cec34266.qloud-c.yandex.net
 (sas1-9998cec34266.qloud-c.yandex.net [2a02:6b8:c14:3a0e:0:640:9998:cec3])
 by mxbackcorp1o.mail.yandex.net (mxbackcorp/Yandex) with ESMTP id
 Gfkc1GFItu-7SaiCmmE; Wed, 04 Mar 2020 16:07:35 +0300
Precedence: bulk
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yandex-team.ru;
 s=default; 
 t=1583327255; bh=nlxUiX0vPzTyUjbVc3grdclin00oPgm2S/Tp+BITx2w=;
 h=In-Reply-To:Message-Id:References:Date:Subject:To:From:Cc;
 b=OOsV/a4j175NykMjjUVdUCu/5E0pLhN7XJaXC2wCwFNIEzJV9AfrVT+jCWcKMMexL
 qjjfOoetQbMg33IOQRGqDSYKQhcjK2NxA35ybSeTiUyq9L5fEnk5H6vvWFhaQuB0KP
 bCefIHXhVH5euwuqMECnR3gmYZfPGOTOb7uS00IU=
Authentication-Results: mxbackcorp1o.mail.yandex.net;
 dkim=pass header.i=@yandex-team.ru
Received: from dynamic-red.dhcp.yndx.net (dynamic-red.dhcp.yndx.net
 [2a02:6b8:0:40c:b4f7:3f29:4fea:8822])
 by sas1-9998cec34266.qloud-c.yandex.net (smtpcorp/Yandex) with ESMTPSA id
 ujb0Gsh6CR-7RWOip7E; Wed, 04 Mar 2020 16:07:27 +0300
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (Client certificate not present)
From: Alexey Kirillov <lekiravi@yandex-team.ru>
To: Eric Blake <eblake@redhat.com>, Thomas Huth <huth@tuxfamily.org>,
 Markus Armbruster <armbru@redhat.com>
Date: Wed,  4 Mar 2020 16:06:56 +0300
Message-Id: <20200304130656.16859-5-lekiravi@yandex-team.ru>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200304130656.16859-1-lekiravi@yandex-team.ru>
References: <20200304130656.16859-1-lekiravi@yandex-team.ru>
X-Mailman-Approved-At: Wed, 04 Mar 2020 13:39:29 +0000
Subject: [Xen-devel] [PATCH v2 4/4] net: Remove field info_str of
 NetClientState
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Peter Maydell <peter.maydell@linaro.org>,
 Dmitry Fleytman <dmitry.fleytman@gmail.com>,
 "Michael S. Tsirkin" <mst@redhat.com>, Jason Wang <jasowang@redhat.com>,
 qemu-devel@nongnu.org, Vincenzo Maffione <v.maffione@gmail.com>,
 Gerd Hoffmann <kraxel@redhat.com>,
 "Edgar E. Iglesias" <edgar.iglesias@gmail.com>,
 Sven Schnelle <svens@stackframe.org>, Rob Herring <robh@kernel.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Paul Durrant <paul@xen.org>,
 Joel Stanley <joel@jms.id.au>, Anthony Perard <anthony.perard@citrix.com>,
 Samuel Thibault <samuel.thibault@ens-lyon.org>,
 Aleksandar Rikalo <aleksandar.rikalo@rt-rk.com>,
 David Gibson <david@gibson.dropbear.id.au>,
 Laurent Vivier <lvivier@redhat.com>, Jiri Pirko <jiri@resnulli.us>,
 yc-core@yandex-team.ru, Stefan Weil <sw@weilnetz.de>,
 Alistair Francis <alistair@alistair23.me>,
 Beniamino Galvani <b.galvani@gmail.com>, qemu-arm@nongnu.org,
 Peter Chubb <peter.chubb@nicta.com.au>,
 =?UTF-8?q?C=C3=A9dric=20Le=20Goater?= <clg@kaod.org>,
 xen-devel@lists.xenproject.org, Giuseppe Lettieri <g.lettieri@iet.unipi.it>,
 Luigi Rizzo <rizzo@iet.unipi.it>, Richard Henderson <rth@twiddle.net>,
 Andrew Jeffery <andrew@aj.id.au>, Michael Walle <michael@walle.cc>,
 qemu-ppc@nongnu.org, Aleksandar Markovic <amarkovic@wavecomp.com>,
 Alexey Kirillov <lekiravi@yandex-team.ru>, Paolo Bonzini <pbonzini@redhat.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Q29tcGxldGVseSByZW1vdmUgdGhlIGluZm9fc3RyIGZpZWxkIG9mIHN0cnVjdCBOZXRDbGllbnRT
dGF0ZSBiZWNhdXNlCml0IGlzIG5vIGxvbmdlciByZXF1aXJlZCBkdWUgdG8gdGhlIGFkZGl0aW9u
IG9mIHRoZSBRTVAgcXVlcnktbmV0ZGV2cyBjb21tYW5kLgoKU2lnbmVkLW9mZi1ieTogQWxleGV5
IEtpcmlsbG92IDxsZWtpcmF2aUB5YW5kZXgtdGVhbS5ydT4KLS0tCiBody9uZXQvYWxsd2lubmVy
X2VtYWMuYyAgICAgfCAgMiArLQogaHcvbmV0L2RwODM5M3guYyAgICAgICAgICAgIHwgIDIgKy0K
IGh3L25ldC9lMTAwMC5jICAgICAgICAgICAgICB8ICA0ICsrLS0KIGh3L25ldC9lMTAwMGUuYyAg
ICAgICAgICAgICB8ICAyICstCiBody9uZXQvZTEwMDBlX2NvcmUuYyAgICAgICAgfCAgMiArLQog
aHcvbmV0L2UxMDAweF9jb21tb24uYyAgICAgIHwgIDIgKy0KIGh3L25ldC9lZXBybzEwMC5jICAg
ICAgICAgICB8ICA1ICsrKy0tCiBody9uZXQvZXRyYXhmc19ldGguYyAgICAgICAgfCAgMiArLQog
aHcvbmV0L2ZzbF9ldHNlYy9ldHNlYy5jICAgIHwgIDIgKy0KIGh3L25ldC9mdGdtYWMxMDAuYyAg
ICAgICAgICB8ICAyICstCiBody9uZXQvaTgyNTk2LmMgICAgICAgICAgICAgfCAgNiArKystLS0K
IGh3L25ldC9pbXhfZmVjLmMgICAgICAgICAgICB8ICAyICstCiBody9uZXQvbGFuOTExOC5jICAg
ICAgICAgICAgfCAgNCArKy0tCiBody9uZXQvbWNmX2ZlYy5jICAgICAgICAgICAgfCAgMiArLQog
aHcvbmV0L21pbGt5bWlzdC1taW5pbWFjMi5jIHwgIDIgKy0KIGh3L25ldC9taXBzbmV0LmMgICAg
ICAgICAgICB8ICAyICstCiBody9uZXQvbmUyMDAwLWlzYS5jICAgICAgICAgfCAgMiArLQogaHcv
bmV0L25lMjAwMC1wY2kuYyAgICAgICAgIHwgIDIgKy0KIGh3L25ldC9wY25ldC5jICAgICAgICAg
ICAgICB8ICAyICstCiBody9uZXQvcm9ja2VyL3JvY2tlcl9mcC5jICAgfCAgNCArKy0tCiBody9u
ZXQvcnRsODEzOS5jICAgICAgICAgICAgfCAgNiArKystLS0KIGh3L25ldC9zbWM5MWMxMTEuYyAg
ICAgICAgICB8ICAyICstCiBody9uZXQvc3BhcHJfbGxhbi5jICAgICAgICAgfCAgNiArKystLS0K
IGh3L25ldC9zdGVsbGFyaXNfZW5ldC5jICAgICB8ICAyICstCiBody9uZXQvc3VuZ2VtLmMgICAg
ICAgICAgICAgfCAgNCArKy0tCiBody9uZXQvc3VuaG1lLmMgICAgICAgICAgICAgfCAgMiArLQog
aHcvbmV0L3R1bGlwLmMgICAgICAgICAgICAgIHwgIDIgKy0KIGh3L25ldC92aXJ0aW8tbmV0LmMg
ICAgICAgICB8ICA4ICsrKystLS0tCiBody9uZXQvdm14bmV0My5jICAgICAgICAgICAgfCAgNCAr
Ky0tCiBody9uZXQveGVuX25pYy5jICAgICAgICAgICAgfCAgNCAtLS0tCiBody9uZXQveGdtYWMu
YyAgICAgICAgICAgICAgfCAgMiArLQogaHcvbmV0L3hpbGlueF9heGllbmV0LmMgICAgIHwgIDIg
Ky0KIGh3L25ldC94aWxpbnhfZXRobGl0ZS5jICAgICB8ICAyICstCiBody91c2IvZGV2LW5ldHdv
cmsuYyAgICAgICAgfCAgMiArLQogaW5jbHVkZS9uZXQvbmV0LmggICAgICAgICAgIHwgIDMgKy0t
CiBuZXQvbDJ0cHYzLmMgICAgICAgICAgICAgICAgfCAgMyAtLS0KIG5ldC9uZXQuYyAgICAgICAg
ICAgICAgICAgICB8ICA4ICstLS0tLS0tCiBuZXQvc2xpcnAuYyAgICAgICAgICAgICAgICAgfCAg
NCAtLS0tCiBuZXQvc29ja2V0LmMgICAgICAgICAgICAgICAgfCAyNCAtLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0KIG5ldC90YXAuYyAgICAgICAgICAgICAgICAgICB8IDEyIC0tLS0tLS0tLS0tLQog
bmV0L3ZkZS5jICAgICAgICAgICAgICAgICAgIHwgIDQgLS0tLQogbmV0L3Zob3N0LXVzZXIuYyAg
ICAgICAgICAgIHwgIDIgLS0KIDQyIGZpbGVzIGNoYW5nZWQsIDUxIGluc2VydGlvbnMoKyksIDEx
MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9ody9uZXQvYWxsd2lubmVyX2VtYWMuYyBiL2h3
L25ldC9hbGx3aW5uZXJfZW1hYy5jCmluZGV4IGU5YmJmZjg3MTAuLjZhYmJkYmZkNGIgMTAwNjQ0
Ci0tLSBhL2h3L25ldC9hbGx3aW5uZXJfZW1hYy5jCisrKyBiL2h3L25ldC9hbGx3aW5uZXJfZW1h
Yy5jCkBAIC00NTQsNyArNDU0LDcgQEAgc3RhdGljIHZvaWQgYXdfZW1hY19yZWFsaXplKERldmlj
ZVN0YXRlICpkZXYsIEVycm9yICoqZXJycCkKICAgICBxZW11X21hY2FkZHJfZGVmYXVsdF9pZl91
bnNldCgmcy0+Y29uZi5tYWNhZGRyKTsKICAgICBzLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF9h
d19lbWFjX2luZm8sICZzLT5jb25mLAogICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Rf
Z2V0X3R5cGVuYW1lKE9CSkVDVChkZXYpKSwgZGV2LT5pZCwgcyk7Ci0gICAgcWVtdV9mb3JtYXRf
bmljX2luZm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsK
KyAgICBxZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5j
b25mLm1hY2FkZHIuYSk7CiAKICAgICBmaWZvOF9jcmVhdGUoJnMtPnJ4X2ZpZm8sIFJYX0ZJRk9f
U0laRSk7CiAgICAgZmlmbzhfY3JlYXRlKCZzLT50eF9maWZvWzBdLCBUWF9GSUZPX1NJWkUpOwpk
aWZmIC0tZ2l0IGEvaHcvbmV0L2RwODM5M3guYyBiL2h3L25ldC9kcDgzOTN4LmMKaW5kZXggOGEz
NTA0ZDk2Mi4uYTZmOTViMDk3YiAxMDA2NDQKLS0tIGEvaHcvbmV0L2RwODM5M3guYworKysgYi9o
dy9uZXQvZHA4MzkzeC5jCkBAIC05ODIsNyArOTgyLDcgQEAgc3RhdGljIHZvaWQgZHA4MzkzeF9y
ZWFsaXplKERldmljZVN0YXRlICpkZXYsIEVycm9yICoqZXJycCkKIAogICAgIHMtPm5pYyA9IHFl
bXVfbmV3X25pYygmbmV0X2RwODM5MzJfaW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG9iamVjdF9nZXRfdHlwZW5hbWUoT0JKRUNUKGRldikpLCBkZXYtPmlkLCBzKTsK
LSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+
Y29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1
ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKIAogICAgIHMtPndhdGNoZG9nID0gdGlt
ZXJfbmV3X25zKFFFTVVfQ0xPQ0tfVklSVFVBTCwgZHA4MzkzeF93YXRjaGRvZywgcyk7CiAKZGlm
ZiAtLWdpdCBhL2h3L25ldC9lMTAwMC5jIGIvaHcvbmV0L2UxMDAwLmMKaW5kZXggMGI4MzNkNWEx
NS4uNWFlNTJlMzdlYSAxMDA2NDQKLS0tIGEvaHcvbmV0L2UxMDAwLmMKKysrIGIvaHcvbmV0L2Ux
MDAwLmMKQEAgLTEwOTUsNyArMTA5NSw3IEBAIG1hY193cml0ZXJlZyhFMTAwMFN0YXRlICpzLCBp
bnQgaW5kZXgsIHVpbnQzMl90IHZhbCkKICAgICBpZiAoaW5kZXggPT0gUkEgKyAxKSB7CiAgICAg
ICAgIG1hY2FkZHJbMF0gPSBjcHVfdG9fbGUzMihzLT5tYWNfcmVnW1JBXSk7CiAgICAgICAgIG1h
Y2FkZHJbMV0gPSBjcHVfdG9fbGUzMihzLT5tYWNfcmVnW1JBICsgMV0pOwotICAgICAgICBxZW11
X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgKHVpbnQ4X3QgKilt
YWNhZGRyKTsKKyAgICAgICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUo
cy0+bmljKSwgKHVpbnQ4X3QgKiltYWNhZGRyKTsKICAgICB9CiB9CiAKQEAgLTE3MTEsNyArMTcx
MSw3IEBAIHN0YXRpYyB2b2lkIHBjaV9lMTAwMF9yZWFsaXplKFBDSURldmljZSAqcGNpX2Rldiwg
RXJyb3IgKiplcnJwKQogICAgIGQtPm5pYyA9IHFlbXVfbmV3X25pYygmbmV0X2UxMDAwX2luZm8s
ICZkLT5jb25mLAogICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfZ2V0X3R5cGVuYW1l
KE9CSkVDVChkKSksIGRldi0+aWQsIGQpOwogCi0gICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3Ry
KHFlbXVfZ2V0X3F1ZXVlKGQtPm5pYyksIG1hY2FkZHIpOworICAgIHFlbXVfdXBkYXRlX25pY19t
YWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKGQtPm5pYyksIG1hY2FkZHIpOwogCiAgICAgZC0+YXV0b25l
Z190aW1lciA9IHRpbWVyX25ld19tcyhRRU1VX0NMT0NLX1ZJUlRVQUwsIGUxMDAwX2F1dG9uZWdf
dGltZXIsIGQpOwogICAgIGQtPm1pdF90aW1lciA9IHRpbWVyX25ld19ucyhRRU1VX0NMT0NLX1ZJ
UlRVQUwsIGUxMDAwX21pdF90aW1lciwgZCk7CmRpZmYgLS1naXQgYS9ody9uZXQvZTEwMDBlLmMg
Yi9ody9uZXQvZTEwMDBlLmMKaW5kZXggYTkxZGJkY2EzYy4uNzYzNjYxMjI3ZCAxMDA2NDQKLS0t
IGEvaHcvbmV0L2UxMDAwZS5jCisrKyBiL2h3L25ldC9lMTAwMGUuYwpAQCAtMzMzLDcgKzMzMyw3
IEBAIGUxMDAwZV9pbml0X25ldF9wZWVyKEUxMDAwRVN0YXRlICpzLCBQQ0lEZXZpY2UgKnBjaV9k
ZXYsIHVpbnQ4X3QgKm1hY2FkZHIpCiAgICAgdHJhY2VfZTEwMDBlX21hY19zZXRfcGVybWFuZW50
KE1BQ19BUkcobWFjYWRkcikpOwogICAgIG1lbWNweShzLT5jb3JlLnBlcm1hbmVudF9tYWMsIG1h
Y2FkZHIsIHNpemVvZihzLT5jb3JlLnBlcm1hbmVudF9tYWMpKTsKIAotICAgIHFlbXVfZm9ybWF0
X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBtYWNhZGRyKTsKKyAgICBxZW11
X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBtYWNhZGRyKTsKIAog
ICAgIC8qIFNldHVwIHZpcnRpbyBoZWFkZXJzICovCiAgICAgaWYgKHMtPmRpc2FibGVfdm5ldCkg
ewpkaWZmIC0tZ2l0IGEvaHcvbmV0L2UxMDAwZV9jb3JlLmMgYi9ody9uZXQvZTEwMDBlX2NvcmUu
YwppbmRleCA5NGVhMzRkY2E1Li4zNThlOTBiNDBkIDEwMDY0NAotLS0gYS9ody9uZXQvZTEwMDBl
X2NvcmUuYworKysgYi9ody9uZXQvZTEwMDBlX2NvcmUuYwpAQCAtMjczMSw3ICsyNzMxLDcgQEAg
ZTEwMDBlX21hY19zZXRtYWNhZGRyKEUxMDAwRUNvcmUgKmNvcmUsIGludCBpbmRleCwgdWludDMy
X3QgdmFsKQogCiAgICAgbWFjYWRkclswXSA9IGNwdV90b19sZTMyKGNvcmUtPm1hY1tSQV0pOwog
ICAgIG1hY2FkZHJbMV0gPSBjcHVfdG9fbGUzMihjb3JlLT5tYWNbUkEgKyAxXSk7Ci0gICAgcWVt
dV9mb3JtYXRfbmljX2luZm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKGNvcmUtPm93bmVyX25pYyksCisg
ICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUoY29yZS0+b3duZXJfbmlj
KSwKICAgICAgICAgKHVpbnQ4X3QgKikgbWFjYWRkcik7CiAKICAgICB0cmFjZV9lMTAwMGVfbWFj
X3NldF9zdyhNQUNfQVJHKG1hY2FkZHIpKTsKZGlmZiAtLWdpdCBhL2h3L25ldC9lMTAwMHhfY29t
bW9uLmMgYi9ody9uZXQvZTEwMDB4X2NvbW1vbi5jCmluZGV4IDcxN2Y5ZGYxYzkuLmFkNjZkZDNk
NTUgMTAwNjQ0Ci0tLSBhL2h3L25ldC9lMTAwMHhfY29tbW9uLmMKKysrIGIvaHcvbmV0L2UxMDAw
eF9jb21tb24uYwpAQCAtMTQ1LDcgKzE0NSw3IEBAIHZvaWQgZTEwMDB4X3Jlc2V0X21hY19hZGRy
KE5JQ1N0YXRlICpuaWMsIHVpbnQzMl90ICptYWNfcmVncywKICAgICAgICAgICAgIChpIDwgMikg
PyBtYWNfYWRkcltpICsgNF0gPDwgKDggKiBpKSA6IDA7CiAgICAgfQogCi0gICAgcWVtdV9mb3Jt
YXRfbmljX2luZm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKG5pYyksIG1hY19hZGRyKTsKKyAgICBxZW11
X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShuaWMpLCBtYWNfYWRkcik7CiAgICAg
dHJhY2VfZTEwMDB4X21hY19pbmRpY2F0ZShNQUNfQVJHKG1hY19hZGRyKSk7CiB9CiAKZGlmZiAt
LWdpdCBhL2h3L25ldC9lZXBybzEwMC5jIGIvaHcvbmV0L2VlcHJvMTAwLmMKaW5kZXggZjY0NzRm
MGU2OC4uMzFjYjVjMDA3ZiAxMDA2NDQKLS0tIGEvaHcvbmV0L2VlcHJvMTAwLmMKKysrIGIvaHcv
bmV0L2VlcHJvMTAwLmMKQEAgLTE4NjcsOCArMTg2Nyw5IEBAIHN0YXRpYyB2b2lkIGUxMDBfbmlj
X3JlYWxpemUoUENJRGV2aWNlICpwY2lfZGV2LCBFcnJvciAqKmVycnApCiAgICAgcy0+bmljID0g
cWVtdV9uZXdfbmljKCZuZXRfZWVwcm8xMDBfaW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG9iamVjdF9nZXRfdHlwZW5hbWUoT0JKRUNUKHBjaV9kZXYpKSwgcGNpX2Rl
di0+cWRldi5pZCwgcyk7CiAKLSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRf
cXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOwotICAgIFRSQUNFKE9USEVSLCBsb2dv
dXQoIiVzXG4iLCBxZW11X2dldF9xdWV1ZShzLT5uaWMpLT5pbmZvX3N0cikpOworICAgIHFlbXVf
dXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRk
ci5hKTsKKyAgICBUUkFDRShPVEhFUiwgbG9nb3V0KCJtYWNhZGRyPSVzXG4iLAorICAgICAgICAg
ICAgICAgICAgICAgICAgcWVtdV9nZXRfcXVldWUocy0+bmljKS0+c3RvcmVkX2NvbmZpZy0+dS5u
aWMubWFjYWRkcikpOwogCiAgICAgcWVtdV9yZWdpc3Rlcl9yZXNldChuaWNfcmVzZXQsIHMpOwog
CmRpZmYgLS1naXQgYS9ody9uZXQvZXRyYXhmc19ldGguYyBiL2h3L25ldC9ldHJheGZzX2V0aC5j
CmluZGV4IDI3ZmQwNjliOTYuLmRjY2RjYjllNjcgMTAwNjQ0Ci0tLSBhL2h3L25ldC9ldHJheGZz
X2V0aC5jCisrKyBiL2h3L25ldC9ldHJheGZzX2V0aC5jCkBAIC02MjAsNyArNjIwLDcgQEAgc3Rh
dGljIHZvaWQgZXRyYXhmc19ldGhfcmVhbGl6ZShEZXZpY2VTdGF0ZSAqZGV2LCBFcnJvciAqKmVy
cnApCiAgICAgcWVtdV9tYWNhZGRyX2RlZmF1bHRfaWZfdW5zZXQoJnMtPmNvbmYubWFjYWRkcik7
CiAgICAgcy0+bmljID0gcWVtdV9uZXdfbmljKCZuZXRfZXRyYXhmc19pbmZvLCAmcy0+Y29uZiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X2dldF90eXBlbmFtZShPQkpFQ1Qocykp
LCBkZXYtPmlkLCBzKTsKLSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVl
dWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNh
ZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKIAogICAgIHMt
PnBoeS5yZWFkID0gdGRrX3JlYWQ7CiAgICAgcy0+cGh5LndyaXRlID0gdGRrX3dyaXRlOwpkaWZm
IC0tZ2l0IGEvaHcvbmV0L2ZzbF9ldHNlYy9ldHNlYy5jIGIvaHcvbmV0L2ZzbF9ldHNlYy9ldHNl
Yy5jCmluZGV4IDQ3NWYzYzg4N2EuLjFkZTljMmZmZjMgMTAwNjQ0Ci0tLSBhL2h3L25ldC9mc2xf
ZXRzZWMvZXRzZWMuYworKysgYi9ody9uZXQvZnNsX2V0c2VjL2V0c2VjLmMKQEAgLTM5MCw3ICsz
OTAsNyBAQCBzdGF0aWMgdm9pZCBldHNlY19yZWFsaXplKERldmljZVN0YXRlICpkZXYsIEVycm9y
ICoqZXJycCkKIAogICAgIGV0c2VjLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF9ldHNlY19pbmZv
LCAmZXRzZWMtPmNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfZ2V0
X3R5cGVuYW1lKE9CSkVDVChkZXYpKSwgZGV2LT5pZCwgZXRzZWMpOwotICAgIHFlbXVfZm9ybWF0
X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShldHNlYy0+bmljKSwgZXRzZWMtPmNvbmYubWFj
YWRkci5hKTsKKyAgICBxZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShldHNl
Yy0+bmljKSwgZXRzZWMtPmNvbmYubWFjYWRkci5hKTsKIAogICAgIGV0c2VjLT5wdGltZXIgPSBw
dGltZXJfaW5pdChldHNlY190aW1lcl9oaXQsIGV0c2VjLCBQVElNRVJfUE9MSUNZX0RFRkFVTFQp
OwogICAgIHB0aW1lcl90cmFuc2FjdGlvbl9iZWdpbihldHNlYy0+cHRpbWVyKTsKZGlmZiAtLWdp
dCBhL2h3L25ldC9mdGdtYWMxMDAuYyBiL2h3L25ldC9mdGdtYWMxMDAuYwppbmRleCAyZjkyYjY1
ZDRlLi4xNDI4NmNhYzgxIDEwMDY0NAotLS0gYS9ody9uZXQvZnRnbWFjMTAwLmMKKysrIGIvaHcv
bmV0L2Z0Z21hYzEwMC5jCkBAIC0xMDM3LDcgKzEwMzcsNyBAQCBzdGF0aWMgdm9pZCBmdGdtYWMx
MDBfcmVhbGl6ZShEZXZpY2VTdGF0ZSAqZGV2LCBFcnJvciAqKmVycnApCiAgICAgcy0+bmljID0g
cWVtdV9uZXdfbmljKCZuZXRfZnRnbWFjMTAwX2luZm8sICZzLT5jb25mLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICBvYmplY3RfZ2V0X3R5cGVuYW1lKE9CSkVDVChkZXYpKSwgREVWSUNFKGRl
diktPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzKTsKLSAgICBxZW11X2Zvcm1hdF9u
aWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOwor
ICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNv
bmYubWFjYWRkci5hKTsKIH0KIAogc3RhdGljIGNvbnN0IFZNU3RhdGVEZXNjcmlwdGlvbiB2bXN0
YXRlX2Z0Z21hYzEwMCA9IHsKZGlmZiAtLWdpdCBhL2h3L25ldC9pODI1OTYuYyBiL2h3L25ldC9p
ODI1OTYuYwppbmRleCBmZTlmMjM5MGE5Li4zZDYyNzIwOTIwIDEwMDY0NAotLS0gYS9ody9uZXQv
aTgyNTk2LmMKKysrIGIvaHcvbmV0L2k4MjU5Ni5jCkBAIC0xNzQsOCArMTc0LDggQEAgc3RhdGlj
IHZvaWQgc2V0X2luZGl2aWR1YWxfYWRkcmVzcyhJODI1OTZTdGF0ZSAqcywgdWludDMyX3QgYWRk
cikKICAgICBtID0gcy0+Y29uZi5tYWNhZGRyLmE7CiAgICAgYWRkcmVzc19zcGFjZV9yZWFkKCZh
ZGRyZXNzX3NwYWNlX21lbW9yeSwgYWRkciArIDgsCiAgICAgICAgICAgICAgICAgICAgICAgIE1F
TVRYQVRUUlNfVU5TUEVDSUZJRUQsIG0sIEVUSF9BTEVOKTsKLSAgICBxZW11X2Zvcm1hdF9uaWNf
aW5mb19zdHIobmMsIG0pOwotICAgIHRyYWNlX2k4MjU5Nl9uZXdfbWFjKG5jLT5pbmZvX3N0cik7
CisgICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIobmMsIG0pOworICAgIHRyYWNlX2k4MjU5Nl9u
ZXdfbWFjKG5jLT5zdG9yZWRfY29uZmlnLT51Lm5pYy5tYWNhZGRyKTsKIH0KIAogc3RhdGljIHZv
aWQgc2V0X211bHRpY2FzdF9saXN0KEk4MjU5NlN0YXRlICpzLCB1aW50MzJfdCBhZGRyKQpAQCAt
NzIzLDcgKzcyMyw3IEBAIHZvaWQgaTgyNTk2X2NvbW1vbl9pbml0KERldmljZVN0YXRlICpkZXYs
IEk4MjU5NlN0YXRlICpzLCBOZXRDbGllbnRJbmZvICppbmZvKQogICAgIH0KICAgICBzLT5uaWMg
PSBxZW11X25ld19uaWMoaW5mbywgJnMtPmNvbmYsIG9iamVjdF9nZXRfdHlwZW5hbWUoT0JKRUNU
KGRldikpLAogICAgICAgICAgICAgICAgIGRldi0+aWQsIHMpOwotICAgIHFlbXVfZm9ybWF0X25p
Y19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7Cisg
ICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29u
Zi5tYWNhZGRyLmEpOwogCiAgICAgaWYgKFVTRV9USU1FUikgewogICAgICAgICBzLT5mbHVzaF9x
dWV1ZV90aW1lciA9IHRpbWVyX25ld19ucyhRRU1VX0NMT0NLX1ZJUlRVQUwsCmRpZmYgLS1naXQg
YS9ody9uZXQvaW14X2ZlYy5jIGIvaHcvbmV0L2lteF9mZWMuYwppbmRleCA2YTEyNGExNTRhLi5l
ODA0N2VjNDJlIDEwMDY0NAotLS0gYS9ody9uZXQvaW14X2ZlYy5jCisrKyBiL2h3L25ldC9pbXhf
ZmVjLmMKQEAgLTEzMjMsNyArMTMyMyw3IEBAIHN0YXRpYyB2b2lkIGlteF9ldGhfcmVhbGl6ZShE
ZXZpY2VTdGF0ZSAqZGV2LCBFcnJvciAqKmVycnApCiAgICAgICAgICAgICAgICAgICAgICAgICAg
IG9iamVjdF9nZXRfdHlwZW5hbWUoT0JKRUNUKGRldikpLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICBERVZJQ0UoZGV2KS0+aWQsIHMpOwogCi0gICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3Ry
KHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKKyAgICBxZW11X3Vw
ZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1hY2FkZHIu
YSk7CiB9CiAKIHN0YXRpYyBQcm9wZXJ0eSBpbXhfZXRoX3Byb3BlcnRpZXNbXSA9IHsKZGlmZiAt
LWdpdCBhL2h3L25ldC9sYW45MTE4LmMgYi9ody9uZXQvbGFuOTExOC5jCmluZGV4IGRhN2UwYmIw
ZTguLjBjMWJjMGYwZWIgMTAwNjQ0Ci0tLSBhL2h3L25ldC9sYW45MTE4LmMKKysrIGIvaHcvbmV0
L2xhbjkxMTguYwpAQCAtMzUzLDcgKzM1Myw3IEBAIHN0YXRpYyB2b2lkIGxhbjkxMThfdXBkYXRl
KGxhbjkxMThfc3RhdGUgKnMpCiAKIHN0YXRpYyB2b2lkIGxhbjkxMThfbWFjX2NoYW5nZWQobGFu
OTExOF9zdGF0ZSAqcykKIHsKLSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRf
cXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19t
YWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKIH0KIAog
c3RhdGljIHZvaWQgbGFuOTExOF9yZWxvYWRfZWVwcm9tKGxhbjkxMThfc3RhdGUgKnMpCkBAIC0x
MzQzLDcgKzEzNDMsNyBAQCBzdGF0aWMgdm9pZCBsYW45MTE4X3JlYWxpemUoRGV2aWNlU3RhdGUg
KmRldiwgRXJyb3IgKiplcnJwKQogCiAgICAgcy0+bmljID0gcWVtdV9uZXdfbmljKCZuZXRfbGFu
OTExOF9pbmZvLCAmcy0+Y29uZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X2dl
dF90eXBlbmFtZShPQkpFQ1QoZGV2KSksIGRldi0+aWQsIHMpOwotICAgIHFlbXVfZm9ybWF0X25p
Y19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7Cisg
ICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29u
Zi5tYWNhZGRyLmEpOwogICAgIHMtPmVlcHJvbVswXSA9IDB4YTU7CiAgICAgZm9yIChpID0gMDsg
aSA8IDY7IGkrKykgewogICAgICAgICBzLT5lZXByb21baSArIDFdID0gcy0+Y29uZi5tYWNhZGRy
LmFbaV07CmRpZmYgLS1naXQgYS9ody9uZXQvbWNmX2ZlYy5jIGIvaHcvbmV0L21jZl9mZWMuYwpp
bmRleCA5MzI3YWM4YTMwLi41NjkwYTQ4ODI5IDEwMDY0NAotLS0gYS9ody9uZXQvbWNmX2ZlYy5j
CisrKyBiL2h3L25ldC9tY2ZfZmVjLmMKQEAgLTY0MSw3ICs2NDEsNyBAQCBzdGF0aWMgdm9pZCBt
Y2ZfZmVjX3JlYWxpemUoRGV2aWNlU3RhdGUgKmRldiwgRXJyb3IgKiplcnJwKQogCiAgICAgcy0+
bmljID0gcWVtdV9uZXdfbmljKCZuZXRfbWNmX2ZlY19pbmZvLCAmcy0+Y29uZiwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgb2JqZWN0X2dldF90eXBlbmFtZShPQkpFQ1QoZGV2KSksIGRldi0+
aWQsIHMpOwotICAgIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5u
aWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7CisgICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVt
dV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOwogfQogCiBzdGF0aWMgdm9p
ZCBtY2ZfZmVjX2luc3RhbmNlX2luaXQoT2JqZWN0ICpvYmopCmRpZmYgLS1naXQgYS9ody9uZXQv
bWlsa3ltaXN0LW1pbmltYWMyLmMgYi9ody9uZXQvbWlsa3ltaXN0LW1pbmltYWMyLmMKaW5kZXgg
MWJhMDE3NTRlZS4uMTg1MmVjMTI0ZSAxMDA2NDQKLS0tIGEvaHcvbmV0L21pbGt5bWlzdC1taW5p
bWFjMi5jCisrKyBiL2h3L25ldC9taWxreW1pc3QtbWluaW1hYzIuYwpAQCAtNDg1LDcgKzQ4NSw3
IEBAIHN0YXRpYyB2b2lkIG1pbGt5bWlzdF9taW5pbWFjMl9yZWFsaXplKERldmljZVN0YXRlICpk
ZXYsIEVycm9yICoqZXJycCkKICAgICBxZW11X21hY2FkZHJfZGVmYXVsdF9pZl91bnNldCgmcy0+
Y29uZi5tYWNhZGRyKTsKICAgICBzLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF9taWxreW1pc3Rf
bWluaW1hYzJfaW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVj
dF9nZXRfdHlwZW5hbWUoT0JKRUNUKGRldikpLCBkZXYtPmlkLCBzKTsKLSAgICBxZW11X2Zvcm1h
dF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEp
OworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMt
PmNvbmYubWFjYWRkci5hKTsKIH0KIAogc3RhdGljIGNvbnN0IFZNU3RhdGVEZXNjcmlwdGlvbiB2
bXN0YXRlX21pbGt5bWlzdF9taW5pbWFjMl9tZGlvID0gewpkaWZmIC0tZ2l0IGEvaHcvbmV0L21p
cHNuZXQuYyBiL2h3L25ldC9taXBzbmV0LmMKaW5kZXggMGM1NzhjNDMwYy4uY2EyNjQ5ZDRkMiAx
MDA2NDQKLS0tIGEvaHcvbmV0L21pcHNuZXQuYworKysgYi9ody9uZXQvbWlwc25ldC5jCkBAIC0y
NTUsNyArMjU1LDcgQEAgc3RhdGljIHZvaWQgbWlwc25ldF9yZWFsaXplKERldmljZVN0YXRlICpk
ZXYsIEVycm9yICoqZXJycCkKIAogICAgIHMtPm5pYyA9IHFlbXVfbmV3X25pYygmbmV0X21pcHNu
ZXRfaW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF9nZXRf
dHlwZW5hbWUoT0JKRUNUKGRldikpLCBkZXYtPmlkLCBzKTsKLSAgICBxZW11X2Zvcm1hdF9uaWNf
aW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOworICAg
IHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYu
bWFjYWRkci5hKTsKIH0KIAogc3RhdGljIHZvaWQgbWlwc25ldF9zeXNidXNfcmVzZXQoRGV2aWNl
U3RhdGUgKmRldikKZGlmZiAtLWdpdCBhL2h3L25ldC9uZTIwMDAtaXNhLmMgYi9ody9uZXQvbmUy
MDAwLWlzYS5jCmluZGV4IGU3NDRlZmYxNTMuLmY0ZDc3OTEyNzEgMTAwNjQ0Ci0tLSBhL2h3L25l
dC9uZTIwMDAtaXNhLmMKKysrIGIvaHcvbmV0L25lMjAwMC1pc2EuYwpAQCAtNzQsNyArNzQsNyBA
QCBzdGF0aWMgdm9pZCBpc2FfbmUyMDAwX3JlYWxpemVmbihEZXZpY2VTdGF0ZSAqZGV2LCBFcnJv
ciAqKmVycnApCiAKICAgICBzLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF9uZTIwMDBfaXNhX2lu
Zm8sICZzLT5jLAogICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfZ2V0X3R5cGVuYW1l
KE9CSkVDVChkZXYpKSwgZGV2LT5pZCwgcyk7Ci0gICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3Ry
KHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmMubWFjYWRkci5hKTsKKyAgICBxZW11X3VwZGF0
ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jLm1hY2FkZHIuYSk7CiB9
CiAKIHN0YXRpYyBQcm9wZXJ0eSBuZTIwMDBfaXNhX3Byb3BlcnRpZXNbXSA9IHsKZGlmZiAtLWdp
dCBhL2h3L25ldC9uZTIwMDAtcGNpLmMgYi9ody9uZXQvbmUyMDAwLXBjaS5jCmluZGV4IGUxMWQ2
N2JmNzUuLmU4NjkwZjQ3ZTIgMTAwNjQ0Ci0tLSBhL2h3L25ldC9uZTIwMDAtcGNpLmMKKysrIGIv
aHcvbmV0L25lMjAwMC1wY2kuYwpAQCAtNzIsNyArNzIsNyBAQCBzdGF0aWMgdm9pZCBwY2lfbmUy
MDAwX3JlYWxpemUoUENJRGV2aWNlICpwY2lfZGV2LCBFcnJvciAqKmVycnApCiAgICAgcy0+bmlj
ID0gcWVtdV9uZXdfbmljKCZuZXRfbmUyMDAwX2luZm8sICZzLT5jLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICBvYmplY3RfZ2V0X3R5cGVuYW1lKE9CSkVDVChwY2lfZGV2KSksCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHBjaV9kZXYtPnFkZXYuaWQsIHMpOwotICAgIHFlbXVfZm9ybWF0
X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jLm1hY2FkZHIuYSk7Cisg
ICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Yy5t
YWNhZGRyLmEpOwogfQogCiBzdGF0aWMgdm9pZCBwY2lfbmUyMDAwX2V4aXQoUENJRGV2aWNlICpw
Y2lfZGV2KQpkaWZmIC0tZ2l0IGEvaHcvbmV0L3BjbmV0LmMgYi9ody9uZXQvcGNuZXQuYwppbmRl
eCBmM2YxOGQ4NTk4Li5lY2IxZmNiMzMyIDEwMDY0NAotLS0gYS9ody9uZXQvcGNuZXQuYworKysg
Yi9ody9uZXQvcGNuZXQuYwpAQCAtMTcxOSw3ICsxNzE5LDcgQEAgdm9pZCBwY25ldF9jb21tb25f
aW5pdChEZXZpY2VTdGF0ZSAqZGV2LCBQQ05ldFN0YXRlICpzLCBOZXRDbGllbnRJbmZvICppbmZv
KQogCiAgICAgcWVtdV9tYWNhZGRyX2RlZmF1bHRfaWZfdW5zZXQoJnMtPmNvbmYubWFjYWRkcik7
CiAgICAgcy0+bmljID0gcWVtdV9uZXdfbmljKGluZm8sICZzLT5jb25mLCBvYmplY3RfZ2V0X3R5
cGVuYW1lKE9CSkVDVChkZXYpKSwgZGV2LT5pZCwgcyk7Ci0gICAgcWVtdV9mb3JtYXRfbmljX2lu
Zm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKKyAgICBx
ZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1h
Y2FkZHIuYSk7CiAKICAgICAvKiBJbml0aWFsaXplIHRoZSBQUk9NICovCiAKZGlmZiAtLWdpdCBh
L2h3L25ldC9yb2NrZXIvcm9ja2VyX2ZwLmMgYi9ody9uZXQvcm9ja2VyL3JvY2tlcl9mcC5jCmlu
ZGV4IDRhYTdkYTc5YjguLmRkYjIxOTE5NDkgMTAwNjQ0Ci0tLSBhL2h3L25ldC9yb2NrZXIvcm9j
a2VyX2ZwLmMKKysrIGIvaHcvbmV0L3JvY2tlci9yb2NrZXJfZnAuYwpAQCAtMjQwLDggKzI0MCw4
IEBAIEZwUG9ydCAqZnBfcG9ydF9hbGxvYyhSb2NrZXIgKnIsIGNoYXIgKnN3X25hbWUsCiAKICAg
ICBwb3J0LT5uaWMgPSBxZW11X25ld19uaWMoJmZwX3BvcnRfaW5mbywgJnBvcnQtPmNvbmYsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3X25hbWUsIE5VTEwsIHBvcnQpOwotICAgIHFl
bXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShwb3J0LT5uaWMpLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwb3J0LT5jb25mLm1hY2FkZHIuYSk7CisgICAgcWVtdV91
cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocG9ydC0+bmljKSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwb3J0LT5jb25mLm1hY2FkZHIuYSk7CiAKICAgICBmcF9wb3J0X3Jl
c2V0KHBvcnQpOwogCmRpZmYgLS1naXQgYS9ody9uZXQvcnRsODEzOS5jIGIvaHcvbmV0L3J0bDgx
MzkuYwppbmRleCBhZTQ3MzliYzA5Li5hM2Y0MmVhNTY3IDEwMDY0NAotLS0gYS9ody9uZXQvcnRs
ODEzOS5jCisrKyBiL2h3L25ldC9ydGw4MTM5LmMKQEAgLTEyMjcsNyArMTIyNyw3IEBAIHN0YXRp
YyB2b2lkIHJ0bDgxMzlfcmVzZXQoRGV2aWNlU3RhdGUgKmQpCiAKICAgICAvKiByZXN0b3JlIE1B
QyBhZGRyZXNzICovCiAgICAgbWVtY3B5KHMtPnBoeXMsIHMtPmNvbmYubWFjYWRkci5hLCA2KTsK
LSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+
cGh5cyk7CisgICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmlj
KSwgcy0+cGh5cyk7CiAKICAgICAvKiByZXNldCBpbnRlcnJ1cHQgbWFzayAqLwogICAgIHMtPklu
dHJTdGF0dXMgPSAwOwpAQCAtMjY3Niw3ICsyNjc2LDcgQEAgc3RhdGljIHZvaWQgcnRsODEzOV9p
b193cml0ZWIodm9pZCAqb3BhcXVlLCB1aW50OF90IGFkZHIsIHVpbnQzMl90IHZhbCkKICAgICAg
ICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIE1BQzArNToKICAgICAgICAgICAgIHMtPnBoeXNb
YWRkciAtIE1BQzBdID0gdmFsOwotICAgICAgICAgICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3Ry
KHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPnBoeXMpOworICAgICAgICAgICAgcWVtdV91cGRh
dGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+cGh5cyk7CiAgICAgICAg
ICAgICBicmVhazsKICAgICAgICAgY2FzZSBNQUMwKzYgLi4uIE1BQzArNzoKICAgICAgICAgICAg
IC8qIHJlc2VydmVkICovCkBAIC0zMzk4LDcgKzMzOTgsNyBAQCBzdGF0aWMgdm9pZCBwY2lfcnRs
ODEzOV9yZWFsaXplKFBDSURldmljZSAqZGV2LCBFcnJvciAqKmVycnApCiAKICAgICBzLT5uaWMg
PSBxZW11X25ld19uaWMoJm5ldF9ydGw4MTM5X2luZm8sICZzLT5jb25mLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICBvYmplY3RfZ2V0X3R5cGVuYW1lKE9CSkVDVChkZXYpKSwgZC0+aWQsIHMp
OwotICAgIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBz
LT5jb25mLm1hY2FkZHIuYSk7CisgICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRf
cXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOwogCiAgICAgcy0+Y3BsdXNfdHhidWZm
ZXIgPSBOVUxMOwogICAgIHMtPmNwbHVzX3R4YnVmZmVyX2xlbiA9IDA7CmRpZmYgLS1naXQgYS9o
dy9uZXQvc21jOTFjMTExLmMgYi9ody9uZXQvc21jOTFjMTExLmMKaW5kZXggZTllYjZmNmMwNS4u
ZjIzNzQ2ZGMzMyAxMDA2NDQKLS0tIGEvaHcvbmV0L3NtYzkxYzExMS5jCisrKyBiL2h3L25ldC9z
bWM5MWMxMTEuYwpAQCAtNzgyLDcgKzc4Miw3IEBAIHN0YXRpYyB2b2lkIHNtYzkxYzExMV9yZWFs
aXplKERldmljZVN0YXRlICpkZXYsIEVycm9yICoqZXJycCkKICAgICBxZW11X21hY2FkZHJfZGVm
YXVsdF9pZl91bnNldCgmcy0+Y29uZi5tYWNhZGRyKTsKICAgICBzLT5uaWMgPSBxZW11X25ld19u
aWMoJm5ldF9zbWM5MWMxMTFfaW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG9iamVjdF9nZXRfdHlwZW5hbWUoT0JKRUNUKGRldikpLCBkZXYtPmlkLCBzKTsKLSAgICBx
ZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29uZi5t
YWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMt
Pm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKICAgICAvKiA/Pz8gU2F2ZS9yZXN0b3JlLiAgKi8K
IH0KIApkaWZmIC0tZ2l0IGEvaHcvbmV0L3NwYXByX2xsYW4uYyBiL2h3L25ldC9zcGFwcl9sbGFu
LmMKaW5kZXggODBmNWExZGQzNy4uMjZiMTFhMjFhOSAxMDA2NDQKLS0tIGEvaHcvbmV0L3NwYXBy
X2xsYW4uYworKysgYi9ody9uZXQvc3BhcHJfbGxhbi5jCkBAIC0zMTQsNyArMzE0LDcgQEAgc3Rh
dGljIHZvaWQgc3BhcHJfdmxhbl9yZXNldChTcGFwclZpb0RldmljZSAqc2RldikKIAogICAgIG1l
bWNweSgmZGV2LT5uaWNjb25mLm1hY2FkZHIuYSwgJmRldi0+cGVybV9tYWMuYSwKICAgICAgICAg
ICAgc2l6ZW9mKGRldi0+bmljY29uZi5tYWNhZGRyLmEpKTsKLSAgICBxZW11X2Zvcm1hdF9uaWNf
aW5mb19zdHIocWVtdV9nZXRfcXVldWUoZGV2LT5uaWMpLCBkZXYtPm5pY2NvbmYubWFjYWRkci5h
KTsKKyAgICBxZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShkZXYtPm5pYyks
IGRldi0+bmljY29uZi5tYWNhZGRyLmEpOwogfQogCiBzdGF0aWMgdm9pZCBzcGFwcl92bGFuX3Jl
YWxpemUoU3BhcHJWaW9EZXZpY2UgKnNkZXYsIEVycm9yICoqZXJycCkKQEAgLTMyNyw3ICszMjcs
NyBAQCBzdGF0aWMgdm9pZCBzcGFwcl92bGFuX3JlYWxpemUoU3BhcHJWaW9EZXZpY2UgKnNkZXYs
IEVycm9yICoqZXJycCkKIAogICAgIGRldi0+bmljID0gcWVtdV9uZXdfbmljKCZuZXRfc3BhcHJf
dmxhbl9pbmZvLCAmZGV2LT5uaWNjb25mLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9i
amVjdF9nZXRfdHlwZW5hbWUoT0JKRUNUKHNkZXYpKSwgc2Rldi0+cWRldi5pZCwgZGV2KTsKLSAg
ICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUoZGV2LT5uaWMpLCBkZXYt
Pm5pY2NvbmYubWFjYWRkci5hKTsKKyAgICBxZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dl
dF9xdWV1ZShkZXYtPm5pYyksIGRldi0+bmljY29uZi5tYWNhZGRyLmEpOwogCiAgICAgZGV2LT5y
eHBfdGltZXIgPSB0aW1lcl9uZXdfdXMoUUVNVV9DTE9DS19WSVJUVUFMLCBzcGFwcl92bGFuX2Zs
dXNoX3J4X3F1ZXVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldik7CkBA
IC03NzUsNyArNzc1LDcgQEAgc3RhdGljIHRhcmdldF91bG9uZyBoX2NoYW5nZV9sb2dpY2FsX2xh
bl9tYWMoUG93ZXJQQ0NQVSAqY3B1LAogICAgICAgICBtYWNhZGRyID4+PSA4OwogICAgIH0KIAot
ICAgIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShkZXYtPm5pYyksIGRl
di0+bmljY29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVf
Z2V0X3F1ZXVlKGRldi0+bmljKSwgZGV2LT5uaWNjb25mLm1hY2FkZHIuYSk7CiAKICAgICByZXR1
cm4gSF9TVUNDRVNTOwogfQpkaWZmIC0tZ2l0IGEvaHcvbmV0L3N0ZWxsYXJpc19lbmV0LmMgYi9o
dy9uZXQvc3RlbGxhcmlzX2VuZXQuYwppbmRleCBjYjZlMjUwOWVhLi5hZWM5OWJjMjE0IDEwMDY0
NAotLS0gYS9ody9uZXQvc3RlbGxhcmlzX2VuZXQuYworKysgYi9ody9uZXQvc3RlbGxhcmlzX2Vu
ZXQuYwpAQCAtNDkzLDcgKzQ5Myw3IEBAIHN0YXRpYyB2b2lkIHN0ZWxsYXJpc19lbmV0X3JlYWxp
emUoRGV2aWNlU3RhdGUgKmRldiwgRXJyb3IgKiplcnJwKQogCiAgICAgcy0+bmljID0gcWVtdV9u
ZXdfbmljKCZuZXRfc3RlbGxhcmlzX2VuZXRfaW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG9iamVjdF9nZXRfdHlwZW5hbWUoT0JKRUNUKGRldikpLCBkZXYtPmlkLCBz
KTsKLSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwg
cy0+Y29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0
X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKIH0KIAogc3RhdGljIFByb3BlcnR5
IHN0ZWxsYXJpc19lbmV0X3Byb3BlcnRpZXNbXSA9IHsKZGlmZiAtLWdpdCBhL2h3L25ldC9zdW5n
ZW0uYyBiL2h3L25ldC9zdW5nZW0uYwppbmRleCA4OWRhNTFmN2Y2Li5iM2Y0OWIyM2FlIDEwMDY0
NAotLS0gYS9ody9uZXQvc3VuZ2VtLmMKKysrIGIvaHcvbmV0L3N1bmdlbS5jCkBAIC0xMzYxLDgg
KzEzNjEsOCBAQCBzdGF0aWMgdm9pZCBzdW5nZW1fcmVhbGl6ZShQQ0lEZXZpY2UgKnBjaV9kZXYs
IEVycm9yICoqZXJycCkKICAgICBzLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF9zdW5nZW1faW5m
bywgJnMtPmNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF9nZXRfdHlwZW5h
bWUoT0JKRUNUKGRldikpLAogICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmlkLCBzKTsK
LSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcy0+Y29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVf
dXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcy0+Y29uZi5tYWNhZGRyLmEpOwogfQogCiBzdGF0aWMgdm9pZCBzdW5n
ZW1fcmVzZXQoRGV2aWNlU3RhdGUgKmRldikKZGlmZiAtLWdpdCBhL2h3L25ldC9zdW5obWUuYyBi
L2h3L25ldC9zdW5obWUuYwppbmRleCA4ODYzNjAxZjZjLi4yZmYyZWYxMTYyIDEwMDY0NAotLS0g
YS9ody9uZXQvc3VuaG1lLmMKKysrIGIvaHcvbmV0L3N1bmhtZS5jCkBAIC04OTIsNyArODkyLDcg
QEAgc3RhdGljIHZvaWQgc3VuaG1lX3JlYWxpemUoUENJRGV2aWNlICpwY2lfZGV2LCBFcnJvciAq
KmVycnApCiAgICAgcWVtdV9tYWNhZGRyX2RlZmF1bHRfaWZfdW5zZXQoJnMtPmNvbmYubWFjYWRk
cik7CiAgICAgcy0+bmljID0gcWVtdV9uZXdfbmljKCZuZXRfc3VuaG1lX2luZm8sICZzLT5jb25m
LAogICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfZ2V0X3R5cGVuYW1lKE9CSkVDVChk
KSksIGQtPmlkLCBzKTsKLSAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9nZXRfcXVl
dWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNh
ZGRyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKIH0KIAogc3Rh
dGljIHZvaWQgc3VuaG1lX2luc3RhbmNlX2luaXQoT2JqZWN0ICpvYmopCmRpZmYgLS1naXQgYS9o
dy9uZXQvdHVsaXAuYyBiL2h3L25ldC90dWxpcC5jCmluZGV4IGNmYWMyNzE5ZDMuLjM2ZmYxMGM1
OTMgMTAwNjQ0Ci0tLSBhL2h3L25ldC90dWxpcC5jCisrKyBiL2h3L25ldC90dWxpcC5jCkBAIC05
NjQsNyArOTY0LDcgQEAgc3RhdGljIHZvaWQgcGNpX3R1bGlwX3JlYWxpemUoUENJRGV2aWNlICpw
Y2lfZGV2LCBFcnJvciAqKmVycnApCiAgICAgcy0+bmljID0gcWVtdV9uZXdfbmljKCZuZXRfdHVs
aXBfaW5mbywgJnMtPmMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF9nZXRfdHlw
ZW5hbWUoT0JKRUNUKHBjaV9kZXYpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgcGNpX2Rl
di0+cWRldi5pZCwgcyk7Ci0gICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3RyKHFlbXVfZ2V0X3F1
ZXVlKHMtPm5pYyksIHMtPmMubWFjYWRkci5hKTsKKyAgICBxZW11X3VwZGF0ZV9uaWNfbWFjYWRk
cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jLm1hY2FkZHIuYSk7CiB9CiAKIHN0YXRpYyB2
b2lkIHBjaV90dWxpcF9leGl0KFBDSURldmljZSAqcGNpX2RldikKZGlmZiAtLWdpdCBhL2h3L25l
dC92aXJ0aW8tbmV0LmMgYi9ody9uZXQvdmlydGlvLW5ldC5jCmluZGV4IDM2MjdiYjE3MTcuLmVh
MTk5MmJjODQgMTAwNjQ0Ci0tLSBhL2h3L25ldC92aXJ0aW8tbmV0LmMKKysrIGIvaHcvbmV0L3Zp
cnRpby1uZXQuYwpAQCAtMTUyLDcgKzE1Miw3IEBAIHN0YXRpYyB2b2lkIHZpcnRpb19uZXRfc2V0
X2NvbmZpZyhWaXJ0SU9EZXZpY2UgKnZkZXYsIGNvbnN0IHVpbnQ4X3QgKmNvbmZpZykKICAgICAg
ICAgIXZpcnRpb192ZGV2X2hhc19mZWF0dXJlKHZkZXYsIFZJUlRJT19GX1ZFUlNJT05fMSkgJiYK
ICAgICAgICAgbWVtY21wKG5ldGNmZy5tYWMsIG4tPm1hYywgRVRIX0FMRU4pKSB7CiAgICAgICAg
IG1lbWNweShuLT5tYWMsIG5ldGNmZy5tYWMsIEVUSF9BTEVOKTsKLSAgICAgICAgcWVtdV9mb3Jt
YXRfbmljX2luZm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKG4tPm5pYyksIG4tPm1hYyk7CisgICAgICAg
IHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVfZ2V0X3F1ZXVlKG4tPm5pYyksIG4tPm1hYyk7
CiAgICAgfQogfQogCkBAIC01MjEsNyArNTIxLDcgQEAgc3RhdGljIHZvaWQgdmlydGlvX25ldF9y
ZXNldChWaXJ0SU9EZXZpY2UgKnZkZXYpCiAgICAgbi0+bWFjX3RhYmxlLnVuaV9vdmVyZmxvdyA9
IDA7CiAgICAgbWVtc2V0KG4tPm1hY190YWJsZS5tYWNzLCAwLCBNQUNfVEFCTEVfRU5UUklFUyAq
IEVUSF9BTEVOKTsKICAgICBtZW1jcHkoJm4tPm1hY1swXSwgJm4tPm5pYy0+Y29uZi0+bWFjYWRk
ciwgc2l6ZW9mKG4tPm1hYykpOwotICAgIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dl
dF9xdWV1ZShuLT5uaWMpLCBuLT5tYWMpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFl
bXVfZ2V0X3F1ZXVlKG4tPm5pYyksIG4tPm1hYyk7CiAgICAgbWVtc2V0KG4tPnZsYW5zLCAwLCBN
QVhfVkxBTiA+PiAzKTsKIAogICAgIC8qIEZsdXNoIGFueSBhc3luYyBUWCAqLwpAQCAtMTAwOSw3
ICsxMDA5LDcgQEAgc3RhdGljIGludCB2aXJ0aW9fbmV0X2hhbmRsZV9tYWMoVmlydElPTmV0ICpu
LCB1aW50OF90IGNtZCwKICAgICAgICAgfQogICAgICAgICBzID0gaW92X3RvX2J1Zihpb3YsIGlv
dl9jbnQsIDAsICZuLT5tYWMsIHNpemVvZihuLT5tYWMpKTsKICAgICAgICAgYXNzZXJ0KHMgPT0g
c2l6ZW9mKG4tPm1hYykpOwotICAgICAgICBxZW11X2Zvcm1hdF9uaWNfaW5mb19zdHIocWVtdV9n
ZXRfcXVldWUobi0+bmljKSwgbi0+bWFjKTsKKyAgICAgICAgcWVtdV91cGRhdGVfbmljX21hY2Fk
ZHIocWVtdV9nZXRfcXVldWUobi0+bmljKSwgbi0+bWFjKTsKICAgICAgICAgcnhmaWx0ZXJfbm90
aWZ5KG5jKTsKIAogICAgICAgICByZXR1cm4gVklSVElPX05FVF9PSzsKQEAgLTMwNTYsNyArMzA1
Niw3IEBAIHN0YXRpYyB2b2lkIHZpcnRpb19uZXRfZGV2aWNlX3JlYWxpemUoRGV2aWNlU3RhdGUg
KmRldiwgRXJyb3IgKiplcnJwKQogICAgICAgICBuLT5ob3N0X2hkcl9sZW4gPSAwOwogICAgIH0K
IAotICAgIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShuLT5uaWMpLCBu
LT5uaWNfY29uZi5tYWNhZGRyLmEpOworICAgIHFlbXVfdXBkYXRlX25pY19tYWNhZGRyKHFlbXVf
Z2V0X3F1ZXVlKG4tPm5pYyksIG4tPm5pY19jb25mLm1hY2FkZHIuYSk7CiAKICAgICBuLT52cXNb
MF0udHhfd2FpdGluZyA9IDA7CiAgICAgbi0+dHhfYnVyc3QgPSBuLT5uZXRfY29uZi50eGJ1cnN0
OwpkaWZmIC0tZ2l0IGEvaHcvbmV0L3ZteG5ldDMuYyBiL2h3L25ldC92bXhuZXQzLmMKaW5kZXgg
NmQ5MWNkODMwOS4uM2MzMzc3MzlkMCAxMDA2NDQKLS0tIGEvaHcvbmV0L3ZteG5ldDMuYworKysg
Yi9ody9uZXQvdm14bmV0My5jCkBAIC0zNjYsNyArMzY2LDcgQEAgc3RhdGljIHZvaWQgdm14bmV0
M19zZXRfdmFyaWFibGVfbWFjKFZNWE5FVDNTdGF0ZSAqcywgdWludDMyX3QgaCwgdWludDMyX3Qg
bCkKIAogICAgIFZNV19DRlBSTigiVmFyaWFibGUgTUFDOiAiIE1BQ19GTVQsIE1BQ19BUkcocy0+
Y29uZi5tYWNhZGRyLmEpKTsKIAotICAgIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dl
dF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7CisgICAgcWVtdV91cGRhdGVfbmlj
X21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOwogfQog
CiBzdGF0aWMgdWludDY0X3Qgdm14bmV0M19nZXRfbWFjX2xvdyhNQUNBZGRyICphZGRyKQpAQCAt
MjA2OSw3ICsyMDY5LDcgQEAgc3RhdGljIHZvaWQgdm14bmV0M19uZXRfaW5pdChWTVhORVQzU3Rh
dGUgKnMpCiAgICAgICAgIHFlbXVfdXNpbmdfdm5ldF9oZHIocWVtdV9nZXRfcXVldWUocy0+bmlj
KS0+cGVlciwgMSk7CiAgICAgfQogCi0gICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3RyKHFlbXVf
Z2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKKyAgICBxZW11X3VwZGF0ZV9u
aWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7CiB9
CiAKIHN0YXRpYyB2b2lkCmRpZmYgLS1naXQgYS9ody9uZXQveGVuX25pYy5jIGIvaHcvbmV0L3hl
bl9uaWMuYwppbmRleCAwMGE3ZmRmODQzLi4xOTQ3NmZjMDhjIDEwMDY0NAotLS0gYS9ody9uZXQv
eGVuX25pYy5jCisrKyBiL2h3L25ldC94ZW5fbmljLmMKQEAgLTI5NiwxMCArMjk2LDYgQEAgc3Rh
dGljIGludCBuZXRfaW5pdChzdHJ1Y3QgWGVuTGVnYWN5RGV2aWNlICp4ZW5kZXYpCiAgICAgbmV0
ZGV2LT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF94ZW5faW5mbywgJm5ldGRldi0+Y29uZiwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAieGVuIiwgTlVMTCwgbmV0ZGV2KTsKIAotICAg
IHNucHJpbnRmKHFlbXVfZ2V0X3F1ZXVlKG5ldGRldi0+bmljKS0+aW5mb19zdHIsCi0gICAgICAg
ICAgICAgc2l6ZW9mKHFlbXVfZ2V0X3F1ZXVlKG5ldGRldi0+bmljKS0+aW5mb19zdHIpLAotICAg
ICAgICAgICAgICJuaWM6IHhlbmJ1cyB2aWYgbWFjYWRkcj0lcyIsIG5ldGRldi0+bWFjKTsKLQog
ICAgIC8qIGZpbGwgaW5mbyAqLwogICAgIHhlbnN0b3JlX3dyaXRlX2JlX2ludCgmbmV0ZGV2LT54
ZW5kZXYsICJmZWF0dXJlLXJ4LWNvcHkiLCAxKTsKICAgICB4ZW5zdG9yZV93cml0ZV9iZV9pbnQo
Jm5ldGRldi0+eGVuZGV2LCAiZmVhdHVyZS1yeC1mbGlwIiwgMCk7CmRpZmYgLS1naXQgYS9ody9u
ZXQveGdtYWMuYyBiL2h3L25ldC94Z21hYy5jCmluZGV4IDU3NGRkNDdiNDEuLmY4ODIwMjY5MzAg
MTAwNjQ0Ci0tLSBhL2h3L25ldC94Z21hYy5jCisrKyBiL2h3L25ldC94Z21hYy5jCkBAIC0zOTMs
NyArMzkzLDcgQEAgc3RhdGljIHZvaWQgeGdtYWNfZW5ldF9yZWFsaXplKERldmljZVN0YXRlICpk
ZXYsIEVycm9yICoqZXJycCkKICAgICBxZW11X21hY2FkZHJfZGVmYXVsdF9pZl91bnNldCgmcy0+
Y29uZi5tYWNhZGRyKTsKICAgICBzLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF94Z21hY19lbmV0
X2luZm8sICZzLT5jb25mLAogICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfZ2V0X3R5
cGVuYW1lKE9CSkVDVChkZXYpKSwgZGV2LT5pZCwgcyk7Ci0gICAgcWVtdV9mb3JtYXRfbmljX2lu
Zm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYubWFjYWRkci5hKTsKKyAgICBx
ZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1h
Y2FkZHIuYSk7CiAKICAgICBzLT5yZWdzW1hHTUFDX0FERFJfSElHSCgwKV0gPSAocy0+Y29uZi5t
YWNhZGRyLmFbNV0gPDwgOCkgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
LT5jb25mLm1hY2FkZHIuYVs0XTsKZGlmZiAtLWdpdCBhL2h3L25ldC94aWxpbnhfYXhpZW5ldC5j
IGIvaHcvbmV0L3hpbGlueF9heGllbmV0LmMKaW5kZXggNzA0Nzg4ODExYS4uNzNjYzNmMmFhOCAx
MDA2NDQKLS0tIGEvaHcvbmV0L3hpbGlueF9heGllbmV0LmMKKysrIGIvaHcvbmV0L3hpbGlueF9h
eGllbmV0LmMKQEAgLTk3NSw3ICs5NzUsNyBAQCBzdGF0aWMgdm9pZCB4aWxpbnhfZW5ldF9yZWFs
aXplKERldmljZVN0YXRlICpkZXYsIEVycm9yICoqZXJycCkKICAgICBxZW11X21hY2FkZHJfZGVm
YXVsdF9pZl91bnNldCgmcy0+Y29uZi5tYWNhZGRyKTsKICAgICBzLT5uaWMgPSBxZW11X25ld19u
aWMoJm5ldF94aWxpbnhfZW5ldF9pbmZvLCAmcy0+Y29uZiwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgb2JqZWN0X2dldF90eXBlbmFtZShPQkpFQ1QoZGV2KSksIGRldi0+aWQsIHMpOwotICAg
IHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25m
Lm1hY2FkZHIuYSk7CisgICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUo
cy0+bmljKSwgcy0+Y29uZi5tYWNhZGRyLmEpOwogCiAgICAgdGRrX2luaXQoJnMtPlRFTUFDLnBo
eSk7CiAgICAgbWRpb19hdHRhY2goJnMtPlRFTUFDLm1kaW9fYnVzLCAmcy0+VEVNQUMucGh5LCBz
LT5jX3BoeWFkZHIpOwpkaWZmIC0tZ2l0IGEvaHcvbmV0L3hpbGlueF9ldGhsaXRlLmMgYi9ody9u
ZXQveGlsaW54X2V0aGxpdGUuYwppbmRleCBjZjA3ZTY5OGIzLi4zNzY5MmYxNWUxIDEwMDY0NAot
LS0gYS9ody9uZXQveGlsaW54X2V0aGxpdGUuYworKysgYi9ody9uZXQveGlsaW54X2V0aGxpdGUu
YwpAQCAtMjM1LDcgKzIzNSw3IEBAIHN0YXRpYyB2b2lkIHhpbGlueF9ldGhsaXRlX3JlYWxpemUo
RGV2aWNlU3RhdGUgKmRldiwgRXJyb3IgKiplcnJwKQogICAgIHFlbXVfbWFjYWRkcl9kZWZhdWx0
X2lmX3Vuc2V0KCZzLT5jb25mLm1hY2FkZHIpOwogICAgIHMtPm5pYyA9IHFlbXVfbmV3X25pYygm
bmV0X3hpbGlueF9ldGhsaXRlX2luZm8sICZzLT5jb25mLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICBvYmplY3RfZ2V0X3R5cGVuYW1lKE9CSkVDVChkZXYpKSwgZGV2LT5pZCwgcyk7Ci0gICAg
cWVtdV9mb3JtYXRfbmljX2luZm9fc3RyKHFlbXVfZ2V0X3F1ZXVlKHMtPm5pYyksIHMtPmNvbmYu
bWFjYWRkci5hKTsKKyAgICBxZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihxZW11X2dldF9xdWV1ZShz
LT5uaWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7CiB9CiAKIHN0YXRpYyB2b2lkIHhpbGlueF9ldGhs
aXRlX2luaXQoT2JqZWN0ICpvYmopCmRpZmYgLS1naXQgYS9ody91c2IvZGV2LW5ldHdvcmsuYyBi
L2h3L3VzYi9kZXYtbmV0d29yay5jCmluZGV4IDlhNzhhZDkyOGIuLjUyZThlNjk4OWEgMTAwNjQ0
Ci0tLSBhL2h3L3VzYi9kZXYtbmV0d29yay5jCisrKyBiL2h3L3VzYi9kZXYtbmV0d29yay5jCkBA
IC0xMzYyLDcgKzEzNjIsNyBAQCBzdGF0aWMgdm9pZCB1c2JfbmV0X3JlYWxpemUoVVNCRGV2aWNl
ICpkZXYsIEVycm9yICoqZXJycCkKICAgICBxZW11X21hY2FkZHJfZGVmYXVsdF9pZl91bnNldCgm
cy0+Y29uZi5tYWNhZGRyKTsKICAgICBzLT5uaWMgPSBxZW11X25ld19uaWMoJm5ldF91c2JuZXRf
aW5mbywgJnMtPmNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF9nZXRfdHlw
ZW5hbWUoT0JKRUNUKHMpKSwgcy0+ZGV2LnFkZXYuaWQsIHMpOwotICAgIHFlbXVfZm9ybWF0X25p
Y19pbmZvX3N0cihxZW11X2dldF9xdWV1ZShzLT5uaWMpLCBzLT5jb25mLm1hY2FkZHIuYSk7Cisg
ICAgcWVtdV91cGRhdGVfbmljX21hY2FkZHIocWVtdV9nZXRfcXVldWUocy0+bmljKSwgcy0+Y29u
Zi5tYWNhZGRyLmEpOwogICAgIHNucHJpbnRmKHMtPnVzYnN0cmluZ19tYWMsIHNpemVvZihzLT51
c2JzdHJpbmdfbWFjKSwKICAgICAgICAgICAgICAiJTAyeCUwMnglMDJ4JTAyeCUwMnglMDJ4IiwK
ICAgICAgICAgICAgICAweDQwLApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9uZXQvbmV0LmggYi9pbmNs
dWRlL25ldC9uZXQuaAppbmRleCA5ZGY0NjgwOTM3Li5iNGNhOTExMmFhIDEwMDY0NAotLS0gYS9p
bmNsdWRlL25ldC9uZXQuaAorKysgYi9pbmNsdWRlL25ldC9uZXQuaApAQCAtOTEsNyArOTEsNiBA
QCBzdHJ1Y3QgTmV0Q2xpZW50U3RhdGUgewogICAgIE5ldFF1ZXVlICppbmNvbWluZ19xdWV1ZTsK
ICAgICBjaGFyICptb2RlbDsKICAgICBjaGFyICpuYW1lOwotICAgIGNoYXIgaW5mb19zdHJbMjU2
XTsKICAgICBOZXRkZXZJbmZvICpzdG9yZWRfY29uZmlnOwogICAgIHVuc2lnbmVkIHJlY2VpdmVf
ZGlzYWJsZWQgOiAxOwogICAgIE5ldENsaWVudERlc3RydWN0b3IgKmRlc3RydWN0b3I7CkBAIC0x
NTUsNyArMTU0LDcgQEAgc3NpemVfdCBxZW11X3NlbmRfcGFja2V0X2FzeW5jKE5ldENsaWVudFN0
YXRlICpuYywgY29uc3QgdWludDhfdCAqYnVmLAogdm9pZCBxZW11X3B1cmdlX3F1ZXVlZF9wYWNr
ZXRzKE5ldENsaWVudFN0YXRlICpuYyk7CiB2b2lkIHFlbXVfZmx1c2hfcXVldWVkX3BhY2tldHMo
TmV0Q2xpZW50U3RhdGUgKm5jKTsKIHZvaWQgcWVtdV9mbHVzaF9vcl9wdXJnZV9xdWV1ZWRfcGFj
a2V0cyhOZXRDbGllbnRTdGF0ZSAqbmMsIGJvb2wgcHVyZ2UpOwotdm9pZCBxZW11X2Zvcm1hdF9u
aWNfaW5mb19zdHIoTmV0Q2xpZW50U3RhdGUgKm5jLCB1aW50OF90IG1hY2FkZHJbNl0pOwordm9p
ZCBxZW11X3VwZGF0ZV9uaWNfbWFjYWRkcihOZXRDbGllbnRTdGF0ZSAqbmMsIHVpbnQ4X3QgbWFj
YWRkcls2XSk7CiBib29sIHFlbXVfaGFzX3VmbyhOZXRDbGllbnRTdGF0ZSAqbmMpOwogYm9vbCBx
ZW11X2hhc192bmV0X2hkcihOZXRDbGllbnRTdGF0ZSAqbmMpOwogYm9vbCBxZW11X2hhc192bmV0
X2hkcl9sZW4oTmV0Q2xpZW50U3RhdGUgKm5jLCBpbnQgbGVuKTsKZGlmZiAtLWdpdCBhL25ldC9s
MnRwdjMuYyBiL25ldC9sMnRwdjMuYwppbmRleCBmNGU0NWU3YjI4Li44ZGNjZGQ2MjVlIDEwMDY0
NAotLS0gYS9uZXQvbDJ0cHYzLmMKKysrIGIvbmV0L2wydHB2My5jCkBAIC03NDQsOSArNzQ0LDYg
QEAgaW50IG5ldF9pbml0X2wydHB2Myhjb25zdCBOZXRkZXYgKm5ldGRldiwKICAgICBpZiAobDJ0
cHYzLT5oYXNfZHN0cG9ydCkgewogICAgICAgICBzdG9yZWQtPmRzdHBvcnQgPSBnX3N0cmR1cChs
MnRwdjMtPmRzdHBvcnQpOwogICAgIH0KLQotICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3RyLCBz
aXplb2Yocy0+bmMuaW5mb19zdHIpLAotICAgICAgICAgICAgICJsMnRwdjM6IGNvbm5lY3RlZCIp
OwogICAgIHJldHVybiAwOwogb3V0ZXJyOgogICAgIHFlbXVfZGVsX25ldF9jbGllbnQobmMpOwpk
aWZmIC0tZ2l0IGEvbmV0L25ldC5jIGIvbmV0L25ldC5jCmluZGV4IDFhODE1M2RiZjcuLjg4NzU1
ZTVjMWMgMTAwNjQ0Ci0tLSBhL25ldC9uZXQuYworKysgYi9uZXQvbmV0LmMKQEAgLTEyNywxOSAr
MTI3LDEzIEBAIGNoYXIgKnFlbXVfbWFjX3N0cmR1cF9wcmludGYoY29uc3QgdWludDhfdCAqbWFj
YWRkcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hY2FkZHJbM10sIG1hY2FkZHJbNF0s
IG1hY2FkZHJbNV0pOwogfQogCi12b2lkIHFlbXVfZm9ybWF0X25pY19pbmZvX3N0cihOZXRDbGll
bnRTdGF0ZSAqbmMsIHVpbnQ4X3QgbWFjYWRkcls2XSkKK3ZvaWQgcWVtdV91cGRhdGVfbmljX21h
Y2FkZHIoTmV0Q2xpZW50U3RhdGUgKm5jLCB1aW50OF90IG1hY2FkZHJbNl0pCiB7CiAgICAgZ19h
c3NlcnQobmMtPnN0b3JlZF9jb25maWcpOwogCiAgICAgZ19mcmVlKG5jLT5zdG9yZWRfY29uZmln
LT51Lm5pYy5tYWNhZGRyKTsKICAgICBuYy0+c3RvcmVkX2NvbmZpZy0+dS5uaWMubWFjYWRkciA9
IGdfc3RyZHVwX3ByaW50ZihNQUNfRk1ULAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIE1BQ19BUkcobWFjYWRkcikpOwotCi0gICAgc25wcmlu
dGYobmMtPmluZm9fc3RyLCBzaXplb2YobmMtPmluZm9fc3RyKSwKLSAgICAgICAgICAgICAibW9k
ZWw9JXMsbWFjYWRkcj0lMDJ4OiUwMng6JTAyeDolMDJ4OiUwMng6JTAyeCIsCi0gICAgICAgICAg
ICAgbmMtPm1vZGVsLAotICAgICAgICAgICAgIG1hY2FkZHJbMF0sIG1hY2FkZHJbMV0sIG1hY2Fk
ZHJbMl0sCi0gICAgICAgICAgICAgbWFjYWRkclszXSwgbWFjYWRkcls0XSwgbWFjYWRkcls1XSk7
CiB9CiAKIHN0YXRpYyBpbnQgbWFjX3RhYmxlWzI1Nl0gPSB7MH07CmRpZmYgLS1naXQgYS9uZXQv
c2xpcnAuYyBiL25ldC9zbGlycC5jCmluZGV4IGZiNWI4N2ViZWQuLjI0YTg4NzdkZGMgMTAwNjQ0
Ci0tLSBhL25ldC9zbGlycC5jCisrKyBiL25ldC9zbGlycC5jCkBAIC02NzAsMTAgKzY3MCw2IEBA
IHN0YXRpYyBpbnQgbmV0X3NsaXJwX2luaXQoTmV0Q2xpZW50U3RhdGUgKnBlZXIsIGNvbnN0IGNo
YXIgKm1vZGVsLAogICAgICAgICBzdG9yZWQtPnRmdHBfc2VydmVyX25hbWUgPSBnX3N0cmR1cCh0
ZnRwX3NlcnZlcl9uYW1lKTsKICAgICB9CiAKLSAgICBzbnByaW50ZihuYy0+aW5mb19zdHIsIHNp
emVvZihuYy0+aW5mb19zdHIpLAotICAgICAgICAgICAgICJuZXQ9JXMscmVzdHJpY3Q9JXMiLCBp
bmV0X250b2EobmV0KSwKLSAgICAgICAgICAgICByZXN0cmljdGVkID8gIm9uIiA6ICJvZmYiKTsK
LQogICAgIHMgPSBET19VUENBU1QoU2xpcnBTdGF0ZSwgbmMsIG5jKTsKIAogICAgIHMtPnNsaXJw
ID0gc2xpcnBfaW5pdChyZXN0cmljdGVkLCBpcHY0LCBuZXQsIG1hc2ssIGhvc3QsCmRpZmYgLS1n
aXQgYS9uZXQvc29ja2V0LmMgYi9uZXQvc29ja2V0LmMKaW5kZXggMmQyZDU0MTljYS4uMWY4ODAx
OTcwYyAxMDA2NDQKLS0tIGEvbmV0L3NvY2tldC5jCisrKyBiL25ldC9zb2NrZXQuYwpAQCAtMTgw
LDcgKzE4MCw2IEBAIHN0YXRpYyB2b2lkIG5ldF9zb2NrZXRfc2VuZCh2b2lkICpvcGFxdWUpCiAg
ICAgICAgIHMtPmZkID0gLTE7CiAgICAgICAgIG5ldF9zb2NrZXRfcnNfaW5pdCgmcy0+cnMsIG5l
dF9zb2NrZXRfcnNfZmluYWxpemUsIGZhbHNlKTsKICAgICAgICAgcy0+bmMubGlua19kb3duID0g
dHJ1ZTsKLSAgICAgICAgbWVtc2V0KHMtPm5jLmluZm9fc3RyLCAwLCBzaXplb2Yocy0+bmMuaW5m
b19zdHIpKTsKIAogICAgICAgICByZXR1cm47CiAgICAgfQpAQCAtNDAwLDE2ICszOTksMTAgQEAg
c3RhdGljIE5ldFNvY2tldFN0YXRlICpuZXRfc29ja2V0X2ZkX2luaXRfZGdyYW0oTmV0Q2xpZW50
U3RhdGUgKnBlZXIsCiAgICAgICAgIHN0b3JlZC0+bWNhc3QgPSBnX3N0cmR1cChtY2FzdCk7CiAK
ICAgICAgICAgcy0+ZGdyYW1fZHN0ID0gc2FkZHI7Ci0gICAgICAgIHNucHJpbnRmKG5jLT5pbmZv
X3N0ciwgc2l6ZW9mKG5jLT5pbmZvX3N0ciksCi0gICAgICAgICAgICAgICAgICJzb2NrZXQ6IGZk
PSVkIChjbG9uZWQgbWNhc3Q9JXM6JWQpIiwKLSAgICAgICAgICAgICAgICAgZmQsIGluZXRfbnRv
YShzYWRkci5zaW5fYWRkciksIG50b2hzKHNhZGRyLnNpbl9wb3J0KSk7CiAgICAgfSBlbHNlIHsK
ICAgICAgICAgaWYgKHNhX3R5cGUgPT0gU09DS0VUX0FERFJFU1NfVFlQRV9VTklYKSB7CiAgICAg
ICAgICAgICBzLT5kZ3JhbV9kc3Quc2luX2ZhbWlseSA9IEFGX1VOSVg7CiAgICAgICAgIH0KLQot
ICAgICAgICBzbnByaW50ZihuYy0+aW5mb19zdHIsIHNpemVvZihuYy0+aW5mb19zdHIpLAotICAg
ICAgICAgICAgICAgICAic29ja2V0OiBmZD0lZCAlcyIsIGZkLCBTb2NrZXRBZGRyZXNzVHlwZV9z
dHIoc2FfdHlwZSkpOwogICAgIH0KIAogICAgIHJldHVybiBzOwpAQCAtNDQzLDkgKzQzNiw2IEBA
IHN0YXRpYyBOZXRTb2NrZXRTdGF0ZSAqbmV0X3NvY2tldF9mZF9pbml0X3N0cmVhbShOZXRDbGll
bnRTdGF0ZSAqcGVlciwKICAgICBOZXRkZXZTb2NrZXRPcHRpb25zICpzdG9yZWQ7CiAKICAgICBu
YyA9IHFlbXVfbmV3X25ldF9jbGllbnQoJm5ldF9zb2NrZXRfaW5mbywgcGVlciwgbW9kZWwsIG5h
bWUpOwotCi0gICAgc25wcmludGYobmMtPmluZm9fc3RyLCBzaXplb2YobmMtPmluZm9fc3RyKSwg
InNvY2tldDogZmQ9JWQiLCBmZCk7Ci0KICAgICBzID0gRE9fVVBDQVNUKE5ldFNvY2tldFN0YXRl
LCBuYywgbmMpOwogCiAgICAgcy0+ZmQgPSBmZDsKQEAgLTUyNywxMCArNTE3LDYgQEAgc3RhdGlj
IHZvaWQgbmV0X3NvY2tldF9hY2NlcHQodm9pZCAqb3BhcXVlKQogCiAgICAgc3RvcmVkLT5oYXNf
ZmQgPSB0cnVlOwogICAgIHN0b3JlZC0+ZmQgPSBnX3N0cmR1cF9wcmludGYoIiVkIiwgZmQpOwot
Ci0gICAgc25wcmludGYocy0+bmMuaW5mb19zdHIsIHNpemVvZihzLT5uYy5pbmZvX3N0ciksCi0g
ICAgICAgICAgICAgInNvY2tldDogY29ubmVjdGlvbiBmcm9tICVzOiVkIiwKLSAgICAgICAgICAg
ICBpbmV0X250b2Eoc2FkZHIuc2luX2FkZHIpLCBudG9ocyhzYWRkci5zaW5fcG9ydCkpOwogfQog
CiBzdGF0aWMgaW50IG5ldF9zb2NrZXRfbGlzdGVuX2luaXQoTmV0Q2xpZW50U3RhdGUgKnBlZXIs
CkBAIC02NDUsOSArNjMxLDYgQEAgc3RhdGljIGludCBuZXRfc29ja2V0X2Nvbm5lY3RfaW5pdChO
ZXRDbGllbnRTdGF0ZSAqcGVlciwKICAgICBzdG9yZWQtPmhhc19jb25uZWN0ID0gdHJ1ZTsKICAg
ICBzdG9yZWQtPmNvbm5lY3QgPSBnX3N0cmR1cChob3N0X3N0cik7CiAKLSAgICBzbnByaW50Zihz
LT5uYy5pbmZvX3N0ciwgc2l6ZW9mKHMtPm5jLmluZm9fc3RyKSwKLSAgICAgICAgICAgICAic29j
a2V0OiBjb25uZWN0IHRvICVzOiVkIiwKLSAgICAgICAgICAgICBpbmV0X250b2Eoc2FkZHIuc2lu
X2FkZHIpLCBudG9ocyhzYWRkci5zaW5fcG9ydCkpOwogICAgIHJldHVybiAwOwogfQogCkBAIC03
MDQsMTEgKzY4Nyw3IEBAIHN0YXRpYyBpbnQgbmV0X3NvY2tldF9tY2FzdF9pbml0KE5ldENsaWVu
dFN0YXRlICpwZWVyLAogICAgICAgICBzdG9yZWQtPmxvY2FsYWRkciA9IGdfc3RyZHVwKGxvY2Fs
YWRkcl9zdHIpOwogICAgIH0KIAotICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3RyLCBzaXplb2Yo
cy0+bmMuaW5mb19zdHIpLAotICAgICAgICAgICAgICJzb2NrZXQ6IG1jYXN0PSVzOiVkIiwKLSAg
ICAgICAgICAgICBpbmV0X250b2Eoc2FkZHIuc2luX2FkZHIpLCBudG9ocyhzYWRkci5zaW5fcG9y
dCkpOwogICAgIHJldHVybiAwOwotCiB9CiAKIHN0YXRpYyBpbnQgbmV0X3NvY2tldF91ZHBfaW5p
dChOZXRDbGllbnRTdGF0ZSAqcGVlciwKQEAgLTc2OSw5ICs3NDgsNiBAQCBzdGF0aWMgaW50IG5l
dF9zb2NrZXRfdWRwX2luaXQoTmV0Q2xpZW50U3RhdGUgKnBlZXIsCiAgICAgc3RvcmVkLT5oYXNf
dWRwID0gdHJ1ZTsKICAgICBzdG9yZWQtPnVkcCA9IGdfc3RyZHVwKHJob3N0KTsKIAotICAgIHNu
cHJpbnRmKHMtPm5jLmluZm9fc3RyLCBzaXplb2Yocy0+bmMuaW5mb19zdHIpLAotICAgICAgICAg
ICAgICJzb2NrZXQ6IHVkcD0lczolZCIsCi0gICAgICAgICAgICAgaW5ldF9udG9hKHJhZGRyLnNp
bl9hZGRyKSwgbnRvaHMocmFkZHIuc2luX3BvcnQpKTsKICAgICByZXR1cm4gMDsKIH0KIApkaWZm
IC0tZ2l0IGEvbmV0L3RhcC5jIGIvbmV0L3RhcC5jCmluZGV4IGY0MGYzNzhjMmEuLmJkNWNiNmY1
Y2QgMTAwNjQ0Ci0tLSBhL25ldC90YXAuYworKysgYi9uZXQvdGFwLmMKQEAgLTYxNiw5ICs2MTYs
NiBAQCBpbnQgbmV0X2luaXRfYnJpZGdlKGNvbnN0IE5ldGRldiAqbmV0ZGV2LCBjb25zdCBjaGFy
ICpuYW1lLAogICAgICAgICBzdG9yZWQtPmhlbHBlciA9IGdfc3RyZHVwKGhlbHBlcik7CiAgICAg
fQogCi0gICAgc25wcmludGYocy0+bmMuaW5mb19zdHIsIHNpemVvZihzLT5uYy5pbmZvX3N0ciks
ICJoZWxwZXI9JXMsYnI9JXMiLCBoZWxwZXIsCi0gICAgICAgICAgICAgYnIpOwotCiAgICAgcmV0
dXJuIDA7CiB9CiAKQEAgLTcwNCw4ICs3MDEsNiBAQCBzdGF0aWMgdm9pZCBuZXRfaW5pdF90YXBf
b25lKGNvbnN0IE5ldGRldlRhcE9wdGlvbnMgKnRhcCwgTmV0Q2xpZW50U3RhdGUgKnBlZXIsCiAg
ICAgICAgICAgICBzdG9yZWQtPmZkcyA9IGdfc3RyZHVwX3ByaW50ZigiJXM6JWQiLCBzdG9yZWQt
PmZkcywgZmQpOwogICAgICAgICAgICAgZ19mcmVlKHRtcF9zKTsKICAgICAgICAgfQotCi0gICAg
ICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3RyLCBzaXplb2Yocy0+bmMuaW5mb19zdHIpLCAiZmQ9
JWQiLCBmZCk7CiAgICAgfSBlbHNlIGlmICh0YXAtPmhhc19oZWxwZXIpIHsKICAgICAgICAgaWYg
KCFzdG9yZWQtPmhhc19oZWxwZXIpIHsKICAgICAgICAgICAgIHN0b3JlZC0+aGFzX2hlbHBlciA9
IHRydWU7CkBAIC03MTcsOSArNzEyLDYgQEAgc3RhdGljIHZvaWQgbmV0X2luaXRfdGFwX29uZShj
b25zdCBOZXRkZXZUYXBPcHRpb25zICp0YXAsIE5ldENsaWVudFN0YXRlICpwZWVyLAogICAgICAg
ICAgICAgc3RvcmVkLT5iciA9IHRhcC0+aGFzX2JyID8gZ19zdHJkdXAodGFwLT5icikgOgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ19zdHJkdXAoREVGQVVMVF9CUklER0Vf
SU5URVJGQUNFKTsKICAgICAgICAgfQotCi0gICAgICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3Ry
LCBzaXplb2Yocy0+bmMuaW5mb19zdHIpLCAiaGVscGVyPSVzIiwKLSAgICAgICAgICAgICAgICAg
dGFwLT5oZWxwZXIpOwogICAgIH0gZWxzZSB7CiAgICAgICAgIGlmIChpZm5hbWUgJiYgIXN0b3Jl
ZC0+aGFzX2lmbmFtZSkgewogICAgICAgICAgICAgc3RvcmVkLT5oYXNfaWZuYW1lID0gdHJ1ZTsK
QEAgLTczNiwxMCArNzI4LDYgQEAgc3RhdGljIHZvaWQgbmV0X2luaXRfdGFwX29uZShjb25zdCBO
ZXRkZXZUYXBPcHRpb25zICp0YXAsIE5ldENsaWVudFN0YXRlICpwZWVyLAogICAgICAgICAgICAg
c3RvcmVkLT5kb3duc2NyaXB0ID0gZ19zdHJkdXAoZG93bnNjcmlwdCk7CiAgICAgICAgIH0KIAot
ICAgICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwgc2l6ZW9mKHMtPm5jLmluZm9fc3RyKSwK
LSAgICAgICAgICAgICAgICAgImlmbmFtZT0lcyxzY3JpcHQ9JXMsZG93bnNjcmlwdD0lcyIsIGlm
bmFtZSwgc2NyaXB0LAotICAgICAgICAgICAgICAgICBkb3duc2NyaXB0KTsKLQogICAgICAgICBp
ZiAoc3RyY21wKGRvd25zY3JpcHQsICJubyIpICE9IDApIHsKICAgICAgICAgICAgIHNucHJpbnRm
KHMtPmRvd25fc2NyaXB0LCBzaXplb2Yocy0+ZG93bl9zY3JpcHQpLCAiJXMiLCBkb3duc2NyaXB0
KTsKICAgICAgICAgICAgIHNucHJpbnRmKHMtPmRvd25fc2NyaXB0X2FyZywgc2l6ZW9mKHMtPmRv
d25fc2NyaXB0X2FyZyksCmRpZmYgLS1naXQgYS9uZXQvdmRlLmMgYi9uZXQvdmRlLmMKaW5kZXgg
YzRlZGY1Y2JhMS4uY2RkMjdlZGRkNyAxMDA2NDQKLS0tIGEvbmV0L3ZkZS5jCisrKyBiL25ldC92
ZGUuYwpAQCAtOTksMTAgKzk5LDYgQEAgc3RhdGljIGludCBuZXRfdmRlX2luaXQoTmV0Q2xpZW50
U3RhdGUgKnBlZXIsIGNvbnN0IGNoYXIgKm1vZGVsLAogICAgIH0KIAogICAgIG5jID0gcWVtdV9u
ZXdfbmV0X2NsaWVudCgmbmV0X3ZkZV9pbmZvLCBwZWVyLCBtb2RlbCwgbmFtZSk7Ci0KLSAgICBz
bnByaW50ZihuYy0+aW5mb19zdHIsIHNpemVvZihuYy0+aW5mb19zdHIpLCAic29jaz0lcyxmZD0l
ZCIsCi0gICAgICAgICAgICAgc29jaywgdmRlX2RhdGFmZCh2ZGUpKTsKLQogICAgIHMgPSBET19V
UENBU1QoVkRFU3RhdGUsIG5jLCBuYyk7CiAKICAgICBzLT52ZGUgPSB2ZGU7CmRpZmYgLS1naXQg
YS9uZXQvdmhvc3QtdXNlci5jIGIvbmV0L3Zob3N0LXVzZXIuYwppbmRleCBhYTJkYzUzMTc5Li5k
Y2M2MGY5YzM0IDEwMDY0NAotLS0gYS9uZXQvdmhvc3QtdXNlci5jCisrKyBiL25ldC92aG9zdC11
c2VyLmMKQEAgLTMyMyw4ICszMjMsNiBAQCBzdGF0aWMgaW50IG5ldF92aG9zdF91c2VyX2luaXQo
TmV0Q2xpZW50U3RhdGUgKnBlZXIsIGNvbnN0IGNoYXIgKmRldmljZSwKICAgICB1c2VyID0gZ19u
ZXcwKHN0cnVjdCBWaG9zdFVzZXJTdGF0ZSwgMSk7CiAgICAgZm9yIChpID0gMDsgaSA8IHF1ZXVl
czsgaSsrKSB7CiAgICAgICAgIG5jID0gcWVtdV9uZXdfbmV0X2NsaWVudCgmbmV0X3Zob3N0X3Vz
ZXJfaW5mbywgcGVlciwgZGV2aWNlLCBuYW1lKTsKLSAgICAgICAgc25wcmludGYobmMtPmluZm9f
c3RyLCBzaXplb2YobmMtPmluZm9fc3RyKSwgInZob3N0LXVzZXIlZCB0byAlcyIsCi0gICAgICAg
ICAgICAgICAgIGksIGNoci0+bGFiZWwpOwogICAgICAgICBuYy0+cXVldWVfaW5kZXggPSBpOwog
ICAgICAgICBpZiAoIW5jMCkgewogICAgICAgICAgICAgbmMwID0gbmM7Ci0tIAoyLjE3LjEKCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwg
bWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3Rz
LnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

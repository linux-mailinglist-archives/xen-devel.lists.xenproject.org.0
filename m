Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 220F811E94D
	for <lists+xen-devel@lfdr.de>; Fri, 13 Dec 2019 18:40:29 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ifot7-0000Mq-2n; Fri, 13 Dec 2019 17:38:01 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GgWl=2D=citrix.com=george.dunlap@srs-us1.protection.inumbo.net>)
 id 1ifot5-0000MC-Bh
 for xen-devel@lists.xenproject.org; Fri, 13 Dec 2019 17:37:59 +0000
X-Inumbo-ID: 486a466a-1dcf-11ea-a1e1-bc764e2007e4
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 486a466a-1dcf-11ea-a1e1-bc764e2007e4;
 Fri, 13 Dec 2019 17:37:50 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1576258670;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=rmV8tIU0ODVoLgIuVH2l410+cBsG7aefjXalQ/Chu9g=;
 b=iMLEVNsYoHw1ic+BkqXjCjPFm85pvSmNWPAu+nPAMcWZayjPxE8sj/4b
 9OWl2FTK9h0/K28QeepkyWUFC+4545nNosv0RayvXsnR7nXPcRCzMndUm
 zrN+9zTFp3piQcK8ReeWVuNb2DFSJ1MaepwGcKLLntjk/2tjH0sAlZxYN A=;
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=george.dunlap@citrix.com;
 spf=Pass smtp.mailfrom=George.Dunlap@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 george.dunlap@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="george.dunlap@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa4.hc3370-68.iphmx.com: domain of
 George.Dunlap@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="George.Dunlap@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: L2SYOZUPd51YqWT8lH1Fly3S49DCzQMG41PlgsHSwOciNaw+9NKuefsztLfcg//GXeZ+cP+2EI
 k2fC5jgPmc5YC7r5Z+chwZ9Kp3mHxRcuIJmBIYOubYDo6mKz5lGTfgIcrGyjKb86QKMwPeBVar
 gl8oddaTufaeW1L88S3b3MBODvLM9I9Ym+8DXfqvP5DIhiJjLnNk38QLyIiwBpGVJ9NmiO3ZeK
 ThUSuDz74rv6K8aU1YWuItsueFSJcssJeSpx2HkDXl3bVLvYmuOWMBxgmOqyZPwsg8sP8tEOXK
 XTk=
X-SBRS: 2.7
X-MesageID: 10226692
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.69,309,1571716800"; d="scan'208";a="10226692"
From: George Dunlap <george.dunlap@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Fri, 13 Dec 2019 17:37:41 +0000
Message-ID: <20191213173742.1960441-3-george.dunlap@citrix.com>
X-Mailer: git-send-email 2.24.0
In-Reply-To: <20191213173742.1960441-1-george.dunlap@citrix.com>
References: <20191213173742.1960441-1-george.dunlap@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 2/3] x86/mm: Use mfn_t in type get / put call
 tree
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UmVwbGFjZSBgdW5zaWduZWQgbG9uZ2Agd2l0aCBgbWZuX3RgIGFzIGFwcHJvcHJpYXRlIHRocm91
Z2hvdXQKYWxsb2MvZnJlZV9sTl90YWJsZSwgZ2V0L3B1dF9wYWdlX2Zyb21fbE5lLCBhbmQKZ2V0
X2xOX2xpbmVhcl9wYWdldGFibGUuICBUaGlzIG9idmlhdGVzIHRoZSBuZWVkIGZvciBhIGxvYWQg
b2YKYG1mbl94KClgIGFuZCBgX21mbigpYCBjYXN0cy4KClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KLS0tCk5ldyBpbiB2Mi4KCkNDOiBBbmRy
ZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpDQzogSmFuIEJldWxpY2ggPGpi
ZXVsaWNoQHN1c2UuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNzcgKysrKysrKysrKysr
KysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAzNyBp
bnNlcnRpb25zKCspLCA0MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYv
bW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IGNlYjY1NmNhNzUuLjU1ZjlhNTgxYjQgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC02
ODEsMTAgKzY4MSwxMCBAQCBib29sZWFuX3BhcmFtKCJwdi1saW5lYXItcHQiLCBvcHRfcHZfbGlu
ZWFyX3B0KTsKICNkZWZpbmUgZGVmaW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGxldmVsKSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiBzdGF0aWMgaW50ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogZ2V0
XyMjbGV2ZWwjI19saW5lYXJfcGFnZXRhYmxlKCAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKLSAgICBsZXZlbCMjX3BnZW50cnlfdCBwZGUsIHVuc2lnbmVkIGxv
bmcgcGRlX3Bmbiwgc3RydWN0IGRvbWFpbiAqZCkgICAgICAgICBcCisgICAgbGV2ZWwjI19wZ2Vu
dHJ5X3QgcGRlLCBtZm5fdCBwZGVfcGZuLCBzdHJ1Y3QgZG9tYWluICpkKSAgICAgICAgICAgICAg
ICAgXAogeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICB1bnNpZ25lZCBsb25nIHgsIHk7ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgdW5z
aWduZWQgbG9uZyBwZm47ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAorICAgIG1mbl90IHBmbjsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CiAgICAgaWYgKCAhb3B0X3B2X2xpbmVhcl9wdCApICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAogICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKQEAgLTcwMCwxNiAr
NzAwLDE2IEBAIGdldF8jI2xldmVsIyNfbGluZWFyX3BhZ2V0YWJsZSggICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIHJldHVybiAwOyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAg
IH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgaWYgKCAocGZuID0g
bGV2ZWwjI2VfZ2V0X3BmbihwZGUpKSAhPSBwZGVfcGZuICkgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgIGlmICggIW1mbl9lcShwZm4gPSBsZXZlbCMjZV9nZXRfbWZuKHBkZSksIHBkZV9w
Zm4pICkgICAgICAgICAgICAgICAgICAgIFwKICAgICB7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAg
IHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsICpwdHBnID0gbWZuX3RvX3BhZ2UoX21mbihwZGVfcGZu
KSk7ICAgICAgICAgXAorICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCAqcHRwZyA9IG1m
bl90b19wYWdlKHBkZV9wZm4pOyAgICAgICAgICAgICAgIFwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CiAgICAgICAgIC8qIE1ha2Ugc3VyZSB0aGUgcGFnZSB0YWJsZSBiZWxvbmdzIHRvIHRoZSBjb3Jy
ZWN0IGRvbWFpbi4gKi8gICAgICAgXAogICAgICAgICBpZiAoIHVubGlrZWx5KHBhZ2VfZ2V0X293
bmVyKHB0cGcpICE9IGQpICkgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgICAg
IHJldHVybiAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgICAgICAvKiBNYWtlIHN1cmUgdGhl
IG1hcHBlZCBmcmFtZSBiZWxvbmdzIHRvIHRoZSBjb3JyZWN0IGRvbWFpbi4gKi8gICAgIFwKLSAg
ICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fbWZuKF9tZm4ocGZuKSwgZCk7ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCisgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX21mbihwZm4s
IGQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgICAgICBpZiAoIHVu
bGlrZWx5KCFwYWdlKSApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKICAgICAgICAgICAgIHJldHVybiAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXApAQCAtNzU1
LDcgKzc1NSw3IEBAIGdldF8jI2xldmVsIyNfbGluZWFyX3BhZ2V0YWJsZSggICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAjZGVmaW5lIGRlZmluZV9nZXRfbGlu
ZWFyX3BhZ2V0YWJsZShsZXZlbCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiBzdGF0
aWMgaW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCiBnZXRfIyNsZXZlbCMjX2xpbmVhcl9wYWdldGFibGUoICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIGxldmVsIyNfcGdlbnRyeV90
IHBkZSwgdW5zaWduZWQgbG9uZyBwZGVfcGZuLCBzdHJ1Y3QgZG9tYWluICpkKSBcCisgICAgICAg
IGxldmVsIyNfcGdlbnRyeV90IHBkZSwgbWZuX3QgcGRlX3Bmbiwgc3RydWN0IGRvbWFpbiAqZCkg
ICAgICAgICBcCiB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIHJldHVybiAwOyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiB9CkBAIC0xMTQx
LDcgKzExNDEsNyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAogZGVm
aW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGwyKTsKIHN0YXRpYyBpbnQKIGdldF9wYWdlX2Zyb21f
bDJlKAotICAgIGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgbDJtZm4sIHN0cnVjdCBk
b21haW4gKmQsIHVuc2lnbmVkIGludCBmbGFncykKKyAgICBsMl9wZ2VudHJ5X3QgbDJlLCBtZm5f
dCBsMm1mbiwgc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIHVu
c2lnbmVkIGxvbmcgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKICAgICBpbnQgcmM7CkBAIC0xMTY1
LDcgKzExNjUsNyBAQCBnZXRfcGFnZV9mcm9tX2wyZSgKIGRlZmluZV9nZXRfbGluZWFyX3BhZ2V0
YWJsZShsMyk7CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9tX2wzZSgKLSAgICBsM19wZ2VudHJ5
X3QgbDNlLCB1bnNpZ25lZCBsb25nIGwzbWZuLCBzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBp
bnQgZmxhZ3MpCisgICAgbDNfcGdlbnRyeV90IGwzZSwgbWZuX3QgbDNtZm4sIHN0cnVjdCBkb21h
aW4gKmQsIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBpbnQgcmM7CiAKQEAgLTExODksNyAr
MTE4OSw3IEBAIGdldF9wYWdlX2Zyb21fbDNlKAogZGVmaW5lX2dldF9saW5lYXJfcGFnZXRhYmxl
KGw0KTsKIHN0YXRpYyBpbnQKIGdldF9wYWdlX2Zyb21fbDRlKAotICAgIGw0X3BnZW50cnlfdCBs
NGUsIHVuc2lnbmVkIGxvbmcgbDRtZm4sIHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGludCBm
bGFncykKKyAgICBsNF9wZ2VudHJ5X3QgbDRlLCBtZm5fdCBsNG1mbiwgc3RydWN0IGRvbWFpbiAq
ZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGludCByYzsKIApAQCAtMTMyOSwxMCArMTMy
OSw5IEBAIHN0YXRpYyBpbnQgcHV0X2RhdGFfcGFnZXMoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwg
Ym9vbCB3cml0ZWFibGUsIGludCBwdF9zaGlmdCkKICAqIE5CLiBWaXJ0dWFsIGFkZHJlc3MgJ2wy
ZScgbWFwcyB0byBhIG1hY2hpbmUgYWRkcmVzcyB3aXRoaW4gZnJhbWUgJ3BmbicuCiAgKiBOb3Rl
IGFsc28gdGhhdCB0aGlzIGF1dG9tYXRpY2FsbHkgZGVhbHMgY29ycmVjdGx5IHdpdGggbGluZWFy
IHAudC4ncy4KICAqLwotc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3Qg
bDJlLCB1bnNpZ25lZCBsb25nIGwybWZuLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgZmxhZ3MpCitzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50
cnlfdCBsMmUsIG1mbl90IGwybWZuLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7Ci0gICAgaWYgKCAh
KGwyZV9nZXRfZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpIHx8IChsMmVfZ2V0X3BmbihsMmUp
ID09IGwybWZuKSApCisgICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNF
TlQpIHx8IG1mbl9lcShsMmVfZ2V0X21mbihsMmUpLCBsMm1mbikgKQogICAgICAgICByZXR1cm4g
MTsKIAogICAgIGlmICggbDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0VfUFNFICkKQEAgLTEzNDAs
MTMgKzEzMzksMTIgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3Qg
bDJlLCB1bnNpZ25lZCBsb25nIGwybWZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0VfUlcsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBMMl9QQUdFVEFCTEVfU0hJRlQpOwogCi0gICAgcmV0dXJuIHB1dF9wdF9wYWdlKGwyZV9n
ZXRfcGFnZShsMmUpLCBtZm5fdG9fcGFnZShfbWZuKGwybWZuKSksIGZsYWdzKTsKKyAgICByZXR1
cm4gcHV0X3B0X3BhZ2UobDJlX2dldF9wYWdlKGwyZSksIG1mbl90b19wYWdlKGwybWZuKSwgZmxh
Z3MpOwogfQogCi1zdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2Us
IHVuc2lnbmVkIGxvbmcgbDNtZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBmbGFncykKK3N0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90
IGwzZSwgbWZuX3QgbDNtZm4sIHVuc2lnbmVkIGludCBmbGFncykKIHsKLSAgICBpZiAoICEobDNl
X2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgfHwgKGwzZV9nZXRfcGZuKGwzZSkgPT0g
bDNtZm4pICkKKyAgICBpZiAoICEobDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkg
fHwgbWZuX2VxKGwzZV9nZXRfbWZuKGwzZSksIGwzbWZuKSApCiAgICAgICAgIHJldHVybiAxOwog
CiAgICAgaWYgKCB1bmxpa2VseShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QU0UpICkKQEAg
LTEzNTQsMTYgKzEzNTIsMTUgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2Vu
dHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIGwzbWZuLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUlcsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBMM19QQUdFVEFCTEVfU0hJRlQpOwogCi0gICAgcmV0dXJuIHB1dF9wdF9wYWdl
KGwzZV9nZXRfcGFnZShsM2UpLCBtZm5fdG9fcGFnZShfbWZuKGwzbWZuKSksIGZsYWdzKTsKKyAg
ICByZXR1cm4gcHV0X3B0X3BhZ2UobDNlX2dldF9wYWdlKGwzZSksIG1mbl90b19wYWdlKGwzbWZu
KSwgZmxhZ3MpOwogfQogCi1zdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlf
dCBsNGUsIHVuc2lnbmVkIGxvbmcgbDRtZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVuc2lnbmVkIGludCBmbGFncykKK3N0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdl
bnRyeV90IGw0ZSwgbWZuX3QgbDRtZm4sIHVuc2lnbmVkIGludCBmbGFncykKIHsKLSAgICBpZiAo
ICEobDRlX2dldF9mbGFncyhsNGUpICYgX1BBR0VfUFJFU0VOVCkgfHwgKGw0ZV9nZXRfcGZuKGw0
ZSkgPT0gbDRtZm4pICkKKyAgICBpZiAoICEobDRlX2dldF9mbGFncyhsNGUpICYgX1BBR0VfUFJF
U0VOVCkgfHwgbWZuX2VxKGw0ZV9nZXRfbWZuKGw0ZSksIGw0bWZuKSApCiAgICAgICAgIHJldHVy
biAxOwogCi0gICAgcmV0dXJuIHB1dF9wdF9wYWdlKGw0ZV9nZXRfcGFnZShsNGUpLCBtZm5fdG9f
cGFnZShfbWZuKGw0bWZuKSksIGZsYWdzKTsKKyAgICByZXR1cm4gcHV0X3B0X3BhZ2UobDRlX2dl
dF9wYWdlKGw0ZSksIG1mbl90b19wYWdlKGw0bWZuKSwgZmxhZ3MpOwogfQogCiBzdGF0aWMgaW50
IGFsbG9jX2wxX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCkBAIC0xNDYwLDEzICsxNDU3
LDEzIEBAIHN0YXRpYyBpbnQgY3JlYXRlX3BhZV94ZW5fbWFwcGluZ3Moc3RydWN0IGRvbWFpbiAq
ZCwgbDNfcGdlbnRyeV90ICpwbDNlKQogc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiB7CiAgICAgc3RydWN0IGRvbWFp
biAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwotICAgIHVuc2lnbmVkIGxvbmcgIGwybWZuID0g
bWZuX3gocGFnZV90b19tZm4ocGFnZSkpOworICAgIG1mbl90ICAgICAgICAgbDJtZm4gPSBwYWdl
X3RvX21mbihwYWdlKTsKICAgICBsMl9wZ2VudHJ5X3QgICpwbDJlOwogICAgIHVuc2lnbmVkIGlu
dCAgIGk7CiAgICAgaW50ICAgICAgICAgICAgcmMgPSAwOwogICAgIHVuc2lnbmVkIGludCAgIHBh
cnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCi0gICAgcGwyZSA9IG1hcF9kb21h
aW5fcGFnZShfbWZuKGwybWZuKSk7CisgICAgcGwyZSA9IG1hcF9kb21haW5fcGFnZShsMm1mbik7
CiAKICAgICAvKgogICAgICAqIE5CIHRoYXQgYWxsb2NfbDJfdGFibGUgd2lsbCBuZXZlciBzZXQg
cGFydGlhbF9wdGUgb24gYW4gbDI7IGJ1dApAQCAtMTU1OSwxNCArMTU1NiwxNCBAQCBzdGF0aWMg
aW50IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkK
IHsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7Ci0gICAgdW5z
aWduZWQgbG9uZyAgbDNtZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7CisgICAgbWZuX3Qg
ICAgICAgICAgbDNtZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsM19wZ2VudHJ5X3QgICpw
bDNlOwogICAgIHVuc2lnbmVkIGludCAgIGk7CiAgICAgaW50ICAgICAgICAgICAgcmMgPSAwOwog
ICAgIHVuc2lnbmVkIGludCAgIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwog
ICAgIGwzX3BnZW50cnlfdCAgIGwzZSA9IGwzZV9lbXB0eSgpOwogCi0gICAgcGwzZSA9IG1hcF9k
b21haW5fcGFnZShfbWZuKGwzbWZuKSk7CisgICAgcGwzZSA9IG1hcF9kb21haW5fcGFnZShsM21m
bik7CiAKICAgICAvKgogICAgICAqIFBBRSBndWVzdHMgYWxsb2NhdGUgZnVsbCBwYWdlcywgYnV0
IGFyZW4ndCByZXF1aXJlZCB0byBpbml0aWFsaXplCkBAIC0xNzg2LDggKzE3ODMsOCBAQCB2b2lk
IHphcF9yb19tcHQobWZuX3QgbWZuKQogc3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogewogICAgIHN0cnVjdCBkb21haW4gKmQgPSBwYWdlX2dldF9vd25l
cihwYWdlKTsKLSAgICB1bnNpZ25lZCBsb25nICBsNG1mbiA9IG1mbl94KHBhZ2VfdG9fbWZuKHBh
Z2UpKTsKLSAgICBsNF9wZ2VudHJ5X3QgICpwbDRlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4obDRt
Zm4pKTsKKyAgICBtZm5fdCAgICAgICAgICBsNG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOworICAg
IGw0X3BnZW50cnlfdCAgKnBsNGUgPSBtYXBfZG9tYWluX3BhZ2UobDRtZm4pOwogICAgIHVuc2ln
bmVkIGludCAgIGk7CiAgICAgaW50ICAgICAgICAgICAgcmMgPSAwOwogICAgIHVuc2lnbmVkIGlu
dCAgIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwpAQCAtMTg2OSw3ICsxODY2
LDcgQEAgc3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQog
CiAgICAgaWYgKCAhcmMgKQogICAgIHsKLSAgICAgICAgaW5pdF94ZW5fbDRfc2xvdHMocGw0ZSwg
X21mbihsNG1mbiksCisgICAgICAgIGluaXRfeGVuX2w0X3Nsb3RzKHBsNGUsIGw0bWZuLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICBkLCBJTlZBTElEX01GTiwgVk1fQVNTSVNUKGQsIG0ycF9z
dHJpY3QpKTsKICAgICAgICAgYXRvbWljX2luYygmZC0+YXJjaC5wdi5ucl9sNF9wYWdlcyk7CiAg
ICAgfQpAQCAtMTg5NiwxMyArMTg5MywxMyBAQCBzdGF0aWMgdm9pZCBmcmVlX2wxX3RhYmxlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiBzdGF0aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSkKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIo
cGFnZSk7Ci0gICAgdW5zaWduZWQgbG9uZyBsMm1mbiA9IG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2Up
KTsKKyAgICBtZm5fdCBsMm1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgIGwyX3BnZW50cnlf
dCAqcGwyZTsKICAgICBpbnQgcmMgPSAwOwogICAgIHVuc2lnbmVkIGludCBwYXJ0aWFsX2ZsYWdz
ID0gcGFnZS0+cGFydGlhbF9mbGFncywKICAgICAgICAgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9w
dGVzIC0gIShwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KTsKIAotICAgIHBsMmUgPSBt
YXBfZG9tYWluX3BhZ2UoX21mbihsMm1mbikpOworICAgIHBsMmUgPSBtYXBfZG9tYWluX3BhZ2Uo
bDJtZm4pOwogCiAgICAgZm9yICggOyA7ICkKICAgICB7CkBAIC0xOTQ4LDEzICsxOTQ1LDEzIEBA
IHN0YXRpYyBpbnQgZnJlZV9sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogc3RhdGlj
IGludCBmcmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7CiAgICAgc3RydWN0
IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwotICAgIHVuc2lnbmVkIGxvbmcgbDNt
Zm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7CisgICAgbWZuX3QgbDNtZm4gPSBwYWdlX3Rv
X21mbihwYWdlKTsKICAgICBsM19wZ2VudHJ5X3QgKnBsM2U7CiAgICAgaW50IHJjID0gMDsKICAg
ICB1bnNpZ25lZCBpbnQgcGFydGlhbF9mbGFncyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3MsCiAgICAg
ICAgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICEocGFydGlhbF9mbGFncyAmIFBURl9w
YXJ0aWFsX3NldCk7CiAKLSAgICBwbDNlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4obDNtZm4pKTsK
KyAgICBwbDNlID0gbWFwX2RvbWFpbl9wYWdlKGwzbWZuKTsKIAogICAgIGZvciAoIDsgOyApCiAg
ICAgewpAQCAtMTk5NSw4ICsxOTkyLDggQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiBzdGF0aWMgaW50IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIocGFn
ZSk7Ci0gICAgdW5zaWduZWQgbG9uZyBsNG1mbiA9IG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKTsK
LSAgICBsNF9wZ2VudHJ5X3QgKnBsNGUgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihsNG1mbikpOwor
ICAgIG1mbl90IGw0bWZuID0gcGFnZV90b19tZm4ocGFnZSk7CisgICAgbDRfcGdlbnRyeV90ICpw
bDRlID0gbWFwX2RvbWFpbl9wYWdlKGw0bWZuKTsKICAgICBpbnQgcmMgPSAwOwogICAgIHVuc2ln
bmVkIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzLAogICAgICAgICBpID0gcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQp
OwpAQCAtMjI3NSw3ICsyMjcyLDcgQEAgc3RhdGljIGludCBtb2RfbDJfZW50cnkobDJfcGdlbnRy
eV90ICpwbDJlLAogICAgICAgICAgICAgcmV0dXJuIC1FQlVTWTsKICAgICAgICAgfQogCi0gICAg
ICAgIGlmICggdW5saWtlbHkoKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUobmwyZSwgbWZuX3gobWZu
KSwgZCwgMCkpIDwgMCkgKQorICAgICAgICBpZiAoIHVubGlrZWx5KChyYyA9IGdldF9wYWdlX2Zy
b21fbDJlKG5sMmUsIG1mbiwgZCwgMCkpIDwgMCkgKQogICAgICAgICAgICAgcmV0dXJuIHJjOwog
CiAgICAgICAgIG5sMmUgPSBhZGp1c3RfZ3Vlc3RfbDJlKG5sMmUsIGQpOwpAQCAtMjI5NCw3ICsy
MjkxLDcgQEAgc3RhdGljIGludCBtb2RfbDJfZW50cnkobDJfcGdlbnRyeV90ICpwbDJlLAogICAg
ICAgICByZXR1cm4gLUVCVVNZOwogICAgIH0KIAotICAgIHB1dF9wYWdlX2Zyb21fbDJlKG9sMmUs
IG1mbl94KG1mbiksIFBURl9kZWZlcik7CisgICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgbWZu
LCBQVEZfZGVmZXIpOwogCiAgICAgcmV0dXJuIHJjOwogfQpAQCAtMjMzNyw3ICsyMzM0LDcgQEAg
c3RhdGljIGludCBtb2RfbDNfZW50cnkobDNfcGdlbnRyeV90ICpwbDNlLAogICAgICAgICAgICAg
cmV0dXJuIHJjID8gMCA6IC1FRkFVTFQ7CiAgICAgICAgIH0KIAotICAgICAgICByYyA9IGdldF9w
YWdlX2Zyb21fbDNlKG5sM2UsIG1mbl94KG1mbiksIGQsIDApOworICAgICAgICByYyA9IGdldF9w
YWdlX2Zyb21fbDNlKG5sM2UsIG1mbiwgZCwgMCk7CiAgICAgICAgIGlmICggdW5saWtlbHkocmMg
PCAwKSApCiAgICAgICAgICAgICByZXR1cm4gcmM7CiAgICAgICAgIHJjID0gMDsKQEAgLTIzNjIs
NyArMjM1OSw3IEBAIHN0YXRpYyBpbnQgbW9kX2wzX2VudHJ5KGwzX3BnZW50cnlfdCAqcGwzZSwK
ICAgICAgICAgaWYgKCAhY3JlYXRlX3BhZV94ZW5fbWFwcGluZ3MoZCwgcGwzZSkgKQogICAgICAg
ICAgICAgQlVHKCk7CiAKLSAgICBwdXRfcGFnZV9mcm9tX2wzZShvbDNlLCBtZm5feChtZm4pLCBQ
VEZfZGVmZXIpOworICAgIHB1dF9wYWdlX2Zyb21fbDNlKG9sM2UsIG1mbiwgUFRGX2RlZmVyKTsK
ICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTI0MDQsNyArMjQwMSw3IEBAIHN0YXRpYyBpbnQgbW9k
X2w0X2VudHJ5KGw0X3BnZW50cnlfdCAqcGw0ZSwKICAgICAgICAgICAgIHJldHVybiByYyA/IDAg
OiAtRUZBVUxUOwogICAgICAgICB9CiAKLSAgICAgICAgcmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShu
bDRlLCBtZm5feChtZm4pLCBkLCAwKTsKKyAgICAgICAgcmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShu
bDRlLCBtZm4sIGQsIDApOwogICAgICAgICBpZiAoIHVubGlrZWx5KHJjIDwgMCkgKQogICAgICAg
ICAgICAgcmV0dXJuIHJjOwogICAgICAgICByYyA9IDA7CkBAIC0yNDI1LDcgKzI0MjIsNyBAQCBz
dGF0aWMgaW50IG1vZF9sNF9lbnRyeShsNF9wZ2VudHJ5X3QgKnBsNGUsCiAgICAgICAgIHJldHVy
biAtRUZBVUxUOwogICAgIH0KIAotICAgIHB1dF9wYWdlX2Zyb21fbDRlKG9sNGUsIG1mbl94KG1m
biksIFBURl9kZWZlcik7CisgICAgcHV0X3BhZ2VfZnJvbV9sNGUob2w0ZSwgbWZuLCBQVEZfZGVm
ZXIpOwogICAgIHJldHVybiByYzsKIH0KICNlbmRpZiAvKiBDT05GSUdfUFYgKi8KLS0gCjIuMjQu
MAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DD731BDA6D
	for <lists+xen-devel@lfdr.de>; Wed, 25 Sep 2019 11:04:13 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iD39f-0001Z6-7b; Wed, 25 Sep 2019 09:00:11 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=6irf=XU=citrix.com=paul.durrant@srs-us1.protection.inumbo.net>)
 id 1iD39d-0001XR-MC
 for xen-devel@lists.xenproject.org; Wed, 25 Sep 2019 09:00:09 +0000
X-Inumbo-ID: debc9f78-df72-11e9-97fb-bc764e2007e4
Received: from esa6.hc3370-68.iphmx.com (unknown [216.71.155.175])
 by localhost (Halon) with ESMTPS
 id debc9f78-df72-11e9-97fb-bc764e2007e4;
 Wed, 25 Sep 2019 09:00:07 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1569402007;
 h=from:to:cc:subject:date:message-id:references:
 in-reply-to:content-transfer-encoding:mime-version;
 bh=MRti3QuCBFegVl3XhrSEUeLnGcO9UUM6OMzPjfaMG+s=;
 b=cIZNbpa4DfRRikm5dgZXogMSlVZStVSYuSjsQ2IOMW2VMIxG4IJ8cnwK
 NUR9mobNykyJFZGVn1vr41zkYNsX6RPrSPpYUn1htzdLsUseKOp5R/5/E
 Nl/OA26vzyWixrLmWqYJvSwjjOroOHYLi+riUzQt2NAzZQEEAYokP/uge A=;
Authentication-Results: esa6.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=Paul.Durrant@citrix.com;
 spf=Pass smtp.mailfrom=Paul.Durrant@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa6.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 Paul.Durrant@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="Paul.Durrant@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa6.hc3370-68.iphmx.com: domain of
 Paul.Durrant@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="Paul.Durrant@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa6.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: xbEJcZs8Xcav9PBUOUMtrTYc/4uV84QcYKNqC3mxL0U5HLqvU7s8cYMIDy1iKYF2XckB6mAcQ8
 sT6tJXz35Dgk2seOQ83fNqEFAG8L0/JFVf2bsz9yvb9vL813Dxwo08zoLzaNddGeE4eYoeKfnN
 roYifwnI3QsMcv/fK1xzDBupQGTddC1/Od8DlsDhiBfCx3mlapdyquq2LvraTu5Y7M1VaUSA0M
 TRz13SO1NQhslzqSfgkWExElKysgSFSORfAd0QDm/Ih/MhmR7FVWvFsavV5qhox5QYRJRMk5Ue
 AVQ=
X-SBRS: 2.7
X-MesageID: 6308425
X-Ironport-Server: esa6.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,547,1559534400"; 
   d="scan'208";a="6308425"
From: Paul Durrant <Paul.Durrant@citrix.com>
To: Paul Durrant <Paul.Durrant@citrix.com>, Ian Jackson
 <Ian.Jackson@citrix.com>, Wei Liu <wl@xen.org>, Anthony Perard
 <anthony.perard@citrix.com>
Thread-Topic: [PATCH v13 1/4] remove late (on-demand) construction of IOMMU
 page tables
Thread-Index: AQHVbg2cp4/RM5itbkmB4FCOySHfvac8Ipwg
Date: Wed, 25 Sep 2019 09:00:02 +0000
Message-ID: <5e25bfa2e5cb4cc3acf845465dea50c5@AMSPEX02CL03.citrite.net>
References: <20190918104113.3294-1-paul.durrant@citrix.com>
 <20190918104113.3294-2-paul.durrant@citrix.com>
In-Reply-To: <20190918104113.3294-2-paul.durrant@citrix.com>
Accept-Language: en-GB, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-ms-exchange-transport-fromentityheader: Hosted
MIME-Version: 1.0
Subject: Re: [Xen-devel] [PATCH v13 1/4] remove late (on-demand)
 construction of IOMMU page tables
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "xen-devel \(xen-devel@lists.xenproject.org\)"
 <xen-devel@lists.xenproject.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TGlieGwgbWFpbnRhaW5lcnMuLi4gcGluZz8NCg0KPiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0t
LQ0KPiBGcm9tOiBQYXVsIER1cnJhbnQgPHBhdWwuZHVycmFudEBjaXRyaXguY29tPg0KPiBTZW50
OiAxOCBTZXB0ZW1iZXIgMjAxOSAxMTo0MQ0KPiBUbzogeGVuLWRldmVsQGxpc3RzLnhlbnByb2pl
Y3Qub3JnDQo+IENjOiBQYXVsIER1cnJhbnQgPFBhdWwuRHVycmFudEBjaXRyaXguY29tPjsgQWxl
eGFuZHJ1IElzYWlsYSA8YWlzYWlsYUBiaXRkZWZlbmRlci5jb20+OyBSYXp2YW4NCj4gQ29qb2Nh
cnUgPHJjb2pvY2FydUBiaXRkZWZlbmRlci5jb20+OyBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+OyBKdWxpZW4gR3JhbGwNCj4gPGp1bGllbi5ncmFsbEBhcm0uY29tPjsgU3RlZmFubyBT
dGFiZWxsaW5pIDxzc3RhYmVsbGluaUBrZXJuZWwub3JnPjsgVm9sb2R5bXlyIEJhYmNodWsNCj4g
PFZvbG9keW15cl9CYWJjaHVrQGVwYW0uY29tPjsgQW5kcmV3IENvb3BlciA8QW5kcmV3LkNvb3Bl
cjNAY2l0cml4LmNvbT47IEdlb3JnZSBEdW5sYXANCj4gPEdlb3JnZS5EdW5sYXBAY2l0cml4LmNv
bT47IElhbiBKYWNrc29uIDxJYW4uSmFja3NvbkBjaXRyaXguY29tPjsgS29ucmFkIFJ6ZXN6dXRl
ayBXaWxrDQo+IDxrb25yYWQud2lsa0BvcmFjbGUuY29tPjsgVGltIChYZW4ub3JnKSA8dGltQHhl
bi5vcmc+OyBXZWkgTGl1IDx3bEB4ZW4ub3JnPjsgUm9nZXIgUGF1IE1vbm5lDQo+IDxyb2dlci5w
YXVAY2l0cml4LmNvbT47IFRhbWFzIEsgTGVuZ3llbCA8dGFtYXNAdGtsZW5neWVsLmNvbT47IEdl
b3JnZSBEdW5sYXANCj4gPEdlb3JnZS5EdW5sYXBAY2l0cml4LmNvbT47IFBldHJlIFBpcmNhbGFi
dSA8cHBpcmNhbGFidUBiaXRkZWZlbmRlci5jb20+DQo+IFN1YmplY3Q6IFtQQVRDSCB2MTMgMS80
XSByZW1vdmUgbGF0ZSAob24tZGVtYW5kKSBjb25zdHJ1Y3Rpb24gb2YgSU9NTVUgcGFnZSB0YWJs
ZXMNCj4gDQo+IE5vdyB0aGF0IHRoZXJlIGlzIGEgcGVyLWRvbWFpbiBJT01NVS1lbmFibGUgZmxh
Zywgd2hpY2ggc2hvdWxkIGJlIHNldCBpZg0KPiBhbnkgZGV2aWNlIGlzIGdvaW5nIHRvIGJlIHBh
c3NlZCB0aHJvdWdoLCBzdG9wIGRlZmVycmluZyBwYWdlIHRhYmxlDQo+IGNvbnN0cnVjdGlvbiB1
bnRpbCB0aGUgYXNzaWdubWVudCBpcyBkb25lLiBBbHNvIGRvbid0IHRlYXIgZG93biB0aGUgdGFi
bGVzDQo+IGFnYWluIHdoZW4gdGhlIGxhc3QgZGV2aWNlIGlzIGRlLWFzc2lnbmVkOyBkZWZlciB0
aGF0IHRhc2sgdW50aWwgZG9tYWluDQo+IGRlc3RydWN0aW9uLg0KPiANCj4gVGhpcyBhbGxvd3Mg
dGhlIGhhc19pb21tdV9wdCgpIGhlbHBlciBhbmQgaW9tbXVfc3RhdHVzIGVudW1lcmF0aW9uIHRv
IGJlDQo+IHJlbW92ZWQuIENhbGxzIHRvIGhhc19pb21tdV9wdCgpIGFyZSBzaW1wbHkgcmVwbGFj
ZWQgYnkgY2FsbHMgdG8NCj4gaXNfaW9tbXVfZW5hYmxlZCgpLiBSZW1haW5pbmcgb3Blbi1jb2Rl
ZCB0ZXN0cyBvZiBpb21tdV9oYXBfcHRfc2hhcmUgY2FuDQo+IGFsc28gYmUgcmVwbGFjZWQgYnkg
Y2FsbHMgdG8gaW9tbXVfdXNlX2hhcF9wdCgpLg0KPiBUaGUgYXJjaF9pb21tdV9wb3B1bGF0ZV9w
YWdlX3RhYmxlKCkgYW5kIGlvbW11X2NvbnN0cnVjdCgpIGZ1bmN0aW9ucyBiZWNvbWUNCj4gcmVk
dW5kYW50LCBhcyBkb2VzIHRoZSAnc3RyaWN0IG1vZGUnIGRvbTAgcGFnZV9saXN0IG1hcHBpbmcg
Y29kZSBpbg0KPiBpb21tdV9od2RvbV9pbml0KCksIGFuZCBpb21tdV90ZWFyZG93bigpIGNhbiBi
ZSBtYWRlIHN0YXRpYyBpcyBpdHMgb25seQ0KPiByZW1haW5pbmcgY2FsbGVyLCBpb21tdV9kb21h
aW5fZGVzdHJveSgpLCBpcyB3aXRoaW4gdGhlIHNhbWUgc291cmNlDQo+IG1vZHVsZS4NCj4gDQo+
IEFsbCBpbiBhbGwsIGFib3V0IDIyMCBsaW5lcyBvZiBjb2RlIGFyZSByZW1vdmVkIGZyb20gdGhl
IGh5cGVydmlzb3IgKGF0DQo+IHRoZSBleHBlbnNlIG9mIHNvbWUgYWRkaXRpb25zIGluIHRoZSB0
b29sc3RhY2spLg0KPiANCj4gTk9URTogVGhpcyBwYXRjaCB3aWxsIGNhdXNlIGEgc21hbGwgYW1v
dW50IG9mIGV4dHJhIHJlc291cmNlIHRvIGJlIHVzZWQNCj4gICAgICAgdG8gYWNjb21tb2RhdGUg
SU9NTVUgcGFnZSB0YWJsZXMgdGhhdCBtYXkgbmV2ZXIgYmUgdXNlZCwgc2luY2UgdGhlDQo+ICAg
ICAgIHBlci1kb21haW4gSU9NTVUtZW5hYmxlIGZsYWcgaXMgY3VycmVudGx5IHNldCB0byB0aGUg
dmFsdWUgb2YgdGhlDQo+ICAgICAgIGdsb2JhbCBpb21tdV9lbmFibGUgZmxhZy4gQSBzdWJzZXF1
ZW50IHBhdGNoIHdpbGwgYWRkIGFuIG9wdGlvbiB0bw0KPiAgICAgICB0aGUgdG9vbHN0YWNrIHRv
IGFsbG93IGl0IHRvIGJlIHR1cm5lZCBvZmYgaWYgdGhlcmUgaXMgbm8gaW50ZW50aW9uDQo+ICAg
ICAgIHRvIGFzc2lnbiBwYXNzdGhyb3VnaCBoYXJkd2FyZSB0byB0aGUgZG9tYWluLg0KPiAgICAg
ICBUbyBhY2NvdW50IGZvciB0aGUgZXh0cmEgcmVzb3VyY2UsICdpb21tdV9tZW1rYicgaGFzIGJl
ZW4gYWRkZWQgdG8NCj4gICAgICAgZG9tYWluX2J1aWxkX2luZm8uIFRoaXMgcGF0Y2ggc2V0cyBp
dCB0byBhIHZhbHVlIGNhbGN1bGF0ZWQgYmFzZWQNCj4gICAgICAgb24gdGhlIGRvbWFpbidzIG1h
eGltdW0gbWVtb3J5IHdoZW4gdGhlIFAyTSBzaGFyaW5nIGlzIGVpdGhlciBub3QNCj4gICAgICAg
c3VwcG9ydGVkIG9yIGdsb2JhbGx5IGRpc2FibGVkLCBvciB6ZXJvIG90aGVyd2lzZS4gSG93ZXZl
ciwgd2hlbg0KPiAgICAgICB0aGUgdG9vbHN0YWNrIG9wdGlvbiBtZW50aW9uZWQgYWJvdmUgaXMg
YWRkZWQsIGl0IHdpbGwgYWxzbyBiZSB6ZXJvDQo+ICAgICAgIGlmIHRoZSBwZXItZG9tYWluIElP
TU1VLWVuYWJsZSBmbGFnIGlzIHR1cm5lZCBvZmYuDQo+IA0KPiBTaWduZWQtb2ZmLWJ5OiBQYXVs
IER1cnJhbnQgPHBhdWwuZHVycmFudEBjaXRyaXguY29tPg0KPiBSZXZpZXdlZC1ieTogQWxleGFu
ZHJ1IElzYWlsYSA8YWlzYWlsYUBiaXRkZWZlbmRlci5jb20+DQo+IEFja2VkLWJ5OiBSYXp2YW4g
Q29qb2NhcnUgPHJjb2pvY2FydUBiaXRkZWZlbmRlci5jb20+DQo+IFJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+DQo+IEFja2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1
bGllbi5ncmFsbEBhcm0uY29tPg0KPiAtLS0NCj4gQ2M6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3N0
YWJlbGxpbmlAa2VybmVsLm9yZz4NCj4gQ2M6IFZvbG9keW15ciBCYWJjaHVrIDxWb2xvZHlteXJf
QmFiY2h1a0BlcGFtLmNvbT4NCj4gQ2M6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNp
dHJpeC5jb20+DQo+IENjOiBHZW9yZ2UgRHVubGFwIDxHZW9yZ2UuRHVubGFwQGV1LmNpdHJpeC5j
b20+DQo+IENjOiBJYW4gSmFja3NvbiA8aWFuLmphY2tzb25AZXUuY2l0cml4LmNvbT4NCj4gQ2M6
IEtvbnJhZCBSemVzenV0ZWsgV2lsayA8a29ucmFkLndpbGtAb3JhY2xlLmNvbT4NCj4gQ2M6IFRp
bSBEZWVnYW4gPHRpbUB4ZW4ub3JnPg0KPiBDYzogV2VpIExpdSA8d2xAeGVuLm9yZz4NCj4gQ2M6
ICJSb2dlciBQYXUgTW9ubsOpIiA8cm9nZXIucGF1QGNpdHJpeC5jb20+DQo+IENjOiBUYW1hcyBL
IExlbmd5ZWwgPHRhbWFzQHRrbGVuZ3llbC5jb20+DQo+IENjOiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGV1LmNpdHJpeC5jb20+DQo+IENjOiBQZXRyZSBQaXJjYWxhYnUgPHBwaXJjYWxh
YnVAYml0ZGVmZW5kZXIuY29tPg0KPiANCj4gUHJldmlvdXNseSBwYXJ0IG9mIHNlcmllcyBodHRw
czovL2xpc3RzLnhlbnByb2plY3Qub3JnL2FyY2hpdmVzL2h0bWwveGVuLWRldmVsLzIwMTktMDcv
bXNnMDIyNjcuaHRtbA0KPiANCj4gdjk6DQo+ICAtIEF2b2lkIHRoZSBpb21tdV9tZW1rYiBvdmVy
aGVhZCBpZiB0aGUgSU9NTVUgaXMgZGlzYWJsZSBvciBwYWdlIHRhYmxlcw0KPiAgICBhcmUgc2hh
cmVkDQo+IA0KPiB2NzoNCj4gIC0gQWRkIHRvb2xzdGFjayBtZW1vcnkgcmVzZXJ2YXRpb24gZm9y
IElPTU1VIHBhZ2UgdGFibGVzLi4uIFJlLXVzZSBvZg0KPiAgICBzaGFkb3cgY2FsY3VsYXRpb24g
ZGlkbid0IHNlZW0gYXBwcm9wcmlhdGUgc28gYSBuZXcgaGVscGVyIGZ1bmN0aW9uIGlzDQo+ICAg
IGFkZGVkDQo+IA0KPiB2NToNCj4gIC0gTWlub3Igc3R5bGUgZml4ZXMNCj4gLS0tDQo+ICB0b29s
cy9saWJ4bC9saWJ4bC5oICAgICAgICAgICAgICAgICAgIHwgICA3ICsrDQo+ICB0b29scy9saWJ4
bC9saWJ4bF9tZW0uYyAgICAgICAgICAgICAgIHwgICA2ICstDQo+ICB0b29scy9saWJ4bC9saWJ4
bF90eXBlcy5pZGwgICAgICAgICAgIHwgICAxICsNCj4gIHRvb2xzL2xpYnhsL2xpYnhsX3V0aWxz
LmMgICAgICAgICAgICAgfCAgMTUgKysrDQo+ICB0b29scy9saWJ4bC9saWJ4bF91dGlscy5oICAg
ICAgICAgICAgIHwgICAxICsNCj4gIHRvb2xzL3hsL3hsX3BhcnNlLmMgICAgICAgICAgICAgICAg
ICAgfCAgMjQgKysrKy0NCj4gIHhlbi9hcmNoL2FybS9wMm0uYyAgICAgICAgICAgICAgICAgICAg
fCAgIDIgKy0NCj4gIHhlbi9hcmNoL3g4Ni9kb20wX2J1aWxkLmMgICAgICAgICAgICAgfCAgIDIg
Ky0NCj4gIHhlbi9hcmNoL3g4Ni9odm0vbXRyci5jICAgICAgICAgICAgICAgfCAgIDUgKy0NCj4g
IHhlbi9hcmNoL3g4Ni9tbS9tZW1fc2hhcmluZy5jICAgICAgICAgfCAgIDIgKy0NCj4gIHhlbi9h
cmNoL3g4Ni9tbS9wMm0uYyAgICAgICAgICAgICAgICAgfCAgIDQgKy0NCj4gIHhlbi9hcmNoL3g4
Ni9tbS9wYWdpbmcuYyAgICAgICAgICAgICAgfCAgIDIgKy0NCj4gIHhlbi9hcmNoL3g4Ni94ODZf
NjQvbW0uYyAgICAgICAgICAgICAgfCAgIDIgKy0NCj4gIHhlbi9jb21tb24vbWVtb3J5LmMgICAg
ICAgICAgICAgICAgICAgfCAgIDQgKy0NCj4gIHhlbi9jb21tb24vdm1fZXZlbnQuYyAgICAgICAg
ICAgICAgICAgfCAgIDIgKy0NCj4gIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVl
LmMgfCAgMTEgLS0tDQo+ICB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pb21tdS5jICAgICAgIHwg
MTM0ICsrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tDQo+ICB4ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9wY2kuYyAgICAgICAgIHwgIDEyIC0tLQ0KPiAgeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRk
L2lvbW11LmMgICB8ICAxMCArLQ0KPiAgeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2lvbW11
LmMgICB8ICA5NyAtLS0tLS0tLS0tLS0tLS0tLS0tDQo+ICB4ZW4vaW5jbHVkZS9hc20tYXJtL2lv
bW11LmggICAgICAgICAgIHwgICAyICstDQo+ICB4ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11Lmgg
ICAgICAgICAgIHwgICAyICstDQo+ICB4ZW4vaW5jbHVkZS94ZW4vaW9tbXUuaCAgICAgICAgICAg
ICAgIHwgIDE2IC0tLQ0KPiAgeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggICAgICAgICAgICAgICB8
ICAgMiAtDQo+ICAyNCBmaWxlcyBjaGFuZ2VkLCA5NCBpbnNlcnRpb25zKCspLCAyNzEgZGVsZXRp
b25zKC0pDQo+IA0KPiBkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGwuaCBiL3Rvb2xzL2xp
YnhsL2xpYnhsLmgNCj4gaW5kZXggODE2OWQ0NGJkYS4uMTI1NDUxMzBkZiAxMDA2NDQNCj4gLS0t
IGEvdG9vbHMvbGlieGwvbGlieGwuaA0KPiArKysgYi90b29scy9saWJ4bC9saWJ4bC5oDQo+IEBA
IC00MDgsNiArNDA4LDEzIEBADQo+ICAgKi8NCj4gICNkZWZpbmUgTElCWExfSEFWRV9QSFlTSU5G
T19DQVBfSU9NTVVfSEFQX1BUX1NIQVJFIDENCj4gDQo+ICsvKg0KPiArICogTElCWExfSEFWRV9C
VUlMRElORk9fSU9NTVVfTUVNS0IgaW5kaWNhdGVzIHRoYXRlIGxpYnhsX2RvbWFpbl9idWlsZF9p
bmZvDQo+ICsgKiBoYXMgYW4gaW9tbXVfbWVta2IgZmllbGQgd2hpY2ggc2hvdWxkIGJlIHNldCB3
aXRoIHRoZSBhbW91bnQgb2YgbWVtb3J5DQo+ICsgKiBvdmVyaGVhZCBuZWVkZWQgYnkgdGhlIGRv
bWFpbiBmb3IgcG9wdWxhdGluZyBJT01NVSBwYWdlIHRhYmxlcy4NCj4gKyAqLw0KPiArI2RlZmlu
ZSBMSUJYTF9IQVZFX0JVSUxESU5GT19JT01NVV9NRU1LQiAxDQo+ICsNCj4gIC8qDQo+ICAgKiBs
aWJ4bCBBQkkgY29tcGF0aWJpbGl0eQ0KPiAgICoNCj4gZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhs
L2xpYnhsX21lbS5jIGIvdG9vbHMvbGlieGwvbGlieGxfbWVtLmMNCj4gaW5kZXggNDQ4YTJhZjhm
ZC4uZmQ2ZjMzMzEyZSAxMDA2NDQNCj4gLS0tIGEvdG9vbHMvbGlieGwvbGlieGxfbWVtLmMNCj4g
KysrIGIvdG9vbHMvbGlieGwvbGlieGxfbWVtLmMNCj4gQEAgLTQ2MSwxNSArNDYxLDE3IEBAIGlu
dCBsaWJ4bF9kb21haW5fbmVlZF9tZW1vcnkobGlieGxfY3R4ICpjdHgsDQo+ICAgICAgaWYgKHJj
KSBnb3RvIG91dDsNCj4gDQo+ICAgICAgKm5lZWRfbWVta2IgPSBiX2luZm8tPnRhcmdldF9tZW1r
YjsNCj4gKyAgICAqbmVlZF9tZW1rYiArPSBiX2luZm8tPnNoYWRvd19tZW1rYiArIGJfaW5mby0+
aW9tbXVfbWVta2I7DQo+ICsNCj4gICAgICBzd2l0Y2ggKGJfaW5mby0+dHlwZSkgew0KPiAgICAg
IGNhc2UgTElCWExfRE9NQUlOX1RZUEVfUFZIOg0KPiAgICAgIGNhc2UgTElCWExfRE9NQUlOX1RZ
UEVfSFZNOg0KPiAtICAgICAgICAqbmVlZF9tZW1rYiArPSBiX2luZm8tPnNoYWRvd19tZW1rYiAr
IExJQlhMX0hWTV9FWFRSQV9NRU1PUlk7DQo+ICsgICAgICAgICpuZWVkX21lbWtiICs9IExJQlhM
X0hWTV9FWFRSQV9NRU1PUlk7DQo+ICAgICAgICAgIGlmIChsaWJ4bF9kZWZib29sX3ZhbChiX2lu
Zm8tPmRldmljZV9tb2RlbF9zdHViZG9tYWluKSkNCj4gICAgICAgICAgICAgICpuZWVkX21lbWti
ICs9IDMyICogMTAyNDsNCj4gICAgICAgICAgYnJlYWs7DQo+ICAgICAgY2FzZSBMSUJYTF9ET01B
SU5fVFlQRV9QVjoNCj4gLSAgICAgICAgKm5lZWRfbWVta2IgKz0gYl9pbmZvLT5zaGFkb3dfbWVt
a2IgKyBMSUJYTF9QVl9FWFRSQV9NRU1PUlk7DQo+ICsgICAgICAgICpuZWVkX21lbWtiICs9IExJ
QlhMX1BWX0VYVFJBX01FTU9SWTsNCj4gICAgICAgICAgYnJlYWs7DQo+ICAgICAgZGVmYXVsdDoN
Cj4gICAgICAgICAgcmMgPSBFUlJPUl9JTlZBTDsNCj4gZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhs
L2xpYnhsX3R5cGVzLmlkbCBiL3Rvb2xzL2xpYnhsL2xpYnhsX3R5cGVzLmlkbA0KPiBpbmRleCA3
MjUzZDZlMGZiLi5kNTJjNjNiNmIwIDEwMDY0NA0KPiAtLS0gYS90b29scy9saWJ4bC9saWJ4bF90
eXBlcy5pZGwNCj4gKysrIGIvdG9vbHMvbGlieGwvbGlieGxfdHlwZXMuaWRsDQo+IEBAIC00ODYs
NiArNDg2LDcgQEAgbGlieGxfZG9tYWluX2J1aWxkX2luZm8gPSBTdHJ1Y3QoImRvbWFpbl9idWls
ZF9pbmZvIixbDQo+ICAgICAgKCJ0YXJnZXRfbWVta2IiLCAgICBNZW1LQiksDQo+ICAgICAgKCJ2
aWRlb19tZW1rYiIsICAgICBNZW1LQiksDQo+ICAgICAgKCJzaGFkb3dfbWVta2IiLCAgICBNZW1L
QiksDQo+ICsgICAgKCJpb21tdV9tZW1rYiIsICAgICBNZW1LQiksDQo+ICAgICAgKCJydGNfdGlt
ZW9mZnNldCIsICB1aW50MzIpLA0KPiAgICAgICgiZXhlY19zc2lkcmVmIiwgICAgdWludDMyKSwN
Cj4gICAgICAoImV4ZWNfc3NpZF9sYWJlbCIsIHN0cmluZyksDQo+IGRpZmYgLS1naXQgYS90b29s
cy9saWJ4bC9saWJ4bF91dGlscy5jIGIvdG9vbHMvbGlieGwvbGlieGxfdXRpbHMuYw0KPiBpbmRl
eCBmMzYwZjVlMjI4Li40MDU3MzNiN2UxIDEwMDY0NA0KPiAtLS0gYS90b29scy9saWJ4bC9saWJ4
bF91dGlscy5jDQo+ICsrKyBiL3Rvb2xzL2xpYnhsL2xpYnhsX3V0aWxzLmMNCj4gQEAgLTQ4LDYg
KzQ4LDIxIEBAIHVuc2lnbmVkIGxvbmcgbGlieGxfZ2V0X3JlcXVpcmVkX3NoYWRvd19tZW1vcnko
dW5zaWduZWQgbG9uZyBtYXhtZW1fa2IsIHVuc2lnbmVkDQo+ICAgICAgcmV0dXJuIDQgKiAoMjU2
ICogc21wX2NwdXMgKyAyICogKG1heG1lbV9rYiAvIDEwMjQpKTsNCj4gIH0NCj4gDQo+ICt1bnNp
Z25lZCBsb25nIGxpYnhsX2dldF9yZXF1aXJlZF9pb21tdV9tZW1vcnkodW5zaWduZWQgbG9uZyBt
YXhtZW1fa2IpDQo+ICt7DQo+ICsgICAgdW5zaWduZWQgbG9uZyBpb21tdV9wYWdlcyA9IDAsIG1l
bV9wYWdlcyA9IG1heG1lbV9rYiAvIDQ7DQo+ICsgICAgdW5zaWduZWQgaW50IGxldmVsOw0KPiAr
DQo+ICsgICAgLyogQXNzdW1lIGEgNCBsZXZlbCBwYWdlIHRhYmxlIHdpdGggNTEyIGVudHJpZXMg
cGVyIGxldmVsICovDQo+ICsgICAgZm9yIChsZXZlbCA9IDA7IGxldmVsIDwgNDsgbGV2ZWwrKykN
Cj4gKyAgICB7DQo+ICsgICAgICAgIG1lbV9wYWdlcyA9IERJVl9ST1VORFVQKG1lbV9wYWdlcywg
NTEyKTsNCj4gKyAgICAgICAgaW9tbXVfcGFnZXMgKz0gbWVtX3BhZ2VzOw0KPiArICAgIH0NCj4g
Kw0KPiArICAgIHJldHVybiBpb21tdV9wYWdlcyAqIDQ7DQo+ICt9DQo+ICsNCj4gIGNoYXIgKmxp
YnhsX2RvbWlkX3RvX25hbWUobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IGRvbWlkKQ0KPiAgew0K
PiAgICAgIHVuc2lnbmVkIGludCBsZW47DQo+IGRpZmYgLS1naXQgYS90b29scy9saWJ4bC9saWJ4
bF91dGlscy5oIGIvdG9vbHMvbGlieGwvbGlieGxfdXRpbHMuaA0KPiBpbmRleCA0NDQwOWFmZGM0
Li42MzBjY2JlMjhhIDEwMDY0NA0KPiAtLS0gYS90b29scy9saWJ4bC9saWJ4bF91dGlscy5oDQo+
ICsrKyBiL3Rvb2xzL2xpYnhsL2xpYnhsX3V0aWxzLmgNCj4gQEAgLTI0LDYgKzI0LDcgQEAgY29u
c3QNCj4gIGNoYXIgKmxpYnhsX2Jhc2VuYW1lKGNvbnN0IGNoYXIgKm5hbWUpOyAvKiByZXR1cm5z
IHN0cmluZyBmcm9tIHN0cmR1cCAqLw0KPiANCj4gIHVuc2lnbmVkIGxvbmcgbGlieGxfZ2V0X3Jl
cXVpcmVkX3NoYWRvd19tZW1vcnkodW5zaWduZWQgbG9uZyBtYXhtZW1fa2IsIHVuc2lnbmVkIGlu
dCBzbXBfY3B1cyk7DQo+ICt1bnNpZ25lZCBsb25nIGxpYnhsX2dldF9yZXF1aXJlZF9pb21tdV9t
ZW1vcnkodW5zaWduZWQgbG9uZyBtYXhtZW1fa2IpOw0KPiAgaW50IGxpYnhsX25hbWVfdG9fZG9t
aWQobGlieGxfY3R4ICpjdHgsIGNvbnN0IGNoYXIgKm5hbWUsIHVpbnQzMl90ICpkb21pZCk7DQo+
ICBpbnQgbGlieGxfZG9tYWluX3F1YWxpZmllcl90b19kb21pZChsaWJ4bF9jdHggKmN0eCwgY29u
c3QgY2hhciAqbmFtZSwgdWludDMyX3QgKmRvbWlkKTsNCj4gIGNoYXIgKmxpYnhsX2RvbWlkX3Rv
X25hbWUobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IGRvbWlkKTsNCj4gZGlmZiAtLWdpdCBhL3Rv
b2xzL3hsL3hsX3BhcnNlLmMgYi90b29scy94bC94bF9wYXJzZS5jDQo+IGluZGV4IGUxMDViZGEy
YmIuLjI5M2Y1ZjczMGUgMTAwNjQ0DQo+IC0tLSBhL3Rvb2xzL3hsL3hsX3BhcnNlLmMNCj4gKysr
IGIvdG9vbHMveGwveGxfcGFyc2UuYw0KPiBAQCAtMTIwNyw2ICsxMjA3LDcgQEAgdm9pZCBwYXJz
ZV9jb25maWdfZGF0YShjb25zdCBjaGFyICpjb25maWdfc291cmNlLA0KPiAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgY29uZmlnX2xlbiwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgbGli
eGxfZG9tYWluX2NvbmZpZyAqZF9jb25maWcpDQo+ICB7DQo+ICsgICAgbGlieGxfcGh5c2luZm8g
cGh5c2luZm87DQo+ICAgICAgY29uc3QgY2hhciAqYnVmOw0KPiAgICAgIGxvbmcgbCwgdmNwdXMg
PSAwOw0KPiAgICAgIFhMVV9Db25maWcgKmNvbmZpZzsNCj4gQEAgLTEyMjEsMTAgKzEyMjIsMjIg
QEAgdm9pZCBwYXJzZV9jb25maWdfZGF0YShjb25zdCBjaGFyICpjb25maWdfc291cmNlLA0KPiAg
ICAgIGludCBwY2lfc2VpemUgPSAwOw0KPiAgICAgIGludCBpLCBlOw0KPiAgICAgIGNoYXIgKmtl
cm5lbF9iYXNlbmFtZTsNCj4gKyAgICBib29sIGlvbW11X2VuYWJsZWQsIGlvbW11X2hhcF9wdF9z
aGFyZTsNCj4gDQo+ICAgICAgbGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvICpjX2luZm8gPSAmZF9j
b25maWctPmNfaW5mbzsNCj4gICAgICBsaWJ4bF9kb21haW5fYnVpbGRfaW5mbyAqYl9pbmZvID0g
JmRfY29uZmlnLT5iX2luZm87DQo+IA0KPiArICAgIGxpYnhsX3BoeXNpbmZvX2luaXQoJnBoeXNp
bmZvKTsNCj4gKyAgICBpZiAobGlieGxfZ2V0X3BoeXNpbmZvKGN0eCwgJnBoeXNpbmZvKSAhPSAw
KSB7DQo+ICsgICAgICAgIGxpYnhsX3BoeXNpbmZvX2Rpc3Bvc2UoJnBoeXNpbmZvKTsNCj4gKyAg
ICAgICAgZnByaW50ZihzdGRlcnIsICJsaWJ4bF9nZXRfcGh5c2luZm8gZmFpbGVkXG4iKTsNCj4g
KyAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOw0KPiArICAgIH0NCj4gKw0KPiArICAgIGlvbW11
X2VuYWJsZWQgPSBwaHlzaW5mby5jYXBfaHZtX2RpcmVjdGlvOw0KPiArICAgIGlvbW11X2hhcF9w
dF9zaGFyZSA9IHBoeXNpbmZvLmNhcF9pb21tdV9oYXBfcHRfc2hhcmU7DQo+ICsgICAgbGlieGxf
cGh5c2luZm9fZGlzcG9zZSgmcGh5c2luZm8pOw0KPiArDQo+ICAgICAgY29uZmlnPSB4bHVfY2Zn
X2luaXQoc3RkZXJyLCBjb25maWdfc291cmNlKTsNCj4gICAgICBpZiAoIWNvbmZpZykgew0KPiAg
ICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkZhaWxlZCB0byBhbGxvY2F0ZSBmb3IgY29uZmlndXJh
dGlvblxuIik7DQo+IEBAIC0xNDQ4LDE0ICsxNDYxLDIxIEBAIHZvaWQgcGFyc2VfY29uZmlnX2Rh
dGEoY29uc3QgY2hhciAqY29uZmlnX3NvdXJjZSwNCj4gICAgICAgICAgZXhpdCgxKTsNCj4gICAg
ICB9DQo+IA0KPiAtICAgIC8qIGxpYnhsX2dldF9yZXF1aXJlZF9zaGFkb3dfbWVtb3J5KCkgbXVz
dCBiZSBjYWxsZWQgYWZ0ZXIgZmluYWwgdmFsdWVzDQo+ICsgICAgLyogbGlieGxfZ2V0X3JlcXVp
cmVkX3NoYWRvd19tZW1vcnkoKSBhbmQNCj4gKyAgICAgKiBsaWJ4bF9nZXRfcmVxdWlyZWRfaW9t
bXVfbWVtb3J5KCkgbXVzdCBiZSBjYWxsZWQgYWZ0ZXIgZmluYWwgdmFsdWVzDQo+ICAgICAgICog
KGRlZmF1bHQgb3Igc3BlY2lmaWVkKSBmb3IgdmNwdXMgYW5kIG1lbW9yeSBhcmUgc2V0LCBiZWNh
dXNlIHRoZQ0KPiAtICAgICAqIGNhbGN1bGF0aW9uIGRlcGVuZHMgb24gdGhvc2UgdmFsdWVzLiAq
Lw0KPiArICAgICAqIGNhbGN1bGF0aW9ucyBkZXBlbmQgb24gdGhvc2UgdmFsdWVzLiAqLw0KPiAg
ICAgIGJfaW5mby0+c2hhZG93X21lbWtiID0gIXhsdV9jZmdfZ2V0X2xvbmcoY29uZmlnLCAic2hh
ZG93X21lbW9yeSIsICZsLCAwKQ0KPiAgICAgICAgICA/IGwgKiAxMDI0DQo+ICAgICAgICAgIDog
bGlieGxfZ2V0X3JlcXVpcmVkX3NoYWRvd19tZW1vcnkoYl9pbmZvLT5tYXhfbWVta2IsDQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYl9pbmZvLT5tYXhfdmNw
dXMpOw0KPiANCj4gKyAgICAvKiBObyBJT01NVSByZXNlcnZhdGlvbiBpcyBuZWVkZWQgaWYgZWl0
aGVyIHRoZSBJT01NVSBpcyBkaXNhYmxlZCBvciBpdA0KPiArICAgICAqIGNhbiBzaGFyZSB0aGUg
UDJNLiAqLw0KPiArICAgIGJfaW5mby0+aW9tbXVfbWVta2IgPSAoIWlvbW11X2VuYWJsZWQgfHwg
aW9tbXVfaGFwX3B0X3NoYXJlKQ0KPiArICAgICAgICA/IDANCj4gKyAgICAgICAgOiBsaWJ4bF9n
ZXRfcmVxdWlyZWRfaW9tbXVfbWVtb3J5KGJfaW5mby0+bWF4X21lbWtiKTsNCj4gKw0KPiAgICAg
IHhsdV9jZmdfZ2V0X2RlZmJvb2woY29uZmlnLCAibm9taWdyYXRlIiwgJmJfaW5mby0+ZGlzYWJs
ZV9taWdyYXRlLCAwKTsNCj4gDQo+ICAgICAgaWYgKCF4bHVfY2ZnX2dldF9sb25nKGNvbmZpZywg
InRzY19tb2RlIiwgJmwsIDEpKSB7DQo+IGRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0vcDJtLmMg
Yi94ZW4vYXJjaC9hcm0vcDJtLmMNCj4gaW5kZXggN2YxNDQyOTMyYS4uNjkyNTY1NzU3ZSAxMDA2
NDQNCj4gLS0tIGEveGVuL2FyY2gvYXJtL3AybS5jDQo+ICsrKyBiL3hlbi9hcmNoL2FybS9wMm0u
Yw0KPiBAQCAtMTA1Niw3ICsxMDU2LDcgQEAgc3RhdGljIGludCBfX3AybV9zZXRfZW50cnkoc3Ry
dWN0IHAybV9kb21haW4gKnAybSwNCj4gICAgICAgICAgICFtZm5fZXEobHBhZV9nZXRfbWZuKCpl
bnRyeSksIGxwYWVfZ2V0X21mbihvcmlnX3B0ZSkpICkNCj4gICAgICAgICAgcDJtX2ZyZWVfZW50
cnkocDJtLCBvcmlnX3B0ZSwgbGV2ZWwpOw0KPiANCj4gLSAgICBpZiAoIGhhc19pb21tdV9wdChw
Mm0tPmRvbWFpbikgJiYNCj4gKyAgICBpZiAoIGlzX2lvbW11X2VuYWJsZWQocDJtLT5kb21haW4p
ICYmDQo+ICAgICAgICAgICAobHBhZV9pc192YWxpZChvcmlnX3B0ZSkgfHwgbHBhZV9pc192YWxp
ZCgqZW50cnkpKSApDQo+ICAgICAgew0KPiAgICAgICAgICB1bnNpZ25lZCBpbnQgZmx1c2hfZmxh
Z3MgPSAwOw0KPiBkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbTBfYnVpbGQuYyBiL3hlbi9h
cmNoL3g4Ni9kb20wX2J1aWxkLmMNCj4gaW5kZXggZDM4MTc4NGVkZC4uN2NmYWIyZGMyNSAxMDA2
NDQNCj4gLS0tIGEveGVuL2FyY2gveDg2L2RvbTBfYnVpbGQuYw0KPiArKysgYi94ZW4vYXJjaC94
ODYvZG9tMF9idWlsZC5jDQo+IEBAIC0zNjUsNyArMzY1LDcgQEAgdW5zaWduZWQgbG9uZyBfX2lu
aXQgZG9tMF9jb21wdXRlX25yX3BhZ2VzKA0KPiAgICAgIH0NCj4gDQo+ICAgICAgbmVlZF9wYWdp
bmcgPSBpc19odm1fZG9tYWluKGQpICYmDQo+IC0gICAgICAgICghaW9tbXVfaGFwX3B0X3NoYXJl
IHx8ICFwYWdpbmdfbW9kZV9oYXAoZCkpOw0KPiArICAgICAgICAoIWlvbW11X3VzZV9oYXBfcHQo
ZCkgfHwgIXBhZ2luZ19tb2RlX2hhcChkKSk7DQo+ICAgICAgZm9yICggOyA7IG5lZWRfcGFnaW5n
ID0gZmFsc2UgKQ0KPiAgICAgIHsNCj4gICAgICAgICAgbnJfcGFnZXMgPSBnZXRfbWVtc2l6ZSgm
ZG9tMF9zaXplLCBhdmFpbCk7DQo+IGRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL210cnIu
YyBiL3hlbi9hcmNoL3g4Ni9odm0vbXRyci5jDQo+IGluZGV4IDdjY2Q4NWJjZWEuLjVhZDE1ZWFm
ZTAgMTAwNjQ0DQo+IC0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vbXRyci5jDQo+ICsrKyBiL3hlbi9h
cmNoL3g4Ni9odm0vbXRyci5jDQo+IEBAIC03ODMsNyArNzgzLDggQEAgSFZNX1JFR0lTVEVSX1NB
VkVfUkVTVE9SRShNVFJSLCBodm1fc2F2ZV9tdHJyX21zciwgaHZtX2xvYWRfbXRycl9tc3IsIDEs
DQo+IA0KPiAgdm9pZCBtZW1vcnlfdHlwZV9jaGFuZ2VkKHN0cnVjdCBkb21haW4gKmQpDQo+ICB7
DQo+IC0gICAgaWYgKCAoaGFzX2lvbW11X3B0KGQpIHx8IGNhY2hlX2ZsdXNoX3Blcm1pdHRlZChk
KSkgJiYgZC0+dmNwdSAmJiBkLT52Y3B1WzBdICkNCj4gKyAgICBpZiAoIChpc19pb21tdV9lbmFi
bGVkKGQpIHx8IGNhY2hlX2ZsdXNoX3Blcm1pdHRlZChkKSkgJiYNCj4gKyAgICAgICAgIGQtPnZj
cHUgJiYgZC0+dmNwdVswXSApDQo+ICAgICAgew0KPiAgICAgICAgICBwMm1fbWVtb3J5X3R5cGVf
Y2hhbmdlZChkKTsNCj4gICAgICAgICAgZmx1c2hfYWxsKEZMVVNIX0NBQ0hFKTsNCj4gQEAgLTgz
MSw3ICs4MzIsNyBAQCBpbnQgZXB0ZV9nZXRfZW50cnlfZW10KHN0cnVjdCBkb21haW4gKmQsIHVu
c2lnbmVkIGxvbmcgZ2ZuLCBtZm5fdCBtZm4sDQo+ICAgICAgICAgIHJldHVybiBNVFJSX1RZUEVf
VU5DQUNIQUJMRTsNCj4gICAgICB9DQo+IA0KPiAtICAgIGlmICggIWhhc19pb21tdV9wdChkKSAm
JiAhY2FjaGVfZmx1c2hfcGVybWl0dGVkKGQpICkNCj4gKyAgICBpZiAoICFpc19pb21tdV9lbmFi
bGVkKGQpICYmICFjYWNoZV9mbHVzaF9wZXJtaXR0ZWQoZCkgKQ0KPiAgICAgIHsNCj4gICAgICAg
ICAgKmlwYXQgPSAxOw0KPiAgICAgICAgICByZXR1cm4gTVRSUl9UWVBFX1dSQkFDSzsNCj4gZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9tZW1fc2hhcmluZy5jIGIveGVuL2FyY2gveDg2L21t
L21lbV9zaGFyaW5nLmMNCj4gaW5kZXggYTVmZTg5ZTMzOS4uZWZiODgyMTc2OCAxMDA2NDQNCj4g
LS0tIGEveGVuL2FyY2gveDg2L21tL21lbV9zaGFyaW5nLmMNCj4gKysrIGIveGVuL2FyY2gveDg2
L21tL21lbV9zaGFyaW5nLmMNCj4gQEAgLTE2NjQsNyArMTY2NCw3IEBAIGludCBtZW1fc2hhcmlu
Z19kb21jdGwoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHhlbl9kb21jdGxfbWVtX3NoYXJpbmdf
b3AgKm1lYykNCj4gICAgICAgICAgY2FzZSBYRU5fRE9NQ1RMX01FTV9TSEFSSU5HX0NPTlRST0w6
DQo+ICAgICAgICAgIHsNCj4gICAgICAgICAgICAgIHJjID0gMDsNCj4gLSAgICAgICAgICAgIGlm
ICggdW5saWtlbHkoaGFzX2lvbW11X3B0KGQpICYmIG1lYy0+dS5lbmFibGUpICkNCj4gKyAgICAg
ICAgICAgIGlmICggdW5saWtlbHkoaXNfaW9tbXVfZW5hYmxlZChkKSAmJiBtZWMtPnUuZW5hYmxl
KSApDQo+ICAgICAgICAgICAgICAgICAgcmMgPSAtRVhERVY7DQo+ICAgICAgICAgICAgICBlbHNl
DQo+ICAgICAgICAgICAgICAgICAgZC0+YXJjaC5odm0ubWVtX3NoYXJpbmdfZW5hYmxlZCA9IG1l
Yy0+dS5lbmFibGU7DQo+IGRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMgYi94ZW4v
YXJjaC94ODYvbW0vcDJtLmMNCj4gaW5kZXggOGE1MjI5ZWUyMS4uZTVlNDM0OWRlYSAxMDA2NDQN
Cj4gLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jDQo+ICsrKyBiL3hlbi9hcmNoL3g4Ni9tbS9w
Mm0uYw0KPiBAQCAtMTM0MSw3ICsxMzQxLDcgQEAgaW50IHNldF9pZGVudGl0eV9wMm1fZW50cnko
c3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwNCj4gDQo+ICAgICAgaWYgKCAh
cGFnaW5nX21vZGVfdHJhbnNsYXRlKHAybS0+ZG9tYWluKSApDQo+ICAgICAgew0KPiAtICAgICAg
ICBpZiAoICFoYXNfaW9tbXVfcHQoZCkgKQ0KPiArICAgICAgICBpZiAoICFpc19pb21tdV9lbmFi
bGVkKGQpICkNCj4gICAgICAgICAgICAgIHJldHVybiAwOw0KPiAgICAgICAgICByZXR1cm4gaW9t
bXVfbGVnYWN5X21hcChkLCBfZGZuKGdmbl9sKSwgX21mbihnZm5fbCksIFBBR0VfT1JERVJfNEss
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VRl9yZWFkYWJsZSB8IElP
TU1VRl93cml0YWJsZSk7DQo+IEBAIC0xNDMyLDcgKzE0MzIsNyBAQCBpbnQgY2xlYXJfaWRlbnRp
dHlfcDJtX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuX2wpDQo+IA0K
PiAgICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShkKSApDQo+ICAgICAgew0KPiAtICAg
ICAgICBpZiAoICFoYXNfaW9tbXVfcHQoZCkgKQ0KPiArICAgICAgICBpZiAoICFpc19pb21tdV9l
bmFibGVkKGQpICkNCj4gICAgICAgICAgICAgIHJldHVybiAwOw0KPiAgICAgICAgICByZXR1cm4g
aW9tbXVfbGVnYWN5X3VubWFwKGQsIF9kZm4oZ2ZuX2wpLCBQQUdFX09SREVSXzRLKTsNCj4gICAg
ICB9DQo+IGRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcGFnaW5nLmMgYi94ZW4vYXJjaC94
ODYvbW0vcGFnaW5nLmMNCj4gaW5kZXggNjlhYTIyOGU0Ni4uZDlhNTJjNGRiNCAxMDA2NDQNCj4g
LS0tIGEveGVuL2FyY2gveDg2L21tL3BhZ2luZy5jDQo+ICsrKyBiL3hlbi9hcmNoL3g4Ni9tbS9w
YWdpbmcuYw0KPiBAQCAtMjEzLDcgKzIxMyw3IEBAIGludCBwYWdpbmdfbG9nX2RpcnR5X2VuYWJs
ZShzdHJ1Y3QgZG9tYWluICpkLCBib29sX3QgbG9nX2dsb2JhbCkNCj4gIHsNCj4gICAgICBpbnQg
cmV0Ow0KPiANCj4gLSAgICBpZiAoIGhhc19pb21tdV9wdChkKSAmJiBsb2dfZ2xvYmFsICkNCj4g
KyAgICBpZiAoIGlzX2lvbW11X2VuYWJsZWQoZCkgJiYgbG9nX2dsb2JhbCApDQo+ICAgICAgew0K
PiAgICAgICAgICAvKg0KPiAgICAgICAgICAgKiBSZWZ1c2UgdG8gdHVybiBvbiBnbG9iYWwgbG9n
LWRpcnR5IG1vZGUNCj4gZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni94ODZfNjQvbW0uYyBiL3hl
bi9hcmNoL3g4Ni94ODZfNjQvbW0uYw0KPiBpbmRleCA3OTVhNDY3NDYyLi5mYTU1ZjM0NzRlIDEw
MDY0NA0KPiAtLS0gYS94ZW4vYXJjaC94ODYveDg2XzY0L21tLmMNCj4gKysrIGIveGVuL2FyY2gv
eDg2L3g4Nl82NC9tbS5jDQo+IEBAIC0xNDM0LDcgKzE0MzQsNyBAQCBpbnQgbWVtb3J5X2FkZCh1
bnNpZ25lZCBsb25nIHNwZm4sIHVuc2lnbmVkIGxvbmcgZXBmbiwgdW5zaWduZWQgaW50IHB4bSkN
Cj4gICAgICAgKiBzaGFyZWQgb3IgYmVpbmcga2VwdCBpbiBzeW5jIHRoZW4gbmV3bHkgYWRkZWQg
bWVtb3J5IG5lZWRzIHRvIGJlDQo+ICAgICAgICogbWFwcGVkIGhlcmUuDQo+ICAgICAgICovDQo+
IC0gICAgaWYgKCBoYXNfaW9tbXVfcHQoaGFyZHdhcmVfZG9tYWluKSAmJg0KPiArICAgIGlmICgg
aXNfaW9tbXVfZW5hYmxlZChoYXJkd2FyZV9kb21haW4pICYmDQo+ICAgICAgICAgICAhaW9tbXVf
dXNlX2hhcF9wdChoYXJkd2FyZV9kb21haW4pICYmDQo+ICAgICAgICAgICAhbmVlZF9pb21tdV9w
dF9zeW5jKGhhcmR3YXJlX2RvbWFpbikgKQ0KPiAgICAgIHsNCj4gZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vbWVtb3J5LmMgYi94ZW4vY29tbW9uL21lbW9yeS5jDQo+IGluZGV4IGQ1YWZmODNmMmQu
LjczNjRmZDJjMzMgMTAwNjQ0DQo+IC0tLSBhL3hlbi9jb21tb24vbWVtb3J5LmMNCj4gKysrIGIv
eGVuL2NvbW1vbi9tZW1vcnkuYw0KPiBAQCAtODIzLDcgKzgyMyw3IEBAIGludCB4ZW5tZW1fYWRk
X3RvX3BoeXNtYXAoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHhlbl9hZGRfdG9fcGh5c21hcCAq
eGF0cCwNCj4gICAgICB4YXRwLT5ncGZuICs9IHN0YXJ0Ow0KPiAgICAgIHhhdHAtPnNpemUgLT0g
c3RhcnQ7DQo+IA0KPiAtICAgIGlmICggaGFzX2lvbW11X3B0KGQpICkNCj4gKyAgICBpZiAoIGlz
X2lvbW11X2VuYWJsZWQoZCkgKQ0KPiAgICAgICAgIHRoaXNfY3B1KGlvbW11X2RvbnRfZmx1c2hf
aW90bGIpID0gMTsNCj4gDQo+ICAgICAgd2hpbGUgKCB4YXRwLT5zaXplID4gZG9uZSApDQo+IEBA
IC04NDQsNyArODQ0LDcgQEAgaW50IHhlbm1lbV9hZGRfdG9fcGh5c21hcChzdHJ1Y3QgZG9tYWlu
ICpkLCBzdHJ1Y3QgeGVuX2FkZF90b19waHlzbWFwICp4YXRwLA0KPiAgICAgICAgICB9DQo+ICAg
ICAgfQ0KPiANCj4gLSAgICBpZiAoIGhhc19pb21tdV9wdChkKSApDQo+ICsgICAgaWYgKCBpc19p
b21tdV9lbmFibGVkKGQpICkNCj4gICAgICB7DQo+ICAgICAgICAgIGludCByZXQ7DQo+IA0KPiBk
aWZmIC0tZ2l0IGEveGVuL2NvbW1vbi92bV9ldmVudC5jIGIveGVuL2NvbW1vbi92bV9ldmVudC5j
DQo+IGluZGV4IDJhMWM4N2U0NGIuLjNiMTgxOTVlYmYgMTAwNjQ0DQo+IC0tLSBhL3hlbi9jb21t
b24vdm1fZXZlbnQuYw0KPiArKysgYi94ZW4vY29tbW9uL3ZtX2V2ZW50LmMNCj4gQEAgLTYzMCw3
ICs2MzAsNyBAQCBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4
ZW5fZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMpDQo+IA0KPiAgICAgICAgICAgICAgLyogTm8gcGFn
aW5nIGlmIGlvbW11IGlzIHVzZWQgKi8NCj4gICAgICAgICAgICAgIHJjID0gLUVNTElOSzsNCj4g
LSAgICAgICAgICAgIGlmICggdW5saWtlbHkoaGFzX2lvbW11X3B0KGQpKSApDQo+ICsgICAgICAg
ICAgICBpZiAoIHVubGlrZWx5KGlzX2lvbW11X2VuYWJsZWQoZCkpICkNCj4gICAgICAgICAgICAg
ICAgICBicmVhazsNCj4gDQo+ICAgICAgICAgICAgICByYyA9IC1FWERFVjsNCj4gZGlmZiAtLWdp
dCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVlLmMgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jDQo+IGluZGV4IDEyZjJjNGMzZjIuLmVhOWZkNTRlM2Ig
MTAwNjQ0DQo+IC0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVlLmMNCj4g
KysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvZGV2aWNlX3RyZWUuYw0KPiBAQCAtNDAsMTcg
KzQwLDYgQEAgaW50IGlvbW11X2Fzc2lnbl9kdF9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3Ry
dWN0IGR0X2RldmljZV9ub2RlICpkZXYpDQo+ICAgICAgaWYgKCAhbGlzdF9lbXB0eSgmZGV2LT5k
b21haW5fbGlzdCkgKQ0KPiAgICAgICAgICBnb3RvIGZhaWw7DQo+IA0KPiAtICAgIC8qDQo+IC0g
ICAgICogVGhlIGh3ZG9tIGlzIGZvcmNlZCB0byB1c2UgSU9NTVUgZm9yIHByb3RlY3RpbmcgYXNz
aWduZWQNCj4gLSAgICAgKiBkZXZpY2UuIFRoZXJlZm9yZSB0aGUgSU9NTVUgZGF0YSBpcyBhbHJl
YWR5IHNldCB1cC4NCj4gLSAgICAgKi8NCj4gLSAgICBBU1NFUlQoIWlzX2hhcmR3YXJlX2RvbWFp
bihkKSB8fA0KPiAtICAgICAgICAgICBoZC0+c3RhdHVzID09IElPTU1VX1NUQVRVU19pbml0aWFs
aXplZCk7DQo+IC0NCj4gLSAgICByYyA9IGlvbW11X2NvbnN0cnVjdChkKTsNCj4gLSAgICBpZiAo
IHJjICkNCj4gLSAgICAgICAgZ290byBmYWlsOw0KPiAtDQo+ICAgICAgLyogVGhlIGZsYWcgZmll
bGQgZG9lc24ndCBtYXR0ZXIgdG8gRFQgZGV2aWNlLiAqLw0KPiAgICAgIHJjID0gaGQtPnBsYXRm
b3JtX29wcy0+YXNzaWduX2RldmljZShkLCAwLCBkdF90b19kZXYoZGV2KSwgMCk7DQo+IA0KPiBk
aWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW9tbXUuYyBiL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2lvbW11LmMNCj4gaW5kZXggMTFlY2U0ZDFmMy4uNzFmMTdlN2VkYyAxMDA2
NDQNCj4gLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW9tbXUuYw0KPiArKysgYi94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9pb21tdS5jDQo+IEBAIC0xNTIsNiArMTUyLDE3IEBAIHN0YXRp
YyBpbnQgX19pbml0IHBhcnNlX2RvbTBfaW9tbXVfcGFyYW0oY29uc3QgY2hhciAqcykNCj4gIH0N
Cj4gIGN1c3RvbV9wYXJhbSgiZG9tMC1pb21tdSIsIHBhcnNlX2RvbTBfaW9tbXVfcGFyYW0pOw0K
PiANCj4gK3N0YXRpYyB2b2lkIF9faHdkb21faW5pdCBjaGVja19od2RvbV9yZXFzKHN0cnVjdCBk
b21haW4gKmQpDQo+ICt7DQo+ICsgICAgaWYgKCBpb21tdV9od2RvbV9ub25lIHx8ICFwYWdpbmdf
bW9kZV90cmFuc2xhdGUoZCkgKQ0KPiArICAgICAgICByZXR1cm47DQo+ICsNCj4gKyAgICBhcmNo
X2lvbW11X2NoZWNrX2F1dG90cmFuc2xhdGVkX2h3ZG9tKGQpOw0KPiArDQo+ICsgICAgaW9tbXVf
aHdkb21fcGFzc3Rocm91Z2ggPSBmYWxzZTsNCj4gKyAgICBpb21tdV9od2RvbV9zdHJpY3QgPSB0
cnVlOw0KPiArfQ0KPiArDQo+ICBpbnQgaW9tbXVfZG9tYWluX2luaXQoc3RydWN0IGRvbWFpbiAq
ZCkNCj4gIHsNCj4gICAgICBzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRvbV9pb21tdShkKTsN
Cj4gQEAgLTE2OSwxMjkgKzE4MCw0NCBAQCBpbnQgaW9tbXVfZG9tYWluX2luaXQoc3RydWN0IGRv
bWFpbiAqZCkNCj4gICAgICAgICAgcmV0dXJuIHJldDsNCj4gDQo+ICAgICAgaGQtPnBsYXRmb3Jt
X29wcyA9IGlvbW11X2dldF9vcHMoKTsNCj4gLSAgICByZXR1cm4gaGQtPnBsYXRmb3JtX29wcy0+
aW5pdChkKTsNCj4gLX0NCj4gKyAgICByZXQgPSBoZC0+cGxhdGZvcm1fb3BzLT5pbml0KGQpOw0K
PiArICAgIGlmICggcmV0ICkNCj4gKyAgICAgICAgcmV0dXJuIHJldDsNCj4gDQo+IC1zdGF0aWMg
dm9pZCBfX2h3ZG9tX2luaXQgY2hlY2tfaHdkb21fcmVxcyhzdHJ1Y3QgZG9tYWluICpkKQ0KPiAt
ew0KPiAtICAgIGlmICggaW9tbXVfaHdkb21fbm9uZSB8fCAhcGFnaW5nX21vZGVfdHJhbnNsYXRl
KGQpICkNCj4gLSAgICAgICAgcmV0dXJuOw0KPiArICAgIGlmICggaXNfaGFyZHdhcmVfZG9tYWlu
KGQpICkNCj4gKyAgICAgICAgY2hlY2tfaHdkb21fcmVxcyhkKTsgLyogbWF5IG1vZGlmeSBpb21t
dV9od2RvbV9zdHJpY3QgKi8NCj4gDQo+IC0gICAgYXJjaF9pb21tdV9jaGVja19hdXRvdHJhbnNs
YXRlZF9od2RvbShkKTsNCj4gKyAgICAvKg0KPiArICAgICAqIE5COiAncmVsYXhlZCcgaC93IGRv
bWFpbnMgZG9uJ3QgbmVlZCB0aGUgSU9NTVUgbWFwcGluZ3MgdG8gYmUga2VwdA0KPiArICAgICAq
ICAgICBpbi1zeW5jIHdpdGggdGhlaXIgYXNzaWduZWQgcGFnZXMgYmVjYXVzZSBhbGwgaG9zdCBS
QU0gd2lsbCBiZQ0KPiArICAgICAqICAgICBtYXBwZWQgZHVyaW5nIGh3ZG9tX2luaXQoKS4NCj4g
KyAgICAgKi8NCj4gKyAgICBpZiAoICFpc19oYXJkd2FyZV9kb21haW4oZCkgfHwgaW9tbXVfaHdk
b21fc3RyaWN0ICkNCj4gKyAgICAgICAgaGQtPm5lZWRfc3luYyA9ICFpb21tdV91c2VfaGFwX3B0
KGQpOw0KPiANCj4gLSAgICBpb21tdV9od2RvbV9wYXNzdGhyb3VnaCA9IGZhbHNlOw0KPiAtICAg
IGlvbW11X2h3ZG9tX3N0cmljdCA9IHRydWU7DQo+ICsgICAgcmV0dXJuIDA7DQo+ICB9DQo+IA0K
PiAgdm9pZCBfX2h3ZG9tX2luaXQgaW9tbXVfaHdkb21faW5pdChzdHJ1Y3QgZG9tYWluICpkKQ0K
PiAgew0KPiAgICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOw0KPiAN
Cj4gLSAgICBjaGVja19od2RvbV9yZXFzKGQpOw0KPiAtDQo+ICAgICAgaWYgKCAhaXNfaW9tbXVf
ZW5hYmxlZChkKSApDQo+ICAgICAgICAgIHJldHVybjsNCj4gDQo+ICAgICAgcmVnaXN0ZXJfa2V5
aGFuZGxlcignbycsICZpb21tdV9kdW1wX3AybV90YWJsZSwgImR1bXAgaW9tbXUgcDJtIHRhYmxl
IiwgMCk7DQo+IA0KPiAtICAgIGhkLT5zdGF0dXMgPSBJT01NVV9TVEFUVVNfaW5pdGlhbGl6aW5n
Ow0KPiAtICAgIC8qDQo+IC0gICAgICogTkI6IHJlbGF4ZWQgaHcgZG9tYWlucyBkb24ndCBuZWVk
IHN5bmMgYmVjYXVzZSBhbGwgcmFtIGlzIGFscmVhZHkNCj4gLSAgICAgKiBtYXBwZWQgaW4gdGhl
IGlvbW11IHBhZ2UgdGFibGVzLg0KPiAtICAgICAqLw0KPiAtICAgIGhkLT5uZWVkX3N5bmMgPSBp
b21tdV9od2RvbV9zdHJpY3QgJiYgIWlvbW11X3VzZV9oYXBfcHQoZCk7DQo+IC0gICAgaWYgKCBu
ZWVkX2lvbW11X3B0X3N5bmMoZCkgKQ0KPiAtICAgIHsNCj4gLSAgICAgICAgc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZTsNCj4gLSAgICAgICAgdW5zaWduZWQgaW50IGkgPSAwLCBmbHVzaF9mbGFncyA9
IDA7DQo+IC0gICAgICAgIGludCByYyA9IDA7DQo+IC0NCj4gLSAgICAgICAgcGFnZV9saXN0X2Zv
cl9lYWNoICggcGFnZSwgJmQtPnBhZ2VfbGlzdCApDQo+IC0gICAgICAgIHsNCj4gLSAgICAgICAg
ICAgIHVuc2lnbmVkIGxvbmcgbWZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOw0KPiAtICAg
ICAgICAgICAgdW5zaWduZWQgbG9uZyBkZm4gPSBtZm5fdG9fZ21mbihkLCBtZm4pOw0KPiAtICAg
ICAgICAgICAgdW5zaWduZWQgaW50IG1hcHBpbmcgPSBJT01NVUZfcmVhZGFibGU7DQo+IC0gICAg
ICAgICAgICBpbnQgcmV0Ow0KPiAtDQo+IC0gICAgICAgICAgICBpZiAoICgocGFnZS0+dS5pbnVz
ZS50eXBlX2luZm8gJiBQR1RfY291bnRfbWFzaykgPT0gMCkgfHwNCj4gLSAgICAgICAgICAgICAg
ICAgKChwYWdlLT51LmludXNlLnR5cGVfaW5mbyAmIFBHVF90eXBlX21hc2spDQo+IC0gICAgICAg
ICAgICAgICAgICA9PSBQR1Rfd3JpdGFibGVfcGFnZSkgKQ0KPiAtICAgICAgICAgICAgICAgIG1h
cHBpbmcgfD0gSU9NTVVGX3dyaXRhYmxlOw0KPiAtDQo+IC0gICAgICAgICAgICByZXQgPSBpb21t
dV9tYXAoZCwgX2RmbihkZm4pLCBfbWZuKG1mbiksIDAsIG1hcHBpbmcsDQo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJmZsdXNoX2ZsYWdzKTsNCj4gLQ0KPiAtICAgICAgICAgICAgaWYg
KCAhcmMgKQ0KPiAtICAgICAgICAgICAgICAgIHJjID0gcmV0Ow0KPiAtDQo+IC0gICAgICAgICAg
ICBpZiAoICEoaSsrICYgMHhmZmZmZikgKQ0KPiAtICAgICAgICAgICAgICAgIHByb2Nlc3NfcGVu
ZGluZ19zb2Z0aXJxcygpOw0KPiAtICAgICAgICB9DQo+IC0NCj4gLSAgICAgICAgLyogVXNlIHdo
aWxlLWJyZWFrIHRvIGF2b2lkIGNvbXBpbGVyIHdhcm5pbmcgKi8NCj4gLSAgICAgICAgd2hpbGUg
KCBpb21tdV9pb3RsYl9mbHVzaF9hbGwoZCwgZmx1c2hfZmxhZ3MpICkNCj4gLSAgICAgICAgICAg
IGJyZWFrOw0KPiAtDQo+IC0gICAgICAgIGlmICggcmMgKQ0KPiAtICAgICAgICAgICAgcHJpbnRr
KFhFTkxPR19XQVJOSU5HICJkJWQ6IElPTU1VIG1hcHBpbmcgZmFpbGVkOiAlZFxuIiwNCj4gLSAg
ICAgICAgICAgICAgICAgICBkLT5kb21haW5faWQsIHJjKTsNCj4gLSAgICB9DQo+IC0NCj4gICAg
ICBoZC0+cGxhdGZvcm1fb3BzLT5od2RvbV9pbml0KGQpOw0KPiAtDQo+IC0gICAgaGQtPnN0YXR1
cyA9IElPTU1VX1NUQVRVU19pbml0aWFsaXplZDsNCj4gIH0NCj4gDQo+IC12b2lkIGlvbW11X3Rl
YXJkb3duKHN0cnVjdCBkb21haW4gKmQpDQo+ICtzdGF0aWMgdm9pZCBpb21tdV90ZWFyZG93bihz
dHJ1Y3QgZG9tYWluICpkKQ0KPiAgew0KPiAgICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0g
ZG9tX2lvbW11KGQpOw0KPiANCj4gLSAgICBoZC0+c3RhdHVzID0gSU9NTVVfU1RBVFVTX2Rpc2Fi
bGVkOw0KPiAgICAgIGhkLT5wbGF0Zm9ybV9vcHMtPnRlYXJkb3duKGQpOw0KPiAgICAgIHRhc2ts
ZXRfc2NoZWR1bGUoJmlvbW11X3B0X2NsZWFudXBfdGFza2xldCk7DQo+ICB9DQo+IA0KPiAtaW50
IGlvbW11X2NvbnN0cnVjdChzdHJ1Y3QgZG9tYWluICpkKQ0KPiAtew0KPiAtICAgIHN0cnVjdCBk
b21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOw0KPiAtDQo+IC0gICAgaWYgKCBoZC0+c3Rh
dHVzID09IElPTU1VX1NUQVRVU19pbml0aWFsaXplZCApDQo+IC0gICAgICAgIHJldHVybiAwOw0K
PiAtDQo+IC0gICAgaGQtPnN0YXR1cyA9IElPTU1VX1NUQVRVU19pbml0aWFsaXppbmc7DQo+IC0N
Cj4gLSAgICBpZiAoICFpb21tdV91c2VfaGFwX3B0KGQpICkNCj4gLSAgICB7DQo+IC0gICAgICAg
IGludCByYzsNCj4gLQ0KPiAtICAgICAgICBoZC0+bmVlZF9zeW5jID0gdHJ1ZTsNCj4gLQ0KPiAt
ICAgICAgICByYyA9IGFyY2hfaW9tbXVfcG9wdWxhdGVfcGFnZV90YWJsZShkKTsNCj4gLSAgICAg
ICAgaWYgKCByYyApDQo+IC0gICAgICAgIHsNCj4gLSAgICAgICAgICAgIGlmICggcmMgIT0gLUVS
RVNUQVJUICkNCj4gLSAgICAgICAgICAgIHsNCj4gLSAgICAgICAgICAgICAgICBoZC0+bmVlZF9z
eW5jID0gZmFsc2U7DQo+IC0gICAgICAgICAgICAgICAgaGQtPnN0YXR1cyA9IElPTU1VX1NUQVRV
U19kaXNhYmxlZDsNCj4gLSAgICAgICAgICAgIH0NCj4gLQ0KPiAtICAgICAgICAgICAgcmV0dXJu
IHJjOw0KPiAtICAgICAgICB9DQo+IC0gICAgfQ0KPiAtDQo+IC0gICAgaGQtPnN0YXR1cyA9IElP
TU1VX1NUQVRVU19pbml0aWFsaXplZDsNCj4gLQ0KPiAtICAgIC8qDQo+IC0gICAgICogVGhlcmUg
bWF5IGJlIGRpcnR5IGNhY2hlIGxpbmVzIHdoZW4gYSBkZXZpY2UgaXMgYXNzaWduZWQNCj4gLSAg
ICAgKiBhbmQgYmVmb3JlIGhhc19pb21tdV9wdChkKSBiZWNvbWluZyB0cnVlLCB0aGlzIHdpbGwg
Y2F1c2UNCj4gLSAgICAgKiBtZW1vcnlfdHlwZV9jaGFuZ2VkIGxvc2UgZWZmZWN0IGlmIG1lbW9y
eSB0eXBlIGNoYW5nZXMuDQo+IC0gICAgICogQ2FsbCBtZW1vcnlfdHlwZV9jaGFuZ2VkIGhlcmUg
dG8gYW1lbmQgdGhpcy4NCj4gLSAgICAgKi8NCj4gLSAgICBtZW1vcnlfdHlwZV9jaGFuZ2VkKGQp
Ow0KPiAtDQo+IC0gICAgcmV0dXJuIDA7DQo+IC19DQo+IC0NCj4gIHZvaWQgaW9tbXVfZG9tYWlu
X2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCkNCj4gIHsNCj4gICAgICBpZiAoICFpc19pb21tdV9l
bmFibGVkKGQpICkNCj4gQEAgLTU4NywxMSArNTEzLDggQEAgaW50IGlvbW11X2RvX2RvbWN0bCgN
Cj4gIHZvaWQgaW9tbXVfc2hhcmVfcDJtX3RhYmxlKHN0cnVjdCBkb21haW4qIGQpDQo+ICB7DQo+
ICAgICAgQVNTRVJUKGhhcF9lbmFibGVkKGQpKTsNCj4gLSAgICAvKg0KPiAtICAgICAqIGlvbW11
X3VzZV9oYXBfcHQoZCkgY2Fubm90IGJlIHVzZWQgaGVyZSBiZWNhdXNlIGR1cmluZyBkb21haW4N
Cj4gLSAgICAgKiBjb25zdHJ1Y3Rpb24gaGFzX2lvbW11X3B0KGQpIHdpbGwgYWx3YXlzIHJldHVy
biBmYWxzZSBoZXJlLg0KPiAtICAgICAqLw0KPiAtICAgIGlmICggaXNfaW9tbXVfZW5hYmxlZChk
KSAmJiBpb21tdV9oYXBfcHRfc2hhcmUgKQ0KPiArDQo+ICsgICAgaWYgKCBpb21tdV91c2VfaGFw
X3B0KGQpICkNCj4gICAgICAgICAgaW9tbXVfZ2V0X29wcygpLT5zaGFyZV9wMm0oZCk7DQo+ICB9
DQo+IA0KPiBAQCAtNjM4LDggKzU2MSw3IEBAIHN0YXRpYyB2b2lkIGlvbW11X2R1bXBfcDJtX3Rh
YmxlKHVuc2lnbmVkIGNoYXIga2V5KQ0KPiAgICAgIG9wcyA9IGlvbW11X2dldF9vcHMoKTsNCj4g
ICAgICBmb3JfZWFjaF9kb21haW4oZCkNCj4gICAgICB7DQo+IC0gICAgICAgIGlmICggaXNfaGFy
ZHdhcmVfZG9tYWluKGQpIHx8DQo+IC0gICAgICAgICAgICAgZG9tX2lvbW11KGQpLT5zdGF0dXMg
PCBJT01NVV9TVEFUVVNfaW5pdGlhbGl6ZWQgKQ0KPiArICAgICAgICBpZiAoIGlzX2hhcmR3YXJl
X2RvbWFpbihkKSB8fCAhaXNfaW9tbXVfZW5hYmxlZChkKSApDQo+ICAgICAgICAgICAgICBjb250
aW51ZTsNCj4gDQo+ICAgICAgICAgIGlmICggaW9tbXVfdXNlX2hhcF9wdChkKSApDQo+IGRpZmYg
LS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL3BjaS5jDQo+IGluZGV4IGQyOGYxN2FmNzUuLjFmYWQwYWY1MzQgMTAwNjQ0DQo+IC0t
LSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jDQo+ICsrKyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3BjaS5jDQo+IEBAIC05MzksOSArOTM5LDYgQEAgc3RhdGljIGludCBkZWFzc2ln
bl9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgdWludDE2X3Qgc2VnLCB1aW50OF90IGJ1cywNCj4g
DQo+ICAgICAgcGRldi0+ZmF1bHQuY291bnQgPSAwOw0KPiANCj4gLSAgICBpZiAoICFoYXNfYXJj
aF9wZGV2cyhkKSAmJiBoYXNfaW9tbXVfcHQoZCkgKQ0KPiAtICAgICAgICBpb21tdV90ZWFyZG93
bihkKTsNCj4gLQ0KPiAgICAgIHJldHVybiByZXQ7DQo+ICB9DQo+IA0KPiBAQCAtMTQ5MCwxMyAr
MTQ4Nyw2IEBAIHN0YXRpYyBpbnQgYXNzaWduX2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCB1MTYg
c2VnLCB1OCBidXMsIHU4IGRldmZuLCB1MzIgZmxhZykNCj4gICAgICBpZiAoICFwY2lkZXZzX3Ry
eWxvY2soKSApDQo+ICAgICAgICAgIHJldHVybiAtRVJFU1RBUlQ7DQo+IA0KPiAtICAgIHJjID0g
aW9tbXVfY29uc3RydWN0KGQpOw0KPiAtICAgIGlmICggcmMgKQ0KPiAtICAgIHsNCj4gLSAgICAg
ICAgcGNpZGV2c191bmxvY2soKTsNCj4gLSAgICAgICAgcmV0dXJuIHJjOw0KPiAtICAgIH0NCj4g
LQ0KPiAgICAgIHBkZXYgPSBwY2lfZ2V0X3BkZXZfYnlfZG9tYWluKGhhcmR3YXJlX2RvbWFpbiwg
c2VnLCBidXMsIGRldmZuKTsNCj4gICAgICBpZiAoICFwZGV2ICkNCj4gICAgICB7DQo+IEBAIC0x
NTI1LDggKzE1MTUsNiBAQCBzdGF0aWMgaW50IGFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbiAq
ZCwgdTE2IHNlZywgdTggYnVzLCB1OCBkZXZmbiwgdTMyIGZsYWcpDQo+ICAgICAgfQ0KPiANCj4g
ICBkb25lOg0KPiAtICAgIGlmICggIWhhc19hcmNoX3BkZXZzKGQpICYmIGhhc19pb21tdV9wdChk
KSApDQo+IC0gICAgICAgIGlvbW11X3RlYXJkb3duKGQpOw0KPiAgICAgIHBjaWRldnNfdW5sb2Nr
KCk7DQo+IA0KPiAgICAgIHJldHVybiByYzsNCj4gZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3Z0ZC9pb21tdS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11
LmMNCj4gaW5kZXggZjEyMzc2MGVlMi4uM2MxN2YxMTM4NiAxMDA2NDQNCj4gLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMNCj4gKysrIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL2lvbW11LmMNCj4gQEAgLTE3MjEsMTUgKzE3MjEsNyBAQCBzdGF0aWMgdm9pZCBp
b21tdV9kb21haW5fdGVhcmRvd24oc3RydWN0IGRvbWFpbiAqZCkNCj4gDQo+ICAgICAgQVNTRVJU
KGlzX2lvbW11X2VuYWJsZWQoZCkpOw0KPiANCj4gLSAgICAvKg0KPiAtICAgICAqIFdlIGNhbid0
IHVzZSBpb21tdV91c2VfaGFwX3B0IGhlcmUgYmVjYXVzZSBlaXRoZXIgSU9NTVUgc3RhdGUNCj4g
LSAgICAgKiBpcyBhbHJlYWR5IGNoYW5nZWQgdG8gSU9NTVVfU1RBVFVTX2Rpc2FibGVkIGF0IHRo
aXMgcG9pbnQgb3INCj4gLSAgICAgKiBoYXMgYWx3YXlzIGJlZW4gSU9NTVVfU1RBVFVTX2Rpc2Fi
bGVkLg0KPiAtICAgICAqDQo+IC0gICAgICogV2UgYWxzbyBuZWVkIHRvIHRlc3QgaWYgSEFQIGlz
IGVuYWJsZWQgYmVjYXVzZSBQViBndWVzdHMgY2FuDQo+IC0gICAgICogZW50ZXIgdGhpcyBwYXRo
IHRvby4NCj4gLSAgICAgKi8NCj4gLSAgICBpZiAoIGhhcF9lbmFibGVkKGQpICYmIGlvbW11X2hh
cF9wdF9zaGFyZSApDQo+ICsgICAgaWYgKCBpb21tdV91c2VfaGFwX3B0KGQpICkNCj4gICAgICAg
ICAgcmV0dXJuOw0KPiANCj4gICAgICBzcGluX2xvY2soJmhkLT5hcmNoLm1hcHBpbmdfbG9jayk7
DQo+IGRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5jDQo+IGluZGV4IDgzMTlmZTBhNjkuLjQ3
YTNlNTUyMTMgMTAwNjQ0DQo+IC0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21t
dS5jDQo+ICsrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9pb21tdS5jDQo+IEBAIC04
MSwxMDMgKzgxLDYgQEAgaW50IF9faW5pdCBpb21tdV9zZXR1cF9ocGV0X21zaShzdHJ1Y3QgbXNp
X2Rlc2MgKm1zaSkNCj4gICAgICByZXR1cm4gb3BzLT5zZXR1cF9ocGV0X21zaSA/IG9wcy0+c2V0
dXBfaHBldF9tc2kobXNpKSA6IC1FTk9ERVY7DQo+ICB9DQo+IA0KPiAtaW50IGFyY2hfaW9tbXVf
cG9wdWxhdGVfcGFnZV90YWJsZShzdHJ1Y3QgZG9tYWluICpkKQ0KPiAtew0KPiAtICAgIHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2U7DQo+IC0gICAgaW50IHJjID0gMCwgbiA9IDA7DQo+IC0NCj4gLSAg
ICBzcGluX2xvY2soJmQtPnBhZ2VfYWxsb2NfbG9jayk7DQo+IC0NCj4gLSAgICBpZiAoIHVubGlr
ZWx5KGQtPmlzX2R5aW5nKSApDQo+IC0gICAgICAgIHJjID0gLUVTUkNIOw0KPiAtDQo+IC0gICAg
d2hpbGUgKCAhcmMgJiYgKHBhZ2UgPSBwYWdlX2xpc3RfcmVtb3ZlX2hlYWQoJmQtPnBhZ2VfbGlz
dCkpICkNCj4gLSAgICB7DQo+IC0gICAgICAgIGlmICggaXNfaHZtX2RvbWFpbihkKSB8fA0KPiAt
ICAgICAgICAgICAgKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvICYgUEdUX3R5cGVfbWFzaykgPT0g
UEdUX3dyaXRhYmxlX3BhZ2UgKQ0KPiAtICAgICAgICB7DQo+IC0gICAgICAgICAgICBtZm5fdCBt
Zm4gPSBwYWdlX3RvX21mbihwYWdlKTsNCj4gLSAgICAgICAgICAgIGdmbl90IGdmbiA9IG1mbl90
b19nZm4oZCwgbWZuKTsNCj4gLSAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbHVzaF9mbGFncyA9
IDA7DQo+IC0NCj4gLSAgICAgICAgICAgIGlmICggIWdmbl9lcShnZm4sIElOVkFMSURfR0ZOKSAp
DQo+IC0gICAgICAgICAgICB7DQo+IC0gICAgICAgICAgICAgICAgZGZuX3QgZGZuID0gX2Rmbihn
Zm5feChnZm4pKTsNCj4gLQ0KPiAtICAgICAgICAgICAgICAgIEFTU0VSVCghKGdmbl94KGdmbikg
Pj4gREVGQVVMVF9ET01BSU5fQUREUkVTU19XSURUSCkpOw0KPiAtICAgICAgICAgICAgICAgIEJV
R19PTihTSEFSRURfTTJQKGdmbl94KGdmbikpKTsNCj4gLSAgICAgICAgICAgICAgICByYyA9IGlv
bW11X21hcChkLCBkZm4sIG1mbiwgUEFHRV9PUkRFUl80SywNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVUZfcmVhZGFibGUgfCBJT01NVUZfd3JpdGFibGUsDQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJmZsdXNoX2ZsYWdzKTsNCj4gLQ0KPiAtICAgICAg
ICAgICAgICAgIC8qDQo+IC0gICAgICAgICAgICAgICAgICogV2UgbWF5IGJlIHdvcmtpbmcgYmVo
aW5kIHRoZSBiYWNrIG9mIGEgcnVubmluZyBndWVzdCwgd2hpY2gNCj4gLSAgICAgICAgICAgICAg
ICAgKiBtYXkgY2hhbmdlIHRoZSB0eXBlIG9mIGEgcGFnZSBhdCBhbnkgdGltZS4gIFdlIGNhbid0
IHByZXZlbnQNCj4gLSAgICAgICAgICAgICAgICAgKiB0aGlzIChmb3IgaW5zdGFuY2UsIGJ5IGJ1
bXBpbmcgdGhlIHR5cGUgY291bnQgd2hpbGUgbWFwcGluZw0KPiAtICAgICAgICAgICAgICAgICAq
IHRoZSBwYWdlKSB3aXRob3V0IGNhdXNpbmcgbGVnaXRpbWF0ZSBndWVzdCB0eXBlLWNoYW5nZQ0K
PiAtICAgICAgICAgICAgICAgICAqIG9wZXJhdGlvbnMgdG8gZmFpbC4gIFNvIGFmdGVyIGFkZGlu
ZyB0aGUgcGFnZSB0byB0aGUgSU9NTVUsDQo+IC0gICAgICAgICAgICAgICAgICogY2hlY2sgYWdh
aW4gdG8gbWFrZSBzdXJlIHRoaXMgaXMgc3RpbGwgdmFsaWQuICBOQiB0aGF0IHRoZQ0KPiAtICAg
ICAgICAgICAgICAgICAqIHdyaXRhYmxlIGVudHJ5IGluIHRoZSBpb21tdSBpcyBoYXJtbGVzcyB1
bnRpbCBsYXRlciwgd2hlbg0KPiAtICAgICAgICAgICAgICAgICAqIHRoZSBhY3R1YWwgZGV2aWNl
IGdldHMgYXNzaWduZWQuDQo+IC0gICAgICAgICAgICAgICAgICovDQo+IC0gICAgICAgICAgICAg
ICAgaWYgKCAhcmMgJiYgIWlzX2h2bV9kb21haW4oZCkgJiYNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICgocGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJiBQR1RfdHlwZV9tYXNrKSAhPQ0KPiAtICAg
ICAgICAgICAgICAgICAgICAgIFBHVF93cml0YWJsZV9wYWdlKSApDQo+IC0gICAgICAgICAgICAg
ICAgew0KPiAtICAgICAgICAgICAgICAgICAgICByYyA9IGlvbW11X3VubWFwKGQsIGRmbiwgUEFH
RV9PUkRFUl80SywgJmZsdXNoX2ZsYWdzKTsNCj4gLSAgICAgICAgICAgICAgICAgICAgLyogSWYg
dGhlIHR5cGUgY2hhbmdlZCB5ZXQgYWdhaW4sIHNpbXBseSBmb3JjZSBhIHJldHJ5LiAqLw0KPiAt
ICAgICAgICAgICAgICAgICAgICBpZiAoICFyYyAmJiAoKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZv
ICYgUEdUX3R5cGVfbWFzaykgPT0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFBHVF93cml0YWJsZV9wYWdlKSApDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICByYyA9IC1F
UkVTVEFSVDsNCj4gLSAgICAgICAgICAgICAgICB9DQo+IC0gICAgICAgICAgICB9DQo+IC0gICAg
ICAgICAgICBpZiAoIHJjICkNCj4gLSAgICAgICAgICAgIHsNCj4gLSAgICAgICAgICAgICAgICBw
YWdlX2xpc3RfYWRkKHBhZ2UsICZkLT5wYWdlX2xpc3QpOw0KPiAtICAgICAgICAgICAgICAgIGJy
ZWFrOw0KPiAtICAgICAgICAgICAgfQ0KPiAtICAgICAgICB9DQo+IC0gICAgICAgIHBhZ2VfbGlz
dF9hZGRfdGFpbChwYWdlLCAmZC0+YXJjaC5yZWxtZW1fbGlzdCk7DQo+IC0gICAgICAgIGlmICgg
ISgrK24gJiAweGZmKSAmJiAhcGFnZV9saXN0X2VtcHR5KCZkLT5wYWdlX2xpc3QpICYmDQo+IC0g
ICAgICAgICAgICAgaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApDQo+IC0gICAgICAgICAgICBy
YyA9IC1FUkVTVEFSVDsNCj4gLSAgICB9DQo+IC0NCj4gLSAgICBpZiAoICFyYyApDQo+IC0gICAg
ew0KPiAtICAgICAgICAvKg0KPiAtICAgICAgICAgKiBUaGUgZXhwZWN0YXRpb24gaGVyZSBpcyB0
aGF0IGdlbmVyYWxseSB0aGVyZSBhcmUgbWFueSBub3JtYWwgcGFnZXMNCj4gLSAgICAgICAgICog
b24gcmVsbWVtX2xpc3QgKHRoZSBvbmVzIHdlIHB1dCB0aGVyZSkgYW5kIG9ubHkgZmV3IGJlaW5n
IGluIGFuDQo+IC0gICAgICAgICAqIG9mZmxpbmUvYnJva2VuIHN0YXRlLiBUaGUgbGF0dGVyIG9u
ZXMgYXJlIGFsd2F5cyBhdCB0aGUgaGVhZCBvZiB0aGUNCj4gLSAgICAgICAgICogbGlzdC4gSGVu
Y2Ugd2UgZmlyc3QgbW92ZSB0aGUgd2hvbGUgbGlzdCwgYW5kIHRoZW4gbW92ZSBiYWNrIHRoZQ0K
PiAtICAgICAgICAgKiBmaXJzdCBmZXcgZW50cmllcy4NCj4gLSAgICAgICAgICovDQo+IC0gICAg
ICAgIHBhZ2VfbGlzdF9tb3ZlKCZkLT5wYWdlX2xpc3QsICZkLT5hcmNoLnJlbG1lbV9saXN0KTsN
Cj4gLSAgICAgICAgd2hpbGUgKCAhcGFnZV9saXN0X2VtcHR5KCZkLT5wYWdlX2xpc3QpICYmDQo+
IC0gICAgICAgICAgICAgICAgKHBhZ2UgPSBwYWdlX2xpc3RfZmlyc3QoJmQtPnBhZ2VfbGlzdCks
DQo+IC0gICAgICAgICAgICAgICAgIChwYWdlLT5jb3VudF9pbmZvICYgKFBHQ19zdGF0ZXxQR0Nf
YnJva2VuKSkpICkNCj4gLSAgICAgICAgew0KPiAtICAgICAgICAgICAgcGFnZV9saXN0X2RlbChw
YWdlLCAmZC0+cGFnZV9saXN0KTsNCj4gLSAgICAgICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChw
YWdlLCAmZC0+YXJjaC5yZWxtZW1fbGlzdCk7DQo+IC0gICAgICAgIH0NCj4gLSAgICB9DQo+IC0N
Cj4gLSAgICBzcGluX3VubG9jaygmZC0+cGFnZV9hbGxvY19sb2NrKTsNCj4gLQ0KPiAtICAgIGlm
ICggIXJjICkNCj4gLSAgICAgICAgLyoNCj4gLSAgICAgICAgICogZmx1c2hfZmxhZ3MgYXJlIG5v
dCB0cmFja2VkIGFjcm9zcyBoeXBlcmNhbGwgcHJlLWVtcHRpb24gc28NCj4gLSAgICAgICAgICog
YXNzdW1lIGEgZnVsbCBmbHVzaCBpcyBuZWNlc3NhcnkuDQo+IC0gICAgICAgICAqLw0KPiAtICAg
ICAgICByYyA9IGlvbW11X2lvdGxiX2ZsdXNoX2FsbCgNCj4gLSAgICAgICAgICAgIGQsIElPTU1V
X0ZMVVNIRl9hZGRlZCB8IElPTU1VX0ZMVVNIRl9tb2RpZmllZCk7DQo+IC0NCj4gLSAgICBpZiAo
IHJjICYmIHJjICE9IC1FUkVTVEFSVCApDQo+IC0gICAgICAgIGlvbW11X3RlYXJkb3duKGQpOw0K
PiAtDQo+IC0gICAgcmV0dXJuIHJjOw0KPiAtfQ0KPiAtDQo+ICB2b2lkIF9faHdkb21faW5pdCBh
cmNoX2lvbW11X2NoZWNrX2F1dG90cmFuc2xhdGVkX2h3ZG9tKHN0cnVjdCBkb21haW4gKmQpDQo+
ICB7DQo+ICAgICAgaWYgKCAhaXNfaW9tbXVfZW5hYmxlZChkKSApDQo+IGRpZmYgLS1naXQgYS94
ZW4vaW5jbHVkZS9hc20tYXJtL2lvbW11LmggYi94ZW4vaW5jbHVkZS9hc20tYXJtL2lvbW11LmgN
Cj4gaW5kZXggOTA0YzlhZWMxMS4uMTU3N2U4M2QyYiAxMDA2NDQNCj4gLS0tIGEveGVuL2luY2x1
ZGUvYXNtLWFybS9pb21tdS5oDQo+ICsrKyBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vaW9tbXUuaA0K
PiBAQCAtMjEsNyArMjEsNyBAQCBzdHJ1Y3QgYXJjaF9pb21tdQ0KPiAgfTsNCj4gDQo+ICAvKiBB
bHdheXMgc2hhcmUgUDJNIFRhYmxlIGJldHdlZW4gdGhlIENQVSBhbmQgdGhlIElPTU1VICovDQo+
IC0jZGVmaW5lIGlvbW11X3VzZV9oYXBfcHQoZCkgKGhhc19pb21tdV9wdChkKSkNCj4gKyNkZWZp
bmUgaW9tbXVfdXNlX2hhcF9wdChkKSBpc19pb21tdV9lbmFibGVkKGQpDQo+IA0KPiAgY29uc3Qg
c3RydWN0IGlvbW11X29wcyAqaW9tbXVfZ2V0X29wcyh2b2lkKTsNCj4gIHZvaWQgaW9tbXVfc2V0
X29wcyhjb25zdCBzdHJ1Y3QgaW9tbXVfb3BzICpvcHMpOw0KPiBkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9pb21tdS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9pb21tdS5oDQo+IGlu
ZGV4IDMxZmRhNGIwY2YuLjUwNzFhZmQ2YTUgMTAwNjQ0DQo+IC0tLSBhL3hlbi9pbmNsdWRlL2Fz
bS14ODYvaW9tbXUuaA0KPiArKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11LmgNCj4gQEAg
LTg4LDcgKzg4LDcgQEAgZXh0ZXJuIGNvbnN0IHN0cnVjdCBpb21tdV9pbml0X29wcyAqaW9tbXVf
aW5pdF9vcHM7DQo+IA0KPiAgLyogQXJlIHdlIHVzaW5nIHRoZSBkb21haW4gUDJNIHRhYmxlIGFz
IGl0cyBJT01NVSBwYWdldGFibGU/ICovDQo+ICAjZGVmaW5lIGlvbW11X3VzZV9oYXBfcHQoZCkg
XA0KPiAtICAgIChoYXBfZW5hYmxlZChkKSAmJiBoYXNfaW9tbXVfcHQoZCkgJiYgaW9tbXVfaGFw
X3B0X3NoYXJlKQ0KPiArICAgIChoYXBfZW5hYmxlZChkKSAmJiBpc19pb21tdV9lbmFibGVkKGQp
ICYmIGlvbW11X2hhcF9wdF9zaGFyZSkNCj4gDQo+ICB2b2lkIGlvbW11X3VwZGF0ZV9pcmVfZnJv
bV9hcGljKHVuc2lnbmVkIGludCBhcGljLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBpbnQg
dmFsdWUpOw0KPiAgdW5zaWduZWQgaW50IGlvbW11X3JlYWRfYXBpY19mcm9tX2lyZSh1bnNpZ25l
ZCBpbnQgYXBpYywgdW5zaWduZWQgaW50IHJlZyk7DQo+IGRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS94ZW4vaW9tbXUuaCBiL3hlbi9pbmNsdWRlL3hlbi9pb21tdS5oDQo+IGluZGV4IGM1ZWQ3ZWZl
OTguLmRmZWMwY2EzZmMgMTAwNjQ0DQo+IC0tLSBhL3hlbi9pbmNsdWRlL3hlbi9pb21tdS5oDQo+
ICsrKyBiL3hlbi9pbmNsdWRlL3hlbi9pb21tdS5oDQo+IEBAIC04OCwxNSArODgsOSBAQCB2b2lk
IGlvbW11X2RvbWFpbl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQpOw0KPiANCj4gIHZvaWQgYXJj
aF9pb21tdV9kb21haW5fZGVzdHJveShzdHJ1Y3QgZG9tYWluICpkKTsNCj4gIGludCBhcmNoX2lv
bW11X2RvbWFpbl9pbml0KHN0cnVjdCBkb21haW4gKmQpOw0KPiAtaW50IGFyY2hfaW9tbXVfcG9w
dWxhdGVfcGFnZV90YWJsZShzdHJ1Y3QgZG9tYWluICpkKTsNCj4gIHZvaWQgYXJjaF9pb21tdV9j
aGVja19hdXRvdHJhbnNsYXRlZF9od2RvbShzdHJ1Y3QgZG9tYWluICpkKTsNCj4gIHZvaWQgYXJj
aF9pb21tdV9od2RvbV9pbml0KHN0cnVjdCBkb21haW4gKmQpOw0KPiANCj4gLWludCBpb21tdV9j
b25zdHJ1Y3Qoc3RydWN0IGRvbWFpbiAqZCk7DQo+IC0NCj4gLS8qIEZ1bmN0aW9uIHVzZWQgaW50
ZXJuYWxseSwgdXNlIGlvbW11X2RvbWFpbl9kZXN0cm95ICovDQo+IC12b2lkIGlvbW11X3RlYXJk
b3duKHN0cnVjdCBkb21haW4gKmQpOw0KPiAtDQo+ICAvKg0KPiAgICogVGhlIGZvbGxvd2luZyBm
bGFncyBhcmUgcGFzc2VkIHRvIG1hcCBvcGVyYXRpb25zIGFuZCBwYXNzZWQgYnkgbG9va3VwDQo+
ICAgKiBvcGVyYXRpb25zLg0KPiBAQCAtMjYzLDEzICsyNTcsNiBAQCBzdHJ1Y3QgaW9tbXVfb3Bz
IHsNCj4gICMgZGVmaW5lIGlvbW11X3ZjYWxsIGlvbW11X2NhbGwNCj4gICNlbmRpZg0KPiANCj4g
LWVudW0gaW9tbXVfc3RhdHVzDQo+IC17DQo+IC0gICAgSU9NTVVfU1RBVFVTX2Rpc2FibGVkLA0K
PiAtICAgIElPTU1VX1NUQVRVU19pbml0aWFsaXppbmcsDQo+IC0gICAgSU9NTVVfU1RBVFVTX2lu
aXRpYWxpemVkDQo+IC19Ow0KPiAtDQo+ICBzdHJ1Y3QgZG9tYWluX2lvbW11IHsNCj4gICAgICBz
dHJ1Y3QgYXJjaF9pb21tdSBhcmNoOw0KPiANCj4gQEAgLTI4OSw5ICsyNzYsNiBAQCBzdHJ1Y3Qg
ZG9tYWluX2lvbW11IHsNCj4gICAgICAvKiBGZWF0dXJlcyBzdXBwb3J0ZWQgYnkgdGhlIElPTU1V
ICovDQo+ICAgICAgREVDTEFSRV9CSVRNQVAoZmVhdHVyZXMsIElPTU1VX0ZFQVRfY291bnQpOw0K
PiANCj4gLSAgICAvKiBTdGF0dXMgb2YgZ3Vlc3QgSU9NTVUgbWFwcGluZ3MgKi8NCj4gLSAgICBl
bnVtIGlvbW11X3N0YXR1cyBzdGF0dXM7DQo+IC0NCj4gICAgICAvKg0KPiAgICAgICAqIERvZXMg
dGhlIGd1ZXN0IHJlcWlyZSBtYXBwaW5ncyB0byBiZSBzeW5jaG9uaXplZCwgdG8gbWFpbnRhaW4N
Cj4gICAgICAgKiB0aGUgZGVmYXVsdCBkZm4gPT0gcGZuIG1hcC4gKFNlZSBjb21tZW50IG9uIGRm
biBhdCB0aGUgdG9wIG9mDQo+IGRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCBi
L3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oDQo+IGluZGV4IDJkMTdjODQ5MTUuLmFlMWZhZjcwZDMg
MTAwNjQ0DQo+IC0tLSBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oDQo+ICsrKyBiL3hlbi9pbmNs
dWRlL3hlbi9zY2hlZC5oDQo+IEBAIC05NjYsMTAgKzk2Niw4IEBAIHN0YXRpYyBpbmxpbmUgYm9v
bCBpc19od2RvbV9waW5uZWRfdmNwdShjb25zdCBzdHJ1Y3QgdmNwdSAqdikNCj4gIH0NCj4gDQo+
ICAjaWZkZWYgQ09ORklHX0hBU19QQVNTVEhST1VHSA0KPiAtI2RlZmluZSBoYXNfaW9tbXVfcHQo
ZCkgKGRvbV9pb21tdShkKS0+c3RhdHVzICE9IElPTU1VX1NUQVRVU19kaXNhYmxlZCkNCj4gICNk
ZWZpbmUgbmVlZF9pb21tdV9wdF9zeW5jKGQpIChkb21faW9tbXUoZCktPm5lZWRfc3luYykNCj4g
ICNlbHNlDQo+IC0jZGVmaW5lIGhhc19pb21tdV9wdChkKSBmYWxzZQ0KPiAgI2RlZmluZSBuZWVk
X2lvbW11X3B0X3N5bmMoZCkgZmFsc2UNCj4gICNlbmRpZg0KPiANCj4gLS0NCj4gMi4yMC4xLjIu
Z2IyMWViYjY3MQ0KDQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9y
ZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

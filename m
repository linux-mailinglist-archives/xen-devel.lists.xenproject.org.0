Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 0331A293A95
	for <lists+xen-devel@lfdr.de>; Tue, 20 Oct 2020 14:01:38 +0200 (CEST)
Received: from list by lists.xenproject.org with outflank-mailman.9132.24637 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1kUqKM-0006tM-CI; Tue, 20 Oct 2020 12:01:18 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 9132.24637; Tue, 20 Oct 2020 12:01:18 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1kUqKM-0006rz-2z; Tue, 20 Oct 2020 12:01:18 +0000
Received: by outflank-mailman (input) for mailman id 9132;
 Tue, 20 Oct 2020 12:01:15 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=8aR8=D3=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1kUqKJ-0006DX-KL
 for xen-devel@lists.xen.org; Tue, 20 Oct 2020 12:01:15 +0000
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 606dbaa2-065d-4b85-8699-989412608bdc;
 Tue, 20 Oct 2020 12:00:51 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1kUqJo-0001KQ-1l; Tue, 20 Oct 2020 12:00:44 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1kUqJo-00021v-0d; Tue, 20 Oct 2020 12:00:44 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <SRS0=8aR8=D3=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
	id 1kUqKJ-0006DX-KL
	for xen-devel@lists.xen.org; Tue, 20 Oct 2020 12:01:15 +0000
X-Inumbo-ID: 606dbaa2-065d-4b85-8699-989412608bdc
Received: from mail.xenproject.org (unknown [104.130.215.37])
	by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
	id 606dbaa2-065d-4b85-8699-989412608bdc;
	Tue, 20 Oct 2020 12:00:51 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=uHlIz/z4uRF9R68bRtWybynZpCQOwe0wXxuZRBPwdKc=; b=64AmIrQTuhYHXQOeXzNZQAY2vr
	z/RhTTXQnVOqsnfb6VlDMm6K0uN3Grhr9/IMzbU5SRjTjKTQixbpjNWHQm/gr0Kb4LVAex4RTk3mk
	/acwcS0JANeTIgfxP0a3ebGq8SvoEWpQoqxibfX2ElfJtr5VnNoCrKqMGb9uzj/Hyd7A=;
Received: from xenbits.xenproject.org ([104.239.192.120])
	by mail.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <iwj@xenbits.xen.org>)
	id 1kUqJo-0001KQ-1l; Tue, 20 Oct 2020 12:00:44 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
	(envelope-from <iwj@xenbits.xen.org>)
	id 1kUqJo-00021v-0d; Tue, 20 Oct 2020 12:00:44 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 345 v3 - x86: Race condition in Xen mapping
 code
Message-Id: <E1kUqJo-00021v-0d@xenbits.xenproject.org>
Date: Tue, 20 Oct 2020 12:00:44 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

                    Xen Security Advisory XSA-345
                              version 3

                x86: Race condition in Xen mapping code

UPDATES IN VERSION 3
====================

Public release.

ISSUE DESCRIPTION
=================

The Xen code handling the updating of the hypervisor's own pagetables
tries to use 2MiB and 1GiB superpages as much as possible to maximize
TLB efficiency.  Some of the operations for checking and coalescing
superpages take non-negligible amount of time; to avoid potential lock
contention, this code also tries to avoid holding locks for the entire
operation.

Unfortunately, several potential race conditions were not considered;
precisely-timed guest actions could potentially lead to the code
writing to a page which has been freed (and thus potentially already
reused).

IMPACT
======

A malicious guest can cause a host denial-of-service.  Data corruption
or privilege escalation cannot be ruled out.

VULNERABLE SYSTEMS
==================

Versions of Xen from at least 3.2 onward are affected.

Only x86 systems are vulnerable.  ARM systems are not vulnerable.

Guests can only exercise the vulnerability if they have passed through
hardware devices.  Guests without passthrough configured cannot
exploit the vulnerability.

Furthermore, HVM and PVH guests can only exercise the vulnerability if
they are running in shadow mode, and only when running on VT-x capable
hardware (as opposed to SVM).  This is believed to be Intel, Centaur
and Shanghai CPUs.

MITIGATION
==========

Running all guests in HVM or PVH mode, in each case with HAP enabled,
prevent those guests from exploiting the vulnerability.

CREDITS
=======

This issue was discovered by Hongyan Xia of Amazon.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa345/*.patch           xen-unstable
xsa345-4.14/*.patch      Xen 4.14.x
xsa345-4.13/*.patch      Xen 4.12.x, Xen 4.13.x
xsa345-4.11/*.patch      Xen 4.11.x
xsa345-4.10/*.patch      Xen 4.10.x

$ sha256sum xsa345* xsa345*/*
c8b9445b05aa4c585d9817c2e6cbf08466452a15381ca5b9a0224a377522edf9  xsa345.meta
4ed69dce620449bedda29f3ce1ed767908d2bbeb888701e7c4c2461216b724f7  xsa345-4.10/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch
98d3b171b197c1ff9f26ff70499a0cde3b23d048d622b12bf2ea0899de4f9e7f  xsa345-4.10/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch
78c4be2f1747051d13869001180ee25bdeabe5e8138d0604a33db610b24e38f1  xsa345-4.10/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch
4abd8271a70593fcde683071fdf0ac342ff9b0859b60c9790b14dd7e5ae85129  xsa345-4.11/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch
3209195c1a7e8a6186b704d6bb791a3fb3c251d59e15b42bcb0ecc0d38f13a4f  xsa345-4.11/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch
7e73f6c14718a0d4b25b4453b45c20bf265bd54c91b77678815be1ef7beae61f  xsa345-4.11/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch
b68b82911c96feee9d05abcddf174c2f6b278829bc8c3bf3062739de8c4704b2  xsa345-4.12/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch
fe2a1568a3e273ae01b3984c193e75aea16da53c6c9db27d21a2196d0f204c6e  xsa345-4.12/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch
22c98f4a264bc6b15ed29da8698a733947849c16a3e9da58de88bf16986b6aad  xsa345-4.12/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch
16299d885c19e1cd378a856caf8c1d1365c341bea648c0a0d5f24ae7d56015ae  xsa345-4.13/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch
b820061c242c7fa4da44cbb44fa16e0d0542c16815a89699385da0c87321f7ea  xsa345-4.13/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch
8a87ac2478c9bda6ef28c480b256448d51393a5e04f6e8a68ea29d9aeba92e47  xsa345-4.13/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch
acf093741fecccccce0018d4a5c0f5dba367373dd1d6d04ed76ff3f178579670  xsa345-4.14/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch
616f2547b4bb6d5eb9f853b1659e6e2a1fc0f67866665f4f6cdd8d763effcdfc  xsa345-4.14/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch
17ae72d2af6759da17ce777e0fc9eef8f8eb6be3fe6d5b38b3589f641fc0f918  xsa345-4.14/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch
65c56cb4d34ff4e97220311b303c09b54bfa44bcf4adc8e81d4a50c50eeb6b95  xsa345/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch
5512bd167c29ba7da06b2ace1397fc43ed33a362174ea927d6ca3f9bdd31748b  xsa345/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch
392524c9b0a01618e6c86a39dc1c68288065300b49548e29e9e6672947858060  xsa345/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl+OzqoMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZLt4H/2hHMHfpQsPiWUXQj6/SXmjZrnIuBsBeP6Hno3p+
aKVzdFJkdBHN6thRlIgir1tffawxbzrFG4ARN3A4mBfdEJYFMLo79v6dn1FtCdzw
OFdI95/sZ+zeOR8InfjedX67S0fNzVW4QkU2dpS5pwupdn+wg+Z4313FIyV7Oteo
sbN8dCeCn9t2mDBXa6D9Tyhc5iTfPBU09AZWh29wjnjGH4nOgarDwHX4x7VzZLyY
CB18RZ/Ezwud3thlsZdLWfzGOvpRDMKFq2pYwBHd3Dc7cSOLRGf6x8FLAHVc7XzR
a5cLY0oYOppJa++a/yyG8pKs7O410943SZ7292mDv0hwjnw=
=pVu8
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa345.meta"
Content-Disposition: attachment; filename="xsa345.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAzNDUsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xNCIsCiAgICAiNC4xMyIsCiAgICAiNC4xMiIs
CiAgICAiNC4xMSIsCiAgICAiNC4xMCIKICBdLAogICJUcmVlcyI6IFsKICAg
ICJ4ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICIxNzE5Zjc5YTBlZmQzNmQxNTgzN2M1MTk4MjE3M2RkMWMy
ODdkY2VkIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAy
ODYKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTM0NS00LjEwLyoucGF0Y2giCiAgICAgICAgICBdCiAgICAg
ICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTEiOiB7CiAgICAgICJSZWNp
cGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAiU3RhYmxlUmVm
IjogIjM2MzBhMzY3ODU0Yzk4YmJmOGU3NDdkMDllZWFiN2U2OGYzNzAwMDMi
LAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAgIDI4NgogICAg
ICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAi
eHNhMzQ1LTQuMTEvKi5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAg
ICAgIH0KICAgIH0sCiAgICAiNC4xMiI6IHsKICAgICAgIlJlY2lwZXMiOiB7
CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYiOiAiNjg4
ODAxNzM5MmFjMjViNWU1ODg1NTQwMzA2NDJhZmZhYzI1YTk1ZCIsCiAgICAg
ICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjg2CiAgICAgICAgICBd
LAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EzNDUt
NC4xMy8qLnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQog
ICAgfSwKICAgICI0LjEzIjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAg
ICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICI4ZTdlNTg1N2Ey
MDNjOWQ5ZGY3NzMzZmQ2ODc2ODU1NWM3ZTc2ODM5IiwKICAgICAgICAgICJQ
cmVyZXFzIjogWwogICAgICAgICAgICAyODYKICAgICAgICAgIF0sCiAgICAg
ICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTM0NS00LjEzLyou
cGF0Y2giCiAgICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAog
ICAgIjQuMTQiOiB7CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4i
OiB7CiAgICAgICAgICAiU3RhYmxlUmVmIjogImM5M2I1MjBhNDFmMjc4N2Rk
NzZiZmIyZTQ1NDgzNmQxZDU3ODc1MDUiLAogICAgICAgICAgIlByZXJlcXMi
OiBbCiAgICAgICAgICAgIDI4NgogICAgICAgICAgXSwKICAgICAgICAgICJQ
YXRjaGVzIjogWwogICAgICAgICAgICAieHNhMzQ1LTQuMTQvKi5wYXRjaCIK
ICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAibWFz
dGVyIjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewog
ICAgICAgICAgIlN0YWJsZVJlZiI6ICI1OWIyN2YzNjBlM2Q5ZGMwMzc4YzEy
ODhlNjdhOTFmYTQxYTc3MTU4IiwKICAgICAgICAgICJQcmVyZXFzIjogWwog
ICAgICAgICAgICAyODYKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hl
cyI6IFsKICAgICAgICAgICAgInhzYTM0NS8qLnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.10/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Disposition: attachment;
 filename="xsa345-4.10/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Transfer-Encoding: base64

RnJvbSAzZWNkZmY0OGMyZTdmMDY0MDA2NWRmNDgzNjFhNTI2NTExNjVjZmRh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQxICswMDAwClN1YmplY3Q6IFtQQVRDSCAxLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbWFwX3BhZ2VzX3RvX3hlbiB0byBoYXZlIG9ubHkgYSBzaW5nbGUKIGV4
aXQgcGF0aAoKV2Ugd2lsbCBzb29uIG5lZWQgdG8gcGVyZm9ybSBjbGVhbi11
cHMgYmVmb3JlIHJldHVybmluZy4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zNDUuCgpSZXBvcnRlZC1ieTogSG9uZ3lh
biBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IFdl
aSBMaXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhv
bmd5YW4gWGlhIDxob25neXhpYUBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkFj
a2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgfCAxNyArKysrKysrKysrKy0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDExIGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94
ODYvbW0uYwppbmRleCBmZDczNGZmOTQ3Li5mNmRmMGE0MWYxIDEwMDY0NAot
LS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0u
YwpAQCAtNTExMiw2ICs1MTEyLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgbDJfcGdlbnRyeV90ICpwbDJlLCBvbDJlOwogICAgIGwxX3BnZW50
cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CisgICAg
aW50IHJjID0gLUVOT01FTTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhvbGRm
KSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50IG9f
ID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUxMzIsNyArNTEz
Myw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICBsM19wZ2Vu
dHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7CiAK
ICAgICAgICAgaWYgKCAhcGwzZSApCi0gICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgIG9sM2Ug
PSAqcGwzZTsKIAogICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpA
QCAtNTIxOCw3ICs1MjIwLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAK
ICAgICAgICAgICAgIHBsMmUgPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAg
ICAgICAgICAgICBpZiAoIHBsMmUgPT0gTlVMTCApCi0gICAgICAgICAgICAg
ICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAgZ290byBvdXQ7
CiAKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDJfUEFHRVRBQkxF
X0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgbDJlX3dyaXRlKHBs
MmUgKyBpLApAQCAtNTI0Nyw3ICs1MjQ5LDcgQEAgaW50IG1hcF9wYWdlc190
b194ZW4oCiAKICAgICAgICAgcGwyZSA9IHZpcnRfdG9feGVuX2wyZSh2aXJ0
KTsKICAgICAgICAgaWYgKCAhcGwyZSApCi0gICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OwogCiAgICAgICAgIGlm
ICggKCgoKHZpcnQgPj4gUEFHRV9TSElGVCkgfCBtZm4pICYKICAgICAgICAg
ICAgICAgICgoMXUgPDwgUEFHRVRBQkxFX09SREVSKSAtIDEpKSA9PSAwKSAm
JgpAQCAtNTI4OSw3ICs1MjkxLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcGwxZSA9IHZpcnRf
dG9feGVuX2wxZSh2aXJ0KTsKICAgICAgICAgICAgICAgICBpZiAoIHBsMWUg
PT0gTlVMTCApCi0gICAgICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVN
OworICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgICAg
IH0KICAgICAgICAgICAgIGVsc2UgaWYgKCBsMmVfZ2V0X2ZsYWdzKCpwbDJl
KSAmIF9QQUdFX1BTRSApCiAgICAgICAgICAgICB7CkBAIC01MzE1LDcgKzUz
MTcsNyBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKIAogICAgICAgICAgICAg
ICAgIHBsMWUgPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAgICAg
ICAgICAgaWYgKCBwbDFlID09IE5VTEwgKQotICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVOT01FTTsKKyAgICAgICAgICAgICAgICAgICAgZ290byBv
dXQ7CiAKICAgICAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwxX1BB
R0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgICAgICBs
MWVfd3JpdGUoJnBsMWVbaV0sCkBAIC01NDU4LDcgKzU0NjAsMTAgQEAgaW50
IG1hcF9wYWdlc190b194ZW4oCiAKICN1bmRlZiBmbHVzaF9mbGFncwogCi0g
ICAgcmV0dXJuIDA7CisgICAgcmMgPSAwOworCisgb3V0OgorICAgIHJldHVy
biByYzsKIH0KIAogaW50IHBvcHVsYXRlX3B0X3JhbmdlKHVuc2lnbmVkIGxv
bmcgdmlydCwgdW5zaWduZWQgbG9uZyBtZm4sCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.10/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Disposition: attachment;
 filename="xsa345-4.10/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Transfer-Encoding: base64

RnJvbSAyYWU0ODkxZjNhNDQyOGE2ODljOWEyMGUwOGFlYmQ2NjJjMGRjZjk3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQyICswMDAwClN1YmplY3Q6IFtQQVRDSCAyLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbW9kaWZ5X3hlbl9tYXBwaW5ncyB0byBoYXZlIG9uZSBleGl0CiBwYXRo
CgpXZSB3aWxsIHNvb24gbmVlZCB0byBwZXJmb3JtIGNsZWFuLXVwcyBiZWZv
cmUgcmV0dXJuaW5nLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5OiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8
d2VpLmxpdTJAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSG9uZ3lhbiBY
aWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJj
aC94ODYvbW0uYyB8IDEyICsrKysrKysrKy0tLQogMSBmaWxlIGNoYW5nZWQs
IDkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4
IGY2ZGYwYTQxZjEuLmU2NDQ2ODVjYWIgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC01NDkxLDYg
KzU0OTEsNyBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBs
b25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAg
IGwxX3BnZW50cnlfdCAqcGwxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CiAg
ICAgdW5zaWduZWQgbG9uZyB2ID0gczsKKyAgICBpbnQgcmMgPSAtRU5PTUVN
OwogCiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBi
ZSBhbHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxf
UEFHRV9SV3xfUEFHRV9QUkVTRU5UKQpAQCAtNTUzMiw3ICs1NTMzLDggQEAg
aW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNp
Z25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAgIC8q
IFBBR0UxR0I6IHNoYXR0ZXIgdGhlIHN1cGVycGFnZSBhbmQgZmFsbCB0aHJv
dWdoLiAqLwogICAgICAgICAgICAgcGwyZSA9IGFsbG9jX3hlbl9wYWdldGFi
bGUoKTsKICAgICAgICAgICAgIGlmICggIXBsMmUgKQotICAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAgICAgIGdvdG8gb3V0
OworCiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VUQUJM
RV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgIGwyZV93cml0ZShw
bDJlICsgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgbDJlX2Zyb21f
cGZuKGwzZV9nZXRfcGZuKCpwbDNlKSArCkBAIC01NTg3LDcgKzU1ODksOCBA
QCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVu
c2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgICAgICAgICAg
ICAgIC8qIFBTRTogc2hhdHRlciB0aGUgc3VwZXJwYWdlIGFuZCB0cnkgYWdh
aW4uICovCiAgICAgICAgICAgICAgICAgcGwxZSA9IGFsbG9jX3hlbl9wYWdl
dGFibGUoKTsKICAgICAgICAgICAgICAgICBpZiAoICFwbDFlICkKLSAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAg
ICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgICAgICAgICAgZm9yICggaSA9
IDA7IGkgPCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAg
ICAgICAgICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbDFlX2Zyb21fcGZuKGwyZV9nZXRfcGZuKCpw
bDJlKSArIGksCkBAIC01NzE2LDcgKzU3MTksMTAgQEAgaW50IG1vZGlmeV94
ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUs
IHVuc2lnbmVkIGludCBuZikKICAgICBmbHVzaF9hcmVhKE5VTEwsIEZMVVNI
X1RMQl9HTE9CQUwpOwogCiAjdW5kZWYgRkxBR1NfTUFTSwotICAgIHJldHVy
biAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAgICByZXR1cm4gcmM7CiB9
CiAKICN1bmRlZiBmbHVzaF9hcmVhCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.10/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Disposition: attachment;
 filename="xsa345-4.10/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Transfer-Encoding: base64

RnJvbSAyNDE4MWY3NjM1YzEwNmY4NzE5YjBlYmE1YWFjMTBjZjc0N2E0Y2Vj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KRGF0ZTogU2F0LCAxMSBKYW4gMjAyMCAy
MTo1Nzo0MyArMDAwMApTdWJqZWN0OiBbUEFUQ0ggMy8zXSB4ODYvbW06IFBy
ZXZlbnQgc29tZSByYWNlcyBpbiBoeXBlcnZpc29yIG1hcHBpbmcgdXBkYXRl
cwoKbWFwX3BhZ2VzX3RvX3hlbiB3aWxsIGF0dGVtcHQgdG8gY29hbGVzY2Ug
bWFwcGluZ3MgaW50byAyTWlCIGFuZCAxR2lCCnN1cGVycGFnZXMgaWYgcG9z
c2libGUsIHRvIG1heGltaXplIFRMQiBlZmZpY2llbmN5LiAgVGhpcyBtZWFu
cyBib3RoCnJlcGxhY2luZyBzdXBlcnBhZ2UgZW50cmllcyB3aXRoIHNtYWxs
ZXIgZW50cmllcywgYW5kIHJlcGxhY2luZwpzbWFsbGVyIGVudHJpZXMgd2l0
aCBzdXBlcnBhZ2VzLgoKVW5mb3J0dW5hdGVseSwgd2hpbGUgc29tZSBwb3Rl
bnRpYWwgcmFjZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5LApvdGhlcnMgYXJl
IG5vdC4gIFRoZXNlIGluY2x1ZGU6CgoxLiBXaGVuIG9uZSBwcm9jZXNzb3Ig
bW9kaWZpZXMgYSBzdWItc3VwZXJwYWdlIG1hcHBpbmcgd2hpbGUgYW5vdGhl
cgpwcm9jZXNzb3IgcmVwbGFjZXMgdGhlIGVudGlyZSByYW5nZSB3aXRoIGEg
c3VwZXJwYWdlLgoKVGFrZSB0aGUgZm9sbG93aW5nIGV4YW1wbGU6CgpTdXBw
b3NlIEwzW05dIHBvaW50cyB0byBMMi4gIEFuZCBzdXBwb3NlIHdlIGhhdmUg
dHdvIHByb2Nlc3NvcnMsIEEgYW5kCkIuCgoqIEEgd2Fsa3MgdGhlIHBhZ2V0
YWJsZXMsIGdldCBhIHBvaW50ZXIgdG8gTDIuCiogQiByZXBsYWNlcyBMM1tO
XSB3aXRoIGEgMUdpQiBtYXBwaW5nLgoqIEIgRnJlZXMgTDIKKiBBIHdyaXRl
cyBMMltNXSAjCgpUaGlzIGlzIHJhY2UgZXhhY2VyYmF0ZWQgYnkgdGhlIGZh
Y3QgdGhhdCB2aXJ0X3RvX3hlbl9sWzIxXWUgZG9lc24ndApoYW5kbGUgaGln
aGVyLWxldmVsIHN1cGVycGFnZXMgcHJvcGVybHk6IElmIHlvdSBjYWxsIHZp
cnRfeGVuX3RvX2wyZQpvbiBhIHZpcnR1YWwgYWRkcmVzcyB3aXRoaW4gYW4g
TDMgc3VwZXJwYWdlLCB5b3UnbGwgZWl0aGVyIGhpdCBhIEJVRygpCihtb3N0
IGxpa2VseSksIG9yIGdldCBhIHBvaW50ZXIgaW50byB0aGUgbWlkZGxlIG9m
IGEgZGF0YSBwYWdlOyBzYW1lCndpdGggdmlydF94ZW5fdG9fbDEgb24gYSB2
aXJ0dWFsIGFkZHJlc3Mgd2l0aGluIGVpdGhlciBhbiBMMyBvciBMMgpzdXBl
cnBhZ2UuCgpTbyB0YWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToKCiogQSBy
ZWFkcyBwbDNlIGFuZCBkaXNjb3ZlcnMgaXQgdG8gcG9pbnQgdG8gYW4gTDIu
CiogQiByZXBsYWNlcyBMM1tOXSB3aXRoIGEgMUdpQiBtYXBwaW5nCiogQSBj
YWxscyB2aXJ0X3RvX3hlbl9sMmUoKSBhbmQgaGl0cyB0aGUgQlVHX09OKCkg
IwoKMi4gV2hlbiB0d28gcHJvY2Vzc29ycyBzaW11bHRhbmVvdXNseSB0cnkg
dG8gcmVwbGFjZSBhIHN1Yi1zdXBlcnBhZ2UKbWFwcGluZyB3aXRoIGEgc3Vw
ZXJwYWdlIG1hcHBpbmcuCgpUYWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToK
ClN1cHBvc2UgTDNbTl0gcG9pbnRzIHRvIEwyLiAgQW5kIHN1cHBvc2Ugd2Ug
aGF2ZSB0d28gcHJvY2Vzc29ycywgQSBhbmQgQiwKYm90aCB0cnlpbmcgdG8g
cmVwbGFjZSBMM1tOXSB3aXRoIGEgc3VwZXJwYWdlLgoKKiBBIHdhbGtzIHRo
ZSBwYWdldGFibGVzLCBnZXQgYSBwb2ludGVyIHRvIHBsM2UsIGFuZCB0YWtl
cyBhIGNvcHkgb2wzZSBwb2ludGluZyB0byBMMi4KKiBCIHdhbGtzIHRoZSBw
YWdldGFibGVzLCBnZXRzIGEgcG9pbnRyZSB0byBwbDNlLCBhbmQgdGFrZXMg
YSBjb3B5IG9sM2UgcG9pbnRpbmcgdG8gTDIuCiogQSB3cml0ZXMgdGhlIG5l
dyB2YWx1ZSBpbnRvIEwzW05dCiogQiB3cml0ZXMgdGhlIG5ldyB2YWx1ZSBp
bnRvIEwzW05dCiogQSByZWN1cnNpdmVseSBmcmVlcyBhbGwgdGhlIEwxJ3Mg
dW5kZXIgTDIsIHRoZW4gZnJlZXMgTDIKKiBCIHJlY3Vyc2l2ZWx5IGRvdWJs
ZS1mcmVlcyBhbGwgdGhlIEwxJ3MgdW5kZXIgTDIsIHRoZW4gZG91YmxlLWZy
ZWVzIEwyICMKCkZpeCB0aGlzIGJ5IGdyYWJiaW5nIGEgbG9jayBmb3IgdGhl
IGVudGlyZXR5IG9mIHRoZSBtYXBwaW5nIHVwZGF0ZQpvcGVyYXRpb24uCgpS
YXRoZXIgdGhhbiBncmFiYmluZyBtYXBfcGdkaXJfbG9jayBmb3IgdGhlIGVu
dGlyZSBvcGVyYXRpb24sIGhvd2V2ZXIsCnJlcHVycG9zZSB0aGUgUEdUX2xv
Y2tlZCBiaXQgZnJvbSBMMydzIHBhZ2UtPnR5cGVfaW5mbyBhcyBhIGxvY2su
ClRoaXMgbWVhbnMgdGhhdCByYXRoZXIgdGhhbiBsb2NraW5nIHRoZSBlbnRp
cmUgYWRkcmVzcyBzcGFjZSwgd2UKIm9ubHkiIGxvY2sgYSBzaW5nbGUgNTEy
R2lCIGNodW5rIG9mIGh5cGVydmlzb3IgYWRkcmVzcyBzcGFjZSBhdCBhCnRp
bWUuCgpUaGVyZSB3YXMgYSBwcm9wb3NhbCBmb3IgYSBsb2NrLWFuZC1yZXZl
cmlmeSBhcHByb2FjaCwgd2hlcmUgd2Ugd2Fsawp0aGUgcGFnZXRhYmxlcyB0
byB0aGUgcG9pbnQgd2hlcmUgd2UgZGVjaWRlIHdoYXQgdG8gZG87IHRoZW4g
Z3JhYiB0aGUKbWFwX3BnZGlyX2xvY2ssIHJlLXZlcmlmeSB0aGUgaW5mb3Jt
YXRpb24gd2UgY29sbGVjdGVkIHdpdGhvdXQgdGhlCmxvY2ssIGFuZCBmaW5h
bGx5IG1ha2UgdGhlIGNoYW5nZSAoc3RhcnRpbmcgb3ZlciBhZ2FpbiBpZiBh
bnl0aGluZyBoYWQKY2hhbmdlZCkuICBXaXRob3V0IGJlaW5nIGFibGUgdG8g
Z3VhcmFudGVlIHRoYXQgdGhlIEwyIHRhYmxlIHdhc24ndApmcmVlZCwgaG93
ZXZlciwgdGhhdCBtZWFucyBldmVyeSByZWFkIHdvdWxkIG5lZWQgdG8gYmUg
Y29uc2lkZXJlZApwb3RlbnRpYWxseSB1bnNhZmUuICBUaGlua2luZyBjYXJl
ZnVsbHkgYWJvdXQgdGhhdCBpcyBwcm9iYWJseQpzb21ldGhpbmcgdGhhdCB3
YW50cyB0byBiZSBkb25lIG9uIHB1YmxpYywgbm90IHVuZGVyIHRpbWUgcHJl
c3N1cmUuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5
OiBIb25neWFuIFhpYSA8aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSG9uZ3lhbiBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25l
ZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4
LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZpbGUg
Y2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IGU2NDQ2ODVjYWIuLmZhYTdkZjMwYzEgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0yMTMyLDYgKzIxMzIsNTAgQEAgdm9pZCBwYWdlX3VubG9jayhzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIH0gd2hpbGUgKCAoeSA9IGNtcHhjaGco
JnBhZ2UtPnUuaW51c2UudHlwZV9pbmZvLCB4LCBueCkpICE9IHggKTsKIH0K
IAorLyoKKyAqIEwzIHRhYmxlIGxvY2tzOgorICoKKyAqIFVzZWQgZm9yIHNl
cmlhbGl6YXRpb24gaW4gbWFwX3BhZ2VzX3RvX3hlbigpIGFuZCBtb2RpZnlf
eGVuX21hcHBpbmdzKCkuCisgKgorICogRm9yIFhlbiBQVCBwYWdlcywgdGhl
IHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvIGlzIHVudXNlZCBhbmQgaXQgaXMg
c2FmZSB0bworICogcmV1c2UgdGhlIFBHVF9sb2NrZWQgZmxhZy4gVGhpcyBs
b2NrIGlzIHRha2VuIG9ubHkgd2hlbiB3ZSBtb3ZlIGRvd24gdG8gTDMKKyAq
IHRhYmxlcyBhbmQgYmVsb3csIHNpbmNlIEw0IChhbmQgYWJvdmUsIGZvciA1
LWxldmVsIHBhZ2luZykgaXMgc3RpbGwgZ2xvYmFsbHkKKyAqIHByb3RlY3Rl
ZCBieSBtYXBfcGdkaXJfbG9jay4KKyAqCisgKiBQViBNTVUgdXBkYXRlIGh5
cGVyY2FsbHMgY2FsbCBtYXBfcGFnZXNfdG9feGVuIHdoaWxlIGhvbGRpbmcg
YSBwYWdlJ3MgcGFnZV9sb2NrKCkuCisgKiBUaGlzIGhhcyB0d28gaW1wbGlj
YXRpb25zOgorICogLSBXZSBjYW5ub3QgcmV1c2UgcmV1c2UgY3VycmVudF9s
b2NrZWRfcGFnZV8qIGZvciBkZWJ1Z2dpbmcKKyAqIC0gVG8gYXZvaWQgdGhl
IGNoYW5jZSBvZiBkZWFkbG9jaywgZXZlbiBmb3IgZGlmZmVyZW50IHBhZ2Vz
LCB3ZQorICogICBtdXN0IG5ldmVyIGdyYWIgcGFnZV9sb2NrKCkgYWZ0ZXIg
Z3JhYmJpbmcgbDN0X2xvY2soKS4gIFRoaXMKKyAqICAgaW5jbHVkZXMgYW55
IHBhZ2VfbG9jaygpLWJhc2VkIGxvY2tzLCBzdWNoIGFzCisgKiAgIG1lbV9z
aGFyaW5nX3BhZ2VfbG9jaygpLgorICoKKyAqIEFsc28gbm90ZSB0aGF0IHdl
IGdyYWIgdGhlIG1hcF9wZ2Rpcl9sb2NrIHdoaWxlIGhvbGRpbmcgdGhlCisg
KiBsM3RfbG9jaygpLCBzbyB0byBhdm9pZCBkZWFkbG9jayB3ZSBtdXN0IGF2
b2lkIGdyYWJiaW5nIHRoZW0gaW4KKyAqIHJldmVyc2Ugb3JkZXIuCisgKi8K
K3N0YXRpYyB2b2lkIGwzdF9sb2NrKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
Cit7CisgICAgdW5zaWduZWQgbG9uZyB4LCBueDsKKworICAgIGRvIHsKKyAg
ICAgICAgd2hpbGUgKCAoeCA9IHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvKSAm
IFBHVF9sb2NrZWQgKQorICAgICAgICAgICAgY3B1X3JlbGF4KCk7CisgICAg
ICAgIG54ID0geCB8IFBHVF9sb2NrZWQ7CisgICAgfSB3aGlsZSAoIGNtcHhj
aGcoJnBhZ2UtPnUuaW51c2UudHlwZV9pbmZvLCB4LCBueCkgIT0geCApOwor
fQorCitzdGF0aWMgdm9pZCBsM3RfdW5sb2NrKHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2UpCit7CisgICAgdW5zaWduZWQgbG9uZyB4LCBueCwgeSA9IHBhZ2Ut
PnUuaW51c2UudHlwZV9pbmZvOworCisgICAgZG8geworICAgICAgICB4ID0g
eTsKKyAgICAgICAgQlVHX09OKCEoeCAmIFBHVF9sb2NrZWQpKTsKKyAgICAg
ICAgbnggPSB4ICYgflBHVF9sb2NrZWQ7CisgICAgfSB3aGlsZSAoICh5ID0g
Y21weGNoZygmcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIHgsIG54KSkgIT0g
eCApOworfQorCiAvKgogICogUFRFIGZsYWdzIHRoYXQgYSBndWVzdCBtYXkg
Y2hhbmdlIHdpdGhvdXQgcmUtdmFsaWRhdGluZyB0aGUgUFRFLgogICogQWxs
IG90aGVyIGJpdHMgYWZmZWN0IHRyYW5zbGF0aW9uLCBjYWNoaW5nLCBvciBY
ZW4ncyBzYWZldHkuCkBAIC01MTAyLDYgKzUxNDYsMjMgQEAgbDFfcGdlbnRy
eV90ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9uZyB2KQogICAgICAg
ICAgICAgICAgICAgICAgICAgIGZsdXNoX2FyZWFfbG9jYWwoKGNvbnN0IHZv
aWQgKil2LCBmKSA6IFwKICAgICAgICAgICAgICAgICAgICAgICAgICBmbHVz
aF9hcmVhX2FsbCgoY29uc3Qgdm9pZCAqKXYsIGYpKQogCisjZGVmaW5lIEwz
VF9JTklUKHBhZ2UpIChwYWdlKSA9IFpFUk9fQkxPQ0tfUFRSCisKKyNkZWZp
bmUgTDNUX0xPQ0socGFnZSkgICAgICAgIFwKKyAgICBkbyB7ICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBsb2NraW5nICkgICAgICAg
IFwKKyAgICAgICAgICAgIGwzdF9sb2NrKHBhZ2UpOyAgIFwKKyAgICB9IHdo
aWxlICggZmFsc2UgKQorCisjZGVmaW5lIEwzVF9VTkxPQ0socGFnZSkgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgZG8geyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIGlm
ICggbG9ja2luZyAmJiAocGFnZSkgIT0gWkVST19CTE9DS19QVFIgKSBcCisg
ICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICBsM3RfdW5sb2NrKHBhZ2UpOyAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICAocGFnZSkgPSBaRVJPX0JM
T0NLX1BUUjsgICAgICAgICAgICAgICBcCisgICAgICAgIH0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgfSB3aGls
ZSAoIGZhbHNlICkKKwogaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgdW5z
aWduZWQgbG9uZyB2aXJ0LAogICAgIHVuc2lnbmVkIGxvbmcgbWZuLApAQCAt
NTExMyw2ICs1MTc0LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAg
bDFfcGdlbnRyeV90ICpwbDFlLCBvbDFlOwogICAgIHVuc2lnbmVkIGludCAg
aTsKICAgICBpbnQgcmMgPSAtRU5PTUVNOworICAgIHN0cnVjdCBwYWdlX2lu
Zm8gKmN1cnJlbnRfbDNwYWdlOwogCiAjZGVmaW5lIGZsdXNoX2ZsYWdzKG9s
ZGYpIGRvIHsgICAgICAgICAgICAgICAgIFwKICAgICB1bnNpZ25lZCBpbnQg
b18gPSAob2xkZik7ICAgICAgICAgICAgICAgICAgXApAQCAtNTEyOCwxMyAr
NTE5MCwyMCBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICB9ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSB3aGls
ZSAoMCkKIAorICAgIEwzVF9JTklUKGN1cnJlbnRfbDNwYWdlKTsKKwogICAg
IHdoaWxlICggbnJfbWZucyAhPSAwICkKICAgICB7Ci0gICAgICAgIGwzX3Bn
ZW50cnlfdCBvbDNlLCAqcGwzZSA9IHZpcnRfdG9feGVuX2wzZSh2aXJ0KTsK
KyAgICAgICAgbDNfcGdlbnRyeV90ICpwbDNlLCBvbDNlOwogCisgICAgICAg
IEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOworCisgICAgICAgIHBsM2Ug
PSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7CiAgICAgICAgIGlmICggIXBsM2Ug
KQogICAgICAgICAgICAgZ290byBvdXQ7CiAKKyAgICAgICAgY3VycmVudF9s
M3BhZ2UgPSB2aXJ0X3RvX3BhZ2UocGwzZSk7CisgICAgICAgIEwzVF9MT0NL
KGN1cnJlbnRfbDNwYWdlKTsKICAgICAgICAgb2wzZSA9ICpwbDNlOwogCiAg
ICAgICAgIGlmICggY3B1X2hhc19wYWdlMWdiICYmCkBAIC01NDYzLDYgKzU1
MzIsNyBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICByYyA9IDA7CiAK
ICBvdXQ6CisgICAgTDNUX1VOTE9DSyhjdXJyZW50X2wzcGFnZSk7CiAgICAg
cmV0dXJuIHJjOwogfQogCkBAIC01NDkyLDYgKzU1NjIsNyBAQCBpbnQgbW9k
aWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxv
bmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgIHVuc2lnbmVkIGludCAgaTsK
ICAgICB1bnNpZ25lZCBsb25nIHYgPSBzOwogICAgIGludCByYyA9IC1FTk9N
RU07CisgICAgc3RydWN0IHBhZ2VfaW5mbyAqY3VycmVudF9sM3BhZ2U7CiAK
ICAgICAvKiBTZXQgb2YgdmFsaWQgUFRFIGJpdHMgd2hpY2ggbWF5IGJlIGFs
dGVyZWQuICovCiAjZGVmaW5lIEZMQUdTX01BU0sgKF9QQUdFX05YfF9QQUdF
X1JXfF9QQUdFX1BSRVNFTlQpCkBAIC01NTAwLDExICs1NTcxLDIyIEBAIGlu
dCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWdu
ZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgQVNTRVJUKElTX0FM
SUdORUQocywgUEFHRV9TSVpFKSk7CiAgICAgQVNTRVJUKElTX0FMSUdORUQo
ZSwgUEFHRV9TSVpFKSk7CiAKKyAgICBMM1RfSU5JVChjdXJyZW50X2wzcGFn
ZSk7CisKICAgICB3aGlsZSAoIHYgPCBlICkKICAgICB7Ci0gICAgICAgIGwz
X3BnZW50cnlfdCAqcGwzZSA9IHZpcnRfdG9feGVuX2wzZSh2KTsKKyAgICAg
ICAgbDNfcGdlbnRyeV90ICpwbDNlOworCisgICAgICAgIEwzVF9VTkxPQ0so
Y3VycmVudF9sM3BhZ2UpOwogCi0gICAgICAgIGlmICggIXBsM2UgfHwgIShs
M2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BSRVNFTlQpICkKKyAgICAg
ICAgcGwzZSA9IHZpcnRfdG9feGVuX2wzZSh2KTsKKyAgICAgICAgaWYgKCAh
cGwzZSApCisgICAgICAgICAgICBnb3RvIG91dDsKKworICAgICAgICBjdXJy
ZW50X2wzcGFnZSA9IHZpcnRfdG9fcGFnZShwbDNlKTsKKyAgICAgICAgTDNU
X0xPQ0soY3VycmVudF9sM3BhZ2UpOworCisgICAgICAgIGlmICggIShsM2Vf
Z2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BSRVNFTlQpICkKICAgICAgICAg
ewogICAgICAgICAgICAgLyogQ29uZmlybSB0aGUgY2FsbGVyIGlzbid0IHRy
eWluZyB0byBjcmVhdGUgbmV3IG1hcHBpbmdzLiAqLwogICAgICAgICAgICAg
QVNTRVJUKCEobmYgJiBfUEFHRV9QUkVTRU5UKSk7CkBAIC01NzIyLDkgKzU4
MDQsMTMgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9u
ZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICBy
YyA9IDA7CiAKICBvdXQ6CisgICAgTDNUX1VOTE9DSyhjdXJyZW50X2wzcGFn
ZSk7CiAgICAgcmV0dXJuIHJjOwogfQogCisjdW5kZWYgTDNUX0xPQ0sKKyN1
bmRlZiBMM1RfVU5MT0NLCisKICN1bmRlZiBmbHVzaF9hcmVhCiAKIGludCBk
ZXN0cm95X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVk
IGxvbmcgZSkKLS0gCjIuMjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.11/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Disposition: attachment;
 filename="xsa345-4.11/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Transfer-Encoding: base64

RnJvbSBlZGJlNzA0MjdlMTc3NDMzNTFmMWI3MzllYTE1MzZhY2Q3NTdhZTZj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQxICswMDAwClN1YmplY3Q6IFtQQVRDSCAxLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbWFwX3BhZ2VzX3RvX3hlbiB0byBoYXZlIG9ubHkgYSBzaW5nbGUKIGV4
aXQgcGF0aAoKV2Ugd2lsbCBzb29uIG5lZWQgdG8gcGVyZm9ybSBjbGVhbi11
cHMgYmVmb3JlIHJldHVybmluZy4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zNDUuCgpSZXBvcnRlZC1ieTogSG9uZ3lh
biBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IFdl
aSBMaXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhv
bmd5YW4gWGlhIDxob25neXhpYUBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkFj
a2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgfCAxNyArKysrKysrKysrKy0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDExIGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94
ODYvbW0uYwppbmRleCA2MjY3NjhhOTUwLi43OWEzZmFjM2NjIDEwMDY0NAot
LS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0u
YwpAQCAtNTE5NCw2ICs1MTk0LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgbDJfcGdlbnRyeV90ICpwbDJlLCBvbDJlOwogICAgIGwxX3BnZW50
cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CisgICAg
aW50IHJjID0gLUVOT01FTTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhvbGRm
KSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50IG9f
ID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUyMTQsNyArNTIx
NSw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICBsM19wZ2Vu
dHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7CiAK
ICAgICAgICAgaWYgKCAhcGwzZSApCi0gICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgIG9sM2Ug
PSAqcGwzZTsKIAogICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpA
QCAtNTMwMiw3ICs1MzA0LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAK
ICAgICAgICAgICAgIHBsMmUgPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAg
ICAgICAgICAgICBpZiAoIHBsMmUgPT0gTlVMTCApCi0gICAgICAgICAgICAg
ICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAgZ290byBvdXQ7
CiAKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDJfUEFHRVRBQkxF
X0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgbDJlX3dyaXRlKHBs
MmUgKyBpLApAQCAtNTMzMSw3ICs1MzMzLDcgQEAgaW50IG1hcF9wYWdlc190
b194ZW4oCiAKICAgICAgICAgcGwyZSA9IHZpcnRfdG9feGVuX2wyZSh2aXJ0
KTsKICAgICAgICAgaWYgKCAhcGwyZSApCi0gICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OwogCiAgICAgICAgIGlm
ICggKCgoKHZpcnQgPj4gUEFHRV9TSElGVCkgfCBtZm5feChtZm4pKSAmCiAg
ICAgICAgICAgICAgICAoKDF1IDw8IFBBR0VUQUJMRV9PUkRFUikgLSAxKSkg
PT0gMCkgJiYKQEAgLTUzNzQsNyArNTM3Niw3IEBAIGludCBtYXBfcGFnZXNf
dG9feGVuKAogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBsMWUg
PSB2aXJ0X3RvX3hlbl9sMWUodmlydCk7CiAgICAgICAgICAgICAgICAgaWYg
KCBwbDFlID09IE5VTEwgKQotICAgICAgICAgICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKKyAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7CiAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggbDJlX2dldF9mbGFn
cygqcGwyZSkgJiBfUEFHRV9QU0UgKQogICAgICAgICAgICAgewpAQCAtNTQw
MSw3ICs1NDAzLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAKICAgICAg
ICAgICAgICAgICBwbDFlID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAg
ICAgICAgICAgICAgIGlmICggcGwxZSA9PSBOVUxMICkKLSAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAgICAg
IGdvdG8gb3V0OwogCiAgICAgICAgICAgICAgICAgZm9yICggaSA9IDA7IGkg
PCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAgICAgICAg
ICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLApAQCAtNTU0NSw3ICs1NTQ3LDEw
IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogCiAjdW5kZWYgZmx1c2hfZmxh
Z3MKIAotICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAg
ICByZXR1cm4gcmM7CiB9CiAKIGludCBwb3B1bGF0ZV9wdF9yYW5nZSh1bnNp
Z25lZCBsb25nIHZpcnQsIHVuc2lnbmVkIGxvbmcgbnJfbWZucykKLS0gCjIu
MjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.11/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Disposition: attachment;
 filename="xsa345-4.11/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Transfer-Encoding: base64

RnJvbSA3MTAxNzg2YmU5MWRjZTY1MGI2ZTc5ZjEzNzRjNTgwYzczMWJiMzQ4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQyICswMDAwClN1YmplY3Q6IFtQQVRDSCAyLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbW9kaWZ5X3hlbl9tYXBwaW5ncyB0byBoYXZlIG9uZSBleGl0CiBwYXRo
CgpXZSB3aWxsIHNvb24gbmVlZCB0byBwZXJmb3JtIGNsZWFuLXVwcyBiZWZv
cmUgcmV0dXJuaW5nLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5OiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8
d2VpLmxpdTJAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSG9uZ3lhbiBY
aWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJj
aC94ODYvbW0uYyB8IDEyICsrKysrKysrKy0tLQogMSBmaWxlIGNoYW5nZWQs
IDkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4
IDc5YTNmYWMzY2MuLjhlZDNlY2FjYmUgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC01NTc3LDYg
KzU1NzcsNyBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBs
b25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAg
IGwxX3BnZW50cnlfdCAqcGwxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CiAg
ICAgdW5zaWduZWQgbG9uZyB2ID0gczsKKyAgICBpbnQgcmMgPSAtRU5PTUVN
OwogCiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBi
ZSBhbHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxf
UEFHRV9SV3xfUEFHRV9QUkVTRU5UKQpAQCAtNTYxOCw3ICs1NjE5LDggQEAg
aW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNp
Z25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAgIC8q
IFBBR0UxR0I6IHNoYXR0ZXIgdGhlIHN1cGVycGFnZSBhbmQgZmFsbCB0aHJv
dWdoLiAqLwogICAgICAgICAgICAgcGwyZSA9IGFsbG9jX3hlbl9wYWdldGFi
bGUoKTsKICAgICAgICAgICAgIGlmICggIXBsMmUgKQotICAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAgICAgIGdvdG8gb3V0
OworCiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VUQUJM
RV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgIGwyZV93cml0ZShw
bDJlICsgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgbDJlX2Zyb21f
cGZuKGwzZV9nZXRfcGZuKCpwbDNlKSArCkBAIC01NjczLDcgKzU2NzUsOCBA
QCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVu
c2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgICAgICAgICAg
ICAgIC8qIFBTRTogc2hhdHRlciB0aGUgc3VwZXJwYWdlIGFuZCB0cnkgYWdh
aW4uICovCiAgICAgICAgICAgICAgICAgcGwxZSA9IGFsbG9jX3hlbl9wYWdl
dGFibGUoKTsKICAgICAgICAgICAgICAgICBpZiAoICFwbDFlICkKLSAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAg
ICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgICAgICAgICAgZm9yICggaSA9
IDA7IGkgPCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAg
ICAgICAgICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbDFlX2Zyb21fcGZuKGwyZV9nZXRfcGZuKCpw
bDJlKSArIGksCkBAIC01ODAyLDcgKzU4MDUsMTAgQEAgaW50IG1vZGlmeV94
ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUs
IHVuc2lnbmVkIGludCBuZikKICAgICBmbHVzaF9hcmVhKE5VTEwsIEZMVVNI
X1RMQl9HTE9CQUwpOwogCiAjdW5kZWYgRkxBR1NfTUFTSwotICAgIHJldHVy
biAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAgICByZXR1cm4gcmM7CiB9
CiAKICN1bmRlZiBmbHVzaF9hcmVhCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.11/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Disposition: attachment;
 filename="xsa345-4.11/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Transfer-Encoding: base64

RnJvbSBlN2JiYzRhMGI1YWY3NmE4MmYwZGNmNGFmY2JmMTUwOWIwMjBlYjcz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KRGF0ZTogU2F0LCAxMSBKYW4gMjAyMCAy
MTo1Nzo0MyArMDAwMApTdWJqZWN0OiBbUEFUQ0ggMy8zXSB4ODYvbW06IFBy
ZXZlbnQgc29tZSByYWNlcyBpbiBoeXBlcnZpc29yIG1hcHBpbmcgdXBkYXRl
cwoKbWFwX3BhZ2VzX3RvX3hlbiB3aWxsIGF0dGVtcHQgdG8gY29hbGVzY2Ug
bWFwcGluZ3MgaW50byAyTWlCIGFuZCAxR2lCCnN1cGVycGFnZXMgaWYgcG9z
c2libGUsIHRvIG1heGltaXplIFRMQiBlZmZpY2llbmN5LiAgVGhpcyBtZWFu
cyBib3RoCnJlcGxhY2luZyBzdXBlcnBhZ2UgZW50cmllcyB3aXRoIHNtYWxs
ZXIgZW50cmllcywgYW5kIHJlcGxhY2luZwpzbWFsbGVyIGVudHJpZXMgd2l0
aCBzdXBlcnBhZ2VzLgoKVW5mb3J0dW5hdGVseSwgd2hpbGUgc29tZSBwb3Rl
bnRpYWwgcmFjZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5LApvdGhlcnMgYXJl
IG5vdC4gIFRoZXNlIGluY2x1ZGU6CgoxLiBXaGVuIG9uZSBwcm9jZXNzb3Ig
bW9kaWZpZXMgYSBzdWItc3VwZXJwYWdlIG1hcHBpbmcgd2hpbGUgYW5vdGhl
cgpwcm9jZXNzb3IgcmVwbGFjZXMgdGhlIGVudGlyZSByYW5nZSB3aXRoIGEg
c3VwZXJwYWdlLgoKVGFrZSB0aGUgZm9sbG93aW5nIGV4YW1wbGU6CgpTdXBw
b3NlIEwzW05dIHBvaW50cyB0byBMMi4gIEFuZCBzdXBwb3NlIHdlIGhhdmUg
dHdvIHByb2Nlc3NvcnMsIEEgYW5kCkIuCgoqIEEgd2Fsa3MgdGhlIHBhZ2V0
YWJsZXMsIGdldCBhIHBvaW50ZXIgdG8gTDIuCiogQiByZXBsYWNlcyBMM1tO
XSB3aXRoIGEgMUdpQiBtYXBwaW5nLgoqIEIgRnJlZXMgTDIKKiBBIHdyaXRl
cyBMMltNXSAjCgpUaGlzIGlzIHJhY2UgZXhhY2VyYmF0ZWQgYnkgdGhlIGZh
Y3QgdGhhdCB2aXJ0X3RvX3hlbl9sWzIxXWUgZG9lc24ndApoYW5kbGUgaGln
aGVyLWxldmVsIHN1cGVycGFnZXMgcHJvcGVybHk6IElmIHlvdSBjYWxsIHZp
cnRfeGVuX3RvX2wyZQpvbiBhIHZpcnR1YWwgYWRkcmVzcyB3aXRoaW4gYW4g
TDMgc3VwZXJwYWdlLCB5b3UnbGwgZWl0aGVyIGhpdCBhIEJVRygpCihtb3N0
IGxpa2VseSksIG9yIGdldCBhIHBvaW50ZXIgaW50byB0aGUgbWlkZGxlIG9m
IGEgZGF0YSBwYWdlOyBzYW1lCndpdGggdmlydF94ZW5fdG9fbDEgb24gYSB2
aXJ0dWFsIGFkZHJlc3Mgd2l0aGluIGVpdGhlciBhbiBMMyBvciBMMgpzdXBl
cnBhZ2UuCgpTbyB0YWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToKCiogQSBy
ZWFkcyBwbDNlIGFuZCBkaXNjb3ZlcnMgaXQgdG8gcG9pbnQgdG8gYW4gTDIu
CiogQiByZXBsYWNlcyBMM1tOXSB3aXRoIGEgMUdpQiBtYXBwaW5nCiogQSBj
YWxscyB2aXJ0X3RvX3hlbl9sMmUoKSBhbmQgaGl0cyB0aGUgQlVHX09OKCkg
IwoKMi4gV2hlbiB0d28gcHJvY2Vzc29ycyBzaW11bHRhbmVvdXNseSB0cnkg
dG8gcmVwbGFjZSBhIHN1Yi1zdXBlcnBhZ2UKbWFwcGluZyB3aXRoIGEgc3Vw
ZXJwYWdlIG1hcHBpbmcuCgpUYWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToK
ClN1cHBvc2UgTDNbTl0gcG9pbnRzIHRvIEwyLiAgQW5kIHN1cHBvc2Ugd2Ug
aGF2ZSB0d28gcHJvY2Vzc29ycywgQSBhbmQgQiwKYm90aCB0cnlpbmcgdG8g
cmVwbGFjZSBMM1tOXSB3aXRoIGEgc3VwZXJwYWdlLgoKKiBBIHdhbGtzIHRo
ZSBwYWdldGFibGVzLCBnZXQgYSBwb2ludGVyIHRvIHBsM2UsIGFuZCB0YWtl
cyBhIGNvcHkgb2wzZSBwb2ludGluZyB0byBMMi4KKiBCIHdhbGtzIHRoZSBw
YWdldGFibGVzLCBnZXRzIGEgcG9pbnRyZSB0byBwbDNlLCBhbmQgdGFrZXMg
YSBjb3B5IG9sM2UgcG9pbnRpbmcgdG8gTDIuCiogQSB3cml0ZXMgdGhlIG5l
dyB2YWx1ZSBpbnRvIEwzW05dCiogQiB3cml0ZXMgdGhlIG5ldyB2YWx1ZSBp
bnRvIEwzW05dCiogQSByZWN1cnNpdmVseSBmcmVlcyBhbGwgdGhlIEwxJ3Mg
dW5kZXIgTDIsIHRoZW4gZnJlZXMgTDIKKiBCIHJlY3Vyc2l2ZWx5IGRvdWJs
ZS1mcmVlcyBhbGwgdGhlIEwxJ3MgdW5kZXIgTDIsIHRoZW4gZG91YmxlLWZy
ZWVzIEwyICMKCkZpeCB0aGlzIGJ5IGdyYWJiaW5nIGEgbG9jayBmb3IgdGhl
IGVudGlyZXR5IG9mIHRoZSBtYXBwaW5nIHVwZGF0ZQpvcGVyYXRpb24uCgpS
YXRoZXIgdGhhbiBncmFiYmluZyBtYXBfcGdkaXJfbG9jayBmb3IgdGhlIGVu
dGlyZSBvcGVyYXRpb24sIGhvd2V2ZXIsCnJlcHVycG9zZSB0aGUgUEdUX2xv
Y2tlZCBiaXQgZnJvbSBMMydzIHBhZ2UtPnR5cGVfaW5mbyBhcyBhIGxvY2su
ClRoaXMgbWVhbnMgdGhhdCByYXRoZXIgdGhhbiBsb2NraW5nIHRoZSBlbnRp
cmUgYWRkcmVzcyBzcGFjZSwgd2UKIm9ubHkiIGxvY2sgYSBzaW5nbGUgNTEy
R2lCIGNodW5rIG9mIGh5cGVydmlzb3IgYWRkcmVzcyBzcGFjZSBhdCBhCnRp
bWUuCgpUaGVyZSB3YXMgYSBwcm9wb3NhbCBmb3IgYSBsb2NrLWFuZC1yZXZl
cmlmeSBhcHByb2FjaCwgd2hlcmUgd2Ugd2Fsawp0aGUgcGFnZXRhYmxlcyB0
byB0aGUgcG9pbnQgd2hlcmUgd2UgZGVjaWRlIHdoYXQgdG8gZG87IHRoZW4g
Z3JhYiB0aGUKbWFwX3BnZGlyX2xvY2ssIHJlLXZlcmlmeSB0aGUgaW5mb3Jt
YXRpb24gd2UgY29sbGVjdGVkIHdpdGhvdXQgdGhlCmxvY2ssIGFuZCBmaW5h
bGx5IG1ha2UgdGhlIGNoYW5nZSAoc3RhcnRpbmcgb3ZlciBhZ2FpbiBpZiBh
bnl0aGluZyBoYWQKY2hhbmdlZCkuICBXaXRob3V0IGJlaW5nIGFibGUgdG8g
Z3VhcmFudGVlIHRoYXQgdGhlIEwyIHRhYmxlIHdhc24ndApmcmVlZCwgaG93
ZXZlciwgdGhhdCBtZWFucyBldmVyeSByZWFkIHdvdWxkIG5lZWQgdG8gYmUg
Y29uc2lkZXJlZApwb3RlbnRpYWxseSB1bnNhZmUuICBUaGlua2luZyBjYXJl
ZnVsbHkgYWJvdXQgdGhhdCBpcyBwcm9iYWJseQpzb21ldGhpbmcgdGhhdCB3
YW50cyB0byBiZSBkb25lIG9uIHB1YmxpYywgbm90IHVuZGVyIHRpbWUgcHJl
c3N1cmUuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5
OiBIb25neWFuIFhpYSA8aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSG9uZ3lhbiBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25l
ZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4
LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZpbGUg
Y2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IDhlZDNlY2FjYmUuLjRmZjI0ZGU3M2QgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0yMTUzLDYgKzIxNTMsNTAgQEAgdm9pZCBwYWdlX3VubG9jayhzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIGN1cnJlbnRfbG9ja2VkX3BhZ2Vfc2V0
KE5VTEwpOwogfQogCisvKgorICogTDMgdGFibGUgbG9ja3M6CisgKgorICog
VXNlZCBmb3Igc2VyaWFsaXphdGlvbiBpbiBtYXBfcGFnZXNfdG9feGVuKCkg
YW5kIG1vZGlmeV94ZW5fbWFwcGluZ3MoKS4KKyAqCisgKiBGb3IgWGVuIFBU
IHBhZ2VzLCB0aGUgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gaXMgdW51c2Vk
IGFuZCBpdCBpcyBzYWZlIHRvCisgKiByZXVzZSB0aGUgUEdUX2xvY2tlZCBm
bGFnLiBUaGlzIGxvY2sgaXMgdGFrZW4gb25seSB3aGVuIHdlIG1vdmUgZG93
biB0byBMMworICogdGFibGVzIGFuZCBiZWxvdywgc2luY2UgTDQgKGFuZCBh
Ym92ZSwgZm9yIDUtbGV2ZWwgcGFnaW5nKSBpcyBzdGlsbCBnbG9iYWxseQor
ICogcHJvdGVjdGVkIGJ5IG1hcF9wZ2Rpcl9sb2NrLgorICoKKyAqIFBWIE1N
VSB1cGRhdGUgaHlwZXJjYWxscyBjYWxsIG1hcF9wYWdlc190b194ZW4gd2hp
bGUgaG9sZGluZyBhIHBhZ2UncyBwYWdlX2xvY2soKS4KKyAqIFRoaXMgaGFz
IHR3byBpbXBsaWNhdGlvbnM6CisgKiAtIFdlIGNhbm5vdCByZXVzZSByZXVz
ZSBjdXJyZW50X2xvY2tlZF9wYWdlXyogZm9yIGRlYnVnZ2luZworICogLSBU
byBhdm9pZCB0aGUgY2hhbmNlIG9mIGRlYWRsb2NrLCBldmVuIGZvciBkaWZm
ZXJlbnQgcGFnZXMsIHdlCisgKiAgIG11c3QgbmV2ZXIgZ3JhYiBwYWdlX2xv
Y2soKSBhZnRlciBncmFiYmluZyBsM3RfbG9jaygpLiAgVGhpcworICogICBp
bmNsdWRlcyBhbnkgcGFnZV9sb2NrKCktYmFzZWQgbG9ja3MsIHN1Y2ggYXMK
KyAqICAgbWVtX3NoYXJpbmdfcGFnZV9sb2NrKCkuCisgKgorICogQWxzbyBu
b3RlIHRoYXQgd2UgZ3JhYiB0aGUgbWFwX3BnZGlyX2xvY2sgd2hpbGUgaG9s
ZGluZyB0aGUKKyAqIGwzdF9sb2NrKCksIHNvIHRvIGF2b2lkIGRlYWRsb2Nr
IHdlIG11c3QgYXZvaWQgZ3JhYmJpbmcgdGhlbSBpbgorICogcmV2ZXJzZSBv
cmRlci4KKyAqLworc3RhdGljIHZvaWQgbDN0X2xvY2soc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54OworCisg
ICAgZG8geworICAgICAgICB3aGlsZSAoICh4ID0gcGFnZS0+dS5pbnVzZS50
eXBlX2luZm8pICYgUEdUX2xvY2tlZCApCisgICAgICAgICAgICBjcHVfcmVs
YXgoKTsKKyAgICAgICAgbnggPSB4IHwgUEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggY21weGNoZygmcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIHgsIG54
KSAhPSB4ICk7Cit9CisKK3N0YXRpYyB2b2lkIGwzdF91bmxvY2soc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54
LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2luZm87CisKKyAgICBkbyB7Cisg
ICAgICAgIHggPSB5OworICAgICAgICBCVUdfT04oISh4ICYgUEdUX2xvY2tl
ZCkpOworICAgICAgICBueCA9IHggJiB+UEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggKHkgPSBjbXB4Y2hnKCZwYWdlLT51LmludXNlLnR5cGVfaW5mbywg
eCwgbngpKSAhPSB4ICk7Cit9CisKIC8qCiAgKiBQVEUgZmxhZ3MgdGhhdCBh
IGd1ZXN0IG1heSBjaGFuZ2Ugd2l0aG91dCByZS12YWxpZGF0aW5nIHRoZSBQ
VEUuCiAgKiBBbGwgb3RoZXIgYml0cyBhZmZlY3QgdHJhbnNsYXRpb24sIGNh
Y2hpbmcsIG9yIFhlbidzIHNhZmV0eS4KQEAgLTUxODQsNiArNTIyOCwyMyBA
QCBsMV9wZ2VudHJ5X3QgKnZpcnRfdG9feGVuX2wxZSh1bnNpZ25lZCBsb25n
IHYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgZmx1c2hfYXJlYV9sb2Nh
bCgoY29uc3Qgdm9pZCAqKXYsIGYpIDogXAogICAgICAgICAgICAgICAgICAg
ICAgICAgIGZsdXNoX2FyZWFfYWxsKChjb25zdCB2b2lkICopdiwgZikpCiAK
KyNkZWZpbmUgTDNUX0lOSVQocGFnZSkgKHBhZ2UpID0gWkVST19CTE9DS19Q
VFIKKworI2RlZmluZSBMM1RfTE9DSyhwYWdlKSAgICAgICAgXAorICAgIGRv
IHsgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBpZiAoIGxvY2tp
bmcgKSAgICAgICAgXAorICAgICAgICAgICAgbDN0X2xvY2socGFnZSk7ICAg
XAorICAgIH0gd2hpbGUgKCBmYWxzZSApCisKKyNkZWZpbmUgTDNUX1VOTE9D
SyhwYWdlKSAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgaWYgKCBsb2NraW5nICYmIChwYWdlKSAhPSBaRVJPX0JMT0NL
X1BUUiApIFwKKyAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgIGwzdF91bmxvY2socGFn
ZSk7ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgIChwYWdl
KSA9IFpFUk9fQkxPQ0tfUFRSOyAgICAgICAgICAgICAgIFwKKyAgICAgICAg
fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICB9IHdoaWxlICggZmFsc2UgKQorCiBpbnQgbWFwX3BhZ2VzX3RvX3hl
bigKICAgICB1bnNpZ25lZCBsb25nIHZpcnQsCiAgICAgbWZuX3QgbWZuLApA
QCAtNTE5NSw2ICs1MjU2LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAg
ICAgbDFfcGdlbnRyeV90ICpwbDFlLCBvbDFlOwogICAgIHVuc2lnbmVkIGlu
dCAgaTsKICAgICBpbnQgcmMgPSAtRU5PTUVNOworICAgIHN0cnVjdCBwYWdl
X2luZm8gKmN1cnJlbnRfbDNwYWdlOwogCiAjZGVmaW5lIGZsdXNoX2ZsYWdz
KG9sZGYpIGRvIHsgICAgICAgICAgICAgICAgIFwKICAgICB1bnNpZ25lZCBp
bnQgb18gPSAob2xkZik7ICAgICAgICAgICAgICAgICAgXApAQCAtNTIxMCwx
MyArNTI3MiwyMCBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICB9ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSB3
aGlsZSAoMCkKIAorICAgIEwzVF9JTklUKGN1cnJlbnRfbDNwYWdlKTsKKwog
ICAgIHdoaWxlICggbnJfbWZucyAhPSAwICkKICAgICB7Ci0gICAgICAgIGwz
X3BnZW50cnlfdCBvbDNlLCAqcGwzZSA9IHZpcnRfdG9feGVuX2wzZSh2aXJ0
KTsKKyAgICAgICAgbDNfcGdlbnRyeV90ICpwbDNlLCBvbDNlOwogCisgICAg
ICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOworCisgICAgICAgIHBs
M2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7CiAgICAgICAgIGlmICggIXBs
M2UgKQogICAgICAgICAgICAgZ290byBvdXQ7CiAKKyAgICAgICAgY3VycmVu
dF9sM3BhZ2UgPSB2aXJ0X3RvX3BhZ2UocGwzZSk7CisgICAgICAgIEwzVF9M
T0NLKGN1cnJlbnRfbDNwYWdlKTsKICAgICAgICAgb2wzZSA9ICpwbDNlOwog
CiAgICAgICAgIGlmICggY3B1X2hhc19wYWdlMWdiICYmCkBAIC01NTUwLDYg
KzU2MTksNyBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICByYyA9IDA7
CiAKICBvdXQ6CisgICAgTDNUX1VOTE9DSyhjdXJyZW50X2wzcGFnZSk7CiAg
ICAgcmV0dXJuIHJjOwogfQogCkBAIC01NTc4LDYgKzU2NDgsNyBAQCBpbnQg
bW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVk
IGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgIHVuc2lnbmVkIGludCAg
aTsKICAgICB1bnNpZ25lZCBsb25nIHYgPSBzOwogICAgIGludCByYyA9IC1F
Tk9NRU07CisgICAgc3RydWN0IHBhZ2VfaW5mbyAqY3VycmVudF9sM3BhZ2U7
CiAKICAgICAvKiBTZXQgb2YgdmFsaWQgUFRFIGJpdHMgd2hpY2ggbWF5IGJl
IGFsdGVyZWQuICovCiAjZGVmaW5lIEZMQUdTX01BU0sgKF9QQUdFX05YfF9Q
QUdFX1JXfF9QQUdFX1BSRVNFTlQpCkBAIC01NTg2LDExICs1NjU3LDIyIEBA
IGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5z
aWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgQVNTRVJUKElT
X0FMSUdORUQocywgUEFHRV9TSVpFKSk7CiAgICAgQVNTRVJUKElTX0FMSUdO
RUQoZSwgUEFHRV9TSVpFKSk7CiAKKyAgICBMM1RfSU5JVChjdXJyZW50X2wz
cGFnZSk7CisKICAgICB3aGlsZSAoIHYgPCBlICkKICAgICB7Ci0gICAgICAg
IGwzX3BnZW50cnlfdCAqcGwzZSA9IHZpcnRfdG9feGVuX2wzZSh2KTsKKyAg
ICAgICAgbDNfcGdlbnRyeV90ICpwbDNlOworCisgICAgICAgIEwzVF9VTkxP
Q0soY3VycmVudF9sM3BhZ2UpOwogCi0gICAgICAgIGlmICggIXBsM2UgfHwg
IShsM2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BSRVNFTlQpICkKKyAg
ICAgICAgcGwzZSA9IHZpcnRfdG9feGVuX2wzZSh2KTsKKyAgICAgICAgaWYg
KCAhcGwzZSApCisgICAgICAgICAgICBnb3RvIG91dDsKKworICAgICAgICBj
dXJyZW50X2wzcGFnZSA9IHZpcnRfdG9fcGFnZShwbDNlKTsKKyAgICAgICAg
TDNUX0xPQ0soY3VycmVudF9sM3BhZ2UpOworCisgICAgICAgIGlmICggIShs
M2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BSRVNFTlQpICkKICAgICAg
ICAgewogICAgICAgICAgICAgLyogQ29uZmlybSB0aGUgY2FsbGVyIGlzbid0
IHRyeWluZyB0byBjcmVhdGUgbmV3IG1hcHBpbmdzLiAqLwogICAgICAgICAg
ICAgQVNTRVJUKCEobmYgJiBfUEFHRV9QUkVTRU5UKSk7CkBAIC01ODA4LDkg
KzU4OTAsMTMgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQg
bG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAg
ICByYyA9IDA7CiAKICBvdXQ6CisgICAgTDNUX1VOTE9DSyhjdXJyZW50X2wz
cGFnZSk7CiAgICAgcmV0dXJuIHJjOwogfQogCisjdW5kZWYgTDNUX0xPQ0sK
KyN1bmRlZiBMM1RfVU5MT0NLCisKICN1bmRlZiBmbHVzaF9hcmVhCiAKIGlu
dCBkZXN0cm95X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2ln
bmVkIGxvbmcgZSkKLS0gCjIuMjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.12/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Disposition: attachment;
 filename="xsa345-4.12/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Transfer-Encoding: base64

RnJvbSBlMzNmYWQzMDQ0YWFhZWVjNmVkOTkxNDkyNWQ5NTU4Njk1YmRiMDlk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQxICswMDAwClN1YmplY3Q6IFtQQVRDSCAxLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbWFwX3BhZ2VzX3RvX3hlbiB0byBoYXZlIG9ubHkgYSBzaW5nbGUKIGV4
aXQgcGF0aAoKV2Ugd2lsbCBzb29uIG5lZWQgdG8gcGVyZm9ybSBjbGVhbi11
cHMgYmVmb3JlIHJldHVybmluZy4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zNDUuCgpSZXBvcnRlZC1ieTogSG9uZ3lh
biBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IFdl
aSBMaXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhv
bmd5YW4gWGlhIDxob25neXhpYUBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+Ci0t
LQogeGVuL2FyY2gveDg2L21tLmMgfCAxNyArKysrKysrKysrKy0tLS0tLQog
MSBmaWxlIGNoYW5nZWQsIDExIGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJj
aC94ODYvbW0uYwppbmRleCBiNGM5MGJkMDU0Li4wZTU0MGYxNDNiIDEwMDY0
NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYv
bW0uYwpAQCAtNTIyNyw2ICs1MjI3LDcgQEAgaW50IG1hcF9wYWdlc190b194
ZW4oCiAgICAgbDJfcGdlbnRyeV90ICpwbDJlLCBvbDJlOwogICAgIGwxX3Bn
ZW50cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7Cisg
ICAgaW50IHJjID0gLUVOT01FTTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhv
bGRmKSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50
IG9fID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUyNDcsNyAr
NTI0OCw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICBsM19w
Z2VudHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7
CiAKICAgICAgICAgaWYgKCAhcGwzZSApCi0gICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgIG9s
M2UgPSAqcGwzZTsKIAogICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAm
JgpAQCAtNTMzNSw3ICs1MzM3LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4o
CiAKICAgICAgICAgICAgIHBsMmUgPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7
CiAgICAgICAgICAgICBpZiAoIHBsMmUgPT0gTlVMTCApCi0gICAgICAgICAg
ICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAgZ290byBv
dXQ7CiAKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDJfUEFHRVRB
QkxFX0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgbDJlX3dyaXRl
KHBsMmUgKyBpLApAQCAtNTM2NCw3ICs1MzY2LDcgQEAgaW50IG1hcF9wYWdl
c190b194ZW4oCiAKICAgICAgICAgcGwyZSA9IHZpcnRfdG9feGVuX2wyZSh2
aXJ0KTsKICAgICAgICAgaWYgKCAhcGwyZSApCi0gICAgICAgICAgICByZXR1
cm4gLUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OwogCiAgICAgICAg
IGlmICggKCgoKHZpcnQgPj4gUEFHRV9TSElGVCkgfCBtZm5feChtZm4pKSAm
CiAgICAgICAgICAgICAgICAoKDF1IDw8IFBBR0VUQUJMRV9PUkRFUikgLSAx
KSkgPT0gMCkgJiYKQEAgLTU0MDcsNyArNTQwOSw3IEBAIGludCBtYXBfcGFn
ZXNfdG9feGVuKAogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBs
MWUgPSB2aXJ0X3RvX3hlbl9sMWUodmlydCk7CiAgICAgICAgICAgICAgICAg
aWYgKCBwbDFlID09IE5VTEwgKQotICAgICAgICAgICAgICAgICAgICByZXR1
cm4gLUVOT01FTTsKKyAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7CiAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggbDJlX2dldF9m
bGFncygqcGwyZSkgJiBfUEFHRV9QU0UgKQogICAgICAgICAgICAgewpAQCAt
NTQzNCw3ICs1NDM2LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAKICAg
ICAgICAgICAgICAgICBwbDFlID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwog
ICAgICAgICAgICAgICAgIGlmICggcGwxZSA9PSBOVUxMICkKLSAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAg
ICAgIGdvdG8gb3V0OwogCiAgICAgICAgICAgICAgICAgZm9yICggaSA9IDA7
IGkgPCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAgICAg
ICAgICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLApAQCAtNTU3OCw3ICs1NTgw
LDEwIEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogCiAjdW5kZWYgZmx1c2hf
ZmxhZ3MKIAotICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKworIG91dDoK
KyAgICByZXR1cm4gcmM7CiB9CiAKIGludCBwb3B1bGF0ZV9wdF9yYW5nZSh1
bnNpZ25lZCBsb25nIHZpcnQsIHVuc2lnbmVkIGxvbmcgbnJfbWZucykKLS0g
CjIuMjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.12/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Disposition: attachment;
 filename="xsa345-4.12/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Transfer-Encoding: base64

RnJvbSBhMTUxYjA3ZDUwNGQ3ZjQ0MjI1NmUxYzgyOTE3MzM0MjE2YzU4YTIx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQyICswMDAwClN1YmplY3Q6IFtQQVRDSCAyLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbW9kaWZ5X3hlbl9tYXBwaW5ncyB0byBoYXZlIG9uZSBleGl0CiBwYXRo
CgpXZSB3aWxsIHNvb24gbmVlZCB0byBwZXJmb3JtIGNsZWFuLXVwcyBiZWZv
cmUgcmV0dXJuaW5nLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5OiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8
d2VpLmxpdTJAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSG9uZ3lhbiBY
aWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyB8IDEyICsrKysrKysrKy0tLQogMSBmaWxlIGNoYW5n
ZWQsIDkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmlu
ZGV4IDBlNTQwZjE0M2IuLmJmZjI2ODllNjAgMTAwNjQ0Ci0tLSBhL3hlbi9h
cmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC01NjEw
LDYgKzU2MTAsNyBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25l
ZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQog
ICAgIGwxX3BnZW50cnlfdCAqcGwxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7
CiAgICAgdW5zaWduZWQgbG9uZyB2ID0gczsKKyAgICBpbnQgcmMgPSAtRU5P
TUVNOwogCiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1h
eSBiZSBhbHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9O
WHxfUEFHRV9SV3xfUEFHRV9QUkVTRU5UKQpAQCAtNTY1MSw3ICs1NjUyLDgg
QEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1
bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAg
IC8qIFBBR0UxR0I6IHNoYXR0ZXIgdGhlIHN1cGVycGFnZSBhbmQgZmFsbCB0
aHJvdWdoLiAqLwogICAgICAgICAgICAgcGwyZSA9IGFsbG9jX3hlbl9wYWdl
dGFibGUoKTsKICAgICAgICAgICAgIGlmICggIXBsMmUgKQotICAgICAgICAg
ICAgICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAgICAgIGdvdG8g
b3V0OworCiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VU
QUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgIGwyZV93cml0
ZShwbDJlICsgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgbDJlX2Zy
b21fcGZuKGwzZV9nZXRfcGZuKCpwbDNlKSArCkBAIC01NzA2LDcgKzU3MDgs
OCBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMs
IHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgICAgICAg
ICAgICAgIC8qIFBTRTogc2hhdHRlciB0aGUgc3VwZXJwYWdlIGFuZCB0cnkg
YWdhaW4uICovCiAgICAgICAgICAgICAgICAgcGwxZSA9IGFsbG9jX3hlbl9w
YWdldGFibGUoKTsKICAgICAgICAgICAgICAgICBpZiAoICFwbDFlICkKLSAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAg
ICAgICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgICAgICAgICAgZm9yICgg
aSA9IDA7IGkgPCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAg
ICAgICAgICAgICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbDFlX2Zyb21fcGZuKGwyZV9nZXRfcGZu
KCpwbDJlKSArIGksCkBAIC01ODM1LDcgKzU4MzgsMTAgQEAgaW50IG1vZGlm
eV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25n
IGUsIHVuc2lnbmVkIGludCBuZikKICAgICBmbHVzaF9hcmVhKE5VTEwsIEZM
VVNIX1RMQl9HTE9CQUwpOwogCiAjdW5kZWYgRkxBR1NfTUFTSwotICAgIHJl
dHVybiAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAgICByZXR1cm4gcmM7
CiB9CiAKICN1bmRlZiBmbHVzaF9hcmVhCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.12/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Disposition: attachment;
 filename="xsa345-4.12/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Transfer-Encoding: base64

RnJvbSBhYmFmMDVlMTgzZjNiYzM5Mjc4NDRhZTE2ZDY2NDJhMzgyYzBkYmVm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KRGF0ZTogU2F0LCAxMSBKYW4gMjAyMCAy
MTo1Nzo0MyArMDAwMApTdWJqZWN0OiBbUEFUQ0ggMy8zXSB4ODYvbW06IFBy
ZXZlbnQgc29tZSByYWNlcyBpbiBoeXBlcnZpc29yIG1hcHBpbmcgdXBkYXRl
cwoKbWFwX3BhZ2VzX3RvX3hlbiB3aWxsIGF0dGVtcHQgdG8gY29hbGVzY2Ug
bWFwcGluZ3MgaW50byAyTWlCIGFuZCAxR2lCCnN1cGVycGFnZXMgaWYgcG9z
c2libGUsIHRvIG1heGltaXplIFRMQiBlZmZpY2llbmN5LiAgVGhpcyBtZWFu
cyBib3RoCnJlcGxhY2luZyBzdXBlcnBhZ2UgZW50cmllcyB3aXRoIHNtYWxs
ZXIgZW50cmllcywgYW5kIHJlcGxhY2luZwpzbWFsbGVyIGVudHJpZXMgd2l0
aCBzdXBlcnBhZ2VzLgoKVW5mb3J0dW5hdGVseSwgd2hpbGUgc29tZSBwb3Rl
bnRpYWwgcmFjZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5LApvdGhlcnMgYXJl
IG5vdC4gIFRoZXNlIGluY2x1ZGU6CgoxLiBXaGVuIG9uZSBwcm9jZXNzb3Ig
bW9kaWZpZXMgYSBzdWItc3VwZXJwYWdlIG1hcHBpbmcgd2hpbGUgYW5vdGhl
cgpwcm9jZXNzb3IgcmVwbGFjZXMgdGhlIGVudGlyZSByYW5nZSB3aXRoIGEg
c3VwZXJwYWdlLgoKVGFrZSB0aGUgZm9sbG93aW5nIGV4YW1wbGU6CgpTdXBw
b3NlIEwzW05dIHBvaW50cyB0byBMMi4gIEFuZCBzdXBwb3NlIHdlIGhhdmUg
dHdvIHByb2Nlc3NvcnMsIEEgYW5kCkIuCgoqIEEgd2Fsa3MgdGhlIHBhZ2V0
YWJsZXMsIGdldCBhIHBvaW50ZXIgdG8gTDIuCiogQiByZXBsYWNlcyBMM1tO
XSB3aXRoIGEgMUdpQiBtYXBwaW5nLgoqIEIgRnJlZXMgTDIKKiBBIHdyaXRl
cyBMMltNXSAjCgpUaGlzIGlzIHJhY2UgZXhhY2VyYmF0ZWQgYnkgdGhlIGZh
Y3QgdGhhdCB2aXJ0X3RvX3hlbl9sWzIxXWUgZG9lc24ndApoYW5kbGUgaGln
aGVyLWxldmVsIHN1cGVycGFnZXMgcHJvcGVybHk6IElmIHlvdSBjYWxsIHZp
cnRfeGVuX3RvX2wyZQpvbiBhIHZpcnR1YWwgYWRkcmVzcyB3aXRoaW4gYW4g
TDMgc3VwZXJwYWdlLCB5b3UnbGwgZWl0aGVyIGhpdCBhIEJVRygpCihtb3N0
IGxpa2VseSksIG9yIGdldCBhIHBvaW50ZXIgaW50byB0aGUgbWlkZGxlIG9m
IGEgZGF0YSBwYWdlOyBzYW1lCndpdGggdmlydF94ZW5fdG9fbDEgb24gYSB2
aXJ0dWFsIGFkZHJlc3Mgd2l0aGluIGVpdGhlciBhbiBMMyBvciBMMgpzdXBl
cnBhZ2UuCgpTbyB0YWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToKCiogQSBy
ZWFkcyBwbDNlIGFuZCBkaXNjb3ZlcnMgaXQgdG8gcG9pbnQgdG8gYW4gTDIu
CiogQiByZXBsYWNlcyBMM1tOXSB3aXRoIGEgMUdpQiBtYXBwaW5nCiogQSBj
YWxscyB2aXJ0X3RvX3hlbl9sMmUoKSBhbmQgaGl0cyB0aGUgQlVHX09OKCkg
IwoKMi4gV2hlbiB0d28gcHJvY2Vzc29ycyBzaW11bHRhbmVvdXNseSB0cnkg
dG8gcmVwbGFjZSBhIHN1Yi1zdXBlcnBhZ2UKbWFwcGluZyB3aXRoIGEgc3Vw
ZXJwYWdlIG1hcHBpbmcuCgpUYWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToK
ClN1cHBvc2UgTDNbTl0gcG9pbnRzIHRvIEwyLiAgQW5kIHN1cHBvc2Ugd2Ug
aGF2ZSB0d28gcHJvY2Vzc29ycywgQSBhbmQgQiwKYm90aCB0cnlpbmcgdG8g
cmVwbGFjZSBMM1tOXSB3aXRoIGEgc3VwZXJwYWdlLgoKKiBBIHdhbGtzIHRo
ZSBwYWdldGFibGVzLCBnZXQgYSBwb2ludGVyIHRvIHBsM2UsIGFuZCB0YWtl
cyBhIGNvcHkgb2wzZSBwb2ludGluZyB0byBMMi4KKiBCIHdhbGtzIHRoZSBw
YWdldGFibGVzLCBnZXRzIGEgcG9pbnRyZSB0byBwbDNlLCBhbmQgdGFrZXMg
YSBjb3B5IG9sM2UgcG9pbnRpbmcgdG8gTDIuCiogQSB3cml0ZXMgdGhlIG5l
dyB2YWx1ZSBpbnRvIEwzW05dCiogQiB3cml0ZXMgdGhlIG5ldyB2YWx1ZSBp
bnRvIEwzW05dCiogQSByZWN1cnNpdmVseSBmcmVlcyBhbGwgdGhlIEwxJ3Mg
dW5kZXIgTDIsIHRoZW4gZnJlZXMgTDIKKiBCIHJlY3Vyc2l2ZWx5IGRvdWJs
ZS1mcmVlcyBhbGwgdGhlIEwxJ3MgdW5kZXIgTDIsIHRoZW4gZG91YmxlLWZy
ZWVzIEwyICMKCkZpeCB0aGlzIGJ5IGdyYWJiaW5nIGEgbG9jayBmb3IgdGhl
IGVudGlyZXR5IG9mIHRoZSBtYXBwaW5nIHVwZGF0ZQpvcGVyYXRpb24uCgpS
YXRoZXIgdGhhbiBncmFiYmluZyBtYXBfcGdkaXJfbG9jayBmb3IgdGhlIGVu
dGlyZSBvcGVyYXRpb24sIGhvd2V2ZXIsCnJlcHVycG9zZSB0aGUgUEdUX2xv
Y2tlZCBiaXQgZnJvbSBMMydzIHBhZ2UtPnR5cGVfaW5mbyBhcyBhIGxvY2su
ClRoaXMgbWVhbnMgdGhhdCByYXRoZXIgdGhhbiBsb2NraW5nIHRoZSBlbnRp
cmUgYWRkcmVzcyBzcGFjZSwgd2UKIm9ubHkiIGxvY2sgYSBzaW5nbGUgNTEy
R2lCIGNodW5rIG9mIGh5cGVydmlzb3IgYWRkcmVzcyBzcGFjZSBhdCBhCnRp
bWUuCgpUaGVyZSB3YXMgYSBwcm9wb3NhbCBmb3IgYSBsb2NrLWFuZC1yZXZl
cmlmeSBhcHByb2FjaCwgd2hlcmUgd2Ugd2Fsawp0aGUgcGFnZXRhYmxlcyB0
byB0aGUgcG9pbnQgd2hlcmUgd2UgZGVjaWRlIHdoYXQgdG8gZG87IHRoZW4g
Z3JhYiB0aGUKbWFwX3BnZGlyX2xvY2ssIHJlLXZlcmlmeSB0aGUgaW5mb3Jt
YXRpb24gd2UgY29sbGVjdGVkIHdpdGhvdXQgdGhlCmxvY2ssIGFuZCBmaW5h
bGx5IG1ha2UgdGhlIGNoYW5nZSAoc3RhcnRpbmcgb3ZlciBhZ2FpbiBpZiBh
bnl0aGluZyBoYWQKY2hhbmdlZCkuICBXaXRob3V0IGJlaW5nIGFibGUgdG8g
Z3VhcmFudGVlIHRoYXQgdGhlIEwyIHRhYmxlIHdhc24ndApmcmVlZCwgaG93
ZXZlciwgdGhhdCBtZWFucyBldmVyeSByZWFkIHdvdWxkIG5lZWQgdG8gYmUg
Y29uc2lkZXJlZApwb3RlbnRpYWxseSB1bnNhZmUuICBUaGlua2luZyBjYXJl
ZnVsbHkgYWJvdXQgdGhhdCBpcyBwcm9iYWJseQpzb21ldGhpbmcgdGhhdCB3
YW50cyB0byBiZSBkb25lIG9uIHB1YmxpYywgbm90IHVuZGVyIHRpbWUgcHJl
c3N1cmUuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5
OiBIb25neWFuIFhpYSA8aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSG9uZ3lhbiBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25l
ZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4
LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZpbGUg
Y2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IGJmZjI2ODllNjAuLmQ2YmE4YzRiYjQgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0yMTk3LDYgKzIxOTcsNTAgQEAgdm9pZCBwYWdlX3VubG9jayhzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIGN1cnJlbnRfbG9ja2VkX3BhZ2Vfc2V0
KE5VTEwpOwogfQogCisvKgorICogTDMgdGFibGUgbG9ja3M6CisgKgorICog
VXNlZCBmb3Igc2VyaWFsaXphdGlvbiBpbiBtYXBfcGFnZXNfdG9feGVuKCkg
YW5kIG1vZGlmeV94ZW5fbWFwcGluZ3MoKS4KKyAqCisgKiBGb3IgWGVuIFBU
IHBhZ2VzLCB0aGUgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gaXMgdW51c2Vk
IGFuZCBpdCBpcyBzYWZlIHRvCisgKiByZXVzZSB0aGUgUEdUX2xvY2tlZCBm
bGFnLiBUaGlzIGxvY2sgaXMgdGFrZW4gb25seSB3aGVuIHdlIG1vdmUgZG93
biB0byBMMworICogdGFibGVzIGFuZCBiZWxvdywgc2luY2UgTDQgKGFuZCBh
Ym92ZSwgZm9yIDUtbGV2ZWwgcGFnaW5nKSBpcyBzdGlsbCBnbG9iYWxseQor
ICogcHJvdGVjdGVkIGJ5IG1hcF9wZ2Rpcl9sb2NrLgorICoKKyAqIFBWIE1N
VSB1cGRhdGUgaHlwZXJjYWxscyBjYWxsIG1hcF9wYWdlc190b194ZW4gd2hp
bGUgaG9sZGluZyBhIHBhZ2UncyBwYWdlX2xvY2soKS4KKyAqIFRoaXMgaGFz
IHR3byBpbXBsaWNhdGlvbnM6CisgKiAtIFdlIGNhbm5vdCByZXVzZSByZXVz
ZSBjdXJyZW50X2xvY2tlZF9wYWdlXyogZm9yIGRlYnVnZ2luZworICogLSBU
byBhdm9pZCB0aGUgY2hhbmNlIG9mIGRlYWRsb2NrLCBldmVuIGZvciBkaWZm
ZXJlbnQgcGFnZXMsIHdlCisgKiAgIG11c3QgbmV2ZXIgZ3JhYiBwYWdlX2xv
Y2soKSBhZnRlciBncmFiYmluZyBsM3RfbG9jaygpLiAgVGhpcworICogICBp
bmNsdWRlcyBhbnkgcGFnZV9sb2NrKCktYmFzZWQgbG9ja3MsIHN1Y2ggYXMK
KyAqICAgbWVtX3NoYXJpbmdfcGFnZV9sb2NrKCkuCisgKgorICogQWxzbyBu
b3RlIHRoYXQgd2UgZ3JhYiB0aGUgbWFwX3BnZGlyX2xvY2sgd2hpbGUgaG9s
ZGluZyB0aGUKKyAqIGwzdF9sb2NrKCksIHNvIHRvIGF2b2lkIGRlYWRsb2Nr
IHdlIG11c3QgYXZvaWQgZ3JhYmJpbmcgdGhlbSBpbgorICogcmV2ZXJzZSBv
cmRlci4KKyAqLworc3RhdGljIHZvaWQgbDN0X2xvY2soc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54OworCisg
ICAgZG8geworICAgICAgICB3aGlsZSAoICh4ID0gcGFnZS0+dS5pbnVzZS50
eXBlX2luZm8pICYgUEdUX2xvY2tlZCApCisgICAgICAgICAgICBjcHVfcmVs
YXgoKTsKKyAgICAgICAgbnggPSB4IHwgUEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggY21weGNoZygmcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIHgsIG54
KSAhPSB4ICk7Cit9CisKK3N0YXRpYyB2b2lkIGwzdF91bmxvY2soc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54
LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2luZm87CisKKyAgICBkbyB7Cisg
ICAgICAgIHggPSB5OworICAgICAgICBCVUdfT04oISh4ICYgUEdUX2xvY2tl
ZCkpOworICAgICAgICBueCA9IHggJiB+UEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggKHkgPSBjbXB4Y2hnKCZwYWdlLT51LmludXNlLnR5cGVfaW5mbywg
eCwgbngpKSAhPSB4ICk7Cit9CisKICNpZmRlZiBDT05GSUdfUFYKIC8qCiAg
KiBQVEUgZmxhZ3MgdGhhdCBhIGd1ZXN0IG1heSBjaGFuZ2Ugd2l0aG91dCBy
ZS12YWxpZGF0aW5nIHRoZSBQVEUuCkBAIC01MjE3LDYgKzUyNjEsMjMgQEAg
bDFfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9uZyB2
KQogICAgICAgICAgICAgICAgICAgICAgICAgIGZsdXNoX2FyZWFfbG9jYWwo
KGNvbnN0IHZvaWQgKil2LCBmKSA6IFwKICAgICAgICAgICAgICAgICAgICAg
ICAgICBmbHVzaF9hcmVhX2FsbCgoY29uc3Qgdm9pZCAqKXYsIGYpKQogCisj
ZGVmaW5lIEwzVF9JTklUKHBhZ2UpIChwYWdlKSA9IFpFUk9fQkxPQ0tfUFRS
CisKKyNkZWZpbmUgTDNUX0xPQ0socGFnZSkgICAgICAgIFwKKyAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBsb2NraW5n
ICkgICAgICAgIFwKKyAgICAgICAgICAgIGwzdF9sb2NrKHBhZ2UpOyAgIFwK
KyAgICB9IHdoaWxlICggZmFsc2UgKQorCisjZGVmaW5lIEwzVF9VTkxPQ0so
cGFnZSkgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgIGlmICggbG9ja2luZyAmJiAocGFnZSkgIT0gWkVST19CTE9DS19Q
VFIgKSBcCisgICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICBsM3RfdW5sb2NrKHBhZ2Up
OyAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAocGFnZSkg
PSBaRVJPX0JMT0NLX1BUUjsgICAgICAgICAgICAgICBcCisgICAgICAgIH0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgfSB3aGlsZSAoIGZhbHNlICkKKwogaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgdW5zaWduZWQgbG9uZyB2aXJ0LAogICAgIG1mbl90IG1mbiwKQEAg
LTUyMjgsNiArNTI4OSw3IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAg
IGwxX3BnZW50cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQg
IGk7CiAgICAgaW50IHJjID0gLUVOT01FTTsKKyAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpjdXJyZW50X2wzcGFnZTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhv
bGRmKSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50
IG9fID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUyNDMsMTMg
KzUzMDUsMjAgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgfSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKIH0gd2hp
bGUgKDApCiAKKyAgICBMM1RfSU5JVChjdXJyZW50X2wzcGFnZSk7CisKICAg
ICB3aGlsZSAoIG5yX21mbnMgIT0gMCApCiAgICAgewotICAgICAgICBsM19w
Z2VudHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7
CisgICAgICAgIGwzX3BnZW50cnlfdCAqcGwzZSwgb2wzZTsKIAorICAgICAg
ICBMM1RfVU5MT0NLKGN1cnJlbnRfbDNwYWdlKTsKKworICAgICAgICBwbDNl
ID0gdmlydF90b194ZW5fbDNlKHZpcnQpOwogICAgICAgICBpZiAoICFwbDNl
ICkKICAgICAgICAgICAgIGdvdG8gb3V0OwogCisgICAgICAgIGN1cnJlbnRf
bDNwYWdlID0gdmlydF90b19wYWdlKHBsM2UpOworICAgICAgICBMM1RfTE9D
SyhjdXJyZW50X2wzcGFnZSk7CiAgICAgICAgIG9sM2UgPSAqcGwzZTsKIAog
ICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpAQCAtNTU4Myw2ICs1
NjUyLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgcmMgPSAwOwog
CiAgb3V0OgorICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOwogICAg
IHJldHVybiByYzsKIH0KIApAQCAtNTYxMSw2ICs1NjgxLDcgQEAgaW50IG1v
ZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBs
b25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICB1bnNpZ25lZCBpbnQgIGk7
CiAgICAgdW5zaWduZWQgbG9uZyB2ID0gczsKICAgICBpbnQgcmMgPSAtRU5P
TUVNOworICAgIHN0cnVjdCBwYWdlX2luZm8gKmN1cnJlbnRfbDNwYWdlOwog
CiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBiZSBh
bHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxfUEFH
RV9SV3xfUEFHRV9QUkVTRU5UKQpAQCAtNTYxOSwxMSArNTY5MCwyMiBAQCBp
bnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2ln
bmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgIEFTU0VSVChJU19B
TElHTkVEKHMsIFBBR0VfU0laRSkpOwogICAgIEFTU0VSVChJU19BTElHTkVE
KGUsIFBBR0VfU0laRSkpOwogCisgICAgTDNUX0lOSVQoY3VycmVudF9sM3Bh
Z2UpOworCiAgICAgd2hpbGUgKCB2IDwgZSApCiAgICAgewotICAgICAgICBs
M19wZ2VudHJ5X3QgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2Uodik7CisgICAg
ICAgIGwzX3BnZW50cnlfdCAqcGwzZTsKKworICAgICAgICBMM1RfVU5MT0NL
KGN1cnJlbnRfbDNwYWdlKTsKIAotICAgICAgICBpZiAoICFwbDNlIHx8ICEo
bDNlX2dldF9mbGFncygqcGwzZSkgJiBfUEFHRV9QUkVTRU5UKSApCisgICAg
ICAgIHBsM2UgPSB2aXJ0X3RvX3hlbl9sM2Uodik7CisgICAgICAgIGlmICgg
IXBsM2UgKQorICAgICAgICAgICAgZ290byBvdXQ7CisKKyAgICAgICAgY3Vy
cmVudF9sM3BhZ2UgPSB2aXJ0X3RvX3BhZ2UocGwzZSk7CisgICAgICAgIEwz
VF9MT0NLKGN1cnJlbnRfbDNwYWdlKTsKKworICAgICAgICBpZiAoICEobDNl
X2dldF9mbGFncygqcGwzZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAg
IHsKICAgICAgICAgICAgIC8qIENvbmZpcm0gdGhlIGNhbGxlciBpc24ndCB0
cnlpbmcgdG8gY3JlYXRlIG5ldyBtYXBwaW5ncy4gKi8KICAgICAgICAgICAg
IEFTU0VSVCghKG5mICYgX1BBR0VfUFJFU0VOVCkpOwpAQCAtNTg0MSw5ICs1
OTIzLDEzIEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxv
bmcgcywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAg
cmMgPSAwOwogCiAgb3V0OgorICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3Bh
Z2UpOwogICAgIHJldHVybiByYzsKIH0KIAorI3VuZGVmIEwzVF9MT0NLCisj
dW5kZWYgTDNUX1VOTE9DSworCiAjdW5kZWYgZmx1c2hfYXJlYQogCiBpbnQg
ZGVzdHJveV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25l
ZCBsb25nIGUpCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.13/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Disposition: attachment;
 filename="xsa345-4.13/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Transfer-Encoding: base64

RnJvbSBiM2UwZDRlMzdiNzkwMjUzM2E0NjM4MTIzNzQ5NDdkNGQ2ZDJlNDYz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQxICswMDAwClN1YmplY3Q6IFtQQVRDSCAxLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbWFwX3BhZ2VzX3RvX3hlbiB0byBoYXZlIG9ubHkgYSBzaW5nbGUKIGV4
aXQgcGF0aAoKV2Ugd2lsbCBzb29uIG5lZWQgdG8gcGVyZm9ybSBjbGVhbi11
cHMgYmVmb3JlIHJldHVybmluZy4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zNDUuCgpSZXBvcnRlZC1ieTogSG9uZ3lh
biBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IFdl
aSBMaXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhv
bmd5YW4gWGlhIDxob25neXhpYUBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkFj
a2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgfCAxNyArKysrKysrKysrKy0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDExIGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94
ODYvbW0uYwppbmRleCAzMGRmZmI2OGU4Li4xMzNhMzkzODc1IDEwMDY0NAot
LS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0u
YwpAQCAtNTE4Nyw2ICs1MTg3LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgbDJfcGdlbnRyeV90ICpwbDJlLCBvbDJlOwogICAgIGwxX3BnZW50
cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CisgICAg
aW50IHJjID0gLUVOT01FTTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhvbGRm
KSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50IG9f
ID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUyMDcsNyArNTIw
OCw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICBsM19wZ2Vu
dHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7CiAK
ICAgICAgICAgaWYgKCAhcGwzZSApCi0gICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgIG9sM2Ug
PSAqcGwzZTsKIAogICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpA
QCAtNTI5NSw3ICs1Mjk3LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAK
ICAgICAgICAgICAgIHBsMmUgPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAg
ICAgICAgICAgICBpZiAoIHBsMmUgPT0gTlVMTCApCi0gICAgICAgICAgICAg
ICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAgZ290byBvdXQ7
CiAKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDJfUEFHRVRBQkxF
X0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgbDJlX3dyaXRlKHBs
MmUgKyBpLApAQCAtNTMyNCw3ICs1MzI2LDcgQEAgaW50IG1hcF9wYWdlc190
b194ZW4oCiAKICAgICAgICAgcGwyZSA9IHZpcnRfdG9feGVuX2wyZSh2aXJ0
KTsKICAgICAgICAgaWYgKCAhcGwyZSApCi0gICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OwogCiAgICAgICAgIGlm
ICggKCgoKHZpcnQgPj4gUEFHRV9TSElGVCkgfCBtZm5feChtZm4pKSAmCiAg
ICAgICAgICAgICAgICAoKDF1IDw8IFBBR0VUQUJMRV9PUkRFUikgLSAxKSkg
PT0gMCkgJiYKQEAgLTUzNjcsNyArNTM2OSw3IEBAIGludCBtYXBfcGFnZXNf
dG9feGVuKAogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBsMWUg
PSB2aXJ0X3RvX3hlbl9sMWUodmlydCk7CiAgICAgICAgICAgICAgICAgaWYg
KCBwbDFlID09IE5VTEwgKQotICAgICAgICAgICAgICAgICAgICByZXR1cm4g
LUVOT01FTTsKKyAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7CiAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggbDJlX2dldF9mbGFn
cygqcGwyZSkgJiBfUEFHRV9QU0UgKQogICAgICAgICAgICAgewpAQCAtNTM5
NCw3ICs1Mzk2LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAKICAgICAg
ICAgICAgICAgICBwbDFlID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAg
ICAgICAgICAgICAgIGlmICggcGwxZSA9PSBOVUxMICkKLSAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAgICAgICAg
IGdvdG8gb3V0OwogCiAgICAgICAgICAgICAgICAgZm9yICggaSA9IDA7IGkg
PCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAgICAgICAg
ICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLApAQCAtNTUzOCw3ICs1NTQwLDEw
IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogCiAjdW5kZWYgZmx1c2hfZmxh
Z3MKIAotICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAg
ICByZXR1cm4gcmM7CiB9CiAKIGludCBwb3B1bGF0ZV9wdF9yYW5nZSh1bnNp
Z25lZCBsb25nIHZpcnQsIHVuc2lnbmVkIGxvbmcgbnJfbWZucykKLS0gCjIu
MjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.13/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Disposition: attachment;
 filename="xsa345-4.13/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Transfer-Encoding: base64

RnJvbSA5ZjZmMzViODMzZDI5NWFjYWFhMmQ4ZmY4Y2YzMDliZjY4OGNmZDUw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQyICswMDAwClN1YmplY3Q6IFtQQVRDSCAyLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbW9kaWZ5X3hlbl9tYXBwaW5ncyB0byBoYXZlIG9uZSBleGl0CiBwYXRo
CgpXZSB3aWxsIHNvb24gbmVlZCB0byBwZXJmb3JtIGNsZWFuLXVwcyBiZWZv
cmUgcmV0dXJuaW5nLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5OiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8
d2VpLmxpdTJAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSG9uZ3lhbiBY
aWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJj
aC94ODYvbW0uYyB8IDEyICsrKysrKysrKy0tLQogMSBmaWxlIGNoYW5nZWQs
IDkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4
IDEzM2EzOTM4NzUuLmFmNzI2ZDMyNzQgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC01NTcwLDYg
KzU1NzAsNyBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBs
b25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAg
IGwxX3BnZW50cnlfdCAqcGwxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CiAg
ICAgdW5zaWduZWQgbG9uZyB2ID0gczsKKyAgICBpbnQgcmMgPSAtRU5PTUVN
OwogCiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBi
ZSBhbHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxf
UEFHRV9SV3xfUEFHRV9QUkVTRU5UKQpAQCAtNTYxMSw3ICs1NjEyLDggQEAg
aW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNp
Z25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAgIC8q
IFBBR0UxR0I6IHNoYXR0ZXIgdGhlIHN1cGVycGFnZSBhbmQgZmFsbCB0aHJv
dWdoLiAqLwogICAgICAgICAgICAgcGwyZSA9IGFsbG9jX3hlbl9wYWdldGFi
bGUoKTsKICAgICAgICAgICAgIGlmICggIXBsMmUgKQotICAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAgICAgIGdvdG8gb3V0
OworCiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VUQUJM
RV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgIGwyZV93cml0ZShw
bDJlICsgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgbDJlX2Zyb21f
cGZuKGwzZV9nZXRfcGZuKCpwbDNlKSArCkBAIC01NjY2LDcgKzU2NjgsOCBA
QCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVu
c2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgICAgICAgICAg
ICAgIC8qIFBTRTogc2hhdHRlciB0aGUgc3VwZXJwYWdlIGFuZCB0cnkgYWdh
aW4uICovCiAgICAgICAgICAgICAgICAgcGwxZSA9IGFsbG9jX3hlbl9wYWdl
dGFibGUoKTsKICAgICAgICAgICAgICAgICBpZiAoICFwbDFlICkKLSAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgICAgICAg
ICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgICAgICAgICAgZm9yICggaSA9
IDA7IGkgPCBMMV9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAg
ICAgICAgICAgICAgbDFlX3dyaXRlKCZwbDFlW2ldLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbDFlX2Zyb21fcGZuKGwyZV9nZXRfcGZuKCpw
bDJlKSArIGksCkBAIC01Nzk1LDcgKzU3OTgsMTAgQEAgaW50IG1vZGlmeV94
ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUs
IHVuc2lnbmVkIGludCBuZikKICAgICBmbHVzaF9hcmVhKE5VTEwsIEZMVVNI
X1RMQl9HTE9CQUwpOwogCiAjdW5kZWYgRkxBR1NfTUFTSwotICAgIHJldHVy
biAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAgICByZXR1cm4gcmM7CiB9
CiAKICN1bmRlZiBmbHVzaF9hcmVhCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.13/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Disposition: attachment;
 filename="xsa345-4.13/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Transfer-Encoding: base64

RnJvbSAwZmY5YTg0NTNkYzQ3Y2Q0N2VlZTk2NTlkNTkxNmFmYjUwOTRlODcx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KRGF0ZTogU2F0LCAxMSBKYW4gMjAyMCAy
MTo1Nzo0MyArMDAwMApTdWJqZWN0OiBbUEFUQ0ggMy8zXSB4ODYvbW06IFBy
ZXZlbnQgc29tZSByYWNlcyBpbiBoeXBlcnZpc29yIG1hcHBpbmcgdXBkYXRl
cwoKbWFwX3BhZ2VzX3RvX3hlbiB3aWxsIGF0dGVtcHQgdG8gY29hbGVzY2Ug
bWFwcGluZ3MgaW50byAyTWlCIGFuZCAxR2lCCnN1cGVycGFnZXMgaWYgcG9z
c2libGUsIHRvIG1heGltaXplIFRMQiBlZmZpY2llbmN5LiAgVGhpcyBtZWFu
cyBib3RoCnJlcGxhY2luZyBzdXBlcnBhZ2UgZW50cmllcyB3aXRoIHNtYWxs
ZXIgZW50cmllcywgYW5kIHJlcGxhY2luZwpzbWFsbGVyIGVudHJpZXMgd2l0
aCBzdXBlcnBhZ2VzLgoKVW5mb3J0dW5hdGVseSwgd2hpbGUgc29tZSBwb3Rl
bnRpYWwgcmFjZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5LApvdGhlcnMgYXJl
IG5vdC4gIFRoZXNlIGluY2x1ZGU6CgoxLiBXaGVuIG9uZSBwcm9jZXNzb3Ig
bW9kaWZpZXMgYSBzdWItc3VwZXJwYWdlIG1hcHBpbmcgd2hpbGUgYW5vdGhl
cgpwcm9jZXNzb3IgcmVwbGFjZXMgdGhlIGVudGlyZSByYW5nZSB3aXRoIGEg
c3VwZXJwYWdlLgoKVGFrZSB0aGUgZm9sbG93aW5nIGV4YW1wbGU6CgpTdXBw
b3NlIEwzW05dIHBvaW50cyB0byBMMi4gIEFuZCBzdXBwb3NlIHdlIGhhdmUg
dHdvIHByb2Nlc3NvcnMsIEEgYW5kCkIuCgoqIEEgd2Fsa3MgdGhlIHBhZ2V0
YWJsZXMsIGdldCBhIHBvaW50ZXIgdG8gTDIuCiogQiByZXBsYWNlcyBMM1tO
XSB3aXRoIGEgMUdpQiBtYXBwaW5nLgoqIEIgRnJlZXMgTDIKKiBBIHdyaXRl
cyBMMltNXSAjCgpUaGlzIGlzIHJhY2UgZXhhY2VyYmF0ZWQgYnkgdGhlIGZh
Y3QgdGhhdCB2aXJ0X3RvX3hlbl9sWzIxXWUgZG9lc24ndApoYW5kbGUgaGln
aGVyLWxldmVsIHN1cGVycGFnZXMgcHJvcGVybHk6IElmIHlvdSBjYWxsIHZp
cnRfeGVuX3RvX2wyZQpvbiBhIHZpcnR1YWwgYWRkcmVzcyB3aXRoaW4gYW4g
TDMgc3VwZXJwYWdlLCB5b3UnbGwgZWl0aGVyIGhpdCBhIEJVRygpCihtb3N0
IGxpa2VseSksIG9yIGdldCBhIHBvaW50ZXIgaW50byB0aGUgbWlkZGxlIG9m
IGEgZGF0YSBwYWdlOyBzYW1lCndpdGggdmlydF94ZW5fdG9fbDEgb24gYSB2
aXJ0dWFsIGFkZHJlc3Mgd2l0aGluIGVpdGhlciBhbiBMMyBvciBMMgpzdXBl
cnBhZ2UuCgpTbyB0YWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToKCiogQSBy
ZWFkcyBwbDNlIGFuZCBkaXNjb3ZlcnMgaXQgdG8gcG9pbnQgdG8gYW4gTDIu
CiogQiByZXBsYWNlcyBMM1tOXSB3aXRoIGEgMUdpQiBtYXBwaW5nCiogQSBj
YWxscyB2aXJ0X3RvX3hlbl9sMmUoKSBhbmQgaGl0cyB0aGUgQlVHX09OKCkg
IwoKMi4gV2hlbiB0d28gcHJvY2Vzc29ycyBzaW11bHRhbmVvdXNseSB0cnkg
dG8gcmVwbGFjZSBhIHN1Yi1zdXBlcnBhZ2UKbWFwcGluZyB3aXRoIGEgc3Vw
ZXJwYWdlIG1hcHBpbmcuCgpUYWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToK
ClN1cHBvc2UgTDNbTl0gcG9pbnRzIHRvIEwyLiAgQW5kIHN1cHBvc2Ugd2Ug
aGF2ZSB0d28gcHJvY2Vzc29ycywgQSBhbmQgQiwKYm90aCB0cnlpbmcgdG8g
cmVwbGFjZSBMM1tOXSB3aXRoIGEgc3VwZXJwYWdlLgoKKiBBIHdhbGtzIHRo
ZSBwYWdldGFibGVzLCBnZXQgYSBwb2ludGVyIHRvIHBsM2UsIGFuZCB0YWtl
cyBhIGNvcHkgb2wzZSBwb2ludGluZyB0byBMMi4KKiBCIHdhbGtzIHRoZSBw
YWdldGFibGVzLCBnZXRzIGEgcG9pbnRyZSB0byBwbDNlLCBhbmQgdGFrZXMg
YSBjb3B5IG9sM2UgcG9pbnRpbmcgdG8gTDIuCiogQSB3cml0ZXMgdGhlIG5l
dyB2YWx1ZSBpbnRvIEwzW05dCiogQiB3cml0ZXMgdGhlIG5ldyB2YWx1ZSBp
bnRvIEwzW05dCiogQSByZWN1cnNpdmVseSBmcmVlcyBhbGwgdGhlIEwxJ3Mg
dW5kZXIgTDIsIHRoZW4gZnJlZXMgTDIKKiBCIHJlY3Vyc2l2ZWx5IGRvdWJs
ZS1mcmVlcyBhbGwgdGhlIEwxJ3MgdW5kZXIgTDIsIHRoZW4gZG91YmxlLWZy
ZWVzIEwyICMKCkZpeCB0aGlzIGJ5IGdyYWJiaW5nIGEgbG9jayBmb3IgdGhl
IGVudGlyZXR5IG9mIHRoZSBtYXBwaW5nIHVwZGF0ZQpvcGVyYXRpb24uCgpS
YXRoZXIgdGhhbiBncmFiYmluZyBtYXBfcGdkaXJfbG9jayBmb3IgdGhlIGVu
dGlyZSBvcGVyYXRpb24sIGhvd2V2ZXIsCnJlcHVycG9zZSB0aGUgUEdUX2xv
Y2tlZCBiaXQgZnJvbSBMMydzIHBhZ2UtPnR5cGVfaW5mbyBhcyBhIGxvY2su
ClRoaXMgbWVhbnMgdGhhdCByYXRoZXIgdGhhbiBsb2NraW5nIHRoZSBlbnRp
cmUgYWRkcmVzcyBzcGFjZSwgd2UKIm9ubHkiIGxvY2sgYSBzaW5nbGUgNTEy
R2lCIGNodW5rIG9mIGh5cGVydmlzb3IgYWRkcmVzcyBzcGFjZSBhdCBhCnRp
bWUuCgpUaGVyZSB3YXMgYSBwcm9wb3NhbCBmb3IgYSBsb2NrLWFuZC1yZXZl
cmlmeSBhcHByb2FjaCwgd2hlcmUgd2Ugd2Fsawp0aGUgcGFnZXRhYmxlcyB0
byB0aGUgcG9pbnQgd2hlcmUgd2UgZGVjaWRlIHdoYXQgdG8gZG87IHRoZW4g
Z3JhYiB0aGUKbWFwX3BnZGlyX2xvY2ssIHJlLXZlcmlmeSB0aGUgaW5mb3Jt
YXRpb24gd2UgY29sbGVjdGVkIHdpdGhvdXQgdGhlCmxvY2ssIGFuZCBmaW5h
bGx5IG1ha2UgdGhlIGNoYW5nZSAoc3RhcnRpbmcgb3ZlciBhZ2FpbiBpZiBh
bnl0aGluZyBoYWQKY2hhbmdlZCkuICBXaXRob3V0IGJlaW5nIGFibGUgdG8g
Z3VhcmFudGVlIHRoYXQgdGhlIEwyIHRhYmxlIHdhc24ndApmcmVlZCwgaG93
ZXZlciwgdGhhdCBtZWFucyBldmVyeSByZWFkIHdvdWxkIG5lZWQgdG8gYmUg
Y29uc2lkZXJlZApwb3RlbnRpYWxseSB1bnNhZmUuICBUaGlua2luZyBjYXJl
ZnVsbHkgYWJvdXQgdGhhdCBpcyBwcm9iYWJseQpzb21ldGhpbmcgdGhhdCB3
YW50cyB0byBiZSBkb25lIG9uIHB1YmxpYywgbm90IHVuZGVyIHRpbWUgcHJl
c3N1cmUuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5
OiBIb25neWFuIFhpYSA8aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSG9uZ3lhbiBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25l
ZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4
LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZpbGUg
Y2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IGFmNzI2ZDMyNzQuLmQ2YTA3NjFmNDMgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0yMTY3LDYgKzIxNjcsNTAgQEAgdm9pZCBwYWdlX3VubG9jayhzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIGN1cnJlbnRfbG9ja2VkX3BhZ2Vfc2V0
KE5VTEwpOwogfQogCisvKgorICogTDMgdGFibGUgbG9ja3M6CisgKgorICog
VXNlZCBmb3Igc2VyaWFsaXphdGlvbiBpbiBtYXBfcGFnZXNfdG9feGVuKCkg
YW5kIG1vZGlmeV94ZW5fbWFwcGluZ3MoKS4KKyAqCisgKiBGb3IgWGVuIFBU
IHBhZ2VzLCB0aGUgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gaXMgdW51c2Vk
IGFuZCBpdCBpcyBzYWZlIHRvCisgKiByZXVzZSB0aGUgUEdUX2xvY2tlZCBm
bGFnLiBUaGlzIGxvY2sgaXMgdGFrZW4gb25seSB3aGVuIHdlIG1vdmUgZG93
biB0byBMMworICogdGFibGVzIGFuZCBiZWxvdywgc2luY2UgTDQgKGFuZCBh
Ym92ZSwgZm9yIDUtbGV2ZWwgcGFnaW5nKSBpcyBzdGlsbCBnbG9iYWxseQor
ICogcHJvdGVjdGVkIGJ5IG1hcF9wZ2Rpcl9sb2NrLgorICoKKyAqIFBWIE1N
VSB1cGRhdGUgaHlwZXJjYWxscyBjYWxsIG1hcF9wYWdlc190b194ZW4gd2hp
bGUgaG9sZGluZyBhIHBhZ2UncyBwYWdlX2xvY2soKS4KKyAqIFRoaXMgaGFz
IHR3byBpbXBsaWNhdGlvbnM6CisgKiAtIFdlIGNhbm5vdCByZXVzZSByZXVz
ZSBjdXJyZW50X2xvY2tlZF9wYWdlXyogZm9yIGRlYnVnZ2luZworICogLSBU
byBhdm9pZCB0aGUgY2hhbmNlIG9mIGRlYWRsb2NrLCBldmVuIGZvciBkaWZm
ZXJlbnQgcGFnZXMsIHdlCisgKiAgIG11c3QgbmV2ZXIgZ3JhYiBwYWdlX2xv
Y2soKSBhZnRlciBncmFiYmluZyBsM3RfbG9jaygpLiAgVGhpcworICogICBp
bmNsdWRlcyBhbnkgcGFnZV9sb2NrKCktYmFzZWQgbG9ja3MsIHN1Y2ggYXMK
KyAqICAgbWVtX3NoYXJpbmdfcGFnZV9sb2NrKCkuCisgKgorICogQWxzbyBu
b3RlIHRoYXQgd2UgZ3JhYiB0aGUgbWFwX3BnZGlyX2xvY2sgd2hpbGUgaG9s
ZGluZyB0aGUKKyAqIGwzdF9sb2NrKCksIHNvIHRvIGF2b2lkIGRlYWRsb2Nr
IHdlIG11c3QgYXZvaWQgZ3JhYmJpbmcgdGhlbSBpbgorICogcmV2ZXJzZSBv
cmRlci4KKyAqLworc3RhdGljIHZvaWQgbDN0X2xvY2soc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54OworCisg
ICAgZG8geworICAgICAgICB3aGlsZSAoICh4ID0gcGFnZS0+dS5pbnVzZS50
eXBlX2luZm8pICYgUEdUX2xvY2tlZCApCisgICAgICAgICAgICBjcHVfcmVs
YXgoKTsKKyAgICAgICAgbnggPSB4IHwgUEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggY21weGNoZygmcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIHgsIG54
KSAhPSB4ICk7Cit9CisKK3N0YXRpYyB2b2lkIGwzdF91bmxvY2soc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54
LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2luZm87CisKKyAgICBkbyB7Cisg
ICAgICAgIHggPSB5OworICAgICAgICBCVUdfT04oISh4ICYgUEdUX2xvY2tl
ZCkpOworICAgICAgICBueCA9IHggJiB+UEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggKHkgPSBjbXB4Y2hnKCZwYWdlLT51LmludXNlLnR5cGVfaW5mbywg
eCwgbngpKSAhPSB4ICk7Cit9CisKICNpZmRlZiBDT05GSUdfUFYKIC8qCiAg
KiBQVEUgZmxhZ3MgdGhhdCBhIGd1ZXN0IG1heSBjaGFuZ2Ugd2l0aG91dCBy
ZS12YWxpZGF0aW5nIHRoZSBQVEUuCkBAIC01MTc3LDYgKzUyMjEsMjMgQEAg
bDFfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9uZyB2
KQogICAgICAgICAgICAgICAgICAgICAgICAgIGZsdXNoX2FyZWFfbG9jYWwo
KGNvbnN0IHZvaWQgKil2LCBmKSA6IFwKICAgICAgICAgICAgICAgICAgICAg
ICAgICBmbHVzaF9hcmVhX2FsbCgoY29uc3Qgdm9pZCAqKXYsIGYpKQogCisj
ZGVmaW5lIEwzVF9JTklUKHBhZ2UpIChwYWdlKSA9IFpFUk9fQkxPQ0tfUFRS
CisKKyNkZWZpbmUgTDNUX0xPQ0socGFnZSkgICAgICAgIFwKKyAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBsb2NraW5n
ICkgICAgICAgIFwKKyAgICAgICAgICAgIGwzdF9sb2NrKHBhZ2UpOyAgIFwK
KyAgICB9IHdoaWxlICggZmFsc2UgKQorCisjZGVmaW5lIEwzVF9VTkxPQ0so
cGFnZSkgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgIGlmICggbG9ja2luZyAmJiAocGFnZSkgIT0gWkVST19CTE9DS19Q
VFIgKSBcCisgICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICBsM3RfdW5sb2NrKHBhZ2Up
OyAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAocGFnZSkg
PSBaRVJPX0JMT0NLX1BUUjsgICAgICAgICAgICAgICBcCisgICAgICAgIH0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgfSB3aGlsZSAoIGZhbHNlICkKKwogaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgdW5zaWduZWQgbG9uZyB2aXJ0LAogICAgIG1mbl90IG1mbiwKQEAg
LTUxODgsNiArNTI0OSw3IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAg
IGwxX3BnZW50cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQg
IGk7CiAgICAgaW50IHJjID0gLUVOT01FTTsKKyAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpjdXJyZW50X2wzcGFnZTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhv
bGRmKSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50
IG9fID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUyMDMsMTMg
KzUyNjUsMjAgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgfSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKIH0gd2hp
bGUgKDApCiAKKyAgICBMM1RfSU5JVChjdXJyZW50X2wzcGFnZSk7CisKICAg
ICB3aGlsZSAoIG5yX21mbnMgIT0gMCApCiAgICAgewotICAgICAgICBsM19w
Z2VudHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7
CisgICAgICAgIGwzX3BnZW50cnlfdCAqcGwzZSwgb2wzZTsKIAorICAgICAg
ICBMM1RfVU5MT0NLKGN1cnJlbnRfbDNwYWdlKTsKKworICAgICAgICBwbDNl
ID0gdmlydF90b194ZW5fbDNlKHZpcnQpOwogICAgICAgICBpZiAoICFwbDNl
ICkKICAgICAgICAgICAgIGdvdG8gb3V0OwogCisgICAgICAgIGN1cnJlbnRf
bDNwYWdlID0gdmlydF90b19wYWdlKHBsM2UpOworICAgICAgICBMM1RfTE9D
SyhjdXJyZW50X2wzcGFnZSk7CiAgICAgICAgIG9sM2UgPSAqcGwzZTsKIAog
ICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpAQCAtNTU0Myw2ICs1
NjEyLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgcmMgPSAwOwog
CiAgb3V0OgorICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOwogICAg
IHJldHVybiByYzsKIH0KIApAQCAtNTU3MSw2ICs1NjQxLDcgQEAgaW50IG1v
ZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBs
b25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICB1bnNpZ25lZCBpbnQgIGk7
CiAgICAgdW5zaWduZWQgbG9uZyB2ID0gczsKICAgICBpbnQgcmMgPSAtRU5P
TUVNOworICAgIHN0cnVjdCBwYWdlX2luZm8gKmN1cnJlbnRfbDNwYWdlOwog
CiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBiZSBh
bHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxfUEFH
RV9SV3xfUEFHRV9QUkVTRU5UKQpAQCAtNTU3OSwxMSArNTY1MCwyMiBAQCBp
bnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2ln
bmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgIEFTU0VSVChJU19B
TElHTkVEKHMsIFBBR0VfU0laRSkpOwogICAgIEFTU0VSVChJU19BTElHTkVE
KGUsIFBBR0VfU0laRSkpOwogCisgICAgTDNUX0lOSVQoY3VycmVudF9sM3Bh
Z2UpOworCiAgICAgd2hpbGUgKCB2IDwgZSApCiAgICAgewotICAgICAgICBs
M19wZ2VudHJ5X3QgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2Uodik7CisgICAg
ICAgIGwzX3BnZW50cnlfdCAqcGwzZTsKKworICAgICAgICBMM1RfVU5MT0NL
KGN1cnJlbnRfbDNwYWdlKTsKIAotICAgICAgICBpZiAoICFwbDNlIHx8ICEo
bDNlX2dldF9mbGFncygqcGwzZSkgJiBfUEFHRV9QUkVTRU5UKSApCisgICAg
ICAgIHBsM2UgPSB2aXJ0X3RvX3hlbl9sM2Uodik7CisgICAgICAgIGlmICgg
IXBsM2UgKQorICAgICAgICAgICAgZ290byBvdXQ7CisKKyAgICAgICAgY3Vy
cmVudF9sM3BhZ2UgPSB2aXJ0X3RvX3BhZ2UocGwzZSk7CisgICAgICAgIEwz
VF9MT0NLKGN1cnJlbnRfbDNwYWdlKTsKKworICAgICAgICBpZiAoICEobDNl
X2dldF9mbGFncygqcGwzZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAg
IHsKICAgICAgICAgICAgIC8qIENvbmZpcm0gdGhlIGNhbGxlciBpc24ndCB0
cnlpbmcgdG8gY3JlYXRlIG5ldyBtYXBwaW5ncy4gKi8KICAgICAgICAgICAg
IEFTU0VSVCghKG5mICYgX1BBR0VfUFJFU0VOVCkpOwpAQCAtNTgwMSw5ICs1
ODgzLDEzIEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxv
bmcgcywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAg
cmMgPSAwOwogCiAgb3V0OgorICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3Bh
Z2UpOwogICAgIHJldHVybiByYzsKIH0KIAorI3VuZGVmIEwzVF9MT0NLCisj
dW5kZWYgTDNUX1VOTE9DSworCiAjdW5kZWYgZmx1c2hfYXJlYQogCiBpbnQg
ZGVzdHJveV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25l
ZCBsb25nIGUpCi0tIAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.14/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Disposition: attachment;
 filename="xsa345-4.14/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Transfer-Encoding: base64

RnJvbSBlOWM1YTllZTVlMmU4ODhmOGJiMDVjZjBhMzUzZWQ2MzUzMDBhYmUz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQxICswMDAwClN1YmplY3Q6IFtQQVRDSCAxLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbWFwX3BhZ2VzX3RvX3hlbiB0byBoYXZlIG9ubHkgYSBzaW5nbGUKIGV4
aXQgcGF0aAoKV2Ugd2lsbCBzb29uIG5lZWQgdG8gcGVyZm9ybSBjbGVhbi11
cHMgYmVmb3JlIHJldHVybmluZy4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zNDUuCgpSZXBvcnRlZC1ieTogSG9uZ3lh
biBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IFdl
aSBMaXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhv
bmd5YW4gWGlhIDxob25neXhpYUBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkFj
a2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgfCAxNyArKysrKysrKysrKy0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDExIGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94
ODYvbW0uYwppbmRleCA4MmJjNjc2NTUzLi4wM2Y2ZTZhYTYyIDEwMDY0NAot
LS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0u
YwpAQCAtNTA4OCw2ICs1MDg4LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgbDJfcGdlbnRyeV90ICpwbDJlLCBvbDJlOwogICAgIGwxX3BnZW50
cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CisgICAg
aW50IHJjID0gLUVOT01FTTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhvbGRm
KSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50IG9f
ID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUxMDgsNyArNTEw
OSw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICBsM19wZ2Vu
dHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7CiAK
ICAgICAgICAgaWYgKCAhcGwzZSApCi0gICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworCiAgICAgICAgIG9sM2Ug
PSAqcGwzZTsKIAogICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpA
QCAtNTE5OCw3ICs1MjAwLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAK
ICAgICAgICAgICAgIGwydCA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAg
ICAgICAgICAgIGlmICggbDJ0ID09IE5VTEwgKQotICAgICAgICAgICAgICAg
IHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAgICAgIGdvdG8gb3V0Owog
CiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VUQUJMRV9F
TlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAgIGwyZV93cml0ZShsMnQg
KyBpLApAQCAtNTIyNyw3ICs1MjI5LDcgQEAgaW50IG1hcF9wYWdlc190b194
ZW4oCiAKICAgICAgICAgcGwyZSA9IHZpcnRfdG9feGVuX2wyZSh2aXJ0KTsK
ICAgICAgICAgaWYgKCAhcGwyZSApCi0gICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OwogCiAgICAgICAgIGlmICgg
KCgoKHZpcnQgPj4gUEFHRV9TSElGVCkgfCBtZm5feChtZm4pKSAmCiAgICAg
ICAgICAgICAgICAoKDF1IDw8IFBBR0VUQUJMRV9PUkRFUikgLSAxKSkgPT0g
MCkgJiYKQEAgLTUyNzEsNyArNTI3Myw3IEBAIGludCBtYXBfcGFnZXNfdG9f
eGVuKAogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBsMWUgPSB2
aXJ0X3RvX3hlbl9sMWUodmlydCk7CiAgICAgICAgICAgICAgICAgaWYgKCBw
bDFlID09IE5VTEwgKQotICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKKyAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggbDJlX2dldF9mbGFncygq
cGwyZSkgJiBfUEFHRV9QU0UgKQogICAgICAgICAgICAgewpAQCAtNTI5OSw3
ICs1MzAxLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAKICAgICAgICAg
ICAgICAgICBsMXQgPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAg
ICAgICAgICAgaWYgKCBsMXQgPT0gTlVMTCApCi0gICAgICAgICAgICAgICAg
ICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAgICAgICAgICBnb3Rv
IG91dDsKIAogICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFf
UEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgICAg
IGwxZV93cml0ZSgmbDF0W2ldLApAQCAtNTQ0NSw3ICs1NDQ3LDEwIEBAIGlu
dCBtYXBfcGFnZXNfdG9feGVuKAogCiAjdW5kZWYgZmx1c2hfZmxhZ3MKIAot
ICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKworIG91dDoKKyAgICByZXR1
cm4gcmM7CiB9CiAKIGludCBwb3B1bGF0ZV9wdF9yYW5nZSh1bnNpZ25lZCBs
b25nIHZpcnQsIHVuc2lnbmVkIGxvbmcgbnJfbWZucykKLS0gCjIuMjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.14/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Disposition: attachment;
 filename="xsa345-4.14/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Transfer-Encoding: base64

RnJvbSA4NjQ1YWRiN2FjNjc5ZTVkZGM1YzM5ZTBjNWM5MThlNGEyYmE1Mzkx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQyICswMDAwClN1YmplY3Q6IFtQQVRDSCAyLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbW9kaWZ5X3hlbl9tYXBwaW5ncyB0byBoYXZlIG9uZSBleGl0CiBwYXRo
CgpXZSB3aWxsIHNvb24gbmVlZCB0byBwZXJmb3JtIGNsZWFuLXVwcyBiZWZv
cmUgcmV0dXJuaW5nLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5OiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8
d2VpLmxpdTJAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSG9uZ3lhbiBY
aWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJj
aC94ODYvbW0uYyB8IDEyICsrKysrKysrKy0tLQogMSBmaWxlIGNoYW5nZWQs
IDkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4
IDAzZjZlNmFhNjIuLjI0NjgzNDdhNDUgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC01NDc3LDYg
KzU0NzcsNyBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBs
b25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAg
IGwxX3BnZW50cnlfdCAqcGwxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CiAg
ICAgdW5zaWduZWQgbG9uZyB2ID0gczsKKyAgICBpbnQgcmMgPSAtRU5PTUVN
OwogCiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBi
ZSBhbHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxf
UEFHRV9ESVJUWXxfUEFHRV9BQ0NFU1NFRHxfUEFHRV9SV3xfUEFHRV9QUkVT
RU5UKQpAQCAtNTUyMCw3ICs1NTIxLDggQEAgaW50IG1vZGlmeV94ZW5fbWFw
cGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2ln
bmVkIGludCBuZikKICAgICAgICAgICAgIC8qIFBBR0UxR0I6IHNoYXR0ZXIg
dGhlIHN1cGVycGFnZSBhbmQgZmFsbCB0aHJvdWdoLiAqLwogICAgICAgICAg
ICAgbDJ0ID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAg
aWYgKCAhbDJ0ICkKLSAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsK
KyAgICAgICAgICAgICAgICBnb3RvIG91dDsKKwogICAgICAgICAgICAgZm9y
ICggaSA9IDA7IGkgPCBMMl9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAg
ICAgICAgICAgICAgICBsMmVfd3JpdGUobDJ0ICsgaSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbDJlX2Zyb21fcGZuKGwzZV9nZXRfcGZuKCpwbDNl
KSArCkBAIC01NTc3LDcgKzU1NzksOCBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBw
aW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWdu
ZWQgaW50IG5mKQogICAgICAgICAgICAgICAgIC8qIFBTRTogc2hhdHRlciB0
aGUgc3VwZXJwYWdlIGFuZCB0cnkgYWdhaW4uICovCiAgICAgICAgICAgICAg
ICAgbDF0ID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAg
ICAgIGlmICggIWwxdCApCi0gICAgICAgICAgICAgICAgICAgIHJldHVybiAt
RU5PTUVNOworICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKKwogICAg
ICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VO
VFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgICAgIGwxZV93cml0ZSgm
bDF0W2ldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbDFlX2Zy
b21fcGZuKGwyZV9nZXRfcGZuKCpwbDJlKSArIGksCkBAIC01NzEwLDcgKzU3
MTMsMTAgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9u
ZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICBm
bHVzaF9hcmVhKE5VTEwsIEZMVVNIX1RMQl9HTE9CQUwpOwogCiAjdW5kZWYg
RkxBR1NfTUFTSwotICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKworIG91
dDoKKyAgICByZXR1cm4gcmM7CiB9CiAKICN1bmRlZiBmbHVzaF9hcmVhCi0t
IAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345-4.14/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Disposition: attachment;
 filename="xsa345-4.14/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Transfer-Encoding: base64

RnJvbSA2YjAyMDQxOGQwNTU0ZDllYzZlYjIwMWY1MDc3NmE3MmRiNjc3Mzli
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KRGF0ZTogU2F0LCAxMSBKYW4gMjAyMCAy
MTo1Nzo0MyArMDAwMApTdWJqZWN0OiBbUEFUQ0ggMy8zXSB4ODYvbW06IFBy
ZXZlbnQgc29tZSByYWNlcyBpbiBoeXBlcnZpc29yIG1hcHBpbmcgdXBkYXRl
cwoKbWFwX3BhZ2VzX3RvX3hlbiB3aWxsIGF0dGVtcHQgdG8gY29hbGVzY2Ug
bWFwcGluZ3MgaW50byAyTWlCIGFuZCAxR2lCCnN1cGVycGFnZXMgaWYgcG9z
c2libGUsIHRvIG1heGltaXplIFRMQiBlZmZpY2llbmN5LiAgVGhpcyBtZWFu
cyBib3RoCnJlcGxhY2luZyBzdXBlcnBhZ2UgZW50cmllcyB3aXRoIHNtYWxs
ZXIgZW50cmllcywgYW5kIHJlcGxhY2luZwpzbWFsbGVyIGVudHJpZXMgd2l0
aCBzdXBlcnBhZ2VzLgoKVW5mb3J0dW5hdGVseSwgd2hpbGUgc29tZSBwb3Rl
bnRpYWwgcmFjZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5LApvdGhlcnMgYXJl
IG5vdC4gIFRoZXNlIGluY2x1ZGU6CgoxLiBXaGVuIG9uZSBwcm9jZXNzb3Ig
bW9kaWZpZXMgYSBzdWItc3VwZXJwYWdlIG1hcHBpbmcgd2hpbGUgYW5vdGhl
cgpwcm9jZXNzb3IgcmVwbGFjZXMgdGhlIGVudGlyZSByYW5nZSB3aXRoIGEg
c3VwZXJwYWdlLgoKVGFrZSB0aGUgZm9sbG93aW5nIGV4YW1wbGU6CgpTdXBw
b3NlIEwzW05dIHBvaW50cyB0byBMMi4gIEFuZCBzdXBwb3NlIHdlIGhhdmUg
dHdvIHByb2Nlc3NvcnMsIEEgYW5kCkIuCgoqIEEgd2Fsa3MgdGhlIHBhZ2V0
YWJsZXMsIGdldCBhIHBvaW50ZXIgdG8gTDIuCiogQiByZXBsYWNlcyBMM1tO
XSB3aXRoIGEgMUdpQiBtYXBwaW5nLgoqIEIgRnJlZXMgTDIKKiBBIHdyaXRl
cyBMMltNXSAjCgpUaGlzIGlzIHJhY2UgZXhhY2VyYmF0ZWQgYnkgdGhlIGZh
Y3QgdGhhdCB2aXJ0X3RvX3hlbl9sWzIxXWUgZG9lc24ndApoYW5kbGUgaGln
aGVyLWxldmVsIHN1cGVycGFnZXMgcHJvcGVybHk6IElmIHlvdSBjYWxsIHZp
cnRfeGVuX3RvX2wyZQpvbiBhIHZpcnR1YWwgYWRkcmVzcyB3aXRoaW4gYW4g
TDMgc3VwZXJwYWdlLCB5b3UnbGwgZWl0aGVyIGhpdCBhIEJVRygpCihtb3N0
IGxpa2VseSksIG9yIGdldCBhIHBvaW50ZXIgaW50byB0aGUgbWlkZGxlIG9m
IGEgZGF0YSBwYWdlOyBzYW1lCndpdGggdmlydF94ZW5fdG9fbDEgb24gYSB2
aXJ0dWFsIGFkZHJlc3Mgd2l0aGluIGVpdGhlciBhbiBMMyBvciBMMgpzdXBl
cnBhZ2UuCgpTbyB0YWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToKCiogQSBy
ZWFkcyBwbDNlIGFuZCBkaXNjb3ZlcnMgaXQgdG8gcG9pbnQgdG8gYW4gTDIu
CiogQiByZXBsYWNlcyBMM1tOXSB3aXRoIGEgMUdpQiBtYXBwaW5nCiogQSBj
YWxscyB2aXJ0X3RvX3hlbl9sMmUoKSBhbmQgaGl0cyB0aGUgQlVHX09OKCkg
IwoKMi4gV2hlbiB0d28gcHJvY2Vzc29ycyBzaW11bHRhbmVvdXNseSB0cnkg
dG8gcmVwbGFjZSBhIHN1Yi1zdXBlcnBhZ2UKbWFwcGluZyB3aXRoIGEgc3Vw
ZXJwYWdlIG1hcHBpbmcuCgpUYWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToK
ClN1cHBvc2UgTDNbTl0gcG9pbnRzIHRvIEwyLiAgQW5kIHN1cHBvc2Ugd2Ug
aGF2ZSB0d28gcHJvY2Vzc29ycywgQSBhbmQgQiwKYm90aCB0cnlpbmcgdG8g
cmVwbGFjZSBMM1tOXSB3aXRoIGEgc3VwZXJwYWdlLgoKKiBBIHdhbGtzIHRo
ZSBwYWdldGFibGVzLCBnZXQgYSBwb2ludGVyIHRvIHBsM2UsIGFuZCB0YWtl
cyBhIGNvcHkgb2wzZSBwb2ludGluZyB0byBMMi4KKiBCIHdhbGtzIHRoZSBw
YWdldGFibGVzLCBnZXRzIGEgcG9pbnRyZSB0byBwbDNlLCBhbmQgdGFrZXMg
YSBjb3B5IG9sM2UgcG9pbnRpbmcgdG8gTDIuCiogQSB3cml0ZXMgdGhlIG5l
dyB2YWx1ZSBpbnRvIEwzW05dCiogQiB3cml0ZXMgdGhlIG5ldyB2YWx1ZSBp
bnRvIEwzW05dCiogQSByZWN1cnNpdmVseSBmcmVlcyBhbGwgdGhlIEwxJ3Mg
dW5kZXIgTDIsIHRoZW4gZnJlZXMgTDIKKiBCIHJlY3Vyc2l2ZWx5IGRvdWJs
ZS1mcmVlcyBhbGwgdGhlIEwxJ3MgdW5kZXIgTDIsIHRoZW4gZG91YmxlLWZy
ZWVzIEwyICMKCkZpeCB0aGlzIGJ5IGdyYWJiaW5nIGEgbG9jayBmb3IgdGhl
IGVudGlyZXR5IG9mIHRoZSBtYXBwaW5nIHVwZGF0ZQpvcGVyYXRpb24uCgpS
YXRoZXIgdGhhbiBncmFiYmluZyBtYXBfcGdkaXJfbG9jayBmb3IgdGhlIGVu
dGlyZSBvcGVyYXRpb24sIGhvd2V2ZXIsCnJlcHVycG9zZSB0aGUgUEdUX2xv
Y2tlZCBiaXQgZnJvbSBMMydzIHBhZ2UtPnR5cGVfaW5mbyBhcyBhIGxvY2su
ClRoaXMgbWVhbnMgdGhhdCByYXRoZXIgdGhhbiBsb2NraW5nIHRoZSBlbnRp
cmUgYWRkcmVzcyBzcGFjZSwgd2UKIm9ubHkiIGxvY2sgYSBzaW5nbGUgNTEy
R2lCIGNodW5rIG9mIGh5cGVydmlzb3IgYWRkcmVzcyBzcGFjZSBhdCBhCnRp
bWUuCgpUaGVyZSB3YXMgYSBwcm9wb3NhbCBmb3IgYSBsb2NrLWFuZC1yZXZl
cmlmeSBhcHByb2FjaCwgd2hlcmUgd2Ugd2Fsawp0aGUgcGFnZXRhYmxlcyB0
byB0aGUgcG9pbnQgd2hlcmUgd2UgZGVjaWRlIHdoYXQgdG8gZG87IHRoZW4g
Z3JhYiB0aGUKbWFwX3BnZGlyX2xvY2ssIHJlLXZlcmlmeSB0aGUgaW5mb3Jt
YXRpb24gd2UgY29sbGVjdGVkIHdpdGhvdXQgdGhlCmxvY2ssIGFuZCBmaW5h
bGx5IG1ha2UgdGhlIGNoYW5nZSAoc3RhcnRpbmcgb3ZlciBhZ2FpbiBpZiBh
bnl0aGluZyBoYWQKY2hhbmdlZCkuICBXaXRob3V0IGJlaW5nIGFibGUgdG8g
Z3VhcmFudGVlIHRoYXQgdGhlIEwyIHRhYmxlIHdhc24ndApmcmVlZCwgaG93
ZXZlciwgdGhhdCBtZWFucyBldmVyeSByZWFkIHdvdWxkIG5lZWQgdG8gYmUg
Y29uc2lkZXJlZApwb3RlbnRpYWxseSB1bnNhZmUuICBUaGlua2luZyBjYXJl
ZnVsbHkgYWJvdXQgdGhhdCBpcyBwcm9iYWJseQpzb21ldGhpbmcgdGhhdCB3
YW50cyB0byBiZSBkb25lIG9uIHB1YmxpYywgbm90IHVuZGVyIHRpbWUgcHJl
c3N1cmUuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5
OiBIb25neWFuIFhpYSA8aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSG9uZ3lhbiBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25l
ZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4
LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZpbGUg
Y2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IDI0NjgzNDdhNDUuLjljNTViMmI5ZTMgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0yMDg4LDYgKzIwODgsNTAgQEAgdm9pZCBwYWdlX3VubG9jayhzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIGN1cnJlbnRfbG9ja2VkX3BhZ2Vfc2V0
KE5VTEwpOwogfQogCisvKgorICogTDMgdGFibGUgbG9ja3M6CisgKgorICog
VXNlZCBmb3Igc2VyaWFsaXphdGlvbiBpbiBtYXBfcGFnZXNfdG9feGVuKCkg
YW5kIG1vZGlmeV94ZW5fbWFwcGluZ3MoKS4KKyAqCisgKiBGb3IgWGVuIFBU
IHBhZ2VzLCB0aGUgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gaXMgdW51c2Vk
IGFuZCBpdCBpcyBzYWZlIHRvCisgKiByZXVzZSB0aGUgUEdUX2xvY2tlZCBm
bGFnLiBUaGlzIGxvY2sgaXMgdGFrZW4gb25seSB3aGVuIHdlIG1vdmUgZG93
biB0byBMMworICogdGFibGVzIGFuZCBiZWxvdywgc2luY2UgTDQgKGFuZCBh
Ym92ZSwgZm9yIDUtbGV2ZWwgcGFnaW5nKSBpcyBzdGlsbCBnbG9iYWxseQor
ICogcHJvdGVjdGVkIGJ5IG1hcF9wZ2Rpcl9sb2NrLgorICoKKyAqIFBWIE1N
VSB1cGRhdGUgaHlwZXJjYWxscyBjYWxsIG1hcF9wYWdlc190b194ZW4gd2hp
bGUgaG9sZGluZyBhIHBhZ2UncyBwYWdlX2xvY2soKS4KKyAqIFRoaXMgaGFz
IHR3byBpbXBsaWNhdGlvbnM6CisgKiAtIFdlIGNhbm5vdCByZXVzZSByZXVz
ZSBjdXJyZW50X2xvY2tlZF9wYWdlXyogZm9yIGRlYnVnZ2luZworICogLSBU
byBhdm9pZCB0aGUgY2hhbmNlIG9mIGRlYWRsb2NrLCBldmVuIGZvciBkaWZm
ZXJlbnQgcGFnZXMsIHdlCisgKiAgIG11c3QgbmV2ZXIgZ3JhYiBwYWdlX2xv
Y2soKSBhZnRlciBncmFiYmluZyBsM3RfbG9jaygpLiAgVGhpcworICogICBp
bmNsdWRlcyBhbnkgcGFnZV9sb2NrKCktYmFzZWQgbG9ja3MsIHN1Y2ggYXMK
KyAqICAgbWVtX3NoYXJpbmdfcGFnZV9sb2NrKCkuCisgKgorICogQWxzbyBu
b3RlIHRoYXQgd2UgZ3JhYiB0aGUgbWFwX3BnZGlyX2xvY2sgd2hpbGUgaG9s
ZGluZyB0aGUKKyAqIGwzdF9sb2NrKCksIHNvIHRvIGF2b2lkIGRlYWRsb2Nr
IHdlIG11c3QgYXZvaWQgZ3JhYmJpbmcgdGhlbSBpbgorICogcmV2ZXJzZSBv
cmRlci4KKyAqLworc3RhdGljIHZvaWQgbDN0X2xvY2soc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54OworCisg
ICAgZG8geworICAgICAgICB3aGlsZSAoICh4ID0gcGFnZS0+dS5pbnVzZS50
eXBlX2luZm8pICYgUEdUX2xvY2tlZCApCisgICAgICAgICAgICBjcHVfcmVs
YXgoKTsKKyAgICAgICAgbnggPSB4IHwgUEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggY21weGNoZygmcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIHgsIG54
KSAhPSB4ICk7Cit9CisKK3N0YXRpYyB2b2lkIGwzdF91bmxvY2soc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54
LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2luZm87CisKKyAgICBkbyB7Cisg
ICAgICAgIHggPSB5OworICAgICAgICBCVUdfT04oISh4ICYgUEdUX2xvY2tl
ZCkpOworICAgICAgICBueCA9IHggJiB+UEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggKHkgPSBjbXB4Y2hnKCZwYWdlLT51LmludXNlLnR5cGVfaW5mbywg
eCwgbngpKSAhPSB4ICk7Cit9CisKICNpZmRlZiBDT05GSUdfUFYKIC8qCiAg
KiBQVEUgZmxhZ3MgdGhhdCBhIGd1ZXN0IG1heSBjaGFuZ2Ugd2l0aG91dCBy
ZS12YWxpZGF0aW5nIHRoZSBQVEUuCkBAIC01MDc4LDYgKzUxMjIsMjMgQEAg
bDFfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9uZyB2
KQogICAgICAgICAgICAgICAgICAgICAgICAgIGZsdXNoX2FyZWFfbG9jYWwo
KGNvbnN0IHZvaWQgKil2LCBmKSA6IFwKICAgICAgICAgICAgICAgICAgICAg
ICAgICBmbHVzaF9hcmVhX2FsbCgoY29uc3Qgdm9pZCAqKXYsIGYpKQogCisj
ZGVmaW5lIEwzVF9JTklUKHBhZ2UpIChwYWdlKSA9IFpFUk9fQkxPQ0tfUFRS
CisKKyNkZWZpbmUgTDNUX0xPQ0socGFnZSkgICAgICAgIFwKKyAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBsb2NraW5n
ICkgICAgICAgIFwKKyAgICAgICAgICAgIGwzdF9sb2NrKHBhZ2UpOyAgIFwK
KyAgICB9IHdoaWxlICggZmFsc2UgKQorCisjZGVmaW5lIEwzVF9VTkxPQ0so
cGFnZSkgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgIGlmICggbG9ja2luZyAmJiAocGFnZSkgIT0gWkVST19CTE9DS19Q
VFIgKSBcCisgICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICBsM3RfdW5sb2NrKHBhZ2Up
OyAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAocGFnZSkg
PSBaRVJPX0JMT0NLX1BUUjsgICAgICAgICAgICAgICBcCisgICAgICAgIH0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgfSB3aGlsZSAoIGZhbHNlICkKKwogaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgdW5zaWduZWQgbG9uZyB2aXJ0LAogICAgIG1mbl90IG1mbiwKQEAg
LTUwODksNiArNTE1MCw3IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAg
IGwxX3BnZW50cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQg
IGk7CiAgICAgaW50IHJjID0gLUVOT01FTTsKKyAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpjdXJyZW50X2wzcGFnZTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhv
bGRmKSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50
IG9fID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUxMDQsMTMg
KzUxNjYsMjAgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgfSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKIH0gd2hp
bGUgKDApCiAKKyAgICBMM1RfSU5JVChjdXJyZW50X2wzcGFnZSk7CisKICAg
ICB3aGlsZSAoIG5yX21mbnMgIT0gMCApCiAgICAgewotICAgICAgICBsM19w
Z2VudHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7
CisgICAgICAgIGwzX3BnZW50cnlfdCAqcGwzZSwgb2wzZTsKIAorICAgICAg
ICBMM1RfVU5MT0NLKGN1cnJlbnRfbDNwYWdlKTsKKworICAgICAgICBwbDNl
ID0gdmlydF90b194ZW5fbDNlKHZpcnQpOwogICAgICAgICBpZiAoICFwbDNl
ICkKICAgICAgICAgICAgIGdvdG8gb3V0OwogCisgICAgICAgIGN1cnJlbnRf
bDNwYWdlID0gdmlydF90b19wYWdlKHBsM2UpOworICAgICAgICBMM1RfTE9D
SyhjdXJyZW50X2wzcGFnZSk7CiAgICAgICAgIG9sM2UgPSAqcGwzZTsKIAog
ICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpAQCAtNTQ1MCw2ICs1
NTE5LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgcmMgPSAwOwog
CiAgb3V0OgorICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOwogICAg
IHJldHVybiByYzsKIH0KIApAQCAtNTQ3OCw2ICs1NTQ4LDcgQEAgaW50IG1v
ZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBs
b25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICB1bnNpZ25lZCBpbnQgIGk7
CiAgICAgdW5zaWduZWQgbG9uZyB2ID0gczsKICAgICBpbnQgcmMgPSAtRU5P
TUVNOworICAgIHN0cnVjdCBwYWdlX2luZm8gKmN1cnJlbnRfbDNwYWdlOwog
CiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBiZSBh
bHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxfUEFH
RV9ESVJUWXxfUEFHRV9BQ0NFU1NFRHxfUEFHRV9SV3xfUEFHRV9QUkVTRU5U
KQpAQCAtNTQ4NiwxMSArNTU1NywyMiBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBw
aW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWdu
ZWQgaW50IG5mKQogICAgIEFTU0VSVChJU19BTElHTkVEKHMsIFBBR0VfU0la
RSkpOwogICAgIEFTU0VSVChJU19BTElHTkVEKGUsIFBBR0VfU0laRSkpOwog
CisgICAgTDNUX0lOSVQoY3VycmVudF9sM3BhZ2UpOworCiAgICAgd2hpbGUg
KCB2IDwgZSApCiAgICAgewotICAgICAgICBsM19wZ2VudHJ5X3QgKnBsM2Ug
PSB2aXJ0X3RvX3hlbl9sM2Uodik7CisgICAgICAgIGwzX3BnZW50cnlfdCAq
cGwzZTsKKworICAgICAgICBMM1RfVU5MT0NLKGN1cnJlbnRfbDNwYWdlKTsK
IAotICAgICAgICBpZiAoICFwbDNlIHx8ICEobDNlX2dldF9mbGFncygqcGwz
ZSkgJiBfUEFHRV9QUkVTRU5UKSApCisgICAgICAgIHBsM2UgPSB2aXJ0X3Rv
X3hlbl9sM2Uodik7CisgICAgICAgIGlmICggIXBsM2UgKQorICAgICAgICAg
ICAgZ290byBvdXQ7CisKKyAgICAgICAgY3VycmVudF9sM3BhZ2UgPSB2aXJ0
X3RvX3BhZ2UocGwzZSk7CisgICAgICAgIEwzVF9MT0NLKGN1cnJlbnRfbDNw
YWdlKTsKKworICAgICAgICBpZiAoICEobDNlX2dldF9mbGFncygqcGwzZSkg
JiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIC8q
IENvbmZpcm0gdGhlIGNhbGxlciBpc24ndCB0cnlpbmcgdG8gY3JlYXRlIG5l
dyBtYXBwaW5ncy4gKi8KICAgICAgICAgICAgIEFTU0VSVCghKG5mICYgX1BB
R0VfUFJFU0VOVCkpOwpAQCAtNTcxNiw5ICs1Nzk4LDEzIEBAIGludCBtb2Rp
ZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9u
ZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgcmMgPSAwOwogCiAgb3V0Ogor
ICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOwogICAgIHJldHVybiBy
YzsKIH0KIAorI3VuZGVmIEwzVF9MT0NLCisjdW5kZWYgTDNUX1VOTE9DSwor
CiAjdW5kZWYgZmx1c2hfYXJlYQogCiBpbnQgZGVzdHJveV94ZW5fbWFwcGlu
Z3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUpCi0tIAoyLjI1
LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Disposition: attachment;
 filename="xsa345/0001-x86-mm-Refactor-map_pages_to_xen-to-have-only-a-sing.patch"
Content-Transfer-Encoding: base64

RnJvbSBkODllODRmMzgyYjYwNDVlMzExYTA2N2FmNmQyODY4MGU1YTQ0MGZm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQxICswMDAwClN1YmplY3Q6IFtQQVRDSCAxLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbWFwX3BhZ2VzX3RvX3hlbiB0byBoYXZlIG9ubHkgYSBzaW5nbGUKIGV4
aXQgcGF0aAoKV2Ugd2lsbCBzb29uIG5lZWQgdG8gcGVyZm9ybSBjbGVhbi11
cHMgYmVmb3JlIHJldHVybmluZy4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoK
VGhpcyBpcyBwYXJ0IG9mIFhTQS0zNDUuCgpSZXBvcnRlZC1ieTogSG9uZ3lh
biBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IFdl
aSBMaXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhv
bmd5YW4gWGlhIDxob25neXhpYUBhbWF6b24uY29tPgpTaWduZWQtb2ZmLWJ5
OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkFj
a2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgfCAxOSArKysrKysrKysrKystLS0tLS0tCiAx
IGZpbGUgY2hhbmdlZCwgMTIgaW5zZXJ0aW9ucygrKSwgNyBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNo
L3g4Ni9tbS5jCmluZGV4IGQxY2ZjOGZiNGEuLmI5MDkwODNiYzIgMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCkBAIC0yNzUsNyArMjc1LDcgQEAgc3RhdGljIGw0X3BnZW50cnlfdCBf
X3JlYWRfbW9zdGx5IHNwbGl0X2w0ZTsKICAqIE9yaWdpbmFsbHkgY2xvbmVk
IGZyb20gc2hhcmVfeGVuX3BhZ2Vfd2l0aF9ndWVzdCgpLCBqdXN0IHRvIGF2
b2lkIHNldHRpbmcKICAqIFBHQ194ZW5faGVhcCBvbiBub24taGVhcCAodHlw
aWNhbGx5KSBNTUlPIHBhZ2VzLiBPdGhlciBwaWVjZXMgZ290IGRyb3BwZWQK
ICAqIHNpbXBseSBiZWNhdXNlIHRoZXkncmUgbm90IG5lZWRlZCBpbiB0aGlz
IGNvbnRleHQuCi0gKi8gCisgKi8KIHN0YXRpYyB2b2lkIF9faW5pdCBhc3Np
Z25faW9fcGFnZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogewogICAgIHNl
dF9ncGZuX2Zyb21fbWZuKG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKSwgSU5W
QUxJRF9NMlBfRU5UUlkpOwpAQCAtNTA3OSw2ICs1MDc5LDcgQEAgaW50IG1h
cF9wYWdlc190b194ZW4oCiAgICAgbDJfcGdlbnRyeV90ICpwbDJlLCBvbDJl
OwogICAgIGwxX3BnZW50cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25l
ZCBpbnQgIGk7CisgICAgaW50IHJjID0gLUVOT01FTTsKIAogI2RlZmluZSBm
bHVzaF9mbGFncyhvbGRmKSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAg
dW5zaWduZWQgaW50IG9fID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwK
QEAgLTUwOTksNyArNTEwMCw4IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAog
ICAgICAgICBsM19wZ2VudHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hl
bl9sM2UodmlydCk7CiAKICAgICAgICAgaWYgKCAhcGwzZSApCi0gICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0Owor
CiAgICAgICAgIG9sM2UgPSAqcGwzZTsKIAogICAgICAgICBpZiAoIGNwdV9o
YXNfcGFnZTFnYiAmJgpAQCAtNTE4OSw3ICs1MTkxLDcgQEAgaW50IG1hcF9w
YWdlc190b194ZW4oCiAKICAgICAgICAgICAgIGwydCA9IGFsbG9jX3hlbl9w
YWdldGFibGUoKTsKICAgICAgICAgICAgIGlmICggbDJ0ID09IE5VTEwgKQot
ICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAgICAg
ICAgIGdvdG8gb3V0OwogCiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8
IEwyX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAgICAg
IGwyZV93cml0ZShsMnQgKyBpLApAQCAtNTIxOCw3ICs1MjIwLDcgQEAgaW50
IG1hcF9wYWdlc190b194ZW4oCiAKICAgICAgICAgcGwyZSA9IHZpcnRfdG9f
eGVuX2wyZSh2aXJ0KTsKICAgICAgICAgaWYgKCAhcGwyZSApCi0gICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0Owog
CiAgICAgICAgIGlmICggKCgoKHZpcnQgPj4gUEFHRV9TSElGVCkgfCBtZm5f
eChtZm4pKSAmCiAgICAgICAgICAgICAgICAoKDF1IDw8IFBBR0VUQUJMRV9P
UkRFUikgLSAxKSkgPT0gMCkgJiYKQEAgLTUyNjIsNyArNTI2NCw3IEBAIGlu
dCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBsMWUgPSB2aXJ0X3RvX3hlbl9sMWUodmlydCk7CiAgICAgICAg
ICAgICAgICAgaWYgKCBwbDFlID09IE5VTEwgKQotICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsKKyAgICAgICAgICAgICAgICAgICAgZ290
byBvdXQ7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICgg
bDJlX2dldF9mbGFncygqcGwyZSkgJiBfUEFHRV9QU0UgKQogICAgICAgICAg
ICAgewpAQCAtNTI5MCw3ICs1MjkyLDcgQEAgaW50IG1hcF9wYWdlc190b194
ZW4oCiAKICAgICAgICAgICAgICAgICBsMXQgPSBhbGxvY194ZW5fcGFnZXRh
YmxlKCk7CiAgICAgICAgICAgICAgICAgaWYgKCBsMXQgPT0gTlVMTCApCi0g
ICAgICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgICAgICAg
ICAgICAgICAgICBnb3RvIG91dDsKIAogICAgICAgICAgICAgICAgIGZvciAo
IGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAgICAg
ICAgICAgICAgICAgICAgIGwxZV93cml0ZSgmbDF0W2ldLApAQCAtNTQzNiw3
ICs1NDM4LDEwIEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogCiAjdW5kZWYg
Zmx1c2hfZmxhZ3MKIAotICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKwor
IG91dDoKKyAgICByZXR1cm4gcmM7CiB9CiAKIGludCBwb3B1bGF0ZV9wdF9y
YW5nZSh1bnNpZ25lZCBsb25nIHZpcnQsIHVuc2lnbmVkIGxvbmcgbnJfbWZu
cykKLS0gCjIuMjUuMQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa345/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Disposition: attachment;
 filename="xsa345/0002-x86-mm-Refactor-modify_xen_mappings-to-have-one-exit.patch"
Content-Transfer-Encoding: base64

RnJvbSA3YWNhOTA3NjY2NDhmMWI4ZWJjMDRlMGFiZDRkNzliYmQ0ZGI3N2Ew
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBXZWkgTGl1IDx3ZWku
bGl1MkBjaXRyaXguY29tPgpEYXRlOiBTYXQsIDExIEphbiAyMDIwIDIxOjU3
OjQyICswMDAwClN1YmplY3Q6IFtQQVRDSCAyLzNdIHg4Ni9tbTogUmVmYWN0
b3IgbW9kaWZ5X3hlbl9tYXBwaW5ncyB0byBoYXZlIG9uZSBleGl0CiBwYXRo
CgpXZSB3aWxsIHNvb24gbmVlZCB0byBwZXJmb3JtIGNsZWFuLXVwcyBiZWZv
cmUgcmV0dXJuaW5nLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5OiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogV2VpIExpdSA8
d2VpLmxpdTJAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSG9uZ3lhbiBY
aWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJj
aC94ODYvbW0uYyB8IDEyICsrKysrKysrKy0tLQogMSBmaWxlIGNoYW5nZWQs
IDkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4
IGI5MDkwODNiYzIuLmQwZmM4YTgxNDIgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC01NDY4LDYg
KzU0NjgsNyBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBs
b25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAg
IGwxX3BnZW50cnlfdCAqcGwxZTsKICAgICB1bnNpZ25lZCBpbnQgIGk7CiAg
ICAgdW5zaWduZWQgbG9uZyB2ID0gczsKKyAgICBpbnQgcmMgPSAtRU5PTUVN
OwogCiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBi
ZSBhbHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxf
UEFHRV9ESVJUWXxfUEFHRV9BQ0NFU1NFRHxfUEFHRV9SV3xfUEFHRV9QUkVT
RU5UKQpAQCAtNTUxMSw3ICs1NTEyLDggQEAgaW50IG1vZGlmeV94ZW5fbWFw
cGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2ln
bmVkIGludCBuZikKICAgICAgICAgICAgIC8qIFBBR0UxR0I6IHNoYXR0ZXIg
dGhlIHN1cGVycGFnZSBhbmQgZmFsbCB0aHJvdWdoLiAqLwogICAgICAgICAg
ICAgbDJ0ID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAg
aWYgKCAhbDJ0ICkKLSAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsK
KyAgICAgICAgICAgICAgICBnb3RvIG91dDsKKwogICAgICAgICAgICAgZm9y
ICggaSA9IDA7IGkgPCBMMl9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAg
ICAgICAgICAgICAgICBsMmVfd3JpdGUobDJ0ICsgaSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbDJlX2Zyb21fcGZuKGwzZV9nZXRfcGZuKCpwbDNl
KSArCkBAIC01NTY4LDcgKzU1NzAsOCBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBw
aW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWdu
ZWQgaW50IG5mKQogICAgICAgICAgICAgICAgIC8qIFBTRTogc2hhdHRlciB0
aGUgc3VwZXJwYWdlIGFuZCB0cnkgYWdhaW4uICovCiAgICAgICAgICAgICAg
ICAgbDF0ID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAg
ICAgIGlmICggIWwxdCApCi0gICAgICAgICAgICAgICAgICAgIHJldHVybiAt
RU5PTUVNOworICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKKwogICAg
ICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VO
VFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgICAgIGwxZV93cml0ZSgm
bDF0W2ldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbDFlX2Zy
b21fcGZuKGwyZV9nZXRfcGZuKCpwbDJlKSArIGksCkBAIC01NzAxLDcgKzU3
MDQsMTAgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9u
ZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICBm
bHVzaF9hcmVhKE5VTEwsIEZMVVNIX1RMQl9HTE9CQUwpOwogCiAjdW5kZWYg
RkxBR1NfTUFTSwotICAgIHJldHVybiAwOworICAgIHJjID0gMDsKKworIG91
dDoKKyAgICByZXR1cm4gcmM7CiB9CiAKICN1bmRlZiBmbHVzaF9hcmVhCi0t
IAoyLjI1LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa345/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Disposition: attachment;
 filename="xsa345/0003-x86-mm-Prevent-some-races-in-hypervisor-mapping-upda.patch"
Content-Transfer-Encoding: base64

RnJvbSBkMjUzNTlkNWM0MjM4M2QyYmM3ZDFhOTQ0ZmFiOGJjMDM5ZGJiNDQy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBIb25neWFuIFhpYSA8
aG9uZ3l4aWFAYW1hem9uLmNvbT4KRGF0ZTogU2F0LCAxMSBKYW4gMjAyMCAy
MTo1Nzo0MyArMDAwMApTdWJqZWN0OiBbUEFUQ0ggMy8zXSB4ODYvbW06IFBy
ZXZlbnQgc29tZSByYWNlcyBpbiBoeXBlcnZpc29yIG1hcHBpbmcgdXBkYXRl
cwoKbWFwX3BhZ2VzX3RvX3hlbiB3aWxsIGF0dGVtcHQgdG8gY29hbGVzY2Ug
bWFwcGluZ3MgaW50byAyTWlCIGFuZCAxR2lCCnN1cGVycGFnZXMgaWYgcG9z
c2libGUsIHRvIG1heGltaXplIFRMQiBlZmZpY2llbmN5LiAgVGhpcyBtZWFu
cyBib3RoCnJlcGxhY2luZyBzdXBlcnBhZ2UgZW50cmllcyB3aXRoIHNtYWxs
ZXIgZW50cmllcywgYW5kIHJlcGxhY2luZwpzbWFsbGVyIGVudHJpZXMgd2l0
aCBzdXBlcnBhZ2VzLgoKVW5mb3J0dW5hdGVseSwgd2hpbGUgc29tZSBwb3Rl
bnRpYWwgcmFjZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5LApvdGhlcnMgYXJl
IG5vdC4gIFRoZXNlIGluY2x1ZGU6CgoxLiBXaGVuIG9uZSBwcm9jZXNzb3Ig
bW9kaWZpZXMgYSBzdWItc3VwZXJwYWdlIG1hcHBpbmcgd2hpbGUgYW5vdGhl
cgpwcm9jZXNzb3IgcmVwbGFjZXMgdGhlIGVudGlyZSByYW5nZSB3aXRoIGEg
c3VwZXJwYWdlLgoKVGFrZSB0aGUgZm9sbG93aW5nIGV4YW1wbGU6CgpTdXBw
b3NlIEwzW05dIHBvaW50cyB0byBMMi4gIEFuZCBzdXBwb3NlIHdlIGhhdmUg
dHdvIHByb2Nlc3NvcnMsIEEgYW5kCkIuCgoqIEEgd2Fsa3MgdGhlIHBhZ2V0
YWJsZXMsIGdldCBhIHBvaW50ZXIgdG8gTDIuCiogQiByZXBsYWNlcyBMM1tO
XSB3aXRoIGEgMUdpQiBtYXBwaW5nLgoqIEIgRnJlZXMgTDIKKiBBIHdyaXRl
cyBMMltNXSAjCgpUaGlzIGlzIHJhY2UgZXhhY2VyYmF0ZWQgYnkgdGhlIGZh
Y3QgdGhhdCB2aXJ0X3RvX3hlbl9sWzIxXWUgZG9lc24ndApoYW5kbGUgaGln
aGVyLWxldmVsIHN1cGVycGFnZXMgcHJvcGVybHk6IElmIHlvdSBjYWxsIHZp
cnRfeGVuX3RvX2wyZQpvbiBhIHZpcnR1YWwgYWRkcmVzcyB3aXRoaW4gYW4g
TDMgc3VwZXJwYWdlLCB5b3UnbGwgZWl0aGVyIGhpdCBhIEJVRygpCihtb3N0
IGxpa2VseSksIG9yIGdldCBhIHBvaW50ZXIgaW50byB0aGUgbWlkZGxlIG9m
IGEgZGF0YSBwYWdlOyBzYW1lCndpdGggdmlydF94ZW5fdG9fbDEgb24gYSB2
aXJ0dWFsIGFkZHJlc3Mgd2l0aGluIGVpdGhlciBhbiBMMyBvciBMMgpzdXBl
cnBhZ2UuCgpTbyB0YWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToKCiogQSBy
ZWFkcyBwbDNlIGFuZCBkaXNjb3ZlcnMgaXQgdG8gcG9pbnQgdG8gYW4gTDIu
CiogQiByZXBsYWNlcyBMM1tOXSB3aXRoIGEgMUdpQiBtYXBwaW5nCiogQSBj
YWxscyB2aXJ0X3RvX3hlbl9sMmUoKSBhbmQgaGl0cyB0aGUgQlVHX09OKCkg
IwoKMi4gV2hlbiB0d28gcHJvY2Vzc29ycyBzaW11bHRhbmVvdXNseSB0cnkg
dG8gcmVwbGFjZSBhIHN1Yi1zdXBlcnBhZ2UKbWFwcGluZyB3aXRoIGEgc3Vw
ZXJwYWdlIG1hcHBpbmcuCgpUYWtlIHRoZSBmb2xsb3dpbmcgZXhhbXBsZToK
ClN1cHBvc2UgTDNbTl0gcG9pbnRzIHRvIEwyLiAgQW5kIHN1cHBvc2Ugd2Ug
aGF2ZSB0d28gcHJvY2Vzc29ycywgQSBhbmQgQiwKYm90aCB0cnlpbmcgdG8g
cmVwbGFjZSBMM1tOXSB3aXRoIGEgc3VwZXJwYWdlLgoKKiBBIHdhbGtzIHRo
ZSBwYWdldGFibGVzLCBnZXQgYSBwb2ludGVyIHRvIHBsM2UsIGFuZCB0YWtl
cyBhIGNvcHkgb2wzZSBwb2ludGluZyB0byBMMi4KKiBCIHdhbGtzIHRoZSBw
YWdldGFibGVzLCBnZXRzIGEgcG9pbnRyZSB0byBwbDNlLCBhbmQgdGFrZXMg
YSBjb3B5IG9sM2UgcG9pbnRpbmcgdG8gTDIuCiogQSB3cml0ZXMgdGhlIG5l
dyB2YWx1ZSBpbnRvIEwzW05dCiogQiB3cml0ZXMgdGhlIG5ldyB2YWx1ZSBp
bnRvIEwzW05dCiogQSByZWN1cnNpdmVseSBmcmVlcyBhbGwgdGhlIEwxJ3Mg
dW5kZXIgTDIsIHRoZW4gZnJlZXMgTDIKKiBCIHJlY3Vyc2l2ZWx5IGRvdWJs
ZS1mcmVlcyBhbGwgdGhlIEwxJ3MgdW5kZXIgTDIsIHRoZW4gZG91YmxlLWZy
ZWVzIEwyICMKCkZpeCB0aGlzIGJ5IGdyYWJiaW5nIGEgbG9jayBmb3IgdGhl
IGVudGlyZXR5IG9mIHRoZSBtYXBwaW5nIHVwZGF0ZQpvcGVyYXRpb24uCgpS
YXRoZXIgdGhhbiBncmFiYmluZyBtYXBfcGdkaXJfbG9jayBmb3IgdGhlIGVu
dGlyZSBvcGVyYXRpb24sIGhvd2V2ZXIsCnJlcHVycG9zZSB0aGUgUEdUX2xv
Y2tlZCBiaXQgZnJvbSBMMydzIHBhZ2UtPnR5cGVfaW5mbyBhcyBhIGxvY2su
ClRoaXMgbWVhbnMgdGhhdCByYXRoZXIgdGhhbiBsb2NraW5nIHRoZSBlbnRp
cmUgYWRkcmVzcyBzcGFjZSwgd2UKIm9ubHkiIGxvY2sgYSBzaW5nbGUgNTEy
R2lCIGNodW5rIG9mIGh5cGVydmlzb3IgYWRkcmVzcyBzcGFjZSBhdCBhCnRp
bWUuCgpUaGVyZSB3YXMgYSBwcm9wb3NhbCBmb3IgYSBsb2NrLWFuZC1yZXZl
cmlmeSBhcHByb2FjaCwgd2hlcmUgd2Ugd2Fsawp0aGUgcGFnZXRhYmxlcyB0
byB0aGUgcG9pbnQgd2hlcmUgd2UgZGVjaWRlIHdoYXQgdG8gZG87IHRoZW4g
Z3JhYiB0aGUKbWFwX3BnZGlyX2xvY2ssIHJlLXZlcmlmeSB0aGUgaW5mb3Jt
YXRpb24gd2UgY29sbGVjdGVkIHdpdGhvdXQgdGhlCmxvY2ssIGFuZCBmaW5h
bGx5IG1ha2UgdGhlIGNoYW5nZSAoc3RhcnRpbmcgb3ZlciBhZ2FpbiBpZiBh
bnl0aGluZyBoYWQKY2hhbmdlZCkuICBXaXRob3V0IGJlaW5nIGFibGUgdG8g
Z3VhcmFudGVlIHRoYXQgdGhlIEwyIHRhYmxlIHdhc24ndApmcmVlZCwgaG93
ZXZlciwgdGhhdCBtZWFucyBldmVyeSByZWFkIHdvdWxkIG5lZWQgdG8gYmUg
Y29uc2lkZXJlZApwb3RlbnRpYWxseSB1bnNhZmUuICBUaGlua2luZyBjYXJl
ZnVsbHkgYWJvdXQgdGhhdCBpcyBwcm9iYWJseQpzb21ldGhpbmcgdGhhdCB3
YW50cyB0byBiZSBkb25lIG9uIHB1YmxpYywgbm90IHVuZGVyIHRpbWUgcHJl
c3N1cmUuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NS4KClJlcG9ydGVkLWJ5
OiBIb25neWFuIFhpYSA8aG9uZ3l4aWFAYW1hem9uLmNvbT4KU2lnbmVkLW9m
Zi1ieTogSG9uZ3lhbiBYaWEgPGhvbmd5eGlhQGFtYXpvbi5jb20+ClNpZ25l
ZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4
LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDkyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAxIGZpbGUg
Y2hhbmdlZCwgODkgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IGQwZmM4YTgxNDIuLjAwYjM1NTQyZDEgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0yMDgzLDYgKzIwODMsNTAgQEAgdm9pZCBwYWdlX3VubG9jayhzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIGN1cnJlbnRfbG9ja2VkX3BhZ2Vfc2V0
KE5VTEwpOwogfQogCisvKgorICogTDMgdGFibGUgbG9ja3M6CisgKgorICog
VXNlZCBmb3Igc2VyaWFsaXphdGlvbiBpbiBtYXBfcGFnZXNfdG9feGVuKCkg
YW5kIG1vZGlmeV94ZW5fbWFwcGluZ3MoKS4KKyAqCisgKiBGb3IgWGVuIFBU
IHBhZ2VzLCB0aGUgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gaXMgdW51c2Vk
IGFuZCBpdCBpcyBzYWZlIHRvCisgKiByZXVzZSB0aGUgUEdUX2xvY2tlZCBm
bGFnLiBUaGlzIGxvY2sgaXMgdGFrZW4gb25seSB3aGVuIHdlIG1vdmUgZG93
biB0byBMMworICogdGFibGVzIGFuZCBiZWxvdywgc2luY2UgTDQgKGFuZCBh
Ym92ZSwgZm9yIDUtbGV2ZWwgcGFnaW5nKSBpcyBzdGlsbCBnbG9iYWxseQor
ICogcHJvdGVjdGVkIGJ5IG1hcF9wZ2Rpcl9sb2NrLgorICoKKyAqIFBWIE1N
VSB1cGRhdGUgaHlwZXJjYWxscyBjYWxsIG1hcF9wYWdlc190b194ZW4gd2hp
bGUgaG9sZGluZyBhIHBhZ2UncyBwYWdlX2xvY2soKS4KKyAqIFRoaXMgaGFz
IHR3byBpbXBsaWNhdGlvbnM6CisgKiAtIFdlIGNhbm5vdCByZXVzZSByZXVz
ZSBjdXJyZW50X2xvY2tlZF9wYWdlXyogZm9yIGRlYnVnZ2luZworICogLSBU
byBhdm9pZCB0aGUgY2hhbmNlIG9mIGRlYWRsb2NrLCBldmVuIGZvciBkaWZm
ZXJlbnQgcGFnZXMsIHdlCisgKiAgIG11c3QgbmV2ZXIgZ3JhYiBwYWdlX2xv
Y2soKSBhZnRlciBncmFiYmluZyBsM3RfbG9jaygpLiAgVGhpcworICogICBp
bmNsdWRlcyBhbnkgcGFnZV9sb2NrKCktYmFzZWQgbG9ja3MsIHN1Y2ggYXMK
KyAqICAgbWVtX3NoYXJpbmdfcGFnZV9sb2NrKCkuCisgKgorICogQWxzbyBu
b3RlIHRoYXQgd2UgZ3JhYiB0aGUgbWFwX3BnZGlyX2xvY2sgd2hpbGUgaG9s
ZGluZyB0aGUKKyAqIGwzdF9sb2NrKCksIHNvIHRvIGF2b2lkIGRlYWRsb2Nr
IHdlIG11c3QgYXZvaWQgZ3JhYmJpbmcgdGhlbSBpbgorICogcmV2ZXJzZSBv
cmRlci4KKyAqLworc3RhdGljIHZvaWQgbDN0X2xvY2soc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54OworCisg
ICAgZG8geworICAgICAgICB3aGlsZSAoICh4ID0gcGFnZS0+dS5pbnVzZS50
eXBlX2luZm8pICYgUEdUX2xvY2tlZCApCisgICAgICAgICAgICBjcHVfcmVs
YXgoKTsKKyAgICAgICAgbnggPSB4IHwgUEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggY21weGNoZygmcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIHgsIG54
KSAhPSB4ICk7Cit9CisKK3N0YXRpYyB2b2lkIGwzdF91bmxvY2soc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIHgsIG54
LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2luZm87CisKKyAgICBkbyB7Cisg
ICAgICAgIHggPSB5OworICAgICAgICBCVUdfT04oISh4ICYgUEdUX2xvY2tl
ZCkpOworICAgICAgICBueCA9IHggJiB+UEdUX2xvY2tlZDsKKyAgICB9IHdo
aWxlICggKHkgPSBjbXB4Y2hnKCZwYWdlLT51LmludXNlLnR5cGVfaW5mbywg
eCwgbngpKSAhPSB4ICk7Cit9CisKICNpZmRlZiBDT05GSUdfUFYKIC8qCiAg
KiBQVEUgZmxhZ3MgdGhhdCBhIGd1ZXN0IG1heSBjaGFuZ2Ugd2l0aG91dCBy
ZS12YWxpZGF0aW5nIHRoZSBQVEUuCkBAIC01MDY5LDYgKzUxMTMsMjMgQEAg
bDFfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9uZyB2
KQogICAgICAgICAgICAgICAgICAgICAgICAgIGZsdXNoX2FyZWFfbG9jYWwo
KGNvbnN0IHZvaWQgKil2LCBmKSA6IFwKICAgICAgICAgICAgICAgICAgICAg
ICAgICBmbHVzaF9hcmVhX2FsbCgoY29uc3Qgdm9pZCAqKXYsIGYpKQogCisj
ZGVmaW5lIEwzVF9JTklUKHBhZ2UpIChwYWdlKSA9IFpFUk9fQkxPQ0tfUFRS
CisKKyNkZWZpbmUgTDNUX0xPQ0socGFnZSkgICAgICAgIFwKKyAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBsb2NraW5n
ICkgICAgICAgIFwKKyAgICAgICAgICAgIGwzdF9sb2NrKHBhZ2UpOyAgIFwK
KyAgICB9IHdoaWxlICggZmFsc2UgKQorCisjZGVmaW5lIEwzVF9VTkxPQ0so
cGFnZSkgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgIGlmICggbG9ja2luZyAmJiAocGFnZSkgIT0gWkVST19CTE9DS19Q
VFIgKSBcCisgICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICBsM3RfdW5sb2NrKHBhZ2Up
OyAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAocGFnZSkg
PSBaRVJPX0JMT0NLX1BUUjsgICAgICAgICAgICAgICBcCisgICAgICAgIH0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgfSB3aGlsZSAoIGZhbHNlICkKKwogaW50IG1hcF9wYWdlc190b194ZW4o
CiAgICAgdW5zaWduZWQgbG9uZyB2aXJ0LAogICAgIG1mbl90IG1mbiwKQEAg
LTUwODAsNiArNTE0MSw3IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAg
IGwxX3BnZW50cnlfdCAqcGwxZSwgb2wxZTsKICAgICB1bnNpZ25lZCBpbnQg
IGk7CiAgICAgaW50IHJjID0gLUVOT01FTTsKKyAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpjdXJyZW50X2wzcGFnZTsKIAogI2RlZmluZSBmbHVzaF9mbGFncyhv
bGRmKSBkbyB7ICAgICAgICAgICAgICAgICBcCiAgICAgdW5zaWduZWQgaW50
IG9fID0gKG9sZGYpOyAgICAgICAgICAgICAgICAgIFwKQEAgLTUwOTUsMTMg
KzUxNTcsMjAgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgfSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKIH0gd2hp
bGUgKDApCiAKKyAgICBMM1RfSU5JVChjdXJyZW50X2wzcGFnZSk7CisKICAg
ICB3aGlsZSAoIG5yX21mbnMgIT0gMCApCiAgICAgewotICAgICAgICBsM19w
Z2VudHJ5X3Qgb2wzZSwgKnBsM2UgPSB2aXJ0X3RvX3hlbl9sM2UodmlydCk7
CisgICAgICAgIGwzX3BnZW50cnlfdCAqcGwzZSwgb2wzZTsKIAorICAgICAg
ICBMM1RfVU5MT0NLKGN1cnJlbnRfbDNwYWdlKTsKKworICAgICAgICBwbDNl
ID0gdmlydF90b194ZW5fbDNlKHZpcnQpOwogICAgICAgICBpZiAoICFwbDNl
ICkKICAgICAgICAgICAgIGdvdG8gb3V0OwogCisgICAgICAgIGN1cnJlbnRf
bDNwYWdlID0gdmlydF90b19wYWdlKHBsM2UpOworICAgICAgICBMM1RfTE9D
SyhjdXJyZW50X2wzcGFnZSk7CiAgICAgICAgIG9sM2UgPSAqcGwzZTsKIAog
ICAgICAgICBpZiAoIGNwdV9oYXNfcGFnZTFnYiAmJgpAQCAtNTQ0MSw2ICs1
NTEwLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgcmMgPSAwOwog
CiAgb3V0OgorICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOwogICAg
IHJldHVybiByYzsKIH0KIApAQCAtNTQ2OSw2ICs1NTM5LDcgQEAgaW50IG1v
ZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBs
b25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICB1bnNpZ25lZCBpbnQgIGk7
CiAgICAgdW5zaWduZWQgbG9uZyB2ID0gczsKICAgICBpbnQgcmMgPSAtRU5P
TUVNOworICAgIHN0cnVjdCBwYWdlX2luZm8gKmN1cnJlbnRfbDNwYWdlOwog
CiAgICAgLyogU2V0IG9mIHZhbGlkIFBURSBiaXRzIHdoaWNoIG1heSBiZSBh
bHRlcmVkLiAqLwogI2RlZmluZSBGTEFHU19NQVNLIChfUEFHRV9OWHxfUEFH
RV9ESVJUWXxfUEFHRV9BQ0NFU1NFRHxfUEFHRV9SV3xfUEFHRV9QUkVTRU5U
KQpAQCAtNTQ3NywxMSArNTU0OCwyMiBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBw
aW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWdu
ZWQgaW50IG5mKQogICAgIEFTU0VSVChJU19BTElHTkVEKHMsIFBBR0VfU0la
RSkpOwogICAgIEFTU0VSVChJU19BTElHTkVEKGUsIFBBR0VfU0laRSkpOwog
CisgICAgTDNUX0lOSVQoY3VycmVudF9sM3BhZ2UpOworCiAgICAgd2hpbGUg
KCB2IDwgZSApCiAgICAgewotICAgICAgICBsM19wZ2VudHJ5X3QgKnBsM2Ug
PSB2aXJ0X3RvX3hlbl9sM2Uodik7CisgICAgICAgIGwzX3BnZW50cnlfdCAq
cGwzZTsKKworICAgICAgICBMM1RfVU5MT0NLKGN1cnJlbnRfbDNwYWdlKTsK
IAotICAgICAgICBpZiAoICFwbDNlIHx8ICEobDNlX2dldF9mbGFncygqcGwz
ZSkgJiBfUEFHRV9QUkVTRU5UKSApCisgICAgICAgIHBsM2UgPSB2aXJ0X3Rv
X3hlbl9sM2Uodik7CisgICAgICAgIGlmICggIXBsM2UgKQorICAgICAgICAg
ICAgZ290byBvdXQ7CisKKyAgICAgICAgY3VycmVudF9sM3BhZ2UgPSB2aXJ0
X3RvX3BhZ2UocGwzZSk7CisgICAgICAgIEwzVF9MT0NLKGN1cnJlbnRfbDNw
YWdlKTsKKworICAgICAgICBpZiAoICEobDNlX2dldF9mbGFncygqcGwzZSkg
JiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIC8q
IENvbmZpcm0gdGhlIGNhbGxlciBpc24ndCB0cnlpbmcgdG8gY3JlYXRlIG5l
dyBtYXBwaW5ncy4gKi8KICAgICAgICAgICAgIEFTU0VSVCghKG5mICYgX1BB
R0VfUFJFU0VOVCkpOwpAQCAtNTcwNyw5ICs1Nzg5LDEzIEBAIGludCBtb2Rp
ZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9u
ZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgcmMgPSAwOwogCiAgb3V0Ogor
ICAgIEwzVF9VTkxPQ0soY3VycmVudF9sM3BhZ2UpOwogICAgIHJldHVybiBy
YzsKIH0KIAorI3VuZGVmIEwzVF9MT0NLCisjdW5kZWYgTDNUX1VOTE9DSwor
CiAjdW5kZWYgZmx1c2hfYXJlYQogCiBpbnQgZGVzdHJveV94ZW5fbWFwcGlu
Z3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUpCi0tIAoyLjI1
LjEKCg==

--=separator--


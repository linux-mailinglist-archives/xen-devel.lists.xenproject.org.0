Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 3902C1764BC
	for <lists+xen-devel@lfdr.de>; Mon,  2 Mar 2020 21:15:38 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j8rPD-0001O8-Ct; Mon, 02 Mar 2020 20:11:11 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Hq1L=4T=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1j8rPB-0001O3-WE
 for xen-devel@lists.xenproject.org; Mon, 02 Mar 2020 20:11:10 +0000
X-Inumbo-ID: f2b42c4b-5cc1-11ea-9ff6-12813bfff9fa
Received: from mail-yw1-f44.google.com (unknown [209.85.161.44])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id f2b42c4b-5cc1-11ea-9ff6-12813bfff9fa;
 Mon, 02 Mar 2020 20:11:06 +0000 (UTC)
Received: by mail-yw1-f44.google.com with SMTP id y72so1085528ywg.3
 for <xen-devel@lists.xenproject.org>; Mon, 02 Mar 2020 12:11:06 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id;
 bh=Ljh15I+NnbiOdQAiKkDPi5D9dY+Wl7d4cf7nQqn9ZFM=;
 b=rYfdjBGYs9zpoiJip9ZifEOKhirQLfKPO5UqO3k85RID7mpyeb05AtaRJ8aZUPh/H8
 aDEUkpT/a1xCHYgWLy8RcTuY4wxe04I450fB76QMT+l0KQnzUI8ByS56E43fLo2oVu8J
 LQuqW2ZMZp7AzcWIuBuI9Pxd7LVqutpkeILFqw9PfCmQpaN3m1Hz86PMkDkKI5ogCm9u
 SIL0RwBIeatq/giMaGnhpX4m6078wgv5Nbn0C4kcQ2J2DZyLx2h5+cqT8ZIuZcFg0q6Q
 Kfzc0AWjBoAEC3g8aaubGlN3jls3TklO1DTwD/RFUWNc1E3T5vDsmn0z7AadA17Nsr4F
 pT2A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id;
 bh=Ljh15I+NnbiOdQAiKkDPi5D9dY+Wl7d4cf7nQqn9ZFM=;
 b=gjCb1KOGPnfDkbs3K6vvzVe683gOZOB8fH5yQxWnHW08k3dcksijt3gdFnv5hb4Ugz
 tlX0mFMYPNaXrzXs5vtiFWukiwSeah/yBhIAifupWMoevWz0plzgwYnGszWU9N/YyaQV
 CRapHplqpLcpZOOcKQFV35Jmmagu2ZXscj8n2B2LR8S1/l98Ck66l1+p8cnIfk2PwFxj
 IabvnM1oSFD6flQtZ87o7pDP7aS2fgpHaj4/eZhMSUmfyHO4xYBrAqHKEC1DgZPX0HbQ
 ZJK8sEvrIZ61x0FRceVdlR4jR2nVnkOAKIz/yJ7qjS8nhzbphyG7U2LcgkPEi43lEhBH
 ZwXQ==
X-Gm-Message-State: ANhLgQ3bFMY3VTAb1N3kQrb6gB9BXUcf+9V+aZ5Jh1mekpyFjFRsovXQ
 RCV/VEXkpSikhG6tPNF/pLyg1ZMG
X-Google-Smtp-Source: ADFU+vvxZHnGaYdyGv/SRkT7DOIWrsdoK0V6JT//k3EPn7r+HY72vACGGK7mZakR1VNXhBjPFBjXKQ==
X-Received: by 2002:a81:5655:: with SMTP id k82mr1044309ywb.363.1583179863160; 
 Mon, 02 Mar 2020 12:11:03 -0800 (PST)
Received: from four.lan (cpe-67-241-56-252.twcny.res.rr.com. [67.241.56.252])
 by smtp.gmail.com with ESMTPSA id
 s185sm890490ywd.73.2020.03.02.12.11.00
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 02 Mar 2020 12:11:01 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
X-Google-Original-From: Nick Rosbrook <rosbrookn@ainfosec.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  2 Mar 2020 15:10:24 -0500
Message-Id: <d9916032f6214e57caaac1d7a4b8afcf1723ad08.1583179824.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.17.1
Subject: [Xen-devel] [PATCH v2] golang/xenlight: implement constructor
 generation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

R2VuZXJhdGUgY29uc3RydWN0b3JzIGZvciBnZW5lcmF0ZWQgR28gdHlwZXMuIENhbGwgbGlieGxf
PHR5cGU+X2luaXQgc28KdGhlIEdvIHR5cGUgY2FuIGJlIHByb3Blcmx5IGluaXRpYWxpemVkLgoK
SWYgYSB0eXBlIGhhcyBhIGtleWVkIHVuaW9uIGZpZWxkLCBhZGQgYSBwYXJhbWV0ZXIgdG8gdGhl
IGZ1bmN0aW9uCnNpZ25hdHVyZSB0byBzZXQgdGhlIGtleSB2YXJpYWJsZSwgYW5kIGNhbGwgdGhl
IGluaXQgZnVuY3Rpb24gZm9yIHRoZQprZXllZCB1bmlvbi4KClNpZ25lZC1vZmYtYnk6IE5pY2sg
Um9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2dlbmdvdHlwZXMucHkgIHwgICA3MiArKwogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBl
cnMuZ2VuLmdvIHwgMTA2MCArKysrKysrKysrKysrKysrKysrKysrKysrLQogMiBmaWxlcyBjaGFu
Z2VkLCAxMTE0IGluc2VydGlvbnMoKyksIDE4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Rv
b2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5IGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2dlbmdvdHlwZXMucHkKaW5kZXggYjA5Y2ZmYjgyOS4uZjgxMjcxZjNjMCAxMDA2NDQKLS0tIGEv
dG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkKKysrIGIvdG9vbHMvZ29sYW5nL3hl
bmxpZ2h0L2dlbmdvdHlwZXMucHkKQEAgLTIyNSw2ICsyMjUsOSBAQCBkZWYgeGVubGlnaHRfZ29s
YW5nX2dlbmVyYXRlX2hlbHBlcnMocGF0aCA9IE5vbmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9
IE5vbmUpOgogICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UodHksIGlkbC5TdHJ1Y3QpOgog
ICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAKKyAgICAgICAgICAgIGYud3JpdGUoeGVubGlnaHRf
Z29sYW5nX2RlZmluZV9jb25zdHJ1Y3Rvcih0eSkpCisgICAgICAgICAgICBmLndyaXRlKCdcbicp
CisKICAgICAgICAgICAgIChmZGVmLCBleHRyYXMpID0geGVubGlnaHRfZ29sYW5nX2RlZmluZV9m
cm9tX0ModHkpCiAKICAgICAgICAgICAgIGYud3JpdGUoZmRlZikKQEAgLTYxOSw2ICs2MjIsNzUg
QEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19hcnJheV90b19DKHR5ID0gTm9uZSk6CiAKICAgICByZXR1
cm4gcwogCitkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmluZV9jb25zdHJ1Y3Rvcih0eSA9IE5vbmUp
OgorICAgIHMgPSAnJworCisgICAgY3R5cGVuYW1lICA9IHR5LnR5cGVuYW1lCisgICAgZ290eXBl
bmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShjdHlwZW5hbWUpCisKKyAgICAjIFNpbmNl
IHRoaXMgZnVuYyBpcyBleHBvcnRlZCwgYWRkIGEgY29tbWVudCBhcyBwZXIgR28gY29udmVudGlv
bnMuCisgICAgcyArPSAnLy8gTmV3e30gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiB7fScuZm9ybWF0
KGdvdHlwZW5hbWUsZ290eXBlbmFtZSkKKyAgICBzICs9ICcgaW5pdGlhbGl6ZWQgd2l0aCBkZWZh
dWx0cy5cbicKKworICAgICMgSWYgYSBzdHJ1Y3QgaGFzIGEga2V5ZWQgdW5pb24sIGFuIGV4dHJh
IGFyZ3VtZW50IGlzCisgICAgIyByZXF1aXJlZCBpbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlLCBh
bmQgYW4gZXh0cmEgX2luaXQKKyAgICAjIGNhbGwgaXMgbmVlZGVkLgorICAgIHBhcmFtcyAgID0g
W10KKyAgICBpbml0X2ZucyA9IFtdCisKKyAgICAjIEFkZCBjYWxsIHRvIHBhcmVudCBpbml0X2Zu
IGZpcnN0LgorICAgIGluaXRfZm5zLmFwcGVuZCgnQy57fSgmeGMpJy5mb3JtYXQodHkuaW5pdF9m
bikpCisKKyAgICBmb3IgZiBpbiB0eS5maWVsZHM6CisgICAgICAgIGlmIG5vdCBpc2luc3RhbmNl
KGYudHlwZSwgaWRsLktleWVkVW5pb24pOgorICAgICAgICAgICAgY29udGludWUKKworICAgICAg
ICBwYXJhbSA9IGYudHlwZS5rZXl2YXIKKworICAgICAgICBwYXJhbV9jdHlwZSAgPSBwYXJhbS50
eXBlLnR5cGVuYW1lCisgICAgICAgIHBhcmFtX2dvdHlwZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRf
bmFtZShwYXJhbV9jdHlwZSkKKyAgICAgICAgcGFyYW1fZ29uYW1lID0geGVubGlnaHRfZ29sYW5n
X2ZtdF9uYW1lKHBhcmFtLm5hbWUsZXhwb3J0ZWQ9RmFsc2UpCisKKyAgICAgICAgIyBTZXJ2ZXJh
bCBrZXllZCB1bmlvbnMgdXNlICd0eXBlJyBhcyB0aGUga2V5IHZhcmlhYmxlIG5hbWUuIEluCisg
ICAgICAgICMgdGhhdCBjYXNlLCBwcmVwZW5kIHRoZSBmaXJzdCBsZXR0ZXIgb2YgdGhlIEdvIHR5
cGUgbmFtZS4KKyAgICAgICAgaWYgcGFyYW1fZ29uYW1lID09ICd0eXBlJzoKKyAgICAgICAgICAg
IHBhcmFtX2dvbmFtZSA9ICd7fXR5cGUnLmZvcm1hdChwYXJhbV9nb3R5cGUubG93ZXIoKVswXSkK
KworICAgICAgICAjIEFkZCBjYWxsIHRvIGtleWVkIHVuaW9uJ3MgaW5pdF9mbi4KKyAgICAgICAg
aW5pdF9mbnMuYXBwZW5kKCdDLnt9X3t9KCZ4YywgQy57fSh7fSkpJy5mb3JtYXQodHkuaW5pdF9m
biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGFyYW0ubmFtZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcGFyYW1fY3R5cGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtX2dvbmFtZSkpCisKKyAgICAgICAgIyBB
ZGQgdG8gcGFyYW1zIGxpc3QuCisgICAgICAgIHBhcmFtcy5hcHBlbmQoJ3t9IHt9Jy5mb3JtYXQo
cGFyYW1fZ29uYW1lLCBwYXJhbV9nb3R5cGUpKQorCisgICAgIyBEZWZpbmUgZnVuY3Rpb24KKyAg
ICBzICs9ICdmdW5jIE5ld3t9KHt9KSAoKnt9LCBlcnJvcikge3tcbicuZm9ybWF0KGdvdHlwZW5h
bWUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn
LCcuam9pbihwYXJhbXMpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ290eXBlbmFtZSkKKworICAgICMgRGVjbGFyZSB2YXJpYWJsZXMuCisgICAg
cyArPSAndmFyIChcbngge31cbnhjIEMue30pXG5cbicuZm9ybWF0KGdvdHlwZW5hbWUsIGN0eXBl
bmFtZSkKKworICAgICMgV3JpdGUgaW5pdF9mbiBjYWxscy4KKyAgICBzICs9ICdcbicuam9pbihp
bml0X2ZucykKKyAgICBzICs9ICdcbicKKworICAgICMgTWFrZSBzdXJlIGRpc3Bvc2VfZm4gZ2V0
J3MgY2FsbGVkIHdoZW4gY29uc3RydWN0b3IKKyAgICAjIHJldHVybnMuCisgICAgaWYgdHkuZGlz
cG9zZV9mbiBpcyBub3QgTm9uZToKKyAgICAgICAgcyArPSAnZGVmZXIgQy57fSgmeGMpXG4nLmZv
cm1hdCh0eS5kaXNwb3NlX2ZuKQorCisgICAgcyArPSAnXG4nCisKKyAgICAjIENhbGwgZnJvbUMg
dG8gaW5pdGlhbGl6ZSBHbyB0eXBlLgorICAgIHMgKz0gJ2lmIGVyciA6PSB4LmZyb21DKCZ4Yyk7
IGVyciAhPSBuaWwge1xuJworICAgIHMgKz0gJ3JldHVybiBuaWwsIGVyciB9XG5cbicKKyAgICBz
ICs9ICdyZXR1cm4gJngsIG5pbH1cbicKKworICAgIHJldHVybiBzCisKIGRlZiB4ZW5saWdodF9n
b2xhbmdfZm10X25hbWUobmFtZSwgZXhwb3J0ZWQgPSBUcnVlKToKICAgICAiIiIKICAgICBUYWtl
IGEgZ2l2ZW4gdHlwZSBuYW1lIGFuZCByZXR1cm4gYW4KZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFu
Zy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJz
Lmdlbi5nbwppbmRleCA3NDZkOTliNWJhLi5iNGQ3ZGNhMWM2IDEwMDY0NAotLS0gYS90b29scy9n
b2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2hlbHBlcnMuZ2VuLmdvCkBAIC0zMCw2ICszMCwyMyBAQCB0eXBlZGVmIHR5cGVvZigoKHN0cnVj
dCBsaWJ4bF9wc3JfaHdfaW5mbyAqKU5VTEwpLT51Lm1iYSlsaWJ4bF9wc3JfaHdfaW5mb190eXBl
XwogKi8KIGltcG9ydCAiQyIKIAorLy8gTmV3SW9wb3J0UmFuZ2UgcmV0dXJucyBhbiBpbnN0YW5j
ZSBvZiBJb3BvcnRSYW5nZSBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdJb3Bv
cnRSYW5nZSgpICgqSW9wb3J0UmFuZ2UsIGVycm9yKSB7CisJdmFyICgKKwkJeCAgSW9wb3J0UmFu
Z2UKKwkJeGMgQy5saWJ4bF9pb3BvcnRfcmFuZ2UKKwkpCisKKwlDLmxpYnhsX2lvcG9ydF9yYW5n
ZV9pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX2lvcG9ydF9yYW5nZV9kaXNwb3NlKCZ4YykKKwor
CWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIK
Kwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpJb3BvcnRSYW5nZSkgZnJvbUMo
eGMgKkMubGlieGxfaW9wb3J0X3JhbmdlKSBlcnJvciB7CiAJeC5GaXJzdCA9IHVpbnQzMih4Yy5m
aXJzdCkKIAl4Lk51bWJlciA9IHVpbnQzMih4Yy5udW1iZXIpCkBAIC01MCw2ICs2NywyMyBAQCBm
dW5jICh4ICpJb3BvcnRSYW5nZSkgdG9DKHhjICpDLmxpYnhsX2lvcG9ydF9yYW5nZSkgKGVyciBl
cnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3SW9tZW1SYW5nZSByZXR1cm5zIGFuIGlu
c3RhbmNlIG9mIElvbWVtUmFuZ2UgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3
SW9tZW1SYW5nZSgpICgqSW9tZW1SYW5nZSwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBJb21lbVJh
bmdlCisJCXhjIEMubGlieGxfaW9tZW1fcmFuZ2UKKwkpCisKKwlDLmxpYnhsX2lvbWVtX3Jhbmdl
X2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfaW9tZW1fcmFuZ2VfZGlzcG9zZSgmeGMpCisKKwlp
ZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJ
fQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqSW9tZW1SYW5nZSkgZnJvbUMoeGMg
KkMubGlieGxfaW9tZW1fcmFuZ2UpIGVycm9yIHsKIAl4LlN0YXJ0ID0gdWludDY0KHhjLnN0YXJ0
KQogCXguTnVtYmVyID0gdWludDY0KHhjLm51bWJlcikKQEAgLTcyLDYgKzEwNiwyMyBAQCBmdW5j
ICh4ICpJb21lbVJhbmdlKSB0b0MoeGMgKkMubGlieGxfaW9tZW1fcmFuZ2UpIChlcnIgZXJyb3Ip
IHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1ZnYUludGVyZmFjZUluZm8gcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBWZ2FJbnRlcmZhY2VJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitm
dW5jIE5ld1ZnYUludGVyZmFjZUluZm8oKSAoKlZnYUludGVyZmFjZUluZm8sIGVycm9yKSB7CisJ
dmFyICgKKwkJeCAgVmdhSW50ZXJmYWNlSW5mbworCQl4YyBDLmxpYnhsX3ZnYV9pbnRlcmZhY2Vf
aW5mbworCSkKKworCUMubGlieGxfdmdhX2ludGVyZmFjZV9pbmZvX2luaXQoJnhjKQorCWRlZmVy
IEMubGlieGxfdmdhX2ludGVyZmFjZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHgu
ZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVy
biAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZnYUludGVyZmFjZUluZm8pIGZyb21DKHhjICpDLmxp
YnhsX3ZnYV9pbnRlcmZhY2VfaW5mbykgZXJyb3IgewogCXguS2luZCA9IFZnYUludGVyZmFjZVR5
cGUoeGMua2luZCkKIApAQCAtOTAsNiArMTQxLDIzIEBAIGZ1bmMgKHggKlZnYUludGVyZmFjZUlu
Zm8pIHRvQyh4YyAqQy5saWJ4bF92Z2FfaW50ZXJmYWNlX2luZm8pIChlcnIgZXJyb3IpIHsKIAly
ZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1ZuY0luZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBWbmNJ
bmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZuY0luZm8oKSAoKlZuY0lu
Zm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgVm5jSW5mbworCQl4YyBDLmxpYnhsX3ZuY19pbmZv
CisJKQorCisJQy5saWJ4bF92bmNfaW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX3ZuY19p
bmZvX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHgg
KlZuY0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9
IHguRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRW5hYmxlOiAldiIsIGVycikKQEAgLTEyOCw2ICsxOTYs
MjMgQEAgZnVuYyAoeCAqVm5jSW5mbykgdG9DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSAoZXJyIGVy
cm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdTcGljZUluZm8gcmV0dXJucyBhbiBpbnN0
YW5jZSBvZiBTcGljZUluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3U3Bp
Y2VJbmZvKCkgKCpTcGljZUluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgU3BpY2VJbmZvCisJ
CXhjIEMubGlieGxfc3BpY2VfaW5mbworCSkKKworCUMubGlieGxfc3BpY2VfaW5mb19pbml0KCZ4
YykKKwlkZWZlciBDLmxpYnhsX3NwaWNlX2luZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0g
eC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0
dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqU3BpY2VJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9z
cGljZV9pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9IHguRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUp
OyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRW5h
YmxlOiAldiIsIGVycikKQEAgLTE5Niw2ICsyODEsMjMgQEAgZnVuYyAoeCAqU3BpY2VJbmZvKSB0
b0MoeGMgKkMubGlieGxfc3BpY2VfaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3U2RsSW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFNkbEluZm8gaW5pdGlhbGl6
ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3U2RsSW5mbygpICgqU2RsSW5mbywgZXJyb3IpIHsK
Kwl2YXIgKAorCQl4ICBTZGxJbmZvCisJCXhjIEMubGlieGxfc2RsX2luZm8KKwkpCisKKwlDLmxp
YnhsX3NkbF9pbmZvX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfc2RsX2luZm9fZGlzcG9zZSgm
eGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5p
bCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqU2RsSW5mbykgZnJv
bUMoeGMgKkMubGlieGxfc2RsX2luZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJv
bUMoJnhjLmVuYWJsZSk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVy
dGluZyBmaWVsZCBFbmFibGU6ICV2IiwgZXJyKQpAQCAtMjMyLDYgKzMzNCwyMyBAQCBmdW5jICh4
ICpTZGxJbmZvKSB0b0MoeGMgKkMubGlieGxfc2RsX2luZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1
cm4gbmlsCiB9CiAKKy8vIE5ld0RvbWluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEb21pbmZv
IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RvbWluZm8oKSAoKkRvbWluZm8s
IGVycm9yKSB7CisJdmFyICgKKwkJeCAgRG9taW5mbworCQl4YyBDLmxpYnhsX2RvbWluZm8KKwkp
CisKKwlDLmxpYnhsX2RvbWluZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9kb21pbmZvX2Rp
c3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRvbWlu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWluZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5VdWlk
LmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBmbXQuRXJyb3JmKCJjb252
ZXJ0aW5nIGZpZWxkIFV1aWQ6ICV2IiwgZXJyKQpAQCAtMjk2LDYgKzQxNSwyMyBAQCBmdW5jICh4
ICpEb21pbmZvKSB0b0MoeGMgKkMubGlieGxfZG9taW5mbykgKGVyciBlcnJvcikgewogCXJldHVy
biBuaWwKIH0KIAorLy8gTmV3Q3B1cG9vbGluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBDcHVw
b29saW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdDcHVwb29saW5mbygp
ICgqQ3B1cG9vbGluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgQ3B1cG9vbGluZm8KKwkJeGMg
Qy5saWJ4bF9jcHVwb29saW5mbworCSkKKworCUMubGlieGxfY3B1cG9vbGluZm9faW5pdCgmeGMp
CisJZGVmZXIgQy5saWJ4bF9jcHVwb29saW5mb19kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4
LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1
cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpDcHVwb29saW5mbykgZnJvbUMoeGMgKkMubGlieGxf
Y3B1cG9vbGluZm8pIGVycm9yIHsKIAl4LlBvb2xpZCA9IHVpbnQzMih4Yy5wb29saWQpCiAJeC5Q
b29sTmFtZSA9IEMuR29TdHJpbmcoeGMucG9vbF9uYW1lKQpAQCAtMzI4LDYgKzQ2NCwyNCBAQCBm
dW5jICh4ICpDcHVwb29saW5mbykgdG9DKHhjICpDLmxpYnhsX2NwdXBvb2xpbmZvKSAoZXJyIGVy
cm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdDaGFubmVsaW5mbyByZXR1cm5zIGFuIGlu
c3RhbmNlIG9mIENoYW5uZWxpbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5l
d0NoYW5uZWxpbmZvKGNvbm5lY3Rpb24gQ2hhbm5lbENvbm5lY3Rpb24pICgqQ2hhbm5lbGluZm8s
IGVycm9yKSB7CisJdmFyICgKKwkJeCAgQ2hhbm5lbGluZm8KKwkJeGMgQy5saWJ4bF9jaGFubmVs
aW5mbworCSkKKworCUMubGlieGxfY2hhbm5lbGluZm9faW5pdCgmeGMpCisJQy5saWJ4bF9jaGFu
bmVsaW5mb19pbml0X2Nvbm5lY3Rpb24oJnhjLCBDLmxpYnhsX2NoYW5uZWxfY29ubmVjdGlvbihj
b25uZWN0aW9uKSkKKwlkZWZlciBDLmxpYnhsX2NoYW5uZWxpbmZvX2Rpc3Bvc2UoJnhjKQorCisJ
aWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgor
CX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkNoYW5uZWxpbmZvKSBmcm9tQyh4
YyAqQy5saWJ4bF9jaGFubmVsaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmco
eGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtNDAx
LDYgKzU1NSwyMyBAQCBmdW5jICh4ICpDaGFubmVsaW5mbykgdG9DKHhjICpDLmxpYnhsX2NoYW5u
ZWxpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdWbWluZm8gcmV0
dXJucyBhbiBpbnN0YW5jZSBvZiBWbWluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1
bmMgTmV3Vm1pbmZvKCkgKCpWbWluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgVm1pbmZvCisJ
CXhjIEMubGlieGxfdm1pbmZvCisJKQorCisJQy5saWJ4bF92bWluZm9faW5pdCgmeGMpCisJZGVm
ZXIgQy5saWJ4bF92bWluZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwK
K30KKwogZnVuYyAoeCAqVm1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bWluZm8pIGVycm9yIHsK
IAlpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CiAJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFV1aWQ6ICV2IiwgZXJyKQpAQCAtNDI1LDYg
KzU5NiwyMyBAQCBmdW5jICh4ICpWbWluZm8pIHRvQyh4YyAqQy5saWJ4bF92bWluZm8pIChlcnIg
ZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1ZlcnNpb25JbmZvIHJldHVybnMgYW4g
aW5zdGFuY2Ugb2YgVmVyc2lvbkluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMg
TmV3VmVyc2lvbkluZm8oKSAoKlZlcnNpb25JbmZvLCBlcnJvcikgeworCXZhciAoCisJCXggIFZl
cnNpb25JbmZvCisJCXhjIEMubGlieGxfdmVyc2lvbl9pbmZvCisJKQorCisJQy5saWJ4bF92ZXJz
aW9uX2luZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF92ZXJzaW9uX2luZm9fZGlzcG9zZSgm
eGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5p
bCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqVmVyc2lvbkluZm8p
IGZyb21DKHhjICpDLmxpYnhsX3ZlcnNpb25faW5mbykgZXJyb3IgewogCXguWGVuVmVyc2lvbk1h
am9yID0gaW50KHhjLnhlbl92ZXJzaW9uX21ham9yKQogCXguWGVuVmVyc2lvbk1pbm9yID0gaW50
KHhjLnhlbl92ZXJzaW9uX21pbm9yKQpAQCAtNDg1LDYgKzY3MywyMyBAQCBmdW5jICh4ICpWZXJz
aW9uSW5mbykgdG9DKHhjICpDLmxpYnhsX3ZlcnNpb25faW5mbykgKGVyciBlcnJvcikgewogCXJl
dHVybiBuaWwKIH0KIAorLy8gTmV3RG9tYWluQ3JlYXRlSW5mbyByZXR1cm5zIGFuIGluc3RhbmNl
IG9mIERvbWFpbkNyZWF0ZUluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3
RG9tYWluQ3JlYXRlSW5mbygpICgqRG9tYWluQ3JlYXRlSW5mbywgZXJyb3IpIHsKKwl2YXIgKAor
CQl4ICBEb21haW5DcmVhdGVJbmZvCisJCXhjIEMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvCisJ
KQorCisJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4
bF9kb21haW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygm
eGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBu
aWwKK30KKwogZnVuYyAoeCAqRG9tYWluQ3JlYXRlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9t
YWluX2NyZWF0ZV9pbmZvKSBlcnJvciB7CiAJeC5UeXBlID0gRG9tYWluVHlwZSh4Yy5fdHlwZSkK
IAlpZiBlcnIgOj0geC5IYXAuZnJvbUMoJnhjLmhhcCk7IGVyciAhPSBuaWwgewpAQCAtNTYzLDYg
Kzc2OCwyMyBAQCBmdW5jICh4ICpEb21haW5DcmVhdGVJbmZvKSB0b0MoeGMgKkMubGlieGxfZG9t
YWluX2NyZWF0ZV9pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdE
b21haW5SZXN0b3JlUGFyYW1zIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRG9tYWluUmVzdG9yZVBh
cmFtcyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEb21haW5SZXN0b3JlUGFy
YW1zKCkgKCpEb21haW5SZXN0b3JlUGFyYW1zLCBlcnJvcikgeworCXZhciAoCisJCXggIERvbWFp
blJlc3RvcmVQYXJhbXMKKwkJeGMgQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXMKKwkpCisK
KwlDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtc19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhs
X2RvbWFpbl9yZXN0b3JlX3BhcmFtc19kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21D
KCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngs
IG5pbAorfQorCiBmdW5jICh4ICpEb21haW5SZXN0b3JlUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4
bF9kb21haW5fcmVzdG9yZV9wYXJhbXMpIGVycm9yIHsKIAl4LkNoZWNrcG9pbnRlZFN0cmVhbSA9
IGludCh4Yy5jaGVja3BvaW50ZWRfc3RyZWFtKQogCXguU3RyZWFtVmVyc2lvbiA9IHVpbnQzMih4
Yy5zdHJlYW1fdmVyc2lvbikKQEAgLTU5Myw2ICs4MTUsMjMgQEAgZnVuYyAoeCAqRG9tYWluUmVz
dG9yZVBhcmFtcykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgKGVyciBl
cnJvcikKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1NjaGVkUGFyYW1zIHJldHVybnMgYW4gaW5z
dGFuY2Ugb2YgU2NoZWRQYXJhbXMgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3
U2NoZWRQYXJhbXMoKSAoKlNjaGVkUGFyYW1zLCBlcnJvcikgeworCXZhciAoCisJCXggIFNjaGVk
UGFyYW1zCisJCXhjIEMubGlieGxfc2NoZWRfcGFyYW1zCisJKQorCisJQy5saWJ4bF9zY2hlZF9w
YXJhbXNfaW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9zY2hlZF9wYXJhbXNfZGlzcG9zZSgmeGMp
CisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwg
ZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqU2NoZWRQYXJhbXMpIGZy
b21DKHhjICpDLmxpYnhsX3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXguVmNwdWlkID0gaW50KHhj
LnZjcHVpZCkKIAl4LldlaWdodCA9IGludCh4Yy53ZWlnaHQpCkBAIC02MjEsNiArODYwLDIzIEBA
IGZ1bmMgKHggKlNjaGVkUGFyYW1zKSB0b0MoeGMgKkMubGlieGxfc2NoZWRfcGFyYW1zKSAoZXJy
IGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdWY3B1U2NoZWRQYXJhbXMgcmV0dXJu
cyBhbiBpbnN0YW5jZSBvZiBWY3B1U2NoZWRQYXJhbXMgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0
cy4KK2Z1bmMgTmV3VmNwdVNjaGVkUGFyYW1zKCkgKCpWY3B1U2NoZWRQYXJhbXMsIGVycm9yKSB7
CisJdmFyICgKKwkJeCAgVmNwdVNjaGVkUGFyYW1zCisJCXhjIEMubGlieGxfdmNwdV9zY2hlZF9w
YXJhbXMKKwkpCisKKwlDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zX2luaXQoJnhjKQorCWRlZmVy
IEMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXNfZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5m
cm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJu
ICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4
bF92Y3B1X3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2No
ZWQpCiAJbnVtVmNwdXMgOj0gaW50KHhjLm51bV92Y3B1cykKQEAgLTY1Nyw2ICs5MTMsMjMgQEAg
ZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSB0b0MoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJh
bXMpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RvbWFpblNjaGVkUGFy
YW1zIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRG9tYWluU2NoZWRQYXJhbXMgaW5pdGlhbGl6ZWQg
d2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RG9tYWluU2NoZWRQYXJhbXMoKSAoKkRvbWFpblNjaGVk
UGFyYW1zLCBlcnJvcikgeworCXZhciAoCisJCXggIERvbWFpblNjaGVkUGFyYW1zCisJCXhjIEMu
bGlieGxfZG9tYWluX3NjaGVkX3BhcmFtcworCSkKKworCUMubGlieGxfZG9tYWluX3NjaGVkX3Bh
cmFtc19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXNfZGlzcG9z
ZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJu
IG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluU2No
ZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXMpIGVycm9yIHsK
IAl4LlNjaGVkID0gU2NoZWR1bGVyKHhjLnNjaGVkKQogCXguV2VpZ2h0ID0gaW50KHhjLndlaWdo
dCkKQEAgLTY4OSw2ICs5NjIsMjMgQEAgZnVuYyAoeCAqRG9tYWluU2NoZWRQYXJhbXMpIHRvQyh4
YyAqQy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5p
bAogfQogCisvLyBOZXdWbm9kZUluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBWbm9kZUluZm8g
aW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3Vm5vZGVJbmZvKCkgKCpWbm9kZUlu
Zm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgVm5vZGVJbmZvCisJCXhjIEMubGlieGxfdm5vZGVf
aW5mbworCSkKKworCUMubGlieGxfdm5vZGVfaW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhs
X3Zub2RlX2luZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwog
ZnVuYyAoeCAqVm5vZGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSBlcnJvciB7
CiAJeC5NZW1rYiA9IHVpbnQ2NCh4Yy5tZW1rYikKIAludW1EaXN0YW5jZXMgOj0gaW50KHhjLm51
bV9kaXN0YW5jZXMpCkBAIC03MjksNiArMTAxOSwyMyBAQCBmdW5jICh4ICpWbm9kZUluZm8pIHRv
Qyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQog
CisvLyBOZXdSZG1SZXNlcnZlIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUmRtUmVzZXJ2ZSBpbml0
aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdSZG1SZXNlcnZlKCkgKCpSZG1SZXNlcnZl
LCBlcnJvcikgeworCXZhciAoCisJCXggIFJkbVJlc2VydmUKKwkJeGMgQy5saWJ4bF9yZG1fcmVz
ZXJ2ZQorCSkKKworCUMubGlieGxfcmRtX3Jlc2VydmVfaW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4
bF9yZG1fcmVzZXJ2ZV9kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQor
CiBmdW5jICh4ICpSZG1SZXNlcnZlKSBmcm9tQyh4YyAqQy5saWJ4bF9yZG1fcmVzZXJ2ZSkgZXJy
b3IgewogCXguU3RyYXRlZ3kgPSBSZG1SZXNlcnZlU3RyYXRlZ3koeGMuc3RyYXRlZ3kpCiAJeC5Q
b2xpY3kgPSBSZG1SZXNlcnZlUG9saWN5KHhjLnBvbGljeSkKQEAgLTc0OSw2ICsxMDU2LDI0IEBA
IGZ1bmMgKHggKlJkbVJlc2VydmUpIHRvQyh4YyAqQy5saWJ4bF9yZG1fcmVzZXJ2ZSkgKGVyciBl
cnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RG9tYWluQnVpbGRJbmZvIHJldHVybnMg
YW4gaW5zdGFuY2Ugb2YgRG9tYWluQnVpbGRJbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMu
CitmdW5jIE5ld0RvbWFpbkJ1aWxkSW5mbyhkdHlwZSBEb21haW5UeXBlKSAoKkRvbWFpbkJ1aWxk
SW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBEb21haW5CdWlsZEluZm8KKwkJeGMgQy5saWJ4
bF9kb21haW5fYnVpbGRfaW5mbworCSkKKworCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9faW5p
dCgmeGMpCisJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19pbml0X3R5cGUoJnhjLCBDLmxpYnhs
X2RvbWFpbl90eXBlKGR0eXBlKSkKKwlkZWZlciBDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rp
c3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFp
bkJ1aWxkSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsK
IAl4Lk1heFZjcHVzID0gaW50KHhjLm1heF92Y3B1cykKIAlpZiBlcnIgOj0geC5BdmFpbFZjcHVz
LmZyb21DKCZ4Yy5hdmFpbF92Y3B1cyk7IGVyciAhPSBuaWwgewpAQCAtODc4LDE4ICsxMjAzLDE4
IEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1
aWxkX2luZm8pIGVycm9yIHsKIAl4LlRlZSA9IFRlZVR5cGUoeGMudGVlKQogCXguVHlwZSA9IERv
bWFpblR5cGUoeGMuX3R5cGUpCiAJc3dpdGNoIHguVHlwZSB7Ci0JY2FzZSBEb21haW5UeXBlSHZt
OgotCQl2YXIgdHlwZUh2bSBEb21haW5CdWlsZEluZm9UeXBlVW5pb25Idm0KLQkJaWYgZXJyIDo9
IHR5cGVIdm0uZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIHR5cGVIdm06ICV2IiwgZXJyKQotCQl9Ci0JCXguVHlwZVVuaW9uID0g
dHlwZUh2bQogCWNhc2UgRG9tYWluVHlwZVB2OgogCQl2YXIgdHlwZVB2IERvbWFpbkJ1aWxkSW5m
b1R5cGVVbmlvblB2CiAJCWlmIGVyciA6PSB0eXBlUHYuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsK
IAkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVQdjogJXYiLCBlcnIp
CiAJCX0KIAkJeC5UeXBlVW5pb24gPSB0eXBlUHYKKwljYXNlIERvbWFpblR5cGVIdm06CisJCXZh
ciB0eXBlSHZtIERvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvbkh2bQorCQlpZiBlcnIgOj0gdHlwZUh2
bS5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgdHlwZUh2bTogJXYiLCBlcnIpCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlSHZt
CiAJY2FzZSBEb21haW5UeXBlUHZoOgogCQl2YXIgdHlwZVB2aCBEb21haW5CdWlsZEluZm9UeXBl
VW5pb25QdmgKIAkJaWYgZXJyIDo9IHR5cGVQdmguZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKQEAg
LTE0MDYsNiArMTczMSwyMyBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5s
aWJ4bF9kb21haW5fYnVpbGRfaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAor
Ly8gTmV3RGV2aWNlVmZiIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlVmZiIGluaXRpYWxp
emVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RldmljZVZmYigpICgqRGV2aWNlVmZiLCBlcnJv
cikgeworCXZhciAoCisJCXggIERldmljZVZmYgorCQl4YyBDLmxpYnhsX2RldmljZV92ZmIKKwkp
CisKKwlDLmxpYnhsX2RldmljZV92ZmJfaW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9kZXZpY2Vf
dmZiX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHgg
KkRldmljZVZmYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgZXJyb3IgewogCXguQmFj
a2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0g
Qy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC0xNDQ2LDYgKzE3ODgsMjMgQEAgZnVu
YyAoeCAqRGV2aWNlVmZiKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgKGVyciBlcnJvcikg
ewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlVmtiIHJldHVybnMgYW4gaW5zdGFuY2Ug
b2YgRGV2aWNlVmtiIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RldmljZVZr
YigpICgqRGV2aWNlVmtiLCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZVZrYgorCQl4YyBD
LmxpYnhsX2RldmljZV92a2IKKwkpCisKKwlDLmxpYnhsX2RldmljZV92a2JfaW5pdCgmeGMpCisJ
ZGVmZXIgQy5saWJ4bF9kZXZpY2VfdmtiX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJv
bUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAm
eCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZrYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNl
X3ZrYikgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkK
IAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC0x
NDk2LDYgKzE4NTUsMjMgQEAgZnVuYyAoeCAqRGV2aWNlVmtiKSB0b0MoeGMgKkMubGlieGxfZGV2
aWNlX3ZrYikgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlRGlz
ayByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERldmljZURpc2sgaW5pdGlhbGl6ZWQgd2l0aCBkZWZh
dWx0cy4KK2Z1bmMgTmV3RGV2aWNlRGlzaygpICgqRGV2aWNlRGlzaywgZXJyb3IpIHsKKwl2YXIg
KAorCQl4ICBEZXZpY2VEaXNrCisJCXhjIEMubGlieGxfZGV2aWNlX2Rpc2sKKwkpCisKKwlDLmxp
YnhsX2RldmljZV9kaXNrX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfZGV2aWNlX2Rpc2tfZGlz
cG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNl
RGlzaykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX2Rpc2spIGVycm9yIHsKIAl4LkJhY2tlbmRE
b21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29T
dHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtMTU3OCw2ICsxOTU0LDIzIEBAIGZ1bmMgKHgg
KkRldmljZURpc2spIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfZGlzaykgKGVyciBlcnJvcikgewog
CXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlTmljIHJldHVybnMgYW4gaW5zdGFuY2Ugb2Yg
RGV2aWNlTmljIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RldmljZU5pYygp
ICgqRGV2aWNlTmljLCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZU5pYworCQl4YyBDLmxp
YnhsX2RldmljZV9uaWMKKwkpCisKKwlDLmxpYnhsX2RldmljZV9uaWNfaW5pdCgmeGMpCisJZGVm
ZXIgQy5saWJ4bF9kZXZpY2VfbmljX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMo
JnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwg
bmlsCit9CisKIGZ1bmMgKHggKkRldmljZU5pYykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX25p
YykgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4
LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC0xODM2
LDYgKzIyMjksMjMgQEAgZnVuYyAoeCAqRGV2aWNlTmljKSB0b0MoeGMgKkMubGlieGxfZGV2aWNl
X25pYykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3RGV2aWNlUGNpIHJl
dHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlUGNpIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMu
CitmdW5jIE5ld0RldmljZVBjaSgpICgqRGV2aWNlUGNpLCBlcnJvcikgeworCXZhciAoCisJCXgg
IERldmljZVBjaQorCQl4YyBDLmxpYnhsX2RldmljZV9wY2kKKwkpCisKKwlDLmxpYnhsX2Rldmlj
ZV9wY2lfaW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9kZXZpY2VfcGNpX2Rpc3Bvc2UoJnhjKQor
CisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVy
cgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVBjaSkgZnJvbUMo
eGMgKkMubGlieGxfZGV2aWNlX3BjaSkgZXJyb3IgewogCXguRnVuYyA9IGJ5dGUoeGMuX2Z1bmMp
CiAJeC5EZXYgPSBieXRlKHhjLmRldikKQEAgLTE4NzQsNiArMjI4NCwyMyBAQCBmdW5jICh4ICpE
ZXZpY2VQY2kpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfcGNpKSAoZXJyIGVycm9yKSB7CiAJcmV0
dXJuIG5pbAogfQogCisvLyBOZXdEZXZpY2VSZG0gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZp
Y2VSZG0gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RGV2aWNlUmRtKCkgKCpE
ZXZpY2VSZG0sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgRGV2aWNlUmRtCisJCXhjIEMubGlieGxf
ZGV2aWNlX3JkbQorCSkKKworCUMubGlieGxfZGV2aWNlX3JkbV9pbml0KCZ4YykKKwlkZWZlciBD
LmxpYnhsX2RldmljZV9yZG1fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwK
K30KKwogZnVuYyAoeCAqRGV2aWNlUmRtKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcmRtKSBl
cnJvciB7CiAJeC5TdGFydCA9IHVpbnQ2NCh4Yy5zdGFydCkKIAl4LlNpemUgPSB1aW50NjQoeGMu
c2l6ZSkKQEAgLTE4OTYsNiArMjMyMywyMyBAQCBmdW5jICh4ICpEZXZpY2VSZG0pIHRvQyh4YyAq
Qy5saWJ4bF9kZXZpY2VfcmRtKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBO
ZXdEZXZpY2VVc2JjdHJsIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgRGV2aWNlVXNiY3RybCBpbml0
aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VVc2JjdHJsKCkgKCpEZXZpY2VV
c2JjdHJsLCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZVVzYmN0cmwKKwkJeGMgQy5saWJ4
bF9kZXZpY2VfdXNiY3RybAorCSkKKworCUMubGlieGxfZGV2aWNlX3VzYmN0cmxfaW5pdCgmeGMp
CisJZGVmZXIgQy5saWJ4bF9kZXZpY2VfdXNiY3RybF9kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6
PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwly
ZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfdXNiY3RybCkgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90
eXBlKQogCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKQEAgLTE5MjYsNiArMjM3MCwyNCBAQCBm
dW5jICh4ICpEZXZpY2VVc2JjdHJsKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3VzYmN0cmwpIChl
cnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RldmljZVVzYmRldiByZXR1cm5z
IGFuIGluc3RhbmNlIG9mIERldmljZVVzYmRldiBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgor
ZnVuYyBOZXdEZXZpY2VVc2JkZXYodXR5cGUgVXNiZGV2VHlwZSkgKCpEZXZpY2VVc2JkZXYsIGVy
cm9yKSB7CisJdmFyICgKKwkJeCAgRGV2aWNlVXNiZGV2CisJCXhjIEMubGlieGxfZGV2aWNlX3Vz
YmRldgorCSkKKworCUMubGlieGxfZGV2aWNlX3VzYmRldl9pbml0KCZ4YykKKwlDLmxpYnhsX2Rl
dmljZV91c2JkZXZfaW5pdF90eXBlKCZ4YywgQy5saWJ4bF91c2JkZXZfdHlwZSh1dHlwZSkpCisJ
ZGVmZXIgQy5saWJ4bF9kZXZpY2VfdXNiZGV2X2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHgu
ZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVy
biAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVVzYmRldikgZnJvbUMoeGMgKkMubGlieGxf
ZGV2aWNlX3VzYmRldikgZXJyb3IgewogCXguQ3RybCA9IERldmlkKHhjLmN0cmwpCiAJeC5Qb3J0
ID0gaW50KHhjLnBvcnQpCkBAIC0xOTgzLDYgKzI0NDUsMjMgQEAgZnVuYyAoeCAqRGV2aWNlVXNi
ZGV2KSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3VzYmRldikgKGVyciBlcnJvcikgewogCXJldHVy
biBuaWwKIH0KIAorLy8gTmV3RGV2aWNlRHRkZXYgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZp
Y2VEdGRldiBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VEdGRldigp
ICgqRGV2aWNlRHRkZXYsIGVycm9yKSB7CisJdmFyICgKKwkJeCAgRGV2aWNlRHRkZXYKKwkJeGMg
Qy5saWJ4bF9kZXZpY2VfZHRkZXYKKwkpCisKKwlDLmxpYnhsX2RldmljZV9kdGRldl9pbml0KCZ4
YykKKwlkZWZlciBDLmxpYnhsX2RldmljZV9kdGRldl9kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6
PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwly
ZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VEdGRldikgZnJvbUMoeGMgKkMubGli
eGxfZGV2aWNlX2R0ZGV2KSBlcnJvciB7CiAJeC5QYXRoID0gQy5Hb1N0cmluZyh4Yy5wYXRoKQog
CkBAIC0yMDAzLDYgKzI0ODIsMjMgQEAgZnVuYyAoeCAqRGV2aWNlRHRkZXYpIHRvQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfZHRkZXYpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5l
d0RldmljZVZ0cG0gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VWdHBtIGluaXRpYWxpemVk
IHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RldmljZVZ0cG0oKSAoKkRldmljZVZ0cG0sIGVycm9y
KSB7CisJdmFyICgKKwkJeCAgRGV2aWNlVnRwbQorCQl4YyBDLmxpYnhsX2RldmljZV92dHBtCisJ
KQorCisJQy5saWJ4bF9kZXZpY2VfdnRwbV9pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX2Rldmlj
ZV92dHBtX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMg
KHggKkRldmljZVZ0cG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJvciB7CiAJ
eC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5h
bWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTIwMzMsNiArMjUyOSwyMyBA
QCBmdW5jICh4ICpEZXZpY2VWdHBtKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3Z0cG0pIChlcnIg
ZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RldmljZVA5IHJldHVybnMgYW4gaW5z
dGFuY2Ugb2YgRGV2aWNlUDkgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RGV2
aWNlUDkoKSAoKkRldmljZVA5LCBlcnJvcikgeworCXZhciAoCisJCXggIERldmljZVA5CisJCXhj
IEMubGlieGxfZGV2aWNlX3A5CisJKQorCisJQy5saWJ4bF9kZXZpY2VfcDlfaW5pdCgmeGMpCisJ
ZGVmZXIgQy5saWJ4bF9kZXZpY2VfcDlfZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9t
QygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4
LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlUDkpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9w
OSkgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4
LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC0yMDY5
LDYgKzI1ODIsMjMgQEAgZnVuYyAoeCAqRGV2aWNlUDkpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
cDkpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RldmljZVB2Y2FsbHNp
ZiByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERldmljZVB2Y2FsbHNpZiBpbml0aWFsaXplZCB3aXRo
IGRlZmF1bHRzLgorZnVuYyBOZXdEZXZpY2VQdmNhbGxzaWYoKSAoKkRldmljZVB2Y2FsbHNpZiwg
ZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBEZXZpY2VQdmNhbGxzaWYKKwkJeGMgQy5saWJ4bF9kZXZp
Y2VfcHZjYWxsc2lmCisJKQorCisJQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmX2luaXQoJnhjKQor
CWRlZmVyIEMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZl9kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6
PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwly
ZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VQdmNhbGxzaWYpIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV9wdmNhbGxzaWYpIGVycm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlk
KHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZF9kb21uYW1lKQpAQCAtMjA5Myw2ICsyNjIzLDI0IEBAIGZ1bmMgKHggKkRldmljZVB2Y2Fs
bHNpZikgdG9DKHhjICpDLmxpYnhsX2RldmljZV9wdmNhbGxzaWYpIChlcnIgZXJyb3IpIHsKIAly
ZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RldmljZUNoYW5uZWwgcmV0dXJucyBhbiBpbnN0YW5jZSBv
ZiBEZXZpY2VDaGFubmVsIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0Rldmlj
ZUNoYW5uZWwoY29ubmVjdGlvbiBDaGFubmVsQ29ubmVjdGlvbikgKCpEZXZpY2VDaGFubmVsLCBl
cnJvcikgeworCXZhciAoCisJCXggIERldmljZUNoYW5uZWwKKwkJeGMgQy5saWJ4bF9kZXZpY2Vf
Y2hhbm5lbAorCSkKKworCUMubGlieGxfZGV2aWNlX2NoYW5uZWxfaW5pdCgmeGMpCisJQy5saWJ4
bF9kZXZpY2VfY2hhbm5lbF9pbml0X2Nvbm5lY3Rpb24oJnhjLCBDLmxpYnhsX2NoYW5uZWxfY29u
bmVjdGlvbihjb25uZWN0aW9uKSkKKwlkZWZlciBDLmxpYnhsX2RldmljZV9jaGFubmVsX2Rpc3Bv
c2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVy
biBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZUNo
YW5uZWwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9jaGFubmVsKSBlcnJvciB7CiAJeC5CYWNr
ZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBD
LkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTIxNTgsNiArMjcwNiwyMyBAQCBmdW5j
ICh4ICpEZXZpY2VDaGFubmVsKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX2NoYW5uZWwpIChlcnIg
ZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0Nvbm5lY3RvclBhcmFtIHJldHVybnMg
YW4gaW5zdGFuY2Ugb2YgQ29ubmVjdG9yUGFyYW0gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4K
K2Z1bmMgTmV3Q29ubmVjdG9yUGFyYW0oKSAoKkNvbm5lY3RvclBhcmFtLCBlcnJvcikgeworCXZh
ciAoCisJCXggIENvbm5lY3RvclBhcmFtCisJCXhjIEMubGlieGxfY29ubmVjdG9yX3BhcmFtCisJ
KQorCisJQy5saWJ4bF9jb25uZWN0b3JfcGFyYW1faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9j
b25uZWN0b3JfcGFyYW1fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBl
cnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30K
KwogZnVuYyAoeCAqQ29ubmVjdG9yUGFyYW0pIGZyb21DKHhjICpDLmxpYnhsX2Nvbm5lY3Rvcl9w
YXJhbSkgZXJyb3IgewogCXguVW5pcXVlSWQgPSBDLkdvU3RyaW5nKHhjLnVuaXF1ZV9pZCkKIAl4
LldpZHRoID0gdWludDMyKHhjLndpZHRoKQpAQCAtMjE4Miw2ICsyNzQ3LDIzIEBAIGZ1bmMgKHgg
KkNvbm5lY3RvclBhcmFtKSB0b0MoeGMgKkMubGlieGxfY29ubmVjdG9yX3BhcmFtKSAoZXJyIGVy
cm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdEZXZpY2VWZGlzcGwgcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBEZXZpY2VWZGlzcGwgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMg
TmV3RGV2aWNlVmRpc3BsKCkgKCpEZXZpY2VWZGlzcGwsIGVycm9yKSB7CisJdmFyICgKKwkJeCAg
RGV2aWNlVmRpc3BsCisJCXhjIEMubGlieGxfZGV2aWNlX3ZkaXNwbAorCSkKKworCUMubGlieGxf
ZGV2aWNlX3ZkaXNwbF9pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX2RldmljZV92ZGlzcGxfZGlz
cG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNl
VmRpc3BsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmRpc3BsKSBlcnJvciB7CiAJeC5CYWNr
ZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBD
LkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTIyMjYsNiArMjgwOCwyMyBAQCBmdW5j
ICh4ICpEZXZpY2VWZGlzcGwpIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmRpc3BsKSAoZXJyIGVy
cm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdWc25kUGFyYW1zIHJldHVybnMgYW4gaW5z
dGFuY2Ugb2YgVnNuZFBhcmFtcyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdW
c25kUGFyYW1zKCkgKCpWc25kUGFyYW1zLCBlcnJvcikgeworCXZhciAoCisJCXggIFZzbmRQYXJh
bXMKKwkJeGMgQy5saWJ4bF92c25kX3BhcmFtcworCSkKKworCUMubGlieGxfdnNuZF9wYXJhbXNf
aW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF92c25kX3BhcmFtc19kaXNwb3NlKCZ4YykKKworCWlm
IGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9
CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpWc25kUGFyYW1zKSBmcm9tQyh4YyAq
Qy5saWJ4bF92c25kX3BhcmFtcykgZXJyb3IgewogCW51bVNhbXBsZVJhdGVzIDo9IGludCh4Yy5u
dW1fc2FtcGxlX3JhdGVzKQogCWNTYW1wbGVSYXRlcyA6PSAoKlsxIDw8IDI4XUMudWludDMyX3Qp
KHVuc2FmZS5Qb2ludGVyKHhjLnNhbXBsZV9yYXRlcykpWzpudW1TYW1wbGVSYXRlczpudW1TYW1w
bGVSYXRlc10KQEAgLTIyNzYsNiArMjg3NSwyMyBAQCBmdW5jICh4ICpWc25kUGFyYW1zKSB0b0Mo
eGMgKkMubGlieGxfdnNuZF9wYXJhbXMpIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAK
Ky8vIE5ld1ZzbmRTdHJlYW0gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBWc25kU3RyZWFtIGluaXRp
YWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld1ZzbmRTdHJlYW0oKSAoKlZzbmRTdHJlYW0s
IGVycm9yKSB7CisJdmFyICgKKwkJeCAgVnNuZFN0cmVhbQorCQl4YyBDLmxpYnhsX3ZzbmRfc3Ry
ZWFtCisJKQorCisJQy5saWJ4bF92c25kX3N0cmVhbV9pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhs
X3ZzbmRfc3RyZWFtX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJy
ICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisK
IGZ1bmMgKHggKlZzbmRTdHJlYW0pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfc3RyZWFtKSBlcnJv
ciB7CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQogCXguVHlwZSA9IFZz
bmRTdHJlYW1UeXBlKHhjLl90eXBlKQpAQCAtMjMwNCw2ICsyOTIwLDIzIEBAIGZ1bmMgKHggKlZz
bmRTdHJlYW0pIHRvQyh4YyAqQy5saWJ4bF92c25kX3N0cmVhbSkgKGVyciBlcnJvcikgewogCXJl
dHVybiBuaWwKIH0KIAorLy8gTmV3VnNuZFBjbSByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZzbmRQ
Y20gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VnNuZFBjbSgpICgqVnNuZFBj
bSwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWc25kUGNtCisJCXhjIEMubGlieGxfdnNuZF9wY20K
KwkpCisKKwlDLmxpYnhsX3ZzbmRfcGNtX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfdnNuZF9w
Y21fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAq
VnNuZFBjbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wY20pIGVycm9yIHsKIAl4Lk5hbWUgPSBD
LkdvU3RyaW5nKHhjLm5hbWUpCiAJaWYgZXJyIDo9IHguUGFyYW1zLmZyb21DKCZ4Yy5wYXJhbXMp
OyBlcnIgIT0gbmlsIHsKQEAgLTIzNDgsNiArMjk4MSwyMyBAQCBmdW5jICh4ICpWc25kUGNtKSB0
b0MoeGMgKkMubGlieGxfdnNuZF9wY20pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAK
Ky8vIE5ld0RldmljZVZzbmQgcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEZXZpY2VWc25kIGluaXRp
YWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0RldmljZVZzbmQoKSAoKkRldmljZVZzbmQs
IGVycm9yKSB7CisJdmFyICgKKwkJeCAgRGV2aWNlVnNuZAorCQl4YyBDLmxpYnhsX2RldmljZV92
c25kCisJKQorCisJQy5saWJ4bF9kZXZpY2VfdnNuZF9pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhs
X2RldmljZV92c25kX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJy
ICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisK
IGZ1bmMgKHggKkRldmljZVZzbmQpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92c25kKSBlcnJv
ciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2Vu
ZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTI0MDQsNiArMzA1
NCwyMyBAQCBmdW5jICh4ICpEZXZpY2VWc25kKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3ZzbmQp
IChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0RvbWFpbkNvbmZpZyByZXR1
cm5zIGFuIGluc3RhbmNlIG9mIERvbWFpbkNvbmZpZyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRz
LgorZnVuYyBOZXdEb21haW5Db25maWcoKSAoKkRvbWFpbkNvbmZpZywgZXJyb3IpIHsKKwl2YXIg
KAorCQl4ICBEb21haW5Db25maWcKKwkJeGMgQy5saWJ4bF9kb21haW5fY29uZmlnCisJKQorCisJ
Qy5saWJ4bF9kb21haW5fY29uZmlnX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfZG9tYWluX2Nv
bmZpZ19kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4
ICpEb21haW5Db25maWcpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIGVycm9yIHsK
IAlpZiBlcnIgOj0geC5DSW5mby5mcm9tQygmeGMuY19pbmZvKTsgZXJyICE9IG5pbCB7CiAJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENJbmZvOiAldiIsIGVycikKQEAgLTI3
MTIsNiArMzM3OSwyMyBAQCBmdW5jICh4ICpEb21haW5Db25maWcpIHRvQyh4YyAqQy5saWJ4bF9k
b21haW5fY29uZmlnKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdEaXNr
aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIERpc2tpbmZvIGluaXRpYWxpemVkIHdpdGggZGVm
YXVsdHMuCitmdW5jIE5ld0Rpc2tpbmZvKCkgKCpEaXNraW5mbywgZXJyb3IpIHsKKwl2YXIgKAor
CQl4ICBEaXNraW5mbworCQl4YyBDLmxpYnhsX2Rpc2tpbmZvCisJKQorCisJQy5saWJ4bF9kaXNr
aW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX2Rpc2tpbmZvX2Rpc3Bvc2UoJnhjKQorCisJ
aWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgor
CX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkRpc2tpbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF9kaXNraW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMjc0OCw2ICsz
NDMyLDIzIEBAIGZ1bmMgKHggKkRpc2tpbmZvKSB0b0MoeGMgKkMubGlieGxfZGlza2luZm8pIChl
cnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld05pY2luZm8gcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBOaWNpbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld05p
Y2luZm8oKSAoKk5pY2luZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgTmljaW5mbworCQl4YyBD
LmxpYnhsX25pY2luZm8KKwkpCisKKwlDLmxpYnhsX25pY2luZm9faW5pdCgmeGMpCisJZGVmZXIg
Qy5saWJ4bF9uaWNpbmZvX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9
CisKIGZ1bmMgKHggKk5pY2luZm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsK
IAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50
MzIoeGMuYmFja2VuZF9pZCkKQEAgLTI3ODYsNiArMzQ4NywyMyBAQCBmdW5jICh4ICpOaWNpbmZv
KSB0b0MoeGMgKkMubGlieGxfbmljaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3VnRwbWluZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBWdHBtaW5mbyBpbml0aWFs
aXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdWdHBtaW5mbygpICgqVnRwbWluZm8sIGVycm9y
KSB7CisJdmFyICgKKwkJeCAgVnRwbWluZm8KKwkJeGMgQy5saWJ4bF92dHBtaW5mbworCSkKKwor
CUMubGlieGxfdnRwbWluZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF92dHBtaW5mb19kaXNw
b3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpWdHBtaW5m
bykgZnJvbUMoeGMgKkMubGlieGxfdnRwbWluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdv
U3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkK
QEAgLTI4MjgsNiArMzU0NiwyMyBAQCBmdW5jICh4ICpWdHBtaW5mbykgdG9DKHhjICpDLmxpYnhs
X3Z0cG1pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdVc2JjdHJs
aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFVzYmN0cmxpbmZvIGluaXRpYWxpemVkIHdpdGgg
ZGVmYXVsdHMuCitmdW5jIE5ld1VzYmN0cmxpbmZvKCkgKCpVc2JjdHJsaW5mbywgZXJyb3IpIHsK
Kwl2YXIgKAorCQl4ICBVc2JjdHJsaW5mbworCQl4YyBDLmxpYnhsX3VzYmN0cmxpbmZvCisJKQor
CisJQy5saWJ4bF91c2JjdHJsaW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX3VzYmN0cmxp
bmZvX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHgg
KlVzYmN0cmxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF91c2JjdHJsaW5mbykgZXJyb3IgewogCXgu
VHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90eXBlKQogCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkK
QEAgLTI4NzIsNiArMzYwNywyMyBAQCBmdW5jICh4ICpVc2JjdHJsaW5mbykgdG9DKHhjICpDLmxp
YnhsX3VzYmN0cmxpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdW
Y3B1aW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZjcHVpbmZvIGluaXRpYWxpemVkIHdpdGgg
ZGVmYXVsdHMuCitmdW5jIE5ld1ZjcHVpbmZvKCkgKCpWY3B1aW5mbywgZXJyb3IpIHsKKwl2YXIg
KAorCQl4ICBWY3B1aW5mbworCQl4YyBDLmxpYnhsX3ZjcHVpbmZvCisJKQorCisJQy5saWJ4bF92
Y3B1aW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX3ZjcHVpbmZvX2Rpc3Bvc2UoJnhjKQor
CisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBuaWwsIGVy
cgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlZjcHVpbmZvKSBmcm9tQyh4
YyAqQy5saWJ4bF92Y3B1aW5mbykgZXJyb3IgewogCXguVmNwdWlkID0gdWludDMyKHhjLnZjcHVp
ZCkKIAl4LkNwdSA9IHVpbnQzMih4Yy5jcHUpCkBAIC0yOTEyLDYgKzM2NjQsMjMgQEAgZnVuYyAo
eCAqVmNwdWluZm8pIHRvQyh4YyAqQy5saWJ4bF92Y3B1aW5mbykgKGVyciBlcnJvcikgewogCXJl
dHVybiBuaWwKIH0KIAorLy8gTmV3UGh5c2luZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBQaHlz
aW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdQaHlzaW5mbygpICgqUGh5
c2luZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgUGh5c2luZm8KKwkJeGMgQy5saWJ4bF9waHlz
aW5mbworCSkKKworCUMubGlieGxfcGh5c2luZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9w
aHlzaW5mb19kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5j
ICh4ICpQaHlzaW5mbykgZnJvbUMoeGMgKkMubGlieGxfcGh5c2luZm8pIGVycm9yIHsKIAl4LlRo
cmVhZHNQZXJDb3JlID0gdWludDMyKHhjLnRocmVhZHNfcGVyX2NvcmUpCiAJeC5Db3Jlc1BlclNv
Y2tldCA9IHVpbnQzMih4Yy5jb3Jlc19wZXJfc29ja2V0KQpAQCAtMjk3Miw2ICszNzQxLDIzIEBA
IGZ1bmMgKHggKlBoeXNpbmZvKSB0b0MoeGMgKkMubGlieGxfcGh5c2luZm8pIChlcnIgZXJyb3Ip
IHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0Nvbm5lY3RvcmluZm8gcmV0dXJucyBhbiBpbnN0
YW5jZSBvZiBDb25uZWN0b3JpbmZvIGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5l
d0Nvbm5lY3RvcmluZm8oKSAoKkNvbm5lY3RvcmluZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAg
Q29ubmVjdG9yaW5mbworCQl4YyBDLmxpYnhsX2Nvbm5lY3RvcmluZm8KKwkpCisKKwlDLmxpYnhs
X2Nvbm5lY3RvcmluZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9jb25uZWN0b3JpbmZvX2Rp
c3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKkNvbm5l
Y3RvcmluZm8pIGZyb21DKHhjICpDLmxpYnhsX2Nvbm5lY3RvcmluZm8pIGVycm9yIHsKIAl4LlVu
aXF1ZUlkID0gQy5Hb1N0cmluZyh4Yy51bmlxdWVfaWQpCiAJeC5XaWR0aCA9IHVpbnQzMih4Yy53
aWR0aCkKQEAgLTMwMDQsNiArMzc5MCwyMyBAQCBmdW5jICh4ICpDb25uZWN0b3JpbmZvKSB0b0Mo
eGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0K
IAorLy8gTmV3VmRpc3BsaW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIFZkaXNwbGluZm8gaW5p
dGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VmRpc3BsaW5mbygpICgqVmRpc3BsaW5m
bywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWZGlzcGxpbmZvCisJCXhjIEMubGlieGxfdmRpc3Bs
aW5mbworCSkKKworCUMubGlieGxfdmRpc3BsaW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhs
X3ZkaXNwbGluZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwog
ZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmRpc3BsaW5mbykgZXJyb3Ig
ewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVp
bnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMzA1Niw2ICszODU5LDIzIEBAIGZ1bmMgKHggKlZkaXNw
bGluZm8pIHRvQyh4YyAqQy5saWJ4bF92ZGlzcGxpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdTdHJlYW1pbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgU3RyZWFt
aW5mbyBpbml0aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdTdHJlYW1pbmZvKCkgKCpT
dHJlYW1pbmZvLCBlcnJvcikgeworCXZhciAoCisJCXggIFN0cmVhbWluZm8KKwkJeGMgQy5saWJ4
bF9zdHJlYW1pbmZvCisJKQorCisJQy5saWJ4bF9zdHJlYW1pbmZvX2luaXQoJnhjKQorCWRlZmVy
IEMubGlieGxfc3RyZWFtaW5mb19kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4
Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5p
bAorfQorCiBmdW5jICh4ICpTdHJlYW1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zdHJlYW1pbmZv
KSBlcnJvciB7CiAJeC5SZXFFdnRjaCA9IGludCh4Yy5yZXFfZXZ0Y2gpCiAJeC5SZXFScmVmID0g
aW50KHhjLnJlcV9ycmVmKQpAQCAtMzA3Niw2ICszODk2LDIzIEBAIGZ1bmMgKHggKlN0cmVhbWlu
Zm8pIHRvQyh4YyAqQy5saWJ4bF9zdHJlYW1pbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5p
bAogfQogCisvLyBOZXdQY21pbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgUGNtaW5mbyBpbml0
aWFsaXplZCB3aXRoIGRlZmF1bHRzLgorZnVuYyBOZXdQY21pbmZvKCkgKCpQY21pbmZvLCBlcnJv
cikgeworCXZhciAoCisJCXggIFBjbWluZm8KKwkJeGMgQy5saWJ4bF9wY21pbmZvCisJKQorCisJ
Qy5saWJ4bF9wY21pbmZvX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfcGNtaW5mb19kaXNwb3Nl
KCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4g
bmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5pbAorfQorCiBmdW5jICh4ICpQY21pbmZvKSBm
cm9tQyh4YyAqQy5saWJ4bF9wY21pbmZvKSBlcnJvciB7CiAJbnVtVnNuZFN0cmVhbXMgOj0gaW50
KHhjLm51bV92c25kX3N0cmVhbXMpCiAJY1N0cmVhbXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3N0
cmVhbWluZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnN0cmVhbXMpKVs6bnVtVnNuZFN0cmVhbXM6bnVt
VnNuZFN0cmVhbXNdCkBAIC0zMTEwLDYgKzM5NDcsMjMgQEAgZnVuYyAoeCAqUGNtaW5mbykgdG9D
KHhjICpDLmxpYnhsX3BjbWluZm8pIChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8v
IE5ld1ZzbmRpbmZvIHJldHVybnMgYW4gaW5zdGFuY2Ugb2YgVnNuZGluZm8gaW5pdGlhbGl6ZWQg
d2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3VnNuZGluZm8oKSAoKlZzbmRpbmZvLCBlcnJvcikgewor
CXZhciAoCisJCXggIFZzbmRpbmZvCisJCXhjIEMubGlieGxfdnNuZGluZm8KKwkpCisKKwlDLmxp
YnhsX3ZzbmRpbmZvX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfdnNuZGluZm9fZGlzcG9zZSgm
eGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5p
bCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqVnNuZGluZm8pIGZy
b21DKHhjICpDLmxpYnhsX3ZzbmRpbmZvKSBlcnJvciB7CiAJeC5CYWNrZW5kID0gQy5Hb1N0cmlu
Zyh4Yy5iYWNrZW5kKQogCXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQpCkBAIC0z
MTYwLDYgKzQwMTQsMjMgQEAgZnVuYyAoeCAqVnNuZGluZm8pIHRvQyh4YyAqQy5saWJ4bF92c25k
aW5mbykgKGVyciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3VmtiaW5mbyByZXR1
cm5zIGFuIGluc3RhbmNlIG9mIFZrYmluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1
bmMgTmV3VmtiaW5mbygpICgqVmtiaW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBWa2JpbmZv
CisJCXhjIEMubGlieGxfdmtiaW5mbworCSkKKworCUMubGlieGxfdmtiaW5mb19pbml0KCZ4YykK
KwlkZWZlciBDLmxpYnhsX3ZrYmluZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9t
QygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4
LCBuaWwKK30KKwogZnVuYyAoeCAqVmtiaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmtiaW5mbykg
ZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJ
ZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMzE5Niw2ICs0MDY3LDIzIEBAIGZ1bmMgKHgg
KlZrYmluZm8pIHRvQyh4YyAqQy5saWJ4bF92a2JpbmZvKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJu
IG5pbAogfQogCisvLyBOZXdOdW1haW5mbyByZXR1cm5zIGFuIGluc3RhbmNlIG9mIE51bWFpbmZv
IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld051bWFpbmZvKCkgKCpOdW1haW5m
bywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBOdW1haW5mbworCQl4YyBDLmxpYnhsX251bWFpbmZv
CisJKQorCisJQy5saWJ4bF9udW1haW5mb19pbml0KCZ4YykKKwlkZWZlciBDLmxpYnhsX251bWFp
bmZvX2Rpc3Bvc2UoJnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBuaWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHgg
Kk51bWFpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9udW1haW5mbykgZXJyb3IgewogCXguU2l6ZSA9
IHVpbnQ2NCh4Yy5zaXplKQogCXguRnJlZSA9IHVpbnQ2NCh4Yy5mcmVlKQpAQCAtMzIzMCw2ICs0
MTE4LDIzIEBAIGZ1bmMgKHggKk51bWFpbmZvKSB0b0MoeGMgKkMubGlieGxfbnVtYWluZm8pIChl
cnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld0NwdXRvcG9sb2d5IHJldHVybnMg
YW4gaW5zdGFuY2Ugb2YgQ3B1dG9wb2xvZ3kgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1
bmMgTmV3Q3B1dG9wb2xvZ3koKSAoKkNwdXRvcG9sb2d5LCBlcnJvcikgeworCXZhciAoCisJCXgg
IENwdXRvcG9sb2d5CisJCXhjIEMubGlieGxfY3B1dG9wb2xvZ3kKKwkpCisKKwlDLmxpYnhsX2Nw
dXRvcG9sb2d5X2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfY3B1dG9wb2xvZ3lfZGlzcG9zZSgm
eGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5p
bCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqQ3B1dG9wb2xvZ3kp
IGZyb21DKHhjICpDLmxpYnhsX2NwdXRvcG9sb2d5KSBlcnJvciB7CiAJeC5Db3JlID0gdWludDMy
KHhjLmNvcmUpCiAJeC5Tb2NrZXQgPSB1aW50MzIoeGMuc29ja2V0KQpAQCAtMzI1Miw2ICs0MTU3
LDIzIEBAIGZ1bmMgKHggKkNwdXRvcG9sb2d5KSB0b0MoeGMgKkMubGlieGxfY3B1dG9wb2xvZ3kp
IChlcnIgZXJyb3IpIHsKIAlyZXR1cm4gbmlsCiB9CiAKKy8vIE5ld1BjaXRvcG9sb2d5IHJldHVy
bnMgYW4gaW5zdGFuY2Ugb2YgUGNpdG9wb2xvZ3kgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4K
K2Z1bmMgTmV3UGNpdG9wb2xvZ3koKSAoKlBjaXRvcG9sb2d5LCBlcnJvcikgeworCXZhciAoCisJ
CXggIFBjaXRvcG9sb2d5CisJCXhjIEMubGlieGxfcGNpdG9wb2xvZ3kKKwkpCisKKwlDLmxpYnhs
X3BjaXRvcG9sb2d5X2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfcGNpdG9wb2xvZ3lfZGlzcG9z
ZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJu
IG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqUGNpdG9wb2xv
Z3kpIGZyb21DKHhjICpDLmxpYnhsX3BjaXRvcG9sb2d5KSBlcnJvciB7CiAJeC5TZWcgPSB1aW50
MTYoeGMuc2VnKQogCXguQnVzID0gYnl0ZSh4Yy5idXMpCkBAIC0zMjc2LDYgKzQxOTgsMjIgQEAg
ZnVuYyAoeCAqUGNpdG9wb2xvZ3kpIHRvQyh4YyAqQy5saWJ4bF9wY2l0b3BvbG9neSkgKGVyciBl
cnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3U2NoZWRDcmVkaXRQYXJhbXMgcmV0dXJu
cyBhbiBpbnN0YW5jZSBvZiBTY2hlZENyZWRpdFBhcmFtcyBpbml0aWFsaXplZCB3aXRoIGRlZmF1
bHRzLgorZnVuYyBOZXdTY2hlZENyZWRpdFBhcmFtcygpICgqU2NoZWRDcmVkaXRQYXJhbXMsIGVy
cm9yKSB7CisJdmFyICgKKwkJeCAgU2NoZWRDcmVkaXRQYXJhbXMKKwkJeGMgQy5saWJ4bF9zY2hl
ZF9jcmVkaXRfcGFyYW1zCisJKQorCisJQy5saWJ4bF9zY2hlZF9jcmVkaXRfcGFyYW1zX2luaXQo
JnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBu
aWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlNjaGVkQ3JlZGl0
UGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXRfcGFyYW1zKSBlcnJvciB7CiAJ
eC5Uc2xpY2VNcyA9IGludCh4Yy50c2xpY2VfbXMpCiAJeC5SYXRlbGltaXRVcyA9IGludCh4Yy5y
YXRlbGltaXRfdXMpCkBAIC0zMjkyLDYgKzQyMzAsMjIgQEAgZnVuYyAoeCAqU2NoZWRDcmVkaXRQ
YXJhbXMpIHRvQyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXRfcGFyYW1zKSAoZXJyIGVycm9yKSB7
CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdTY2hlZENyZWRpdDJQYXJhbXMgcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBTY2hlZENyZWRpdDJQYXJhbXMgaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4K
K2Z1bmMgTmV3U2NoZWRDcmVkaXQyUGFyYW1zKCkgKCpTY2hlZENyZWRpdDJQYXJhbXMsIGVycm9y
KSB7CisJdmFyICgKKwkJeCAgU2NoZWRDcmVkaXQyUGFyYW1zCisJCXhjIEMubGlieGxfc2NoZWRf
Y3JlZGl0Ml9wYXJhbXMKKwkpCisKKwlDLmxpYnhsX3NjaGVkX2NyZWRpdDJfcGFyYW1zX2luaXQo
JnhjKQorCisJaWYgZXJyIDo9IHguZnJvbUMoJnhjKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBu
aWwsIGVycgorCX0KKworCXJldHVybiAmeCwgbmlsCit9CisKIGZ1bmMgKHggKlNjaGVkQ3JlZGl0
MlBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0Ml9wYXJhbXMpIGVycm9yIHsK
IAl4LlJhdGVsaW1pdFVzID0gaW50KHhjLnJhdGVsaW1pdF91cykKIApAQCAtMzMwNCw2ICs0MjU4
LDIzIEBAIGZ1bmMgKHggKlNjaGVkQ3JlZGl0MlBhcmFtcykgdG9DKHhjICpDLmxpYnhsX3NjaGVk
X2NyZWRpdDJfcGFyYW1zKSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdE
b21haW5SZW11c0luZm8gcmV0dXJucyBhbiBpbnN0YW5jZSBvZiBEb21haW5SZW11c0luZm8gaW5p
dGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3RG9tYWluUmVtdXNJbmZvKCkgKCpEb21h
aW5SZW11c0luZm8sIGVycm9yKSB7CisJdmFyICgKKwkJeCAgRG9tYWluUmVtdXNJbmZvCisJCXhj
IEMubGlieGxfZG9tYWluX3JlbXVzX2luZm8KKwkpCisKKwlDLmxpYnhsX2RvbWFpbl9yZW11c19p
bmZvX2luaXQoJnhjKQorCWRlZmVyIEMubGlieGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgm
eGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5p
bCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluUmVtdXNJ
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fcmVtdXNfaW5mbykgZXJyb3IgewogCXguSW50
ZXJ2YWwgPSBpbnQoeGMuaW50ZXJ2YWwpCiAJaWYgZXJyIDo9IHguQWxsb3dVbnNhZmUuZnJvbUMo
JnhjLmFsbG93X3Vuc2FmZSk7IGVyciAhPSBuaWwgewpAQCAtMzM2OCw2ICs0MzM5LDI0IEBAIGZ1
bmMgKHggKkRvbWFpblJlbXVzSW5mbykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZv
KSAoZXJyIGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdFdmVudCByZXR1cm5zIGFu
IGluc3RhbmNlIG9mIEV2ZW50IGluaXRpYWxpemVkIHdpdGggZGVmYXVsdHMuCitmdW5jIE5ld0V2
ZW50KGV0eXBlIEV2ZW50VHlwZSkgKCpFdmVudCwgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBFdmVu
dAorCQl4YyBDLmxpYnhsX2V2ZW50CisJKQorCisJQy5saWJ4bF9ldmVudF9pbml0KCZ4YykKKwlD
LmxpYnhsX2V2ZW50X2luaXRfdHlwZSgmeGMsIEMubGlieGxfZXZlbnRfdHlwZShldHlwZSkpCisJ
ZGVmZXIgQy5saWJ4bF9ldmVudF9kaXNwb3NlKCZ4YykKKworCWlmIGVyciA6PSB4LmZyb21DKCZ4
Yyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gbmlsLCBlcnIKKwl9CisKKwlyZXR1cm4gJngsIG5p
bAorfQorCiBmdW5jICh4ICpFdmVudCkgZnJvbUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9yIHsK
IAlpZiBlcnIgOj0geC5MaW5rLmZyb21DKCZ4Yy5saW5rKTsgZXJyICE9IG5pbCB7CiAJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIExpbms6ICV2IiwgZXJyKQpAQCAtMzM3OSw2
ICs0MzY4LDEyIEBAIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9ldmVudCkgZXJy
b3IgewogCXguRm9yVXNlciA9IHVpbnQ2NCh4Yy5mb3JfdXNlcikKIAl4LlR5cGUgPSBFdmVudFR5
cGUoeGMuX3R5cGUpCiAJc3dpdGNoIHguVHlwZSB7CisJY2FzZSBFdmVudFR5cGVPcGVyYXRpb25D
b21wbGV0ZToKKwkJdmFyIHR5cGVPcGVyYXRpb25Db21wbGV0ZSBFdmVudFR5cGVVbmlvbk9wZXJh
dGlvbkNvbXBsZXRlCisJCWlmIGVyciA6PSB0eXBlT3BlcmF0aW9uQ29tcGxldGUuZnJvbUMoeGMp
OyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5
cGVPcGVyYXRpb25Db21wbGV0ZTogJXYiLCBlcnIpCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBl
T3BlcmF0aW9uQ29tcGxldGUKIAljYXNlIEV2ZW50VHlwZURvbWFpblNodXRkb3duOgogCQl2YXIg
dHlwZURvbWFpblNodXRkb3duIEV2ZW50VHlwZVVuaW9uRG9tYWluU2h1dGRvd24KIAkJaWYgZXJy
IDo9IHR5cGVEb21haW5TaHV0ZG93bi5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgewpAQCAtMzM5MSwx
MiArNDM4Niw2IEBAIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9ldmVudCkgZXJy
b3IgewogCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgdHlwZURpc2tFamVj
dDogJXYiLCBlcnIpCiAJCX0KIAkJeC5UeXBlVW5pb24gPSB0eXBlRGlza0VqZWN0Ci0JY2FzZSBF
dmVudFR5cGVPcGVyYXRpb25Db21wbGV0ZToKLQkJdmFyIHR5cGVPcGVyYXRpb25Db21wbGV0ZSBF
dmVudFR5cGVVbmlvbk9wZXJhdGlvbkNvbXBsZXRlCi0JCWlmIGVyciA6PSB0eXBlT3BlcmF0aW9u
Q29tcGxldGUuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIHR5cGVPcGVyYXRpb25Db21wbGV0ZTogJXYiLCBlcnIpCi0JCX0KLQkJ
eC5UeXBlVW5pb24gPSB0eXBlT3BlcmF0aW9uQ29tcGxldGUKIAlkZWZhdWx0OgogCQlyZXR1cm4g
Zm10LkVycm9yZigiaW52YWxpZCB1bmlvbiBrZXkgJyV2JyIsIHguVHlwZSkKIAl9CkBAIC0zNDkz
LDYgKzQ0ODIsMjMgQEAgZnVuYyAoeCAqRXZlbnQpIHRvQyh4YyAqQy5saWJ4bF9ldmVudCkgKGVy
ciBlcnJvcikgewogCXJldHVybiBuaWwKIH0KIAorLy8gTmV3UHNyQ2F0SW5mbyByZXR1cm5zIGFu
IGluc3RhbmNlIG9mIFBzckNhdEluZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMg
TmV3UHNyQ2F0SW5mbygpICgqUHNyQ2F0SW5mbywgZXJyb3IpIHsKKwl2YXIgKAorCQl4ICBQc3JD
YXRJbmZvCisJCXhjIEMubGlieGxfcHNyX2NhdF9pbmZvCisJKQorCisJQy5saWJ4bF9wc3JfY2F0
X2luZm9faW5pdCgmeGMpCisJZGVmZXIgQy5saWJ4bF9wc3JfY2F0X2luZm9fZGlzcG9zZSgmeGMp
CisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIG5pbCwg
ZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAoeCAqUHNyQ2F0SW5mbykgZnJv
bUMoeGMgKkMubGlieGxfcHNyX2NhdF9pbmZvKSBlcnJvciB7CiAJeC5JZCA9IHVpbnQzMih4Yy5p
ZCkKIAl4LkNvc01heCA9IHVpbnQzMih4Yy5jb3NfbWF4KQpAQCAtMzUxNywyMiArNDUyMyw0MCBA
QCBmdW5jICh4ICpQc3JDYXRJbmZvKSB0b0MoeGMgKkMubGlieGxfcHNyX2NhdF9pbmZvKSAoZXJy
IGVycm9yKSB7CiAJcmV0dXJuIG5pbAogfQogCisvLyBOZXdQc3JId0luZm8gcmV0dXJucyBhbiBp
bnN0YW5jZSBvZiBQc3JId0luZm8gaW5pdGlhbGl6ZWQgd2l0aCBkZWZhdWx0cy4KK2Z1bmMgTmV3
UHNySHdJbmZvKHB0eXBlIFBzckZlYXRUeXBlKSAoKlBzckh3SW5mbywgZXJyb3IpIHsKKwl2YXIg
KAorCQl4ICBQc3JId0luZm8KKwkJeGMgQy5saWJ4bF9wc3JfaHdfaW5mbworCSkKKworCUMubGli
eGxfcHNyX2h3X2luZm9faW5pdCgmeGMpCisJQy5saWJ4bF9wc3JfaHdfaW5mb19pbml0X3R5cGUo
JnhjLCBDLmxpYnhsX3Bzcl9mZWF0X3R5cGUocHR5cGUpKQorCWRlZmVyIEMubGlieGxfcHNyX2h3
X2luZm9fZGlzcG9zZSgmeGMpCisKKwlpZiBlcnIgOj0geC5mcm9tQygmeGMpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIG5pbCwgZXJyCisJfQorCisJcmV0dXJuICZ4LCBuaWwKK30KKwogZnVuYyAo
eCAqUHNySHdJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfaHdfaW5mbykgZXJyb3IgewogCXgu
SWQgPSB1aW50MzIoeGMuaWQpCiAJeC5UeXBlID0gUHNyRmVhdFR5cGUoeGMuX3R5cGUpCiAJc3dp
dGNoIHguVHlwZSB7Ci0JY2FzZSBQc3JGZWF0VHlwZUNhdDoKLQkJdmFyIHR5cGVDYXQgUHNySHdJ
bmZvVHlwZVVuaW9uQ2F0Ci0JCWlmIGVyciA6PSB0eXBlQ2F0LmZyb21DKHhjKTsgZXJyICE9IG5p
bCB7Ci0JCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCB0eXBlQ2F0OiAldiIs
IGVycikKLQkJfQotCQl4LlR5cGVVbmlvbiA9IHR5cGVDYXQKIAljYXNlIFBzckZlYXRUeXBlTWJh
OgogCQl2YXIgdHlwZU1iYSBQc3JId0luZm9UeXBlVW5pb25NYmEKIAkJaWYgZXJyIDo9IHR5cGVN
YmEuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKIAkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0
aW5nIGZpZWxkIHR5cGVNYmE6ICV2IiwgZXJyKQogCQl9CiAJCXguVHlwZVVuaW9uID0gdHlwZU1i
YQorCWNhc2UgUHNyRmVhdFR5cGVDYXQ6CisJCXZhciB0eXBlQ2F0IFBzckh3SW5mb1R5cGVVbmlv
bkNhdAorCQlpZiBlcnIgOj0gdHlwZUNhdC5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgdHlwZUNhdDogJXYiLCBlcnIpCisJCX0K
KwkJeC5UeXBlVW5pb24gPSB0eXBlQ2F0CiAJZGVmYXVsdDoKIAkJcmV0dXJuIGZtdC5FcnJvcmYo
ImludmFsaWQgdW5pb24ga2V5ICcldiciLCB4LlR5cGUpCiAJfQotLSAKMi4xNy4xCgoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxp
bmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5w
cm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

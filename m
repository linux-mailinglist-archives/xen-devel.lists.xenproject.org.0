Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8E8A015BED0
	for <lists+xen-devel@lfdr.de>; Thu, 13 Feb 2020 13:57:46 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j2E1Y-0006DR-SF; Thu, 13 Feb 2020 12:55:20 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=06QY=4B=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1j2E1X-0006Cd-Hy
 for xen-devel@lists.xenproject.org; Thu, 13 Feb 2020 12:55:19 +0000
X-Inumbo-ID: 07fa8cc2-4e60-11ea-b898-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 07fa8cc2-4e60-11ea-b898-12813bfff9fa;
 Thu, 13 Feb 2020 12:54:55 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 66CC1AC6B;
 Thu, 13 Feb 2020 12:54:53 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Thu, 13 Feb 2020 13:54:46 +0100
Message-Id: <20200213125449.14226-6-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20200213125449.14226-1-jgross@suse.com>
References: <20200213125449.14226-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 5/8] xen/sched: use keyhandler locks when
 dumping data to console
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 George Dunlap <george.dunlap@eu.citrix.com>, Meng Xu <mengxu@cis.upenn.edu>,
 Dario Faggioli <dfaggioli@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW5zdGVhZCBvZiB1c2luZyB0aGUgbm9ybWFsIGxvY2tzIHVzZSB0aGUga2V5aGFuZGxlciBwcm92
aWRlZCB0cnlsb2Nrcwp3aXRoIHRpbWVvdXRzLiBUaGlzIHJlcXVpcmVzIGEgc3BlY2lhbCBwcmlt
aXRpdmUgZm9yIHRoZSBzY2hlZHVsZXIKbG9jay4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KLS0tCiB4ZW4vY29tbW9uL3NjaGVkL2NvcmUuYyAgICB8ICA3
ICsrKysrKysKIHhlbi9jb21tb24vc2NoZWQvY3B1cG9vbC5jIHwgIDQgKysrLQogeGVuL2NvbW1v
bi9zY2hlZC9jcmVkaXQuYyAgfCAyNSArKysrKysrKysrKysrKysrKystLS0tLS0tCiB4ZW4vY29t
bW9uL3NjaGVkL2NyZWRpdDIuYyB8IDE3ICsrKysrKysrKysrLS0tLS0tCiB4ZW4vY29tbW9uL3Nj
aGVkL251bGwuYyAgICB8IDQyICsrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0t
LS0tLQogeGVuL2NvbW1vbi9zY2hlZC9wcml2YXRlLmggfCAgMSArCiB4ZW4vY29tbW9uL3NjaGVk
L3J0LmMgICAgICB8ICA3ICsrKysrLS0KIDcgZmlsZXMgY2hhbmdlZCwgNzAgaW5zZXJ0aW9ucygr
KSwgMzMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZC9jb3JlLmMg
Yi94ZW4vY29tbW9uL3NjaGVkL2NvcmUuYwppbmRleCBkNGU4OTQ0ZTBlLi43YjhiMGZlODBlIDEw
MDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkL2NvcmUuYworKysgYi94ZW4vY29tbW9uL3NjaGVk
L2NvcmUuYwpAQCAtMjEsNiArMjEsNyBAQAogI2luY2x1ZGUgPHhlbi9kb21haW4uaD4KICNpbmNs
dWRlIDx4ZW4vZGVsYXkuaD4KICNpbmNsdWRlIDx4ZW4vZXZlbnQuaD4KKyNpbmNsdWRlIDx4ZW4v
a2V5aGFuZGxlci5oPgogI2luY2x1ZGUgPHhlbi90aW1lLmg+CiAjaW5jbHVkZSA8eGVuL3RpbWVy
Lmg+CiAjaW5jbHVkZSA8eGVuL3BlcmZjLmg+CkBAIC0zMzAyLDYgKzMzMDMsMTIgQEAgdm9pZCBf
X2luaXQgc2NoZWRfc2V0dXBfZG9tMF92Y3B1cyhzdHJ1Y3QgZG9tYWluICpkKQogfQogI2VuZGlm
CiAKK3NwaW5sb2NrX3QgKmtleWhhbmRsZXJfcGNwdV9sb2NrKHVuc2lnbmVkIGludCBjcHUpCit7
CisgICAga2V5aGFuZGxlcl9sb2NrX2JvZHkoc3BpbmxvY2tfdCAqLCBwY3B1X3NjaGVkdWxlX3Ry
eWxvY2soY3B1KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAiY291bGQgbm90IGdldCBwY3B1
IGxvY2ssIGNwdT0ldVxuIiwgY3B1KTsKK30KKwogI2lmZGVmIENPTkZJR19DT01QQVQKICNpbmNs
dWRlICJjb21wYXQuYyIKICNlbmRpZgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZC9jcHVw
b29sLmMgYi94ZW4vY29tbW9uL3NjaGVkL2NwdXBvb2wuYwppbmRleCA0NzY5MTZjNmVhLi41YzE4
MWU5NzcyIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkL2NwdXBvb2wuYworKysgYi94ZW4v
Y29tbW9uL3NjaGVkL2NwdXBvb2wuYwpAQCAtODkzLDcgKzg5Myw5IEBAIHZvaWQgZHVtcF9ydW5x
KHVuc2lnbmVkIGNoYXIga2V5KQogICAgIHNfdGltZV90ICAgICAgICAgbm93ID0gTk9XKCk7CiAg
ICAgc3RydWN0IGNwdXBvb2wgKipjOwogCi0gICAgc3Bpbl9sb2NrKCZjcHVwb29sX2xvY2spOwor
ICAgIGlmICggIWtleWhhbmRsZXJfc3Bpbl9sb2NrKCZjcHVwb29sX2xvY2ssICJjb3VsZCBub3Qg
Z2V0IGNwdXBvb2xzIikgKQorICAgICAgICByZXR1cm47CisKICAgICBsb2NhbF9pcnFfc2F2ZShm
bGFncyk7CiAKICAgICBwcmludGsoInNjaGVkX3NtdF9wb3dlcl9zYXZpbmdzOiAlc1xuIiwKZGlm
ZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWQvY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkL2Ny
ZWRpdC5jCmluZGV4IGRlZTg3ZTdmZTIuLjE2NWZmMjZiYjggMTAwNjQ0Ci0tLSBhL3hlbi9jb21t
b24vc2NoZWQvY3JlZGl0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZC9jcmVkaXQuYwpAQCAtMjA1
Nyw4ICsyMDU3LDE1IEBAIGNzY2hlZF9kdW1wX3BjcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBpbnQgY3B1KQogICAgICAqIC0gd2Ugc2NhbiB0aHJvdWdoIHRoZSBydW5xdWV1ZSwgc28g
d2UgbmVlZCB0aGUgcHJvcGVyIHJ1bnF1ZXVlCiAgICAgICogICBsb2NrICh0aGUgb25lIG9mIHRo
ZSBydW5xdWV1ZSBvZiB0aGlzIGNwdSkuCiAgICAgICovCi0gICAgc3Bpbl9sb2NrKCZwcnYtPmxv
Y2spOwotICAgIGxvY2sgPSBwY3B1X3NjaGVkdWxlX2xvY2soY3B1KTsKKyAgICBpZiAoICFrZXlo
YW5kbGVyX3NwaW5fbG9jaygmcHJ2LT5sb2NrLCAiY291bGQgbm90IGdldCBjcmVkaXQgZGF0YSIp
ICkKKyAgICAgICAgcmV0dXJuOworCisgICAgbG9jayA9IGtleWhhbmRsZXJfcGNwdV9sb2NrKGNw
dSk7CisgICAgaWYgKCAhbG9jayApCisgICAgeworICAgICAgICBzcGluX3VubG9jaygmcHJ2LT5s
b2NrKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KIAogICAgIHNwYyA9IENTQ0hFRF9QQ1BVKGNw
dSk7CiAgICAgcnVucSA9ICZzcGMtPnJ1bnE7CkBAIC0yMDk4LDcgKzIxMDUsOCBAQCBjc2NoZWRf
ZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgc3RydWN0IGNzY2hlZF9wcml2
YXRlICpwcnYgPSBDU0NIRURfUFJJVihvcHMpOwogICAgIGludCBsb29wOwogCi0gICAgc3Bpbl9s
b2NrKCZwcnYtPmxvY2spOworICAgIGlmICggIWtleWhhbmRsZXJfc3Bpbl9sb2NrKCZwcnYtPmxv
Y2ssICJjb3VsZCBub3QgZ2V0IGNyZWRpdCBkYXRhIikgKQorICAgICAgICByZXR1cm47CiAKICAg
ICBwcmludGsoImluZm86XG4iCiAgICAgICAgICAgICJcdG5jcHVzICAgICAgICAgICAgICA9ICV1
XG4iCkBAIC0yMTQyLDEyICsyMTUwLDE1IEBAIGNzY2hlZF9kdW1wKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcykKICAgICAgICAgICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAKICAgICAgICAgICAg
IHN2YyA9IGxpc3RfZW50cnkoaXRlcl9zdmMsIHN0cnVjdCBjc2NoZWRfdW5pdCwgYWN0aXZlX3Vu
aXRfZWxlbSk7Ci0gICAgICAgICAgICBsb2NrID0gdW5pdF9zY2hlZHVsZV9sb2NrKHN2Yy0+dW5p
dCk7CisgICAgICAgICAgICBsb2NrID0ga2V5aGFuZGxlcl9wY3B1X2xvY2soc3ZjLT51bml0LT5y
ZXMtPm1hc3Rlcl9jcHUpOwogCi0gICAgICAgICAgICBwcmludGsoIlx0JTNkOiAiLCArK2xvb3Ap
OwotICAgICAgICAgICAgY3NjaGVkX2R1bXBfdW5pdChzdmMpOworICAgICAgICAgICAgaWYgKCBs
b2NrICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBwcmludGsoIlx0JTNkOiAiLCAr
K2xvb3ApOworICAgICAgICAgICAgICAgIGNzY2hlZF9kdW1wX3VuaXQoc3ZjKTsKIAotICAgICAg
ICAgICAgdW5pdF9zY2hlZHVsZV91bmxvY2sobG9jaywgc3ZjLT51bml0KTsKKyAgICAgICAgICAg
ICAgICBwY3B1X3NjaGVkdWxlX3VubG9jayhsb2NrLCBzdmMtPnVuaXQtPnJlcy0+bWFzdGVyX2Nw
dSk7CisgICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICB9CiAKZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vc2NoZWQvY3JlZGl0Mi5jIGIveGVuL2NvbW1vbi9zY2hlZC9jcmVkaXQyLmMKaW5kZXgg
ZTc2ZDJlZDU0My4uMjhiMDNmZTc0NCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZC9jcmVk
aXQyLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZC9jcmVkaXQyLmMKQEAgLTM2NTUsNyArMzY1NSw4
IEBAIGNzY2hlZDJfZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgICogV2Ug
bmVlZCB0aGUgcHJpdmF0ZSBzY2hlZHVsZXIgbG9jayBhcyB3ZSBhY2Nlc3MgZ2xvYmFsCiAgICAg
ICogc2NoZWR1bGVyIGRhdGEgYW5kIChiZWxvdykgdGhlIGxpc3Qgb2YgYWN0aXZlIGRvbWFpbnMu
CiAgICAgICovCi0gICAgcmVhZF9sb2NrKCZwcnYtPmxvY2spOworICAgIGlmICggIWtleWhhbmRs
ZXJfcmVhZF9sb2NrKCZwcnYtPmxvY2ssICJjb3VsZCBub3QgZ2V0IGNyZWRpdDIgZGF0YSIpICkK
KyAgICAgICAgcmV0dXJuOwogCiAgICAgcHJpbnRrKCJBY3RpdmUgcXVldWVzOiAlZFxuIgogICAg
ICAgICAgICAiXHRkZWZhdWx0LXdlaWdodCAgICAgPSAlZFxuIiwKQEAgLTM3MTEsMTIgKzM3MTIs
MTUgQEAgY3NjaGVkMl9kdW1wKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcykKICAgICAgICAg
ICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKiBjb25zdCBzdmMgPSBjc2NoZWQyX3VuaXQodW5pdCk7
CiAgICAgICAgICAgICBzcGlubG9ja190ICpsb2NrOwogCi0gICAgICAgICAgICBsb2NrID0gdW5p
dF9zY2hlZHVsZV9sb2NrKHVuaXQpOworICAgICAgICAgICAgbG9jayA9IGtleWhhbmRsZXJfcGNw
dV9sb2NrKHVuaXQtPnJlcy0+bWFzdGVyX2NwdSk7CiAKLSAgICAgICAgICAgIHByaW50aygiXHQl
M2Q6ICIsICsrbG9vcCk7Ci0gICAgICAgICAgICBjc2NoZWQyX2R1bXBfdW5pdChwcnYsIHN2Yyk7
CisgICAgICAgICAgICBpZiAoIGxvY2sgKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAg
IHByaW50aygiXHQlM2Q6ICIsICsrbG9vcCk7CisgICAgICAgICAgICAgICAgY3NjaGVkMl9kdW1w
X3VuaXQocHJ2LCBzdmMpOwogCi0gICAgICAgICAgICB1bml0X3NjaGVkdWxlX3VubG9jayhsb2Nr
LCB1bml0KTsKKyAgICAgICAgICAgICAgICBwY3B1X3NjaGVkdWxlX3VubG9jayhsb2NrLCB1bml0
LT5yZXMtPm1hc3Rlcl9jcHUpOworICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgfQogCkBA
IC0zNzI3LDcgKzM3MzEsOCBAQCBjc2NoZWQyX2R1bXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzKQogICAgICAgICBpbnQgbG9vcCA9IDA7CiAKICAgICAgICAgLyogV2UgbmVlZCB0aGUgbG9j
ayB0byBzY2FuIHRoZSBydW5xdWV1ZS4gKi8KLSAgICAgICAgc3Bpbl9sb2NrKCZycWQtPmxvY2sp
OworICAgICAgICBpZiAoICFrZXloYW5kbGVyX3NwaW5fbG9jaygmcnFkLT5sb2NrLCAiY291bGQg
bm90IGdldCBydW5xIikgKQorICAgICAgICAgICAgY29udGludWU7CiAKICAgICAgICAgcHJpbnRr
KCJSdW5xdWV1ZSAlZDpcbiIsIGkpOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkL251
bGwuYyBiL3hlbi9jb21tb24vc2NoZWQvbnVsbC5jCmluZGV4IDNiMzE3MDNkN2UuLmZlNTljZTE3
ZmUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWQvbnVsbC5jCisrKyBiL3hlbi9jb21tb24v
c2NoZWQvbnVsbC5jCkBAIC0yOCw2ICsyOCw3IEBACiAgKiBpZiB0aGUgc2NoZWR1bGVyIGlzIHVz
ZWQgaW5zaWRlIGEgY3B1cG9vbC4KICAqLwogCisjaW5jbHVkZSA8eGVuL2tleWhhbmRsZXIuaD4K
ICNpbmNsdWRlIDx4ZW4vc2NoZWQuaD4KICNpbmNsdWRlIDx4ZW4vc29mdGlycS5oPgogI2luY2x1
ZGUgPHhlbi90cmFjZS5oPgpAQCAtOTgyLDcgKzk4Myw4IEBAIHN0YXRpYyB2b2lkIG51bGxfZHVt
cChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgc3RydWN0IGxpc3RfaGVhZCAqaXRl
cjsKICAgICB1bnNpZ25lZCBpbnQgbG9vcDsKIAotICAgIHNwaW5fbG9jaygmcHJ2LT5sb2NrKTsK
KyAgICBpZiAoICFrZXloYW5kbGVyX3NwaW5fbG9jaygmcHJ2LT5sb2NrLCAiY291bGQgbm90IGdl
dCBudWxsIGRhdGEiKSApCisgICAgICAgIHJldHVybjsKIAogICAgIHByaW50aygiXHRjcHVzX2Zy
ZWUgPSAlKnBibFxuIiwgQ1BVTUFTS19QUigmcHJ2LT5jcHVzX2ZyZWUpKTsKIApAQCAtMTAwMSwz
MSArMTAwMywzNyBAQCBzdGF0aWMgdm9pZCBudWxsX2R1bXAoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqb3BzKQogICAgICAgICAgICAgc3RydWN0IG51bGxfdW5pdCAqIGNvbnN0IG52YyA9IG51bGxf
dW5pdCh1bml0KTsKICAgICAgICAgICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAKLSAgICAgICAgICAg
IGxvY2sgPSB1bml0X3NjaGVkdWxlX2xvY2sodW5pdCk7CisgICAgICAgICAgICBsb2NrID0ga2V5
aGFuZGxlcl9wY3B1X2xvY2sodW5pdC0+cmVzLT5tYXN0ZXJfY3B1KTsKIAotICAgICAgICAgICAg
cHJpbnRrKCJcdCUzZDogIiwgKytsb29wKTsKLSAgICAgICAgICAgIGR1bXBfdW5pdChwcnYsIG52
Yyk7Ci0gICAgICAgICAgICBwcmludGsoIlxuIik7CisgICAgICAgICAgICBpZiAoIGxvY2sgKQor
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHByaW50aygiXHQlM2Q6ICIsICsrbG9vcCk7
CisgICAgICAgICAgICAgICAgZHVtcF91bml0KHBydiwgbnZjKTsKKyAgICAgICAgICAgICAgICBw
cmludGsoIlxuIik7CiAKLSAgICAgICAgICAgIHVuaXRfc2NoZWR1bGVfdW5sb2NrKGxvY2ssIHVu
aXQpOworICAgICAgICAgICAgICAgIHBjcHVfc2NoZWR1bGVfdW5sb2NrKGxvY2ssIHVuaXQtPnJl
cy0+bWFzdGVyX2NwdSk7CisgICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICB9CiAKICAgICBw
cmludGsoIldhaXRxdWV1ZTogIik7CiAgICAgbG9vcCA9IDA7Ci0gICAgc3Bpbl9sb2NrKCZwcnYt
PndhaXRxX2xvY2spOwotICAgIGxpc3RfZm9yX2VhY2goIGl0ZXIsICZwcnYtPndhaXRxICkKKyAg
ICBpZiAoIGtleWhhbmRsZXJfc3Bpbl9sb2NrKCZwcnYtPndhaXRxX2xvY2ssICJjb3VsZCBub3Qg
Z2V0IHdhaXRxIikgKQogICAgIHsKLSAgICAgICAgc3RydWN0IG51bGxfdW5pdCAqbnZjID0gbGlz
dF9lbnRyeShpdGVyLCBzdHJ1Y3QgbnVsbF91bml0LCB3YWl0cV9lbGVtKTsKLQotICAgICAgICBp
ZiAoIGxvb3ArKyAhPSAwICkKLSAgICAgICAgICAgIHByaW50aygiLCAiKTsKLSAgICAgICAgaWYg
KCBsb29wICUgMjQgPT0gMCApCi0gICAgICAgICAgICBwcmludGsoIlxuXHQiKTsKLSAgICAgICAg
cHJpbnRrKCIlcGR2JWQiLCBudmMtPnVuaXQtPmRvbWFpbiwgbnZjLT51bml0LT51bml0X2lkKTsK
KyAgICAgICAgbGlzdF9mb3JfZWFjaCggaXRlciwgJnBydi0+d2FpdHEgKQorICAgICAgICB7Cisg
ICAgICAgICAgICBzdHJ1Y3QgbnVsbF91bml0ICpudmMgPSBsaXN0X2VudHJ5KGl0ZXIsIHN0cnVj
dCBudWxsX3VuaXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHdhaXRxX2VsZW0pOworCisgICAgICAgICAgICBpZiAoIGxvb3ArKyAhPSAwICkKKyAgICAg
ICAgICAgICAgICBwcmludGsoIiwgIik7CisgICAgICAgICAgICBpZiAoIGxvb3AgJSAyNCA9PSAw
ICkKKyAgICAgICAgICAgICAgICBwcmludGsoIlxuXHQiKTsKKyAgICAgICAgICAgIHByaW50aygi
JXBkdiVkIiwgbnZjLT51bml0LT5kb21haW4sIG52Yy0+dW5pdC0+dW5pdF9pZCk7CisgICAgICAg
IH0KKyAgICAgICAgcHJpbnRrKCJcbiIpOworICAgICAgICBzcGluX3VubG9jaygmcHJ2LT53YWl0
cV9sb2NrKTsKICAgICB9Ci0gICAgcHJpbnRrKCJcbiIpOwotICAgIHNwaW5fdW5sb2NrKCZwcnYt
PndhaXRxX2xvY2spOwogCiAgICAgc3Bpbl91bmxvY2soJnBydi0+bG9jayk7CiB9CmRpZmYgLS1n
aXQgYS94ZW4vY29tbW9uL3NjaGVkL3ByaXZhdGUuaCBiL3hlbi9jb21tb24vc2NoZWQvcHJpdmF0
ZS5oCmluZGV4IDJhOTQxNzliYWEuLjY3MjNmNzRkMjggMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
c2NoZWQvcHJpdmF0ZS5oCisrKyBiL3hlbi9jb21tb24vc2NoZWQvcHJpdmF0ZS5oCkBAIC02MzEs
NSArNjMxLDYgQEAgc3RydWN0IGNwdXBvb2wgKmNwdXBvb2xfZ2V0X2J5X2lkKGludCBwb29saWQp
Owogdm9pZCBjcHVwb29sX3B1dChzdHJ1Y3QgY3B1cG9vbCAqcG9vbCk7CiBpbnQgY3B1cG9vbF9h
ZGRfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIGludCBwb29saWQpOwogdm9pZCBjcHVwb29sX3Jt
X2RvbWFpbihzdHJ1Y3QgZG9tYWluICpkKTsKK3NwaW5sb2NrX3QgKmtleWhhbmRsZXJfcGNwdV9s
b2NrKHVuc2lnbmVkIGludCBjcHUpOwogCiAjZW5kaWYgLyogX19YRU5fU0NIRURfSUZfSF9fICov
CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkL3J0LmMgYi94ZW4vY29tbW9uL3NjaGVkL3J0
LmMKaW5kZXggMTYzNzljYjJkMi4uZDRiMTdlMGY4YiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9z
Y2hlZC9ydC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWQvcnQuYwpAQCAtMzU0LDcgKzM1NCw5IEBA
IHJ0X2R1bXBfcGNwdShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIGludCBjcHUpCiAgICAg
c3RydWN0IHJ0X3ByaXZhdGUgKnBydiA9IHJ0X3ByaXYob3BzKTsKICAgICBjb25zdCBzdHJ1Y3Qg
cnRfdW5pdCAqc3ZjOwogCi0gICAgc3Bpbl9sb2NrKCZwcnYtPmxvY2spOworICAgIGlmICggIWtl
eWhhbmRsZXJfc3Bpbl9sb2NrKCZwcnYtPmxvY2ssICJjb3VsZCBub3QgZ2V0IHJ0IGRhdGEiKSAp
CisgICAgICAgIHJldHVybjsKKwogICAgIHByaW50aygiQ1BVWyUwMmRdXG4iLCBjcHUpOwogICAg
IC8qIGN1cnJlbnQgVU5JVCAobm90aGluZyB0byBzYXkgaWYgdGhhdCdzIHRoZSBpZGxlIHVuaXQp
LiAqLwogICAgIHN2YyA9IHJ0X3VuaXQoY3Vycl9vbl9jcHUoY3B1KSk7CkBAIC0zNzMsNyArMzc1
LDggQEAgcnRfZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgY29uc3Qgc3Ry
dWN0IHJ0X3VuaXQgKnN2YzsKICAgICBjb25zdCBzdHJ1Y3QgcnRfZG9tICpzZG9tOwogCi0gICAg
c3Bpbl9sb2NrKCZwcnYtPmxvY2spOworICAgIGlmICggIWtleWhhbmRsZXJfc3Bpbl9sb2NrKCZw
cnYtPmxvY2ssICJjb3VsZCBub3QgZ2V0IHJ0IGRhdGEiKSApCisgICAgICAgIHJldHVybjsKIAog
ICAgIGlmICggbGlzdF9lbXB0eSgmcHJ2LT5zZG9tKSApCiAgICAgICAgIGdvdG8gb3V0OwotLSAK
Mi4xNi40CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
WGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0
cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

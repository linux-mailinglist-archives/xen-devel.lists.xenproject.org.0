Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 51B95ADBF8
	for <lists+xen-devel@lfdr.de>; Mon,  9 Sep 2019 17:17:06 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i7LMj-00068U-09; Mon, 09 Sep 2019 15:14:05 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=NFaf=XE=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1i7LMh-00067k-EF
 for xen-devel@lists.xenproject.org; Mon, 09 Sep 2019 15:14:03 +0000
X-Inumbo-ID: 747b3f12-d314-11e9-ac0d-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 747b3f12-d314-11e9-ac0d-12813bfff9fa;
 Mon, 09 Sep 2019 15:14:02 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 414A9AEF1;
 Mon,  9 Sep 2019 15:14:01 +0000 (UTC)
To: Juergen Gross <jgross@suse.com>
References: <20190809145833.1020-1-jgross@suse.com>
 <20190809145833.1020-25-jgross@suse.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <de1280ef-a2f0-b96c-8c7a-049027cf1b34@suse.com>
Date: Mon, 9 Sep 2019 17:14:10 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20190809145833.1020-25-jgross@suse.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v2 24/48] xen: switch from for_each_vcpu()
 to for_each_sched_unit()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Tim Deegan <tim@xen.org>, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, xen-devel@lists.xenproject.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMDkuMDguMjAxOSAxNjo1OCwgSnVlcmdlbiBHcm9zcyB3cm90ZToKPiBAQCAtNTA0LDIyICs1
MTEsMjEgQEAgaW50IHNjaGVkX21vdmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBj
cHVwb29sICpjKQo+ICAgICAgaWYgKCBJU19FUlIoZG9tZGF0YSkgKQo+ICAgICAgICAgIHJldHVy
biBQVFJfRVJSKGRvbWRhdGEpOwo+ICAKPiAtICAgIHZjcHVfcHJpdiA9IHh6YWxsb2NfYXJyYXko
dm9pZCAqLCBkLT5tYXhfdmNwdXMpOwo+IC0gICAgaWYgKCB2Y3B1X3ByaXYgPT0gTlVMTCApCj4g
KyAgICB1bml0X3ByaXYgPSB4emFsbG9jX2FycmF5KHZvaWQgKiwgZC0+bWF4X3ZjcHVzKTsKCkkg
ZmluZCBpdCBjb25mdXNpbmcgdGhhdCBhbiBhcnJheSBvZiB1bml0cyAoYXMgcGVyIHRoZSB1c2Ug
YmVsb3cpCmlzIGRpbWVuc2lvbmVkIGJ5IHRoZSBkb21haW4ncyB2Q1BVIGNvdW50LiBJc24ndCB0
aGVyZSBhIGNvcnJlbGF0aW9uCmJldHdlZW4gdkNQVSBJRHMgYW5kIHVuaXRzIElEcywgcGVyaGFw
cyBhbG9uZyB0aGUgbGluZXMgb2YgQ1BVCkFQSUMgKHRocmVhZCksIGNvcmUsIGFuZCBzb2NrZXQg
SURzPyBJZiBzbywgdGhlIGFycmF5IHNpemUgY291bGQKYmUgYm91bmRlZCBoZXJlIGJ5IGEgc21h
bGxlciAoZG93biB0aGUgcm9hZCkgdmFsdWUuCgo+IEBAIC04ODAsMTggKzg4OSwzNiBAQCB2b2lk
IHZjcHVfZm9yY2VfcmVzY2hlZHVsZShzdHJ1Y3QgdmNwdSAqdikKPiAgICAgIHZjcHVfbWlncmF0
ZV9maW5pc2godik7Cj4gIH0KPiAgCj4gK3N0YXRpYyBib29sIHNjaGVkX2NoZWNrX2FmZmluaXR5
X2Jyb2tlbihzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKCmNvbnN0Cgo+ICt7Cj4gKyAgICBzdHJ1
Y3QgdmNwdSAqdjsKCmNvbnN0Cgo+IEBAIC05MTAsMTggKzkzNywyMCBAQCB2b2lkIHJlc3RvcmVf
dmNwdV9hZmZpbml0eShzdHJ1Y3QgZG9tYWluICpkKQo+ICAgICAgICAgICAgICAgICAgICAgIGNw
dXBvb2xfZG9tYWluX2NwdW1hc2soZCkpOwo+ICAgICAgICAgIGlmICggY3B1bWFza19lbXB0eShj
cHVtYXNrX3NjcmF0Y2hfY3B1KGNwdSkpICkKPiAgICAgICAgICB7Cj4gLSAgICAgICAgICAgIGlm
ICggdi0+YWZmaW5pdHlfYnJva2VuICkKPiArICAgICAgICAgICAgaWYgKCBzY2hlZF9jaGVja19h
ZmZpbml0eV9icm9rZW4odW5pdCkgKQo+ICAgICAgICAgICAgICB7Cj4gLSAgICAgICAgICAgICAg
ICBzY2hlZF9zZXRfYWZmaW5pdHkodiwgdW5pdC0+Y3B1X2hhcmRfYWZmaW5pdHlfc2F2ZWQsIE5V
TEwpOwo+IC0gICAgICAgICAgICAgICAgdi0+YWZmaW5pdHlfYnJva2VuID0gMDsKPiArICAgICAg
ICAgICAgICAgIHNjaGVkX3NldF9hZmZpbml0eSh1bml0LT52Y3B1X2xpc3QsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdC0+Y3B1X2hhcmRfYWZmaW5pdHlfc2F2ZWQs
IE5VTEwpOwo+ICsgICAgICAgICAgICAgICAgc2NoZWRfcmVzZXRfYWZmaW5pdHlfYnJva2VuKHVu
aXQpOwo+ICAgICAgICAgICAgICAgICAgY3B1bWFza19hbmQoY3B1bWFza19zY3JhdGNoX2NwdShj
cHUpLCB1bml0LT5jcHVfaGFyZF9hZmZpbml0eSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNwdXBvb2xfZG9tYWluX2NwdW1hc2soZCkpOwo+ICAgICAgICAgICAgICB9Cj4gIAo+ICAg
ICAgICAgICAgICBpZiAoIGNwdW1hc2tfZW1wdHkoY3B1bWFza19zY3JhdGNoX2NwdShjcHUpKSAp
Cj4gICAgICAgICAgICAgIHsKPiAtICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfREVCVUcg
IkJyZWFraW5nIGFmZmluaXR5IGZvciAlcHZcbiIsIHYpOwo+IC0gICAgICAgICAgICAgICAgc2No
ZWRfc2V0X2FmZmluaXR5KHYsICZjcHVtYXNrX2FsbCwgTlVMTCk7Cj4gKyAgICAgICAgICAgICAg
ICBwcmludGsoWEVOTE9HX0RFQlVHICJCcmVha2luZyBhZmZpbml0eSBmb3IgJXB2XG4iLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHVuaXQtPnZjcHVfbGlzdCk7Cj4gKyAgICAgICAgICAgICAg
ICBzY2hlZF9zZXRfYWZmaW5pdHkodW5pdC0+dmNwdV9saXN0LCAmY3B1bWFza19hbGwsIE5VTEwp
Owo+ICAgICAgICAgICAgICAgICAgY3B1bWFza19hbmQoY3B1bWFza19zY3JhdGNoX2NwdShjcHUp
LCB1bml0LT5jcHVfaGFyZF9hZmZpbml0eSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNwdXBvb2xfZG9tYWluX2NwdW1hc2soZCkpOwo+ICAgICAgICAgICAgICB9Cj5bLi4uXT4gQEAg
LTk2NCwxNyArOTkyLDE4IEBAIGludCBjcHVfZGlzYWJsZV9zY2hlZHVsZXIodW5zaWduZWQgaW50
IGNwdSkKPiAgCj4gICAgICBmb3JfZWFjaF9kb21haW5faW5fY3B1cG9vbCAoIGQsIGMgKQo+ICAg
ICAgewo+IC0gICAgICAgIGZvcl9lYWNoX3ZjcHUgKCBkLCB2ICkKPiArICAgICAgICBzdHJ1Y3Qg
c2NoZWRfdW5pdCAqdW5pdDsKPiArCj4gKyAgICAgICAgZm9yX2VhY2hfc2NoZWRfdW5pdCAoIGQs
IHVuaXQgKQo+ICAgICAgICAgIHsKPiAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsK
PiAtICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQgPSB2LT5zY2hlZF91bml0Owo+
ICAgICAgICAgICAgICBzcGlubG9ja190ICpsb2NrID0gdW5pdF9zY2hlZHVsZV9sb2NrX2lycXNh
dmUodW5pdCwgJmZsYWdzKTsKPiAgCj4gICAgICAgICAgICAgIGNwdW1hc2tfYW5kKCZvbmxpbmVf
YWZmaW5pdHksIHVuaXQtPmNwdV9oYXJkX2FmZmluaXR5LCBjLT5jcHVfdmFsaWQpOwo+ICAgICAg
ICAgICAgICBpZiAoIGNwdW1hc2tfZW1wdHkoJm9ubGluZV9hZmZpbml0eSkgJiYKPiAgICAgICAg
ICAgICAgICAgICBjcHVtYXNrX3Rlc3RfY3B1KGNwdSwgdW5pdC0+Y3B1X2hhcmRfYWZmaW5pdHkp
ICkKPiAgICAgICAgICAgICAgewo+IC0gICAgICAgICAgICAgICAgaWYgKCB2LT5hZmZpbml0eV9i
cm9rZW4gKQo+ICsgICAgICAgICAgICAgICAgaWYgKCB1bml0LT52Y3B1X2xpc3QtPmFmZmluaXR5
X2Jyb2tlbiApCj4gICAgICAgICAgICAgICAgICB7Cj4gICAgICAgICAgICAgICAgICAgICAgLyog
VGhlIHZjcHUgaXMgdGVtcG9yYXJpbHkgcGlubmVkLCBjYW4ndCBtb3ZlIGl0LiAqLwo+ICAgICAg
ICAgICAgICAgICAgICAgIHVuaXRfc2NoZWR1bGVfdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxh
Z3MsIHVuaXQpOwo+IEBAIC05ODIsMTQgKzEwMTEsMTUgQEAgaW50IGNwdV9kaXNhYmxlX3NjaGVk
dWxlcih1bnNpZ25lZCBpbnQgY3B1KQo+ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAg
ICAgICAgICAgICAgICAgfQo+ICAKPiAtICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfREVC
VUcgIkJyZWFraW5nIGFmZmluaXR5IGZvciAlcHZcbiIsIHYpOwo+ICsgICAgICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19ERUJVRyAiQnJlYWtpbmcgYWZmaW5pdHkgZm9yICVwdlxuIiwKPiArICAg
ICAgICAgICAgICAgICAgICAgICB1bml0LT52Y3B1X2xpc3QpOwo+ICAKPiAtICAgICAgICAgICAg
ICAgIHNjaGVkX3NldF9hZmZpbml0eSh2LCAmY3B1bWFza19hbGwsIE5VTEwpOwo+ICsgICAgICAg
ICAgICAgICAgc2NoZWRfc2V0X2FmZmluaXR5KHVuaXQtPnZjcHVfbGlzdCwgJmNwdW1hc2tfYWxs
LCBOVUxMKTsKPiAgICAgICAgICAgICAgfQo+ICAKPiAtICAgICAgICAgICAgaWYgKCB2LT5wcm9j
ZXNzb3IgIT0gY3B1ICkKPiArICAgICAgICAgICAgaWYgKCBzY2hlZF91bml0X2NwdSh1bml0KSAh
PSBzY2hlZF9nZXRfcmVzb3VyY2VfY3B1KGNwdSkgKQo+ICAgICAgICAgICAgICB7Cj4gLSAgICAg
ICAgICAgICAgICAvKiBUaGUgdmNwdSBpcyBub3Qgb24gdGhpcyBjcHUsIHNvIHdlIGNhbiBtb3Zl
IG9uLiAqLwo+ICsgICAgICAgICAgICAgICAgLyogVGhlIHVuaXQgaXMgbm90IG9uIHRoaXMgY3B1
LCBzbyB3ZSBjYW4gbW92ZSBvbi4gKi8KPiAgICAgICAgICAgICAgICAgIHVuaXRfc2NoZWR1bGVf
dW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MsIHVuaXQpOwo+ICAgICAgICAgICAgICAgICAg
Y29udGludWU7Cj4gICAgICAgICAgICAgIH0KPiBAQCAtMTAwMiwxNyArMTAzMiwxNyBAQCBpbnQg
Y3B1X2Rpc2FibGVfc2NoZWR1bGVyKHVuc2lnbmVkIGludCBjcHUpCj4gICAgICAgICAgICAgICAq
ICAqIHRoZSBzY2hlZHVsZXIgd2lsbCBhbHdheXMgZmluZCBhIHN1aXRhYmxlIHNvbHV0aW9uLCBv
cgo+ICAgICAgICAgICAgICAgKiAgICB0aGluZ3Mgd291bGQgaGF2ZSBmYWlsZWQgYmVmb3JlIGdl
dHRpbmcgaW4gaGVyZS4KPiAgICAgICAgICAgICAgICovCj4gLSAgICAgICAgICAgIHZjcHVfbWln
cmF0ZV9zdGFydCh2KTsKPiArICAgICAgICAgICAgdmNwdV9taWdyYXRlX3N0YXJ0KHVuaXQtPnZj
cHVfbGlzdCk7Cj4gICAgICAgICAgICAgIHVuaXRfc2NoZWR1bGVfdW5sb2NrX2lycXJlc3RvcmUo
bG9jaywgZmxhZ3MsIHVuaXQpOwo+ICAKPiAtICAgICAgICAgICAgdmNwdV9taWdyYXRlX2Zpbmlz
aCh2KTsKPiArICAgICAgICAgICAgdmNwdV9taWdyYXRlX2ZpbmlzaCh1bml0LT52Y3B1X2xpc3Qp
OwoKQWxsIHRoZSAtPnZjcHVfbGlzdCByZWZlcmVuY2VzIGxvb2sgYm9ndXMgY29uc2lkZXJpbmcg
d2hlcmUgeW91J3JlCm1vdmluZywgYnV0IEkgY2FuIG9ubHkgZ3Vlc3MgdGhhdCBhbGwgb2YgdGhp
cyB3aWxsIG5lZWQgdG91Y2hpbmcKYWdhaW4gbGF0ZXIgaW4gdGhlIHNlcmllcy4gSSB3b25kZXIg
dGhvdWdoIHdoZXRoZXIgdGhlc2Ugd291bGRuJ3QKYmV0dGVyIGNoYW5nZSBpbnRvIGZvci1lYWNo
LXZDUFUtaW4tdW5pdCBsb29wcyByaWdodCBhd2F5LgoKPiAgICAgICAgICAgICAgLyoKPiAgICAg
ICAgICAgICAgICogVGhlIG9ubHkgY2F2ZWF0LCBpbiB0aGlzIGNhc2UsIGlzIHRoYXQgaWYgYSB2
Y3B1IGFjdGl2ZSBpbgo+ICAgICAgICAgICAgICAgKiB0aGUgaHlwZXJ2aXNvciBpc24ndCBtaWdy
YXRhYmxlLiBJbiB0aGlzIGNhc2UsIHRoZSBjYWxsZXIKPiAgICAgICAgICAgICAgICogc2hvdWxk
IHRyeSBhZ2FpbiBhZnRlciByZWxlYXNpbmcgYW5kIHJlYXF1aXJpbmcgYWxsIGxvY2tzLgo+ICAg
ICAgICAgICAgICAgKi8KPiAtICAgICAgICAgICAgaWYgKCB2LT5wcm9jZXNzb3IgPT0gY3B1ICkK
PiArICAgICAgICAgICAgaWYgKCBzY2hlZF91bml0X2NwdSh1bml0KSA9PSBzY2hlZF9nZXRfcmVz
b3VyY2VfY3B1KGNwdSkgKQoKSXMgY29tcGFyaW5nIHRoZSAocHNldWRvKSBDUFUgdmFsdWVzIGhl
cmUgdGhlIG1vc3QgZWZmaWNpZW50IGFwcHJvYWNoCmdlbmVyYXRlZCBjb2RlIHdpc2U/IENhbid0
IHRoZXJlIGJlIHNvbWUgcG9pbnRlciBjb21wYXJpc29uIHRoYXQncwpjaGVhcGVyPwoKPiBAQCAt
MTAyMyw4ICsxMDUzLDggQEAgaW50IGNwdV9kaXNhYmxlX3NjaGVkdWxlcih1bnNpZ25lZCBpbnQg
Y3B1KQo+ICBzdGF0aWMgaW50IGNwdV9kaXNhYmxlX3NjaGVkdWxlcl9jaGVjayh1bnNpZ25lZCBp
bnQgY3B1KQo+ICB7Cj4gICAgICBzdHJ1Y3QgZG9tYWluICpkOwo+IC0gICAgc3RydWN0IHZjcHUg
KnY7Cj4gICAgICBzdHJ1Y3QgY3B1cG9vbCAqYzsKPiArICAgIHN0cnVjdCB2Y3B1ICp2Owo+ICAK
PiAgICAgIGMgPSBwZXJfY3B1KGNwdXBvb2wsIGNwdSk7Cj4gICAgICBpZiAoIGMgPT0gTlVMTCAp
CgpTdHJheSBjaGFuZ2U/CgpKYW4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnBy
b2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94
ZW4tZGV2ZWw=

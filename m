Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 25245165EDD
	for <lists+xen-devel@lfdr.de>; Thu, 20 Feb 2020 14:33:35 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j4lvN-0006At-Db; Thu, 20 Feb 2020 13:31:29 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=ARLV=4I=invisiblethingslab.com=pawel@srs-us1.protection.inumbo.net>)
 id 1j4lvL-0006Ao-In
 for xen-devel@lists.xenproject.org; Thu, 20 Feb 2020 13:31:27 +0000
X-Inumbo-ID: 4b2ca388-53e5-11ea-bc8e-bc764e2007e4
Received: from wout2-smtp.messagingengine.com (unknown [64.147.123.25])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 4b2ca388-53e5-11ea-bc8e-bc764e2007e4;
 Thu, 20 Feb 2020 13:31:26 +0000 (UTC)
Received: from compute1.internal (compute1.nyi.internal [10.202.2.41])
 by mailout.west.internal (Postfix) with ESMTP id 3AE6D345;
 Thu, 20 Feb 2020 08:31:25 -0500 (EST)
Received: from mailfrontend1 ([10.202.2.162])
 by compute1.internal (MEProxy); Thu, 20 Feb 2020 08:31:25 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:message-id:mime-version:subject:to:x-me-proxy
 :x-me-proxy:x-me-sender:x-me-sender:x-sasl-enc; s=fm2; bh=C3kfas
 FJBEmWBmF/TW0tPGH++9JtUjNI6fnqWsoklGs=; b=bL1uyXvt9+/ZoMVNSTlrGG
 ycY3aVqS1v9PypNHp+WOD1vyLZpinR5EvNQGsZaNudU3sWw3CAnBOMKKgScfh4DR
 Xpk+tvTdy4BEdrdmnYF3O/w3zJoRXl4BrWMlLCBlw3jSLPS9wB13zr+le97OMPfJ
 FjA+bX0KnGln+PLFsGWpQHoYs2gL+bNRyMSKcxoZ4lwmkF0a4sRo9UiiloQz+tIj
 NrSfawdNsnJTynwmjatwdHadEwGveEVnGZUuFLx6NSSX2TPjPUTs/c6JSNWKUoa6
 fH3SY0Es89ZPyryJdXr7jYzwXK0wbx15S84DAll+1Xf3mXp4/srgotAJVP9oz1Cg
 ==
X-ME-Sender: <xms:LIpOXqLUDLAun2OQFMeQZi1VcoQKgpxi6q_AnmBD9l_lDM_5TC6qFw>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgedugedrkedvgdehfecutefuodetggdotefrodftvf
 curfhrohhfihhlvgemucfhrghsthforghilhdpqfgfvfdpuffrtefokffrpgfnqfghnecu
 uegrihhlohhuthemuceftddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenuc
 fjughrpefhvffufffkofggtgfgsehtkeertdertdejnecuhfhrohhmpefrrgifvghlucfo
 rghrtgiivgifshhkihcuoehprgifvghlsehinhhvihhsihgslhgvthhhihhnghhslhgrsg
 drtghomheqnecuffhomhgrihhnpegtrhgvrghtihhonhdrthhoohhlshenucfkphepkeef
 rdeljedrvdefrddvleenucevlhhushhtvghrufhiiigvpedtnecurfgrrhgrmhepmhgrih
 hlfhhrohhmpehprgifvghlsehinhhvihhsihgslhgvthhhihhnghhslhgrsgdrtghomh
X-ME-Proxy: <xmx:LIpOXgwJiG4u46FrX_eCehSvho9nDDxm2tk8_yBn6ciNqhKxX_Tt8Q>
 <xmx:LIpOXqUx10vJhzR-SVgm9LWPfA-Jhm31n6M0505dN1QzWmaUBFZ08Q>
 <xmx:LIpOXlnC3_uB4UILf-UH54oRRPev6vYAgOcf0wIEKEsjIx_sFVX0EQ>
 <xmx:LIpOXn0ibyaw-WQM54ndD8RSO3CFOLOMJzJh--DgdvPrboxPn8H7zA>
Received: from localhost.localdomain (unknown [83.97.23.29])
 by mail.messagingengine.com (Postfix) with ESMTPA id 9D3BE3280062;
 Thu, 20 Feb 2020 08:31:23 -0500 (EST)
From: =?UTF-8?q?Pawe=C5=82=20Marczewski?= <pawel@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Thu, 20 Feb 2020 14:31:03 +0100
Message-Id: <6613fdc72f9e7c4a7eb29ae73c19db810501944f.1582203228.git.pawel@invisiblethingslab.com>
X-Mailer: git-send-email 2.21.1
MIME-Version: 1.0
Subject: [Xen-devel] [XEN PATCH v2] libxl: wait for console path before
 firing console_available
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>,
 =?UTF-8?q?Pawe=C5=82=20Marczewski?= <pawel@invisiblethingslab.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SWYgd2Ugc2tpcCB0aGUgYm9vdGxvYWRlciwgdGhlIFRUWSBwYXRoIHdpbGwgYmUgc2V0IGZvciB4
ZW5jb25zb2xlZC4KSG93ZXZlciwgdGhlcmUgaXMgbm8gZ3VhcmFudGVlIHRoYXQgdGhpcyB3aWxs
IGhhcHBlbiBieSB0aGUgdGltZSB3ZQp3YW50IHRvIGNhbGwgdGhlIGNvbnNvbGVfYXZhaWxhYmxl
IGNhbGxiYWNrLCBzbyB3ZSBoYXZlIHRvIHdhaXQuCgpTaWduZWQtb2ZmLWJ5OiBQYXdlxYIgTWFy
Y3pld3NraSA8cGF3ZWxAaW52aXNpYmxldGhpbmdzbGFiLmNvbT4KLS0tCkNoYW5nZWQgc2luY2Ug
djE6CiAgKiB1c2UgeHN3YWl0IG1lY2hhbmlzbSB0byBhZGQgYSB0aW1lb3V0CgpBcyBtZW50aW9u
ZWQgYmVmb3JlLCB0aGlzIGlzIHRvIGZpeCBhIHJhY2UgY29uZGl0aW9uIHRoYXQgYXBwZWFycyB3
aGVuCnVzaW5nIGxpYnhsIHZpYSBsaWJ2aXJ0IGFuZCBub3QgdXNpbmcgYm9vdGxvYWRlciAoY29u
c29sZV9hdmFpbGFibGUKZmlyZXMgdG9vIGVhcmx5KS4KCkkgaGF2ZSB0ZXN0ZWQgdGhlIHBhdGNo
IG9uIFF1YmVzIE9TIDQuMSAod2l0aCBYZW4gNC4xMyksIGFuZCBpdCBzZWVtcwp0byBzb2x2ZSB0
aGUgcHJvYmxlbS4gSSBhbHNvIGNoZWNrZWQgdGhlIHRpbWVvdXQ6IHdoZW4geGVuY29uc29sZWQg
aXMKc3RvcHBlZCwgbGlieGwgd2FpdHMgZm9yIDEwIHNlY29uZHMgYW5kIHRoZW4gYWJvcnRzIGRv
bWFpbiBjcmVhdGlvbi4KCiB0b29scy9saWJ4bC9saWJ4bF9jcmVhdGUuYyAgIHwgNDMgKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCiB0b29scy9saWJ4bC9saWJ4bF9pbnRlcm5h
bC5oIHwgIDEgKwogMiBmaWxlcyBjaGFuZ2VkLCA0MSBpbnNlcnRpb25zKCspLCAzIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xpYnhsX2NyZWF0ZS5jIGIvdG9vbHMvbGli
eGwvbGlieGxfY3JlYXRlLmMKaW5kZXggM2E3MzY0ZTJhYy4uNGIxNTBkOTJiOSAxMDA2NDQKLS0t
IGEvdG9vbHMvbGlieGwvbGlieGxfY3JlYXRlLmMKKysrIGIvdG9vbHMvbGlieGwvbGlieGxfY3Jl
YXRlLmMKQEAgLTExOTAsNiArMTE5MCwzMyBAQCBzdGF0aWMgdm9pZCBkb21jcmVhdGVfY29uc29s
ZV9hdmFpbGFibGUobGlieGxfX2VnYyAqZWdjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGRjcy0+YW9wX2NvbnNvbGVfaG93LmZvcl9ldmVudCkpOwogfQogCitzdGF0
aWMgdm9pZCBjb25zb2xlX3hzd2FpdF9jYWxsYmFjayhsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX194
c3dhaXRfc3RhdGUgKnhzd2EsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgcmMsIGNvbnN0IGNoYXIgKnApCit7CisgICAgRUdDX0dDOworICAgIGxpYnhsX19kb21haW5f
Y3JlYXRlX3N0YXRlICpkY3MgPSBDT05UQUlORVJfT0YoeHN3YSwgKmRjcywgY29uc29sZV94c3dh
aXQpOworICAgIGNoYXIgKmRvbXBhdGggPSBsaWJ4bF9feHNfZ2V0X2RvbXBhdGgoZ2MsIGRjcy0+
Z3Vlc3RfZG9taWQpOworICAgIGNoYXIgKnR0eV9wYXRoID0gR0NTUFJJTlRGKCIlcy9jb25zb2xl
L3R0eSIsIGRvbXBhdGgpOworICAgIGNoYXIgKnR0eTsKKworICAgIGlmIChyYykgeworICAgICAg
ICBpZiAocmMgPT0gRVJST1JfVElNRURPVVQpCisgICAgICAgICAgICBMT0coRVJST1IsICIlczog
dGltZWQgb3V0IiwgeHN3YS0+d2hhdCk7CisgICAgICAgIGxpYnhsX194c3dhaXRfc3RvcChnYywg
eHN3YSk7CisgICAgICAgIGRvbWNyZWF0ZV9jb21wbGV0ZShlZ2MsIGRjcywgcmMpOworICAgICAg
ICByZXR1cm47CisgICAgfQorCisgICAgdHR5ID0gbGlieGxfX3hzX3JlYWQoZ2MsIFhCVF9OVUxM
LCB0dHlfcGF0aCk7CisKKyAgICBpZiAodHR5ICYmIHR0eVswXSAhPSAnXDAnKSB7CisgICAgICAg
IGxpYnhsX194c3dhaXRfc3RvcChnYywgeHN3YSk7CisKKyAgICAgICAgZG9tY3JlYXRlX2NvbnNv
bGVfYXZhaWxhYmxlKGVnYywgZGNzKTsKKyAgICAgICAgZG9tY3JlYXRlX2NvbXBsZXRlKGVnYywg
ZGNzLCAwKTsKKyAgICB9Cit9CisKIHN0YXRpYyB2b2lkIGRvbWNyZWF0ZV9ib290bG9hZGVyX2Rv
bmUobGlieGxfX2VnYyAqZWdjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBsaWJ4bF9fYm9vdGxvYWRlcl9zdGF0ZSAqYmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCByYykKQEAgLTE3MjgsOSArMTc1NSwxOCBAQCBzdGF0aWMgdm9pZCBk
b21jcmVhdGVfYXR0YWNoX2RldmljZXMobGlieGxfX2VnYyAqZWdjLAogICAgICAgICByZXR1cm47
CiAgICAgfQogCi0gICAgZG9tY3JlYXRlX2NvbnNvbGVfYXZhaWxhYmxlKGVnYywgZGNzKTsKLQot
ICAgIGRvbWNyZWF0ZV9jb21wbGV0ZShlZ2MsIGRjcywgMCk7CisgICAgZGNzLT5jb25zb2xlX3hz
d2FpdC5hbyA9IGFvOworICAgIGRjcy0+Y29uc29sZV94c3dhaXQud2hhdCA9IEdDU1BSSU5URigi
ZG9tYWluICVkIGNvbnNvbGUgdHR5IiwgZG9taWQpOworICAgIGRjcy0+Y29uc29sZV94c3dhaXQu
cGF0aCA9IEdDU1BSSU5URigiJXMvY29uc29sZS90dHkiLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBsaWJ4bF9feHNfZ2V0X2RvbXBhdGgoZ2MsIGRvbWlkKSk7Cisg
ICAgZGNzLT5jb25zb2xlX3hzd2FpdC50aW1lb3V0X21zID0gMTAgKiAxMDAwOworICAgIGRjcy0+
Y29uc29sZV94c3dhaXQuY2FsbGJhY2sgPSBjb25zb2xlX3hzd2FpdF9jYWxsYmFjazsKKyAgICBy
ZXQgPSBsaWJ4bF9feHN3YWl0X3N0YXJ0KGdjLCAmZGNzLT5jb25zb2xlX3hzd2FpdCk7CisgICAg
aWYgKHJldCkgeworICAgICAgICBMT0coRVJST1IsICJ1bmFibGUgdG8gc2V0IHVwIHdhdGNoIGZv
ciBkb21haW4gJWQgY29uc29sZSBwYXRoIiwKKyAgICAgICAgICAgIGRvbWlkKTsKKyAgICAgICAg
Z290byBlcnJvcl9vdXQ7CisgICAgfQogCiAgICAgcmV0dXJuOwogCkBAIC0xODYxLDYgKzE4OTcs
NyBAQCBzdGF0aWMgaW50IGRvX2RvbWFpbl9jcmVhdGUobGlieGxfY3R4ICpjdHgsIGxpYnhsX2Rv
bWFpbl9jb25maWcgKmRfY29uZmlnLAogCiAgICAgbGlieGxfX2FvX3Byb2dyZXNzX2dldGhvdygm
Y2Rjcy0+ZGNzLmFvcF9jb25zb2xlX2hvdywgYW9wX2NvbnNvbGVfaG93KTsKICAgICBjZGNzLT5k
b21pZF9vdXQgPSBkb21pZDsKKyAgICBsaWJ4bF9feHN3YWl0X2luaXQoJmNkY3MtPmRjcy5jb25z
b2xlX3hzd2FpdCk7CiAKICAgICBpbml0aWF0ZV9kb21haW5fY3JlYXRlKGVnYywgJmNkY3MtPmRj
cyk7CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xpYnhsX2ludGVybmFsLmggYi90b29scy9s
aWJ4bC9saWJ4bF9pbnRlcm5hbC5oCmluZGV4IDQ5MzY0NDYwNjkuLmQ4MTI5NDE3ZGMgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhsX2ludGVybmFsLmgKKysrIGIvdG9vbHMvbGlieGwvbGli
eGxfaW50ZXJuYWwuaApAQCAtNDE4MCw2ICs0MTgwLDcgQEAgc3RydWN0IGxpYnhsX19kb21haW5f
Y3JlYXRlX3N0YXRlIHsKICAgICAvKiBuZWNlc3NhcnkgaWYgdGhlIGRvbWFpbiBjcmVhdGlvbiBm
YWlsZWQgYW5kIHdlIGhhdmUgdG8gZGVzdHJveSBpdCAqLwogICAgIGxpYnhsX19kb21haW5fZGVz
dHJveV9zdGF0ZSBkZHM7CiAgICAgbGlieGxfX211bHRpZGV2IG11bHRpZGV2OworICAgIGxpYnhs
X194c3dhaXRfc3RhdGUgY29uc29sZV94c3dhaXQ7CiB9OwogCiBfaGlkZGVuIGludCBsaWJ4bF9f
ZGV2aWNlX25pY19zZXRfZGV2aWRzKGxpYnhsX19nYyAqZ2MsCi0tIAoyLjIxLjEKCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGlu
ZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnBy
b2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

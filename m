Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4CAE017CE70
	for <lists+xen-devel@lfdr.de>; Sat,  7 Mar 2020 14:47:13 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1jAZjn-000788-89; Sat, 07 Mar 2020 13:43:31 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=dMHb=4Y=gmail.com=yyankovskyi@srs-us1.protection.inumbo.net>)
 id 1jAZjl-000783-Pk
 for xen-devel@lists.xenproject.org; Sat, 07 Mar 2020 13:43:29 +0000
X-Inumbo-ID: 9f95cc88-6079-11ea-b52f-bc764e2007e4
Received: from mail-wm1-x342.google.com (unknown [2a00:1450:4864:20::342])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 9f95cc88-6079-11ea-b52f-bc764e2007e4;
 Sat, 07 Mar 2020 13:43:27 +0000 (UTC)
Received: by mail-wm1-x342.google.com with SMTP id u9so5251390wml.3
 for <xen-devel@lists.xenproject.org>; Sat, 07 Mar 2020 05:43:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=date:from:to:cc:subject:message-id:mime-version:content-disposition
 :user-agent; bh=UzOq6FF3akuPLC3LG/nbtpm2iPPVNKaEhYdMK/V4DS4=;
 b=UxH22wuIfNxM82dg41VB6fdmI5cHQGp7lvwz2K44E4mz3F0f5GHU2mxBHC37JWyqmd
 Md54KEzvLJrC5II5SVOAZAWo5YomNxm4E3gzfkRQQdzuntKfM7L/qOGHd30MK8RKrBia
 WZ3M70xMqxT/YWEXZmh6yB2V8GFH8eZlzpMnZ1VJWQIuuJxdoJCRivcSsXp/Jjm7PFwc
 m56aDwmPRK54zeNED70EFkJQwga3CwY9xRABEiIDFSX7MogzfA6kHe7Ht2gfoJXkjM9T
 0/qsFFve91XPjDHSbCok0pMrO/T1gxp8W44QukzspJW08wQFJGdPTkBuEmXqbFcdUnWp
 ormA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id:mime-version
 :content-disposition:user-agent;
 bh=UzOq6FF3akuPLC3LG/nbtpm2iPPVNKaEhYdMK/V4DS4=;
 b=ilbNhgv5EVYVo7h8NlCludMANewHTIStDNbQr8w8U6lM0XWLFPwWZly5G5AD9oQoe8
 Y0HR455x+gXnKgPnw9akzL/z1yDWufXeOqllcPDtNtsQLcobglaNpxFaMoUsk3ySTGlb
 t2obSWvNLiOXbtT0WJXutQ7M+pdpppfyOJ9BxDcXCCWitG80udQCE8SrVRdKxnBrkN2Z
 S8SChd3nExLBfo8lSTjCWjxHSUjX6bF2qzsk1xC4Yon+AdmBfh4G1PR0XLP1CjUBSFkN
 LbtKEgb5cSiCesk9r6MNdgT2SVAe10eRMAA/JSTWKtHtNZtl3NEjZiabLAhN48Gq06EF
 P81w==
X-Gm-Message-State: ANhLgQ0wRR8mW8VW7/W+5f0tE2u4aY19dnWazA2ckbW2QZMsXxX8j/nr
 JVbQ2juHx83Jh6j9eq9KxHQ=
X-Google-Smtp-Source: ADFU+vsUs+QmAkT5XOB9p9rVquO+gT1CLcpyghqwj6qHtOYCQ/Bvz0SzGyyVrDxQX64Hrp5P5Vk1JA==
X-Received: by 2002:a05:600c:2214:: with SMTP id
 z20mr9508158wml.57.1583588606301; 
 Sat, 07 Mar 2020 05:43:26 -0800 (PST)
Received: from kbp1-lhp-F74019 (a81-14-236-68.net-htp.de. [81.14.236.68])
 by smtp.gmail.com with ESMTPSA id j14sm53414628wrn.32.2020.03.07.05.43.24
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Sat, 07 Mar 2020 05:43:25 -0800 (PST)
Date: Sat, 7 Mar 2020 15:43:22 +0200
From: Yan Yankovskyi <yyankovskyi@gmail.com>
To: Boris Ostrovsky <boris.ostrovsky@oracle.com>,
 Jan Beulich <jbeulich@suse.com>
Message-ID: <20200307134322.GA27756@kbp1-lhp-F74019>
MIME-Version: 1.0
Content-Disposition: inline
User-Agent: Mutt/1.9.4 (2018-02-28)
Subject: [Xen-devel] [PATCH v2] xen: Use evtchn_type_t as a type for event
 channels
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, xen-devel@lists.xenproject.org,
 Stefano Stabellini <sstabellini@kernel.org>, linux-kernel@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TWFrZSBldmVudCBjaGFubmVsIGZ1bmN0aW9ucyBwYXNzIGV2ZW50IGNoYW5uZWwgcG9ydCB1c2lu
ZwpldnRjaG5fcG9ydF90IHR5cGUuIEl0IGVsaW1pbmF0ZXMgc2lnbmVkIDwtPiB1bnNpZ25lZCBj
b252ZXJzaW9uLgoKU2lnbmVkLW9mZi1ieTogWWFuIFlhbmtvdnNreWkgPHl5YW5rb3Zza3lpQGdt
YWlsLmNvbT4KLS0tCiBkcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzXzJsLmMgICAgICAgIHwgMTYg
KysrLS0tCiBkcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2Jhc2UuYyAgICAgIHwgODMgKysrKysr
KysrKysrKystLS0tLS0tLS0tLS0tCiBkcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ZpZm8uYyAg
ICAgIHwgMjIgKysrLS0tLQogZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19pbnRlcm5hbC5oICB8
IDMwICsrKysrLS0tLS0KIGRyaXZlcnMveGVuL2V2dGNobi5jICAgICAgICAgICAgICAgICAgfCAx
MyArKystLQogZHJpdmVycy94ZW4vcHZjYWxscy1iYWNrLmMgICAgICAgICAgICB8ICA1ICstCiBk
cml2ZXJzL3hlbi94ZW4tcGNpYmFjay94ZW5idXMuYyAgICAgIHwgIDcgKystCiBkcml2ZXJzL3hl
bi94ZW4tc2NzaWJhY2suYyAgICAgICAgICAgIHwgIDMgKy0KIGRyaXZlcnMveGVuL3hlbmJ1cy94
ZW5idXNfY2xpZW50LmMgICAgfCAgNiArLQogaW5jbHVkZS94ZW4vZXZlbnRzLmggICAgICAgICAg
ICAgICAgICB8IDIwICsrKy0tLS0KIGluY2x1ZGUveGVuL2ludGVyZmFjZS9ldmVudF9jaGFubmVs
LmggfCAgMiArLQogaW5jbHVkZS94ZW4veGVuYnVzLmggICAgICAgICAgICAgICAgICB8ICA0ICst
CiAxMiBmaWxlcyBjaGFuZ2VkLCAxMDkgaW5zZXJ0aW9ucygrKSwgMTAyIGRlbGV0aW9ucygtKQoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfMmwuYyBiL2RyaXZlcnMveGVu
L2V2ZW50cy9ldmVudHNfMmwuYwppbmRleCA4ZWRlZjUxYzkyZTUuLjY0ZGY5MTlhMjExMSAxMDA2
NDQKLS0tIGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c18ybC5jCisrKyBiL2RyaXZlcnMveGVu
L2V2ZW50cy9ldmVudHNfMmwuYwpAQCAtNTMsMzcgKzUzLDM3IEBAIHN0YXRpYyB2b2lkIGV2dGNo
bl8ybF9iaW5kX3RvX2NwdShzdHJ1Y3QgaXJxX2luZm8gKmluZm8sIHVuc2lnbmVkIGNwdSkKIAlz
ZXRfYml0KGluZm8tPmV2dGNobiwgQk0ocGVyX2NwdShjcHVfZXZ0Y2huX21hc2ssIGNwdSkpKTsK
IH0KIAotc3RhdGljIHZvaWQgZXZ0Y2huXzJsX2NsZWFyX3BlbmRpbmcodW5zaWduZWQgcG9ydCkK
K3N0YXRpYyB2b2lkIGV2dGNobl8ybF9jbGVhcl9wZW5kaW5nKGV2dGNobl9wb3J0X3QgcG9ydCkK
IHsKIAlzdHJ1Y3Qgc2hhcmVkX2luZm8gKnMgPSBIWVBFUlZJU09SX3NoYXJlZF9pbmZvOwogCXN5
bmNfY2xlYXJfYml0KHBvcnQsIEJNKCZzLT5ldnRjaG5fcGVuZGluZ1swXSkpOwogfQogCi1zdGF0
aWMgdm9pZCBldnRjaG5fMmxfc2V0X3BlbmRpbmcodW5zaWduZWQgcG9ydCkKK3N0YXRpYyB2b2lk
IGV2dGNobl8ybF9zZXRfcGVuZGluZyhldnRjaG5fcG9ydF90IHBvcnQpCiB7CiAJc3RydWN0IHNo
YXJlZF9pbmZvICpzID0gSFlQRVJWSVNPUl9zaGFyZWRfaW5mbzsKIAlzeW5jX3NldF9iaXQocG9y
dCwgQk0oJnMtPmV2dGNobl9wZW5kaW5nWzBdKSk7CiB9CiAKLXN0YXRpYyBib29sIGV2dGNobl8y
bF9pc19wZW5kaW5nKHVuc2lnbmVkIHBvcnQpCitzdGF0aWMgYm9vbCBldnRjaG5fMmxfaXNfcGVu
ZGluZyhldnRjaG5fcG9ydF90IHBvcnQpCiB7CiAJc3RydWN0IHNoYXJlZF9pbmZvICpzID0gSFlQ
RVJWSVNPUl9zaGFyZWRfaW5mbzsKIAlyZXR1cm4gc3luY190ZXN0X2JpdChwb3J0LCBCTSgmcy0+
ZXZ0Y2huX3BlbmRpbmdbMF0pKTsKIH0KIAotc3RhdGljIGJvb2wgZXZ0Y2huXzJsX3Rlc3RfYW5k
X3NldF9tYXNrKHVuc2lnbmVkIHBvcnQpCitzdGF0aWMgYm9vbCBldnRjaG5fMmxfdGVzdF9hbmRf
c2V0X21hc2soZXZ0Y2huX3BvcnRfdCBwb3J0KQogewogCXN0cnVjdCBzaGFyZWRfaW5mbyAqcyA9
IEhZUEVSVklTT1Jfc2hhcmVkX2luZm87CiAJcmV0dXJuIHN5bmNfdGVzdF9hbmRfc2V0X2JpdChw
b3J0LCBCTSgmcy0+ZXZ0Y2huX21hc2tbMF0pKTsKIH0KIAotc3RhdGljIHZvaWQgZXZ0Y2huXzJs
X21hc2sodW5zaWduZWQgcG9ydCkKK3N0YXRpYyB2b2lkIGV2dGNobl8ybF9tYXNrKGV2dGNobl9w
b3J0X3QgcG9ydCkKIHsKIAlzdHJ1Y3Qgc2hhcmVkX2luZm8gKnMgPSBIWVBFUlZJU09SX3NoYXJl
ZF9pbmZvOwogCXN5bmNfc2V0X2JpdChwb3J0LCBCTSgmcy0+ZXZ0Y2huX21hc2tbMF0pKTsKIH0K
IAotc3RhdGljIHZvaWQgZXZ0Y2huXzJsX3VubWFzayh1bnNpZ25lZCBwb3J0KQorc3RhdGljIHZv
aWQgZXZ0Y2huXzJsX3VubWFzayhldnRjaG5fcG9ydF90IHBvcnQpCiB7CiAJc3RydWN0IHNoYXJl
ZF9pbmZvICpzID0gSFlQRVJWSVNPUl9zaGFyZWRfaW5mbzsKIAl1bnNpZ25lZCBpbnQgY3B1ID0g
Z2V0X2NwdSgpOwpAQCAtMTczLDcgKzE3Myw3IEBAIHN0YXRpYyB2b2lkIGV2dGNobl8ybF9oYW5k
bGVfZXZlbnRzKHVuc2lnbmVkIGNwdSkKIAkvKiBUaW1lciBpbnRlcnJ1cHQgaGFzIGhpZ2hlc3Qg
cHJpb3JpdHkuICovCiAJaXJxID0gaXJxX2Zyb21fdmlycShjcHUsIFZJUlFfVElNRVIpOwogCWlm
IChpcnEgIT0gLTEpIHsKLQkJdW5zaWduZWQgaW50IGV2dGNobiA9IGV2dGNobl9mcm9tX2lycShp
cnEpOworCQlldnRjaG5fcG9ydF90IGV2dGNobiA9IGV2dGNobl9mcm9tX2lycShpcnEpOwogCQl3
b3JkX2lkeCA9IGV2dGNobiAvIEJJVFNfUEVSX0xPTkc7CiAJCWJpdF9pZHggPSBldnRjaG4gJSBC
SVRTX1BFUl9MT05HOwogCQlpZiAoYWN0aXZlX2V2dGNobnMoY3B1LCBzLCB3b3JkX2lkeCkgJiAo
MVVMTCA8PCBiaXRfaWR4KSkKQEAgLTIyOCw3ICsyMjgsNyBAQCBzdGF0aWMgdm9pZCBldnRjaG5f
MmxfaGFuZGxlX2V2ZW50cyh1bnNpZ25lZCBjcHUpCiAKIAkJZG8gewogCQkJeGVuX3Vsb25nX3Qg
Yml0czsKLQkJCWludCBwb3J0OworCQkJZXZ0Y2huX3BvcnRfdCBwb3J0OwogCiAJCQliaXRzID0g
TUFTS19MU0JTKHBlbmRpbmdfYml0cywgYml0X2lkeCk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
eGVuL2V2ZW50cy9ldmVudHNfYmFzZS5jIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNl
LmMKaW5kZXggNDk5ZWZmN2QzZjY1Li4wNmY2Y2IwMWFmMzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
eGVuL2V2ZW50cy9ldmVudHNfYmFzZS5jCisrKyBiL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNf
YmFzZS5jCkBAIC0xMTYsNyArMTE2LDcgQEAgc3RhdGljIHZvaWQgY2xlYXJfZXZ0Y2huX3RvX2ly
cV9hbGwodm9pZCkKIAl9CiB9CiAKLXN0YXRpYyBpbnQgc2V0X2V2dGNobl90b19pcnEodW5zaWdu
ZWQgZXZ0Y2huLCB1bnNpZ25lZCBpcnEpCitzdGF0aWMgaW50IHNldF9ldnRjaG5fdG9faXJxKGV2
dGNobl9wb3J0X3QgZXZ0Y2huLCB1bnNpZ25lZCBpbnQgaXJxKQogewogCXVuc2lnbmVkIHJvdzsK
IAl1bnNpZ25lZCBjb2w7CkBAIC0xNDMsNyArMTQzLDcgQEAgc3RhdGljIGludCBzZXRfZXZ0Y2hu
X3RvX2lycSh1bnNpZ25lZCBldnRjaG4sIHVuc2lnbmVkIGlycSkKIAlyZXR1cm4gMDsKIH0KIAot
aW50IGdldF9ldnRjaG5fdG9faXJxKHVuc2lnbmVkIGV2dGNobikKK2ludCBnZXRfZXZ0Y2huX3Rv
X2lycShldnRjaG5fcG9ydF90IGV2dGNobikKIHsKIAlpZiAoZXZ0Y2huID49IHhlbl9ldnRjaG5f
bWF4X2NoYW5uZWxzKCkpCiAJCXJldHVybiAtMTsKQEAgLTE2Miw3ICsxNjIsNyBAQCBzdHJ1Y3Qg
aXJxX2luZm8gKmluZm9fZm9yX2lycSh1bnNpZ25lZCBpcnEpCiBzdGF0aWMgaW50IHhlbl9pcnFf
aW5mb19jb21tb25fc2V0dXAoc3RydWN0IGlycV9pbmZvICppbmZvLAogCQkJCSAgICAgdW5zaWdu
ZWQgaXJxLAogCQkJCSAgICAgZW51bSB4ZW5faXJxX3R5cGUgdHlwZSwKLQkJCQkgICAgIHVuc2ln
bmVkIGV2dGNobiwKKwkJCQkgICAgIGV2dGNobl9wb3J0X3QgZXZ0Y2huLAogCQkJCSAgICAgdW5z
aWduZWQgc2hvcnQgY3B1KQogewogCWludCByZXQ7CkBAIC0xODQsNyArMTg0LDcgQEAgc3RhdGlj
IGludCB4ZW5faXJxX2luZm9fY29tbW9uX3NldHVwKHN0cnVjdCBpcnFfaW5mbyAqaW5mbywKIH0K
IAogc3RhdGljIGludCB4ZW5faXJxX2luZm9fZXZ0Y2huX3NldHVwKHVuc2lnbmVkIGlycSwKLQkJ
CQkgICAgIHVuc2lnbmVkIGV2dGNobikKKwkJCQkgICAgIGV2dGNobl9wb3J0X3QgZXZ0Y2huKQog
ewogCXN0cnVjdCBpcnFfaW5mbyAqaW5mbyA9IGluZm9fZm9yX2lycShpcnEpOwogCkBAIC0xOTMs
NyArMTkzLDcgQEAgc3RhdGljIGludCB4ZW5faXJxX2luZm9fZXZ0Y2huX3NldHVwKHVuc2lnbmVk
IGlycSwKIAogc3RhdGljIGludCB4ZW5faXJxX2luZm9faXBpX3NldHVwKHVuc2lnbmVkIGNwdSwK
IAkJCQkgIHVuc2lnbmVkIGlycSwKLQkJCQkgIHVuc2lnbmVkIGV2dGNobiwKKwkJCQkgIGV2dGNo
bl9wb3J0X3QgZXZ0Y2huLAogCQkJCSAgZW51bSBpcGlfdmVjdG9yIGlwaSkKIHsKIAlzdHJ1Y3Qg
aXJxX2luZm8gKmluZm8gPSBpbmZvX2Zvcl9pcnEoaXJxKTsKQEAgLTIwNyw3ICsyMDcsNyBAQCBz
dGF0aWMgaW50IHhlbl9pcnFfaW5mb19pcGlfc2V0dXAodW5zaWduZWQgY3B1LAogCiBzdGF0aWMg
aW50IHhlbl9pcnFfaW5mb192aXJxX3NldHVwKHVuc2lnbmVkIGNwdSwKIAkJCQkgICB1bnNpZ25l
ZCBpcnEsCi0JCQkJICAgdW5zaWduZWQgZXZ0Y2huLAorCQkJCSAgIGV2dGNobl9wb3J0X3QgZXZ0
Y2huLAogCQkJCSAgIHVuc2lnbmVkIHZpcnEpCiB7CiAJc3RydWN0IGlycV9pbmZvICppbmZvID0g
aW5mb19mb3JfaXJxKGlycSk7CkBAIC0yMjAsNyArMjIwLDcgQEAgc3RhdGljIGludCB4ZW5faXJx
X2luZm9fdmlycV9zZXR1cCh1bnNpZ25lZCBjcHUsCiB9CiAKIHN0YXRpYyBpbnQgeGVuX2lycV9p
bmZvX3BpcnFfc2V0dXAodW5zaWduZWQgaXJxLAotCQkJCSAgIHVuc2lnbmVkIGV2dGNobiwKKwkJ
CQkgICBldnRjaG5fcG9ydF90IGV2dGNobiwKIAkJCQkgICB1bnNpZ25lZCBwaXJxLAogCQkJCSAg
IHVuc2lnbmVkIGdzaSwKIAkJCQkgICB1aW50MTZfdCBkb21pZCwKQEAgLTI1Myw3ICsyNTMsNyBA
QCB1bnNpZ25lZCBpbnQgZXZ0Y2huX2Zyb21faXJxKHVuc2lnbmVkIGlycSkKIAlyZXR1cm4gaW5m
b19mb3JfaXJxKGlycSktPmV2dGNobjsKIH0KIAotdW5zaWduZWQgaXJxX2Zyb21fZXZ0Y2huKHVu
c2lnbmVkIGludCBldnRjaG4pCit1bnNpZ25lZCBpbnQgaXJxX2Zyb21fZXZ0Y2huKGV2dGNobl9w
b3J0X3QgZXZ0Y2huKQogewogCXJldHVybiBnZXRfZXZ0Y2huX3RvX2lycShldnRjaG4pOwogfQpA
QCAtMzA0LDcgKzMwNCw3IEBAIHVuc2lnbmVkIGNwdV9mcm9tX2lycSh1bnNpZ25lZCBpcnEpCiAJ
cmV0dXJuIGluZm9fZm9yX2lycShpcnEpLT5jcHU7CiB9CiAKLXVuc2lnbmVkIGludCBjcHVfZnJv
bV9ldnRjaG4odW5zaWduZWQgaW50IGV2dGNobikKK3Vuc2lnbmVkIGludCBjcHVfZnJvbV9ldnRj
aG4oZXZ0Y2huX3BvcnRfdCBldnRjaG4pCiB7CiAJaW50IGlycSA9IGdldF9ldnRjaG5fdG9faXJx
KGV2dGNobik7CiAJdW5zaWduZWQgcmV0ID0gMDsKQEAgLTM1NCw3ICszNTQsNyBAQCBzdGF0aWMg
dm9pZCBiaW5kX2V2dGNobl90b19jcHUodW5zaWduZWQgaW50IGNobiwgdW5zaWduZWQgaW50IGNw
dSkKICAqLwogdm9pZCBub3RpZnlfcmVtb3RlX3ZpYV9pcnEoaW50IGlycSkKIHsKLQlpbnQgZXZ0
Y2huID0gZXZ0Y2huX2Zyb21faXJxKGlycSk7CisJZXZ0Y2huX3BvcnRfdCBldnRjaG4gPSBldnRj
aG5fZnJvbV9pcnEoaXJxKTsKIAogCWlmIChWQUxJRF9FVlRDSE4oZXZ0Y2huKSkKIAkJbm90aWZ5
X3JlbW90ZV92aWFfZXZ0Y2huKGV2dGNobik7CkBAIC00NDUsNyArNDQ1LDcgQEAgc3RhdGljIHZv
aWQgeGVuX2ZyZWVfaXJxKHVuc2lnbmVkIGlycSkKIAlpcnFfZnJlZV9kZXNjKGlycSk7CiB9CiAK
LXN0YXRpYyB2b2lkIHhlbl9ldnRjaG5fY2xvc2UodW5zaWduZWQgaW50IHBvcnQpCitzdGF0aWMg
dm9pZCB4ZW5fZXZ0Y2huX2Nsb3NlKGV2dGNobl9wb3J0X3QgcG9ydCkKIHsKIAlzdHJ1Y3QgZXZ0
Y2huX2Nsb3NlIGNsb3NlOwogCkBAIC00NzIsNyArNDcyLDcgQEAgc3RhdGljIHZvaWQgcGlycV9x
dWVyeV91bm1hc2soaW50IGlycSkKIAogc3RhdGljIHZvaWQgZW9pX3BpcnEoc3RydWN0IGlycV9k
YXRhICpkYXRhKQogewotCWludCBldnRjaG4gPSBldnRjaG5fZnJvbV9pcnEoZGF0YS0+aXJxKTsK
KwlldnRjaG5fcG9ydF90IGV2dGNobiA9IGV2dGNobl9mcm9tX2lycShkYXRhLT5pcnEpOwogCXN0
cnVjdCBwaHlzZGV2X2VvaSBlb2kgPSB7IC5pcnEgPSBwaXJxX2Zyb21faXJxKGRhdGEtPmlycSkg
fTsKIAlpbnQgcmMgPSAwOwogCkBAIC01MDgsNyArNTA4LDcgQEAgc3RhdGljIHVuc2lnbmVkIGlu
dCBfX3N0YXJ0dXBfcGlycSh1bnNpZ25lZCBpbnQgaXJxKQogewogCXN0cnVjdCBldnRjaG5fYmlu
ZF9waXJxIGJpbmRfcGlycTsKIAlzdHJ1Y3QgaXJxX2luZm8gKmluZm8gPSBpbmZvX2Zvcl9pcnEo
aXJxKTsKLQlpbnQgZXZ0Y2huID0gZXZ0Y2huX2Zyb21faXJxKGlycSk7CisJZXZ0Y2huX3BvcnRf
dCBldnRjaG4gPSBldnRjaG5fZnJvbV9pcnEoaXJxKTsKIAlpbnQgcmM7CiAKIAlCVUdfT04oaW5m
by0+dHlwZSAhPSBJUlFUX1BJUlEpOwpAQCAtNTYxLDcgKzU2MSw3IEBAIHN0YXRpYyB2b2lkIHNo
dXRkb3duX3BpcnEoc3RydWN0IGlycV9kYXRhICpkYXRhKQogewogCXVuc2lnbmVkIGludCBpcnEg
PSBkYXRhLT5pcnE7CiAJc3RydWN0IGlycV9pbmZvICppbmZvID0gaW5mb19mb3JfaXJxKGlycSk7
Ci0JdW5zaWduZWQgZXZ0Y2huID0gZXZ0Y2huX2Zyb21faXJxKGlycSk7CisJZXZ0Y2huX3BvcnRf
dCBldnRjaG4gPSBldnRjaG5fZnJvbV9pcnEoaXJxKTsKIAogCUJVR19PTihpbmZvLT50eXBlICE9
IElSUVRfUElSUSk7CiAKQEAgLTYwMSw3ICs2MDEsNyBAQCBFWFBPUlRfU1lNQk9MX0dQTCh4ZW5f
aXJxX2Zyb21fZ3NpKTsKIAogc3RhdGljIHZvaWQgX191bmJpbmRfZnJvbV9pcnEodW5zaWduZWQg
aW50IGlycSkKIHsKLQlpbnQgZXZ0Y2huID0gZXZ0Y2huX2Zyb21faXJxKGlycSk7CisJZXZ0Y2hu
X3BvcnRfdCBldnRjaG4gPSBldnRjaG5fZnJvbV9pcnEoaXJxKTsKIAlzdHJ1Y3QgaXJxX2luZm8g
KmluZm8gPSBpcnFfZ2V0X2hhbmRsZXJfZGF0YShpcnEpOwogCiAJaWYgKGluZm8tPnJlZmNudCA+
IDApIHsKQEAgLTgyNyw3ICs4MjcsNyBAQCBpbnQgeGVuX3BpcnFfZnJvbV9pcnEodW5zaWduZWQg
aXJxKQogfQogRVhQT1JUX1NZTUJPTF9HUEwoeGVuX3BpcnFfZnJvbV9pcnEpOwogCi1pbnQgYmlu
ZF9ldnRjaG5fdG9faXJxKHVuc2lnbmVkIGludCBldnRjaG4pCitpbnQgYmluZF9ldnRjaG5fdG9f
aXJxKGV2dGNobl9wb3J0X3QgZXZ0Y2huKQogewogCWludCBpcnE7CiAJaW50IHJldDsKQEAgLTg3
MCw4ICs4NzAsOCBAQCBFWFBPUlRfU1lNQk9MX0dQTChiaW5kX2V2dGNobl90b19pcnEpOwogc3Rh
dGljIGludCBiaW5kX2lwaV90b19pcnEodW5zaWduZWQgaW50IGlwaSwgdW5zaWduZWQgaW50IGNw
dSkKIHsKIAlzdHJ1Y3QgZXZ0Y2huX2JpbmRfaXBpIGJpbmRfaXBpOwotCWludCBldnRjaG4sIGly
cTsKLQlpbnQgcmV0OworCWV2dGNobl9wb3J0X3QgZXZ0Y2huOworCWludCByZXQsIGlycTsKIAog
CW11dGV4X2xvY2soJmlycV9tYXBwaW5nX3VwZGF0ZV9sb2NrKTsKIApAQCAtOTA5LDcgKzkwOSw3
IEBAIHN0YXRpYyBpbnQgYmluZF9pcGlfdG9faXJxKHVuc2lnbmVkIGludCBpcGksIHVuc2lnbmVk
IGludCBjcHUpCiB9CiAKIGludCBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnEodW5zaWdu
ZWQgaW50IHJlbW90ZV9kb21haW4sCi0JCQkJICAgdW5zaWduZWQgaW50IHJlbW90ZV9wb3J0KQor
CQkJCSAgIGV2dGNobl9wb3J0X3QgcmVtb3RlX3BvcnQpCiB7CiAJc3RydWN0IGV2dGNobl9iaW5k
X2ludGVyZG9tYWluIGJpbmRfaW50ZXJkb21haW47CiAJaW50IGVycjsKQEAgLTkyNyw3ICs5Mjcs
OCBAQCBFWFBPUlRfU1lNQk9MX0dQTChiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnEpOwog
c3RhdGljIGludCBmaW5kX3ZpcnEodW5zaWduZWQgaW50IHZpcnEsIHVuc2lnbmVkIGludCBjcHUp
CiB7CiAJc3RydWN0IGV2dGNobl9zdGF0dXMgc3RhdHVzOwotCWludCBwb3J0LCByYyA9IC1FTk9F
TlQ7CisJZXZ0Y2huX3BvcnRfdCBwb3J0OworCWludCByYyA9IC1FTk9FTlQ7CiAKIAltZW1zZXQo
JnN0YXR1cywgMCwgc2l6ZW9mKHN0YXR1cykpOwogCWZvciAocG9ydCA9IDA7IHBvcnQgPCB4ZW5f
ZXZ0Y2huX21heF9jaGFubmVscygpOyBwb3J0KyspIHsKQEAgLTk2Miw3ICs5NjMsOCBAQCBFWFBP
UlRfU1lNQk9MX0dQTCh4ZW5fZXZ0Y2huX25yX2NoYW5uZWxzKTsKIGludCBiaW5kX3ZpcnFfdG9f
aXJxKHVuc2lnbmVkIGludCB2aXJxLCB1bnNpZ25lZCBpbnQgY3B1LCBib29sIHBlcmNwdSkKIHsK
IAlzdHJ1Y3QgZXZ0Y2huX2JpbmRfdmlycSBiaW5kX3ZpcnE7Ci0JaW50IGV2dGNobiwgaXJxLCBy
ZXQ7CisJZXZ0Y2huX3BvcnRfdCBldnRjaG4gPSB4ZW5fZXZ0Y2huX21heF9jaGFubmVscygpOwor
CWludCBpcnEsIHJldDsKIAogCW11dGV4X2xvY2soJmlycV9tYXBwaW5nX3VwZGF0ZV9sb2NrKTsK
IApAQCAtOTkwLDcgKzk5Miw2IEBAIGludCBiaW5kX3ZpcnFfdG9faXJxKHVuc2lnbmVkIGludCB2
aXJxLCB1bnNpZ25lZCBpbnQgY3B1LCBib29sIHBlcmNwdSkKIAkJCWlmIChyZXQgPT0gLUVFWElT
VCkKIAkJCQlyZXQgPSBmaW5kX3ZpcnEodmlycSwgY3B1KTsKIAkJCUJVR19PTihyZXQgPCAwKTsK
LQkJCWV2dGNobiA9IHJldDsKIAkJfQogCiAJCXJldCA9IHhlbl9pcnFfaW5mb192aXJxX3NldHVw
KGNwdSwgaXJxLCBldnRjaG4sIHZpcnEpOwpAQCAtMTAxOSw3ICsxMDIwLDcgQEAgc3RhdGljIHZv
aWQgdW5iaW5kX2Zyb21faXJxKHVuc2lnbmVkIGludCBpcnEpCiAJbXV0ZXhfdW5sb2NrKCZpcnFf
bWFwcGluZ191cGRhdGVfbG9jayk7CiB9CiAKLWludCBiaW5kX2V2dGNobl90b19pcnFoYW5kbGVy
KHVuc2lnbmVkIGludCBldnRjaG4sCitpbnQgYmluZF9ldnRjaG5fdG9faXJxaGFuZGxlcihldnRj
aG5fcG9ydF90IGV2dGNobiwKIAkJCSAgICAgIGlycV9oYW5kbGVyX3QgaGFuZGxlciwKIAkJCSAg
ICAgIHVuc2lnbmVkIGxvbmcgaXJxZmxhZ3MsCiAJCQkgICAgICBjb25zdCBjaGFyICpkZXZuYW1l
LCB2b2lkICpkZXZfaWQpCkBAIC0xMDQwLDcgKzEwNDEsNyBAQCBpbnQgYmluZF9ldnRjaG5fdG9f
aXJxaGFuZGxlcih1bnNpZ25lZCBpbnQgZXZ0Y2huLAogRVhQT1JUX1NZTUJPTF9HUEwoYmluZF9l
dnRjaG5fdG9faXJxaGFuZGxlcik7CiAKIGludCBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19p
cnFoYW5kbGVyKHVuc2lnbmVkIGludCByZW1vdGVfZG9tYWluLAotCQkJCQkgIHVuc2lnbmVkIGlu
dCByZW1vdGVfcG9ydCwKKwkJCQkJICBldnRjaG5fcG9ydF90IHJlbW90ZV9wb3J0LAogCQkJCQkg
IGlycV9oYW5kbGVyX3QgaGFuZGxlciwKIAkJCQkJICB1bnNpZ25lZCBsb25nIGlycWZsYWdzLAog
CQkJCQkgIGNvbnN0IGNoYXIgKmRldm5hbWUsCkBAIC0xMTMyLDcgKzExMzMsNyBAQCBpbnQgeGVu
X3NldF9pcnFfcHJpb3JpdHkodW5zaWduZWQgaXJxLCB1bnNpZ25lZCBwcmlvcml0eSkKIH0KIEVY
UE9SVF9TWU1CT0xfR1BMKHhlbl9zZXRfaXJxX3ByaW9yaXR5KTsKIAotaW50IGV2dGNobl9tYWtl
X3JlZmNvdW50ZWQodW5zaWduZWQgaW50IGV2dGNobikKK2ludCBldnRjaG5fbWFrZV9yZWZjb3Vu
dGVkKGV2dGNobl9wb3J0X3QgZXZ0Y2huKQogewogCWludCBpcnEgPSBnZXRfZXZ0Y2huX3RvX2ly
cShldnRjaG4pOwogCXN0cnVjdCBpcnFfaW5mbyAqaW5mbzsKQEAgLTExNTMsNyArMTE1NCw3IEBA
IGludCBldnRjaG5fbWFrZV9yZWZjb3VudGVkKHVuc2lnbmVkIGludCBldnRjaG4pCiB9CiBFWFBP
UlRfU1lNQk9MX0dQTChldnRjaG5fbWFrZV9yZWZjb3VudGVkKTsKIAotaW50IGV2dGNobl9nZXQo
dW5zaWduZWQgaW50IGV2dGNobikKK2ludCBldnRjaG5fZ2V0KGV2dGNobl9wb3J0X3QgZXZ0Y2hu
KQogewogCWludCBpcnE7CiAJc3RydWN0IGlycV9pbmZvICppbmZvOwpAQCAtMTE4Niw3ICsxMTg3
LDcgQEAgaW50IGV2dGNobl9nZXQodW5zaWduZWQgaW50IGV2dGNobikKIH0KIEVYUE9SVF9TWU1C
T0xfR1BMKGV2dGNobl9nZXQpOwogCi12b2lkIGV2dGNobl9wdXQodW5zaWduZWQgaW50IGV2dGNo
bikKK3ZvaWQgZXZ0Y2huX3B1dChldnRjaG5fcG9ydF90IGV2dGNobikKIHsKIAlpbnQgaXJxID0g
Z2V0X2V2dGNobl90b19pcnEoZXZ0Y2huKTsKIAlpZiAoV0FSTl9PTihpcnEgPT0gLTEpKQpAQCAt
MTI1Miw3ICsxMjUzLDcgQEAgdm9pZCB4ZW5faHZtX2V2dGNobl9kb191cGNhbGwodm9pZCkKIEVY
UE9SVF9TWU1CT0xfR1BMKHhlbl9odm1fZXZ0Y2huX2RvX3VwY2FsbCk7CiAKIC8qIFJlYmluZCBh
IG5ldyBldmVudCBjaGFubmVsIHRvIGFuIGV4aXN0aW5nIGlycS4gKi8KLXZvaWQgcmViaW5kX2V2
dGNobl9pcnEoaW50IGV2dGNobiwgaW50IGlycSkKK3ZvaWQgcmViaW5kX2V2dGNobl9pcnEoZXZ0
Y2huX3BvcnRfdCBldnRjaG4sIGludCBpcnEpCiB7CiAJc3RydWN0IGlycV9pbmZvICppbmZvID0g
aW5mb19mb3JfaXJxKGlycSk7CiAKQEAgLTEyNzUsNyArMTI3Niw3IEBAIHZvaWQgcmViaW5kX2V2
dGNobl9pcnEoaW50IGV2dGNobiwgaW50IGlycSkKIAogCW11dGV4X3VubG9jaygmaXJxX21hcHBp
bmdfdXBkYXRlX2xvY2spOwogCi0gICAgICAgIGJpbmRfZXZ0Y2huX3RvX2NwdShldnRjaG4sIGlu
Zm8tPmNwdSk7CisJYmluZF9ldnRjaG5fdG9fY3B1KGV2dGNobiwgaW5mby0+Y3B1KTsKIAkvKiBU
aGlzIHdpbGwgYmUgZGVmZXJyZWQgdW50aWwgaW50ZXJydXB0IGlzIHByb2Nlc3NlZCAqLwogCWly
cV9zZXRfYWZmaW5pdHkoaXJxLCBjcHVtYXNrX29mKGluZm8tPmNwdSkpOwogCkBAIC0xMjg0LDcg
KzEyODUsNyBAQCB2b2lkIHJlYmluZF9ldnRjaG5faXJxKGludCBldnRjaG4sIGludCBpcnEpCiB9
CiAKIC8qIFJlYmluZCBhbiBldnRjaG4gc28gdGhhdCBpdCBnZXRzIGRlbGl2ZXJlZCB0byBhIHNw
ZWNpZmljIGNwdSAqLwotc3RhdGljIGludCB4ZW5fcmViaW5kX2V2dGNobl90b19jcHUoaW50IGV2
dGNobiwgdW5zaWduZWQgaW50IHRjcHUpCitzdGF0aWMgaW50IHhlbl9yZWJpbmRfZXZ0Y2huX3Rv
X2NwdShldnRjaG5fcG9ydF90IGV2dGNobiwgdW5zaWduZWQgaW50IHRjcHUpCiB7CiAJc3RydWN0
IGV2dGNobl9iaW5kX3ZjcHUgYmluZF92Y3B1OwogCWludCBtYXNrZWQ7CkBAIC0xMzQyLDcgKzEz
NDMsNyBAQCBFWFBPUlRfU1lNQk9MX0dQTCh4ZW5fc2V0X2FmZmluaXR5X2V2dGNobik7CiAKIHN0
YXRpYyB2b2lkIGVuYWJsZV9keW5pcnEoc3RydWN0IGlycV9kYXRhICpkYXRhKQogewotCWludCBl
dnRjaG4gPSBldnRjaG5fZnJvbV9pcnEoZGF0YS0+aXJxKTsKKwlldnRjaG5fcG9ydF90IGV2dGNo
biA9IGV2dGNobl9mcm9tX2lycShkYXRhLT5pcnEpOwogCiAJaWYgKFZBTElEX0VWVENITihldnRj
aG4pKQogCQl1bm1hc2tfZXZ0Y2huKGV2dGNobik7CkBAIC0xMzUwLDcgKzEzNTEsNyBAQCBzdGF0
aWMgdm9pZCBlbmFibGVfZHluaXJxKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSkKIAogc3RhdGljIHZv
aWQgZGlzYWJsZV9keW5pcnEoc3RydWN0IGlycV9kYXRhICpkYXRhKQogewotCWludCBldnRjaG4g
PSBldnRjaG5fZnJvbV9pcnEoZGF0YS0+aXJxKTsKKwlldnRjaG5fcG9ydF90IGV2dGNobiA9IGV2
dGNobl9mcm9tX2lycShkYXRhLT5pcnEpOwogCiAJaWYgKFZBTElEX0VWVENITihldnRjaG4pKQog
CQltYXNrX2V2dGNobihldnRjaG4pOwpAQCAtMTM1OCw3ICsxMzU5LDcgQEAgc3RhdGljIHZvaWQg
ZGlzYWJsZV9keW5pcnEoc3RydWN0IGlycV9kYXRhICpkYXRhKQogCiBzdGF0aWMgdm9pZCBhY2tf
ZHluaXJxKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSkKIHsKLQlpbnQgZXZ0Y2huID0gZXZ0Y2huX2Zy
b21faXJxKGRhdGEtPmlycSk7CisJZXZ0Y2huX3BvcnRfdCBldnRjaG4gPSBldnRjaG5fZnJvbV9p
cnEoZGF0YS0+aXJxKTsKIAogCWlmICghVkFMSURfRVZUQ0hOKGV2dGNobikpCiAJCXJldHVybjsK
QEAgLTEzODUsNyArMTM4Niw3IEBAIHN0YXRpYyB2b2lkIG1hc2tfYWNrX2R5bmlycShzdHJ1Y3Qg
aXJxX2RhdGEgKmRhdGEpCiAKIHN0YXRpYyBpbnQgcmV0cmlnZ2VyX2R5bmlycShzdHJ1Y3QgaXJx
X2RhdGEgKmRhdGEpCiB7Ci0JdW5zaWduZWQgaW50IGV2dGNobiA9IGV2dGNobl9mcm9tX2lycShk
YXRhLT5pcnEpOworCWV2dGNobl9wb3J0X3QgZXZ0Y2huID0gZXZ0Y2huX2Zyb21faXJxKGRhdGEt
PmlycSk7CiAJaW50IG1hc2tlZDsKIAogCWlmICghVkFMSURfRVZUQ0hOKGV2dGNobikpCkBAIC0x
NDQwLDcgKzE0NDEsOCBAQCBzdGF0aWMgdm9pZCByZXN0b3JlX3BpcnFzKHZvaWQpCiBzdGF0aWMg
dm9pZCByZXN0b3JlX2NwdV92aXJxcyh1bnNpZ25lZCBpbnQgY3B1KQogewogCXN0cnVjdCBldnRj
aG5fYmluZF92aXJxIGJpbmRfdmlycTsKLQlpbnQgdmlycSwgaXJxLCBldnRjaG47CisJZXZ0Y2hu
X3BvcnRfdCBldnRjaG47CisJaW50IHZpcnEsIGlycTsKIAogCWZvciAodmlycSA9IDA7IHZpcnEg
PCBOUl9WSVJRUzsgdmlycSsrKSB7CiAJCWlmICgoaXJxID0gcGVyX2NwdSh2aXJxX3RvX2lycSwg
Y3B1KVt2aXJxXSkgPT0gLTEpCkBAIC0xNDY1LDcgKzE0NjcsOCBAQCBzdGF0aWMgdm9pZCByZXN0
b3JlX2NwdV92aXJxcyh1bnNpZ25lZCBpbnQgY3B1KQogc3RhdGljIHZvaWQgcmVzdG9yZV9jcHVf
aXBpcyh1bnNpZ25lZCBpbnQgY3B1KQogewogCXN0cnVjdCBldnRjaG5fYmluZF9pcGkgYmluZF9p
cGk7Ci0JaW50IGlwaSwgaXJxLCBldnRjaG47CisJZXZ0Y2huX3BvcnRfdCBldnRjaG47CisJaW50
IGlwaSwgaXJxOwogCiAJZm9yIChpcGkgPSAwOyBpcGkgPCBYRU5fTlJfSVBJUzsgaXBpKyspIHsK
IAkJaWYgKChpcnEgPSBwZXJfY3B1KGlwaV90b19pcnEsIGNwdSlbaXBpXSkgPT0gLTEpCkBAIC0x
NDg5LDcgKzE0OTIsNyBAQCBzdGF0aWMgdm9pZCByZXN0b3JlX2NwdV9pcGlzKHVuc2lnbmVkIGlu
dCBjcHUpCiAvKiBDbGVhciBhbiBpcnEncyBwZW5kaW5nIHN0YXRlLCBpbiBwcmVwYXJhdGlvbiBm
b3IgcG9sbGluZyBvbiBpdCAqLwogdm9pZCB4ZW5fY2xlYXJfaXJxX3BlbmRpbmcoaW50IGlycSkK
IHsKLQlpbnQgZXZ0Y2huID0gZXZ0Y2huX2Zyb21faXJxKGlycSk7CisJZXZ0Y2huX3BvcnRfdCBl
dnRjaG4gPSBldnRjaG5fZnJvbV9pcnEoaXJxKTsKIAogCWlmIChWQUxJRF9FVlRDSE4oZXZ0Y2hu
KSkKIAkJY2xlYXJfZXZ0Y2huKGV2dGNobik7CkBAIC0xNDk3LDcgKzE1MDAsNyBAQCB2b2lkIHhl
bl9jbGVhcl9pcnFfcGVuZGluZyhpbnQgaXJxKQogRVhQT1JUX1NZTUJPTCh4ZW5fY2xlYXJfaXJx
X3BlbmRpbmcpOwogdm9pZCB4ZW5fc2V0X2lycV9wZW5kaW5nKGludCBpcnEpCiB7Ci0JaW50IGV2
dGNobiA9IGV2dGNobl9mcm9tX2lycShpcnEpOworCWV2dGNobl9wb3J0X3QgZXZ0Y2huID0gZXZ0
Y2huX2Zyb21faXJxKGlycSk7CiAKIAlpZiAoVkFMSURfRVZUQ0hOKGV2dGNobikpCiAJCXNldF9l
dnRjaG4oZXZ0Y2huKTsKQEAgLTE1MDUsNyArMTUwOCw3IEBAIHZvaWQgeGVuX3NldF9pcnFfcGVu
ZGluZyhpbnQgaXJxKQogCiBib29sIHhlbl90ZXN0X2lycV9wZW5kaW5nKGludCBpcnEpCiB7Ci0J
aW50IGV2dGNobiA9IGV2dGNobl9mcm9tX2lycShpcnEpOworCWV2dGNobl9wb3J0X3QgZXZ0Y2hu
ID0gZXZ0Y2huX2Zyb21faXJxKGlycSk7CiAJYm9vbCByZXQgPSBmYWxzZTsKIAogCWlmIChWQUxJ
RF9FVlRDSE4oZXZ0Y2huKSkKQEAgLTE2NjcsNyArMTY3MCw3IEBAIG1vZHVsZV9wYXJhbShmaWZv
X2V2ZW50cywgYm9vbCwgMCk7CiB2b2lkIF9faW5pdCB4ZW5faW5pdF9JUlEodm9pZCkKIHsKIAlp
bnQgcmV0ID0gLUVJTlZBTDsKLQl1bnNpZ25lZCBpbnQgZXZ0Y2huOworCWV2dGNobl9wb3J0X3Qg
ZXZ0Y2huOwogCiAJaWYgKGZpZm9fZXZlbnRzKQogCQlyZXQgPSB4ZW5fZXZ0Y2huX2ZpZm9faW5p
dCgpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMgYi9kcml2
ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ZpZm8uYwppbmRleCA3NmIzMThlODgzODIuLmM2MGVlMDQ1
MDE3MyAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMKKysrIGIv
ZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMKQEAgLTgyLDcgKzgyLDcgQEAgc3RhdGlj
IHVuc2lnbmVkIGV2ZW50X2FycmF5X3BhZ2VzIF9fcmVhZF9tb3N0bHk7CiAKICNlbmRpZgogCi1z
dGF0aWMgaW5saW5lIGV2ZW50X3dvcmRfdCAqZXZlbnRfd29yZF9mcm9tX3BvcnQodW5zaWduZWQg
cG9ydCkKK3N0YXRpYyBpbmxpbmUgZXZlbnRfd29yZF90ICpldmVudF93b3JkX2Zyb21fcG9ydChl
dnRjaG5fcG9ydF90IHBvcnQpCiB7CiAJdW5zaWduZWQgaSA9IHBvcnQgLyBFVkVOVF9XT1JEU19Q
RVJfUEFHRTsKIApAQCAtMTQwLDcgKzE0MCw3IEBAIHN0YXRpYyB2b2lkIGluaXRfYXJyYXlfcGFn
ZShldmVudF93b3JkX3QgKmFycmF5X3BhZ2UpCiAKIHN0YXRpYyBpbnQgZXZ0Y2huX2ZpZm9fc2V0
dXAoc3RydWN0IGlycV9pbmZvICppbmZvKQogewotCXVuc2lnbmVkIHBvcnQgPSBpbmZvLT5ldnRj
aG47CisJZXZ0Y2huX3BvcnRfdCBwb3J0ID0gaW5mby0+ZXZ0Y2huOwogCXVuc2lnbmVkIG5ld19h
cnJheV9wYWdlczsKIAlpbnQgcmV0OwogCkBAIC0xOTEsMzcgKzE5MSwzNyBAQCBzdGF0aWMgdm9p
ZCBldnRjaG5fZmlmb19iaW5kX3RvX2NwdShzdHJ1Y3QgaXJxX2luZm8gKmluZm8sIHVuc2lnbmVk
IGNwdSkKIAkvKiBuby1vcCAqLwogfQogCi1zdGF0aWMgdm9pZCBldnRjaG5fZmlmb19jbGVhcl9w
ZW5kaW5nKHVuc2lnbmVkIHBvcnQpCitzdGF0aWMgdm9pZCBldnRjaG5fZmlmb19jbGVhcl9wZW5k
aW5nKGV2dGNobl9wb3J0X3QgcG9ydCkKIHsKIAlldmVudF93b3JkX3QgKndvcmQgPSBldmVudF93
b3JkX2Zyb21fcG9ydChwb3J0KTsKIAlzeW5jX2NsZWFyX2JpdChFVlRDSE5fRklGT19CSVQoUEVO
RElORywgd29yZCksIEJNKHdvcmQpKTsKIH0KIAotc3RhdGljIHZvaWQgZXZ0Y2huX2ZpZm9fc2V0
X3BlbmRpbmcodW5zaWduZWQgcG9ydCkKK3N0YXRpYyB2b2lkIGV2dGNobl9maWZvX3NldF9wZW5k
aW5nKGV2dGNobl9wb3J0X3QgcG9ydCkKIHsKIAlldmVudF93b3JkX3QgKndvcmQgPSBldmVudF93
b3JkX2Zyb21fcG9ydChwb3J0KTsKIAlzeW5jX3NldF9iaXQoRVZUQ0hOX0ZJRk9fQklUKFBFTkRJ
TkcsIHdvcmQpLCBCTSh3b3JkKSk7CiB9CiAKLXN0YXRpYyBib29sIGV2dGNobl9maWZvX2lzX3Bl
bmRpbmcodW5zaWduZWQgcG9ydCkKK3N0YXRpYyBib29sIGV2dGNobl9maWZvX2lzX3BlbmRpbmco
ZXZ0Y2huX3BvcnRfdCBwb3J0KQogewogCWV2ZW50X3dvcmRfdCAqd29yZCA9IGV2ZW50X3dvcmRf
ZnJvbV9wb3J0KHBvcnQpOwogCXJldHVybiBzeW5jX3Rlc3RfYml0KEVWVENITl9GSUZPX0JJVChQ
RU5ESU5HLCB3b3JkKSwgQk0od29yZCkpOwogfQogCi1zdGF0aWMgYm9vbCBldnRjaG5fZmlmb190
ZXN0X2FuZF9zZXRfbWFzayh1bnNpZ25lZCBwb3J0KQorc3RhdGljIGJvb2wgZXZ0Y2huX2ZpZm9f
dGVzdF9hbmRfc2V0X21hc2soZXZ0Y2huX3BvcnRfdCBwb3J0KQogewogCWV2ZW50X3dvcmRfdCAq
d29yZCA9IGV2ZW50X3dvcmRfZnJvbV9wb3J0KHBvcnQpOwogCXJldHVybiBzeW5jX3Rlc3RfYW5k
X3NldF9iaXQoRVZUQ0hOX0ZJRk9fQklUKE1BU0tFRCwgd29yZCksIEJNKHdvcmQpKTsKIH0KIAot
c3RhdGljIHZvaWQgZXZ0Y2huX2ZpZm9fbWFzayh1bnNpZ25lZCBwb3J0KQorc3RhdGljIHZvaWQg
ZXZ0Y2huX2ZpZm9fbWFzayhldnRjaG5fcG9ydF90IHBvcnQpCiB7CiAJZXZlbnRfd29yZF90ICp3
b3JkID0gZXZlbnRfd29yZF9mcm9tX3BvcnQocG9ydCk7CiAJc3luY19zZXRfYml0KEVWVENITl9G
SUZPX0JJVChNQVNLRUQsIHdvcmQpLCBCTSh3b3JkKSk7CiB9CiAKLXN0YXRpYyBib29sIGV2dGNo
bl9maWZvX2lzX21hc2tlZCh1bnNpZ25lZCBwb3J0KQorc3RhdGljIGJvb2wgZXZ0Y2huX2ZpZm9f
aXNfbWFza2VkKGV2dGNobl9wb3J0X3QgcG9ydCkKIHsKIAlldmVudF93b3JkX3QgKndvcmQgPSBl
dmVudF93b3JkX2Zyb21fcG9ydChwb3J0KTsKIAlyZXR1cm4gc3luY190ZXN0X2JpdChFVlRDSE5f
RklGT19CSVQoTUFTS0VELCB3b3JkKSwgQk0od29yZCkpOwpAQCAtMjQyLDcgKzI0Miw3IEBAIHN0
YXRpYyB2b2lkIGNsZWFyX21hc2tlZCh2b2xhdGlsZSBldmVudF93b3JkX3QgKndvcmQpCiAJfSB3
aGlsZSAodyAhPSBvbGQpOwogfQogCi1zdGF0aWMgdm9pZCBldnRjaG5fZmlmb191bm1hc2sodW5z
aWduZWQgcG9ydCkKK3N0YXRpYyB2b2lkIGV2dGNobl9maWZvX3VubWFzayhldnRjaG5fcG9ydF90
IHBvcnQpCiB7CiAJZXZlbnRfd29yZF90ICp3b3JkID0gZXZlbnRfd29yZF9mcm9tX3BvcnQocG9y
dCk7CiAKQEAgLTI3MCw3ICsyNzAsNyBAQCBzdGF0aWMgdWludDMyX3QgY2xlYXJfbGlua2VkKHZv
bGF0aWxlIGV2ZW50X3dvcmRfdCAqd29yZCkKIAlyZXR1cm4gdyAmIEVWVENITl9GSUZPX0xJTktf
TUFTSzsKIH0KIAotc3RhdGljIHZvaWQgaGFuZGxlX2lycV9mb3JfcG9ydCh1bnNpZ25lZCBwb3J0
KQorc3RhdGljIHZvaWQgaGFuZGxlX2lycV9mb3JfcG9ydChldnRjaG5fcG9ydF90IHBvcnQpCiB7
CiAJaW50IGlycTsKIApAQCAtMjg2LDcgKzI4Niw3IEBAIHN0YXRpYyB2b2lkIGNvbnN1bWVfb25l
X2V2ZW50KHVuc2lnbmVkIGNwdSwKIHsKIAlzdHJ1Y3QgZXZ0Y2huX2ZpZm9fcXVldWUgKnEgPSAm
cGVyX2NwdShjcHVfcXVldWUsIGNwdSk7CiAJdWludDMyX3QgaGVhZDsKLQl1bnNpZ25lZCBwb3J0
OworCWV2dGNobl9wb3J0X3QgcG9ydDsKIAlldmVudF93b3JkX3QgKndvcmQ7CiAKIAloZWFkID0g
cS0+aGVhZFtwcmlvcml0eV07CmRpZmYgLS1naXQgYS9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRz
X2ludGVybmFsLmggYi9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ludGVybmFsLmgKaW5kZXgg
ODI5MzhjZmY2YzdhLi4xMDY4NGZlYjA5NGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMveGVuL2V2ZW50
cy9ldmVudHNfaW50ZXJuYWwuaAorKysgYi9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ludGVy
bmFsLmgKQEAgLTMzLDcgKzMzLDcgQEAgc3RydWN0IGlycV9pbmZvIHsKIAlpbnQgcmVmY250Owog
CWVudW0geGVuX2lycV90eXBlIHR5cGU7CS8qIHR5cGUgKi8KIAl1bnNpZ25lZCBpcnE7Ci0JdW5z
aWduZWQgaW50IGV2dGNobjsJLyogZXZlbnQgY2hhbm5lbCAqLworCWV2dGNobl9wb3J0X3QgZXZ0
Y2huOwkvKiBldmVudCBjaGFubmVsICovCiAJdW5zaWduZWQgc2hvcnQgY3B1OwkvKiBjcHUgYm91
bmQgKi8KIAogCXVuaW9uIHsKQEAgLTYwLDEyICs2MCwxMiBAQCBzdHJ1Y3QgZXZ0Y2huX29wcyB7
CiAJaW50ICgqc2V0dXApKHN0cnVjdCBpcnFfaW5mbyAqaW5mbyk7CiAJdm9pZCAoKmJpbmRfdG9f
Y3B1KShzdHJ1Y3QgaXJxX2luZm8gKmluZm8sIHVuc2lnbmVkIGNwdSk7CiAKLQl2b2lkICgqY2xl
YXJfcGVuZGluZykodW5zaWduZWQgcG9ydCk7Ci0Jdm9pZCAoKnNldF9wZW5kaW5nKSh1bnNpZ25l
ZCBwb3J0KTsKLQlib29sICgqaXNfcGVuZGluZykodW5zaWduZWQgcG9ydCk7Ci0JYm9vbCAoKnRl
c3RfYW5kX3NldF9tYXNrKSh1bnNpZ25lZCBwb3J0KTsKLQl2b2lkICgqbWFzaykodW5zaWduZWQg
cG9ydCk7Ci0Jdm9pZCAoKnVubWFzaykodW5zaWduZWQgcG9ydCk7CisJdm9pZCAoKmNsZWFyX3Bl
bmRpbmcpKGV2dGNobl9wb3J0X3QgcG9ydCk7CisJdm9pZCAoKnNldF9wZW5kaW5nKShldnRjaG5f
cG9ydF90IHBvcnQpOworCWJvb2wgKCppc19wZW5kaW5nKShldnRjaG5fcG9ydF90IHBvcnQpOwor
CWJvb2wgKCp0ZXN0X2FuZF9zZXRfbWFzaykoZXZ0Y2huX3BvcnRfdCBwb3J0KTsKKwl2b2lkICgq
bWFzaykoZXZ0Y2huX3BvcnRfdCBwb3J0KTsKKwl2b2lkICgqdW5tYXNrKShldnRjaG5fcG9ydF90
IHBvcnQpOwogCiAJdm9pZCAoKmhhbmRsZV9ldmVudHMpKHVuc2lnbmVkIGNwdSk7CiAJdm9pZCAo
KnJlc3VtZSkodm9pZCk7CkBAIC03NCwxMSArNzQsMTEgQEAgc3RydWN0IGV2dGNobl9vcHMgewog
ZXh0ZXJuIGNvbnN0IHN0cnVjdCBldnRjaG5fb3BzICpldnRjaG5fb3BzOwogCiBleHRlcm4gaW50
ICoqZXZ0Y2huX3RvX2lycTsKLWludCBnZXRfZXZ0Y2huX3RvX2lycSh1bnNpZ25lZCBpbnQgZXZ0
Y2huKTsKK2ludCBnZXRfZXZ0Y2huX3RvX2lycShldnRjaG5fcG9ydF90IGV2dGNobik7CiAKIHN0
cnVjdCBpcnFfaW5mbyAqaW5mb19mb3JfaXJxKHVuc2lnbmVkIGlycSk7CiB1bnNpZ25lZCBjcHVf
ZnJvbV9pcnEodW5zaWduZWQgaXJxKTsKLXVuc2lnbmVkIGNwdV9mcm9tX2V2dGNobih1bnNpZ25l
ZCBpbnQgZXZ0Y2huKTsKK3Vuc2lnbmVkIGludCBjcHVfZnJvbV9ldnRjaG4oZXZ0Y2huX3BvcnRf
dCBldnRjaG4pOwogCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIHhlbl9ldnRjaG5fbWF4X2NoYW5u
ZWxzKHZvaWQpCiB7CkBAIC0xMDIsMzIgKzEwMiwzMiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgeGVu
X2V2dGNobl9wb3J0X2JpbmRfdG9fY3B1KHN0cnVjdCBpcnFfaW5mbyAqaW5mbywKIAlldnRjaG5f
b3BzLT5iaW5kX3RvX2NwdShpbmZvLCBjcHUpOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgY2xl
YXJfZXZ0Y2huKHVuc2lnbmVkIHBvcnQpCitzdGF0aWMgaW5saW5lIHZvaWQgY2xlYXJfZXZ0Y2hu
KGV2dGNobl9wb3J0X3QgcG9ydCkKIHsKIAlldnRjaG5fb3BzLT5jbGVhcl9wZW5kaW5nKHBvcnQp
OwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgc2V0X2V2dGNobih1bnNpZ25lZCBwb3J0KQorc3Rh
dGljIGlubGluZSB2b2lkIHNldF9ldnRjaG4oZXZ0Y2huX3BvcnRfdCBwb3J0KQogewogCWV2dGNo
bl9vcHMtPnNldF9wZW5kaW5nKHBvcnQpOwogfQogCi1zdGF0aWMgaW5saW5lIGJvb2wgdGVzdF9l
dnRjaG4odW5zaWduZWQgcG9ydCkKK3N0YXRpYyBpbmxpbmUgYm9vbCB0ZXN0X2V2dGNobihldnRj
aG5fcG9ydF90IHBvcnQpCiB7CiAJcmV0dXJuIGV2dGNobl9vcHMtPmlzX3BlbmRpbmcocG9ydCk7
CiB9CiAKLXN0YXRpYyBpbmxpbmUgYm9vbCB0ZXN0X2FuZF9zZXRfbWFzayh1bnNpZ25lZCBwb3J0
KQorc3RhdGljIGlubGluZSBib29sIHRlc3RfYW5kX3NldF9tYXNrKGV2dGNobl9wb3J0X3QgcG9y
dCkKIHsKIAlyZXR1cm4gZXZ0Y2huX29wcy0+dGVzdF9hbmRfc2V0X21hc2socG9ydCk7CiB9CiAK
LXN0YXRpYyBpbmxpbmUgdm9pZCBtYXNrX2V2dGNobih1bnNpZ25lZCBwb3J0KQorc3RhdGljIGlu
bGluZSB2b2lkIG1hc2tfZXZ0Y2huKGV2dGNobl9wb3J0X3QgcG9ydCkKIHsKIAlyZXR1cm4gZXZ0
Y2huX29wcy0+bWFzayhwb3J0KTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHVubWFza19ldnRj
aG4odW5zaWduZWQgcG9ydCkKK3N0YXRpYyBpbmxpbmUgdm9pZCB1bm1hc2tfZXZ0Y2huKGV2dGNo
bl9wb3J0X3QgcG9ydCkKIHsKIAlyZXR1cm4gZXZ0Y2huX29wcy0+dW5tYXNrKHBvcnQpOwogfQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vZXZ0Y2huLmMgYi9kcml2ZXJzL3hlbi9ldnRjaG4uYwpp
bmRleCAwNTJiNTVhMTRlYmMuLjZlMGIxZGQ1NTczYyAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4v
ZXZ0Y2huLmMKKysrIGIvZHJpdmVycy94ZW4vZXZ0Y2huLmMKQEAgLTgzLDcgKzgzLDcgQEAgc3Ry
dWN0IHBlcl91c2VyX2RhdGEgewogc3RydWN0IHVzZXJfZXZ0Y2huIHsKIAlzdHJ1Y3QgcmJfbm9k
ZSBub2RlOwogCXN0cnVjdCBwZXJfdXNlcl9kYXRhICp1c2VyOwotCXVuc2lnbmVkIHBvcnQ7CisJ
ZXZ0Y2huX3BvcnRfdCBwb3J0OwogCWJvb2wgZW5hYmxlZDsKIH07CiAKQEAgLTEzOCw3ICsxMzgs
OCBAQCBzdGF0aWMgdm9pZCBkZWxfZXZ0Y2huKHN0cnVjdCBwZXJfdXNlcl9kYXRhICp1LCBzdHJ1
Y3QgdXNlcl9ldnRjaG4gKmV2dGNobikKIAlrZnJlZShldnRjaG4pOwogfQogCi1zdGF0aWMgc3Ry
dWN0IHVzZXJfZXZ0Y2huICpmaW5kX2V2dGNobihzdHJ1Y3QgcGVyX3VzZXJfZGF0YSAqdSwgdW5z
aWduZWQgcG9ydCkKK3N0YXRpYyBzdHJ1Y3QgdXNlcl9ldnRjaG4gKmZpbmRfZXZ0Y2huKHN0cnVj
dCBwZXJfdXNlcl9kYXRhICp1LAorCQkJCSAgICAgICBldnRjaG5fcG9ydF90IHBvcnQpCiB7CiAJ
c3RydWN0IHJiX25vZGUgKm5vZGUgPSB1LT5ldnRjaG5zLnJiX25vZGU7CiAKQEAgLTE2Myw3ICsx
NjQsNyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgZXZ0Y2huX2ludGVycnVwdChpbnQgaXJxLCB2b2lk
ICpkYXRhKQogCXN0cnVjdCBwZXJfdXNlcl9kYXRhICp1ID0gZXZ0Y2huLT51c2VyOwogCiAJV0FS
TighZXZ0Y2huLT5lbmFibGVkLAotCSAgICAgIkludGVycnVwdCBmb3IgcG9ydCAlZCwgYnV0IGFw
cGFyZW50bHkgbm90IGVuYWJsZWQ7IHBlci11c2VyICVwXG4iLAorCSAgICAgIkludGVycnVwdCBm
b3IgcG9ydCAldSwgYnV0IGFwcGFyZW50bHkgbm90IGVuYWJsZWQ7IHBlci11c2VyICVwXG4iLAog
CSAgICAgZXZ0Y2huLT5wb3J0LCB1KTsKIAogCWRpc2FibGVfaXJxX25vc3luYyhpcnEpOwpAQCAt
Mjg2LDcgKzI4Nyw3IEBAIHN0YXRpYyBzc2l6ZV90IGV2dGNobl93cml0ZShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgY29uc3QgY2hhciBfX3VzZXIgKmJ1ZiwKIAltdXRleF9sb2NrKCZ1LT5iaW5kX211dGV4
KTsKIAogCWZvciAoaSA9IDA7IGkgPCAoY291bnQvc2l6ZW9mKGV2dGNobl9wb3J0X3QpKTsgaSsr
KSB7Ci0JCXVuc2lnbmVkIHBvcnQgPSBrYnVmW2ldOworCQlldnRjaG5fcG9ydF90IHBvcnQgPSBr
YnVmW2ldOwogCQlzdHJ1Y3QgdXNlcl9ldnRjaG4gKmV2dGNobjsKIAogCQlldnRjaG4gPSBmaW5k
X2V2dGNobih1LCBwb3J0KTsKQEAgLTM2MSw3ICszNjIsNyBAQCBzdGF0aWMgaW50IGV2dGNobl9y
ZXNpemVfcmluZyhzdHJ1Y3QgcGVyX3VzZXJfZGF0YSAqdSkKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBldnRjaG5fYmluZF90b191c2VyKHN0cnVjdCBwZXJfdXNlcl9kYXRhICp1LCBpbnQg
cG9ydCkKK3N0YXRpYyBpbnQgZXZ0Y2huX2JpbmRfdG9fdXNlcihzdHJ1Y3QgcGVyX3VzZXJfZGF0
YSAqdSwgZXZ0Y2huX3BvcnRfdCBwb3J0KQogewogCXN0cnVjdCB1c2VyX2V2dGNobiAqZXZ0Y2hu
OwogCXN0cnVjdCBldnRjaG5fY2xvc2UgY2xvc2U7CkBAIC00MjMsNyArNDI0LDcgQEAgc3RhdGlj
IHZvaWQgZXZ0Y2huX3VuYmluZF9mcm9tX3VzZXIoc3RydWN0IHBlcl91c2VyX2RhdGEgKnUsCiAK
IHN0YXRpYyBERUZJTkVfUEVSX0NQVShpbnQsIGJpbmRfbGFzdF9zZWxlY3RlZF9jcHUpOwogCi1z
dGF0aWMgdm9pZCBldnRjaG5fYmluZF9pbnRlcmRvbV9uZXh0X3ZjcHUoaW50IGV2dGNobikKK3N0
YXRpYyB2b2lkIGV2dGNobl9iaW5kX2ludGVyZG9tX25leHRfdmNwdShldnRjaG5fcG9ydF90IGV2
dGNobikKIHsKIAl1bnNpZ25lZCBpbnQgc2VsZWN0ZWRfY3B1LCBpcnE7CiAJc3RydWN0IGlycV9k
ZXNjICpkZXNjOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vcHZjYWxscy1iYWNrLmMgYi9kcml2
ZXJzL3hlbi9wdmNhbGxzLWJhY2suYwppbmRleCBjNTdjNzFiN2Q1M2QuLmNmNGNlM2U5MzU4ZCAx
MDA2NDQKLS0tIGEvZHJpdmVycy94ZW4vcHZjYWxscy1iYWNrLmMKKysrIGIvZHJpdmVycy94ZW4v
cHZjYWxscy1iYWNrLmMKQEAgLTMwMCw3ICszMDAsNyBAQCBzdGF0aWMgc3RydWN0IHNvY2tfbWFw
cGluZyAqcHZjYWxsc19uZXdfYWN0aXZlX3NvY2tldCgKIAkJc3RydWN0IHB2Y2FsbHNfZmVkYXRh
ICpmZWRhdGEsCiAJCXVpbnQ2NF90IGlkLAogCQlncmFudF9yZWZfdCByZWYsCi0JCXVpbnQzMl90
IGV2dGNobiwKKwkJZXZ0Y2huX3BvcnRfdCBldnRjaG4sCiAJCXN0cnVjdCBzb2NrZXQgKnNvY2sp
CiB7CiAJaW50IHJldDsKQEAgLTkwNSw3ICs5MDUsOCBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgcHZj
YWxsc19iYWNrX2Nvbm5fZXZlbnQoaW50IGlycSwgdm9pZCAqc29ja19tYXApCiAKIHN0YXRpYyBp
bnQgYmFja2VuZF9jb25uZWN0KHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYpCiB7Ci0JaW50IGVy
ciwgZXZ0Y2huOworCWludCBlcnI7CisJZXZ0Y2huX3BvcnRfdCBldnRjaG47CiAJZ3JhbnRfcmVm
X3QgcmluZ19yZWY7CiAJc3RydWN0IHB2Y2FsbHNfZmVkYXRhICpmZWRhdGEgPSBOVUxMOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay94ZW5idXMuYyBiL2RyaXZlcnMveGVu
L3hlbi1wY2liYWNrL3hlbmJ1cy5jCmluZGV4IDgzM2IyZDJjNDMxOC4uZjIxMTU1ODc4NTVmIDEw
MDY0NAotLS0gYS9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay94ZW5idXMuYworKysgYi9kcml2ZXJz
L3hlbi94ZW4tcGNpYmFjay94ZW5idXMuYwpAQCAtMTA1LDEzICsxMDUsMTMgQEAgc3RhdGljIHZv
aWQgZnJlZV9wZGV2KHN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNlICpwZGV2KQogfQogCiBzdGF0aWMg
aW50IHhlbl9wY2lia19kb19hdHRhY2goc3RydWN0IHhlbl9wY2lia19kZXZpY2UgKnBkZXYsIGlu
dCBnbnRfcmVmLAotCQkJICAgICBpbnQgcmVtb3RlX2V2dGNobikKKwkJCSAgICAgZXZ0Y2huX3Bv
cnRfdCByZW1vdGVfZXZ0Y2huKQogewogCWludCBlcnIgPSAwOwogCXZvaWQgKnZhZGRyOwogCiAJ
ZGV2X2RiZygmcGRldi0+eGRldi0+ZGV2LAotCQkiQXR0YWNoaW5nIHRvIGZyb250ZW5kIHJlc291
cmNlcyAtIGdudF9yZWY9JWQgZXZ0Y2huPSVkXG4iLAorCQkiQXR0YWNoaW5nIHRvIGZyb250ZW5k
IHJlc291cmNlcyAtIGdudF9yZWY9JWQgZXZ0Y2huPSV1XG4iLAogCQlnbnRfcmVmLCByZW1vdGVf
ZXZ0Y2huKTsKIAogCWVyciA9IHhlbmJ1c19tYXBfcmluZ192YWxsb2MocGRldi0+eGRldiwgJmdu
dF9yZWYsIDEsICZ2YWRkcik7CkBAIC0xNDIsNyArMTQyLDggQEAgc3RhdGljIGludCB4ZW5fcGNp
YmtfZG9fYXR0YWNoKHN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNlICpwZGV2LCBpbnQgZ250X3JlZiwK
IHN0YXRpYyBpbnQgeGVuX3BjaWJrX2F0dGFjaChzdHJ1Y3QgeGVuX3BjaWJrX2RldmljZSAqcGRl
dikKIHsKIAlpbnQgZXJyID0gMDsKLQlpbnQgZ250X3JlZiwgcmVtb3RlX2V2dGNobjsKKwlpbnQg
Z250X3JlZjsKKwlldnRjaG5fcG9ydF90IHJlbW90ZV9ldnRjaG47CiAJY2hhciAqbWFnaWMgPSBO
VUxMOwogCiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMveGVuL3hlbi1zY3NpYmFjay5jIGIvZHJpdmVy
cy94ZW4veGVuLXNjc2liYWNrLmMKaW5kZXggYmEwOTQyZTQ4MWJjLi43NWMwYTJlOWE2ZGIgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMveGVuL3hlbi1zY3NpYmFjay5jCisrKyBiL2RyaXZlcnMveGVuL3hl
bi1zY3NpYmFjay5jCkBAIC04NTQsNyArODU0LDggQEAgc3RhdGljIGludCBzY3NpYmFja19pbml0
X3NyaW5nKHN0cnVjdCB2c2NzaWJrX2luZm8gKmluZm8sIGdyYW50X3JlZl90IHJpbmdfcmVmLAog
c3RhdGljIGludCBzY3NpYmFja19tYXAoc3RydWN0IHZzY3NpYmtfaW5mbyAqaW5mbykKIHsKIAlz
dHJ1Y3QgeGVuYnVzX2RldmljZSAqZGV2ID0gaW5mby0+ZGV2OwotCXVuc2lnbmVkIGludCByaW5n
X3JlZiwgZXZ0Y2huOworCXVuc2lnbmVkIGludCByaW5nX3JlZjsKKwlldnRjaG5fcG9ydF90IGV2
dGNobjsKIAlpbnQgZXJyOwogCiAJZXJyID0geGVuYnVzX2dhdGhlcihYQlRfTklMLCBkZXYtPm90
aGVyZW5kLApkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4veGVuYnVzL3hlbmJ1c19jbGllbnQuYyBi
L2RyaXZlcnMveGVuL3hlbmJ1cy94ZW5idXNfY2xpZW50LmMKaW5kZXggZTE3Y2E4MTU2MTcxLi4x
Zjg3NTE0ZTRlZmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMveGVuL3hlbmJ1cy94ZW5idXNfY2xpZW50
LmMKKysrIGIvZHJpdmVycy94ZW4veGVuYnVzL3hlbmJ1c19jbGllbnQuYwpAQCAtMzkxLDcgKzM5
MSw3IEBAIEVYUE9SVF9TWU1CT0xfR1BMKHhlbmJ1c19ncmFudF9yaW5nKTsKICAqIGVycm9yLCB0
aGUgZGV2aWNlIHdpbGwgc3dpdGNoIHRvIFhlbmJ1c1N0YXRlQ2xvc2luZywgYW5kIHRoZSBlcnJv
ciB3aWxsIGJlCiAgKiBzYXZlZCBpbiB0aGUgc3RvcmUuCiAgKi8KLWludCB4ZW5idXNfYWxsb2Nf
ZXZ0Y2huKHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYsIGludCAqcG9ydCkKK2ludCB4ZW5idXNf
YWxsb2NfZXZ0Y2huKHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYsIGV2dGNobl9wb3J0X3QgKnBv
cnQpCiB7CiAJc3RydWN0IGV2dGNobl9hbGxvY191bmJvdW5kIGFsbG9jX3VuYm91bmQ7CiAJaW50
IGVycjsKQEAgLTQxNCw3ICs0MTQsNyBAQCBFWFBPUlRfU1lNQk9MX0dQTCh4ZW5idXNfYWxsb2Nf
ZXZ0Y2huKTsKIC8qKgogICogRnJlZSBhbiBleGlzdGluZyBldmVudCBjaGFubmVsLiBSZXR1cm5z
IDAgb24gc3VjY2VzcyBvciAtZXJybm8gb24gZXJyb3IuCiAgKi8KLWludCB4ZW5idXNfZnJlZV9l
dnRjaG4oc3RydWN0IHhlbmJ1c19kZXZpY2UgKmRldiwgaW50IHBvcnQpCitpbnQgeGVuYnVzX2Zy
ZWVfZXZ0Y2huKHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYsIGV2dGNobl9wb3J0X3QgcG9ydCkK
IHsKIAlzdHJ1Y3QgZXZ0Y2huX2Nsb3NlIGNsb3NlOwogCWludCBlcnI7CkBAIC00MjMsNyArNDIz
LDcgQEAgaW50IHhlbmJ1c19mcmVlX2V2dGNobihzdHJ1Y3QgeGVuYnVzX2RldmljZSAqZGV2LCBp
bnQgcG9ydCkKIAogCWVyciA9IEhZUEVSVklTT1JfZXZlbnRfY2hhbm5lbF9vcChFVlRDSE5PUF9j
bG9zZSwgJmNsb3NlKTsKIAlpZiAoZXJyKQotCQl4ZW5idXNfZGV2X2Vycm9yKGRldiwgZXJyLCAi
ZnJlZWluZyBldmVudCBjaGFubmVsICVkIiwgcG9ydCk7CisJCXhlbmJ1c19kZXZfZXJyb3IoZGV2
LCBlcnIsICJmcmVlaW5nIGV2ZW50IGNoYW5uZWwgJXUiLCBwb3J0KTsKIAogCXJldHVybiBlcnI7
CiB9CmRpZmYgLS1naXQgYS9pbmNsdWRlL3hlbi9ldmVudHMuaCBiL2luY2x1ZGUveGVuL2V2ZW50
cy5oCmluZGV4IGMwZTZhMDU5ODM5Ny4uN2ZlNWE3M2I4YmRhIDEwMDY0NAotLS0gYS9pbmNsdWRl
L3hlbi9ldmVudHMuaAorKysgYi9pbmNsdWRlL3hlbi9ldmVudHMuaApAQCAtMTQsOCArMTQsOCBA
QAogCiB1bnNpZ25lZCB4ZW5fZXZ0Y2huX25yX2NoYW5uZWxzKHZvaWQpOwogCi1pbnQgYmluZF9l
dnRjaG5fdG9faXJxKHVuc2lnbmVkIGludCBldnRjaG4pOwotaW50IGJpbmRfZXZ0Y2huX3RvX2ly
cWhhbmRsZXIodW5zaWduZWQgaW50IGV2dGNobiwKK2ludCBiaW5kX2V2dGNobl90b19pcnEoZXZ0
Y2huX3BvcnRfdCBldnRjaG4pOworaW50IGJpbmRfZXZ0Y2huX3RvX2lycWhhbmRsZXIoZXZ0Y2hu
X3BvcnRfdCBldnRjaG4sCiAJCQkgICAgICBpcnFfaGFuZGxlcl90IGhhbmRsZXIsCiAJCQkgICAg
ICB1bnNpZ25lZCBsb25nIGlycWZsYWdzLCBjb25zdCBjaGFyICpkZXZuYW1lLAogCQkJICAgICAg
dm9pZCAqZGV2X2lkKTsKQEAgLTMxLDkgKzMxLDkgQEAgaW50IGJpbmRfaXBpX3RvX2lycWhhbmRs
ZXIoZW51bSBpcGlfdmVjdG9yIGlwaSwKIAkJCSAgIGNvbnN0IGNoYXIgKmRldm5hbWUsCiAJCQkg
ICB2b2lkICpkZXZfaWQpOwogaW50IGJpbmRfaW50ZXJkb21haW5fZXZ0Y2huX3RvX2lycSh1bnNp
Z25lZCBpbnQgcmVtb3RlX2RvbWFpbiwKLQkJCQkgICB1bnNpZ25lZCBpbnQgcmVtb3RlX3BvcnQp
OworCQkJCSAgIGV2dGNobl9wb3J0X3QgcmVtb3RlX3BvcnQpOwogaW50IGJpbmRfaW50ZXJkb21h
aW5fZXZ0Y2huX3RvX2lycWhhbmRsZXIodW5zaWduZWQgaW50IHJlbW90ZV9kb21haW4sCi0JCQkJ
CSAgdW5zaWduZWQgaW50IHJlbW90ZV9wb3J0LAorCQkJCQkgIGV2dGNobl9wb3J0X3QgcmVtb3Rl
X3BvcnQsCiAJCQkJCSAgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLAogCQkJCQkgIHVuc2lnbmVkIGxv
bmcgaXJxZmxhZ3MsCiAJCQkJCSAgY29uc3QgY2hhciAqZGV2bmFtZSwKQEAgLTU0LDE1ICs1NCwx
NSBAQCBpbnQgeGVuX3NldF9pcnFfcHJpb3JpdHkodW5zaWduZWQgaXJxLCB1bnNpZ25lZCBwcmlv
cml0eSk7CiAvKgogICogQWxsb3cgZXh0cmEgcmVmZXJlbmNlcyB0byBldmVudCBjaGFubmVscyBl
eHBvc2VkIHRvIHVzZXJzcGFjZSBieSBldnRjaG4KICAqLwotaW50IGV2dGNobl9tYWtlX3JlZmNv
dW50ZWQodW5zaWduZWQgaW50IGV2dGNobik7Ci1pbnQgZXZ0Y2huX2dldCh1bnNpZ25lZCBpbnQg
ZXZ0Y2huKTsKLXZvaWQgZXZ0Y2huX3B1dCh1bnNpZ25lZCBpbnQgZXZ0Y2huKTsKK2ludCBldnRj
aG5fbWFrZV9yZWZjb3VudGVkKGV2dGNobl9wb3J0X3QgZXZ0Y2huKTsKK2ludCBldnRjaG5fZ2V0
KGV2dGNobl9wb3J0X3QgZXZ0Y2huKTsKK3ZvaWQgZXZ0Y2huX3B1dChldnRjaG5fcG9ydF90IGV2
dGNobik7CiAKIHZvaWQgeGVuX3NlbmRfSVBJX29uZSh1bnNpZ25lZCBpbnQgY3B1LCBlbnVtIGlw
aV92ZWN0b3IgdmVjdG9yKTsKLXZvaWQgcmViaW5kX2V2dGNobl9pcnEoaW50IGV2dGNobiwgaW50
IGlycSk7Cit2b2lkIHJlYmluZF9ldnRjaG5faXJxKGV2dGNobl9wb3J0X3QgZXZ0Y2huLCBpbnQg
aXJxKTsKIGludCB4ZW5fc2V0X2FmZmluaXR5X2V2dGNobihzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2Ms
IHVuc2lnbmVkIGludCB0Y3B1KTsKIAotc3RhdGljIGlubGluZSB2b2lkIG5vdGlmeV9yZW1vdGVf
dmlhX2V2dGNobihpbnQgcG9ydCkKK3N0YXRpYyBpbmxpbmUgdm9pZCBub3RpZnlfcmVtb3RlX3Zp
YV9ldnRjaG4oZXZ0Y2huX3BvcnRfdCBwb3J0KQogewogCXN0cnVjdCBldnRjaG5fc2VuZCBzZW5k
ID0geyAucG9ydCA9IHBvcnQgfTsKIAkodm9pZClIWVBFUlZJU09SX2V2ZW50X2NoYW5uZWxfb3Ao
RVZUQ0hOT1Bfc2VuZCwgJnNlbmQpOwpAQCAtODYsNyArODYsNyBAQCB2b2lkIHhlbl9wb2xsX2ly
cShpbnQgaXJxKTsKIHZvaWQgeGVuX3BvbGxfaXJxX3RpbWVvdXQoaW50IGlycSwgdTY0IHRpbWVv
dXQpOwogCiAvKiBEZXRlcm1pbmUgdGhlIElSUSB3aGljaCBpcyBib3VuZCB0byBhbiBldmVudCBj
aGFubmVsICovCi11bnNpZ25lZCBpcnFfZnJvbV9ldnRjaG4odW5zaWduZWQgaW50IGV2dGNobik7
Cit1bnNpZ25lZCBpbnQgaXJxX2Zyb21fZXZ0Y2huKGV2dGNobl9wb3J0X3QgZXZ0Y2huKTsKIGlu
dCBpcnFfZnJvbV92aXJxKHVuc2lnbmVkIGludCBjcHUsIHVuc2lnbmVkIGludCB2aXJxKTsKIHVu
c2lnbmVkIGludCBldnRjaG5fZnJvbV9pcnEodW5zaWduZWQgaXJxKTsKIApkaWZmIC0tZ2l0IGEv
aW5jbHVkZS94ZW4vaW50ZXJmYWNlL2V2ZW50X2NoYW5uZWwuaCBiL2luY2x1ZGUveGVuL2ludGVy
ZmFjZS9ldmVudF9jaGFubmVsLmgKaW5kZXggNDU2NTBjOWEwNmQ1Li5jZjgwZTMzOGZiYjAgMTAw
NjQ0Ci0tLSBhL2luY2x1ZGUveGVuL2ludGVyZmFjZS9ldmVudF9jaGFubmVsLmgKKysrIGIvaW5j
bHVkZS94ZW4vaW50ZXJmYWNlL2V2ZW50X2NoYW5uZWwuaApAQCAtMjIwLDcgKzIyMCw3IEBAIHN0
cnVjdCBldnRjaG5fZXhwYW5kX2FycmF5IHsKICNkZWZpbmUgRVZUQ0hOT1Bfc2V0X3ByaW9yaXR5
ICAgIDEzCiBzdHJ1Y3QgZXZ0Y2huX3NldF9wcmlvcml0eSB7CiAJLyogSU4gcGFyYW1ldGVycy4g
Ki8KLQl1aW50MzJfdCBwb3J0OworCWV2dGNobl9wb3J0X3QgcG9ydDsKIAl1aW50MzJfdCBwcmlv
cml0eTsKIH07CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUveGVuL3hlbmJ1cy5oIGIvaW5jbHVkZS94
ZW4veGVuYnVzLmgKaW5kZXggODlhODg5NTg1YmEwLi40ZjM1MjE2MDY0YmEgMTAwNjQ0Ci0tLSBh
L2luY2x1ZGUveGVuL3hlbmJ1cy5oCisrKyBiL2luY2x1ZGUveGVuL3hlbmJ1cy5oCkBAIC0yMTgs
OCArMjE4LDggQEAgaW50IHhlbmJ1c191bm1hcF9yaW5nKHN0cnVjdCB4ZW5idXNfZGV2aWNlICpk
ZXYsCiAJCSAgICAgIGdyYW50X2hhbmRsZV90ICpoYW5kbGVzLCB1bnNpZ25lZCBpbnQgbnJfaGFu
ZGxlcywKIAkJICAgICAgdW5zaWduZWQgbG9uZyAqdmFkZHJzKTsKIAotaW50IHhlbmJ1c19hbGxv
Y19ldnRjaG4oc3RydWN0IHhlbmJ1c19kZXZpY2UgKmRldiwgaW50ICpwb3J0KTsKLWludCB4ZW5i
dXNfZnJlZV9ldnRjaG4oc3RydWN0IHhlbmJ1c19kZXZpY2UgKmRldiwgaW50IHBvcnQpOworaW50
IHhlbmJ1c19hbGxvY19ldnRjaG4oc3RydWN0IHhlbmJ1c19kZXZpY2UgKmRldiwgdW5zaWduZWQg
aW50ICpwb3J0KTsKK2ludCB4ZW5idXNfZnJlZV9ldnRjaG4oc3RydWN0IHhlbmJ1c19kZXZpY2Ug
KmRldiwgdW5zaWduZWQgaW50IHBvcnQpOwogCiBlbnVtIHhlbmJ1c19zdGF0ZSB4ZW5idXNfcmVh
ZF9kcml2ZXJfc3RhdGUoY29uc3QgY2hhciAqcGF0aCk7CiAKLS0gCjIuMTcuMQoKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5n
IGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJv
amVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B7356B095E
	for <lists+xen-devel@lfdr.de>; Thu, 12 Sep 2019 09:21:37 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i8JO9-0001vu-Nz; Thu, 12 Sep 2019 07:19:33 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=+knL=XH=intel.com=chao.gao@srs-us1.protection.inumbo.net>)
 id 1i8JO8-0001u7-6M
 for xen-devel@lists.xenproject.org; Thu, 12 Sep 2019 07:19:32 +0000
X-Inumbo-ID: 9c6cebcc-d52d-11e9-83e3-12813bfff9fa
Received: from mga01.intel.com (unknown [192.55.52.88])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 9c6cebcc-d52d-11e9-83e3-12813bfff9fa;
 Thu, 12 Sep 2019 07:19:08 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga006.jf.intel.com ([10.7.209.51])
 by fmsmga101.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 12 Sep 2019 00:19:08 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,492,1559545200"; d="scan'208";a="189906357"
Received: from gao-cwp.sh.intel.com ([10.239.159.26])
 by orsmga006.jf.intel.com with ESMTP; 12 Sep 2019 00:19:06 -0700
From: Chao Gao <chao.gao@intel.com>
To: xen-devel@lists.xenproject.org
Date: Thu, 12 Sep 2019 15:22:26 +0800
Message-Id: <1568272949-1086-14-git-send-email-chao.gao@intel.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1568272949-1086-1-git-send-email-chao.gao@intel.com>
References: <1568272949-1086-1-git-send-email-chao.gao@intel.com>
Subject: [Xen-devel] [PATCH v10 13/16] microcode: remove
 microcode_update_lock
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Sergey Dyasli <sergey.dyasli@citrix.com>, Ashok Raj <ashok.raj@intel.com>,
 Wei Liu <wl@xen.org>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Jan Beulich <jbeulich@suse.com>, Chao Gao <chao.gao@intel.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

bWljcm9jb2RlX3VwZGF0ZV9sb2NrIGlzIHRvIHByZXZlbnQgbG9naWMgdGhyZWFkcyBvZiBhIHNh
bWUgY29yZSBmcm9tCnVwZGF0aW5nIG1pY3JvY29kZSBhdCB0aGUgc2FtZSB0aW1lLiBCdXQgZHVl
IHRvIHVzaW5nIGEgZ2xvYmFsIGxvY2ssIGl0CmFsc28gcHJldmVudGVkIHBhcmFsbGVsIG1pY3Jv
Y29kZSB1cGRhdGluZyBvbiBkaWZmZXJlbnQgY29yZXMuCgpSZW1vdmUgdGhpcyBsb2NrIGluIG9y
ZGVyIHRvIHVwZGF0ZSBtaWNyb2NvZGUgaW4gcGFyYWxsZWwuIEl0IGlzIHNhZmUKYmVjYXVzZSB3
ZSBoYXZlIGFscmVhZHkgZW5zdXJlZCBzZXJpYWxpemF0aW9uIG9mIHNpYmxpbmcgdGhyZWFkcyBh
dCB0aGUKY2FsbGVyIHNpZGUuCjEuRm9yIGxhdGUgbWljcm9jb2RlIHVwZGF0ZSwgZG9fbWljcm9j
b2RlX3VwZGF0ZSgpIGVuc3VyZXMgdGhhdCBvbmx5IG9uZQogIHNpYmlsaW5nIHRocmVhZCBvZiBh
IGNvcmUgY2FuIHVwZGF0ZSBtaWNyb2NvZGUuCjIuRm9yIG1pY3JvY29kZSB1cGRhdGUgZHVyaW5n
IHN5c3RlbSBzdGFydHVwIG9yIENQVS1ob3RwbHVnLAogIG1pY3JvY29kZV9tdXRleCgpIGd1YXJh
bnRlZXMgdXBkYXRlIHNlcmlhbGl6YXRpb24gb2YgbG9naWNhbCB0aHJlYWRzLgozLmdldC9wdXRf
Y3B1X2JpdG1hcHMoKSBwcmV2ZW50cyB0aGUgY29uY3VycmVuY3kgb2YgQ1BVLWhvdHBsdWcgYW5k
CiAgbGF0ZSBtaWNyb2NvZGUgdXBkYXRlLgoKTm90ZSB0aGF0IHByaW50ayBpbiBhcHBseV9taWNy
b2NvZGUoKSBhbmQgc3ZtX2hvc3Rfb3N2bV9pbml0KCkgKGZvciBBTUQKb25seSkgYXJlIHN0aWxs
IHByb2Nlc3NlZCBzZXF1ZW50aWFsbHkuCgpTaWduZWQtb2ZmLWJ5OiBDaGFvIEdhbyA8Y2hhby5n
YW9AaW50ZWwuY29tPgpSZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29t
PgotLS0KQ2hhbmdlcyBpbiB2NzoKIC0gcmV3b3JrZWQuIFJlbW92ZSBjb21wbGV4IGxvY2sgbG9n
aWNzIGludHJvZHVjZWQgaW4gdjUgYW5kIHY2LiBUaGUgbWljcm9jb2RlCiBwYXRjaCB0byBiZSBh
cHBsaWVkIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB3aXRob3V0IGFueSBnbG9iYWwgdmFyaWFi
bGUuIFRodXMKIG5vIGxvY2sgaXMgYWRkZWQgdG8gc2VyaWFsaXplIHBvdGVudGlhbCByZWFkZXJz
L3dyaXRlcnMuIENhbGxlcnMgb2YKIGFwcGx5X21pY3JvY29kZSgpIHdpbGwgZ3VhcmFudGVlIHRo
ZSBjb3JyZWN0bmVzczogdGhlIHBhdGNoIHBvbmludGVkIGJ5IHRoZQogYXJndW1lbnRzIHdvbid0
IGJlIGNoYW5nZWQgYnkgb3RoZXJzLgoKQ2hhbmdlcyBpbiB2NjoKIC0gaW50cm9kdWNlIGVhcmx5
X3Vjb2RlX3VwZGF0ZV9sb2NrIHRvIHNlcmlhbGl6ZSBlYXJseSB1Y29kZSB1cGRhdGUuCgpDaGFu
Z2VzIGluIHY1OgogLSBuZXdseSBhZGQKLS0tCiB4ZW4vYXJjaC94ODYvbWljcm9jb2RlX2FtZC5j
ICAgfCA4ICstLS0tLS0tCiB4ZW4vYXJjaC94ODYvbWljcm9jb2RlX2ludGVsLmMgfCA4ICstLS0t
LS0tCiAyIGZpbGVzIGNoYW5nZWQsIDIgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9hbWQuYyBiL3hlbi9hcmNoL3g4Ni9t
aWNyb2NvZGVfYW1kLmMKaW5kZXggZjA1ZGI3Mi4uODU2Y2FlYSAxMDA2NDQKLS0tIGEveGVuL2Fy
Y2gveDg2L21pY3JvY29kZV9hbWQuYworKysgYi94ZW4vYXJjaC94ODYvbWljcm9jb2RlX2FtZC5j
CkBAIC03NCw5ICs3NCw2IEBAIHN0cnVjdCBtcGJoZHIgewogICAgIHVpbnQ4X3QgZGF0YVtdOwog
fTsKIAotLyogc2VyaWFsaXplIGFjY2VzcyB0byB0aGUgcGh5c2ljYWwgd3JpdGUgKi8KLXN0YXRp
YyBERUZJTkVfU1BJTkxPQ0sobWljcm9jb2RlX3VwZGF0ZV9sb2NrKTsKLQogLyogU2VlIGNvbW1l
bnQgaW4gc3RhcnRfdXBkYXRlKCkgZm9yIGNhc2VzIHdoZW4gdGhpcyByb3V0aW5lIGZhaWxzICov
CiBzdGF0aWMgaW50IGNvbGxlY3RfY3B1X2luZm8oc3RydWN0IGNwdV9zaWduYXR1cmUgKmNzaWcp
CiB7CkBAIC0yMzIsNyArMjI5LDYgQEAgc3RhdGljIGVudW0gbWljcm9jb2RlX21hdGNoX3Jlc3Vs
dCBjb21wYXJlX3BhdGNoKAogCiBzdGF0aWMgaW50IGFwcGx5X21pY3JvY29kZShjb25zdCBzdHJ1
Y3QgbWljcm9jb2RlX3BhdGNoICpwYXRjaCkKIHsKLSAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwog
ICAgIHVpbnQzMl90IHJldjsKICAgICBpbnQgaHdfZXJyOwogICAgIHVuc2lnbmVkIGludCBjcHUg
PSBzbXBfcHJvY2Vzc29yX2lkKCk7CkBAIC0yNDcsMTUgKzI0MywxMyBAQCBzdGF0aWMgaW50IGFw
cGx5X21pY3JvY29kZShjb25zdCBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICpwYXRjaCkKIAogICAg
IGhkciA9IHBhdGNoLT5tY19hbWQtPm1wYjsKIAotICAgIHNwaW5fbG9ja19pcnFzYXZlKCZtaWNy
b2NvZGVfdXBkYXRlX2xvY2ssIGZsYWdzKTsKKyAgICBCVUdfT04obG9jYWxfaXJxX2lzX2VuYWJs
ZWQoKSk7CiAKICAgICBod19lcnIgPSB3cm1zcl9zYWZlKE1TUl9BTURfUEFUQ0hMT0FERVIsICh1
bnNpZ25lZCBsb25nKWhkcik7CiAKICAgICAvKiBnZXQgcGF0Y2ggaWQgYWZ0ZXIgcGF0Y2hpbmcg
Ki8KICAgICByZG1zcmwoTVNSX0FNRF9QQVRDSExFVkVMLCByZXYpOwogCi0gICAgc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmbWljcm9jb2RlX3VwZGF0ZV9sb2NrLCBmbGFncyk7Ci0KICAgICAvKgog
ICAgICAqIFNvbWUgcHJvY2Vzc29ycyBsZWF2ZSB0aGUgdWNvZGUgYmxvYiBtYXBwaW5nIGFzIFVD
IGFmdGVyIHRoZSB1cGRhdGUuCiAgICAgICogRmx1c2ggdGhlIG1hcHBpbmcgdG8gcmVnYWluIG5v
cm1hbCBjYWNoZWFiaWxpdHkuCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbWljcm9jb2RlX2lu
dGVsLmMgYi94ZW4vYXJjaC94ODYvbWljcm9jb2RlX2ludGVsLmMKaW5kZXggNGU4MTFiNy4uMTlm
MWJhMCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9pbnRlbC5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9taWNyb2NvZGVfaW50ZWwuYwpAQCAtOTMsOSArOTMsNiBAQCBzdHJ1Y3QgZXh0
ZW5kZWRfc2lndGFibGUgewogCiAjZGVmaW5lIGV4dHRhYmxlX3NpemUoZXQpICgoZXQpLT5jb3Vu
dCAqIEVYVF9TSUdOQVRVUkVfU0laRSArIEVYVF9IRUFERVJfU0laRSkKIAotLyogc2VyaWFsaXpl
IGFjY2VzcyB0byB0aGUgcGh5c2ljYWwgd3JpdGUgdG8gTVNSIDB4NzkgKi8KLXN0YXRpYyBERUZJ
TkVfU1BJTkxPQ0sobWljcm9jb2RlX3VwZGF0ZV9sb2NrKTsKLQogc3RhdGljIGludCBjb2xsZWN0
X2NwdV9pbmZvKHN0cnVjdCBjcHVfc2lnbmF0dXJlICpjc2lnKQogewogICAgIHVuc2lnbmVkIGlu
dCBjcHVfbnVtID0gc21wX3Byb2Nlc3Nvcl9pZCgpOwpAQCAtMjg4LDcgKzI4NSw2IEBAIHN0YXRp
YyBlbnVtIG1pY3JvY29kZV9tYXRjaF9yZXN1bHQgY29tcGFyZV9wYXRjaCgKIAogc3RhdGljIGlu
dCBhcHBseV9taWNyb2NvZGUoY29uc3Qgc3RydWN0IG1pY3JvY29kZV9wYXRjaCAqcGF0Y2gpCiB7
Ci0gICAgdW5zaWduZWQgbG9uZyBmbGFnczsKICAgICB1aW50NjRfdCBtc3JfY29udGVudDsKICAg
ICB1bnNpZ25lZCBpbnQgdmFsWzJdOwogICAgIHVuc2lnbmVkIGludCBjcHVfbnVtID0gcmF3X3Nt
cF9wcm9jZXNzb3JfaWQoKTsKQEAgLTMwMyw4ICsyOTksNyBAQCBzdGF0aWMgaW50IGFwcGx5X21p
Y3JvY29kZShjb25zdCBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICpwYXRjaCkKIAogICAgIG1jX2lu
dGVsID0gcGF0Y2gtPm1jX2ludGVsOwogCi0gICAgLyogc2VyaWFsaXplIGFjY2VzcyB0byB0aGUg
cGh5c2ljYWwgd3JpdGUgdG8gTVNSIDB4NzkgKi8KLSAgICBzcGluX2xvY2tfaXJxc2F2ZSgmbWlj
cm9jb2RlX3VwZGF0ZV9sb2NrLCBmbGFncyk7CisgICAgQlVHX09OKGxvY2FsX2lycV9pc19lbmFi
bGVkKCkpOwogCiAgICAgLyogd3JpdGUgbWljcm9jb2RlIHZpYSBNU1IgMHg3OSAqLwogICAgIHdy
bXNybChNU1JfSUEzMl9VQ09ERV9XUklURSwgKHVuc2lnbmVkIGxvbmcpbWNfaW50ZWwtPmJpdHMp
OwpAQCAtMzE3LDcgKzMxMiw2IEBAIHN0YXRpYyBpbnQgYXBwbHlfbWljcm9jb2RlKGNvbnN0IHN0
cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnBhdGNoKQogICAgIHJkbXNybChNU1JfSUEzMl9VQ09ERV9S
RVYsIG1zcl9jb250ZW50KTsKICAgICB2YWxbMV0gPSAodWludDMyX3QpKG1zcl9jb250ZW50ID4+
IDMyKTsKIAotICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJm1pY3JvY29kZV91cGRhdGVfbG9j
aywgZmxhZ3MpOwogICAgIGlmICggdmFsWzFdICE9IG1jX2ludGVsLT5oZHIucmV2ICkKICAgICB7
CiAgICAgICAgIHByaW50ayhLRVJOX0VSUiAibWljcm9jb2RlOiBDUFUlZCB1cGRhdGUgZnJvbSBy
ZXZpc2lvbiAiCi0tIAoxLjguMy4xCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVu
cHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZv
L3hlbi1kZXZlbA==

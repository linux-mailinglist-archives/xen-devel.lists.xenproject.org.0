Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9307660132
	for <lists+xen-devel@lfdr.de>; Fri,  5 Jul 2019 08:58:46 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hjI8O-0001tK-7o; Fri, 05 Jul 2019 06:55:52 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=vD9p=VC=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hjI8M-0001tF-Ik
 for xen-devel@lists.xenproject.org; Fri, 05 Jul 2019 06:55:50 +0000
X-Inumbo-ID: eaf4c10a-9ef1-11e9-8980-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id eaf4c10a-9ef1-11e9-8980-bc764e045a96;
 Fri, 05 Jul 2019 06:55:48 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 42BE3AF80;
 Fri,  5 Jul 2019 06:55:47 +0000 (UTC)
To: Andrew Cooper <andrew.cooper3@citrix.com>,
 Xen-devel <xen-devel@lists.xenproject.org>
References: <20190704175732.5943-1-andrew.cooper3@citrix.com>
From: Juergen Gross <jgross@suse.com>
Message-ID: <eef0d656-a82f-cb71-86f4-52a52f02a599@suse.com>
Date: Fri, 5 Jul 2019 08:55:46 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.2
MIME-Version: 1.0
In-Reply-To: <20190704175732.5943-1-andrew.cooper3@citrix.com>
Content-Language: de-DE
Subject: Re: [Xen-devel] [PATCH] x86/ctxt-switch: Document and improve GDT
 handling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Wei Liu <wl@xen.org>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?Q?Roger_Pau_Monn=c3=a9?= <roger.pau@citrix.com>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMDQuMDcuMTkgMTk6NTcsIEFuZHJldyBDb29wZXIgd3JvdGU6Cj4gd3JpdGVfZnVsbF9nZHRf
cHRlcygpIGhhcyBhIGxhdGVudCBidWcuICBVc2luZyB2aXJ0X3RvX21mbigpIGFuZCBpdGVyYXRp
bmcKPiB3aXRoIChtZm4gKyBpKSBpcyB3cm9uZywgYmVjYXVzZSBvZiBQRFggY29tcHJlc3Npb24u
ICBUaGUgY29udGV4dCBzd2l0Y2ggcGF0aAo+IG9ubHkgZnVuY3Rpb25zIGNvcnJlY3RseSBiZWNh
dXNlIE5SX1JFU0VSVkVEX0dEVF9QQUdFUyBpcyAxLgo+IAo+IEFzIHRoaXMgaXMgZXhjZWVkaW5n
bHkgdW5saWtlbHkgdG8gY2hhbmdlIG1vdmluZyBmb3dhcmQsIGRyb3AgdGhlIGxvb3AKPiByYXRo
ZXIgdGhhbiBpbnNlcnRpbmcgYSBCVUlMRF9CVUdfT04oTlJfUkVTRVJWRURfR0RUX1BBR0VTICE9
IDEpLgo+IAo+IFdpdGggdGhlIGxvb3AgZHJvcHBlZCwgd3JpdGVfZnVsbF9nZHRfcHRlcygpIGJl
Y29tZXMgbW9yZSBvYnZpb3VzbHkgYSBwb29yCj4gbmFtZSwgc28gcmVuYW1lIGl0IHRvIHVwZGF0
ZV94ZW5fc2xvdF9pbl9mdWxsX2dkdCgpLgo+IAo+IEZ1cnRoZXJtb3JlLCBjYWxsaW5nIHZpcnRf
dG9fbWZuKCkgaW4gdGhlIGNvbnRleHQgc3dpdGNoIHBhdGggaXMgYSBsb3Qgb2YKPiB3YXN0ZWQg
Y3ljbGVzIGZvciBhIHJlc3VsdCB3aGljaCBpcyBjb25zdGFudCBhZnRlciBib290Lgo+IAo+IEJl
Z2luIGJ5IGRvY3VtZW50aW5nIGhvdyBYZW4gaGFuZGxlcyB0aGUgR0RUcyBhY3Jvc3MgY29udGV4
dCBzd2l0Y2guCj4gCj4gIEZyb20gdGhpcywgd2Ugb2JzZXJ2ZSB0aGF0IGxvYWRfZnVsbF9nZHQo
KSBpcyBjb21wbGV0ZWx5IGluZGVwZW5kZW50IG9mIHRoZQo+IGN1cnJlbnQgQ1BVLCBhbmQgbG9h
ZF9kZWZhdWx0X2dkdCgpIG9ubHkgZ2V0cyBwYXNzZWQgdGhlIGN1cnJlbnQgQ1BVIHJlZ3VsYXIK
PiBHRFQuCj4gCj4gQWRkIHR3byBleHRyYSBwZXItY3B1IHZhcmlhYmxlcyB3aGljaCBjYWNoZSB0
aGUgTDFlIGZvciB0aGUgcmVndWxhciBhbmQgY29tcGF0Cj4gR0RULCBjYWxjdWxhdGVkIGluIGNw
dV9zbXBib290X2FsbG9jKCkvdHJhcF9pbml0KCkgYXMgYXBwcm9wcmlhdGUsIHNvCj4gdXBkYXRl
X3hlbl9zbG90X2luX2Z1bGxfZ2R0KCkgZG9lc24ndCBuZWVkIHRvIHdhc3RlIHRpbWUgcGVyZm9y
bWluZyB0aGUgc2FtZQo+IGNhbGN1bGF0aW9uIG9uIGV2ZXJ5IGNvbnRleHQgc3dpdGNoLgo+IAo+
IFNpZ25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+
CgpJIGRpZCBhIHNtYWxsIHBlcmZvcm1hbmNlIHRlc3Qgd2l0aCB0aGlzIHBhdGNoOiBvbiBhIDgg
Y3B1IHN5c3RlbSBJCnN0YXJ0ZWQgMiBtaW5pLW9zIGRvbWFpbnMgKDEgdmNwdSBlYWNoKSBkb2lu
ZyBhIGJ1c3kgbG9vcCBzZW5kaW5nCmV2ZW50cyB0byBkb20wLiBPbiBkb20wIEkgZGlkIGEgYnVp
bGQgb2YgdGhlIGh5cGVydmlzb3IgdmlhCiJtYWtlIC1qIDgiIGFuZCBtZWFzdXJlZCB0aGUgdGlt
ZSBmb3IgdGhhdCBidWlsZCwgdGhlbiB0b29rIHRoZQphdmVyYWdlIG9mIDUgc3VjaCBidWlsZHMg
KGRvaW5nIGEgbWFrZSBjbGVhbiBpbiBiZXR3ZWVuKS4KCiAgICAgICAgICAgZWxhcHNlZCAgdXNl
ciAgIHN5c3RlbQpVbnBhdGNoZWQgIDY2LjUxICAyMzIuOTMgIDEwOS4yMQpQYXRjaGVkICAgIDU3
LjAwICAyMjUuNDcgIDEwNS40NwoKVGhpcyBpcyBhIHZlcnkgY2xlYXIgd2luIG9mIHBlcmZvcm1h
bmNlIQoKVGVzdGVkLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+CgoKSnVlcmdlbgoKPiAtLS0KPiBD
QzogSmFuIEJldWxpY2ggPEpCZXVsaWNoQHN1c2UuY29tPgo+IENDOiBXZWkgTGl1IDx3bEB4ZW4u
b3JnPgo+IENDOiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4KPiBDQzog
SnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgo+IAo+IFNsaWdodGx5IFJGQy4KPiAKPiBJ
J20gZmFpcmx5IGNvbmZpZGVudCB0aGlzIGlzIGJldHRlciwgYnV0IEp1ZXJnZW4gc2F5cyB0aGF0
IHRoZSBzb21lIG9mIGhpcwo+IHNjaGVkdWxpbmcgcGVyZiB0ZXN0cyBub3RpY2UgbGFyZ2UgZGlm
ZmVyZW5jZSBmcm9tIHN1YnRsZSBjaGFuZ2VzIGluCj4gX19jb250ZXh0X3N3aXRjaCgpLCBzbyBp
dCB3b3VsZCBiZSB1c2VmdWwgdG8gZ2V0IHNvbWUgbnVtYmVycyBmcm9tIHRoaXMKPiBjaGFuZ2Uu
Cj4gCj4gVGhlIGRlbHRhIGZyb20gdGhpcyBjaGFuZ2UgaXM6Cj4gCj4gICAgYWRkL3JlbW92ZTog
Mi8wIGdyb3cvc2hyaW5rOiAxLzEgdXAvZG93bjogMzIwLy0xMjcgKDE5MykKPiAgICBGdW5jdGlv
biAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGQgICAgIG5ldyAgIGRlbHRh
Cj4gICAgY3B1X3NtcGJvb3RfY2FsbGJhY2sgICAgICAgICAgICAgICAgICAgICAgICAxMTUyICAg
IDE0NTYgICAgKzMwNAo+ICAgIHBlcl9jcHVfX2dkdF90YWJsZV9sMWUgICAgICAgICAgICAgICAg
ICAgICAgICAgLSAgICAgICA4ICAgICAgKzgKPiAgICBwZXJfY3B1X19jb21wYXRfZ2R0X3RhYmxl
X2wxZSAgICAgICAgICAgICAgICAgIC0gICAgICAgOCAgICAgICs4Cj4gICAgX19jb250ZXh0X3N3
aXRjaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMjM4ICAgIDExMTEgICAgLTEyNwo+ICAg
IFRvdGFsOiBCZWZvcmU9MzMzOTIyNywgQWZ0ZXI9MzMzOTQyMCwgY2hnICswLjAxJQo+IAo+IEkn
bSBub3Qgb3Zlcmx5IGhhcHB5IGFib3V0IHRoZSBzcGVjaWFsIGNhc2UgaW4gdHJhcF9pbml0KCkg
YnV0IEkgY2FuJ3QgdGhpbmsKPiBvZiBhIGJldHRlciBwbGFjZSB0byBwdXQgdGhpcy4KPiAKPiBB
bHNvLCBpdCBzaG91bGQgbm93IGJlIHZlcnkgb2J2aW91cyB0byBwZW9wbGUgdGhhdCBYZW4ncyBj
dXJyZW50IEdEVCBoYW5kbGluZwo+IGZvciBub24tUFYgdmNwdXMgaXMgYSByZWNpcGUgc3VidGxl
IGJ1Z3MsIGlmIHdlIGV2ZXIgbWFuYWdlIHRvIGV4ZWN1dGUgYSBzdHJheQo+IG1vdi9wb3AgJXNy
ZWcgaW5zdHJ1Y3Rpb24uICBXZSByZWFsbHkgb3VnaHQgdG8gaGF2ZSBYZW4ncyByZWd1bGFyIEdE
VCBpbiBhbgo+IGFyZWEgd2hlcmUgc2xvdHMgMC0xMyBhcmUgZWl0aGVyIG1hcHBlZCB0byB0aGUg
emVybyBwYWdlLCBvciBub3QgcHJlc2VudCwgc28KPiB3ZSBkb24ndCByaXNrIGxvYWRpbmcgYSBu
b24tZmF1bHRpbmcgZ2FyYmFnZSBzZWxlY3Rvci4KPiAtLS0KPiAgIHhlbi9hcmNoL3g4Ni9kb21h
aW4uYyAgICAgIHwgNTIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0t
LS0tLQo+ICAgeGVuL2FyY2gveDg2L3NtcGJvb3QuYyAgICAgfCAgNCArKysrCj4gICB4ZW4vYXJj
aC94ODYvdHJhcHMuYyAgICAgICB8IDEwICsrKysrKysrKwo+ICAgeGVuL2luY2x1ZGUvYXNtLXg4
Ni9kZXNjLmggfCAgMiArKwo+ICAgNCBmaWxlcyBjaGFuZ2VkLCA1MCBpbnNlcnRpb25zKCspLCAx
OCBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIv
eGVuL2FyY2gveDg2L2RvbWFpbi5jCj4gaW5kZXggODRjYWZiZTU1OC4uMTQ3Zjk2YTA5ZSAxMDA2
NDQKPiAtLS0gYS94ZW4vYXJjaC94ODYvZG9tYWluLmMKPiArKysgYi94ZW4vYXJjaC94ODYvZG9t
YWluLmMKPiBAQCAtMTYzNSwyMyArMTYzNSw0MiBAQCBzdGF0aWMgdm9pZCBfdXBkYXRlX3J1bnN0
YXRlX2FyZWEoc3RydWN0IHZjcHUgKnYpCj4gICAgICAgICAgIHYtPmFyY2gucHYubmVlZF91cGRh
dGVfcnVuc3RhdGVfYXJlYSA9IDE7Cj4gICB9Cj4gICAKPiArLyoKPiArICogT3ZlcnZpZXcgb2Yg
WGVuJ3MgR0RUcy4KPiArICoKPiArICogWGVuIG1haW50YWlucyBwZXItQ1BVIGNvbXBhdCBhbmQg
cmVndWxhciBHRFRzIHdoaWNoIGFyZSBib3RoIGEgc2luZ2xlIHBhZ2UKPiArICogaW4gc2l6ZS4g
IFNvbWUgY29udGVudCBpcyBzcGVjaWZpYyB0byBlYWNoIENQVSAodGhlIFRTUywgdGhlIHBlci1D
UFUgbWFya2VyCj4gKyAqIGZvciAjREYgaGFuZGxpbmcsIGFuZCBvcHRpb25hbGx5IHRoZSBMRFQp
LiAgVGhlIGNvbXBhdCBhbmQgcmVndWxhciBHRFRzCj4gKyAqIGRpZmZlciBieSB0aGUgbGF5b3V0
IGFuZCBjb250ZW50IG9mIHRoZSBndWVzdCBhY2Nlc3NpYmxlIHNlbGVjdG9ycy4KPiArICoKPiAr
ICogVGhlIFhlbiBzZWxlY3RvcnMgbGl2ZSBmcm9tIDB4ZTAwMCAoc2xvdCAxNCBvZiAxNiksIGFu
ZCBuZWVkIHRvIGFsd2F5cwo+ICsgKiBhcHBlYXIgaW4gdGhpcyBwb3NpdGlvbiBmb3IgaW50ZXJy
dXB0L2V4Y2VwdGlvbiBoYW5kbGluZyB0byB3b3JrLgo+ICsgKgo+ICsgKiBBIFBWIGd1ZXN0IG1h
eSBzcGVjaWZ5IEdEVCBmcmFtZXMgb2YgdGhlaXIgb3duIChzbG90cyAwIHRvIDEzKS4gIFJvb20g
Zm9yIGEKPiArICogZnVsbCBHRFQgZXhpc3RzIGluIHRoZSBwZXItZG9tYWluIG1hcHBpbmdzLgo+
ICsgKgo+ICsgKiBUbyBzY2hlZHVsZSBhIFBWIHZjcHUsIHdlIHBvaW50IHNsb3QgMTQgb2YgdGhl
IGd1ZXN0J3MgZnVsbCBHRFQgYXQgdGhlCj4gKyAqIGN1cnJlbnQgQ1BVJ3MgY29tcGF0IG9yIHJl
Z3VsYXIgKGFzIGFwcHJvcHJpYXRlKSBHRFQgZnJhbWUuICBUaGlzIGlzIHNvCj4gKyAqIHRoYXQg
dGhlIHBlci1DUFUgcGFydHMgc3RpbGwgd29yayBjb3JyZWN0bHkgYWZ0ZXIgc3dpdGNoaW5nIHBh
Z2V0YWJsZXMgYW5kCj4gKyAqIGxvYWRpbmcgdGhlIGd1ZXN0cyBmdWxsIEdEVCBpbnRvIEdEVFIu
Cj4gKyAqCj4gKyAqIFRvIHNjaGVkdWxlIElkbGUgb3IgSFZNIHZjcHVzLCB3ZSBsb2FkIGEgR0RU
IGJhc2UgYWRkcmVzcyB3aGljaCBjYXVzZXMgdGhlCj4gKyAqIHJlZ3VsYXIgcGVyLUNQVSBHRFQg
ZnJhbWUgdG8gYXBwZWFyIHdpdGggc2VsZWN0b3JzIGF0IHRoZSBhcHByb3ByaWF0ZQo+ICsgKiBv
ZmZzZXQuCj4gKyAqLwo+ICAgc3RhdGljIGlubGluZSBib29sIG5lZWRfZnVsbF9nZHQoY29uc3Qg
c3RydWN0IGRvbWFpbiAqZCkKPiAgIHsKPiAgICAgICByZXR1cm4gaXNfcHZfZG9tYWluKGQpICYm
ICFpc19pZGxlX2RvbWFpbihkKTsKPiAgIH0KPiAgIAo+IC1zdGF0aWMgdm9pZCB3cml0ZV9mdWxs
X2dkdF9wdGVzKHNlZ19kZXNjX3QgKmdkdCwgY29uc3Qgc3RydWN0IHZjcHUgKnYpCj4gK3N0YXRp
YyB2b2lkIHVwZGF0ZV94ZW5fc2xvdF9pbl9mdWxsX2dkdChjb25zdCBzdHJ1Y3QgdmNwdSAqdiwg
dW5zaWduZWQgaW50IGNwdSkKPiAgIHsKPiAtICAgIHVuc2lnbmVkIGxvbmcgbWZuID0gdmlydF90
b19tZm4oZ2R0KTsKPiAtICAgIGwxX3BnZW50cnlfdCAqcGwxZSA9IHB2X2dkdF9wdGVzKHYpOwo+
IC0gICAgdW5zaWduZWQgaW50IGk7Cj4gLQo+IC0gICAgZm9yICggaSA9IDA7IGkgPCBOUl9SRVNF
UlZFRF9HRFRfUEFHRVM7IGkrKyApCj4gLSAgICAgICAgbDFlX3dyaXRlKHBsMWUgKyBGSVJTVF9S
RVNFUlZFRF9HRFRfUEFHRSArIGksCj4gLSAgICAgICAgICAgICAgICAgIGwxZV9mcm9tX3Bmbiht
Zm4gKyBpLCBfX1BBR0VfSFlQRVJWSVNPUl9SVykpOwo+ICsgICAgbDFlX3dyaXRlKHB2X2dkdF9w
dGVzKHYpICsgRklSU1RfUkVTRVJWRURfR0RUX1BBR0UsCj4gKyAgICAgICAgICAgICAgIWlzX3B2
XzMyYml0X3ZjcHUodikgPyBwZXJfY3B1KGdkdF90YWJsZV9sMWUsIGNwdSkKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICA6IHBlcl9jcHUoY29tcGF0X2dkdF90YWJsZV9sMWUs
IGNwdSkpOwo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGxvYWRfZnVsbF9nZHQoY29uc3Qgc3Ry
dWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBjcHUpCj4gK3N0YXRpYyB2b2lkIGxvYWRfZnVsbF9n
ZHQoY29uc3Qgc3RydWN0IHZjcHUgKnYpCj4gICB7Cj4gICAgICAgc3RydWN0IGRlc2NfcHRyIGdk
dF9kZXNjID0gewo+ICAgICAgICAgICAubGltaXQgPSBMQVNUX1JFU0VSVkVEX0dEVF9CWVRFLAo+
IEBAIC0xNjYxLDExICsxNjgwLDEyIEBAIHN0YXRpYyB2b2lkIGxvYWRfZnVsbF9nZHQoY29uc3Qg
c3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBjcHUpCj4gICAgICAgbGdkdCgmZ2R0X2Rlc2Mp
Owo+ICAgfQo+ICAgCj4gLXN0YXRpYyB2b2lkIGxvYWRfZGVmYXVsdF9nZHQoY29uc3Qgc2VnX2Rl
c2NfdCAqZ2R0LCB1bnNpZ25lZCBpbnQgY3B1KQo+ICtzdGF0aWMgdm9pZCBsb2FkX2RlZmF1bHRf
Z2R0KHVuc2lnbmVkIGludCBjcHUpCj4gICB7Cj4gICAgICAgc3RydWN0IGRlc2NfcHRyIGdkdF9k
ZXNjID0gewo+ICAgICAgICAgICAubGltaXQgPSBMQVNUX1JFU0VSVkVEX0dEVF9CWVRFLAo+IC0g
ICAgICAgIC5iYXNlICA9ICh1bnNpZ25lZCBsb25nKShnZHQgLSBGSVJTVF9SRVNFUlZFRF9HRFRf
RU5UUlkpLAo+ICsgICAgICAgIC5iYXNlICA9ICh1bnNpZ25lZCBsb25nKShwZXJfY3B1KGdkdF90
YWJsZSwgY3B1KSAtCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZJUlNUX1JF
U0VSVkVEX0dEVF9FTlRSWSksCj4gICAgICAgfTsKPiAgIAo+ICAgICAgIGxnZHQoJmdkdF9kZXNj
KTsKPiBAQCAtMTY3OCw3ICsxNjk4LDYgQEAgc3RhdGljIHZvaWQgX19jb250ZXh0X3N3aXRjaCh2
b2lkKQo+ICAgICAgIHN0cnVjdCB2Y3B1ICAgICAgICAgICpwID0gcGVyX2NwdShjdXJyX3ZjcHUs
IGNwdSk7Cj4gICAgICAgc3RydWN0IHZjcHUgICAgICAgICAgKm4gPSBjdXJyZW50Owo+ICAgICAg
IHN0cnVjdCBkb21haW4gICAgICAgICpwZCA9IHAtPmRvbWFpbiwgKm5kID0gbi0+ZG9tYWluOwo+
IC0gICAgc2VnX2Rlc2NfdCAgICAgICAgICAgKmdkdDsKPiAgIAo+ICAgICAgIEFTU0VSVChwICE9
IG4pOwo+ICAgICAgIEFTU0VSVCghdmNwdV9jcHVfZGlydHkobikpOwo+IEBAIC0xNzE4LDE1ICsx
NzM3LDEyIEBAIHN0YXRpYyB2b2lkIF9fY29udGV4dF9zd2l0Y2godm9pZCkKPiAgIAo+ICAgICAg
IHBzcl9jdHh0X3N3aXRjaF90byhuZCk7Cj4gICAKPiAtICAgIGdkdCA9ICFpc19wdl8zMmJpdF9k
b21haW4obmQpID8gcGVyX2NwdShnZHRfdGFibGUsIGNwdSkgOgo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBwZXJfY3B1KGNvbXBhdF9nZHRfdGFibGUsIGNwdSk7Cj4gLQo+
ICAgICAgIGlmICggbmVlZF9mdWxsX2dkdChuZCkgKQo+IC0gICAgICAgIHdyaXRlX2Z1bGxfZ2R0
X3B0ZXMoZ2R0LCBuKTsKPiArICAgICAgICB1cGRhdGVfeGVuX3Nsb3RfaW5fZnVsbF9nZHQobiwg
Y3B1KTsKPiAgIAo+ICAgICAgIGlmICggbmVlZF9mdWxsX2dkdChwZCkgJiYKPiAgICAgICAgICAg
ICgocC0+dmNwdV9pZCAhPSBuLT52Y3B1X2lkKSB8fCAhbmVlZF9mdWxsX2dkdChuZCkpICkKPiAt
ICAgICAgICBsb2FkX2RlZmF1bHRfZ2R0KGdkdCwgY3B1KTsKPiArICAgICAgICBsb2FkX2RlZmF1
bHRfZ2R0KGNwdSk7Cj4gICAKPiAgICAgICB3cml0ZV9wdGJhc2Uobik7Cj4gICAKPiBAQCAtMTcz
OSw3ICsxNzU1LDcgQEAgc3RhdGljIHZvaWQgX19jb250ZXh0X3N3aXRjaCh2b2lkKQo+ICAgCj4g
ICAgICAgaWYgKCBuZWVkX2Z1bGxfZ2R0KG5kKSAmJgo+ICAgICAgICAgICAgKChwLT52Y3B1X2lk
ICE9IG4tPnZjcHVfaWQpIHx8ICFuZWVkX2Z1bGxfZ2R0KHBkKSkgKQo+IC0gICAgICAgIGxvYWRf
ZnVsbF9nZHQobiwgY3B1KTsKPiArICAgICAgICBsb2FkX2Z1bGxfZ2R0KG4pOwo+ICAgCj4gICAg
ICAgaWYgKCBwZCAhPSBuZCApCj4gICAgICAgICAgIGNwdW1hc2tfY2xlYXJfY3B1KGNwdSwgcGQt
PmRpcnR5X2NwdW1hc2spOwo+IGRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvc21wYm9vdC5jIGIv
eGVuL2FyY2gveDg2L3NtcGJvb3QuYwo+IGluZGV4IDczMGZlMTQxZmEuLjAwNDI4NWQxNGMgMTAw
NjQ0Cj4gLS0tIGEveGVuL2FyY2gveDg2L3NtcGJvb3QuYwo+ICsrKyBiL3hlbi9hcmNoL3g4Ni9z
bXBib290LmMKPiBAQCAtOTg1LDYgKzk4NSw4IEBAIHN0YXRpYyBpbnQgY3B1X3NtcGJvb3RfYWxs
b2ModW5zaWduZWQgaW50IGNwdSkKPiAgICAgICBpZiAoIGdkdCA9PSBOVUxMICkKPiAgICAgICAg
ICAgZ290byBvdXQ7Cj4gICAgICAgcGVyX2NwdShnZHRfdGFibGUsIGNwdSkgPSBnZHQ7Cj4gKyAg
ICBwZXJfY3B1KGdkdF90YWJsZV9sMWUsIGNwdSkgPQo+ICsgICAgICAgIGwxZV9mcm9tX3Bmbih2
aXJ0X3RvX21mbihnZHQpLCBfX1BBR0VfSFlQRVJWSVNPUl9SVyk7Cj4gICAgICAgbWVtY3B5KGdk
dCwgYm9vdF9jcHVfZ2R0X3RhYmxlLCBOUl9SRVNFUlZFRF9HRFRfUEFHRVMgKiBQQUdFX1NJWkUp
Owo+ICAgICAgIEJVSUxEX0JVR19PTihOUl9DUFVTID4gMHgxMDAwMCk7Cj4gICAgICAgZ2R0W1BF
Ul9DUFVfR0RUX0VOVFJZIC0gRklSU1RfUkVTRVJWRURfR0RUX0VOVFJZXS5hID0gY3B1Owo+IEBA
IC05OTIsNiArOTk0LDggQEAgc3RhdGljIGludCBjcHVfc21wYm9vdF9hbGxvYyh1bnNpZ25lZCBp
bnQgY3B1KQo+ICAgICAgIHBlcl9jcHUoY29tcGF0X2dkdF90YWJsZSwgY3B1KSA9IGdkdCA9IGFs
bG9jX3hlbmhlYXBfcGFnZXMob3JkZXIsIG1lbWZsYWdzKTsKPiAgICAgICBpZiAoIGdkdCA9PSBO
VUxMICkKPiAgICAgICAgICAgZ290byBvdXQ7Cj4gKyAgICBwZXJfY3B1KGNvbXBhdF9nZHRfdGFi
bGVfbDFlLCBjcHUpID0KPiArICAgICAgICBsMWVfZnJvbV9wZm4odmlydF90b19tZm4oZ2R0KSwg
X19QQUdFX0hZUEVSVklTT1JfUlcpOwo+ICAgICAgIG1lbWNweShnZHQsIGJvb3RfY3B1X2NvbXBh
dF9nZHRfdGFibGUsIE5SX1JFU0VSVkVEX0dEVF9QQUdFUyAqIFBBR0VfU0laRSk7Cj4gICAgICAg
Z2R0W1BFUl9DUFVfR0RUX0VOVFJZIC0gRklSU1RfUkVTRVJWRURfR0RUX0VOVFJZXS5hID0gY3B1
Owo+ICAgCj4gZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni90cmFwcy5jIGIveGVuL2FyY2gveDg2
L3RyYXBzLmMKPiBpbmRleCA4MDk3ZWYzYmY1Li4yNWI0YjQ3ZTVlIDEwMDY0NAo+IC0tLSBhL3hl
bi9hcmNoL3g4Ni90cmFwcy5jCj4gKysrIGIveGVuL2FyY2gveDg2L3RyYXBzLmMKPiBAQCAtOTcs
NyArOTcsOSBAQCBERUZJTkVfUEVSX0NQVSh1aW50NjRfdCwgZWZlcik7Cj4gICBzdGF0aWMgREVG
SU5FX1BFUl9DUFUodW5zaWduZWQgbG9uZywgbGFzdF9leHRhYmxlX2FkZHIpOwo+ICAgCj4gICBE
RUZJTkVfUEVSX0NQVV9SRUFEX01PU1RMWShzZWdfZGVzY190ICosIGdkdF90YWJsZSk7Cj4gK0RF
RklORV9QRVJfQ1BVX1JFQURfTU9TVExZKGwxX3BnZW50cnlfdCwgZ2R0X3RhYmxlX2wxZSk7Cj4g
ICBERUZJTkVfUEVSX0NQVV9SRUFEX01PU1RMWShzZWdfZGVzY190ICosIGNvbXBhdF9nZHRfdGFi
bGUpOwo+ICtERUZJTkVfUEVSX0NQVV9SRUFEX01PU1RMWShsMV9wZ2VudHJ5X3QsIGNvbXBhdF9n
ZHRfdGFibGVfbDFlKTsKPiAgIAo+ICAgLyogTWFzdGVyIHRhYmxlLCB1c2VkIGJ5IENQVTAuICov
Cj4gICBpZHRfZW50cnlfdCBfX3NlY3Rpb24oIi5ic3MucGFnZV9hbGlnbmVkIikgX19hbGlnbmVk
KFBBR0VfU0laRSkKPiBAQCAtMjA1OSw2ICsyMDYxLDE0IEBAIHZvaWQgX19pbml0IHRyYXBfaW5p
dCh2b2lkKQo+ICAgICAgICAgICB9Cj4gICAgICAgfQo+ICAgCj4gKyAgICAvKiBDYWNoZSB7LGNv
bXBhdF99Z2R0X3RhYmxlX2wxZSBub3cgdGhhdCBwaHlzaWNhbGx5IHJlbG9jYXRpb24gaXMgZG9u
ZS4gKi8KPiArICAgIHRoaXNfY3B1KGdkdF90YWJsZV9sMWUpID0KPiArICAgICAgICBsMWVfZnJv
bV9wZm4odmlydF90b19tZm4oYm9vdF9jcHVfZ2R0X3RhYmxlKSwKPiArICAgICAgICAgICAgICAg
ICAgICAgX19QQUdFX0hZUEVSVklTT1JfUlcpOwo+ICsgICAgdGhpc19jcHUoY29tcGF0X2dkdF90
YWJsZV9sMWUpID0KPiArICAgICAgICBsMWVfZnJvbV9wZm4odmlydF90b19tZm4oYm9vdF9jcHVf
Y29tcGF0X2dkdF90YWJsZSksCj4gKyAgICAgICAgICAgICAgICAgICAgIF9fUEFHRV9IWVBFUlZJ
U09SX1JXKTsKPiArCj4gICAgICAgcGVyY3B1X3RyYXBzX2luaXQoKTsKPiAgIAo+ICAgICAgIGNw
dV9pbml0KCk7Cj4gZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvZGVzYy5oIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9kZXNjLmgKPiBpbmRleCA4NWU4M2JjZWZiLi5lNTY1NzI3ZGMwIDEw
MDY0NAo+IC0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvZGVzYy5oCj4gKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9kZXNjLmgKPiBAQCAtMjA2LDggKzIwNiwxMCBAQCBzdHJ1Y3QgX19wYWNrZWQg
ZGVzY19wdHIgewo+ICAgCj4gICBleHRlcm4gc2VnX2Rlc2NfdCBib290X2NwdV9nZHRfdGFibGVb
XTsKPiAgIERFQ0xBUkVfUEVSX0NQVShzZWdfZGVzY190ICosIGdkdF90YWJsZSk7Cj4gK0RFQ0xB
UkVfUEVSX0NQVShsMV9wZ2VudHJ5X3QsIGdkdF90YWJsZV9sMWUpOwo+ICAgZXh0ZXJuIHNlZ19k
ZXNjX3QgYm9vdF9jcHVfY29tcGF0X2dkdF90YWJsZVtdOwo+ICAgREVDTEFSRV9QRVJfQ1BVKHNl
Z19kZXNjX3QgKiwgY29tcGF0X2dkdF90YWJsZSk7Cj4gK0RFQ0xBUkVfUEVSX0NQVShsMV9wZ2Vu
dHJ5X3QsIGNvbXBhdF9nZHRfdGFibGVfbDFlKTsKPiAgIAo+ICAgZXh0ZXJuIHZvaWQgbG9hZF9U
Uih2b2lkKTsKPiAgIAo+IAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2pl
Y3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4t
ZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id BB246B04C7
	for <lists+xen-devel@lfdr.de>; Wed, 11 Sep 2019 22:11:03 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i88rk-00030w-MY; Wed, 11 Sep 2019 20:05:24 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=L0xq=XG=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1i88rj-00030Q-4o
 for xen-devel@lists.xenproject.org; Wed, 11 Sep 2019 20:05:23 +0000
X-Inumbo-ID: 77962363-d4cf-11e9-83dd-12813bfff9fa
Received: from esa2.hc3370-68.iphmx.com (unknown [216.71.145.153])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 77962363-d4cf-11e9-83dd-12813bfff9fa;
 Wed, 11 Sep 2019 20:05:14 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1568232314;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=BIbnzCREkG77hGwoxZ3RMjH/adLjjec/0WbuotSainY=;
 b=Y/qAtP5RizTiEL+UN51Iu/6u8CO7vCdLHLmv9aMbKbOrRnEhQOztzP/8
 6P3ROA2fhQMvTlyB/ugiIRDwoijFXQocIHgmnYagkOtnF+KYok1e1QGJ/
 NhdWYL8o8Yrg8MQQYZplsMGvBEIMPll/s4aHJ3QT0drRygk74uEV1FKtV 4=;
Authentication-Results: esa2.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa2.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa2.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa2.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: iC/85lOS97iYbHxeP+m/voeXswq+JeYqBhLHZ/p93Cik7QXsMus2dDB8dA9+Yiyd4153Ec55UB
 9ppGVUz3JoKeb6+ox7U6TOrlfKkAWjWAVmcXkIabxGL5lrTSCV56+Y1iSaFN45k60gWgU/4A2r
 vqtyNGrbzeL+OxXgXTMtTrkyVatnTfu+vxvbINgD1ytNMJEZNu8biYVsNUjYaAG1XSDqrydOKR
 gSK9pYZgEGQ2JK3aqAyUOCMJOoDznNrVdvbqcwe/AMLgy9bsXPW1Bsp6ddbEvWK3b57SH1+xoI
 7jI=
X-SBRS: 2.7
X-MesageID: 5451848
X-Ironport-Server: esa2.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,494,1559534400"; 
   d="scan'208";a="5451848"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Wed, 11 Sep 2019 21:04:59 +0100
Message-ID: <20190911200504.5693-4-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190911200504.5693-1-andrew.cooper3@citrix.com>
References: <20190911200504.5693-1-andrew.cooper3@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 3/8] x86/domctl: Implement
 XEN_DOMCTL_set_cpumsr_policy
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Sergey Dyasli <sergey.dyasli@citrix.com>, Wei Liu <wl@xen.org>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <Ian.Jackson@eu.citrix.com>, Jan Beulich <JBeulich@suse.com>,
 Daniel De Graaf <dgdegra@tycho.nsa.gov>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBoeXBlcmNhbGwgYWxsb3dzIHRoZSB0b29sc3RhY2sgdG8gcHJlc2VudCBvbmUgY29tYmlu
ZWQgQ1BVSUQgYW5kIE1TUgpwb2xpY3kgZm9yIGEgZG9tYWluLCB3aGljaCBjYW4gYmUgYXVkaXRl
ZCBpbiBvbmUgZ28gYnkgWGVuLCB3aGljaCBpcyBuZWNlc3NhcnkKZm9yIGNvcnJlY3RuZXNzIG9m
IHRoZSBhdWRpdGluZy4KClJldXNlIHRoZSBleGlzdGluZyBzZXRfY3B1aWQgWFNNIGFjY2VzcyB2
ZWN0b3IsIGFzIHRoaXMgaXMgbG9naWNhbGx5IHRoZSBzYW1lCm9wZXJhdGlvbi4KCkFzIHg4Nl9j
cHVfcG9saWNpZXNfYXJlX2NvbXBhdGlibGUoKSBpcyBzdGlsbCBvbmx5IGEgc3R1YiwgcmV0YWlu
IHRoZSBjYWxsIHRvCnJlY2FsY3VsYXRlX2NwdWlkX3BvbGljeSgpIHRvIGRpc2NhcmQgdW5zYWZl
IHRvb2xzdGFjayBzZXR0aW5ncy4KClNpZ25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IFNlcmdleSBEeWFzbGkgPHNlcmdl
eS5keWFzbGlAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9n
ZXIucGF1QGNpdHJpeC5jb20+Ci0tLQpDQzogSmFuIEJldWxpY2ggPEpCZXVsaWNoQHN1c2UuY29t
PgpDQzogSWFuIEphY2tzb24gPElhbi5KYWNrc29uQGV1LmNpdHJpeC5jb20+CkNDOiBXZWkgTGl1
IDx3bEB4ZW4ub3JnPgpDQzogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+
CkNDOiBEYW5pZWwgRGUgR3JhYWYgPGRnZGVncmFAdHljaG8ubnNhLmdvdj4KLS0tCiB0b29scy9s
aWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaCAgICAgICB8ICA1ICsrKwogdG9vbHMvbGlieGMveGNfY3B1
aWRfeDg2LmMgICAgICAgICAgfCA0OSArKysrKysrKysrKysrKysrKysrKysrKwogeGVuL2FyY2gv
eDg2L2RvbWN0bC5jICAgICAgICAgICAgICAgfCA4MCArKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrCiB4ZW4vaW5jbHVkZS9wdWJsaWMvZG9tY3RsLmggICAgICAgICB8IDE1ICsr
KysrLS0KIHhlbi94c20vZmxhc2svaG9va3MuYyAgICAgICAgICAgICAgIHwgIDEgKwogeGVuL3hz
bS9mbGFzay9wb2xpY3kvYWNjZXNzX3ZlY3RvcnMgfCAgMSArCiA2IGZpbGVzIGNoYW5nZWQsIDE0
NyBpbnNlcnRpb25zKCspLCA0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhj
L2luY2x1ZGUveGVuY3RybC5oIGIvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmgKaW5kZXgg
NzU1OWUxYmM2OS4uZTQ3Nzc4NTM1ZCAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGMvaW5jbHVkZS94
ZW5jdHJsLmgKKysrIGIvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmgKQEAgLTI1MzAsNiAr
MjUzMCwxMSBAQCBpbnQgeGNfZ2V0X3N5c3RlbV9jcHVfcG9saWN5KHhjX2ludGVyZmFjZSAqeGNo
LCB1aW50MzJfdCBpbmRleCwKIGludCB4Y19nZXRfZG9tYWluX2NwdV9wb2xpY3koeGNfaW50ZXJm
YWNlICp4Y2gsIHVpbnQzMl90IGRvbWlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
aW50MzJfdCAqbnJfbGVhdmVzLCB4ZW5fY3B1aWRfbGVhZl90ICpsZWF2ZXMsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpucl9tc3JzLCB4ZW5fbXNyX2VudHJ5X3QgKm1z
cnMpOworaW50IHhjX3NldF9kb21haW5fY3B1X3BvbGljeSh4Y19pbnRlcmZhY2UgKnhjaCwgdWlu
dDMyX3QgZG9taWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IG5yX2xl
YXZlcywgeGVuX2NwdWlkX2xlYWZfdCAqbGVhdmVzLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50MzJfdCBucl9tc3JzLCB4ZW5fbXNyX2VudHJ5X3QgKm1zcnMsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICplcnJfbGVhZl9wLCB1aW50MzJfdCAqZXJyX3N1
YmxlYWZfcCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgKmVycl9tc3Jf
aWR4X3ApOwogCiB1aW50MzJfdCB4Y19nZXRfY3B1X2ZlYXR1cmVzZXRfc2l6ZSh2b2lkKTsKIApk
aWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfY3B1aWRfeDg2LmMgYi90b29scy9saWJ4Yy94Y19j
cHVpZF94ODYuYwppbmRleCBiODI5MzM2MDgyLi4zM2I5ZTlmYzg1IDEwMDY0NAotLS0gYS90b29s
cy9saWJ4Yy94Y19jcHVpZF94ODYuYworKysgYi90b29scy9saWJ4Yy94Y19jcHVpZF94ODYuYwpA
QCAtMjI5LDYgKzIyOSw1NSBAQCBpbnQgeGNfZ2V0X2RvbWFpbl9jcHVfcG9saWN5KHhjX2ludGVy
ZmFjZSAqeGNoLCB1aW50MzJfdCBkb21pZCwKICAgICByZXR1cm4gcmV0OwogfQogCitpbnQgeGNf
c2V0X2RvbWFpbl9jcHVfcG9saWN5KHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJfdCBkb21pZCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgbnJfbGVhdmVzLCB4ZW5fY3B1
aWRfbGVhZl90ICpsZWF2ZXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90
IG5yX21zcnMsIHhlbl9tc3JfZW50cnlfdCAqbXNycywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdWludDMyX3QgKmVycl9sZWFmX3AsIHVpbnQzMl90ICplcnJfc3VibGVhZl9wLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqZXJyX21zcl9pZHhfcCkKK3sKKyAg
ICBERUNMQVJFX0RPTUNUTDsKKyAgICBERUNMQVJFX0hZUEVSQ0FMTF9CT1VOQ0UobGVhdmVzLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucl9sZWF2ZXMgKiBzaXplb2YoKmxlYXZlcyks
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhDX0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNF
X0lOKTsKKyAgICBERUNMQVJFX0hZUEVSQ0FMTF9CT1VOQ0UobXNycywKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbnJfbXNycyAqIHNpemVvZigqbXNycyksCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFhDX0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNFX0lOKTsKKyAgICBpbnQgcmV0
OworCisgICAgaWYgKCB4Y19oeXBlcmNhbGxfYm91bmNlX3ByZSh4Y2gsIGxlYXZlcykgKQorICAg
ICAgICByZXR1cm4gLTE7CisKKyAgICBpZiAoIHhjX2h5cGVyY2FsbF9ib3VuY2VfcHJlKHhjaCwg
bXNycykgKQorICAgICAgICByZXR1cm4gLTE7CisKKyAgICBkb21jdGwuY21kID0gWEVOX0RPTUNU
TF9zZXRfY3B1X3BvbGljeTsKKyAgICBkb21jdGwuZG9tYWluID0gZG9taWQ7CisgICAgZG9tY3Rs
LnUuY3B1X3BvbGljeS5ucl9sZWF2ZXMgPSBucl9sZWF2ZXM7CisgICAgc2V0X3hlbl9ndWVzdF9o
YW5kbGUoZG9tY3RsLnUuY3B1X3BvbGljeS5jcHVpZF9wb2xpY3ksIGxlYXZlcyk7CisgICAgZG9t
Y3RsLnUuY3B1X3BvbGljeS5ucl9tc3JzID0gbnJfbXNyczsKKyAgICBzZXRfeGVuX2d1ZXN0X2hh
bmRsZShkb21jdGwudS5jcHVfcG9saWN5Lm1zcl9wb2xpY3ksIG1zcnMpOworICAgIGRvbWN0bC51
LmNwdV9wb2xpY3kuZXJyX2xlYWYgPSB+MDsKKyAgICBkb21jdGwudS5jcHVfcG9saWN5LmVycl9z
dWJsZWFmID0gfjA7CisgICAgZG9tY3RsLnUuY3B1X3BvbGljeS5lcnJfbXNyX2lkeCA9IH4wOwor
CisgICAgcmV0ID0gZG9fZG9tY3RsKHhjaCwgJmRvbWN0bCk7CisKKyAgICB4Y19oeXBlcmNhbGxf
Ym91bmNlX3Bvc3QoeGNoLCBsZWF2ZXMpOworICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4
Y2gsIG1zcnMpOworCisgICAgaWYgKCByZXQgKQorICAgIHsKKyAgICAgICAgaWYgKCBlcnJfbGVh
Zl9wICkKKyAgICAgICAgICAgICplcnJfbGVhZl9wID0gZG9tY3RsLnUuY3B1X3BvbGljeS5lcnJf
bGVhZjsKKyAgICAgICAgaWYgKCBlcnJfc3VibGVhZl9wICkKKyAgICAgICAgICAgICplcnJfc3Vi
bGVhZl9wID0gZG9tY3RsLnUuY3B1X3BvbGljeS5lcnJfc3VibGVhZjsKKyAgICAgICAgaWYgKCBl
cnJfbXNyX2lkeF9wICkKKyAgICAgICAgICAgICplcnJfbXNyX2lkeF9wID0gZG9tY3RsLnUuY3B1
X3BvbGljeS5lcnJfbXNyX2lkeDsKKyAgICB9CisKKyAgICByZXR1cm4gcmV0OworfQorCiBzdHJ1
Y3QgY3B1aWRfZG9tYWluX2luZm8KIHsKICAgICB1bnNpZ25lZCBpbnQgdmVuZG9yOyAvKiBYODZf
VkVORE9SXyogKi8KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9kb21jdGwuYyBiL3hlbi9hcmNo
L3g4Ni9kb21jdGwuYwppbmRleCBkMTVhZTA2NmMzLi45OWJjMmZiMTBkIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvZG9tY3RsLmMKKysrIGIveGVuL2FyY2gveDg2L2RvbWN0bC5jCkBAIC0yOTQs
NiArMjk0LDY1IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2RvbWFpbl9jcHVpZF9pbmZvKHN0cnVjdCBk
b21haW4gKmQsCiAgICAgcmV0dXJuIDA7CiB9CiAKK3N0YXRpYyBpbnQgdXBkYXRlX2RvbWFpbl9j
cHVfcG9saWN5KHN0cnVjdCBkb21haW4gKmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB4ZW5fZG9tY3RsX2NwdV9wb2xpY3lfdCAqeGRwYykKK3sKKyAgICBzdHJ1Y3QgY3B1
X3BvbGljeSBuZXcgPSB7fTsKKyAgICBjb25zdCBzdHJ1Y3QgY3B1X3BvbGljeSAqc3lzID0gaXNf
cHZfZG9tYWluKGQpCisgICAgICAgID8gJnN5c3RlbV9wb2xpY2llc1tYRU5fU1lTQ1RMX2NwdV9w
b2xpY3lfcHZfbWF4XQorICAgICAgICA6ICZzeXN0ZW1fcG9saWNpZXNbWEVOX1NZU0NUTF9jcHVf
cG9saWN5X2h2bV9tYXhdOworICAgIHN0cnVjdCBjcHVfcG9saWN5X2Vycm9ycyBlcnIgPSBJTklU
X0NQVV9QT0xJQ1lfRVJST1JTOworICAgIGludCByZXQgPSAtRU5PTUVNOworCisgICAgLyogU3Rh
cnQgYnkgY29weWluZyB0aGUgZG9tYWluJ3MgZXhpc3RpbmcgcG9saWNpZXMuICovCisgICAgaWYg
KCAhKG5ldy5jcHVpZCA9IHhtZW1kdXAoZC0+YXJjaC5jcHVpZCkpIHx8CisgICAgICAgICAhKG5l
dy5tc3IgICA9IHhtZW1kdXAoZC0+YXJjaC5tc3IpKSApCisgICAgICAgIGdvdG8gb3V0OworCisg
ICAgLyogTWVyZ2UgdGhlIHRvb2xzdGFjayBwcm92aWRlZCBkYXRhLiAqLworICAgIGlmICggKHJl
dCA9IHg4Nl9jcHVpZF9jb3B5X2Zyb21fYnVmZmVyKAorICAgICAgICAgICAgICBuZXcuY3B1aWQs
IHhkcGMtPmNwdWlkX3BvbGljeSwgeGRwYy0+bnJfbGVhdmVzLAorICAgICAgICAgICAgICAmZXJy
LmxlYWYsICZlcnIuc3VibGVhZikpIHx8CisgICAgICAgICAocmV0ID0geDg2X21zcl9jb3B5X2Zy
b21fYnVmZmVyKAorICAgICAgICAgICAgICBuZXcubXNyLCB4ZHBjLT5tc3JfcG9saWN5LCB4ZHBj
LT5ucl9tc3JzLCAmZXJyLm1zcikpICkKKyAgICAgICAgZ290byBvdXQ7CisKKyAgICAvKiBUcmlt
IGFueSBuZXdseS1zdGFsZSBvdXQtb2YtcmFuZ2UgbGVhdmVzLiAqLworICAgIHg4Nl9jcHVpZF9w
b2xpY3lfY2xlYXJfb3V0X29mX3JhbmdlX2xlYXZlcyhuZXcuY3B1aWQpOworCisgICAgLyogQXVk
aXQgdGhlIGNvbWJpbmVkIGRhdGFzZXQuICovCisgICAgcmV0ID0geDg2X2NwdV9wb2xpY2llc19h
cmVfY29tcGF0aWJsZShzeXMsICZuZXcsICZlcnIpOworICAgIGlmICggcmV0ICkKKyAgICAgICAg
Z290byBvdXQ7CisKKyAgICAvKgorICAgICAqIEF1ZGl0IHdhcyBzdWNjZXNzZnVsLiAgUmVwbGFj
ZSBleGlzdGluZyBwb2xpY2llcywgbGVhdmluZyB0aGUgb2xkCisgICAgICogcG9saWNpZXMgdG8g
YmUgZnJlZWQuCisgICAgICovCisgICAgU1dBUChuZXcuY3B1aWQsIGQtPmFyY2guY3B1aWQpOwor
ICAgIFNXQVAobmV3Lm1zciwgICBkLT5hcmNoLm1zcik7CisKKyAgICAvKiBUT0RPOiBEcm9wIHdo
ZW4geDg2X2NwdV9wb2xpY2llc19hcmVfY29tcGF0aWJsZSgpIGlzIGNvbXBsZXRlZC4gKi8KKyAg
ICByZWNhbGN1bGF0ZV9jcHVpZF9wb2xpY3koZCk7CisKKyAgICAvKiBSZWNhbGN1bGF0ZSByZWxl
dmFudCBkb20vdmNwdSBzdGF0ZSBub3cgdGhlIHBvbGljeSBoYXMgY2hhbmdlZC4gKi8KKyAgICBk
b21haW5fY3B1X3BvbGljeV9jaGFuZ2VkKGQpOworCisgb3V0OgorICAgIC8qIEZyZWUgd2hpY2hl
dmVyIGNwdWlkL21zciBzdHJ1Y3RzIGFyZSBub3QgaW5zdGFsbGVkIGluIHN0cnVjdCBkb21haW4u
ICovCisgICAgeGZyZWUobmV3LmNwdWlkKTsKKyAgICB4ZnJlZShuZXcubXNyKTsKKworICAgIGlm
ICggcmV0ICkKKyAgICB7CisgICAgICAgIHhkcGMtPmVycl9sZWFmICAgID0gZXJyLmxlYWY7Cisg
ICAgICAgIHhkcGMtPmVycl9zdWJsZWFmID0gZXJyLnN1YmxlYWY7CisgICAgICAgIHhkcGMtPmVy
cl9tc3JfaWR4ID0gZXJyLm1zcjsKKyAgICB9CisKKyAgICByZXR1cm4gcmV0OworfQorCiBzdGF0
aWMgaW50IHZjcHVfc2V0X3ZtY2Uoc3RydWN0IHZjcHUgKnYsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3Qgc3RydWN0IHhlbl9kb21jdGxfZXh0X3ZjcHVjb250ZXh0ICpldmMpCiB7CkBA
IC0xNDc2LDYgKzE1MzUsMjcgQEAgbG9uZyBhcmNoX2RvX2RvbWN0bCgKICAgICAgICAgY29weWJh
Y2sgPSB0cnVlOwogICAgICAgICBicmVhazsKIAorICAgIGNhc2UgWEVOX0RPTUNUTF9zZXRfY3B1
X3BvbGljeToKKyAgICAgICAgaWYgKCBkID09IGN1cnJkICkgLyogTm8gZG9tYWluX3BhdXNlKCkg
Ki8KKyAgICAgICAgeworICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKKyAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICB9CisKKyAgICAgICAgZG9tYWluX3BhdXNlKGQpOworCisgICAgICAgIGlm
ICggZC0+Y3JlYXRpb25fZmluaXNoZWQgKQorICAgICAgICAgICAgcmV0ID0gLUVFWElTVDsgLyog
Tm8gY2hhbmdpbmcgb25jZSB0aGUgZG9tYWluIGlzIHJ1bm5pbmcuICovCisgICAgICAgIGVsc2UK
KyAgICAgICAgeworICAgICAgICAgICAgcmV0ID0gdXBkYXRlX2RvbWFpbl9jcHVfcG9saWN5KGQs
ICZkb21jdGwtPnUuY3B1X3BvbGljeSk7CisgICAgICAgICAgICBpZiAoIHJldCApIC8qIENvcHkg
ZG9tY3RsLT51LmNwdV9wb2xpY3kuZXJyXyogdG8gZ3Vlc3QuICovCisgICAgICAgICAgICAgICAg
Y29weWJhY2sgPSB0cnVlOworICAgICAgICB9CisKKyAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7
CisgICAgICAgIGJyZWFrOworCiAgICAgZGVmYXVsdDoKICAgICAgICAgcmV0ID0gaW9tbXVfZG9f
ZG9tY3RsKGRvbWN0bCwgZCwgdV9kb21jdGwpOwogICAgICAgICBicmVhazsKZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL3B1YmxpYy9kb21jdGwuaCBiL3hlbi9pbmNsdWRlL3B1YmxpYy9kb21jdGwu
aAppbmRleCA3N2Y1NDZjYmI4Li4wNDcxZDNjNjgwIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9w
dWJsaWMvZG9tY3RsLmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL2RvbWN0bC5oCkBAIC02NTgs
MTcgKzY1OCwyMyBAQCBzdHJ1Y3QgeGVuX2RvbWN0bF9jcHVpZCB7CiB9OwogCiAvKgotICogWEVO
X0RPTUNUTF9nZXRfY3B1X3BvbGljeSAoeDg2IHNwZWNpZmljKQorICogWEVOX0RPTUNUTF97Z2V0
LHNldH1fY3B1X3BvbGljeSAoeDg2IHNwZWNpZmljKQogICoKLSAqIFF1ZXJ5IHRoZSBDUFVJRCBh
bmQgTVNSIHBvbGljaWVzIGZvciBhIHNwZWNpZmljIGRvbWFpbi4KKyAqIFF1ZXJ5IG9yIHNldCB0
aGUgQ1BVSUQgYW5kIE1TUiBwb2xpY2llcyBmb3IgYSBzcGVjaWZpYyBkb21haW4uCiAgKi8KIHN0
cnVjdCB4ZW5fZG9tY3RsX2NwdV9wb2xpY3kgewogICAgIHVpbnQzMl90IG5yX2xlYXZlczsgLyog
SU4vT1VUOiBOdW1iZXIgb2YgbGVhdmVzIGluL3dyaXR0ZW4gdG8KICAgICAgICAgICAgICAgICAg
ICAgICAgICAqICdjcHVpZF9wb2xpY3knLiAqLwogICAgIHVpbnQzMl90IG5yX21zcnM7ICAgLyog
SU4vT1VUOiBOdW1iZXIgb2YgTVNScyBpbi93cml0dGVuIHRvCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgKiAnbXNyX2RvbWFpbl9wb2xpY3knICovCi0gICAgWEVOX0dVRVNUX0hBTkRMRV82NCh4
ZW5fY3B1aWRfbGVhZl90KSBjcHVpZF9wb2xpY3k7IC8qIE9VVCAqLwotICAgIFhFTl9HVUVTVF9I
QU5ETEVfNjQoeGVuX21zcl9lbnRyeV90KSBtc3JfcG9saWN5OyAgICAvKiBPVVQgKi8KKyAgICBY
RU5fR1VFU1RfSEFORExFXzY0KHhlbl9jcHVpZF9sZWFmX3QpIGNwdWlkX3BvbGljeTsgLyogSU4v
T1VUICovCisgICAgWEVOX0dVRVNUX0hBTkRMRV82NCh4ZW5fbXNyX2VudHJ5X3QpIG1zcl9wb2xp
Y3k7ICAgIC8qIElOL09VVCAqLworICAgIHVpbnQzMl90IGVycl9sZWFmLCBlcnJfc3VibGVhZjsg
LyogT1VULCBzZXRfcG9saWN5IG9ubHkuICBJZiBub3QgfjAsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKiBpbmRpY2F0ZXMgdGhlIGxlYWYvc3VibGVhZiB3aGljaAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogYXVkaXRpbmcgb2JqZWN0ZWQgdG8u
ICovCisgICAgdWludDMyX3QgZXJyX21zcl9pZHg7ICAgICAgICAgICAvKiBPVVQsIHNldF9wb2xp
Y3kgb25seS4gIElmIG5vdCB+MCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAqIGluZGljYXRlcyB0aGUgTVNSIGlkeCB3aGljaAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICogYXVkaXRpbmcgb2JqZWN0ZWQgdG8uICovCiB9OwogdHlwZWRlZiBzdHJ1
Y3QgeGVuX2RvbWN0bF9jcHVfcG9saWN5IHhlbl9kb21jdGxfY3B1X3BvbGljeV90OwogREVGSU5F
X1hFTl9HVUVTVF9IQU5ETEUoeGVuX2RvbWN0bF9jcHVfcG9saWN5X3QpOwpAQCAtMTE5Myw2ICsx
MTk5LDcgQEAgc3RydWN0IHhlbl9kb21jdGwgewogLyogI2RlZmluZSBYRU5fRE9NQ1RMX3NldF9n
bnR0YWJfbGltaXRzICAgICAgICAgIDgwIC0gTW92ZWQgaW50byBYRU5fRE9NQ1RMX2NyZWF0ZWRv
bWFpbiAqLwogI2RlZmluZSBYRU5fRE9NQ1RMX3Z1YXJ0X29wICAgICAgICAgICAgICAgICAgICAg
IDgxCiAjZGVmaW5lIFhFTl9ET01DVExfZ2V0X2NwdV9wb2xpY3kgICAgICAgICAgICAgICAgODIK
KyNkZWZpbmUgWEVOX0RPTUNUTF9zZXRfY3B1X3BvbGljeSAgICAgICAgICAgICAgICA4MwogI2Rl
ZmluZSBYRU5fRE9NQ1RMX2dkYnN4X2d1ZXN0bWVtaW8gICAgICAgICAgICAxMDAwCiAjZGVmaW5l
IFhFTl9ET01DVExfZ2Ric3hfcGF1c2V2Y3B1ICAgICAgICAgICAgIDEwMDEKICNkZWZpbmUgWEVO
X0RPTUNUTF9nZGJzeF91bnBhdXNldmNwdSAgICAgICAgICAgMTAwMgpkaWZmIC0tZ2l0IGEveGVu
L3hzbS9mbGFzay9ob29rcy5jIGIveGVuL3hzbS9mbGFzay9ob29rcy5jCmluZGV4IDY4MDBmMmQ5
YTAuLmIyMzc3Mjc4NmEgMTAwNjQ0Ci0tLSBhL3hlbi94c20vZmxhc2svaG9va3MuYworKysgYi94
ZW4veHNtL2ZsYXNrL2hvb2tzLmMKQEAgLTcxNSw2ICs3MTUsNyBAQCBzdGF0aWMgaW50IGZsYXNr
X2RvbWN0bChzdHJ1Y3QgZG9tYWluICpkLCBpbnQgY21kKQogICAgIGNhc2UgWEVOX0RPTUNUTF9z
ZXRfdmlycV9oYW5kbGVyOgogICAgICAgICByZXR1cm4gY3VycmVudF9oYXNfcGVybShkLCBTRUND
TEFTU19ET01BSU4sIERPTUFJTl9fU0VUX1ZJUlFfSEFORExFUik7CiAKKyAgICBjYXNlIFhFTl9E
T01DVExfc2V0X2NwdV9wb2xpY3k6CiAgICAgY2FzZSBYRU5fRE9NQ1RMX3NldF9jcHVpZDoKICAg
ICAgICAgcmV0dXJuIGN1cnJlbnRfaGFzX3Blcm0oZCwgU0VDQ0xBU1NfRE9NQUlOMiwgRE9NQUlO
Ml9fU0VUX0NQVUlEKTsKIApkaWZmIC0tZ2l0IGEveGVuL3hzbS9mbGFzay9wb2xpY3kvYWNjZXNz
X3ZlY3RvcnMgYi94ZW4veHNtL2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVjdG9ycwppbmRleCA3NmYz
ZDYwZGRkLi42ZjNmOTQ5M2Y4IDEwMDY0NAotLS0gYS94ZW4veHNtL2ZsYXNrL3BvbGljeS9hY2Nl
c3NfdmVjdG9ycworKysgYi94ZW4veHNtL2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVjdG9ycwpAQCAt
MjA3LDYgKzIwNyw3IEBAIGNsYXNzIGRvbWFpbjIKICMgIHNvdXJjZSA9IHRoZSBkb21haW4gbWFr
aW5nIHRoZSBoeXBlcmNhbGwKICMgIHRhcmdldCA9IHRoZSBuZXcgdGFyZ2V0IGRvbWFpbgogICAg
IHNldF9hc190YXJnZXQKKyMgWEVOX0RPTUNUTF9zZXRfY3B1X3BvbGljeQogIyBYRU5fRE9NQ1RM
X3NldF9jcHVpZAogICAgIHNldF9jcHVpZAogIyBYRU5fRE9NQ1RMX2dldHRzY2luZm8KLS0gCjIu
MTEuMAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhl
bi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBz
Oi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

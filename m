Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 44E3C179199
	for <lists+xen-devel@lfdr.de>; Wed,  4 Mar 2020 14:42:16 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j9UFH-0006WJ-LP; Wed, 04 Mar 2020 13:39:31 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=FNX+=4V=yandex-team.ru=lekiravi@srs-us1.protection.inumbo.net>)
 id 1j9TkC-0003s5-8i
 for xen-devel@lists.xenproject.org; Wed, 04 Mar 2020 13:07:24 +0000
X-Inumbo-ID: 13f3c408-5e19-11ea-b74d-bc764e2007e4
Received: from forwardcorp1o.mail.yandex.net (unknown [95.108.205.193])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 13f3c408-5e19-11ea-b74d-bc764e2007e4;
 Wed, 04 Mar 2020 13:07:19 +0000 (UTC)
Received: from mxbackcorp2j.mail.yandex.net (mxbackcorp2j.mail.yandex.net
 [IPv6:2a02:6b8:0:1619::119])
 by forwardcorp1o.mail.yandex.net (Yandex) with ESMTP id 9A8E92E15E0;
 Wed,  4 Mar 2020 16:07:18 +0300 (MSK)
Received: from sas1-9998cec34266.qloud-c.yandex.net
 (sas1-9998cec34266.qloud-c.yandex.net [2a02:6b8:c14:3a0e:0:640:9998:cec3])
 by mxbackcorp2j.mail.yandex.net (mxbackcorp/Yandex) with ESMTP id
 2fG6wQovH6-7FJKVJLY; Wed, 04 Mar 2020 16:07:18 +0300
Precedence: bulk
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yandex-team.ru;
 s=default; 
 t=1583327238; bh=gUepq0ZgfyyamhXn5xaZHf5pGfLg8uSIGoLVfjf22Mg=;
 h=In-Reply-To:Message-Id:References:Date:Subject:To:From:Cc;
 b=okkyz1ijj5yer/sIh6PWpSqyfst9t0zVfS311Li2S3XsGYMR9tm1SDzuYCmhfpgcH
 p5yA8/hu2PWv4PF8O8Sb5fqWHdVg9/fqnYCZfzDLK8pTEX5gV/IrWTIIkTQxvRE2iM
 kJgr++NIDWri+8sM7lu0g1O6DqTNEBHc7zGA64wE=
Authentication-Results: mxbackcorp2j.mail.yandex.net;
 dkim=pass header.i=@yandex-team.ru
Received: from dynamic-red.dhcp.yndx.net (dynamic-red.dhcp.yndx.net
 [2a02:6b8:0:40c:b4f7:3f29:4fea:8822])
 by sas1-9998cec34266.qloud-c.yandex.net (smtpcorp/Yandex) with ESMTPSA id
 ujb0Gsh6CR-7EWOBUZD; Wed, 04 Mar 2020 16:07:15 +0300
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (Client certificate not present)
From: Alexey Kirillov <lekiravi@yandex-team.ru>
To: Eric Blake <eblake@redhat.com>, Thomas Huth <huth@tuxfamily.org>,
 Markus Armbruster <armbru@redhat.com>
Date: Wed,  4 Mar 2020 16:06:53 +0300
Message-Id: <20200304130656.16859-2-lekiravi@yandex-team.ru>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200304130656.16859-1-lekiravi@yandex-team.ru>
References: <20200304130656.16859-1-lekiravi@yandex-team.ru>
X-Mailman-Approved-At: Wed, 04 Mar 2020 13:39:29 +0000
Subject: [Xen-devel] [PATCH v2 1/4] qapi: net: Add query-netdevs command
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Peter Maydell <peter.maydell@linaro.org>,
 Dmitry Fleytman <dmitry.fleytman@gmail.com>,
 "Michael S. Tsirkin" <mst@redhat.com>, Jason Wang <jasowang@redhat.com>,
 qemu-devel@nongnu.org, Vincenzo Maffione <v.maffione@gmail.com>,
 Gerd Hoffmann <kraxel@redhat.com>,
 "Edgar E. Iglesias" <edgar.iglesias@gmail.com>,
 Sven Schnelle <svens@stackframe.org>, Rob Herring <robh@kernel.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Paul Durrant <paul@xen.org>,
 Joel Stanley <joel@jms.id.au>, Anthony Perard <anthony.perard@citrix.com>,
 Samuel Thibault <samuel.thibault@ens-lyon.org>,
 Aleksandar Rikalo <aleksandar.rikalo@rt-rk.com>,
 David Gibson <david@gibson.dropbear.id.au>,
 Laurent Vivier <lvivier@redhat.com>, Jiri Pirko <jiri@resnulli.us>,
 yc-core@yandex-team.ru, Stefan Weil <sw@weilnetz.de>,
 Alistair Francis <alistair@alistair23.me>,
 Beniamino Galvani <b.galvani@gmail.com>, qemu-arm@nongnu.org,
 Peter Chubb <peter.chubb@nicta.com.au>,
 =?UTF-8?q?C=C3=A9dric=20Le=20Goater?= <clg@kaod.org>,
 xen-devel@lists.xenproject.org, Giuseppe Lettieri <g.lettieri@iet.unipi.it>,
 Luigi Rizzo <rizzo@iet.unipi.it>, Richard Henderson <rth@twiddle.net>,
 Andrew Jeffery <andrew@aj.id.au>, Michael Walle <michael@walle.cc>,
 qemu-ppc@nongnu.org, Aleksandar Markovic <amarkovic@wavecomp.com>,
 Alexey Kirillov <lekiravi@yandex-team.ru>, Paolo Bonzini <pbonzini@redhat.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIGEgcW1wIGNvbW1hbmQgdGhhdCBwcm92aWRlcyBpbmZvcm1hdGlvbiBhYm91dCBjdXJyZW50
bHkgYXR0YWNoZWQKbmV0d29yayBkZXZpY2VzIGFuZCB0aGVpciBjb25maWd1cmF0aW9uLgoKU2ln
bmVkLW9mZi1ieTogQWxleGV5IEtpcmlsbG92IDxsZWtpcmF2aUB5YW5kZXgtdGVhbS5ydT4KLS0t
CiBpbmNsdWRlL25ldC9uZXQuaCB8ICAgMSArCiBuZXQvaHViLmMgICAgICAgICB8ICAgOCArKysK
IG5ldC9sMnRwdjMuYyAgICAgIHwgIDE5ICsrKysrKysKIG5ldC9uZXQuYyAgICAgICAgIHwgIDkx
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogbmV0L25ldG1hcC5jICAgICAgfCAg
MTMgKysrKysKIG5ldC9zbGlycC5jICAgICAgIHwgMTI2ICsrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysKIG5ldC9zb2NrZXQuYyAgICAgIHwgIDcxICsrKysrKysr
KysrKysrKysrKysrKysrKysrCiBuZXQvdGFwLXdpbjMyLmMgICB8ICAgOSArKysrCiBuZXQvdGFw
LmMgICAgICAgICB8IDEwMyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiBu
ZXQvdmRlLmMgICAgICAgICB8ICAyNiArKysrKysrKysrCiBuZXQvdmhvc3QtdXNlci5jICB8ICAx
OCArKysrKy0tCiBxYXBpL25ldC5qc29uICAgICB8ICA4OSArKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKwogMTIgZmlsZXMgY2hhbmdlZCwgNTY2IGluc2VydGlvbnMoKyksIDggZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9uZXQvbmV0LmggYi9pbmNsdWRlL25ldC9uZXQu
aAppbmRleCBlMTc1YmE5Njc3Li4yYzg5NTZjMGIzIDEwMDY0NAotLS0gYS9pbmNsdWRlL25ldC9u
ZXQuaAorKysgYi9pbmNsdWRlL25ldC9uZXQuaApAQCAtOTIsNiArOTIsNyBAQCBzdHJ1Y3QgTmV0
Q2xpZW50U3RhdGUgewogICAgIGNoYXIgKm1vZGVsOwogICAgIGNoYXIgKm5hbWU7CiAgICAgY2hh
ciBpbmZvX3N0clsyNTZdOworICAgIE5ldGRldkluZm8gKnN0b3JlZF9jb25maWc7CiAgICAgdW5z
aWduZWQgcmVjZWl2ZV9kaXNhYmxlZCA6IDE7CiAgICAgTmV0Q2xpZW50RGVzdHJ1Y3RvciAqZGVz
dHJ1Y3RvcjsKICAgICB1bnNpZ25lZCBpbnQgcXVldWVfaW5kZXg7CmRpZmYgLS1naXQgYS9uZXQv
aHViLmMgYi9uZXQvaHViLmMKaW5kZXggNTc5NWE2NzhlZC4uMzc5OTViNTUxNyAxMDA2NDQKLS0t
IGEvbmV0L2h1Yi5jCisrKyBiL25ldC9odWIuYwpAQCAtMTQ4LDYgKzE0OCw3IEBAIHN0YXRpYyBO
ZXRIdWJQb3J0ICpuZXRfaHViX3BvcnRfbmV3KE5ldEh1YiAqaHViLCBjb25zdCBjaGFyICpuYW1l
LAogICAgIE5ldEh1YlBvcnQgKnBvcnQ7CiAgICAgaW50IGlkID0gaHViLT5udW1fcG9ydHMrKzsK
ICAgICBjaGFyIGRlZmF1bHRfbmFtZVsxMjhdOworICAgIE5ldGRldkh1YlBvcnRPcHRpb25zICpz
dG9yZWQ7CiAKICAgICBpZiAoIW5hbWUpIHsKICAgICAgICAgc25wcmludGYoZGVmYXVsdF9uYW1l
LCBzaXplb2YoZGVmYXVsdF9uYW1lKSwKQEAgLTE2MCw2ICsxNjEsMTMgQEAgc3RhdGljIE5ldEh1
YlBvcnQgKm5ldF9odWJfcG9ydF9uZXcoTmV0SHViICpodWIsIGNvbnN0IGNoYXIgKm5hbWUsCiAg
ICAgcG9ydC0+aWQgPSBpZDsKICAgICBwb3J0LT5odWIgPSBodWI7CiAKKyAgICAvKiBTdG9yZSBz
dGFydHVwIHBhcmFtZXRlcnMgKi8KKyAgICBuYy0+c3RvcmVkX2NvbmZpZyA9IGdfbmV3MChOZXRk
ZXZJbmZvLCAxKTsKKyAgICBuYy0+c3RvcmVkX2NvbmZpZy0+dHlwZSA9IE5FVF9DTElFTlRfRFJJ
VkVSX0hVQlBPUlQ7CisgICAgc3RvcmVkID0gJm5jLT5zdG9yZWRfY29uZmlnLT51Lmh1YnBvcnQ7
CisKKyAgICBzdG9yZWQtPmh1YmlkID0gaHViLT5pZDsKKwogICAgIFFMSVNUX0lOU0VSVF9IRUFE
KCZodWItPnBvcnRzLCBwb3J0LCBuZXh0KTsKIAogICAgIHJldHVybiBwb3J0OwpkaWZmIC0tZ2l0
IGEvbmV0L2wydHB2My5jIGIvbmV0L2wydHB2My5jCmluZGV4IDU1ZmVhMTdjMGYuLmY0ZTQ1ZTdi
MjggMTAwNjQ0Ci0tLSBhL25ldC9sMnRwdjMuYworKysgYi9uZXQvbDJ0cHYzLmMKQEAgLTUzNSw2
ICs1MzUsNyBAQCBpbnQgbmV0X2luaXRfbDJ0cHYzKGNvbnN0IE5ldGRldiAqbmV0ZGV2LAogICAg
IHN0cnVjdCBhZGRyaW5mbyBoaW50czsKICAgICBzdHJ1Y3QgYWRkcmluZm8gKnJlc3VsdCA9IE5V
TEw7CiAgICAgY2hhciAqc3JjcG9ydCwgKmRzdHBvcnQ7CisgICAgTmV0ZGV2TDJUUHYzT3B0aW9u
cyAqc3RvcmVkOwogCiAgICAgbmMgPSBxZW11X25ld19uZXRfY2xpZW50KCZuZXRfbDJ0cHYzX2lu
Zm8sIHBlZXIsICJsMnRwdjMiLCBuYW1lKTsKIApAQCAtNzI2LDYgKzcyNywyNCBAQCBpbnQgbmV0
X2luaXRfbDJ0cHYzKGNvbnN0IE5ldGRldiAqbmV0ZGV2LAogCiAgICAgbDJ0cHYzX3JlYWRfcG9s
bChzLCB0cnVlKTsKIAorICAgIC8qIFN0b3JlIHN0YXJ0dXAgcGFyYW1ldGVycyAqLworICAgIG5j
LT5zdG9yZWRfY29uZmlnID0gZ19uZXcwKE5ldGRldkluZm8sIDEpOworICAgIG5jLT5zdG9yZWRf
Y29uZmlnLT50eXBlID0gTkVUX0NMSUVOVF9EUklWRVJfTDJUUFYzOworICAgIHN0b3JlZCA9ICZu
Yy0+c3RvcmVkX2NvbmZpZy0+dS5sMnRwdjM7CisKKyAgICBtZW1jcHkoc3RvcmVkLCBsMnRwdjMs
IHNpemVvZihOZXRkZXZMMlRQdjNPcHRpb25zKSk7CisKKyAgICBzdG9yZWQtPnNyYyA9IGdfc3Ry
ZHVwKGwydHB2My0+c3JjKTsKKyAgICBzdG9yZWQtPmRzdCA9IGdfc3RyZHVwKGwydHB2My0+ZHN0
KTsKKworICAgIGlmIChsMnRwdjMtPmhhc19zcmNwb3J0KSB7CisgICAgICAgIHN0b3JlZC0+c3Jj
cG9ydCA9IGdfc3RyZHVwKGwydHB2My0+c3JjcG9ydCk7CisgICAgfQorCisgICAgaWYgKGwydHB2
My0+aGFzX2RzdHBvcnQpIHsKKyAgICAgICAgc3RvcmVkLT5kc3Rwb3J0ID0gZ19zdHJkdXAobDJ0
cHYzLT5kc3Rwb3J0KTsKKyAgICB9CisKICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwgc2l6
ZW9mKHMtPm5jLmluZm9fc3RyKSwKICAgICAgICAgICAgICAibDJ0cHYzOiBjb25uZWN0ZWQiKTsK
ICAgICByZXR1cm4gMDsKZGlmZiAtLWdpdCBhL25ldC9uZXQuYyBiL25ldC9uZXQuYwppbmRleCA5
ZTkzYzNmOGExLi4wMWUwNTQ4Mjk1IDEwMDY0NAotLS0gYS9uZXQvbmV0LmMKKysrIGIvbmV0L25l
dC5jCkBAIC01NCw2ICs1NCw3IEBACiAjaW5jbHVkZSAic3lzZW11L3N5c2VtdS5oIgogI2luY2x1
ZGUgIm5ldC9maWx0ZXIuaCIKICNpbmNsdWRlICJxYXBpL3N0cmluZy1vdXRwdXQtdmlzaXRvci5o
IgorI2luY2x1ZGUgInFhcGkvY2xvbmUtdmlzaXRvci5oIgogCiAvKiBOZXQgYnJpZGdlIGlzIGN1
cnJlbnRseSBub3Qgc3VwcG9ydGVkIGZvciBXMzIuICovCiAjaWYgIWRlZmluZWQoX1dJTjMyKQpA
QCAtMTI4LDYgKzEyOSwxMiBAQCBjaGFyICpxZW11X21hY19zdHJkdXBfcHJpbnRmKGNvbnN0IHVp
bnQ4X3QgKm1hY2FkZHIpCiAKIHZvaWQgcWVtdV9mb3JtYXRfbmljX2luZm9fc3RyKE5ldENsaWVu
dFN0YXRlICpuYywgdWludDhfdCBtYWNhZGRyWzZdKQogeworICAgIGdfYXNzZXJ0KG5jLT5zdG9y
ZWRfY29uZmlnKTsKKworICAgIGdfZnJlZShuYy0+c3RvcmVkX2NvbmZpZy0+dS5uaWMubWFjYWRk
cik7CisgICAgbmMtPnN0b3JlZF9jb25maWctPnUubmljLm1hY2FkZHIgPSBnX3N0cmR1cF9wcmlu
dGYoTUFDX0ZNVCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBNQUNfQVJHKG1hY2FkZHIpKTsKKwogICAgIHNucHJpbnRmKG5jLT5pbmZvX3N0
ciwgc2l6ZW9mKG5jLT5pbmZvX3N0ciksCiAgICAgICAgICAgICAgIm1vZGVsPSVzLG1hY2FkZHI9
JTAyeDolMDJ4OiUwMng6JTAyeDolMDJ4OiUwMngiLAogICAgICAgICAgICAgIG5jLT5tb2RlbCwK
QEAgLTI4Myw2ICsyOTAsNyBAQCBOSUNTdGF0ZSAqcWVtdV9uZXdfbmljKE5ldENsaWVudEluZm8g
KmluZm8sCiAgICAgTmV0Q2xpZW50U3RhdGUgKipwZWVycyA9IGNvbmYtPnBlZXJzLm5jczsKICAg
ICBOSUNTdGF0ZSAqbmljOwogICAgIGludCBpLCBxdWV1ZXMgPSBNQVgoMSwgY29uZi0+cGVlcnMu
cXVldWVzKTsKKyAgICBOZXRMZWdhY3lOaWNPcHRpb25zICpzdG9yZWQ7CiAKICAgICBhc3NlcnQo
aW5mby0+dHlwZSA9PSBORVRfQ0xJRU5UX0RSSVZFUl9OSUMpOwogICAgIGFzc2VydChpbmZvLT5z
aXplID49IHNpemVvZihOSUNTdGF0ZSkpOwpAQCAtMjk4LDYgKzMwNiwyNyBAQCBOSUNTdGF0ZSAq
cWVtdV9uZXdfbmljKE5ldENsaWVudEluZm8gKmluZm8sCiAgICAgICAgIG5pYy0+bmNzW2ldLnF1
ZXVlX2luZGV4ID0gaTsKICAgICB9CiAKKyAgICAvKiBTdG9yZSBzdGFydHVwIHBhcmFtZXRlcnMg
Ki8KKyAgICBuaWMtPm5jc1swXS5zdG9yZWRfY29uZmlnID0gZ19uZXcwKE5ldGRldkluZm8sIDEp
OworICAgIG5pYy0+bmNzWzBdLnN0b3JlZF9jb25maWctPnR5cGUgPSBORVRfQ0xJRU5UX0RSSVZF
Ul9OSUM7CisgICAgc3RvcmVkID0gJm5pYy0+bmNzWzBdLnN0b3JlZF9jb25maWctPnUubmljOwor
CisgICAgLyogUmVhZC1vbmx5IGluIHJ1bnRpbWUgKi8KKyAgICBuaWMtPm5jc1swXS5zdG9yZWRf
Y29uZmlnLT5oYXNfcGVybV9tYWMgPSB0cnVlOworICAgIG5pYy0+bmNzWzBdLnN0b3JlZF9jb25m
aWctPnBlcm1fbWFjID0gZ19zdHJkdXBfcHJpbnRmKE1BQ19GTVQsCisgICAgICAgIE1BQ19BUkco
Y29uZi0+bWFjYWRkci5hKSk7CisKKyAgICBpZiAocGVlcnNbMF0pIHsKKyAgICAgICAgc3RvcmVk
LT5oYXNfbmV0ZGV2ID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5uZXRkZXYgPSBnX3N0cmR1cChw
ZWVyc1swXS0+bmFtZSk7CisgICAgfQorCisgICAgc3RvcmVkLT5oYXNfbWFjYWRkciA9IHRydWU7
CisgICAgc3RvcmVkLT5tYWNhZGRyID0gZ19zdHJkdXBfcHJpbnRmKE1BQ19GTVQsIE1BQ19BUkco
Y29uZi0+bWFjYWRkci5hKSk7CisKKyAgICBzdG9yZWQtPmhhc19tb2RlbCA9IHRydWU7CisgICAg
c3RvcmVkLT5tb2RlbCA9IGdfc3RyZHVwKG1vZGVsKTsKKwogICAgIHJldHVybiBuaWM7CiB9CiAK
QEAgLTM0NCw2ICszNzMsNyBAQCBzdGF0aWMgdm9pZCBxZW11X2ZyZWVfbmV0X2NsaWVudChOZXRD
bGllbnRTdGF0ZSAqbmMpCiAgICAgfQogICAgIGdfZnJlZShuYy0+bmFtZSk7CiAgICAgZ19mcmVl
KG5jLT5tb2RlbCk7CisgICAgcWFwaV9mcmVlX05ldGRldkluZm8obmMtPnN0b3JlZF9jb25maWcp
OwogICAgIGlmIChuYy0+ZGVzdHJ1Y3RvcikgewogICAgICAgICBuYy0+ZGVzdHJ1Y3RvcihuYyk7
CiAgICAgfQpAQCAtMTMyMCw2ICsxMzUwLDY3IEBAIFJ4RmlsdGVySW5mb0xpc3QgKnFtcF9xdWVy
eV9yeF9maWx0ZXIoYm9vbCBoYXNfbmFtZSwgY29uc3QgY2hhciAqbmFtZSwKICAgICByZXR1cm4g
ZmlsdGVyX2xpc3Q7CiB9CiAKK05ldGRldkluZm9MaXN0ICpxbXBfcXVlcnlfbmV0ZGV2cyhFcnJv
ciAqKmVycnApCit7CisgICAgTmV0ZGV2SW5mb0xpc3QgKmxpc3QgPSBOVUxMOworICAgIE5ldENs
aWVudFN0YXRlICpuYzsKKworICAgIFFUQUlMUV9GT1JFQUNIKG5jLCAmbmV0X2NsaWVudHMsIG5l
eHQpIHsKKyAgICAgICAgLyogT25seSBsb29rIGF0IG5ldGRldnMsIG5vdCBmb3IgZWFjaCBxdWV1
ZSAqLworICAgICAgICBpZiAobmMtPnN0b3JlZF9jb25maWcpIHsKKyAgICAgICAgICAgIE5ldGRl
dkluZm9MaXN0ICpub2RlID0gZ19uZXcwKE5ldGRldkluZm9MaXN0LCAxKTsKKworICAgICAgICAg
ICAgbm9kZS0+dmFsdWUgPSBRQVBJX0NMT05FKE5ldGRldkluZm8sIG5jLT5zdG9yZWRfY29uZmln
KTsKKyAgICAgICAgICAgIGdfZnJlZShub2RlLT52YWx1ZS0+aWQpOyAvKiBOZWVkIHRvIGRlYWxs
b2MgZGVmYXVsdCBlbXB0eSBpZCAqLworICAgICAgICAgICAgbm9kZS0+dmFsdWUtPmlkID0gZ19z
dHJkdXAobmMtPm5hbWUpOworCisgICAgICAgICAgICBpZiAobmMtPmluZm8tPnR5cGUgPT0gTkVU
X0NMSUVOVF9EUklWRVJfTklDKSB7CisgICAgICAgICAgICAgICAgTklDU3RhdGUgKnN0YXRlID0g
cWVtdV9nZXRfbmljKG5jKTsKKyAgICAgICAgICAgICAgICBhc3NlcnQoc3RhdGUpOworCisgICAg
ICAgICAgICAgICAgLyogTklDIGhhdmUgZXhwbGljaXQgbnVtYmVyIG9mIHF1ZXVlcyAqLworICAg
ICAgICAgICAgICAgIGFzc2VydChzdGF0ZS0+Y29uZik7CisgICAgICAgICAgICAgICAgbm9kZS0+
dmFsdWUtPnF1ZXVlc19jb3VudCA9IHN0YXRlLT5jb25mLT5wZWVycy5xdWV1ZXM7CisgICAgICAg
ICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIC8qIE5vdCBhIE5JQywgYnV0IGNhbiBoYXZl
IHF1ZXVlcyAqLworICAgICAgICAgICAgICAgIE5ldENsaWVudFN0YXRlICpuY19pdGVyYWJsZTsK
KworICAgICAgICAgICAgICAgIFFUQUlMUV9GT1JFQUNIKG5jX2l0ZXJhYmxlLCAmbmV0X2NsaWVu
dHMsIG5leHQpIHsKKyAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmNtcChuY19pdGVyYWJsZS0+
bmFtZSwgbmMtPm5hbWUpID09IDApIHsKKyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUtPnZh
bHVlLT5xdWV1ZXNfY291bnQrKzsKKyAgICAgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAg
ICAgIH0KKyAgICAgICAgICAgIH0KKworICAgICAgICAgICAgbm9kZS0+dmFsdWUtPmhhc19wZWVy
ID0gbmMtPnBlZXIgIT0gTlVMTDsKKyAgICAgICAgICAgIGlmIChub2RlLT52YWx1ZS0+aGFzX3Bl
ZXIpIHsKKyAgICAgICAgICAgICAgICBub2RlLT52YWx1ZS0+cGVlciA9IGdfc3RyZHVwKG5jLT5w
ZWVyLT5uYW1lKTsKKyAgICAgICAgICAgIH0KKworICAgICAgICAgICAgbm9kZS0+dmFsdWUtPmhh
c19odWIgPQorICAgICAgICAgICAgICAgIG5ldF9odWJfaWRfZm9yX2NsaWVudChuYywgKGludCAq
KSZub2RlLT52YWx1ZS0+aHViKSA9PSAwOworCisgICAgICAgICAgICAvKgorICAgICAgICAgICAg
ICogQ29weSB0aGUgY3VycmVudCBodWJwb3J0IHBlZXIgaWQgdG8gY29ubmVjdGVkIG5ldGRldiBp
ZCwKKyAgICAgICAgICAgICAqIGJlY2F1c2UgaXQgY291bGQgaGF2ZSBiZWVuIGNoYW5nZWQgYXQg
cnVudGltZQorICAgICAgICAgICAgICovCisgICAgICAgICAgICBpZiAobmMtPmluZm8tPnR5cGUg
PT0gTkVUX0NMSUVOVF9EUklWRVJfSFVCUE9SVCkgeworICAgICAgICAgICAgICAgIGlmIChub2Rl
LT52YWx1ZS0+aGFzX3BlZXIpIHsKKyAgICAgICAgICAgICAgICAgICAgZ19mcmVlKG5vZGUtPnZh
bHVlLT51Lmh1YnBvcnQubmV0ZGV2KTsKKworICAgICAgICAgICAgICAgICAgICBub2RlLT52YWx1
ZS0+dS5odWJwb3J0Lmhhc19uZXRkZXYgPSB0cnVlOworICAgICAgICAgICAgICAgICAgICBub2Rl
LT52YWx1ZS0+dS5odWJwb3J0Lm5ldGRldiA9IGdfc3RyZHVwKG5jLT5wZWVyLT5uYW1lKTsKKyAg
ICAgICAgICAgICAgICB9CisgICAgICAgICAgICB9CisKKyAgICAgICAgICAgIG5vZGUtPm5leHQg
PSBsaXN0OworICAgICAgICAgICAgbGlzdCA9IG5vZGU7CisgICAgICAgIH0KKyAgICB9CisKKyAg
ICByZXR1cm4gbGlzdDsKK30KKwogdm9pZCBobXBfaW5mb19uZXR3b3JrKE1vbml0b3IgKm1vbiwg
Y29uc3QgUURpY3QgKnFkaWN0KQogewogICAgIE5ldENsaWVudFN0YXRlICpuYywgKnBlZXI7CmRp
ZmYgLS1naXQgYS9uZXQvbmV0bWFwLmMgYi9uZXQvbmV0bWFwLmMKaW5kZXggMzUwZjA5N2Y5MS4u
NzFmZWFjYjkyYyAxMDA2NDQKLS0tIGEvbmV0L25ldG1hcC5jCisrKyBiL25ldC9uZXRtYXAuYwpA
QCAtNDExLDYgKzQxMSw3IEBAIGludCBuZXRfaW5pdF9uZXRtYXAoY29uc3QgTmV0ZGV2ICpuZXRk
ZXYsCiAgICAgTmV0Q2xpZW50U3RhdGUgKm5jOwogICAgIEVycm9yICplcnIgPSBOVUxMOwogICAg
IE5ldG1hcFN0YXRlICpzOworICAgIE5ldGRldk5ldG1hcE9wdGlvbnMgKnN0b3JlZDsKIAogICAg
IG5tZCA9IG5ldG1hcF9vcGVuKG5ldG1hcF9vcHRzLCAmZXJyKTsKICAgICBpZiAoZXJyKSB7CkBA
IC00MjcsNiArNDI4LDE4IEBAIGludCBuZXRfaW5pdF9uZXRtYXAoY29uc3QgTmV0ZGV2ICpuZXRk
ZXYsCiAgICAgcHN0cmNweShzLT5pZm5hbWUsIHNpemVvZihzLT5pZm5hbWUpLCBuZXRtYXBfb3B0
cy0+aWZuYW1lKTsKICAgICBuZXRtYXBfcmVhZF9wb2xsKHMsIHRydWUpOyAvKiBJbml0aWFsbHkg
b25seSBwb2xsIGZvciByZWFkcy4gKi8KIAorICAgIC8qIFN0b3JlIHN0YXJ0dXAgcGFyYW1ldGVy
cyAqLworICAgIG5jLT5zdG9yZWRfY29uZmlnID0gZ19uZXcwKE5ldGRldkluZm8sIDEpOworICAg
IG5jLT5zdG9yZWRfY29uZmlnLT50eXBlID0gTkVUX0NMSUVOVF9EUklWRVJfTkVUTUFQOworICAg
IHN0b3JlZCA9ICZuYy0+c3RvcmVkX2NvbmZpZy0+dS5uZXRtYXA7CisKKyAgICBzdG9yZWQtPmlm
bmFtZSA9IGdfc3RyZHVwKG5ldG1hcF9vcHRzLT5pZm5hbWUpOworCisgICAgaWYgKG5ldG1hcF9v
cHRzLT5oYXNfZGV2bmFtZSkgeworICAgICAgICBzdG9yZWQtPmhhc19kZXZuYW1lID0gdHJ1ZTsK
KyAgICAgICAgc3RvcmVkLT5kZXZuYW1lID0gZ19zdHJkdXAobmV0bWFwX29wdHMtPmRldm5hbWUp
OworICAgIH0KKwogICAgIHJldHVybiAwOwogfQogCmRpZmYgLS1naXQgYS9uZXQvc2xpcnAuYyBi
L25ldC9zbGlycC5jCmluZGV4IGM0MzM0ZWU4NzYuLmZiNWI4N2ViZWQgMTAwNjQ0Ci0tLSBhL25l
dC9zbGlycC5jCisrKyBiL25ldC9zbGlycC5jCkBAIC0zNDYsNiArMzQ2LDE0IEBAIHN0YXRpYyBT
YXZlVk1IYW5kbGVycyBzYXZldm1fc2xpcnBfc3RhdGUgPSB7CiAgICAgLmxvYWRfc3RhdGUgPSBu
ZXRfc2xpcnBfc3RhdGVfbG9hZCwKIH07CiAKKyNkZWZpbmUgQVBQRU5EX1NUUklOR0xJU1QodGFp
bCwgbmV3X3ZhbCkgXAorICAgIGRvIHsgXAorICAgICAgICAqKHRhaWwpID0gZ19uZXcwKFN0cmlu
Z0xpc3QsIDEpOyBcCisgICAgICAgICgqKHRhaWwpKS0+dmFsdWUgPSBnX25ldzAoU3RyaW5nLCAx
KTsgXAorICAgICAgICAoKih0YWlsKSktPnZhbHVlLT5zdHIgPSBnX3N0cmR1cCgobmV3X3ZhbCkp
OyBcCisgICAgICAgICh0YWlsKSA9ICYoKCoodGFpbCkpLT5uZXh0KTsgXAorICAgIH0gd2hpbGUg
KDApCisKIHN0YXRpYyBpbnQgbmV0X3NsaXJwX2luaXQoTmV0Q2xpZW50U3RhdGUgKnBlZXIsIGNv
bnN0IGNoYXIgKm1vZGVsLAogICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpu
YW1lLCBpbnQgcmVzdHJpY3RlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBpcHY0
LCBjb25zdCBjaGFyICp2bmV0d29yaywgY29uc3QgY2hhciAqdmhvc3QsCkBAIC0zNzgsNiArMzg2
LDkgQEAgc3RhdGljIGludCBuZXRfc2xpcnBfaW5pdChOZXRDbGllbnRTdGF0ZSAqcGVlciwgY29u
c3QgY2hhciAqbW9kZWwsCiAgICAgaW50IHNoaWZ0OwogICAgIGNoYXIgKmVuZDsKICAgICBzdHJ1
Y3Qgc2xpcnBfY29uZmlnX3N0ciAqY29uZmlnOworICAgIE5ldGRldlVzZXJPcHRpb25zICpzdG9y
ZWQ7CisgICAgU3RyaW5nTGlzdCAqKnN0b3JlZF9ob3N0ZndkOworICAgIFN0cmluZ0xpc3QgKipz
dG9yZWRfZ3Vlc3Rmd2Q7CiAKICAgICBpZiAoIWlwdjQgJiYgKHZuZXR3b3JrIHx8IHZob3N0IHx8
IHZuYW1lc2VydmVyKSkgewogICAgICAgICBlcnJvcl9zZXRnKGVycnAsICJJUHY0IGRpc2FibGVk
IGJ1dCBuZXRtYXNrL2hvc3QvZG5zIHByb3ZpZGVkIik7CkBAIC01NTMsNiArNTY0LDExMiBAQCBz
dGF0aWMgaW50IG5ldF9zbGlycF9pbml0KE5ldENsaWVudFN0YXRlICpwZWVyLCBjb25zdCBjaGFy
ICptb2RlbCwKIAogICAgIG5jID0gcWVtdV9uZXdfbmV0X2NsaWVudCgmbmV0X3NsaXJwX2luZm8s
IHBlZXIsIG1vZGVsLCBuYW1lKTsKIAorICAgIC8qIFN0b3JlIHN0YXJ0dXAgcGFyYW1ldGVycyAq
LworICAgIG5jLT5zdG9yZWRfY29uZmlnID0gZ19uZXcwKE5ldGRldkluZm8sIDEpOworICAgIG5j
LT5zdG9yZWRfY29uZmlnLT50eXBlID0gTkVUX0NMSUVOVF9EUklWRVJfVVNFUjsKKyAgICBzdG9y
ZWQgPSAmbmMtPnN0b3JlZF9jb25maWctPnUudXNlcjsKKworICAgIGlmICh2aG9zdG5hbWUpIHsK
KyAgICAgICAgc3RvcmVkLT5oYXNfaG9zdG5hbWUgPSB0cnVlOworICAgICAgICBzdG9yZWQtPmhv
c3RuYW1lID0gZ19zdHJkdXAodmhvc3RuYW1lKTsKKyAgICB9CisKKyAgICBzdG9yZWQtPmhhc19x
X3Jlc3RyaWN0ID0gdHJ1ZTsKKyAgICBzdG9yZWQtPnFfcmVzdHJpY3QgPSByZXN0cmljdGVkOwor
CisgICAgc3RvcmVkLT5oYXNfaXB2NCA9IHRydWU7CisgICAgc3RvcmVkLT5pcHY0ID0gaXB2NDsK
KworICAgIHN0b3JlZC0+aGFzX2lwdjYgPSB0cnVlOworICAgIHN0b3JlZC0+aXB2NiA9IGlwdjY7
CisKKyAgICBpZiAoaXB2NCkgeworICAgICAgICB1aW50OF90ICpuZXRfYnl0ZXMgPSAodWludDhf
dCAqKSZuZXQ7CisgICAgICAgIHVpbnQ4X3QgKm1hc2tfYnl0ZXMgPSAodWludDhfdCAqKSZtYXNr
OworCisgICAgICAgIHN0b3JlZC0+aGFzX25ldCA9IHRydWU7CisgICAgICAgIHN0b3JlZC0+bmV0
ID0gZ19zdHJkdXBfcHJpbnRmKCIlZC4lZC4lZC4lZC8lZC4lZC4lZC4lZCIsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldF9ieXRlc1swXSwgbmV0X2J5dGVzWzFdLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRfYnl0ZXNbMl0sIG5ldF9i
eXRlc1szXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFza19ieXRl
c1swXSwgbWFza19ieXRlc1sxXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWFza19ieXRlc1syXSwgbWFza19ieXRlc1szXSk7CisKKyAgICAgICAgc3RvcmVkLT5oYXNf
aG9zdCA9IHRydWU7CisgICAgICAgIHN0b3JlZC0+aG9zdCA9IGdfc3RyZHVwKGluZXRfbnRvYSho
b3N0KSk7CisgICAgfQorCisgICAgaWYgKHRmdHBfZXhwb3J0KSB7CisgICAgICAgIHN0b3JlZC0+
aGFzX3RmdHAgPSB0cnVlOworICAgICAgICBzdG9yZWQtPnRmdHAgPSBnX3N0cmR1cCh0ZnRwX2V4
cG9ydCk7CisgICAgfQorCisgICAgaWYgKGJvb3RmaWxlKSB7CisgICAgICAgIHN0b3JlZC0+aGFz
X2Jvb3RmaWxlID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5ib290ZmlsZSA9IGdfc3RyZHVwKGJv
b3RmaWxlKTsKKyAgICB9CisKKyAgICBpZiAodmRoY3Bfc3RhcnQpIHsKKyAgICAgICAgc3RvcmVk
LT5oYXNfZGhjcHN0YXJ0ID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5kaGNwc3RhcnQgPSBnX3N0
cmR1cCh2ZGhjcF9zdGFydCk7CisgICAgfQorCisgICAgaWYgKGlwdjQpIHsKKyAgICAgICAgc3Rv
cmVkLT5oYXNfZG5zID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5kbnMgPSBnX3N0cmR1cChpbmV0
X250b2EoZG5zKSk7CisgICAgfQorCisgICAgaWYgKGRuc3NlYXJjaCkgeworICAgICAgICBzdG9y
ZWQtPmhhc19kbnNzZWFyY2ggPSB0cnVlOworICAgICAgICBTdHJpbmdMaXN0ICoqc3RvcmVkX2xp
c3QgPSAmc3RvcmVkLT5kbnNzZWFyY2g7CisKKyAgICAgICAgZm9yIChpbnQgaSA9IDA7IGRuc3Nl
YXJjaFtpXTsgaSsrKSB7CisgICAgICAgICAgICBBUFBFTkRfU1RSSU5HTElTVChzdG9yZWRfbGlz
dCwgZG5zc2VhcmNoW2ldKTsKKyAgICAgICAgfQorICAgIH0KKworICAgIGlmICh2ZG9tYWlubmFt
ZSkgeworICAgICAgICBzdG9yZWQtPmhhc19kb21haW5uYW1lID0gdHJ1ZTsKKyAgICAgICAgc3Rv
cmVkLT5kb21haW5uYW1lID0gZ19zdHJkdXAodmRvbWFpbm5hbWUpOworICAgIH0KKworICAgIGlm
IChpcHY2KSB7CisgICAgICAgIGNoYXIgYWRkcnN0cltJTkVUNl9BRERSU1RSTEVOXTsKKyAgICAg
ICAgY29uc3QgY2hhciAqcmVzOworCisgICAgICAgIHN0b3JlZC0+aGFzX2lwdjZfcHJlZml4ID0g
dHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5pcHY2X3ByZWZpeCA9IGdfc3RyZHVwKHZwcmVmaXg2KTsK
KworICAgICAgICBzdG9yZWQtPmhhc19pcHY2X3ByZWZpeGxlbiA9IHRydWU7CisgICAgICAgIHN0
b3JlZC0+aXB2Nl9wcmVmaXhsZW4gPSB2cHJlZml4Nl9sZW47CisKKyAgICAgICAgcmVzID0gaW5l
dF9udG9wKEFGX0lORVQ2LCAmaXA2X2hvc3QsCisgICAgICAgICAgICAgICAgICAgICAgICBhZGRy
c3RyLCBzaXplb2YoYWRkcnN0cikpOworCisgICAgICAgIHN0b3JlZC0+aGFzX2lwdjZfaG9zdCA9
IHRydWU7CisgICAgICAgIHN0b3JlZC0+aXB2Nl9ob3N0ID0gZ19zdHJkdXAocmVzKTsKKworICAg
ICAgICByZXMgPSBpbmV0X250b3AoQUZfSU5FVDYsICZpcDZfZG5zLAorICAgICAgICAgICAgICAg
ICAgICAgICAgYWRkcnN0ciwgc2l6ZW9mKGFkZHJzdHIpKTsKKworICAgICAgICBzdG9yZWQtPmhh
c19pcHY2X2RucyA9IHRydWU7CisgICAgICAgIHN0b3JlZC0+aXB2Nl9kbnMgPSBnX3N0cmR1cChy
ZXMpOworICAgIH0KKworICAgIGlmIChzbWJfZXhwb3J0KSB7CisgICAgICAgIHN0b3JlZC0+aGFz
X3NtYiA9IHRydWU7CisgICAgICAgIHN0b3JlZC0+c21iID0gZ19zdHJkdXAoc21iX2V4cG9ydCk7
CisgICAgfQorCisgICAgaWYgKHZzbWJzZXJ2ZXIpIHsKKyAgICAgICAgc3RvcmVkLT5oYXNfc21i
c2VydmVyID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5zbWJzZXJ2ZXIgPSBnX3N0cmR1cCh2c21i
c2VydmVyKTsKKyAgICB9CisKKyAgICBpZiAodGZ0cF9zZXJ2ZXJfbmFtZSkgeworICAgICAgICBz
dG9yZWQtPmhhc190ZnRwX3NlcnZlcl9uYW1lID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT50ZnRw
X3NlcnZlcl9uYW1lID0gZ19zdHJkdXAodGZ0cF9zZXJ2ZXJfbmFtZSk7CisgICAgfQorCiAgICAg
c25wcmludGYobmMtPmluZm9fc3RyLCBzaXplb2YobmMtPmluZm9fc3RyKSwKICAgICAgICAgICAg
ICAibmV0PSVzLHJlc3RyaWN0PSVzIiwgaW5ldF9udG9hKG5ldCksCiAgICAgICAgICAgICAgcmVz
dHJpY3RlZCA/ICJvbiIgOiAib2ZmIik7CkBAIC01ODIsMTQgKzY5OSwyMyBAQCBzdGF0aWMgaW50
IG5ldF9zbGlycF9pbml0KE5ldENsaWVudFN0YXRlICpwZWVyLCBjb25zdCBjaGFyICptb2RlbCwK
ICAgICBzLT5wb2xsX25vdGlmaWVyLm5vdGlmeSA9IG5ldF9zbGlycF9wb2xsX25vdGlmeTsKICAg
ICBtYWluX2xvb3BfcG9sbF9hZGRfbm90aWZpZXIoJnMtPnBvbGxfbm90aWZpZXIpOwogCisgICAg
c3RvcmVkX2hvc3Rmd2QgPSAmc3RvcmVkLT5ob3N0ZndkOworICAgIHN0b3JlZF9ndWVzdGZ3ZCA9
ICZzdG9yZWQtPmd1ZXN0ZndkOworCiAgICAgZm9yIChjb25maWcgPSBzbGlycF9jb25maWdzOyBj
b25maWc7IGNvbmZpZyA9IGNvbmZpZy0+bmV4dCkgewogICAgICAgICBpZiAoY29uZmlnLT5mbGFn
cyAmIFNMSVJQX0NGR19IT1NURldEKSB7CiAgICAgICAgICAgICBpZiAoc2xpcnBfaG9zdGZ3ZChz
LCBjb25maWctPnN0ciwgZXJycCkgPCAwKSB7CiAgICAgICAgICAgICAgICAgZ290byBlcnJvcjsK
KyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgc3RvcmVkLT5oYXNfaG9zdGZ3
ZCA9IHRydWU7CisgICAgICAgICAgICAgICAgQVBQRU5EX1NUUklOR0xJU1Qoc3RvcmVkX2hvc3Rm
d2QsIGNvbmZpZy0+c3RyKTsKICAgICAgICAgICAgIH0KICAgICAgICAgfSBlbHNlIHsKICAgICAg
ICAgICAgIGlmIChzbGlycF9ndWVzdGZ3ZChzLCBjb25maWctPnN0ciwgZXJycCkgPCAwKSB7CiAg
ICAgICAgICAgICAgICAgZ290byBlcnJvcjsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAg
ICAgICAgICAgc3RvcmVkLT5oYXNfZ3Vlc3Rmd2QgPSB0cnVlOworICAgICAgICAgICAgICAgIEFQ
UEVORF9TVFJJTkdMSVNUKHN0b3JlZF9ndWVzdGZ3ZCwgY29uZmlnLT5zdHIpOwogICAgICAgICAg
ICAgfQogICAgICAgICB9CiAgICAgfQpkaWZmIC0tZ2l0IGEvbmV0L3NvY2tldC5jIGIvbmV0L3Nv
Y2tldC5jCmluZGV4IGM5MjM1NDA0OWIuLjJkMmQ1NDE5Y2EgMTAwNjQ0Ci0tLSBhL25ldC9zb2Nr
ZXQuYworKysgYi9uZXQvc29ja2V0LmMKQEAgLTM0Miw2ICszNDIsNyBAQCBzdGF0aWMgTmV0U29j
a2V0U3RhdGUgKm5ldF9zb2NrZXRfZmRfaW5pdF9kZ3JhbShOZXRDbGllbnRTdGF0ZSAqcGVlciwK
ICAgICBOZXRTb2NrZXRTdGF0ZSAqczsKICAgICBTb2NrZXRBZGRyZXNzICpzYTsKICAgICBTb2Nr
ZXRBZGRyZXNzVHlwZSBzYV90eXBlOworICAgIE5ldGRldlNvY2tldE9wdGlvbnMgKnN0b3JlZDsK
IAogICAgIHNhID0gc29ja2V0X2xvY2FsX2FkZHJlc3MoZmQsIGVycnApOwogICAgIGlmICghc2Ep
IHsKQEAgLTM4NSw4ICszODYsMTkgQEAgc3RhdGljIE5ldFNvY2tldFN0YXRlICpuZXRfc29ja2V0
X2ZkX2luaXRfZGdyYW0oTmV0Q2xpZW50U3RhdGUgKnBlZXIsCiAgICAgbmV0X3NvY2tldF9yc19p
bml0KCZzLT5ycywgbmV0X3NvY2tldF9yc19maW5hbGl6ZSwgZmFsc2UpOwogICAgIG5ldF9zb2Nr
ZXRfcmVhZF9wb2xsKHMsIHRydWUpOwogCisgICAgLyogU3RvcmUgc3RhcnR1cCBwYXJhbWV0ZXJz
ICovCisgICAgbmMtPnN0b3JlZF9jb25maWcgPSBnX25ldzAoTmV0ZGV2SW5mbywgMSk7CisgICAg
bmMtPnN0b3JlZF9jb25maWctPnR5cGUgPSBORVRfQ0xJRU5UX0RSSVZFUl9TT0NLRVQ7CisgICAg
c3RvcmVkID0gJm5jLT5zdG9yZWRfY29uZmlnLT51LnNvY2tldDsKKworICAgIHN0b3JlZC0+aGFz
X2ZkID0gdHJ1ZTsKKyAgICBzdG9yZWQtPmZkID0gZ19zdHJkdXBfcHJpbnRmKCIlZCIsIGZkKTsK
KwogICAgIC8qIG1jYXN0OiBzYXZlIGJvdW5kIGFkZHJlc3MgYXMgZHN0ICovCiAgICAgaWYgKGlz
X2Nvbm5lY3RlZCAmJiBtY2FzdCAhPSBOVUxMKSB7CisgICAgICAgIHN0b3JlZC0+aGFzX21jYXN0
ID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5tY2FzdCA9IGdfc3RyZHVwKG1jYXN0KTsKKwogICAg
ICAgICBzLT5kZ3JhbV9kc3QgPSBzYWRkcjsKICAgICAgICAgc25wcmludGYobmMtPmluZm9fc3Ry
LCBzaXplb2YobmMtPmluZm9fc3RyKSwKICAgICAgICAgICAgICAgICAgInNvY2tldDogZmQ9JWQg
KGNsb25lZCBtY2FzdD0lczolZCkiLApAQCAtNDI4LDYgKzQ0MCw3IEBAIHN0YXRpYyBOZXRTb2Nr
ZXRTdGF0ZSAqbmV0X3NvY2tldF9mZF9pbml0X3N0cmVhbShOZXRDbGllbnRTdGF0ZSAqcGVlciwK
IHsKICAgICBOZXRDbGllbnRTdGF0ZSAqbmM7CiAgICAgTmV0U29ja2V0U3RhdGUgKnM7CisgICAg
TmV0ZGV2U29ja2V0T3B0aW9ucyAqc3RvcmVkOwogCiAgICAgbmMgPSBxZW11X25ld19uZXRfY2xp
ZW50KCZuZXRfc29ja2V0X2luZm8sIHBlZXIsIG1vZGVsLCBuYW1lKTsKIApAQCAtNDQ3LDYgKzQ2
MCwxNSBAQCBzdGF0aWMgTmV0U29ja2V0U3RhdGUgKm5ldF9zb2NrZXRfZmRfaW5pdF9zdHJlYW0o
TmV0Q2xpZW50U3RhdGUgKnBlZXIsCiAgICAgfSBlbHNlIHsKICAgICAgICAgcWVtdV9zZXRfZmRf
aGFuZGxlcihzLT5mZCwgTlVMTCwgbmV0X3NvY2tldF9jb25uZWN0LCBzKTsKICAgICB9CisKKyAg
ICAvKiBTdG9yZSBzdGFydHVwIHBhcmFtZXRlcnMgKi8KKyAgICBuYy0+c3RvcmVkX2NvbmZpZyA9
IGdfbmV3MChOZXRkZXZJbmZvLCAxKTsKKyAgICBuYy0+c3RvcmVkX2NvbmZpZy0+dHlwZSA9IE5F
VF9DTElFTlRfRFJJVkVSX1NPQ0tFVDsKKyAgICBzdG9yZWQgPSAmbmMtPnN0b3JlZF9jb25maWct
PnUuc29ja2V0OworCisgICAgc3RvcmVkLT5oYXNfZmQgPSB0cnVlOworICAgIHN0b3JlZC0+ZmQg
PSBnX3N0cmR1cF9wcmludGYoIiVkIiwgZmQpOworCiAgICAgcmV0dXJuIHM7CiB9CiAKQEAgLTQ4
Myw2ICs1MDUsNyBAQCBzdGF0aWMgdm9pZCBuZXRfc29ja2V0X2FjY2VwdCh2b2lkICpvcGFxdWUp
CiAgICAgc3RydWN0IHNvY2thZGRyX2luIHNhZGRyOwogICAgIHNvY2tsZW5fdCBsZW47CiAgICAg
aW50IGZkOworICAgIE5ldGRldlNvY2tldE9wdGlvbnMgKnN0b3JlZDsKIAogICAgIGZvcig7Oykg
ewogICAgICAgICBsZW4gPSBzaXplb2Yoc2FkZHIpOwpAQCAtNDk4LDYgKzUyMSwxMyBAQCBzdGF0
aWMgdm9pZCBuZXRfc29ja2V0X2FjY2VwdCh2b2lkICpvcGFxdWUpCiAgICAgcy0+ZmQgPSBmZDsK
ICAgICBzLT5uYy5saW5rX2Rvd24gPSBmYWxzZTsKICAgICBuZXRfc29ja2V0X2Nvbm5lY3Qocyk7
CisKKyAgICAvKiBTdG9yZSBhZGRpdGlvbmFsIHN0YXJ0dXAgcGFyYW1ldGVycyAoZXh0ZW5kIG5l
dF9zb2NrZXRfbGlzdGVuX2luaXQpICovCisgICAgc3RvcmVkID0gJnMtPm5jLnN0b3JlZF9jb25m
aWctPnUuc29ja2V0OworCisgICAgc3RvcmVkLT5oYXNfZmQgPSB0cnVlOworICAgIHN0b3JlZC0+
ZmQgPSBnX3N0cmR1cF9wcmludGYoIiVkIiwgZmQpOworCiAgICAgc25wcmludGYocy0+bmMuaW5m
b19zdHIsIHNpemVvZihzLT5uYy5pbmZvX3N0ciksCiAgICAgICAgICAgICAgInNvY2tldDogY29u
bmVjdGlvbiBmcm9tICVzOiVkIiwKICAgICAgICAgICAgICBpbmV0X250b2Eoc2FkZHIuc2luX2Fk
ZHIpLCBudG9ocyhzYWRkci5zaW5fcG9ydCkpOwpAQCAtNTEzLDYgKzU0Myw3IEBAIHN0YXRpYyBp
bnQgbmV0X3NvY2tldF9saXN0ZW5faW5pdChOZXRDbGllbnRTdGF0ZSAqcGVlciwKICAgICBOZXRT
b2NrZXRTdGF0ZSAqczsKICAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gc2FkZHI7CiAgICAgaW50IGZk
LCByZXQ7CisgICAgTmV0ZGV2U29ja2V0T3B0aW9ucyAqc3RvcmVkOwogCiAgICAgaWYgKHBhcnNl
X2hvc3RfcG9ydCgmc2FkZHIsIGhvc3Rfc3RyLCBlcnJwKSA8IDApIHsKICAgICAgICAgcmV0dXJu
IC0xOwpAQCAtNTQ5LDYgKzU4MCwxNSBAQCBzdGF0aWMgaW50IG5ldF9zb2NrZXRfbGlzdGVuX2lu
aXQoTmV0Q2xpZW50U3RhdGUgKnBlZXIsCiAgICAgbmV0X3NvY2tldF9yc19pbml0KCZzLT5ycywg
bmV0X3NvY2tldF9yc19maW5hbGl6ZSwgZmFsc2UpOwogCiAgICAgcWVtdV9zZXRfZmRfaGFuZGxl
cihzLT5saXN0ZW5fZmQsIG5ldF9zb2NrZXRfYWNjZXB0LCBOVUxMLCBzKTsKKworICAgIC8qIFN0
b3JlIHN0YXJ0dXAgcGFyYW1ldGVycyAqLworICAgIG5jLT5zdG9yZWRfY29uZmlnID0gZ19uZXcw
KE5ldGRldkluZm8sIDEpOworICAgIG5jLT5zdG9yZWRfY29uZmlnLT50eXBlID0gTkVUX0NMSUVO
VF9EUklWRVJfU09DS0VUOworICAgIHN0b3JlZCA9ICZuYy0+c3RvcmVkX2NvbmZpZy0+dS5zb2Nr
ZXQ7CisKKyAgICBzdG9yZWQtPmhhc19saXN0ZW4gPSB0cnVlOworICAgIHN0b3JlZC0+bGlzdGVu
ID0gZ19zdHJkdXAoaG9zdF9zdHIpOworCiAgICAgcmV0dXJuIDA7CiB9CiAKQEAgLTU2MSw2ICs2
MDEsNyBAQCBzdGF0aWMgaW50IG5ldF9zb2NrZXRfY29ubmVjdF9pbml0KE5ldENsaWVudFN0YXRl
ICpwZWVyLAogICAgIE5ldFNvY2tldFN0YXRlICpzOwogICAgIGludCBmZCwgY29ubmVjdGVkLCBy
ZXQ7CiAgICAgc3RydWN0IHNvY2thZGRyX2luIHNhZGRyOworICAgIE5ldGRldlNvY2tldE9wdGlv
bnMgKnN0b3JlZDsKIAogICAgIGlmIChwYXJzZV9ob3N0X3BvcnQoJnNhZGRyLCBob3N0X3N0ciwg
ZXJycCkgPCAwKSB7CiAgICAgICAgIHJldHVybiAtMTsKQEAgLTU5OCw2ICs2MzksMTIgQEAgc3Rh
dGljIGludCBuZXRfc29ja2V0X2Nvbm5lY3RfaW5pdChOZXRDbGllbnRTdGF0ZSAqcGVlciwKICAg
ICAgICAgcmV0dXJuIC0xOwogICAgIH0KIAorICAgIC8qIFN0b3JlIGFkZGl0aW9uYWwgc3RhcnR1
cCBwYXJhbWV0ZXJzIChleHRlbmQgbmV0X3NvY2tldF9mZF9pbml0KSAqLworICAgIHN0b3JlZCA9
ICZzLT5uYy5zdG9yZWRfY29uZmlnLT51LnNvY2tldDsKKworICAgIHN0b3JlZC0+aGFzX2Nvbm5l
Y3QgPSB0cnVlOworICAgIHN0b3JlZC0+Y29ubmVjdCA9IGdfc3RyZHVwKGhvc3Rfc3RyKTsKKwog
ICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3RyLCBzaXplb2Yocy0+bmMuaW5mb19zdHIpLAogICAg
ICAgICAgICAgICJzb2NrZXQ6IGNvbm5lY3QgdG8gJXM6JWQiLAogICAgICAgICAgICAgIGluZXRf
bnRvYShzYWRkci5zaW5fYWRkciksIG50b2hzKHNhZGRyLnNpbl9wb3J0KSk7CkBAIC02MTUsNiAr
NjYyLDcgQEAgc3RhdGljIGludCBuZXRfc29ja2V0X21jYXN0X2luaXQoTmV0Q2xpZW50U3RhdGUg
KnBlZXIsCiAgICAgaW50IGZkOwogICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzYWRkcjsKICAgICBz
dHJ1Y3QgaW5fYWRkciBsb2NhbGFkZHIsICpwYXJhbV9sb2NhbGFkZHI7CisgICAgTmV0ZGV2U29j
a2V0T3B0aW9ucyAqc3RvcmVkOwogCiAgICAgaWYgKHBhcnNlX2hvc3RfcG9ydCgmc2FkZHIsIGhv
c3Rfc3RyLCBlcnJwKSA8IDApIHsKICAgICAgICAgcmV0dXJuIC0xOwpAQCAtNjQzLDYgKzY5MSwx
OSBAQCBzdGF0aWMgaW50IG5ldF9zb2NrZXRfbWNhc3RfaW5pdChOZXRDbGllbnRTdGF0ZSAqcGVl
ciwKIAogICAgIHMtPmRncmFtX2RzdCA9IHNhZGRyOwogCisgICAgLyogU3RvcmUgYWRkaXRpb25h
bCBzdGFydHVwIHBhcmFtZXRlcnMgKGV4dGVuZCBuZXRfc29ja2V0X2ZkX2luaXQpICovCisgICAg
c3RvcmVkID0gJnMtPm5jLnN0b3JlZF9jb25maWctPnUuc29ja2V0OworCisgICAgaWYgKCFzdG9y
ZWQtPmhhc19tY2FzdCkgeworICAgICAgICBzdG9yZWQtPmhhc19tY2FzdCA9IHRydWU7CisgICAg
ICAgIHN0b3JlZC0+bWNhc3QgPSBnX3N0cmR1cChob3N0X3N0cik7CisgICAgfQorCisgICAgaWYg
KGxvY2FsYWRkcl9zdHIpIHsKKyAgICAgICAgc3RvcmVkLT5oYXNfbG9jYWxhZGRyID0gdHJ1ZTsK
KyAgICAgICAgc3RvcmVkLT5sb2NhbGFkZHIgPSBnX3N0cmR1cChsb2NhbGFkZHJfc3RyKTsKKyAg
ICB9CisKICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwgc2l6ZW9mKHMtPm5jLmluZm9fc3Ry
KSwKICAgICAgICAgICAgICAic29ja2V0OiBtY2FzdD0lczolZCIsCiAgICAgICAgICAgICAgaW5l
dF9udG9hKHNhZGRyLnNpbl9hZGRyKSwgbnRvaHMoc2FkZHIuc2luX3BvcnQpKTsKQEAgLTY2MCw2
ICs3MjEsNyBAQCBzdGF0aWMgaW50IG5ldF9zb2NrZXRfdWRwX2luaXQoTmV0Q2xpZW50U3RhdGUg
KnBlZXIsCiAgICAgTmV0U29ja2V0U3RhdGUgKnM7CiAgICAgaW50IGZkLCByZXQ7CiAgICAgc3Ry
dWN0IHNvY2thZGRyX2luIGxhZGRyLCByYWRkcjsKKyAgICBOZXRkZXZTb2NrZXRPcHRpb25zICpz
dG9yZWQ7CiAKICAgICBpZiAocGFyc2VfaG9zdF9wb3J0KCZsYWRkciwgbGhvc3QsIGVycnApIDwg
MCkgewogICAgICAgICByZXR1cm4gLTE7CkBAIC02OTgsNiArNzYwLDE1IEBAIHN0YXRpYyBpbnQg
bmV0X3NvY2tldF91ZHBfaW5pdChOZXRDbGllbnRTdGF0ZSAqcGVlciwKIAogICAgIHMtPmRncmFt
X2RzdCA9IHJhZGRyOwogCisgICAgLyogU3RvcmUgYWRkaXRpb25hbCBzdGFydHVwIHBhcmFtZXRl
cnMgKGV4dGVuZCBuZXRfc29ja2V0X2ZkX2luaXQpICovCisgICAgc3RvcmVkID0gJnMtPm5jLnN0
b3JlZF9jb25maWctPnUuc29ja2V0OworCisgICAgc3RvcmVkLT5oYXNfbG9jYWxhZGRyID0gdHJ1
ZTsKKyAgICBzdG9yZWQtPmxvY2FsYWRkciA9IGdfc3RyZHVwKGxob3N0KTsKKworICAgIHN0b3Jl
ZC0+aGFzX3VkcCA9IHRydWU7CisgICAgc3RvcmVkLT51ZHAgPSBnX3N0cmR1cChyaG9zdCk7CisK
ICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwgc2l6ZW9mKHMtPm5jLmluZm9fc3RyKSwKICAg
ICAgICAgICAgICAic29ja2V0OiB1ZHA9JXM6JWQiLAogICAgICAgICAgICAgIGluZXRfbnRvYShy
YWRkci5zaW5fYWRkciksIG50b2hzKHJhZGRyLnNpbl9wb3J0KSk7CmRpZmYgLS1naXQgYS9uZXQv
dGFwLXdpbjMyLmMgYi9uZXQvdGFwLXdpbjMyLmMKaW5kZXggMmI1ZGNkYTM2ZS4uMjBiYTBiMWRj
OCAxMDA2NDQKLS0tIGEvbmV0L3RhcC13aW4zMi5jCisrKyBiL25ldC90YXAtd2luMzIuYwpAQCAt
NzY4LDYgKzc2OCw3IEBAIHN0YXRpYyBpbnQgdGFwX3dpbjMyX2luaXQoTmV0Q2xpZW50U3RhdGUg
KnBlZXIsIGNvbnN0IGNoYXIgKm1vZGVsLAogICAgIE5ldENsaWVudFN0YXRlICpuYzsKICAgICBU
QVBTdGF0ZSAqczsKICAgICB0YXBfd2luMzJfb3ZlcmxhcHBlZF90ICpoYW5kbGU7CisgICAgTmV0
ZGV2VGFwT3B0aW9ucyAqc3RvcmVkOwogCiAgICAgaWYgKHRhcF93aW4zMl9vcGVuKCZoYW5kbGUs
IGlmbmFtZSkgPCAwKSB7CiAgICAgICAgIHByaW50ZigidGFwOiBDb3VsZCBub3Qgb3BlbiAnJXMn
XG4iLCBpZm5hbWUpOwpAQCAtNzc4LDYgKzc3OSwxNCBAQCBzdGF0aWMgaW50IHRhcF93aW4zMl9p
bml0KE5ldENsaWVudFN0YXRlICpwZWVyLCBjb25zdCBjaGFyICptb2RlbCwKIAogICAgIHMgPSBE
T19VUENBU1QoVEFQU3RhdGUsIG5jLCBuYyk7CiAKKyAgICAvKiBTdG9yZSBzdGFydHVwIHBhcmFt
ZXRlcnMgKi8KKyAgICBuYy0+c3RvcmVkX2NvbmZpZyA9IGdfbmV3MChOZXRkZXZJbmZvLCAxKTsK
KyAgICBuYy0+c3RvcmVkX2NvbmZpZy0+dHlwZSA9IE5FVF9DTElFTlRfRFJJVkVSX1RBUDsKKyAg
ICBzdG9yZWQgPSAmbmMtPnN0b3JlZF9jb25maWctPnUudGFwOworCisgICAgc3RvcmVkLT5oYXNf
aWZuYW1lID0gdHJ1ZTsKKyAgICBzdG9yZWQtPmlmbmFtZSA9IGdfc3RyZHVwKGlmbmFtZSk7CisK
ICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwgc2l6ZW9mKHMtPm5jLmluZm9fc3RyKSwKICAg
ICAgICAgICAgICAidGFwOiBpZm5hbWU9JXMiLCBpZm5hbWUpOwogCmRpZmYgLS1naXQgYS9uZXQv
dGFwLmMgYi9uZXQvdGFwLmMKaW5kZXggNjIwN2Y2MWY4NC4uZjQwZjM3OGMyYSAxMDA2NDQKLS0t
IGEvbmV0L3RhcC5jCisrKyBiL25ldC90YXAuYwpAQCAtNTg0LDYgKzU4NCw3IEBAIGludCBuZXRf
aW5pdF9icmlkZ2UoY29uc3QgTmV0ZGV2ICpuZXRkZXYsIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAg
Y29uc3QgY2hhciAqaGVscGVyLCAqYnI7CiAgICAgVEFQU3RhdGUgKnM7CiAgICAgaW50IGZkLCB2
bmV0X2hkcjsKKyAgICBOZXRkZXZCcmlkZ2VPcHRpb25zICpzdG9yZWQ7CiAKICAgICBhc3NlcnQo
bmV0ZGV2LT50eXBlID09IE5FVF9DTElFTlRfRFJJVkVSX0JSSURHRSk7CiAgICAgYnJpZGdlID0g
Jm5ldGRldi0+dS5icmlkZ2U7CkBAIC02MDAsNiArNjAxLDIxIEBAIGludCBuZXRfaW5pdF9icmlk
Z2UoY29uc3QgTmV0ZGV2ICpuZXRkZXYsIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgdm5ldF9oZHIg
PSB0YXBfcHJvYmVfdm5ldF9oZHIoZmQpOwogICAgIHMgPSBuZXRfdGFwX2ZkX2luaXQocGVlciwg
ImJyaWRnZSIsIG5hbWUsIGZkLCB2bmV0X2hkcik7CiAKKyAgICAvKiBTdG9yZSBzdGFydHVwIHBh
cmFtZXRlcnMgKi8KKyAgICBzLT5uYy5zdG9yZWRfY29uZmlnID0gZ19uZXcwKE5ldGRldkluZm8s
IDEpOworICAgIHMtPm5jLnN0b3JlZF9jb25maWctPnR5cGUgPSBORVRfQ0xJRU5UX0RSSVZFUl9C
UklER0U7CisgICAgc3RvcmVkID0gJnMtPm5jLnN0b3JlZF9jb25maWctPnUuYnJpZGdlOworCisg
ICAgaWYgKGJyKSB7CisgICAgICAgIHN0b3JlZC0+aGFzX2JyID0gdHJ1ZTsKKyAgICAgICAgc3Rv
cmVkLT5iciA9IGdfc3RyZHVwKGJyKTsKKyAgICB9CisKKyAgICBpZiAoaGVscGVyKSB7CisgICAg
ICAgIHN0b3JlZC0+aGFzX2hlbHBlciA9IHRydWU7CisgICAgICAgIHN0b3JlZC0+aGVscGVyID0g
Z19zdHJkdXAoaGVscGVyKTsKKyAgICB9CisKICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwg
c2l6ZW9mKHMtPm5jLmluZm9fc3RyKSwgImhlbHBlcj0lcyxicj0lcyIsIGhlbHBlciwKICAgICAg
ICAgICAgICBicik7CiAKQEAgLTY0NywxMSArNjYzLDEzIEBAIHN0YXRpYyB2b2lkIG5ldF9pbml0
X3RhcF9vbmUoY29uc3QgTmV0ZGV2VGFwT3B0aW9ucyAqdGFwLCBOZXRDbGllbnRTdGF0ZSAqcGVl
ciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqbW9kZWwsIGNvbnN0
IGNoYXIgKm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmlm
bmFtZSwgY29uc3QgY2hhciAqc2NyaXB0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBjaGFyICpkb3duc2NyaXB0LCBjb25zdCBjaGFyICp2aG9zdGZkbmFtZSwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW50IHZuZXRfaGRyLCBpbnQgZmQsIEVycm9yICoqZXJycCkK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHZuZXRfaGRyLCBpbnQgZmQsIE5ldGRl
dkluZm8gKipjb21tb25fc3RvcmVkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFcnJv
ciAqKmVycnApCiB7CiAgICAgRXJyb3IgKmVyciA9IE5VTEw7CiAgICAgVEFQU3RhdGUgKnMgPSBu
ZXRfdGFwX2ZkX2luaXQocGVlciwgbW9kZWwsIG5hbWUsIGZkLCB2bmV0X2hkcik7CiAgICAgaW50
IHZob3N0ZmQ7CisgICAgTmV0ZGV2VGFwT3B0aW9ucyAqc3RvcmVkOwogCiAgICAgdGFwX3NldF9z
bmRidWYocy0+ZmQsIHRhcCwgJmVycik7CiAgICAgaWYgKGVycikgewpAQCAtNjU5LDEyICs2Nzcs
NjUgQEAgc3RhdGljIHZvaWQgbmV0X2luaXRfdGFwX29uZShjb25zdCBOZXRkZXZUYXBPcHRpb25z
ICp0YXAsIE5ldENsaWVudFN0YXRlICpwZWVyLAogICAgICAgICByZXR1cm47CiAgICAgfQogCisg
ICAgLyogU3RvcmUgc3RhcnR1cCBwYXJhbWV0ZXJzICovCisgICAgaWYgKCEqY29tbW9uX3N0b3Jl
ZCkgeworICAgICAgICAqY29tbW9uX3N0b3JlZCA9IGdfbmV3MChOZXRkZXZJbmZvLCAxKTsKKyAg
ICAgICAgKCpjb21tb25fc3RvcmVkKS0+dHlwZSA9IE5FVF9DTElFTlRfRFJJVkVSX1RBUDsKKyAg
ICAgICAgcy0+bmMuc3RvcmVkX2NvbmZpZyA9ICpjb21tb25fc3RvcmVkOworICAgIH0KKyAgICBz
dG9yZWQgPSAmKCpjb21tb25fc3RvcmVkKS0+dS50YXA7CisKKyAgICBpZiAodGFwLT5oYXNfc25k
YnVmICYmICFzdG9yZWQtPmhhc19zbmRidWYpIHsKKyAgICAgICAgc3RvcmVkLT5oYXNfc25kYnVm
ID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5zbmRidWYgPSB0YXAtPnNuZGJ1ZjsKKyAgICB9CisK
KyAgICBpZiAodm5ldF9oZHIgJiYgIXN0b3JlZC0+aGFzX3ZuZXRfaGRyKSB7CisgICAgICAgIHN0
b3JlZC0+aGFzX3ZuZXRfaGRyID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT52bmV0X2hkciA9IHRy
dWU7CisgICAgfQorCiAgICAgaWYgKHRhcC0+aGFzX2ZkIHx8IHRhcC0+aGFzX2ZkcykgeworICAg
ICAgICBpZiAoIXN0b3JlZC0+aGFzX2ZkcykgeworICAgICAgICAgICAgc3RvcmVkLT5oYXNfZmRz
ID0gdHJ1ZTsKKyAgICAgICAgICAgIHN0b3JlZC0+ZmRzID0gZ19zdHJkdXBfcHJpbnRmKCIlZCIs
IGZkKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNoYXIgKnRtcF9zID0gc3RvcmVk
LT5mZHM7CisgICAgICAgICAgICBzdG9yZWQtPmZkcyA9IGdfc3RyZHVwX3ByaW50ZigiJXM6JWQi
LCBzdG9yZWQtPmZkcywgZmQpOworICAgICAgICAgICAgZ19mcmVlKHRtcF9zKTsKKyAgICAgICAg
fQorCiAgICAgICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3RyLCBzaXplb2Yocy0+bmMuaW5mb19z
dHIpLCAiZmQ9JWQiLCBmZCk7CiAgICAgfSBlbHNlIGlmICh0YXAtPmhhc19oZWxwZXIpIHsKKyAg
ICAgICAgaWYgKCFzdG9yZWQtPmhhc19oZWxwZXIpIHsKKyAgICAgICAgICAgIHN0b3JlZC0+aGFz
X2hlbHBlciA9IHRydWU7CisgICAgICAgICAgICBzdG9yZWQtPmhlbHBlciA9IGdfc3RyZHVwKHRh
cC0+aGVscGVyKTsKKyAgICAgICAgfQorCisgICAgICAgIGlmICghc3RvcmVkLT5oYXNfYnIpIHsK
KyAgICAgICAgICAgIHN0b3JlZC0+aGFzX2JyID0gdHJ1ZTsKKyAgICAgICAgICAgIHN0b3JlZC0+
YnIgPSB0YXAtPmhhc19iciA/IGdfc3RyZHVwKHRhcC0+YnIpIDoKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGdfc3RyZHVwKERFRkFVTFRfQlJJREdFX0lOVEVSRkFDRSk7Cisg
ICAgICAgIH0KKwogICAgICAgICBzbnByaW50ZihzLT5uYy5pbmZvX3N0ciwgc2l6ZW9mKHMtPm5j
LmluZm9fc3RyKSwgImhlbHBlcj0lcyIsCiAgICAgICAgICAgICAgICAgIHRhcC0+aGVscGVyKTsK
ICAgICB9IGVsc2UgeworICAgICAgICBpZiAoaWZuYW1lICYmICFzdG9yZWQtPmhhc19pZm5hbWUp
IHsKKyAgICAgICAgICAgIHN0b3JlZC0+aGFzX2lmbmFtZSA9IHRydWU7CisgICAgICAgICAgICBz
dG9yZWQtPmlmbmFtZSA9IGdfc3RyZHVwKGlmbmFtZSk7CisgICAgICAgIH0KKworICAgICAgICBp
ZiAoc2NyaXB0ICYmICFzdG9yZWQtPmhhc19zY3JpcHQpIHsKKyAgICAgICAgICAgIHN0b3JlZC0+
aGFzX3NjcmlwdCA9IHRydWU7CisgICAgICAgICAgICBzdG9yZWQtPnNjcmlwdCA9IGdfc3RyZHVw
KHNjcmlwdCk7CisgICAgICAgIH0KKworICAgICAgICBpZiAoZG93bnNjcmlwdCAmJiAhc3RvcmVk
LT5oYXNfZG93bnNjcmlwdCkgeworICAgICAgICAgICAgc3RvcmVkLT5oYXNfZG93bnNjcmlwdCA9
IHRydWU7CisgICAgICAgICAgICBzdG9yZWQtPmRvd25zY3JpcHQgPSBnX3N0cmR1cChkb3duc2Ny
aXB0KTsKKyAgICAgICAgfQorCiAgICAgICAgIHNucHJpbnRmKHMtPm5jLmluZm9fc3RyLCBzaXpl
b2Yocy0+bmMuaW5mb19zdHIpLAogICAgICAgICAgICAgICAgICAiaWZuYW1lPSVzLHNjcmlwdD0l
cyxkb3duc2NyaXB0PSVzIiwgaWZuYW1lLCBzY3JpcHQsCiAgICAgICAgICAgICAgICAgIGRvd25z
Y3JpcHQpOwpAQCAtNjgwLDkgKzc1MSwyMCBAQCBzdGF0aWMgdm9pZCBuZXRfaW5pdF90YXBfb25l
KGNvbnN0IE5ldGRldlRhcE9wdGlvbnMgKnRhcCwgTmV0Q2xpZW50U3RhdGUgKnBlZXIsCiAgICAg
ICAgIHZob3N0ZmRuYW1lIHx8ICh0YXAtPmhhc192aG9zdGZvcmNlICYmIHRhcC0+dmhvc3Rmb3Jj
ZSkpIHsKICAgICAgICAgVmhvc3ROZXRPcHRpb25zIG9wdGlvbnM7CiAKKyAgICAgICAgc3RvcmVk
LT5oYXNfdmhvc3QgPSB0cnVlOworICAgICAgICBzdG9yZWQtPnZob3N0ID0gdHJ1ZTsKKworICAg
ICAgICBpZiAodGFwLT5oYXNfdmhvc3Rmb3JjZSAmJiB0YXAtPnZob3N0Zm9yY2UpIHsKKyAgICAg
ICAgICAgIHN0b3JlZC0+aGFzX3Zob3N0Zm9yY2UgPSB0cnVlOworICAgICAgICAgICAgc3RvcmVk
LT52aG9zdGZvcmNlID0gdHJ1ZTsKKyAgICAgICAgfQorCiAgICAgICAgIG9wdGlvbnMuYmFja2Vu
ZF90eXBlID0gVkhPU1RfQkFDS0VORF9UWVBFX0tFUk5FTDsKICAgICAgICAgb3B0aW9ucy5uZXRf
YmFja2VuZCA9ICZzLT5uYzsKICAgICAgICAgaWYgKHRhcC0+aGFzX3BvbGxfdXMpIHsKKyAgICAg
ICAgICAgIHN0b3JlZC0+aGFzX3BvbGxfdXMgPSB0cnVlOworICAgICAgICAgICAgc3RvcmVkLT5w
b2xsX3VzID0gdGFwLT5wb2xsX3VzOworCiAgICAgICAgICAgICBvcHRpb25zLmJ1c3lsb29wX3Rp
bWVvdXQgPSB0YXAtPnBvbGxfdXM7CiAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICBvcHRp
b25zLmJ1c3lsb29wX3RpbWVvdXQgPSAwOwpAQCAtNzE1LDYgKzc5NywxNSBAQCBzdGF0aWMgdm9p
ZCBuZXRfaW5pdF90YXBfb25lKGNvbnN0IE5ldGRldlRhcE9wdGlvbnMgKnRhcCwgTmV0Q2xpZW50
U3RhdGUgKnBlZXIsCiAgICAgICAgIH0KICAgICAgICAgb3B0aW9ucy5vcGFxdWUgPSAodm9pZCAq
KSh1aW50cHRyX3Qpdmhvc3RmZDsKIAorICAgICAgICBpZiAoIXN0b3JlZC0+aGFzX3Zob3N0ZmRz
KSB7CisgICAgICAgICAgICBzdG9yZWQtPmhhc192aG9zdGZkcyA9IHRydWU7CisgICAgICAgICAg
ICBzdG9yZWQtPnZob3N0ZmRzID0gZ19zdHJkdXBfcHJpbnRmKCIlZCIsIHZob3N0ZmQpOworICAg
ICAgICB9IGVsc2UgeworICAgICAgICAgICAgY2hhciAqdG1wX3MgPSBzdG9yZWQtPnZob3N0ZmRz
OworICAgICAgICAgICAgc3RvcmVkLT52aG9zdGZkcyA9IGdfc3RyZHVwX3ByaW50ZigiJXM6JWQi
LCBzdG9yZWQtPmZkcywgdmhvc3RmZCk7CisgICAgICAgICAgICBnX2ZyZWUodG1wX3MpOworICAg
ICAgICB9CisKICAgICAgICAgcy0+dmhvc3RfbmV0ID0gdmhvc3RfbmV0X2luaXQoJm9wdGlvbnMp
OwogICAgICAgICBpZiAoIXMtPnZob3N0X25ldCkgewogICAgICAgICAgICAgaWYgKHRhcC0+aGFz
X3Zob3N0Zm9yY2UgJiYgdGFwLT52aG9zdGZvcmNlKSB7CkBAIC03NjYsNiArODU3LDcgQEAgaW50
IG5ldF9pbml0X3RhcChjb25zdCBOZXRkZXYgKm5ldGRldiwgY29uc3QgY2hhciAqbmFtZSwKICAg
ICBFcnJvciAqZXJyID0gTlVMTDsKICAgICBjb25zdCBjaGFyICp2aG9zdGZkbmFtZTsKICAgICBj
aGFyIGlmbmFtZVsxMjhdOworICAgIE5ldGRldkluZm8gKmNvbW1vbl9zdG9yZWQgPSBOVUxMOyAv
KiB3aWxsIHN0b3JlIGNvbmZpZ3VyYXRpb24gKi8KIAogICAgIGFzc2VydChuZXRkZXYtPnR5cGUg
PT0gTkVUX0NMSUVOVF9EUklWRVJfVEFQKTsKICAgICB0YXAgPSAmbmV0ZGV2LT51LnRhcDsKQEAg
LTgwMSw3ICs4OTMsNyBAQCBpbnQgbmV0X2luaXRfdGFwKGNvbnN0IE5ldGRldiAqbmV0ZGV2LCBj
b25zdCBjaGFyICpuYW1lLAogCiAgICAgICAgIG5ldF9pbml0X3RhcF9vbmUodGFwLCBwZWVyLCAi
dGFwIiwgbmFtZSwgTlVMTCwKICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHQsIGRvd25z
Y3JpcHQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgdmhvc3RmZG5hbWUsIHZuZXRfaGRyLCBm
ZCwgJmVycik7CisgICAgICAgICAgICAgICAgICAgICAgICAgdmhvc3RmZG5hbWUsIHZuZXRfaGRy
LCBmZCwgJmNvbW1vbl9zdG9yZWQsICZlcnIpOwogICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAg
ICAgICBlcnJvcl9wcm9wYWdhdGUoZXJycCwgZXJyKTsKICAgICAgICAgICAgIHJldHVybiAtMTsK
QEAgLTg1Nyw3ICs5NDksNyBAQCBpbnQgbmV0X2luaXRfdGFwKGNvbnN0IE5ldGRldiAqbmV0ZGV2
LCBjb25zdCBjaGFyICpuYW1lLAogICAgICAgICAgICAgbmV0X2luaXRfdGFwX29uZSh0YXAsIHBl
ZXIsICJ0YXAiLCBuYW1lLCBpZm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNj
cmlwdCwgZG93bnNjcmlwdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFwLT5oYXNf
dmhvc3RmZHMgPyB2aG9zdF9mZHNbaV0gOiBOVUxMLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB2bmV0X2hkciwgZmQsICZlcnIpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
bmV0X2hkciwgZmQsICZjb21tb25fc3RvcmVkLCAmZXJyKTsKICAgICAgICAgICAgIGlmIChlcnIp
IHsKICAgICAgICAgICAgICAgICBlcnJvcl9wcm9wYWdhdGUoZXJycCwgZXJyKTsKICAgICAgICAg
ICAgICAgICByZXQgPSAtMTsKQEAgLTg5Niw3ICs5ODgsNyBAQCBmcmVlX2ZhaWw6CiAKICAgICAg
ICAgbmV0X2luaXRfdGFwX29uZSh0YXAsIHBlZXIsICJicmlkZ2UiLCBuYW1lLCBpZm5hbWUsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2NyaXB0LCBkb3duc2NyaXB0LCB2aG9zdGZkbmFtZSwK
LSAgICAgICAgICAgICAgICAgICAgICAgICB2bmV0X2hkciwgZmQsICZlcnIpOworICAgICAgICAg
ICAgICAgICAgICAgICAgIHZuZXRfaGRyLCBmZCwgJmNvbW1vbl9zdG9yZWQsICZlcnIpOwogICAg
ICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgICBlcnJvcl9wcm9wYWdhdGUoZXJycCwgZXJyKTsK
ICAgICAgICAgICAgIGNsb3NlKGZkKTsKQEAgLTkzNSw3ICsxMDI3LDggQEAgZnJlZV9mYWlsOgog
ICAgICAgICAgICAgbmV0X2luaXRfdGFwX29uZSh0YXAsIHBlZXIsICJ0YXAiLCBuYW1lLCBpZm5h
bWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPj0gMSA/ICJubyIgOiBzY3JpcHQs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPj0gMSA/ICJubyIgOiBkb3duc2NyaXB0
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aG9zdGZkbmFtZSwgdm5ldF9oZHIsIGZk
LCAmZXJyKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmhvc3RmZG5hbWUsIHZuZXRf
aGRyLCBmZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmNvbW1vbl9zdG9yZWQsICZl
cnIpOwogICAgICAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICAgICAgIGVycm9yX3Byb3Bh
Z2F0ZShlcnJwLCBlcnIpOwogICAgICAgICAgICAgICAgIGNsb3NlKGZkKTsKZGlmZiAtLWdpdCBh
L25ldC92ZGUuYyBiL25ldC92ZGUuYwppbmRleCA5OTE4OWNjY2I2Li5jMGFiMmJiNjVjIDEwMDY0
NAotLS0gYS9uZXQvdmRlLmMKKysrIGIvbmV0L3ZkZS5jCkBAIC04NCw2ICs4NCw3IEBAIHN0YXRp
YyBpbnQgbmV0X3ZkZV9pbml0KE5ldENsaWVudFN0YXRlICpwZWVyLCBjb25zdCBjaGFyICptb2Rl
bCwKICAgICBWREVDT05OICp2ZGU7CiAgICAgY2hhciAqaW5pdF9ncm91cCA9IChjaGFyICopZ3Jv
dXA7CiAgICAgY2hhciAqaW5pdF9zb2NrID0gKGNoYXIgKilzb2NrOworICAgIE5ldGRldlZkZU9w
dGlvbnMgKnN0b3JlZDsKIAogICAgIHN0cnVjdCB2ZGVfb3Blbl9hcmdzIGFyZ3MgPSB7CiAgICAg
ICAgIC5wb3J0ID0gcG9ydCwKQEAgLTEwOCw2ICsxMDksMzEgQEAgc3RhdGljIGludCBuZXRfdmRl
X2luaXQoTmV0Q2xpZW50U3RhdGUgKnBlZXIsIGNvbnN0IGNoYXIgKm1vZGVsLAogCiAgICAgcWVt
dV9zZXRfZmRfaGFuZGxlcih2ZGVfZGF0YWZkKHMtPnZkZSksIHZkZV90b19xZW11LCBOVUxMLCBz
KTsKIAorICAgIC8qIFN0b3JlIHN0YXJ0dXAgcGFyYW1ldGVycyAqLworICAgIG5jLT5zdG9yZWRf
Y29uZmlnID0gZ19uZXcwKE5ldGRldkluZm8sIDEpOworICAgIG5jLT5zdG9yZWRfY29uZmlnLT50
eXBlID0gTkVUX0NMSUVOVF9EUklWRVJfVkRFOworICAgIHN0b3JlZCA9ICZuYy0+c3RvcmVkX2Nv
bmZpZy0+dS52ZGU7CisKKyAgICBpZiAoc29jaykgeworICAgICAgICBzdG9yZWQtPmhhc19zb2Nr
ID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5zb2NrID0gZ19zdHJkdXAoc29jayk7CisgICAgfQor
CisgICAgaWYgKHBvcnQpIHsKKyAgICAgICAgc3RvcmVkLT5oYXNfcG9ydCA9IHRydWU7CisgICAg
ICAgIHN0b3JlZC0+cG9ydCA9IHBvcnQ7CisgICAgfQorCisgICAgaWYgKGdyb3VwKSB7CisgICAg
ICAgIHN0b3JlZC0+aGFzX2dyb3VwID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5ncm91cCA9IGdf
c3RyZHVwKGdyb3VwKTsKKyAgICB9CisKKyAgICBpZiAobW9kZSkgeworICAgICAgICBzdG9yZWQt
Pmhhc19tb2RlID0gdHJ1ZTsKKyAgICAgICAgc3RvcmVkLT5tb2RlID0gbW9kZTsKKyAgICB9CisK
ICAgICByZXR1cm4gMDsKIH0KIApkaWZmIC0tZ2l0IGEvbmV0L3Zob3N0LXVzZXIuYyBiL25ldC92
aG9zdC11c2VyLmMKaW5kZXggMTc1MzJkYWFmMy4uYWEyZGM1MzE3OSAxMDA2NDQKLS0tIGEvbmV0
L3Zob3N0LXVzZXIuYworKysgYi9uZXQvdmhvc3QtdXNlci5jCkBAIC0zMDcsMTQgKzMwNywxNSBA
QCBzdGF0aWMgdm9pZCBuZXRfdmhvc3RfdXNlcl9ldmVudCh2b2lkICpvcGFxdWUsIFFFTVVDaHJF
dmVudCBldmVudCkKIH0KIAogc3RhdGljIGludCBuZXRfdmhvc3RfdXNlcl9pbml0KE5ldENsaWVu
dFN0YXRlICpwZWVyLCBjb25zdCBjaGFyICpkZXZpY2UsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgY2hhciAqbmFtZSwgQ2hhcmRldiAqY2hyLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGludCBxdWV1ZXMpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29uc3QgY2hhciAqbmFtZSwgY29uc3QgY2hhciAqY2hhcmRldiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBDaGFyZGV2ICpjaHIsIGludCBxdWV1ZXMpCiB7CiAgICAgRXJyb3Ig
KmVyciA9IE5VTEw7CiAgICAgTmV0Q2xpZW50U3RhdGUgKm5jLCAqbmMwID0gTlVMTDsKICAgICBO
ZXRWaG9zdFVzZXJTdGF0ZSAqcyA9IE5VTEw7CiAgICAgVmhvc3RVc2VyU3RhdGUgKnVzZXI7CiAg
ICAgaW50IGk7CisgICAgTmV0ZGV2Vmhvc3RVc2VyT3B0aW9ucyAqc3RvcmVkOwogCiAgICAgYXNz
ZXJ0KG5hbWUpOwogICAgIGFzc2VydChxdWV1ZXMgPiAwKTsKQEAgLTM1MSw2ICszNTIsMTYgQEAg
c3RhdGljIGludCBuZXRfdmhvc3RfdXNlcl9pbml0KE5ldENsaWVudFN0YXRlICpwZWVyLCBjb25z
dCBjaGFyICpkZXZpY2UsCiAKICAgICBhc3NlcnQocy0+dmhvc3RfbmV0KTsKIAorICAgIC8qIFN0
b3JlIHN0YXJ0dXAgcGFyYW1ldGVycyAqLworICAgIG5jMC0+c3RvcmVkX2NvbmZpZyA9IGdfbmV3
MChOZXRkZXZJbmZvLCAxKTsKKyAgICBuYzAtPnN0b3JlZF9jb25maWctPnR5cGUgPSBORVRfQ0xJ
RU5UX0RSSVZFUl9WSE9TVF9VU0VSOworICAgIHN0b3JlZCA9ICZuYzAtPnN0b3JlZF9jb25maWct
PnUudmhvc3RfdXNlcjsKKworICAgIHN0b3JlZC0+Y2hhcmRldiA9IGdfc3RyZHVwKGNoYXJkZXYp
OworCisgICAgc3RvcmVkLT5oYXNfcXVldWVzID0gdHJ1ZTsKKyAgICBzdG9yZWQtPnF1ZXVlcyA9
IHF1ZXVlczsKKwogICAgIHJldHVybiAwOwogCiBlcnI6CkBAIC00NDIsNSArNDUzLDYgQEAgaW50
IG5ldF9pbml0X3Zob3N0X3VzZXIoY29uc3QgTmV0ZGV2ICpuZXRkZXYsIGNvbnN0IGNoYXIgKm5h
bWUsCiAgICAgICAgIHJldHVybiAtMTsKICAgICB9CiAKLSAgICByZXR1cm4gbmV0X3Zob3N0X3Vz
ZXJfaW5pdChwZWVyLCAidmhvc3RfdXNlciIsIG5hbWUsIGNociwgcXVldWVzKTsKKyAgICByZXR1
cm4gbmV0X3Zob3N0X3VzZXJfaW5pdChwZWVyLCAidmhvc3RfdXNlciIsIG5hbWUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdmhvc3RfdXNlcl9vcHRzLT5jaGFyZGV2LCBjaHIsIHF1
ZXVlcyk7CiB9CmRpZmYgLS1naXQgYS9xYXBpL25ldC5qc29uIGIvcWFwaS9uZXQuanNvbgppbmRl
eCAxY2I5YTdkNzgyLi40ZjMyOWExZGUwIDEwMDY0NAotLS0gYS9xYXBpL25ldC5qc29uCisrKyBi
L3FhcGkvbmV0Lmpzb24KQEAgLTc1MCwzICs3NTAsOTIgQEAKICMjCiB7ICdldmVudCc6ICdGQUlM
T1ZFUl9ORUdPVElBVEVEJywKICAgJ2RhdGEnOiB7J2RldmljZS1pZCc6ICdzdHInfSB9CisKKyMj
CisjIEBOZXRkZXZJbmZvOgorIworIyBDb25maWd1cmF0aW9uIG9mIGEgbmV0d29yayBkZXZpY2Uu
CisjCisjIEBpZDogRGV2aWNlIGlkZW50aWZpZXIuCisjCisjIEB0eXBlOiBTcGVjaWZ5IHRoZSBk
cml2ZXIgdXNlZCBmb3IgaW50ZXJwcmV0aW5nIHJlbWFpbmluZyBhcmd1bWVudHMuCisjCisjIEBw
ZWVyOiBDb25uZWN0ZWQgbmV0d29yayBkZXZpY2UuCisjCisjIEBxdWV1ZXMtY291bnQ6IE51bWJl
ciBvZiBxdWV1ZXMuCisjCisjIEBodWI6IGh1YmlkIG9mIGh1YiwgaWYgY29ubmVjdGVkIHRvLgor
IworIyBAcGVybS1tYWM6IE9yaWdpbmFsIE1BQyBhZGRyZXNzLgorIworIyBTaW5jZTogNS4wCisj
IworeyAndW5pb24nOiAnTmV0ZGV2SW5mbycsCisgICdiYXNlJzogeyAnaWQnOiAnc3RyJywKKyAg
ICAgICAgICAgICd0eXBlJzogJ05ldENsaWVudERyaXZlcicsCisgICAgICAgICAgICAnKnBlZXIn
OiAnc3RyJywKKyAgICAgICAgICAgICdxdWV1ZXMtY291bnQnOiAnaW50JywKKyAgICAgICAgICAg
ICcqaHViJzogJ2ludCcsCisgICAgICAgICAgICAnKnBlcm0tbWFjJzogJ3N0cicgfSwKKyAgJ2Rp
c2NyaW1pbmF0b3InOiAndHlwZScsCisgICdkYXRhJzogeworICAgICAgJ25pYyc6ICAgICAgICAn
TmV0TGVnYWN5TmljT3B0aW9ucycsCisgICAgICAndXNlcic6ICAgICAgICdOZXRkZXZVc2VyT3B0
aW9ucycsCisgICAgICAndGFwJzogICAgICAgICdOZXRkZXZUYXBPcHRpb25zJywKKyAgICAgICds
MnRwdjMnOiAgICAgJ05ldGRldkwyVFB2M09wdGlvbnMnLAorICAgICAgJ3NvY2tldCc6ICAgICAn
TmV0ZGV2U29ja2V0T3B0aW9ucycsCisgICAgICAndmRlJzogICAgICAgICdOZXRkZXZWZGVPcHRp
b25zJywKKyAgICAgICdicmlkZ2UnOiAgICAgJ05ldGRldkJyaWRnZU9wdGlvbnMnLAorICAgICAg
J2h1YnBvcnQnOiAgICAnTmV0ZGV2SHViUG9ydE9wdGlvbnMnLAorICAgICAgJ25ldG1hcCc6ICAg
ICAnTmV0ZGV2TmV0bWFwT3B0aW9ucycsCisgICAgICAndmhvc3QtdXNlcic6ICdOZXRkZXZWaG9z
dFVzZXJPcHRpb25zJyB9IH0KKworIyMKKyMgQHF1ZXJ5LW5ldGRldnM6CisjCisjIEdldCBhIGxp
c3Qgb2YgQE5ldGRldkluZm8gZm9yIGFsbCB2aXJ0dWFsIG5ldHdvcmsgZGV2aWNlcy4KKyMKKyMg
UmV0dXJuczogYSBsaXN0IG9mIEBOZXRkZXZJbmZvIGRlc2NyaWJpbmcgZWFjaCB2aXJ0dWFsIG5l
dHdvcmsgZGV2aWNlLgorIworIyBTaW5jZTogNS4wCisjCisjIEV4YW1wbGU6CisjCisjIC0+IHsg
ImV4ZWN1dGUiOiAicXVlcnktbmV0ZGV2cyIgfQorIyA8LSB7ICJyZXR1cm4iOiBbCisjICAgICAg
ICAgIHsKKyMgICAgICAgICAgICAgICJwZWVyIjogIm5ldGRldjAiLAorIyAgICAgICAgICAgICAg
Im5ldGRldiI6ICJuZXRkZXYwIiwKKyMgICAgICAgICAgICAgICJwZXJtLW1hYyI6ICI1Mjo1NDow
MDoxMjozNDo1NiIKKyMgICAgICAgICAgICAgICJtb2RlbCI6ICJ2aXJ0aW8tbmV0LXBjaSIsCisj
ICAgICAgICAgICAgICAibWFjYWRkciI6ICI1Mjo1NDowMDoxMjozNDo1NiIsCisjICAgICAgICAg
ICAgICAicXVldWVzLWNvdW50IjogMSwKKyMgICAgICAgICAgICAgICJ0eXBlIjogIm5pYyIsCisj
ICAgICAgICAgICAgICAiaWQiOiAibmV0MCIKKyMgICAgICAgICAgfSwKKyMgICAgICAgICAgewor
IyAgICAgICAgICAgICAgInBlZXIiOiAibmV0MCIsCisjICAgICAgICAgICAgICAiaXB2NiI6IHRy
dWUsCisjICAgICAgICAgICAgICAiaXB2NCI6IHRydWUsCisjICAgICAgICAgICAgICAiaG9zdCI6
ICIxMC4wLjIuMiIsCisjICAgICAgICAgICAgICAicXVldWVzLWNvdW50IjogMSwKKyMgICAgICAg
ICAgICAgICJpcHY2LWRucyI6ICJmZWMwOjozIiwKKyMgICAgICAgICAgICAgICJpcHY2LXByZWZp
eCI6ICJmZWMwOjoiLAorIyAgICAgICAgICAgICAgIm5ldCI6ICIxMC4wLjIuMC8yNTUuMjU1LjI1
NS4wIiwKKyMgICAgICAgICAgICAgICJpcHY2LWhvc3QiOiAiZmVjMDo6MiIsCisjICAgICAgICAg
ICAgICAidHlwZSI6ICJ1c2VyIiwKKyMgICAgICAgICAgICAgICJkbnMiOiAiMTAuMC4yLjMiLAor
IyAgICAgICAgICAgICAgImhvc3Rmd2QiOiBbCisjICAgICAgICAgICAgICAgICAgeworIyAgICAg
ICAgICAgICAgICAgICAgICAic3RyIjogInRjcDo6MjAwMDQtOjIyIgorIyAgICAgICAgICAgICAg
ICAgIH0KKyMgICAgICAgICAgICAgIF0sCisjICAgICAgICAgICAgICAiaXB2Ni1wcmVmaXhsZW4i
OiA2NCwKKyMgICAgICAgICAgICAgICJpZCI6ICJuZXRkZXYwIiwKKyMgICAgICAgICAgICAgICJy
ZXN0cmljdCI6IGZhbHNlCisjICAgICAgICAgIH0KKyMgICAgICBdCisjICAgIH0KKyMKKyMjCit7
ICdjb21tYW5kJzogJ3F1ZXJ5LW5ldGRldnMnLCAncmV0dXJucyc6IFsnTmV0ZGV2SW5mbyddIH0K
LS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3Jn
Cmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

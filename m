Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id F3D0A126905
	for <lists+xen-devel@lfdr.de>; Thu, 19 Dec 2019 19:25:17 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ii0QU-0002Z0-NK; Thu, 19 Dec 2019 18:21:30 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=tNyU=2J=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1ii0QT-0002Yv-72
 for xen-devel@lists.xenproject.org; Thu, 19 Dec 2019 18:21:29 +0000
X-Inumbo-ID: 5a0f626c-228c-11ea-b6f1-bc764e2007e4
Received: from esa5.hc3370-68.iphmx.com (unknown [216.71.155.168])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 5a0f626c-228c-11ea-b6f1-bc764e2007e4;
 Thu, 19 Dec 2019 18:21:19 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1576779679;
 h=from:to:cc:subject:date:message-id:mime-version;
 bh=BzgVL9yUm5d02322hri4Dur9TL0XprDEoRkGuiJMILs=;
 b=ISPJsHLXcvC+B3zwjoDveZRwHwpvBUZstE7/k1PDhCUtH7TeGIGmVTEf
 CYbUwzD2l8jz8LwRSGMv7Cd4FxVQB+iZEf6wcM1uAXUUpUJ+UEpJnW3qP
 9OLP8K6UZjRSL9XDVU5VsgsMPqrr4I+HvugSLEbi/w8rdGy7Psq/R0Q6r M=;
Authentication-Results: esa5.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa5.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: etEHDAzv5P3tUAZlkFHKAQy+2x53a4vtYc0lMKzfWsPZFtwypKYfd1nUpWcf/1jnVlsrISYhl8
 +EWjN2Rmk8y+qGAmdF+RE52aaO2849gFuWzLzh8oL/cUgRVKvPTMW7ezWpr+VZW+6z6/jgc2+p
 QujJerlMqN8fO9zg6YLU0L+3QxZ3PdKXh/Kvpn3enZM3MwmxsrNxxgPj0nglird/HwKBygXmUP
 VdU6Ld/DKN0ICXTyaMzLf8xfVHGsre+Ld4/MmW4Qkj6avLWiwml2w8BjZwdwU4E91Y6pkM/+GC
 xj0=
X-SBRS: 2.7
X-MesageID: 10317890
X-Ironport-Server: esa5.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.69,332,1571716800"; d="scan'208";a="10317890"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Thu, 19 Dec 2019 18:21:15 +0000
Message-ID: <20191219182115.1432-1-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH] tools/libxc: Drop unused xc_compression_*()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wl@xen.org>,
 Ian Jackson <Ian.Jackson@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlcmUgaGF2ZSBiZWVuIG5vIHVzZXJzIG9mIHRoZSB4Y19jb21wcmVzc2lvbl8qKCkgaW50ZXJm
YWNlIHNpbmNlIE1pZ3JhdGlvbgp2MiByZXBsYWNlZCBsZWdhY3kgbWlncmF0aW9uICgyMDE2LCBj
L3MgYjE1YmM0MzQ1KS4KCkl0IHdvdWxkIG5lZWQgYWRqdXN0aW5nIHRvIGZpdCBpbnRvIG1pZ3Jh
dGlvbiB2MiwgYW5kIGNhbiBiZSBwdWxsZWQgb3V0IG9mIGdpdApoaXN0b3J5IGlmIHNvbWVvbmUg
d2FudHMgdG8gcmVzdXJyZWN0IGl0IGluIHRoZSBmdXR1cmUuCgpTaWduZWQtb2ZmLWJ5OiBBbmRy
ZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgotLS0KQ0M6IElhbiBKYWNrc29u
IDxJYW4uSmFja3NvbkBjaXRyaXguY29tPgpDQzogV2VpIExpdSA8d2xAeGVuLm9yZz4KLS0tCiB0
b29scy9saWJ4Yy9NYWtlZmlsZSAgICAgICAgICB8ICAgMiArLQogdG9vbHMvbGlieGMvaW5jbHVk
ZS94ZW5jdHJsLmggfCAgNjAgLS0tLS0KIHRvb2xzL2xpYnhjL3hjX2NvbXByZXNzaW9uLmMgIHwg
NTQ1IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogMyBmaWxlcyBj
aGFuZ2VkLCAxIGluc2VydGlvbigrKSwgNjA2IGRlbGV0aW9ucygtKQogZGVsZXRlIG1vZGUgMTAw
NjQ0IHRvb2xzL2xpYnhjL3hjX2NvbXByZXNzaW9uLmMKCmRpZmYgLS1naXQgYS90b29scy9saWJ4
Yy9NYWtlZmlsZSBiL3Rvb2xzL2xpYnhjL01ha2VmaWxlCmluZGV4IGNiYzMwMDAxZjYuLjZkMGFm
NTYzYzAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL01ha2VmaWxlCisrKyBiL3Rvb2xzL2xpYnhj
L01ha2VmaWxlCkBAIC02Myw3ICs2Myw3IEBAIEdVRVNUX1NSQ1MtJChDT05GSUdfWDg2KSArPSB4
Y19zcl9zYXZlX3g4Nl9wdi5jCiBHVUVTVF9TUkNTLSQoQ09ORklHX1g4NikgKz0geGNfc3Jfc2F2
ZV94ODZfaHZtLmMKIEdVRVNUX1NSQ1MteSArPSB4Y19zcl9yZXN0b3JlLmMKIEdVRVNUX1NSQ1Mt
eSArPSB4Y19zcl9zYXZlLmMKLUdVRVNUX1NSQ1MteSArPSB4Y19vZmZsaW5lX3BhZ2UuYyB4Y19j
b21wcmVzc2lvbi5jCitHVUVTVF9TUkNTLXkgKz0geGNfb2ZmbGluZV9wYWdlLmMKIGVsc2UKIEdV
RVNUX1NSQ1MteSArPSB4Y19ub21pZ3JhdGUuYwogZW5kaWYKZGlmZiAtLWdpdCBhL3Rvb2xzL2xp
YnhjL2luY2x1ZGUveGVuY3RybC5oIGIvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmgKaW5k
ZXggZjQ0MzE2ODdiMy4uOTgzZjVhYzZiMCAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGMvaW5jbHVk
ZS94ZW5jdHJsLmgKKysrIGIvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmgKQEAgLTIzMTUs
NjYgKzIzMTUsNiBAQCB2b2lkIHhjX2VsZl9zZXRfbG9nZmlsZSh4Y19pbnRlcmZhY2UgKnhjaCwg
c3RydWN0IGVsZl9iaW5hcnkgKmVsZiwKICAgICAgICAgICAgICAgICAgICAgICAgIGludCB2ZXJi
b3NlKTsKIC8qIFVzZWZ1bCBmb3IgY2FsbGVycyB3aG8gYWxzbyB1c2UgbGliZWxmLiAqLwogCi0v
KioKLSAqIENoZWNrcG9pbnQgQ29tcHJlc3Npb24KLSAqLwotdHlwZWRlZiBzdHJ1Y3QgY29tcHJl
c3Npb25fY3R4IGNvbXBfY3R4OwotY29tcF9jdHggKnhjX2NvbXByZXNzaW9uX2NyZWF0ZV9jb250
ZXh0KHhjX2ludGVyZmFjZSAqeGNoLAotCQkJCQl1bnNpZ25lZCBsb25nIHAybV9zaXplKTsKLXZv
aWQgeGNfY29tcHJlc3Npb25fZnJlZV9jb250ZXh0KHhjX2ludGVyZmFjZSAqeGNoLCBjb21wX2N0
eCAqY3R4KTsKLQotLyoqCi0gKiBBZGQgYSBwYWdlIHRvIGNvbXByZXNzaW9uIHBhZ2UgYnVmZmVy
LCB0byBiZSBjb21wcmVzc2VkIGxhdGVyLgotICoKLSAqIHJldHVybnMgMCBpZiB0aGUgcGFnZSB3
YXMgc3VjY2Vzc2Z1bGx5IGFkZGVkIHRvIHRoZSBwYWdlIGJ1ZmZlcgotICoKLSAqIHJldHVybnMg
LTEgaWYgdGhlcmUgaXMgbm8gc3BhY2UgaW4gYnVmZmVyLiBJbiB0aGlzIGNhc2UsIHRoZQotICog
IGFwcGxpY2F0aW9uIHNob3VsZCBjYWxsIHhjX2NvbXByZXNzaW9uX2NvbXByZXNzX3BhZ2VzIHRv
IGNvbXByZXNzCi0gKiAgdGhlIGJ1ZmZlciAob3IgYXRsZWFzdCBwYXJ0IG9mIGl0KSwgdGhlcmVi
eSBmcmVlaW5nIHNvbWUgc3BhY2UgaW4KLSAqICB0aGUgcGFnZSBidWZmZXIuCi0gKgotICogcmV0
dXJucyAtMiBpZiB0aGUgcGZuIGlzIG91dCBvZiBib3VuZHMsIHdoZXJlIHRoZSBib3VuZCBpcyBw
Mm1fc2l6ZQotICogIHBhcmFtZXRlciBwYXNzZWQgZHVyaW5nIHhjX2NvbXByZXNzaW9uX2NyZWF0
ZV9jb250ZXh0LgotICovCi1pbnQgeGNfY29tcHJlc3Npb25fYWRkX3BhZ2UoeGNfaW50ZXJmYWNl
ICp4Y2gsIGNvbXBfY3R4ICpjdHgsIGNoYXIgKnBhZ2UsCi0JCQkgICAgdW5zaWduZWQgbG9uZyBw
Zm4sIGludCBpc3Jhdyk7Ci0KLS8qKgotICogRGVsdGEgY29tcHJlc3MgcGFnZXMgaW4gdGhlIGNv
bXByZXNzaW9uIGJ1ZmZlciBhbmQgaW5zZXJ0cyB0aGUKLSAqIGNvbXByZXNzZWQgZGF0YSBpbnRv
IHRoZSBzdXBwbGllZCBjb21wcmVzc2lvbiBidWZmZXIgY29tcGJ1Ziwgd2hvc2UKLSAqIHNpemUg
aXMgY29tcGJ1Zl9zaXplLgotICogQWZ0ZXIgY29tcHJlc3Npb24sIHRoZSBwYWdlcyBhcmUgY29w
aWVkIHRvIHRoZSBpbnRlcm5hbCBMUlUgY2FjaGUuCi0gKgotICogVGhpcyBmdW5jdGlvbiBjb21w
cmVzc2VzIGFzIG1hbnkgcGFnZXMgYXMgcG9zc2libGUgaW50byB0aGUKLSAqIHN1cHBsaWVkIGNv
bXByZXNzaW9uIGJ1ZmZlci4gSXQgbWFpbnRhaW5zIGFuIGludGVybmFsIGl0ZXJhdG9yIHRvCi0g
KiBrZWVwIHRyYWNrIG9mIHBhZ2VzIGluIHRoZSBpbnB1dCBidWZmZXIgdGhhdCBhcmUgeWV0IHRv
IGJlIGNvbXByZXNzZWQuCi0gKgotICogcmV0dXJucyAtMSBpZiB0aGUgY29tcHJlc3Npb24gYnVm
ZmVyIGhhcyBydW4gb3V0IG9mIHNwYWNlLiAgCi0gKiByZXR1cm5zIDEgb24gc3VjY2Vzcy4KLSAq
IHJldHVybnMgMCBpZiBubyBtb3JlIHBhZ2VzIGFyZSBsZWZ0IHRvIGJlIGNvbXByZXNzZWQuCi0g
KiAgV2hlbiB0aGUgcmV0dXJuIHZhbHVlIGlzIG5vbi16ZXJvLCBjb21wYnVmX2xlbiBpbmRpY2F0
ZXMgdGhlIGFjdHVhbAotICogIGFtb3VudCBvZiBkYXRhIHByZXNlbnQgaW4gY29tcGJ1ZiAoPD1j
b21wYnVmX3NpemUpLgotICovCi1pbnQgeGNfY29tcHJlc3Npb25fY29tcHJlc3NfcGFnZXMoeGNf
aW50ZXJmYWNlICp4Y2gsIGNvbXBfY3R4ICpjdHgsCi0JCQkJICBjaGFyICpjb21wYnVmLCB1bnNp
Z25lZCBsb25nIGNvbXBidWZfc2l6ZSwKLQkJCQkgIHVuc2lnbmVkIGxvbmcgKmNvbXBidWZfbGVu
KTsKLQotLyoqCi0gKiBSZXNldHMgdGhlIGludGVybmFsIHBhZ2UgYnVmZmVyIHRoYXQgaG9sZHMg
ZGlydHkgcGFnZXMgYmVmb3JlIGNvbXByZXNzaW9uLgotICogQWxzbyByZXNldHMgdGhlIGl0ZXJh
dG9ycy4KLSAqLwotdm9pZCB4Y19jb21wcmVzc2lvbl9yZXNldF9wYWdlYnVmKHhjX2ludGVyZmFj
ZSAqeGNoLCBjb21wX2N0eCAqY3R4KTsKLQotLyoqCi0gKiBDYWxsZXIgbXVzdCBzdXBwbHkgdGhl
IGNvbXByZXNzaW9uIGJ1ZmZlciAoY29tcGJ1ZiksCi0gKiBpdHMgc2l6ZSAoY29tcGJ1Zl9zaXpl
KSBhbmQgYSByZWZlcmVuY2UgdG8gaW5kZXggdmFyaWFibGUgKGNvbXBidWZfcG9zKQotICogdGhh
dCBpcyB1c2VkIGludGVybmFsbHkuIEVhY2ggY2FsbCBwdWxscyBvdXQgb25lIHBhZ2UgZnJvbSB0
aGUgY29tcHJlc3NlZAotICogY2h1bmsgYW5kIGNvcGllcyBpdCB0byBkZXN0LgotICovCi1pbnQg
eGNfY29tcHJlc3Npb25fdW5jb21wcmVzc19wYWdlKHhjX2ludGVyZmFjZSAqeGNoLCBjaGFyICpj
b21wYnVmLAotCQkJCSAgIHVuc2lnbmVkIGxvbmcgY29tcGJ1Zl9zaXplLAotCQkJCSAgIHVuc2ln
bmVkIGxvbmcgKmNvbXBidWZfcG9zLCBjaGFyICpkZXN0KTsKLQogLyoKICAqIEV4ZWN1dGUgYW4g
aW1hZ2UgcHJldmlvdXNseSBsb2FkZWQgd2l0aCB4Y19rZXhlY19sb2FkKCkuCiAgKgpkaWZmIC0t
Z2l0IGEvdG9vbHMvbGlieGMveGNfY29tcHJlc3Npb24uYyBiL3Rvb2xzL2xpYnhjL3hjX2NvbXBy
ZXNzaW9uLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDg5YzExMTRlYmIuLjAwMDAw
MDAwMDAKLS0tIGEvdG9vbHMvbGlieGMveGNfY29tcHJlc3Npb24uYworKysgL2Rldi9udWxsCkBA
IC0xLDU0NSArMCwwIEBACi0vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiB4Y19jb21wcmVzc2lv
bi5jCi0gKgotICogQ2hlY2twb2ludCBDb21wcmVzc2lvbiB1c2luZyBQYWdlIERlbHRhIEFsZ29y
aXRobS4KLSAqIC0gQSBMUlUgY2FjaGUgb2YgcmVjZW50bHkgZGlydGllZCBndWVzdCBwYWdlcyBp
cyBtYWludGFpbmVkLgotICogLSBGb3IgZWFjaCBkaXJ0eSBndWVzdCBwYWdlIGluIHRoZSBjaGVj
a3BvaW50LCBpZiBhIHByZXZpb3VzIHZlcnNpb24gb2YgdGhlCi0gKiBwYWdlIGV4aXN0cyBpbiB0
aGUgY2FjaGUsIFhPUiBib3RoIHBhZ2VzIGFuZCBzZW5kIHRoZSBub24temVybyBzZWN0aW9ucwot
ICogdG8gdGhlIHJlY2VpdmVyLiBUaGUgY2FjaGUgaXMgdGhlbiB1cGRhdGVkIHdpdGggdGhlIG5l
d2VyIGNvcHkgb2YgZ3Vlc3QgcGFnZS4KLSAqIC0gVGhlIHJlY2VpdmVyIHdpbGwgWE9SIHRoZSBu
b24temVybyBzZWN0aW9ucyBhZ2FpbnN0IGl0cyBjb3B5IG9mIHRoZSBndWVzdAotICogcGFnZSwg
dGhlcmVieSBicmluZ2luZyB0aGUgZ3Vlc3QgcGFnZSB1cC10by1kYXRlIHdpdGggdGhlIHNlbmRl
ciBzaWRlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAxMSBTaHJpcmFtIFJhamFnb3BhbGFuIChy
c2hyaXJhbUBjcy51YmMuY2EpLgotICoKLSAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJl
OyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqIG1vZGlmeSBpdCB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247Ci0gKiB2ZXJzaW9uIDIuMSBv
ZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhl
IGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLSAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi0gKiBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQotICog
TGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLSAqCi0gKiBZ
b3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwg
UHVibGljCi0gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBJZiBub3QsIHNlZSA8
aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCi0gKgotICovCi0KLSNpbmNsdWRlIDxzdGRp
by5oPgotI2luY2x1ZGUgPHN0ZGxpYi5oPgotI2luY2x1ZGUgPHVuaXN0ZC5oPgotI2luY2x1ZGUg
PHN5cy90eXBlcy5oPgotI2luY2x1ZGUgPGludHR5cGVzLmg+Ci0jaW5jbHVkZSAieGNfcHJpdmF0
ZS5oIgotI2luY2x1ZGUgInhlbmN0cmwuaCIKLSNpbmNsdWRlICJ4Z19zYXZlX3Jlc3RvcmUuaCIK
LSNpbmNsdWRlICJ4Z19wcml2YXRlLmgiCi0jaW5jbHVkZSAieGNfZG9tLmgiCi0KLS8qIFBhZ2Ug
Q2FjaGUgZm9yIERlbHRhIENvbXByZXNzaW9uKi8KLSNkZWZpbmUgREVMVEFfQ0FDSEVfU0laRSAo
WENfUEFHRV9TSVpFICogODE5MikKLQotLyogSW50ZXJuYWwgcGFnZSBidWZmZXIgdG8gaG9sZCBk
aXJ0eSBwYWdlcyBvZiBhIGNoZWNrcG9pbnQsCi0gKiB0byBiZSBjb21wcmVzc2VkIGFmdGVyIHRo
ZSBkb21haW4gaXMgcmVzdW1lZCBmb3IgZXhlY3V0aW9uLgotICovCi0jZGVmaW5lIFBBR0VfQlVG
RkVSX1NJWkUgKFhDX1BBR0VfU0laRSAqIDgxOTIpCi0KLXN0cnVjdCBjYWNoZV9wYWdlCi17Ci0g
ICAgY2hhciAqcGFnZTsKLSAgICB4ZW5fcGZuX3QgcGZuOwotICAgIHN0cnVjdCBjYWNoZV9wYWdl
ICpuZXh0OwotICAgIHN0cnVjdCBjYWNoZV9wYWdlICpwcmV2OwotfTsKLQotc3RydWN0IGNvbXBy
ZXNzaW9uX2N0eAotewotICAgIC8qIGNvbXByZXNzaW9uIGJ1ZmZlciAtIGhvbGRzIGNvbXByZXNz
ZWQgZGF0YSAqLwotICAgIGNoYXIgKmNvbXBidWY7Ci0gICAgdW5zaWduZWQgbG9uZyBjb21wYnVm
X3NpemU7Ci0gICAgdW5zaWduZWQgbG9uZyBjb21wYnVmX3BvczsKLQotICAgIC8qIFBhZ2UgYnVm
ZmVyIHRvIGhvbGQgcGFnZXMgdG8gYmUgY29tcHJlc3NlZCAqLwotICAgIGNoYXIgKmlucHV0YnVm
OwotICAgIC8qIHBmbnMgb2YgcGFnZXMgdG8gYmUgY29tcHJlc3NlZCAqLwotICAgIHhlbl9wZm5f
dCAqc2VuZGJ1Zl9wZm5zOwotICAgIHVuc2lnbmVkIGludCBwZm5zX2xlbjsKLSAgICB1bnNpZ25l
ZCBpbnQgcGZuc19pbmRleDsKLQotICAgIC8qIENvbXByZXNzaW9uIENhY2hlIChMUlUpICovCi0g
ICAgY2hhciAqY2FjaGVfYmFzZTsKLSAgICBzdHJ1Y3QgY2FjaGVfcGFnZSAqKnBmbjJjYWNoZTsK
LSAgICBzdHJ1Y3QgY2FjaGVfcGFnZSAqY2FjaGU7Ci0gICAgc3RydWN0IGNhY2hlX3BhZ2UgKnBh
Z2VfbGlzdF9oZWFkOwotICAgIHN0cnVjdCBjYWNoZV9wYWdlICpwYWdlX2xpc3RfdGFpbDsKLSAg
ICB1bnNpZ25lZCBsb25nIGRvbV9wZm5saXN0X3NpemU7Ci19OwotCi0jZGVmaW5lIFJVTkZMQUcg
MAotI2RlZmluZSBTS0lQRkxBRyAoKGNoYXIpMTI4KQotI2RlZmluZSBGTEFHTUFTSyBTS0lQRkxB
RwotI2RlZmluZSBMRU5NQVNLICgoY2hhcikxMjcpCi0KLS8qCi0gKiBzZWUgeGdfc2F2ZV9yZXN0
b3JlLmggZm9yIGRldGFpbHMgb24gdGhlIGNvbXByZXNzZWQgc3RyZWFtIGZvcm1hdC4KLSAqIGRl
bHRhIHNpemUgPSA0IGJ5dGVzLgotICogcnVuIGhlYWRlciA9IDEgYnl0ZSAoMSBiaXQgZm9yIHJ1
bnR5cGUsIDdiaXRzIGZvciBydW4gbGVuZ3RoKS4KLSAqICBpLmUgbWF4aW11bSBzaXplIG9mIGEg
cnVuID0gMTI3ICogNCA9IDUwOCBieXRlcy4KLSAqIFdvcnN0IGNhc2UgY29tcHJlc3Npb246IEVu
dGlyZSBwYWdlIGhhcyBjaGFuZ2VkLgotICogSW4gdGhlIHdvcnN0IGNhc2UsIHRoZSBzaXplIG9m
IHRoZSBjb21wcmVzc2VkIHBhZ2UgaXMKLSAqICA4IHJ1bnMgb2YgNTA4IGJ5dGVzICsgMSBydW4g
b2YgMzIgYnl0ZXMgKyA5IHJ1biBoZWFkZXJzIAotICogID0gNDEwNSBieXRlcy4KLSAqIFdlIGNv
dWxkIGRldGVjdCB0aGlzIHdvcnN0IGNhc2UgYW5kIHNlbmQgdGhlIGVudGlyZSBwYWdlIHdpdGgg
YQotICogRlVMTF9QQUdFIG1hcmtlciwgcmVkdWNpbmcgdGhlIHRvdGFsIHNpemUgdG8gNDA5NyBi
eXRlcy4gVGhlIGNvc3QKLSAqIG9mIHRoaXMgc2l6ZSByZWR1Y3Rpb24gaXMgYW4gYWRkaXRpb25h
bCBtZW1jcHksIG9uIHRvcCBvZiB0d28gcHJldmlvdXMKLSAqIG1lbWNweSAodG8gdGhlIGNvbXBy
ZXNzZWQgc3RyZWFtIGFuZCB0aGUgY2FjaGUgcGFnZSBpbiB0aGUgZm9yIGxvb3ApLgotICoKLSAq
IFdlIG1pZ2h0IGFzIHdlbGwgc2FjcmlmaWNlIGFuIGV4dHJhIDggYnl0ZXMgaW5zdGVhZCBvZiBh
IG1lbWNweS4KLSAqLwotI2RlZmluZSBXT1JTVF9DT01QX1BBR0VfU0laRSAoWENfUEFHRV9TSVpF
ICsgOSkKLQotLyoKLSAqIEEgemVybyBsZW5ndGggc2tpcCBpbmRpY2F0ZXMgZnVsbCBwYWdlLgot
ICovCi0jZGVmaW5lIEVNUFRZX1BBR0UgMAotI2RlZmluZSBGVUxMX1BBR0UgU0tJUEZMQUcKLSNk
ZWZpbmUgRlVMTF9QQUdFX1NJWkUgKFhDX1BBR0VfU0laRSArIDEpCi0jZGVmaW5lIE1BWF9ERUxU
QVMgKFhDX1BBR0VfU0laRS9zaXplb2YodWludDMyX3QpKQotCi0vKgotICogQWRkIGEgcGFnZXRh
YmxlIHBhZ2Ugb3IgYSBuZXcgcGFnZSAodW5jYWNoZWQpCi0gKiBpZiBzcmNwYWdlIGlzIGEgcGFn
ZXRhYmxlIHBhZ2UsIGNhY2hlX3BhZ2UgaXMgbnVsbC4KLSAqIGlmIHNyY3BhZ2UgaXMgYSBwYWdl
IHRoYXQgd2FzIG5vdCBwcmV2aW91c2x5IGluIHRoZSBjYWNoZSwKLSAqICBjYWNoZV9wYWdlIHBv
aW50cyB0byBhIGZyZWUgcGFnZSBzbG90IGluIHRoZSBjYWNoZSB3aGVyZQotICogIHRoaXMgbmV3
IHBhZ2UgY2FuIGJlIGNvcGllZCB0by4KLSAqLwotc3RhdGljIGludCBhZGRfZnVsbF9wYWdlKGNv
bXBfY3R4ICpjdHgsIGNoYXIgKnNyY3BhZ2UsIGNoYXIgKmNhY2hlX3BhZ2UpCi17Ci0gICAgY2hh
ciAqZGVzdCA9IChjdHgtPmNvbXBidWYgKyBjdHgtPmNvbXBidWZfcG9zKTsKLQotICAgIGlmICgg
KGN0eC0+Y29tcGJ1Zl9wb3MgKyBGVUxMX1BBR0VfU0laRSkgPiBjdHgtPmNvbXBidWZfc2l6ZSkK
LSAgICAgICAgcmV0dXJuIC0xOwotCi0gICAgaWYgKGNhY2hlX3BhZ2UpCi0gICAgICAgIG1lbWNw
eShjYWNoZV9wYWdlLCBzcmNwYWdlLCBYQ19QQUdFX1NJWkUpOwotICAgIGRlc3RbMF0gPSBGVUxM
X1BBR0U7Ci0gICAgbWVtY3B5KCZkZXN0WzFdLCBzcmNwYWdlLCBYQ19QQUdFX1NJWkUpOwotICAg
IGN0eC0+Y29tcGJ1Zl9wb3MgKz0gRlVMTF9QQUdFX1NJWkU7Ci0KLSAgICByZXR1cm4gRlVMTF9Q
QUdFX1NJWkU7Ci19Ci0KLXN0YXRpYyBpbnQgY29tcHJlc3NfcGFnZShjb21wX2N0eCAqY3R4LCBj
aGFyICpzcmNwYWdlLCBjaGFyICpjYWNoZV9wYWdlKQotewotICAgIGNoYXIgKmRlc3QgPSAoY3R4
LT5jb21wYnVmICsgY3R4LT5jb21wYnVmX3Bvcyk7Ci0gICAgdWludDMyX3QgKm5ldywgKm9sZDsK
LQotICAgIGludCBvZmYsIHJ1bnB0ciA9IDA7Ci0gICAgaW50IHdhc2NvcHlpbmcgPSAwLCBjb3B5
aW5nID0gMCwgYnl0ZXNfc2tpcHBlZCA9IDA7Ci0gICAgaW50IGNvbXBsZW4gPSAwLCBwYWdlb2Zm
ID0gMCwgcnVuYnl0ZXMgPSAwOwotCi0gICAgY2hhciBydW5sZW4gPSAwOwotCi0gICAgaWYgKCAo
Y3R4LT5jb21wYnVmX3BvcyArIFdPUlNUX0NPTVBfUEFHRV9TSVpFKSA+IGN0eC0+Y29tcGJ1Zl9z
aXplKQotICAgICAgICByZXR1cm4gLTE7Ci0KLSAgICAvKgotICAgICAqIFRoZXJlIGFyZSBubyBh
bGlnbm1lbnQgaXNzdWVzIGhlcmUgc2luY2Ugc3JjcGFnZSBpcwotICAgICAqIGRvbVUncyBwYWdl
IHBhc3NlZCBmcm9tIHhjX2RvbWFpbl9zYXZlIGFuZCBjYWNoZV9wYWdlIGlzCi0gICAgICogYSBw
dHIgdG8gY2FjaGUgcGFnZSAoY2FjaGUgaXMgcGFnZSBhbGlnbmVkKS4KLSAgICAgKi8KLSAgICBu
ZXcgPSAodWludDMyX3QqKXNyY3BhZ2U7Ci0gICAgb2xkID0gKHVpbnQzMl90KiljYWNoZV9wYWdl
OwotCi0gICAgZm9yIChvZmYgPSAwOyBvZmYgPD0gTUFYX0RFTFRBUzsgb2ZmKyspCi0gICAgewot
ICAgICAgICAvKgotICAgICAgICAgKiBBdCAob2ZmID09IE1BWF9ERUxUQVMpLCB3ZSBhcmUgcHJv
Y2Vzc2luZyB0aGUgbGFzdCBydW4KLSAgICAgICAgICogaW4gdGhlIHBhZ2UuIFNpbmNlIHRoZXJl
IGlzIG5vIFhPUmluZywgbWFrZSB3YXNjb3B5aW5nICE9IGNvcHlpbmcKLSAgICAgICAgICogdG8g
c2F0aXNmeSB0aGUgaWYtYmxvY2sgYmVsb3cuCi0gICAgICAgICAqLwotICAgICAgICBjb3B5aW5n
ID0gKChvZmYgPCBNQVhfREVMVEFTKSA/IChvbGRbb2ZmXSAhPSBuZXdbb2ZmXSkgOiAhd2FzY29w
eWluZyk7Ci0KLSAgICAgICAgaWYgKHJ1bmxlbikKLSAgICAgICAgewotICAgICAgICAgICAgLyog
c3dpdGNoaW5nIGJldHdlZW4gcnVuIHR5cGVzIG9yIGN1cnJlbnQgcnVuIGlzIGZ1bGwgKi8KLSAg
ICAgICAgICAgIGlmICggKHdhc2NvcHlpbmcgIT0gY29weWluZykgfHwgKHJ1bmxlbiA9PSBMRU5N
QVNLKSApCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcnVuYnl0ZXMgPSBydW5sZW4g
KiBzaXplb2YodWludDMyX3QpOwotICAgICAgICAgICAgICAgIHJ1bmxlbiB8PSAod2FzY29weWlu
ZyA/IFJVTkZMQUcgOiBTS0lQRkxBRyk7Ci0gICAgICAgICAgICAgICAgZGVzdFtjb21wbGVuKytd
ID0gcnVubGVuOwotCi0gICAgICAgICAgICAgICAgaWYgKHdhc2NvcHlpbmcpIC8qIFJVTkZMQUcg
Ki8KLSAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIHBhZ2VvZmYgPSBydW5w
dHIgKiBzaXplb2YodWludDMyX3QpOwotICAgICAgICAgICAgICAgICAgICBtZW1jcHkoZGVzdCAr
IGNvbXBsZW4sIHNyY3BhZ2UgKyBwYWdlb2ZmLCBydW5ieXRlcyk7Ci0gICAgICAgICAgICAgICAg
ICAgIG1lbWNweShjYWNoZV9wYWdlICsgcGFnZW9mZiwgc3JjcGFnZSArIHBhZ2VvZmYsIHJ1bmJ5
dGVzKTsKLSAgICAgICAgICAgICAgICAgICAgY29tcGxlbiArPSBydW5ieXRlczsKLSAgICAgICAg
ICAgICAgICB9Ci0gICAgICAgICAgICAgICAgZWxzZSAvKiBTS0lQRkxBRyAqLwotICAgICAgICAg
ICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgYnl0ZXNfc2tpcHBlZCArPSBydW5ieXRlczsK
LSAgICAgICAgICAgICAgICB9Ci0KLSAgICAgICAgICAgICAgICBydW5sZW4gPSAwOwotICAgICAg
ICAgICAgICAgIHJ1bnB0ciA9IG9mZjsKLSAgICAgICAgICAgIH0KLSAgICAgICAgfQotICAgICAg
ICBydW5sZW4rKzsKLSAgICAgICAgd2FzY29weWluZyA9IGNvcHlpbmc7Ci0gICAgfQotCi0gICAg
LyoKLSAgICAgKiBDaGVjayBmb3IgZW1wdHkgcGFnZS4KLSAgICAgKi8KLSAgICBpZiAoYnl0ZXNf
c2tpcHBlZCA9PSBYQ19QQUdFX1NJWkUpCi0gICAgewotICAgICAgICBjb21wbGVuID0gMTsKLSAg
ICAgICAgZGVzdFswXSA9IEVNUFRZX1BBR0U7Ci0gICAgfQotICAgIGN0eC0+Y29tcGJ1Zl9wb3Mg
Kz0gY29tcGxlbjsKLQotICAgIHJldHVybiBjb21wbGVuOwotfQotCi1zdGF0aWMKLWNoYXIgKmdl
dF9jYWNoZV9wYWdlKGNvbXBfY3R4ICpjdHgsIHhlbl9wZm5fdCBwZm4sCi0gICAgICAgICAgICAg
ICAgICAgICBpbnQgKmlzcmF3KQotewotICAgIHN0cnVjdCBjYWNoZV9wYWdlICppdGVtID0gTlVM
TDsKLQotICAgIGl0ZW0gPSBjdHgtPnBmbjJjYWNoZVtwZm5dOwotCi0gICAgaWYgKCFpdGVtKQot
ICAgIHsKLSAgICAgICAgKmlzcmF3ID0gMTsKLQotICAgICAgICAvKiBJZiB0aGUgbGlzdCBpcyBm
dWxsLCBldmljdCBhIHBhZ2UgZnJvbSB0aGUgdGFpbCBlbmQuICovCi0gICAgICAgIGl0ZW0gPSBj
dHgtPnBhZ2VfbGlzdF90YWlsOwotICAgICAgICBpZiAoaXRlbS0+cGZuICE9IElOVkFMSURfUEZO
KQotICAgICAgICAgICAgY3R4LT5wZm4yY2FjaGVbaXRlbS0+cGZuXSA9IE5VTEw7Ci0KLSAgICAg
ICAgaXRlbS0+cGZuID0gcGZuOwotICAgICAgICBjdHgtPnBmbjJjYWNoZVtwZm5dID0gaXRlbTsK
LSAgICB9Ci0gICAgICAgIAotICAgIC8qIAlpZiByZXF1ZXN0ZWQgaXRlbSBpcyBpbiBjYWNoZSBt
b3ZlIHRvIGhlYWQgb2YgbGlzdCAqLwotICAgIGlmIChpdGVtICE9IGN0eC0+cGFnZV9saXN0X2hl
YWQpCi0gICAgewotICAgICAgICBpZiAoaXRlbSA9PSBjdHgtPnBhZ2VfbGlzdF90YWlsKQotICAg
ICAgICB7Ci0gICAgICAgICAgICAvKiBpdGVtIGF0IHRhaWwgb2YgbGlzdC4gKi8KLSAgICAgICAg
ICAgIGN0eC0+cGFnZV9saXN0X3RhaWwgPSBpdGVtLT5wcmV2OwotICAgICAgICAgICAgKGN0eC0+
cGFnZV9saXN0X3RhaWwpLT5uZXh0ID0gTlVMTDsKLSAgICAgICAgfQotICAgICAgICBlbHNlCi0g
ICAgICAgIHsKLSAgICAgICAgICAgIC8qIGl0ZW0gaW4gbWlkZGxlIG9mIGxpc3QgKi8KLSAgICAg
ICAgICAgIGl0ZW0tPnByZXYtPm5leHQgPSBpdGVtLT5uZXh0OwotICAgICAgICAgICAgaXRlbS0+
bmV4dC0+cHJldiA9IGl0ZW0tPnByZXY7Ci0gICAgICAgIH0KLQotICAgICAgICBpdGVtLT5wcmV2
ID0gTlVMTDsKLSAgICAgICAgaXRlbS0+bmV4dCA9IGN0eC0+cGFnZV9saXN0X2hlYWQ7Ci0gICAg
ICAgIChjdHgtPnBhZ2VfbGlzdF9oZWFkKS0+cHJldiA9IGl0ZW07Ci0gICAgICAgIGN0eC0+cGFn
ZV9saXN0X2hlYWQgPSBpdGVtOwotICAgIH0KLQotICAgIHJldHVybiAoY3R4LT5wYWdlX2xpc3Rf
aGVhZCktPnBhZ2U7Ci19Ci0KLS8qIFJlbW92ZSBwYWdldGFibGUgcGFnZXMgZnJvbSBjYWNoZSBh
bmQgbW92ZSB0byB0YWlsLCBhcyBmcmVlIHBhZ2VzICovCi1zdGF0aWMKLXZvaWQgaW52YWxpZGF0
ZV9jYWNoZV9wYWdlKGNvbXBfY3R4ICpjdHgsIHhlbl9wZm5fdCBwZm4pCi17Ci0gICAgc3RydWN0
IGNhY2hlX3BhZ2UgKml0ZW0gPSBOVUxMOwotCi0gICAgaXRlbSA9IGN0eC0+cGZuMmNhY2hlW3Bm
bl07Ci0gICAgaWYgKGl0ZW0pCi0gICAgewotICAgICAgICBpZiAoaXRlbSAhPSBjdHgtPnBhZ2Vf
bGlzdF90YWlsKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBpdGVtIGF0IGhlYWQgb2YgbGlz
dCAqLwotICAgICAgICAgICAgaWYgKGl0ZW0gPT0gY3R4LT5wYWdlX2xpc3RfaGVhZCkKLSAgICAg
ICAgICAgIHsKLSAgICAgICAgICAgICAgICBjdHgtPnBhZ2VfbGlzdF9oZWFkID0gKGN0eC0+cGFn
ZV9saXN0X2hlYWQpLT5uZXh0OwotICAgICAgICAgICAgICAgIChjdHgtPnBhZ2VfbGlzdF9oZWFk
KS0+cHJldiA9IE5VTEw7Ci0gICAgICAgICAgICB9Ci0gICAgICAgICAgICBlbHNlIC8qIGl0ZW0g
aW4gbWlkZGxlIG9mIGxpc3QgKi8KLSAgICAgICAgICAgIHsgICAgICAgICAgICAKLSAgICAgICAg
ICAgICAgICBpdGVtLT5wcmV2LT5uZXh0ID0gaXRlbS0+bmV4dDsKLSAgICAgICAgICAgICAgICBp
dGVtLT5uZXh0LT5wcmV2ID0gaXRlbS0+cHJldjsKLSAgICAgICAgICAgIH0KLQotICAgICAgICAg
ICAgaXRlbS0+bmV4dCA9IE5VTEw7Ci0gICAgICAgICAgICBpdGVtLT5wcmV2ID0gY3R4LT5wYWdl
X2xpc3RfdGFpbDsKLSAgICAgICAgICAgIChjdHgtPnBhZ2VfbGlzdF90YWlsKS0+bmV4dCA9IGl0
ZW07Ci0gICAgICAgICAgICBjdHgtPnBhZ2VfbGlzdF90YWlsID0gaXRlbTsKLSAgICAgICAgfQot
ICAgICAgICBjdHgtPnBmbjJjYWNoZVtwZm5dID0gTlVMTDsKLSAgICAgICAgKGN0eC0+cGFnZV9s
aXN0X3RhaWwpLT5wZm4gPSBJTlZBTElEX1BGTjsKLSAgICB9Ci19Ci0KLWludCB4Y19jb21wcmVz
c2lvbl9hZGRfcGFnZSh4Y19pbnRlcmZhY2UgKnhjaCwgY29tcF9jdHggKmN0eCwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjaGFyICpwYWdlLCB4ZW5fcGZuX3QgcGZuLCBpbnQgaXNyYXcp
Ci17Ci0gICAgaWYgKHBmbiA+IGN0eC0+ZG9tX3Bmbmxpc3Rfc2l6ZSkKLSAgICB7Ci0gICAgICAg
IEVSUk9SKCJJbnZhbGlkIHBmbiBwYXNzZWQgaW50byAiCi0gICAgICAgICAgICAgICJ4Y19jb21w
cmVzc2lvbl9hZGRfcGFnZSAlIiBQUklwZm4gIlxuIiwgcGZuKTsKLSAgICAgICAgcmV0dXJuIC0y
OwotICAgIH0KLQotICAgIC8qIHBhZ2V0YWJsZSBwYWdlICovCi0gICAgaWYgKGlzcmF3KQotICAg
ICAgICBpbnZhbGlkYXRlX2NhY2hlX3BhZ2UoY3R4LCBwZm4pOwotICAgIGN0eC0+c2VuZGJ1Zl9w
Zm5zW2N0eC0+cGZuc19sZW5dID0gaXNyYXcgPyBJTlZBTElEX1BGTiA6IHBmbjsKLSAgICBtZW1j
cHkoY3R4LT5pbnB1dGJ1ZiArIGN0eC0+cGZuc19sZW4gKiBYQ19QQUdFX1NJWkUsIHBhZ2UsIFhD
X1BBR0VfU0laRSk7Ci0gICAgY3R4LT5wZm5zX2xlbisrOwotCi0gICAgLyogY2hlY2sgaWYgd2Ug
aGF2ZSBydW4gb3V0IG9mIHNwYWNlLiBJZiBzbywKLSAgICAgKiB3ZSBuZWVkIHRvIHN5bmNocm9u
b3VzbHkgY29tcHJlc3MgdGhlIHBhZ2VzIGFuZCBmbHVzaCB0aGVtIG91dAotICAgICAqLwotICAg
IGlmIChjdHgtPnBmbnNfbGVuID09IE5SUEFHRVMoUEFHRV9CVUZGRVJfU0laRSkpCi0gICAgICAg
IHJldHVybiAtMTsKLSAgICByZXR1cm4gMDsKLX0KLQotaW50IHhjX2NvbXByZXNzaW9uX2NvbXBy
ZXNzX3BhZ2VzKHhjX2ludGVyZmFjZSAqeGNoLCBjb21wX2N0eCAqY3R4LAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKmNvbXBidWYsIHVuc2lnbmVkIGxvbmcgY29tcGJ1
Zl9zaXplLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcg
KmNvbXBidWZfbGVuKQotewotICAgIGNoYXIgKmNhY2hlX2NvcHkgPSBOVUxMLCAqY3VycmVudF9w
YWdlID0gTlVMTDsKLSAgICBpbnQgaXNyYXcsIHJjID0gMTsKLQotICAgIGlmICghY3R4LT5wZm5z
X2xlbiB8fCAoY3R4LT5wZm5zX2luZGV4ID09IGN0eC0+cGZuc19sZW4pKSB7Ci0gICAgICAgIGN0
eC0+cGZuc19sZW4gPSBjdHgtPnBmbnNfaW5kZXggPSAwOwotICAgICAgICByZXR1cm4gMDsKLSAg
ICB9Ci0KLSAgICBjdHgtPmNvbXBidWZfcG9zID0gMDsKLSAgICBjdHgtPmNvbXBidWYgPSBjb21w
YnVmOwotICAgIGN0eC0+Y29tcGJ1Zl9zaXplID0gY29tcGJ1Zl9zaXplOwotCi0gICAgZm9yICg7
IGN0eC0+cGZuc19pbmRleCA8IGN0eC0+cGZuc19sZW47IGN0eC0+cGZuc19pbmRleCsrKQotICAg
IHsKLSAgICAgICAgaXNyYXcgPSAwOwotICAgICAgICBjYWNoZV9jb3B5ID0gTlVMTDsKLSAgICAg
ICAgY3VycmVudF9wYWdlID0gY3R4LT5pbnB1dGJ1ZiArIGN0eC0+cGZuc19pbmRleCAqIFhDX1BB
R0VfU0laRTsKLQotICAgICAgICBpZiAoY3R4LT5zZW5kYnVmX3BmbnNbY3R4LT5wZm5zX2luZGV4
XSA9PSBJTlZBTElEX1BGTikKLSAgICAgICAgICAgIGlzcmF3ID0gMTsKLSAgICAgICAgZWxzZQot
ICAgICAgICAgICAgY2FjaGVfY29weSA9IGdldF9jYWNoZV9wYWdlKGN0eCwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPnNlbmRidWZfcGZuc1tjdHgtPnBmbnNf
aW5kZXhdLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZpc3Jhdyk7
Ci0KLSAgICAgICAgaWYgKGlzcmF3KQotICAgICAgICAgICAgcmMgPSAoYWRkX2Z1bGxfcGFnZShj
dHgsIGN1cnJlbnRfcGFnZSwgY2FjaGVfY29weSkgPj0gMCk7Ci0gICAgICAgIGVsc2UKLSAgICAg
ICAgICAgIHJjID0gKGNvbXByZXNzX3BhZ2UoY3R4LCBjdXJyZW50X3BhZ2UsIGNhY2hlX2NvcHkp
ID49IDApOwotCi0gICAgICAgIGlmICggIXJjICkKLSAgICAgICAgewotICAgICAgICAgICAgLyog
T3V0IG9mIHNwYWNlIGluIG91dGJ1ZiEgZmx1c2ggYW5kIGNvbWUgYmFjayAqLwotICAgICAgICAg
ICAgcmMgPSAtMTsKLSAgICAgICAgICAgIGJyZWFrOwotICAgICAgICB9Ci0gICAgfQotICAgIGlm
IChjb21wYnVmX2xlbikKLSAgICAgICAgKmNvbXBidWZfbGVuID0gY3R4LT5jb21wYnVmX3BvczsK
LQotICAgIHJldHVybiByYzsKLX0KLQotaW5saW5lCi12b2lkIHhjX2NvbXByZXNzaW9uX3Jlc2V0
X3BhZ2VidWYoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbXBfY3R4ICpjdHgpCi17Ci0gICAgY3R4LT5w
Zm5zX2luZGV4ID0gY3R4LT5wZm5zX2xlbiA9IDA7Ci19Ci0KLWludCB4Y19jb21wcmVzc2lvbl91
bmNvbXByZXNzX3BhZ2UoeGNfaW50ZXJmYWNlICp4Y2gsIGNoYXIgKmNvbXBidWYsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgY29tcGJ1Zl9zaXplLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICpjb21wYnVm
X3BvcywgY2hhciAqZGVzdHBhZ2UpCi17Ci0gICAgdW5zaWduZWQgbG9uZyBwb3M7Ci0gICAgdW5z
aWduZWQgaW50IGxlbiA9IDAsIHBhZ2Vwb3MgPSAwOwotICAgIGNoYXIgZmxhZzsKLQotICAgIHBv
cyA9ICpjb21wYnVmX3BvczsKLSAgICBpZiAocG9zID49IGNvbXBidWZfc2l6ZSkKLSAgICB7Ci0g
ICAgICAgIEVSUk9SKCJPdXQgb2YgYm91bmRzIGV4Y2VwdGlvbiBpbiBjb21wcmVzc2lvbiBidWZm
ZXIgKGEpOiIKLSAgICAgICAgICAgICAgInJlYWQgcHRyOiVsdSwgYnVmc2l6ZSA9ICVsdVxuIiwK
LSAgICAgICAgICAgICAgKmNvbXBidWZfcG9zLCBjb21wYnVmX3NpemUpOwotICAgICAgICByZXR1
cm4gLTE7Ci0gICAgfQotCi0gICAgc3dpdGNoIChjb21wYnVmW3Bvc10pCi0gICAgewotICAgIGNh
c2UgRU1QVFlfUEFHRToKLSAgICAgICAgcG9zKys7Ci0gICAgICAgIGJyZWFrOwotCi0gICAgY2Fz
ZSBGVUxMX1BBR0U6Ci0gICAgICAgIHsKLSAgICAgICAgICAgIC8qIENoZWNrIGlmIHRoZSBpbnB1
dCBidWZmZXIgaGFzIDRLQiBvZiBkYXRhICovCi0gICAgICAgICAgICBpZiAoKHBvcyArIEZVTExf
UEFHRV9TSVpFKSA+IGNvbXBidWZfc2l6ZSkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAg
ICBFUlJPUigiT3V0IG9mIGJvdW5kcyBleGNlcHRpb24gaW4gY29tcHJlc3Npb24gYnVmZmVyIChi
KToiCi0gICAgICAgICAgICAgICAgICAgICAgInJlYWQgcHRyID0gJWx1LCBidWZzaXplID0gJWx1
XG4iLAotICAgICAgICAgICAgICAgICAgICAgICpjb21wYnVmX3BvcywgY29tcGJ1Zl9zaXplKTsK
LSAgICAgICAgICAgICAgICByZXR1cm4gLTE7Ci0gICAgICAgICAgICB9Ci0gICAgICAgICAgICBt
ZW1jcHkoZGVzdHBhZ2UsICZjb21wYnVmW3BvcyArIDFdLCBYQ19QQUdFX1NJWkUpOwotICAgICAg
ICAgICAgcG9zICs9IEZVTExfUEFHRV9TSVpFOwotICAgICAgICB9Ci0gICAgICAgIGJyZWFrOwot
Ci0gICAgZGVmYXVsdDogLyogTm9ybWFsIHBhZ2Ugd2l0aCBvbmUgb3IgbW9yZSBydW5zICovCi0g
ICAgICAgIHsKLSAgICAgICAgICAgIGRvCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAg
ZmxhZyA9IGNvbXBidWZbcG9zXSAmIEZMQUdNQVNLOwotICAgICAgICAgICAgICAgIGxlbiA9IChj
b21wYnVmW3Bvc10gJiBMRU5NQVNLKSAqIHNpemVvZih1aW50MzJfdCk7Ci0gICAgICAgICAgICAg
ICAgLyogU2FuaXR5IENoZWNrOiBaZXJvLWxlbmd0aCBydW5zIGFyZSBhbGxvd2VkIG9ubHkgZm9y
Ci0gICAgICAgICAgICAgICAgICogRlVMTF9QQUdFIGFuZCBFTVBUWV9QQUdFLgotICAgICAgICAg
ICAgICAgICAqLwotICAgICAgICAgICAgICAgIGlmICghbGVuKQotICAgICAgICAgICAgICAgIHsK
LSAgICAgICAgICAgICAgICAgICAgRVJST1IoIlplcm8gbGVuZ3RoIHJ1biBlbmNvdW50ZXJlZCBm
b3Igbm9ybWFsIHBhZ2U6ICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgImJ1ZmZlciAoZCk6
cmVhZCBwdHIgPSAlbHUsIGZsYWcgPSAldSwgIgotICAgICAgICAgICAgICAgICAgICAgICAgICAi
YnVmc2l6ZSA9ICVsdSwgcGFnZXBvcyA9ICV1XG4iLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICBwb3MsICh1bnNpZ25lZCBpbnQpZmxhZywgY29tcGJ1Zl9zaXplLCBwYWdlcG9zKTsKLSAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC0xOwotICAgICAgICAgICAgICAgIH0KLQotICAgICAgICAg
ICAgICAgIHBvcysrOwotICAgICAgICAgICAgICAgIGlmIChmbGFnID09IFJVTkZMQUcpCi0gICAg
ICAgICAgICAgICAgewotICAgICAgICAgICAgICAgICAgICAvKiBDaGVjayBpZiB0aGUgaW5wdXQg
YnVmZmVyIGhhcyBsZW4gYnl0ZXMgb2YgZGF0YQotICAgICAgICAgICAgICAgICAgICAgKiBhbmQg
d2hldGhlciBpdCB3b3VsZCBmaXQgaW4gdGhlIGRlc3RpbmF0aW9uIHBhZ2UuCi0gICAgICAgICAg
ICAgICAgICAgICAqLwotICAgICAgICAgICAgICAgICAgICBpZiAoKChwb3MgKyBsZW4pID4gY29t
cGJ1Zl9zaXplKQotICAgICAgICAgICAgICAgICAgICAgICAgfHwgKChwYWdlcG9zICsgbGVuKSA+
IFhDX1BBR0VfU0laRSkpCi0gICAgICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAg
ICAgICAgIEVSUk9SKCJPdXQgb2YgYm91bmRzIGV4Y2VwdGlvbiBpbiBjb21wcmVzc2lvbiAiCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYnVmZmVyIChjKTpyZWFkIHB0ciA9ICVsdSwg
cnVubGVuID0gJXUsICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJidWZzaXplID0g
JWx1LCBwYWdlcG9zID0gJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3Ms
IGxlbiwgY29tcGJ1Zl9zaXplLCBwYWdlcG9zKTsKLSAgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiAtMTsKLSAgICAgICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgICAgICBtZW1j
cHkoJmRlc3RwYWdlW3BhZ2Vwb3NdLCAmY29tcGJ1Zltwb3NdLCBsZW4pOwotICAgICAgICAgICAg
ICAgICAgICBwb3MgKz0gbGVuOwotICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICBw
YWdlcG9zICs9IGxlbjsKLSAgICAgICAgICAgIH0gd2hpbGUgKChwYWdlcG9zIDwgWENfUEFHRV9T
SVpFKSAmJiAocG9zIDwgY29tcGJ1Zl9zaXplKSk7Ci0KLSAgICAgICAgICAgIC8qIE1ha2Ugc3Vy
ZSB3ZSBoYXZlIGNvcGllZC9za2lwcGVkIDRLQiB3b3J0aCBvZiBkYXRhICovCi0gICAgICAgICAg
ICBpZiAocGFnZXBvcyAhPSBYQ19QQUdFX1NJWkUpCi0gICAgICAgICAgICB7Ci0gICAgICAgICAg
ICAgICAgRVJST1IoIkludmFsaWQgZGF0YSBpbiBjb21wcmVzc2lvbiBidWZmZXI6IgotICAgICAg
ICAgICAgICAgICAgICAgICJyZWFkIHB0ciA9ICVsdSwgYnVmc2l6ZSA9ICVsdSwgcGFnZXBvcyA9
ICV1XG4iLAotICAgICAgICAgICAgICAgICAgICAgIHBvcywgY29tcGJ1Zl9zaXplLCBwYWdlcG9z
KTsKLSAgICAgICAgICAgICAgICByZXR1cm4gLTE7Ci0gICAgICAgICAgICB9Ci0gICAgICAgIH0K
LSAgICB9Ci0gICAgKmNvbXBidWZfcG9zID0gcG9zOwotICAgIHJldHVybiAwOwotfQotCi12b2lk
IHhjX2NvbXByZXNzaW9uX2ZyZWVfY29udGV4dCh4Y19pbnRlcmZhY2UgKnhjaCwgY29tcF9jdHgg
KmN0eCkKLXsKLSAgICBpZiAoIWN0eCkgcmV0dXJuOwotCi0gICAgZnJlZShjdHgtPmlucHV0YnVm
KTsKLSAgICBmcmVlKGN0eC0+c2VuZGJ1Zl9wZm5zKTsKLSAgICBmcmVlKGN0eC0+Y2FjaGVfYmFz
ZSk7Ci0gICAgZnJlZShjdHgtPnBmbjJjYWNoZSk7Ci0gICAgZnJlZShjdHgtPmNhY2hlKTsKLSAg
ICBmcmVlKGN0eCk7Ci19Ci0KLWNvbXBfY3R4ICp4Y19jb21wcmVzc2lvbl9jcmVhdGVfY29udGV4
dCh4Y19pbnRlcmZhY2UgKnhjaCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBsb25nIHAybV9zaXplKQotewotICAgIHVuc2lnbmVkIGxvbmcgaTsKLSAg
ICBjb21wX2N0eCAqY3R4ID0gTlVMTDsKLSAgICB1bnNpZ25lZCBsb25nIG51bV9jYWNoZV9wYWdl
cyA9IERFTFRBX0NBQ0hFX1NJWkUvWENfUEFHRV9TSVpFOwotCi0gICAgY3R4ID0gKGNvbXBfY3R4
ICopbWFsbG9jKHNpemVvZihjb21wX2N0eCkpOwotICAgIGlmICghY3R4KQotICAgIHsKLSAgICAg
ICAgRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBjb21wcmVzc2lvbl9jdHhcbiIpOwotICAgICAg
ICBnb3RvIGVycm9yOwotICAgIH0KLSAgICBtZW1zZXQoY3R4LCAwLCBzaXplb2YoY29tcF9jdHgp
KTsKLQotICAgIGN0eC0+aW5wdXRidWYgPSB4Y19tZW1hbGlnbih4Y2gsIFhDX1BBR0VfU0laRSwg
UEFHRV9CVUZGRVJfU0laRSk7Ci0gICAgaWYgKCFjdHgtPmlucHV0YnVmKQotICAgIHsKLSAgICAg
ICAgRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBwYWdlIGJ1ZmZlclxuIik7Ci0gICAgICAgIGdv
dG8gZXJyb3I7Ci0gICAgfQotCi0gICAgY3R4LT5jYWNoZV9iYXNlID0geGNfbWVtYWxpZ24oeGNo
LCBYQ19QQUdFX1NJWkUsIERFTFRBX0NBQ0hFX1NJWkUpOwotICAgIGlmICghY3R4LT5jYWNoZV9i
YXNlKQotICAgIHsKLSAgICAgICAgRVJST1IoIkZhaWxlZCB0byBhbGxvY2F0ZSBkZWx0YSBjYWNo
ZVxuIik7Ci0gICAgICAgIGdvdG8gZXJyb3I7Ci0gICAgfQotCi0gICAgY3R4LT5zZW5kYnVmX3Bm
bnMgPSBtYWxsb2MoTlJQQUdFUyhQQUdFX0JVRkZFUl9TSVpFKSAqCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc2l6ZW9mKHhlbl9wZm5fdCkpOwotICAgIGlmICghY3R4LT5zZW5kYnVm
X3BmbnMpCi0gICAgewotICAgICAgICBFUlJPUigiQ291bGQgbm90IGFsbG9jIHNlbmRidWZfcGZu
c1xuIik7Ci0gICAgICAgIGdvdG8gZXJyb3I7Ci0gICAgfQotICAgIG1lbXNldChjdHgtPnNlbmRi
dWZfcGZucywgLTEsCi0gICAgICAgICAgIE5SUEFHRVMoUEFHRV9CVUZGRVJfU0laRSkgKiBzaXpl
b2YoeGVuX3Bmbl90KSk7Ci0KLSAgICBjdHgtPnBmbjJjYWNoZSA9IGNhbGxvYyhwMm1fc2l6ZSwg
c2l6ZW9mKHN0cnVjdCBjYWNoZV9wYWdlICopKTsKLSAgICBpZiAoIWN0eC0+cGZuMmNhY2hlKQot
ICAgIHsKLSAgICAgICAgRVJST1IoIkNvdWxkIG5vdCBhbGxvYyBwZm4yY2FjaGUgbWFwXG4iKTsK
LSAgICAgICAgZ290byBlcnJvcjsKLSAgICB9Ci0KLSAgICBjdHgtPmNhY2hlID0gbWFsbG9jKG51
bV9jYWNoZV9wYWdlcyAqIHNpemVvZihzdHJ1Y3QgY2FjaGVfcGFnZSkpOwotICAgIGlmICghY3R4
LT5jYWNoZSkKLSAgICB7Ci0gICAgICAgIEVSUk9SKCJDb3VsZCBub3QgYWxsb2MgY29tcHJlc3Np
b24gY2FjaGVcbiIpOwotICAgICAgICBnb3RvIGVycm9yOwotICAgIH0KLQotICAgIGZvciAoaSA9
IDA7IGkgPCBudW1fY2FjaGVfcGFnZXM7IGkrKykKLSAgICB7Ci0gICAgICAgIGN0eC0+Y2FjaGVb
aV0ucGZuID0gSU5WQUxJRF9QRk47Ci0gICAgICAgIGN0eC0+Y2FjaGVbaV0ucGFnZSA9IGN0eC0+
Y2FjaGVfYmFzZSArIGkgKiBYQ19QQUdFX1NJWkU7Ci0gICAgICAgIGN0eC0+Y2FjaGVbaV0ucHJl
diA9IChpID09IDApID8gTlVMTCA6ICYoY3R4LT5jYWNoZVtpIC0gMV0pOwotICAgICAgICBjdHgt
PmNhY2hlW2ldLm5leHQgPSAoKGkrMSkgPT0gbnVtX2NhY2hlX3BhZ2VzKT8gTlVMTCA6Ci0gICAg
ICAgICAgICAmKGN0eC0+Y2FjaGVbaSArIDFdKTsKLSAgICB9Ci0gICAgY3R4LT5wYWdlX2xpc3Rf
aGVhZCA9ICYoY3R4LT5jYWNoZVswXSk7Ci0gICAgY3R4LT5wYWdlX2xpc3RfdGFpbCA9ICYoY3R4
LT5jYWNoZVtudW1fY2FjaGVfcGFnZXMgLTFdKTsKLSAgICBjdHgtPmRvbV9wZm5saXN0X3NpemUg
PSBwMm1fc2l6ZTsKLQotICAgIHJldHVybiBjdHg7Ci1lcnJvcjoKLSAgICB4Y19jb21wcmVzc2lv
bl9mcmVlX2NvbnRleHQoeGNoLCBjdHgpOwotICAgIHJldHVybiBOVUxMOwotfQotCi0vKgotICog
TG9jYWwgdmFyaWFibGVzOgotICogbW9kZTogQwotICogYy1maWxlLXN0eWxlOiAiQlNEIgotICog
Yy1iYXNpYy1vZmZzZXQ6IDQKLSAqIHRhYi13aWR0aDogNAotICogaW5kZW50LXRhYnMtbW9kZTog
bmlsCi0gKiBFbmQ6Ci0gKi8KLS0gCjIuMTEuMAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxp
c3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9s
aXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 18EA212D1CD
	for <lists+xen-devel@lfdr.de>; Mon, 30 Dec 2019 17:15:19 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ilxeV-0002DE-CH; Mon, 30 Dec 2019 16:12:19 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=0QMt=2U=intel.com=tamas.lengyel@srs-us1.protection.inumbo.net>)
 id 1ilxeU-0002CO-54
 for xen-devel@lists.xenproject.org; Mon, 30 Dec 2019 16:12:18 +0000
X-Inumbo-ID: 18e3ffe6-2b1f-11ea-a04b-12813bfff9fa
Received: from mga14.intel.com (unknown [192.55.52.115])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 18e3ffe6-2b1f-11ea-a04b-12813bfff9fa;
 Mon, 30 Dec 2019 16:11:55 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by fmsmga103.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 30 Dec 2019 08:11:54 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.69,375,1571727600"; d="scan'208";a="221167326"
Received: from tlengyel-mobl2.amr.corp.intel.com (HELO localhost.localdomain)
 ([10.254.94.206])
 by orsmga003.jf.intel.com with ESMTP; 30 Dec 2019 08:11:53 -0800
From: Tamas K Lengyel <tamas.lengyel@intel.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 30 Dec 2019 08:11:30 -0800
Message-Id: <9624f5a21bc4c858d70bb008c9985bc2af0010e8.1577721845.git.tamas.lengyel@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1577721845.git.tamas.lengyel@intel.com>
References: <cover.1577721845.git.tamas.lengyel@intel.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 06/18] x86/mem_sharing: define
 mem_sharing_domain to hold some scattered variables
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Tamas K Lengyel <tamas@tklengyel.com>,
 Tamas K Lengyel <tamas.lengyel@intel.com>, Wei Liu <wl@xen.org>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Q3JlYXRlIHN0cnVjdCBtZW1fc2hhcmluZ19kb21haW4gdW5kZXIgaHZtX2RvbWFpbiBhbmQgbW92
ZSBtZW0gc2hhcmluZwp2YXJpYWJsZXMgaW50byBpdCBmcm9tIHAybV9kb21haW4gYW5kIGh2bV9k
b21haW4uCgpFeHBvc2UgdGhlIG1lbV9zaGFyaW5nX2VuYWJsZWQgbWFjcm8gdG8gYmUgdXNlZCBj
b25zaXN0ZW50bHkgYWNyb3NzIFhlbi4KClJlbW92ZSBzb21lIGR1cGxpY2F0ZSBjYWxscyB0byBt
ZW1fc2hhcmluZ19lbmFibGVkIGluIG1lbV9zaGFyaW5nLmMKClNpZ25lZC1vZmYtYnk6IFRhbWFz
IEsgTGVuZ3llbCA8dGFtYXMubGVuZ3llbEBpbnRlbC5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21t
L21lbV9zaGFyaW5nLmMgICAgIHwgMTAgKysrKy0tLS0tLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvcGNpLmMgICAgIHwgIDMgKy0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9kb21haW4uaCAg
fCAgNiArKysrKy0KIHhlbi9pbmNsdWRlL2FzbS14ODYvbWVtX3NoYXJpbmcuaCB8IDE2ICsrKysr
KysrKysrKysrKysKIHhlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmggICAgICAgICB8ICA0IC0tLS0K
IDUgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0aW9ucygrKSwgMTMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tL21lbV9zaGFyaW5nLmMgYi94ZW4vYXJjaC94ODYvbW0v
bWVtX3NoYXJpbmcuYwppbmRleCBmNjE4NzQwM2EwLi4zYWE2MWMzMGU2IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0vbWVtX3NoYXJpbmcuYworKysgYi94ZW4vYXJjaC94ODYvbW0vbWVtX3No
YXJpbmcuYwpAQCAtMTk3LDkgKzE5Nyw2IEBAIHN0YXRpYyBzaHJfaGFuZGxlX3QgZ2V0X25leHRf
aGFuZGxlKHZvaWQpCiAgICAgcmV0dXJuIHggKyAxOwogfQogCi0jZGVmaW5lIG1lbV9zaGFyaW5n
X2VuYWJsZWQoZCkgXAotICAgIChpc19odm1fZG9tYWluKGQpICYmIChkKS0+YXJjaC5odm0ubWVt
X3NoYXJpbmdfZW5hYmxlZCkKLQogc3RhdGljIGF0b21pY190IG5yX3NhdmVkX21mbnMgICA9IEFU
T01JQ19JTklUKDApOwogc3RhdGljIGF0b21pY190IG5yX3NoYXJlZF9tZm5zICA9IEFUT01JQ19J
TklUKDApOwogCkBAIC0xMzA5LDYgKzEzMDYsNyBAQCBpbnQgX19tZW1fc2hhcmluZ191bnNoYXJl
X3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwKIGludCByZWxpbnF1aXNoX3NoYXJlZF9wYWdlcyhzdHJ1
Y3QgZG9tYWluICpkKQogewogICAgIGludCByYyA9IDA7CisgICAgc3RydWN0IG1lbV9zaGFyaW5n
X2RvbWFpbiAqbXNkID0gJmQtPmFyY2guaHZtLm1lbV9zaGFyaW5nOwogICAgIHN0cnVjdCBwMm1f
ZG9tYWluICpwMm0gPSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAgICAgdW5zaWduZWQgbG9uZyBnZm4s
IGNvdW50ID0gMDsKIApAQCAtMTMxNiw3ICsxMzE0LDcgQEAgaW50IHJlbGlucXVpc2hfc2hhcmVk
X3BhZ2VzKHN0cnVjdCBkb21haW4gKmQpCiAgICAgICAgIHJldHVybiAwOwogCiAgICAgcDJtX2xv
Y2socDJtKTsKLSAgICBmb3IgKCBnZm4gPSBwMm0tPm5leHRfc2hhcmVkX2dmbl90b19yZWxpbnF1
aXNoOworICAgIGZvciAoIGdmbiA9IG1zZC0+bmV4dF9zaGFyZWRfZ2ZuX3RvX3JlbGlucXVpc2g7
CiAgICAgICAgICAgZ2ZuIDw9IHAybS0+bWF4X21hcHBlZF9wZm47IGdmbisrICkKICAgICB7CiAg
ICAgICAgIHAybV9hY2Nlc3NfdCBhOwpAQCAtMTM1MSw3ICsxMzQ5LDcgQEAgaW50IHJlbGlucXVp
c2hfc2hhcmVkX3BhZ2VzKHN0cnVjdCBkb21haW4gKmQpCiAgICAgICAgIHsKICAgICAgICAgICAg
IGlmICggaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgICAgICB7Ci0gICAgICAg
ICAgICAgICAgcDJtLT5uZXh0X3NoYXJlZF9nZm5fdG9fcmVsaW5xdWlzaCA9IGdmbiArIDE7Cisg
ICAgICAgICAgICAgICAgbXNkLT5uZXh0X3NoYXJlZF9nZm5fdG9fcmVsaW5xdWlzaCA9IGdmbiAr
IDE7CiAgICAgICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgYnJl
YWs7CiAgICAgICAgICAgICB9CkBAIC0xNDM3LDcgKzE0MzUsNyBAQCBpbnQgbWVtX3NoYXJpbmdf
bWVtb3AoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fbWVtX3NoYXJpbmdfb3BfdCkgYXJnKQog
CiAgICAgLyogT25seSBIQVAgaXMgc3VwcG9ydGVkICovCiAgICAgcmMgPSAtRU5PREVWOwotICAg
IGlmICggIWhhcF9lbmFibGVkKGQpIHx8ICFkLT5hcmNoLmh2bS5tZW1fc2hhcmluZ19lbmFibGVk
ICkKKyAgICBpZiAoICFtZW1fc2hhcmluZ19lbmFibGVkKGQpICkKICAgICAgICAgZ290byBvdXQ7
CiAKICAgICBzd2l0Y2ggKCBtc28ub3AgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvcGNpLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwppbmRleCBjMDdhNjM5
ODFhLi42NWQxZDQ1N2ZmIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2ku
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwpAQCAtMTQ5OCw4ICsxNDk4LDcg
QEAgc3RhdGljIGludCBhc3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4gKmQsIHUxNiBzZWcsIHU4
IGJ1cywgdTggZGV2Zm4sIHUzMiBmbGFnKQogICAgIC8qIFByZXZlbnQgZGV2aWNlIGFzc2lnbiBp
ZiBtZW0gcGFnaW5nIG9yIG1lbSBzaGFyaW5nIGhhdmUgYmVlbiAKICAgICAgKiBlbmFibGVkIGZv
ciB0aGlzIGRvbWFpbiAqLwogICAgIGlmICggZCAhPSBkb21faW8gJiYKLSAgICAgICAgIHVubGlr
ZWx5KChpc19odm1fZG9tYWluKGQpICYmCi0gICAgICAgICAgICAgICAgICAgZC0+YXJjaC5odm0u
bWVtX3NoYXJpbmdfZW5hYmxlZCkgfHwKKyAgICAgICAgIHVubGlrZWx5KG1lbV9zaGFyaW5nX2Vu
YWJsZWQoZCkgfHwKICAgICAgICAgICAgICAgICAgIHZtX2V2ZW50X2NoZWNrX3JpbmcoZC0+dm1f
ZXZlbnRfcGFnaW5nKSB8fAogICAgICAgICAgICAgICAgICAgcDJtX2dldF9ob3N0cDJtKGQpLT5n
bG9iYWxfbG9nZGlydHkpICkKICAgICAgICAgcmV0dXJuIC1FWERFVjsKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvaHZtL2RvbWFpbi5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0v
ZG9tYWluLmgKaW5kZXggYmNjNTYyMTc5Ny4uOGY3MGJhMmIxYSAxMDA2NDQKLS0tIGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9odm0vZG9tYWluLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0v
ZG9tYWluLmgKQEAgLTI5LDYgKzI5LDcgQEAKICNpbmNsdWRlIDxhc20vaHZtL3ZpcmlkaWFuLmg+
CiAjaW5jbHVkZSA8YXNtL2h2bS92bXgvdm1jcy5oPgogI2luY2x1ZGUgPGFzbS9odm0vc3ZtL3Zt
Y2IuaD4KKyNpbmNsdWRlIDxhc20vbWVtX3NoYXJpbmcuaD4KICNpbmNsdWRlIDxwdWJsaWMvZ3Jh
bnRfdGFibGUuaD4KICNpbmNsdWRlIDxwdWJsaWMvaHZtL3BhcmFtcy5oPgogI2luY2x1ZGUgPHB1
YmxpYy9odm0vc2F2ZS5oPgpAQCAtMTU2LDcgKzE1Nyw2IEBAIHN0cnVjdCBodm1fZG9tYWluIHsK
IAogICAgIHN0cnVjdCB2aXJpZGlhbl9kb21haW4gKnZpcmlkaWFuOwogCi0gICAgYm9vbF90ICAg
ICAgICAgICAgICAgICBtZW1fc2hhcmluZ19lbmFibGVkOwogICAgIGJvb2xfdCAgICAgICAgICAg
ICAgICAgcWVtdV9tYXBjYWNoZV9pbnZhbGlkYXRlOwogICAgIGJvb2xfdCAgICAgICAgICAgICAg
ICAgaXNfczNfc3VzcGVuZGVkOwogCkBAIC0xOTIsNiArMTkyLDEwIEBAIHN0cnVjdCBodm1fZG9t
YWluIHsKICAgICAgICAgc3RydWN0IHZteF9kb21haW4gdm14OwogICAgICAgICBzdHJ1Y3Qgc3Zt
X2RvbWFpbiBzdm07CiAgICAgfTsKKworI2lmZGVmIENPTkZJR19NRU1fU0hBUklORworICAgIHN0
cnVjdCBtZW1fc2hhcmluZ19kb21haW4gbWVtX3NoYXJpbmc7CisjZW5kaWYKIH07CiAKICNlbmRp
ZiAvKiBfX0FTTV9YODZfSFZNX0RPTUFJTl9IX18gKi8KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRl
L2FzbS14ODYvbWVtX3NoYXJpbmcuaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbWVtX3NoYXJpbmcu
aAppbmRleCBjZjc4NDg3MDlmLi4xMzExNGI2MzQ2IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9h
c20teDg2L21lbV9zaGFyaW5nLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tZW1fc2hhcmlu
Zy5oCkBAIC0yNiw2ICsyNiwyMCBAQAogCiAjaWZkZWYgQ09ORklHX01FTV9TSEFSSU5HCiAKK3N0
cnVjdCBtZW1fc2hhcmluZ19kb21haW4KK3sKKyAgICBib29sIGVuYWJsZWQ7CisKKyAgICAvKgor
ICAgICAqIFdoZW4gcmVsZWFzaW5nIHNoYXJlZCBnZm4ncyBpbiBhIHByZWVtcHRpYmxlIG1hbm5l
ciwgcmVjYWxsIHdoZXJlCisgICAgICogdG8gcmVzdW1lIHRoZSBzZWFyY2guCisgICAgICovCisg
ICAgdW5zaWduZWQgbG9uZyBuZXh0X3NoYXJlZF9nZm5fdG9fcmVsaW5xdWlzaDsKK307CisKKyNk
ZWZpbmUgbWVtX3NoYXJpbmdfZW5hYmxlZChkKSBcCisgICAgKGhhcF9lbmFibGVkKGQpICYmIChk
KS0+YXJjaC5odm0ubWVtX3NoYXJpbmcuZW5hYmxlZCkKKwogLyogQXVkaXRpbmcgb2YgbWVtb3J5
IHNoYXJpbmcgY29kZT8gKi8KICNpZm5kZWYgTkRFQlVHCiAjZGVmaW5lIE1FTV9TSEFSSU5HX0FV
RElUIDEKQEAgLTEwNCw2ICsxMTgsOCBAQCBpbnQgcmVsaW5xdWlzaF9zaGFyZWRfcGFnZXMoc3Ry
dWN0IGRvbWFpbiAqZCk7CiAKICNlbHNlCiAKKyNkZWZpbmUgbWVtX3NoYXJpbmdfZW5hYmxlZChk
KSBmYWxzZQorCiBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBtZW1fc2hhcmluZ19nZXRfbnJf
c2F2ZWRfbWZucyh2b2lkKQogewogICAgIHJldHVybiAwOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1
ZGUvYXNtLXg4Ni9wMm0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKaW5kZXggNzM5OWM0
YTg5Ny4uOGRlZmE5MDMwNiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wMm0uaAor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5oCkBAIC0zMDUsMTAgKzMwNSw2IEBAIHN0cnVj
dCBwMm1fZG9tYWluIHsKICAgICB1bnNpZ25lZCBsb25nIG1pbl9yZW1hcHBlZF9nZm47CiAgICAg
dW5zaWduZWQgbG9uZyBtYXhfcmVtYXBwZWRfZ2ZuOwogCi0gICAgLyogV2hlbiByZWxlYXNpbmcg
c2hhcmVkIGdmbidzIGluIGEgcHJlZW1wdGlibGUgbWFubmVyLCByZWNhbGwgd2hlcmUKLSAgICAg
KiB0byByZXN1bWUgdGhlIHNlYXJjaCAqLwotICAgIHVuc2lnbmVkIGxvbmcgbmV4dF9zaGFyZWRf
Z2ZuX3RvX3JlbGlucXVpc2g7Ci0KICNpZmRlZiBDT05GSUdfSFZNCiAgICAgLyogUG9wdWxhdGUt
b24tZGVtYW5kIHZhcmlhYmxlcwogICAgICAqIEFsbCB2YXJpYWJsZXMgYXJlIHByb3RlY3RlZCB3
aXRoIHRoZSBwb2QgbG9jay4gV2UgY2Fubm90IHJlbHkgb24KLS0gCjIuMjAuMQoKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5n
IGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJv
amVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DF89078D048
	for <lists+xen-devel@lfdr.de>; Wed, 30 Aug 2023 01:20:34 +0200 (CEST)
Received: from list by lists.xenproject.org with outflank-mailman.592511.925266 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1qb808-0007Wl-AU; Tue, 29 Aug 2023 23:20:00 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 592511.925266; Tue, 29 Aug 2023 23:20:00 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1qb808-0007Uw-6Q; Tue, 29 Aug 2023 23:20:00 +0000
Received: by outflank-mailman (input) for mailman id 592511;
 Tue, 29 Aug 2023 23:19:58 +0000
Received: from se1-gles-flk1-in.inumbo.com ([94.247.172.50]
 helo=se1-gles-flk1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=Y18t=EO=epam.com=prvs=36058b40d2=volodymyr_babchuk@srs-se1.protection.inumbo.net>)
 id 1qb806-0006kQ-7h
 for xen-devel@lists.xenproject.org; Tue, 29 Aug 2023 23:19:58 +0000
Received: from mx0b-0039f301.pphosted.com (mx0b-0039f301.pphosted.com
 [148.163.137.242]) by se1-gles-flk1.inumbo.com (Halon) with ESMTPS
 id 8febe2ce-46c2-11ee-9b0d-b553b5be7939;
 Wed, 30 Aug 2023 01:19:55 +0200 (CEST)
Received: from pps.filterd (m0174682.ppops.net [127.0.0.1])
 by mx0b-0039f301.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 37TFMk9j021983; Tue, 29 Aug 2023 23:19:51 GMT
Received: from eur05-db8-obe.outbound.protection.outlook.com
 (mail-db8eur05lp2108.outbound.protection.outlook.com [104.47.17.108])
 by mx0b-0039f301.pphosted.com (PPS) with ESMTPS id 3ssdvpbm4f-5
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 29 Aug 2023 23:19:51 +0000
Received: from VI1PR03MB3710.eurprd03.prod.outlook.com (2603:10a6:803:31::18)
 by AM7PR03MB6371.eurprd03.prod.outlook.com (2603:10a6:20b:1b8::20)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6699.35; Tue, 29 Aug
 2023 23:19:43 +0000
Received: from VI1PR03MB3710.eurprd03.prod.outlook.com
 ([fe80::9d42:8444:f00d:7895]) by VI1PR03MB3710.eurprd03.prod.outlook.com
 ([fe80::9d42:8444:f00d:7895%4]) with mapi id 15.20.6699.034; Tue, 29 Aug 2023
 23:19:43 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: 8febe2ce-46c2-11ee-9b0d-b553b5be7939
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=SypQwkUbvN/L1vdbszievjyluja2bV3l0pj0lkLyfo7W5ADzSahuX8raESuYvVnBjrIyAaB62hSA+3eri8gGBWCj2ebqwAsjtwJ6qBa62QLpi2/SsKd7y68qqajf+s4U7r/RMe05D/KmjmefKQkMPyv+lxMp2NKBfkQfs0B2iErIr7wg22hdhmoCnZrwOZipoidhESYihesOs2s8YB/0p0il/mU9UTJ7IGJ81SumylzQ7XGwIRxhWOjMu3CbUXFUvqwV+E9jpaqOLdSuIdZlkD00WRKGCJJCwQt3B/bpMeP3ophYOJUzhkHhkTAiYDa3WBGdyCiUu+RKgs2kWt59Nw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=imFiRlRgcy7VyVgiEylGKNGZs2FbczvBHx5r958a0tE=;
 b=RAxX74TuSGGpWvvyFGflCn+Rl8o+Q13OMUlV5l93h6eLn4miLk9MSves1fp8BF4sIrrsBX/Hju81X1s3yIVh4FX5M2Hh4curz9RmQmtD7KFkdeQxnm7nVCXsYTrFbTat/WfT+yPAaJS+oCYJe5A9I9EaoJgftVU776zitQVw8fMExjnzGm/wKBLrzUWt6UPMD5SVZbUZqyZzVCxRgWJlmwFhhA5ocCuw4ypwezecMflqJwcuZhKG7RDGLYpDE/niqDVkfYJB4CKgkIdFm0Q+h5jfNuIQnqWp2cnN0JJl/OgQPBBHWnOOT3LY/yO7OvpAkEE3KYqvntz8U/bmT6GM6Q==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=epam.com; dmarc=pass action=none header.from=epam.com;
 dkim=pass header.d=epam.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=epam.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=imFiRlRgcy7VyVgiEylGKNGZs2FbczvBHx5r958a0tE=;
 b=RGYMcy2eytKPGBT5BQ7jLhlcxY5nIFpgLUdjZTM7592fp2FZJuMLFpBf0cBczqUDT2oq9MFhBDiYm3/lZUvdFHTAEyGuXHw0ifl8zHFviPM8WwiHHyZX6je20qX5jML9WKhMS4/S2+z7GaLXof34F6XpU5+MxjiOhediTQG1aCxl3ZDjZu9MtWlXs9H/x1TPxlB4kZvdvsVWOOrAykJy3YfwPbqafRXTJTKEbi4C/Z2De7G5NU4WFki+3cuPlQzwn3FcYaOoDfBrknIL8lCnlP2GGMhpJne6yclNv1wkYJtDdaQllXZIN3HPt9Jcll9V286kXP9t94fcANKOd7JYow==
From: Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
CC: Stewart Hildebrand <stewart.hildebrand@amd.com>,
        Oleksandr Andrushchenko
	<Oleksandr_Andrushchenko@epam.com>,
        Jan Beulich <jbeulich@suse.com>,
        Andrew
 Cooper <andrew.cooper3@citrix.com>,
        =?utf-8?B?Um9nZXIgUGF1IE1vbm7DqQ==?=
	<roger.pau@citrix.com>,
        Wei Liu <wl@xen.org>, Jun Nakajima
	<jun.nakajima@intel.com>,
        Kevin Tian <kevin.tian@intel.com>, Paul Durrant
	<paul@xen.org>,
        Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
Subject: [PATCH v9 02/16] vpci: use per-domain PCI lock to protect vpci
 structure
Thread-Topic: [PATCH v9 02/16] vpci: use per-domain PCI lock to protect vpci
 structure
Thread-Index: AQHZ2s9KfUsugiaE80OWAJ/SuT82fA==
Date: Tue, 29 Aug 2023 23:19:42 +0000
Message-ID: <20230829231912.4091958-3-volodymyr_babchuk@epam.com>
References: <20230829231912.4091958-1-volodymyr_babchuk@epam.com>
In-Reply-To: <20230829231912.4091958-1-volodymyr_babchuk@epam.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.41.0
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: VI1PR03MB3710:EE_|AM7PR03MB6371:EE_
x-ms-office365-filtering-correlation-id: 3c7aa324-2cd4-4e57-048c-08dba8e66d6f
x-ld-processed: b41b72d0-4e9f-4c26-8a69-f949f367c91d,ExtAddr
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: 
 s6ra7aw/SB+PYiz/jSl5rWWLCyYH4QM5wxKab9OVD0s3YVy/MCmCY+Zm8/wORY2/r//0VRUTM8lEx+5HehtUkJn9PpAZvdwl0P7J5PJQv7b7ybGZ7jOZBxFlvz8O7jg7+JqT97xybz7bmnNj+FmMXwA/k9U8UTJcv50rNU0sa4RiSpz/LYYCKISdiVRV/jR59piEhqsh50yIfMRMHj9BHyW1NPh25FvHslh+oY2D6e2g1dCp0tYR7TAPyuonSOJ4dDEFzrXADzcM7gDYMu+lDcjYFez23JvM0yVBItrpP6LmurMjtxCBfGmO44j/b2bMhzR+5BAOJLO3axrrGPqHL3fTlJsSdgI8gzp8rKulD6rpAJqDgrwz0c+m7dnX5h+evKlRDl75ezgVMGtj6Mfk+E5tnJOWoDwp4X5OzVqVgTIzMh3J0sYBWst1EvId8qILvumi4En/F3Z8Vn4kNioH2KbNyZAXe6+hEDQoNN661m1876huYgdTLVeRjE34pzfwkZhbZhWp7wlTesoNI3EgsfRT2JuvPrWU/9FNaBITjcZdtnNvOUfTVgF7TbAyNyvZsMcfmF+ffbIlumTWn16IRR6knTIBJsZo5Z7fcsHG21976OvNgZwW94qb2IjWcNj/AX0DFl0dKxRku7wllZgcug==
x-forefront-antispam-report: 
 CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:VI1PR03MB3710.eurprd03.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230031)(346002)(39860400002)(376002)(396003)(136003)(366004)(451199024)(1800799009)(186009)(71200400001)(6512007)(6506007)(6486002)(478600001)(55236004)(76116006)(1076003)(2616005)(107886003)(26005)(30864003)(2906002)(6916009)(64756008)(66446008)(54906003)(316002)(5660300002)(66476007)(66556008)(91956017)(66946007)(41300700001)(83380400001)(8936002)(4326008)(8676002)(36756003)(38070700005)(38100700002)(86362001)(122000001)(579004)(559001)(309714004);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: 
 =?utf-8?B?OUtLdy9OZEtzbzBUNm9ZZHFIanlxa2ZpTS8rRDRmY09XS055TjRaVFc4Q21p?=
 =?utf-8?B?dlFLcXRlZFl5RzIvak1oYkhnNFVZNlpKanBIS1RoVlMzZkZlR3BEN2t4UWtF?=
 =?utf-8?B?RC9seDJoK0dGUGlaRzZrdGhrZDlTRS9YdE1hU0tTdkdVc3AzRE5XTUtjSzhV?=
 =?utf-8?B?S3lRNVQ3WUtNUmRCMHgyM0VBekwrdWhaMFhFTWp6dVRwdjArYllnMzdkSDl0?=
 =?utf-8?B?bEtYOGpnNzliOUdCOGdvUkdnUnBQTmFEZjIvaEsxVEVhdkUyVms2ZHZWMThY?=
 =?utf-8?B?N1FHQzdkZEdUSkoxNktLNzRVejdGMEwvSWx2MkVyV3JFNExQc0NtL0J1K29q?=
 =?utf-8?B?Vi9IT0pFTDdNbGZOYXMvTDBRUW1VdTNvTURVUXNmZ3dDY1cyMzA5U1JlMVVX?=
 =?utf-8?B?STdDbmMzN2tsTXBSVGlhaGFMRFNDRlB5TnpwdUJKWGJ1WXk4YUFNcGo4Ykdm?=
 =?utf-8?B?b1B1R0NVVUpVL1hmQ3Q4WnVhajJmUi9OalNReGw5a21CUjluOU5CaXNONksx?=
 =?utf-8?B?N1Y3ZC8xczNITDE1MWdEL2ErKzF6QXJBdFdpNVJMLzZCbE9jdWJ0QlFiNzFt?=
 =?utf-8?B?U05uWUlYVXlWd29UMzJQSmp3bmxpOXM4WlF6dnEycVpzN09rSHZEcmw4aFZp?=
 =?utf-8?B?U00wbUgvNDBXV1VSQUlRNHNlbnFxNVVQSVFlWVNzcCtjSlFzUmRHdTM0Ymoy?=
 =?utf-8?B?Wk90WC9ZVFplRmt1L2tPcEFMajdpOE1OVEh0aFdLVEMzbXF1RDlrczhmN3Ay?=
 =?utf-8?B?MjA4eFFCS0hTTHZaSFdsMVZ2M1JOSXZiQlFZeFVxQytBRUxsTVFEWk1BYlZQ?=
 =?utf-8?B?L1J4RFArRUpFVVk0QmFNVXh5VkFFakQvMXBoa0xwRkczN1RWOG9LOGUzQlRR?=
 =?utf-8?B?cTlFODJGNWIrNUxUOVN2Z0huM29EbjRqamo2NFZYd2lYeXlMSUwvcUN0MUY0?=
 =?utf-8?B?Nmd2aUI3L2FKK1pJVjJUQlBYTGdvdVZhdVdHL0Q4andIYTVsYzc4L25WSWdi?=
 =?utf-8?B?TVZ3UkRwYlhhaUJPVE5pWTM2Qi9MblcvRU50SVNCZUhvbVl4RW55MEg1eWN1?=
 =?utf-8?B?dHV0cWkxNlFYaEZhYit4S1ZYMUl5dkpVZmJ2dkcwTTVGdi9XYjRJL2dkNkVT?=
 =?utf-8?B?TjFYc0tZcWxKV29yVlBTaURTTE0rM2RJRjZwa3hMRW9rdHQrTFRVUlpZOHhi?=
 =?utf-8?B?dVh4VElIenRJbkVjYTE2cG40THhBWUFEcnJhMmRpdnk1ek4xRzFUbTBhZ1dh?=
 =?utf-8?B?eVN4Q2htUG1XQW0wZWRrVDVUT29DdXVIQmg1YkoxbkdUdEhRblUreVZ5QW51?=
 =?utf-8?B?VVNzRU5tU1lORkFobStnTEQ0N2E1S2lkOGxKTXE3eWhoV0tKajc1UFFKTDdt?=
 =?utf-8?B?dDlnU2hZLzJIeU5xckp2N3dXaTE4QkpVUmtLYVAzVGRKYzN0L1dqdHhSWWlV?=
 =?utf-8?B?U3ZQSVg1OEhndGd6Qm5BN1dzVGRjZDZGU2xQRXF0UzdSM3NNMG1hRGNqd2pL?=
 =?utf-8?B?anNlMkxrYy9rOXBKS0dXMDVIYW1WbjNmSy90c0FEeDRxc25WM05VeU9ta0N5?=
 =?utf-8?B?QUFJYTl3amUzMDRnMkRZMFpBaEUxeXM5WFdsUFYyNjJxOXhHZzlFZnVVSk53?=
 =?utf-8?B?R2xuOGVMN2Y3TkdlejZKUTJHZFVYSkhkd1F4V3dsM09IRWZMVW93djRTRU1p?=
 =?utf-8?B?SU9OWW15UU14eVE1NlNhenB5Mm1ET2VPNGwvUUJJU1RvSm0raC9JSlBmcUZV?=
 =?utf-8?B?T21DM0R5UHc4cWMxUXc4WE1WODMrY2MxK3VHbElJZXBSSXlxbG9rMXRnaUtr?=
 =?utf-8?B?UUhDbkpkdlFZcnpnWXZ0RkYrYnMwTXlDRFpaVTJaUGQ5RllwVndpZDhRS2Z1?=
 =?utf-8?B?K1BTaWtzUUpSS2ZyVGdtaW16eXJMdGJSVjMyR1hHT1BpUWNRcDZJNWNtUEll?=
 =?utf-8?B?THRjS1RmYVNXdkpDNWl0K2xBemx0am5HUzM5MjYwRjlvVEQ3K3FFSWpuZW1K?=
 =?utf-8?B?UnpLalYzR04zejR0SWJ3SjhsenNneFg4ZmxVRXBKSURxeVFJK2JVUjdCZ3JX?=
 =?utf-8?B?cnNFaWxiU3QrOXRPakFScHV1S3FVcytLWWJPODRNVFFIRjhDakttYzBIMlI5?=
 =?utf-8?B?REoxSVNXOTJlNEpqZ1VyL0plZWtqWFo3RXp5UXh5czRMclJiVEllWGsyWnVE?=
 =?utf-8?B?TlE9PQ==?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <90ED5F819900094BAF58E78EF2256F4A@eurprd03.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: epam.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: VI1PR03MB3710.eurprd03.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 3c7aa324-2cd4-4e57-048c-08dba8e66d6f
X-MS-Exchange-CrossTenant-originalarrivaltime: 29 Aug 2023 23:19:42.5516
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b41b72d0-4e9f-4c26-8a69-f949f367c91d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: vYSH1s2xuPIdaVuLe+AZfChUxr3GblPmZEdl9oNHRY9+lhuut82wBQ7spWRfwIKWAtulSDQJfmbg1/2xq7Tgob03b/0woHQtpMtyO0gUwfo=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM7PR03MB6371
X-Proofpoint-ORIG-GUID: -ghOakbpgbfx8hINmWIrtmmpUk9Z7vWS
X-Proofpoint-GUID: -ghOakbpgbfx8hINmWIrtmmpUk9Z7vWS
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.267,Aquarius:18.0.957,Hydra:6.0.601,FMLib:17.11.176.26
 definitions=2023-08-29_16,2023-08-29_01,2023-05-22_02
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0 malwarescore=0 bulkscore=0
 mlxscore=0 adultscore=0 priorityscore=1501 impostorscore=0
 lowpriorityscore=0 phishscore=0 spamscore=0 suspectscore=0 mlxlogscore=999
 clxscore=1015 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2308100000 definitions=main-2308290202

RnJvbTogT2xla3NhbmRyIEFuZHJ1c2hjaGVua28gPG9sZWtzYW5kcl9hbmRydXNoY2hlbmtvQGVw
YW0uY29tPg0KDQpVc2UgYSBwcmV2aW91c2x5IGludHJvZHVjZWQgcGVyLWRvbWFpbiByZWFkL3dy
aXRlIGxvY2sgdG8gY2hlY2sNCndoZXRoZXIgdnBjaSBpcyBwcmVzZW50LCBzbyB3ZSBhcmUgc3Vy
ZSB0aGVyZSBhcmUgbm8gYWNjZXNzZXMgdG8gdGhlDQpjb250ZW50cyBvZiB0aGUgdnBjaSBzdHJ1
Y3QgaWYgbm90LiBUaGlzIGxvY2sgY2FuIGJlIHVzZWQgKGFuZCBpbiBhDQpmZXcgY2FzZXMgaXMg
dXNlZCByaWdodCBhd2F5KSBzbyB0aGF0IHZwY2kgcmVtb3ZhbCBjYW4gYmUgcGVyZm9ybWVkDQp3
aGlsZSBob2xkaW5nIHRoZSBsb2NrIGluIHdyaXRlIG1vZGUuIFByZXZpb3VzbHkgc3VjaCByZW1v
dmFsIGNvdWxkDQpyYWNlIHdpdGggdnBjaV9yZWFkIGZvciBleGFtcGxlLg0KDQpXaGVuIHRha2lu
ZyBib3RoIGQtPnBjaV9sb2NrIGFuZCBwZGV2LT52cGNpLT5sb2NrIHRoZXkgYXJlIHNob3VsZCBi
ZQ0KdGFrZW4gaW4gdGhpcyBleGFjdCBvcmRlcjogZC0+cGNpX2xvY2sgdGhlbiBwZGV2LT52cGNp
LT5sb2NrIHRvIGF2b2lkDQpwb3NzaWJsZSBkZWFkbG9jayBzaXR1YXRpb25zLg0KDQoxLiBQZXIt
ZG9tYWluJ3MgcGNpX3J3bG9jayBpcyB1c2VkIHRvIHByb3RlY3QgcGRldi0+dnBjaSBzdHJ1Y3R1
cmUNCmZyb20gYmVpbmcgcmVtb3ZlZC4NCg0KMi4gV3JpdGluZyB0aGUgY29tbWFuZCByZWdpc3Rl
ciBhbmQgUk9NIEJBUiByZWdpc3RlciBtYXkgdHJpZ2dlcg0KbW9kaWZ5X2JhcnMgdG8gcnVuLCB3
aGljaCBpbiB0dXJuIG1heSBhY2Nlc3MgbXVsdGlwbGUgcGRldnMgd2hpbGUNCmNoZWNraW5nIGZv
ciB0aGUgZXhpc3RpbmcgQkFSJ3Mgb3ZlcmxhcC4gVGhlIG92ZXJsYXBwaW5nIGNoZWNrLCBpZg0K
ZG9uZSB1bmRlciB0aGUgcmVhZCBsb2NrLCByZXF1aXJlcyB2cGNpLT5sb2NrIHRvIGJlIGFjcXVp
cmVkIG9uIGJvdGgNCmRldmljZXMgYmVpbmcgY29tcGFyZWQsIHdoaWNoIG1heSBwcm9kdWNlIGEg
ZGVhZGxvY2suIEl0IGlzIG5vdA0KcG9zc2libGUgdG8gdXBncmFkZSByZWFkIGxvY2sgdG8gd3Jp
dGUgbG9jayBpbiBzdWNoIGEgY2FzZS4gU28sIGluDQpvcmRlciB0byBwcmV2ZW50IHRoZSBkZWFk
bG9jaywgdXNlIGQtPnBjaV9sb2NrIGluc3RlYWQuIFRvIHByZXZlbnQNCmRlYWRsb2NrIHdoaWxl
IGxvY2tpbmcgYm90aCBod2RvbS0+cGNpX2xvY2sgYW5kIGRvbV94ZW4tPnBjaV9sb2NrLA0KYWx3
YXlzIGxvY2sgaHdkb20gZmlyc3QuDQoNCkFsbCBvdGhlciBjb2RlLCB3aGljaCBkb2Vzbid0IGxl
YWQgdG8gcGRldi0+dnBjaSBkZXN0cnVjdGlvbiBhbmQgZG9lcw0Kbm90IGFjY2VzcyBtdWx0aXBs
ZSBwZGV2cyBhdCB0aGUgc2FtZSB0aW1lLCBjYW4gc3RpbGwgdXNlIGENCmNvbWJpbmF0aW9uIG9m
IHRoZSByZWFkIGxvY2sgYW5kIHBkZXYtPnZwY2ktPmxvY2suDQoNCjMuIERyb3AgY29uc3QgcXVh
bGlmaWVyIHdoZXJlIHRoZSBuZXcgcndsb2NrIGlzIHVzZWQgYW5kIHRoaXMgaXMNCmFwcHJvcHJp
YXRlLg0KDQo0LiBEbyBub3QgY2FsbCBwcm9jZXNzX3BlbmRpbmdfc29mdGlycXMgd2l0aCBhbnkg
bG9ja3MgaGVsZC4gRm9yIHRoYXQNCnVubG9jayBwcmlvciB0aGUgY2FsbCBhbmQgcmUtYWNxdWly
ZSB0aGUgbG9ja3MgYWZ0ZXIuIEFmdGVyDQpyZS1hY3F1aXJpbmcgdGhlIGxvY2sgdGhlcmUgaXMg
bm8gbmVlZCB0byBjaGVjayBpZiBwZGV2LT52cGNpIGV4aXN0czoNCiAtIGluIGFwcGx5X21hcCBi
ZWNhdXNlIG9mIHRoZSBjb250ZXh0IGl0IGlzIGNhbGxlZCAobm8gcmFjZSBjb25kaXRpb24NCiAg
IHBvc3NpYmxlKQ0KIC0gZm9yIE1TSS9NU0ktWCBkZWJ1ZyBjb2RlIGJlY2F1c2UgaXQgaXMgY2Fs
bGVkIGF0IHRoZSBlbmQgb2YNCiAgIHBkZXYtPnZwY2kgYWNjZXNzIGFuZCBubyBmdXJ0aGVyIGFj
Y2VzcyB0byBwZGV2LT52cGNpIGlzIG1hZGUNCg0KNS4gVXNlIGQtPnBjaV9sb2NrIGFyb3VuZCBm
b3JfZWFjaF9wZGV2IGFuZCBwY2lfZ2V0X3BkZXZfYnlfZG9tYWluDQp3aGlsZSBhY2Nlc3Npbmcg
cGRldnMgaW4gdnBjaSBjb2RlLg0KDQpUaGVyZSBpcyBhIHBvc3NpYmxlIGxvY2sgaW52ZXJzaW9u
IGluIE1TSSBjb2RlLCBhcyBzb21lIHBhcnRzIG9mIGl0DQphY3F1aXJlIHBjaWRldnNfbG9jaygp
IHdoaWxlIGFscmVhZHkgaG9sZGluZyBkLT5wY2lfbG9jay4NCg0KU3VnZ2VzdGVkLWJ5OiBSb2dl
ciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4NClN1Z2dlc3RlZC1ieTogSmFuIEJl
dWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPg0KU2lnbmVkLW9mZi1ieTogT2xla3NhbmRyIEFuZHJ1
c2hjaGVua28gPG9sZWtzYW5kcl9hbmRydXNoY2hlbmtvQGVwYW0uY29tPg0KU2lnbmVkLW9mZi1i
eTogVm9sb2R5bXlyIEJhYmNodWsgPHZvbG9keW15cl9iYWJjaHVrQGVwYW0uY29tPg0KDQotLS0N
CkNoYW5nZXMgaW4gdjk6DQogLSBleHRlbmRlZCBsb2NrZWQgcmVnaW9uIHRvIHByb3RlY3QgdnBj
aV9yZW1vdmVfZGV2aWNlIGFuZA0KICAgdnBjaV9hZGRfaGFuZGxlcnMoKSBjYWxscw0KIC0gdnBj
aV93cml0ZSgpIHRha2VzIGxvY2sgaW4gdGhlIHdyaXRlIG1vZGUgdG8gcHJvdGVjdA0KICAgcG90
ZW50aWFsIGNhbGwgdG8gbW9kaWZ5X2JhcnMoKQ0KIC0gcmVuYW1lZCBsb2NrIHJlbGVhc2luZyBm
dW5jdGlvbg0KIC0gcmVtb3ZlZCBBU1NFUlQoKXMgZnJvbSBtc2kgY29kZQ0KIC0gYWRkZWQgdHJ5
bG9jayBpbiB2cGNpX2R1bXBfbXNpDQoNCkNoYW5nZXMgaW4gdjg6DQogLSBjaGFuZ2VkIGQtPnZw
Y2lfbG9jayB0byBkLT5wY2lfbG9jaw0KIC0gaW50cm9kdWNpbmcgZC0+cGNpX2xvY2sgaW4gYSBz
ZXBhcmF0ZSBwYXRjaA0KIC0gZXh0ZW5kZWQgbG9ja2VkIHJlZ2lvbiBpbiB2cGNpX3Byb2Nlc3Nf
cGVuZGluZw0KIC0gcmVtb3ZlZCBwY2lkZXZzX2xvY2tpcyB2cGNpX2R1bXBfbXNpKCkNCiAtIHJl
bW92ZWQgc29tZSBjaGFuZ2VzIGFzIHRoZXkgYXJlIG5vdCBuZWVkZWQgd2l0aA0KICAgdGhlIG5l
dyBsb2NraW5nIHNjaGVtZQ0KIC0gYWRkZWQgaGFuZGxpbmcgZm9yIGh3ZG9tICYmIGRvbV94ZW4g
Y2FzZQ0KLS0tDQogeGVuL2FyY2gveDg2L2h2bS92bXNpLmMgICAgICAgfCAyNCArKysrKysrKy0t
LS0tLS0tDQogeGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMgICAgfCAgMiAtLQ0KIHhlbi9hcmNo
L3g4Ni9pcnEuYyAgICAgICAgICAgIHwgMTUgKysrKysrKy0tLQ0KIHhlbi9hcmNoL3g4Ni9tc2ku
YyAgICAgICAgICAgIHwgIDggKystLS0tDQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMg
fCAgNyArKystLQ0KIHhlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMgICAgIHwgMTggKysrKysrKysr
KysrDQogeGVuL2RyaXZlcnMvdnBjaS9tc2kuYyAgICAgICAgfCAyMiArKysrKysrKysrKysrLS0N
CiB4ZW4vZHJpdmVycy92cGNpL21zaXguYyAgICAgICB8IDUyICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKy0tLS0tDQogeGVuL2RyaXZlcnMvdnBjaS92cGNpLmMgICAgICAgfCA0NiArKysr
KysrKysrKysrKysrKysrKysrKysrKysrKy0tDQogOSBmaWxlcyBjaGFuZ2VkLCAxNTQgaW5zZXJ0
aW9ucygrKSwgNDAgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZt
L3Ztc2kuYyBiL3hlbi9hcmNoL3g4Ni9odm0vdm1zaS5jDQppbmRleCAxMjhmMjM2MzYyLi5mZGU3
NmNjNmI0IDEwMDY0NA0KLS0tIGEveGVuL2FyY2gveDg2L2h2bS92bXNpLmMNCisrKyBiL3hlbi9h
cmNoL3g4Ni9odm0vdm1zaS5jDQpAQCAtNDY4LDcgKzQ2OCw3IEBAIGludCBtc2l4dGJsX3B0X3Jl
Z2lzdGVyKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBwaXJxICpwaXJxLCB1aW50NjRfdCBndGFi
bGUpDQogICAgIHN0cnVjdCBtc2l4dGJsX2VudHJ5ICplbnRyeSwgKm5ld19lbnRyeTsNCiAgICAg
aW50IHIgPSAtRUlOVkFMOw0KIA0KLSAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQoKSk7DQorICAg
IEFTU0VSVChwY2lkZXZzX2xvY2tlZCgpIHx8IHJ3X2lzX2xvY2tlZCgmZC0+cGNpX2xvY2spKTsN
CiAgICAgQVNTRVJUKHJ3X2lzX3dyaXRlX2xvY2tlZCgmZC0+ZXZlbnRfbG9jaykpOw0KIA0KICAg
ICBpZiAoICFtc2l4dGJsX2luaXRpYWxpc2VkKGQpICkNCkBAIC01MzgsNyArNTM4LDcgQEAgdm9p
ZCBtc2l4dGJsX3B0X3VucmVnaXN0ZXIoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHBpcnEgKnBp
cnEpDQogICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0KICAgICBzdHJ1Y3QgbXNpeHRibF9lbnRy
eSAqZW50cnk7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xvY2tlZCgpKTsNCisgICAgQVNTRVJU
KHBjaWRldnNfbG9ja2VkKCkgfHwgcndfaXNfbG9ja2VkKCZkLT5wY2lfbG9jaykpOw0KICAgICBB
U1NFUlQocndfaXNfd3JpdGVfbG9ja2VkKCZkLT5ldmVudF9sb2NrKSk7DQogDQogICAgIGlmICgg
IW1zaXh0YmxfaW5pdGlhbGlzZWQoZCkgKQ0KQEAgLTY4NCw3ICs2ODQsNyBAQCBzdGF0aWMgaW50
IHZwY2lfbXNpX3VwZGF0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdWludDMyX3QgZGF0
YSwNCiB7DQogICAgIHVuc2lnbmVkIGludCBpOw0KIA0KLSAgICBBU1NFUlQocGNpZGV2c19sb2Nr
ZWQoKSk7DQorICAgIEFTU0VSVChyd19pc19sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xvY2sp
KTsNCiANCiAgICAgaWYgKCAoYWRkcmVzcyAmIE1TSV9BRERSX0JBU0VfTUFTSykgIT0gTVNJX0FE
RFJfSEVBREVSICkNCiAgICAgew0KQEAgLTcyNSw4ICs3MjUsOCBAQCB2b2lkIHZwY2lfbXNpX2Fy
Y2hfdXBkYXRlKHN0cnVjdCB2cGNpX21zaSAqbXNpLCBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRl
dikNCiAgICAgaW50IHJjOw0KIA0KICAgICBBU1NFUlQobXNpLT5hcmNoLnBpcnEgIT0gSU5WQUxJ
RF9QSVJRKTsNCisgICAgQVNTRVJUKHJ3X2lzX2xvY2tlZCgmcGRldi0+ZG9tYWluLT5wY2lfbG9j
aykpOw0KIA0KLSAgICBwY2lkZXZzX2xvY2soKTsNCiAgICAgZm9yICggaSA9IDA7IGkgPCBtc2kt
PnZlY3RvcnMgJiYgbXNpLT5hcmNoLmJvdW5kOyBpKysgKQ0KICAgICB7DQogICAgICAgICBzdHJ1
Y3QgeGVuX2RvbWN0bF9iaW5kX3B0X2lycSB1bmJpbmQgPSB7DQpAQCAtNzQ1LDcgKzc0NSw2IEBA
IHZvaWQgdnBjaV9tc2lfYXJjaF91cGRhdGUoc3RydWN0IHZwY2lfbXNpICptc2ksIGNvbnN0IHN0
cnVjdCBwY2lfZGV2ICpwZGV2KQ0KIA0KICAgICBtc2ktPmFyY2guYm91bmQgPSAhdnBjaV9tc2lf
dXBkYXRlKHBkZXYsIG1zaS0+ZGF0YSwgbXNpLT5hZGRyZXNzLA0KICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG1zaS0+dmVjdG9ycywgbXNpLT5hcmNoLnBpcnEsIG1zaS0+
bWFzayk7DQotICAgIHBjaWRldnNfdW5sb2NrKCk7DQogfQ0KIA0KIHN0YXRpYyBpbnQgdnBjaV9t
c2lfZW5hYmxlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1bnNpZ25lZCBpbnQgbnIsDQpA
QCAtNzc4LDE1ICs3NzcsMTMgQEAgaW50IHZwY2lfbXNpX2FyY2hfZW5hYmxlKHN0cnVjdCB2cGNp
X21zaSAqbXNpLCBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwNCiAgICAgaW50IHJjOw0KIA0K
ICAgICBBU1NFUlQobXNpLT5hcmNoLnBpcnEgPT0gSU5WQUxJRF9QSVJRKTsNCisgICAgQVNTRVJU
KHJ3X2lzX2xvY2tlZCgmcGRldi0+ZG9tYWluLT5wY2lfbG9jaykpOw0KICAgICByYyA9IHZwY2lf
bXNpX2VuYWJsZShwZGV2LCB2ZWN0b3JzLCAwKTsNCiAgICAgaWYgKCByYyA8IDAgKQ0KICAgICAg
ICAgcmV0dXJuIHJjOw0KICAgICBtc2ktPmFyY2gucGlycSA9IHJjOw0KLQ0KLSAgICBwY2lkZXZz
X2xvY2soKTsNCiAgICAgbXNpLT5hcmNoLmJvdW5kID0gIXZwY2lfbXNpX3VwZGF0ZShwZGV2LCBt
c2ktPmRhdGEsIG1zaS0+YWRkcmVzcywgdmVjdG9ycywNCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBtc2ktPmFyY2gucGlycSwgbXNpLT5tYXNrKTsNCi0gICAgcGNpZGV2
c191bmxvY2soKTsNCiANCiAgICAgcmV0dXJuIDA7DQogfQ0KQEAgLTc5Nyw4ICs3OTQsOCBAQCBz
dGF0aWMgdm9pZCB2cGNpX21zaV9kaXNhYmxlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBp
bnQgcGlycSwNCiAgICAgdW5zaWduZWQgaW50IGk7DQogDQogICAgIEFTU0VSVChwaXJxICE9IElO
VkFMSURfUElSUSk7DQorICAgIEFTU0VSVChyd19pc19sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNp
X2xvY2spKTsNCiANCi0gICAgcGNpZGV2c19sb2NrKCk7DQogICAgIGZvciAoIGkgPSAwOyBpIDwg
bnIgJiYgYm91bmQ7IGkrKyApDQogICAgIHsNCiAgICAgICAgIHN0cnVjdCB4ZW5fZG9tY3RsX2Jp
bmRfcHRfaXJxIGJpbmQgPSB7DQpAQCAtODE0LDcgKzgxMSw2IEBAIHN0YXRpYyB2b2lkIHZwY2lf
bXNpX2Rpc2FibGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIGludCBwaXJxLA0KICAgICB3
cml0ZV9sb2NrKCZwZGV2LT5kb21haW4tPmV2ZW50X2xvY2spOw0KICAgICB1bm1hcF9kb21haW5f
cGlycShwZGV2LT5kb21haW4sIHBpcnEpOw0KICAgICB3cml0ZV91bmxvY2soJnBkZXYtPmRvbWFp
bi0+ZXZlbnRfbG9jayk7DQotICAgIHBjaWRldnNfdW5sb2NrKCk7DQogfQ0KIA0KIHZvaWQgdnBj
aV9tc2lfYXJjaF9kaXNhYmxlKHN0cnVjdCB2cGNpX21zaSAqbXNpLCBjb25zdCBzdHJ1Y3QgcGNp
X2RldiAqcGRldikNCkBAIC04NTQsNiArODUwLDggQEAgaW50IHZwY2lfbXNpeF9hcmNoX2VuYWJs
ZV9lbnRyeShzdHJ1Y3QgdnBjaV9tc2l4X2VudHJ5ICplbnRyeSwNCiAgICAgaW50IHJjOw0KIA0K
ICAgICBBU1NFUlQoZW50cnktPmFyY2gucGlycSA9PSBJTlZBTElEX1BJUlEpOw0KKyAgICBBU1NF
UlQocndfaXNfbG9ja2VkKCZwZGV2LT5kb21haW4tPnBjaV9sb2NrKSk7DQorDQogICAgIHJjID0g
dnBjaV9tc2lfZW5hYmxlKHBkZXYsIHZtc2l4X2VudHJ5X25yKHBkZXYtPnZwY2ktPm1zaXgsIGVu
dHJ5KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVfYmFzZSk7DQogICAgIGlmICgg
cmMgPCAwICkNCkBAIC04NjEsNyArODU5LDYgQEAgaW50IHZwY2lfbXNpeF9hcmNoX2VuYWJsZV9l
bnRyeShzdHJ1Y3QgdnBjaV9tc2l4X2VudHJ5ICplbnRyeSwNCiANCiAgICAgZW50cnktPmFyY2gu
cGlycSA9IHJjOw0KIA0KLSAgICBwY2lkZXZzX2xvY2soKTsNCiAgICAgcmMgPSB2cGNpX21zaV91
cGRhdGUocGRldiwgZW50cnktPmRhdGEsIGVudHJ5LT5hZGRyLCAxLCBlbnRyeS0+YXJjaC5waXJx
LA0KICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeS0+bWFza2VkKTsNCiAgICAgaWYgKCBy
YyApDQpAQCAtODY5LDcgKzg2Niw2IEBAIGludCB2cGNpX21zaXhfYXJjaF9lbmFibGVfZW50cnko
c3RydWN0IHZwY2lfbXNpeF9lbnRyeSAqZW50cnksDQogICAgICAgICB2cGNpX21zaV9kaXNhYmxl
KHBkZXYsIGVudHJ5LT5hcmNoLnBpcnEsIDEsIGZhbHNlKTsNCiAgICAgICAgIGVudHJ5LT5hcmNo
LnBpcnEgPSBJTlZBTElEX1BJUlE7DQogICAgIH0NCi0gICAgcGNpZGV2c191bmxvY2soKTsNCiAN
CiAgICAgcmV0dXJuIHJjOw0KIH0NCkBAIC04OTUsNiArODkxLDggQEAgaW50IHZwY2lfbXNpeF9h
cmNoX3ByaW50KGNvbnN0IHN0cnVjdCB2cGNpX21zaXggKm1zaXgpDQogew0KICAgICB1bnNpZ25l
ZCBpbnQgaTsNCiANCisgICAgQVNTRVJUKHJ3X2lzX2xvY2tlZCgmbXNpeC0+cGRldi0+ZG9tYWlu
LT5wY2lfbG9jaykpOw0KKw0KICAgICBmb3IgKCBpID0gMDsgaSA8IG1zaXgtPm1heF9lbnRyaWVz
OyBpKysgKQ0KICAgICB7DQogICAgICAgICBjb25zdCBzdHJ1Y3QgdnBjaV9tc2l4X2VudHJ5ICpl
bnRyeSA9ICZtc2l4LT5lbnRyaWVzW2ldOw0KQEAgLTkxMyw3ICs5MTEsOSBAQCBpbnQgdnBjaV9t
c2l4X2FyY2hfcHJpbnQoY29uc3Qgc3RydWN0IHZwY2lfbXNpeCAqbXNpeCkNCiAgICAgICAgICAg
ICBzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IG1zaXgtPnBkZXY7DQogDQogICAgICAgICAgICAgc3Bp
bl91bmxvY2soJm1zaXgtPnBkZXYtPnZwY2ktPmxvY2spOw0KKyAgICAgICAgICAgIHJlYWRfdW5s
b2NrKCZwZGV2LT5kb21haW4tPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICBwcm9jZXNzX3BlbmRp
bmdfc29mdGlycXMoKTsNCisgICAgICAgICAgICByZWFkX2xvY2soJnBkZXYtPmRvbWFpbi0+cGNp
X2xvY2spOw0KICAgICAgICAgICAgIC8qIE5COiB3ZSBhc3N1bWUgdGhhdCBwZGV2IGNhbm5vdCBn
byBhd2F5IGZvciBhbiBhbGl2ZSBkb21haW4uICovDQogICAgICAgICAgICAgaWYgKCAhcGRldi0+
dnBjaSB8fCAhc3Bpbl90cnlsb2NrKCZwZGV2LT52cGNpLT5sb2NrKSApDQogICAgICAgICAgICAg
ICAgIHJldHVybiAtRUJVU1k7DQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS92bXgvdm14
LmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYw0KaW5kZXggMWVkYzdmMWU5MS4uNTQ1YTI3
Nzk2ZSAxMDA2NDQNCi0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jDQorKysgYi94ZW4v
YXJjaC94ODYvaHZtL3ZteC92bXguYw0KQEAgLTQxMyw4ICs0MTMsNiBAQCBzdGF0aWMgaW50IGNm
X2NoZWNrIHZteF9waV91cGRhdGVfaXJ0ZShjb25zdCBzdHJ1Y3QgdmNwdSAqdiwNCiANCiAgICAg
c3Bpbl91bmxvY2tfaXJxKCZkZXNjLT5sb2NrKTsNCiANCi0gICAgQVNTRVJUKHBjaWRldnNfbG9j
a2VkKCkpOw0KLQ0KICAgICByZXR1cm4gaW9tbXVfdXBkYXRlX2lyZV9mcm9tX21zaShtc2lfZGVz
YywgJm1zaV9kZXNjLT5tc2cpOw0KIA0KICB1bmxvY2tfb3V0Og0KZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9pcnEuYyBiL3hlbi9hcmNoL3g4Ni9pcnEuYw0KaW5kZXggNmFiZmQ4MTYyMS4uY2I5
OWFlNTM5MiAxMDA2NDQNCi0tLSBhL3hlbi9hcmNoL3g4Ni9pcnEuYw0KKysrIGIveGVuL2FyY2gv
eDg2L2lycS5jDQpAQCAtMjE1Nyw3ICsyMTU3LDcgQEAgaW50IG1hcF9kb21haW5fcGlycSgNCiAg
ICAgICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0KICAgICAgICAgdW5zaWduZWQgaW50IG5yID0g
MDsNCiANCi0gICAgICAgIEFTU0VSVChwY2lkZXZzX2xvY2tlZCgpKTsNCisgICAgICAgIEFTU0VS
VChwY2lkZXZzX2xvY2tlZCgpIHx8IHJ3X2lzX2xvY2tlZCgmZC0+cGNpX2xvY2spKTsNCiANCiAg
ICAgICAgIHJldCA9IC1FTk9ERVY7DQogICAgICAgICBpZiAoICFjcHVfaGFzX2FwaWMgKQ0KQEAg
LTIzMTQsNyArMjMxNCw3IEBAIGludCB1bm1hcF9kb21haW5fcGlycShzdHJ1Y3QgZG9tYWluICpk
LCBpbnQgcGlycSkNCiAgICAgaWYgKCAocGlycSA8IDApIHx8IChwaXJxID49IGQtPm5yX3BpcnFz
KSApDQogICAgICAgICByZXR1cm4gLUVJTlZBTDsNCiANCi0gICAgQVNTRVJUKHBjaWRldnNfbG9j
a2VkKCkpOw0KKyAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQoKSB8fCByd19pc19sb2NrZWQoJmQt
PnBjaV9sb2NrKSk7DQogICAgIEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJmQtPmV2ZW50X2xv
Y2spKTsNCiANCiAgICAgaW5mbyA9IHBpcnFfaW5mbyhkLCBwaXJxKTsNCkBAIC0yOTA4LDcgKzI5
MDgsMTMgQEAgaW50IGFsbG9jYXRlX2FuZF9tYXBfbXNpX3BpcnEoc3RydWN0IGRvbWFpbiAqZCwg
aW50IGluZGV4LCBpbnQgKnBpcnFfcCwNCiANCiAgICAgbXNpLT5pcnEgPSBpcnE7DQogDQotICAg
IHBjaWRldnNfbG9jaygpOw0KKyAgICAvKg0KKyAgICAgKiBJZiB3ZSBhcmUgY2FsbGVkIHZpYSB2
UENJLT52TVNJIHBhdGgsIHdlIGFscmVhZHkgYXJlIGhvbGRpbmcNCisgICAgICogZC0+cGNpX2xv
Y2sgc28gdGhlcmUgaXMgbm8gbmVlZCB0byB0YWtlIHBjaWRldnNfbG9jaywgYXMgaXQNCisgICAg
ICogd2lsbCBjYXVzZSBsb2NrIGludmVyc2lvbi4NCisgICAgICovDQorICAgIGlmICggIXJ3X2lz
X2xvY2tlZCgmZC0+cGNpX2xvY2spICkNCisgICAgICAgIHBjaWRldnNfbG9jaygpOw0KICAgICAv
KiBWZXJpZnkgb3IgZ2V0IHBpcnEuICovDQogICAgIHdyaXRlX2xvY2soJmQtPmV2ZW50X2xvY2sp
Ow0KICAgICBwaXJxID0gYWxsb2NhdGVfcGlycShkLCBpbmRleCwgKnBpcnFfcCwgaXJxLCB0eXBl
LCAmbXNpLT5lbnRyeV9ucik7DQpAQCAtMjkyNCw3ICsyOTMwLDggQEAgaW50IGFsbG9jYXRlX2Fu
ZF9tYXBfbXNpX3BpcnEoc3RydWN0IGRvbWFpbiAqZCwgaW50IGluZGV4LCBpbnQgKnBpcnFfcCwN
CiANCiAgZG9uZToNCiAgICAgd3JpdGVfdW5sb2NrKCZkLT5ldmVudF9sb2NrKTsNCi0gICAgcGNp
ZGV2c191bmxvY2soKTsNCisgICAgaWYgKCAhcndfaXNfbG9ja2VkKCZkLT5wY2lfbG9jaykgKQ0K
KyAgICAgICAgcGNpZGV2c191bmxvY2soKTsNCiAgICAgaWYgKCByZXQgKQ0KICAgICB7DQogICAg
ICAgICBzd2l0Y2ggKCB0eXBlICkNCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbXNpLmMgYi94
ZW4vYXJjaC94ODYvbXNpLmMNCmluZGV4IGQwYmY2M2RmMWQuLmJhMjk2M2I3ZDIgMTAwNjQ0DQot
LS0gYS94ZW4vYXJjaC94ODYvbXNpLmMNCisrKyBiL3hlbi9hcmNoL3g4Ni9tc2kuYw0KQEAgLTYx
Myw3ICs2MTMsNyBAQCBzdGF0aWMgaW50IG1zaV9jYXBhYmlsaXR5X2luaXQoc3RydWN0IHBjaV9k
ZXYgKmRldiwNCiAgICAgdTggc2xvdCA9IFBDSV9TTE9UKGRldi0+ZGV2Zm4pOw0KICAgICB1OCBm
dW5jID0gUENJX0ZVTkMoZGV2LT5kZXZmbik7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xvY2tl
ZCgpKTsNCisgICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkgfHwgcndfaXNfbG9ja2VkKCZkZXYt
PmRvbWFpbi0+cGNpX2xvY2spKTsNCiAgICAgcG9zID0gcGNpX2ZpbmRfY2FwX29mZnNldChzZWcs
IGJ1cywgc2xvdCwgZnVuYywgUENJX0NBUF9JRF9NU0kpOw0KICAgICBpZiAoICFwb3MgKQ0KICAg
ICAgICAgcmV0dXJuIC1FTk9ERVY7DQpAQCAtNzgzLDcgKzc4Myw3IEBAIHN0YXRpYyBpbnQgbXNp
eF9jYXBhYmlsaXR5X2luaXQoc3RydWN0IHBjaV9kZXYgKmRldiwNCiAgICAgaWYgKCAhcG9zICkN
CiAgICAgICAgIHJldHVybiAtRU5PREVWOw0KIA0KLSAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQo
KSk7DQorICAgIEFTU0VSVChwY2lkZXZzX2xvY2tlZCgpIHx8IHJ3X2lzX2xvY2tlZCgmZGV2LT5k
b21haW4tPnBjaV9sb2NrKSk7DQogDQogICAgIGNvbnRyb2wgPSBwY2lfY29uZl9yZWFkMTYoZGV2
LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcykpOw0KICAgICAvKg0KQEAgLTEwMDAsNyArMTAw
MCw2IEBAIHN0YXRpYyBpbnQgX19wY2lfZW5hYmxlX21zaShzdHJ1Y3QgbXNpX2luZm8gKm1zaSwg
c3RydWN0IG1zaV9kZXNjICoqZGVzYykNCiAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXY7DQogICAg
IHN0cnVjdCBtc2lfZGVzYyAqb2xkX2Rlc2M7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xvY2tl
ZCgpKTsNCiAgICAgcGRldiA9IHBjaV9nZXRfcGRldihOVUxMLCBtc2ktPnNiZGYpOw0KICAgICBp
ZiAoICFwZGV2ICkNCiAgICAgICAgIHJldHVybiAtRU5PREVWOw0KQEAgLTEwNTUsNyArMTA1NCw2
IEBAIHN0YXRpYyBpbnQgX19wY2lfZW5hYmxlX21zaXgoc3RydWN0IG1zaV9pbmZvICptc2ksIHN0
cnVjdCBtc2lfZGVzYyAqKmRlc2MpDQogICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0KICAgICBz
dHJ1Y3QgbXNpX2Rlc2MgKm9sZF9kZXNjOw0KIA0KLSAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQo
KSk7DQogICAgIHBkZXYgPSBwY2lfZ2V0X3BkZXYoTlVMTCwgbXNpLT5zYmRmKTsNCiAgICAgaWYg
KCAhcGRldiB8fCAhcGRldi0+bXNpeCApDQogICAgICAgICByZXR1cm4gLUVOT0RFVjsNCkBAIC0x
MTcwLDggKzExNjgsNiBAQCBpbnQgcGNpX3ByZXBhcmVfbXNpeCh1MTYgc2VnLCB1OCBidXMsIHU4
IGRldmZuLCBib29sIG9mZikNCiAgKi8NCiBpbnQgcGNpX2VuYWJsZV9tc2koc3RydWN0IG1zaV9p
bmZvICptc2ksIHN0cnVjdCBtc2lfZGVzYyAqKmRlc2MpDQogew0KLSAgICBBU1NFUlQocGNpZGV2
c19sb2NrZWQoKSk7DQotDQogICAgIGlmICggIXVzZV9tc2kgKQ0KICAgICAgICAgcmV0dXJuIC1F
UEVSTTsNCiANCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jDQppbmRleCA3OWNhOTI4NjcyLi40ZjE4MjkzOTAw
IDEwMDY0NA0KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMNCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jDQpAQCAtNzUyLDcgKzc1Miw2IEBAIGludCBwY2lfYWRk
X2RldmljZSh1MTYgc2VnLCB1OCBidXMsIHU4IGRldmZuLA0KICAgICAgICAgcGRldi0+ZG9tYWlu
ID0gaGFyZHdhcmVfZG9tYWluOw0KICAgICAgICAgd3JpdGVfbG9jaygmaGFyZHdhcmVfZG9tYWlu
LT5wY2lfbG9jayk7DQogICAgICAgICBsaXN0X2FkZCgmcGRldi0+ZG9tYWluX2xpc3QsICZoYXJk
d2FyZV9kb21haW4tPnBkZXZfbGlzdCk7DQotICAgICAgICB3cml0ZV91bmxvY2soJmhhcmR3YXJl
X2RvbWFpbi0+cGNpX2xvY2spOw0KIA0KICAgICAgICAgLyoNCiAgICAgICAgICAqIEZvciBkZXZp
Y2VzIG5vdCBkaXNjb3ZlcmVkIGJ5IFhlbiBkdXJpbmcgYm9vdCwgYWRkIHZQQ0kgaGFuZGxlcnMN
CkBAIC03NjIsMTcgKzc2MSwxNyBAQCBpbnQgcGNpX2FkZF9kZXZpY2UodTE2IHNlZywgdTggYnVz
LCB1OCBkZXZmbiwNCiAgICAgICAgIGlmICggcmV0ICkNCiAgICAgICAgIHsNCiAgICAgICAgICAg
ICBwcmludGsoWEVOTE9HX0VSUiAiU2V0dXAgb2YgdlBDSSBmYWlsZWQ6ICVkXG4iLCByZXQpOw0K
LSAgICAgICAgICAgIHdyaXRlX2xvY2soJmhhcmR3YXJlX2RvbWFpbi0+cGNpX2xvY2spOw0KICAg
ICAgICAgICAgIGxpc3RfZGVsKCZwZGV2LT5kb21haW5fbGlzdCk7DQogICAgICAgICAgICAgd3Jp
dGVfdW5sb2NrKCZoYXJkd2FyZV9kb21haW4tPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICBwZGV2
LT5kb21haW4gPSBOVUxMOw0KICAgICAgICAgICAgIGdvdG8gb3V0Ow0KICAgICAgICAgfQ0KKyAg
ICAgICAgd3JpdGVfdW5sb2NrKCZoYXJkd2FyZV9kb21haW4tPnBjaV9sb2NrKTsNCiAgICAgICAg
IHJldCA9IGlvbW11X2FkZF9kZXZpY2UocGRldik7DQogICAgICAgICBpZiAoIHJldCApDQogICAg
ICAgICB7DQotICAgICAgICAgICAgdnBjaV9yZW1vdmVfZGV2aWNlKHBkZXYpOw0KICAgICAgICAg
ICAgIHdyaXRlX2xvY2soJmhhcmR3YXJlX2RvbWFpbi0+cGNpX2xvY2spOw0KKyAgICAgICAgICAg
IHZwY2lfcmVtb3ZlX2RldmljZShwZGV2KTsNCiAgICAgICAgICAgICBsaXN0X2RlbCgmcGRldi0+
ZG9tYWluX2xpc3QpOw0KICAgICAgICAgICAgIHdyaXRlX3VubG9jaygmaGFyZHdhcmVfZG9tYWlu
LT5wY2lfbG9jayk7DQogICAgICAgICAgICAgcGRldi0+ZG9tYWluID0gTlVMTDsNCkBAIC0xMTQ3
LDcgKzExNDYsOSBAQCBzdGF0aWMgdm9pZCBfX2h3ZG9tX2luaXQgc2V0dXBfb25lX2h3ZG9tX2Rl
dmljZShjb25zdCBzdHJ1Y3Qgc2V0dXBfaHdkb20gKmN0eHQsDQogICAgIH0gd2hpbGUgKCBkZXZm
biAhPSBwZGV2LT5kZXZmbiAmJg0KICAgICAgICAgICAgICAgUENJX1NMT1QoZGV2Zm4pID09IFBD
SV9TTE9UKHBkZXYtPmRldmZuKSApOw0KIA0KKyAgICB3cml0ZV9sb2NrKCZjdHh0LT5kLT5wY2lf
bG9jayk7DQogICAgIGVyciA9IHZwY2lfYWRkX2hhbmRsZXJzKHBkZXYpOw0KKyAgICB3cml0ZV91
bmxvY2soJmN0eHQtPmQtPnBjaV9sb2NrKTsNCiAgICAgaWYgKCBlcnIgKQ0KICAgICAgICAgcHJp
bnRrKFhFTkxPR19FUlIgInNldHVwIG9mIHZQQ0kgZm9yIGQlZCBmYWlsZWQ6ICVkXG4iLA0KICAg
ICAgICAgICAgICAgIGN0eHQtPmQtPmRvbWFpbl9pZCwgZXJyKTsNCmRpZmYgLS1naXQgYS94ZW4v
ZHJpdmVycy92cGNpL2hlYWRlci5jIGIveGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYw0KaW5kZXgg
NjBmNzA0OWUzNC4uMTc3YTZiNTdhNSAxMDA2NDQNCi0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvaGVh
ZGVyLmMNCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMNCkBAIC0xNzIsNiArMTcyLDcg
QEAgYm9vbCB2cGNpX3Byb2Nlc3NfcGVuZGluZyhzdHJ1Y3QgdmNwdSAqdikNCiAgICAgICAgIGlm
ICggcmMgPT0gLUVSRVNUQVJUICkNCiAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiANCisgICAg
ICAgIHdyaXRlX2xvY2soJnYtPmRvbWFpbi0+cGNpX2xvY2spOw0KICAgICAgICAgc3Bpbl9sb2Nr
KCZ2LT52cGNpLnBkZXYtPnZwY2ktPmxvY2spOw0KICAgICAgICAgLyogRGlzYWJsZSBtZW1vcnkg
ZGVjb2RpbmcgdW5jb25kaXRpb25hbGx5IG9uIGZhaWx1cmUuICovDQogICAgICAgICBtb2RpZnlf
ZGVjb2Rpbmcodi0+dnBjaS5wZGV2LA0KQEAgLTE5MCw2ICsxOTEsNyBAQCBib29sIHZwY2lfcHJv
Y2Vzc19wZW5kaW5nKHN0cnVjdCB2Y3B1ICp2KQ0KICAgICAgICAgICAgICAqIGZhaWx1cmUuDQog
ICAgICAgICAgICAgICovDQogICAgICAgICAgICAgdnBjaV9yZW1vdmVfZGV2aWNlKHYtPnZwY2ku
cGRldik7DQorICAgICAgICB3cml0ZV91bmxvY2soJnYtPmRvbWFpbi0+cGNpX2xvY2spOw0KICAg
ICB9DQogDQogICAgIHJldHVybiBmYWxzZTsNCkBAIC0yMDEsOCArMjAzLDIwIEBAIHN0YXRpYyBp
bnQgX19pbml0IGFwcGx5X21hcChzdHJ1Y3QgZG9tYWluICpkLCBjb25zdCBzdHJ1Y3QgcGNpX2Rl
diAqcGRldiwNCiAgICAgc3RydWN0IG1hcF9kYXRhIGRhdGEgPSB7IC5kID0gZCwgLm1hcCA9IHRy
dWUgfTsNCiAgICAgaW50IHJjOw0KIA0KKyAgICBBU1NFUlQocndfaXNfbG9ja2VkKCZkLT5wY2lf
bG9jaykpOw0KKw0KICAgICB3aGlsZSAoIChyYyA9IHJhbmdlc2V0X2NvbnN1bWVfcmFuZ2VzKG1l
bSwgbWFwX3JhbmdlLCAmZGF0YSkpID09IC1FUkVTVEFSVCApDQorICAgIHsNCisgICAgICAgIC8q
DQorICAgICAgICAgKiBJdCdzIHNhZmUgdG8gZHJvcCBhbmQgcmVhY3F1aXJlIHRoZSBsb2NrIGlu
IHRoaXMgY29udGV4dA0KKyAgICAgICAgICogd2l0aG91dCByaXNraW5nIHBkZXYgZGlzYXBwZWFy
aW5nIGJlY2F1c2UgZGV2aWNlcyBjYW5ub3QgYmUNCisgICAgICAgICAqIHJlbW92ZWQgdW50aWwg
dGhlIGluaXRpYWwgZG9tYWluIGhhcyBiZWVuIHN0YXJ0ZWQuDQorICAgICAgICAgKi8NCisgICAg
ICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lfbG9jayk7DQogICAgICAgICBwcm9jZXNzX3BlbmRpbmdf
c29mdGlycXMoKTsNCisgICAgICAgIHJlYWRfbG9jaygmZC0+cGNpX2xvY2spOw0KKyAgICB9DQor
DQogICAgIHJhbmdlc2V0X2Rlc3Ryb3kobWVtKTsNCiAgICAgaWYgKCAhcmMgKQ0KICAgICAgICAg
bW9kaWZ5X2RlY29kaW5nKHBkZXYsIGNtZCwgZmFsc2UpOw0KQEAgLTI0Myw2ICsyNTcsOCBAQCBz
dGF0aWMgaW50IG1vZGlmeV9iYXJzKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1aW50MTZf
dCBjbWQsIGJvb2wgcm9tX29ubHkpDQogICAgIHVuc2lnbmVkIGludCBpOw0KICAgICBpbnQgcmM7
DQogDQorICAgIEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xv
Y2spKTsNCisNCiAgICAgaWYgKCAhbWVtICkNCiAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KIA0K
QEAgLTUyMiw2ICs1MzgsOCBAQCBzdGF0aWMgaW50IGNmX2NoZWNrIGluaXRfYmFycyhzdHJ1Y3Qg
cGNpX2RldiAqcGRldikNCiAgICAgc3RydWN0IHZwY2lfYmFyICpiYXJzID0gaGVhZGVyLT5iYXJz
Ow0KICAgICBpbnQgcmM7DQogDQorICAgIEFTU0VSVChyd19pc19sb2NrZWQoJnBkZXYtPmRvbWFp
bi0+cGNpX2xvY2spKTsNCisNCiAgICAgc3dpdGNoICggcGNpX2NvbmZfcmVhZDgocGRldi0+c2Jk
ZiwgUENJX0hFQURFUl9UWVBFKSAmIDB4N2YgKQ0KICAgICB7DQogICAgIGNhc2UgUENJX0hFQURF
Ul9UWVBFX05PUk1BTDoNCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL21zaS5jIGIveGVu
L2RyaXZlcnMvdnBjaS9tc2kuYw0KaW5kZXggOGYyYjU5ZTYxYS4uYTA3MzNiYjJjYiAxMDA2NDQN
Ci0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvbXNpLmMNCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNp
LmMNCkBAIC0yNjUsNyArMjY1LDcgQEAgUkVHSVNURVJfVlBDSV9JTklUKGluaXRfbXNpLCBWUENJ
X1BSSU9SSVRZX0xPVyk7DQogDQogdm9pZCB2cGNpX2R1bXBfbXNpKHZvaWQpDQogew0KLSAgICBj
b25zdCBzdHJ1Y3QgZG9tYWluICpkOw0KKyAgICBzdHJ1Y3QgZG9tYWluICpkOw0KIA0KICAgICBy
Y3VfcmVhZF9sb2NrKCZkb21saXN0X3JlYWRfbG9jayk7DQogICAgIGZvcl9lYWNoX2RvbWFpbiAo
IGQgKQ0KQEAgLTI3Nyw2ICsyNzcsOSBAQCB2b2lkIHZwY2lfZHVtcF9tc2kodm9pZCkNCiANCiAg
ICAgICAgIHByaW50aygidlBDSSBNU0kvTVNJLVggZCVkXG4iLCBkLT5kb21haW5faWQpOw0KIA0K
KyAgICAgICAgaWYgKCAhcmVhZF90cnlsb2NrKCZkLT5wY2lfbG9jaykgKQ0KKyAgICAgICAgICAg
IGNvbnRpbnVlOw0KKw0KICAgICAgICAgZm9yX2VhY2hfcGRldiAoIGQsIHBkZXYgKQ0KICAgICAg
ICAgew0KICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB2cGNpX21zaSAqbXNpOw0KQEAgLTMxOCwx
NSArMzIxLDI4IEBAIHZvaWQgdnBjaV9kdW1wX21zaSh2b2lkKQ0KICAgICAgICAgICAgICAgICAg
ICAgICogaG9sZGluZyB0aGUgbG9jay4NCiAgICAgICAgICAgICAgICAgICAgICAqLw0KICAgICAg
ICAgICAgICAgICAgICAgcHJpbnRrKCJ1bmFibGUgdG8gcHJpbnQgYWxsIE1TSS1YIGVudHJpZXM6
ICVkXG4iLCByYyk7DQotICAgICAgICAgICAgICAgICAgICBwcm9jZXNzX3BlbmRpbmdfc29mdGly
cXMoKTsNCi0gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KKyAgICAgICAgICAgICAgICAg
ICAgZ290byBwZGV2X2RvbmU7DQogICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICB9DQog
DQogICAgICAgICAgICAgc3Bpbl91bmxvY2soJnBkZXYtPnZwY2ktPmxvY2spOw0KKyBwZGV2X2Rv
bmU6DQorICAgICAgICAgICAgLyoNCisgICAgICAgICAgICAgKiBVbmxvY2sgbG9jayB0byBwcm9j
ZXNzIHBlbmRpbmcgc29mdGlycXMuIFRoaXMgaXMNCisgICAgICAgICAgICAgKiBwb3RlbnRpYWxs
eSB1bnNhZmUsIGFzIGQtPnBkZXZfbGlzdCBjYW4gYmUgY2hhbmdlZCBpbg0KKyAgICAgICAgICAg
ICAqIG1lYW50aW1lLg0KKyAgICAgICAgICAgICAqLw0KKyAgICAgICAgICAgIHJlYWRfdW5sb2Nr
KCZkLT5wY2lfbG9jayk7DQogICAgICAgICAgICAgcHJvY2Vzc19wZW5kaW5nX3NvZnRpcnFzKCk7
DQorICAgICAgICAgICAgaWYgKCAhcmVhZF90cnlsb2NrKCZkLT5wY2lfbG9jaykgKQ0KKyAgICAg
ICAgICAgIHsNCisgICAgICAgICAgICAgICAgcHJpbnRrKCJ1bmFibGUgdG8gYWNjZXNzIG90aGVy
IGRldmljZXMgZm9yIHRoZSBkb21haW5cbiIpOw0KKyAgICAgICAgICAgICAgICBnb3RvIGRvbWFp
bl9kb25lOw0KKyAgICAgICAgICAgIH0NCiAgICAgICAgIH0NCisgICAgICAgIHJlYWRfdW5sb2Nr
KCZkLT5wY2lfbG9jayk7DQogICAgIH0NCisgZG9tYWluX2RvbmU6DQogICAgIHJjdV9yZWFkX3Vu
bG9jaygmZG9tbGlzdF9yZWFkX2xvY2spOw0KIH0NCiANCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVy
cy92cGNpL21zaXguYyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jDQppbmRleCBmOWRmNTA2ZjI5
Li5mOGM1YmQzOTNiIDEwMDY0NA0KLS0tIGEveGVuL2RyaXZlcnMvdnBjaS9tc2l4LmMNCisrKyBi
L3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jDQpAQCAtMTQ3LDYgKzE0Nyw4IEBAIHN0YXRpYyBzdHJ1
Y3QgdnBjaV9tc2l4ICptc2l4X2ZpbmQoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQg
bG9uZyBhZGRyKQ0KIHsNCiAgICAgc3RydWN0IHZwY2lfbXNpeCAqbXNpeDsNCiANCisgICAgQVNT
RVJUKHJ3X2lzX2xvY2tlZCgmZC0+cGNpX2xvY2spKTsNCisNCiAgICAgbGlzdF9mb3JfZWFjaF9l
bnRyeSAoIG1zaXgsICZkLT5hcmNoLmh2bS5tc2l4X3RhYmxlcywgbmV4dCApDQogICAgIHsNCiAg
ICAgICAgIGNvbnN0IHN0cnVjdCB2cGNpX2JhciAqYmFycyA9IG1zaXgtPnBkZXYtPnZwY2ktPmhl
YWRlci5iYXJzOw0KQEAgLTE2Myw3ICsxNjUsMTMgQEAgc3RhdGljIHN0cnVjdCB2cGNpX21zaXgg
Km1zaXhfZmluZChjb25zdCBzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGFkZHIpDQog
DQogc3RhdGljIGludCBjZl9jaGVjayBtc2l4X2FjY2VwdChzdHJ1Y3QgdmNwdSAqdiwgdW5zaWdu
ZWQgbG9uZyBhZGRyKQ0KIHsNCi0gICAgcmV0dXJuICEhbXNpeF9maW5kKHYtPmRvbWFpbiwgYWRk
cik7DQorICAgIGludCByYzsNCisNCisgICAgcmVhZF9sb2NrKCZ2LT5kb21haW4tPnBjaV9sb2Nr
KTsNCisgICAgcmMgPSAhIW1zaXhfZmluZCh2LT5kb21haW4sIGFkZHIpOw0KKyAgICByZWFkX3Vu
bG9jaygmdi0+ZG9tYWluLT5wY2lfbG9jayk7DQorDQorICAgIHJldHVybiByYzsNCiB9DQogDQog
c3RhdGljIGJvb2wgYWNjZXNzX2FsbG93ZWQoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVu
c2lnbmVkIGxvbmcgYWRkciwNCkBAIC0zNTgsMjEgKzM2NiwzNSBAQCBzdGF0aWMgaW50IGFkamFj
ZW50X3JlYWQoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgY29uc3Qgc3RydWN0IHZwY2lfbXNpeCAq
bXNpeCwNCiBzdGF0aWMgaW50IGNmX2NoZWNrIG1zaXhfcmVhZCgNCiAgICAgc3RydWN0IHZjcHUg
KnYsIHVuc2lnbmVkIGxvbmcgYWRkciwgdW5zaWduZWQgaW50IGxlbiwgdW5zaWduZWQgbG9uZyAq
ZGF0YSkNCiB7DQotICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21haW47DQotICAg
IHN0cnVjdCB2cGNpX21zaXggKm1zaXggPSBtc2l4X2ZpbmQoZCwgYWRkcik7DQorICAgIHN0cnVj
dCBkb21haW4gKmQgPSB2LT5kb21haW47DQorICAgIHN0cnVjdCB2cGNpX21zaXggKm1zaXg7DQog
ICAgIGNvbnN0IHN0cnVjdCB2cGNpX21zaXhfZW50cnkgKmVudHJ5Ow0KICAgICB1bnNpZ25lZCBp
bnQgb2Zmc2V0Ow0KIA0KICAgICAqZGF0YSA9IH4wdWw7DQogDQorICAgIHJlYWRfbG9jaygmZC0+
cGNpX2xvY2spOw0KKw0KKyAgICBtc2l4ID0gbXNpeF9maW5kKGQsIGFkZHIpOw0KICAgICBpZiAo
ICFtc2l4ICkNCisgICAgew0KKyAgICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiAg
ICAgICAgIHJldHVybiBYODZFTVVMX1JFVFJZOw0KKyAgICB9DQogDQogICAgIGlmICggYWRqYWNl
bnRfaGFuZGxlKG1zaXgsIGFkZHIpICkNCi0gICAgICAgIHJldHVybiBhZGphY2VudF9yZWFkKGQs
IG1zaXgsIGFkZHIsIGxlbiwgZGF0YSk7DQorICAgIHsNCisgICAgICAgIGludCByYyA9IGFkamFj
ZW50X3JlYWQoZCwgbXNpeCwgYWRkciwgbGVuLCBkYXRhKTsNCisNCisgICAgICAgIHJlYWRfdW5s
b2NrKCZkLT5wY2lfbG9jayk7DQorICAgICAgICByZXR1cm4gcmM7DQorICAgIH0NCiANCiAgICAg
aWYgKCAhYWNjZXNzX2FsbG93ZWQobXNpeC0+cGRldiwgYWRkciwgbGVuKSApDQorICAgIHsNCisg
ICAgICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lfbG9jayk7DQogICAgICAgICByZXR1cm4gWDg2RU1V
TF9PS0FZOw0KKyAgICB9DQogDQogICAgIHNwaW5fbG9jaygmbXNpeC0+cGRldi0+dnBjaS0+bG9j
ayk7DQogICAgIGVudHJ5ID0gZ2V0X2VudHJ5KG1zaXgsIGFkZHIpOw0KQEAgLTQwNCw2ICs0MjYs
NyBAQCBzdGF0aWMgaW50IGNmX2NoZWNrIG1zaXhfcmVhZCgNCiAgICAgICAgIGJyZWFrOw0KICAg
ICB9DQogICAgIHNwaW5fdW5sb2NrKCZtc2l4LT5wZGV2LT52cGNpLT5sb2NrKTsNCisgICAgcmVh
ZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiANCiAgICAgcmV0dXJuIFg4NkVNVUxfT0tBWTsNCiB9
DQpAQCAtNDkxLDE5ICs1MTQsMzMgQEAgc3RhdGljIGludCBhZGphY2VudF93cml0ZShjb25zdCBz
dHJ1Y3QgZG9tYWluICpkLCBjb25zdCBzdHJ1Y3QgdnBjaV9tc2l4ICptc2l4LA0KIHN0YXRpYyBp
bnQgY2ZfY2hlY2sgbXNpeF93cml0ZSgNCiAgICAgc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGxv
bmcgYWRkciwgdW5zaWduZWQgaW50IGxlbiwgdW5zaWduZWQgbG9uZyBkYXRhKQ0KIHsNCi0gICAg
Y29uc3Qgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsNCi0gICAgc3RydWN0IHZwY2lfbXNp
eCAqbXNpeCA9IG1zaXhfZmluZChkLCBhZGRyKTsNCisgICAgc3RydWN0IGRvbWFpbiAqZCA9IHYt
PmRvbWFpbjsNCisgICAgc3RydWN0IHZwY2lfbXNpeCAqbXNpeDsNCiAgICAgc3RydWN0IHZwY2lf
bXNpeF9lbnRyeSAqZW50cnk7DQogICAgIHVuc2lnbmVkIGludCBvZmZzZXQ7DQogDQorICAgIHJl
YWRfbG9jaygmZC0+cGNpX2xvY2spOw0KKw0KKyAgICBtc2l4ID0gbXNpeF9maW5kKGQsIGFkZHIp
Ow0KICAgICBpZiAoICFtc2l4ICkNCisgICAgew0KKyAgICAgICAgcmVhZF91bmxvY2soJmQtPnBj
aV9sb2NrKTsNCiAgICAgICAgIHJldHVybiBYODZFTVVMX1JFVFJZOw0KKyAgICB9DQogDQogICAg
IGlmICggYWRqYWNlbnRfaGFuZGxlKG1zaXgsIGFkZHIpICkNCi0gICAgICAgIHJldHVybiBhZGph
Y2VudF93cml0ZShkLCBtc2l4LCBhZGRyLCBsZW4sIGRhdGEpOw0KKyAgICB7DQorICAgICAgICBp
bnQgcmMgPSBhZGphY2VudF93cml0ZShkLCBtc2l4LCBhZGRyLCBsZW4sIGRhdGEpOw0KKw0KKyAg
ICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCisgICAgICAgIHJldHVybiByYzsNCisg
ICAgfQ0KIA0KICAgICBpZiAoICFhY2Nlc3NfYWxsb3dlZChtc2l4LT5wZGV2LCBhZGRyLCBsZW4p
ICkNCisgICAgew0KKyAgICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiAgICAgICAg
IHJldHVybiBYODZFTVVMX09LQVk7DQorICAgIH0NCiANCiAgICAgc3Bpbl9sb2NrKCZtc2l4LT5w
ZGV2LT52cGNpLT5sb2NrKTsNCiAgICAgZW50cnkgPSBnZXRfZW50cnkobXNpeCwgYWRkcik7DQpA
QCAtNTc5LDYgKzYxNiw3IEBAIHN0YXRpYyBpbnQgY2ZfY2hlY2sgbXNpeF93cml0ZSgNCiAgICAg
ICAgIGJyZWFrOw0KICAgICB9DQogICAgIHNwaW5fdW5sb2NrKCZtc2l4LT5wZGV2LT52cGNpLT5s
b2NrKTsNCisgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiANCiAgICAgcmV0dXJuIFg4
NkVNVUxfT0tBWTsNCiB9DQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMgYi94
ZW4vZHJpdmVycy92cGNpL3ZwY2kuYw0KaW5kZXggZDczZmE3NjMwMi4uMzRmZmYyZWYyZCAxMDA2
NDQNCi0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvdnBjaS5jDQorKysgYi94ZW4vZHJpdmVycy92cGNp
L3ZwY2kuYw0KQEAgLTM4LDYgKzM4LDggQEAgZXh0ZXJuIHZwY2lfcmVnaXN0ZXJfaW5pdF90ICpj
b25zdCBfX2VuZF92cGNpX2FycmF5W107DQogDQogdm9pZCB2cGNpX3JlbW92ZV9kZXZpY2Uoc3Ry
dWN0IHBjaV9kZXYgKnBkZXYpDQogew0KKyAgICBBU1NFUlQocndfaXNfd3JpdGVfbG9ja2VkKCZw
ZGV2LT5kb21haW4tPnBjaV9sb2NrKSk7DQorDQogICAgIGlmICggIWhhc192cGNpKHBkZXYtPmRv
bWFpbikgfHwgIXBkZXYtPnZwY2kgKQ0KICAgICAgICAgcmV0dXJuOw0KIA0KQEAgLTczLDYgKzc1
LDggQEAgaW50IHZwY2lfYWRkX2hhbmRsZXJzKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQ0KICAgICBj
b25zdCB1bnNpZ25lZCBsb25nICpyb19tYXA7DQogICAgIGludCByYyA9IDA7DQogDQorICAgIEFT
U0VSVChyd19pc193cml0ZV9sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xvY2spKTsNCisNCiAg
ICAgaWYgKCAhaGFzX3ZwY2kocGRldi0+ZG9tYWluKSApDQogICAgICAgICByZXR1cm4gMDsNCiAN
CkBAIC0zMjYsMTEgKzMzMCwxMiBAQCBzdGF0aWMgdWludDMyX3QgbWVyZ2VfcmVzdWx0KHVpbnQz
Ml90IGRhdGEsIHVpbnQzMl90IG5ldywgdW5zaWduZWQgaW50IHNpemUsDQogDQogdWludDMyX3Qg
dnBjaV9yZWFkKHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQgaW50
IHNpemUpDQogew0KLSAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpkID0gY3VycmVudC0+ZG9tYWlu
Ow0KKyAgICBzdHJ1Y3QgZG9tYWluICpkID0gY3VycmVudC0+ZG9tYWluOw0KICAgICBjb25zdCBz
dHJ1Y3QgcGNpX2RldiAqcGRldjsNCiAgICAgY29uc3Qgc3RydWN0IHZwY2lfcmVnaXN0ZXIgKnI7
DQogICAgIHVuc2lnbmVkIGludCBkYXRhX29mZnNldCA9IDA7DQogICAgIHVpbnQzMl90IGRhdGEg
PSB+KHVpbnQzMl90KTA7DQorICAgIHJ3bG9ja190ICpsb2NrOw0KIA0KICAgICBpZiAoICFzaXpl
ICkNCiAgICAgew0KQEAgLTM0MiwxMSArMzQ3LDIxIEBAIHVpbnQzMl90IHZwY2lfcmVhZChwY2lf
c2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVuc2lnbmVkIGludCBzaXplKQ0KICAgICAg
KiBGaW5kIHRoZSBQQ0kgZGV2IG1hdGNoaW5nIHRoZSBhZGRyZXNzLCB3aGljaCBmb3IgaHdkb20g
YWxzbyByZXF1aXJlcw0KICAgICAgKiBjb25zdWx0aW5nIERvbVhFTi4gIFBhc3N0aHJvdWdoIGV2
ZXJ5dGhpbmcgdGhhdCdzIG5vdCB0cmFwcGVkLg0KICAgICAgKi8NCisgICAgbG9jayA9ICZkLT5w
Y2lfbG9jazsNCisgICAgcmVhZF9sb2NrKGxvY2spOw0KICAgICBwZGV2ID0gcGNpX2dldF9wZGV2
KGQsIHNiZGYpOw0KICAgICBpZiAoICFwZGV2ICYmIGlzX2hhcmR3YXJlX2RvbWFpbihkKSApDQor
ICAgIHsNCisgICAgICAgIHJlYWRfdW5sb2NrKGxvY2spOw0KKyAgICAgICAgbG9jayA9ICZkb21f
eGVuLT5wY2lfbG9jazsNCisgICAgICAgIHJlYWRfbG9jayhsb2NrKTsNCiAgICAgICAgIHBkZXYg
PSBwY2lfZ2V0X3BkZXYoZG9tX3hlbiwgc2JkZik7DQorICAgIH0NCiAgICAgaWYgKCAhcGRldiB8
fCAhcGRldi0+dnBjaSApDQorICAgIHsNCisgICAgICAgIHJlYWRfdW5sb2NrKGxvY2spOw0KICAg
ICAgICAgcmV0dXJuIHZwY2lfcmVhZF9odyhzYmRmLCByZWcsIHNpemUpOw0KKyAgICB9DQogDQog
ICAgIHNwaW5fbG9jaygmcGRldi0+dnBjaS0+bG9jayk7DQogDQpAQCAtMzkyLDYgKzQwNyw3IEBA
IHVpbnQzMl90IHZwY2lfcmVhZChwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVu
c2lnbmVkIGludCBzaXplKQ0KICAgICAgICAgQVNTRVJUKGRhdGFfb2Zmc2V0IDwgc2l6ZSk7DQog
ICAgIH0NCiAgICAgc3Bpbl91bmxvY2soJnBkZXYtPnZwY2ktPmxvY2spOw0KKyAgICByZWFkX3Vu
bG9jayhsb2NrKTsNCiANCiAgICAgaWYgKCBkYXRhX29mZnNldCA8IHNpemUgKQ0KICAgICB7DQpA
QCAtNDMxLDEwICs0NDcsMjMgQEAgc3RhdGljIHZvaWQgdnBjaV93cml0ZV9oZWxwZXIoY29uc3Qg
c3RydWN0IHBjaV9kZXYgKnBkZXYsDQogICAgICAgICAgICAgIHItPnByaXZhdGUpOw0KIH0NCiAN
CisvKiBIZWxwZXIgZnVuY3Rpb24gdG8gdW5sb2NrIGxvY2tzIHRha2VuIGJ5IHZwY2lfd3JpdGUg
aW4gcHJvcGVyIG9yZGVyICovDQorc3RhdGljIHZvaWQgcmVsZWFzZV9kb21haW5fbG9ja3Moc3Ry
dWN0IGRvbWFpbiAqZCkNCit7DQorICAgIEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJmQtPnBj
aV9sb2NrKSk7DQorDQorICAgIGlmICggaXNfaGFyZHdhcmVfZG9tYWluKGQpICkNCisgICAgew0K
KyAgICAgICAgQVNTRVJUKHJ3X2lzX3dyaXRlX2xvY2tlZCgmZG9tX3hlbi0+cGNpX2xvY2spKTsN
CisgICAgICAgIHdyaXRlX3VubG9jaygmZG9tX3hlbi0+cGNpX2xvY2spOw0KKyAgICB9DQorICAg
IHdyaXRlX3VubG9jaygmZC0+cGNpX2xvY2spOw0KK30NCisNCiB2b2lkIHZwY2lfd3JpdGUocGNp
X3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBpbnQgc2l6ZSwNCiAgICAg
ICAgICAgICAgICAgdWludDMyX3QgZGF0YSkNCiB7DQotICAgIGNvbnN0IHN0cnVjdCBkb21haW4g
KmQgPSBjdXJyZW50LT5kb21haW47DQorICAgIHN0cnVjdCBkb21haW4gKmQgPSBjdXJyZW50LT5k
b21haW47DQogICAgIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0KICAgICBjb25zdCBzdHJ1
Y3QgdnBjaV9yZWdpc3RlciAqcjsNCiAgICAgdW5zaWduZWQgaW50IGRhdGFfb2Zmc2V0ID0gMDsN
CkBAIC00NDcsOCArNDc2LDE2IEBAIHZvaWQgdnBjaV93cml0ZShwY2lfc2JkZl90IHNiZGYsIHVu
c2lnbmVkIGludCByZWcsIHVuc2lnbmVkIGludCBzaXplLA0KIA0KICAgICAvKg0KICAgICAgKiBG
aW5kIHRoZSBQQ0kgZGV2IG1hdGNoaW5nIHRoZSBhZGRyZXNzLCB3aGljaCBmb3IgaHdkb20gYWxz
byByZXF1aXJlcw0KLSAgICAgKiBjb25zdWx0aW5nIERvbVhFTi4gIFBhc3N0aHJvdWdoIGV2ZXJ5
dGhpbmcgdGhhdCdzIG5vdCB0cmFwcGVkLg0KKyAgICAgKiBjb25zdWx0aW5nIERvbVhFTi4gUGFz
c3Rocm91Z2ggZXZlcnl0aGluZyB0aGF0J3Mgbm90IHRyYXBwZWQuDQorICAgICAqIElmIHRoaXMg
aXMgaHdkb20sIHdlIG5lZWQgdG8gaG9sZCBsb2NrcyBmb3IgYm90aCBkb21haW4gaW4gY2FzZSBp
Zg0KKyAgICAgKiBtb2RpZnlfYmFycygpIGlzIGNhbGxlZA0KICAgICAgKi8NCisgICAgd3JpdGVf
bG9jaygmZC0+cGNpX2xvY2spOw0KKw0KKyAgICAvKiBkb21feGVuLT5wY2lfbG9jayBhbHdheXMg
c2hvdWxkIGJlIHRha2VuIHNlY29uZCB0byBwcmV2ZW50IGRlYWRsb2NrICovDQorICAgIGlmICgg
aXNfaGFyZHdhcmVfZG9tYWluKGQpICkNCisgICAgICAgIHdyaXRlX2xvY2soJmRvbV94ZW4tPnBj
aV9sb2NrKTsNCisNCiAgICAgcGRldiA9IHBjaV9nZXRfcGRldihkLCBzYmRmKTsNCiAgICAgaWYg
KCAhcGRldiAmJiBpc19oYXJkd2FyZV9kb21haW4oZCkgKQ0KICAgICAgICAgcGRldiA9IHBjaV9n
ZXRfcGRldihkb21feGVuLCBzYmRmKTsNCkBAIC00NTksNiArNDk2LDggQEAgdm9pZCB2cGNpX3dy
aXRlKHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQgaW50IHNpemUs
DQogDQogICAgICAgICBpZiAoICFyb19tYXAgfHwgIXRlc3RfYml0KHNiZGYuYmRmLCByb19tYXAp
ICkNCiAgICAgICAgICAgICB2cGNpX3dyaXRlX2h3KHNiZGYsIHJlZywgc2l6ZSwgZGF0YSk7DQor
DQorICAgICAgICByZWxlYXNlX2RvbWFpbl9sb2NrcyhkKTsNCiAgICAgICAgIHJldHVybjsNCiAg
ICAgfQ0KIA0KQEAgLTQ5OCw2ICs1MzcsNyBAQCB2b2lkIHZwY2lfd3JpdGUocGNpX3NiZGZfdCBz
YmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBpbnQgc2l6ZSwNCiAgICAgICAgIEFTU0VS
VChkYXRhX29mZnNldCA8IHNpemUpOw0KICAgICB9DQogICAgIHNwaW5fdW5sb2NrKCZwZGV2LT52
cGNpLT5sb2NrKTsNCisgICAgcmVsZWFzZV9kb21haW5fbG9ja3MoZCk7DQogDQogICAgIGlmICgg
ZGF0YV9vZmZzZXQgPCBzaXplICkNCiAgICAgICAgIC8qIFRhaWxpbmcgZ2FwLCB3cml0ZSB0aGUg
cmVtYWluaW5nLiAqLw0KLS0gDQoyLjQxLjANCg==


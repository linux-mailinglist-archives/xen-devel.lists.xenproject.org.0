Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 310CC6AD64
	for <lists+xen-devel@lfdr.de>; Tue, 16 Jul 2019 19:09:30 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hnQuS-0005qj-Ey; Tue, 16 Jul 2019 17:06:36 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=v+lg=VN=bitdefender.com=ppircalabu@srs-us1.protection.inumbo.net>)
 id 1hnQuR-0005qC-8d
 for xen-devel@lists.xenproject.org; Tue, 16 Jul 2019 17:06:35 +0000
X-Inumbo-ID: 0d825f0e-a7ec-11e9-8980-bc764e045a96
Received: from mx01.bbu.dsd.mx.bitdefender.com (unknown [91.199.104.161])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 0d825f0e-a7ec-11e9-8980-bc764e045a96;
 Tue, 16 Jul 2019 17:06:30 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 46AD3305FFA8; Tue, 16 Jul 2019 20:06:26 +0300 (EEST)
Received: from bitdefender.com (unknown [195.189.155.70])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 2D222304F609;
 Tue, 16 Jul 2019 20:06:26 +0300 (EEST)
From: Petre Pircalabu <ppircalabu@bitdefender.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 16 Jul 2019 20:06:24 +0300
Message-Id: <fa78b1f1a9b046f52a017afcb73c6ef57d018d82.1563293545.git.ppircalabu@bitdefender.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <cover.1563293545.git.ppircalabu@bitdefender.com>
References: <cover.1563293545.git.ppircalabu@bitdefender.com>
In-Reply-To: <cover.1563293545.git.ppircalabu@bitdefender.com>
References: <cover.1563293545.git.ppircalabu@bitdefender.com>
Subject: [Xen-devel] [PATCH v2 10/10] xen-access: Add support for
 vm_event_ng interface
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Petre Pircalabu <ppircalabu@bitdefender.com>,
 Tamas K Lengyel <tamas@tklengyel.com>,
 Razvan Cojocaru <rcojocaru@bitdefender.com>, Wei Liu <wl@xen.org>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Alexandru Isaila <aisaila@bitdefender.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

U3BsaXQgeGVuLWFjY2VzcyBpbiBvcmRlciB0byBhY2NvbW1vZGF0ZSBib3RoIHZtX2V2ZW50IGlu
dGVyZmFjZXMKKGxlZ2FjeSBhbmQgTkcpLiBCeSBkZWZhdWx0LCB0aGUgbGVnYWN5IHZtX2V2ZW50
IGlzIHNlbGVjdGVkIGJ1dAp0aGlzIGNhbiBiZSBjaGFuZ2VkIGJ5IGFkZGluZyB0aGUgJy1uJyBm
bGFnIGluIHRoZSBjb21tYW5kIGxpbmUuCgpTaWduZWQtb2ZmLWJ5OiBQZXRyZSBQaXJjYWxhYnUg
PHBwaXJjYWxhYnVAYml0ZGVmZW5kZXIuY29tPgotLS0KIHRvb2xzL3Rlc3RzL3hlbi1hY2Nlc3Mv
TWFrZWZpbGUgICAgICB8ICAgNyArLQogdG9vbHMvdGVzdHMveGVuLWFjY2Vzcy92bS1ldmVudC1u
Zy5jIHwgMTgzICsrKysrKysrKysrKysrKysrKwogdG9vbHMvdGVzdHMveGVuLWFjY2Vzcy92bS1l
dmVudC5jICAgIHwgMTk0ICsrKysrKysrKysrKysrKysrKysKIHRvb2xzL3Rlc3RzL3hlbi1hY2Nl
c3MveGVuLWFjY2Vzcy5jICB8IDM0OCArKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQogdG9vbHMvdGVzdHMveGVuLWFjY2Vzcy94ZW4tYWNjZXNzLmggIHwgIDkxICsrKysrKysrKwog
NSBmaWxlcyBjaGFuZ2VkLCA1ODIgaW5zZXJ0aW9ucygrKSwgMjQxIGRlbGV0aW9ucygtKQogY3Jl
YXRlIG1vZGUgMTAwNjQ0IHRvb2xzL3Rlc3RzL3hlbi1hY2Nlc3Mvdm0tZXZlbnQtbmcuYwogY3Jl
YXRlIG1vZGUgMTAwNjQ0IHRvb2xzL3Rlc3RzL3hlbi1hY2Nlc3Mvdm0tZXZlbnQuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IHRvb2xzL3Rlc3RzL3hlbi1hY2Nlc3MveGVuLWFjY2Vzcy5oCgpkaWZmIC0t
Z2l0IGEvdG9vbHMvdGVzdHMveGVuLWFjY2Vzcy9NYWtlZmlsZSBiL3Rvb2xzL3Rlc3RzL3hlbi1h
Y2Nlc3MvTWFrZWZpbGUKaW5kZXggMTMxYzlmMy4uMTc3NjBkOCAxMDA2NDQKLS0tIGEvdG9vbHMv
dGVzdHMveGVuLWFjY2Vzcy9NYWtlZmlsZQorKysgYi90b29scy90ZXN0cy94ZW4tYWNjZXNzL01h
a2VmaWxlCkBAIC03LDYgKzcsNyBAQCBDRkxBR1MgKz0gLURYQ19XQU5UX0NPTVBBVF9ERVZJQ0VN
T0RFTF9BUEkKIENGTEFHUyArPSAkKENGTEFHU19saWJ4ZW5jdHJsKQogQ0ZMQUdTICs9ICQoQ0ZM
QUdTX2xpYnhlbmd1ZXN0KQogQ0ZMQUdTICs9ICQoQ0ZMQUdTX2xpYnhlbmV2dGNobikKK0NGTEFH
UyArPSAkKENGTEFHU19saWJ4ZW5mb3JlaWdubWVtb3J5KQogQ0ZMQUdTICs9ICQoQ0ZMQUdTX3hl
bmluY2x1ZGUpCiAKIFRBUkdFVFMteSA6PSB4ZW4tYWNjZXNzCkBAIC0yNSw4ICsyNiwxMCBAQCBj
bGVhbjoKIC5QSE9OWTogZGlzdGNsZWFuCiBkaXN0Y2xlYW46IGNsZWFuCiAKLXhlbi1hY2Nlc3M6
IHhlbi1hY2Nlc3MubyBNYWtlZmlsZQotCSQoQ0MpIC1vICRAICQ8ICQoTERGTEFHUykgJChMRExJ
QlNfbGlieGVuY3RybCkgJChMRExJQlNfbGlieGVuZ3Vlc3QpICQoTERMSUJTX2xpYnhlbmV2dGNo
bikKK09CSlMgPSB4ZW4tYWNjZXNzLm8gdm0tZXZlbnQubyB2bS1ldmVudC1uZy5vCisKK3hlbi1h
Y2Nlc3M6ICQoT0JKUykgTWFrZWZpbGUKKwkkKENDKSAtbyAkQCAkKE9CSlMpICQoTERGTEFHUykg
JChMRExJQlNfbGlieGVuY3RybCkgJChMRExJQlNfbGlieGVuZ3Vlc3QpICQoTERMSUJTX2xpYnhl
bmV2dGNobikgJChMRExJQlNfbGlieGVuZm9yZWlnbm1lbW9yeSkKIAogaW5zdGFsbCB1bmluc3Rh
bGw6CiAKZGlmZiAtLWdpdCBhL3Rvb2xzL3Rlc3RzL3hlbi1hY2Nlc3Mvdm0tZXZlbnQtbmcuYyBi
L3Rvb2xzL3Rlc3RzL3hlbi1hY2Nlc3Mvdm0tZXZlbnQtbmcuYwpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwLi4yYzc5ZjYxCi0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvdGVzdHMv
eGVuLWFjY2Vzcy92bS1ldmVudC1uZy5jCkBAIC0wLDAgKzEsMTgzIEBACisvKgorICogdm0tZXZl
bnQtbmcuYworICoKKyAqIENvcHlyaWdodCAoYykgMjAxOSBCaXRkZWZlbmRlciBTLlIuTC4KKyAq
CisgKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55
IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5CisgKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lh
dGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8KKyAqIGRlYWwgaW4g
dGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0
YXRpb24gdGhlCisgKiByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNo
LCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3IKKyAqIHNlbGwgY29waWVzIG9mIHRoZSBT
b2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCisg
KiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25z
OgorICoKKyAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24g
bm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFs
IHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklE
RUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICog
SU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBN
RVJDSEFOVEFCSUxJVFksCisgKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQg
Tk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKKyAqIEFVVEhPUlMgT1IgQ09Q
WVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIK
KyAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Ig
T1RIRVJXSVNFLCBBUklTSU5HCisgKiBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRI
IFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSCisgKiBERUFMSU5HUyBJTiBUSEUgU09G
VFdBUkUuCisgKi8KKworI2luY2x1ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8aW50dHlwZXMuaD4K
KyNpbmNsdWRlIDxzdGRsaWIuaD4KKyNpbmNsdWRlIDxzdHJpbmcuaD4KKyNpbmNsdWRlIDxzeXMv
bW1hbi5oPgorI2luY2x1ZGUgPHhlbmZvcmVpZ25tZW1vcnkuaD4KKyNpbmNsdWRlICJ4ZW4tYWNj
ZXNzLmgiCisKKyNpZm5kZWYgUEZOX1VQCisjZGVmaW5lIFBGTl9VUCh4KSAgICAgKCgoeCkgKyBY
Q19QQUdFX1NJWkUtMSkgPj4gWENfUEFHRV9TSElGVCkKKyNlbmRpZiAvKiBQRk5fVVAgKi8KKwor
dHlwZWRlZiBzdHJ1Y3Qgdm1fZXZlbnRfY2hhbm5lbHMKK3sKKyAgICB2bV9ldmVudF90IHZtZTsK
KyAgICBpbnQgbnVtX2NoYW5uZWxzOworICAgIHhlbmZvcmVpZ25tZW1vcnlfcmVzb3VyY2VfaGFu
ZGxlICpmcmVzOworICAgIHN0cnVjdCB2bV9ldmVudF9zbG90ICpzbG90czsKKyAgICBpbnQgKnBv
cnRzOworfSB2bV9ldmVudF9jaGFubmVsc190OworCisjZGVmaW5lIHRvX2NoYW5uZWxzKF92bWUp
IGNvbnRhaW5lcl9vZigoX3ZtZSksIHZtX2V2ZW50X2NoYW5uZWxzX3QsIHZtZSkKKworc3RhdGlj
IGludCB2bV9ldmVudF9jaGFubmVsc19pbml0KHhjX2ludGVyZmFjZSAqeGNoLCB4ZW5ldnRjaG5f
aGFuZGxlICp4Y2UsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9taWRfdCBk
b21haW5faWQsIHZtX2V2ZW50X29wc190ICpvcHMsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdm1fZXZlbnRfdCAqKnZtX2V2ZW50KQoreworICAgIHZtX2V2ZW50X2NoYW5uZWxz
X3QgKmltcGwgPSBOVUxMOworICAgIGludCByYywgaTsKKworICAgIGltcGwgPSAodm1fZXZlbnRf
Y2hhbm5lbHNfdCAqKWNhbGxvYygxLCBzaXplb2Yodm1fZXZlbnRfY2hhbm5lbHNfdCkpOworICAg
IGlmICggaW1wbCA9PSBOVUxMICkKKyAgICAgICAgcmV0dXJuIC1FTk9NRU07CisKKyAgICByYyA9
IHhjX21vbml0b3JfbmdfZW5hYmxlKHhjaCwgZG9tYWluX2lkLCAmaW1wbC0+ZnJlcywgJmltcGwt
Pm51bV9jaGFubmVscywgKHZvaWQqKikmaW1wbC0+c2xvdHMpOworICAgIGlmICggcmMgKQorICAg
IHsKKyAgICAgICAgRVJST1IoIkZhaWxlZCB0byBlbmFibGUgbW9uaXRvciIpOworICAgICAgICBy
ZXR1cm4gcmM7CisgICAgfQorCisgICAgaW1wbC0+cG9ydHMgPSBjYWxsb2MoaW1wbC0+bnVtX2No
YW5uZWxzLCBzaXplb2YoaW50KSk7CisgICAgaWYgKCBpbXBsLT5wb3J0cyA9PSBOVUxMICkKKyAg
ICB7CisgICAgICAgIHJjID0gLUVOT01FTTsKKyAgICAgICAgZ290byBlcnI7CisgICAgfQorCisg
ICAgZm9yICggaSA9IDA7IGkgPCBpbXBsLT5udW1fY2hhbm5lbHM7IGkrKykKKyAgICB7CisgICAg
ICAgIHJjID0geGVuZXZ0Y2huX2JpbmRfaW50ZXJkb21haW4oeGNlLCBkb21haW5faWQsIGltcGwt
PnNsb3RzW2ldLnBvcnQpOworICAgICAgICBpZiAoICByYyA8IDAgKQorICAgICAgICB7CisgICAg
ICAgICAgICBFUlJPUigiRmFpbGVkIHRvIGJpbmQgdm1fZXZlbnRfc2xvdCBwb3J0IGZvciB2Y3B1
ICVkIiwgaSk7CisgICAgICAgICAgICByYyA9IC1lcnJubzsKKyAgICAgICAgICAgIGdvdG8gZXJy
OworICAgICAgICB9CisKKyAgICAgICAgaW1wbC0+cG9ydHNbaV0gPSByYzsKKyAgICB9CisKKyAg
ICAqdm1fZXZlbnQgPSAodm1fZXZlbnRfdCopIGltcGw7CisgICAgcmV0dXJuIDA7CisKK2VycjoK
KyAgICB3aGlsZSAoIC0taSA+PSAwICkKKyAgICAgICAgeGVuZXZ0Y2huX3VuYmluZCh4Y2UsIGlt
cGwtPnBvcnRzW2ldKTsKKyAgICBmcmVlKGltcGwtPnBvcnRzKTsKKyAgICB4Y19tb25pdG9yX25n
X2Rpc2FibGUoeGNoLCBkb21haW5faWQsICZpbXBsLT5mcmVzKTsKKyAgICBmcmVlKGltcGwpOwor
ICAgIHJldHVybiByYzsKK30KKworc3RhdGljIGludCB2Y3B1X2lkX2J5X3BvcnQodm1fZXZlbnRf
Y2hhbm5lbHNfdCAqaW1wbCwgaW50IHBvcnQsIGludCAqdmNwdV9pZCkKK3sKKyAgICBpbnQgaTsK
KworICAgIGZvciAoIGkgPSAwOyBpIDwgaW1wbC0+bnVtX2NoYW5uZWxzOyBpKysgKQorICAgIHsK
KyAgICAgICAgaWYgKCBwb3J0ID09IGltcGwtPnBvcnRzW2ldICkKKyAgICAgICAgeworICAgICAg
ICAgICAgKnZjcHVfaWQgPSBpOworICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAgIH0KKyAg
ICB9CisKKyAgICByZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIGludCB2bV9ldmVudF9jaGFu
bmVsc190ZWFyZG93bih2bV9ldmVudF90ICp2bV9ldmVudCkKK3sKKyAgICB2bV9ldmVudF9jaGFu
bmVsc190ICppbXBsID0gdG9fY2hhbm5lbHModm1fZXZlbnQpOworICAgIGludCByYywgaTsKKwor
ICAgIGlmICggaW1wbCA9PSBOVUxMIHx8IGltcGwtPnBvcnRzID09IE5VTEwgKQorICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsKKworICAgIGZvciAoIGkgPSAwOyBpIDwgaW1wbC0+bnVtX2NoYW5uZWxz
OyBpKysgKQorICAgIHsKKyAgICAgICAgcmMgPSB4ZW5ldnRjaG5fdW5iaW5kKHZtX2V2ZW50LT54
Y2UsIGltcGwtPnBvcnRzW2ldKTsKKyAgICAgICAgaWYgKCByYyAhPSAwICkKKyAgICAgICAgewor
ICAgICAgICAgICAgRVJST1IoIkVycm9yIHVuYmluZGluZyBldmVudCBwb3J0Iik7CisgICAgICAg
ICAgICByZXR1cm4gcmM7CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXR1cm4geGNfbW9uaXRv
cl9uZ19kaXNhYmxlKGltcGwtPnZtZS54Y2gsIGltcGwtPnZtZS5kb21haW5faWQsICZpbXBsLT5m
cmVzKTsKK30KKworc3RhdGljIGJvb2wgdm1fZXZlbnRfY2hhbm5lbHNfZ2V0X3JlcXVlc3Qodm1f
ZXZlbnRfdCAqdm1fZXZlbnQsIHZtX2V2ZW50X3JlcXVlc3RfdCAqcmVxLCBpbnQgKnBvcnQpCit7
CisgICAgaW50IHZjcHVfaWQ7CisgICAgdm1fZXZlbnRfY2hhbm5lbHNfdCAqaW1wbCA9IHRvX2No
YW5uZWxzKHZtX2V2ZW50KTsKKworICAgIGlmICggdmNwdV9pZF9ieV9wb3J0KGltcGwsICpwb3J0
LCAmdmNwdV9pZCkgIT0gMCApCisgICAgICAgIHJldHVybiBmYWxzZTsKKworICAgIGlmICggaW1w
bC0+c2xvdHNbdmNwdV9pZF0uc3RhdGUgIT0gU1RBVEVfVk1fRVZFTlRfU0xPVF9TVUJNSVQgKQor
ICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICBtZW1jcHkocmVxLCAmaW1wbC0+c2xvdHNbdmNw
dV9pZF0udS5yZXEsIHNpemVvZigqcmVxKSk7CisKKyAgICByZXR1cm4gdHJ1ZTsKK30KKworc3Rh
dGljIHZvaWQgdm1fZXZlbnRfY2hhbm5lbHNfcHV0X3Jlc3BvbnNlKHZtX2V2ZW50X3QgKnZtX2V2
ZW50LCB2bV9ldmVudF9yZXNwb25zZV90ICpyc3AsIGludCBwb3J0KQoreworICAgIGludCB2Y3B1
X2lkOworICAgIHZtX2V2ZW50X2NoYW5uZWxzX3QgKmltcGwgPSB0b19jaGFubmVscyh2bV9ldmVu
dCk7CisKKyAgICBpZiAoIHZjcHVfaWRfYnlfcG9ydChpbXBsLCBwb3J0LCAmdmNwdV9pZCkgIT0g
MCApCisgICAgICAgIHJldHVybjsKKworICAgIG1lbWNweSgmaW1wbC0+c2xvdHNbdmNwdV9pZF0u
dS5yc3AsIHJzcCwgc2l6ZW9mKCpyc3ApKTsKKyAgICBpbXBsLT5zbG90c1t2Y3B1X2lkXS5zdGF0
ZSA9IFNUQVRFX1ZNX0VWRU5UX1NMT1RfRklOSVNIOworfQorCitzdGF0aWMgaW50IHZtX2V2ZW50
X2NoYW5uZWxzX25vdGlmeV9wb3J0KHZtX2V2ZW50X3QgKnZtX2V2ZW50LCBpbnQgcG9ydCkKK3sK
KyAgICByZXR1cm4geGVuZXZ0Y2huX25vdGlmeSh2bV9ldmVudC0+eGNlLCBwb3J0KTsKK30KKwor
dm1fZXZlbnRfb3BzX3QgY2hhbm5lbF9vcHMgPSB7CisgICAgLmdldF9yZXF1ZXN0ID0gdm1fZXZl
bnRfY2hhbm5lbHNfZ2V0X3JlcXVlc3QsCisgICAgLnB1dF9yZXNwb25zZSA9IHZtX2V2ZW50X2No
YW5uZWxzX3B1dF9yZXNwb25zZSwKKyAgICAubm90aWZ5X3BvcnQgPSB2bV9ldmVudF9jaGFubmVs
c19ub3RpZnlfcG9ydCwKKyAgICAuaW5pdCA9IHZtX2V2ZW50X2NoYW5uZWxzX2luaXQsCisgICAg
LnRlYXJkb3duID0gdm1fZXZlbnRfY2hhbm5lbHNfdGVhcmRvd24sCit9OworCisvKgorICogTG9j
YWwgdmFyaWFibGVzOgorICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAiQlNEIgorICogYy1i
YXNpYy1vZmZzZXQ6IDQKKyAqIGluZGVudC10YWJzLW1vZGU6IG5pbAorICogRW5kOgorICovCmRp
ZmYgLS1naXQgYS90b29scy90ZXN0cy94ZW4tYWNjZXNzL3ZtLWV2ZW50LmMgYi90b29scy90ZXN0
cy94ZW4tYWNjZXNzL3ZtLWV2ZW50LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MC4uZTZiMjBjZQotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL3Rlc3RzL3hlbi1hY2Nlc3Mvdm0t
ZXZlbnQuYwpAQCAtMCwwICsxLDE5NCBAQAorLyoKKyAqIHZtLWV2ZW50LmMKKyAqCisgKiBDb3B5
cmlnaHQgKGMpIDIwMTkgQml0ZGVmZW5kZXIgUy5SLkwuCisgKgorICogUGVybWlzc2lvbiBpcyBo
ZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEg
Y29weQorICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZp
bGVzICh0aGUgIlNvZnR3YXJlIiksIHRvCisgKiBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0
IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZQorICogcmlnaHRz
IHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGlj
ZW5zZSwgYW5kL29yCisgKiBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJt
aXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcworICogZnVybmlzaGVkIHRvIGRvIHNv
LCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKyAqCisgKiBUaGUgYWJvdmUg
Y29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNs
dWRlZCBpbgorICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29m
dHdhcmUuCisgKgorICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQg
V0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKKyAqIElNUExJRUQsIElOQ0xVRElORyBC
VVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAorICog
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4g
Tk8gRVZFTlQgU0hBTEwgVEhFCisgKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJ
QUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCisgKiBMSUFCSUxJVFksIFdIRVRI
RVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORwor
ICogRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhF
IFVTRSBPUiBPVEhFUgorICogREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgorICovCisKKyNpbmNs
dWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGludHR5cGVzLmg+CisjaW5jbHVkZSA8c3RkbGliLmg+
CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVkZSA8c3lzL21tYW4uaD4KKyNpbmNsdWRlICJ4
ZW4tYWNjZXNzLmgiCisKK3R5cGVkZWYgc3RydWN0IHZtX2V2ZW50X3JpbmcgeworICAgIHZtX2V2
ZW50X3Qgdm1lOworICAgIGludCBwb3J0OworICAgIHZtX2V2ZW50X2JhY2tfcmluZ190IGJhY2tf
cmluZzsKKyAgICB1aW50MzJfdCBldnRjaG5fcG9ydDsKKyAgICB2b2lkICpyaW5nX3BhZ2U7Cit9
IHZtX2V2ZW50X3JpbmdfdDsKKworI2RlZmluZSB0b19yaW5nKF92bWUpIGNvbnRhaW5lcl9vZigo
X3ZtZSksIHZtX2V2ZW50X3JpbmdfdCwgdm1lKQorCitzdGF0aWMgaW50IHZtX2V2ZW50X3Jpbmdf
aW5pdCh4Y19pbnRlcmZhY2UgKnhjaCwgeGVuZXZ0Y2huX2hhbmRsZSAqeGNlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZG9taWRfdCBkb21haW5faWQsIHZtX2V2ZW50X29wc190ICpv
cHMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bV9ldmVudF90ICoqdm1fZXZlbnQp
Cit7CisgICAgdm1fZXZlbnRfcmluZ190ICppbXBsOworICAgIGludCByYzsKKworICAgIGltcGwg
PSAodm1fZXZlbnRfcmluZ190KikgY2FsbG9jICgxLCBzaXplb2Yodm1fZXZlbnRfcmluZ190KSk7
CisgICAgaWYgKCBpbXBsID09IE5VTEwgKQorICAgICAgICByZXR1cm4gLUVOT01FTTsKKworICAg
IC8qIEVuYWJsZSBtZW1fYWNjZXNzICovCisgICAgaW1wbC0+cmluZ19wYWdlID0geGNfbW9uaXRv
cl9lbmFibGUoeGNoLCBkb21haW5faWQsICZpbXBsLT5ldnRjaG5fcG9ydCk7CisgICAgaWYgKCBp
bXBsLT5yaW5nX3BhZ2UgPT0gTlVMTCApCisgICAgeworICAgICAgICBzd2l0Y2ggKCBlcnJubyAp
CisgICAgICAgIHsKKyAgICAgICAgY2FzZSBFQlVTWToKKyAgICAgICAgICAgIEVSUk9SKCJ4ZW5h
Y2Nlc3MgaXMgKG9yIHdhcykgYWN0aXZlIG9uIHRoaXMgZG9tYWluIik7CisgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgY2FzZSBFTk9ERVY6CisgICAgICAgICAgICBFUlJPUigiRVBUIG5vdCBz
dXBwb3J0ZWQgZm9yIHRoaXMgZ3Vlc3QiKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBk
ZWZhdWx0OgorICAgICAgICAgICAgcGVycm9yKCJFcnJvciBlbmFibGluZyBtZW1fYWNjZXNzIik7
CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICByYyA9IC1lcnJubzsKKyAg
ICAgICAgZ290byBlcnI7CisgICAgfQorCisgICAgLyogQmluZCBldmVudCBub3RpZmljYXRpb24g
Ki8KKyAgICByYyA9IHhlbmV2dGNobl9iaW5kX2ludGVyZG9tYWluKHhjZSwgZG9tYWluX2lkLCBp
bXBsLT5ldnRjaG5fcG9ydCk7CisgICAgaWYgKCByYyA8IDAgKQorICAgIHsKKyAgICAgICAgRVJS
T1IoIkZhaWxlZCB0byBiaW5kIGV2ZW50IGNoYW5uZWwiKTsKKyAgICAgICAgbXVubWFwKGltcGwt
PnJpbmdfcGFnZSwgWENfUEFHRV9TSVpFKTsKKyAgICAgICAgeGNfbW9uaXRvcl9kaXNhYmxlKHhj
aCwgZG9tYWluX2lkKTsKKyAgICAgICAgZ290byBlcnI7CisgICAgfQorCisgICAgaW1wbC0+cG9y
dCA9IHJjOworCisgICAgLyogSW5pdGlhbGlzZSByaW5nICovCisgICAgU0hBUkVEX1JJTkdfSU5J
VCgodm1fZXZlbnRfc3JpbmdfdCAqKWltcGwtPnJpbmdfcGFnZSk7CisgICAgQkFDS19SSU5HX0lO
SVQoJmltcGwtPmJhY2tfcmluZywgKHZtX2V2ZW50X3NyaW5nX3QgKilpbXBsLT5yaW5nX3BhZ2Us
CisgICAgICAgICAgICAgICAgICAgWENfUEFHRV9TSVpFKTsKKworICAgICp2bV9ldmVudCA9ICh2
bV9ldmVudF90KikgaW1wbDsKKyAgICByZXR1cm4gMDsKKworZXJyOgorICAgIGZyZWUoaW1wbCk7
CisgICAgcmV0dXJuIHJjOworfQorCitzdGF0aWMgaW50IHZtX2V2ZW50X3JpbmdfdGVhcmRvd24o
dm1fZXZlbnRfdCAqdm1fZXZlbnQpCit7CisgICAgdm1fZXZlbnRfcmluZ190ICppbXBsID0gdG9f
cmluZyh2bV9ldmVudCk7CisgICAgaW50IHJjOworCisgICAgaWYgKCBpbXBsLT5yaW5nX3BhZ2Ug
IT0gTlVMTCApCisgICAgICAgIG11bm1hcChpbXBsLT5yaW5nX3BhZ2UsIFhDX1BBR0VfU0laRSk7
CisKKyAgICAvKiBUZWFyIGRvd24gZG9tYWluIHhlbmFjY2VzcyBpbiBYZW4gKi8KKyAgICByYyA9
IHhjX21vbml0b3JfZGlzYWJsZSh2bV9ldmVudC0+eGNoLCB2bV9ldmVudC0+ZG9tYWluX2lkKTsK
KyAgICBpZiAoIHJjICE9IDAgKQorICAgIHsKKyAgICAgICAgRVJST1IoIkVycm9yIHRlYXJpbmcg
ZG93biBkb21haW4geGVuYWNjZXNzIGluIHhlbiIpOworICAgICAgICByZXR1cm4gcmM7CisgICAg
fQorCisgICAgLyogVW5iaW5kIFZJUlEgKi8KKyAgICByYyA9IHhlbmV2dGNobl91bmJpbmQodm1f
ZXZlbnQtPnhjZSwgaW1wbC0+cG9ydCk7CisgICAgaWYgKCByYyAhPSAwICkKKyAgICB7CisgICAg
ICAgIEVSUk9SKCJFcnJvciB1bmJpbmRpbmcgZXZlbnQgcG9ydCIpOworICAgICAgICByZXR1cm4g
cmM7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKKy8qCisgKiBOb3RlIHRoYXQgdGhpcyBm
dW5jdGlvbiBpcyBub3QgdGhyZWFkIHNhZmUuCisgKi8KK3N0YXRpYyBib29sIHZtX2V2ZW50X3Jp
bmdfZ2V0X3JlcXVlc3Qodm1fZXZlbnRfdCAqdm1fZXZlbnQsIHZtX2V2ZW50X3JlcXVlc3RfdCAq
cmVxLCBpbnQgKnBvcnQpCit7CisgICAgdm1fZXZlbnRfYmFja19yaW5nX3QgKmJhY2tfcmluZzsK
KyAgICBSSU5HX0lEWCByZXFfY29uczsKKyAgICB2bV9ldmVudF9yaW5nX3QgKmltcGwgPSB0b19y
aW5nKHZtX2V2ZW50KTsKKworICAgIGlmICggIVJJTkdfSEFTX1VOQ09OU1VNRURfUkVRVUVTVFMo
JmltcGwtPmJhY2tfcmluZykgKQorICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICBiYWNrX3Jp
bmcgPSAmaW1wbC0+YmFja19yaW5nOworICAgIHJlcV9jb25zID0gYmFja19yaW5nLT5yZXFfY29u
czsKKworICAgIC8qIENvcHkgcmVxdWVzdCAqLworICAgIG1lbWNweShyZXEsIFJJTkdfR0VUX1JF
UVVFU1QoYmFja19yaW5nLCByZXFfY29ucyksIHNpemVvZigqcmVxKSk7CisgICAgcmVxX2NvbnMr
KzsKKworICAgIC8qIFVwZGF0ZSByaW5nICovCisgICAgYmFja19yaW5nLT5yZXFfY29ucyA9IHJl
cV9jb25zOworICAgIGJhY2tfcmluZy0+c3JpbmctPnJlcV9ldmVudCA9IHJlcV9jb25zICsgMTsK
KworICAgICpwb3J0ID0gaW1wbC0+cG9ydDsKKworICAgIHJldHVybiB0cnVlOworfQorCisvKgor
ICogTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gaXMgbm90IHRocmVhZCBzYWZlLgorICovCitzdGF0
aWMgdm9pZCB2bV9ldmVudF9yaW5nX3B1dF9yZXNwb25zZSh2bV9ldmVudF90ICp2bV9ldmVudCwg
dm1fZXZlbnRfcmVzcG9uc2VfdCAqcnNwLCBpbnQgcG9ydCkKK3sKKyAgICB2bV9ldmVudF9iYWNr
X3JpbmdfdCAqYmFja19yaW5nOworICAgIFJJTkdfSURYIHJzcF9wcm9kOworICAgIHZtX2V2ZW50
X3JpbmdfdCAqaW1wbCA9IHRvX3Jpbmcodm1fZXZlbnQpOworCisgICAgYmFja19yaW5nID0gJmlt
cGwtPmJhY2tfcmluZzsKKyAgICByc3BfcHJvZCA9IGJhY2tfcmluZy0+cnNwX3Byb2RfcHZ0Owor
CisgICAgLyogQ29weSByZXNwb25zZSAqLworICAgIG1lbWNweShSSU5HX0dFVF9SRVNQT05TRShi
YWNrX3JpbmcsIHJzcF9wcm9kKSwgcnNwLCBzaXplb2YoKnJzcCkpOworICAgIHJzcF9wcm9kKys7
CisKKyAgICAvKiBVcGRhdGUgcmluZyAqLworICAgIGJhY2tfcmluZy0+cnNwX3Byb2RfcHZ0ID0g
cnNwX3Byb2Q7CisgICAgUklOR19QVVNIX1JFU1BPTlNFUyhiYWNrX3JpbmcpOworfQorCitzdGF0
aWMgaW50IHZtX2V2ZW50X3Jpbmdfbm90aWZ5X3BvcnQodm1fZXZlbnRfdCAqdm1fZXZlbnQsIGlu
dCBwb3J0KQoreworICAgIHJldHVybiB4ZW5ldnRjaG5fbm90aWZ5KHZtX2V2ZW50LT54Y2UsIHBv
cnQpOworfQorCit2bV9ldmVudF9vcHNfdCByaW5nX29wcyA9IHsKKyAgICAuZ2V0X3JlcXVlc3Qg
PSB2bV9ldmVudF9yaW5nX2dldF9yZXF1ZXN0LAorICAgIC5wdXRfcmVzcG9uc2UgPSB2bV9ldmVu
dF9yaW5nX3B1dF9yZXNwb25zZSwKKyAgICAubm90aWZ5X3BvcnQgPSB2bV9ldmVudF9yaW5nX25v
dGlmeV9wb3J0LAorICAgIC5pbml0ID0gdm1fZXZlbnRfcmluZ19pbml0LAorICAgIC50ZWFyZG93
biA9IHZtX2V2ZW50X3JpbmdfdGVhcmRvd24sCit9OworCisvKgorICogTG9jYWwgdmFyaWFibGVz
OgorICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAiQlNEIgorICogYy1iYXNpYy1vZmZzZXQ6
IDQKKyAqIGluZGVudC10YWJzLW1vZGU6IG5pbAorICogRW5kOgorICovCmRpZmYgLS1naXQgYS90
b29scy90ZXN0cy94ZW4tYWNjZXNzL3hlbi1hY2Nlc3MuYyBiL3Rvb2xzL3Rlc3RzL3hlbi1hY2Nl
c3MveGVuLWFjY2Vzcy5jCmluZGV4IGFiZjE3YTIuLjkxNTdmMjMgMTAwNjQ0Ci0tLSBhL3Rvb2xz
L3Rlc3RzL3hlbi1hY2Nlc3MveGVuLWFjY2Vzcy5jCisrKyBiL3Rvb2xzL3Rlc3RzL3hlbi1hY2Nl
c3MveGVuLWFjY2Vzcy5jCkBAIC0zNSwxNCArMzUsOSBAQAogI2luY2x1ZGUgPHRpbWUuaD4KICNp
bmNsdWRlIDxzaWduYWwuaD4KICNpbmNsdWRlIDx1bmlzdGQuaD4KLSNpbmNsdWRlIDxzeXMvbW1h
bi5oPgogI2luY2x1ZGUgPHBvbGwuaD4KICNpbmNsdWRlIDxnZXRvcHQuaD4KIAotI2luY2x1ZGUg
PHhlbmN0cmwuaD4KLSNpbmNsdWRlIDx4ZW5ldnRjaG4uaD4KLSNpbmNsdWRlIDx4ZW4vdm1fZXZl
bnQuaD4KLQogI2luY2x1ZGUgPHhlbi10b29scy9saWJzLmg+CiAKICNpZiBkZWZpbmVkKF9fYXJt
X18pIHx8IGRlZmluZWQoX19hYXJjaDY0X18pCkBAIC01Miw5ICs0Nyw3IEBACiAjZGVmaW5lIFNU
QVJUX1BGTiAwVUxMCiAjZW5kaWYKIAotI2RlZmluZSBEUFJJTlRGKGEsIGIuLi4pIGZwcmludGYo
c3RkZXJyLCBhLCAjIyBiKQotI2RlZmluZSBFUlJPUihhLCBiLi4uKSBmcHJpbnRmKHN0ZGVyciwg
YSAiXG4iLCAjIyBiKQotI2RlZmluZSBQRVJST1IoYSwgYi4uLikgZnByaW50ZihzdGRlcnIsIGEg
IjogJXNcbiIsICMjIGIsIHN0cmVycm9yKGVycm5vKSkKKyNpbmNsdWRlICJ4ZW4tYWNjZXNzLmgi
CiAKIC8qIEZyb20geGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3IuaCAqLwogI2RlZmluZSBY
ODZfVFJBUF9ERUJVRyAgMQpAQCAtNjMsMzIgKzU2LDE0IEBACiAvKiBGcm9tIHhlbi9pbmNsdWRl
L2FzbS14ODYveDg2LWRlZm5zLmggKi8KICNkZWZpbmUgWDg2X0NSNF9QR0UgICAgICAgIDB4MDAw
MDAwODAgLyogZW5hYmxlIGdsb2JhbCBwYWdlcyAqLwogCi10eXBlZGVmIHN0cnVjdCB2bV9ldmVu
dCB7Ci0gICAgZG9taWRfdCBkb21haW5faWQ7Ci0gICAgeGVuZXZ0Y2huX2hhbmRsZSAqeGNlX2hh
bmRsZTsKLSAgICBpbnQgcG9ydDsKLSAgICB2bV9ldmVudF9iYWNrX3JpbmdfdCBiYWNrX3Jpbmc7
Ci0gICAgdWludDMyX3QgZXZ0Y2huX3BvcnQ7Ci0gICAgdm9pZCAqcmluZ19wYWdlOwotfSB2bV9l
dmVudF90OwotCi10eXBlZGVmIHN0cnVjdCB4ZW5hY2Nlc3MgewotICAgIHhjX2ludGVyZmFjZSAq
eGNfaGFuZGxlOwotCi0gICAgeGVuX3Bmbl90IG1heF9ncGZuOwotCi0gICAgdm1fZXZlbnRfdCB2
bV9ldmVudDsKLX0geGVuYWNjZXNzX3Q7Ci0KIHN0YXRpYyBpbnQgaW50ZXJydXB0ZWQ7Ci1ib29s
IGV2dGNobl9iaW5kID0gMCwgZXZ0Y2huX29wZW4gPSAwLCBtZW1fYWNjZXNzX2VuYWJsZSA9IDA7
CiAKIHN0YXRpYyB2b2lkIGNsb3NlX2hhbmRsZXIoaW50IHNpZykKIHsKICAgICBpbnRlcnJ1cHRl
ZCA9IHNpZzsKIH0KIAotaW50IHhjX3dhaXRfZm9yX2V2ZW50X29yX3RpbWVvdXQoeGNfaW50ZXJm
YWNlICp4Y2gsIHhlbmV2dGNobl9oYW5kbGUgKnhjZSwgdW5zaWduZWQgbG9uZyBtcykKK3N0YXRp
YyBpbnQgeGNfd2FpdF9mb3JfZXZlbnRfb3JfdGltZW91dCh4Y19pbnRlcmZhY2UgKnhjaCwgeGVu
ZXZ0Y2huX2hhbmRsZSAqeGNlLCB1bnNpZ25lZCBsb25nIG1zKQogewogICAgIHN0cnVjdCBwb2xs
ZmQgZmQgPSB7IC5mZCA9IHhlbmV2dGNobl9mZCh4Y2UpLCAuZXZlbnRzID0gUE9MTElOIHwgUE9M
TEVSUiB9OwogICAgIGludCBwb3J0OwpAQCAtMTI5LDE2MSArMTA0LDg1IEBAIGludCB4Y193YWl0
X2Zvcl9ldmVudF9vcl90aW1lb3V0KHhjX2ludGVyZmFjZSAqeGNoLCB4ZW5ldnRjaG5faGFuZGxl
ICp4Y2UsIHVuc2lnCiAgICAgcmV0dXJuIC1lcnJubzsKIH0KIAotaW50IHhlbmFjY2Vzc190ZWFy
ZG93bih4Y19pbnRlcmZhY2UgKnhjaCwgeGVuYWNjZXNzX3QgKnhlbmFjY2VzcykKK3N0YXRpYyBp
bnQgdm1fZXZlbnRfdGVhcmRvd24odm1fZXZlbnRfdCAqdm1fZXZlbnQpCiB7CiAgICAgaW50IHJj
OwogCi0gICAgaWYgKCB4ZW5hY2Nlc3MgPT0gTlVMTCApCisgICAgaWYgKCB2bV9ldmVudCA9PSBO
VUxMICkKICAgICAgICAgcmV0dXJuIDA7CiAKLSAgICAvKiBUZWFyIGRvd24gZG9tYWluIHhlbmFj
Y2VzcyBpbiBYZW4gKi8KLSAgICBpZiAoIHhlbmFjY2Vzcy0+dm1fZXZlbnQucmluZ19wYWdlICE9
IE5VTEwgKQotICAgICAgICBtdW5tYXAoeGVuYWNjZXNzLT52bV9ldmVudC5yaW5nX3BhZ2UsIFhD
X1BBR0VfU0laRSk7Ci0KLSAgICBpZiAoIG1lbV9hY2Nlc3NfZW5hYmxlICkKLSAgICB7Ci0gICAg
ICAgIHJjID0geGNfbW9uaXRvcl9kaXNhYmxlKHhlbmFjY2Vzcy0+eGNfaGFuZGxlLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5hY2Nlc3MtPnZtX2V2ZW50LmRvbWFpbl9pZCk7
Ci0gICAgICAgIGlmICggcmMgIT0gMCApCi0gICAgICAgIHsKLSAgICAgICAgICAgIEVSUk9SKCJF
cnJvciB0ZWFyaW5nIGRvd24gZG9tYWluIHhlbmFjY2VzcyBpbiB4ZW4iKTsKLSAgICAgICAgICAg
IHJldHVybiByYzsKLSAgICAgICAgfQotICAgIH0KLQotICAgIC8qIFVuYmluZCBWSVJRICovCi0g
ICAgaWYgKCBldnRjaG5fYmluZCApCi0gICAgewotICAgICAgICByYyA9IHhlbmV2dGNobl91bmJp
bmQoeGVuYWNjZXNzLT52bV9ldmVudC54Y2VfaGFuZGxlLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgeGVuYWNjZXNzLT52bV9ldmVudC5wb3J0KTsKLSAgICAgICAgaWYgKCByYyAhPSAw
ICkKLSAgICAgICAgewotICAgICAgICAgICAgRVJST1IoIkVycm9yIHVuYmluZGluZyBldmVudCBw
b3J0Iik7Ci0gICAgICAgICAgICByZXR1cm4gcmM7Ci0gICAgICAgIH0KLSAgICB9CisgICAgcmMg
PSB2bV9ldmVudC0+b3BzLT50ZWFyZG93bih2bV9ldmVudCk7CisgICAgaWYgKCByYyAhPSAwICkK
KyAgICAgICAgcmV0dXJuIHJjOwogCiAgICAgLyogQ2xvc2UgZXZlbnQgY2hhbm5lbCAqLwotICAg
IGlmICggZXZ0Y2huX29wZW4gKQorICAgIHJjID0geGVuZXZ0Y2huX2Nsb3NlKHZtX2V2ZW50LT54
Y2UpOworICAgIGlmICggcmMgIT0gMCApCiAgICAgewotICAgICAgICByYyA9IHhlbmV2dGNobl9j
bG9zZSh4ZW5hY2Nlc3MtPnZtX2V2ZW50LnhjZV9oYW5kbGUpOwotICAgICAgICBpZiAoIHJjICE9
IDAgKQotICAgICAgICB7Ci0gICAgICAgICAgICBFUlJPUigiRXJyb3IgY2xvc2luZyBldmVudCBj
aGFubmVsIik7Ci0gICAgICAgICAgICByZXR1cm4gcmM7Ci0gICAgICAgIH0KKyAgICAgICAgRVJS
T1IoIkVycm9yIGNsb3NpbmcgZXZlbnQgY2hhbm5lbCIpOworICAgICAgICByZXR1cm4gcmM7CiAg
ICAgfQogCiAgICAgLyogQ2xvc2UgY29ubmVjdGlvbiB0byBYZW4gKi8KLSAgICByYyA9IHhjX2lu
dGVyZmFjZV9jbG9zZSh4ZW5hY2Nlc3MtPnhjX2hhbmRsZSk7CisgICAgcmMgPSB4Y19pbnRlcmZh
Y2VfY2xvc2Uodm1fZXZlbnQtPnhjaCk7CiAgICAgaWYgKCByYyAhPSAwICkKICAgICB7CiAgICAg
ICAgIEVSUk9SKCJFcnJvciBjbG9zaW5nIGNvbm5lY3Rpb24gdG8geGVuIik7CiAgICAgICAgIHJl
dHVybiByYzsKICAgICB9Ci0gICAgeGVuYWNjZXNzLT54Y19oYW5kbGUgPSBOVUxMOwotCi0gICAg
ZnJlZSh4ZW5hY2Nlc3MpOwogCiAgICAgcmV0dXJuIDA7CiB9CiAKLXhlbmFjY2Vzc190ICp4ZW5h
Y2Nlc3NfaW5pdCh4Y19pbnRlcmZhY2UgKip4Y2hfciwgZG9taWRfdCBkb21haW5faWQpCitzdGF0
aWMgdm1fZXZlbnRfdCAqdm1fZXZlbnRfaW5pdChkb21pZF90IGRvbWFpbl9pZCwgdm1fZXZlbnRf
b3BzX3QgKm9wcykKIHsKLSAgICB4ZW5hY2Nlc3NfdCAqeGVuYWNjZXNzID0gMDsKKyAgICB2bV9l
dmVudF90ICp2bV9ldmVudDsKICAgICB4Y19pbnRlcmZhY2UgKnhjaDsKKyAgICB4ZW5ldnRjaG5f
aGFuZGxlICp4Y2U7CisgICAgeGVuX3Bmbl90IG1heF9ncGZuOwogICAgIGludCByYzsKIAorICAg
IGlmICggb3BzID09IE5VTEwgKQorICAgICAgICByZXR1cm4gTlVMTDsKKwogICAgIHhjaCA9IHhj
X2ludGVyZmFjZV9vcGVuKE5VTEwsIE5VTEwsIDApOwogICAgIGlmICggeGNoID09IE5VTEwgKQot
ICAgICAgICBnb3RvIGVycl9pZmFjZTsKKyAgICAgICAgZ290byBlcnI7CiAKICAgICBEUFJJTlRG
KCJ4ZW5hY2Nlc3MgaW5pdFxuIik7Ci0gICAgKnhjaF9yID0geGNoOwotCi0gICAgLyogQWxsb2Nh
dGUgbWVtb3J5ICovCi0gICAgeGVuYWNjZXNzID0gbWFsbG9jKHNpemVvZih4ZW5hY2Nlc3NfdCkp
OwotICAgIG1lbXNldCh4ZW5hY2Nlc3MsIDAsIHNpemVvZih4ZW5hY2Nlc3NfdCkpOwotCi0gICAg
LyogT3BlbiBjb25uZWN0aW9uIHRvIHhlbiAqLwotICAgIHhlbmFjY2Vzcy0+eGNfaGFuZGxlID0g
eGNoOwotCi0gICAgLyogU2V0IGRvbWFpbiBpZCAqLwotICAgIHhlbmFjY2Vzcy0+dm1fZXZlbnQu
ZG9tYWluX2lkID0gZG9tYWluX2lkOwotCi0gICAgLyogRW5hYmxlIG1lbV9hY2Nlc3MgKi8KLSAg
ICB4ZW5hY2Nlc3MtPnZtX2V2ZW50LnJpbmdfcGFnZSA9Ci0gICAgICAgICAgICB4Y19tb25pdG9y
X2VuYWJsZSh4ZW5hY2Nlc3MtPnhjX2hhbmRsZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHhlbmFjY2Vzcy0+dm1fZXZlbnQuZG9tYWluX2lkLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJnhlbmFjY2Vzcy0+dm1fZXZlbnQuZXZ0Y2huX3BvcnQpOwotICAgIGlmICggeGVu
YWNjZXNzLT52bV9ldmVudC5yaW5nX3BhZ2UgPT0gTlVMTCApCi0gICAgewotICAgICAgICBzd2l0
Y2ggKCBlcnJubyApCi0gICAgICAgIHsKLSAgICAgICAgY2FzZSBFQlVTWToKLSAgICAgICAgICAg
IEVSUk9SKCJ4ZW5hY2Nlc3MgaXMgKG9yIHdhcykgYWN0aXZlIG9uIHRoaXMgZG9tYWluIik7Ci0g
ICAgICAgICAgICBicmVhazsKLSAgICAgICAgY2FzZSBFTk9ERVY6Ci0gICAgICAgICAgICBFUlJP
UigiRVBUIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgZ3Vlc3QiKTsKLSAgICAgICAgICAgIGJyZWFr
OwotICAgICAgICBkZWZhdWx0OgotICAgICAgICAgICAgcGVycm9yKCJFcnJvciBlbmFibGluZyBt
ZW1fYWNjZXNzIik7Ci0gICAgICAgICAgICBicmVhazsKLSAgICAgICAgfQotICAgICAgICBnb3Rv
IGVycjsKLSAgICB9Ci0gICAgbWVtX2FjY2Vzc19lbmFibGUgPSAxOwogCiAgICAgLyogT3BlbiBl
dmVudCBjaGFubmVsICovCi0gICAgeGVuYWNjZXNzLT52bV9ldmVudC54Y2VfaGFuZGxlID0geGVu
ZXZ0Y2huX29wZW4oTlVMTCwgMCk7Ci0gICAgaWYgKCB4ZW5hY2Nlc3MtPnZtX2V2ZW50LnhjZV9o
YW5kbGUgPT0gTlVMTCApCisgICAgeGNlID0geGVuZXZ0Y2huX29wZW4oTlVMTCwgMCk7CisgICAg
aWYgKCB4Y2UgPT0gTlVMTCApCiAgICAgewogICAgICAgICBFUlJPUigiRmFpbGVkIHRvIG9wZW4g
ZXZlbnQgY2hhbm5lbCIpOwogICAgICAgICBnb3RvIGVycjsKICAgICB9Ci0gICAgZXZ0Y2huX29w
ZW4gPSAxOwotCi0gICAgLyogQmluZCBldmVudCBub3RpZmljYXRpb24gKi8KLSAgICByYyA9IHhl
bmV2dGNobl9iaW5kX2ludGVyZG9tYWluKHhlbmFjY2Vzcy0+dm1fZXZlbnQueGNlX2hhbmRsZSwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhlbmFjY2Vzcy0+dm1fZXZlbnQu
ZG9tYWluX2lkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVuYWNjZXNz
LT52bV9ldmVudC5ldnRjaG5fcG9ydCk7Ci0gICAgaWYgKCByYyA8IDAgKQotICAgIHsKLSAgICAg
ICAgRVJST1IoIkZhaWxlZCB0byBiaW5kIGV2ZW50IGNoYW5uZWwiKTsKLSAgICAgICAgZ290byBl
cnI7Ci0gICAgfQotICAgIGV2dGNobl9iaW5kID0gMTsKLSAgICB4ZW5hY2Nlc3MtPnZtX2V2ZW50
LnBvcnQgPSByYzsKLQotICAgIC8qIEluaXRpYWxpc2UgcmluZyAqLwotICAgIFNIQVJFRF9SSU5H
X0lOSVQoKHZtX2V2ZW50X3NyaW5nX3QgKil4ZW5hY2Nlc3MtPnZtX2V2ZW50LnJpbmdfcGFnZSk7
Ci0gICAgQkFDS19SSU5HX0lOSVQoJnhlbmFjY2Vzcy0+dm1fZXZlbnQuYmFja19yaW5nLAotICAg
ICAgICAgICAgICAgICAgICh2bV9ldmVudF9zcmluZ190ICopeGVuYWNjZXNzLT52bV9ldmVudC5y
aW5nX3BhZ2UsCi0gICAgICAgICAgICAgICAgICAgWENfUEFHRV9TSVpFKTsKIAogICAgIC8qIEdl
dCBtYXhfZ3BmbiAqLwotICAgIHJjID0geGNfZG9tYWluX21heGltdW1fZ3Bmbih4ZW5hY2Nlc3Mt
PnhjX2hhbmRsZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVuYWNjZXNzLT52
bV9ldmVudC5kb21haW5faWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZ4ZW5h
Y2Nlc3MtPm1heF9ncGZuKTsKLQorICAgIHJjID0geGNfZG9tYWluX21heGltdW1fZ3Bmbih4Y2gs
IGRvbWFpbl9pZCwgJm1heF9ncGZuKTsKICAgICBpZiAoIHJjICkKICAgICB7CiAgICAgICAgIEVS
Uk9SKCJGYWlsZWQgdG8gZ2V0IG1heCBncGZuIik7CiAgICAgICAgIGdvdG8gZXJyOwogICAgIH0K
KyAgICBEUFJJTlRGKCJtYXhfZ3BmbiA9ICUiUFJJX3hlbl9wZm4iXG4iLCBtYXhfZ3Bmbik7CiAK
LSAgICBEUFJJTlRGKCJtYXhfZ3BmbiA9ICUiUFJJX3hlbl9wZm4iXG4iLCB4ZW5hY2Nlc3MtPm1h
eF9ncGZuKTsKKyAgICByYyA9IG9wcy0+aW5pdCh4Y2gsIHhjZSwgZG9tYWluX2lkLCBvcHMsICZ2
bV9ldmVudCk7CisgICAgaWYgKCByYyA8IDAgKQorICAgICAgICBnb3RvIGVycjsKIAotICAgIHJl
dHVybiB4ZW5hY2Nlc3M7CisgICAgdm1fZXZlbnQtPnhjaCA9IHhjaDsKKyAgICB2bV9ldmVudC0+
eGNlID0geGNlOworICAgIHZtX2V2ZW50LT5kb21haW5faWQgPSBkb21haW5faWQ7CisgICAgdm1f
ZXZlbnQtPm9wcyA9IG9wczsKKyAgICB2bV9ldmVudC0+bWF4X2dwZm4gPSBtYXhfZ3BmbjsKIAot
IGVycjoKLSAgICByYyA9IHhlbmFjY2Vzc190ZWFyZG93bih4Y2gsIHhlbmFjY2Vzcyk7Ci0gICAg
aWYgKCByYyApCi0gICAgewotICAgICAgICBFUlJPUigiRmFpbGVkIHRvIHRlYXJkb3duIHhlbmFj
Y2VzcyBzdHJ1Y3R1cmUhXG4iKTsKLSAgICB9CisgICAgcmV0dXJuIHZtX2V2ZW50OwogCi0gZXJy
X2lmYWNlOgorIGVycjoKKyAgICB4ZW5ldnRjaG5fY2xvc2UoeGNlKTsKKyAgICB4Y19pbnRlcmZh
Y2VfY2xvc2UoeGNoKTsKIAogICAgIHJldHVybiBOVUxMOwogfQpAQCAtMjk4LDI2ICsxOTcsNiBA
QCBzdGF0aWMgaW5saW5lIGludCBjb250cm9sX3NpbmdsZXN0ZXAoeGNfaW50ZXJmYWNlICp4Y2gs
IGRvbWlkX3QgZG9tYWluX2lkLAogfQogCiAvKgotICogTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24g
aXMgbm90IHRocmVhZCBzYWZlLgotICovCi1zdGF0aWMgdm9pZCBnZXRfcmVxdWVzdCh2bV9ldmVu
dF90ICp2bV9ldmVudCwgdm1fZXZlbnRfcmVxdWVzdF90ICpyZXEpCi17Ci0gICAgdm1fZXZlbnRf
YmFja19yaW5nX3QgKmJhY2tfcmluZzsKLSAgICBSSU5HX0lEWCByZXFfY29uczsKLQotICAgIGJh
Y2tfcmluZyA9ICZ2bV9ldmVudC0+YmFja19yaW5nOwotICAgIHJlcV9jb25zID0gYmFja19yaW5n
LT5yZXFfY29uczsKLQotICAgIC8qIENvcHkgcmVxdWVzdCAqLwotICAgIG1lbWNweShyZXEsIFJJ
TkdfR0VUX1JFUVVFU1QoYmFja19yaW5nLCByZXFfY29ucyksIHNpemVvZigqcmVxKSk7Ci0gICAg
cmVxX2NvbnMrKzsKLQotICAgIC8qIFVwZGF0ZSByaW5nICovCi0gICAgYmFja19yaW5nLT5yZXFf
Y29ucyA9IHJlcV9jb25zOwotICAgIGJhY2tfcmluZy0+c3JpbmctPnJlcV9ldmVudCA9IHJlcV9j
b25zICsgMTsKLX0KLQotLyoKICAqIFg4NiBjb250cm9sIHJlZ2lzdGVyIG5hbWVzCiAgKi8KIHN0
YXRpYyBjb25zdCBjaGFyKiBnZXRfeDg2X2N0cmxfcmVnX25hbWUodWludDMyX3QgaW5kZXgpCkBA
IC0zMzUsMjkgKzIxNCw5IEBAIHN0YXRpYyBjb25zdCBjaGFyKiBnZXRfeDg2X2N0cmxfcmVnX25h
bWUodWludDMyX3QgaW5kZXgpCiAgICAgcmV0dXJuIG5hbWVzW2luZGV4XTsKIH0KIAotLyoKLSAq
IE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGlzIG5vdCB0aHJlYWQgc2FmZS4KLSAqLwotc3RhdGlj
IHZvaWQgcHV0X3Jlc3BvbnNlKHZtX2V2ZW50X3QgKnZtX2V2ZW50LCB2bV9ldmVudF9yZXNwb25z
ZV90ICpyc3ApCi17Ci0gICAgdm1fZXZlbnRfYmFja19yaW5nX3QgKmJhY2tfcmluZzsKLSAgICBS
SU5HX0lEWCByc3BfcHJvZDsKLQotICAgIGJhY2tfcmluZyA9ICZ2bV9ldmVudC0+YmFja19yaW5n
OwotICAgIHJzcF9wcm9kID0gYmFja19yaW5nLT5yc3BfcHJvZF9wdnQ7Ci0KLSAgICAvKiBDb3B5
IHJlc3BvbnNlICovCi0gICAgbWVtY3B5KFJJTkdfR0VUX1JFU1BPTlNFKGJhY2tfcmluZywgcnNw
X3Byb2QpLCByc3AsIHNpemVvZigqcnNwKSk7Ci0gICAgcnNwX3Byb2QrKzsKLQotICAgIC8qIFVw
ZGF0ZSByaW5nICovCi0gICAgYmFja19yaW5nLT5yc3BfcHJvZF9wdnQgPSByc3BfcHJvZDsKLSAg
ICBSSU5HX1BVU0hfUkVTUE9OU0VTKGJhY2tfcmluZyk7Ci19Ci0KIHZvaWQgdXNhZ2UoY2hhciog
cHJvZ25hbWUpCiB7Ci0gICAgZnByaW50ZihzdGRlcnIsICJVc2FnZTogJXMgWy1tXSA8ZG9tYWlu
X2lkPiB3cml0ZXxleGVjIiwgcHJvZ25hbWUpOworICAgIGZwcmludGYoc3RkZXJyLCAiVXNhZ2U6
ICVzIFstbV0gWy1uXSA8ZG9tYWluX2lkPiB3cml0ZXxleGVjIiwgcHJvZ25hbWUpOwogI2lmIGRl
ZmluZWQoX19pMzg2X18pIHx8IGRlZmluZWQoX194ODZfNjRfXykKICAgICBmcHJpbnRmKHN0ZGVy
ciwgInxicmVha3BvaW50fGFsdHAybV93cml0ZXxhbHRwMm1fZXhlY3xkZWJ1Z3xjcHVpZHxkZXNj
X2FjY2Vzc3x3cml0ZV9jdHJscmVnX2NyNHxhbHRwMm1fd3JpdGVfbm9fZ3B0Iik7CiAjZWxpZiBk
ZWZpbmVkKF9fYXJtX18pIHx8IGRlZmluZWQoX19hYXJjaDY0X18pCkBAIC0zNjcsMTkgKzIyNiwy
MiBAQCB2b2lkIHVzYWdlKGNoYXIqIHByb2duYW1lKQogICAgICAgICAgICAgIlxuIgogICAgICAg
ICAgICAgIkxvZ3MgZmlyc3QgcGFnZSB3cml0ZXMsIGV4ZWNzLCBvciBicmVha3BvaW50IHRyYXBz
IHRoYXQgb2NjdXIgb24gdGhlIGRvbWFpbi5cbiIKICAgICAgICAgICAgICJcbiIKLSAgICAgICAg
ICAgICItbSByZXF1aXJlcyB0aGlzIHByb2dyYW0gdG8gcnVuLCBvciBlbHNlIHRoZSBkb21haW4g
bWF5IHBhdXNlXG4iKTsKKyAgICAgICAgICAgICItbSByZXF1aXJlcyB0aGlzIHByb2dyYW0gdG8g
cnVuLCBvciBlbHNlIHRoZSBkb21haW4gbWF5IHBhdXNlXG4iCisgICAgICAgICAgICAiLW4gdXNl
cyB0aGUgcGVyLXZjcHUgY2hhbm5lbHMgdm1fZXZlbnQgaW50ZXJmYWNlXG4iKTsKIH0KIAorZXh0
ZXJuIHZtX2V2ZW50X29wc190IHJpbmdfb3BzOworZXh0ZXJuIHZtX2V2ZW50X29wc190IGNoYW5u
ZWxfb3BzOworCiBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogewogICAgIHN0cnVj
dCBzaWdhY3Rpb24gYWN0OwogICAgIGRvbWlkX3QgZG9tYWluX2lkOwotICAgIHhlbmFjY2Vzc190
ICp4ZW5hY2Nlc3M7CisgICAgdm1fZXZlbnRfdCAqdm1fZXZlbnQ7CiAgICAgdm1fZXZlbnRfcmVx
dWVzdF90IHJlcTsKICAgICB2bV9ldmVudF9yZXNwb25zZV90IHJzcDsKICAgICBpbnQgcmMgPSAt
MTsKICAgICBpbnQgcmMxOwotICAgIHhjX2ludGVyZmFjZSAqeGNoOwogICAgIHhlbm1lbV9hY2Nl
c3NfdCBkZWZhdWx0X2FjY2VzcyA9IFhFTk1FTV9hY2Nlc3Nfcnd4OwogICAgIHhlbm1lbV9hY2Nl
c3NfdCBhZnRlcl9maXJzdF9hY2Nlc3MgPSBYRU5NRU1fYWNjZXNzX3J3eDsKICAgICBpbnQgbWVt
YWNjZXNzID0gMDsKQEAgLTM5NCw2ICsyNTYsNyBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAq
YXJndltdKQogICAgIGludCB3cml0ZV9jdHJscmVnX2NyNCA9IDA7CiAgICAgaW50IGFsdHAybV93
cml0ZV9ub19ncHQgPSAwOwogICAgIHVpbnQxNl90IGFsdHAybV92aWV3X2lkID0gMDsKKyAgICBp
bnQgbmV3X2ludGVyZmFjZSA9IDA7CiAKICAgICBjaGFyKiBwcm9nbmFtZSA9IGFyZ3ZbMF07CiAg
ICAgY2hhciogY29tbWFuZDsKQEAgLTQwMiwxMSArMjY1LDEyIEBAIGludCBtYWluKGludCBhcmdj
LCBjaGFyICphcmd2W10pCiAgICAgc3RydWN0IG9wdGlvbiBsb25nX29wdGlvbnNbXSA9CiAgICAg
ewogICAgICAgICB7ICJtZW0tYWNjZXNzLWxpc3RlbmVyIiwgbm9fYXJndW1lbnQsIDAsICdtJyB9
LAorICAgICAgICB7ICJuZXctaW50ZXJmYWNlIiwgbm9fYXJndW1lbnQsIDAsICduJyB9LAogICAg
IH07CiAKICAgICB3aGlsZSAoIDEgKQogICAgIHsKLSAgICAgICAgYyA9IGdldG9wdF9sb25nKGFy
Z2MsIGFyZ3YsICJtIiwgbG9uZ19vcHRpb25zLCAmb3B0aW9uX2luZGV4KTsKKyAgICAgICAgYyA9
IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJtbiIsIGxvbmdfb3B0aW9ucywgJm9wdGlvbl9pbmRl
eCk7CiAgICAgICAgIGlmICggYyA9PSAtMSApCiAgICAgICAgICAgICBicmVhazsKIApAQCAtNDE2
LDYgKzI4MCwxMCBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAgICAgICAg
ICAgcmVxdWlyZWQgPSAxOwogICAgICAgICAgICAgYnJlYWs7CiAKKyAgICAgICAgY2FzZSAnbic6
CisgICAgICAgICAgICBuZXdfaW50ZXJmYWNlID0gMTsKKyAgICAgICAgICAgIGJyZWFrOworCiAg
ICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICB1c2FnZShwcm9nbmFtZSk7CiAgICAgICAgICAg
ICByZXR1cm4gLTE7CkBAIC00OTUsMTAgKzM2MywxMSBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hh
ciAqYXJndltdKQogICAgICAgICByZXR1cm4gLTE7CiAgICAgfQogCi0gICAgeGVuYWNjZXNzID0g
eGVuYWNjZXNzX2luaXQoJnhjaCwgZG9tYWluX2lkKTsKLSAgICBpZiAoIHhlbmFjY2VzcyA9PSBO
VUxMICkKKyAgICB2bV9ldmVudCA9IHZtX2V2ZW50X2luaXQoZG9tYWluX2lkLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAobmV3X2ludGVyZmFjZSkgPyAmY2hhbm5lbF9vcHMgOiAmcmlu
Z19vcHMpOworICAgIGlmICggdm1fZXZlbnQgPT0gTlVMTCApCiAgICAgewotICAgICAgICBFUlJP
UigiRXJyb3IgaW5pdGlhbGlzaW5nIHhlbmFjY2VzcyIpOworICAgICAgICBFUlJPUigiRXJyb3Ig
aW5pdGlhbGlzaW5nIHZtX2V2ZW50Iik7CiAgICAgICAgIHJldHVybiAxOwogICAgIH0KIApAQCAt
NTE0LDcgKzM4Myw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgc2ln
YWN0aW9uKFNJR0FMUk0sICZhY3QsIE5VTEwpOwogCiAgICAgLyogU2V0IHdoZXRoZXIgdGhlIGFj
Y2VzcyBsaXN0ZW5lciBpcyByZXF1aXJlZCAqLwotICAgIHJjID0geGNfZG9tYWluX3NldF9hY2Nl
c3NfcmVxdWlyZWQoeGNoLCBkb21haW5faWQsIHJlcXVpcmVkKTsKKyAgICByYyA9IHhjX2RvbWFp
bl9zZXRfYWNjZXNzX3JlcXVpcmVkKHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwgcmVxdWlyZWQp
OwogICAgIGlmICggcmMgPCAwICkKICAgICB7CiAgICAgICAgIEVSUk9SKCJFcnJvciAlZCBzZXR0
aW5nIG1lbV9hY2Nlc3MgbGlzdGVuZXIgcmVxdWlyZWRcbiIsIHJjKTsKQEAgLTUyOSwxMyArMzk4
LDEzIEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAKICAgICAgICAgaWYoIGFs
dHAybV93cml0ZV9ub19ncHQgKQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IHhjX21vbml0
b3JfaW5ndWVzdF9wYWdlZmF1bHQoeGNoLCBkb21haW5faWQsIDEpOworICAgICAgICAgICAgcmMg
PSB4Y19tb25pdG9yX2luZ3Vlc3RfcGFnZWZhdWx0KHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwg
MSk7CiAgICAgICAgICAgICBpZiAoIHJjIDwgMCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAg
ICAgICAgRVJST1IoIkVycm9yICVkIHNldHRpbmcgaW5ndWVzdCBwYWdlZmF1bHRcbiIsIHJjKTsK
ICAgICAgICAgICAgICAgICBnb3RvIGV4aXQ7CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBy
YyA9IHhjX21vbml0b3JfZW11bF91bmltcGxlbWVudGVkKHhjaCwgZG9tYWluX2lkLCAxKTsKKyAg
ICAgICAgICAgIHJjID0geGNfbW9uaXRvcl9lbXVsX3VuaW1wbGVtZW50ZWQodm1fZXZlbnQtPnhj
aCwgZG9tYWluX2lkLCAxKTsKICAgICAgICAgICAgIGlmICggcmMgPCAwICkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICBFUlJPUigiRXJyb3IgJWQgZmFpbGVkIHRvIGVuYWJsZSBlbXVs
IHVuaW1wbGVtZW50ZWRcbiIsIHJjKTsKQEAgLTU0MywxNCArNDEyLDE1IEBAIGludCBtYWluKGlu
dCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgICAgICAgICB9CiAgICAgICAgIH0KIAotICAgICAg
ICByYyA9IHhjX2FsdHAybV9zZXRfZG9tYWluX3N0YXRlKCB4Y2gsIGRvbWFpbl9pZCwgMSApOwor
ICAgICAgICByYyA9IHhjX2FsdHAybV9zZXRfZG9tYWluX3N0YXRlKCB2bV9ldmVudC0+eGNoLCBk
b21haW5faWQsIDEgKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBFUlJPUigiRXJyb3IgJWQgZW5hYmxpbmcgYWx0cDJtIG9uIGRvbWFpbiFcbiIsIHJjKTsK
ICAgICAgICAgICAgIGdvdG8gZXhpdDsKICAgICAgICAgfQogCi0gICAgICAgIHJjID0geGNfYWx0
cDJtX2NyZWF0ZV92aWV3KCB4Y2gsIGRvbWFpbl9pZCwgZGVmYXVsdF9hY2Nlc3MsICZhbHRwMm1f
dmlld19pZCApOworICAgICAgICByYyA9IHhjX2FsdHAybV9jcmVhdGVfdmlldyggdm1fZXZlbnQt
PnhjaCwgZG9tYWluX2lkLCBkZWZhdWx0X2FjY2VzcywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZhbHRwMm1fdmlld19pZCApOwogICAgICAgICBpZiAoIHJjIDwgMCApCiAg
ICAgICAgIHsKICAgICAgICAgICAgIEVSUk9SKCJFcnJvciAlZCBjcmVhdGluZyBhbHRwMm0gdmll
dyFcbiIsIHJjKTsKQEAgLTU2MCwyNCArNDMwLDI0IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFy
ICphcmd2W10pCiAgICAgICAgIERQUklOVEYoImFsdHAybSB2aWV3IGNyZWF0ZWQgd2l0aCBpZCAl
dVxuIiwgYWx0cDJtX3ZpZXdfaWQpOwogICAgICAgICBEUFJJTlRGKCJTZXR0aW5nIGFsdHAybSBt
ZW1fYWNjZXNzIHBlcm1pc3Npb25zLi4gIik7CiAKLSAgICAgICAgZm9yKCA7IGdmbiA8IHhlbmFj
Y2Vzcy0+bWF4X2dwZm47ICsrZ2ZuICkKKyAgICAgICAgZm9yKCA7IGdmbiA8IHZtX2V2ZW50LT5t
YXhfZ3BmbjsgKytnZm4gKQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IHhjX2FsdHAybV9z
ZXRfbWVtX2FjY2VzcyggeGNoLCBkb21haW5faWQsIGFsdHAybV92aWV3X2lkLCBnZm4sCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF9hY2Nlc3MpOwor
ICAgICAgICAgICAgcmMgPSB4Y19hbHRwMm1fc2V0X21lbV9hY2Nlc3MoIHZtX2V2ZW50LT54Y2gs
IGRvbWFpbl9pZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBh
bHRwMm1fdmlld19pZCwgZ2ZuLCBkZWZhdWx0X2FjY2Vzcyk7CiAgICAgICAgICAgICBpZiAoICFy
YyApCiAgICAgICAgICAgICAgICAgcGVybV9zZXQrKzsKICAgICAgICAgfQogCiAgICAgICAgIERQ
UklOVEYoImRvbmUhIFBlcm1pc3Npb25zIHNldCBvbiAlbHUgcGFnZXMuXG4iLCBwZXJtX3NldCk7
CiAKLSAgICAgICAgcmMgPSB4Y19hbHRwMm1fc3dpdGNoX3RvX3ZpZXcoIHhjaCwgZG9tYWluX2lk
LCBhbHRwMm1fdmlld19pZCApOworICAgICAgICByYyA9IHhjX2FsdHAybV9zd2l0Y2hfdG9fdmll
dyggdm1fZXZlbnQtPnhjaCwgZG9tYWluX2lkLCBhbHRwMm1fdmlld19pZCApOwogICAgICAgICBp
ZiAoIHJjIDwgMCApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9SKCJFcnJvciAlZCBzd2l0
Y2hpbmcgdG8gYWx0cDJtIHZpZXchXG4iLCByYyk7CiAgICAgICAgICAgICBnb3RvIGV4aXQ7CiAg
ICAgICAgIH0KIAotICAgICAgICByYyA9IHhjX21vbml0b3Jfc2luZ2xlc3RlcCggeGNoLCBkb21h
aW5faWQsIDEgKTsKKyAgICAgICAgcmMgPSB4Y19tb25pdG9yX3NpbmdsZXN0ZXAoIHZtX2V2ZW50
LT54Y2gsIGRvbWFpbl9pZCwgMSApOwogICAgICAgICBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIEVSUk9SKCJFcnJvciAlZCBmYWlsZWQgdG8gZW5hYmxlIHNpbmdsZXN0ZXAg
bW9uaXRvcmluZyFcbiIsIHJjKTsKQEAgLTU4OCwxNSArNDU4LDE1IEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAgICAgaWYgKCBtZW1hY2Nlc3MgJiYgIWFsdHAybSApCiAgICAg
ewogICAgICAgICAvKiBTZXQgdGhlIGRlZmF1bHQgYWNjZXNzIHR5cGUgYW5kIGNvbnZlcnQgYWxs
IHBhZ2VzIHRvIGl0ICovCi0gICAgICAgIHJjID0geGNfc2V0X21lbV9hY2Nlc3MoeGNoLCBkb21h
aW5faWQsIGRlZmF1bHRfYWNjZXNzLCB+MHVsbCwgMCk7CisgICAgICAgIHJjID0geGNfc2V0X21l
bV9hY2Nlc3Modm1fZXZlbnQtPnhjaCwgZG9tYWluX2lkLCBkZWZhdWx0X2FjY2VzcywgfjB1bGws
IDApOwogICAgICAgICBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9S
KCJFcnJvciAlZCBzZXR0aW5nIGRlZmF1bHQgbWVtIGFjY2VzcyB0eXBlXG4iLCByYyk7CiAgICAg
ICAgICAgICBnb3RvIGV4aXQ7CiAgICAgICAgIH0KIAotICAgICAgICByYyA9IHhjX3NldF9tZW1f
YWNjZXNzKHhjaCwgZG9tYWluX2lkLCBkZWZhdWx0X2FjY2VzcywgU1RBUlRfUEZOLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICh4ZW5hY2Nlc3MtPm1heF9ncGZuIC0gU1RBUlRfUEZO
KSApOworICAgICAgICByYyA9IHhjX3NldF9tZW1fYWNjZXNzKHZtX2V2ZW50LT54Y2gsIGRvbWFp
bl9pZCwgZGVmYXVsdF9hY2Nlc3MsIFNUQVJUX1BGTiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAodm1fZXZlbnQtPm1heF9ncGZuIC0gU1RBUlRfUEZOKSApOwogCiAgICAgICAgIGlm
ICggcmMgPCAwICkKICAgICAgICAgewpAQCAtNjA4LDcgKzQ3OCw3IEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAKICAgICBpZiAoIGJyZWFrcG9pbnQgKQogICAgIHsKLSAgICAg
ICAgcmMgPSB4Y19tb25pdG9yX3NvZnR3YXJlX2JyZWFrcG9pbnQoeGNoLCBkb21haW5faWQsIDEp
OworICAgICAgICByYyA9IHhjX21vbml0b3Jfc29mdHdhcmVfYnJlYWtwb2ludCh2bV9ldmVudC0+
eGNoLCBkb21haW5faWQsIDEpOwogICAgICAgICBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIEVSUk9SKCJFcnJvciAlZCBzZXR0aW5nIGJyZWFrcG9pbnQgdHJhcHBpbmcgd2l0
aCB2bV9ldmVudFxuIiwgcmMpOwpAQCAtNjE4LDcgKzQ4OCw3IEBAIGludCBtYWluKGludCBhcmdj
LCBjaGFyICphcmd2W10pCiAKICAgICBpZiAoIGRlYnVnICkKICAgICB7Ci0gICAgICAgIHJjID0g
eGNfbW9uaXRvcl9kZWJ1Z19leGNlcHRpb25zKHhjaCwgZG9tYWluX2lkLCAxLCAxKTsKKyAgICAg
ICAgcmMgPSB4Y19tb25pdG9yX2RlYnVnX2V4Y2VwdGlvbnModm1fZXZlbnQtPnhjaCwgZG9tYWlu
X2lkLCAxLCAxKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBFUlJPUigiRXJyb3IgJWQgc2V0dGluZyBkZWJ1ZyBleGNlcHRpb24gbGlzdGVuZXIgd2l0aCB2
bV9ldmVudFxuIiwgcmMpOwpAQCAtNjI4LDcgKzQ5OCw3IEBAIGludCBtYWluKGludCBhcmdjLCBj
aGFyICphcmd2W10pCiAKICAgICBpZiAoIGNwdWlkICkKICAgICB7Ci0gICAgICAgIHJjID0geGNf
bW9uaXRvcl9jcHVpZCh4Y2gsIGRvbWFpbl9pZCwgMSk7CisgICAgICAgIHJjID0geGNfbW9uaXRv
cl9jcHVpZCh2bV9ldmVudC0+eGNoLCBkb21haW5faWQsIDEpOwogICAgICAgICBpZiAoIHJjIDwg
MCApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9SKCJFcnJvciAlZCBzZXR0aW5nIGNwdWlk
IGxpc3RlbmVyIHdpdGggdm1fZXZlbnRcbiIsIHJjKTsKQEAgLTYzOCw3ICs1MDgsNyBAQCBpbnQg
bWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogCiAgICAgaWYgKCBkZXNjX2FjY2VzcyApCiAg
ICAgewotICAgICAgICByYyA9IHhjX21vbml0b3JfZGVzY3JpcHRvcl9hY2Nlc3MoeGNoLCBkb21h
aW5faWQsIDEpOworICAgICAgICByYyA9IHhjX21vbml0b3JfZGVzY3JpcHRvcl9hY2Nlc3Modm1f
ZXZlbnQtPnhjaCwgZG9tYWluX2lkLCAxKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBFUlJPUigiRXJyb3IgJWQgc2V0dGluZyBkZXNjcmlwdG9yIGFjY2Vz
cyBsaXN0ZW5lciB3aXRoIHZtX2V2ZW50XG4iLCByYyk7CkBAIC02NDgsNyArNTE4LDcgQEAgaW50
IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAogICAgIGlmICggcHJpdmNhbGwgKQogICAg
IHsKLSAgICAgICAgcmMgPSB4Y19tb25pdG9yX3ByaXZpbGVnZWRfY2FsbCh4Y2gsIGRvbWFpbl9p
ZCwgMSk7CisgICAgICAgIHJjID0geGNfbW9uaXRvcl9wcml2aWxlZ2VkX2NhbGwodm1fZXZlbnQt
PnhjaCwgZG9tYWluX2lkLCAxKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBFUlJPUigiRXJyb3IgJWQgc2V0dGluZyBwcml2aWxlZ2VkIGNhbGwgdHJhcHBp
bmcgd2l0aCB2bV9ldmVudFxuIiwgcmMpOwpAQCAtNjU5LDcgKzUyOSw3IEBAIGludCBtYWluKGlu
dCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgaWYgKCB3cml0ZV9jdHJscmVnX2NyNCApCiAgICAg
ewogICAgICAgICAvKiBNYXNrIHRoZSBDUjQuUEdFIGJpdCBzbyBubyBldmVudHMgd2lsbCBiZSBn
ZW5lcmF0ZWQgZm9yIGdsb2JhbCBUTEIgZmx1c2hlcy4gKi8KLSAgICAgICAgcmMgPSB4Y19tb25p
dG9yX3dyaXRlX2N0cmxyZWcoeGNoLCBkb21haW5faWQsIFZNX0VWRU5UX1g4Nl9DUjQsIDEsIDEs
CisgICAgICAgIHJjID0geGNfbW9uaXRvcl93cml0ZV9jdHJscmVnKHZtX2V2ZW50LT54Y2gsIGRv
bWFpbl9pZCwgVk1fRVZFTlRfWDg2X0NSNCwgMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgWDg2X0NSNF9QR0UsIDEpOwogICAgICAgICBpZiAoIHJjIDwgMCApCiAg
ICAgICAgIHsKQEAgLTY3MSw0MSArNTQxLDQzIEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICph
cmd2W10pCiAgICAgLyogV2FpdCBmb3IgYWNjZXNzICovCiAgICAgZm9yICggOyA7ICkKICAgICB7
CisgICAgICAgIGludCBwb3J0ID0gMDsKKwogICAgICAgICBpZiAoIGludGVycnVwdGVkICkKICAg
ICAgICAgewogICAgICAgICAgICAgLyogVW5yZWdpc3RlciBmb3IgZXZlcnkgZXZlbnQgKi8KICAg
ICAgICAgICAgIERQUklOVEYoInhlbmFjY2VzcyBzaHV0dGluZyBkb3duIG9uIHNpZ25hbCAlZFxu
IiwgaW50ZXJydXB0ZWQpOwogCiAgICAgICAgICAgICBpZiAoIGJyZWFrcG9pbnQgKQotICAgICAg
ICAgICAgICAgIHJjID0geGNfbW9uaXRvcl9zb2Z0d2FyZV9icmVha3BvaW50KHhjaCwgZG9tYWlu
X2lkLCAwKTsKKyAgICAgICAgICAgICAgICByYyA9IHhjX21vbml0b3Jfc29mdHdhcmVfYnJlYWtw
b2ludCh2bV9ldmVudC0+eGNoLCBkb21haW5faWQsIDApOwogICAgICAgICAgICAgaWYgKCBkZWJ1
ZyApCi0gICAgICAgICAgICAgICAgcmMgPSB4Y19tb25pdG9yX2RlYnVnX2V4Y2VwdGlvbnMoeGNo
LCBkb21haW5faWQsIDAsIDApOworICAgICAgICAgICAgICAgIHJjID0geGNfbW9uaXRvcl9kZWJ1
Z19leGNlcHRpb25zKHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwgMCwgMCk7CiAgICAgICAgICAg
ICBpZiAoIGNwdWlkICkKLSAgICAgICAgICAgICAgICByYyA9IHhjX21vbml0b3JfY3B1aWQoeGNo
LCBkb21haW5faWQsIDApOworICAgICAgICAgICAgICAgIHJjID0geGNfbW9uaXRvcl9jcHVpZCh2
bV9ldmVudC0+eGNoLCBkb21haW5faWQsIDApOwogICAgICAgICAgICAgaWYgKCBkZXNjX2FjY2Vz
cyApCi0gICAgICAgICAgICAgICAgcmMgPSB4Y19tb25pdG9yX2Rlc2NyaXB0b3JfYWNjZXNzKHhj
aCwgZG9tYWluX2lkLCAwKTsKKyAgICAgICAgICAgICAgICByYyA9IHhjX21vbml0b3JfZGVzY3Jp
cHRvcl9hY2Nlc3Modm1fZXZlbnQtPnhjaCwgZG9tYWluX2lkLCAwKTsKICAgICAgICAgICAgIGlm
ICggd3JpdGVfY3RybHJlZ19jcjQgKQotICAgICAgICAgICAgICAgIHJjID0geGNfbW9uaXRvcl93
cml0ZV9jdHJscmVnKHhjaCwgZG9tYWluX2lkLCBWTV9FVkVOVF9YODZfQ1I0LCAwLCAwLCAwLCAw
KTsKKyAgICAgICAgICAgICAgICByYyA9IHhjX21vbml0b3Jfd3JpdGVfY3RybHJlZyh2bV9ldmVu
dC0+eGNoLCBkb21haW5faWQsIFZNX0VWRU5UX1g4Nl9DUjQsIDAsIDAsIDAsIDApOwogCiAgICAg
ICAgICAgICBpZiAoIHByaXZjYWxsICkKLSAgICAgICAgICAgICAgICByYyA9IHhjX21vbml0b3Jf
cHJpdmlsZWdlZF9jYWxsKHhjaCwgZG9tYWluX2lkLCAwKTsKKyAgICAgICAgICAgICAgICByYyA9
IHhjX21vbml0b3JfcHJpdmlsZWdlZF9jYWxsKHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwgMCk7
CiAKICAgICAgICAgICAgIGlmICggYWx0cDJtICkKICAgICAgICAgICAgIHsKLSAgICAgICAgICAg
ICAgICByYyA9IHhjX2FsdHAybV9zd2l0Y2hfdG9fdmlldyggeGNoLCBkb21haW5faWQsIDAgKTsK
LSAgICAgICAgICAgICAgICByYyA9IHhjX2FsdHAybV9kZXN0cm95X3ZpZXcoeGNoLCBkb21haW5f
aWQsIGFsdHAybV92aWV3X2lkKTsKLSAgICAgICAgICAgICAgICByYyA9IHhjX2FsdHAybV9zZXRf
ZG9tYWluX3N0YXRlKHhjaCwgZG9tYWluX2lkLCAwKTsKLSAgICAgICAgICAgICAgICByYyA9IHhj
X21vbml0b3Jfc2luZ2xlc3RlcCh4Y2gsIGRvbWFpbl9pZCwgMCk7CisgICAgICAgICAgICAgICAg
cmMgPSB4Y19hbHRwMm1fc3dpdGNoX3RvX3ZpZXcoIHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwg
MCApOworICAgICAgICAgICAgICAgIHJjID0geGNfYWx0cDJtX2Rlc3Ryb3lfdmlldyh2bV9ldmVu
dC0+eGNoLCBkb21haW5faWQsIGFsdHAybV92aWV3X2lkKTsKKyAgICAgICAgICAgICAgICByYyA9
IHhjX2FsdHAybV9zZXRfZG9tYWluX3N0YXRlKHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwgMCk7
CisgICAgICAgICAgICAgICAgcmMgPSB4Y19tb25pdG9yX3NpbmdsZXN0ZXAodm1fZXZlbnQtPnhj
aCwgZG9tYWluX2lkLCAwKTsKICAgICAgICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICAgICAg
cmMgPSB4Y19zZXRfbWVtX2FjY2Vzcyh4Y2gsIGRvbWFpbl9pZCwgWEVOTUVNX2FjY2Vzc19yd3gs
IH4wdWxsLCAwKTsKLSAgICAgICAgICAgICAgICByYyA9IHhjX3NldF9tZW1fYWNjZXNzKHhjaCwg
ZG9tYWluX2lkLCBYRU5NRU1fYWNjZXNzX3J3eCwgU1RBUlRfUEZOLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKHhlbmFjY2Vzcy0+bWF4X2dwZm4gLSBTVEFSVF9QRk4p
ICk7CisgICAgICAgICAgICAgICAgcmMgPSB4Y19zZXRfbWVtX2FjY2Vzcyh2bV9ldmVudC0+eGNo
LCBkb21haW5faWQsIFhFTk1FTV9hY2Nlc3Nfcnd4LCB+MHVsbCwgMCk7CisgICAgICAgICAgICAg
ICAgcmMgPSB4Y19zZXRfbWVtX2FjY2Vzcyh2bV9ldmVudC0+eGNoLCBkb21haW5faWQsIFhFTk1F
TV9hY2Nlc3Nfcnd4LCBTVEFSVF9QRk4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAodm1fZXZlbnQtPm1heF9ncGZuIC0gU1RBUlRfUEZOKSApOwogICAgICAgICAgICAg
fQogCiAgICAgICAgICAgICBzaHV0dGluZ19kb3duID0gMTsKICAgICAgICAgfQogCi0gICAgICAg
IHJjID0geGNfd2FpdF9mb3JfZXZlbnRfb3JfdGltZW91dCh4Y2gsIHhlbmFjY2Vzcy0+dm1fZXZl
bnQueGNlX2hhbmRsZSwgMTAwKTsKKyAgICAgICAgcmMgPSB4Y193YWl0X2Zvcl9ldmVudF9vcl90
aW1lb3V0KHZtX2V2ZW50LT54Y2gsIHZtX2V2ZW50LT54Y2UsIDEwMCk7CiAgICAgICAgIGlmICgg
cmMgPCAtMSApCiAgICAgICAgIHsKICAgICAgICAgICAgIEVSUk9SKCJFcnJvciBnZXR0aW5nIGV2
ZW50Iik7CkBAIC03MTcsMTAgKzU4OSwxMCBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJn
dltdKQogICAgICAgICAgICAgRFBSSU5URigiR290IGV2ZW50IGZyb20gWGVuXG4iKTsKICAgICAg
ICAgfQogCi0gICAgICAgIHdoaWxlICggUklOR19IQVNfVU5DT05TVU1FRF9SRVFVRVNUUygmeGVu
YWNjZXNzLT52bV9ldmVudC5iYWNrX3JpbmcpICkKLSAgICAgICAgewotICAgICAgICAgICAgZ2V0
X3JlcXVlc3QoJnhlbmFjY2Vzcy0+dm1fZXZlbnQsICZyZXEpOworICAgICAgICBwb3J0ID0gcmM7
CiAKKyAgICAgICAgd2hpbGUgKCB2bV9ldmVudC0+b3BzLT5nZXRfcmVxdWVzdCh2bV9ldmVudCwg
JnJlcSwgJnBvcnQpICkKKyAgICAgICAgewogICAgICAgICAgICAgaWYgKCByZXEudmVyc2lvbiAh
PSBWTV9FVkVOVF9JTlRFUkZBQ0VfVkVSU0lPTiApCiAgICAgICAgICAgICB7CiAgICAgICAgICAg
ICAgICAgRVJST1IoIkVycm9yOiB2bV9ldmVudCBpbnRlcmZhY2UgdmVyc2lvbiBtaXNtYXRjaCFc
biIpOwpAQCAtNzQ0LDcgKzYxNiw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10p
CiAgICAgICAgICAgICAgICAgICAgICAqIEF0IHNodXRkb3duIHdlIGhhdmUgYWxyZWFkeSByZXNl
dCBhbGwgdGhlIHBlcm1pc3Npb25zIHNvIHJlYWxseSBubyB1c2UgZ2V0dGluZyBpdCBhZ2Fpbi4K
ICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgIHhlbm1lbV9hY2Nl
c3NfdCBhY2Nlc3M7Ci0gICAgICAgICAgICAgICAgICAgIHJjID0geGNfZ2V0X21lbV9hY2Nlc3Mo
eGNoLCBkb21haW5faWQsIHJlcS51Lm1lbV9hY2Nlc3MuZ2ZuLCAmYWNjZXNzKTsKKyAgICAgICAg
ICAgICAgICAgICAgcmMgPSB4Y19nZXRfbWVtX2FjY2Vzcyh2bV9ldmVudC0+eGNoLCBkb21haW5f
aWQsIHJlcS51Lm1lbV9hY2Nlc3MuZ2ZuLCAmYWNjZXNzKTsKICAgICAgICAgICAgICAgICAgICAg
aWYgKHJjIDwgMCkKICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAg
ICAgRVJST1IoIkVycm9yICVkIGdldHRpbmcgbWVtX2FjY2VzcyBldmVudFxuIiwgcmMpOwpAQCAt
Nzc3LDcgKzY0OSw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICAgICAgIGVsc2UgaWYgKCBkZWZhdWx0X2FjY2VzcyAhPSBh
ZnRlcl9maXJzdF9hY2Nlc3MgKQogICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAg
ICAgcmMgPSB4Y19zZXRfbWVtX2FjY2Vzcyh4Y2gsIGRvbWFpbl9pZCwgYWZ0ZXJfZmlyc3RfYWNj
ZXNzLAorICAgICAgICAgICAgICAgICAgICByYyA9IHhjX3NldF9tZW1fYWNjZXNzKHZtX2V2ZW50
LT54Y2gsIGRvbWFpbl9pZCwgYWZ0ZXJfZmlyc3RfYWNjZXNzLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS51Lm1lbV9hY2Nlc3MuZ2ZuLCAxKTsKICAgICAg
ICAgICAgICAgICAgICAgaWYgKHJjIDwgMCkKICAgICAgICAgICAgICAgICAgICAgewpAQCAtNzk4
LDcgKzY3MCw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgICAgICAg
ICAgICAgICAgICAgIHJlcS52Y3B1X2lkKTsKIAogICAgICAgICAgICAgICAgIC8qIFJlaW5qZWN0
ICovCi0gICAgICAgICAgICAgICAgcmMgPSB4Y19odm1faW5qZWN0X3RyYXAoeGNoLCBkb21haW5f
aWQsIHJlcS52Y3B1X2lkLAorICAgICAgICAgICAgICAgIHJjID0geGNfaHZtX2luamVjdF90cmFw
KHZtX2V2ZW50LT54Y2gsIGRvbWFpbl9pZCwgcmVxLnZjcHVfaWQsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgWDg2X1RSQVBfSU5UMywKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICByZXEudS5zb2Z0d2FyZV9icmVha3BvaW50LnR5cGUsIC0x
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS51LnNvZnR3YXJl
X2JyZWFrcG9pbnQuaW5zbl9sZW5ndGgsIDApOwpAQCAtODQ2LDcgKzcxOCw3IEBAIGludCBtYWlu
KGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcS51LmRl
YnVnX2V4Y2VwdGlvbi5pbnNuX2xlbmd0aCk7CiAKICAgICAgICAgICAgICAgICAvKiBSZWluamVj
dCAqLwotICAgICAgICAgICAgICAgIHJjID0geGNfaHZtX2luamVjdF90cmFwKHhjaCwgZG9tYWlu
X2lkLCByZXEudmNwdV9pZCwKKyAgICAgICAgICAgICAgICByYyA9IHhjX2h2bV9pbmplY3RfdHJh
cCh2bV9ldmVudC0+eGNoLCBkb21haW5faWQsIHJlcS52Y3B1X2lkLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFg4Nl9UUkFQX0RFQlVHLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS51LmRlYnVnX2V4Y2VwdGlvbi50eXBlLCAtMSwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEudS5kZWJ1Z19leGNl
cHRpb24uaW5zbl9sZW5ndGgsCkBAIC05MTQsMTcgKzc4NiwxNSBAQCBpbnQgbWFpbihpbnQgYXJn
YywgY2hhciAqYXJndltdKQogICAgICAgICAgICAgfQogCiAgICAgICAgICAgICAvKiBQdXQgdGhl
IHJlc3BvbnNlIG9uIHRoZSByaW5nICovCi0gICAgICAgICAgICBwdXRfcmVzcG9uc2UoJnhlbmFj
Y2Vzcy0+dm1fZXZlbnQsICZyc3ApOwotICAgICAgICB9Ci0KLSAgICAgICAgLyogVGVsbCBYZW4g
cGFnZSBpcyByZWFkeSAqLwotICAgICAgICByYyA9IHhlbmV2dGNobl9ub3RpZnkoeGVuYWNjZXNz
LT52bV9ldmVudC54Y2VfaGFuZGxlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVu
YWNjZXNzLT52bV9ldmVudC5wb3J0KTsKKyAgICAgICAgICAgIHB1dF9yZXNwb25zZSh2bV9ldmVu
dCwgJnJzcCwgcG9ydCk7CiAKLSAgICAgICAgaWYgKCByYyAhPSAwICkKLSAgICAgICAgewotICAg
ICAgICAgICAgRVJST1IoIkVycm9yIHJlc3VtaW5nIHBhZ2UiKTsKLSAgICAgICAgICAgIGludGVy
cnVwdGVkID0gLTE7CisgICAgICAgICAgICAvKiBUZWxsIFhlbiBwYWdlIGlzIHJlYWR5ICovCisg
ICAgICAgICAgICByYyA9IG5vdGlmeV9wb3J0KHZtX2V2ZW50LCBwb3J0KTsKKyAgICAgICAgICAg
IGlmICggcmMgIT0gMCApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgRVJST1IoIkVy
cm9yIHJlc3VtaW5nIHBhZ2UiKTsKKyAgICAgICAgICAgICAgICBpbnRlcnJ1cHRlZCA9IC0xOwor
ICAgICAgICAgICAgfQogICAgICAgICB9CiAKICAgICAgICAgaWYgKCBzaHV0dGluZ19kb3duICkK
QEAgLTkzNywxMyArODA3LDEzIEBAIGV4aXQ6CiAgICAgewogICAgICAgICB1aW50MzJfdCB2Y3B1
X2lkOwogICAgICAgICBmb3IgKCB2Y3B1X2lkID0gMDsgdmNwdV9pZDxYRU5fTEVHQUNZX01BWF9W
Q1BVUzsgdmNwdV9pZCsrKQotICAgICAgICAgICAgcmMgPSBjb250cm9sX3NpbmdsZXN0ZXAoeGNo
LCBkb21haW5faWQsIHZjcHVfaWQsIDApOworICAgICAgICAgICAgcmMgPSBjb250cm9sX3Npbmds
ZXN0ZXAodm1fZXZlbnQtPnhjaCwgZG9tYWluX2lkLCB2Y3B1X2lkLCAwKTsKICAgICB9CiAKLSAg
ICAvKiBUZWFyIGRvd24gZG9tYWluIHhlbmFjY2VzcyAqLwotICAgIHJjMSA9IHhlbmFjY2Vzc190
ZWFyZG93bih4Y2gsIHhlbmFjY2Vzcyk7CisgICAgLyogVGVhciBkb3duIGRvbWFpbiAqLworICAg
IHJjMSA9IHZtX2V2ZW50X3RlYXJkb3duKHZtX2V2ZW50KTsKICAgICBpZiAoIHJjMSAhPSAwICkK
LSAgICAgICAgRVJST1IoIkVycm9yIHRlYXJpbmcgZG93biB4ZW5hY2Nlc3MiKTsKKyAgICAgICAg
RVJST1IoIkVycm9yIHRlYXJpbmcgZG93biB2bV9ldmVudCIpOwogCiAgICAgaWYgKCByYyA9PSAw
ICkKICAgICAgICAgcmMgPSByYzE7CmRpZmYgLS1naXQgYS90b29scy90ZXN0cy94ZW4tYWNjZXNz
L3hlbi1hY2Nlc3MuaCBiL3Rvb2xzL3Rlc3RzL3hlbi1hY2Nlc3MveGVuLWFjY2Vzcy5oCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjlmYzY0MGMKLS0tIC9kZXYvbnVsbAorKysg
Yi90b29scy90ZXN0cy94ZW4tYWNjZXNzL3hlbi1hY2Nlc3MuaApAQCAtMCwwICsxLDkxIEBACisv
KgorICogeGVuLWFjY2Vzcy5oCisgKgorICogQ29weXJpZ2h0IChjKSAyMDE5IEJpdGRlZmVuZGVy
IFMuUi5MLgorICoKKyAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hh
cmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKKyAqIG9mIHRoaXMgc29mdHdhcmUg
YW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0bwor
ICogZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdp
dGhvdXQgbGltaXRhdGlvbiB0aGUKKyAqIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVy
Z2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vcgorICogc2VsbCBjb3Bp
ZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29m
dHdhcmUgaXMKKyAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5n
IGNvbmRpdGlvbnM6CisgKgorICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMg
cGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KKyAqIGFsbCBjb3BpZXMgb3Ig
c3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgorICoKKyAqIFRIRSBTT0ZUV0FS
RSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBS
RVNTIE9SCisgKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJS
QU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKKyAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQ
VVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQorICogQVVU
SE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdF
UyBPUiBPVEhFUgorICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFD
VCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcKKyAqIEZST00sIE9VVCBPRiBPUiBJTiBDT05O
RUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIKKyAqIERFQUxJTkdT
IElOIFRIRSBTT0ZUV0FSRS4KKyAqLworCisjaWZuZGVmIFhFTl9BQ0NFU1NfSAorI2RlZmluZSBY
RU5fQUNDRVNTX0gKKworI2luY2x1ZGUgPHhlbmN0cmwuaD4KKyNpbmNsdWRlIDx4ZW5ldnRjaG4u
aD4KKyNpbmNsdWRlIDx4ZW4vdm1fZXZlbnQuaD4KKworI2lmbmRlZiBjb250YWluZXJfb2YKKyNk
ZWZpbmUgY29udGFpbmVyX29mKHB0ciwgdHlwZSwgbWVtYmVyKSAoeyBcCisgICAgICAgICAgICAg
ICAgY29uc3QgdHlwZW9mKCAoKHR5cGUgKikwKS0+bWVtYmVyICkgKl9fbXB0ciA9IChwdHIpOyBc
CisgICAgICAgICAgICAgICAgKHR5cGUgKikoIChjaGFyICopX19tcHRyIC0gb2Zmc2V0b2YodHlw
ZSxtZW1iZXIpICk7fSkKKyNlbmRpZiAvKiBjb250YWluZXJfb2YgKi8KKworI2RlZmluZSBEUFJJ
TlRGKGEsIGIuLi4pIGZwcmludGYoc3RkZXJyLCBhLCAjIyBiKQorI2RlZmluZSBFUlJPUihhLCBi
Li4uKSBmcHJpbnRmKHN0ZGVyciwgYSAiXG4iLCAjIyBiKQorI2RlZmluZSBQRVJST1IoYSwgYi4u
LikgZnByaW50ZihzdGRlcnIsIGEgIjogJXNcbiIsICMjIGIsIHN0cmVycm9yKGVycm5vKSkKKwor
c3RydWN0IHZtX2V2ZW50X29wczsKKwordHlwZWRlZiBzdHJ1Y3Qgdm1fZXZlbnQgeworICAgIHhj
X2ludGVyZmFjZSAqeGNoOworICAgIGRvbWlkX3QgZG9tYWluX2lkOworICAgIHhlbmV2dGNobl9o
YW5kbGUgKnhjZTsKKyAgICB4ZW5fcGZuX3QgbWF4X2dwZm47CisgICAgc3RydWN0IHZtX2V2ZW50
X29wcyAqb3BzOworfSB2bV9ldmVudF90OworCit0eXBlZGVmIHN0cnVjdCB2bV9ldmVudF9vcHMg
eworICAgIGludCAoKmluaXQpKHhjX2ludGVyZmFjZSAqLCB4ZW5ldnRjaG5faGFuZGxlICosIGRv
bWlkX3QsCisgICAgICAgICAgICAgICAgc3RydWN0IHZtX2V2ZW50X29wcyAqLCB2bV9ldmVudF90
ICoqKTsKKyAgICBpbnQgKCp0ZWFyZG93bikodm1fZXZlbnRfdCAqKTsKKyAgICBib29sICgqZ2V0
X3JlcXVlc3QpKHZtX2V2ZW50X3QgKiwgdm1fZXZlbnRfcmVxdWVzdF90ICosIGludCAqKTsKKyAg
ICB2b2lkICgqcHV0X3Jlc3BvbnNlKSh2bV9ldmVudF90ICosIHZtX2V2ZW50X3Jlc3BvbnNlX3Qg
KiwgaW50KTsKKyAgICBpbnQgKCpub3RpZnlfcG9ydCkodm1fZXZlbnRfdCAqLCBpbnQgcG9ydCk7
Cit9IHZtX2V2ZW50X29wc190OworCitzdGF0aWMgaW5saW5lIGJvb2wgZ2V0X3JlcXVlc3Qodm1f
ZXZlbnRfdCAqdm1fZXZlbnQsIHZtX2V2ZW50X3JlcXVlc3RfdCAqcmVxLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCAqcG9ydCkKK3sKKyAgICByZXR1cm4gKCB2bV9ldmVudCAp
ID8gdm1fZXZlbnQtPm9wcy0+Z2V0X3JlcXVlc3Qodm1fZXZlbnQsIHJlcSwgcG9ydCkgOgorICAg
ICAgICAgICAgICAgICAgICAgICAgICBmYWxzZTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIHB1
dF9yZXNwb25zZSh2bV9ldmVudF90ICp2bV9ldmVudCwgdm1fZXZlbnRfcmVzcG9uc2VfdCAqcnNw
LCBpbnQgcG9ydCkKK3sKKyAgICBpZiAoICB2bV9ldmVudCApCisgICAgICAgIHZtX2V2ZW50LT5v
cHMtPnB1dF9yZXNwb25zZSh2bV9ldmVudCwgcnNwLCBwb3J0KTsKK30KKworc3RhdGljIGlubGlu
ZSBpbnQgbm90aWZ5X3BvcnQodm1fZXZlbnRfdCAqdm1fZXZlbnQsIGludCBwb3J0KQoreworICAg
IGlmICggIXZtX2V2ZW50ICkKKyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisKKyAgICByZXR1cm4g
dm1fZXZlbnQtPm9wcy0+bm90aWZ5X3BvcnQodm1fZXZlbnQsIHBvcnQpOworfQorCisjZW5kaWYg
LyogWEVOX0FDQ0VTU19IICovCisKKy8qCisgKiBMb2NhbCB2YXJpYWJsZXM6CisgKiBtb2RlOiBD
CisgKiBjLWZpbGUtc3R5bGU6ICJCU0QiCisgKiBjLWJhc2ljLW9mZnNldDogNAorICogaW5kZW50
LXRhYnMtbW9kZTogbmlsCisgKiBFbmQ6CisgKi8KLS0gCjIuNy40CgoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApY
ZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

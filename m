Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4684A16684
	for <lists+xen-devel@lfdr.de>; Tue,  7 May 2019 17:18:39 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hO1oh-0007fl-SS; Tue, 07 May 2019 15:15:39 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=qCYz=TH=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1hO1og-0007e8-4p
 for xen-devel@lists.xenproject.org; Tue, 07 May 2019 15:15:38 +0000
X-Inumbo-ID: f6865222-70da-11e9-843c-bc764e045a96
Received: from foss.arm.com (unknown [217.140.101.70])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTP
 id f6865222-70da-11e9-843c-bc764e045a96;
 Tue, 07 May 2019 15:15:35 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.72.51.249])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 2AAA0374;
 Tue,  7 May 2019 08:15:35 -0700 (PDT)
Received: from e108454-lin.cambridge.arm.com (e108454-lin.cambridge.arm.com
 [10.1.196.50])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id E71E33F5AF;
 Tue,  7 May 2019 08:15:32 -0700 (PDT)
From: Julien Grall <julien.grall@arm.com>
To: xen-devel@lists.xenproject.org
Date: Tue,  7 May 2019 16:14:57 +0100
Message-Id: <20190507151458.29350-14-julien.grall@arm.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190507151458.29350-1-julien.grall@arm.com>
References: <20190507151458.29350-1-julien.grall@arm.com>
Subject: [Xen-devel] [PATCH 13/14] xen/mm: Convert {s,
 g}et_gpfn_from_mfn() to use typesafe MFN
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wei.liu2@citrix.com>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Tamas K Lengyel <tamas@tklengyel.com>,
 Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIGZpcnN0IHBhcmFtZXRlciBvZiB7cyxnfWV0X2dwZm5fZnJvbV9tZm4oKSBpcyBhbiBNRk4s
IHNvIGl0IGNhbiBiZQpzd2l0Y2hlZCB0byB1c2UgdGhlIHR5cGVzYWZlLgoKQXQgdGhlIHNhbWUg
dGltZSwgcmVwbGFjZSBncGZuIHdpdGggcGZuIGluIHRoZSBoZWxwZXJzIGFzIHRoZXkgYWxsIGRl
YWwKd2l0aCBQRk4gYW5kIGFsc28gdHVybiB0aGUgbWFjcm9zIHRvIHN0YXRpYyBpbmxpbmUuCgpO
b3RlIHRoYXQgdGhlIHJldHVybiBvZiB0aGUgZ2V0dGVyIGFuZCB0aGUgMm5kIHBhcmFtZXRlciBv
ZiB0aGUgc2V0dGVyCmhhdmUgbm90IGJlZW4gY29udmVydGVkIHRvIHVzZSB0eXBlc2FmZSBQRk4g
YmVjYXVzZSBpdCB3YXMgcmVxdWlyaW5nCm1vcmUgY2hhbmdlcyB0aGFuIGV4cGVjdGVkLgoKU2ln
bmVkLW9mZi1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KCi0tLQogICAg
Q2hhbmdlcyBpbiB2MjoKICAgICAgICAtIFBhdGNoIGFkZGVkCi0tLQogeGVuL2FyY2gveDg2L2Nw
dS9tY2hlY2svbWNhY3Rpb24uYyB8ICAyICstCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAgICAgICAg
ICAgICAgIHwgMTQgKysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9tbS9tZW1fc2hhcmluZy5jICAgICAg
fCAxOSArKysrKy0tLS0tLQogeGVuL2FyY2gveDg2L21tL3AybS1wb2QuYyAgICAgICAgICB8ICA0
ICstLQogeGVuL2FyY2gveDg2L21tL3AybS1wdC5jICAgICAgICAgICB8IDM3ICsrKysrKysrKyst
LS0tLS0tLS0tLQogeGVuL2FyY2gveDg2L21tL3AybS5jICAgICAgICAgICAgICB8IDY2ICsrKysr
KysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tCiB4ZW4vYXJjaC94ODYvbW0vcGFnaW5n
LmMgICAgICAgICAgIHwgIDQgKy0tCiB4ZW4vYXJjaC94ODYvcHYvZG9tMF9idWlsZC5jICAgICAg
IHwgIDYgKystLQogeGVuL2FyY2gveDg2L3g4Nl82NC90cmFwcy5jICAgICAgICB8IDQxICsrKysr
KysrKysrLS0tLS0tLS0tLS0tCiB4ZW4vY29tbW9uL21lbW9yeS5jICAgICAgICAgICAgICAgIHwg
IDIgKy0KIHhlbi9jb21tb24vcGFnZV9hbGxvYy5jICAgICAgICAgICAgfCAgMiArLQogeGVuL2lu
Y2x1ZGUvYXNtLWFybS9tbS5oICAgICAgICAgICB8ICAyICstCiB4ZW4vaW5jbHVkZS9hc20teDg2
L2dyYW50X3RhYmxlLmggIHwgIDIgKy0KIHhlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCAgICAgICAg
ICAgfCAxNiArKysrKy0tLS0KIHhlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmggICAgICAgICAgfCAg
MiArLQogMTUgZmlsZXMgY2hhbmdlZCwgMTEzIGluc2VydGlvbnMoKyksIDEwNiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvY3B1L21jaGVjay9tY2FjdGlvbi5jIGIveGVu
L2FyY2gveDg2L2NwdS9tY2hlY2svbWNhY3Rpb24uYwppbmRleCA2OTMzMmZiODRkLi41ZTc4ZmI3
NzAzIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvY3B1L21jaGVjay9tY2FjdGlvbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9jcHUvbWNoZWNrL21jYWN0aW9uLmMKQEAgLTg5LDcgKzg5LDcgQEAgbWNf
bWVtZXJyX2RoYW5kbGVyKHN0cnVjdCBtY2FfYmluZm8gKmJpbmZvLAogICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgIGQgPSBnZXRfZG9tYWluX2J5X2lkKGJhbmstPm1jX2RvbWlkKTsKICAg
ICAgICAgICAgICAgICBBU1NFUlQoZCk7Ci0gICAgICAgICAgICAgICAgZ2ZuID0gZ2V0X2dwZm5f
ZnJvbV9tZm4oKGJhbmstPm1jX2FkZHIpID4+IFBBR0VfU0hJRlQpOworICAgICAgICAgICAgICAg
IGdmbiA9IGdldF9wZm5fZnJvbV9tZm4obWFkZHJfdG9fbWZuKGJhbmstPm1jX2FkZHIpKTsKIAog
ICAgICAgICAgICAgICAgIGlmICggdW5tbWFwX2Jyb2tlbl9wYWdlKGQsIG1mbiwgZ2ZuKSApCiAg
ICAgICAgICAgICAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJj
aC94ODYvbW0uYwppbmRleCA3ZDg4N2YyNjk5Li42MGM0NzU4MmJlIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNTAyLDcgKzUwMiw3IEBA
IHZvaWQgc2hhcmVfeGVuX3BhZ2Vfd2l0aF9ndWVzdChzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCBz
dHJ1Y3QgZG9tYWluICpkLAogICAgIGlmICggcGFnZV9nZXRfb3duZXIocGFnZSkgPT0gZCApCiAg
ICAgICAgIHJldHVybjsKIAotICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KHBhZ2VfdG9fbWZu
KHBhZ2UpKSwgSU5WQUxJRF9NMlBfRU5UUlkpOworICAgIHNldF9wZm5fZnJvbV9tZm4ocGFnZV90
b19tZm4ocGFnZSksIElOVkFMSURfTTJQX0VOVFJZKTsKIAogICAgIHNwaW5fbG9jaygmZC0+cGFn
ZV9hbGxvY19sb2NrKTsKIApAQCAtMTA3Nyw3ICsxMDc3LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sMWUo
CiAKICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiRXJyb3IgdXBkYXRpbmcg
bWFwcGluZ3MgZm9yIG1mbiAlIiBQUklfbWZuCiAgICAgICAgICAgICAgICAgICAgICAiIChwZm4g
JSIgUFJJX3BmbiAiLCBmcm9tIEwxIGVudHJ5ICUiIFBSSXB0ZSAiKSBmb3IgZCVkXG4iLAotICAg
ICAgICAgICAgICAgICAgICAgbWZuLCBnZXRfZ3Bmbl9mcm9tX21mbihtZm4pLAorICAgICAgICAg
ICAgICAgICAgICAgbWZuLCBnZXRfcGZuX2Zyb21fbWZuKF9tZm4obWZuKSksCiAgICAgICAgICAg
ICAgICAgICAgICBsMWVfZ2V0X2ludHB0ZShsMWUpLCBsMWVfb3duZXItPmRvbWFpbl9pZCk7CiAg
ICAgICAgICAgICByZXR1cm4gZXJyOwogICAgICAgICB9CkBAIC0xMDg4LDcgKzEwODgsNyBAQCBn
ZXRfcGFnZV9mcm9tX2wxZSgKICBjb3VsZF9ub3RfcGluOgogICAgIGdkcHJpbnRrKFhFTkxPR19X
QVJOSU5HLCAiRXJyb3IgZ2V0dGluZyBtZm4gJSIgUFJJX21mbiAiIChwZm4gJSIgUFJJX3Bmbgog
ICAgICAgICAgICAgICIpIGZyb20gTDEgZW50cnkgJSIgUFJJcHRlICIgZm9yIGwxZV9vd25lciBk
JWQsIHBnX293bmVyIGQlZFxuIiwKLSAgICAgICAgICAgICBtZm4sIGdldF9ncGZuX2Zyb21fbWZu
KG1mbiksCisgICAgICAgICAgICAgbWZuLCBnZXRfcGZuX2Zyb21fbWZuKF9tZm4obWZuKSksCiAg
ICAgICAgICAgICAgbDFlX2dldF9pbnRwdGUobDFlKSwgbDFlX293bmVyLT5kb21haW5faWQsIHBn
X293bmVyLT5kb21haW5faWQpOwogICAgIGlmICggcmVhbF9wZ19vd25lciAhPSBOVUxMICkKICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CkBAIC0yNjA0LDcgKzI2MDQsNyBAQCBzdGF0aWMgaW50IGFs
bG9jX3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUs
CiAgICAgICAgICAgICAgICAgICIgKHBmbiAlIiBQUklfcGZuICIpIGZvciB0eXBlICUiIFBSdHlw
ZV9pbmZvCiAgICAgICAgICAgICAgICAgICI6IGNhZj0lMDhseCB0YWY9JSIgUFJ0eXBlX2luZm8g
IlxuIiwKICAgICAgICAgICAgICAgICAgbWZuX3gocGFnZV90b19tZm4ocGFnZSkpLAotICAgICAg
ICAgICAgICAgICBnZXRfZ3Bmbl9mcm9tX21mbihtZm5feChwYWdlX3RvX21mbihwYWdlKSkpLAor
ICAgICAgICAgICAgICAgICBnZXRfcGZuX2Zyb21fbWZuKHBhZ2VfdG9fbWZuKHBhZ2UpKSwKICAg
ICAgICAgICAgICAgICAgdHlwZSwgcGFnZS0+Y291bnRfaW5mbywgcGFnZS0+dS5pbnVzZS50eXBl
X2luZm8pOwogICAgICAgICBpZiAoIHBhZ2UgIT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgKQogICAgICAgICAgICAgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gPSAwOwpAQCAtMjg5MCw3
ICsyODkwLDcgQEAgc3RhdGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAiQmFkIHR5cGUg
KHNhdyAlIiBQUnR5cGVfaW5mbyAiICE9IGV4cCAlIiBQUnR5cGVfaW5mbyAiKSAiCiAgICAgICAg
ICAgICAgICAgICAgICAiZm9yIG1mbiAlIiBQUklfbWZuICIgKHBmbiAlIiBQUklfcGZuICIpXG4i
LAogICAgICAgICAgICAgICAgICAgICAgeCwgdHlwZSwgbWZuX3gocGFnZV90b19tZm4ocGFnZSkp
LAotICAgICAgICAgICAgICAgICAgICAgZ2V0X2dwZm5fZnJvbV9tZm4obWZuX3gocGFnZV90b19t
Zm4ocGFnZSkpKSk7CisgICAgICAgICAgICAgICAgICAgICBnZXRfcGZuX2Zyb21fbWZuKHBhZ2Vf
dG9fbWZuKHBhZ2UpKSk7CiAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKICAgICAgICAgfQog
ICAgICAgICBlbHNlIGlmICggdW5saWtlbHkoISh4ICYgUEdUX3ZhbGlkYXRlZCkpICkKQEAgLTQw
MDIsNyArNDAwMiw3IEBAIGxvbmcgZG9fbW11X3VwZGF0ZSgKICAgICAgICAgICAgICAgICBicmVh
azsKICAgICAgICAgICAgIH0KIAotICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3go
bWZuKSwgZ3Bmbik7CisgICAgICAgICAgICBzZXRfcGZuX2Zyb21fbWZuKG1mbiwgZ3Bmbik7CiAg
ICAgICAgICAgICBwYWdpbmdfbWFya19wZm5fZGlydHkocGdfb3duZXIsIF9wZm4oZ3BmbikpOwog
CiAgICAgICAgICAgICBwdXRfcGFnZShwYWdlKTsKQEAgLTQ1MjksNyArNDUyOSw3IEBAIGludCB4
ZW5tZW1fYWRkX3RvX3BoeXNtYXBfb25lKAogICAgICAgICBnb3RvIHB1dF9ib3RoOwogCiAgICAg
LyogVW5tYXAgZnJvbSBvbGQgbG9jYXRpb24sIGlmIGFueS4gKi8KLSAgICBvbGRfZ3BmbiA9IGdl
dF9ncGZuX2Zyb21fbWZuKG1mbl94KG1mbikpOworICAgIG9sZF9ncGZuID0gZ2V0X3Bmbl9mcm9t
X21mbihtZm4pOwogICAgIEFTU0VSVCghU0hBUkVEX00yUChvbGRfZ3BmbikpOwogICAgIGlmICgg
c3BhY2UgPT0gWEVOTUFQU1BBQ0VfZ21mbiAmJiBvbGRfZ3BmbiAhPSBnZm4gKQogICAgIHsKZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9tZW1fc2hhcmluZy5jIGIveGVuL2FyY2gveDg2L21t
L21lbV9zaGFyaW5nLmMKaW5kZXggNWFjOWQ4ZjU0Yy4uYWY5MDNjMTFlOSAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gveDg2L21tL21lbV9zaGFyaW5nLmMKKysrIGIveGVuL2FyY2gveDg2L21tL21lbV9z
aGFyaW5nLmMKQEAgLTM5MSwxMSArMzkxLDEyIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBtZW1fc2hh
cmluZ19nZm5fZGVzdHJveShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLAogICAgIHhmcmVlKGdmbl9p
bmZvKTsKIH0KIAotc3RhdGljIHN0cnVjdCBwYWdlX2luZm8qIG1lbV9zaGFyaW5nX2xvb2t1cCh1
bnNpZ25lZCBsb25nIG1mbikKK3N0YXRpYyBzdHJ1Y3QgcGFnZV9pbmZvKiBtZW1fc2hhcmluZ19s
b29rdXAobWZuX3QgbWZuKQogewotICAgIGlmICggbWZuX3ZhbGlkKF9tZm4obWZuKSkgKQorICAg
IGlmICggbWZuX3ZhbGlkKG1mbikgKQogICAgIHsKLSAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyog
cGFnZSA9IG1mbl90b19wYWdlKF9tZm4obWZuKSk7CisgICAgICAgIHN0cnVjdCBwYWdlX2luZm8q
IHBhZ2UgPSBtZm5fdG9fcGFnZShtZm4pOworCiAgICAgICAgIGlmICggcGFnZV9nZXRfb3duZXIo
cGFnZSkgPT0gZG9tX2NvdyApCiAgICAgICAgIHsKICAgICAgICAgICAgIC8qIENvdW50IGhhcyB0
byBiZSBhdCBsZWFzdCB0d28sIGJlY2F1c2Ugd2UncmUgY2FsbGVkCkBAIC00MDQsNyArNDA1LDcg
QEAgc3RhdGljIHN0cnVjdCBwYWdlX2luZm8qIG1lbV9zaGFyaW5nX2xvb2t1cCh1bnNpZ25lZCBs
b25nIG1mbikKICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgdCA9IHJlYWRfYXRvbWljKCZwYWdl
LT51LmludXNlLnR5cGVfaW5mbyk7CiAgICAgICAgICAgICBBU1NFUlQoKHQgJiBQR1RfdHlwZV9t
YXNrKSA9PSBQR1Rfc2hhcmVkX3BhZ2UpOwogICAgICAgICAgICAgQVNTRVJUKCh0ICYgUEdUX2Nv
dW50X21hc2spID49IDIpOwotICAgICAgICAgICAgQVNTRVJUKFNIQVJFRF9NMlAoZ2V0X2dwZm5f
ZnJvbV9tZm4obWZuKSkpOworICAgICAgICAgICAgQVNTRVJUKFNIQVJFRF9NMlAoZ2V0X3Bmbl9m
cm9tX21mbihtZm4pKSk7CiAgICAgICAgICAgICByZXR1cm4gcGFnZTsKICAgICAgICAgfQogICAg
IH0KQEAgLTQ2NCwxMCArNDY1LDEwIEBAIHN0YXRpYyBpbnQgYXVkaXQodm9pZCkKICAgICAgICAg
fQogCiAgICAgICAgIC8qIENoZWNrIHRoZSBtMnAgZW50cnkgKi8KLSAgICAgICAgaWYgKCAhU0hB
UkVEX00yUChnZXRfZ3Bmbl9mcm9tX21mbihtZm5feChtZm4pKSkgKQorICAgICAgICBpZiAoICFT
SEFSRURfTTJQKGdldF9wZm5fZnJvbV9tZm4obWZuKSkgKQogICAgICAgICB7CiAgICAgICAgICAg
IE1FTV9TSEFSSU5HX0RFQlVHKCJtZm4gJWx4IHNoYXJlZCwgYnV0IHdyb25nIG0ycCBlbnRyeSAo
JWx4KSFcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl94KG1mbiksIGdldF9n
cGZuX2Zyb21fbWZuKG1mbl94KG1mbikpKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bWZuX3gobWZuKSwgZ2V0X3Bmbl9mcm9tX21mbihtZm4pKTsKICAgICAgICAgICAgZXJyb3JzKys7
CiAgICAgICAgIH0KIApAQCAtNjkzLDcgKzY5NCw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHBh
Z2VfaW5mbyAqX19ncmFiX3NoYXJlZF9wYWdlKG1mbl90IG1mbikKICAgICBpZiAoICFtZW1fc2hh
cmluZ19wYWdlX2xvY2socGcpICkKICAgICAgICAgcmV0dXJuIE5VTEw7CiAKLSAgICBpZiAoIG1l
bV9zaGFyaW5nX2xvb2t1cChtZm5feChtZm4pKSA9PSBOVUxMICkKKyAgICBpZiAoIG1lbV9zaGFy
aW5nX2xvb2t1cChtZm4pID09IE5VTEwgKQogICAgIHsKICAgICAgICAgbWVtX3NoYXJpbmdfcGFn
ZV91bmxvY2socGcpOwogICAgICAgICByZXR1cm4gTlVMTDsKQEAgLTg3Nyw3ICs4NzgsNyBAQCBz
dGF0aWMgaW50IG5vbWluYXRlX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2ZuLAogICAg
IGF0b21pY19pbmMoJm5yX3NoYXJlZF9tZm5zKTsKIAogICAgIC8qIFVwZGF0ZSBtMnAgZW50cnkg
dG8gU0hBUkVEX00yUF9FTlRSWSAqLwotICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG1mbiks
IFNIQVJFRF9NMlBfRU5UUlkpOworICAgIHNldF9wZm5fZnJvbV9tZm4obWZuLCBTSEFSRURfTTJQ
X0VOVFJZKTsKIAogICAgICpwaGFuZGxlID0gcGFnZS0+c2hhcmluZy0+aGFuZGxlOwogICAgIGF1
ZGl0X2FkZF9saXN0KHBhZ2UpOwpAQCAtMTIyMiw3ICsxMjIzLDcgQEAgcHJpdmF0ZV9wYWdlX2Zv
dW5kOgogICAgIH0KIAogICAgIC8qIFVwZGF0ZSBtMnAgZW50cnkgKi8KLSAgICBzZXRfZ3Bmbl9m
cm9tX21mbihtZm5feChwYWdlX3RvX21mbihwYWdlKSksIGdmbik7CisgICAgc2V0X3Bmbl9mcm9t
X21mbihwYWdlX3RvX21mbihwYWdlKSwgZ2ZuKTsKIAogICAgIC8qIE5vdyB0aGF0IHRoZSBnZm48
LT5tZm4gbWFwIGlzIHByb3Blcmx5IGVzdGFibGlzaGVkLAogICAgICAqIG1hcmtpbmcgZGlydHkg
aXMgZmVhc2libGUgKi8KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMgYi94
ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5jCmluZGV4IDQzMTM4NjMwNjYuLjllMDAxNzM4ZjQgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMKKysrIGIveGVuL2FyY2gveDg2L21t
L3AybS1wb2QuYwpAQCAtNjUyLDcgKzY1Miw3IEBAIHAybV9wb2RfZGVjcmVhc2VfcmVzZXJ2YXRp
b24oc3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2ZuLCB1bnNpZ25lZCBpbnQgb3JkZXIpCiAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICBwMm1fdGxiX2ZsdXNoX3N5bmMocDJtKTsKICAgICAgICAg
ICAgIGZvciAoIGogPSAwOyBqIDwgbjsgKytqICkKLSAgICAgICAgICAgICAgICBzZXRfZ3Bmbl9m
cm9tX21mbihtZm5feChtZm4pLCBJTlZBTElEX00yUF9FTlRSWSk7CisgICAgICAgICAgICAgICAg
c2V0X3Bmbl9mcm9tX21mbihtZm4sIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAgICAgIHAy
bV9wb2RfY2FjaGVfYWRkKHAybSwgcGFnZSwgY3VyX29yZGVyKTsKIAogICAgICAgICAgICAgc3Rl
YWxfZm9yX2NhY2hlID0gICggcDJtLT5wb2QuZW50cnlfY291bnQgPiBwMm0tPnBvZC5jb3VudCAp
OwpAQCAtMTIwMyw3ICsxMjAzLDcgQEAgcDJtX3BvZF9kZW1hbmRfcG9wdWxhdGUoc3RydWN0IHAy
bV9kb21haW4gKnAybSwgZ2ZuX3QgZ2ZuLAogCiAgICAgZm9yKCBpID0gMDsgaSA8ICgxVUwgPDwg
b3JkZXIpOyBpKysgKQogICAgIHsKLSAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3gobWZu
KSArIGksIGdmbl94KGdmbl9hbGlnbmVkKSArIGkpOworICAgICAgICBzZXRfcGZuX2Zyb21fbWZu
KG1mbl9hZGQobWZuLCBpKSwgZ2ZuX3goZ2ZuX2FsaWduZWQpICsgaSk7CiAgICAgICAgIHBhZ2lu
Z19tYXJrX3Bmbl9kaXJ0eShkLCBfcGZuKGdmbl94KGdmbl9hbGlnbmVkKSArIGkpKTsKICAgICB9
CiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcHQuYyBiL3hlbi9hcmNoL3g4Ni9t
bS9wMm0tcHQuYwppbmRleCBjYWZjOWYyOTliLi4wZTg1ODE5ZjliIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0vcDJtLXB0LmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1wdC5jCkBAIC05
OTEsNyArOTkxLDggQEAgc3RhdGljIGludCBwMm1fcHRfY2hhbmdlX2VudHJ5X3R5cGVfcmFuZ2Uo
c3RydWN0IHAybV9kb21haW4gKnAybSwKIGxvbmcgcDJtX3B0X2F1ZGl0X3AybShzdHJ1Y3QgcDJt
X2RvbWFpbiAqcDJtKQogewogICAgIHVuc2lnbmVkIGxvbmcgZW50cnlfY291bnQgPSAwLCBwbWJh
ZCA9IDA7Ci0gICAgdW5zaWduZWQgbG9uZyBtZm4sIGdmbiwgbTJwZm47CisgICAgdW5zaWduZWQg
bG9uZyBnZm4sIG0ycGZuOworICAgIG1mbl90IG1mbjsKIAogICAgIEFTU0VSVChwMm1fbG9ja2Vk
X2J5X21lKHAybSkpOwogICAgIEFTU0VSVChwb2RfbG9ja2VkX2J5X21lKHAybSkpOwpAQCAtMTAz
MCwxOSArMTAzMSwxOSBAQCBsb25nIHAybV9wdF9hdWRpdF9wMm0oc3RydWN0IHAybV9kb21haW4g
KnAybSkKICAgICAgICAgICAgICAgICAvKiBjaGVjayBmb3IgMUdCIHN1cGVyIHBhZ2UgKi8KICAg
ICAgICAgICAgICAgICBpZiAoIGwzZV9nZXRfZmxhZ3MobDNlW2kzXSkgJiBfUEFHRV9QU0UgKQog
ICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgbWZuID0gbDNlX2dldF9wZm4o
bDNlW2kzXSk7Ci0gICAgICAgICAgICAgICAgICAgIEFTU0VSVChtZm5fdmFsaWQoX21mbihtZm4p
KSk7CisgICAgICAgICAgICAgICAgICAgIG1mbiA9IGwzZV9nZXRfbWZuKGwzZVtpM10pOworICAg
ICAgICAgICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKG1mbikpOwogICAgICAgICAgICAgICAg
ICAgICAvKiB3ZSBoYXZlIHRvIGNvdmVyIDUxMng1MTIgNEsgcGFnZXMgKi8KICAgICAgICAgICAg
ICAgICAgICAgZm9yICggaTIgPSAwOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgaTIgPCAo
TDJfUEFHRVRBQkxFX0VOVFJJRVMgKiBMMV9QQUdFVEFCTEVfRU5UUklFUyk7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGkyKyspCiAgICAgICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAg
ICAgICAgICAgICAgIG0ycGZuID0gZ2V0X2dwZm5fZnJvbV9tZm4obWZuK2kyKTsKKyAgICAgICAg
ICAgICAgICAgICAgICAgIG0ycGZuID0gZ2V0X3Bmbl9mcm9tX21mbihtZm5fYWRkKG1mbiwgaTIp
KTsKICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbTJwZm4gIT0gKGdmbiArIGkyKSApCiAg
ICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG1i
YWQrKzsKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBQMk1fUFJJTlRLKCJtaXNtYXRjaDog
Z2ZuICUjbHggLT4gbWZuICUjbHgiCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAiIC0+IGdmbiAlI2x4XG4iLCBnZm4raTIsIG1mbitpMiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBQMk1fUFJJTlRLKCJtaXNtYXRjaDogZ2ZuICUjbHggLT4gbWZuICUiUFJJX21m
biIgZ2ZuICUjbHhcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
Zm4gKyBpMiwgbWZuX3gobWZuX2FkZChtZm4sIGkyKSksCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBtMnBmbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVH
KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICB9CkBAIC0xMDY3LDE3ICsxMDY4LDE3IEBAIGxv
bmcgcDJtX3B0X2F1ZGl0X3AybShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtKQogICAgICAgICAgICAg
ICAgICAgICAvKiBjaGVjayBmb3Igc3VwZXIgcGFnZSAqLwogICAgICAgICAgICAgICAgICAgICBp
ZiAoIGwyZV9nZXRfZmxhZ3MobDJlW2kyXSkgJiBfUEFHRV9QU0UgKQogICAgICAgICAgICAgICAg
ICAgICB7Ci0gICAgICAgICAgICAgICAgICAgICAgICBtZm4gPSBsMmVfZ2V0X3BmbihsMmVbaTJd
KTsKLSAgICAgICAgICAgICAgICAgICAgICAgIEFTU0VSVChtZm5fdmFsaWQoX21mbihtZm4pKSk7
CisgICAgICAgICAgICAgICAgICAgICAgICBtZm4gPSBsMmVfZ2V0X21mbihsMmVbaTJdKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgIEFTU0VSVChtZm5fdmFsaWQobWZuKSk7CiAgICAgICAgICAg
ICAgICAgICAgICAgICBmb3IgKCBpMSA9IDA7IGkxIDwgTDFfUEFHRVRBQkxFX0VOVFJJRVM7IGkx
KyspCiAgICAgICAgICAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbTJwZm4gPSBnZXRfZ3Bmbl9mcm9tX21mbihtZm4raTEpOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG0ycGZuID0gZ2V0X3Bmbl9mcm9tX21mbihtZm5fYWRkKG1mbiwgaTEpKTsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBBbGxvdyBzaGFyZWQgTTJQcyAqLwogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGlmICggKG0ycGZuICE9IChnZm4gKyBpMSkpICYmICFTSEFS
RURfTTJQKG0ycGZuKSApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwbWJhZCsrOwotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBQMk1fUFJJTlRLKCJtaXNtYXRjaDogZ2ZuICUjbHggLT4gbWZuICUjbHgiCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiAtPiBnZm4gJSNseFxuIiwg
Z2ZuK2kxLCBtZm4raTEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAyTV9QUklO
VEsoIm1pc21hdGNoOiBnZm4gJSNseCAtPiBtZm4gJSJQUklfbWZuIiAtPiBnZm4gJSNseFxuIiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZm4gKyBpMSwgbWZu
X3gobWZuX2FkZChtZm4sIGkxKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbTJwZm4pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCVUcoKTsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CkBAIC0xMDk5LDE5ICsxMTAwLDE5IEBAIGxv
bmcgcDJtX3B0X2F1ZGl0X3AybShzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBlbnRyeV9jb3VudCsrOwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgfQotICAgICAgICAgICAg
ICAgICAgICAgICAgbWZuID0gbDFlX2dldF9wZm4obDFlW2kxXSk7Ci0gICAgICAgICAgICAgICAg
ICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKF9tZm4obWZuKSkpOwotICAgICAgICAgICAgICAgICAg
ICAgICAgbTJwZm4gPSBnZXRfZ3Bmbl9mcm9tX21mbihtZm4pOworICAgICAgICAgICAgICAgICAg
ICAgICAgbWZuID0gbDFlX2dldF9tZm4obDFlW2kxXSk7CisgICAgICAgICAgICAgICAgICAgICAg
ICBBU1NFUlQobWZuX3ZhbGlkKG1mbikpOworICAgICAgICAgICAgICAgICAgICAgICAgbTJwZm4g
PSBnZXRfcGZuX2Zyb21fbWZuKG1mbik7CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIG0y
cGZuICE9IGdmbiAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlICE9IHAybV9t
bWlvX2RpcmVjdCAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhcDJtX2lzX2dyYW50
KHR5cGUpICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFwMm1faXNfc2hhcmVkKHR5
cGUpICkKICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBwbWJhZCsrOwotICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50aygibWlzbWF0
Y2g6IGdmbiAlI2x4IC0+IG1mbiAlI2x4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAiIC0+IGdmbiAlI2x4XG4iLCBnZm4sIG1mbiwgbTJwZm4pOwotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFAyTV9QUklOVEsoIm1pc21hdGNoOiBnZm4gJSNseCAtPiBtZm4gJSNseCIK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgLT4gZ2ZuICUjbHhcbiIs
IGdmbiwgbWZuLCBtMnBmbik7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRrKCJt
aXNtYXRjaDogZ2ZuICUjbHggLT4gbWZuICUiUFJJX21mbiIgLT4gZ2ZuICUjbHhcbiIsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmbiwgbWZuX3gobWZuKSwgbTJwZm4pOwor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAyTV9QUklOVEsoIm1pc21hdGNoOiBnZm4gJSNs
eCAtPiBtZm4gJSJQUklfbWZuIiAtPiBnZm4gJSNseFxuIiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGdmbiwgbWZuX3gobWZuKSwgbTJwZm4pOwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIEJVRygpOwogICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgICAgICB9CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMgYi94ZW4v
YXJjaC94ODYvbW0vcDJtLmMKaW5kZXggM2M5OGY3MmRiYi4uMDAzZWQ5NzUyMSAxMDA2NDQKLS0t
IGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAt
NzY5LDcgKzc2OSw3IEBAIHZvaWQgcDJtX2ZpbmFsX3RlYXJkb3duKHN0cnVjdCBkb21haW4gKmQp
CiAKIAogc3RhdGljIGludAotcDJtX3JlbW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0s
IHVuc2lnbmVkIGxvbmcgZ2ZuX2wsIHVuc2lnbmVkIGxvbmcgbWZuLAorcDJtX3JlbW92ZV9wYWdl
KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcgZ2ZuX2wsIG1mbl90IG1mbiwK
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgcGFnZV9vcmRlcikKIHsKICAgICB1bnNpZ25l
ZCBsb25nIGk7CkBAIC03ODMsMTcgKzc4MywxNyBAQCBwMm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAy
bV9kb21haW4gKnAybSwgdW5zaWduZWQgbG9uZyBnZm5fbCwgdW5zaWduZWQgbG9uZyBtZm4sCiAg
ICAgICAgIHJldHVybiAwOwogCiAgICAgQVNTRVJUKGdmbl9sb2NrZWRfYnlfbWUocDJtLCBnZm4p
KTsKLSAgICBQMk1fREVCVUcoInJlbW92aW5nIGdmbj0lI2x4IG1mbj0lI2x4XG4iLCBnZm5fbCwg
bWZuKTsKKyAgICBQMk1fREVCVUcoInJlbW92aW5nIGdmbj0lI2x4IG1mbj0lIlBSSV9tZm4iXG4i
LCBnZm5fbCwgbWZuX3gobWZuKSk7CiAKLSAgICBpZiAoIG1mbl92YWxpZChfbWZuKG1mbikpICkK
KyAgICBpZiAoIG1mbl92YWxpZChtZm4pICkKICAgICB7CiAgICAgICAgIGZvciAoIGkgPSAwOyBp
IDwgKDFVTCA8PCBwYWdlX29yZGVyKTsgaSsrICkKICAgICAgICAgewogICAgICAgICAgICAgbWZu
X3JldHVybiA9IHAybS0+Z2V0X2VudHJ5KHAybSwgZ2ZuX2FkZChnZm4sIGkpLCAmdCwgJmEsIDAs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwgTlVMTCk7CiAg
ICAgICAgICAgICBpZiAoICFwMm1faXNfZ3JhbnQodCkgJiYgIXAybV9pc19zaGFyZWQodCkgJiYg
IXAybV9pc19mb3JlaWduKHQpICkKLSAgICAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbiht
Zm4raSwgSU5WQUxJRF9NMlBfRU5UUlkpOwotICAgICAgICAgICAgQVNTRVJUKCAhcDJtX2lzX3Zh
bGlkKHQpIHx8IG1mbiArIGkgPT0gbWZuX3gobWZuX3JldHVybikgKTsKKyAgICAgICAgICAgICAg
ICBzZXRfcGZuX2Zyb21fbWZuKG1mbl9hZGQobWZuLCBpKSwgSU5WQUxJRF9NMlBfRU5UUlkpOwor
ICAgICAgICAgICAgQVNTRVJUKCAhcDJtX2lzX3ZhbGlkKHQpIHx8IG1mbl9lcShtZm5fYWRkKG1m
biwgaSksIG1mbl9yZXR1cm4pICk7CiAgICAgICAgIH0KICAgICB9CiAgICAgcmV0dXJuIHAybV9z
ZXRfZW50cnkocDJtLCBnZm4sIElOVkFMSURfTUZOLCBwYWdlX29yZGVyLCBwMm1faW52YWxpZCwK
QEAgLTgwNyw3ICs4MDcsNyBAQCBndWVzdF9waHlzbWFwX3JlbW92ZV9wYWdlKHN0cnVjdCBkb21h
aW4gKmQsIGdmbl90IGdmbiwKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtID0gcDJtX2dldF9o
b3N0cDJtKGQpOwogICAgIGludCByYzsKICAgICBnZm5fbG9jayhwMm0sIGdmbiwgcGFnZV9vcmRl
cik7Ci0gICAgcmMgPSBwMm1fcmVtb3ZlX3BhZ2UocDJtLCBnZm5feChnZm4pLCBtZm5feChtZm4p
LCBwYWdlX29yZGVyKTsKKyAgICByYyA9IHAybV9yZW1vdmVfcGFnZShwMm0sIGdmbl94KGdmbiks
IG1mbiwgcGFnZV9vcmRlcik7CiAgICAgZ2ZuX3VubG9jayhwMm0sIGdmbiwgcGFnZV9vcmRlcik7
CiAgICAgcmV0dXJuIHJjOwogfQpAQCAtOTA4LDcgKzkwOCw3IEBAIGd1ZXN0X3BoeXNtYXBfYWRk
X2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIGdmbl90IGdmbiwgbWZuX3QgbWZuLAogICAgICAgICBl
bHNlIGlmICggcDJtX2lzX3JhbShvdCkgJiYgIXAybV9pc19wYWdlZChvdCkgKQogICAgICAgICB7
CiAgICAgICAgICAgICBBU1NFUlQobWZuX3ZhbGlkKG9tZm4pKTsKLSAgICAgICAgICAgIHNldF9n
cGZuX2Zyb21fbWZuKG1mbl94KG9tZm4pLCBJTlZBTElEX00yUF9FTlRSWSk7CisgICAgICAgICAg
ICBzZXRfcGZuX2Zyb21fbWZuKG9tZm4sIElOVkFMSURfTTJQX0VOVFJZKTsKICAgICAgICAgfQog
ICAgICAgICBlbHNlIGlmICggb3QgPT0gcDJtX3BvcHVsYXRlX29uX2RlbWFuZCApCiAgICAgICAg
IHsKQEAgLTk1MSw3ICs5NTEsNyBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9t
YWluICpkLCBnZm5fdCBnZm4sIG1mbl90IG1mbiwKICAgICAgICAgICAgICAgICBQMk1fREVCVUco
Im9sZCBnZm49JSNseCAtPiBtZm4gJSNseFxuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
Z2ZuX3gob2dmbikgLCBtZm5feChvbWZuKSk7CiAgICAgICAgICAgICAgICAgaWYgKCBtZm5fZXEo
b21mbiwgbWZuX2FkZChtZm4sIGkpKSApCi0gICAgICAgICAgICAgICAgICAgIHAybV9yZW1vdmVf
cGFnZShwMm0sIGdmbl94KG9nZm4pLCBtZm5feChtZm5fYWRkKG1mbiwgaSkpLAorICAgICAgICAg
ICAgICAgICAgICBwMm1fcmVtb3ZlX3BhZ2UocDJtLCBnZm5feChvZ2ZuKSwgbWZuX2FkZChtZm4s
IGkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCk7CiAgICAgICAgICAg
ICB9CiAgICAgICAgIH0KQEAgLTk2OCw4ICs5NjgsOCBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRy
eShzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIG1mbl90IG1mbiwKICAgICAgICAgaWYgKCAh
cDJtX2lzX2dyYW50KHQpICkKICAgICAgICAgewogICAgICAgICAgICAgZm9yICggaSA9IDA7IGkg
PCAoMVVMIDw8IHBhZ2Vfb3JkZXIpOyBpKysgKQotICAgICAgICAgICAgICAgIHNldF9ncGZuX2Zy
b21fbWZuKG1mbl94KG1mbl9hZGQobWZuLCBpKSksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZ2ZuX3goZ2ZuX2FkZChnZm4sIGkpKSk7CisgICAgICAgICAgICAgICAgc2V0X3Bm
bl9mcm9tX21mbihtZm5fYWRkKG1mbiwgaSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBnZm5feChnZm5fYWRkKGdmbiwgaSkpKTsKICAgICAgICAgfQogICAgIH0KICAgICBlbHNl
CkBAIC0xMjcyLDcgKzEyNzIsNyBAQCBzdGF0aWMgaW50IHNldF90eXBlZF9wMm1fZW50cnkoc3Ry
dWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwKICAgICAgICAgZm9yICggaSA9IDA7
IGkgPCAoMVVMIDw8IG9yZGVyKTsgKytpICkKICAgICAgICAgewogICAgICAgICAgICAgQVNTRVJU
KG1mbl92YWxpZChtZm5fYWRkKG9tZm4sIGkpKSk7Ci0gICAgICAgICAgICBzZXRfZ3Bmbl9mcm9t
X21mbihtZm5feChvbWZuKSArIGksIElOVkFMSURfTTJQX0VOVFJZKTsKKyAgICAgICAgICAgIHNl
dF9wZm5fZnJvbV9tZm4obWZuX2FkZChvbWZuLCBpKSwgSU5WQUxJRF9NMlBfRU5UUlkpOwogICAg
ICAgICB9CiAgICAgfQogCkBAIC0xNDY3LDcgKzE0NjcsNyBAQCBpbnQgc2V0X3NoYXJlZF9wMm1f
ZW50cnkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwgbWZuX3QgbWZuKQog
ICAgIHBnX3R5cGUgPSByZWFkX2F0b21pYygmKG1mbl90b19wYWdlKG9tZm4pLT51LmludXNlLnR5
cGVfaW5mbykpOwogICAgIGlmICggKHBnX3R5cGUgJiBQR1RfY291bnRfbWFzaykgPT0gMAogICAg
ICAgICAgfHwgKHBnX3R5cGUgJiBQR1RfdHlwZV9tYXNrKSAhPSBQR1Rfc2hhcmVkX3BhZ2UgKQot
ICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm5feChvbWZuKSwgSU5WQUxJRF9NMlBfRU5UUlkp
OworICAgICAgICBzZXRfcGZuX2Zyb21fbWZuKG9tZm4sIElOVkFMSURfTTJQX0VOVFJZKTsKIAog
ICAgIFAyTV9ERUJVRygic2V0IHNoYXJlZCAlbHggJWx4XG4iLCBnZm5fbCwgbWZuX3gobWZuKSk7
CiAgICAgcmMgPSBwMm1fc2V0X2VudHJ5KHAybSwgZ2ZuLCBtZm4sIFBBR0VfT1JERVJfNEssIHAy
bV9yYW1fc2hhcmVkLApAQCAtMTgyMSw3ICsxODIxLDcgQEAgaW50IHAybV9tZW1fcGFnaW5nX3By
ZXAoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm5fbCwgdWludDY0X3QgYnVmZmVy
KQogICAgIHJldCA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwgUEFHRV9PUkRFUl80SywK
ICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2luZ19tb2RlX2xvZ19kaXJ0eShkKSA/IHAybV9y
YW1fbG9nZGlydHkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA6IHAybV9yYW1fcncsIGEpOwotICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG1mbiks
IGdmbl9sKTsKKyAgICBzZXRfcGZuX2Zyb21fbWZuKG1mbiwgZ2ZuX2wpOwogCiAgICAgaWYgKCAh
cGFnZV9leHRhbnQgKQogICAgICAgICBhdG9taWNfZGVjKCZkLT5wYWdlZF9wYWdlcyk7CkBAIC0x
ODcyLDcgKzE4NzIsNyBAQCB2b2lkIHAybV9tZW1fcGFnaW5nX3Jlc3VtZShzdHJ1Y3QgZG9tYWlu
ICpkLCB2bV9ldmVudF9yZXNwb25zZV90ICpyc3ApCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHAybV9yYW1fcncsIGEpOwogCiAgICAgICAgICAgICBpZiAoICFyYyApCi0gICAg
ICAgICAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuX3gobWZuKSwgZ2ZuX3goZ2ZuKSk7Cisg
ICAgICAgICAgICAgICAgc2V0X3Bmbl9mcm9tX21mbihtZm4sIGdmbl94KGdmbikpOwogICAgICAg
ICB9CiAgICAgICAgIGdmbl91bmxvY2socDJtLCBnZm4sIDApOwogICAgIH0KQEAgLTI2MzUsNyAr
MjYzNSw3IEBAIGludCBwMm1fY2hhbmdlX2FsdHAybV9nZm4oc3RydWN0IGRvbWFpbiAqZCwgdW5z
aWduZWQgaW50IGlkeCwKICAgICBpZiAoIGdmbl9lcShuZXdfZ2ZuLCBJTlZBTElEX0dGTikgKQog
ICAgIHsKICAgICAgICAgaWYgKCBtZm5fdmFsaWQobWZuKSApCi0gICAgICAgICAgICBwMm1fcmVt
b3ZlX3BhZ2UoYXAybSwgZ2ZuX3gob2xkX2dmbiksIG1mbl94KG1mbiksIFBBR0VfT1JERVJfNEsp
OworICAgICAgICAgICAgcDJtX3JlbW92ZV9wYWdlKGFwMm0sIGdmbl94KG9sZF9nZm4pLCBtZm4s
IFBBR0VfT1JERVJfNEspOwogICAgICAgICByYyA9IDA7CiAgICAgICAgIGdvdG8gb3V0OwogICAg
IH0KQEAgLTI3NzIsOCArMjc3Miw4IEBAIHZvaWQgYXVkaXRfcDJtKHN0cnVjdCBkb21haW4gKmQs
CiB7CiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZTsKICAgICBzdHJ1Y3QgZG9tYWluICpvZDsK
LSAgICB1bnNpZ25lZCBsb25nIG1mbiwgZ2ZuOwotICAgIG1mbl90IHAybWZuOworICAgIHVuc2ln
bmVkIGxvbmcgZ2ZuOworICAgIG1mbl90IHAybWZuLCBtZm47CiAgICAgdW5zaWduZWQgbG9uZyBv
cnBoYW5zX2NvdW50ID0gMCwgbXBiYWQgPSAwLCBwbWJhZCA9IDA7CiAgICAgcDJtX2FjY2Vzc190
IHAybWE7CiAgICAgcDJtX3R5cGVfdCB0eXBlOwpAQCAtMjc5NSw1NCArMjc5NSw1NCBAQCB2b2lk
IGF1ZGl0X3AybShzdHJ1Y3QgZG9tYWluICpkLAogICAgIHNwaW5fbG9jaygmZC0+cGFnZV9hbGxv
Y19sb2NrKTsKICAgICBwYWdlX2xpc3RfZm9yX2VhY2ggKCBwYWdlLCAmZC0+cGFnZV9saXN0ICkK
ICAgICB7Ci0gICAgICAgIG1mbiA9IG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKTsKKyAgICAgICAg
bWZuID0gcGFnZV90b19tZm4ocGFnZSk7CiAKLSAgICAgICAgUDJNX1BSSU5USygiYXVkaXRpbmcg
Z3Vlc3QgcGFnZSwgbWZuPSUjbHhcbiIsIG1mbik7CisgICAgICAgIFAyTV9QUklOVEsoImF1ZGl0
aW5nIGd1ZXN0IHBhZ2UsIG1mbj0lIlBSSV9tZm4iXG4iLCBtZm5feChtZm4pKTsKIAogICAgICAg
ICBvZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogCiAgICAgICAgIGlmICggb2QgIT0gZCApCiAg
ICAgICAgIHsKLSAgICAgICAgICAgIFAyTV9QUklOVEsoIndyb25nIG93bmVyICUjbHggLT4gJXAo
JXUpICE9ICVwKCV1KVxuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgbWZuLCBvZCwgKG9kP29k
LT5kb21haW5faWQ6LTEpLCBkLCBkLT5kb21haW5faWQpOworICAgICAgICAgICAgUDJNX1BSSU5U
Sygid3Jvbmcgb3duZXIgJSJQUklfbWZuIiAtPiAlcCgldSkgIT0gJXAoJXUpXG4iLAorICAgICAg
ICAgICAgICAgICAgICAgICBtZm5feChtZm4pLCBvZCwgKG9kP29kLT5kb21haW5faWQ6LTEpLCBk
LCBkLT5kb21haW5faWQpOwogICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgIH0KIAotICAg
ICAgICBnZm4gPSBnZXRfZ3Bmbl9mcm9tX21mbihtZm4pOworICAgICAgICBnZm4gPSBnZXRfcGZu
X2Zyb21fbWZuKG1mbik7CiAgICAgICAgIGlmICggZ2ZuID09IElOVkFMSURfTTJQX0VOVFJZICkK
ICAgICAgICAgewogICAgICAgICAgICAgb3JwaGFuc19jb3VudCsrOwotICAgICAgICAgICAgUDJN
X1BSSU5USygib3JwaGFuZWQgZ3Vlc3QgcGFnZTogbWZuPSUjbHggaGFzIGludmFsaWQgZ2ZuXG4i
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgbWZuKTsKKyAgICAgICAgICAgIFAyTV9QUklO
VEsoIm9ycGhhbmVkIGd1ZXN0IHBhZ2U6IG1mbj0lIlBSSV9tZm4iIGhhcyBpbnZhbGlkIGdmblxu
IiwKKyAgICAgICAgICAgICAgICAgICAgICAgbWZuX3gobWZuKSk7CiAgICAgICAgICAgICBjb250
aW51ZTsKICAgICAgICAgfQogCiAgICAgICAgIGlmICggU0hBUkVEX00yUChnZm4pICkKICAgICAg
ICAgewotICAgICAgICAgICAgUDJNX1BSSU5USygic2hhcmVkIG1mbiAoJWx4KSBvbiBkb21haW4g
cGFnZSBsaXN0IVxuIiwKLSAgICAgICAgICAgICAgICAgICAgbWZuKTsKKyAgICAgICAgICAgIFAy
TV9QUklOVEsoInNoYXJlZCBtZm4gKCUiUFJJX21mbiIpIG9uIGRvbWFpbiBwYWdlIGxpc3QhXG4i
LAorICAgICAgICAgICAgICAgICAgICAgICBtZm5feChtZm4pKTsKICAgICAgICAgICAgIGNvbnRp
bnVlOwogICAgICAgICB9CiAKICAgICAgICAgcDJtZm4gPSBnZXRfZ2ZuX3R5cGVfYWNjZXNzKHAy
bSwgZ2ZuLCAmdHlwZSwgJnAybWEsIDAsIE5VTEwpOwotICAgICAgICBpZiAoIG1mbl94KHAybWZu
KSAhPSBtZm4gKQorICAgICAgICBpZiAoICFtZm5fZXEocDJtZm4sIG1mbikgKQogICAgICAgICB7
CiAgICAgICAgICAgICBtcGJhZCsrOwotICAgICAgICAgICAgUDJNX1BSSU5USygibWFwIG1pc21h
dGNoIG1mbiAlI2x4IC0+IGdmbiAlI2x4IC0+IG1mbiAlI2x4IgorICAgICAgICAgICAgUDJNX1BS
SU5USygibWFwIG1pc21hdGNoIG1mbiAlIlBSSV9tZm4iIC0+IGdmbiAlI2x4IC0+IG1mbiAlIlBS
SV9tZm4iIgogICAgICAgICAgICAgICAgICAgICAgICAiICgtPiBnZm4gJSNseClcbiIsCi0gICAg
ICAgICAgICAgICAgICAgICAgIG1mbiwgZ2ZuLCBtZm5feChwMm1mbiksCisgICAgICAgICAgICAg
ICAgICAgICAgIG1mbl94KG1mbiksIGdmbiwgbWZuX3gocDJtZm4pLAogICAgICAgICAgICAgICAg
ICAgICAgICAobWZuX3ZhbGlkKHAybWZuKQotICAgICAgICAgICAgICAgICAgICAgICAgPyBnZXRf
Z3Bmbl9mcm9tX21mbihtZm5feChwMm1mbikpCisgICAgICAgICAgICAgICAgICAgICAgICA/IGdl
dF9wZm5fZnJvbV9tZm4ocDJtZm4pCiAgICAgICAgICAgICAgICAgICAgICAgICA6IC0xdSkpOwog
ICAgICAgICAgICAgLyogVGhpcyBtMnAgZW50cnkgaXMgc3RhbGU6IHRoZSBkb21haW4gaGFzIGFu
b3RoZXIgZnJhbWUgaW4KICAgICAgICAgICAgICAqIHRoaXMgcGh5c2ljYWwgc2xvdC4gIE5vIGdy
ZWF0IGRpc2FzdGVyLCBidXQgZm9yIG5lYXRuZXNzLAogICAgICAgICAgICAgICogYmxvdyBhd2F5
IHRoZSBtMnAgZW50cnkuICovCi0gICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm4sIElO
VkFMSURfTTJQX0VOVFJZKTsKKyAgICAgICAgICAgIHNldF9wZm5fZnJvbV9tZm4obWZuLCBJTlZB
TElEX00yUF9FTlRSWSk7CiAgICAgICAgIH0KICAgICAgICAgX19wdXRfZ2ZuKHAybSwgZ2ZuKTsK
IAotICAgICAgICBQMk1fUFJJTlRLKCJPSzogbWZuPSUjbHgsIGdmbj0lI2x4LCBwMm1mbj0lI2x4
XG4iLAotICAgICAgICAgICAgICAgICAgICAgICBtZm4sIGdmbiwgbWZuX3gocDJtZm4pKTsKKyAg
ICAgICAgUDJNX1BSSU5USygiT0s6IG1mbj0lIlBSSV9tZm4iLCBnZm49JSNseCwgcDJtZm49JSJQ
UklfbWZuIlxuIiwKKyAgICAgICAgICAgICAgICAgICBtZm5feChtZm4pLCBnZm4sIG1mbl94KHAy
bWZuKSk7CiAgICAgfQogICAgIHNwaW5fdW5sb2NrKCZkLT5wYWdlX2FsbG9jX2xvY2spOwogCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcGFnaW5nLmMgYi94ZW4vYXJjaC94ODYvbW0vcGFn
aW5nLmMKaW5kZXggOWIwZjI2OGU3NC4uY2VmMmY5MDE4NiAxMDA2NDQKLS0tIGEveGVuL2FyY2gv
eDg2L21tL3BhZ2luZy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wYWdpbmcuYwpAQCAtMzQ0LDcg
KzM0NCw3IEBAIHZvaWQgcGFnaW5nX21hcmtfZGlydHkoc3RydWN0IGRvbWFpbiAqZCwgbWZuX3Qg
Z21mbikKICAgICAgICAgcmV0dXJuOwogCiAgICAgLyogV2UgL3JlYWxseS8gbWVhbiBQRk4gaGVy
ZSwgZXZlbiBmb3Igbm9uLXRyYW5zbGF0ZWQgZ3Vlc3RzLiAqLwotICAgIHBmbiA9IF9wZm4oZ2V0
X2dwZm5fZnJvbV9tZm4obWZuX3goZ21mbikpKTsKKyAgICBwZm4gPSBfcGZuKGdldF9wZm5fZnJv
bV9tZm4oZ21mbikpOwogCiAgICAgcGFnaW5nX21hcmtfcGZuX2RpcnR5KGQsIHBmbik7CiB9CkBA
IC0zNjIsNyArMzYyLDcgQEAgaW50IHBhZ2luZ19tZm5faXNfZGlydHkoc3RydWN0IGRvbWFpbiAq
ZCwgbWZuX3QgZ21mbikKICAgICBBU1NFUlQocGFnaW5nX21vZGVfbG9nX2RpcnR5KGQpKTsKIAog
ICAgIC8qIFdlIC9yZWFsbHkvIG1lYW4gUEZOIGhlcmUsIGV2ZW4gZm9yIG5vbi10cmFuc2xhdGVk
IGd1ZXN0cy4gKi8KLSAgICBwZm4gPSBfcGZuKGdldF9ncGZuX2Zyb21fbWZuKG1mbl94KGdtZm4p
KSk7CisgICAgcGZuID0gX3BmbihnZXRfcGZuX2Zyb21fbWZuKGdtZm4pKTsKICAgICAvKiBJbnZh
bGlkIHBhZ2VzIGNhbid0IGJlIGRpcnR5LiAqLwogICAgIGlmICggdW5saWtlbHkoIVZBTElEX00y
UChwZm5feChwZm4pKSkgKQogICAgICAgICByZXR1cm4gMDsKZGlmZiAtLWdpdCBhL3hlbi9hcmNo
L3g4Ni9wdi9kb20wX2J1aWxkLmMgYi94ZW4vYXJjaC94ODYvcHYvZG9tMF9idWlsZC5jCmluZGV4
IGNlZjJkNDIyNTQuLmIzOWFiNjcwOTIgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9kb20w
X2J1aWxkLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2RvbTBfYnVpbGQuYwpAQCAtMzksNyArMzks
NyBAQCB2b2lkIF9faW5pdCBkb20wX3VwZGF0ZV9waHlzbWFwKHN0cnVjdCBkb21haW4gKmQsIHVu
c2lnbmVkIGxvbmcgcGZuLAogICAgIGVsc2UKICAgICAgICAgKCh1bnNpZ25lZCBpbnQgKil2cGh5
c21hcF9zKVtwZm5dID0gbWZuOwogCi0gICAgc2V0X2dwZm5fZnJvbV9tZm4obWZuLCBwZm4pOwor
ICAgIHNldF9wZm5fZnJvbV9tZm4oX21mbihtZm4pLCBwZm4pOwogfQogCiBzdGF0aWMgX19pbml0
IHZvaWQgbWFya19wdl9wdF9wYWdlc19yZG9ubHkoc3RydWN0IGRvbWFpbiAqZCwKQEAgLTc5OCw4
ICs3OTgsOCBAQCBpbnQgX19pbml0IGRvbTBfY29uc3RydWN0X3B2KHN0cnVjdCBkb21haW4gKmQs
CiAgICAgcGFnZV9saXN0X2Zvcl9lYWNoICggcGFnZSwgJmQtPnBhZ2VfbGlzdCApCiAgICAgewog
ICAgICAgICBtZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7Ci0gICAgICAgIEJVR19PTihT
SEFSRURfTTJQKGdldF9ncGZuX2Zyb21fbWZuKG1mbikpKTsKLSAgICAgICAgaWYgKCBnZXRfZ3Bm
bl9mcm9tX21mbihtZm4pID49IGNvdW50ICkKKyAgICAgICAgQlVHX09OKFNIQVJFRF9NMlAoZ2V0
X3Bmbl9mcm9tX21mbihfbWZuKG1mbikpKSk7CisgICAgICAgIGlmICggZ2V0X3Bmbl9mcm9tX21m
bihfbWZuKG1mbikpID49IGNvdW50ICkKICAgICAgICAgewogICAgICAgICAgICAgQlVHX09OKGlz
X3B2XzMyYml0X2RvbWFpbihkKSk7CiAgICAgICAgICAgICBpZiAoICFwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmJgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3g4Nl82NC90cmFwcy5jIGIveGVu
L2FyY2gveDg2L3g4Nl82NC90cmFwcy5jCmluZGV4IDQ0YWY3NjVlM2UuLmY4MGYyMjUwZmUgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni94ODZfNjQvdHJhcHMuYworKysgYi94ZW4vYXJjaC94ODYv
eDg2XzY0L3RyYXBzLmMKQEAgLTE4NCw3ICsxODQsOCBAQCB2b2lkIHZjcHVfc2hvd19yZWdpc3Rl
cnMoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiAKIHZvaWQgc2hvd19wYWdlX3dhbGsodW5zaWduZWQg
bG9uZyBhZGRyKQogewotICAgIHVuc2lnbmVkIGxvbmcgcGZuLCBtZm4gPSByZWFkX2NyMygpID4+
IFBBR0VfU0hJRlQ7CisgICAgdW5zaWduZWQgbG9uZyBwZm47CisgICAgbWZuX3QgbWZuID0gbWFk
ZHJfdG9fbWZuKHJlYWRfY3IzKCkpOwogICAgIGw0X3BnZW50cnlfdCBsNGUsICpsNHQ7CiAgICAg
bDNfcGdlbnRyeV90IGwzZSwgKmwzdDsKICAgICBsMl9wZ2VudHJ5X3QgbDJlLCAqbDJ0OwpAQCAt
MTk0LDUyICsxOTUsNTIgQEAgdm9pZCBzaG93X3BhZ2Vfd2Fsayh1bnNpZ25lZCBsb25nIGFkZHIp
CiAgICAgaWYgKCAhaXNfY2Fub25pY2FsX2FkZHJlc3MoYWRkcikgKQogICAgICAgICByZXR1cm47
CiAKLSAgICBsNHQgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihtZm4pKTsKKyAgICBsNHQgPSBtYXBf
ZG9tYWluX3BhZ2UobWZuKTsKICAgICBsNGUgPSBsNHRbbDRfdGFibGVfb2Zmc2V0KGFkZHIpXTsK
ICAgICB1bm1hcF9kb21haW5fcGFnZShsNHQpOwotICAgIG1mbiA9IGw0ZV9nZXRfcGZuKGw0ZSk7
Ci0gICAgcGZuID0gbWZuX3ZhbGlkKF9tZm4obWZuKSkgJiYgbWFjaGluZV90b19waHlzX21hcHBp
bmdfdmFsaWQgPwotICAgICAgICAgIGdldF9ncGZuX2Zyb21fbWZuKG1mbikgOiBJTlZBTElEX00y
UF9FTlRSWTsKKyAgICBtZm4gPSBsNGVfZ2V0X21mbihsNGUpOworICAgIHBmbiA9IG1mbl92YWxp
ZChtZm4pICYmIG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nX3ZhbGlkID8KKyAgICAgICAgICBnZXRf
cGZuX2Zyb21fbWZuKG1mbikgOiBJTlZBTElEX00yUF9FTlRSWTsKICAgICBwcmludGsoIiBMNFsw
eCUwM2x4XSA9ICUiUFJJcHRlIiAlMDE2bHhcbiIsCiAgICAgICAgICAgIGw0X3RhYmxlX29mZnNl
dChhZGRyKSwgbDRlX2dldF9pbnRwdGUobDRlKSwgcGZuKTsKICAgICBpZiAoICEobDRlX2dldF9m
bGFncyhsNGUpICYgX1BBR0VfUFJFU0VOVCkgfHwKLSAgICAgICAgICFtZm5fdmFsaWQoX21mbiht
Zm4pKSApCisgICAgICAgICAhbWZuX3ZhbGlkKG1mbikgKQogICAgICAgICByZXR1cm47CiAKLSAg
ICBsM3QgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihtZm4pKTsKKyAgICBsM3QgPSBtYXBfZG9tYWlu
X3BhZ2UobWZuKTsKICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KGFkZHIpXTsKICAgICB1
bm1hcF9kb21haW5fcGFnZShsM3QpOwotICAgIG1mbiA9IGwzZV9nZXRfcGZuKGwzZSk7Ci0gICAg
cGZuID0gbWZuX3ZhbGlkKF9tZm4obWZuKSkgJiYgbWFjaGluZV90b19waHlzX21hcHBpbmdfdmFs
aWQgPwotICAgICAgICAgIGdldF9ncGZuX2Zyb21fbWZuKG1mbikgOiBJTlZBTElEX00yUF9FTlRS
WTsKKyAgICBtZm4gPSBsM2VfZ2V0X21mbihsM2UpOworICAgIHBmbiA9IG1mbl92YWxpZChtZm4p
ICYmIG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nX3ZhbGlkID8KKyAgICAgICAgICBnZXRfcGZuX2Zy
b21fbWZuKG1mbikgOiBJTlZBTElEX00yUF9FTlRSWTsKICAgICBwcmludGsoIiBMM1sweCUwM2x4
XSA9ICUiUFJJcHRlIiAlMDE2bHglc1xuIiwKICAgICAgICAgICAgbDNfdGFibGVfb2Zmc2V0KGFk
ZHIpLCBsM2VfZ2V0X2ludHB0ZShsM2UpLCBwZm4sCiAgICAgICAgICAgIChsM2VfZ2V0X2ZsYWdz
KGwzZSkgJiBfUEFHRV9QU0UpID8gIiAoUFNFKSIgOiAiIik7CiAgICAgaWYgKCAhKGwzZV9nZXRf
ZmxhZ3MobDNlKSAmIF9QQUdFX1BSRVNFTlQpIHx8CiAgICAgICAgICAobDNlX2dldF9mbGFncyhs
M2UpICYgX1BBR0VfUFNFKSB8fAotICAgICAgICAgIW1mbl92YWxpZChfbWZuKG1mbikpICkKKyAg
ICAgICAgICFtZm5fdmFsaWQobWZuKSApCiAgICAgICAgIHJldHVybjsKIAotICAgIGwydCA9IG1h
cF9kb21haW5fcGFnZShfbWZuKG1mbikpOworICAgIGwydCA9IG1hcF9kb21haW5fcGFnZShtZm4p
OwogICAgIGwyZSA9IGwydFtsMl90YWJsZV9vZmZzZXQoYWRkcildOwogICAgIHVubWFwX2RvbWFp
bl9wYWdlKGwydCk7Ci0gICAgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKLSAgICBwZm4gPSBtZm5f
dmFsaWQoX21mbihtZm4pKSAmJiBtYWNoaW5lX3RvX3BoeXNfbWFwcGluZ192YWxpZCA/Ci0gICAg
ICAgICAgZ2V0X2dwZm5fZnJvbV9tZm4obWZuKSA6IElOVkFMSURfTTJQX0VOVFJZOworICAgIG1m
biA9IGwyZV9nZXRfbWZuKGwyZSk7CisgICAgcGZuID0gbWZuX3ZhbGlkKG1mbikgJiYgbWFjaGlu
ZV90b19waHlzX21hcHBpbmdfdmFsaWQgPworICAgICAgICAgIGdldF9wZm5fZnJvbV9tZm4obWZu
KSA6IElOVkFMSURfTTJQX0VOVFJZOwogICAgIHByaW50aygiIEwyWzB4JTAzbHhdID0gJSJQUklw
dGUiICUwMTZseCVzXG4iLAogICAgICAgICAgICBsMl90YWJsZV9vZmZzZXQoYWRkciksIGwyZV9n
ZXRfaW50cHRlKGwyZSksIHBmbiwKICAgICAgICAgICAgKGwyZV9nZXRfZmxhZ3MobDJlKSAmIF9Q
QUdFX1BTRSkgPyAiIChQU0UpIiA6ICIiKTsKICAgICBpZiAoICEobDJlX2dldF9mbGFncyhsMmUp
ICYgX1BBR0VfUFJFU0VOVCkgfHwKICAgICAgICAgIChsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFH
RV9QU0UpIHx8Ci0gICAgICAgICAhbWZuX3ZhbGlkKF9tZm4obWZuKSkgKQorICAgICAgICAgIW1m
bl92YWxpZChtZm4pICkKICAgICAgICAgcmV0dXJuOwogCi0gICAgbDF0ID0gbWFwX2RvbWFpbl9w
YWdlKF9tZm4obWZuKSk7CisgICAgbDF0ID0gbWFwX2RvbWFpbl9wYWdlKG1mbik7CiAgICAgbDFl
ID0gbDF0W2wxX3RhYmxlX29mZnNldChhZGRyKV07CiAgICAgdW5tYXBfZG9tYWluX3BhZ2UobDF0
KTsKLSAgICBtZm4gPSBsMWVfZ2V0X3BmbihsMWUpOwotICAgIHBmbiA9IG1mbl92YWxpZChfbWZu
KG1mbikpICYmIG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nX3ZhbGlkID8KLSAgICAgICAgICBnZXRf
Z3Bmbl9mcm9tX21mbihtZm4pIDogSU5WQUxJRF9NMlBfRU5UUlk7CisgICAgbWZuID0gbDFlX2dl
dF9tZm4obDFlKTsKKyAgICBwZm4gPSBtZm5fdmFsaWQobWZuKSAmJiBtYWNoaW5lX3RvX3BoeXNf
bWFwcGluZ192YWxpZCA/CisgICAgICAgICAgZ2V0X3Bmbl9mcm9tX21mbihtZm4pIDogSU5WQUxJ
RF9NMlBfRU5UUlk7CiAgICAgcHJpbnRrKCIgTDFbMHglMDNseF0gPSAlIlBSSXB0ZSIgJTAxNmx4
XG4iLAogICAgICAgICAgICBsMV90YWJsZV9vZmZzZXQoYWRkciksIGwxZV9nZXRfaW50cHRlKGwx
ZSksIHBmbik7CiB9CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL21lbW9yeS5jIGIveGVuL2NvbW1v
bi9tZW1vcnkuYwppbmRleCBkNmE1ODBkYTMxLi5lZWNjOTY3MWZmIDEwMDY0NAotLS0gYS94ZW4v
Y29tbW9uL21lbW9yeS5jCisrKyBiL3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTI3Myw3ICsyNzMs
NyBAQCBzdGF0aWMgdm9pZCBwb3B1bGF0ZV9waHlzbWFwKHN0cnVjdCBtZW1vcF9hcmdzICphKQog
ICAgICAgICAgICAgaWYgKCAhcGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICBmb3IgKCBqID0gMDsgaiA8ICgxVSA8PCBhLT5leHRlbnRfb3Jk
ZXIpOyBqKysgKQotICAgICAgICAgICAgICAgICAgICBzZXRfZ3Bmbl9mcm9tX21mbihtZm5feCht
Zm5fYWRkKG1mbiwgaikpLCBncGZuICsgaik7CisgICAgICAgICAgICAgICAgICAgIHNldF9wZm5f
ZnJvbV9tZm4obWZuX2FkZChtZm4sIGopLCBncGZuICsgaik7CiAKICAgICAgICAgICAgICAgICAv
KiBJbmZvcm0gdGhlIGRvbWFpbiBvZiB0aGUgbmV3IHBhZ2UncyBtYWNoaW5lIGFkZHJlc3MuICov
IAogICAgICAgICAgICAgICAgIGlmICggdW5saWtlbHkoX19jb3B5X21mbl90b19ndWVzdF9vZmZz
ZXQoYS0+ZXh0ZW50X2xpc3QsIGksCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3BhZ2VfYWxsb2Mu
YyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCmluZGV4IDYwNjFjY2UyNGYuLmExMDBlMDNlMmUg
MTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCisrKyBiL3hlbi9jb21tb24vcGFn
ZV9hbGxvYy5jCkBAIC0xNDI0LDcgKzE0MjQsNyBAQCBzdGF0aWMgdm9pZCBmcmVlX2hlYXBfcGFn
ZXMoCiAKICAgICAgICAgLyogVGhpcyBwYWdlIGlzIG5vdCBhIGd1ZXN0IGZyYW1lIGFueSBtb3Jl
LiAqLwogICAgICAgICBwYWdlX3NldF9vd25lcigmcGdbaV0sIE5VTEwpOyAvKiBzZXRfZ3Bmbl9m
cm9tX21mbiBzbm9vcHMgcGcgb3duZXIgKi8KLSAgICAgICAgc2V0X2dwZm5fZnJvbV9tZm4obWZu
X3gobWZuKSArIGksIElOVkFMSURfTTJQX0VOVFJZKTsKKyAgICAgICAgc2V0X3Bmbl9mcm9tX21m
bihtZm5fYWRkKG1mbiwgKyBpKSwgSU5WQUxJRF9NMlBfRU5UUlkpOwogCiAgICAgICAgIGlmICgg
bmVlZF9zY3J1YiApCiAgICAgICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS1hcm0v
bW0uaCBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vbW0uaAppbmRleCBhOWNiOThhNmM3Li4zYzAzYmUz
YmNhIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20tYXJtL21tLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLWFybS9tbS5oCkBAIC0zMjIsNyArMzIyLDcgQEAgc3RydWN0IHBhZ2VfaW5mbyAqZ2V0
X3BhZ2VfZnJvbV9ndmEoc3RydWN0IHZjcHUgKnYsIHZhZGRyX3QgdmEsCiAjZGVmaW5lIFNIQVJF
RF9NMlAoX2UpICAgICAgICAgICAoKF9lKSA9PSBTSEFSRURfTTJQX0VOVFJZKQogCiAvKiBXZSBk
b24ndCBoYXZlIGEgTTJQIG9uIEFybSAqLwotI2RlZmluZSBzZXRfZ3Bmbl9mcm9tX21mbihtZm4s
IHBmbikgZG8geyAodm9pZCkgKG1mbiksICh2b2lkKShwZm4pOyB9IHdoaWxlICgwKQorc3RhdGlj
IGlubGluZSB2b2lkIHNldF9wZm5fZnJvbV9tZm4obWZuX3QgbWZuLCB1bnNpZ25lZCBsb25nIHBm
bikge30KIAogLyogQXJjaC1zcGVjaWZpYyBwb3J0aW9uIG9mIG1lbW9yeV9vcCBoeXBlcmNhbGwu
ICovCiBsb25nIGFyY2hfbWVtb3J5X29wKGludCBvcCwgWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh2
b2lkKSBhcmcpOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9ncmFudF90YWJsZS5o
IGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9ncmFudF90YWJsZS5oCmluZGV4IDY2MTIyOGRkMzkuLmQ3
MzFiOWU0OWYgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvZ3JhbnRfdGFibGUuaAor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2dyYW50X3RhYmxlLmgKQEAgLTQxLDcgKzQxLDcgQEAg
c3RhdGljIGlubGluZSBpbnQgcmVwbGFjZV9ncmFudF9ob3N0X21hcHBpbmcodWludDY0X3QgYWRk
ciwgbWZuX3QgZnJhbWUsCiAjZGVmaW5lIGdudHRhYl9nZXRfZnJhbWVfZ2ZuKGd0LCBzdCwgaWR4
KSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIG1mbl90IG1mbl8gPSAoc3Qp
ID8gZ250dGFiX3N0YXR1c19tZm4oZ3QsIGlkeCkgICAgICAgICAgICAgICAgICAgICAgIFwKICAg
ICAgICAgICAgICAgICAgICAgICA6IGdudHRhYl9zaGFyZWRfbWZuKGd0LCBpZHgpOyAgICAgICAg
ICAgICAgICAgICAgICBcCi0gICAgdW5zaWduZWQgbG9uZyBncGZuXyA9IGdldF9ncGZuX2Zyb21f
bWZuKG1mbl94KG1mbl8pKTsgICAgICAgICAgICAgICAgXAorICAgIHVuc2lnbmVkIGxvbmcgZ3Bm
bl8gPSBnZXRfcGZuX2Zyb21fbWZuKG1mbl8pOyAgICAgICAgICAgICAgICAgICAgICAgIFwKICAg
ICBWQUxJRF9NMlAoZ3Bmbl8pID8gX2dmbihncGZuXykgOiBJTlZBTElEX0dGTjsgICAgICAgICAg
ICAgICAgICAgICAgICBcCiB9KQogCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKaW5kZXggNDcyMTcyNWM2MC4uYmNlNjA2MTlj
MyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCisrKyBiL3hlbi9pbmNsdWRl
L2FzbS14ODYvbW0uaApAQCAtNDkyLDIyICs0OTIsMjYgQEAgZXh0ZXJuIHN0cnVjdCBkb21haW4g
KmRvbV94ZW4sICpkb21faW8sICpkb21fY293OwkvKiBmb3Igdm1jb3JlaW5mbyAqLwogICovCiBl
eHRlcm4gYm9vbCBtYWNoaW5lX3RvX3BoeXNfbWFwcGluZ192YWxpZDsKIAotc3RhdGljIGlubGlu
ZSB2b2lkIHNldF9ncGZuX2Zyb21fbWZuKHVuc2lnbmVkIGxvbmcgbWZuLCB1bnNpZ25lZCBsb25n
IHBmbikKK3N0YXRpYyBpbmxpbmUgdm9pZCBzZXRfcGZuX2Zyb21fbWZuKG1mbl90IG1mbiwgdW5z
aWduZWQgbG9uZyBwZm4pCiB7Ci0gICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVy
KG1mbl90b19wYWdlKF9tZm4obWZuKSkpOworICAgIGNvbnN0IHVuc2lnbmVkIGxvbmcgbWZuXyA9
IG1mbl94KG1mbik7CisgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKG1mbl90
b19wYWdlKG1mbikpOwogICAgIHVuc2lnbmVkIGxvbmcgZW50cnkgPSAoZCAmJiAoZCA9PSBkb21f
Y293KSkgPyBTSEFSRURfTTJQX0VOVFJZIDogcGZuOwogCiAgICAgaWYgKCFtYWNoaW5lX3RvX3Bo
eXNfbWFwcGluZ192YWxpZCkKICAgICAgICAgcmV0dXJuOwogCi0gICAgaWYgKCBtZm4gPj0gKFJE
V1JfQ09NUEFUX01QVF9WSVJUX0VORCAtIFJEV1JfQ09NUEFUX01QVF9WSVJUX1NUQVJUKSAvIDQg
KQotICAgICAgICBjb21wYXRfbWFjaGluZV90b19waHlzX21hcHBpbmdbbWZuXSA9IGVudHJ5Owot
ICAgIG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nW21mbl0gPSBlbnRyeTsKKyAgICBpZiAoIG1mbl8g
Pj0gKFJEV1JfQ09NUEFUX01QVF9WSVJUX0VORCAtIFJEV1JfQ09NUEFUX01QVF9WSVJUX1NUQVJU
KSAvIDQgKQorICAgICAgICBjb21wYXRfbWFjaGluZV90b19waHlzX21hcHBpbmdbbWZuX10gPSBl
bnRyeTsKKyAgICBtYWNoaW5lX3RvX3BoeXNfbWFwcGluZ1ttZm5fXSA9IGVudHJ5OwogfQogCiBl
eHRlcm4gc3RydWN0IHJhbmdlc2V0ICptbWlvX3JvX3JhbmdlczsKIAotI2RlZmluZSBnZXRfZ3Bm
bl9mcm9tX21mbihtZm4pICAgICAgKG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nWyhtZm4pXSkKK3N0
YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBnZXRfcGZuX2Zyb21fbWZuKG1mbl90IG1mbikKK3sK
KyAgICByZXR1cm4gbWFjaGluZV90b19waHlzX21hcHBpbmdbbWZuX3gobWZuKV07Cit9CiAKICNk
ZWZpbmUgY29tcGF0X3Bmbl90b19jcjMocGZuKSAoKCh1bnNpZ25lZCkocGZuKSA8PCAxMikgfCAo
KHVuc2lnbmVkKShwZm4pID4+IDIwKSkKICNkZWZpbmUgY29tcGF0X2NyM190b19wZm4oY3IzKSAo
KCh1bnNpZ25lZCkoY3IzKSA+PiAxMikgfCAoKHVuc2lnbmVkKShjcjMpIDw8IDIwKSkKZGlmZiAt
LWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmggYi94ZW4vaW5jbHVkZS9hc20teDg2L3Ay
bS5oCmluZGV4IDAxNTc1NjhiZTkuLjA3YjdlYzZkYjAgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRl
L2FzbS14ODYvcDJtLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9wMm0uaApAQCAtNTA5LDcg
KzUwOSw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHBhZ2VfaW5mbyAqZ2V0X3BhZ2VfZnJvbV9n
Zm4oCiBzdGF0aWMgaW5saW5lIGdmbl90IG1mbl90b19nZm4oY29uc3Qgc3RydWN0IGRvbWFpbiAq
ZCwgbWZuX3QgbWZuKQogewogICAgIGlmICggcGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkKLSAg
ICAgICAgcmV0dXJuIF9nZm4oZ2V0X2dwZm5fZnJvbV9tZm4obWZuX3gobWZuKSkpOworICAgICAg
ICByZXR1cm4gX2dmbihnZXRfcGZuX2Zyb21fbWZuKG1mbikpOwogICAgIGVsc2UKICAgICAgICAg
cmV0dXJuIF9nZm4obWZuX3gobWZuKSk7CiB9Ci0tIAoyLjExLjAKCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhl
bi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3Jn
L21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

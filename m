Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 7A838E4981
	for <lists+xen-devel@lfdr.de>; Fri, 25 Oct 2019 13:13:05 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iNxUS-0001dn-11; Fri, 25 Oct 2019 11:10:44 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=PbB1=YS=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iNxUQ-0001dV-FH
 for xen-devel@lists.xen.org; Fri, 25 Oct 2019 11:10:42 +0000
X-Inumbo-ID: 136f2170-f718-11e9-94c4-12813bfff9fa
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 136f2170-f718-11e9-94c4-12813bfff9fa;
 Fri, 25 Oct 2019 11:10:39 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUH-0001Vt-79; Fri, 25 Oct 2019 11:10:33 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUH-0002hA-3u; Fri, 25 Oct 2019 11:10:33 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iNxUH-0002hA-3u@xenbits.xenproject.org>
Date: Fri, 25 Oct 2019 11:10:33 +0000
Subject: [Xen-devel] Xen Security Advisory 287 v3 (CVE-2019-17342) - x86:
 steal_page violates page_struct access discipline
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-17342 / XSA-287
                              version 3

         x86: steal_page violates page_struct access discipline

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

Xen's reference counting rules were designed to allow pages to change
owner and state without requiring a global lock.  Each page has a page
structure, and a very specific set of access disciplines must be
observed to ensure that pages are freed properly, and that no writable
mappings exist for PV pagetable pages.

Unfortunately, when the XENMEM_exchange hypercall was introduced,
these access disciplines were violated, opening up several potential
race conditions.

IMPACT
======

A single PV guest can leak arbitrary amounts of memory, leading to a
denial of service.

A cooperating pair of PV and HVM/PVH guests can get a writable
pagetable entry, leading to information disclosure or privilege
escalation.

Privilege escalation attacks using only a single PV guest or a pair of
PV guests have not been ruled out.

Note that both of these attacks require very precise timing, which may
be difficult to exploit in practice.

VULNERABLE SYSTEMS
==================

Only x86 systems are vulnerable.

Only systems which run PV guests are vulnerable.  Systems which run
only HVM/PVH guests are not vulnerable.

MITIGATION
==========

Running only HVM or PVH guests will avoid these vulnerabilities.

CREDITS
=======

This issue was discovered by Jan Beulich of SUSE.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa287.patch           xen-unstable
xsa287-4.11.patch      Xen 4.11.x
xsa287-4.10.patch      Xen 4.10.x
xsa287-4.9.patch       Xen 4.9.x
xsa287-4.8.patch       Xen 4.8.x
xsa287-4.7.patch       Xen 4.7.x

$ sha256sum xsa287*
ae2b9261e26df871693478629c63970ba30817ee1dcb2266b89d8b067833c1b3  xsa287.meta
7de1b886d69dd7c497f88d41adf9a6f7cf9a305fd8ae9d714e1125e2a22208ab  xsa287.patch
55f40f2f9bb41c85ac80dac775352e28b25fada80dae574e9d10300d5e2b91ce  xsa287-4.7.patch
57312ff131eb6b51235723e862adf42ad3529ed13135375875c054fa0b55f80b  xsa287-4.8.patch
34f4b835766a38bcf4066ccbab74676eda176e15ed2a6bd7884678a64507f89a  xsa287-4.9.patch
c7eaf8a325011dda84b02ee097ddbc7b5f2f4d3399de545a3a7b14e2d23f4278  xsa287-4.10.patch
6793315f714a249a4fad12b36559640b2f97f19f5b85f0d58694c6e78aa3d567  xsa287-4.11.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl2y18cMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZMbcIAKcMpCX29ANW9/W2cnGremzicicGAQW9KvmZVK5e
weLBItv9pTqIGeVm71/X2dXt5KeRryh+Py53zYtUhy4pFQXQAezEzlRs+Y4TtX3l
+XVsfDFqks+bfyduBKMerwJpqr2Hd3DOdvir8iSqH2jHLLd5JqTYho+m0L0HPD9J
Smn43rwurMChSjSFR4H+TnrOcX/1iUWgj3BVUkswGn3CrUdBJFe5mp6QeoYlyiL1
CN6rmx5+CWLvBTwMkEiA8/3GX322qv4f2P0woOnaFW+aNgj1VRcyB2l1V0ParYYw
0Yfj32XNIhdzNfUanenRAUNnTYSzVFFdbTMgV2sgwZjXNgE=
=7jA5
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa287.meta"
Content-Disposition: attachment; filename="xsa287.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyODcsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIsCiAgICAiNC45IiwK
ICAgICI0LjgiLAogICAgIjQuNyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4
ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICJhMDE2YjhmMjA3YzdhM2ZlOGJkZDJiNmY3YzA4MDAyMGUzZTFj
ODIzIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAyODQs
CiAgICAgICAgICAgIDI4NQogICAgICAgICAgXSwKICAgICAgICAgICJQYXRj
aGVzIjogWwogICAgICAgICAgICAieHNhMjg3LTQuMTAucGF0Y2giCiAgICAg
ICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTEiOiB7
CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAg
ICAiU3RhYmxlUmVmIjogIjg3ZjUxYmYzNjZjYTc5Yjk4ZTFlMjAxYmY5YmQ3
YTljMTY0NjMxZTIiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAg
ICAgIDI4NCwKICAgICAgICAgICAgMjg1CiAgICAgICAgICBdLAogICAgICAg
ICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EyODctNC4xMS5wYXRj
aCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAi
NC43IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewog
ICAgICAgICAgIlN0YWJsZVJlZiI6ICI3MTBjYzA5Njk3MTAxOWJjMmU1YTlh
YWJiOWFmMWFjY2EwYjViOWU3IiwKICAgICAgICAgICJQcmVyZXFzIjogWwog
ICAgICAgICAgICAyODQsCiAgICAgICAgICAgIDI4NQogICAgICAgICAgXSwK
ICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNhMjg3LTQu
Ny5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0s
CiAgICAiNC44IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICI5MDhlNzY4ZmFlNDlhOGRi
MDA4OWU2ODE4ODY1MjA3OWUzYmZhYTY2IiwKICAgICAgICAgICJQcmVyZXFz
IjogWwogICAgICAgICAgICAyODQsCiAgICAgICAgICAgIDI4NQogICAgICAg
ICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNh
Mjg3LTQuOC5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0K
ICAgIH0sCiAgICAiNC45IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAg
ICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICJmNWFjZjk3ZjY2
OWM2YmM5NjkxZTAzNzcxYWQwNjcwM2RhNzdlMGQ1IiwKICAgICAgICAgICJQ
cmVyZXFzIjogWwogICAgICAgICAgICAyODQsCiAgICAgICAgICAgIDI4NQog
ICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAg
ICAieHNhMjg3LTQuOS5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAg
ICAgIH0KICAgIH0sCiAgICAibWFzdGVyIjogewogICAgICAiUmVjaXBlcyI6
IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICIy
NGQ1MjgyNTI3ZjQ2NDc5MDdiMzU3MjgyMGI1MzM1YzE1Y2QwMzU2IiwKICAg
ICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAyODQsCiAgICAgICAg
ICAgIDI4NQogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwog
ICAgICAgICAgICAieHNhMjg3LnBhdGNoIgogICAgICAgICAgXQogICAgICAg
IH0KICAgICAgfQogICAgfQogIH0KfQ==

--=separator
Content-Type: application/octet-stream; name="xsa287.patch"
Content-Disposition: attachment; filename="xsa287.patch"
Content-Transfer-Encoding: base64

RnJvbSBjMGI4OWMzZDNhNThiN2M4ODUzMmIzNmI5ZDEyNzdjMjc0NTU0MzEz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IEZyaSwgMTggSmFu
IDIwMTkgMTU6MDA6MzQgKzAwMDAKU3ViamVjdDogW1BBVENIXSBzdGVhbF9w
YWdlOiBHZXQgcmlkIG9mIGJvZ3VzIHN0cnVjdCBwYWdlIHN0YXRlcwoKVGhl
IG9yaWdpbmFsIHJ1bGVzIGZvciBgc3RydWN0IHBhZ2VgIHJlcXVpcmVkIHRo
ZSBmb2xsb3dpbmcgaW52YXJpYW50cwphdCBhbGwgdGltZXM6CgotIHJlZmNv
dW50ID4gMCBpbXBsaWVzIG93bmVyICE9IE5VTEwKLSBQR0NfYWxsb2NhdGVk
IGltcGxpZXMgcmVmY291bnQgPiAwCgpzdGVhbF9wYWdlLCBpbiBhIG1pc2d1
aWRlZCBhdHRlbXB0IHRvIHByb3RlY3QgYWdhaW5zdCB1bmtub3duIHJhY2Vz
LAp2aW9sYXRlcyBib3RoIG9mIHRoZXNlIHJ1bGVzLCB0aHVzIGludHJvZHVj
aW5nIG90aGVyIHJhY2VzOgoKLSBUZW1wb3JhcmlseSwgdGhlIGNvdW50X2lu
Zm8gaGFzIHRoZSByZWZjb3VudCBnbyB0byAwIHdoaWxlCiAgUEdDX2FsbG9j
YXRlZCBpcyBzZXQKCi0gSXQgZXhwbGljaXRseSByZXR1cm5zIHRoZSBwYWdl
IFBHQ19hbGxvY2F0ZWQgc2V0LCBidXQgb3duZXIgPT0gTlVMTAogIGFuZCBw
YWdlIG5vdCBvbiB0aGUgcGFnZV9saXN0LgoKVGhlIHNlY29uZCBvbmUgbWVh
bnQgdGhhdCBwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKCkgY291bGQg
cmV0dXJuCk5VTEwgZXZlbiBhZnRlciBoYXZpbmcgc3VjY2Vzc2Z1bGx5IGdy
YWJiZWQgYSByZWZlcmVuY2Ugb24gdGhlIHBhZ2UsCmxlYWRpbmcgdGhlIGNh
bGxlciB0byBsZWFrIHRoZSByZWZlcmVuY2UgKHNpbmNlICJjb3VsZG4ndCBn
ZXQgcmVmIiBhbmQKImdvdCByZWYgYnV0IG5vIG93bmVyIiBsb29rIHRoZSBz
YW1lKS4KCkZ1cnRoZXJtb3JlLCByYXRoZXIgdGhhbiBncmFiYmluZyBhIHBh
Z2UgcmVmZXJlbmNlIHRvIGVuc3VyZSB0aGF0IHRoZQpvd25lciBkb2Vzbid0
IGNoYW5nZSB1bmRlciBpdHMgZmVldCwgaXQgYXBwZWFycyB0byByZWx5IG9u
IGhvbGRpbmcKZC0+cGFnZV9hbGxvYyBsb2NrIHRvIHByZXZlbnQgdGhpcy4K
ClVuZm9ydHVuYXRlbHksIHRoaXMgaXMgaW5lZmZlY3RpdmU6IHBhZ2UtPm93
bmVyIHJlbWFpbnMgbm9uLU5VTEwgZm9yCnNvbWUgdGltZSBhZnRlciB0aGUg
Y291bnQgaGFzIGJlZW4gc2V0IHRvIDA7IG1lYW5pbmcgdGhhdCBpdCB3b3Vs
ZCBiZQplbnRpcmVseSBwb3NzaWJsZSBmb3IgdGhlIHBhZ2UgdG8gYmUgZnJl
ZWQgYW5kIHJlLWFsbG9jYXRlZCB0byBhCmRpZmZlcmVudCBkb21haW4gYmV0
d2VlbiB0aGUgcGFnZV9nZXRfb3duZXIoKSBjaGVjayBhbmQgdGhlIGNvdW50
X2luZm8KY2hlY2suCgpNb2RpZnkgc3RlYWxfcGFnZSB0byBpbnN0ZWFkIGZv
bGxvdyB0aGUgYXBwcm9wcmlhdGUgYWNjZXNzIGRpc2NpcGxpbmUsCnRha2lu
ZyB0aGUgcGFnZSB0aHJvdWdoIHNlcmllcyBvZiBzdGF0ZXMgc2ltaWxhciB0
byBiZWluZyBmcmVlZCBhbmQKdGhlbiByZS1hbGxvY2F0ZWQgd2l0aCBNRU1G
X25vX293bmVyOgoKLSBHcmFiIGFuIGV4dHJhIHJlZmVyZW5jZSB0byBtYWtl
IHN1cmUgd2UgZG9uJ3QgcmFjZSB3aXRoIGFueW9uZSBlbHNlCiAgZnJlZWlu
ZyB0aGUgcGFnZQoKLSBEcm9wIGJvdGggcmVmZXJlbmNlcyBhbmQgUEdDX2Fs
bG9jYXRlZCBhdG9taWNhbGx5LCBzbyB0aGF0IChpZgpzdWNjZXNzZnVsKSwg
YW55b25lIGVsc2UgdHJ5aW5nIHRvIGdyYWIgYSByZWZlcmVuY2Ugd2lsbCBm
YWlsCgotIEF0dGVtcHQgdG8gcmVzZXQgWGVuJ3MgbWFwcGluZ3MKCi0gUmVz
ZXQgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLgoKVGhlbiwgbW9kaWZ5IHRoZSB0
d28gY2FsbGVycyBhcHByb3ByaWF0ZWx5OgoKLSBMZWF2ZSBjb3VudF9pbmZv
IGFsb25lIChpdCdzIGFscmVhZHkgYmVlbiBjbGVhcmVkKQotIENhbGwgZnJl
ZV9kb21oZWFwX3BhZ2UoKSBkaXJlY3RseSBpZiBhcHByb3ByaWF0ZQotIENh
bGwgYXNzaWduX3BhZ2VzKCkgcmF0aGVyIHRoYW4gb3Blbi1jb2RpbmcgYSBw
YXJ0aWFsIGFzc2lnbgoKV2l0aCBhbGwgY2FsbGVycyB0byBhc3NpZ25fcGFn
ZXMoKSBub3cgcGFzc2luZyBpbiBwYWdlcyB3aXRoIHRoZQp0eXBlX2luZm8g
ZmllbGQgY2xlYXIsIHRpZ2h0ZW4gdGhlIHJlc3BlY3RpdmUgYXNzZXJ0aW9u
IHRoZXJlLgoKVGhpcyBpcyBYU0EtMjg3LgoKU2lnbmVkLW9mZi1ieTogR2Vv
cmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgICAgICAgIHwgODQgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9ncmFudF90
YWJsZS5jIHwgMjAgKysrKystLS0tLQogeGVuL2NvbW1vbi9tZW1vcnkuYyAg
ICAgIHwgMTkgKysrKystLS0tCiB4ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyAg
fCAgMiArLQogNCBmaWxlcyBjaGFuZ2VkLCA4MyBpbnNlcnRpb25zKCspLCA0
MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0u
YyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IDdlYzU5NTRiMDMuLjRkM2Ix
N2YzYTggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9tbS5jCkBAIC0zOTg5LDcwICszOTg5LDEwNiBAQCBpbnQg
ZG9uYXRlX3BhZ2UoCiAgICAgcmV0dXJuIC1FSU5WQUw7CiB9CiAKKy8qCisg
KiBTdGVhbCBwYWdlIHdpbGwgYXR0ZW1wdCB0byByZW1vdmUgYHBhZ2VgIGZy
b20gZG9tYWluIGBkYC4gIFVwb24KKyAqIHJldHVybiwgYHBhZ2VgIHdpbGwg
YmUgaW4gYSBzdGF0ZSBzaW1pbGFyIHRvIHRoZSBzdGF0ZSBvZiBhIHBhZ2UK
KyAqIHJldHVybmVkIGZyb20gYWxsb2NfZG9taGVhcF9wYWdlKCkgd2l0aCBN
RU1GX25vX293bmVyIHNldDoKKyAqIC0gcmVmY291bnQgMAorICogLSB0eXBl
IGNvdW50IGNsZWFyZWQKKyAqIC0gb3duZXIgTlVMTAorICogLSBwYWdlIGNh
Y2hpbmcgYXR0cmlidXRlcyBjbGVhbmVkIHVwCisgKiAtIHJlbW92ZWQgZnJv
bSB0aGUgZG9tYWluJ3MgcGFnZV9saXN0CisgKgorICogSWYgTUVNRl9ub19y
ZWZjb3VudCBpcyBub3Qgc2V0LCB0aGUgZG9tYWluJ3MgdG90X3BhZ2VzIHdp
bGwgYmUKKyAqIGFkanVzdGVkLiAgSWYgdGhpcyByZXN1bHRzIGluIHRoZSBw
YWdlIGNvdW50IGZhbGxpbmcgdG8gMCwKKyAqIHB1dF9kb21haW4oKSB3aWxs
IGJlIGNhbGxlZC4KKyAqCisgKiBUaGUgY2FsbGVyIHNob3VsZCBlaXRoZXIg
Y2FsbCBmcmVlX2RvbWhlYXBfcGFnZSgpIHRvIGZyZWUgdGhlCisgKiBwYWdl
LCBvciBhc3NpZ25fcGFnZXMoKSB0byBwdXQgaXQgYmFjayBvbiBzb21lIGRv
bWFpbidzIHBhZ2UgbGlzdC4KKyAqLwogaW50IHN0ZWFsX3BhZ2UoCiAgICAg
c3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5z
aWduZWQgaW50IG1lbWZsYWdzKQogewogICAgIHVuc2lnbmVkIGxvbmcgeCwg
eTsKICAgICBib29sIGRyb3BfZG9tX3JlZiA9IGZhbHNlOwotICAgIGNvbnN0
IHN0cnVjdCBkb21haW4gKm93bmVyID0gZG9tX3hlbjsKKyAgICBjb25zdCBz
dHJ1Y3QgZG9tYWluICpvd25lcjsKKyAgICBpbnQgcmM7CiAKICAgICBpZiAo
IHBhZ2luZ19tb2RlX2V4dGVybmFsKGQpICkKICAgICAgICAgcmV0dXJuIC1F
T1BOT1RTVVBQOwogCi0gICAgc3Bpbl9sb2NrKCZkLT5wYWdlX2FsbG9jX2xv
Y2spOwotCi0gICAgaWYgKCBpc194ZW5faGVhcF9wYWdlKHBhZ2UpIHx8ICgo
b3duZXIgPSBwYWdlX2dldF9vd25lcihwYWdlKSkgIT0gZCkgKQorICAgIC8q
IEdyYWIgYSByZWZlcmVuY2UgdG8gbWFrZSBzdXJlIHRoZSBwYWdlIGRvZXNu
J3QgY2hhbmdlIHVuZGVyIG91ciBmZWV0ICovCisgICAgcmMgPSAtRUlOVkFM
OworICAgIGlmICggIShvd25lciA9IHBhZ2VfZ2V0X293bmVyX2FuZF9yZWZl
cmVuY2UocGFnZSkpICkKICAgICAgICAgZ290byBmYWlsOwogCisgICAgaWYg
KCBvd25lciAhPSBkIHx8IGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkgKQorICAg
ICAgICBnb3RvIGZhaWxfcHV0OworCiAgICAgLyoKLSAgICAgKiBXZSByZXF1
aXJlIHRoZXJlIGlzIGp1c3Qgb25lIHJlZmVyZW5jZSAoUEdDX2FsbG9jYXRl
ZCkuIFdlIHRlbXBvcmFyaWx5Ci0gICAgICogZHJvcCB0aGlzIHJlZmVyZW5j
ZSBub3cgc28gdGhhdCB3ZSBjYW4gc2FmZWx5IHN3aXp6bGUgdGhlIG93bmVy
LgorICAgICAqIFdlIHJlcXVpcmUgdGhlcmUgYXJlIGV4YWN0bHkgdHdvIHJl
ZmVyZW5jZXMgLS0gdGhlIG9uZSB3ZSBqdXN0CisgICAgICogdG9vaywgYW5k
IFBHQ19hbGxvY2F0ZWQuIFdlIHRlbXBvcmFyaWx5IGRyb3AgYm90aCB0aGVz
ZQorICAgICAqIHJlZmVyZW5jZXMgc28gdGhhdCB0aGUgcGFnZSBiZWNvbWVz
IGVmZmVjdGl2ZWx5IG5vbi0ibGl2ZSIgZm9yCisgICAgICogdGhlIGRvbWFp
bi4KICAgICAgKi8KICAgICB5ID0gcGFnZS0+Y291bnRfaW5mbzsKICAgICBk
byB7CiAgICAgICAgIHggPSB5OwotICAgICAgICBpZiAoICh4ICYgKFBHQ19j
b3VudF9tYXNrfFBHQ19hbGxvY2F0ZWQpKSAhPSAoMSB8IFBHQ19hbGxvY2F0
ZWQpICkKLSAgICAgICAgICAgIGdvdG8gZmFpbDsKLSAgICAgICAgeSA9IGNt
cHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIHggJiB+UEdDX2NvdW50X21h
c2spOworICAgICAgICBpZiAoICh4ICYgKFBHQ19jb3VudF9tYXNrfFBHQ19h
bGxvY2F0ZWQpKSAhPSAoMiB8IFBHQ19hbGxvY2F0ZWQpICkKKyAgICAgICAg
ICAgIGdvdG8gZmFpbF9wdXQ7CisgICAgICAgIHkgPSBjbXB4Y2hnKCZwYWdl
LT5jb3VudF9pbmZvLCB4LCB4ICYgfihQR0NfY291bnRfbWFza3xQR0NfYWxs
b2NhdGVkKSk7CiAgICAgfSB3aGlsZSAoIHkgIT0geCApOwogCiAgICAgLyoK
LSAgICAgKiBXaXRoIHRoZSBzb2xlIHJlZmVyZW5jZSBkcm9wcGVkIHRlbXBv
cmFyaWx5LCBuby1vbmUgY2FuIHVwZGF0ZSB0eXBlCi0gICAgICogaW5mb3Jt
YXRpb24uIFR5cGUgY291bnQgYWxzbyBuZWVkcyB0byBiZSB6ZXJvIGluIHRo
aXMgY2FzZSwgYnV0IGUuZy4KLSAgICAgKiBQR1Rfc2VnX2Rlc2NfcGFnZSBt
YXkgc3RpbGwgaGF2ZSBQR1RfdmFsaWRhdGVkIHNldCwgd2hpY2ggd2UgbmVl
ZCB0bwotICAgICAqIGNsZWFyIGJlZm9yZSB0cmFuc2ZlcnJpbmcgb3duZXJz
aGlwIChhcyB2YWxpZGF0aW9uIGNyaXRlcmlhIHZhcnkKLSAgICAgKiBkZXBl
bmRpbmcgb24gZG9tYWluIHR5cGUpLgorICAgICAqIE5CIHRoaXMgaXMgc2Fm
ZSBldmVuIGlmIHRoZSBwYWdlIGVuZHMgdXAgYmVpbmcgZ2l2ZW4gYmFjayB0
bworICAgICAqIHRoZSBkb21haW4sIGJlY2F1c2UgdGhlIGNvdW50IGlzIHpl
cm86IHN1YnNlcXVlbnQgbWFwcGluZ3Mgd2lsbAorICAgICAqIGNhdXNlIHRo
ZSBjYWNoZSBhdHRyaWJ1dGVzIHRvIGJlIHJlLWluc3RhdGVkIGluc2lkZQor
ICAgICAqIGdldF9wYWdlX2Zyb21fbDFlKCkuCisgICAgICovCisgICAgaWYg
KCAocmMgPSBjbGVhbnVwX3BhZ2VfY2FjaGVhdHRyKHBhZ2UpKSApCisgICAg
eworICAgICAgICAvKgorICAgICAgICAgKiBDb3VsZG4ndCBmaXh1cCBYZW4n
cyBtYXBwaW5nczsgcHV0IHRoaW5ncyB0aGUgd2F5IHdlIGZvdW5kCisgICAg
ICAgICAqIGl0IGFuZCByZXR1cm4gYW4gZXJyb3IKKyAgICAgICAgICovCisg
ICAgICAgIHBhZ2UtPmNvdW50X2luZm8gfD0gUEdDX2FsbG9jYXRlZCB8IDE7
CisgICAgICAgIGdvdG8gZmFpbDsKKyAgICB9CisKKyAgICAvKgorICAgICAq
IFdpdGggdGhlIHJlZmVyZW5jZSBjb3VudCBub3cgemVybywgbm9ib2R5IGNh
biBncmFiIHJlZmVyZW5jZXMKKyAgICAgKiB0byBkbyBhbnl0aGluZyBlbHNl
IHdpdGggdGhlIHBhZ2UuICBSZXR1cm4gdGhlIHBhZ2UgdG8gYSBzdGF0ZQor
ICAgICAqIHRoYXQgaXQgbWlnaHQgYmUgdXBvbiByZXR1cm4gZnJvbSBhbGxv
Y19kb21oZWFwX3BhZ2VzIHdpdGgKKyAgICAgKiBNRU1GX25vX293bmVyIHNl
dC4KICAgICAgKi8KKyAgICBzcGluX2xvY2soJmQtPnBhZ2VfYWxsb2NfbG9j
ayk7CisKICAgICBCVUdfT04ocGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJiAo
UEdUX2NvdW50X21hc2sgfCBQR1RfbG9ja2VkIHwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgUEdUX3Bpbm5lZCkpOwogICAgIHBh
Z2UtPnUuaW51c2UudHlwZV9pbmZvID0gMDsKLQotICAgIC8qIFN3aXp6bGUg
dGhlIG93bmVyIHRoZW4gcmVpbnN0YXRlIHRoZSBQR0NfYWxsb2NhdGVkIHJl
ZmVyZW5jZS4gKi8KICAgICBwYWdlX3NldF9vd25lcihwYWdlLCBOVUxMKTsK
LSAgICB5ID0gcGFnZS0+Y291bnRfaW5mbzsKLSAgICBkbyB7Ci0gICAgICAg
IHggPSB5OwotICAgICAgICBCVUdfT04oKHggJiAoUEdDX2NvdW50X21hc2t8
UEdDX2FsbG9jYXRlZCkpICE9IFBHQ19hbGxvY2F0ZWQpOwotICAgIH0gd2hp
bGUgKCAoeSA9IGNtcHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIHggfCAx
KSkgIT0geCApOworICAgIHBhZ2VfbGlzdF9kZWwocGFnZSwgJmQtPnBhZ2Vf
bGlzdCk7CiAKICAgICAvKiBVbmxpbmsgZnJvbSBvcmlnaW5hbCBvd25lci4g
Ki8KICAgICBpZiAoICEobWVtZmxhZ3MgJiBNRU1GX25vX3JlZmNvdW50KSAm
JiAhZG9tYWluX2FkanVzdF90b3RfcGFnZXMoZCwgLTEpICkKICAgICAgICAg
ZHJvcF9kb21fcmVmID0gdHJ1ZTsKLSAgICBwYWdlX2xpc3RfZGVsKHBhZ2Us
ICZkLT5wYWdlX2xpc3QpOwogCiAgICAgc3Bpbl91bmxvY2soJmQtPnBhZ2Vf
YWxsb2NfbG9jayk7CisKICAgICBpZiAoIHVubGlrZWx5KGRyb3BfZG9tX3Jl
ZikgKQogICAgICAgICBwdXRfZG9tYWluKGQpOworCiAgICAgcmV0dXJuIDA7
CiAKKyBmYWlsX3B1dDoKKyAgICBwdXRfcGFnZShwYWdlKTsKICBmYWlsOgot
ICAgIHNwaW5fdW5sb2NrKCZkLT5wYWdlX2FsbG9jX2xvY2spOwogICAgIGdk
cHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiQmFkIHN0ZWFsIG1mbiAlIiBQUklf
bWZuCiAgICAgICAgICAgICAgIiBmcm9tIGQlZCAob3duZXIgZCVkKSBjYWY9
JTA4bHggdGFmPSUiIFBSdHlwZV9pbmZvICJcbiIsCiAgICAgICAgICAgICAg
bWZuX3gocGFnZV90b19tZm4ocGFnZSkpLCBkLT5kb21haW5faWQsCiAgICAg
ICAgICAgICAgb3duZXIgPyBvd25lci0+ZG9tYWluX2lkIDogRE9NSURfSU5W
QUxJRCwKICAgICAgICAgICAgICBwYWdlLT5jb3VudF9pbmZvLCBwYWdlLT51
LmludXNlLnR5cGVfaW5mbyk7Ci0gICAgcmV0dXJuIC1FSU5WQUw7CisgICAg
cmV0dXJuIHJjOwogfQogCiAjaWZkZWYgQ09ORklHX1BWCmRpZmYgLS1naXQg
YS94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMgYi94ZW4vY29tbW9uL2dyYW50
X3RhYmxlLmMKaW5kZXggZGIyMmQ2YjQ0MS4uODA3MjhlYTU3ZCAxMDA2NDQK
LS0tIGEveGVuL2NvbW1vbi9ncmFudF90YWJsZS5jCisrKyBiL3hlbi9jb21t
b24vZ3JhbnRfdGFibGUuYwpAQCAtMjE1Nyw3ICsyMTU3LDcgQEAgZ250dGFi
X3RyYW5zZmVyKAogI2lmZGVmIENPTkZJR19YODYKICAgICAgICAgICAgIHB1
dF9nZm4oZCwgZ29wLm1mbik7CiAjZW5kaWYKLSAgICAgICAgICAgIHBhZ2Ut
PmNvdW50X2luZm8gJj0gfihQR0NfY291bnRfbWFza3xQR0NfYWxsb2NhdGVk
KTsKKyAgICAgICAgICAgIC8qIFRoZSBjb3VudF9pbmZvIGhhcyBhbHJlYWR5
IGJlZW4gY2xlYW5lZCAqLwogICAgICAgICAgICAgZnJlZV9kb21oZWFwX3Bh
Z2UocGFnZSk7CiAgICAgICAgICAgICBnb3RvIGNvcHliYWNrOwogICAgICAg
ICB9CkBAIC0yMTgwLDEwICsyMTgwLDkgQEAgZ250dGFiX3RyYW5zZmVyKAog
CiAgICAgICAgICAgICBjb3B5X2RvbWFpbl9wYWdlKHBhZ2VfdG9fbWZuKG5l
d19wYWdlKSwgbWZuKTsKIAotICAgICAgICAgICAgcGFnZS0+Y291bnRfaW5m
byAmPSB+KFBHQ19jb3VudF9tYXNrfFBHQ19hbGxvY2F0ZWQpOworICAgICAg
ICAgICAgLyogVGhlIGNvdW50X2luZm8gaGFzIGFscmVhZHkgYmVlbiBjbGVh
cmVkICovCiAgICAgICAgICAgICBmcmVlX2RvbWhlYXBfcGFnZShwYWdlKTsK
ICAgICAgICAgICAgIHBhZ2UgPSBuZXdfcGFnZTsKLSAgICAgICAgICAgIHBh
Z2UtPmNvdW50X2luZm8gPSBQR0NfYWxsb2NhdGVkIHwgMTsKICAgICAgICAg
ICAgIG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgICAgICB9CiAKQEAg
LTIyMjMsMTIgKzIyMjIsMTcgQEAgZ250dGFiX3RyYW5zZmVyKAogICAgICAg
ICAgKi8KICAgICAgICAgc3Bpbl91bmxvY2soJmUtPnBhZ2VfYWxsb2NfbG9j
ayk7CiAgICAgICAgIG9rYXkgPSBnbnR0YWJfcHJlcGFyZV9mb3JfdHJhbnNm
ZXIoZSwgZCwgZ29wLnJlZik7Ci0gICAgICAgIHNwaW5fbG9jaygmZS0+cGFn
ZV9hbGxvY19sb2NrKTsKIAotICAgICAgICBpZiAoIHVubGlrZWx5KCFva2F5
KSB8fCB1bmxpa2VseShlLT5pc19keWluZykgKQorICAgICAgICBpZiAoIHVu
bGlrZWx5KCFva2F5IHx8IGFzc2lnbl9wYWdlcyhlLCBwYWdlLCAwLCBNRU1G
X25vX3JlZmNvdW50KSkgKQogICAgICAgICB7Ci0gICAgICAgICAgICBib29s
X3QgZHJvcF9kb21fcmVmID0gIWRvbWFpbl9hZGp1c3RfdG90X3BhZ2VzKGUs
IC0xKTsKKyAgICAgICAgICAgIGJvb2wgZHJvcF9kb21fcmVmOwogCisgICAg
ICAgICAgICAvKgorICAgICAgICAgICAgICogTmVlZCB0byBncmFiIHRoaXMg
YWdhaW4gdG8gc2FmZWx5IGZyZWUgb3VyICJyZXNlcnZlZCIKKyAgICAgICAg
ICAgICAqIHBhZ2UgaW4gdGhlIHBhZ2UgdG90YWwKKyAgICAgICAgICAgICAq
LworICAgICAgICAgICAgc3Bpbl9sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2sp
OworICAgICAgICAgICAgZHJvcF9kb21fcmVmID0gIWRvbWFpbl9hZGp1c3Rf
dG90X3BhZ2VzKGUsIC0xKTsKICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZl
LT5wYWdlX2FsbG9jX2xvY2spOwogCiAgICAgICAgICAgICBpZiAoIG9rYXkg
LyogaS5lLiBlLT5pc19keWluZyBkdWUgdG8gdGhlIHN1cnJvdW5kaW5nIGlm
KCkgKi8gKQpAQCAtMjI0MSwxMCArMjI0NSw2IEBAIGdudHRhYl90cmFuc2Zl
cigKICAgICAgICAgICAgIGdvdG8gdW5sb2NrX2FuZF9jb3B5YmFjazsKICAg
ICAgICAgfQogCi0gICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAm
ZS0+cGFnZV9saXN0KTsKLSAgICAgICAgcGFnZV9zZXRfb3duZXIocGFnZSwg
ZSk7Ci0KLSAgICAgICAgc3Bpbl91bmxvY2soJmUtPnBhZ2VfYWxsb2NfbG9j
ayk7CiAjaWZkZWYgQ09ORklHX1g4NgogICAgICAgICBwdXRfZ2ZuKGQsIGdv
cC5tZm4pOwogI2VuZGlmCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL21lbW9y
eS5jIGIveGVuL2NvbW1vbi9tZW1vcnkuYwppbmRleCBiNmNmMDk1ODVjLi41
Mzg3NzY5OTg3IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL21lbW9yeS5jCisr
KyBiL3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTY5NCwyMCArNjk0LDIyIEBA
IHN0YXRpYyBsb25nIG1lbW9yeV9leGNoYW5nZShYRU5fR1VFU1RfSEFORExF
X1BBUkFNKHhlbl9tZW1vcnlfZXhjaGFuZ2VfdCkgYXJnKQogICAgICAgICAg
KiBTdWNjZXNzISBCZXlvbmQgdGhpcyBwb2ludCB3ZSBjYW5ub3QgZmFpbCBm
b3IgdGhpcyBjaHVuay4KICAgICAgICAgICovCiAKLSAgICAgICAgLyogRGVz
dHJveSBmaW5hbCByZWZlcmVuY2UgdG8gZWFjaCBpbnB1dCBwYWdlLiAqLwor
ICAgICAgICAvKgorICAgICAgICAgKiBUaGVzZSBwYWdlcyBoYXZlIGFscmVh
ZHkgaGFkIG93bmVyIGFuZCByZWZlcmVuY2UgY2xlYXJlZC4KKyAgICAgICAg
ICogRG8gdGhlIGZpbmFsIHR3byBzdGVwczogUmVtb3ZlIGZyb20gdGhlIHBo
eXNtYXAsIGFuZCBmcmVlCisgICAgICAgICAqIHRoZW0uCisgICAgICAgICAq
LwogICAgICAgICB3aGlsZSAoIChwYWdlID0gcGFnZV9saXN0X3JlbW92ZV9o
ZWFkKCZpbl9jaHVua19saXN0KSkgKQogICAgICAgICB7CiAgICAgICAgICAg
ICB1bnNpZ25lZCBsb25nIGdmbjsKIAotICAgICAgICAgICAgaWYgKCAhdGVz
dF9hbmRfY2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRf
aW5mbykgKQotICAgICAgICAgICAgICAgIEJVRygpOwogICAgICAgICAgICAg
bWZuID0gcGFnZV90b19tZm4ocGFnZSk7CiAgICAgICAgICAgICBnZm4gPSBt
Zm5fdG9fZ21mbihkLCBtZm5feChtZm4pKTsKICAgICAgICAgICAgIC8qIFBh
Z2VzIHdlcmUgdW5zaGFyZWQgYWJvdmUgKi8KICAgICAgICAgICAgIEJVR19P
TihTSEFSRURfTTJQKGdmbikpOwogICAgICAgICAgICAgaWYgKCBndWVzdF9w
aHlzbWFwX3JlbW92ZV9wYWdlKGQsIF9nZm4oZ2ZuKSwgbWZuLCAwKSApCiAg
ICAgICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAgICAgICAg
cHV0X3BhZ2UocGFnZSk7CisgICAgICAgICAgICBmcmVlX2RvbWhlYXBfcGFn
ZShwYWdlKTsKICAgICAgICAgfQogCiAgICAgICAgIC8qIEFzc2lnbiBlYWNo
IG91dHB1dCBwYWdlIHRvIHRoZSBkb21haW4uICovCkBAIC03ODAsMTMgKzc4
MiwxNiBAQCBzdGF0aWMgbG9uZyBtZW1vcnlfZXhjaGFuZ2UoWEVOX0dVRVNU
X0hBTkRMRV9QQVJBTSh4ZW5fbWVtb3J5X2V4Y2hhbmdlX3QpIGFyZykKICAg
ICAgKiBjaHVua3Mgc3VjY2VlZGVkLgogICAgICAqLwogIGZhaWw6Ci0gICAg
LyogUmVhc3NpZ24gYW55IGlucHV0IHBhZ2VzIHdlIG1hbmFnZWQgdG8gc3Rl
YWwuICovCisgICAgLyoKKyAgICAgKiBSZWFzc2lnbiBhbnkgaW5wdXQgcGFn
ZXMgd2UgbWFuYWdlZCB0byBzdGVhbC4gIE5CIHRoYXQgaWYgdGhlIGFzc2ln
bgorICAgICAqIGZhaWxzIGFnYWluLCB3ZSdyZSBvbiB0aGUgaG9vayBmb3Ig
ZnJlZWluZyB0aGUgcGFnZSwgc2luY2Ugd2UndmUgYWxyZWFkeQorICAgICAq
IGNsZWFyZWQgUEdDX2FsbG9jYXRlZC4KKyAgICAgKi8KICAgICB3aGlsZSAo
IChwYWdlID0gcGFnZV9saXN0X3JlbW92ZV9oZWFkKCZpbl9jaHVua19saXN0
KSkgKQogICAgICAgICBpZiAoIGFzc2lnbl9wYWdlcyhkLCBwYWdlLCAwLCBN
RU1GX25vX3JlZmNvdW50KSApCiAgICAgICAgIHsKICAgICAgICAgICAgIEJV
R19PTighZC0+aXNfZHlpbmcpOwotICAgICAgICAgICAgaWYgKCB0ZXN0X2Fu
ZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZv
KSApCi0gICAgICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CisgICAgICAg
ICAgICBmcmVlX2RvbWhlYXBfcGFnZShwYWdlKTsKICAgICAgICAgfQogCiAg
ZHlpbmc6CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyBi
L3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCmluZGV4IGY3MWQzYmI3YTEuLmJl
NDQxNTgwMzMgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vcGFnZV9hbGxvYy5j
CisrKyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCkBAIC0yMjc5LDcgKzIy
NzksNyBAQCBpbnQgYXNzaWduX3BhZ2VzKAogICAgIGZvciAoIGkgPSAwOyBp
IDwgKDEgPDwgb3JkZXIpOyBpKysgKQogICAgIHsKICAgICAgICAgQVNTRVJU
KHBhZ2VfZ2V0X293bmVyKCZwZ1tpXSkgPT0gTlVMTCk7Ci0gICAgICAgIEFT
U0VSVCgocGdbaV0uY291bnRfaW5mbyAmIH4oUEdDX2FsbG9jYXRlZCB8IDEp
KSA9PSAwKTsKKyAgICAgICAgQVNTRVJUKCFwZ1tpXS5jb3VudF9pbmZvKTsK
ICAgICAgICAgcGFnZV9zZXRfb3duZXIoJnBnW2ldLCBkKTsKICAgICAgICAg
c21wX3dtYigpOyAvKiBEb21haW4gcG9pbnRlciBtdXN0IGJlIHZpc2libGUg
YmVmb3JlIHVwZGF0aW5nIHJlZmNudC4gKi8KICAgICAgICAgcGdbaV0uY291
bnRfaW5mbyA9IFBHQ19hbGxvY2F0ZWQgfCAxOwotLSAKMi4yMC4xCgo=

--=separator
Content-Type: application/octet-stream; name="xsa287-4.7.patch"
Content-Disposition: attachment; filename="xsa287-4.7.patch"
Content-Transfer-Encoding: base64

RnJvbSA2ZjU5YmNlMDA4MWU2MDkxMjI2NWY2ZTI3MzQzZWQ1NWE5YzMwNjhk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IEZyaSwgMTggSmFu
IDIwMTkgMTU6MDA6MzQgKzAwMDAKU3ViamVjdDogW1BBVENIXSBzdGVhbF9w
YWdlOiBHZXQgcmlkIG9mIGJvZ3VzIHN0cnVjdCBwYWdlIHN0YXRlcwoKVGhl
IG9yaWdpbmFsIHJ1bGVzIGZvciBgc3RydWN0IHBhZ2VgIHJlcXVpcmVkIHRo
ZSBmb2xsb3dpbmcgaW52YXJpYW50cwphdCBhbGwgdGltZXM6CgotIHJlZmNv
dW50ID4gMCBpbXBsaWVzIG93bmVyICE9IE5VTEwKLSBQR0NfYWxsb2NhdGVk
IGltcGxpZXMgcmVmY291bnQgPiAwCgpzdGVhbF9wYWdlLCBpbiBhIG1pc2d1
aWRlZCBhdHRlbXB0IHRvIHByb3RlY3QgYWdhaW5zdCB1bmtub3duIHJhY2Vz
LAp2aW9sYXRlcyBib3RoIG9mIHRoZXNlIHJ1bGVzLCB0aHVzIGludHJvZHVj
aW5nIG90aGVyIHJhY2VzOgoKLSBUZW1wb3JhcmlseSwgdGhlIGNvdW50X2lu
Zm8gaGFzIHRoZSByZWZjb3VudCBnbyB0byAwIHdoaWxlCiAgUEdDX2FsbG9j
YXRlZCBpcyBzZXQKCi0gSXQgZXhwbGljaXRseSByZXR1cm5zIHRoZSBwYWdl
IFBHQ19hbGxvY2F0ZWQgc2V0LCBidXQgb3duZXIgPT0gTlVMTAogIGFuZCBw
YWdlIG5vdCBvbiB0aGUgcGFnZV9saXN0LgoKVGhlIHNlY29uZCBvbmUgbWVh
bnQgdGhhdCBwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKCkgY291bGQg
cmV0dXJuCk5VTEwgZXZlbiBhZnRlciBoYXZpbmcgc3VjY2Vzc2Z1bGx5IGdy
YWJiZWQgYSByZWZlcmVuY2Ugb24gdGhlIHBhZ2UsCmxlYWRpbmcgdGhlIGNh
bGxlciB0byBsZWFrIHRoZSByZWZlcmVuY2UgKHNpbmNlICJjb3VsZG4ndCBn
ZXQgcmVmIiBhbmQKImdvdCByZWYgYnV0IG5vIG93bmVyIiBsb29rIHRoZSBz
YW1lKS4KCkZ1cnRoZXJtb3JlLCByYXRoZXIgdGhhbiBncmFiYmluZyBhIHBh
Z2UgcmVmZXJlbmNlIHRvIGVuc3VyZSB0aGF0IHRoZQpvd25lciBkb2Vzbid0
IGNoYW5nZSB1bmRlciBpdHMgZmVldCwgaXQgYXBwZWFycyB0byByZWx5IG9u
IGhvbGRpbmcKZC0+cGFnZV9hbGxvYyBsb2NrIHRvIHByZXZlbnQgdGhpcy4K
ClVuZm9ydHVuYXRlbHksIHRoaXMgaXMgaW5lZmZlY3RpdmU6IHBhZ2UtPm93
bmVyIHJlbWFpbnMgbm9uLU5VTEwgZm9yCnNvbWUgdGltZSBhZnRlciB0aGUg
Y291bnQgaGFzIGJlZW4gc2V0IHRvIDA7IG1lYW5pbmcgdGhhdCBpdCB3b3Vs
ZCBiZQplbnRpcmVseSBwb3NzaWJsZSBmb3IgdGhlIHBhZ2UgdG8gYmUgZnJl
ZWQgYW5kIHJlLWFsbG9jYXRlZCB0byBhCmRpZmZlcmVudCBkb21haW4gYmV0
d2VlbiB0aGUgcGFnZV9nZXRfb3duZXIoKSBjaGVjayBhbmQgdGhlIGNvdW50
X2luZm8KY2hlY2suCgpNb2RpZnkgc3RlYWxfcGFnZSB0byBpbnN0ZWFkIGZv
bGxvdyB0aGUgYXBwcm9wcmlhdGUgYWNjZXNzIGRpc2NpcGxpbmUsCnRha2lu
ZyB0aGUgcGFnZSB0aHJvdWdoIHNlcmllcyBvZiBzdGF0ZXMgc2ltaWxhciB0
byBiZWluZyBmcmVlZCBhbmQKdGhlbiByZS1hbGxvY2F0ZWQgd2l0aCBNRU1G
X25vX293bmVyOgoKLSBHcmFiIGFuIGV4dHJhIHJlZmVyZW5jZSB0byBtYWtl
IHN1cmUgd2UgZG9uJ3QgcmFjZSB3aXRoIGFueW9uZSBlbHNlCiAgZnJlZWlu
ZyB0aGUgcGFnZQoKLSBEcm9wIGJvdGggcmVmZXJlbmNlcyBhbmQgUEdDX2Fs
bG9jYXRlZCBhdG9taWNhbGx5LCBzbyB0aGF0IChpZgpzdWNjZXNzZnVsKSwg
YW55b25lIGVsc2UgdHJ5aW5nIHRvIGdyYWIgYSByZWZlcmVuY2Ugd2lsbCBm
YWlsCgotIEF0dGVtcHQgdG8gcmVzZXQgWGVuJ3MgbWFwcGluZ3MKCi0gUmVz
ZXQgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLgoKVGhlbiwgbW9kaWZ5IHRoZSB0
d28gY2FsbGVycyBhcHByb3ByaWF0ZWx5OgoKLSBMZWF2ZSBjb3VudF9pbmZv
IGFsb25lIChpdCdzIGFscmVhZHkgYmVlbiBjbGVhcmVkKQotIENhbGwgZnJl
ZV9kb21oZWFwX3BhZ2UoKSBkaXJlY3RseSBpZiBhcHByb3ByaWF0ZQotIENh
bGwgYXNzaWduX3BhZ2VzKCkgcmF0aGVyIHRoYW4gb3Blbi1jb2RpbmcgYSBw
YXJ0aWFsIGFzc2lnbgoKV2l0aCBhbGwgY2FsbGVycyB0byBhc3NpZ25fcGFn
ZXMoKSBub3cgcGFzc2luZyBpbiBwYWdlcyB3aXRoIHRoZQp0eXBlX2luZm8g
ZmllbGQgY2xlYXIsIHRpZ2h0ZW4gdGhlIHJlc3BlY3RpdmUgYXNzZXJ0aW9u
IHRoZXJlLgoKVGhpcyBpcyBYU0EtMjg3LgoKU2lnbmVkLW9mZi1ieTogR2Vv
cmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CgpCYWNr
cG9ydDogUmV0dXJuIC1FT1BOT1RTVVBQIGluIHBhZ2luZ19tb2RlX2V4dGVy
bmFsKCkgZm9yIGNvbnNpc3RlbmN5LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICAgICB8IDg2ICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0t
LS0tLS0tLS0KIHhlbi9jb21tb24vZ3JhbnRfdGFibGUuYyB8IDIwICsrKysr
LS0tLS0KIHhlbi9jb21tb24vbWVtb3J5LmMgICAgICB8IDE5ICsrKysrLS0t
LQogeGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMgIHwgIDIgKy0KIDQgZmlsZXMg
Y2hhbmdlZCwgODQgaW5zZXJ0aW9ucygrKSwgNDMgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCBjOWM2ZmM5ZGM4Li40N2Y0YWE0ZjZhIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtNDcxNyw2OSArNDcxNywxMDUgQEAgaW50IGRvbmF0ZV9wYWdlKAogICAg
IHJldHVybiAtMTsKIH0KIAorLyoKKyAqIFN0ZWFsIHBhZ2Ugd2lsbCBhdHRl
bXB0IHRvIHJlbW92ZSBgcGFnZWAgZnJvbSBkb21haW4gYGRgLiAgVXBvbgor
ICogcmV0dXJuLCBgcGFnZWAgd2lsbCBiZSBpbiBhIHN0YXRlIHNpbWlsYXIg
dG8gdGhlIHN0YXRlIG9mIGEgcGFnZQorICogcmV0dXJuZWQgZnJvbSBhbGxv
Y19kb21oZWFwX3BhZ2UoKSB3aXRoIE1FTUZfbm9fb3duZXIgc2V0OgorICog
LSByZWZjb3VudCAwCisgKiAtIHR5cGUgY291bnQgY2xlYXJlZAorICogLSBv
d25lciBOVUxMCisgKiAtIHBhZ2UgY2FjaGluZyBhdHRyaWJ1dGVzIGNsZWFu
ZWQgdXAKKyAqIC0gcmVtb3ZlZCBmcm9tIHRoZSBkb21haW4ncyBwYWdlX2xp
c3QKKyAqCisgKiBJZiBNRU1GX25vX3JlZmNvdW50IGlzIG5vdCBzZXQsIHRo
ZSBkb21haW4ncyB0b3RfcGFnZXMgd2lsbCBiZQorICogYWRqdXN0ZWQuICBJ
ZiB0aGlzIHJlc3VsdHMgaW4gdGhlIHBhZ2UgY291bnQgZmFsbGluZyB0byAw
LAorICogcHV0X2RvbWFpbigpIHdpbGwgYmUgY2FsbGVkLgorICoKKyAqIFRo
ZSBjYWxsZXIgc2hvdWxkIGVpdGhlciBjYWxsIGZyZWVfZG9taGVhcF9wYWdl
KCkgdG8gZnJlZSB0aGUKKyAqIHBhZ2UsIG9yIGFzc2lnbl9wYWdlcygpIHRv
IHB1dCBpdCBiYWNrIG9uIHNvbWUgZG9tYWluJ3MgcGFnZSBsaXN0LgorICov
CiBpbnQgc3RlYWxfcGFnZSgKICAgICBzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBpbnQgbWVtZmxhZ3MpCiB7
CiAgICAgdW5zaWduZWQgbG9uZyB4LCB5OwogICAgIGJvb2xfdCBkcm9wX2Rv
bV9yZWYgPSAwOwotICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKm93bmVyID0g
ZG9tX3hlbjsKKyAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpvd25lcjsKKyAg
ICBpbnQgcmM7CiAKICAgICBpZiAoIHBhZ2luZ19tb2RlX2V4dGVybmFsKGQp
ICkKLSAgICAgICAgcmV0dXJuIC0xOwotCi0gICAgc3Bpbl9sb2NrKCZkLT5w
YWdlX2FsbG9jX2xvY2spOworICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7
CiAKLSAgICBpZiAoIGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkgfHwgKChvd25l
ciA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpKSAhPSBkKSApCisgICAgLyogR3Jh
YiBhIHJlZmVyZW5jZSB0byBtYWtlIHN1cmUgdGhlIHBhZ2UgZG9lc24ndCBj
aGFuZ2UgdW5kZXIgb3VyIGZlZXQgKi8KKyAgICByYyA9IC1FSU5WQUw7Cisg
ICAgaWYgKCAhKG93bmVyID0gcGFnZV9nZXRfb3duZXJfYW5kX3JlZmVyZW5j
ZShwYWdlKSkgKQogICAgICAgICBnb3RvIGZhaWw7CiAKKyAgICBpZiAoIG93
bmVyICE9IGQgfHwgaXNfeGVuX2hlYXBfcGFnZShwYWdlKSApCisgICAgICAg
IGdvdG8gZmFpbF9wdXQ7CisKICAgICAvKgotICAgICAqIFdlIHJlcXVpcmUg
dGhlcmUgaXMganVzdCBvbmUgcmVmZXJlbmNlIChQR0NfYWxsb2NhdGVkKS4g
V2UgdGVtcG9yYXJpbHkKLSAgICAgKiBkcm9wIHRoaXMgcmVmZXJlbmNlIG5v
dyBzbyB0aGF0IHdlIGNhbiBzYWZlbHkgc3dpenpsZSB0aGUgb3duZXIuCisg
ICAgICogV2UgcmVxdWlyZSB0aGVyZSBhcmUgZXhhY3RseSB0d28gcmVmZXJl
bmNlcyAtLSB0aGUgb25lIHdlIGp1c3QKKyAgICAgKiB0b29rLCBhbmQgUEdD
X2FsbG9jYXRlZC4gV2UgdGVtcG9yYXJpbHkgZHJvcCBib3RoIHRoZXNlCisg
ICAgICogcmVmZXJlbmNlcyBzbyB0aGF0IHRoZSBwYWdlIGJlY29tZXMgZWZm
ZWN0aXZlbHkgbm9uLSJsaXZlIiBmb3IKKyAgICAgKiB0aGUgZG9tYWluLgog
ICAgICAqLwogICAgIHkgPSBwYWdlLT5jb3VudF9pbmZvOwogICAgIGRvIHsK
ICAgICAgICAgeCA9IHk7Ci0gICAgICAgIGlmICggKHggJiAoUEdDX2NvdW50
X21hc2t8UEdDX2FsbG9jYXRlZCkpICE9ICgxIHwgUEdDX2FsbG9jYXRlZCkg
KQotICAgICAgICAgICAgZ290byBmYWlsOwotICAgICAgICB5ID0gY21weGNo
ZygmcGFnZS0+Y291bnRfaW5mbywgeCwgeCAmIH5QR0NfY291bnRfbWFzayk7
CisgICAgICAgIGlmICggKHggJiAoUEdDX2NvdW50X21hc2t8UEdDX2FsbG9j
YXRlZCkpICE9ICgyIHwgUEdDX2FsbG9jYXRlZCkgKQorICAgICAgICAgICAg
Z290byBmYWlsX3B1dDsKKyAgICAgICAgeSA9IGNtcHhjaGcoJnBhZ2UtPmNv
dW50X2luZm8sIHgsIHggJiB+KFBHQ19jb3VudF9tYXNrfFBHQ19hbGxvY2F0
ZWQpKTsKICAgICB9IHdoaWxlICggeSAhPSB4ICk7CiAKICAgICAvKgotICAg
ICAqIFdpdGggdGhlIHNvbGUgcmVmZXJlbmNlIGRyb3BwZWQgdGVtcG9yYXJp
bHksIG5vLW9uZSBjYW4gdXBkYXRlIHR5cGUKLSAgICAgKiBpbmZvcm1hdGlv
bi4gVHlwZSBjb3VudCBhbHNvIG5lZWRzIHRvIGJlIHplcm8gaW4gdGhpcyBj
YXNlLCBidXQgZS5nLgotICAgICAqIFBHVF9zZWdfZGVzY19wYWdlIG1heSBz
dGlsbCBoYXZlIFBHVF92YWxpZGF0ZWQgc2V0LCB3aGljaCB3ZSBuZWVkIHRv
Ci0gICAgICogY2xlYXIgYmVmb3JlIHRyYW5zZmVycmluZyBvd25lcnNoaXAg
KGFzIHZhbGlkYXRpb24gY3JpdGVyaWEgdmFyeQotICAgICAqIGRlcGVuZGlu
ZyBvbiBkb21haW4gdHlwZSkuCisgICAgICogTkIgdGhpcyBpcyBzYWZlIGV2
ZW4gaWYgdGhlIHBhZ2UgZW5kcyB1cCBiZWluZyBnaXZlbiBiYWNrIHRvCisg
ICAgICogdGhlIGRvbWFpbiwgYmVjYXVzZSB0aGUgY291bnQgaXMgemVybzog
c3Vic2VxdWVudCBtYXBwaW5ncyB3aWxsCisgICAgICogY2F1c2UgdGhlIGNh
Y2hlIGF0dHJpYnV0ZXMgdG8gYmUgcmUtaW5zdGF0ZWQgaW5zaWRlCisgICAg
ICogZ2V0X3BhZ2VfZnJvbV9sMWUoKS4KICAgICAgKi8KKyAgICBpZiAoIChy
YyA9IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIocGFnZSkpICkKKyAgICB7Cisg
ICAgICAgIC8qCisgICAgICAgICAqIENvdWxkbid0IGZpeHVwIFhlbidzIG1h
cHBpbmdzOyBwdXQgdGhpbmdzIHRoZSB3YXkgd2UgZm91bmQKKyAgICAgICAg
ICogaXQgYW5kIHJldHVybiBhbiBlcnJvcgorICAgICAgICAgKi8KKyAgICAg
ICAgcGFnZS0+Y291bnRfaW5mbyB8PSBQR0NfYWxsb2NhdGVkIHwgMTsKKyAg
ICAgICAgZ290byBmYWlsOworICAgIH0KKworICAgIC8qCisgICAgICogV2l0
aCB0aGUgcmVmZXJlbmNlIGNvdW50IG5vdyB6ZXJvLCBub2JvZHkgY2FuIGdy
YWIgcmVmZXJlbmNlcworICAgICAqIHRvIGRvIGFueXRoaW5nIGVsc2Ugd2l0
aCB0aGUgcGFnZS4gIFJldHVybiB0aGUgcGFnZSB0byBhIHN0YXRlCisgICAg
ICogdGhhdCBpdCBtaWdodCBiZSB1cG9uIHJldHVybiBmcm9tIGFsbG9jX2Rv
bWhlYXBfcGFnZXMgd2l0aAorICAgICAqIE1FTUZfbm9fb3duZXIgc2V0Lgor
ICAgICAqLworICAgIHNwaW5fbG9jaygmZC0+cGFnZV9hbGxvY19sb2NrKTsK
KwogICAgIEJVR19PTihwYWdlLT51LmludXNlLnR5cGVfaW5mbyAmIChQR1Rf
Y291bnRfbWFzayB8IFBHVF9sb2NrZWQgfAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBQR1RfcGlubmVkKSk7CiAgICAgcGFnZS0+
dS5pbnVzZS50eXBlX2luZm8gPSAwOwotCi0gICAgLyogU3dpenpsZSB0aGUg
b3duZXIgdGhlbiByZWluc3RhdGUgdGhlIFBHQ19hbGxvY2F0ZWQgcmVmZXJl
bmNlLiAqLwogICAgIHBhZ2Vfc2V0X293bmVyKHBhZ2UsIE5VTEwpOwotICAg
IHkgPSBwYWdlLT5jb3VudF9pbmZvOwotICAgIGRvIHsKLSAgICAgICAgeCA9
IHk7Ci0gICAgICAgIEJVR19PTigoeCAmIChQR0NfY291bnRfbWFza3xQR0Nf
YWxsb2NhdGVkKSkgIT0gUEdDX2FsbG9jYXRlZCk7Ci0gICAgfSB3aGlsZSAo
ICh5ID0gY21weGNoZygmcGFnZS0+Y291bnRfaW5mbywgeCwgeCB8IDEpKSAh
PSB4ICk7CisgICAgcGFnZV9saXN0X2RlbChwYWdlLCAmZC0+cGFnZV9saXN0
KTsKIAogICAgIC8qIFVubGluayBmcm9tIG9yaWdpbmFsIG93bmVyLiAqLwog
ICAgIGlmICggIShtZW1mbGFncyAmIE1FTUZfbm9fcmVmY291bnQpICYmICFk
b21haW5fYWRqdXN0X3RvdF9wYWdlcyhkLCAtMSkgKQogICAgICAgICBkcm9w
X2RvbV9yZWYgPSAxOwotICAgIHBhZ2VfbGlzdF9kZWwocGFnZSwgJmQtPnBh
Z2VfbGlzdCk7CiAKICAgICBzcGluX3VubG9jaygmZC0+cGFnZV9hbGxvY19s
b2NrKTsKKwogICAgIGlmICggdW5saWtlbHkoZHJvcF9kb21fcmVmKSApCiAg
ICAgICAgIHB1dF9kb21haW4oZCk7CisKICAgICByZXR1cm4gMDsKIAorIGZh
aWxfcHV0OgorICAgIHB1dF9wYWdlKHBhZ2UpOwogIGZhaWw6Ci0gICAgc3Bp
bl91bmxvY2soJmQtPnBhZ2VfYWxsb2NfbG9jayk7CiAgICAgTUVNX0xPRygi
QmFkIHBhZ2UgJWx4OiBlZD0lZCBzZD0lZCBjYWY9JTA4bHggdGFmPSUiIFBS
dHlwZV9pbmZvLAogICAgICAgICAgICAgcGFnZV90b19tZm4ocGFnZSksIGQt
PmRvbWFpbl9pZCwKICAgICAgICAgICAgIG93bmVyID8gb3duZXItPmRvbWFp
bl9pZCA6IERPTUlEX0lOVkFMSUQsCiAgICAgICAgICAgICBwYWdlLT5jb3Vu
dF9pbmZvLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7Ci0gICAgcmV0dXJu
IC0xOworICAgIHJldHVybiByYzsKIH0KIAogc3RhdGljIGludCBfX2RvX3Vw
ZGF0ZV92YV9tYXBwaW5nKApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9ncmFu
dF90YWJsZS5jIGIveGVuL2NvbW1vbi9ncmFudF90YWJsZS5jCmluZGV4IGFk
NDRiOTYzMDMuLjcwOWUzODcxZjUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
Z3JhbnRfdGFibGUuYworKysgYi94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMK
QEAgLTE5ODUsNyArMTk4NSw3IEBAIGdudHRhYl90cmFuc2ZlcigKICAgICAg
ICAgICAgIHJjdV91bmxvY2tfZG9tYWluKGUpOwogICAgICAgICBwdXRfZ2Zu
X2FuZF9jb3B5YmFjazoKICAgICAgICAgICAgIHB1dF9nZm4oZCwgZ29wLm1m
bik7Ci0gICAgICAgICAgICBwYWdlLT5jb3VudF9pbmZvICY9IH4oUEdDX2Nv
dW50X21hc2t8UEdDX2FsbG9jYXRlZCk7CisgICAgICAgICAgICAvKiBUaGUg
Y291bnRfaW5mbyBoYXMgYWxyZWFkeSBiZWVuIGNsZWFuZWQgKi8KICAgICAg
ICAgICAgIGZyZWVfZG9taGVhcF9wYWdlKHBhZ2UpOwogICAgICAgICAgICAg
Z290byBjb3B5YmFjazsKICAgICAgICAgfQpAQCAtMjAwOCwxMCArMjAwOCw5
IEBAIGdudHRhYl90cmFuc2ZlcigKIAogICAgICAgICAgICAgY29weV9kb21h
aW5fcGFnZShfbWZuKHBhZ2VfdG9fbWZuKG5ld19wYWdlKSksIF9tZm4obWZu
KSk7CiAKLSAgICAgICAgICAgIHBhZ2UtPmNvdW50X2luZm8gJj0gfihQR0Nf
Y291bnRfbWFza3xQR0NfYWxsb2NhdGVkKTsKKyAgICAgICAgICAgIC8qIFRo
ZSBjb3VudF9pbmZvIGhhcyBhbHJlYWR5IGJlZW4gY2xlYXJlZCAqLwogICAg
ICAgICAgICAgZnJlZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgICAg
ICBwYWdlID0gbmV3X3BhZ2U7Ci0gICAgICAgICAgICBwYWdlLT5jb3VudF9p
bmZvID0gUEdDX2FsbG9jYXRlZCB8IDE7CiAgICAgICAgICAgICBtZm4gPSBw
YWdlX3RvX21mbihwYWdlKTsKICAgICAgICAgfQogCkBAIC0yMDUxLDEyICsy
MDUwLDE3IEBAIGdudHRhYl90cmFuc2ZlcigKICAgICAgICAgICovCiAgICAg
ICAgIHNwaW5fdW5sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOwogICAgICAg
ICBva2F5ID0gZ250dGFiX3ByZXBhcmVfZm9yX3RyYW5zZmVyKGUsIGQsIGdv
cC5yZWYpOwotICAgICAgICBzcGluX2xvY2soJmUtPnBhZ2VfYWxsb2NfbG9j
ayk7CiAKLSAgICAgICAgaWYgKCB1bmxpa2VseSghb2theSkgfHwgdW5saWtl
bHkoZS0+aXNfZHlpbmcpICkKKyAgICAgICAgaWYgKCB1bmxpa2VseSghb2th
eSB8fCBhc3NpZ25fcGFnZXMoZSwgcGFnZSwgMCwgTUVNRl9ub19yZWZjb3Vu
dCkpICkKICAgICAgICAgewotICAgICAgICAgICAgYm9vbF90IGRyb3BfZG9t
X3JlZiA9ICFkb21haW5fYWRqdXN0X3RvdF9wYWdlcyhlLCAtMSk7CisgICAg
ICAgICAgICBib29sX3QgZHJvcF9kb21fcmVmOwogCisgICAgICAgICAgICAv
KgorICAgICAgICAgICAgICogTmVlZCB0byBncmFiIHRoaXMgYWdhaW4gdG8g
c2FmZWx5IGZyZWUgb3VyICJyZXNlcnZlZCIKKyAgICAgICAgICAgICAqIHBh
Z2UgaW4gdGhlIHBhZ2UgdG90YWwKKyAgICAgICAgICAgICAqLworICAgICAg
ICAgICAgc3Bpbl9sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOworICAgICAg
ICAgICAgZHJvcF9kb21fcmVmID0gIWRvbWFpbl9hZGp1c3RfdG90X3BhZ2Vz
KGUsIC0xKTsKICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZlLT5wYWdlX2Fs
bG9jX2xvY2spOwogCiAgICAgICAgICAgICBpZiAoIG9rYXkgLyogaS5lLiBl
LT5pc19keWluZyBkdWUgdG8gdGhlIHN1cnJvdW5kaW5nIGlmKCkgKi8gKQpA
QCAtMjA2OSwxMCArMjA3Myw2IEBAIGdudHRhYl90cmFuc2ZlcigKICAgICAg
ICAgICAgIGdvdG8gdW5sb2NrX2FuZF9jb3B5YmFjazsKICAgICAgICAgfQog
Ci0gICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmZS0+cGFnZV9s
aXN0KTsKLSAgICAgICAgcGFnZV9zZXRfb3duZXIocGFnZSwgZSk7Ci0KLSAg
ICAgICAgc3Bpbl91bmxvY2soJmUtPnBhZ2VfYWxsb2NfbG9jayk7CiAgICAg
ICAgIHB1dF9nZm4oZCwgZ29wLm1mbik7CiAKICAgICAgICAgVFJBQ0VfMUQo
VFJDX01FTV9QQUdFX0dSQU5UX1RSQU5TRkVSLCBlLT5kb21haW5faWQpOwpk
aWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9tZW1vcnkuYyBiL3hlbi9jb21tb24v
bWVtb3J5LmMKaW5kZXggMThjZTYyYTcwNS4uOTU4MWY4MTkwMiAxMDA2NDQK
LS0tIGEveGVuL2NvbW1vbi9tZW1vcnkuYworKysgYi94ZW4vY29tbW9uL21l
bW9yeS5jCkBAIC01ODksMjAgKzU4OSwyMiBAQCBzdGF0aWMgbG9uZyBtZW1v
cnlfZXhjaGFuZ2UoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fbWVtb3J5
X2V4Y2hhbmdlX3QpIGFyZykKICAgICAgICAgICogU3VjY2VzcyEgQmV5b25k
IHRoaXMgcG9pbnQgd2UgY2Fubm90IGZhaWwgZm9yIHRoaXMgY2h1bmsuCiAg
ICAgICAgICAqLwogCi0gICAgICAgIC8qIERlc3Ryb3kgZmluYWwgcmVmZXJl
bmNlIHRvIGVhY2ggaW5wdXQgcGFnZS4gKi8KKyAgICAgICAgLyoKKyAgICAg
ICAgICogVGhlc2UgcGFnZXMgaGF2ZSBhbHJlYWR5IGhhZCBvd25lciBhbmQg
cmVmZXJlbmNlIGNsZWFyZWQuCisgICAgICAgICAqIERvIHRoZSBmaW5hbCB0
d28gc3RlcHM6IFJlbW92ZSBmcm9tIHRoZSBwaHlzbWFwLCBhbmQgZnJlZQor
ICAgICAgICAgKiB0aGVtLgorICAgICAgICAgKi8KICAgICAgICAgd2hpbGUg
KCAocGFnZSA9IHBhZ2VfbGlzdF9yZW1vdmVfaGVhZCgmaW5fY2h1bmtfbGlz
dCkpICkKICAgICAgICAgewogICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBn
Zm47CiAKLSAgICAgICAgICAgIGlmICggIXRlc3RfYW5kX2NsZWFyX2JpdChf
UEdDX2FsbG9jYXRlZCwgJnBhZ2UtPmNvdW50X2luZm8pICkKLSAgICAgICAg
ICAgICAgICBCVUcoKTsKICAgICAgICAgICAgIG1mbiA9IHBhZ2VfdG9fbWZu
KHBhZ2UpOwogICAgICAgICAgICAgZ2ZuID0gbWZuX3RvX2dtZm4oZCwgbWZu
KTsKICAgICAgICAgICAgIC8qIFBhZ2VzIHdlcmUgdW5zaGFyZWQgYWJvdmUg
Ki8KICAgICAgICAgICAgIEJVR19PTihTSEFSRURfTTJQKGdmbikpOwogICAg
ICAgICAgICAgaWYgKCBndWVzdF9waHlzbWFwX3JlbW92ZV9wYWdlKGQsIGdm
biwgbWZuLCAwKSApCiAgICAgICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQp
OwotICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CisgICAgICAgICAgICBm
cmVlX2RvbWhlYXBfcGFnZShwYWdlKTsKICAgICAgICAgfQogCiAgICAgICAg
IC8qIEFzc2lnbiBlYWNoIG91dHB1dCBwYWdlIHRvIHRoZSBkb21haW4uICov
CkBAIC02NzQsMTMgKzY3NiwxNiBAQCBzdGF0aWMgbG9uZyBtZW1vcnlfZXhj
aGFuZ2UoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fbWVtb3J5X2V4Y2hh
bmdlX3QpIGFyZykKICAgICAgKiBjaHVua3Mgc3VjY2VlZGVkLgogICAgICAq
LwogIGZhaWw6Ci0gICAgLyogUmVhc3NpZ24gYW55IGlucHV0IHBhZ2VzIHdl
IG1hbmFnZWQgdG8gc3RlYWwuICovCisgICAgLyoKKyAgICAgKiBSZWFzc2ln
biBhbnkgaW5wdXQgcGFnZXMgd2UgbWFuYWdlZCB0byBzdGVhbC4gIE5CIHRo
YXQgaWYgdGhlIGFzc2lnbgorICAgICAqIGZhaWxzIGFnYWluLCB3ZSdyZSBv
biB0aGUgaG9vayBmb3IgZnJlZWluZyB0aGUgcGFnZSwgc2luY2Ugd2UndmUg
YWxyZWFkeQorICAgICAqIGNsZWFyZWQgUEdDX2FsbG9jYXRlZC4KKyAgICAg
Ki8KICAgICB3aGlsZSAoIChwYWdlID0gcGFnZV9saXN0X3JlbW92ZV9oZWFk
KCZpbl9jaHVua19saXN0KSkgKQogICAgICAgICBpZiAoIGFzc2lnbl9wYWdl
cyhkLCBwYWdlLCAwLCBNRU1GX25vX3JlZmNvdW50KSApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIEJVR19PTighZC0+aXNfZHlpbmcpOwotICAgICAgICAg
ICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZw
YWdlLT5jb3VudF9pbmZvKSApCi0gICAgICAgICAgICAgICAgcHV0X3BhZ2Uo
cGFnZSk7CisgICAgICAgICAgICBmcmVlX2RvbWhlYXBfcGFnZShwYWdlKTsK
ICAgICAgICAgfQogCiAgZHlpbmc6CmRpZmYgLS1naXQgYS94ZW4vY29tbW9u
L3BhZ2VfYWxsb2MuYyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCmluZGV4
IGQwMjc4MTlmN2IuLjU5ZmE1Yjk3NGYgMTAwNjQ0Ci0tLSBhL3hlbi9jb21t
b24vcGFnZV9hbGxvYy5jCisrKyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5j
CkBAIC0xNzgwLDcgKzE3ODAsNyBAQCBpbnQgYXNzaWduX3BhZ2VzKAogICAg
IGZvciAoIGkgPSAwOyBpIDwgKDEgPDwgb3JkZXIpOyBpKysgKQogICAgIHsK
ICAgICAgICAgQVNTRVJUKHBhZ2VfZ2V0X293bmVyKCZwZ1tpXSkgPT0gTlVM
TCk7Ci0gICAgICAgIEFTU0VSVCgocGdbaV0uY291bnRfaW5mbyAmIH4oUEdD
X2FsbG9jYXRlZCB8IDEpKSA9PSAwKTsKKyAgICAgICAgQVNTRVJUKCFwZ1tp
XS5jb3VudF9pbmZvKTsKICAgICAgICAgcGFnZV9zZXRfb3duZXIoJnBnW2ld
LCBkKTsKICAgICAgICAgc21wX3dtYigpOyAvKiBEb21haW4gcG9pbnRlciBt
dXN0IGJlIHZpc2libGUgYmVmb3JlIHVwZGF0aW5nIHJlZmNudC4gKi8KICAg
ICAgICAgcGdbaV0uY291bnRfaW5mbyA9IFBHQ19hbGxvY2F0ZWQgfCAxOwot
LSAKMi4yMC4xCgo=

--=separator
Content-Type: application/octet-stream; name="xsa287-4.8.patch"
Content-Disposition: attachment; filename="xsa287-4.8.patch"
Content-Transfer-Encoding: base64

RnJvbSBkNzMzMjNmZWQ3OGU0YmRhMTE2NDRiN2FhOWI5MDJhNzVmM2Q3MDVj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IEZyaSwgMTggSmFu
IDIwMTkgMTU6MDA6MzQgKzAwMDAKU3ViamVjdDogW1BBVENIXSBzdGVhbF9w
YWdlOiBHZXQgcmlkIG9mIGJvZ3VzIHN0cnVjdCBwYWdlIHN0YXRlcwoKVGhl
IG9yaWdpbmFsIHJ1bGVzIGZvciBgc3RydWN0IHBhZ2VgIHJlcXVpcmVkIHRo
ZSBmb2xsb3dpbmcgaW52YXJpYW50cwphdCBhbGwgdGltZXM6CgotIHJlZmNv
dW50ID4gMCBpbXBsaWVzIG93bmVyICE9IE5VTEwKLSBQR0NfYWxsb2NhdGVk
IGltcGxpZXMgcmVmY291bnQgPiAwCgpzdGVhbF9wYWdlLCBpbiBhIG1pc2d1
aWRlZCBhdHRlbXB0IHRvIHByb3RlY3QgYWdhaW5zdCB1bmtub3duIHJhY2Vz
LAp2aW9sYXRlcyBib3RoIG9mIHRoZXNlIHJ1bGVzLCB0aHVzIGludHJvZHVj
aW5nIG90aGVyIHJhY2VzOgoKLSBUZW1wb3JhcmlseSwgdGhlIGNvdW50X2lu
Zm8gaGFzIHRoZSByZWZjb3VudCBnbyB0byAwIHdoaWxlCiAgUEdDX2FsbG9j
YXRlZCBpcyBzZXQKCi0gSXQgZXhwbGljaXRseSByZXR1cm5zIHRoZSBwYWdl
IFBHQ19hbGxvY2F0ZWQgc2V0LCBidXQgb3duZXIgPT0gTlVMTAogIGFuZCBw
YWdlIG5vdCBvbiB0aGUgcGFnZV9saXN0LgoKVGhlIHNlY29uZCBvbmUgbWVh
bnQgdGhhdCBwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKCkgY291bGQg
cmV0dXJuCk5VTEwgZXZlbiBhZnRlciBoYXZpbmcgc3VjY2Vzc2Z1bGx5IGdy
YWJiZWQgYSByZWZlcmVuY2Ugb24gdGhlIHBhZ2UsCmxlYWRpbmcgdGhlIGNh
bGxlciB0byBsZWFrIHRoZSByZWZlcmVuY2UgKHNpbmNlICJjb3VsZG4ndCBn
ZXQgcmVmIiBhbmQKImdvdCByZWYgYnV0IG5vIG93bmVyIiBsb29rIHRoZSBz
YW1lKS4KCkZ1cnRoZXJtb3JlLCByYXRoZXIgdGhhbiBncmFiYmluZyBhIHBh
Z2UgcmVmZXJlbmNlIHRvIGVuc3VyZSB0aGF0IHRoZQpvd25lciBkb2Vzbid0
IGNoYW5nZSB1bmRlciBpdHMgZmVldCwgaXQgYXBwZWFycyB0byByZWx5IG9u
IGhvbGRpbmcKZC0+cGFnZV9hbGxvYyBsb2NrIHRvIHByZXZlbnQgdGhpcy4K
ClVuZm9ydHVuYXRlbHksIHRoaXMgaXMgaW5lZmZlY3RpdmU6IHBhZ2UtPm93
bmVyIHJlbWFpbnMgbm9uLU5VTEwgZm9yCnNvbWUgdGltZSBhZnRlciB0aGUg
Y291bnQgaGFzIGJlZW4gc2V0IHRvIDA7IG1lYW5pbmcgdGhhdCBpdCB3b3Vs
ZCBiZQplbnRpcmVseSBwb3NzaWJsZSBmb3IgdGhlIHBhZ2UgdG8gYmUgZnJl
ZWQgYW5kIHJlLWFsbG9jYXRlZCB0byBhCmRpZmZlcmVudCBkb21haW4gYmV0
d2VlbiB0aGUgcGFnZV9nZXRfb3duZXIoKSBjaGVjayBhbmQgdGhlIGNvdW50
X2luZm8KY2hlY2suCgpNb2RpZnkgc3RlYWxfcGFnZSB0byBpbnN0ZWFkIGZv
bGxvdyB0aGUgYXBwcm9wcmlhdGUgYWNjZXNzIGRpc2NpcGxpbmUsCnRha2lu
ZyB0aGUgcGFnZSB0aHJvdWdoIHNlcmllcyBvZiBzdGF0ZXMgc2ltaWxhciB0
byBiZWluZyBmcmVlZCBhbmQKdGhlbiByZS1hbGxvY2F0ZWQgd2l0aCBNRU1G
X25vX293bmVyOgoKLSBHcmFiIGFuIGV4dHJhIHJlZmVyZW5jZSB0byBtYWtl
IHN1cmUgd2UgZG9uJ3QgcmFjZSB3aXRoIGFueW9uZSBlbHNlCiAgZnJlZWlu
ZyB0aGUgcGFnZQoKLSBEcm9wIGJvdGggcmVmZXJlbmNlcyBhbmQgUEdDX2Fs
bG9jYXRlZCBhdG9taWNhbGx5LCBzbyB0aGF0IChpZgpzdWNjZXNzZnVsKSwg
YW55b25lIGVsc2UgdHJ5aW5nIHRvIGdyYWIgYSByZWZlcmVuY2Ugd2lsbCBm
YWlsCgotIEF0dGVtcHQgdG8gcmVzZXQgWGVuJ3MgbWFwcGluZ3MKCi0gUmVz
ZXQgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLgoKVGhlbiwgbW9kaWZ5IHRoZSB0
d28gY2FsbGVycyBhcHByb3ByaWF0ZWx5OgoKLSBMZWF2ZSBjb3VudF9pbmZv
IGFsb25lIChpdCdzIGFscmVhZHkgYmVlbiBjbGVhcmVkKQotIENhbGwgZnJl
ZV9kb21oZWFwX3BhZ2UoKSBkaXJlY3RseSBpZiBhcHByb3ByaWF0ZQotIENh
bGwgYXNzaWduX3BhZ2VzKCkgcmF0aGVyIHRoYW4gb3Blbi1jb2RpbmcgYSBw
YXJ0aWFsIGFzc2lnbgoKV2l0aCBhbGwgY2FsbGVycyB0byBhc3NpZ25fcGFn
ZXMoKSBub3cgcGFzc2luZyBpbiBwYWdlcyB3aXRoIHRoZQp0eXBlX2luZm8g
ZmllbGQgY2xlYXIsIHRpZ2h0ZW4gdGhlIHJlc3BlY3RpdmUgYXNzZXJ0aW9u
IHRoZXJlLgoKVGhpcyBpcyBYU0EtMjg3LgoKU2lnbmVkLW9mZi1ieTogR2Vv
cmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CgpCYWNr
cG9ydDogUmV0dXJuIC1FT1BOT1RTVVBQIGluIHBhZ2luZ19tb2RlX2V4dGVy
bmFsKCkgZm9yIGNvbnNpc3RlbmN5LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICAgICB8IDg2ICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0t
LS0tLS0tLS0KIHhlbi9jb21tb24vZ3JhbnRfdGFibGUuYyB8IDIwICsrKysr
LS0tLS0KIHhlbi9jb21tb24vbWVtb3J5LmMgICAgICB8IDE5ICsrKysrLS0t
LQogeGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMgIHwgIDIgKy0KIDQgZmlsZXMg
Y2hhbmdlZCwgODQgaW5zZXJ0aW9ucygrKSwgNDMgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCAyYjkzZWZiNTA0Li5lZjNiMjA4ZmIwIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtNDcyMiw2OSArNDcyMiwxMDUgQEAgaW50IGRvbmF0ZV9wYWdlKAogICAg
IHJldHVybiAtMTsKIH0KIAorLyoKKyAqIFN0ZWFsIHBhZ2Ugd2lsbCBhdHRl
bXB0IHRvIHJlbW92ZSBgcGFnZWAgZnJvbSBkb21haW4gYGRgLiAgVXBvbgor
ICogcmV0dXJuLCBgcGFnZWAgd2lsbCBiZSBpbiBhIHN0YXRlIHNpbWlsYXIg
dG8gdGhlIHN0YXRlIG9mIGEgcGFnZQorICogcmV0dXJuZWQgZnJvbSBhbGxv
Y19kb21oZWFwX3BhZ2UoKSB3aXRoIE1FTUZfbm9fb3duZXIgc2V0OgorICog
LSByZWZjb3VudCAwCisgKiAtIHR5cGUgY291bnQgY2xlYXJlZAorICogLSBv
d25lciBOVUxMCisgKiAtIHBhZ2UgY2FjaGluZyBhdHRyaWJ1dGVzIGNsZWFu
ZWQgdXAKKyAqIC0gcmVtb3ZlZCBmcm9tIHRoZSBkb21haW4ncyBwYWdlX2xp
c3QKKyAqCisgKiBJZiBNRU1GX25vX3JlZmNvdW50IGlzIG5vdCBzZXQsIHRo
ZSBkb21haW4ncyB0b3RfcGFnZXMgd2lsbCBiZQorICogYWRqdXN0ZWQuICBJ
ZiB0aGlzIHJlc3VsdHMgaW4gdGhlIHBhZ2UgY291bnQgZmFsbGluZyB0byAw
LAorICogcHV0X2RvbWFpbigpIHdpbGwgYmUgY2FsbGVkLgorICoKKyAqIFRo
ZSBjYWxsZXIgc2hvdWxkIGVpdGhlciBjYWxsIGZyZWVfZG9taGVhcF9wYWdl
KCkgdG8gZnJlZSB0aGUKKyAqIHBhZ2UsIG9yIGFzc2lnbl9wYWdlcygpIHRv
IHB1dCBpdCBiYWNrIG9uIHNvbWUgZG9tYWluJ3MgcGFnZSBsaXN0LgorICov
CiBpbnQgc3RlYWxfcGFnZSgKICAgICBzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBpbnQgbWVtZmxhZ3MpCiB7
CiAgICAgdW5zaWduZWQgbG9uZyB4LCB5OwogICAgIGJvb2xfdCBkcm9wX2Rv
bV9yZWYgPSAwOwotICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKm93bmVyID0g
ZG9tX3hlbjsKKyAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpvd25lcjsKKyAg
ICBpbnQgcmM7CiAKICAgICBpZiAoIHBhZ2luZ19tb2RlX2V4dGVybmFsKGQp
ICkKLSAgICAgICAgcmV0dXJuIC0xOwotCi0gICAgc3Bpbl9sb2NrKCZkLT5w
YWdlX2FsbG9jX2xvY2spOworICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7
CiAKLSAgICBpZiAoIGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkgfHwgKChvd25l
ciA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpKSAhPSBkKSApCisgICAgLyogR3Jh
YiBhIHJlZmVyZW5jZSB0byBtYWtlIHN1cmUgdGhlIHBhZ2UgZG9lc24ndCBj
aGFuZ2UgdW5kZXIgb3VyIGZlZXQgKi8KKyAgICByYyA9IC1FSU5WQUw7Cisg
ICAgaWYgKCAhKG93bmVyID0gcGFnZV9nZXRfb3duZXJfYW5kX3JlZmVyZW5j
ZShwYWdlKSkgKQogICAgICAgICBnb3RvIGZhaWw7CiAKKyAgICBpZiAoIG93
bmVyICE9IGQgfHwgaXNfeGVuX2hlYXBfcGFnZShwYWdlKSApCisgICAgICAg
IGdvdG8gZmFpbF9wdXQ7CisKICAgICAvKgotICAgICAqIFdlIHJlcXVpcmUg
dGhlcmUgaXMganVzdCBvbmUgcmVmZXJlbmNlIChQR0NfYWxsb2NhdGVkKS4g
V2UgdGVtcG9yYXJpbHkKLSAgICAgKiBkcm9wIHRoaXMgcmVmZXJlbmNlIG5v
dyBzbyB0aGF0IHdlIGNhbiBzYWZlbHkgc3dpenpsZSB0aGUgb3duZXIuCisg
ICAgICogV2UgcmVxdWlyZSB0aGVyZSBhcmUgZXhhY3RseSB0d28gcmVmZXJl
bmNlcyAtLSB0aGUgb25lIHdlIGp1c3QKKyAgICAgKiB0b29rLCBhbmQgUEdD
X2FsbG9jYXRlZC4gV2UgdGVtcG9yYXJpbHkgZHJvcCBib3RoIHRoZXNlCisg
ICAgICogcmVmZXJlbmNlcyBzbyB0aGF0IHRoZSBwYWdlIGJlY29tZXMgZWZm
ZWN0aXZlbHkgbm9uLSJsaXZlIiBmb3IKKyAgICAgKiB0aGUgZG9tYWluLgog
ICAgICAqLwogICAgIHkgPSBwYWdlLT5jb3VudF9pbmZvOwogICAgIGRvIHsK
ICAgICAgICAgeCA9IHk7Ci0gICAgICAgIGlmICggKHggJiAoUEdDX2NvdW50
X21hc2t8UEdDX2FsbG9jYXRlZCkpICE9ICgxIHwgUEdDX2FsbG9jYXRlZCkg
KQotICAgICAgICAgICAgZ290byBmYWlsOwotICAgICAgICB5ID0gY21weGNo
ZygmcGFnZS0+Y291bnRfaW5mbywgeCwgeCAmIH5QR0NfY291bnRfbWFzayk7
CisgICAgICAgIGlmICggKHggJiAoUEdDX2NvdW50X21hc2t8UEdDX2FsbG9j
YXRlZCkpICE9ICgyIHwgUEdDX2FsbG9jYXRlZCkgKQorICAgICAgICAgICAg
Z290byBmYWlsX3B1dDsKKyAgICAgICAgeSA9IGNtcHhjaGcoJnBhZ2UtPmNv
dW50X2luZm8sIHgsIHggJiB+KFBHQ19jb3VudF9tYXNrfFBHQ19hbGxvY2F0
ZWQpKTsKICAgICB9IHdoaWxlICggeSAhPSB4ICk7CiAKICAgICAvKgotICAg
ICAqIFdpdGggdGhlIHNvbGUgcmVmZXJlbmNlIGRyb3BwZWQgdGVtcG9yYXJp
bHksIG5vLW9uZSBjYW4gdXBkYXRlIHR5cGUKLSAgICAgKiBpbmZvcm1hdGlv
bi4gVHlwZSBjb3VudCBhbHNvIG5lZWRzIHRvIGJlIHplcm8gaW4gdGhpcyBj
YXNlLCBidXQgZS5nLgotICAgICAqIFBHVF9zZWdfZGVzY19wYWdlIG1heSBz
dGlsbCBoYXZlIFBHVF92YWxpZGF0ZWQgc2V0LCB3aGljaCB3ZSBuZWVkIHRv
Ci0gICAgICogY2xlYXIgYmVmb3JlIHRyYW5zZmVycmluZyBvd25lcnNoaXAg
KGFzIHZhbGlkYXRpb24gY3JpdGVyaWEgdmFyeQotICAgICAqIGRlcGVuZGlu
ZyBvbiBkb21haW4gdHlwZSkuCisgICAgICogTkIgdGhpcyBpcyBzYWZlIGV2
ZW4gaWYgdGhlIHBhZ2UgZW5kcyB1cCBiZWluZyBnaXZlbiBiYWNrIHRvCisg
ICAgICogdGhlIGRvbWFpbiwgYmVjYXVzZSB0aGUgY291bnQgaXMgemVybzog
c3Vic2VxdWVudCBtYXBwaW5ncyB3aWxsCisgICAgICogY2F1c2UgdGhlIGNh
Y2hlIGF0dHJpYnV0ZXMgdG8gYmUgcmUtaW5zdGF0ZWQgaW5zaWRlCisgICAg
ICogZ2V0X3BhZ2VfZnJvbV9sMWUoKS4KICAgICAgKi8KKyAgICBpZiAoIChy
YyA9IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIocGFnZSkpICkKKyAgICB7Cisg
ICAgICAgIC8qCisgICAgICAgICAqIENvdWxkbid0IGZpeHVwIFhlbidzIG1h
cHBpbmdzOyBwdXQgdGhpbmdzIHRoZSB3YXkgd2UgZm91bmQKKyAgICAgICAg
ICogaXQgYW5kIHJldHVybiBhbiBlcnJvcgorICAgICAgICAgKi8KKyAgICAg
ICAgcGFnZS0+Y291bnRfaW5mbyB8PSBQR0NfYWxsb2NhdGVkIHwgMTsKKyAg
ICAgICAgZ290byBmYWlsOworICAgIH0KKworICAgIC8qCisgICAgICogV2l0
aCB0aGUgcmVmZXJlbmNlIGNvdW50IG5vdyB6ZXJvLCBub2JvZHkgY2FuIGdy
YWIgcmVmZXJlbmNlcworICAgICAqIHRvIGRvIGFueXRoaW5nIGVsc2Ugd2l0
aCB0aGUgcGFnZS4gIFJldHVybiB0aGUgcGFnZSB0byBhIHN0YXRlCisgICAg
ICogdGhhdCBpdCBtaWdodCBiZSB1cG9uIHJldHVybiBmcm9tIGFsbG9jX2Rv
bWhlYXBfcGFnZXMgd2l0aAorICAgICAqIE1FTUZfbm9fb3duZXIgc2V0Lgor
ICAgICAqLworICAgIHNwaW5fbG9jaygmZC0+cGFnZV9hbGxvY19sb2NrKTsK
KwogICAgIEJVR19PTihwYWdlLT51LmludXNlLnR5cGVfaW5mbyAmIChQR1Rf
Y291bnRfbWFzayB8IFBHVF9sb2NrZWQgfAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBQR1RfcGlubmVkKSk7CiAgICAgcGFnZS0+
dS5pbnVzZS50eXBlX2luZm8gPSAwOwotCi0gICAgLyogU3dpenpsZSB0aGUg
b3duZXIgdGhlbiByZWluc3RhdGUgdGhlIFBHQ19hbGxvY2F0ZWQgcmVmZXJl
bmNlLiAqLwogICAgIHBhZ2Vfc2V0X293bmVyKHBhZ2UsIE5VTEwpOwotICAg
IHkgPSBwYWdlLT5jb3VudF9pbmZvOwotICAgIGRvIHsKLSAgICAgICAgeCA9
IHk7Ci0gICAgICAgIEJVR19PTigoeCAmIChQR0NfY291bnRfbWFza3xQR0Nf
YWxsb2NhdGVkKSkgIT0gUEdDX2FsbG9jYXRlZCk7Ci0gICAgfSB3aGlsZSAo
ICh5ID0gY21weGNoZygmcGFnZS0+Y291bnRfaW5mbywgeCwgeCB8IDEpKSAh
PSB4ICk7CisgICAgcGFnZV9saXN0X2RlbChwYWdlLCAmZC0+cGFnZV9saXN0
KTsKIAogICAgIC8qIFVubGluayBmcm9tIG9yaWdpbmFsIG93bmVyLiAqLwog
ICAgIGlmICggIShtZW1mbGFncyAmIE1FTUZfbm9fcmVmY291bnQpICYmICFk
b21haW5fYWRqdXN0X3RvdF9wYWdlcyhkLCAtMSkgKQogICAgICAgICBkcm9w
X2RvbV9yZWYgPSAxOwotICAgIHBhZ2VfbGlzdF9kZWwocGFnZSwgJmQtPnBh
Z2VfbGlzdCk7CiAKICAgICBzcGluX3VubG9jaygmZC0+cGFnZV9hbGxvY19s
b2NrKTsKKwogICAgIGlmICggdW5saWtlbHkoZHJvcF9kb21fcmVmKSApCiAg
ICAgICAgIHB1dF9kb21haW4oZCk7CisKICAgICByZXR1cm4gMDsKIAorIGZh
aWxfcHV0OgorICAgIHB1dF9wYWdlKHBhZ2UpOwogIGZhaWw6Ci0gICAgc3Bp
bl91bmxvY2soJmQtPnBhZ2VfYWxsb2NfbG9jayk7CiAgICAgTUVNX0xPRygi
QmFkIHBhZ2UgJWx4OiBlZD0lZCBzZD0lZCBjYWY9JTA4bHggdGFmPSUiIFBS
dHlwZV9pbmZvLAogICAgICAgICAgICAgcGFnZV90b19tZm4ocGFnZSksIGQt
PmRvbWFpbl9pZCwKICAgICAgICAgICAgIG93bmVyID8gb3duZXItPmRvbWFp
bl9pZCA6IERPTUlEX0lOVkFMSUQsCiAgICAgICAgICAgICBwYWdlLT5jb3Vu
dF9pbmZvLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7Ci0gICAgcmV0dXJu
IC0xOworICAgIHJldHVybiByYzsKIH0KIAogc3RhdGljIGludCBfX2RvX3Vw
ZGF0ZV92YV9tYXBwaW5nKApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9ncmFu
dF90YWJsZS5jIGIveGVuL2NvbW1vbi9ncmFudF90YWJsZS5jCmluZGV4IDI3
Y2NlMTc2YTMuLjAzZmUzOGFjYjUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
Z3JhbnRfdGFibGUuYworKysgYi94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMK
QEAgLTE5ODUsNyArMTk4NSw3IEBAIGdudHRhYl90cmFuc2ZlcigKICAgICAg
ICAgICAgIHJjdV91bmxvY2tfZG9tYWluKGUpOwogICAgICAgICBwdXRfZ2Zu
X2FuZF9jb3B5YmFjazoKICAgICAgICAgICAgIHB1dF9nZm4oZCwgZ29wLm1m
bik7Ci0gICAgICAgICAgICBwYWdlLT5jb3VudF9pbmZvICY9IH4oUEdDX2Nv
dW50X21hc2t8UEdDX2FsbG9jYXRlZCk7CisgICAgICAgICAgICAvKiBUaGUg
Y291bnRfaW5mbyBoYXMgYWxyZWFkeSBiZWVuIGNsZWFuZWQgKi8KICAgICAg
ICAgICAgIGZyZWVfZG9taGVhcF9wYWdlKHBhZ2UpOwogICAgICAgICAgICAg
Z290byBjb3B5YmFjazsKICAgICAgICAgfQpAQCAtMjAwOCwxMCArMjAwOCw5
IEBAIGdudHRhYl90cmFuc2ZlcigKIAogICAgICAgICAgICAgY29weV9kb21h
aW5fcGFnZShfbWZuKHBhZ2VfdG9fbWZuKG5ld19wYWdlKSksIF9tZm4obWZu
KSk7CiAKLSAgICAgICAgICAgIHBhZ2UtPmNvdW50X2luZm8gJj0gfihQR0Nf
Y291bnRfbWFza3xQR0NfYWxsb2NhdGVkKTsKKyAgICAgICAgICAgIC8qIFRo
ZSBjb3VudF9pbmZvIGhhcyBhbHJlYWR5IGJlZW4gY2xlYXJlZCAqLwogICAg
ICAgICAgICAgZnJlZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgICAg
ICBwYWdlID0gbmV3X3BhZ2U7Ci0gICAgICAgICAgICBwYWdlLT5jb3VudF9p
bmZvID0gUEdDX2FsbG9jYXRlZCB8IDE7CiAgICAgICAgICAgICBtZm4gPSBw
YWdlX3RvX21mbihwYWdlKTsKICAgICAgICAgfQogCkBAIC0yMDUxLDEyICsy
MDUwLDE3IEBAIGdudHRhYl90cmFuc2ZlcigKICAgICAgICAgICovCiAgICAg
ICAgIHNwaW5fdW5sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOwogICAgICAg
ICBva2F5ID0gZ250dGFiX3ByZXBhcmVfZm9yX3RyYW5zZmVyKGUsIGQsIGdv
cC5yZWYpOwotICAgICAgICBzcGluX2xvY2soJmUtPnBhZ2VfYWxsb2NfbG9j
ayk7CiAKLSAgICAgICAgaWYgKCB1bmxpa2VseSghb2theSkgfHwgdW5saWtl
bHkoZS0+aXNfZHlpbmcpICkKKyAgICAgICAgaWYgKCB1bmxpa2VseSghb2th
eSB8fCBhc3NpZ25fcGFnZXMoZSwgcGFnZSwgMCwgTUVNRl9ub19yZWZjb3Vu
dCkpICkKICAgICAgICAgewotICAgICAgICAgICAgYm9vbF90IGRyb3BfZG9t
X3JlZiA9ICFkb21haW5fYWRqdXN0X3RvdF9wYWdlcyhlLCAtMSk7CisgICAg
ICAgICAgICBib29sIGRyb3BfZG9tX3JlZjsKIAorICAgICAgICAgICAgLyoK
KyAgICAgICAgICAgICAqIE5lZWQgdG8gZ3JhYiB0aGlzIGFnYWluIHRvIHNh
ZmVseSBmcmVlIG91ciAicmVzZXJ2ZWQiCisgICAgICAgICAgICAgKiBwYWdl
IGluIHRoZSBwYWdlIHRvdGFsCisgICAgICAgICAgICAgKi8KKyAgICAgICAg
ICAgIHNwaW5fbG9jaygmZS0+cGFnZV9hbGxvY19sb2NrKTsKKyAgICAgICAg
ICAgIGRyb3BfZG9tX3JlZiA9ICFkb21haW5fYWRqdXN0X3RvdF9wYWdlcyhl
LCAtMSk7CiAgICAgICAgICAgICBzcGluX3VubG9jaygmZS0+cGFnZV9hbGxv
Y19sb2NrKTsKIAogICAgICAgICAgICAgaWYgKCBva2F5IC8qIGkuZS4gZS0+
aXNfZHlpbmcgZHVlIHRvIHRoZSBzdXJyb3VuZGluZyBpZigpICovICkKQEAg
LTIwNjksMTAgKzIwNzMsNiBAQCBnbnR0YWJfdHJhbnNmZXIoCiAgICAgICAg
ICAgICBnb3RvIHVubG9ja19hbmRfY29weWJhY2s7CiAgICAgICAgIH0KIAot
ICAgICAgICBwYWdlX2xpc3RfYWRkX3RhaWwocGFnZSwgJmUtPnBhZ2VfbGlz
dCk7Ci0gICAgICAgIHBhZ2Vfc2V0X293bmVyKHBhZ2UsIGUpOwotCi0gICAg
ICAgIHNwaW5fdW5sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOwogICAgICAg
ICBwdXRfZ2ZuKGQsIGdvcC5tZm4pOwogCiAgICAgICAgIFRSQUNFXzFEKFRS
Q19NRU1fUEFHRV9HUkFOVF9UUkFOU0ZFUiwgZS0+ZG9tYWluX2lkKTsKZGlm
ZiAtLWdpdCBhL3hlbi9jb21tb24vbWVtb3J5LmMgYi94ZW4vY29tbW9uL21l
bW9yeS5jCmluZGV4IGNkYTc5MTg1YjkuLjFjMGNkMGUzMTQgMTAwNjQ0Ci0t
LSBhL3hlbi9jb21tb24vbWVtb3J5LmMKKysrIGIveGVuL2NvbW1vbi9tZW1v
cnkuYwpAQCAtNjExLDIwICs2MTEsMjIgQEAgc3RhdGljIGxvbmcgbWVtb3J5
X2V4Y2hhbmdlKFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0oeGVuX21lbW9yeV9l
eGNoYW5nZV90KSBhcmcpCiAgICAgICAgICAqIFN1Y2Nlc3MhIEJleW9uZCB0
aGlzIHBvaW50IHdlIGNhbm5vdCBmYWlsIGZvciB0aGlzIGNodW5rLgogICAg
ICAgICAgKi8KIAotICAgICAgICAvKiBEZXN0cm95IGZpbmFsIHJlZmVyZW5j
ZSB0byBlYWNoIGlucHV0IHBhZ2UuICovCisgICAgICAgIC8qCisgICAgICAg
ICAqIFRoZXNlIHBhZ2VzIGhhdmUgYWxyZWFkeSBoYWQgb3duZXIgYW5kIHJl
ZmVyZW5jZSBjbGVhcmVkLgorICAgICAgICAgKiBEbyB0aGUgZmluYWwgdHdv
IHN0ZXBzOiBSZW1vdmUgZnJvbSB0aGUgcGh5c21hcCwgYW5kIGZyZWUKKyAg
ICAgICAgICogdGhlbS4KKyAgICAgICAgICovCiAgICAgICAgIHdoaWxlICgg
KHBhZ2UgPSBwYWdlX2xpc3RfcmVtb3ZlX2hlYWQoJmluX2NodW5rX2xpc3Qp
KSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgZ2Zu
OwogCi0gICAgICAgICAgICBpZiAoICF0ZXN0X2FuZF9jbGVhcl9iaXQoX1BH
Q19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZvKSApCi0gICAgICAgICAg
ICAgICAgQlVHKCk7CiAgICAgICAgICAgICBtZm4gPSBwYWdlX3RvX21mbihw
YWdlKTsKICAgICAgICAgICAgIGdmbiA9IG1mbl90b19nbWZuKGQsIG1mbik7
CiAgICAgICAgICAgICAvKiBQYWdlcyB3ZXJlIHVuc2hhcmVkIGFib3ZlICov
CiAgICAgICAgICAgICBCVUdfT04oU0hBUkVEX00yUChnZm4pKTsKICAgICAg
ICAgICAgIGlmICggZ3Vlc3RfcGh5c21hcF9yZW1vdmVfcGFnZShkLCBfZ2Zu
KGdmbiksIF9tZm4obWZuKSwgMCkgKQogICAgICAgICAgICAgICAgIGRvbWFp
bl9jcmFzaChkKTsKLSAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOworICAg
ICAgICAgICAgZnJlZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgIH0K
IAogICAgICAgICAvKiBBc3NpZ24gZWFjaCBvdXRwdXQgcGFnZSB0byB0aGUg
ZG9tYWluLiAqLwpAQCAtNjk3LDEzICs2OTksMTYgQEAgc3RhdGljIGxvbmcg
bWVtb3J5X2V4Y2hhbmdlKFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0oeGVuX21l
bW9yeV9leGNoYW5nZV90KSBhcmcpCiAgICAgICogY2h1bmtzIHN1Y2NlZWRl
ZC4KICAgICAgKi8KICBmYWlsOgotICAgIC8qIFJlYXNzaWduIGFueSBpbnB1
dCBwYWdlcyB3ZSBtYW5hZ2VkIHRvIHN0ZWFsLiAqLworICAgIC8qCisgICAg
ICogUmVhc3NpZ24gYW55IGlucHV0IHBhZ2VzIHdlIG1hbmFnZWQgdG8gc3Rl
YWwuICBOQiB0aGF0IGlmIHRoZSBhc3NpZ24KKyAgICAgKiBmYWlscyBhZ2Fp
biwgd2UncmUgb24gdGhlIGhvb2sgZm9yIGZyZWVpbmcgdGhlIHBhZ2UsIHNp
bmNlIHdlJ3ZlIGFscmVhZHkKKyAgICAgKiBjbGVhcmVkIFBHQ19hbGxvY2F0
ZWQuCisgICAgICovCiAgICAgd2hpbGUgKCAocGFnZSA9IHBhZ2VfbGlzdF9y
ZW1vdmVfaGVhZCgmaW5fY2h1bmtfbGlzdCkpICkKICAgICAgICAgaWYgKCBh
c3NpZ25fcGFnZXMoZCwgcGFnZSwgMCwgTUVNRl9ub19yZWZjb3VudCkgKQog
ICAgICAgICB7CiAgICAgICAgICAgICBCVUdfT04oIWQtPmlzX2R5aW5nKTsK
LSAgICAgICAgICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KF9QR0NfYWxs
b2NhdGVkLCAmcGFnZS0+Y291bnRfaW5mbykgKQotICAgICAgICAgICAgICAg
IHB1dF9wYWdlKHBhZ2UpOworICAgICAgICAgICAgZnJlZV9kb21oZWFwX3Bh
Z2UocGFnZSk7CiAgICAgICAgIH0KIAogIGR5aW5nOgpkaWZmIC0tZ2l0IGEv
eGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMgYi94ZW4vY29tbW9uL3BhZ2VfYWxs
b2MuYwppbmRleCAyYjUzYTI1ZjFjLi44ZDQxYjVhZmZhIDEwMDY0NAotLS0g
YS94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYworKysgYi94ZW4vY29tbW9uL3Bh
Z2VfYWxsb2MuYwpAQCAtMTc3MCw3ICsxNzcwLDcgQEAgaW50IGFzc2lnbl9w
YWdlcygKICAgICBmb3IgKCBpID0gMDsgaSA8ICgxIDw8IG9yZGVyKTsgaSsr
ICkKICAgICB7CiAgICAgICAgIEFTU0VSVChwYWdlX2dldF9vd25lcigmcGdb
aV0pID09IE5VTEwpOwotICAgICAgICBBU1NFUlQoKHBnW2ldLmNvdW50X2lu
Zm8gJiB+KFBHQ19hbGxvY2F0ZWQgfCAxKSkgPT0gMCk7CisgICAgICAgIEFT
U0VSVCghcGdbaV0uY291bnRfaW5mbyk7CiAgICAgICAgIHBhZ2Vfc2V0X293
bmVyKCZwZ1tpXSwgZCk7CiAgICAgICAgIHNtcF93bWIoKTsgLyogRG9tYWlu
IHBvaW50ZXIgbXVzdCBiZSB2aXNpYmxlIGJlZm9yZSB1cGRhdGluZyByZWZj
bnQuICovCiAgICAgICAgIHBnW2ldLmNvdW50X2luZm8gPSBQR0NfYWxsb2Nh
dGVkIHwgMTsKLS0gCjIuMjAuMQoK

--=separator
Content-Type: application/octet-stream; name="xsa287-4.9.patch"
Content-Disposition: attachment; filename="xsa287-4.9.patch"
Content-Transfer-Encoding: base64

RnJvbSBhNTE1NzVlZTNmNTc0YTczY2NiNzZiYTMxZTljNjZkMWYwMzRhNzMx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IEZyaSwgMTggSmFu
IDIwMTkgMTU6MDA6MzQgKzAwMDAKU3ViamVjdDogW1BBVENIXSBzdGVhbF9w
YWdlOiBHZXQgcmlkIG9mIGJvZ3VzIHN0cnVjdCBwYWdlIHN0YXRlcwoKVGhl
IG9yaWdpbmFsIHJ1bGVzIGZvciBgc3RydWN0IHBhZ2VgIHJlcXVpcmVkIHRo
ZSBmb2xsb3dpbmcgaW52YXJpYW50cwphdCBhbGwgdGltZXM6CgotIHJlZmNv
dW50ID4gMCBpbXBsaWVzIG93bmVyICE9IE5VTEwKLSBQR0NfYWxsb2NhdGVk
IGltcGxpZXMgcmVmY291bnQgPiAwCgpzdGVhbF9wYWdlLCBpbiBhIG1pc2d1
aWRlZCBhdHRlbXB0IHRvIHByb3RlY3QgYWdhaW5zdCB1bmtub3duIHJhY2Vz
LAp2aW9sYXRlcyBib3RoIG9mIHRoZXNlIHJ1bGVzLCB0aHVzIGludHJvZHVj
aW5nIG90aGVyIHJhY2VzOgoKLSBUZW1wb3JhcmlseSwgdGhlIGNvdW50X2lu
Zm8gaGFzIHRoZSByZWZjb3VudCBnbyB0byAwIHdoaWxlCiAgUEdDX2FsbG9j
YXRlZCBpcyBzZXQKCi0gSXQgZXhwbGljaXRseSByZXR1cm5zIHRoZSBwYWdl
IFBHQ19hbGxvY2F0ZWQgc2V0LCBidXQgb3duZXIgPT0gTlVMTAogIGFuZCBw
YWdlIG5vdCBvbiB0aGUgcGFnZV9saXN0LgoKVGhlIHNlY29uZCBvbmUgbWVh
bnQgdGhhdCBwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKCkgY291bGQg
cmV0dXJuCk5VTEwgZXZlbiBhZnRlciBoYXZpbmcgc3VjY2Vzc2Z1bGx5IGdy
YWJiZWQgYSByZWZlcmVuY2Ugb24gdGhlIHBhZ2UsCmxlYWRpbmcgdGhlIGNh
bGxlciB0byBsZWFrIHRoZSByZWZlcmVuY2UgKHNpbmNlICJjb3VsZG4ndCBn
ZXQgcmVmIiBhbmQKImdvdCByZWYgYnV0IG5vIG93bmVyIiBsb29rIHRoZSBz
YW1lKS4KCkZ1cnRoZXJtb3JlLCByYXRoZXIgdGhhbiBncmFiYmluZyBhIHBh
Z2UgcmVmZXJlbmNlIHRvIGVuc3VyZSB0aGF0IHRoZQpvd25lciBkb2Vzbid0
IGNoYW5nZSB1bmRlciBpdHMgZmVldCwgaXQgYXBwZWFycyB0byByZWx5IG9u
IGhvbGRpbmcKZC0+cGFnZV9hbGxvYyBsb2NrIHRvIHByZXZlbnQgdGhpcy4K
ClVuZm9ydHVuYXRlbHksIHRoaXMgaXMgaW5lZmZlY3RpdmU6IHBhZ2UtPm93
bmVyIHJlbWFpbnMgbm9uLU5VTEwgZm9yCnNvbWUgdGltZSBhZnRlciB0aGUg
Y291bnQgaGFzIGJlZW4gc2V0IHRvIDA7IG1lYW5pbmcgdGhhdCBpdCB3b3Vs
ZCBiZQplbnRpcmVseSBwb3NzaWJsZSBmb3IgdGhlIHBhZ2UgdG8gYmUgZnJl
ZWQgYW5kIHJlLWFsbG9jYXRlZCB0byBhCmRpZmZlcmVudCBkb21haW4gYmV0
d2VlbiB0aGUgcGFnZV9nZXRfb3duZXIoKSBjaGVjayBhbmQgdGhlIGNvdW50
X2luZm8KY2hlY2suCgpNb2RpZnkgc3RlYWxfcGFnZSB0byBpbnN0ZWFkIGZv
bGxvdyB0aGUgYXBwcm9wcmlhdGUgYWNjZXNzIGRpc2NpcGxpbmUsCnRha2lu
ZyB0aGUgcGFnZSB0aHJvdWdoIHNlcmllcyBvZiBzdGF0ZXMgc2ltaWxhciB0
byBiZWluZyBmcmVlZCBhbmQKdGhlbiByZS1hbGxvY2F0ZWQgd2l0aCBNRU1G
X25vX293bmVyOgoKLSBHcmFiIGFuIGV4dHJhIHJlZmVyZW5jZSB0byBtYWtl
IHN1cmUgd2UgZG9uJ3QgcmFjZSB3aXRoIGFueW9uZSBlbHNlCiAgZnJlZWlu
ZyB0aGUgcGFnZQoKLSBEcm9wIGJvdGggcmVmZXJlbmNlcyBhbmQgUEdDX2Fs
bG9jYXRlZCBhdG9taWNhbGx5LCBzbyB0aGF0IChpZgpzdWNjZXNzZnVsKSwg
YW55b25lIGVsc2UgdHJ5aW5nIHRvIGdyYWIgYSByZWZlcmVuY2Ugd2lsbCBm
YWlsCgotIEF0dGVtcHQgdG8gcmVzZXQgWGVuJ3MgbWFwcGluZ3MKCi0gUmVz
ZXQgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLgoKVGhlbiwgbW9kaWZ5IHRoZSB0
d28gY2FsbGVycyBhcHByb3ByaWF0ZWx5OgoKLSBMZWF2ZSBjb3VudF9pbmZv
IGFsb25lIChpdCdzIGFscmVhZHkgYmVlbiBjbGVhcmVkKQotIENhbGwgZnJl
ZV9kb21oZWFwX3BhZ2UoKSBkaXJlY3RseSBpZiBhcHByb3ByaWF0ZQotIENh
bGwgYXNzaWduX3BhZ2VzKCkgcmF0aGVyIHRoYW4gb3Blbi1jb2RpbmcgYSBw
YXJ0aWFsIGFzc2lnbgoKV2l0aCBhbGwgY2FsbGVycyB0byBhc3NpZ25fcGFn
ZXMoKSBub3cgcGFzc2luZyBpbiBwYWdlcyB3aXRoIHRoZQp0eXBlX2luZm8g
ZmllbGQgY2xlYXIsIHRpZ2h0ZW4gdGhlIHJlc3BlY3RpdmUgYXNzZXJ0aW9u
IHRoZXJlLgoKVGhpcyBpcyBYU0EtMjg3LgoKU2lnbmVkLW9mZi1ieTogR2Vv
cmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CgpCYWNr
cG9ydDogUmV0dXJuIC1FT1BOT1RTVVBQIGluIHBhZ2luZ19tb2RlX2V4dGVy
bmFsKCkgZm9yIGNvbnNpc3RlbmN5LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICAgICB8IDg2ICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0t
LS0tLS0tLS0KIHhlbi9jb21tb24vZ3JhbnRfdGFibGUuYyB8IDIwICsrKysr
LS0tLS0KIHhlbi9jb21tb24vbWVtb3J5LmMgICAgICB8IDE5ICsrKysrLS0t
LQogeGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMgIHwgIDIgKy0KIDQgZmlsZXMg
Y2hhbmdlZCwgODQgaW5zZXJ0aW9ucygrKSwgNDMgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCAyOTgyZWVjNDNlLi40NzZlZjhlZTg1IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtNDc3NSw3MCArNDc3NSwxMDYgQEAgaW50IGRvbmF0ZV9wYWdlKAogICAg
IHJldHVybiAtMTsKIH0KIAorLyoKKyAqIFN0ZWFsIHBhZ2Ugd2lsbCBhdHRl
bXB0IHRvIHJlbW92ZSBgcGFnZWAgZnJvbSBkb21haW4gYGRgLiAgVXBvbgor
ICogcmV0dXJuLCBgcGFnZWAgd2lsbCBiZSBpbiBhIHN0YXRlIHNpbWlsYXIg
dG8gdGhlIHN0YXRlIG9mIGEgcGFnZQorICogcmV0dXJuZWQgZnJvbSBhbGxv
Y19kb21oZWFwX3BhZ2UoKSB3aXRoIE1FTUZfbm9fb3duZXIgc2V0OgorICog
LSByZWZjb3VudCAwCisgKiAtIHR5cGUgY291bnQgY2xlYXJlZAorICogLSBv
d25lciBOVUxMCisgKiAtIHBhZ2UgY2FjaGluZyBhdHRyaWJ1dGVzIGNsZWFu
ZWQgdXAKKyAqIC0gcmVtb3ZlZCBmcm9tIHRoZSBkb21haW4ncyBwYWdlX2xp
c3QKKyAqCisgKiBJZiBNRU1GX25vX3JlZmNvdW50IGlzIG5vdCBzZXQsIHRo
ZSBkb21haW4ncyB0b3RfcGFnZXMgd2lsbCBiZQorICogYWRqdXN0ZWQuICBJ
ZiB0aGlzIHJlc3VsdHMgaW4gdGhlIHBhZ2UgY291bnQgZmFsbGluZyB0byAw
LAorICogcHV0X2RvbWFpbigpIHdpbGwgYmUgY2FsbGVkLgorICoKKyAqIFRo
ZSBjYWxsZXIgc2hvdWxkIGVpdGhlciBjYWxsIGZyZWVfZG9taGVhcF9wYWdl
KCkgdG8gZnJlZSB0aGUKKyAqIHBhZ2UsIG9yIGFzc2lnbl9wYWdlcygpIHRv
IHB1dCBpdCBiYWNrIG9uIHNvbWUgZG9tYWluJ3MgcGFnZSBsaXN0LgorICov
CiBpbnQgc3RlYWxfcGFnZSgKICAgICBzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBpbnQgbWVtZmxhZ3MpCiB7
CiAgICAgdW5zaWduZWQgbG9uZyB4LCB5OwogICAgIGJvb2xfdCBkcm9wX2Rv
bV9yZWYgPSAwOwotICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKm93bmVyID0g
ZG9tX3hlbjsKKyAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpvd25lcjsKKyAg
ICBpbnQgcmM7CiAKICAgICBpZiAoIHBhZ2luZ19tb2RlX2V4dGVybmFsKGQp
ICkKLSAgICAgICAgcmV0dXJuIC0xOwotCi0gICAgc3Bpbl9sb2NrKCZkLT5w
YWdlX2FsbG9jX2xvY2spOworICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7
CiAKLSAgICBpZiAoIGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkgfHwgKChvd25l
ciA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpKSAhPSBkKSApCisgICAgLyogR3Jh
YiBhIHJlZmVyZW5jZSB0byBtYWtlIHN1cmUgdGhlIHBhZ2UgZG9lc24ndCBj
aGFuZ2UgdW5kZXIgb3VyIGZlZXQgKi8KKyAgICByYyA9IC1FSU5WQUw7Cisg
ICAgaWYgKCAhKG93bmVyID0gcGFnZV9nZXRfb3duZXJfYW5kX3JlZmVyZW5j
ZShwYWdlKSkgKQogICAgICAgICBnb3RvIGZhaWw7CiAKKyAgICBpZiAoIG93
bmVyICE9IGQgfHwgaXNfeGVuX2hlYXBfcGFnZShwYWdlKSApCisgICAgICAg
IGdvdG8gZmFpbF9wdXQ7CisKICAgICAvKgotICAgICAqIFdlIHJlcXVpcmUg
dGhlcmUgaXMganVzdCBvbmUgcmVmZXJlbmNlIChQR0NfYWxsb2NhdGVkKS4g
V2UgdGVtcG9yYXJpbHkKLSAgICAgKiBkcm9wIHRoaXMgcmVmZXJlbmNlIG5v
dyBzbyB0aGF0IHdlIGNhbiBzYWZlbHkgc3dpenpsZSB0aGUgb3duZXIuCisg
ICAgICogV2UgcmVxdWlyZSB0aGVyZSBhcmUgZXhhY3RseSB0d28gcmVmZXJl
bmNlcyAtLSB0aGUgb25lIHdlIGp1c3QKKyAgICAgKiB0b29rLCBhbmQgUEdD
X2FsbG9jYXRlZC4gV2UgdGVtcG9yYXJpbHkgZHJvcCBib3RoIHRoZXNlCisg
ICAgICogcmVmZXJlbmNlcyBzbyB0aGF0IHRoZSBwYWdlIGJlY29tZXMgZWZm
ZWN0aXZlbHkgbm9uLSJsaXZlIiBmb3IKKyAgICAgKiB0aGUgZG9tYWluLgog
ICAgICAqLwogICAgIHkgPSBwYWdlLT5jb3VudF9pbmZvOwogICAgIGRvIHsK
ICAgICAgICAgeCA9IHk7Ci0gICAgICAgIGlmICggKHggJiAoUEdDX2NvdW50
X21hc2t8UEdDX2FsbG9jYXRlZCkpICE9ICgxIHwgUEdDX2FsbG9jYXRlZCkg
KQotICAgICAgICAgICAgZ290byBmYWlsOwotICAgICAgICB5ID0gY21weGNo
ZygmcGFnZS0+Y291bnRfaW5mbywgeCwgeCAmIH5QR0NfY291bnRfbWFzayk7
CisgICAgICAgIGlmICggKHggJiAoUEdDX2NvdW50X21hc2t8UEdDX2FsbG9j
YXRlZCkpICE9ICgyIHwgUEdDX2FsbG9jYXRlZCkgKQorICAgICAgICAgICAg
Z290byBmYWlsX3B1dDsKKyAgICAgICAgeSA9IGNtcHhjaGcoJnBhZ2UtPmNv
dW50X2luZm8sIHgsIHggJiB+KFBHQ19jb3VudF9tYXNrfFBHQ19hbGxvY2F0
ZWQpKTsKICAgICB9IHdoaWxlICggeSAhPSB4ICk7CiAKICAgICAvKgotICAg
ICAqIFdpdGggdGhlIHNvbGUgcmVmZXJlbmNlIGRyb3BwZWQgdGVtcG9yYXJp
bHksIG5vLW9uZSBjYW4gdXBkYXRlIHR5cGUKLSAgICAgKiBpbmZvcm1hdGlv
bi4gVHlwZSBjb3VudCBhbHNvIG5lZWRzIHRvIGJlIHplcm8gaW4gdGhpcyBj
YXNlLCBidXQgZS5nLgotICAgICAqIFBHVF9zZWdfZGVzY19wYWdlIG1heSBz
dGlsbCBoYXZlIFBHVF92YWxpZGF0ZWQgc2V0LCB3aGljaCB3ZSBuZWVkIHRv
Ci0gICAgICogY2xlYXIgYmVmb3JlIHRyYW5zZmVycmluZyBvd25lcnNoaXAg
KGFzIHZhbGlkYXRpb24gY3JpdGVyaWEgdmFyeQotICAgICAqIGRlcGVuZGlu
ZyBvbiBkb21haW4gdHlwZSkuCisgICAgICogTkIgdGhpcyBpcyBzYWZlIGV2
ZW4gaWYgdGhlIHBhZ2UgZW5kcyB1cCBiZWluZyBnaXZlbiBiYWNrIHRvCisg
ICAgICogdGhlIGRvbWFpbiwgYmVjYXVzZSB0aGUgY291bnQgaXMgemVybzog
c3Vic2VxdWVudCBtYXBwaW5ncyB3aWxsCisgICAgICogY2F1c2UgdGhlIGNh
Y2hlIGF0dHJpYnV0ZXMgdG8gYmUgcmUtaW5zdGF0ZWQgaW5zaWRlCisgICAg
ICogZ2V0X3BhZ2VfZnJvbV9sMWUoKS4KICAgICAgKi8KKyAgICBpZiAoIChy
YyA9IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIocGFnZSkpICkKKyAgICB7Cisg
ICAgICAgIC8qCisgICAgICAgICAqIENvdWxkbid0IGZpeHVwIFhlbidzIG1h
cHBpbmdzOyBwdXQgdGhpbmdzIHRoZSB3YXkgd2UgZm91bmQKKyAgICAgICAg
ICogaXQgYW5kIHJldHVybiBhbiBlcnJvcgorICAgICAgICAgKi8KKyAgICAg
ICAgcGFnZS0+Y291bnRfaW5mbyB8PSBQR0NfYWxsb2NhdGVkIHwgMTsKKyAg
ICAgICAgZ290byBmYWlsOworICAgIH0KKworICAgIC8qCisgICAgICogV2l0
aCB0aGUgcmVmZXJlbmNlIGNvdW50IG5vdyB6ZXJvLCBub2JvZHkgY2FuIGdy
YWIgcmVmZXJlbmNlcworICAgICAqIHRvIGRvIGFueXRoaW5nIGVsc2Ugd2l0
aCB0aGUgcGFnZS4gIFJldHVybiB0aGUgcGFnZSB0byBhIHN0YXRlCisgICAg
ICogdGhhdCBpdCBtaWdodCBiZSB1cG9uIHJldHVybiBmcm9tIGFsbG9jX2Rv
bWhlYXBfcGFnZXMgd2l0aAorICAgICAqIE1FTUZfbm9fb3duZXIgc2V0Lgor
ICAgICAqLworICAgIHNwaW5fbG9jaygmZC0+cGFnZV9hbGxvY19sb2NrKTsK
KwogICAgIEJVR19PTihwYWdlLT51LmludXNlLnR5cGVfaW5mbyAmIChQR1Rf
Y291bnRfbWFzayB8IFBHVF9sb2NrZWQgfAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBQR1RfcGlubmVkKSk7CiAgICAgcGFnZS0+
dS5pbnVzZS50eXBlX2luZm8gPSAwOwotCi0gICAgLyogU3dpenpsZSB0aGUg
b3duZXIgdGhlbiByZWluc3RhdGUgdGhlIFBHQ19hbGxvY2F0ZWQgcmVmZXJl
bmNlLiAqLwogICAgIHBhZ2Vfc2V0X293bmVyKHBhZ2UsIE5VTEwpOwotICAg
IHkgPSBwYWdlLT5jb3VudF9pbmZvOwotICAgIGRvIHsKLSAgICAgICAgeCA9
IHk7Ci0gICAgICAgIEJVR19PTigoeCAmIChQR0NfY291bnRfbWFza3xQR0Nf
YWxsb2NhdGVkKSkgIT0gUEdDX2FsbG9jYXRlZCk7Ci0gICAgfSB3aGlsZSAo
ICh5ID0gY21weGNoZygmcGFnZS0+Y291bnRfaW5mbywgeCwgeCB8IDEpKSAh
PSB4ICk7CisgICAgcGFnZV9saXN0X2RlbChwYWdlLCAmZC0+cGFnZV9saXN0
KTsKIAogICAgIC8qIFVubGluayBmcm9tIG9yaWdpbmFsIG93bmVyLiAqLwog
ICAgIGlmICggIShtZW1mbGFncyAmIE1FTUZfbm9fcmVmY291bnQpICYmICFk
b21haW5fYWRqdXN0X3RvdF9wYWdlcyhkLCAtMSkgKQogICAgICAgICBkcm9w
X2RvbV9yZWYgPSAxOwotICAgIHBhZ2VfbGlzdF9kZWwocGFnZSwgJmQtPnBh
Z2VfbGlzdCk7CiAKICAgICBzcGluX3VubG9jaygmZC0+cGFnZV9hbGxvY19s
b2NrKTsKKwogICAgIGlmICggdW5saWtlbHkoZHJvcF9kb21fcmVmKSApCiAg
ICAgICAgIHB1dF9kb21haW4oZCk7CisKICAgICByZXR1cm4gMDsKIAorIGZh
aWxfcHV0OgorICAgIHB1dF9wYWdlKHBhZ2UpOwogIGZhaWw6Ci0gICAgc3Bp
bl91bmxvY2soJmQtPnBhZ2VfYWxsb2NfbG9jayk7CiAgICAgZ2RwcmludGso
WEVOTE9HX1dBUk5JTkcsICJCYWQgc3RlYWwgbWZuICUiIFBSSV9tZm4KICAg
ICAgICAgICAgICAiIGZyb20gZCVkIChvd25lciBkJWQpIGNhZj0lMDhseCB0
YWY9JSIgUFJ0eXBlX2luZm8gIlxuIiwKICAgICAgICAgICAgICBwYWdlX3Rv
X21mbihwYWdlKSwgZC0+ZG9tYWluX2lkLAogICAgICAgICAgICAgIG93bmVy
ID8gb3duZXItPmRvbWFpbl9pZCA6IERPTUlEX0lOVkFMSUQsCiAgICAgICAg
ICAgICAgcGFnZS0+Y291bnRfaW5mbywgcGFnZS0+dS5pbnVzZS50eXBlX2lu
Zm8pOwotICAgIHJldHVybiAtMTsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0
YXRpYyBpbnQgX19kb191cGRhdGVfdmFfbWFwcGluZygKZGlmZiAtLWdpdCBh
L3hlbi9jb21tb24vZ3JhbnRfdGFibGUuYyBiL3hlbi9jb21tb24vZ3JhbnRf
dGFibGUuYwppbmRleCA1ZWUwOTgxODMyLi41YjMzOGU5NWZmIDEwMDY0NAot
LS0gYS94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMKKysrIGIveGVuL2NvbW1v
bi9ncmFudF90YWJsZS5jCkBAIC0xOTg1LDcgKzE5ODUsNyBAQCBnbnR0YWJf
dHJhbnNmZXIoCiAgICAgICAgICAgICByY3VfdW5sb2NrX2RvbWFpbihlKTsK
ICAgICAgICAgcHV0X2dmbl9hbmRfY29weWJhY2s6CiAgICAgICAgICAgICBw
dXRfZ2ZuKGQsIGdvcC5tZm4pOwotICAgICAgICAgICAgcGFnZS0+Y291bnRf
aW5mbyAmPSB+KFBHQ19jb3VudF9tYXNrfFBHQ19hbGxvY2F0ZWQpOworICAg
ICAgICAgICAgLyogVGhlIGNvdW50X2luZm8gaGFzIGFscmVhZHkgYmVlbiBj
bGVhbmVkICovCiAgICAgICAgICAgICBmcmVlX2RvbWhlYXBfcGFnZShwYWdl
KTsKICAgICAgICAgICAgIGdvdG8gY29weWJhY2s7CiAgICAgICAgIH0KQEAg
LTIwMDgsMTAgKzIwMDgsOSBAQCBnbnR0YWJfdHJhbnNmZXIoCiAKICAgICAg
ICAgICAgIGNvcHlfZG9tYWluX3BhZ2UoX21mbihwYWdlX3RvX21mbihuZXdf
cGFnZSkpLCBfbWZuKG1mbikpOwogCi0gICAgICAgICAgICBwYWdlLT5jb3Vu
dF9pbmZvICY9IH4oUEdDX2NvdW50X21hc2t8UEdDX2FsbG9jYXRlZCk7Cisg
ICAgICAgICAgICAvKiBUaGUgY291bnRfaW5mbyBoYXMgYWxyZWFkeSBiZWVu
IGNsZWFyZWQgKi8KICAgICAgICAgICAgIGZyZWVfZG9taGVhcF9wYWdlKHBh
Z2UpOwogICAgICAgICAgICAgcGFnZSA9IG5ld19wYWdlOwotICAgICAgICAg
ICAgcGFnZS0+Y291bnRfaW5mbyA9IFBHQ19hbGxvY2F0ZWQgfCAxOwogICAg
ICAgICAgICAgbWZuID0gcGFnZV90b19tZm4ocGFnZSk7CiAgICAgICAgIH0K
IApAQCAtMjA1MSwxMiArMjA1MCwxNyBAQCBnbnR0YWJfdHJhbnNmZXIoCiAg
ICAgICAgICAqLwogICAgICAgICBzcGluX3VubG9jaygmZS0+cGFnZV9hbGxv
Y19sb2NrKTsKICAgICAgICAgb2theSA9IGdudHRhYl9wcmVwYXJlX2Zvcl90
cmFuc2ZlcihlLCBkLCBnb3AucmVmKTsKLSAgICAgICAgc3Bpbl9sb2NrKCZl
LT5wYWdlX2FsbG9jX2xvY2spOwogCi0gICAgICAgIGlmICggdW5saWtlbHko
IW9rYXkpIHx8IHVubGlrZWx5KGUtPmlzX2R5aW5nKSApCisgICAgICAgIGlm
ICggdW5saWtlbHkoIW9rYXkgfHwgYXNzaWduX3BhZ2VzKGUsIHBhZ2UsIDAs
IE1FTUZfbm9fcmVmY291bnQpKSApCiAgICAgICAgIHsKLSAgICAgICAgICAg
IGJvb2xfdCBkcm9wX2RvbV9yZWYgPSAhZG9tYWluX2FkanVzdF90b3RfcGFn
ZXMoZSwgLTEpOworICAgICAgICAgICAgYm9vbCBkcm9wX2RvbV9yZWY7CiAK
KyAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgKiBOZWVkIHRvIGdyYWIg
dGhpcyBhZ2FpbiB0byBzYWZlbHkgZnJlZSBvdXIgInJlc2VydmVkIgorICAg
ICAgICAgICAgICogcGFnZSBpbiB0aGUgcGFnZSB0b3RhbAorICAgICAgICAg
ICAgICovCisgICAgICAgICAgICBzcGluX2xvY2soJmUtPnBhZ2VfYWxsb2Nf
bG9jayk7CisgICAgICAgICAgICBkcm9wX2RvbV9yZWYgPSAhZG9tYWluX2Fk
anVzdF90b3RfcGFnZXMoZSwgLTEpOwogICAgICAgICAgICAgc3Bpbl91bmxv
Y2soJmUtPnBhZ2VfYWxsb2NfbG9jayk7CiAKICAgICAgICAgICAgIGlmICgg
b2theSAvKiBpLmUuIGUtPmlzX2R5aW5nIGR1ZSB0byB0aGUgc3Vycm91bmRp
bmcgaWYoKSAqLyApCkBAIC0yMDY5LDEwICsyMDczLDYgQEAgZ250dGFiX3Ry
YW5zZmVyKAogICAgICAgICAgICAgZ290byB1bmxvY2tfYW5kX2NvcHliYWNr
OwogICAgICAgICB9CiAKLSAgICAgICAgcGFnZV9saXN0X2FkZF90YWlsKHBh
Z2UsICZlLT5wYWdlX2xpc3QpOwotICAgICAgICBwYWdlX3NldF9vd25lcihw
YWdlLCBlKTsKLQotICAgICAgICBzcGluX3VubG9jaygmZS0+cGFnZV9hbGxv
Y19sb2NrKTsKICAgICAgICAgcHV0X2dmbihkLCBnb3AubWZuKTsKIAogICAg
ICAgICBUUkFDRV8xRChUUkNfTUVNX1BBR0VfR1JBTlRfVFJBTlNGRVIsIGUt
PmRvbWFpbl9pZCk7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL21lbW9yeS5j
IGIveGVuL2NvbW1vbi9tZW1vcnkuYwppbmRleCBjMWQwZGEzMThlLi4xYWRl
NjJhMzA5IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL21lbW9yeS5jCisrKyBi
L3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTYxMCwyMCArNjEwLDIyIEBAIHN0
YXRpYyBsb25nIG1lbW9yeV9leGNoYW5nZShYRU5fR1VFU1RfSEFORExFX1BB
UkFNKHhlbl9tZW1vcnlfZXhjaGFuZ2VfdCkgYXJnKQogICAgICAgICAgKiBT
dWNjZXNzISBCZXlvbmQgdGhpcyBwb2ludCB3ZSBjYW5ub3QgZmFpbCBmb3Ig
dGhpcyBjaHVuay4KICAgICAgICAgICovCiAKLSAgICAgICAgLyogRGVzdHJv
eSBmaW5hbCByZWZlcmVuY2UgdG8gZWFjaCBpbnB1dCBwYWdlLiAqLworICAg
ICAgICAvKgorICAgICAgICAgKiBUaGVzZSBwYWdlcyBoYXZlIGFscmVhZHkg
aGFkIG93bmVyIGFuZCByZWZlcmVuY2UgY2xlYXJlZC4KKyAgICAgICAgICog
RG8gdGhlIGZpbmFsIHR3byBzdGVwczogUmVtb3ZlIGZyb20gdGhlIHBoeXNt
YXAsIGFuZCBmcmVlCisgICAgICAgICAqIHRoZW0uCisgICAgICAgICAqLwog
ICAgICAgICB3aGlsZSAoIChwYWdlID0gcGFnZV9saXN0X3JlbW92ZV9oZWFk
KCZpbl9jaHVua19saXN0KSkgKQogICAgICAgICB7CiAgICAgICAgICAgICB1
bnNpZ25lZCBsb25nIGdmbjsKIAotICAgICAgICAgICAgaWYgKCAhdGVzdF9h
bmRfY2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRfaW5m
bykgKQotICAgICAgICAgICAgICAgIEJVRygpOwogICAgICAgICAgICAgbWZu
ID0gcGFnZV90b19tZm4ocGFnZSk7CiAgICAgICAgICAgICBnZm4gPSBtZm5f
dG9fZ21mbihkLCBtZm4pOwogICAgICAgICAgICAgLyogUGFnZXMgd2VyZSB1
bnNoYXJlZCBhYm92ZSAqLwogICAgICAgICAgICAgQlVHX09OKFNIQVJFRF9N
MlAoZ2ZuKSk7CiAgICAgICAgICAgICBpZiAoIGd1ZXN0X3BoeXNtYXBfcmVt
b3ZlX3BhZ2UoZCwgX2dmbihnZm4pLCBfbWZuKG1mbiksIDApICkKICAgICAg
ICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7Ci0gICAgICAgICAgICBwdXRf
cGFnZShwYWdlKTsKKyAgICAgICAgICAgIGZyZWVfZG9taGVhcF9wYWdlKHBh
Z2UpOwogICAgICAgICB9CiAKICAgICAgICAgLyogQXNzaWduIGVhY2ggb3V0
cHV0IHBhZ2UgdG8gdGhlIGRvbWFpbi4gKi8KQEAgLTY5NiwxMyArNjk4LDE2
IEBAIHN0YXRpYyBsb25nIG1lbW9yeV9leGNoYW5nZShYRU5fR1VFU1RfSEFO
RExFX1BBUkFNKHhlbl9tZW1vcnlfZXhjaGFuZ2VfdCkgYXJnKQogICAgICAq
IGNodW5rcyBzdWNjZWVkZWQuCiAgICAgICovCiAgZmFpbDoKLSAgICAvKiBS
ZWFzc2lnbiBhbnkgaW5wdXQgcGFnZXMgd2UgbWFuYWdlZCB0byBzdGVhbC4g
Ki8KKyAgICAvKgorICAgICAqIFJlYXNzaWduIGFueSBpbnB1dCBwYWdlcyB3
ZSBtYW5hZ2VkIHRvIHN0ZWFsLiAgTkIgdGhhdCBpZiB0aGUgYXNzaWduCisg
ICAgICogZmFpbHMgYWdhaW4sIHdlJ3JlIG9uIHRoZSBob29rIGZvciBmcmVl
aW5nIHRoZSBwYWdlLCBzaW5jZSB3ZSd2ZSBhbHJlYWR5CisgICAgICogY2xl
YXJlZCBQR0NfYWxsb2NhdGVkLgorICAgICAqLwogICAgIHdoaWxlICggKHBh
Z2UgPSBwYWdlX2xpc3RfcmVtb3ZlX2hlYWQoJmluX2NodW5rX2xpc3QpKSAp
CiAgICAgICAgIGlmICggYXNzaWduX3BhZ2VzKGQsIHBhZ2UsIDAsIE1FTUZf
bm9fcmVmY291bnQpICkKICAgICAgICAgewogICAgICAgICAgICAgQlVHX09O
KCFkLT5pc19keWluZyk7Ci0gICAgICAgICAgICBpZiAoIHRlc3RfYW5kX2Ns
ZWFyX2JpdChfUEdDX2FsbG9jYXRlZCwgJnBhZ2UtPmNvdW50X2luZm8pICkK
LSAgICAgICAgICAgICAgICBwdXRfcGFnZShwYWdlKTsKKyAgICAgICAgICAg
IGZyZWVfZG9taGVhcF9wYWdlKHBhZ2UpOwogICAgICAgICB9CiAKICBkeWlu
ZzoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jIGIveGVu
L2NvbW1vbi9wYWdlX2FsbG9jLmMKaW5kZXggN2Q4YzM3ZWYzNi4uNTJiNTMw
MWMwZiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMKKysr
IGIveGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMKQEAgLTE3NjYsNyArMTc2Niw3
IEBAIGludCBhc3NpZ25fcGFnZXMoCiAgICAgZm9yICggaSA9IDA7IGkgPCAo
MSA8PCBvcmRlcik7IGkrKyApCiAgICAgewogICAgICAgICBBU1NFUlQocGFn
ZV9nZXRfb3duZXIoJnBnW2ldKSA9PSBOVUxMKTsKLSAgICAgICAgQVNTRVJU
KChwZ1tpXS5jb3VudF9pbmZvICYgfihQR0NfYWxsb2NhdGVkIHwgMSkpID09
IDApOworICAgICAgICBBU1NFUlQoIXBnW2ldLmNvdW50X2luZm8pOwogICAg
ICAgICBwYWdlX3NldF9vd25lcigmcGdbaV0sIGQpOwogICAgICAgICBzbXBf
d21iKCk7IC8qIERvbWFpbiBwb2ludGVyIG11c3QgYmUgdmlzaWJsZSBiZWZv
cmUgdXBkYXRpbmcgcmVmY250LiAqLwogICAgICAgICBwZ1tpXS5jb3VudF9p
bmZvID0gUEdDX2FsbG9jYXRlZCB8IDE7Ci0tIAoyLjIwLjEKCg==

--=separator
Content-Type: application/octet-stream; name="xsa287-4.10.patch"
Content-Disposition: attachment; filename="xsa287-4.10.patch"
Content-Transfer-Encoding: base64

RnJvbSA5YjFmNjE5MmU0YjAzNjZkYzA5Y2VhOTA1ZDNlMGE0YjgyY2FkNDVi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IEZyaSwgMTggSmFu
IDIwMTkgMTU6MDA6MzQgKzAwMDAKU3ViamVjdDogW1BBVENIXSBzdGVhbF9w
YWdlOiBHZXQgcmlkIG9mIGJvZ3VzIHN0cnVjdCBwYWdlIHN0YXRlcwoKVGhl
IG9yaWdpbmFsIHJ1bGVzIGZvciBgc3RydWN0IHBhZ2VgIHJlcXVpcmVkIHRo
ZSBmb2xsb3dpbmcgaW52YXJpYW50cwphdCBhbGwgdGltZXM6CgotIHJlZmNv
dW50ID4gMCBpbXBsaWVzIG93bmVyICE9IE5VTEwKLSBQR0NfYWxsb2NhdGVk
IGltcGxpZXMgcmVmY291bnQgPiAwCgpzdGVhbF9wYWdlLCBpbiBhIG1pc2d1
aWRlZCBhdHRlbXB0IHRvIHByb3RlY3QgYWdhaW5zdCB1bmtub3duIHJhY2Vz
LAp2aW9sYXRlcyBib3RoIG9mIHRoZXNlIHJ1bGVzLCB0aHVzIGludHJvZHVj
aW5nIG90aGVyIHJhY2VzOgoKLSBUZW1wb3JhcmlseSwgdGhlIGNvdW50X2lu
Zm8gaGFzIHRoZSByZWZjb3VudCBnbyB0byAwIHdoaWxlCiAgUEdDX2FsbG9j
YXRlZCBpcyBzZXQKCi0gSXQgZXhwbGljaXRseSByZXR1cm5zIHRoZSBwYWdl
IFBHQ19hbGxvY2F0ZWQgc2V0LCBidXQgb3duZXIgPT0gTlVMTAogIGFuZCBw
YWdlIG5vdCBvbiB0aGUgcGFnZV9saXN0LgoKVGhlIHNlY29uZCBvbmUgbWVh
bnQgdGhhdCBwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKCkgY291bGQg
cmV0dXJuCk5VTEwgZXZlbiBhZnRlciBoYXZpbmcgc3VjY2Vzc2Z1bGx5IGdy
YWJiZWQgYSByZWZlcmVuY2Ugb24gdGhlIHBhZ2UsCmxlYWRpbmcgdGhlIGNh
bGxlciB0byBsZWFrIHRoZSByZWZlcmVuY2UgKHNpbmNlICJjb3VsZG4ndCBn
ZXQgcmVmIiBhbmQKImdvdCByZWYgYnV0IG5vIG93bmVyIiBsb29rIHRoZSBz
YW1lKS4KCkZ1cnRoZXJtb3JlLCByYXRoZXIgdGhhbiBncmFiYmluZyBhIHBh
Z2UgcmVmZXJlbmNlIHRvIGVuc3VyZSB0aGF0IHRoZQpvd25lciBkb2Vzbid0
IGNoYW5nZSB1bmRlciBpdHMgZmVldCwgaXQgYXBwZWFycyB0byByZWx5IG9u
IGhvbGRpbmcKZC0+cGFnZV9hbGxvYyBsb2NrIHRvIHByZXZlbnQgdGhpcy4K
ClVuZm9ydHVuYXRlbHksIHRoaXMgaXMgaW5lZmZlY3RpdmU6IHBhZ2UtPm93
bmVyIHJlbWFpbnMgbm9uLU5VTEwgZm9yCnNvbWUgdGltZSBhZnRlciB0aGUg
Y291bnQgaGFzIGJlZW4gc2V0IHRvIDA7IG1lYW5pbmcgdGhhdCBpdCB3b3Vs
ZCBiZQplbnRpcmVseSBwb3NzaWJsZSBmb3IgdGhlIHBhZ2UgdG8gYmUgZnJl
ZWQgYW5kIHJlLWFsbG9jYXRlZCB0byBhCmRpZmZlcmVudCBkb21haW4gYmV0
d2VlbiB0aGUgcGFnZV9nZXRfb3duZXIoKSBjaGVjayBhbmQgdGhlIGNvdW50
X2luZm8KY2hlY2suCgpNb2RpZnkgc3RlYWxfcGFnZSB0byBpbnN0ZWFkIGZv
bGxvdyB0aGUgYXBwcm9wcmlhdGUgYWNjZXNzIGRpc2NpcGxpbmUsCnRha2lu
ZyB0aGUgcGFnZSB0aHJvdWdoIHNlcmllcyBvZiBzdGF0ZXMgc2ltaWxhciB0
byBiZWluZyBmcmVlZCBhbmQKdGhlbiByZS1hbGxvY2F0ZWQgd2l0aCBNRU1G
X25vX293bmVyOgoKLSBHcmFiIGFuIGV4dHJhIHJlZmVyZW5jZSB0byBtYWtl
IHN1cmUgd2UgZG9uJ3QgcmFjZSB3aXRoIGFueW9uZSBlbHNlCiAgZnJlZWlu
ZyB0aGUgcGFnZQoKLSBEcm9wIGJvdGggcmVmZXJlbmNlcyBhbmQgUEdDX2Fs
bG9jYXRlZCBhdG9taWNhbGx5LCBzbyB0aGF0IChpZgpzdWNjZXNzZnVsKSwg
YW55b25lIGVsc2UgdHJ5aW5nIHRvIGdyYWIgYSByZWZlcmVuY2Ugd2lsbCBm
YWlsCgotIEF0dGVtcHQgdG8gcmVzZXQgWGVuJ3MgbWFwcGluZ3MKCi0gUmVz
ZXQgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLgoKVGhlbiwgbW9kaWZ5IHRoZSB0
d28gY2FsbGVycyBhcHByb3ByaWF0ZWx5OgoKLSBMZWF2ZSBjb3VudF9pbmZv
IGFsb25lIChpdCdzIGFscmVhZHkgYmVlbiBjbGVhcmVkKQotIENhbGwgZnJl
ZV9kb21oZWFwX3BhZ2UoKSBkaXJlY3RseSBpZiBhcHByb3ByaWF0ZQotIENh
bGwgYXNzaWduX3BhZ2VzKCkgcmF0aGVyIHRoYW4gb3Blbi1jb2RpbmcgYSBw
YXJ0aWFsIGFzc2lnbgoKV2l0aCBhbGwgY2FsbGVycyB0byBhc3NpZ25fcGFn
ZXMoKSBub3cgcGFzc2luZyBpbiBwYWdlcyB3aXRoIHRoZQp0eXBlX2luZm8g
ZmllbGQgY2xlYXIsIHRpZ2h0ZW4gdGhlIHJlc3BlY3RpdmUgYXNzZXJ0aW9u
IHRoZXJlLgoKVGhpcyBpcyBYU0EtMjg3LgoKU2lnbmVkLW9mZi1ieTogR2Vv
cmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgICAgICAgIHwgODQgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9ncmFudF90
YWJsZS5jIHwgMjAgKysrKystLS0tLQogeGVuL2NvbW1vbi9tZW1vcnkuYyAg
ICAgIHwgMTkgKysrKystLS0tCiB4ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyAg
fCAgMiArLQogNCBmaWxlcyBjaGFuZ2VkLCA4MyBpbnNlcnRpb25zKCspLCA0
MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0u
YyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IGMyMGVkYjk1NGQuLjY3ZjZj
ZmMxZDUgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9tbS5jCkBAIC0zOTI0LDcwICszOTI0LDEwNiBAQCBpbnQg
ZG9uYXRlX3BhZ2UoCiAgICAgcmV0dXJuIC1FSU5WQUw7CiB9CiAKKy8qCisg
KiBTdGVhbCBwYWdlIHdpbGwgYXR0ZW1wdCB0byByZW1vdmUgYHBhZ2VgIGZy
b20gZG9tYWluIGBkYC4gIFVwb24KKyAqIHJldHVybiwgYHBhZ2VgIHdpbGwg
YmUgaW4gYSBzdGF0ZSBzaW1pbGFyIHRvIHRoZSBzdGF0ZSBvZiBhIHBhZ2UK
KyAqIHJldHVybmVkIGZyb20gYWxsb2NfZG9taGVhcF9wYWdlKCkgd2l0aCBN
RU1GX25vX293bmVyIHNldDoKKyAqIC0gcmVmY291bnQgMAorICogLSB0eXBl
IGNvdW50IGNsZWFyZWQKKyAqIC0gb3duZXIgTlVMTAorICogLSBwYWdlIGNh
Y2hpbmcgYXR0cmlidXRlcyBjbGVhbmVkIHVwCisgKiAtIHJlbW92ZWQgZnJv
bSB0aGUgZG9tYWluJ3MgcGFnZV9saXN0CisgKgorICogSWYgTUVNRl9ub19y
ZWZjb3VudCBpcyBub3Qgc2V0LCB0aGUgZG9tYWluJ3MgdG90X3BhZ2VzIHdp
bGwgYmUKKyAqIGFkanVzdGVkLiAgSWYgdGhpcyByZXN1bHRzIGluIHRoZSBw
YWdlIGNvdW50IGZhbGxpbmcgdG8gMCwKKyAqIHB1dF9kb21haW4oKSB3aWxs
IGJlIGNhbGxlZC4KKyAqCisgKiBUaGUgY2FsbGVyIHNob3VsZCBlaXRoZXIg
Y2FsbCBmcmVlX2RvbWhlYXBfcGFnZSgpIHRvIGZyZWUgdGhlCisgKiBwYWdl
LCBvciBhc3NpZ25fcGFnZXMoKSB0byBwdXQgaXQgYmFjayBvbiBzb21lIGRv
bWFpbidzIHBhZ2UgbGlzdC4KKyAqLwogaW50IHN0ZWFsX3BhZ2UoCiAgICAg
c3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5z
aWduZWQgaW50IG1lbWZsYWdzKQogewogICAgIHVuc2lnbmVkIGxvbmcgeCwg
eTsKICAgICBib29sIGRyb3BfZG9tX3JlZiA9IGZhbHNlOwotICAgIGNvbnN0
IHN0cnVjdCBkb21haW4gKm93bmVyID0gZG9tX3hlbjsKKyAgICBjb25zdCBz
dHJ1Y3QgZG9tYWluICpvd25lcjsKKyAgICBpbnQgcmM7CiAKICAgICBpZiAo
IHBhZ2luZ19tb2RlX2V4dGVybmFsKGQpICkKICAgICAgICAgcmV0dXJuIC1F
T1BOT1RTVVBQOwogCi0gICAgc3Bpbl9sb2NrKCZkLT5wYWdlX2FsbG9jX2xv
Y2spOwotCi0gICAgaWYgKCBpc194ZW5faGVhcF9wYWdlKHBhZ2UpIHx8ICgo
b3duZXIgPSBwYWdlX2dldF9vd25lcihwYWdlKSkgIT0gZCkgKQorICAgIC8q
IEdyYWIgYSByZWZlcmVuY2UgdG8gbWFrZSBzdXJlIHRoZSBwYWdlIGRvZXNu
J3QgY2hhbmdlIHVuZGVyIG91ciBmZWV0ICovCisgICAgcmMgPSAtRUlOVkFM
OworICAgIGlmICggIShvd25lciA9IHBhZ2VfZ2V0X293bmVyX2FuZF9yZWZl
cmVuY2UocGFnZSkpICkKICAgICAgICAgZ290byBmYWlsOwogCisgICAgaWYg
KCBvd25lciAhPSBkIHx8IGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkgKQorICAg
ICAgICBnb3RvIGZhaWxfcHV0OworCiAgICAgLyoKLSAgICAgKiBXZSByZXF1
aXJlIHRoZXJlIGlzIGp1c3Qgb25lIHJlZmVyZW5jZSAoUEdDX2FsbG9jYXRl
ZCkuIFdlIHRlbXBvcmFyaWx5Ci0gICAgICogZHJvcCB0aGlzIHJlZmVyZW5j
ZSBub3cgc28gdGhhdCB3ZSBjYW4gc2FmZWx5IHN3aXp6bGUgdGhlIG93bmVy
LgorICAgICAqIFdlIHJlcXVpcmUgdGhlcmUgYXJlIGV4YWN0bHkgdHdvIHJl
ZmVyZW5jZXMgLS0gdGhlIG9uZSB3ZSBqdXN0CisgICAgICogdG9vaywgYW5k
IFBHQ19hbGxvY2F0ZWQuIFdlIHRlbXBvcmFyaWx5IGRyb3AgYm90aCB0aGVz
ZQorICAgICAqIHJlZmVyZW5jZXMgc28gdGhhdCB0aGUgcGFnZSBiZWNvbWVz
IGVmZmVjdGl2ZWx5IG5vbi0ibGl2ZSIgZm9yCisgICAgICogdGhlIGRvbWFp
bi4KICAgICAgKi8KICAgICB5ID0gcGFnZS0+Y291bnRfaW5mbzsKICAgICBk
byB7CiAgICAgICAgIHggPSB5OwotICAgICAgICBpZiAoICh4ICYgKFBHQ19j
b3VudF9tYXNrfFBHQ19hbGxvY2F0ZWQpKSAhPSAoMSB8IFBHQ19hbGxvY2F0
ZWQpICkKLSAgICAgICAgICAgIGdvdG8gZmFpbDsKLSAgICAgICAgeSA9IGNt
cHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIHggJiB+UEdDX2NvdW50X21h
c2spOworICAgICAgICBpZiAoICh4ICYgKFBHQ19jb3VudF9tYXNrfFBHQ19h
bGxvY2F0ZWQpKSAhPSAoMiB8IFBHQ19hbGxvY2F0ZWQpICkKKyAgICAgICAg
ICAgIGdvdG8gZmFpbF9wdXQ7CisgICAgICAgIHkgPSBjbXB4Y2hnKCZwYWdl
LT5jb3VudF9pbmZvLCB4LCB4ICYgfihQR0NfY291bnRfbWFza3xQR0NfYWxs
b2NhdGVkKSk7CiAgICAgfSB3aGlsZSAoIHkgIT0geCApOwogCiAgICAgLyoK
LSAgICAgKiBXaXRoIHRoZSBzb2xlIHJlZmVyZW5jZSBkcm9wcGVkIHRlbXBv
cmFyaWx5LCBuby1vbmUgY2FuIHVwZGF0ZSB0eXBlCi0gICAgICogaW5mb3Jt
YXRpb24uIFR5cGUgY291bnQgYWxzbyBuZWVkcyB0byBiZSB6ZXJvIGluIHRo
aXMgY2FzZSwgYnV0IGUuZy4KLSAgICAgKiBQR1Rfc2VnX2Rlc2NfcGFnZSBt
YXkgc3RpbGwgaGF2ZSBQR1RfdmFsaWRhdGVkIHNldCwgd2hpY2ggd2UgbmVl
ZCB0bwotICAgICAqIGNsZWFyIGJlZm9yZSB0cmFuc2ZlcnJpbmcgb3duZXJz
aGlwIChhcyB2YWxpZGF0aW9uIGNyaXRlcmlhIHZhcnkKLSAgICAgKiBkZXBl
bmRpbmcgb24gZG9tYWluIHR5cGUpLgorICAgICAqIE5CIHRoaXMgaXMgc2Fm
ZSBldmVuIGlmIHRoZSBwYWdlIGVuZHMgdXAgYmVpbmcgZ2l2ZW4gYmFjayB0
bworICAgICAqIHRoZSBkb21haW4sIGJlY2F1c2UgdGhlIGNvdW50IGlzIHpl
cm86IHN1YnNlcXVlbnQgbWFwcGluZ3Mgd2lsbAorICAgICAqIGNhdXNlIHRo
ZSBjYWNoZSBhdHRyaWJ1dGVzIHRvIGJlIHJlLWluc3RhdGVkIGluc2lkZQor
ICAgICAqIGdldF9wYWdlX2Zyb21fbDFlKCkuCisgICAgICovCisgICAgaWYg
KCAocmMgPSBjbGVhbnVwX3BhZ2VfY2FjaGVhdHRyKHBhZ2UpKSApCisgICAg
eworICAgICAgICAvKgorICAgICAgICAgKiBDb3VsZG4ndCBmaXh1cCBYZW4n
cyBtYXBwaW5nczsgcHV0IHRoaW5ncyB0aGUgd2F5IHdlIGZvdW5kCisgICAg
ICAgICAqIGl0IGFuZCByZXR1cm4gYW4gZXJyb3IKKyAgICAgICAgICovCisg
ICAgICAgIHBhZ2UtPmNvdW50X2luZm8gfD0gUEdDX2FsbG9jYXRlZCB8IDE7
CisgICAgICAgIGdvdG8gZmFpbDsKKyAgICB9CisKKyAgICAvKgorICAgICAq
IFdpdGggdGhlIHJlZmVyZW5jZSBjb3VudCBub3cgemVybywgbm9ib2R5IGNh
biBncmFiIHJlZmVyZW5jZXMKKyAgICAgKiB0byBkbyBhbnl0aGluZyBlbHNl
IHdpdGggdGhlIHBhZ2UuICBSZXR1cm4gdGhlIHBhZ2UgdG8gYSBzdGF0ZQor
ICAgICAqIHRoYXQgaXQgbWlnaHQgYmUgdXBvbiByZXR1cm4gZnJvbSBhbGxv
Y19kb21oZWFwX3BhZ2VzIHdpdGgKKyAgICAgKiBNRU1GX25vX293bmVyIHNl
dC4KICAgICAgKi8KKyAgICBzcGluX2xvY2soJmQtPnBhZ2VfYWxsb2NfbG9j
ayk7CisKICAgICBCVUdfT04ocGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJiAo
UEdUX2NvdW50X21hc2sgfCBQR1RfbG9ja2VkIHwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgUEdUX3Bpbm5lZCkpOwogICAgIHBh
Z2UtPnUuaW51c2UudHlwZV9pbmZvID0gMDsKLQotICAgIC8qIFN3aXp6bGUg
dGhlIG93bmVyIHRoZW4gcmVpbnN0YXRlIHRoZSBQR0NfYWxsb2NhdGVkIHJl
ZmVyZW5jZS4gKi8KICAgICBwYWdlX3NldF9vd25lcihwYWdlLCBOVUxMKTsK
LSAgICB5ID0gcGFnZS0+Y291bnRfaW5mbzsKLSAgICBkbyB7Ci0gICAgICAg
IHggPSB5OwotICAgICAgICBCVUdfT04oKHggJiAoUEdDX2NvdW50X21hc2t8
UEdDX2FsbG9jYXRlZCkpICE9IFBHQ19hbGxvY2F0ZWQpOwotICAgIH0gd2hp
bGUgKCAoeSA9IGNtcHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIHggfCAx
KSkgIT0geCApOworICAgIHBhZ2VfbGlzdF9kZWwocGFnZSwgJmQtPnBhZ2Vf
bGlzdCk7CiAKICAgICAvKiBVbmxpbmsgZnJvbSBvcmlnaW5hbCBvd25lci4g
Ki8KICAgICBpZiAoICEobWVtZmxhZ3MgJiBNRU1GX25vX3JlZmNvdW50KSAm
JiAhZG9tYWluX2FkanVzdF90b3RfcGFnZXMoZCwgLTEpICkKICAgICAgICAg
ZHJvcF9kb21fcmVmID0gdHJ1ZTsKLSAgICBwYWdlX2xpc3RfZGVsKHBhZ2Us
ICZkLT5wYWdlX2xpc3QpOwogCiAgICAgc3Bpbl91bmxvY2soJmQtPnBhZ2Vf
YWxsb2NfbG9jayk7CisKICAgICBpZiAoIHVubGlrZWx5KGRyb3BfZG9tX3Jl
ZikgKQogICAgICAgICBwdXRfZG9tYWluKGQpOworCiAgICAgcmV0dXJuIDA7
CiAKKyBmYWlsX3B1dDoKKyAgICBwdXRfcGFnZShwYWdlKTsKICBmYWlsOgot
ICAgIHNwaW5fdW5sb2NrKCZkLT5wYWdlX2FsbG9jX2xvY2spOwogICAgIGdk
cHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiQmFkIHN0ZWFsIG1mbiAlIiBQUklf
bWZuCiAgICAgICAgICAgICAgIiBmcm9tIGQlZCAob3duZXIgZCVkKSBjYWY9
JTA4bHggdGFmPSUiIFBSdHlwZV9pbmZvICJcbiIsCiAgICAgICAgICAgICAg
bWZuX3gocGFnZV90b19tZm4ocGFnZSkpLCBkLT5kb21haW5faWQsCiAgICAg
ICAgICAgICAgb3duZXIgPyBvd25lci0+ZG9tYWluX2lkIDogRE9NSURfSU5W
QUxJRCwKICAgICAgICAgICAgICBwYWdlLT5jb3VudF9pbmZvLCBwYWdlLT51
LmludXNlLnR5cGVfaW5mbyk7Ci0gICAgcmV0dXJuIC1FSU5WQUw7CisgICAg
cmV0dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IF9fZG9fdXBkYXRlX3ZhX21h
cHBpbmcoCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMg
Yi94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMKaW5kZXggZTY3OTBkNWZhYy4u
NDJlYTUwZjQ4NSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9ncmFudF90YWJs
ZS5jCisrKyBiL3hlbi9jb21tb24vZ3JhbnRfdGFibGUuYwpAQCAtMjE3NSw3
ICsyMTc1LDcgQEAgZ250dGFiX3RyYW5zZmVyKAogICAgICAgICAgICAgcmN1
X3VubG9ja19kb21haW4oZSk7CiAgICAgICAgIHB1dF9nZm5fYW5kX2NvcHli
YWNrOgogICAgICAgICAgICAgcHV0X2dmbihkLCBnb3AubWZuKTsKLSAgICAg
ICAgICAgIHBhZ2UtPmNvdW50X2luZm8gJj0gfihQR0NfY291bnRfbWFza3xQ
R0NfYWxsb2NhdGVkKTsKKyAgICAgICAgICAgIC8qIFRoZSBjb3VudF9pbmZv
IGhhcyBhbHJlYWR5IGJlZW4gY2xlYW5lZCAqLwogICAgICAgICAgICAgZnJl
ZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgICAgICBnb3RvIGNvcHli
YWNrOwogICAgICAgICB9CkBAIC0yMTk4LDEwICsyMTk4LDkgQEAgZ250dGFi
X3RyYW5zZmVyKAogCiAgICAgICAgICAgICBjb3B5X2RvbWFpbl9wYWdlKF9t
Zm4ocGFnZV90b19tZm4obmV3X3BhZ2UpKSwgX21mbihtZm4pKTsKIAotICAg
ICAgICAgICAgcGFnZS0+Y291bnRfaW5mbyAmPSB+KFBHQ19jb3VudF9tYXNr
fFBHQ19hbGxvY2F0ZWQpOworICAgICAgICAgICAgLyogVGhlIGNvdW50X2lu
Zm8gaGFzIGFscmVhZHkgYmVlbiBjbGVhcmVkICovCiAgICAgICAgICAgICBm
cmVlX2RvbWhlYXBfcGFnZShwYWdlKTsKICAgICAgICAgICAgIHBhZ2UgPSBu
ZXdfcGFnZTsKLSAgICAgICAgICAgIHBhZ2UtPmNvdW50X2luZm8gPSBQR0Nf
YWxsb2NhdGVkIHwgMTsKICAgICAgICAgICAgIG1mbiA9IHBhZ2VfdG9fbWZu
KHBhZ2UpOwogICAgICAgICB9CiAKQEAgLTIyNDEsMTIgKzIyNDAsMTcgQEAg
Z250dGFiX3RyYW5zZmVyKAogICAgICAgICAgKi8KICAgICAgICAgc3Bpbl91
bmxvY2soJmUtPnBhZ2VfYWxsb2NfbG9jayk7CiAgICAgICAgIG9rYXkgPSBn
bnR0YWJfcHJlcGFyZV9mb3JfdHJhbnNmZXIoZSwgZCwgZ29wLnJlZik7Ci0g
ICAgICAgIHNwaW5fbG9jaygmZS0+cGFnZV9hbGxvY19sb2NrKTsKIAotICAg
ICAgICBpZiAoIHVubGlrZWx5KCFva2F5KSB8fCB1bmxpa2VseShlLT5pc19k
eWluZykgKQorICAgICAgICBpZiAoIHVubGlrZWx5KCFva2F5IHx8IGFzc2ln
bl9wYWdlcyhlLCBwYWdlLCAwLCBNRU1GX25vX3JlZmNvdW50KSkgKQogICAg
ICAgICB7Ci0gICAgICAgICAgICBib29sX3QgZHJvcF9kb21fcmVmID0gIWRv
bWFpbl9hZGp1c3RfdG90X3BhZ2VzKGUsIC0xKTsKKyAgICAgICAgICAgIGJv
b2wgZHJvcF9kb21fcmVmOwogCisgICAgICAgICAgICAvKgorICAgICAgICAg
ICAgICogTmVlZCB0byBncmFiIHRoaXMgYWdhaW4gdG8gc2FmZWx5IGZyZWUg
b3VyICJyZXNlcnZlZCIKKyAgICAgICAgICAgICAqIHBhZ2UgaW4gdGhlIHBh
Z2UgdG90YWwKKyAgICAgICAgICAgICAqLworICAgICAgICAgICAgc3Bpbl9s
b2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOworICAgICAgICAgICAgZHJvcF9k
b21fcmVmID0gIWRvbWFpbl9hZGp1c3RfdG90X3BhZ2VzKGUsIC0xKTsKICAg
ICAgICAgICAgIHNwaW5fdW5sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOwog
CiAgICAgICAgICAgICBpZiAoIG9rYXkgLyogaS5lLiBlLT5pc19keWluZyBk
dWUgdG8gdGhlIHN1cnJvdW5kaW5nIGlmKCkgKi8gKQpAQCAtMjI1OSwxMCAr
MjI2Myw2IEBAIGdudHRhYl90cmFuc2ZlcigKICAgICAgICAgICAgIGdvdG8g
dW5sb2NrX2FuZF9jb3B5YmFjazsKICAgICAgICAgfQogCi0gICAgICAgIHBh
Z2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmZS0+cGFnZV9saXN0KTsKLSAgICAg
ICAgcGFnZV9zZXRfb3duZXIocGFnZSwgZSk7Ci0KLSAgICAgICAgc3Bpbl91
bmxvY2soJmUtPnBhZ2VfYWxsb2NfbG9jayk7CiAgICAgICAgIHB1dF9nZm4o
ZCwgZ29wLm1mbik7CiAKICAgICAgICAgVFJBQ0VfMUQoVFJDX01FTV9QQUdF
X0dSQU5UX1RSQU5TRkVSLCBlLT5kb21haW5faWQpOwpkaWZmIC0tZ2l0IGEv
eGVuL2NvbW1vbi9tZW1vcnkuYyBiL3hlbi9jb21tb24vbWVtb3J5LmMKaW5k
ZXggMDg4MDgzZTRkMS4uOGFhZWNiNDQ5NSAxMDA2NDQKLS0tIGEveGVuL2Nv
bW1vbi9tZW1vcnkuYworKysgYi94ZW4vY29tbW9uL21lbW9yeS5jCkBAIC02
MzEsMjAgKzYzMSwyMiBAQCBzdGF0aWMgbG9uZyBtZW1vcnlfZXhjaGFuZ2Uo
WEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fbWVtb3J5X2V4Y2hhbmdlX3Qp
IGFyZykKICAgICAgICAgICogU3VjY2VzcyEgQmV5b25kIHRoaXMgcG9pbnQg
d2UgY2Fubm90IGZhaWwgZm9yIHRoaXMgY2h1bmsuCiAgICAgICAgICAqLwog
Ci0gICAgICAgIC8qIERlc3Ryb3kgZmluYWwgcmVmZXJlbmNlIHRvIGVhY2gg
aW5wdXQgcGFnZS4gKi8KKyAgICAgICAgLyoKKyAgICAgICAgICogVGhlc2Ug
cGFnZXMgaGF2ZSBhbHJlYWR5IGhhZCBvd25lciBhbmQgcmVmZXJlbmNlIGNs
ZWFyZWQuCisgICAgICAgICAqIERvIHRoZSBmaW5hbCB0d28gc3RlcHM6IFJl
bW92ZSBmcm9tIHRoZSBwaHlzbWFwLCBhbmQgZnJlZQorICAgICAgICAgKiB0
aGVtLgorICAgICAgICAgKi8KICAgICAgICAgd2hpbGUgKCAocGFnZSA9IHBh
Z2VfbGlzdF9yZW1vdmVfaGVhZCgmaW5fY2h1bmtfbGlzdCkpICkKICAgICAg
ICAgewogICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBnZm47CiAKLSAgICAg
ICAgICAgIGlmICggIXRlc3RfYW5kX2NsZWFyX2JpdChfUEdDX2FsbG9jYXRl
ZCwgJnBhZ2UtPmNvdW50X2luZm8pICkKLSAgICAgICAgICAgICAgICBCVUco
KTsKICAgICAgICAgICAgIG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAg
ICAgICAgICAgZ2ZuID0gbWZuX3RvX2dtZm4oZCwgbWZuKTsKICAgICAgICAg
ICAgIC8qIFBhZ2VzIHdlcmUgdW5zaGFyZWQgYWJvdmUgKi8KICAgICAgICAg
ICAgIEJVR19PTihTSEFSRURfTTJQKGdmbikpOwogICAgICAgICAgICAgaWYg
KCBndWVzdF9waHlzbWFwX3JlbW92ZV9wYWdlKGQsIF9nZm4oZ2ZuKSwgX21m
bihtZm4pLCAwKSApCiAgICAgICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQp
OwotICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CisgICAgICAgICAgICBm
cmVlX2RvbWhlYXBfcGFnZShwYWdlKTsKICAgICAgICAgfQogCiAgICAgICAg
IC8qIEFzc2lnbiBlYWNoIG91dHB1dCBwYWdlIHRvIHRoZSBkb21haW4uICov
CkBAIC03MTcsMTMgKzcxOSwxNiBAQCBzdGF0aWMgbG9uZyBtZW1vcnlfZXhj
aGFuZ2UoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fbWVtb3J5X2V4Y2hh
bmdlX3QpIGFyZykKICAgICAgKiBjaHVua3Mgc3VjY2VlZGVkLgogICAgICAq
LwogIGZhaWw6Ci0gICAgLyogUmVhc3NpZ24gYW55IGlucHV0IHBhZ2VzIHdl
IG1hbmFnZWQgdG8gc3RlYWwuICovCisgICAgLyoKKyAgICAgKiBSZWFzc2ln
biBhbnkgaW5wdXQgcGFnZXMgd2UgbWFuYWdlZCB0byBzdGVhbC4gIE5CIHRo
YXQgaWYgdGhlIGFzc2lnbgorICAgICAqIGZhaWxzIGFnYWluLCB3ZSdyZSBv
biB0aGUgaG9vayBmb3IgZnJlZWluZyB0aGUgcGFnZSwgc2luY2Ugd2UndmUg
YWxyZWFkeQorICAgICAqIGNsZWFyZWQgUEdDX2FsbG9jYXRlZC4KKyAgICAg
Ki8KICAgICB3aGlsZSAoIChwYWdlID0gcGFnZV9saXN0X3JlbW92ZV9oZWFk
KCZpbl9jaHVua19saXN0KSkgKQogICAgICAgICBpZiAoIGFzc2lnbl9wYWdl
cyhkLCBwYWdlLCAwLCBNRU1GX25vX3JlZmNvdW50KSApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIEJVR19PTighZC0+aXNfZHlpbmcpOwotICAgICAgICAg
ICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZw
YWdlLT5jb3VudF9pbmZvKSApCi0gICAgICAgICAgICAgICAgcHV0X3BhZ2Uo
cGFnZSk7CisgICAgICAgICAgICBmcmVlX2RvbWhlYXBfcGFnZShwYWdlKTsK
ICAgICAgICAgfQogCiAgZHlpbmc6CmRpZmYgLS1naXQgYS94ZW4vY29tbW9u
L3BhZ2VfYWxsb2MuYyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCmluZGV4
IDU5OGMzNDMyYzkuLjE1YTZmMDE4ZjggMTAwNjQ0Ci0tLSBhL3hlbi9jb21t
b24vcGFnZV9hbGxvYy5jCisrKyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5j
CkBAIC0yMjE5LDcgKzIyMTksNyBAQCBpbnQgYXNzaWduX3BhZ2VzKAogICAg
IGZvciAoIGkgPSAwOyBpIDwgKDEgPDwgb3JkZXIpOyBpKysgKQogICAgIHsK
ICAgICAgICAgQVNTRVJUKHBhZ2VfZ2V0X293bmVyKCZwZ1tpXSkgPT0gTlVM
TCk7Ci0gICAgICAgIEFTU0VSVCgocGdbaV0uY291bnRfaW5mbyAmIH4oUEdD
X2FsbG9jYXRlZCB8IDEpKSA9PSAwKTsKKyAgICAgICAgQVNTRVJUKCFwZ1tp
XS5jb3VudF9pbmZvKTsKICAgICAgICAgcGFnZV9zZXRfb3duZXIoJnBnW2ld
LCBkKTsKICAgICAgICAgc21wX3dtYigpOyAvKiBEb21haW4gcG9pbnRlciBt
dXN0IGJlIHZpc2libGUgYmVmb3JlIHVwZGF0aW5nIHJlZmNudC4gKi8KICAg
ICAgICAgcGdbaV0uY291bnRfaW5mbyA9IFBHQ19hbGxvY2F0ZWQgfCAxOwot
LSAKMi4yMC4xCgo=

--=separator
Content-Type: application/octet-stream; name="xsa287-4.11.patch"
Content-Disposition: attachment; filename="xsa287-4.11.patch"
Content-Transfer-Encoding: base64

RnJvbSA2NzYyMGMxY2NiMTNmN2I1ODY0NWY0ODI0OGJhMWY0MDhiMDIxZmRj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IEZyaSwgMTggSmFu
IDIwMTkgMTU6MDA6MzQgKzAwMDAKU3ViamVjdDogW1BBVENIXSBzdGVhbF9w
YWdlOiBHZXQgcmlkIG9mIGJvZ3VzIHN0cnVjdCBwYWdlIHN0YXRlcwoKVGhl
IG9yaWdpbmFsIHJ1bGVzIGZvciBgc3RydWN0IHBhZ2VgIHJlcXVpcmVkIHRo
ZSBmb2xsb3dpbmcgaW52YXJpYW50cwphdCBhbGwgdGltZXM6CgotIHJlZmNv
dW50ID4gMCBpbXBsaWVzIG93bmVyICE9IE5VTEwKLSBQR0NfYWxsb2NhdGVk
IGltcGxpZXMgcmVmY291bnQgPiAwCgpzdGVhbF9wYWdlLCBpbiBhIG1pc2d1
aWRlZCBhdHRlbXB0IHRvIHByb3RlY3QgYWdhaW5zdCB1bmtub3duIHJhY2Vz
LAp2aW9sYXRlcyBib3RoIG9mIHRoZXNlIHJ1bGVzLCB0aHVzIGludHJvZHVj
aW5nIG90aGVyIHJhY2VzOgoKLSBUZW1wb3JhcmlseSwgdGhlIGNvdW50X2lu
Zm8gaGFzIHRoZSByZWZjb3VudCBnbyB0byAwIHdoaWxlCiAgUEdDX2FsbG9j
YXRlZCBpcyBzZXQKCi0gSXQgZXhwbGljaXRseSByZXR1cm5zIHRoZSBwYWdl
IFBHQ19hbGxvY2F0ZWQgc2V0LCBidXQgb3duZXIgPT0gTlVMTAogIGFuZCBw
YWdlIG5vdCBvbiB0aGUgcGFnZV9saXN0LgoKVGhlIHNlY29uZCBvbmUgbWVh
bnQgdGhhdCBwYWdlX2dldF9vd25lcl9hbmRfcmVmZXJlbmNlKCkgY291bGQg
cmV0dXJuCk5VTEwgZXZlbiBhZnRlciBoYXZpbmcgc3VjY2Vzc2Z1bGx5IGdy
YWJiZWQgYSByZWZlcmVuY2Ugb24gdGhlIHBhZ2UsCmxlYWRpbmcgdGhlIGNh
bGxlciB0byBsZWFrIHRoZSByZWZlcmVuY2UgKHNpbmNlICJjb3VsZG4ndCBn
ZXQgcmVmIiBhbmQKImdvdCByZWYgYnV0IG5vIG93bmVyIiBsb29rIHRoZSBz
YW1lKS4KCkZ1cnRoZXJtb3JlLCByYXRoZXIgdGhhbiBncmFiYmluZyBhIHBh
Z2UgcmVmZXJlbmNlIHRvIGVuc3VyZSB0aGF0IHRoZQpvd25lciBkb2Vzbid0
IGNoYW5nZSB1bmRlciBpdHMgZmVldCwgaXQgYXBwZWFycyB0byByZWx5IG9u
IGhvbGRpbmcKZC0+cGFnZV9hbGxvYyBsb2NrIHRvIHByZXZlbnQgdGhpcy4K
ClVuZm9ydHVuYXRlbHksIHRoaXMgaXMgaW5lZmZlY3RpdmU6IHBhZ2UtPm93
bmVyIHJlbWFpbnMgbm9uLU5VTEwgZm9yCnNvbWUgdGltZSBhZnRlciB0aGUg
Y291bnQgaGFzIGJlZW4gc2V0IHRvIDA7IG1lYW5pbmcgdGhhdCBpdCB3b3Vs
ZCBiZQplbnRpcmVseSBwb3NzaWJsZSBmb3IgdGhlIHBhZ2UgdG8gYmUgZnJl
ZWQgYW5kIHJlLWFsbG9jYXRlZCB0byBhCmRpZmZlcmVudCBkb21haW4gYmV0
d2VlbiB0aGUgcGFnZV9nZXRfb3duZXIoKSBjaGVjayBhbmQgdGhlIGNvdW50
X2luZm8KY2hlY2suCgpNb2RpZnkgc3RlYWxfcGFnZSB0byBpbnN0ZWFkIGZv
bGxvdyB0aGUgYXBwcm9wcmlhdGUgYWNjZXNzIGRpc2NpcGxpbmUsCnRha2lu
ZyB0aGUgcGFnZSB0aHJvdWdoIHNlcmllcyBvZiBzdGF0ZXMgc2ltaWxhciB0
byBiZWluZyBmcmVlZCBhbmQKdGhlbiByZS1hbGxvY2F0ZWQgd2l0aCBNRU1G
X25vX293bmVyOgoKLSBHcmFiIGFuIGV4dHJhIHJlZmVyZW5jZSB0byBtYWtl
IHN1cmUgd2UgZG9uJ3QgcmFjZSB3aXRoIGFueW9uZSBlbHNlCiAgZnJlZWlu
ZyB0aGUgcGFnZQoKLSBEcm9wIGJvdGggcmVmZXJlbmNlcyBhbmQgUEdDX2Fs
bG9jYXRlZCBhdG9taWNhbGx5LCBzbyB0aGF0IChpZgpzdWNjZXNzZnVsKSwg
YW55b25lIGVsc2UgdHJ5aW5nIHRvIGdyYWIgYSByZWZlcmVuY2Ugd2lsbCBm
YWlsCgotIEF0dGVtcHQgdG8gcmVzZXQgWGVuJ3MgbWFwcGluZ3MKCi0gUmVz
ZXQgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLgoKVGhlbiwgbW9kaWZ5IHRoZSB0
d28gY2FsbGVycyBhcHByb3ByaWF0ZWx5OgoKLSBMZWF2ZSBjb3VudF9pbmZv
IGFsb25lIChpdCdzIGFscmVhZHkgYmVlbiBjbGVhcmVkKQotIENhbGwgZnJl
ZV9kb21oZWFwX3BhZ2UoKSBkaXJlY3RseSBpZiBhcHByb3ByaWF0ZQotIENh
bGwgYXNzaWduX3BhZ2VzKCkgcmF0aGVyIHRoYW4gb3Blbi1jb2RpbmcgYSBw
YXJ0aWFsIGFzc2lnbgoKV2l0aCBhbGwgY2FsbGVycyB0byBhc3NpZ25fcGFn
ZXMoKSBub3cgcGFzc2luZyBpbiBwYWdlcyB3aXRoIHRoZQp0eXBlX2luZm8g
ZmllbGQgY2xlYXIsIHRpZ2h0ZW4gdGhlIHJlc3BlY3RpdmUgYXNzZXJ0aW9u
IHRoZXJlLgoKVGhpcyBpcyBYU0EtMjg3LgoKU2lnbmVkLW9mZi1ieTogR2Vv
cmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQog
eGVuL2FyY2gveDg2L21tLmMgICAgICAgIHwgODQgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9ncmFudF90
YWJsZS5jIHwgMjAgKysrKystLS0tLQogeGVuL2NvbW1vbi9tZW1vcnkuYyAg
ICAgIHwgMTkgKysrKystLS0tCiB4ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyAg
fCAgMiArLQogNCBmaWxlcyBjaGFuZ2VkLCA4MyBpbnNlcnRpb25zKCspLCA0
MiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0u
YyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IDY1MDkwMzVhNWMuLmQ4ZmY1
OGM5MDEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9tbS5jCkBAIC0zOTY2LDcwICszOTY2LDEwNiBAQCBpbnQg
ZG9uYXRlX3BhZ2UoCiAgICAgcmV0dXJuIC1FSU5WQUw7CiB9CiAKKy8qCisg
KiBTdGVhbCBwYWdlIHdpbGwgYXR0ZW1wdCB0byByZW1vdmUgYHBhZ2VgIGZy
b20gZG9tYWluIGBkYC4gIFVwb24KKyAqIHJldHVybiwgYHBhZ2VgIHdpbGwg
YmUgaW4gYSBzdGF0ZSBzaW1pbGFyIHRvIHRoZSBzdGF0ZSBvZiBhIHBhZ2UK
KyAqIHJldHVybmVkIGZyb20gYWxsb2NfZG9taGVhcF9wYWdlKCkgd2l0aCBN
RU1GX25vX293bmVyIHNldDoKKyAqIC0gcmVmY291bnQgMAorICogLSB0eXBl
IGNvdW50IGNsZWFyZWQKKyAqIC0gb3duZXIgTlVMTAorICogLSBwYWdlIGNh
Y2hpbmcgYXR0cmlidXRlcyBjbGVhbmVkIHVwCisgKiAtIHJlbW92ZWQgZnJv
bSB0aGUgZG9tYWluJ3MgcGFnZV9saXN0CisgKgorICogSWYgTUVNRl9ub19y
ZWZjb3VudCBpcyBub3Qgc2V0LCB0aGUgZG9tYWluJ3MgdG90X3BhZ2VzIHdp
bGwgYmUKKyAqIGFkanVzdGVkLiAgSWYgdGhpcyByZXN1bHRzIGluIHRoZSBw
YWdlIGNvdW50IGZhbGxpbmcgdG8gMCwKKyAqIHB1dF9kb21haW4oKSB3aWxs
IGJlIGNhbGxlZC4KKyAqCisgKiBUaGUgY2FsbGVyIHNob3VsZCBlaXRoZXIg
Y2FsbCBmcmVlX2RvbWhlYXBfcGFnZSgpIHRvIGZyZWUgdGhlCisgKiBwYWdl
LCBvciBhc3NpZ25fcGFnZXMoKSB0byBwdXQgaXQgYmFjayBvbiBzb21lIGRv
bWFpbidzIHBhZ2UgbGlzdC4KKyAqLwogaW50IHN0ZWFsX3BhZ2UoCiAgICAg
c3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5z
aWduZWQgaW50IG1lbWZsYWdzKQogewogICAgIHVuc2lnbmVkIGxvbmcgeCwg
eTsKICAgICBib29sIGRyb3BfZG9tX3JlZiA9IGZhbHNlOwotICAgIGNvbnN0
IHN0cnVjdCBkb21haW4gKm93bmVyID0gZG9tX3hlbjsKKyAgICBjb25zdCBz
dHJ1Y3QgZG9tYWluICpvd25lcjsKKyAgICBpbnQgcmM7CiAKICAgICBpZiAo
IHBhZ2luZ19tb2RlX2V4dGVybmFsKGQpICkKICAgICAgICAgcmV0dXJuIC1F
T1BOT1RTVVBQOwogCi0gICAgc3Bpbl9sb2NrKCZkLT5wYWdlX2FsbG9jX2xv
Y2spOwotCi0gICAgaWYgKCBpc194ZW5faGVhcF9wYWdlKHBhZ2UpIHx8ICgo
b3duZXIgPSBwYWdlX2dldF9vd25lcihwYWdlKSkgIT0gZCkgKQorICAgIC8q
IEdyYWIgYSByZWZlcmVuY2UgdG8gbWFrZSBzdXJlIHRoZSBwYWdlIGRvZXNu
J3QgY2hhbmdlIHVuZGVyIG91ciBmZWV0ICovCisgICAgcmMgPSAtRUlOVkFM
OworICAgIGlmICggIShvd25lciA9IHBhZ2VfZ2V0X293bmVyX2FuZF9yZWZl
cmVuY2UocGFnZSkpICkKICAgICAgICAgZ290byBmYWlsOwogCisgICAgaWYg
KCBvd25lciAhPSBkIHx8IGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkgKQorICAg
ICAgICBnb3RvIGZhaWxfcHV0OworCiAgICAgLyoKLSAgICAgKiBXZSByZXF1
aXJlIHRoZXJlIGlzIGp1c3Qgb25lIHJlZmVyZW5jZSAoUEdDX2FsbG9jYXRl
ZCkuIFdlIHRlbXBvcmFyaWx5Ci0gICAgICogZHJvcCB0aGlzIHJlZmVyZW5j
ZSBub3cgc28gdGhhdCB3ZSBjYW4gc2FmZWx5IHN3aXp6bGUgdGhlIG93bmVy
LgorICAgICAqIFdlIHJlcXVpcmUgdGhlcmUgYXJlIGV4YWN0bHkgdHdvIHJl
ZmVyZW5jZXMgLS0gdGhlIG9uZSB3ZSBqdXN0CisgICAgICogdG9vaywgYW5k
IFBHQ19hbGxvY2F0ZWQuIFdlIHRlbXBvcmFyaWx5IGRyb3AgYm90aCB0aGVz
ZQorICAgICAqIHJlZmVyZW5jZXMgc28gdGhhdCB0aGUgcGFnZSBiZWNvbWVz
IGVmZmVjdGl2ZWx5IG5vbi0ibGl2ZSIgZm9yCisgICAgICogdGhlIGRvbWFp
bi4KICAgICAgKi8KICAgICB5ID0gcGFnZS0+Y291bnRfaW5mbzsKICAgICBk
byB7CiAgICAgICAgIHggPSB5OwotICAgICAgICBpZiAoICh4ICYgKFBHQ19j
b3VudF9tYXNrfFBHQ19hbGxvY2F0ZWQpKSAhPSAoMSB8IFBHQ19hbGxvY2F0
ZWQpICkKLSAgICAgICAgICAgIGdvdG8gZmFpbDsKLSAgICAgICAgeSA9IGNt
cHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIHggJiB+UEdDX2NvdW50X21h
c2spOworICAgICAgICBpZiAoICh4ICYgKFBHQ19jb3VudF9tYXNrfFBHQ19h
bGxvY2F0ZWQpKSAhPSAoMiB8IFBHQ19hbGxvY2F0ZWQpICkKKyAgICAgICAg
ICAgIGdvdG8gZmFpbF9wdXQ7CisgICAgICAgIHkgPSBjbXB4Y2hnKCZwYWdl
LT5jb3VudF9pbmZvLCB4LCB4ICYgfihQR0NfY291bnRfbWFza3xQR0NfYWxs
b2NhdGVkKSk7CiAgICAgfSB3aGlsZSAoIHkgIT0geCApOwogCiAgICAgLyoK
LSAgICAgKiBXaXRoIHRoZSBzb2xlIHJlZmVyZW5jZSBkcm9wcGVkIHRlbXBv
cmFyaWx5LCBuby1vbmUgY2FuIHVwZGF0ZSB0eXBlCi0gICAgICogaW5mb3Jt
YXRpb24uIFR5cGUgY291bnQgYWxzbyBuZWVkcyB0byBiZSB6ZXJvIGluIHRo
aXMgY2FzZSwgYnV0IGUuZy4KLSAgICAgKiBQR1Rfc2VnX2Rlc2NfcGFnZSBt
YXkgc3RpbGwgaGF2ZSBQR1RfdmFsaWRhdGVkIHNldCwgd2hpY2ggd2UgbmVl
ZCB0bwotICAgICAqIGNsZWFyIGJlZm9yZSB0cmFuc2ZlcnJpbmcgb3duZXJz
aGlwIChhcyB2YWxpZGF0aW9uIGNyaXRlcmlhIHZhcnkKLSAgICAgKiBkZXBl
bmRpbmcgb24gZG9tYWluIHR5cGUpLgorICAgICAqIE5CIHRoaXMgaXMgc2Fm
ZSBldmVuIGlmIHRoZSBwYWdlIGVuZHMgdXAgYmVpbmcgZ2l2ZW4gYmFjayB0
bworICAgICAqIHRoZSBkb21haW4sIGJlY2F1c2UgdGhlIGNvdW50IGlzIHpl
cm86IHN1YnNlcXVlbnQgbWFwcGluZ3Mgd2lsbAorICAgICAqIGNhdXNlIHRo
ZSBjYWNoZSBhdHRyaWJ1dGVzIHRvIGJlIHJlLWluc3RhdGVkIGluc2lkZQor
ICAgICAqIGdldF9wYWdlX2Zyb21fbDFlKCkuCisgICAgICovCisgICAgaWYg
KCAocmMgPSBjbGVhbnVwX3BhZ2VfY2FjaGVhdHRyKHBhZ2UpKSApCisgICAg
eworICAgICAgICAvKgorICAgICAgICAgKiBDb3VsZG4ndCBmaXh1cCBYZW4n
cyBtYXBwaW5nczsgcHV0IHRoaW5ncyB0aGUgd2F5IHdlIGZvdW5kCisgICAg
ICAgICAqIGl0IGFuZCByZXR1cm4gYW4gZXJyb3IKKyAgICAgICAgICovCisg
ICAgICAgIHBhZ2UtPmNvdW50X2luZm8gfD0gUEdDX2FsbG9jYXRlZCB8IDE7
CisgICAgICAgIGdvdG8gZmFpbDsKKyAgICB9CisKKyAgICAvKgorICAgICAq
IFdpdGggdGhlIHJlZmVyZW5jZSBjb3VudCBub3cgemVybywgbm9ib2R5IGNh
biBncmFiIHJlZmVyZW5jZXMKKyAgICAgKiB0byBkbyBhbnl0aGluZyBlbHNl
IHdpdGggdGhlIHBhZ2UuICBSZXR1cm4gdGhlIHBhZ2UgdG8gYSBzdGF0ZQor
ICAgICAqIHRoYXQgaXQgbWlnaHQgYmUgdXBvbiByZXR1cm4gZnJvbSBhbGxv
Y19kb21oZWFwX3BhZ2VzIHdpdGgKKyAgICAgKiBNRU1GX25vX293bmVyIHNl
dC4KICAgICAgKi8KKyAgICBzcGluX2xvY2soJmQtPnBhZ2VfYWxsb2NfbG9j
ayk7CisKICAgICBCVUdfT04ocGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJiAo
UEdUX2NvdW50X21hc2sgfCBQR1RfbG9ja2VkIHwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgUEdUX3Bpbm5lZCkpOwogICAgIHBh
Z2UtPnUuaW51c2UudHlwZV9pbmZvID0gMDsKLQotICAgIC8qIFN3aXp6bGUg
dGhlIG93bmVyIHRoZW4gcmVpbnN0YXRlIHRoZSBQR0NfYWxsb2NhdGVkIHJl
ZmVyZW5jZS4gKi8KICAgICBwYWdlX3NldF9vd25lcihwYWdlLCBOVUxMKTsK
LSAgICB5ID0gcGFnZS0+Y291bnRfaW5mbzsKLSAgICBkbyB7Ci0gICAgICAg
IHggPSB5OwotICAgICAgICBCVUdfT04oKHggJiAoUEdDX2NvdW50X21hc2t8
UEdDX2FsbG9jYXRlZCkpICE9IFBHQ19hbGxvY2F0ZWQpOwotICAgIH0gd2hp
bGUgKCAoeSA9IGNtcHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIHggfCAx
KSkgIT0geCApOworICAgIHBhZ2VfbGlzdF9kZWwocGFnZSwgJmQtPnBhZ2Vf
bGlzdCk7CiAKICAgICAvKiBVbmxpbmsgZnJvbSBvcmlnaW5hbCBvd25lci4g
Ki8KICAgICBpZiAoICEobWVtZmxhZ3MgJiBNRU1GX25vX3JlZmNvdW50KSAm
JiAhZG9tYWluX2FkanVzdF90b3RfcGFnZXMoZCwgLTEpICkKICAgICAgICAg
ZHJvcF9kb21fcmVmID0gdHJ1ZTsKLSAgICBwYWdlX2xpc3RfZGVsKHBhZ2Us
ICZkLT5wYWdlX2xpc3QpOwogCiAgICAgc3Bpbl91bmxvY2soJmQtPnBhZ2Vf
YWxsb2NfbG9jayk7CisKICAgICBpZiAoIHVubGlrZWx5KGRyb3BfZG9tX3Jl
ZikgKQogICAgICAgICBwdXRfZG9tYWluKGQpOworCiAgICAgcmV0dXJuIDA7
CiAKKyBmYWlsX3B1dDoKKyAgICBwdXRfcGFnZShwYWdlKTsKICBmYWlsOgot
ICAgIHNwaW5fdW5sb2NrKCZkLT5wYWdlX2FsbG9jX2xvY2spOwogICAgIGdk
cHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiQmFkIHN0ZWFsIG1mbiAlIiBQUklf
bWZuCiAgICAgICAgICAgICAgIiBmcm9tIGQlZCAob3duZXIgZCVkKSBjYWY9
JTA4bHggdGFmPSUiIFBSdHlwZV9pbmZvICJcbiIsCiAgICAgICAgICAgICAg
bWZuX3gocGFnZV90b19tZm4ocGFnZSkpLCBkLT5kb21haW5faWQsCiAgICAg
ICAgICAgICAgb3duZXIgPyBvd25lci0+ZG9tYWluX2lkIDogRE9NSURfSU5W
QUxJRCwKICAgICAgICAgICAgICBwYWdlLT5jb3VudF9pbmZvLCBwYWdlLT51
LmludXNlLnR5cGVfaW5mbyk7Ci0gICAgcmV0dXJuIC1FSU5WQUw7CisgICAg
cmV0dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IF9fZG9fdXBkYXRlX3ZhX21h
cHBpbmcoCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMg
Yi94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMKaW5kZXggYzA1ODVkMzNmNC4u
NjU2ZmFkMWI0MiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9ncmFudF90YWJs
ZS5jCisrKyBiL3hlbi9jb21tb24vZ3JhbnRfdGFibGUuYwpAQCAtMjE3OSw3
ICsyMTc5LDcgQEAgZ250dGFiX3RyYW5zZmVyKAogICAgICAgICAgICAgcmN1
X3VubG9ja19kb21haW4oZSk7CiAgICAgICAgIHB1dF9nZm5fYW5kX2NvcHli
YWNrOgogICAgICAgICAgICAgcHV0X2dmbihkLCBnb3AubWZuKTsKLSAgICAg
ICAgICAgIHBhZ2UtPmNvdW50X2luZm8gJj0gfihQR0NfY291bnRfbWFza3xQ
R0NfYWxsb2NhdGVkKTsKKyAgICAgICAgICAgIC8qIFRoZSBjb3VudF9pbmZv
IGhhcyBhbHJlYWR5IGJlZW4gY2xlYW5lZCAqLwogICAgICAgICAgICAgZnJl
ZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgICAgICBnb3RvIGNvcHli
YWNrOwogICAgICAgICB9CkBAIC0yMjAyLDEwICsyMjAyLDkgQEAgZ250dGFi
X3RyYW5zZmVyKAogCiAgICAgICAgICAgICBjb3B5X2RvbWFpbl9wYWdlKHBh
Z2VfdG9fbWZuKG5ld19wYWdlKSwgbWZuKTsKIAotICAgICAgICAgICAgcGFn
ZS0+Y291bnRfaW5mbyAmPSB+KFBHQ19jb3VudF9tYXNrfFBHQ19hbGxvY2F0
ZWQpOworICAgICAgICAgICAgLyogVGhlIGNvdW50X2luZm8gaGFzIGFscmVh
ZHkgYmVlbiBjbGVhcmVkICovCiAgICAgICAgICAgICBmcmVlX2RvbWhlYXBf
cGFnZShwYWdlKTsKICAgICAgICAgICAgIHBhZ2UgPSBuZXdfcGFnZTsKLSAg
ICAgICAgICAgIHBhZ2UtPmNvdW50X2luZm8gPSBQR0NfYWxsb2NhdGVkIHwg
MTsKICAgICAgICAgICAgIG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAg
ICAgICB9CiAKQEAgLTIyNDUsMTIgKzIyNDQsMTcgQEAgZ250dGFiX3RyYW5z
ZmVyKAogICAgICAgICAgKi8KICAgICAgICAgc3Bpbl91bmxvY2soJmUtPnBh
Z2VfYWxsb2NfbG9jayk7CiAgICAgICAgIG9rYXkgPSBnbnR0YWJfcHJlcGFy
ZV9mb3JfdHJhbnNmZXIoZSwgZCwgZ29wLnJlZik7Ci0gICAgICAgIHNwaW5f
bG9jaygmZS0+cGFnZV9hbGxvY19sb2NrKTsKIAotICAgICAgICBpZiAoIHVu
bGlrZWx5KCFva2F5KSB8fCB1bmxpa2VseShlLT5pc19keWluZykgKQorICAg
ICAgICBpZiAoIHVubGlrZWx5KCFva2F5IHx8IGFzc2lnbl9wYWdlcyhlLCBw
YWdlLCAwLCBNRU1GX25vX3JlZmNvdW50KSkgKQogICAgICAgICB7Ci0gICAg
ICAgICAgICBib29sX3QgZHJvcF9kb21fcmVmID0gIWRvbWFpbl9hZGp1c3Rf
dG90X3BhZ2VzKGUsIC0xKTsKKyAgICAgICAgICAgIGJvb2wgZHJvcF9kb21f
cmVmOwogCisgICAgICAgICAgICAvKgorICAgICAgICAgICAgICogTmVlZCB0
byBncmFiIHRoaXMgYWdhaW4gdG8gc2FmZWx5IGZyZWUgb3VyICJyZXNlcnZl
ZCIKKyAgICAgICAgICAgICAqIHBhZ2UgaW4gdGhlIHBhZ2UgdG90YWwKKyAg
ICAgICAgICAgICAqLworICAgICAgICAgICAgc3Bpbl9sb2NrKCZlLT5wYWdl
X2FsbG9jX2xvY2spOworICAgICAgICAgICAgZHJvcF9kb21fcmVmID0gIWRv
bWFpbl9hZGp1c3RfdG90X3BhZ2VzKGUsIC0xKTsKICAgICAgICAgICAgIHNw
aW5fdW5sb2NrKCZlLT5wYWdlX2FsbG9jX2xvY2spOwogCiAgICAgICAgICAg
ICBpZiAoIG9rYXkgLyogaS5lLiBlLT5pc19keWluZyBkdWUgdG8gdGhlIHN1
cnJvdW5kaW5nIGlmKCkgKi8gKQpAQCAtMjI2MywxMCArMjI2Nyw2IEBAIGdu
dHRhYl90cmFuc2ZlcigKICAgICAgICAgICAgIGdvdG8gdW5sb2NrX2FuZF9j
b3B5YmFjazsKICAgICAgICAgfQogCi0gICAgICAgIHBhZ2VfbGlzdF9hZGRf
dGFpbChwYWdlLCAmZS0+cGFnZV9saXN0KTsKLSAgICAgICAgcGFnZV9zZXRf
b3duZXIocGFnZSwgZSk7Ci0KLSAgICAgICAgc3Bpbl91bmxvY2soJmUtPnBh
Z2VfYWxsb2NfbG9jayk7CiAgICAgICAgIHB1dF9nZm4oZCwgZ29wLm1mbik7
CiAKICAgICAgICAgVFJBQ0VfMUQoVFJDX01FTV9QQUdFX0dSQU5UX1RSQU5T
RkVSLCBlLT5kb21haW5faWQpOwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9t
ZW1vcnkuYyBiL3hlbi9jb21tb24vbWVtb3J5LmMKaW5kZXggNGZiNzk2MmM3
OS4uZjcxMTYzMjIxZiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9tZW1vcnku
YworKysgYi94ZW4vY29tbW9uL21lbW9yeS5jCkBAIC02NzUsMjAgKzY3NSwy
MiBAQCBzdGF0aWMgbG9uZyBtZW1vcnlfZXhjaGFuZ2UoWEVOX0dVRVNUX0hB
TkRMRV9QQVJBTSh4ZW5fbWVtb3J5X2V4Y2hhbmdlX3QpIGFyZykKICAgICAg
ICAgICogU3VjY2VzcyEgQmV5b25kIHRoaXMgcG9pbnQgd2UgY2Fubm90IGZh
aWwgZm9yIHRoaXMgY2h1bmsuCiAgICAgICAgICAqLwogCi0gICAgICAgIC8q
IERlc3Ryb3kgZmluYWwgcmVmZXJlbmNlIHRvIGVhY2ggaW5wdXQgcGFnZS4g
Ki8KKyAgICAgICAgLyoKKyAgICAgICAgICogVGhlc2UgcGFnZXMgaGF2ZSBh
bHJlYWR5IGhhZCBvd25lciBhbmQgcmVmZXJlbmNlIGNsZWFyZWQuCisgICAg
ICAgICAqIERvIHRoZSBmaW5hbCB0d28gc3RlcHM6IFJlbW92ZSBmcm9tIHRo
ZSBwaHlzbWFwLCBhbmQgZnJlZQorICAgICAgICAgKiB0aGVtLgorICAgICAg
ICAgKi8KICAgICAgICAgd2hpbGUgKCAocGFnZSA9IHBhZ2VfbGlzdF9yZW1v
dmVfaGVhZCgmaW5fY2h1bmtfbGlzdCkpICkKICAgICAgICAgewogICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyBnZm47CiAKLSAgICAgICAgICAgIGlmICgg
IXRlc3RfYW5kX2NsZWFyX2JpdChfUEdDX2FsbG9jYXRlZCwgJnBhZ2UtPmNv
dW50X2luZm8pICkKLSAgICAgICAgICAgICAgICBCVUcoKTsKICAgICAgICAg
ICAgIG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgICAgICAgICAgZ2Zu
ID0gbWZuX3RvX2dtZm4oZCwgbWZuX3gobWZuKSk7CiAgICAgICAgICAgICAv
KiBQYWdlcyB3ZXJlIHVuc2hhcmVkIGFib3ZlICovCiAgICAgICAgICAgICBC
VUdfT04oU0hBUkVEX00yUChnZm4pKTsKICAgICAgICAgICAgIGlmICggZ3Vl
c3RfcGh5c21hcF9yZW1vdmVfcGFnZShkLCBfZ2ZuKGdmbiksIG1mbiwgMCkg
KQogICAgICAgICAgICAgICAgIGRvbWFpbl9jcmFzaChkKTsKLSAgICAgICAg
ICAgIHB1dF9wYWdlKHBhZ2UpOworICAgICAgICAgICAgZnJlZV9kb21oZWFw
X3BhZ2UocGFnZSk7CiAgICAgICAgIH0KIAogICAgICAgICAvKiBBc3NpZ24g
ZWFjaCBvdXRwdXQgcGFnZSB0byB0aGUgZG9tYWluLiAqLwpAQCAtNzYxLDEz
ICs3NjMsMTYgQEAgc3RhdGljIGxvbmcgbWVtb3J5X2V4Y2hhbmdlKFhFTl9H
VUVTVF9IQU5ETEVfUEFSQU0oeGVuX21lbW9yeV9leGNoYW5nZV90KSBhcmcp
CiAgICAgICogY2h1bmtzIHN1Y2NlZWRlZC4KICAgICAgKi8KICBmYWlsOgot
ICAgIC8qIFJlYXNzaWduIGFueSBpbnB1dCBwYWdlcyB3ZSBtYW5hZ2VkIHRv
IHN0ZWFsLiAqLworICAgIC8qCisgICAgICogUmVhc3NpZ24gYW55IGlucHV0
IHBhZ2VzIHdlIG1hbmFnZWQgdG8gc3RlYWwuICBOQiB0aGF0IGlmIHRoZSBh
c3NpZ24KKyAgICAgKiBmYWlscyBhZ2Fpbiwgd2UncmUgb24gdGhlIGhvb2sg
Zm9yIGZyZWVpbmcgdGhlIHBhZ2UsIHNpbmNlIHdlJ3ZlIGFscmVhZHkKKyAg
ICAgKiBjbGVhcmVkIFBHQ19hbGxvY2F0ZWQuCisgICAgICovCiAgICAgd2hp
bGUgKCAocGFnZSA9IHBhZ2VfbGlzdF9yZW1vdmVfaGVhZCgmaW5fY2h1bmtf
bGlzdCkpICkKICAgICAgICAgaWYgKCBhc3NpZ25fcGFnZXMoZCwgcGFnZSwg
MCwgTUVNRl9ub19yZWZjb3VudCkgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBCVUdfT04oIWQtPmlzX2R5aW5nKTsKLSAgICAgICAgICAgIGlmICggdGVz
dF9hbmRfY2xlYXJfYml0KF9QR0NfYWxsb2NhdGVkLCAmcGFnZS0+Y291bnRf
aW5mbykgKQotICAgICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOworICAg
ICAgICAgICAgZnJlZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgIH0K
IAogIGR5aW5nOgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9wYWdlX2FsbG9j
LmMgYi94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYwppbmRleCA0ODJmMDk4OGY3
Li41MmRhNzc2MmUzIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3BhZ2VfYWxs
b2MuYworKysgYi94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYwpAQCAtMjIyMSw3
ICsyMjIxLDcgQEAgaW50IGFzc2lnbl9wYWdlcygKICAgICBmb3IgKCBpID0g
MDsgaSA8ICgxIDw8IG9yZGVyKTsgaSsrICkKICAgICB7CiAgICAgICAgIEFT
U0VSVChwYWdlX2dldF9vd25lcigmcGdbaV0pID09IE5VTEwpOwotICAgICAg
ICBBU1NFUlQoKHBnW2ldLmNvdW50X2luZm8gJiB+KFBHQ19hbGxvY2F0ZWQg
fCAxKSkgPT0gMCk7CisgICAgICAgIEFTU0VSVCghcGdbaV0uY291bnRfaW5m
byk7CiAgICAgICAgIHBhZ2Vfc2V0X293bmVyKCZwZ1tpXSwgZCk7CiAgICAg
ICAgIHNtcF93bWIoKTsgLyogRG9tYWluIHBvaW50ZXIgbXVzdCBiZSB2aXNp
YmxlIGJlZm9yZSB1cGRhdGluZyByZWZjbnQuICovCiAgICAgICAgIHBnW2ld
LmNvdW50X2luZm8gPSBQR0NfYWxsb2NhdGVkIHwgMTsKLS0gCjIuMjAuMQoK

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8CB2B13655C
	for <lists+xen-devel@lfdr.de>; Fri, 10 Jan 2020 03:33:44 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ipk4m-0004kr-DI; Fri, 10 Jan 2020 02:31:04 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=iVu5=27=gmail.com=tamas.k.lengyel@srs-us1.protection.inumbo.net>)
 id 1ipk4l-0004kl-BV
 for xen-devel@lists.xenproject.org; Fri, 10 Jan 2020 02:31:03 +0000
X-Inumbo-ID: 3d029362-3351-11ea-bbef-12813bfff9fa
Received: from mail-io1-f53.google.com (unknown [209.85.166.53])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 3d029362-3351-11ea-bbef-12813bfff9fa;
 Fri, 10 Jan 2020 02:30:59 +0000 (UTC)
Received: by mail-io1-f53.google.com with SMTP id c16so393812ioo.8
 for <xen-devel@lists.xenproject.org>; Thu, 09 Jan 2020 18:30:59 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=S0OuIP8+ucUCDVu7t6xzNjlZC8xt+10xUjUxDwWISgA=;
 b=OGBFnDoX/JJeApchl17WmToGfuAznOrh6x++C46R4g2XXhpvn4hgcHgtZjja3Cxp0P
 edmj+eWUtNJR/E6wyLIC/UUF6mOndJRo+D6TJiGvRkALF18RNJcB5JBD69djiisyyVXB
 jqdWcY51stFOdgBLAbrLm5lPDKnno5irC3MtNqhgPRJ2j4h/Jeri10avLOcaWHkaMWDP
 naxNZDifwe8a8ZcRUJULecfv7m1d02/pJj787LQRfvFxfXd0DQ/P3L0jLJTaOQ9t9pNR
 Y2KOWqqc/awo2d2GcDPHnCYlAmitfUAQ75tdx/9ujr3DT5hUWhLyFpmpcaxTpvdMc5uN
 UiyQ==
X-Gm-Message-State: APjAAAWawLvftj5jG1RWJsqdfLG50z4cOoS4/me8xO/iPiRouXWnPeWR
 aK9dcAtqL5g5pRMypG9jHOrCsh3E+Ek=
X-Google-Smtp-Source: APXvYqzlDbTN196V9ba2dQPos0Arpukk9n/laoHDYX/TOsRIizyqC210epIZclWoluUvmZnL6A0mXw==
X-Received: by 2002:a6b:4e08:: with SMTP id c8mr500480iob.64.1578623457340;
 Thu, 09 Jan 2020 18:30:57 -0800 (PST)
Received: from l1.lan ([2601:280:4c00:797:7e7a:91ff:fe03:32f2])
 by smtp.gmail.com with ESMTPSA id p12sm233622ilk.66.2020.01.09.18.30.55
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 09 Jan 2020 18:30:56 -0800 (PST)
From: Tamas K Lengyel <tamas@tklengyel.com>
To: xen-devel@lists.xenproject.org
Date: Thu,  9 Jan 2020 19:30:52 -0700
Message-Id: <20200110023052.21159-2-tamas@tklengyel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200110023052.21159-1-tamas@tklengyel.com>
References: <20200110023052.21159-1-tamas@tklengyel.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 2/2] Remove undocumented and unmaintained
 tools/memshr library
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Tamas K Lengyel <tamas@tklengyel.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIGxpYnJhcnkgaGFzIGJlZW4gbGFyZ2VseSB1bnRvdWNoZWQgZm9yIG92ZXIgYSBkZWNhZGUg
YXQgdGhpcyBwb2ludCwgaXQgaXMKdW5kb2N1bWVudGVkIGFuZCBpdCdzIHVuY2xlYXIgd2hhdCBp
dCB3YXMgb3JpZ2luYWxseSB1c2VkIGZvci4gUmVtb3ZlIGl0IGZyb20KdHJlZSwgaWYgYW55b25l
IG5lZWRzIGl0IGluIHRoZSBmdXR1cmUgaXQgY2FuIGJlIGNhcnZlZCBvdXQgZnJvbSBnaXQgaGlz
dG9yeS4KClNpZ25lZC1vZmYtYnk6IFRhbWFzIEsgTGVuZ3llbCA8dGFtYXNAdGtsZW5neWVsLmNv
bT4KLS0tCiB0b29scy9NYWtlZmlsZSAgICAgICAgICAgICAgICB8ICAgIDEgLQogdG9vbHMvbWVt
c2hyL01ha2VmaWxlICAgICAgICAgfCAgIDQ5IC0tCiB0b29scy9tZW1zaHIvYmlkaXItZGFlbW9u
LmMgICB8ICAxMDMgLS0tCiB0b29scy9tZW1zaHIvYmlkaXItZGFlbW9uLmggICB8ICAgMjQgLQog
dG9vbHMvbWVtc2hyL2JpZGlyLWhhc2guYyAgICAgfCAxMzU1IC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQogdG9vbHMvbWVtc2hyL2JpZGlyLWhhc2guaCAgICAgfCAgMTE0IC0tLQog
dG9vbHMvbWVtc2hyL2JpZGlyLW5hbWVkZWZzLmggfCAgIDc5IC0tCiB0b29scy9tZW1zaHIvaW50
ZXJmYWNlLmMgICAgICB8ICAyMjQgLS0tLS0tCiB0b29scy9tZW1zaHIvbWVtc2hyLXByaXYuaCAg
ICB8ICAgMzMgLQogdG9vbHMvbWVtc2hyL21lbXNoci5oICAgICAgICAgfCAgIDUxIC0tCiB0b29s
cy9tZW1zaHIvc2htLmMgICAgICAgICAgICB8ICAyNjIgLS0tLS0tLQogdG9vbHMvbWVtc2hyL3No
bS5oICAgICAgICAgICAgfCAgIDQ5IC0tCiAxMiBmaWxlcyBjaGFuZ2VkLCAyMzQ0IGRlbGV0aW9u
cygtKQogZGVsZXRlIG1vZGUgMTAwNjQ0IHRvb2xzL21lbXNoci9NYWtlZmlsZQogZGVsZXRlIG1v
ZGUgMTAwNjQ0IHRvb2xzL21lbXNoci9iaWRpci1kYWVtb24uYwogZGVsZXRlIG1vZGUgMTAwNjQ0
IHRvb2xzL21lbXNoci9iaWRpci1kYWVtb24uaAogZGVsZXRlIG1vZGUgMTAwNjQ0IHRvb2xzL21l
bXNoci9iaWRpci1oYXNoLmMKIGRlbGV0ZSBtb2RlIDEwMDY0NCB0b29scy9tZW1zaHIvYmlkaXIt
aGFzaC5oCiBkZWxldGUgbW9kZSAxMDA2NDQgdG9vbHMvbWVtc2hyL2JpZGlyLW5hbWVkZWZzLmgK
IGRlbGV0ZSBtb2RlIDEwMDY0NCB0b29scy9tZW1zaHIvaW50ZXJmYWNlLmMKIGRlbGV0ZSBtb2Rl
IDEwMDY0NCB0b29scy9tZW1zaHIvbWVtc2hyLXByaXYuaAogZGVsZXRlIG1vZGUgMTAwNjQ0IHRv
b2xzL21lbXNoci9tZW1zaHIuaAogZGVsZXRlIG1vZGUgMTAwNjQ0IHRvb2xzL21lbXNoci9zaG0u
YwogZGVsZXRlIG1vZGUgMTAwNjQ0IHRvb2xzL21lbXNoci9zaG0uaAoKZGlmZiAtLWdpdCBhL3Rv
b2xzL01ha2VmaWxlIGIvdG9vbHMvTWFrZWZpbGUKaW5kZXggN2IxZjZjNGQyOC4uYzEwOTQ2ZTNi
MSAxMDA2NDQKLS0tIGEvdG9vbHMvTWFrZWZpbGUKKysrIGIvdG9vbHMvTWFrZWZpbGUKQEAgLTE5
LDcgKzE5LDYgQEAgU1VCRElSUy0kKENPTkZJR19YODYpICs9IGZpcm13YXJlCiBTVUJESVJTLXkg
Kz0gY29uc29sZQogU1VCRElSUy15ICs9IHhlbm1vbgogU1VCRElSUy15ICs9IHhlbnN0YXQKLVNV
QkRJUlMtJChDT05GSUdfTGludXgpICs9IG1lbXNociAKIFNVQkRJUlMtJChDT05GSUdfTmV0QlNE
KSArPSB4ZW5iYWNrZW5kZAogU1VCRElSUy15ICs9IGxpYmZzaW1hZ2UKIFNVQkRJUlMtJChDT05G
SUdfTGludXgpICs9IGxpYnZjaGFuCmRpZmYgLS1naXQgYS90b29scy9tZW1zaHIvTWFrZWZpbGUg
Yi90b29scy9tZW1zaHIvTWFrZWZpbGUKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDMx
ZDJkZDdhZGEuLjAwMDAwMDAwMDAKLS0tIGEvdG9vbHMvbWVtc2hyL01ha2VmaWxlCisrKyAvZGV2
L251bGwKQEAgLTEsNDkgKzAsMCBAQAotWEVOX1JPT1QgPSAkKENVUkRJUikvLi4vLi4KLWluY2x1
ZGUgJChYRU5fUk9PVCkvdG9vbHMvUnVsZXMubWsKLQotTElCTUVNU0hSLUJVSUxEIDo9IGxpYm1l
bXNoci5hCi0KLUNGTEFHUyAgICAgICAgICArPSAtV2Vycm9yCi1DRkxBR1MgICAgICAgICAgKz0g
LVduby11bnVzZWQKLUNGTEFHUyAgICAgICAgICArPSAkKENGTEFHU194ZW5pbmNsdWRlKQotQ0ZM
QUdTICAgICAgICAgICs9ICQoQ0ZMQUdTX2xpYnhlbmN0cmwpCi1DRkxBR1MgICAgICAgICAgKz0g
LURfR05VX1NPVVJDRQotQ0ZMQUdTICAgICAgICAgICs9IC1mUElDCi0KLUxJQi1TUkNTICAgICAg
ICA6PSBpbnRlcmZhY2UuYwotTElCLVNSQ1MgICAgICAgICs9IHNobS5jCi1MSUItU1JDUyAgICAg
ICAgKz0gYmlkaXItZGFlbW9uLmMKLUxJQi1TUkNTICAgICAgICArPSBiaWRpci1oYXNoLmMKLQot
TElCLU9CSlMgICAgICAgIDo9IGludGVyZmFjZS5vCi1MSUItT0JKUyAgICAgICAgKz0gc2htLm8K
LUxJQi1PQkpTICAgICAgICArPSBiaWRpci1kYWVtb24ubwotTElCLU9CSlMgICAgICAgICs9IGJp
ZGlyLWhhc2gtZmdwcnRzaHIubwotTElCLU9CSlMgICAgICAgICs9IGJpZGlyLWhhc2gtYmxvY2tz
aHIubwotCi1hbGw6IGJ1aWxkCi0KLWJ1aWxkOiAkKExJQk1FTVNIUi1CVUlMRCkKLQotYmlkaXIt
aGFzaC1mZ3BydHNoci5vOiBiaWRpci1oYXNoLmMKLQkkKENDKSAkKENGTEFHUykgLURGSU5HRVJQ
UklOVF9NQVAgLWMgLW8gJCoubyBiaWRpci1oYXNoLmMgCi0KLWJpZGlyLWhhc2gtYmxvY2tzaHIu
bzogYmlkaXItaGFzaC5jCi0JJChDQykgJChDRkxBR1MpIC1EQkxPQ0tfTUFQIC1jIC1vICQqLm8g
YmlkaXItaGFzaC5jIAotCi1saWJtZW1zaHIuYTogJChMSUItT0JKUykKLQkkKEFSKSByYyAkQCAk
XgotCi1pbnN0YWxsOiBhbGwKLQotdW5pbnN0YWxsOgotCi1jbGVhbjoKLQlybSAtcmYgKi5hICou
byAqfiAkKERFUFNfUk0pCi0KLS5QSE9OWTogZGlzdGNsZWFuCi1kaXN0Y2xlYW46IGNsZWFuCi0K
LS5QSE9OWTogYWxsIGJ1aWxkIGNsZWFuIGluc3RhbGwgZGlzdGNsZWFuIHVuaW5zdGFsbAotCi0t
aW5jbHVkZSAkKERFUFNfSU5DTFVERSkKZGlmZiAtLWdpdCBhL3Rvb2xzL21lbXNoci9iaWRpci1k
YWVtb24uYyBiL3Rvb2xzL21lbXNoci9iaWRpci1kYWVtb24uYwpkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggZGRiN2MwMDMxOS4uMDAwMDAwMDAwMAotLS0gYS90b29scy9tZW1zaHIvYmlk
aXItZGFlbW9uLmMKKysrIC9kZXYvbnVsbApAQCAtMSwxMDMgKzAsMCBAQAotLyoqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwOSBDaXRyaXggU3lzdGVtcywgSW5j
LiAoR3J6ZWdvcnogTWlsb3MpCi0gKgotICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7
IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLSAqIGl0IHVuZGVyIHRoZSB0
ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci0g
KiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBM
aWNlbnNlLCBvcgotICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KLSAqCi0g
KiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJl
IHVzZWZ1bCwKLSAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBp
bXBsaWVkIHdhcnJhbnR5IG9mCi0gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQ
QVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCi0gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBmb3IgbW9yZSBkZXRhaWxzLgotICoKLSAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNv
cHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi0gKiBhbG9uZyB3aXRoIHRoaXMg
cHJvZ3JhbTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgotICov
Ci0jaW5jbHVkZSA8cHRocmVhZC5oPgotI2luY2x1ZGUgPGludHR5cGVzLmg+Ci0jaW5jbHVkZSA8
dW5pc3RkLmg+Ci0jaW5jbHVkZSA8ZXJybm8uaD4KLQotI2luY2x1ZGUgImJpZGlyLWhhc2guaCIK
LSNpbmNsdWRlICJtZW1zaHItcHJpdi5oIgotCi1zdGF0aWMgc3RydWN0IGJsb2Nrc2hyX2hhc2gg
KmJsa3NfaGFzaDsKLQotLyogQ2FsbGJhY2sgaW4gdGhlIGl0ZXJhdG9yLCByZW1lbWJlciB0aGlz
IHZhbHVlLCBhbmQgbGVhdmUgKi8KLWludCBmaW5kX29uZSh2YmRibGtfdCBrLCBzaGFyZV90dXBs
ZV90IHYsIHZvaWQgKnByaXYpCi17Ci0gICAgc2hhcmVfdHVwbGVfdCAqcnYgPSAoc2hhcmVfdHVw
bGVfdCAqKSBwcml2OwotICAgICpydiA9IHY7Ci0gICAgLyogQnJlYWsgb3V0IG9mIGl0ZXJhdG9y
IGxvb3AgKi8KLSAgICByZXR1cm4gMTsKLX0KLQotdm9pZCogYmlkaXJfZGFlbW9uKHZvaWQgKnVu
dXNlZCkKLXsKLSAgICB1aW50MzJfdCBucl9lbnQsIG1heF9ucl9lbnQsIHRhYl9zaXplLCBtYXhf
bG9hZCwgbWluX2xvYWQ7Ci0KLSAgICB3aGlsZSgxKQotICAgIHsKLSAgICAgICAgYmxvY2tzaHJf
aGFzaF9zaXplcyggYmxrc19oYXNoLCAKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbnJf
ZW50LCAKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbWF4X25yX2VudCwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAmdGFiX3NpemUsIAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICZtYXhfbG9hZCwgCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgJm1pbl9sb2FkKTsK
LSAgICAgICAgLyogUmVtb3ZlIHNvbWUgaGludHMgYXMgc29vbiBhcyB3ZSBnZXQgdG8gOTAlIGNh
cGFjaXR5ICovIAotICAgICAgICBpZigxMCAqIG5yX2VudCA+IDkgKiBtYXhfbnJfZW50KQotICAg
ICAgICB7Ci0gICAgICAgICAgICBzaGFyZV90dXBsZV90IG5leHRfcmVtb3ZlOwotICAgICAgICAg
ICAgaW50IHRvX3JlbW92ZTsKLSAgICAgICAgICAgIGludCByZXQ7Ci0KLSAgICAgICAgICAgIHRv
X3JlbW92ZSA9IDAuMSAqIG1heF9ucl9lbnQ7IAotICAgICAgICAgICAgd2hpbGUodG9fcmVtb3Zl
ID4gMCkgCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgLyogV2UgdXNlIHRoZSBpdGVy
YXRvciB0byBnZXQgb25lIGVudHJ5ICovCi0gICAgICAgICAgICAgICAgbmV4dF9yZW1vdmUuaGFu
ZGxlID0gMDsKLSAgICAgICAgICAgICAgICByZXQgPSBibG9ja3Nocl9oYXNoX2l0ZXJhdG9yKGJs
a3NfaGFzaCwgZmluZF9vbmUsICZuZXh0X3JlbW92ZSk7Ci0KLSAgICAgICAgICAgICAgICBpZiAo
ICFyZXQgKQotICAgICAgICAgICAgICAgICAgICBpZiAoIG5leHRfcmVtb3ZlLmhhbmRsZSA9PSAw
ICkKLSAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FU1JDSDsKLQotICAgICAgICAgICAg
ICAgIGlmICggIXJldCApCi0gICAgICAgICAgICAgICAgICAgIHJldCA9IGJsb2Nrc2hyX3Nocmhu
ZF9yZW1vdmUoYmxrc19oYXNoLCBuZXh0X3JlbW92ZSwgTlVMTCk7Ci0KLSAgICAgICAgICAgICAg
ICBpZihyZXQgPD0gMCkKLSAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIC8q
IFdlIGZhaWxlZCB0byByZW1vdmUgYW4gZW50cnksIGJlY2F1c2Ugb2YgYSBzZXJpb3VzIGhhc2gK
LSAgICAgICAgICAgICAgICAgICAgICogdGFibGUgZXJyb3IgKi8KLSAgICAgICAgICAgICAgICAg
ICAgRFBSSU5URigiQ291bGQgbm90IHJlbW92ZSBoYW5kbGUgJSJQUklkNjQiLCBlcnJvcjogJWRc
biIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF9yZW1vdmUuaGFuZGxlLCByZXQp
OwotICAgICAgICAgICAgICAgICAgICAvKiBGb3JjZSB0byBleGl0IHRoZSBsb29wIGVhcmx5ICov
Ci0gICAgICAgICAgICAgICAgICAgIHRvX3JlbW92ZSA9IDA7Ci0gICAgICAgICAgICAgICAgfSBl
bHNlIAotICAgICAgICAgICAgICAgIGlmKHJldCA+IDApCi0gICAgICAgICAgICAgICAgewotICAg
ICAgICAgICAgICAgICAgICAvKiBNYW5hZ2VkIHRvIHJlbW92ZSB0aGUgZW50cnkuIE5vdGUgbmV4
dF9yZW1vdmUgbm90Ci0gICAgICAgICAgICAgICAgICAgICAqIGluY3JlbWVudGVkLCBpbiBjYXNl
IHRoZXJlIGFyZSBkdXBsaWNhdGVzICovCi0gICAgICAgICAgICAgICAgICAgIHRvX3JlbW92ZS0t
OwotICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgIH0KLSAgICAgICAgfQotCi0gICAgICAg
IHNsZWVwKDEpOwotICAgIH0KLX0KLQotdm9pZCBiaWRpcl9kYWVtb25fbGF1bmNoKHZvaWQpCi17
Ci0gICAgcHRocmVhZF90IHRocmVhZDsgCi0KLSAgICBwdGhyZWFkX2NyZWF0ZSgmdGhyZWFkLCBO
VUxMLCBiaWRpcl9kYWVtb24sIE5VTEwpOwotfQotCi12b2lkIGJpZGlyX2RhZW1vbl9pbml0aWFs
aXplKHN0cnVjdCBibG9ja3Nocl9oYXNoICpibGtzKQotewotICAgIGJsa3NfaGFzaCA9IGJsa3M7
IAotICAgIGJpZGlyX2RhZW1vbl9sYXVuY2goKTsKLX0KZGlmZiAtLWdpdCBhL3Rvb2xzL21lbXNo
ci9iaWRpci1kYWVtb24uaCBiL3Rvb2xzL21lbXNoci9iaWRpci1kYWVtb24uaApkZWxldGVkIGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggZjY4MzI4MDY3OC4uMDAwMDAwMDAwMAotLS0gYS90b29scy9t
ZW1zaHIvYmlkaXItZGFlbW9uLmgKKysrIC9kZXYvbnVsbApAQCAtMSwyNCArMCwwIEBACi0vKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDA5IENpdHJpeCBTeXN0
ZW1zLCBJbmMuIChHcnplZ29yeiBNaWxvcykKLSAqCi0gKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBz
b2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQotICogaXQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkKLSAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIg
b2YgdGhlIExpY2Vuc2UsIG9yCi0gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9u
LgotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0
IHdpbGwgYmUgdXNlZnVsLAotICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2
ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLSAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNT
IEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLSAqIEdOVSBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCi0gKgotICogWW91IHNob3VsZCBoYXZlIHJlY2Vp
dmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLSAqIGFsb25nIHdp
dGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2Vz
Lz4uCi0gKi8KLQotI2lmbmRlZiBfX0JJRElSX0RBRU1PTl9IX18KLSNkZWZpbmUgX19CSURJUl9E
QUVNT05fSF9fCi0KLXZvaWQgYmlkaXJfZGFlbW9uX2luaXRpYWxpemUoc3RydWN0IGJsb2Nrc2hy
X2hhc2ggKmJsa3MpOwotCi0jZW5kaWYgLyogX19CSURJUl9EQUVNT05fSF9fICovCmRpZmYgLS1n
aXQgYS90b29scy9tZW1zaHIvYmlkaXItaGFzaC5jIGIvdG9vbHMvbWVtc2hyL2JpZGlyLWhhc2gu
YwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggYzVjYzcxZTNjYS4uMDAwMDAwMDAwMAot
LS0gYS90b29scy9tZW1zaHIvYmlkaXItaGFzaC5jCisrKyAvZGV2L251bGwKQEAgLTEsMTM1NSAr
MCwwIEBACi0vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDA5
IENpdHJpeCBTeXN0ZW1zLCBJbmMuIChHcnplZ29yeiBNaWxvcykKLSAqCi0gKiBUaGlzIHByb2dy
YW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlm
eQotICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkKLSAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
ciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCi0gKiAoYXQgeW91ciBvcHRpb24pIGFueSBs
YXRlciB2ZXJzaW9uLgotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAotICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLSAqIE1FUkNIQU5UQUJJTElU
WSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLSAqIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCi0gKgotICogWW91IHNob3Vs
ZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UK
LSAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUu
b3JnL2xpY2Vuc2VzLz4uCi0gKi8KLSNpbmNsdWRlIDxhc3NlcnQuaD4KLSNpbmNsdWRlIDxlcnJu
by5oPgotI2luY2x1ZGUgPG1hdGguaD4KLSNpbmNsdWRlIDxwdGhyZWFkLmg+Ci0jaW5jbHVkZSA8
c3RkZGVmLmg+Ci0jaW5jbHVkZSA8c3RkaW50Lmg+Ci0jaW5jbHVkZSA8c3RkbGliLmg+Ci0jaW5j
bHVkZSA8c3RyaW5nLmg+Ci0jaW5jbHVkZSA8dGltZS5oPgotI2luY2x1ZGUgPHVuaXN0ZC5oPgot
Ci0jaW5jbHVkZSAiYmlkaXItaGFzaC5oIgotCi1zdGF0aWMgY29uc3QgdWludDMyX3QgaGFzaF9z
aXplc1tdID0gezUzLCA5NywgMTkzLCAzODksIDc2OSwgMTU0MywgMzA3OSwgNjE1MSwKLSAgICAx
MjI4OSwgMjQ1OTMsIDQ5MTU3LCA5ODMxNywgMTk2NjEzLCAzOTMyNDEsIDc4NjQzMywgMTU3Mjg2
OSwgMzE0NTczOSwKLSAgICA2MjkxNDY5LCAxMjU4MjkxNywgMjUxNjU4NDMsIDUwMzMxNjUzLCAx
MDA2NjMzMTksIDIwMTMyNjYxMSwgNDAyNjUzMTg5LAotICAgIDgwNTMwNjQ1NywgMTYxMDYxMjc0
MX07Ci1zdGF0aWMgY29uc3QgdWludDE2X3QgaGFzaF9zaXplc19sZW4gPQotICAgICAgICAgICAg
c2l6ZW9mKGhhc2hfc2l6ZXMpL3NpemVvZihoYXNoX3NpemVzWzBdKTsKLXN0YXRpYyBjb25zdCBm
bG9hdCBoYXNoX21heF9sb2FkX2ZhY3QgPSAwLjY1Owotc3RhdGljIGNvbnN0IGZsb2F0IGhhc2hf
bWluX2xvYWRfZmFjdCA9IDAuMTA7Ci0KLS8qIEhvdyBtYW55IGJ1Y2tldHMgd2lsbCBiZSBjb3Zl
cmVkIGJ5IGEgc2luZ2xlIHJ3IGxvY2sgKi8KLSNkZWZpbmUgQlVDS0VUU19QRVJfTE9DSyAgICA2
NAotI2RlZmluZSBucl9sb2NrcyhfbnJfYnVja2V0cykgICAoMSArIChfbnJfYnVja2V0cykgLyBC
VUNLRVRTX1BFUl9MT0NLKQotCi0KLSNkZWZpbmUgSEFTSF9MT0NLICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgcHRocmVh
ZF9yd2xvY2tfdCBoYXNoX2xvY2sKLQotI2RlZmluZSBCVUNLRVRfTE9DSyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBwdGhy
ZWFkX3J3bG9ja190IGJ1Y2tldF9sb2NrCi0KLXN0cnVjdCBoYXNoX2VudHJ5Ci17Ci0gICAgX19r
X3Qga2V5OwotICAgIF9fdl90IHZhbHVlOwotICAgIC8qIFRoaXMgc3RydWN0dXJlIHdpbGwgYmVs
b25nIHRvIHR3byBidWNrZXRzLCBvbmUgaW4gZWFjaCBoYXNoIHRhYmxlICovCi0gICAgc3RydWN0
IGhhc2hfZW50cnkgKmtleV9uZXh0OwotICAgIHN0cnVjdCBoYXNoX2VudHJ5ICp2YWx1ZV9uZXh0
OwotfTsKLQotc3RydWN0IGJ1Y2tldAotewotICAgIHN0cnVjdCBoYXNoX2VudHJ5ICpoYXNoX2Vu
dHJ5OwotfTsKLQotc3RydWN0IGJ1Y2tldF9sb2NrCi17Ci0gICAgQlVDS0VUX0xPQ0s7Ci19Owot
Ci1zdHJ1Y3QgX19oYXNoCi17Ci0gICAgaW50IGxvY2tfYWxpdmU7Ci0gICAgSEFTSF9MT0NLOyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBwcm90ZWN0czoKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAqICpfdGFiLCB0YWJfc2l6ZSwgc2l6ZV9pZHgsICpf
bG9hZAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogKGFsbCB3
cml0ZXMgd2l0aCB3cmxvY2spCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKi8KLSAgICB1aW50MzJfdCBucl9lbnQ7ICAgICAgICAgICAgICAgICAgICAgIC8qICMg
ZW50cmllcyBoZWxkIGluIGhhc2h0YWJsZXMgKi8KLSAgICBzdHJ1Y3QgYnVja2V0ICprZXlfdGFi
OyAgICAgICAgICAgICAgIC8qIGZvcndhcmQgbWFwcGluZyBoYXNodGFibGUgICAgKi8KLSAgICBz
dHJ1Y3QgYnVja2V0ICp2YWx1ZV90YWI7ICAgICAgICAgICAgIC8qIGJhY2t3YXJkIG1hcHBpbmcg
aGFzaHRhYmxlICAgKi8KLSAgICBzdHJ1Y3QgYnVja2V0X2xvY2sgKmtleV9sb2NrX3RhYjsgICAg
IC8qIGtleSB0YWJsZSBidWNrZXQgbG9ja3MgICAgICAgKi8KLSAgICBzdHJ1Y3QgYnVja2V0X2xv
Y2sgKnZhbHVlX2xvY2tfdGFiOyAgIC8qIHZhbHVlIHRhYmxlIGJ1Y2tldCBsb2NrcyAgICAgKi8K
LSAgICB1aW50MzJfdCB0YWJfc2l6ZTsgICAgICAgICAgICAgICAgICAgIC8qICMgYnVja2V0cyBp
cyBoYXNodGFibGVzICAgICAgKi8KLSAgICB1aW50MTZfdCBzaXplX2lkeDsgICAgICAgICAgICAg
ICAgICAgIC8qIHRhYmxlIHNpemUgaW5kZXggICAgICAgICAgICAgKi8KLSAgICB1aW50MzJfdCBt
YXhfbG9hZDsgICAgICAgICAgICAgICAgICAgIC8qICMgZW50cmllcyBiZWZvcmUgcmVoYXNoICAg
ICAgKi8KLSAgICB1aW50MzJfdCBtaW5fbG9hZDsgICAgICAgICAgICAgICAgICAgIC8qICMgZW50
cmllcyBiZWZvcmUgcmVoYXNoICAgICAgKi8KLX07Ci0KLXN0cnVjdCBfX2hhc2ggKl9faGFzaF9p
bml0ICAgKHN0cnVjdCBfX2hhc2ggKmgsIHVpbnQzMl90IG1pbl9zaXplKTsKLWludCAgICAgICAg
ICAgIF9fa2V5X2xvb2t1cCAgKHN0cnVjdCBfX2hhc2ggKmgsIF9fa190IGssIF9fdl90ICp2cCk7
Ci1pbnQgICAgICAgICAgICBfX3ZhbHVlX2xvb2t1cChzdHJ1Y3QgX19oYXNoICpoLCBfX3ZfdCB2
LCBfX2tfdCAqa3ApOwotaW50ICAgICAgICAgICAgX19pbnNlcnQgICAgICAoc3RydWN0IF9faGFz
aCAqaCwgX19rX3QgaywgX192X3Qgdik7Ci1pbnQgICAgICAgICAgICBfX2tleV9yZW1vdmUgIChz
dHJ1Y3QgX19oYXNoICpoLCBfX2tfdCBrLCBfX3ZfdCAqdnApOwotaW50ICAgICAgICAgICAgX192
YWx1ZV9yZW1vdmUoc3RydWN0IF9faGFzaCAqaCwgX192X3QgdiwgX19rX3QgKmtwKTsKLWludCAg
ICAgICAgICAgIF9faGFzaF9kZXN0cm95KHN0cnVjdCBfX2hhc2ggKmgsCi0gICAgICAgICAgICAg
ICAgICAgIHZvaWQgKCplbnRyeV9jb25zdW1lcikoX19rX3QgaywgX192X3Qgdiwgdm9pZCAqcCks
Ci0gICAgICAgICAgICAgICAgICAgIHZvaWQgKmQpOwotaW50ICAgICAgICAgICAgX19oYXNoX2l0
ZXJhdG9yKHN0cnVjdCBfX2hhc2ggKmgsCi0gICAgICAgICAgICAgICAgICAgICAgICBpbnQgKCpl
bnRyeV9jb25zdW1lcikoX19rX3QgaywgX192X3Qgdiwgdm9pZCAqcCksCi0gICAgICAgICAgICAg
ICAgICAgICAgICB2b2lkICpkKTsKLXN0YXRpYyB2b2lkICAgICAgaGFzaF9yZXNpemUoc3RydWN0
IF9faGFzaCAqaCk7Ci0KLSNpZiBkZWZpbmVkKF9fYXJtX18pCi1zdGF0aWMgaW5saW5lIHZvaWQg
YXRvbWljX2luYyh1aW50MzJfdCAqdikKLXsKLSAgICAgICAgdW5zaWduZWQgbG9uZyB0bXA7Ci0g
ICAgICAgIGludCByZXN1bHQ7Ci0KLSAgICAgICAgX19hc21fXyBfX3ZvbGF0aWxlX18oIkAgYXRv
bWljX2luY1xuIgotIjE6ICAgICBsZHJleCAgICUwLCBbJTNdXG4iCi0iICAgICAgIGFkZCAgICAg
JTAsICUwLCAjMVxuIgotIiAgICAgICBzdHJleCAgICUxLCAlMCwgWyUzXVxuIgotIiAgICAgICB0
ZXEgICAgICUxLCAjMFxuIgotIiAgICAgICBibmUgICAgIDFiIgotICAgICAgICA6ICI9JnIiIChy
ZXN1bHQpLCAiPSZyIiAodG1wKSwgIitRbyIgKCp2KQotICAgICAgICA6ICJyIiAodikKLSAgICAg
ICAgOiAiY2MiKTsKLX0KLXN0YXRpYyBpbmxpbmUgdm9pZCBhdG9taWNfZGVjKHVpbnQzMl90ICp2
KQotewotICAgICAgICB1bnNpZ25lZCBsb25nIHRtcDsKLSAgICAgICAgaW50IHJlc3VsdDsKLQot
ICAgICAgICBfX2FzbV9fIF9fdm9sYXRpbGVfXygiQCBhdG9taWNfZGVjXG4iCi0iMTogICAgIGxk
cmV4ICAgJTAsIFslM11cbiIKLSIgICAgICAgc3ViICAgICAlMCwgJTAsICMxXG4iCi0iICAgICAg
IHN0cmV4ICAgJTEsICUwLCBbJTNdXG4iCi0iICAgICAgIHRlcSAgICAgJTEsICMwXG4iCi0iICAg
ICAgIGJuZSAgICAgMWIiCi0gICAgICAgIDogIj0mciIgKHJlc3VsdCksICI9JnIiICh0bXApLCAi
K1FvIiAoKnYpCi0gICAgICAgIDogInIiICh2KQotICAgICAgICA6ICJjYyIpOwotfQotCi0jZWxp
ZiBkZWZpbmVkKF9fYWFyY2g2NF9fKQotCi1zdGF0aWMgaW5saW5lIHZvaWQgYXRvbWljX2luYyh1
aW50MzJfdCAqdikKLXsKLSAgICAgICAgdW5zaWduZWQgbG9uZyB0bXA7Ci0gICAgICAgIGludCBy
ZXN1bHQ7Ci0KLSAgICAgICAgYXNtIHZvbGF0aWxlKCIvLyBhdG9taWNfaW5jXG4iCi0iMTogICAg
IGxkeHIgICAgJXcwLCBbJTNdXG4iCi0iICAgICAgIGFkZCAgICAgJXcwLCAldzAsICMxXG4iCi0i
ICAgICAgIHN0eHIgICAgJXcxLCAldzAsIFslM11cbiIKLSIgICAgICAgY2JueiAgICAldzEsIDFi
IgotICAgICAgICA6ICI9JnIiIChyZXN1bHQpLCAiPSZyIiAodG1wKSwgIitvIiAodikKLSAgICAg
ICAgOiAiciIgKHYpCi0gICAgICAgIDogImNjIik7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBh
dG9taWNfZGVjKHVpbnQzMl90ICp2KQotewotICAgICAgICB1bnNpZ25lZCBsb25nIHRtcDsKLSAg
ICAgICAgaW50IHJlc3VsdDsKLQotICAgICAgICBhc20gdm9sYXRpbGUoIi8vIGF0b21pY19kZWNc
biIKLSIxOiAgICAgbGR4ciAgICAldzAsIFslM11cbiIKLSIgICAgICAgc3ViICAgICAldzAsICV3
MCwgIzFcbiIKLSIgICAgICAgc3R4ciAgICAldzEsICV3MCwgWyUzXVxuIgotIiAgICAgICBjYm56
ICAgICV3MSwgMWIiCi0gICAgICAgIDogIj0mciIgKHJlc3VsdCksICI9JnIiICh0bXApLCAiK28i
ICh2KQotICAgICAgICA6ICJyIiAodikKLSAgICAgICAgOiAiY2MiKTsKLX0KLQotI2Vsc2UgLyog
X194ODZfXyAqLwotc3RhdGljIGlubGluZSB2b2lkIGF0b21pY19pbmModWludDMyX3QgKnYpCi17
Ci0gICAgYXNtIHZvbGF0aWxlICgKLSAgICAgICAgImxvY2sgOyBpbmNsICUwIgotICAgICAgICA6
ICI9bSIgKCoodm9sYXRpbGUgdWludDMyX3QgKil2KQotICAgICAgICA6ICJtIiAoKih2b2xhdGls
ZSB1aW50MzJfdCAqKXYpICk7Ci19Ci1zdGF0aWMgaW5saW5lIHZvaWQgYXRvbWljX2RlYyh1aW50
MzJfdCAqdikKLXsKLSAgICBhc20gdm9sYXRpbGUgKAotICAgICAgICAibG9jayA7IGRlY2wgJTAi
Ci0gICAgICAgIDogIj1tIiAoKih2b2xhdGlsZSB1aW50MzJfdCAqKXYpCi0gICAgICAgIDogIm0i
ICgqKHZvbGF0aWxlIHVpbnQzMl90ICopdikgKTsKLX0KLSNlbmRpZgotCi0jaWZkZWYgQklESVJf
VVNFX1NURE1BTExPQwotCi1zdGF0aWMgdm9pZCogYWxsb2NfZW50cnkoc3RydWN0IF9faGFzaCAq
aCwgaW50IHNpemUpCi17Ci0gICAgcmV0dXJuIG1hbGxvYyhzaXplKTsKLX0KLQotc3RhdGljIHZv
aWQgYWxsb2NfYnVja2V0cyhzdHJ1Y3QgX19oYXNoICpoLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICBpbnQgbnJfYnVja2V0cywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGJ1
Y2tldCAqKmJ1Y2tldF90YWIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBidWNr
ZXRfbG9jayAqKmJ1Y2tldF9sb2Nrc190YWIpCi17Ci0gICAgKmJ1Y2tldF90YWIgPSAoc3RydWN0
IGJ1Y2tldCopCi0gICAgICAgIG1hbGxvYyhucl9idWNrZXRzICogc2l6ZW9mKHN0cnVjdCBidWNr
ZXQpKTsKLSAgICAqYnVja2V0X2xvY2tzX3RhYiA9IChzdHJ1Y3QgYnVja2V0X2xvY2sqKQotICAg
ICAgICBtYWxsb2MobnJfbG9ja3MobnJfYnVja2V0cykgKiBzaXplb2Yoc3RydWN0IGJ1Y2tldF9s
b2NrKSk7Ci19Ci0KLXN0YXRpYyB2b2lkIGZyZWVfZW50cnkoc3RydWN0IF9faGFzaCAqaCwgdm9p
ZCAqcCkKLXsKLSAgICBmcmVlKHApOwotfQotCi1zdGF0aWMgdm9pZCBmcmVlX2J1Y2tldHMoc3Ry
dWN0IF9faGFzaCAqaCwKLSAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgYnVja2V0ICpi
dWNrZXRzLAotICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBidWNrZXRfbG9jayAqYnVj
a2V0X2xvY2tzKQotewotICAgIGZyZWUoYnVja2V0cyk7Ci0gICAgZnJlZShidWNrZXRfbG9ja3Mp
OwotfQotCi1zdGF0aWMgaW50IG1heF9lbnRyaWVzKHN0cnVjdCBfX2hhc2ggKmgpCi17Ci0gICAg
LyogVGhlcmUgYXJlIG5vIGV4cGxpY2l0IHJlc3RyaWN0aW9ucyB0byBob3cgbWFueSBlbnRyaWVz
IHdlIGNhbiBzdG9yZSAqLwotICAgIHJldHVybiAtMTsKLX0KLQotI2Vsc2UKLQotLyoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLwotLyoqIE1lbW9yeSBhbGxvY2F0b3IgZm9yIHNoYXJlZCBtZW1vcnkgcmVn
aW9uICoqLwotLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwotI2RlZmluZSBTSE1fVEFCTEVfU0xPVFMg
NAotCi1zdHJ1Y3Qgc2htX2hkcgotewotICAgIGludCAgICAgICAgICAgICBoYXNoX2FsbG9jYXRl
ZDsKLSAgICBwdGhyZWFkX211dGV4X3QgbXV0ZXg7Ci0gICAgaW50ICAgICAgICAgICAgIGZyZWVf
dGFiX3Nsb3RzW1NITV9UQUJMRV9TTE9UU107Ci0KLSAgICB1bnNpZ25lZCBsb25nICAgZnJlZWxp
c3Rfb2Zmc2V0OwotICAgICAgICAgICAgICAgICAgICAKLSAgICB1bnNpZ25lZCBsb25nICAgZW50
cmllc19vZmZzZXQ7Ci0gICAgdW5zaWduZWQgbG9uZyAgIG5yX2VudHJpZXM7Ci0gICAgICAgICAg
ICAgICAgICAgIAotICAgIHVuc2lnbmVkIGxvbmcgICB0YWJzX29mZnNldDsKLSAgICB1bnNpZ25l
ZCBsb25nICAgbWF4X3RhYl9zaXplOwotICAgIHVuc2lnbmVkIGxvbmcgICBtYXhfbG9ja190YWJf
c2l6ZTsKLQotICAgIHN0cnVjdCBfX2hhc2ggICBoYXNoOwotfTsKLQotc3RhdGljIHVuc2lnbmVk
IGxvbmcgZ2V0X3NobV9iYWRkcih2b2lkICpoZHIpCi17Ci0gICAgcmV0dXJuICgodW5zaWduZWQg
bG9uZyloZHIgLSBvZmZzZXRvZihzdHJ1Y3Qgc2htX2hkciwgaGFzaCkpOwotfQotCi0KLS8qKiBM
b2NhdGlvbnMgb2YgdmFyaW91cyBzdHJ1Y3R1cmVzL21lbW9yeSBhcmVhcyAqKi8KLXN0YXRpYyBz
dHJ1Y3Qgc2htX2hkciogZ2V0X3NobV9oZHIoc3RydWN0IF9faGFzaCAqaCkKLXsKLSAgICByZXR1
cm4gKHN0cnVjdCBzaG1faGRyICopCi0gICAgICAgICAgICAoKHVuc2lnbmVkIGxvbmcpaCAtIG9m
ZnNldG9mKHN0cnVjdCBzaG1faGRyLCBoYXNoKSk7Ci19Ci0KLXN0YXRpYyB1aW50MzJfdCogZ2V0
X3NobV9mcmVlbGlzdChzdHJ1Y3Qgc2htX2hkciAqaGRyKQotewotICAgIHVuc2lnbmVkIGxvbmcg
c2htX2JhZGRyID0gKHVuc2lnbmVkIGxvbmcpaGRyOwotICAgIHJldHVybiAoKHVpbnQzMl90ICop
KHNobV9iYWRkciArIGhkci0+ZnJlZWxpc3Rfb2Zmc2V0KSk7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3Qg
aGFzaF9lbnRyeSogZ2V0X3NobV9lbnRyaWVzKHN0cnVjdCBzaG1faGRyICpoZHIpCi17Ci0gICAg
dW5zaWduZWQgbG9uZyBzaG1fYmFkZHIgPSAodW5zaWduZWQgbG9uZyloZHI7Ci0gICAgcmV0dXJu
ICgoc3RydWN0IGhhc2hfZW50cnkgKikoc2htX2JhZGRyICsgaGRyLT5lbnRyaWVzX29mZnNldCkp
OwotfQotCi1zdGF0aWMgc3RydWN0IGJ1Y2tldCogZ2V0X3NobV90YWIoc3RydWN0IHNobV9oZHIg
KmhkciwgaW50IGkpCi17Ci0gICAgdW5zaWduZWQgbG9uZyBzaG1fYmFkZHIgPSAodW5zaWduZWQg
bG9uZyloZHI7Ci0gICAgcmV0dXJuICgoc3RydWN0IGJ1Y2tldCAqKQotICAgICAgICAgICAgICAg
KChzaG1fYmFkZHIgKyBoZHItPnRhYnNfb2Zmc2V0KSArCi0gICAgICAgICAgICAgICAgIGkgKiAo
aGRyLT5tYXhfdGFiX3NpemUgKyBoZHItPm1heF9sb2NrX3RhYl9zaXplKSkpOwotfQotCi1zdGF0
aWMgc3RydWN0IGJ1Y2tldF9sb2NrKiBnZXRfc2htX2xvY2tfdGFiKHN0cnVjdCBzaG1faGRyICpo
ZHIsIGludCBpKQotewotICAgIHVuc2lnbmVkIGxvbmcgc2htX2JhZGRyID0gKHVuc2lnbmVkIGxv
bmcpaGRyOwotICAgIHJldHVybiAoKHN0cnVjdCBidWNrZXRfbG9jayAqKQotICAgICAgICAgICAg
ICAgKChzaG1fYmFkZHIgKyBoZHItPnRhYnNfb2Zmc2V0KSArCi0gICAgICAgICAgICAgICAgIGkg
KiAoaGRyLT5tYXhfdGFiX3NpemUgKyBoZHItPm1heF9sb2NrX3RhYl9zaXplKSArCi0gICAgICAg
ICAgICAgICAgIGhkci0+bWF4X3RhYl9zaXplKSk7Ci19Ci0KLXN0YXRpYyBpbnQgZ2V0X3NobV9z
bG90KHN0cnVjdCBzaG1faGRyICpoZHIsIHZvaWQgKnApCi17Ci0gICAgdW5zaWduZWQgbG9uZyBz
aG1fYmFkZHIgPSAodW5zaWduZWQgbG9uZyloZHI7Ci0gICAgcmV0dXJuICgodW5zaWduZWQgbG9u
ZylwIC0gKHNobV9iYWRkciArIGhkci0+dGFic19vZmZzZXQpKSAvCi0gICAgICAgICAgICAgICho
ZHItPm1heF90YWJfc2l6ZSArIGhkci0+bWF4X2xvY2tfdGFiX3NpemUpOwotfQotCi0vKiBTaGFy
ZWQgbWVtb3J5IGFsbG9jYXRvciBsb2NrcyAqLwotc3RhdGljIGludCBzaG1fbXV0ZXhfaW5pdChz
dHJ1Y3Qgc2htX2hkciAqaCkKLXsKLSAgICBpbnQgcmV0OwotICAgIHB0aHJlYWRfbXV0ZXhhdHRy
X3QgX2F0dHI7Ci0KLSAgICByZXQgPSBwdGhyZWFkX211dGV4YXR0cl9pbml0KCZfYXR0cik7Ci0g
ICAgaWYocmV0ID09IDApCi0gICAgICAgIHJldCA9IHB0aHJlYWRfbXV0ZXhhdHRyX3NldHBzaGFy
ZWQoJl9hdHRyLCBQVEhSRUFEX1BST0NFU1NfU0hBUkVEKTsKLSAgICBpZihyZXQgPT0gMCkKLSAg
ICAgICAgcmV0ID0gcHRocmVhZF9tdXRleF9pbml0KCZoLT5tdXRleCwgJl9hdHRyKTsKLSAgICBp
ZihyZXQgPT0gMCkKLSAgICAgICAgcmV0ID0gcHRocmVhZF9tdXRleGF0dHJfZGVzdHJveSgmX2F0
dHIpOwotCi0gICAgcmV0dXJuIHJldDsKLX07Ci0KLXN0YXRpYyBpbnQgc2htX211dGV4X2xvY2so
c3RydWN0IHNobV9oZHIgKmgpCi17Ci0gICAgcmV0dXJuIHB0aHJlYWRfbXV0ZXhfbG9jaygmaC0+
bXV0ZXgpOwotfQotCi1zdGF0aWMgaW50IHNobV9tdXRleF91bmxvY2soc3RydWN0IHNobV9oZHIg
KmgpCi17Ci0gICAgcmV0dXJuIHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZoLT5tdXRleCk7Ci19Ci0K
LQotLyogU2hhcmVkIG1lbW9yeSBhbGxvY2F0b3IgZnJlZWxpc3QgKi8KLXN0YXRpYyB2b2lkIHNo
bV9hZGRfdG9fZnJlZWxpc3Qoc3RydWN0IHNobV9oZHIgKmhkciwgdWludDMyX3Qgc2wpCi17Ci0g
ICAgdWludDMyX3QgKmZyZWVsaXN0ID0gZ2V0X3NobV9mcmVlbGlzdChoZHIpOwotCi0gICAgc2ht
X211dGV4X2xvY2soaGRyKTsKLSAgICBmcmVlbGlzdFtzbCsxXSA9IGZyZWVsaXN0WzBdOwotICAg
IGZyZWVsaXN0WzBdID0gc2w7Ci0gICAgc2htX211dGV4X3VubG9jayhoZHIpOwotfQotCi1zdGF0
aWMgdWludDMyX3Qgc2htX2dldF9mcm9tX2ZyZWVsaXN0KHN0cnVjdCBzaG1faGRyICpoZHIpCi17
Ci0gICAgdWludDMyX3QgKmZyZWVsaXN0ID0gZ2V0X3NobV9mcmVlbGlzdChoZHIpOwotICAgIHVp
bnQzMl90IHNsb3Q7Ci0KLSAgICBzaG1fbXV0ZXhfbG9jayhoZHIpOwotICAgIHNsb3QgPSBmcmVl
bGlzdFswXTsKLSAgICBmcmVlbGlzdFswXSA9IGZyZWVsaXN0W3Nsb3QrMV07Ci0gICAgc2htX211
dGV4X3VubG9jayhoZHIpOwotCi0gICAgcmV0dXJuIChzbG90ID09IDAgPyAtMSA6IHNsb3QpOwot
fQotCi0KLSNkZWZpbmUgU0hNX0FMTE9DX01BSU4oX24pCi0KLXN0YXRpYyB1bnNpZ25lZCBsb25n
IHNobV9pbml0X29mZnNldHMoCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3Qgc2htX2hkciAqaGRyLCBpbnQgbnJfZW50cmllcykKLXsKLSAgICBoZHItPmZyZWVsaXN0
X29mZnNldCA9IHNpemVvZihzdHJ1Y3Qgc2htX2hkcik7Ci0KLSAgICAvKiBGcmVlbGlzdCBuZWVk
cyBvbmUgZXh0cmEgc2xvdCBpbiB0aGUgYXJyYXkgZm9yIHRoZSBmcmVlbGlzdCBoZWFkICovCi0g
ICAgaGRyLT5lbnRyaWVzX29mZnNldCA9Ci0gICAgICAgIGhkci0+ZnJlZWxpc3Rfb2Zmc2V0ICsg
KG5yX2VudHJpZXMgKyAxKSAqIHNpemVvZih1aW50MzJfdCk7Ci0gICAgaGRyLT5ucl9lbnRyaWVz
ID0gbnJfZW50cmllczsKLQotICAgIGhkci0+dGFic19vZmZzZXQgPSBoZHItPmVudHJpZXNfb2Zm
c2V0ICsKLSAgICAgICAgbnJfZW50cmllcyAqIHNpemVvZihzdHJ1Y3QgaGFzaF9lbnRyeSk7Ci0g
ICAgLyogV2Ugd2FudCB0byBhbGxvY2F0ZSB0YWJsZSAxLjUgbGFyZ2VyIHRoYW4gdGhlIG51bWJl
ciBvZiBlbnRyaWVzCi0gICAgICAgd2Ugd2FudCB0byBob2xkIGluIGl0ICovCi0gICAgaGRyLT5t
YXhfdGFiX3NpemUgPQotICAgICAgICAobnJfZW50cmllcyAqIDMgLyAyKSAqIHNpemVvZihzdHJ1
Y3QgYnVja2V0KTsKLSAgICBoZHItPm1heF9sb2NrX3RhYl9zaXplID0KLSAgICAgICAgbnJfbG9j
a3MoaGRyLT5tYXhfdGFiX3NpemUpICogc2l6ZW9mKHN0cnVjdCBidWNrZXRfbG9jayk7Ci0KLSAg
ICByZXR1cm4gaGRyLT50YWJzX29mZnNldCArIChoZHItPm1heF90YWJfc2l6ZSArIGhkci0+bWF4
X2xvY2tfdGFiX3NpemUpICogNDsKLX0KLQotc3RydWN0IF9faGFzaCogX19zaG1faGFzaF9pbml0
KHVuc2lnbmVkIGxvbmcgc2htX2JhZGRyLCB1bnNpZ25lZCBsb25nIHNobV9zaXplKQotewotICAg
IHVpbnQzMl90IGk7Ci0gICAgc3RydWN0IHNobV9oZHIgKmhkcjsKLQotICAgIC8qIFNvbWUgc2Fu
aXR5IGNoZWNrcyAqLwotICAgIGhkciA9IChzdHJ1Y3Qgc2htX2hkciAqKXNobV9iYWRkcjsKLSAg
ICBtZW1zZXQoaGRyLCAwLCBzaXplb2Yoc3RydWN0IHNobV9oZHIpKTsKLQotICAgIC8qIEZpbmQg
dGhlIG1heGltdW0gbnVtYmVyIG9mIGVudHJpZXMgd2UgY2FuIHN0b3JlIGluIHRoZSBnaXZlbiBz
aG1fc2l6ZSAqLwotICAgIGZvcihpPTE7IHNobV9pbml0X29mZnNldHMoaGRyLCBpKSA8IHNobV9z
aXplOyBpKyspe307Ci0gICAgc2htX2luaXRfb2Zmc2V0cyhoZHIsIChpLTEpKTsKLQotICAgIG1l
bXNldChnZXRfc2htX2ZyZWVsaXN0KGhkciksIDAsCi0gICAgICAgICAgIChoZHItPm5yX2VudHJp
ZXMgKyAxKSAqIHNpemVvZih1aW50MzJfdCkpOwotICAgIGlmKHNobV9tdXRleF9pbml0KGhkcikg
IT0gMCkKLSAgICAgICAgcmV0dXJuIE5VTEw7Ci0gICAgZm9yKGk9MDsgaTxoZHItPm5yX2VudHJp
ZXM7IGkrKykKLSAgICAgICAgc2htX2FkZF90b19mcmVlbGlzdChoZHIsIGkpOwotICAgIGZvcihp
PTA7IGk8U0hNX1RBQkxFX1NMT1RTOyBpKyspCi0gICAgICAgIGhkci0+ZnJlZV90YWJfc2xvdHNb
aV0gPSAxOwotCi0gICAgc2htX211dGV4X2xvY2soaGRyKTsKLSAgICBhc3NlcnQoIWhkci0+aGFz
aF9hbGxvY2F0ZWQpOwotICAgIGhkci0+aGFzaF9hbGxvY2F0ZWQgPSAxOwotICAgIHNobV9tdXRl
eF91bmxvY2soaGRyKTsKLQotICAgIHJldHVybiBfX2hhc2hfaW5pdCgmaGRyLT5oYXNoLCAxMDAw
KTsKLX0KLQotc3RydWN0IF9faGFzaCogX19zaG1faGFzaF9nZXQodW5zaWduZWQgbG9uZyBzaG1f
YmFkZHIpCi17Ci0gICAgc3RydWN0IHNobV9oZHIgKmhkciA9IChzdHJ1Y3Qgc2htX2hkciAqKXNo
bV9iYWRkcjsKLQotICAgIHJldHVybiAoaGRyLT5oYXNoX2FsbG9jYXRlZCA/ICZoZHItPmhhc2gg
OiBOVUxMKTsKLX0KLQotc3RhdGljIHZvaWQqIGFsbG9jX2VudHJ5KHN0cnVjdCBfX2hhc2ggKmgs
IGludCBzaXplKQotewotICAgIHN0cnVjdCBzaG1faGRyICpoZHIgPSBnZXRfc2htX2hkcihoKTsK
LSAgICB1aW50MzJfdCBzbG90ID0gc2htX2dldF9mcm9tX2ZyZWVsaXN0KGhkcik7Ci0KLSAgICBh
c3NlcnQoc2l6ZSA9PSBzaXplb2Yoc3RydWN0IGhhc2hfZW50cnkpKTsKLSAgICBpZihzbG90ID09
IC0xKQotICAgICAgICByZXR1cm4gTlVMTDsKLQotICAgIHJldHVybiAoZ2V0X3NobV9lbnRyaWVz
KGhkcikgKyBzbG90KTsKLX0KLQotc3RhdGljIHZvaWQgYWxsb2NfYnVja2V0cyhzdHJ1Y3QgX19o
YXNoICpoLAotICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgbnJfYnVja2V0cywKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGJ1Y2tldCAqKmJ1Y2tldHNfdGFiLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgYnVja2V0X2xvY2sgKipidWNrZXRfbG9ja3NfdGFi
KQotewotICAgIHN0cnVjdCBzaG1faGRyICpoZHIgPSBnZXRfc2htX2hkcihoKTsKLSAgICBpbnQg
ZnJlZV9zbG90OwotCi0gICAgKmJ1Y2tldHNfdGFiID0gTlVMTDsKLSAgICAqYnVja2V0X2xvY2tz
X3RhYiA9IE5VTEw7Ci0KLSAgICBpZigoKG5yX2J1Y2tldHMgKiBzaXplb2Yoc3RydWN0IGJ1Y2tl
dCkpID4gaGRyLT5tYXhfdGFiX3NpemUpIHx8Ci0gICAgICAgKChucl9sb2Nrcyhucl9idWNrZXRz
KSAqIHNpemVvZihzdHJ1Y3QgYnVja2V0X2xvY2spKSA+Ci0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBoZHItPm1heF9sb2NrX3RhYl9zaXplKSkKLSAgICAg
ICAgcmV0dXJuOwotCi0gICAgc2htX211dGV4X2xvY2soaGRyKTsKLSAgICBmb3IoZnJlZV9zbG90
PTA7IGZyZWVfc2xvdDxTSE1fVEFCTEVfU0xPVFM7IGZyZWVfc2xvdCsrKQotICAgICAgICBpZiho
ZHItPmZyZWVfdGFiX3Nsb3RzW2ZyZWVfc2xvdF0pCi0gICAgICAgICAgICBicmVhazsKLSAgICBp
ZihmcmVlX3Nsb3QgPT0gU0hNX1RBQkxFX1NMT1RTKQotICAgIHsKLSAgICAgICAgc2htX211dGV4
X3VubG9jayhoZHIpOwotICAgICAgICByZXR1cm47Ci0gICAgfQotICAgIGhkci0+ZnJlZV90YWJf
c2xvdHNbZnJlZV9zbG90XSA9IDA7Ci0gICAgc2htX211dGV4X3VubG9jayhoZHIpOwotICAgICpi
dWNrZXRzX3RhYiAgICAgID0gZ2V0X3NobV90YWIoaGRyLCBmcmVlX3Nsb3QpOwotICAgICpidWNr
ZXRfbG9ja3NfdGFiID0gZ2V0X3NobV9sb2NrX3RhYihoZHIsIGZyZWVfc2xvdCk7Ci19Ci0KLXN0
YXRpYyB2b2lkIGZyZWVfZW50cnkoc3RydWN0IF9faGFzaCAqaCwgdm9pZCAqcCkKLXsKLSAgICBz
dHJ1Y3Qgc2htX2hkciAqaGRyID0gZ2V0X3NobV9oZHIoaCk7Ci0gICAgdWludDMyX3Qgc2xvdDsK
LQotICAgIHNsb3QgPSAoKHVpbnQzMl90KSgoc3RydWN0IGhhc2hfZW50cnkgKilwIC0KLSAgICAg
ICAgICAgICAgICBnZXRfc2htX2VudHJpZXMoaGRyKSkpOwotICAgIHNobV9hZGRfdG9fZnJlZWxp
c3QoaGRyLCBzbG90KTsKLX0KLQotc3RhdGljIHZvaWQgZnJlZV9idWNrZXRzKHN0cnVjdCBfX2hh
c2ggKmgsCi0gICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGJ1Y2tldCAqYnVja2V0cywK
LSAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgYnVja2V0X2xvY2sgKmJ1Y2tldF9sb2Nr
cykKLXsKLSAgICBzdHJ1Y3Qgc2htX2hkciAqaGRyID0gZ2V0X3NobV9oZHIoaCk7Ci0gICAgaW50
IHNsb3Q7Ci0KLSAgICBpZighYnVja2V0cyB8fCAhYnVja2V0X2xvY2tzKQotICAgIHsKLSAgICAg
ICAgYXNzZXJ0KCFidWNrZXRzICYmICFidWNrZXRfbG9ja3MpOwotICAgICAgICByZXR1cm47Ci0g
ICAgfQotICAgIHNsb3QgPSBnZXRfc2htX3Nsb3QoaGRyLCBidWNrZXRzKTsKLSAgICBhc3NlcnQo
c2xvdCA8IFNITV9UQUJMRV9TTE9UUyk7Ci0gICAgYXNzZXJ0KChjaGFyICopYnVja2V0X2xvY2tz
ID09IChjaGFyICopYnVja2V0cyArIGhkci0+bWF4X3RhYl9zaXplKTsKLSAgICBzaG1fbXV0ZXhf
bG9jayhoZHIpOwotICAgIGFzc2VydChoZHItPmZyZWVfdGFiX3Nsb3RzW3Nsb3RdID09IDApOwot
ICAgIGhkci0+ZnJlZV90YWJfc2xvdHNbc2xvdF0gPSAxOwotICAgIHNobV9tdXRleF91bmxvY2so
aGRyKTsKLX0KLQotc3RhdGljIGludCBtYXhfZW50cmllcyhzdHJ1Y3QgX19oYXNoICpoKQotewot
ICAgIHN0cnVjdCBzaG1faGRyICpoZHIgPSBnZXRfc2htX2hkcihoKTsKLQotICAgIHJldHVybiBo
ZHItPm5yX2VudHJpZXM7Ci19Ci0KLSNlbmRpZiAvKiAhQklESVJfVVNFX1NURE1BTExPQyAqLwot
Ci0KLS8qIFRoZSBzdHJ1Y3R1cmVzIG1heSBiZSBzdG9yZWQgaW4gc2hhcmVkIG1lbW9yeSByZWdp
b24sIHdpdGggYmFzZSBhZGRyZXNzICovCi0vKiBzdG9yZWQgaW4gc2htX2Jhc2VfYWRkci4gQWxs
IHRoZSBwb2ludGVycyBpbiB0aGUgYWJvdmUgc3RydWN0dXJlcyBuZWVkICAqLwotLyogdG8gYmUg
cmVsYXRpdmUgdG8gdGhpcyBiYXNlIGFkZHJlc3MgKG90aGVyd2lzZSB0aGV5IHdvdWxkIG5vdCBt
YWtlICAgICAgKi8KLS8qIHNlbnNlIHRvIG90aGVyIHByb2Nlc3NlcykuIEJlbGxvdyBhY2Nlc3Nv
ciBmdW5jdGlvbnMgYXJlIHVzZWQgdG8gICAgICAgICovCi0vKiBjb252ZXJ0IGJldHdlZW4gY2Fu
b25pY2FsIChiYXNlIGFkZHJlc3MgcmVsYXRpdmUpIGFuZCBsb2NhbCBhZGRyZXNzZXMuICAqLwot
LyogQzJMIHN0YW5kcyBmb3IgQ0FOT05JQ0FMX1RPX0xPQ0FMLCBhbmQgdmljZSB2ZXJzYSAgICAg
ICAgICAgICAgICAgICAgICAgKi8KLSNkZWZpbmUgQzJMKF9oLCBfcCkgKCh0eXBlb2YoX3ApKSgo
dW5zaWduZWQgbG9uZykoX3ApICsgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAg
ICBnZXRfc2htX2JhZGRyKF9oKSkpCi0jZGVmaW5lIEwyQyhfaCwgX3ApICgodHlwZW9mKF9wKSko
KHVuc2lnbmVkIGxvbmcpKF9wKSAtICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICAg
ICAgZ2V0X3NobV9iYWRkcihfaCkpKQotCi0KLSNkZWZpbmUgSEFTSF9MT0NLX0lOSVQoX2gpICh7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAg
aW50IF9yZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAotICAgIHB0aHJlYWRfcndsb2NrYXR0cl90IF9hdHRyOyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgaC0+bG9ja19hbGl2ZSA9IDE7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIF9yZXQgPSBwdGhyZWFk
X3J3bG9ja2F0dHJfaW5pdCgmX2F0dHIpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICBpZihfcmV0ID09IDApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIF9yZXQgPSBwdGhyZWFkX3J3
bG9ja2F0dHJfc2V0cHNoYXJlZCgmX2F0dHIsICAgICAgICAgICAgICAgICAgICAgICAgICAgXAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFRIUkVBRF9QUk9D
RVNTX1NIQVJFRCk7ICAgICAgICAgIFwKLSAgICBpZihfcmV0ID09IDApICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAg
IF9yZXQgPSBwdGhyZWFkX3J3bG9ja19pbml0KCYoX2gpLT5oYXNoX2xvY2ssICZfYXR0cik7ICAg
ICAgICAgICAgICAgICAgXAotICAgIGlmKF9yZXQgPT0gMCkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgX3JldCA9
IHB0aHJlYWRfcndsb2NrYXR0cl9kZXN0cm95KCZfYXR0cik7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIF9yZXQ7ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLX0pCi0KLSNkZWZpbmUgSEFTSF9MT0NLX1JETE9DSyhfaCkgKHsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgaW50IF9yZXQ7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBpZighX2gtPmxvY2tfYWxpdmUpIF9yZXQg
PSBFTk9MQ0s7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAg
ZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAotICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgc3Ry
dWN0IHRpbWVzcGVjIF90czsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgICAgIC8qIDEwcyB0aW1lb3V0LCBsb25nIGJ1dCB+bWF0Y2hlcyBk
aXNrIHNwaW4tdXAgdGltZXMgKi8gICAgICAgICAgICAgICAgXAotICAgICAgICBfdHMudHZfc2Vj
ID0gdGltZShOVUxMKSArIDEwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICAgICAgX3RzLnR2X25zZWMgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIF9yZXQgPSBwdGhyZWFkX3J3
bG9ja190aW1lZHJkbG9jaygmKF9oKS0+aGFzaF9sb2NrLCAmX3RzKTsgICAgICAgICAgICAgXAot
ICAgICAgICBpZihfcmV0ID09IEVUSU1FRE9VVCkgX2gtPmxvY2tfYWxpdmUgPSAwOyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgX3Jl
dDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAotfSkKLQotI2RlZmluZSBIQVNIX0xPQ0tfUkRVTkxPQ0soX2gpICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBwdGhy
ZWFkX3J3bG9ja191bmxvY2soJihfaCktPmhhc2hfbG9jaykKLQotI2RlZmluZSBIQVNIX0xPQ0tf
V1JMT0NLKF9oKSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICBpbnQgX3JldDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAot
ICAgIGlmKCFfaC0+bG9ja19hbGl2ZSkgX3JldCA9IEVOT0xDSzsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBlbHNlICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgeyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAotICAgICAgICBzdHJ1Y3QgdGltZXNwZWMgX3RzOyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgX3RzLnR2
X3NlYyA9IHRpbWUoTlVMTCkgKyAxMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCi0gICAgICAgIF90cy50dl9uc2VjID0gMFVMOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICBfcmV0ID0gcHRocmVh
ZF9yd2xvY2tfdGltZWR3cmxvY2soJihfaCktPmhhc2hfbG9jaywgJl90cyk7ICAgICAgICAgICAg
IFwKLSAgICAgICAgaWYoX3JldCA9PSBFVElNRURPVVQpIF9oLT5sb2NrX2FsaXZlID0gMDsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgfSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAg
IF9yZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKLX0pCi0KLSNkZWZpbmUgSEFTSF9MT0NLX1RSWVdSTE9DSyhf
aCkgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAg
aW50IF9yZXQgPSAoX2gtPmxvY2tfYWxpdmUgPyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgICAgICAgICAgICBwdGhyZWFkX3J3bG9ja190
cnl3cmxvY2soJihfaCktPmhhc2hfbG9jaykgOiAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAg
ICAgICAgICAgRU5PTENLKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgX3JldDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotfSkKLQotI2RlZmluZSBIQVNI
X0xPQ0tfV1JVTkxPQ0soX2gpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKLSAgICBwdGhyZWFkX3J3bG9ja191bmxvY2soJihfaCktPmhhc2hfbG9jaykK
LQotCi0jZGVmaW5lIEJVQ0tFVF9MT0NLX0lOSVQoX2gsIF9iKSAoeyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGludCBfcmV0OyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAg
ICBwdGhyZWFkX3J3bG9ja2F0dHJfdCBfYXR0cjsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIF9yZXQg
PSBwdGhyZWFkX3J3bG9ja2F0dHJfaW5pdCgmX2F0dHIpOyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKLSAgICBpZihfcmV0ID09IDApICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIF9yZXQgPSBw
dGhyZWFkX3J3bG9ja2F0dHJfc2V0cHNoYXJlZCgmX2F0dHIsICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFRI
UkVBRF9QUk9DRVNTX1NIQVJFRCk7ICAgICAgICAgIFwKLSAgICBpZihfcmV0ID09IDApICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
Ci0gICAgICAgIF9yZXQgPSBwdGhyZWFkX3J3bG9ja19pbml0KCYoX2IpLT5idWNrZXRfbG9jaywg
Jl9hdHRyKTsgICAgICAgICAgICAgICAgXAotICAgIGlmKF9yZXQgPT0gMCkgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAg
ICAgX3JldCA9IHB0aHJlYWRfcndsb2NrYXR0cl9kZXN0cm95KCZfYXR0cik7ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIF9yZXQ7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKLX0pCi0KLQotI2RlZmluZSBCVUNLRVRfTE9DS19SRExPQ0soX2gsIF9sb2Nr
X3RhYiwgX2lkeCkgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBpbnQgX3Jl
dDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgc3RydWN0IHRpbWVzcGVjIF90czsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIHN0cnVjdCBidWNrZXRf
bG9jayAqX2xvY2sgPSAmKF9sb2NrX3RhYilbKF9pZHgpIC8gQlVDS0VUU19QRVJfTE9DS107ICAg
ICAgIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgX3RzLnR2X3NlYyA9IHRpbWUoTlVM
TCkgKyAxMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAot
ICAgIF90cy50dl9uc2VjID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBfcmV0ID0gcHRocmVhZF9yd2xvY2tfdGltZWRy
ZGxvY2soJihfbG9jayktPmJ1Y2tldF9sb2NrLCAmX3RzKTsgICAgICAgICAgICBcCi0gICAgaWYo
X3JldCA9PSBFVElNRURPVVQpIChfaCktPmxvY2tfYWxpdmUgPSAwOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAotICAgIF9yZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLX0pCi0KLQotI2RlZmlu
ZSBCVUNLRVRfTE9DS19SRFVOTE9DSyhfaCwgX2xvY2tfdGFiLCBfaWR4KSAoeyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKLSAgICBzdHJ1Y3QgYnVja2V0X2xvY2sgKl9sb2NrID0gJihfbG9j
a190YWIpWyhfaWR4KSAvIEJVQ0tFVFNfUEVSX0xPQ0tdOyAgICAgICBcCi0gICAgcHRocmVhZF9y
d2xvY2tfdW5sb2NrKCYoX2xvY2spLT5idWNrZXRfbG9jayk7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAotfSkKLQotI2RlZmluZSBCVUNLRVRfTE9DS19XUkxPQ0soX2gsIF9sb2NrX3Rh
YiwgX2lkeCkgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBpbnQgX3JldDsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCi0gICAgc3RydWN0IHRpbWVzcGVjIF90czsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIHN0cnVjdCBidWNrZXRfbG9j
ayAqX2xvY2sgPSAmKF9sb2NrX3RhYilbKF9pZHgpIC8gQlVDS0VUU19QRVJfTE9DS107ICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgX3RzLnR2X3NlYyA9IHRpbWUoTlVMTCkg
KyAxMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAg
IF90cy50dl9uc2VjID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKLSAgICBfcmV0ID0gcHRocmVhZF9yd2xvY2tfdGltZWR3cmxv
Y2soJihfbG9jayktPmJ1Y2tldF9sb2NrLCAmX3RzKTsgICAgICAgICAgICBcCi0gICAgaWYoX3Jl
dCA9PSBFVElNRURPVVQpIChfaCktPmxvY2tfYWxpdmUgPSAwOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAotICAgIF9yZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLX0pCi0KLSNkZWZpbmUgQlVD
S0VUX0xPQ0tfV1JVTkxPQ0soX2gsIF9sb2NrX3RhYiwgX2lkeCkgKHsgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgc3RydWN0IGJ1Y2tldF9sb2NrICpfbG9jayA9ICYoX2xvY2tfdGFi
KVsoX2lkeCkgLyBCVUNLRVRTX1BFUl9MT0NLXTsgICAgICAgXAotICAgIHB0aHJlYWRfcndsb2Nr
X3VubG9jaygmKF9sb2NrKS0+YnVja2V0X2xvY2spOyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLX0pCi0KLSNkZWZpbmUgVFdPX0JVQ0tFVFNfTE9DS19XUkxPQ0soX2gsIF9ibHQxLCBf
aWR4MSwgX2JsdDIsIF9pZHgyKSAgKHsgICAgICAgICAgICBcCi0gICAgaW50IF9yZXQ7ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAotICAgIHB0aHJlYWRfcndsb2NrX3QgKl9sMSwgKl9sMjsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBzdHJ1Y3QgdGltZXNwZWMgX3RzOyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0g
ICAgc3RydWN0IGJ1Y2tldF9sb2NrICpfYmwxID0gJihfYmx0MSlbKF9pZHgxKSAvIEJVQ0tFVFNf
UEVSX0xPQ0tdOyAgICAgICAgICAgXAotICAgIHN0cnVjdCBidWNrZXRfbG9jayAqX2JsMiA9ICYo
X2JsdDIpWyhfaWR4MikgLyBCVUNLRVRTX1BFUl9MT0NLXTsgICAgICAgICAgIFwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCi0gICAgYXNzZXJ0KChfYmwxKSAhPSAoX2JsMikpOyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGlmKChfYmwxKSA8
IChfYmwyKSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKLSAgICB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIF9sMSA9ICYoX2JsMSkt
PmJ1Y2tldF9sb2NrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAotICAgICAgICBfbDIgPSAmKF9ibDIpLT5idWNrZXRfbG9jazsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICB9ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAg
ZWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAotICAgIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgX2wx
ID0gJihfYmwyKS0+YnVja2V0X2xvY2s7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgICAgIF9sMiA9ICYoX2JsMSktPmJ1Y2tldF9sb2NrOyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIH0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICBfdHMudHZfc2VjID0gdGltZShOVUxMKSArIDEwOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgX3RzLnR2X25zZWMgPSAwOyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAot
ICAgIF9yZXQgPSBwdGhyZWFkX3J3bG9ja190aW1lZHdybG9jayhfbDEsICZfdHMpOyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBfdHMudHZfc2VjID0gdGltZShOVUxMKSArIDEw
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgX3Rz
LnR2X25zZWMgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAotICAgIGlmKF9yZXQgPT0gMCkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgX3JldCA9
IHB0aHJlYWRfcndsb2NrX3RpbWVkd3Jsb2NrKF9sMiwgJl90cyk7ICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCi0gICAgaWYoX3JldCA9PSBFVElNRURPVVQpIChfaCktPmxvY2tfYWxpdmUgPSAw
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICBfcmV0OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCi19KQotCi0jZGVmaW5lIFRXT19CVUNLRVRTX0xP
Q0tfV1JVTkxPQ0soX2gsIF9ibHQxLCBfaWR4MSwgX2JsdDIsIF9pZHgyKSAoeyAgICAgICAgICAg
XAotICAgIGludCBfcmV0OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBzdHJ1Y3QgYnVja2V0X2xvY2sgKl9ibDEg
PSAmKF9ibHQxKVsoX2lkeDEpIC8gQlVDS0VUU19QRVJfTE9DS107ICAgICAgICAgICBcCi0gICAg
c3RydWN0IGJ1Y2tldF9sb2NrICpfYmwyID0gJihfYmx0MilbKF9pZHgyKSAvIEJVQ0tFVFNfUEVS
X0xPQ0tdOyAgICAgICAgICAgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBfcmV0ID0g
cHRocmVhZF9yd2xvY2tfdW5sb2NrKCYoX2JsMSktPmJ1Y2tldF9sb2NrKTsgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgaWYoX3JldCA9PSAwKSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICBfcmV0ID0gcHRo
cmVhZF9yd2xvY2tfdW5sb2NrKCYoX2JsMiktPmJ1Y2tldF9sb2NrKTsgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgX3JldDsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAot
fSkKLQotCi0KLQotc3RhdGljIHVpbnQzMl90IGhhc2hfdG9faWR4KHN0cnVjdCBfX2hhc2ggKmgs
IHVpbnQzMl90IGhhc2gpCi17Ci0gICAgcmV0dXJuIChoYXNoICUgaC0+dGFiX3NpemUpOwotfQot
Ci1zdGF0aWMgdm9pZCBhbGxvY190YWIoc3RydWN0IF9faGFzaCAqaCwKLSAgICAgICAgICAgICAg
ICAgICAgICBpbnQgc2l6ZSwKLSAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgYnVja2V0ICoq
YnVja2V0c190YWIsCi0gICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGJ1Y2tldF9sb2NrICoq
YnVja2V0X2xvY2tzX3RhYikKLXsKLSAgICBpbnQgaTsKLQotICAgIGFsbG9jX2J1Y2tldHMoaCwg
c2l6ZSwgYnVja2V0c190YWIsIGJ1Y2tldF9sb2Nrc190YWIpOwotICAgIGlmKCEoKmJ1Y2tldHNf
dGFiKSB8fCAhKCpidWNrZXRfbG9ja3NfdGFiKSkKLSAgICAgICAgZ290byBlcnJvcl9vdXQ7Ci0g
ICAgbWVtc2V0KCpidWNrZXRzX3RhYiwgMCwgc2l6ZSAqIHNpemVvZihzdHJ1Y3QgYnVja2V0KSk7
Ci0gICAgbWVtc2V0KCpidWNrZXRfbG9ja3NfdGFiLCAwLCBucl9sb2NrcyhzaXplKSAqIHNpemVv
ZihzdHJ1Y3QgYnVja2V0X2xvY2spKTsKLSAgICBmb3IoaT0wOyBpPG5yX2xvY2tzKHNpemUpOyBp
KyspCi0gICAgICAgIGlmKEJVQ0tFVF9MT0NLX0lOSVQoaCwgKmJ1Y2tldF9sb2Nrc190YWIgKyBp
KSAhPSAwKQotICAgICAgICAgICAgZ290byBlcnJvcl9vdXQ7Ci0KLSAgICByZXR1cm47Ci1lcnJv
cl9vdXQ6Ci0gICAgZnJlZV9idWNrZXRzKGgsICpidWNrZXRzX3RhYiwgKmJ1Y2tldF9sb2Nrc190
YWIpOwotICAgICpidWNrZXRzX3RhYiA9IE5VTEw7Ci0gICAgKmJ1Y2tldF9sb2Nrc190YWIgPSBO
VUxMOwotICAgIHJldHVybjsKLX0KLQotCi1zdHJ1Y3QgX19oYXNoICpfX2hhc2hfaW5pdChzdHJ1
Y3QgX19oYXNoICpoLCB1aW50MzJfdCBtaW5fc2l6ZSkKLXsKLSAgICB1aW50MzJfdCBzaXplOwot
ICAgIHVpbnQxNl90IHNpemVfaWR4OwotICAgIHN0cnVjdCBidWNrZXQgKmJ1Y2tldHM7Ci0gICAg
c3RydWN0IGJ1Y2tldF9sb2NrICpidWNrZXRfbG9ja3M7Ci0KLSAgICAvKiBTYW5pdHkgY2hlY2sg
b24gYXJncyAqLwotICAgIGlmIChtaW5fc2l6ZSA+IGhhc2hfc2l6ZXNbaGFzaF9zaXplc19sZW4t
MV0pIHJldHVybiBOVUxMOwotICAgIC8qIEZpbmQgbGVhc3Qgc2l6ZSBncmVhdGVyIHRoYW4gaW5p
dF9zaXplICovCi0gICAgZm9yKHNpemVfaWR4ID0gMDsgc2l6ZV9pZHggPCBoYXNoX3NpemVzX2xl
bjsgc2l6ZV9pZHgrKykKLSAgICAgICAgICAgIGlmKGhhc2hfc2l6ZXNbc2l6ZV9pZHhdID49IG1p
bl9zaXplKQotICAgICAgICAgICAgICAgIGJyZWFrOwotICAgIHNpemUgPSBoYXNoX3NpemVzW3Np
emVfaWR4XTsKLQotICAgIGlmKCFoKSByZXR1cm4gTlVMTDsKLSAgICBhbGxvY190YWIoaCwgc2l6
ZSwgJmJ1Y2tldHMsICZidWNrZXRfbG9ja3MpOwotICAgIGlmKCFidWNrZXRzIHx8ICFidWNrZXRf
bG9ja3MpIGdvdG8gYWxsb2NfZmFpbDsKLSAgICBoLT5rZXlfdGFiICAgICAgICAgPSBMMkMoaCwg
YnVja2V0cyk7Ci0gICAgaC0+a2V5X2xvY2tfdGFiICAgID0gTDJDKGgsIGJ1Y2tldF9sb2Nrcyk7
Ci0gICAgYWxsb2NfdGFiKGgsIHNpemUsICZidWNrZXRzLCAmYnVja2V0X2xvY2tzKTsKLSAgICBp
ZighYnVja2V0cyB8fCAhYnVja2V0X2xvY2tzKSBnb3RvIGFsbG9jX2ZhaWw7Ci0gICAgaC0+dmFs
dWVfdGFiICAgICAgID0gTDJDKGgsIGJ1Y2tldHMpOwotICAgIGgtPnZhbHVlX2xvY2tfdGFiICA9
IEwyQyhoLCBidWNrZXRfbG9ja3MpOwotICAgIC8qIEluaXQgYWxsIGggdmFyaWFibGVzICovCi0g
ICAgaWYoSEFTSF9MT0NLX0lOSVQoaCkgIT0gMCkgZ290byBhbGxvY19mYWlsOwotICAgIGgtPm5y
X2VudCA9IDA7Ci0gICAgaC0+dGFiX3NpemUgPSBzaXplOwotICAgIGgtPnNpemVfaWR4ID0gc2l6
ZV9pZHg7Ci0gICAgaC0+bWF4X2xvYWQgPSAodWludDMyX3QpY2VpbGYoaGFzaF9tYXhfbG9hZF9m
YWN0ICogc2l6ZSk7Ci0gICAgaC0+bWluX2xvYWQgPSAodWludDMyX3QpY2VpbGYoaGFzaF9taW5f
bG9hZF9mYWN0ICogc2l6ZSk7Ci0KLSAgICByZXR1cm4gaDsKLQotYWxsb2NfZmFpbDoKLSAgICBp
ZihoLT5rZXlfdGFiIHx8IGgtPmtleV9sb2NrX3RhYikKLSAgICAgICAgZnJlZV9idWNrZXRzKGgs
IEMyTChoLCBoLT5rZXlfdGFiKSwgQzJMKGgsIGgtPmtleV9sb2NrX3RhYikpOwotICAgIHJldHVy
biBOVUxMOwotfQotCi0jdW5kZWYgX19wcmltCi0jdW5kZWYgX19wcmltX3QKLSN1bmRlZiBfX3By
aW1fdGFiCi0jdW5kZWYgX19wcmltX2xvY2tfdGFiCi0jdW5kZWYgX19wcmltX2hhc2gKLSN1bmRl
ZiBfX3ByaW1fY21wCi0jdW5kZWYgX19wcmltX25leHQKLSN1bmRlZiBfX3NlYwotI3VuZGVmIF9f
c2VjX3QKLQotI2RlZmluZSBfX3ByaW0gICAgICAgICAgICAga2V5Ci0jZGVmaW5lIF9fcHJpbV90
ICAgICAgICAgX19rX3QKLSNkZWZpbmUgX19wcmltX3RhYiAgICAgICAgIGtleV90YWIKLSNkZWZp
bmUgX19wcmltX2xvY2tfdGFiICAgIGtleV9sb2NrX3RhYgotI2RlZmluZSBfX3ByaW1faGFzaCAg
ICAgIF9fa2V5X2hhc2gKLSNkZWZpbmUgX19wcmltX2NtcCAgICAgICBfX2tleV9jbXAKLSNkZWZp
bmUgX19wcmltX25leHQgICAgICAgIGtleV9uZXh0Ci0jZGVmaW5lIF9fc2VjICAgICAgICAgICAg
ICB2YWx1ZQotI2RlZmluZSBfX3NlY190ICAgICAgICAgIF9fdl90Ci1pbnQgX19rZXlfbG9va3Vw
KHN0cnVjdCBfX2hhc2ggKmgsIF9fcHJpbV90IGssIF9fc2VjX3QgKnZwKQotewotICAgIHN0cnVj
dCBoYXNoX2VudHJ5ICplbnRyeTsKLSAgICBzdHJ1Y3QgYnVja2V0ICpiOwotICAgIHN0cnVjdCBi
dWNrZXRfbG9jayAqYmx0OwotICAgIHVpbnQzMl90IGlkeDsKLQotICAgIGlmKEhBU0hfTE9DS19S
RExPQ0soaCkgIT0gMCkgcmV0dXJuIC1FTk9MQ0s7Ci0gICAgaWR4ID0gaGFzaF90b19pZHgoaCwg
X19wcmltX2hhc2goaykpOwotICAgIGIgPSBDMkwoaCwgJmgtPl9fcHJpbV90YWJbaWR4XSk7Ci0g
ICAgYmx0ID0gQzJMKGgsIGgtPl9fcHJpbV9sb2NrX3RhYik7Ci0gICAgaWYoQlVDS0VUX0xPQ0tf
UkRMT0NLKGgsIGJsdCwgaWR4KSAhPSAwKSByZXR1cm4gLUVOT0xDSzsKLSAgICBlbnRyeSA9IGIt
Pmhhc2hfZW50cnk7Ci0gICAgd2hpbGUoZW50cnkgIT0gTlVMTCkKLSAgICB7Ci0gICAgICAgIGVu
dHJ5ID0gQzJMKGgsIGVudHJ5KTsKLSAgICAgICAgaWYoX19wcmltX2NtcChrLCBlbnRyeS0+X19w
cmltKSkKLSAgICAgICAgewotICAgICAgICAgICAgLyogVW5sb2NrIGhlcmUgKi8KLSAgICAgICAg
ICAgICp2cCA9IGVudHJ5LT5fX3NlYzsKLSAgICAgICAgICAgIEJVQ0tFVF9MT0NLX1JEVU5MT0NL
KGgsIGJsdCwgaWR4KTsKLSAgICAgICAgICAgIEhBU0hfTE9DS19SRFVOTE9DSyhoKTsKLSAgICAg
ICAgICAgIHJldHVybiAxOwotICAgICAgICB9Ci0gICAgICAgIGVudHJ5ID0gZW50cnktPl9fcHJp
bV9uZXh0OwotICAgIH0KLSAgICBCVUNLRVRfTE9DS19SRFVOTE9DSyhoLCBibHQsIGlkeCk7Ci0g
ICAgSEFTSF9MT0NLX1JEVU5MT0NLKGgpOwotICAgIHJldHVybiAwOwotfQotCi0vKiB2YWx1ZSBs
b29rdXAgaXMgYW4gYWxtb3N0IGV4YWN0IGNvcHkgb2Yga2V5IGxvb2t1cCAqLwotI3VuZGVmIF9f
cHJpbQotI3VuZGVmIF9fcHJpbV90Ci0jdW5kZWYgX19wcmltX3RhYgotI3VuZGVmIF9fcHJpbV9s
b2NrX3RhYgotI3VuZGVmIF9fcHJpbV9oYXNoCi0jdW5kZWYgX19wcmltX2NtcAotI3VuZGVmIF9f
cHJpbV9uZXh0Ci0jdW5kZWYgX19zZWMKLSN1bmRlZiBfX3NlY190Ci0KLSNkZWZpbmUgX19wcmlt
ICAgICAgICAgICAgIHZhbHVlCi0jZGVmaW5lIF9fcHJpbV90ICAgICAgICAgX192X3QKLSNkZWZp
bmUgX19wcmltX3RhYiAgICAgICAgIHZhbHVlX3RhYgotI2RlZmluZSBfX3ByaW1fbG9ja190YWIg
ICAgdmFsdWVfbG9ja190YWIKLSNkZWZpbmUgX19wcmltX2hhc2ggICAgICBfX3ZhbHVlX2hhc2gK
LSNkZWZpbmUgX19wcmltX2NtcCAgICAgICBfX3ZhbHVlX2NtcAotI2RlZmluZSBfX3ByaW1fbmV4
dCAgICAgICAgdmFsdWVfbmV4dAotI2RlZmluZSBfX3NlYyAgICAgICAgICAgICAga2V5Ci0jZGVm
aW5lIF9fc2VjX3QgICAgICAgICAgX19rX3QKLWludCBfX3ZhbHVlX2xvb2t1cChzdHJ1Y3QgX19o
YXNoICpoLCBfX3ByaW1fdCBrLCBfX3NlY190ICp2cCkKLXsKLSAgICBzdHJ1Y3QgaGFzaF9lbnRy
eSAqZW50cnk7Ci0gICAgc3RydWN0IGJ1Y2tldCAqYjsKLSAgICBzdHJ1Y3QgYnVja2V0X2xvY2sg
KmJsdDsKLSAgICB1aW50MzJfdCBpZHg7Ci0KLSAgICBpZihIQVNIX0xPQ0tfUkRMT0NLKGgpICE9
IDApIHJldHVybiAtRU5PTENLOwotICAgIGlkeCA9IGhhc2hfdG9faWR4KGgsIF9fcHJpbV9oYXNo
KGspKTsKLSAgICBiID0gQzJMKGgsICZoLT5fX3ByaW1fdGFiW2lkeF0pOwotICAgIGJsdCA9IEMy
TChoLCBoLT5fX3ByaW1fbG9ja190YWIpOwotICAgIGlmKEJVQ0tFVF9MT0NLX1JETE9DSyhoLCBi
bHQsIGlkeCkgIT0gMCkgcmV0dXJuIC1FTk9MQ0s7Ci0gICAgZW50cnkgPSBiLT5oYXNoX2VudHJ5
OwotICAgIHdoaWxlKGVudHJ5ICE9IE5VTEwpCi0gICAgewotICAgICAgICBlbnRyeSA9IEMyTCho
LCBlbnRyeSk7Ci0gICAgICAgIGlmKF9fcHJpbV9jbXAoaywgZW50cnktPl9fcHJpbSkpCi0gICAg
ICAgIHsKLSAgICAgICAgICAgIC8qIFVubG9jayBoZXJlICovCi0gICAgICAgICAgICAqdnAgPSBl
bnRyeS0+X19zZWM7Ci0gICAgICAgICAgICBCVUNLRVRfTE9DS19SRFVOTE9DSyhoLCBibHQsIGlk
eCk7Ci0gICAgICAgICAgICBIQVNIX0xPQ0tfUkRVTkxPQ0soaCk7Ci0gICAgICAgICAgICByZXR1
cm4gMTsKLSAgICAgICAgfQotICAgICAgICBlbnRyeSA9IGVudHJ5LT5fX3ByaW1fbmV4dDsKLSAg
ICB9Ci0gICAgQlVDS0VUX0xPQ0tfUkRVTkxPQ0soaCwgYmx0LCBpZHgpOwotICAgIEhBU0hfTE9D
S19SRFVOTE9DSyhoKTsKLSAgICByZXR1cm4gMDsKLX0KLQotaW50IF9faW5zZXJ0KHN0cnVjdCBf
X2hhc2ggKmgsIF9fa190IGssIF9fdl90IHYpCi17Ci0gICAgdWludDMyX3Qga19pZHgsIHZfaWR4
OwotICAgIHN0cnVjdCBoYXNoX2VudHJ5ICplbnRyeTsKLSAgICBzdHJ1Y3QgYnVja2V0ICpiaywg
KmJ2OwotICAgIHN0cnVjdCBidWNrZXRfbG9jayAqYmx0aywgKmJsdHY7Ci0KLSAgICAvKiBBbGxv
Y2F0ZSBuZXcgZW50cnkgYmVmb3JlIGFueSBsb2NrcyAoaW4gY2FzZSBpdCBmYWlscykgKi8KLSAg
ICBlbnRyeSA9IChzdHJ1Y3QgaGFzaF9lbnRyeSopCi0gICAgICAgICAgICAgICAgICAgIGFsbG9j
X2VudHJ5KGgsIHNpemVvZihzdHJ1Y3QgaGFzaF9lbnRyeSkpOwotICAgIGlmKCFlbnRyeSkgcmV0
dXJuIDA7Ci0KLSAgICBpZihIQVNIX0xPQ0tfUkRMT0NLKGgpICE9IDApIHJldHVybiAtRU5PTENL
OwotICAgIC8qIFJlYWQgZnJvbSBucl9lbnQgaXMgYXRvbWljKFRPRE8gY2hlY2spLCBubyBuZWVk
IGZvciBmYW5jeSBhY2Nlc3NvcnMgKi8KLSAgICBpZihoLT5ucl9lbnQrMSA+IGgtPm1heF9sb2Fk
KQotICAgIHsKLSAgICAgICAgLyogUmVzaXplIG5lZWRzIHRoZSB3cml0ZSBsb2NrLCBkcm9wIHJl
YWQgbG9jayB0ZW1wb3JhcmlseSAqLwotICAgICAgICBIQVNIX0xPQ0tfUkRVTkxPQ0soaCk7Ci0g
ICAgICAgIGhhc2hfcmVzaXplKGgpOwotICAgICAgICBpZihIQVNIX0xPQ0tfUkRMT0NLKGgpICE9
IDApIHJldHVybiAtRU5PTENLOwotICAgIH0KLQotICAgIC8qIEluaXQgdGhlIGVudHJ5ICovCi0g
ICAgZW50cnktPmtleSA9IGs7Ci0gICAgZW50cnktPnZhbHVlID0gdjsKLQotICAgIC8qIFdvcmsg
b3V0IHRoZSBpbmRpY2llcyAqLwotICAgIGtfaWR4ID0gaGFzaF90b19pZHgoaCwgX19rZXlfaGFz
aChrKSk7Ci0gICAgdl9pZHggPSBoYXNoX3RvX2lkeChoLCBfX3ZhbHVlX2hhc2godikpOwotCi0g
ICAgLyogSW5zZXJ0ICovCi0gICAgYmsgICA9IEMyTChoLCAmaC0+a2V5X3RhYltrX2lkeF0pOwot
ICAgIGJ2ICAgPSBDMkwoaCwgJmgtPnZhbHVlX3RhYlt2X2lkeF0pOwotICAgIGJsdGsgPSBDMkwo
aCwgaC0+a2V5X2xvY2tfdGFiKTsKLSAgICBibHR2ID0gQzJMKGgsIGgtPnZhbHVlX2xvY2tfdGFi
KTsKLSAgICBpZihUV09fQlVDS0VUU19MT0NLX1dSTE9DSyhoLCBibHRrLCBrX2lkeCwgYmx0diwg
dl9pZHgpICE9IDApCi0gICAgICAgIHJldHVybiAtRU5PTENLOwotICAgIGVudHJ5LT5rZXlfbmV4
dCA9IGJrLT5oYXNoX2VudHJ5OwotICAgIGJrLT5oYXNoX2VudHJ5ID0gTDJDKGgsIGVudHJ5KTsK
LSAgICBlbnRyeS0+dmFsdWVfbmV4dCA9IGJ2LT5oYXNoX2VudHJ5OwotICAgIGJ2LT5oYXNoX2Vu
dHJ5ID0gTDJDKGgsIGVudHJ5KTsKLSAgICBUV09fQlVDS0VUU19MT0NLX1dSVU5MT0NLKGgsIGJs
dGssIGtfaWR4LCBibHR2LCB2X2lkeCk7Ci0KLSAgICAvKiBCb29rIGtlZXBpbmcgKi8KLSAgICBh
dG9taWNfaW5jKCZoLT5ucl9lbnQpOwotCi0gICAgSEFTSF9MT0NLX1JEVU5MT0NLKGgpOwotCi0g
ICAgcmV0dXJuIDE7Ci19Ci0KLQotI3VuZGVmIF9fcHJpbQotI3VuZGVmIF9fcHJpbV90Ci0jdW5k
ZWYgX19wcmltX3RhYgotI3VuZGVmIF9fcHJpbV9sb2NrX3RhYgotI3VuZGVmIF9fcHJpbV9oYXNo
Ci0jdW5kZWYgX19wcmltX2NtcAotI3VuZGVmIF9fcHJpbV9uZXh0Ci0jdW5kZWYgX19zZWMKLSN1
bmRlZiBfX3NlY190Ci0jdW5kZWYgX19zZWNfdGFiCi0jdW5kZWYgX19zZWNfbG9ja190YWIKLSN1
bmRlZiBfX3NlY19oYXNoCi0jdW5kZWYgX19zZWNfbmV4dAotCi0jZGVmaW5lIF9fcHJpbSAgICAg
ICAgICAgICBrZXkKLSNkZWZpbmUgX19wcmltX3QgICAgICAgICBfX2tfdAotI2RlZmluZSBfX3By
aW1fdGFiICAgICAgICAga2V5X3RhYgotI2RlZmluZSBfX3ByaW1fbG9ja190YWIgICAga2V5X2xv
Y2tfdGFiCi0jZGVmaW5lIF9fcHJpbV9oYXNoICAgICAgX19rZXlfaGFzaAotI2RlZmluZSBfX3By
aW1fY21wICAgICAgIF9fa2V5X2NtcAotI2RlZmluZSBfX3ByaW1fbmV4dCAgICAgICAga2V5X25l
eHQKLSNkZWZpbmUgX19zZWMgICAgICAgICAgICAgIHZhbHVlCi0jZGVmaW5lIF9fc2VjX3QgICAg
ICAgICAgX192X3QKLSNkZWZpbmUgX19zZWNfdGFiICAgICAgICAgIHZhbHVlX3RhYgotI2RlZmlu
ZSBfX3NlY19sb2NrX3RhYiAgICAgdmFsdWVfbG9ja190YWIKLSNkZWZpbmUgX19zZWNfaGFzaCAg
ICAgICBfX3ZhbHVlX2hhc2gKLSNkZWZpbmUgX19zZWNfbmV4dCAgICAgICAgIHZhbHVlX25leHQK
LQotaW50IF9fa2V5X3JlbW92ZShzdHJ1Y3QgX19oYXNoICpoLCBfX3ByaW1fdCBrLCBfX3NlY190
ICp2cCkKLXsKLSAgICBzdHJ1Y3QgaGFzaF9lbnRyeSAqZSwgKmVzLCAqKnBlaywgKipwZXY7Ci0g
ICAgc3RydWN0IGJ1Y2tldCAqYmssICpidjsKLSAgICBzdHJ1Y3QgYnVja2V0X2xvY2sgKmJsdGss
ICpibHR2OwotICAgIHVpbnQzMl90IG9sZF9raWR4LCBraWR4LCB2aWR4LCBtaW5fbG9hZCwgbnJf
ZW50OwotICAgIF9fcHJpbV90IGtzOwotICAgIF9fc2VjX3QgdnM7Ci0KLSAgICBpZihIQVNIX0xP
Q0tfUkRMT0NLKGgpICE9IDApIHJldHVybiAtRU5PTENLOwotCi1hZ2FpbjoKLSAgICBvbGRfa2lk
eCA9IGtpZHggPSBoYXNoX3RvX2lkeChoLCBfX3ByaW1faGFzaChrKSk7Ci0gICAgYmsgPSBDMkwo
aCwgJmgtPl9fcHJpbV90YWJba2lkeF0pOwotICAgIGJsdGsgPSBDMkwoaCwgaC0+X19wcmltX2xv
Y2tfdGFiKTsKLSAgICBpZihCVUNLRVRfTE9DS19SRExPQ0soaCwgYmx0aywga2lkeCkgIT0gMCkg
cmV0dXJuIC1FTk9MQ0s7Ci0gICAgcGVrID0gJihiay0+aGFzaF9lbnRyeSk7Ci0gICAgZSA9ICpw
ZWs7Ci0gICAgd2hpbGUoZSAhPSBOVUxMKQotICAgIHsKLSAgICAgICAgZSA9IEMyTChoLCBlKTsK
LSAgICAgICAgaWYoX19wcmltX2NtcChrLCBlLT5fX3ByaW0pKQotICAgICAgICB7Ci0gICAgICAg
ICAgICBnb3RvIGZvdW5kOwotICAgICAgICB9Ci0gICAgICAgIHBlayA9ICYoZS0+X19wcmltX25l
eHQpOwotICAgICAgICBlID0gKnBlazsKLSAgICB9Ci0KLSAgICBCVUNLRVRfTE9DS19SRFVOTE9D
SyhoLCBibHRrLCBraWR4KTsKLSAgICBIQVNIX0xPQ0tfUkRVTkxPQ0soaCk7Ci0KLSAgICByZXR1
cm4gMDsKLQotZm91bmQ6Ci0gICAgLyoKLSAgICAgKiBNYWtlIGxvY2FsIGNvcHkgb2Yga2V5IGFu
ZCB2YWx1ZS4KLSAgICAgKi8KLSAgICBlcyA9IGU7Ci0gICAga3MgPSBlLT5fX3ByaW07Ci0gICAg
dnMgPSBlLT5fX3NlYzsKLSAgICBraWR4ID0gaGFzaF90b19pZHgoaCwgX19wcmltX2hhc2goa3Mp
KTsKLSAgICAvKiBCZWluZyBwYXJhbm9pZDogY2hlY2sgaWYga2lkeCBoYXMgbm90IGNoYW5nZWQs
IHNvIHRoYXQgd2UgdW5sb2NrIHRoZQotICAgICAqIHJpZ2h0IGJ1Y2tldCAqLwotICAgIGFzc2Vy
dChvbGRfa2lkeCA9PSBraWR4KTsKLSAgICB2aWR4ID0gaGFzaF90b19pZHgoaCwgX19zZWNfaGFz
aCh2cykpOwotICAgIGJrICAgPSBDMkwoaCwgJmgtPl9fcHJpbV90YWJba2lkeF0pOwotICAgIGJ2
ICAgPSBDMkwoaCwgJmgtPl9fc2VjX3RhYlt2aWR4XSk7Ci0gICAgYmx0ayA9IEMyTChoLCBoLT5f
X3ByaW1fbG9ja190YWIpOwotICAgIGJsdHYgPSBDMkwoaCwgaC0+X19zZWNfbG9ja190YWIpOwot
ICAgIEJVQ0tFVF9MT0NLX1JEVU5MT0NLKGgsIGJsdGssIGtpZHgpOwotICAgIGlmKFRXT19CVUNL
RVRTX0xPQ0tfV1JMT0NLKGgsIGJsdGssIGtpZHgsIGJsdHYsIHZpZHgpICE9IDApIHJldHVybiAt
RU5PTENLOwotICAgIHBlayA9ICYoYmstPmhhc2hfZW50cnkpOwotICAgIHBldiA9ICYoYnYtPmhh
c2hfZW50cnkpOwotCi0gICAgLyogRmluZCB0aGUgZW50cnkgaW4gYm90aCB0YWJsZXMgKi8KLSAg
ICBlID0gKnBlazsKLSAgICB3aGlsZShlICE9IE5VTEwpCi0gICAgewotICAgICAgICBlID0gQzJM
KGgsIGUpOwotICAgICAgICBpZihlID09IGVzKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBC
ZWluZyBwYXJhbm9pZDogbWFrZSBzdXJlIHRoYXQgdGhlIGtleSBhbmQgdmFsdWUgYXJlCi0gICAg
ICAgICAgICAgKiBzdGlsbCB0aGUgc2FtZS4gVGhpcyBpcyBzdGlsbCBub3QgMTAwJSwgYmVjYXVz
ZSwgaW4KLSAgICAgICAgICAgICAqIHByaW5jaXBsZSwgdGhlIGVudHJ5IGNvdWxkIGhhdmUgZ290
IGRlbGV0ZWQsIHdoZW4gd2UKLSAgICAgICAgICAgICAqIGRpZG4ndCBob2xkIHRoZSBsb2NrcyBm
b3IgYSBsaXR0bGUgd2hpbGUsIGFuZCBleGFjdGx5Ci0gICAgICAgICAgICAgKiB0aGUgc2FtZSBl
bnRyeSByZWluc2VydGVkLiBJZiB0aGUgX19rX3QgJiBfX3ZfdCBhcmUKLSAgICAgICAgICAgICAq
IHNpbXBsZSB0eXBlcyB0aGFuIGl0IHByb2JhYmx5IGRvZXNuJ3QgbWF0dGVyLCBidXQgaWYKLSAg
ICAgICAgICAgICAqIGVpdGhlciBpcyBhIHBvaW50ZXIgdHlwZSwgdGhlIGFjdHVhbCBzdHJ1Y3R1
cmUgbWlnaHQKLSAgICAgICAgICAgICAqIG5vdyBiZSBkaWZmZXJlbnQuIFRoZSBjaGFuY2VzIHRo
YXQgaGFwcGVucyBhcmUgdmVyeQotICAgICAgICAgICAgICogc2xpbSwgYnV0IHN0aWxsLCBpZiB0
aGF0J3MgYSBwcm9ibGVtLCB0aGUgdXNlciBuZWVkcyB0bwotICAgICAgICAgICAgICogcGF5IGF0
dGVudGlvbiB0byB0aGUgc3RydWN0dXJlIHJlLWFsbG9jYXRpb24gKi8KLSAgICAgICAgICAgIGlm
KChtZW1jbXAoJihlLT5fX3ByaW0pLCAma3MsIHNpemVvZihfX3ByaW1fdCkpKSB8fAotICAgICAg
ICAgICAgICAgKG1lbWNtcCgmKGUtPl9fc2VjKSwgJnZzLCBzaXplb2YoX19zZWNfdCkpKSkKLSAg
ICAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgICAgIGdvdG8gZm91bmRfYWdhaW47Ci0gICAg
ICAgIH0KLSAgICAgICAgcGVrID0gJihlLT5fX3ByaW1fbmV4dCk7Ci0gICAgICAgIGUgPSAqcGVr
OwotICAgIH0KLQotICAgIFRXT19CVUNLRVRTX0xPQ0tfV1JVTkxPQ0soaCwgYmx0aywga2lkeCwg
Ymx0diwgdmlkeCk7Ci0KLSAgICAvKiBFbnRyeSBnb3QgcmVtb3ZlZCBpbiB0aGUgbWVhbnRpbWUs
IHRyeSBhZ2FpbiAqLwotICAgIGdvdG8gYWdhaW47Ci0KLWZvdW5kX2FnYWluOgotICAgIC8qIFdl
IGFyZSBub3cgY29taXR0ZWQgdG8gdGhlIHJlbW92YWwgKi8KLSAgICBlID0gKnBldjsKLSAgICB3
aGlsZShlICE9IE5VTEwpCi0gICAgewotICAgICAgICBlID0gQzJMKGgsIGUpOwotICAgICAgICBp
ZihlID09IGVzKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBCb3RoIHBlayBhbmQgcGV2IGFy
ZSBwb2ludGluZyB0byB0aGUgcmlnaHQgcGxhY2UsIHJlbW92ZSAqLwotICAgICAgICAgICAgKnBl
ayA9IGUtPl9fcHJpbV9uZXh0OwotICAgICAgICAgICAgKnBldiA9IGUtPl9fc2VjX25leHQ7Ci0K
LSAgICAgICAgICAgIGF0b21pY19kZWMoJmgtPm5yX2VudCk7Ci0gICAgICAgICAgICBucl9lbnQg
PSBoLT5ucl9lbnQ7Ci0gICAgICAgICAgICAvKiByZWFkIG1pbl9sb2FkIHN0aWxsIHVuZGVyIHRo
ZSBoYXNoIGxvY2shICovCi0gICAgICAgICAgICBtaW5fbG9hZCA9IGgtPm1pbl9sb2FkOwotCi0g
ICAgICAgICAgICBUV09fQlVDS0VUU19MT0NLX1dSVU5MT0NLKGgsIGJsdGssIGtpZHgsIGJsdHYs
IHZpZHgpOwotICAgICAgICAgICAgSEFTSF9MT0NLX1JEVU5MT0NLKGgpOwotCi0gICAgICAgICAg
ICBpZihucl9lbnQgPCBtaW5fbG9hZCkKLSAgICAgICAgICAgICAgICBoYXNoX3Jlc2l6ZShoKTsK
LSAgICAgICAgICAgIGlmKHZwICE9IE5VTEwpCi0gICAgICAgICAgICAgICAgKnZwID0gZS0+X19z
ZWM7Ci0gICAgICAgICAgICBmcmVlX2VudHJ5KGgsIGUpOwotICAgICAgICAgICAgcmV0dXJuIDE7
Ci0gICAgICAgIH0KLSAgICAgICAgcGV2ID0gJihlLT5fX3NlY19uZXh0KTsKLSAgICAgICAgZSA9
ICpwZXY7Ci0gICAgfQotCi0gICAgLyogV2Ugc2hvdWxkIG5ldmVyIGdldCBoZXJlISwgbm8gbmVl
ZCB0byB1bmxvY2sgYW55dGhpbmcgKi8KLSAgICByZXR1cm4gLUVOT0xDSzsKLX0KLQotI3VuZGVm
IF9fcHJpbQotI3VuZGVmIF9fcHJpbV90Ci0jdW5kZWYgX19wcmltX3RhYgotI3VuZGVmIF9fcHJp
bV9sb2NrX3RhYgotI3VuZGVmIF9fcHJpbV9oYXNoCi0jdW5kZWYgX19wcmltX2NtcAotI3VuZGVm
IF9fcHJpbV9uZXh0Ci0jdW5kZWYgX19zZWMKLSN1bmRlZiBfX3NlY190Ci0jdW5kZWYgX19zZWNf
dGFiCi0jdW5kZWYgX19zZWNfbG9ja190YWIKLSN1bmRlZiBfX3NlY19oYXNoCi0jdW5kZWYgX19z
ZWNfbmV4dAotCi0jZGVmaW5lIF9fcHJpbSAgICAgICAgICAgICB2YWx1ZQotI2RlZmluZSBfX3By
aW1fdCAgICAgICAgIF9fdl90Ci0jZGVmaW5lIF9fcHJpbV90YWIgICAgICAgICB2YWx1ZV90YWIK
LSNkZWZpbmUgX19wcmltX2xvY2tfdGFiICAgIHZhbHVlX2xvY2tfdGFiCi0jZGVmaW5lIF9fcHJp
bV9oYXNoICAgICAgX192YWx1ZV9oYXNoCi0jZGVmaW5lIF9fcHJpbV9jbXAgICAgICAgX192YWx1
ZV9jbXAKLSNkZWZpbmUgX19wcmltX25leHQgICAgICAgIHZhbHVlX25leHQKLSNkZWZpbmUgX19z
ZWMgICAgICAgICAgICAgIGtleQotI2RlZmluZSBfX3NlY190ICAgICAgICAgIF9fa190Ci0jZGVm
aW5lIF9fc2VjX3RhYiAgICAgICAgICBrZXlfdGFiCi0jZGVmaW5lIF9fc2VjX2xvY2tfdGFiICAg
ICBrZXlfbG9ja190YWIKLSNkZWZpbmUgX19zZWNfaGFzaCAgICAgICBfX2tleV9oYXNoCi0jZGVm
aW5lIF9fc2VjX25leHQgICAgICAgICBrZXlfbmV4dAotCi1pbnQgX192YWx1ZV9yZW1vdmUoc3Ry
dWN0IF9faGFzaCAqaCwgX19wcmltX3QgaywgX19zZWNfdCAqdnApCi17Ci0gICAgc3RydWN0IGhh
c2hfZW50cnkgKmUsICplcywgKipwZWssICoqcGV2OwotICAgIHN0cnVjdCBidWNrZXQgKmJrLCAq
YnY7Ci0gICAgc3RydWN0IGJ1Y2tldF9sb2NrICpibHRrLCAqYmx0djsKLSAgICB1aW50MzJfdCBv
bGRfa2lkeCwga2lkeCwgdmlkeCwgbWluX2xvYWQsIG5yX2VudDsKLSAgICBfX3ByaW1fdCBrczsK
LSAgICBfX3NlY190IHZzOwotCi0gICAgaWYoSEFTSF9MT0NLX1JETE9DSyhoKSAhPSAwKSByZXR1
cm4gLUVOT0xDSzsKLQotYWdhaW46Ci0gICAgb2xkX2tpZHggPSBraWR4ID0gaGFzaF90b19pZHgo
aCwgX19wcmltX2hhc2goaykpOwotICAgIGJrID0gQzJMKGgsICZoLT5fX3ByaW1fdGFiW2tpZHhd
KTsKLSAgICBibHRrID0gQzJMKGgsIGgtPl9fcHJpbV9sb2NrX3RhYik7Ci0gICAgaWYoQlVDS0VU
X0xPQ0tfUkRMT0NLKGgsIGJsdGssIGtpZHgpICE9IDApIHJldHVybiAtRU5PTENLOwotICAgIHBl
ayA9ICYoYmstPmhhc2hfZW50cnkpOwotICAgIGUgPSAqcGVrOwotICAgIHdoaWxlKGUgIT0gTlVM
TCkKLSAgICB7Ci0gICAgICAgIGUgPSBDMkwoaCwgZSk7Ci0gICAgICAgIGlmKF9fcHJpbV9jbXAo
aywgZS0+X19wcmltKSkKLSAgICAgICAgewotICAgICAgICAgICAgZ290byBmb3VuZDsKLSAgICAg
ICAgfQotICAgICAgICBwZWsgPSAmKGUtPl9fcHJpbV9uZXh0KTsKLSAgICAgICAgZSA9ICpwZWs7
Ci0gICAgfQotCi0gICAgQlVDS0VUX0xPQ0tfUkRVTkxPQ0soaCwgYmx0aywga2lkeCk7Ci0gICAg
SEFTSF9MT0NLX1JEVU5MT0NLKGgpOwotCi0gICAgcmV0dXJuIDA7Ci0KLWZvdW5kOgotICAgIC8q
Ci0gICAgICogTWFrZSBsb2NhbCBjb3B5IG9mIGtleSBhbmQgdmFsdWUuCi0gICAgICovCi0gICAg
ZXMgPSBlOwotICAgIGtzID0gZS0+X19wcmltOwotICAgIHZzID0gZS0+X19zZWM7Ci0gICAga2lk
eCA9IGhhc2hfdG9faWR4KGgsIF9fcHJpbV9oYXNoKGtzKSk7Ci0gICAgLyogQmVpbmcgcGFyYW5v
aWQ6IGNoZWNrIGlmIGtpZHggaGFzIG5vdCBjaGFuZ2VkLCBzbyB0aGF0IHdlIHVubG9jayB0aGUK
LSAgICAgKiByaWdodCBidWNrZXQgKi8KLSAgICBhc3NlcnQob2xkX2tpZHggPT0ga2lkeCk7Ci0g
ICAgdmlkeCA9IGhhc2hfdG9faWR4KGgsIF9fc2VjX2hhc2godnMpKTsKLSAgICBiayAgID0gQzJM
KGgsICZoLT5fX3ByaW1fdGFiW2tpZHhdKTsKLSAgICBidiAgID0gQzJMKGgsICZoLT5fX3NlY190
YWJbdmlkeF0pOwotICAgIGJsdGsgPSBDMkwoaCwgaC0+X19wcmltX2xvY2tfdGFiKTsKLSAgICBi
bHR2ID0gQzJMKGgsIGgtPl9fc2VjX2xvY2tfdGFiKTsKLSAgICBCVUNLRVRfTE9DS19SRFVOTE9D
SyhoLCBibHRrLCBraWR4KTsKLSAgICBpZihUV09fQlVDS0VUU19MT0NLX1dSTE9DSyhoLCBibHRr
LCBraWR4LCBibHR2LCB2aWR4KSAhPSAwKSByZXR1cm4gLUVOT0xDSzsKLSAgICBwZWsgPSAmKGJr
LT5oYXNoX2VudHJ5KTsKLSAgICBwZXYgPSAmKGJ2LT5oYXNoX2VudHJ5KTsKLQotICAgIC8qIEZp
bmQgdGhlIGVudHJ5IGluIGJvdGggdGFibGVzICovCi0gICAgZSA9ICpwZWs7Ci0gICAgd2hpbGUo
ZSAhPSBOVUxMKQotICAgIHsKLSAgICAgICAgZSA9IEMyTChoLCBlKTsKLSAgICAgICAgaWYoZSA9
PSBlcykKLSAgICAgICAgewotICAgICAgICAgICAgLyogQmVpbmcgcGFyYW5vaWQ6IG1ha2Ugc3Vy
ZSB0aGF0IHRoZSBrZXkgYW5kIHZhbHVlIGFyZQotICAgICAgICAgICAgICogc3RpbGwgdGhlIHNh
bWUuIFRoaXMgaXMgc3RpbGwgbm90IDEwMCUsIGJlY2F1c2UsIGluCi0gICAgICAgICAgICAgKiBw
cmluY2lwbGUsIHRoZSBlbnRyeSBjb3VsZCBoYXZlIGdvdCBkZWxldGVkLCB3aGVuIHdlCi0gICAg
ICAgICAgICAgKiBkaWRuJ3QgaG9sZCB0aGUgbG9ja3MgZm9yIGEgbGl0dGxlIHdoaWxlLCBhbmQg
ZXhhY3RseQotICAgICAgICAgICAgICogdGhlIHNhbWUgZW50cnkgcmVpbnNlcnRlZC4gSWYgdGhl
IF9fa190ICYgX192X3QgYXJlCi0gICAgICAgICAgICAgKiBzaW1wbGUgdHlwZXMgdGhhbiBpdCBw
cm9iYWJseSBkb2Vzbid0IG1hdHRlciwgYnV0IGlmCi0gICAgICAgICAgICAgKiBlaXRoZXIgaXMg
YSBwb2ludGVyIHR5cGUsIHRoZSBhY3R1YWwgc3RydWN0dXJlIG1pZ2h0Ci0gICAgICAgICAgICAg
KiBub3cgYmUgZGlmZmVyZW50LiBUaGUgY2hhbmNlcyB0aGF0IGhhcHBlbnMgYXJlIHZlcnkKLSAg
ICAgICAgICAgICAqIHNsaW0sIGJ1dCBzdGlsbCwgaWYgdGhhdCdzIGEgcHJvYmxlbSwgdGhlIHVz
ZXIgbmVlZHMgdG8KLSAgICAgICAgICAgICAqIHBheSBhdHRlbnRpb24gdG8gdGhlIHN0cnVjdHVy
ZSByZS1hbGxvY2F0aW9uICovCi0gICAgICAgICAgICBpZigobWVtY21wKCYoZS0+X19wcmltKSwg
JmtzLCBzaXplb2YoX19wcmltX3QpKSkgfHwKLSAgICAgICAgICAgICAgIChtZW1jbXAoJihlLT5f
X3NlYyksICZ2cywgc2l6ZW9mKF9fc2VjX3QpKSkpCi0gICAgICAgICAgICAgICAgYnJlYWs7Ci0g
ICAgICAgICAgICBnb3RvIGZvdW5kX2FnYWluOwotICAgICAgICB9Ci0gICAgICAgIHBlayA9ICYo
ZS0+X19wcmltX25leHQpOwotICAgICAgICBlID0gKnBlazsKLSAgICB9Ci0KLSAgICBUV09fQlVD
S0VUU19MT0NLX1dSVU5MT0NLKGgsIGJsdGssIGtpZHgsIGJsdHYsIHZpZHgpOwotCi0gICAgLyog
RW50cnkgZ290IHJlbW92ZWQgaW4gdGhlIG1lYW50aW1lLCB0cnkgYWdhaW4gKi8KLSAgICBnb3Rv
IGFnYWluOwotCi1mb3VuZF9hZ2FpbjoKLSAgICAvKiBXZSBhcmUgbm93IGNvbWl0dGVkIHRvIHRo
ZSByZW1vdmFsICovCi0gICAgZSA9ICpwZXY7Ci0gICAgd2hpbGUoZSAhPSBOVUxMKQotICAgIHsK
LSAgICAgICAgZSA9IEMyTChoLCBlKTsKLSAgICAgICAgaWYoZSA9PSBlcykKLSAgICAgICAgewot
ICAgICAgICAgICAgLyogQm90aCBwZWsgYW5kIHBldiBhcmUgcG9pbnRpbmcgdG8gdGhlIHJpZ2h0
IHBsYWNlLCByZW1vdmUgKi8KLSAgICAgICAgICAgICpwZWsgPSBlLT5fX3ByaW1fbmV4dDsKLSAg
ICAgICAgICAgICpwZXYgPSBlLT5fX3NlY19uZXh0OwotCi0gICAgICAgICAgICBhdG9taWNfZGVj
KCZoLT5ucl9lbnQpOwotICAgICAgICAgICAgbnJfZW50ID0gaC0+bnJfZW50OwotICAgICAgICAg
ICAgLyogcmVhZCBtaW5fbG9hZCBzdGlsbCB1bmRlciB0aGUgaGFzaCBsb2NrISAqLwotICAgICAg
ICAgICAgbWluX2xvYWQgPSBoLT5taW5fbG9hZDsKLQotICAgICAgICAgICAgVFdPX0JVQ0tFVFNf
TE9DS19XUlVOTE9DSyhoLCBibHRrLCBraWR4LCBibHR2LCB2aWR4KTsKLSAgICAgICAgICAgIEhB
U0hfTE9DS19SRFVOTE9DSyhoKTsKLQotICAgICAgICAgICAgaWYobnJfZW50IDwgbWluX2xvYWQp
Ci0gICAgICAgICAgICAgICAgaGFzaF9yZXNpemUoaCk7Ci0gICAgICAgICAgICBpZih2cCAhPSBO
VUxMKQotICAgICAgICAgICAgICAgICp2cCA9IGUtPl9fc2VjOwotICAgICAgICAgICAgZnJlZV9l
bnRyeShoLCBlKTsKLSAgICAgICAgICAgIHJldHVybiAxOwotICAgICAgICB9Ci0gICAgICAgIHBl
diA9ICYoZS0+X19zZWNfbmV4dCk7Ci0gICAgICAgIGUgPSAqcGV2OwotICAgIH0KLQotICAgIC8q
IFdlIHNob3VsZCBuZXZlciBnZXQgaGVyZSEsIG5vIG5lZWQgdG8gdW5sb2NrIGFueXRoaW5nICov
Ci0gICAgcmV0dXJuIC1FTk9MQ0s7Ci19Ci0KLQotaW50IF9faGFzaF9kZXN0cm95KHN0cnVjdCBf
X2hhc2ggKmgsCi0gICAgICAgICAgICAgICAgICAgdm9pZCAoKmVudHJ5X2NvbnN1bWVyKShfX2tf
dCBrLCBfX3ZfdCB2LCB2b2lkICpwKSwKLSAgICAgICAgICAgICAgICAgICB2b2lkICpkKQotewot
ICAgIHN0cnVjdCBoYXNoX2VudHJ5ICplLCAqbjsKLSAgICBzdHJ1Y3QgYnVja2V0ICpiOwotICAg
IGludCBpOwotCi0gICAgaWYoSEFTSF9MT0NLX1dSTE9DSyhoKSAhPSAwKSByZXR1cm4gLUVOT0xD
SzsKLQotICAgIC8qIE5vIG5lZWQgdG8gbG9jayBpbmRpdmlkdWFsIGJ1Y2tldHMsIHdpdGggaGFz
aCB3cml0ZSBsb2NrICAqLwotICAgIGZvcihpPTA7IGkgPCBoLT50YWJfc2l6ZTsgaSsrKQotICAg
IHsKLSAgICAgICAgYiA9IEMyTChoLCAmaC0+a2V5X3RhYltpXSk7Ci0gICAgICAgIGUgPSBiLT5o
YXNoX2VudHJ5OwotICAgICAgICB3aGlsZShlICE9IE5VTEwpCi0gICAgICAgIHsKLSAgICAgICAg
ICAgIGUgPSBDMkwoaCwgZSk7Ci0gICAgICAgICAgICBuID0gZS0+a2V5X25leHQ7Ci0gICAgICAg
ICAgICBpZihlbnRyeV9jb25zdW1lcikKLSAgICAgICAgICAgICAgICBlbnRyeV9jb25zdW1lcihl
LT5rZXksIGUtPnZhbHVlLCBkKTsKLSAgICAgICAgICAgIGZyZWVfZW50cnkoaCwgZSk7Ci0gICAg
ICAgICAgICBlID0gbjsKLSAgICAgICAgfQotICAgIH0KLSAgICBmcmVlX2J1Y2tldHMoaCwgQzJM
KGgsIGgtPmtleV90YWIpLCBDMkwoaCwgaC0+a2V5X2xvY2tfdGFiKSk7Ci0gICAgZnJlZV9idWNr
ZXRzKGgsIEMyTChoLCBoLT52YWx1ZV90YWIpLCBDMkwoaCwgaC0+dmFsdWVfbG9ja190YWIpKTsK
LQotICAgIEhBU0hfTE9DS19XUlVOTE9DSyhoKTsKLSAgICBoLT5sb2NrX2FsaXZlID0gMDsKLQot
ICAgIHJldHVybiAwOwotfQotCi1zdGF0aWMgdm9pZCBoYXNoX3Jlc2l6ZShzdHJ1Y3QgX19oYXNo
ICpoKQotewotICAgIGludCBuZXdfc2l6ZV9pZHgsIGksIGxvY2tfcmV0OwotICAgIHVpbnQzMl90
IHNpemUsIG9sZF9zaXplLCBraWR4LCB2aWR4OwotICAgIHN0cnVjdCBidWNrZXQgKnQxLCAqdDIs
ICpiOwotICAgIHN0cnVjdCBidWNrZXRfbG9jayAqbDEsICpsMjsKLSAgICBzdHJ1Y3QgaGFzaF9l
bnRyeSAqZSwgKm47Ci0KLSAgICAvKiBXZSBtYXkgZmFpbCB0byBhbGxvY2F0ZSB0aGUgbG9jaywg
aWYgdGhlIHJlc2l6ZSBpcyB0cmlnZ2VyZWQgd2hpbGUKLSAgICAgICB3ZSBhcmUgaXRlcmF0aW5n
ICh1bmRlciByZWFkIGxvY2spICovCi0gICAgbG9ja19yZXQgPSBIQVNIX0xPQ0tfVFJZV1JMT0NL
KGgpOwotICAgIGlmKGxvY2tfcmV0ICE9IDApIHJldHVybjsKLQotICAgIG5ld19zaXplX2lkeCA9
IGgtPnNpemVfaWR4OwotICAgIC8qIFdvcmsgb3V0IHRoZSBuZXcgc2l6ZSAqLwotICAgIGlmKGgt
Pm5yX2VudCA+PSBoLT5tYXhfbG9hZCkKLSAgICAgICAgbmV3X3NpemVfaWR4ID0gaC0+c2l6ZV9p
ZHgrMTsKLSAgICBpZihoLT5ucl9lbnQgPCBoLT5taW5fbG9hZCkKLSAgICAgICAgbmV3X3NpemVf
aWR4ID0gaC0+c2l6ZV9pZHgtMTsKLSAgICBpZigobmV3X3NpemVfaWR4ID09IGgtPnNpemVfaWR4
KSB8fAotICAgICAgIChuZXdfc2l6ZV9pZHggPj0gaGFzaF9zaXplc19sZW4pIHx8Ci0gICAgICAg
KG5ld19zaXplX2lkeCA8IDApKQotICAgIHsKLSAgICAgICAgSEFTSF9MT0NLX1dSVU5MT0NLKGgp
OwotICAgICAgICByZXR1cm47Ci0gICAgfQotCi0gICAgc2l6ZSA9IGhhc2hfc2l6ZXNbbmV3X3Np
emVfaWR4XTsKLQotICAgIC8qIEFsbG9jYXRlIHRoZSBuZXcgc2l6ZXMgKi8KLSAgICB0MSA9IHQy
ID0gTlVMTDsKLSAgICBsMSA9IGwyID0gTlVMTDsKLSAgICBhbGxvY190YWIoaCwgc2l6ZSwgJnQx
LCAmbDEpOwotICAgIGlmKCF0MSB8fCAhbDEpIGdvdG8gYWxsb2NfZmFpbDsKLSAgICBhbGxvY190
YWIoaCwgc2l6ZSwgJnQyLCAmbDIpOwotICAgIGlmKCF0MiB8fCAhbDIpIGdvdG8gYWxsb2NfZmFp
bDsKLQotICAgIG9sZF9zaXplID0gaC0+dGFiX3NpemU7Ci0gICAgaC0+dGFiX3NpemUgPSBzaXpl
OwotICAgIGgtPnNpemVfaWR4ID0gbmV3X3NpemVfaWR4OwotICAgIGgtPm1heF9sb2FkID0gKHVp
bnQzMl90KWNlaWxmKGhhc2hfbWF4X2xvYWRfZmFjdCAqIHNpemUpOwotICAgIGgtPm1pbl9sb2Fk
ID0gKHVpbnQzMl90KWNlaWxmKGhhc2hfbWluX2xvYWRfZmFjdCAqIHNpemUpOwotCi0gICAgLyog
TW92ZSB0aGUgZW50cmllcyAqLwotICAgIGZvcihpPTA7IGkgPCBvbGRfc2l6ZTsgaSsrKQotICAg
IHsKLSAgICAgICAgYiA9IEMyTChoLCAmaC0+a2V5X3RhYltpXSk7Ci0gICAgICAgIGUgPSBiLT5o
YXNoX2VudHJ5OwotICAgICAgICB3aGlsZShlICE9IE5VTEwpCi0gICAgICAgIHsKLSAgICAgICAg
ICAgIGUgPSBDMkwoaCwgZSk7Ci0gICAgICAgICAgICBuID0gZS0+a2V5X25leHQ7Ci0gICAgICAg
ICAgICBraWR4ID1oYXNoX3RvX2lkeChoLCBfX2tleV9oYXNoKGUtPmtleSkpOwotICAgICAgICAg
ICAgdmlkeCA9aGFzaF90b19pZHgoaCwgX192YWx1ZV9oYXNoKGUtPnZhbHVlKSk7Ci0gICAgICAg
ICAgICAvKiBNb3ZlIHRvIHRoZSBjb3JyZWN0IGJ1Y2tldCAqLwotICAgICAgICAgICAgZS0+a2V5
X25leHQgPSB0MVtraWR4XS5oYXNoX2VudHJ5OwotICAgICAgICAgICAgdDFba2lkeF0uaGFzaF9l
bnRyeSA9IEwyQyhoLCBlKTsKLSAgICAgICAgICAgIGUtPnZhbHVlX25leHQgPSB0Mlt2aWR4XS5o
YXNoX2VudHJ5OwotICAgICAgICAgICAgdDJbdmlkeF0uaGFzaF9lbnRyeSA9IEwyQyhoLCBlKTsK
LSAgICAgICAgICAgIGUgPSBuOwotICAgICAgICB9Ci0gICAgfQotICAgIGZyZWVfYnVja2V0cyho
LCBDMkwoaCwgaC0+a2V5X3RhYiksIEMyTChoLCBoLT5rZXlfbG9ja190YWIpKTsKLSAgICBmcmVl
X2J1Y2tldHMoaCwgQzJMKGgsIGgtPnZhbHVlX3RhYiksIEMyTChoLCBoLT52YWx1ZV9sb2NrX3Rh
YikpOwotICAgIGgtPmtleV90YWIgICAgICAgICA9IEwyQyhoLCB0MSk7Ci0gICAgaC0+a2V5X2xv
Y2tfdGFiICAgID0gTDJDKGgsIGwxKTsKLSAgICBoLT52YWx1ZV90YWIgICAgICAgPSBMMkMoaCwg
dDIpOwotICAgIGgtPnZhbHVlX2xvY2tfdGFiICA9IEwyQyhoLCBsMik7Ci0KLSAgICBIQVNIX0xP
Q0tfV1JVTkxPQ0soaCk7Ci0KLSAgICByZXR1cm47Ci0KLWFsbG9jX2ZhaWw6Ci0gICAgLyogSWYg
d2UgZmFpbGVkIHRvIHJlc2l6ZSwgYWRqdXN0IG1heC9taW4gbG9hZC4gVGhpcyB3aWxsIHN0b3Ag
dXMgZnJvbQotICAgICAqIHJldHJ5aW5nIHJlc2l6ZSB0b28gZnJlcXVlbnRseSAqLyAKLSAgICBp
ZihuZXdfc2l6ZV9pZHggPiBoLT5zaXplX2lkeCkKLSAgICAgICAgaC0+bWF4X2xvYWQgPSAoaC0+
bWF4X2xvYWQgKyAyICogaC0+dGFiX3NpemUpIC8gMiArIDE7Ci0gICAgZWxzZSAKLSAgICBpZiAo
bmV3X3NpemVfaWR4IDwgaC0+c2l6ZV9pZHgpCi0gICAgICAgIGgtPm1pbl9sb2FkID0gaC0+bWlu
X2xvYWQgLyAyOwotICAgIEhBU0hfTE9DS19XUlVOTE9DSyhoKTsKLSAgICBpZih0MSB8fCBsMSkg
ZnJlZV9idWNrZXRzKGgsIHQxLCBsMSk7Ci0gICAgaWYodDIgfHwgbDIpIGZyZWVfYnVja2V0cyho
LCB0MiwgbDIpOwotICAgIHJldHVybjsKLX0KLQotaW50IF9faGFzaF9pdGVyYXRvcihzdHJ1Y3Qg
X19oYXNoICpoLAotICAgICAgICAgICAgICAgICAgICBpbnQgKCplbnRyeV9jb25zdW1lcikoX19r
X3QgaywgX192X3Qgdiwgdm9pZCAqcCksCi0gICAgICAgICAgICAgICAgICAgIHZvaWQgKmQpCi17
Ci0gICAgc3RydWN0IGhhc2hfZW50cnkgKmUsICpuOwotICAgIHN0cnVjdCBidWNrZXQgKmI7Ci0g
ICAgc3RydWN0IGJ1Y2tldF9sb2NrICpibHQ7Ci0gICAgaW50IGksIGJya19lYXJseTsKLQotICAg
IGlmKEhBU0hfTE9DS19SRExPQ0soaCkgIT0gMCkgcmV0dXJuIC1FTk9MQ0s7Ci0KLSAgICBmb3Io
aT0wOyBpIDwgaC0+dGFiX3NpemU7IGkrKykKLSAgICB7Ci0gICAgICAgIGIgPSBDMkwoaCwgJmgt
PmtleV90YWJbaV0pOwotICAgICAgICBibHQgPSBDMkwoaCwgaC0+a2V5X2xvY2tfdGFiKTsKLSAg
ICAgICAgaWYoQlVDS0VUX0xPQ0tfUkRMT0NLKGgsIGJsdCwgaSkgIT0gMCkgcmV0dXJuIC1FTk9M
Q0s7Ci0gICAgICAgIGUgPSBiLT5oYXNoX2VudHJ5OwotICAgICAgICB3aGlsZShlICE9IE5VTEwp
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIGUgPSBDMkwoaCwgZSk7Ci0gICAgICAgICAgICBuID0g
ZS0+a2V5X25leHQ7Ci0gICAgICAgICAgICBicmtfZWFybHkgPSBlbnRyeV9jb25zdW1lcihlLT5r
ZXksIGUtPnZhbHVlLCBkKTsKLSAgICAgICAgICAgIGlmKGJya19lYXJseSkKLSAgICAgICAgICAg
IHsKLSAgICAgICAgICAgICAgICBCVUNLRVRfTE9DS19SRFVOTE9DSyhoLCBibHQsIGkpOwotICAg
ICAgICAgICAgICAgIGdvdG8gb3V0OwotICAgICAgICAgICAgfQotICAgICAgICAgICAgZSA9IG47
Ci0gICAgICAgIH0KLSAgICAgICAgQlVDS0VUX0xPQ0tfUkRVTkxPQ0soaCwgYmx0LCBpKTsKLSAg
ICB9Ci1vdXQ6Ci0gICAgSEFTSF9MT0NLX1JEVU5MT0NLKGgpOwotICAgIHJldHVybiAwOwotfQot
Ci12b2lkIF9faGFzaF9zaXplcyhzdHJ1Y3QgX19oYXNoICpoLAotICAgICAgICAgICAgICAgICAg
dWludDMyX3QgKm5yX2VudCwKLSAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICptYXhfbnJfZW50
LAotICAgICAgICAgICAgICAgICAgdWludDMyX3QgKnRhYl9zaXplLAotICAgICAgICAgICAgICAg
ICAgdWludDMyX3QgKm1heF9sb2FkLAotICAgICAgICAgICAgICAgICAgdWludDMyX3QgKm1pbl9s
b2FkKQotewotICAgIGlmKG5yX2VudCAgICAgIT0gTlVMTCkgKm5yX2VudCAgICAgPSBoLT5ucl9l
bnQ7Ci0gICAgaWYobWF4X25yX2VudCAhPSBOVUxMKSAqbWF4X25yX2VudCA9IG1heF9lbnRyaWVz
KGgpOyAKLSAgICBpZih0YWJfc2l6ZSAgICE9IE5VTEwpICp0YWJfc2l6ZSAgID0gaC0+dGFiX3Np
emU7Ci0gICAgaWYobWF4X2xvYWQgICAhPSBOVUxMKSAqbWF4X2xvYWQgICA9IGgtPm1heF9sb2Fk
OwotICAgIGlmKG1pbl9sb2FkICAgIT0gTlVMTCkgKm1pbl9sb2FkICAgPSBoLT5taW5fbG9hZDsK
LX0KLQpkaWZmIC0tZ2l0IGEvdG9vbHMvbWVtc2hyL2JpZGlyLWhhc2guaCBiL3Rvb2xzL21lbXNo
ci9iaWRpci1oYXNoLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGQzMmM4ZTQ3ODEu
LjAwMDAwMDAwMDAKLS0tIGEvdG9vbHMvbWVtc2hyL2JpZGlyLWhhc2guaAorKysgL2Rldi9udWxs
CkBAIC0xLDExNCArMCwwIEBACi0vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKgotICogQ29weXJp
Z2h0IChjKSAyMDA5IENpdHJpeCBTeXN0ZW1zLCBJbmMuIChHcnplZ29yeiBNaWxvcykKLSAqCi0g
KiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yIG1vZGlmeQotICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKLSAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5k
YXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCi0gKiAoYXQgeW91ciBv
cHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmli
dXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAotICogYnV0IFdJVEhPVVQg
QU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLSAqIE1F
UkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0
aGUKLSAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCi0gKgot
ICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UKLSAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNlZSA8aHR0
cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCi0gKi8KLSNpZm5kZWYgX19CSURJUl9IQVNIX0hf
XwotI2RlZmluZSBfX0JJRElSX0hBU0hfSF9fCi0KLSNpbmNsdWRlIDxzdGRpbnQuaD4KLSNpbmNs
dWRlIDxzdHJpbmcuaD4KLSNpbmNsdWRlICJtZW1zaHItcHJpdi5oIgotCi10eXBlZGVmIHN0cnVj
dCB2YmRibGsgewotICAgIHVpbnQ2NF90IHNlYzsKLSAgICB1aW50MTZfdCBkaXNrX2lkOwotfSB2
YmRibGtfdDsKLQotCi0jaWYgZGVmaW5lZCBGSU5HRVJQUklOVF9NQVAgfHwgQkxPQ0tfTUFQIAot
I2RlZmluZSBERUZJTkVfU0lOR0xFX01BUCAKLSNlbmRpZgotCi0vKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLS8qIEZpbmdlcnByaW50IG1h
cCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLwotLyoqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi0jaWYgZGVmaW5lZCBG
SU5HRVJQUklOVF9NQVAgfHwgIWRlZmluZWQgREVGSU5FX1NJTkdMRV9NQVAKLQotI3VuZGVmIEJJ
RElSX05BTUVfUFJFRklYCi0jdW5kZWYgQklESVJfS0VZCi0jdW5kZWYgQklESVJfVkFMVUUKLSN1
bmRlZiBCSURJUl9LRVlfVAotI3VuZGVmIEJJRElSX1ZBTFVFX1QKLXN0YXRpYyB1aW50MzJfdCBm
Z3BydHNocl9mZ3BydF9oYXNoKHVpbnQzMl90IGgpCi17Ci0gICAgcmV0dXJuIGg7Ci19Ci0KLXN0
YXRpYyB1aW50MzJfdCBmZ3BydHNocl9tZm5faGFzaCh1aW50NjRfdCBtKQotewotICAgIHJldHVy
biAodWludDMyX3QpbTsKLX0KLQotc3RhdGljIGludCBmZ3BydHNocl9mZ3BydF9jbXAodWludDMy
X3QgaDEsIHVpbnQzMl90IGgyKQotewotICAgIHJldHVybiAoaDEgPT0gaDIpOwotfQotCi1zdGF0
aWMgaW50IGZncHJ0c2hyX21mbl9jbXAodWludDMyX3QgbTEsIHVpbnQzMl90IG0yKQotewotICAg
IHJldHVybiAobTEgPT0gbTIpOwotfQotI2RlZmluZSBCSURJUl9OQU1FX1BSRUZJWCAgICAgICBm
Z3BydHNociAKLSNkZWZpbmUgQklESVJfS0VZICAgICAgICAgICAgICAgZmdwcnQgCi0jZGVmaW5l
IEJJRElSX1ZBTFVFICAgICAgICAgICAgIG1mbiAKLSNkZWZpbmUgQklESVJfS0VZX1QgICAgICAg
ICAgICAgdWludDMyX3QKLSNkZWZpbmUgQklESVJfVkFMVUVfVCAgICAgICAgICAgeGVuX21mbl90
Ci0jaW5jbHVkZSAiYmlkaXItbmFtZWRlZnMuaCIKLQotI2VuZGlmIC8qIEZJTkdFUlBSSU5UX01B
UCAqLwotCi0KLS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqLwotLyogQmxvY2s8LT5NZW1vcnkgc2hhcmluZyBoYW5kbGVzICAgICAgICAgICAg
ICAgICAgICAgICovCi0vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKi8KLSNpZiBkZWZpbmVkIEJMT0NLX01BUCB8fCAhZGVmaW5lZCBERUZJTkVf
U0lOR0xFX01BUAotCi0jdW5kZWYgQklESVJfTkFNRV9QUkVGSVgKLSN1bmRlZiBCSURJUl9LRVkK
LSN1bmRlZiBCSURJUl9WQUxVRQotI3VuZGVmIEJJRElSX0tFWV9UCi0jdW5kZWYgQklESVJfVkFM
VUVfVAotCi0vKiBUT0RPIGJldHRlciBoYXNoZXMhICovCi1zdGF0aWMgaW5saW5lIHVpbnQzMl90
IGJsb2Nrc2hyX2Jsb2NrX2hhc2godmJkYmxrX3QgYmxvY2spCi17Ci0gICAgcmV0dXJuICh1aW50
MzJfdCkoYmxvY2suc2VjKSBeICh1aW50MzJfdCkoYmxvY2suZGlza19pZCk7Ci19Ci0KLXN0YXRp
YyBpbmxpbmUgdWludDMyX3QgYmxvY2tzaHJfc2hyaG5kX2hhc2goc2hhcmVfdHVwbGVfdCBzaHJo
bmQpCi17Ci0gICAgcmV0dXJuICgodWludDMyX3QpIHNocmhuZC5oYW5kbGUpOwotfQotCi1zdGF0
aWMgaW5saW5lIGludCBibG9ja3Nocl9ibG9ja19jbXAodmJkYmxrX3QgYjEsIHZiZGJsa190IGIy
KQotewotICAgIHJldHVybiAoYjEuc2VjID09IGIyLnNlYykgJiYgKGIxLmRpc2tfaWQgPT0gYjIu
ZGlza19pZCk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgaW50IGJsb2Nrc2hyX3NocmhuZF9jbXAoc2hh
cmVfdHVwbGVfdCBoMSwgc2hhcmVfdHVwbGVfdCBoMikKLXsKLSAgICByZXR1cm4gKCAhbWVtY21w
KCZoMSwgJmgyLCBzaXplb2Yoc2hhcmVfdHVwbGVfdCkpICk7Ci19Ci0jZGVmaW5lIEJJRElSX05B
TUVfUFJFRklYICAgICAgIGJsb2Nrc2hyCi0jZGVmaW5lIEJJRElSX0tFWSAgICAgICAgICAgICAg
IGJsb2NrCi0jZGVmaW5lIEJJRElSX1ZBTFVFICAgICAgICAgICAgIHNocmhuZAotI2RlZmluZSBC
SURJUl9LRVlfVCAgICAgICAgICAgICB2YmRibGtfdAotI2RlZmluZSBCSURJUl9WQUxVRV9UICAg
ICAgICAgICBzaGFyZV90dXBsZV90Ci0jaW5jbHVkZSAiYmlkaXItbmFtZWRlZnMuaCIKLQotI2Vu
ZGlmIC8qIEJMT0NLX01BUCAqLwotCi0jZW5kaWYgLyogX19CSURJUl9IQVNIX0hfXyAqLwpkaWZm
IC0tZ2l0IGEvdG9vbHMvbWVtc2hyL2JpZGlyLW5hbWVkZWZzLmggYi90b29scy9tZW1zaHIvYmlk
aXItbmFtZWRlZnMuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNmFiNGIzZGU4Yy4u
MDAwMDAwMDAwMAotLS0gYS90b29scy9tZW1zaHIvYmlkaXItbmFtZWRlZnMuaAorKysgL2Rldi9u
dWxsCkBAIC0xLDc5ICswLDAgQEAKLS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqCi0gKiBDb3B5
cmlnaHQgKGMpIDIwMDkgQ2l0cml4IFN5c3RlbXMsIEluYy4gKEdyemVnb3J6IE1pbG9zKQotICoK
LSAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IgbW9kaWZ5Ci0gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQotICogdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKLSAqIChhdCB5b3Vy
IG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCi0gKgotICogVGhpcyBwcm9ncmFtIGlzIGRpc3Ry
aWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi0gKiBidXQgV0lUSE9V
VCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgotICog
TUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2Vl
IHRoZQotICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLSAq
Ci0gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZQotICogYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IElmIG5vdCwgc2VlIDxo
dHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KLSAqLwotI2luY2x1ZGUgIm1lbXNoci1wcml2
LmgiCi0KLS8qIE1hY3JvcyB1c2VkIHRvIGFzc2VtYmxlIHRoZSBuYW1lcyAqLwotI2RlZmluZSBC
SURJUl9OQU1FX09ORV9JTlRFUk5BTChwcmVmaXgsIG5hbWUpIFwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcHJlZml4ICMjIF8gIyMgbmFtZQotI2RlZmluZSBCSURJUl9OQU1FX1RX
T19JTlRFUk5BTChwcmVmaXgsIG5hbWUxLCBuYW1lMikgXAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBwcmVmaXggIyMgXyAjIyBuYW1lMSAjIyBfICMjIG5hbWUyCi0KLSNkZWZpbmUg
QklESVJfTkFNRV9PTkUocHJlZml4LCBuYW1lKSBcCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEJJRElSX05BTUVfT05FX0lOVEVSTkFMKHByZWZpeCwgbmFtZSkKLSNkZWZpbmUgQklE
SVJfTkFNRV9UV08ocHJlZml4LCBuYW1lMSwgbmFtZTIpIFwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgQklESVJfTkFNRV9UV09fSU5URVJOQUwocHJlZml4LCBuYW1lMSwgbmFtZTIp
Ci0KLSNkZWZpbmUgSU5URVJOQUxfTkFNRV9PTkUobmFtZSkgQklESVJfTkFNRV9PTkUoQklESVJf
TkFNRV9QUkVGSVgsIG5hbWUpCi0jZGVmaW5lIElOVEVSTkFMX05BTUVfVFdPKG5hbWUxLCBuYW1l
MikgXAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCSURJUl9OQU1FX1RXTyhCSURJ
Ul9OQU1FX1BSRUZJWCwgbmFtZTEsIG5hbWUyKQotCi0vKiBGdW5jdGlvbi90eXBlIG5hbWVzICov
Ci0jZGVmaW5lIF9fa190ICAgICAgICAgICAgICAgICAgIEJJRElSX0tFWV9UCi0jZGVmaW5lIF9f
dl90ICAgICAgICAgICAgICAgICAgIEJJRElSX1ZBTFVFX1QKLQotI2RlZmluZSBfX2hhc2ggICAg
ICAgICAgICAgICAgICBJTlRFUk5BTF9OQU1FX09ORShoYXNoKQotI2RlZmluZSBfX3NobV9oYXNo
X2luaXQgICAgICAgICBJTlRFUk5BTF9OQU1FX09ORShzaG1faGFzaF9pbml0KQotI2RlZmluZSBf
X3NobV9oYXNoX2dldCAgICAgICAgICBJTlRFUk5BTF9OQU1FX09ORShzaG1faGFzaF9nZXQpCi0j
ZGVmaW5lIF9faGFzaF9pbml0ICAgICAgICAgICAgIElOVEVSTkFMX05BTUVfT05FKGhhc2hfaW5p
dCkKLSNkZWZpbmUgX19rZXlfbG9va3VwICAgICAgICAgICAgSU5URVJOQUxfTkFNRV9UV08oQklE
SVJfS0VZLCBsb29rdXApCi0jZGVmaW5lIF9fdmFsdWVfbG9va3VwICAgICAgICAgIElOVEVSTkFM
X05BTUVfVFdPKEJJRElSX1ZBTFVFLCBsb29rdXApCi0jZGVmaW5lIF9faW5zZXJ0ICAgICAgICAg
ICAgICAgIElOVEVSTkFMX05BTUVfT05FKGluc2VydCkKLSNkZWZpbmUgX19rZXlfcmVtb3ZlICAg
ICAgICAgICAgSU5URVJOQUxfTkFNRV9UV08oQklESVJfS0VZLCByZW1vdmUpCi0jZGVmaW5lIF9f
dmFsdWVfcmVtb3ZlICAgICAgICAgIElOVEVSTkFMX05BTUVfVFdPKEJJRElSX1ZBTFVFLCByZW1v
dmUpCi0jZGVmaW5lIF9faGFzaF9kZXN0cm95ICAgICAgICAgIElOVEVSTkFMX05BTUVfT05FKGhh
c2hfZGVzdHJveSkKLSNkZWZpbmUgX19oYXNoX2l0ZXJhdG9yICAgICAgICAgSU5URVJOQUxfTkFN
RV9PTkUoaGFzaF9pdGVyYXRvcikKLQotI2RlZmluZSBfX2tleV9oYXNoICAgICAgICAgICAgICBJ
TlRFUk5BTF9OQU1FX1RXTyhCSURJUl9LRVksIGhhc2gpCi0jZGVmaW5lIF9fa2V5X2NtcCAgICAg
ICAgICAgICAgIElOVEVSTkFMX05BTUVfVFdPKEJJRElSX0tFWSwgY21wKQotI2RlZmluZSBfX3Zh
bHVlX2hhc2ggICAgICAgICAgICBJTlRFUk5BTF9OQU1FX1RXTyhCSURJUl9WQUxVRSwgaGFzaCkK
LSNkZWZpbmUgX192YWx1ZV9jbXAgICAgICAgICAgICAgSU5URVJOQUxfTkFNRV9UV08oQklESVJf
VkFMVUUsIGNtcCkKLQotI2RlZmluZSBfX2hhc2hfc2l6ZXMgICAgICAgICAgICBJTlRFUk5BTF9O
QU1FX09ORShoYXNoX3NpemVzKQotCi0KLS8qIEZpbmFsIGZ1bmN0aW9uIGV4cG9ydHMgKi8KLXN0
cnVjdCBfX2hhc2gqIF9fc2htX2hhc2hfaW5pdCh1bnNpZ25lZCBsb25nIHNobV9iYWRkciwgdW5z
aWduZWQgbG9uZyBzaG1fc2l6ZSk7Ci1zdHJ1Y3QgX19oYXNoKiBfX3NobV9oYXNoX2dldCh1bnNp
Z25lZCBsb25nIHNobV9iYWRkcik7Ci1zdHJ1Y3QgX19oYXNoICpfX2hhc2hfaW5pdCAgIChzdHJ1
Y3QgX19oYXNoICpoLCB1aW50MzJfdCBtaW5fc2l6ZSk7Ci1pbnQgICAgICAgICAgICBfX2tleV9s
b29rdXAgIChzdHJ1Y3QgX19oYXNoICpoLCBfX2tfdCBrLCBfX3ZfdCAqdnApOwotaW50ICAgICAg
ICAgICAgX192YWx1ZV9sb29rdXAoc3RydWN0IF9faGFzaCAqaCwgX192X3QgdiwgX19rX3QgKmtw
KTsKLWludCAgICAgICAgICAgIF9faW5zZXJ0ICAgICAgKHN0cnVjdCBfX2hhc2ggKmgsIF9fa190
IGssIF9fdl90IHYpOwotaW50ICAgICAgICAgICAgX19rZXlfcmVtb3ZlICAoc3RydWN0IF9faGFz
aCAqaCwgX19rX3QgaywgX192X3QgKnZwKTsKLWludCAgICAgICAgICAgIF9fdmFsdWVfcmVtb3Zl
KHN0cnVjdCBfX2hhc2ggKmgsIF9fdl90IHYsIF9fa190ICprcCk7Ci1pbnQgICAgICAgICAgICBf
X2hhc2hfZGVzdHJveShzdHJ1Y3QgX19oYXNoICpoLAotICAgICAgICAgICAgICAgICAgICB2b2lk
ICgqZW50cnlfY29uc3VtZXIpKF9fa190IGssIF9fdl90IHYsIHZvaWQgKnApLAotICAgICAgICAg
ICAgICAgICAgICB2b2lkICpkKTsKLWludCAgICAgICAgICAgIF9faGFzaF9pdGVyYXRvcihzdHJ1
Y3QgX19oYXNoICpoLAotICAgICAgICAgICAgICAgICAgICAgICAgaW50ICgqZW50cnlfY29uc3Vt
ZXIpKF9fa190IGssIF9fdl90IHYsIHZvaWQgKnApLAotICAgICAgICAgICAgICAgICAgICAgICAg
dm9pZCAqZCk7Ci12b2lkICAgICAgICAgICBfX2hhc2hfc2l6ZXMoc3RydWN0IF9faGFzaCAqaCwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbnJfZW50LAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICptYXhfbnJfZW50LAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVpbnQzMl90ICp0YWJfc2l6ZSwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50MzJfdCAqbWF4X2xvYWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlu
dDMyX3QgKm1pbl9sb2FkKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL21lbXNoci9pbnRlcmZhY2UuYyBi
L3Rvb2xzL21lbXNoci9pbnRlcmZhY2UuYwpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
YmE0M2MzZGU2Ni4uMDAwMDAwMDAwMAotLS0gYS90b29scy9tZW1zaHIvaW50ZXJmYWNlLmMKKysr
IC9kZXYvbnVsbApAQCAtMSwyMjQgKzAsMCBAQAotLyoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICoK
LSAqIENvcHlyaWdodCAoYykgMjAwOSBDaXRyaXggU3lzdGVtcywgSW5jLiAoR3J6ZWdvcnogTWls
b3MpCi0gKgotICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKLSAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5Ci0gKiB0aGUgRnJlZSBTb2Z0
d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgotICog
KGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KLSAqCi0gKiBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLSAqIGJ1
dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5
IG9mCi0gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBP
U0UuICBTZWUgdGhlCi0gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRh
aWxzLgotICoKLSAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi0gKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgSWYgbm90
LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgotICovCi0jaW5jbHVkZSA8c3Ry
aW5nLmg+Ci0jaW5jbHVkZSA8aW50dHlwZXMuaD4KLQotI2luY2x1ZGUgIm1lbXNoci5oIgotI2lu
Y2x1ZGUgIm1lbXNoci1wcml2LmgiCi0jaW5jbHVkZSAiYmlkaXItaGFzaC5oIgotI2luY2x1ZGUg
InNobS5oIgotI2luY2x1ZGUgImJpZGlyLWRhZW1vbi5oIgotCi10eXBlZGVmIHN0cnVjdCB7Ci0g
ICAgaW50ICAgICBlbmFibGVkOwotICAgIGRvbWlkX3QgZG9taWQ7Ci0gICAgeGNfaW50ZXJmYWNl
ICp4Y19oYW5kbGU7Ci19IG1lbXNocl92YmRfaW5mb190OwotCi1tZW1zaHJfdmJkX2luZm9fdCB2
YmRfaW5mbyA9IHswLCBET01JRF9JTlZBTElEfTsKLQotCi10eXBlZGVmIHN0cnVjdCB7Ci0gICAg
c3RydWN0IHNoYXJlZF9tZW1zaHJfaW5mbyAqc2hhcmVkX2luZm87Ci0gICAgc3RydWN0IGZncHJ0
c2hyX2hhc2ggICAgICAqZmdwcnRzOwotICAgIHN0cnVjdCBibG9ja3Nocl9oYXNoICAgICAgKmJs
a3M7Ci19IHByaXZhdGVfbWVtc2hyX2luZm9fdDsKLQotcHJpdmF0ZV9tZW1zaHJfaW5mb190IG1l
bXNocjsKLQotI2RlZmluZSBTSEFSRURfSU5GTyAgKG1lbXNoci5zaGFyZWRfaW5mbykKLQotdm9p
ZCBtZW1zaHJfc2V0X2RvbWlkKGludCBkb21pZCkKLXsKLSAgICB2YmRfaW5mby5kb21pZCA9IGRv
bWlkOwotfQotCi12b2lkIG1lbXNocl9kYWVtb25faW5pdGlhbGl6ZSh2b2lkKQotewotICAgIHZv
aWQgKnNobV9iYXNlX2FkZHI7Ci0gICAgc3RydWN0IGZncHJ0c2hyX2hhc2ggKmg7Ci0KLSAgICBt
ZW1zZXQoJm1lbXNociwgMCwgc2l6ZW9mKHByaXZhdGVfbWVtc2hyX2luZm9fdCkpOwotCi0gICAg
aWYoKFNIQVJFRF9JTkZPID0gc2htX3NoYXJlZF9pbmZvX29wZW4oMSkpID09IE5VTEwpCi0gICAg
ewotICAgICAgICBEUFJJTlRGKCJGYWlsZWQgdG8gaW5pdCBzaGFyZWQgaW5mby5cbiIpOwotICAg
ICAgICByZXR1cm47Ci0gICAgfQotCi0gICAgaWYoKG1lbXNoci5mZ3BydHMgPSBzaG1fZmdwcnRz
aHJfaGFzaF9vcGVuKDEpKSA9PSBOVUxMKSAKLSAgICB7Ci0gICAgICAgIERQUklOVEYoIkZhaWxl
ZCB0byBpbml0IGZncHJ0c2hyIGhhc2guXG4iKTsKLSAgICAgICAgcmV0dXJuOwotICAgIH0KLSAg
ICBtZW1zaHIuc2hhcmVkX2luZm8tPmZncHJ0c2hyX2hhc2hfaW5pdGVkID0gMTsKLQotICAgIGlm
KChtZW1zaHIuYmxrcyA9IHNobV9ibG9ja3Nocl9oYXNoX29wZW4oMSkpID09IE5VTEwpIAotICAg
IHsKLSAgICAgICAgRFBSSU5URigiRmFpbGVkIHRvIGluaXQgYmxvY2tzaHIgaGFzaC5cbiIpOwot
ICAgICAgICByZXR1cm47Ci0gICAgfQotICAgIG1lbXNoci5zaGFyZWRfaW5mby0+YmxvY2tzaHJf
aGFzaF9pbml0ZWQgPSAxOwotICAgIAotICAgIGJpZGlyX2RhZW1vbl9pbml0aWFsaXplKG1lbXNo
ci5ibGtzKTsKLX0KLQotCi12b2lkIG1lbXNocl92YmRfaW5pdGlhbGl6ZSh2b2lkKQotewotICAg
IHhjX2ludGVyZmFjZSAqeGNfaGFuZGxlOwotCi0gICAgbWVtc2V0KCZtZW1zaHIsIDAsIHNpemVv
Zihwcml2YXRlX21lbXNocl9pbmZvX3QpKTsKLQotICAgIGlmKChTSEFSRURfSU5GTyA9IHNobV9z
aGFyZWRfaW5mb19vcGVuKDApKSA9PSBOVUxMKQotICAgIHsKLSAgICAgICAgRFBSSU5URigiRmFp
bGVkIHRvIG9wZW4gc2hhcmVkIGluZm8uXG4iKTsKLSAgICAgICAgcmV0dXJuOwotICAgIH0KLQot
ICAgIGlmKCFTSEFSRURfSU5GTy0+ZmdwcnRzaHJfaGFzaF9pbml0ZWQpCi0gICAgewotICAgICAg
ICBEUFJJTlRGKCJmZ3BydHNociBoYXNoIG5vdCBpbml0ZWQuXG4iKTsKLSAgICAgICAgcmV0dXJu
OwotICAgIH0KLQotICAgIGlmKChtZW1zaHIuZmdwcnRzID0gc2htX2ZncHJ0c2hyX2hhc2hfb3Bl
bigwKSkgPT0gTlVMTCkKLSAgICB7Ci0gICAgICAgIERQUklOVEYoIkZhaWxlZCB0byBvcGVuIGZn
cHJ0c2hyX2hhc2guXG4iKTsKLSAgICAgICAgcmV0dXJuOwotICAgIH0KLQotICAgIGlmKChtZW1z
aHIuYmxrcyA9IHNobV9ibG9ja3Nocl9oYXNoX29wZW4oMCkpID09IE5VTEwpCi0gICAgewotICAg
ICAgICBEUFJJTlRGKCJGYWlsZWQgdG8gb3BlbiBibG9ja3Nocl9oYXNoLlxuIik7Ci0gICAgICAg
IHJldHVybjsKLSAgICB9Ci0KLSAgICBpZih2YmRfaW5mby5kb21pZCA9PSBET01JRF9JTlZBTElE
KQotICAgICAgICByZXR1cm47Ci0KLSAgICBpZigoeGNfaGFuZGxlID0geGNfaW50ZXJmYWNlX29w
ZW4oMCwwLDApKSA9PSAwKQotICAgIHsKLSAgICAgICAgRFBSSU5URigiRmFpbGVkIHRvIG9wZW4g
WEMgaW50ZXJmYWNlLlxuIik7Ci0gICAgICAgIHJldHVybjsKLSAgICB9Ci0KLSAgICB2YmRfaW5m
by54Y19oYW5kbGUgPSB4Y19oYW5kbGU7Ci0gICAgdmJkX2luZm8uZW5hYmxlZCA9IDE7Ci19Ci0K
LXVpbnQxNl90IG1lbXNocl92YmRfaW1hZ2VfZ2V0KGNvbnN0IGNoYXIqIGZpbGUpCi17Ci0gICAg
dWludDE2X3QgaWQ7Ci0KLSAgICBpZihwdGhyZWFkX211dGV4X2xvY2soJlNIQVJFRF9JTkZPLT5s
b2NrKSkgZ290byBlcnJvcl9vdXQ7Ci0gICAgaWQgPSBzaG1fdmJkX2ltYWdlX2dldChmaWxlLCBT
SEFSRURfSU5GTy0+dmJkX2ltYWdlcyk7Ci0gICAgaWYocHRocmVhZF9tdXRleF91bmxvY2soJlNI
QVJFRF9JTkZPLT5sb2NrKSkgZ290byBlcnJvcl9vdXQ7Ci0KLSAgICByZXR1cm4gaWQ7Ci1lcnJv
cl9vdXQ6Ci0gICAgcmV0dXJuIDA7ICAgIAotfQotCi12b2lkIG1lbXNocl92YmRfaW1hZ2VfcHV0
KHVpbnQxNl90IG1lbXNocl9pZCkKLXsKLSAgICBpZihwdGhyZWFkX211dGV4X2xvY2soJlNIQVJF
RF9JTkZPLT5sb2NrKSkgcmV0dXJuOwotICAgIHNobV92YmRfaW1hZ2VfcHV0KG1lbXNocl9pZCwg
U0hBUkVEX0lORk8tPnZiZF9pbWFnZXMpOwotICAgIGlmKHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZT
SEFSRURfSU5GTy0+bG9jaykpIHJldHVybjsKLX0KLSAgICAKLWludCBtZW1zaHJfdmJkX2lzc3Vl
X3JvX3JlcXVlc3QoY2hhciAqYnVmLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
cmFudF9yZWZfdCBncmVmLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MTZf
dCBmaWxlX2lkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCBzZWMs
IAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgc2VjcywKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2hhcmVfdHVwbGVfdCAqaG5kKQotewotICAgIHZiZGJsa190
IGJsazsKLSAgICBzaGFyZV90dXBsZV90IHNvdXJjZV9zdCwgY2xpZW50X3N0OwotICAgIHVpbnQ2
NF90IGNfaG5kOwotICAgIGludCByZXQ7Ci0KLSAgICAqaG5kID0gKHNoYXJlX3R1cGxlX3QpeyAw
LCAwLCAwIH07Ci0gICAgaWYoIXZiZF9pbmZvLmVuYWJsZWQpIAotICAgICAgICByZXR1cm4gLTE7
Ci0KLSAgICBpZihzZWNzICE9IDgpCi0gICAgICAgIHJldHVybiAtMjsKLQotICAgIC8qIE5vbWlu
YXRlIHRoZSBncmFudGVkIHBhZ2UgZm9yIHNoYXJpbmcgKi8KLSAgICByZXQgPSB4Y19tZW1zaHJf
bm9taW5hdGVfZ3JlZih2YmRfaW5mby54Y19oYW5kbGUsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdmJkX2luZm8uZG9taWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ3JlZiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmY19obmQpOwot
ICAgIC8qIElmIHBhZ2UgY291bGRuJ3QgYmUgbWFkZSBzaGFyYWJsZSwgd2UgY2Fubm90IGRvIGFu
eXRoaW5nIGFib3V0IGl0ICovCi0gICAgaWYocmV0ICE9IDApCi0gICAgICAgIHJldHVybiAtMzsK
LQotICAgIGNsaWVudF9zdCA9IChzaGFyZV90dXBsZV90KXsgdmJkX2luZm8uZG9taWQsIGdyZWYs
IGNfaG5kIH07Ci0gICAgKmhuZCA9IGNsaWVudF9zdDsKLQotICAgIC8qIENoZWNrIGlmIHdlJ3Zl
IHJlYWQgbWF0Y2hpbmcgZGlzayBibG9jayBwcmV2aW91c2x5ICovCi0gICAgYmxrLnNlYyAgICAg
PSBzZWM7Ci0gICAgYmxrLmRpc2tfaWQgPSBmaWxlX2lkOwotICAgIGlmKGJsb2Nrc2hyX2Jsb2Nr
X2xvb2t1cChtZW1zaHIuYmxrcywgYmxrLCAmc291cmNlX3N0KSA+IDApCi0gICAgewotICAgICAg
ICByZXQgPSB4Y19tZW1zaHJfc2hhcmVfZ3JlZnModmJkX2luZm8ueGNfaGFuZGxlLCBzb3VyY2Vf
c3QuZG9tYWluLCBzb3VyY2Vfc3QuZnJhbWUsIAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc291cmNlX3N0LmhhbmRsZSwgdmJkX2luZm8uZG9taWQsIGdyZWYsIGNfaG5kKTsK
LSAgICAgICAgaWYoIXJldCkgcmV0dXJuIDA7Ci0gICAgICAgIC8qIEhhbmRsZXMgZmFpbGVkIHRv
IGJlIHNoYXJlZCA9PiBhdCBsZWFzdCBvbmUgb2YgdGhlbSBtdXN0IGJlIGludmFsaWQsCi0gICAg
ICAgICAgIHJlbW92ZSB0aGUgcmVsZXZhbnQgb25lcyBmcm9tIHRoZSBtYXAgKi8KLSAgICAgICAg
c3dpdGNoKHJldCkKLSAgICAgICAgewotICAgICAgICAgICAgY2FzZSBYRU5NRU1fU0hBUklOR19P
UF9TX0hBTkRMRV9JTlZBTElEOgotICAgICAgICAgICAgICAgIHJldCA9IGJsb2Nrc2hyX3Nocmhu
ZF9yZW1vdmUobWVtc2hyLmJsa3MsIHNvdXJjZV9zdCwgTlVMTCk7Ci0gICAgICAgICAgICAgICAg
aWYocmV0KSBEUFJJTlRGKCJDb3VsZCBub3Qgcm0gaW52bCBzX2huZDogJXUgJSJQUklkNjQiICUi
UFJJZDY0IlxuIiwgCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2Vf
c3QuZG9tYWluLCBzb3VyY2Vfc3QuZnJhbWUsIHNvdXJjZV9zdC5oYW5kbGUpOwotICAgICAgICAg
ICAgICAgIGJyZWFrOwotICAgICAgICAgICAgY2FzZSBYRU5NRU1fU0hBUklOR19PUF9DX0hBTkRM
RV9JTlZBTElEOgotICAgICAgICAgICAgICAgIHJldCA9IGJsb2Nrc2hyX3NocmhuZF9yZW1vdmUo
bWVtc2hyLmJsa3MsIGNsaWVudF9zdCwgTlVMTCk7Ci0gICAgICAgICAgICAgICAgaWYocmV0KSBE
UFJJTlRGKCJDb3VsZCBub3Qgcm0gaW52bCBjX2huZDogJXUgJSJQUklkNjQiICUiUFJJZDY0Ilxu
IiwgCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfc3QuZG9tYWlu
LCBjbGllbnRfc3QuZnJhbWUsIGNsaWVudF9zdC5oYW5kbGUpOwotICAgICAgICAgICAgICAgIGJy
ZWFrOwotICAgICAgICAgICAgZGVmYXVsdDoKLSAgICAgICAgICAgICAgICBicmVhazsKLSAgICAg
ICAgfQotICAgICAgICByZXR1cm4gLTU7Ci0gICAgfQotCi0gICAgcmV0dXJuIC00OwotfQotCi12
b2lkIG1lbXNocl92YmRfY29tcGxldGVfcm9fcmVxdWVzdChzaGFyZV90dXBsZV90IGhuZCwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQxNl90IGZpbGVfaWQsIAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3Qgc2VjLCAKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBzZWNzKQotewotICAgIHZiZGJsa190IGJs
azsKLSAgICAKLSAgICBpZighdmJkX2luZm8uZW5hYmxlZCkgCi0gICAgICAgIHJldHVybjsKLQot
ICAgIGlmKHNlY3MgIT0gOCkKLSAgICAgICAgcmV0dXJuOwotCi0gICAgYmxrLnNlYyAgICAgPSBz
ZWM7Ci0gICAgYmxrLmRpc2tfaWQgPSBmaWxlX2lkOwotICAgIGlmKGJsb2Nrc2hyX2luc2VydCht
ZW1zaHIuYmxrcywgYmxrLCBobmQpIDwgMCkKLSAgICAgICAgRFBSSU5URigiQ291bGQgbm90IGlu
c2VydCBibG9jayBoaW50IGludG8gaGFzaC5cbiIpOwotfQpkaWZmIC0tZ2l0IGEvdG9vbHMvbWVt
c2hyL21lbXNoci1wcml2LmggYi90b29scy9tZW1zaHIvbWVtc2hyLXByaXYuaApkZWxldGVkIGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggZjJjM2YxZjkxZC4uMDAwMDAwMDAwMAotLS0gYS90b29scy9t
ZW1zaHIvbWVtc2hyLXByaXYuaAorKysgL2Rldi9udWxsCkBAIC0xLDMzICswLDAgQEAKLS8qKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioKLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDkgQ2l0cml4IFN5c3Rl
bXMsIEluYy4gKEdyemVnb3J6IE1pbG9zKQotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNv
ZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci0gKiBpdCB1bmRl
ciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieQotICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBv
ZiB0aGUgTGljZW5zZSwgb3IKLSAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24u
Ci0gKgotICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQg
d2lsbCBiZSB1c2VmdWwsCi0gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZl
biB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgotICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQotICogR05VIEdlbmVyYWwgUHVibGlj
IExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLSAqCi0gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2
ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQotICogYWxvbmcgd2l0
aCB0aGlzIHByb2dyYW07IElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMv
Pi4KLSAqLwotI2lmbmRlZiBfX01FTVNIUl9QUklWX0hfXwotI2RlZmluZSBfX01FTVNIUl9QUklW
X0hfXwotCi0jaW5jbHVkZSA8c3lzbG9nLmg+Ci0jaW5jbHVkZSA8eGVuY3RybC5oPgotI2luY2x1
ZGUgIm1lbXNoci5oIgotCi0jaWYgMQotI2RlZmluZSBEUFJJTlRGKF9mLCBfYS4uLikgc3lzbG9n
KExPR19JTkZPLCBfZiwgIyNfYSkKLSNlbHNlCi0jZGVmaW5lIERQUklOVEYoX2YsIF9hLi4uKSAo
KHZvaWQpMCkKLSNlbmRpZgotCi0jZGVmaW5lIEVQUklOVEYoX2YsIF9hLi4uKSBzeXNsb2coTE9H
X0VSUiwgIm1lbXNocjolczogIiBfZiwgX19mdW5jX18sICMjX2EpCi0KLSNlbmRpZiAvKiBfX01F
TVNIUl9QUklWX0hfXyAqLwpkaWZmIC0tZ2l0IGEvdG9vbHMvbWVtc2hyL21lbXNoci5oIGIvdG9v
bHMvbWVtc2hyL21lbXNoci5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBmM2Y4OThj
ZDJjLi4wMDAwMDAwMDAwCi0tLSBhL3Rvb2xzL21lbXNoci9tZW1zaHIuaAorKysgL2Rldi9udWxs
CkBAIC0xLDUxICswLDAgQEAKLS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqCi0gKiBDb3B5cmln
aHQgKGMpIDIwMDkgQ2l0cml4IFN5c3RlbXMsIEluYy4gKEdyemVnb3J6IE1pbG9zKQotICoKLSAq
IFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBh
bmQvb3IgbW9kaWZ5Ci0gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQotICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRh
dGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKLSAqIChhdCB5b3VyIG9w
dGlvbikgYW55IGxhdGVyIHZlcnNpb24uCi0gKgotICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1
dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi0gKiBidXQgV0lUSE9VVCBB
TlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgotICogTUVS
Q0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRo
ZQotICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLSAqCi0g
KiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZQotICogYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IElmIG5vdCwgc2VlIDxodHRw
Oi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KLSAqLwotI2lmbmRlZiBfX01FTVNIUl9IX18KLSNk
ZWZpbmUgX19NRU1TSFJfSF9fCi0KLSNpbmNsdWRlIDxzdGRpbnQuaD4KLSNpbmNsdWRlIDx4ZW4v
eGVuLmg+Ci0jaW5jbHVkZSA8eGVuL2dyYW50X3RhYmxlLmg+Ci0KLXR5cGVkZWYgdWludDY0X3Qg
eGVuX21mbl90OwotCi10eXBlZGVmIHN0cnVjdCBzaGFyZV90dXBsZSAKLXsKLSAgICB1aW50MzJf
dCBkb21haW47Ci0gICAgdWludDY0X3QgZnJhbWU7Ci0gICAgdWludDY0X3QgaGFuZGxlOwotfSBz
aGFyZV90dXBsZV90OwotCi1leHRlcm4gdm9pZCBtZW1zaHJfc2V0X2RvbWlkKGludCBkb21pZCk7
Ci1leHRlcm4gdm9pZCBtZW1zaHJfZGFlbW9uX2luaXRpYWxpemUodm9pZCk7Ci1leHRlcm4gdm9p
ZCBtZW1zaHJfdmJkX2luaXRpYWxpemUodm9pZCk7Ci1leHRlcm4gdWludDE2X3QgbWVtc2hyX3Zi
ZF9pbWFnZV9nZXQoY29uc3QgY2hhciogZmlsZSk7Ci1leHRlcm4gdm9pZCBtZW1zaHJfdmJkX2lt
YWdlX3B1dCh1aW50MTZfdCBtZW1zaHJfaWQpOwotZXh0ZXJuIGludCBtZW1zaHJfdmJkX2lzc3Vl
X3JvX3JlcXVlc3QoY2hhciAqYnVmLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ3JhbnRfcmVmX3QgZ3JlZiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQxNl90IGZpbGVfaWQsIAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdWludDY0X3Qgc2VjLCAKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBzZWNzLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c2hhcmVfdHVwbGVfdCAqaG5kKTsKLWV4dGVybiB2b2lkIG1lbXNocl92YmRfY29tcGxldGVfcm9f
cmVxdWVzdCgKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlX3R1
cGxlX3QgaG5kLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDE2
X3QgZmlsZV9pZCwgCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50
NjRfdCBzZWMsIAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHNl
Y3MpOwotCi0jZW5kaWYgLyogX19NRU1TSFJfSF9fICovCmRpZmYgLS1naXQgYS90b29scy9tZW1z
aHIvc2htLmMgYi90b29scy9tZW1zaHIvc2htLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwZTlhNTE1MzIuLjAwMDAwMDAwMDAKLS0tIGEvdG9vbHMvbWVtc2hyL3NobS5jCisrKyAv
ZGV2L251bGwKQEAgLTEsMjYyICswLDAgQEAKLS8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqCi0g
KiBDb3B5cmlnaHQgKGMpIDIwMDkgQ2l0cml4IFN5c3RlbXMsIEluYy4gKEdyemVnb3J6IE1pbG9z
KQotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Ci0gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQotICogdGhlIEZyZWUgU29mdHdh
cmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKLSAqIChh
dCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCi0gKgotICogVGhpcyBwcm9ncmFtIGlz
IGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi0gKiBidXQg
V0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBv
ZgotICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NF
LiAgU2VlIHRoZQotICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWls
cy4KLSAqCi0gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZQotICogYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IElmIG5vdCwg
c2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KLSAqLwotI2luY2x1ZGUgPGFzc2Vy
dC5oPgotI2luY2x1ZGUgPHN0ZGxpYi5oPgotI2luY2x1ZGUgPHN0cmluZy5oPgotI2luY2x1ZGUg
PGZjbnRsLmg+Ci0jaW5jbHVkZSA8dW5pc3RkLmg+Ci0jaW5jbHVkZSA8c3lzL21tYW4uaD4KLSNp
bmNsdWRlIDxzeXMvc3RhdC5oPgotI2luY2x1ZGUgPHN5cy90eXBlcy5oPgotCi0jaW5jbHVkZSAi
bWVtc2hyLXByaXYuaCIKLSNpbmNsdWRlICJiaWRpci1oYXNoLmgiCi0jaW5jbHVkZSAic2htLmgi
Ci0KLSNkZWZpbmUgTUVNU0hSX0lORk9fU0hNX0ZJTEUgICIvbWVtc2hyLWluZm8iCi0jZGVmaW5l
IE1FTVNIUl9JTkZPX01BR0lDICAgICAweDE1MjYzNzQ4IAotCi0jZGVmaW5lIEZHUFJUX0hBU0hf
U0hNX0ZJTEUgIi9ibGt0YXAtZmdwcnRzIgotI2RlZmluZSBGR1BSVF9IQVNIX1BBR0VTICAgIDEw
MDAwCi0KLSNkZWZpbmUgQkxPQ0tfSEFTSF9TSE1fRklMRSAiL2Jsa3RhcC1ibGtzIgotI2RlZmlu
ZSBCTE9DS19IQVNIX1BBR0VTICAgIDEwMDAwCi0KLXR5cGVkZWYgc3RydWN0IHNobV9hcmVhIHsK
LSAgICB2b2lkKiAgYmFzZV9hZGRyOwotICAgIHNpemVfdCBzaXplOwotICAgIGludCAgICBmZDsK
LX0gc2htX2FyZWFfdDsKLQotdHlwZWRlZiBzdHJ1Y3QgewotICAgIHN0cnVjdCBzaG1fYXJlYSBz
aGFyZWRfaW5mb19hcmVhOwotICAgIHN0cnVjdCBzaG1fYXJlYSBmZ3BydHNfYXJlYTsKLSAgICBz
dHJ1Y3Qgc2htX2FyZWEgYmxvY2tzX2FyZWE7Ci19IHByaXZhdGVfc2htX2luZm9fdDsKLQotcHJp
dmF0ZV9zaG1faW5mb190IHNobV9pbmZvOwotCi0KLQotc3RhdGljIGludCBzaG1fYXJlYV9vcGVu
KGNvbnN0IGNoYXIgKmZpbGUsIHNpemVfdCBzaXplLCBpbnQgdW5saW5rLCBzaG1fYXJlYV90ICpz
aG1hKQoteyAKLSAgICAvKiBUT0RPOiBJZiBibGt0YXBjdHJsIGNhbiBiZSByZXN0YXJ0ZWQgd2hp
bGUgc3lzdGVtIGlzIHJ1bm5pbmcsIHRoaXMgbmVlZHMKLSAgICAgKiB0byBiZSBjbGV2ZXJlciAq
LwotICAgIGlmKHVubGluaykgc2htX3VubGluayhmaWxlKTsKLQotICAgIHNobWEtPnNpemUgPSBz
aXplOwotICAgIHNobWEtPmZkID0gc2htX29wZW4oZmlsZSwKLSAgICAgICAgICAgICAgICAgICAg
ICAgIChPX0NSRUFUIHwgT19SRFdSKSwKLSAgICAgICAgICAgICAgICAgICAgICAgIChTX0lSRUFE
IHwgU19JV1JJVEUpKTsKLQotICAgIGlmKHNobWEtPmZkIDwgMCkgcmV0dXJuIC0xOwotCi0gICAg
aWYoZnRydW5jYXRlKHNobWEtPmZkLCBzaXplKSA8IDApIHJldHVybiAtMjsKLQotICAgIHNobWEt
PmJhc2VfYWRkciA9IG1tYXAoTlVMTCwgCi0gICAgICAgICAgICAgICAgICAgICAgc2l6ZSwKLSAg
ICAgICAgICAgICAgICAgICAgICBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLCAKLSAgICAgICAgICAg
ICAgICAgICAgICBNQVBfU0hBUkVELAotICAgICAgICAgICAgICAgICAgICAgIHNobWEtPmZkLAot
ICAgICAgICAgICAgICAgICAgICAgIDApOwotICAgIAotICAgIGlmKHNobWEtPmJhc2VfYWRkciA9
PSBNQVBfRkFJTEVEKSByZXR1cm4gLTI7Ci0KLSAgICByZXR1cm4gMDsKLX0KLQotc3RhdGljIHZv
aWQgc2htX2FyZWFfY2xvc2Uoc2htX2FyZWFfdCAqc2htYSkKLXsKLSAgICBtdW5tYXAoc2htYS0+
YmFzZV9hZGRyLCBzaG1hLT5zaXplKTsKLSAgICBjbG9zZShzaG1hLT5mZCk7Ci19Ci0KLQotc2hh
cmVkX21lbXNocl9pbmZvX3QgKiBzaG1fc2hhcmVkX2luZm9fb3BlbihpbnQgdW5saW5rKQotewot
ICAgIHNoYXJlZF9tZW1zaHJfaW5mb190ICpzaGFyZWRfaW5mbzsKLSAgICBwdGhyZWFkX211dGV4
YXR0cl90ICBsb2NrX2F0dHI7Ci0gICAgaW50IG5yX3BhZ2VzLCBpOwotCi0gICAgbnJfcGFnZXMg
PSAoc2l6ZW9mKHNoYXJlZF9tZW1zaHJfaW5mb190KSA+PiBYQ19QQUdFX1NISUZUKSArIDE7Ci0g
ICAgaWYoc2htX2FyZWFfb3BlbihNRU1TSFJfSU5GT19TSE1fRklMRSwgCi0gICAgICAgICAgICAg
ICAgICAgICBucl9wYWdlcyAqIFhDX1BBR0VfU0laRSwKLSAgICAgICAgICAgICAgICAgICAgIHVu
bGluaywgCi0gICAgICAgICAgICAgICAgICAgICAmKHNobV9pbmZvLnNoYXJlZF9pbmZvX2FyZWEp
KSA8IDApCi0gICAgewotICAgICAgICBEUFJJTlRGKCJGYWlsZWQgdG8gb3BlbiBzaG1hIGZvciBz
aGFyZWQgaW5mby5cbiIpOwotICAgICAgICByZXR1cm4gTlVMTDsKLSAgICB9Ci0gICAgc2hhcmVk
X2luZm8gPSAoc2hhcmVkX21lbXNocl9pbmZvX3QgKikKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2htX2luZm8uc2hhcmVkX2luZm9fYXJlYS5iYXNlX2FkZHI7Ci0gICAgaWYodW5saW5r
KQotICAgIHsKLSAgICAgICAgbWVtc2V0KHNoYXJlZF9pbmZvLCAwLCBzaXplb2Yoc2hhcmVkX21l
bXNocl9pbmZvX3QpKTsKLSAgICAgICAgaWYocHRocmVhZF9tdXRleGF0dHJfaW5pdCgmbG9ja19h
dHRyKSB8fAotICAgICAgICAgICBwdGhyZWFkX211dGV4YXR0cl9zZXRwc2hhcmVkKCZsb2NrX2F0
dHIsIFBUSFJFQURfUFJPQ0VTU19TSEFSRUQpIHx8Ci0gICAgICAgICAgIHB0aHJlYWRfbXV0ZXhf
aW5pdCgmc2hhcmVkX2luZm8tPmxvY2ssICZsb2NrX2F0dHIpIHx8Ci0gICAgICAgICAgIHB0aHJl
YWRfbXV0ZXhhdHRyX2Rlc3Ryb3koJmxvY2tfYXR0cikpCi0gICAgICAgIHsKLSAgICAgICAgICAg
IERQUklOVEYoIkZhaWxlZCB0byBpbml0IHNoYXJlZCBpbmZvIGxvY2suXG4iKTsKLSAgICAgICAg
ICAgIHJldHVybiBOVUxMOwotICAgICAgICB9Ci0gICAgICAgIHN0cmNweShzaGFyZWRfaW5mby0+
dmJkX2ltYWdlc1swXS5maWxlLCAibGlzdC1oZWFkIik7Ci0gICAgICAgIGZvcihpPTE7IGk8TUFY
X05SX1ZCRF9JTUFHRVM7IGkrKykKLSAgICAgICAgewotICAgICAgICAgICAgc2hhcmVkX2luZm8t
PnZiZF9pbWFnZXNbaV0ubmV4dCA9IGk7IAotICAgICAgICAgICAgc2hhcmVkX2luZm8tPnZiZF9p
bWFnZXNbaV0ucHJldiA9IGk7IAotICAgICAgICB9Ci0gICAgICAgIHNoYXJlZF9pbmZvLT5tYWdp
YyA9IE1FTVNIUl9JTkZPX01BR0lDOwotICAgIH0gCi0gICAgZWxzZQotICAgIGlmKHNoYXJlZF9p
bmZvLT5tYWdpYyAhPSBNRU1TSFJfSU5GT19NQUdJQykKLSAgICB7Ci0gICAgICAgIERQUklOVEYo
IkluY29ycmVjdCBtYWdpYyBpbiBzaGFyZWQgaW5mby5cbiIpOwotICAgICAgICByZXR1cm4gTlVM
TDsKLSAgICB9Ci0gICAgCi0gICAgcmV0dXJuIHNoYXJlZF9pbmZvOwotfQotCi0KLXN0cnVjdCBm
Z3BydHNocl9oYXNoICogc2htX2ZncHJ0c2hyX2hhc2hfb3BlbihpbnQgdW5saW5rKQotewotICAg
IHN0cnVjdCBmZ3BydHNocl9oYXNoICpoOwotICAgIGlmKHNobV9hcmVhX29wZW4oRkdQUlRfSEFT
SF9TSE1fRklMRSwgCi0gICAgICAgICAgICAgICAgICAgICBGR1BSVF9IQVNIX1BBR0VTICogWENf
UEFHRV9TSVpFLAotICAgICAgICAgICAgICAgICAgICAgdW5saW5rLCAKLSAgICAgICAgICAgICAg
ICAgICAgICYoc2htX2luZm8uZmdwcnRzX2FyZWEpKSA8IDApCi0gICAgewotICAgICAgICBEUFJJ
TlRGKCJGYWlsZWQgdG8gaW5pdCBzaG1hIGZvciBmZ3BydHNocl9oYXNoLlxuIik7Ci0gICAgICAg
IHJldHVybiBOVUxMOwotICAgIH0KLQotICAgIGlmKHVubGluaykKLSAgICB7Ci0gICAgICAgIGgg
PSBmZ3BydHNocl9zaG1faGFzaF9pbml0KAotICAgICAgICAgICAgICAgICAgICAgKHVuc2lnbmVk
IGxvbmcpIHNobV9pbmZvLmZncHJ0c19hcmVhLmJhc2VfYWRkciwgCi0gICAgICAgICAgICAgICAg
ICAgICBGR1BSVF9IQVNIX1BBR0VTICogWENfUEFHRV9TSVpFKTsKLSAgICB9IGVsc2UKLSAgICB7
Ci0gICAgICAgIGggPSBmZ3BydHNocl9zaG1faGFzaF9nZXQoCi0gICAgICAgICAgICAgICAgICAg
ICAodW5zaWduZWQgbG9uZykgc2htX2luZm8uZmdwcnRzX2FyZWEuYmFzZV9hZGRyKTsgCi0gICAg
fQotICAgICAgICAKLSAgICByZXR1cm4gaDsKLX0gCi0KLXN0cnVjdCBibG9ja3Nocl9oYXNoICog
c2htX2Jsb2Nrc2hyX2hhc2hfb3BlbihpbnQgdW5saW5rKQotewotICAgIHN0cnVjdCBibG9ja3No
cl9oYXNoICpoOwotICAgIGlmKHNobV9hcmVhX29wZW4oQkxPQ0tfSEFTSF9TSE1fRklMRSwgCi0g
ICAgICAgICAgICAgICAgICAgICBCTE9DS19IQVNIX1BBR0VTICogWENfUEFHRV9TSVpFLAotICAg
ICAgICAgICAgICAgICAgICAgdW5saW5rLCAKLSAgICAgICAgICAgICAgICAgICAgICYoc2htX2lu
Zm8uYmxvY2tzX2FyZWEpKSA8IDApCi0gICAgewotICAgICAgICBEUFJJTlRGKCJGYWlsZWQgdG8g
aW5pdCBzaG1hIGZvciBibG9ja3Nocl9oYXNoLlxuIik7Ci0gICAgICAgIHJldHVybiBOVUxMOwot
ICAgIH0KLQotICAgIGlmKHVubGluaykKLSAgICB7Ci0gICAgICAgIGggPSBibG9ja3Nocl9zaG1f
aGFzaF9pbml0KAotICAgICAgICAgICAgICAgICAgICAgKHVuc2lnbmVkIGxvbmcpIHNobV9pbmZv
LmJsb2Nrc19hcmVhLmJhc2VfYWRkciwgCi0gICAgICAgICAgICAgICAgICAgICBCTE9DS19IQVNI
X1BBR0VTICogWENfUEFHRV9TSVpFKTsKLSAgICB9IGVsc2UKLSAgICB7Ci0gICAgICAgIGggPSBi
bG9ja3Nocl9zaG1faGFzaF9nZXQoCi0gICAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9u
Zykgc2htX2luZm8uYmxvY2tzX2FyZWEuYmFzZV9hZGRyKTsgCi0gICAgfQotICAgICAgICAKLSAg
ICByZXR1cm4gaDsKLX0gCi0KLXVpbnQxNl90IHNobV92YmRfaW1hZ2VfZ2V0KGNvbnN0IGNoYXIq
IGZpbGUsIHZiZF9pbWFnZV9pbmZvX3QgKnZiZF9pbWdzKQotewotICAgIHZiZF9pbWFnZV9pbmZv
X3QgKmltZywgKm5leHRfaW1nOwotICAgIGludCBpLCBpbWdfaWQ7Ci0KLSAgICAvKiBUcnkgdG8g
ZmluZCB0aGUgZmlsZSBpbiB0aGUgZXhpc3RpbmcgbGlzdCBmaXJzdCAqLyAKLSAgICBpbWcgPSB2
YmRfaW1nczsKLSAgICB3aGlsZShpbWctPm5leHQgIT0gMCkKLSAgICB7Ci0gICAgICAgIGltZyA9
IHZiZF9pbWdzICsgaW1nLT5uZXh0OwotICAgICAgICBpZihzdHJuY21wKGltZy0+ZmlsZSwgZmls
ZSwgTUFYX05BTUVfTEVOKSA9PSAwKQotICAgICAgICB7Ci0gICAgICAgICAgICBpbWctPnJlZl9j
bnQrKzsKLSAgICAgICAgICAgIHJldHVybiAodWludDE2X3QpKGltZyAtIHZiZF9pbWdzKTsgCi0g
ICAgICAgIH0KLSAgICB9Ci0gICAgCi0gICAgLyogQ291bGRuJ3QgZmluZCBhbiBleGlzdGluZyBl
bnRyeS4gV2UgbmVlZCB0byBhZGQgb25lLiBGaW5kIGVtcHR5IHNsb3QgKi8gCi0gICAgZm9yKGk9
MTsgaTxNQVhfTlJfVkJEX0lNQUdFUzsgaSsrKQotICAgIHsKLSAgICAgICAgaW1nID0gdmJkX2lt
Z3MgKyBpOwotICAgICAgICBpZigoaW1nLT5uZXh0ID09IGkpICYmIChpbWctPnByZXYgPT0gaSkp
Ci0gICAgICAgICAgICBicmVhazsKLSAgICB9Ci0gICAgLyogTm8gZW50cmllcyBsZWZ0ISAqLwot
ICAgIGlmKGkgPT0gTUFYX05SX1ZCRF9JTUFHRVMpCi0gICAgewotICAgICAgICBEUFJJTlRGKCJO
byBzcGFjZSBpbiB2YmRzIHRhYmxlLlxuIik7Ci0gICAgICAgIHJldHVybiAwOwotICAgIH0KLSAg
ICBpZihzdHJsZW4oZmlsZSkgPiBNQVhfTkFNRV9MRU4gLSAxKQotICAgIHsKLSAgICAgICAgRFBS
SU5URigiRmlsZW5hbWU6ICVzIHRvbyBsb25nICg+JWQpLlxuIiwgZmlsZSwgTUFYX05BTUVfTEVO
IC0gMSk7Ci0gICAgICAgIHJldHVybiAwOyAKLSAgICB9Ci0gICAgLyogSW5pdCB0aGUgZW50cnkg
Ki8KLSAgICBpbWdfaWQgPSAoaW1nIC0gdmJkX2ltZ3MpOwotICAgIG5leHRfaW1nID0gdmJkX2lt
Z3MgKyB2YmRfaW1nc1swXS5uZXh0OwotICAgIHN0cmNweShpbWctPmZpbGUsIGZpbGUpOwotICAg
IGltZy0+cmVmX2NudCA9IDE7Ci0gICAgaW1nLT5uZXh0ID0gdmJkX2ltZ3NbMF0ubmV4dDsKLSAg
ICBpbWctPnByZXYgPSAwOwotICAgIG5leHRfaW1nLT5wcmV2ID0gaW1nX2lkOwotICAgIHZiZF9p
bWdzWzBdLm5leHQgPSBpbWdfaWQ7Ci0KLSAgICByZXR1cm4gaW1nX2lkOwotfQotCi0KLXZvaWQg
c2htX3ZiZF9pbWFnZV9wdXQodWludDE2X3QgbWVtc2hyX2lkLCB2YmRfaW1hZ2VfaW5mb190ICp2
YmRfaW1ncykKLXsKLSAgICB2YmRfaW1hZ2VfaW5mb190ICppbWcsICpuZXh0X2ltZywgKnByZXZf
aW1nOwotICAgIAotICAgIGltZyA9IHZiZF9pbWdzICsgbWVtc2hyX2lkOwotICAgIGlmKGltZy0+
cmVmX2NudCA9PSAwKQotICAgIHsKLSAgICAgICAgRFBSSU5URigiSW5jb3JyZWN0IGltYWdlIHB1
dC5cbiIpOwotICAgICAgICByZXR1cm47Ci0gICAgfQotCi0gICAgaW1nLT5yZWZfY250LS07IAot
Ci0gICAgLyogUmVtb3ZlIGZyb20gbGlzdCBpZiByZWZfY250IGlzIHplcm8gKi8KLSAgICBpZihp
bWctPnJlZl9jbnQgPT0gMCkKLSAgICB7Ci0gICAgICAgIG5leHRfaW1nID0gdmJkX2ltZ3MgKyBp
bWctPm5leHQ7Ci0gICAgICAgIHByZXZfaW1nID0gdmJkX2ltZ3MgKyBpbWctPnByZXY7Ci0gICAg
ICAgIHByZXZfaW1nLT5uZXh0ID0gaW1nLT5uZXh0OwotICAgICAgICBuZXh0X2ltZy0+cHJldiA9
IGltZy0+cHJldjsKLSAgICAgICAgaW1nLT5uZXh0ID0gaW1nLT5wcmV2ID0gKGltZyAtIHZiZF9p
bWdzKTsKLSAgICAgICAgbWVtc2V0KGltZy0+ZmlsZSwgMCwgTUFYX05BTUVfTEVOKTsKLSAgICB9
Ci19Ci0KZGlmZiAtLWdpdCBhL3Rvb2xzL21lbXNoci9zaG0uaCBiL3Rvb2xzL21lbXNoci9zaG0u
aApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggYWRiNmViOTc1NC4uMDAwMDAwMDAwMAot
LS0gYS90b29scy9tZW1zaHIvc2htLmgKKysrIC9kZXYvbnVsbApAQCAtMSw0OSArMCwwIEBACi0v
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDA5IENpdHJpeCBT
eXN0ZW1zLCBJbmMuIChHcnplZ29yeiBNaWxvcykKLSAqCi0gKiBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQotICogaXQg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJs
aXNoZWQgYnkKLSAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9u
IDIgb2YgdGhlIExpY2Vuc2UsIG9yCi0gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJz
aW9uLgotICoKLSAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0
IGl0IHdpbGwgYmUgdXNlZnVsLAotICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0
IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKLSAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRO
RVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKLSAqIEdOVSBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCi0gKgotICogWW91IHNob3VsZCBoYXZlIHJl
Y2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKLSAqIGFsb25n
IHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vu
c2VzLz4uCi0gKi8KLSNpZm5kZWYgX19TSE1fSF9fCi0jZGVmaW5lIF9fU0hNX0hfXwotCi0jaW5j
bHVkZSA8cHRocmVhZC5oPgotI2luY2x1ZGUgPHVuaXN0ZC5oPgotCi0jZGVmaW5lIE1BWF9OQU1F
X0xFTiAgMTAwMAotCi10eXBlZGVmIHN0cnVjdCB2YmRfaW1hZ2VfaW5mbyB7Ci0gICAgY2hhciAg
ICAgZmlsZVtNQVhfTkFNRV9MRU5dOwotICAgIGludCAgICAgIHJlZl9jbnQ7Ci0gICAgdWludDE2
X3QgbmV4dDsKLSAgICB1aW50MTZfdCBwcmV2OwotfSB2YmRfaW1hZ2VfaW5mb190OwotCi0jZGVm
aW5lIE1BWF9OUl9WQkRfSU1BR0VTICAgNDA5NgotIAotdHlwZWRlZiBzdHJ1Y3Qgc2hhcmVkX21l
bXNocl9pbmZvIHsKLSAgICB1bnNpZ25lZCBsb25nICAgIG1hZ2ljOwotICAgIHB0aHJlYWRfbXV0
ZXhfdCAgbG9jazsKLSAgICBpbnQgICAgICAgICAgICAgIGZncHJ0c2hyX2hhc2hfaW5pdGVkOwot
ICAgIGludCAgICAgICAgICAgICAgYmxvY2tzaHJfaGFzaF9pbml0ZWQ7Ci0gICAgdmJkX2ltYWdl
X2luZm9fdCB2YmRfaW1hZ2VzW01BWF9OUl9WQkRfSU1BR0VTXTsKLX0gc2hhcmVkX21lbXNocl9p
bmZvX3Q7Ci0KLXNoYXJlZF9tZW1zaHJfaW5mb190ICogc2htX3NoYXJlZF9pbmZvX29wZW4oaW50
IHVubGluayk7Ci1zdHJ1Y3QgZmdwcnRzaHJfaGFzaCAqIHNobV9mZ3BydHNocl9oYXNoX29wZW4o
aW50IHVubGluayk7Ci1zdHJ1Y3QgYmxvY2tzaHJfaGFzaCAqIHNobV9ibG9ja3Nocl9oYXNoX29w
ZW4oaW50IHVubGluayk7Ci11aW50MTZfdCBzaG1fdmJkX2ltYWdlX2dldChjb25zdCBjaGFyKiBm
aWxlLCB2YmRfaW1hZ2VfaW5mb190ICp2YmRfaW1ncyk7Ci12b2lkICAgICBzaG1fdmJkX2ltYWdl
X3B1dCh1aW50MTZfdCBtZW1zaHJfaWQsIHZiZF9pbWFnZV9pbmZvX3QgKnZiZF9pbWdzKTsKLQot
I2VuZGlmIC8qIF9fU0hNX0hfXyAqLwotLSAKMi4yMC4xCgoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2
ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWls
bWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

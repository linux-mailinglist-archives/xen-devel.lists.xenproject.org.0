Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id AE38913CCA3
	for <lists+xen-devel@lfdr.de>; Wed, 15 Jan 2020 19:57:40 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1irno0-0002Sw-MR; Wed, 15 Jan 2020 18:54:16 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=aRIg=3E=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1irnnz-0002Sr-Kz
 for xen-devel@lists.xenproject.org; Wed, 15 Jan 2020 18:54:15 +0000
X-Inumbo-ID: 663c5832-37c8-11ea-b89f-bc764e2007e4
Received: from esa1.hc3370-68.iphmx.com (unknown [216.71.145.142])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 663c5832-37c8-11ea-b89f-bc764e2007e4;
 Wed, 15 Jan 2020 18:54:04 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1579114444;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=qibFpxQeKPGuuHTezrsBY6/zvkJa9qX2HTmoeRfMxc0=;
 b=ax835efPO5nPaOrSx8VNQ18rvrEe/JMqwpivWrBT2+kGXoeiusaAJlad
 JANKbTOsekyS8EnbgMUlNc1Bh0D56OLae+xQJa22sXCxp8a1k5wOk2//o
 ysSJaDUGbni/Xyp7fNWbHu4Tm7ZG0FV3B6GgEb4qxfjxlPFOgOwhWOds/ A=;
Authentication-Results: esa1.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa1.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa1.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa1.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: WZ/nsVNfpkCeQAoT3lNg/EUQfvuZUjkh3cSk7y9myLzhJpxt9r5UcomoOm2+o7JrhEWVquWeQW
 JN5DLxjPtLjyyeGRvwq9QMxv7V/WD5lsk5NwPe4b5uflqXllCsdh1rG0sMVkOBVi0IOKvAC2EO
 DCza01DKhZPZw5yOyZNkihN1WFr9ytv4OrBoLDLtGiHho25IAWBnqk3WkTbQbQBQ2dpnkIVy/f
 yJCQNy+JAqfzOY0u6zkPMM8pGgwxDk55RO6dTaLgFJItUpRJ3nkk7SLlQaFxTPggaZKK02wk75
 v00=
X-SBRS: 2.7
X-MesageID: 11132227
X-Ironport-Server: esa1.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.70,323,1574139600"; d="scan'208";a="11132227"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Wed, 15 Jan 2020 18:53:47 +0000
Message-ID: <20200115185347.26079-1-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20191224151932.6304-1-andrew.cooper3@citrix.com>
References: <20191224151932.6304-1-andrew.cooper3@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 0.5/12] tools/migration: Formatting and style
 cleanup
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wl@xen.org>,
 Ian Jackson <Ian.Jackson@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIGNvZGUgaGFzIGRldmF0aW5nIGZyb20gdGhlIHByZXZhaWxpbmcgc3R5bGUgaW4gbWFueSB3
YXlzLiAgQWRqdXN0IHNwYWNpbmcsCmluZGVudGF0aW9uLCBwb3NpdGlvbiBvZiBvcGVyYXRvcnMs
IGxheW91dCBvZiBtdWx0aWxpbmUgY29tbWVudHMsIHJlbW92YWwgb2YKc3VwZXJmbHVvdXMgY29t
bWVudHMsIGNvbnN0bmVzcywgdHJhaWxpbmcgY29tbWFzLCBhbmQgdXNlIG9mIHVucXVhbGlmaWVk
Cid1bnNpZ25lZCcuCgpObyBmdW5jdGlvbmFsIGNoYW5nZS4KClNpZ25lZC1vZmYtYnk6IEFuZHJl
dyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+Ci0tLQpDQzogSWFuIEphY2tzb24g
PElhbi5KYWNrc29uQGNpdHJpeC5jb20+CkNDOiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgotLS0KIHRv
b2xzL2xpYnhjL2luY2x1ZGUveGVuZ3Vlc3QuaCAgICAgICAgICAgICB8ICAzNSArKysrLS0tLQog
dG9vbHMvbGlieGMveGNfc3JfY29tbW9uLmMgICAgICAgICAgICAgICAgIHwgICA5ICstLQogdG9v
bHMvbGlieGMveGNfc3JfY29tbW9uLmggICAgICAgICAgICAgICAgIHwgIDEwICstLQogdG9vbHMv
bGlieGMveGNfc3JfY29tbW9uX3g4Ni5jICAgICAgICAgICAgIHwgICA1ICstCiB0b29scy9saWJ4
Yy94Y19zcl9jb21tb25feDg2X3B2LmMgICAgICAgICAgfCAgMTIgKy0tCiB0b29scy9saWJ4Yy94
Y19zcl9yZXN0b3JlLmMgICAgICAgICAgICAgICAgfCAgMzkgKysrKy0tLS0tCiB0b29scy9saWJ4
Yy94Y19zcl9yZXN0b3JlX3g4Nl9wdi5jICAgICAgICAgfCAgMjEgKystLS0KIHRvb2xzL2xpYnhj
L3hjX3NyX3NhdmUuYyAgICAgICAgICAgICAgICAgICB8ICA3NCArKysrKysrKy0tLS0tLS0tLQog
dG9vbHMvbGlieGMveGNfc3Jfc2F2ZV94ODZfaHZtLmMgICAgICAgICAgIHwgICA3ICstCiB0b29s
cy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9wdi5jICAgICAgICAgICAgfCAxMDEgKysrKysrKysrLS0t
LS0tLS0tLS0tLS0KIHRvb2xzL3B5dGhvbi9zY3JpcHRzL2NvbnZlcnQtbGVnYWN5LXN0cmVhbSB8
ICAyMCArKy0tLQogdG9vbHMvcHl0aG9uL3hlbi9taWdyYXRpb24vbGlieGMucHkgICAgICAgIHwg
MTI0ICsrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tCiB0b29scy9weXRob24veGVuL21pZ3Jh
dGlvbi9saWJ4bC5weSAgICAgICAgfCAgMzkgKysrKy0tLS0tCiAxMyBmaWxlcyBjaGFuZ2VkLCAy
MzUgaW5zZXJ0aW9ucygrKSwgMjYxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL2xp
YnhjL2luY2x1ZGUveGVuZ3Vlc3QuaCBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuZ3Vlc3QuaApp
bmRleCAyMzc2MDMzNzNjLi4xOWQ4MjhhN2YyIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy9pbmNs
dWRlL3hlbmd1ZXN0LmgKKysrIGIvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5ndWVzdC5oCkBAIC01
MiwxMCArNTIsMTEgQEAgdHlwZWRlZiBpbnQgKCpwcmVjb3B5X3BvbGljeV90KShzdHJ1Y3QgcHJl
Y29weV9zdGF0cywgdm9pZCAqKTsKIAogLyogY2FsbGJhY2tzIHByb3ZpZGVkIGJ5IHhjX2RvbWFp
bl9zYXZlICovCiBzdHJ1Y3Qgc2F2ZV9jYWxsYmFja3MgewotICAgIC8qIENhbGxlZCBhZnRlciBl
eHBpcmF0aW9uIG9mIGNoZWNrcG9pbnQgaW50ZXJ2YWwsCisgICAgLyoKKyAgICAgKiBDYWxsZWQg
YWZ0ZXIgZXhwaXJhdGlvbiBvZiBjaGVja3BvaW50IGludGVydmFsLAogICAgICAqIHRvIHN1c3Bl
bmQgdGhlIGd1ZXN0LgogICAgICAqLwotICAgIGludCAoKnN1c3BlbmQpKHZvaWQqIGRhdGEpOwor
ICAgIGludCAoKnN1c3BlbmQpKHZvaWQgKmRhdGEpOwogCiAgICAgLyoKICAgICAgKiBDYWxsZWQg
YmVmb3JlIGFuZCBhZnRlciBldmVyeSBiYXRjaCBvZiBwYWdlIGRhdGEgc2VudCBkdXJpbmcKQEAg
LTc5LDcgKzgwLDcgQEAgc3RydWN0IHNhdmVfY2FsbGJhY2tzIHsKICAgICAgKiB4Y19kb21haW5f
c2F2ZSB0aGVuIGZsdXNoZXMgdGhlIG91dHB1dCBidWZmZXIsIHdoaWxlIHRoZQogICAgICAqICBn
dWVzdCBjb250aW51ZXMgdG8gcnVuLgogICAgICAqLwotICAgIGludCAoKnBvc3Rjb3B5KSh2b2lk
KiBkYXRhKTsKKyAgICBpbnQgKCpwb3N0Y29weSkodm9pZCAqZGF0YSk7CiAKICAgICAvKgogICAg
ICAqIENhbGxlZCBhZnRlciB0aGUgbWVtb3J5IGNoZWNrcG9pbnQgaGFzIGJlZW4gZmx1c2hlZApA
QCAtOTQsNyArOTUsNyBAQCBzdHJ1Y3Qgc2F2ZV9jYWxsYmFja3MgewogICAgICAqIDA6IHRlcm1p
bmF0ZSBjaGVja3BvaW50aW5nIGdyYWNlZnVsbHkKICAgICAgKiAxOiB0YWtlIGFub3RoZXIgY2hl
Y2twb2ludAogICAgICAqLwotICAgIGludCAoKmNoZWNrcG9pbnQpKHZvaWQqIGRhdGEpOworICAg
IGludCAoKmNoZWNrcG9pbnQpKHZvaWQgKmRhdGEpOwogCiAgICAgLyoKICAgICAgKiBDYWxsZWQg
YWZ0ZXIgdGhlIGNoZWNrcG9pbnQgY2FsbGJhY2suCkBAIC0xMDMsMTMgKzEwNCwxMyBAQCBzdHJ1
Y3Qgc2F2ZV9jYWxsYmFja3MgewogICAgICAqIDA6IHRlcm1pbmF0ZSBjaGVja3BvaW50aW5nIGdy
YWNlZnVsbHkKICAgICAgKiAxOiB0YWtlIGFub3RoZXIgY2hlY2twb2ludAogICAgICAqLwotICAg
IGludCAoKndhaXRfY2hlY2twb2ludCkodm9pZCogZGF0YSk7CisgICAgaW50ICgqd2FpdF9jaGVj
a3BvaW50KSh2b2lkICpkYXRhKTsKIAogICAgIC8qIEVuYWJsZSBxZW11LWRtIGxvZ2dpbmcgZGly
dHkgcGFnZXMgdG8geGVuICovCiAgICAgaW50ICgqc3dpdGNoX3FlbXVfbG9nZGlydHkpKHVpbnQz
Ml90IGRvbWlkLCB1bnNpZ25lZCBlbmFibGUsIHZvaWQgKmRhdGEpOyAvKiBIVk0gb25seSAqLwog
CiAgICAgLyogdG8gYmUgcHJvdmlkZWQgYXMgdGhlIGxhc3QgYXJndW1lbnQgdG8gZWFjaCBjYWxs
YmFjayBmdW5jdGlvbiAqLwotICAgIHZvaWQqIGRhdGE7CisgICAgdm9pZCAqZGF0YTsKIH07CiAK
IC8qIFR5cGUgb2Ygc3RyZWFtLiAgUGxhaW4sIG9yIHVzaW5nIGEgY29udGludW91cyByZXBsaWNh
dGlvbiBwcm90b2NvbD8gKi8KQEAgLTEzOCwyMiArMTM5LDI0IEBAIGludCB4Y19kb21haW5fc2F2
ZSh4Y19pbnRlcmZhY2UgKnhjaCwgaW50IGlvX2ZkLCB1aW50MzJfdCBkb20sCiAKIC8qIGNhbGxi
YWNrcyBwcm92aWRlZCBieSB4Y19kb21haW5fcmVzdG9yZSAqLwogc3RydWN0IHJlc3RvcmVfY2Fs
bGJhY2tzIHsKLSAgICAvKiBDYWxsZWQgYWZ0ZXIgYSBuZXcgY2hlY2twb2ludCB0byBzdXNwZW5k
IHRoZSBndWVzdC4KLSAgICAgKi8KLSAgICBpbnQgKCpzdXNwZW5kKSh2b2lkKiBkYXRhKTsKKyAg
ICAvKiBDYWxsZWQgYWZ0ZXIgYSBuZXcgY2hlY2twb2ludCB0byBzdXNwZW5kIHRoZSBndWVzdC4g
Ki8KKyAgICBpbnQgKCpzdXNwZW5kKSh2b2lkICpkYXRhKTsKIAotICAgIC8qIENhbGxlZCBhZnRl
ciB0aGUgc2Vjb25kYXJ5IHZtIGlzIHJlYWR5IHRvIHJlc3VtZS4KKyAgICAvKgorICAgICAqIENh
bGxlZCBhZnRlciB0aGUgc2Vjb25kYXJ5IHZtIGlzIHJlYWR5IHRvIHJlc3VtZS4KICAgICAgKiBD
YWxsYmFjayBmdW5jdGlvbiByZXN1bWVzIHRoZSBndWVzdCAmIHRoZSBkZXZpY2UgbW9kZWwsCiAg
ICAgICogcmV0dXJucyB0byB4Y19kb21haW5fcmVzdG9yZS4KICAgICAgKi8KLSAgICBpbnQgKCpw
b3N0Y29weSkodm9pZCogZGF0YSk7CisgICAgaW50ICgqcG9zdGNvcHkpKHZvaWQgKmRhdGEpOwog
Ci0gICAgLyogQSBjaGVja3BvaW50IHJlY29yZCBoYXMgYmVlbiBmb3VuZCBpbiB0aGUgc3RyZWFt
LgotICAgICAqIHJldHVybnM6ICovCisgICAgLyoKKyAgICAgKiBBIGNoZWNrcG9pbnQgcmVjb3Jk
IGhhcyBiZWVuIGZvdW5kIGluIHRoZSBzdHJlYW0uCisgICAgICogcmV0dXJuczoKKyAgICAgKi8K
ICNkZWZpbmUgWEdSX0NIRUNLUE9JTlRfRVJST1IgICAgMCAvKiBUZXJtaW5hdGUgcHJvY2Vzc2lu
ZyAqLwogI2RlZmluZSBYR1JfQ0hFQ0tQT0lOVF9TVUNDRVNTICAxIC8qIENvbnRpbnVlIHJlYWRp
bmcgbW9yZSBkYXRhIGZyb20gdGhlIHN0cmVhbSAqLwogI2RlZmluZSBYR1JfQ0hFQ0tQT0lOVF9G
QUlMT1ZFUiAyIC8qIEZhaWxvdmVyIGFuZCByZXN1bWUgVk0gKi8KLSAgICBpbnQgKCpjaGVja3Bv
aW50KSh2b2lkKiBkYXRhKTsKKyAgICBpbnQgKCpjaGVja3BvaW50KSh2b2lkICpkYXRhKTsKIAog
ICAgIC8qCiAgICAgICogQ2FsbGVkIGFmdGVyIHRoZSBjaGVja3BvaW50IGNhbGxiYWNrLgpAQCAt
MTYyLDcgKzE2NSw3IEBAIHN0cnVjdCByZXN0b3JlX2NhbGxiYWNrcyB7CiAgICAgICogMDogdGVy
bWluYXRlIGNoZWNrcG9pbnRpbmcgZ3JhY2VmdWxseQogICAgICAqIDE6IHRha2UgYW5vdGhlciBj
aGVja3BvaW50CiAgICAgICovCi0gICAgaW50ICgqd2FpdF9jaGVja3BvaW50KSh2b2lkKiBkYXRh
KTsKKyAgICBpbnQgKCp3YWl0X2NoZWNrcG9pbnQpKHZvaWQgKmRhdGEpOwogCiAgICAgLyoKICAg
ICAgKiBjYWxsYmFjayB0byBzZW5kIHN0b3JlIGdmbiBhbmQgY29uc29sZSBnZm4gdG8geGwKQEAg
LTE3Myw3ICsxNzYsNyBAQCBzdHJ1Y3QgcmVzdG9yZV9jYWxsYmFja3MgewogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHZvaWQgKmRhdGEpOwogCiAgICAgLyogdG8gYmUgcHJvdmlkZWQgYXMg
dGhlIGxhc3QgYXJndW1lbnQgdG8gZWFjaCBjYWxsYmFjayBmdW5jdGlvbiAqLwotICAgIHZvaWQq
IGRhdGE7CisgICAgdm9pZCAqZGF0YTsKIH07CiAKIC8qKgpkaWZmIC0tZ2l0IGEvdG9vbHMvbGli
eGMveGNfc3JfY29tbW9uLmMgYi90b29scy9saWJ4Yy94Y19zcl9jb21tb24uYwppbmRleCA0NmZk
OTI4ZGUyLi5kZDlhMTFiNGI1IDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94Y19zcl9jb21tb24u
YworKysgYi90b29scy9saWJ4Yy94Y19zcl9jb21tb24uYwpAQCAtNCw3ICs0LDcgQEAKIAogI2lu
Y2x1ZGUgPHhlbi10b29scy9saWJzLmg+CiAKLXN0YXRpYyBjb25zdCBjaGFyICpkaGRyX3R5cGVz
W10gPQorc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGRoZHJfdHlwZXNbXSA9CiB7CiAgICAgW0RI
RFJfVFlQRV9YODZfUFZdICA9ICJ4ODYgUFYiLAogICAgIFtESERSX1RZUEVfWDg2X0hWTV0gPSAi
eDg2IEhWTSIsCkBAIC0xOCw3ICsxOCw3IEBAIGNvbnN0IGNoYXIgKmRoZHJfdHlwZV90b19zdHIo
dWludDMyX3QgdHlwZSkKICAgICByZXR1cm4gIlJlc2VydmVkIjsKIH0KIAotc3RhdGljIGNvbnN0
IGNoYXIgKm1hbmRhdG9yeV9yZWNfdHlwZXNbXSA9CitzdGF0aWMgY29uc3QgY2hhciAqY29uc3Qg
bWFuZGF0b3J5X3JlY190eXBlc1tdID0KIHsKICAgICBbUkVDX1RZUEVfRU5EXSAgICAgICAgICAg
ICAgICAgICAgICAgICAgPSAiRW5kIiwKICAgICBbUkVDX1RZUEVfUEFHRV9EQVRBXSAgICAgICAg
ICAgICAgICAgICAgPSAiUGFnZSBkYXRhIiwKQEAgLTU4LDEzICs1OCwxMiBAQCBpbnQgd3JpdGVf
c3BsaXRfcmVjb3JkKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHN0cnVjdCB4Y19zcl9yZWNv
cmQgKnJlYywKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogICAgIHR5cGVvZihy
ZWMtPmxlbmd0aCkgY29tYmluZWRfbGVuZ3RoID0gcmVjLT5sZW5ndGggKyBzejsKICAgICBzaXpl
X3QgcmVjb3JkX2xlbmd0aCA9IFJPVU5EVVAoY29tYmluZWRfbGVuZ3RoLCBSRUNfQUxJR05fT1JE
RVIpOwotICAgIHN0cnVjdCBpb3ZlYyBwYXJ0c1tdID0KLSAgICB7CisgICAgc3RydWN0IGlvdmVj
IHBhcnRzW10gPSB7CiAgICAgICAgIHsgJnJlYy0+dHlwZSwgICAgICAgc2l6ZW9mKHJlYy0+dHlw
ZSkgfSwKICAgICAgICAgeyAmY29tYmluZWRfbGVuZ3RoLCBzaXplb2YoY29tYmluZWRfbGVuZ3Ro
KSB9LAogICAgICAgICB7IHJlYy0+ZGF0YSwgICAgICAgIHJlYy0+bGVuZ3RoIH0sCiAgICAgICAg
IHsgYnVmLCAgICAgICAgICAgICAgc3ogfSwKLSAgICAgICAgeyAodm9pZCopemVyb2VzLCAgICBy
ZWNvcmRfbGVuZ3RoIC0gY29tYmluZWRfbGVuZ3RoIH0sCisgICAgICAgIHsgKHZvaWQgKil6ZXJv
ZXMsICAgcmVjb3JkX2xlbmd0aCAtIGNvbWJpbmVkX2xlbmd0aCB9LAogICAgIH07CiAKICAgICBp
ZiAoIHJlY29yZF9sZW5ndGggPiBSRUNfTEVOR1RIX01BWCApCmRpZmYgLS1naXQgYS90b29scy9s
aWJ4Yy94Y19zcl9jb21tb24uaCBiL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1vbi5oCmluZGV4IGI5
MjNhZDVjMTAuLmU0M2I4NThhMGEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1v
bi5oCisrKyBiL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1vbi5oCkBAIC0yMjgsNyArMjI4LDcgQEAg
c3RydWN0IHhjX3NyX2NvbnRleHQKICAgICAgICAgICAgIHN0cnVjdCBwcmVjb3B5X3N0YXRzIHN0
YXRzOwogCiAgICAgICAgICAgICB4ZW5fcGZuX3QgKmJhdGNoX3BmbnM7Ci0gICAgICAgICAgICB1
bnNpZ25lZCBucl9iYXRjaF9wZm5zOworICAgICAgICAgICAgdW5zaWduZWQgaW50IG5yX2JhdGNo
X3BmbnM7CiAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICpkZWZlcnJlZF9wYWdlczsKICAgICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgbnJfZGVmZXJyZWRfcGFnZXM7CiAgICAgICAgICAgICB4Y19o
eXBlcmNhbGxfYnVmZmVyX3QgZGlydHlfYml0bWFwX2hidWY7CkBAIC0yNjIsOCArMjYyLDggQEAg
c3RydWN0IHhjX3NyX2NvbnRleHQKICAqLwogI2RlZmluZSBERUZBVUxUX0JVRl9SRUNPUkRTIDEw
MjQKICAgICAgICAgICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgKmJ1ZmZlcmVkX3JlY29yZHM7Ci0g
ICAgICAgICAgICB1bnNpZ25lZCBhbGxvY2F0ZWRfcmVjX251bTsKLSAgICAgICAgICAgIHVuc2ln
bmVkIGJ1ZmZlcmVkX3JlY19udW07CisgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYWxsb2NhdGVk
X3JlY19udW07CisgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYnVmZmVyZWRfcmVjX251bTsKIAog
ICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAqIFhlbnN0b3JlIGFuZCBDb25zb2xlIHBhcmFt
ZXRlcnMuCkBAIC0zMzMsNyArMzMzLDcgQEAgc3RydWN0IHhjX3NyX2NvbnRleHQKICAgICAgICAg
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhjX3NyX2Jsb2Ig
YmFzaWMsIGV4dGQsIHhzYXZlLCBtc3I7CiAgICAgICAgICAgICAgICAgICAgIH0gKnZjcHVzOwot
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBucl92Y3B1czsKKyAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IG5yX3ZjcHVzOwogICAgICAgICAgICAgICAgIH0gcmVzdG9yZTsKICAg
ICAgICAgICAgIH07CiAgICAgICAgIH0geDg2X3B2OwpAQCAtNDE4LDcgKzQxOCw3IEBAIGludCBy
ZWFkX3JlY29yZChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCBpbnQgZmQsIHN0cnVjdCB4Y19z
cl9yZWNvcmQgKnJlYyk7CiAgKiB4ODZfcHZfbG9jYWxpc2VfcGFnZSgpIGlmIHdlIHJlY2VpdmUg
cGFnZXRhYmxlcyBmcmFtZXMgYWhlYWQgb2YgdGhlCiAgKiBjb250ZW50cyBvZiB0aGUgZnJhbWVz
IHRoZXkgcG9pbnQgYXQuCiAgKi8KLWludCBwb3B1bGF0ZV9wZm5zKHN0cnVjdCB4Y19zcl9jb250
ZXh0ICpjdHgsIHVuc2lnbmVkIGNvdW50LAoraW50IHBvcHVsYXRlX3BmbnMoc3RydWN0IHhjX3Ny
X2NvbnRleHQgKmN0eCwgdW5zaWduZWQgaW50IGNvdW50LAogICAgICAgICAgICAgICAgICAgY29u
c3QgeGVuX3Bmbl90ICpvcmlnaW5hbF9wZm5zLCBjb25zdCB1aW50MzJfdCAqdHlwZXMpOwogCiAj
ZW5kaWYKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1vbl94ODYuYyBiL3Rvb2xz
L2xpYnhjL3hjX3NyX2NvbW1vbl94ODYuYwppbmRleCAxZGVlODQwYTAzLi4wMTE2ODRkZjk3IDEw
MDY0NAotLS0gYS90b29scy9saWJ4Yy94Y19zcl9jb21tb25feDg2LmMKKysrIGIvdG9vbHMvbGli
eGMveGNfc3JfY29tbW9uX3g4Ni5jCkBAIC00LDExICs0LDEwIEBAIGludCB3cml0ZV94ODZfdHNj
X2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhj
aCA9IGN0eC0+eGNoOwogICAgIHN0cnVjdCB4Y19zcl9yZWNfeDg2X3RzY19pbmZvIHRzYyA9IHt9
OwotICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0KLSAgICB7CisgICAgc3RydWN0IHhjX3Ny
X3JlY29yZCByZWMgPSB7CiAgICAgICAgIC50eXBlID0gUkVDX1RZUEVfWDg2X1RTQ19JTkZPLAog
ICAgICAgICAubGVuZ3RoID0gc2l6ZW9mKHRzYyksCi0gICAgICAgIC5kYXRhID0gJnRzYworICAg
ICAgICAuZGF0YSA9ICZ0c2MsCiAgICAgfTsKIAogICAgIGlmICggeGNfZG9tYWluX2dldF90c2Nf
aW5mbyh4Y2gsIGN0eC0+ZG9taWQsICZ0c2MubW9kZSwKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhj
L3hjX3NyX2NvbW1vbl94ODZfcHYuYyBiL3Rvb2xzL2xpYnhjL3hjX3NyX2NvbW1vbl94ODZfcHYu
YwppbmRleCBmMjMzYzg3OTllLi5lYzQzM2ZhZDcwIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94
Y19zcl9jb21tb25feDg2X3B2LmMKKysrIGIvdG9vbHMvbGlieGMveGNfc3JfY29tbW9uX3g4Nl9w
di5jCkBAIC0xMCwxMCArMTAsMTAgQEAgeGVuX3Bmbl90IG1mbl90b19wZm4oc3RydWN0IHhjX3Ny
X2NvbnRleHQgKmN0eCwgeGVuX3Bmbl90IG1mbikKIAogYm9vbCBtZm5faW5fcHNldWRvcGh5c21h
cChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB4ZW5fcGZuX3QgbWZuKQogewotICAgIHJldHVy
biAoIChtZm4gPD0gY3R4LT54ODZfcHYubWF4X21mbikgJiYKLSAgICAgICAgICAgICAobWZuX3Rv
X3BmbihjdHgsIG1mbikgPD0gY3R4LT54ODZfcHYubWF4X3BmbikgJiYKLSAgICAgICAgICAgICAo
eGNfcGZuX3RvX21mbihtZm5fdG9fcGZuKGN0eCwgbWZuKSwgY3R4LT54ODZfcHYucDJtLAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+eDg2X3B2LndpZHRoKSA9PSBtZm4pICk7Cisg
ICAgcmV0dXJuICgobWZuIDw9IGN0eC0+eDg2X3B2Lm1heF9tZm4pICYmCisgICAgICAgICAgICAo
bWZuX3RvX3BmbihjdHgsIG1mbikgPD0gY3R4LT54ODZfcHYubWF4X3BmbikgJiYKKyAgICAgICAg
ICAgICh4Y19wZm5fdG9fbWZuKG1mbl90b19wZm4oY3R4LCBtZm4pLCBjdHgtPng4Nl9wdi5wMm0s
CisgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgtPng4Nl9wdi53aWR0aCkgPT0gbWZuKSk7
CiB9CiAKIHZvaWQgZHVtcF9iYWRfcHNldWRvcGh5c21hcF9lbnRyeShzdHJ1Y3QgeGNfc3JfY29u
dGV4dCAqY3R4LCB4ZW5fcGZuX3QgbWZuKQpAQCAtMTU3LDcgKzE1Nyw3IEBAIGludCB4ODZfcHZf
bWFwX20ycChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAgIHsKICAgICAgICAgc3RydWN0
IHhlbl9tYWNocGh5c19tZm5fbGlzdCB4bW1sID0gewogICAgICAgICAgICAgLm1heF9leHRlbnRz
ID0gMSwKLSAgICAgICAgICAgIC5leHRlbnRfc3RhcnQgPSB7ICZjdHgtPng4Nl9wdi5jb21wYXRf
bTJwX21mbjAgfQorICAgICAgICAgICAgLmV4dGVudF9zdGFydCA9IHsgJmN0eC0+eDg2X3B2LmNv
bXBhdF9tMnBfbWZuMCB9LAogICAgICAgICB9OwogCiAgICAgICAgIHJjID0gZG9fbWVtb3J5X29w
KHhjaCwgWEVOTUVNX21hY2hwaHlzX2NvbXBhdF9tZm5fbGlzdCwKQEAgLTE3NSw3ICsxNzUsNyBA
QCBpbnQgeDg2X3B2X21hcF9tMnAoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKICAgICByYyA9
IDA7CiAgICAgRFBSSU5URigibWF4X21mbiAlI2x4IiwgY3R4LT54ODZfcHYubWF4X21mbik7CiAK
LWVycjoKKyBlcnI6CiAgICAgZnJlZShlbnRyaWVzKTsKICAgICBmcmVlKGV4dGVudHNfc3RhcnQp
OwogCmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy94Y19zcl9yZXN0b3JlLmMgYi90b29scy9saWJ4
Yy94Y19zcl9yZXN0b3JlLmMKaW5kZXggZDliZjZmYjVhMS4uNWUzMTkwOGNhOCAxMDA2NDQKLS0t
IGEvdG9vbHMvbGlieGMveGNfc3JfcmVzdG9yZS5jCisrKyBiL3Rvb2xzL2xpYnhjL3hjX3NyX3Jl
c3RvcmUuYwpAQCAtMTM0LDEzICsxMzQsMTMgQEAgc3RhdGljIGludCBwZm5fc2V0X3BvcHVsYXRl
ZChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB4ZW5fcGZuX3QgcGZuKQogICogdW5wb3B1bGF0
ZWQgc3Vic2V0LiAgSWYgdHlwZXMgaXMgTlVMTCwgbm8gcGFnZSB0eXBlIGNoZWNraW5nIGlzIHBl
cmZvcm1lZAogICogYW5kIGFsbCB1bnBvcHVsYXRlZCBwZm5zIGFyZSBwb3B1bGF0ZWQuCiAgKi8K
LWludCBwb3B1bGF0ZV9wZm5zKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVuc2lnbmVkIGNv
dW50LAoraW50IHBvcHVsYXRlX3BmbnMoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgdW5zaWdu
ZWQgaW50IGNvdW50LAogICAgICAgICAgICAgICAgICAgY29uc3QgeGVuX3Bmbl90ICpvcmlnaW5h
bF9wZm5zLCBjb25zdCB1aW50MzJfdCAqdHlwZXMpCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4Y2gg
PSBjdHgtPnhjaDsKICAgICB4ZW5fcGZuX3QgKm1mbnMgPSBtYWxsb2MoY291bnQgKiBzaXplb2Yo
Km1mbnMpKSwKICAgICAgICAgKnBmbnMgPSBtYWxsb2MoY291bnQgKiBzaXplb2YoKnBmbnMpKTsK
LSAgICB1bnNpZ25lZCBpLCBucl9wZm5zID0gMDsKKyAgICB1bnNpZ25lZCBpbnQgaSwgbnJfcGZu
cyA9IDA7CiAgICAgaW50IHJjID0gLTE7CiAKICAgICBpZiAoICFtZm5zIHx8ICFwZm5zICkKQEAg
LTIwMiw3ICsyMDIsNyBAQCBpbnQgcG9wdWxhdGVfcGZucyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAq
Y3R4LCB1bnNpZ25lZCBjb3VudCwKICAqIHN0cmVhbSwgcG9wdWxhdGUgYW5kIHJlY29yZCB0aGVp
ciB0eXBlcywgbWFwIHRoZSByZWxldmFudCBzdWJzZXQgYW5kIGNvcHkKICAqIHRoZSBkYXRhIGlu
dG8gdGhlIGd1ZXN0LgogICovCi1zdGF0aWMgaW50IHByb2Nlc3NfcGFnZV9kYXRhKHN0cnVjdCB4
Y19zcl9jb250ZXh0ICpjdHgsIHVuc2lnbmVkIGNvdW50LAorc3RhdGljIGludCBwcm9jZXNzX3Bh
Z2VfZGF0YShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1bnNpZ25lZCBpbnQgY291bnQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhlbl9wZm5fdCAqcGZucywgdWludDMyX3QgKnR5
cGVzLCB2b2lkICpwYWdlX2RhdGEpCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhj
aDsKQEAgLTIxMCw4ICsyMTAsOCBAQCBzdGF0aWMgaW50IHByb2Nlc3NfcGFnZV9kYXRhKHN0cnVj
dCB4Y19zcl9jb250ZXh0ICpjdHgsIHVuc2lnbmVkIGNvdW50LAogICAgIGludCAqbWFwX2VycnMg
PSBtYWxsb2MoY291bnQgKiBzaXplb2YoKm1hcF9lcnJzKSk7CiAgICAgaW50IHJjOwogICAgIHZv
aWQgKm1hcHBpbmcgPSBOVUxMLCAqZ3Vlc3RfcGFnZSA9IE5VTEw7Ci0gICAgdW5zaWduZWQgaSwg
ICAgLyogaSBpbmRleGVzIHRoZSBwZm5zIGZyb20gdGhlIHJlY29yZC4gKi8KLSAgICAgICAgaiwg
ICAgICAgICAvKiBqIGluZGV4ZXMgdGhlIHN1YnNldCBvZiBwZm5zIHdlIGRlY2lkZSB0byBtYXAu
ICovCisgICAgdW5zaWduZWQgaW50IGksIC8qIGkgaW5kZXhlcyB0aGUgcGZucyBmcm9tIHRoZSBy
ZWNvcmQuICovCisgICAgICAgIGosICAgICAgICAgIC8qIGogaW5kZXhlcyB0aGUgc3Vic2V0IG9m
IHBmbnMgd2UgZGVjaWRlIHRvIG1hcC4gKi8KICAgICAgICAgbnJfcGFnZXMgPSAwOwogCiAgICAg
aWYgKCAhbWZucyB8fCAhbWFwX2VycnMgKQpAQCAtMjU4LDggKzI1OCw4IEBAIHN0YXRpYyBpbnQg
cHJvY2Vzc19wYWdlX2RhdGEoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwgdW5zaWduZWQgY291
bnQsCiAgICAgaWYgKCBucl9wYWdlcyA9PSAwICkKICAgICAgICAgZ290byBkb25lOwogCi0gICAg
bWFwcGluZyA9IGd1ZXN0X3BhZ2UgPSB4ZW5mb3JlaWdubWVtb3J5X21hcCh4Y2gtPmZtZW0sCi0g
ICAgICAgIGN0eC0+ZG9taWQsIFBST1RfUkVBRCB8IFBST1RfV1JJVEUsCisgICAgbWFwcGluZyA9
IGd1ZXN0X3BhZ2UgPSB4ZW5mb3JlaWdubWVtb3J5X21hcCgKKyAgICAgICAgeGNoLT5mbWVtLCBj
dHgtPmRvbWlkLCBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLAogICAgICAgICBucl9wYWdlcywgbWZu
cywgbWFwX2VycnMpOwogICAgIGlmICggIW1hcHBpbmcgKQogICAgIHsKQEAgLTMzNiw3ICszMzYs
NyBAQCBzdGF0aWMgaW50IGhhbmRsZV9wYWdlX2RhdGEoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0
eCwgc3RydWN0IHhjX3NyX3JlY29yZCAqcmVjKQogewogICAgIHhjX2ludGVyZmFjZSAqeGNoID0g
Y3R4LT54Y2g7CiAgICAgc3RydWN0IHhjX3NyX3JlY19wYWdlX2RhdGFfaGVhZGVyICpwYWdlcyA9
IHJlYy0+ZGF0YTsKLSAgICB1bnNpZ25lZCBpLCBwYWdlc19vZl9kYXRhID0gMDsKKyAgICB1bnNp
Z25lZCBpbnQgaSwgcGFnZXNfb2ZfZGF0YSA9IDA7CiAgICAgaW50IHJjID0gLTE7CiAKICAgICB4
ZW5fcGZuX3QgKnBmbnMgPSBOVUxMLCBwZm47CkBAIC00MjQsMTIgKzQyNCwxMSBAQCBzdGF0aWMg
aW50IHNlbmRfY2hlY2twb2ludF9kaXJ0eV9wZm5fbGlzdChzdHJ1Y3QgeGNfc3JfY29udGV4dCAq
Y3R4KQogewogICAgIHhjX2ludGVyZmFjZSAqeGNoID0gY3R4LT54Y2g7CiAgICAgaW50IHJjID0g
LTE7Ci0gICAgdW5zaWduZWQgY291bnQsIHdyaXR0ZW47CisgICAgdW5zaWduZWQgaW50IGNvdW50
LCB3cml0dGVuOwogICAgIHVpbnQ2NF90IGksICpwZm5zID0gTlVMTDsKICAgICBzdHJ1Y3QgaW92
ZWMgKmlvdiA9IE5VTEw7CiAgICAgeGNfc2hhZG93X29wX3N0YXRzX3Qgc3RhdHMgPSB7IDAsIGN0
eC0+cmVzdG9yZS5wMm1fc2l6ZSB9OwotICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0KLSAg
ICB7CisgICAgc3RydWN0IHhjX3NyX3JlY29yZCByZWMgPSB7CiAgICAgICAgIC50eXBlID0gUkVD
X1RZUEVfQ0hFQ0tQT0lOVF9ESVJUWV9QRk5fTElTVCwKICAgICB9OwogICAgIERFQ0xBUkVfSFlQ
RVJDQUxMX0JVRkZFUl9TSEFET1codW5zaWduZWQgbG9uZywgZGlydHlfYml0bWFwLApAQCAtNTEw
LDcgKzUwOSw3IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2NoZWNrcG9pbnQoc3RydWN0IHhjX3NyX2Nv
bnRleHQgKmN0eCkKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogICAgIGlu
dCByYyA9IDAsIHJldDsKLSAgICB1bnNpZ25lZCBpOworICAgIHVuc2lnbmVkIGludCBpOwogCiAg
ICAgaWYgKCBjdHgtPnN0cmVhbV90eXBlID09IFhDX1NUUkVBTV9QTEFJTiApCiAgICAgewpAQCAt
NTg3LDcgKzU4Niw3IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2NoZWNrcG9pbnQoc3RydWN0IHhjX3Ny
X2NvbnRleHQgKmN0eCkKIAogICAgICAgICAvKiBXYWl0IGZvciBhIG5ldyBjaGVja3BvaW50ICov
CiAgICAgICAgIHJldCA9IGN0eC0+cmVzdG9yZS5jYWxsYmFja3MtPndhaXRfY2hlY2twb2ludCgK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC0+cmVz
dG9yZS5jYWxsYmFja3MtPmRhdGEpOworICAgICAgICAgICAgY3R4LT5yZXN0b3JlLmNhbGxiYWNr
cy0+ZGF0YSk7CiAgICAgICAgIEhBTkRMRV9DQUxMQkFDS19SRVRVUk5fVkFMVUUocmV0KTsKIAog
ICAgICAgICAvKiBzdXNwZW5kIHNlY29uZGFyeSB2bSAqLwpAQCAtNjA4LDcgKzYwNyw3IEBAIHN0
YXRpYyBpbnQgaGFuZGxlX2NoZWNrcG9pbnQoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHN0
YXRpYyBpbnQgYnVmZmVyX3JlY29yZChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCBzdHJ1Y3Qg
eGNfc3JfcmVjb3JkICpyZWMpCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsK
LSAgICB1bnNpZ25lZCBuZXdfYWxsb2NfbnVtOworICAgIHVuc2lnbmVkIGludCBuZXdfYWxsb2Nf
bnVtOwogICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgKnA7CiAKICAgICBpZiAoIGN0eC0+cmVzdG9y
ZS5idWZmZXJlZF9yZWNfbnVtID49IGN0eC0+cmVzdG9yZS5hbGxvY2F0ZWRfcmVjX251bSApCkBA
IC02NzUsOCArNjc0LDggQEAgc3RhdGljIGludCBzZXR1cChzdHJ1Y3QgeGNfc3JfY29udGV4dCAq
Y3R4KQogCiAgICAgaWYgKCBjdHgtPnN0cmVhbV90eXBlID09IFhDX1NUUkVBTV9DT0xPICkKICAg
ICB7Ci0gICAgICAgIGRpcnR5X2JpdG1hcCA9IHhjX2h5cGVyY2FsbF9idWZmZXJfYWxsb2NfcGFn
ZXMoeGNoLCBkaXJ0eV9iaXRtYXAsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5S
UEFHRVMoYml0bWFwX3NpemUoY3R4LT5yZXN0b3JlLnAybV9zaXplKSkpOworICAgICAgICBkaXJ0
eV9iaXRtYXAgPSB4Y19oeXBlcmNhbGxfYnVmZmVyX2FsbG9jX3BhZ2VzKAorICAgICAgICAgICAg
eGNoLCBkaXJ0eV9iaXRtYXAsIE5SUEFHRVMoYml0bWFwX3NpemUoY3R4LT5yZXN0b3JlLnAybV9z
aXplKSkpOwogCiAgICAgICAgIGlmICggIWRpcnR5X2JpdG1hcCApCiAgICAgICAgIHsKQEAgLTcx
Nyw3ICs3MTYsNyBAQCBzdGF0aWMgaW50IHNldHVwKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgp
CiBzdGF0aWMgdm9pZCBjbGVhbnVwKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiB7CiAgICAg
eGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKLSAgICB1bnNpZ25lZCBpOworICAgIHVuc2ln
bmVkIGludCBpOwogICAgIERFQ0xBUkVfSFlQRVJDQUxMX0JVRkZFUl9TSEFET1codW5zaWduZWQg
bG9uZywgZGlydHlfYml0bWFwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JmN0eC0+cmVzdG9yZS5kaXJ0eV9iaXRtYXBfaGJ1Zik7CiAKQEAgLTcyNSwxMCArNzI0LDEyIEBA
IHN0YXRpYyB2b2lkIGNsZWFudXAoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKICAgICAgICAg
ZnJlZShjdHgtPnJlc3RvcmUuYnVmZmVyZWRfcmVjb3Jkc1tpXS5kYXRhKTsKIAogICAgIGlmICgg
Y3R4LT5zdHJlYW1fdHlwZSA9PSBYQ19TVFJFQU1fQ09MTyApCi0gICAgICAgIHhjX2h5cGVyY2Fs
bF9idWZmZXJfZnJlZV9wYWdlcyh4Y2gsIGRpcnR5X2JpdG1hcCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgTlJQQUdFUyhiaXRtYXBfc2l6ZShjdHgtPnJlc3RvcmUucDJtX3Np
emUpKSk7CisgICAgICAgIHhjX2h5cGVyY2FsbF9idWZmZXJfZnJlZV9wYWdlcygKKyAgICAgICAg
ICAgIHhjaCwgZGlydHlfYml0bWFwLCBOUlBBR0VTKGJpdG1hcF9zaXplKGN0eC0+cmVzdG9yZS5w
Mm1fc2l6ZSkpKTsKKwogICAgIGZyZWUoY3R4LT5yZXN0b3JlLmJ1ZmZlcmVkX3JlY29yZHMpOwog
ICAgIGZyZWUoY3R4LT5yZXN0b3JlLnBvcHVsYXRlZF9wZm5zKTsKKwogICAgIGlmICggY3R4LT5y
ZXN0b3JlLm9wcy5jbGVhbnVwKGN0eCkgKQogICAgICAgICBQRVJST1IoIkZhaWxlZCB0byBjbGVh
biB1cCIpOwogfQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfc3JfcmVzdG9yZV94ODZfcHYu
YyBiL3Rvb2xzL2xpYnhjL3hjX3NyX3Jlc3RvcmVfeDg2X3B2LmMKaW5kZXggZGNjMmE3ZjhjNS4u
OTI5OTg2MTIzNiAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGMveGNfc3JfcmVzdG9yZV94ODZfcHYu
YworKysgYi90b29scy9saWJ4Yy94Y19zcl9yZXN0b3JlX3g4Nl9wdi5jCkBAIC0yMjIsNyArMjIy
LDcgQEAgc3RhdGljIGludCBwcm9jZXNzX3N0YXJ0X2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQg
KmN0eCwKIAogICAgIHJjID0gMDsKIAotZXJyOgorIGVycjoKICAgICBpZiAoIGd1ZXN0X3N0YXJ0
X2luZm8gKQogICAgICAgICBtdW5tYXAoZ3Vlc3Rfc3RhcnRfaW5mbywgUEFHRV9TSVpFKTsKIApA
QCAtMjM4LDcgKzIzOCw3IEBAIHN0YXRpYyBpbnQgcHJvY2Vzc192Y3B1X2Jhc2ljKHN0cnVjdCB4
Y19zcl9jb250ZXh0ICpjdHgsCiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKICAg
ICB2Y3B1X2d1ZXN0X2NvbnRleHRfYW55X3QgKnZjcHUgPSBjdHgtPng4Nl9wdi5yZXN0b3JlLnZj
cHVzW3ZjcHVpZF0uYmFzaWMucHRyOwogICAgIHhlbl9wZm5fdCBwZm4sIG1mbjsKLSAgICB1bnNp
Z25lZCBpLCBnZHRfY291bnQ7CisgICAgdW5zaWduZWQgaW50IGksIGdkdF9jb3VudDsKICAgICBp
bnQgcmMgPSAtMTsKIAogICAgIC8qIFZjcHUgMCBpcyBzcGVjaWFsOiBDb252ZXJ0IHRoZSBzdXNw
ZW5kIHJlY29yZCB0byBhbiBtZm4uICovCkBAIC00NzQsNyArNDc0LDcgQEAgc3RhdGljIGludCB1
cGRhdGVfdmNwdV9jb250ZXh0KHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiB7CiAgICAgeGNf
aW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKICAgICBzdHJ1Y3QgeGNfc3JfeDg2X3B2X3Jlc3Rv
cmVfdmNwdSAqdmNwdTsKLSAgICB1bnNpZ25lZCBpOworICAgIHVuc2lnbmVkIGludCBpOwogICAg
IGludCByYyA9IDA7CiAKICAgICBmb3IgKCBpID0gMDsgaSA8IGN0eC0+eDg2X3B2LnJlc3RvcmUu
bnJfdmNwdXM7ICsraSApCkBAIC01MjcsNyArNTI3LDcgQEAgc3RhdGljIGludCB1cGRhdGVfZ3Vl
c3RfcDJtKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4
Y2ggPSBjdHgtPnhjaDsKICAgICB4ZW5fcGZuX3QgbWZuLCBwZm4sICpndWVzdF9wMm0gPSBOVUxM
OwotICAgIHVuc2lnbmVkIGk7CisgICAgdW5zaWduZWQgaW50IGk7CiAgICAgaW50IHJjID0gLTE7
CiAKICAgICBmb3IgKCBpID0gMDsgaSA8IGN0eC0+eDg2X3B2LnAybV9mcmFtZXM7ICsraSApCkBA
IC01NjIsNyArNTYyLDcgQEAgc3RhdGljIGludCB1cGRhdGVfZ3Vlc3RfcDJtKHN0cnVjdCB4Y19z
cl9jb250ZXh0ICpjdHgpCiAKICAgICBndWVzdF9wMm0gPSB4Y19tYXBfZm9yZWlnbl9wYWdlcyh4
Y2gsIGN0eC0+ZG9taWQsIFBST1RfV1JJVEUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY3R4LT54ODZfcHYucDJtX3BmbnMsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY3R4LT54ODZfcHYucDJtX2ZyYW1lcyApOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGN0eC0+eDg2X3B2LnAybV9mcmFtZXMpOwogICAgIGlmICggIWd1
ZXN0X3AybSApCiAgICAgewogICAgICAgICBQRVJST1IoIkZhaWxlZCB0byBtYXAgcDJtIGZyYW1l
cyIpOwpAQCAtNTcyLDYgKzU3Miw3IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2d1ZXN0X3AybShzdHJ1
Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAgIG1lbWNweShndWVzdF9wMm0sIGN0eC0+eDg2X3B2
LnAybSwKICAgICAgICAgICAgKGN0eC0+eDg2X3B2Lm1heF9wZm4gKyAxKSAqIGN0eC0+eDg2X3B2
LndpZHRoKTsKICAgICByYyA9IDA7CisKICBlcnI6CiAgICAgaWYgKCBndWVzdF9wMm0gKQogICAg
ICAgICBtdW5tYXAoZ3Vlc3RfcDJtLCBjdHgtPng4Nl9wdi5wMm1fZnJhbWVzICogUEFHRV9TSVpF
KTsKQEAgLTY3NSw3ICs2NzYsNyBAQCBzdGF0aWMgaW50IGhhbmRsZV94ODZfcHZfcDJtX2ZyYW1l
cyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LAogewogICAgIHhjX2ludGVyZmFjZSAqeGNoID0g
Y3R4LT54Y2g7CiAgICAgc3RydWN0IHhjX3NyX3JlY194ODZfcHZfcDJtX2ZyYW1lcyAqZGF0YSA9
IHJlYy0+ZGF0YTsKLSAgICB1bnNpZ25lZCBzdGFydCwgZW5kLCB4LCBmcHAgPSBQQUdFX1NJWkUg
LyBjdHgtPng4Nl9wdi53aWR0aDsKKyAgICB1bnNpZ25lZCBpbnQgc3RhcnQsIGVuZCwgeCwgZnBw
ID0gUEFHRV9TSVpFIC8gY3R4LT54ODZfcHYud2lkdGg7CiAgICAgaW50IHJjOwogCiAgICAgaWYg
KCAhY3R4LT54ODZfcHYucmVzdG9yZS5zZWVuX3B2X2luZm8gKQpAQCAtODYyLDcgKzg2Myw3IEBA
IHN0YXRpYyBpbnQgaGFuZGxlX3NoYXJlZF9pbmZvKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkICpyZWMp
CiB7CiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKLSAgICB1bnNpZ25lZCBpOwor
ICAgIHVuc2lnbmVkIGludCBpOwogICAgIGludCByYyA9IC0xOwogICAgIHNoYXJlZF9pbmZvX2Fu
eV90ICpndWVzdF9zaGluZm8gPSBOVUxMOwogICAgIGNvbnN0IHNoYXJlZF9pbmZvX2FueV90ICpv
bGRfc2hpbmZvID0gcmVjLT5kYXRhOwpAQCAtOTA0LDggKzkwNSw4IEBAIHN0YXRpYyBpbnQgaGFu
ZGxlX3NoYXJlZF9pbmZvKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsCiAgICAgTUVNU0VUX0FS
UkFZX0ZJRUxEKGd1ZXN0X3NoaW5mbywgZXZ0Y2huX21hc2ssIDB4ZmYsIGN0eC0+eDg2X3B2Lndp
ZHRoKTsKIAogICAgIHJjID0gMDsKLSBlcnI6CiAKKyBlcnI6CiAgICAgaWYgKCBndWVzdF9zaGlu
Zm8gKQogICAgICAgICBtdW5tYXAoZ3Vlc3Rfc2hpbmZvLCBQQUdFX1NJWkUpOwogCkBAIC05NTIs
NyArOTUzLDcgQEAgc3RhdGljIGludCB4ODZfcHZfbG9jYWxpc2VfcGFnZShzdHJ1Y3QgeGNfc3Jf
Y29udGV4dCAqY3R4LAogICAgIHhjX2ludGVyZmFjZSAqeGNoID0gY3R4LT54Y2g7CiAgICAgdWlu
dDY0X3QgKnRhYmxlID0gcGFnZTsKICAgICB1aW50NjRfdCBwdGU7Ci0gICAgdW5zaWduZWQgaSwg
dG9fcG9wdWxhdGU7CisgICAgdW5zaWduZWQgaW50IGksIHRvX3BvcHVsYXRlOwogICAgIHhlbl9w
Zm5fdCBwZm5zWyhQQUdFX1NJWkUgLyBzaXplb2YodWludDY0X3QpKV07CiAKICAgICB0eXBlICY9
IFhFTl9ET01DVExfUEZJTkZPX0xUQUJUWVBFX01BU0s7CkBAIC0xMTM0LDcgKzExMzUsNyBAQCBz
dGF0aWMgaW50IHg4Nl9wdl9jbGVhbnVwKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAKICAg
ICBpZiAoIGN0eC0+eDg2X3B2LnJlc3RvcmUudmNwdXMgKQogICAgIHsKLSAgICAgICAgdW5zaWdu
ZWQgaTsKKyAgICAgICAgdW5zaWduZWQgaW50IGk7CiAKICAgICAgICAgZm9yICggaSA9IDA7IGkg
PCBjdHgtPng4Nl9wdi5yZXN0b3JlLm5yX3ZjcHVzOyArK2kgKQogICAgICAgICB7CmRpZmYgLS1n
aXQgYS90b29scy9saWJ4Yy94Y19zcl9zYXZlLmMgYi90b29scy9saWJ4Yy94Y19zcl9zYXZlLmMK
aW5kZXggMDY1MWZhOTJiYy4uZmE3MzZhMzExZiAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGMveGNf
c3Jfc2F2ZS5jCisrKyBiL3Rvb2xzL2xpYnhjL3hjX3NyX3NhdmUuYwpAQCAtMTAsMjAgKzEwLDE4
IEBAIHN0YXRpYyBpbnQgd3JpdGVfaGVhZGVycyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1
aW50MTZfdCBndWVzdF90eXBlKQogewogICAgIHhjX2ludGVyZmFjZSAqeGNoID0gY3R4LT54Y2g7
CiAgICAgaW50MzJfdCB4ZW5fdmVyc2lvbiA9IHhjX3ZlcnNpb24oeGNoLCBYRU5WRVJfdmVyc2lv
biwgTlVMTCk7Ci0gICAgc3RydWN0IHhjX3NyX2loZHIgaWhkciA9Ci0gICAgICAgIHsKLSAgICAg
ICAgICAgIC5tYXJrZXIgID0gSUhEUl9NQVJLRVIsCi0gICAgICAgICAgICAuaWQgICAgICA9IGh0
b25sKElIRFJfSUQpLAotICAgICAgICAgICAgLnZlcnNpb24gPSBodG9ubChJSERSX1ZFUlNJT04p
LAotICAgICAgICAgICAgLm9wdGlvbnMgPSBodG9ucyhJSERSX09QVF9MSVRUTEVfRU5ESUFOKSwK
LSAgICAgICAgfTsKLSAgICBzdHJ1Y3QgeGNfc3JfZGhkciBkaGRyID0KLSAgICAgICAgewotICAg
ICAgICAgICAgLnR5cGUgICAgICAgPSBndWVzdF90eXBlLAotICAgICAgICAgICAgLnBhZ2Vfc2hp
ZnQgPSBYQ19QQUdFX1NISUZULAotICAgICAgICAgICAgLnhlbl9tYWpvciAgPSAoeGVuX3ZlcnNp
b24gPj4gMTYpICYgMHhmZmZmLAotICAgICAgICAgICAgLnhlbl9taW5vciAgPSAoeGVuX3ZlcnNp
b24pICAgICAgICYgMHhmZmZmLAotICAgICAgICB9OworICAgIHN0cnVjdCB4Y19zcl9paGRyIGlo
ZHIgPSB7CisgICAgICAgIC5tYXJrZXIgID0gSUhEUl9NQVJLRVIsCisgICAgICAgIC5pZCAgICAg
ID0gaHRvbmwoSUhEUl9JRCksCisgICAgICAgIC52ZXJzaW9uID0gaHRvbmwoSUhEUl9WRVJTSU9O
KSwKKyAgICAgICAgLm9wdGlvbnMgPSBodG9ucyhJSERSX09QVF9MSVRUTEVfRU5ESUFOKSwKKyAg
ICB9OworICAgIHN0cnVjdCB4Y19zcl9kaGRyIGRoZHIgPSB7CisgICAgICAgIC50eXBlICAgICAg
ID0gZ3Vlc3RfdHlwZSwKKyAgICAgICAgLnBhZ2Vfc2hpZnQgPSBYQ19QQUdFX1NISUZULAorICAg
ICAgICAueGVuX21ham9yICA9ICh4ZW5fdmVyc2lvbiA+PiAxNikgJiAweGZmZmYsCisgICAgICAg
IC54ZW5fbWlub3IgID0gKHhlbl92ZXJzaW9uKSAgICAgICAmIDB4ZmZmZiwKKyAgICB9OwogCiAg
ICAgaWYgKCB4ZW5fdmVyc2lvbiA8IDAgKQogICAgIHsKQEAgLTUxLDcgKzQ5LDcgQEAgc3RhdGlj
IGludCB3cml0ZV9oZWFkZXJzKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVpbnQxNl90IGd1
ZXN0X3R5cGUpCiAgKi8KIHN0YXRpYyBpbnQgd3JpdGVfZW5kX3JlY29yZChzdHJ1Y3QgeGNfc3Jf
Y29udGV4dCAqY3R4KQogewotICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgZW5kID0geyBSRUNfVFlQ
RV9FTkQsIDAsIE5VTEwgfTsKKyAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIGVuZCA9IHsgLnR5cGUg
PSBSRUNfVFlQRV9FTkQgfTsKIAogICAgIHJldHVybiB3cml0ZV9yZWNvcmQoY3R4LCAmZW5kKTsK
IH0KQEAgLTYxLDcgKzU5LDcgQEAgc3RhdGljIGludCB3cml0ZV9lbmRfcmVjb3JkKHN0cnVjdCB4
Y19zcl9jb250ZXh0ICpjdHgpCiAgKi8KIHN0YXRpYyBpbnQgd3JpdGVfY2hlY2twb2ludF9yZWNv
cmQoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHsKLSAgICBzdHJ1Y3QgeGNfc3JfcmVjb3Jk
IGNoZWNrcG9pbnQgPSB7IFJFQ19UWVBFX0NIRUNLUE9JTlQsIDAsIE5VTEwgfTsKKyAgICBzdHJ1
Y3QgeGNfc3JfcmVjb3JkIGNoZWNrcG9pbnQgPSB7IC50eXBlID0gUkVDX1RZUEVfQ0hFQ0tQT0lO
VCB9OwogCiAgICAgcmV0dXJuIHdyaXRlX3JlY29yZChjdHgsICZjaGVja3BvaW50KTsKIH0KQEAg
LTg0LDE0ICs4MiwxMyBAQCBzdGF0aWMgaW50IHdyaXRlX2JhdGNoKHN0cnVjdCB4Y19zcl9jb250
ZXh0ICpjdHgpCiAgICAgdm9pZCAqKmd1ZXN0X2RhdGEgPSBOVUxMOwogICAgIHZvaWQgKipsb2Nh
bF9wYWdlcyA9IE5VTEw7CiAgICAgaW50ICplcnJvcnMgPSBOVUxMLCByYyA9IC0xOwotICAgIHVu
c2lnbmVkIGksIHAsIG5yX3BhZ2VzID0gMCwgbnJfcGFnZXNfbWFwcGVkID0gMDsKLSAgICB1bnNp
Z25lZCBucl9wZm5zID0gY3R4LT5zYXZlLm5yX2JhdGNoX3BmbnM7CisgICAgdW5zaWduZWQgaW50
IGksIHAsIG5yX3BhZ2VzID0gMCwgbnJfcGFnZXNfbWFwcGVkID0gMDsKKyAgICB1bnNpZ25lZCBp
bnQgbnJfcGZucyA9IGN0eC0+c2F2ZS5ucl9iYXRjaF9wZm5zOwogICAgIHZvaWQgKnBhZ2UsICpv
cmlnX3BhZ2U7CiAgICAgdWludDY0X3QgKnJlY19wZm5zID0gTlVMTDsKICAgICBzdHJ1Y3QgaW92
ZWMgKmlvdiA9IE5VTEw7IGludCBpb3ZjbnQgPSAwOwogICAgIHN0cnVjdCB4Y19zcl9yZWNfcGFn
ZV9kYXRhX2hlYWRlciBoZHIgPSB7IDAgfTsKLSAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIHJlYyA9
Ci0gICAgeworICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0gewogICAgICAgICAudHlwZSA9
IFJFQ19UWVBFX1BBR0VfREFUQSwKICAgICB9OwogCkBAIC0xNTMsOCArMTUwLDggQEAgc3RhdGlj
IGludCB3cml0ZV9iYXRjaChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogCiAgICAgaWYgKCBu
cl9wYWdlcyA+IDAgKQogICAgIHsKLSAgICAgICAgZ3Vlc3RfbWFwcGluZyA9IHhlbmZvcmVpZ25t
ZW1vcnlfbWFwKHhjaC0+Zm1lbSwKLSAgICAgICAgICAgIGN0eC0+ZG9taWQsIFBST1RfUkVBRCwg
bnJfcGFnZXMsIG1mbnMsIGVycm9ycyk7CisgICAgICAgIGd1ZXN0X21hcHBpbmcgPSB4ZW5mb3Jl
aWdubWVtb3J5X21hcCgKKyAgICAgICAgICAgIHhjaC0+Zm1lbSwgY3R4LT5kb21pZCwgUFJPVF9S
RUFELCBucl9wYWdlcywgbWZucywgZXJyb3JzKTsKICAgICAgICAgaWYgKCAhZ3Vlc3RfbWFwcGlu
ZyApCiAgICAgICAgIHsKICAgICAgICAgICAgIFBFUlJPUigiRmFpbGVkIHRvIG1hcCBndWVzdCBw
YWdlcyIpOwpAQCAtNDgxLDcgKzQ3OCw3IEBAIHN0YXRpYyBpbnQgdXBkYXRlX3Byb2dyZXNzX3N0
cmluZyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCBjaGFyICoqc3RyKQogc3RhdGljIGludCBz
aW1wbGVfcHJlY29weV9wb2xpY3koc3RydWN0IHByZWNvcHlfc3RhdHMgc3RhdHMsIHZvaWQgKnVz
ZXIpCiB7CiAgICAgcmV0dXJuICgoc3RhdHMuZGlydHlfY291bnQgPj0gMCAmJgotICAgICAgICAg
ICAgc3RhdHMuZGlydHlfY291bnQgPCBTUFBfVEFSR0VUX0RJUlRZX0NPVU5UKSB8fAorICAgICAg
ICAgICAgIHN0YXRzLmRpcnR5X2NvdW50IDwgU1BQX1RBUkdFVF9ESVJUWV9DT1VOVCkgfHwKICAg
ICAgICAgICAgIHN0YXRzLml0ZXJhdGlvbiA+PSBTUFBfTUFYX0lURVJBVElPTlMpCiAgICAgICAg
ID8gWEdTX1BPTElDWV9TVE9QX0FORF9DT1BZCiAgICAgICAgIDogWEdTX1BPTElDWV9DT05USU5V
RV9QUkVDT1BZOwpAQCAtNTExLDEyICs1MDgsMTMgQEAgc3RhdGljIGludCBzZW5kX21lbW9yeV9s
aXZlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAgICAgaWYgKCByYyApCiAgICAgICAgIGdv
dG8gb3V0OwogCi0gICAgY3R4LT5zYXZlLnN0YXRzID0gKHN0cnVjdCBwcmVjb3B5X3N0YXRzKQot
ICAgICAgICB7IC5kaXJ0eV9jb3VudCAgID0gY3R4LT5zYXZlLnAybV9zaXplIH07CisgICAgY3R4
LT5zYXZlLnN0YXRzID0gKHN0cnVjdCBwcmVjb3B5X3N0YXRzKXsKKyAgICAgICAgLmRpcnR5X2Nv
dW50ID0gY3R4LT5zYXZlLnAybV9zaXplLAorICAgIH07CiAgICAgcG9saWN5X3N0YXRzID0gJmN0
eC0+c2F2ZS5zdGF0czsKIAogICAgIGlmICggcHJlY29weV9wb2xpY3kgPT0gTlVMTCApCi0gICAg
ICAgICBwcmVjb3B5X3BvbGljeSA9IHNpbXBsZV9wcmVjb3B5X3BvbGljeTsKKyAgICAgICAgcHJl
Y29weV9wb2xpY3kgPSBzaW1wbGVfcHJlY29weV9wb2xpY3k7CiAKICAgICBiaXRtYXBfc2V0KGRp
cnR5X2JpdG1hcCwgY3R4LT5zYXZlLnAybV9zaXplKTsKIApAQCAtNTQ2LDcgKzU0NCw3IEBAIHN0
YXRpYyBpbnQgc2VuZF9tZW1vcnlfbGl2ZShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAg
ICAgICBwb2xpY3lfZGVjaXNpb24gPSBwcmVjb3B5X3BvbGljeSgqcG9saWN5X3N0YXRzLCBkYXRh
KTsKIAogICAgICAgICBpZiAoIHBvbGljeV9kZWNpc2lvbiAhPSBYR1NfUE9MSUNZX0NPTlRJTlVF
X1BSRUNPUFkgKQotICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIGJyZWFrOwogCiAgICAg
ICAgIGlmICggeGNfc2hhZG93X2NvbnRyb2woCiAgICAgICAgICAgICAgICAgIHhjaCwgY3R4LT5k
b21pZCwgWEVOX0RPTUNUTF9TSEFET1dfT1BfQ0xFQU4sCkBAIC01NzEsMTAgKzU2OSwxMCBAQCBz
dGF0aWMgaW50IHNlbmRfbWVtb3J5X2xpdmUoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHN0
YXRpYyBpbnQgY29sb19tZXJnZV9zZWNvbmRhcnlfZGlydHlfYml0bWFwKHN0cnVjdCB4Y19zcl9j
b250ZXh0ICpjdHgpCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKLSAgICBz
dHJ1Y3QgeGNfc3JfcmVjb3JkIHJlYyA9IHsgMCwgMCwgTlVMTCB9OworICAgIHN0cnVjdCB4Y19z
cl9yZWNvcmQgcmVjOwogICAgIHVpbnQ2NF90ICpwZm5zID0gTlVMTDsKICAgICB1aW50NjRfdCBw
Zm47Ci0gICAgdW5zaWduZWQgY291bnQsIGk7CisgICAgdW5zaWduZWQgaW50IGNvdW50LCBpOwog
ICAgIGludCByYzsKICAgICBERUNMQVJFX0hZUEVSQ0FMTF9CVUZGRVJfU0hBRE9XKHVuc2lnbmVk
IGxvbmcsIGRpcnR5X2JpdG1hcCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZjdHgtPnNhdmUuZGlydHlfYml0bWFwX2hidWYpOwpAQCAtNTg1LDE0ICs1ODMsMTQgQEAgc3Rh
dGljIGludCBjb2xvX21lcmdlX3NlY29uZGFyeV9kaXJ0eV9iaXRtYXAoc3RydWN0IHhjX3NyX2Nv
bnRleHQgKmN0eCkKIAogICAgIGlmICggcmVjLnR5cGUgIT0gUkVDX1RZUEVfQ0hFQ0tQT0lOVF9E
SVJUWV9QRk5fTElTVCApCiAgICAgewotICAgICAgICBQRVJST1IoIkV4cGVjdCBkaXJ0eSBiaXRt
YXAgcmVjb3JkLCBidXQgcmVjZWl2ZWQgJXUiLCByZWMudHlwZSApOworICAgICAgICBQRVJST1Io
IkV4cGVjdCBkaXJ0eSBiaXRtYXAgcmVjb3JkLCBidXQgcmVjZWl2ZWQgJXUiLCByZWMudHlwZSk7
CiAgICAgICAgIHJjID0gLTE7CiAgICAgICAgIGdvdG8gZXJyOwogICAgIH0KIAogICAgIGlmICgg
cmVjLmxlbmd0aCAlIHNpemVvZigqcGZucykgKQogICAgIHsKLSAgICAgICAgUEVSUk9SKCJJbnZh
bGlkIGRpcnR5IHBmbiBsaXN0IHJlY29yZCBsZW5ndGggJXUiLCByZWMubGVuZ3RoICk7CisgICAg
ICAgIFBFUlJPUigiSW52YWxpZCBkaXJ0eSBwZm4gbGlzdCByZWNvcmQgbGVuZ3RoICV1IiwgcmVj
Lmxlbmd0aCk7CiAgICAgICAgIHJjID0gLTE7CiAgICAgICAgIGdvdG8gZXJyOwogICAgIH0KQEAg
LTYwMyw3ICs2MDEsNyBAQCBzdGF0aWMgaW50IGNvbG9fbWVyZ2Vfc2Vjb25kYXJ5X2RpcnR5X2Jp
dG1hcChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAgIGZvciAoIGkgPSAwOyBpIDwgY291
bnQ7IGkrKyApCiAgICAgewogICAgICAgICBwZm4gPSBwZm5zW2ldOwotICAgICAgICBpZiAocGZu
ID4gY3R4LT5zYXZlLnAybV9zaXplKQorICAgICAgICBpZiAoIHBmbiA+IGN0eC0+c2F2ZS5wMm1f
c2l6ZSApCiAgICAgICAgIHsKICAgICAgICAgICAgIFBFUlJPUigiSW52YWxpZCBwZm4gMHglIiBQ
Ukl4NjQsIHBmbik7CiAgICAgICAgICAgICByYyA9IC0xOwpAQCAtNjg4LDExICs2ODYsNyBAQCBz
dGF0aWMgaW50IHZlcmlmeV9mcmFtZXMoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKICAgICB4
Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogICAgIHhjX3NoYWRvd19vcF9zdGF0c190IHN0
YXRzID0geyAwLCBjdHgtPnNhdmUucDJtX3NpemUgfTsKICAgICBpbnQgcmM7Ci0gICAgc3RydWN0
IHhjX3NyX3JlY29yZCByZWMgPQotICAgIHsKLSAgICAgICAgLnR5cGUgPSBSRUNfVFlQRV9WRVJJ
RlksCi0gICAgICAgIC5sZW5ndGggPSAwLAotICAgIH07CisgICAgc3RydWN0IHhjX3NyX3JlY29y
ZCByZWMgPSB7IC50eXBlID0gUkVDX1RZUEVfVkVSSUZZIH07CiAKICAgICBEUFJJTlRGKCJFbmFi
bGluZyB2ZXJpZnkgbW9kZSIpOwogCkBAIC03NDgsNyArNzQyLDcgQEAgc3RhdGljIGludCBzZW5k
X2RvbWFpbl9tZW1vcnlfbGl2ZShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogICAgICAgICAg
ICAgZ290byBvdXQ7CiAgICAgfQogCi0gIG91dDoKKyBvdXQ6CiAgICAgcmV0dXJuIHJjOwogfQog
CkBAIC03OTUsNyArNzg5LDcgQEAgc3RhdGljIGludCBzZXR1cChzdHJ1Y3QgeGNfc3JfY29udGV4
dCAqY3R4KQogICAgICAgICBnb3RvIGVycjsKIAogICAgIGRpcnR5X2JpdG1hcCA9IHhjX2h5cGVy
Y2FsbF9idWZmZXJfYWxsb2NfcGFnZXMoCi0gICAgICAgICAgICAgICAgICAgeGNoLCBkaXJ0eV9i
aXRtYXAsIE5SUEFHRVMoYml0bWFwX3NpemUoY3R4LT5zYXZlLnAybV9zaXplKSkpOworICAgICAg
ICB4Y2gsIGRpcnR5X2JpdG1hcCwgTlJQQUdFUyhiaXRtYXBfc2l6ZShjdHgtPnNhdmUucDJtX3Np
emUpKSk7CiAgICAgY3R4LT5zYXZlLmJhdGNoX3BmbnMgPSBtYWxsb2MoTUFYX0JBVENIX1NJWkUg
KgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZigqY3R4LT5zYXZlLmJh
dGNoX3BmbnMpKTsKICAgICBjdHgtPnNhdmUuZGVmZXJyZWRfcGFnZXMgPSBjYWxsb2MoMSwgYml0
bWFwX3NpemUoY3R4LT5zYXZlLnAybV9zaXplKSk7CkBAIC05NjYsNyArOTYwLDcgQEAgc3RhdGlj
IGludCBzYXZlKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVpbnQxNl90IGd1ZXN0X3R5cGUp
CiB9OwogCiBpbnQgeGNfZG9tYWluX3NhdmUoeGNfaW50ZXJmYWNlICp4Y2gsIGludCBpb19mZCwg
dWludDMyX3QgZG9tLAotICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGZsYWdzLCBzdHJ1Y3Qg
c2F2ZV9jYWxsYmFja3MqIGNhbGxiYWNrcywKKyAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBm
bGFncywgc3RydWN0IHNhdmVfY2FsbGJhY2tzICpjYWxsYmFja3MsCiAgICAgICAgICAgICAgICAg
ICAgeGNfc3RyZWFtX3R5cGVfdCBzdHJlYW1fdHlwZSwgaW50IHJlY3ZfZmQpCiB7CiAgICAgc3Ry
dWN0IHhjX3NyX2NvbnRleHQgY3R4ID0gewpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfc3Jf
c2F2ZV94ODZfaHZtLmMgYi90b29scy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9odm0uYwppbmRleCA5
MGZmMzVhNDM5Li4zZDg2Y2IwNjAwIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94Y19zcl9zYXZl
X3g4Nl9odm0uYworKysgYi90b29scy9saWJ4Yy94Y19zcl9zYXZlX3g4Nl9odm0uYwpAQCAtMTEs
OCArMTEsNyBAQCBzdGF0aWMgaW50IHdyaXRlX2h2bV9jb250ZXh0KHN0cnVjdCB4Y19zcl9jb250
ZXh0ICpjdHgpCiB7CiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBjdHgtPnhjaDsKICAgICBpbnQg
cmMsIGh2bV9idWZfc2l6ZTsKLSAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIGh2bV9yZWMgPQotICAg
IHsKKyAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIGh2bV9yZWMgPSB7CiAgICAgICAgIC50eXBlID0g
UkVDX1RZUEVfSFZNX0NPTlRFWFQsCiAgICAgfTsKIApAQCAtMTM0LDcgKzEzMyw2IEBAIHN0YXRp
YyB4ZW5fcGZuX3QgeDg2X2h2bV9wZm5fdG9fZ2ZuKGNvbnN0IHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgsCiBzdGF0aWMgaW50IHg4Nl9odm1fbm9ybWFsaXNlX3BhZ2Uoc3RydWN0IHhjX3NyX2Nv
bnRleHQgKmN0eCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5fcGZuX3Qg
dHlwZSwgdm9pZCAqKnBhZ2UpCiB7Ci0gICAgLyogbm8tb3AgKi8KICAgICByZXR1cm4gMDsKIH0K
IApAQCAtMTc0LDE5ICsxNzIsMTYgQEAgc3RhdGljIGludCB4ODZfaHZtX3NldHVwKHN0cnVjdCB4
Y19zcl9jb250ZXh0ICpjdHgpCiAKIHN0YXRpYyBpbnQgeDg2X2h2bV9zdGFydF9vZl9zdHJlYW0o
c3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHsKLSAgICAvKiBuby1vcCAqLwogICAgIHJldHVy
biAwOwogfQogCiBzdGF0aWMgaW50IHg4Nl9odm1fc3RhcnRfb2ZfY2hlY2twb2ludChzdHJ1Y3Qg
eGNfc3JfY29udGV4dCAqY3R4KQogewotICAgIC8qIG5vLW9wICovCiAgICAgcmV0dXJuIDA7CiB9
CiAKIHN0YXRpYyBpbnQgeDg2X2h2bV9jaGVja192bV9zdGF0ZShzdHJ1Y3QgeGNfc3JfY29udGV4
dCAqY3R4KQogewotICAgIC8qIG5vLW9wICovCiAgICAgcmV0dXJuIDA7CiB9CiAKZGlmZiAtLWdp
dCBhL3Rvb2xzL2xpYnhjL3hjX3NyX3NhdmVfeDg2X3B2LmMgYi90b29scy9saWJ4Yy94Y19zcl9z
YXZlX3g4Nl9wdi5jCmluZGV4IDA5YjZlZmVlZTMuLjNlYmM1YTJiZjggMTAwNjQ0Ci0tLSBhL3Rv
b2xzL2xpYnhjL3hjX3NyX3NhdmVfeDg2X3B2LmMKKysrIGIvdG9vbHMvbGlieGMveGNfc3Jfc2F2
ZV94ODZfcHYuYwpAQCAtODAsNyArODAsNyBAQCBzdGF0aWMgaW50IG1hcF9wMm1fbGVhdmVzKHN0
cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHhlbl9wZm5fdCAqbWZucywKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2l6ZV90IG5fbWZucykKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0
eC0+eGNoOwotICAgIHVuc2lnbmVkIHg7CisgICAgdW5zaWduZWQgaW50IHg7CiAKICAgICBjdHgt
Png4Nl9wdi5wMm0gPSB4Y19tYXBfZm9yZWlnbl9wYWdlcyh4Y2gsIGN0eC0+ZG9taWQsIFBST1Rf
UkVBRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5zLCBu
X21mbnMpOwpAQCAtMTMzLDcgKzEzMyw3IEBAIHN0YXRpYyBpbnQgbWFwX3AybV90cmVlKHN0cnVj
dCB4Y19zcl9jb250ZXh0ICpjdHgpCiAgICAgICovCiAgICAgeGNfaW50ZXJmYWNlICp4Y2ggPSBj
dHgtPnhjaDsKICAgICBpbnQgcmMgPSAtMTsKLSAgICB1bnNpZ25lZCB4LCBzYXZlZF94LCBmcHAs
IGZsbF9lbnRyaWVzLCBmbF9lbnRyaWVzOworICAgIHVuc2lnbmVkIGludCB4LCBzYXZlZF94LCBm
cHAsIGZsbF9lbnRyaWVzLCBmbF9lbnRyaWVzOwogICAgIHhlbl9wZm5fdCBmbGxfbWZuLCBzYXZl
ZF9tZm4sIG1heF9wZm47CiAKICAgICB4ZW5fcGZuX3QgKmxvY2FsX2ZsbCA9IE5VTEw7CkBAIC0y
NjAsOCArMjYwLDcgQEAgc3RhdGljIGludCBtYXBfcDJtX3RyZWUoc3RydWN0IHhjX3NyX2NvbnRl
eHQgKmN0eCkKICAgICAvKiBNYXAgdGhlIHAybSBsZWF2ZXMgdGhlbXNlbHZlcy4gKi8KICAgICBy
YyA9IG1hcF9wMm1fbGVhdmVzKGN0eCwgbG9jYWxfZmwsIGZsX2VudHJpZXMpOwogCi1lcnI6Ci0K
KyBlcnI6CiAgICAgZnJlZShsb2NhbF9mbCk7CiAgICAgaWYgKCBndWVzdF9mbCApCiAgICAgICAg
IG11bm1hcChndWVzdF9mbCwgZmxsX2VudHJpZXMgKiBQQUdFX1NJWkUpOwpAQCAtMzE4LDcgKzMx
Nyw3IEBAIHN0YXRpYyBpbnQgbWFwX3AybV9saXN0KHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgs
IHVpbnQ2NF90IHAybV9jcjMpCiAgICAgeGVuX3Bmbl90IHAybV9tZm4sIG1mbiwgc2F2ZWRfbWZu
LCBtYXhfcGZuOwogICAgIHVpbnQ2NF90ICpwdGVzID0gTlVMTDsKICAgICB4ZW5fcGZuX3QgKm1m
bnMgPSBOVUxMOwotICAgIHVuc2lnbmVkIGZwcCwgbl9wYWdlcywgbGV2ZWwsIHNoaWZ0LCBpZHhf
c3RhcnQsIGlkeF9lbmQsIGlkeCwgc2F2ZWRfaWR4OworICAgIHVuc2lnbmVkIGludCBmcHAsIG5f
cGFnZXMsIGxldmVsLCBzaGlmdCwgaWR4X3N0YXJ0LCBpZHhfZW5kLCBpZHgsIHNhdmVkX2lkeDsK
ICAgICBpbnQgcmMgPSAtMTsKIAogICAgIHAybV9tZm4gPSBjcjNfdG9fbWZuKGN0eCwgcDJtX2Ny
Myk7CkBAIC00NTAsNyArNDQ5LDcgQEAgc3RhdGljIGludCBtYXBfcDJtX2xpc3Qoc3RydWN0IHhj
X3NyX2NvbnRleHQgKmN0eCwgdWludDY0X3QgcDJtX2NyMykKICAgICAvKiBNYXAgdGhlIHAybSBs
ZWF2ZXMgdGhlbXNlbHZlcy4gKi8KICAgICByYyA9IG1hcF9wMm1fbGVhdmVzKGN0eCwgbWZucywg
aWR4X2VuZCAtIGlkeF9zdGFydCArIDEpOwogCi1lcnI6CisgZXJyOgogICAgIGZyZWUobWZucyk7
CiAgICAgaWYgKCBwdGVzICkKICAgICAgICAgbXVubWFwKHB0ZXMsIG5fcGFnZXMgKiBQQUdFX1NJ
WkUpOwpAQCAtNDgzLDE1ICs0ODIsMTMgQEAgc3RhdGljIGludCB3cml0ZV9vbmVfdmNwdV9iYXNp
YyhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1aW50MzJfdCBpZCkKIHsKICAgICB4Y19pbnRl
cmZhY2UgKnhjaCA9IGN0eC0+eGNoOwogICAgIHhlbl9wZm5fdCBtZm4sIHBmbjsKLSAgICB1bnNp
Z25lZCBpLCBnZHRfY291bnQ7CisgICAgdW5zaWduZWQgaW50IGksIGdkdF9jb3VudDsKICAgICBp
bnQgcmMgPSAtMTsKICAgICB2Y3B1X2d1ZXN0X2NvbnRleHRfYW55X3QgdmNwdTsKLSAgICBzdHJ1
Y3QgeGNfc3JfcmVjX3g4Nl9wdl92Y3B1X2hkciB2aGRyID0KLSAgICB7CisgICAgc3RydWN0IHhj
X3NyX3JlY194ODZfcHZfdmNwdV9oZHIgdmhkciA9IHsKICAgICAgICAgLnZjcHVfaWQgPSBpZCwK
ICAgICB9OwotICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0KLSAgICB7CisgICAgc3RydWN0
IHhjX3NyX3JlY29yZCByZWMgPSB7CiAgICAgICAgIC50eXBlID0gUkVDX1RZUEVfWDg2X1BWX1ZD
UFVfQkFTSUMsCiAgICAgICAgIC5sZW5ndGggPSBzaXplb2YodmhkciksCiAgICAgICAgIC5kYXRh
ID0gJnZoZHIsCkBAIC01ODYsMTggKzU4MywxNSBAQCBzdGF0aWMgaW50IHdyaXRlX29uZV92Y3B1
X2Jhc2ljKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgsIHVpbnQzMl90IGlkKQogc3RhdGljIGlu
dCB3cml0ZV9vbmVfdmNwdV9leHRlbmRlZChzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCB1aW50
MzJfdCBpZCkKIHsKICAgICB4Y19pbnRlcmZhY2UgKnhjaCA9IGN0eC0+eGNoOwotICAgIHN0cnVj
dCB4Y19zcl9yZWNfeDg2X3B2X3ZjcHVfaGRyIHZoZHIgPQotICAgIHsKKyAgICBzdHJ1Y3QgeGNf
c3JfcmVjX3g4Nl9wdl92Y3B1X2hkciB2aGRyID0gewogICAgICAgICAudmNwdV9pZCA9IGlkLAog
ICAgIH07Ci0gICAgc3RydWN0IHhjX3NyX3JlY29yZCByZWMgPQotICAgIHsKKyAgICBzdHJ1Y3Qg
eGNfc3JfcmVjb3JkIHJlYyA9IHsKICAgICAgICAgLnR5cGUgPSBSRUNfVFlQRV9YODZfUFZfVkNQ
VV9FWFRFTkRFRCwKICAgICAgICAgLmxlbmd0aCA9IHNpemVvZih2aGRyKSwKICAgICAgICAgLmRh
dGEgPSAmdmhkciwKICAgICB9OwotICAgIHN0cnVjdCB4ZW5fZG9tY3RsIGRvbWN0bCA9Ci0gICAg
eworICAgIHN0cnVjdCB4ZW5fZG9tY3RsIGRvbWN0bCA9IHsKICAgICAgICAgLmNtZCA9IFhFTl9E
T01DVExfZ2V0X2V4dF92Y3B1Y29udGV4dCwKICAgICAgICAgLmRvbWFpbiA9IGN0eC0+ZG9taWQs
CiAgICAgICAgIC51LmV4dF92Y3B1Y29udGV4dC52Y3B1ID0gaWQsCkBAIC02MjYsMTggKzYyMCwx
NSBAQCBzdGF0aWMgaW50IHdyaXRlX29uZV92Y3B1X3hzYXZlKHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgsIHVpbnQzMl90IGlkKQogICAgIHhjX2ludGVyZmFjZSAqeGNoID0gY3R4LT54Y2g7CiAg
ICAgaW50IHJjID0gLTE7CiAgICAgREVDTEFSRV9IWVBFUkNBTExfQlVGRkVSKHZvaWQsIGJ1ZmZl
cik7Ci0gICAgc3RydWN0IHhjX3NyX3JlY194ODZfcHZfdmNwdV9oZHIgdmhkciA9Ci0gICAgewor
ICAgIHN0cnVjdCB4Y19zcl9yZWNfeDg2X3B2X3ZjcHVfaGRyIHZoZHIgPSB7CiAgICAgICAgIC52
Y3B1X2lkID0gaWQsCiAgICAgfTsKLSAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIHJlYyA9Ci0gICAg
eworICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0gewogICAgICAgICAudHlwZSA9IFJFQ19U
WVBFX1g4Nl9QVl9WQ1BVX1hTQVZFLAogICAgICAgICAubGVuZ3RoID0gc2l6ZW9mKHZoZHIpLAog
ICAgICAgICAuZGF0YSA9ICZ2aGRyLAogICAgIH07Ci0gICAgc3RydWN0IHhlbl9kb21jdGwgZG9t
Y3RsID0KLSAgICB7CisgICAgc3RydWN0IHhlbl9kb21jdGwgZG9tY3RsID0gewogICAgICAgICAu
Y21kID0gWEVOX0RPTUNUTF9nZXR2Y3B1ZXh0c3RhdGUsCiAgICAgICAgIC5kb21haW4gPSBjdHgt
PmRvbWlkLAogICAgICAgICAudS52Y3B1ZXh0c3RhdGUudmNwdSA9IGlkLApAQCAtNjk1LDE4ICs2
ODYsMTUgQEAgc3RhdGljIGludCB3cml0ZV9vbmVfdmNwdV9tc3JzKHN0cnVjdCB4Y19zcl9jb250
ZXh0ICpjdHgsIHVpbnQzMl90IGlkKQogICAgIGludCByYyA9IC0xOwogICAgIHNpemVfdCBidWZm
ZXJzejsKICAgICBERUNMQVJFX0hZUEVSQ0FMTF9CVUZGRVIodm9pZCwgYnVmZmVyKTsKLSAgICBz
dHJ1Y3QgeGNfc3JfcmVjX3g4Nl9wdl92Y3B1X2hkciB2aGRyID0KLSAgICB7CisgICAgc3RydWN0
IHhjX3NyX3JlY194ODZfcHZfdmNwdV9oZHIgdmhkciA9IHsKICAgICAgICAgLnZjcHVfaWQgPSBp
ZCwKICAgICB9OwotICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0KLSAgICB7CisgICAgc3Ry
dWN0IHhjX3NyX3JlY29yZCByZWMgPSB7CiAgICAgICAgIC50eXBlID0gUkVDX1RZUEVfWDg2X1BW
X1ZDUFVfTVNSUywKICAgICAgICAgLmxlbmd0aCA9IHNpemVvZih2aGRyKSwKICAgICAgICAgLmRh
dGEgPSAmdmhkciwKICAgICB9OwotICAgIHN0cnVjdCB4ZW5fZG9tY3RsIGRvbWN0bCA9Ci0gICAg
eworICAgIHN0cnVjdCB4ZW5fZG9tY3RsIGRvbWN0bCA9IHsKICAgICAgICAgLmNtZCA9IFhFTl9E
T01DVExfZ2V0X3ZjcHVfbXNycywKICAgICAgICAgLmRvbWFpbiA9IGN0eC0+ZG9taWQsCiAgICAg
ICAgIC51LnZjcHVfbXNycy52Y3B1ID0gaWQsCkBAIC04MDUsMTcgKzc5MywxNSBAQCBzdGF0aWMg
aW50IHdyaXRlX2FsbF92Y3B1X2luZm9ybWF0aW9uKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgp
CiAgKi8KIHN0YXRpYyBpbnQgd3JpdGVfeDg2X3B2X2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQg
KmN0eCkKIHsKLSAgICBzdHJ1Y3QgeGNfc3JfcmVjX3g4Nl9wdl9pbmZvIGluZm8gPQotICAgICAg
ICB7Ci0gICAgICAgICAgICAuZ3Vlc3Rfd2lkdGggPSBjdHgtPng4Nl9wdi53aWR0aCwKLSAgICAg
ICAgICAgIC5wdF9sZXZlbHMgPSBjdHgtPng4Nl9wdi5sZXZlbHMsCi0gICAgICAgIH07Ci0gICAg
c3RydWN0IHhjX3NyX3JlY29yZCByZWMgPQotICAgICAgICB7Ci0gICAgICAgICAgICAudHlwZSA9
IFJFQ19UWVBFX1g4Nl9QVl9JTkZPLAotICAgICAgICAgICAgLmxlbmd0aCA9IHNpemVvZihpbmZv
KSwKLSAgICAgICAgICAgIC5kYXRhID0gJmluZm8KLSAgICAgICAgfTsKKyAgICBzdHJ1Y3QgeGNf
c3JfcmVjX3g4Nl9wdl9pbmZvIGluZm8gPSB7CisgICAgICAgIC5ndWVzdF93aWR0aCA9IGN0eC0+
eDg2X3B2LndpZHRoLAorICAgICAgICAucHRfbGV2ZWxzID0gY3R4LT54ODZfcHYubGV2ZWxzLAor
ICAgIH07CisgICAgc3RydWN0IHhjX3NyX3JlY29yZCByZWMgPSB7CisgICAgICAgIC50eXBlID0g
UkVDX1RZUEVfWDg2X1BWX0lORk8sCisgICAgICAgIC5sZW5ndGggPSBzaXplb2YoaW5mbyksCisg
ICAgICAgIC5kYXRhID0gJmluZm8sCisgICAgfTsKIAogICAgIHJldHVybiB3cml0ZV9yZWNvcmQo
Y3R4LCAmcmVjKTsKIH0KQEAgLTgyNywyMCArODEzLDE3IEBAIHN0YXRpYyBpbnQgd3JpdGVfeDg2
X3B2X2luZm8oc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHN0YXRpYyBpbnQgd3JpdGVfeDg2
X3B2X3AybV9mcmFtZXMoc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKIHsKICAgICB4Y19pbnRl
cmZhY2UgKnhjaCA9IGN0eC0+eGNoOwotICAgIGludCByYzsgdW5zaWduZWQgaTsKKyAgICBpbnQg
cmM7IHVuc2lnbmVkIGludCBpOwogICAgIHNpemVfdCBkYXRhc3ogPSBjdHgtPng4Nl9wdi5wMm1f
ZnJhbWVzICogc2l6ZW9mKHVpbnQ2NF90KTsKICAgICB1aW50NjRfdCAqZGF0YSA9IE5VTEw7Ci0g
ICAgc3RydWN0IHhjX3NyX3JlY194ODZfcHZfcDJtX2ZyYW1lcyBoZHIgPQotICAgICAgICB7Ci0g
ICAgICAgICAgICAuc3RhcnRfcGZuID0gMCwKLSAgICAgICAgICAgIC5lbmRfcGZuID0gY3R4LT54
ODZfcHYubWF4X3BmbiwKLSAgICAgICAgfTsKLSAgICBzdHJ1Y3QgeGNfc3JfcmVjb3JkIHJlYyA9
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIC50eXBlID0gUkVDX1RZUEVfWDg2X1BWX1AyTV9GUkFN
RVMsCi0gICAgICAgICAgICAubGVuZ3RoID0gc2l6ZW9mKGhkciksCi0gICAgICAgICAgICAuZGF0
YSA9ICZoZHIsCi0gICAgICAgIH07CisgICAgc3RydWN0IHhjX3NyX3JlY194ODZfcHZfcDJtX2Zy
YW1lcyBoZHIgPSB7CisgICAgICAgIC5lbmRfcGZuID0gY3R4LT54ODZfcHYubWF4X3BmbiwKKyAg
ICB9OworICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQgcmVjID0geworICAgICAgICAudHlwZSA9IFJF
Q19UWVBFX1g4Nl9QVl9QMk1fRlJBTUVTLAorICAgICAgICAubGVuZ3RoID0gc2l6ZW9mKGhkciks
CisgICAgICAgIC5kYXRhID0gJmhkciwKKyAgICB9OwogCiAgICAgLyogTm8gbmVlZCB0byB0cmFu
c2xhdGUgaWYgc2l6ZW9mKHVpbnQ2NF90KSA9PSBzaXplb2YoeGVuX3Bmbl90KS4gKi8KICAgICBp
ZiAoIHNpemVvZih1aW50NjRfdCkgIT0gc2l6ZW9mKCpjdHgtPng4Nl9wdi5wMm1fcGZucykgKQpA
QCAtODcxLDggKzg1NCw3IEBAIHN0YXRpYyBpbnQgd3JpdGVfeDg2X3B2X3AybV9mcmFtZXMoc3Ry
dWN0IHhjX3NyX2NvbnRleHQgKmN0eCkKICAqLwogc3RhdGljIGludCB3cml0ZV9zaGFyZWRfaW5m
byhzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogewotICAgIHN0cnVjdCB4Y19zcl9yZWNvcmQg
cmVjID0KLSAgICB7CisgICAgc3RydWN0IHhjX3NyX3JlY29yZCByZWMgPSB7CiAgICAgICAgIC50
eXBlID0gUkVDX1RZUEVfU0hBUkVEX0lORk8sCiAgICAgICAgIC5sZW5ndGggPSBQQUdFX1NJWkUs
CiAgICAgICAgIC5kYXRhID0gY3R4LT54ODZfcHYuc2hpbmZvLApAQCAtODkwLDcgKzg3Miw3IEBA
IHN0YXRpYyBpbnQgbm9ybWFsaXNlX3BhZ2V0YWJsZShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4
LCBjb25zdCB1aW50NjRfdCAqc3JjLAogewogICAgIHhjX2ludGVyZmFjZSAqeGNoID0gY3R4LT54
Y2g7CiAgICAgdWludDY0X3QgcHRlOwotICAgIHVuc2lnbmVkIGksIHhlbl9maXJzdCA9IC0xLCB4
ZW5fbGFzdCA9IC0xOyAvKiBJbmRpY2VzIG9mIFhlbiBtYXBwaW5ncy4gKi8KKyAgICB1bnNpZ25l
ZCBpbnQgaSwgeGVuX2ZpcnN0ID0gLTEsIHhlbl9sYXN0ID0gLTE7IC8qIEluZGljZXMgb2YgWGVu
IG1hcHBpbmdzLiAqLwogCiAgICAgdHlwZSAmPSBYRU5fRE9NQ1RMX1BGSU5GT19MVEFCVFlQRV9N
QVNLOwogCkBAIC0xMDA0LDcgKzk4Niw2IEBAIHN0YXRpYyBpbnQgbm9ybWFsaXNlX3BhZ2V0YWJs
ZShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4LCBjb25zdCB1aW50NjRfdCAqc3JjLAogICAgIHJl
dHVybiAwOwogfQogCi0vKiBzYXZlX29wcyBmdW5jdGlvbi4gKi8KIHN0YXRpYyB4ZW5fcGZuX3Qg
eDg2X3B2X3Bmbl90b19nZm4oY29uc3Qgc3RydWN0IHhjX3NyX2NvbnRleHQgKmN0eCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVuX3Bmbl90IHBmbikKIHsKQEAgLTEwNDAs
NyArMTAyMSw3IEBAIHN0YXRpYyBpbnQgeDg2X3B2X25vcm1hbGlzZV9wYWdlKHN0cnVjdCB4Y19z
cl9jb250ZXh0ICpjdHgsIHhlbl9wZm5fdCB0eXBlLAogICAgIHJjID0gbm9ybWFsaXNlX3BhZ2V0
YWJsZShjdHgsICpwYWdlLCBsb2NhbF9wYWdlLCB0eXBlKTsKICAgICAqcGFnZSA9IGxvY2FsX3Bh
Z2U7CiAKLSAgb3V0OgorIG91dDoKICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTEwNzEsOSArMTA1
Miw2IEBAIHN0YXRpYyBpbnQgeDg2X3B2X3NldHVwKHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgp
CiAgICAgcmV0dXJuIDA7CiB9CiAKLS8qCi0gKiBzYXZlX29wcyBmdW5jdGlvbi4gIFdyaXRlcyBQ
ViBoZWFkZXIgcmVjb3JkcyBpbnRvIHRoZSBzdHJlYW0uCi0gKi8KIHN0YXRpYyBpbnQgeDg2X3B2
X3N0YXJ0X29mX3N0cmVhbShzdHJ1Y3QgeGNfc3JfY29udGV4dCAqY3R4KQogewogICAgIGludCBy
YzsKQEAgLTExMjcsOSArMTEwNSw2IEBAIHN0YXRpYyBpbnQgeDg2X3B2X2NoZWNrX3ZtX3N0YXRl
KHN0cnVjdCB4Y19zcl9jb250ZXh0ICpjdHgpCiAgICAgcmV0dXJuIHg4Nl9wdl9jaGVja192bV9z
dGF0ZV9wMm1fbGlzdChjdHgpOwogfQogCi0vKgotICogc2F2ZV9vcHMgZnVuY3Rpb24uICBDbGVh
bnVwLgotICovCiBzdGF0aWMgaW50IHg4Nl9wdl9jbGVhbnVwKHN0cnVjdCB4Y19zcl9jb250ZXh0
ICpjdHgpCiB7CiAgICAgZnJlZShjdHgtPng4Nl9wdi5wMm1fcGZucyk7CmRpZmYgLS1naXQgYS90
b29scy9weXRob24vc2NyaXB0cy9jb252ZXJ0LWxlZ2FjeS1zdHJlYW0gYi90b29scy9weXRob24v
c2NyaXB0cy9jb252ZXJ0LWxlZ2FjeS1zdHJlYW0KaW5kZXggYTVkYTMwYjFjZS4uMjkyMmZiMzE4
NSAxMDA3NTUKLS0tIGEvdG9vbHMvcHl0aG9uL3NjcmlwdHMvY29udmVydC1sZWdhY3ktc3RyZWFt
CisrKyBiL3Rvb2xzL3B5dGhvbi9zY3JpcHRzL2NvbnZlcnQtbGVnYWN5LXN0cmVhbQpAQCAtMjU3
LDggKzI1Nyw4IEBAIGRlZiByZWFkX3B2X2V4dGVuZGVkX2luZm8odm0pOgogCiAKICAgICBpZiBz
b19mYXIgIT0gdG90YWxfbGVuZ3RoOgotICAgICAgICByYWlzZSBTdHJlYW1FcnJvcigiT3ZlcnNo
b3QgRXh0ZW5kZWQgSW5mbyBzaXplIGJ5ICVkIGJ5dGVzIgotICAgICAgICAgICAgICAgICAgICAg
ICAgICAlIChzb19mYXIgLSB0b3RhbF9sZW5ndGgsKSkKKyAgICAgICAgcmFpc2UgU3RyZWFtRXJy
b3IoIk92ZXJzaG90IEV4dGVuZGVkIEluZm8gc2l6ZSBieSAlZCBieXRlcyIgJQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAoc29fZmFyIC0gdG90YWxfbGVuZ3RoLCApKQogCiBkZWYgcmVhZF9w
dl9wMm1fZnJhbWVzKHZtKToKICAgICBmcHAgPSA0MDk2IC8gdm0ud2lkdGgKQEAgLTM3NSw4ICsz
NzUsOCBAQCBkZWYgcmVhZF9jaHVua3Modm0pOgogICAgICAgICBlbGlmIG1hcmtlciA+IDA6CiAK
ICAgICAgICAgICAgIGlmIG1hcmtlciA+IGxlZ2FjeS5NQVhfQkFUQ0g6Ci0gICAgICAgICAgICAg
ICAgcmFpc2UgU3RyZWFtRXJyb3IoIlBhZ2UgYmF0Y2ggKCVkKSBleGNlZWRlZCBNQVhfQkFUQ0gg
KCVkKSIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIChtYXJrZXIsIGxlZ2Fj
eS5NQVhfQkFUQ0gpKQorICAgICAgICAgICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKCJQYWdlIGJh
dGNoICglZCkgZXhjZWVkZWQgTUFYX0JBVENIICglZCkiICUKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAobWFya2VyLCBsZWdhY3kuTUFYX0JBVENIKSkKICAgICAgICAgICAgIHBm
bnMgPSB1bnBhY2tfdWxvbmdzKG1hcmtlcikKIAogICAgICAgICAgICAgIyB4Y19kb21haW5fc2F2
ZSgpIGxlYXZlcyBtYW55IFhFTl9ET01DVExfUEZJTkZPX1hUQUIgcmVjb3JkcyBmb3IKQEAgLTM5
OCw4ICszOTgsOCBAQCBkZWYgcmVhZF9jaHVua3Modm0pOgogICAgICAgICAgICAgbWF4X2lkLCA9
IHVucGFja19leGFjdCgiaSIpCiAKICAgICAgICAgICAgIGlmIG1heF9pZCA+IGxlZ2FjeS5NQVhf
VkNQVV9JRDoKLSAgICAgICAgICAgICAgICByYWlzZSBTdHJlYW1FcnJvcigiVmNwdSBtYXhfaWQg
b3V0IG9mIHJhbmdlOiAlZCA+ICVkIgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICUgKG1heF9pZCwgbGVnYWN5Lk1BWF9WQ1BVX0lEKSkKKyAgICAgICAgICAgICAgICByYWlzZSBT
dHJlYW1FcnJvcigiVmNwdSBtYXhfaWQgb3V0IG9mIHJhbmdlOiAlZCA+ICVkIiAlCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1heF9pZCwgbGVnYWN5Lk1BWF9WQ1BVX0lEKSkK
IAogICAgICAgICAgICAgdm0ubWF4X3ZjcHVfaWQgPSBtYXhfaWQKICAgICAgICAgICAgIGJpdG1h
cCA9IHVucGFja19leGFjdCgiUSIgKiAoKG1heF9pZC82NCkgKyAxKSkKQEAgLTQxNCw4ICs0MTQs
OCBAQCBkZWYgcmVhZF9jaHVua3Modm0pOgogICAgICAgICAgICAgICAgICAgICBiaXRfaWR4ICs9
IDEKICAgICAgICAgICAgICAgICAgICAgd29yZCA+Pj0gMQogCi0gICAgICAgICAgICBpbmZvKCIg
IFZjcHUgaW5mbzogbWF4X2lkICVkLCBvbmxpbmUgbWFwICVzIgotICAgICAgICAgICAgICAgICAl
ICh2bS5tYXhfdmNwdV9pZCwgdm0ub25saW5lX3ZjcHVfbWFwKSkKKyAgICAgICAgICAgIGluZm8o
IiAgVmNwdSBpbmZvOiBtYXhfaWQgJWQsIG9ubGluZSBtYXAgJXMiICUKKyAgICAgICAgICAgICAg
ICAgKHZtLm1heF92Y3B1X2lkLCB2bS5vbmxpbmVfdmNwdV9tYXApKQogCiAgICAgICAgIGVsaWYg
bWFya2VyID09IGxlZ2FjeS5DSFVOS19odm1faWRlbnRfcHQ6CiAgICAgICAgICAgICBfLCBpZGVu
dF9wdCA9IHVucGFja19leGFjdCgiPUlRIikKQEAgLTUxMiw3ICs1MTIsNyBAQCBkZWYgcmVhZF9j
aHVua3Modm0pOgogICAgICAgICAgICAgICAgIFtwdWJsaWMuSFZNX1BBUkFNX05SX0lPUkVRX1NF
UlZFUl9QQUdFUywgbnJfcGFnZXNdKQogCiAgICAgICAgIGVsc2U6Ci0gICAgICAgICAgICByYWlz
ZSBTdHJlYW1FcnJvcigiVW5yZWNvZ25pc2VkIGNodW5rICVkIiAlIChtYXJrZXIsKSkKKyAgICAg
ICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKCJVbnJlY29nbmlzZWQgY2h1bmsgJWQiICUgKG1hcmtl
ciwgKSkKIAogZGVmIHJlYWRfaHZtX3RhaWwodm0pOgogCkBAIC01NzksNyArNTc5LDcgQEAgZGVm
IHJlYWRfbGVnYWN5X3N0cmVhbSh2bSk6CiAKICAgICB0cnk6CiAgICAgICAgIHZtLnAybV9zaXpl
LCA9IHVucGFja191bG9uZ3MoMSkKLSAgICAgICAgaW5mbygiUDJNIFNpemU6IDB4JXgiICUgKHZt
LnAybV9zaXplLCkpCisgICAgICAgIGluZm8oIlAyTSBTaXplOiAweCV4IiAlICh2bS5wMm1fc2l6
ZSwgKSkKIAogICAgICAgICBpZiB2bS5saWJ4bDoKICAgICAgICAgICAgIHdyaXRlX2xpYnhsX2hk
cigpCmRpZmYgLS1naXQgYS90b29scy9weXRob24veGVuL21pZ3JhdGlvbi9saWJ4Yy5weSBiL3Rv
b2xzL3B5dGhvbi94ZW4vbWlncmF0aW9uL2xpYnhjLnB5CmluZGV4IDQzMjc1MGM5ZmEuLjhhODAw
ZGY5ODAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3B5dGhvbi94ZW4vbWlncmF0aW9uL2xpYnhjLnB5Cisr
KyBiL3Rvb2xzL3B5dGhvbi94ZW4vbWlncmF0aW9uL2xpYnhjLnB5CkBAIC03NCw3ICs3NCw3IEBA
CiAgICAgUkVDX1RZUEVfeDg2X3B2X3ZjcHVfbXNycyAgICAgICAgICAgOiAieDg2IFBWIHZjcHUg
bXNycyIsCiAgICAgUkVDX1RZUEVfdmVyaWZ5ICAgICAgICAgICAgICAgICAgICAgOiAiVmVyaWZ5
IiwKICAgICBSRUNfVFlQRV9jaGVja3BvaW50ICAgICAgICAgICAgICAgICA6ICJDaGVja3BvaW50
IiwKLSAgICBSRUNfVFlQRV9jaGVja3BvaW50X2RpcnR5X3Bmbl9saXN0ICA6ICJDaGVja3BvaW50
IGRpcnR5IHBmbiBsaXN0IgorICAgIFJFQ19UWVBFX2NoZWNrcG9pbnRfZGlydHlfcGZuX2xpc3Qg
IDogIkNoZWNrcG9pbnQgZGlydHkgcGZuIGxpc3QiLAogfQogCiAjIHBhZ2VfZGF0YQpAQCAtMTM3
LDI0ICsxMzcsMjUgQEAgZGVmIHZlcmlmeV9paGRyKHNlbGYpOgogICAgICAgICAgICAgc2VsZi51
bnBhY2tfZXhhY3QoSUhEUl9GT1JNQVQpCiAKICAgICAgICAgaWYgbWFya2VyICE9IElIRFJfTUFS
S0VSOgotICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoIkJhZCBpbWFnZSBtYXJrZXI6IEV4
cGVjdGVkIDB4JXgsIGdvdCAweCV4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAo
SUhEUl9NQVJLRVIsIG1hcmtlcikpCisgICAgICAgICAgICByYWlzZSBTdHJlYW1FcnJvcigiQmFk
IGltYWdlIG1hcmtlcjogRXhwZWN0ZWQgMHgleCwgZ290IDB4JXgiICUKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIChJSERSX01BUktFUiwgbWFya2VyKSkKIAogICAgICAgICBpZiBpZGVu
dCAhPSBJSERSX0lERU5UOgotICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoIkJhZCBpbWFn
ZSBpZDogRXhwZWN0ZWQgMHgleCwgZ290IDB4JXgiCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAlIChJSERSX0lERU5ULCBpZGVudCkpCisgICAgICAgICAgICByYWlzZSBTdHJlYW1FcnJv
cigiQmFkIGltYWdlIGlkOiBFeHBlY3RlZCAweCV4LCBnb3QgMHgleCIgJQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKElIRFJfSURFTlQsIGlkZW50KSkKIAogICAgICAgICBpZiB2ZXJz
aW9uICE9IElIRFJfVkVSU0lPTjoKLSAgICAgICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKCJVbmtu
b3duIGltYWdlIHZlcnNpb246IEV4cGVjdGVkICVkLCBnb3QgJWQiCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAlIChJSERSX1ZFUlNJT04sIHZlcnNpb24pKQorICAgICAgICAgICAgcmFp
c2UgU3RyZWFtRXJyb3IoIlVua25vd24gaW1hZ2UgdmVyc2lvbjogRXhwZWN0ZWQgJWQsIGdvdCAl
ZCIgJQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKElIRFJfVkVSU0lPTiwgdmVyc2lv
bikpCiAKICAgICAgICAgaWYgb3B0aW9ucyAmIElIRFJfT1BUX1JFU1pfTUFTSzoKLSAgICAgICAg
ICAgIHJhaXNlIFN0cmVhbUVycm9yKCJSZXNlcnZlZCBiaXRzIHNldCBpbiBpbWFnZSBvcHRpb25z
IGZpZWxkOiAweCV4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAob3B0aW9ucyAm
IElIRFJfT1BUX1JFU1pfTUFTSykpCisgICAgICAgICAgICByYWlzZSBTdHJlYW1FcnJvcigiUmVz
ZXJ2ZWQgYml0cyBzZXQgaW4gaW1hZ2Ugb3B0aW9ucyBmaWVsZDogMHgleCIgJQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKG9wdGlvbnMgJiBJSERSX09QVF9SRVNaX01BU0spKQogCiAg
ICAgICAgIGlmIHJlczEgIT0gMCBvciByZXMyICE9IDA6Ci0gICAgICAgICAgICByYWlzZSBTdHJl
YW1FcnJvcigiUmVzZXJ2ZWQgYml0cyBzZXQgaW4gaW1hZ2UgaGVhZGVyOiAweCUwNHg6MHglMDh4
IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAocmVzMSwgcmVzMikpCisgICAgICAg
ICAgICByYWlzZSBTdHJlYW1FcnJvcigKKyAgICAgICAgICAgICAgICAiUmVzZXJ2ZWQgYml0cyBz
ZXQgaW4gaW1hZ2UgaGVhZGVyOiAweCUwNHg6MHglMDh4IiAlCisgICAgICAgICAgICAgICAgKHJl
czEsIHJlczIpKQogCiAgICAgICAgIGlmICggKHN5cy5ieXRlb3JkZXIgPT0gImxpdHRsZSIpIGFu
ZAogICAgICAgICAgICAgICgob3B0aW9ucyAmIElIRFJfT1BUX0JJVF9FTkRJQU4pICE9IElIRFJf
T1BUX0xFKSApOgpAQCAtMTc1LDE5ICsxNzYsMTkgQEAgZGVmIHZlcmlmeV9kaGRyKHNlbGYpOgog
ICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoIlVucmVjb2duaXNlZCBkb21haW4gdHlwZSAw
eCV4IiAlIChndHlwZSwgKSkKIAogICAgICAgICBpZiByZXMxICE9IDA6Ci0gICAgICAgICAgICBy
YWlzZSBTdHJlYW1FcnJvcigiUmVzZXJ2ZWQgYml0cyBzZXQgaW4gZG9tYWluIGhlYWRlciAweCUw
NHgiCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIChyZXMxLCApKQorICAgICAgICAg
ICAgcmFpc2UgU3RyZWFtRXJyb3IoIlJlc2VydmVkIGJpdHMgc2V0IGluIGRvbWFpbiBoZWFkZXIg
MHglMDR4IiAlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVzMSwgKSkKIAogICAg
ICAgICBpZiBwYWdlX3NoaWZ0ICE9IDEyOgotICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3Io
IlBhZ2Ugc2hpZnQgZXhwZWN0ZWQgdG8gYmUgMTIuICBHb3QgJWQiCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAlIChwYWdlX3NoaWZ0LCApKQorICAgICAgICAgICAgcmFpc2UgU3RyZWFt
RXJyb3IoIlBhZ2Ugc2hpZnQgZXhwZWN0ZWQgdG8gYmUgMTIuICBHb3QgJWQiICUKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIChwYWdlX3NoaWZ0LCApKQogCiAgICAgICAgIGlmIG1ham9y
ID09IDA6Ci0gICAgICAgICAgICBzZWxmLmluZm8oIkRvbWFpbiBIZWFkZXI6IGxlZ2FjeSBjb252
ZXJ0ZWQgJXMiCi0gICAgICAgICAgICAgICAgICAgICAgJSAoZGhkcl90eXBlX3RvX3N0cltndHlw
ZV0sICkpCisgICAgICAgICAgICBzZWxmLmluZm8oIkRvbWFpbiBIZWFkZXI6IGxlZ2FjeSBjb252
ZXJ0ZWQgJXMiICUKKyAgICAgICAgICAgICAgICAgICAgICAoZGhkcl90eXBlX3RvX3N0cltndHlw
ZV0sICkpCiAgICAgICAgIGVsc2U6Ci0gICAgICAgICAgICBzZWxmLmluZm8oIkRvbWFpbiBIZWFk
ZXI6ICVzIGZyb20gWGVuICVkLiVkIgotICAgICAgICAgICAgICAgICAgICAgICUgKGRoZHJfdHlw
ZV90b19zdHJbZ3R5cGVdLCBtYWpvciwgbWlub3IpKQorICAgICAgICAgICAgc2VsZi5pbmZvKCJE
b21haW4gSGVhZGVyOiAlcyBmcm9tIFhlbiAlZC4lZCIgJQorICAgICAgICAgICAgICAgICAgICAg
IChkaGRyX3R5cGVfdG9fc3RyW2d0eXBlXSwgbWFqb3IsIG1pbm9yKSkKIAogCiAgICAgZGVmIHZl
cmlmeV9yZWNvcmQoc2VsZik6CkBAIC0yMDQsMTIgKzIwNSwxMiBAQCBkZWYgdmVyaWZ5X3JlY29y
ZChzZWxmKToKICAgICAgICAgaWYgcnR5cGUgIT0gUkVDX1RZUEVfcGFnZV9kYXRhOgogCiAgICAg
ICAgICAgICBpZiBzZWxmLnNxdWFzaGVkX3BhZ2VkYXRhX3JlY29yZHMgPiAwOgotICAgICAgICAg
ICAgICAgIHNlbGYuaW5mbygiU3F1YXNoZWQgJWQgUGFnZSBEYXRhIHJlY29yZHMgdG9nZXRoZXIi
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICUgKHNlbGYuc3F1YXNoZWRfcGFnZWRhdGFfcmVj
b3JkcywgKSkKKyAgICAgICAgICAgICAgICBzZWxmLmluZm8oIlNxdWFzaGVkICVkIFBhZ2UgRGF0
YSByZWNvcmRzIHRvZ2V0aGVyIiAlCisgICAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLnNx
dWFzaGVkX3BhZ2VkYXRhX3JlY29yZHMsICkpCiAgICAgICAgICAgICAgICAgc2VsZi5zcXVhc2hl
ZF9wYWdlZGF0YV9yZWNvcmRzID0gMAogCi0gICAgICAgICAgICBzZWxmLmluZm8oIkxpYnhjIFJl
Y29yZDogJXMsIGxlbmd0aCAlZCIKLSAgICAgICAgICAgICAgICAgICAgICAlIChyZWNfdHlwZV90
b19zdHJbcnR5cGVdLCBsZW5ndGgpKQorICAgICAgICAgICAgc2VsZi5pbmZvKCJMaWJ4YyBSZWNv
cmQ6ICVzLCBsZW5ndGggJWQiICUKKyAgICAgICAgICAgICAgICAgICAgICAocmVjX3R5cGVfdG9f
c3RyW3J0eXBlXSwgbGVuZ3RoKSkKIAogICAgICAgICBlbHNlOgogICAgICAgICAgICAgc2VsZi5z
cXVhc2hlZF9wYWdlZGF0YV9yZWNvcmRzICs9IDEKQEAgLTIxOSw4ICsyMjAsOSBAQCBkZWYgdmVy
aWZ5X3JlY29yZChzZWxmKToKICAgICAgICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKCJQYWRkaW5n
IGNvbnRhaW5pbmcgbm9uMCBieXRlcyBmb3VuZCIpCiAKICAgICAgICAgaWYgcnR5cGUgbm90IGlu
IHJlY29yZF92ZXJpZmllcnM6Ci0gICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoIk5vIHZl
cmlmaWNhdGlvbiBmdW5jdGlvbiBmb3IgbGlieGMgcmVjb3JkICclcyciCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJSByZWNfdHlwZV90b19zdHJbcnR5cGVdKQorICAgICAgICAgICAg
cmFpc2UgUnVudGltZUVycm9yKAorICAgICAgICAgICAgICAgICJObyB2ZXJpZmljYXRpb24gZnVu
Y3Rpb24gZm9yIGxpYnhjIHJlY29yZCAnJXMnIiAlCisgICAgICAgICAgICAgICAgcmVjX3R5cGVf
dG9fc3RyW3J0eXBlXSkKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHJlY29yZF92ZXJpZmll
cnNbcnR5cGVdKHNlbGYsIGNvbnRlbnRbOmxlbmd0aF0pCiAKQEAgLTIzOSwzMiArMjQxLDMyIEBA
IGRlZiB2ZXJpZnlfcmVjb3JkX3BhZ2VfZGF0YShzZWxmLCBjb250ZW50KToKICAgICAgICAgbWlu
c3ogPSBjYWxjc2l6ZShQQUdFX0RBVEFfRk9STUFUKQogCiAgICAgICAgIGlmIGxlbihjb250ZW50
KSA8PSBtaW5zejoKLSAgICAgICAgICAgIHJhaXNlIFJlY29yZEVycm9yKCJQQUdFX0RBVEEgcmVj
b3JkIG11c3QgYmUgYXQgbGVhc3QgJWQgYnl0ZXMgbG9uZyIKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICUgKG1pbnN6LCApKQorICAgICAgICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoCisg
ICAgICAgICAgICAgICAgIlBBR0VfREFUQSByZWNvcmQgbXVzdCBiZSBhdCBsZWFzdCAlZCBieXRl
cyBsb25nIiAlIChtaW5zeiwgKSkKIAogICAgICAgICBjb3VudCwgcmVzMSA9IHVucGFjayhQQUdF
X0RBVEFfRk9STUFULCBjb250ZW50WzptaW5zel0pCiAKICAgICAgICAgaWYgcmVzMSAhPSAwOgot
ICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoIlJlc2VydmVkIGJpdHMgc2V0IGluIFBBR0Vf
REFUQSByZWNvcmQgMHglMDR4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAocmVz
MSwgKSkKKyAgICAgICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKAorICAgICAgICAgICAgICAgICJS
ZXNlcnZlZCBiaXRzIHNldCBpbiBQQUdFX0RBVEEgcmVjb3JkIDB4JTA0eCIgJSAocmVzMSwgKSkK
IAogICAgICAgICBwZm5zeiA9IGNvdW50ICogOAogICAgICAgICBpZiAobGVuKGNvbnRlbnQpIC0g
bWluc3opIDwgcGZuc3o6Ci0gICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiUEFHRV9EQVRB
IHJlY29yZCBtdXN0IGNvbnRhaW4gYSBwZm4gcmVjb3JkIGZvciAiCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAiZWFjaCBjb3VudCIpCisgICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJv
cigKKyAgICAgICAgICAgICAgICAiUEFHRV9EQVRBIHJlY29yZCBtdXN0IGNvbnRhaW4gYSBwZm4g
cmVjb3JkIGZvciBlYWNoIGNvdW50IikKIAotICAgICAgICBwZm5zID0gbGlzdCh1bnBhY2soIj0l
ZFEiICUgKGNvdW50LCksIGNvbnRlbnRbbWluc3o6bWluc3ogKyBwZm5zel0pKQorICAgICAgICBw
Zm5zID0gbGlzdCh1bnBhY2soIj0lZFEiICUgKGNvdW50LCApLCBjb250ZW50W21pbnN6Om1pbnN6
ICsgcGZuc3pdKSkKIAogICAgICAgICBucl9wYWdlcyA9IDAKICAgICAgICAgZm9yIGlkeCwgcGZu
IGluIGVudW1lcmF0ZShwZm5zKToKIAogICAgICAgICAgICAgaWYgcGZuICYgUEFHRV9EQVRBX1BG
Tl9SRVNaX01BU0s6Ci0gICAgICAgICAgICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoIlJlc2VydmVk
IGJpdHMgc2V0IGluIHBmblslZF06IDB4JTAxNngiLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGlkeCwgcGZuICYgUEFHRV9EQVRBX1BGTl9SRVNaX01BU0spCisgICAgICAgICAg
ICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoIlJlc2VydmVkIGJpdHMgc2V0IGluIHBmblslZF06IDB4
JTAxNngiICUKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaWR4LCBwZm4gJiBQ
QUdFX0RBVEFfUEZOX1JFU1pfTUFTSykpCiAKICAgICAgICAgICAgIGlmIHBmbiA+PiBQQUdFX0RB
VEFfVFlQRV9TSElGVCBpbiAoNSwgNiwgNywgOCk6Ci0gICAgICAgICAgICAgICAgcmFpc2UgUmVj
b3JkRXJyb3IoIkludmFsaWQgdHlwZSB2YWx1ZSBpbiBwZm5bJWRdOiAweCUwMTZ4IiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHgsIHBmbiAmIFBBR0VfREFUQV9UWVBFX0xU
QUJfTUFTSykKKyAgICAgICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiSW52YWxpZCB0eXBl
IHZhbHVlIGluIHBmblslZF06IDB4JTAxNngiICUKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAoaWR4LCBwZm4gJiBQQUdFX0RBVEFfVFlQRV9MVEFCX01BU0spKQogCiAgICAgICAg
ICAgICAjIFdlIGV4cGVjdCBwYWdlIGRhdGEgZm9yIGVhY2ggbm9ybWFsIHBhZ2Ugb3IgcGFnZXRh
YmxlCiAgICAgICAgICAgICBpZiBQQUdFX0RBVEFfVFlQRV9OT1RBQiA8PSAocGZuICYgUEFHRV9E
QVRBX1RZUEVfTFRBQlRZUEVfTUFTSykgXApAQCAtMjczLDggKzI3NSw4IEBAIGRlZiB2ZXJpZnlf
cmVjb3JkX3BhZ2VfZGF0YShzZWxmLCBjb250ZW50KToKIAogICAgICAgICBwYWdlc3ogPSBucl9w
YWdlcyAqIDQwOTYKICAgICAgICAgaWYgbGVuKGNvbnRlbnQpICE9IG1pbnN6ICsgcGZuc3ogKyBw
YWdlc3o6Ci0gICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiRXhwZWN0ZWQgJXUgKyAldSAr
ICV1LCBnb3QgJXUiCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIChtaW5zeiwgcGZu
c3osIHBhZ2VzeiwgbGVuKGNvbnRlbnQpKSkKKyAgICAgICAgICAgIHJhaXNlIFJlY29yZEVycm9y
KCJFeHBlY3RlZCAldSArICV1ICsgJXUsIGdvdCAldSIgJQorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgKG1pbnN6LCBwZm5zeiwgcGFnZXN6LCBsZW4oY29udGVudCkpKQogCiAKICAgICBk
ZWYgdmVyaWZ5X3JlY29yZF94ODZfcHZfaW5mbyhzZWxmLCBjb250ZW50KToKQEAgLTI4Miw4ICsy
ODQsOCBAQCBkZWYgdmVyaWZ5X3JlY29yZF94ODZfcHZfaW5mbyhzZWxmLCBjb250ZW50KToKIAog
ICAgICAgICBleHBlY3RlZHN6ID0gY2FsY3NpemUoWDg2X1BWX0lORk9fRk9STUFUKQogICAgICAg
ICBpZiBsZW4oY29udGVudCkgIT0gZXhwZWN0ZWRzejoKLSAgICAgICAgICAgIHJhaXNlIFJlY29y
ZEVycm9yKCJ4ODZfcHZfaW5mbzogZXhwZWN0ZWQgbGVuZ3RoIG9mICVkLCBnb3QgJWQiCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAlIChleHBlY3RlZHN6LCBsZW4oY29udGVudCkpKQor
ICAgICAgICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoIng4Nl9wdl9pbmZvOiBleHBlY3RlZCBsZW5n
dGggb2YgJWQsIGdvdCAlZCIgJQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGV4cGVj
dGVkc3osIGxlbihjb250ZW50KSkpCiAKICAgICAgICAgd2lkdGgsIGxldmVscywgcmVzMSwgcmVz
MiA9IHVucGFjayhYODZfUFZfSU5GT19GT1JNQVQsIGNvbnRlbnQpCiAKQEAgLTI5NCw4ICsyOTYs
OSBAQCBkZWYgdmVyaWZ5X3JlY29yZF94ODZfcHZfaW5mbyhzZWxmLCBjb250ZW50KToKICAgICAg
ICAgICAgIHJhaXNlIFJlY29yZEVycm9yKCJFeHBlY3RlZCBsZXZlbHMgb2YgMyBvciA0LCBnb3Qg
JWQiICUgKGxldmVscywgKSkKIAogICAgICAgICBpZiByZXMxICE9IDAgb3IgcmVzMiAhPSAwOgot
ICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoIlJlc2VydmVkIGJpdHMgc2V0IGluIFg4Nl9Q
Vl9JTkZPOiAweCUwNHggMHglMDh4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAo
cmVzMSwgcmVzMikpCisgICAgICAgICAgICByYWlzZSBTdHJlYW1FcnJvcigKKyAgICAgICAgICAg
ICAgICAiUmVzZXJ2ZWQgYml0cyBzZXQgaW4gWDg2X1BWX0lORk86IDB4JTA0eCAweCUwOHgiICUK
KyAgICAgICAgICAgICAgICAocmVzMSwgcmVzMikpCiAKICAgICAgICAgYml0bmVzcyA9IHs0OjMy
LCA4OjY0fVt3aWR0aF0KICAgICAgICAgc2VsZi5pbmZvKCIgICVzYml0IGd1ZXN0LCAlZCBsZXZl
bHMgb2YgcGFnZXRhYmxlcyIgJSAoYml0bmVzcywgbGV2ZWxzKSkKQEAgLTMwOSw4ICszMTIsOCBA
QCBkZWYgdmVyaWZ5X3JlY29yZF94ODZfcHZfcDJtX2ZyYW1lcyhzZWxmLCBjb250ZW50KToKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgbGVhc3QgOCBieXRlcyBsb25nIikKIAogICAg
ICAgICBpZiBsZW4oY29udGVudCkgJSA4ICE9IDA6Ci0gICAgICAgICAgICByYWlzZSBSZWNvcmRF
cnJvcigiTGVuZ3RoIGV4cGVjdGVkIHRvIGJlIGEgbXVsdGlwbGUgb2YgOCwgbm90ICVkIgotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAobGVuKGNvbnRlbnQpLCApKQorICAgICAgICAg
ICAgcmFpc2UgUmVjb3JkRXJyb3IoIkxlbmd0aCBleHBlY3RlZCB0byBiZSBhIG11bHRpcGxlIG9m
IDgsIG5vdCAlZCIgJQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGxlbihjb250ZW50
KSwgKSkKIAogICAgICAgICBzdGFydCwgZW5kID0gdW5wYWNrKCI9SUkiLCBjb250ZW50Wzo4XSkK
ICAgICAgICAgc2VsZi5pbmZvKCIgIFN0YXJ0IHBmbiAweCV4LCBFbmQgMHgleCIgJSAoc3RhcnQs
IGVuZCkpCkBAIC0zMjEsMzAgKzMyNCwzMiBAQCBkZWYgdmVyaWZ5X3JlY29yZF94ODZfcHZfdmNw
dV9nZW5lcmljKHNlbGYsIGNvbnRlbnQsIG5hbWUpOgogICAgICAgICBtaW5zeiA9IGNhbGNzaXpl
KFg4Nl9QVl9WQ1BVX0hEUl9GT1JNQVQpCiAKICAgICAgICAgaWYgbGVuKGNvbnRlbnQpIDwgbWlu
c3o6Ci0gICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiWDg2X1BWX1ZDUFVfJXMgcmVjb3Jk
IGxlbmd0aCBtdXN0IGJlIGF0IGxlYXN0ICVkIgotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIiBieXRlcyBsb25nIiAlIChuYW1lLCBtaW5zeikpCisgICAgICAgICAgICByYWlzZSBSZWNv
cmRFcnJvcigKKyAgICAgICAgICAgICAgICAiWDg2X1BWX1ZDUFVfJXMgcmVjb3JkIGxlbmd0aCBt
dXN0IGJlIGF0IGxlYXN0ICVkIGJ5dGVzIGxvbmciICUKKyAgICAgICAgICAgICAgICAobmFtZSwg
bWluc3opKQogCiAgICAgICAgIGlmIGxlbihjb250ZW50KSA9PSBtaW5zejoKLSAgICAgICAgICAg
IHNlbGYuaW5mbygiV2FybmluZzogWDg2X1BWX1ZDUFVfJXMgcmVjb3JkIHdpdGggemVybyBjb250
ZW50IgotICAgICAgICAgICAgICAgICAgICAgICUgKG5hbWUsICkpCisgICAgICAgICAgICBzZWxm
LmluZm8oIldhcm5pbmc6IFg4Nl9QVl9WQ1BVXyVzIHJlY29yZCB3aXRoIHplcm8gY29udGVudCIg
JQorICAgICAgICAgICAgICAgICAgICAgIChuYW1lLCApKQogCiAgICAgICAgIHZjcHVpZCwgcmVz
MSA9IHVucGFjayhYODZfUFZfVkNQVV9IRFJfRk9STUFULCBjb250ZW50WzptaW5zel0pCiAKICAg
ICAgICAgaWYgcmVzMSAhPSAwOgogICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoCi0gICAg
ICAgICAgICAgICAgIlJlc2VydmVkIGJpdHMgc2V0IGluIHg4Nl9wdl92Y3B1XyVzIHJlY29yZCAw
eCUwNHgiCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIChuYW1lLCByZXMxKSkKKyAg
ICAgICAgICAgICAgICAiUmVzZXJ2ZWQgYml0cyBzZXQgaW4geDg2X3B2X3ZjcHVfJXMgcmVjb3Jk
IDB4JTA0eCIgJQorICAgICAgICAgICAgICAgIChuYW1lLCByZXMxKSkKIAotICAgICAgICBzZWxm
LmluZm8oIiAgdmNwdSVkICVzIGNvbnRleHQsICVkIGJ5dGVzIgotICAgICAgICAgICAgICAgICAg
JSAodmNwdWlkLCBuYW1lLCBsZW4oY29udGVudCkgLSBtaW5zeikpCisgICAgICAgIHNlbGYuaW5m
bygiICB2Y3B1JWQgJXMgY29udGV4dCwgJWQgYnl0ZXMiICUKKyAgICAgICAgICAgICAgICAgICh2
Y3B1aWQsIG5hbWUsIGxlbihjb250ZW50KSAtIG1pbnN6KSkKIAogCiAgICAgZGVmIHZlcmlmeV9y
ZWNvcmRfc2hhcmVkX2luZm8oc2VsZiwgY29udGVudCk6CiAgICAgICAgICIiIiBzaGFyZWQgaW5m
byByZWNvcmQgIiIiCiAKLSAgICAgICAgaWYgbGVuKGNvbnRlbnQpICE9IDQwOTY6Ci0gICAgICAg
ICAgICByYWlzZSBSZWNvcmRFcnJvcigiTGVuZ3RoIGV4cGVjdGVkIHRvIGJlIDQ5MDYgYnl0ZXMs
IG5vdCAlZCIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKGxlbihjb250ZW50KSwg
KSkKKyAgICAgICAgY29udGVudHN6ID0gbGVuKGNvbnRlbnQpCisgICAgICAgIGlmIGNvbnRlbnRz
eiAhPSA0MDk2OgorICAgICAgICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoIkxlbmd0aCBleHBlY3Rl
ZCB0byBiZSA0OTA2IGJ5dGVzLCBub3QgJWQiICUKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChjb250ZW50c3osICkpCiAKIAogICAgIGRlZiB2ZXJpZnlfcmVjb3JkX3RzY19pbmZvKHNl
bGYsIGNvbnRlbnQpOgpAQCAtMzU4LDExICszNjMsMTEgQEAgZGVmIHZlcmlmeV9yZWNvcmRfdHNj
X2luZm8oc2VsZiwgY29udGVudCk6CiAgICAgICAgIG1vZGUsIGtoeiwgbnNlYywgaW5jYXJuLCBy
ZXMxID0gdW5wYWNrKFg4Nl9UU0NfSU5GT19GT1JNQVQsIGNvbnRlbnQpCiAKICAgICAgICAgaWYg
cmVzMSAhPSAwOgotICAgICAgICAgICAgcmFpc2UgU3RyZWFtRXJyb3IoIlJlc2VydmVkIGJpdHMg
c2V0IGluIFg4Nl9UU0NfSU5GTzogMHglMDh4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJSAocmVzMSwgKSkKKyAgICAgICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKCJSZXNlcnZlZCBi
aXRzIHNldCBpbiBYODZfVFNDX0lORk86IDB4JTA4eCIgJQorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgKHJlczEsICkpCiAKLSAgICAgICAgc2VsZi5pbmZvKCIgIE1vZGUgJXUsICV1IGtI
eiwgJXUgbnMsIGluY2FybmF0aW9uICVkIgotICAgICAgICAgICAgICAgICAgJSAobW9kZSwga2h6
LCBuc2VjLCBpbmNhcm4pKQorICAgICAgICBzZWxmLmluZm8oIiAgTW9kZSAldSwgJXUga0h6LCAl
dSBucywgaW5jYXJuYXRpb24gJWQiICUKKyAgICAgICAgICAgICAgICAgIChtb2RlLCBraHosIG5z
ZWMsIGluY2FybikpCiAKIAogICAgIGRlZiB2ZXJpZnlfcmVjb3JkX2h2bV9jb250ZXh0KHNlbGYs
IGNvbnRlbnQpOgpAQCAtNDEyLDYgKzQxNyw3IEBAIGRlZiB2ZXJpZnlfcmVjb3JkX2NoZWNrcG9p
bnQoc2VsZiwgY29udGVudCk6CiAgICAgICAgIGlmIGxlbihjb250ZW50KSAhPSAwOgogICAgICAg
ICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoIkNoZWNrcG9pbnQgcmVjb3JkIHdpdGggbm9uLXplcm8g
bGVuZ3RoIikKIAorCiAgICAgZGVmIHZlcmlmeV9yZWNvcmRfY2hlY2twb2ludF9kaXJ0eV9wZm5f
bGlzdChzZWxmLCBjb250ZW50KToKICAgICAgICAgIiIiIGNoZWNrcG9pbnQgZGlydHkgcGZuIGxp
c3QgIiIiCiAgICAgICAgIHJhaXNlIFJlY29yZEVycm9yKCJGb3VuZCBjaGVja3BvaW50IGRpcnR5
IHBmbiBsaXN0IHJlY29yZCBpbiBzdHJlYW0iKQpkaWZmIC0tZ2l0IGEvdG9vbHMvcHl0aG9uL3hl
bi9taWdyYXRpb24vbGlieGwucHkgYi90b29scy9weXRob24veGVuL21pZ3JhdGlvbi9saWJ4bC5w
eQppbmRleCA3OWY0MDI0ZTcyLi41YzRkNGZlMDYzIDEwMDY0NAotLS0gYS90b29scy9weXRob24v
eGVuL21pZ3JhdGlvbi9saWJ4bC5weQorKysgYi90b29scy9weXRob24veGVuL21pZ3JhdGlvbi9s
aWJ4bC5weQpAQCAtNDUsNyArNDUsNyBAQAogICAgIFJFQ19UWVBFX2VtdWxhdG9yX3hlbnN0b3Jl
X2RhdGEgOiAiRW11bGF0b3IgeGVuc3RvcmUgZGF0YSIsCiAgICAgUkVDX1RZUEVfZW11bGF0b3Jf
Y29udGV4dCAgICAgICA6ICJFbXVsYXRvciBjb250ZXh0IiwKICAgICBSRUNfVFlQRV9jaGVja3Bv
aW50X2VuZCAgICAgICAgIDogIkNoZWNrcG9pbnQgZW5kIiwKLSAgICBSRUNfVFlQRV9jaGVja3Bv
aW50X3N0YXRlICAgICAgIDogIkNoZWNrcG9pbnQgc3RhdGUiCisgICAgUkVDX1RZUEVfY2hlY2tw
b2ludF9zdGF0ZSAgICAgICA6ICJDaGVja3BvaW50IHN0YXRlIiwKIH0KIAogIyBlbXVsYXRvcl8q
IGhlYWRlcgpAQCAtOTAsMTYgKzkwLDE2IEBAIGRlZiB2ZXJpZnlfaGRyKHNlbGYpOgogICAgICAg
ICBpZGVudCwgdmVyc2lvbiwgb3B0aW9ucyA9IHNlbGYudW5wYWNrX2V4YWN0KEhEUl9GT1JNQVQp
CiAKICAgICAgICAgaWYgaWRlbnQgIT0gSERSX0lERU5UOgotICAgICAgICAgICAgcmFpc2UgU3Ry
ZWFtRXJyb3IoIkJhZCBpbWFnZSBpZDogRXhwZWN0ZWQgMHgleCwgZ290IDB4JXgiCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAlIChIRFJfSURFTlQsIGlkZW50KSkKKyAgICAgICAgICAg
IHJhaXNlIFN0cmVhbUVycm9yKCJCYWQgaW1hZ2UgaWQ6IEV4cGVjdGVkIDB4JXgsIGdvdCAweCV4
IiAlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoSERSX0lERU5ULCBpZGVudCkpCiAK
ICAgICAgICAgaWYgdmVyc2lvbiAhPSBIRFJfVkVSU0lPTjoKLSAgICAgICAgICAgIHJhaXNlIFN0
cmVhbUVycm9yKCJVbmtub3duIGltYWdlIHZlcnNpb246IEV4cGVjdGVkICVkLCBnb3QgJWQiCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIChIRFJfVkVSU0lPTiwgdmVyc2lvbikpCisg
ICAgICAgICAgICByYWlzZSBTdHJlYW1FcnJvcigiVW5rbm93biBpbWFnZSB2ZXJzaW9uOiBFeHBl
Y3RlZCAlZCwgZ290ICVkIiAlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoSERSX1ZF
UlNJT04sIHZlcnNpb24pKQogCiAgICAgICAgIGlmIG9wdGlvbnMgJiBIRFJfT1BUX1JFU1pfTUFT
SzoKLSAgICAgICAgICAgIHJhaXNlIFN0cmVhbUVycm9yKCJSZXNlcnZlZCBiaXRzIHNldCBpbiBp
bWFnZSBvcHRpb25zIGZpZWxkOiAweCV4IgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JSAob3B0aW9ucyAmIEhEUl9PUFRfUkVTWl9NQVNLKSkKKyAgICAgICAgICAgIHJhaXNlIFN0cmVh
bUVycm9yKCJSZXNlcnZlZCBiaXRzIHNldCBpbiBpbWFnZSBvcHRpb25zIGZpZWxkOiAweCV4IiAl
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3B0aW9ucyAmIEhEUl9PUFRfUkVTWl9N
QVNLKSkKIAogICAgICAgICBpZiAoIChzeXMuYnl0ZW9yZGVyID09ICJsaXR0bGUiKSBhbmQKICAg
ICAgICAgICAgICAoKG9wdGlvbnMgJiBIRFJfT1BUX0JJVF9FTkRJQU4pICE9IEhEUl9PUFRfTEUp
ICk6CkBAIC0xMjEsOCArMTIxLDggQEAgZGVmIHZlcmlmeV9yZWNvcmQoc2VsZik6CiAgICAgICAg
IGlmIHJ0eXBlIG5vdCBpbiByZWNfdHlwZV90b19zdHI6CiAgICAgICAgICAgICByYWlzZSBTdHJl
YW1FcnJvcigiVW5yZWNvZ25pc2VkIHJlY29yZCB0eXBlICV4IiAlIChydHlwZSwgKSkKIAotICAg
ICAgICBzZWxmLmluZm8oIkxpYnhsIFJlY29yZDogJXMsIGxlbmd0aCAlZCIKLSAgICAgICAgICAg
ICAgICAgICUgKHJlY190eXBlX3RvX3N0cltydHlwZV0sIGxlbmd0aCkpCisgICAgICAgIHNlbGYu
aW5mbygiTGlieGwgUmVjb3JkOiAlcywgbGVuZ3RoICVkIiAlCisgICAgICAgICAgICAgICAgICAo
cmVjX3R5cGVfdG9fc3RyW3J0eXBlXSwgbGVuZ3RoKSkKIAogICAgICAgICBjb250ZW50c3ogPSAo
bGVuZ3RoICsgNykgJiB+NwogICAgICAgICBjb250ZW50ID0gc2VsZi5yZGV4YWN0KGNvbnRlbnRz
eikKQEAgLTEzMiw4ICsxMzIsOSBAQCBkZWYgdmVyaWZ5X3JlY29yZChzZWxmKToKICAgICAgICAg
ICAgIHJhaXNlIFN0cmVhbUVycm9yKCJQYWRkaW5nIGNvbnRhaW5pbmcgbm9uMCBieXRlcyBmb3Vu
ZCIpCiAKICAgICAgICAgaWYgcnR5cGUgbm90IGluIHJlY29yZF92ZXJpZmllcnM6Ci0gICAgICAg
ICAgICByYWlzZSBSdW50aW1lRXJyb3IoIk5vIHZlcmlmaWNhdGlvbiBmdW5jdGlvbiBmb3IgbGli
eGwgcmVjb3JkICclcyciCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSByZWNfdHlw
ZV90b19zdHJbcnR5cGVdKQorICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKAorICAgICAg
ICAgICAgICAgICJObyB2ZXJpZmljYXRpb24gZnVuY3Rpb24gZm9yIGxpYnhsIHJlY29yZCAnJXMn
IiAlCisgICAgICAgICAgICAgICAgcmVjX3R5cGVfdG9fc3RyW3J0eXBlXSkKICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgIHJlY29yZF92ZXJpZmllcnNbcnR5cGVdKHNlbGYsIGNvbnRlbnRbOmxl
bmd0aF0pCiAKQEAgLTE2MiwxNiArMTYzLDE2IEBAIGRlZiB2ZXJpZnlfcmVjb3JkX2VtdWxhdG9y
X3hlbnN0b3JlX2RhdGEoc2VsZiwgY29udGVudCk6CiAgICAgICAgIG1pbnN6ID0gY2FsY3NpemUo
RU1VTEFUT1JfSEVBREVSX0ZPUk1BVCkKIAogICAgICAgICBpZiBsZW4oY29udGVudCkgPCBtaW5z
ejoKLSAgICAgICAgICAgIHJhaXNlIFJlY29yZEVycm9yKCJMZW5ndGggbXVzdCBiZSBhdCBsZWFz
dCAlZCBieXRlcywgZ290ICVkIgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAobWlu
c3osIGxlbihjb250ZW50KSkpCisgICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiTGVuZ3Ro
IG11c3QgYmUgYXQgbGVhc3QgJWQgYnl0ZXMsIGdvdCAlZCIgJQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKG1pbnN6LCBsZW4oY29udGVudCkpKQogCiAgICAgICAgIGVtdV9pZCwgZW11
X2lkeCA9IHVucGFjayhFTVVMQVRPUl9IRUFERVJfRk9STUFULCBjb250ZW50WzptaW5zel0pCiAK
ICAgICAgICAgaWYgZW11X2lkIG5vdCBpbiBlbXVsYXRvcl9pZF90b19zdHI6CiAgICAgICAgICAg
ICByYWlzZSBSZWNvcmRFcnJvcigiVW5yZWNvZ25pc2VkIGVtdWxhdG9yIGlkIDB4JXgiICUgKGVt
dV9pZCwgKSkKIAotICAgICAgICBzZWxmLmluZm8oIkVtdWxhdG9yIFhlbnN0b3JlIERhdGEgKCVz
LCBpZHggJWQpIgotICAgICAgICAgICAgICAgICAgJSAoZW11bGF0b3JfaWRfdG9fc3RyW2VtdV9p
ZF0sIGVtdV9pZHgpKQorICAgICAgICBzZWxmLmluZm8oIkVtdWxhdG9yIFhlbnN0b3JlIERhdGEg
KCVzLCBpZHggJWQpIiAlCisgICAgICAgICAgICAgICAgICAoZW11bGF0b3JfaWRfdG9fc3RyW2Vt
dV9pZF0sIGVtdV9pZHgpKQogCiAgICAgICAgICMgQ2hvcCBvZmYgdGhlIGVtdWxhdG9yIGhlYWRl
cgogICAgICAgICBjb250ZW50ID0gY29udGVudFttaW5zejpdCkBAIC0xODUsOCArMTg2LDggQEAg
ZGVmIHZlcmlmeV9yZWNvcmRfZW11bGF0b3JfeGVuc3RvcmVfZGF0YShzZWxmLCBjb250ZW50KToK
ICAgICAgICAgICAgIHBhcnRzID0gY29udGVudFs6LTFdLnNwbGl0KCJceDAwIikKIAogICAgICAg
ICAgICAgaWYgKGxlbihwYXJ0cykgJSAyKSAhPSAwOgotICAgICAgICAgICAgICAgIHJhaXNlIFJl
Y29yZEVycm9yKCJFeHBlY3RlZCBhbiBldmVuIG51bWJlciBvZiBzdHJpbmdzLCBnb3QgJWQiCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJSAobGVuKHBhcnRzKSwgKSkKKyAgICAg
ICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiRXhwZWN0ZWQgYW4gZXZlbiBudW1iZXIgb2Yg
c3RyaW5ncywgZ290ICVkIiAlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGxl
bihwYXJ0cyksICkpCiAKICAgICAgICAgICAgIGZvciBrZXksIHZhbCBpbiB6aXAocGFydHNbMDo6
Ml0sIHBhcnRzWzE6OjJdKToKICAgICAgICAgICAgICAgICBzZWxmLmluZm8oIiAgJyVzJyA9ICcl
cyciICUgKGtleSwgdmFsKSkKQEAgLTE5Nyw4ICsxOTgsOCBAQCBkZWYgdmVyaWZ5X3JlY29yZF9l
bXVsYXRvcl9jb250ZXh0KHNlbGYsIGNvbnRlbnQpOgogICAgICAgICBtaW5zeiA9IGNhbGNzaXpl
KEVNVUxBVE9SX0hFQURFUl9GT1JNQVQpCiAKICAgICAgICAgaWYgbGVuKGNvbnRlbnQpIDwgbWlu
c3o6Ci0gICAgICAgICAgICByYWlzZSBSZWNvcmRFcnJvcigiTGVuZ3RoIG11c3QgYmUgYXQgbGVh
c3QgJWQgYnl0ZXMsIGdvdCAlZCIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICUgKG1p
bnN6LCBsZW4oY29udGVudCkpKQorICAgICAgICAgICAgcmFpc2UgUmVjb3JkRXJyb3IoIkxlbmd0
aCBtdXN0IGJlIGF0IGxlYXN0ICVkIGJ5dGVzLCBnb3QgJWQiICUKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChtaW5zeiwgbGVuKGNvbnRlbnQpKSkKIAogICAgICAgICBlbXVfaWQsIGVt
dV9pZHggPSB1bnBhY2soRU1VTEFUT1JfSEVBREVSX0ZPUk1BVCwgY29udGVudFs6bWluc3pdKQog
Ci0tIAoyLjExLjAKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9y
ZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

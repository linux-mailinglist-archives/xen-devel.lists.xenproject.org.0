Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 0C09C35F84
	for <lists+xen-devel@lfdr.de>; Wed,  5 Jun 2019 16:45:22 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hYX7Y-0000Cr-Gq; Wed, 05 Jun 2019 14:42:32 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=gpCR=UE=citrix.com=roger.pau@srs-us1.protection.inumbo.net>)
 id 1hYX7X-0000Cl-CO
 for xen-devel@lists.xenproject.org; Wed, 05 Jun 2019 14:42:31 +0000
X-Inumbo-ID: 22beb268-87a0-11e9-b9e0-e3b0f7591e0a
Received: from esa5.hc3370-68.iphmx.com (unknown [216.71.155.168])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 22beb268-87a0-11e9-b9e0-e3b0f7591e0a;
 Wed, 05 Jun 2019 14:42:26 +0000 (UTC)
Authentication-Results: esa5.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=roger.pau@citrix.com;
 spf=Pass smtp.mailfrom=roger.pau@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 roger.pau@citrix.com) identity=pra; client-ip=23.29.105.83;
 receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa5.hc3370-68.iphmx.com: domain of
 roger.pau@citrix.com designates 23.29.105.83 as permitted
 sender) identity=mailfrom; client-ip=23.29.105.83;
 receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:23.29.105.83 ip4:162.221.156.50 ~all"
Received-SPF: None (esa5.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=23.29.105.83; receiver=esa5.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: VHaeMGNlMZiMvalQ1T1j/A9IimdnizHWOxdJTAoqKhZ6IqF7mVKhqasrFiiucv2mWxagl0XGdF
 JcjYsRM9s23rDBaUSHjxP+2hfb+elA+isvGDWqNsa7F2JuHKTxB66hDUOYZePspDlR3VZFDD9r
 JEPlKFnw5I6QCl2c4a87JvtV545su0KOocWukgJQOqDquox2/qycpi74yzOJE9Mrx9NjsSlvc+
 w8vPZdzu5Sn1QSJDqjYSd88UZyM/CLa9ujbOaHQ1yU4aPiGnKWz9/kfrgdUJ3h3FPjKwBaWukd
 04A=
X-SBRS: 2.7
X-MesageID: 1327612
X-Ironport-Server: esa5.hc3370-68.iphmx.com
X-Remote-IP: 23.29.105.83
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.60,550,1549947600"; 
   d="scan'208";a="1327612"
Date: Wed, 5 Jun 2019 16:42:15 +0200
From: Roger Pau =?utf-8?B?TW9ubsOp?= <roger.pau@citrix.com>
To: Chao Gao <chao.gao@intel.com>
Message-ID: <20190605144215.3xyyi33adkfu2emi@Air-de-Roger>
References: <1558945891-3015-1-git-send-email-chao.gao@intel.com>
 <1558945891-3015-9-git-send-email-chao.gao@intel.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <1558945891-3015-9-git-send-email-chao.gao@intel.com>
User-Agent: NeoMutt/20180716
X-ClientProxiedBy: AMSPEX02CAS01.citrite.net (10.69.22.112) To
 AMSPEX02CL02.citrite.net (10.69.22.126)
Subject: Re: [Xen-devel] [PATCH v7 08/10] x86/microcode: Synchronize late
 microcode loading
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Sergey Dyasli <sergey.dyasli@citrix.com>, Kevin Tian <kevin.tian@intel.com>,
 Ashok Raj <ashok.raj@intel.com>, Wei Liu <wl@xen.org>,
 Jun Nakajima <jun.nakajima@intel.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Jan Beulich <jbeulich@suse.com>,
 xen-devel@lists.xenproject.org, Thomas Gleixner <tglx@linutronix.de>, Borislav
 Petkov <bp@suse.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gTW9uLCBNYXkgMjcsIDIwMTkgYXQgMDQ6MzE6MjlQTSArMDgwMCwgQ2hhbyBHYW8gd3JvdGU6
Cj4gVGhpcyBwYXRjaCBwb3J0cyBtaWNyb2NvZGUgaW1wcm92ZW1lbnQgcGF0Y2hlcyBmcm9tIGxp
bnV4IGtlcm5lbC4KPiAKPiBCZWZvcmUgeW91IHJlYWQgYW55IGZ1cnRoZXI6IHRoZSBlYXJseSBs
b2FkaW5nIG1ldGhvZCBpcyBzdGlsbCB0aGUKPiBwcmVmZXJyZWQgb25lIGFuZCB5b3Ugc2hvdWxk
IGFsd2F5cyBkbyB0aGF0LiBUaGUgZm9sbG93aW5nIHBhdGNoIGlzCj4gaW1wcm92aW5nIHRoZSBs
YXRlIGxvYWRpbmcgbWVjaGFuaXNtIGZvciBsb25nIHJ1bm5pbmcgam9icyBhbmQgY2xvdWQgdXNl
Cj4gY2FzZXMuCj4gCj4gR2F0aGVyIGFsbCBjb3JlcyBhbmQgc2VyaWFsaXplIHRoZSBtaWNyb2Nv
ZGUgdXBkYXRlIG9uIHRoZW0gYnkgZG9pbmcgaXQKPiBvbmUtYnktb25lIHRvIG1ha2UgdGhlIGxh
dGUgdXBkYXRlIHByb2Nlc3MgYXMgcmVsaWFibGUgYXMgcG9zc2libGUgYW5kCj4gYXZvaWQgcG90
ZW50aWFsIGlzc3VlcyBjYXVzZWQgYnkgdGhlIG1pY3JvY29kZSB1cGRhdGUuCj4gCj4gU2lnbmVk
LW9mZi1ieTogQ2hhbyBHYW8gPGNoYW8uZ2FvQGludGVsLmNvbT4KPiBUZXN0ZWQtYnk6IENoYW8g
R2FvIDxjaGFvLmdhb0BpbnRlbC5jb20+Cj4gW2xpbnV4IGNvbW1pdDogYTUzMjFhZWM2NDEyYjIw
YjVhZDE1ZGIyZDZiOTE2YzA1MzQ5ZGJmZl0KPiBbbGludXggY29tbWl0OiBiYjhjMTNkNjFhNjI5
Mjc2YTE2MmMxZDJiMWEyMGE4MTVjYmNmYmI3XQo+IENjOiBLZXZpbiBUaWFuIDxrZXZpbi50aWFu
QGludGVsLmNvbT4KPiBDYzogSnVuIE5ha2FqaW1hIDxqdW4ubmFrYWppbWFAaW50ZWwuY29tPgo+
IENjOiBBc2hvayBSYWogPGFzaG9rLnJhakBpbnRlbC5jb20+Cj4gQ2M6IEJvcmlzbGF2IFBldGtv
diA8YnBAc3VzZS5kZT4KPiBDYzogVGhvbWFzIEdsZWl4bmVyIDx0Z2x4QGxpbnV0cm9uaXguZGU+
Cj4gQ2M6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+Cj4gQ2M6IEph
biBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KPiAtLS0KPiBDaGFuZ2VzIGluIHY3Ogo+ICAt
IENoZWNrIHdoZXRoZXIgJ3RpbWVvdXQnIGlzIDAgcmF0aGVyIHRoYW4gIjw9MCIgc2luY2UgaXQg
aXMgdW5zaWduZWQgaW50Lgo+ICAtIHJld29yZCB0aGUgY29tbWVudCBhYm92ZSBtaWNyb2NvZGVf
dXBkYXRlX2NwdSgpIHRvIGNsZWFybHkgc3RhdGUgdGhhdAo+ICBvbmUgdGhyZWFkIHBlciBjb3Jl
IHNob3VsZCBkbyB0aGUgdXBkYXRlLgo+IAo+IENoYW5nZXMgaW4gdjY6Cj4gIC0gVXNlIG9uZSB0
aW1lb3V0IHBlcmlvZCBmb3IgcmVuZGV6dm91cyBzdGFnZSBhbmQgYW5vdGhlciBmb3IgdXBkYXRl
IHN0YWdlLgo+ICAtIHNjYWxlIHRpbWUgdG8gd2FpdCBieSB0aGUgbnVtYmVyIG9mIHJlbWFpbmlu
ZyBjcHVzIHRvIHJlc3BvbmQuCj4gICAgSXQgaGVscHMgdG8gZmluZCBzb21ldGhpbmcgd3Jvbmcg
ZWFybGllciBhbmQgdGh1cyB3ZSBjYW4gcmVib290IHRoZQo+ICAgIHN5c3RlbSBlYXJsaWVyLgo+
IC0tLQo+ICB4ZW4vYXJjaC94ODYvbWljcm9jb2RlLmMgfCAxNzEgKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0KPiAgMSBmaWxlIGNoYW5nZWQsIDE1NSBpbnNl
cnRpb25zKCspLCAxNiBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L21pY3JvY29kZS5jIGIveGVuL2FyY2gveDg2L21pY3JvY29kZS5jCj4gaW5kZXggMjNjZjU1MC4u
ZjRhNDE3ZSAxMDA2NDQKPiAtLS0gYS94ZW4vYXJjaC94ODYvbWljcm9jb2RlLmMKPiArKysgYi94
ZW4vYXJjaC94ODYvbWljcm9jb2RlLmMKPiBAQCAtMjIsNiArMjIsNyBAQAo+ICAgKi8KPiAgCj4g
ICNpbmNsdWRlIDx4ZW4vY3B1Lmg+Cj4gKyNpbmNsdWRlIDx4ZW4vY3B1bWFzay5oPgo+ICAjaW5j
bHVkZSA8eGVuL2xpYi5oPgo+ICAjaW5jbHVkZSA8eGVuL2tlcm5lbC5oPgo+ICAjaW5jbHVkZSA8
eGVuL2luaXQuaD4KPiBAQCAtMzAsMTUgKzMxLDM0IEBACj4gICNpbmNsdWRlIDx4ZW4vc21wLmg+
Cj4gICNpbmNsdWRlIDx4ZW4vc29mdGlycS5oPgo+ICAjaW5jbHVkZSA8eGVuL3NwaW5sb2NrLmg+
Cj4gKyNpbmNsdWRlIDx4ZW4vc3RvcF9tYWNoaW5lLmg+Cj4gICNpbmNsdWRlIDx4ZW4vdGFza2xl
dC5oPgo+ICAjaW5jbHVkZSA8eGVuL2d1ZXN0X2FjY2Vzcy5oPgo+ICAjaW5jbHVkZSA8eGVuL2Vh
cmx5Y3Bpby5oPgo+ICsjaW5jbHVkZSA8eGVuL3dhdGNoZG9nLmg+Cj4gIAo+ICsjaW5jbHVkZSA8
YXNtL2RlbGF5Lmg+Cj4gICNpbmNsdWRlIDxhc20vbXNyLmg+Cj4gICNpbmNsdWRlIDxhc20vcHJv
Y2Vzc29yLmg+Cj4gICNpbmNsdWRlIDxhc20vc2V0dXAuaD4KPiAgI2luY2x1ZGUgPGFzbS9taWNy
b2NvZGUuaD4KPiAgCj4gKy8qCj4gKyAqIEJlZm9yZSBwZXJmb3JtaW5nIGEgbGF0ZSBtaWNyb2Nv
ZGUgdXBkYXRlIG9uIGFueSB0aHJlYWQsIHdlCj4gKyAqIHJlbmRlenZvdXMgYWxsIGNwdXMgaW4g
c3RvcF9tYWNoaW5lIGNvbnRleHQuIFRoZSB0aW1lb3V0IGZvcgo+ICsgKiB3YWl0aW5nIGZvciBj
cHUgcmVuZGV6dm91cyBpcyAzMG1zLiBJdCBpcyB0aGUgdGltZW91dCB1c2VkIGJ5Cj4gKyAqIGxp
dmUgcGF0Y2hpbmcKPiArICovCj4gKyNkZWZpbmUgTUlDUk9DT0RFX0NBTExJTl9USU1FT1VUX1VT
IDMwMDAwCj4gKwo+ICsvKgo+ICsgKiBUaW1lb3V0IGZvciBlYWNoIHRocmVhZCB0byBjb21wbGV0
ZSB1cGRhdGUgaXMgc2V0IHRvIDFzLiBJdCBpcyBhCj4gKyAqIGNvbnNlcnZhdGl2ZSBjaG9pY2Ug
Y29uc2lkZXJpbmcgYWxsIHBvc3NpYmxlIGludGVyZmVyZW5jZSAoZm9yCj4gKyAqIGluc3RhbmNl
LCBzb21ldGltZXMgd2JpbnZkIHRha2VzIHJlbGF0aXZlIGxvbmcgdGltZSkuIEFuZCBhIHBlcmZl
Y3QKPiArICogdGltZW91dCBkb2Vzbid0IGhlbHAgYSBsb3QgZXhjZXB0IGFuIGVhcmx5IHNodXRk
b3duLgoKSSB3b3VsZCByZW1vdmUgdGhlICJBbmQgYSBwZXJmZWN0Li4uIiBzZW50ZW5jZS4gSSBk
b24ndCB0aGluayBpdCBtYWtlcwptdWNoIHNlbnNlIHRvIHNwZWFrIGFib3V0ICJwZXJmZWN0IHRp
bWVvdXRzIi4KCj4gKyAqLwo+ICsjZGVmaW5lIE1JQ1JPQ09ERV9VUERBVEVfVElNRU9VVF9VUyAx
MDAwMDAwCj4gKwo+ICBzdGF0aWMgbW9kdWxlX3QgX19pbml0ZGF0YSB1Y29kZV9tb2Q7Cj4gIHN0
YXRpYyBzaWduZWQgaW50IF9faW5pdGRhdGEgdWNvZGVfbW9kX2lkeDsKPiAgc3RhdGljIGJvb2xf
dCBfX2luaXRkYXRhIHVjb2RlX21vZF9mb3JjZWQ7Cj4gQEAgLTE5MCw2ICsyMTAsMTIgQEAgc3Rh
dGljIERFRklORV9TUElOTE9DSyhtaWNyb2NvZGVfbXV0ZXgpOwo+ICBERUZJTkVfUEVSX0NQVShz
dHJ1Y3QgY3B1X3NpZ25hdHVyZSwgY3B1X3NpZyk7Cj4gIAo+ICAvKgo+ICsgKiBDb3VudCB0aGUg
Q1BVcyB0aGF0IGhhdmUgZW50ZXJlZCwgZXhpdGVkIHRoZSByZW5kZXp2b3VzIGFuZCBzdWNjZWVk
ZWQgaW4KPiArICogbWljcm9jb2RlIHVwZGF0ZSBkdXJpbmcgbGF0ZSBtaWNyb2NvZGUgdXBkYXRl
IHJlc3BlY3RpdmVseS4KPiArICovCj4gK3N0YXRpYyBhdG9taWNfdCBjcHVfaW4sIGNwdV9vdXQs
IGNwdV91cGRhdGVkOwo+ICsKPiArLyoKPiAgICogUmV0dXJuIHRoZSBwYXRjaCB3aXRoIHRoZSBo
aWdoZXN0IHJldmlzaW9uIGlkIGFtb25nIGFsbCBtYXRjaGluZwo+ICAgKiBwYXRjaGVzIGluIHRo
ZSBibG9iLiBSZXR1cm4gTlVMTCBpZiBubyBzdWl0YWJsZSBwYXRjaC4KPiAgICovCj4gQEAgLTI3
MCwzMSArMjk2LDkwIEBAIGJvb2wgbWljcm9jb2RlX3VwZGF0ZV9jYWNoZShzdHJ1Y3QgbWljcm9j
b2RlX3BhdGNoICpwYXRjaCkKPiAgICAgIHJldHVybiB0cnVlOwo+ICB9Cj4gIAo+IC1zdGF0aWMg
bG9uZyBkb19taWNyb2NvZGVfdXBkYXRlKHZvaWQgKnBhdGNoKQo+ICsvKiBXYWl0IGZvciBDUFVz
IHRvIHJlbmRlenZvdXMgd2l0aCBhIHRpbWVvdXQgKHVzKSAqLwo+ICtzdGF0aWMgaW50IHdhaXRf
Zm9yX2NwdXMoYXRvbWljX3QgKmNudCwgdW5zaWduZWQgaW50IGV4cGVjdCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCB0aW1lb3V0KQo+ICB7Cj4gLSAgICBpbnQgZXJy
b3IsIGNwdTsKPiAtCj4gLSAgICBlcnJvciA9IG1pY3JvY29kZV91cGRhdGVfY3B1KHBhdGNoKTsK
PiAtICAgIGlmICggZXJyb3IgKQo+ICsgICAgd2hpbGUgKCBhdG9taWNfcmVhZChjbnQpIDwgZXhw
ZWN0ICkKPiAgICAgIHsKPiAtICAgICAgICBtaWNyb2NvZGVfb3BzLT5mcmVlX3BhdGNoKG1pY3Jv
Y29kZV9jYWNoZSk7Cj4gLSAgICAgICAgcmV0dXJuIGVycm9yOwo+ICsgICAgICAgIGlmICggIXRp
bWVvdXQgKQo+ICsgICAgICAgIHsKPiArICAgICAgICAgICAgcHJpbnRrKCJDUFUlZDogVGltZW91
dCB3aGVuIHdhaXRpbmcgZm9yIENQVXMgY2FsbGluZyBpblxuIiwKPiArICAgICAgICAgICAgICAg
ICAgIHNtcF9wcm9jZXNzb3JfaWQoKSk7Cj4gKyAgICAgICAgICAgIHJldHVybiAtRUJVU1k7Cj4g
KyAgICAgICAgfQo+ICsgICAgICAgIHVkZWxheSgxKTsKPiArICAgICAgICB0aW1lb3V0LS07CgpO
aXQ6IHlvdSBjb3VsZCBkbyB0aGUgZGVjcmVtZW50IGluc2lkZSB0aGUgaWYgY29uZGl0aW9uLgoK
PiAgICAgIH0KPiAgCj4gKyAgICByZXR1cm4gMDsKPiArfQo+ICAKPiAtICAgIGNwdSA9IGNwdW1h
c2tfbmV4dChzbXBfcHJvY2Vzc29yX2lkKCksICZjcHVfb25saW5lX21hcCk7Cj4gLSAgICBpZiAo
IGNwdSA8IG5yX2NwdV9pZHMgKQo+IC0gICAgICAgIHJldHVybiBjb250aW51ZV9oeXBlcmNhbGxf
b25fY3B1KGNwdSwgZG9fbWljcm9jb2RlX3VwZGF0ZSwgcGF0Y2gpOwo+ICtzdGF0aWMgaW50IGRv
X21pY3JvY29kZV91cGRhdGUodm9pZCAqcGF0Y2gpCj4gK3sKPiArICAgIHVuc2lnbmVkIGludCBj
cHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7Cj4gKyAgICB1bnNpZ25lZCBpbnQgY3B1X25yID0gbnVt
X29ubGluZV9jcHVzKCk7Cj4gKyAgICB1bnNpZ25lZCBpbnQgZmluaXNoZWQ7Cj4gKyAgICBpbnQg
cmV0Owo+ICsgICAgc3RhdGljIGJvb2wgZXJyb3I7Cj4gIAo+IC0gICAgbWljcm9jb2RlX3VwZGF0
ZV9jYWNoZShwYXRjaCk7Cj4gKyAgICBhdG9taWNfaW5jKCZjcHVfaW4pOwo+ICsgICAgcmV0ID0g
d2FpdF9mb3JfY3B1cygmY3B1X2luLCBjcHVfbnIsIE1JQ1JPQ09ERV9DQUxMSU5fVElNRU9VVF9V
Uyk7Cj4gKyAgICBpZiAoIHJldCApCj4gKyAgICAgICAgcmV0dXJuIHJldDsKPiAgCj4gLSAgICBy
ZXR1cm4gZXJyb3I7Cj4gKyAgICByZXQgPSBtaWNyb2NvZGVfb3BzLT5jb2xsZWN0X2NwdV9pbmZv
KCZ0aGlzX2NwdShjcHVfc2lnKSk7Cj4gKyAgICAvKgo+ICsgICAgICogTG9hZCBtaWNyb2NvZGUg
dXBkYXRlIG9uIG9ubHkgb25lIGxvZ2ljYWwgcHJvY2Vzc29yIHBlciBjb3JlLgo+ICsgICAgICog
SGVyZSwgYW1vbmcgbG9naWNhbCBwcm9jZXNzb3JzIG9mIGEgY29yZSwgdGhlIG9uZSB3aXRoIHRo
ZQo+ICsgICAgICogbG93ZXN0IHRocmVhZCBpZCBpcyBjaG9zZW4gdG8gcGVyZm9ybSB0aGUgbG9h
ZGluZy4KPiArICAgICAqLwo+ICsgICAgaWYgKCAhcmV0ICYmIChjcHUgPT0gY3B1bWFza19maXJz
dChwZXJfY3B1KGNwdV9zaWJsaW5nX21hc2ssIGNwdSkpKSApCj4gKyAgICB7Cj4gKyAgICAgICAg
cmV0ID0gbWljcm9jb2RlX29wcy0+YXBwbHlfbWljcm9jb2RlKHBhdGNoKTsKPiArICAgICAgICBp
ZiAoICFyZXQgKQo+ICsgICAgICAgICAgICBhdG9taWNfaW5jKCZjcHVfdXBkYXRlZCk7Cj4gKyAg
ICB9Cj4gKyAgICAvKgo+ICsgICAgICogSW5jcmVhc2UgdGhlIHdhaXQgdGltZW91dCB0byBhIHNh
ZmUgdmFsdWUgaGVyZSBzaW5jZSB3ZSdyZSBzZXJpYWxpemluZwo+ICsgICAgICogdGhlIG1pY3Jv
Y29kZSB1cGRhdGUgYW5kIHRoYXQgY291bGQgdGFrZSBhIHdoaWxlIG9uIGEgbGFyZ2UgbnVtYmVy
IG9mCj4gKyAgICAgKiBDUFVzLiBBbmQgdGhhdCBpcyBmaW5lIGFzIHRoZSAqYWN0dWFsKiB0aW1l
b3V0IHdpbGwgYmUgZGV0ZXJtaW5lZCBieQo+ICsgICAgICogdGhlIGxhc3QgQ1BVIGZpbmlzaGVk
IHVwZGF0aW5nIGFuZCB0aHVzIGN1dCBzaG9ydAoKSXQncyBsaWtlbHkgbWUgbWlzc2luZyBzb21l
dGhpbmcsIGJ1dCB3aGVyZSBpcyB0aGlzIHNlcmlhbGl6YXRpb24KYmVpbmcgZG9uZT8KCkkgYXNz
dW1lIGl0J3MgZG9uZSBieSBhcHBseV9taWNyb2NvZGUgYmVjYXVzZSBkb19taWNyb2NvZGVfdXBk
YXRlCmRvZXNuJ3QgZG8gYW55IHNlcmlhbGl6YXRpb24gb2YgbWljcm9jb2RlIGxvYWRpbmcuCgo+
ICsgICAgICovCj4gKyAgICBhdG9taWNfaW5jKCZjcHVfb3V0KTsKPiArICAgIGZpbmlzaGVkID0g
YXRvbWljX3JlYWQoJmNwdV9vdXQpOwo+ICsgICAgd2hpbGUgKCAhZXJyb3IgJiYgZmluaXNoZWQg
IT0gY3B1X25yICkKPiArICAgIHsKPiArICAgICAgICAvKgo+ICsgICAgICAgICAqIER1cmluZyBl
YWNoIHRpbWVvdXQgaW50ZXJ2YWwsIGF0IGxlYXN0IGEgQ1BVIGlzIGV4cGVjdGVkIHRvCj4gKyAg
ICAgICAgICogZmluaXNoIGl0cyB1cGRhdGUuIE90aGVyd2lzZSwgc29tZXRoaW5nIGdvZXMgd3Jv
bmcuCj4gKyAgICAgICAgICovCj4gKyAgICAgICAgaWYgKCB3YWl0X2Zvcl9jcHVzKCZjcHVfb3V0
LCBmaW5pc2hlZCArIDEsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIE1JQ1JPQ09ERV9V
UERBVEVfVElNRU9VVF9VUykgJiYgIWVycm9yICkKPiArICAgICAgICB7Cj4gKyAgICAgICAgICAg
IGVycm9yID0gdHJ1ZTsKCkknbSBub3Qgc3VyZSBJIHNlZSB0aGUgcG9pbnQgb2YgdGhlIGVycm9y
IHZhcmlhYmxlLCB5b3UgYWxyZWFkeSBicmluZwp0aGUgc3lzdGVtIGRvd24gd2l0aCBwYW5pYy4g
SWYgdGhlIGludGVudGlvbiBpcyB0byBwcmV2ZW50IG11bHRpcGxlCnBhbmljcyBmcm9tIGRpZmZl
cmVudCB0aHJlYWRzIHRoZW4geW91IG5lZWQgdG8gdXNlIHNvbWUga2luZCBvZgphdG9taWMgZmV0
Y2ggYW5kIHNldCBvciBlbHNlIHRoZSBjb2RlIGlzIHJhY3kuCgo+ICsgICAgICAgICAgICBwYW5p
YygiVGltZW91dCB3aGVuIGZpbmlzaGluZyB1cGRhdGluZyBtaWNyb2NvZGUgKGZpbmlzaGVkICVk
LyVkKSIsCgpCb3RoIGZpbmlzaGVkIGFuZCBjcHVfbnIgYXJlIHVuc2lnbmVkIGludHMsIGhlbmNl
IHlvdSBzaG91bGQgdXNlICV1Cmluc3RlYWQgb2YgJWQuCgo+ICsgICAgICAgICAgICAgICAgICBm
aW5pc2hlZCwgY3B1X25yKTsKPiArICAgICAgICB9CgpUaGlzIHdob2xlIGxvb3Agc2VlbXMgdG8g
YmUgZGVzaWduZWQgZm9yIHNlcmlhbGl6ZWQgbWljcm9jb2RlCmFwcGxpY2F0aW9uLCB3aGljaCBp
cyBub3QgdGhlIGNhc2Ugd2l0aCB0aGUgY3VycmVudCBpbXBsZW1lbnRhdGlvbgp3aGVyZSBtaWNy
b2NvZGUgaXMgdXBkYXRlZCBpbiBwYXJhbGxlbCBvbiBhbGwgdGhlIGNvcmVzPwoKSU1PIHlvdSBz
aG91bGQganVzdCB3YWl0IGZvciBNSUNST0NPREVfVVBEQVRFX1RJTUVPVVRfVVMgYSBzaW5nbGUK
dGltZS4KCj4gKyAgICAgICAgZmluaXNoZWQgPSBhdG9taWNfcmVhZCgmY3B1X291dCk7Cj4gKyAg
ICB9Cj4gKwo+ICsgICAgLyoKPiArICAgICAqIFJlZnJlc2ggQ1BVIHNpZ25hdHVyZSAocmV2aXNp
b24pIG9uIHRocmVhZHMgd2hpY2ggZGlkbid0IGNhbGwKPiArICAgICAqIGFwcGx5X21pY3JvY29k
ZSgpLgo+ICsgICAgICovCj4gKyAgICBpZiAoIGNwdSAhPSBjcHVtYXNrX2ZpcnN0KHBlcl9jcHUo
Y3B1X3NpYmxpbmdfbWFzaywgY3B1KSkgKQo+ICsgICAgICAgIHJldCA9IG1pY3JvY29kZV9vcHMt
PmNvbGxlY3RfY3B1X2luZm8oJnRoaXNfY3B1KGNwdV9zaWcpKTsKPiArCj4gKyAgICByZXR1cm4g
cmV0Owo+ICB9Cj4gIAo+ICBpbnQgbWljcm9jb2RlX3VwZGF0ZShYRU5fR1VFU1RfSEFORExFX1BB
UkFNKGNvbnN0X3ZvaWQpIGJ1ZiwgdW5zaWduZWQgbG9uZyBsZW4pCj4gIHsKPiAgICAgIGludCBy
ZXQ7Cj4gICAgICB2b2lkICpidWZmZXI7Cj4gKyAgICB1bnNpZ25lZCBpbnQgY3B1LCBucl9jb3Jl
czsKPiAgICAgIHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnBhdGNoOwo+ICAKPiAgICAgIGlmICgg
bGVuICE9ICh1aW50MzJfdClsZW4gKQo+IEBAIC0zMTYsMTEgKzQwMSwxOCBAQCBpbnQgbWljcm9j
b2RlX3VwZGF0ZShYRU5fR1VFU1RfSEFORExFX1BBUkFNKGNvbnN0X3ZvaWQpIGJ1ZiwgdW5zaWdu
ZWQgbG9uZyBsZW4pCj4gICAgICAgICAgZ290byBmcmVlOwo+ICAgICAgfQo+ICAKPiArICAgIC8q
IGNwdV9vbmxpbmVfbWFwIG11c3Qgbm90IGNoYW5nZSBkdXJpbmcgdXBkYXRlICovCj4gKyAgICBp
ZiAoICFnZXRfY3B1X21hcHMoKSApCj4gKyAgICB7Cj4gKyAgICAgICAgcmV0ID0gLUVCVVNZOwo+
ICsgICAgICAgIGdvdG8gZnJlZTsKPiArICAgIH0KPiArCj4gICAgICBpZiAoIG1pY3JvY29kZV9v
cHMtPnN0YXJ0X3VwZGF0ZSApCj4gICAgICB7Cj4gICAgICAgICAgcmV0ID0gbWljcm9jb2RlX29w
cy0+c3RhcnRfdXBkYXRlKCk7Cj4gICAgICAgICAgaWYgKCByZXQgIT0gMCApCj4gLSAgICAgICAg
ICAgIGdvdG8gZnJlZTsKPiArICAgICAgICAgICAgZ290byBwdXQ7Cj4gICAgICB9Cj4gIAo+ICAg
ICAgcGF0Y2ggPSBtaWNyb2NvZGVfcGFyc2VfYmxvYihidWZmZXIsIGxlbik7Cj4gQEAgLTMzNywx
MiArNDI5LDU5IEBAIGludCBtaWNyb2NvZGVfdXBkYXRlKFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0o
Y29uc3Rfdm9pZCkgYnVmLCB1bnNpZ25lZCBsb25nIGxlbikKPiAgICAgICAgICBpZiAoIHBhdGNo
ICkKPiAgICAgICAgICAgICAgbWljcm9jb2RlX29wcy0+ZnJlZV9wYXRjaChwYXRjaCk7Cj4gICAg
ICAgICAgcmV0ID0gLUVJTlZBTDsKPiAtICAgICAgICBnb3RvIGZyZWU7Cj4gKyAgICAgICAgZ290
byBwdXQ7Cj4gICAgICB9Cj4gIAo+IC0gICAgcmV0ID0gY29udGludWVfaHlwZXJjYWxsX29uX2Nw
dShjcHVtYXNrX2ZpcnN0KCZjcHVfb25saW5lX21hcCksCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGRvX21pY3JvY29kZV91cGRhdGUsIHBhdGNoKTsKPiArICAgIGF0b21p
Y19zZXQoJmNwdV9pbiwgMCk7Cj4gKyAgICBhdG9taWNfc2V0KCZjcHVfb3V0LCAwKTsKPiArICAg
IGF0b21pY19zZXQoJmNwdV91cGRhdGVkLCAwKTsKPiArCj4gKyAgICAvKiBDYWxjdWxhdGUgdGhl
IG51bWJlciBvZiBvbmxpbmUgQ1BVIGNvcmUgKi8KPiArICAgIG5yX2NvcmVzID0gMDsKPiArICAg
IGZvcl9lYWNoX29ubGluZV9jcHUoY3B1KQo+ICsgICAgICAgIGlmICggY3B1ID09IGNwdW1hc2tf
Zmlyc3QocGVyX2NwdShjcHVfc2libGluZ19tYXNrLCBjcHUpKSApCj4gKyAgICAgICAgICAgIG5y
X2NvcmVzKys7Cj4gKwo+ICsgICAgcHJpbnRrKFhFTkxPR19JTkZPICIlZCBjb3JlcyBhcmUgdG8g
dXBkYXRlIHRoZWlyIG1pY3JvY29kZVxuIiwgbnJfY29yZXMpOwoKU2FtZSBoZXJlLCBucl9jb3Jl
cyBpcyB1bnNpZ25lZC4KCj4gKwo+ICsgICAgLyoKPiArICAgICAqIFdlIGludGVuZCB0byBkaXNh
YmxlIGludGVycnVwdCBmb3IgbG9uZyB0aW1lLCB3aGljaCBtYXkgbGVhZCB0bwo+ICsgICAgICog
d2F0Y2hkb2cgdGltZW91dC4KPiArICAgICAqLwo+ICsgICAgd2F0Y2hkb2dfZGlzYWJsZSgpOwo+
ICsgICAgLyoKPiArICAgICAqIExhdGUgbG9hZGluZyBkYW5jZS4gV2h5IHRoZSBoZWF2eS1oYW5k
ZWQgc3RvcF9tYWNoaW5lIGVmZm9ydD8KPiArICAgICAqCj4gKyAgICAgKiAtIEhUIHNpYmxpbmdz
IG11c3QgYmUgaWRsZSBhbmQgbm90IGV4ZWN1dGUgb3RoZXIgY29kZSB3aGlsZSB0aGUgb3RoZXIK
PiArICAgICAqICAgc2libGluZyBpcyBsb2FkaW5nIG1pY3JvY29kZSBpbiBvcmRlciB0byBhdm9p
ZCBhbnkgbmVnYXRpdmUKPiArICAgICAqICAgaW50ZXJhY3Rpb25zIGNhdXNlIGJ5IHRoZSBsb2Fk
aW5nLgo+ICsgICAgICoKPiArICAgICAqIC0gSW4gYWRkaXRpb24sIG1pY3JvY29kZSB1cGRhdGUg
b24gdGhlIGNvcmVzIG11c3QgYmUgc2VyaWFsaXplZCB1bnRpbAo+ICsgICAgICogICB0aGlzIHJl
cXVpcmVtZW50IGNhbiBiZSByZWxheGVkIGluIHRoZSBmdXR1cmUuIFJpZ2h0IG5vdywgdGhpcyBp
cwo+ICsgICAgICogICBjb25zZXJ2YXRpdmUgYW5kIGdvb2QuCj4gKyAgICAgKi8KPiArICAgIHJl
dCA9IHN0b3BfbWFjaGluZV9ydW4oZG9fbWljcm9jb2RlX3VwZGF0ZSwgcGF0Y2gsIE5SX0NQVVMp
Owo+ICsgICAgd2F0Y2hkb2dfZW5hYmxlKCk7Cj4gKwo+ICsgICAgaWYgKCBhdG9taWNfcmVhZCgm
Y3B1X3VwZGF0ZWQpID09IG5yX2NvcmVzICkKPiArICAgIHsKPiArICAgICAgICBzcGluX2xvY2so
Jm1pY3JvY29kZV9tdXRleCk7Cj4gKyAgICAgICAgbWljcm9jb2RlX3VwZGF0ZV9jYWNoZShwYXRj
aCk7Cj4gKyAgICAgICAgc3Bpbl91bmxvY2soJm1pY3JvY29kZV9tdXRleCk7Cj4gKyAgICB9Cj4g
KyAgICBlbHNlIGlmICggYXRvbWljX3JlYWQoJmNwdV91cGRhdGVkKSA9PSAwICkKPiArICAgICAg
ICBtaWNyb2NvZGVfb3BzLT5mcmVlX3BhdGNoKHBhdGNoKTsKPiArICAgIGVsc2UKPiArICAgIHsK
PiArICAgICAgICBwcmludGsoIlVwZGF0aW5nIG1pY3JvY29kZSBzdWNjZWVkZWQgb24gcGFydCBv
ZiBDUFVzIGFuZCBmYWlsZWQgb25cbiIKCkkgd291bGQgcHJlZml4IHRoaXMgd2l0aCBYRU5MT0df
RVJSIGFuZCBhbiBleHBsaWNpdCAiRVJST1I6ICIgcHJlZml4CmluIHRoZSBmb3JtYXQgc3RyaW5n
LgoKVGhhbmtzLCBSb2dlci4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2pl
Y3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4t
ZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 86C77EB089
	for <lists+xen-devel@lfdr.de>; Thu, 31 Oct 2019 13:43:13 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iQ9jQ-0002A3-Ab; Thu, 31 Oct 2019 12:39:16 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=CAAN=YY=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iQ9aJ-0007H8-56
 for xen-devel@lists.xen.org; Thu, 31 Oct 2019 12:29:51 +0000
X-Inumbo-ID: 18eab4fe-fbda-11e9-beca-bc764e2007e4
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 18eab4fe-fbda-11e9-beca-bc764e2007e4;
 Thu, 31 Oct 2019 12:29:35 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iQ9Zw-00079n-Fj; Thu, 31 Oct 2019 12:29:28 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iQ9Zw-0002vd-B1; Thu, 31 Oct 2019 12:29:28 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iQ9Zw-0002vd-B1@xenbits.xenproject.org>
Date: Thu, 31 Oct 2019 12:29:28 +0000
X-Mailman-Approved-At: Thu, 31 Oct 2019 12:39:13 +0000
Subject: [Xen-devel] Xen Security Advisory 299 v4 (CVE-2019-18421) - Issues
 with restartable PV type change operations
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-18421 / XSA-299
                               version 4

           Issues with restartable PV type change operations

UPDATES IN VERSION 4
====================

Public release.

ISSUE DESCRIPTION
=================

To avoid using shadow pagetables for PV guests, Xen exposes the actual
hardware pagetables to the guest.  In order to prevent the guest from
modifying these page tables directly, Xen keeps track of how pages are
used using a type system; pages must be "promoted" before being used
as a pagetable, and "demoted" before being used for any other type.
Xen also allows for "recursive" promotions: i.e., an operating system
promoting a page to an L4 pagetable may end up causing pages to be
promoted to L3s, which may in turn cause pages to be promoted to L2s,
and so on.  These operations may take an arbitrarily large amount of
time, and so must be re-startable.

Unfortunately, making recursive pagetable promotion and demotion
operations restartable is incredibly complicated, and the code
contains several races which, if triggered, can cause Xen to drop or
retain extra type counts, potentially allowing guests to get write
access to in-use pagetables.

IMPACT
======

A malicious PV guest administrator may be able to escalate their
privilege to that of the host.

VULNERABLE SYSTEMS
==================

All x86 systems with untrusted PV guests are vulnerable.

HVM and PVH guests cannot exercise this vulnerability.
ARM systems are not vulnerable because ARM guests are all PVH.

All security-supported Xen versions are vulnerable.

Note that these attacks require very precise timing, which may
be difficult to exploit in practice.

MITIGATION
==========

Running only HVM or PVH guests will avoid this vulnerability.

Running PV guests in "shim" mode will also avoid this vulnerability.

CREDITS
=======

This issue was discovered by George Dunlap of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa299/*.patch           xen-unstable
xsa299-4.12/*.patch      Xen 4.12.x
xsa299-4.11/*.patch      Xen 4.11.x
xsa299-4.10/*.patch      Xen 4.10.x
xsa299-4.9/*.patch       Xen 4.9.x
xsa299-4.8/*.patch       Xen 4.8.x

$ sha256sum xsa299* xsa299*/*
687fb0f3273a424726edb4d249b79cfc45d1ef7000610405b11eaac49baecaa8  xsa299.meta
6c8f46e57f61a5e1e2e5e628a32e4c9ae144218ce475309811bb9900d3fdda48  xsa299-4.8/0001-x86-mm-Clean-up-trailing-whitespace.patch
3409e71ed7bc199bcda33892ea6f70fe257c4f3906d74b4a6f4352415daeedb0  xsa299-4.8/0002-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch
1179fe0f1a591c542478bf8614501f8ddb67e342d7d452f6bff3b6a999f2b20f  xsa299-4.8/0003-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch
bc0352a1d82079c4072cc3871d0d397f7abb3c0480dfc3c5c542091d2ec7d7b0  xsa299-4.8/0004-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch
2b96857ef3e0f8259df7ad01600f1c30ca234668d6f26744c2ae0d3d7dded090  xsa299-4.8/0005-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch
fe119a8255e23a86845fa1ac5f93afa25acdaff705061c172ea9e0589b0bc1a4  xsa299-4.8/0006-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch
562415d5fdb4e173443a2aa211094743a722ef1fe5a2d19c59cb3d329e101984  xsa299-4.8/0007-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch
454296ac46ea5feea8866101e7c953bf6dbd37a5275f7b006eeb6d22cbae387d  xsa299-4.8/0008-x86-mm-Always-retain-a-general-ref-on-partial.patch
f203a70da67f304c2ede516ef989b58ace6774eeee4eca919631c75f09860ba3  xsa299-4.8/0009-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch
1f4877c10ead99c51d822d29ebaed9774cdb97cca869fe1a1ccf905540e291c7  xsa299-4.8/0010-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch
733d260d731cce9902d66dc5b42ae9d10a319acda6dadcc426b6dfeba6e917da  xsa299-4.8/0011-x86-mm-Fix-nested-de-validation-on-error.patch
cd105c15e2fd915644cb7d31000df60e51d1054a807b575d5436ccb87c1e9a18  xsa299-4.8/0012-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch
d8db456679e652f5a33a0a448d379e3a88b0cf7ce1415ee46007873cfb6f49b7  xsa299-4.9/0001-x86-mm-Clean-up-trailing-whitespace.patch
e54df901b5f13d70643938ff365a09a43725637511251efc3ac55c45b80016f5  xsa299-4.9/0002-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch
8da540f32ff77f5871f646a6ef2847bc3adc2aecfa4698dcec4335b72e758616  xsa299-4.9/0003-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch
e97044ffb5edcc7f1094dd47e365f2f29971cacf784d8aaa9a0e42f770ca899d  xsa299-4.9/0004-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch
53977fd090d488f484e6191c6b68cbc59f771d8cf4aeb230b7b9f8ddc891a58e  xsa299-4.9/0005-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch
d10b9d434d341ac380e8a9c6fc4b3ddec8baf8dec9d565c2e66867f8d05497ba  xsa299-4.9/0006-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch
7e01debdbe59cfa734e63b5c9d5c2799aa25f961f0d065ce8c8bdb64d577b164  xsa299-4.9/0007-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch
12f0732907547367645db6300cff959f15118b91503165dc2c66083769ac7e56  xsa299-4.9/0008-x86-mm-Always-retain-a-general-ref-on-partial.patch
06044bf56130dd845e08ed9af75f4aade186d48b1cea88d7862026bbe0bf51af  xsa299-4.9/0009-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch
2fea704a716d6ff8a589fba7bf5d71443e2b52f41f591f8173d50dcb3ba9a94b  xsa299-4.9/0010-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch
4bcfd94bdd77726e8ea1069081f5f544705b22752a185ee4e1f58c730a902b74  xsa299-4.9/0011-x86-mm-Fix-nested-de-validation-on-error.patch
580fa03182e40f122e3d21a5c71183b6a9500eae2afba490cf43514b75e15062  xsa299-4.9/0012-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch
c3bde8f42e75c0f98c22938267f947d4729e7372510dededa3750699ac8cb2f5  xsa299-4.10/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch
0794fd0d20d71367977926f2393e354d4a43452a51f421616fa413acd68bf24a  xsa299-4.10/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch
0591cd2fa566fcec43e2aa6e1cfb92629c816e55c7548b2534c5a7a84505cd06  xsa299-4.10/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch
736966986c43bcdfcbf337fc87af6f430458bad5d105b33f7dfa0a1eb72f2416  xsa299-4.10/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch
416db71e950838dbf5d024ae9ba8bb6e6685314608543fd8df0516db7786b811  xsa299-4.10/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch
7d84aaf129401faa863565df084e776413dd07ec440c1a67db961b8a147651a4  xsa299-4.10/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch
59d37dc3cfd811bcbbedb72ca9d80eb2d460dce4e373e581c88fdb6b874b4111  xsa299-4.10/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch
746156888f0dc4a75164cd668dd05fdf3d9b11cc96205785384f84ebcd1df4ae  xsa299-4.10/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch
bcc54d2b0653e584c89c0d219d5cd82e94c2629033ea8f1b22dfd3f373267bf5  xsa299-4.10/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch
4829ba66647d344f1eaad632fddab4c8c51db513d1ae18385dec195b86e76936  xsa299-4.10/0010-x86-mm-Fix-nested-de-validation-on-error.patch
7ad0b06d2748da4e4b317f4cc8c829c7fb451bf86ad778d97d231acff7cfd940  xsa299-4.10/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch
225fec9475b5992338ce19da982a759b3a551c653dbbb280295b00018a107d28  xsa299-4.11/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch
fa910f573bde107b90fef4568fa500bf875d7303ac93642ed8a135d639bf7f0e  xsa299-4.11/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch
f5fcf8ab6940d85fe43de61463ff00bcf17a22b94da4f2b28fa45d714b0255d0  xsa299-4.11/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch
e1e49d767f08889b518423935869332a40f87e824bb93a0c2707f1f99e9f0328  xsa299-4.11/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch
c0f5ce00516491b1f3d2eccf25fbd67d409d855e3d4b423490f1bc37b4477e87  xsa299-4.11/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch
4562543c497c17cc3a793f67a75824043ca3dea69ccc456bf9f5546825282f0e  xsa299-4.11/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch
90bc777691225eb4c55804702c2cd7f2913317b13334c27b9437ee60be672cca  xsa299-4.11/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch
7903c9599ee47dc05647e5ec7a6ce3fe5e6331b527551286897429e97cf56f61  xsa299-4.11/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch
c1ae9bad93e11a4a9253265318b67b45865e566b17ddd7f167bb88197a9b700c  xsa299-4.11/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch
49a21bd396ab4af6b82aaa38dac733f4fde806587b5b126cd656f725b9c8eee7  xsa299-4.11/0010-x86-mm-Fix-nested-de-validation-on-error.patch
09df369fa52335e3e560af593d4e9843bab1da24aa1b4c905f9ea1ce8441af6e  xsa299-4.11/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch
d27f07eb0020181487ec9dda15c6331125d6b0505fdce1ae67c0a9b524159e11  xsa299-4.12/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch
00c2fb77366c427e226315cfb1cda1c67ce495ec8a0b400ff30924bc399bf283  xsa299-4.12/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch
bc88c216e438af9e1dddf1e5374fd1c78c9867e8908ba3016c72d999aebaea4b  xsa299-4.12/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch
cc6416c6311be82a2b89d5b14ceb9ecc6cb92ce9286bb03b91083c661186d28d  xsa299-4.12/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch
732fbb80a6fc6364945e1b6534c921d503e2369c3cd25f425096549b71f75fa0  xsa299-4.12/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch
20e37b3712b66111193bed02b368aff2ee0e7896dd55b5e6c928fbc97ec618b3  xsa299-4.12/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch
20bec098f3ad474093ce33e4ae5e8cee5ff9f8504107c8a4ff76f2731abbab13  xsa299-4.12/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch
71addb8014eeb51a6adc4377aaa4b74ac611a28a6f62865f7020a536a1a9cbc5  xsa299-4.12/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch
71bd7d75f7878571d4ea4351ea10f487a1c1a86765f67c85a25308d5df24a40e  xsa299-4.12/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch
1e58d49f72c1eb158db08a17a3805e2144c0d468b6388a9a8795b67f80a699a5  xsa299-4.12/0010-x86-mm-Fix-nested-de-validation-on-error.patch
67594f941f8cecbc0ff87dfedbdbd43f4e4234d049c1a5d62143153ae96954c1  xsa299-4.12/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch
08179d90ea327bca328f3a45198c31166df2aa6fb459b148dd74c716c1d5bb88  xsa299/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch
d37e7b4dd3c9d7da14a287d9fe6807f81d95bba8bdab79b729ed5aa3350fad70  xsa299/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch
660fc01fb09aee7628d65d7893ec11bf77cfe79543e390656b59f0e60334d058  xsa299/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch
2dc6ad4233ec572ba21632ab80b6149541f3169affb792e31930e3f7c6e72fc6  xsa299/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch
175fd90422bf00879de2129cd1a86bbdeb1c15ff344d286ab9634bc3f1512c03  xsa299/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch
afa26c8850085412a787d7f0cb3031f15181ee2c9b3b1a9b4a007bff7404457f  xsa299/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch
6f0502b2377db2115faf9c7bcbf35898013dcec74170950c3aa7a0586ff1e174  xsa299/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch
787c3eeaadfed46947fb17773fa8f9e9efe891658d7460eaf5291a4ca6155123  xsa299/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch
77341c4d0ab62fbb7090d2a6b60902467563ae470ac0807ef40a3ac791d2933a  xsa299/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch
e489f49f8783fb388161365072da585c049e05d80306cf963cec5ecbb3bc67c7  xsa299/0010-x86-mm-Fix-nested-de-validation-on-error.patch
17b9ae71c150747bff4d57eee8a918b1961e880e25ae2b9c0dbe933e005cb1a0  xsa299/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch
$

NOTE ON RESOLUTION
==================

Even with these fixes, the code is still very complicated.  After the
embargo is up, we plan to try getting rid of automatic recursive
pagetable promotion entirely, instead requiring guest operating
systems to promote pages one-by-one themselves.  This would obviate
the need to have restartable operations, greatly simplifying the
reference counting code.

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl2601kMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZiYAIAMx46nYNIJ5KwV4rCKkBW1O/EDOc5dqt9PjlIKWR
PbJ4rrs9ZObvRh1Xw7nNM/leexHNYClWGAGPp/pLOyfF4nw/9B13jMF0C39vP4Fd
FMzM0jKyZreWTU38NqkrAVHbawyZNkS//1PITZy6LvA+DvwsHBz34qFsUX8Fw3vd
pu7izoozEFCzTie0zrUqwKV7yIyJ+3u3b/SjGuou0nxrbyIGuz/HIxazcFxJWwZh
4Zww3yKWMvXVedg8a2ZP5Fi+8+ePurOKz6g48gOWYefCPYXASrEaAf6s2WUp9Yi1
akddy2WIHzqd3HfOqEVKE5y8bjVvEft7mOIqOVeJBpEzh1s=
=633F
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa299.meta"
Content-Disposition: attachment; filename="xsa299.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyOTksCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMiIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIs
CiAgICAiNC45IiwKICAgICI0LjgiCiAgXSwKICAiVHJlZXMiOiBbCiAgICAi
eGVuIgogIF0sCiAgIlJlY2lwZXMiOiB7CiAgICAiNC4xMCI6IHsKICAgICAg
IlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFi
bGVSZWYiOiAiMzEzMWJmOTU2YWIxNTkyOTVlY2RkZTBjNWFkMDAzZDBjNWFm
NDY5NSIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjk2
LAogICAgICAgICAgICAyOTgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0
Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTI5OS00LjEwLyoucGF0Y2giCiAg
ICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTEi
OiB7CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAg
ICAgICAiU3RhYmxlUmVmIjogIjMzNDJlZTkzMThjZDM4YmEwMDYyNTViNjg3
YWI3YTE0NTM5OWVhOTIiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAg
ICAgICAgIDI5NiwKICAgICAgICAgICAgMjk4CiAgICAgICAgICBdLAogICAg
ICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EyOTktNC4xMS8q
LnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwK
ICAgICI0LjEyIjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICI1OTlkNmQyM2NiYjc5MGE3
ODhmN2E0OWFiNGYxMWYxYTNiNWI0MjllIiwKICAgICAgICAgICJQcmVyZXFz
IjogWwogICAgICAgICAgICAyOTYsCiAgICAgICAgICAgIDI5OAogICAgICAg
ICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNh
Mjk5LTQuMTIvKi5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAg
IH0KICAgIH0sCiAgICAiNC44IjogewogICAgICAiUmVjaXBlcyI6IHsKICAg
ICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICJjNjcyMTBm
NjBkZmE4MzU2NWQyNmFlNzEwZTRmNWU3MjlhOTVkY2U1IiwKICAgICAgICAg
ICJQcmVyZXFzIjogWwogICAgICAgICAgICAyOTYsCiAgICAgICAgICAgIDI5
OAogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAg
ICAgICAieHNhMjk5LTQuOC8qLnBhdGNoIgogICAgICAgICAgXQogICAgICAg
IH0KICAgICAgfQogICAgfSwKICAgICI0LjkiOiB7CiAgICAgICJSZWNpcGVz
IjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAiU3RhYmxlUmVmIjog
IjhkMmE2ODgwMTUxOTNlMjBhZTQ3ZmUzYzIwOGY5OTEyODI0MGY4MjEiLAog
ICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAgIDI5NiwKICAgICAg
ICAgICAgMjk4CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBb
CiAgICAgICAgICAgICJ4c2EyOTktNC45LyoucGF0Y2giCiAgICAgICAgICBd
CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIm1hc3RlciI6IHsKICAg
ICAgIlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJT
dGFibGVSZWYiOiAiNTVhYjI5MmM0MmRiNDFiMDVjZmRiYTAxMjY4MGJmMWUw
ZWEwMmY3YSIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAg
Mjk2LAogICAgICAgICAgICAyOTgKICAgICAgICAgIF0sCiAgICAgICAgICAi
UGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTI5OS8qLnBhdGNoIgogICAg
ICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0001-x86-mm-Clean-up-trailing-whitespace.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0001-x86-mm-Clean-up-trailing-whitespace.patch"
Content-Transfer-Encoding: base64

RnJvbSA5ZGZiNTU5N2M1YjUxMjIyYmE5YjI1OTNkOGZhMmM4Mzc2MWJlMGU0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMTYgT2N0
IDIwMTkgMDk6NDY6MzUgKzAxMDAKU3ViamVjdDogW1BBVENIIDAxLzEyXSB4
ODYvbW06IENsZWFuIHVwIHRyYWlsaW5nIHdoaXRlc3BhY2UKClNvbWV0aW1l
IGJldHdlZW4gNC45IGFuZCA0LjEwIHNvbWVvbmUgY2xlYW5lZCB1cCBhbGwg
dGhlIHRyYWlsaW5nCndoaXRlc3BhY2UgaW4gbW0uYzsgYXBwbHlpbmcgdGhp
cyBwYXRjaCBub3cgbWFrZXMgYWxsIGZ1dGhlciBwYXRjaGVzCm11Y2ggY2xl
YW5lci4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoKUmVwb3J0ZWQtYnk6IEdl
b3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVk
LW9mZi1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXgu
Y29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMTE4ICsrKysrKysrKysr
KysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBj
aGFuZ2VkLCA1OSBpbnNlcnRpb25zKCspLCA1OSBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IDlhYmRmMTUzODQuLjVjOWRiM2Y4OTggMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0xLDQ4ICsxLDQ4IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCiAgKiBhcmNoL3g4Ni9tbS5jCi0gKiAKKyAqCiAgKiBDb3B5cmln
aHQgKGMpIDIwMDItMjAwNSBLIEEgRnJhc2VyCiAgKiBDb3B5cmlnaHQgKGMp
IDIwMDQgQ2hyaXN0aWFuIExpbXBhY2gKLSAqIAorICoKICAqIFRoaXMgcHJv
Z3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IgbW9kaWZ5CiAgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQog
ICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNp
b24gMiBvZiB0aGUgTGljZW5zZSwgb3IKICAqIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCi0gKiAKKyAqCiAgKiBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVz
ZWZ1bCwKICAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBl
dmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAgKiBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUg
dGhlCiAgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLgotICogCisgKgogICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVk
IGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKICAq
IGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNlZSA8aHR0cDov
L3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCiAgKi8KIAogLyoKICAqIEEgZGVz
Y3JpcHRpb24gb2YgdGhlIHg4NiBwYWdlIHRhYmxlIEFQSToKLSAqIAorICoK
ICAqIERvbWFpbnMgdHJhcCB0byBkb19tbXVfdXBkYXRlIHdpdGggYSBsaXN0
IG9mIHVwZGF0ZSByZXF1ZXN0cy4KICAqIFRoaXMgaXMgYSBsaXN0IG9mIChw
dHIsIHZhbCkgcGFpcnMsIHdoZXJlIHRoZSByZXF1ZXN0ZWQgb3BlcmF0aW9u
CiAgKiBpcyAqcHRyID0gdmFsLgotICogCisgKgogICogUmVmZXJlbmNlIGNv
dW50aW5nIG9mIHBhZ2VzOgogICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQogICogRWFjaCBwYWdlIGhhcyB0d28gcmVmY291bnRzOiB0b3RfY291
bnQgYW5kIHR5cGVfY291bnQuCi0gKiAKKyAqCiAgKiBUT1RfQ09VTlQgaXMg
dGhlIG9idmlvdXMgcmVmZXJlbmNlIGNvdW50LiBJdCBjb3VudHMgYWxsIHVz
ZXMgb2YgYQogICogcGh5c2ljYWwgcGFnZSBmcmFtZSBieSBhIGRvbWFpbiwg
aW5jbHVkaW5nIHVzZXMgYXMgYSBwYWdlIGRpcmVjdG9yeSwKICAqIGEgcGFn
ZSB0YWJsZSwgb3Igc2ltcGxlIG1hcHBpbmdzIHZpYSBhIFBURS4gVGhpcyBj
b3VudCBwcmV2ZW50cyBhCiAgKiBkb21haW4gZnJvbSByZWxlYXNpbmcgYSBm
cmFtZSBiYWNrIHRvIHRoZSBmcmVlIHBvb2wgd2hlbiBpdCBzdGlsbCBob2xk
cwogICogYSByZWZlcmVuY2UgdG8gaXQuCi0gKiAKKyAqCiAgKiBUWVBFX0NP
VU5UIGlzIG1vcmUgc3VidGxlLiBBIGZyYW1lIGNhbiBiZSBwdXQgdG8gb25l
IG9mIHRocmVlCiAgKiBtdXR1YWxseS1leGNsdXNpdmUgdXNlczogaXQgbWln
aHQgYmUgdXNlZCBhcyBhIHBhZ2UgZGlyZWN0b3J5LCBvciBhCiAgKiBwYWdl
IHRhYmxlLCBvciBpdCBtYXkgYmUgbWFwcGVkIHdyaXRhYmxlIGJ5IHRoZSBk
b21haW4gW29mIGNvdXJzZSwgYQogICogZnJhbWUgbWF5IG5vdCBiZSB1c2Vk
IGluIGFueSBvZiB0aGVzZSB0aHJlZSB3YXlzIV0uCi0gKiBTbywgdHlwZV9j
b3VudCBpcyBhIGNvdW50IG9mIHRoZSBudW1iZXIgb2YgdGltZXMgYSBmcmFt
ZSBpcyBiZWluZyAKKyAqIFNvLCB0eXBlX2NvdW50IGlzIGEgY291bnQgb2Yg
dGhlIG51bWJlciBvZiB0aW1lcyBhIGZyYW1lIGlzIGJlaW5nCiAgKiByZWZl
cnJlZCB0byBpbiBpdHMgY3VycmVudCBpbmNhcm5hdGlvbi4gVGhlcmVmb3Jl
LCBhIHBhZ2UgY2FuIG9ubHkKICAqIGNoYW5nZSBpdHMgdHlwZSB3aGVuIGl0
cyB0eXBlIGNvdW50IGlzIHplcm8uCi0gKiAKKyAqCiAgKiBQaW5uaW5nIHRo
ZSBwYWdlIHR5cGU6CiAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBU
aGUgdHlwZSBvZiBhIHBhZ2UgY2FuIGJlIHBpbm5lZC91bnBpbm5lZCB3aXRo
IHRoZSBjb21tYW5kcwpAQCAtNTEsMjAgKzUxLDIwIEBACiAgKiBUaGlzIGlz
IHVzZWZ1bCB0byBwcmV2ZW50IGEgcGFnZSdzIHR5cGUgY291bnQgZmFsbGlu
ZyB0byB6ZXJvLCBhdCB3aGljaAogICogcG9pbnQgc2FmZXR5IGNoZWNrcyB3
b3VsZCBuZWVkIHRvIGJlIGNhcnJpZWQgb3V0IG5leHQgdGltZSB0aGUgY291
bnQKICAqIGlzIGluY3JlYXNlZCBhZ2Fpbi4KLSAqIAorICoKICAqIEEgZnVy
dGhlciBub3RlIG9uIHdyaXRhYmxlIHBhZ2UgbWFwcGluZ3M6CiAgKiAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICogRm9y
IHNpbXBsaWNpdHksIHRoZSBjb3VudCBvZiB3cml0YWJsZSBtYXBwaW5ncyBm
b3IgYSBwYWdlIG1heSBub3QKICAqIGNvcnJlc3BvbmQgdG8gcmVhbGl0eS4g
VGhlICd3cml0YWJsZSBjb3VudCcgaXMgaW5jcmVtZW50ZWQgZm9yIGV2ZXJ5
CiAgKiBQVEUgd2hpY2ggbWFwcyB0aGUgcGFnZSB3aXRoIHRoZSBfUEFHRV9S
VyBmbGFnIHNldC4gSG93ZXZlciwgZm9yCiAgKiB3cml0ZSBhY2Nlc3MgdG8g
YmUgcG9zc2libGUgdGhlIHBhZ2UgZGlyZWN0b3J5IGVudHJ5IG11c3QgYWxz
byBoYXZlCi0gKiBpdHMgX1BBR0VfUlcgYml0IHNldC4gV2UgZG8gbm90IGNo
ZWNrIHRoaXMgYXMgaXQgY29tcGxpY2F0ZXMgdGhlIAorICogaXRzIF9QQUdF
X1JXIGJpdCBzZXQuIFdlIGRvIG5vdCBjaGVjayB0aGlzIGFzIGl0IGNvbXBs
aWNhdGVzIHRoZQogICogcmVmZXJlbmNlIGNvdW50aW5nIGNvbnNpZGVyYWJs
eSBbY29uc2lkZXIgdGhlIGNhc2Ugb2YgbXVsdGlwbGUKICAqIGRpcmVjdG9y
eSBlbnRyaWVzIHJlZmVyZW5jaW5nIGEgc2luZ2xlIHBhZ2UgdGFibGUsIHNv
bWUgd2l0aCB0aGUgUlcKICAqIGJpdCBzZXQsIG90aGVycyBub3QgLS0gaXQg
c3RhcnRzIGdldHRpbmcgYSBiaXQgbWVzc3ldLgogICogSW4gbm9ybWFsIHVz
ZSwgdGhpcyBzaW1wbGlmaWNhdGlvbiBzaG91bGRuJ3QgYmUgYSBwcm9ibGVt
LgogICogSG93ZXZlciwgdGhlIGxvZ2ljIGNhbiBiZSBhZGRlZCBpZiByZXF1
aXJlZC4KLSAqIAorICoKICAqIE9uZSBtb3JlIG5vdGUgb24gcmVhZC1vbmx5
IHBhZ2UgbWFwcGluZ3M6CiAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQogICogV2Ugd2FudCBkb21haW5zIHRvIGJlIGFi
bGUgdG8gbWFwIHBhZ2VzIGZvciByZWFkLW9ubHkgYWNjZXNzLiBUaGUKQEAg
LTczLDEwICs3MywxMCBAQAogICogSG93ZXZlciwgZG9tYWlucyBoYXZlIGZy
ZWUgYWNjZXNzIHRvIHJpbmdzIDEgJiAyIG9mIHRoZSBJbnRlbAogICogcHJp
dmlsZWdlIG1vZGVsLiBJbiB0ZXJtcyBvZiBwYWdlIHByb3RlY3Rpb24sIHRo
ZXNlIGFyZSBjb25zaWRlcmVkCiAgKiB0byBiZSBwYXJ0IG9mICdzdXBlcnZp
c29yIG1vZGUnLiBUaGUgV1AgYml0IGluIENSMCBjb250cm9scyB3aGV0aGVy
Ci0gKiByZWFkLW9ubHkgcmVzdHJpY3Rpb25zIGFyZSByZXNwZWN0ZWQgaW4g
c3VwZXJ2aXNvciBtb2RlIC0tIGlmIHRoZSAKKyAqIHJlYWQtb25seSByZXN0
cmljdGlvbnMgYXJlIHJlc3BlY3RlZCBpbiBzdXBlcnZpc29yIG1vZGUgLS0g
aWYgdGhlCiAgKiBiaXQgaXMgY2xlYXIgdGhlbiBhbnkgbWFwcGVkIHBhZ2Ug
aXMgd3JpdGFibGUuCi0gKiAKLSAqIFdlIGdldCByb3VuZCB0aGlzIGJ5IGFs
d2F5cyBzZXR0aW5nIHRoZSBXUCBiaXQgYW5kIGRpc2FsbG93aW5nIAorICoK
KyAqIFdlIGdldCByb3VuZCB0aGlzIGJ5IGFsd2F5cyBzZXR0aW5nIHRoZSBX
UCBiaXQgYW5kIGRpc2FsbG93aW5nCiAgKiB1cGRhdGVzIHRvIGl0LiBUaGlz
IGlzIHZlcnkgdW5saWtlbHkgdG8gY2F1c2UgYSBwcm9ibGVtIGZvciBndWVz
dAogICogT1Mncywgd2hpY2ggd2lsbCBnZW5lcmFsbHkgdXNlIHRoZSBXUCBi
aXQgdG8gc2ltcGxpZnkgY29weS1vbi13cml0ZQogICogaW1wbGVtZW50YXRp
b24gKGluIHRoYXQgY2FzZSwgT1Mgd2FudHMgYSBmYXVsdCB3aGVuIGl0IHdy
aXRlcyB0bwpAQCAtMzE0LDcgKzMxNCw3IEBAIHZvaWQgX19pbml0IGFyY2hf
aW5pdF9tZW1vcnkodm9pZCkKICAgICAgKi8KICAgICBkb21faW8gPSBkb21h
aW5fY3JlYXRlKERPTUlEX0lPLCBET01DUkZfZHVtbXksIDAsIE5VTEwpOwog
ICAgIEJVR19PTihJU19FUlIoZG9tX2lvKSk7Ci0gICAgCisKICAgICAvKgog
ICAgICAqIEluaXRpYWxpc2Ugb3VyIENPVyBkb21haW4uCiAgICAgICogVGhp
cyBkb21haW4gb3ducyBzaGFyYWJsZSBwYWdlcy4KQEAgLTMyNSw3ICszMjUs
NyBAQCB2b2lkIF9faW5pdCBhcmNoX2luaXRfbWVtb3J5KHZvaWQpCiAgICAg
LyogRmlyc3QgMU1CIG9mIFJBTSBpcyBoaXN0b3JpY2FsbHkgbWFya2VkIGFz
IEkvTy4gKi8KICAgICBmb3IgKCBpID0gMDsgaSA8IDB4MTAwOyBpKysgKQog
ICAgICAgICBzaGFyZV94ZW5fcGFnZV93aXRoX2d1ZXN0KG1mbl90b19wYWdl
KGkpLCBkb21faW8sIFhFTlNIQVJFX3dyaXRhYmxlKTsKLSAKKwogICAgIC8q
IEFueSBhcmVhcyBub3Qgc3BlY2lmaWVkIGFzIFJBTSBieSB0aGUgZTgyMCBt
YXAgYXJlIGNvbnNpZGVyZWQgSS9PLiAqLwogICAgIGZvciAoIGkgPSAwLCBw
Zm4gPSAwOyBwZm4gPCBtYXhfcGFnZTsgaSsrICkKICAgICB7CkBAIC0zNTUs
NyArMzU1LDcgQEAgdm9pZCBfX2luaXQgYXJjaF9pbml0X21lbW9yeSh2b2lk
KQogICAgICAgICAgKi8KICAgICAgICAgaW9zdGFydF9wZm4gPSBtYXhfdCh1
bnNpZ25lZCBsb25nLCBwZm4sIDFVTCA8PCAoMjAgLSBQQUdFX1NISUZUKSk7
CiAgICAgICAgIGlvZW5kX3BmbiA9IG1pbihyc3RhcnRfcGZuLCAxNlVMIDw8
ICgyMCAtIFBBR0VfU0hJRlQpKTsKLSAgICAgICAgaWYgKCBpb3N0YXJ0X3Bm
biA8IGlvZW5kX3BmbiApICAgICAgICAgICAgCisgICAgICAgIGlmICggaW9z
dGFydF9wZm4gPCBpb2VuZF9wZm4gKQogICAgICAgICAgICAgZGVzdHJveV94
ZW5fbWFwcGluZ3MoKHVuc2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaW9zdGFy
dF9wZm4pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHVu
c2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaW9lbmRfcGZuKSk7CiAKQEAgLTQ0
Myw3ICs0NDMsNyBAQCBpbnQgcGFnZV9pc19yYW1fdHlwZSh1bnNpZ25lZCBs
b25nIG1mbiwgdW5zaWduZWQgbG9uZyBtZW1fdHlwZSkKICAgICAgICAgICAg
IC8qIHVua25vd24gKi8KICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg
ICB9Ci0gICAgICAgIAorCiAgICAgICAgIC8qIFRlc3QgdGhlIHJhbmdlLiAq
LwogICAgICAgICBpZiAoIChlODIwLm1hcFtpXS5hZGRyIDw9IG1hZGRyKSAm
JgogICAgICAgICAgICAgICgoZTgyMC5tYXBbaV0uYWRkciArIGU4MjAubWFw
W2ldLnNpemUpID49IChtYWRkciArIFBBR0VfU0laRSkpICkKQEAgLTU0Niw3
ICs1NDYsNyBAQCB2b2lkIHdyaXRlX3B0YmFzZShzdHJ1Y3QgdmNwdSAqdikK
IAogLyoKICAqIFNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgQ1IzIGlzIHVwZGF0
ZWQuCi0gKiAKKyAqCiAgKiBVc2VzIHZhbHVlcyBmb3VuZCBpbiB2Y3B1LT5h
cmNoLihndWVzdF90YWJsZSBhbmQgZ3Vlc3RfdGFibGVfdXNlciksIGFuZAog
ICogZm9yIEhWTSBndWVzdHMsIGFyY2gubW9uaXRvcl90YWJsZSBhbmQgaHZt
J3MgZ3Vlc3QgQ1IzLgogICoKQEAgLTc1Niw3ICs3NTYsNyBAQCBzdGF0aWMg
aW50IGdldF9wYWdlX2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9u
ciwgc3RydWN0IGRvbWFpbiAqZCkKIHN0YXRpYyBpbnQgX19nZXRfcGFnZV90
eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlw
ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwcmVlbXB0aWJs
ZSk7CiAKLXN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdl
bnIodW5zaWduZWQgbG9uZyBwYWdlX25yLCAKK3N0YXRpYyBpbnQgZ2V0X3Bh
Z2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIodW5zaWduZWQgbG9uZyBwYWdlX25y
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBkb21haW4gKmQsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwYXJ0aWFsLApA
QCAtMTA2MSw3ICsxMDYxLDcgQEAgZ2V0X3BhZ2VfZnJvbV9sMWUoCiAgICAg
ICAgIHsKICAgICAgICAgICAgIGlmICggbWZuICE9IChQQUREUl9NQVNLID4+
IFBBR0VfU0hJRlQpICkgLyogSU5WQUxJRF9NRk4/ICovCiAgICAgICAgICAg
ICB7Ci0gICAgICAgICAgICAgICAgTUVNX0xPRygiTm9uLXByaXZpbGVnZWQg
KCV1KSBhdHRlbXB0IHRvIG1hcCBJL08gc3BhY2UgJTA4bHgiLCAKKyAgICAg
ICAgICAgICAgICBNRU1fTE9HKCJOb24tcHJpdmlsZWdlZCAoJXUpIGF0dGVt
cHQgdG8gbWFwIEkvTyBzcGFjZSAlMDhseCIsCiAgICAgICAgICAgICAgICAg
ICAgICAgICBwZ19vd25lci0+ZG9tYWluX2lkLCBtZm4pOwogICAgICAgICAg
ICAgICAgIHJldHVybiAtRVBFUk07CiAgICAgICAgICAgICB9CkBAIC0xMTU0
LDcgKzExNTQsNyBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKICAgICAgICAgcGdf
b3duZXIgPSByZWFsX3BnX293bmVyOwogICAgIH0KIAotICAgIC8qIEV4dHJh
IHBhcmFub2lkIGNoZWNrIGZvciBzaGFyZWQgbWVtb3J5LiBXcml0YWJsZSBt
YXBwaW5ncyAKKyAgICAvKiBFeHRyYSBwYXJhbm9pZCBjaGVjayBmb3Igc2hh
cmVkIG1lbW9yeS4gV3JpdGFibGUgbWFwcGluZ3MKICAgICAgKiBkaXNhbGxv
d2VkICh1bnNoYXJlIGZpcnN0ISkgKi8KICAgICBpZiAoIChsMWYgJiBfUEFH
RV9SVykgJiYgKHJlYWxfcGdfb3duZXIgPT0gZG9tX2NvdykgKQogICAgICAg
ICBnb3RvIGNvdWxkX25vdF9waW47CkBAIC0xMzk4LDEyICsxMzk4LDEyIEBA
IHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFfcGdlbnRyeV90IGwxZSwgc3Ry
dWN0IGRvbWFpbiAqbDFlX293bmVyKQogICAgICAqIENoZWNrIGlmIHRoaXMg
aXMgYSBtYXBwaW5nIHRoYXQgd2FzIGVzdGFibGlzaGVkIHZpYSBhIGdyYW50
IHJlZmVyZW5jZS4KICAgICAgKiBJZiBpdCB3YXMgdGhlbiB3ZSBzaG91bGQg
bm90IGJlIGhlcmU6IHdlIHJlcXVpcmUgdGhhdCBzdWNoIG1hcHBpbmdzIGFy
ZQogICAgICAqIGV4cGxpY2l0bHkgZGVzdHJveWVkIHZpYSB0aGUgZ3JhbnQt
dGFibGUgaW50ZXJmYWNlLgotICAgICAqIAorICAgICAqCiAgICAgICogVGhl
IHVwc2hvdCBvZiB0aGlzIGlzIHRoYXQgdGhlIGd1ZXN0IGNhbiBlbmQgdXAg
d2l0aCBhY3RpdmUgZ3JhbnRzIHRoYXQKICAgICAgKiBpdCBjYW5ub3QgZGVz
dHJveSAoYmVjYXVzZSBpdCBubyBsb25nZXIgaGFzIGEgUFRFIHRvIHByZXNl
bnQgdG8gdGhlCiAgICAgICogZ3JhbnQtdGFibGUgaW50ZXJmYWNlKS4gVGhp
cyBjYW4gbGVhZCB0byBzdWJ0bGUgaGFyZC10by1jYXRjaCBidWdzLAogICAg
ICAqIGhlbmNlIGEgc3BlY2lhbCBncmFudCBQVEUgZmxhZyBjYW4gYmUgZW5h
YmxlZCB0byBjYXRjaCB0aGUgYnVnIGVhcmx5LgotICAgICAqIAorICAgICAq
CiAgICAgICogKE5vdGUgdGhhdCB0aGUgdW5kZXN0cm95YWJsZSBhY3RpdmUg
Z3JhbnRzIGFyZSBub3QgYSBzZWN1cml0eSBob2xlIGluCiAgICAgICogWGVu
LiBBbGwgYWN0aXZlIGdyYW50cyBjYW4gc2FmZWx5IGJlIGNsZWFuZWQgdXAg
d2hlbiB0aGUgZG9tYWluIGRpZXMuKQogICAgICAqLwpAQCAtMTQxNyw3ICsx
NDE3LDcgQEAgdm9pZCBwdXRfcGFnZV9mcm9tX2wxZShsMV9wZ2VudHJ5X3Qg
bDFlLCBzdHJ1Y3QgZG9tYWluICpsMWVfb3duZXIpCiAKICAgICAvKiBSZW1l
bWJlciB3ZSBkaWRuJ3QgdGFrZSBhIHR5cGUtY291bnQgb2YgZm9yZWlnbiB3
cml0YWJsZSBtYXBwaW5ncwogICAgICAqIHRvIHBhZ2luZy1leHRlcm5hbCBk
b21haW5zICovCi0gICAgaWYgKCAobDFlX2dldF9mbGFncyhsMWUpICYgX1BB
R0VfUlcpICYmIAorICAgIGlmICggKGwxZV9nZXRfZmxhZ3MobDFlKSAmIF9Q
QUdFX1JXKSAmJgogICAgICAgICAgKChsMWVfb3duZXIgPT0gcGdfb3duZXIp
IHx8ICFwYWdpbmdfbW9kZV9leHRlcm5hbChwZ19vd25lcikpICkKICAgICB7
CiAgICAgICAgIHB1dF9wYWdlX2FuZF90eXBlKHBhZ2UpOwpAQCAtMTQyNSw3
ICsxNDI1LDcgQEAgdm9pZCBwdXRfcGFnZV9mcm9tX2wxZShsMV9wZ2VudHJ5
X3QgbDFlLCBzdHJ1Y3QgZG9tYWluICpsMWVfb3duZXIpCiAgICAgZWxzZQog
ICAgIHsKICAgICAgICAgLyogV2UgZXhwZWN0IHRoaXMgaXMgcmFyZSBzbyB3
ZSBibG93IHRoZSBlbnRpcmUgc2hhZG93IExEVC4gKi8KLSAgICAgICAgaWYg
KCB1bmxpa2VseSgoKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvICYgUEdUX3R5
cGVfbWFzaykgPT0gCisgICAgICAgIGlmICggdW5saWtlbHkoKChwYWdlLT51
LmludXNlLnR5cGVfaW5mbyAmIFBHVF90eXBlX21hc2spID09CiAgICAgICAg
ICAgICAgICAgICAgICAgIFBHVF9zZWdfZGVzY19wYWdlKSkgJiYKICAgICAg
ICAgICAgICB1bmxpa2VseSgoKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvICYg
UEdUX2NvdW50X21hc2spICE9IDApKSAmJgogICAgICAgICAgICAgIChsMWVf
b3duZXIgPT0gcGdfb3duZXIpICkKQEAgLTE1MjcsNyArMTUyNyw3IEBAIHN0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwg
dW5zaWduZWQgbG9uZyBwZm4sCiB7CiAgICAgaW50IHJjID0gMTsKIAotICAg
IGlmICggKGw0ZV9nZXRfZmxhZ3MobDRlKSAmIF9QQUdFX1BSRVNFTlQpICYm
IAorICAgIGlmICggKGw0ZV9nZXRfZmxhZ3MobDRlKSAmIF9QQUdFX1BSRVNF
TlQpICYmCiAgICAgICAgICAobDRlX2dldF9wZm4obDRlKSAhPSBwZm4pICkK
ICAgICB7CiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBnID0gbDRlX2dl
dF9wYWdlKGw0ZSk7CkBAIC0yMDg1LDggKzIwODUsOCBAQCB2b2lkIHBhZ2Vf
dW5sb2NrKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAKIC8qIEhvdyB0byB3
cml0ZSBhbiBlbnRyeSB0byB0aGUgZ3Vlc3QgcGFnZXRhYmxlcy4KICAqIFJl
dHVybnMgMCBmb3IgZmFpbHVyZSAocG9pbnRlciBub3QgdmFsaWQpLCAxIGZv
ciBzdWNjZXNzLiAqLwotc3RhdGljIGlubGluZSBpbnQgdXBkYXRlX2ludHB0
ZShpbnRwdGVfdCAqcCwgCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludHB0ZV90IG9sZCwgCitzdGF0aWMgaW5saW5lIGludCB1cGRhdGVf
aW50cHRlKGludHB0ZV90ICpwLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbnRwdGVfdCBvbGQsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGludHB0ZV90IG5ldywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBtZm4sCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1ICp2LApAQCAtMjI1Nyw4
ICsyMjU3LDggQEAgc3RhdGljIGludCBtb2RfbDFfZW50cnkobDFfcGdlbnRy
eV90ICpwbDFlLCBsMV9wZ2VudHJ5X3QgbmwxZSwKIAogCiAvKiBVcGRhdGUg
dGhlIEwyIGVudHJ5IGF0IHBsMmUgdG8gbmV3IHZhbHVlIG5sMmUuIHBsMmUg
aXMgd2l0aGluIGZyYW1lIHBmbi4gKi8KLXN0YXRpYyBpbnQgbW9kX2wyX2Vu
dHJ5KGwyX3BnZW50cnlfdCAqcGwyZSwgCi0gICAgICAgICAgICAgICAgICAg
ICAgICBsMl9wZ2VudHJ5X3QgbmwyZSwgCitzdGF0aWMgaW50IG1vZF9sMl9l
bnRyeShsMl9wZ2VudHJ5X3QgKnBsMmUsCisgICAgICAgICAgICAgICAgICAg
ICAgICBsMl9wZ2VudHJ5X3QgbmwyZSwKICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAgICAgICAgICAgICAgICAg
ICAgaW50IHByZXNlcnZlX2FkLAogICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IHZjcHUgKnZjcHUpCkBAIC0yMzIxLDggKzIzMjEsOCBAQCBzdGF0
aWMgaW50IG1vZF9sMl9lbnRyeShsMl9wZ2VudHJ5X3QgKnBsMmUsCiB9CiAK
IC8qIFVwZGF0ZSB0aGUgTDMgZW50cnkgYXQgcGwzZSB0byBuZXcgdmFsdWUg
bmwzZS4gcGwzZSBpcyB3aXRoaW4gZnJhbWUgcGZuLiAqLwotc3RhdGljIGlu
dCBtb2RfbDNfZW50cnkobDNfcGdlbnRyeV90ICpwbDNlLCAKLSAgICAgICAg
ICAgICAgICAgICAgICAgIGwzX3BnZW50cnlfdCBubDNlLCAKK3N0YXRpYyBp
bnQgbW9kX2wzX2VudHJ5KGwzX3BnZW50cnlfdCAqcGwzZSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgIGwzX3BnZW50cnlfdCBubDNlLAogICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAgICAg
ICAgICAgICAgICAgICBpbnQgcHJlc2VydmVfYWQsCiAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgdmNwdSAqdmNwdSkKQEAgLTIzOTQsOCArMjM5
NCw4IEBAIHN0YXRpYyBpbnQgbW9kX2wzX2VudHJ5KGwzX3BnZW50cnlfdCAq
cGwzZSwKIH0KIAogLyogVXBkYXRlIHRoZSBMNCBlbnRyeSBhdCBwbDRlIHRv
IG5ldyB2YWx1ZSBubDRlLiBwbDRlIGlzIHdpdGhpbiBmcmFtZSBwZm4uICov
Ci1zdGF0aWMgaW50IG1vZF9sNF9lbnRyeShsNF9wZ2VudHJ5X3QgKnBsNGUs
IAotICAgICAgICAgICAgICAgICAgICAgICAgbDRfcGdlbnRyeV90IG5sNGUs
IAorc3RhdGljIGludCBtb2RfbDRfZW50cnkobDRfcGdlbnRyeV90ICpwbDRl
LAorICAgICAgICAgICAgICAgICAgICAgICAgbDRfcGdlbnRyeV90IG5sNGUs
CiAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIHBmbiwK
ICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwcmVzZXJ2ZV9hZCwKICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1ICp2Y3B1KQpAQCAt
MjU2MCw3ICsyNTYwLDcgQEAgc3RydWN0IGRvbWFpbiAqcGFnZV9nZXRfb3du
ZXJfYW5kX3JlZmVyZW5jZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICB4ID0geTsKICAgICAgICAgLyoKICAgICAgICAgICogQ291bnQgPT0g
IDA6IFBhZ2UgaXMgbm90IGFsbG9jYXRlZCwgc28gd2UgY2Fubm90IHRha2Ug
YSByZWZlcmVuY2UuCi0gICAgICAgICAqIENvdW50ID09IC0xOiBSZWZlcmVu
Y2UgY291bnQgd291bGQgd3JhcCwgd2hpY2ggaXMgaW52YWxpZC4gCisgICAg
ICAgICAqIENvdW50ID09IC0xOiBSZWZlcmVuY2UgY291bnQgd291bGQgd3Jh
cCwgd2hpY2ggaXMgaW52YWxpZC4KICAgICAgICAgICogQ291bnQgPT0gLTI6
IFJlbWFpbmluZyB1bnVzZWQgcmVmIGlzIHJlc2VydmVkIGZvciBnZXRfcGFn
ZV9saWdodCgpLgogICAgICAgICAgKi8KICAgICAgICAgaWYgKCB1bmxpa2Vs
eSgoKHggKyAyKSAmIFBHQ19jb3VudF9tYXNrKSA8PSAyKSApCkBAIC0yNjQ4
LDcgKzI2NDgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAg
ICAgIHJjID0gYWxsb2Nfc2VnZGVzY19wYWdlKHBhZ2UpOwogICAgICAgICBi
cmVhazsKICAgICBkZWZhdWx0OgotICAgICAgICBwcmludGsoIkJhZCB0eXBl
IGluIGFsbG9jX3BhZ2VfdHlwZSAlbHggdD0lIiBQUnR5cGVfaW5mbyAiIGM9
JWx4XG4iLCAKKyAgICAgICAgcHJpbnRrKCJCYWQgdHlwZSBpbiBhbGxvY19w
YWdlX3R5cGUgJWx4IHQ9JSIgUFJ0eXBlX2luZm8gIiBjPSVseFxuIiwKICAg
ICAgICAgICAgICAgIHR5cGUsIHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvLAog
ICAgICAgICAgICAgICAgcGFnZS0+Y291bnRfaW5mbyk7CiAgICAgICAgIHJj
ID0gLUVJTlZBTDsKQEAgLTI5MDQsOCArMjkwNCw4IEBAIHN0YXRpYyBpbnQg
X19nZXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2ln
bmVkIGxvbmcgdHlwZSwKICAgICAgICAgICAgIGlmICggKHggJiBQR1RfdHlw
ZV9tYXNrKSAhPSB0eXBlICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICAvKgotICAgICAgICAgICAgICAgICAqIE9uIHR5cGUgY2hhbmdlIHdl
IGNoZWNrIHRvIGZsdXNoIHN0YWxlIFRMQiBlbnRyaWVzLiBUaGlzIAotICAg
ICAgICAgICAgICAgICAqIG1heSBiZSB1bm5lY2Vzc2FyeSAoZS5nLiwgcGFn
ZSB3YXMgR0RUL0xEVCkgYnV0IHRob3NlIAorICAgICAgICAgICAgICAgICAq
IE9uIHR5cGUgY2hhbmdlIHdlIGNoZWNrIHRvIGZsdXNoIHN0YWxlIFRMQiBl
bnRyaWVzLiBUaGlzCisgICAgICAgICAgICAgICAgICogbWF5IGJlIHVubmVj
ZXNzYXJ5IChlLmcuLCBwYWdlIHdhcyBHRFQvTERUKSBidXQgdGhvc2UKICAg
ICAgICAgICAgICAgICAgKiBjaXJjdW1zdGFuY2VzIHNob3VsZCBiZSB2ZXJ5
IHJhcmUuCiAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAg
Y3B1bWFza190IG1hc2s7CkBAIC0zODQxLDcgKzM4NDEsNyBAQCBsb25nIGRv
X21tdWV4dF9vcCgKICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg
ICByYyA9IC1FUEVSTTsKICAgICAgICAgICAgIGJyZWFrOwotICAgIAorCiAg
ICAgICAgIGNhc2UgTU1VRVhUX0lOVkxQR19BTEw6CiAgICAgICAgICAgICBp
ZiAoIHVubGlrZWx5KGQgIT0gcGdfb3duZXIpICkKICAgICAgICAgICAgICAg
ICByYyA9IC1FUEVSTTsKQEAgLTQzODAsNyArNDM4MCw3IEBAIHN0YXRpYyBp
bnQgY3JlYXRlX2dyYW50X3B0ZV9tYXBwaW5nKAogICAgICAgICBNRU1fTE9H
KCJDb3VsZCBub3QgZ2V0IHBhZ2UgZm9yIG5vcm1hbCB1cGRhdGUiKTsKICAg
ICAgICAgcmV0dXJuIEdOVFNUX2dlbmVyYWxfZXJyb3I7CiAgICAgfQotICAg
IAorCiAgICAgbWZuID0gcGFnZV90b19tZm4ocGFnZSk7CiAgICAgdmEgPSBt
YXBfZG9tYWluX3BhZ2UoX21mbihtZm4pKTsKICAgICB2YSA9ICh2b2lkICop
KCh1bnNpZ25lZCBsb25nKXZhICsgKCh1bnNpZ25lZCBsb25nKXB0ZV9hZGRy
ICYgflBBR0VfTUFTSykpOwpAQCAtNDQwNCw3ICs0NDA0LDcgQEAgc3RhdGlj
IGludCBjcmVhdGVfZ3JhbnRfcHRlX21hcHBpbmcoCiAgICAgICAgIHBhZ2Vf
dW5sb2NrKHBhZ2UpOwogICAgICAgICByYyA9IEdOVFNUX2dlbmVyYWxfZXJy
b3I7CiAgICAgICAgIGdvdG8gZmFpbGVkOwotICAgIH0gCisgICAgfQogCiAg
ICAgcGFnZV91bmxvY2socGFnZSk7CiAKQEAgLTQ0NDYsNyArNDQ0Niw3IEBA
IHN0YXRpYyBpbnQgZGVzdHJveV9ncmFudF9wdGVfbWFwcGluZygKICAgICAg
ICAgTUVNX0xPRygiQ291bGQgbm90IGdldCBwYWdlIGZvciBub3JtYWwgdXBk
YXRlIik7CiAgICAgICAgIHJldHVybiBHTlRTVF9nZW5lcmFsX2Vycm9yOwog
ICAgIH0KLSAgICAKKwogICAgIG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwog
ICAgIHZhID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4obWZuKSk7CiAgICAgdmEg
PSAodm9pZCAqKSgodW5zaWduZWQgbG9uZyl2YSArICgodW5zaWduZWQgbG9u
ZylhZGRyICYgflBBR0VfTUFTSykpOwpAQCAtNDQ2NSw3ICs0NDY1LDcgQEAg
c3RhdGljIGludCBkZXN0cm95X2dyYW50X3B0ZV9tYXBwaW5nKAogICAgIH0K
IAogICAgIG9sMWUgPSAqKGwxX3BnZW50cnlfdCAqKXZhOwotICAgIAorCiAg
ICAgLyoKICAgICAgKiBDaGVjayB0aGF0IHRoZSBQVEUgc3VwcGxpZWQgYWN0
dWFsbHkgbWFwcyBmcmFtZSAod2l0aCBhcHByb3ByaWF0ZQogICAgICAqIHBl
cm1pc3Npb25zKS4KQEAgLTQ0ODksOCArNDQ4OSw4IEBAIHN0YXRpYyBpbnQg
ZGVzdHJveV9ncmFudF9wdGVfbWFwcGluZygKIAogICAgIC8qIERlbGV0ZSBw
YWdldGFibGUgZW50cnkuICovCiAgICAgaWYgKCB1bmxpa2VseSghVVBEQVRF
X0VOVFJZCi0gICAgICAgICAgICAgICAgICAobDEsIAotICAgICAgICAgICAg
ICAgICAgIChsMV9wZ2VudHJ5X3QgKil2YSwgb2wxZSwgbDFlX2VtcHR5KCks
IG1mbiwgCisgICAgICAgICAgICAgICAgICAobDEsCisgICAgICAgICAgICAg
ICAgICAgKGwxX3BnZW50cnlfdCAqKXZhLCBvbDFlLCBsMWVfZW1wdHkoKSwg
bWZuLAogICAgICAgICAgICAgICAgICAgIGQtPnZjcHVbMF0gLyogQ2hhbmdl
IGlmIHdlIGdvIHRvIHBlci12Y3B1IHNoYWRvd3MuICovLAogICAgICAgICAg
ICAgICAgICAgIDApKSApCiAgICAgewpAQCAtNDUxNyw3ICs0NTE3LDcgQEAg
c3RhdGljIGludCBjcmVhdGVfZ3JhbnRfdmFfbWFwcGluZygKICAgICB1bnNp
Z25lZCBsb25nIGdsMW1mbjsKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpsMXBn
OwogICAgIGludCBva2F5OwotICAgIAorCiAgICAgYWRqdXN0X2d1ZXN0X2wx
ZShubDFlLCBkKTsKIAogICAgIHBsMWUgPSBndWVzdF9tYXBfbDFlKHZhLCAm
Z2wxbWZuKTsKQEAgLTQ1NzAsNyArNDU3MCw3IEBAIHN0YXRpYyBpbnQgcmVw
bGFjZV9ncmFudF92YV9tYXBwaW5nKAogICAgIHVuc2lnbmVkIGxvbmcgZ2wx
bWZuOwogICAgIHN0cnVjdCBwYWdlX2luZm8gKmwxcGc7CiAgICAgaW50IHJj
ID0gMDsKLSAgICAKKwogICAgIHBsMWUgPSBndWVzdF9tYXBfbDFlKGFkZHIs
ICZnbDFtZm4pOwogICAgIGlmICggIXBsMWUgKQogICAgIHsKQEAgLTQ2Njcs
NyArNDY2Nyw3IEBAIHN0YXRpYyBpbnQgY3JlYXRlX2dyYW50X3AybV9tYXBw
aW5nKHVpbnQ2NF90IGFkZHIsIHVuc2lnbmVkIGxvbmcgZnJhbWUsCiAgICAg
ICAgIHJldHVybiBHTlRTVF9va2F5OwogfQogCi1pbnQgY3JlYXRlX2dyYW50
X2hvc3RfbWFwcGluZyh1aW50NjRfdCBhZGRyLCB1bnNpZ25lZCBsb25nIGZy
YW1lLCAKK2ludCBjcmVhdGVfZ3JhbnRfaG9zdF9tYXBwaW5nKHVpbnQ2NF90
IGFkZHIsIHVuc2lnbmVkIGxvbmcgZnJhbWUsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MsIHVuc2lnbmVkIGlu
dCBjYWNoZV9mbGFncykKIHsKICAgICBsMV9wZ2VudHJ5X3QgcHRlOwpAQCAt
NDczNiw3ICs0NzM2LDcgQEAgaW50IHJlcGxhY2VfZ3JhbnRfaG9zdF9tYXBw
aW5nKAogICAgIHN0cnVjdCBwYWdlX2luZm8gKmwxcGc7CiAgICAgaW50IHJj
OwogICAgIHVuc2lnbmVkIGludCBncmFudF9wdGVfZmxhZ3M7Ci0gICAgCisK
ICAgICBpZiAoIHBhZ2luZ19tb2RlX2V4dGVybmFsKGN1cnJlbnQtPmRvbWFp
bikgKQogICAgICAgICByZXR1cm4gcmVwbGFjZV9ncmFudF9wMm1fbWFwcGlu
ZyhhZGRyLCBmcmFtZSwgbmV3X2FkZHIsIGZsYWdzKTsKIApAQCAtNDc2Miw3
ICs0NzYyLDcgQEAgaW50IHJlcGxhY2VfZ3JhbnRfaG9zdF9tYXBwaW5nKAog
ICAgICAgICBpZiAoICFuZXdfYWRkciApCiAgICAgICAgICAgICByZXR1cm4g
ZGVzdHJveV9ncmFudF9wdGVfbWFwcGluZyhhZGRyLCBmcmFtZSwgZ3JhbnRf
cHRlX2ZsYWdzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY3Vyci0+ZG9tYWluKTsKLSAgICAgICAgCisKICAgICAg
ICAgTUVNX0xPRygiVW5zdXBwb3J0ZWQgZ3JhbnQgdGFibGUgb3BlcmF0aW9u
Iik7CiAgICAgICAgIHJldHVybiBHTlRTVF9nZW5lcmFsX2Vycm9yOwogICAg
IH0KQEAgLTUxNTIsNyArNTE1Miw3IEBAIHZvaWQgZGVzdHJveV9nZHQoc3Ry
dWN0IHZjcHUgKnYpCiB9CiAKIAotbG9uZyBzZXRfZ2R0KHN0cnVjdCB2Y3B1
ICp2LCAKK2xvbmcgc2V0X2dkdChzdHJ1Y3QgdmNwdSAqdiwKICAgICAgICAg
ICAgICB1bnNpZ25lZCBsb25nICpmcmFtZXMsCiAgICAgICAgICAgICAgdW5z
aWduZWQgaW50IGVudHJpZXMpCiB7CkBAIC01MjE0LDcgKzUyMTQsNyBAQCBs
b25nIGRvX3NldF9nZHQoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fdWxv
bmdfdCkgZnJhbWVfbGlzdCwKICAgICAvKiBSZWNoZWNrZWQgaW4gc2V0X2dk
dCwgYnV0IGVuc3VyZXMgYSBzYW5lIGxpbWl0IGZvciBjb3B5X2Zyb21fdXNl
cigpLiAqLwogICAgIGlmICggZW50cmllcyA+IEZJUlNUX1JFU0VSVkVEX0dE
VF9FTlRSWSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwotICAgIAorCiAg
ICAgaWYgKCBjb3B5X2Zyb21fZ3Vlc3QoZnJhbWVzLCBmcmFtZV9saXN0LCBu
cl9wYWdlcykgKQogICAgICAgICByZXR1cm4gLUVGQVVMVDsKIApAQCAtNTUw
NCw3ICs1NTA0LDcgQEAgbG9uZyBhcmNoX21lbW9yeV9vcCh1bnNpZ25lZCBs
b25nIGNtZCwgWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh2b2lkKSBhcmcpCiAg
ICAgICAgICAgICByY3VfdW5sb2NrX2RvbWFpbihkKTsKICAgICAgICAgICAg
IHJldHVybiAtRU5PTUVNOwogICAgICAgICB9Ci0gICAgICAgIAorCiAgICAg
ICAgIGlmICggY29weV9mcm9tX2d1ZXN0KGU4MjAsIGZtYXAubWFwLmJ1ZmZl
ciwgZm1hcC5tYXAubnJfZW50cmllcykgKQogICAgICAgICB7CiAgICAgICAg
ICAgICB4ZnJlZShlODIwKTsKQEAgLTU2NTYsNyArNTY1Niw3IEBAIGxvbmcg
YXJjaF9tZW1vcnlfb3AodW5zaWduZWQgbG9uZyBjbWQsIFhFTl9HVUVTVF9I
QU5ETEVfUEFSQU0odm9pZCkgYXJnKQogICAgICAgICAgICAgICAgIHJjID0g
LUVJTlZBTDsKICAgICAgICAgICAgICAgICBnb3RvIHBvZF90YXJnZXRfb3V0
X3VubG9jazsKICAgICAgICAgICAgIH0KLSAgICAgICAgICAgIAorCiAgICAg
ICAgICAgICByYyA9IHAybV9wb2Rfc2V0X21lbV90YXJnZXQoZCwgdGFyZ2V0
LnRhcmdldF9wYWdlcyk7CiAgICAgICAgIH0KIApAQCAtNTY3OCw3ICs1Njc4
LDcgQEAgbG9uZyBhcmNoX21lbW9yeV9vcCh1bnNpZ25lZCBsb25nIGNtZCwg
WEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh2b2lkKSBhcmcpCiAgICAgICAgICAg
ICAgICAgZ290byBwb2RfdGFyZ2V0X291dF91bmxvY2s7CiAgICAgICAgICAg
ICB9CiAgICAgICAgIH0KLSAgICAgICAgCisKICAgICBwb2RfdGFyZ2V0X291
dF91bmxvY2s6CiAgICAgICAgIHJjdV91bmxvY2tfZG9tYWluKGQpOwogICAg
ICAgICByZXR1cm4gcmM7CkBAIC01OTE0LDcgKzU5MTQsNyBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IHg4Nl9lbXVsYXRlX29wcyBwdHdyX2VtdWxhdGVfb3Bz
ID0gewogfTsKIAogLyogV3JpdGUgcGFnZSBmYXVsdCBoYW5kbGVyOiBjaGVj
ayBpZiBndWVzdCBpcyB0cnlpbmcgdG8gbW9kaWZ5IGEgUFRFLiAqLwotaW50
IHB0d3JfZG9fcGFnZV9mYXVsdChzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQg
bG9uZyBhZGRyLCAKK2ludCBwdHdyX2RvX3BhZ2VfZmF1bHQoc3RydWN0IHZj
cHUgKnYsIHVuc2lnbmVkIGxvbmcgYWRkciwKICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiB7CiAgICAgc3Ry
dWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0002-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0002-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Transfer-Encoding: base64

RnJvbSBmY2ZiM2ZjNzcwNTJkMzI4MjczYTk4ZTRmMzYwMzU0YWY2NjBhZmZl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAyLzEyXSB4
ODYvbW06IEwxVEYgY2hlY2tzIGRvbid0IGxlYXZlIGEgcGFydGlhbCBlbnRy
eQoKT24gZGV0ZWN0aW9uIG9mIGEgcG90ZW50aWFsIEwxVEYgaXNzdWUsIG1v
c3QgdmFsaWRhdGlvbiBjb2RlIHJldHVybnMKLUVSRVNUQVJUIHRvIGFsbG93
IHRoZSBzd2l0Y2ggdG8gc2hhZG93IG1vZGUgdG8gaGFwcGVuIGFuZCBjYXVz
ZSB0aGUKb3JpZ2luYWwgb3BlcmF0aW9uIHRvIGJlIHJlc3RhcnRlZC4KCkhv
d2V2ZXIsIGluIHRoZSB2YWxpZGF0aW9uIGNvZGUsIHRoZSByZXR1cm4gdmFs
dWUgLUVSRVNUQVJUIGhhcyBiZWVuCnJlcHVycG9zZWQgdG8gaW5kaWNhdGUg
MSkgdGhlIGZ1bmN0aW9uIGhhcyBwYXJ0aWFsbHkgY29tcGxldGVkCnNvbWV0
aGluZyB3aGljaCBuZWVkcyB0byBiZSB1bmRvbmUsIGFuZCAyKSBjYWxsaW5n
IHB1dF9wYWdlX3R5cGUoKQpzaG91bGQgY2xlYW5seSB1bmRvIGl0LiAgVGhp
cyBjYXVzZXMgcHJvYmxlbXMgaW4gc2V2ZXJhbCBwbGFjZXMuCgpGb3IgTDEg
dGFibGVzLCBvbiByZWNlaXZpbmcgYW4gLUVSRVNUQVJUIHJldHVybiBmcm9t
IGFsbG9jX2wxX3RhYmxlKCksCmFsbG9jX3BhZ2VfdHlwZSgpIHdpbGwgc2V0
IFBHVF9wYXJ0aWFsIG9uIHRoZSBwYWdlLiAgSWYgZm9yIHNvbWUKcmVhc29u
IHRoZSBvcmlnaW5hbCBvcGVyYXRpb24gbmV2ZXIgcmVzdGFydHMsIHRoZW4g
b24gZG9tYWluCmRlc3RydWN0aW9uLCByZWxpbnF1aXNoX21lbW9yeSgpIHdp
bGwgY2FsbCBmcmVlX3BhZ2VfdHlwZSgpIG9uIHRoZQpwYWdlLgoKVW5mb3J0
dW5hdGVseSwgYWxsb2NfIGFuZCBmcmVlX2wxX3RhYmxlKCkgYXJlbid0IHNl
dCB1cCB0byBkZWFsIHdpdGgKUEdUX3BhcnRpYWwuICBXaGVuIHJldHVybmlu
ZyBhIGZhaWx1cmUsIGFsbG9jX2wxX3RhYmxlKCkgYWx3YXlzCmRlLXZhbGlk
YXRlcyB3aGF0ZXZlciBpdCdzIHZhbGlkYXRlZCBzbyBmYXIsIGFuZCBmcmVl
X2wxX3RhYmxlKCkKYWx3YXlzIGRldmFsaWRhdGVzIHRoZSB3aG9sZSBwYWdl
LiAgVGhpcyBtZWFucyB0aGF0IGlmCnJlbGlucXVpc2hfbWVtb3J5KCkgY2Fs
bHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBhbiBMMSB0aGF0IGRpZG4ndApjb21w
bGV0ZSBkdWUgdG8gYW4gTDFURiwgaXQgd2lsbCBjYWxsIHB1dF9wYWdlX2Zy
b21fbDFlKCkgb24gInBhZ2UKZW50cmllcyIgdGhhdCBoYXZlIG5ldmVyIGJl
ZW4gdmFsaWRhdGVkLgoKRm9yIEwyKyB0YWJsZXMsIHNldHRpbmcgcmMgdG8g
RVJFU1RBUlQgY2F1c2VzIHRoZSByZXN0IG9mIHRoZQphbGxvY19sTl90YWJs
ZSgpIGZ1bmN0aW9uIHRvICp0aGluayogdGhhdCB0aGUgZW50cnkgaW4gcXVl
c3Rpb24gd2lsbApoYXZlIFBHVF9wYXJ0aWFsIHNldC4gIFRoaXMgd2lsbCBj
YXVzZSBpdCB0byBzZXQgcGFydGlhbF9wdGUgPSAxLiAgSWYKcmVsaW5xdXNo
X21lbW9yeSgpIHRoZW4gY2FsbHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBvbmUg
b2YgdGhvc2UgcGFnZXMsCnRoZW4gZnJlZV9sTl90YWJsZSgpIHdpbGwgY2Fs
bCBwdXRfcGFnZV9mcm9tX2xOZSgpIG9uIHRoZSBlbnRyeSB3aGVuCml0IHNo
b3VsZG4ndC4KClJhdGhlciB0aGFuIGluZGljYXRpbmcgLUVSRVNUQVJULCBp
bmRpY2F0ZSAtRUlOVFIuICBUaGlzIGlzIHRoZSBjb2RlCnRvIGluZGljYXRl
IHRoYXQgbm90aGluZyBoYXMgY2hhbmdlZCBmcm9tIHdoZW4geW91IHN0YXJ0
ZWQgdGhlIGNhbGwKKHdoaWNoIGlzIGVmZmVjdGl2ZWx5IGhvdyBhbGxvY19s
MV90YWJsZSgpIGhhbmRsZXMgZXJyb3JzKS4KCm1vZF9sTl9lbnRyeSgpIHNo
b3VsZG4ndCBoYXZlIGFueSBvZiB0aGVzZSB0eXBlcyBvZiBwcm9ibGVtcywg
c28gbGVhdmUKcG90ZW50aWFsIGNoYW5nZXMgdGhlcmUgZm9yIGEgY2xlYW4t
dXAgcGF0Y2ggbGF0ZXIuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJl
cG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5k
dW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDgg
KysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA1YzlkYjNmODk4Li4xYzE5MDky
NTAzIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTIzNiw3ICsxMjM2LDcgQEAgZ2V0X3BhZ2Vf
ZnJvbV9sMmUoCiAgICAgaW50IHJjOwogCiAgICAgaWYgKCAhKGwyZV9nZXRf
ZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKLSAgICAgICAgcmV0dXJu
IHB2X2wxdGZfY2hlY2tfbDJlKGQsIGwyZSkgPyAtRVJFU1RBUlQgOiAxOwor
ICAgICAgICByZXR1cm4gcHZfbDF0Zl9jaGVja19sMmUoZCwgbDJlKSA/IC1F
SU5UUiA6IDE7CiAKICAgICBpZiAoIHVubGlrZWx5KChsMmVfZ2V0X2ZsYWdz
KGwyZSkgJiBMMl9ESVNBTExPV19NQVNLKSkgKQogICAgIHsKQEAgLTEyNzgs
NyArMTI3OCw3IEBAIGdldF9wYWdlX2Zyb21fbDNlKAogICAgIGludCByYzsK
IAogICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QUkVT
RU5UKSApCi0gICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2wzZShkLCBs
M2UpID8gLUVSRVNUQVJUIDogMTsKKyAgICAgICAgcmV0dXJuIHB2X2wxdGZf
Y2hlY2tfbDNlKGQsIGwzZSkgPyAtRUlOVFIgOiAxOwogCiAgICAgaWYgKCB1
bmxpa2VseSgobDNlX2dldF9mbGFncyhsM2UpICYgbDNfZGlzYWxsb3dfbWFz
ayhkKSkpICkKICAgICB7CkBAIC0xMzA0LDcgKzEzMDQsNyBAQCBnZXRfcGFn
ZV9mcm9tX2w0ZSgKICAgICBpbnQgcmM7CiAKICAgICBpZiAoICEobDRlX2dl
dF9mbGFncyhsNGUpICYgX1BBR0VfUFJFU0VOVCkgKQotICAgICAgICByZXR1
cm4gcHZfbDF0Zl9jaGVja19sNGUoZCwgbDRlKSA/IC1FUkVTVEFSVCA6IDE7
CisgICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2w0ZShkLCBsNGUpID8g
LUVJTlRSIDogMTsKIAogICAgIGlmICggdW5saWtlbHkoKGw0ZV9nZXRfZmxh
Z3MobDRlKSAmIEw0X0RJU0FMTE9XX01BU0spKSApCiAgICAgewpAQCAtMTU2
Nyw3ICsxNTY3LDcgQEAgc3RhdGljIGludCBhbGxvY19sMV90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHsKICAgICAgICAgaWYgKCAhKGwx
ZV9nZXRfZmxhZ3MocGwxZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIHJldCA9IHB2X2wxdGZfY2hlY2tfbDFlKGQs
IHBsMWVbaV0pID8gLUVSRVNUQVJUIDogMDsKKyAgICAgICAgICAgIHJldCA9
IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBsMWVbaV0pID8gLUVJTlRSIDogMDsK
ICAgICAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgICAgICBnb3Rv
IG91dDsKICAgICAgICAgfQotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0003-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0003-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Transfer-Encoding: base64

RnJvbSAyZmNhOTJlZWQ2OWJlMjU0NmMxYzVhMGM3ODczMmM3MTk4NWVlMDhj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAzLzEyXSB4
ODYvbW06IERvbid0IHJlLXNldCBQR1RfcGlubmVkIG9uIGEgcGFydGlhbGx5
CiBkZS12YWxpZGF0ZWQgcGFnZQoKV2hlbiB1bnBpbm5pbmcgcGFnZXRhYmxl
cywgaWYgYW4gb3BlcmF0aW9uIGlzIGludGVycnVwdGVkLApyZWxpbnF1aXNo
X21lbW9yeSgpIHJlLXNldHMgUEdUX3Bpbm5lZCBzbyB0aGF0IHRoZSB1bi1w
aW4gd2lsbApwaWNrZWR1cCBhZ2FpbiB3aGVuIHRoZSBoeXBlcmNhbGwgcmVz
dGFydHMuCgpUaGlzIGlzIGFwcHJvcHJpYXRlIHdoZW4gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKSByZXR1cm5zCi1FSU5UUiwgd2hpY2ggaW5k
aWNhdGVzIHRoYXQgdGhlIHBhZ2UgaXMgYmFjayBpbiBpdHMgaW5pdGlhbCBz
dGF0ZQooaS5lLiwgY29tcGxldGVseSB2YWxpZGF0ZWQpLiAgSG93ZXZlciwg
Zm9yIC1FUkVTVEFSVCwgdGhpcyBsZWFkcyB0byBhCnN0YXRlIHdoZXJlIGEg
cGFnZSBoYXMgYm90aCBQR1RfcGlubmVkIGFuZCBQR1RfcGFydGlhbCBzZXQu
CgpUaGlzIGhhcHBlbnMgdG8gd29yayBhdCB0aGUgbW9tZW50LCBhbHRob3Vn
aCBpdCdzIG5vdCByZWFsbHkgYQoiY2Fub25pY2FsIiBzdGF0ZTsgYnV0IGlu
IHN1YnNlcXVlbnQgcGF0Y2hlcywgd2hlcmUgd2UgbmVlZCB0byBtYWtlIGEK
ZGlzdGluY3Rpb24gaW4gaGFuZGxpbmcgYmV0d2VlbiBQR1RfdmFsaWRhdGVk
IGFuZCBQR1RfcGFydGlhbCBwYWdlcywKdGhpcyBjYXVzZXMgaXNzdWVzLgoK
TW92ZSB0byBhICJjYW5vbmljYWwiIHN0YXRlIGJ5OgotIE9ubHkgcmUtc2V0
dGluZyBQR1RfcGlubmVkIG9uIC1FSU5UUgotIFJlLWRyb3BwaW5nIHRoZSBy
ZWZjb3VudCBoZWxkIGJ5IFBHVF9waW5uZWQgb24gLUVSRVNUQVJUCgpJbiB0
aGUgbGF0dGVyIGNhc2UsIHRoZSBQR1RfcGFydGlhbCBiaXQgd2lsbCBiZSBj
bGVhcmVkIGZ1cnRoZXIgZG93bgp3aXRoIHRoZSByZXN0IG9mIHRoZSBvdGhl
ciBQR1RfcGFydGlhbCBwYWdlcy4KCldoaWxlIGhlcmUsIGNsZWFuIHVwIHNv
bWUgdHJhaW5saW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVu
bGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tYWluLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggMzk0NmVhMzhmZC4uNDAwZWZi
YWQxNCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTU5LDcgKzE1OSw3IEBAIHN0
YXRpYyB2b2lkIHBsYXlfZGVhZCh2b2lkKQogICAgICAqIHRoaXMgY2FzZSwg
aGVhcCBjb3JydXB0aW9uIG9yICNQRiBjYW4gb2NjdXIgKHdoZW4gaGVhcCBk
ZWJ1Z2dpbmcgaXMKICAgICAgKiBlbmFibGVkKS4gRm9yIGV4YW1wbGUsIGV2
ZW4gcHJpbnRrKCkgY2FuIGludm9sdmUgdGFza2xldCBzY2hlZHVsaW5nLAog
ICAgICAqIHdoaWNoIHRvdWNoZXMgcGVyLWNwdSB2YXJzLgotICAgICAqIAor
ICAgICAqCiAgICAgICogQ29uc2lkZXIgdmVyeSBjYXJlZnVsbHkgd2hlbiBh
ZGRpbmcgY29kZSB0byAqZGVhZF9pZGxlLiBNb3N0IGh5cGVydmlzb3IKICAg
ICAgKiBzdWJzeXN0ZW1zIGFyZSB1bnNhZmUgdG8gY2FsbC4KICAgICAgKi8K
QEAgLTI2MzgsOSArMjYzOCwzNCBAQCBzdGF0aWMgaW50IHJlbGlucXVpc2hf
bWVtb3J5KAogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLUVS
RVNUQVJUOgogICAgICAgICBjYXNlIC1FSU5UUjoKKyAgICAgICAgICAgIC8q
CisgICAgICAgICAgICAgKiAtRUlOVFIgbWVhbnMgUEdUX3ZhbGlkYXRlZCBo
YXMgYmVlbiByZS1zZXQ7IHJlLXNldAorICAgICAgICAgICAgICogUEdUX3Bp
bm5lZCBhZ2FpbiBzbyB0aGF0IGl0IGdldHMgcGlja2VkIHVwIG5leHQgdGlt
ZQorICAgICAgICAgICAgICogYXJvdW5kLgorICAgICAgICAgICAgICoKKyAg
ICAgICAgICAgICAqIC1FUkVTVEFSVCwgT1RPSCwgbWVhbnMgUEdUX3BhcnRp
YWwgaXMgc2V0IGluc3RlYWQuICBQdXQKKyAgICAgICAgICAgICAqIGl0IGJh
Y2sgb24gdGhlIGxpc3QsIGJ1dCBkb24ndCBzZXQgUEdUX3Bpbm5lZDsgdGhl
CisgICAgICAgICAgICAgKiBzZWN0aW9uIGJlbG93IHdpbGwgZmluaXNoIG9m
ZiBkZS12YWxpZGF0aW9uLiAgQnV0IHdlIGRvCisgICAgICAgICAgICAgKiBu
ZWVkIHRvIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGFzc29jaWF0ZWQgd2l0aAor
ICAgICAgICAgICAgICogUEdUX3Bpbm5lZCwgc2luY2UgcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKQorICAgICAgICAgICAgICogZGlkbid0IGRv
IGl0LgorICAgICAgICAgICAgICoKKyAgICAgICAgICAgICAqIE5CIHdlIGNh
biBkbyBhbiBBU1NFUlQgZm9yIFBHVF92YWxpZGF0ZWQsIHNpbmNlIHdlCisg
ICAgICAgICAgICAgKiAib3duIiB0aGUgdHlwZSByZWY7IGJ1dCB0aGVvcmV0
aWNhbGx5LCB0aGUgUEdUX3BhcnRpYWwKKyAgICAgICAgICAgICAqIGNvdWxk
IGJlIGNsZWFyZWQgYnkgc29tZW9uZSBlbHNlLgorICAgICAgICAgICAgICov
CisgICAgICAgICAgICBpZiAoIHJldCA9PSAtRUlOVFIgKQorICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIEFTU0VSVChwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmIFBHVF92YWxpZGF0ZWQpOworICAgICAgICAgICAgICAgIHNl
dF9iaXQoX1BHVF9waW5uZWQsICZwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICBlbHNlCisgICAgICAgICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CisKICAgICAgICAgICAgIHJldCA9IC1F
UkVTVEFSVDsKKworICAgICAgICAgICAgLyogUHV0IHRoZSBwYWdlIGJhY2sg
b24gdGhlIGxpc3QgYW5kIGRyb3AgdGhlIHJlZiB3ZSBncmFiYmVkIGFib3Zl
ICovCiAgICAgICAgICAgICBwYWdlX2xpc3RfYWRkKHBhZ2UsIGxpc3QpOwot
ICAgICAgICAgICAgc2V0X2JpdChfUEdUX3Bpbm5lZCwgJnBhZ2UtPnUuaW51
c2UudHlwZV9pbmZvKTsKICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwog
ICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIGRlZmF1bHQ6CkBAIC0y
OTAzLDcgKzI5MjgsNyBAQCB2b2lkIHZjcHVfa2ljayhzdHJ1Y3QgdmNwdSAq
dikKICAgICAgKiBwZW5kaW5nIGZsYWcuIFRoZXNlIHZhbHVlcyBtYXkgZmx1
Y3R1YXRlIChhZnRlciBhbGwsIHdlIGhvbGQgbm8KICAgICAgKiBsb2Nrcykg
YnV0IHRoZSBrZXkgaW5zaWdodCBpcyB0aGF0IGVhY2ggY2hhbmdlIHdpbGwg
Y2F1c2UKICAgICAgKiBldnRjaG5fdXBjYWxsX3BlbmRpbmcgdG8gYmUgcG9s
bGVkLgotICAgICAqIAorICAgICAqCiAgICAgICogTkIyLiBXZSBzYXZlIHRo
ZSBydW5uaW5nIGZsYWcgYWNyb3NzIHRoZSB1bmJsb2NrIHRvIGF2b2lkIGEg
bmVlZGxlc3MKICAgICAgKiBJUEkgZm9yIGRvbWFpbnMgdGhhdCB3ZSBJUEkn
ZCB0byB1bmJsb2NrLgogICAgICAqLwotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0004-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0004-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Transfer-Encoding: base64

RnJvbSAzOTA2Mzg2NGU3MGEzMGEyZWU5NTg5NTNlZDcxNzYwZTc1OTZmMjAy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA0LzEyXSB4
ODYvbW06IFNlcGFyYXRlIG91dCBwYXJ0aWFsX3B0ZSB0cmlzdGF0ZSBpbnRv
CiBpbmRpdmlkdWFsIGZsYWdzCgpBdCB0aGUgbW9tZW50LCBwYXJ0aWFsX3B0
ZSBpcyBhIHRyaS1zdGF0ZSB0aGF0IGNvbnRhaW5zIHR3byBkaXN0aW5jdCBi
aXRzCm9mIGluZm9ybWF0aW9uOgoKMS4gSWYgemVybywgdGhlIHB0ZSBhdCBp
bmRleCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHVuLXZhbGlkYXRlZC4gIElm
CiAgIG5vbi16ZXJvLCB0aGUgcHRlIHdhcyBsYXN0IHNlZW4gd2l0aCBQR1Rf
cGFydGlhbCBzZXQuCgoyLiBJZiBwb3NpdGl2ZSwgdGhlIHB0ZSBhdCBpbmRl
eCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGRvZXMgbm90IGhvbGQgYQogICBnZW5l
cmFsIHJlZmVyZW5jZSBjb3VudC4gIElmIG5lZ2F0aXZlLCBpdCBkb2VzLgoK
VG8gbWFrZSBmdXR1cmUgcGF0Y2hlcyBtb3JlIGNsZWFyLCBzZXBhcmF0ZSBv
dXQgdGhpcyBmdW5jdGlvbmFsaXR5CmludG8gdHdvIGRpc3RpbmN0LCBuYW1l
ZCBiaXRzOiBQVEZfcGFydGlhbF9zZXQgKGZvciAjMSkgYW5kClBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIChmb3IgIzIpLgoKQWRkaXRpb25hbGx5LCBhIG51
bWJlciBvZiBmdW5jdGlvbnMgd2hpY2ggbmVlZCB0aGlzIGluZm9ybWF0aW9u
IGFsc28KdGFrZSBvdGhlciBmbGFncyB0byBjb250cm9sIGJlaGF2aW9yIChz
dWNoIGFzIGBwcmVlbXB0aWJsZWAgYW5kCmBkZWZlcmApLiAgVGhlc2UgYXJl
IGhhcmQgdG8gcmVhZCBpbiB0aGUgY2FsbGVyIChzaW5jZSB5b3Ugb25seSBz
ZWUKJ3RydWUnIG9yICdmYWxzZScpLCBhbmQgdWdseSB3aGVuIG1hbnkgYXJl
IGFkZGVkIHRvZ2V0aGVyLiAgSW4KcHJlcGFyYXRpb24gZm9yIGFkZGluZyB5
ZXQgYW5vdGhlciBmbGFnIGluIGEgZnV0dXJlIHBhdGNoLCBjb2xsYXBzZQph
bGwgb2YgdGhlc2UgaW50byBhIHNpbmdsZSBgZmxhZ2AgdmFyaWFibGUuCgpO
QiB0aGF0IHRoaXMgZG9lcyBtZWFuIGNoZWNraW5nIGZvciB3aGF0IHdhcyBw
cmV2aW91c2x5IHRoZSAnLTEnCmNvbmRpdGlvbiBhIGJpdCBtb3JlIHVnbHkg
aW4gdGhlIHB1dF9wYWdlX2Zyb21fbE5lIGZ1bmN0aW9ucyAoc2luY2UKeW91
IGhhdmUgdG8gY2hlY2sgZm9yIGJvdGggcGFydGlhbF9zZXQgYW5kIGdlbmVy
YWwgcmVmKTsgYnV0IHRoaXMKY2xhdXNlIHdpbGwgZ28gYXdheSBpbiBhIGZ1
dHVyZSBwYXRjaC4KCkFsc28gbm90ZSB0aGF0IHRoZSBvcmlnaW5hbCBjb21t
ZW50IGhhZCBhbiBvZmYtYnktb25lIGVycm9yOgpwYXJ0aWFsX2ZsYWdzIChs
aWtlIHBhcnRpYWxfcHRlIGJlZm9yZSBpdCkgY29uY2VybnMKcGxOZVtucl92
YWxpZGF0ZWRfcHRlc10sIG5vdCBwbE5lW25yX3ZhbGlkYXRlZF9wdGVzKzFd
LgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyAgICAgICAgfCAxNjYgKysrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggfCAgNDEgKysrKysrKy0tLQogMiBmaWxlcyBjaGFuZ2VkLCAxMjggaW5z
ZXJ0aW9ucygrKSwgNzkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAxYzE5
MDkyNTAzLi42ODBiNWIzZGU3IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNzU2LDIyICs3NTYs
MzUgQEAgc3RhdGljIGludCBnZXRfcGFnZV9mcm9tX3BhZ2Vucih1bnNpZ25l
ZCBsb25nIHBhZ2VfbnIsIHN0cnVjdCBkb21haW4gKmQpCiBzdGF0aWMgaW50
IF9fZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgcHJlZW1wdGlibGUpOwogCisvKgorICogVGhlIGZvbGxvd2luZyBmbGFn
cyBhcmUgdXNlZCB0byBzcGVjaWZ5IGJlaGF2aW9yIG9mIHZhcmlvdXMgZ2V0
IGFuZAorICogcHV0IGNvbW1hbmRzLiAgVGhlIGZpcnN0IHR3byBhcmUgYWxz
byBzdG9yZWQgaW4gcGFnZS0+cGFydGlhbF9mbGFncworICogdG8gaW5kaWNh
dGUgdGhlIHN0YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQgdG8gYnkKKyAqIHBh
Z2UtPnB0ZVtwYWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhl
IGNvbW1lbnQgaW4gbW0uaCBmb3IKKyAqIG1vcmUgaW5mb3JtYXRpb24uCisg
Ki8KKyNkZWZpbmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwgMCkK
KyNkZWZpbmUgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkKKyNk
ZWZpbmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKKyNkZWZp
bmUgUFRGX2RlZmVyICAgICAgICAgICAgICAgKDEgPDwgMykKKwogc3RhdGlj
IGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3BhZ2Vucih1bnNpZ25lZCBs
b25nIHBhZ2VfbnIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGxvbmcgdHlwZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRvbWFpbiAqZCwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
IHBhcnRpYWwsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBwcmVlbXB0aWJsZSkKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKQogewog
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9fcGFnZShwYWdl
X25yKTsKICAgICBpbnQgcmM7CisgICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZs
YWdzICYgUFRGX3ByZWVtcHRpYmxlLAorICAgICAgICAgcGFydGlhbF9yZWYg
PSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogCi0gICAgaWYg
KCBsaWtlbHkocGFydGlhbCA+PSAwKSAmJgorICAgIGlmICggbGlrZWx5KCFw
YXJ0aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9m
cm9tX3BhZ2VucihwYWdlX25yLCBkKSkgKQogICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKIAogICAgIHJjID0gX19nZXRfcGFnZV90eXBlKHBhZ2UsIHR5cGUs
IHByZWVtcHRpYmxlKTsKIAotICAgIGlmICggdW5saWtlbHkocmMpICYmIHBh
cnRpYWwgPj0gMCAmJgorICAgIGlmICggdW5saWtlbHkocmMpICYmICFwYXJ0
aWFsX3JlZiAmJgogICAgICAgICAgKCFwcmVlbXB0aWJsZSB8fCBwYWdlICE9
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKSApCiAgICAgICAgIHB1
dF9wYWdlKHBhZ2UpOwogCkBAIC0xMjMwLDcgKzEyNDMsNyBAQCBnZXRfcGFn
ZV9mcm9tX2wxZSgKIGRlZmluZV9nZXRfbGluZWFyX3BhZ2V0YWJsZShsMik7
CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9tX2wyZSgKLSAgICBsMl9wZ2Vu
dHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3RydWN0IGRvbWFpbiAq
ZCwgaW50IHBhcnRpYWwpCisgICAgbDJfcGdlbnRyeV90IGwyZSwgdW5zaWdu
ZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGludCBm
bGFncykKIHsKICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwyZV9nZXRfcGZu
KGwyZSk7CiAgICAgaW50IHJjOwpAQCAtMTI0Niw4ICsxMjU5LDkgQEAgZ2V0
X3BhZ2VfZnJvbV9sMmUoCiAKICAgICBpZiAoICEobDJlX2dldF9mbGFncyhs
MmUpICYgX1BBR0VfUFNFKSApCiAgICAgewotICAgICAgICByYyA9IGdldF9w
YWdlX2FuZF90eXBlX2Zyb21fcGFnZW5yKG1mbiwgUEdUX2wxX3BhZ2VfdGFi
bGUsIGQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcGFydGlhbCwgZmFsc2UpOworICAgICAgICBBU1NFUlQoIShmbGFn
cyAmIFBURl9wcmVlbXB0aWJsZSkpOworCisgICAgICAgIHJjID0gZ2V0X3Bh
Z2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobWZuLCBQR1RfbDFfcGFnZV90YWJs
ZSwgZCwgZmxhZ3MpOwogICAgICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1F
SU5WQUwpICYmIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKGwyZSwgcGZuLCBk
KSApCiAgICAgICAgICAgICByYyA9IDA7CiAgICAgICAgIHJldHVybiByYzsK
QEAgLTEyNzMsNyArMTI4Nyw3IEBAIGdldF9wYWdlX2Zyb21fbDJlKAogZGVm
aW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGwzKTsKIHN0YXRpYyBpbnQKIGdl
dF9wYWdlX2Zyb21fbDNlKAotICAgIGwzX3BnZW50cnlfdCBsM2UsIHVuc2ln
bmVkIGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCBpbnQgcGFydGlhbCkK
KyAgICBsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3Ry
dWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGlu
dCByYzsKIApAQCAtMTI4Nyw3ICsxMzAxLDcgQEAgZ2V0X3BhZ2VfZnJvbV9s
M2UoCiAgICAgfQogCiAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9t
X3BhZ2VucigKLSAgICAgICAgbDNlX2dldF9wZm4obDNlKSwgUEdUX2wyX3Bh
Z2VfdGFibGUsIGQsIHBhcnRpYWwsIDEpOworICAgICAgICBsM2VfZ2V0X3Bm
bihsM2UpLCBQR1RfbDJfcGFnZV90YWJsZSwgZCwgZmxhZ3MgfCBQVEZfcHJl
ZW1wdGlibGUpOwogICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkg
JiYKICAgICAgICAgICFpc19wdl8zMmJpdF9kb21haW4oZCkgJiYKICAgICAg
ICAgIGdldF9sM19saW5lYXJfcGFnZXRhYmxlKGwzZSwgcGZuLCBkKSApCkBA
IC0xMjk5LDcgKzEzMTMsNyBAQCBnZXRfcGFnZV9mcm9tX2wzZSgKIGRlZmlu
ZV9nZXRfbGluZWFyX3BhZ2V0YWJsZShsNCk7CiBzdGF0aWMgaW50CiBnZXRf
cGFnZV9mcm9tX2w0ZSgKLSAgICBsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25l
ZCBsb25nIHBmbiwgc3RydWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisg
ICAgbDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVj
dCBkb21haW4gKmQsIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBpbnQg
cmM7CiAKQEAgLTEzMTMsNyArMTMyNyw3IEBAIGdldF9wYWdlX2Zyb21fbDRl
KAogICAgIH0KIAogICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9w
YWdlbnIoCi0gICAgICAgIGw0ZV9nZXRfcGZuKGw0ZSksIFBHVF9sM19wYWdl
X3RhYmxlLCBkLCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgbDRlX2dldF9wZm4o
bDRlKSwgUEdUX2wzX3BhZ2VfdGFibGUsIGQsIGZsYWdzIHwgUFRGX3ByZWVt
cHRpYmxlKTsKICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYm
IGdldF9sNF9saW5lYXJfcGFnZXRhYmxlKGw0ZSwgcGZuLCBkKSApCiAgICAg
ICAgIHJjID0gMDsKIApAQCAtMTQ0Myw3ICsxNDU3LDcgQEAgdm9pZCBwdXRf
cGFnZV9mcm9tX2wxZShsMV9wZ2VudHJ5X3QgbDFlLCBzdHJ1Y3QgZG9tYWlu
ICpsMWVfb3duZXIpCiAgKiBOb3RlIGFsc28gdGhhdCB0aGlzIGF1dG9tYXRp
Y2FsbHkgZGVhbHMgY29ycmVjdGx5IHdpdGggbGluZWFyIHAudC4ncy4KICAq
Lwogc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3Qg
bDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaW50IHBhcnRpYWwsIGJvb2wgZGVmZXIpCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAg
ICBpbnQgcmMgPSAwOwogCkBAIC0xNDU3LDEyICsxNDcxLDEzIEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBn
ID0gbDJlX2dldF9wYWdlKGwyZSk7CiAgICAgICAgIHN0cnVjdCBwYWdlX2lu
Zm8gKnB0cGcgPSBtZm5fdG9fcGFnZShwZm4pOwogCi0gICAgICAgIGlmICgg
dW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgaWYgKCAoZmxhZ3Mg
JiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYp
KSA9PQorICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAg
ICB7Ci0gICAgICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAgICAgICAg
IEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAgICAgICAgICBy
YyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKICAgICAgICAg
fQotICAgICAgICBlbHNlIGlmICggZGVmZXIgKQorICAgICAgICBlbHNlIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gcHRwZzsKICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGc7CkBA
IC0xNDc5LDcgKzE0OTQsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21f
bDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAogfQog
CiBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBs
M2UsIHVuc2lnbmVkIGxvbmcgcGZuLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbnQgcGFydGlhbCwgYm9vbF90IGRlZmVyKQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcGc7CiAgICAgaW50IHJjOwpAQCAtMTUw
MiwxMyArMTUxNywxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNl
KGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAg
cGcgPSBsM2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggdW5saWtlbHko
cGFydGlhbCA+IDApICkKKyAgICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CisgICAgICAg
ICBQVEZfcGFydGlhbF9zZXQgKQogICAgIHsKLSAgICAgICAgQVNTRVJUKCFk
ZWZlcik7CisgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7
CiAgICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZu
X3RvX3BhZ2UocGZuKSk7CiAgICAgfQogCi0gICAgaWYgKCBkZWZlciApCisg
ICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgewogICAgICAgICBj
dXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UocGZu
KTsKICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBw
ZzsKQEAgLTE1MjMsNyArMTUzOSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2Vf
ZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4s
CiB9CiAKIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRy
eV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBwYXJ0aWFsLCBib29sX3QgZGVmZXIpCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykK
IHsKICAgICBpbnQgcmMgPSAxOwogCkBAIC0xNTMyLDEzICsxNTQ4LDE0IEBA
IHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0
ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgewogICAgICAgICBzdHJ1Y3Qg
cGFnZV9pbmZvICpwZyA9IGw0ZV9nZXRfcGFnZShsNGUpOwogCi0gICAgICAg
IGlmICggdW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgaWYgKCAo
ZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYpKSA9PQorICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQog
ICAgICAgICB7Ci0gICAgICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAg
ICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAgICAg
ICAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90b19w
YWdlKHBmbikpOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKCBkZWZlciAp
CisgICAgICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7
CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
bWZuX3RvX3BhZ2UocGZuKTsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID0gcGc7CkBAIC0xNjQ4LDEyICsxNjY1LDEzIEBA
IHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgIHVuc2lnbmVkIGxvbmcg
IHBmbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgIGwyX3BnZW50cnlfdCAg
KnBsMmU7CiAgICAgdW5zaWduZWQgaW50ICAgaTsKLSAgICBpbnQgICAgICAg
ICAgICByYyA9IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKKyAg
ICBpbnQgICAgICAgICAgICByYyA9IDA7CisgICAgdW5zaWduZWQgaW50ICAg
cGFydGlhbF9mbGFncyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3M7CiAKICAgICBw
bDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAKICAgICBmb3Ig
KCBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMMl9QQUdFVEFC
TEVfRU5UUklFUzsKLSAgICAgICAgICBpKyssIHBhcnRpYWwgPSAwICkKKyAg
ICAgICAgICBpKyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAgICB7CiAgICAg
ICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzICYmIGh5cGVy
Y2FsbF9wcmVlbXB0X2NoZWNrKCkgKQogICAgICAgICB7CkBAIC0xNjYzLDE4
ICsxNjgxLDE5IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAg
ICB9CiAKICAgICAgICAgaWYgKCAhaXNfZ3Vlc3RfbDJfc2xvdChkLCB0eXBl
LCBpKSB8fAotICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDJl
KHBsMmVbaV0sIHBmbiwgZCwgcGFydGlhbCkpID4gMCApCisgICAgICAgICAg
ICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuLCBkLCBw
YXJ0aWFsX2ZsYWdzKSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVlOwog
CiAgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAgewog
ICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAg
ICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IDE7Cisg
ICAgICAgICAgICAvKiBTZXQgJ3NldCcsIHJldGFpbiAnZ2VuZXJhbCByZWYn
ICovCisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlh
bF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAgfQogICAgICAg
ICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgIHJjID0gLUVS
RVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA8IDAg
JiYgcmMgIT0gLUVJTlRSICkKQEAgLTE2ODMsNyArMTcwMiw3IEBAIHN0YXRp
YyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwg
dW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAgICAgICAgaWYgKCBpICkKICAg
ICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSAwOworICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3Mg
PSAwOwogICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0
X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKICAgICAgICAgICAgIH0KQEAgLTE3
MTMsNyArMTczMiw4IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB1bnNpZ25lZCBsb25nICBwZm4g
PSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsM19wZ2VudHJ5X3QgICpwbDNl
OwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAgICAg
cmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7CisgICAgaW50
ICAgICAgICAgICAgcmMgPSAwOworICAgIHVuc2lnbmVkIGludCAgIHBhcnRp
YWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCiAgICAgcGwzZSA9
IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCkBAIC0xNzI4LDcgKzE3
NDgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIG1lbXNldChwbDNlICsgNCwgMCwgKEwz
X1BBR0VUQUJMRV9FTlRSSUVTIC0gNCkgKiBzaXplb2YoKnBsM2UpKTsKIAog
ICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwz
X1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywgcGFydGlhbCA9
IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQogICAg
IHsKICAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
JiYgaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgIHsKQEAg
LTE3NDYsMjEgKzE3NjYsMjMgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJs
ZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICAgICAgICAgIHJj
ID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobDNlX2dldF9wZm4o
cGwzZVtpXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90YWJsZSB8CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQ
R1RfcGFlX3hlbl9sMiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGQsIHBhcnRpYWwsIDEpOworICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgfCBQVEZfcHJlZW1wdGlibGUpOwog
ICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCAhaXNfZ3Vlc3RfbDNfc2xv
dChpKSB8fAotICAgICAgICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJv
bV9sM2UocGwzZVtpXSwgcGZuLCBkLCBwYXJ0aWFsKSkgPiAwICkKKyAgICAg
ICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0s
IHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCiAgICAgICAgICAgICBj
b250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAg
ICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlh
bCA/OiAxOworICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2Vu
ZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KKyAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwg
UFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYg
KCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsKICAgICAgICAgICAg
IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIHBh
Z2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSAwOwogICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAg
ICAgICAgIH0KICAgICAgICAgaWYgKCByYyA8IDAgKQpAQCAtMTc3Nyw3ICsx
Nzk5LDcgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlKQogICAgICAgICBpZiAoIGkgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgIGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICB9
CkBAIC0xODQzLDE5ICsxODY1LDIxIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB1bnNpZ25lZCBs
b25nICBwZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsNF9wZ2VudHJ5
X3QgICpwbDRlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAgICAg
dW5zaWduZWQgaW50ICAgaTsKLSAgICBpbnQgICAgICAgICAgICByYyA9IDAs
IHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKKyAgICBpbnQgICAgICAg
ICAgICByYyA9IDA7CisgICAgdW5zaWduZWQgaW50ICAgcGFydGlhbF9mbGFn
cyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3M7CiAKICAgICBmb3IgKCBpID0gcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMNF9QQUdFVEFCTEVfRU5UUklF
UzsKLSAgICAgICAgICBpKyssIHBhcnRpYWwgPSAwICkKKyAgICAgICAgICBp
KyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAgICB7CiAgICAgICAgIGlmICgg
IWlzX2d1ZXN0X2w0X3Nsb3QoZCwgaSkgfHwKLSAgICAgICAgICAgICAocmMg
PSBnZXRfcGFnZV9mcm9tX2w0ZShwbDRlW2ldLCBwZm4sIGQsIHBhcnRpYWwp
KSA+IDAgKQorICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDRl
KHBsNGVbaV0sIHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCiAgICAg
ICAgICAgICBjb250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVT
VEFSVCApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRl
ID0gcGFydGlhbCA/OiAxOworICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBs
ZWF2ZSAnZ2VuZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQg
Ki8KKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFs
X2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAgICAg
IGVsc2UgaWYgKCByYyA8IDAgKQogICAgICAgICB7CkBAIC0xODY0LDcgKzE4
ODgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7
CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAg
ICAgICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAg
ICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBl
bHNlCkBAIC0xOTE4LDE5ICsxOTQyLDIwIEBAIHN0YXRpYyBpbnQgZnJlZV9s
Ml90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHN0cnVjdCBk
b21haW4gKmQgPSBwYWdlX2dldF9vd25lcihwYWdlKTsKICAgICB1bnNpZ25l
ZCBsb25nIHBmbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgIGwyX3BnZW50
cnlfdCAqcGwyZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+
cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50IGkgPSBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFsOworICAgIGludCByYyA9IDA7Cisg
ICAgdW5zaWduZWQgaW50IHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFs
X2ZsYWdzLAorICAgICAgICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
LSAhKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpOwogCiAgICAg
cGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCiAgICAgZm9y
ICggOyA7ICkKICAgICB7CiAgICAgICAgIGlmICggaXNfZ3Vlc3RfbDJfc2xv
dChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkgKQotICAgICAgICAg
ICAgcmMgPSBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIHBhcnRp
YWwsIGZhbHNlKTsKKyAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9s
MmUocGwyZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAgaWYg
KCByYyA8IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgcGFy
dGlhbCA9IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogCiAgICAg
ICAgIGlmICggIWktLSApCiAgICAgICAgICAgICBicmVhazsKQEAgLTE5NTIs
MTIgKzE5NzcsMTQgQEAgc3RhdGljIGludCBmcmVlX2wyX3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgZWxzZSBpZiAoIHJjID09IC1FUkVT
VEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
cyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/
OiAtMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFs
X2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/CisgICAgICAgICAgICBwYXJ0
aWFsX2ZsYWdzIDoKKyAgICAgICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CiAgICAgfQogICAgIGVsc2UgaWYg
KCByYyA9PSAtRUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTIC0g
MSApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGkgKyAxOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICByYyA9IC1F
UkVTVEFSVDsKICAgICB9CiAKQEAgLTE5NjksOCArMTk5Niw5IEBAIHN0YXRp
YyBpbnQgZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQog
ICAgIHN0cnVjdCBkb21haW4gKmQgPSBwYWdlX2dldF9vd25lcihwYWdlKTsK
ICAgICB1bnNpZ25lZCBsb25nIHBmbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwog
ICAgIGwzX3BnZW50cnlfdCAqcGwzZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0
aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50ICBp
ID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhcGFydGlhbDsKKyAgICBp
bnQgcmMgPSAwOworICAgIHVuc2lnbmVkIGludCBwYXJ0aWFsX2ZsYWdzID0g
cGFnZS0+cGFydGlhbF9mbGFncywKKyAgICAgICAgaSA9IHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzIC0gIShwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxf
c2V0KTsKIAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4p
KTsKIApAQCAtMTk3OCwxMSArMjAwNiwxMSBAQCBzdGF0aWMgaW50IGZyZWVf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB7CiAgICAg
ICAgIGlmICggaXNfZ3Vlc3RfbDNfc2xvdChpKSApCiAgICAgICAgIHsKLSAg
ICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9sM2UocGwzZVtpXSwgcGZu
LCBwYXJ0aWFsLCAwKTsKKyAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJv
bV9sM2UocGwzZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAg
ICAgIGlmICggcmMgPCAwICkKICAgICAgICAgICAgICAgICBicmVhazsKIAot
ICAgICAgICAgICAgcGFydGlhbCA9IDA7CisgICAgICAgICAgICBwYXJ0aWFs
X2ZsYWdzID0gMDsKICAgICAgICAgICAgIGlmICggcmMgPT0gMCApCiAgICAg
ICAgICAgICAgICAgdW5hZGp1c3RfZ3Vlc3RfbDNlKHBsM2VbaV0sIGQpOwog
ICAgICAgICB9CkBAIC0yMDAyLDEyICsyMDMwLDE0IEBAIHN0YXRpYyBpbnQg
ZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIGlm
ICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSBwYXJ0aWFsID86IC0xOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2Zs
YWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpID8KKyAg
ICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgorICAgICAgICAgICAgKFBURl9w
YXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsKICAgICB9
CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDNfUEFHRVRB
QkxFX0VOVFJJRVMgLSAxICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzID0gaSArIDE7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxf
cHRlID0gMDsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAg
ICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgIH0KICAgICByZXR1cm4gcmMg
PiAwID8gMCA6IHJjOwpAQCAtMjAxOCwyNiArMjA0OCwyOSBAQCBzdGF0aWMg
aW50IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAg
ICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7CiAg
ICAgdW5zaWduZWQgbG9uZyBwZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAg
ICBsNF9wZ2VudHJ5X3QgKnBsNGUgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihw
Zm4pKTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlh
bF9wdGU7Ci0gICAgdW5zaWduZWQgaW50ICBpID0gcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgLSAhcGFydGlhbDsKKyAgICBpbnQgcmMgPSAwOworICAgIHVu
c2lnbmVkIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzLAor
ICAgICAgICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhKHBhcnRp
YWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpOwogCiAgICAgZG8gewogICAg
ICAgICBpZiAoIGlzX2d1ZXN0X2w0X3Nsb3QoZCwgaSkgKQotICAgICAgICAg
ICAgcmMgPSBwdXRfcGFnZV9mcm9tX2w0ZShwbDRlW2ldLCBwZm4sIHBhcnRp
YWwsIDApOworICAgICAgICAgICAgcmMgPSBwdXRfcGFnZV9mcm9tX2w0ZShw
bDRlW2ldLCBwZm4sIHBhcnRpYWxfZmxhZ3MpOwogICAgICAgICBpZiAoIHJj
IDwgMCApCiAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgcGFydGlhbCA9
IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogICAgIH0gd2hpbGUg
KCBpLS0gKTsKIAogICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7
CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IC0xOworICAgICAg
ICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZf
cGFydGlhbF9zZXQpID8KKyAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgor
ICAgICAgICAgICAgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmKTsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5U
UiAmJiBpIDwgTDRfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CiAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaSArIDE7Ci0gICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFnZS0+cGFy
dGlhbF9mbGFncyA9IDA7CiAgICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAg
IH0KIApAQCAtMjMxNSw3ICsyMzQ4LDcgQEAgc3RhdGljIGludCBtb2RfbDJf
ZW50cnkobDJfcGdlbnRyeV90ICpwbDJlLAogICAgICAgICByZXR1cm4gLUVC
VVNZOwogICAgIH0KIAotICAgIHB1dF9wYWdlX2Zyb21fbDJlKG9sMmUsIHBm
biwgMCwgdHJ1ZSk7CisgICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgcGZu
LCBQVEZfZGVmZXIpOwogCiAgICAgcmV0dXJuIHJjOwogfQpAQCAtMjM4OSw3
ICsyNDIyLDcgQEAgc3RhdGljIGludCBtb2RfbDNfZW50cnkobDNfcGdlbnRy
eV90ICpwbDNlLAogICAgICAgICBpZiAoICFjcmVhdGVfcGFlX3hlbl9tYXBw
aW5ncyhkLCBwbDNlKSApCiAgICAgICAgICAgICBCVUcoKTsKIAotICAgIHB1
dF9wYWdlX2Zyb21fbDNlKG9sM2UsIHBmbiwgMCwgMSk7CisgICAgcHV0X3Bh
Z2VfZnJvbV9sM2Uob2wzZSwgcGZuLCBQVEZfZGVmZXIpOwogICAgIHJldHVy
biByYzsKIH0KIApAQCAtMjQ1MSw3ICsyNDg0LDcgQEAgc3RhdGljIGludCBt
b2RfbDRfZW50cnkobDRfcGdlbnRyeV90ICpwbDRlLAogICAgICAgICByZXR1
cm4gLUVGQVVMVDsKICAgICB9CiAKLSAgICBwdXRfcGFnZV9mcm9tX2w0ZShv
bDRlLCBwZm4sIDAsIDEpOworICAgIHB1dF9wYWdlX2Zyb21fbDRlKG9sNGUs
IHBmbiwgUFRGX2RlZmVyKTsKICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTI3
MTUsNyArMjc0OCw3IEBAIGludCBmcmVlX3BhZ2VfdHlwZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgaWYgKCAh
KHR5cGUgJiBQR1RfcGFydGlhbCkgKQogICAgIHsKICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMgPSAxVSA8PCBQQUdFVEFCTEVfT1JERVI7Ci0g
ICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IDA7CiAgICAgfQogCiAgICAgc3dpdGNoICggdHlw
ZSAmIFBHVF90eXBlX21hc2sgKQpAQCAtMzAwMyw3ICszMDM2LDcgQEAgc3Rh
dGljIGludCBfX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogICAgICAgICBpZiAoICEoeCAmIFBH
VF9wYXJ0aWFsKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gMDsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfcHRlID0gMDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3Mg
PSAwOwogICAgICAgICB9CiAgICAgICAgIHBhZ2UtPmxpbmVhcl9wdF9jb3Vu
dCA9IDA7CiAgICAgICAgIHJjID0gYWxsb2NfcGFnZV90eXBlKHBhZ2UsIHR5
cGUsIHByZWVtcHRpYmxlKTsKQEAgLTMzNjksNyArMzQwMiw4IEBAIGludCBu
ZXdfZ3Vlc3RfY3IzKHVuc2lnbmVkIGxvbmcgbWZuKQogCiAgICAgcmMgPSBw
YWdpbmdfbW9kZV9yZWZjb3VudHMoZCkKICAgICAgICAgID8gKGdldF9wYWdl
X2Zyb21fcGFnZW5yKG1mbiwgZCkgPyAwIDogLUVJTlZBTCkKLSAgICAgICAg
IDogZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobWZuLCBQR1Rfcm9v
dF9wYWdlX3RhYmxlLCBkLCAwLCAxKTsKKyAgICAgICAgIDogZ2V0X3BhZ2Vf
YW5kX3R5cGVfZnJvbV9wYWdlbnIobWZuLCBQR1Rfcm9vdF9wYWdlX3RhYmxl
LCBkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBQVEZfcHJlZW1wdGlibGUpOwogICAgIHN3aXRjaCAoIHJjICkKICAgICB7
CiAgICAgY2FzZSAwOgpAQCAtMzc1Nyw3ICszNzkxLDcgQEAgbG9uZyBkb19t
bXVleHRfb3AoCiAgICAgICAgICAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2Vf
ZnJvbV9wYWdlbnIob3AuYXJnMS5tZm4sIGQpID8gMCA6IC1FSU5WQUw7CiAg
ICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICByYyA9
IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fcGFnZW5yKAotICAgICAgICAgICAg
ICAgICAgICAgICAgb3AuYXJnMS5tZm4sIFBHVF9yb290X3BhZ2VfdGFibGUs
IGQsIDAsIDEpOworICAgICAgICAgICAgICAgICAgICAgICAgb3AuYXJnMS5t
Zm4sIFBHVF9yb290X3BhZ2VfdGFibGUsIGQsIFBURl9wcmVlbXB0aWJsZSk7
CiAKICAgICAgICAgICAgICAgICBpZiAoIHVubGlrZWx5KHJjKSApCiAgICAg
ICAgICAgICAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCmluZGV4IDk1NWUx
ZmE4NmEuLjhlM2NlZjk1NGMgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2Fz
bS14ODYvbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKQEAg
LTE0MSwxOSArMTQxLDM0IEBAIHN0cnVjdCBwYWdlX2luZm8KICAgICAgICAg
ICogc2V0dGluZyB0aGUgZmxhZyBtdXN0IG5vdCBkcm9wIHRoYXQgcmVmZXJl
bmNlLCB3aGVyZWFzIHRoZSBpbnN0YW5jZQogICAgICAgICAgKiBjbGVhcmlu
ZyBpdCB3aWxsIGhhdmUgdG8uCiAgICAgICAgICAqCi0gICAgICAgICAqIElm
IEBwYXJ0aWFsX3B0ZSBpcyBwb3NpdGl2ZSB0aGVuIFBURSBhdCBAbnJfdmFs
aWRhdGVkX3B0ZXMrMSBoYXMKLSAgICAgICAgICogYmVlbiBwYXJ0aWFsbHkg
dmFsaWRhdGVkLiBUaGlzIGltcGxpZXMgdGhhdCB0aGUgZ2VuZXJhbCByZWZl
cmVuY2UKLSAgICAgICAgICogdG8gdGhlIHBhZ2UgKGFjcXVpcmVkIGZyb20g
Z2V0X3BhZ2VfZnJvbV9sTmUoKSkgd291bGQgYmUgZHJvcHBlZAotICAgICAg
ICAgKiAoYWdhaW4gZHVlIHRvIHRoZSBhcHBhcmVudCBmYWlsdXJlKSBhbmQg
aGVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZAotICAgICAgICAgKiB3aGVuIHJl
c3VtaW5nIHRoZSB2YWxpZGF0aW9uLCBidXQgbXVzdCBub3QgYmUgZHJvcHBl
ZCB3aGVuIHBpY2tpbmcKLSAgICAgICAgICogdXAgdGhlIHBhZ2UgZm9yIGlu
dmFsaWRhdGlvbi4KKyAgICAgICAgICogSWYgcGFydGlhbF9mbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCBpcyBzZXQsIHRoZW4gdGhlIHBhZ2UgYXQKKyAgICAg
ICAgICogYXQgQG5yX3ZhbGlkYXRlZF9wdGVzIGhhZCBQR1RfcGFydGlhbCBz
ZXQgYXMgYSByZXN1bHQgb2YgYW4KKyAgICAgICAgICogb3BlcmF0aW9uIG9u
IHRoZSBjdXJyZW50IHBhZ2UuICAoVGhhdCBwYWdlIG1heSBvciBtYXkgbm90
CisgICAgICAgICAqIHN0aWxsIGhhdmUgUEdUX3BhcnRpYWwgc2V0LikKICAg
ICAgICAgICoKLSAgICAgICAgICogSWYgQHBhcnRpYWxfcHRlIGlzIG5lZ2F0
aXZlIHRoZW4gUFRFIGF0IEBucl92YWxpZGF0ZWRfcHRlcysxIGhhcwotICAg
ICAgICAgKiBiZWVuIHBhcnRpYWxseSBpbnZhbGlkYXRlZC4gVGhpcyBpcyBi
YXNpY2FsbHkgdGhlIG9wcG9zaXRlIGNhc2Ugb2YKLSAgICAgICAgICogYWJv
dmUsIGkuZS4gdGhlIGdlbmVyYWwgcmVmZXJlbmNlIHRvIHRoZSBwYWdlIHdh
cyBub3QgZHJvcHBlZCBpbgotICAgICAgICAgKiBwdXRfcGFnZV9mcm9tX2xO
ZSgpIChkdWUgdG8gdGhlIGFwcGFyZW50IGZhaWx1cmUpLCBhbmQgaGVuY2Ug
aXQKLSAgICAgICAgICogbXVzdCBiZSBkcm9wcGVkIHdoZW4gdGhlIHB1dCBv
cGVyYXRpb24gaXMgcmVzdW1lZCAoYW5kIGNvbXBsZXRlcyksCi0gICAgICAg
ICAqIGJ1dCBpdCBtdXN0IG5vdCBiZSBhY3F1aXJlZCBpZiBwaWNraW5nIHVw
IHRoZSBwYWdlIGZvciB2YWxpZGF0aW9uLgorICAgICAgICAgKiBJZiBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZiBpcyBzZXQsIHRoZW4gdGhlIFBURSBhdAor
ICAgICAgICAgKiBAbnJfdmFsaWRhdGVkX3B0ZWYgaG9sZHMgYSBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBmb3IgdGhlCisgICAgICAgICAqIHBhZ2UuCisg
ICAgICAgICAqCisgICAgICAgICAqIFRoaXMgaGFwcGVuczoKKyAgICAgICAg
ICogLSBEdXJpbmcgZGUtdmFsaWRhdGlvbiwgaWYgZGUtdmFsaWRhdGlvbiBv
ZiB0aGUgcGFnZSB3YXMKKyAgICAgICAgICogICBpbnRlcnJ1cHRlZAorICAg
ICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBhbiBpbnZhbGlkIGVu
dHJ5IGlzIGVuY291bnRlcmVkIGFuZAorICAgICAgICAgKiAgIHZhbGlkYXRp
b24gaXMgcHJlZW1wdGlibGUKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRh
dGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgd2FzIHNldCBvbgor
ICAgICAgICAgKiAgIHRoaXMgZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFw
cyBiZWNhdXNlIHdlJ3JlIHBpY2tpbmcKKyAgICAgICAgICogICB1cCBmcm9t
IGEgcGFydGlhbCBkZS12YWxpZGF0aW9uKS4KKyAgICAgICAgICoKKyAgICAg
ICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBpcyBjbGVhciwKKyAgICAgICAgICogdGhlbiBhIGdl
bmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQ7IGlmIGl0IGlz
IHNldCwgbm8KKyAgICAgICAgICogcmVmZXJlbmNlIHNob3VsZCBiZSBhY3F1
aXJlZC4KKyAgICAgICAgICoKKyAgICAgICAgICogV2hlbiByZXN1bWluZyBk
ZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcwor
ICAgICAgICAgKiBjbGVhciwgbm8gcmVmZXJlbmNlIHNob3VsZCBiZSBkcm9w
cGVkOyBpZiBpdCBpcyBzZXQsIGEKKyAgICAgICAgICogcmVmZXJlbmNlIHNo
b3VsZCBiZSBkcm9wcGVkLgorICAgICAgICAgKgorICAgICAgICAgKiBOQiB0
aGF0IFBURl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9y
ZWYgYXJlCisgICAgICAgICAqIGRlZmluZWQgaW4gbW0uYywgdGhlIG9ubHkg
cGxhY2Ugd2hlcmUgdGhleSBhcmUgdXNlZC4KICAgICAgICAgICoKICAgICAg
ICAgICogVGhlIDNyZCBmaWVsZCwgQGxpbmVhcl9wdF9jb3VudCwgaW5kaWNh
dGVzCiAgICAgICAgICAqIC0gYnkgYSBwb3NpdGl2ZSB2YWx1ZSwgaG93IG1h
bnkgc2FtZS1sZXZlbCBwYWdlIHRhYmxlIGVudHJpZXMgYSBwYWdlCkBAIC0x
NjQsNyArMTc5LDcgQEAgc3RydWN0IHBhZ2VfaW5mbwogICAgICAgICBzdHJ1
Y3QgewogICAgICAgICAgICAgdTE2IG5yX3ZhbGlkYXRlZF9wdGVzOlBBR0VU
QUJMRV9PUkRFUiArIDE7CiAgICAgICAgICAgICB1MTYgOjE2IC0gUEFHRVRB
QkxFX09SREVSIC0gMSAtIDI7Ci0gICAgICAgICAgICBzMTYgcGFydGlhbF9w
dGU6MjsKKyAgICAgICAgICAgIHUxNiBwYXJ0aWFsX2ZsYWdzOjI7CiAgICAg
ICAgICAgICBzMTYgbGluZWFyX3B0X2NvdW50OwogICAgICAgICB9OwogCi0t
IAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0005-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0005-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Transfer-Encoding: base64

RnJvbSAxMzY2MGQ3MThlYzNhMTE5ZmYwYWIxZjExOTdkMDc5NmNhNzljNjY4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA1LzEyXSB4
ODYvbW06IFVzZSBmbGFncyBmb3IgX3B1dF9wYWdlX3R5cGUgcmF0aGVyIHRo
YW4gYQogYm9vbGVhbgoKVGhpcyBpcyBpbiBtYWlubHkgaW4gcHJlcGFyYXRp
b24gZm9yIF9wdXRfcGFnZV90eXBlIHRha2luZyB0aGUKcGFydGlhbF9mbGFn
cyB2YWx1ZSBpbiB0aGUgZnV0dXJlLiAgSXQgYWxzbyBtYWtlcyBpdCBlYXNp
ZXIgdG8gcmVhZCBpbgp0aGUgY2FsbGVyIChzaW5jZSB5b3Ugc2VlIGEgZmxh
ZyBuYW1lIHJhdGhlciB0aGFuIGB0cnVlYCBvciBgZmFsc2VgKS4KCk5vIGZ1
bmN0aW9uYWwgY2hhbmdlIGludGVuZGVkLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0yOTkuCgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2
L21tLmMgfCAyNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tCiAxIGZpbGUg
Y2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA2ODBiNWIzZGU3Li4xNTc2YTA4M2RmIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTM5Miw3ICsxMzkyLDcgQEAgZ2V0X3BhZ2VfZnJvbV9sNGUoCiAgICAg
ICAgICAgICBsM2VfcmVtb3ZlX2ZsYWdzKChwbDNlKSwgX1BBR0VfVVNFUnxf
UEFHRV9SV3xfUEFHRV9BQ0NFU1NFRCk7ICAgXAogICAgIH0gd2hpbGUgKCAw
ICkKIAotc3RhdGljIGludCBfcHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlLCBib29sIHByZWVtcHRpYmxlLAorc3RhdGljIGludCBfcHV0
X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBp
bnQgZmxhZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBw
YWdlX2luZm8gKnB0cGcpOwogCiB2b2lkIHB1dF9wYWdlX2Zyb21fbDFlKGwx
X3BnZW50cnlfdCBsMWUsIHN0cnVjdCBkb21haW4gKmwxZV9vd25lcikKQEAg
LTE0NzUsNyArMTQ3NSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9s
MmUobDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAg
ICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgICAgIHsKICAgICAg
ICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7Ci0gICAgICAg
ICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKKyAg
ICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0
aWJsZSwgcHRwZyk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKICAgICAgICAgewpAQCAtMTQ4NCw3ICsxNDg0
LDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5
X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgfQogICAgICAg
ICBlbHNlCiAgICAgICAgIHsKLSAgICAgICAgICAgIHJjID0gX3B1dF9wYWdl
X3R5cGUocGcsIHRydWUsIHB0cGcpOworICAgICAgICAgICAgcmMgPSBfcHV0
X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBwdHBnKTsKICAgICAg
ICAgICAgIGlmICggbGlrZWx5KCFyYykgKQogICAgICAgICAgICAgICAgIHB1
dF9wYWdlKHBnKTsKICAgICAgICAgfQpAQCAtMTUyMSw3ICsxNTIxLDcgQEAg
c3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3QgbDNl
LCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgIFBURl9wYXJ0aWFsX3Nl
dCApCiAgICAgewogICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZl
cikpOwotICAgICAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUs
IG1mbl90b19wYWdlKHBmbikpOworICAgICAgICByZXR1cm4gX3B1dF9wYWdl
X3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UocGZuKSk7
CiAgICAgfQogCiAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCkBAIC0x
NTMxLDcgKzE1MzEsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNl
KGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICByZXR1cm4gMDsKICAgICB9CiAKLSAgICByYyA9IF9wdXRfcGFnZV90eXBl
KHBnLCB0cnVlLCBtZm5fdG9fcGFnZShwZm4pKTsKKyAgICByYyA9IF9wdXRf
cGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKHBm
bikpOwogICAgIGlmICggbGlrZWx5KCFyYykgKQogICAgICAgICBwdXRfcGFn
ZShwZyk7CiAKQEAgLTE1NTIsNyArMTU1Miw3IEBAIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCiAgICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAg
ICAgIHsKICAgICAgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVy
KSk7Ci0gICAgICAgICAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRy
dWUsIG1mbl90b19wYWdlKHBmbikpOworICAgICAgICAgICAgcmV0dXJuIF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdl
KHBmbikpOwogICAgICAgICB9CiAKICAgICAgICAgaWYgKCBmbGFncyAmIFBU
Rl9kZWZlciApCkBAIC0xNTYyLDcgKzE1NjIsNyBAQCBzdGF0aWMgaW50IHB1
dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxv
bmcgcGZuLAogICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgIH0KIAot
ICAgICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBtZm5fdG9f
cGFnZShwZm4pKTsKKyAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywg
UFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKICAgICAgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAgICAgICBwdXRfcGFnZShwZyk7
CiAgICAgfQpAQCAtMjgyNSwxMSArMjgyNSwxMiBAQCBzdGF0aWMgaW50IF9w
dXRfZmluYWxfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVu
c2lnbmVkIGxvbmcgdHlwZSwKIH0KIAogCi1zdGF0aWMgaW50IF9wdXRfcGFn
ZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIGJvb2wgcHJlZW1wdGli
bGUsCitzdGF0aWMgaW50IF9wdXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UsIHVuc2lnbmVkIGludCBmbGFncywKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZykKIHsKICAgICB1
bnNpZ25lZCBsb25nIG54LCB4LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2lu
Zm87CiAgICAgaW50IHJjID0gMDsKKyAgICBib29sIHByZWVtcHRpYmxlID0g
ZmxhZ3MgJiBQVEZfcHJlZW1wdGlibGU7CiAKICAgICBmb3IgKCA7IDsgKQog
ICAgIHsKQEAgLTMwMjQsNyArMzAyNSw3IEBAIHN0YXRpYyBpbnQgX19nZXRf
cGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxv
bmcgdHlwZSwKIAogICAgICAgICAgICAgaWYgKCB1bmxpa2VseShpb21tdV9y
ZXQpICkKICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICBfcHV0X3Bh
Z2VfdHlwZShwYWdlLCBmYWxzZSwgTlVMTCk7CisgICAgICAgICAgICAgICAg
X3B1dF9wYWdlX3R5cGUocGFnZSwgMCwgTlVMTCk7CiAgICAgICAgICAgICAg
ICAgcmMgPSBpb21tdV9yZXQ7CiAgICAgICAgICAgICAgICAgZ290byBvdXQ7
CiAgICAgICAgICAgICB9CkBAIC0zMDUxLDcgKzMwNTIsNyBAQCBzdGF0aWMg
aW50IF9fZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1
bnNpZ25lZCBsb25nIHR5cGUsCiAKIHZvaWQgcHV0X3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogewotICAgIGludCByYyA9IF9wdXRfcGFn
ZV90eXBlKHBhZ2UsIGZhbHNlLCBOVUxMKTsKKyAgICBpbnQgcmMgPSBfcHV0
X3BhZ2VfdHlwZShwYWdlLCAwLCBOVUxMKTsKICAgICBBU1NFUlQocmMgPT0g
MCk7CiAgICAgKHZvaWQpcmM7CiB9CkBAIC0zMDY3LDcgKzMwNjgsNyBAQCBp
bnQgZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUpCiAKIGludCBwdXRfcGFnZV90eXBlX3ByZWVtcHRp
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7Ci0gICAgcmV0dXJuIF9w
dXRfcGFnZV90eXBlKHBhZ2UsIHRydWUsIE5VTEwpOworICAgIHJldHVybiBf
cHV0X3BhZ2VfdHlwZShwYWdlLCBQVEZfcHJlZW1wdGlibGUsIE5VTEwpOwog
fQogCiBpbnQgZ2V0X3BhZ2VfdHlwZV9wcmVlbXB0aWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCkBAIC0zMjczLDcg
KzMyNzQsNyBAQCBpbnQgcHV0X29sZF9ndWVzdF90YWJsZShzdHJ1Y3QgdmNw
dSAqdikKICAgICBpZiAoICF2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCiAg
ICAgICAgIHJldHVybiAwOwogCi0gICAgc3dpdGNoICggcmMgPSBfcHV0X3Bh
Z2VfdHlwZSh2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSwgdHJ1ZSwKKyAgICBz
d2l0Y2ggKCByYyA9IF9wdXRfcGFnZV90eXBlKHYtPmFyY2gub2xkX2d1ZXN0
X3RhYmxlLCBQVEZfcHJlZW1wdGlibGUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF9wdHBnKSApCiAgICAg
ewogICAgIGNhc2UgLUVJTlRSOgotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0006-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0006-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Transfer-Encoding: base64

RnJvbSBhYWZjOWNkODQ3ODk2NzQ4MTYwYzU4MjBhNWI5Yzk0NDA0YTM1MGY0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA2LzEyXSB4
ODYvbW06IFJld29yayBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbiBjb25k
aXRpb25hbAoKTWFrZSBpdCBlYXNpZXIgdG8gcmVhZCBieSBkZWNsYXJpbmcg
dGhlIGNvbmRpdGlvbnMgaW4gd2hpY2ggd2Ugd2lsbApyZXRhaW4gdGhlIHJl
ZiwgcmF0aGVyIHRoYW4gdGhlIGNvbmRpdGlvbnMgdW5kZXIgd2hpY2ggd2Ug
cmVsZWFzZSBpdC4KClRoZSBvbmx5IHdheSAocGFnZSA9PSBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZSkgY2FuIGJlIHRydWUgaXMgaWYKcHJlZW1w
dGlibGUgaXMgdHJ1ZTsgc28gcmVtb3ZlIHRoaXMgZnJvbSB0aGUgcXVlcnkg
aXRzZWxmLCBhbmQgYWRkIGFuCkFTU0VSVCgpIHRvIHRoYXQgZWZmZWN0IG9u
IHRoZSBvcHBvc2l0ZSBwYXRoLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50
ZW5kZWQuCgpOQiB0aGF0IGFsbG9jX2xOX3RhYmxlKCkgbWlzaGFuZGxlIHRo
ZSAibGluZWFyIHB0IGZhaWx1cmUiIHNpdHVhdGlvbgpkZXNjcmliZWQgaW4g
dGhlIGNvbW1lbnQ7IHRoaXMgd2lsbCBiZSBhZGRyZXNzZWQgaW4gYSBmdXR1
cmUgcGF0Y2guCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDM5ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNo
YW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCAxNTc2YTA4M2RmLi4xNmFlZjJmNjUyIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
Nzg0LDggKzc4NCw0MyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBl
X2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9uciwKIAogICAgIHJj
ID0gX19nZXRfcGFnZV90eXBlKHBhZ2UsIHR5cGUsIHByZWVtcHRpYmxlKTsK
IAotICAgIGlmICggdW5saWtlbHkocmMpICYmICFwYXJ0aWFsX3JlZiAmJgot
ICAgICAgICAgKCFwcmVlbXB0aWJsZSB8fCBwYWdlICE9IGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlKSApCisgICAgLyoKKyAgICAgKiBSZXRhaW4g
dGhlIHJlZmNvdW50IGlmOgorICAgICAqIC0gcGFnZSBpcyBmdWxseSB2YWxp
ZGF0ZWQgKHJjID09IDApCisgICAgICogLSBwYWdlIGlzIG5vdCB2YWxpZGF0
ZWQgKHJjIDwgMCkgYnV0OgorICAgICAqICAgLSBXZSBjYW1lIGluIHdpdGgg
YSByZWZlcmVuY2UgKHBhcnRpYWxfcmVmKQorICAgICAqICAgLSBwYWdlIGlz
IHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0IHRoZXJlJ3MgYmVlbiBhbiBlcnJv
cgorICAgICAqICAgICAocGFnZSA9PSBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSkKKyAgICAgKgorICAgICAqIFRoZSBwYXJ0aWFsX3JlZi1vbi1l
cnJvciBjbGF1c2UgaXMgd29ydGggYW4gZXhwbGFuYXRpb24uICBUaGVyZQor
ICAgICAqIGFyZSB0d28gc2NlbmFyaW9zIHdoZXJlIHBhcnRpYWxfcmVmIG1p
Z2h0IGJlIHRydWUgY29taW5nIGluOgorICAgICAqIC0gbWZuIGhhcyBiZWVu
IHBhcnRpYWxseSBkZW1vdGVkIGFzIHR5cGUgYHR5cGVgOyBpLmUuIGhhcwor
ICAgICAqICAgUEdUX3BhcnRpYWwgc2V0CisgICAgICogLSBtZm4gaGFzIGJl
ZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxp
bmVhcgorICAgICAqICAgcGFnZTsgZS5nLiB3ZSdyZSBiZWluZyBjYWxsZWQg
ZnJvbSBnZXRfcGFnZV9mcm9tX2wyZSB3aXRoCisgICAgICogICB0eXBlID09
IFBHVF9sMV90YWJsZSwgYnV0IHRoZSBtZm4gaXMgUEdUX2wyX3RhYmxlKQor
ICAgICAqCisgICAgICogSWYgdGhlcmUncyBhbiBlcnJvciwgaW4gdGhlIGZp
cnN0IGNhc2UsIF9nZXRfcGFnZV90eXBlIHdpbGwKKyAgICAgKiBlaXRoZXIg
cmV0dXJuIC1FUkVTVEFSVCwgaW4gd2hpY2ggY2FzZSB3ZSB3YW50IHRvIHJl
dGFpbiB0aGUKKyAgICAgKiByZWYgKGFzIHRoZSBjYWxsZXIgd2lsbCBjb25z
aWRlciBpdCByZXRhaW5lZCksIG9yIC1FSU5WQUwsIGluCisgICAgICogd2hp
Y2ggY2FzZSBvbGRfZ3Vlc3RfdGFibGUgd2lsbCBiZSBzZXQ7IGluIGJvdGgg
Y2FzZXMsIHdlIG5lZWQKKyAgICAgKiB0byByZXRhaW4gdGhlIHJlZi4KKyAg
ICAgKgorICAgICAqIEluIHRoZSBzZWNvbmQgY2FzZSwgaWYgdGhlcmUncyBh
biBlcnJvciwgX2dldF9wYWdlX3R5cGUoKSBjYW4KKyAgICAgKiAqb25seSog
cmV0dXJuIC1FSU5WQUwsIGFuZCAqbmV2ZXIqIHNldCBvbGRfZ3Vlc3RfdGFi
bGUuICBJbgorICAgICAqIHRoYXQgY2FzZSB3ZSBhbHNvIHdhbnQgdG8gcmV0
YWluIHRoZSByZWZlcmVuY2UsIHRvIGFsbG93IHRoZQorICAgICAqIHBhZ2Ug
dG8gY29udGludWUgdG8gYmUgdG9ybiBkb3duIChpLmUuLCBQR1RfcGFydGlh
bCBjbGVhcmVkKQorICAgICAqIHNhZmVseS4KKyAgICAgKgorICAgICAqIEFs
c28gbm90ZSB0aGF0IHdlIHNob3VsZG4ndCBiZSBhYmxlIHRvIGxlYXZlIHdp
dGggdGhlIHJlZmVyZW5jZQorICAgICAqIGNvdW50IHJldGFpbmVkIHVubGVz
cyB3ZSBzdWNjZWVkZWQsIG9yIHRoZSBvcGVyYXRpb24gd2FzCisgICAgICog
cHJlZW1wdGlibGUuCisgICAgICovCisgICAgaWYgKCBsaWtlbHkoIXJjKSB8
fCBwYXJ0aWFsX3JlZiApCisgICAgICAgIC8qIG5vdGhpbmcgKi87CisgICAg
ZWxzZSBpZiAoIHBhZ2UgPT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgKQorICAgICAgICBBU1NFUlQocHJlZW1wdGlibGUpOworICAgIGVsc2UK
ICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CiAKICAgICByZXR1cm4gcmM7Ci0t
IAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0007-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0007-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Transfer-Encoding: base64

RnJvbSA2MmU5YjljNjhlYmE2MWI3YmVkY2I1ZWY4MWJlOTQwMzA4ZDQxMjdk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA3LzEyXSB4
ODYvbW06IEhhdmUgYWxsb2NfbFsyM11fdGFibGUgY2xlYXIgcGFydGlhbF9m
bGFncyB3aGVuCiBwcmVlbXB0aW5nCgpJbiBvcmRlciB0byBhbGxvdyByZWN1
cnNpdmUgcGFnZXRhYmxlIHByb21vdGlvbnMgYW5kIGRlbW90aW9ucyB0byBi
ZQppbnRlcnJ1cHRlZCwgWGVuIG11c3Qga2VlcCB0cmFjayBvZiB0aGUgc3Rh
dGUgb2YgdGhlIHN1Yi1wYWdlcwpwcm9tb3RlZCBvciBkZW1vdGVkLiAgVGhp
cyBpcyBzdG9yZWQgaW4gdHdvIGVsZW1lbnRzIGluIHRoZSBwYWdlCnN0cnVj
dDogbnJfZW50cmllc192YWxpZGF0ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpU
aGUgcnVsZSBpcyB0aGF0IGVudHJpZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRh
dGVkKSBzaG91bGQgYWx3YXlzIGJlCnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdl
bmVyYWwgcmVmZXJlbmNlIGNvdW50LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6
ZXJvLCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlk
YXRlZCBhbmQgbm8gcmVmZXJlbmNlCmNvdW50IGlzIGhlbGQuICBJZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRl
ZF0KaXMgcGFydGlhbGx5IHZhbGlkYXRlZC4KCkF0IHRoZSBtb21lbnQsIGEg
ZGlzdGluY3Rpb24gaXMgbWFkZSBiZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVt
b3Rpb24Kd2l0aCByZWdhcmQgdG8gd2hldGhlciB0aGUgZW50cnkgaXRzZWxm
ICJob2xkcyIgYSBnZW5lcmFsIHJlZmVyZW5jZQpjb3VudDogd2hlbiBlbnRy
eSBwcm9tb3Rpb24gaXMgaW50ZXJydXB0ZWQgKGkuZS4sIHJldHVybnMgLUVS
RVNUQVJUKSwKdGhlIGVudHJ5IGlzIG5vdCBjb25zaWRlcmVkIHRvIGhvbGQg
YSByZWZlcmVuY2U7IHdoZW4gZW50cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0
ZWQsIHRoZSBlbnRyeSBpcyBzdGlsbCBjb25zaWRlcmVkIHRvIGhvbGQgYSBn
ZW5lcmFsCnJlZmVyZW5jZS4KClBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYg
Y2xlYXIsIGl0J3MgYSBwYXJ0aWFsIHByb21vdGlvbiA9PiBubyBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBoZWxkCmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBp
dCdzIHBhcnRpYWwgZGVtb3Rpb24sIHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UK
Y291bnQgaGVsZC4gIEJlY2F1c2UgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25z
IGNhbiBiZSBpbnRlcmxlYXZlZCwgdGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8g
Z2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21f
bCplLAp0byBiZSBhYmxlIHRvIHByb3Blcmx5IGhhbmRsZSByZWZlcmVuY2Ug
Y291bnRzLgoKVW5mb3J0dW5hdGVseSwgd2hlbiBhbGxvY19sWzIzXV90YWJs
ZSBjaGVjayBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpCmFuZCByZXR1cm4g
LUVSRVNUQVJULCB0aGV5IHNldCBucl9lbnRyaWVzX3ZhbGlkYXRlZCwgYnV0
IGRvbid0IGNsZWFyCnBhcnRpYWxfZmxhZ3MuCgpJZiB3ZSB3ZXJlIHBpY2tp
bmcgdXAgZnJvbSBhIHByZXZpb3VzbHktaW50ZXJydXB0ZWQgcHJvbW90aW9u
LCB0aGF0Cm1lYW5zIHRoYXQgUFRGX3BhcnRpYWxfc2V0IHdvdWxkIGJlIHNl
dCBldmVuIHRob3VnaApbbnJfZW50cmllc192YWxpZGF0ZWRdIHdhcyBub3Qg
cGFydGlhbGx5IHZhbGlkYXRlZC4gIFRoaXMgbWVhbnMgdGhhdAppZiB0aGUg
cGFnZSBpbiB0aGlzIHN0YXRlIHdlcmUgZGUtdmFsaWRhdGVkLCBwdXRfcGFn
ZV90eXBlKCkgd291bGQKZXJyb25lb3VzbHkgYmUgY2FsbGVkIG9uIHRoYXQg
ZW50cnkuCgpQZXJoYXBzIHdvcnNlLCBpZiB3ZSB3ZXJlIHJhY2luZyB3aXRo
IGEgZGUtdmFsaWRhdGlvbiwgdGhlbiB3ZSBtaWdodApsZWF2ZSBib3RoIFBU
Rl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7IGFu
ZCB3aGVuCmRlLXZhbGlkYXRpb24gcGlja2VkIHVwIGFnYWluLCBib3RoIHRo
ZSB0eXBlIGFuZCB0aGUgZ2VuZXJhbCByZWYgd291bGQKYmUgZXJyb25lb3Vz
bHkgZHJvcHBlZCBmcm9tIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0uCgpJbiBh
IHNlbnNlLCB0aGUgcmVhbCBpc3N1ZSBoZXJlIGlzIGNvZGUgZHVwbGljYXRp
b24uICBSYXRoZXIgdGhhbgpkdXBsaWNhdGUgdGhlIGludGVycnVwdGlvbiBj
b2RlLCBzZXQgcmMgdG8gLUVJTlRSIGFuZCBmYWxsIHRocm91Z2ggdG8KdGhl
IGNvZGUgd2hpY2ggYWxyZWFkeSBoYW5kbGVzIHRoYXQgY2FzZSBjb3JyZWN0
bHkuCgpHaXZlbiB0aGUgbG9naWMgYXQgdGhpcyBwb2ludCwgaXQgc2hvdWxk
IGJlIGltcG9zc2libGUgZm9yCnBhcnRpYWxfZmxhZ3MgdG8gYmUgbm9uLXpl
cm87IGFkZCBhbiBBU1NFUlQoKSB0byBjYXRjaCBhbnkgY2hhbmdlcy4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMTggKysrKy0tLS0tLS0tLS0tLS0t
CiAxIGZpbGUgY2hhbmdlZCwgNCBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCmluZGV4IDE2YWVmMmY2NTIuLjVlNmJiMzM0OWMgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS5jCkBAIC0xNzA5LDEzICsxNzA5LDggQEAgc3RhdGljIGludCBhbGxv
Y19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBs
b25nIHR5cGUpCiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCAp
CiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAg
ewotICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwot
ICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVh
azsKLSAgICAgICAgfQotCi0gICAgICAgIGlmICggIWlzX2d1ZXN0X2wyX3Ns
b3QoZCwgdHlwZSwgaSkgfHwKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOwor
ICAgICAgICBlbHNlIGlmICggIWlzX2d1ZXN0X2wyX3Nsb3QoZCwgdHlwZSwg
aSkgfHwKICAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2wyZShw
bDJlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQogICAgICAg
ICAgICAgY29udGludWU7CiAKQEAgLTE3ODYsMTMgKzE3ODEsOCBAQCBzdGF0
aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCApCiAgICAgewog
ICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAmJiBo
eXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAgewotICAgICAg
ICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAg
ICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVhazsKLSAgICAg
ICAgfQotCi0gICAgICAgIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYm
IChpID09IDMpICkKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAg
ICBlbHNlIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYmIChpID09IDMp
ICkKICAgICAgICAgewogICAgICAgICAgICAgaWYgKCAhKGwzZV9nZXRfZmxh
Z3MocGwzZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSB8fAogICAgICAgICAgICAg
ICAgICAobDNlX2dldF9mbGFncyhwbDNlW2ldKSAmIGwzX2Rpc2FsbG93X21h
c2soZCkpICkKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0008-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0008-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Transfer-Encoding: base64

RnJvbSAzOTFhODViYmIxMWY5MjE4ZDY1YWZhYzY2NmM5ODA2MjFjNWI4MjJi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA4LzEyXSB4
ODYvbW06IEFsd2F5cyByZXRhaW4gYSBnZW5lcmFsIHJlZiBvbiBwYXJ0aWFs
CgpJbiBvcmRlciB0byBhbGxvdyByZWN1cnNpdmUgcGFnZXRhYmxlIHByb21v
dGlvbnMgYW5kIGRlbW90aW9ucyB0byBiZQppbnRlcnJ1cHRlZCwgWGVuIG11
c3Qga2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIHN1Yi1wYWdlcwpw
cm9tb3RlZCBvciBkZW1vdGVkLiAgVGhpcyBpcyBzdG9yZWQgaW4gdHdvIGVs
ZW1lbnRzIGluIHRoZSBwYWdlIHN0cnVjdDoKbnJfZW50cmllc192YWxpZGF0
ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpUaGUgcnVsZSBpcyB0aGF0IGVudHJp
ZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRhdGVkKSBzaG91bGQgYWx3YXlzIGJl
CnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdlbmVyYWwgcmVmZXJlbmNlIGNvdW50
LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6ZXJvLCB0aGVuIFtucl9lbnRyaWVz
X3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlkYXRlZCBhbmQgbm8gcmVmZXJlbmNl
CmNvdW50IGlzIGhlbGQuICBJZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0KaXMgcGFydGlhbGx5IHZhbGlk
YXRlZC4KCkF0IHRoZSBtb21lbnQsIGEgZGlzdGluY3Rpb24gaXMgbWFkZSBi
ZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVtb3Rpb24Kd2l0aCByZWdhcmQgdG8g
d2hldGhlciB0aGUgZW50cnkgaXRzZWxmICJob2xkcyIgYSBnZW5lcmFsIHJl
ZmVyZW5jZQpjb3VudDogd2hlbiBlbnRyeSBwcm9tb3Rpb24gaXMgaW50ZXJy
dXB0ZWQgKGkuZS4sIHJldHVybnMgLUVSRVNUQVJUKSwKdGhlIGVudHJ5IGlz
IG5vdCBjb25zaWRlcmVkIHRvIGhvbGQgYSByZWZlcmVuY2U7IHdoZW4gZW50
cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0ZWQsIHRoZSBlbnRyeSBpcyBzdGls
bCBjb25zaWRlcmVkIHRvIGhvbGQgYSBnZW5lcmFsCnJlZmVyZW5jZS4KClBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHVzZWQgdG8gZGlzdGluZ3Vpc2gg
YmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYgY2xlYXIsIGl0J3MgYSBwYXJ0aWFs
IHByb21vdGlvbiA9PiBubyBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBoZWxk
CmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBpdCdzIHBhcnRpYWwgZGVtb3Rpb24s
IHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UKY291bnQgaGVsZC4gIEJlY2F1c2Ug
cHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIGNhbiBiZSBpbnRlcmxlYXZlZCwg
dGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21fbCplLAp0byBiZSBhYmxlIHRvIHBy
b3Blcmx5IGhhbmRsZSByZWZlcmVuY2UgY291bnRzLgoKVW5mb3J0dW5hdGVs
eSwgYmVjYXVzZSBhIHJlZmNvdW50IGlzIG5vdCBoZWxkLCBpdCBpcyBwb3Nz
aWJsZSB0bwplbmdpbmVlciBhIHNpdHVhdGlvbiB3aGVyZSBQRlRfcGFydGlh
bF9zZXQgaXMgc2V0IGJ1dCB0aGUgcGFnZSBpbgpxdWVzdGlvbiBoYXMgYmVl
biBhc3NpZ25lZCB0byBhbm90aGVyIGRvbWFpbi4gIEEgc2tldGNoIGlzIHBy
b3ZpZGVkIGluCnRoZSBhcHBlbmRpeC4KCkZpeCB0aGlzIGJ5IGhhdmluZyB0
aGUgcGFyZW50IHBhZ2UgdGFibGUgZW50cnkgaG9sZCBhIGdlbmVyYWwKcmVm
ZXJlbmNlIGNvdW50IHdoZW5ldmVyIFBGVF9wYXJ0aWFsX3NldCBpcyBzZXQu
ICAoRm9yIGNsYXJpdHkgb2YKY2hhbmdlLCBrZWVwIHR3byBzZXBhcmF0ZSBm
bGFncy4gIFRoZXNlIHdpbGwgYmUgY29sbGFwc2VkIGluIGEKc3Vic2VxdWVu
dCBjaGFuZ2VzZXQuKQoKVGhpcyBoYXMgdHdvIGJhc2ljIGltcGxpY2F0aW9u
cy4gIE9uIHRoZSBwdXRfcGFnZV9mcm9tX2xOZSgpIHNpZGUsCnRoaXMgbWVh
biB0aGF0IHRoZSAocGFydGlhbF9zZXQgJiYgIXBhcnRpYWxfcmVmKSBjYXNl
IGNhbiBuZXZlciBoYXBwZW4sCmFuZCBubyBsb25nZXIgbmVlZHMgdG8gYmUg
c3BlY2lhbC1jYXNlZC4KClNlY29uZGx5LCBiZWNhdXNlIGJvdGggZmxhZ3Mg
YXJlIHNldCB0b2dldGhlciwgdGhlcmUncyBubyBuZWVkIHRvIGNhcnJ5IG92
ZXIKZXhpc3RpbmcgYml0cyBmcm9tIHBhcnRpYWxfcHRlLgoKKE5CIHRoZXJl
IGlzIHN0aWxsIGFub3RoZXIgaXNzdWUgd2l0aCBjYWxsaW5nIF9wdXRfcGFn
ZV90eXBlKCkgb24gYQpwYWdlIHdoaWNoIGhhZCBQR1RfcGFydGlhbCBzZXQ7
IHRoYXQgd2lsbCBiZSBoYW5kbGVkIGluIGEgc3Vic2VxdWVudApwYXRjaC4p
CgpPbiB0aGUgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oKSBzaWRlLCB3
ZSBuZWVkIHRvIGRpc3Rpbmd1aXNoCmJldHdlZW4gY2FsbGVycyB3aGljaCBo
b2xkIGEgcmVmZXJlbmNlIG9uIHBhcnRpYWwgKGkuZS4sCmFsbG9jX2xOX3Rh
YmxlKCkpLCBhbmQgdGhvc2Ugd2hpY2ggZG8gbm90IChuZXdfY3IzLCBQSU5f
TE5fVEFCTEUsIGFuZApzbyBvbik6IHBhc3MgYSBmbGFnIGlmIHRoZSB0eXBl
IHNob3VsZCBiZSByZXRhaW5lZCBvbiBpbnRlcnJ1cHRpb24uCgpOQiB0aGF0
IHNpbmNlIGwxIHByb21vdGlvbiBjYW4ndCBiZSBwcmVlbXB0ZWQsIHRoYXQg
Z2V0X3BhZ2VfZnJvbV9sMmUKY2FuJ3QgcmV0dXJuIC1FUkVTVEFSVC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0tLQoKKiBBcHBlbmRpeDogRW5naW5lZXJpbmcgUFRGX3BhcnRpYWxfc2V0
IHdoaWxlIGEgcGFnZSBiZWxvbmdzIHRvIGEKICBmb3JlaWduIGRvbWFpbgoK
U3VwcG9zZSBBIGlzIGEgcGFnZSB3aGljaCBjYW4gYmUgcHJvbW90ZWQgdG8g
YW4gbDMsIGFuZCBCIGlzIGEgcGFnZQp3aGljaCBjYW4gYmUgcHJvbW90ZWQg
dG8gYW4gbDIsIGFuZCBBW3hdIHBvaW50cyB0byBCLiAgQiBoYXMKUEdDX2Fs
bG9jYXRlZCBzZXQgYnV0IG5vIG90aGVyIGdlbmVyYWwgcmVmZXJlbmNlcy4K
ClYxOiAgUElOX0wzIEEuCiAgQSBpcyB2YWxpZGF0ZWQsIEIgaXMgdmFsaWRh
dGVkLgogIEEudHlwZV9jb3VudCA9IDEgfCBQR1RfdmFsaWRhdGVkIHwgUEdU
X3Bpbm5lZAogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfdmFsaWRhdGVkCiAg
Qi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkIChBW3hdIGhvbGRzIGEgZ2Vu
ZXJhbCByZWYpCgpWMTogVU5QSU4gQS4KICBBIGJlZ2lucyBkZS12YWxpZGF0
aW9uLgogIEFycmFuZ2UgdG8gYmUgaW50ZXJydXB0ZWQgd2hlbiBpIDwgeAog
IFYxLT5vbGRfZ3Vlc3RfdGFibGUgPSBBCiAgVjEtPm9sZF9ndWVzdF90YWJs
ZV9yZWZfaGVsZCA9IGZhbHNlCiAgQS50eXBlX2NvdW50ID0gMSB8IFBHVF9w
YXJ0aWFsCiAgQS5ucl92YWxpZGF0ZWRfZW50cmllcyA9IGkgPCB4CiAgQi50
eXBlX2NvdW50ID0gMAogIEIuY291bnQgPSAxIHwgUEdDX2FsbG9jYXRlZAoK
VjI6IE1PRF9MNF9FTlRSWSB0byBwb2ludCBzb21lIGw0ZSB0byBBLgogIFBp
Y2tzIHVwIHJlLXZhbGlkYXRpb24gb2YgQS4KICBBcnJhbmdlIHRvIGJlIGlu
dGVycnVwdGVkIGhhbGZ3YXkgdGhyb3VnaCBCJ3MgdmFsaWRhdGlvbgogIEIu
dHlwZV9jb3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEIuY291bnQgPSAyIHwg
UEdDX2FsbG9jYXRlZCAoUEdUX3BhcnRpYWwgaG9sZHMgYSBnZW5lcmFsIHJl
ZikKICBBLnR5cGVfY291bnQgPSAxIHwgUEdUX3BhcnRpYWwKICBBLm5yX3Zh
bGlkYXRlZF9lbnRyaWVzID0geAogIEEucGFydGlhbF9wdGUgPSBQVEZfcGFy
dGlhbF9zZXQKClYzOiBNT0RfTDNfRU5UUlkgdG8gcG9pbnQgc29tZSBvdGhl
ciBsM2UgKG5vdCBpbiBBKSB0byBCLgogIFZhbGlkYXRlcyBCLgogIEIudHlw
ZV9jb3VudCA9IDEgfCBQR1RfdmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQ
R0NfYWxsb2NhdGVkICgib3RoZXIgbDNlIiBob2xkcyBhIGdlbmVyYWwgcmVm
KQoKVjM6IE1PRF9MM19FTlRSWSB0byBjbGVhciBsM2UgcG9pbnRpbmcgdG8g
Qi4KICBEZXZhbGlkYXRlcyBCLgogIEIudHlwZV9jb3VudCA9IDAKICBCLmNv
dW50ID0gMSB8IFBHQ19hbGxvY2F0ZWQKClYzOiBkZWNyZWFzZV9yZXNlcnZh
dGlvbihCKQogIENsZWFycyBQR0NfYWxsb2NhdGVkCiAgQi5jb3VudCA9IDAg
PT4gQiBpcyBmcmVlZAoKQiBnZXRzIGFzc2lnbmVkIHRvIGEgZGlmZmVyZW50
IGRvbWFpbgoKVjE6IFJlc3RhcnRzIFVOUElOIG9mIEEKICBwdXRfb2xkX2d1
ZXN0X3RhYmxlKEEpCiAgICAuLi4KICAgICAgZnJlZV9sM190YWJsZShBKQoK
Tm93IHNpbmNlIEEucGFydGlhbF9mbGFncyBoYXMgUFRGX3BhcnRpYWxfc2V0
LCBmcmVlX2wzX3RhYmxlKCkgd2lsbApjYWxsIHB1dF9wYWdlX2Zyb21fbDNl
KCkgb24gQVt4XSwgd2hpY2ggcG9pbnRzIHRvIEIsIHdoaWxlIEIgaXMgb3du
ZWQKYnkgYW5vdGhlciBkb21haW4uCgpJZiBBW3hdIGhlbGQgYSBnZW5lcmFs
IHJlZmNvdW50IGZvciBCIG9uIHBhcnRpYWwgdmFsaWRhdGlvbiwgYXMgaXQg
ZG9lcwpmb3IgcGFydGlhbCBkZS12YWxpZGF0aW9uLCB0aGVuIEIgd291bGQg
c3RpbGwgaGF2ZSBhIHJlZmVyZW5jZSBjb3VudCBvZgoxIGFmdGVyIFBHQ19h
bGxvY2F0ZWQgd2FzIGZyZWVkOyBzbyBCIHdvdWxkbid0IGJlIGZyZWVkIHVu
dGlsIGFmdGVyCnB1dF9wYWdlX2Zyb21fbDNlKCkgaGFkIGhhcHBlbmQgb24g
QVt4XS4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAgICAgfCA4NyArKysr
KysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5j
bHVkZS9hc20teDg2L21tLmggfCAxNSArKysrLS0tCiAyIGZpbGVzIGNoYW5n
ZWQsIDYxIGluc2VydGlvbnMoKyksIDQxIGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS5jIGIveGVuL2FyY2gveDg2L21tLmMK
aW5kZXggNWU2YmIzMzQ5Yy4uODAxMmI2Y2RkYiAxMDA2NDQKLS0tIGEveGVu
L2FyY2gveDg2L21tLmMKKysrIGIveGVuL2FyY2gveDg2L21tLmMKQEAgLTc2
MywxMCArNzYzLDExIEBAIHN0YXRpYyBpbnQgX19nZXRfcGFnZV90eXBlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSwKICAq
IHBhZ2UtPnB0ZVtwYWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUg
dGhlIGNvbW1lbnQgaW4gbW0uaCBmb3IKICAqIG1vcmUgaW5mb3JtYXRpb24u
CiAgKi8KLSNkZWZpbmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwg
MCkKLSNkZWZpbmUgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkK
LSNkZWZpbmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKLSNk
ZWZpbmUgUFRGX2RlZmVyICAgICAgICAgICAgICAgKDEgPDwgMykKKyNkZWZp
bmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgICAoMSA8PCAwKQorI2RlZmlu
ZSBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiAgICgxIDw8IDEpCisjZGVmaW5l
IFBURl9wcmVlbXB0aWJsZSAgICAgICAgICAgKDEgPDwgMikKKyNkZWZpbmUg
UFRGX2RlZmVyICAgICAgICAgICAgICAgICAoMSA8PCAzKQorI2RlZmluZSBQ
VEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0ICgxIDw8IDQpCiAKIHN0YXRpYyBp
bnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIodW5zaWduZWQgbG9u
ZyBwYWdlX25yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nIHR5cGUsCkBAIC03NzYsNyArNzc3LDEx
IEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIo
dW5zaWduZWQgbG9uZyBwYWdlX25yLAogICAgIHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2UgPSBtZm5fdG9fcGFnZShwYWdlX25yKTsKICAgICBpbnQgcmM7CiAg
ICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZsYWdzICYgUFRGX3ByZWVtcHRpYmxl
LAotICAgICAgICAgcGFydGlhbF9yZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmOworICAgICAgICAgcGFydGlhbF9yZWYgPSBmbGFncyAm
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmLAorICAgICAgICAgcGFydGlhbF9z
ZXQgPSBmbGFncyAmIFBURl9wYXJ0aWFsX3NldCwKKyAgICAgICAgIHJldGFp
bl9yZWYgID0gZmxhZ3MgJiBQVEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0Owor
CisgICAgQVNTRVJUKHBhcnRpYWxfcmVmID09IHBhcnRpYWxfc2V0KTsKIAog
ICAgIGlmICggbGlrZWx5KCFwYXJ0aWFsX3JlZikgJiYKICAgICAgICAgIHVu
bGlrZWx5KCFnZXRfcGFnZV9mcm9tX3BhZ2VucihwYWdlX25yLCBkKSkgKQpA
QCAtNzg5LDEzICs3OTQsMTUgQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRf
dHlwZV9mcm9tX3BhZ2Vucih1bnNpZ25lZCBsb25nIHBhZ2VfbnIsCiAgICAg
ICogLSBwYWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKICAgICAg
KiAtIHBhZ2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6CiAgICAg
ICogICAtIFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlhbF9y
ZWYpCisgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCAo
cmMgPT0gLUVSRVNUQVJUKSwgYW5kIHRoZQorICAgICAqICAgICBjYWxsZXIg
aGFzIGFza2VkIHRoZSByZWYgdG8gYmUgcmV0YWluZWQgaW4gdGhhdCBjYXNl
CiAgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCBidXQg
dGhlcmUncyBiZWVuIGFuIGVycm9yCiAgICAgICogICAgIChwYWdlID09IGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKQogICAgICAqCiAgICAgICog
VGhlIHBhcnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBpcyB3b3J0aCBhbiBl
eHBsYW5hdGlvbi4gIFRoZXJlCiAgICAgICogYXJlIHR3byBzY2VuYXJpb3Mg
d2hlcmUgcGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBjb21pbmcgaW46Ci0g
ICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgdHlw
ZSBgdHlwZWA7IGkuZS4gaGFzCi0gICAgICogICBQR1RfcGFydGlhbCBzZXQK
KyAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgcHJvbW90ZWQgLyBk
ZW1vdGVkIGFzIHR5cGUgYHR5cGVgOworICAgICAqICAgaS5lLiBoYXMgUEdU
X3BhcnRpYWwgc2V0CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5
IGRlbW90ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgogICAgICAq
ICAgcGFnZTsgZS5nLiB3ZSdyZSBiZWluZyBjYWxsZWQgZnJvbSBnZXRfcGFn
ZV9mcm9tX2wyZSB3aXRoCiAgICAgICogICB0eXBlID09IFBHVF9sMV90YWJs
ZSwgYnV0IHRoZSBtZm4gaXMgUEdUX2wyX3RhYmxlKQpAQCAtODE4LDcgKzgy
NSw4IEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdl
bnIodW5zaWduZWQgbG9uZyBwYWdlX25yLAogICAgICAqLwogICAgIGlmICgg
bGlrZWx5KCFyYykgfHwgcGFydGlhbF9yZWYgKQogICAgICAgICAvKiBub3Ro
aW5nICovOwotICAgIGVsc2UgaWYgKCBwYWdlID09IGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlICkKKyAgICBlbHNlIGlmICggcGFnZSA9PSBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSB8fAorICAgICAgICAgICAgICAo
cmV0YWluX3JlZiAmJiByYyA9PSAtRVJFU1RBUlQpICkKICAgICAgICAgQVNT
RVJUKHByZWVtcHRpYmxlKTsKICAgICBlbHNlCiAgICAgICAgIHB1dF9wYWdl
KHBhZ2UpOwpAQCAtMTUwOSw4ICsxNTE3LDggQEAgc3RhdGljIGludCBwdXRf
cGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25n
IHBmbiwKICAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0
IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQogICAgICAgICAgICAg
ICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAgICB7Ci0gICAgICAgICAgICBB
U1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwotICAgICAgICAgICAgcmMg
PSBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBwdHBnKTsK
KyAgICAgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdheXMgaW1w
bHkgcGFydGlhbF9yZWYgKi8KKyAgICAgICAgICAgIEJVRygpOwogICAgICAg
ICB9CiAgICAgICAgIGVsc2UgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAg
ICAgICAgIHsKQEAgLTE1NTUsOCArMTU2Myw4IEBAIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCiAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQogICAgICAgICAgUFRGX3Bh
cnRpYWxfc2V0ICkKICAgICB7Ci0gICAgICAgIEFTU0VSVCghKGZsYWdzICYg
UFRGX2RlZmVyKSk7Ci0gICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShw
ZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKKyAgICAg
ICAgLyogcGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBseSBwYXJ0aWFs
X3JlZiAqLworICAgICAgICBCVUcoKTsKICAgICB9CiAKICAgICBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKQEAgLTE1ODYsOCArMTU5NCw4IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAgICAgICAgIGlmICggKGZsYWdzICYgKFBURl9w
YXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KICAg
ICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAgewotICAg
ICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKLSAgICAg
ICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRp
YmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKKyAgICAgICAgICAgIC8qIHBhcnRp
YWxfc2V0IHNob3VsZCBhbHdheXMgaW1wbHkgcGFydGlhbF9yZWYgKi8KKyAg
ICAgICAgICAgIEJVRygpOwogICAgICAgICB9CiAKICAgICAgICAgaWYgKCBm
bGFncyAmIFBURl9kZWZlciApCkBAIC0xNzE0LDEzICsxNzIyLDIyIEBAIHN0
YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAgICAgICAgIChyYyA9IGdl
dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbiwgZCwgcGFydGlhbF9mbGFn
cykpID4gMCApCiAgICAgICAgICAgICBjb250aW51ZTsKIAotICAgICAgICBp
ZiAoIHJjID09IC1FUkVTVEFSVCApCi0gICAgICAgIHsKLSAgICAgICAgICAg
IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIC8q
IFNldCAnc2V0JywgcmV0YWluICdnZW5lcmFsIHJlZicgKi8KLSAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRG
X3BhcnRpYWxfc2V0OwotICAgICAgICB9Ci0gICAgICAgIGVsc2UgaWYgKCBy
YyA9PSAtRUlOVFIgJiYgaSApCisgICAgICAgIC8qCisgICAgICAgICAqIEl0
IHNob3VsZG4ndCBiZSBwb3NzaWJsZSBmb3IgZ2V0X3BhZ2VfZnJvbV9sMmUg
dG8gcmV0dXJuCisgICAgICAgICAqIC1FUkVTVEFSVCwgc2luY2Ugd2UgbmV2
ZXIgY2FsbCB0aGlzIHdpdGggUFRGX3ByZWVtcHRpYmxlLgorICAgICAgICAg
KiAoYWxsb2NfbDFfdGFibGUgbWF5IHJldHVybiAtRUlOVFIgb24gYW4gTDFU
Ri12dWxuZXJhYmxlCisgICAgICAgICAqIGVudHJ5LikKKyAgICAgICAgICoK
KyAgICAgICAgICogTkIgdGhhdCB3aGlsZSBvbiBhICJjbGVhbiIgcHJvbW90
aW9uLCB3ZSBjYW4gbmV2ZXIgZ2V0CisgICAgICAgICAqIFBHVF9wYXJ0aWFs
LiAgSXQgaXMgcG9zc2libGUgdG8gYXJyYW5nZSBmb3IgYW4gbDJlIHRvCisg
ICAgICAgICAqIGNvbnRhaW4gYSBwYXJ0aWFsbHktZGV2YWxpZGF0ZWQgbDI7
IGJ1dCBpbiB0aGF0IGNhc2UsIGJvdGgKKyAgICAgICAgICogb2YgdGhlIGZv
bGxvd2luZyBmdW5jdGlvbnMgd2lsbCBmYWlsIGFueXdheSAodGhlIGZpcnN0
CisgICAgICAgICAqIGJlY2F1c2UgdGhlIHBhZ2UgaW4gcXVlc3Rpb24gaXMg
bm90IGFuIGwxOyB0aGUgc2Vjb25kCisgICAgICAgICAqIGJlY2F1c2UgdGhl
IHBhZ2UgaXMgbm90IGZ1bGx5IHZhbGlkYXRlZCkuCisgICAgICAgICAqLwor
ICAgICAgICBBU1NFUlQocmMgIT0gLUVSRVNUQVJUKTsKKworICAgICAgICBp
ZiAoIHJjID09IC1FSU5UUiAmJiBpICkKICAgICAgICAgewogICAgICAgICAg
ICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwogICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CkBAIC0xNzI5LDYgKzE3NDYsNyBA
QCBzdGF0aWMgaW50IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSkKICAgICAgICAgZWxzZSBpZiAo
IHJjIDwgMCAmJiByYyAhPSAtRUlOVFIgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBNRU1fTE9HKCJGYWlsdXJlIGluIGFsbG9jX2wyX3RhYmxlOiBlbnRy
eSAlZCIsIGkpOworICAgICAgICAgICAgQVNTRVJUKGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwogICAgICAgICAgICAgaWYgKCBp
ICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyA9IGk7CkBAIC0xNzkyLDE3ICsxODEwLDIxIEBAIHN0
YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFBHVF9sMl9wYWdlX3RhYmxlIHwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBHVF9wYWVf
eGVuX2wyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8CisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQ
VEZfcHJlZW1wdGlibGUgfAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgUFRGX3JldGFpbl9yZWZfb25fcmVz
dGFydCk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoICFpc19ndWVz
dF9sM19zbG90KGkpIHx8Ci0gICAgICAgICAgICAgICAgICAocmMgPSBnZXRf
cGFnZV9mcm9tX2wzZShwbDNlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3Mp
KSA+IDAgKQorICAgICAgICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJv
bV9sM2UocGwzZVtpXSwgcGZuLCBkLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8CisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQVEZfcmV0YWlu
X3JlZl9vbl9yZXN0YXJ0KSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVl
OwogCiAgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAg
ewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwog
ICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJhbCByZWYn
IHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAgICAgIHBh
Z2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3BhcnRp
YWxfc2V0OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogICAg
ICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSAp
CiAgICAgICAgIHsKQEAgLTE4OTcsMTQgKzE5MTksMTUgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQogICAgIHsKICAgICAg
ICAgaWYgKCAhaXNfZ3Vlc3RfbDRfc2xvdChkLCBpKSB8fAotICAgICAgICAg
ICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDRlKHBsNGVbaV0sIHBmbiwgZCwg
cGFydGlhbF9mbGFncykpID4gMCApCisgICAgICAgICAgICAgKHJjID0gZ2V0
X3BhZ2VfZnJvbV9sNGUocGw0ZVtpXSwgcGZuLCBkLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgfCBQVEZfcmV0YWlu
X3JlZl9vbl9yZXN0YXJ0KSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVl
OwogCiAgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAg
ewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwog
ICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJhbCByZWYn
IHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAgICAgIHBh
Z2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3BhcnRp
YWxfc2V0OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogICAg
ICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKQogICAgICAgICB7
CkBAIC0yMDAyLDkgKzIwMjUsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDJfdGFi
bGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBlbHNlIGlmICggcmMg
PT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/Ci0gICAgICAg
ICAgICBwYXJ0aWFsX2ZsYWdzIDoKLSAgICAgICAgICAgIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CisgICAgICAgIHBh
Z2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFy
dGlhbF9nZW5lcmFsX3JlZjsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09
IC1FSU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAg
ICB7CkBAIC0yMDU1LDkgKzIwNzYsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDNf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09
IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAo
cGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgPwotICAgICAgICAg
ICAgcGFydGlhbF9mbGFncyA6Ci0gICAgICAgICAgICAoUFRGX3BhcnRpYWxf
c2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpOworICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRp
YWxfZ2VuZXJhbF9yZWY7CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9PSAt
RUlOVFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAgICAg
ewpAQCAtMjA4OCw5ICsyMTA3LDcgQEAgc3RhdGljIGludCBmcmVlX2w0X3Rh
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgaWYgKCByYyA9PSAt
RVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gKHBh
cnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpID8KLSAgICAgICAgICAg
IHBhcnRpYWxfZmxhZ3MgOgotICAgICAgICAgICAgKFBURl9wYXJ0aWFsX3Nl
dCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsKKyAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmOwogICAgIH0KICAgICBlbHNlIGlmICggcmMgPT0gLUVJ
TlRSICYmIGkgPCBMNF9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQogICAgIHsK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9p
bmNsdWRlL2FzbS14ODYvbW0uaAppbmRleCA4ZTNjZWY5NTRjLi5jMmQxNzU4
YWQ3IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKKysr
IGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCkBAIC0xNTEsMjIgKzE1MSwy
NSBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAgICAgICAgICAqIHBhZ2UuCiAgICAg
ICAgICAqCiAgICAgICAgICAqIFRoaXMgaGFwcGVuczoKLSAgICAgICAgICog
LSBEdXJpbmcgZGUtdmFsaWRhdGlvbiwgaWYgZGUtdmFsaWRhdGlvbiBvZiB0
aGUgcGFnZSB3YXMKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiBv
ciBkZS12YWxpZGF0aW9uLCBpZiB0aGUgb3BlcmF0aW9uIHdhcwogICAgICAg
ICAgKiAgIGludGVycnVwdGVkCiAgICAgICAgICAqIC0gRHVyaW5nIHZhbGlk
YXRpb24sIGlmIGFuIGludmFsaWQgZW50cnkgaXMgZW5jb3VudGVyZWQgYW5k
CiAgICAgICAgICAqICAgdmFsaWRhdGlvbiBpcyBwcmVlbXB0aWJsZQogICAg
ICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9n
ZW5lcmFsX3JlZiB3YXMgc2V0IG9uCi0gICAgICAgICAqICAgdGhpcyBlbnRy
eSB0byBiZWdpbiB3aXRoIChwZXJoYXBzIGJlY2F1c2Ugd2UncmUgcGlja2lu
ZwotICAgICAgICAgKiAgIHVwIGZyb20gYSBwYXJ0aWFsIGRlLXZhbGlkYXRp
b24pLgorICAgICAgICAgKiAgIHRoaXMgZW50cnkgdG8gYmVnaW4gd2l0aCAo
cGVyaGFwcyBiZWNhdXNlIGl0IHBpY2tlZCB1cCBhCisgICAgICAgICAqICAg
cHJldmlvdXMgb3BlcmF0aW9uKQogICAgICAgICAgKgotICAgICAgICAgKiBX
aGVuIHJlc3VtaW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVy
YWxfcmVmIGlzIGNsZWFyLAotICAgICAgICAgKiB0aGVuIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZDsgaWYgaXQgaXMgc2V0LCBu
bwotICAgICAgICAgKiByZWZlcmVuY2Ugc2hvdWxkIGJlIGFjcXVpcmVkLgor
ICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24sIGlmIFBURl9w
YXJ0aWFsX2dlbmVyYWxfcmVmIGlzCisgICAgICAgICAqIGNsZWFyLCB0aGVu
IGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZDsgaWYg
aXQKKyAgICAgICAgICogaXMgc2V0LCBubyByZWZlcmVuY2Ugc2hvdWxkIGJl
IGFjcXVpcmVkLgogICAgICAgICAgKgogICAgICAgICAgKiBXaGVuIHJlc3Vt
aW5nIGRlLXZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
IGlzCiAgICAgICAgICAqIGNsZWFyLCBubyByZWZlcmVuY2Ugc2hvdWxkIGJl
IGRyb3BwZWQ7IGlmIGl0IGlzIHNldCwgYQogICAgICAgICAgKiByZWZlcmVu
Y2Ugc2hvdWxkIGJlIGRyb3BwZWQuCiAgICAgICAgICAqCisgICAgICAgICAq
IE5CIGF0IHRoZSBtb21lbnQsIFBURl9wYXJ0aWFsX3NldCBzaG91bGQgYmUg
c2V0IGlmIGFuZCBvbmx5IGlmCisgICAgICAgICAqIFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmIGlzIHNldC4KKyAgICAgICAgICoKICAgICAgICAgICogTkIg
dGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0aWFsX2dlbmVyYWxf
cmVmIGFyZQogICAgICAgICAgKiBkZWZpbmVkIGluIG1tLmMsIHRoZSBvbmx5
IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQuCiAgICAgICAgICAqCi0tIAoy
LjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0009-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0009-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Transfer-Encoding: base64

RnJvbSA0ZTAzODhhZjcwMTQ2ZmFhZWY2NDQzYThiNTc4MDdjZDYxZTA5NjBm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA5LzEyXSB4
ODYvbW06IENvbGxhcHNlIFBURl9wYXJ0aWFsX3NldCBhbmQKIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGludG8gb25lCgouLi5ub3cgdGhhdCB0aGV5IGFy
ZSBlcXVpdmFsZW50LiAgTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQu
CgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21tLmMg
ICAgICAgIHwgNTAgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIHwgMjkgKysrKysr
KysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA4MDEyYjZj
ZGRiLi5hNzA4NGNjZmE3IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNzU4LDEzICs3NTgsMTIg
QEAgc3RhdGljIGludCBfX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogCiAvKgogICogVGhlIGZv
bGxvd2luZyBmbGFncyBhcmUgdXNlZCB0byBzcGVjaWZ5IGJlaGF2aW9yIG9m
IHZhcmlvdXMgZ2V0IGFuZAotICogcHV0IGNvbW1hbmRzLiAgVGhlIGZpcnN0
IHR3byBhcmUgYWxzbyBzdG9yZWQgaW4gcGFnZS0+cGFydGlhbF9mbGFncwot
ICogdG8gaW5kaWNhdGUgdGhlIHN0YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQg
dG8gYnkKKyAqIHB1dCBjb21tYW5kcy4gIFRoZSBmaXJzdCBpcyBhbHNvIHN0
b3JlZCBpbiBwYWdlLT5wYXJ0aWFsX2ZsYWdzIHRvCisgKiBpbmRpY2F0ZSB0
aGUgc3RhdGUgb2YgdGhlIHBhZ2UgcG9pbnRlZCB0byBieQogICogcGFnZS0+
cHRlW3BhZ2UtPm5yX3ZhbGlkYXRlZF9lbnRyaWVzXS4gIFNlZSB0aGUgY29t
bWVudCBpbiBtbS5oIGZvcgogICogbW9yZSBpbmZvcm1hdGlvbi4KICAqLwog
I2RlZmluZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAgICgxIDw8IDApCi0j
ZGVmaW5lIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmICAgKDEgPDwgMSkKICNk
ZWZpbmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgICAoMSA8PCAyKQogI2Rl
ZmluZSBQVEZfZGVmZXIgICAgICAgICAgICAgICAgICgxIDw8IDMpCiAjZGVm
aW5lIFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQgKDEgPDwgNCkKQEAgLTc3
NywxMyArNzc2LDEwIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVf
ZnJvbV9wYWdlbnIodW5zaWduZWQgbG9uZyBwYWdlX25yLAogICAgIHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9fcGFnZShwYWdlX25yKTsKICAg
ICBpbnQgcmM7CiAgICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZsYWdzICYgUFRG
X3ByZWVtcHRpYmxlLAotICAgICAgICAgcGFydGlhbF9yZWYgPSBmbGFncyAm
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmLAogICAgICAgICAgcGFydGlhbF9z
ZXQgPSBmbGFncyAmIFBURl9wYXJ0aWFsX3NldCwKICAgICAgICAgIHJldGFp
bl9yZWYgID0gZmxhZ3MgJiBQVEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0Owog
Ci0gICAgQVNTRVJUKHBhcnRpYWxfcmVmID09IHBhcnRpYWxfc2V0KTsKLQot
ICAgIGlmICggbGlrZWx5KCFwYXJ0aWFsX3JlZikgJiYKKyAgICBpZiAoIGxp
a2VseSghcGFydGlhbF9zZXQpICYmCiAgICAgICAgICB1bmxpa2VseSghZ2V0
X3BhZ2VfZnJvbV9wYWdlbnIocGFnZV9uciwgZCkpICkKICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7CiAKQEAgLTc5MywxNCArNzg5LDE0IEBAIHN0YXRpYyBp
bnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIodW5zaWduZWQgbG9u
ZyBwYWdlX25yLAogICAgICAqIFJldGFpbiB0aGUgcmVmY291bnQgaWY6CiAg
ICAgICogLSBwYWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKICAg
ICAgKiAtIHBhZ2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6Ci0g
ICAgICogICAtIFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlh
bF9yZWYpCisgICAgICogICAtIFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5j
ZSAocGFydGlhbF9zZXQpCiAgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5
IHZhbGlkYXRlZCAocmMgPT0gLUVSRVNUQVJUKSwgYW5kIHRoZQogICAgICAq
ICAgICBjYWxsZXIgaGFzIGFza2VkIHRoZSByZWYgdG8gYmUgcmV0YWluZWQg
aW4gdGhhdCBjYXNlCiAgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZh
bGlkYXRlZCBidXQgdGhlcmUncyBiZWVuIGFuIGVycm9yCiAgICAgICogICAg
IChwYWdlID09IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKQogICAg
ICAqCi0gICAgICogVGhlIHBhcnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBp
cyB3b3J0aCBhbiBleHBsYW5hdGlvbi4gIFRoZXJlCi0gICAgICogYXJlIHR3
byBzY2VuYXJpb3Mgd2hlcmUgcGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBj
b21pbmcgaW46CisgICAgICogVGhlIHBhcnRpYWxfc2V0LW9uLWVycm9yIGNs
YXVzZSBpcyB3b3J0aCBhbiBleHBsYW5hdGlvbi4gIFRoZXJlCisgICAgICog
YXJlIHR3byBzY2VuYXJpb3Mgd2hlcmUgcGFydGlhbF9zZXQgbWlnaHQgYmUg
dHJ1ZSBjb21pbmcgaW46CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlh
bGx5IHByb21vdGVkIC8gZGVtb3RlZCBhcyB0eXBlIGB0eXBlYDsKICAgICAg
KiAgIGkuZS4gaGFzIFBHVF9wYXJ0aWFsIHNldAogICAgICAqIC0gbWZuIGhh
cyBiZWVuIHBhcnRpYWxseSBkZW1vdGVkIGFzIEwodHlwZSsxKSAoaS5lLiwg
YSBsaW5lYXIKQEAgLTgyMyw3ICs4MTksNyBAQCBzdGF0aWMgaW50IGdldF9w
YWdlX2FuZF90eXBlX2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9u
ciwKICAgICAgKiBjb3VudCByZXRhaW5lZCB1bmxlc3Mgd2Ugc3VjY2VlZGVk
LCBvciB0aGUgb3BlcmF0aW9uIHdhcwogICAgICAqIHByZWVtcHRpYmxlLgog
ICAgICAqLwotICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9yZWYg
KQorICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9zZXQgKQogICAg
ICAgICAvKiBub3RoaW5nICovOwogICAgIGVsc2UgaWYgKCBwYWdlID09IGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlIHx8CiAgICAgICAgICAgICAg
IChyZXRhaW5fcmVmICYmIHJjID09IC1FUkVTVEFSVCkgKQpAQCAtMTUxNCwx
MyArMTUxMCw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAgIHN0
cnVjdCBwYWdlX2luZm8gKnBnID0gbDJlX2dldF9wYWdlKGwyZSk7CiAgICAg
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnB0cGcgPSBtZm5fdG9fcGFnZShwZm4p
OwogCi0gICAgICAgIGlmICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3NldCB8
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KLSAgICAgICAgICAgICAg
UFRGX3BhcnRpYWxfc2V0ICkKLSAgICAgICAgewotICAgICAgICAgICAgLyog
cGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBseSBwYXJ0aWFsX3JlZiAq
LwotICAgICAgICAgICAgQlVHKCk7Ci0gICAgICAgIH0KLSAgICAgICAgZWxz
ZSBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKKyAgICAgICAgaWYgKCBmbGFn
cyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKICAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBwdHBnOwogICAgICAgICAgICAg
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKQEAgLTE1NjAs
MTMgKzE1NTAsNiBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwz
X3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgcGcg
PSBsM2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggKGZsYWdzICYgKFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0K
LSAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCi0gICAgewotICAgICAgICAv
KiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxfcmVm
ICovCi0gICAgICAgIEJVRygpOwotICAgIH0KLQogICAgIGlmICggZmxhZ3Mg
JiBQVEZfZGVmZXIgKQogICAgIHsKICAgICAgICAgY3VycmVudC0+YXJjaC5v
bGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKHBmbik7CkBAIC0xNTkxLDEz
ICsxNTc0LDYgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2w0ZShsNF9w
Z2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICB7CiAgICAg
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnBnID0gbDRlX2dldF9wYWdlKGw0ZSk7
CiAKLSAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQotICAgICAgICAgICAgICBQ
VEZfcGFydGlhbF9zZXQgKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBw
YXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxfcmVmICov
Ci0gICAgICAgICAgICBCVUcoKTsKLSAgICAgICAgfQotCiAgICAgICAgIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2Uo
cGZuKTsKQEAgLTE4MjQsNyArMTgwMCw3IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgewog
ICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwogICAg
ICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJhbCByZWYnIHNl
dCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZjsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxh
Z3MgPSBQVEZfcGFydGlhbF9zZXQ7CiAgICAgICAgIH0KICAgICAgICAgZWxz
ZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpICkKICAgICAgICAgewpAQCAtMTky
Nyw3ICsxOTAzLDcgQEAgc3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICB7CiAgICAgICAgICAgICBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICAvKiBT
ZXQgJ3NldCcsIGxlYXZlICdnZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50
cnkgd2FzIHNldCAqLwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0
aWFsX3NldDsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggcmMgPCAw
ICkKICAgICAgICAgewpAQCAtMjAyNSw3ICsyMDAxLDcgQEAgc3RhdGljIGlu
dCBmcmVlX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAg
ZWxzZSBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBh
cnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9n
ZW5lcmFsX3JlZjsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBU
Rl9wYXJ0aWFsX3NldDsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1F
SU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7
CkBAIC0yMDc2LDcgKzIwNTIsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDNfdGFi
bGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09IC1F
UkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZf
cGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsKICAg
ICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDNfUEFH
RVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CkBAIC0yMTA3LDcgKzIwODMs
NyBAQCBzdGF0aWMgaW50IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewog
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAg
IHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IFBURl9wYXJ0aWFsX3NldDsKICAgICB9CiAgICAgZWxzZSBpZiAo
IHJjID09IC1FSU5UUiAmJiBpIDwgTDRfUEFHRVRBQkxFX0VOVFJJRVMgLSAx
ICkKICAgICB7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKaW5kZXggYzJkMTc1OGFk
Ny4uYTEzZGQxZDI5OSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaApAQCAtMTQ2
LDcgKzE0Niw3IEBAIHN0cnVjdCBwYWdlX2luZm8KICAgICAgICAgICogb3Bl
cmF0aW9uIG9uIHRoZSBjdXJyZW50IHBhZ2UuICAoVGhhdCBwYWdlIG1heSBv
ciBtYXkgbm90CiAgICAgICAgICAqIHN0aWxsIGhhdmUgUEdUX3BhcnRpYWwg
c2V0LikKICAgICAgICAgICoKLSAgICAgICAgICogSWYgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYgaXMgc2V0LCB0aGVuIHRoZSBQVEUgYXQKKyAgICAgICAg
ICogQWRkaXRpb25hbGx5LCBpZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIHRoZSBQVEUgYXQKICAgICAgICAgICogQG5yX3ZhbGlkYXRlZF9wdGVm
IGhvbGRzIGEgZ2VuZXJhbCByZWZlcmVuY2UgY291bnQgZm9yIHRoZQogICAg
ICAgICAgKiBwYWdlLgogICAgICAgICAgKgpAQCAtMTU1LDIzICsxNTUsMjAg
QEAgc3RydWN0IHBhZ2VfaW5mbwogICAgICAgICAgKiAgIGludGVycnVwdGVk
CiAgICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIGFuIGludmFs
aWQgZW50cnkgaXMgZW5jb3VudGVyZWQgYW5kCiAgICAgICAgICAqICAgdmFs
aWRhdGlvbiBpcyBwcmVlbXB0aWJsZQotICAgICAgICAgKiAtIER1cmluZyB2
YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiB3YXMgc2V0
IG9uCi0gICAgICAgICAqICAgdGhpcyBlbnRyeSB0byBiZWdpbiB3aXRoIChw
ZXJoYXBzIGJlY2F1c2UgaXQgcGlja2VkIHVwIGEKKyAgICAgICAgICogLSBE
dXJpbmcgdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfc2V0IHdhcyBzZXQg
b24gdGhpcworICAgICAgICAgKiAgIGVudHJ5IHRvIGJlZ2luIHdpdGggKHBl
cmhhcHMgYmVjYXVzZSBpdCBwaWNrZWQgdXAgYQogICAgICAgICAgKiAgIHBy
ZXZpb3VzIG9wZXJhdGlvbikKICAgICAgICAgICoKLSAgICAgICAgICogV2hl
biByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFs
X3JlZiBpcwotICAgICAgICAgKiBjbGVhciwgdGhlbiBhIGdlbmVyYWwgcmVm
ZXJlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQ7IGlmIGl0Ci0gICAgICAgICAq
IGlzIHNldCwgbm8gcmVmZXJlbmNlIHNob3VsZCBiZSBhY3F1aXJlZC4KKyAg
ICAgICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFy
dGlhbF9zZXQgaXMgY2xlYXIsIHRoZW4KKyAgICAgICAgICogYSBnZW5lcmFs
IHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVpcmVkOyBpZiBpdCBpcyBzZXQs
IG5vCisgICAgICAgICAqIHJlZmVyZW5jZSBzaG91bGQgYmUgYWNxdWlyZWQu
CiAgICAgICAgICAqCi0gICAgICAgICAqIFdoZW4gcmVzdW1pbmcgZGUtdmFs
aWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMKLSAgICAg
ICAgICogY2xlYXIsIG5vIHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZDsg
aWYgaXQgaXMgc2V0LCBhCi0gICAgICAgICAqIHJlZmVyZW5jZSBzaG91bGQg
YmUgZHJvcHBlZC4KKyAgICAgICAgICogV2hlbiByZXN1bWluZyBkZS12YWxp
ZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9zZXQgaXMgY2xlYXIsCisgICAgICAg
ICAqIG5vIHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZDsgaWYgaXQgaXMg
c2V0LCBhIHJlZmVyZW5jZQorICAgICAgICAgKiBzaG91bGQgYmUgZHJvcHBl
ZC4KICAgICAgICAgICoKLSAgICAgICAgICogTkIgYXQgdGhlIG1vbWVudCwg
UFRGX3BhcnRpYWxfc2V0IHNob3VsZCBiZSBzZXQgaWYgYW5kIG9ubHkgaWYK
LSAgICAgICAgICogUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0Lgot
ICAgICAgICAgKgotICAgICAgICAgKiBOQiB0aGF0IFBURl9wYXJ0aWFsX3Nl
dCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgYXJlCi0gICAgICAgICAq
IGRlZmluZWQgaW4gbW0uYywgdGhlIG9ubHkgcGxhY2Ugd2hlcmUgdGhleSBh
cmUgdXNlZC4KKyAgICAgICAgICogTkIgdGhhdCBQVEZfcGFydGlhbF9zZXQg
aXMgZGVmaW5lZCBpbiBtbS5jLCB0aGUgb25seSBwbGFjZQorICAgICAgICAg
KiB3aGVyZSBpdCBpcyB1c2VkLgogICAgICAgICAgKgogICAgICAgICAgKiBU
aGUgM3JkIGZpZWxkLCBAbGluZWFyX3B0X2NvdW50LCBpbmRpY2F0ZXMKICAg
ICAgICAgICogLSBieSBhIHBvc2l0aXZlIHZhbHVlLCBob3cgbWFueSBzYW1l
LWxldmVsIHBhZ2UgdGFibGUgZW50cmllcyBhIHBhZ2UKQEAgLTE4MSw4ICsx
NzgsOCBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAgICAgICAgICAqLwogICAgICAg
ICBzdHJ1Y3QgewogICAgICAgICAgICAgdTE2IG5yX3ZhbGlkYXRlZF9wdGVz
OlBBR0VUQUJMRV9PUkRFUiArIDE7Ci0gICAgICAgICAgICB1MTYgOjE2IC0g
UEFHRVRBQkxFX09SREVSIC0gMSAtIDI7Ci0gICAgICAgICAgICB1MTYgcGFy
dGlhbF9mbGFnczoyOworICAgICAgICAgICAgdTE2IDoxNiAtIFBBR0VUQUJM
RV9PUkRFUiAtIDEgLSAxOworICAgICAgICAgICAgdTE2IHBhcnRpYWxfZmxh
Z3M6MTsKICAgICAgICAgICAgIHMxNiBsaW5lYXJfcHRfY291bnQ7CiAgICAg
ICAgIH07CiAKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0010-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0010-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Transfer-Encoding: base64

RnJvbSAyODExMjAyYTI2NzA2OWUxMjg3ZDA2OWVjZDYxY2RlMWM0NGM4NzQx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDEwLzEyXSB4
ODYvbW06IFByb3Blcmx5IGhhbmRsZSBsaW5lYXIgcGFnZXRhYmxlIHByb21v
dGlvbgogZmFpbHVyZXMKCkluIG9yZGVyIHRvIGFsbG93IHJlY3Vyc2l2ZSBw
YWdldGFibGUgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIHRvIGJlCmludGVy
cnVwdGVkLCBYZW4gbXVzdCBrZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0
aGUgc3ViLXBhZ2VzCnByb21vdGVkIG9yIGRlbW90ZWQuICBUaGlzIGlzIHN0
b3JlZCBpbiB0d28gZWxlbWVudHMgaW4gdGhlIHBhZ2UKc3RydWN0OiBucl9l
bnRyaWVzX3ZhbGlkYXRlZCBhbmQgcGFydGlhbF9mbGFncy4KClRoZSBydWxl
IGlzIHRoYXQgZW50cmllcyBbMCwgbnJfZW50cmllc192YWxpZGF0ZWQpIHNo
b3VsZCBhbHdheXMgYmUKdmFsaWRhdGVkIGFuZCBob2xkIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgY291bnQuICBJZiBwYXJ0aWFsX2ZsYWdzIGlzCnplcm8sIHRo
ZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXSBpcyBub3QgdmFsaWRhdGVkIGFu
ZCBubyByZWZlcmVuY2UKY291bnQgaXMgaGVsZC4gIElmIFBURl9wYXJ0aWFs
X3NldCBpcyBzZXQsIHRoZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXQppcyBw
YXJ0aWFsbHkgdmFsaWRhdGVkLCBhbmQgYSBnZW5lcmFsIHJlZmVyZW5jZSBj
b3VudCBpcyBoZWxkLgoKVW5mb3J0dW5hdGVseSwgaW4gY2FzZXMgd2hlcmUg
YW4gZW50cnkgYmVnYW4gd2l0aCBQVEZfcGFydGlhbF9zZXQgc2V0LAphbmQg
Z2V0X3BhZ2VfZnJvbV9sTmUoKSByZXR1cm5zIC1FSU5WQUwsIHRoZSBQVEZf
cGFydGlhbF9zZXQgYml0IGlzCmVycm9uZW91c2x5IGRyb3BwZWQuICAoVGhp
cyBzY2VuYXJpbyBjYW4gYmUgZW5naW5lZXJlZCBtYWlubHkgYnkgdGhlCnVz
ZSBvZiBpbnRlcmxlYXZpbmcgb2YgcHJvbW90aW5nIGFuZCBkZW1vdGluZyBh
IHBhZ2Ugd2hpY2ggaGFzICJsaW5lYXIKcGFnZXRhYmxlIiBlbnRyaWVzOyBz
ZWUgdGhlIGFwcGVuZGl4IGZvciBhIHNrZXRjaC4pICBUaGlzIG1lYW5zIHRo
YXQKd2Ugd2lsbCAibGVhayIgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBv
biB0aGUgcGFnZSBpbiBxdWVzdGlvbiwKcHJldmVudGluZyB0aGUgcGFnZSBm
cm9tIGJlaW5nIGZyZWVkLgoKRml4IHRoaXMgYnkgc2V0dGluZyBwYWdlLT5w
YXJ0aWFsX2ZsYWdzIHRvIHRoZSBwYXJ0aWFsX2ZsYWdzIGxvY2FsCnZhcmlh
YmxlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTkuCgpSZXBvcnRlZC1ieTog
R2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+Ci0tLS0tCkFwcGVuZGl4CgpTdXBwb3NlIEEgYW5kIEIgY2FuIGJv
dGggYmUgcHJvbW90ZWQgdG8gTDIgcGFnZXMsIGFuZCBBW3hdIHBvaW50cyB0
byBCLgoKVjE6IFBJTl9MMiBCLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1Rf
dmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkCgpWMTog
TU9EX0wzX0VOVFJZIHBvaW50aW5nIHNvbWV0aGluZyB0byBBLgogIEluIHRo
ZSBwcm9jZXNzIG9mIHZhbGlkYXRpbmcgQVt4XSwgZ3JhYiBhbiBleHRyYSB0
eXBlIC8gcmVmIG9uIEI6CiAgQi50eXBlX2NvdW50ID0gMiB8IFBHVF92YWxp
ZGF0ZWQKICBCLmNvdW50ID0gMyB8IFBHQ19hbGxvY2F0ZWQKICBBLnR5cGVf
Y291bnQgPSAxIHwgUEdUX3ZhbGlkYXRlZAogIEEuY291bnQgPSAyIHwgUEdD
X2FsbG9jYXRlZAoKVjE6IFVOUElOIEIuCiAgQi50eXBlX2NvdW50ID0gMSB8
IFBHVF92YWxpZGF0ZQogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAoK
VjE6IE1PRF9MM19FTlRSWSByZW1vdmluZyB0aGUgcmVmZXJlbmNlIHRvIEEu
CiAgRGUtdmFsaWRhdGUgQSwgZG93biB0byBBW3hdLCB3aGljaCBwb2ludHMg
dG8gQi4KICBEcm9wIHRoZSBmaW5hbCB0eXBlIG9uIEIuICBBcnJhbmdlIHRv
IGJlIGludGVycnVwdGVkLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFy
dGlhbAogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAogIEEudHlwZV9j
b3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFsaWRhdGVkX2VudHJp
ZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IC0xCgpWMjogTU9EX0wzX0VOVFJZ
IGFkZHMgYSByZWZlcmVuY2UgdG8gQS4KCkF0IHRoaXMgcG9pbnQsIGdldF9w
YWdlX2Zyb21fbDJlKEFbeF0pIHRyaWVzCmdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKCksIHdoaWNoIGZhaWxzIGJlY2F1c2UgaXQncyB0aGUgd3Jvbmcg
dHlwZTsKYW5kIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKCkgYWxzbyBmYWls
cywgYmVjYXVzZSBCIGlzbid0IHZhbGlkYXRlZCBhcwphbiBsMiBhbnltb3Jl
LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNiArKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCBhNzA4NGNjZmE3Li4zNTUxYjU4OTYzIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTcyNiw3ICsxNzI2LDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAg
ICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKKyAgICAgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKICAg
ICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
TlVMTDsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSA9IHBhZ2U7CiAgICAgICAgICAgICB9CkBAIC0xODIyLDcgKzE4
MjIsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIGlmICggaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOworICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKICAgICAgICAgfQpAQCAtMTkxMiw3ICsxOTEyLDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CisgICAgICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAg
ICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBlbHNl
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0011-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0011-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Transfer-Encoding: base64

RnJvbSA3MmJjNzc2MDBhYTFmNGM2MDFiMzBhZjQ2YWMzZjgwOGM5M2M4Y2E0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDExLzEyXSB4
ODYvbW06IEZpeCBuZXN0ZWQgZGUtdmFsaWRhdGlvbiBvbiBlcnJvcgoKSWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBkaXNjb3ZlcmVkIHdoZW4gdmFsaWRhdGlu
ZyBhIHBhZ2UtdGFibGUgdHJlZSwKdGhlIGVudGlyZSB0cmVlIHdoaWNoIGhh
cyBzbyBmYXIgYmVlbiB2YWxpZGF0ZWQgbXVzdCBiZSBkZS12YWxpZGF0ZWQu
ClNpbmNlIHRoaXMgbWF5IHRha2UgYSBsb25nIHRpbWUsIGFsbG9jX2xbMi00
XV90YWJsZSgpIHNldCBjdXJyZW50CnZjcHUncyBvbGRfZ3Vlc3RfdGFibGUg
aW1tZWRpYXRlbHk7IHB1dF9vbGRfZ3Vlc3RfdGFibGUoKSB3aWxsIG1ha2UK
c3VyZSB0aGF0IHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxlZCB0byBm
aW5pc2ggb2ZmIHRoZQpkZS12YWxpZGF0aW9uIGJlZm9yZSBhbnkgb3RoZXIg
TU1VIG9wZXJhdGlvbnMgY2FuIGhhcHBlbiBvbiB0aGUgdmNwdS4KClRoZSBp
bnZhcmlhbnQgZm9yIHBhcnRpYWwgcGFnZXMgc2hvdWxkIGJlOgoKKiBFbnRy
aWVzIFswLCBucl92YWxpZGF0ZWRfcHRlcykgc2hvdWxkIGJlIGNvbXBsZXRl
bHkgdmFsaWRhdGVkOwogIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGRlLXZhbGlk
YXRlIHRoZXNlLgoKKiBJZiBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHBhcnRp
YWxseSB2YWxpZGF0ZWQsIHBhcnRpYWxfZmxhZ3Mgc2hvdWxkCiAgc2V0IFBU
Rl9wYXJ0aWFMX3NldC4gIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxl
ZCBvbiB0aGlzIHBhZ2UgdG8KICBmaW5pc2ggb2ZmIGRldmFsaWRhdGlvbiwg
YW5kIHRoZSBhcHByb3ByaWF0ZSByZWZjb3VudCBhZGp1c3RtZW50cwogIHdp
bGwgYmUgZG9uZS4KCmFsbG9jX2xbMi0zXV90YWJsZSgpIGluZGljYXRlcyBw
YXJ0aWFsIHZhbGlkYXRpb24gdG8gaXRzIGNhbGxlcnMgYnkKc2V0dGluZyBj
dXJyZW50LT5vbGRfZ3Vlc3RfdGFibGUuCgpVbmZvcnR1bmF0ZWx5LCB0aGlz
IGlzIG1pc2hhbmRsZWQuCgpUYWtlIHRoZSBjYXNlIHdoZXJlIHZhbGlkYXRp
bmcgbE5lW3hdIHJldHVybnMgYW4gZXJyb3IuCgpGaXJzdCwgYWxsb2NfbDNf
dGFibGUoKSBkb2Vzbid0IGNoZWNrIG9sZF9ndWVzdF90YWJsZSBhdCBhbGw7
IGFzIGEKcmVzdWx0LCBwYXJ0aWFsX2ZsYWdzIGlzIG5vdCBzZXQgd2hlbiBp
dCBzaG91bGQgYmUuICBucl92YWxpZGF0ZWRfcHRlcwppcyBzZXQgdG8geDsg
YW5kIHNpbmNlIFBGVF9wYXJ0aWFsX3NldCBjbGVhciwgZGUtdmFsaWRhdGlv
biByZXN1bWVzIGF0Cm5yX3ZhbGlkYXRlZF9wdGVzLTEuICBUaGlzIG1lYW5z
IHRoYXQgdGhlIGwyIHBhZ2UgYXQgcGwzZVt4XSB3aWxsIG5vdApoYXZlIHB1
dF9wYWdlX3R5cGUoKSBjYWxsZWQgb24gaXQgd2hlbiBkZS12YWxpZGF0aW5n
IHRoZSByZXN0IG9mIHRoZQpsMzogaXQgd2lsbCBiZSBzdHVjayBpbiB0aGUg
UEdUX3BhcnRpYWwgc3RhdGUgdW50aWwgdGhlIGRvbWFpbiBpcwpkZXN0cm95
ZWQsIG9yIHVudGlsIGl0IGlzIHJlLXVzZWQgYXMgYW4gbDIuICAoQW55IG90
aGVyIHBhZ2UgdHlwZSB3aWxsCmZhaWwuKQoKV29yc2UsIGFsbG9jX2w0X3Rh
YmxlKCksIHJhdGhlciB0aGFuIHNldHRpbmcgUFRGX3BhcnRpYWxfc2V0IGFz
IGl0CnNob3VsZCwgc2V0cyBucl92YWxpZGF0ZWRfcHRlcyB0byB4KzEuICBX
aGVuIGRlLXZhbGlkYXRpbmcsIHNpbmNlCnBhcnRpYWwgaXMgMCwgdGhpcyB3
aWxsIGNvcnJlY3RseSByZXN1bWUgY2FsbGluZyBwdXRfcGFnZV90eXBlIGF0
IFt4XTsKYnV0LCBpZiB0aGUgcHV0X3BhZ2VfdHlwZSgpIGlzIG5ldmVyIGNh
bGxlZCwgYnV0IGluc3RlYWQKZ2V0X3BhZ2VfdHlwZSgpIGlzIGNhbGxlZCwg
dmFsaWRhdGlvbiB3aWxsIHBpY2sgdXAgYXQgW3grMV0sCm5lZ2xlY3Rpbmcg
dG8gdmFsaWRhdGUgW3hdLiAgSWYgdGhlIHJlc3Qgb2YgdGhlIHZhbGlkYXRp
b24gc3VjY2VlZHMsCnRoZSBsNCB3aWxsIGJlIHZhbGlkYXRlZCBldmVuIHRo
b3VnaCBbeF0gaXMgaW52YWxpZC4KCkZpeCB0aGlzIGluIGJvdGggY2FzZXMg
Ynkgc2V0dGluZyBQVEZfcGFydGlhbF9zZXQgaWYgb2xkX2d1ZXN0X3RhYmxl
CmlzIHNldC4KCldoaWxlIGhlcmUsIGFkZCBzb21lIHNhZmV0eSBjYXRjaGVz
OgotIG9sZF9ndWVzdF90YWJsZSBtdXN0IHBvaW50IHRvIHRoZSBwYWdlIGNv
bnRhaW5lZCBpbgogIFtucl92YWxpZGF0ZWRfcHRlc10uCi0gYWxsb2NfbDFf
cGFnZSBzaG91bGRuJ3Qgc2V0IG9sZF9ndWVzdF90YWJsZQoKSWYgd2UgZXhw
ZXJpZW5jZSBvbmUgb2YgdGhlc2Ugc2l0dWF0aW9ucyBpbiBwcm9kdWN0aW9u
IGJ1aWxkcywgaXQncwpzYWZlciB0byBhdm9pZCBjYWxsaW5nIHB1dF9wYWdl
X3R5cGUgZm9yIHRoZSBwYWdlcyBpbiBxdWVzdGlvbi4gIElmCnRoZXkgaGF2
ZSBQR1RfcGFydGlhbCBzZXQsIHRoZXkgd2lsbCBiZSBjbGVhbmVkIHVwIG9u
IGRvbWFpbgpkZXN0cnVjdGlvbjsgaWYgbm90LCB3ZSBoYXZlIG5vIGlkZWEg
d2hldGhlciBhIHR5cGUgY291bnQgaXMgc2FmZSB0bwpkcm9wLiAgUmV0YWlu
aW5nIGFuIGV4dHJhIHR5cGUgcmVmIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBk
cm9wcGVkIG1heQp0cmlnZ2VyIGEgQlVHKCkgb24gdGhlIGZyZWVfZG9tYWlu
X3BhZ2UoKSBwYXRoLCBidXQgZHJvcHBpbmcgYSB0eXBlCmNvdW50IHRoYXQg
c2hvdWxkbid0IGJlIGRyb3BwZWQgbWF5IGNhdXNlIGEgcHJpdmlsZWdlIGVz
Y2FsYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDU1ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiAx
IGZpbGUgY2hhbmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigt
KQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS5jIGIveGVuL2FyY2gv
eDg2L21tLmMKaW5kZXggMzU1MWI1ODk2My4uODE0ZDEyMzUzYyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysrIGIveGVuL2FyY2gveDg2L21t
LmMKQEAgLTE3MjUsNiArMTcyNSwyMCBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9PSBOVUxMKTsKICAgICAgICAgICAgIGlmICggaSApCiAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAg
ICAgICAgKiBhbGxvY19sMV90YWJsZSgpIGRvZXNuJ3Qgc2V0IG9sZF9ndWVz
dF90YWJsZTsgaXQgZG9lcworICAgICAgICAgICAgICAgICAqIGl0cyBvd24g
dGVhci1kb3duIGltbWVkaWF0ZWx5IG9uIGZhaWx1cmUuICBJZiBpdAorICAg
ICAgICAgICAgICAgICAqIGRpZCB3ZSdkIG5lZWQgdG8gY2hlY2sgaXQgYW5k
IHNldCBwYXJ0aWFsX2ZsYWdzIGFzIHdlCisgICAgICAgICAgICAgICAgICog
ZG8gaW4gYWxsb2NfbFszNF1fdGFibGUoKS4KKyAgICAgICAgICAgICAgICAg
KgorICAgICAgICAgICAgICAgICAqIE5vdGUgb24gdGhlIHVzZSBvZiBBU1NF
UlQ6IGlmIGl0J3Mgbm9uLW51bGwgYW5kCisgICAgICAgICAgICAgICAgICog
aGFzbid0IGJlZW4gY2xlYW5lZCB1cCB5ZXQsIGl0IHNob3VsZCBoYXZlCisg
ICAgICAgICAgICAgICAgICogUEdUX3BhcnRpYWwgc2V0OyBhbmQgc28gdGhl
IHR5cGUgd2lsbCBiZSBjbGVhbmVkIHVwCisgICAgICAgICAgICAgICAgICog
b24gZG9tYWluIGRlc3RydWN0aW9uLiAgVW5mb3J0dW5hdGVseSwgd2Ugd291
bGQKKyAgICAgICAgICAgICAgICAgKiBsZWFrIHRoZSBnZW5lcmFsIHJlZiBo
ZWxkIGJ5IG9sZF9ndWVzdF90YWJsZTsgYnV0CisgICAgICAgICAgICAgICAg
ICogbGVha2luZyBhIHBhZ2UgaXMgbGVzcyBiYWQgdGhhbiBhIGhvc3QgY3Jh
c2guCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgQVNT
RVJUKGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwog
ICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
ICAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlh
bF9mbGFnczsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF9wdHBnID0gTlVMTDsKQEAgLTE3NTgsNiArMTc3Miw3IEBAIHN0YXRp
YyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkK
ICAgICB1bnNpZ25lZCBpbnQgICBpOwogICAgIGludCAgICAgICAgICAgIHJj
ID0gMDsKICAgICB1bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFn
ZS0+cGFydGlhbF9mbGFnczsKKyAgICBsM19wZ2VudHJ5X3QgICBsM2UgPSBs
M2VfZW1wdHkoKTsKIAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21m
bihwZm4pKTsKIApAQCAtMTgwOSw3ICsxODI0LDExIEBAIHN0YXRpYyBpbnQg
YWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAg
ICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlm
ICggcmMgPCAwICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogWFNBLTI5
OSBCYWNrcG9ydDogQ29weSBsM2UgZm9yIGNoZWNraW5nICovCisgICAgICAg
ICAgICBsM2UgPSBwbDNlW2ldOwogICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KIAogICAgICAgICBhZGp1c3RfZ3Vlc3RfbDNlKHBsM2VbaV0sIGQp
OwogICAgIH0KQEAgLTE4MjMsNiArMTg0MiwyNCBAQCBzdGF0aWMgaW50IGFs
bG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAg
IHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
ICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2Zs
YWdzOworICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLyoK
KyAgICAgICAgICAgICAgICAgKiBXZSd2ZSBleHBlcmllbmNlZCBhIHZhbGlk
YXRpb24gZmFpbHVyZS4gIElmCisgICAgICAgICAgICAgICAgICogb2xkX2d1
ZXN0X3RhYmxlIGlzIHNldCwgInRyYW5zZmVyIiB0aGUgZ2VuZXJhbAorICAg
ICAgICAgICAgICAgICAqIHJlZmVyZW5jZSBjb3VudCB0byBwbDNlW25yX3Zh
bGlkYXRlZF9wdGVzXSBieQorICAgICAgICAgICAgICAgICAqIHNldHRpbmcg
UFRGX3BhcnRpYWxfc2V0LgorICAgICAgICAgICAgICAgICAqCisgICAgICAg
ICAgICAgICAgICogQXMgYSBwcmVjYXV0aW9uLCBjaGVjayB0aGF0IG9sZF9n
dWVzdF90YWJsZSBpcyB0aGUKKyAgICAgICAgICAgICAgICAgKiBwYWdlIHBv
aW50ZWQgdG8gYnkgcGwzZVtucl92YWxpZGF0ZWRfcHRlc10uICBJZgorICAg
ICAgICAgICAgICAgICAqIG5vdCwgaXQncyBzYWZlciB0byBsZWFrIGEgdHlw
ZSByZWYgb24gcHJvZHVjdGlvbgorICAgICAgICAgICAgICAgICAqIGJ1aWxk
cy4KKyAgICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgICAgICBpZiAo
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IGwzZV9nZXRfcGFn
ZShsM2UpICkKKyAgICAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgICAgICBlbHNl
CisgICAgICAgICAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOwor
ICAgICAgICAgICAgfQogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CiAgICAgICAgIH0KQEAgLTE5MTgs
NyArMTk1NSwyMyBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICAgICAgZWxzZQogICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCi0gICAgICAgICAgICAgICAg
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcysrOworICAgICAgICAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICAgICAgICAvKgorICAg
ICAgICAgICAgICAgICAgICAgICAgICogV2UndmUgZXhwZXJpZW5jZWQgYSB2
YWxpZGF0aW9uIGZhaWx1cmUuICBJZgorICAgICAgICAgICAgICAgICAgICAg
ICAgICogb2xkX2d1ZXN0X3RhYmxlIGlzIHNldCwgInRyYW5zZmVyIiB0aGUg
Z2VuZXJhbAorICAgICAgICAgICAgICAgICAgICAgICAgICogcmVmZXJlbmNl
IGNvdW50IHRvIHBsM2VbbnJfdmFsaWRhdGVkX3B0ZXNdIGJ5CisgICAgICAg
ICAgICAgICAgICAgICAgICAgKiBzZXR0aW5nIFBURl9wYXJ0aWFsX3NldC4K
KyAgICAgICAgICAgICAgICAgICAgICAgICAqCisgICAgICAgICAgICAgICAg
ICAgICAgICAgKiBBcyBhIHByZWNhdXRpb24sIGNoZWNrIHRoYXQgb2xkX2d1
ZXN0X3RhYmxlIGlzIHRoZQorICAgICAgICAgICAgICAgICAgICAgICAgICog
cGFnZSBwb2ludGVkIHRvIGJ5IHBsNGVbbnJfdmFsaWRhdGVkX3B0ZXNdLiAg
SWYKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIG5vdCwgaXQncyBzYWZl
ciB0byBsZWFrIGEgdHlwZSByZWYgb24gcHJvZHVjdGlvbgorICAgICAgICAg
ICAgICAgICAgICAgICAgICogYnVpbGRzLgorICAgICAgICAgICAgICAgICAg
ICAgICAgICovCisgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IGw0ZV9nZXRfcGFnZShwbDRl
W2ldKSApCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZS0+cGFy
dGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgICAg
ICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBB
U1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICAgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9w
dHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICAgICAgICAgIH0K
LS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.8/0012-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Disposition: attachment;
 filename="xsa299-4.8/0012-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Transfer-Encoding: base64

RnJvbSAxNWY0M2ZmNmYwZjA4ZDY0NDk1NzQ5ZDNjMmU3ZDQyMzBlZjhiNjMy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NTAgKzAxMDAKU3ViamVjdDogW1BBVENIIDEyLzEyXSB4
ODYvbW06IERvbid0IGRyb3AgYSB0eXBlIHJlZiB1bmxlc3MgeW91IGhlbGQg
YSByZWYgdG8KIGJlZ2luIHdpdGgKClZhbGlkYXRpb24gYW5kIGRlLXZhbGlk
YXRpb24gb2YgcGFnZXRhYmxlIHRyZWVzIG1heSB0YWtlIGFyYml0cmFyaWx5
CmxhcmdlIGFtb3VudHMgb2YgdGltZSwgYW5kIHNvIG11c3QgYmUgcHJlZW1w
dGlibGUuICBUaGlzIGlzIGluZGljYXRlZApieSBzZXR0aW5nIHRoZSBQR1Rf
cGFydGlhbCBiaXQgaW4gdGhlIHR5cGVfaW5mbywgYW5kIHNldHRpbmcKbnJf
dmFsaWRhdGVkX2VudHJpZXMgYW5kIHBhcnRpYWxfZmxhZ3MgYXBwcm9wcmlh
dGVseS4gIFNwZWNpZmljYWxseSwKaWYgdGhlIGVudHJ5IGF0IFtucl92YWxp
ZGF0ZWRfZW50cmllc10gaXMgcGFydGlhbGx5IHZhbGlkYXRlZCwKcGFydGlh
bF9mbGFncyBzaG91bGQgaGF2ZSB0aGUgUEdUX3BhcnRpYWxfc2V0IGJpdCBz
ZXQsIGFuZCB0aGUgZW50cnkKc2hvdWxkIGhvbGQgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudC4gIER1cmluZyBkZS12YWxpZGF0aW9uLApwdXRfcGFnZV90
eXBlKCkgaXMgY2FsbGVkIG9uIHBhcnRpYWxseSB2YWxpZGF0ZWQgZW50cmll
cy4KClVuZm9ydHVuYXRlbHksIHRoZXJlIGFyZSBhIG51bWJlciBvZiBpc3N1
ZXMgd2l0aCB0aGUgY3VycmVudCBhbGdvcml0aG0uCgpGaXJzdCwgZG9pbmcg
YSAibm9ybWFsIiBwdXRfcGFnZV90eXBlKCkgaXMgbm90IHNhZmUgd2hlbiBu
byB0eXBlIHJlZgppcyBoZWxkOiB0aGVyZSBpcyBub3RoaW5nIHRvIHN0b3Ag
YW5vdGhlciB2Y3B1IGZyb20gY29taW5nIGFsb25nIGFuZApwaWNraW5nIHVw
IHZhbGlkYXRpb24gYWdhaW46IGF0IHdoaWNoIHBvaW50IHRoZSBwdXRfcGFn
ZV90eXBlIG1heSBkcm9wCnRoZSBvbmx5IHBhZ2UgcmVmIG9uIGFuIGluLXVz
ZSBwYWdlLiAgU29tZSBleGFtcGxlcyBhcmUgbGlzdGVkIGluIHRoZQphcHBl
bmRpeC4KClRoZSBjb3JlIGlzc3VlIGlzIHRoYXQgcHV0X3BhZ2VfdHlwZSgp
IGlzIGJlaW5nIGNhbGxlZCBib3RoIHRvIGNsZWFuCnVwIFBHVF9wYXJ0aWFs
LCBhbmQgdG8gZHJvcCBhIHR5cGUgY291bnQ7IGFuZCBoYXMgbm8gd2F5IG9m
IGtub3dpbmcKd2hpY2ggaXMgd2hpY2g7IGFuZCBzbyBpZiBpbiBiZXR3ZWVu
LCBQR1RfcGFydGlhbCBpcyBjbGVhcmVkLApwdXRfcGFnZV90eXBlKCkgd2ls
bCBkcm9wIHRoZSB0eXBlIHJlZiBlcnJvbmVvdXNseS4KCldoYXQgaXMgbmVl
ZGVkIGlzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIHN0YXRlczoKLSBE
cm9wcGluZyBhIHR5cGUgcmVmIHdoaWNoIGlzIGhlbGQKLSBDbGVhbmluZyB1
cCBhIHBhZ2Ugd2hpY2ggaGFzIGJlZW4gcGFydGlhbGx5IGRlL3ZhbGlkYXRl
ZAoKRml4IHRoaXMgYnkgdGVsbGluZyBwdXRfcGFnZV90eXBlKCkgd2hpY2gg
b2YgdGhlIHR3byBhY3Rpdml0aWVzIHlvdQppbnRlbmQuCgpXaGVuIGNsZWFu
aW5nIHVwIGEgcGFydGlhbCBkZS92YWxpZGF0aW9uLCB0YWtlIG5vIGFjdGlv
biB1bmxlc3MgeW91CmZpbmQgYSBwYWdlIHBhcnRpYWxseSB2YWxpZGF0ZWQu
CgpJZiBwdXRfcGFnZV90eXBlKCkgaXMgY2FsbGVkIHdpdGhvdXQgUFRGX3Bh
cnRpYWxfc2V0LCBhbmQgZmluZHMgdGhlCnBhZ2UgaW4gYSBQR1RfcGFydGlh
bCBzdGF0ZSBhbnl3YXksIHRoZW4gdGhlcmUncyBjZXJ0YWlubHkgYmVlbiBh
Cm1pc2FjY291bnRpbmcgc29tZXdoZXJlLCBhbmQgY2Fycnlpbmcgb24gd291
bGQgYWxtb3N0IGNlcnRhaW5seSBjYXVzZQphIHNlY3VyaXR5IGlzc3VlLCBz
byBjcmFzaCB0aGUgaG9zdCBpbnN0ZWFkLgoKSW4gcHV0X3BhZ2VfZnJvbV9s
TmUsIHBhc3MgcGFydGlhbF9mbGFncyBvbiB0byBfcHV0X3BhZ2VfdHlwZSgp
LgoKb2xkX2d1ZXN0X3RhYmxlIG1heSBiZSBzZXQgZWl0aGVyIHdpdGggYSBm
dWxseSB2YWxpZGF0ZWQgcGFnZSAod2hlbgp1c2luZyB0aGUgImRlZmVycmVk
IHB1dCIgcGF0dGVybiksIG9yIHdpdGggYSBwYXJ0aWFsbHkgdmFsaWRhdGVk
IHBhZ2UKKHdoZW4gYSBub3JtYWwgImRlLXZhbGlkYXRpb24iIGlzIGludGVy
cnVwdGVkLCBvciB3aGVuIGEgdmFsaWRhdGlvbgpmYWlscyBwYXJ0LXdheSB0
aHJvdWdoIGR1ZSB0byBpbnZhbGlkIGVudHJpZXMpLiAgQWRkIGEgZmxhZywK
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwsIHRvIGluZGljYXRlIHdoaWNoIG9m
IHRoZXNlIGl0IGlzLCBhbmQgdXNlCnRoYXQgdG8gcGFzcyB0aGUgYXBwcm9w
cmlhdGUgZmxhZyB0byBfcHV0X3BhZ2VfdHlwZSgpLgoKV2hpbGUgaGVyZSwg
ZGVsZXRlIHN0cmF5IHRyYWlsaW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tLS0KQXBw
ZW5kaXg6CgpTdXBwb3NlIHBhZ2UgQSwgd2hlbiBpbnRlcnByZXRlZCBhcyBh
biBsMyBwYWdldGFibGUsIGNvbnRhaW5zIGFsbAp2YWxpZCBlbnRyaWVzOyBh
bmQgc3VwcG9zZSBBW3hdIHBvaW50cyB0byBwYWdlIEIsIHdoaWNoIHdoZW4K
aW50ZXJwcmV0ZWQgYXMgYW4gbDIgcGFnZXRhYmxlLCBjb250YWlucyBhbGwg
dmFsaWQgZW50cmllcy4KClAxOiBQSU5fTDNfVEFCTEUKICBBIC0+IFBHVF9s
M190YWJsZSB8IDEgfCB2YWxpZAogIEIgLT4gUEdUX2wyX3RhYmxlIHwgMSB8
IHZhbGlkCgpQMTogVU5QSU5fVEFCTEUKICA+IEFycmFuZ2UgdG8gaW50ZXJy
dXB0IGFmdGVyIEIgaGFzIGJlZW4gZGUtdmFsaWRhdGVkCiAgQjoKICAgIHR5
cGVfaW5mbyAtPiBQR1RfbDJfdGFibGUgfCAwCiAgQToKICAgIHR5cGVfaW5m
byAtPiBQR1RfbDNfdGFibGUgfCAxIHwgcGFydGlhbAogICAgbnJfdmFsaWRh
dGVkX2VudGllcyAtPiAobGVzcyB0aGFuIHgpCgpQMjogbW9kX2w0X2VudHJ5
IHRvIHBvaW50IHRvIEEKICA+IEFycmFuZ2UgZm9yIHRoaXMgdG8gYmUgaW50
ZXJydXB0ZWQgd2hpbGUgQiBpcyBiZWluZyB2YWxpZGF0ZWQKICBCOgogICAg
dHlwZV9pbmZvIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBwYXJ0aWFsCiAgICAo
bnJfdmFsaWRhdGVkX2VudGlyZXMgJmMgc2V0IGFzIGFwcHJvcHJpYXRlKQog
IEE6CiAgICB0eXBlX2luZm8gLT4gUEdUX2wzX3RhYmxlIHwgMSB8IHBhcnRp
YWwKICAgIG5yX3ZhbGlkYXRlZF9lbnRyaWVzIC0+IHgKICAgIHBhcnRpYWxf
cHRlID0gMQoKUDM6IG1vZF9sM19lbnRyeSBzb21lIG90aGVyIHVucmVsYXRl
ZCBsMyB0byBwb2ludCB0byBCOgogIEI6CiAgICB0eXBlX2luZm8gLT4gUEdU
X2wyX3RhYmxlIHwgMQoKUDE6IFJlc3RhcnQgVU5QSU5fVEFCTEUKCkF0IHRo
aXMgcG9pbnQsIHNpbmNlIEEubnJfdmFsaWRhdGVfZW50cmllcyA9PSB4IGFu
ZCBBLnBhcnRpYWxfcHRlICE9CjAsIGZyZWVfbDNfdGFibGUoKSB3aWxsIGNh
bGwgcHV0X3BhZ2VfZnJvbV9sM2UoKSBvbiBwbDNlW3hdLCBkcm9wcGluZwpp
dHMgdHlwZSBjb3VudCB0byAwIHdoaWxlIGl0J3Mgc3RpbGwgYmVpbmcgcG9p
bnRlZCB0byBieSBzb21lIG90aGVyIGwzCgpBIHNpbWlsYXIgaXNzdWUgYXJp
c2VzIHdpdGggb2xkX2d1ZXN0X3RhYmxlLiAgQ29uc2lkZXIgdGhlIGZvbGxv
d2luZwpzY2VuYXJpbzoKClN1cHBvc2UgQSBpcyBhIHBhZ2Ugd2hpY2gsIHdo
ZW4gaW50ZXJwcmV0ZWQgYXMgYW4gbDIsIGhhcyB2YWxpZCBlbnRyaWVzCnVu
dGlsIGVudHJ5IHgsIHdoaWNoIGlzIGludmFsaWQuCgpWMTogIFBJTl9MMl9U
QUJMRShBKQogIDxWYWxpZGF0ZSB1bnRpbCB3ZSB0cnkgdG8gdmFsaWRhdGUg
W3hdLCBnZXQgLUVJTlZBTD4KICBBIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBQ
R1RfcGFydGlhbAogIFYxIC0+IG9sZF9ndWVzdF90YWJsZSA9IEEKICA8ZGVs
YXllZD4KClYyOiBQSU5fTDJfVEFCTEUoQSkKICA8UGljayB1cCB3aGVyZSBW
MSBsZWZ0IG9mZiwgdHJ5IHRvIHJlLXZhbGlkYXRlIFt4XSwgZ2V0IC1FSU5W
QUw+CiAgQSAtPiBQR1RfbDJfdGFibGUgfCAxIHwgUEdUX3BhcnRpYWwKICBW
MiAtPiBvbGRfZ3Vlc3RfdGFibGUgPSBBCiAgPHJlc3RhcnQ+CiAgcHV0X29s
ZF9ndWVzdF90YWJsZSgpCiAgICBfcHV0X3BhZ2VfdHlwZShBKQogICAgICBB
IC0+IFBHVF9sMl90YWJsZSB8IDAKClYxOiA8cmVzdGFydD4KICBwdXRfb2xk
X2d1ZXN0X3RhYmxlKCkKICAgIF9wdXRfcGFnZV90eXBlKEEpICMgVU5ERVJG
TE9XCgpJbmRlZWQsIGl0IGlzIHBvc3NpYmxlIHRvIGVuZ2luZWVyIGZvciBv
bGRfZ3Vlc3RfdGFibGUgZm9yIGV2ZXJ5IHZjcHUKYSBndWVzdCBoYXMgdG8g
cG9pbnQgdG8gdGhlIHNhbWUgcGFnZS4KLS0tCiB4ZW4vYXJjaC94ODYvZG9t
YWluLmMgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAg
ICAgICAgIHwgOTggKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oIHwgIDQgKy0KIDMg
ZmlsZXMgY2hhbmdlZCwgOTQgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IDQwMGVmYmFkMTQuLjhiMDAzMGU5
NWEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTEzODYsOSArMTM4NiwxNSBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICAgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0
aHJvdWdoICovCiAgICAgICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6Cisg
ICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICAgICAq
IE5CIHRoYXQgd2UncmUgcHV0dGluZyB0aGUga2VybmVsLW1vZGUgdGFibGUK
KyAgICAgICAgICAgICAgICAgICAgICogaGVyZSwgd2hpY2ggd2UndmUgYWxy
ZWFkeSBzdWNjZXNzZnVsbHkKKyAgICAgICAgICAgICAgICAgICAgICogdmFs
aWRhdGVkIGFib3ZlOyBoZW5jZSBwYXJ0aWFsID0gZmFsc2U7CisgICAgICAg
ICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgICB2LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPQogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZXRhYmxlX2dldF9wYWdlKHYtPmFyY2guZ3Vlc3RfdGFibGUp
OworICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgIHYtPmFy
Y2guZ3Vlc3RfdGFibGUgPSBwYWdldGFibGVfbnVsbCgpOwogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0Ogpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA4MTRkMTIzNTNjLi5iNWNhNTAzMWE4IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTUxNCwxMCArMTUxNCwxMSBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gcHRwZzsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgIH0K
ICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOworICAg
ICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHko
IXJjKSApCiAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAg
ICB9CkBAIC0xNTQwLDYgKzE1NDEsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdl
X2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZu
LAogICAgICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwzZV9nZXRfcGZuKGwz
ZSk7CiAgICAgICAgIGludCB3cml0ZWFibGUgPSBsM2VfZ2V0X2ZsYWdzKGwz
ZSkgJiBfUEFHRV9SVzsKIAorICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBBU1NFUlQoIShtZm4gJiAoKDFV
TCA8PCAoTDNfUEFHRVRBQkxFX1NISUZUIC0gUEFHRV9TSElGVCkpIC0gMSkp
KTsKICAgICAgICAgZG8gewogICAgICAgICAgICAgcHV0X2RhdGFfcGFnZSht
Zm5fdG9fcGFnZShtZm4pLCB3cml0ZWFibGUpOwpAQCAtMTU1MiwxMiArMTU1
NCwxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50
cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgaWYgKCBmbGFn
cyAmIFBURl9kZWZlciApCiAgICAgeworICAgICAgICBBU1NFUlQoIShmbGFn
cyAmIFBURl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UocGZuKTsKICAgICAgICAg
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKKyAgICAgICAg
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IGZhbHNl
OwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAgICByYyA9IF9wdXRf
cGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKHBm
bikpOworICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZsYWdzIHwgUFRG
X3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKICAgICBpZiAoIGxp
a2VseSghcmMpICkKICAgICAgICAgcHV0X3BhZ2UocGcpOwogCkBAIC0xNTc2
LDEyICsxNTgwLDE0IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUo
bDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAKICAgICAg
ICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKKyAgICAg
ICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSk7CiAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZu
X3RvX3BhZ2UocGZuKTsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAg
ICByZXR1cm4gMDsKICAgICAgICAgfQogCi0gICAgICAgIHJjID0gX3B1dF9w
YWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UocGZu
KSk7CisgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZsYWdzIHwg
UFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKICAgICAgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAgICAgICBwdXRfcGFnZShwZyk7
CiAgICAgfQpAQCAtMTY4OSw2ICsxNjk1LDE0IEBAIHN0YXRpYyBpbnQgYWxs
b2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQg
bG9uZyB0eXBlKQogCiAgICAgcGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZu
KHBmbikpOwogCisgICAgLyoKKyAgICAgKiBOQiB0aGF0IGFsbG9jX2wyX3Rh
YmxlIHdpbGwgbmV2ZXIgc2V0IHBhcnRpYWxfcHRlIG9uIGFuIGwyOyBidXQK
KyAgICAgKiBmcmVlX2wyX3RhYmxlIG1pZ2h0IGlmIGEgbGluZWFyX3BhZ2V0
YWJsZSBlbnRyeSBpcyBpbnRlcnJ1cHRlZAorICAgICAqIHBhcnR3YXkgdGhy
b3VnaCBkZS12YWxpZGF0aW9uLiAgSW4gdGhhdCBjaXJjdW1zdGFuY2UsCisg
ICAgICogZ2V0X3BhZ2VfZnJvbV9sMmUoKSB3aWxsIGFsd2F5cyByZXR1cm4g
LUVJTlZBTDsgYW5kIHdlIG11c3QKKyAgICAgKiByZXRhaW4gdGhlIHR5cGUg
cmVmIGJ5IGRvaW5nIHRoZSBub3JtYWwgcGFydGlhbF9mbGFncyB0cmFja2lu
Zy4KKyAgICAgKi8KKwogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlczsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTOwogICAgICAgICAg
IGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQogICAgIHsKQEAgLTE3NDMsNiAr
MTc1Nyw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzOwog
ICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcg
PSBOVUxMOwogICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1
ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgICAgICBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gdHJ1ZTsKICAgICAgICAg
ICAgIH0KICAgICAgICAgfQogICAgICAgICBpZiAoIHJjIDwgMCApCkBAIC0x
ODU2LDEyICsxODcxLDE2IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUo
c3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICAgKiBi
dWlsZHMuCiAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAg
aWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBsM2VfZ2V0
X3BhZ2UobDNlKSApCisgICAgICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgICAgICBBU1NFUlQoY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVf
cGFydGlhbCk7CiAgICAgICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxf
ZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CisgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgQVNT
RVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsK
KyAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3Bh
cnRpYWwgPSB0cnVlOwogICAgICAgICB9CiAgICAgICAgIHdoaWxlICggaS0t
ID4gMCApCiAgICAgICAgIHsKQEAgLTE5NjgsMTIgKzE5ODcsMTYgQEAgc3Rh
dGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogICAgICAgICAgICAgICAgICAgICAgICAgICogYnVpbGRzLgogICAgICAg
ICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAoIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IGw0ZV9n
ZXRfcGFnZShwbDRlW2ldKSApCisgICAgICAgICAgICAgICAgICAgICAgICB7
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVNTRVJUKGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwpOwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFy
dGlhbF9zZXQ7CisgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAg
ICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlh
bCA9IHRydWU7CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgfQog
ICAgICAgICB9CkBAIC0yOTA4LDYgKzI5MzEsMjggQEAgc3RhdGljIGludCBf
cHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25l
ZCBpbnQgZmxhZ3MsCiAgICAgICAgIHggID0geTsKICAgICAgICAgbnggPSB4
IC0gMTsKIAorICAgICAgICAvKgorICAgICAgICAgKiBJcyB0aGlzIGV4cGVj
dGVkIHRvIGRvIGEgZnVsbCByZWZlcmVuY2UgZHJvcCwgb3Igb25seQorICAg
ICAgICAgKiBjbGVhbnVwIHBhcnRpYWwgdmFsaWRhdGlvbiAvIGRldmFsaWRh
dGlvbj8KKyAgICAgICAgICoKKyAgICAgICAgICogSWYgdGhlIGZvcm1lciwg
dGhlIGNhbGxlciBtdXN0IGhvbGQgYSAiZnVsbCIgdHlwZSByZWY7CisgICAg
ICAgICAqIHdoaWNoIG1lYW5zIHRoZSBwYWdlIG11c3QgYmUgdmFsaWRhdGVk
LiAgSWYgdGhlIHBhZ2UgaXMKKyAgICAgICAgICogKm5vdCogZnVsbHkgdmFs
aWRhdGVkLCBjb250aW51aW5nIHdvdWxkIGFsbW9zdCBjZXJ0YWlubHkKKyAg
ICAgICAgICogb3BlbiB1cCBhIHNlY3VyaXR5IGhvbGUuICBBbiBleGNlcHRp
b24gdG8gdGhpcyBpcyBkdXJpbmcKKyAgICAgICAgICogZG9tYWluIGRlc3Ry
dWN0aW9uLCB3aGVyZSBQR1RfdmFsaWRhdGVkIGNhbiBiZSBkcm9wcGVkCisg
ICAgICAgICAqIHdpdGhvdXQgZHJvcHBpbmcgYSB0eXBlIHJlZi4KKyAgICAg
ICAgICoKKyAgICAgICAgICogSWYgdGhlIGxhdHRlciwgZG8gbm90aGluZyB1
bmxlc3MgdHlwZSBQR1RfcGFydGlhbCBpcyBzZXQuCisgICAgICAgICAqIElm
IGl0IGlzIHNldCwgdGhlIHR5cGUgY291bnQgbXVzdCBiZSAxLgorICAgICAg
ICAgKi8KKyAgICAgICAgaWYgKCAhKGZsYWdzICYgUFRGX3BhcnRpYWxfc2V0
KSApCisgICAgICAgICAgICBCVUdfT04oKHggJiBQR1RfcGFydGlhbCkgfHwK
KyAgICAgICAgICAgICAgICAgICAhKCh4ICYgUEdUX3ZhbGlkYXRlZCkgfHwg
cGFnZV9nZXRfb3duZXIocGFnZSktPmlzX2R5aW5nKSk7CisgICAgICAgIGVs
c2UgaWYgKCAhKHggJiBQR1RfcGFydGlhbCkgKQorICAgICAgICAgICAgcmV0
dXJuIDA7CisgICAgICAgIGVsc2UKKyAgICAgICAgICAgIEJVR19PTigoeCAm
IFBHVF9jb3VudF9tYXNrKSAhPSAxKTsKKwogICAgICAgICBBU1NFUlQoKHgg
JiBQR1RfY291bnRfbWFzaykgIT0gMCk7CiAKICAgICAgICAgaWYgKCB1bmxp
a2VseSgobnggJiBQR1RfY291bnRfbWFzaykgPT0gMCkgKQpAQCAtMzM0NSwx
NyArMzM5MCwzNCBAQCBpbnQgcHV0X29sZF9ndWVzdF90YWJsZShzdHJ1Y3Qg
dmNwdSAqdikKICAgICBpZiAoICF2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSAp
CiAgICAgICAgIHJldHVybiAwOwogCi0gICAgc3dpdGNoICggcmMgPSBfcHV0
X3BhZ2VfdHlwZSh2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSwgUFRGX3ByZWVt
cHRpYmxlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi0+
YXJjaC5vbGRfZ3Vlc3RfcHRwZykgKQorICAgIHJjID0gX3B1dF9wYWdlX3R5
cGUodi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUsCisgICAgICAgICAgICAgICAg
ICAgICAgICBQVEZfcHJlZW1wdGlibGUgfAorICAgICAgICAgICAgICAgICAg
ICAgICAgKCB2LT5hcmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID8KKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0IDogMCAp
LAorICAgICAgICAgICAgICAgICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3Rf
cHRwZyk7CisKKyAgICBpZiAoIHJjID09IC1FUkVTVEFSVCB8fCByYyA9PSAt
RUlOVFIgKQogICAgIHsKLSAgICBjYXNlIC1FSU5UUjoKLSAgICBjYXNlIC1F
UkVTVEFSVDoKKyAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbCA9IChyYyA9PSAtRVJFU1RBUlQpOwogICAgICAgICByZXR1cm4gLUVS
RVNUQVJUOwotICAgIGNhc2UgMDoKLSAgICAgICAgcHV0X3BhZ2Uodi0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUpOwogICAgIH0KIAorICAgIC8qCisgICAgICog
SXQgc2hvdWxkbid0IGJlIHBvc3NpYmxlIGZvciBfcHV0X3BhZ2VfdHlwZSgp
IHRvIHJldHVybgorICAgICAqIGFueXRoaW5nIGVsc2UgYXQgdGhlIG1vbWVu
dDsgYnV0IGlmIGl0IGRvZXMgaGFwcGVuIGluCisgICAgICogcHJvZHVjdGlv
biwgbGVha2luZyB0aGUgdHlwZSByZWYgaXMgcHJvYmFibHkgdGhlIGJlc3Qg
dGhpbmcgdG8KKyAgICAgKiBkby4gIEVpdGhlciB3YXksIGRyb3AgdGhlIGdl
bmVyYWwgcmVmIGhlbGQgYnkgb2xkX2d1ZXN0X3RhYmxlLgorICAgICAqLwor
ICAgIEFTU0VSVChyYyA9PSAwKTsKKworICAgIHB1dF9wYWdlKHYtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlKTsKICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZSA9IE5VTEw7CisgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7
CisgICAgLyoKKyAgICAgKiBTYWZlc3QgZGVmYXVsdCBpZiBzb21lb25lIHNl
dHMgb2xkX2d1ZXN0X3RhYmxlIHdpdGhvdXQKKyAgICAgKiBleHBsaWNpdGx5
IHNldHRpbmcgb2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwuCisgICAgICovCisg
ICAgdi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IHRydWU7CiAK
ICAgICByZXR1cm4gcmM7CiB9CkBAIC0zNTA3LDExICszNTY5LDExIEBAIGlu
dCBuZXdfZ3Vlc3RfY3IzKHVuc2lnbmVkIGxvbmcgbWZuKQogICAgICAgICAg
ICAgc3dpdGNoICggcmMgPSBwdXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJs
ZShwYWdlKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICBjYXNlIC1F
SU5UUjoKLSAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKLSAgICAg
ICAgICAgICAgICAvKiBmYWxsdGhyb3VnaCAqLwogICAgICAgICAgICAgY2Fz
ZSAtRVJFU1RBUlQ6CiAgICAgICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgY3Vyci0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOworICAgICAgICAgICAgICAgIGN1
cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSAocmMgPT0gLUVS
RVNUQVJUKTsKKyAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAg
ICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgIGRlZmF1bHQ6CiAg
ICAgICAgICAgICAgICAgQlVHX09OKHJjKTsKQEAgLTM3ODEsNiArMzg0Myw3
IEBAIGxvbmcgZG9fbW11ZXh0X29wKAogICAgICAgICAgICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnIt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgICAg
ICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwg
PSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgIH0KQEAgLTM4MTYsNiArMzg3OSwxMSBAQCBs
b25nIGRvX21tdWV4dF9vcCgKICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJU
OgogICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcg
PSBOVUxMOwogICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0
X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgICAgICAvKgorICAgICAgICAg
ICAgICAgICAqIEVJTlRSIG1lYW5zIHdlIHN0aWxsIGhvbGQgdGhlIHR5cGUg
cmVmOyBFUkVTVEFSVAorICAgICAgICAgICAgICAgICAqIG1lYW5zIFBHVF9w
YXJ0aWFsIGhvbGRzIHRoZSB0eXBlIHJlZgorICAgICAgICAgICAgICAgICAq
LworICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxl
X3BhcnRpYWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKICAgICAgICAgICAgICAg
ICByYyA9IDA7CiAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg
ICBkZWZhdWx0OgpAQCAtMzg5MCwxMSArMzk1OCwxNSBAQCBsb25nIGRvX21t
dWV4dF9vcCgKICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICggcmMgPSBw
dXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJsZShwYWdlKSApCiAgICAgICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgY2FzZSAtRUlO
VFI6Ci0gICAgICAgICAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsK
LSAgICAgICAgICAgICAgICAgICAgICAgIC8qIGZhbGx0aHJvdWdoICovCiAg
ICAgICAgICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJUOgogICAgICAgICAg
ICAgICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5V
TEw7CiAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICAgICAgICAgICAgICAv
KgorICAgICAgICAgICAgICAgICAgICAgICAgICogRUlOVFIgbWVhbnMgd2Ug
c3RpbGwgaG9sZCB0aGUgdHlwZSByZWY7CisgICAgICAgICAgICAgICAgICAg
ICAgICAgKiBFUkVTVEFSVCBtZWFucyBQR1RfcGFydGlhbCBob2xkcyB0aGUg
cmVmCisgICAgICAgICAgICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAg
ICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRp
YWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKKyAgICAgICAgICAgICAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICAgICAgICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg
ICAgICAgICAgICAgICAgICBCVUdfT04ocmMpOwpkaWZmIC0tZ2l0IGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvZG9tYWluLmgKaW5kZXggMDEzNzI4MzhlYy4uMzcyYTE1N2I3MCAxMDA2
NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaAorKysgYi94
ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oCkBAIC0zNDIsNyArMzQyLDcg
QEAgc3RydWN0IGFyY2hfZG9tYWluCiAKICAgICBzdHJ1Y3QgcGFnaW5nX2Rv
bWFpbiBwYWdpbmc7CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybTsKLSAg
ICAvKiBUbyBlbmZvcmNlIGxvY2sgb3JkZXJpbmcgaW4gdGhlIHBvZCBjb2Rl
IHdydCB0aGUgCisgICAgLyogVG8gZW5mb3JjZSBsb2NrIG9yZGVyaW5nIGlu
IHRoZSBwb2QgY29kZSB3cnQgdGhlCiAgICAgICogcGFnZV9hbGxvYyBsb2Nr
ICovCiAgICAgaW50IHBhZ2VfYWxsb2NfdW5sb2NrX2xldmVsOwogCkBAIC01
NzYsNiArNTc2LDggQEAgc3RydWN0IGFyY2hfdmNwdQogICAgIHN0cnVjdCBw
YWdlX2luZm8gKm9sZF9ndWVzdF90YWJsZTsgIC8qIHBhcnRpYWxseSBkZXN0
cnVjdGVkIHBhZ2V0YWJsZSAqLwogICAgIHN0cnVjdCBwYWdlX2luZm8gKm9s
ZF9ndWVzdF9wdHBnOyAgIC8qIGNvbnRhaW5pbmcgcGFnZSB0YWJsZSBvZiB0
aGUgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAvKiBmb3JtZXIsIGlmIGFueSAqLworICAgIGJvb2wgb2xkX2d1ZXN0X3Rh
YmxlX3BhcnRpYWw7ICAgICAgIC8qIEFyZSB3ZSBkcm9wcGluZyBhIHR5cGUg
cmVmLCBvciBqdXN0CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICogZmluaXNoaW5nIHVwIGEgcGFydGlhbCBkZS12YWxpZGF0
aW9uPyAqLwogICAgIC8qIGd1ZXN0X3RhYmxlIGhvbGRzIGEgcmVmIHRvIHRo
ZSBwYWdlLCBhbmQgYWxzbyBhIHR5cGUtY291bnQgdW5sZXNzCiAgICAgICog
c2hhZG93IHJlZmNvdW50cyBhcmUgaW4gdXNlICovCiAgICAgcGFnZXRhYmxl
X3Qgc2hhZG93X3RhYmxlWzRdOyAgICAgICAgLyogKE1GTikgc2hhZG93KHMp
IG9mIGd1ZXN0ICovCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0001-x86-mm-Clean-up-trailing-whitespace.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0001-x86-mm-Clean-up-trailing-whitespace.patch"
Content-Transfer-Encoding: base64

RnJvbSBmNzc1MWQ4M2NiMTA0NTU1YTdkYmZhYjIxYmI0YzFhMjk3MTIxMDgz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMTYgT2N0
IDIwMTkgMDk6MTY6MTUgKzAxMDAKU3ViamVjdDogW1BBVENIIDAxLzEyXSB4
ODYvbW06IENsZWFuIHVwIHRyYWlsaW5nIHdoaXRlc3BhY2UKClNvbWV0aW1l
IGJldHdlZW4gNC45IGFuZCA0LjEwIHNvbWVvbmUgY2xlYW5lZCB1cCBhbGwg
dGhlIHRyYWlsaW5nCndoaXRlc3BhY2UgaW4gbW0uYzsgYXBwbHlpbmcgdGhp
cyBwYXRjaCBub3cgbWFrZXMgYWxsIGZ1dGhlciBwYXRjaGVzCm11Y2ggY2xl
YW5lci4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLgoKUmVwb3J0ZWQtYnk6IEdl
b3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVk
LW9mZi1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXgu
Y29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMTE2ICsrKysrKysrKysr
KysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBj
aGFuZ2VkLCA1OCBpbnNlcnRpb25zKCspLCA1OCBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCmluZGV4IGFlOGMyZGU0ZjMuLmJkYzI2ODIxNTQgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBA
IC0xLDQ4ICsxLDQ4IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCiAgKiBhcmNoL3g4Ni9tbS5jCi0gKiAKKyAqCiAgKiBDb3B5cmln
aHQgKGMpIDIwMDItMjAwNSBLIEEgRnJhc2VyCiAgKiBDb3B5cmlnaHQgKGMp
IDIwMDQgQ2hyaXN0aWFuIExpbXBhY2gKLSAqIAorICoKICAqIFRoaXMgcHJv
Z3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IgbW9kaWZ5CiAgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQog
ICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNp
b24gMiBvZiB0aGUgTGljZW5zZSwgb3IKICAqIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCi0gKiAKKyAqCiAgKiBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVz
ZWZ1bCwKICAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBl
dmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAgKiBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUg
dGhlCiAgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLgotICogCisgKgogICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVk
IGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKICAq
IGFsb25nIHdpdGggdGhpcyBwcm9ncmFtOyBJZiBub3QsIHNlZSA8aHR0cDov
L3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCiAgKi8KIAogLyoKICAqIEEgZGVz
Y3JpcHRpb24gb2YgdGhlIHg4NiBwYWdlIHRhYmxlIEFQSToKLSAqIAorICoK
ICAqIERvbWFpbnMgdHJhcCB0byBkb19tbXVfdXBkYXRlIHdpdGggYSBsaXN0
IG9mIHVwZGF0ZSByZXF1ZXN0cy4KICAqIFRoaXMgaXMgYSBsaXN0IG9mIChw
dHIsIHZhbCkgcGFpcnMsIHdoZXJlIHRoZSByZXF1ZXN0ZWQgb3BlcmF0aW9u
CiAgKiBpcyAqcHRyID0gdmFsLgotICogCisgKgogICogUmVmZXJlbmNlIGNv
dW50aW5nIG9mIHBhZ2VzOgogICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQogICogRWFjaCBwYWdlIGhhcyB0d28gcmVmY291bnRzOiB0b3RfY291
bnQgYW5kIHR5cGVfY291bnQuCi0gKiAKKyAqCiAgKiBUT1RfQ09VTlQgaXMg
dGhlIG9idmlvdXMgcmVmZXJlbmNlIGNvdW50LiBJdCBjb3VudHMgYWxsIHVz
ZXMgb2YgYQogICogcGh5c2ljYWwgcGFnZSBmcmFtZSBieSBhIGRvbWFpbiwg
aW5jbHVkaW5nIHVzZXMgYXMgYSBwYWdlIGRpcmVjdG9yeSwKICAqIGEgcGFn
ZSB0YWJsZSwgb3Igc2ltcGxlIG1hcHBpbmdzIHZpYSBhIFBURS4gVGhpcyBj
b3VudCBwcmV2ZW50cyBhCiAgKiBkb21haW4gZnJvbSByZWxlYXNpbmcgYSBm
cmFtZSBiYWNrIHRvIHRoZSBmcmVlIHBvb2wgd2hlbiBpdCBzdGlsbCBob2xk
cwogICogYSByZWZlcmVuY2UgdG8gaXQuCi0gKiAKKyAqCiAgKiBUWVBFX0NP
VU5UIGlzIG1vcmUgc3VidGxlLiBBIGZyYW1lIGNhbiBiZSBwdXQgdG8gb25l
IG9mIHRocmVlCiAgKiBtdXR1YWxseS1leGNsdXNpdmUgdXNlczogaXQgbWln
aHQgYmUgdXNlZCBhcyBhIHBhZ2UgZGlyZWN0b3J5LCBvciBhCiAgKiBwYWdl
IHRhYmxlLCBvciBpdCBtYXkgYmUgbWFwcGVkIHdyaXRhYmxlIGJ5IHRoZSBk
b21haW4gW29mIGNvdXJzZSwgYQogICogZnJhbWUgbWF5IG5vdCBiZSB1c2Vk
IGluIGFueSBvZiB0aGVzZSB0aHJlZSB3YXlzIV0uCi0gKiBTbywgdHlwZV9j
b3VudCBpcyBhIGNvdW50IG9mIHRoZSBudW1iZXIgb2YgdGltZXMgYSBmcmFt
ZSBpcyBiZWluZyAKKyAqIFNvLCB0eXBlX2NvdW50IGlzIGEgY291bnQgb2Yg
dGhlIG51bWJlciBvZiB0aW1lcyBhIGZyYW1lIGlzIGJlaW5nCiAgKiByZWZl
cnJlZCB0byBpbiBpdHMgY3VycmVudCBpbmNhcm5hdGlvbi4gVGhlcmVmb3Jl
LCBhIHBhZ2UgY2FuIG9ubHkKICAqIGNoYW5nZSBpdHMgdHlwZSB3aGVuIGl0
cyB0eXBlIGNvdW50IGlzIHplcm8uCi0gKiAKKyAqCiAgKiBQaW5uaW5nIHRo
ZSBwYWdlIHR5cGU6CiAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBU
aGUgdHlwZSBvZiBhIHBhZ2UgY2FuIGJlIHBpbm5lZC91bnBpbm5lZCB3aXRo
IHRoZSBjb21tYW5kcwpAQCAtNTEsMjAgKzUxLDIwIEBACiAgKiBUaGlzIGlz
IHVzZWZ1bCB0byBwcmV2ZW50IGEgcGFnZSdzIHR5cGUgY291bnQgZmFsbGlu
ZyB0byB6ZXJvLCBhdCB3aGljaAogICogcG9pbnQgc2FmZXR5IGNoZWNrcyB3
b3VsZCBuZWVkIHRvIGJlIGNhcnJpZWQgb3V0IG5leHQgdGltZSB0aGUgY291
bnQKICAqIGlzIGluY3JlYXNlZCBhZ2Fpbi4KLSAqIAorICoKICAqIEEgZnVy
dGhlciBub3RlIG9uIHdyaXRhYmxlIHBhZ2UgbWFwcGluZ3M6CiAgKiAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICogRm9y
IHNpbXBsaWNpdHksIHRoZSBjb3VudCBvZiB3cml0YWJsZSBtYXBwaW5ncyBm
b3IgYSBwYWdlIG1heSBub3QKICAqIGNvcnJlc3BvbmQgdG8gcmVhbGl0eS4g
VGhlICd3cml0YWJsZSBjb3VudCcgaXMgaW5jcmVtZW50ZWQgZm9yIGV2ZXJ5
CiAgKiBQVEUgd2hpY2ggbWFwcyB0aGUgcGFnZSB3aXRoIHRoZSBfUEFHRV9S
VyBmbGFnIHNldC4gSG93ZXZlciwgZm9yCiAgKiB3cml0ZSBhY2Nlc3MgdG8g
YmUgcG9zc2libGUgdGhlIHBhZ2UgZGlyZWN0b3J5IGVudHJ5IG11c3QgYWxz
byBoYXZlCi0gKiBpdHMgX1BBR0VfUlcgYml0IHNldC4gV2UgZG8gbm90IGNo
ZWNrIHRoaXMgYXMgaXQgY29tcGxpY2F0ZXMgdGhlIAorICogaXRzIF9QQUdF
X1JXIGJpdCBzZXQuIFdlIGRvIG5vdCBjaGVjayB0aGlzIGFzIGl0IGNvbXBs
aWNhdGVzIHRoZQogICogcmVmZXJlbmNlIGNvdW50aW5nIGNvbnNpZGVyYWJs
eSBbY29uc2lkZXIgdGhlIGNhc2Ugb2YgbXVsdGlwbGUKICAqIGRpcmVjdG9y
eSBlbnRyaWVzIHJlZmVyZW5jaW5nIGEgc2luZ2xlIHBhZ2UgdGFibGUsIHNv
bWUgd2l0aCB0aGUgUlcKICAqIGJpdCBzZXQsIG90aGVycyBub3QgLS0gaXQg
c3RhcnRzIGdldHRpbmcgYSBiaXQgbWVzc3ldLgogICogSW4gbm9ybWFsIHVz
ZSwgdGhpcyBzaW1wbGlmaWNhdGlvbiBzaG91bGRuJ3QgYmUgYSBwcm9ibGVt
LgogICogSG93ZXZlciwgdGhlIGxvZ2ljIGNhbiBiZSBhZGRlZCBpZiByZXF1
aXJlZC4KLSAqIAorICoKICAqIE9uZSBtb3JlIG5vdGUgb24gcmVhZC1vbmx5
IHBhZ2UgbWFwcGluZ3M6CiAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQogICogV2Ugd2FudCBkb21haW5zIHRvIGJlIGFi
bGUgdG8gbWFwIHBhZ2VzIGZvciByZWFkLW9ubHkgYWNjZXNzLiBUaGUKQEAg
LTczLDEwICs3MywxMCBAQAogICogSG93ZXZlciwgZG9tYWlucyBoYXZlIGZy
ZWUgYWNjZXNzIHRvIHJpbmdzIDEgJiAyIG9mIHRoZSBJbnRlbAogICogcHJp
dmlsZWdlIG1vZGVsLiBJbiB0ZXJtcyBvZiBwYWdlIHByb3RlY3Rpb24sIHRo
ZXNlIGFyZSBjb25zaWRlcmVkCiAgKiB0byBiZSBwYXJ0IG9mICdzdXBlcnZp
c29yIG1vZGUnLiBUaGUgV1AgYml0IGluIENSMCBjb250cm9scyB3aGV0aGVy
Ci0gKiByZWFkLW9ubHkgcmVzdHJpY3Rpb25zIGFyZSByZXNwZWN0ZWQgaW4g
c3VwZXJ2aXNvciBtb2RlIC0tIGlmIHRoZSAKKyAqIHJlYWQtb25seSByZXN0
cmljdGlvbnMgYXJlIHJlc3BlY3RlZCBpbiBzdXBlcnZpc29yIG1vZGUgLS0g
aWYgdGhlCiAgKiBiaXQgaXMgY2xlYXIgdGhlbiBhbnkgbWFwcGVkIHBhZ2Ug
aXMgd3JpdGFibGUuCi0gKiAKLSAqIFdlIGdldCByb3VuZCB0aGlzIGJ5IGFs
d2F5cyBzZXR0aW5nIHRoZSBXUCBiaXQgYW5kIGRpc2FsbG93aW5nIAorICoK
KyAqIFdlIGdldCByb3VuZCB0aGlzIGJ5IGFsd2F5cyBzZXR0aW5nIHRoZSBX
UCBiaXQgYW5kIGRpc2FsbG93aW5nCiAgKiB1cGRhdGVzIHRvIGl0LiBUaGlz
IGlzIHZlcnkgdW5saWtlbHkgdG8gY2F1c2UgYSBwcm9ibGVtIGZvciBndWVz
dAogICogT1Mncywgd2hpY2ggd2lsbCBnZW5lcmFsbHkgdXNlIHRoZSBXUCBi
aXQgdG8gc2ltcGxpZnkgY29weS1vbi13cml0ZQogICogaW1wbGVtZW50YXRp
b24gKGluIHRoYXQgY2FzZSwgT1Mgd2FudHMgYSBmYXVsdCB3aGVuIGl0IHdy
aXRlcyB0bwpAQCAtMzExLDcgKzMxMSw3IEBAIHZvaWQgX19pbml0IGFyY2hf
aW5pdF9tZW1vcnkodm9pZCkKICAgICAgKi8KICAgICBkb21faW8gPSBkb21h
aW5fY3JlYXRlKERPTUlEX0lPLCBET01DUkZfZHVtbXksIDAsIE5VTEwpOwog
ICAgIEJVR19PTihJU19FUlIoZG9tX2lvKSk7Ci0gICAgCisKICAgICAvKgog
ICAgICAqIEluaXRpYWxpc2Ugb3VyIENPVyBkb21haW4uCiAgICAgICogVGhp
cyBkb21haW4gb3ducyBzaGFyYWJsZSBwYWdlcy4KQEAgLTMyMiw3ICszMjIs
NyBAQCB2b2lkIF9faW5pdCBhcmNoX2luaXRfbWVtb3J5KHZvaWQpCiAgICAg
LyogRmlyc3QgMU1CIG9mIFJBTSBpcyBoaXN0b3JpY2FsbHkgbWFya2VkIGFz
IEkvTy4gKi8KICAgICBmb3IgKCBpID0gMDsgaSA8IDB4MTAwOyBpKysgKQog
ICAgICAgICBzaGFyZV94ZW5fcGFnZV93aXRoX2d1ZXN0KG1mbl90b19wYWdl
KGkpLCBkb21faW8sIFhFTlNIQVJFX3dyaXRhYmxlKTsKLSAKKwogICAgIC8q
IEFueSBhcmVhcyBub3Qgc3BlY2lmaWVkIGFzIFJBTSBieSB0aGUgZTgyMCBt
YXAgYXJlIGNvbnNpZGVyZWQgSS9PLiAqLwogICAgIGZvciAoIGkgPSAwLCBw
Zm4gPSAwOyBwZm4gPCBtYXhfcGFnZTsgaSsrICkKICAgICB7CkBAIC0zNTIs
NyArMzUyLDcgQEAgdm9pZCBfX2luaXQgYXJjaF9pbml0X21lbW9yeSh2b2lk
KQogICAgICAgICAgKi8KICAgICAgICAgaW9zdGFydF9wZm4gPSBtYXhfdCh1
bnNpZ25lZCBsb25nLCBwZm4sIDFVTCA8PCAoMjAgLSBQQUdFX1NISUZUKSk7
CiAgICAgICAgIGlvZW5kX3BmbiA9IG1pbihyc3RhcnRfcGZuLCAxNlVMIDw8
ICgyMCAtIFBBR0VfU0hJRlQpKTsKLSAgICAgICAgaWYgKCBpb3N0YXJ0X3Bm
biA8IGlvZW5kX3BmbiApICAgICAgICAgICAgCisgICAgICAgIGlmICggaW9z
dGFydF9wZm4gPCBpb2VuZF9wZm4gKQogICAgICAgICAgICAgZGVzdHJveV94
ZW5fbWFwcGluZ3MoKHVuc2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaW9zdGFy
dF9wZm4pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHVu
c2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaW9lbmRfcGZuKSk7CiAKQEAgLTQ0
MCw3ICs0NDAsNyBAQCBpbnQgcGFnZV9pc19yYW1fdHlwZSh1bnNpZ25lZCBs
b25nIG1mbiwgdW5zaWduZWQgbG9uZyBtZW1fdHlwZSkKICAgICAgICAgICAg
IC8qIHVua25vd24gKi8KICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg
ICB9Ci0gICAgICAgIAorCiAgICAgICAgIC8qIFRlc3QgdGhlIHJhbmdlLiAq
LwogICAgICAgICBpZiAoIChlODIwLm1hcFtpXS5hZGRyIDw9IG1hZGRyKSAm
JgogICAgICAgICAgICAgICgoZTgyMC5tYXBbaV0uYWRkciArIGU4MjAubWFw
W2ldLnNpemUpID49IChtYWRkciArIFBBR0VfU0laRSkpICkKQEAgLTU1OSw3
ICs1NTksNyBAQCB2b2lkIHdyaXRlX3B0YmFzZShzdHJ1Y3QgdmNwdSAqdikK
IAogLyoKICAqIFNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgQ1IzIGlzIHVwZGF0
ZWQuCi0gKiAKKyAqCiAgKiBVc2VzIHZhbHVlcyBmb3VuZCBpbiB2Y3B1LT5h
cmNoLihndWVzdF90YWJsZSBhbmQgZ3Vlc3RfdGFibGVfdXNlciksIGFuZAog
ICogZm9yIEhWTSBndWVzdHMsIGFyY2gubW9uaXRvcl90YWJsZSBhbmQgaHZt
J3MgZ3Vlc3QgQ1IzLgogICoKQEAgLTc3MCw3ICs3NzAsNyBAQCBzdGF0aWMg
aW50IGdldF9wYWdlX2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9u
ciwgc3RydWN0IGRvbWFpbiAqZCkKIHN0YXRpYyBpbnQgX19nZXRfcGFnZV90
eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlw
ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwcmVlbXB0aWJs
ZSk7CiAKLXN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdl
bnIodW5zaWduZWQgbG9uZyBwYWdlX25yLCAKK3N0YXRpYyBpbnQgZ2V0X3Bh
Z2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIodW5zaWduZWQgbG9uZyBwYWdlX25y
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBkb21haW4gKmQsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwYXJ0aWFsLApA
QCAtMTE3NCw3ICsxMTc0LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sMWUoCiAgICAg
ICAgIHBnX293bmVyID0gcmVhbF9wZ19vd25lcjsKICAgICB9CiAKLSAgICAv
KiBFeHRyYSBwYXJhbm9pZCBjaGVjayBmb3Igc2hhcmVkIG1lbW9yeS4gV3Jp
dGFibGUgbWFwcGluZ3MgCisgICAgLyogRXh0cmEgcGFyYW5vaWQgY2hlY2sg
Zm9yIHNoYXJlZCBtZW1vcnkuIFdyaXRhYmxlIG1hcHBpbmdzCiAgICAgICog
ZGlzYWxsb3dlZCAodW5zaGFyZSBmaXJzdCEpICovCiAgICAgaWYgKCAobDFm
ICYgX1BBR0VfUlcpICYmIChyZWFsX3BnX293bmVyID09IGRvbV9jb3cpICkK
ICAgICAgICAgZ290byBjb3VsZF9ub3RfcGluOwpAQCAtMTQyMywxMiArMTQy
MywxMiBAQCB2b2lkIHB1dF9wYWdlX2Zyb21fbDFlKGwxX3BnZW50cnlfdCBs
MWUsIHN0cnVjdCBkb21haW4gKmwxZV9vd25lcikKICAgICAgKiBDaGVjayBp
ZiB0aGlzIGlzIGEgbWFwcGluZyB0aGF0IHdhcyBlc3RhYmxpc2hlZCB2aWEg
YSBncmFudCByZWZlcmVuY2UuCiAgICAgICogSWYgaXQgd2FzIHRoZW4gd2Ug
c2hvdWxkIG5vdCBiZSBoZXJlOiB3ZSByZXF1aXJlIHRoYXQgc3VjaCBtYXBw
aW5ncyBhcmUKICAgICAgKiBleHBsaWNpdGx5IGRlc3Ryb3llZCB2aWEgdGhl
IGdyYW50LXRhYmxlIGludGVyZmFjZS4KLSAgICAgKiAKKyAgICAgKgogICAg
ICAqIFRoZSB1cHNob3Qgb2YgdGhpcyBpcyB0aGF0IHRoZSBndWVzdCBjYW4g
ZW5kIHVwIHdpdGggYWN0aXZlIGdyYW50cyB0aGF0CiAgICAgICogaXQgY2Fu
bm90IGRlc3Ryb3kgKGJlY2F1c2UgaXQgbm8gbG9uZ2VyIGhhcyBhIFBURSB0
byBwcmVzZW50IHRvIHRoZQogICAgICAqIGdyYW50LXRhYmxlIGludGVyZmFj
ZSkuIFRoaXMgY2FuIGxlYWQgdG8gc3VidGxlIGhhcmQtdG8tY2F0Y2ggYnVn
cywKICAgICAgKiBoZW5jZSBhIHNwZWNpYWwgZ3JhbnQgUFRFIGZsYWcgY2Fu
IGJlIGVuYWJsZWQgdG8gY2F0Y2ggdGhlIGJ1ZyBlYXJseS4KLSAgICAgKiAK
KyAgICAgKgogICAgICAqIChOb3RlIHRoYXQgdGhlIHVuZGVzdHJveWFibGUg
YWN0aXZlIGdyYW50cyBhcmUgbm90IGEgc2VjdXJpdHkgaG9sZSBpbgogICAg
ICAqIFhlbi4gQWxsIGFjdGl2ZSBncmFudHMgY2FuIHNhZmVseSBiZSBjbGVh
bmVkIHVwIHdoZW4gdGhlIGRvbWFpbiBkaWVzLikKICAgICAgKi8KQEAgLTE0
NDMsNyArMTQ0Myw3IEBAIHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFfcGdl
bnRyeV90IGwxZSwgc3RydWN0IGRvbWFpbiAqbDFlX293bmVyKQogCiAgICAg
LyogUmVtZW1iZXIgd2UgZGlkbid0IHRha2UgYSB0eXBlLWNvdW50IG9mIGZv
cmVpZ24gd3JpdGFibGUgbWFwcGluZ3MKICAgICAgKiB0byBwYWdpbmctZXh0
ZXJuYWwgZG9tYWlucyAqLwotICAgIGlmICggKGwxZV9nZXRfZmxhZ3MobDFl
KSAmIF9QQUdFX1JXKSAmJiAKKyAgICBpZiAoIChsMWVfZ2V0X2ZsYWdzKGwx
ZSkgJiBfUEFHRV9SVykgJiYKICAgICAgICAgICgobDFlX293bmVyID09IHBn
X293bmVyKSB8fCAhcGFnaW5nX21vZGVfZXh0ZXJuYWwocGdfb3duZXIpKSAp
CiAgICAgewogICAgICAgICBwdXRfcGFnZV9hbmRfdHlwZShwYWdlKTsKQEAg
LTE0NTEsNyArMTQ1MSw3IEBAIHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFf
cGdlbnRyeV90IGwxZSwgc3RydWN0IGRvbWFpbiAqbDFlX293bmVyKQogICAg
IGVsc2UKICAgICB7CiAgICAgICAgIC8qIFdlIGV4cGVjdCB0aGlzIGlzIHJh
cmUgc28gd2UgYmxvdyB0aGUgZW50aXJlIHNoYWRvdyBMRFQuICovCi0gICAg
ICAgIGlmICggdW5saWtlbHkoKChwYWdlLT51LmludXNlLnR5cGVfaW5mbyAm
IFBHVF90eXBlX21hc2spID09IAorICAgICAgICBpZiAoIHVubGlrZWx5KCgo
cGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJiBQR1RfdHlwZV9tYXNrKSA9PQog
ICAgICAgICAgICAgICAgICAgICAgICBQR1Rfc2VnX2Rlc2NfcGFnZSkpICYm
CiAgICAgICAgICAgICAgdW5saWtlbHkoKChwYWdlLT51LmludXNlLnR5cGVf
aW5mbyAmIFBHVF9jb3VudF9tYXNrKSAhPSAwKSkgJiYKICAgICAgICAgICAg
ICAobDFlX293bmVyID09IHBnX293bmVyKSApCkBAIC0xNTUzLDcgKzE1NTMs
NyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlf
dCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLAogewogICAgIGludCByYyA9IDE7
CiAKLSAgICBpZiAoIChsNGVfZ2V0X2ZsYWdzKGw0ZSkgJiBfUEFHRV9QUkVT
RU5UKSAmJiAKKyAgICBpZiAoIChsNGVfZ2V0X2ZsYWdzKGw0ZSkgJiBfUEFH
RV9QUkVTRU5UKSAmJgogICAgICAgICAgKGw0ZV9nZXRfcGZuKGw0ZSkgIT0g
cGZuKSApCiAgICAgewogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9
IGw0ZV9nZXRfcGFnZShsNGUpOwpAQCAtMjExMiw4ICsyMTEyLDggQEAgdm9p
ZCBwYWdlX3VubG9jayhzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogCiAvKiBI
b3cgdG8gd3JpdGUgYW4gZW50cnkgdG8gdGhlIGd1ZXN0IHBhZ2V0YWJsZXMu
CiAgKiBSZXR1cm5zIDAgZm9yIGZhaWx1cmUgKHBvaW50ZXIgbm90IHZhbGlk
KSwgMSBmb3Igc3VjY2Vzcy4gKi8KLXN0YXRpYyBpbmxpbmUgaW50IHVwZGF0
ZV9pbnRwdGUoaW50cHRlX3QgKnAsIAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnRwdGVfdCBvbGQsIAorc3RhdGljIGlubGluZSBpbnQg
dXBkYXRlX2ludHB0ZShpbnRwdGVfdCAqcCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaW50cHRlX3Qgb2xkLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpbnRwdGVfdCBuZXcsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbWZuLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmNwdSAqdiwKQEAg
LTIyODUsOCArMjI4NSw4IEBAIHN0YXRpYyBpbnQgbW9kX2wxX2VudHJ5KGwx
X3BnZW50cnlfdCAqcGwxZSwgbDFfcGdlbnRyeV90IG5sMWUsCiAKIAogLyog
VXBkYXRlIHRoZSBMMiBlbnRyeSBhdCBwbDJlIHRvIG5ldyB2YWx1ZSBubDJl
LiBwbDJlIGlzIHdpdGhpbiBmcmFtZSBwZm4uICovCi1zdGF0aWMgaW50IG1v
ZF9sMl9lbnRyeShsMl9wZ2VudHJ5X3QgKnBsMmUsIAotICAgICAgICAgICAg
ICAgICAgICAgICAgbDJfcGdlbnRyeV90IG5sMmUsIAorc3RhdGljIGludCBt
b2RfbDJfZW50cnkobDJfcGdlbnRyeV90ICpwbDJlLAorICAgICAgICAgICAg
ICAgICAgICAgICAgbDJfcGdlbnRyeV90IG5sMmUsCiAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgICAgICAg
ICAgICAgICAgIGludCBwcmVzZXJ2ZV9hZCwKICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCB2Y3B1ICp2Y3B1KQpAQCAtMjM1MCw4ICsyMzUwLDgg
QEAgc3RhdGljIGludCBtb2RfbDJfZW50cnkobDJfcGdlbnRyeV90ICpwbDJl
LAogfQogCiAvKiBVcGRhdGUgdGhlIEwzIGVudHJ5IGF0IHBsM2UgdG8gbmV3
IHZhbHVlIG5sM2UuIHBsM2UgaXMgd2l0aGluIGZyYW1lIHBmbi4gKi8KLXN0
YXRpYyBpbnQgbW9kX2wzX2VudHJ5KGwzX3BnZW50cnlfdCAqcGwzZSwgCi0g
ICAgICAgICAgICAgICAgICAgICAgICBsM19wZ2VudHJ5X3QgbmwzZSwgCitz
dGF0aWMgaW50IG1vZF9sM19lbnRyeShsM19wZ2VudHJ5X3QgKnBsM2UsCisg
ICAgICAgICAgICAgICAgICAgICAgICBsM19wZ2VudHJ5X3QgbmwzZSwKICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcGZuLAogICAg
ICAgICAgICAgICAgICAgICAgICAgaW50IHByZXNlcnZlX2FkLAogICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHZjcHUgKnZjcHUpCkBAIC0yNDI0
LDggKzI0MjQsOCBAQCBzdGF0aWMgaW50IG1vZF9sM19lbnRyeShsM19wZ2Vu
dHJ5X3QgKnBsM2UsCiB9CiAKIC8qIFVwZGF0ZSB0aGUgTDQgZW50cnkgYXQg
cGw0ZSB0byBuZXcgdmFsdWUgbmw0ZS4gcGw0ZSBpcyB3aXRoaW4gZnJhbWUg
cGZuLiAqLwotc3RhdGljIGludCBtb2RfbDRfZW50cnkobDRfcGdlbnRyeV90
ICpwbDRlLCAKLSAgICAgICAgICAgICAgICAgICAgICAgIGw0X3BnZW50cnlf
dCBubDRlLCAKK3N0YXRpYyBpbnQgbW9kX2w0X2VudHJ5KGw0X3BnZW50cnlf
dCAqcGw0ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgIGw0X3BnZW50cnlf
dCBubDRlLAogICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9u
ZyBwZm4sCiAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcHJlc2VydmVf
YWQsCiAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmNwdSAqdmNw
dSkKQEAgLTI1OTIsNyArMjU5Miw3IEBAIHN0cnVjdCBkb21haW4gKnBhZ2Vf
Z2V0X293bmVyX2FuZF9yZWZlcmVuY2Uoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSkKICAgICAgICAgeCA9IHk7CiAgICAgICAgIC8qCiAgICAgICAgICAqIENv
dW50ID09ICAwOiBQYWdlIGlzIG5vdCBhbGxvY2F0ZWQsIHNvIHdlIGNhbm5v
dCB0YWtlIGEgcmVmZXJlbmNlLgotICAgICAgICAgKiBDb3VudCA9PSAtMTog
UmVmZXJlbmNlIGNvdW50IHdvdWxkIHdyYXAsIHdoaWNoIGlzIGludmFsaWQu
IAorICAgICAgICAgKiBDb3VudCA9PSAtMTogUmVmZXJlbmNlIGNvdW50IHdv
dWxkIHdyYXAsIHdoaWNoIGlzIGludmFsaWQuCiAgICAgICAgICAqIENvdW50
ID09IC0yOiBSZW1haW5pbmcgdW51c2VkIHJlZiBpcyByZXNlcnZlZCBmb3Ig
Z2V0X3BhZ2VfbGlnaHQoKS4KICAgICAgICAgICovCiAgICAgICAgIGlmICgg
dW5saWtlbHkoKCh4ICsgMikgJiBQR0NfY291bnRfbWFzaykgPD0gMikgKQpA
QCAtMjY4MCw3ICsyNjgwLDcgQEAgc3RhdGljIGludCBhbGxvY19wYWdlX3R5
cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBl
LAogICAgICAgICByYyA9IGFsbG9jX3NlZ2Rlc2NfcGFnZShwYWdlKTsKICAg
ICAgICAgYnJlYWs7CiAgICAgZGVmYXVsdDoKLSAgICAgICAgcHJpbnRrKCJC
YWQgdHlwZSBpbiBhbGxvY19wYWdlX3R5cGUgJWx4IHQ9JSIgUFJ0eXBlX2lu
Zm8gIiBjPSVseFxuIiwgCisgICAgICAgIHByaW50aygiQmFkIHR5cGUgaW4g
YWxsb2NfcGFnZV90eXBlICVseCB0PSUiIFBSdHlwZV9pbmZvICIgYz0lbHhc
biIsCiAgICAgICAgICAgICAgICB0eXBlLCBwYWdlLT51LmludXNlLnR5cGVf
aW5mbywKICAgICAgICAgICAgICAgIHBhZ2UtPmNvdW50X2luZm8pOwogICAg
ICAgICByYyA9IC1FSU5WQUw7CkBAIC0yOTQxLDggKzI5NDEsOCBAQCBzdGF0
aWMgaW50IF9fZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
LCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgICAgICAgICBpZiAoICh4ICYg
UEdUX3R5cGVfbWFzaykgIT0gdHlwZSApCiAgICAgICAgICAgICB7CiAgICAg
ICAgICAgICAgICAgLyoKLSAgICAgICAgICAgICAgICAgKiBPbiB0eXBlIGNo
YW5nZSB3ZSBjaGVjayB0byBmbHVzaCBzdGFsZSBUTEIgZW50cmllcy4gVGhp
cyAKLSAgICAgICAgICAgICAgICAgKiBtYXkgYmUgdW5uZWNlc3NhcnkgKGUu
Zy4sIHBhZ2Ugd2FzIEdEVC9MRFQpIGJ1dCB0aG9zZSAKKyAgICAgICAgICAg
ICAgICAgKiBPbiB0eXBlIGNoYW5nZSB3ZSBjaGVjayB0byBmbHVzaCBzdGFs
ZSBUTEIgZW50cmllcy4gVGhpcworICAgICAgICAgICAgICAgICAqIG1heSBi
ZSB1bm5lY2Vzc2FyeSAoZS5nLiwgcGFnZSB3YXMgR0RUL0xEVCkgYnV0IHRo
b3NlCiAgICAgICAgICAgICAgICAgICogY2lyY3Vtc3RhbmNlcyBzaG91bGQg
YmUgdmVyeSByYXJlLgogICAgICAgICAgICAgICAgICAqLwogICAgICAgICAg
ICAgICAgIGNwdW1hc2tfdCAqbWFzayA9IHRoaXNfY3B1KHNjcmF0Y2hfY3B1
bWFzayk7CkBAIC0zODkyLDcgKzM4OTIsNyBAQCBsb25nIGRvX21tdWV4dF9v
cCgKICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICByYyA9IC1F
UEVSTTsKICAgICAgICAgICAgIGJyZWFrOwotICAgIAorCiAgICAgICAgIGNh
c2UgTU1VRVhUX0lOVkxQR19BTEw6CiAgICAgICAgICAgICBpZiAoIHVubGlr
ZWx5KGQgIT0gcGdfb3duZXIpICkKICAgICAgICAgICAgICAgICByYyA9IC1F
UEVSTTsKQEAgLTQ0MjYsNyArNDQyNiw3IEBAIHN0YXRpYyBpbnQgY3JlYXRl
X2dyYW50X3B0ZV9tYXBwaW5nKAogICAgICAgICBnZHByaW50ayhYRU5MT0df
V0FSTklORywgIkNvdWxkIG5vdCBnZXQgcGFnZSBmb3Igbm9ybWFsIHVwZGF0
ZVxuIik7CiAgICAgICAgIHJldHVybiBHTlRTVF9nZW5lcmFsX2Vycm9yOwog
ICAgIH0KLSAgICAKKwogICAgIG1mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwog
ICAgIHZhID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4obWZuKSk7CiAgICAgdmEg
PSAodm9pZCAqKSgodW5zaWduZWQgbG9uZyl2YSArICgodW5zaWduZWQgbG9u
ZylwdGVfYWRkciAmIH5QQUdFX01BU0spKTsKQEAgLTQ0NTAsNyArNDQ1MCw3
IEBAIHN0YXRpYyBpbnQgY3JlYXRlX2dyYW50X3B0ZV9tYXBwaW5nKAogICAg
ICAgICBwYWdlX3VubG9jayhwYWdlKTsKICAgICAgICAgcmMgPSBHTlRTVF9n
ZW5lcmFsX2Vycm9yOwogICAgICAgICBnb3RvIGZhaWxlZDsKLSAgICB9IAor
ICAgIH0KIAogICAgIHBhZ2VfdW5sb2NrKHBhZ2UpOwogCkBAIC00NDkyLDcg
KzQ0OTIsNyBAQCBzdGF0aWMgaW50IGRlc3Ryb3lfZ3JhbnRfcHRlX21hcHBp
bmcoCiAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiQ291bGQg
bm90IGdldCBwYWdlIGZvciBub3JtYWwgdXBkYXRlXG4iKTsKICAgICAgICAg
cmV0dXJuIEdOVFNUX2dlbmVyYWxfZXJyb3I7CiAgICAgfQotICAgIAorCiAg
ICAgbWZuID0gcGFnZV90b19tZm4ocGFnZSk7CiAgICAgdmEgPSBtYXBfZG9t
YWluX3BhZ2UoX21mbihtZm4pKTsKICAgICB2YSA9ICh2b2lkICopKCh1bnNp
Z25lZCBsb25nKXZhICsgKCh1bnNpZ25lZCBsb25nKWFkZHIgJiB+UEFHRV9N
QVNLKSk7CkBAIC00NTExLDcgKzQ1MTEsNyBAQCBzdGF0aWMgaW50IGRlc3Ry
b3lfZ3JhbnRfcHRlX21hcHBpbmcoCiAgICAgfQogCiAgICAgb2wxZSA9ICoo
bDFfcGdlbnRyeV90ICopdmE7Ci0gICAgCisKICAgICAvKgogICAgICAqIENo
ZWNrIHRoYXQgdGhlIFBURSBzdXBwbGllZCBhY3R1YWxseSBtYXBzIGZyYW1l
ICh3aXRoIGFwcHJvcHJpYXRlCiAgICAgICogcGVybWlzc2lvbnMpLgpAQCAt
NDUzNyw4ICs0NTM3LDggQEAgc3RhdGljIGludCBkZXN0cm95X2dyYW50X3B0
ZV9tYXBwaW5nKAogCiAgICAgLyogRGVsZXRlIHBhZ2V0YWJsZSBlbnRyeS4g
Ki8KICAgICBpZiAoIHVubGlrZWx5KCFVUERBVEVfRU5UUlkKLSAgICAgICAg
ICAgICAgICAgIChsMSwgCi0gICAgICAgICAgICAgICAgICAgKGwxX3BnZW50
cnlfdCAqKXZhLCBvbDFlLCBsMWVfZW1wdHkoKSwgbWZuLCAKKyAgICAgICAg
ICAgICAgICAgIChsMSwKKyAgICAgICAgICAgICAgICAgICAobDFfcGdlbnRy
eV90ICopdmEsIG9sMWUsIGwxZV9lbXB0eSgpLCBtZm4sCiAgICAgICAgICAg
ICAgICAgICAgZC0+dmNwdVswXSAvKiBDaGFuZ2UgaWYgd2UgZ28gdG8gcGVy
LXZjcHUgc2hhZG93cy4gKi8sCiAgICAgICAgICAgICAgICAgICAgMCkpICkK
ICAgICB7CkBAIC00NTY2LDcgKzQ1NjYsNyBAQCBzdGF0aWMgaW50IGNyZWF0
ZV9ncmFudF92YV9tYXBwaW5nKAogICAgIHVuc2lnbmVkIGxvbmcgZ2wxbWZu
OwogICAgIHN0cnVjdCBwYWdlX2luZm8gKmwxcGc7CiAgICAgaW50IG9rYXk7
Ci0gICAgCisKICAgICBhZGp1c3RfZ3Vlc3RfbDFlKG5sMWUsIGQpOwogCiAg
ICAgcGwxZSA9IGd1ZXN0X21hcF9sMWUodmEsICZnbDFtZm4pOwpAQCAtNDYx
OSw3ICs0NjE5LDcgQEAgc3RhdGljIGludCByZXBsYWNlX2dyYW50X3ZhX21h
cHBpbmcoCiAgICAgdW5zaWduZWQgbG9uZyBnbDFtZm47CiAgICAgc3RydWN0
IHBhZ2VfaW5mbyAqbDFwZzsKICAgICBpbnQgcmMgPSAwOwotICAgIAorCiAg
ICAgcGwxZSA9IGd1ZXN0X21hcF9sMWUoYWRkciwgJmdsMW1mbik7CiAgICAg
aWYgKCAhcGwxZSApCiAgICAgewpAQCAtNDcxOSw3ICs0NzE5LDcgQEAgc3Rh
dGljIGludCBjcmVhdGVfZ3JhbnRfcDJtX21hcHBpbmcodWludDY0X3QgYWRk
ciwgdW5zaWduZWQgbG9uZyBmcmFtZSwKICAgICAgICAgcmV0dXJuIEdOVFNU
X29rYXk7CiB9CiAKLWludCBjcmVhdGVfZ3JhbnRfaG9zdF9tYXBwaW5nKHVp
bnQ2NF90IGFkZHIsIHVuc2lnbmVkIGxvbmcgZnJhbWUsIAoraW50IGNyZWF0
ZV9ncmFudF9ob3N0X21hcHBpbmcodWludDY0X3QgYWRkciwgdW5zaWduZWQg
bG9uZyBmcmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBmbGFncywgdW5zaWduZWQgaW50IGNhY2hlX2ZsYWdzKQog
ewogICAgIGwxX3BnZW50cnlfdCBwdGU7CkBAIC00Nzg5LDcgKzQ3ODksNyBA
QCBpbnQgcmVwbGFjZV9ncmFudF9ob3N0X21hcHBpbmcoCiAgICAgc3RydWN0
IHBhZ2VfaW5mbyAqbDFwZzsKICAgICBpbnQgcmM7CiAgICAgdW5zaWduZWQg
aW50IGdyYW50X3B0ZV9mbGFnczsKLSAgICAKKwogICAgIGlmICggcGFnaW5n
X21vZGVfZXh0ZXJuYWwoY3VycmVudC0+ZG9tYWluKSApCiAgICAgICAgIHJl
dHVybiByZXBsYWNlX2dyYW50X3AybV9tYXBwaW5nKGFkZHIsIGZyYW1lLCBu
ZXdfYWRkciwgZmxhZ3MpOwogCkBAIC00ODE1LDcgKzQ4MTUsNyBAQCBpbnQg
cmVwbGFjZV9ncmFudF9ob3N0X21hcHBpbmcoCiAgICAgICAgIGlmICggIW5l
d19hZGRyICkKICAgICAgICAgICAgIHJldHVybiBkZXN0cm95X2dyYW50X3B0
ZV9tYXBwaW5nKGFkZHIsIGZyYW1lLCBncmFudF9wdGVfZmxhZ3MsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJy
LT5kb21haW4pOwotICAgICAgICAKKwogICAgICAgICByZXR1cm4gR05UU1Rf
Z2VuZXJhbF9lcnJvcjsKICAgICB9CiAKQEAgLTUyMTAsNyArNTIxMCw3IEBA
IHZvaWQgZGVzdHJveV9nZHQoc3RydWN0IHZjcHUgKnYpCiB9CiAKIAotbG9u
ZyBzZXRfZ2R0KHN0cnVjdCB2Y3B1ICp2LCAKK2xvbmcgc2V0X2dkdChzdHJ1
Y3QgdmNwdSAqdiwKICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICpmcmFt
ZXMsCiAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGVudHJpZXMpCiB7CkBA
IC01MjcyLDcgKzUyNzIsNyBAQCBsb25nIGRvX3NldF9nZHQoWEVOX0dVRVNU
X0hBTkRMRV9QQVJBTSh4ZW5fdWxvbmdfdCkgZnJhbWVfbGlzdCwKICAgICAv
KiBSZWNoZWNrZWQgaW4gc2V0X2dkdCwgYnV0IGVuc3VyZXMgYSBzYW5lIGxp
bWl0IGZvciBjb3B5X2Zyb21fdXNlcigpLiAqLwogICAgIGlmICggZW50cmll
cyA+IEZJUlNUX1JFU0VSVkVEX0dEVF9FTlRSWSApCiAgICAgICAgIHJldHVy
biAtRUlOVkFMOwotICAgIAorCiAgICAgaWYgKCBjb3B5X2Zyb21fZ3Vlc3Qo
ZnJhbWVzLCBmcmFtZV9saXN0LCBucl9wYWdlcykgKQogICAgICAgICByZXR1
cm4gLUVGQVVMVDsKIApAQCAtNTU2NSw3ICs1NTY1LDcgQEAgbG9uZyBhcmNo
X21lbW9yeV9vcCh1bnNpZ25lZCBsb25nIGNtZCwgWEVOX0dVRVNUX0hBTkRM
RV9QQVJBTSh2b2lkKSBhcmcpCiAgICAgICAgICAgICByY3VfdW5sb2NrX2Rv
bWFpbihkKTsKICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwogICAgICAg
ICB9Ci0gICAgICAgIAorCiAgICAgICAgIGlmICggY29weV9mcm9tX2d1ZXN0
KGU4MjAsIGZtYXAubWFwLmJ1ZmZlciwgZm1hcC5tYXAubnJfZW50cmllcykg
KQogICAgICAgICB7CiAgICAgICAgICAgICB4ZnJlZShlODIwKTsKQEAgLTU3
MjQsNyArNTcyNCw3IEBAIGxvbmcgYXJjaF9tZW1vcnlfb3AodW5zaWduZWQg
bG9uZyBjbWQsIFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0odm9pZCkgYXJnKQog
ICAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKICAgICAgICAgICAgICAg
ICBnb3RvIHBvZF90YXJnZXRfb3V0X3VubG9jazsKICAgICAgICAgICAgIH0K
LSAgICAgICAgICAgIAorCiAgICAgICAgICAgICByYyA9IHAybV9wb2Rfc2V0
X21lbV90YXJnZXQoZCwgdGFyZ2V0LnRhcmdldF9wYWdlcyk7CiAgICAgICAg
IH0KIApAQCAtNTc0Niw3ICs1NzQ2LDcgQEAgbG9uZyBhcmNoX21lbW9yeV9v
cCh1bnNpZ25lZCBsb25nIGNtZCwgWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh2
b2lkKSBhcmcpCiAgICAgICAgICAgICAgICAgZ290byBwb2RfdGFyZ2V0X291
dF91bmxvY2s7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KLSAgICAgICAg
CisKICAgICBwb2RfdGFyZ2V0X291dF91bmxvY2s6CiAgICAgICAgIHJjdV91
bmxvY2tfZG9tYWluKGQpOwogICAgICAgICByZXR1cm4gcmM7CkBAIC01OTky
LDcgKzU5OTIsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHg4Nl9lbXVsYXRl
X29wcyBwdHdyX2VtdWxhdGVfb3BzID0gewogfTsKIAogLyogV3JpdGUgcGFn
ZSBmYXVsdCBoYW5kbGVyOiBjaGVjayBpZiBndWVzdCBpcyB0cnlpbmcgdG8g
bW9kaWZ5IGEgUFRFLiAqLwotaW50IHB0d3JfZG9fcGFnZV9mYXVsdChzdHJ1
Y3QgdmNwdSAqdiwgdW5zaWduZWQgbG9uZyBhZGRyLCAKK2ludCBwdHdyX2Rv
X3BhZ2VfZmF1bHQoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGxvbmcgYWRk
ciwKICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNwdV91c2VyX3Jl
Z3MgKnJlZ3MpCiB7CiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFp
bjsKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0002-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0002-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Transfer-Encoding: base64

RnJvbSAyZjUyOTY5NzBhYjhlNWFjMDQ4ZjE0YzU2MGQwYmVmZDUzZDM4NmNj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAyLzEyXSB4
ODYvbW06IEwxVEYgY2hlY2tzIGRvbid0IGxlYXZlIGEgcGFydGlhbCBlbnRy
eQoKT24gZGV0ZWN0aW9uIG9mIGEgcG90ZW50aWFsIEwxVEYgaXNzdWUsIG1v
c3QgdmFsaWRhdGlvbiBjb2RlIHJldHVybnMKLUVSRVNUQVJUIHRvIGFsbG93
IHRoZSBzd2l0Y2ggdG8gc2hhZG93IG1vZGUgdG8gaGFwcGVuIGFuZCBjYXVz
ZSB0aGUKb3JpZ2luYWwgb3BlcmF0aW9uIHRvIGJlIHJlc3RhcnRlZC4KCkhv
d2V2ZXIsIGluIHRoZSB2YWxpZGF0aW9uIGNvZGUsIHRoZSByZXR1cm4gdmFs
dWUgLUVSRVNUQVJUIGhhcyBiZWVuCnJlcHVycG9zZWQgdG8gaW5kaWNhdGUg
MSkgdGhlIGZ1bmN0aW9uIGhhcyBwYXJ0aWFsbHkgY29tcGxldGVkCnNvbWV0
aGluZyB3aGljaCBuZWVkcyB0byBiZSB1bmRvbmUsIGFuZCAyKSBjYWxsaW5n
IHB1dF9wYWdlX3R5cGUoKQpzaG91bGQgY2xlYW5seSB1bmRvIGl0LiAgVGhp
cyBjYXVzZXMgcHJvYmxlbXMgaW4gc2V2ZXJhbCBwbGFjZXMuCgpGb3IgTDEg
dGFibGVzLCBvbiByZWNlaXZpbmcgYW4gLUVSRVNUQVJUIHJldHVybiBmcm9t
IGFsbG9jX2wxX3RhYmxlKCksCmFsbG9jX3BhZ2VfdHlwZSgpIHdpbGwgc2V0
IFBHVF9wYXJ0aWFsIG9uIHRoZSBwYWdlLiAgSWYgZm9yIHNvbWUKcmVhc29u
IHRoZSBvcmlnaW5hbCBvcGVyYXRpb24gbmV2ZXIgcmVzdGFydHMsIHRoZW4g
b24gZG9tYWluCmRlc3RydWN0aW9uLCByZWxpbnF1aXNoX21lbW9yeSgpIHdp
bGwgY2FsbCBmcmVlX3BhZ2VfdHlwZSgpIG9uIHRoZQpwYWdlLgoKVW5mb3J0
dW5hdGVseSwgYWxsb2NfIGFuZCBmcmVlX2wxX3RhYmxlKCkgYXJlbid0IHNl
dCB1cCB0byBkZWFsIHdpdGgKUEdUX3BhcnRpYWwuICBXaGVuIHJldHVybmlu
ZyBhIGZhaWx1cmUsIGFsbG9jX2wxX3RhYmxlKCkgYWx3YXlzCmRlLXZhbGlk
YXRlcyB3aGF0ZXZlciBpdCdzIHZhbGlkYXRlZCBzbyBmYXIsIGFuZCBmcmVl
X2wxX3RhYmxlKCkKYWx3YXlzIGRldmFsaWRhdGVzIHRoZSB3aG9sZSBwYWdl
LiAgVGhpcyBtZWFucyB0aGF0IGlmCnJlbGlucXVpc2hfbWVtb3J5KCkgY2Fs
bHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBhbiBMMSB0aGF0IGRpZG4ndApjb21w
bGV0ZSBkdWUgdG8gYW4gTDFURiwgaXQgd2lsbCBjYWxsIHB1dF9wYWdlX2Zy
b21fbDFlKCkgb24gInBhZ2UKZW50cmllcyIgdGhhdCBoYXZlIG5ldmVyIGJl
ZW4gdmFsaWRhdGVkLgoKRm9yIEwyKyB0YWJsZXMsIHNldHRpbmcgcmMgdG8g
RVJFU1RBUlQgY2F1c2VzIHRoZSByZXN0IG9mIHRoZQphbGxvY19sTl90YWJs
ZSgpIGZ1bmN0aW9uIHRvICp0aGluayogdGhhdCB0aGUgZW50cnkgaW4gcXVl
c3Rpb24gd2lsbApoYXZlIFBHVF9wYXJ0aWFsIHNldC4gIFRoaXMgd2lsbCBj
YXVzZSBpdCB0byBzZXQgcGFydGlhbF9wdGUgPSAxLiAgSWYKcmVsaW5xdXNo
X21lbW9yeSgpIHRoZW4gY2FsbHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBvbmUg
b2YgdGhvc2UgcGFnZXMsCnRoZW4gZnJlZV9sTl90YWJsZSgpIHdpbGwgY2Fs
bCBwdXRfcGFnZV9mcm9tX2xOZSgpIG9uIHRoZSBlbnRyeSB3aGVuCml0IHNo
b3VsZG4ndC4KClJhdGhlciB0aGFuIGluZGljYXRpbmcgLUVSRVNUQVJULCBp
bmRpY2F0ZSAtRUlOVFIuICBUaGlzIGlzIHRoZSBjb2RlCnRvIGluZGljYXRl
IHRoYXQgbm90aGluZyBoYXMgY2hhbmdlZCBmcm9tIHdoZW4geW91IHN0YXJ0
ZWQgdGhlIGNhbGwKKHdoaWNoIGlzIGVmZmVjdGl2ZWx5IGhvdyBhbGxvY19s
MV90YWJsZSgpIGhhbmRsZXMgZXJyb3JzKS4KCm1vZF9sTl9lbnRyeSgpIHNo
b3VsZG4ndCBoYXZlIGFueSBvZiB0aGVzZSB0eXBlcyBvZiBwcm9ibGVtcywg
c28gbGVhdmUKcG90ZW50aWFsIGNoYW5nZXMgdGhlcmUgZm9yIGEgY2xlYW4t
dXAgcGF0Y2ggbGF0ZXIuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJl
cG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5k
dW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDgg
KysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBiZGMyNjgyMTU0Li5iNWRlNmMx
MDhhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTI1Nyw3ICsxMjU3LDcgQEAgZ2V0X3BhZ2Vf
ZnJvbV9sMmUoCiAgICAgaW50IHJjOwogCiAgICAgaWYgKCAhKGwyZV9nZXRf
ZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKLSAgICAgICAgcmV0dXJu
IHB2X2wxdGZfY2hlY2tfbDJlKGQsIGwyZSkgPyAtRVJFU1RBUlQgOiAxOwor
ICAgICAgICByZXR1cm4gcHZfbDF0Zl9jaGVja19sMmUoZCwgbDJlKSA/IC1F
SU5UUiA6IDE7CiAKICAgICBpZiAoIHVubGlrZWx5KChsMmVfZ2V0X2ZsYWdz
KGwyZSkgJiBMMl9ESVNBTExPV19NQVNLKSkgKQogICAgIHsKQEAgLTEzMDAs
NyArMTMwMCw3IEBAIGdldF9wYWdlX2Zyb21fbDNlKAogICAgIGludCByYzsK
IAogICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QUkVT
RU5UKSApCi0gICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2wzZShkLCBs
M2UpID8gLUVSRVNUQVJUIDogMTsKKyAgICAgICAgcmV0dXJuIHB2X2wxdGZf
Y2hlY2tfbDNlKGQsIGwzZSkgPyAtRUlOVFIgOiAxOwogCiAgICAgaWYgKCB1
bmxpa2VseSgobDNlX2dldF9mbGFncyhsM2UpICYgbDNfZGlzYWxsb3dfbWFz
ayhkKSkpICkKICAgICB7CkBAIC0xMzI3LDcgKzEzMjcsNyBAQCBnZXRfcGFn
ZV9mcm9tX2w0ZSgKICAgICBpbnQgcmM7CiAKICAgICBpZiAoICEobDRlX2dl
dF9mbGFncyhsNGUpICYgX1BBR0VfUFJFU0VOVCkgKQotICAgICAgICByZXR1
cm4gcHZfbDF0Zl9jaGVja19sNGUoZCwgbDRlKSA/IC1FUkVTVEFSVCA6IDE7
CisgICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2w0ZShkLCBsNGUpID8g
LUVJTlRSIDogMTsKIAogICAgIGlmICggdW5saWtlbHkoKGw0ZV9nZXRfZmxh
Z3MobDRlKSAmIEw0X0RJU0FMTE9XX01BU0spKSApCiAgICAgewpAQCAtMTU5
Myw3ICsxNTkzLDcgQEAgc3RhdGljIGludCBhbGxvY19sMV90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHsKICAgICAgICAgaWYgKCAhKGwx
ZV9nZXRfZmxhZ3MocGwxZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIHJldCA9IHB2X2wxdGZfY2hlY2tfbDFlKGQs
IHBsMWVbaV0pID8gLUVSRVNUQVJUIDogMDsKKyAgICAgICAgICAgIHJldCA9
IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBsMWVbaV0pID8gLUVJTlRSIDogMDsK
ICAgICAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgICAgICBnb3Rv
IG91dDsKICAgICAgICAgfQotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0003-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0003-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Transfer-Encoding: base64

RnJvbSA2M2EwMzBjNmZiYjc0ZTE5YjU4MGU0YzQ2ZGQyNWJiYjFjOGE2MTc4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAzLzEyXSB4
ODYvbW06IERvbid0IHJlLXNldCBQR1RfcGlubmVkIG9uIGEgcGFydGlhbGx5
CiBkZS12YWxpZGF0ZWQgcGFnZQoKV2hlbiB1bnBpbm5pbmcgcGFnZXRhYmxl
cywgaWYgYW4gb3BlcmF0aW9uIGlzIGludGVycnVwdGVkLApyZWxpbnF1aXNo
X21lbW9yeSgpIHJlLXNldHMgUEdUX3Bpbm5lZCBzbyB0aGF0IHRoZSB1bi1w
aW4gd2lsbApwaWNrZWR1cCBhZ2FpbiB3aGVuIHRoZSBoeXBlcmNhbGwgcmVz
dGFydHMuCgpUaGlzIGlzIGFwcHJvcHJpYXRlIHdoZW4gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKSByZXR1cm5zCi1FSU5UUiwgd2hpY2ggaW5k
aWNhdGVzIHRoYXQgdGhlIHBhZ2UgaXMgYmFjayBpbiBpdHMgaW5pdGlhbCBz
dGF0ZQooaS5lLiwgY29tcGxldGVseSB2YWxpZGF0ZWQpLiAgSG93ZXZlciwg
Zm9yIC1FUkVTVEFSVCwgdGhpcyBsZWFkcyB0byBhCnN0YXRlIHdoZXJlIGEg
cGFnZSBoYXMgYm90aCBQR1RfcGlubmVkIGFuZCBQR1RfcGFydGlhbCBzZXQu
CgpUaGlzIGhhcHBlbnMgdG8gd29yayBhdCB0aGUgbW9tZW50LCBhbHRob3Vn
aCBpdCdzIG5vdCByZWFsbHkgYQoiY2Fub25pY2FsIiBzdGF0ZTsgYnV0IGlu
IHN1YnNlcXVlbnQgcGF0Y2hlcywgd2hlcmUgd2UgbmVlZCB0byBtYWtlIGEK
ZGlzdGluY3Rpb24gaW4gaGFuZGxpbmcgYmV0d2VlbiBQR1RfdmFsaWRhdGVk
IGFuZCBQR1RfcGFydGlhbCBwYWdlcywKdGhpcyBjYXVzZXMgaXNzdWVzLgoK
TW92ZSB0byBhICJjYW5vbmljYWwiIHN0YXRlIGJ5OgotIE9ubHkgcmUtc2V0
dGluZyBQR1RfcGlubmVkIG9uIC1FSU5UUgotIFJlLWRyb3BwaW5nIHRoZSBy
ZWZjb3VudCBoZWxkIGJ5IFBHVF9waW5uZWQgb24gLUVSRVNUQVJUCgpJbiB0
aGUgbGF0dGVyIGNhc2UsIHRoZSBQR1RfcGFydGlhbCBiaXQgd2lsbCBiZSBj
bGVhcmVkIGZ1cnRoZXIgZG93bgp3aXRoIHRoZSByZXN0IG9mIHRoZSBvdGhl
ciBQR1RfcGFydGlhbCBwYWdlcy4KCldoaWxlIGhlcmUsIGNsZWFuIHVwIHNv
bWUgdHJhaW5saW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVu
bGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tYWluLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggYjFlMmNmYTI3ZS4uMWE0Zjg5
YTZiMSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTU5LDcgKzE1OSw3IEBAIHN0
YXRpYyB2b2lkIHBsYXlfZGVhZCh2b2lkKQogICAgICAqIHRoaXMgY2FzZSwg
aGVhcCBjb3JydXB0aW9uIG9yICNQRiBjYW4gb2NjdXIgKHdoZW4gaGVhcCBk
ZWJ1Z2dpbmcgaXMKICAgICAgKiBlbmFibGVkKS4gRm9yIGV4YW1wbGUsIGV2
ZW4gcHJpbnRrKCkgY2FuIGludm9sdmUgdGFza2xldCBzY2hlZHVsaW5nLAog
ICAgICAqIHdoaWNoIHRvdWNoZXMgcGVyLWNwdSB2YXJzLgotICAgICAqIAor
ICAgICAqCiAgICAgICogQ29uc2lkZXIgdmVyeSBjYXJlZnVsbHkgd2hlbiBh
ZGRpbmcgY29kZSB0byAqZGVhZF9pZGxlLiBNb3N0IGh5cGVydmlzb3IKICAg
ICAgKiBzdWJzeXN0ZW1zIGFyZSB1bnNhZmUgdG8gY2FsbC4KICAgICAgKi8K
QEAgLTI0MDUsOSArMjQwNSwzNCBAQCBzdGF0aWMgaW50IHJlbGlucXVpc2hf
bWVtb3J5KAogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLUVS
RVNUQVJUOgogICAgICAgICBjYXNlIC1FSU5UUjoKKyAgICAgICAgICAgIC8q
CisgICAgICAgICAgICAgKiAtRUlOVFIgbWVhbnMgUEdUX3ZhbGlkYXRlZCBo
YXMgYmVlbiByZS1zZXQ7IHJlLXNldAorICAgICAgICAgICAgICogUEdUX3Bp
bm5lZCBhZ2FpbiBzbyB0aGF0IGl0IGdldHMgcGlja2VkIHVwIG5leHQgdGlt
ZQorICAgICAgICAgICAgICogYXJvdW5kLgorICAgICAgICAgICAgICoKKyAg
ICAgICAgICAgICAqIC1FUkVTVEFSVCwgT1RPSCwgbWVhbnMgUEdUX3BhcnRp
YWwgaXMgc2V0IGluc3RlYWQuICBQdXQKKyAgICAgICAgICAgICAqIGl0IGJh
Y2sgb24gdGhlIGxpc3QsIGJ1dCBkb24ndCBzZXQgUEdUX3Bpbm5lZDsgdGhl
CisgICAgICAgICAgICAgKiBzZWN0aW9uIGJlbG93IHdpbGwgZmluaXNoIG9m
ZiBkZS12YWxpZGF0aW9uLiAgQnV0IHdlIGRvCisgICAgICAgICAgICAgKiBu
ZWVkIHRvIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGFzc29jaWF0ZWQgd2l0aAor
ICAgICAgICAgICAgICogUEdUX3Bpbm5lZCwgc2luY2UgcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKQorICAgICAgICAgICAgICogZGlkbid0IGRv
IGl0LgorICAgICAgICAgICAgICoKKyAgICAgICAgICAgICAqIE5CIHdlIGNh
biBkbyBhbiBBU1NFUlQgZm9yIFBHVF92YWxpZGF0ZWQsIHNpbmNlIHdlCisg
ICAgICAgICAgICAgKiAib3duIiB0aGUgdHlwZSByZWY7IGJ1dCB0aGVvcmV0
aWNhbGx5LCB0aGUgUEdUX3BhcnRpYWwKKyAgICAgICAgICAgICAqIGNvdWxk
IGJlIGNsZWFyZWQgYnkgc29tZW9uZSBlbHNlLgorICAgICAgICAgICAgICov
CisgICAgICAgICAgICBpZiAoIHJldCA9PSAtRUlOVFIgKQorICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIEFTU0VSVChwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmIFBHVF92YWxpZGF0ZWQpOworICAgICAgICAgICAgICAgIHNl
dF9iaXQoX1BHVF9waW5uZWQsICZwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICBlbHNlCisgICAgICAgICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CisKICAgICAgICAgICAgIHJldCA9IC1F
UkVTVEFSVDsKKworICAgICAgICAgICAgLyogUHV0IHRoZSBwYWdlIGJhY2sg
b24gdGhlIGxpc3QgYW5kIGRyb3AgdGhlIHJlZiB3ZSBncmFiYmVkIGFib3Zl
ICovCiAgICAgICAgICAgICBwYWdlX2xpc3RfYWRkKHBhZ2UsIGxpc3QpOwot
ICAgICAgICAgICAgc2V0X2JpdChfUEdUX3Bpbm5lZCwgJnBhZ2UtPnUuaW51
c2UudHlwZV9pbmZvKTsKICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwog
ICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIGRlZmF1bHQ6CkBAIC0y
NjMxLDcgKzI2NTYsNyBAQCB2b2lkIHZjcHVfa2ljayhzdHJ1Y3QgdmNwdSAq
dikKICAgICAgKiBwZW5kaW5nIGZsYWcuIFRoZXNlIHZhbHVlcyBtYXkgZmx1
Y3R1YXRlIChhZnRlciBhbGwsIHdlIGhvbGQgbm8KICAgICAgKiBsb2Nrcykg
YnV0IHRoZSBrZXkgaW5zaWdodCBpcyB0aGF0IGVhY2ggY2hhbmdlIHdpbGwg
Y2F1c2UKICAgICAgKiBldnRjaG5fdXBjYWxsX3BlbmRpbmcgdG8gYmUgcG9s
bGVkLgotICAgICAqIAorICAgICAqCiAgICAgICogTkIyLiBXZSBzYXZlIHRo
ZSBydW5uaW5nIGZsYWcgYWNyb3NzIHRoZSB1bmJsb2NrIHRvIGF2b2lkIGEg
bmVlZGxlc3MKICAgICAgKiBJUEkgZm9yIGRvbWFpbnMgdGhhdCB3ZSBJUEkn
ZCB0byB1bmJsb2NrLgogICAgICAqLwotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0004-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0004-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Transfer-Encoding: base64

RnJvbSBkZDc1YzM1MTYyMDU1ZTI5NGY4ZmE0ZGM5NjA5YTliMmVhODFkNDM4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA0LzEyXSB4
ODYvbW06IFNlcGFyYXRlIG91dCBwYXJ0aWFsX3B0ZSB0cmlzdGF0ZSBpbnRv
CiBpbmRpdmlkdWFsIGZsYWdzCgpBdCB0aGUgbW9tZW50LCBwYXJ0aWFsX3B0
ZSBpcyBhIHRyaS1zdGF0ZSB0aGF0IGNvbnRhaW5zIHR3byBkaXN0aW5jdCBi
aXRzCm9mIGluZm9ybWF0aW9uOgoKMS4gSWYgemVybywgdGhlIHB0ZSBhdCBp
bmRleCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHVuLXZhbGlkYXRlZC4gIElm
CiAgIG5vbi16ZXJvLCB0aGUgcHRlIHdhcyBsYXN0IHNlZW4gd2l0aCBQR1Rf
cGFydGlhbCBzZXQuCgoyLiBJZiBwb3NpdGl2ZSwgdGhlIHB0ZSBhdCBpbmRl
eCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGRvZXMgbm90IGhvbGQgYQogICBnZW5l
cmFsIHJlZmVyZW5jZSBjb3VudC4gIElmIG5lZ2F0aXZlLCBpdCBkb2VzLgoK
VG8gbWFrZSBmdXR1cmUgcGF0Y2hlcyBtb3JlIGNsZWFyLCBzZXBhcmF0ZSBv
dXQgdGhpcyBmdW5jdGlvbmFsaXR5CmludG8gdHdvIGRpc3RpbmN0LCBuYW1l
ZCBiaXRzOiBQVEZfcGFydGlhbF9zZXQgKGZvciAjMSkgYW5kClBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIChmb3IgIzIpLgoKQWRkaXRpb25hbGx5LCBhIG51
bWJlciBvZiBmdW5jdGlvbnMgd2hpY2ggbmVlZCB0aGlzIGluZm9ybWF0aW9u
IGFsc28KdGFrZSBvdGhlciBmbGFncyB0byBjb250cm9sIGJlaGF2aW9yIChz
dWNoIGFzIGBwcmVlbXB0aWJsZWAgYW5kCmBkZWZlcmApLiAgVGhlc2UgYXJl
IGhhcmQgdG8gcmVhZCBpbiB0aGUgY2FsbGVyIChzaW5jZSB5b3Ugb25seSBz
ZWUKJ3RydWUnIG9yICdmYWxzZScpLCBhbmQgdWdseSB3aGVuIG1hbnkgYXJl
IGFkZGVkIHRvZ2V0aGVyLiAgSW4KcHJlcGFyYXRpb24gZm9yIGFkZGluZyB5
ZXQgYW5vdGhlciBmbGFnIGluIGEgZnV0dXJlIHBhdGNoLCBjb2xsYXBzZQph
bGwgb2YgdGhlc2UgaW50byBhIHNpbmdsZSBgZmxhZ2AgdmFyaWFibGUuCgpO
QiB0aGF0IHRoaXMgZG9lcyBtZWFuIGNoZWNraW5nIGZvciB3aGF0IHdhcyBw
cmV2aW91c2x5IHRoZSAnLTEnCmNvbmRpdGlvbiBhIGJpdCBtb3JlIHVnbHkg
aW4gdGhlIHB1dF9wYWdlX2Zyb21fbE5lIGZ1bmN0aW9ucyAoc2luY2UKeW91
IGhhdmUgdG8gY2hlY2sgZm9yIGJvdGggcGFydGlhbF9zZXQgYW5kIGdlbmVy
YWwgcmVmKTsgYnV0IHRoaXMKY2xhdXNlIHdpbGwgZ28gYXdheSBpbiBhIGZ1
dHVyZSBwYXRjaC4KCkFsc28gbm90ZSB0aGF0IHRoZSBvcmlnaW5hbCBjb21t
ZW50IGhhZCBhbiBvZmYtYnktb25lIGVycm9yOgpwYXJ0aWFsX2ZsYWdzIChs
aWtlIHBhcnRpYWxfcHRlIGJlZm9yZSBpdCkgY29uY2VybnMKcGxOZVtucl92
YWxpZGF0ZWRfcHRlc10sIG5vdCBwbE5lW25yX3ZhbGlkYXRlZF9wdGVzKzFd
LgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyAgICAgICAgfCAxNjYgKysrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggfCAgNDEgKysrKysrKy0tLQogMiBmaWxlcyBjaGFuZ2VkLCAxMjggaW5z
ZXJ0aW9ucygrKSwgNzkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBiNWRl
NmMxMDhhLi45ZDIyNWUzYzI4IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNzcwLDIyICs3NzAs
MzUgQEAgc3RhdGljIGludCBnZXRfcGFnZV9mcm9tX3BhZ2Vucih1bnNpZ25l
ZCBsb25nIHBhZ2VfbnIsIHN0cnVjdCBkb21haW4gKmQpCiBzdGF0aWMgaW50
IF9fZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgcHJlZW1wdGlibGUpOwogCisvKgorICogVGhlIGZvbGxvd2luZyBmbGFn
cyBhcmUgdXNlZCB0byBzcGVjaWZ5IGJlaGF2aW9yIG9mIHZhcmlvdXMgZ2V0
IGFuZAorICogcHV0IGNvbW1hbmRzLiAgVGhlIGZpcnN0IHR3byBhcmUgYWxz
byBzdG9yZWQgaW4gcGFnZS0+cGFydGlhbF9mbGFncworICogdG8gaW5kaWNh
dGUgdGhlIHN0YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQgdG8gYnkKKyAqIHBh
Z2UtPnB0ZVtwYWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhl
IGNvbW1lbnQgaW4gbW0uaCBmb3IKKyAqIG1vcmUgaW5mb3JtYXRpb24uCisg
Ki8KKyNkZWZpbmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwgMCkK
KyNkZWZpbmUgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkKKyNk
ZWZpbmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKKyNkZWZp
bmUgUFRGX2RlZmVyICAgICAgICAgICAgICAgKDEgPDwgMykKKwogc3RhdGlj
IGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3BhZ2Vucih1bnNpZ25lZCBs
b25nIHBhZ2VfbnIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGxvbmcgdHlwZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRvbWFpbiAqZCwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
IHBhcnRpYWwsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBwcmVlbXB0aWJsZSkKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKQogewog
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9fcGFnZShwYWdl
X25yKTsKICAgICBpbnQgcmM7CisgICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZs
YWdzICYgUFRGX3ByZWVtcHRpYmxlLAorICAgICAgICAgcGFydGlhbF9yZWYg
PSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogCi0gICAgaWYg
KCBsaWtlbHkocGFydGlhbCA+PSAwKSAmJgorICAgIGlmICggbGlrZWx5KCFw
YXJ0aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9m
cm9tX3BhZ2VucihwYWdlX25yLCBkKSkgKQogICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKIAogICAgIHJjID0gX19nZXRfcGFnZV90eXBlKHBhZ2UsIHR5cGUs
IHByZWVtcHRpYmxlKTsKIAotICAgIGlmICggdW5saWtlbHkocmMpICYmIHBh
cnRpYWwgPj0gMCAmJgorICAgIGlmICggdW5saWtlbHkocmMpICYmICFwYXJ0
aWFsX3JlZiAmJgogICAgICAgICAgKCFwcmVlbXB0aWJsZSB8fCBwYWdlICE9
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKSApCiAgICAgICAgIHB1
dF9wYWdlKHBhZ2UpOwogCkBAIC0xMjUxLDcgKzEyNjQsNyBAQCBnZXRfcGFn
ZV9mcm9tX2wxZSgKIGRlZmluZV9nZXRfbGluZWFyX3BhZ2V0YWJsZShsMik7
CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9tX2wyZSgKLSAgICBsMl9wZ2Vu
dHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3RydWN0IGRvbWFpbiAq
ZCwgaW50IHBhcnRpYWwpCisgICAgbDJfcGdlbnRyeV90IGwyZSwgdW5zaWdu
ZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGludCBm
bGFncykKIHsKICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwyZV9nZXRfcGZu
KGwyZSk7CiAgICAgaW50IHJjOwpAQCAtMTI2OCw4ICsxMjgxLDkgQEAgZ2V0
X3BhZ2VfZnJvbV9sMmUoCiAKICAgICBpZiAoICEobDJlX2dldF9mbGFncyhs
MmUpICYgX1BBR0VfUFNFKSApCiAgICAgewotICAgICAgICByYyA9IGdldF9w
YWdlX2FuZF90eXBlX2Zyb21fcGFnZW5yKG1mbiwgUEdUX2wxX3BhZ2VfdGFi
bGUsIGQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcGFydGlhbCwgZmFsc2UpOworICAgICAgICBBU1NFUlQoIShmbGFn
cyAmIFBURl9wcmVlbXB0aWJsZSkpOworCisgICAgICAgIHJjID0gZ2V0X3Bh
Z2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobWZuLCBQR1RfbDFfcGFnZV90YWJs
ZSwgZCwgZmxhZ3MpOwogICAgICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1F
SU5WQUwpICYmIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKGwyZSwgcGZuLCBk
KSApCiAgICAgICAgICAgICByYyA9IDA7CiAgICAgICAgIHJldHVybiByYzsK
QEAgLTEyOTUsNyArMTMwOSw3IEBAIGdldF9wYWdlX2Zyb21fbDJlKAogZGVm
aW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGwzKTsKIHN0YXRpYyBpbnQKIGdl
dF9wYWdlX2Zyb21fbDNlKAotICAgIGwzX3BnZW50cnlfdCBsM2UsIHVuc2ln
bmVkIGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCBpbnQgcGFydGlhbCkK
KyAgICBsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3Ry
dWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGlu
dCByYzsKIApAQCAtMTMxMCw3ICsxMzI0LDcgQEAgZ2V0X3BhZ2VfZnJvbV9s
M2UoCiAgICAgfQogCiAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9t
X3BhZ2VucigKLSAgICAgICAgbDNlX2dldF9wZm4obDNlKSwgUEdUX2wyX3Bh
Z2VfdGFibGUsIGQsIHBhcnRpYWwsIDEpOworICAgICAgICBsM2VfZ2V0X3Bm
bihsM2UpLCBQR1RfbDJfcGFnZV90YWJsZSwgZCwgZmxhZ3MgfCBQVEZfcHJl
ZW1wdGlibGUpOwogICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkg
JiYKICAgICAgICAgICFpc19wdl8zMmJpdF9kb21haW4oZCkgJiYKICAgICAg
ICAgIGdldF9sM19saW5lYXJfcGFnZXRhYmxlKGwzZSwgcGZuLCBkKSApCkBA
IC0xMzIyLDcgKzEzMzYsNyBAQCBnZXRfcGFnZV9mcm9tX2wzZSgKIGRlZmlu
ZV9nZXRfbGluZWFyX3BhZ2V0YWJsZShsNCk7CiBzdGF0aWMgaW50CiBnZXRf
cGFnZV9mcm9tX2w0ZSgKLSAgICBsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25l
ZCBsb25nIHBmbiwgc3RydWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisg
ICAgbDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVj
dCBkb21haW4gKmQsIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBpbnQg
cmM7CiAKQEAgLTEzMzcsNyArMTM1MSw3IEBAIGdldF9wYWdlX2Zyb21fbDRl
KAogICAgIH0KIAogICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9w
YWdlbnIoCi0gICAgICAgIGw0ZV9nZXRfcGZuKGw0ZSksIFBHVF9sM19wYWdl
X3RhYmxlLCBkLCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgbDRlX2dldF9wZm4o
bDRlKSwgUEdUX2wzX3BhZ2VfdGFibGUsIGQsIGZsYWdzIHwgUFRGX3ByZWVt
cHRpYmxlKTsKICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYm
IGdldF9sNF9saW5lYXJfcGFnZXRhYmxlKGw0ZSwgcGZuLCBkKSApCiAgICAg
ICAgIHJjID0gMDsKIApAQCAtMTQ2OSw3ICsxNDgzLDcgQEAgdm9pZCBwdXRf
cGFnZV9mcm9tX2wxZShsMV9wZ2VudHJ5X3QgbDFlLCBzdHJ1Y3QgZG9tYWlu
ICpsMWVfb3duZXIpCiAgKiBOb3RlIGFsc28gdGhhdCB0aGlzIGF1dG9tYXRp
Y2FsbHkgZGVhbHMgY29ycmVjdGx5IHdpdGggbGluZWFyIHAudC4ncy4KICAq
Lwogc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3Qg
bDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaW50IHBhcnRpYWwsIGJvb2wgZGVmZXIpCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAg
ICBpbnQgcmMgPSAwOwogCkBAIC0xNDgzLDEyICsxNDk3LDEzIEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBn
ID0gbDJlX2dldF9wYWdlKGwyZSk7CiAgICAgICAgIHN0cnVjdCBwYWdlX2lu
Zm8gKnB0cGcgPSBtZm5fdG9fcGFnZShwZm4pOwogCi0gICAgICAgIGlmICgg
dW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgaWYgKCAoZmxhZ3Mg
JiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYp
KSA9PQorICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAg
ICB7Ci0gICAgICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAgICAgICAg
IEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAgICAgICAgICBy
YyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKICAgICAgICAg
fQotICAgICAgICBlbHNlIGlmICggZGVmZXIgKQorICAgICAgICBlbHNlIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gcHRwZzsKICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGc7CkBA
IC0xNTA1LDcgKzE1MjAsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21f
bDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAogfQog
CiBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBs
M2UsIHVuc2lnbmVkIGxvbmcgcGZuLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbnQgcGFydGlhbCwgYm9vbF90IGRlZmVyKQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcGc7CiAgICAgaW50IHJjOwpAQCAtMTUy
OCwxMyArMTU0MywxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNl
KGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAg
cGcgPSBsM2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggdW5saWtlbHko
cGFydGlhbCA+IDApICkKKyAgICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CisgICAgICAg
ICBQVEZfcGFydGlhbF9zZXQgKQogICAgIHsKLSAgICAgICAgQVNTRVJUKCFk
ZWZlcik7CisgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7
CiAgICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZu
X3RvX3BhZ2UocGZuKSk7CiAgICAgfQogCi0gICAgaWYgKCBkZWZlciApCisg
ICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgewogICAgICAgICBj
dXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UocGZu
KTsKICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBw
ZzsKQEAgLTE1NDksNyArMTU2NSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2Vf
ZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4s
CiB9CiAKIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRy
eV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBwYXJ0aWFsLCBib29sX3QgZGVmZXIpCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykK
IHsKICAgICBpbnQgcmMgPSAxOwogCkBAIC0xNTU4LDEzICsxNTc0LDE0IEBA
IHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0
ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgewogICAgICAgICBzdHJ1Y3Qg
cGFnZV9pbmZvICpwZyA9IGw0ZV9nZXRfcGFnZShsNGUpOwogCi0gICAgICAg
IGlmICggdW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgaWYgKCAo
ZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYpKSA9PQorICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQog
ICAgICAgICB7Ci0gICAgICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAg
ICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAgICAg
ICAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90b19w
YWdlKHBmbikpOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKCBkZWZlciAp
CisgICAgICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7
CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
bWZuX3RvX3BhZ2UocGZuKTsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID0gcGc7CkBAIC0xNjc0LDEyICsxNjkxLDEzIEBA
IHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgIHVuc2lnbmVkIGxvbmcg
IHBmbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgIGwyX3BnZW50cnlfdCAg
KnBsMmU7CiAgICAgdW5zaWduZWQgaW50ICAgaTsKLSAgICBpbnQgICAgICAg
ICAgICByYyA9IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKKyAg
ICBpbnQgICAgICAgICAgICByYyA9IDA7CisgICAgdW5zaWduZWQgaW50ICAg
cGFydGlhbF9mbGFncyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3M7CiAKICAgICBw
bDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAKICAgICBmb3Ig
KCBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMMl9QQUdFVEFC
TEVfRU5UUklFUzsKLSAgICAgICAgICBpKyssIHBhcnRpYWwgPSAwICkKKyAg
ICAgICAgICBpKyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAgICB7CiAgICAg
ICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzICYmIGh5cGVy
Y2FsbF9wcmVlbXB0X2NoZWNrKCkgKQogICAgICAgICB7CkBAIC0xNjg5LDE4
ICsxNzA3LDE5IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAg
ICB9CiAKICAgICAgICAgaWYgKCAhaXNfZ3Vlc3RfbDJfc2xvdChkLCB0eXBl
LCBpKSB8fAotICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDJl
KHBsMmVbaV0sIHBmbiwgZCwgcGFydGlhbCkpID4gMCApCisgICAgICAgICAg
ICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuLCBkLCBw
YXJ0aWFsX2ZsYWdzKSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVlOwog
CiAgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAgewog
ICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAg
ICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IDE7Cisg
ICAgICAgICAgICAvKiBTZXQgJ3NldCcsIHJldGFpbiAnZ2VuZXJhbCByZWYn
ICovCisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlh
bF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAgfQogICAgICAg
ICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgIHJjID0gLUVS
RVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA8IDAg
JiYgcmMgIT0gLUVJTlRSICkKQEAgLTE3MDksNyArMTcyOCw3IEBAIHN0YXRp
YyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwg
dW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAgICAgICAgaWYgKCBpICkKICAg
ICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSAwOworICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3Mg
PSAwOwogICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0
X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKICAgICAgICAgICAgIH0KQEAgLTE3
MzksNyArMTc1OCw4IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB1bnNpZ25lZCBsb25nICBwZm4g
PSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsM19wZ2VudHJ5X3QgICpwbDNl
OwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAgICAg
cmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7CisgICAgaW50
ICAgICAgICAgICAgcmMgPSAwOworICAgIHVuc2lnbmVkIGludCAgIHBhcnRp
YWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCiAgICAgcGwzZSA9
IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCkBAIC0xNzU0LDcgKzE3
NzQsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIG1lbXNldChwbDNlICsgNCwgMCwgKEwz
X1BBR0VUQUJMRV9FTlRSSUVTIC0gNCkgKiBzaXplb2YoKnBsM2UpKTsKIAog
ICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwz
X1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywgcGFydGlhbCA9
IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQogICAg
IHsKICAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
JiYgaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgIHsKQEAg
LTE3NzIsMjEgKzE3OTIsMjMgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJs
ZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICAgICAgICAgIHJj
ID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobDNlX2dldF9wZm4o
cGwzZVtpXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90YWJsZSB8CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQ
R1RfcGFlX3hlbl9sMiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGQsIHBhcnRpYWwsIDEpOworICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgfCBQVEZfcHJlZW1wdGlibGUpOwog
ICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCAhaXNfZ3Vlc3RfbDNfc2xv
dChpKSB8fAotICAgICAgICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJv
bV9sM2UocGwzZVtpXSwgcGZuLCBkLCBwYXJ0aWFsKSkgPiAwICkKKyAgICAg
ICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0s
IHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCiAgICAgICAgICAgICBj
b250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAg
ICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlh
bCA/OiAxOworICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2Vu
ZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KKyAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwg
UFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYg
KCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsKICAgICAgICAgICAg
IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIHBh
Z2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSAwOwogICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAg
ICAgICAgIH0KICAgICAgICAgaWYgKCByYyA8IDAgKQpAQCAtMTgwMyw3ICsx
ODI1LDcgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlKQogICAgICAgICBpZiAoIGkgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgIGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICB9
CkBAIC0xODY5LDE5ICsxODkxLDIxIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB1bnNpZ25lZCBs
b25nICBwZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsNF9wZ2VudHJ5
X3QgICpwbDRlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAgICAg
dW5zaWduZWQgaW50ICAgaTsKLSAgICBpbnQgICAgICAgICAgICByYyA9IDAs
IHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKKyAgICBpbnQgICAgICAg
ICAgICByYyA9IDA7CisgICAgdW5zaWduZWQgaW50ICAgcGFydGlhbF9mbGFn
cyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3M7CiAKICAgICBmb3IgKCBpID0gcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMNF9QQUdFVEFCTEVfRU5UUklF
UzsKLSAgICAgICAgICBpKyssIHBhcnRpYWwgPSAwICkKKyAgICAgICAgICBp
KyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAgICB7CiAgICAgICAgIGlmICgg
IWlzX2d1ZXN0X2w0X3Nsb3QoZCwgaSkgfHwKLSAgICAgICAgICAgICAocmMg
PSBnZXRfcGFnZV9mcm9tX2w0ZShwbDRlW2ldLCBwZm4sIGQsIHBhcnRpYWwp
KSA+IDAgKQorICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDRl
KHBsNGVbaV0sIHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCiAgICAg
ICAgICAgICBjb250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVT
VEFSVCApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRl
ID0gcGFydGlhbCA/OiAxOworICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBs
ZWF2ZSAnZ2VuZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQg
Ki8KKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFs
X2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAgICAg
IGVsc2UgaWYgKCByYyA8IDAgKQogICAgICAgICB7CkBAIC0xODkxLDcgKzE5
MTUsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7
CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAg
ICAgICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAg
ICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBl
bHNlCkBAIC0xOTQ1LDE5ICsxOTY5LDIwIEBAIHN0YXRpYyBpbnQgZnJlZV9s
Ml90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHN0cnVjdCBk
b21haW4gKmQgPSBwYWdlX2dldF9vd25lcihwYWdlKTsKICAgICB1bnNpZ25l
ZCBsb25nIHBmbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwogICAgIGwyX3BnZW50
cnlfdCAqcGwyZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+
cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50IGkgPSBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFsOworICAgIGludCByYyA9IDA7Cisg
ICAgdW5zaWduZWQgaW50IHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFs
X2ZsYWdzLAorICAgICAgICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
LSAhKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpOwogCiAgICAg
cGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCiAgICAgZm9y
ICggOyA7ICkKICAgICB7CiAgICAgICAgIGlmICggaXNfZ3Vlc3RfbDJfc2xv
dChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkgKQotICAgICAgICAg
ICAgcmMgPSBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIHBhcnRp
YWwsIGZhbHNlKTsKKyAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9s
MmUocGwyZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAgaWYg
KCByYyA8IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgcGFy
dGlhbCA9IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogCiAgICAg
ICAgIGlmICggIWktLSApCiAgICAgICAgICAgICBicmVhazsKQEAgLTE5Nzks
MTIgKzIwMDQsMTQgQEAgc3RhdGljIGludCBmcmVlX2wyX3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgZWxzZSBpZiAoIHJjID09IC1FUkVT
VEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
cyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/
OiAtMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFs
X2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/CisgICAgICAgICAgICBwYXJ0
aWFsX2ZsYWdzIDoKKyAgICAgICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CiAgICAgfQogICAgIGVsc2UgaWYg
KCByYyA9PSAtRUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTIC0g
MSApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGkgKyAxOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICByYyA9IC1F
UkVTVEFSVDsKICAgICB9CiAKQEAgLTE5OTYsOCArMjAyMyw5IEBAIHN0YXRp
YyBpbnQgZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQog
ICAgIHN0cnVjdCBkb21haW4gKmQgPSBwYWdlX2dldF9vd25lcihwYWdlKTsK
ICAgICB1bnNpZ25lZCBsb25nIHBmbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOwog
ICAgIGwzX3BnZW50cnlfdCAqcGwzZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0
aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50ICBp
ID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhcGFydGlhbDsKKyAgICBp
bnQgcmMgPSAwOworICAgIHVuc2lnbmVkIGludCBwYXJ0aWFsX2ZsYWdzID0g
cGFnZS0+cGFydGlhbF9mbGFncywKKyAgICAgICAgaSA9IHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzIC0gIShwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxf
c2V0KTsKIAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4p
KTsKIApAQCAtMjAwNSwxMSArMjAzMywxMSBAQCBzdGF0aWMgaW50IGZyZWVf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB7CiAgICAg
ICAgIGlmICggaXNfZ3Vlc3RfbDNfc2xvdChpKSApCiAgICAgICAgIHsKLSAg
ICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9sM2UocGwzZVtpXSwgcGZu
LCBwYXJ0aWFsLCAwKTsKKyAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJv
bV9sM2UocGwzZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAg
ICAgIGlmICggcmMgPCAwICkKICAgICAgICAgICAgICAgICBicmVhazsKIAot
ICAgICAgICAgICAgcGFydGlhbCA9IDA7CisgICAgICAgICAgICBwYXJ0aWFs
X2ZsYWdzID0gMDsKICAgICAgICAgICAgIGlmICggcmMgPT0gMCApCiAgICAg
ICAgICAgICAgICAgdW5hZGp1c3RfZ3Vlc3RfbDNlKHBsM2VbaV0sIGQpOwog
ICAgICAgICB9CkBAIC0yMDI5LDEyICsyMDU3LDE0IEBAIHN0YXRpYyBpbnQg
ZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIGlm
ICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSBwYXJ0aWFsID86IC0xOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2Zs
YWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpID8KKyAg
ICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgorICAgICAgICAgICAgKFBURl9w
YXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsKICAgICB9
CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDNfUEFHRVRB
QkxFX0VOVFJJRVMgLSAxICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzID0gaSArIDE7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxf
cHRlID0gMDsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAg
ICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgIH0KICAgICByZXR1cm4gcmMg
PiAwID8gMCA6IHJjOwpAQCAtMjA0NSwyNiArMjA3NSwyOSBAQCBzdGF0aWMg
aW50IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAg
ICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7CiAg
ICAgdW5zaWduZWQgbG9uZyBwZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAg
ICBsNF9wZ2VudHJ5X3QgKnBsNGUgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihw
Zm4pKTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlh
bF9wdGU7Ci0gICAgdW5zaWduZWQgaW50ICBpID0gcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgLSAhcGFydGlhbDsKKyAgICBpbnQgcmMgPSAwOworICAgIHVu
c2lnbmVkIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzLAor
ICAgICAgICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhKHBhcnRp
YWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpOwogCiAgICAgZG8gewogICAg
ICAgICBpZiAoIGlzX2d1ZXN0X2w0X3Nsb3QoZCwgaSkgKQotICAgICAgICAg
ICAgcmMgPSBwdXRfcGFnZV9mcm9tX2w0ZShwbDRlW2ldLCBwZm4sIHBhcnRp
YWwsIDApOworICAgICAgICAgICAgcmMgPSBwdXRfcGFnZV9mcm9tX2w0ZShw
bDRlW2ldLCBwZm4sIHBhcnRpYWxfZmxhZ3MpOwogICAgICAgICBpZiAoIHJj
IDwgMCApCiAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgcGFydGlhbCA9
IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogICAgIH0gd2hpbGUg
KCBpLS0gKTsKIAogICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7
CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IC0xOworICAgICAg
ICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZf
cGFydGlhbF9zZXQpID8KKyAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgor
ICAgICAgICAgICAgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmKTsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5U
UiAmJiBpIDwgTDRfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CiAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaSArIDE7Ci0gICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFnZS0+cGFy
dGlhbF9mbGFncyA9IDA7CiAgICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAg
IH0KIApAQCAtMjM0NCw3ICsyMzc3LDcgQEAgc3RhdGljIGludCBtb2RfbDJf
ZW50cnkobDJfcGdlbnRyeV90ICpwbDJlLAogICAgICAgICByZXR1cm4gLUVC
VVNZOwogICAgIH0KIAotICAgIHB1dF9wYWdlX2Zyb21fbDJlKG9sMmUsIHBm
biwgMCwgdHJ1ZSk7CisgICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgcGZu
LCBQVEZfZGVmZXIpOwogCiAgICAgcmV0dXJuIHJjOwogfQpAQCAtMjQxOSw3
ICsyNDUyLDcgQEAgc3RhdGljIGludCBtb2RfbDNfZW50cnkobDNfcGdlbnRy
eV90ICpwbDNlLAogICAgICAgICBpZiAoICFjcmVhdGVfcGFlX3hlbl9tYXBw
aW5ncyhkLCBwbDNlKSApCiAgICAgICAgICAgICBCVUcoKTsKIAotICAgIHB1
dF9wYWdlX2Zyb21fbDNlKG9sM2UsIHBmbiwgMCwgMSk7CisgICAgcHV0X3Bh
Z2VfZnJvbV9sM2Uob2wzZSwgcGZuLCBQVEZfZGVmZXIpOwogICAgIHJldHVy
biByYzsKIH0KIApAQCAtMjQ4Miw3ICsyNTE1LDcgQEAgc3RhdGljIGludCBt
b2RfbDRfZW50cnkobDRfcGdlbnRyeV90ICpwbDRlLAogICAgICAgICByZXR1
cm4gLUVGQVVMVDsKICAgICB9CiAKLSAgICBwdXRfcGFnZV9mcm9tX2w0ZShv
bDRlLCBwZm4sIDAsIDEpOworICAgIHB1dF9wYWdlX2Zyb21fbDRlKG9sNGUs
IHBmbiwgUFRGX2RlZmVyKTsKICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTI3
NDgsNyArMjc4MSw3IEBAIGludCBmcmVlX3BhZ2VfdHlwZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgaWYgKCAh
KHR5cGUgJiBQR1RfcGFydGlhbCkgKQogICAgIHsKICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMgPSAxVSA8PCBQQUdFVEFCTEVfT1JERVI7Ci0g
ICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IDA7CiAgICAgfQogCiAgICAgc3dpdGNoICggdHlw
ZSAmIFBHVF90eXBlX21hc2sgKQpAQCAtMzA0Miw3ICszMDc1LDcgQEAgc3Rh
dGljIGludCBfX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogICAgICAgICBpZiAoICEoeCAmIFBH
VF9wYXJ0aWFsKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gMDsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfcHRlID0gMDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3Mg
PSAwOwogICAgICAgICB9CiAgICAgICAgIHBhZ2UtPmxpbmVhcl9wdF9jb3Vu
dCA9IDA7CiAgICAgICAgIHJjID0gYWxsb2NfcGFnZV90eXBlKHBhZ2UsIHR5
cGUsIHByZWVtcHRpYmxlKTsKQEAgLTM0MTQsNyArMzQ0Nyw4IEBAIGludCBu
ZXdfZ3Vlc3RfY3IzKHVuc2lnbmVkIGxvbmcgbWZuKQogCiAgICAgcmMgPSBw
YWdpbmdfbW9kZV9yZWZjb3VudHMoZCkKICAgICAgICAgID8gKGdldF9wYWdl
X2Zyb21fcGFnZW5yKG1mbiwgZCkgPyAwIDogLUVJTlZBTCkKLSAgICAgICAg
IDogZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobWZuLCBQR1Rfcm9v
dF9wYWdlX3RhYmxlLCBkLCAwLCAxKTsKKyAgICAgICAgIDogZ2V0X3BhZ2Vf
YW5kX3R5cGVfZnJvbV9wYWdlbnIobWZuLCBQR1Rfcm9vdF9wYWdlX3RhYmxl
LCBkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBQVEZfcHJlZW1wdGlibGUpOwogICAgIHN3aXRjaCAoIHJjICkKICAgICB7
CiAgICAgY2FzZSAwOgpAQCAtMzgwNyw3ICszODQxLDcgQEAgbG9uZyBkb19t
bXVleHRfb3AoCiAgICAgICAgICAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2Vf
ZnJvbV9wYWdlbnIob3AuYXJnMS5tZm4sIGQpID8gMCA6IC1FSU5WQUw7CiAg
ICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICByYyA9
IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fcGFnZW5yKAotICAgICAgICAgICAg
ICAgICAgICAgICAgb3AuYXJnMS5tZm4sIFBHVF9yb290X3BhZ2VfdGFibGUs
IGQsIDAsIDEpOworICAgICAgICAgICAgICAgICAgICAgICAgb3AuYXJnMS5t
Zm4sIFBHVF9yb290X3BhZ2VfdGFibGUsIGQsIFBURl9wcmVlbXB0aWJsZSk7
CiAKICAgICAgICAgICAgICAgICBpZiAoIHVubGlrZWx5KHJjKSApCiAgICAg
ICAgICAgICAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCmluZGV4IDdlNGZm
ZWIxNjAuLjBiZjViNjBiYTggMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2Fz
bS14ODYvbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKQEAg
LTE0MCwxOSArMTQwLDM0IEBAIHN0cnVjdCBwYWdlX2luZm8KICAgICAgICAg
ICogc2V0dGluZyB0aGUgZmxhZyBtdXN0IG5vdCBkcm9wIHRoYXQgcmVmZXJl
bmNlLCB3aGVyZWFzIHRoZSBpbnN0YW5jZQogICAgICAgICAgKiBjbGVhcmlu
ZyBpdCB3aWxsIGhhdmUgdG8uCiAgICAgICAgICAqCi0gICAgICAgICAqIElm
IEBwYXJ0aWFsX3B0ZSBpcyBwb3NpdGl2ZSB0aGVuIFBURSBhdCBAbnJfdmFs
aWRhdGVkX3B0ZXMrMSBoYXMKLSAgICAgICAgICogYmVlbiBwYXJ0aWFsbHkg
dmFsaWRhdGVkLiBUaGlzIGltcGxpZXMgdGhhdCB0aGUgZ2VuZXJhbCByZWZl
cmVuY2UKLSAgICAgICAgICogdG8gdGhlIHBhZ2UgKGFjcXVpcmVkIGZyb20g
Z2V0X3BhZ2VfZnJvbV9sTmUoKSkgd291bGQgYmUgZHJvcHBlZAotICAgICAg
ICAgKiAoYWdhaW4gZHVlIHRvIHRoZSBhcHBhcmVudCBmYWlsdXJlKSBhbmQg
aGVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZAotICAgICAgICAgKiB3aGVuIHJl
c3VtaW5nIHRoZSB2YWxpZGF0aW9uLCBidXQgbXVzdCBub3QgYmUgZHJvcHBl
ZCB3aGVuIHBpY2tpbmcKLSAgICAgICAgICogdXAgdGhlIHBhZ2UgZm9yIGlu
dmFsaWRhdGlvbi4KKyAgICAgICAgICogSWYgcGFydGlhbF9mbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCBpcyBzZXQsIHRoZW4gdGhlIHBhZ2UgYXQKKyAgICAg
ICAgICogYXQgQG5yX3ZhbGlkYXRlZF9wdGVzIGhhZCBQR1RfcGFydGlhbCBz
ZXQgYXMgYSByZXN1bHQgb2YgYW4KKyAgICAgICAgICogb3BlcmF0aW9uIG9u
IHRoZSBjdXJyZW50IHBhZ2UuICAoVGhhdCBwYWdlIG1heSBvciBtYXkgbm90
CisgICAgICAgICAqIHN0aWxsIGhhdmUgUEdUX3BhcnRpYWwgc2V0LikKICAg
ICAgICAgICoKLSAgICAgICAgICogSWYgQHBhcnRpYWxfcHRlIGlzIG5lZ2F0
aXZlIHRoZW4gUFRFIGF0IEBucl92YWxpZGF0ZWRfcHRlcysxIGhhcwotICAg
ICAgICAgKiBiZWVuIHBhcnRpYWxseSBpbnZhbGlkYXRlZC4gVGhpcyBpcyBi
YXNpY2FsbHkgdGhlIG9wcG9zaXRlIGNhc2Ugb2YKLSAgICAgICAgICogYWJv
dmUsIGkuZS4gdGhlIGdlbmVyYWwgcmVmZXJlbmNlIHRvIHRoZSBwYWdlIHdh
cyBub3QgZHJvcHBlZCBpbgotICAgICAgICAgKiBwdXRfcGFnZV9mcm9tX2xO
ZSgpIChkdWUgdG8gdGhlIGFwcGFyZW50IGZhaWx1cmUpLCBhbmQgaGVuY2Ug
aXQKLSAgICAgICAgICogbXVzdCBiZSBkcm9wcGVkIHdoZW4gdGhlIHB1dCBv
cGVyYXRpb24gaXMgcmVzdW1lZCAoYW5kIGNvbXBsZXRlcyksCi0gICAgICAg
ICAqIGJ1dCBpdCBtdXN0IG5vdCBiZSBhY3F1aXJlZCBpZiBwaWNraW5nIHVw
IHRoZSBwYWdlIGZvciB2YWxpZGF0aW9uLgorICAgICAgICAgKiBJZiBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZiBpcyBzZXQsIHRoZW4gdGhlIFBURSBhdAor
ICAgICAgICAgKiBAbnJfdmFsaWRhdGVkX3B0ZWYgaG9sZHMgYSBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBmb3IgdGhlCisgICAgICAgICAqIHBhZ2UuCisg
ICAgICAgICAqCisgICAgICAgICAqIFRoaXMgaGFwcGVuczoKKyAgICAgICAg
ICogLSBEdXJpbmcgZGUtdmFsaWRhdGlvbiwgaWYgZGUtdmFsaWRhdGlvbiBv
ZiB0aGUgcGFnZSB3YXMKKyAgICAgICAgICogICBpbnRlcnJ1cHRlZAorICAg
ICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBhbiBpbnZhbGlkIGVu
dHJ5IGlzIGVuY291bnRlcmVkIGFuZAorICAgICAgICAgKiAgIHZhbGlkYXRp
b24gaXMgcHJlZW1wdGlibGUKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRh
dGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgd2FzIHNldCBvbgor
ICAgICAgICAgKiAgIHRoaXMgZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFw
cyBiZWNhdXNlIHdlJ3JlIHBpY2tpbmcKKyAgICAgICAgICogICB1cCBmcm9t
IGEgcGFydGlhbCBkZS12YWxpZGF0aW9uKS4KKyAgICAgICAgICoKKyAgICAg
ICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBpcyBjbGVhciwKKyAgICAgICAgICogdGhlbiBhIGdl
bmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQ7IGlmIGl0IGlz
IHNldCwgbm8KKyAgICAgICAgICogcmVmZXJlbmNlIHNob3VsZCBiZSBhY3F1
aXJlZC4KKyAgICAgICAgICoKKyAgICAgICAgICogV2hlbiByZXN1bWluZyBk
ZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcwor
ICAgICAgICAgKiBjbGVhciwgbm8gcmVmZXJlbmNlIHNob3VsZCBiZSBkcm9w
cGVkOyBpZiBpdCBpcyBzZXQsIGEKKyAgICAgICAgICogcmVmZXJlbmNlIHNo
b3VsZCBiZSBkcm9wcGVkLgorICAgICAgICAgKgorICAgICAgICAgKiBOQiB0
aGF0IFBURl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9y
ZWYgYXJlCisgICAgICAgICAqIGRlZmluZWQgaW4gbW0uYywgdGhlIG9ubHkg
cGxhY2Ugd2hlcmUgdGhleSBhcmUgdXNlZC4KICAgICAgICAgICoKICAgICAg
ICAgICogVGhlIDNyZCBmaWVsZCwgQGxpbmVhcl9wdF9jb3VudCwgaW5kaWNh
dGVzCiAgICAgICAgICAqIC0gYnkgYSBwb3NpdGl2ZSB2YWx1ZSwgaG93IG1h
bnkgc2FtZS1sZXZlbCBwYWdlIHRhYmxlIGVudHJpZXMgYSBwYWdlCkBAIC0x
NjMsNyArMTc4LDcgQEAgc3RydWN0IHBhZ2VfaW5mbwogICAgICAgICBzdHJ1
Y3QgewogICAgICAgICAgICAgdTE2IG5yX3ZhbGlkYXRlZF9wdGVzOlBBR0VU
QUJMRV9PUkRFUiArIDE7CiAgICAgICAgICAgICB1MTYgOjE2IC0gUEFHRVRB
QkxFX09SREVSIC0gMSAtIDI7Ci0gICAgICAgICAgICBzMTYgcGFydGlhbF9w
dGU6MjsKKyAgICAgICAgICAgIHUxNiBwYXJ0aWFsX2ZsYWdzOjI7CiAgICAg
ICAgICAgICBzMTYgbGluZWFyX3B0X2NvdW50OwogICAgICAgICB9OwogCi0t
IAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0005-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0005-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Transfer-Encoding: base64

RnJvbSA5ODU5ZmI5OGJkNDFiYzc5ZjdkZDY5NmM1ZGM1ZjA5NWY2MDM4Mjll
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA1LzEyXSB4
ODYvbW06IFVzZSBmbGFncyBmb3IgX3B1dF9wYWdlX3R5cGUgcmF0aGVyIHRo
YW4gYQogYm9vbGVhbgoKVGhpcyBpcyBpbiBtYWlubHkgaW4gcHJlcGFyYXRp
b24gZm9yIF9wdXRfcGFnZV90eXBlIHRha2luZyB0aGUKcGFydGlhbF9mbGFn
cyB2YWx1ZSBpbiB0aGUgZnV0dXJlLiAgSXQgYWxzbyBtYWtlcyBpdCBlYXNp
ZXIgdG8gcmVhZCBpbgp0aGUgY2FsbGVyIChzaW5jZSB5b3Ugc2VlIGEgZmxh
ZyBuYW1lIHJhdGhlciB0aGFuIGB0cnVlYCBvciBgZmFsc2VgKS4KCk5vIGZ1
bmN0aW9uYWwgY2hhbmdlIGludGVuZGVkLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0yOTkuCgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2
L21tLmMgfCAyNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tCiAxIGZpbGUg
Y2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA5ZDIyNWUzYzI4Li4yY2YwYzMzZDE4IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTQxNyw3ICsxNDE3LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sNGUoCiAgICAg
ICAgICAgICBsM2VfcmVtb3ZlX2ZsYWdzKChwbDNlKSwgX1BBR0VfVVNFUnxf
UEFHRV9SV3xfUEFHRV9BQ0NFU1NFRCk7ICAgXAogICAgIH0gd2hpbGUgKCAw
ICkKIAotc3RhdGljIGludCBfcHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlLCBib29sIHByZWVtcHRpYmxlLAorc3RhdGljIGludCBfcHV0
X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBp
bnQgZmxhZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBw
YWdlX2luZm8gKnB0cGcpOwogCiB2b2lkIHB1dF9wYWdlX2Zyb21fbDFlKGwx
X3BnZW50cnlfdCBsMWUsIHN0cnVjdCBkb21haW4gKmwxZV9vd25lcikKQEAg
LTE1MDEsNyArMTUwMSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9s
MmUobDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAg
ICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgICAgIHsKICAgICAg
ICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7Ci0gICAgICAg
ICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKKyAg
ICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0
aWJsZSwgcHRwZyk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKICAgICAgICAgewpAQCAtMTUxMCw3ICsxNTEw
LDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5
X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgfQogICAgICAg
ICBlbHNlCiAgICAgICAgIHsKLSAgICAgICAgICAgIHJjID0gX3B1dF9wYWdl
X3R5cGUocGcsIHRydWUsIHB0cGcpOworICAgICAgICAgICAgcmMgPSBfcHV0
X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBwdHBnKTsKICAgICAg
ICAgICAgIGlmICggbGlrZWx5KCFyYykgKQogICAgICAgICAgICAgICAgIHB1
dF9wYWdlKHBnKTsKICAgICAgICAgfQpAQCAtMTU0Nyw3ICsxNTQ3LDcgQEAg
c3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3QgbDNl
LCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgIFBURl9wYXJ0aWFsX3Nl
dCApCiAgICAgewogICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZl
cikpOwotICAgICAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUs
IG1mbl90b19wYWdlKHBmbikpOworICAgICAgICByZXR1cm4gX3B1dF9wYWdl
X3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UocGZuKSk7
CiAgICAgfQogCiAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCkBAIC0x
NTU3LDcgKzE1NTcsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNl
KGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICByZXR1cm4gMDsKICAgICB9CiAKLSAgICByYyA9IF9wdXRfcGFnZV90eXBl
KHBnLCB0cnVlLCBtZm5fdG9fcGFnZShwZm4pKTsKKyAgICByYyA9IF9wdXRf
cGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKHBm
bikpOwogICAgIGlmICggbGlrZWx5KCFyYykgKQogICAgICAgICBwdXRfcGFn
ZShwZyk7CiAKQEAgLTE1NzgsNyArMTU3OCw3IEBAIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCiAgICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAg
ICAgIHsKICAgICAgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVy
KSk7Ci0gICAgICAgICAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRy
dWUsIG1mbl90b19wYWdlKHBmbikpOworICAgICAgICAgICAgcmV0dXJuIF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdl
KHBmbikpOwogICAgICAgICB9CiAKICAgICAgICAgaWYgKCBmbGFncyAmIFBU
Rl9kZWZlciApCkBAIC0xNTg4LDcgKzE1ODgsNyBAQCBzdGF0aWMgaW50IHB1
dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxv
bmcgcGZuLAogICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgIH0KIAot
ICAgICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBtZm5fdG9f
cGFnZShwZm4pKTsKKyAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywg
UFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKICAgICAgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAgICAgICBwdXRfcGFnZShwZyk7
CiAgICAgfQpAQCAtMjg1OSwxMSArMjg1OSwxMiBAQCBzdGF0aWMgaW50IF9w
dXRfZmluYWxfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVu
c2lnbmVkIGxvbmcgdHlwZSwKIH0KIAogCi1zdGF0aWMgaW50IF9wdXRfcGFn
ZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIGJvb2wgcHJlZW1wdGli
bGUsCitzdGF0aWMgaW50IF9wdXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UsIHVuc2lnbmVkIGludCBmbGFncywKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZykKIHsKICAgICB1
bnNpZ25lZCBsb25nIG54LCB4LCB5ID0gcGFnZS0+dS5pbnVzZS50eXBlX2lu
Zm87CiAgICAgaW50IHJjID0gMDsKKyAgICBib29sIHByZWVtcHRpYmxlID0g
ZmxhZ3MgJiBQVEZfcHJlZW1wdGlibGU7CiAKICAgICBmb3IgKCA7IDsgKQog
ICAgIHsKQEAgLTMwNjMsNyArMzA2NCw3IEBAIHN0YXRpYyBpbnQgX19nZXRf
cGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxv
bmcgdHlwZSwKIAogICAgICAgICAgICAgaWYgKCB1bmxpa2VseShpb21tdV9y
ZXQpICkKICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICBfcHV0X3Bh
Z2VfdHlwZShwYWdlLCBmYWxzZSwgTlVMTCk7CisgICAgICAgICAgICAgICAg
X3B1dF9wYWdlX3R5cGUocGFnZSwgMCwgTlVMTCk7CiAgICAgICAgICAgICAg
ICAgcmMgPSBpb21tdV9yZXQ7CiAgICAgICAgICAgICAgICAgZ290byBvdXQ7
CiAgICAgICAgICAgICB9CkBAIC0zMDkwLDcgKzMwOTEsNyBAQCBzdGF0aWMg
aW50IF9fZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1
bnNpZ25lZCBsb25nIHR5cGUsCiAKIHZvaWQgcHV0X3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogewotICAgIGludCByYyA9IF9wdXRfcGFn
ZV90eXBlKHBhZ2UsIGZhbHNlLCBOVUxMKTsKKyAgICBpbnQgcmMgPSBfcHV0
X3BhZ2VfdHlwZShwYWdlLCAwLCBOVUxMKTsKICAgICBBU1NFUlQocmMgPT0g
MCk7CiAgICAgKHZvaWQpcmM7CiB9CkBAIC0zMTA2LDcgKzMxMDcsNyBAQCBp
bnQgZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUpCiAKIGludCBwdXRfcGFnZV90eXBlX3ByZWVtcHRp
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7Ci0gICAgcmV0dXJuIF9w
dXRfcGFnZV90eXBlKHBhZ2UsIHRydWUsIE5VTEwpOworICAgIHJldHVybiBf
cHV0X3BhZ2VfdHlwZShwYWdlLCBQVEZfcHJlZW1wdGlibGUsIE5VTEwpOwog
fQogCiBpbnQgZ2V0X3BhZ2VfdHlwZV9wcmVlbXB0aWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCkBAIC0zMzE2LDcg
KzMzMTcsNyBAQCBpbnQgcHV0X29sZF9ndWVzdF90YWJsZShzdHJ1Y3QgdmNw
dSAqdikKICAgICBpZiAoICF2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCiAg
ICAgICAgIHJldHVybiAwOwogCi0gICAgc3dpdGNoICggcmMgPSBfcHV0X3Bh
Z2VfdHlwZSh2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSwgdHJ1ZSwKKyAgICBz
d2l0Y2ggKCByYyA9IF9wdXRfcGFnZV90eXBlKHYtPmFyY2gub2xkX2d1ZXN0
X3RhYmxlLCBQVEZfcHJlZW1wdGlibGUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF9wdHBnKSApCiAgICAg
ewogICAgIGNhc2UgLUVJTlRSOgotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0006-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0006-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Transfer-Encoding: base64

RnJvbSAzODk4OTg2MDA3NjlkOTRiZTIxYzhlMzdkYjZkZjkwNWJhYmMwZWVl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA2LzEyXSB4
ODYvbW06IFJld29yayBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbiBjb25k
aXRpb25hbAoKTWFrZSBpdCBlYXNpZXIgdG8gcmVhZCBieSBkZWNsYXJpbmcg
dGhlIGNvbmRpdGlvbnMgaW4gd2hpY2ggd2Ugd2lsbApyZXRhaW4gdGhlIHJl
ZiwgcmF0aGVyIHRoYW4gdGhlIGNvbmRpdGlvbnMgdW5kZXIgd2hpY2ggd2Ug
cmVsZWFzZSBpdC4KClRoZSBvbmx5IHdheSAocGFnZSA9PSBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZSkgY2FuIGJlIHRydWUgaXMgaWYKcHJlZW1w
dGlibGUgaXMgdHJ1ZTsgc28gcmVtb3ZlIHRoaXMgZnJvbSB0aGUgcXVlcnkg
aXRzZWxmLCBhbmQgYWRkIGFuCkFTU0VSVCgpIHRvIHRoYXQgZWZmZWN0IG9u
IHRoZSBvcHBvc2l0ZSBwYXRoLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50
ZW5kZWQuCgpOQiB0aGF0IGFsbG9jX2xOX3RhYmxlKCkgbWlzaGFuZGxlIHRo
ZSAibGluZWFyIHB0IGZhaWx1cmUiIHNpdHVhdGlvbgpkZXNjcmliZWQgaW4g
dGhlIGNvbW1lbnQ7IHRoaXMgd2lsbCBiZSBhZGRyZXNzZWQgaW4gYSBmdXR1
cmUgcGF0Y2guCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDM5ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNo
YW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCAyY2YwYzMzZDE4Li5jNDMwZjJjNTJlIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
Nzk4LDggKzc5OCw0MyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBl
X2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9uciwKIAogICAgIHJj
ID0gX19nZXRfcGFnZV90eXBlKHBhZ2UsIHR5cGUsIHByZWVtcHRpYmxlKTsK
IAotICAgIGlmICggdW5saWtlbHkocmMpICYmICFwYXJ0aWFsX3JlZiAmJgot
ICAgICAgICAgKCFwcmVlbXB0aWJsZSB8fCBwYWdlICE9IGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlKSApCisgICAgLyoKKyAgICAgKiBSZXRhaW4g
dGhlIHJlZmNvdW50IGlmOgorICAgICAqIC0gcGFnZSBpcyBmdWxseSB2YWxp
ZGF0ZWQgKHJjID09IDApCisgICAgICogLSBwYWdlIGlzIG5vdCB2YWxpZGF0
ZWQgKHJjIDwgMCkgYnV0OgorICAgICAqICAgLSBXZSBjYW1lIGluIHdpdGgg
YSByZWZlcmVuY2UgKHBhcnRpYWxfcmVmKQorICAgICAqICAgLSBwYWdlIGlz
IHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0IHRoZXJlJ3MgYmVlbiBhbiBlcnJv
cgorICAgICAqICAgICAocGFnZSA9PSBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSkKKyAgICAgKgorICAgICAqIFRoZSBwYXJ0aWFsX3JlZi1vbi1l
cnJvciBjbGF1c2UgaXMgd29ydGggYW4gZXhwbGFuYXRpb24uICBUaGVyZQor
ICAgICAqIGFyZSB0d28gc2NlbmFyaW9zIHdoZXJlIHBhcnRpYWxfcmVmIG1p
Z2h0IGJlIHRydWUgY29taW5nIGluOgorICAgICAqIC0gbWZuIGhhcyBiZWVu
IHBhcnRpYWxseSBkZW1vdGVkIGFzIHR5cGUgYHR5cGVgOyBpLmUuIGhhcwor
ICAgICAqICAgUEdUX3BhcnRpYWwgc2V0CisgICAgICogLSBtZm4gaGFzIGJl
ZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxp
bmVhcgorICAgICAqICAgcGFnZTsgZS5nLiB3ZSdyZSBiZWluZyBjYWxsZWQg
ZnJvbSBnZXRfcGFnZV9mcm9tX2wyZSB3aXRoCisgICAgICogICB0eXBlID09
IFBHVF9sMV90YWJsZSwgYnV0IHRoZSBtZm4gaXMgUEdUX2wyX3RhYmxlKQor
ICAgICAqCisgICAgICogSWYgdGhlcmUncyBhbiBlcnJvciwgaW4gdGhlIGZp
cnN0IGNhc2UsIF9nZXRfcGFnZV90eXBlIHdpbGwKKyAgICAgKiBlaXRoZXIg
cmV0dXJuIC1FUkVTVEFSVCwgaW4gd2hpY2ggY2FzZSB3ZSB3YW50IHRvIHJl
dGFpbiB0aGUKKyAgICAgKiByZWYgKGFzIHRoZSBjYWxsZXIgd2lsbCBjb25z
aWRlciBpdCByZXRhaW5lZCksIG9yIC1FSU5WQUwsIGluCisgICAgICogd2hp
Y2ggY2FzZSBvbGRfZ3Vlc3RfdGFibGUgd2lsbCBiZSBzZXQ7IGluIGJvdGgg
Y2FzZXMsIHdlIG5lZWQKKyAgICAgKiB0byByZXRhaW4gdGhlIHJlZi4KKyAg
ICAgKgorICAgICAqIEluIHRoZSBzZWNvbmQgY2FzZSwgaWYgdGhlcmUncyBh
biBlcnJvciwgX2dldF9wYWdlX3R5cGUoKSBjYW4KKyAgICAgKiAqb25seSog
cmV0dXJuIC1FSU5WQUwsIGFuZCAqbmV2ZXIqIHNldCBvbGRfZ3Vlc3RfdGFi
bGUuICBJbgorICAgICAqIHRoYXQgY2FzZSB3ZSBhbHNvIHdhbnQgdG8gcmV0
YWluIHRoZSByZWZlcmVuY2UsIHRvIGFsbG93IHRoZQorICAgICAqIHBhZ2Ug
dG8gY29udGludWUgdG8gYmUgdG9ybiBkb3duIChpLmUuLCBQR1RfcGFydGlh
bCBjbGVhcmVkKQorICAgICAqIHNhZmVseS4KKyAgICAgKgorICAgICAqIEFs
c28gbm90ZSB0aGF0IHdlIHNob3VsZG4ndCBiZSBhYmxlIHRvIGxlYXZlIHdp
dGggdGhlIHJlZmVyZW5jZQorICAgICAqIGNvdW50IHJldGFpbmVkIHVubGVz
cyB3ZSBzdWNjZWVkZWQsIG9yIHRoZSBvcGVyYXRpb24gd2FzCisgICAgICog
cHJlZW1wdGlibGUuCisgICAgICovCisgICAgaWYgKCBsaWtlbHkoIXJjKSB8
fCBwYXJ0aWFsX3JlZiApCisgICAgICAgIC8qIG5vdGhpbmcgKi87CisgICAg
ZWxzZSBpZiAoIHBhZ2UgPT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgKQorICAgICAgICBBU1NFUlQocHJlZW1wdGlibGUpOworICAgIGVsc2UK
ICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CiAKICAgICByZXR1cm4gcmM7Ci0t
IAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0007-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0007-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Transfer-Encoding: base64

RnJvbSA4NjI5YmZhNDUyY2I4ODkwMzUwY2U2M2M5ZTI4YzRkMGU1OGI3YTJj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA3LzEyXSB4
ODYvbW06IEhhdmUgYWxsb2NfbFsyM11fdGFibGUgY2xlYXIgcGFydGlhbF9m
bGFncyB3aGVuCiBwcmVlbXB0aW5nCgpJbiBvcmRlciB0byBhbGxvdyByZWN1
cnNpdmUgcGFnZXRhYmxlIHByb21vdGlvbnMgYW5kIGRlbW90aW9ucyB0byBi
ZQppbnRlcnJ1cHRlZCwgWGVuIG11c3Qga2VlcCB0cmFjayBvZiB0aGUgc3Rh
dGUgb2YgdGhlIHN1Yi1wYWdlcwpwcm9tb3RlZCBvciBkZW1vdGVkLiAgVGhp
cyBpcyBzdG9yZWQgaW4gdHdvIGVsZW1lbnRzIGluIHRoZSBwYWdlCnN0cnVj
dDogbnJfZW50cmllc192YWxpZGF0ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpU
aGUgcnVsZSBpcyB0aGF0IGVudHJpZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRh
dGVkKSBzaG91bGQgYWx3YXlzIGJlCnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdl
bmVyYWwgcmVmZXJlbmNlIGNvdW50LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6
ZXJvLCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlk
YXRlZCBhbmQgbm8gcmVmZXJlbmNlCmNvdW50IGlzIGhlbGQuICBJZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRl
ZF0KaXMgcGFydGlhbGx5IHZhbGlkYXRlZC4KCkF0IHRoZSBtb21lbnQsIGEg
ZGlzdGluY3Rpb24gaXMgbWFkZSBiZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVt
b3Rpb24Kd2l0aCByZWdhcmQgdG8gd2hldGhlciB0aGUgZW50cnkgaXRzZWxm
ICJob2xkcyIgYSBnZW5lcmFsIHJlZmVyZW5jZQpjb3VudDogd2hlbiBlbnRy
eSBwcm9tb3Rpb24gaXMgaW50ZXJydXB0ZWQgKGkuZS4sIHJldHVybnMgLUVS
RVNUQVJUKSwKdGhlIGVudHJ5IGlzIG5vdCBjb25zaWRlcmVkIHRvIGhvbGQg
YSByZWZlcmVuY2U7IHdoZW4gZW50cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0
ZWQsIHRoZSBlbnRyeSBpcyBzdGlsbCBjb25zaWRlcmVkIHRvIGhvbGQgYSBn
ZW5lcmFsCnJlZmVyZW5jZS4KClBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYg
Y2xlYXIsIGl0J3MgYSBwYXJ0aWFsIHByb21vdGlvbiA9PiBubyBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBoZWxkCmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBp
dCdzIHBhcnRpYWwgZGVtb3Rpb24sIHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UK
Y291bnQgaGVsZC4gIEJlY2F1c2UgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25z
IGNhbiBiZSBpbnRlcmxlYXZlZCwgdGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8g
Z2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21f
bCplLAp0byBiZSBhYmxlIHRvIHByb3Blcmx5IGhhbmRsZSByZWZlcmVuY2Ug
Y291bnRzLgoKVW5mb3J0dW5hdGVseSwgd2hlbiBhbGxvY19sWzIzXV90YWJs
ZSBjaGVjayBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpCmFuZCByZXR1cm4g
LUVSRVNUQVJULCB0aGV5IHNldCBucl9lbnRyaWVzX3ZhbGlkYXRlZCwgYnV0
IGRvbid0IGNsZWFyCnBhcnRpYWxfZmxhZ3MuCgpJZiB3ZSB3ZXJlIHBpY2tp
bmcgdXAgZnJvbSBhIHByZXZpb3VzbHktaW50ZXJydXB0ZWQgcHJvbW90aW9u
LCB0aGF0Cm1lYW5zIHRoYXQgUFRGX3BhcnRpYWxfc2V0IHdvdWxkIGJlIHNl
dCBldmVuIHRob3VnaApbbnJfZW50cmllc192YWxpZGF0ZWRdIHdhcyBub3Qg
cGFydGlhbGx5IHZhbGlkYXRlZC4gIFRoaXMgbWVhbnMgdGhhdAppZiB0aGUg
cGFnZSBpbiB0aGlzIHN0YXRlIHdlcmUgZGUtdmFsaWRhdGVkLCBwdXRfcGFn
ZV90eXBlKCkgd291bGQKZXJyb25lb3VzbHkgYmUgY2FsbGVkIG9uIHRoYXQg
ZW50cnkuCgpQZXJoYXBzIHdvcnNlLCBpZiB3ZSB3ZXJlIHJhY2luZyB3aXRo
IGEgZGUtdmFsaWRhdGlvbiwgdGhlbiB3ZSBtaWdodApsZWF2ZSBib3RoIFBU
Rl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7IGFu
ZCB3aGVuCmRlLXZhbGlkYXRpb24gcGlja2VkIHVwIGFnYWluLCBib3RoIHRo
ZSB0eXBlIGFuZCB0aGUgZ2VuZXJhbCByZWYgd291bGQKYmUgZXJyb25lb3Vz
bHkgZHJvcHBlZCBmcm9tIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0uCgpJbiBh
IHNlbnNlLCB0aGUgcmVhbCBpc3N1ZSBoZXJlIGlzIGNvZGUgZHVwbGljYXRp
b24uICBSYXRoZXIgdGhhbgpkdXBsaWNhdGUgdGhlIGludGVycnVwdGlvbiBj
b2RlLCBzZXQgcmMgdG8gLUVJTlRSIGFuZCBmYWxsIHRocm91Z2ggdG8KdGhl
IGNvZGUgd2hpY2ggYWxyZWFkeSBoYW5kbGVzIHRoYXQgY2FzZSBjb3JyZWN0
bHkuCgpHaXZlbiB0aGUgbG9naWMgYXQgdGhpcyBwb2ludCwgaXQgc2hvdWxk
IGJlIGltcG9zc2libGUgZm9yCnBhcnRpYWxfZmxhZ3MgdG8gYmUgbm9uLXpl
cm87IGFkZCBhbiBBU1NFUlQoKSB0byBjYXRjaCBhbnkgY2hhbmdlcy4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMTggKysrKy0tLS0tLS0tLS0tLS0t
CiAxIGZpbGUgY2hhbmdlZCwgNCBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCmluZGV4IGM0MzBmMmM1MmUuLmZjZTE1ZjMwY2EgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS5jCkBAIC0xNzM1LDEzICsxNzM1LDggQEAgc3RhdGljIGludCBhbGxv
Y19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBs
b25nIHR5cGUpCiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCAp
CiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAg
ewotICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwot
ICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVh
azsKLSAgICAgICAgfQotCi0gICAgICAgIGlmICggIWlzX2d1ZXN0X2wyX3Ns
b3QoZCwgdHlwZSwgaSkgfHwKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOwor
ICAgICAgICBlbHNlIGlmICggIWlzX2d1ZXN0X2wyX3Nsb3QoZCwgdHlwZSwg
aSkgfHwKICAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2wyZShw
bDJlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQogICAgICAg
ICAgICAgY29udGludWU7CiAKQEAgLTE4MTIsMTMgKzE4MDcsOCBAQCBzdGF0
aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCApCiAgICAgewog
ICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAmJiBo
eXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAgewotICAgICAg
ICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAg
ICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVhazsKLSAgICAg
ICAgfQotCi0gICAgICAgIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYm
IChpID09IDMpICkKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAg
ICBlbHNlIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYmIChpID09IDMp
ICkKICAgICAgICAgewogICAgICAgICAgICAgaWYgKCAhKGwzZV9nZXRfZmxh
Z3MocGwzZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSB8fAogICAgICAgICAgICAg
ICAgICAobDNlX2dldF9mbGFncyhwbDNlW2ldKSAmIGwzX2Rpc2FsbG93X21h
c2soZCkpICkKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0008-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0008-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Transfer-Encoding: base64

RnJvbSA0NTcyMzJhZjI1ZTAzN2NlNGZiZDczZGM4ZDZjMWYzYzgzMGU3MzVi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA4LzEyXSB4
ODYvbW06IEFsd2F5cyByZXRhaW4gYSBnZW5lcmFsIHJlZiBvbiBwYXJ0aWFs
CgpJbiBvcmRlciB0byBhbGxvdyByZWN1cnNpdmUgcGFnZXRhYmxlIHByb21v
dGlvbnMgYW5kIGRlbW90aW9ucyB0byBiZQppbnRlcnJ1cHRlZCwgWGVuIG11
c3Qga2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIHN1Yi1wYWdlcwpw
cm9tb3RlZCBvciBkZW1vdGVkLiAgVGhpcyBpcyBzdG9yZWQgaW4gdHdvIGVs
ZW1lbnRzIGluIHRoZSBwYWdlIHN0cnVjdDoKbnJfZW50cmllc192YWxpZGF0
ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpUaGUgcnVsZSBpcyB0aGF0IGVudHJp
ZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRhdGVkKSBzaG91bGQgYWx3YXlzIGJl
CnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdlbmVyYWwgcmVmZXJlbmNlIGNvdW50
LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6ZXJvLCB0aGVuIFtucl9lbnRyaWVz
X3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlkYXRlZCBhbmQgbm8gcmVmZXJlbmNl
CmNvdW50IGlzIGhlbGQuICBJZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0KaXMgcGFydGlhbGx5IHZhbGlk
YXRlZC4KCkF0IHRoZSBtb21lbnQsIGEgZGlzdGluY3Rpb24gaXMgbWFkZSBi
ZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVtb3Rpb24Kd2l0aCByZWdhcmQgdG8g
d2hldGhlciB0aGUgZW50cnkgaXRzZWxmICJob2xkcyIgYSBnZW5lcmFsIHJl
ZmVyZW5jZQpjb3VudDogd2hlbiBlbnRyeSBwcm9tb3Rpb24gaXMgaW50ZXJy
dXB0ZWQgKGkuZS4sIHJldHVybnMgLUVSRVNUQVJUKSwKdGhlIGVudHJ5IGlz
IG5vdCBjb25zaWRlcmVkIHRvIGhvbGQgYSByZWZlcmVuY2U7IHdoZW4gZW50
cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0ZWQsIHRoZSBlbnRyeSBpcyBzdGls
bCBjb25zaWRlcmVkIHRvIGhvbGQgYSBnZW5lcmFsCnJlZmVyZW5jZS4KClBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHVzZWQgdG8gZGlzdGluZ3Vpc2gg
YmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYgY2xlYXIsIGl0J3MgYSBwYXJ0aWFs
IHByb21vdGlvbiA9PiBubyBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBoZWxk
CmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBpdCdzIHBhcnRpYWwgZGVtb3Rpb24s
IHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UKY291bnQgaGVsZC4gIEJlY2F1c2Ug
cHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIGNhbiBiZSBpbnRlcmxlYXZlZCwg
dGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21fbCplLAp0byBiZSBhYmxlIHRvIHBy
b3Blcmx5IGhhbmRsZSByZWZlcmVuY2UgY291bnRzLgoKVW5mb3J0dW5hdGVs
eSwgYmVjYXVzZSBhIHJlZmNvdW50IGlzIG5vdCBoZWxkLCBpdCBpcyBwb3Nz
aWJsZSB0bwplbmdpbmVlciBhIHNpdHVhdGlvbiB3aGVyZSBQRlRfcGFydGlh
bF9zZXQgaXMgc2V0IGJ1dCB0aGUgcGFnZSBpbgpxdWVzdGlvbiBoYXMgYmVl
biBhc3NpZ25lZCB0byBhbm90aGVyIGRvbWFpbi4gIEEgc2tldGNoIGlzIHBy
b3ZpZGVkIGluCnRoZSBhcHBlbmRpeC4KCkZpeCB0aGlzIGJ5IGhhdmluZyB0
aGUgcGFyZW50IHBhZ2UgdGFibGUgZW50cnkgaG9sZCBhIGdlbmVyYWwKcmVm
ZXJlbmNlIGNvdW50IHdoZW5ldmVyIFBGVF9wYXJ0aWFsX3NldCBpcyBzZXQu
ICAoRm9yIGNsYXJpdHkgb2YKY2hhbmdlLCBrZWVwIHR3byBzZXBhcmF0ZSBm
bGFncy4gIFRoZXNlIHdpbGwgYmUgY29sbGFwc2VkIGluIGEKc3Vic2VxdWVu
dCBjaGFuZ2VzZXQuKQoKVGhpcyBoYXMgdHdvIGJhc2ljIGltcGxpY2F0aW9u
cy4gIE9uIHRoZSBwdXRfcGFnZV9mcm9tX2xOZSgpIHNpZGUsCnRoaXMgbWVh
biB0aGF0IHRoZSAocGFydGlhbF9zZXQgJiYgIXBhcnRpYWxfcmVmKSBjYXNl
IGNhbiBuZXZlciBoYXBwZW4sCmFuZCBubyBsb25nZXIgbmVlZHMgdG8gYmUg
c3BlY2lhbC1jYXNlZC4KClNlY29uZGx5LCBiZWNhdXNlIGJvdGggZmxhZ3Mg
YXJlIHNldCB0b2dldGhlciwgdGhlcmUncyBubyBuZWVkIHRvIGNhcnJ5IG92
ZXIKZXhpc3RpbmcgYml0cyBmcm9tIHBhcnRpYWxfcHRlLgoKKE5CIHRoZXJl
IGlzIHN0aWxsIGFub3RoZXIgaXNzdWUgd2l0aCBjYWxsaW5nIF9wdXRfcGFn
ZV90eXBlKCkgb24gYQpwYWdlIHdoaWNoIGhhZCBQR1RfcGFydGlhbCBzZXQ7
IHRoYXQgd2lsbCBiZSBoYW5kbGVkIGluIGEgc3Vic2VxdWVudApwYXRjaC4p
CgpPbiB0aGUgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oKSBzaWRlLCB3
ZSBuZWVkIHRvIGRpc3Rpbmd1aXNoCmJldHdlZW4gY2FsbGVycyB3aGljaCBo
b2xkIGEgcmVmZXJlbmNlIG9uIHBhcnRpYWwgKGkuZS4sCmFsbG9jX2xOX3Rh
YmxlKCkpLCBhbmQgdGhvc2Ugd2hpY2ggZG8gbm90IChuZXdfY3IzLCBQSU5f
TE5fVEFCTEUsIGFuZApzbyBvbik6IHBhc3MgYSBmbGFnIGlmIHRoZSB0eXBl
IHNob3VsZCBiZSByZXRhaW5lZCBvbiBpbnRlcnJ1cHRpb24uCgpOQiB0aGF0
IHNpbmNlIGwxIHByb21vdGlvbiBjYW4ndCBiZSBwcmVlbXB0ZWQsIHRoYXQg
Z2V0X3BhZ2VfZnJvbV9sMmUKY2FuJ3QgcmV0dXJuIC1FUkVTVEFSVC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0tLQoqIEFwcGVuZGl4OiBFbmdpbmVlcmluZyBQVEZfcGFydGlhbF9zZXQg
d2hpbGUgYSBwYWdlIGJlbG9uZ3MgdG8gYQogIGZvcmVpZ24gZG9tYWluCgpT
dXBwb3NlIEEgaXMgYSBwYWdlIHdoaWNoIGNhbiBiZSBwcm9tb3RlZCB0byBh
biBsMywgYW5kIEIgaXMgYSBwYWdlCndoaWNoIGNhbiBiZSBwcm9tb3RlZCB0
byBhbiBsMiwgYW5kIEFbeF0gcG9pbnRzIHRvIEIuICBCIGhhcwpQR0NfYWxs
b2NhdGVkIHNldCBidXQgbm8gb3RoZXIgZ2VuZXJhbCByZWZlcmVuY2VzLgoK
VjE6ICBQSU5fTDMgQS4KICBBIGlzIHZhbGlkYXRlZCwgQiBpcyB2YWxpZGF0
ZWQuCiAgQS50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQgfCBQR1Rf
cGlubmVkCiAgQi50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBC
LmNvdW50ID0gMiB8IFBHQ19hbGxvY2F0ZWQgKEFbeF0gaG9sZHMgYSBnZW5l
cmFsIHJlZikKClYxOiBVTlBJTiBBLgogIEEgYmVnaW5zIGRlLXZhbGlkYXRp
b24uCiAgQXJyYW5nZSB0byBiZSBpbnRlcnJ1cHRlZCB3aGVuIGkgPCB4CiAg
VjEtPm9sZF9ndWVzdF90YWJsZSA9IEEKICBWMS0+b2xkX2d1ZXN0X3RhYmxl
X3JlZl9oZWxkID0gZmFsc2UKICBBLnR5cGVfY291bnQgPSAxIHwgUEdUX3Bh
cnRpYWwKICBBLm5yX3ZhbGlkYXRlZF9lbnRyaWVzID0gaSA8IHgKICBCLnR5
cGVfY291bnQgPSAwCiAgQi5jb3VudCA9IDEgfCBQR0NfYWxsb2NhdGVkCgpW
MjogTU9EX0w0X0VOVFJZIHRvIHBvaW50IHNvbWUgbDRlIHRvIEEuCiAgUGlj
a3MgdXAgcmUtdmFsaWRhdGlvbiBvZiBBLgogIEFycmFuZ2UgdG8gYmUgaW50
ZXJydXB0ZWQgaGFsZndheSB0aHJvdWdoIEIncyB2YWxpZGF0aW9uCiAgQi50
eXBlX2NvdW50ID0gMSB8IFBHVF9wYXJ0aWFsCiAgQi5jb3VudCA9IDIgfCBQ
R0NfYWxsb2NhdGVkIChQR1RfcGFydGlhbCBob2xkcyBhIGdlbmVyYWwgcmVm
KQogIEEudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFs
aWRhdGVkX2VudHJpZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IFBURl9wYXJ0
aWFsX3NldAoKVjM6IE1PRF9MM19FTlRSWSB0byBwb2ludCBzb21lIG90aGVy
IGwzZSAobm90IGluIEEpIHRvIEIuCiAgVmFsaWRhdGVzIEIuCiAgQi50eXBl
X2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBCLmNvdW50ID0gMiB8IFBH
Q19hbGxvY2F0ZWQgKCJvdGhlciBsM2UiIGhvbGRzIGEgZ2VuZXJhbCByZWYp
CgpWMzogTU9EX0wzX0VOVFJZIHRvIGNsZWFyIGwzZSBwb2ludGluZyB0byBC
LgogIERldmFsaWRhdGVzIEIuCiAgQi50eXBlX2NvdW50ID0gMAogIEIuY291
bnQgPSAxIHwgUEdDX2FsbG9jYXRlZAoKVjM6IGRlY3JlYXNlX3Jlc2VydmF0
aW9uKEIpCiAgQ2xlYXJzIFBHQ19hbGxvY2F0ZWQKICBCLmNvdW50ID0gMCA9
PiBCIGlzIGZyZWVkCgpCIGdldHMgYXNzaWduZWQgdG8gYSBkaWZmZXJlbnQg
ZG9tYWluCgpWMTogUmVzdGFydHMgVU5QSU4gb2YgQQogIHB1dF9vbGRfZ3Vl
c3RfdGFibGUoQSkKICAgIC4uLgogICAgICBmcmVlX2wzX3RhYmxlKEEpCgpO
b3cgc2luY2UgQS5wYXJ0aWFsX2ZsYWdzIGhhcyBQVEZfcGFydGlhbF9zZXQs
IGZyZWVfbDNfdGFibGUoKSB3aWxsCmNhbGwgcHV0X3BhZ2VfZnJvbV9sM2Uo
KSBvbiBBW3hdLCB3aGljaCBwb2ludHMgdG8gQiwgd2hpbGUgQiBpcyBvd25l
ZApieSBhbm90aGVyIGRvbWFpbi4KCklmIEFbeF0gaGVsZCBhIGdlbmVyYWwg
cmVmY291bnQgZm9yIEIgb24gcGFydGlhbCB2YWxpZGF0aW9uLCBhcyBpdCBk
b2VzCmZvciBwYXJ0aWFsIGRlLXZhbGlkYXRpb24sIHRoZW4gQiB3b3VsZCBz
dGlsbCBoYXZlIGEgcmVmZXJlbmNlIGNvdW50IG9mCjEgYWZ0ZXIgUEdDX2Fs
bG9jYXRlZCB3YXMgZnJlZWQ7IHNvIEIgd291bGRuJ3QgYmUgZnJlZWQgdW50
aWwgYWZ0ZXIKcHV0X3BhZ2VfZnJvbV9sM2UoKSBoYWQgaGFwcGVuZCBvbiBB
W3hdLgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jICAgICAgICB8IDg3ICsrKysr
KysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0KIHhlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaCB8IDE1ICsrKystLS0KIDIgZmlsZXMgY2hhbmdl
ZCwgNjEgaW5zZXJ0aW9ucygrKSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwpp
bmRleCBmY2UxNWYzMGNhLi4wYWM4YzQ1OTJkIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNzc3
LDEwICs3NzcsMTEgQEAgc3RhdGljIGludCBfX2dldF9wYWdlX3R5cGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogICog
cGFnZS0+cHRlW3BhZ2UtPm5yX3ZhbGlkYXRlZF9lbnRyaWVzXS4gIFNlZSB0
aGUgY29tbWVudCBpbiBtbS5oIGZvcgogICogbW9yZSBpbmZvcm1hdGlvbi4K
ICAqLwotI2RlZmluZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAoMSA8PCAw
KQotI2RlZmluZSBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiAoMSA8PCAxKQot
I2RlZmluZSBQVEZfcHJlZW1wdGlibGUgICAgICAgICAoMSA8PCAyKQotI2Rl
ZmluZSBQVEZfZGVmZXIgICAgICAgICAgICAgICAoMSA8PCAzKQorI2RlZmlu
ZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAgICgxIDw8IDApCisjZGVmaW5l
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmICAgKDEgPDwgMSkKKyNkZWZpbmUg
UFRGX3ByZWVtcHRpYmxlICAgICAgICAgICAoMSA8PCAyKQorI2RlZmluZSBQ
VEZfZGVmZXIgICAgICAgICAgICAgICAgICgxIDw8IDMpCisjZGVmaW5lIFBU
Rl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQgKDEgPDwgNCkKIAogc3RhdGljIGlu
dCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3BhZ2Vucih1bnNpZ25lZCBsb25n
IHBhZ2VfbnIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGxvbmcgdHlwZSwKQEAgLTc5MCw3ICs3OTEsMTEg
QEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3BhZ2Vucih1
bnNpZ25lZCBsb25nIHBhZ2VfbnIsCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSA9IG1mbl90b19wYWdlKHBhZ2VfbnIpOwogICAgIGludCByYzsKICAg
ICBib29sIHByZWVtcHRpYmxlID0gZmxhZ3MgJiBQVEZfcHJlZW1wdGlibGUs
Ci0gICAgICAgICBwYXJ0aWFsX3JlZiA9IGZsYWdzICYgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWY7CisgICAgICAgICBwYXJ0aWFsX3JlZiA9IGZsYWdzICYg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYsCisgICAgICAgICBwYXJ0aWFsX3Nl
dCA9IGZsYWdzICYgUFRGX3BhcnRpYWxfc2V0LAorICAgICAgICAgcmV0YWlu
X3JlZiAgPSBmbGFncyAmIFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQ7CisK
KyAgICBBU1NFUlQocGFydGlhbF9yZWYgPT0gcGFydGlhbF9zZXQpOwogCiAg
ICAgaWYgKCBsaWtlbHkoIXBhcnRpYWxfcmVmKSAmJgogICAgICAgICAgdW5s
aWtlbHkoIWdldF9wYWdlX2Zyb21fcGFnZW5yKHBhZ2VfbnIsIGQpKSApCkBA
IC04MDMsMTMgKzgwOCwxNSBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90
eXBlX2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9uciwKICAgICAg
KiAtIHBhZ2UgaXMgZnVsbHkgdmFsaWRhdGVkIChyYyA9PSAwKQogICAgICAq
IC0gcGFnZSBpcyBub3QgdmFsaWRhdGVkIChyYyA8IDApIGJ1dDoKICAgICAg
KiAgIC0gV2UgY2FtZSBpbiB3aXRoIGEgcmVmZXJlbmNlIChwYXJ0aWFsX3Jl
ZikKKyAgICAgKiAgIC0gcGFnZSBpcyBwYXJ0aWFsbHkgdmFsaWRhdGVkIChy
YyA9PSAtRVJFU1RBUlQpLCBhbmQgdGhlCisgICAgICogICAgIGNhbGxlciBo
YXMgYXNrZWQgdGhlIHJlZiB0byBiZSByZXRhaW5lZCBpbiB0aGF0IGNhc2UK
ICAgICAgKiAgIC0gcGFnZSBpcyBwYXJ0aWFsbHkgdmFsaWRhdGVkIGJ1dCB0
aGVyZSdzIGJlZW4gYW4gZXJyb3IKICAgICAgKiAgICAgKHBhZ2UgPT0gY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUpCiAgICAgICoKICAgICAgKiBU
aGUgcGFydGlhbF9yZWYtb24tZXJyb3IgY2xhdXNlIGlzIHdvcnRoIGFuIGV4
cGxhbmF0aW9uLiAgVGhlcmUKICAgICAgKiBhcmUgdHdvIHNjZW5hcmlvcyB3
aGVyZSBwYXJ0aWFsX3JlZiBtaWdodCBiZSB0cnVlIGNvbWluZyBpbjoKLSAg
ICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgZGVtb3RlZCBhcyB0eXBl
IGB0eXBlYDsgaS5lLiBoYXMKLSAgICAgKiAgIFBHVF9wYXJ0aWFsIHNldAor
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBwcm9tb3RlZCAvIGRl
bW90ZWQgYXMgdHlwZSBgdHlwZWA7CisgICAgICogICBpLmUuIGhhcyBQR1Rf
cGFydGlhbCBzZXQKICAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkg
ZGVtb3RlZCBhcyBMKHR5cGUrMSkgKGkuZS4sIGEgbGluZWFyCiAgICAgICog
ICBwYWdlOyBlLmcuIHdlJ3JlIGJlaW5nIGNhbGxlZCBmcm9tIGdldF9wYWdl
X2Zyb21fbDJlIHdpdGgKICAgICAgKiAgIHR5cGUgPT0gUEdUX2wxX3RhYmxl
LCBidXQgdGhlIG1mbiBpcyBQR1RfbDJfdGFibGUpCkBAIC04MzIsNyArODM5
LDggQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3BhZ2Vu
cih1bnNpZ25lZCBsb25nIHBhZ2VfbnIsCiAgICAgICovCiAgICAgaWYgKCBs
aWtlbHkoIXJjKSB8fCBwYXJ0aWFsX3JlZiApCiAgICAgICAgIC8qIG5vdGhp
bmcgKi87Ci0gICAgZWxzZSBpZiAoIHBhZ2UgPT0gY3VycmVudC0+YXJjaC5v
bGRfZ3Vlc3RfdGFibGUgKQorICAgIGVsc2UgaWYgKCBwYWdlID09IGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlIHx8CisgICAgICAgICAgICAgIChy
ZXRhaW5fcmVmICYmIHJjID09IC1FUkVTVEFSVCkgKQogICAgICAgICBBU1NF
UlQocHJlZW1wdGlibGUpOwogICAgIGVsc2UKICAgICAgICAgcHV0X3BhZ2Uo
cGFnZSk7CkBAIC0xNTM1LDggKzE1NDMsOCBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcg
cGZuLAogICAgICAgICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQg
fCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CiAgICAgICAgICAgICAg
IFBURl9wYXJ0aWFsX3NldCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIEFT
U0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7Ci0gICAgICAgICAgICByYyA9
IF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOwor
ICAgICAgICAgICAgLyogcGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBs
eSBwYXJ0aWFsX3JlZiAqLworICAgICAgICAgICAgQlVHKCk7CiAgICAgICAg
IH0KICAgICAgICAgZWxzZSBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKICAg
ICAgICAgewpAQCAtMTU4MSw4ICsxNTg5LDggQEAgc3RhdGljIGludCBwdXRf
cGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25n
IHBmbiwKICAgICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CiAgICAgICAgICBQVEZfcGFy
dGlhbF9zZXQgKQogICAgIHsKLSAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQ
VEZfZGVmZXIpKTsKLSAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBn
LCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKHBmbikpOworICAgICAg
ICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxf
cmVmICovCisgICAgICAgIEJVRygpOwogICAgIH0KIAogICAgIGlmICggZmxh
Z3MgJiBQVEZfZGVmZXIgKQpAQCAtMTYxMiw4ICsxNjIwLDggQEAgc3RhdGlj
IGludCBwdXRfcGFnZV9mcm9tX2w0ZShsNF9wZ2VudHJ5X3QgbDRlLCB1bnNp
Z25lZCBsb25nIHBmbiwKICAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQogICAg
ICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAgICB7Ci0gICAg
ICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwotICAgICAg
ICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGli
bGUsIG1mbl90b19wYWdlKHBmbikpOworICAgICAgICAgICAgLyogcGFydGlh
bF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBseSBwYXJ0aWFsX3JlZiAqLworICAg
ICAgICAgICAgQlVHKCk7CiAgICAgICAgIH0KIAogICAgICAgICBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKQEAgLTE3NDAsMTMgKzE3NDgsMjIgQEAgc3Rh
dGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
LCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAgICAgICAgICAgKHJjID0gZ2V0
X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuLCBkLCBwYXJ0aWFsX2ZsYWdz
KSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgIGlm
ICggcmMgPT0gLUVSRVNUQVJUICkKLSAgICAgICAgewotICAgICAgICAgICAg
cGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgLyog
U2V0ICdzZXQnLCByZXRhaW4gJ2dlbmVyYWwgcmVmJyAqLwotICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3MgfCBQVEZf
cGFydGlhbF9zZXQ7Ci0gICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIHJj
ID09IC1FSU5UUiAmJiBpICkKKyAgICAgICAgLyoKKyAgICAgICAgICogSXQg
c2hvdWxkbid0IGJlIHBvc3NpYmxlIGZvciBnZXRfcGFnZV9mcm9tX2wyZSB0
byByZXR1cm4KKyAgICAgICAgICogLUVSRVNUQVJULCBzaW5jZSB3ZSBuZXZl
ciBjYWxsIHRoaXMgd2l0aCBQVEZfcHJlZW1wdGlibGUuCisgICAgICAgICAq
IChhbGxvY19sMV90YWJsZSBtYXkgcmV0dXJuIC1FSU5UUiBvbiBhbiBMMVRG
LXZ1bG5lcmFibGUKKyAgICAgICAgICogZW50cnkuKQorICAgICAgICAgKgor
ICAgICAgICAgKiBOQiB0aGF0IHdoaWxlIG9uIGEgImNsZWFuIiBwcm9tb3Rp
b24sIHdlIGNhbiBuZXZlciBnZXQKKyAgICAgICAgICogUEdUX3BhcnRpYWwu
ICBJdCBpcyBwb3NzaWJsZSB0byBhcnJhbmdlIGZvciBhbiBsMmUgdG8KKyAg
ICAgICAgICogY29udGFpbiBhIHBhcnRpYWxseS1kZXZhbGlkYXRlZCBsMjsg
YnV0IGluIHRoYXQgY2FzZSwgYm90aAorICAgICAgICAgKiBvZiB0aGUgZm9s
bG93aW5nIGZ1bmN0aW9ucyB3aWxsIGZhaWwgYW55d2F5ICh0aGUgZmlyc3QK
KyAgICAgICAgICogYmVjYXVzZSB0aGUgcGFnZSBpbiBxdWVzdGlvbiBpcyBu
b3QgYW4gbDE7IHRoZSBzZWNvbmQKKyAgICAgICAgICogYmVjYXVzZSB0aGUg
cGFnZSBpcyBub3QgZnVsbHkgdmFsaWRhdGVkKS4KKyAgICAgICAgICovCisg
ICAgICAgIEFTU0VSVChyYyAhPSAtRVJFU1RBUlQpOworCisgICAgICAgIGlm
ICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKQEAgLTE3NTUsNiArMTc3Miw3IEBA
IHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAgICBlbHNlIGlmICgg
cmMgPCAwICYmIHJjICE9IC1FSU5UUiApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLCAiRmFpbHVyZSBpbiBhbGxv
Y19sMl90YWJsZTogc2xvdCAlI3hcbiIsIGkpOworICAgICAgICAgICAgQVNT
RVJUKGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwog
ICAgICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAg
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CkBAIC0xODE4
LDE3ICsxODM2LDIxIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBHVF9sMl9wYWdlX3RhYmxl
IHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFBHVF9wYWVfeGVuX2wyLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBh
cnRpYWxfZmxhZ3MgfCBQVEZfcHJlZW1wdGlibGUpOworICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlh
bF9mbGFncyB8CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBQVEZfcHJlZW1wdGlibGUgfAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFRG
X3JldGFpbl9yZWZfb25fcmVzdGFydCk7CiAgICAgICAgIH0KICAgICAgICAg
ZWxzZSBpZiAoICFpc19ndWVzdF9sM19zbG90KGkpIHx8Ci0gICAgICAgICAg
ICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2wzZShwbDNlW2ldLCBwZm4s
IGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQorICAgICAgICAgICAgICAgICAg
KHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UocGwzZVtpXSwgcGZuLCBkLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlh
bF9mbGFncyB8CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBQVEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0KSkgPiAwICkKICAg
ICAgICAgICAgIGNvbnRpbnVlOwogCiAgICAgICAgIGlmICggcmMgPT0gLUVS
RVNUQVJUICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOwogICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBs
ZWF2ZSAnZ2VuZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQg
Ki8KLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFs
X2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OworICAgICAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCBy
YyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsKQEAgLTE5MjMsMTQgKzE5
NDUsMTUgQEAgc3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlKQogICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9
IDAgKQogICAgIHsKICAgICAgICAgaWYgKCAhaXNfZ3Vlc3RfbDRfc2xvdChk
LCBpKSB8fAotICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDRl
KHBsNGVbaV0sIHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCisgICAg
ICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sNGUocGw0ZVtpXSwgcGZu
LCBkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWxf
ZmxhZ3MgfCBQVEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0KSkgPiAwICkKICAg
ICAgICAgICAgIGNvbnRpbnVlOwogCiAgICAgICAgIGlmICggcmMgPT0gLUVS
RVNUQVJUICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOwogICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBs
ZWF2ZSAnZ2VuZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQg
Ki8KLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFs
X2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OworICAgICAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCBy
YyA8IDAgKQogICAgICAgICB7CkBAIC0yMDI5LDkgKzIwNTIsNyBAQCBzdGF0
aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkK
ICAgICBlbHNlIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAg
ICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFn
ZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRp
YWxfc2V0KSA/Ci0gICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoKLSAgICAg
ICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFs
X3JlZik7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFy
dGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKICAgICB9CiAg
ICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxF
X0VOVFJJRVMgLSAxICkKICAgICB7CkBAIC0yMDgyLDkgKzIxMDMsNyBAQCBz
dGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSAocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFs
X3NldCkgPwotICAgICAgICAgICAgcGFydGlhbF9mbGFncyA6Ci0gICAgICAg
ICAgICAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9y
ZWYpOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRp
YWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CiAgICAgfQogICAg
IGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTIC0gMSApCiAgICAgewpAQCAtMjExNSw5ICsyMTM0LDcgQEAgc3Rh
dGljIGludCBmcmVlX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAg
cGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5w
YXJ0aWFsX2ZsYWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9z
ZXQpID8KLSAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgotICAgICAgICAg
ICAgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
KTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFs
X3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogICAgIH0KICAgICBl
bHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMNF9QQUdFVEFCTEVfRU5U
UklFUyAtIDEgKQogICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2Fz
bS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaAppbmRleCAw
YmY1YjYwYmE4Li42YWI2NDJlYjE4IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVk
ZS9hc20teDg2L21tLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5o
CkBAIC0xNTAsMjIgKzE1MCwyNSBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAgICAg
ICAgICAqIHBhZ2UuCiAgICAgICAgICAqCiAgICAgICAgICAqIFRoaXMgaGFw
cGVuczoKLSAgICAgICAgICogLSBEdXJpbmcgZGUtdmFsaWRhdGlvbiwgaWYg
ZGUtdmFsaWRhdGlvbiBvZiB0aGUgcGFnZSB3YXMKKyAgICAgICAgICogLSBE
dXJpbmcgdmFsaWRhdGlvbiBvciBkZS12YWxpZGF0aW9uLCBpZiB0aGUgb3Bl
cmF0aW9uIHdhcwogICAgICAgICAgKiAgIGludGVycnVwdGVkCiAgICAgICAg
ICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIGFuIGludmFsaWQgZW50cnkg
aXMgZW5jb3VudGVyZWQgYW5kCiAgICAgICAgICAqICAgdmFsaWRhdGlvbiBp
cyBwcmVlbXB0aWJsZQogICAgICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9u
LCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiB3YXMgc2V0IG9uCi0gICAg
ICAgICAqICAgdGhpcyBlbnRyeSB0byBiZWdpbiB3aXRoIChwZXJoYXBzIGJl
Y2F1c2Ugd2UncmUgcGlja2luZwotICAgICAgICAgKiAgIHVwIGZyb20gYSBw
YXJ0aWFsIGRlLXZhbGlkYXRpb24pLgorICAgICAgICAgKiAgIHRoaXMgZW50
cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFwcyBiZWNhdXNlIGl0IHBpY2tlZCB1
cCBhCisgICAgICAgICAqICAgcHJldmlvdXMgb3BlcmF0aW9uKQogICAgICAg
ICAgKgotICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24sIGlm
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIGNsZWFyLAotICAgICAgICAg
KiB0aGVuIGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1aXJl
ZDsgaWYgaXQgaXMgc2V0LCBubwotICAgICAgICAgKiByZWZlcmVuY2Ugc2hv
dWxkIGJlIGFjcXVpcmVkLgorICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIHZh
bGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzCisgICAg
ICAgICAqIGNsZWFyLCB0aGVuIGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBi
ZSByZS1hY3F1aXJlZDsgaWYgaXQKKyAgICAgICAgICogaXMgc2V0LCBubyBy
ZWZlcmVuY2Ugc2hvdWxkIGJlIGFjcXVpcmVkLgogICAgICAgICAgKgogICAg
ICAgICAgKiBXaGVuIHJlc3VtaW5nIGRlLXZhbGlkYXRpb24sIGlmIFBURl9w
YXJ0aWFsX2dlbmVyYWxfcmVmIGlzCiAgICAgICAgICAqIGNsZWFyLCBubyBy
ZWZlcmVuY2Ugc2hvdWxkIGJlIGRyb3BwZWQ7IGlmIGl0IGlzIHNldCwgYQog
ICAgICAgICAgKiByZWZlcmVuY2Ugc2hvdWxkIGJlIGRyb3BwZWQuCiAgICAg
ICAgICAqCisgICAgICAgICAqIE5CIGF0IHRoZSBtb21lbnQsIFBURl9wYXJ0
aWFsX3NldCBzaG91bGQgYmUgc2V0IGlmIGFuZCBvbmx5IGlmCisgICAgICAg
ICAqIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHNldC4KKyAgICAgICAg
ICoKICAgICAgICAgICogTkIgdGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGFyZQogICAgICAgICAgKiBkZWZpbmVk
IGluIG1tLmMsIHRoZSBvbmx5IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQu
CiAgICAgICAgICAqCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0009-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0009-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Transfer-Encoding: base64

RnJvbSBhMzQwZDUyYzE1MzdmMWQyOTYxMmQ1YzE3YTZiYTVlOTQ4YjEwZTY5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA5LzEyXSB4
ODYvbW06IENvbGxhcHNlIFBURl9wYXJ0aWFsX3NldCBhbmQKIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGludG8gb25lCgouLi5ub3cgdGhhdCB0aGV5IGFy
ZSBlcXVpdmFsZW50LiAgTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQu
CgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21tLmMg
ICAgICAgIHwgNTAgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIHwgMjkgKysrKysr
KysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAwYWM4YzQ1
OTJkLi5lZTkxYzY5NTM3IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNzcyLDEzICs3NzIsMTIg
QEAgc3RhdGljIGludCBfX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogCiAvKgogICogVGhlIGZv
bGxvd2luZyBmbGFncyBhcmUgdXNlZCB0byBzcGVjaWZ5IGJlaGF2aW9yIG9m
IHZhcmlvdXMgZ2V0IGFuZAotICogcHV0IGNvbW1hbmRzLiAgVGhlIGZpcnN0
IHR3byBhcmUgYWxzbyBzdG9yZWQgaW4gcGFnZS0+cGFydGlhbF9mbGFncwot
ICogdG8gaW5kaWNhdGUgdGhlIHN0YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQg
dG8gYnkKKyAqIHB1dCBjb21tYW5kcy4gIFRoZSBmaXJzdCBpcyBhbHNvIHN0
b3JlZCBpbiBwYWdlLT5wYXJ0aWFsX2ZsYWdzIHRvCisgKiBpbmRpY2F0ZSB0
aGUgc3RhdGUgb2YgdGhlIHBhZ2UgcG9pbnRlZCB0byBieQogICogcGFnZS0+
cHRlW3BhZ2UtPm5yX3ZhbGlkYXRlZF9lbnRyaWVzXS4gIFNlZSB0aGUgY29t
bWVudCBpbiBtbS5oIGZvcgogICogbW9yZSBpbmZvcm1hdGlvbi4KICAqLwog
I2RlZmluZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAgICgxIDw8IDApCi0j
ZGVmaW5lIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmICAgKDEgPDwgMSkKICNk
ZWZpbmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgICAoMSA8PCAyKQogI2Rl
ZmluZSBQVEZfZGVmZXIgICAgICAgICAgICAgICAgICgxIDw8IDMpCiAjZGVm
aW5lIFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQgKDEgPDwgNCkKQEAgLTc5
MSwxMyArNzkwLDEwIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVf
ZnJvbV9wYWdlbnIodW5zaWduZWQgbG9uZyBwYWdlX25yLAogICAgIHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9fcGFnZShwYWdlX25yKTsKICAg
ICBpbnQgcmM7CiAgICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZsYWdzICYgUFRG
X3ByZWVtcHRpYmxlLAotICAgICAgICAgcGFydGlhbF9yZWYgPSBmbGFncyAm
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmLAogICAgICAgICAgcGFydGlhbF9z
ZXQgPSBmbGFncyAmIFBURl9wYXJ0aWFsX3NldCwKICAgICAgICAgIHJldGFp
bl9yZWYgID0gZmxhZ3MgJiBQVEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0Owog
Ci0gICAgQVNTRVJUKHBhcnRpYWxfcmVmID09IHBhcnRpYWxfc2V0KTsKLQot
ICAgIGlmICggbGlrZWx5KCFwYXJ0aWFsX3JlZikgJiYKKyAgICBpZiAoIGxp
a2VseSghcGFydGlhbF9zZXQpICYmCiAgICAgICAgICB1bmxpa2VseSghZ2V0
X3BhZ2VfZnJvbV9wYWdlbnIocGFnZV9uciwgZCkpICkKICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7CiAKQEAgLTgwNywxNCArODAzLDE0IEBAIHN0YXRpYyBp
bnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIodW5zaWduZWQgbG9u
ZyBwYWdlX25yLAogICAgICAqIFJldGFpbiB0aGUgcmVmY291bnQgaWY6CiAg
ICAgICogLSBwYWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKICAg
ICAgKiAtIHBhZ2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6Ci0g
ICAgICogICAtIFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlh
bF9yZWYpCisgICAgICogICAtIFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5j
ZSAocGFydGlhbF9zZXQpCiAgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5
IHZhbGlkYXRlZCAocmMgPT0gLUVSRVNUQVJUKSwgYW5kIHRoZQogICAgICAq
ICAgICBjYWxsZXIgaGFzIGFza2VkIHRoZSByZWYgdG8gYmUgcmV0YWluZWQg
aW4gdGhhdCBjYXNlCiAgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZh
bGlkYXRlZCBidXQgdGhlcmUncyBiZWVuIGFuIGVycm9yCiAgICAgICogICAg
IChwYWdlID09IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKQogICAg
ICAqCi0gICAgICogVGhlIHBhcnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBp
cyB3b3J0aCBhbiBleHBsYW5hdGlvbi4gIFRoZXJlCi0gICAgICogYXJlIHR3
byBzY2VuYXJpb3Mgd2hlcmUgcGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBj
b21pbmcgaW46CisgICAgICogVGhlIHBhcnRpYWxfc2V0LW9uLWVycm9yIGNs
YXVzZSBpcyB3b3J0aCBhbiBleHBsYW5hdGlvbi4gIFRoZXJlCisgICAgICog
YXJlIHR3byBzY2VuYXJpb3Mgd2hlcmUgcGFydGlhbF9zZXQgbWlnaHQgYmUg
dHJ1ZSBjb21pbmcgaW46CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlh
bGx5IHByb21vdGVkIC8gZGVtb3RlZCBhcyB0eXBlIGB0eXBlYDsKICAgICAg
KiAgIGkuZS4gaGFzIFBHVF9wYXJ0aWFsIHNldAogICAgICAqIC0gbWZuIGhh
cyBiZWVuIHBhcnRpYWxseSBkZW1vdGVkIGFzIEwodHlwZSsxKSAoaS5lLiwg
YSBsaW5lYXIKQEAgLTgzNyw3ICs4MzMsNyBAQCBzdGF0aWMgaW50IGdldF9w
YWdlX2FuZF90eXBlX2Zyb21fcGFnZW5yKHVuc2lnbmVkIGxvbmcgcGFnZV9u
ciwKICAgICAgKiBjb3VudCByZXRhaW5lZCB1bmxlc3Mgd2Ugc3VjY2VlZGVk
LCBvciB0aGUgb3BlcmF0aW9uIHdhcwogICAgICAqIHByZWVtcHRpYmxlLgog
ICAgICAqLwotICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9yZWYg
KQorICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9zZXQgKQogICAg
ICAgICAvKiBub3RoaW5nICovOwogICAgIGVsc2UgaWYgKCBwYWdlID09IGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlIHx8CiAgICAgICAgICAgICAg
IChyZXRhaW5fcmVmICYmIHJjID09IC1FUkVTVEFSVCkgKQpAQCAtMTU0MCwx
MyArMTUzNiw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAgIHN0
cnVjdCBwYWdlX2luZm8gKnBnID0gbDJlX2dldF9wYWdlKGwyZSk7CiAgICAg
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnB0cGcgPSBtZm5fdG9fcGFnZShwZm4p
OwogCi0gICAgICAgIGlmICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3NldCB8
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KLSAgICAgICAgICAgICAg
UFRGX3BhcnRpYWxfc2V0ICkKLSAgICAgICAgewotICAgICAgICAgICAgLyog
cGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBseSBwYXJ0aWFsX3JlZiAq
LwotICAgICAgICAgICAgQlVHKCk7Ci0gICAgICAgIH0KLSAgICAgICAgZWxz
ZSBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKKyAgICAgICAgaWYgKCBmbGFn
cyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKICAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBwdHBnOwogICAgICAgICAgICAg
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKQEAgLTE1ODYs
MTMgKzE1NzYsNiBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwz
X3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgcGcg
PSBsM2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggKGZsYWdzICYgKFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0K
LSAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCi0gICAgewotICAgICAgICAv
KiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxfcmVm
ICovCi0gICAgICAgIEJVRygpOwotICAgIH0KLQogICAgIGlmICggZmxhZ3Mg
JiBQVEZfZGVmZXIgKQogICAgIHsKICAgICAgICAgY3VycmVudC0+YXJjaC5v
bGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKHBmbik7CkBAIC0xNjE3LDEz
ICsxNjAwLDYgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2w0ZShsNF9w
Z2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICB7CiAgICAg
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnBnID0gbDRlX2dldF9wYWdlKGw0ZSk7
CiAKLSAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQotICAgICAgICAgICAgICBQ
VEZfcGFydGlhbF9zZXQgKQotICAgICAgICB7Ci0gICAgICAgICAgICAvKiBw
YXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxfcmVmICov
Ci0gICAgICAgICAgICBCVUcoKTsKLSAgICAgICAgfQotCiAgICAgICAgIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2Uo
cGZuKTsKQEAgLTE4NTAsNyArMTgyNiw3IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgewog
ICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwogICAg
ICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJhbCByZWYnIHNl
dCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZjsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxh
Z3MgPSBQVEZfcGFydGlhbF9zZXQ7CiAgICAgICAgIH0KICAgICAgICAgZWxz
ZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpICkKICAgICAgICAgewpAQCAtMTk1
Myw3ICsxOTI5LDcgQEAgc3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICB7CiAgICAgICAgICAgICBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICAvKiBT
ZXQgJ3NldCcsIGxlYXZlICdnZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50
cnkgd2FzIHNldCAqLwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0
aWFsX3NldDsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggcmMgPCAw
ICkKICAgICAgICAgewpAQCAtMjA1Miw3ICsyMDI4LDcgQEAgc3RhdGljIGlu
dCBmcmVlX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAg
ZWxzZSBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBh
cnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9n
ZW5lcmFsX3JlZjsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBU
Rl9wYXJ0aWFsX3NldDsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1F
SU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7
CkBAIC0yMTAzLDcgKzIwNzksNyBAQCBzdGF0aWMgaW50IGZyZWVfbDNfdGFi
bGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09IC1F
UkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZf
cGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsKICAg
ICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDNfUEFH
RVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CkBAIC0yMTM0LDcgKzIxMTAs
NyBAQCBzdGF0aWMgaW50IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewog
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAg
IHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IFBURl9wYXJ0aWFsX3NldDsKICAgICB9CiAgICAgZWxzZSBpZiAo
IHJjID09IC1FSU5UUiAmJiBpIDwgTDRfUEFHRVRBQkxFX0VOVFJJRVMgLSAx
ICkKICAgICB7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKaW5kZXggNmFiNjQyZWIx
OC4uN2IwNTU4OWRjOCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaApAQCAtMTQ1
LDcgKzE0NSw3IEBAIHN0cnVjdCBwYWdlX2luZm8KICAgICAgICAgICogb3Bl
cmF0aW9uIG9uIHRoZSBjdXJyZW50IHBhZ2UuICAoVGhhdCBwYWdlIG1heSBv
ciBtYXkgbm90CiAgICAgICAgICAqIHN0aWxsIGhhdmUgUEdUX3BhcnRpYWwg
c2V0LikKICAgICAgICAgICoKLSAgICAgICAgICogSWYgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYgaXMgc2V0LCB0aGVuIHRoZSBQVEUgYXQKKyAgICAgICAg
ICogQWRkaXRpb25hbGx5LCBpZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIHRoZSBQVEUgYXQKICAgICAgICAgICogQG5yX3ZhbGlkYXRlZF9wdGVm
IGhvbGRzIGEgZ2VuZXJhbCByZWZlcmVuY2UgY291bnQgZm9yIHRoZQogICAg
ICAgICAgKiBwYWdlLgogICAgICAgICAgKgpAQCAtMTU0LDIzICsxNTQsMjAg
QEAgc3RydWN0IHBhZ2VfaW5mbwogICAgICAgICAgKiAgIGludGVycnVwdGVk
CiAgICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIGFuIGludmFs
aWQgZW50cnkgaXMgZW5jb3VudGVyZWQgYW5kCiAgICAgICAgICAqICAgdmFs
aWRhdGlvbiBpcyBwcmVlbXB0aWJsZQotICAgICAgICAgKiAtIER1cmluZyB2
YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiB3YXMgc2V0
IG9uCi0gICAgICAgICAqICAgdGhpcyBlbnRyeSB0byBiZWdpbiB3aXRoIChw
ZXJoYXBzIGJlY2F1c2UgaXQgcGlja2VkIHVwIGEKKyAgICAgICAgICogLSBE
dXJpbmcgdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfc2V0IHdhcyBzZXQg
b24gdGhpcworICAgICAgICAgKiAgIGVudHJ5IHRvIGJlZ2luIHdpdGggKHBl
cmhhcHMgYmVjYXVzZSBpdCBwaWNrZWQgdXAgYQogICAgICAgICAgKiAgIHBy
ZXZpb3VzIG9wZXJhdGlvbikKICAgICAgICAgICoKLSAgICAgICAgICogV2hl
biByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFs
X3JlZiBpcwotICAgICAgICAgKiBjbGVhciwgdGhlbiBhIGdlbmVyYWwgcmVm
ZXJlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQ7IGlmIGl0Ci0gICAgICAgICAq
IGlzIHNldCwgbm8gcmVmZXJlbmNlIHNob3VsZCBiZSBhY3F1aXJlZC4KKyAg
ICAgICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFy
dGlhbF9zZXQgaXMgY2xlYXIsIHRoZW4KKyAgICAgICAgICogYSBnZW5lcmFs
IHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVpcmVkOyBpZiBpdCBpcyBzZXQs
IG5vCisgICAgICAgICAqIHJlZmVyZW5jZSBzaG91bGQgYmUgYWNxdWlyZWQu
CiAgICAgICAgICAqCi0gICAgICAgICAqIFdoZW4gcmVzdW1pbmcgZGUtdmFs
aWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMKLSAgICAg
ICAgICogY2xlYXIsIG5vIHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZDsg
aWYgaXQgaXMgc2V0LCBhCi0gICAgICAgICAqIHJlZmVyZW5jZSBzaG91bGQg
YmUgZHJvcHBlZC4KKyAgICAgICAgICogV2hlbiByZXN1bWluZyBkZS12YWxp
ZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9zZXQgaXMgY2xlYXIsCisgICAgICAg
ICAqIG5vIHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZDsgaWYgaXQgaXMg
c2V0LCBhIHJlZmVyZW5jZQorICAgICAgICAgKiBzaG91bGQgYmUgZHJvcHBl
ZC4KICAgICAgICAgICoKLSAgICAgICAgICogTkIgYXQgdGhlIG1vbWVudCwg
UFRGX3BhcnRpYWxfc2V0IHNob3VsZCBiZSBzZXQgaWYgYW5kIG9ubHkgaWYK
LSAgICAgICAgICogUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0Lgot
ICAgICAgICAgKgotICAgICAgICAgKiBOQiB0aGF0IFBURl9wYXJ0aWFsX3Nl
dCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgYXJlCi0gICAgICAgICAq
IGRlZmluZWQgaW4gbW0uYywgdGhlIG9ubHkgcGxhY2Ugd2hlcmUgdGhleSBh
cmUgdXNlZC4KKyAgICAgICAgICogTkIgdGhhdCBQVEZfcGFydGlhbF9zZXQg
aXMgZGVmaW5lZCBpbiBtbS5jLCB0aGUgb25seSBwbGFjZQorICAgICAgICAg
KiB3aGVyZSBpdCBpcyB1c2VkLgogICAgICAgICAgKgogICAgICAgICAgKiBU
aGUgM3JkIGZpZWxkLCBAbGluZWFyX3B0X2NvdW50LCBpbmRpY2F0ZXMKICAg
ICAgICAgICogLSBieSBhIHBvc2l0aXZlIHZhbHVlLCBob3cgbWFueSBzYW1l
LWxldmVsIHBhZ2UgdGFibGUgZW50cmllcyBhIHBhZ2UKQEAgLTE4MCw4ICsx
NzcsOCBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAgICAgICAgICAqLwogICAgICAg
ICBzdHJ1Y3QgewogICAgICAgICAgICAgdTE2IG5yX3ZhbGlkYXRlZF9wdGVz
OlBBR0VUQUJMRV9PUkRFUiArIDE7Ci0gICAgICAgICAgICB1MTYgOjE2IC0g
UEFHRVRBQkxFX09SREVSIC0gMSAtIDI7Ci0gICAgICAgICAgICB1MTYgcGFy
dGlhbF9mbGFnczoyOworICAgICAgICAgICAgdTE2IDoxNiAtIFBBR0VUQUJM
RV9PUkRFUiAtIDEgLSAxOworICAgICAgICAgICAgdTE2IHBhcnRpYWxfZmxh
Z3M6MTsKICAgICAgICAgICAgIHMxNiBsaW5lYXJfcHRfY291bnQ7CiAgICAg
ICAgIH07CiAKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0010-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0010-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Transfer-Encoding: base64

RnJvbSA5ZTZjYWFiZTQzMTRhZWU1ZmI2ZDQwNWE4OTIxMmQ0OWQ0NTZjZTIw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDEwLzEyXSB4
ODYvbW06IFByb3Blcmx5IGhhbmRsZSBsaW5lYXIgcGFnZXRhYmxlIHByb21v
dGlvbgogZmFpbHVyZXMKCkluIG9yZGVyIHRvIGFsbG93IHJlY3Vyc2l2ZSBw
YWdldGFibGUgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIHRvIGJlCmludGVy
cnVwdGVkLCBYZW4gbXVzdCBrZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0
aGUgc3ViLXBhZ2VzCnByb21vdGVkIG9yIGRlbW90ZWQuICBUaGlzIGlzIHN0
b3JlZCBpbiB0d28gZWxlbWVudHMgaW4gdGhlIHBhZ2UKc3RydWN0OiBucl9l
bnRyaWVzX3ZhbGlkYXRlZCBhbmQgcGFydGlhbF9mbGFncy4KClRoZSBydWxl
IGlzIHRoYXQgZW50cmllcyBbMCwgbnJfZW50cmllc192YWxpZGF0ZWQpIHNo
b3VsZCBhbHdheXMgYmUKdmFsaWRhdGVkIGFuZCBob2xkIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgY291bnQuICBJZiBwYXJ0aWFsX2ZsYWdzIGlzCnplcm8sIHRo
ZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXSBpcyBub3QgdmFsaWRhdGVkIGFu
ZCBubyByZWZlcmVuY2UKY291bnQgaXMgaGVsZC4gIElmIFBURl9wYXJ0aWFs
X3NldCBpcyBzZXQsIHRoZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXQppcyBw
YXJ0aWFsbHkgdmFsaWRhdGVkLCBhbmQgYSBnZW5lcmFsIHJlZmVyZW5jZSBj
b3VudCBpcyBoZWxkLgoKVW5mb3J0dW5hdGVseSwgaW4gY2FzZXMgd2hlcmUg
YW4gZW50cnkgYmVnYW4gd2l0aCBQVEZfcGFydGlhbF9zZXQgc2V0LAphbmQg
Z2V0X3BhZ2VfZnJvbV9sTmUoKSByZXR1cm5zIC1FSU5WQUwsIHRoZSBQVEZf
cGFydGlhbF9zZXQgYml0IGlzCmVycm9uZW91c2x5IGRyb3BwZWQuICAoVGhp
cyBzY2VuYXJpbyBjYW4gYmUgZW5naW5lZXJlZCBtYWlubHkgYnkgdGhlCnVz
ZSBvZiBpbnRlcmxlYXZpbmcgb2YgcHJvbW90aW5nIGFuZCBkZW1vdGluZyBh
IHBhZ2Ugd2hpY2ggaGFzICJsaW5lYXIKcGFnZXRhYmxlIiBlbnRyaWVzOyBz
ZWUgdGhlIGFwcGVuZGl4IGZvciBhIHNrZXRjaC4pICBUaGlzIG1lYW5zIHRo
YXQKd2Ugd2lsbCAibGVhayIgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBv
biB0aGUgcGFnZSBpbiBxdWVzdGlvbiwKcHJldmVudGluZyB0aGUgcGFnZSBm
cm9tIGJlaW5nIGZyZWVkLgoKRml4IHRoaXMgYnkgc2V0dGluZyBwYWdlLT5w
YXJ0aWFsX2ZsYWdzIHRvIHRoZSBwYXJ0aWFsX2ZsYWdzIGxvY2FsCnZhcmlh
YmxlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTkuCgpSZXBvcnRlZC1ieTog
R2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+Ci0tLS0tCkFwcGVuZGl4CgpTdXBwb3NlIEEgYW5kIEIgY2FuIGJv
dGggYmUgcHJvbW90ZWQgdG8gTDIgcGFnZXMsIGFuZCBBW3hdIHBvaW50cyB0
byBCLgoKVjE6IFBJTl9MMiBCLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1Rf
dmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkCgpWMTog
TU9EX0wzX0VOVFJZIHBvaW50aW5nIHNvbWV0aGluZyB0byBBLgogIEluIHRo
ZSBwcm9jZXNzIG9mIHZhbGlkYXRpbmcgQVt4XSwgZ3JhYiBhbiBleHRyYSB0
eXBlIC8gcmVmIG9uIEI6CiAgQi50eXBlX2NvdW50ID0gMiB8IFBHVF92YWxp
ZGF0ZWQKICBCLmNvdW50ID0gMyB8IFBHQ19hbGxvY2F0ZWQKICBBLnR5cGVf
Y291bnQgPSAxIHwgUEdUX3ZhbGlkYXRlZAogIEEuY291bnQgPSAyIHwgUEdD
X2FsbG9jYXRlZAoKVjE6IFVOUElOIEIuCiAgQi50eXBlX2NvdW50ID0gMSB8
IFBHVF92YWxpZGF0ZQogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAoK
VjE6IE1PRF9MM19FTlRSWSByZW1vdmluZyB0aGUgcmVmZXJlbmNlIHRvIEEu
CiAgRGUtdmFsaWRhdGUgQSwgZG93biB0byBBW3hdLCB3aGljaCBwb2ludHMg
dG8gQi4KICBEcm9wIHRoZSBmaW5hbCB0eXBlIG9uIEIuICBBcnJhbmdlIHRv
IGJlIGludGVycnVwdGVkLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFy
dGlhbAogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAogIEEudHlwZV9j
b3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFsaWRhdGVkX2VudHJp
ZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IC0xCgpWMjogTU9EX0wzX0VOVFJZ
IGFkZHMgYSByZWZlcmVuY2UgdG8gQS4KCkF0IHRoaXMgcG9pbnQsIGdldF9w
YWdlX2Zyb21fbDJlKEFbeF0pIHRyaWVzCmdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKCksIHdoaWNoIGZhaWxzIGJlY2F1c2UgaXQncyB0aGUgd3Jvbmcg
dHlwZTsKYW5kIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKCkgYWxzbyBmYWls
cywgYmVjYXVzZSBCIGlzbid0IHZhbGlkYXRlZCBhcwphbiBsMiBhbnltb3Jl
LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNiArKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCBlZTkxYzY5NTM3Li4xOWIxNmRlNWQxIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTc1Miw3ICsxNzUyLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAg
ICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKKyAgICAgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKICAg
ICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
TlVMTDsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSA9IHBhZ2U7CiAgICAgICAgICAgICB9CkBAIC0xODQ4LDcgKzE4
NDgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIGlmICggaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOworICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKICAgICAgICAgfQpAQCAtMTkzOSw3ICsxOTM5LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CisgICAgICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAg
ICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBlbHNl
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0011-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0011-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Transfer-Encoding: base64

RnJvbSA3ZGY1ZDc0YWRmZmM4NTdmZWZiNWQ3NzhjZmQyN2E5YjhlMTRkYWM1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDExLzEyXSB4
ODYvbW06IEZpeCBuZXN0ZWQgZGUtdmFsaWRhdGlvbiBvbiBlcnJvcgoKSWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBkaXNjb3ZlcmVkIHdoZW4gdmFsaWRhdGlu
ZyBhIHBhZ2UtdGFibGUgdHJlZSwKdGhlIGVudGlyZSB0cmVlIHdoaWNoIGhh
cyBzbyBmYXIgYmVlbiB2YWxpZGF0ZWQgbXVzdCBiZSBkZS12YWxpZGF0ZWQu
ClNpbmNlIHRoaXMgbWF5IHRha2UgYSBsb25nIHRpbWUsIGFsbG9jX2xbMi00
XV90YWJsZSgpIHNldCBjdXJyZW50CnZjcHUncyBvbGRfZ3Vlc3RfdGFibGUg
aW1tZWRpYXRlbHk7IHB1dF9vbGRfZ3Vlc3RfdGFibGUoKSB3aWxsIG1ha2UK
c3VyZSB0aGF0IHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxlZCB0byBm
aW5pc2ggb2ZmIHRoZQpkZS12YWxpZGF0aW9uIGJlZm9yZSBhbnkgb3RoZXIg
TU1VIG9wZXJhdGlvbnMgY2FuIGhhcHBlbiBvbiB0aGUgdmNwdS4KClRoZSBp
bnZhcmlhbnQgZm9yIHBhcnRpYWwgcGFnZXMgc2hvdWxkIGJlOgoKKiBFbnRy
aWVzIFswLCBucl92YWxpZGF0ZWRfcHRlcykgc2hvdWxkIGJlIGNvbXBsZXRl
bHkgdmFsaWRhdGVkOwogIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGRlLXZhbGlk
YXRlIHRoZXNlLgoKKiBJZiBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHBhcnRp
YWxseSB2YWxpZGF0ZWQsIHBhcnRpYWxfZmxhZ3Mgc2hvdWxkCiAgc2V0IFBU
Rl9wYXJ0aWFMX3NldC4gIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxl
ZCBvbiB0aGlzIHBhZ2UgdG8KICBmaW5pc2ggb2ZmIGRldmFsaWRhdGlvbiwg
YW5kIHRoZSBhcHByb3ByaWF0ZSByZWZjb3VudCBhZGp1c3RtZW50cwogIHdp
bGwgYmUgZG9uZS4KCmFsbG9jX2xbMi0zXV90YWJsZSgpIGluZGljYXRlcyBw
YXJ0aWFsIHZhbGlkYXRpb24gdG8gaXRzIGNhbGxlcnMgYnkKc2V0dGluZyBj
dXJyZW50LT5vbGRfZ3Vlc3RfdGFibGUuCgpVbmZvcnR1bmF0ZWx5LCB0aGlz
IGlzIG1pc2hhbmRsZWQuCgpUYWtlIHRoZSBjYXNlIHdoZXJlIHZhbGlkYXRp
bmcgbE5lW3hdIHJldHVybnMgYW4gZXJyb3IuCgpGaXJzdCwgYWxsb2NfbDNf
dGFibGUoKSBkb2Vzbid0IGNoZWNrIG9sZF9ndWVzdF90YWJsZSBhdCBhbGw7
IGFzIGEKcmVzdWx0LCBwYXJ0aWFsX2ZsYWdzIGlzIG5vdCBzZXQgd2hlbiBp
dCBzaG91bGQgYmUuICBucl92YWxpZGF0ZWRfcHRlcwppcyBzZXQgdG8geDsg
YW5kIHNpbmNlIFBGVF9wYXJ0aWFsX3NldCBjbGVhciwgZGUtdmFsaWRhdGlv
biByZXN1bWVzIGF0Cm5yX3ZhbGlkYXRlZF9wdGVzLTEuICBUaGlzIG1lYW5z
IHRoYXQgdGhlIGwyIHBhZ2UgYXQgcGwzZVt4XSB3aWxsIG5vdApoYXZlIHB1
dF9wYWdlX3R5cGUoKSBjYWxsZWQgb24gaXQgd2hlbiBkZS12YWxpZGF0aW5n
IHRoZSByZXN0IG9mIHRoZQpsMzogaXQgd2lsbCBiZSBzdHVjayBpbiB0aGUg
UEdUX3BhcnRpYWwgc3RhdGUgdW50aWwgdGhlIGRvbWFpbiBpcwpkZXN0cm95
ZWQsIG9yIHVudGlsIGl0IGlzIHJlLXVzZWQgYXMgYW4gbDIuICAoQW55IG90
aGVyIHBhZ2UgdHlwZSB3aWxsCmZhaWwuKQoKV29yc2UsIGFsbG9jX2w0X3Rh
YmxlKCksIHJhdGhlciB0aGFuIHNldHRpbmcgUFRGX3BhcnRpYWxfc2V0IGFz
IGl0CnNob3VsZCwgc2V0cyBucl92YWxpZGF0ZWRfcHRlcyB0byB4KzEuICBX
aGVuIGRlLXZhbGlkYXRpbmcsIHNpbmNlCnBhcnRpYWwgaXMgMCwgdGhpcyB3
aWxsIGNvcnJlY3RseSByZXN1bWUgY2FsbGluZyBwdXRfcGFnZV90eXBlIGF0
IFt4XTsKYnV0LCBpZiB0aGUgcHV0X3BhZ2VfdHlwZSgpIGlzIG5ldmVyIGNh
bGxlZCwgYnV0IGluc3RlYWQKZ2V0X3BhZ2VfdHlwZSgpIGlzIGNhbGxlZCwg
dmFsaWRhdGlvbiB3aWxsIHBpY2sgdXAgYXQgW3grMV0sCm5lZ2xlY3Rpbmcg
dG8gdmFsaWRhdGUgW3hdLiAgSWYgdGhlIHJlc3Qgb2YgdGhlIHZhbGlkYXRp
b24gc3VjY2VlZHMsCnRoZSBsNCB3aWxsIGJlIHZhbGlkYXRlZCBldmVuIHRo
b3VnaCBbeF0gaXMgaW52YWxpZC4KCkZpeCB0aGlzIGluIGJvdGggY2FzZXMg
Ynkgc2V0dGluZyBQVEZfcGFydGlhbF9zZXQgaWYgb2xkX2d1ZXN0X3RhYmxl
CmlzIHNldC4KCldoaWxlIGhlcmUsIGFkZCBzb21lIHNhZmV0eSBjYXRjaGVz
OgotIG9sZF9ndWVzdF90YWJsZSBtdXN0IHBvaW50IHRvIHRoZSBwYWdlIGNv
bnRhaW5lZCBpbgogIFtucl92YWxpZGF0ZWRfcHRlc10uCi0gYWxsb2NfbDFf
cGFnZSBzaG91bGRuJ3Qgc2V0IG9sZF9ndWVzdF90YWJsZQoKSWYgd2UgZXhw
ZXJpZW5jZSBvbmUgb2YgdGhlc2Ugc2l0dWF0aW9ucyBpbiBwcm9kdWN0aW9u
IGJ1aWxkcywgaXQncwpzYWZlciB0byBhdm9pZCBjYWxsaW5nIHB1dF9wYWdl
X3R5cGUgZm9yIHRoZSBwYWdlcyBpbiBxdWVzdGlvbi4gIElmCnRoZXkgaGF2
ZSBQR1RfcGFydGlhbCBzZXQsIHRoZXkgd2lsbCBiZSBjbGVhbmVkIHVwIG9u
IGRvbWFpbgpkZXN0cnVjdGlvbjsgaWYgbm90LCB3ZSBoYXZlIG5vIGlkZWEg
d2hldGhlciBhIHR5cGUgY291bnQgaXMgc2FmZSB0bwpkcm9wLiAgUmV0YWlu
aW5nIGFuIGV4dHJhIHR5cGUgcmVmIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBk
cm9wcGVkIG1heQp0cmlnZ2VyIGEgQlVHKCkgb24gdGhlIGZyZWVfZG9tYWlu
X3BhZ2UoKSBwYXRoLCBidXQgZHJvcHBpbmcgYSB0eXBlCmNvdW50IHRoYXQg
c2hvdWxkbid0IGJlIGRyb3BwZWQgbWF5IGNhdXNlIGEgcHJpdmlsZWdlIGVz
Y2FsYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDU1ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiAx
IGZpbGUgY2hhbmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigt
KQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS5jIGIveGVuL2FyY2gv
eDg2L21tLmMKaW5kZXggMTliMTZkZTVkMS4uNGFmODJkNjQ0NyAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysrIGIveGVuL2FyY2gveDg2L21t
LmMKQEAgLTE3NTEsNiArMTc1MSwyMCBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9PSBOVUxMKTsKICAgICAgICAgICAgIGlmICggaSApCiAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAg
ICAgICAgKiBhbGxvY19sMV90YWJsZSgpIGRvZXNuJ3Qgc2V0IG9sZF9ndWVz
dF90YWJsZTsgaXQgZG9lcworICAgICAgICAgICAgICAgICAqIGl0cyBvd24g
dGVhci1kb3duIGltbWVkaWF0ZWx5IG9uIGZhaWx1cmUuICBJZiBpdAorICAg
ICAgICAgICAgICAgICAqIGRpZCB3ZSdkIG5lZWQgdG8gY2hlY2sgaXQgYW5k
IHNldCBwYXJ0aWFsX2ZsYWdzIGFzIHdlCisgICAgICAgICAgICAgICAgICog
ZG8gaW4gYWxsb2NfbFszNF1fdGFibGUoKS4KKyAgICAgICAgICAgICAgICAg
KgorICAgICAgICAgICAgICAgICAqIE5vdGUgb24gdGhlIHVzZSBvZiBBU1NF
UlQ6IGlmIGl0J3Mgbm9uLW51bGwgYW5kCisgICAgICAgICAgICAgICAgICog
aGFzbid0IGJlZW4gY2xlYW5lZCB1cCB5ZXQsIGl0IHNob3VsZCBoYXZlCisg
ICAgICAgICAgICAgICAgICogUEdUX3BhcnRpYWwgc2V0OyBhbmQgc28gdGhl
IHR5cGUgd2lsbCBiZSBjbGVhbmVkIHVwCisgICAgICAgICAgICAgICAgICog
b24gZG9tYWluIGRlc3RydWN0aW9uLiAgVW5mb3J0dW5hdGVseSwgd2Ugd291
bGQKKyAgICAgICAgICAgICAgICAgKiBsZWFrIHRoZSBnZW5lcmFsIHJlZiBo
ZWxkIGJ5IG9sZF9ndWVzdF90YWJsZTsgYnV0CisgICAgICAgICAgICAgICAg
ICogbGVha2luZyBhIHBhZ2UgaXMgbGVzcyBiYWQgdGhhbiBhIGhvc3QgY3Jh
c2guCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgQVNT
RVJUKGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwog
ICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
ICAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlh
bF9mbGFnczsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF9wdHBnID0gTlVMTDsKQEAgLTE3ODQsNiArMTc5OCw3IEBAIHN0YXRp
YyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkK
ICAgICB1bnNpZ25lZCBpbnQgICBpOwogICAgIGludCAgICAgICAgICAgIHJj
ID0gMDsKICAgICB1bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFn
ZS0+cGFydGlhbF9mbGFnczsKKyAgICBsM19wZ2VudHJ5X3QgICBsM2UgPSBs
M2VfZW1wdHkoKTsKIAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21m
bihwZm4pKTsKIApAQCAtMTgzNSw3ICsxODUwLDExIEBAIHN0YXRpYyBpbnQg
YWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAg
ICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlm
ICggcmMgPCAwICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogWFNBLTI5
OSBCYWNrcG9ydDogQ29weSBsM2UgZm9yIGNoZWNraW5nICovCisgICAgICAg
ICAgICBsM2UgPSBwbDNlW2ldOwogICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KIAogICAgICAgICBhZGp1c3RfZ3Vlc3RfbDNlKHBsM2VbaV0sIGQp
OwogICAgIH0KQEAgLTE4NDksNiArMTg2OCwyNCBAQCBzdGF0aWMgaW50IGFs
bG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAg
IHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
ICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2Zs
YWdzOworICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLyoK
KyAgICAgICAgICAgICAgICAgKiBXZSd2ZSBleHBlcmllbmNlZCBhIHZhbGlk
YXRpb24gZmFpbHVyZS4gIElmCisgICAgICAgICAgICAgICAgICogb2xkX2d1
ZXN0X3RhYmxlIGlzIHNldCwgInRyYW5zZmVyIiB0aGUgZ2VuZXJhbAorICAg
ICAgICAgICAgICAgICAqIHJlZmVyZW5jZSBjb3VudCB0byBwbDNlW25yX3Zh
bGlkYXRlZF9wdGVzXSBieQorICAgICAgICAgICAgICAgICAqIHNldHRpbmcg
UFRGX3BhcnRpYWxfc2V0LgorICAgICAgICAgICAgICAgICAqCisgICAgICAg
ICAgICAgICAgICogQXMgYSBwcmVjYXV0aW9uLCBjaGVjayB0aGF0IG9sZF9n
dWVzdF90YWJsZSBpcyB0aGUKKyAgICAgICAgICAgICAgICAgKiBwYWdlIHBv
aW50ZWQgdG8gYnkgcGwzZVtucl92YWxpZGF0ZWRfcHRlc10uICBJZgorICAg
ICAgICAgICAgICAgICAqIG5vdCwgaXQncyBzYWZlciB0byBsZWFrIGEgdHlw
ZSByZWYgb24gcHJvZHVjdGlvbgorICAgICAgICAgICAgICAgICAqIGJ1aWxk
cy4KKyAgICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgICAgICBpZiAo
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IGwzZV9nZXRfcGFn
ZShsM2UpICkKKyAgICAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgICAgICBlbHNl
CisgICAgICAgICAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOwor
ICAgICAgICAgICAgfQogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CiAgICAgICAgIH0KQEAgLTE5NDUs
NyArMTk4MiwyMyBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICAgICAgZWxzZQogICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCi0gICAgICAgICAgICAgICAg
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcysrOworICAgICAgICAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICAgICAgICAvKgorICAg
ICAgICAgICAgICAgICAgICAgICAgICogV2UndmUgZXhwZXJpZW5jZWQgYSB2
YWxpZGF0aW9uIGZhaWx1cmUuICBJZgorICAgICAgICAgICAgICAgICAgICAg
ICAgICogb2xkX2d1ZXN0X3RhYmxlIGlzIHNldCwgInRyYW5zZmVyIiB0aGUg
Z2VuZXJhbAorICAgICAgICAgICAgICAgICAgICAgICAgICogcmVmZXJlbmNl
IGNvdW50IHRvIHBsM2VbbnJfdmFsaWRhdGVkX3B0ZXNdIGJ5CisgICAgICAg
ICAgICAgICAgICAgICAgICAgKiBzZXR0aW5nIFBURl9wYXJ0aWFsX3NldC4K
KyAgICAgICAgICAgICAgICAgICAgICAgICAqCisgICAgICAgICAgICAgICAg
ICAgICAgICAgKiBBcyBhIHByZWNhdXRpb24sIGNoZWNrIHRoYXQgb2xkX2d1
ZXN0X3RhYmxlIGlzIHRoZQorICAgICAgICAgICAgICAgICAgICAgICAgICog
cGFnZSBwb2ludGVkIHRvIGJ5IHBsNGVbbnJfdmFsaWRhdGVkX3B0ZXNdLiAg
SWYKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIG5vdCwgaXQncyBzYWZl
ciB0byBsZWFrIGEgdHlwZSByZWYgb24gcHJvZHVjdGlvbgorICAgICAgICAg
ICAgICAgICAgICAgICAgICogYnVpbGRzLgorICAgICAgICAgICAgICAgICAg
ICAgICAgICovCisgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IGw0ZV9nZXRfcGFnZShwbDRl
W2ldKSApCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZS0+cGFy
dGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgICAg
ICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBB
U1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICAgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9w
dHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICAgICAgICAgIH0K
LS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.9/0012-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Disposition: attachment;
 filename="xsa299-4.9/0012-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Transfer-Encoding: base64

RnJvbSAxZDAxN2FmNDUwMTFlNTRjMWY0MDE3MWNhZTU1N2QwYzhkMWQ0MTA0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NTAgKzAxMDAKU3ViamVjdDogW1BBVENIIDEyLzEyXSB4
ODYvbW06IERvbid0IGRyb3AgYSB0eXBlIHJlZiB1bmxlc3MgeW91IGhlbGQg
YSByZWYgdG8KIGJlZ2luIHdpdGgKClZhbGlkYXRpb24gYW5kIGRlLXZhbGlk
YXRpb24gb2YgcGFnZXRhYmxlIHRyZWVzIG1heSB0YWtlIGFyYml0cmFyaWx5
CmxhcmdlIGFtb3VudHMgb2YgdGltZSwgYW5kIHNvIG11c3QgYmUgcHJlZW1w
dGlibGUuICBUaGlzIGlzIGluZGljYXRlZApieSBzZXR0aW5nIHRoZSBQR1Rf
cGFydGlhbCBiaXQgaW4gdGhlIHR5cGVfaW5mbywgYW5kIHNldHRpbmcKbnJf
dmFsaWRhdGVkX2VudHJpZXMgYW5kIHBhcnRpYWxfZmxhZ3MgYXBwcm9wcmlh
dGVseS4gIFNwZWNpZmljYWxseSwKaWYgdGhlIGVudHJ5IGF0IFtucl92YWxp
ZGF0ZWRfZW50cmllc10gaXMgcGFydGlhbGx5IHZhbGlkYXRlZCwKcGFydGlh
bF9mbGFncyBzaG91bGQgaGF2ZSB0aGUgUEdUX3BhcnRpYWxfc2V0IGJpdCBz
ZXQsIGFuZCB0aGUgZW50cnkKc2hvdWxkIGhvbGQgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudC4gIER1cmluZyBkZS12YWxpZGF0aW9uLApwdXRfcGFnZV90
eXBlKCkgaXMgY2FsbGVkIG9uIHBhcnRpYWxseSB2YWxpZGF0ZWQgZW50cmll
cy4KClVuZm9ydHVuYXRlbHksIHRoZXJlIGFyZSBhIG51bWJlciBvZiBpc3N1
ZXMgd2l0aCB0aGUgY3VycmVudCBhbGdvcml0aG0uCgpGaXJzdCwgZG9pbmcg
YSAibm9ybWFsIiBwdXRfcGFnZV90eXBlKCkgaXMgbm90IHNhZmUgd2hlbiBu
byB0eXBlIHJlZgppcyBoZWxkOiB0aGVyZSBpcyBub3RoaW5nIHRvIHN0b3Ag
YW5vdGhlciB2Y3B1IGZyb20gY29taW5nIGFsb25nIGFuZApwaWNraW5nIHVw
IHZhbGlkYXRpb24gYWdhaW46IGF0IHdoaWNoIHBvaW50IHRoZSBwdXRfcGFn
ZV90eXBlIG1heSBkcm9wCnRoZSBvbmx5IHBhZ2UgcmVmIG9uIGFuIGluLXVz
ZSBwYWdlLiAgU29tZSBleGFtcGxlcyBhcmUgbGlzdGVkIGluIHRoZQphcHBl
bmRpeC4KClRoZSBjb3JlIGlzc3VlIGlzIHRoYXQgcHV0X3BhZ2VfdHlwZSgp
IGlzIGJlaW5nIGNhbGxlZCBib3RoIHRvIGNsZWFuCnVwIFBHVF9wYXJ0aWFs
LCBhbmQgdG8gZHJvcCBhIHR5cGUgY291bnQ7IGFuZCBoYXMgbm8gd2F5IG9m
IGtub3dpbmcKd2hpY2ggaXMgd2hpY2g7IGFuZCBzbyBpZiBpbiBiZXR3ZWVu
LCBQR1RfcGFydGlhbCBpcyBjbGVhcmVkLApwdXRfcGFnZV90eXBlKCkgd2ls
bCBkcm9wIHRoZSB0eXBlIHJlZiBlcnJvbmVvdXNseS4KCldoYXQgaXMgbmVl
ZGVkIGlzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIHN0YXRlczoKLSBE
cm9wcGluZyBhIHR5cGUgcmVmIHdoaWNoIGlzIGhlbGQKLSBDbGVhbmluZyB1
cCBhIHBhZ2Ugd2hpY2ggaGFzIGJlZW4gcGFydGlhbGx5IGRlL3ZhbGlkYXRl
ZAoKRml4IHRoaXMgYnkgdGVsbGluZyBwdXRfcGFnZV90eXBlKCkgd2hpY2gg
b2YgdGhlIHR3byBhY3Rpdml0aWVzIHlvdQppbnRlbmQuCgpXaGVuIGNsZWFu
aW5nIHVwIGEgcGFydGlhbCBkZS92YWxpZGF0aW9uLCB0YWtlIG5vIGFjdGlv
biB1bmxlc3MgeW91CmZpbmQgYSBwYWdlIHBhcnRpYWxseSB2YWxpZGF0ZWQu
CgpJZiBwdXRfcGFnZV90eXBlKCkgaXMgY2FsbGVkIHdpdGhvdXQgUFRGX3Bh
cnRpYWxfc2V0LCBhbmQgZmluZHMgdGhlCnBhZ2UgaW4gYSBQR1RfcGFydGlh
bCBzdGF0ZSBhbnl3YXksIHRoZW4gdGhlcmUncyBjZXJ0YWlubHkgYmVlbiBh
Cm1pc2FjY291bnRpbmcgc29tZXdoZXJlLCBhbmQgY2Fycnlpbmcgb24gd291
bGQgYWxtb3N0IGNlcnRhaW5seSBjYXVzZQphIHNlY3VyaXR5IGlzc3VlLCBz
byBjcmFzaCB0aGUgaG9zdCBpbnN0ZWFkLgoKSW4gcHV0X3BhZ2VfZnJvbV9s
TmUsIHBhc3MgcGFydGlhbF9mbGFncyBvbiB0byBfcHV0X3BhZ2VfdHlwZSgp
LgoKb2xkX2d1ZXN0X3RhYmxlIG1heSBiZSBzZXQgZWl0aGVyIHdpdGggYSBm
dWxseSB2YWxpZGF0ZWQgcGFnZSAod2hlbgp1c2luZyB0aGUgImRlZmVycmVk
IHB1dCIgcGF0dGVybiksIG9yIHdpdGggYSBwYXJ0aWFsbHkgdmFsaWRhdGVk
IHBhZ2UKKHdoZW4gYSBub3JtYWwgImRlLXZhbGlkYXRpb24iIGlzIGludGVy
cnVwdGVkLCBvciB3aGVuIGEgdmFsaWRhdGlvbgpmYWlscyBwYXJ0LXdheSB0
aHJvdWdoIGR1ZSB0byBpbnZhbGlkIGVudHJpZXMpLiAgQWRkIGEgZmxhZywK
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwsIHRvIGluZGljYXRlIHdoaWNoIG9m
IHRoZXNlIGl0IGlzLCBhbmQgdXNlCnRoYXQgdG8gcGFzcyB0aGUgYXBwcm9w
cmlhdGUgZmxhZyB0byBfcHV0X3BhZ2VfdHlwZSgpLgoKV2hpbGUgaGVyZSwg
ZGVsZXRlIHN0cmF5IHRyYWlsaW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tLS0KQXBw
ZW5kaXg6CgpTdXBwb3NlIHBhZ2UgQSwgd2hlbiBpbnRlcnByZXRlZCBhcyBh
biBsMyBwYWdldGFibGUsIGNvbnRhaW5zIGFsbAp2YWxpZCBlbnRyaWVzOyBh
bmQgc3VwcG9zZSBBW3hdIHBvaW50cyB0byBwYWdlIEIsIHdoaWNoIHdoZW4K
aW50ZXJwcmV0ZWQgYXMgYW4gbDIgcGFnZXRhYmxlLCBjb250YWlucyBhbGwg
dmFsaWQgZW50cmllcy4KClAxOiBQSU5fTDNfVEFCTEUKICBBIC0+IFBHVF9s
M190YWJsZSB8IDEgfCB2YWxpZAogIEIgLT4gUEdUX2wyX3RhYmxlIHwgMSB8
IHZhbGlkCgpQMTogVU5QSU5fVEFCTEUKICA+IEFycmFuZ2UgdG8gaW50ZXJy
dXB0IGFmdGVyIEIgaGFzIGJlZW4gZGUtdmFsaWRhdGVkCiAgQjoKICAgIHR5
cGVfaW5mbyAtPiBQR1RfbDJfdGFibGUgfCAwCiAgQToKICAgIHR5cGVfaW5m
byAtPiBQR1RfbDNfdGFibGUgfCAxIHwgcGFydGlhbAogICAgbnJfdmFsaWRh
dGVkX2VudGllcyAtPiAobGVzcyB0aGFuIHgpCgpQMjogbW9kX2w0X2VudHJ5
IHRvIHBvaW50IHRvIEEKICA+IEFycmFuZ2UgZm9yIHRoaXMgdG8gYmUgaW50
ZXJydXB0ZWQgd2hpbGUgQiBpcyBiZWluZyB2YWxpZGF0ZWQKICBCOgogICAg
dHlwZV9pbmZvIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBwYXJ0aWFsCiAgICAo
bnJfdmFsaWRhdGVkX2VudGlyZXMgJmMgc2V0IGFzIGFwcHJvcHJpYXRlKQog
IEE6CiAgICB0eXBlX2luZm8gLT4gUEdUX2wzX3RhYmxlIHwgMSB8IHBhcnRp
YWwKICAgIG5yX3ZhbGlkYXRlZF9lbnRyaWVzIC0+IHgKICAgIHBhcnRpYWxf
cHRlID0gMQoKUDM6IG1vZF9sM19lbnRyeSBzb21lIG90aGVyIHVucmVsYXRl
ZCBsMyB0byBwb2ludCB0byBCOgogIEI6CiAgICB0eXBlX2luZm8gLT4gUEdU
X2wyX3RhYmxlIHwgMQoKUDE6IFJlc3RhcnQgVU5QSU5fVEFCTEUKCkF0IHRo
aXMgcG9pbnQsIHNpbmNlIEEubnJfdmFsaWRhdGVfZW50cmllcyA9PSB4IGFu
ZCBBLnBhcnRpYWxfcHRlICE9CjAsIGZyZWVfbDNfdGFibGUoKSB3aWxsIGNh
bGwgcHV0X3BhZ2VfZnJvbV9sM2UoKSBvbiBwbDNlW3hdLCBkcm9wcGluZwpp
dHMgdHlwZSBjb3VudCB0byAwIHdoaWxlIGl0J3Mgc3RpbGwgYmVpbmcgcG9p
bnRlZCB0byBieSBzb21lIG90aGVyIGwzCgpBIHNpbWlsYXIgaXNzdWUgYXJp
c2VzIHdpdGggb2xkX2d1ZXN0X3RhYmxlLiAgQ29uc2lkZXIgdGhlIGZvbGxv
d2luZwpzY2VuYXJpbzoKClN1cHBvc2UgQSBpcyBhIHBhZ2Ugd2hpY2gsIHdo
ZW4gaW50ZXJwcmV0ZWQgYXMgYW4gbDIsIGhhcyB2YWxpZCBlbnRyaWVzCnVu
dGlsIGVudHJ5IHgsIHdoaWNoIGlzIGludmFsaWQuCgpWMTogIFBJTl9MMl9U
QUJMRShBKQogIDxWYWxpZGF0ZSB1bnRpbCB3ZSB0cnkgdG8gdmFsaWRhdGUg
W3hdLCBnZXQgLUVJTlZBTD4KICBBIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBQ
R1RfcGFydGlhbAogIFYxIC0+IG9sZF9ndWVzdF90YWJsZSA9IEEKICA8ZGVs
YXllZD4KClYyOiBQSU5fTDJfVEFCTEUoQSkKICA8UGljayB1cCB3aGVyZSBW
MSBsZWZ0IG9mZiwgdHJ5IHRvIHJlLXZhbGlkYXRlIFt4XSwgZ2V0IC1FSU5W
QUw+CiAgQSAtPiBQR1RfbDJfdGFibGUgfCAxIHwgUEdUX3BhcnRpYWwKICBW
MiAtPiBvbGRfZ3Vlc3RfdGFibGUgPSBBCiAgPHJlc3RhcnQ+CiAgcHV0X29s
ZF9ndWVzdF90YWJsZSgpCiAgICBfcHV0X3BhZ2VfdHlwZShBKQogICAgICBB
IC0+IFBHVF9sMl90YWJsZSB8IDAKClYxOiA8cmVzdGFydD4KICBwdXRfb2xk
X2d1ZXN0X3RhYmxlKCkKICAgIF9wdXRfcGFnZV90eXBlKEEpICMgVU5ERVJG
TE9XCgpJbmRlZWQsIGl0IGlzIHBvc3NpYmxlIHRvIGVuZ2luZWVyIGZvciBv
bGRfZ3Vlc3RfdGFibGUgZm9yIGV2ZXJ5IHZjcHUKYSBndWVzdCBoYXMgdG8g
cG9pbnQgdG8gdGhlIHNhbWUgcGFnZS4KLS0tCiB4ZW4vYXJjaC94ODYvZG9t
YWluLmMgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAg
ICAgICAgIHwgOTggKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oIHwgIDQgKy0KIDMg
ZmlsZXMgY2hhbmdlZCwgOTQgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IDFhNGY4OWE2YjEuLjJiMGEwMWQy
NGEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTEzNTAsOSArMTM1MCwxNSBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICAgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0
aHJvdWdoICovCiAgICAgICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6Cisg
ICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICAgICAq
IE5CIHRoYXQgd2UncmUgcHV0dGluZyB0aGUga2VybmVsLW1vZGUgdGFibGUK
KyAgICAgICAgICAgICAgICAgICAgICogaGVyZSwgd2hpY2ggd2UndmUgYWxy
ZWFkeSBzdWNjZXNzZnVsbHkKKyAgICAgICAgICAgICAgICAgICAgICogdmFs
aWRhdGVkIGFib3ZlOyBoZW5jZSBwYXJ0aWFsID0gZmFsc2U7CisgICAgICAg
ICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgICB2LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPQogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZXRhYmxlX2dldF9wYWdlKHYtPmFyY2guZ3Vlc3RfdGFibGUp
OworICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgIHYtPmFy
Y2guZ3Vlc3RfdGFibGUgPSBwYWdldGFibGVfbnVsbCgpOwogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0Ogpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA0YWY4MmQ2NDQ3Li43NGExNDkxYzMzIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTU0MCwxMCArMTU0MCwxMSBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gcHRwZzsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgIH0K
ICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOworICAg
ICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHko
IXJjKSApCiAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAg
ICB9CkBAIC0xNTY2LDYgKzE1NjcsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdl
X2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZu
LAogICAgICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwzZV9nZXRfcGZuKGwz
ZSk7CiAgICAgICAgIGludCB3cml0ZWFibGUgPSBsM2VfZ2V0X2ZsYWdzKGwz
ZSkgJiBfUEFHRV9SVzsKIAorICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBBU1NFUlQoIShtZm4gJiAoKDFV
TCA8PCAoTDNfUEFHRVRBQkxFX1NISUZUIC0gUEFHRV9TSElGVCkpIC0gMSkp
KTsKICAgICAgICAgZG8gewogICAgICAgICAgICAgcHV0X2RhdGFfcGFnZSht
Zm5fdG9fcGFnZShtZm4pLCB3cml0ZWFibGUpOwpAQCAtMTU3OCwxMiArMTU4
MCwxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50
cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgaWYgKCBmbGFn
cyAmIFBURl9kZWZlciApCiAgICAgeworICAgICAgICBBU1NFUlQoIShmbGFn
cyAmIFBURl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UocGZuKTsKICAgICAgICAg
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKKyAgICAgICAg
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IGZhbHNl
OwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAgICByYyA9IF9wdXRf
cGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKHBm
bikpOworICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZsYWdzIHwgUFRG
X3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKICAgICBpZiAoIGxp
a2VseSghcmMpICkKICAgICAgICAgcHV0X3BhZ2UocGcpOwogCkBAIC0xNjAy
LDEyICsxNjA2LDE0IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUo
bDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAKICAgICAg
ICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKKyAgICAg
ICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSk7CiAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZu
X3RvX3BhZ2UocGZuKTsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAg
ICByZXR1cm4gMDsKICAgICAgICAgfQogCi0gICAgICAgIHJjID0gX3B1dF9w
YWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UocGZu
KSk7CisgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZsYWdzIHwg
UFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShwZm4pKTsKICAgICAgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAgICAgICBwdXRfcGFnZShwZyk7
CiAgICAgfQpAQCAtMTcxNSw2ICsxNzIxLDE0IEBAIHN0YXRpYyBpbnQgYWxs
b2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQg
bG9uZyB0eXBlKQogCiAgICAgcGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZu
KHBmbikpOwogCisgICAgLyoKKyAgICAgKiBOQiB0aGF0IGFsbG9jX2wyX3Rh
YmxlIHdpbGwgbmV2ZXIgc2V0IHBhcnRpYWxfcHRlIG9uIGFuIGwyOyBidXQK
KyAgICAgKiBmcmVlX2wyX3RhYmxlIG1pZ2h0IGlmIGEgbGluZWFyX3BhZ2V0
YWJsZSBlbnRyeSBpcyBpbnRlcnJ1cHRlZAorICAgICAqIHBhcnR3YXkgdGhy
b3VnaCBkZS12YWxpZGF0aW9uLiAgSW4gdGhhdCBjaXJjdW1zdGFuY2UsCisg
ICAgICogZ2V0X3BhZ2VfZnJvbV9sMmUoKSB3aWxsIGFsd2F5cyByZXR1cm4g
LUVJTlZBTDsgYW5kIHdlIG11c3QKKyAgICAgKiByZXRhaW4gdGhlIHR5cGUg
cmVmIGJ5IGRvaW5nIHRoZSBub3JtYWwgcGFydGlhbF9mbGFncyB0cmFja2lu
Zy4KKyAgICAgKi8KKwogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlczsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTOwogICAgICAgICAg
IGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQogICAgIHsKQEAgLTE3NjksNiAr
MTc4Myw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgICAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzOwog
ICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcg
PSBOVUxMOwogICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1
ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgICAgICBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gdHJ1ZTsKICAgICAgICAg
ICAgIH0KICAgICAgICAgfQogICAgICAgICBpZiAoIHJjIDwgMCApCkBAIC0x
ODgyLDEyICsxODk3LDE2IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUo
c3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICAgKiBi
dWlsZHMuCiAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAg
aWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBsM2VfZ2V0
X3BhZ2UobDNlKSApCisgICAgICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgICAgICBBU1NFUlQoY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVf
cGFydGlhbCk7CiAgICAgICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxf
ZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CisgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgQVNT
RVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsK
KyAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3Bh
cnRpYWwgPSB0cnVlOwogICAgICAgICB9CiAgICAgICAgIHdoaWxlICggaS0t
ID4gMCApCiAgICAgICAgIHsKQEAgLTE5OTUsMTIgKzIwMTQsMTYgQEAgc3Rh
dGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogICAgICAgICAgICAgICAgICAgICAgICAgICogYnVpbGRzLgogICAgICAg
ICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAoIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IGw0ZV9n
ZXRfcGFnZShwbDRlW2ldKSApCisgICAgICAgICAgICAgICAgICAgICAgICB7
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVNTRVJUKGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwpOwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFy
dGlhbF9zZXQ7CisgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAg
ICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlh
bCA9IHRydWU7CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgfQog
ICAgICAgICB9CkBAIC0yOTQyLDYgKzI5NjUsMjggQEAgc3RhdGljIGludCBf
cHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25l
ZCBpbnQgZmxhZ3MsCiAgICAgICAgIHggID0geTsKICAgICAgICAgbnggPSB4
IC0gMTsKIAorICAgICAgICAvKgorICAgICAgICAgKiBJcyB0aGlzIGV4cGVj
dGVkIHRvIGRvIGEgZnVsbCByZWZlcmVuY2UgZHJvcCwgb3Igb25seQorICAg
ICAgICAgKiBjbGVhbnVwIHBhcnRpYWwgdmFsaWRhdGlvbiAvIGRldmFsaWRh
dGlvbj8KKyAgICAgICAgICoKKyAgICAgICAgICogSWYgdGhlIGZvcm1lciwg
dGhlIGNhbGxlciBtdXN0IGhvbGQgYSAiZnVsbCIgdHlwZSByZWY7CisgICAg
ICAgICAqIHdoaWNoIG1lYW5zIHRoZSBwYWdlIG11c3QgYmUgdmFsaWRhdGVk
LiAgSWYgdGhlIHBhZ2UgaXMKKyAgICAgICAgICogKm5vdCogZnVsbHkgdmFs
aWRhdGVkLCBjb250aW51aW5nIHdvdWxkIGFsbW9zdCBjZXJ0YWlubHkKKyAg
ICAgICAgICogb3BlbiB1cCBhIHNlY3VyaXR5IGhvbGUuICBBbiBleGNlcHRp
b24gdG8gdGhpcyBpcyBkdXJpbmcKKyAgICAgICAgICogZG9tYWluIGRlc3Ry
dWN0aW9uLCB3aGVyZSBQR1RfdmFsaWRhdGVkIGNhbiBiZSBkcm9wcGVkCisg
ICAgICAgICAqIHdpdGhvdXQgZHJvcHBpbmcgYSB0eXBlIHJlZi4KKyAgICAg
ICAgICoKKyAgICAgICAgICogSWYgdGhlIGxhdHRlciwgZG8gbm90aGluZyB1
bmxlc3MgdHlwZSBQR1RfcGFydGlhbCBpcyBzZXQuCisgICAgICAgICAqIElm
IGl0IGlzIHNldCwgdGhlIHR5cGUgY291bnQgbXVzdCBiZSAxLgorICAgICAg
ICAgKi8KKyAgICAgICAgaWYgKCAhKGZsYWdzICYgUFRGX3BhcnRpYWxfc2V0
KSApCisgICAgICAgICAgICBCVUdfT04oKHggJiBQR1RfcGFydGlhbCkgfHwK
KyAgICAgICAgICAgICAgICAgICAhKCh4ICYgUEdUX3ZhbGlkYXRlZCkgfHwg
cGFnZV9nZXRfb3duZXIocGFnZSktPmlzX2R5aW5nKSk7CisgICAgICAgIGVs
c2UgaWYgKCAhKHggJiBQR1RfcGFydGlhbCkgKQorICAgICAgICAgICAgcmV0
dXJuIDA7CisgICAgICAgIGVsc2UKKyAgICAgICAgICAgIEJVR19PTigoeCAm
IFBHVF9jb3VudF9tYXNrKSAhPSAxKTsKKwogICAgICAgICBBU1NFUlQoKHgg
JiBQR1RfY291bnRfbWFzaykgIT0gMCk7CiAKICAgICAgICAgaWYgKCB1bmxp
a2VseSgobnggJiBQR1RfY291bnRfbWFzaykgPT0gMCkgKQpAQCAtMzM4OCwx
NyArMzQzMywzNCBAQCBpbnQgcHV0X29sZF9ndWVzdF90YWJsZShzdHJ1Y3Qg
dmNwdSAqdikKICAgICBpZiAoICF2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSAp
CiAgICAgICAgIHJldHVybiAwOwogCi0gICAgc3dpdGNoICggcmMgPSBfcHV0
X3BhZ2VfdHlwZSh2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSwgUFRGX3ByZWVt
cHRpYmxlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi0+
YXJjaC5vbGRfZ3Vlc3RfcHRwZykgKQorICAgIHJjID0gX3B1dF9wYWdlX3R5
cGUodi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUsCisgICAgICAgICAgICAgICAg
ICAgICAgICBQVEZfcHJlZW1wdGlibGUgfAorICAgICAgICAgICAgICAgICAg
ICAgICAgKCB2LT5hcmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID8KKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0IDogMCAp
LAorICAgICAgICAgICAgICAgICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3Rf
cHRwZyk7CisKKyAgICBpZiAoIHJjID09IC1FUkVTVEFSVCB8fCByYyA9PSAt
RUlOVFIgKQogICAgIHsKLSAgICBjYXNlIC1FSU5UUjoKLSAgICBjYXNlIC1F
UkVTVEFSVDoKKyAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbCA9IChyYyA9PSAtRVJFU1RBUlQpOwogICAgICAgICByZXR1cm4gLUVS
RVNUQVJUOwotICAgIGNhc2UgMDoKLSAgICAgICAgcHV0X3BhZ2Uodi0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUpOwogICAgIH0KIAorICAgIC8qCisgICAgICog
SXQgc2hvdWxkbid0IGJlIHBvc3NpYmxlIGZvciBfcHV0X3BhZ2VfdHlwZSgp
IHRvIHJldHVybgorICAgICAqIGFueXRoaW5nIGVsc2UgYXQgdGhlIG1vbWVu
dDsgYnV0IGlmIGl0IGRvZXMgaGFwcGVuIGluCisgICAgICogcHJvZHVjdGlv
biwgbGVha2luZyB0aGUgdHlwZSByZWYgaXMgcHJvYmFibHkgdGhlIGJlc3Qg
dGhpbmcgdG8KKyAgICAgKiBkby4gIEVpdGhlciB3YXksIGRyb3AgdGhlIGdl
bmVyYWwgcmVmIGhlbGQgYnkgb2xkX2d1ZXN0X3RhYmxlLgorICAgICAqLwor
ICAgIEFTU0VSVChyYyA9PSAwKTsKKworICAgIHB1dF9wYWdlKHYtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlKTsKICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZSA9IE5VTEw7CisgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7
CisgICAgLyoKKyAgICAgKiBTYWZlc3QgZGVmYXVsdCBpZiBzb21lb25lIHNl
dHMgb2xkX2d1ZXN0X3RhYmxlIHdpdGhvdXQKKyAgICAgKiBleHBsaWNpdGx5
IHNldHRpbmcgb2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwuCisgICAgICovCisg
ICAgdi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IHRydWU7CiAK
ICAgICByZXR1cm4gcmM7CiB9CkBAIC0zNTUzLDExICszNjE1LDExIEBAIGlu
dCBuZXdfZ3Vlc3RfY3IzKHVuc2lnbmVkIGxvbmcgbWZuKQogICAgICAgICAg
ICAgc3dpdGNoICggcmMgPSBwdXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJs
ZShwYWdlKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICBjYXNlIC1F
SU5UUjoKLSAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKLSAgICAg
ICAgICAgICAgICAvKiBmYWxsdGhyb3VnaCAqLwogICAgICAgICAgICAgY2Fz
ZSAtRVJFU1RBUlQ6CiAgICAgICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgY3Vyci0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOworICAgICAgICAgICAgICAgIGN1
cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSAocmMgPT0gLUVS
RVNUQVJUKTsKKyAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAg
ICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgIGRlZmF1bHQ6CiAg
ICAgICAgICAgICAgICAgQlVHX09OKHJjKTsKQEAgLTM4MjgsNiArMzg5MCw3
IEBAIGxvbmcgZG9fbW11ZXh0X29wKAogICAgICAgICAgICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnIt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgICAg
ICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwg
PSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgIH0KQEAgLTM4NjYsNiArMzkyOSwxMSBAQCBs
b25nIGRvX21tdWV4dF9vcCgKICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJU
OgogICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcg
PSBOVUxMOwogICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0
X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgICAgICAvKgorICAgICAgICAg
ICAgICAgICAqIEVJTlRSIG1lYW5zIHdlIHN0aWxsIGhvbGQgdGhlIHR5cGUg
cmVmOyBFUkVTVEFSVAorICAgICAgICAgICAgICAgICAqIG1lYW5zIFBHVF9w
YXJ0aWFsIGhvbGRzIHRoZSB0eXBlIHJlZgorICAgICAgICAgICAgICAgICAq
LworICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxl
X3BhcnRpYWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKICAgICAgICAgICAgICAg
ICByYyA9IDA7CiAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg
ICBkZWZhdWx0OgpAQCAtMzk0MSwxMSArNDAwOSwxNSBAQCBsb25nIGRvX21t
dWV4dF9vcCgKICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICggcmMgPSBw
dXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJsZShwYWdlKSApCiAgICAgICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgY2FzZSAtRUlO
VFI6Ci0gICAgICAgICAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsK
LSAgICAgICAgICAgICAgICAgICAgICAgIC8qIGZhbGx0aHJvdWdoICovCiAg
ICAgICAgICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJUOgogICAgICAgICAg
ICAgICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5V
TEw7CiAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICAgICAgICAgICAgICAv
KgorICAgICAgICAgICAgICAgICAgICAgICAgICogRUlOVFIgbWVhbnMgd2Ug
c3RpbGwgaG9sZCB0aGUgdHlwZSByZWY7CisgICAgICAgICAgICAgICAgICAg
ICAgICAgKiBFUkVTVEFSVCBtZWFucyBQR1RfcGFydGlhbCBob2xkcyB0aGUg
cmVmCisgICAgICAgICAgICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAg
ICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRp
YWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKKyAgICAgICAgICAgICAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICAgICAgICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg
ICAgICAgICAgICAgICAgICBCVUdfT04ocmMpOwpkaWZmIC0tZ2l0IGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvZG9tYWluLmgKaW5kZXggN2VhNjc1MzJkZC4uYTBmZTM2MWQ1ZSAxMDA2
NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaAorKysgYi94
ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oCkBAIC0zMzgsNyArMzM4LDcg
QEAgc3RydWN0IGFyY2hfZG9tYWluCiAKICAgICBzdHJ1Y3QgcGFnaW5nX2Rv
bWFpbiBwYWdpbmc7CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybTsKLSAg
ICAvKiBUbyBlbmZvcmNlIGxvY2sgb3JkZXJpbmcgaW4gdGhlIHBvZCBjb2Rl
IHdydCB0aGUgCisgICAgLyogVG8gZW5mb3JjZSBsb2NrIG9yZGVyaW5nIGlu
IHRoZSBwb2QgY29kZSB3cnQgdGhlCiAgICAgICogcGFnZV9hbGxvYyBsb2Nr
ICovCiAgICAgaW50IHBhZ2VfYWxsb2NfdW5sb2NrX2xldmVsOwogCkBAIC01
NzIsNiArNTcyLDggQEAgc3RydWN0IGFyY2hfdmNwdQogICAgIHN0cnVjdCBw
YWdlX2luZm8gKm9sZF9ndWVzdF90YWJsZTsgIC8qIHBhcnRpYWxseSBkZXN0
cnVjdGVkIHBhZ2V0YWJsZSAqLwogICAgIHN0cnVjdCBwYWdlX2luZm8gKm9s
ZF9ndWVzdF9wdHBnOyAgIC8qIGNvbnRhaW5pbmcgcGFnZSB0YWJsZSBvZiB0
aGUgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAvKiBmb3JtZXIsIGlmIGFueSAqLworICAgIGJvb2wgb2xkX2d1ZXN0X3Rh
YmxlX3BhcnRpYWw7ICAgICAgIC8qIEFyZSB3ZSBkcm9wcGluZyBhIHR5cGUg
cmVmLCBvciBqdXN0CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICogZmluaXNoaW5nIHVwIGEgcGFydGlhbCBkZS12YWxpZGF0
aW9uPyAqLwogICAgIC8qIGd1ZXN0X3RhYmxlIGhvbGRzIGEgcmVmIHRvIHRo
ZSBwYWdlLCBhbmQgYWxzbyBhIHR5cGUtY291bnQgdW5sZXNzCiAgICAgICog
c2hhZG93IHJlZmNvdW50cyBhcmUgaW4gdXNlICovCiAgICAgcGFnZXRhYmxl
X3Qgc2hhZG93X3RhYmxlWzRdOyAgICAgICAgLyogKE1GTikgc2hhZG93KHMp
IG9mIGd1ZXN0ICovCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Transfer-Encoding: base64

RnJvbSBiYzI2NmE2OGFhMDE0YWYyY2MzZWQwYTFmNTU3MjNmZGVhYzJlNTQ1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAxLzExXSB4
ODYvbW06IEwxVEYgY2hlY2tzIGRvbid0IGxlYXZlIGEgcGFydGlhbCBlbnRy
eQoKT24gZGV0ZWN0aW9uIG9mIGEgcG90ZW50aWFsIEwxVEYgaXNzdWUsIG1v
c3QgdmFsaWRhdGlvbiBjb2RlIHJldHVybnMKLUVSRVNUQVJUIHRvIGFsbG93
IHRoZSBzd2l0Y2ggdG8gc2hhZG93IG1vZGUgdG8gaGFwcGVuIGFuZCBjYXVz
ZSB0aGUKb3JpZ2luYWwgb3BlcmF0aW9uIHRvIGJlIHJlc3RhcnRlZC4KCkhv
d2V2ZXIsIGluIHRoZSB2YWxpZGF0aW9uIGNvZGUsIHRoZSByZXR1cm4gdmFs
dWUgLUVSRVNUQVJUIGhhcyBiZWVuCnJlcHVycG9zZWQgdG8gaW5kaWNhdGUg
MSkgdGhlIGZ1bmN0aW9uIGhhcyBwYXJ0aWFsbHkgY29tcGxldGVkCnNvbWV0
aGluZyB3aGljaCBuZWVkcyB0byBiZSB1bmRvbmUsIGFuZCAyKSBjYWxsaW5n
IHB1dF9wYWdlX3R5cGUoKQpzaG91bGQgY2xlYW5seSB1bmRvIGl0LiAgVGhp
cyBjYXVzZXMgcHJvYmxlbXMgaW4gc2V2ZXJhbCBwbGFjZXMuCgpGb3IgTDEg
dGFibGVzLCBvbiByZWNlaXZpbmcgYW4gLUVSRVNUQVJUIHJldHVybiBmcm9t
IGFsbG9jX2wxX3RhYmxlKCksCmFsbG9jX3BhZ2VfdHlwZSgpIHdpbGwgc2V0
IFBHVF9wYXJ0aWFsIG9uIHRoZSBwYWdlLiAgSWYgZm9yIHNvbWUKcmVhc29u
IHRoZSBvcmlnaW5hbCBvcGVyYXRpb24gbmV2ZXIgcmVzdGFydHMsIHRoZW4g
b24gZG9tYWluCmRlc3RydWN0aW9uLCByZWxpbnF1aXNoX21lbW9yeSgpIHdp
bGwgY2FsbCBmcmVlX3BhZ2VfdHlwZSgpIG9uIHRoZQpwYWdlLgoKVW5mb3J0
dW5hdGVseSwgYWxsb2NfIGFuZCBmcmVlX2wxX3RhYmxlKCkgYXJlbid0IHNl
dCB1cCB0byBkZWFsIHdpdGgKUEdUX3BhcnRpYWwuICBXaGVuIHJldHVybmlu
ZyBhIGZhaWx1cmUsIGFsbG9jX2wxX3RhYmxlKCkgYWx3YXlzCmRlLXZhbGlk
YXRlcyB3aGF0ZXZlciBpdCdzIHZhbGlkYXRlZCBzbyBmYXIsIGFuZCBmcmVl
X2wxX3RhYmxlKCkKYWx3YXlzIGRldmFsaWRhdGVzIHRoZSB3aG9sZSBwYWdl
LiAgVGhpcyBtZWFucyB0aGF0IGlmCnJlbGlucXVpc2hfbWVtb3J5KCkgY2Fs
bHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBhbiBMMSB0aGF0IGRpZG4ndApjb21w
bGV0ZSBkdWUgdG8gYW4gTDFURiwgaXQgd2lsbCBjYWxsIHB1dF9wYWdlX2Zy
b21fbDFlKCkgb24gInBhZ2UKZW50cmllcyIgdGhhdCBoYXZlIG5ldmVyIGJl
ZW4gdmFsaWRhdGVkLgoKRm9yIEwyKyB0YWJsZXMsIHNldHRpbmcgcmMgdG8g
RVJFU1RBUlQgY2F1c2VzIHRoZSByZXN0IG9mIHRoZQphbGxvY19sTl90YWJs
ZSgpIGZ1bmN0aW9uIHRvICp0aGluayogdGhhdCB0aGUgZW50cnkgaW4gcXVl
c3Rpb24gd2lsbApoYXZlIFBHVF9wYXJ0aWFsIHNldC4gIFRoaXMgd2lsbCBj
YXVzZSBpdCB0byBzZXQgcGFydGlhbF9wdGUgPSAxLiAgSWYKcmVsaW5xdXNo
X21lbW9yeSgpIHRoZW4gY2FsbHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBvbmUg
b2YgdGhvc2UgcGFnZXMsCnRoZW4gZnJlZV9sTl90YWJsZSgpIHdpbGwgY2Fs
bCBwdXRfcGFnZV9mcm9tX2xOZSgpIG9uIHRoZSBlbnRyeSB3aGVuCml0IHNo
b3VsZG4ndC4KClJhdGhlciB0aGFuIGluZGljYXRpbmcgLUVSRVNUQVJULCBp
bmRpY2F0ZSAtRUlOVFIuICBUaGlzIGlzIHRoZSBjb2RlCnRvIGluZGljYXRl
IHRoYXQgbm90aGluZyBoYXMgY2hhbmdlZCBmcm9tIHdoZW4geW91IHN0YXJ0
ZWQgdGhlIGNhbGwKKHdoaWNoIGlzIGVmZmVjdGl2ZWx5IGhvdyBhbGxvY19s
MV90YWJsZSgpIGhhbmRsZXMgZXJyb3JzKS4KCm1vZF9sTl9lbnRyeSgpIHNo
b3VsZG4ndCBoYXZlIGFueSBvZiB0aGVzZSB0eXBlcyBvZiBwcm9ibGVtcywg
c28gbGVhdmUKcG90ZW50aWFsIGNoYW5nZXMgdGhlcmUgZm9yIGEgY2xlYW4t
dXAgcGF0Y2ggbGF0ZXIuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJl
cG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5k
dW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDgg
KysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBjZTJjMDgyY2FmLi4wY2JjYTQ4
YTAyIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTE1Miw3ICsxMTUyLDcgQEAgZ2V0X3BhZ2Vf
ZnJvbV9sMmUoCiAgICAgaW50IHJjOwogCiAgICAgaWYgKCAhKGwyZV9nZXRf
ZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKLSAgICAgICAgcmV0dXJu
IHB2X2wxdGZfY2hlY2tfbDJlKGQsIGwyZSkgPyAtRVJFU1RBUlQgOiAxOwor
ICAgICAgICByZXR1cm4gcHZfbDF0Zl9jaGVja19sMmUoZCwgbDJlKSA/IC1F
SU5UUiA6IDE7CiAKICAgICBpZiAoIHVubGlrZWx5KChsMmVfZ2V0X2ZsYWdz
KGwyZSkgJiBMMl9ESVNBTExPV19NQVNLKSkgKQogICAgIHsKQEAgLTExODgs
NyArMTE4OCw3IEBAIGdldF9wYWdlX2Zyb21fbDNlKAogICAgIGludCByYzsK
IAogICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QUkVT
RU5UKSApCi0gICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2wzZShkLCBs
M2UpID8gLUVSRVNUQVJUIDogMTsKKyAgICAgICAgcmV0dXJuIHB2X2wxdGZf
Y2hlY2tfbDNlKGQsIGwzZSkgPyAtRUlOVFIgOiAxOwogCiAgICAgaWYgKCB1
bmxpa2VseSgobDNlX2dldF9mbGFncyhsM2UpICYgbDNfZGlzYWxsb3dfbWFz
ayhkKSkpICkKICAgICB7CkBAIC0xMjIxLDcgKzEyMjEsNyBAQCBnZXRfcGFn
ZV9mcm9tX2w0ZSgKICAgICBpbnQgcmM7CiAKICAgICBpZiAoICEobDRlX2dl
dF9mbGFncyhsNGUpICYgX1BBR0VfUFJFU0VOVCkgKQotICAgICAgICByZXR1
cm4gcHZfbDF0Zl9jaGVja19sNGUoZCwgbDRlKSA/IC1FUkVTVEFSVCA6IDE7
CisgICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2w0ZShkLCBsNGUpID8g
LUVJTlRSIDogMTsKIAogICAgIGlmICggdW5saWtlbHkoKGw0ZV9nZXRfZmxh
Z3MobDRlKSAmIEw0X0RJU0FMTE9XX01BU0spKSApCiAgICAgewpAQCAtMTQz
NSw3ICsxNDM1LDcgQEAgc3RhdGljIGludCBhbGxvY19sMV90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHsKICAgICAgICAgaWYgKCAhKGwx
ZV9nZXRfZmxhZ3MocGwxZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIHJldCA9IHB2X2wxdGZfY2hlY2tfbDFlKGQs
IHBsMWVbaV0pID8gLUVSRVNUQVJUIDogMDsKKyAgICAgICAgICAgIHJldCA9
IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBsMWVbaV0pID8gLUVJTlRSIDogMDsK
ICAgICAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgICAgICBnb3Rv
IG91dDsKICAgICAgICAgfQotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Transfer-Encoding: base64

RnJvbSBmZDdiZmU5YWFlZTQxYzU4OWMxNmM1NDFlYzUzODI4NWRjZGUxZmIy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAyLzExXSB4
ODYvbW06IERvbid0IHJlLXNldCBQR1RfcGlubmVkIG9uIGEgcGFydGlhbGx5
CiBkZS12YWxpZGF0ZWQgcGFnZQoKV2hlbiB1bnBpbm5pbmcgcGFnZXRhYmxl
cywgaWYgYW4gb3BlcmF0aW9uIGlzIGludGVycnVwdGVkLApyZWxpbnF1aXNo
X21lbW9yeSgpIHJlLXNldHMgUEdUX3Bpbm5lZCBzbyB0aGF0IHRoZSB1bi1w
aW4gd2lsbApwaWNrZWR1cCBhZ2FpbiB3aGVuIHRoZSBoeXBlcmNhbGwgcmVz
dGFydHMuCgpUaGlzIGlzIGFwcHJvcHJpYXRlIHdoZW4gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKSByZXR1cm5zCi1FSU5UUiwgd2hpY2ggaW5k
aWNhdGVzIHRoYXQgdGhlIHBhZ2UgaXMgYmFjayBpbiBpdHMgaW5pdGlhbCBz
dGF0ZQooaS5lLiwgY29tcGxldGVseSB2YWxpZGF0ZWQpLiAgSG93ZXZlciwg
Zm9yIC1FUkVTVEFSVCwgdGhpcyBsZWFkcyB0byBhCnN0YXRlIHdoZXJlIGEg
cGFnZSBoYXMgYm90aCBQR1RfcGlubmVkIGFuZCBQR1RfcGFydGlhbCBzZXQu
CgpUaGlzIGhhcHBlbnMgdG8gd29yayBhdCB0aGUgbW9tZW50LCBhbHRob3Vn
aCBpdCdzIG5vdCByZWFsbHkgYQoiY2Fub25pY2FsIiBzdGF0ZTsgYnV0IGlu
IHN1YnNlcXVlbnQgcGF0Y2hlcywgd2hlcmUgd2UgbmVlZCB0byBtYWtlIGEK
ZGlzdGluY3Rpb24gaW4gaGFuZGxpbmcgYmV0d2VlbiBQR1RfdmFsaWRhdGVk
IGFuZCBQR1RfcGFydGlhbCBwYWdlcywKdGhpcyBjYXVzZXMgaXNzdWVzLgoK
TW92ZSB0byBhICJjYW5vbmljYWwiIHN0YXRlIGJ5OgotIE9ubHkgcmUtc2V0
dGluZyBQR1RfcGlubmVkIG9uIC1FSU5UUgotIFJlLWRyb3BwaW5nIHRoZSBy
ZWZjb3VudCBoZWxkIGJ5IFBHVF9waW5uZWQgb24gLUVSRVNUQVJUCgpJbiB0
aGUgbGF0dGVyIGNhc2UsIHRoZSBQR1RfcGFydGlhbCBiaXQgd2lsbCBiZSBj
bGVhcmVkIGZ1cnRoZXIgZG93bgp3aXRoIHRoZSByZXN0IG9mIHRoZSBvdGhl
ciBQR1RfcGFydGlhbCBwYWdlcy4KCldoaWxlIGhlcmUsIGNsZWFuIHVwIHNv
bWUgdHJhaW5saW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVu
bGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tYWluLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggOTFjMmIxYzIxYS4uODk3MTI0
ZjA1ZiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTEyLDcgKzExMiw3IEBAIHN0
YXRpYyB2b2lkIHBsYXlfZGVhZCh2b2lkKQogICAgICAqIHRoaXMgY2FzZSwg
aGVhcCBjb3JydXB0aW9uIG9yICNQRiBjYW4gb2NjdXIgKHdoZW4gaGVhcCBk
ZWJ1Z2dpbmcgaXMKICAgICAgKiBlbmFibGVkKS4gRm9yIGV4YW1wbGUsIGV2
ZW4gcHJpbnRrKCkgY2FuIGludm9sdmUgdGFza2xldCBzY2hlZHVsaW5nLAog
ICAgICAqIHdoaWNoIHRvdWNoZXMgcGVyLWNwdSB2YXJzLgotICAgICAqIAor
ICAgICAqCiAgICAgICogQ29uc2lkZXIgdmVyeSBjYXJlZnVsbHkgd2hlbiBh
ZGRpbmcgY29kZSB0byAqZGVhZF9pZGxlLiBNb3N0IGh5cGVydmlzb3IKICAg
ICAgKiBzdWJzeXN0ZW1zIGFyZSB1bnNhZmUgdG8gY2FsbC4KICAgICAgKi8K
QEAgLTE4MzcsOSArMTgzNywzNCBAQCBzdGF0aWMgaW50IHJlbGlucXVpc2hf
bWVtb3J5KAogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLUVS
RVNUQVJUOgogICAgICAgICBjYXNlIC1FSU5UUjoKKyAgICAgICAgICAgIC8q
CisgICAgICAgICAgICAgKiAtRUlOVFIgbWVhbnMgUEdUX3ZhbGlkYXRlZCBo
YXMgYmVlbiByZS1zZXQ7IHJlLXNldAorICAgICAgICAgICAgICogUEdUX3Bp
bm5lZCBhZ2FpbiBzbyB0aGF0IGl0IGdldHMgcGlja2VkIHVwIG5leHQgdGlt
ZQorICAgICAgICAgICAgICogYXJvdW5kLgorICAgICAgICAgICAgICoKKyAg
ICAgICAgICAgICAqIC1FUkVTVEFSVCwgT1RPSCwgbWVhbnMgUEdUX3BhcnRp
YWwgaXMgc2V0IGluc3RlYWQuICBQdXQKKyAgICAgICAgICAgICAqIGl0IGJh
Y2sgb24gdGhlIGxpc3QsIGJ1dCBkb24ndCBzZXQgUEdUX3Bpbm5lZDsgdGhl
CisgICAgICAgICAgICAgKiBzZWN0aW9uIGJlbG93IHdpbGwgZmluaXNoIG9m
ZiBkZS12YWxpZGF0aW9uLiAgQnV0IHdlIGRvCisgICAgICAgICAgICAgKiBu
ZWVkIHRvIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGFzc29jaWF0ZWQgd2l0aAor
ICAgICAgICAgICAgICogUEdUX3Bpbm5lZCwgc2luY2UgcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKQorICAgICAgICAgICAgICogZGlkbid0IGRv
IGl0LgorICAgICAgICAgICAgICoKKyAgICAgICAgICAgICAqIE5CIHdlIGNh
biBkbyBhbiBBU1NFUlQgZm9yIFBHVF92YWxpZGF0ZWQsIHNpbmNlIHdlCisg
ICAgICAgICAgICAgKiAib3duIiB0aGUgdHlwZSByZWY7IGJ1dCB0aGVvcmV0
aWNhbGx5LCB0aGUgUEdUX3BhcnRpYWwKKyAgICAgICAgICAgICAqIGNvdWxk
IGJlIGNsZWFyZWQgYnkgc29tZW9uZSBlbHNlLgorICAgICAgICAgICAgICov
CisgICAgICAgICAgICBpZiAoIHJldCA9PSAtRUlOVFIgKQorICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIEFTU0VSVChwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmIFBHVF92YWxpZGF0ZWQpOworICAgICAgICAgICAgICAgIHNl
dF9iaXQoX1BHVF9waW5uZWQsICZwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICBlbHNlCisgICAgICAgICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CisKICAgICAgICAgICAgIHJldCA9IC1F
UkVTVEFSVDsKKworICAgICAgICAgICAgLyogUHV0IHRoZSBwYWdlIGJhY2sg
b24gdGhlIGxpc3QgYW5kIGRyb3AgdGhlIHJlZiB3ZSBncmFiYmVkIGFib3Zl
ICovCiAgICAgICAgICAgICBwYWdlX2xpc3RfYWRkKHBhZ2UsIGxpc3QpOwot
ICAgICAgICAgICAgc2V0X2JpdChfUEdUX3Bpbm5lZCwgJnBhZ2UtPnUuaW51
c2UudHlwZV9pbmZvKTsKICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwog
ICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIGRlZmF1bHQ6CkBAIC0y
MDYxLDcgKzIwODYsNyBAQCB2b2lkIHZjcHVfa2ljayhzdHJ1Y3QgdmNwdSAq
dikKICAgICAgKiBwZW5kaW5nIGZsYWcuIFRoZXNlIHZhbHVlcyBtYXkgZmx1
Y3R1YXRlIChhZnRlciBhbGwsIHdlIGhvbGQgbm8KICAgICAgKiBsb2Nrcykg
YnV0IHRoZSBrZXkgaW5zaWdodCBpcyB0aGF0IGVhY2ggY2hhbmdlIHdpbGwg
Y2F1c2UKICAgICAgKiBldnRjaG5fdXBjYWxsX3BlbmRpbmcgdG8gYmUgcG9s
bGVkLgotICAgICAqIAorICAgICAqCiAgICAgICogTkIyLiBXZSBzYXZlIHRo
ZSBydW5uaW5nIGZsYWcgYWNyb3NzIHRoZSB1bmJsb2NrIHRvIGF2b2lkIGEg
bmVlZGxlc3MKICAgICAgKiBJUEkgZm9yIGRvbWFpbnMgdGhhdCB3ZSBJUEkn
ZCB0byB1bmJsb2NrLgogICAgICAqLwotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Transfer-Encoding: base64

RnJvbSA2YmFkMDljNzA4ZDkwNjkyMmZiNTlkN2UyYzA2ZDVkZTlhNjMzY2Ez
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAzLzExXSB4
ODYvbW06IFNlcGFyYXRlIG91dCBwYXJ0aWFsX3B0ZSB0cmlzdGF0ZSBpbnRv
CiBpbmRpdmlkdWFsIGZsYWdzCgpBdCB0aGUgbW9tZW50LCBwYXJ0aWFsX3B0
ZSBpcyBhIHRyaS1zdGF0ZSB0aGF0IGNvbnRhaW5zIHR3byBkaXN0aW5jdCBi
aXRzCm9mIGluZm9ybWF0aW9uOgoKMS4gSWYgemVybywgdGhlIHB0ZSBhdCBp
bmRleCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHVuLXZhbGlkYXRlZC4gIElm
CiAgIG5vbi16ZXJvLCB0aGUgcHRlIHdhcyBsYXN0IHNlZW4gd2l0aCBQR1Rf
cGFydGlhbCBzZXQuCgoyLiBJZiBwb3NpdGl2ZSwgdGhlIHB0ZSBhdCBpbmRl
eCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGRvZXMgbm90IGhvbGQgYQogICBnZW5l
cmFsIHJlZmVyZW5jZSBjb3VudC4gIElmIG5lZ2F0aXZlLCBpdCBkb2VzLgoK
VG8gbWFrZSBmdXR1cmUgcGF0Y2hlcyBtb3JlIGNsZWFyLCBzZXBhcmF0ZSBv
dXQgdGhpcyBmdW5jdGlvbmFsaXR5CmludG8gdHdvIGRpc3RpbmN0LCBuYW1l
ZCBiaXRzOiBQVEZfcGFydGlhbF9zZXQgKGZvciAjMSkgYW5kClBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIChmb3IgIzIpLgoKQWRkaXRpb25hbGx5LCBhIG51
bWJlciBvZiBmdW5jdGlvbnMgd2hpY2ggbmVlZCB0aGlzIGluZm9ybWF0aW9u
IGFsc28KdGFrZSBvdGhlciBmbGFncyB0byBjb250cm9sIGJlaGF2aW9yIChz
dWNoIGFzIGBwcmVlbXB0aWJsZWAgYW5kCmBkZWZlcmApLiAgVGhlc2UgYXJl
IGhhcmQgdG8gcmVhZCBpbiB0aGUgY2FsbGVyIChzaW5jZSB5b3Ugb25seSBz
ZWUKJ3RydWUnIG9yICdmYWxzZScpLCBhbmQgdWdseSB3aGVuIG1hbnkgYXJl
IGFkZGVkIHRvZ2V0aGVyLiAgSW4KcHJlcGFyYXRpb24gZm9yIGFkZGluZyB5
ZXQgYW5vdGhlciBmbGFnIGluIGEgZnV0dXJlIHBhdGNoLCBjb2xsYXBzZQph
bGwgb2YgdGhlc2UgaW50byBhIHNpbmdsZSBgZmxhZ2AgdmFyaWFibGUuCgpO
QiB0aGF0IHRoaXMgZG9lcyBtZWFuIGNoZWNraW5nIGZvciB3aGF0IHdhcyBw
cmV2aW91c2x5IHRoZSAnLTEnCmNvbmRpdGlvbiBhIGJpdCBtb3JlIHVnbHkg
aW4gdGhlIHB1dF9wYWdlX2Zyb21fbE5lIGZ1bmN0aW9ucyAoc2luY2UKeW91
IGhhdmUgdG8gY2hlY2sgZm9yIGJvdGggcGFydGlhbF9zZXQgYW5kIGdlbmVy
YWwgcmVmKTsgYnV0IHRoaXMKY2xhdXNlIHdpbGwgZ28gYXdheSBpbiBhIGZ1
dHVyZSBwYXRjaC4KCkFsc28gbm90ZSB0aGF0IHRoZSBvcmlnaW5hbCBjb21t
ZW50IGhhZCBhbiBvZmYtYnktb25lIGVycm9yOgpwYXJ0aWFsX2ZsYWdzIChs
aWtlIHBhcnRpYWxfcHRlIGJlZm9yZSBpdCkgY29uY2VybnMKcGxOZVtucl92
YWxpZGF0ZWRfcHRlc10sIG5vdCBwbE5lW25yX3ZhbGlkYXRlZF9wdGVzKzFd
LgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyAgICAgICAgfCAxNjUgKysrKysrKysrKysrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggfCAgNDEgKysrKysrKy0tLQogMiBmaWxlcyBjaGFuZ2VkLCAxMjggaW5z
ZXJ0aW9ucygrKSwgNzggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAwY2Jj
YTQ4YTAyLi44NGVlNDhlYzNmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNjUxLDIwICs2NTEs
MzQgQEAgc3RhdGljIGludCBhbGxvY19zZWdkZXNjX3BhZ2Uoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSkKIHN0YXRpYyBpbnQgX19nZXRfcGFnZV90eXBlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwcmVlbXB0aWJsZSk7CiAK
Ky8qCisgKiBUaGUgZm9sbG93aW5nIGZsYWdzIGFyZSB1c2VkIHRvIHNwZWNp
ZnkgYmVoYXZpb3Igb2YgdmFyaW91cyBnZXQgYW5kCisgKiBwdXQgY29tbWFu
ZHMuICBUaGUgZmlyc3QgdHdvIGFyZSBhbHNvIHN0b3JlZCBpbiBwYWdlLT5w
YXJ0aWFsX2ZsYWdzCisgKiB0byBpbmRpY2F0ZSB0aGUgc3RhdGUgb2YgdGhl
IHBhZ2UgcG9pbnRlZCB0byBieQorICogcGFnZS0+cHRlW3BhZ2UtPm5yX3Zh
bGlkYXRlZF9lbnRyaWVzXS4gIFNlZSB0aGUgY29tbWVudCBpbiBtbS5oIGZv
cgorICogbW9yZSBpbmZvcm1hdGlvbi4KKyAqLworI2RlZmluZSBQVEZfcGFy
dGlhbF9zZXQgICAgICAgICAoMSA8PCAwKQorI2RlZmluZSBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiAoMSA8PCAxKQorI2RlZmluZSBQVEZfcHJlZW1wdGli
bGUgICAgICAgICAoMSA8PCAyKQorI2RlZmluZSBQVEZfZGVmZXIgICAgICAg
ICAgICAgICAoMSA8PCAzKQorCiBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90
eXBlX2Zyb21fbWZuKAogICAgIG1mbl90IG1mbiwgdW5zaWduZWQgbG9uZyB0
eXBlLCBzdHJ1Y3QgZG9tYWluICpkLAotICAgIGludCBwYXJ0aWFsLCBpbnQg
cHJlZW1wdGlibGUpCisgICAgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAg
IHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9fcGFnZShtZm4pOwog
ICAgIGludCByYzsKKyAgICBib29sIHByZWVtcHRpYmxlID0gZmxhZ3MgJiBQ
VEZfcHJlZW1wdGlibGUsCisgICAgICAgICBwYXJ0aWFsX3JlZiA9IGZsYWdz
ICYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CiAKLSAgICBpZiAoIGxpa2Vs
eShwYXJ0aWFsID49IDApICYmCisgICAgaWYgKCBsaWtlbHkoIXBhcnRpYWxf
cmVmKSAmJgogICAgICAgICAgdW5saWtlbHkoIWdldF9wYWdlX2Zyb21fbWZu
KG1mbiwgZCkpICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKICAgICBy
YyA9IF9fZ2V0X3BhZ2VfdHlwZShwYWdlLCB0eXBlLCBwcmVlbXB0aWJsZSk7
CiAKLSAgICBpZiAoIHVubGlrZWx5KHJjKSAmJiBwYXJ0aWFsID49IDAgJiYK
KyAgICBpZiAoIHVubGlrZWx5KHJjKSAmJiAhcGFydGlhbF9yZWYgJiYKICAg
ICAgICAgICghcHJlZW1wdGlibGUgfHwgcGFnZSAhPSBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSkgKQogICAgICAgICBwdXRfcGFnZShwYWdlKTsK
IApAQCAtMTE0Niw3ICsxMTYwLDcgQEAgZ2V0X3BhZ2VfZnJvbV9sMWUoCiBk
ZWZpbmVfZ2V0X2xpbmVhcl9wYWdldGFibGUobDIpOwogc3RhdGljIGludAog
Z2V0X3BhZ2VfZnJvbV9sMmUoCi0gICAgbDJfcGdlbnRyeV90IGwyZSwgdW5z
aWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4gKmQsIGludCBwYXJ0aWFs
KQorICAgIGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLCBz
dHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAg
dW5zaWduZWQgbG9uZyBtZm4gPSBsMmVfZ2V0X3BmbihsMmUpOwogICAgIGlu
dCByYzsKQEAgLTExNjMsOCArMTE3Nyw5IEBAIGdldF9wYWdlX2Zyb21fbDJl
KAogCiAgICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3MobDJlKSAmIF9QQUdFX1BT
RSkgKQogICAgIHsKLSAgICAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9m
cm9tX21mbihfbWZuKG1mbiksIFBHVF9sMV9wYWdlX3RhYmxlLCBkLAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWws
IGZhbHNlKTsKKyAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfcHJlZW1w
dGlibGUpKTsKKworICAgICAgICByYyA9IGdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKF9tZm4obWZuKSwgUEdUX2wxX3BhZ2VfdGFibGUsIGQsIGZsYWdz
KTsKICAgICAgICAgaWYgKCB1bmxpa2VseShyYyA9PSAtRUlOVkFMKSAmJiBn
ZXRfbDJfbGluZWFyX3BhZ2V0YWJsZShsMmUsIHBmbiwgZCkgKQogICAgICAg
ICAgICAgcmMgPSAwOwogICAgICAgICByZXR1cm4gcmM7CkBAIC0xMTgzLDcg
KzExOTgsNyBAQCBnZXRfcGFnZV9mcm9tX2wyZSgKIGRlZmluZV9nZXRfbGlu
ZWFyX3BhZ2V0YWJsZShsMyk7CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9t
X2wzZSgKLSAgICBsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBm
biwgc3RydWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisgICAgbDNfcGdl
bnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBpbnQgcmM7CiAKQEAg
LTExOTgsNyArMTIxMyw3IEBAIGdldF9wYWdlX2Zyb21fbDNlKAogICAgIH0K
IAogICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCi0gICAg
ICAgIGwzZV9nZXRfbWZuKGwzZSksIFBHVF9sMl9wYWdlX3RhYmxlLCBkLCBw
YXJ0aWFsLCAxKTsKKyAgICAgICAgbDNlX2dldF9tZm4obDNlKSwgUEdUX2wy
X3BhZ2VfdGFibGUsIGQsIGZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlKTsKICAg
ICBpZiAoIHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYmCiAgICAgICAgICAh
aXNfcHZfMzJiaXRfZG9tYWluKGQpICYmCiAgICAgICAgICBnZXRfbDNfbGlu
ZWFyX3BhZ2V0YWJsZShsM2UsIHBmbiwgZCkgKQpAQCAtMTIxNiw3ICsxMjMx
LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sM2UoCiBkZWZpbmVfZ2V0X2xpbmVhcl9w
YWdldGFibGUobDQpOwogc3RhdGljIGludAogZ2V0X3BhZ2VfZnJvbV9sNGUo
Ci0gICAgbDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0
cnVjdCBkb21haW4gKmQsIGludCBwYXJ0aWFsKQorICAgIGw0X3BnZW50cnlf
dCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCB1
bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAgaW50IHJjOwogCkBAIC0xMjMx
LDcgKzEyNDYsNyBAQCBnZXRfcGFnZV9mcm9tX2w0ZSgKICAgICB9CiAKICAg
ICByYyA9IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAotICAgICAgICBs
NGVfZ2V0X21mbihsNGUpLCBQR1RfbDNfcGFnZV90YWJsZSwgZCwgcGFydGlh
bCwgMSk7CisgICAgICAgIGw0ZV9nZXRfbWZuKGw0ZSksIFBHVF9sM19wYWdl
X3RhYmxlLCBkLCBmbGFncyB8IFBURl9wcmVlbXB0aWJsZSk7CiAgICAgaWYg
KCB1bmxpa2VseShyYyA9PSAtRUlOVkFMKSAmJiBnZXRfbDRfbGluZWFyX3Bh
Z2V0YWJsZShsNGUsIHBmbiwgZCkgKQogICAgICAgICByYyA9IDA7CiAKQEAg
LTEzMDYsNyArMTMyMSw3IEBAIHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFf
cGdlbnRyeV90IGwxZSwgc3RydWN0IGRvbWFpbiAqbDFlX293bmVyKQogICog
Tm90ZSBhbHNvIHRoYXQgdGhpcyBhdXRvbWF0aWNhbGx5IGRlYWxzIGNvcnJl
Y3RseSB3aXRoIGxpbmVhciBwLnQuJ3MuCiAgKi8KIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwYXJ0
aWFsLCBib29sIGRlZmVyKQorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAgaW50IHJjID0gMDsKIApA
QCAtMTMyNiwxMiArMTM0MSwxMyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGwyZV9nZXRfcGFnZShs
MmUpOwogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwdHBnID0gbWZuX3Rv
X3BhZ2UoX21mbihwZm4pKTsKIAotICAgICAgICBpZiAoIHVubGlrZWx5KHBh
cnRpYWwgPiAwKSApCisgICAgICAgIGlmICggKGZsYWdzICYgKFBURl9wYXJ0
aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KKyAgICAg
ICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAgewotICAgICAg
ICAgICAgQVNTRVJUKCFkZWZlcik7CisgICAgICAgICAgICBBU1NFUlQoIShm
bGFncyAmIFBURl9kZWZlcikpOwogICAgICAgICAgICAgcmMgPSBfcHV0X3Bh
Z2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7CiAgICAgICAgIH0KLSAgICAgICAg
ZWxzZSBpZiAoIGRlZmVyICkKKyAgICAgICAgZWxzZSBpZiAoIGZsYWdzICYg
UFRGX2RlZmVyICkKICAgICAgICAgewogICAgICAgICAgICAgY3VycmVudC0+
YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IHB0cGc7CiAgICAgICAgICAgICBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBnOwpAQCAtMTM0OCw3ICsx
MzY0LDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2Vu
dHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKIH0KIAogc3RhdGljIGlu
dCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25l
ZCBsb25nIHBmbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
IHBhcnRpYWwsIGJvb2wgZGVmZXIpCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBzdHJ1Y3QgcGFn
ZV9pbmZvICpwZzsKICAgICBpbnQgcmM7CkBAIC0xMzcxLDEzICsxMzg3LDE0
IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90
IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAKICAgICBwZyA9IGwzZV9nZXRf
cGFnZShsM2UpOwogCi0gICAgaWYgKCB1bmxpa2VseShwYXJ0aWFsID4gMCkg
KQorICAgIGlmICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9w
YXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KKyAgICAgICAgIFBURl9wYXJ0aWFs
X3NldCApCiAgICAgewotICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAg
ICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKICAgICAgICAgcmV0
dXJuIF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBtZm5fdG9fcGFnZShfbWZu
KHBmbikpKTsKICAgICB9CiAKLSAgICBpZiAoIGRlZmVyICkKKyAgICBpZiAo
IGZsYWdzICYgUFRGX2RlZmVyICkKICAgICB7CiAgICAgICAgIGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBtZm5fdG9fcGFnZShfbWZuKHBmbikp
OwogICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBn
OwpAQCAtMTM5Miw3ICsxNDA5LDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9m
cm9tX2wzZShsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwK
IH0KIAogc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2w0ZShsNF9wZ2VudHJ5
X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBmbiwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgaW50IHBhcnRpYWwsIGJvb2wgZGVmZXIpCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykKIHsK
ICAgICBpbnQgcmMgPSAxOwogCkBAIC0xNDAxLDEzICsxNDE4LDE0IEBAIHN0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwg
dW5zaWduZWQgbG9uZyBwZm4sCiAgICAgewogICAgICAgICBzdHJ1Y3QgcGFn
ZV9pbmZvICpwZyA9IGw0ZV9nZXRfcGFnZShsNGUpOwogCi0gICAgICAgIGlm
ICggdW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgaWYgKCAoZmxh
Z3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9y
ZWYpKSA9PQorICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAg
ICAgICB7Ci0gICAgICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAgICAg
ICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAgICAgICAg
ICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90b19wYWdl
KF9tZm4ocGZuKSkpOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKCBkZWZl
ciApCisgICAgICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBn
ID0gbWZuX3RvX3BhZ2UoX21mbihwZm4pKTsKICAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGc7CkBAIC0xNTE0LDEyICsx
NTMyLDEzIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogICAgIHVuc2ln
bmVkIGxvbmcgIHBmbiA9IG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKTsKICAg
ICBsMl9wZ2VudHJ5X3QgICpwbDJlOwogICAgIHVuc2lnbmVkIGludCAgIGk7
Ci0gICAgaW50ICAgICAgICAgICAgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+
cGFydGlhbF9wdGU7CisgICAgaW50ICAgICAgICAgICAgcmMgPSAwOworICAg
IHVuc2lnbmVkIGludCAgIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFs
X2ZsYWdzOwogCiAgICAgcGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBm
bikpOwogCiAgICAgZm9yICggaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
OyBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7Ci0gICAgICAgICAgaSsrLCBw
YXJ0aWFsID0gMCApCisgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0g
MCApCiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKICAgICAg
ICAgewpAQCAtMTUyOSwxOCArMTU0OCwxOSBAQCBzdGF0aWMgaW50IGFsbG9j
X2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxv
bmcgdHlwZSkKICAgICAgICAgfQogCiAgICAgICAgIGlmICggIWlzX2d1ZXN0
X2wyX3Nsb3QoZCwgdHlwZSwgaSkgfHwKLSAgICAgICAgICAgICAocmMgPSBn
ZXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIGQsIHBhcnRpYWwpKSA+
IDAgKQorICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDJlKHBs
MmVbaV0sIHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCiAgICAgICAg
ICAgICBjb250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFS
VCApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRl
ZF9wdGVzID0gaTsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
cGFydGlhbCA/OiAxOworICAgICAgICAgICAgLyogU2V0ICdzZXQnLCByZXRh
aW4gJ2dlbmVyYWwgcmVmJyAqLworICAgICAgICAgICAgcGFnZS0+cGFydGlh
bF9mbGFncyA9IHBhcnRpYWxfZmxhZ3MgfCBQVEZfcGFydGlhbF9zZXQ7CiAg
ICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBp
ICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXMgPSBpOwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAw
OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgfQogICAgICAgICBl
bHNlIGlmICggcmMgPCAwICYmIHJjICE9IC1FSU5UUiApCkBAIC0xNTQ5LDcg
KzE1NjksNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSkKICAgICAgICAg
ICAgIGlmICggaSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAg
cGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgICAg
IHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgICAgICBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CiAgICAg
ICAgICAgICB9CkBAIC0xNTczLDcgKzE1OTMsOCBAQCBzdGF0aWMgaW50IGFs
bG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgdW5z
aWduZWQgbG9uZyAgcGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwog
ICAgIGwzX3BnZW50cnlfdCAgKnBsM2U7CiAgICAgdW5zaWduZWQgaW50ICAg
aTsKLSAgICBpbnQgICAgICAgICAgICByYyA9IDAsIHBhcnRpYWwgPSBwYWdl
LT5wYXJ0aWFsX3B0ZTsKKyAgICBpbnQgICAgICAgICAgICByYyA9IDA7Cisg
ICAgdW5zaWduZWQgaW50ICAgcGFydGlhbF9mbGFncyA9IHBhZ2UtPnBhcnRp
YWxfZmxhZ3M7CiAKICAgICBwbDNlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4o
cGZuKSk7CiAKQEAgLTE1ODgsNyArMTYwOSw3IEBAIHN0YXRpYyBpbnQgYWxs
b2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAg
bWVtc2V0KHBsM2UgKyA0LCAwLCAoTDNfUEFHRVRBQkxFX0VOVFJJRVMgLSA0
KSAqIHNpemVvZigqcGwzZSkpOwogCiAgICAgZm9yICggaSA9IHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzOyBpIDwgTDNfUEFHRVRBQkxFX0VOVFJJRVM7Ci0g
ICAgICAgICAgaSsrLCBwYXJ0aWFsID0gMCApCisgICAgICAgICAgaSsrLCBw
YXJ0aWFsX2ZsYWdzID0gMCApCiAgICAgewogICAgICAgICBpZiAoIGkgPiBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9j
aGVjaygpICkKICAgICAgICAgewpAQCAtMTYwNSwyMCArMTYyNiwyMiBAQCBz
dGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgcmMgPSBn
ZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICAgICAgICAgICAgICAg
ICAgbDNlX2dldF9tZm4ocGwzZVtpXSksCi0gICAgICAgICAgICAgICAgICAg
IFBHVF9sMl9wYWdlX3RhYmxlIHwgUEdUX3BhZV94ZW5fbDIsIGQsIHBhcnRp
YWwsIDEpOworICAgICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90YWJs
ZSB8IFBHVF9wYWVfeGVuX2wyLCBkLAorICAgICAgICAgICAgICAgICAgICBw
YXJ0aWFsX2ZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlKTsKICAgICAgICAgfQot
ICAgICAgICBlbHNlIGlmICggKHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UocGwz
ZVtpXSwgcGZuLCBkLCBwYXJ0aWFsKSkgPiAwICkKKyAgICAgICAgZWxzZSBp
ZiAoIChyYyA9IGdldF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0sIHBmbiwgZCwg
cGFydGlhbF9mbGFncykpID4gMCApCiAgICAgICAgICAgICBjb250aW51ZTsK
IAogICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAg
ICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAxOwor
ICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJhbCByZWYn
IHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KKyAgICAgICAgICAgIHBh
Z2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3BhcnRp
YWxfc2V0OwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA9PSAt
RUlOVFIgJiYgaSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfcHRlID0gMDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3Mg
PSAwOwogICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgIH0K
ICAgICAgICAgaWYgKCByYyA8IDAgKQpAQCAtMTYzNSw3ICsxNjU4LDcgQEAg
c3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgICAgICBpZiAoIGkgKQogICAgICAgICB7CiAgICAgICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICBwYWdlLT5wYXJ0
aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICB9CkBAIC0xNzY3
LDE5ICsxNzkwLDIxIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICB1bnNpZ25lZCBsb25nICBwZm4g
PSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7CiAgICAgbDRfcGdlbnRyeV90
ICAqcGw0ZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogICAgIHVu
c2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAgICAgcmMgPSAwLCBw
YXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7CisgICAgaW50ICAgICAgICAg
ICAgcmMgPSAwOworICAgIHVuc2lnbmVkIGludCAgIHBhcnRpYWxfZmxhZ3Mg
PSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCiAgICAgZm9yICggaSA9IHBhZ2Ut
Pm5yX3ZhbGlkYXRlZF9wdGVzOyBpIDwgTDRfUEFHRVRBQkxFX0VOVFJJRVM7
Ci0gICAgICAgICAgaSsrLCBwYXJ0aWFsID0gMCApCisgICAgICAgICAgaSsr
LCBwYXJ0aWFsX2ZsYWdzID0gMCApCiAgICAgewogICAgICAgICBpZiAoICFp
c19ndWVzdF9sNF9zbG90KGQsIGkpIHx8Ci0gICAgICAgICAgICAgKHJjID0g
Z2V0X3BhZ2VfZnJvbV9sNGUocGw0ZVtpXSwgcGZuLCBkLCBwYXJ0aWFsKSkg
PiAwICkKKyAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShw
bDRlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQogICAgICAg
ICAgICAgY29udGludWU7CiAKICAgICAgICAgaWYgKCByYyA9PSAtRVJFU1RB
UlQgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IHBhcnRpYWwgPzogMTsKKyAgICAgICAgICAgIC8qIFNldCAnc2V0JywgbGVh
dmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMgc2V0ICov
CisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9m
bGFncyB8IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAgfQogICAgICAgICBl
bHNlIGlmICggcmMgPCAwICkKICAgICAgICAgewpAQCAtMTc4OSw3ICsxODE0
LDcgQEAgc3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlKQogICAgICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAwOwor
ICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAg
ICAgICAgICAgICAgIGlmICggcmMgPT0gLUVJTlRSICkKICAgICAgICAgICAg
ICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgZWxz
ZQpAQCAtMTg0MiwxOSArMTg2NywyMCBAQCBzdGF0aWMgaW50IGZyZWVfbDJf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBzdHJ1Y3QgZG9t
YWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7CiAgICAgdW5zaWduZWQg
bG9uZyBwZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7CiAgICAgbDJf
cGdlbnRyeV90ICpwbDJlOwotICAgIGludCByYyA9IDAsIHBhcnRpYWwgPSBw
YWdlLT5wYXJ0aWFsX3B0ZTsKLSAgICB1bnNpZ25lZCBpbnQgaSA9IHBhZ2Ut
Pm5yX3ZhbGlkYXRlZF9wdGVzIC0gIXBhcnRpYWw7CisgICAgaW50IHJjID0g
MDsKKyAgICB1bnNpZ25lZCBpbnQgcGFydGlhbF9mbGFncyA9IHBhZ2UtPnBh
cnRpYWxfZmxhZ3MsCisgICAgICAgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyAtICEocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCk7CiAK
ICAgICBwbDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAKICAg
ICBmb3IgKCA7IDsgKQogICAgIHsKICAgICAgICAgaWYgKCBpc19ndWVzdF9s
Ml9zbG90KGQsIHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvLCBpKSApCi0gICAg
ICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbiwg
cGFydGlhbCwgZmFsc2UpOworICAgICAgICAgICAgcmMgPSBwdXRfcGFnZV9m
cm9tX2wyZShwbDJlW2ldLCBwZm4sIHBhcnRpYWxfZmxhZ3MpOwogICAgICAg
ICBpZiAoIHJjIDwgMCApCiAgICAgICAgICAgICBicmVhazsKIAotICAgICAg
ICBwYXJ0aWFsID0gMDsKKyAgICAgICAgcGFydGlhbF9mbGFncyA9IDA7CiAK
ICAgICAgICAgaWYgKCAhaS0tICkKICAgICAgICAgICAgIGJyZWFrOwpAQCAt
MTg3NiwxMiArMTkwMiwxNCBAQCBzdGF0aWMgaW50IGZyZWVfbDJfdGFibGUo
c3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBlbHNlIGlmICggcmMgPT0g
LUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRl
ZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0
aWFsID86IC0xOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gKHBh
cnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpID8KKyAgICAgICAgICAg
IHBhcnRpYWxfZmxhZ3MgOgorICAgICAgICAgICAgKFBURl9wYXJ0aWFsX3Nl
dCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsKICAgICB9CiAgICAgZWxz
ZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJ
RVMgLSAxICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9w
dGVzID0gaSArIDE7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsK
KyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAgICAgICAgIHJj
ID0gLUVSRVNUQVJUOwogICAgIH0KIApAQCAtMTg5MywxOCArMTkyMSwxOSBA
QCBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSkKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIo
cGFnZSk7CiAgICAgdW5zaWduZWQgbG9uZyBwZm4gPSBtZm5feChwYWdlX3Rv
X21mbihwYWdlKSk7CiAgICAgbDNfcGdlbnRyeV90ICpwbDNlOwotICAgIGlu
dCByYyA9IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKLSAgICB1
bnNpZ25lZCBpbnQgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICFw
YXJ0aWFsOworICAgIGludCByYyA9IDA7CisgICAgdW5zaWduZWQgaW50IHBh
cnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzLAorICAgICAgICBp
ID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhKHBhcnRpYWxfZmxhZ3Mg
JiBQVEZfcGFydGlhbF9zZXQpOwogCiAgICAgcGwzZSA9IG1hcF9kb21haW5f
cGFnZShfbWZuKHBmbikpOwogCiAgICAgZm9yICggOyA7ICkKICAgICB7Ci0g
ICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9sM2UocGwzZVtpXSwgcGZuLCBw
YXJ0aWFsLCAwKTsKKyAgICAgICAgcmMgPSBwdXRfcGFnZV9mcm9tX2wzZShw
bDNlW2ldLCBwZm4sIHBhcnRpYWxfZmxhZ3MpOwogICAgICAgICBpZiAoIHJj
IDwgMCApCiAgICAgICAgICAgICBicmVhazsKIAotICAgICAgICBwYXJ0aWFs
ID0gMDsKKyAgICAgICAgcGFydGlhbF9mbGFncyA9IDA7CiAgICAgICAgIGlm
ICggcmMgPT0gMCApCiAgICAgICAgICAgICBwbDNlW2ldID0gdW5hZGp1c3Rf
Z3Vlc3RfbDNlKHBsM2VbaV0sIGQpOwogCkBAIC0xOTIzLDEyICsxOTUyLDE0
IEBAIHN0YXRpYyBpbnQgZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZv
ICpwYWdlKQogICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
cGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IC0xOworICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFy
dGlhbF9zZXQpID8KKyAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgorICAg
ICAgICAgICAgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVy
YWxfcmVmKTsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAm
JiBpIDwgTDNfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CiAgICAg
ICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaSArIDE7Ci0gICAgICAg
IHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFnZS0+cGFydGlh
bF9mbGFncyA9IDA7CiAgICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgIH0K
ICAgICByZXR1cm4gcmMgPiAwID8gMCA6IHJjOwpAQCAtMTkzOSwyNiArMTk3
MCwyOSBAQCBzdGF0aWMgaW50IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRf
b3duZXIocGFnZSk7CiAgICAgdW5zaWduZWQgbG9uZyBwZm4gPSBtZm5feChw
YWdlX3RvX21mbihwYWdlKSk7CiAgICAgbDRfcGdlbnRyeV90ICpwbDRlID0g
bWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7Ci0gICAgaW50IHJjID0gMCwg
cGFydGlhbCA9IHBhZ2UtPnBhcnRpYWxfcHRlOwotICAgIHVuc2lnbmVkIGlu
dCAgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzIC0gIXBhcnRpYWw7Cisg
ICAgaW50IHJjID0gMDsKKyAgICB1bnNpZ25lZCBwYXJ0aWFsX2ZsYWdzID0g
cGFnZS0+cGFydGlhbF9mbGFncywKKyAgICAgICAgaSA9IHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzIC0gIShwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxf
c2V0KTsKIAogICAgIGRvIHsKICAgICAgICAgaWYgKCBpc19ndWVzdF9sNF9z
bG90KGQsIGkpICkKLSAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9s
NGUocGw0ZVtpXSwgcGZuLCBwYXJ0aWFsLCAwKTsKKyAgICAgICAgICAgIHJj
ID0gcHV0X3BhZ2VfZnJvbV9sNGUocGw0ZVtpXSwgcGZuLCBwYXJ0aWFsX2Zs
YWdzKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICAgICAgYnJl
YWs7Ci0gICAgICAgIHBhcnRpYWwgPSAwOworICAgICAgICBwYXJ0aWFsX2Zs
YWdzID0gMDsKICAgICB9IHdoaWxlICggaS0tICk7CiAKICAgICBpZiAoIHJj
ID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
cGFydGlhbCA/OiAtMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/CisgICAgICAg
ICAgICBwYXJ0aWFsX2ZsYWdzIDoKKyAgICAgICAgICAgIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CiAgICAgfQogICAg
IGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEw0X1BBR0VUQUJMRV9F
TlRSSUVTIC0gMSApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGkgKyAxOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IDA7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAg
ICByYyA9IC1FUkVTVEFSVDsKICAgICB9CiAKQEAgLTIxODAsNyArMjIxNCw3
IEBAIHN0YXRpYyBpbnQgbW9kX2wyX2VudHJ5KGwyX3BnZW50cnlfdCAqcGwy
ZSwKICAgICAgICAgcmV0dXJuIC1FQlVTWTsKICAgICB9CiAKLSAgICBwdXRf
cGFnZV9mcm9tX2wyZShvbDJlLCBwZm4sIDAsIHRydWUpOworICAgIHB1dF9w
YWdlX2Zyb21fbDJlKG9sMmUsIHBmbiwgUFRGX2RlZmVyKTsKIAogICAgIHJl
dHVybiByYzsKIH0KQEAgLTIyNDgsNyArMjI4Miw3IEBAIHN0YXRpYyBpbnQg
bW9kX2wzX2VudHJ5KGwzX3BnZW50cnlfdCAqcGwzZSwKICAgICAgICAgaWYg
KCAhY3JlYXRlX3BhZV94ZW5fbWFwcGluZ3MoZCwgcGwzZSkgKQogICAgICAg
ICAgICAgQlVHKCk7CiAKLSAgICBwdXRfcGFnZV9mcm9tX2wzZShvbDNlLCBw
Zm4sIDAsIDEpOworICAgIHB1dF9wYWdlX2Zyb21fbDNlKG9sM2UsIHBmbiwg
UFRGX2RlZmVyKTsKICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTIzMTEsNyAr
MjM0NSw3IEBAIHN0YXRpYyBpbnQgbW9kX2w0X2VudHJ5KGw0X3BnZW50cnlf
dCAqcGw0ZSwKICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7CiAgICAgfQogCi0g
ICAgcHV0X3BhZ2VfZnJvbV9sNGUob2w0ZSwgcGZuLCAwLCAxKTsKKyAgICBw
dXRfcGFnZV9mcm9tX2w0ZShvbDRlLCBwZm4sIFBURl9kZWZlcik7CiAgICAg
cmV0dXJuIHJjOwogfQogCkBAIC0yNTc3LDcgKzI2MTEsNyBAQCBpbnQgZnJl
ZV9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQg
bG9uZyB0eXBlLAogICAgIGlmICggISh0eXBlICYgUEdUX3BhcnRpYWwpICkK
ICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gMVUg
PDwgUEFHRVRBQkxFX09SREVSOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0
ZSA9IDA7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAg
IH0KIAogICAgIHN3aXRjaCAoIHR5cGUgJiBQR1RfdHlwZV9tYXNrICkKQEAg
LTI4NjIsNyArMjg5Niw3IEBAIHN0YXRpYyBpbnQgX19nZXRfcGFnZV90eXBl
KHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSwK
ICAgICAgICAgaWYgKCAhKHggJiBQR1RfcGFydGlhbCkgKQogICAgICAgICB7
CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IDA7Ci0g
ICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAg
ICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgfQogICAgICAg
ICBwYWdlLT5saW5lYXJfcHRfY291bnQgPSAwOwogICAgICAgICByYyA9IGFs
bG9jX3BhZ2VfdHlwZShwYWdlLCB0eXBlLCBwcmVlbXB0aWJsZSk7CkBAIC0z
MDM3LDcgKzMwNzEsOCBAQCBpbnQgbmV3X2d1ZXN0X2NyMyhtZm5fdCBtZm4p
CiAKICAgICByYyA9IHBhZ2luZ19tb2RlX3JlZmNvdW50cyhkKQogICAgICAg
ICAgPyAoZ2V0X3BhZ2VfZnJvbV9tZm4obWZuLCBkKSA/IDAgOiAtRUlOVkFM
KQotICAgICAgICAgOiBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihtZm4s
IFBHVF9yb290X3BhZ2VfdGFibGUsIGQsIDAsIDEpOworICAgICAgICAgOiBn
ZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihtZm4sIFBHVF9yb290X3BhZ2Vf
dGFibGUsIGQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFBURl9wcmVlbXB0aWJsZSk7CiAgICAgc3dpdGNoICggcmMgKQogICAg
IHsKICAgICBjYXNlIDA6CkBAIC0zNDIwLDcgKzM0NTUsNyBAQCBsb25nIGRv
X21tdWV4dF9vcCgKICAgICAgICAgICAgIGlmICggb3AuYXJnMS5tZm4gIT0g
MCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSBnZXRf
cGFnZV9hbmRfdHlwZV9mcm9tX21mbigKLSAgICAgICAgICAgICAgICAgICAg
X21mbihvcC5hcmcxLm1mbiksIFBHVF9yb290X3BhZ2VfdGFibGUsIGN1cnJk
LCAwLCAxKTsKKyAgICAgICAgICAgICAgICAgICAgX21mbihvcC5hcmcxLm1m
biksIFBHVF9yb290X3BhZ2VfdGFibGUsIGN1cnJkLCBQVEZfcHJlZW1wdGli
bGUpOwogCiAgICAgICAgICAgICAgICAgaWYgKCB1bmxpa2VseShyYykgKQog
ICAgICAgICAgICAgICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2Fz
bS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaAppbmRleCAx
MDMwYjhiNWU2Li5hNTMxZmUzMTE1IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVk
ZS9hc20teDg2L21tLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5o
CkBAIC0xNTcsMTkgKzE1NywzNCBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAgICAg
ICAgICAqIHNldHRpbmcgdGhlIGZsYWcgbXVzdCBub3QgZHJvcCB0aGF0IHJl
ZmVyZW5jZSwgd2hlcmVhcyB0aGUgaW5zdGFuY2UKICAgICAgICAgICogY2xl
YXJpbmcgaXQgd2lsbCBoYXZlIHRvLgogICAgICAgICAgKgotICAgICAgICAg
KiBJZiBAcGFydGlhbF9wdGUgaXMgcG9zaXRpdmUgdGhlbiBQVEUgYXQgQG5y
X3ZhbGlkYXRlZF9wdGVzKzEgaGFzCi0gICAgICAgICAqIGJlZW4gcGFydGlh
bGx5IHZhbGlkYXRlZC4gVGhpcyBpbXBsaWVzIHRoYXQgdGhlIGdlbmVyYWwg
cmVmZXJlbmNlCi0gICAgICAgICAqIHRvIHRoZSBwYWdlIChhY3F1aXJlZCBm
cm9tIGdldF9wYWdlX2Zyb21fbE5lKCkpIHdvdWxkIGJlIGRyb3BwZWQKLSAg
ICAgICAgICogKGFnYWluIGR1ZSB0byB0aGUgYXBwYXJlbnQgZmFpbHVyZSkg
YW5kIGhlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQKLSAgICAgICAgICogd2hl
biByZXN1bWluZyB0aGUgdmFsaWRhdGlvbiwgYnV0IG11c3Qgbm90IGJlIGRy
b3BwZWQgd2hlbiBwaWNraW5nCi0gICAgICAgICAqIHVwIHRoZSBwYWdlIGZv
ciBpbnZhbGlkYXRpb24uCisgICAgICAgICAqIElmIHBhcnRpYWxfZmxhZ3Mg
JiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIHRoZSBwYWdlIGF0Cisg
ICAgICAgICAqIGF0IEBucl92YWxpZGF0ZWRfcHRlcyBoYWQgUEdUX3BhcnRp
YWwgc2V0IGFzIGEgcmVzdWx0IG9mIGFuCisgICAgICAgICAqIG9wZXJhdGlv
biBvbiB0aGUgY3VycmVudCBwYWdlLiAgKFRoYXQgcGFnZSBtYXkgb3IgbWF5
IG5vdAorICAgICAgICAgKiBzdGlsbCBoYXZlIFBHVF9wYXJ0aWFsIHNldC4p
CiAgICAgICAgICAqCi0gICAgICAgICAqIElmIEBwYXJ0aWFsX3B0ZSBpcyBu
ZWdhdGl2ZSB0aGVuIFBURSBhdCBAbnJfdmFsaWRhdGVkX3B0ZXMrMSBoYXMK
LSAgICAgICAgICogYmVlbiBwYXJ0aWFsbHkgaW52YWxpZGF0ZWQuIFRoaXMg
aXMgYmFzaWNhbGx5IHRoZSBvcHBvc2l0ZSBjYXNlIG9mCi0gICAgICAgICAq
IGFib3ZlLCBpLmUuIHRoZSBnZW5lcmFsIHJlZmVyZW5jZSB0byB0aGUgcGFn
ZSB3YXMgbm90IGRyb3BwZWQgaW4KLSAgICAgICAgICogcHV0X3BhZ2VfZnJv
bV9sTmUoKSAoZHVlIHRvIHRoZSBhcHBhcmVudCBmYWlsdXJlKSwgYW5kIGhl
bmNlIGl0Ci0gICAgICAgICAqIG11c3QgYmUgZHJvcHBlZCB3aGVuIHRoZSBw
dXQgb3BlcmF0aW9uIGlzIHJlc3VtZWQgKGFuZCBjb21wbGV0ZXMpLAotICAg
ICAgICAgKiBidXQgaXQgbXVzdCBub3QgYmUgYWNxdWlyZWQgaWYgcGlja2lu
ZyB1cCB0aGUgcGFnZSBmb3IgdmFsaWRhdGlvbi4KKyAgICAgICAgICogSWYg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0LCB0aGVuIHRoZSBQVEUg
YXQKKyAgICAgICAgICogQG5yX3ZhbGlkYXRlZF9wdGVmIGhvbGRzIGEgZ2Vu
ZXJhbCByZWZlcmVuY2UgY291bnQgZm9yIHRoZQorICAgICAgICAgKiBwYWdl
LgorICAgICAgICAgKgorICAgICAgICAgKiBUaGlzIGhhcHBlbnM6CisgICAg
ICAgICAqIC0gRHVyaW5nIGRlLXZhbGlkYXRpb24sIGlmIGRlLXZhbGlkYXRp
b24gb2YgdGhlIHBhZ2Ugd2FzCisgICAgICAgICAqICAgaW50ZXJydXB0ZWQK
KyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiwgaWYgYW4gaW52YWxp
ZCBlbnRyeSBpcyBlbmNvdW50ZXJlZCBhbmQKKyAgICAgICAgICogICB2YWxp
ZGF0aW9uIGlzIHByZWVtcHRpYmxlCisgICAgICAgICAqIC0gRHVyaW5nIHZh
bGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIHdhcyBzZXQg
b24KKyAgICAgICAgICogICB0aGlzIGVudHJ5IHRvIGJlZ2luIHdpdGggKHBl
cmhhcHMgYmVjYXVzZSB3ZSdyZSBwaWNraW5nCisgICAgICAgICAqICAgdXAg
ZnJvbSBhIHBhcnRpYWwgZGUtdmFsaWRhdGlvbikuCisgICAgICAgICAqCisg
ICAgICAgICAqIFdoZW4gcmVzdW1pbmcgdmFsaWRhdGlvbiwgaWYgUFRGX3Bh
cnRpYWxfZ2VuZXJhbF9yZWYgaXMgY2xlYXIsCisgICAgICAgICAqIHRoZW4g
YSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVpcmVkOyBpZiBp
dCBpcyBzZXQsIG5vCisgICAgICAgICAqIHJlZmVyZW5jZSBzaG91bGQgYmUg
YWNxdWlyZWQuCisgICAgICAgICAqCisgICAgICAgICAqIFdoZW4gcmVzdW1p
bmcgZGUtdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYg
aXMKKyAgICAgICAgICogY2xlYXIsIG5vIHJlZmVyZW5jZSBzaG91bGQgYmUg
ZHJvcHBlZDsgaWYgaXQgaXMgc2V0LCBhCisgICAgICAgICAqIHJlZmVyZW5j
ZSBzaG91bGQgYmUgZHJvcHBlZC4KKyAgICAgICAgICoKKyAgICAgICAgICog
TkIgdGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0aWFsX2dlbmVy
YWxfcmVmIGFyZQorICAgICAgICAgKiBkZWZpbmVkIGluIG1tLmMsIHRoZSBv
bmx5IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQuCiAgICAgICAgICAqCiAg
ICAgICAgICAqIFRoZSAzcmQgZmllbGQsIEBsaW5lYXJfcHRfY291bnQsIGlu
ZGljYXRlcwogICAgICAgICAgKiAtIGJ5IGEgcG9zaXRpdmUgdmFsdWUsIGhv
dyBtYW55IHNhbWUtbGV2ZWwgcGFnZSB0YWJsZSBlbnRyaWVzIGEgcGFnZQpA
QCAtMTgwLDcgKzE5NSw3IEBAIHN0cnVjdCBwYWdlX2luZm8KICAgICAgICAg
c3RydWN0IHsKICAgICAgICAgICAgIHUxNiBucl92YWxpZGF0ZWRfcHRlczpQ
QUdFVEFCTEVfT1JERVIgKyAxOwogICAgICAgICAgICAgdTE2IDoxNiAtIFBB
R0VUQUJMRV9PUkRFUiAtIDEgLSAyOwotICAgICAgICAgICAgczE2IHBhcnRp
YWxfcHRlOjI7CisgICAgICAgICAgICB1MTYgcGFydGlhbF9mbGFnczoyOwog
ICAgICAgICAgICAgczE2IGxpbmVhcl9wdF9jb3VudDsKICAgICAgICAgfTsK
IAotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Transfer-Encoding: base64

RnJvbSAyNTVhZDg4MDRjNzlkYzg3NDMyMmE3MDYwYWUwNjE1MzA1YmNiOGU4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA0LzExXSB4
ODYvbW06IFVzZSBmbGFncyBmb3IgX3B1dF9wYWdlX3R5cGUgcmF0aGVyIHRo
YW4gYQogYm9vbGVhbgoKVGhpcyBpcyBpbiBtYWlubHkgaW4gcHJlcGFyYXRp
b24gZm9yIF9wdXRfcGFnZV90eXBlIHRha2luZyB0aGUKcGFydGlhbF9mbGFn
cyB2YWx1ZSBpbiB0aGUgZnV0dXJlLiAgSXQgYWxzbyBtYWtlcyBpdCBlYXNp
ZXIgdG8gcmVhZCBpbgp0aGUgY2FsbGVyIChzaW5jZSB5b3Ugc2VlIGEgZmxh
ZyBuYW1lIHJhdGhlciB0aGFuIGB0cnVlYCBvciBgZmFsc2VgKS4KCk5vIGZ1
bmN0aW9uYWwgY2hhbmdlIGludGVuZGVkLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0yOTkuCgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2
L21tLmMgfCAyNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tCiAxIGZpbGUg
Y2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA4NGVlNDhlYzNmLi5lMzI2NGY4ODc5IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTI1Myw3ICsxMjUzLDcgQEAgZ2V0X3BhZ2VfZnJvbV9sNGUoCiAgICAg
cmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50IF9wdXRfcGFnZV90eXBlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UsIGJvb2wgcHJlZW1wdGlibGUsCitzdGF0
aWMgaW50IF9wdXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Us
IHVuc2lnbmVkIGludCBmbGFncywKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZyk7CiAKIHZvaWQgcHV0X3BhZ2Vf
ZnJvbV9sMWUobDFfcGdlbnRyeV90IGwxZSwgc3RydWN0IGRvbWFpbiAqbDFl
X293bmVyKQpAQCAtMTM0NSw3ICsxMzQ1LDcgQEAgc3RhdGljIGludCBwdXRf
cGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25n
IHBmbiwKICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAg
ICAgewogICAgICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIp
KTsKLSAgICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUs
IHB0cGcpOworICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywg
UFRGX3ByZWVtcHRpYmxlLCBwdHBnKTsKICAgICAgICAgfQogICAgICAgICBl
bHNlIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CkBAIC0x
MzU0LDcgKzEzNTQsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJl
KGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICB9CiAgICAgICAgIGVsc2UKICAgICAgICAgewotICAgICAgICAgICAgcmMg
PSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7CisgICAgICAgICAg
ICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0
cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAg
ICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAgICB9CkBAIC0xMzkxLDcg
KzEzOTEsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3Bn
ZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAgICAgUFRG
X3BhcnRpYWxfc2V0ICkKICAgICB7CiAgICAgICAgIEFTU0VSVCghKGZsYWdz
ICYgUFRGX2RlZmVyKSk7Ci0gICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlw
ZShwZywgdHJ1ZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAgICAg
IHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBt
Zm5fdG9fcGFnZShfbWZuKHBmbikpKTsKICAgICB9CiAKICAgICBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKQEAgLTE0MDEsNyArMTQwMSw3IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAot
ICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90b19wYWdl
KF9tZm4ocGZuKSkpOworICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBU
Rl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CiAgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAgIHB1dF9wYWdlKHBnKTsKIApA
QCAtMTQyMiw3ICsxNDIyLDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9t
X2w0ZShsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAg
ICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAgewogICAg
ICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKLSAgICAg
ICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZuX3Rv
X3BhZ2UoX21mbihwZm4pKSk7CisgICAgICAgICAgICByZXR1cm4gX3B1dF9w
YWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21m
bihwZm4pKSk7CiAgICAgICAgIH0KIAogICAgICAgICBpZiAoIGZsYWdzICYg
UFRGX2RlZmVyICkKQEAgLTE0MzIsNyArMTQzMiw3IEBAIHN0YXRpYyBpbnQg
cHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQg
bG9uZyBwZm4sCiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgfQog
Ci0gICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90
b19wYWdlKF9tZm4ocGZuKSkpOworICAgICAgICByYyA9IF9wdXRfcGFnZV90
eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZu
KSkpOwogICAgICAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICAgICAgICAg
IHB1dF9wYWdlKHBnKTsKICAgICB9CkBAIC0yNjgwLDExICsyNjgwLDEyIEBA
IHN0YXRpYyBpbnQgX3B1dF9maW5hbF9wYWdlX3R5cGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogfQogCiAKLXN0YXRp
YyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwg
Ym9vbCBwcmVlbXB0aWJsZSwKK3N0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUo
c3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpw
dHBnKQogewogICAgIHVuc2lnbmVkIGxvbmcgbngsIHgsIHkgPSBwYWdlLT51
LmludXNlLnR5cGVfaW5mbzsKICAgICBpbnQgcmMgPSAwOworICAgIGJvb2wg
cHJlZW1wdGlibGUgPSBmbGFncyAmIFBURl9wcmVlbXB0aWJsZTsKIAogICAg
IGZvciAoIDsgOyApCiAgICAgewpAQCAtMjg4NCw3ICsyODg1LDcgQEAgc3Rh
dGljIGludCBfX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogCiAgICAgICAgICAgICBpZiAoIHVu
bGlrZWx5KGlvbW11X3JldCkgKQogICAgICAgICAgICAgewotICAgICAgICAg
ICAgICAgIF9wdXRfcGFnZV90eXBlKHBhZ2UsIGZhbHNlLCBOVUxMKTsKKyAg
ICAgICAgICAgICAgICBfcHV0X3BhZ2VfdHlwZShwYWdlLCAwLCBOVUxMKTsK
ICAgICAgICAgICAgICAgICByYyA9IGlvbW11X3JldDsKICAgICAgICAgICAg
ICAgICBnb3RvIG91dDsKICAgICAgICAgICAgIH0KQEAgLTI5MTEsNyArMjkx
Miw3IEBAIHN0YXRpYyBpbnQgX19nZXRfcGFnZV90eXBlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSwKIAogdm9pZCBwdXRf
cGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7Ci0gICAgaW50
IHJjID0gX3B1dF9wYWdlX3R5cGUocGFnZSwgZmFsc2UsIE5VTEwpOworICAg
IGludCByYyA9IF9wdXRfcGFnZV90eXBlKHBhZ2UsIDAsIE5VTEwpOwogICAg
IEFTU0VSVChyYyA9PSAwKTsKICAgICAodm9pZClyYzsKIH0KQEAgLTI5Mjcs
NyArMjkyOCw3IEBAIGludCBnZXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSkKIAogaW50IHB1dF9wYWdl
X3R5cGVfcHJlZW1wdGlibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKIHsK
LSAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGFnZSwgdHJ1ZSwgTlVMTCk7
CisgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBhZ2UsIFBURl9wcmVlbXB0
aWJsZSwgTlVMTCk7CiB9CiAKIGludCBnZXRfcGFnZV90eXBlX3ByZWVtcHRp
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlw
ZSkKQEAgLTI5NDMsNyArMjk0NCw3IEBAIGludCBwdXRfb2xkX2d1ZXN0X3Rh
YmxlKHN0cnVjdCB2Y3B1ICp2KQogICAgIGlmICggIXYtPmFyY2gub2xkX2d1
ZXN0X3RhYmxlICkKICAgICAgICAgcmV0dXJuIDA7CiAKLSAgICBzd2l0Y2gg
KCByYyA9IF9wdXRfcGFnZV90eXBlKHYtPmFyY2gub2xkX2d1ZXN0X3RhYmxl
LCB0cnVlLAorICAgIHN3aXRjaCAoIHJjID0gX3B1dF9wYWdlX3R5cGUodi0+
YXJjaC5vbGRfZ3Vlc3RfdGFibGUsIFBURl9wcmVlbXB0aWJsZSwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYtPmFyY2gub2xkX2d1ZXN0
X3B0cGcpICkKICAgICB7CiAgICAgY2FzZSAtRUlOVFI6Ci0tIAoyLjIzLjAK
Cg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Transfer-Encoding: base64

RnJvbSAzNmNlMmI2ZTI0NmQ0MWViYWViOTk0ZGJmMmI0ZTBlNDU1NTg5M2Jm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA1LzExXSB4
ODYvbW06IFJld29yayBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbiBjb25k
aXRpb25hbAoKTWFrZSBpdCBlYXNpZXIgdG8gcmVhZCBieSBkZWNsYXJpbmcg
dGhlIGNvbmRpdGlvbnMgaW4gd2hpY2ggd2Ugd2lsbApyZXRhaW4gdGhlIHJl
ZiwgcmF0aGVyIHRoYW4gdGhlIGNvbmRpdGlvbnMgdW5kZXIgd2hpY2ggd2Ug
cmVsZWFzZSBpdC4KClRoZSBvbmx5IHdheSAocGFnZSA9PSBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZSkgY2FuIGJlIHRydWUgaXMgaWYKcHJlZW1w
dGlibGUgaXMgdHJ1ZTsgc28gcmVtb3ZlIHRoaXMgZnJvbSB0aGUgcXVlcnkg
aXRzZWxmLCBhbmQgYWRkIGFuCkFTU0VSVCgpIHRvIHRoYXQgZWZmZWN0IG9u
IHRoZSBvcHBvc2l0ZSBwYXRoLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50
ZW5kZWQuCgpOQiB0aGF0IGFsbG9jX2xOX3RhYmxlKCkgbWlzaGFuZGxlIHRo
ZSAibGluZWFyIHB0IGZhaWx1cmUiIHNpdHVhdGlvbgpkZXNjcmliZWQgaW4g
dGhlIGNvbW1lbnQ7IHRoaXMgd2lsbCBiZSBhZGRyZXNzZWQgaW4gYSBmdXR1
cmUgcGF0Y2guCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDM5ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNo
YW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCBlMzI2NGY4ODc5Li5jZTdmNWI4NGYzIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
Njc4LDggKzY3OCw0MyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBl
X2Zyb21fbWZuKAogCiAgICAgcmMgPSBfX2dldF9wYWdlX3R5cGUocGFnZSwg
dHlwZSwgcHJlZW1wdGlibGUpOwogCi0gICAgaWYgKCB1bmxpa2VseShyYykg
JiYgIXBhcnRpYWxfcmVmICYmCi0gICAgICAgICAoIXByZWVtcHRpYmxlIHx8
IHBhZ2UgIT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUpICkKKyAg
ICAvKgorICAgICAqIFJldGFpbiB0aGUgcmVmY291bnQgaWY6CisgICAgICog
LSBwYWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKKyAgICAgKiAt
IHBhZ2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6CisgICAgICog
ICAtIFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlhbF9yZWYp
CisgICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCBidXQg
dGhlcmUncyBiZWVuIGFuIGVycm9yCisgICAgICogICAgIChwYWdlID09IGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKQorICAgICAqCisgICAgICog
VGhlIHBhcnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBpcyB3b3J0aCBhbiBl
eHBsYW5hdGlvbi4gIFRoZXJlCisgICAgICogYXJlIHR3byBzY2VuYXJpb3Mg
d2hlcmUgcGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBjb21pbmcgaW46Cisg
ICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgdHlw
ZSBgdHlwZWA7IGkuZS4gaGFzCisgICAgICogICBQR1RfcGFydGlhbCBzZXQK
KyAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgZGVtb3RlZCBhcyBM
KHR5cGUrMSkgKGkuZS4sIGEgbGluZWFyCisgICAgICogICBwYWdlOyBlLmcu
IHdlJ3JlIGJlaW5nIGNhbGxlZCBmcm9tIGdldF9wYWdlX2Zyb21fbDJlIHdp
dGgKKyAgICAgKiAgIHR5cGUgPT0gUEdUX2wxX3RhYmxlLCBidXQgdGhlIG1m
biBpcyBQR1RfbDJfdGFibGUpCisgICAgICoKKyAgICAgKiBJZiB0aGVyZSdz
IGFuIGVycm9yLCBpbiB0aGUgZmlyc3QgY2FzZSwgX2dldF9wYWdlX3R5cGUg
d2lsbAorICAgICAqIGVpdGhlciByZXR1cm4gLUVSRVNUQVJULCBpbiB3aGlj
aCBjYXNlIHdlIHdhbnQgdG8gcmV0YWluIHRoZQorICAgICAqIHJlZiAoYXMg
dGhlIGNhbGxlciB3aWxsIGNvbnNpZGVyIGl0IHJldGFpbmVkKSwgb3IgLUVJ
TlZBTCwgaW4KKyAgICAgKiB3aGljaCBjYXNlIG9sZF9ndWVzdF90YWJsZSB3
aWxsIGJlIHNldDsgaW4gYm90aCBjYXNlcywgd2UgbmVlZAorICAgICAqIHRv
IHJldGFpbiB0aGUgcmVmLgorICAgICAqCisgICAgICogSW4gdGhlIHNlY29u
ZCBjYXNlLCBpZiB0aGVyZSdzIGFuIGVycm9yLCBfZ2V0X3BhZ2VfdHlwZSgp
IGNhbgorICAgICAqICpvbmx5KiByZXR1cm4gLUVJTlZBTCwgYW5kICpuZXZl
ciogc2V0IG9sZF9ndWVzdF90YWJsZS4gIEluCisgICAgICogdGhhdCBjYXNl
IHdlIGFsc28gd2FudCB0byByZXRhaW4gdGhlIHJlZmVyZW5jZSwgdG8gYWxs
b3cgdGhlCisgICAgICogcGFnZSB0byBjb250aW51ZSB0byBiZSB0b3JuIGRv
d24gKGkuZS4sIFBHVF9wYXJ0aWFsIGNsZWFyZWQpCisgICAgICogc2FmZWx5
LgorICAgICAqCisgICAgICogQWxzbyBub3RlIHRoYXQgd2Ugc2hvdWxkbid0
IGJlIGFibGUgdG8gbGVhdmUgd2l0aCB0aGUgcmVmZXJlbmNlCisgICAgICog
Y291bnQgcmV0YWluZWQgdW5sZXNzIHdlIHN1Y2NlZWRlZCwgb3IgdGhlIG9w
ZXJhdGlvbiB3YXMKKyAgICAgKiBwcmVlbXB0aWJsZS4KKyAgICAgKi8KKyAg
ICBpZiAoIGxpa2VseSghcmMpIHx8IHBhcnRpYWxfcmVmICkKKyAgICAgICAg
Lyogbm90aGluZyAqLzsKKyAgICBlbHNlIGlmICggcGFnZSA9PSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCisgICAgICAgIEFTU0VSVChwcmVl
bXB0aWJsZSk7CisgICAgZWxzZQogICAgICAgICBwdXRfcGFnZShwYWdlKTsK
IAogICAgIHJldHVybiByYzsKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Transfer-Encoding: base64

RnJvbSAxODBmNjM4ZmI1MDQ3YzQ3OGNhMzJiMTVkZDJiYTliYTBjZTQzNjIz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA2LzExXSB4
ODYvbW06IEhhdmUgYWxsb2NfbFsyM11fdGFibGUgY2xlYXIgcGFydGlhbF9m
bGFncyB3aGVuCiBwcmVlbXB0aW5nCgpJbiBvcmRlciB0byBhbGxvdyByZWN1
cnNpdmUgcGFnZXRhYmxlIHByb21vdGlvbnMgYW5kIGRlbW90aW9ucyB0byBi
ZQppbnRlcnJ1cHRlZCwgWGVuIG11c3Qga2VlcCB0cmFjayBvZiB0aGUgc3Rh
dGUgb2YgdGhlIHN1Yi1wYWdlcwpwcm9tb3RlZCBvciBkZW1vdGVkLiAgVGhp
cyBpcyBzdG9yZWQgaW4gdHdvIGVsZW1lbnRzIGluIHRoZSBwYWdlCnN0cnVj
dDogbnJfZW50cmllc192YWxpZGF0ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpU
aGUgcnVsZSBpcyB0aGF0IGVudHJpZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRh
dGVkKSBzaG91bGQgYWx3YXlzIGJlCnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdl
bmVyYWwgcmVmZXJlbmNlIGNvdW50LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6
ZXJvLCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlk
YXRlZCBhbmQgbm8gcmVmZXJlbmNlCmNvdW50IGlzIGhlbGQuICBJZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRl
ZF0KaXMgcGFydGlhbGx5IHZhbGlkYXRlZC4KCkF0IHRoZSBtb21lbnQsIGEg
ZGlzdGluY3Rpb24gaXMgbWFkZSBiZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVt
b3Rpb24Kd2l0aCByZWdhcmQgdG8gd2hldGhlciB0aGUgZW50cnkgaXRzZWxm
ICJob2xkcyIgYSBnZW5lcmFsIHJlZmVyZW5jZQpjb3VudDogd2hlbiBlbnRy
eSBwcm9tb3Rpb24gaXMgaW50ZXJydXB0ZWQgKGkuZS4sIHJldHVybnMgLUVS
RVNUQVJUKSwKdGhlIGVudHJ5IGlzIG5vdCBjb25zaWRlcmVkIHRvIGhvbGQg
YSByZWZlcmVuY2U7IHdoZW4gZW50cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0
ZWQsIHRoZSBlbnRyeSBpcyBzdGlsbCBjb25zaWRlcmVkIHRvIGhvbGQgYSBn
ZW5lcmFsCnJlZmVyZW5jZS4KClBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYg
Y2xlYXIsIGl0J3MgYSBwYXJ0aWFsIHByb21vdGlvbiA9PiBubyBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBoZWxkCmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBp
dCdzIHBhcnRpYWwgZGVtb3Rpb24sIHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UK
Y291bnQgaGVsZC4gIEJlY2F1c2UgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25z
IGNhbiBiZSBpbnRlcmxlYXZlZCwgdGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8g
Z2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21f
bCplLAp0byBiZSBhYmxlIHRvIHByb3Blcmx5IGhhbmRsZSByZWZlcmVuY2Ug
Y291bnRzLgoKVW5mb3J0dW5hdGVseSwgd2hlbiBhbGxvY19sWzIzXV90YWJs
ZSBjaGVjayBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpCmFuZCByZXR1cm4g
LUVSRVNUQVJULCB0aGV5IHNldCBucl9lbnRyaWVzX3ZhbGlkYXRlZCwgYnV0
IGRvbid0IGNsZWFyCnBhcnRpYWxfZmxhZ3MuCgpJZiB3ZSB3ZXJlIHBpY2tp
bmcgdXAgZnJvbSBhIHByZXZpb3VzbHktaW50ZXJydXB0ZWQgcHJvbW90aW9u
LCB0aGF0Cm1lYW5zIHRoYXQgUFRGX3BhcnRpYWxfc2V0IHdvdWxkIGJlIHNl
dCBldmVuIHRob3VnaApbbnJfZW50cmllc192YWxpZGF0ZWRdIHdhcyBub3Qg
cGFydGlhbGx5IHZhbGlkYXRlZC4gIFRoaXMgbWVhbnMgdGhhdAppZiB0aGUg
cGFnZSBpbiB0aGlzIHN0YXRlIHdlcmUgZGUtdmFsaWRhdGVkLCBwdXRfcGFn
ZV90eXBlKCkgd291bGQKZXJyb25lb3VzbHkgYmUgY2FsbGVkIG9uIHRoYXQg
ZW50cnkuCgpQZXJoYXBzIHdvcnNlLCBpZiB3ZSB3ZXJlIHJhY2luZyB3aXRo
IGEgZGUtdmFsaWRhdGlvbiwgdGhlbiB3ZSBtaWdodApsZWF2ZSBib3RoIFBU
Rl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7IGFu
ZCB3aGVuCmRlLXZhbGlkYXRpb24gcGlja2VkIHVwIGFnYWluLCBib3RoIHRo
ZSB0eXBlIGFuZCB0aGUgZ2VuZXJhbCByZWYgd291bGQKYmUgZXJyb25lb3Vz
bHkgZHJvcHBlZCBmcm9tIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0uCgpJbiBh
IHNlbnNlLCB0aGUgcmVhbCBpc3N1ZSBoZXJlIGlzIGNvZGUgZHVwbGljYXRp
b24uICBSYXRoZXIgdGhhbgpkdXBsaWNhdGUgdGhlIGludGVycnVwdGlvbiBj
b2RlLCBzZXQgcmMgdG8gLUVJTlRSIGFuZCBmYWxsIHRocm91Z2ggdG8KdGhl
IGNvZGUgd2hpY2ggYWxyZWFkeSBoYW5kbGVzIHRoYXQgY2FzZSBjb3JyZWN0
bHkuCgpHaXZlbiB0aGUgbG9naWMgYXQgdGhpcyBwb2ludCwgaXQgc2hvdWxk
IGJlIGltcG9zc2libGUgZm9yCnBhcnRpYWxfZmxhZ3MgdG8gYmUgbm9uLXpl
cm87IGFkZCBhbiBBU1NFUlQoKSB0byBjYXRjaCBhbnkgY2hhbmdlcy4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMTggKysrKy0tLS0tLS0tLS0tLS0t
CiAxIGZpbGUgY2hhbmdlZCwgNCBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCmluZGV4IGNlN2Y1Yjg0ZjMuLjliOWI2N2NkNzQgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS5jCkBAIC0xNTc2LDEzICsxNTc2LDggQEAgc3RhdGljIGludCBhbGxv
Y19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBs
b25nIHR5cGUpCiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCAp
CiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAg
ewotICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwot
ICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVh
azsKLSAgICAgICAgfQotCi0gICAgICAgIGlmICggIWlzX2d1ZXN0X2wyX3Ns
b3QoZCwgdHlwZSwgaSkgfHwKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOwor
ICAgICAgICBlbHNlIGlmICggIWlzX2d1ZXN0X2wyX3Nsb3QoZCwgdHlwZSwg
aSkgfHwKICAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2wyZShw
bDJlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQogICAgICAg
ICAgICAgY29udGludWU7CiAKQEAgLTE2NDcsMTMgKzE2NDIsOCBAQCBzdGF0
aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCApCiAgICAgewog
ICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAmJiBo
eXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAgewotICAgICAg
ICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAg
ICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVhazsKLSAgICAg
ICAgfQotCi0gICAgICAgIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYm
IChpID09IDMpICkKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAg
ICBlbHNlIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYmIChpID09IDMp
ICkKICAgICAgICAgewogICAgICAgICAgICAgaWYgKCAhKGwzZV9nZXRfZmxh
Z3MocGwzZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSB8fAogICAgICAgICAgICAg
ICAgICAobDNlX2dldF9mbGFncyhwbDNlW2ldKSAmIGwzX2Rpc2FsbG93X21h
c2soZCkpICkKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Transfer-Encoding: base64

RnJvbSAyOWY1NmYwZTdjMTFhMjk5ZGE0OTdjODY2YjRjNzZlYmJjODYyMDQ1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA3LzExXSB4
ODYvbW06IEFsd2F5cyByZXRhaW4gYSBnZW5lcmFsIHJlZiBvbiBwYXJ0aWFs
CgpJbiBvcmRlciB0byBhbGxvdyByZWN1cnNpdmUgcGFnZXRhYmxlIHByb21v
dGlvbnMgYW5kIGRlbW90aW9ucyB0byBiZQppbnRlcnJ1cHRlZCwgWGVuIG11
c3Qga2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIHN1Yi1wYWdlcwpw
cm9tb3RlZCBvciBkZW1vdGVkLiAgVGhpcyBpcyBzdG9yZWQgaW4gdHdvIGVs
ZW1lbnRzIGluIHRoZSBwYWdlIHN0cnVjdDoKbnJfZW50cmllc192YWxpZGF0
ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpUaGUgcnVsZSBpcyB0aGF0IGVudHJp
ZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRhdGVkKSBzaG91bGQgYWx3YXlzIGJl
CnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdlbmVyYWwgcmVmZXJlbmNlIGNvdW50
LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6ZXJvLCB0aGVuIFtucl9lbnRyaWVz
X3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlkYXRlZCBhbmQgbm8gcmVmZXJlbmNl
CmNvdW50IGlzIGhlbGQuICBJZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0KaXMgcGFydGlhbGx5IHZhbGlk
YXRlZC4KCkF0IHRoZSBtb21lbnQsIGEgZGlzdGluY3Rpb24gaXMgbWFkZSBi
ZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVtb3Rpb24Kd2l0aCByZWdhcmQgdG8g
d2hldGhlciB0aGUgZW50cnkgaXRzZWxmICJob2xkcyIgYSBnZW5lcmFsIHJl
ZmVyZW5jZQpjb3VudDogd2hlbiBlbnRyeSBwcm9tb3Rpb24gaXMgaW50ZXJy
dXB0ZWQgKGkuZS4sIHJldHVybnMgLUVSRVNUQVJUKSwKdGhlIGVudHJ5IGlz
IG5vdCBjb25zaWRlcmVkIHRvIGhvbGQgYSByZWZlcmVuY2U7IHdoZW4gZW50
cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0ZWQsIHRoZSBlbnRyeSBpcyBzdGls
bCBjb25zaWRlcmVkIHRvIGhvbGQgYSBnZW5lcmFsCnJlZmVyZW5jZS4KClBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHVzZWQgdG8gZGlzdGluZ3Vpc2gg
YmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYgY2xlYXIsIGl0J3MgYSBwYXJ0aWFs
IHByb21vdGlvbiA9PiBubyBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBoZWxk
CmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBpdCdzIHBhcnRpYWwgZGVtb3Rpb24s
IHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UKY291bnQgaGVsZC4gIEJlY2F1c2Ug
cHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIGNhbiBiZSBpbnRlcmxlYXZlZCwg
dGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21fbCplLAp0byBiZSBhYmxlIHRvIHBy
b3Blcmx5IGhhbmRsZSByZWZlcmVuY2UgY291bnRzLgoKVW5mb3J0dW5hdGVs
eSwgYmVjYXVzZSBhIHJlZmNvdW50IGlzIG5vdCBoZWxkLCBpdCBpcyBwb3Nz
aWJsZSB0bwplbmdpbmVlciBhIHNpdHVhdGlvbiB3aGVyZSBQRlRfcGFydGlh
bF9zZXQgaXMgc2V0IGJ1dCB0aGUgcGFnZSBpbgpxdWVzdGlvbiBoYXMgYmVl
biBhc3NpZ25lZCB0byBhbm90aGVyIGRvbWFpbi4gIEEgc2tldGNoIGlzIHBy
b3ZpZGVkIGluCnRoZSBhcHBlbmRpeC4KCkZpeCB0aGlzIGJ5IGhhdmluZyB0
aGUgcGFyZW50IHBhZ2UgdGFibGUgZW50cnkgaG9sZCBhIGdlbmVyYWwKcmVm
ZXJlbmNlIGNvdW50IHdoZW5ldmVyIFBGVF9wYXJ0aWFsX3NldCBpcyBzZXQu
ICAoRm9yIGNsYXJpdHkgb2YKY2hhbmdlLCBrZWVwIHR3byBzZXBhcmF0ZSBm
bGFncy4gIFRoZXNlIHdpbGwgYmUgY29sbGFwc2VkIGluIGEKc3Vic2VxdWVu
dCBjaGFuZ2VzZXQuKQoKVGhpcyBoYXMgdHdvIGJhc2ljIGltcGxpY2F0aW9u
cy4gIE9uIHRoZSBwdXRfcGFnZV9mcm9tX2xOZSgpIHNpZGUsCnRoaXMgbWVh
biB0aGF0IHRoZSAocGFydGlhbF9zZXQgJiYgIXBhcnRpYWxfcmVmKSBjYXNl
IGNhbiBuZXZlciBoYXBwZW4sCmFuZCBubyBsb25nZXIgbmVlZHMgdG8gYmUg
c3BlY2lhbC1jYXNlZC4KClNlY29uZGx5LCBiZWNhdXNlIGJvdGggZmxhZ3Mg
YXJlIHNldCB0b2dldGhlciwgdGhlcmUncyBubyBuZWVkIHRvIGNhcnJ5IG92
ZXIKZXhpc3RpbmcgYml0cyBmcm9tIHBhcnRpYWxfcHRlLgoKKE5CIHRoZXJl
IGlzIHN0aWxsIGFub3RoZXIgaXNzdWUgd2l0aCBjYWxsaW5nIF9wdXRfcGFn
ZV90eXBlKCkgb24gYQpwYWdlIHdoaWNoIGhhZCBQR1RfcGFydGlhbCBzZXQ7
IHRoYXQgd2lsbCBiZSBoYW5kbGVkIGluIGEgc3Vic2VxdWVudApwYXRjaC4p
CgpPbiB0aGUgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oKSBzaWRlLCB3
ZSBuZWVkIHRvIGRpc3Rpbmd1aXNoCmJldHdlZW4gY2FsbGVycyB3aGljaCBo
b2xkIGEgcmVmZXJlbmNlIG9uIHBhcnRpYWwgKGkuZS4sCmFsbG9jX2xOX3Rh
YmxlKCkpLCBhbmQgdGhvc2Ugd2hpY2ggZG8gbm90IChuZXdfY3IzLCBQSU5f
TE5fVEFCTEUsIGFuZApzbyBvbik6IHBhc3MgYSBmbGFnIGlmIHRoZSB0eXBl
IHNob3VsZCBiZSByZXRhaW5lZCBvbiBpbnRlcnJ1cHRpb24uCgpOQiB0aGF0
IHNpbmNlIGwxIHByb21vdGlvbiBjYW4ndCBiZSBwcmVlbXB0ZWQsIHRoYXQg
Z2V0X3BhZ2VfZnJvbV9sMmUKY2FuJ3QgcmV0dXJuIC1FUkVTVEFSVC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0tLQoqIEFwcGVuZGl4OiBFbmdpbmVlcmluZyBQVEZfcGFydGlhbF9zZXQg
d2hpbGUgYSBwYWdlIGJlbG9uZ3MgdG8gYQogIGZvcmVpZ24gZG9tYWluCgpT
dXBwb3NlIEEgaXMgYSBwYWdlIHdoaWNoIGNhbiBiZSBwcm9tb3RlZCB0byBh
biBsMywgYW5kIEIgaXMgYSBwYWdlCndoaWNoIGNhbiBiZSBwcm9tb3RlZCB0
byBhbiBsMiwgYW5kIEFbeF0gcG9pbnRzIHRvIEIuICBCIGhhcwpQR0NfYWxs
b2NhdGVkIHNldCBidXQgbm8gb3RoZXIgZ2VuZXJhbCByZWZlcmVuY2VzLgoK
VjE6ICBQSU5fTDMgQS4KICBBIGlzIHZhbGlkYXRlZCwgQiBpcyB2YWxpZGF0
ZWQuCiAgQS50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQgfCBQR1Rf
cGlubmVkCiAgQi50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBC
LmNvdW50ID0gMiB8IFBHQ19hbGxvY2F0ZWQgKEFbeF0gaG9sZHMgYSBnZW5l
cmFsIHJlZikKClYxOiBVTlBJTiBBLgogIEEgYmVnaW5zIGRlLXZhbGlkYXRp
b24uCiAgQXJyYW5nZSB0byBiZSBpbnRlcnJ1cHRlZCB3aGVuIGkgPCB4CiAg
VjEtPm9sZF9ndWVzdF90YWJsZSA9IEEKICBWMS0+b2xkX2d1ZXN0X3RhYmxl
X3JlZl9oZWxkID0gZmFsc2UKICBBLnR5cGVfY291bnQgPSAxIHwgUEdUX3Bh
cnRpYWwKICBBLm5yX3ZhbGlkYXRlZF9lbnRyaWVzID0gaSA8IHgKICBCLnR5
cGVfY291bnQgPSAwCiAgQi5jb3VudCA9IDEgfCBQR0NfYWxsb2NhdGVkCgpW
MjogTU9EX0w0X0VOVFJZIHRvIHBvaW50IHNvbWUgbDRlIHRvIEEuCiAgUGlj
a3MgdXAgcmUtdmFsaWRhdGlvbiBvZiBBLgogIEFycmFuZ2UgdG8gYmUgaW50
ZXJydXB0ZWQgaGFsZndheSB0aHJvdWdoIEIncyB2YWxpZGF0aW9uCiAgQi50
eXBlX2NvdW50ID0gMSB8IFBHVF9wYXJ0aWFsCiAgQi5jb3VudCA9IDIgfCBQ
R0NfYWxsb2NhdGVkIChQR1RfcGFydGlhbCBob2xkcyBhIGdlbmVyYWwgcmVm
KQogIEEudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFs
aWRhdGVkX2VudHJpZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IFBURl9wYXJ0
aWFsX3NldAoKVjM6IE1PRF9MM19FTlRSWSB0byBwb2ludCBzb21lIG90aGVy
IGwzZSAobm90IGluIEEpIHRvIEIuCiAgVmFsaWRhdGVzIEIuCiAgQi50eXBl
X2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBCLmNvdW50ID0gMiB8IFBH
Q19hbGxvY2F0ZWQgKCJvdGhlciBsM2UiIGhvbGRzIGEgZ2VuZXJhbCByZWYp
CgpWMzogTU9EX0wzX0VOVFJZIHRvIGNsZWFyIGwzZSBwb2ludGluZyB0byBC
LgogIERldmFsaWRhdGVzIEIuCiAgQi50eXBlX2NvdW50ID0gMAogIEIuY291
bnQgPSAxIHwgUEdDX2FsbG9jYXRlZAoKVjM6IGRlY3JlYXNlX3Jlc2VydmF0
aW9uKEIpCiAgQ2xlYXJzIFBHQ19hbGxvY2F0ZWQKICBCLmNvdW50ID0gMCA9
PiBCIGlzIGZyZWVkCgpCIGdldHMgYXNzaWduZWQgdG8gYSBkaWZmZXJlbnQg
ZG9tYWluCgpWMTogUmVzdGFydHMgVU5QSU4gb2YgQQogIHB1dF9vbGRfZ3Vl
c3RfdGFibGUoQSkKICAgIC4uLgogICAgICBmcmVlX2wzX3RhYmxlKEEpCgpO
b3cgc2luY2UgQS5wYXJ0aWFsX2ZsYWdzIGhhcyBQVEZfcGFydGlhbF9zZXQs
IGZyZWVfbDNfdGFibGUoKSB3aWxsCmNhbGwgcHV0X3BhZ2VfZnJvbV9sM2Uo
KSBvbiBBW3hdLCB3aGljaCBwb2ludHMgdG8gQiwgd2hpbGUgQiBpcyBvd25l
ZApieSBhbm90aGVyIGRvbWFpbi4KCklmIEFbeF0gaGVsZCBhIGdlbmVyYWwg
cmVmY291bnQgZm9yIEIgb24gcGFydGlhbCB2YWxpZGF0aW9uLCBhcyBpdCBk
b2VzCmZvciBwYXJ0aWFsIGRlLXZhbGlkYXRpb24sIHRoZW4gQiB3b3VsZCBz
dGlsbCBoYXZlIGEgcmVmZXJlbmNlIGNvdW50IG9mCjEgYWZ0ZXIgUEdDX2Fs
bG9jYXRlZCB3YXMgZnJlZWQ7IHNvIEIgd291bGRuJ3QgYmUgZnJlZWQgdW50
aWwgYWZ0ZXIKcHV0X3BhZ2VfZnJvbV9sM2UoKSBoYWQgaGFwcGVuZCBvbiBB
W3hdLgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jICAgICAgICB8IDg0ICsrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaCB8IDE1ICsrKystLS0KIDIgZmlsZXMgY2hhbmdl
ZCwgNTggaW5zZXJ0aW9ucygrKSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwpp
bmRleCA5YjliNjdjZDc0Li4yZjE4NWEzY2QzIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNjU4
LDEwICs2NTgsMTEgQEAgc3RhdGljIGludCBfX2dldF9wYWdlX3R5cGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogICog
cGFnZS0+cHRlW3BhZ2UtPm5yX3ZhbGlkYXRlZF9lbnRyaWVzXS4gIFNlZSB0
aGUgY29tbWVudCBpbiBtbS5oIGZvcgogICogbW9yZSBpbmZvcm1hdGlvbi4K
ICAqLwotI2RlZmluZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAoMSA8PCAw
KQotI2RlZmluZSBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiAoMSA8PCAxKQot
I2RlZmluZSBQVEZfcHJlZW1wdGlibGUgICAgICAgICAoMSA8PCAyKQotI2Rl
ZmluZSBQVEZfZGVmZXIgICAgICAgICAgICAgICAoMSA8PCAzKQorI2RlZmlu
ZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAgICgxIDw8IDApCisjZGVmaW5l
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmICAgKDEgPDwgMSkKKyNkZWZpbmUg
UFRGX3ByZWVtcHRpYmxlICAgICAgICAgICAoMSA8PCAyKQorI2RlZmluZSBQ
VEZfZGVmZXIgICAgICAgICAgICAgICAgICgxIDw8IDMpCisjZGVmaW5lIFBU
Rl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQgKDEgPDwgNCkKIAogc3RhdGljIGlu
dCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICBtZm5fdCBtZm4s
IHVuc2lnbmVkIGxvbmcgdHlwZSwgc3RydWN0IGRvbWFpbiAqZCwKQEAgLTY3
MCw3ICs2NzEsMTEgQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9m
cm9tX21mbigKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3Rv
X3BhZ2UobWZuKTsKICAgICBpbnQgcmM7CiAgICAgYm9vbCBwcmVlbXB0aWJs
ZSA9IGZsYWdzICYgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAgcGFydGlh
bF9yZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAg
ICAgICAgcGFydGlhbF9yZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVy
YWxfcmVmLAorICAgICAgICAgcGFydGlhbF9zZXQgPSBmbGFncyAmIFBURl9w
YXJ0aWFsX3NldCwKKyAgICAgICAgIHJldGFpbl9yZWYgID0gZmxhZ3MgJiBQ
VEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0OworCisgICAgQVNTRVJUKHBhcnRp
YWxfcmVmID09IHBhcnRpYWxfc2V0KTsKIAogICAgIGlmICggbGlrZWx5KCFw
YXJ0aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9m
cm9tX21mbihtZm4sIGQpKSApCkBAIC02ODMsMTMgKzY4OCwxNSBAQCBzdGF0
aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAogICAgICAqIC0g
cGFnZSBpcyBmdWxseSB2YWxpZGF0ZWQgKHJjID09IDApCiAgICAgICogLSBw
YWdlIGlzIG5vdCB2YWxpZGF0ZWQgKHJjIDwgMCkgYnV0OgogICAgICAqICAg
LSBXZSBjYW1lIGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfcmVmKQor
ICAgICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgKHJjID09
IC1FUkVTVEFSVCksIGFuZCB0aGUKKyAgICAgKiAgICAgY2FsbGVyIGhhcyBh
c2tlZCB0aGUgcmVmIHRvIGJlIHJldGFpbmVkIGluIHRoYXQgY2FzZQogICAg
ICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0IHRoZXJl
J3MgYmVlbiBhbiBlcnJvcgogICAgICAqICAgICAocGFnZSA9PSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkKICAgICAgKgogICAgICAqIFRoZSBw
YXJ0aWFsX3JlZi1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4gZXhwbGFu
YXRpb24uICBUaGVyZQogICAgICAqIGFyZSB0d28gc2NlbmFyaW9zIHdoZXJl
IHBhcnRpYWxfcmVmIG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgotICAgICAq
IC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBkZW1vdGVkIGFzIHR5cGUgYHR5
cGVgOyBpLmUuIGhhcwotICAgICAqICAgUEdUX3BhcnRpYWwgc2V0CisgICAg
ICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IHByb21vdGVkIC8gZGVtb3Rl
ZCBhcyB0eXBlIGB0eXBlYDsKKyAgICAgKiAgIGkuZS4gaGFzIFBHVF9wYXJ0
aWFsIHNldAogICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBkZW1v
dGVkIGFzIEwodHlwZSsxKSAoaS5lLiwgYSBsaW5lYXIKICAgICAgKiAgIHBh
Z2U7IGUuZy4gd2UncmUgYmVpbmcgY2FsbGVkIGZyb20gZ2V0X3BhZ2VfZnJv
bV9sMmUgd2l0aAogICAgICAqICAgdHlwZSA9PSBQR1RfbDFfdGFibGUsIGJ1
dCB0aGUgbWZuIGlzIFBHVF9sMl90YWJsZSkKQEAgLTcxMiw3ICs3MTksOCBA
QCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAogICAg
ICAqLwogICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9yZWYgKQog
ICAgICAgICAvKiBub3RoaW5nICovOwotICAgIGVsc2UgaWYgKCBwYWdlID09
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlICkKKyAgICBlbHNlIGlm
ICggcGFnZSA9PSBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSB8fAor
ICAgICAgICAgICAgICAocmV0YWluX3JlZiAmJiByYyA9PSAtRVJFU1RBUlQp
ICkKICAgICAgICAgQVNTRVJUKHByZWVtcHRpYmxlKTsKICAgICBlbHNlCiAg
ICAgICAgIHB1dF9wYWdlKHBhZ2UpOwpAQCAtMTM3OSw4ICsxMzg3LDggQEAg
c3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJl
LCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgaWYgKCAoZmxhZ3MgJiAo
UFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9
PQogICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAgICB7
Ci0gICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwot
ICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVt
cHRpYmxlLCBwdHBnKTsKKyAgICAgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNo
b3VsZCBhbHdheXMgaW1wbHkgcGFydGlhbF9yZWYgKi8KKyAgICAgICAgICAg
IEJVRygpOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCBmbGFncyAm
IFBURl9kZWZlciApCiAgICAgICAgIHsKQEAgLTE0MjUsOCArMTQzMyw4IEBA
IHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwz
ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgaWYgKCAoZmxhZ3MgJiAoUFRG
X3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQog
ICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICB7Ci0gICAgICAgIEFT
U0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7Ci0gICAgICAgIHJldHVybiBf
cHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFn
ZShfbWZuKHBmbikpKTsKKyAgICAgICAgLyogcGFydGlhbF9zZXQgc2hvdWxk
IGFsd2F5cyBpbXBseSBwYXJ0aWFsX3JlZiAqLworICAgICAgICBCVUcoKTsK
ICAgICB9CiAKICAgICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKQEAgLTE0
NTYsOCArMTQ2NCw4IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUo
bDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAg
IGlmICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmKSkgPT0KICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxf
c2V0ICkKICAgICAgICAgewotICAgICAgICAgICAgQVNTRVJUKCEoZmxhZ3Mg
JiBQVEZfZGVmZXIpKTsKLSAgICAgICAgICAgIHJldHVybiBfcHV0X3BhZ2Vf
dHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShfbWZuKHBm
bikpKTsKKyAgICAgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdh
eXMgaW1wbHkgcGFydGlhbF9yZWYgKi8KKyAgICAgICAgICAgIEJVRygpOwog
ICAgICAgICB9CiAKICAgICAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciAp
CkBAIC0xNTgxLDEzICsxNTg5LDIyIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0
eXBlKQogICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDJlKHBs
MmVbaV0sIHBmbiwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCiAgICAgICAg
ICAgICBjb250aW51ZTsKIAotICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFS
VCApCi0gICAgICAgIHsKLSAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRl
ZF9wdGVzID0gaTsKLSAgICAgICAgICAgIC8qIFNldCAnc2V0JywgcmV0YWlu
ICdnZW5lcmFsIHJlZicgKi8KLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxf
ZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OwotICAg
ICAgICB9Ci0gICAgICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSAp
CisgICAgICAgIC8qCisgICAgICAgICAqIEl0IHNob3VsZG4ndCBiZSBwb3Nz
aWJsZSBmb3IgZ2V0X3BhZ2VfZnJvbV9sMmUgdG8gcmV0dXJuCisgICAgICAg
ICAqIC1FUkVTVEFSVCwgc2luY2Ugd2UgbmV2ZXIgY2FsbCB0aGlzIHdpdGgg
UFRGX3ByZWVtcHRpYmxlLgorICAgICAgICAgKiAoYWxsb2NfbDFfdGFibGUg
bWF5IHJldHVybiAtRUlOVFIgb24gYW4gTDFURi12dWxuZXJhYmxlCisgICAg
ICAgICAqIGVudHJ5LikKKyAgICAgICAgICoKKyAgICAgICAgICogTkIgdGhh
dCB3aGlsZSBvbiBhICJjbGVhbiIgcHJvbW90aW9uLCB3ZSBjYW4gbmV2ZXIg
Z2V0CisgICAgICAgICAqIFBHVF9wYXJ0aWFsLiAgSXQgaXMgcG9zc2libGUg
dG8gYXJyYW5nZSBmb3IgYW4gbDJlIHRvCisgICAgICAgICAqIGNvbnRhaW4g
YSBwYXJ0aWFsbHktZGV2YWxpZGF0ZWQgbDI7IGJ1dCBpbiB0aGF0IGNhc2Us
IGJvdGgKKyAgICAgICAgICogb2YgdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMg
d2lsbCBmYWlsIGFueXdheSAodGhlIGZpcnN0CisgICAgICAgICAqIGJlY2F1
c2UgdGhlIHBhZ2UgaW4gcXVlc3Rpb24gaXMgbm90IGFuIGwxOyB0aGUgc2Vj
b25kCisgICAgICAgICAqIGJlY2F1c2UgdGhlIHBhZ2UgaXMgbm90IGZ1bGx5
IHZhbGlkYXRlZCkuCisgICAgICAgICAqLworICAgICAgICBBU1NFUlQocmMg
IT0gLUVSRVNUQVJUKTsKKworICAgICAgICBpZiAoIHJjID09IC1FSU5UUiAm
JiBpICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgPSBpOwogICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IDA7CkBAIC0xNTk2LDYgKzE2MTMsNyBAQCBzdGF0aWMgaW50IGFsbG9j
X2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxv
bmcgdHlwZSkKICAgICAgICAgZWxzZSBpZiAoIHJjIDwgMCAmJiByYyAhPSAt
RUlOVFIgKQogICAgICAgICB7CiAgICAgICAgICAgICBnZHByaW50ayhYRU5M
T0dfV0FSTklORywgIkZhaWx1cmUgaW4gYWxsb2NfbDJfdGFibGU6IHNsb3Qg
JSN4XG4iLCBpKTsKKyAgICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBOVUxMKTsKICAgICAgICAgICAgIGlmICgg
aSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcGFnZS0+bnJf
dmFsaWRhdGVkX3B0ZXMgPSBpOwpAQCAtMTY1MiwxNiArMTY3MCwxNyBAQCBz
dGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgICAgICAgICAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9m
cm9tX21mbigKICAgICAgICAgICAgICAgICAgICAgbDNlX2dldF9tZm4ocGwz
ZVtpXSksCiAgICAgICAgICAgICAgICAgICAgIFBHVF9sMl9wYWdlX3RhYmxl
IHwgUEdUX3BhZV94ZW5fbDIsIGQsCi0gICAgICAgICAgICAgICAgICAgIHBh
cnRpYWxfZmxhZ3MgfCBQVEZfcHJlZW1wdGlibGUpOworICAgICAgICAgICAg
ICAgICAgICBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlIHwgUFRG
X3JldGFpbl9yZWZfb25fcmVzdGFydCk7CiAgICAgICAgIH0KLSAgICAgICAg
ZWxzZSBpZiAoIChyYyA9IGdldF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0sIHBm
biwgZCwgcGFydGlhbF9mbGFncykpID4gMCApCisgICAgICAgIGVsc2UgaWYg
KCAocmMgPSBnZXRfcGFnZV9mcm9tX2wzZShwbDNlW2ldLCBwZm4sIGQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8
IFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQpKSA+IDAgKQogICAgICAgICAg
ICAgY29udGludWU7CiAKICAgICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQg
KQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7CiAgICAgICAgICAgICAvKiBTZXQgJ3NldCcsIGxlYXZlICdn
ZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNldCAqLwotICAg
ICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3Mg
fCBQVEZfcGFydGlhbF9zZXQ7CisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFs
X2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWY7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjID09IC1F
SU5UUiAmJiBpICkKICAgICAgICAgewpAQCAtMTgyMiwxNCArMTg0MSwxNSBA
QCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2UpCiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCApCiAg
ICAgewogICAgICAgICBpZiAoICFpc19ndWVzdF9sNF9zbG90KGQsIGkpIHx8
Ci0gICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sNGUocGw0ZVtp
XSwgcGZuLCBkLCBwYXJ0aWFsX2ZsYWdzKSkgPiAwICkKKyAgICAgICAgICAg
ICAocmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShwbDRlW2ldLCBwZm4sIGQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8
IFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQpKSA+IDAgKQogICAgICAgICAg
ICAgY29udGludWU7CiAKICAgICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQg
KQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7CiAgICAgICAgICAgICAvKiBTZXQgJ3NldCcsIGxlYXZlICdn
ZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNldCAqLwotICAg
ICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3Mg
fCBQVEZfcGFydGlhbF9zZXQ7CisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFs
X2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWY7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjIDwgMCAp
CiAgICAgICAgIHsKQEAgLTE5MjcsOSArMTk0Nyw3IEBAIHN0YXRpYyBpbnQg
ZnJlZV9sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIGVs
c2UgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0
aWFsX2ZsYWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQp
ID8KLSAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgotICAgICAgICAgICAg
KFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsK
KyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3Nl
dCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogICAgIH0KICAgICBlbHNl
IGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMMl9QQUdFVEFCTEVfRU5UUklF
UyAtIDEgKQogICAgIHsKQEAgLTE5NzcsOSArMTk5NSw3IEBAIHN0YXRpYyBp
bnQgZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
IGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2Ut
Pm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlh
bF9mbGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/
Ci0gICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoKLSAgICAgICAgICAgIChQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7Cisg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQg
fCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKICAgICB9CiAgICAgZWxzZSBp
ZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDNfUEFHRVRBQkxFX0VOVFJJRVMg
LSAxICkKICAgICB7CkBAIC0yMDEwLDkgKzIwMjYsNyBAQCBzdGF0aWMgaW50
IGZyZWVfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBp
ZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5u
cl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxf
ZmxhZ3MgPSAocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgPwot
ICAgICAgICAgICAgcGFydGlhbF9mbGFncyA6Ci0gICAgICAgICAgICAoUFRG
X3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpOworICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CiAgICAgfQogICAgIGVsc2UgaWYg
KCByYyA9PSAtRUlOVFIgJiYgaSA8IEw0X1BBR0VUQUJMRV9FTlRSSUVTIC0g
MSApCiAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9t
bS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCmluZGV4IGE1MzFmZTMx
MTUuLjc0YjAyNDZjMDIgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14
ODYvbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKQEAgLTE2
NywyMiArMTY3LDI1IEBAIHN0cnVjdCBwYWdlX2luZm8KICAgICAgICAgICog
cGFnZS4KICAgICAgICAgICoKICAgICAgICAgICogVGhpcyBoYXBwZW5zOgot
ICAgICAgICAgKiAtIER1cmluZyBkZS12YWxpZGF0aW9uLCBpZiBkZS12YWxp
ZGF0aW9uIG9mIHRoZSBwYWdlIHdhcworICAgICAgICAgKiAtIER1cmluZyB2
YWxpZGF0aW9uIG9yIGRlLXZhbGlkYXRpb24sIGlmIHRoZSBvcGVyYXRpb24g
d2FzCiAgICAgICAgICAqICAgaW50ZXJydXB0ZWQKICAgICAgICAgICogLSBE
dXJpbmcgdmFsaWRhdGlvbiwgaWYgYW4gaW52YWxpZCBlbnRyeSBpcyBlbmNv
dW50ZXJlZCBhbmQKICAgICAgICAgICogICB2YWxpZGF0aW9uIGlzIHByZWVt
cHRpYmxlCiAgICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIFBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIHdhcyBzZXQgb24KLSAgICAgICAgICog
ICB0aGlzIGVudHJ5IHRvIGJlZ2luIHdpdGggKHBlcmhhcHMgYmVjYXVzZSB3
ZSdyZSBwaWNraW5nCi0gICAgICAgICAqICAgdXAgZnJvbSBhIHBhcnRpYWwg
ZGUtdmFsaWRhdGlvbikuCisgICAgICAgICAqICAgdGhpcyBlbnRyeSB0byBi
ZWdpbiB3aXRoIChwZXJoYXBzIGJlY2F1c2UgaXQgcGlja2VkIHVwIGEKKyAg
ICAgICAgICogICBwcmV2aW91cyBvcGVyYXRpb24pCiAgICAgICAgICAqCi0g
ICAgICAgICAqIFdoZW4gcmVzdW1pbmcgdmFsaWRhdGlvbiwgaWYgUFRGX3Bh
cnRpYWxfZ2VuZXJhbF9yZWYgaXMgY2xlYXIsCi0gICAgICAgICAqIHRoZW4g
YSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVpcmVkOyBpZiBp
dCBpcyBzZXQsIG5vCi0gICAgICAgICAqIHJlZmVyZW5jZSBzaG91bGQgYmUg
YWNxdWlyZWQuCisgICAgICAgICAqIFdoZW4gcmVzdW1pbmcgdmFsaWRhdGlv
biwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMKKyAgICAgICAgICog
Y2xlYXIsIHRoZW4gYSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFj
cXVpcmVkOyBpZiBpdAorICAgICAgICAgKiBpcyBzZXQsIG5vIHJlZmVyZW5j
ZSBzaG91bGQgYmUgYWNxdWlyZWQuCiAgICAgICAgICAqCiAgICAgICAgICAq
IFdoZW4gcmVzdW1pbmcgZGUtdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYgaXMKICAgICAgICAgICogY2xlYXIsIG5vIHJlZmVyZW5j
ZSBzaG91bGQgYmUgZHJvcHBlZDsgaWYgaXQgaXMgc2V0LCBhCiAgICAgICAg
ICAqIHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZC4KICAgICAgICAgICoK
KyAgICAgICAgICogTkIgYXQgdGhlIG1vbWVudCwgUFRGX3BhcnRpYWxfc2V0
IHNob3VsZCBiZSBzZXQgaWYgYW5kIG9ubHkgaWYKKyAgICAgICAgICogUFRG
X3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0LgorICAgICAgICAgKgogICAg
ICAgICAgKiBOQiB0aGF0IFBURl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRp
YWxfZ2VuZXJhbF9yZWYgYXJlCiAgICAgICAgICAqIGRlZmluZWQgaW4gbW0u
YywgdGhlIG9ubHkgcGxhY2Ugd2hlcmUgdGhleSBhcmUgdXNlZC4KICAgICAg
ICAgICoKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Transfer-Encoding: base64

RnJvbSAxNDBjODg3NjgzNWExMzRkYWY1MDdkNmM2MGJkY2RmOTEyNmYxNjZm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA4LzExXSB4
ODYvbW06IENvbGxhcHNlIFBURl9wYXJ0aWFsX3NldCBhbmQKIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGludG8gb25lCgouLi5ub3cgdGhhdCB0aGV5IGFy
ZSBlcXVpdmFsZW50LiAgTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQu
CgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21tLmMg
ICAgICAgIHwgNTAgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIHwgMjkgKysrKysr
KysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAyZjE4NWEz
Y2QzLi42OTM3OTEzMzFhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNjUzLDEzICs2NTMsMTIg
QEAgc3RhdGljIGludCBfX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogCiAvKgogICogVGhlIGZv
bGxvd2luZyBmbGFncyBhcmUgdXNlZCB0byBzcGVjaWZ5IGJlaGF2aW9yIG9m
IHZhcmlvdXMgZ2V0IGFuZAotICogcHV0IGNvbW1hbmRzLiAgVGhlIGZpcnN0
IHR3byBhcmUgYWxzbyBzdG9yZWQgaW4gcGFnZS0+cGFydGlhbF9mbGFncwot
ICogdG8gaW5kaWNhdGUgdGhlIHN0YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQg
dG8gYnkKKyAqIHB1dCBjb21tYW5kcy4gIFRoZSBmaXJzdCBpcyBhbHNvIHN0
b3JlZCBpbiBwYWdlLT5wYXJ0aWFsX2ZsYWdzIHRvCisgKiBpbmRpY2F0ZSB0
aGUgc3RhdGUgb2YgdGhlIHBhZ2UgcG9pbnRlZCB0byBieQogICogcGFnZS0+
cHRlW3BhZ2UtPm5yX3ZhbGlkYXRlZF9lbnRyaWVzXS4gIFNlZSB0aGUgY29t
bWVudCBpbiBtbS5oIGZvcgogICogbW9yZSBpbmZvcm1hdGlvbi4KICAqLwog
I2RlZmluZSBQVEZfcGFydGlhbF9zZXQgICAgICAgICAgICgxIDw8IDApCi0j
ZGVmaW5lIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmICAgKDEgPDwgMSkKICNk
ZWZpbmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgICAoMSA8PCAyKQogI2Rl
ZmluZSBQVEZfZGVmZXIgICAgICAgICAgICAgICAgICgxIDw8IDMpCiAjZGVm
aW5lIFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQgKDEgPDwgNCkKQEAgLTY3
MSwxMyArNjcwLDEwIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVf
ZnJvbV9tZm4oCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IG1mbl90
b19wYWdlKG1mbik7CiAgICAgaW50IHJjOwogICAgIGJvb2wgcHJlZW1wdGli
bGUgPSBmbGFncyAmIFBURl9wcmVlbXB0aWJsZSwKLSAgICAgICAgIHBhcnRp
YWxfcmVmID0gZmxhZ3MgJiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiwKICAg
ICAgICAgIHBhcnRpYWxfc2V0ID0gZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQs
CiAgICAgICAgICByZXRhaW5fcmVmICA9IGZsYWdzICYgUFRGX3JldGFpbl9y
ZWZfb25fcmVzdGFydDsKIAotICAgIEFTU0VSVChwYXJ0aWFsX3JlZiA9PSBw
YXJ0aWFsX3NldCk7Ci0KLSAgICBpZiAoIGxpa2VseSghcGFydGlhbF9yZWYp
ICYmCisgICAgaWYgKCBsaWtlbHkoIXBhcnRpYWxfc2V0KSAmJgogICAgICAg
ICAgdW5saWtlbHkoIWdldF9wYWdlX2Zyb21fbWZuKG1mbiwgZCkpICkKICAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKQEAgLTY4NywxNCArNjgzLDE0IEBA
IHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAg
ICogUmV0YWluIHRoZSByZWZjb3VudCBpZjoKICAgICAgKiAtIHBhZ2UgaXMg
ZnVsbHkgdmFsaWRhdGVkIChyYyA9PSAwKQogICAgICAqIC0gcGFnZSBpcyBu
b3QgdmFsaWRhdGVkIChyYyA8IDApIGJ1dDoKLSAgICAgKiAgIC0gV2UgY2Ft
ZSBpbiB3aXRoIGEgcmVmZXJlbmNlIChwYXJ0aWFsX3JlZikKKyAgICAgKiAg
IC0gV2UgY2FtZSBpbiB3aXRoIGEgcmVmZXJlbmNlIChwYXJ0aWFsX3NldCkK
ICAgICAgKiAgIC0gcGFnZSBpcyBwYXJ0aWFsbHkgdmFsaWRhdGVkIChyYyA9
PSAtRVJFU1RBUlQpLCBhbmQgdGhlCiAgICAgICogICAgIGNhbGxlciBoYXMg
YXNrZWQgdGhlIHJlZiB0byBiZSByZXRhaW5lZCBpbiB0aGF0IGNhc2UKICAg
ICAgKiAgIC0gcGFnZSBpcyBwYXJ0aWFsbHkgdmFsaWRhdGVkIGJ1dCB0aGVy
ZSdzIGJlZW4gYW4gZXJyb3IKICAgICAgKiAgICAgKHBhZ2UgPT0gY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUpCiAgICAgICoKLSAgICAgKiBUaGUg
cGFydGlhbF9yZWYtb24tZXJyb3IgY2xhdXNlIGlzIHdvcnRoIGFuIGV4cGxh
bmF0aW9uLiAgVGhlcmUKLSAgICAgKiBhcmUgdHdvIHNjZW5hcmlvcyB3aGVy
ZSBwYXJ0aWFsX3JlZiBtaWdodCBiZSB0cnVlIGNvbWluZyBpbjoKKyAgICAg
KiBUaGUgcGFydGlhbF9zZXQtb24tZXJyb3IgY2xhdXNlIGlzIHdvcnRoIGFu
IGV4cGxhbmF0aW9uLiAgVGhlcmUKKyAgICAgKiBhcmUgdHdvIHNjZW5hcmlv
cyB3aGVyZSBwYXJ0aWFsX3NldCBtaWdodCBiZSB0cnVlIGNvbWluZyBpbjoK
ICAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgcHJvbW90ZWQgLyBk
ZW1vdGVkIGFzIHR5cGUgYHR5cGVgOwogICAgICAqICAgaS5lLiBoYXMgUEdU
X3BhcnRpYWwgc2V0CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5
IGRlbW90ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgpAQCAtNzE3
LDcgKzcxMyw3IEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4oCiAgICAgICogY291bnQgcmV0YWluZWQgdW5sZXNzIHdlIHN1Y2Nl
ZWRlZCwgb3IgdGhlIG9wZXJhdGlvbiB3YXMKICAgICAgKiBwcmVlbXB0aWJs
ZS4KICAgICAgKi8KLSAgICBpZiAoIGxpa2VseSghcmMpIHx8IHBhcnRpYWxf
cmVmICkKKyAgICBpZiAoIGxpa2VseSghcmMpIHx8IHBhcnRpYWxfc2V0ICkK
ICAgICAgICAgLyogbm90aGluZyAqLzsKICAgICBlbHNlIGlmICggcGFnZSA9
PSBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSB8fAogICAgICAgICAg
ICAgICAocmV0YWluX3JlZiAmJiByYyA9PSAtRVJFU1RBUlQpICkKQEAgLTEz
ODQsMTMgKzEzODAsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJl
KGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGwyZV9nZXRfcGFnZShsMmUpOwog
ICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwdHBnID0gbWZuX3RvX3BhZ2Uo
X21mbihwZm4pKTsKIAotICAgICAgICBpZiAoIChmbGFncyAmIChQVEZfcGFy
dGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09Ci0gICAg
ICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCi0gICAgICAgIHsKLSAgICAg
ICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdheXMgaW1wbHkgcGFy
dGlhbF9yZWYgKi8KLSAgICAgICAgICAgIEJVRygpOwotICAgICAgICB9Ci0g
ICAgICAgIGVsc2UgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCisgICAgICAg
IGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gcHRwZzsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGc7
CkBAIC0xNDMwLDEzICsxNDIwLDYgQEAgc3RhdGljIGludCBwdXRfcGFnZV9m
cm9tX2wzZShsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwK
IAogICAgIHBnID0gbDNlX2dldF9wYWdlKGwzZSk7CiAKLSAgICBpZiAoIChm
bGFncyAmIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFs
X3JlZikpID09Ci0gICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQotICAgIHsK
LSAgICAgICAgLyogcGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBseSBw
YXJ0aWFsX3JlZiAqLwotICAgICAgICBCVUcoKTsKLSAgICB9Ci0KICAgICBp
ZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKICAgICB7CiAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBtZm5fdG9fcGFnZShfbWZuKHBm
bikpOwpAQCAtMTQ2MSwxMyArMTQ0NCw2IEBAIHN0YXRpYyBpbnQgcHV0X3Bh
Z2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBw
Zm4sCiAgICAgewogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGw0
ZV9nZXRfcGFnZShsNGUpOwogCi0gICAgICAgIGlmICggKGZsYWdzICYgKFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0K
LSAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKLSAgICAgICAgewot
ICAgICAgICAgICAgLyogcGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBs
eSBwYXJ0aWFsX3JlZiAqLwotICAgICAgICAgICAgQlVHKCk7Ci0gICAgICAg
IH0KLQogICAgICAgICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKICAgICAg
ICAgewogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRw
ZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CkBAIC0xNjgwLDcgKzE2NTYs
NyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UpCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzID0gaTsKICAgICAgICAgICAgIC8qIFNldCAnc2V0Jywg
bGVhdmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMgc2V0
ICovCi0gICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CisgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0Owog
ICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYg
aSApCiAgICAgICAgIHsKQEAgLTE4NDksNyArMTgyNSw3IEBAIHN0YXRpYyBp
bnQgYWxsb2NfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAg
ICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
PSBpOwogICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJh
bCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAgICAgICAgIHBhZ2UtPnBh
cnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CiAgICAgICAgIH0KICAg
ICAgICAgZWxzZSBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsKQEAgLTE5NDcs
NyArMTkyMyw3IEBAIHN0YXRpYyBpbnQgZnJlZV9sMl90YWJsZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIGVsc2UgaWYgKCByYyA9PSAtRVJFU1RB
UlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
PSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRp
YWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CisgICAgICAgIHBh
Z2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CiAgICAgfQog
ICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJM
RV9FTlRSSUVTIC0gMSApCiAgICAgewpAQCAtMTk5NSw3ICsxOTcxLDcgQEAg
c3RhdGljIGludCBmcmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAg
ICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRp
YWxfZ2VuZXJhbF9yZWY7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3Mg
PSBQVEZfcGFydGlhbF9zZXQ7CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9
PSAtRUlOVFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAg
ICAgewpAQCAtMjAyNiw3ICsyMDAyLDcgQEAgc3RhdGljIGludCBmcmVlX2w0
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgaWYgKCByYyA9
PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0g
UFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7Cisg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7
CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEw0
X1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAgICAgewpkaWZmIC0tZ2l0IGEv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oCmluZGV4IDc0YjAyNDZjMDIuLjcwNDM0NTMzNWMgMTAwNjQ0Ci0t
LSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L21tLmgKQEAgLTE2Miw3ICsxNjIsNyBAQCBzdHJ1Y3QgcGFn
ZV9pbmZvCiAgICAgICAgICAqIG9wZXJhdGlvbiBvbiB0aGUgY3VycmVudCBw
YWdlLiAgKFRoYXQgcGFnZSBtYXkgb3IgbWF5IG5vdAogICAgICAgICAgKiBz
dGlsbCBoYXZlIFBHVF9wYXJ0aWFsIHNldC4pCiAgICAgICAgICAqCi0gICAg
ICAgICAqIElmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHNldCwgdGhl
biB0aGUgUFRFIGF0CisgICAgICAgICAqIEFkZGl0aW9uYWxseSwgaWYgUFRG
X3BhcnRpYWxfc2V0IGlzIHNldCwgdGhlbiB0aGUgUFRFIGF0CiAgICAgICAg
ICAqIEBucl92YWxpZGF0ZWRfcHRlZiBob2xkcyBhIGdlbmVyYWwgcmVmZXJl
bmNlIGNvdW50IGZvciB0aGUKICAgICAgICAgICogcGFnZS4KICAgICAgICAg
ICoKQEAgLTE3MSwyMyArMTcxLDIwIEBAIHN0cnVjdCBwYWdlX2luZm8KICAg
ICAgICAgICogICBpbnRlcnJ1cHRlZAogICAgICAgICAgKiAtIER1cmluZyB2
YWxpZGF0aW9uLCBpZiBhbiBpbnZhbGlkIGVudHJ5IGlzIGVuY291bnRlcmVk
IGFuZAogICAgICAgICAgKiAgIHZhbGlkYXRpb24gaXMgcHJlZW1wdGlibGUK
LSAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRp
YWxfZ2VuZXJhbF9yZWYgd2FzIHNldCBvbgotICAgICAgICAgKiAgIHRoaXMg
ZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFwcyBiZWNhdXNlIGl0IHBpY2tl
ZCB1cCBhCisgICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIFBU
Rl9wYXJ0aWFsX3NldCB3YXMgc2V0IG9uIHRoaXMKKyAgICAgICAgICogICBl
bnRyeSB0byBiZWdpbiB3aXRoIChwZXJoYXBzIGJlY2F1c2UgaXQgcGlja2Vk
IHVwIGEKICAgICAgICAgICogICBwcmV2aW91cyBvcGVyYXRpb24pCiAgICAg
ICAgICAqCi0gICAgICAgICAqIFdoZW4gcmVzdW1pbmcgdmFsaWRhdGlvbiwg
aWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMKLSAgICAgICAgICogY2xl
YXIsIHRoZW4gYSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVp
cmVkOyBpZiBpdAotICAgICAgICAgKiBpcyBzZXQsIG5vIHJlZmVyZW5jZSBz
aG91bGQgYmUgYWNxdWlyZWQuCisgICAgICAgICAqIFdoZW4gcmVzdW1pbmcg
dmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfc2V0IGlzIGNsZWFyLCB0aGVu
CisgICAgICAgICAqIGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1h
Y3F1aXJlZDsgaWYgaXQgaXMgc2V0LCBubworICAgICAgICAgKiByZWZlcmVu
Y2Ugc2hvdWxkIGJlIGFjcXVpcmVkLgogICAgICAgICAgKgotICAgICAgICAg
KiBXaGVuIHJlc3VtaW5nIGRlLXZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmIGlzCi0gICAgICAgICAqIGNsZWFyLCBubyByZWZlcmVu
Y2Ugc2hvdWxkIGJlIGRyb3BwZWQ7IGlmIGl0IGlzIHNldCwgYQotICAgICAg
ICAgKiByZWZlcmVuY2Ugc2hvdWxkIGJlIGRyb3BwZWQuCisgICAgICAgICAq
IFdoZW4gcmVzdW1pbmcgZGUtdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxf
c2V0IGlzIGNsZWFyLAorICAgICAgICAgKiBubyByZWZlcmVuY2Ugc2hvdWxk
IGJlIGRyb3BwZWQ7IGlmIGl0IGlzIHNldCwgYSByZWZlcmVuY2UKKyAgICAg
ICAgICogc2hvdWxkIGJlIGRyb3BwZWQuCiAgICAgICAgICAqCi0gICAgICAg
ICAqIE5CIGF0IHRoZSBtb21lbnQsIFBURl9wYXJ0aWFsX3NldCBzaG91bGQg
YmUgc2V0IGlmIGFuZCBvbmx5IGlmCi0gICAgICAgICAqIFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmIGlzIHNldC4KLSAgICAgICAgICoKLSAgICAgICAgICog
TkIgdGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0aWFsX2dlbmVy
YWxfcmVmIGFyZQotICAgICAgICAgKiBkZWZpbmVkIGluIG1tLmMsIHRoZSBv
bmx5IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQuCisgICAgICAgICAqIE5C
IHRoYXQgUFRGX3BhcnRpYWxfc2V0IGlzIGRlZmluZWQgaW4gbW0uYywgdGhl
IG9ubHkgcGxhY2UKKyAgICAgICAgICogd2hlcmUgaXQgaXMgdXNlZC4KICAg
ICAgICAgICoKICAgICAgICAgICogVGhlIDNyZCBmaWVsZCwgQGxpbmVhcl9w
dF9jb3VudCwgaW5kaWNhdGVzCiAgICAgICAgICAqIC0gYnkgYSBwb3NpdGl2
ZSB2YWx1ZSwgaG93IG1hbnkgc2FtZS1sZXZlbCBwYWdlIHRhYmxlIGVudHJp
ZXMgYSBwYWdlCkBAIC0xOTcsOCArMTk0LDggQEAgc3RydWN0IHBhZ2VfaW5m
bwogICAgICAgICAgKi8KICAgICAgICAgc3RydWN0IHsKICAgICAgICAgICAg
IHUxNiBucl92YWxpZGF0ZWRfcHRlczpQQUdFVEFCTEVfT1JERVIgKyAxOwot
ICAgICAgICAgICAgdTE2IDoxNiAtIFBBR0VUQUJMRV9PUkRFUiAtIDEgLSAy
OwotICAgICAgICAgICAgdTE2IHBhcnRpYWxfZmxhZ3M6MjsKKyAgICAgICAg
ICAgIHUxNiA6MTYgLSBQQUdFVEFCTEVfT1JERVIgLSAxIC0gMTsKKyAgICAg
ICAgICAgIHUxNiBwYXJ0aWFsX2ZsYWdzOjE7CiAgICAgICAgICAgICBzMTYg
bGluZWFyX3B0X2NvdW50OwogICAgICAgICB9OwogCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Transfer-Encoding: base64

RnJvbSAyMDNiYzk2NzU3NGM3YzVhMDZlZDZiYjQ1MmE5NzYxZjQ2ZGNlNzI0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA5LzExXSB4
ODYvbW06IFByb3Blcmx5IGhhbmRsZSBsaW5lYXIgcGFnZXRhYmxlIHByb21v
dGlvbgogZmFpbHVyZXMKCkluIG9yZGVyIHRvIGFsbG93IHJlY3Vyc2l2ZSBw
YWdldGFibGUgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIHRvIGJlCmludGVy
cnVwdGVkLCBYZW4gbXVzdCBrZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0
aGUgc3ViLXBhZ2VzCnByb21vdGVkIG9yIGRlbW90ZWQuICBUaGlzIGlzIHN0
b3JlZCBpbiB0d28gZWxlbWVudHMgaW4gdGhlIHBhZ2UKc3RydWN0OiBucl9l
bnRyaWVzX3ZhbGlkYXRlZCBhbmQgcGFydGlhbF9mbGFncy4KClRoZSBydWxl
IGlzIHRoYXQgZW50cmllcyBbMCwgbnJfZW50cmllc192YWxpZGF0ZWQpIHNo
b3VsZCBhbHdheXMgYmUKdmFsaWRhdGVkIGFuZCBob2xkIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgY291bnQuICBJZiBwYXJ0aWFsX2ZsYWdzIGlzCnplcm8sIHRo
ZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXSBpcyBub3QgdmFsaWRhdGVkIGFu
ZCBubyByZWZlcmVuY2UKY291bnQgaXMgaGVsZC4gIElmIFBURl9wYXJ0aWFs
X3NldCBpcyBzZXQsIHRoZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXQppcyBw
YXJ0aWFsbHkgdmFsaWRhdGVkLCBhbmQgYSBnZW5lcmFsIHJlZmVyZW5jZSBj
b3VudCBpcyBoZWxkLgoKVW5mb3J0dW5hdGVseSwgaW4gY2FzZXMgd2hlcmUg
YW4gZW50cnkgYmVnYW4gd2l0aCBQVEZfcGFydGlhbF9zZXQgc2V0LAphbmQg
Z2V0X3BhZ2VfZnJvbV9sTmUoKSByZXR1cm5zIC1FSU5WQUwsIHRoZSBQVEZf
cGFydGlhbF9zZXQgYml0IGlzCmVycm9uZW91c2x5IGRyb3BwZWQuICAoVGhp
cyBzY2VuYXJpbyBjYW4gYmUgZW5naW5lZXJlZCBtYWlubHkgYnkgdGhlCnVz
ZSBvZiBpbnRlcmxlYXZpbmcgb2YgcHJvbW90aW5nIGFuZCBkZW1vdGluZyBh
IHBhZ2Ugd2hpY2ggaGFzICJsaW5lYXIKcGFnZXRhYmxlIiBlbnRyaWVzOyBz
ZWUgdGhlIGFwcGVuZGl4IGZvciBhIHNrZXRjaC4pICBUaGlzIG1lYW5zIHRo
YXQKd2Ugd2lsbCAibGVhayIgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBv
biB0aGUgcGFnZSBpbiBxdWVzdGlvbiwKcHJldmVudGluZyB0aGUgcGFnZSBm
cm9tIGJlaW5nIGZyZWVkLgoKRml4IHRoaXMgYnkgc2V0dGluZyBwYWdlLT5w
YXJ0aWFsX2ZsYWdzIHRvIHRoZSBwYXJ0aWFsX2ZsYWdzIGxvY2FsCnZhcmlh
YmxlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTkuCgpSZXBvcnRlZC1ieTog
R2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+Ci0tLS0tCkFwcGVuZGl4CgpTdXBwb3NlIEEgYW5kIEIgY2FuIGJv
dGggYmUgcHJvbW90ZWQgdG8gTDIgcGFnZXMsIGFuZCBBW3hdIHBvaW50cyB0
byBCLgoKVjE6IFBJTl9MMiBCLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1Rf
dmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkCgpWMTog
TU9EX0wzX0VOVFJZIHBvaW50aW5nIHNvbWV0aGluZyB0byBBLgogIEluIHRo
ZSBwcm9jZXNzIG9mIHZhbGlkYXRpbmcgQVt4XSwgZ3JhYiBhbiBleHRyYSB0
eXBlIC8gcmVmIG9uIEI6CiAgQi50eXBlX2NvdW50ID0gMiB8IFBHVF92YWxp
ZGF0ZWQKICBCLmNvdW50ID0gMyB8IFBHQ19hbGxvY2F0ZWQKICBBLnR5cGVf
Y291bnQgPSAxIHwgUEdUX3ZhbGlkYXRlZAogIEEuY291bnQgPSAyIHwgUEdD
X2FsbG9jYXRlZAoKVjE6IFVOUElOIEIuCiAgQi50eXBlX2NvdW50ID0gMSB8
IFBHVF92YWxpZGF0ZQogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAoK
VjE6IE1PRF9MM19FTlRSWSByZW1vdmluZyB0aGUgcmVmZXJlbmNlIHRvIEEu
CiAgRGUtdmFsaWRhdGUgQSwgZG93biB0byBBW3hdLCB3aGljaCBwb2ludHMg
dG8gQi4KICBEcm9wIHRoZSBmaW5hbCB0eXBlIG9uIEIuICBBcnJhbmdlIHRv
IGJlIGludGVycnVwdGVkLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFy
dGlhbAogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAogIEEudHlwZV9j
b3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFsaWRhdGVkX2VudHJp
ZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IC0xCgpWMjogTU9EX0wzX0VOVFJZ
IGFkZHMgYSByZWZlcmVuY2UgdG8gQS4KCkF0IHRoaXMgcG9pbnQsIGdldF9w
YWdlX2Zyb21fbDJlKEFbeF0pIHRyaWVzCmdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKCksIHdoaWNoIGZhaWxzIGJlY2F1c2UgaXQncyB0aGUgd3Jvbmcg
dHlwZTsKYW5kIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKCkgYWxzbyBmYWls
cywgYmVjYXVzZSBCIGlzbid0IHZhbGlkYXRlZCBhcwphbiBsMiBhbnltb3Jl
LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNiArKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCA2OTM3OTEzMzFhLi4zMDBmMTQ3ZTk4IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTU5Myw3ICsxNTkzLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAg
ICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKKyAgICAgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKICAg
ICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
TlVMTDsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSA9IHBhZ2U7CiAgICAgICAgICAgICB9CkBAIC0xNjc4LDcgKzE2
NzgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIGlmICggaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOworICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKICAgICAgICAgfQpAQCAtMTgzNSw3ICsxODM1LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CisgICAgICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAg
ICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBlbHNl
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Transfer-Encoding: base64

RnJvbSA0NTI0MmI5MDU3YjRmZWNjYjgzNzM2MmYzOWUwZWI5N2RjMDA5M2M4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDEwLzExXSB4
ODYvbW06IEZpeCBuZXN0ZWQgZGUtdmFsaWRhdGlvbiBvbiBlcnJvcgoKSWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBkaXNjb3ZlcmVkIHdoZW4gdmFsaWRhdGlu
ZyBhIHBhZ2UtdGFibGUgdHJlZSwKdGhlIGVudGlyZSB0cmVlIHdoaWNoIGhh
cyBzbyBmYXIgYmVlbiB2YWxpZGF0ZWQgbXVzdCBiZSBkZS12YWxpZGF0ZWQu
ClNpbmNlIHRoaXMgbWF5IHRha2UgYSBsb25nIHRpbWUsIGFsbG9jX2xbMi00
XV90YWJsZSgpIHNldCBjdXJyZW50CnZjcHUncyBvbGRfZ3Vlc3RfdGFibGUg
aW1tZWRpYXRlbHk7IHB1dF9vbGRfZ3Vlc3RfdGFibGUoKSB3aWxsIG1ha2UK
c3VyZSB0aGF0IHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxlZCB0byBm
aW5pc2ggb2ZmIHRoZQpkZS12YWxpZGF0aW9uIGJlZm9yZSBhbnkgb3RoZXIg
TU1VIG9wZXJhdGlvbnMgY2FuIGhhcHBlbiBvbiB0aGUgdmNwdS4KClRoZSBp
bnZhcmlhbnQgZm9yIHBhcnRpYWwgcGFnZXMgc2hvdWxkIGJlOgoKKiBFbnRy
aWVzIFswLCBucl92YWxpZGF0ZWRfcHRlcykgc2hvdWxkIGJlIGNvbXBsZXRl
bHkgdmFsaWRhdGVkOwogIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGRlLXZhbGlk
YXRlIHRoZXNlLgoKKiBJZiBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHBhcnRp
YWxseSB2YWxpZGF0ZWQsIHBhcnRpYWxfZmxhZ3Mgc2hvdWxkCiAgc2V0IFBU
Rl9wYXJ0aWFMX3NldC4gIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxl
ZCBvbiB0aGlzIHBhZ2UgdG8KICBmaW5pc2ggb2ZmIGRldmFsaWRhdGlvbiwg
YW5kIHRoZSBhcHByb3ByaWF0ZSByZWZjb3VudCBhZGp1c3RtZW50cwogIHdp
bGwgYmUgZG9uZS4KCmFsbG9jX2xbMi0zXV90YWJsZSgpIGluZGljYXRlcyBw
YXJ0aWFsIHZhbGlkYXRpb24gdG8gaXRzIGNhbGxlcnMgYnkKc2V0dGluZyBj
dXJyZW50LT5vbGRfZ3Vlc3RfdGFibGUuCgpVbmZvcnR1bmF0ZWx5LCB0aGlz
IGlzIG1pc2hhbmRsZWQuCgpUYWtlIHRoZSBjYXNlIHdoZXJlIHZhbGlkYXRp
bmcgbE5lW3hdIHJldHVybnMgYW4gZXJyb3IuCgpGaXJzdCwgYWxsb2NfbDNf
dGFibGUoKSBkb2Vzbid0IGNoZWNrIG9sZF9ndWVzdF90YWJsZSBhdCBhbGw7
IGFzIGEKcmVzdWx0LCBwYXJ0aWFsX2ZsYWdzIGlzIG5vdCBzZXQgd2hlbiBp
dCBzaG91bGQgYmUuICBucl92YWxpZGF0ZWRfcHRlcwppcyBzZXQgdG8geDsg
YW5kIHNpbmNlIFBGVF9wYXJ0aWFsX3NldCBjbGVhciwgZGUtdmFsaWRhdGlv
biByZXN1bWVzIGF0Cm5yX3ZhbGlkYXRlZF9wdGVzLTEuICBUaGlzIG1lYW5z
IHRoYXQgdGhlIGwyIHBhZ2UgYXQgcGwzZVt4XSB3aWxsIG5vdApoYXZlIHB1
dF9wYWdlX3R5cGUoKSBjYWxsZWQgb24gaXQgd2hlbiBkZS12YWxpZGF0aW5n
IHRoZSByZXN0IG9mIHRoZQpsMzogaXQgd2lsbCBiZSBzdHVjayBpbiB0aGUg
UEdUX3BhcnRpYWwgc3RhdGUgdW50aWwgdGhlIGRvbWFpbiBpcwpkZXN0cm95
ZWQsIG9yIHVudGlsIGl0IGlzIHJlLXVzZWQgYXMgYW4gbDIuICAoQW55IG90
aGVyIHBhZ2UgdHlwZSB3aWxsCmZhaWwuKQoKV29yc2UsIGFsbG9jX2w0X3Rh
YmxlKCksIHJhdGhlciB0aGFuIHNldHRpbmcgUFRGX3BhcnRpYWxfc2V0IGFz
IGl0CnNob3VsZCwgc2V0cyBucl92YWxpZGF0ZWRfcHRlcyB0byB4KzEuICBX
aGVuIGRlLXZhbGlkYXRpbmcsIHNpbmNlCnBhcnRpYWwgaXMgMCwgdGhpcyB3
aWxsIGNvcnJlY3RseSByZXN1bWUgY2FsbGluZyBwdXRfcGFnZV90eXBlIGF0
IFt4XTsKYnV0LCBpZiB0aGUgcHV0X3BhZ2VfdHlwZSgpIGlzIG5ldmVyIGNh
bGxlZCwgYnV0IGluc3RlYWQKZ2V0X3BhZ2VfdHlwZSgpIGlzIGNhbGxlZCwg
dmFsaWRhdGlvbiB3aWxsIHBpY2sgdXAgYXQgW3grMV0sCm5lZ2xlY3Rpbmcg
dG8gdmFsaWRhdGUgW3hdLiAgSWYgdGhlIHJlc3Qgb2YgdGhlIHZhbGlkYXRp
b24gc3VjY2VlZHMsCnRoZSBsNCB3aWxsIGJlIHZhbGlkYXRlZCBldmVuIHRo
b3VnaCBbeF0gaXMgaW52YWxpZC4KCkZpeCB0aGlzIGluIGJvdGggY2FzZXMg
Ynkgc2V0dGluZyBQVEZfcGFydGlhbF9zZXQgaWYgb2xkX2d1ZXN0X3RhYmxl
CmlzIHNldC4KCldoaWxlIGhlcmUsIGFkZCBzb21lIHNhZmV0eSBjYXRjaGVz
OgotIG9sZF9ndWVzdF90YWJsZSBtdXN0IHBvaW50IHRvIHRoZSBwYWdlIGNv
bnRhaW5lZCBpbgogIFtucl92YWxpZGF0ZWRfcHRlc10uCi0gYWxsb2NfbDFf
cGFnZSBzaG91bGRuJ3Qgc2V0IG9sZF9ndWVzdF90YWJsZQoKSWYgd2UgZXhw
ZXJpZW5jZSBvbmUgb2YgdGhlc2Ugc2l0dWF0aW9ucyBpbiBwcm9kdWN0aW9u
IGJ1aWxkcywgaXQncwpzYWZlciB0byBhdm9pZCBjYWxsaW5nIHB1dF9wYWdl
X3R5cGUgZm9yIHRoZSBwYWdlcyBpbiBxdWVzdGlvbi4gIElmCnRoZXkgaGF2
ZSBQR1RfcGFydGlhbCBzZXQsIHRoZXkgd2lsbCBiZSBjbGVhbmVkIHVwIG9u
IGRvbWFpbgpkZXN0cnVjdGlvbjsgaWYgbm90LCB3ZSBoYXZlIG5vIGlkZWEg
d2hldGhlciBhIHR5cGUgY291bnQgaXMgc2FmZSB0bwpkcm9wLiAgUmV0YWlu
aW5nIGFuIGV4dHJhIHR5cGUgcmVmIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBk
cm9wcGVkIG1heQp0cmlnZ2VyIGEgQlVHKCkgb24gdGhlIGZyZWVfZG9tYWlu
X3BhZ2UoKSBwYXRoLCBidXQgZHJvcHBpbmcgYSB0eXBlCmNvdW50IHRoYXQg
c2hvdWxkbid0IGJlIGRyb3BwZWQgbWF5IGNhdXNlIGEgcHJpdmlsZWdlIGVz
Y2FsYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDU1ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiAx
IGZpbGUgY2hhbmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigt
KQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS5jIGIveGVuL2FyY2gv
eDg2L21tLmMKaW5kZXggMzAwZjE0N2U5OC4uMmVhMzI0NjNhOCAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysrIGIveGVuL2FyY2gveDg2L21t
LmMKQEAgLTE1OTIsNiArMTU5MiwyMCBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9PSBOVUxMKTsKICAgICAgICAgICAgIGlmICggaSApCiAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAg
ICAgICAgKiBhbGxvY19sMV90YWJsZSgpIGRvZXNuJ3Qgc2V0IG9sZF9ndWVz
dF90YWJsZTsgaXQgZG9lcworICAgICAgICAgICAgICAgICAqIGl0cyBvd24g
dGVhci1kb3duIGltbWVkaWF0ZWx5IG9uIGZhaWx1cmUuICBJZiBpdAorICAg
ICAgICAgICAgICAgICAqIGRpZCB3ZSdkIG5lZWQgdG8gY2hlY2sgaXQgYW5k
IHNldCBwYXJ0aWFsX2ZsYWdzIGFzIHdlCisgICAgICAgICAgICAgICAgICog
ZG8gaW4gYWxsb2NfbFszNF1fdGFibGUoKS4KKyAgICAgICAgICAgICAgICAg
KgorICAgICAgICAgICAgICAgICAqIE5vdGUgb24gdGhlIHVzZSBvZiBBU1NF
UlQ6IGlmIGl0J3Mgbm9uLW51bGwgYW5kCisgICAgICAgICAgICAgICAgICog
aGFzbid0IGJlZW4gY2xlYW5lZCB1cCB5ZXQsIGl0IHNob3VsZCBoYXZlCisg
ICAgICAgICAgICAgICAgICogUEdUX3BhcnRpYWwgc2V0OyBhbmQgc28gdGhl
IHR5cGUgd2lsbCBiZSBjbGVhbmVkIHVwCisgICAgICAgICAgICAgICAgICog
b24gZG9tYWluIGRlc3RydWN0aW9uLiAgVW5mb3J0dW5hdGVseSwgd2Ugd291
bGQKKyAgICAgICAgICAgICAgICAgKiBsZWFrIHRoZSBnZW5lcmFsIHJlZiBo
ZWxkIGJ5IG9sZF9ndWVzdF90YWJsZTsgYnV0CisgICAgICAgICAgICAgICAg
ICogbGVha2luZyBhIHBhZ2UgaXMgbGVzcyBiYWQgdGhhbiBhIGhvc3QgY3Jh
c2guCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgQVNT
RVJUKGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwog
ICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
ICAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlh
bF9mbGFnczsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF9wdHBnID0gTlVMTDsKQEAgLTE2MTksNiArMTYzMyw3IEBAIHN0YXRp
YyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkK
ICAgICB1bnNpZ25lZCBpbnQgICBpOwogICAgIGludCAgICAgICAgICAgIHJj
ID0gMDsKICAgICB1bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFn
ZS0+cGFydGlhbF9mbGFnczsKKyAgICBsM19wZ2VudHJ5X3QgICBsM2UgPSBs
M2VfZW1wdHkoKTsKIAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21m
bihwZm4pKTsKIApAQCAtMTY2NSw3ICsxNjgwLDExIEBAIHN0YXRpYyBpbnQg
YWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAg
ICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlm
ICggcmMgPCAwICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogWFNBLTI5
OSBCYWNrcG9ydDogQ29weSBsM2UgZm9yIGNoZWNraW5nICovCisgICAgICAg
ICAgICBsM2UgPSBwbDNlW2ldOwogICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KIAogICAgICAgICBwbDNlW2ldID0gYWRqdXN0X2d1ZXN0X2wzZShw
bDNlW2ldLCBkKTsKICAgICB9CkBAIC0xNjc5LDYgKzE2OTgsMjQgQEAgc3Rh
dGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7CiAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0g
cGFydGlhbF9mbGFnczsKKyAgICAgICAgICAgIGlmICggY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgKQorICAgICAgICAgICAgeworICAgICAgICAg
ICAgICAgIC8qCisgICAgICAgICAgICAgICAgICogV2UndmUgZXhwZXJpZW5j
ZWQgYSB2YWxpZGF0aW9uIGZhaWx1cmUuICBJZgorICAgICAgICAgICAgICAg
ICAqIG9sZF9ndWVzdF90YWJsZSBpcyBzZXQsICJ0cmFuc2ZlciIgdGhlIGdl
bmVyYWwKKyAgICAgICAgICAgICAgICAgKiByZWZlcmVuY2UgY291bnQgdG8g
cGwzZVtucl92YWxpZGF0ZWRfcHRlc10gYnkKKyAgICAgICAgICAgICAgICAg
KiBzZXR0aW5nIFBURl9wYXJ0aWFsX3NldC4KKyAgICAgICAgICAgICAgICAg
KgorICAgICAgICAgICAgICAgICAqIEFzIGEgcHJlY2F1dGlvbiwgY2hlY2sg
dGhhdCBvbGRfZ3Vlc3RfdGFibGUgaXMgdGhlCisgICAgICAgICAgICAgICAg
ICogcGFnZSBwb2ludGVkIHRvIGJ5IHBsM2VbbnJfdmFsaWRhdGVkX3B0ZXNd
LiAgSWYKKyAgICAgICAgICAgICAgICAgKiBub3QsIGl0J3Mgc2FmZXIgdG8g
bGVhayBhIHR5cGUgcmVmIG9uIHByb2R1Y3Rpb24KKyAgICAgICAgICAgICAg
ICAgKiBidWlsZHMuCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAg
ICAgICAgaWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBs
M2VfZ2V0X3BhZ2UobDNlKSApCisgICAgICAgICAgICAgICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CisgICAgICAgICAg
ICAgICAgZWxzZQorICAgICAgICAgICAgICAgICAgICBBU1NFUlRfVU5SRUFD
SEFCTEUoKTsKKyAgICAgICAgICAgIH0KICAgICAgICAgICAgIGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICB9
CkBAIC0xODQxLDcgKzE4NzgsMjMgQEAgc3RhdGljIGludCBhbGxvY19sNF90
YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICAgICAgICAg
IGVsc2UKICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
IGlmICggY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQotICAgICAg
ICAgICAgICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMrKzsK
KyAgICAgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICAg
ICAgLyoKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIFdlJ3ZlIGV4cGVy
aWVuY2VkIGEgdmFsaWRhdGlvbiBmYWlsdXJlLiAgSWYKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAqIG9sZF9ndWVzdF90YWJsZSBpcyBzZXQsICJ0cmFu
c2ZlciIgdGhlIGdlbmVyYWwKKyAgICAgICAgICAgICAgICAgICAgICAgICAq
IHJlZmVyZW5jZSBjb3VudCB0byBwbDNlW25yX3ZhbGlkYXRlZF9wdGVzXSBi
eQorICAgICAgICAgICAgICAgICAgICAgICAgICogc2V0dGluZyBQVEZfcGFy
dGlhbF9zZXQuCisgICAgICAgICAgICAgICAgICAgICAgICAgKgorICAgICAg
ICAgICAgICAgICAgICAgICAgICogQXMgYSBwcmVjYXV0aW9uLCBjaGVjayB0
aGF0IG9sZF9ndWVzdF90YWJsZSBpcyB0aGUKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAqIHBhZ2UgcG9pbnRlZCB0byBieSBwbDRlW25yX3ZhbGlkYXRl
ZF9wdGVzXS4gIElmCisgICAgICAgICAgICAgICAgICAgICAgICAgKiBub3Qs
IGl0J3Mgc2FmZXIgdG8gbGVhayBhIHR5cGUgcmVmIG9uIHByb2R1Y3Rpb24K
KyAgICAgICAgICAgICAgICAgICAgICAgICAqIGJ1aWxkcy4KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAqLworICAgICAgICAgICAgICAgICAgICAgICAg
aWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBsNGVfZ2V0
X3BhZ2UocGw0ZVtpXSkgKQorICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CisgICAg
ICAgICAgICAgICAgICAgICAgICBlbHNlCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CisgICAgICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5v
bGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKICAgICAgICAg
ICAgICAgICB9Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.10/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Disposition: attachment;
 filename="xsa299-4.10/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Transfer-Encoding: base64

RnJvbSA0OTA1ZjdmYmFhNjBmNzVkZjA2MzMwNWM5NTMyZmI2M2I3N2RlYWI5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NTAgKzAxMDAKU3ViamVjdDogW1BBVENIIDExLzExXSB4
ODYvbW06IERvbid0IGRyb3AgYSB0eXBlIHJlZiB1bmxlc3MgeW91IGhlbGQg
YSByZWYgdG8KIGJlZ2luIHdpdGgKClZhbGlkYXRpb24gYW5kIGRlLXZhbGlk
YXRpb24gb2YgcGFnZXRhYmxlIHRyZWVzIG1heSB0YWtlIGFyYml0cmFyaWx5
CmxhcmdlIGFtb3VudHMgb2YgdGltZSwgYW5kIHNvIG11c3QgYmUgcHJlZW1w
dGlibGUuICBUaGlzIGlzIGluZGljYXRlZApieSBzZXR0aW5nIHRoZSBQR1Rf
cGFydGlhbCBiaXQgaW4gdGhlIHR5cGVfaW5mbywgYW5kIHNldHRpbmcKbnJf
dmFsaWRhdGVkX2VudHJpZXMgYW5kIHBhcnRpYWxfZmxhZ3MgYXBwcm9wcmlh
dGVseS4gIFNwZWNpZmljYWxseSwKaWYgdGhlIGVudHJ5IGF0IFtucl92YWxp
ZGF0ZWRfZW50cmllc10gaXMgcGFydGlhbGx5IHZhbGlkYXRlZCwKcGFydGlh
bF9mbGFncyBzaG91bGQgaGF2ZSB0aGUgUEdUX3BhcnRpYWxfc2V0IGJpdCBz
ZXQsIGFuZCB0aGUgZW50cnkKc2hvdWxkIGhvbGQgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudC4gIER1cmluZyBkZS12YWxpZGF0aW9uLApwdXRfcGFnZV90
eXBlKCkgaXMgY2FsbGVkIG9uIHBhcnRpYWxseSB2YWxpZGF0ZWQgZW50cmll
cy4KClVuZm9ydHVuYXRlbHksIHRoZXJlIGFyZSBhIG51bWJlciBvZiBpc3N1
ZXMgd2l0aCB0aGUgY3VycmVudCBhbGdvcml0aG0uCgpGaXJzdCwgZG9pbmcg
YSAibm9ybWFsIiBwdXRfcGFnZV90eXBlKCkgaXMgbm90IHNhZmUgd2hlbiBu
byB0eXBlIHJlZgppcyBoZWxkOiB0aGVyZSBpcyBub3RoaW5nIHRvIHN0b3Ag
YW5vdGhlciB2Y3B1IGZyb20gY29taW5nIGFsb25nIGFuZApwaWNraW5nIHVw
IHZhbGlkYXRpb24gYWdhaW46IGF0IHdoaWNoIHBvaW50IHRoZSBwdXRfcGFn
ZV90eXBlIG1heSBkcm9wCnRoZSBvbmx5IHBhZ2UgcmVmIG9uIGFuIGluLXVz
ZSBwYWdlLiAgU29tZSBleGFtcGxlcyBhcmUgbGlzdGVkIGluIHRoZQphcHBl
bmRpeC4KClRoZSBjb3JlIGlzc3VlIGlzIHRoYXQgcHV0X3BhZ2VfdHlwZSgp
IGlzIGJlaW5nIGNhbGxlZCBib3RoIHRvIGNsZWFuCnVwIFBHVF9wYXJ0aWFs
LCBhbmQgdG8gZHJvcCBhIHR5cGUgY291bnQ7IGFuZCBoYXMgbm8gd2F5IG9m
IGtub3dpbmcKd2hpY2ggaXMgd2hpY2g7IGFuZCBzbyBpZiBpbiBiZXR3ZWVu
LCBQR1RfcGFydGlhbCBpcyBjbGVhcmVkLApwdXRfcGFnZV90eXBlKCkgd2ls
bCBkcm9wIHRoZSB0eXBlIHJlZiBlcnJvbmVvdXNseS4KCldoYXQgaXMgbmVl
ZGVkIGlzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIHN0YXRlczoKLSBE
cm9wcGluZyBhIHR5cGUgcmVmIHdoaWNoIGlzIGhlbGQKLSBDbGVhbmluZyB1
cCBhIHBhZ2Ugd2hpY2ggaGFzIGJlZW4gcGFydGlhbGx5IGRlL3ZhbGlkYXRl
ZAoKRml4IHRoaXMgYnkgdGVsbGluZyBwdXRfcGFnZV90eXBlKCkgd2hpY2gg
b2YgdGhlIHR3byBhY3Rpdml0aWVzIHlvdQppbnRlbmQuCgpXaGVuIGNsZWFu
aW5nIHVwIGEgcGFydGlhbCBkZS92YWxpZGF0aW9uLCB0YWtlIG5vIGFjdGlv
biB1bmxlc3MgeW91CmZpbmQgYSBwYWdlIHBhcnRpYWxseSB2YWxpZGF0ZWQu
CgpJZiBwdXRfcGFnZV90eXBlKCkgaXMgY2FsbGVkIHdpdGhvdXQgUFRGX3Bh
cnRpYWxfc2V0LCBhbmQgZmluZHMgdGhlCnBhZ2UgaW4gYSBQR1RfcGFydGlh
bCBzdGF0ZSBhbnl3YXksIHRoZW4gdGhlcmUncyBjZXJ0YWlubHkgYmVlbiBh
Cm1pc2FjY291bnRpbmcgc29tZXdoZXJlLCBhbmQgY2Fycnlpbmcgb24gd291
bGQgYWxtb3N0IGNlcnRhaW5seSBjYXVzZQphIHNlY3VyaXR5IGlzc3VlLCBz
byBjcmFzaCB0aGUgaG9zdCBpbnN0ZWFkLgoKSW4gcHV0X3BhZ2VfZnJvbV9s
TmUsIHBhc3MgcGFydGlhbF9mbGFncyBvbiB0byBfcHV0X3BhZ2VfdHlwZSgp
LgoKb2xkX2d1ZXN0X3RhYmxlIG1heSBiZSBzZXQgZWl0aGVyIHdpdGggYSBm
dWxseSB2YWxpZGF0ZWQgcGFnZSAod2hlbgp1c2luZyB0aGUgImRlZmVycmVk
IHB1dCIgcGF0dGVybiksIG9yIHdpdGggYSBwYXJ0aWFsbHkgdmFsaWRhdGVk
IHBhZ2UKKHdoZW4gYSBub3JtYWwgImRlLXZhbGlkYXRpb24iIGlzIGludGVy
cnVwdGVkLCBvciB3aGVuIGEgdmFsaWRhdGlvbgpmYWlscyBwYXJ0LXdheSB0
aHJvdWdoIGR1ZSB0byBpbnZhbGlkIGVudHJpZXMpLiAgQWRkIGEgZmxhZywK
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwsIHRvIGluZGljYXRlIHdoaWNoIG9m
IHRoZXNlIGl0IGlzLCBhbmQgdXNlCnRoYXQgdG8gcGFzcyB0aGUgYXBwcm9w
cmlhdGUgZmxhZyB0byBfcHV0X3BhZ2VfdHlwZSgpLgoKV2hpbGUgaGVyZSwg
ZGVsZXRlIHN0cmF5IHRyYWlsaW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tLS0KQXBw
ZW5kaXg6CgpTdXBwb3NlIHBhZ2UgQSwgd2hlbiBpbnRlcnByZXRlZCBhcyBh
biBsMyBwYWdldGFibGUsIGNvbnRhaW5zIGFsbAp2YWxpZCBlbnRyaWVzOyBh
bmQgc3VwcG9zZSBBW3hdIHBvaW50cyB0byBwYWdlIEIsIHdoaWNoIHdoZW4K
aW50ZXJwcmV0ZWQgYXMgYW4gbDIgcGFnZXRhYmxlLCBjb250YWlucyBhbGwg
dmFsaWQgZW50cmllcy4KClAxOiBQSU5fTDNfVEFCTEUKICBBIC0+IFBHVF9s
M190YWJsZSB8IDEgfCB2YWxpZAogIEIgLT4gUEdUX2wyX3RhYmxlIHwgMSB8
IHZhbGlkCgpQMTogVU5QSU5fVEFCTEUKICA+IEFycmFuZ2UgdG8gaW50ZXJy
dXB0IGFmdGVyIEIgaGFzIGJlZW4gZGUtdmFsaWRhdGVkCiAgQjoKICAgIHR5
cGVfaW5mbyAtPiBQR1RfbDJfdGFibGUgfCAwCiAgQToKICAgIHR5cGVfaW5m
byAtPiBQR1RfbDNfdGFibGUgfCAxIHwgcGFydGlhbAogICAgbnJfdmFsaWRh
dGVkX2VudGllcyAtPiAobGVzcyB0aGFuIHgpCgpQMjogbW9kX2w0X2VudHJ5
IHRvIHBvaW50IHRvIEEKICA+IEFycmFuZ2UgZm9yIHRoaXMgdG8gYmUgaW50
ZXJydXB0ZWQgd2hpbGUgQiBpcyBiZWluZyB2YWxpZGF0ZWQKICBCOgogICAg
dHlwZV9pbmZvIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBwYXJ0aWFsCiAgICAo
bnJfdmFsaWRhdGVkX2VudGlyZXMgJmMgc2V0IGFzIGFwcHJvcHJpYXRlKQog
IEE6CiAgICB0eXBlX2luZm8gLT4gUEdUX2wzX3RhYmxlIHwgMSB8IHBhcnRp
YWwKICAgIG5yX3ZhbGlkYXRlZF9lbnRyaWVzIC0+IHgKICAgIHBhcnRpYWxf
cHRlID0gMQoKUDM6IG1vZF9sM19lbnRyeSBzb21lIG90aGVyIHVucmVsYXRl
ZCBsMyB0byBwb2ludCB0byBCOgogIEI6CiAgICB0eXBlX2luZm8gLT4gUEdU
X2wyX3RhYmxlIHwgMQoKUDE6IFJlc3RhcnQgVU5QSU5fVEFCTEUKCkF0IHRo
aXMgcG9pbnQsIHNpbmNlIEEubnJfdmFsaWRhdGVfZW50cmllcyA9PSB4IGFu
ZCBBLnBhcnRpYWxfcHRlICE9CjAsIGZyZWVfbDNfdGFibGUoKSB3aWxsIGNh
bGwgcHV0X3BhZ2VfZnJvbV9sM2UoKSBvbiBwbDNlW3hdLCBkcm9wcGluZwpp
dHMgdHlwZSBjb3VudCB0byAwIHdoaWxlIGl0J3Mgc3RpbGwgYmVpbmcgcG9p
bnRlZCB0byBieSBzb21lIG90aGVyIGwzCgpBIHNpbWlsYXIgaXNzdWUgYXJp
c2VzIHdpdGggb2xkX2d1ZXN0X3RhYmxlLiAgQ29uc2lkZXIgdGhlIGZvbGxv
d2luZwpzY2VuYXJpbzoKClN1cHBvc2UgQSBpcyBhIHBhZ2Ugd2hpY2gsIHdo
ZW4gaW50ZXJwcmV0ZWQgYXMgYW4gbDIsIGhhcyB2YWxpZCBlbnRyaWVzCnVu
dGlsIGVudHJ5IHgsIHdoaWNoIGlzIGludmFsaWQuCgpWMTogIFBJTl9MMl9U
QUJMRShBKQogIDxWYWxpZGF0ZSB1bnRpbCB3ZSB0cnkgdG8gdmFsaWRhdGUg
W3hdLCBnZXQgLUVJTlZBTD4KICBBIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBQ
R1RfcGFydGlhbAogIFYxIC0+IG9sZF9ndWVzdF90YWJsZSA9IEEKICA8ZGVs
YXllZD4KClYyOiBQSU5fTDJfVEFCTEUoQSkKICA8UGljayB1cCB3aGVyZSBW
MSBsZWZ0IG9mZiwgdHJ5IHRvIHJlLXZhbGlkYXRlIFt4XSwgZ2V0IC1FSU5W
QUw+CiAgQSAtPiBQR1RfbDJfdGFibGUgfCAxIHwgUEdUX3BhcnRpYWwKICBW
MiAtPiBvbGRfZ3Vlc3RfdGFibGUgPSBBCiAgPHJlc3RhcnQ+CiAgcHV0X29s
ZF9ndWVzdF90YWJsZSgpCiAgICBfcHV0X3BhZ2VfdHlwZShBKQogICAgICBB
IC0+IFBHVF9sMl90YWJsZSB8IDAKClYxOiA8cmVzdGFydD4KICBwdXRfb2xk
X2d1ZXN0X3RhYmxlKCkKICAgIF9wdXRfcGFnZV90eXBlKEEpICMgVU5ERVJG
TE9XCgpJbmRlZWQsIGl0IGlzIHBvc3NpYmxlIHRvIGVuZ2luZWVyIGZvciBv
bGRfZ3Vlc3RfdGFibGUgZm9yIGV2ZXJ5IHZjcHUKYSBndWVzdCBoYXMgdG8g
cG9pbnQgdG8gdGhlIHNhbWUgcGFnZS4KLS0tCiB4ZW4vYXJjaC94ODYvZG9t
YWluLmMgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAg
ICAgICAgIHwgOTkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oIHwgIDQgKy0KIDMg
ZmlsZXMgY2hhbmdlZCwgOTUgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IDg5NzEyNGYwNWYuLjYwNzRmYTU5
NDcgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTEwNzUsOSArMTA3NSwxNSBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICAgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0
aHJvdWdoICovCiAgICAgICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6Cisg
ICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICAgICAq
IE5CIHRoYXQgd2UncmUgcHV0dGluZyB0aGUga2VybmVsLW1vZGUgdGFibGUK
KyAgICAgICAgICAgICAgICAgICAgICogaGVyZSwgd2hpY2ggd2UndmUgYWxy
ZWFkeSBzdWNjZXNzZnVsbHkKKyAgICAgICAgICAgICAgICAgICAgICogdmFs
aWRhdGVkIGFib3ZlOyBoZW5jZSBwYXJ0aWFsID0gZmFsc2U7CisgICAgICAg
ICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgICB2LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPQogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZXRhYmxlX2dldF9wYWdlKHYtPmFyY2guZ3Vlc3RfdGFibGUp
OworICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgIHYtPmFy
Y2guZ3Vlc3RfdGFibGUgPSBwYWdldGFibGVfbnVsbCgpOwogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0Ogpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCAyZWEzMjQ2M2E4Li45YWU3MWQ4NjRhIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTM4NCwxMCArMTM4NCwxMSBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gcHRwZzsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgIH0K
ICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOworICAg
ICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHko
IXJjKSApCiAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAg
ICB9CkBAIC0xNDEwLDYgKzE0MTEsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdl
X2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZu
LAogICAgICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwzZV9nZXRfcGZuKGwz
ZSk7CiAgICAgICAgIGludCB3cml0ZWFibGUgPSBsM2VfZ2V0X2ZsYWdzKGwz
ZSkgJiBfUEFHRV9SVzsKIAorICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBBU1NFUlQoIShtZm4gJiAoKDFV
TCA8PCAoTDNfUEFHRVRBQkxFX1NISUZUIC0gUEFHRV9TSElGVCkpIC0gMSkp
KTsKICAgICAgICAgZG8gewogICAgICAgICAgICAgcHV0X2RhdGFfcGFnZSht
Zm5fdG9fcGFnZShfbWZuKG1mbikpLCB3cml0ZWFibGUpOwpAQCAtMTQyMiwx
MiArMTQyNCwxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwz
X3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgaWYg
KCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgeworICAgICAgICBBU1NFUlQo
IShmbGFncyAmIFBURl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21mbihwZm4p
KTsKICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBw
ZzsKKyAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbCA9IGZhbHNlOwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAg
ICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1m
bl90b19wYWdlKF9tZm4ocGZuKSkpOworICAgIHJjID0gX3B1dF9wYWdlX3R5
cGUocGcsIGZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShf
bWZuKHBmbikpKTsKICAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICAgICAg
cHV0X3BhZ2UocGcpOwogCkBAIC0xNDQ2LDEyICsxNDUwLDE1IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAKICAgICAgICAgaWYgKCBmbGFncyAmIFBURl9k
ZWZlciApCiAgICAgICAgIHsKKyAgICAgICAgICAgIEFTU0VSVCghKGZsYWdz
ICYgUFRGX3BhcnRpYWxfc2V0KSk7CiAgICAgICAgICAgICBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21mbihwZm4pKTsK
ICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0g
cGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICByZXR1cm4gMDsKICAg
ICAgICAgfQogCi0gICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBU
Rl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAg
ICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZsYWdzIHwgUFRGX3ByZWVt
cHRpYmxlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90b19w
YWdlKF9tZm4ocGZuKSkpOwogICAgICAgICBpZiAoIGxpa2VseSghcmMpICkK
ICAgICAgICAgICAgIHB1dF9wYWdlKHBnKTsKICAgICB9CkBAIC0xNTU2LDYg
KzE1NjMsMTQgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAKICAgICBw
bDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAKKyAgICAvKgor
ICAgICAqIE5CIHRoYXQgYWxsb2NfbDJfdGFibGUgd2lsbCBuZXZlciBzZXQg
cGFydGlhbF9wdGUgb24gYW4gbDI7IGJ1dAorICAgICAqIGZyZWVfbDJfdGFi
bGUgbWlnaHQgaWYgYSBsaW5lYXJfcGFnZXRhYmxlIGVudHJ5IGlzIGludGVy
cnVwdGVkCisgICAgICogcGFydHdheSB0aHJvdWdoIGRlLXZhbGlkYXRpb24u
ICBJbiB0aGF0IGNpcmN1bXN0YW5jZSwKKyAgICAgKiBnZXRfcGFnZV9mcm9t
X2wyZSgpIHdpbGwgYWx3YXlzIHJldHVybiAtRUlOVkFMOyBhbmQgd2UgbXVz
dAorICAgICAqIHJldGFpbiB0aGUgdHlwZSByZWYgYnkgZG9pbmcgdGhlIG5v
cm1hbCBwYXJ0aWFsX2ZsYWdzIHRyYWNraW5nLgorICAgICAqLworCiAgICAg
Zm9yICggaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzOyBpIDwgTDJfUEFH
RVRBQkxFX0VOVFJJRVM7CiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdz
ID0gMCApCiAgICAgewpAQCAtMTYxMCw2ICsxNjI1LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUpCiAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlh
bF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAg
ICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwor
ICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxl
X3BhcnRpYWwgPSB0cnVlOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAg
ICAgICAgIGlmICggcmMgPCAwICkKQEAgLTE3MTIsMTIgKzE3MjgsMTYgQEAg
c3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgICAgICAgICAgICAgICAqIGJ1aWxkcy4KICAgICAgICAgICAg
ICAgICAgKi8KICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID09IGwzZV9nZXRfcGFnZShsM2UpICkKKyAgICAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICAgIEFTU0VSVChjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsKTsKICAgICAgICAg
ICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFs
X3NldDsKKyAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsK
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOworICAgICAgICAgICAgY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IHRydWU7CiAgICAg
ICAgIH0KICAgICAgICAgd2hpbGUgKCBpLS0gPiAwICkKICAgICAgICAgICAg
IHBsM2VbaV0gPSB1bmFkanVzdF9ndWVzdF9sM2UocGwzZVtpXSwgZCk7CkBA
IC0xODkxLDEyICsxOTExLDE2IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFi
bGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICAg
ICAgICAgICAqIGJ1aWxkcy4KICAgICAgICAgICAgICAgICAgICAgICAgICAq
LwogICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBsNGVfZ2V0X3BhZ2UocGw0ZVtpXSkgKQor
ICAgICAgICAgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OworICAgICAgICAg
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNI
QUJMRSgpOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwog
ICAgICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90
YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgIH0KICAgICAgICAgfQpAQCAtMjc2MCw2
ICsyNzg0LDI4IEBAIHN0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICAg
ICB4ICA9IHk7CiAgICAgICAgIG54ID0geCAtIDE7CiAKKyAgICAgICAgLyoK
KyAgICAgICAgICogSXMgdGhpcyBleHBlY3RlZCB0byBkbyBhIGZ1bGwgcmVm
ZXJlbmNlIGRyb3AsIG9yIG9ubHkKKyAgICAgICAgICogY2xlYW51cCBwYXJ0
aWFsIHZhbGlkYXRpb24gLyBkZXZhbGlkYXRpb24/CisgICAgICAgICAqCisg
ICAgICAgICAqIElmIHRoZSBmb3JtZXIsIHRoZSBjYWxsZXIgbXVzdCBob2xk
IGEgImZ1bGwiIHR5cGUgcmVmOworICAgICAgICAgKiB3aGljaCBtZWFucyB0
aGUgcGFnZSBtdXN0IGJlIHZhbGlkYXRlZC4gIElmIHRoZSBwYWdlIGlzCisg
ICAgICAgICAqICpub3QqIGZ1bGx5IHZhbGlkYXRlZCwgY29udGludWluZyB3
b3VsZCBhbG1vc3QgY2VydGFpbmx5CisgICAgICAgICAqIG9wZW4gdXAgYSBz
ZWN1cml0eSBob2xlLiAgQW4gZXhjZXB0aW9uIHRvIHRoaXMgaXMgZHVyaW5n
CisgICAgICAgICAqIGRvbWFpbiBkZXN0cnVjdGlvbiwgd2hlcmUgUEdUX3Zh
bGlkYXRlZCBjYW4gYmUgZHJvcHBlZAorICAgICAgICAgKiB3aXRob3V0IGRy
b3BwaW5nIGEgdHlwZSByZWYuCisgICAgICAgICAqCisgICAgICAgICAqIElm
IHRoZSBsYXR0ZXIsIGRvIG5vdGhpbmcgdW5sZXNzIHR5cGUgUEdUX3BhcnRp
YWwgaXMgc2V0LgorICAgICAgICAgKiBJZiBpdCBpcyBzZXQsIHRoZSB0eXBl
IGNvdW50IG11c3QgYmUgMS4KKyAgICAgICAgICovCisgICAgICAgIGlmICgg
IShmbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgKQorICAgICAgICAgICAgQlVH
X09OKCh4ICYgUEdUX3BhcnRpYWwpIHx8CisgICAgICAgICAgICAgICAgICAg
ISgoeCAmIFBHVF92YWxpZGF0ZWQpIHx8IHBhZ2VfZ2V0X293bmVyKHBhZ2Up
LT5pc19keWluZykpOworICAgICAgICBlbHNlIGlmICggISh4ICYgUEdUX3Bh
cnRpYWwpICkKKyAgICAgICAgICAgIHJldHVybiAwOworICAgICAgICBlbHNl
CisgICAgICAgICAgICBCVUdfT04oKHggJiBQR1RfY291bnRfbWFzaykgIT0g
MSk7CisKICAgICAgICAgQVNTRVJUKCh4ICYgUEdUX2NvdW50X21hc2spICE9
IDApOwogCiAgICAgICAgIGlmICggdW5saWtlbHkoKG54ICYgUEdUX2NvdW50
X21hc2spID09IDApICkKQEAgLTMwMTIsMTcgKzMwNTgsMzQgQEAgaW50IHB1
dF9vbGRfZ3Vlc3RfdGFibGUoc3RydWN0IHZjcHUgKnYpCiAgICAgaWYgKCAh
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQogICAgICAgICByZXR1cm4gMDsK
IAotICAgIHN3aXRjaCAoIHJjID0gX3B1dF9wYWdlX3R5cGUodi0+YXJjaC5v
bGRfZ3Vlc3RfdGFibGUsIFBURl9wcmVlbXB0aWJsZSwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHYtPmFyY2gub2xkX2d1ZXN0X3B0cGcp
ICkKKyAgICByYyA9IF9wdXRfcGFnZV90eXBlKHYtPmFyY2gub2xkX2d1ZXN0
X3RhYmxlLAorICAgICAgICAgICAgICAgICAgICAgICAgUFRGX3ByZWVtcHRp
YmxlIHwKKyAgICAgICAgICAgICAgICAgICAgICAgICggdi0+YXJjaC5vbGRf
Z3Vlc3RfdGFibGVfcGFydGlhbCA/CisgICAgICAgICAgICAgICAgICAgICAg
ICAgIFBURl9wYXJ0aWFsX3NldCA6IDAgKSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgIHYtPmFyY2gub2xkX2d1ZXN0X3B0cGcpOworCisgICAgaWYgKCBy
YyA9PSAtRVJFU1RBUlQgfHwgcmMgPT0gLUVJTlRSICkKICAgICB7Ci0gICAg
Y2FzZSAtRUlOVFI6Ci0gICAgY2FzZSAtRVJFU1RBUlQ6CisgICAgICAgIHYt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSAocmMgPT0gLUVSRVNU
QVJUKTsKICAgICAgICAgcmV0dXJuIC1FUkVTVEFSVDsKLSAgICBjYXNlIDA6
Ci0gICAgICAgIHB1dF9wYWdlKHYtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKTsK
ICAgICB9CiAKKyAgICAvKgorICAgICAqIEl0IHNob3VsZG4ndCBiZSBwb3Nz
aWJsZSBmb3IgX3B1dF9wYWdlX3R5cGUoKSB0byByZXR1cm4KKyAgICAgKiBh
bnl0aGluZyBlbHNlIGF0IHRoZSBtb21lbnQ7IGJ1dCBpZiBpdCBkb2VzIGhh
cHBlbiBpbgorICAgICAqIHByb2R1Y3Rpb24sIGxlYWtpbmcgdGhlIHR5cGUg
cmVmIGlzIHByb2JhYmx5IHRoZSBiZXN0IHRoaW5nIHRvCisgICAgICogZG8u
ICBFaXRoZXIgd2F5LCBkcm9wIHRoZSBnZW5lcmFsIHJlZiBoZWxkIGJ5IG9s
ZF9ndWVzdF90YWJsZS4KKyAgICAgKi8KKyAgICBBU1NFUlQocmMgPT0gMCk7
CisKKyAgICBwdXRfcGFnZSh2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSk7CiAg
ICAgdi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBOVUxMOworICAgIHYtPmFy
Y2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOworICAgIC8qCisgICAgICogU2Fm
ZXN0IGRlZmF1bHQgaWYgc29tZW9uZSBzZXRzIG9sZF9ndWVzdF90YWJsZSB3
aXRob3V0CisgICAgICogZXhwbGljaXRseSBzZXR0aW5nIG9sZF9ndWVzdF90
YWJsZV9wYXJ0aWFsLgorICAgICAqLworICAgIHYtPmFyY2gub2xkX2d1ZXN0
X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogCiAgICAgcmV0dXJuIHJjOwogfQpA
QCAtMzE3NSwxMSArMzIzOCwxMSBAQCBpbnQgbmV3X2d1ZXN0X2NyMyhtZm5f
dCBtZm4pCiAgICAgICAgICAgICBzd2l0Y2ggKCByYyA9IHB1dF9wYWdlX2Fu
ZF90eXBlX3ByZWVtcHRpYmxlKHBhZ2UpICkKICAgICAgICAgICAgIHsKICAg
ICAgICAgICAgIGNhc2UgLUVJTlRSOgotICAgICAgICAgICAgICAgIHJjID0g
LUVSRVNUQVJUOwotICAgICAgICAgICAgICAgIC8qIGZhbGx0aHJvdWdoICov
CiAgICAgICAgICAgICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAg
ICBjdXJyLT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAg
ICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7Cisg
ICAgICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbCA9IChyYyA9PSAtRVJFU1RBUlQpOworICAgICAgICAgICAgICAgIHJj
ID0gLUVSRVNUQVJUOwogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg
ICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICBCVUdfT04ocmMpOwpA
QCAtMzQ0OCw2ICszNTExLDcgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAg
ICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGN1
cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAg
ICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdl
OworICAgICAgICAgICAgICAgICAgICAgICAgY3Vyci0+YXJjaC5vbGRfZ3Vl
c3RfdGFibGVfcGFydGlhbCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgfQpAQCAtMzQ4
Miw2ICszNTQ2LDExIEBAIGxvbmcgZG9fbW11ZXh0X29wKAogICAgICAgICAg
ICAgY2FzZSAtRVJFU1RBUlQ6CiAgICAgICAgICAgICAgICAgY3Vyci0+YXJj
aC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgY3Vy
ci0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOworICAgICAgICAgICAg
ICAgIC8qCisgICAgICAgICAgICAgICAgICogRUlOVFIgbWVhbnMgd2Ugc3Rp
bGwgaG9sZCB0aGUgdHlwZSByZWY7IEVSRVNUQVJUCisgICAgICAgICAgICAg
ICAgICogbWVhbnMgUEdUX3BhcnRpYWwgaG9sZHMgdGhlIHR5cGUgcmVmCisg
ICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgY3Vyci0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IChyYyA9PSAtRVJFU1RBUlQp
OwogICAgICAgICAgICAgICAgIHJjID0gMDsKICAgICAgICAgICAgICAgICBi
cmVhazsKICAgICAgICAgICAgIGRlZmF1bHQ6CkBAIC0zNTUwLDExICszNjE5
LDE1IEBAIGxvbmcgZG9fbW11ZXh0X29wKAogICAgICAgICAgICAgICAgIHN3
aXRjaCAoIHJjID0gcHV0X3BhZ2VfYW5kX3R5cGVfcHJlZW1wdGlibGUocGFn
ZSkgKQogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBjYXNl
IC1FSU5UUjoKLSAgICAgICAgICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7
Ci0gICAgICAgICAgICAgICAgICAgIC8qIGZhbGx0aHJvdWdoICovCiAgICAg
ICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6CiAgICAgICAgICAgICAgICAg
ICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAg
ICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBh
Z2U7CisgICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAg
ICAgICAqIEVJTlRSIG1lYW5zIHdlIHN0aWxsIGhvbGQgdGhlIHR5cGUgcmVm
OworICAgICAgICAgICAgICAgICAgICAgKiBFUkVTVEFSVCBtZWFucyBQR1Rf
cGFydGlhbCBob2xkcyB0aGUgcmVmCisgICAgICAgICAgICAgICAgICAgICAq
LworICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90
YWJsZV9wYXJ0aWFsID0gKHJjID09IC1FUkVTVEFSVCk7CisgICAgICAgICAg
ICAgICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICAgICAgICAgICAg
ICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAg
ICAgICAgICAgICBCVUdfT04ocmMpOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1
ZGUvYXNtLXg4Ni9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvZG9t
YWluLmgKaW5kZXggYWVjNjU2MzBkOS4uNWFmYWY2YjlkZSAxMDA2NDQKLS0t
IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaAorKysgYi94ZW4vaW5j
bHVkZS9hc20teDg2L2RvbWFpbi5oCkBAIC0zMTEsNyArMzExLDcgQEAgc3Ry
dWN0IGFyY2hfZG9tYWluCiAKICAgICBzdHJ1Y3QgcGFnaW5nX2RvbWFpbiBw
YWdpbmc7CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybTsKLSAgICAvKiBU
byBlbmZvcmNlIGxvY2sgb3JkZXJpbmcgaW4gdGhlIHBvZCBjb2RlIHdydCB0
aGUgCisgICAgLyogVG8gZW5mb3JjZSBsb2NrIG9yZGVyaW5nIGluIHRoZSBw
b2QgY29kZSB3cnQgdGhlCiAgICAgICogcGFnZV9hbGxvYyBsb2NrICovCiAg
ICAgaW50IHBhZ2VfYWxsb2NfdW5sb2NrX2xldmVsOwogCkBAIC01NTAsNiAr
NTUwLDggQEAgc3RydWN0IGFyY2hfdmNwdQogICAgIHN0cnVjdCBwYWdlX2lu
Zm8gKm9sZF9ndWVzdF90YWJsZTsgIC8qIHBhcnRpYWxseSBkZXN0cnVjdGVk
IHBhZ2V0YWJsZSAqLwogICAgIHN0cnVjdCBwYWdlX2luZm8gKm9sZF9ndWVz
dF9wdHBnOyAgIC8qIGNvbnRhaW5pbmcgcGFnZSB0YWJsZSBvZiB0aGUgKi8K
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBm
b3JtZXIsIGlmIGFueSAqLworICAgIGJvb2wgb2xkX2d1ZXN0X3RhYmxlX3Bh
cnRpYWw7ICAgICAgIC8qIEFyZSB3ZSBkcm9wcGluZyBhIHR5cGUgcmVmLCBv
ciBqdXN0CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICogZmluaXNoaW5nIHVwIGEgcGFydGlhbCBkZS12YWxpZGF0aW9uPyAq
LwogICAgIC8qIGd1ZXN0X3RhYmxlIGhvbGRzIGEgcmVmIHRvIHRoZSBwYWdl
LCBhbmQgYWxzbyBhIHR5cGUtY291bnQgdW5sZXNzCiAgICAgICogc2hhZG93
IHJlZmNvdW50cyBhcmUgaW4gdXNlICovCiAgICAgcGFnZXRhYmxlX3Qgc2hh
ZG93X3RhYmxlWzRdOyAgICAgICAgLyogKE1GTikgc2hhZG93KHMpIG9mIGd1
ZXN0ICovCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Transfer-Encoding: base64

RnJvbSA4NTJkZjI2OWQyNDdlMTc3ZDVmMmU5YjhmM2E0MzAxYTZmZGQ3NmJk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAxLzExXSB4
ODYvbW06IEwxVEYgY2hlY2tzIGRvbid0IGxlYXZlIGEgcGFydGlhbCBlbnRy
eQoKT24gZGV0ZWN0aW9uIG9mIGEgcG90ZW50aWFsIEwxVEYgaXNzdWUsIG1v
c3QgdmFsaWRhdGlvbiBjb2RlIHJldHVybnMKLUVSRVNUQVJUIHRvIGFsbG93
IHRoZSBzd2l0Y2ggdG8gc2hhZG93IG1vZGUgdG8gaGFwcGVuIGFuZCBjYXVz
ZSB0aGUKb3JpZ2luYWwgb3BlcmF0aW9uIHRvIGJlIHJlc3RhcnRlZC4KCkhv
d2V2ZXIsIGluIHRoZSB2YWxpZGF0aW9uIGNvZGUsIHRoZSByZXR1cm4gdmFs
dWUgLUVSRVNUQVJUIGhhcyBiZWVuCnJlcHVycG9zZWQgdG8gaW5kaWNhdGUg
MSkgdGhlIGZ1bmN0aW9uIGhhcyBwYXJ0aWFsbHkgY29tcGxldGVkCnNvbWV0
aGluZyB3aGljaCBuZWVkcyB0byBiZSB1bmRvbmUsIGFuZCAyKSBjYWxsaW5n
IHB1dF9wYWdlX3R5cGUoKQpzaG91bGQgY2xlYW5seSB1bmRvIGl0LiAgVGhp
cyBjYXVzZXMgcHJvYmxlbXMgaW4gc2V2ZXJhbCBwbGFjZXMuCgpGb3IgTDEg
dGFibGVzLCBvbiByZWNlaXZpbmcgYW4gLUVSRVNUQVJUIHJldHVybiBmcm9t
IGFsbG9jX2wxX3RhYmxlKCksCmFsbG9jX3BhZ2VfdHlwZSgpIHdpbGwgc2V0
IFBHVF9wYXJ0aWFsIG9uIHRoZSBwYWdlLiAgSWYgZm9yIHNvbWUKcmVhc29u
IHRoZSBvcmlnaW5hbCBvcGVyYXRpb24gbmV2ZXIgcmVzdGFydHMsIHRoZW4g
b24gZG9tYWluCmRlc3RydWN0aW9uLCByZWxpbnF1aXNoX21lbW9yeSgpIHdp
bGwgY2FsbCBmcmVlX3BhZ2VfdHlwZSgpIG9uIHRoZQpwYWdlLgoKVW5mb3J0
dW5hdGVseSwgYWxsb2NfIGFuZCBmcmVlX2wxX3RhYmxlKCkgYXJlbid0IHNl
dCB1cCB0byBkZWFsIHdpdGgKUEdUX3BhcnRpYWwuICBXaGVuIHJldHVybmlu
ZyBhIGZhaWx1cmUsIGFsbG9jX2wxX3RhYmxlKCkgYWx3YXlzCmRlLXZhbGlk
YXRlcyB3aGF0ZXZlciBpdCdzIHZhbGlkYXRlZCBzbyBmYXIsIGFuZCBmcmVl
X2wxX3RhYmxlKCkKYWx3YXlzIGRldmFsaWRhdGVzIHRoZSB3aG9sZSBwYWdl
LiAgVGhpcyBtZWFucyB0aGF0IGlmCnJlbGlucXVpc2hfbWVtb3J5KCkgY2Fs
bHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBhbiBMMSB0aGF0IGRpZG4ndApjb21w
bGV0ZSBkdWUgdG8gYW4gTDFURiwgaXQgd2lsbCBjYWxsIHB1dF9wYWdlX2Zy
b21fbDFlKCkgb24gInBhZ2UKZW50cmllcyIgdGhhdCBoYXZlIG5ldmVyIGJl
ZW4gdmFsaWRhdGVkLgoKRm9yIEwyKyB0YWJsZXMsIHNldHRpbmcgcmMgdG8g
RVJFU1RBUlQgY2F1c2VzIHRoZSByZXN0IG9mIHRoZQphbGxvY19sTl90YWJs
ZSgpIGZ1bmN0aW9uIHRvICp0aGluayogdGhhdCB0aGUgZW50cnkgaW4gcXVl
c3Rpb24gd2lsbApoYXZlIFBHVF9wYXJ0aWFsIHNldC4gIFRoaXMgd2lsbCBj
YXVzZSBpdCB0byBzZXQgcGFydGlhbF9wdGUgPSAxLiAgSWYKcmVsaW5xdXNo
X21lbW9yeSgpIHRoZW4gY2FsbHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBvbmUg
b2YgdGhvc2UgcGFnZXMsCnRoZW4gZnJlZV9sTl90YWJsZSgpIHdpbGwgY2Fs
bCBwdXRfcGFnZV9mcm9tX2xOZSgpIG9uIHRoZSBlbnRyeSB3aGVuCml0IHNo
b3VsZG4ndC4KClJhdGhlciB0aGFuIGluZGljYXRpbmcgLUVSRVNUQVJULCBp
bmRpY2F0ZSAtRUlOVFIuICBUaGlzIGlzIHRoZSBjb2RlCnRvIGluZGljYXRl
IHRoYXQgbm90aGluZyBoYXMgY2hhbmdlZCBmcm9tIHdoZW4geW91IHN0YXJ0
ZWQgdGhlIGNhbGwKKHdoaWNoIGlzIGVmZmVjdGl2ZWx5IGhvdyBhbGxvY19s
MV90YWJsZSgpIGhhbmRsZXMgZXJyb3JzKS4KCm1vZF9sTl9lbnRyeSgpIHNo
b3VsZG4ndCBoYXZlIGFueSBvZiB0aGVzZSB0eXBlcyBvZiBwcm9ibGVtcywg
c28gbGVhdmUKcG90ZW50aWFsIGNoYW5nZXMgdGhlcmUgZm9yIGEgY2xlYW4t
dXAgcGF0Y2ggbGF0ZXIuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJl
cG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5k
dW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDgg
KysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBlNmE0Y2IyOGY4Li44Y2VkMTg1
YjQ5IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTExMCw3ICsxMTEwLDcgQEAgZ2V0X3BhZ2Vf
ZnJvbV9sMmUoCiAgICAgaW50IHJjOwogCiAgICAgaWYgKCAhKGwyZV9nZXRf
ZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKLSAgICAgICAgcmV0dXJu
IHB2X2wxdGZfY2hlY2tfbDJlKGQsIGwyZSkgPyAtRVJFU1RBUlQgOiAxOwor
ICAgICAgICByZXR1cm4gcHZfbDF0Zl9jaGVja19sMmUoZCwgbDJlKSA/IC1F
SU5UUiA6IDE7CiAKICAgICBpZiAoIHVubGlrZWx5KChsMmVfZ2V0X2ZsYWdz
KGwyZSkgJiBMMl9ESVNBTExPV19NQVNLKSkgKQogICAgIHsKQEAgLTExNDIs
NyArMTE0Miw3IEBAIGdldF9wYWdlX2Zyb21fbDNlKAogICAgIGludCByYzsK
IAogICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QUkVT
RU5UKSApCi0gICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2wzZShkLCBs
M2UpID8gLUVSRVNUQVJUIDogMTsKKyAgICAgICAgcmV0dXJuIHB2X2wxdGZf
Y2hlY2tfbDNlKGQsIGwzZSkgPyAtRUlOVFIgOiAxOwogCiAgICAgaWYgKCB1
bmxpa2VseSgobDNlX2dldF9mbGFncyhsM2UpICYgbDNfZGlzYWxsb3dfbWFz
ayhkKSkpICkKICAgICB7CkBAIC0xMTc1LDcgKzExNzUsNyBAQCBnZXRfcGFn
ZV9mcm9tX2w0ZSgKICAgICBpbnQgcmM7CiAKICAgICBpZiAoICEobDRlX2dl
dF9mbGFncyhsNGUpICYgX1BBR0VfUFJFU0VOVCkgKQotICAgICAgICByZXR1
cm4gcHZfbDF0Zl9jaGVja19sNGUoZCwgbDRlKSA/IC1FUkVTVEFSVCA6IDE7
CisgICAgICAgIHJldHVybiBwdl9sMXRmX2NoZWNrX2w0ZShkLCBsNGUpID8g
LUVJTlRSIDogMTsKIAogICAgIGlmICggdW5saWtlbHkoKGw0ZV9nZXRfZmxh
Z3MobDRlKSAmIEw0X0RJU0FMTE9XX01BU0spKSApCiAgICAgewpAQCAtMTQw
NCw3ICsxNDA0LDcgQEAgc3RhdGljIGludCBhbGxvY19sMV90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHsKICAgICAgICAgaWYgKCAhKGwx
ZV9nZXRfZmxhZ3MocGwxZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIHJldCA9IHB2X2wxdGZfY2hlY2tfbDFlKGQs
IHBsMWVbaV0pID8gLUVSRVNUQVJUIDogMDsKKyAgICAgICAgICAgIHJldCA9
IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBsMWVbaV0pID8gLUVJTlRSIDogMDsK
ICAgICAgICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgICAgICBnb3Rv
IG91dDsKICAgICAgICAgfQotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Transfer-Encoding: base64

RnJvbSA2YmRkZGQ3OTgwZWFjMGNjODgzOTQ1ZDgyMzk4NmYyNDY4MmNhNDdh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAyLzExXSB4
ODYvbW06IERvbid0IHJlLXNldCBQR1RfcGlubmVkIG9uIGEgcGFydGlhbGx5
CiBkZS12YWxpZGF0ZWQgcGFnZQoKV2hlbiB1bnBpbm5pbmcgcGFnZXRhYmxl
cywgaWYgYW4gb3BlcmF0aW9uIGlzIGludGVycnVwdGVkLApyZWxpbnF1aXNo
X21lbW9yeSgpIHJlLXNldHMgUEdUX3Bpbm5lZCBzbyB0aGF0IHRoZSB1bi1w
aW4gd2lsbApwaWNrZWR1cCBhZ2FpbiB3aGVuIHRoZSBoeXBlcmNhbGwgcmVz
dGFydHMuCgpUaGlzIGlzIGFwcHJvcHJpYXRlIHdoZW4gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKSByZXR1cm5zCi1FSU5UUiwgd2hpY2ggaW5k
aWNhdGVzIHRoYXQgdGhlIHBhZ2UgaXMgYmFjayBpbiBpdHMgaW5pdGlhbCBz
dGF0ZQooaS5lLiwgY29tcGxldGVseSB2YWxpZGF0ZWQpLiAgSG93ZXZlciwg
Zm9yIC1FUkVTVEFSVCwgdGhpcyBsZWFkcyB0byBhCnN0YXRlIHdoZXJlIGEg
cGFnZSBoYXMgYm90aCBQR1RfcGlubmVkIGFuZCBQR1RfcGFydGlhbCBzZXQu
CgpUaGlzIGhhcHBlbnMgdG8gd29yayBhdCB0aGUgbW9tZW50LCBhbHRob3Vn
aCBpdCdzIG5vdCByZWFsbHkgYQoiY2Fub25pY2FsIiBzdGF0ZTsgYnV0IGlu
IHN1YnNlcXVlbnQgcGF0Y2hlcywgd2hlcmUgd2UgbmVlZCB0byBtYWtlIGEK
ZGlzdGluY3Rpb24gaW4gaGFuZGxpbmcgYmV0d2VlbiBQR1RfdmFsaWRhdGVk
IGFuZCBQR1RfcGFydGlhbCBwYWdlcywKdGhpcyBjYXVzZXMgaXNzdWVzLgoK
TW92ZSB0byBhICJjYW5vbmljYWwiIHN0YXRlIGJ5OgotIE9ubHkgcmUtc2V0
dGluZyBQR1RfcGlubmVkIG9uIC1FSU5UUgotIFJlLWRyb3BwaW5nIHRoZSBy
ZWZjb3VudCBoZWxkIGJ5IFBHVF9waW5uZWQgb24gLUVSRVNUQVJUCgpJbiB0
aGUgbGF0dGVyIGNhc2UsIHRoZSBQR1RfcGFydGlhbCBiaXQgd2lsbCBiZSBj
bGVhcmVkIGZ1cnRoZXIgZG93bgp3aXRoIHRoZSByZXN0IG9mIHRoZSBvdGhl
ciBQR1RfcGFydGlhbCBwYWdlcy4KCldoaWxlIGhlcmUsIGNsZWFuIHVwIHNv
bWUgdHJhaW5saW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVu
bGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tYWluLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggMjlmODkyYzA0Yy4uOGZiZWNi
YjE2OSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTEyLDcgKzExMiw3IEBAIHN0
YXRpYyB2b2lkIHBsYXlfZGVhZCh2b2lkKQogICAgICAqIHRoaXMgY2FzZSwg
aGVhcCBjb3JydXB0aW9uIG9yICNQRiBjYW4gb2NjdXIgKHdoZW4gaGVhcCBk
ZWJ1Z2dpbmcgaXMKICAgICAgKiBlbmFibGVkKS4gRm9yIGV4YW1wbGUsIGV2
ZW4gcHJpbnRrKCkgY2FuIGludm9sdmUgdGFza2xldCBzY2hlZHVsaW5nLAog
ICAgICAqIHdoaWNoIHRvdWNoZXMgcGVyLWNwdSB2YXJzLgotICAgICAqIAor
ICAgICAqCiAgICAgICogQ29uc2lkZXIgdmVyeSBjYXJlZnVsbHkgd2hlbiBh
ZGRpbmcgY29kZSB0byAqZGVhZF9pZGxlLiBNb3N0IGh5cGVydmlzb3IKICAg
ICAgKiBzdWJzeXN0ZW1zIGFyZSB1bnNhZmUgdG8gY2FsbC4KICAgICAgKi8K
QEAgLTE4MzgsOSArMTgzOCwzNCBAQCBzdGF0aWMgaW50IHJlbGlucXVpc2hf
bWVtb3J5KAogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLUVS
RVNUQVJUOgogICAgICAgICBjYXNlIC1FSU5UUjoKKyAgICAgICAgICAgIC8q
CisgICAgICAgICAgICAgKiAtRUlOVFIgbWVhbnMgUEdUX3ZhbGlkYXRlZCBo
YXMgYmVlbiByZS1zZXQ7IHJlLXNldAorICAgICAgICAgICAgICogUEdUX3Bp
bm5lZCBhZ2FpbiBzbyB0aGF0IGl0IGdldHMgcGlja2VkIHVwIG5leHQgdGlt
ZQorICAgICAgICAgICAgICogYXJvdW5kLgorICAgICAgICAgICAgICoKKyAg
ICAgICAgICAgICAqIC1FUkVTVEFSVCwgT1RPSCwgbWVhbnMgUEdUX3BhcnRp
YWwgaXMgc2V0IGluc3RlYWQuICBQdXQKKyAgICAgICAgICAgICAqIGl0IGJh
Y2sgb24gdGhlIGxpc3QsIGJ1dCBkb24ndCBzZXQgUEdUX3Bpbm5lZDsgdGhl
CisgICAgICAgICAgICAgKiBzZWN0aW9uIGJlbG93IHdpbGwgZmluaXNoIG9m
ZiBkZS12YWxpZGF0aW9uLiAgQnV0IHdlIGRvCisgICAgICAgICAgICAgKiBu
ZWVkIHRvIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGFzc29jaWF0ZWQgd2l0aAor
ICAgICAgICAgICAgICogUEdUX3Bpbm5lZCwgc2luY2UgcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKQorICAgICAgICAgICAgICogZGlkbid0IGRv
IGl0LgorICAgICAgICAgICAgICoKKyAgICAgICAgICAgICAqIE5CIHdlIGNh
biBkbyBhbiBBU1NFUlQgZm9yIFBHVF92YWxpZGF0ZWQsIHNpbmNlIHdlCisg
ICAgICAgICAgICAgKiAib3duIiB0aGUgdHlwZSByZWY7IGJ1dCB0aGVvcmV0
aWNhbGx5LCB0aGUgUEdUX3BhcnRpYWwKKyAgICAgICAgICAgICAqIGNvdWxk
IGJlIGNsZWFyZWQgYnkgc29tZW9uZSBlbHNlLgorICAgICAgICAgICAgICov
CisgICAgICAgICAgICBpZiAoIHJldCA9PSAtRUlOVFIgKQorICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIEFTU0VSVChwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmIFBHVF92YWxpZGF0ZWQpOworICAgICAgICAgICAgICAgIHNl
dF9iaXQoX1BHVF9waW5uZWQsICZwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICBlbHNlCisgICAgICAgICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CisKICAgICAgICAgICAgIHJldCA9IC1F
UkVTVEFSVDsKKworICAgICAgICAgICAgLyogUHV0IHRoZSBwYWdlIGJhY2sg
b24gdGhlIGxpc3QgYW5kIGRyb3AgdGhlIHJlZiB3ZSBncmFiYmVkIGFib3Zl
ICovCiAgICAgICAgICAgICBwYWdlX2xpc3RfYWRkKHBhZ2UsIGxpc3QpOwot
ICAgICAgICAgICAgc2V0X2JpdChfUEdUX3Bpbm5lZCwgJnBhZ2UtPnUuaW51
c2UudHlwZV9pbmZvKTsKICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwog
ICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIGRlZmF1bHQ6CkBAIC0y
MDYyLDcgKzIwODcsNyBAQCB2b2lkIHZjcHVfa2ljayhzdHJ1Y3QgdmNwdSAq
dikKICAgICAgKiBwZW5kaW5nIGZsYWcuIFRoZXNlIHZhbHVlcyBtYXkgZmx1
Y3R1YXRlIChhZnRlciBhbGwsIHdlIGhvbGQgbm8KICAgICAgKiBsb2Nrcykg
YnV0IHRoZSBrZXkgaW5zaWdodCBpcyB0aGF0IGVhY2ggY2hhbmdlIHdpbGwg
Y2F1c2UKICAgICAgKiBldnRjaG5fdXBjYWxsX3BlbmRpbmcgdG8gYmUgcG9s
bGVkLgotICAgICAqIAorICAgICAqCiAgICAgICogTkIyLiBXZSBzYXZlIHRo
ZSBydW5uaW5nIGZsYWcgYWNyb3NzIHRoZSB1bmJsb2NrIHRvIGF2b2lkIGEg
bmVlZGxlc3MKICAgICAgKiBJUEkgZm9yIGRvbWFpbnMgdGhhdCB3ZSBJUEkn
ZCB0byB1bmJsb2NrLgogICAgICAqLwotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Transfer-Encoding: base64

RnJvbSA3YzBhMzcwMDVmNTJkMTA5MDNjZTIyODUxYjUyYWU5YjZmNGYwZWUy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAzLzExXSB4
ODYvbW06IFNlcGFyYXRlIG91dCBwYXJ0aWFsX3B0ZSB0cmlzdGF0ZSBpbnRv
CiBpbmRpdmlkdWFsIGZsYWdzCgpBdCB0aGUgbW9tZW50LCBwYXJ0aWFsX3B0
ZSBpcyBhIHRyaS1zdGF0ZSB0aGF0IGNvbnRhaW5zIHR3byBkaXN0aW5jdCBi
aXRzCm9mIGluZm9ybWF0aW9uOgoKMS4gSWYgemVybywgdGhlIHB0ZSBhdCBp
bmRleCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHVuLXZhbGlkYXRlZC4gIElm
CiAgIG5vbi16ZXJvLCB0aGUgcHRlIHdhcyBsYXN0IHNlZW4gd2l0aCBQR1Rf
cGFydGlhbCBzZXQuCgoyLiBJZiBwb3NpdGl2ZSwgdGhlIHB0ZSBhdCBpbmRl
eCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGRvZXMgbm90IGhvbGQgYQogICBnZW5l
cmFsIHJlZmVyZW5jZSBjb3VudC4gIElmIG5lZ2F0aXZlLCBpdCBkb2VzLgoK
VG8gbWFrZSBmdXR1cmUgcGF0Y2hlcyBtb3JlIGNsZWFyLCBzZXBhcmF0ZSBv
dXQgdGhpcyBmdW5jdGlvbmFsaXR5CmludG8gdHdvIGRpc3RpbmN0LCBuYW1l
ZCBiaXRzOiBQVEZfcGFydGlhbF9zZXQgKGZvciAjMSkgYW5kClBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIChmb3IgIzIpLgoKQWRkaXRpb25hbGx5LCBhIG51
bWJlciBvZiBmdW5jdGlvbnMgd2hpY2ggbmVlZCB0aGlzIGluZm9ybWF0aW9u
IGFsc28KdGFrZSBvdGhlciBmbGFncyB0byBjb250cm9sIGJlaGF2aW9yIChz
dWNoIGFzIGBwcmVlbXB0aWJsZWAgYW5kCmBkZWZlcmApLiAgVGhlc2UgYXJl
IGhhcmQgdG8gcmVhZCBpbiB0aGUgY2FsbGVyIChzaW5jZSB5b3Ugb25seSBz
ZWUKJ3RydWUnIG9yICdmYWxzZScpLCBhbmQgdWdseSB3aGVuIG1hbnkgYXJl
IGFkZGVkIHRvZ2V0aGVyLiAgSW4KcHJlcGFyYXRpb24gZm9yIGFkZGluZyB5
ZXQgYW5vdGhlciBmbGFnIGluIGEgZnV0dXJlIHBhdGNoLCBjb2xsYXBzZQph
bGwgb2YgdGhlc2UgaW50byBhIHNpbmdsZSBgZmxhZ2AgdmFyaWFibGUuCgpO
QiB0aGF0IHRoaXMgZG9lcyBtZWFuIGNoZWNraW5nIGZvciB3aGF0IHdhcyBw
cmV2aW91c2x5IHRoZSAnLTEnCmNvbmRpdGlvbiBhIGJpdCBtb3JlIHVnbHkg
aW4gdGhlIHB1dF9wYWdlX2Zyb21fbE5lIGZ1bmN0aW9ucyAoc2luY2UKeW91
IGhhdmUgdG8gY2hlY2sgZm9yIGJvdGggcGFydGlhbF9zZXQgYW5kIGdlbmVy
YWwgcmVmKTsgYnV0IHRoaXMKY2xhdXNlIHdpbGwgZ28gYXdheSBpbiBhIGZ1
dHVyZSBwYXRjaC4KCkFsc28gbm90ZSB0aGF0IHRoZSBvcmlnaW5hbCBjb21t
ZW50IGhhZCBhbiBvZmYtYnktb25lIGVycm9yOgpwYXJ0aWFsX2ZsYWdzIChs
aWtlIHBhcnRpYWxfcHRlIGJlZm9yZSBpdCkgY29uY2VybnMKcGxOZVtucl92
YWxpZGF0ZWRfcHRlc10sIG5vdCBwbE5lW25yX3ZhbGlkYXRlZF9wdGVzKzFd
LgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyAgICAgICAgfCAxNjQgKysrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggfCAgNDEgKysrKysrLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCAxMjcgaW5z
ZXJ0aW9ucygrKSwgNzggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA4Y2Vk
MTg1YjQ5Li4xYzRmNTRlMzI4IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNjEwLDIwICs2MTAs
MzQgQEAgc3RhdGljIGludCBhbGxvY19zZWdkZXNjX3BhZ2Uoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSkKIHN0YXRpYyBpbnQgX2dldF9wYWdlX3R5cGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICBib29sIHByZWVtcHRpYmxlKTsKIAor
LyoKKyAqIFRoZSBmb2xsb3dpbmcgZmxhZ3MgYXJlIHVzZWQgdG8gc3BlY2lm
eSBiZWhhdmlvciBvZiB2YXJpb3VzIGdldCBhbmQKKyAqIHB1dCBjb21tYW5k
cy4gIFRoZSBmaXJzdCB0d28gYXJlIGFsc28gc3RvcmVkIGluIHBhZ2UtPnBh
cnRpYWxfZmxhZ3MKKyAqIHRvIGluZGljYXRlIHRoZSBzdGF0ZSBvZiB0aGUg
cGFnZSBwb2ludGVkIHRvIGJ5CisgKiBwYWdlLT5wdGVbcGFnZS0+bnJfdmFs
aWRhdGVkX2VudHJpZXNdLiAgU2VlIHRoZSBjb21tZW50IGluIG1tLmggZm9y
CisgKiBtb3JlIGluZm9ybWF0aW9uLgorICovCisjZGVmaW5lIFBURl9wYXJ0
aWFsX3NldCAgICAgICAgICgxIDw8IDApCisjZGVmaW5lIFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmICgxIDw8IDEpCisjZGVmaW5lIFBURl9wcmVlbXB0aWJs
ZSAgICAgICAgICgxIDw8IDIpCisjZGVmaW5lIFBURl9kZWZlciAgICAgICAg
ICAgICAgICgxIDw8IDMpCisKIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5
cGVfZnJvbV9tZm4oCiAgICAgbWZuX3QgbWZuLCB1bnNpZ25lZCBsb25nIHR5
cGUsIHN0cnVjdCBkb21haW4gKmQsCi0gICAgaW50IHBhcnRpYWwsIGludCBw
cmVlbXB0aWJsZSkKKyAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAg
c3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IG1mbl90b19wYWdlKG1mbik7CiAg
ICAgaW50IHJjOworICAgIGJvb2wgcHJlZW1wdGlibGUgPSBmbGFncyAmIFBU
Rl9wcmVlbXB0aWJsZSwKKyAgICAgICAgIHBhcnRpYWxfcmVmID0gZmxhZ3Mg
JiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKIAotICAgIGlmICggbGlrZWx5
KHBhcnRpYWwgPj0gMCkgJiYKKyAgICBpZiAoIGxpa2VseSghcGFydGlhbF9y
ZWYpICYmCiAgICAgICAgICB1bmxpa2VseSghZ2V0X3BhZ2VfZnJvbV9tZm4o
bWZuLCBkKSkgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAogICAgIHJj
ID0gX2dldF9wYWdlX3R5cGUocGFnZSwgdHlwZSwgcHJlZW1wdGlibGUpOwog
Ci0gICAgaWYgKCB1bmxpa2VseShyYykgJiYgcGFydGlhbCA+PSAwICYmCisg
ICAgaWYgKCB1bmxpa2VseShyYykgJiYgIXBhcnRpYWxfcmVmICYmCiAgICAg
ICAgICAoIXByZWVtcHRpYmxlIHx8IHBhZ2UgIT0gY3VycmVudC0+YXJjaC5v
bGRfZ3Vlc3RfdGFibGUpICkKICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CiAK
QEAgLTExMDQsNyArMTExOCw3IEBAIGdldF9wYWdlX2Zyb21fbDFlKAogZGVm
aW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGwyKTsKIHN0YXRpYyBpbnQKIGdl
dF9wYWdlX2Zyb21fbDJlKAotICAgIGwyX3BnZW50cnlfdCBsMmUsIHVuc2ln
bmVkIGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCBpbnQgcGFydGlhbCkK
KyAgICBsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3Ry
dWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIHVu
c2lnbmVkIGxvbmcgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKICAgICBpbnQg
cmM7CkBAIC0xMTE5LDggKzExMzMsOSBAQCBnZXRfcGFnZV9mcm9tX2wyZSgK
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgfQogCi0gICAgcmMgPSBn
ZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihfbWZuKG1mbiksIFBHVF9sMV9w
YWdlX3RhYmxlLCBkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcGFydGlhbCwgZmFsc2UpOworICAgIEFTU0VSVCghKGZsYWdzICYg
UFRGX3ByZWVtcHRpYmxlKSk7CisKKyAgICByYyA9IGdldF9wYWdlX2FuZF90
eXBlX2Zyb21fbWZuKF9tZm4obWZuKSwgUEdUX2wxX3BhZ2VfdGFibGUsIGQs
IGZsYWdzKTsKICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYm
IGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKGwyZSwgcGZuLCBkKSApCiAgICAg
ICAgIHJjID0gMDsKIApAQCAtMTEzNyw3ICsxMTUyLDcgQEAgZ2V0X3BhZ2Vf
ZnJvbV9sMmUoCiBkZWZpbmVfZ2V0X2xpbmVhcl9wYWdldGFibGUobDMpOwog
c3RhdGljIGludAogZ2V0X3BhZ2VfZnJvbV9sM2UoCi0gICAgbDNfcGdlbnRy
eV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4gKmQs
IGludCBwYXJ0aWFsKQorICAgIGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVk
IGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBpbnQgZmxh
Z3MpCiB7CiAgICAgaW50IHJjOwogCkBAIC0xMTUyLDcgKzExNjcsNyBAQCBn
ZXRfcGFnZV9mcm9tX2wzZSgKICAgICB9CiAKICAgICByYyA9IGdldF9wYWdl
X2FuZF90eXBlX2Zyb21fbWZuKAotICAgICAgICBsM2VfZ2V0X21mbihsM2Up
LCBQR1RfbDJfcGFnZV90YWJsZSwgZCwgcGFydGlhbCwgMSk7CisgICAgICAg
IGwzZV9nZXRfbWZuKGwzZSksIFBHVF9sMl9wYWdlX3RhYmxlLCBkLCBmbGFn
cyB8IFBURl9wcmVlbXB0aWJsZSk7CiAgICAgaWYgKCB1bmxpa2VseShyYyA9
PSAtRUlOVkFMKSAmJgogICAgICAgICAgIWlzX3B2XzMyYml0X2RvbWFpbihk
KSAmJgogICAgICAgICAgZ2V0X2wzX2xpbmVhcl9wYWdldGFibGUobDNlLCBw
Zm4sIGQpICkKQEAgLTExNzAsNyArMTE4NSw3IEBAIGdldF9wYWdlX2Zyb21f
bDNlKAogZGVmaW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGw0KTsKIHN0YXRp
YyBpbnQKIGdldF9wYWdlX2Zyb21fbDRlKAotICAgIGw0X3BnZW50cnlfdCBs
NGUsIHVuc2lnbmVkIGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCBpbnQg
cGFydGlhbCkKKyAgICBsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25n
IHBmbiwgc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQog
ewogICAgIGludCByYzsKIApAQCAtMTE4NSw3ICsxMjAwLDcgQEAgZ2V0X3Bh
Z2VfZnJvbV9sNGUoCiAgICAgfQogCiAgICAgcmMgPSBnZXRfcGFnZV9hbmRf
dHlwZV9mcm9tX21mbigKLSAgICAgICAgbDRlX2dldF9tZm4obDRlKSwgUEdU
X2wzX3BhZ2VfdGFibGUsIGQsIHBhcnRpYWwsIDEpOworICAgICAgICBsNGVf
Z2V0X21mbihsNGUpLCBQR1RfbDNfcGFnZV90YWJsZSwgZCwgZmxhZ3MgfCBQ
VEZfcHJlZW1wdGlibGUpOwogICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJ
TlZBTCkgJiYgZ2V0X2w0X2xpbmVhcl9wYWdldGFibGUobDRlLCBwZm4sIGQp
ICkKICAgICAgICAgcmMgPSAwOwogCkBAIC0xMjc1LDcgKzEyOTAsNyBAQCB2
b2lkIHB1dF9wYWdlX2Zyb21fbDFlKGwxX3BnZW50cnlfdCBsMWUsIHN0cnVj
dCBkb21haW4gKmwxZV9vd25lcikKICAqIE5vdGUgYWxzbyB0aGF0IHRoaXMg
YXV0b21hdGljYWxseSBkZWFscyBjb3JyZWN0bHkgd2l0aCBsaW5lYXIgcC50
LidzLgogICovCiBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3Bn
ZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpbnQgcGFydGlhbCwgYm9vbCBkZWZlcikKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdz
KQogewogICAgIGludCByYyA9IDA7CiAKQEAgLTEyOTUsMTIgKzEzMTAsMTMg
QEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3Qg
bDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgc3RydWN0IHBhZ2Vf
aW5mbyAqcGcgPSBsMmVfZ2V0X3BhZ2UobDJlKTsKICAgICAgICAgc3RydWN0
IHBhZ2VfaW5mbyAqcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CiAK
LSAgICAgICAgaWYgKCB1bmxpa2VseShwYXJ0aWFsID4gMCkgKQorICAgICAg
ICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZikpID09CisgICAgICAgICAgICAgIFBURl9wYXJ0aWFs
X3NldCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIEFTU0VSVCghZGVmZXIp
OworICAgICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsK
ICAgICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIHB0
cGcpOwogICAgICAgICB9Ci0gICAgICAgIGVsc2UgaWYgKCBkZWZlciApCisg
ICAgICAgIGVsc2UgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgICAg
IHsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcg
PSBwdHBnOwogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3Rf
dGFibGUgPSBwZzsKQEAgLTEzMTcsNyArMTMzMyw3IEBAIHN0YXRpYyBpbnQg
cHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQg
bG9uZyBwZm4sCiB9CiAKIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2Uo
bDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVy
KQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQg
ZmxhZ3MpCiB7CiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGc7CiAgICAgaW50
IHJjOwpAQCAtMTM0MCwxMyArMTM1NiwxNCBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcg
cGZuLAogCiAgICAgcGcgPSBsM2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlm
ICggdW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICBpZiAoIChmbGFncyAm
IChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikp
ID09CisgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgIHsKLSAgICAg
ICAgQVNTRVJUKCFkZWZlcik7CisgICAgICAgIEFTU0VSVCghKGZsYWdzICYg
UFRGX2RlZmVyKSk7CiAgICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShw
ZywgdHJ1ZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CiAgICAgfQogCi0g
ICAgaWYgKCBkZWZlciApCisgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciAp
CiAgICAgewogICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBn
ID0gbWZuX3RvX3BhZ2UoX21mbihwZm4pKTsKICAgICAgICAgY3VycmVudC0+
YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKQEAgLTEzNjEsNyArMTM3OCw3
IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90
IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sCiB9CiAKIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBwYXJ0
aWFsLCBib29sIGRlZmVyKQorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAgaW50IHJjID0gMTsKIApA
QCAtMTM3MCwxMyArMTM4NywxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgIHsKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBsNGVfZ2V0
X3BhZ2UobDRlKTsKIAotICAgICAgICBpZiAoIHVubGlrZWx5KHBhcnRpYWwg
PiAwKSApCisgICAgICAgIGlmICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3Nl
dCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KKyAgICAgICAgICAg
ICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAgewotICAgICAgICAgICAg
QVNTRVJUKCFkZWZlcik7CisgICAgICAgICAgICBBU1NFUlQoIShmbGFncyAm
IFBURl9kZWZlcikpOwogICAgICAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90
eXBlKHBnLCB0cnVlLCBtZm5fdG9fcGFnZShfbWZuKHBmbikpKTsKICAgICAg
ICAgfQogCi0gICAgICAgIGlmICggZGVmZXIgKQorICAgICAgICBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKICAgICAgICAgewogICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4o
cGZuKSk7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90
YWJsZSA9IHBnOwpAQCAtMTQ4MywxMiArMTUwMSwxMyBAQCBzdGF0aWMgaW50
IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2ln
bmVkIGxvbmcgdHlwZSkKICAgICB1bnNpZ25lZCBsb25nICBwZm4gPSBtZm5f
eChwYWdlX3RvX21mbihwYWdlKSk7CiAgICAgbDJfcGdlbnRyeV90ICAqcGwy
ZTsKICAgICB1bnNpZ25lZCBpbnQgICBpOwotICAgIGludCAgICAgICAgICAg
IHJjID0gMCwgcGFydGlhbCA9IHBhZ2UtPnBhcnRpYWxfcHRlOworICAgIGlu
dCAgICAgICAgICAgIHJjID0gMDsKKyAgICB1bnNpZ25lZCBpbnQgICBwYXJ0
aWFsX2ZsYWdzID0gcGFnZS0+cGFydGlhbF9mbGFnczsKIAogICAgIHBsMmUg
PSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4pKTsKIAogICAgIGZvciAoIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwyX1BBR0VUQUJMRV9F
TlRSSUVTOwotICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQorICAgICAg
ICAgIGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQogICAgIHsKICAgICAgICAg
aWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYgaHlwZXJjYWxs
X3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgIHsKQEAgLTE0OTgsMTggKzE1
MTcsMTkgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAgICAgIH0K
IAogICAgICAgICBpZiAoICFpc19ndWVzdF9sMl9zbG90KGQsIHR5cGUsIGkp
IHx8Ci0gICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwy
ZVtpXSwgcGZuLCBkLCBwYXJ0aWFsKSkgPiAwICkKKyAgICAgICAgICAgICAo
cmMgPSBnZXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIGQsIHBhcnRp
YWxfZmxhZ3MpKSA+IDAgKQogICAgICAgICAgICAgY29udGludWU7CiAKICAg
ICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgICAgICB7CiAgICAg
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzogMTsKKyAgICAg
ICAgICAgIC8qIFNldCAnc2V0JywgcmV0YWluICdnZW5lcmFsIHJlZicgKi8K
KyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2Zs
YWdzIHwgUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAgICAgIGVs
c2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsKICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICAgICAgcmMgPSAtRVJFU1RB
UlQ7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjIDwgMCAmJiBy
YyAhPSAtRUlOVFIgKQpAQCAtMTUxOCw3ICsxNTM4LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUpCiAgICAgICAgICAgICBpZiAoIGkgKQogICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9w
dGVzID0gaTsKLSAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IDA7CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7
CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRw
ZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICAgICAgfQpAQCAtMTU0Miw3
ICsxNTYyLDggQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlKQogICAgIHVuc2lnbmVkIGxvbmcgIHBmbiA9IG1m
bl94KHBhZ2VfdG9fbWZuKHBhZ2UpKTsKICAgICBsM19wZ2VudHJ5X3QgICpw
bDNlOwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAg
ICAgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7CisgICAg
aW50ICAgICAgICAgICAgcmMgPSAwOworICAgIHVuc2lnbmVkIGludCAgIHBh
cnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCiAgICAgcGwz
ZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCkBAIC0xNTU3LDcg
KzE1NzgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCiAgICAgICAgIG1lbXNldChwbDNlICsgNCwgMCwg
KEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gNCkgKiBzaXplb2YoKnBsM2UpKTsK
IAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8
IEwzX1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywgcGFydGlh
bCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9IDAgKQog
ICAgIHsKICAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0
ZXMgJiYgaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgIHsK
QEAgLTE1NzQsMjAgKzE1OTUsMjIgQEAgc3RhdGljIGludCBhbGxvY19sM190
YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4oCiAgICAgICAgICAgICAgICAgICAgIGwzZV9nZXRfbWZuKHBsM2Vb
aV0pLAotICAgICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90YWJsZSB8
IFBHVF9wYWVfeGVuX2wyLCBkLCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgICAg
ICAgICAgICAgUEdUX2wyX3BhZ2VfdGFibGUgfCBQR1RfcGFlX3hlbl9sMiwg
ZCwKKyAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8IFBURl9w
cmVlbXB0aWJsZSk7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIChy
YyA9IGdldF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0sIHBmbiwgZCwgcGFydGlh
bCkpID4gMCApCisgICAgICAgIGVsc2UgaWYgKCAocmMgPSBnZXRfcGFnZV9m
cm9tX2wzZShwbDNlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAg
KQogICAgICAgICAgICAgY29udGludWU7CiAKICAgICAgICAgaWYgKCByYyA9
PSAtRVJFU1RBUlQgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5u
cl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBwYWdlLT5wYXJ0
aWFsX3B0ZSA9IHBhcnRpYWwgPzogMTsKKyAgICAgICAgICAgIC8qIFNldCAn
c2V0JywgbGVhdmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3
YXMgc2V0ICovCisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0g
cGFydGlhbF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAgfQog
ICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7
Ci0gICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgIHJj
ID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlmICggcmMgPCAw
ICkKQEAgLTE2MDQsNyArMTYyNyw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgaWYgKCBp
ICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXMgPSBpOwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAw
OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAgICAg
ICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsK
ICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0g
cGFnZTsKICAgICAgICAgfQpAQCAtMTczNiwxOSArMTc1OSwyMSBAQCBzdGF0
aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgdW5zaWduZWQgbG9uZyAgcGZuID0gbWZuX3gocGFnZV90b19tZm4o
cGFnZSkpOwogICAgIGw0X3BnZW50cnlfdCAgKnBsNGUgPSBtYXBfZG9tYWlu
X3BhZ2UoX21mbihwZm4pKTsKICAgICB1bnNpZ25lZCBpbnQgICBpOwotICAg
IGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlhbCA9IHBhZ2UtPnBhcnRp
YWxfcHRlOworICAgIGludCAgICAgICAgICAgIHJjID0gMDsKKyAgICB1bnNp
Z25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+cGFydGlhbF9mbGFn
czsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsg
aSA8IEw0X1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywgcGFy
dGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9IDAg
KQogICAgIHsKICAgICAgICAgaWYgKCAhaXNfZ3Vlc3RfbDRfc2xvdChkLCBp
KSB8fAotICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDRlKHBs
NGVbaV0sIHBmbiwgZCwgcGFydGlhbCkpID4gMCApCisgICAgICAgICAgICAg
KHJjID0gZ2V0X3BhZ2VfZnJvbV9sNGUocGw0ZVtpXSwgcGZuLCBkLCBwYXJ0
aWFsX2ZsYWdzKSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCiAg
ICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAgewogICAg
ICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IDE7CisgICAg
ICAgICAgICAvKiBTZXQgJ3NldCcsIGxlYXZlICdnZW5lcmFsIHJlZicgc2V0
IGlmIHRoaXMgZW50cnkgd2FzIHNldCAqLworICAgICAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3MgfCBQVEZfcGFydGlhbF9z
ZXQ7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjIDwgMCApCiAg
ICAgICAgIHsKQEAgLTE3NTgsNyArMTc4Myw3IEBAIHN0YXRpYyBpbnQgYWxs
b2NfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAg
ICAgIGlmICggaSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAg
cGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgICAg
IHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAgICAgICBpZiAoIHJj
ID09IC1FSU5UUiApCiAgICAgICAgICAgICAgICAgICAgIHJjID0gLUVSRVNU
QVJUOwogICAgICAgICAgICAgICAgIGVsc2UKQEAgLTE4MTEsMTkgKzE4MzYs
MjAgQEAgc3RhdGljIGludCBmcmVlX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UpCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293
bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcgcGZuID0gbWZuX3gocGFn
ZV90b19tZm4ocGFnZSkpOwogICAgIGwyX3BnZW50cnlfdCAqcGwyZTsKLSAg
ICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0g
ICAgdW5zaWduZWQgaW50IGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAt
ICFwYXJ0aWFsOworICAgIGludCByYyA9IDA7CisgICAgdW5zaWduZWQgaW50
IHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzLAorICAgICAg
ICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhKHBhcnRpYWxfZmxh
Z3MgJiBQVEZfcGFydGlhbF9zZXQpOwogCiAgICAgcGwyZSA9IG1hcF9kb21h
aW5fcGFnZShfbWZuKHBmbikpOwogCiAgICAgZm9yICggOyA7ICkKICAgICB7
CiAgICAgICAgIGlmICggaXNfZ3Vlc3RfbDJfc2xvdChkLCBwYWdlLT51Lmlu
dXNlLnR5cGVfaW5mbywgaSkgKQotICAgICAgICAgICAgcmMgPSBwdXRfcGFn
ZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIHBhcnRpYWwsIGZhbHNlKTsKKyAg
ICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZu
LCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAg
ICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgcGFydGlhbCA9IDA7CisgICAg
ICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogCiAgICAgICAgIGlmICggIWktLSAp
CiAgICAgICAgICAgICBicmVhazsKQEAgLTE4NDUsMTIgKzE4NzEsMTQgQEAg
c3RhdGljIGludCBmcmVlX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgZWxzZSBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewog
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAg
IHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAtMTsKKyAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3Bh
cnRpYWxfc2V0KSA/CisgICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoKKyAg
ICAgICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5l
cmFsX3JlZik7CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIg
JiYgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAgICAgewogICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGkgKyAxOwotICAgICAg
ICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSAwOwogICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICB9
CiAKQEAgLTE4NjIsMTggKzE4OTAsMTkgQEAgc3RhdGljIGludCBmcmVlX2wz
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgc3RydWN0IGRv
bWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVk
IGxvbmcgcGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwogICAgIGwz
X3BnZW50cnlfdCAqcGwzZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0g
cGFnZS0+cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50ICBpID0gcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhcGFydGlhbDsKKyAgICBpbnQgcmMg
PSAwOworICAgIHVuc2lnbmVkIGludCBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+
cGFydGlhbF9mbGFncywKKyAgICAgICAgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRl
ZF9wdGVzIC0gIShwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KTsK
IAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4pKTsKIAog
ICAgIGZvciAoIDsgOyApCiAgICAgewotICAgICAgICByYyA9IHB1dF9wYWdl
X2Zyb21fbDNlKHBsM2VbaV0sIHBmbiwgcGFydGlhbCwgMCk7CisgICAgICAg
IHJjID0gcHV0X3BhZ2VfZnJvbV9sM2UocGwzZVtpXSwgcGZuLCBwYXJ0aWFs
X2ZsYWdzKTsKICAgICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICAgICAg
YnJlYWs7CiAKLSAgICAgICAgcGFydGlhbCA9IDA7CisgICAgICAgIHBhcnRp
YWxfZmxhZ3MgPSAwOwogICAgICAgICBpZiAoIHJjID09IDAgKQogICAgICAg
ICAgICAgcGwzZVtpXSA9IHVuYWRqdXN0X2d1ZXN0X2wzZShwbDNlW2ldLCBk
KTsKIApAQCAtMTg5MiwxMiArMTkyMSwxNCBAQCBzdGF0aWMgaW50IGZyZWVf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAoIHJj
ID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
cGFydGlhbCA/OiAtMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/CisgICAgICAg
ICAgICBwYXJ0aWFsX2ZsYWdzIDoKKyAgICAgICAgICAgIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CiAgICAgfQogICAg
IGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTIC0gMSApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGkgKyAxOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IDA7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAg
ICByYyA9IC1FUkVTVEFSVDsKICAgICB9CiAgICAgcmV0dXJuIHJjID4gMCA/
IDAgOiByYzsKQEAgLTE5MDgsMjYgKzE5MzksMjkgQEAgc3RhdGljIGludCBm
cmVlX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgc3Ry
dWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogICAgIHVu
c2lnbmVkIGxvbmcgcGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwog
ICAgIGw0X3BnZW50cnlfdCAqcGw0ZSA9IG1hcF9kb21haW5fcGFnZShfbWZu
KHBmbikpOwotICAgIGludCByYyA9IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0
aWFsX3B0ZTsKLSAgICB1bnNpZ25lZCBpbnQgIGkgPSBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyAtICFwYXJ0aWFsOworICAgIGludCByYyA9IDA7CisgICAg
dW5zaWduZWQgcGFydGlhbF9mbGFncyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3Ms
CisgICAgICAgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICEocGFy
dGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCk7CiAKICAgICBkbyB7CiAg
ICAgICAgIGlmICggaXNfZ3Vlc3RfbDRfc2xvdChkLCBpKSApCi0gICAgICAg
ICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDRlKHBsNGVbaV0sIHBmbiwgcGFy
dGlhbCwgMCk7CisgICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDRl
KHBsNGVbaV0sIHBmbiwgcGFydGlhbF9mbGFncyk7CiAgICAgICAgIGlmICgg
cmMgPCAwICkKICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICBwYXJ0aWFs
ID0gMDsKKyAgICAgICAgcGFydGlhbF9mbGFncyA9IDA7CiAgICAgfSB3aGls
ZSAoIGktLSApOwogCiAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAg
IHsKICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAg
ICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzogLTE7CisgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAocGFydGlhbF9mbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCkgPworICAgICAgICAgICAgcGFydGlhbF9mbGFncyA6
CisgICAgICAgICAgICAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYpOwogICAgIH0KICAgICBlbHNlIGlmICggcmMgPT0gLUVJ
TlRSICYmIGkgPCBMNF9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQogICAgIHsK
ICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpICsgMTsKLSAg
ICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAwOworICAgICAgICBwYWdlLT5w
YXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAg
ICAgfQogCkBAIC0yMjAzLDcgKzIyMzcsNyBAQCBzdGF0aWMgaW50IG1vZF9s
Ml9lbnRyeShsMl9wZ2VudHJ5X3QgKnBsMmUsCiAgICAgICAgIHJldHVybiAt
RUJVU1k7CiAgICAgfQogCi0gICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwg
cGZuLCAwLCB0cnVlKTsKKyAgICBwdXRfcGFnZV9mcm9tX2wyZShvbDJlLCBw
Zm4sIFBURl9kZWZlcik7CiAKICAgICByZXR1cm4gcmM7CiB9CkBAIC0yMjcx
LDcgKzIzMDUsNyBAQCBzdGF0aWMgaW50IG1vZF9sM19lbnRyeShsM19wZ2Vu
dHJ5X3QgKnBsM2UsCiAgICAgICAgIGlmICggIWNyZWF0ZV9wYWVfeGVuX21h
cHBpbmdzKGQsIHBsM2UpICkKICAgICAgICAgICAgIEJVRygpOwogCi0gICAg
cHV0X3BhZ2VfZnJvbV9sM2Uob2wzZSwgcGZuLCAwLCAxKTsKKyAgICBwdXRf
cGFnZV9mcm9tX2wzZShvbDNlLCBwZm4sIFBURl9kZWZlcik7CiAgICAgcmV0
dXJuIHJjOwogfQogCkBAIC0yMzM0LDcgKzIzNjgsNyBAQCBzdGF0aWMgaW50
IG1vZF9sNF9lbnRyeShsNF9wZ2VudHJ5X3QgKnBsNGUsCiAgICAgICAgIHJl
dHVybiAtRUZBVUxUOwogICAgIH0KIAotICAgIHB1dF9wYWdlX2Zyb21fbDRl
KG9sNGUsIHBmbiwgMCwgMSk7CisgICAgcHV0X3BhZ2VfZnJvbV9sNGUob2w0
ZSwgcGZuLCBQVEZfZGVmZXIpOwogICAgIHJldHVybiByYzsKIH0KIApAQCAt
MjU5OCw3ICsyNjMyLDcgQEAgaW50IGZyZWVfcGFnZV90eXBlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSwKICAgICBpZiAo
ICEodHlwZSAmIFBHVF9wYXJ0aWFsKSApCiAgICAgewogICAgICAgICBwYWdl
LT5ucl92YWxpZGF0ZWRfcHRlcyA9IDFVIDw8IFBBR0VUQUJMRV9PUkRFUjsK
LSAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAwOworICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICB9CiAKICAgICBzd2l0Y2ggKCB0
eXBlICYgUEdUX3R5cGVfbWFzayApCkBAIC0yODg5LDcgKzI5MjMsNyBAQCBz
dGF0aWMgaW50IF9nZXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UsIHVuc2lnbmVkIGxvbmcgdHlwZSwKICAgICAgICAgaWYgKCAhKHggJiBQ
R1RfcGFydGlhbCkgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5u
cl92YWxpZGF0ZWRfcHRlcyA9IDA7Ci0gICAgICAgICAgICBwYWdlLT5wYXJ0
aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gMDsKICAgICAgICAgfQogICAgICAgICBwYWdlLT5saW5lYXJfcHRfY291
bnQgPSAwOwogICAgICAgICByYyA9IGFsbG9jX3BhZ2VfdHlwZShwYWdlLCB0
eXBlLCBwcmVlbXB0aWJsZSk7CkBAIC0zMDY0LDcgKzMwOTgsNyBAQCBpbnQg
bmV3X2d1ZXN0X2NyMyhtZm5fdCBtZm4pCiAgICAgICAgIHJldHVybiAwOwog
ICAgIH0KIAotICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4o
bWZuLCBQR1Rfcm9vdF9wYWdlX3RhYmxlLCBkLCAwLCAxKTsKKyAgICByYyA9
IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKG1mbiwgUEdUX3Jvb3RfcGFn
ZV90YWJsZSwgZCwgUFRGX3ByZWVtcHRpYmxlKTsKICAgICBzd2l0Y2ggKCBy
YyApCiAgICAgewogICAgIGNhc2UgMDoKQEAgLTM0NTIsNyArMzQ4Niw3IEBA
IGxvbmcgZG9fbW11ZXh0X29wKAogICAgICAgICAgICAgaWYgKCBvcC5hcmcx
Lm1mbiAhPSAwICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBy
YyA9IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAotICAgICAgICAgICAg
ICAgICAgICBfbWZuKG9wLmFyZzEubWZuKSwgUEdUX3Jvb3RfcGFnZV90YWJs
ZSwgY3VycmQsIDAsIDEpOworICAgICAgICAgICAgICAgICAgICBfbWZuKG9w
LmFyZzEubWZuKSwgUEdUX3Jvb3RfcGFnZV90YWJsZSwgY3VycmQsIFBURl9w
cmVlbXB0aWJsZSk7CiAKICAgICAgICAgICAgICAgICBpZiAoIHVubGlrZWx5
KHJjKSApCiAgICAgICAgICAgICAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9tbS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5o
CmluZGV4IDFlYTE3M2M1NTUuLjQ2Y2JhNTI5NDEgMTAwNjQ0Ci0tLSBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbW0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20t
eDg2L21tLmgKQEAgLTIyOCwxOSArMjI4LDM0IEBAIHN0cnVjdCBwYWdlX2lu
Zm8KICAgICAgICAgICogc2V0dGluZyB0aGUgZmxhZyBtdXN0IG5vdCBkcm9w
IHRoYXQgcmVmZXJlbmNlLCB3aGVyZWFzIHRoZSBpbnN0YW5jZQogICAgICAg
ICAgKiBjbGVhcmluZyBpdCB3aWxsIGhhdmUgdG8uCiAgICAgICAgICAqCi0g
ICAgICAgICAqIElmIEBwYXJ0aWFsX3B0ZSBpcyBwb3NpdGl2ZSB0aGVuIFBU
RSBhdCBAbnJfdmFsaWRhdGVkX3B0ZXMrMSBoYXMKLSAgICAgICAgICogYmVl
biBwYXJ0aWFsbHkgdmFsaWRhdGVkLiBUaGlzIGltcGxpZXMgdGhhdCB0aGUg
Z2VuZXJhbCByZWZlcmVuY2UKLSAgICAgICAgICogdG8gdGhlIHBhZ2UgKGFj
cXVpcmVkIGZyb20gZ2V0X3BhZ2VfZnJvbV9sTmUoKSkgd291bGQgYmUgZHJv
cHBlZAotICAgICAgICAgKiAoYWdhaW4gZHVlIHRvIHRoZSBhcHBhcmVudCBm
YWlsdXJlKSBhbmQgaGVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZAotICAgICAg
ICAgKiB3aGVuIHJlc3VtaW5nIHRoZSB2YWxpZGF0aW9uLCBidXQgbXVzdCBu
b3QgYmUgZHJvcHBlZCB3aGVuIHBpY2tpbmcKLSAgICAgICAgICogdXAgdGhl
IHBhZ2UgZm9yIGludmFsaWRhdGlvbi4KKyAgICAgICAgICogSWYgcGFydGlh
bF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCBpcyBzZXQsIHRoZW4gdGhlIHBh
Z2UgYXQKKyAgICAgICAgICogYXQgQG5yX3ZhbGlkYXRlZF9wdGVzIGhhZCBQ
R1RfcGFydGlhbCBzZXQgYXMgYSByZXN1bHQgb2YgYW4KKyAgICAgICAgICog
b3BlcmF0aW9uIG9uIHRoZSBjdXJyZW50IHBhZ2UuICAoVGhhdCBwYWdlIG1h
eSBvciBtYXkgbm90CisgICAgICAgICAqIHN0aWxsIGhhdmUgUEdUX3BhcnRp
YWwgc2V0LikKICAgICAgICAgICoKLSAgICAgICAgICogSWYgQHBhcnRpYWxf
cHRlIGlzIG5lZ2F0aXZlIHRoZW4gUFRFIGF0IEBucl92YWxpZGF0ZWRfcHRl
cysxIGhhcwotICAgICAgICAgKiBiZWVuIHBhcnRpYWxseSBpbnZhbGlkYXRl
ZC4gVGhpcyBpcyBiYXNpY2FsbHkgdGhlIG9wcG9zaXRlIGNhc2Ugb2YKLSAg
ICAgICAgICogYWJvdmUsIGkuZS4gdGhlIGdlbmVyYWwgcmVmZXJlbmNlIHRv
IHRoZSBwYWdlIHdhcyBub3QgZHJvcHBlZCBpbgotICAgICAgICAgKiBwdXRf
cGFnZV9mcm9tX2xOZSgpIChkdWUgdG8gdGhlIGFwcGFyZW50IGZhaWx1cmUp
LCBhbmQgaGVuY2UgaXQKLSAgICAgICAgICogbXVzdCBiZSBkcm9wcGVkIHdo
ZW4gdGhlIHB1dCBvcGVyYXRpb24gaXMgcmVzdW1lZCAoYW5kIGNvbXBsZXRl
cyksCi0gICAgICAgICAqIGJ1dCBpdCBtdXN0IG5vdCBiZSBhY3F1aXJlZCBp
ZiBwaWNraW5nIHVwIHRoZSBwYWdlIGZvciB2YWxpZGF0aW9uLgorICAgICAg
ICAgKiBJZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcyBzZXQsIHRoZW4g
dGhlIFBURSBhdAorICAgICAgICAgKiBAbnJfdmFsaWRhdGVkX3B0ZWYgaG9s
ZHMgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBmb3IgdGhlCisgICAgICAg
ICAqIHBhZ2UuCisgICAgICAgICAqCisgICAgICAgICAqIFRoaXMgaGFwcGVu
czoKKyAgICAgICAgICogLSBEdXJpbmcgZGUtdmFsaWRhdGlvbiwgaWYgZGUt
dmFsaWRhdGlvbiBvZiB0aGUgcGFnZSB3YXMKKyAgICAgICAgICogICBpbnRl
cnJ1cHRlZAorICAgICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBh
biBpbnZhbGlkIGVudHJ5IGlzIGVuY291bnRlcmVkIGFuZAorICAgICAgICAg
KiAgIHZhbGlkYXRpb24gaXMgcHJlZW1wdGlibGUKKyAgICAgICAgICogLSBE
dXJpbmcgdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYg
d2FzIHNldCBvbgorICAgICAgICAgKiAgIHRoaXMgZW50cnkgdG8gYmVnaW4g
d2l0aCAocGVyaGFwcyBiZWNhdXNlIHdlJ3JlIHBpY2tpbmcKKyAgICAgICAg
ICogICB1cCBmcm9tIGEgcGFydGlhbCBkZS12YWxpZGF0aW9uKS4KKyAgICAg
ICAgICoKKyAgICAgICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBp
ZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcyBjbGVhciwKKyAgICAgICAg
ICogdGhlbiBhIGdlbmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUtYWNxdWly
ZWQ7IGlmIGl0IGlzIHNldCwgbm8KKyAgICAgICAgICogcmVmZXJlbmNlIHNo
b3VsZCBiZSBhY3F1aXJlZC4KKyAgICAgICAgICoKKyAgICAgICAgICogV2hl
biByZXN1bWluZyBkZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5l
cmFsX3JlZiBpcworICAgICAgICAgKiBjbGVhciwgbm8gcmVmZXJlbmNlIHNo
b3VsZCBiZSBkcm9wcGVkOyBpZiBpdCBpcyBzZXQsIGEKKyAgICAgICAgICog
cmVmZXJlbmNlIHNob3VsZCBiZSBkcm9wcGVkLgorICAgICAgICAgKgorICAg
ICAgICAgKiBOQiB0aGF0IFBURl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRp
YWxfZ2VuZXJhbF9yZWYgYXJlCisgICAgICAgICAqIGRlZmluZWQgaW4gbW0u
YywgdGhlIG9ubHkgcGxhY2Ugd2hlcmUgdGhleSBhcmUgdXNlZC4KICAgICAg
ICAgICoKICAgICAgICAgICogVGhlIDNyZCBmaWVsZCwgQGxpbmVhcl9wdF9j
b3VudCwgaW5kaWNhdGVzCiAgICAgICAgICAqIC0gYnkgYSBwb3NpdGl2ZSB2
YWx1ZSwgaG93IG1hbnkgc2FtZS1sZXZlbCBwYWdlIHRhYmxlIGVudHJpZXMg
YSBwYWdlCkBAIC0yNTEsNyArMjY2LDcgQEAgc3RydWN0IHBhZ2VfaW5mbwog
ICAgICAgICBzdHJ1Y3QgewogICAgICAgICAgICAgdTE2IG5yX3ZhbGlkYXRl
ZF9wdGVzOlBBR0VUQUJMRV9PUkRFUiArIDE7CiAgICAgICAgICAgICB1MTYg
OjE2IC0gUEFHRVRBQkxFX09SREVSIC0gMSAtIDI7Ci0gICAgICAgICAgICBz
MTYgcGFydGlhbF9wdGU6MjsKKyAgICAgICAgICAgIHUxNiBwYXJ0aWFsX2Zs
YWdzOjI7CiAgICAgICAgICAgICBzMTYgbGluZWFyX3B0X2NvdW50OwogICAg
ICAgICB9OwogCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Transfer-Encoding: base64

RnJvbSAyMGI4YTY3MDJjNjgzOWJhZmQyNTI3ODkzOTZiNDQzZDRiNWM1NDc0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA0LzExXSB4
ODYvbW06IFVzZSBmbGFncyBmb3IgX3B1dF9wYWdlX3R5cGUgcmF0aGVyIHRo
YW4gYQogYm9vbGVhbgoKVGhpcyBpcyBpbiBtYWlubHkgaW4gcHJlcGFyYXRp
b24gZm9yIF9wdXRfcGFnZV90eXBlIHRha2luZyB0aGUKcGFydGlhbF9mbGFn
cyB2YWx1ZSBpbiB0aGUgZnV0dXJlLiAgSXQgYWxzbyBtYWtlcyBpdCBlYXNp
ZXIgdG8gcmVhZCBpbgp0aGUgY2FsbGVyIChzaW5jZSB5b3Ugc2VlIGEgZmxh
ZyBuYW1lIHJhdGhlciB0aGFuIGB0cnVlYCBvciBgZmFsc2VgKS4KCk5vIGZ1
bmN0aW9uYWwgY2hhbmdlIGludGVuZGVkLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0yOTkuCgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2
L21tLmMgfCAyNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tCiAxIGZpbGUg
Y2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCAxYzRmNTRlMzI4Li5lMmZiYTE1ZDg2IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTIwNyw3ICsxMjA3LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sNGUoCiAgICAg
cmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50IF9wdXRfcGFnZV90eXBlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UsIGJvb2wgcHJlZW1wdGlibGUsCitzdGF0
aWMgaW50IF9wdXRfcGFnZV90eXBlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Us
IHVuc2lnbmVkIGludCBmbGFncywKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZyk7CiAKIHZvaWQgcHV0X3BhZ2Vf
ZnJvbV9sMWUobDFfcGdlbnRyeV90IGwxZSwgc3RydWN0IGRvbWFpbiAqbDFl
X293bmVyKQpAQCAtMTMxNCw3ICsxMzE0LDcgQEAgc3RhdGljIGludCBwdXRf
cGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25n
IHBmbiwKICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAg
ICAgewogICAgICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIp
KTsKLSAgICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUs
IHB0cGcpOworICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywg
UFRGX3ByZWVtcHRpYmxlLCBwdHBnKTsKICAgICAgICAgfQogICAgICAgICBl
bHNlIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAgICB7CkBAIC0x
MzIzLDcgKzEzMjMsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJl
KGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICB9CiAgICAgICAgIGVsc2UKICAgICAgICAgewotICAgICAgICAgICAgcmMg
PSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7CisgICAgICAgICAg
ICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0
cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAg
ICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAgICB9CkBAIC0xMzYwLDcg
KzEzNjAsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3Bn
ZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAgICAgUFRG
X3BhcnRpYWxfc2V0ICkKICAgICB7CiAgICAgICAgIEFTU0VSVCghKGZsYWdz
ICYgUFRGX2RlZmVyKSk7Ci0gICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlw
ZShwZywgdHJ1ZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAgICAg
IHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBt
Zm5fdG9fcGFnZShfbWZuKHBmbikpKTsKICAgICB9CiAKICAgICBpZiAoIGZs
YWdzICYgUFRGX2RlZmVyICkKQEAgLTEzNzAsNyArMTM3MCw3IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAot
ICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90b19wYWdl
KF9tZm4ocGZuKSkpOworICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBU
Rl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CiAgICAg
aWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAgIHB1dF9wYWdlKHBnKTsKIApA
QCAtMTM5MSw3ICsxMzkxLDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9t
X2w0ZShsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAg
ICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAgewogICAg
ICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKLSAgICAg
ICAgICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZuX3Rv
X3BhZ2UoX21mbihwZm4pKSk7CisgICAgICAgICAgICByZXR1cm4gX3B1dF9w
YWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21m
bihwZm4pKSk7CiAgICAgICAgIH0KIAogICAgICAgICBpZiAoIGZsYWdzICYg
UFRGX2RlZmVyICkKQEAgLTE0MDEsNyArMTQwMSw3IEBAIHN0YXRpYyBpbnQg
cHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5zaWduZWQg
bG9uZyBwZm4sCiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgfQog
Ci0gICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIG1mbl90
b19wYWdlKF9tZm4ocGZuKSkpOworICAgICAgICByYyA9IF9wdXRfcGFnZV90
eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZu
KSkpOwogICAgICAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICAgICAgICAg
IHB1dF9wYWdlKHBnKTsKICAgICB9CkBAIC0yNzAxLDEwICsyNzAxLDExIEBA
IHN0YXRpYyBpbnQgX3B1dF9maW5hbF9wYWdlX3R5cGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogfQogCiAKLXN0YXRp
YyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwg
Ym9vbCBwcmVlbXB0aWJsZSwKK3N0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUo
c3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpw
dHBnKQogewogICAgIHVuc2lnbmVkIGxvbmcgbngsIHgsIHkgPSBwYWdlLT51
LmludXNlLnR5cGVfaW5mbzsKKyAgICBib29sIHByZWVtcHRpYmxlID0gZmxh
Z3MgJiBQVEZfcHJlZW1wdGlibGU7CiAKICAgICBBU1NFUlQoY3VycmVudF9s
b2NrZWRfcGFnZV9uZV9jaGVjayhwYWdlKSk7CiAKQEAgLTI5MTEsNyArMjkx
Miw3IEBAIHN0YXRpYyBpbnQgX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogCiAgICAgICAgICAg
ICBpZiAoIHVubGlrZWx5KGlvbW11X3JldCkgKQogICAgICAgICAgICAgewot
ICAgICAgICAgICAgICAgIF9wdXRfcGFnZV90eXBlKHBhZ2UsIGZhbHNlLCBO
VUxMKTsKKyAgICAgICAgICAgICAgICBfcHV0X3BhZ2VfdHlwZShwYWdlLCAw
LCBOVUxMKTsKICAgICAgICAgICAgICAgICByYyA9IGlvbW11X3JldDsKICAg
ICAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgICAgIH0KQEAgLTI5
MzgsNyArMjkzOSw3IEBAIHN0YXRpYyBpbnQgX2dldF9wYWdlX3R5cGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlLAogCiB2
b2lkIHB1dF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKIHsK
LSAgICBpbnQgcmMgPSBfcHV0X3BhZ2VfdHlwZShwYWdlLCBmYWxzZSwgTlVM
TCk7CisgICAgaW50IHJjID0gX3B1dF9wYWdlX3R5cGUocGFnZSwgMCwgTlVM
TCk7CiAgICAgQVNTRVJUKHJjID09IDApOwogICAgICh2b2lkKXJjOwogfQpA
QCAtMjk1NSw3ICsyOTU2LDcgQEAgaW50IGdldF9wYWdlX3R5cGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogCiBpbnQg
cHV0X3BhZ2VfdHlwZV9wcmVlbXB0aWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogewotICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwYWdlLCB0cnVl
LCBOVUxMKTsKKyAgICByZXR1cm4gX3B1dF9wYWdlX3R5cGUocGFnZSwgUFRG
X3ByZWVtcHRpYmxlLCBOVUxMKTsKIH0KIAogaW50IGdldF9wYWdlX3R5cGVf
cHJlZW1wdGlibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQg
bG9uZyB0eXBlKQpAQCAtMjk3Miw3ICsyOTczLDcgQEAgaW50IHB1dF9vbGRf
Z3Vlc3RfdGFibGUoc3RydWN0IHZjcHUgKnYpCiAgICAgaWYgKCAhdi0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgKQogICAgICAgICByZXR1cm4gMDsKIAotICAg
IHN3aXRjaCAoIHJjID0gX3B1dF9wYWdlX3R5cGUodi0+YXJjaC5vbGRfZ3Vl
c3RfdGFibGUsIHRydWUsCisgICAgc3dpdGNoICggcmMgPSBfcHV0X3BhZ2Vf
dHlwZSh2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSwgUFRGX3ByZWVtcHRpYmxl
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi0+YXJjaC5v
bGRfZ3Vlc3RfcHRwZykgKQogICAgIHsKICAgICBjYXNlIC1FSU5UUjoKLS0g
CjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Transfer-Encoding: base64

RnJvbSA3YjNmOWY5YTc5NzQ1OTkwMmJlYmJhOTYyZTMxYmU1Y2JmZTdiNTE1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA1LzExXSB4
ODYvbW06IFJld29yayBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbiBjb25k
aXRpb25hbAoKTWFrZSBpdCBlYXNpZXIgdG8gcmVhZCBieSBkZWNsYXJpbmcg
dGhlIGNvbmRpdGlvbnMgaW4gd2hpY2ggd2Ugd2lsbApyZXRhaW4gdGhlIHJl
ZiwgcmF0aGVyIHRoYW4gdGhlIGNvbmRpdGlvbnMgdW5kZXIgd2hpY2ggd2Ug
cmVsZWFzZSBpdC4KClRoZSBvbmx5IHdheSAocGFnZSA9PSBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZSkgY2FuIGJlIHRydWUgaXMgaWYKcHJlZW1w
dGlibGUgaXMgdHJ1ZTsgc28gcmVtb3ZlIHRoaXMgZnJvbSB0aGUgcXVlcnkg
aXRzZWxmLCBhbmQgYWRkIGFuCkFTU0VSVCgpIHRvIHRoYXQgZWZmZWN0IG9u
IHRoZSBvcHBvc2l0ZSBwYXRoLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50
ZW5kZWQuCgpOQiB0aGF0IGFsbG9jX2xOX3RhYmxlKCkgbWlzaGFuZGxlIHRo
ZSAibGluZWFyIHB0IGZhaWx1cmUiIHNpdHVhdGlvbgpkZXNjcmliZWQgaW4g
dGhlIGNvbW1lbnQ7IHRoaXMgd2lsbCBiZSBhZGRyZXNzZWQgaW4gYSBmdXR1
cmUgcGF0Y2guCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDM5ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNo
YW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCBlMmZiYTE1ZDg2Li5lYWY3YjE0MjQ1IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
NjM3LDggKzYzNyw0MyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBl
X2Zyb21fbWZuKAogCiAgICAgcmMgPSBfZ2V0X3BhZ2VfdHlwZShwYWdlLCB0
eXBlLCBwcmVlbXB0aWJsZSk7CiAKLSAgICBpZiAoIHVubGlrZWx5KHJjKSAm
JiAhcGFydGlhbF9yZWYgJiYKLSAgICAgICAgICghcHJlZW1wdGlibGUgfHwg
cGFnZSAhPSBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkgKQorICAg
IC8qCisgICAgICogUmV0YWluIHRoZSByZWZjb3VudCBpZjoKKyAgICAgKiAt
IHBhZ2UgaXMgZnVsbHkgdmFsaWRhdGVkIChyYyA9PSAwKQorICAgICAqIC0g
cGFnZSBpcyBub3QgdmFsaWRhdGVkIChyYyA8IDApIGJ1dDoKKyAgICAgKiAg
IC0gV2UgY2FtZSBpbiB3aXRoIGEgcmVmZXJlbmNlIChwYXJ0aWFsX3JlZikK
KyAgICAgKiAgIC0gcGFnZSBpcyBwYXJ0aWFsbHkgdmFsaWRhdGVkIGJ1dCB0
aGVyZSdzIGJlZW4gYW4gZXJyb3IKKyAgICAgKiAgICAgKHBhZ2UgPT0gY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUpCisgICAgICoKKyAgICAgKiBU
aGUgcGFydGlhbF9yZWYtb24tZXJyb3IgY2xhdXNlIGlzIHdvcnRoIGFuIGV4
cGxhbmF0aW9uLiAgVGhlcmUKKyAgICAgKiBhcmUgdHdvIHNjZW5hcmlvcyB3
aGVyZSBwYXJ0aWFsX3JlZiBtaWdodCBiZSB0cnVlIGNvbWluZyBpbjoKKyAg
ICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgZGVtb3RlZCBhcyB0eXBl
IGB0eXBlYDsgaS5lLiBoYXMKKyAgICAgKiAgIFBHVF9wYXJ0aWFsIHNldAor
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBkZW1vdGVkIGFzIEwo
dHlwZSsxKSAoaS5lLiwgYSBsaW5lYXIKKyAgICAgKiAgIHBhZ2U7IGUuZy4g
d2UncmUgYmVpbmcgY2FsbGVkIGZyb20gZ2V0X3BhZ2VfZnJvbV9sMmUgd2l0
aAorICAgICAqICAgdHlwZSA9PSBQR1RfbDFfdGFibGUsIGJ1dCB0aGUgbWZu
IGlzIFBHVF9sMl90YWJsZSkKKyAgICAgKgorICAgICAqIElmIHRoZXJlJ3Mg
YW4gZXJyb3IsIGluIHRoZSBmaXJzdCBjYXNlLCBfZ2V0X3BhZ2VfdHlwZSB3
aWxsCisgICAgICogZWl0aGVyIHJldHVybiAtRVJFU1RBUlQsIGluIHdoaWNo
IGNhc2Ugd2Ugd2FudCB0byByZXRhaW4gdGhlCisgICAgICogcmVmIChhcyB0
aGUgY2FsbGVyIHdpbGwgY29uc2lkZXIgaXQgcmV0YWluZWQpLCBvciAtRUlO
VkFMLCBpbgorICAgICAqIHdoaWNoIGNhc2Ugb2xkX2d1ZXN0X3RhYmxlIHdp
bGwgYmUgc2V0OyBpbiBib3RoIGNhc2VzLCB3ZSBuZWVkCisgICAgICogdG8g
cmV0YWluIHRoZSByZWYuCisgICAgICoKKyAgICAgKiBJbiB0aGUgc2Vjb25k
IGNhc2UsIGlmIHRoZXJlJ3MgYW4gZXJyb3IsIF9nZXRfcGFnZV90eXBlKCkg
Y2FuCisgICAgICogKm9ubHkqIHJldHVybiAtRUlOVkFMLCBhbmQgKm5ldmVy
KiBzZXQgb2xkX2d1ZXN0X3RhYmxlLiAgSW4KKyAgICAgKiB0aGF0IGNhc2Ug
d2UgYWxzbyB3YW50IHRvIHJldGFpbiB0aGUgcmVmZXJlbmNlLCB0byBhbGxv
dyB0aGUKKyAgICAgKiBwYWdlIHRvIGNvbnRpbnVlIHRvIGJlIHRvcm4gZG93
biAoaS5lLiwgUEdUX3BhcnRpYWwgY2xlYXJlZCkKKyAgICAgKiBzYWZlbHku
CisgICAgICoKKyAgICAgKiBBbHNvIG5vdGUgdGhhdCB3ZSBzaG91bGRuJ3Qg
YmUgYWJsZSB0byBsZWF2ZSB3aXRoIHRoZSByZWZlcmVuY2UKKyAgICAgKiBj
b3VudCByZXRhaW5lZCB1bmxlc3Mgd2Ugc3VjY2VlZGVkLCBvciB0aGUgb3Bl
cmF0aW9uIHdhcworICAgICAqIHByZWVtcHRpYmxlLgorICAgICAqLworICAg
IGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9yZWYgKQorICAgICAgICAv
KiBub3RoaW5nICovOworICAgIGVsc2UgaWYgKCBwYWdlID09IGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlICkKKyAgICAgICAgQVNTRVJUKHByZWVt
cHRpYmxlKTsKKyAgICBlbHNlCiAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwog
CiAgICAgcmV0dXJuIHJjOwotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Transfer-Encoding: base64

RnJvbSBkMjg4OTM3NzdiZTU2ZWY1MTU2MmVkMzI1MDIzNzc5NzRmNzM4ZmQz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA2LzExXSB4
ODYvbW06IEhhdmUgYWxsb2NfbFsyM11fdGFibGUgY2xlYXIgcGFydGlhbF9m
bGFncyB3aGVuCiBwcmVlbXB0aW5nCgpJbiBvcmRlciB0byBhbGxvdyByZWN1
cnNpdmUgcGFnZXRhYmxlIHByb21vdGlvbnMgYW5kIGRlbW90aW9ucyB0byBi
ZQppbnRlcnJ1cHRlZCwgWGVuIG11c3Qga2VlcCB0cmFjayBvZiB0aGUgc3Rh
dGUgb2YgdGhlIHN1Yi1wYWdlcwpwcm9tb3RlZCBvciBkZW1vdGVkLiAgVGhp
cyBpcyBzdG9yZWQgaW4gdHdvIGVsZW1lbnRzIGluIHRoZSBwYWdlCnN0cnVj
dDogbnJfZW50cmllc192YWxpZGF0ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpU
aGUgcnVsZSBpcyB0aGF0IGVudHJpZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRh
dGVkKSBzaG91bGQgYWx3YXlzIGJlCnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdl
bmVyYWwgcmVmZXJlbmNlIGNvdW50LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6
ZXJvLCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlk
YXRlZCBhbmQgbm8gcmVmZXJlbmNlCmNvdW50IGlzIGhlbGQuICBJZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRl
ZF0KaXMgcGFydGlhbGx5IHZhbGlkYXRlZC4KCkF0IHRoZSBtb21lbnQsIGEg
ZGlzdGluY3Rpb24gaXMgbWFkZSBiZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVt
b3Rpb24Kd2l0aCByZWdhcmQgdG8gd2hldGhlciB0aGUgZW50cnkgaXRzZWxm
ICJob2xkcyIgYSBnZW5lcmFsIHJlZmVyZW5jZQpjb3VudDogd2hlbiBlbnRy
eSBwcm9tb3Rpb24gaXMgaW50ZXJydXB0ZWQgKGkuZS4sIHJldHVybnMgLUVS
RVNUQVJUKSwKdGhlIGVudHJ5IGlzIG5vdCBjb25zaWRlcmVkIHRvIGhvbGQg
YSByZWZlcmVuY2U7IHdoZW4gZW50cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0
ZWQsIHRoZSBlbnRyeSBpcyBzdGlsbCBjb25zaWRlcmVkIHRvIGhvbGQgYSBn
ZW5lcmFsCnJlZmVyZW5jZS4KClBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYg
Y2xlYXIsIGl0J3MgYSBwYXJ0aWFsIHByb21vdGlvbiA9PiBubyBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBoZWxkCmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBp
dCdzIHBhcnRpYWwgZGVtb3Rpb24sIHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UK
Y291bnQgaGVsZC4gIEJlY2F1c2UgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25z
IGNhbiBiZSBpbnRlcmxlYXZlZCwgdGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8g
Z2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21f
bCplLAp0byBiZSBhYmxlIHRvIHByb3Blcmx5IGhhbmRsZSByZWZlcmVuY2Ug
Y291bnRzLgoKVW5mb3J0dW5hdGVseSwgd2hlbiBhbGxvY19sWzIzXV90YWJs
ZSBjaGVjayBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpCmFuZCByZXR1cm4g
LUVSRVNUQVJULCB0aGV5IHNldCBucl9lbnRyaWVzX3ZhbGlkYXRlZCwgYnV0
IGRvbid0IGNsZWFyCnBhcnRpYWxfZmxhZ3MuCgpJZiB3ZSB3ZXJlIHBpY2tp
bmcgdXAgZnJvbSBhIHByZXZpb3VzbHktaW50ZXJydXB0ZWQgcHJvbW90aW9u
LCB0aGF0Cm1lYW5zIHRoYXQgUFRGX3BhcnRpYWxfc2V0IHdvdWxkIGJlIHNl
dCBldmVuIHRob3VnaApbbnJfZW50cmllc192YWxpZGF0ZWRdIHdhcyBub3Qg
cGFydGlhbGx5IHZhbGlkYXRlZC4gIFRoaXMgbWVhbnMgdGhhdAppZiB0aGUg
cGFnZSBpbiB0aGlzIHN0YXRlIHdlcmUgZGUtdmFsaWRhdGVkLCBwdXRfcGFn
ZV90eXBlKCkgd291bGQKZXJyb25lb3VzbHkgYmUgY2FsbGVkIG9uIHRoYXQg
ZW50cnkuCgpQZXJoYXBzIHdvcnNlLCBpZiB3ZSB3ZXJlIHJhY2luZyB3aXRo
IGEgZGUtdmFsaWRhdGlvbiwgdGhlbiB3ZSBtaWdodApsZWF2ZSBib3RoIFBU
Rl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7IGFu
ZCB3aGVuCmRlLXZhbGlkYXRpb24gcGlja2VkIHVwIGFnYWluLCBib3RoIHRo
ZSB0eXBlIGFuZCB0aGUgZ2VuZXJhbCByZWYgd291bGQKYmUgZXJyb25lb3Vz
bHkgZHJvcHBlZCBmcm9tIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0uCgpJbiBh
IHNlbnNlLCB0aGUgcmVhbCBpc3N1ZSBoZXJlIGlzIGNvZGUgZHVwbGljYXRp
b24uICBSYXRoZXIgdGhhbgpkdXBsaWNhdGUgdGhlIGludGVycnVwdGlvbiBj
b2RlLCBzZXQgcmMgdG8gLUVJTlRSIGFuZCBmYWxsIHRocm91Z2ggdG8KdGhl
IGNvZGUgd2hpY2ggYWxyZWFkeSBoYW5kbGVzIHRoYXQgY2FzZSBjb3JyZWN0
bHkuCgpHaXZlbiB0aGUgbG9naWMgYXQgdGhpcyBwb2ludCwgaXQgc2hvdWxk
IGJlIGltcG9zc2libGUgZm9yCnBhcnRpYWxfZmxhZ3MgdG8gYmUgbm9uLXpl
cm87IGFkZCBhbiBBU1NFUlQoKSB0byBjYXRjaCBhbnkgY2hhbmdlcy4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMTggKysrKy0tLS0tLS0tLS0tLS0t
CiAxIGZpbGUgY2hhbmdlZCwgNCBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCmluZGV4IGVhZjdiMTQyNDUuLjA1MzQ2NWNiN2MgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS5jCkBAIC0xNTQ1LDEzICsxNTQ1LDggQEAgc3RhdGljIGludCBhbGxv
Y19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBs
b25nIHR5cGUpCiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCAp
CiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAg
ewotICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwot
ICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVh
azsKLSAgICAgICAgfQotCi0gICAgICAgIGlmICggIWlzX2d1ZXN0X2wyX3Ns
b3QoZCwgdHlwZSwgaSkgfHwKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOwor
ICAgICAgICBlbHNlIGlmICggIWlzX2d1ZXN0X2wyX3Nsb3QoZCwgdHlwZSwg
aSkgfHwKICAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2wyZShw
bDJlW2ldLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQogICAgICAg
ICAgICAgY29udGludWU7CiAKQEAgLTE2MTYsMTMgKzE2MTEsOCBAQCBzdGF0
aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdzID0gMCApCiAgICAgewog
ICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAmJiBo
eXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKLSAgICAgICAgewotICAgICAg
ICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAg
ICAgcmMgPSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICBicmVhazsKLSAgICAg
ICAgfQotCi0gICAgICAgIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYm
IChpID09IDMpICkKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAg
ICBlbHNlIGlmICggaXNfcHZfMzJiaXRfZG9tYWluKGQpICYmIChpID09IDMp
ICkKICAgICAgICAgewogICAgICAgICAgICAgaWYgKCAhKGwzZV9nZXRfZmxh
Z3MocGwzZVtpXSkgJiBfUEFHRV9QUkVTRU5UKSB8fAogICAgICAgICAgICAg
ICAgICAobDNlX2dldF9mbGFncyhwbDNlW2ldKSAmIGwzX2Rpc2FsbG93X21h
c2soZCkpICkKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Transfer-Encoding: base64

RnJvbSBmNjA4YTUzYzI1ODA2YTdhNDMxOGNiZTIyNWJjNWY1YmJmMTU0ZDY5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA3LzExXSB4
ODYvbW06IEFsd2F5cyByZXRhaW4gYSBnZW5lcmFsIHJlZiBvbiBwYXJ0aWFs
CgpJbiBvcmRlciB0byBhbGxvdyByZWN1cnNpdmUgcGFnZXRhYmxlIHByb21v
dGlvbnMgYW5kIGRlbW90aW9ucyB0byBiZQppbnRlcnJ1cHRlZCwgWGVuIG11
c3Qga2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIHN1Yi1wYWdlcwpw
cm9tb3RlZCBvciBkZW1vdGVkLiAgVGhpcyBpcyBzdG9yZWQgaW4gdHdvIGVs
ZW1lbnRzIGluIHRoZSBwYWdlIHN0cnVjdDoKbnJfZW50cmllc192YWxpZGF0
ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpUaGUgcnVsZSBpcyB0aGF0IGVudHJp
ZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRhdGVkKSBzaG91bGQgYWx3YXlzIGJl
CnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdlbmVyYWwgcmVmZXJlbmNlIGNvdW50
LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6ZXJvLCB0aGVuIFtucl9lbnRyaWVz
X3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlkYXRlZCBhbmQgbm8gcmVmZXJlbmNl
CmNvdW50IGlzIGhlbGQuICBJZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0KaXMgcGFydGlhbGx5IHZhbGlk
YXRlZC4KCkF0IHRoZSBtb21lbnQsIGEgZGlzdGluY3Rpb24gaXMgbWFkZSBi
ZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVtb3Rpb24Kd2l0aCByZWdhcmQgdG8g
d2hldGhlciB0aGUgZW50cnkgaXRzZWxmICJob2xkcyIgYSBnZW5lcmFsIHJl
ZmVyZW5jZQpjb3VudDogd2hlbiBlbnRyeSBwcm9tb3Rpb24gaXMgaW50ZXJy
dXB0ZWQgKGkuZS4sIHJldHVybnMgLUVSRVNUQVJUKSwKdGhlIGVudHJ5IGlz
IG5vdCBjb25zaWRlcmVkIHRvIGhvbGQgYSByZWZlcmVuY2U7IHdoZW4gZW50
cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0ZWQsIHRoZSBlbnRyeSBpcyBzdGls
bCBjb25zaWRlcmVkIHRvIGhvbGQgYSBnZW5lcmFsCnJlZmVyZW5jZS4KClBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHVzZWQgdG8gZGlzdGluZ3Vpc2gg
YmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYgY2xlYXIsIGl0J3MgYSBwYXJ0aWFs
IHByb21vdGlvbiA9PiBubyBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBoZWxk
CmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBpdCdzIHBhcnRpYWwgZGVtb3Rpb24s
IHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UKY291bnQgaGVsZC4gIEJlY2F1c2Ug
cHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIGNhbiBiZSBpbnRlcmxlYXZlZCwg
dGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21fbCplLAp0byBiZSBhYmxlIHRvIHBy
b3Blcmx5IGhhbmRsZSByZWZlcmVuY2UgY291bnRzLgoKVW5mb3J0dW5hdGVs
eSwgYmVjYXVzZSBhIHJlZmNvdW50IGlzIG5vdCBoZWxkLCBpdCBpcyBwb3Nz
aWJsZSB0bwplbmdpbmVlciBhIHNpdHVhdGlvbiB3aGVyZSBQRlRfcGFydGlh
bF9zZXQgaXMgc2V0IGJ1dCB0aGUgcGFnZSBpbgpxdWVzdGlvbiBoYXMgYmVl
biBhc3NpZ25lZCB0byBhbm90aGVyIGRvbWFpbi4gIEEgc2tldGNoIGlzIHBy
b3ZpZGVkIGluCnRoZSBhcHBlbmRpeC4KCkZpeCB0aGlzIGJ5IGhhdmluZyB0
aGUgcGFyZW50IHBhZ2UgdGFibGUgZW50cnkgaG9sZCBhIGdlbmVyYWwKcmVm
ZXJlbmNlIGNvdW50IHdoZW5ldmVyIFBGVF9wYXJ0aWFsX3NldCBpcyBzZXQu
ICAoRm9yIGNsYXJpdHkgb2YKY2hhbmdlLCBrZWVwIHR3byBzZXBhcmF0ZSBm
bGFncy4gIFRoZXNlIHdpbGwgYmUgY29sbGFwc2VkIGluIGEKc3Vic2VxdWVu
dCBjaGFuZ2VzZXQuKQoKVGhpcyBoYXMgdHdvIGJhc2ljIGltcGxpY2F0aW9u
cy4gIE9uIHRoZSBwdXRfcGFnZV9mcm9tX2xOZSgpIHNpZGUsCnRoaXMgbWVh
biB0aGF0IHRoZSAocGFydGlhbF9zZXQgJiYgIXBhcnRpYWxfcmVmKSBjYXNl
IGNhbiBuZXZlciBoYXBwZW4sCmFuZCBubyBsb25nZXIgbmVlZHMgdG8gYmUg
c3BlY2lhbC1jYXNlZC4KClNlY29uZGx5LCBiZWNhdXNlIGJvdGggZmxhZ3Mg
YXJlIHNldCB0b2dldGhlciwgdGhlcmUncyBubyBuZWVkIHRvIGNhcnJ5IG92
ZXIKZXhpc3RpbmcgYml0cyBmcm9tIHBhcnRpYWxfcHRlLgoKKE5CIHRoZXJl
IGlzIHN0aWxsIGFub3RoZXIgaXNzdWUgd2l0aCBjYWxsaW5nIF9wdXRfcGFn
ZV90eXBlKCkgb24gYQpwYWdlIHdoaWNoIGhhZCBQR1RfcGFydGlhbCBzZXQ7
IHRoYXQgd2lsbCBiZSBoYW5kbGVkIGluIGEgc3Vic2VxdWVudApwYXRjaC4p
CgpPbiB0aGUgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oKSBzaWRlLCB3
ZSBuZWVkIHRvIGRpc3Rpbmd1aXNoCmJldHdlZW4gY2FsbGVycyB3aGljaCBo
b2xkIGEgcmVmZXJlbmNlIG9uIHBhcnRpYWwgKGkuZS4sCmFsbG9jX2xOX3Rh
YmxlKCkpLCBhbmQgdGhvc2Ugd2hpY2ggZG8gbm90IChuZXdfY3IzLCBQSU5f
TE5fVEFCTEUsIGFuZApzbyBvbik6IHBhc3MgYSBmbGFnIGlmIHRoZSB0eXBl
IHNob3VsZCBiZSByZXRhaW5lZCBvbiBpbnRlcnJ1cHRpb24uCgpOQiB0aGF0
IHNpbmNlIGwxIHByb21vdGlvbiBjYW4ndCBiZSBwcmVlbXB0ZWQsIHRoYXQg
Z2V0X3BhZ2VfZnJvbV9sMmUKY2FuJ3QgcmV0dXJuIC1FUkVTVEFSVC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0tLQoqIEFwcGVuZGl4OiBFbmdpbmVlcmluZyBQVEZfcGFydGlhbF9zZXQg
d2hpbGUgYSBwYWdlIGJlbG9uZ3MgdG8gYQogIGZvcmVpZ24gZG9tYWluCgpT
dXBwb3NlIEEgaXMgYSBwYWdlIHdoaWNoIGNhbiBiZSBwcm9tb3RlZCB0byBh
biBsMywgYW5kIEIgaXMgYSBwYWdlCndoaWNoIGNhbiBiZSBwcm9tb3RlZCB0
byBhbiBsMiwgYW5kIEFbeF0gcG9pbnRzIHRvIEIuICBCIGhhcwpQR0NfYWxs
b2NhdGVkIHNldCBidXQgbm8gb3RoZXIgZ2VuZXJhbCByZWZlcmVuY2VzLgoK
VjE6ICBQSU5fTDMgQS4KICBBIGlzIHZhbGlkYXRlZCwgQiBpcyB2YWxpZGF0
ZWQuCiAgQS50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQgfCBQR1Rf
cGlubmVkCiAgQi50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBC
LmNvdW50ID0gMiB8IFBHQ19hbGxvY2F0ZWQgKEFbeF0gaG9sZHMgYSBnZW5l
cmFsIHJlZikKClYxOiBVTlBJTiBBLgogIEEgYmVnaW5zIGRlLXZhbGlkYXRp
b24uCiAgQXJyYW5nZSB0byBiZSBpbnRlcnJ1cHRlZCB3aGVuIGkgPCB4CiAg
VjEtPm9sZF9ndWVzdF90YWJsZSA9IEEKICBWMS0+b2xkX2d1ZXN0X3RhYmxl
X3JlZl9oZWxkID0gZmFsc2UKICBBLnR5cGVfY291bnQgPSAxIHwgUEdUX3Bh
cnRpYWwKICBBLm5yX3ZhbGlkYXRlZF9lbnRyaWVzID0gaSA8IHgKICBCLnR5
cGVfY291bnQgPSAwCiAgQi5jb3VudCA9IDEgfCBQR0NfYWxsb2NhdGVkCgpW
MjogTU9EX0w0X0VOVFJZIHRvIHBvaW50IHNvbWUgbDRlIHRvIEEuCiAgUGlj
a3MgdXAgcmUtdmFsaWRhdGlvbiBvZiBBLgogIEFycmFuZ2UgdG8gYmUgaW50
ZXJydXB0ZWQgaGFsZndheSB0aHJvdWdoIEIncyB2YWxpZGF0aW9uCiAgQi50
eXBlX2NvdW50ID0gMSB8IFBHVF9wYXJ0aWFsCiAgQi5jb3VudCA9IDIgfCBQ
R0NfYWxsb2NhdGVkIChQR1RfcGFydGlhbCBob2xkcyBhIGdlbmVyYWwgcmVm
KQogIEEudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFs
aWRhdGVkX2VudHJpZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IFBURl9wYXJ0
aWFsX3NldAoKVjM6IE1PRF9MM19FTlRSWSB0byBwb2ludCBzb21lIG90aGVy
IGwzZSAobm90IGluIEEpIHRvIEIuCiAgVmFsaWRhdGVzIEIuCiAgQi50eXBl
X2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBCLmNvdW50ID0gMiB8IFBH
Q19hbGxvY2F0ZWQgKCJvdGhlciBsM2UiIGhvbGRzIGEgZ2VuZXJhbCByZWYp
CgpWMzogTU9EX0wzX0VOVFJZIHRvIGNsZWFyIGwzZSBwb2ludGluZyB0byBC
LgogIERldmFsaWRhdGVzIEIuCiAgQi50eXBlX2NvdW50ID0gMAogIEIuY291
bnQgPSAxIHwgUEdDX2FsbG9jYXRlZAoKVjM6IGRlY3JlYXNlX3Jlc2VydmF0
aW9uKEIpCiAgQ2xlYXJzIFBHQ19hbGxvY2F0ZWQKICBCLmNvdW50ID0gMCA9
PiBCIGlzIGZyZWVkCgpCIGdldHMgYXNzaWduZWQgdG8gYSBkaWZmZXJlbnQg
ZG9tYWluCgpWMTogUmVzdGFydHMgVU5QSU4gb2YgQQogIHB1dF9vbGRfZ3Vl
c3RfdGFibGUoQSkKICAgIC4uLgogICAgICBmcmVlX2wzX3RhYmxlKEEpCgpO
b3cgc2luY2UgQS5wYXJ0aWFsX2ZsYWdzIGhhcyBQVEZfcGFydGlhbF9zZXQs
IGZyZWVfbDNfdGFibGUoKSB3aWxsCmNhbGwgcHV0X3BhZ2VfZnJvbV9sM2Uo
KSBvbiBBW3hdLCB3aGljaCBwb2ludHMgdG8gQiwgd2hpbGUgQiBpcyBvd25l
ZApieSBhbm90aGVyIGRvbWFpbi4KCklmIEFbeF0gaGVsZCBhIGdlbmVyYWwg
cmVmY291bnQgZm9yIEIgb24gcGFydGlhbCB2YWxpZGF0aW9uLCBhcyBpdCBk
b2VzCmZvciBwYXJ0aWFsIGRlLXZhbGlkYXRpb24sIHRoZW4gQiB3b3VsZCBz
dGlsbCBoYXZlIGEgcmVmZXJlbmNlIGNvdW50IG9mCjEgYWZ0ZXIgUEdDX2Fs
bG9jYXRlZCB3YXMgZnJlZWQ7IHNvIEIgd291bGRuJ3QgYmUgZnJlZWQgdW50
aWwgYWZ0ZXIKcHV0X3BhZ2VfZnJvbV9sM2UoKSBoYWQgaGFwcGVuZCBvbiBB
W3hdLgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jICAgICAgICB8IDg0ICsrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaCB8IDE1ICsrKystLS0KIDIgZmlsZXMgY2hhbmdl
ZCwgNTggaW5zZXJ0aW9ucygrKSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwpp
bmRleCAwNTM0NjVjYjdjLi42OGE5ZTc0MDAyIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNjE3
LDEwICs2MTcsMTEgQEAgc3RhdGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgKiBw
YWdlLT5wdGVbcGFnZS0+bnJfdmFsaWRhdGVkX2VudHJpZXNdLiAgU2VlIHRo
ZSBjb21tZW50IGluIG1tLmggZm9yCiAgKiBtb3JlIGluZm9ybWF0aW9uLgog
ICovCi0jZGVmaW5lIFBURl9wYXJ0aWFsX3NldCAgICAgICAgICgxIDw8IDAp
Ci0jZGVmaW5lIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmICgxIDw8IDEpCi0j
ZGVmaW5lIFBURl9wcmVlbXB0aWJsZSAgICAgICAgICgxIDw8IDIpCi0jZGVm
aW5lIFBURl9kZWZlciAgICAgICAgICAgICAgICgxIDw8IDMpCisjZGVmaW5l
IFBURl9wYXJ0aWFsX3NldCAgICAgICAgICAgKDEgPDwgMCkKKyNkZWZpbmUg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgICAoMSA8PCAxKQorI2RlZmluZSBQ
VEZfcHJlZW1wdGlibGUgICAgICAgICAgICgxIDw8IDIpCisjZGVmaW5lIFBU
Rl9kZWZlciAgICAgICAgICAgICAgICAgKDEgPDwgMykKKyNkZWZpbmUgUFRG
X3JldGFpbl9yZWZfb25fcmVzdGFydCAoMSA8PCA0KQogCiBzdGF0aWMgaW50
IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAogICAgIG1mbl90IG1mbiwg
dW5zaWduZWQgbG9uZyB0eXBlLCBzdHJ1Y3QgZG9tYWluICpkLApAQCAtNjI5
LDcgKzYzMCwxMSBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKAogICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9f
cGFnZShtZm4pOwogICAgIGludCByYzsKICAgICBib29sIHByZWVtcHRpYmxl
ID0gZmxhZ3MgJiBQVEZfcHJlZW1wdGlibGUsCi0gICAgICAgICBwYXJ0aWFs
X3JlZiA9IGZsYWdzICYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CisgICAg
ICAgICBwYXJ0aWFsX3JlZiA9IGZsYWdzICYgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYsCisgICAgICAgICBwYXJ0aWFsX3NldCA9IGZsYWdzICYgUFRGX3Bh
cnRpYWxfc2V0LAorICAgICAgICAgcmV0YWluX3JlZiAgPSBmbGFncyAmIFBU
Rl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQ7CisKKyAgICBBU1NFUlQocGFydGlh
bF9yZWYgPT0gcGFydGlhbF9zZXQpOwogCiAgICAgaWYgKCBsaWtlbHkoIXBh
cnRpYWxfcmVmKSAmJgogICAgICAgICAgdW5saWtlbHkoIWdldF9wYWdlX2Zy
b21fbWZuKG1mbiwgZCkpICkKQEAgLTY0MiwxMyArNjQ3LDE1IEBAIHN0YXRp
YyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAgICogLSBw
YWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKICAgICAgKiAtIHBh
Z2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6CiAgICAgICogICAt
IFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlhbF9yZWYpCisg
ICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCAocmMgPT0g
LUVSRVNUQVJUKSwgYW5kIHRoZQorICAgICAqICAgICBjYWxsZXIgaGFzIGFz
a2VkIHRoZSByZWYgdG8gYmUgcmV0YWluZWQgaW4gdGhhdCBjYXNlCiAgICAg
ICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCBidXQgdGhlcmUn
cyBiZWVuIGFuIGVycm9yCiAgICAgICogICAgIChwYWdlID09IGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlKQogICAgICAqCiAgICAgICogVGhlIHBh
cnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBpcyB3b3J0aCBhbiBleHBsYW5h
dGlvbi4gIFRoZXJlCiAgICAgICogYXJlIHR3byBzY2VuYXJpb3Mgd2hlcmUg
cGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBjb21pbmcgaW46Ci0gICAgICog
LSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgdHlwZSBgdHlw
ZWA7IGkuZS4gaGFzCi0gICAgICogICBQR1RfcGFydGlhbCBzZXQKKyAgICAg
KiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgcHJvbW90ZWQgLyBkZW1vdGVk
IGFzIHR5cGUgYHR5cGVgOworICAgICAqICAgaS5lLiBoYXMgUEdUX3BhcnRp
YWwgc2V0CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90
ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgogICAgICAqICAgcGFn
ZTsgZS5nLiB3ZSdyZSBiZWluZyBjYWxsZWQgZnJvbSBnZXRfcGFnZV9mcm9t
X2wyZSB3aXRoCiAgICAgICogICB0eXBlID09IFBHVF9sMV90YWJsZSwgYnV0
IHRoZSBtZm4gaXMgUEdUX2wyX3RhYmxlKQpAQCAtNjcxLDcgKzY3OCw4IEBA
IHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAg
ICovCiAgICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFsX3JlZiApCiAg
ICAgICAgIC8qIG5vdGhpbmcgKi87Ci0gICAgZWxzZSBpZiAoIHBhZ2UgPT0g
Y3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQorICAgIGVsc2UgaWYg
KCBwYWdlID09IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlIHx8Cisg
ICAgICAgICAgICAgIChyZXRhaW5fcmVmICYmIHJjID09IC1FUkVTVEFSVCkg
KQogICAgICAgICBBU1NFUlQocHJlZW1wdGlibGUpOwogICAgIGVsc2UKICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CkBAIC0xMzQ4LDggKzEzNTYsOCBAQCBz
dGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUs
IHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAgICBpZiAoIChmbGFncyAmIChQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09
CiAgICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7Ci0g
ICAgICAgICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1w
dGlibGUsIHB0cGcpOworICAgICAgICAgICAgLyogcGFydGlhbF9zZXQgc2hv
dWxkIGFsd2F5cyBpbXBseSBwYXJ0aWFsX3JlZiAqLworICAgICAgICAgICAg
QlVHKCk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIGZsYWdzICYg
UFRGX2RlZmVyICkKICAgICAgICAgewpAQCAtMTM5NCw4ICsxNDAyLDggQEAg
c3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3QgbDNl
LCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICBpZiAoIChmbGFncyAmIChQVEZf
cGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CiAg
ICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgIHsKLSAgICAgICAgQVNT
RVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKLSAgICAgICAgcmV0dXJuIF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdl
KF9tZm4ocGZuKSkpOworICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQg
YWx3YXlzIGltcGx5IHBhcnRpYWxfcmVmICovCisgICAgICAgIEJVRygpOwog
ICAgIH0KIAogICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQpAQCAtMTQy
NSw4ICsxNDMzLDggQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2w0ZShs
NF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAg
aWYgKCAoZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYpKSA9PQogICAgICAgICAgICAgICBQVEZfcGFydGlhbF9z
ZXQgKQogICAgICAgICB7Ci0gICAgICAgICAgICBBU1NFUlQoIShmbGFncyAm
IFBURl9kZWZlcikpOwotICAgICAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90
eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZu
KSkpOworICAgICAgICAgICAgLyogcGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5
cyBpbXBseSBwYXJ0aWFsX3JlZiAqLworICAgICAgICAgICAgQlVHKCk7CiAg
ICAgICAgIH0KIAogICAgICAgICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkK
QEAgLTE1NTAsMTMgKzE1NTgsMjIgQEAgc3RhdGljIGludCBhbGxvY19sMl90
YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5
cGUpCiAgICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwy
ZVtpXSwgcGZuLCBkLCBwYXJ0aWFsX2ZsYWdzKSkgPiAwICkKICAgICAgICAg
ICAgIGNvbnRpbnVlOwogCi0gICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJU
ICkKLSAgICAgICAgewotICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXMgPSBpOwotICAgICAgICAgICAgLyogU2V0ICdzZXQnLCByZXRhaW4g
J2dlbmVyYWwgcmVmJyAqLwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IHBhcnRpYWxfZmxhZ3MgfCBQVEZfcGFydGlhbF9zZXQ7Ci0gICAg
ICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpICkK
KyAgICAgICAgLyoKKyAgICAgICAgICogSXQgc2hvdWxkbid0IGJlIHBvc3Np
YmxlIGZvciBnZXRfcGFnZV9mcm9tX2wyZSB0byByZXR1cm4KKyAgICAgICAg
ICogLUVSRVNUQVJULCBzaW5jZSB3ZSBuZXZlciBjYWxsIHRoaXMgd2l0aCBQ
VEZfcHJlZW1wdGlibGUuCisgICAgICAgICAqIChhbGxvY19sMV90YWJsZSBt
YXkgcmV0dXJuIC1FSU5UUiBvbiBhbiBMMVRGLXZ1bG5lcmFibGUKKyAgICAg
ICAgICogZW50cnkuKQorICAgICAgICAgKgorICAgICAgICAgKiBOQiB0aGF0
IHdoaWxlIG9uIGEgImNsZWFuIiBwcm9tb3Rpb24sIHdlIGNhbiBuZXZlciBn
ZXQKKyAgICAgICAgICogUEdUX3BhcnRpYWwuICBJdCBpcyBwb3NzaWJsZSB0
byBhcnJhbmdlIGZvciBhbiBsMmUgdG8KKyAgICAgICAgICogY29udGFpbiBh
IHBhcnRpYWxseS1kZXZhbGlkYXRlZCBsMjsgYnV0IGluIHRoYXQgY2FzZSwg
Ym90aAorICAgICAgICAgKiBvZiB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyB3
aWxsIGZhaWwgYW55d2F5ICh0aGUgZmlyc3QKKyAgICAgICAgICogYmVjYXVz
ZSB0aGUgcGFnZSBpbiBxdWVzdGlvbiBpcyBub3QgYW4gbDE7IHRoZSBzZWNv
bmQKKyAgICAgICAgICogYmVjYXVzZSB0aGUgcGFnZSBpcyBub3QgZnVsbHkg
dmFsaWRhdGVkKS4KKyAgICAgICAgICovCisgICAgICAgIEFTU0VSVChyYyAh
PSAtRVJFU1RBUlQpOworCisgICAgICAgIGlmICggcmMgPT0gLUVJTlRSICYm
IGkgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gMDsKQEAgLTE1NjUsNiArMTU4Miw3IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9u
ZyB0eXBlKQogICAgICAgICBlbHNlIGlmICggcmMgPCAwICYmIHJjICE9IC1F
SU5UUiApCiAgICAgICAgIHsKICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxP
R19XQVJOSU5HLCAiRmFpbHVyZSBpbiBhbGxvY19sMl90YWJsZTogc2xvdCAl
I3hcbiIsIGkpOworICAgICAgICAgICAgQVNTRVJUKGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwogICAgICAgICAgICAgaWYgKCBp
ICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyA9IGk7CkBAIC0xNjIxLDE2ICsxNjM5LDE3IEBAIHN0
YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSkKICAgICAgICAgICAgICAgICByYyA9IGdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKAogICAgICAgICAgICAgICAgICAgICBsM2VfZ2V0X21mbihwbDNl
W2ldKSwKICAgICAgICAgICAgICAgICAgICAgUEdUX2wyX3BhZ2VfdGFibGUg
fCBQR1RfcGFlX3hlbl9sMiwgZCwKLSAgICAgICAgICAgICAgICAgICAgcGFy
dGlhbF9mbGFncyB8IFBURl9wcmVlbXB0aWJsZSk7CisgICAgICAgICAgICAg
ICAgICAgIHBhcnRpYWxfZmxhZ3MgfCBQVEZfcHJlZW1wdGlibGUgfCBQVEZf
cmV0YWluX3JlZl9vbl9yZXN0YXJ0KTsKICAgICAgICAgfQotICAgICAgICBl
bHNlIGlmICggKHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UocGwzZVtpXSwgcGZu
LCBkLCBwYXJ0aWFsX2ZsYWdzKSkgPiAwICkKKyAgICAgICAgZWxzZSBpZiAo
IChyYyA9IGdldF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0sIHBmbiwgZCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIHwg
UFRGX3JldGFpbl9yZWZfb25fcmVzdGFydCkpID4gMCApCiAgICAgICAgICAg
ICBjb250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCAp
CiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9w
dGVzID0gaTsKICAgICAgICAgICAgIC8qIFNldCAnc2V0JywgbGVhdmUgJ2dl
bmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMgc2V0ICovCi0gICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFncyB8
IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxf
ZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFs
X3JlZjsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJ
TlRSICYmIGkgKQogICAgICAgICB7CkBAIC0xNzkxLDE0ICsxODEwLDE1IEBA
IHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSkKICAgICAgICAgICBpKyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAg
ICB7CiAgICAgICAgIGlmICggIWlzX2d1ZXN0X2w0X3Nsb3QoZCwgaSkgfHwK
LSAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShwbDRlW2ld
LCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpKSA+IDAgKQorICAgICAgICAgICAg
IChyYyA9IGdldF9wYWdlX2Zyb21fbDRlKHBsNGVbaV0sIHBmbiwgZCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIHwg
UFRGX3JldGFpbl9yZWZfb25fcmVzdGFydCkpID4gMCApCiAgICAgICAgICAg
ICBjb250aW51ZTsKIAogICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCAp
CiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9w
dGVzID0gaTsKICAgICAgICAgICAgIC8qIFNldCAnc2V0JywgbGVhdmUgJ2dl
bmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMgc2V0ICovCi0gICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFncyB8
IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxf
ZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFs
X3JlZjsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggcmMgPCAwICkK
ICAgICAgICAgewpAQCAtMTg5Niw5ICsxOTE2LDcgQEAgc3RhdGljIGludCBm
cmVlX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgZWxz
ZSBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdl
LT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSAocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCkg
PwotICAgICAgICAgICAgcGFydGlhbF9mbGFncyA6Ci0gICAgICAgICAgICAo
UFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpOwor
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0
IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CiAgICAgfQogICAgIGVsc2Ug
aWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVT
IC0gMSApCiAgICAgewpAQCAtMTk0Niw5ICsxOTY0LDcgQEAgc3RhdGljIGlu
dCBmcmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAg
aWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFs
X2ZsYWdzID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpID8K
LSAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgOgotICAgICAgICAgICAgKFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsKKyAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogICAgIH0KICAgICBlbHNlIGlm
ICggcmMgPT0gLUVJTlRSICYmIGkgPCBMM19QQUdFVEFCTEVfRU5UUklFUyAt
IDEgKQogICAgIHsKQEAgLTE5NzksOSArMTk5NSw3IEBAIHN0YXRpYyBpbnQg
ZnJlZV9sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIGlm
ICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/Ci0g
ICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoKLSAgICAgICAgICAgIChQVEZf
cGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CisgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKICAgICB9CiAgICAgZWxzZSBpZiAo
IHJjID09IC1FSU5UUiAmJiBpIDwgTDRfUEFHRVRBQkxFX0VOVFJJRVMgLSAx
ICkKICAgICB7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKaW5kZXggNDZjYmE1Mjk0
MS4uZGM5Y2I4NjlkZCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaApAQCAtMjM4
LDIyICsyMzgsMjUgQEAgc3RydWN0IHBhZ2VfaW5mbwogICAgICAgICAgKiBw
YWdlLgogICAgICAgICAgKgogICAgICAgICAgKiBUaGlzIGhhcHBlbnM6Ci0g
ICAgICAgICAqIC0gRHVyaW5nIGRlLXZhbGlkYXRpb24sIGlmIGRlLXZhbGlk
YXRpb24gb2YgdGhlIHBhZ2Ugd2FzCisgICAgICAgICAqIC0gRHVyaW5nIHZh
bGlkYXRpb24gb3IgZGUtdmFsaWRhdGlvbiwgaWYgdGhlIG9wZXJhdGlvbiB3
YXMKICAgICAgICAgICogICBpbnRlcnJ1cHRlZAogICAgICAgICAgKiAtIER1
cmluZyB2YWxpZGF0aW9uLCBpZiBhbiBpbnZhbGlkIGVudHJ5IGlzIGVuY291
bnRlcmVkIGFuZAogICAgICAgICAgKiAgIHZhbGlkYXRpb24gaXMgcHJlZW1w
dGlibGUKICAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiwgaWYgUFRG
X3BhcnRpYWxfZ2VuZXJhbF9yZWYgd2FzIHNldCBvbgotICAgICAgICAgKiAg
IHRoaXMgZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFwcyBiZWNhdXNlIHdl
J3JlIHBpY2tpbmcKLSAgICAgICAgICogICB1cCBmcm9tIGEgcGFydGlhbCBk
ZS12YWxpZGF0aW9uKS4KKyAgICAgICAgICogICB0aGlzIGVudHJ5IHRvIGJl
Z2luIHdpdGggKHBlcmhhcHMgYmVjYXVzZSBpdCBwaWNrZWQgdXAgYQorICAg
ICAgICAgKiAgIHByZXZpb3VzIG9wZXJhdGlvbikKICAgICAgICAgICoKLSAg
ICAgICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFy
dGlhbF9nZW5lcmFsX3JlZiBpcyBjbGVhciwKLSAgICAgICAgICogdGhlbiBh
IGdlbmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQ7IGlmIGl0
IGlzIHNldCwgbm8KLSAgICAgICAgICogcmVmZXJlbmNlIHNob3VsZCBiZSBh
Y3F1aXJlZC4KKyAgICAgICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9u
LCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcworICAgICAgICAgKiBj
bGVhciwgdGhlbiBhIGdlbmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUtYWNx
dWlyZWQ7IGlmIGl0CisgICAgICAgICAqIGlzIHNldCwgbm8gcmVmZXJlbmNl
IHNob3VsZCBiZSBhY3F1aXJlZC4KICAgICAgICAgICoKICAgICAgICAgICog
V2hlbiByZXN1bWluZyBkZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9n
ZW5lcmFsX3JlZiBpcwogICAgICAgICAgKiBjbGVhciwgbm8gcmVmZXJlbmNl
IHNob3VsZCBiZSBkcm9wcGVkOyBpZiBpdCBpcyBzZXQsIGEKICAgICAgICAg
ICogcmVmZXJlbmNlIHNob3VsZCBiZSBkcm9wcGVkLgogICAgICAgICAgKgor
ICAgICAgICAgKiBOQiBhdCB0aGUgbW9tZW50LCBQVEZfcGFydGlhbF9zZXQg
c2hvdWxkIGJlIHNldCBpZiBhbmQgb25seSBpZgorICAgICAgICAgKiBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZiBpcyBzZXQuCisgICAgICAgICAqCiAgICAg
ICAgICAqIE5CIHRoYXQgUFRGX3BhcnRpYWxfc2V0IGFuZCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBhcmUKICAgICAgICAgICogZGVmaW5lZCBpbiBtbS5j
LCB0aGUgb25seSBwbGFjZSB3aGVyZSB0aGV5IGFyZSB1c2VkLgogICAgICAg
ICAgKgotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Transfer-Encoding: base64

RnJvbSA2ODExZGY3ZmI3YTFkNGJiNWE3NWZlYzljZjQxNTE5YjVjODZjNjA1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA4LzExXSB4
ODYvbW06IENvbGxhcHNlIFBURl9wYXJ0aWFsX3NldCBhbmQKIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGludG8gb25lCgouLi5ub3cgdGhhdCB0aGV5IGFy
ZSBlcXVpdmFsZW50LiAgTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQu
CgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21tLmMg
ICAgICAgIHwgNTAgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIHwgMjkgKysrKysr
KysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA2OGE5ZTc0
MDAyLi40OTcwYjE5YWZmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNjEyLDEzICs2MTIsMTIg
QEAgc3RhdGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZv
ICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAKIC8qCiAgKiBUaGUgZm9s
bG93aW5nIGZsYWdzIGFyZSB1c2VkIHRvIHNwZWNpZnkgYmVoYXZpb3Igb2Yg
dmFyaW91cyBnZXQgYW5kCi0gKiBwdXQgY29tbWFuZHMuICBUaGUgZmlyc3Qg
dHdvIGFyZSBhbHNvIHN0b3JlZCBpbiBwYWdlLT5wYXJ0aWFsX2ZsYWdzCi0g
KiB0byBpbmRpY2F0ZSB0aGUgc3RhdGUgb2YgdGhlIHBhZ2UgcG9pbnRlZCB0
byBieQorICogcHV0IGNvbW1hbmRzLiAgVGhlIGZpcnN0IGlzIGFsc28gc3Rv
cmVkIGluIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgdG8KKyAqIGluZGljYXRlIHRo
ZSBzdGF0ZSBvZiB0aGUgcGFnZSBwb2ludGVkIHRvIGJ5CiAgKiBwYWdlLT5w
dGVbcGFnZS0+bnJfdmFsaWRhdGVkX2VudHJpZXNdLiAgU2VlIHRoZSBjb21t
ZW50IGluIG1tLmggZm9yCiAgKiBtb3JlIGluZm9ybWF0aW9uLgogICovCiAj
ZGVmaW5lIFBURl9wYXJ0aWFsX3NldCAgICAgICAgICAgKDEgPDwgMCkKLSNk
ZWZpbmUgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgICAoMSA8PCAxKQogI2Rl
ZmluZSBQVEZfcHJlZW1wdGlibGUgICAgICAgICAgICgxIDw8IDIpCiAjZGVm
aW5lIFBURl9kZWZlciAgICAgICAgICAgICAgICAgKDEgPDwgMykKICNkZWZp
bmUgUFRGX3JldGFpbl9yZWZfb25fcmVzdGFydCAoMSA8PCA0KQpAQCAtNjMw
LDEzICs2MjksMTAgQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9m
cm9tX21mbigKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3Rv
X3BhZ2UobWZuKTsKICAgICBpbnQgcmM7CiAgICAgYm9vbCBwcmVlbXB0aWJs
ZSA9IGZsYWdzICYgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAgcGFydGlh
bF9yZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmLAogICAg
ICAgICAgcGFydGlhbF9zZXQgPSBmbGFncyAmIFBURl9wYXJ0aWFsX3NldCwK
ICAgICAgICAgIHJldGFpbl9yZWYgID0gZmxhZ3MgJiBQVEZfcmV0YWluX3Jl
Zl9vbl9yZXN0YXJ0OwogCi0gICAgQVNTRVJUKHBhcnRpYWxfcmVmID09IHBh
cnRpYWxfc2V0KTsKLQotICAgIGlmICggbGlrZWx5KCFwYXJ0aWFsX3JlZikg
JiYKKyAgICBpZiAoIGxpa2VseSghcGFydGlhbF9zZXQpICYmCiAgICAgICAg
ICB1bmxpa2VseSghZ2V0X3BhZ2VfZnJvbV9tZm4obWZuLCBkKSkgKQogICAg
ICAgICByZXR1cm4gLUVJTlZBTDsKIApAQCAtNjQ2LDE0ICs2NDIsMTQgQEAg
c3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICAg
KiBSZXRhaW4gdGhlIHJlZmNvdW50IGlmOgogICAgICAqIC0gcGFnZSBpcyBm
dWxseSB2YWxpZGF0ZWQgKHJjID09IDApCiAgICAgICogLSBwYWdlIGlzIG5v
dCB2YWxpZGF0ZWQgKHJjIDwgMCkgYnV0OgotICAgICAqICAgLSBXZSBjYW1l
IGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfcmVmKQorICAgICAqICAg
LSBXZSBjYW1lIGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfc2V0KQog
ICAgICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgKHJjID09
IC1FUkVTVEFSVCksIGFuZCB0aGUKICAgICAgKiAgICAgY2FsbGVyIGhhcyBh
c2tlZCB0aGUgcmVmIHRvIGJlIHJldGFpbmVkIGluIHRoYXQgY2FzZQogICAg
ICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0IHRoZXJl
J3MgYmVlbiBhbiBlcnJvcgogICAgICAqICAgICAocGFnZSA9PSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkKICAgICAgKgotICAgICAqIFRoZSBw
YXJ0aWFsX3JlZi1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4gZXhwbGFu
YXRpb24uICBUaGVyZQotICAgICAqIGFyZSB0d28gc2NlbmFyaW9zIHdoZXJl
IHBhcnRpYWxfcmVmIG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgorICAgICAq
IFRoZSBwYXJ0aWFsX3NldC1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4g
ZXhwbGFuYXRpb24uICBUaGVyZQorICAgICAqIGFyZSB0d28gc2NlbmFyaW9z
IHdoZXJlIHBhcnRpYWxfc2V0IG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgog
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBwcm9tb3RlZCAvIGRl
bW90ZWQgYXMgdHlwZSBgdHlwZWA7CiAgICAgICogICBpLmUuIGhhcyBQR1Rf
cGFydGlhbCBzZXQKICAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkg
ZGVtb3RlZCBhcyBMKHR5cGUrMSkgKGkuZS4sIGEgbGluZWFyCkBAIC02NzYs
NyArNjcyLDcgQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9t
X21mbigKICAgICAgKiBjb3VudCByZXRhaW5lZCB1bmxlc3Mgd2Ugc3VjY2Vl
ZGVkLCBvciB0aGUgb3BlcmF0aW9uIHdhcwogICAgICAqIHByZWVtcHRpYmxl
LgogICAgICAqLwotICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9y
ZWYgKQorICAgIGlmICggbGlrZWx5KCFyYykgfHwgcGFydGlhbF9zZXQgKQog
ICAgICAgICAvKiBub3RoaW5nICovOwogICAgIGVsc2UgaWYgKCBwYWdlID09
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlIHx8CiAgICAgICAgICAg
ICAgIChyZXRhaW5fcmVmICYmIHJjID09IC1FUkVTVEFSVCkgKQpAQCAtMTM1
MywxMyArMTM0OSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUo
bDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAg
IHN0cnVjdCBwYWdlX2luZm8gKnBnID0gbDJlX2dldF9wYWdlKGwyZSk7CiAg
ICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnB0cGcgPSBtZm5fdG9fcGFnZShf
bWZuKHBmbikpOwogCi0gICAgICAgIGlmICggKGZsYWdzICYgKFBURl9wYXJ0
aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0KLSAgICAg
ICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKLSAgICAgICAgewotICAgICAg
ICAgICAgLyogcGFydGlhbF9zZXQgc2hvdWxkIGFsd2F5cyBpbXBseSBwYXJ0
aWFsX3JlZiAqLwotICAgICAgICAgICAgQlVHKCk7Ci0gICAgICAgIH0KLSAg
ICAgICAgZWxzZSBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKKyAgICAgICAg
aWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBwdHBnOwogICAg
ICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsK
QEAgLTEzOTksMTMgKzEzODksNiBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAog
CiAgICAgcGcgPSBsM2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggKGZs
YWdzICYgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxf
cmVmKSkgPT0KLSAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCi0gICAgewot
ICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBh
cnRpYWxfcmVmICovCi0gICAgICAgIEJVRygpOwotICAgIH0KLQogICAgIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgIHsKICAgICAgICAgY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZu
KSk7CkBAIC0xNDMwLDEzICsxNDEzLDYgQEAgc3RhdGljIGludCBwdXRfcGFn
ZV9mcm9tX2w0ZShsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25nIHBm
biwKICAgICB7CiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBnID0gbDRl
X2dldF9wYWdlKGw0ZSk7CiAKLSAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRG
X3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQot
ICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQotICAgICAgICB7Ci0g
ICAgICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5
IHBhcnRpYWxfcmVmICovCi0gICAgICAgICAgICBCVUcoKTsKLSAgICAgICAg
fQotCiAgICAgICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBn
ID0gbWZuX3RvX3BhZ2UoX21mbihwZm4pKTsKQEAgLTE2NDksNyArMTYyNSw3
IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOwogICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBs
ZWF2ZSAnZ2VuZXJhbCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQg
Ki8KLSAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFy
dGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CiAg
ICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBp
ICkKICAgICAgICAgewpAQCAtMTgxOCw3ICsxNzk0LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7CiAgICAgICAgICAgICAvKiBTZXQgJ3NldCcsIGxlYXZlICdnZW5lcmFs
IHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNldCAqLwotICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAgICAgICAgcGFnZS0+cGFy
dGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAgfQogICAg
ICAgICBlbHNlIGlmICggcmMgPCAwICkKICAgICAgICAgewpAQCAtMTkxNiw3
ICsxODkyLDcgQEAgc3RhdGljIGludCBmcmVlX2wyX3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCiAgICAgZWxzZSBpZiAoIHJjID09IC1FUkVTVEFS
VCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKKyAgICAgICAgcGFn
ZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsKICAgICB9CiAg
ICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxF
X0VOVFJJRVMgLSAxICkKICAgICB7CkBAIC0xOTY0LDcgKzE5NDAsNyBAQCBz
dGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFn
ZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZjsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IFBURl9wYXJ0aWFsX3NldDsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09
IC1FSU5UUiAmJiBpIDwgTDNfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAg
ICB7CkBAIC0xOTk1LDcgKzE5NzEsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDRf
dGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09
IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKKyAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsK
ICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDRf
UEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CmRpZmYgLS1naXQgYS94
ZW4vaW5jbHVkZS9hc20teDg2L21tLmggYi94ZW4vaW5jbHVkZS9hc20teDg2
L21tLmgKaW5kZXggZGM5Y2I4NjlkZC4uYzZiYTllNGQ3MyAxMDA2NDQKLS0t
IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCisrKyBiL3hlbi9pbmNsdWRl
L2FzbS14ODYvbW0uaApAQCAtMjMzLDcgKzIzMyw3IEBAIHN0cnVjdCBwYWdl
X2luZm8KICAgICAgICAgICogb3BlcmF0aW9uIG9uIHRoZSBjdXJyZW50IHBh
Z2UuICAoVGhhdCBwYWdlIG1heSBvciBtYXkgbm90CiAgICAgICAgICAqIHN0
aWxsIGhhdmUgUEdUX3BhcnRpYWwgc2V0LikKICAgICAgICAgICoKLSAgICAg
ICAgICogSWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0LCB0aGVu
IHRoZSBQVEUgYXQKKyAgICAgICAgICogQWRkaXRpb25hbGx5LCBpZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIHRoZSBQVEUgYXQKICAgICAgICAg
ICogQG5yX3ZhbGlkYXRlZF9wdGVmIGhvbGRzIGEgZ2VuZXJhbCByZWZlcmVu
Y2UgY291bnQgZm9yIHRoZQogICAgICAgICAgKiBwYWdlLgogICAgICAgICAg
KgpAQCAtMjQyLDIzICsyNDIsMjAgQEAgc3RydWN0IHBhZ2VfaW5mbwogICAg
ICAgICAgKiAgIGludGVycnVwdGVkCiAgICAgICAgICAqIC0gRHVyaW5nIHZh
bGlkYXRpb24sIGlmIGFuIGludmFsaWQgZW50cnkgaXMgZW5jb3VudGVyZWQg
YW5kCiAgICAgICAgICAqICAgdmFsaWRhdGlvbiBpcyBwcmVlbXB0aWJsZQot
ICAgICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiB3YXMgc2V0IG9uCi0gICAgICAgICAqICAgdGhpcyBl
bnRyeSB0byBiZWdpbiB3aXRoIChwZXJoYXBzIGJlY2F1c2UgaXQgcGlja2Vk
IHVwIGEKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiwgaWYgUFRG
X3BhcnRpYWxfc2V0IHdhcyBzZXQgb24gdGhpcworICAgICAgICAgKiAgIGVu
dHJ5IHRvIGJlZ2luIHdpdGggKHBlcmhhcHMgYmVjYXVzZSBpdCBwaWNrZWQg
dXAgYQogICAgICAgICAgKiAgIHByZXZpb3VzIG9wZXJhdGlvbikKICAgICAg
ICAgICoKLSAgICAgICAgICogV2hlbiByZXN1bWluZyB2YWxpZGF0aW9uLCBp
ZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcwotICAgICAgICAgKiBjbGVh
ciwgdGhlbiBhIGdlbmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUtYWNxdWly
ZWQ7IGlmIGl0Ci0gICAgICAgICAqIGlzIHNldCwgbm8gcmVmZXJlbmNlIHNo
b3VsZCBiZSBhY3F1aXJlZC4KKyAgICAgICAgICogV2hlbiByZXN1bWluZyB2
YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9zZXQgaXMgY2xlYXIsIHRoZW4K
KyAgICAgICAgICogYSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFj
cXVpcmVkOyBpZiBpdCBpcyBzZXQsIG5vCisgICAgICAgICAqIHJlZmVyZW5j
ZSBzaG91bGQgYmUgYWNxdWlyZWQuCiAgICAgICAgICAqCi0gICAgICAgICAq
IFdoZW4gcmVzdW1pbmcgZGUtdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYgaXMKLSAgICAgICAgICogY2xlYXIsIG5vIHJlZmVyZW5j
ZSBzaG91bGQgYmUgZHJvcHBlZDsgaWYgaXQgaXMgc2V0LCBhCi0gICAgICAg
ICAqIHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZC4KKyAgICAgICAgICog
V2hlbiByZXN1bWluZyBkZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9z
ZXQgaXMgY2xlYXIsCisgICAgICAgICAqIG5vIHJlZmVyZW5jZSBzaG91bGQg
YmUgZHJvcHBlZDsgaWYgaXQgaXMgc2V0LCBhIHJlZmVyZW5jZQorICAgICAg
ICAgKiBzaG91bGQgYmUgZHJvcHBlZC4KICAgICAgICAgICoKLSAgICAgICAg
ICogTkIgYXQgdGhlIG1vbWVudCwgUFRGX3BhcnRpYWxfc2V0IHNob3VsZCBi
ZSBzZXQgaWYgYW5kIG9ubHkgaWYKLSAgICAgICAgICogUFRGX3BhcnRpYWxf
Z2VuZXJhbF9yZWYgaXMgc2V0LgotICAgICAgICAgKgotICAgICAgICAgKiBO
QiB0aGF0IFBURl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYgYXJlCi0gICAgICAgICAqIGRlZmluZWQgaW4gbW0uYywgdGhlIG9u
bHkgcGxhY2Ugd2hlcmUgdGhleSBhcmUgdXNlZC4KKyAgICAgICAgICogTkIg
dGhhdCBQVEZfcGFydGlhbF9zZXQgaXMgZGVmaW5lZCBpbiBtbS5jLCB0aGUg
b25seSBwbGFjZQorICAgICAgICAgKiB3aGVyZSBpdCBpcyB1c2VkLgogICAg
ICAgICAgKgogICAgICAgICAgKiBUaGUgM3JkIGZpZWxkLCBAbGluZWFyX3B0
X2NvdW50LCBpbmRpY2F0ZXMKICAgICAgICAgICogLSBieSBhIHBvc2l0aXZl
IHZhbHVlLCBob3cgbWFueSBzYW1lLWxldmVsIHBhZ2UgdGFibGUgZW50cmll
cyBhIHBhZ2UKQEAgLTI2OCw4ICsyNjUsOCBAQCBzdHJ1Y3QgcGFnZV9pbmZv
CiAgICAgICAgICAqLwogICAgICAgICBzdHJ1Y3QgewogICAgICAgICAgICAg
dTE2IG5yX3ZhbGlkYXRlZF9wdGVzOlBBR0VUQUJMRV9PUkRFUiArIDE7Ci0g
ICAgICAgICAgICB1MTYgOjE2IC0gUEFHRVRBQkxFX09SREVSIC0gMSAtIDI7
Ci0gICAgICAgICAgICB1MTYgcGFydGlhbF9mbGFnczoyOworICAgICAgICAg
ICAgdTE2IDoxNiAtIFBBR0VUQUJMRV9PUkRFUiAtIDEgLSAxOworICAgICAg
ICAgICAgdTE2IHBhcnRpYWxfZmxhZ3M6MTsKICAgICAgICAgICAgIHMxNiBs
aW5lYXJfcHRfY291bnQ7CiAgICAgICAgIH07CiAKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Transfer-Encoding: base64

RnJvbSBhNjA5OGI4OTIwYjAyMTQ5MjIwNjQxY2IxMzM1OGU5MDEyYjVmYzRk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA5LzExXSB4
ODYvbW06IFByb3Blcmx5IGhhbmRsZSBsaW5lYXIgcGFnZXRhYmxlIHByb21v
dGlvbgogZmFpbHVyZXMKCkluIG9yZGVyIHRvIGFsbG93IHJlY3Vyc2l2ZSBw
YWdldGFibGUgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIHRvIGJlCmludGVy
cnVwdGVkLCBYZW4gbXVzdCBrZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0
aGUgc3ViLXBhZ2VzCnByb21vdGVkIG9yIGRlbW90ZWQuICBUaGlzIGlzIHN0
b3JlZCBpbiB0d28gZWxlbWVudHMgaW4gdGhlIHBhZ2UKc3RydWN0OiBucl9l
bnRyaWVzX3ZhbGlkYXRlZCBhbmQgcGFydGlhbF9mbGFncy4KClRoZSBydWxl
IGlzIHRoYXQgZW50cmllcyBbMCwgbnJfZW50cmllc192YWxpZGF0ZWQpIHNo
b3VsZCBhbHdheXMgYmUKdmFsaWRhdGVkIGFuZCBob2xkIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgY291bnQuICBJZiBwYXJ0aWFsX2ZsYWdzIGlzCnplcm8sIHRo
ZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXSBpcyBub3QgdmFsaWRhdGVkIGFu
ZCBubyByZWZlcmVuY2UKY291bnQgaXMgaGVsZC4gIElmIFBURl9wYXJ0aWFs
X3NldCBpcyBzZXQsIHRoZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXQppcyBw
YXJ0aWFsbHkgdmFsaWRhdGVkLCBhbmQgYSBnZW5lcmFsIHJlZmVyZW5jZSBj
b3VudCBpcyBoZWxkLgoKVW5mb3J0dW5hdGVseSwgaW4gY2FzZXMgd2hlcmUg
YW4gZW50cnkgYmVnYW4gd2l0aCBQVEZfcGFydGlhbF9zZXQgc2V0LAphbmQg
Z2V0X3BhZ2VfZnJvbV9sTmUoKSByZXR1cm5zIC1FSU5WQUwsIHRoZSBQVEZf
cGFydGlhbF9zZXQgYml0IGlzCmVycm9uZW91c2x5IGRyb3BwZWQuICAoVGhp
cyBzY2VuYXJpbyBjYW4gYmUgZW5naW5lZXJlZCBtYWlubHkgYnkgdGhlCnVz
ZSBvZiBpbnRlcmxlYXZpbmcgb2YgcHJvbW90aW5nIGFuZCBkZW1vdGluZyBh
IHBhZ2Ugd2hpY2ggaGFzICJsaW5lYXIKcGFnZXRhYmxlIiBlbnRyaWVzOyBz
ZWUgdGhlIGFwcGVuZGl4IGZvciBhIHNrZXRjaC4pICBUaGlzIG1lYW5zIHRo
YXQKd2Ugd2lsbCAibGVhayIgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBv
biB0aGUgcGFnZSBpbiBxdWVzdGlvbiwKcHJldmVudGluZyB0aGUgcGFnZSBm
cm9tIGJlaW5nIGZyZWVkLgoKRml4IHRoaXMgYnkgc2V0dGluZyBwYWdlLT5w
YXJ0aWFsX2ZsYWdzIHRvIHRoZSBwYXJ0aWFsX2ZsYWdzIGxvY2FsCnZhcmlh
YmxlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTkuCgpSZXBvcnRlZC1ieTog
R2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+Ci0tLS0tCkFwcGVuZGl4CgpTdXBwb3NlIEEgYW5kIEIgY2FuIGJv
dGggYmUgcHJvbW90ZWQgdG8gTDIgcGFnZXMsIGFuZCBBW3hdIHBvaW50cyB0
byBCLgoKVjE6IFBJTl9MMiBCLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1Rf
dmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkCgpWMTog
TU9EX0wzX0VOVFJZIHBvaW50aW5nIHNvbWV0aGluZyB0byBBLgogIEluIHRo
ZSBwcm9jZXNzIG9mIHZhbGlkYXRpbmcgQVt4XSwgZ3JhYiBhbiBleHRyYSB0
eXBlIC8gcmVmIG9uIEI6CiAgQi50eXBlX2NvdW50ID0gMiB8IFBHVF92YWxp
ZGF0ZWQKICBCLmNvdW50ID0gMyB8IFBHQ19hbGxvY2F0ZWQKICBBLnR5cGVf
Y291bnQgPSAxIHwgUEdUX3ZhbGlkYXRlZAogIEEuY291bnQgPSAyIHwgUEdD
X2FsbG9jYXRlZAoKVjE6IFVOUElOIEIuCiAgQi50eXBlX2NvdW50ID0gMSB8
IFBHVF92YWxpZGF0ZQogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAoK
VjE6IE1PRF9MM19FTlRSWSByZW1vdmluZyB0aGUgcmVmZXJlbmNlIHRvIEEu
CiAgRGUtdmFsaWRhdGUgQSwgZG93biB0byBBW3hdLCB3aGljaCBwb2ludHMg
dG8gQi4KICBEcm9wIHRoZSBmaW5hbCB0eXBlIG9uIEIuICBBcnJhbmdlIHRv
IGJlIGludGVycnVwdGVkLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFy
dGlhbAogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAogIEEudHlwZV9j
b3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFsaWRhdGVkX2VudHJp
ZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IC0xCgpWMjogTU9EX0wzX0VOVFJZ
IGFkZHMgYSByZWZlcmVuY2UgdG8gQS4KCkF0IHRoaXMgcG9pbnQsIGdldF9w
YWdlX2Zyb21fbDJlKEFbeF0pIHRyaWVzCmdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKCksIHdoaWNoIGZhaWxzIGJlY2F1c2UgaXQncyB0aGUgd3Jvbmcg
dHlwZTsKYW5kIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKCkgYWxzbyBmYWls
cywgYmVjYXVzZSBCIGlzbid0IHZhbGlkYXRlZCBhcwphbiBsMiBhbnltb3Jl
LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNiArKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCA0OTcwYjE5YWZmLi5jZmI3NTM4NDAzIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTU2Miw3ICsxNTYyLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAg
ICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKKyAgICAgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKICAg
ICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
TlVMTDsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSA9IHBhZ2U7CiAgICAgICAgICAgICB9CkBAIC0xNjQ3LDcgKzE2
NDcsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIGlmICggaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOworICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKICAgICAgICAgfQpAQCAtMTgwNCw3ICsxODA0LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CisgICAgICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAg
ICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBlbHNl
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Transfer-Encoding: base64

RnJvbSBlYWJkNzdiNTlmNDAwNjEyODUwMWQ2ZTE1ZjllNjIwZGZiMzQ5NDIw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDEwLzExXSB4
ODYvbW06IEZpeCBuZXN0ZWQgZGUtdmFsaWRhdGlvbiBvbiBlcnJvcgoKSWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBkaXNjb3ZlcmVkIHdoZW4gdmFsaWRhdGlu
ZyBhIHBhZ2UtdGFibGUgdHJlZSwKdGhlIGVudGlyZSB0cmVlIHdoaWNoIGhh
cyBzbyBmYXIgYmVlbiB2YWxpZGF0ZWQgbXVzdCBiZSBkZS12YWxpZGF0ZWQu
ClNpbmNlIHRoaXMgbWF5IHRha2UgYSBsb25nIHRpbWUsIGFsbG9jX2xbMi00
XV90YWJsZSgpIHNldCBjdXJyZW50CnZjcHUncyBvbGRfZ3Vlc3RfdGFibGUg
aW1tZWRpYXRlbHk7IHB1dF9vbGRfZ3Vlc3RfdGFibGUoKSB3aWxsIG1ha2UK
c3VyZSB0aGF0IHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxlZCB0byBm
aW5pc2ggb2ZmIHRoZQpkZS12YWxpZGF0aW9uIGJlZm9yZSBhbnkgb3RoZXIg
TU1VIG9wZXJhdGlvbnMgY2FuIGhhcHBlbiBvbiB0aGUgdmNwdS4KClRoZSBp
bnZhcmlhbnQgZm9yIHBhcnRpYWwgcGFnZXMgc2hvdWxkIGJlOgoKKiBFbnRy
aWVzIFswLCBucl92YWxpZGF0ZWRfcHRlcykgc2hvdWxkIGJlIGNvbXBsZXRl
bHkgdmFsaWRhdGVkOwogIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGRlLXZhbGlk
YXRlIHRoZXNlLgoKKiBJZiBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHBhcnRp
YWxseSB2YWxpZGF0ZWQsIHBhcnRpYWxfZmxhZ3Mgc2hvdWxkCiAgc2V0IFBU
Rl9wYXJ0aWFMX3NldC4gIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxl
ZCBvbiB0aGlzIHBhZ2UgdG8KICBmaW5pc2ggb2ZmIGRldmFsaWRhdGlvbiwg
YW5kIHRoZSBhcHByb3ByaWF0ZSByZWZjb3VudCBhZGp1c3RtZW50cwogIHdp
bGwgYmUgZG9uZS4KCmFsbG9jX2xbMi0zXV90YWJsZSgpIGluZGljYXRlcyBw
YXJ0aWFsIHZhbGlkYXRpb24gdG8gaXRzIGNhbGxlcnMgYnkKc2V0dGluZyBj
dXJyZW50LT5vbGRfZ3Vlc3RfdGFibGUuCgpVbmZvcnR1bmF0ZWx5LCB0aGlz
IGlzIG1pc2hhbmRsZWQuCgpUYWtlIHRoZSBjYXNlIHdoZXJlIHZhbGlkYXRp
bmcgbE5lW3hdIHJldHVybnMgYW4gZXJyb3IuCgpGaXJzdCwgYWxsb2NfbDNf
dGFibGUoKSBkb2Vzbid0IGNoZWNrIG9sZF9ndWVzdF90YWJsZSBhdCBhbGw7
IGFzIGEKcmVzdWx0LCBwYXJ0aWFsX2ZsYWdzIGlzIG5vdCBzZXQgd2hlbiBp
dCBzaG91bGQgYmUuICBucl92YWxpZGF0ZWRfcHRlcwppcyBzZXQgdG8geDsg
YW5kIHNpbmNlIFBGVF9wYXJ0aWFsX3NldCBjbGVhciwgZGUtdmFsaWRhdGlv
biByZXN1bWVzIGF0Cm5yX3ZhbGlkYXRlZF9wdGVzLTEuICBUaGlzIG1lYW5z
IHRoYXQgdGhlIGwyIHBhZ2UgYXQgcGwzZVt4XSB3aWxsIG5vdApoYXZlIHB1
dF9wYWdlX3R5cGUoKSBjYWxsZWQgb24gaXQgd2hlbiBkZS12YWxpZGF0aW5n
IHRoZSByZXN0IG9mIHRoZQpsMzogaXQgd2lsbCBiZSBzdHVjayBpbiB0aGUg
UEdUX3BhcnRpYWwgc3RhdGUgdW50aWwgdGhlIGRvbWFpbiBpcwpkZXN0cm95
ZWQsIG9yIHVudGlsIGl0IGlzIHJlLXVzZWQgYXMgYW4gbDIuICAoQW55IG90
aGVyIHBhZ2UgdHlwZSB3aWxsCmZhaWwuKQoKV29yc2UsIGFsbG9jX2w0X3Rh
YmxlKCksIHJhdGhlciB0aGFuIHNldHRpbmcgUFRGX3BhcnRpYWxfc2V0IGFz
IGl0CnNob3VsZCwgc2V0cyBucl92YWxpZGF0ZWRfcHRlcyB0byB4KzEuICBX
aGVuIGRlLXZhbGlkYXRpbmcsIHNpbmNlCnBhcnRpYWwgaXMgMCwgdGhpcyB3
aWxsIGNvcnJlY3RseSByZXN1bWUgY2FsbGluZyBwdXRfcGFnZV90eXBlIGF0
IFt4XTsKYnV0LCBpZiB0aGUgcHV0X3BhZ2VfdHlwZSgpIGlzIG5ldmVyIGNh
bGxlZCwgYnV0IGluc3RlYWQKZ2V0X3BhZ2VfdHlwZSgpIGlzIGNhbGxlZCwg
dmFsaWRhdGlvbiB3aWxsIHBpY2sgdXAgYXQgW3grMV0sCm5lZ2xlY3Rpbmcg
dG8gdmFsaWRhdGUgW3hdLiAgSWYgdGhlIHJlc3Qgb2YgdGhlIHZhbGlkYXRp
b24gc3VjY2VlZHMsCnRoZSBsNCB3aWxsIGJlIHZhbGlkYXRlZCBldmVuIHRo
b3VnaCBbeF0gaXMgaW52YWxpZC4KCkZpeCB0aGlzIGluIGJvdGggY2FzZXMg
Ynkgc2V0dGluZyBQVEZfcGFydGlhbF9zZXQgaWYgb2xkX2d1ZXN0X3RhYmxl
CmlzIHNldC4KCldoaWxlIGhlcmUsIGFkZCBzb21lIHNhZmV0eSBjYXRjaGVz
OgotIG9sZF9ndWVzdF90YWJsZSBtdXN0IHBvaW50IHRvIHRoZSBwYWdlIGNv
bnRhaW5lZCBpbgogIFtucl92YWxpZGF0ZWRfcHRlc10uCi0gYWxsb2NfbDFf
cGFnZSBzaG91bGRuJ3Qgc2V0IG9sZF9ndWVzdF90YWJsZQoKSWYgd2UgZXhw
ZXJpZW5jZSBvbmUgb2YgdGhlc2Ugc2l0dWF0aW9ucyBpbiBwcm9kdWN0aW9u
IGJ1aWxkcywgaXQncwpzYWZlciB0byBhdm9pZCBjYWxsaW5nIHB1dF9wYWdl
X3R5cGUgZm9yIHRoZSBwYWdlcyBpbiBxdWVzdGlvbi4gIElmCnRoZXkgaGF2
ZSBQR1RfcGFydGlhbCBzZXQsIHRoZXkgd2lsbCBiZSBjbGVhbmVkIHVwIG9u
IGRvbWFpbgpkZXN0cnVjdGlvbjsgaWYgbm90LCB3ZSBoYXZlIG5vIGlkZWEg
d2hldGhlciBhIHR5cGUgY291bnQgaXMgc2FmZSB0bwpkcm9wLiAgUmV0YWlu
aW5nIGFuIGV4dHJhIHR5cGUgcmVmIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBk
cm9wcGVkIG1heQp0cmlnZ2VyIGEgQlVHKCkgb24gdGhlIGZyZWVfZG9tYWlu
X3BhZ2UoKSBwYXRoLCBidXQgZHJvcHBpbmcgYSB0eXBlCmNvdW50IHRoYXQg
c2hvdWxkbid0IGJlIGRyb3BwZWQgbWF5IGNhdXNlIGEgcHJpdmlsZWdlIGVz
Y2FsYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDU1ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiAx
IGZpbGUgY2hhbmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigt
KQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS5jIGIveGVuL2FyY2gv
eDg2L21tLmMKaW5kZXggY2ZiNzUzODQwMy4uYWEwM2NiOGI0MCAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysrIGIveGVuL2FyY2gveDg2L21t
LmMKQEAgLTE1NjEsNiArMTU2MSwyMCBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9PSBOVUxMKTsKICAgICAgICAgICAgIGlmICggaSApCiAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAg
ICAgICAgKiBhbGxvY19sMV90YWJsZSgpIGRvZXNuJ3Qgc2V0IG9sZF9ndWVz
dF90YWJsZTsgaXQgZG9lcworICAgICAgICAgICAgICAgICAqIGl0cyBvd24g
dGVhci1kb3duIGltbWVkaWF0ZWx5IG9uIGZhaWx1cmUuICBJZiBpdAorICAg
ICAgICAgICAgICAgICAqIGRpZCB3ZSdkIG5lZWQgdG8gY2hlY2sgaXQgYW5k
IHNldCBwYXJ0aWFsX2ZsYWdzIGFzIHdlCisgICAgICAgICAgICAgICAgICog
ZG8gaW4gYWxsb2NfbFszNF1fdGFibGUoKS4KKyAgICAgICAgICAgICAgICAg
KgorICAgICAgICAgICAgICAgICAqIE5vdGUgb24gdGhlIHVzZSBvZiBBU1NF
UlQ6IGlmIGl0J3Mgbm9uLW51bGwgYW5kCisgICAgICAgICAgICAgICAgICog
aGFzbid0IGJlZW4gY2xlYW5lZCB1cCB5ZXQsIGl0IHNob3VsZCBoYXZlCisg
ICAgICAgICAgICAgICAgICogUEdUX3BhcnRpYWwgc2V0OyBhbmQgc28gdGhl
IHR5cGUgd2lsbCBiZSBjbGVhbmVkIHVwCisgICAgICAgICAgICAgICAgICog
b24gZG9tYWluIGRlc3RydWN0aW9uLiAgVW5mb3J0dW5hdGVseSwgd2Ugd291
bGQKKyAgICAgICAgICAgICAgICAgKiBsZWFrIHRoZSBnZW5lcmFsIHJlZiBo
ZWxkIGJ5IG9sZF9ndWVzdF90YWJsZTsgYnV0CisgICAgICAgICAgICAgICAg
ICogbGVha2luZyBhIHBhZ2UgaXMgbGVzcyBiYWQgdGhhbiBhIGhvc3QgY3Jh
c2guCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgQVNT
RVJUKGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID09IE5VTEwpOwog
ICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
ICAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlh
bF9mbGFnczsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF9wdHBnID0gTlVMTDsKQEAgLTE1ODgsNiArMTYwMiw3IEBAIHN0YXRp
YyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkK
ICAgICB1bnNpZ25lZCBpbnQgICBpOwogICAgIGludCAgICAgICAgICAgIHJj
ID0gMDsKICAgICB1bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFn
ZS0+cGFydGlhbF9mbGFnczsKKyAgICBsM19wZ2VudHJ5X3QgICBsM2UgPSBs
M2VfZW1wdHkoKTsKIAogICAgIHBsM2UgPSBtYXBfZG9tYWluX3BhZ2UoX21m
bihwZm4pKTsKIApAQCAtMTYzNCw3ICsxNjQ5LDExIEBAIHN0YXRpYyBpbnQg
YWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAg
ICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlm
ICggcmMgPCAwICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogWFNBLTI5
OSBCYWNrcG9ydDogQ29weSBsM2UgZm9yIGNoZWNraW5nICovCisgICAgICAg
ICAgICBsM2UgPSBwbDNlW2ldOwogICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KIAogICAgICAgICBwbDNlW2ldID0gYWRqdXN0X2d1ZXN0X2wzZShw
bDNlW2ldLCBkKTsKICAgICB9CkBAIC0xNjQ4LDYgKzE2NjcsMjQgQEAgc3Rh
dGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7CiAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0g
cGFydGlhbF9mbGFnczsKKyAgICAgICAgICAgIGlmICggY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgKQorICAgICAgICAgICAgeworICAgICAgICAg
ICAgICAgIC8qCisgICAgICAgICAgICAgICAgICogV2UndmUgZXhwZXJpZW5j
ZWQgYSB2YWxpZGF0aW9uIGZhaWx1cmUuICBJZgorICAgICAgICAgICAgICAg
ICAqIG9sZF9ndWVzdF90YWJsZSBpcyBzZXQsICJ0cmFuc2ZlciIgdGhlIGdl
bmVyYWwKKyAgICAgICAgICAgICAgICAgKiByZWZlcmVuY2UgY291bnQgdG8g
cGwzZVtucl92YWxpZGF0ZWRfcHRlc10gYnkKKyAgICAgICAgICAgICAgICAg
KiBzZXR0aW5nIFBURl9wYXJ0aWFsX3NldC4KKyAgICAgICAgICAgICAgICAg
KgorICAgICAgICAgICAgICAgICAqIEFzIGEgcHJlY2F1dGlvbiwgY2hlY2sg
dGhhdCBvbGRfZ3Vlc3RfdGFibGUgaXMgdGhlCisgICAgICAgICAgICAgICAg
ICogcGFnZSBwb2ludGVkIHRvIGJ5IHBsM2VbbnJfdmFsaWRhdGVkX3B0ZXNd
LiAgSWYKKyAgICAgICAgICAgICAgICAgKiBub3QsIGl0J3Mgc2FmZXIgdG8g
bGVhayBhIHR5cGUgcmVmIG9uIHByb2R1Y3Rpb24KKyAgICAgICAgICAgICAg
ICAgKiBidWlsZHMuCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAg
ICAgICAgaWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBs
M2VfZ2V0X3BhZ2UobDNlKSApCisgICAgICAgICAgICAgICAgICAgIHBhZ2Ut
PnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CisgICAgICAgICAg
ICAgICAgZWxzZQorICAgICAgICAgICAgICAgICAgICBBU1NFUlRfVU5SRUFD
SEFCTEUoKTsKKyAgICAgICAgICAgIH0KICAgICAgICAgICAgIGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICB9
CkBAIC0xODEwLDcgKzE4NDcsMjMgQEAgc3RhdGljIGludCBhbGxvY19sNF90
YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICAgICAgICAg
IGVsc2UKICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
IGlmICggY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQotICAgICAg
ICAgICAgICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMrKzsK
KyAgICAgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICAg
ICAgLyoKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIFdlJ3ZlIGV4cGVy
aWVuY2VkIGEgdmFsaWRhdGlvbiBmYWlsdXJlLiAgSWYKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAqIG9sZF9ndWVzdF90YWJsZSBpcyBzZXQsICJ0cmFu
c2ZlciIgdGhlIGdlbmVyYWwKKyAgICAgICAgICAgICAgICAgICAgICAgICAq
IHJlZmVyZW5jZSBjb3VudCB0byBwbDNlW25yX3ZhbGlkYXRlZF9wdGVzXSBi
eQorICAgICAgICAgICAgICAgICAgICAgICAgICogc2V0dGluZyBQVEZfcGFy
dGlhbF9zZXQuCisgICAgICAgICAgICAgICAgICAgICAgICAgKgorICAgICAg
ICAgICAgICAgICAgICAgICAgICogQXMgYSBwcmVjYXV0aW9uLCBjaGVjayB0
aGF0IG9sZF9ndWVzdF90YWJsZSBpcyB0aGUKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAqIHBhZ2UgcG9pbnRlZCB0byBieSBwbDRlW25yX3ZhbGlkYXRl
ZF9wdGVzXS4gIElmCisgICAgICAgICAgICAgICAgICAgICAgICAgKiBub3Qs
IGl0J3Mgc2FmZXIgdG8gbGVhayBhIHR5cGUgcmVmIG9uIHByb2R1Y3Rpb24K
KyAgICAgICAgICAgICAgICAgICAgICAgICAqIGJ1aWxkcy4KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAqLworICAgICAgICAgICAgICAgICAgICAgICAg
aWYgKCBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBsNGVfZ2V0
X3BhZ2UocGw0ZVtpXSkgKQorICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQ7CisgICAg
ICAgICAgICAgICAgICAgICAgICBlbHNlCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CisgICAgICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5v
bGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKICAgICAgICAg
ICAgICAgICB9Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.11/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Disposition: attachment;
 filename="xsa299-4.11/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Transfer-Encoding: base64

RnJvbSBmMDA4NmUzYWM2NWM4YmNhYmI4NGMxYzI5YWIwMGIwYzhhMTg3NTU1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NTAgKzAxMDAKU3ViamVjdDogW1BBVENIIDExLzExXSB4
ODYvbW06IERvbid0IGRyb3AgYSB0eXBlIHJlZiB1bmxlc3MgeW91IGhlbGQg
YSByZWYgdG8KIGJlZ2luIHdpdGgKClZhbGlkYXRpb24gYW5kIGRlLXZhbGlk
YXRpb24gb2YgcGFnZXRhYmxlIHRyZWVzIG1heSB0YWtlIGFyYml0cmFyaWx5
CmxhcmdlIGFtb3VudHMgb2YgdGltZSwgYW5kIHNvIG11c3QgYmUgcHJlZW1w
dGlibGUuICBUaGlzIGlzIGluZGljYXRlZApieSBzZXR0aW5nIHRoZSBQR1Rf
cGFydGlhbCBiaXQgaW4gdGhlIHR5cGVfaW5mbywgYW5kIHNldHRpbmcKbnJf
dmFsaWRhdGVkX2VudHJpZXMgYW5kIHBhcnRpYWxfZmxhZ3MgYXBwcm9wcmlh
dGVseS4gIFNwZWNpZmljYWxseSwKaWYgdGhlIGVudHJ5IGF0IFtucl92YWxp
ZGF0ZWRfZW50cmllc10gaXMgcGFydGlhbGx5IHZhbGlkYXRlZCwKcGFydGlh
bF9mbGFncyBzaG91bGQgaGF2ZSB0aGUgUEdUX3BhcnRpYWxfc2V0IGJpdCBz
ZXQsIGFuZCB0aGUgZW50cnkKc2hvdWxkIGhvbGQgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudC4gIER1cmluZyBkZS12YWxpZGF0aW9uLApwdXRfcGFnZV90
eXBlKCkgaXMgY2FsbGVkIG9uIHBhcnRpYWxseSB2YWxpZGF0ZWQgZW50cmll
cy4KClVuZm9ydHVuYXRlbHksIHRoZXJlIGFyZSBhIG51bWJlciBvZiBpc3N1
ZXMgd2l0aCB0aGUgY3VycmVudCBhbGdvcml0aG0uCgpGaXJzdCwgZG9pbmcg
YSAibm9ybWFsIiBwdXRfcGFnZV90eXBlKCkgaXMgbm90IHNhZmUgd2hlbiBu
byB0eXBlIHJlZgppcyBoZWxkOiB0aGVyZSBpcyBub3RoaW5nIHRvIHN0b3Ag
YW5vdGhlciB2Y3B1IGZyb20gY29taW5nIGFsb25nIGFuZApwaWNraW5nIHVw
IHZhbGlkYXRpb24gYWdhaW46IGF0IHdoaWNoIHBvaW50IHRoZSBwdXRfcGFn
ZV90eXBlIG1heSBkcm9wCnRoZSBvbmx5IHBhZ2UgcmVmIG9uIGFuIGluLXVz
ZSBwYWdlLiAgU29tZSBleGFtcGxlcyBhcmUgbGlzdGVkIGluIHRoZQphcHBl
bmRpeC4KClRoZSBjb3JlIGlzc3VlIGlzIHRoYXQgcHV0X3BhZ2VfdHlwZSgp
IGlzIGJlaW5nIGNhbGxlZCBib3RoIHRvIGNsZWFuCnVwIFBHVF9wYXJ0aWFs
LCBhbmQgdG8gZHJvcCBhIHR5cGUgY291bnQ7IGFuZCBoYXMgbm8gd2F5IG9m
IGtub3dpbmcKd2hpY2ggaXMgd2hpY2g7IGFuZCBzbyBpZiBpbiBiZXR3ZWVu
LCBQR1RfcGFydGlhbCBpcyBjbGVhcmVkLApwdXRfcGFnZV90eXBlKCkgd2ls
bCBkcm9wIHRoZSB0eXBlIHJlZiBlcnJvbmVvdXNseS4KCldoYXQgaXMgbmVl
ZGVkIGlzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIHN0YXRlczoKLSBE
cm9wcGluZyBhIHR5cGUgcmVmIHdoaWNoIGlzIGhlbGQKLSBDbGVhbmluZyB1
cCBhIHBhZ2Ugd2hpY2ggaGFzIGJlZW4gcGFydGlhbGx5IGRlL3ZhbGlkYXRl
ZAoKRml4IHRoaXMgYnkgdGVsbGluZyBwdXRfcGFnZV90eXBlKCkgd2hpY2gg
b2YgdGhlIHR3byBhY3Rpdml0aWVzIHlvdQppbnRlbmQuCgpXaGVuIGNsZWFu
aW5nIHVwIGEgcGFydGlhbCBkZS92YWxpZGF0aW9uLCB0YWtlIG5vIGFjdGlv
biB1bmxlc3MgeW91CmZpbmQgYSBwYWdlIHBhcnRpYWxseSB2YWxpZGF0ZWQu
CgpJZiBwdXRfcGFnZV90eXBlKCkgaXMgY2FsbGVkIHdpdGhvdXQgUFRGX3Bh
cnRpYWxfc2V0LCBhbmQgZmluZHMgdGhlCnBhZ2UgaW4gYSBQR1RfcGFydGlh
bCBzdGF0ZSBhbnl3YXksIHRoZW4gdGhlcmUncyBjZXJ0YWlubHkgYmVlbiBh
Cm1pc2FjY291bnRpbmcgc29tZXdoZXJlLCBhbmQgY2Fycnlpbmcgb24gd291
bGQgYWxtb3N0IGNlcnRhaW5seSBjYXVzZQphIHNlY3VyaXR5IGlzc3VlLCBz
byBjcmFzaCB0aGUgaG9zdCBpbnN0ZWFkLgoKSW4gcHV0X3BhZ2VfZnJvbV9s
TmUsIHBhc3MgcGFydGlhbF9mbGFncyBvbiB0byBfcHV0X3BhZ2VfdHlwZSgp
LgoKb2xkX2d1ZXN0X3RhYmxlIG1heSBiZSBzZXQgZWl0aGVyIHdpdGggYSBm
dWxseSB2YWxpZGF0ZWQgcGFnZSAod2hlbgp1c2luZyB0aGUgImRlZmVycmVk
IHB1dCIgcGF0dGVybiksIG9yIHdpdGggYSBwYXJ0aWFsbHkgdmFsaWRhdGVk
IHBhZ2UKKHdoZW4gYSBub3JtYWwgImRlLXZhbGlkYXRpb24iIGlzIGludGVy
cnVwdGVkLCBvciB3aGVuIGEgdmFsaWRhdGlvbgpmYWlscyBwYXJ0LXdheSB0
aHJvdWdoIGR1ZSB0byBpbnZhbGlkIGVudHJpZXMpLiAgQWRkIGEgZmxhZywK
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwsIHRvIGluZGljYXRlIHdoaWNoIG9m
IHRoZXNlIGl0IGlzLCBhbmQgdXNlCnRoYXQgdG8gcGFzcyB0aGUgYXBwcm9w
cmlhdGUgZmxhZyB0byBfcHV0X3BhZ2VfdHlwZSgpLgoKV2hpbGUgaGVyZSwg
ZGVsZXRlIHN0cmF5IHRyYWlsaW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tLS0KQXBw
ZW5kaXg6CgpTdXBwb3NlIHBhZ2UgQSwgd2hlbiBpbnRlcnByZXRlZCBhcyBh
biBsMyBwYWdldGFibGUsIGNvbnRhaW5zIGFsbAp2YWxpZCBlbnRyaWVzOyBh
bmQgc3VwcG9zZSBBW3hdIHBvaW50cyB0byBwYWdlIEIsIHdoaWNoIHdoZW4K
aW50ZXJwcmV0ZWQgYXMgYW4gbDIgcGFnZXRhYmxlLCBjb250YWlucyBhbGwg
dmFsaWQgZW50cmllcy4KClAxOiBQSU5fTDNfVEFCTEUKICBBIC0+IFBHVF9s
M190YWJsZSB8IDEgfCB2YWxpZAogIEIgLT4gUEdUX2wyX3RhYmxlIHwgMSB8
IHZhbGlkCgpQMTogVU5QSU5fVEFCTEUKICA+IEFycmFuZ2UgdG8gaW50ZXJy
dXB0IGFmdGVyIEIgaGFzIGJlZW4gZGUtdmFsaWRhdGVkCiAgQjoKICAgIHR5
cGVfaW5mbyAtPiBQR1RfbDJfdGFibGUgfCAwCiAgQToKICAgIHR5cGVfaW5m
byAtPiBQR1RfbDNfdGFibGUgfCAxIHwgcGFydGlhbAogICAgbnJfdmFsaWRh
dGVkX2VudGllcyAtPiAobGVzcyB0aGFuIHgpCgpQMjogbW9kX2w0X2VudHJ5
IHRvIHBvaW50IHRvIEEKICA+IEFycmFuZ2UgZm9yIHRoaXMgdG8gYmUgaW50
ZXJydXB0ZWQgd2hpbGUgQiBpcyBiZWluZyB2YWxpZGF0ZWQKICBCOgogICAg
dHlwZV9pbmZvIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBwYXJ0aWFsCiAgICAo
bnJfdmFsaWRhdGVkX2VudGlyZXMgJmMgc2V0IGFzIGFwcHJvcHJpYXRlKQog
IEE6CiAgICB0eXBlX2luZm8gLT4gUEdUX2wzX3RhYmxlIHwgMSB8IHBhcnRp
YWwKICAgIG5yX3ZhbGlkYXRlZF9lbnRyaWVzIC0+IHgKICAgIHBhcnRpYWxf
cHRlID0gMQoKUDM6IG1vZF9sM19lbnRyeSBzb21lIG90aGVyIHVucmVsYXRl
ZCBsMyB0byBwb2ludCB0byBCOgogIEI6CiAgICB0eXBlX2luZm8gLT4gUEdU
X2wyX3RhYmxlIHwgMQoKUDE6IFJlc3RhcnQgVU5QSU5fVEFCTEUKCkF0IHRo
aXMgcG9pbnQsIHNpbmNlIEEubnJfdmFsaWRhdGVfZW50cmllcyA9PSB4IGFu
ZCBBLnBhcnRpYWxfcHRlICE9CjAsIGZyZWVfbDNfdGFibGUoKSB3aWxsIGNh
bGwgcHV0X3BhZ2VfZnJvbV9sM2UoKSBvbiBwbDNlW3hdLCBkcm9wcGluZwpp
dHMgdHlwZSBjb3VudCB0byAwIHdoaWxlIGl0J3Mgc3RpbGwgYmVpbmcgcG9p
bnRlZCB0byBieSBzb21lIG90aGVyIGwzCgpBIHNpbWlsYXIgaXNzdWUgYXJp
c2VzIHdpdGggb2xkX2d1ZXN0X3RhYmxlLiAgQ29uc2lkZXIgdGhlIGZvbGxv
d2luZwpzY2VuYXJpbzoKClN1cHBvc2UgQSBpcyBhIHBhZ2Ugd2hpY2gsIHdo
ZW4gaW50ZXJwcmV0ZWQgYXMgYW4gbDIsIGhhcyB2YWxpZCBlbnRyaWVzCnVu
dGlsIGVudHJ5IHgsIHdoaWNoIGlzIGludmFsaWQuCgpWMTogIFBJTl9MMl9U
QUJMRShBKQogIDxWYWxpZGF0ZSB1bnRpbCB3ZSB0cnkgdG8gdmFsaWRhdGUg
W3hdLCBnZXQgLUVJTlZBTD4KICBBIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBQ
R1RfcGFydGlhbAogIFYxIC0+IG9sZF9ndWVzdF90YWJsZSA9IEEKICA8ZGVs
YXllZD4KClYyOiBQSU5fTDJfVEFCTEUoQSkKICA8UGljayB1cCB3aGVyZSBW
MSBsZWZ0IG9mZiwgdHJ5IHRvIHJlLXZhbGlkYXRlIFt4XSwgZ2V0IC1FSU5W
QUw+CiAgQSAtPiBQR1RfbDJfdGFibGUgfCAxIHwgUEdUX3BhcnRpYWwKICBW
MiAtPiBvbGRfZ3Vlc3RfdGFibGUgPSBBCiAgPHJlc3RhcnQ+CiAgcHV0X29s
ZF9ndWVzdF90YWJsZSgpCiAgICBfcHV0X3BhZ2VfdHlwZShBKQogICAgICBB
IC0+IFBHVF9sMl90YWJsZSB8IDAKClYxOiA8cmVzdGFydD4KICBwdXRfb2xk
X2d1ZXN0X3RhYmxlKCkKICAgIF9wdXRfcGFnZV90eXBlKEEpICMgVU5ERVJG
TE9XCgpJbmRlZWQsIGl0IGlzIHBvc3NpYmxlIHRvIGVuZ2luZWVyIGZvciBv
bGRfZ3Vlc3RfdGFibGUgZm9yIGV2ZXJ5IHZjcHUKYSBndWVzdCBoYXMgdG8g
cG9pbnQgdG8gdGhlIHNhbWUgcGFnZS4KLS0tCiB4ZW4vYXJjaC94ODYvZG9t
YWluLmMgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAg
ICAgICAgIHwgOTkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oIHwgIDQgKy0KIDMg
ZmlsZXMgY2hhbmdlZCwgOTUgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IDhmYmVjYmIxNjkuLmM4ODA1Njhk
ZDQgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTEwNzQsOSArMTA3NCwxNSBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICAgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0
aHJvdWdoICovCiAgICAgICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6Cisg
ICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICAgICAq
IE5CIHRoYXQgd2UncmUgcHV0dGluZyB0aGUga2VybmVsLW1vZGUgdGFibGUK
KyAgICAgICAgICAgICAgICAgICAgICogaGVyZSwgd2hpY2ggd2UndmUgYWxy
ZWFkeSBzdWNjZXNzZnVsbHkKKyAgICAgICAgICAgICAgICAgICAgICogdmFs
aWRhdGVkIGFib3ZlOyBoZW5jZSBwYXJ0aWFsID0gZmFsc2U7CisgICAgICAg
ICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgICB2LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPQogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZXRhYmxlX2dldF9wYWdlKHYtPmFyY2guZ3Vlc3RfdGFibGUp
OworICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgIHYtPmFy
Y2guZ3Vlc3RfdGFibGUgPSBwYWdldGFibGVfbnVsbCgpOwogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0Ogpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCBhYTAzY2I4YjQwLi5jNzAxYzdlZjE0IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTM1MywxMCArMTM1MywxMSBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gcHRwZzsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgIH0K
ICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOworICAg
ICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHko
IXJjKSApCiAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAg
ICB9CkBAIC0xMzc5LDYgKzEzODAsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdl
X2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZu
LAogICAgICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwzZV9nZXRfcGZuKGwz
ZSk7CiAgICAgICAgIGludCB3cml0ZWFibGUgPSBsM2VfZ2V0X2ZsYWdzKGwz
ZSkgJiBfUEFHRV9SVzsKIAorICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBU
Rl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBBU1NFUlQoIShtZm4gJiAoKDFV
TCA8PCAoTDNfUEFHRVRBQkxFX1NISUZUIC0gUEFHRV9TSElGVCkpIC0gMSkp
KTsKICAgICAgICAgZG8gewogICAgICAgICAgICAgcHV0X2RhdGFfcGFnZSht
Zm5fdG9fcGFnZShfbWZuKG1mbikpLCB3cml0ZWFibGUpOwpAQCAtMTM5MSwx
MiArMTM5MywxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwz
X3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgaWYg
KCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgeworICAgICAgICBBU1NFUlQo
IShmbGFncyAmIFBURl9wYXJ0aWFsX3NldCkpOwogICAgICAgICBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21mbihwZm4p
KTsKICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBw
ZzsKKyAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbCA9IGZhbHNlOwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAg
ICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIG1m
bl90b19wYWdlKF9tZm4ocGZuKSkpOworICAgIHJjID0gX3B1dF9wYWdlX3R5
cGUocGcsIGZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShf
bWZuKHBmbikpKTsKICAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICAgICAg
cHV0X3BhZ2UocGcpOwogCkBAIC0xNDE1LDEyICsxNDE5LDE1IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRfcGdlbnRyeV90IGw0ZSwgdW5z
aWduZWQgbG9uZyBwZm4sCiAKICAgICAgICAgaWYgKCBmbGFncyAmIFBURl9k
ZWZlciApCiAgICAgICAgIHsKKyAgICAgICAgICAgIEFTU0VSVCghKGZsYWdz
ICYgUFRGX3BhcnRpYWxfc2V0KSk7CiAgICAgICAgICAgICBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21mbihwZm4pKTsK
ICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0g
cGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICByZXR1cm4gMDsKICAg
ICAgICAgfQogCi0gICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBU
Rl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAg
ICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZsYWdzIHwgUFRGX3ByZWVt
cHRpYmxlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90b19w
YWdlKF9tZm4ocGZuKSkpOwogICAgICAgICBpZiAoIGxpa2VseSghcmMpICkK
ICAgICAgICAgICAgIHB1dF9wYWdlKHBnKTsKICAgICB9CkBAIC0xNTI1LDYg
KzE1MzIsMTQgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAKICAgICBw
bDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAKKyAgICAvKgor
ICAgICAqIE5CIHRoYXQgYWxsb2NfbDJfdGFibGUgd2lsbCBuZXZlciBzZXQg
cGFydGlhbF9wdGUgb24gYW4gbDI7IGJ1dAorICAgICAqIGZyZWVfbDJfdGFi
bGUgbWlnaHQgaWYgYSBsaW5lYXJfcGFnZXRhYmxlIGVudHJ5IGlzIGludGVy
cnVwdGVkCisgICAgICogcGFydHdheSB0aHJvdWdoIGRlLXZhbGlkYXRpb24u
ICBJbiB0aGF0IGNpcmN1bXN0YW5jZSwKKyAgICAgKiBnZXRfcGFnZV9mcm9t
X2wyZSgpIHdpbGwgYWx3YXlzIHJldHVybiAtRUlOVkFMOyBhbmQgd2UgbXVz
dAorICAgICAqIHJldGFpbiB0aGUgdHlwZSByZWYgYnkgZG9pbmcgdGhlIG5v
cm1hbCBwYXJ0aWFsX2ZsYWdzIHRyYWNraW5nLgorICAgICAqLworCiAgICAg
Zm9yICggaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzOyBpIDwgTDJfUEFH
RVRBQkxFX0VOVFJJRVM7CiAgICAgICAgICAgaSsrLCBwYXJ0aWFsX2ZsYWdz
ID0gMCApCiAgICAgewpAQCAtMTU3OSw2ICsxNTk0LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNp
Z25lZCBsb25nIHR5cGUpCiAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlh
bF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAgICAgICAgICAgY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAg
ICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwor
ICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxl
X3BhcnRpYWwgPSB0cnVlOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAg
ICAgICAgIGlmICggcmMgPCAwICkKQEAgLTE2ODEsMTIgKzE2OTcsMTYgQEAg
c3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgICAgICAgICAgICAgICAqIGJ1aWxkcy4KICAgICAgICAgICAg
ICAgICAgKi8KICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlID09IGwzZV9nZXRfcGFnZShsM2UpICkKKyAgICAg
ICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICAgIEFTU0VSVChjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsKTsKICAgICAgICAg
ICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFs
X3NldDsKKyAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsK
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOworICAgICAgICAgICAgY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IHRydWU7CiAgICAg
ICAgIH0KICAgICAgICAgd2hpbGUgKCBpLS0gPiAwICkKICAgICAgICAgICAg
IHBsM2VbaV0gPSB1bmFkanVzdF9ndWVzdF9sM2UocGwzZVtpXSwgZCk7CkBA
IC0xODYwLDEyICsxODgwLDE2IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFi
bGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICAg
ICAgICAgICAqIGJ1aWxkcy4KICAgICAgICAgICAgICAgICAgICAgICAgICAq
LwogICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBsNGVfZ2V0X3BhZ2UocGw0ZVtpXSkgKQor
ICAgICAgICAgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdl
LT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OworICAgICAgICAg
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNI
QUJMRSgpOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwog
ICAgICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90
YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgIH0KICAgICAgICAgfQpAQCAtMjc4Miw2
ICsyODA2LDI4IEBAIHN0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICAg
ICB4ICA9IHk7CiAgICAgICAgIG54ID0geCAtIDE7CiAKKyAgICAgICAgLyoK
KyAgICAgICAgICogSXMgdGhpcyBleHBlY3RlZCB0byBkbyBhIGZ1bGwgcmVm
ZXJlbmNlIGRyb3AsIG9yIG9ubHkKKyAgICAgICAgICogY2xlYW51cCBwYXJ0
aWFsIHZhbGlkYXRpb24gLyBkZXZhbGlkYXRpb24/CisgICAgICAgICAqCisg
ICAgICAgICAqIElmIHRoZSBmb3JtZXIsIHRoZSBjYWxsZXIgbXVzdCBob2xk
IGEgImZ1bGwiIHR5cGUgcmVmOworICAgICAgICAgKiB3aGljaCBtZWFucyB0
aGUgcGFnZSBtdXN0IGJlIHZhbGlkYXRlZC4gIElmIHRoZSBwYWdlIGlzCisg
ICAgICAgICAqICpub3QqIGZ1bGx5IHZhbGlkYXRlZCwgY29udGludWluZyB3
b3VsZCBhbG1vc3QgY2VydGFpbmx5CisgICAgICAgICAqIG9wZW4gdXAgYSBz
ZWN1cml0eSBob2xlLiAgQW4gZXhjZXB0aW9uIHRvIHRoaXMgaXMgZHVyaW5n
CisgICAgICAgICAqIGRvbWFpbiBkZXN0cnVjdGlvbiwgd2hlcmUgUEdUX3Zh
bGlkYXRlZCBjYW4gYmUgZHJvcHBlZAorICAgICAgICAgKiB3aXRob3V0IGRy
b3BwaW5nIGEgdHlwZSByZWYuCisgICAgICAgICAqCisgICAgICAgICAqIElm
IHRoZSBsYXR0ZXIsIGRvIG5vdGhpbmcgdW5sZXNzIHR5cGUgUEdUX3BhcnRp
YWwgaXMgc2V0LgorICAgICAgICAgKiBJZiBpdCBpcyBzZXQsIHRoZSB0eXBl
IGNvdW50IG11c3QgYmUgMS4KKyAgICAgICAgICovCisgICAgICAgIGlmICgg
IShmbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgKQorICAgICAgICAgICAgQlVH
X09OKCh4ICYgUEdUX3BhcnRpYWwpIHx8CisgICAgICAgICAgICAgICAgICAg
ISgoeCAmIFBHVF92YWxpZGF0ZWQpIHx8IHBhZ2VfZ2V0X293bmVyKHBhZ2Up
LT5pc19keWluZykpOworICAgICAgICBlbHNlIGlmICggISh4ICYgUEdUX3Bh
cnRpYWwpICkKKyAgICAgICAgICAgIHJldHVybiAwOworICAgICAgICBlbHNl
CisgICAgICAgICAgICBCVUdfT04oKHggJiBQR1RfY291bnRfbWFzaykgIT0g
MSk7CisKICAgICAgICAgQVNTRVJUKCh4ICYgUEdUX2NvdW50X21hc2spICE9
IDApOwogCiAgICAgICAgIHN3aXRjaCAoIG54ICYgKFBHVF9sb2NrZWQgfCBQ
R1RfY291bnRfbWFzaykgKQpAQCAtMzA0MSwxNyArMzA4NywzNCBAQCBpbnQg
cHV0X29sZF9ndWVzdF90YWJsZShzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAo
ICF2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCiAgICAgICAgIHJldHVybiAw
OwogCi0gICAgc3dpdGNoICggcmMgPSBfcHV0X3BhZ2VfdHlwZSh2LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSwgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRw
ZykgKQorICAgIHJjID0gX3B1dF9wYWdlX3R5cGUodi0+YXJjaC5vbGRfZ3Vl
c3RfdGFibGUsCisgICAgICAgICAgICAgICAgICAgICAgICBQVEZfcHJlZW1w
dGlibGUgfAorICAgICAgICAgICAgICAgICAgICAgICAgKCB2LT5hcmNoLm9s
ZF9ndWVzdF90YWJsZV9wYXJ0aWFsID8KKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgUFRGX3BhcnRpYWxfc2V0IDogMCApLAorICAgICAgICAgICAgICAg
ICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyk7CisKKyAgICBpZiAo
IHJjID09IC1FUkVTVEFSVCB8fCByYyA9PSAtRUlOVFIgKQogICAgIHsKLSAg
ICBjYXNlIC1FSU5UUjoKLSAgICBjYXNlIC1FUkVTVEFSVDoKKyAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IChyYyA9PSAtRVJF
U1RBUlQpOwogICAgICAgICByZXR1cm4gLUVSRVNUQVJUOwotICAgIGNhc2Ug
MDoKLSAgICAgICAgcHV0X3BhZ2Uodi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUp
OwogICAgIH0KIAorICAgIC8qCisgICAgICogSXQgc2hvdWxkbid0IGJlIHBv
c3NpYmxlIGZvciBfcHV0X3BhZ2VfdHlwZSgpIHRvIHJldHVybgorICAgICAq
IGFueXRoaW5nIGVsc2UgYXQgdGhlIG1vbWVudDsgYnV0IGlmIGl0IGRvZXMg
aGFwcGVuIGluCisgICAgICogcHJvZHVjdGlvbiwgbGVha2luZyB0aGUgdHlw
ZSByZWYgaXMgcHJvYmFibHkgdGhlIGJlc3QgdGhpbmcgdG8KKyAgICAgKiBk
by4gIEVpdGhlciB3YXksIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGhlbGQgYnkg
b2xkX2d1ZXN0X3RhYmxlLgorICAgICAqLworICAgIEFTU0VSVChyYyA9PSAw
KTsKKworICAgIHB1dF9wYWdlKHYtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKTsK
ICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IE5VTEw7CisgICAgdi0+
YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CisgICAgLyoKKyAgICAgKiBT
YWZlc3QgZGVmYXVsdCBpZiBzb21lb25lIHNldHMgb2xkX2d1ZXN0X3RhYmxl
IHdpdGhvdXQKKyAgICAgKiBleHBsaWNpdGx5IHNldHRpbmcgb2xkX2d1ZXN0
X3RhYmxlX3BhcnRpYWwuCisgICAgICovCisgICAgdi0+YXJjaC5vbGRfZ3Vl
c3RfdGFibGVfcGFydGlhbCA9IHRydWU7CiAKICAgICByZXR1cm4gcmM7CiB9
CkBAIC0zMjAxLDExICszMjY0LDExIEBAIGludCBuZXdfZ3Vlc3RfY3IzKG1m
bl90IG1mbikKICAgICAgICAgICAgIHN3aXRjaCAoIHJjID0gcHV0X3BhZ2Vf
YW5kX3R5cGVfcHJlZW1wdGlibGUocGFnZSkgKQogICAgICAgICAgICAgewog
ICAgICAgICAgICAgY2FzZSAtRUlOVFI6Ci0gICAgICAgICAgICAgICAgcmMg
PSAtRVJFU1RBUlQ7Ci0gICAgICAgICAgICAgICAgLyogZmFsbHRocm91Z2gg
Ki8KICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJUOgogICAgICAgICAgICAg
ICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAg
ICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsK
KyAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZV9w
YXJ0aWFsID0gKHJjID09IC1FUkVTVEFSVCk7CisgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg
ICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgIEJVR19PTihyYyk7
CkBAIC0zNDc5LDYgKzM1NDIsNyBAQCBsb25nIGRvX21tdWV4dF9vcCgKICAg
ICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAg
Y3Vyci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAg
ICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBh
Z2U7CisgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9n
dWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9CkBAIC0z
NTEzLDYgKzM1NzcsMTEgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAg
ICAgICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAgICBjdXJyLT5h
cmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICBj
dXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CisgICAgICAgICAg
ICAgICAgLyoKKyAgICAgICAgICAgICAgICAgKiBFSU5UUiBtZWFucyB3ZSBz
dGlsbCBob2xkIHRoZSB0eXBlIHJlZjsgRVJFU1RBUlQKKyAgICAgICAgICAg
ICAgICAgKiBtZWFucyBQR1RfcGFydGlhbCBob2xkcyB0aGUgdHlwZSByZWYK
KyAgICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgICAgICBjdXJyLT5h
cmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gKHJjID09IC1FUkVTVEFS
VCk7CiAgICAgICAgICAgICAgICAgcmMgPSAwOwogICAgICAgICAgICAgICAg
IGJyZWFrOwogICAgICAgICAgICAgZGVmYXVsdDoKQEAgLTM1ODEsMTEgKzM2
NTAsMTUgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgICAgICAgICAg
c3dpdGNoICggcmMgPSBwdXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJsZShw
YWdlKSApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIGNh
c2UgLUVJTlRSOgotICAgICAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFS
VDsKLSAgICAgICAgICAgICAgICAgICAgLyogZmFsbHRocm91Z2ggKi8KICAg
ICAgICAgICAgICAgICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAg
ICAgICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAg
ICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0g
cGFnZTsKKyAgICAgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAg
ICAgICAgICogRUlOVFIgbWVhbnMgd2Ugc3RpbGwgaG9sZCB0aGUgdHlwZSBy
ZWY7CisgICAgICAgICAgICAgICAgICAgICAqIEVSRVNUQVJUIG1lYW5zIFBH
VF9wYXJ0aWFsIGhvbGRzIHRoZSByZWYKKyAgICAgICAgICAgICAgICAgICAg
ICovCisgICAgICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0
X3RhYmxlX3BhcnRpYWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKKyAgICAgICAg
ICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAg
ICAgIGJyZWFrOwogICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg
ICAgICAgICAgICAgIEJVR19PTihyYyk7CmRpZmYgLS1naXQgYS94ZW4vaW5j
bHVkZS9hc20teDg2L2RvbWFpbi5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9k
b21haW4uaAppbmRleCAxYWM1YTk2YzA4Li4zNjBjMzhiZDgzIDEwMDY0NAot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oCisrKyBiL3hlbi9p
bmNsdWRlL2FzbS14ODYvZG9tYWluLmgKQEAgLTMwOSw3ICszMDksNyBAQCBz
dHJ1Y3QgYXJjaF9kb21haW4KIAogICAgIHN0cnVjdCBwYWdpbmdfZG9tYWlu
IHBhZ2luZzsKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtOwotICAgIC8q
IFRvIGVuZm9yY2UgbG9jayBvcmRlcmluZyBpbiB0aGUgcG9kIGNvZGUgd3J0
IHRoZSAKKyAgICAvKiBUbyBlbmZvcmNlIGxvY2sgb3JkZXJpbmcgaW4gdGhl
IHBvZCBjb2RlIHdydCB0aGUKICAgICAgKiBwYWdlX2FsbG9jIGxvY2sgKi8K
ICAgICBpbnQgcGFnZV9hbGxvY191bmxvY2tfbGV2ZWw7CiAKQEAgLTU0Miw2
ICs1NDIsOCBAQCBzdHJ1Y3QgYXJjaF92Y3B1CiAgICAgc3RydWN0IHBhZ2Vf
aW5mbyAqb2xkX2d1ZXN0X3RhYmxlOyAgLyogcGFydGlhbGx5IGRlc3RydWN0
ZWQgcGFnZXRhYmxlICovCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqb2xkX2d1
ZXN0X3B0cGc7ICAgLyogY29udGFpbmluZyBwYWdlIHRhYmxlIG9mIHRoZSAq
LwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8q
IGZvcm1lciwgaWYgYW55ICovCisgICAgYm9vbCBvbGRfZ3Vlc3RfdGFibGVf
cGFydGlhbDsgICAgICAgLyogQXJlIHdlIGRyb3BwaW5nIGEgdHlwZSByZWYs
IG9yIGp1c3QKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKiBmaW5pc2hpbmcgdXAgYSBwYXJ0aWFsIGRlLXZhbGlkYXRpb24/
ICovCiAgICAgLyogZ3Vlc3RfdGFibGUgaG9sZHMgYSByZWYgdG8gdGhlIHBh
Z2UsIGFuZCBhbHNvIGEgdHlwZS1jb3VudCB1bmxlc3MKICAgICAgKiBzaGFk
b3cgcmVmY291bnRzIGFyZSBpbiB1c2UgKi8KICAgICBwYWdldGFibGVfdCBz
aGFkb3dfdGFibGVbNF07ICAgICAgICAvKiAoTUZOKSBzaGFkb3cocykgb2Yg
Z3Vlc3QgKi8KLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Transfer-Encoding: base64

RnJvbSAzM2QwNTE5MTdkNWVmMzhmNjc4YjUwN2EzYzgzMmFmZGU0OGI5YjQ5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAxLzExXSB4
ODYvbW06IEwxVEYgY2hlY2tzIGRvbid0IGxlYXZlIGEgcGFydGlhbCBlbnRy
eQoKT24gZGV0ZWN0aW9uIG9mIGEgcG90ZW50aWFsIEwxVEYgaXNzdWUsIG1v
c3QgdmFsaWRhdGlvbiBjb2RlIHJldHVybnMKLUVSRVNUQVJUIHRvIGFsbG93
IHRoZSBzd2l0Y2ggdG8gc2hhZG93IG1vZGUgdG8gaGFwcGVuIGFuZCBjYXVz
ZSB0aGUKb3JpZ2luYWwgb3BlcmF0aW9uIHRvIGJlIHJlc3RhcnRlZC4KCkhv
d2V2ZXIsIGluIHRoZSB2YWxpZGF0aW9uIGNvZGUsIHRoZSByZXR1cm4gdmFs
dWUgLUVSRVNUQVJUIGhhcyBiZWVuCnJlcHVycG9zZWQgdG8gaW5kaWNhdGUg
MSkgdGhlIGZ1bmN0aW9uIGhhcyBwYXJ0aWFsbHkgY29tcGxldGVkCnNvbWV0
aGluZyB3aGljaCBuZWVkcyB0byBiZSB1bmRvbmUsIGFuZCAyKSBjYWxsaW5n
IHB1dF9wYWdlX3R5cGUoKQpzaG91bGQgY2xlYW5seSB1bmRvIGl0LiAgVGhp
cyBjYXVzZXMgcHJvYmxlbXMgaW4gc2V2ZXJhbCBwbGFjZXMuCgpGb3IgTDEg
dGFibGVzLCBvbiByZWNlaXZpbmcgYW4gLUVSRVNUQVJUIHJldHVybiBmcm9t
IGFsbG9jX2wxX3RhYmxlKCksCmFsbG9jX3BhZ2VfdHlwZSgpIHdpbGwgc2V0
IFBHVF9wYXJ0aWFsIG9uIHRoZSBwYWdlLiAgSWYgZm9yIHNvbWUKcmVhc29u
IHRoZSBvcmlnaW5hbCBvcGVyYXRpb24gbmV2ZXIgcmVzdGFydHMsIHRoZW4g
b24gZG9tYWluCmRlc3RydWN0aW9uLCByZWxpbnF1aXNoX21lbW9yeSgpIHdp
bGwgY2FsbCBmcmVlX3BhZ2VfdHlwZSgpIG9uIHRoZQpwYWdlLgoKVW5mb3J0
dW5hdGVseSwgYWxsb2NfIGFuZCBmcmVlX2wxX3RhYmxlKCkgYXJlbid0IHNl
dCB1cCB0byBkZWFsIHdpdGgKUEdUX3BhcnRpYWwuICBXaGVuIHJldHVybmlu
ZyBhIGZhaWx1cmUsIGFsbG9jX2wxX3RhYmxlKCkgYWx3YXlzCmRlLXZhbGlk
YXRlcyB3aGF0ZXZlciBpdCdzIHZhbGlkYXRlZCBzbyBmYXIsIGFuZCBmcmVl
X2wxX3RhYmxlKCkKYWx3YXlzIGRldmFsaWRhdGVzIHRoZSB3aG9sZSBwYWdl
LiAgVGhpcyBtZWFucyB0aGF0IGlmCnJlbGlucXVpc2hfbWVtb3J5KCkgY2Fs
bHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBhbiBMMSB0aGF0IGRpZG4ndApjb21w
bGV0ZSBkdWUgdG8gYW4gTDFURiwgaXQgd2lsbCBjYWxsIHB1dF9wYWdlX2Zy
b21fbDFlKCkgb24gInBhZ2UKZW50cmllcyIgdGhhdCBoYXZlIG5ldmVyIGJl
ZW4gdmFsaWRhdGVkLgoKRm9yIEwyKyB0YWJsZXMsIHNldHRpbmcgcmMgdG8g
RVJFU1RBUlQgY2F1c2VzIHRoZSByZXN0IG9mIHRoZQphbGxvY19sTl90YWJs
ZSgpIGZ1bmN0aW9uIHRvICp0aGluayogdGhhdCB0aGUgZW50cnkgaW4gcXVl
c3Rpb24gd2lsbApoYXZlIFBHVF9wYXJ0aWFsIHNldC4gIFRoaXMgd2lsbCBj
YXVzZSBpdCB0byBzZXQgcGFydGlhbF9wdGUgPSAxLiAgSWYKcmVsaW5xdXNo
X21lbW9yeSgpIHRoZW4gY2FsbHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBvbmUg
b2YgdGhvc2UgcGFnZXMsCnRoZW4gZnJlZV9sTl90YWJsZSgpIHdpbGwgY2Fs
bCBwdXRfcGFnZV9mcm9tX2xOZSgpIG9uIHRoZSBlbnRyeSB3aGVuCml0IHNo
b3VsZG4ndC4KClJhdGhlciB0aGFuIGluZGljYXRpbmcgLUVSRVNUQVJULCBp
bmRpY2F0ZSAtRUlOVFIuICBUaGlzIGlzIHRoZSBjb2RlCnRvIGluZGljYXRl
IHRoYXQgbm90aGluZyBoYXMgY2hhbmdlZCBmcm9tIHdoZW4geW91IHN0YXJ0
ZWQgdGhlIGNhbGwKKHdoaWNoIGlzIGVmZmVjdGl2ZWx5IGhvdyBhbGxvY19s
MV90YWJsZSgpIGhhbmRsZXMgZXJyb3JzKS4KCm1vZF9sTl9lbnRyeSgpIHNo
b3VsZG4ndCBoYXZlIGFueSBvZiB0aGVzZSB0eXBlcyBvZiBwcm9ibGVtcywg
c28gbGVhdmUKcG90ZW50aWFsIGNoYW5nZXMgdGhlcmUgZm9yIGEgY2xlYW4t
dXAgcGF0Y2ggbGF0ZXIuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJl
cG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5k
dW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDgg
KysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAzNTU3Y2QxMTc4Li5hMWI1NWMx
MGZmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTQwOSw3ICsxNDA5LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sMV90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
IHsKICAgICAgICAgaWYgKCAhKGwxZV9nZXRfZmxhZ3MocGwxZVtpXSkgJiBf
UEFHRV9QUkVTRU5UKSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHJldCA9
IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBsMWVbaV0pID8gLUVSRVNUQVJUIDog
MDsKKyAgICAgICAgICAgIHJldCA9IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBs
MWVbaV0pID8gLUVJTlRSIDogMDsKICAgICAgICAgICAgIGlmICggcmV0ICkK
ICAgICAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgfQpAQCAtMTUx
Nyw3ICsxNTE3LDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAg
ICAgIHsKICAgICAgICAgICAgIGlmICggIXB2X2wxdGZfY2hlY2tfbDJlKGQs
IGwyZSkgKQogICAgICAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICAg
ICAgcmMgPSAtRVJFU1RBUlQ7CisgICAgICAgICAgICByYyA9IC1FSU5UUjsK
ICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAgICAgICByYyA9IGdl
dF9wYWdlX2Zyb21fbDJlKGwyZSwgcGZuLCBkLCBwYXJ0aWFsKTsKQEAgLTE2
MDMsNyArMTYwMyw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgewogICAgICAgICAgICAg
aWYgKCAhcHZfbDF0Zl9jaGVja19sM2UoZCwgbDNlKSApCiAgICAgICAgICAg
ICAgICAgY29udGludWU7Ci0gICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsK
KyAgICAgICAgICAgIHJjID0gLUVJTlRSOwogICAgICAgICB9CiAgICAgICAg
IGVsc2UKICAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UobDNl
LCBwZm4sIGQsIHBhcnRpYWwpOwpAQCAtMTc4Myw3ICsxNzgzLDcgQEAgc3Rh
dGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogICAgICAgICB7CiAgICAgICAgICAgICBpZiAoICFwdl9sMXRmX2NoZWNr
X2w0ZShkLCBsNGUpICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKLSAg
ICAgICAgICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgcmMgPSAt
RUlOVFI7CiAgICAgICAgIH0KICAgICAgICAgZWxzZQogICAgICAgICAgICAg
cmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShsNGUsIHBmbiwgZCwgcGFydGlhbCk7
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Transfer-Encoding: base64

RnJvbSBiNDkwNzkyYzE4Zjc0Yjc2ZWM4MTYxNzIxYzFlMDdmODEwZTM2MzA5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAyLzExXSB4
ODYvbW06IERvbid0IHJlLXNldCBQR1RfcGlubmVkIG9uIGEgcGFydGlhbGx5
CiBkZS12YWxpZGF0ZWQgcGFnZQoKV2hlbiB1bnBpbm5pbmcgcGFnZXRhYmxl
cywgaWYgYW4gb3BlcmF0aW9uIGlzIGludGVycnVwdGVkLApyZWxpbnF1aXNo
X21lbW9yeSgpIHJlLXNldHMgUEdUX3Bpbm5lZCBzbyB0aGF0IHRoZSB1bi1w
aW4gd2lsbApwaWNrZWR1cCBhZ2FpbiB3aGVuIHRoZSBoeXBlcmNhbGwgcmVz
dGFydHMuCgpUaGlzIGlzIGFwcHJvcHJpYXRlIHdoZW4gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKSByZXR1cm5zCi1FSU5UUiwgd2hpY2ggaW5k
aWNhdGVzIHRoYXQgdGhlIHBhZ2UgaXMgYmFjayBpbiBpdHMgaW5pdGlhbCBz
dGF0ZQooaS5lLiwgY29tcGxldGVseSB2YWxpZGF0ZWQpLiAgSG93ZXZlciwg
Zm9yIC1FUkVTVEFSVCwgdGhpcyBsZWFkcyB0byBhCnN0YXRlIHdoZXJlIGEg
cGFnZSBoYXMgYm90aCBQR1RfcGlubmVkIGFuZCBQR1RfcGFydGlhbCBzZXQu
CgpUaGlzIGhhcHBlbnMgdG8gd29yayBhdCB0aGUgbW9tZW50LCBhbHRob3Vn
aCBpdCdzIG5vdCByZWFsbHkgYQoiY2Fub25pY2FsIiBzdGF0ZTsgYnV0IGlu
IHN1YnNlcXVlbnQgcGF0Y2hlcywgd2hlcmUgd2UgbmVlZCB0byBtYWtlIGEK
ZGlzdGluY3Rpb24gaW4gaGFuZGxpbmcgYmV0d2VlbiBQR1RfdmFsaWRhdGVk
IGFuZCBQR1RfcGFydGlhbCBwYWdlcywKdGhpcyBjYXVzZXMgaXNzdWVzLgoK
TW92ZSB0byBhICJjYW5vbmljYWwiIHN0YXRlIGJ5OgotIE9ubHkgcmUtc2V0
dGluZyBQR1RfcGlubmVkIG9uIC1FSU5UUgotIFJlLWRyb3BwaW5nIHRoZSBy
ZWZjb3VudCBoZWxkIGJ5IFBHVF9waW5uZWQgb24gLUVSRVNUQVJUCgpJbiB0
aGUgbGF0dGVyIGNhc2UsIHRoZSBQR1RfcGFydGlhbCBiaXQgd2lsbCBiZSBj
bGVhcmVkIGZ1cnRoZXIgZG93bgp3aXRoIHRoZSByZXN0IG9mIHRoZSBvdGhl
ciBQR1RfcGFydGlhbCBwYWdlcy4KCldoaWxlIGhlcmUsIGNsZWFuIHVwIHNv
bWUgdHJhaW5saW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVu
bGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tYWluLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggMjU4NTMyNzgzNC4uNTlkZjhh
NmQ4ZCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTE0LDcgKzExNCw3IEBAIHN0
YXRpYyB2b2lkIHBsYXlfZGVhZCh2b2lkKQogICAgICAqIHRoaXMgY2FzZSwg
aGVhcCBjb3JydXB0aW9uIG9yICNQRiBjYW4gb2NjdXIgKHdoZW4gaGVhcCBk
ZWJ1Z2dpbmcgaXMKICAgICAgKiBlbmFibGVkKS4gRm9yIGV4YW1wbGUsIGV2
ZW4gcHJpbnRrKCkgY2FuIGludm9sdmUgdGFza2xldCBzY2hlZHVsaW5nLAog
ICAgICAqIHdoaWNoIHRvdWNoZXMgcGVyLWNwdSB2YXJzLgotICAgICAqIAor
ICAgICAqCiAgICAgICogQ29uc2lkZXIgdmVyeSBjYXJlZnVsbHkgd2hlbiBh
ZGRpbmcgY29kZSB0byAqZGVhZF9pZGxlLiBNb3N0IGh5cGVydmlzb3IKICAg
ICAgKiBzdWJzeXN0ZW1zIGFyZSB1bnNhZmUgdG8gY2FsbC4KICAgICAgKi8K
QEAgLTE5MDksOSArMTkwOSwzNCBAQCBzdGF0aWMgaW50IHJlbGlucXVpc2hf
bWVtb3J5KAogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgLUVS
RVNUQVJUOgogICAgICAgICBjYXNlIC1FSU5UUjoKKyAgICAgICAgICAgIC8q
CisgICAgICAgICAgICAgKiAtRUlOVFIgbWVhbnMgUEdUX3ZhbGlkYXRlZCBo
YXMgYmVlbiByZS1zZXQ7IHJlLXNldAorICAgICAgICAgICAgICogUEdUX3Bp
bm5lZCBhZ2FpbiBzbyB0aGF0IGl0IGdldHMgcGlja2VkIHVwIG5leHQgdGlt
ZQorICAgICAgICAgICAgICogYXJvdW5kLgorICAgICAgICAgICAgICoKKyAg
ICAgICAgICAgICAqIC1FUkVTVEFSVCwgT1RPSCwgbWVhbnMgUEdUX3BhcnRp
YWwgaXMgc2V0IGluc3RlYWQuICBQdXQKKyAgICAgICAgICAgICAqIGl0IGJh
Y2sgb24gdGhlIGxpc3QsIGJ1dCBkb24ndCBzZXQgUEdUX3Bpbm5lZDsgdGhl
CisgICAgICAgICAgICAgKiBzZWN0aW9uIGJlbG93IHdpbGwgZmluaXNoIG9m
ZiBkZS12YWxpZGF0aW9uLiAgQnV0IHdlIGRvCisgICAgICAgICAgICAgKiBu
ZWVkIHRvIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGFzc29jaWF0ZWQgd2l0aAor
ICAgICAgICAgICAgICogUEdUX3Bpbm5lZCwgc2luY2UgcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKQorICAgICAgICAgICAgICogZGlkbid0IGRv
IGl0LgorICAgICAgICAgICAgICoKKyAgICAgICAgICAgICAqIE5CIHdlIGNh
biBkbyBhbiBBU1NFUlQgZm9yIFBHVF92YWxpZGF0ZWQsIHNpbmNlIHdlCisg
ICAgICAgICAgICAgKiAib3duIiB0aGUgdHlwZSByZWY7IGJ1dCB0aGVvcmV0
aWNhbGx5LCB0aGUgUEdUX3BhcnRpYWwKKyAgICAgICAgICAgICAqIGNvdWxk
IGJlIGNsZWFyZWQgYnkgc29tZW9uZSBlbHNlLgorICAgICAgICAgICAgICov
CisgICAgICAgICAgICBpZiAoIHJldCA9PSAtRUlOVFIgKQorICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIEFTU0VSVChwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmIFBHVF92YWxpZGF0ZWQpOworICAgICAgICAgICAgICAgIHNl
dF9iaXQoX1BHVF9waW5uZWQsICZwYWdlLT51LmludXNlLnR5cGVfaW5mbyk7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICBlbHNlCisgICAgICAgICAg
ICAgICAgcHV0X3BhZ2UocGFnZSk7CisKICAgICAgICAgICAgIHJldCA9IC1F
UkVTVEFSVDsKKworICAgICAgICAgICAgLyogUHV0IHRoZSBwYWdlIGJhY2sg
b24gdGhlIGxpc3QgYW5kIGRyb3AgdGhlIHJlZiB3ZSBncmFiYmVkIGFib3Zl
ICovCiAgICAgICAgICAgICBwYWdlX2xpc3RfYWRkKHBhZ2UsIGxpc3QpOwot
ICAgICAgICAgICAgc2V0X2JpdChfUEdUX3Bpbm5lZCwgJnBhZ2UtPnUuaW51
c2UudHlwZV9pbmZvKTsKICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwog
ICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIGRlZmF1bHQ6CkBAIC0y
MTYxLDcgKzIxODYsNyBAQCB2b2lkIHZjcHVfa2ljayhzdHJ1Y3QgdmNwdSAq
dikKICAgICAgKiBwZW5kaW5nIGZsYWcuIFRoZXNlIHZhbHVlcyBtYXkgZmx1
Y3R1YXRlIChhZnRlciBhbGwsIHdlIGhvbGQgbm8KICAgICAgKiBsb2Nrcykg
YnV0IHRoZSBrZXkgaW5zaWdodCBpcyB0aGF0IGVhY2ggY2hhbmdlIHdpbGwg
Y2F1c2UKICAgICAgKiBldnRjaG5fdXBjYWxsX3BlbmRpbmcgdG8gYmUgcG9s
bGVkLgotICAgICAqIAorICAgICAqCiAgICAgICogTkIyLiBXZSBzYXZlIHRo
ZSBydW5uaW5nIGZsYWcgYWNyb3NzIHRoZSB1bmJsb2NrIHRvIGF2b2lkIGEg
bmVlZGxlc3MKICAgICAgKiBJUEkgZm9yIGRvbWFpbnMgdGhhdCB3ZSBJUEkn
ZCB0byB1bmJsb2NrLgogICAgICAqLwotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Transfer-Encoding: base64

RnJvbSAwZjlmNjFlNTczN2ZkZDM0NjU1MGVjNmUzMDE2MWZhOTllNDY1M2Zh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAzLzExXSB4
ODYvbW06IFNlcGFyYXRlIG91dCBwYXJ0aWFsX3B0ZSB0cmlzdGF0ZSBpbnRv
CiBpbmRpdmlkdWFsIGZsYWdzCgpBdCB0aGUgbW9tZW50LCBwYXJ0aWFsX3B0
ZSBpcyBhIHRyaS1zdGF0ZSB0aGF0IGNvbnRhaW5zIHR3byBkaXN0aW5jdCBi
aXRzCm9mIGluZm9ybWF0aW9uOgoKMS4gSWYgemVybywgdGhlIHB0ZSBhdCBp
bmRleCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHVuLXZhbGlkYXRlZC4gIElm
CiAgIG5vbi16ZXJvLCB0aGUgcHRlIHdhcyBsYXN0IHNlZW4gd2l0aCBQR1Rf
cGFydGlhbCBzZXQuCgoyLiBJZiBwb3NpdGl2ZSwgdGhlIHB0ZSBhdCBpbmRl
eCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGRvZXMgbm90IGhvbGQgYQogICBnZW5l
cmFsIHJlZmVyZW5jZSBjb3VudC4gIElmIG5lZ2F0aXZlLCBpdCBkb2VzLgoK
VG8gbWFrZSBmdXR1cmUgcGF0Y2hlcyBtb3JlIGNsZWFyLCBzZXBhcmF0ZSBv
dXQgdGhpcyBmdW5jdGlvbmFsaXR5CmludG8gdHdvIGRpc3RpbmN0LCBuYW1l
ZCBiaXRzOiBQVEZfcGFydGlhbF9zZXQgKGZvciAjMSkgYW5kClBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIChmb3IgIzIpLgoKQWRkaXRpb25hbGx5LCBhIG51
bWJlciBvZiBmdW5jdGlvbnMgd2hpY2ggbmVlZCB0aGlzIGluZm9ybWF0aW9u
IGFsc28KdGFrZSBvdGhlciBmbGFncyB0byBjb250cm9sIGJlaGF2aW9yIChz
dWNoIGFzIGBwcmVlbXB0aWJsZWAgYW5kCmBkZWZlcmApLiAgVGhlc2UgYXJl
IGhhcmQgdG8gcmVhZCBpbiB0aGUgY2FsbGVyIChzaW5jZSB5b3Ugb25seSBz
ZWUKJ3RydWUnIG9yICdmYWxzZScpLCBhbmQgdWdseSB3aGVuIG1hbnkgYXJl
IGFkZGVkIHRvZ2V0aGVyLiAgSW4KcHJlcGFyYXRpb24gZm9yIGFkZGluZyB5
ZXQgYW5vdGhlciBmbGFnIGluIGEgZnV0dXJlIHBhdGNoLCBjb2xsYXBzZQph
bGwgb2YgdGhlc2UgaW50byBhIHNpbmdsZSBgZmxhZ2AgdmFyaWFibGUuCgpO
QiB0aGF0IHRoaXMgZG9lcyBtZWFuIGNoZWNraW5nIGZvciB3aGF0IHdhcyBw
cmV2aW91c2x5IHRoZSAnLTEnCmNvbmRpdGlvbiBhIGJpdCBtb3JlIHVnbHkg
aW4gdGhlIHB1dF9wYWdlX2Zyb21fbE5lIGZ1bmN0aW9ucyAoc2luY2UKeW91
IGhhdmUgdG8gY2hlY2sgZm9yIGJvdGggcGFydGlhbF9zZXQgYW5kIGdlbmVy
YWwgcmVmKTsgYnV0IHRoaXMKY2xhdXNlIHdpbGwgZ28gYXdheSBpbiBhIGZ1
dHVyZSBwYXRjaC4KCkFsc28gbm90ZSB0aGF0IHRoZSBvcmlnaW5hbCBjb21t
ZW50IGhhZCBhbiBvZmYtYnktb25lIGVycm9yOgpwYXJ0aWFsX2ZsYWdzIChs
aWtlIHBhcnRpYWxfcHRlIGJlZm9yZSBpdCkgY29uY2VybnMKcGxOZVtucl92
YWxpZGF0ZWRfcHRlc10sIG5vdCBwbE5lW25yX3ZhbGlkYXRlZF9wdGVzKzFd
LgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyAgICAgICAgfCAxNjUgKysrKysrKysrKysrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggfCAgNDEgKysrKysrKy0tLQogMiBmaWxlcyBjaGFuZ2VkLCAxMjggaW5z
ZXJ0aW9ucygrKSwgNzggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBhMWI1
NWMxMGZmLi4zZjZmOGNjOWI4IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTA5NCwyMCArMTA5
NCwzNSBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKIH0KIAogI2lmZGVmIENPTkZJ
R19QVgorCisvKgorICogVGhlIGZvbGxvd2luZyBmbGFncyBhcmUgdXNlZCB0
byBzcGVjaWZ5IGJlaGF2aW9yIG9mIHZhcmlvdXMgZ2V0IGFuZAorICogcHV0
IGNvbW1hbmRzLiAgVGhlIGZpcnN0IHR3byBhcmUgYWxzbyBzdG9yZWQgaW4g
cGFnZS0+cGFydGlhbF9mbGFncworICogdG8gaW5kaWNhdGUgdGhlIHN0YXRl
IG9mIHRoZSBwYWdlIHBvaW50ZWQgdG8gYnkKKyAqIHBhZ2UtPnB0ZVtwYWdl
LT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhlIGNvbW1lbnQgaW4g
bW0uaCBmb3IKKyAqIG1vcmUgaW5mb3JtYXRpb24uCisgKi8KKyNkZWZpbmUg
UFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwgMCkKKyNkZWZpbmUgUFRG
X3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkKKyNkZWZpbmUgUFRGX3By
ZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKKyNkZWZpbmUgUFRGX2RlZmVy
ICAgICAgICAgICAgICAgKDEgPDwgMykKKwogc3RhdGljIGludCBnZXRfcGFn
ZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICBtZm5fdCBtZm4sIHVuc2lnbmVk
IGxvbmcgdHlwZSwgc3RydWN0IGRvbWFpbiAqZCwKLSAgICBpbnQgcGFydGlh
bCwgaW50IHByZWVtcHRpYmxlKQorICAgIHVuc2lnbmVkIGludCBmbGFncykK
IHsKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3RvX3BhZ2Uo
bWZuKTsKICAgICBpbnQgcmM7CisgICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZs
YWdzICYgUFRGX3ByZWVtcHRpYmxlLAorICAgICAgICAgcGFydGlhbF9yZWYg
PSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogCi0gICAgaWYg
KCBsaWtlbHkocGFydGlhbCA+PSAwKSAmJgorICAgIGlmICggbGlrZWx5KCFw
YXJ0aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9m
cm9tX21mbihtZm4sIGQpKSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwog
CiAgICAgcmMgPSBfZ2V0X3BhZ2VfdHlwZShwYWdlLCB0eXBlLCBwcmVlbXB0
aWJsZSk7CiAKLSAgICBpZiAoIHVubGlrZWx5KHJjKSAmJiBwYXJ0aWFsID49
IDAgJiYKKyAgICBpZiAoIHVubGlrZWx5KHJjKSAmJiAhcGFydGlhbF9yZWYg
JiYKICAgICAgICAgICghcHJlZW1wdGlibGUgfHwgcGFnZSAhPSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkgKQogICAgICAgICBwdXRfcGFnZShw
YWdlKTsKIApAQCAtMTExNyw3ICsxMTMyLDcgQEAgc3RhdGljIGludCBnZXRf
cGFnZV9hbmRfdHlwZV9mcm9tX21mbigKIGRlZmluZV9nZXRfbGluZWFyX3Bh
Z2V0YWJsZShsMik7CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9tX2wyZSgK
LSAgICBsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3Ry
dWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisgICAgbDJfcGdlbnRyeV90
IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4gKmQsIHVu
c2lnbmVkIGludCBmbGFncykKIHsKICAgICB1bnNpZ25lZCBsb25nIG1mbiA9
IGwyZV9nZXRfcGZuKGwyZSk7CiAgICAgaW50IHJjOwpAQCAtMTEyOSw4ICsx
MTQ0LDkgQEAgZ2V0X3BhZ2VfZnJvbV9sMmUoCiAgICAgICAgIHJldHVybiAt
RUlOVkFMOwogICAgIH0KIAotICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVf
ZnJvbV9tZm4oX21mbihtZm4pLCBQR1RfbDFfcGFnZV90YWJsZSwgZCwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwsIGZh
bHNlKTsKKyAgICBBU1NFUlQoIShmbGFncyAmIFBURl9wcmVlbXB0aWJsZSkp
OworCisgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihfbWZu
KG1mbiksIFBHVF9sMV9wYWdlX3RhYmxlLCBkLCBmbGFncyk7CiAgICAgaWYg
KCB1bmxpa2VseShyYyA9PSAtRUlOVkFMKSAmJiBnZXRfbDJfbGluZWFyX3Bh
Z2V0YWJsZShsMmUsIHBmbiwgZCkgKQogICAgICAgICByYyA9IDA7CiAKQEAg
LTExNDAsNyArMTE1Niw3IEBAIGdldF9wYWdlX2Zyb21fbDJlKAogZGVmaW5l
X2dldF9saW5lYXJfcGFnZXRhYmxlKGwzKTsKIHN0YXRpYyBpbnQKIGdldF9w
YWdlX2Zyb21fbDNlKAotICAgIGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVk
IGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCBpbnQgcGFydGlhbCkKKyAg
ICBsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3RydWN0
IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGludCBy
YzsKIApAQCAtMTE1Miw3ICsxMTY4LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sM2Uo
CiAgICAgfQogCiAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21m
bigKLSAgICAgICAgbDNlX2dldF9tZm4obDNlKSwgUEdUX2wyX3BhZ2VfdGFi
bGUsIGQsIHBhcnRpYWwsIDEpOworICAgICAgICBsM2VfZ2V0X21mbihsM2Up
LCBQR1RfbDJfcGFnZV90YWJsZSwgZCwgZmxhZ3MgfCBQVEZfcHJlZW1wdGli
bGUpOwogICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkgJiYKICAg
ICAgICAgICFpc19wdl8zMmJpdF9kb21haW4oZCkgJiYKICAgICAgICAgIGdl
dF9sM19saW5lYXJfcGFnZXRhYmxlKGwzZSwgcGZuLCBkKSApCkBAIC0xMTY0
LDcgKzExODAsNyBAQCBnZXRfcGFnZV9mcm9tX2wzZSgKIGRlZmluZV9nZXRf
bGluZWFyX3BhZ2V0YWJsZShsNCk7CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9m
cm9tX2w0ZSgKLSAgICBsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25n
IHBmbiwgc3RydWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisgICAgbDRf
cGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21h
aW4gKmQsIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBpbnQgcmM7CiAK
QEAgLTExNzYsNyArMTE5Miw3IEBAIGdldF9wYWdlX2Zyb21fbDRlKAogICAg
IH0KIAogICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCi0g
ICAgICAgIGw0ZV9nZXRfbWZuKGw0ZSksIFBHVF9sM19wYWdlX3RhYmxlLCBk
LCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgbDRlX2dldF9tZm4obDRlKSwgUEdU
X2wzX3BhZ2VfdGFibGUsIGQsIGZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlKTsK
ICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYmIGdldF9sNF9s
aW5lYXJfcGFnZXRhYmxlKGw0ZSwgcGZuLCBkKSApCiAgICAgICAgIHJjID0g
MDsKIApAQCAtMTI3Nyw3ICsxMjkzLDcgQEAgc3RhdGljIHZvaWQgcHV0X2Rh
dGFfcGFnZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCBib29sIHdyaXRlYWJs
ZSkKICAqIE5vdGUgYWxzbyB0aGF0IHRoaXMgYXV0b21hdGljYWxseSBkZWFs
cyBjb3JyZWN0bHkgd2l0aCBsaW5lYXIgcC50LidzLgogICovCiBzdGF0aWMg
aW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2ln
bmVkIGxvbmcgcGZuLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgcGFydGlhbCwgYm9vbCBkZWZlcikKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGludCByYyA9
IDA7CiAKQEAgLTEzMDAsMTIgKzEzMTYsMTMgQEAgc3RhdGljIGludCBwdXRf
cGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25n
IHBmbiwKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBsMmVfZ2V0
X3BhZ2UobDJlKTsKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZyA9
IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CiAKLSAgICAgICAgaWYgKCB1bmxp
a2VseShwYXJ0aWFsID4gMCkgKQorICAgICAgICBpZiAoIChmbGFncyAmIChQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09
CisgICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIEFTU0VSVCghZGVmZXIpOworICAgICAgICAgICAgQVNT
RVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKICAgICAgICAgICAgIHJjID0g
X3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIHB0cGcpOwogICAgICAgICB9Ci0g
ICAgICAgIGVsc2UgaWYgKCBkZWZlciApCisgICAgICAgIGVsc2UgaWYgKCBm
bGFncyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKICAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBwdHBnOwogICAgICAgICAg
ICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKQEAgLTEz
MjIsNyArMTMzOSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUo
bDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiB9CiAKIHN0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwg
dW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAgc3Ry
dWN0IHBhZ2VfaW5mbyAqcGc7CiAgICAgaW50IHJjOwpAQCAtMTM0NSwxMyAr
MTM2MiwxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3Bn
ZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgcGcgPSBs
M2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggdW5saWtlbHkocGFydGlh
bCA+IDApICkKKyAgICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQg
fCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CisgICAgICAgICBQVEZf
cGFydGlhbF9zZXQgKQogICAgIHsKLSAgICAgICAgQVNTRVJUKCFkZWZlcik7
CisgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAg
ICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZuX3RvX3Bh
Z2UoX21mbihwZm4pKSk7CiAgICAgfQogCi0gICAgaWYgKCBkZWZlciApCisg
ICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgewogICAgICAgICBj
dXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21m
bihwZm4pKTsKICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgPSBwZzsKQEAgLTEzNjYsNyArMTM4NCw3IEBAIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCiB9CiAKIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRf
cGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxh
Z3MpCiB7CiAgICAgaW50IHJjID0gMTsKIApAQCAtMTM3NSwxMyArMTM5Mywx
NCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlf
dCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgIHsKICAgICAgICAgc3Ry
dWN0IHBhZ2VfaW5mbyAqcGcgPSBsNGVfZ2V0X3BhZ2UobDRlKTsKIAotICAg
ICAgICBpZiAoIHVubGlrZWx5KHBhcnRpYWwgPiAwKSApCisgICAgICAgIGlm
ICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmKSkgPT0KKyAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0
ICkKICAgICAgICAgewotICAgICAgICAgICAgQVNTRVJUKCFkZWZlcik7Cisg
ICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwogICAg
ICAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBtZm5f
dG9fcGFnZShfbWZuKHBmbikpKTsKICAgICAgICAgfQogCi0gICAgICAgIGlm
ICggZGVmZXIgKQorICAgICAgICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkK
ICAgICAgICAgewogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vl
c3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBnOwpAQCAtMTQ5
MiwxMiArMTUxMSwxMyBAQCBzdGF0aWMgaW50IGFsbG9jX2wyX3RhYmxlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSkKICAg
ICB1bnNpZ25lZCBsb25nICBwZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdl
KSk7CiAgICAgbDJfcGdlbnRyeV90ICAqcGwyZTsKICAgICB1bnNpZ25lZCBp
bnQgICBpOwotICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlhbCA9
IHBhZ2UtPnBhcnRpYWxfcHRlOworICAgIGludCAgICAgICAgICAgIHJjID0g
MDsKKyAgICB1bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+
cGFydGlhbF9mbGFnczsKIAogICAgIHBsMmUgPSBtYXBfZG9tYWluX3BhZ2Uo
X21mbihwZm4pKTsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlczsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAg
IGkrKywgcGFydGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9m
bGFncyA9IDAgKQogICAgIHsKICAgICAgICAgbDJfcGdlbnRyeV90IGwyZTsK
IApAQCAtMTUyMCwxNyArMTU0MCwxOCBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgICAgIHJjID0gLUVJTlRSOwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UKLSAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9s
MmUobDJlLCBwZm4sIGQsIHBhcnRpYWwpOworICAgICAgICAgICAgcmMgPSBn
ZXRfcGFnZV9mcm9tX2wyZShsMmUsIHBmbiwgZCwgcGFydGlhbF9mbGFncyk7
CiAKICAgICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgICAgICB7
CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0g
ICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzogMTsK
KyAgICAgICAgICAgIC8qIFNldCAnc2V0JywgcmV0YWluICdnZW5lcmFsIHJl
ZicgKi8KKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0
aWFsX2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAg
ICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAg
ICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAg
IHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICAgICAgcmMgPSAt
RVJFU1RBUlQ7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjIDwg
MCAmJiByYyAhPSAtRUlOVFIgKQpAQCAtMTUzOSw3ICsxNTYwLDcgQEAgc3Rh
dGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
LCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAgICAgICAgICBpZiAoIGkgKQog
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFs
X3B0ZSA9IDA7CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IDA7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vl
c3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICAgICAgfQpAQCAt
MTU2Myw3ICsxNTg0LDggQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHVuc2lnbmVkIGxvbmcgIHBm
biA9IG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKTsKICAgICBsM19wZ2VudHJ5
X3QgICpwbDNlOwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAg
ICAgICAgICAgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7
CisgICAgaW50ICAgICAgICAgICAgcmMgPSAwOworICAgIHVuc2lnbmVkIGlu
dCAgIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCiAg
ICAgcGwzZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCkBAIC0x
NTc4LDcgKzE2MDAsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgIG1lbXNldChwbDNlICsg
NCwgMCwgKEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gNCkgKiBzaXplb2YoKnBs
M2UpKTsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
czsgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywg
cGFydGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9
IDAgKQogICAgIHsKICAgICAgICAgbDNfcGdlbnRyeV90IGwzZSA9IHBsM2Vb
aV07CiAKQEAgLTE1OTcsNyArMTYxOSw4IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAg
IGVsc2UKICAgICAgICAgICAgICAgICByYyA9IGdldF9wYWdlX2FuZF90eXBl
X2Zyb21fbWZuKAogICAgICAgICAgICAgICAgICAgICBsM2VfZ2V0X21mbihs
M2UpLAotICAgICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90YWJsZSB8
IFBHVF9wYWVfeGVuX2wyLCBkLCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgICAg
ICAgICAgICAgUEdUX2wyX3BhZ2VfdGFibGUgfCBQR1RfcGFlX3hlbl9sMiwg
ZCwKKyAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8IFBURl9w
cmVlbXB0aWJsZSk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoICEo
bDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAg
ICB7CkBAIC0xNjA2LDE3ICsxNjI5LDE4IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAg
IHJjID0gLUVJTlRSOwogICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAg
ICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UobDNlLCBwZm4sIGQsIHBh
cnRpYWwpOworICAgICAgICAgICAgcmMgPSBnZXRfcGFnZV9mcm9tX2wzZShs
M2UsIHBmbiwgZCwgcGFydGlhbF9mbGFncyk7CiAKICAgICAgICAgaWYgKCBy
YyA9PSAtRVJFU1RBUlQgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdl
LT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBwYWdlLT5w
YXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzogMTsKKyAgICAgICAgICAgIC8qIFNl
dCAnc2V0JywgbGVhdmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRy
eSB3YXMgc2V0ICovCisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gcGFydGlhbF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAg
fQogICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAg
ICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAg
IHJjID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlmICggcmMg
PCAwICkKQEAgLTE2MzMsNyArMTY1Nyw3IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgaWYg
KCBpICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUg
PSAwOworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVM
TDsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxl
ID0gcGFnZTsKICAgICAgICAgfQpAQCAtMTc2NywxMCArMTc5MSwxMSBAQCBz
dGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgdW5zaWduZWQgbG9uZyAgcGZuID0gbWZuX3gocGFnZV90b19t
Zm4ocGFnZSkpOwogICAgIGw0X3BnZW50cnlfdCAgKnBsNGUgPSBtYXBfZG9t
YWluX3BhZ2UoX21mbihwZm4pKTsKICAgICB1bnNpZ25lZCBpbnQgICBpOwot
ICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlhbCA9IHBhZ2UtPnBh
cnRpYWxfcHRlOworICAgIGludCAgICAgICAgICAgIHJjID0gMDsKKyAgICB1
bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+cGFydGlhbF9m
bGFnczsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
czsgaSA8IEw0X1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywg
cGFydGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9
IDAgKQogICAgIHsKICAgICAgICAgbDRfcGdlbnRyeV90IGw0ZTsKIApAQCAt
MTc4NiwxMiArMTgxMSwxMyBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxl
KHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICByYyA9IC1F
SU5UUjsKICAgICAgICAgfQogICAgICAgICBlbHNlCi0gICAgICAgICAgICBy
YyA9IGdldF9wYWdlX2Zyb21fbDRlKGw0ZSwgcGZuLCBkLCBwYXJ0aWFsKTsK
KyAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sNGUobDRlLCBwZm4s
IGQsIHBhcnRpYWxfZmxhZ3MpOwogCiAgICAgICAgIGlmICggcmMgPT0gLUVS
RVNUQVJUICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSBwYXJ0aWFsID86IDE7CisgICAgICAgICAgICAvKiBTZXQgJ3NldCcs
IGxlYXZlICdnZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNl
dCAqLworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRp
YWxfZmxhZ3MgfCBQVEZfcGFydGlhbF9zZXQ7CiAgICAgICAgIH0KICAgICAg
ICAgZWxzZSBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsKQEAgLTE4MDEsNyAr
MTgyNyw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgIGlmICggaSApCiAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0
ZXMgPSBpOwotICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
MDsKKyAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsK
ICAgICAgICAgICAgICAgICBpZiAoIHJjID09IC1FSU5UUiApCiAgICAgICAg
ICAgICAgICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICAgICAgICAg
IGVsc2UKQEAgLTE4NTMsMTkgKzE4NzksMjAgQEAgc3RhdGljIGludCBmcmVl
X2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgc3RydWN0
IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogICAgIHVuc2ln
bmVkIGxvbmcgcGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwogICAg
IGwyX3BnZW50cnlfdCAqcGwyZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFs
ID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50IGkgPSBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFsOworICAgIGludCBy
YyA9IDA7CisgICAgdW5zaWduZWQgaW50IHBhcnRpYWxfZmxhZ3MgPSBwYWdl
LT5wYXJ0aWFsX2ZsYWdzLAorICAgICAgICBpID0gcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgLSAhKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQp
OwogCiAgICAgcGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwog
CiAgICAgZm9yICggOyA7ICkKICAgICB7CiAgICAgICAgIGlmICggaXNfZ3Vl
c3RfbDJfc2xvdChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkgKQot
ICAgICAgICAgICAgcmMgPSBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBw
Zm4sIHBhcnRpYWwsIGZhbHNlKTsKKyAgICAgICAgICAgIHJjID0gcHV0X3Bh
Z2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAg
ICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAg
ICAgICAgcGFydGlhbCA9IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAw
OwogCiAgICAgICAgIGlmICggIWktLSApCiAgICAgICAgICAgICBicmVhazsK
QEAgLTE4ODcsMTIgKzE5MTQsMTQgQEAgc3RhdGljIGludCBmcmVlX2wyX3Rh
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgZWxzZSBpZiAoIHJj
ID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
cGFydGlhbCA/OiAtMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/CisgICAgICAg
ICAgICBwYXJ0aWFsX2ZsYWdzIDoKKyAgICAgICAgICAgIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CiAgICAgfQogICAg
IGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJMRV9F
TlRSSUVTIC0gMSApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGkgKyAxOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IDA7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAg
ICByYyA9IC1FUkVTVEFSVDsKICAgICB9CiAKQEAgLTE5MDQsMTggKzE5MzMs
MTkgQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UpCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293
bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcgcGZuID0gbWZuX3gocGFn
ZV90b19tZm4ocGFnZSkpOwogICAgIGwzX3BnZW50cnlfdCAqcGwzZTsKLSAg
ICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0g
ICAgdW5zaWduZWQgaW50ICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
LSAhcGFydGlhbDsKKyAgICBpbnQgcmMgPSAwOworICAgIHVuc2lnbmVkIGlu
dCBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+cGFydGlhbF9mbGFncywKKyAgICAg
ICAgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzIC0gIShwYXJ0aWFsX2Zs
YWdzICYgUFRGX3BhcnRpYWxfc2V0KTsKIAogICAgIHBsM2UgPSBtYXBfZG9t
YWluX3BhZ2UoX21mbihwZm4pKTsKIAogICAgIGZvciAoIDsgOyApCiAgICAg
ewotICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0sIHBm
biwgcGFydGlhbCwgMCk7CisgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9s
M2UocGwzZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAgaWYg
KCByYyA8IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgcGFy
dGlhbCA9IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAg
ICBpZiAoIHJjID09IDAgKQogICAgICAgICAgICAgcGwzZVtpXSA9IHVuYWRq
dXN0X2d1ZXN0X2wzZShwbDNlW2ldLCBkKTsKIApAQCAtMTkzNCwxMiArMTk2
NCwxNCBAQCBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAg
ewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAtMTsKKyAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRG
X3BhcnRpYWxfc2V0KSA/CisgICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoK
KyAgICAgICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9n
ZW5lcmFsX3JlZik7CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9PSAtRUlO
VFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAgICAgewog
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGkgKyAxOwotICAg
ICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgIHBhZ2UtPnBh
cnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAg
ICB9CiAgICAgcmV0dXJuIHJjID4gMCA/IDAgOiByYzsKQEAgLTE5NTAsMjYg
KzE5ODIsMjkgQEAgc3RhdGljIGludCBmcmVlX2w0X3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2Vf
Z2V0X293bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcgcGZuID0gbWZu
X3gocGFnZV90b19tZm4ocGFnZSkpOwogICAgIGw0X3BnZW50cnlfdCAqcGw0
ZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwotICAgIGludCByYyA9
IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKLSAgICB1bnNpZ25l
ZCBpbnQgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFs
OworICAgIGludCByYyA9IDA7CisgICAgdW5zaWduZWQgcGFydGlhbF9mbGFn
cyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3MsCisgICAgICAgIGkgPSBwYWdlLT5u
cl92YWxpZGF0ZWRfcHRlcyAtICEocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0
aWFsX3NldCk7CiAKICAgICBkbyB7CiAgICAgICAgIGlmICggaXNfZ3Vlc3Rf
bDRfc2xvdChkLCBpKSApCi0gICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zy
b21fbDRlKHBsNGVbaV0sIHBmbiwgcGFydGlhbCwgMCk7CisgICAgICAgICAg
ICByYyA9IHB1dF9wYWdlX2Zyb21fbDRlKHBsNGVbaV0sIHBmbiwgcGFydGlh
bF9mbGFncyk7CiAgICAgICAgIGlmICggcmMgPCAwICkKICAgICAgICAgICAg
IGJyZWFrOwotICAgICAgICBwYXJ0aWFsID0gMDsKKyAgICAgICAgcGFydGlh
bF9mbGFncyA9IDA7CiAgICAgfSB3aGlsZSAoIGktLSApOwogCiAgICAgaWYg
KCByYyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJf
dmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0
ZSA9IHBhcnRpYWwgPzogLTE7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxh
Z3MgPSAocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgPworICAg
ICAgICAgICAgcGFydGlhbF9mbGFncyA6CisgICAgICAgICAgICAoUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpOwogICAgIH0K
ICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMNF9QQUdFVEFC
TEVfRU5UUklFUyAtIDEgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpICsgMTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSAwOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAg
ICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgfQogCkBAIC0yMjQ3LDcgKzIy
ODIsNyBAQCBzdGF0aWMgaW50IG1vZF9sMl9lbnRyeShsMl9wZ2VudHJ5X3Qg
KnBsMmUsCiAgICAgICAgIHJldHVybiAtRUJVU1k7CiAgICAgfQogCi0gICAg
cHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgcGZuLCAwLCB0cnVlKTsKKyAgICBw
dXRfcGFnZV9mcm9tX2wyZShvbDJlLCBwZm4sIFBURl9kZWZlcik7CiAKICAg
ICByZXR1cm4gcmM7CiB9CkBAIC0yMzE1LDcgKzIzNTAsNyBAQCBzdGF0aWMg
aW50IG1vZF9sM19lbnRyeShsM19wZ2VudHJ5X3QgKnBsM2UsCiAgICAgICAg
IGlmICggIWNyZWF0ZV9wYWVfeGVuX21hcHBpbmdzKGQsIHBsM2UpICkKICAg
ICAgICAgICAgIEJVRygpOwogCi0gICAgcHV0X3BhZ2VfZnJvbV9sM2Uob2wz
ZSwgcGZuLCAwLCAxKTsKKyAgICBwdXRfcGFnZV9mcm9tX2wzZShvbDNlLCBw
Zm4sIFBURl9kZWZlcik7CiAgICAgcmV0dXJuIHJjOwogfQogCkBAIC0yMzc4
LDcgKzI0MTMsNyBAQCBzdGF0aWMgaW50IG1vZF9sNF9lbnRyeShsNF9wZ2Vu
dHJ5X3QgKnBsNGUsCiAgICAgICAgIHJldHVybiAtRUZBVUxUOwogICAgIH0K
IAotICAgIHB1dF9wYWdlX2Zyb21fbDRlKG9sNGUsIHBmbiwgMCwgMSk7Cisg
ICAgcHV0X3BhZ2VfZnJvbV9sNGUob2w0ZSwgcGZuLCBQVEZfZGVmZXIpOwog
ICAgIHJldHVybiByYzsKIH0KICNlbmRpZiAvKiBDT05GSUdfUFYgKi8KQEAg
LTI2NDksNyArMjY4NCw3IEBAIGludCBmcmVlX3BhZ2VfdHlwZShzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgaWYg
KCAhKHR5cGUgJiBQR1RfcGFydGlhbCkgKQogICAgIHsKICAgICAgICAgcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSAxVSA8PCBQQUdFVEFCTEVfT1JERVI7
Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFn
ZS0+cGFydGlhbF9mbGFncyA9IDA7CiAgICAgfQogCiAgICAgc3dpdGNoICgg
dHlwZSAmIFBHVF90eXBlX21hc2sgKQpAQCAtMjk0Niw3ICsyOTgxLDcgQEAg
c3RhdGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgICAgIGlmICggISh4ICYg
UEdUX3BhcnRpYWwpICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMgPSAwOwotICAgICAgICAgICAgcGFnZS0+cGFy
dGlhbF9wdGUgPSAwOworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IDA7CiAgICAgICAgIH0KICAgICAgICAgcGFnZS0+bGluZWFyX3B0X2Nv
dW50ID0gMDsKICAgICAgICAgcmMgPSBhbGxvY19wYWdlX3R5cGUocGFnZSwg
dHlwZSwgcHJlZW1wdGlibGUpOwpAQCAtMzEyMiw3ICszMTU3LDcgQEAgaW50
IG5ld19ndWVzdF9jcjMobWZuX3QgbWZuKQogICAgICAgICByZXR1cm4gMDsK
ICAgICB9CiAKLSAgICByYyA9IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZu
KG1mbiwgUEdUX3Jvb3RfcGFnZV90YWJsZSwgZCwgMCwgMSk7CisgICAgcmMg
PSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihtZm4sIFBHVF9yb290X3Bh
Z2VfdGFibGUsIGQsIFBURl9wcmVlbXB0aWJsZSk7CiAgICAgc3dpdGNoICgg
cmMgKQogICAgIHsKICAgICBjYXNlIDA6CkBAIC0zNDczLDcgKzM1MDgsNyBA
QCBsb25nIGRvX21tdWV4dF9vcCgKICAgICAgICAgICAgIGlmICggb3AuYXJn
MS5tZm4gIT0gMCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAg
cmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKLSAgICAgICAgICAg
ICAgICAgICAgX21mbihvcC5hcmcxLm1mbiksIFBHVF9yb290X3BhZ2VfdGFi
bGUsIGN1cnJkLCAwLCAxKTsKKyAgICAgICAgICAgICAgICAgICAgX21mbihv
cC5hcmcxLm1mbiksIFBHVF9yb290X3BhZ2VfdGFibGUsIGN1cnJkLCBQVEZf
cHJlZW1wdGlibGUpOwogCiAgICAgICAgICAgICAgICAgaWYgKCB1bmxpa2Vs
eShyYykgKQogICAgICAgICAgICAgICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0u
aAppbmRleCA2ZmFhNTYzMTY3Li44NDA2YWMzYzM3IDEwMDY0NAotLS0gYS94
ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKKysrIGIveGVuL2luY2x1ZGUvYXNt
LXg4Ni9tbS5oCkBAIC0yMjgsMTkgKzIyOCwzNCBAQCBzdHJ1Y3QgcGFnZV9p
bmZvCiAgICAgICAgICAqIHNldHRpbmcgdGhlIGZsYWcgbXVzdCBub3QgZHJv
cCB0aGF0IHJlZmVyZW5jZSwgd2hlcmVhcyB0aGUgaW5zdGFuY2UKICAgICAg
ICAgICogY2xlYXJpbmcgaXQgd2lsbCBoYXZlIHRvLgogICAgICAgICAgKgot
ICAgICAgICAgKiBJZiBAcGFydGlhbF9wdGUgaXMgcG9zaXRpdmUgdGhlbiBQ
VEUgYXQgQG5yX3ZhbGlkYXRlZF9wdGVzKzEgaGFzCi0gICAgICAgICAqIGJl
ZW4gcGFydGlhbGx5IHZhbGlkYXRlZC4gVGhpcyBpbXBsaWVzIHRoYXQgdGhl
IGdlbmVyYWwgcmVmZXJlbmNlCi0gICAgICAgICAqIHRvIHRoZSBwYWdlIChh
Y3F1aXJlZCBmcm9tIGdldF9wYWdlX2Zyb21fbE5lKCkpIHdvdWxkIGJlIGRy
b3BwZWQKLSAgICAgICAgICogKGFnYWluIGR1ZSB0byB0aGUgYXBwYXJlbnQg
ZmFpbHVyZSkgYW5kIGhlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQKLSAgICAg
ICAgICogd2hlbiByZXN1bWluZyB0aGUgdmFsaWRhdGlvbiwgYnV0IG11c3Qg
bm90IGJlIGRyb3BwZWQgd2hlbiBwaWNraW5nCi0gICAgICAgICAqIHVwIHRo
ZSBwYWdlIGZvciBpbnZhbGlkYXRpb24uCisgICAgICAgICAqIElmIHBhcnRp
YWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIHRoZSBw
YWdlIGF0CisgICAgICAgICAqIGF0IEBucl92YWxpZGF0ZWRfcHRlcyBoYWQg
UEdUX3BhcnRpYWwgc2V0IGFzIGEgcmVzdWx0IG9mIGFuCisgICAgICAgICAq
IG9wZXJhdGlvbiBvbiB0aGUgY3VycmVudCBwYWdlLiAgKFRoYXQgcGFnZSBt
YXkgb3IgbWF5IG5vdAorICAgICAgICAgKiBzdGlsbCBoYXZlIFBHVF9wYXJ0
aWFsIHNldC4pCiAgICAgICAgICAqCi0gICAgICAgICAqIElmIEBwYXJ0aWFs
X3B0ZSBpcyBuZWdhdGl2ZSB0aGVuIFBURSBhdCBAbnJfdmFsaWRhdGVkX3B0
ZXMrMSBoYXMKLSAgICAgICAgICogYmVlbiBwYXJ0aWFsbHkgaW52YWxpZGF0
ZWQuIFRoaXMgaXMgYmFzaWNhbGx5IHRoZSBvcHBvc2l0ZSBjYXNlIG9mCi0g
ICAgICAgICAqIGFib3ZlLCBpLmUuIHRoZSBnZW5lcmFsIHJlZmVyZW5jZSB0
byB0aGUgcGFnZSB3YXMgbm90IGRyb3BwZWQgaW4KLSAgICAgICAgICogcHV0
X3BhZ2VfZnJvbV9sTmUoKSAoZHVlIHRvIHRoZSBhcHBhcmVudCBmYWlsdXJl
KSwgYW5kIGhlbmNlIGl0Ci0gICAgICAgICAqIG11c3QgYmUgZHJvcHBlZCB3
aGVuIHRoZSBwdXQgb3BlcmF0aW9uIGlzIHJlc3VtZWQgKGFuZCBjb21wbGV0
ZXMpLAotICAgICAgICAgKiBidXQgaXQgbXVzdCBub3QgYmUgYWNxdWlyZWQg
aWYgcGlja2luZyB1cCB0aGUgcGFnZSBmb3IgdmFsaWRhdGlvbi4KKyAgICAg
ICAgICogSWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0LCB0aGVu
IHRoZSBQVEUgYXQKKyAgICAgICAgICogQG5yX3ZhbGlkYXRlZF9wdGVmIGhv
bGRzIGEgZ2VuZXJhbCByZWZlcmVuY2UgY291bnQgZm9yIHRoZQorICAgICAg
ICAgKiBwYWdlLgorICAgICAgICAgKgorICAgICAgICAgKiBUaGlzIGhhcHBl
bnM6CisgICAgICAgICAqIC0gRHVyaW5nIGRlLXZhbGlkYXRpb24sIGlmIGRl
LXZhbGlkYXRpb24gb2YgdGhlIHBhZ2Ugd2FzCisgICAgICAgICAqICAgaW50
ZXJydXB0ZWQKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiwgaWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBlbmNvdW50ZXJlZCBhbmQKKyAgICAgICAg
ICogICB2YWxpZGF0aW9uIGlzIHByZWVtcHRpYmxlCisgICAgICAgICAqIC0g
RHVyaW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
IHdhcyBzZXQgb24KKyAgICAgICAgICogICB0aGlzIGVudHJ5IHRvIGJlZ2lu
IHdpdGggKHBlcmhhcHMgYmVjYXVzZSB3ZSdyZSBwaWNraW5nCisgICAgICAg
ICAqICAgdXAgZnJvbSBhIHBhcnRpYWwgZGUtdmFsaWRhdGlvbikuCisgICAg
ICAgICAqCisgICAgICAgICAqIFdoZW4gcmVzdW1pbmcgdmFsaWRhdGlvbiwg
aWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgY2xlYXIsCisgICAgICAg
ICAqIHRoZW4gYSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVp
cmVkOyBpZiBpdCBpcyBzZXQsIG5vCisgICAgICAgICAqIHJlZmVyZW5jZSBz
aG91bGQgYmUgYWNxdWlyZWQuCisgICAgICAgICAqCisgICAgICAgICAqIFdo
ZW4gcmVzdW1pbmcgZGUtdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2Vu
ZXJhbF9yZWYgaXMKKyAgICAgICAgICogY2xlYXIsIG5vIHJlZmVyZW5jZSBz
aG91bGQgYmUgZHJvcHBlZDsgaWYgaXQgaXMgc2V0LCBhCisgICAgICAgICAq
IHJlZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZC4KKyAgICAgICAgICoKKyAg
ICAgICAgICogTkIgdGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGFyZQorICAgICAgICAgKiBkZWZpbmVkIGluIG1t
LmMsIHRoZSBvbmx5IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQuCiAgICAg
ICAgICAqCiAgICAgICAgICAqIFRoZSAzcmQgZmllbGQsIEBsaW5lYXJfcHRf
Y291bnQsIGluZGljYXRlcwogICAgICAgICAgKiAtIGJ5IGEgcG9zaXRpdmUg
dmFsdWUsIGhvdyBtYW55IHNhbWUtbGV2ZWwgcGFnZSB0YWJsZSBlbnRyaWVz
IGEgcGFnZQpAQCAtMjUxLDcgKzI2Niw3IEBAIHN0cnVjdCBwYWdlX2luZm8K
ICAgICAgICAgc3RydWN0IHsKICAgICAgICAgICAgIHUxNiBucl92YWxpZGF0
ZWRfcHRlczpQQUdFVEFCTEVfT1JERVIgKyAxOwogICAgICAgICAgICAgdTE2
IDoxNiAtIFBBR0VUQUJMRV9PUkRFUiAtIDEgLSAyOwotICAgICAgICAgICAg
czE2IHBhcnRpYWxfcHRlOjI7CisgICAgICAgICAgICB1MTYgcGFydGlhbF9m
bGFnczoyOwogICAgICAgICAgICAgczE2IGxpbmVhcl9wdF9jb3VudDsKICAg
ICAgICAgfTsKIAotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Transfer-Encoding: base64

RnJvbSBkYjFkODAxYWE4ZGNiOTE4YTI3NDg2YTZlOGQ5Y2Y1ZDczMDdkZWMz
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA0LzExXSB4
ODYvbW06IFVzZSBmbGFncyBmb3IgX3B1dF9wYWdlX3R5cGUgcmF0aGVyIHRo
YW4gYQogYm9vbGVhbgoKVGhpcyBpcyBpbiBtYWlubHkgaW4gcHJlcGFyYXRp
b24gZm9yIF9wdXRfcGFnZV90eXBlIHRha2luZyB0aGUKcGFydGlhbF9mbGFn
cyB2YWx1ZSBpbiB0aGUgZnV0dXJlLiAgSXQgYWxzbyBtYWtlcyBpdCBlYXNp
ZXIgdG8gcmVhZCBpbgp0aGUgY2FsbGVyIChzaW5jZSB5b3Ugc2VlIGEgZmxh
ZyBuYW1lIHJhdGhlciB0aGFuIGB0cnVlYCBvciBgZmFsc2VgKS4KCk5vIGZ1
bmN0aW9uYWwgY2hhbmdlIGludGVuZGVkLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0yOTkuCgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2
L21tLmMgfCAyNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tCiAxIGZpbGUg
Y2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCAzZjZmOGNjOWI4Li4wNzQwYjYxYWY4IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTIwMCw3ICsxMjAwLDcgQEAgZ2V0X3BhZ2VfZnJvbV9sNGUoCiB9CiAj
ZW5kaWYgLyogQ09ORklHX1BWICovCiAKLXN0YXRpYyBpbnQgX3B1dF9wYWdl
X3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgYm9vbCBwcmVlbXB0aWJs
ZSwKK3N0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwdHBnKTsKIAogdm9pZCBw
dXRfcGFnZV9mcm9tX2wxZShsMV9wZ2VudHJ5X3QgbDFlLCBzdHJ1Y3QgZG9t
YWluICpsMWVfb3duZXIpCkBAIC0xMzIwLDcgKzEzMjAsNyBAQCBzdGF0aWMg
aW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2ln
bmVkIGxvbmcgcGZuLAogICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQg
KQogICAgICAgICB7CiAgICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBU
Rl9kZWZlcikpOwotICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShw
ZywgdHJ1ZSwgcHRwZyk7CisgICAgICAgICAgICByYyA9IF9wdXRfcGFnZV90
eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgICAg
IHsKQEAgLTEzMjksNyArMTMyOSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2Vf
ZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4s
CiAgICAgICAgIH0KICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAg
ICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKKyAg
ICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0
aWJsZSwgcHRwZyk7CiAgICAgICAgICAgICBpZiAoIGxpa2VseSghcmMpICkK
ICAgICAgICAgICAgICAgICBwdXRfcGFnZShwZyk7CiAgICAgICAgIH0KQEAg
LTEzNjYsNyArMTM2Niw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9s
M2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAg
ICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgIHsKICAgICAgICAgQVNTRVJU
KCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKLSAgICAgICAgcmV0dXJuIF9wdXRf
cGFnZV90eXBlKHBnLCB0cnVlLCBtZm5fdG9fcGFnZShfbWZuKHBmbikpKTsK
KyAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1w
dGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZuKSkpOwogICAgIH0KIAogICAg
IGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQpAQCAtMTM3Niw3ICsxMzc2LDcg
QEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3Qg
bDNlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgcmV0dXJuIDA7CiAg
ICAgfQogCi0gICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZu
X3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAgcmMgPSBfcHV0X3BhZ2VfdHlw
ZShwZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShfbWZuKHBmbikp
KTsKICAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICAgICAgcHV0X3BhZ2Uo
cGcpOwogCkBAIC0xMzk3LDcgKzEzOTcsNyBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcg
cGZuLAogICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikp
OwotICAgICAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCB0cnVl
LCBtZm5fdG9fcGFnZShfbWZuKHBmbikpKTsKKyAgICAgICAgICAgIHJldHVy
biBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9f
cGFnZShfbWZuKHBmbikpKTsKICAgICAgICAgfQogCiAgICAgICAgIGlmICgg
ZmxhZ3MgJiBQVEZfZGVmZXIgKQpAQCAtMTQwNyw3ICsxNDA3LDcgQEAgc3Rh
dGljIGludCBwdXRfcGFnZV9mcm9tX2w0ZShsNF9wZ2VudHJ5X3QgbDRlLCB1
bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgICAgIHJldHVybiAwOwogICAg
ICAgICB9CiAKLSAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1
ZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAgICAgIHJjID0gX3B1
dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2Uo
X21mbihwZm4pKSk7CiAgICAgICAgIGlmICggbGlrZWx5KCFyYykgKQogICAg
ICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgIH0KQEAgLTI3NTcsMTAgKzI3
NTcsMTEgQEAgc3RhdGljIGludCBfcHV0X2ZpbmFsX3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiB9CiAK
IAotc3RhdGljIGludCBfcHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZv
ICpwYWdlLCBib29sIHByZWVtcHRpYmxlLAorc3RhdGljIGludCBfcHV0X3Bh
Z2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBpbnQg
ZmxhZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBwYWdl
X2luZm8gKnB0cGcpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBueCwgeCwgeSA9
IHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvOworICAgIGJvb2wgcHJlZW1wdGli
bGUgPSBmbGFncyAmIFBURl9wcmVlbXB0aWJsZTsKIAogICAgIEFTU0VSVChj
dXJyZW50X2xvY2tlZF9wYWdlX25lX2NoZWNrKHBhZ2UpKTsKIApAQCAtMjk2
OSw3ICsyOTcwLDcgQEAgc3RhdGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAKICAg
ICAgICAgICAgIGlmICggdW5saWtlbHkoaW9tbXVfcmV0KSApCiAgICAgICAg
ICAgICB7Ci0gICAgICAgICAgICAgICAgX3B1dF9wYWdlX3R5cGUocGFnZSwg
ZmFsc2UsIE5VTEwpOworICAgICAgICAgICAgICAgIF9wdXRfcGFnZV90eXBl
KHBhZ2UsIDAsIE5VTEwpOwogICAgICAgICAgICAgICAgIHJjID0gaW9tbXVf
cmV0OwogICAgICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICAgICAg
fQpAQCAtMjk5Niw3ICsyOTk3LDcgQEAgc3RhdGljIGludCBfZ2V0X3BhZ2Vf
dHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5
cGUsCiAKIHZvaWQgcHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogewotICAgIGludCByYyA9IF9wdXRfcGFnZV90eXBlKHBhZ2UsIGZh
bHNlLCBOVUxMKTsKKyAgICBpbnQgcmMgPSBfcHV0X3BhZ2VfdHlwZShwYWdl
LCAwLCBOVUxMKTsKICAgICBBU1NFUlQocmMgPT0gMCk7CiAgICAgKHZvaWQp
cmM7CiB9CkBAIC0zMDEzLDcgKzMwMTQsNyBAQCBpbnQgZ2V0X3BhZ2VfdHlw
ZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUp
CiAKIGludCBwdXRfcGFnZV90eXBlX3ByZWVtcHRpYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiB7Ci0gICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBh
Z2UsIHRydWUsIE5VTEwpOworICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShw
YWdlLCBQVEZfcHJlZW1wdGlibGUsIE5VTEwpOwogfQogCiBpbnQgZ2V0X3Bh
Z2VfdHlwZV9wcmVlbXB0aWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1
bnNpZ25lZCBsb25nIHR5cGUpCkBAIC0zMDMwLDcgKzMwMzEsNyBAQCBpbnQg
cHV0X29sZF9ndWVzdF90YWJsZShzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAo
ICF2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCiAgICAgICAgIHJldHVybiAw
OwogCi0gICAgc3dpdGNoICggcmMgPSBfcHV0X3BhZ2VfdHlwZSh2LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSwgdHJ1ZSwKKyAgICBzd2l0Y2ggKCByYyA9IF9w
dXRfcGFnZV90eXBlKHYtPmFyY2gub2xkX2d1ZXN0X3RhYmxlLCBQVEZfcHJl
ZW1wdGlibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
LT5hcmNoLm9sZF9ndWVzdF9wdHBnKSApCiAgICAgewogICAgIGNhc2UgLUVJ
TlRSOgotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Transfer-Encoding: base64

RnJvbSA2ZjI1Nzg1NGM4Nzc4Nzc0MjEwMjgxYzVjMjEwMjhjNGI3NzM5YjQ0
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA1LzExXSB4
ODYvbW06IFJld29yayBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbiBjb25k
aXRpb25hbAoKTWFrZSBpdCBlYXNpZXIgdG8gcmVhZCBieSBkZWNsYXJpbmcg
dGhlIGNvbmRpdGlvbnMgaW4gd2hpY2ggd2Ugd2lsbApyZXRhaW4gdGhlIHJl
ZiwgcmF0aGVyIHRoYW4gdGhlIGNvbmRpdGlvbnMgdW5kZXIgd2hpY2ggd2Ug
cmVsZWFzZSBpdC4KClRoZSBvbmx5IHdheSAocGFnZSA9PSBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZSkgY2FuIGJlIHRydWUgaXMgaWYKcHJlZW1w
dGlibGUgaXMgdHJ1ZTsgc28gcmVtb3ZlIHRoaXMgZnJvbSB0aGUgcXVlcnkg
aXRzZWxmLCBhbmQgYWRkIGFuCkFTU0VSVCgpIHRvIHRoYXQgZWZmZWN0IG9u
IHRoZSBvcHBvc2l0ZSBwYXRoLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50
ZW5kZWQuCgpOQiB0aGF0IGFsbG9jX2xOX3RhYmxlKCkgbWlzaGFuZGxlIHRo
ZSAibGluZWFyIHB0IGZhaWx1cmUiIHNpdHVhdGlvbgpkZXNjcmliZWQgaW4g
dGhlIGNvbW1lbnQ7IHRoaXMgd2lsbCBiZSBhZGRyZXNzZWQgaW4gYSBmdXR1
cmUgcGF0Y2guCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDM5ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNo
YW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCAwNzQwYjYxYWY4Li4wYTRkMzlhMmMzIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTEyMiw4ICsxMTIyLDQzIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5
cGVfZnJvbV9tZm4oCiAKICAgICByYyA9IF9nZXRfcGFnZV90eXBlKHBhZ2Us
IHR5cGUsIHByZWVtcHRpYmxlKTsKIAotICAgIGlmICggdW5saWtlbHkocmMp
ICYmICFwYXJ0aWFsX3JlZiAmJgotICAgICAgICAgKCFwcmVlbXB0aWJsZSB8
fCBwYWdlICE9IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKSApCisg
ICAgLyoKKyAgICAgKiBSZXRhaW4gdGhlIHJlZmNvdW50IGlmOgorICAgICAq
IC0gcGFnZSBpcyBmdWxseSB2YWxpZGF0ZWQgKHJjID09IDApCisgICAgICog
LSBwYWdlIGlzIG5vdCB2YWxpZGF0ZWQgKHJjIDwgMCkgYnV0OgorICAgICAq
ICAgLSBXZSBjYW1lIGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfcmVm
KQorICAgICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0
IHRoZXJlJ3MgYmVlbiBhbiBlcnJvcgorICAgICAqICAgICAocGFnZSA9PSBj
dXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkKKyAgICAgKgorICAgICAq
IFRoZSBwYXJ0aWFsX3JlZi1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4g
ZXhwbGFuYXRpb24uICBUaGVyZQorICAgICAqIGFyZSB0d28gc2NlbmFyaW9z
IHdoZXJlIHBhcnRpYWxfcmVmIG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgor
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBkZW1vdGVkIGFzIHR5
cGUgYHR5cGVgOyBpLmUuIGhhcworICAgICAqICAgUEdUX3BhcnRpYWwgc2V0
CisgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMg
TCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgorICAgICAqICAgcGFnZTsgZS5n
LiB3ZSdyZSBiZWluZyBjYWxsZWQgZnJvbSBnZXRfcGFnZV9mcm9tX2wyZSB3
aXRoCisgICAgICogICB0eXBlID09IFBHVF9sMV90YWJsZSwgYnV0IHRoZSBt
Zm4gaXMgUEdUX2wyX3RhYmxlKQorICAgICAqCisgICAgICogSWYgdGhlcmUn
cyBhbiBlcnJvciwgaW4gdGhlIGZpcnN0IGNhc2UsIF9nZXRfcGFnZV90eXBl
IHdpbGwKKyAgICAgKiBlaXRoZXIgcmV0dXJuIC1FUkVTVEFSVCwgaW4gd2hp
Y2ggY2FzZSB3ZSB3YW50IHRvIHJldGFpbiB0aGUKKyAgICAgKiByZWYgKGFz
IHRoZSBjYWxsZXIgd2lsbCBjb25zaWRlciBpdCByZXRhaW5lZCksIG9yIC1F
SU5WQUwsIGluCisgICAgICogd2hpY2ggY2FzZSBvbGRfZ3Vlc3RfdGFibGUg
d2lsbCBiZSBzZXQ7IGluIGJvdGggY2FzZXMsIHdlIG5lZWQKKyAgICAgKiB0
byByZXRhaW4gdGhlIHJlZi4KKyAgICAgKgorICAgICAqIEluIHRoZSBzZWNv
bmQgY2FzZSwgaWYgdGhlcmUncyBhbiBlcnJvciwgX2dldF9wYWdlX3R5cGUo
KSBjYW4KKyAgICAgKiAqb25seSogcmV0dXJuIC1FSU5WQUwsIGFuZCAqbmV2
ZXIqIHNldCBvbGRfZ3Vlc3RfdGFibGUuICBJbgorICAgICAqIHRoYXQgY2Fz
ZSB3ZSBhbHNvIHdhbnQgdG8gcmV0YWluIHRoZSByZWZlcmVuY2UsIHRvIGFs
bG93IHRoZQorICAgICAqIHBhZ2UgdG8gY29udGludWUgdG8gYmUgdG9ybiBk
b3duIChpLmUuLCBQR1RfcGFydGlhbCBjbGVhcmVkKQorICAgICAqIHNhZmVs
eS4KKyAgICAgKgorICAgICAqIEFsc28gbm90ZSB0aGF0IHdlIHNob3VsZG4n
dCBiZSBhYmxlIHRvIGxlYXZlIHdpdGggdGhlIHJlZmVyZW5jZQorICAgICAq
IGNvdW50IHJldGFpbmVkIHVubGVzcyB3ZSBzdWNjZWVkZWQsIG9yIHRoZSBv
cGVyYXRpb24gd2FzCisgICAgICogcHJlZW1wdGlibGUuCisgICAgICovCisg
ICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFsX3JlZiApCisgICAgICAg
IC8qIG5vdGhpbmcgKi87CisgICAgZWxzZSBpZiAoIHBhZ2UgPT0gY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQorICAgICAgICBBU1NFUlQocHJl
ZW1wdGlibGUpOworICAgIGVsc2UKICAgICAgICAgcHV0X3BhZ2UocGFnZSk7
CiAKICAgICByZXR1cm4gcmM7Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Transfer-Encoding: base64

RnJvbSA0YWQ3MDU1MzYxMWE3YTRlNDQ5NGQ1YTNiNTFiNWNjMjk1YTQ4OGUw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA2LzExXSB4
ODYvbW06IEhhdmUgYWxsb2NfbFsyM11fdGFibGUgY2xlYXIgcGFydGlhbF9m
bGFncyB3aGVuCiBwcmVlbXB0aW5nCgpJbiBvcmRlciB0byBhbGxvdyByZWN1
cnNpdmUgcGFnZXRhYmxlIHByb21vdGlvbnMgYW5kIGRlbW90aW9ucyB0byBi
ZQppbnRlcnJ1cHRlZCwgWGVuIG11c3Qga2VlcCB0cmFjayBvZiB0aGUgc3Rh
dGUgb2YgdGhlIHN1Yi1wYWdlcwpwcm9tb3RlZCBvciBkZW1vdGVkLiAgVGhp
cyBpcyBzdG9yZWQgaW4gdHdvIGVsZW1lbnRzIGluIHRoZSBwYWdlCnN0cnVj
dDogbnJfZW50cmllc192YWxpZGF0ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpU
aGUgcnVsZSBpcyB0aGF0IGVudHJpZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRh
dGVkKSBzaG91bGQgYWx3YXlzIGJlCnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdl
bmVyYWwgcmVmZXJlbmNlIGNvdW50LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6
ZXJvLCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlk
YXRlZCBhbmQgbm8gcmVmZXJlbmNlCmNvdW50IGlzIGhlbGQuICBJZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRl
ZF0KaXMgcGFydGlhbGx5IHZhbGlkYXRlZC4KCkF0IHRoZSBtb21lbnQsIGEg
ZGlzdGluY3Rpb24gaXMgbWFkZSBiZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVt
b3Rpb24Kd2l0aCByZWdhcmQgdG8gd2hldGhlciB0aGUgZW50cnkgaXRzZWxm
ICJob2xkcyIgYSBnZW5lcmFsIHJlZmVyZW5jZQpjb3VudDogd2hlbiBlbnRy
eSBwcm9tb3Rpb24gaXMgaW50ZXJydXB0ZWQgKGkuZS4sIHJldHVybnMgLUVS
RVNUQVJUKSwKdGhlIGVudHJ5IGlzIG5vdCBjb25zaWRlcmVkIHRvIGhvbGQg
YSByZWZlcmVuY2U7IHdoZW4gZW50cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0
ZWQsIHRoZSBlbnRyeSBpcyBzdGlsbCBjb25zaWRlcmVkIHRvIGhvbGQgYSBn
ZW5lcmFsCnJlZmVyZW5jZS4KClBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYg
Y2xlYXIsIGl0J3MgYSBwYXJ0aWFsIHByb21vdGlvbiA9PiBubyBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBoZWxkCmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBp
dCdzIHBhcnRpYWwgZGVtb3Rpb24sIHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UK
Y291bnQgaGVsZC4gIEJlY2F1c2UgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25z
IGNhbiBiZSBpbnRlcmxlYXZlZCwgdGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8g
Z2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21f
bCplLAp0byBiZSBhYmxlIHRvIHByb3Blcmx5IGhhbmRsZSByZWZlcmVuY2Ug
Y291bnRzLgoKVW5mb3J0dW5hdGVseSwgd2hlbiBhbGxvY19sWzIzXV90YWJs
ZSBjaGVjayBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpCmFuZCByZXR1cm4g
LUVSRVNUQVJULCB0aGV5IHNldCBucl9lbnRyaWVzX3ZhbGlkYXRlZCwgYnV0
IGRvbid0IGNsZWFyCnBhcnRpYWxfZmxhZ3MuCgpJZiB3ZSB3ZXJlIHBpY2tp
bmcgdXAgZnJvbSBhIHByZXZpb3VzbHktaW50ZXJydXB0ZWQgcHJvbW90aW9u
LCB0aGF0Cm1lYW5zIHRoYXQgUFRGX3BhcnRpYWxfc2V0IHdvdWxkIGJlIHNl
dCBldmVuIHRob3VnaApbbnJfZW50cmllc192YWxpZGF0ZWRdIHdhcyBub3Qg
cGFydGlhbGx5IHZhbGlkYXRlZC4gIFRoaXMgbWVhbnMgdGhhdAppZiB0aGUg
cGFnZSBpbiB0aGlzIHN0YXRlIHdlcmUgZGUtdmFsaWRhdGVkLCBwdXRfcGFn
ZV90eXBlKCkgd291bGQKZXJyb25lb3VzbHkgYmUgY2FsbGVkIG9uIHRoYXQg
ZW50cnkuCgpQZXJoYXBzIHdvcnNlLCBpZiB3ZSB3ZXJlIHJhY2luZyB3aXRo
IGEgZGUtdmFsaWRhdGlvbiwgdGhlbiB3ZSBtaWdodApsZWF2ZSBib3RoIFBU
Rl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7IGFu
ZCB3aGVuCmRlLXZhbGlkYXRpb24gcGlja2VkIHVwIGFnYWluLCBib3RoIHRo
ZSB0eXBlIGFuZCB0aGUgZ2VuZXJhbCByZWYgd291bGQKYmUgZXJyb25lb3Vz
bHkgZHJvcHBlZCBmcm9tIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0uCgpJbiBh
IHNlbnNlLCB0aGUgcmVhbCBpc3N1ZSBoZXJlIGlzIGNvZGUgZHVwbGljYXRp
b24uICBSYXRoZXIgdGhhbgpkdXBsaWNhdGUgdGhlIGludGVycnVwdGlvbiBj
b2RlLCBzZXQgcmMgdG8gLUVJTlRSIGFuZCBmYWxsIHRocm91Z2ggdG8KdGhl
IGNvZGUgd2hpY2ggYWxyZWFkeSBoYW5kbGVzIHRoYXQgY2FzZSBjb3JyZWN0
bHkuCgpHaXZlbiB0aGUgbG9naWMgYXQgdGhpcyBwb2ludCwgaXQgc2hvdWxk
IGJlIGltcG9zc2libGUgZm9yCnBhcnRpYWxfZmxhZ3MgdG8gYmUgbm9uLXpl
cm87IGFkZCBhbiBBU1NFUlQoKSB0byBjYXRjaCBhbnkgY2hhbmdlcy4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMjUgKysrKysrLS0tLS0tLS0tLS0t
LS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDYgaW5zZXJ0aW9ucygrKSwgMTkg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCAwYTRkMzlhMmMzLi5iYmQyOWE2
OGY0IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTU1NCwyMSArMTU1NCwxMyBAQCBzdGF0aWMg
aW50IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVu
c2lnbmVkIGxvbmcgdHlwZSkKICAgICBmb3IgKCBpID0gcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXM7IGkgPCBMMl9QQUdFVEFCTEVfRU5UUklFUzsKICAgICAg
ICAgICBpKyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAgICB7Ci0gICAgICAg
IGwyX3BnZW50cnlfdCBsMmU7CisgICAgICAgIGwyX3BnZW50cnlfdCBsMmUg
PSBwbDJlW2ldOwogCiAgICAgICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQotICAg
ICAgICB7Ci0gICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKLSAgICAgICAgICAg
IGJyZWFrOwotICAgICAgICB9Ci0KLSAgICAgICAgaWYgKCAhaXNfZ3Vlc3Rf
bDJfc2xvdChkLCB0eXBlLCBpKSApCisgICAgICAgICAgICByYyA9IC1FSU5U
UjsKKyAgICAgICAgZWxzZSBpZiAoICFpc19ndWVzdF9sMl9zbG90KGQsIHR5
cGUsIGkpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwotCi0gICAgICAgIGwy
ZSA9IHBsMmVbaV07Ci0KLSAgICAgICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3Mo
bDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKKyAgICAgICAgZWxzZSBpZiAoICEo
bDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBpZiAoICFwdl9sMXRmX2NoZWNrX2wyZShkLCBs
MmUpICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTE2NDAsMTMg
KzE2MzIsOCBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCiAgICAgICAgIGwzX3BnZW50cnlfdCBsM2UgPSBw
bDNlW2ldOwogCiAgICAgICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlkYXRl
ZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQotICAgICAg
ICB7Ci0gICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7
Ci0gICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKLSAgICAgICAgICAgIGJy
ZWFrOwotICAgICAgICB9Ci0KLSAgICAgICAgaWYgKCBpc19wdl8zMmJpdF9k
b21haW4oZCkgJiYgKGkgPT0gMykgKQorICAgICAgICAgICAgcmMgPSAtRUlO
VFI7CisgICAgICAgIGVsc2UgaWYgKCBpc19wdl8zMmJpdF9kb21haW4oZCkg
JiYgKGkgPT0gMykgKQogICAgICAgICB7CiAgICAgICAgICAgICBpZiAoICEo
bDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgfHwKICAgICAg
ICAgICAgICAgICAgKGwzZV9nZXRfZmxhZ3MobDNlKSAmIGwzX2Rpc2FsbG93
X21hc2soZCkpICkKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Transfer-Encoding: base64

RnJvbSA1MWZlNGU2N2Q5NTQ2NDlmY2YxMDMxMTZiZTYyMDZhNzY5ZjBkYjFl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA3LzExXSB4
ODYvbW06IEFsd2F5cyByZXRhaW4gYSBnZW5lcmFsIHJlZiBvbiBwYXJ0aWFs
CgpJbiBvcmRlciB0byBhbGxvdyByZWN1cnNpdmUgcGFnZXRhYmxlIHByb21v
dGlvbnMgYW5kIGRlbW90aW9ucyB0byBiZQppbnRlcnJ1cHRlZCwgWGVuIG11
c3Qga2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIHN1Yi1wYWdlcwpw
cm9tb3RlZCBvciBkZW1vdGVkLiAgVGhpcyBpcyBzdG9yZWQgaW4gdHdvIGVs
ZW1lbnRzIGluIHRoZSBwYWdlIHN0cnVjdDoKbnJfZW50cmllc192YWxpZGF0
ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpUaGUgcnVsZSBpcyB0aGF0IGVudHJp
ZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRhdGVkKSBzaG91bGQgYWx3YXlzIGJl
CnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdlbmVyYWwgcmVmZXJlbmNlIGNvdW50
LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6ZXJvLCB0aGVuIFtucl9lbnRyaWVz
X3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlkYXRlZCBhbmQgbm8gcmVmZXJlbmNl
CmNvdW50IGlzIGhlbGQuICBJZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0KaXMgcGFydGlhbGx5IHZhbGlk
YXRlZC4KCkF0IHRoZSBtb21lbnQsIGEgZGlzdGluY3Rpb24gaXMgbWFkZSBi
ZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVtb3Rpb24Kd2l0aCByZWdhcmQgdG8g
d2hldGhlciB0aGUgZW50cnkgaXRzZWxmICJob2xkcyIgYSBnZW5lcmFsIHJl
ZmVyZW5jZQpjb3VudDogd2hlbiBlbnRyeSBwcm9tb3Rpb24gaXMgaW50ZXJy
dXB0ZWQgKGkuZS4sIHJldHVybnMgLUVSRVNUQVJUKSwKdGhlIGVudHJ5IGlz
IG5vdCBjb25zaWRlcmVkIHRvIGhvbGQgYSByZWZlcmVuY2U7IHdoZW4gZW50
cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0ZWQsIHRoZSBlbnRyeSBpcyBzdGls
bCBjb25zaWRlcmVkIHRvIGhvbGQgYSBnZW5lcmFsCnJlZmVyZW5jZS4KClBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHVzZWQgdG8gZGlzdGluZ3Vpc2gg
YmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYgY2xlYXIsIGl0J3MgYSBwYXJ0aWFs
IHByb21vdGlvbiA9PiBubyBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBoZWxk
CmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBpdCdzIHBhcnRpYWwgZGVtb3Rpb24s
IHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UKY291bnQgaGVsZC4gIEJlY2F1c2Ug
cHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIGNhbiBiZSBpbnRlcmxlYXZlZCwg
dGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21fbCplLAp0byBiZSBhYmxlIHRvIHBy
b3Blcmx5IGhhbmRsZSByZWZlcmVuY2UgY291bnRzLgoKVW5mb3J0dW5hdGVs
eSwgYmVjYXVzZSBhIHJlZmNvdW50IGlzIG5vdCBoZWxkLCBpdCBpcyBwb3Nz
aWJsZSB0bwplbmdpbmVlciBhIHNpdHVhdGlvbiB3aGVyZSBQRlRfcGFydGlh
bF9zZXQgaXMgc2V0IGJ1dCB0aGUgcGFnZSBpbgpxdWVzdGlvbiBoYXMgYmVl
biBhc3NpZ25lZCB0byBhbm90aGVyIGRvbWFpbi4gIEEgc2tldGNoIGlzIHBy
b3ZpZGVkIGluCnRoZSBhcHBlbmRpeC4KCkZpeCB0aGlzIGJ5IGhhdmluZyB0
aGUgcGFyZW50IHBhZ2UgdGFibGUgZW50cnkgaG9sZCBhIGdlbmVyYWwKcmVm
ZXJlbmNlIGNvdW50IHdoZW5ldmVyIFBGVF9wYXJ0aWFsX3NldCBpcyBzZXQu
ICAoRm9yIGNsYXJpdHkgb2YKY2hhbmdlLCBrZWVwIHR3byBzZXBhcmF0ZSBm
bGFncy4gIFRoZXNlIHdpbGwgYmUgY29sbGFwc2VkIGluIGEKc3Vic2VxdWVu
dCBjaGFuZ2VzZXQuKQoKVGhpcyBoYXMgdHdvIGJhc2ljIGltcGxpY2F0aW9u
cy4gIE9uIHRoZSBwdXRfcGFnZV9mcm9tX2xOZSgpIHNpZGUsCnRoaXMgbWVh
biB0aGF0IHRoZSAocGFydGlhbF9zZXQgJiYgIXBhcnRpYWxfcmVmKSBjYXNl
IGNhbiBuZXZlciBoYXBwZW4sCmFuZCBubyBsb25nZXIgbmVlZHMgdG8gYmUg
c3BlY2lhbC1jYXNlZC4KClNlY29uZGx5LCBiZWNhdXNlIGJvdGggZmxhZ3Mg
YXJlIHNldCB0b2dldGhlciwgdGhlcmUncyBubyBuZWVkIHRvIGNhcnJ5IG92
ZXIKZXhpc3RpbmcgYml0cyBmcm9tIHBhcnRpYWxfcHRlLgoKKE5CIHRoZXJl
IGlzIHN0aWxsIGFub3RoZXIgaXNzdWUgd2l0aCBjYWxsaW5nIF9wdXRfcGFn
ZV90eXBlKCkgb24gYQpwYWdlIHdoaWNoIGhhZCBQR1RfcGFydGlhbCBzZXQ7
IHRoYXQgd2lsbCBiZSBoYW5kbGVkIGluIGEgc3Vic2VxdWVudApwYXRjaC4p
CgpPbiB0aGUgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oKSBzaWRlLCB3
ZSBuZWVkIHRvIGRpc3Rpbmd1aXNoCmJldHdlZW4gY2FsbGVycyB3aGljaCBo
b2xkIGEgcmVmZXJlbmNlIG9uIHBhcnRpYWwgKGkuZS4sCmFsbG9jX2xOX3Rh
YmxlKCkpLCBhbmQgdGhvc2Ugd2hpY2ggZG8gbm90IChuZXdfY3IzLCBQSU5f
TE5fVEFCTEUsIGFuZApzbyBvbik6IHBhc3MgYSBmbGFnIGlmIHRoZSB0eXBl
IHNob3VsZCBiZSByZXRhaW5lZCBvbiBpbnRlcnJ1cHRpb24uCgpOQiB0aGF0
IHNpbmNlIGwxIHByb21vdGlvbiBjYW4ndCBiZSBwcmVlbXB0ZWQsIHRoYXQg
Z2V0X3BhZ2VfZnJvbV9sMmUKY2FuJ3QgcmV0dXJuIC1FUkVTVEFSVC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0tLQoqIEFwcGVuZGl4OiBFbmdpbmVlcmluZyBQVEZfcGFydGlhbF9zZXQg
d2hpbGUgYSBwYWdlIGJlbG9uZ3MgdG8gYQogIGZvcmVpZ24gZG9tYWluCgpT
dXBwb3NlIEEgaXMgYSBwYWdlIHdoaWNoIGNhbiBiZSBwcm9tb3RlZCB0byBh
biBsMywgYW5kIEIgaXMgYSBwYWdlCndoaWNoIGNhbiBiZSBwcm9tb3RlZCB0
byBhbiBsMiwgYW5kIEFbeF0gcG9pbnRzIHRvIEIuICBCIGhhcwpQR0NfYWxs
b2NhdGVkIHNldCBidXQgbm8gb3RoZXIgZ2VuZXJhbCByZWZlcmVuY2VzLgoK
VjE6ICBQSU5fTDMgQS4KICBBIGlzIHZhbGlkYXRlZCwgQiBpcyB2YWxpZGF0
ZWQuCiAgQS50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQgfCBQR1Rf
cGlubmVkCiAgQi50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBC
LmNvdW50ID0gMiB8IFBHQ19hbGxvY2F0ZWQgKEFbeF0gaG9sZHMgYSBnZW5l
cmFsIHJlZikKClYxOiBVTlBJTiBBLgogIEEgYmVnaW5zIGRlLXZhbGlkYXRp
b24uCiAgQXJyYW5nZSB0byBiZSBpbnRlcnJ1cHRlZCB3aGVuIGkgPCB4CiAg
VjEtPm9sZF9ndWVzdF90YWJsZSA9IEEKICBWMS0+b2xkX2d1ZXN0X3RhYmxl
X3JlZl9oZWxkID0gZmFsc2UKICBBLnR5cGVfY291bnQgPSAxIHwgUEdUX3Bh
cnRpYWwKICBBLm5yX3ZhbGlkYXRlZF9lbnRyaWVzID0gaSA8IHgKICBCLnR5
cGVfY291bnQgPSAwCiAgQi5jb3VudCA9IDEgfCBQR0NfYWxsb2NhdGVkCgpW
MjogTU9EX0w0X0VOVFJZIHRvIHBvaW50IHNvbWUgbDRlIHRvIEEuCiAgUGlj
a3MgdXAgcmUtdmFsaWRhdGlvbiBvZiBBLgogIEFycmFuZ2UgdG8gYmUgaW50
ZXJydXB0ZWQgaGFsZndheSB0aHJvdWdoIEIncyB2YWxpZGF0aW9uCiAgQi50
eXBlX2NvdW50ID0gMSB8IFBHVF9wYXJ0aWFsCiAgQi5jb3VudCA9IDIgfCBQ
R0NfYWxsb2NhdGVkIChQR1RfcGFydGlhbCBob2xkcyBhIGdlbmVyYWwgcmVm
KQogIEEudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFs
aWRhdGVkX2VudHJpZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IFBURl9wYXJ0
aWFsX3NldAoKVjM6IE1PRF9MM19FTlRSWSB0byBwb2ludCBzb21lIG90aGVy
IGwzZSAobm90IGluIEEpIHRvIEIuCiAgVmFsaWRhdGVzIEIuCiAgQi50eXBl
X2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBCLmNvdW50ID0gMiB8IFBH
Q19hbGxvY2F0ZWQgKCJvdGhlciBsM2UiIGhvbGRzIGEgZ2VuZXJhbCByZWYp
CgpWMzogTU9EX0wzX0VOVFJZIHRvIGNsZWFyIGwzZSBwb2ludGluZyB0byBC
LgogIERldmFsaWRhdGVzIEIuCiAgQi50eXBlX2NvdW50ID0gMAogIEIuY291
bnQgPSAxIHwgUEdDX2FsbG9jYXRlZAoKVjM6IGRlY3JlYXNlX3Jlc2VydmF0
aW9uKEIpCiAgQ2xlYXJzIFBHQ19hbGxvY2F0ZWQKICBCLmNvdW50ID0gMCA9
PiBCIGlzIGZyZWVkCgpCIGdldHMgYXNzaWduZWQgdG8gYSBkaWZmZXJlbnQg
ZG9tYWluCgpWMTogUmVzdGFydHMgVU5QSU4gb2YgQQogIHB1dF9vbGRfZ3Vl
c3RfdGFibGUoQSkKICAgIC4uLgogICAgICBmcmVlX2wzX3RhYmxlKEEpCgpO
b3cgc2luY2UgQS5wYXJ0aWFsX2ZsYWdzIGhhcyBQVEZfcGFydGlhbF9zZXQs
IGZyZWVfbDNfdGFibGUoKSB3aWxsCmNhbGwgcHV0X3BhZ2VfZnJvbV9sM2Uo
KSBvbiBBW3hdLCB3aGljaCBwb2ludHMgdG8gQiwgd2hpbGUgQiBpcyBvd25l
ZApieSBhbm90aGVyIGRvbWFpbi4KCklmIEFbeF0gaGVsZCBhIGdlbmVyYWwg
cmVmY291bnQgZm9yIEIgb24gcGFydGlhbCB2YWxpZGF0aW9uLCBhcyBpdCBk
b2VzCmZvciBwYXJ0aWFsIGRlLXZhbGlkYXRpb24sIHRoZW4gQiB3b3VsZCBz
dGlsbCBoYXZlIGEgcmVmZXJlbmNlIGNvdW50IG9mCjEgYWZ0ZXIgUEdDX2Fs
bG9jYXRlZCB3YXMgZnJlZWQ7IHNvIEIgd291bGRuJ3QgYmUgZnJlZWQgdW50
aWwgYWZ0ZXIKcHV0X3BhZ2VfZnJvbV9sM2UoKSBoYWQgaGFwcGVuZCBvbiBB
W3hdLgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jICAgICAgICB8IDg0ICsrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaCB8IDE1ICsrKystLS0KIDIgZmlsZXMgY2hhbmdl
ZCwgNTggaW5zZXJ0aW9ucygrKSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwpp
bmRleCBiYmQyOWE2OGY0Li40ZDNlYmYzNDFkIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTEw
MiwxMCArMTEwMiwxMSBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKICAqIHBhZ2Ut
PnB0ZVtwYWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhlIGNv
bW1lbnQgaW4gbW0uaCBmb3IKICAqIG1vcmUgaW5mb3JtYXRpb24uCiAgKi8K
LSNkZWZpbmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwgMCkKLSNk
ZWZpbmUgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkKLSNkZWZp
bmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKLSNkZWZpbmUg
UFRGX2RlZmVyICAgICAgICAgICAgICAgKDEgPDwgMykKKyNkZWZpbmUgUFRG
X3BhcnRpYWxfc2V0ICAgICAgICAgICAoMSA8PCAwKQorI2RlZmluZSBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZiAgICgxIDw8IDEpCisjZGVmaW5lIFBURl9w
cmVlbXB0aWJsZSAgICAgICAgICAgKDEgPDwgMikKKyNkZWZpbmUgUFRGX2Rl
ZmVyICAgICAgICAgICAgICAgICAoMSA8PCAzKQorI2RlZmluZSBQVEZfcmV0
YWluX3JlZl9vbl9yZXN0YXJ0ICgxIDw8IDQpCiAKIHN0YXRpYyBpbnQgZ2V0
X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAgbWZuX3QgbWZuLCB1bnNp
Z25lZCBsb25nIHR5cGUsIHN0cnVjdCBkb21haW4gKmQsCkBAIC0xMTE0LDcg
KzExMTUsMTEgQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9t
X21mbigKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3RvX3Bh
Z2UobWZuKTsKICAgICBpbnQgcmM7CiAgICAgYm9vbCBwcmVlbXB0aWJsZSA9
IGZsYWdzICYgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAgcGFydGlhbF9y
ZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAg
ICAgcGFydGlhbF9yZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxf
cmVmLAorICAgICAgICAgcGFydGlhbF9zZXQgPSBmbGFncyAmIFBURl9wYXJ0
aWFsX3NldCwKKyAgICAgICAgIHJldGFpbl9yZWYgID0gZmxhZ3MgJiBQVEZf
cmV0YWluX3JlZl9vbl9yZXN0YXJ0OworCisgICAgQVNTRVJUKHBhcnRpYWxf
cmVmID09IHBhcnRpYWxfc2V0KTsKIAogICAgIGlmICggbGlrZWx5KCFwYXJ0
aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9mcm9t
X21mbihtZm4sIGQpKSApCkBAIC0xMTI3LDEzICsxMTMyLDE1IEBAIHN0YXRp
YyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAgICogLSBw
YWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKICAgICAgKiAtIHBh
Z2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6CiAgICAgICogICAt
IFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlhbF9yZWYpCisg
ICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCAocmMgPT0g
LUVSRVNUQVJUKSwgYW5kIHRoZQorICAgICAqICAgICBjYWxsZXIgaGFzIGFz
a2VkIHRoZSByZWYgdG8gYmUgcmV0YWluZWQgaW4gdGhhdCBjYXNlCiAgICAg
ICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCBidXQgdGhlcmUn
cyBiZWVuIGFuIGVycm9yCiAgICAgICogICAgIChwYWdlID09IGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlKQogICAgICAqCiAgICAgICogVGhlIHBh
cnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBpcyB3b3J0aCBhbiBleHBsYW5h
dGlvbi4gIFRoZXJlCiAgICAgICogYXJlIHR3byBzY2VuYXJpb3Mgd2hlcmUg
cGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBjb21pbmcgaW46Ci0gICAgICog
LSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgdHlwZSBgdHlw
ZWA7IGkuZS4gaGFzCi0gICAgICogICBQR1RfcGFydGlhbCBzZXQKKyAgICAg
KiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgcHJvbW90ZWQgLyBkZW1vdGVk
IGFzIHR5cGUgYHR5cGVgOworICAgICAqICAgaS5lLiBoYXMgUEdUX3BhcnRp
YWwgc2V0CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90
ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgogICAgICAqICAgcGFn
ZTsgZS5nLiB3ZSdyZSBiZWluZyBjYWxsZWQgZnJvbSBnZXRfcGFnZV9mcm9t
X2wyZSB3aXRoCiAgICAgICogICB0eXBlID09IFBHVF9sMV90YWJsZSwgYnV0
IHRoZSBtZm4gaXMgUEdUX2wyX3RhYmxlKQpAQCAtMTE1Niw3ICsxMTYzLDgg
QEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAg
ICAgKi8KICAgICBpZiAoIGxpa2VseSghcmMpIHx8IHBhcnRpYWxfcmVmICkK
ICAgICAgICAgLyogbm90aGluZyAqLzsKLSAgICBlbHNlIGlmICggcGFnZSA9
PSBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCisgICAgZWxzZSBp
ZiAoIHBhZ2UgPT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgfHwK
KyAgICAgICAgICAgICAgKHJldGFpbl9yZWYgJiYgcmMgPT0gLUVSRVNUQVJU
KSApCiAgICAgICAgIEFTU0VSVChwcmVlbXB0aWJsZSk7CiAgICAgZWxzZQog
ICAgICAgICBwdXRfcGFnZShwYWdlKTsKQEAgLTEzNTQsOCArMTM2Miw4IEBA
IHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwy
ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAgIGlmICggKGZsYWdzICYg
KFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkg
PT0KICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAg
ewotICAgICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsK
LSAgICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVl
bXB0aWJsZSwgcHRwZyk7CisgICAgICAgICAgICAvKiBwYXJ0aWFsX3NldCBz
aG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxfcmVmICovCisgICAgICAgICAg
ICBCVUcoKTsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggZmxhZ3Mg
JiBQVEZfZGVmZXIgKQogICAgICAgICB7CkBAIC0xNDAwLDggKzE0MDgsOCBA
QCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBs
M2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgIGlmICggKGZsYWdzICYgKFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0K
ICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgewotICAgICAgICBB
U1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwotICAgICAgICByZXR1cm4g
X3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3Bh
Z2UoX21mbihwZm4pKSk7CisgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3Vs
ZCBhbHdheXMgaW1wbHkgcGFydGlhbF9yZWYgKi8KKyAgICAgICAgQlVHKCk7
CiAgICAgfQogCiAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCkBAIC0x
NDMxLDggKzE0MzksOCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRl
KGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZikpID09CiAgICAgICAgICAgICAgIFBURl9wYXJ0aWFs
X3NldCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIEFTU0VSVCghKGZsYWdz
ICYgUFRGX2RlZmVyKSk7Ci0gICAgICAgICAgICByZXR1cm4gX3B1dF9wYWdl
X3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21mbihw
Zm4pKSk7CisgICAgICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3
YXlzIGltcGx5IHBhcnRpYWxfcmVmICovCisgICAgICAgICAgICBCVUcoKTsK
ICAgICAgICAgfQogCiAgICAgICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIg
KQpAQCAtMTU2OSwxMyArMTU3NywyMiBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgZWxzZQogICAgICAgICAgICAgcmMgPSBnZXRfcGFn
ZV9mcm9tX2wyZShsMmUsIHBmbiwgZCwgcGFydGlhbF9mbGFncyk7CiAKLSAg
ICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQotICAgICAgICB7Ci0gICAg
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAg
ICAgICAvKiBTZXQgJ3NldCcsIHJldGFpbiAnZ2VuZXJhbCByZWYnICovCi0g
ICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFn
cyB8IFBURl9wYXJ0aWFsX3NldDsKLSAgICAgICAgfQotICAgICAgICBlbHNl
IGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQorICAgICAgICAvKgorICAgICAg
ICAgKiBJdCBzaG91bGRuJ3QgYmUgcG9zc2libGUgZm9yIGdldF9wYWdlX2Zy
b21fbDJlIHRvIHJldHVybgorICAgICAgICAgKiAtRVJFU1RBUlQsIHNpbmNl
IHdlIG5ldmVyIGNhbGwgdGhpcyB3aXRoIFBURl9wcmVlbXB0aWJsZS4KKyAg
ICAgICAgICogKGFsbG9jX2wxX3RhYmxlIG1heSByZXR1cm4gLUVJTlRSIG9u
IGFuIEwxVEYtdnVsbmVyYWJsZQorICAgICAgICAgKiBlbnRyeS4pCisgICAg
ICAgICAqCisgICAgICAgICAqIE5CIHRoYXQgd2hpbGUgb24gYSAiY2xlYW4i
IHByb21vdGlvbiwgd2UgY2FuIG5ldmVyIGdldAorICAgICAgICAgKiBQR1Rf
cGFydGlhbC4gIEl0IGlzIHBvc3NpYmxlIHRvIGFycmFuZ2UgZm9yIGFuIGwy
ZSB0bworICAgICAgICAgKiBjb250YWluIGEgcGFydGlhbGx5LWRldmFsaWRh
dGVkIGwyOyBidXQgaW4gdGhhdCBjYXNlLCBib3RoCisgICAgICAgICAqIG9m
IHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIHdpbGwgZmFpbCBhbnl3YXkgKHRo
ZSBmaXJzdAorICAgICAgICAgKiBiZWNhdXNlIHRoZSBwYWdlIGluIHF1ZXN0
aW9uIGlzIG5vdCBhbiBsMTsgdGhlIHNlY29uZAorICAgICAgICAgKiBiZWNh
dXNlIHRoZSBwYWdlIGlzIG5vdCBmdWxseSB2YWxpZGF0ZWQpLgorICAgICAg
ICAgKi8KKyAgICAgICAgQVNTRVJUKHJjICE9IC1FUkVTVEFSVCk7CisKKyAg
ICAgICAgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKICAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwpAQCAtMTU4NCw2ICsx
NjAxLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAgICAgIGVs
c2UgaWYgKCByYyA8IDAgJiYgcmMgIT0gLUVJTlRSICkKICAgICAgICAgewog
ICAgICAgICAgICAgZ2RwcmludGsoWEVOTE9HX1dBUk5JTkcsICJGYWlsdXJl
IGluIGFsbG9jX2wyX3RhYmxlOiBzbG90ICUjeFxuIiwgaSk7CisgICAgICAg
ICAgICBBU1NFUlQoY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPT0g
TlVMTCk7CiAgICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
QEAgLTE2NDIsNyArMTY2MCw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFi
bGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICBy
YyA9IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKAogICAgICAgICAgICAg
ICAgICAgICBsM2VfZ2V0X21mbihsM2UpLAogICAgICAgICAgICAgICAgICAg
ICBQR1RfbDJfcGFnZV90YWJsZSB8IFBHVF9wYWVfeGVuX2wyLCBkLAotICAg
ICAgICAgICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3ByZWVtcHRp
YmxlKTsKKyAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8IFBU
Rl9wcmVlbXB0aWJsZSB8IFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQpOwog
ICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCAhKGwzZV9nZXRfZmxhZ3Mo
bDNlKSAmIF9QQUdFX1BSRVNFTlQpICkKICAgICAgICAgewpAQCAtMTY1MSwx
MyArMTY2OSwxNCBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICByYyA9IC1FSU5UUjsK
ICAgICAgICAgfQogICAgICAgICBlbHNlCi0gICAgICAgICAgICByYyA9IGdl
dF9wYWdlX2Zyb21fbDNlKGwzZSwgcGZuLCBkLCBwYXJ0aWFsX2ZsYWdzKTsK
KyAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UobDNlLCBwZm4s
IGQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRp
YWxfZmxhZ3MgfCBQVEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0KTsKIAogICAg
ICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgICAgIHsKICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKICAgICAgICAg
ICAgIC8qIFNldCAnc2V0JywgbGVhdmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYg
dGhpcyBlbnRyeSB3YXMgc2V0ICovCi0gICAgICAgICAgICBwYWdlLT5wYXJ0
aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsK
KyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKICAgICAgICAgfQog
ICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAgICAg
ICB7CkBAIC0xODMzLDEzICsxODUyLDE0IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDRfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAg
IHJjID0gLUVJTlRSOwogICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAg
ICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sNGUobDRlLCBwZm4sIGQsIHBh
cnRpYWxfZmxhZ3MpOworICAgICAgICAgICAgcmMgPSBnZXRfcGFnZV9mcm9t
X2w0ZShsNGUsIHBmbiwgZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcGFydGlhbF9mbGFncyB8IFBURl9yZXRhaW5fcmVmX29uX3Jl
c3RhcnQpOwogCiAgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAg
ICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
PSBpOwogICAgICAgICAgICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJh
bCByZWYnIHNldCBpZiB0aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRG
X3BhcnRpYWxfc2V0OworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
OwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKQogICAg
ICAgICB7CkBAIC0xOTM2LDkgKzE5NTYsNyBAQCBzdGF0aWMgaW50IGZyZWVf
bDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBlbHNlIGlm
ICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/Ci0g
ICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoKLSAgICAgICAgICAgIChQVEZf
cGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CisgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZjsKICAgICB9CiAgICAgZWxzZSBpZiAo
IHJjID09IC1FSU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVMgLSAx
ICkKICAgICB7CkBAIC0xOTg2LDkgKzIwMDQsNyBAQCBzdGF0aWMgaW50IGZy
ZWVfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAo
IHJjID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxh
Z3MgPSAocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgPwotICAg
ICAgICAgICAgcGFydGlhbF9mbGFncyA6Ci0gICAgICAgICAgICAoUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpOworICAgICAg
ICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwgUFRG
X3BhcnRpYWxfZ2VuZXJhbF9yZWY7CiAgICAgfQogICAgIGVsc2UgaWYgKCBy
YyA9PSAtRUlOVFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSAp
CiAgICAgewpAQCAtMjAxOSw5ICsyMDM1LDcgQEAgc3RhdGljIGludCBmcmVl
X2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgaWYgKCBy
YyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpID8KLSAgICAg
ICAgICAgIHBhcnRpYWxfZmxhZ3MgOgotICAgICAgICAgICAgKFBURl9wYXJ0
aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKTsKKyAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9w
YXJ0aWFsX2dlbmVyYWxfcmVmOwogICAgIH0KICAgICBlbHNlIGlmICggcmMg
PT0gLUVJTlRSICYmIGkgPCBMNF9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQog
ICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCBi
L3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaAppbmRleCA4NDA2YWMzYzM3Li4w
MjA3OWUxMzI0IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCkBAIC0yMzgsMjIg
KzIzOCwyNSBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAgICAgICAgICAqIHBhZ2Uu
CiAgICAgICAgICAqCiAgICAgICAgICAqIFRoaXMgaGFwcGVuczoKLSAgICAg
ICAgICogLSBEdXJpbmcgZGUtdmFsaWRhdGlvbiwgaWYgZGUtdmFsaWRhdGlv
biBvZiB0aGUgcGFnZSB3YXMKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRh
dGlvbiBvciBkZS12YWxpZGF0aW9uLCBpZiB0aGUgb3BlcmF0aW9uIHdhcwog
ICAgICAgICAgKiAgIGludGVycnVwdGVkCiAgICAgICAgICAqIC0gRHVyaW5n
IHZhbGlkYXRpb24sIGlmIGFuIGludmFsaWQgZW50cnkgaXMgZW5jb3VudGVy
ZWQgYW5kCiAgICAgICAgICAqICAgdmFsaWRhdGlvbiBpcyBwcmVlbXB0aWJs
ZQogICAgICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFy
dGlhbF9nZW5lcmFsX3JlZiB3YXMgc2V0IG9uCi0gICAgICAgICAqICAgdGhp
cyBlbnRyeSB0byBiZWdpbiB3aXRoIChwZXJoYXBzIGJlY2F1c2Ugd2UncmUg
cGlja2luZwotICAgICAgICAgKiAgIHVwIGZyb20gYSBwYXJ0aWFsIGRlLXZh
bGlkYXRpb24pLgorICAgICAgICAgKiAgIHRoaXMgZW50cnkgdG8gYmVnaW4g
d2l0aCAocGVyaGFwcyBiZWNhdXNlIGl0IHBpY2tlZCB1cCBhCisgICAgICAg
ICAqICAgcHJldmlvdXMgb3BlcmF0aW9uKQogICAgICAgICAgKgotICAgICAg
ICAgKiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmIGlzIGNsZWFyLAotICAgICAgICAgKiB0aGVuIGEgZ2Vu
ZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZDsgaWYgaXQgaXMg
c2V0LCBubwotICAgICAgICAgKiByZWZlcmVuY2Ugc2hvdWxkIGJlIGFjcXVp
cmVkLgorICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24sIGlm
IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzCisgICAgICAgICAqIGNsZWFy
LCB0aGVuIGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1aXJl
ZDsgaWYgaXQKKyAgICAgICAgICogaXMgc2V0LCBubyByZWZlcmVuY2Ugc2hv
dWxkIGJlIGFjcXVpcmVkLgogICAgICAgICAgKgogICAgICAgICAgKiBXaGVu
IHJlc3VtaW5nIGRlLXZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVy
YWxfcmVmIGlzCiAgICAgICAgICAqIGNsZWFyLCBubyByZWZlcmVuY2Ugc2hv
dWxkIGJlIGRyb3BwZWQ7IGlmIGl0IGlzIHNldCwgYQogICAgICAgICAgKiBy
ZWZlcmVuY2Ugc2hvdWxkIGJlIGRyb3BwZWQuCiAgICAgICAgICAqCisgICAg
ICAgICAqIE5CIGF0IHRoZSBtb21lbnQsIFBURl9wYXJ0aWFsX3NldCBzaG91
bGQgYmUgc2V0IGlmIGFuZCBvbmx5IGlmCisgICAgICAgICAqIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGlzIHNldC4KKyAgICAgICAgICoKICAgICAgICAg
ICogTkIgdGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmIGFyZQogICAgICAgICAgKiBkZWZpbmVkIGluIG1tLmMsIHRo
ZSBvbmx5IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQuCiAgICAgICAgICAq
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Transfer-Encoding: base64

RnJvbSA4YThkODM2ZjdmNzQxOGU2NTlkMzc4MTdhNjZjZDdhNmIxMTUwNDJi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA4LzExXSB4
ODYvbW06IENvbGxhcHNlIFBURl9wYXJ0aWFsX3NldCBhbmQKIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGludG8gb25lCgouLi5ub3cgdGhhdCB0aGV5IGFy
ZSBlcXVpdmFsZW50LiAgTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQu
CgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21tLmMg
ICAgICAgIHwgNTAgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIHwgMjkgKysrKysr
KysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA0ZDNlYmYz
NDFkLi44ODZlOTNiOGFhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTA5NywxMyArMTA5Nywx
MiBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKIAogLyoKICAqIFRoZSBmb2xsb3dp
bmcgZmxhZ3MgYXJlIHVzZWQgdG8gc3BlY2lmeSBiZWhhdmlvciBvZiB2YXJp
b3VzIGdldCBhbmQKLSAqIHB1dCBjb21tYW5kcy4gIFRoZSBmaXJzdCB0d28g
YXJlIGFsc28gc3RvcmVkIGluIHBhZ2UtPnBhcnRpYWxfZmxhZ3MKLSAqIHRv
IGluZGljYXRlIHRoZSBzdGF0ZSBvZiB0aGUgcGFnZSBwb2ludGVkIHRvIGJ5
CisgKiBwdXQgY29tbWFuZHMuICBUaGUgZmlyc3QgaXMgYWxzbyBzdG9yZWQg
aW4gcGFnZS0+cGFydGlhbF9mbGFncyB0bworICogaW5kaWNhdGUgdGhlIHN0
YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQgdG8gYnkKICAqIHBhZ2UtPnB0ZVtw
YWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhlIGNvbW1lbnQg
aW4gbW0uaCBmb3IKICAqIG1vcmUgaW5mb3JtYXRpb24uCiAgKi8KICNkZWZp
bmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgICAoMSA8PCAwKQotI2RlZmlu
ZSBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiAgICgxIDw8IDEpCiAjZGVmaW5l
IFBURl9wcmVlbXB0aWJsZSAgICAgICAgICAgKDEgPDwgMikKICNkZWZpbmUg
UFRGX2RlZmVyICAgICAgICAgICAgICAgICAoMSA8PCAzKQogI2RlZmluZSBQ
VEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0ICgxIDw8IDQpCkBAIC0xMTE1LDEz
ICsxMTE0LDEwIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4oCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IG1mbl90b19w
YWdlKG1mbik7CiAgICAgaW50IHJjOwogICAgIGJvb2wgcHJlZW1wdGlibGUg
PSBmbGFncyAmIFBURl9wcmVlbXB0aWJsZSwKLSAgICAgICAgIHBhcnRpYWxf
cmVmID0gZmxhZ3MgJiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiwKICAgICAg
ICAgIHBhcnRpYWxfc2V0ID0gZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQsCiAg
ICAgICAgICByZXRhaW5fcmVmICA9IGZsYWdzICYgUFRGX3JldGFpbl9yZWZf
b25fcmVzdGFydDsKIAotICAgIEFTU0VSVChwYXJ0aWFsX3JlZiA9PSBwYXJ0
aWFsX3NldCk7Ci0KLSAgICBpZiAoIGxpa2VseSghcGFydGlhbF9yZWYpICYm
CisgICAgaWYgKCBsaWtlbHkoIXBhcnRpYWxfc2V0KSAmJgogICAgICAgICAg
dW5saWtlbHkoIWdldF9wYWdlX2Zyb21fbWZuKG1mbiwgZCkpICkKICAgICAg
ICAgcmV0dXJuIC1FSU5WQUw7CiAKQEAgLTExMzEsMTQgKzExMjcsMTQgQEAg
c3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICAg
KiBSZXRhaW4gdGhlIHJlZmNvdW50IGlmOgogICAgICAqIC0gcGFnZSBpcyBm
dWxseSB2YWxpZGF0ZWQgKHJjID09IDApCiAgICAgICogLSBwYWdlIGlzIG5v
dCB2YWxpZGF0ZWQgKHJjIDwgMCkgYnV0OgotICAgICAqICAgLSBXZSBjYW1l
IGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfcmVmKQorICAgICAqICAg
LSBXZSBjYW1lIGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfc2V0KQog
ICAgICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgKHJjID09
IC1FUkVTVEFSVCksIGFuZCB0aGUKICAgICAgKiAgICAgY2FsbGVyIGhhcyBh
c2tlZCB0aGUgcmVmIHRvIGJlIHJldGFpbmVkIGluIHRoYXQgY2FzZQogICAg
ICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0IHRoZXJl
J3MgYmVlbiBhbiBlcnJvcgogICAgICAqICAgICAocGFnZSA9PSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkKICAgICAgKgotICAgICAqIFRoZSBw
YXJ0aWFsX3JlZi1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4gZXhwbGFu
YXRpb24uICBUaGVyZQotICAgICAqIGFyZSB0d28gc2NlbmFyaW9zIHdoZXJl
IHBhcnRpYWxfcmVmIG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgorICAgICAq
IFRoZSBwYXJ0aWFsX3NldC1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4g
ZXhwbGFuYXRpb24uICBUaGVyZQorICAgICAqIGFyZSB0d28gc2NlbmFyaW9z
IHdoZXJlIHBhcnRpYWxfc2V0IG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgog
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBwcm9tb3RlZCAvIGRl
bW90ZWQgYXMgdHlwZSBgdHlwZWA7CiAgICAgICogICBpLmUuIGhhcyBQR1Rf
cGFydGlhbCBzZXQKICAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkg
ZGVtb3RlZCBhcyBMKHR5cGUrMSkgKGkuZS4sIGEgbGluZWFyCkBAIC0xMTYx
LDcgKzExNTcsNyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKAogICAgICAqIGNvdW50IHJldGFpbmVkIHVubGVzcyB3ZSBzdWNj
ZWVkZWQsIG9yIHRoZSBvcGVyYXRpb24gd2FzCiAgICAgICogcHJlZW1wdGli
bGUuCiAgICAgICovCi0gICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFs
X3JlZiApCisgICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFsX3NldCAp
CiAgICAgICAgIC8qIG5vdGhpbmcgKi87CiAgICAgZWxzZSBpZiAoIHBhZ2Ug
PT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgfHwKICAgICAgICAg
ICAgICAgKHJldGFpbl9yZWYgJiYgcmMgPT0gLUVSRVNUQVJUKSApCkBAIC0x
MzU5LDEzICsxMzU1LDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wy
ZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBsMmVfZ2V0X3BhZ2UobDJlKTsK
ICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZyA9IG1mbl90b19wYWdl
KF9tZm4ocGZuKSk7CiAKLSAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQotICAg
ICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQotICAgICAgICB7Ci0gICAg
ICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBh
cnRpYWxfcmVmICovCi0gICAgICAgICAgICBCVUcoKTsKLSAgICAgICAgfQot
ICAgICAgICBlbHNlIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQorICAgICAg
ICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKICAgICAgICAgewogICAgICAg
ICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IHB0cGc7CiAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBn
OwpAQCAtMTQwNSwxMyArMTM5NSw2IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2Vf
ZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4s
CiAKICAgICBwZyA9IGwzZV9nZXRfcGFnZShsM2UpOwogCi0gICAgaWYgKCAo
ZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYpKSA9PQotICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKLSAgICB7
Ci0gICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdheXMgaW1wbHkg
cGFydGlhbF9yZWYgKi8KLSAgICAgICAgQlVHKCk7Ci0gICAgfQotCiAgICAg
aWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgewogICAgICAgICBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21mbihw
Zm4pKTsKQEAgLTE0MzYsMTMgKzE0MTksNiBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcg
cGZuLAogICAgIHsKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBs
NGVfZ2V0X3BhZ2UobDRlKTsKIAotICAgICAgICBpZiAoIChmbGFncyAmIChQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09
Ci0gICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCi0gICAgICAgIHsK
LSAgICAgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdheXMgaW1w
bHkgcGFydGlhbF9yZWYgKi8KLSAgICAgICAgICAgIEJVRygpOwotICAgICAg
ICB9Ci0KICAgICAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAg
ICAgIHsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0
cGcgPSBtZm5fdG9fcGFnZShfbWZuKHBmbikpOwpAQCAtMTY3Niw3ICsxNjUy
LDcgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICAvKiBTZXQgJ3NldCcs
IGxlYXZlICdnZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNl
dCAqLwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9w
YXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsK
ICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYm
IGkgKQogICAgICAgICB7CkBAIC0xODU5LDcgKzE4MzUsNyBAQCBzdGF0aWMg
aW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAg
ICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKICAgICAgICAgICAgIC8qIFNldCAnc2V0JywgbGVhdmUgJ2dlbmVy
YWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMgc2V0ICovCi0gICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CisgICAgICAgICAgICBwYWdlLT5w
YXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKQogICAgICAgICB7CkBAIC0xOTU2
LDcgKzE5MzIsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBlbHNlIGlmICggcmMgPT0gLUVSRVNU
QVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0
aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OwogICAgIH0K
ICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMMl9QQUdFVEFC
TEVfRU5UUklFUyAtIDEgKQogICAgIHsKQEAgLTIwMDQsNyArMTk4MCw3IEBA
IHN0YXRpYyBpbnQgZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAg
ICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFn
ZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gUFRGX3BhcnRpYWxfc2V0OwogICAgIH0KICAgICBlbHNlIGlmICggcmMg
PT0gLUVJTlRSICYmIGkgPCBMM19QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQog
ICAgIHsKQEAgLTIwMzUsNyArMjAxMSw3IEBAIHN0YXRpYyBpbnQgZnJlZV9s
NF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIGlmICggcmMg
PT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwor
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0
OwogICAgIH0KICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBM
NF9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQogICAgIHsKZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvbW0uaAppbmRleCAwMjA3OWUxMzI0Li5mMGZkMzViZjZiIDEwMDY0NAot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9tbS5oCkBAIC0yMzMsNyArMjMzLDcgQEAgc3RydWN0IHBh
Z2VfaW5mbwogICAgICAgICAgKiBvcGVyYXRpb24gb24gdGhlIGN1cnJlbnQg
cGFnZS4gIChUaGF0IHBhZ2UgbWF5IG9yIG1heSBub3QKICAgICAgICAgICog
c3RpbGwgaGF2ZSBQR1RfcGFydGlhbCBzZXQuKQogICAgICAgICAgKgotICAg
ICAgICAgKiBJZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcyBzZXQsIHRo
ZW4gdGhlIFBURSBhdAorICAgICAgICAgKiBBZGRpdGlvbmFsbHksIGlmIFBU
Rl9wYXJ0aWFsX3NldCBpcyBzZXQsIHRoZW4gdGhlIFBURSBhdAogICAgICAg
ICAgKiBAbnJfdmFsaWRhdGVkX3B0ZWYgaG9sZHMgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudCBmb3IgdGhlCiAgICAgICAgICAqIHBhZ2UuCiAgICAgICAg
ICAqCkBAIC0yNDIsMjMgKzI0MiwyMCBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAg
ICAgICAgICAqICAgaW50ZXJydXB0ZWQKICAgICAgICAgICogLSBEdXJpbmcg
dmFsaWRhdGlvbiwgaWYgYW4gaW52YWxpZCBlbnRyeSBpcyBlbmNvdW50ZXJl
ZCBhbmQKICAgICAgICAgICogICB2YWxpZGF0aW9uIGlzIHByZWVtcHRpYmxl
Ci0gICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIHdhcyBzZXQgb24KLSAgICAgICAgICogICB0aGlz
IGVudHJ5IHRvIGJlZ2luIHdpdGggKHBlcmhhcHMgYmVjYXVzZSBpdCBwaWNr
ZWQgdXAgYQorICAgICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBQ
VEZfcGFydGlhbF9zZXQgd2FzIHNldCBvbiB0aGlzCisgICAgICAgICAqICAg
ZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFwcyBiZWNhdXNlIGl0IHBpY2tl
ZCB1cCBhCiAgICAgICAgICAqICAgcHJldmlvdXMgb3BlcmF0aW9uKQogICAg
ICAgICAgKgotICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24s
IGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzCi0gICAgICAgICAqIGNs
ZWFyLCB0aGVuIGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1
aXJlZDsgaWYgaXQKLSAgICAgICAgICogaXMgc2V0LCBubyByZWZlcmVuY2Ug
c2hvdWxkIGJlIGFjcXVpcmVkLgorICAgICAgICAgKiBXaGVuIHJlc3VtaW5n
IHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX3NldCBpcyBjbGVhciwgdGhl
bgorICAgICAgICAgKiBhIGdlbmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUt
YWNxdWlyZWQ7IGlmIGl0IGlzIHNldCwgbm8KKyAgICAgICAgICogcmVmZXJl
bmNlIHNob3VsZCBiZSBhY3F1aXJlZC4KICAgICAgICAgICoKLSAgICAgICAg
ICogV2hlbiByZXN1bWluZyBkZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBpcwotICAgICAgICAgKiBjbGVhciwgbm8gcmVmZXJl
bmNlIHNob3VsZCBiZSBkcm9wcGVkOyBpZiBpdCBpcyBzZXQsIGEKLSAgICAg
ICAgICogcmVmZXJlbmNlIHNob3VsZCBiZSBkcm9wcGVkLgorICAgICAgICAg
KiBXaGVuIHJlc3VtaW5nIGRlLXZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFs
X3NldCBpcyBjbGVhciwKKyAgICAgICAgICogbm8gcmVmZXJlbmNlIHNob3Vs
ZCBiZSBkcm9wcGVkOyBpZiBpdCBpcyBzZXQsIGEgcmVmZXJlbmNlCisgICAg
ICAgICAqIHNob3VsZCBiZSBkcm9wcGVkLgogICAgICAgICAgKgotICAgICAg
ICAgKiBOQiBhdCB0aGUgbW9tZW50LCBQVEZfcGFydGlhbF9zZXQgc2hvdWxk
IGJlIHNldCBpZiBhbmQgb25seSBpZgotICAgICAgICAgKiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBpcyBzZXQuCi0gICAgICAgICAqCi0gICAgICAgICAq
IE5CIHRoYXQgUFRGX3BhcnRpYWxfc2V0IGFuZCBQVEZfcGFydGlhbF9nZW5l
cmFsX3JlZiBhcmUKLSAgICAgICAgICogZGVmaW5lZCBpbiBtbS5jLCB0aGUg
b25seSBwbGFjZSB3aGVyZSB0aGV5IGFyZSB1c2VkLgorICAgICAgICAgKiBO
QiB0aGF0IFBURl9wYXJ0aWFsX3NldCBpcyBkZWZpbmVkIGluIG1tLmMsIHRo
ZSBvbmx5IHBsYWNlCisgICAgICAgICAqIHdoZXJlIGl0IGlzIHVzZWQuCiAg
ICAgICAgICAqCiAgICAgICAgICAqIFRoZSAzcmQgZmllbGQsIEBsaW5lYXJf
cHRfY291bnQsIGluZGljYXRlcwogICAgICAgICAgKiAtIGJ5IGEgcG9zaXRp
dmUgdmFsdWUsIGhvdyBtYW55IHNhbWUtbGV2ZWwgcGFnZSB0YWJsZSBlbnRy
aWVzIGEgcGFnZQpAQCAtMjY4LDggKzI2NSw4IEBAIHN0cnVjdCBwYWdlX2lu
Zm8KICAgICAgICAgICovCiAgICAgICAgIHN0cnVjdCB7CiAgICAgICAgICAg
ICB1MTYgbnJfdmFsaWRhdGVkX3B0ZXM6UEFHRVRBQkxFX09SREVSICsgMTsK
LSAgICAgICAgICAgIHUxNiA6MTYgLSBQQUdFVEFCTEVfT1JERVIgLSAxIC0g
MjsKLSAgICAgICAgICAgIHUxNiBwYXJ0aWFsX2ZsYWdzOjI7CisgICAgICAg
ICAgICB1MTYgOjE2IC0gUEFHRVRBQkxFX09SREVSIC0gMSAtIDE7CisgICAg
ICAgICAgICB1MTYgcGFydGlhbF9mbGFnczoxOwogICAgICAgICAgICAgczE2
IGxpbmVhcl9wdF9jb3VudDsKICAgICAgICAgfTsKIAotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Transfer-Encoding: base64

RnJvbSBkYTNkMWQyNThlNTRmZTYwMGY3Zjc1Mjg3MTgzYjc0ZDk1N2VjNjNi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA5LzExXSB4
ODYvbW06IFByb3Blcmx5IGhhbmRsZSBsaW5lYXIgcGFnZXRhYmxlIHByb21v
dGlvbgogZmFpbHVyZXMKCkluIG9yZGVyIHRvIGFsbG93IHJlY3Vyc2l2ZSBw
YWdldGFibGUgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIHRvIGJlCmludGVy
cnVwdGVkLCBYZW4gbXVzdCBrZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0
aGUgc3ViLXBhZ2VzCnByb21vdGVkIG9yIGRlbW90ZWQuICBUaGlzIGlzIHN0
b3JlZCBpbiB0d28gZWxlbWVudHMgaW4gdGhlIHBhZ2UKc3RydWN0OiBucl9l
bnRyaWVzX3ZhbGlkYXRlZCBhbmQgcGFydGlhbF9mbGFncy4KClRoZSBydWxl
IGlzIHRoYXQgZW50cmllcyBbMCwgbnJfZW50cmllc192YWxpZGF0ZWQpIHNo
b3VsZCBhbHdheXMgYmUKdmFsaWRhdGVkIGFuZCBob2xkIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgY291bnQuICBJZiBwYXJ0aWFsX2ZsYWdzIGlzCnplcm8sIHRo
ZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXSBpcyBub3QgdmFsaWRhdGVkIGFu
ZCBubyByZWZlcmVuY2UKY291bnQgaXMgaGVsZC4gIElmIFBURl9wYXJ0aWFs
X3NldCBpcyBzZXQsIHRoZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXQppcyBw
YXJ0aWFsbHkgdmFsaWRhdGVkLCBhbmQgYSBnZW5lcmFsIHJlZmVyZW5jZSBj
b3VudCBpcyBoZWxkLgoKVW5mb3J0dW5hdGVseSwgaW4gY2FzZXMgd2hlcmUg
YW4gZW50cnkgYmVnYW4gd2l0aCBQVEZfcGFydGlhbF9zZXQgc2V0LAphbmQg
Z2V0X3BhZ2VfZnJvbV9sTmUoKSByZXR1cm5zIC1FSU5WQUwsIHRoZSBQVEZf
cGFydGlhbF9zZXQgYml0IGlzCmVycm9uZW91c2x5IGRyb3BwZWQuICAoVGhp
cyBzY2VuYXJpbyBjYW4gYmUgZW5naW5lZXJlZCBtYWlubHkgYnkgdGhlCnVz
ZSBvZiBpbnRlcmxlYXZpbmcgb2YgcHJvbW90aW5nIGFuZCBkZW1vdGluZyBh
IHBhZ2Ugd2hpY2ggaGFzICJsaW5lYXIKcGFnZXRhYmxlIiBlbnRyaWVzOyBz
ZWUgdGhlIGFwcGVuZGl4IGZvciBhIHNrZXRjaC4pICBUaGlzIG1lYW5zIHRo
YXQKd2Ugd2lsbCAibGVhayIgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBv
biB0aGUgcGFnZSBpbiBxdWVzdGlvbiwKcHJldmVudGluZyB0aGUgcGFnZSBm
cm9tIGJlaW5nIGZyZWVkLgoKRml4IHRoaXMgYnkgc2V0dGluZyBwYWdlLT5w
YXJ0aWFsX2ZsYWdzIHRvIHRoZSBwYXJ0aWFsX2ZsYWdzIGxvY2FsCnZhcmlh
YmxlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTkuCgpSZXBvcnRlZC1ieTog
R2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+Ci0tLS0tCkFwcGVuZGl4CgpTdXBwb3NlIEEgYW5kIEIgY2FuIGJv
dGggYmUgcHJvbW90ZWQgdG8gTDIgcGFnZXMsIGFuZCBBW3hdIHBvaW50cyB0
byBCLgoKVjE6IFBJTl9MMiBCLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1Rf
dmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkCgpWMTog
TU9EX0wzX0VOVFJZIHBvaW50aW5nIHNvbWV0aGluZyB0byBBLgogIEluIHRo
ZSBwcm9jZXNzIG9mIHZhbGlkYXRpbmcgQVt4XSwgZ3JhYiBhbiBleHRyYSB0
eXBlIC8gcmVmIG9uIEI6CiAgQi50eXBlX2NvdW50ID0gMiB8IFBHVF92YWxp
ZGF0ZWQKICBCLmNvdW50ID0gMyB8IFBHQ19hbGxvY2F0ZWQKICBBLnR5cGVf
Y291bnQgPSAxIHwgUEdUX3ZhbGlkYXRlZAogIEEuY291bnQgPSAyIHwgUEdD
X2FsbG9jYXRlZAoKVjE6IFVOUElOIEIuCiAgQi50eXBlX2NvdW50ID0gMSB8
IFBHVF92YWxpZGF0ZQogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAoK
VjE6IE1PRF9MM19FTlRSWSByZW1vdmluZyB0aGUgcmVmZXJlbmNlIHRvIEEu
CiAgRGUtdmFsaWRhdGUgQSwgZG93biB0byBBW3hdLCB3aGljaCBwb2ludHMg
dG8gQi4KICBEcm9wIHRoZSBmaW5hbCB0eXBlIG9uIEIuICBBcnJhbmdlIHRv
IGJlIGludGVycnVwdGVkLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFy
dGlhbAogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAogIEEudHlwZV9j
b3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFsaWRhdGVkX2VudHJp
ZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IC0xCgpWMjogTU9EX0wzX0VOVFJZ
IGFkZHMgYSByZWZlcmVuY2UgdG8gQS4KCkF0IHRoaXMgcG9pbnQsIGdldF9w
YWdlX2Zyb21fbDJlKEFbeF0pIHRyaWVzCmdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKCksIHdoaWNoIGZhaWxzIGJlY2F1c2UgaXQncyB0aGUgd3Jvbmcg
dHlwZTsKYW5kIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKCkgYWxzbyBmYWls
cywgYmVjYXVzZSBCIGlzbid0IHZhbGlkYXRlZCBhcwphbiBsMiBhbnltb3Jl
LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNiArKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCA4ODZlOTNiOGFhLi4wYTA5NDI5MWRhIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTU4MSw3ICsxNTgxLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAg
ICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKKyAgICAgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKICAg
ICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
TlVMTDsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSA9IHBhZ2U7CiAgICAgICAgICAgICB9CkBAIC0xNjc0LDcgKzE2
NzQsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIGlmICggaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOworICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKICAgICAgICAgfQpAQCAtMTg0NSw3ICsxODQ1LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CisgICAgICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAg
ICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBlbHNl
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Transfer-Encoding: base64

RnJvbSBiM2UxNjlkYzhkYWVhZTg1YjBiNTFjMjVmZGIxNDJlMmU1NTJlYzdm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDEwLzExXSB4
ODYvbW06IEZpeCBuZXN0ZWQgZGUtdmFsaWRhdGlvbiBvbiBlcnJvcgoKSWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBkaXNjb3ZlcmVkIHdoZW4gdmFsaWRhdGlu
ZyBhIHBhZ2UtdGFibGUgdHJlZSwKdGhlIGVudGlyZSB0cmVlIHdoaWNoIGhh
cyBzbyBmYXIgYmVlbiB2YWxpZGF0ZWQgbXVzdCBiZSBkZS12YWxpZGF0ZWQu
ClNpbmNlIHRoaXMgbWF5IHRha2UgYSBsb25nIHRpbWUsIGFsbG9jX2xbMi00
XV90YWJsZSgpIHNldCBjdXJyZW50CnZjcHUncyBvbGRfZ3Vlc3RfdGFibGUg
aW1tZWRpYXRlbHk7IHB1dF9vbGRfZ3Vlc3RfdGFibGUoKSB3aWxsIG1ha2UK
c3VyZSB0aGF0IHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxlZCB0byBm
aW5pc2ggb2ZmIHRoZQpkZS12YWxpZGF0aW9uIGJlZm9yZSBhbnkgb3RoZXIg
TU1VIG9wZXJhdGlvbnMgY2FuIGhhcHBlbiBvbiB0aGUgdmNwdS4KClRoZSBp
bnZhcmlhbnQgZm9yIHBhcnRpYWwgcGFnZXMgc2hvdWxkIGJlOgoKKiBFbnRy
aWVzIFswLCBucl92YWxpZGF0ZWRfcHRlcykgc2hvdWxkIGJlIGNvbXBsZXRl
bHkgdmFsaWRhdGVkOwogIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGRlLXZhbGlk
YXRlIHRoZXNlLgoKKiBJZiBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHBhcnRp
YWxseSB2YWxpZGF0ZWQsIHBhcnRpYWxfZmxhZ3Mgc2hvdWxkCiAgc2V0IFBU
Rl9wYXJ0aWFMX3NldC4gIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxl
ZCBvbiB0aGlzIHBhZ2UgdG8KICBmaW5pc2ggb2ZmIGRldmFsaWRhdGlvbiwg
YW5kIHRoZSBhcHByb3ByaWF0ZSByZWZjb3VudCBhZGp1c3RtZW50cwogIHdp
bGwgYmUgZG9uZS4KCmFsbG9jX2xbMi0zXV90YWJsZSgpIGluZGljYXRlcyBw
YXJ0aWFsIHZhbGlkYXRpb24gdG8gaXRzIGNhbGxlcnMgYnkKc2V0dGluZyBj
dXJyZW50LT5vbGRfZ3Vlc3RfdGFibGUuCgpVbmZvcnR1bmF0ZWx5LCB0aGlz
IGlzIG1pc2hhbmRsZWQuCgpUYWtlIHRoZSBjYXNlIHdoZXJlIHZhbGlkYXRp
bmcgbE5lW3hdIHJldHVybnMgYW4gZXJyb3IuCgpGaXJzdCwgYWxsb2NfbDNf
dGFibGUoKSBkb2Vzbid0IGNoZWNrIG9sZF9ndWVzdF90YWJsZSBhdCBhbGw7
IGFzIGEKcmVzdWx0LCBwYXJ0aWFsX2ZsYWdzIGlzIG5vdCBzZXQgd2hlbiBp
dCBzaG91bGQgYmUuICBucl92YWxpZGF0ZWRfcHRlcwppcyBzZXQgdG8geDsg
YW5kIHNpbmNlIFBGVF9wYXJ0aWFsX3NldCBjbGVhciwgZGUtdmFsaWRhdGlv
biByZXN1bWVzIGF0Cm5yX3ZhbGlkYXRlZF9wdGVzLTEuICBUaGlzIG1lYW5z
IHRoYXQgdGhlIGwyIHBhZ2UgYXQgcGwzZVt4XSB3aWxsIG5vdApoYXZlIHB1
dF9wYWdlX3R5cGUoKSBjYWxsZWQgb24gaXQgd2hlbiBkZS12YWxpZGF0aW5n
IHRoZSByZXN0IG9mIHRoZQpsMzogaXQgd2lsbCBiZSBzdHVjayBpbiB0aGUg
UEdUX3BhcnRpYWwgc3RhdGUgdW50aWwgdGhlIGRvbWFpbiBpcwpkZXN0cm95
ZWQsIG9yIHVudGlsIGl0IGlzIHJlLXVzZWQgYXMgYW4gbDIuICAoQW55IG90
aGVyIHBhZ2UgdHlwZSB3aWxsCmZhaWwuKQoKV29yc2UsIGFsbG9jX2w0X3Rh
YmxlKCksIHJhdGhlciB0aGFuIHNldHRpbmcgUFRGX3BhcnRpYWxfc2V0IGFz
IGl0CnNob3VsZCwgc2V0cyBucl92YWxpZGF0ZWRfcHRlcyB0byB4KzEuICBX
aGVuIGRlLXZhbGlkYXRpbmcsIHNpbmNlCnBhcnRpYWwgaXMgMCwgdGhpcyB3
aWxsIGNvcnJlY3RseSByZXN1bWUgY2FsbGluZyBwdXRfcGFnZV90eXBlIGF0
IFt4XTsKYnV0LCBpZiB0aGUgcHV0X3BhZ2VfdHlwZSgpIGlzIG5ldmVyIGNh
bGxlZCwgYnV0IGluc3RlYWQKZ2V0X3BhZ2VfdHlwZSgpIGlzIGNhbGxlZCwg
dmFsaWRhdGlvbiB3aWxsIHBpY2sgdXAgYXQgW3grMV0sCm5lZ2xlY3Rpbmcg
dG8gdmFsaWRhdGUgW3hdLiAgSWYgdGhlIHJlc3Qgb2YgdGhlIHZhbGlkYXRp
b24gc3VjY2VlZHMsCnRoZSBsNCB3aWxsIGJlIHZhbGlkYXRlZCBldmVuIHRo
b3VnaCBbeF0gaXMgaW52YWxpZC4KCkZpeCB0aGlzIGluIGJvdGggY2FzZXMg
Ynkgc2V0dGluZyBQVEZfcGFydGlhbF9zZXQgaWYgb2xkX2d1ZXN0X3RhYmxl
CmlzIHNldC4KCldoaWxlIGhlcmUsIGFkZCBzb21lIHNhZmV0eSBjYXRjaGVz
OgotIG9sZF9ndWVzdF90YWJsZSBtdXN0IHBvaW50IHRvIHRoZSBwYWdlIGNv
bnRhaW5lZCBpbgogIFtucl92YWxpZGF0ZWRfcHRlc10uCi0gYWxsb2NfbDFf
cGFnZSBzaG91bGRuJ3Qgc2V0IG9sZF9ndWVzdF90YWJsZQoKSWYgd2UgZXhw
ZXJpZW5jZSBvbmUgb2YgdGhlc2Ugc2l0dWF0aW9ucyBpbiBwcm9kdWN0aW9u
IGJ1aWxkcywgaXQncwpzYWZlciB0byBhdm9pZCBjYWxsaW5nIHB1dF9wYWdl
X3R5cGUgZm9yIHRoZSBwYWdlcyBpbiBxdWVzdGlvbi4gIElmCnRoZXkgaGF2
ZSBQR1RfcGFydGlhbCBzZXQsIHRoZXkgd2lsbCBiZSBjbGVhbmVkIHVwIG9u
IGRvbWFpbgpkZXN0cnVjdGlvbjsgaWYgbm90LCB3ZSBoYXZlIG5vIGlkZWEg
d2hldGhlciBhIHR5cGUgY291bnQgaXMgc2FmZSB0bwpkcm9wLiAgUmV0YWlu
aW5nIGFuIGV4dHJhIHR5cGUgcmVmIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBk
cm9wcGVkIG1heQp0cmlnZ2VyIGEgQlVHKCkgb24gdGhlIGZyZWVfZG9tYWlu
X3BhZ2UoKSBwYXRoLCBidXQgZHJvcHBpbmcgYSB0eXBlCmNvdW50IHRoYXQg
c2hvdWxkbid0IGJlIGRyb3BwZWQgbWF5IGNhdXNlIGEgcHJpdmlsZWdlIGVz
Y2FsYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDUzICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAx
IGZpbGUgY2hhbmdlZCwgNTEgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNo
L3g4Ni9tbS5jCmluZGV4IDBhMDk0MjkxZGEuLmE0MzJlNjljNzQgMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCkBAIC0xNTgwLDYgKzE1ODAsMjAgQEAgc3RhdGljIGludCBhbGxvY19s
Ml90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25n
IHR5cGUpCiAgICAgICAgICAgICBBU1NFUlQoY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfdGFibGUgPT0gTlVMTCk7CiAgICAgICAgICAgICBpZiAoIGkgKQog
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAg
ICAgICAgICogYWxsb2NfbDFfdGFibGUoKSBkb2Vzbid0IHNldCBvbGRfZ3Vl
c3RfdGFibGU7IGl0IGRvZXMKKyAgICAgICAgICAgICAgICAgKiBpdHMgb3du
IHRlYXItZG93biBpbW1lZGlhdGVseSBvbiBmYWlsdXJlLiAgSWYgaXQKKyAg
ICAgICAgICAgICAgICAgKiBkaWQgd2UnZCBuZWVkIHRvIGNoZWNrIGl0IGFu
ZCBzZXQgcGFydGlhbF9mbGFncyBhcyB3ZQorICAgICAgICAgICAgICAgICAq
IGRvIGluIGFsbG9jX2xbMzRdX3RhYmxlKCkuCisgICAgICAgICAgICAgICAg
ICoKKyAgICAgICAgICAgICAgICAgKiBOb3RlIG9uIHRoZSB1c2Ugb2YgQVNT
RVJUOiBpZiBpdCdzIG5vbi1udWxsIGFuZAorICAgICAgICAgICAgICAgICAq
IGhhc24ndCBiZWVuIGNsZWFuZWQgdXAgeWV0LCBpdCBzaG91bGQgaGF2ZQor
ICAgICAgICAgICAgICAgICAqIFBHVF9wYXJ0aWFsIHNldDsgYW5kIHNvIHRo
ZSB0eXBlIHdpbGwgYmUgY2xlYW5lZCB1cAorICAgICAgICAgICAgICAgICAq
IG9uIGRvbWFpbiBkZXN0cnVjdGlvbi4gIFVuZm9ydHVuYXRlbHksIHdlIHdv
dWxkCisgICAgICAgICAgICAgICAgICogbGVhayB0aGUgZ2VuZXJhbCByZWYg
aGVsZCBieSBvbGRfZ3Vlc3RfdGFibGU7IGJ1dAorICAgICAgICAgICAgICAg
ICAqIGxlYWtpbmcgYSBwYWdlIGlzIGxlc3MgYmFkIHRoYW4gYSBob3N0IGNy
YXNoLgorICAgICAgICAgICAgICAgICAqLworICAgICAgICAgICAgICAgIEFT
U0VSVChjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBOVUxMKTsK
ICAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7
CiAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRp
YWxfZmxhZ3M7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CkBAIC0xNjA3LDYgKzE2MjEsNyBAQCBzdGF0
aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgdW5zaWduZWQgaW50ICAgaTsKICAgICBpbnQgICAgICAgICAgICBy
YyA9IDA7CiAgICAgdW5zaWduZWQgaW50ICAgcGFydGlhbF9mbGFncyA9IHBh
Z2UtPnBhcnRpYWxfZmxhZ3M7CisgICAgbDNfcGdlbnRyeV90ICAgbDNlID0g
bDNlX2VtcHR5KCk7CiAKICAgICBwbDNlID0gbWFwX2RvbWFpbl9wYWdlKF9t
Zm4ocGZuKSk7CiAKQEAgLTE2MjMsNyArMTYzOCw3IEBAIHN0YXRpYyBpbnQg
YWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBm
b3IgKCBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMM19QQUdF
VEFCTEVfRU5UUklFUzsKICAgICAgICAgICBpKyssIHBhcnRpYWxfZmxhZ3Mg
PSAwICkKICAgICB7Ci0gICAgICAgIGwzX3BnZW50cnlfdCBsM2UgPSBwbDNl
W2ldOworICAgICAgICBsM2UgPSBwbDNlW2ldOwogCiAgICAgICAgIGlmICgg
aSA+IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVl
bXB0X2NoZWNrKCkgKQogICAgICAgICAgICAgcmMgPSAtRUlOVFI7CkBAIC0x
Njc1LDYgKzE2OTAsMjQgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICB7CiAgICAgICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKKyAgICAgICAg
ICAgIGlmICggY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQorICAg
ICAgICAgICAgeworICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAg
ICAgICogV2UndmUgZXhwZXJpZW5jZWQgYSB2YWxpZGF0aW9uIGZhaWx1cmUu
ICBJZgorICAgICAgICAgICAgICAgICAqIG9sZF9ndWVzdF90YWJsZSBpcyBz
ZXQsICJ0cmFuc2ZlciIgdGhlIGdlbmVyYWwKKyAgICAgICAgICAgICAgICAg
KiByZWZlcmVuY2UgY291bnQgdG8gcGwzZVtucl92YWxpZGF0ZWRfcHRlc10g
YnkKKyAgICAgICAgICAgICAgICAgKiBzZXR0aW5nIFBURl9wYXJ0aWFsX3Nl
dC4KKyAgICAgICAgICAgICAgICAgKgorICAgICAgICAgICAgICAgICAqIEFz
IGEgcHJlY2F1dGlvbiwgY2hlY2sgdGhhdCBvbGRfZ3Vlc3RfdGFibGUgaXMg
dGhlCisgICAgICAgICAgICAgICAgICogcGFnZSBwb2ludGVkIHRvIGJ5IHBs
M2VbbnJfdmFsaWRhdGVkX3B0ZXNdLiAgSWYKKyAgICAgICAgICAgICAgICAg
KiBub3QsIGl0J3Mgc2FmZXIgdG8gbGVhayBhIHR5cGUgcmVmIG9uIHByb2R1
Y3Rpb24KKyAgICAgICAgICAgICAgICAgKiBidWlsZHMuCisgICAgICAgICAg
ICAgICAgICovCisgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBsM2VfZ2V0X3BhZ2UobDNlKSApCisgICAg
ICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFy
dGlhbF9zZXQ7CisgICAgICAgICAgICAgICAgZWxzZQorICAgICAgICAgICAg
ICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICAgICAgICAgIH0K
ICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBO
VUxMOwogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgPSBwYWdlOwogICAgICAgICB9CkBAIC0xODUxLDcgKzE4ODQsMjMgQEAg
c3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfdGFibGUgKQotICAgICAgICAgICAgICAgICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMrKzsKKyAgICAgICAgICAgICAgICAgICAgewor
ICAgICAgICAgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAqIFdlJ3ZlIGV4cGVyaWVuY2VkIGEgdmFsaWRhdGlvbiBmYWls
dXJlLiAgSWYKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIG9sZF9ndWVz
dF90YWJsZSBpcyBzZXQsICJ0cmFuc2ZlciIgdGhlIGdlbmVyYWwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAqIHJlZmVyZW5jZSBjb3VudCB0byBwbDNl
W25yX3ZhbGlkYXRlZF9wdGVzXSBieQorICAgICAgICAgICAgICAgICAgICAg
ICAgICogc2V0dGluZyBQVEZfcGFydGlhbF9zZXQuCisgICAgICAgICAgICAg
ICAgICAgICAgICAgKgorICAgICAgICAgICAgICAgICAgICAgICAgICogQXMg
YSBwcmVjYXV0aW9uLCBjaGVjayB0aGF0IG9sZF9ndWVzdF90YWJsZSBpcyB0
aGUKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIHBhZ2UgcG9pbnRlZCB0
byBieSBwbDRlW25yX3ZhbGlkYXRlZF9wdGVzXS4gIElmCisgICAgICAgICAg
ICAgICAgICAgICAgICAgKiBub3QsIGl0J3Mgc2FmZXIgdG8gbGVhayBhIHR5
cGUgcmVmIG9uIHByb2R1Y3Rpb24KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAqIGJ1aWxkcy4KKyAgICAgICAgICAgICAgICAgICAgICAgICAqLworICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9PSBsNGVfZ2V0X3BhZ2UobDRlKSApCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9w
YXJ0aWFsX3NldDsKKyAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUo
KTsKKyAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAg
ICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUg
PSBwYWdlOwogICAgICAgICAgICAgICAgIH0KLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299-4.12/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Disposition: attachment;
 filename="xsa299-4.12/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Transfer-Encoding: base64

RnJvbSBlYTNkYzYyNGM1ZTYzMjVhOWMyZjA3OWU1MmE4NTk2NWQ0YWI2Y2U4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NTAgKzAxMDAKU3ViamVjdDogW1BBVENIIDExLzExXSB4
ODYvbW06IERvbid0IGRyb3AgYSB0eXBlIHJlZiB1bmxlc3MgeW91IGhlbGQg
YSByZWYgdG8KIGJlZ2luIHdpdGgKClZhbGlkYXRpb24gYW5kIGRlLXZhbGlk
YXRpb24gb2YgcGFnZXRhYmxlIHRyZWVzIG1heSB0YWtlIGFyYml0cmFyaWx5
CmxhcmdlIGFtb3VudHMgb2YgdGltZSwgYW5kIHNvIG11c3QgYmUgcHJlZW1w
dGlibGUuICBUaGlzIGlzIGluZGljYXRlZApieSBzZXR0aW5nIHRoZSBQR1Rf
cGFydGlhbCBiaXQgaW4gdGhlIHR5cGVfaW5mbywgYW5kIHNldHRpbmcKbnJf
dmFsaWRhdGVkX2VudHJpZXMgYW5kIHBhcnRpYWxfZmxhZ3MgYXBwcm9wcmlh
dGVseS4gIFNwZWNpZmljYWxseSwKaWYgdGhlIGVudHJ5IGF0IFtucl92YWxp
ZGF0ZWRfZW50cmllc10gaXMgcGFydGlhbGx5IHZhbGlkYXRlZCwKcGFydGlh
bF9mbGFncyBzaG91bGQgaGF2ZSB0aGUgUEdUX3BhcnRpYWxfc2V0IGJpdCBz
ZXQsIGFuZCB0aGUgZW50cnkKc2hvdWxkIGhvbGQgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudC4gIER1cmluZyBkZS12YWxpZGF0aW9uLApwdXRfcGFnZV90
eXBlKCkgaXMgY2FsbGVkIG9uIHBhcnRpYWxseSB2YWxpZGF0ZWQgZW50cmll
cy4KClVuZm9ydHVuYXRlbHksIHRoZXJlIGFyZSBhIG51bWJlciBvZiBpc3N1
ZXMgd2l0aCB0aGUgY3VycmVudCBhbGdvcml0aG0uCgpGaXJzdCwgZG9pbmcg
YSAibm9ybWFsIiBwdXRfcGFnZV90eXBlKCkgaXMgbm90IHNhZmUgd2hlbiBu
byB0eXBlIHJlZgppcyBoZWxkOiB0aGVyZSBpcyBub3RoaW5nIHRvIHN0b3Ag
YW5vdGhlciB2Y3B1IGZyb20gY29taW5nIGFsb25nIGFuZApwaWNraW5nIHVw
IHZhbGlkYXRpb24gYWdhaW46IGF0IHdoaWNoIHBvaW50IHRoZSBwdXRfcGFn
ZV90eXBlIG1heSBkcm9wCnRoZSBvbmx5IHBhZ2UgcmVmIG9uIGFuIGluLXVz
ZSBwYWdlLiAgU29tZSBleGFtcGxlcyBhcmUgbGlzdGVkIGluIHRoZQphcHBl
bmRpeC4KClRoZSBjb3JlIGlzc3VlIGlzIHRoYXQgcHV0X3BhZ2VfdHlwZSgp
IGlzIGJlaW5nIGNhbGxlZCBib3RoIHRvIGNsZWFuCnVwIFBHVF9wYXJ0aWFs
LCBhbmQgdG8gZHJvcCBhIHR5cGUgY291bnQ7IGFuZCBoYXMgbm8gd2F5IG9m
IGtub3dpbmcKd2hpY2ggaXMgd2hpY2g7IGFuZCBzbyBpZiBpbiBiZXR3ZWVu
LCBQR1RfcGFydGlhbCBpcyBjbGVhcmVkLApwdXRfcGFnZV90eXBlKCkgd2ls
bCBkcm9wIHRoZSB0eXBlIHJlZiBlcnJvbmVvdXNseS4KCldoYXQgaXMgbmVl
ZGVkIGlzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIHN0YXRlczoKLSBE
cm9wcGluZyBhIHR5cGUgcmVmIHdoaWNoIGlzIGhlbGQKLSBDbGVhbmluZyB1
cCBhIHBhZ2Ugd2hpY2ggaGFzIGJlZW4gcGFydGlhbGx5IGRlL3ZhbGlkYXRl
ZAoKRml4IHRoaXMgYnkgdGVsbGluZyBwdXRfcGFnZV90eXBlKCkgd2hpY2gg
b2YgdGhlIHR3byBhY3Rpdml0aWVzIHlvdQppbnRlbmQuCgpXaGVuIGNsZWFu
aW5nIHVwIGEgcGFydGlhbCBkZS92YWxpZGF0aW9uLCB0YWtlIG5vIGFjdGlv
biB1bmxlc3MgeW91CmZpbmQgYSBwYWdlIHBhcnRpYWxseSB2YWxpZGF0ZWQu
CgpJZiBwdXRfcGFnZV90eXBlKCkgaXMgY2FsbGVkIHdpdGhvdXQgUFRGX3Bh
cnRpYWxfc2V0LCBhbmQgZmluZHMgdGhlCnBhZ2UgaW4gYSBQR1RfcGFydGlh
bCBzdGF0ZSBhbnl3YXksIHRoZW4gdGhlcmUncyBjZXJ0YWlubHkgYmVlbiBh
Cm1pc2FjY291bnRpbmcgc29tZXdoZXJlLCBhbmQgY2Fycnlpbmcgb24gd291
bGQgYWxtb3N0IGNlcnRhaW5seSBjYXVzZQphIHNlY3VyaXR5IGlzc3VlLCBz
byBjcmFzaCB0aGUgaG9zdCBpbnN0ZWFkLgoKSW4gcHV0X3BhZ2VfZnJvbV9s
TmUsIHBhc3MgcGFydGlhbF9mbGFncyBvbiB0byBfcHV0X3BhZ2VfdHlwZSgp
LgoKb2xkX2d1ZXN0X3RhYmxlIG1heSBiZSBzZXQgZWl0aGVyIHdpdGggYSBm
dWxseSB2YWxpZGF0ZWQgcGFnZSAod2hlbgp1c2luZyB0aGUgImRlZmVycmVk
IHB1dCIgcGF0dGVybiksIG9yIHdpdGggYSBwYXJ0aWFsbHkgdmFsaWRhdGVk
IHBhZ2UKKHdoZW4gYSBub3JtYWwgImRlLXZhbGlkYXRpb24iIGlzIGludGVy
cnVwdGVkLCBvciB3aGVuIGEgdmFsaWRhdGlvbgpmYWlscyBwYXJ0LXdheSB0
aHJvdWdoIGR1ZSB0byBpbnZhbGlkIGVudHJpZXMpLiAgQWRkIGEgZmxhZywK
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwsIHRvIGluZGljYXRlIHdoaWNoIG9m
IHRoZXNlIGl0IGlzLCBhbmQgdXNlCnRoYXQgdG8gcGFzcyB0aGUgYXBwcm9w
cmlhdGUgZmxhZyB0byBfcHV0X3BhZ2VfdHlwZSgpLgoKV2hpbGUgaGVyZSwg
ZGVsZXRlIHN0cmF5IHRyYWlsaW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tLS0KQXBw
ZW5kaXg6CgpTdXBwb3NlIHBhZ2UgQSwgd2hlbiBpbnRlcnByZXRlZCBhcyBh
biBsMyBwYWdldGFibGUsIGNvbnRhaW5zIGFsbAp2YWxpZCBlbnRyaWVzOyBh
bmQgc3VwcG9zZSBBW3hdIHBvaW50cyB0byBwYWdlIEIsIHdoaWNoIHdoZW4K
aW50ZXJwcmV0ZWQgYXMgYW4gbDIgcGFnZXRhYmxlLCBjb250YWlucyBhbGwg
dmFsaWQgZW50cmllcy4KClAxOiBQSU5fTDNfVEFCTEUKICBBIC0+IFBHVF9s
M190YWJsZSB8IDEgfCB2YWxpZAogIEIgLT4gUEdUX2wyX3RhYmxlIHwgMSB8
IHZhbGlkCgpQMTogVU5QSU5fVEFCTEUKICA+IEFycmFuZ2UgdG8gaW50ZXJy
dXB0IGFmdGVyIEIgaGFzIGJlZW4gZGUtdmFsaWRhdGVkCiAgQjoKICAgIHR5
cGVfaW5mbyAtPiBQR1RfbDJfdGFibGUgfCAwCiAgQToKICAgIHR5cGVfaW5m
byAtPiBQR1RfbDNfdGFibGUgfCAxIHwgcGFydGlhbAogICAgbnJfdmFsaWRh
dGVkX2VudGllcyAtPiAobGVzcyB0aGFuIHgpCgpQMjogbW9kX2w0X2VudHJ5
IHRvIHBvaW50IHRvIEEKICA+IEFycmFuZ2UgZm9yIHRoaXMgdG8gYmUgaW50
ZXJydXB0ZWQgd2hpbGUgQiBpcyBiZWluZyB2YWxpZGF0ZWQKICBCOgogICAg
dHlwZV9pbmZvIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBwYXJ0aWFsCiAgICAo
bnJfdmFsaWRhdGVkX2VudGlyZXMgJmMgc2V0IGFzIGFwcHJvcHJpYXRlKQog
IEE6CiAgICB0eXBlX2luZm8gLT4gUEdUX2wzX3RhYmxlIHwgMSB8IHBhcnRp
YWwKICAgIG5yX3ZhbGlkYXRlZF9lbnRyaWVzIC0+IHgKICAgIHBhcnRpYWxf
cHRlID0gMQoKUDM6IG1vZF9sM19lbnRyeSBzb21lIG90aGVyIHVucmVsYXRl
ZCBsMyB0byBwb2ludCB0byBCOgogIEI6CiAgICB0eXBlX2luZm8gLT4gUEdU
X2wyX3RhYmxlIHwgMQoKUDE6IFJlc3RhcnQgVU5QSU5fVEFCTEUKCkF0IHRo
aXMgcG9pbnQsIHNpbmNlIEEubnJfdmFsaWRhdGVfZW50cmllcyA9PSB4IGFu
ZCBBLnBhcnRpYWxfcHRlICE9CjAsIGZyZWVfbDNfdGFibGUoKSB3aWxsIGNh
bGwgcHV0X3BhZ2VfZnJvbV9sM2UoKSBvbiBwbDNlW3hdLCBkcm9wcGluZwpp
dHMgdHlwZSBjb3VudCB0byAwIHdoaWxlIGl0J3Mgc3RpbGwgYmVpbmcgcG9p
bnRlZCB0byBieSBzb21lIG90aGVyIGwzCgpBIHNpbWlsYXIgaXNzdWUgYXJp
c2VzIHdpdGggb2xkX2d1ZXN0X3RhYmxlLiAgQ29uc2lkZXIgdGhlIGZvbGxv
d2luZwpzY2VuYXJpbzoKClN1cHBvc2UgQSBpcyBhIHBhZ2Ugd2hpY2gsIHdo
ZW4gaW50ZXJwcmV0ZWQgYXMgYW4gbDIsIGhhcyB2YWxpZCBlbnRyaWVzCnVu
dGlsIGVudHJ5IHgsIHdoaWNoIGlzIGludmFsaWQuCgpWMTogIFBJTl9MMl9U
QUJMRShBKQogIDxWYWxpZGF0ZSB1bnRpbCB3ZSB0cnkgdG8gdmFsaWRhdGUg
W3hdLCBnZXQgLUVJTlZBTD4KICBBIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBQ
R1RfcGFydGlhbAogIFYxIC0+IG9sZF9ndWVzdF90YWJsZSA9IEEKICA8ZGVs
YXllZD4KClYyOiBQSU5fTDJfVEFCTEUoQSkKICA8UGljayB1cCB3aGVyZSBW
MSBsZWZ0IG9mZiwgdHJ5IHRvIHJlLXZhbGlkYXRlIFt4XSwgZ2V0IC1FSU5W
QUw+CiAgQSAtPiBQR1RfbDJfdGFibGUgfCAxIHwgUEdUX3BhcnRpYWwKICBW
MiAtPiBvbGRfZ3Vlc3RfdGFibGUgPSBBCiAgPHJlc3RhcnQ+CiAgcHV0X29s
ZF9ndWVzdF90YWJsZSgpCiAgICBfcHV0X3BhZ2VfdHlwZShBKQogICAgICBB
IC0+IFBHVF9sMl90YWJsZSB8IDAKClYxOiA8cmVzdGFydD4KICBwdXRfb2xk
X2d1ZXN0X3RhYmxlKCkKICAgIF9wdXRfcGFnZV90eXBlKEEpICMgVU5ERVJG
TE9XCgpJbmRlZWQsIGl0IGlzIHBvc3NpYmxlIHRvIGVuZ2luZWVyIGZvciBv
bGRfZ3Vlc3RfdGFibGUgZm9yIGV2ZXJ5IHZjcHUKYSBndWVzdCBoYXMgdG8g
cG9pbnQgdG8gdGhlIHNhbWUgcGFnZS4KLS0tCiB4ZW4vYXJjaC94ODYvZG9t
YWluLmMgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAg
ICAgICAgIHwgOTkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oIHwgIDQgKy0KIDMg
ZmlsZXMgY2hhbmdlZCwgOTUgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IDU5ZGY4YTZkOGQuLmYxYWU1Zjg5
ZjUgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTExMDQsOSArMTEwNCwxNSBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICAgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0
aHJvdWdoICovCiAgICAgICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6Cisg
ICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICAgICAq
IE5CIHRoYXQgd2UncmUgcHV0dGluZyB0aGUga2VybmVsLW1vZGUgdGFibGUK
KyAgICAgICAgICAgICAgICAgICAgICogaGVyZSwgd2hpY2ggd2UndmUgYWxy
ZWFkeSBzdWNjZXNzZnVsbHkKKyAgICAgICAgICAgICAgICAgICAgICogdmFs
aWRhdGVkIGFib3ZlOyBoZW5jZSBwYXJ0aWFsID0gZmFsc2U7CisgICAgICAg
ICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgICB2LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPQogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZXRhYmxlX2dldF9wYWdlKHYtPmFyY2guZ3Vlc3RfdGFibGUp
OworICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgIHYtPmFy
Y2guZ3Vlc3RfdGFibGUgPSBwYWdldGFibGVfbnVsbCgpOwogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0Ogpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCBhNDMyZTY5Yzc0Li44MTc3NDM2OGEwIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTM1OSwxMCArMTM1OSwxMSBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gcHRwZzsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgIH0K
ICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOworICAg
ICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHko
IXJjKSApCiAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAg
ICB9CkBAIC0xMzg1LDYgKzEzODYsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdl
X2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZu
LAogICAgICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwzZV9nZXRfcGZuKGwz
ZSk7CiAgICAgICAgIGJvb2wgd3JpdGVhYmxlID0gbDNlX2dldF9mbGFncyhs
M2UpICYgX1BBR0VfUlc7CiAKKyAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQ
VEZfcGFydGlhbF9zZXQpKTsKICAgICAgICAgQVNTRVJUKCEobWZuICYgKCgx
VUwgPDwgKEwzX1BBR0VUQUJMRV9TSElGVCAtIFBBR0VfU0hJRlQpKSAtIDEp
KSk7CiAgICAgICAgIGRvIHsKICAgICAgICAgICAgIHB1dF9kYXRhX3BhZ2Uo
bWZuX3RvX3BhZ2UoX21mbihtZm4pKSwgd3JpdGVhYmxlKTsKQEAgLTEzOTcs
MTIgKzEzOTksMTQgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShs
M19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwKIAogICAgIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgIHsKKyAgICAgICAgQVNTRVJU
KCEoZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpKTsKICAgICAgICAgY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZu
KSk7CiAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0g
cGc7CisgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3Bh
cnRpYWwgPSBmYWxzZTsKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCi0g
ICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBt
Zm5fdG9fcGFnZShfbWZuKHBmbikpKTsKKyAgICByYyA9IF9wdXRfcGFnZV90
eXBlKHBnLCBmbGFncyB8IFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2Uo
X21mbihwZm4pKSk7CiAgICAgaWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAg
IHB1dF9wYWdlKHBnKTsKIApAQCAtMTQyMSwxMiArMTQyNSwxNSBAQCBzdGF0
aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVu
c2lnbmVkIGxvbmcgcGZuLAogCiAgICAgICAgIGlmICggZmxhZ3MgJiBQVEZf
ZGVmZXIgKQogICAgICAgICB7CisgICAgICAgICAgICBBU1NFUlQoIShmbGFn
cyAmIFBURl9wYXJ0aWFsX3NldCkpOwogICAgICAgICAgICAgY3VycmVudC0+
YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7
CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9
IHBnOworICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGVfcGFydGlhbCA9IGZhbHNlOwogICAgICAgICAgICAgcmV0dXJuIDA7CiAg
ICAgICAgIH0KIAotICAgICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQ
VEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZuKSkpOworICAg
ICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBmbGFncyB8IFBURl9wcmVl
bXB0aWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5fdG9f
cGFnZShfbWZuKHBmbikpKTsKICAgICAgICAgaWYgKCBsaWtlbHkoIXJjKSAp
CiAgICAgICAgICAgICBwdXRfcGFnZShwZyk7CiAgICAgfQpAQCAtMTUzNSw2
ICsxNTQyLDE0IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogCiAgICAg
cGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCisgICAgLyoK
KyAgICAgKiBOQiB0aGF0IGFsbG9jX2wyX3RhYmxlIHdpbGwgbmV2ZXIgc2V0
IHBhcnRpYWxfcHRlIG9uIGFuIGwyOyBidXQKKyAgICAgKiBmcmVlX2wyX3Rh
YmxlIG1pZ2h0IGlmIGEgbGluZWFyX3BhZ2V0YWJsZSBlbnRyeSBpcyBpbnRl
cnJ1cHRlZAorICAgICAqIHBhcnR3YXkgdGhyb3VnaCBkZS12YWxpZGF0aW9u
LiAgSW4gdGhhdCBjaXJjdW1zdGFuY2UsCisgICAgICogZ2V0X3BhZ2VfZnJv
bV9sMmUoKSB3aWxsIGFsd2F5cyByZXR1cm4gLUVJTlZBTDsgYW5kIHdlIG11
c3QKKyAgICAgKiByZXRhaW4gdGhlIHR5cGUgcmVmIGJ5IGRvaW5nIHRoZSBu
b3JtYWwgcGFydGlhbF9mbGFncyB0cmFja2luZy4KKyAgICAgKi8KKwogICAg
IGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwyX1BB
R0VUQUJMRV9FTlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFn
cyA9IDAgKQogICAgIHsKQEAgLTE1OTgsNiArMTYxMyw3IEBAIHN0YXRpYyBp
bnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5z
aWduZWQgbG9uZyB0eXBlKQogICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzOwogICAgICAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsK
KyAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gdHJ1ZTsKICAgICAgICAgICAgIH0KICAgICAgICAgfQog
ICAgICAgICBpZiAoIHJjIDwgMCApCkBAIC0xNzA0LDEyICsxNzIwLDE2IEBA
IHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSkKICAgICAgICAgICAgICAgICAgKiBidWlsZHMuCiAgICAgICAgICAg
ICAgICAgICovCiAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBsM2VfZ2V0X3BhZ2UobDNlKSApCisgICAg
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICBBU1NFUlQoY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCk7CiAgICAgICAg
ICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlh
bF9zZXQ7CisgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIGVs
c2UKICAgICAgICAgICAgICAgICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7
CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9s
ZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgIGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogICAg
ICAgICB9CiAgICAgICAgIHdoaWxlICggaS0tID4gMCApCiAgICAgICAgICAg
ICBwbDNlW2ldID0gdW5hZGp1c3RfZ3Vlc3RfbDNlKHBsM2VbaV0sIGQpOwpA
QCAtMTg5NywxMiArMTkxNywxNiBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3Rh
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgKiBidWlsZHMuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
Ki8KICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPT0gbDRlX2dldF9wYWdlKGw0ZSkgKQorICAg
ICAgICAgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZV9w
YXJ0aWFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlLT5w
YXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OworICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJM
RSgpOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg
ICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAg
ICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZSA9IHBhZ2U7CisgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgIH0KICAgICAgICAgfQpAQCAtMjgzMSw2ICsy
ODU1LDI4IEBAIHN0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICAgICB4
ICA9IHk7CiAgICAgICAgIG54ID0geCAtIDE7CiAKKyAgICAgICAgLyoKKyAg
ICAgICAgICogSXMgdGhpcyBleHBlY3RlZCB0byBkbyBhIGZ1bGwgcmVmZXJl
bmNlIGRyb3AsIG9yIG9ubHkKKyAgICAgICAgICogY2xlYW51cCBwYXJ0aWFs
IHZhbGlkYXRpb24gLyBkZXZhbGlkYXRpb24/CisgICAgICAgICAqCisgICAg
ICAgICAqIElmIHRoZSBmb3JtZXIsIHRoZSBjYWxsZXIgbXVzdCBob2xkIGEg
ImZ1bGwiIHR5cGUgcmVmOworICAgICAgICAgKiB3aGljaCBtZWFucyB0aGUg
cGFnZSBtdXN0IGJlIHZhbGlkYXRlZC4gIElmIHRoZSBwYWdlIGlzCisgICAg
ICAgICAqICpub3QqIGZ1bGx5IHZhbGlkYXRlZCwgY29udGludWluZyB3b3Vs
ZCBhbG1vc3QgY2VydGFpbmx5CisgICAgICAgICAqIG9wZW4gdXAgYSBzZWN1
cml0eSBob2xlLiAgQW4gZXhjZXB0aW9uIHRvIHRoaXMgaXMgZHVyaW5nCisg
ICAgICAgICAqIGRvbWFpbiBkZXN0cnVjdGlvbiwgd2hlcmUgUEdUX3ZhbGlk
YXRlZCBjYW4gYmUgZHJvcHBlZAorICAgICAgICAgKiB3aXRob3V0IGRyb3Bw
aW5nIGEgdHlwZSByZWYuCisgICAgICAgICAqCisgICAgICAgICAqIElmIHRo
ZSBsYXR0ZXIsIGRvIG5vdGhpbmcgdW5sZXNzIHR5cGUgUEdUX3BhcnRpYWwg
aXMgc2V0LgorICAgICAgICAgKiBJZiBpdCBpcyBzZXQsIHRoZSB0eXBlIGNv
dW50IG11c3QgYmUgMS4KKyAgICAgICAgICovCisgICAgICAgIGlmICggIShm
bGFncyAmIFBURl9wYXJ0aWFsX3NldCkgKQorICAgICAgICAgICAgQlVHX09O
KCh4ICYgUEdUX3BhcnRpYWwpIHx8CisgICAgICAgICAgICAgICAgICAgISgo
eCAmIFBHVF92YWxpZGF0ZWQpIHx8IHBhZ2VfZ2V0X293bmVyKHBhZ2UpLT5p
c19keWluZykpOworICAgICAgICBlbHNlIGlmICggISh4ICYgUEdUX3BhcnRp
YWwpICkKKyAgICAgICAgICAgIHJldHVybiAwOworICAgICAgICBlbHNlCisg
ICAgICAgICAgICBCVUdfT04oKHggJiBQR1RfY291bnRfbWFzaykgIT0gMSk7
CisKICAgICAgICAgQVNTRVJUKCh4ICYgUEdUX2NvdW50X21hc2spICE9IDAp
OwogCiAgICAgICAgIHN3aXRjaCAoIG54ICYgKFBHVF9sb2NrZWQgfCBQR1Rf
Y291bnRfbWFzaykgKQpAQCAtMzA5MiwxNyArMzEzOCwzNCBAQCBpbnQgcHV0
X29sZF9ndWVzdF90YWJsZShzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoICF2
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCiAgICAgICAgIHJldHVybiAwOwog
Ci0gICAgc3dpdGNoICggcmMgPSBfcHV0X3BhZ2VfdHlwZSh2LT5hcmNoLm9s
ZF9ndWVzdF90YWJsZSwgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZykg
KQorICAgIHJjID0gX3B1dF9wYWdlX3R5cGUodi0+YXJjaC5vbGRfZ3Vlc3Rf
dGFibGUsCisgICAgICAgICAgICAgICAgICAgICAgICBQVEZfcHJlZW1wdGli
bGUgfAorICAgICAgICAgICAgICAgICAgICAgICAgKCB2LT5hcmNoLm9sZF9n
dWVzdF90YWJsZV9wYXJ0aWFsID8KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgUFRGX3BhcnRpYWxfc2V0IDogMCApLAorICAgICAgICAgICAgICAgICAg
ICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyk7CisKKyAgICBpZiAoIHJj
ID09IC1FUkVTVEFSVCB8fCByYyA9PSAtRUlOVFIgKQogICAgIHsKLSAgICBj
YXNlIC1FSU5UUjoKLSAgICBjYXNlIC1FUkVTVEFSVDoKKyAgICAgICAgdi0+
YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IChyYyA9PSAtRVJFU1RB
UlQpOwogICAgICAgICByZXR1cm4gLUVSRVNUQVJUOwotICAgIGNhc2UgMDoK
LSAgICAgICAgcHV0X3BhZ2Uodi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUpOwog
ICAgIH0KIAorICAgIC8qCisgICAgICogSXQgc2hvdWxkbid0IGJlIHBvc3Np
YmxlIGZvciBfcHV0X3BhZ2VfdHlwZSgpIHRvIHJldHVybgorICAgICAqIGFu
eXRoaW5nIGVsc2UgYXQgdGhlIG1vbWVudDsgYnV0IGlmIGl0IGRvZXMgaGFw
cGVuIGluCisgICAgICogcHJvZHVjdGlvbiwgbGVha2luZyB0aGUgdHlwZSBy
ZWYgaXMgcHJvYmFibHkgdGhlIGJlc3QgdGhpbmcgdG8KKyAgICAgKiBkby4g
IEVpdGhlciB3YXksIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGhlbGQgYnkgb2xk
X2d1ZXN0X3RhYmxlLgorICAgICAqLworICAgIEFTU0VSVChyYyA9PSAwKTsK
KworICAgIHB1dF9wYWdlKHYtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKTsKICAg
ICB2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IE5VTEw7CisgICAgdi0+YXJj
aC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CisgICAgLyoKKyAgICAgKiBTYWZl
c3QgZGVmYXVsdCBpZiBzb21lb25lIHNldHMgb2xkX2d1ZXN0X3RhYmxlIHdp
dGhvdXQKKyAgICAgKiBleHBsaWNpdGx5IHNldHRpbmcgb2xkX2d1ZXN0X3Rh
YmxlX3BhcnRpYWwuCisgICAgICovCisgICAgdi0+YXJjaC5vbGRfZ3Vlc3Rf
dGFibGVfcGFydGlhbCA9IHRydWU7CiAKICAgICByZXR1cm4gcmM7CiB9CkBA
IC0zMjUzLDExICszMzE2LDExIEBAIGludCBuZXdfZ3Vlc3RfY3IzKG1mbl90
IG1mbikKICAgICAgICAgICAgIHN3aXRjaCAoIHJjID0gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUocGFnZSkgKQogICAgICAgICAgICAgewogICAg
ICAgICAgICAgY2FzZSAtRUlOVFI6Ci0gICAgICAgICAgICAgICAgcmMgPSAt
RVJFU1RBUlQ7Ci0gICAgICAgICAgICAgICAgLyogZmFsbHRocm91Z2ggKi8K
ICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJUOgogICAgICAgICAgICAgICAg
IGN1cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAg
ICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAg
ICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0
aWFsID0gKHJjID09IC1FUkVTVEFSVCk7CisgICAgICAgICAgICAgICAgcmMg
PSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg
ICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgIEJVR19PTihyYyk7CkBA
IC0zNDk0LDYgKzM1NTcsNyBAQCBsb25nIGRvX21tdWV4dF9vcCgKICAgICAg
ICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgY3Vy
ci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAg
ICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7
CisgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVz
dF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9CkBAIC0zNTI4
LDYgKzM1OTIsMTEgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgICAg
ICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAgICBjdXJyLT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICBjdXJy
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICAg
ICAgLyoKKyAgICAgICAgICAgICAgICAgKiBFSU5UUiBtZWFucyB3ZSBzdGls
bCBob2xkIHRoZSB0eXBlIHJlZjsgRVJFU1RBUlQKKyAgICAgICAgICAgICAg
ICAgKiBtZWFucyBQR1RfcGFydGlhbCBob2xkcyB0aGUgdHlwZSByZWYKKyAg
ICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgICAgICBjdXJyLT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gKHJjID09IC1FUkVTVEFSVCk7
CiAgICAgICAgICAgICAgICAgcmMgPSAwOwogICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgZGVmYXVsdDoKQEAgLTM1OTYsMTEgKzM2NjUs
MTUgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgICAgICAgICAgc3dp
dGNoICggcmMgPSBwdXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJsZShwYWdl
KSApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIGNhc2Ug
LUVJTlRSOgotICAgICAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsK
LSAgICAgICAgICAgICAgICAgICAgLyogZmFsbHRocm91Z2ggKi8KICAgICAg
ICAgICAgICAgICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAgICAg
ICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAg
ICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKKyAgICAgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAgICAg
ICAgICogRUlOVFIgbWVhbnMgd2Ugc3RpbGwgaG9sZCB0aGUgdHlwZSByZWY7
CisgICAgICAgICAgICAgICAgICAgICAqIEVSRVNUQVJUIG1lYW5zIFBHVF9w
YXJ0aWFsIGhvbGRzIHRoZSByZWYKKyAgICAgICAgICAgICAgICAgICAgICov
CisgICAgICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3Rh
YmxlX3BhcnRpYWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKKyAgICAgICAgICAg
ICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAg
IGJyZWFrOwogICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAg
ICAgICAgICAgIEJVR19PTihyYyk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9hc20teDg2L2RvbWFpbi5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21h
aW4uaAppbmRleCAyMTRlNDRjZTFjLi4yY2ZjZTdiMzZiIDEwMDY0NAotLS0g
YS94ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oCisrKyBiL3hlbi9pbmNs
dWRlL2FzbS14ODYvZG9tYWluLmgKQEAgLTMwNyw3ICszMDcsNyBAQCBzdHJ1
Y3QgYXJjaF9kb21haW4KIAogICAgIHN0cnVjdCBwYWdpbmdfZG9tYWluIHBh
Z2luZzsKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtOwotICAgIC8qIFRv
IGVuZm9yY2UgbG9jayBvcmRlcmluZyBpbiB0aGUgcG9kIGNvZGUgd3J0IHRo
ZSAKKyAgICAvKiBUbyBlbmZvcmNlIGxvY2sgb3JkZXJpbmcgaW4gdGhlIHBv
ZCBjb2RlIHdydCB0aGUKICAgICAgKiBwYWdlX2FsbG9jIGxvY2sgKi8KICAg
ICBpbnQgcGFnZV9hbGxvY191bmxvY2tfbGV2ZWw7CiAKQEAgLTU4MSw2ICs1
ODEsOCBAQCBzdHJ1Y3QgYXJjaF92Y3B1CiAgICAgc3RydWN0IHBhZ2VfaW5m
byAqb2xkX2d1ZXN0X3RhYmxlOyAgLyogcGFydGlhbGx5IGRlc3RydWN0ZWQg
cGFnZXRhYmxlICovCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqb2xkX2d1ZXN0
X3B0cGc7ICAgLyogY29udGFpbmluZyBwYWdlIHRhYmxlIG9mIHRoZSAqLwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGZv
cm1lciwgaWYgYW55ICovCisgICAgYm9vbCBvbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbDsgICAgICAgLyogQXJlIHdlIGRyb3BwaW5nIGEgdHlwZSByZWYsIG9y
IGp1c3QKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKiBmaW5pc2hpbmcgdXAgYSBwYXJ0aWFsIGRlLXZhbGlkYXRpb24/ICov
CiAgICAgLyogZ3Vlc3RfdGFibGUgaG9sZHMgYSByZWYgdG8gdGhlIHBhZ2Us
IGFuZCBhbHNvIGEgdHlwZS1jb3VudCB1bmxlc3MKICAgICAgKiBzaGFkb3cg
cmVmY291bnRzIGFyZSBpbiB1c2UgKi8KICAgICBwYWdldGFibGVfdCBzaGFk
b3dfdGFibGVbNF07ICAgICAgICAvKiAoTUZOKSBzaGFkb3cocykgb2YgZ3Vl
c3QgKi8KLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Disposition: attachment;
 filename="xsa299/0001-x86-mm-L1TF-checks-don-t-leave-a-partial-entry.patch"
Content-Transfer-Encoding: base64

RnJvbSBkYWU1NTExNDVhZDRjNDcyMGY3YjcwMGQxMGQ1OGI2MDlhY2JhZTRl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAxLzExXSB4
ODYvbW06IEwxVEYgY2hlY2tzIGRvbid0IGxlYXZlIGEgcGFydGlhbCBlbnRy
eQoKT24gZGV0ZWN0aW9uIG9mIGEgcG90ZW50aWFsIEwxVEYgaXNzdWUsIG1v
c3QgdmFsaWRhdGlvbiBjb2RlIHJldHVybnMKLUVSRVNUQVJUIHRvIGFsbG93
IHRoZSBzd2l0Y2ggdG8gc2hhZG93IG1vZGUgdG8gaGFwcGVuIGFuZCBjYXVz
ZSB0aGUKb3JpZ2luYWwgb3BlcmF0aW9uIHRvIGJlIHJlc3RhcnRlZC4KCkhv
d2V2ZXIsIGluIHRoZSB2YWxpZGF0aW9uIGNvZGUsIHRoZSByZXR1cm4gdmFs
dWUgLUVSRVNUQVJUIGhhcyBiZWVuCnJlcHVycG9zZWQgdG8gaW5kaWNhdGUg
MSkgdGhlIGZ1bmN0aW9uIGhhcyBwYXJ0aWFsbHkgY29tcGxldGVkCnNvbWV0
aGluZyB3aGljaCBuZWVkcyB0byBiZSB1bmRvbmUsIGFuZCAyKSBjYWxsaW5n
IHB1dF9wYWdlX3R5cGUoKQpzaG91bGQgY2xlYW5seSB1bmRvIGl0LiAgVGhp
cyBjYXVzZXMgcHJvYmxlbXMgaW4gc2V2ZXJhbCBwbGFjZXMuCgpGb3IgTDEg
dGFibGVzLCBvbiByZWNlaXZpbmcgYW4gLUVSRVNUQVJUIHJldHVybiBmcm9t
IGFsbG9jX2wxX3RhYmxlKCksCmFsbG9jX3BhZ2VfdHlwZSgpIHdpbGwgc2V0
IFBHVF9wYXJ0aWFsIG9uIHRoZSBwYWdlLiAgSWYgZm9yIHNvbWUKcmVhc29u
IHRoZSBvcmlnaW5hbCBvcGVyYXRpb24gbmV2ZXIgcmVzdGFydHMsIHRoZW4g
b24gZG9tYWluCmRlc3RydWN0aW9uLCByZWxpbnF1aXNoX21lbW9yeSgpIHdp
bGwgY2FsbCBmcmVlX3BhZ2VfdHlwZSgpIG9uIHRoZQpwYWdlLgoKVW5mb3J0
dW5hdGVseSwgYWxsb2NfIGFuZCBmcmVlX2wxX3RhYmxlKCkgYXJlbid0IHNl
dCB1cCB0byBkZWFsIHdpdGgKUEdUX3BhcnRpYWwuICBXaGVuIHJldHVybmlu
ZyBhIGZhaWx1cmUsIGFsbG9jX2wxX3RhYmxlKCkgYWx3YXlzCmRlLXZhbGlk
YXRlcyB3aGF0ZXZlciBpdCdzIHZhbGlkYXRlZCBzbyBmYXIsIGFuZCBmcmVl
X2wxX3RhYmxlKCkKYWx3YXlzIGRldmFsaWRhdGVzIHRoZSB3aG9sZSBwYWdl
LiAgVGhpcyBtZWFucyB0aGF0IGlmCnJlbGlucXVpc2hfbWVtb3J5KCkgY2Fs
bHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBhbiBMMSB0aGF0IGRpZG4ndApjb21w
bGV0ZSBkdWUgdG8gYW4gTDFURiwgaXQgd2lsbCBjYWxsIHB1dF9wYWdlX2Zy
b21fbDFlKCkgb24gInBhZ2UKZW50cmllcyIgdGhhdCBoYXZlIG5ldmVyIGJl
ZW4gdmFsaWRhdGVkLgoKRm9yIEwyKyB0YWJsZXMsIHNldHRpbmcgcmMgdG8g
RVJFU1RBUlQgY2F1c2VzIHRoZSByZXN0IG9mIHRoZQphbGxvY19sTl90YWJs
ZSgpIGZ1bmN0aW9uIHRvICp0aGluayogdGhhdCB0aGUgZW50cnkgaW4gcXVl
c3Rpb24gd2lsbApoYXZlIFBHVF9wYXJ0aWFsIHNldC4gIFRoaXMgd2lsbCBj
YXVzZSBpdCB0byBzZXQgcGFydGlhbF9wdGUgPSAxLiAgSWYKcmVsaW5xdXNo
X21lbW9yeSgpIHRoZW4gY2FsbHMgZnJlZV9wYWdlX3R5cGUoKSBvbiBvbmUg
b2YgdGhvc2UgcGFnZXMsCnRoZW4gZnJlZV9sTl90YWJsZSgpIHdpbGwgY2Fs
bCBwdXRfcGFnZV9mcm9tX2xOZSgpIG9uIHRoZSBlbnRyeSB3aGVuCml0IHNo
b3VsZG4ndC4KClJhdGhlciB0aGFuIGluZGljYXRpbmcgLUVSRVNUQVJULCBp
bmRpY2F0ZSAtRUlOVFIuICBUaGlzIGlzIHRoZSBjb2RlCnRvIGluZGljYXRl
IHRoYXQgbm90aGluZyBoYXMgY2hhbmdlZCBmcm9tIHdoZW4geW91IHN0YXJ0
ZWQgdGhlIGNhbGwKKHdoaWNoIGlzIGVmZmVjdGl2ZWx5IGhvdyBhbGxvY19s
MV90YWJsZSgpIGhhbmRsZXMgZXJyb3JzKS4KCm1vZF9sTl9lbnRyeSgpIHNo
b3VsZG4ndCBoYXZlIGFueSBvZiB0aGVzZSB0eXBlcyBvZiBwcm9ibGVtcywg
c28gbGVhdmUKcG90ZW50aWFsIGNoYW5nZXMgdGhlcmUgZm9yIGEgY2xlYW4t
dXAgcGF0Y2ggbGF0ZXIuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJl
cG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5k
dW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDgg
KysrKy0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0IGluc2VydGlvbnMoKyksIDQg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA5OTgxNmZjNjdjLi45Y2FjNmQx
Y2RmIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTM3OSw3ICsxMzc5LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sMV90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
IHsKICAgICAgICAgaWYgKCAhKGwxZV9nZXRfZmxhZ3MocGwxZVtpXSkgJiBf
UEFHRV9QUkVTRU5UKSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHJldCA9
IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBsMWVbaV0pID8gLUVSRVNUQVJUIDog
MDsKKyAgICAgICAgICAgIHJldCA9IHB2X2wxdGZfY2hlY2tfbDFlKGQsIHBs
MWVbaV0pID8gLUVJTlRSIDogMDsKICAgICAgICAgICAgIGlmICggcmV0ICkK
ICAgICAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgfQpAQCAtMTQ4
OCw3ICsxNDg4LDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAg
ICAgIHsKICAgICAgICAgICAgIGlmICggIXB2X2wxdGZfY2hlY2tfbDJlKGQs
IGwyZSkgKQogICAgICAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICAg
ICAgcmMgPSAtRVJFU1RBUlQ7CisgICAgICAgICAgICByYyA9IC1FSU5UUjsK
ICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAgICAgICByYyA9IGdl
dF9wYWdlX2Zyb21fbDJlKGwyZSwgcGZuLCBkLCBwYXJ0aWFsKTsKQEAgLTE1
NzUsNyArMTU3NSw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgewogICAgICAgICAgICAg
aWYgKCAhcHZfbDF0Zl9jaGVja19sM2UoZCwgbDNlKSApCiAgICAgICAgICAg
ICAgICAgY29udGludWU7Ci0gICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsK
KyAgICAgICAgICAgIHJjID0gLUVJTlRSOwogICAgICAgICB9CiAgICAgICAg
IGVsc2UKICAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UobDNl
LCBwZm4sIGQsIHBhcnRpYWwpOwpAQCAtMTc1Niw3ICsxNzU2LDcgQEAgc3Rh
dGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogICAgICAgICB7CiAgICAgICAgICAgICBpZiAoICFwdl9sMXRmX2NoZWNr
X2w0ZShkLCBsNGUpICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKLSAg
ICAgICAgICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgcmMgPSAt
RUlOVFI7CiAgICAgICAgIH0KICAgICAgICAgZWxzZQogICAgICAgICAgICAg
cmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShsNGUsIHBmbiwgZCwgcGFydGlhbCk7
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Disposition: attachment;
 filename="xsa299/0002-x86-mm-Don-t-re-set-PGT_pinned-on-a-partially-de-val.patch"
Content-Transfer-Encoding: base64

RnJvbSBmYmMyNzk2NTFkYmE5ZTViZTZmZjI5Yzg5YTkyZjFiY2U0MGFlZTU2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAyLzExXSB4
ODYvbW06IERvbid0IHJlLXNldCBQR1RfcGlubmVkIG9uIGEgcGFydGlhbGx5
CiBkZS12YWxpZGF0ZWQgcGFnZQoKV2hlbiB1bnBpbm5pbmcgcGFnZXRhYmxl
cywgaWYgYW4gb3BlcmF0aW9uIGlzIGludGVycnVwdGVkLApyZWxpbnF1aXNo
X21lbW9yeSgpIHJlLXNldHMgUEdUX3Bpbm5lZCBzbyB0aGF0IHRoZSB1bi1w
aW4gd2lsbApwaWNrZWR1cCBhZ2FpbiB3aGVuIHRoZSBoeXBlcmNhbGwgcmVz
dGFydHMuCgpUaGlzIGlzIGFwcHJvcHJpYXRlIHdoZW4gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUoKSByZXR1cm5zCi1FSU5UUiwgd2hpY2ggaW5k
aWNhdGVzIHRoYXQgdGhlIHBhZ2UgaXMgYmFjayBpbiBpdHMgaW5pdGlhbCBz
dGF0ZQooaS5lLiwgY29tcGxldGVseSB2YWxpZGF0ZWQpLiAgSG93ZXZlciwg
Zm9yIC1FUkVTVEFSVCwgdGhpcyBsZWFkcyB0byBhCnN0YXRlIHdoZXJlIGEg
cGFnZSBoYXMgYm90aCBQR1RfcGlubmVkIGFuZCBQR1RfcGFydGlhbCBzZXQu
CgpUaGlzIGhhcHBlbnMgdG8gd29yayBhdCB0aGUgbW9tZW50LCBhbHRob3Vn
aCBpdCdzIG5vdCByZWFsbHkgYQoiY2Fub25pY2FsIiBzdGF0ZTsgYnV0IGlu
IHN1YnNlcXVlbnQgcGF0Y2hlcywgd2hlcmUgd2UgbmVlZCB0byBtYWtlIGEK
ZGlzdGluY3Rpb24gaW4gaGFuZGxpbmcgYmV0d2VlbiBQR1RfdmFsaWRhdGVk
IGFuZCBQR1RfcGFydGlhbCBwYWdlcywKdGhpcyBjYXVzZXMgaXNzdWVzLgoK
TW92ZSB0byBhICJjYW5vbmljYWwiIHN0YXRlIGJ5OgotIE9ubHkgcmUtc2V0
dGluZyBQR1RfcGlubmVkIG9uIC1FSU5UUgotIFJlLWRyb3BwaW5nIHRoZSBy
ZWZjb3VudCBoZWxkIGJ5IFBHVF9waW5uZWQgb24gLUVSRVNUQVJUCgpJbiB0
aGUgbGF0dGVyIGNhc2UsIHRoZSBQR1RfcGFydGlhbCBiaXQgd2lsbCBiZSBj
bGVhcmVkIGZ1cnRoZXIgZG93bgp3aXRoIHRoZSByZXN0IG9mIHRoZSBvdGhl
ciBQR1RfcGFydGlhbCBwYWdlcy4KCldoaWxlIGhlcmUsIGNsZWFuIHVwIHNv
bWUgdHJhaW5saW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBhcnQgb2YgWFNB
LTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVu
bGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYv
ZG9tYWluLmMgfCAzMSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKaW5kZXggYzhkN2Y0OTFlYS4uZmViYmIy
MzMzNiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTIwLDcgKzEyMCw3IEBAIHZv
aWQgcGxheV9kZWFkKHZvaWQpCiAgICAgICogdGhpcyBjYXNlLCBoZWFwIGNv
cnJ1cHRpb24gb3IgI1BGIGNhbiBvY2N1ciAod2hlbiBoZWFwIGRlYnVnZ2lu
ZyBpcwogICAgICAqIGVuYWJsZWQpLiBGb3IgZXhhbXBsZSwgZXZlbiBwcmlu
dGsoKSBjYW4gaW52b2x2ZSB0YXNrbGV0IHNjaGVkdWxpbmcsCiAgICAgICog
d2hpY2ggdG91Y2hlcyBwZXItY3B1IHZhcnMuCi0gICAgICogCisgICAgICoK
ICAgICAgKiBDb25zaWRlciB2ZXJ5IGNhcmVmdWxseSB3aGVuIGFkZGluZyBj
b2RlIHRvICpkZWFkX2lkbGUuIE1vc3QgaHlwZXJ2aXNvcgogICAgICAqIHN1
YnN5c3RlbXMgYXJlIHVuc2FmZSB0byBjYWxsLgogICAgICAqLwpAQCAtMTk3
Miw5ICsxOTcyLDM0IEBAIHN0YXRpYyBpbnQgcmVsaW5xdWlzaF9tZW1vcnko
CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6
CiAgICAgICAgIGNhc2UgLUVJTlRSOgorICAgICAgICAgICAgLyoKKyAgICAg
ICAgICAgICAqIC1FSU5UUiBtZWFucyBQR1RfdmFsaWRhdGVkIGhhcyBiZWVu
IHJlLXNldDsgcmUtc2V0CisgICAgICAgICAgICAgKiBQR1RfcGlubmVkIGFn
YWluIHNvIHRoYXQgaXQgZ2V0cyBwaWNrZWQgdXAgbmV4dCB0aW1lCisgICAg
ICAgICAgICAgKiBhcm91bmQuCisgICAgICAgICAgICAgKgorICAgICAgICAg
ICAgICogLUVSRVNUQVJULCBPVE9ILCBtZWFucyBQR1RfcGFydGlhbCBpcyBz
ZXQgaW5zdGVhZC4gIFB1dAorICAgICAgICAgICAgICogaXQgYmFjayBvbiB0
aGUgbGlzdCwgYnV0IGRvbid0IHNldCBQR1RfcGlubmVkOyB0aGUKKyAgICAg
ICAgICAgICAqIHNlY3Rpb24gYmVsb3cgd2lsbCBmaW5pc2ggb2ZmIGRlLXZh
bGlkYXRpb24uICBCdXQgd2UgZG8KKyAgICAgICAgICAgICAqIG5lZWQgdG8g
ZHJvcCB0aGUgZ2VuZXJhbCByZWYgYXNzb2NpYXRlZCB3aXRoCisgICAgICAg
ICAgICAgKiBQR1RfcGlubmVkLCBzaW5jZSBwdXRfcGFnZV9hbmRfdHlwZV9w
cmVlbXB0aWJsZSgpCisgICAgICAgICAgICAgKiBkaWRuJ3QgZG8gaXQuCisg
ICAgICAgICAgICAgKgorICAgICAgICAgICAgICogTkIgd2UgY2FuIGRvIGFu
IEFTU0VSVCBmb3IgUEdUX3ZhbGlkYXRlZCwgc2luY2Ugd2UKKyAgICAgICAg
ICAgICAqICJvd24iIHRoZSB0eXBlIHJlZjsgYnV0IHRoZW9yZXRpY2FsbHks
IHRoZSBQR1RfcGFydGlhbAorICAgICAgICAgICAgICogY291bGQgYmUgY2xl
YXJlZCBieSBzb21lb25lIGVsc2UuCisgICAgICAgICAgICAgKi8KKyAgICAg
ICAgICAgIGlmICggcmV0ID09IC1FSU5UUiApCisgICAgICAgICAgICB7Cisg
ICAgICAgICAgICAgICAgQVNTRVJUKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZv
ICYgUEdUX3ZhbGlkYXRlZCk7CisgICAgICAgICAgICAgICAgc2V0X2JpdChf
UEdUX3Bpbm5lZCwgJnBhZ2UtPnUuaW51c2UudHlwZV9pbmZvKTsKKyAgICAg
ICAgICAgIH0KKyAgICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICBw
dXRfcGFnZShwYWdlKTsKKwogICAgICAgICAgICAgcmV0ID0gLUVSRVNUQVJU
OworCisgICAgICAgICAgICAvKiBQdXQgdGhlIHBhZ2UgYmFjayBvbiB0aGUg
bGlzdCBhbmQgZHJvcCB0aGUgcmVmIHdlIGdyYWJiZWQgYWJvdmUgKi8KICAg
ICAgICAgICAgIHBhZ2VfbGlzdF9hZGQocGFnZSwgbGlzdCk7Ci0gICAgICAg
ICAgICBzZXRfYml0KF9QR1RfcGlubmVkLCAmcGFnZS0+dS5pbnVzZS50eXBl
X2luZm8pOwogICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CiAgICAgICAg
ICAgICBnb3RvIG91dDsKICAgICAgICAgZGVmYXVsdDoKQEAgLTIyMjUsNyAr
MjI1MCw3IEBAIHZvaWQgdmNwdV9raWNrKHN0cnVjdCB2Y3B1ICp2KQogICAg
ICAqIHBlbmRpbmcgZmxhZy4gVGhlc2UgdmFsdWVzIG1heSBmbHVjdHVhdGUg
KGFmdGVyIGFsbCwgd2UgaG9sZCBubwogICAgICAqIGxvY2tzKSBidXQgdGhl
IGtleSBpbnNpZ2h0IGlzIHRoYXQgZWFjaCBjaGFuZ2Ugd2lsbCBjYXVzZQog
ICAgICAqIGV2dGNobl91cGNhbGxfcGVuZGluZyB0byBiZSBwb2xsZWQuCi0g
ICAgICogCisgICAgICoKICAgICAgKiBOQjIuIFdlIHNhdmUgdGhlIHJ1bm5p
bmcgZmxhZyBhY3Jvc3MgdGhlIHVuYmxvY2sgdG8gYXZvaWQgYSBuZWVkbGVz
cwogICAgICAqIElQSSBmb3IgZG9tYWlucyB0aGF0IHdlIElQSSdkIHRvIHVu
YmxvY2suCiAgICAgICovCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Disposition: attachment;
 filename="xsa299/0003-x86-mm-Separate-out-partial_pte-tristate-into-indivi.patch"
Content-Transfer-Encoding: base64

RnJvbSBiODIxZjc5Zjg4YzE5NGNmMzA2NGY0MWVhNjZjZDNkOTU1NGE4Y2I1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDAzLzExXSB4
ODYvbW06IFNlcGFyYXRlIG91dCBwYXJ0aWFsX3B0ZSB0cmlzdGF0ZSBpbnRv
CiBpbmRpdmlkdWFsIGZsYWdzCgpBdCB0aGUgbW9tZW50LCBwYXJ0aWFsX3B0
ZSBpcyBhIHRyaS1zdGF0ZSB0aGF0IGNvbnRhaW5zIHR3byBkaXN0aW5jdCBi
aXRzCm9mIGluZm9ybWF0aW9uOgoKMS4gSWYgemVybywgdGhlIHB0ZSBhdCBp
bmRleCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHVuLXZhbGlkYXRlZC4gIElm
CiAgIG5vbi16ZXJvLCB0aGUgcHRlIHdhcyBsYXN0IHNlZW4gd2l0aCBQR1Rf
cGFydGlhbCBzZXQuCgoyLiBJZiBwb3NpdGl2ZSwgdGhlIHB0ZSBhdCBpbmRl
eCBbbnJfdmFsaWRhdGVkX3B0ZXNdIGRvZXMgbm90IGhvbGQgYQogICBnZW5l
cmFsIHJlZmVyZW5jZSBjb3VudC4gIElmIG5lZ2F0aXZlLCBpdCBkb2VzLgoK
VG8gbWFrZSBmdXR1cmUgcGF0Y2hlcyBtb3JlIGNsZWFyLCBzZXBhcmF0ZSBv
dXQgdGhpcyBmdW5jdGlvbmFsaXR5CmludG8gdHdvIGRpc3RpbmN0LCBuYW1l
ZCBiaXRzOiBQVEZfcGFydGlhbF9zZXQgKGZvciAjMSkgYW5kClBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIChmb3IgIzIpLgoKQWRkaXRpb25hbGx5LCBhIG51
bWJlciBvZiBmdW5jdGlvbnMgd2hpY2ggbmVlZCB0aGlzIGluZm9ybWF0aW9u
IGFsc28KdGFrZSBvdGhlciBmbGFncyB0byBjb250cm9sIGJlaGF2aW9yIChz
dWNoIGFzIGBwcmVlbXB0aWJsZWAgYW5kCmBkZWZlcmApLiAgVGhlc2UgYXJl
IGhhcmQgdG8gcmVhZCBpbiB0aGUgY2FsbGVyIChzaW5jZSB5b3Ugb25seSBz
ZWUKJ3RydWUnIG9yICdmYWxzZScpLCBhbmQgdWdseSB3aGVuIG1hbnkgYXJl
IGFkZGVkIHRvZ2V0aGVyLiAgSW4KcHJlcGFyYXRpb24gZm9yIGFkZGluZyB5
ZXQgYW5vdGhlciBmbGFnIGluIGEgZnV0dXJlIHBhdGNoLCBjb2xsYXBzZQph
bGwgb2YgdGhlc2UgaW50byBhIHNpbmdsZSBgZmxhZ2AgdmFyaWFibGUuCgpO
QiB0aGF0IHRoaXMgZG9lcyBtZWFuIGNoZWNraW5nIGZvciB3aGF0IHdhcyBw
cmV2aW91c2x5IHRoZSAnLTEnCmNvbmRpdGlvbiBhIGJpdCBtb3JlIHVnbHkg
aW4gdGhlIHB1dF9wYWdlX2Zyb21fbE5lIGZ1bmN0aW9ucyAoc2luY2UKeW91
IGhhdmUgdG8gY2hlY2sgZm9yIGJvdGggcGFydGlhbF9zZXQgYW5kIGdlbmVy
YWwgcmVmKTsgYnV0IHRoaXMKY2xhdXNlIHdpbGwgZ28gYXdheSBpbiBhIGZ1
dHVyZSBwYXRjaC4KCkFsc28gbm90ZSB0aGF0IHRoZSBvcmlnaW5hbCBjb21t
ZW50IGhhZCBhbiBvZmYtYnktb25lIGVycm9yOgpwYXJ0aWFsX2ZsYWdzIChs
aWtlIHBhcnRpYWxfcHRlIGJlZm9yZSBpdCkgY29uY2VybnMKcGxOZVtucl92
YWxpZGF0ZWRfcHRlc10sIG5vdCBwbE5lW25yX3ZhbGlkYXRlZF9wdGVzKzFd
LgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4v
YXJjaC94ODYvbW0uYyAgICAgICAgfCAxNjUgKysrKysrKysrKysrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21t
LmggfCAgNDEgKysrKysrKy0tLQogMiBmaWxlcyBjaGFuZ2VkLCAxMjggaW5z
ZXJ0aW9ucygrKSwgNzggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA5Y2Fj
NmQxY2RmLi42YWJkZDIwYjg5IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTA2NCwyMCArMTA2
NCwzNSBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKIH0KIAogI2lmZGVmIENPTkZJ
R19QVgorCisvKgorICogVGhlIGZvbGxvd2luZyBmbGFncyBhcmUgdXNlZCB0
byBzcGVjaWZ5IGJlaGF2aW9yIG9mIHZhcmlvdXMgZ2V0IGFuZAorICogcHV0
IGNvbW1hbmRzLiAgVGhlIGZpcnN0IHR3byBhcmUgYWxzbyBzdG9yZWQgaW4g
cGFnZS0+cGFydGlhbF9mbGFncworICogdG8gaW5kaWNhdGUgdGhlIHN0YXRl
IG9mIHRoZSBwYWdlIHBvaW50ZWQgdG8gYnkKKyAqIHBhZ2UtPnB0ZVtwYWdl
LT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhlIGNvbW1lbnQgaW4g
bW0uaCBmb3IKKyAqIG1vcmUgaW5mb3JtYXRpb24uCisgKi8KKyNkZWZpbmUg
UFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwgMCkKKyNkZWZpbmUgUFRG
X3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkKKyNkZWZpbmUgUFRGX3By
ZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKKyNkZWZpbmUgUFRGX2RlZmVy
ICAgICAgICAgICAgICAgKDEgPDwgMykKKwogc3RhdGljIGludCBnZXRfcGFn
ZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICBtZm5fdCBtZm4sIHVuc2lnbmVk
IGxvbmcgdHlwZSwgc3RydWN0IGRvbWFpbiAqZCwKLSAgICBpbnQgcGFydGlh
bCwgaW50IHByZWVtcHRpYmxlKQorICAgIHVuc2lnbmVkIGludCBmbGFncykK
IHsKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3RvX3BhZ2Uo
bWZuKTsKICAgICBpbnQgcmM7CisgICAgYm9vbCBwcmVlbXB0aWJsZSA9IGZs
YWdzICYgUFRGX3ByZWVtcHRpYmxlLAorICAgICAgICAgcGFydGlhbF9yZWYg
PSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogCi0gICAgaWYg
KCBsaWtlbHkocGFydGlhbCA+PSAwKSAmJgorICAgIGlmICggbGlrZWx5KCFw
YXJ0aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9m
cm9tX21mbihtZm4sIGQpKSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwog
CiAgICAgcmMgPSBfZ2V0X3BhZ2VfdHlwZShwYWdlLCB0eXBlLCBwcmVlbXB0
aWJsZSk7CiAKLSAgICBpZiAoIHVubGlrZWx5KHJjKSAmJiBwYXJ0aWFsID49
IDAgJiYKKyAgICBpZiAoIHVubGlrZWx5KHJjKSAmJiAhcGFydGlhbF9yZWYg
JiYKICAgICAgICAgICghcHJlZW1wdGlibGUgfHwgcGFnZSAhPSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkgKQogICAgICAgICBwdXRfcGFnZShw
YWdlKTsKIApAQCAtMTA4Nyw3ICsxMTAyLDcgQEAgc3RhdGljIGludCBnZXRf
cGFnZV9hbmRfdHlwZV9mcm9tX21mbigKIGRlZmluZV9nZXRfbGluZWFyX3Bh
Z2V0YWJsZShsMik7CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9tX2wyZSgK
LSAgICBsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3Ry
dWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisgICAgbDJfcGdlbnRyeV90
IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21haW4gKmQsIHVu
c2lnbmVkIGludCBmbGFncykKIHsKICAgICB1bnNpZ25lZCBsb25nIG1mbiA9
IGwyZV9nZXRfcGZuKGwyZSk7CiAgICAgaW50IHJjOwpAQCAtMTA5OSw4ICsx
MTE0LDkgQEAgZ2V0X3BhZ2VfZnJvbV9sMmUoCiAgICAgICAgIHJldHVybiAt
RUlOVkFMOwogICAgIH0KIAotICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVf
ZnJvbV9tZm4oX21mbihtZm4pLCBQR1RfbDFfcGFnZV90YWJsZSwgZCwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwsIGZh
bHNlKTsKKyAgICBBU1NFUlQoIShmbGFncyAmIFBURl9wcmVlbXB0aWJsZSkp
OworCisgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihfbWZu
KG1mbiksIFBHVF9sMV9wYWdlX3RhYmxlLCBkLCBmbGFncyk7CiAgICAgaWYg
KCB1bmxpa2VseShyYyA9PSAtRUlOVkFMKSAmJiBnZXRfbDJfbGluZWFyX3Bh
Z2V0YWJsZShsMmUsIHBmbiwgZCkgKQogICAgICAgICByYyA9IDA7CiAKQEAg
LTExMTAsNyArMTEyNiw3IEBAIGdldF9wYWdlX2Zyb21fbDJlKAogZGVmaW5l
X2dldF9saW5lYXJfcGFnZXRhYmxlKGwzKTsKIHN0YXRpYyBpbnQKIGdldF9w
YWdlX2Zyb21fbDNlKAotICAgIGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVk
IGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkLCBpbnQgcGFydGlhbCkKKyAg
ICBsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3RydWN0
IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGludCBy
YzsKIApAQCAtMTEyMiw3ICsxMTM4LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sM2Uo
CiAgICAgfQogCiAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21m
bigKLSAgICAgICAgbDNlX2dldF9tZm4obDNlKSwgUEdUX2wyX3BhZ2VfdGFi
bGUsIGQsIHBhcnRpYWwsIDEpOworICAgICAgICBsM2VfZ2V0X21mbihsM2Up
LCBQR1RfbDJfcGFnZV90YWJsZSwgZCwgZmxhZ3MgfCBQVEZfcHJlZW1wdGli
bGUpOwogICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkgJiYKICAg
ICAgICAgICFpc19wdl8zMmJpdF9kb21haW4oZCkgJiYKICAgICAgICAgIGdl
dF9sM19saW5lYXJfcGFnZXRhYmxlKGwzZSwgcGZuLCBkKSApCkBAIC0xMTM0
LDcgKzExNTAsNyBAQCBnZXRfcGFnZV9mcm9tX2wzZSgKIGRlZmluZV9nZXRf
bGluZWFyX3BhZ2V0YWJsZShsNCk7CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9m
cm9tX2w0ZSgKLSAgICBsNF9wZ2VudHJ5X3QgbDRlLCB1bnNpZ25lZCBsb25n
IHBmbiwgc3RydWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCisgICAgbDRf
cGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21h
aW4gKmQsIHVuc2lnbmVkIGludCBmbGFncykKIHsKICAgICBpbnQgcmM7CiAK
QEAgLTExNDYsNyArMTE2Miw3IEBAIGdldF9wYWdlX2Zyb21fbDRlKAogICAg
IH0KIAogICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCi0g
ICAgICAgIGw0ZV9nZXRfbWZuKGw0ZSksIFBHVF9sM19wYWdlX3RhYmxlLCBk
LCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgbDRlX2dldF9tZm4obDRlKSwgUEdU
X2wzX3BhZ2VfdGFibGUsIGQsIGZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlKTsK
ICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYmIGdldF9sNF9s
aW5lYXJfcGFnZXRhYmxlKGw0ZSwgcGZuLCBkKSApCiAgICAgICAgIHJjID0g
MDsKIApAQCAtMTI0Nyw3ICsxMjYzLDcgQEAgc3RhdGljIHZvaWQgcHV0X2Rh
dGFfcGFnZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCBib29sIHdyaXRlYWJs
ZSkKICAqIE5vdGUgYWxzbyB0aGF0IHRoaXMgYXV0b21hdGljYWxseSBkZWFs
cyBjb3JyZWN0bHkgd2l0aCBsaW5lYXIgcC50LidzLgogICovCiBzdGF0aWMg
aW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2ln
bmVkIGxvbmcgcGZuLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgcGFydGlhbCwgYm9vbCBkZWZlcikKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IGZsYWdzKQogewogICAgIGludCByYyA9
IDA7CiAKQEAgLTEyNzAsMTIgKzEyODYsMTMgQEAgc3RhdGljIGludCBwdXRf
cGFnZV9mcm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25n
IHBmbiwKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBsMmVfZ2V0
X3BhZ2UobDJlKTsKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZyA9
IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CiAKLSAgICAgICAgaWYgKCB1bmxp
a2VseShwYXJ0aWFsID4gMCkgKQorICAgICAgICBpZiAoIChmbGFncyAmIChQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09
CisgICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIEFTU0VSVCghZGVmZXIpOworICAgICAgICAgICAgQVNT
RVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKICAgICAgICAgICAgIHJjID0g
X3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIHB0cGcpOwogICAgICAgICB9Ci0g
ICAgICAgIGVsc2UgaWYgKCBkZWZlciApCisgICAgICAgIGVsc2UgaWYgKCBm
bGFncyAmIFBURl9kZWZlciApCiAgICAgICAgIHsKICAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBwdHBnOwogICAgICAgICAg
ICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwZzsKQEAgLTEy
OTIsNyArMTMwOSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUo
bDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sCiB9CiAKIHN0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwg
dW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAgICAgc3Ry
dWN0IHBhZ2VfaW5mbyAqcGc7CiAgICAgaW50IHJjOwpAQCAtMTMxNSwxMyAr
MTMzMiwxNCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3Bn
ZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogCiAgICAgcGcgPSBs
M2VfZ2V0X3BhZ2UobDNlKTsKIAotICAgIGlmICggdW5saWtlbHkocGFydGlh
bCA+IDApICkKKyAgICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQg
fCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09CisgICAgICAgICBQVEZf
cGFydGlhbF9zZXQgKQogICAgIHsKLSAgICAgICAgQVNTRVJUKCFkZWZlcik7
CisgICAgICAgIEFTU0VSVCghKGZsYWdzICYgUFRGX2RlZmVyKSk7CiAgICAg
ICAgIHJldHVybiBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZuX3RvX3Bh
Z2UoX21mbihwZm4pKSk7CiAgICAgfQogCi0gICAgaWYgKCBkZWZlciApCisg
ICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgewogICAgICAgICBj
dXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21m
bihwZm4pKTsKICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgPSBwZzsKQEAgLTEzMzYsNyArMTM1NCw3IEBAIHN0YXRpYyBpbnQgcHV0
X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9u
ZyBwZm4sCiB9CiAKIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sNGUobDRf
cGdlbnRyeV90IGw0ZSwgdW5zaWduZWQgbG9uZyBwZm4sCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxh
Z3MpCiB7CiAgICAgaW50IHJjID0gMTsKIApAQCAtMTM0NSwxMyArMTM2Mywx
NCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlf
dCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgIHsKICAgICAgICAgc3Ry
dWN0IHBhZ2VfaW5mbyAqcGcgPSBsNGVfZ2V0X3BhZ2UobDRlKTsKIAotICAg
ICAgICBpZiAoIHVubGlrZWx5KHBhcnRpYWwgPiAwKSApCisgICAgICAgIGlm
ICggKGZsYWdzICYgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmKSkgPT0KKyAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0
ICkKICAgICAgICAgewotICAgICAgICAgICAgQVNTRVJUKCFkZWZlcik7Cisg
ICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwogICAg
ICAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBtZm5f
dG9fcGFnZShfbWZuKHBmbikpKTsKICAgICAgICAgfQogCi0gICAgICAgIGlm
ICggZGVmZXIgKQorICAgICAgICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkK
ICAgICAgICAgewogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vl
c3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CiAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBnOwpAQCAtMTQ2
MywxMiArMTQ4MiwxMyBAQCBzdGF0aWMgaW50IGFsbG9jX2wyX3RhYmxlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcgdHlwZSkKICAg
ICB1bnNpZ25lZCBsb25nICBwZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdl
KSk7CiAgICAgbDJfcGdlbnRyeV90ICAqcGwyZTsKICAgICB1bnNpZ25lZCBp
bnQgICBpOwotICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlhbCA9
IHBhZ2UtPnBhcnRpYWxfcHRlOworICAgIGludCAgICAgICAgICAgIHJjID0g
MDsKKyAgICB1bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+
cGFydGlhbF9mbGFnczsKIAogICAgIHBsMmUgPSBtYXBfZG9tYWluX3BhZ2Uo
X21mbihwZm4pKTsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlczsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAg
IGkrKywgcGFydGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9m
bGFncyA9IDAgKQogICAgIHsKICAgICAgICAgbDJfcGdlbnRyeV90IGwyZTsK
IApAQCAtMTQ5MSwxNyArMTUxMSwxOCBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgICAgIHJjID0gLUVJTlRSOwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UKLSAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9s
MmUobDJlLCBwZm4sIGQsIHBhcnRpYWwpOworICAgICAgICAgICAgcmMgPSBn
ZXRfcGFnZV9mcm9tX2wyZShsMmUsIHBmbiwgZCwgcGFydGlhbF9mbGFncyk7
CiAKICAgICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgICAgICB7
CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0g
ICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzogMTsK
KyAgICAgICAgICAgIC8qIFNldCAnc2V0JywgcmV0YWluICdnZW5lcmFsIHJl
ZicgKi8KKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBwYXJ0
aWFsX2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAgICAg
ICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsK
ICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAg
ICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAg
IHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICAgICAgcmMgPSAt
RVJFU1RBUlQ7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjIDwg
MCAmJiByYyAhPSAtRUlOVFIgKQpAQCAtMTUxMSw3ICsxNTMyLDcgQEAgc3Rh
dGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
LCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAgICAgICAgICBpZiAoIGkgKQog
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFs
X3B0ZSA9IDA7CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFn
cyA9IDA7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vl
c3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOwogICAgICAgICAgICAgfQpAQCAt
MTUzNSw3ICsxNTU2LDggQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIHVuc2lnbmVkIGxvbmcgIHBm
biA9IG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKTsKICAgICBsM19wZ2VudHJ5
X3QgICpwbDNlOwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAg
ICAgICAgICAgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7
CisgICAgaW50ICAgICAgICAgICAgcmMgPSAwOworICAgIHVuc2lnbmVkIGlu
dCAgIHBhcnRpYWxfZmxhZ3MgPSBwYWdlLT5wYXJ0aWFsX2ZsYWdzOwogCiAg
ICAgcGwzZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCkBAIC0x
NTUwLDcgKzE1NzIsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgIG1lbXNldChwbDNlICsg
NCwgMCwgKEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gNCkgKiBzaXplb2YoKnBs
M2UpKTsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
czsgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywg
cGFydGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9
IDAgKQogICAgIHsKICAgICAgICAgbDNfcGdlbnRyeV90IGwzZSA9IHBsM2Vb
aV07CiAKQEAgLTE1NjksNyArMTU5MSw4IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAg
IGVsc2UKICAgICAgICAgICAgICAgICByYyA9IGdldF9wYWdlX2FuZF90eXBl
X2Zyb21fbWZuKAogICAgICAgICAgICAgICAgICAgICBsM2VfZ2V0X21mbihs
M2UpLAotICAgICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90YWJsZSB8
IFBHVF9wYWVfeGVuX2wyLCBkLCBwYXJ0aWFsLCAxKTsKKyAgICAgICAgICAg
ICAgICAgICAgUEdUX2wyX3BhZ2VfdGFibGUgfCBQR1RfcGFlX3hlbl9sMiwg
ZCwKKyAgICAgICAgICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8IFBURl9w
cmVlbXB0aWJsZSk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoICEo
bDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAg
ICB7CkBAIC0xNTc4LDE3ICsxNjAxLDE4IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAg
IHJjID0gLUVJTlRSOwogICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAg
ICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sM2UobDNlLCBwZm4sIGQsIHBh
cnRpYWwpOworICAgICAgICAgICAgcmMgPSBnZXRfcGFnZV9mcm9tX2wzZShs
M2UsIHBmbiwgZCwgcGFydGlhbF9mbGFncyk7CiAKICAgICAgICAgaWYgKCBy
YyA9PSAtRVJFU1RBUlQgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdl
LT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBwYWdlLT5w
YXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzogMTsKKyAgICAgICAgICAgIC8qIFNl
dCAnc2V0JywgbGVhdmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRy
eSB3YXMgc2V0ICovCisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gcGFydGlhbF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsKICAgICAgICAg
fQogICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAg
ICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAgICAgICAgICAg
IHJjID0gLUVSRVNUQVJUOwogICAgICAgICB9CiAgICAgICAgIGlmICggcmMg
PCAwICkKQEAgLTE2MDYsNyArMTYzMCw3IEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgaWYg
KCBpICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUg
PSAwOworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CiAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVM
TDsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxl
ID0gcGFnZTsKICAgICAgICAgfQpAQCAtMTc0MCwxMCArMTc2NCwxMSBAQCBz
dGF0aWMgaW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgdW5zaWduZWQgbG9uZyAgcGZuID0gbWZuX3gocGFnZV90b19t
Zm4ocGFnZSkpOwogICAgIGw0X3BnZW50cnlfdCAgKnBsNGUgPSBtYXBfZG9t
YWluX3BhZ2UoX21mbihwZm4pKTsKICAgICB1bnNpZ25lZCBpbnQgICBpOwot
ICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlhbCA9IHBhZ2UtPnBh
cnRpYWxfcHRlOworICAgIGludCAgICAgICAgICAgIHJjID0gMDsKKyAgICB1
bnNpZ25lZCBpbnQgICBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+cGFydGlhbF9m
bGFnczsKIAogICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
czsgaSA8IEw0X1BBR0VUQUJMRV9FTlRSSUVTOwotICAgICAgICAgIGkrKywg
cGFydGlhbCA9IDAgKQorICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFncyA9
IDAgKQogICAgIHsKICAgICAgICAgbDRfcGdlbnRyeV90IGw0ZTsKIApAQCAt
MTc1OSwxMiArMTc4NCwxMyBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3RhYmxl
KHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICByYyA9IC1F
SU5UUjsKICAgICAgICAgfQogICAgICAgICBlbHNlCi0gICAgICAgICAgICBy
YyA9IGdldF9wYWdlX2Zyb21fbDRlKGw0ZSwgcGZuLCBkLCBwYXJ0aWFsKTsK
KyAgICAgICAgICAgIHJjID0gZ2V0X3BhZ2VfZnJvbV9sNGUobDRlLCBwZm4s
IGQsIHBhcnRpYWxfZmxhZ3MpOwogCiAgICAgICAgIGlmICggcmMgPT0gLUVS
RVNUQVJUICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSBwYXJ0aWFsID86IDE7CisgICAgICAgICAgICAvKiBTZXQgJ3NldCcs
IGxlYXZlICdnZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNl
dCAqLworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRp
YWxfZmxhZ3MgfCBQVEZfcGFydGlhbF9zZXQ7CiAgICAgICAgIH0KICAgICAg
ICAgZWxzZSBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsKQEAgLTE3NzQsNyAr
MTgwMCw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgIGlmICggaSApCiAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0
ZXMgPSBpOwotICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
MDsKKyAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsK
ICAgICAgICAgICAgICAgICBpZiAoIHJjID09IC1FSU5UUiApCiAgICAgICAg
ICAgICAgICAgICAgIHJjID0gLUVSRVNUQVJUOwogICAgICAgICAgICAgICAg
IGVsc2UKQEAgLTE4MjYsMTkgKzE4NTIsMjAgQEAgc3RhdGljIGludCBmcmVl
X2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgc3RydWN0
IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogICAgIHVuc2ln
bmVkIGxvbmcgcGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwogICAg
IGwyX3BnZW50cnlfdCAqcGwyZTsKLSAgICBpbnQgcmMgPSAwLCBwYXJ0aWFs
ID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0gICAgdW5zaWduZWQgaW50IGkgPSBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFsOworICAgIGludCBy
YyA9IDA7CisgICAgdW5zaWduZWQgaW50IHBhcnRpYWxfZmxhZ3MgPSBwYWdl
LT5wYXJ0aWFsX2ZsYWdzLAorICAgICAgICBpID0gcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgLSAhKHBhcnRpYWxfZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQp
OwogCiAgICAgcGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwog
CiAgICAgZm9yICggOyA7ICkKICAgICB7CiAgICAgICAgIGlmICggaXNfZ3Vl
c3RfbDJfc2xvdChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkgKQot
ICAgICAgICAgICAgcmMgPSBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBw
Zm4sIHBhcnRpYWwsIGZhbHNlKTsKKyAgICAgICAgICAgIHJjID0gcHV0X3Bh
Z2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAg
ICAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAg
ICAgICAgcGFydGlhbCA9IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAw
OwogCiAgICAgICAgIGlmICggIWktLSApCiAgICAgICAgICAgICBicmVhazsK
QEAgLTE4NjAsMTIgKzE4ODcsMTQgQEAgc3RhdGljIGludCBmcmVlX2wyX3Rh
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgZWxzZSBpZiAoIHJj
ID09IC1FUkVTVEFSVCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0g
cGFydGlhbCA/OiAtMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IChwYXJ0aWFsX2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/CisgICAgICAg
ICAgICBwYXJ0aWFsX2ZsYWdzIDoKKyAgICAgICAgICAgIChQVEZfcGFydGlh
bF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CiAgICAgfQogICAg
IGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJMRV9F
TlRSSUVTIC0gMSApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGkgKyAxOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IDA7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAg
ICByYyA9IC1FUkVTVEFSVDsKICAgICB9CiAKQEAgLTE4NzcsMTggKzE5MDYs
MTkgQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2lu
Zm8gKnBhZ2UpCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293
bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcgcGZuID0gbWZuX3gocGFn
ZV90b19tZm4ocGFnZSkpOwogICAgIGwzX3BnZW50cnlfdCAqcGwzZTsKLSAg
ICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7Ci0g
ICAgdW5zaWduZWQgaW50ICBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
LSAhcGFydGlhbDsKKyAgICBpbnQgcmMgPSAwOworICAgIHVuc2lnbmVkIGlu
dCBwYXJ0aWFsX2ZsYWdzID0gcGFnZS0+cGFydGlhbF9mbGFncywKKyAgICAg
ICAgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzIC0gIShwYXJ0aWFsX2Zs
YWdzICYgUFRGX3BhcnRpYWxfc2V0KTsKIAogICAgIHBsM2UgPSBtYXBfZG9t
YWluX3BhZ2UoX21mbihwZm4pKTsKIAogICAgIGZvciAoIDsgOyApCiAgICAg
ewotICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0sIHBm
biwgcGFydGlhbCwgMCk7CisgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9s
M2UocGwzZVtpXSwgcGZuLCBwYXJ0aWFsX2ZsYWdzKTsKICAgICAgICAgaWYg
KCByYyA8IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgcGFy
dGlhbCA9IDA7CisgICAgICAgIHBhcnRpYWxfZmxhZ3MgPSAwOwogICAgICAg
ICBpZiAoIHJjID09IDAgKQogICAgICAgICAgICAgcGwzZVtpXSA9IHVuYWRq
dXN0X2d1ZXN0X2wzZShwbDNlW2ldLCBkKTsKIApAQCAtMTkwNywxMiArMTkz
NywxNCBAQCBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAg
ewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAtMTsKKyAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFsX2ZsYWdzICYgUFRG
X3BhcnRpYWxfc2V0KSA/CisgICAgICAgICAgICBwYXJ0aWFsX2ZsYWdzIDoK
KyAgICAgICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9n
ZW5lcmFsX3JlZik7CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9PSAtRUlO
VFIgJiYgaSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAgICAgewog
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGkgKyAxOwotICAg
ICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgIHBhZ2UtPnBh
cnRpYWxfZmxhZ3MgPSAwOwogICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAg
ICB9CiAgICAgcmV0dXJuIHJjID4gMCA/IDAgOiByYzsKQEAgLTE5MjMsMjYg
KzE5NTUsMjkgQEAgc3RhdGljIGludCBmcmVlX2w0X3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2Vf
Z2V0X293bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcgcGZuID0gbWZu
X3gocGFnZV90b19tZm4ocGFnZSkpOwogICAgIGw0X3BnZW50cnlfdCAqcGw0
ZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwotICAgIGludCByYyA9
IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKLSAgICB1bnNpZ25l
ZCBpbnQgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFs
OworICAgIGludCByYyA9IDA7CisgICAgdW5zaWduZWQgcGFydGlhbF9mbGFn
cyA9IHBhZ2UtPnBhcnRpYWxfZmxhZ3MsCisgICAgICAgIGkgPSBwYWdlLT5u
cl92YWxpZGF0ZWRfcHRlcyAtICEocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0
aWFsX3NldCk7CiAKICAgICBkbyB7CiAgICAgICAgIGlmICggaXNfZ3Vlc3Rf
bDRfc2xvdChkLCBpKSApCi0gICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zy
b21fbDRlKHBsNGVbaV0sIHBmbiwgcGFydGlhbCwgMCk7CisgICAgICAgICAg
ICByYyA9IHB1dF9wYWdlX2Zyb21fbDRlKHBsNGVbaV0sIHBmbiwgcGFydGlh
bF9mbGFncyk7CiAgICAgICAgIGlmICggcmMgPCAwICkKICAgICAgICAgICAg
IGJyZWFrOwotICAgICAgICBwYXJ0aWFsID0gMDsKKyAgICAgICAgcGFydGlh
bF9mbGFncyA9IDA7CiAgICAgfSB3aGlsZSAoIGktLSApOwogCiAgICAgaWYg
KCByYyA9PSAtRVJFU1RBUlQgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJf
dmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0
ZSA9IHBhcnRpYWwgPzogLTE7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxh
Z3MgPSAocGFydGlhbF9mbGFncyAmIFBURl9wYXJ0aWFsX3NldCkgPworICAg
ICAgICAgICAgcGFydGlhbF9mbGFncyA6CisgICAgICAgICAgICAoUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpOwogICAgIH0K
ICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMNF9QQUdFVEFC
TEVfRU5UUklFUyAtIDEgKQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpICsgMTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSAwOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKICAg
ICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgfQogCkBAIC0yMjE5LDcgKzIy
NTQsNyBAQCBzdGF0aWMgaW50IG1vZF9sMl9lbnRyeShsMl9wZ2VudHJ5X3Qg
KnBsMmUsCiAgICAgICAgIHJldHVybiAtRUJVU1k7CiAgICAgfQogCi0gICAg
cHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgbWZuX3gobWZuKSwgMCwgdHJ1ZSk7
CisgICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgbWZuX3gobWZuKSwgUFRG
X2RlZmVyKTsKIAogICAgIHJldHVybiByYzsKIH0KQEAgLTIyODcsNyArMjMy
Miw3IEBAIHN0YXRpYyBpbnQgbW9kX2wzX2VudHJ5KGwzX3BnZW50cnlfdCAq
cGwzZSwKICAgICAgICAgaWYgKCAhY3JlYXRlX3BhZV94ZW5fbWFwcGluZ3Mo
ZCwgcGwzZSkgKQogICAgICAgICAgICAgQlVHKCk7CiAKLSAgICBwdXRfcGFn
ZV9mcm9tX2wzZShvbDNlLCBtZm5feChtZm4pLCAwLCAxKTsKKyAgICBwdXRf
cGFnZV9mcm9tX2wzZShvbDNlLCBtZm5feChtZm4pLCBQVEZfZGVmZXIpOwog
ICAgIHJldHVybiByYzsKIH0KIApAQCAtMjM1MCw3ICsyMzg1LDcgQEAgc3Rh
dGljIGludCBtb2RfbDRfZW50cnkobDRfcGdlbnRyeV90ICpwbDRlLAogICAg
ICAgICByZXR1cm4gLUVGQVVMVDsKICAgICB9CiAKLSAgICBwdXRfcGFnZV9m
cm9tX2w0ZShvbDRlLCBtZm5feChtZm4pLCAwLCAxKTsKKyAgICBwdXRfcGFn
ZV9mcm9tX2w0ZShvbDRlLCBtZm5feChtZm4pLCBQVEZfZGVmZXIpOwogICAg
IHJldHVybiByYzsKIH0KICNlbmRpZiAvKiBDT05GSUdfUFYgKi8KQEAgLTI2
MTksNyArMjY1NCw3IEBAIGludCBmcmVlX3BhZ2VfdHlwZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgaWYgKCAh
KHR5cGUgJiBQR1RfcGFydGlhbCkgKQogICAgIHsKICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMgPSAxVSA8PCBQQUdFVEFCTEVfT1JERVI7Ci0g
ICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgcGFnZS0+
cGFydGlhbF9mbGFncyA9IDA7CiAgICAgfQogCiAgICAgc3dpdGNoICggdHlw
ZSAmIFBHVF90eXBlX21hc2sgKQpAQCAtMjkxMiw3ICsyOTQ3LDcgQEAgc3Rh
dGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
LCB1bnNpZ25lZCBsb25nIHR5cGUsCiAgICAgICAgIGlmICggISh4ICYgUEdU
X3BhcnRpYWwpICkKICAgICAgICAgewogICAgICAgICAgICAgcGFnZS0+bnJf
dmFsaWRhdGVkX3B0ZXMgPSAwOwotICAgICAgICAgICAgcGFnZS0+cGFydGlh
bF9wdGUgPSAwOworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IDA7CiAgICAgICAgIH0KICAgICAgICAgcGFnZS0+bGluZWFyX3B0X2NvdW50
ID0gMDsKICAgICAgICAgcmMgPSBhbGxvY19wYWdlX3R5cGUocGFnZSwgdHlw
ZSwgcHJlZW1wdGlibGUpOwpAQCAtMzA4OCw3ICszMTIzLDcgQEAgaW50IG5l
d19ndWVzdF9jcjMobWZuX3QgbWZuKQogICAgICAgICByZXR1cm4gMDsKICAg
ICB9CiAKLSAgICByYyA9IGdldF9wYWdlX2FuZF90eXBlX2Zyb21fbWZuKG1m
biwgUEdUX3Jvb3RfcGFnZV90YWJsZSwgZCwgMCwgMSk7CisgICAgcmMgPSBn
ZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihtZm4sIFBHVF9yb290X3BhZ2Vf
dGFibGUsIGQsIFBURl9wcmVlbXB0aWJsZSk7CiAgICAgc3dpdGNoICggcmMg
KQogICAgIHsKICAgICBjYXNlIDA6CkBAIC0zNDM5LDcgKzM0NzQsNyBAQCBs
b25nIGRvX21tdWV4dF9vcCgKICAgICAgICAgICAgIGlmICggb3AuYXJnMS5t
Zm4gIT0gMCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMg
PSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKLSAgICAgICAgICAgICAg
ICAgICAgX21mbihvcC5hcmcxLm1mbiksIFBHVF9yb290X3BhZ2VfdGFibGUs
IGN1cnJkLCAwLCAxKTsKKyAgICAgICAgICAgICAgICAgICAgX21mbihvcC5h
cmcxLm1mbiksIFBHVF9yb290X3BhZ2VfdGFibGUsIGN1cnJkLCBQVEZfcHJl
ZW1wdGlibGUpOwogCiAgICAgICAgICAgICAgICAgaWYgKCB1bmxpa2VseShy
YykgKQogICAgICAgICAgICAgICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaApp
bmRleCAzODYzZTRjZTU3Li4wZTYyOGZhNDE3IDEwMDY0NAotLS0gYS94ZW4v
aW5jbHVkZS9hc20teDg2L21tLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9tbS5oCkBAIC0yMzEsMTkgKzIzMSwzNCBAQCBzdHJ1Y3QgcGFnZV9pbmZv
CiAgICAgICAgICAqIHNldHRpbmcgdGhlIGZsYWcgbXVzdCBub3QgZHJvcCB0
aGF0IHJlZmVyZW5jZSwgd2hlcmVhcyB0aGUgaW5zdGFuY2UKICAgICAgICAg
ICogY2xlYXJpbmcgaXQgd2lsbCBoYXZlIHRvLgogICAgICAgICAgKgotICAg
ICAgICAgKiBJZiBAcGFydGlhbF9wdGUgaXMgcG9zaXRpdmUgdGhlbiBQVEUg
YXQgQG5yX3ZhbGlkYXRlZF9wdGVzKzEgaGFzCi0gICAgICAgICAqIGJlZW4g
cGFydGlhbGx5IHZhbGlkYXRlZC4gVGhpcyBpbXBsaWVzIHRoYXQgdGhlIGdl
bmVyYWwgcmVmZXJlbmNlCi0gICAgICAgICAqIHRvIHRoZSBwYWdlIChhY3F1
aXJlZCBmcm9tIGdldF9wYWdlX2Zyb21fbE5lKCkpIHdvdWxkIGJlIGRyb3Bw
ZWQKLSAgICAgICAgICogKGFnYWluIGR1ZSB0byB0aGUgYXBwYXJlbnQgZmFp
bHVyZSkgYW5kIGhlbmNlIG11c3QgYmUgcmUtYWNxdWlyZWQKLSAgICAgICAg
ICogd2hlbiByZXN1bWluZyB0aGUgdmFsaWRhdGlvbiwgYnV0IG11c3Qgbm90
IGJlIGRyb3BwZWQgd2hlbiBwaWNraW5nCi0gICAgICAgICAqIHVwIHRoZSBw
YWdlIGZvciBpbnZhbGlkYXRpb24uCisgICAgICAgICAqIElmIHBhcnRpYWxf
ZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIHRoZSBwYWdl
IGF0CisgICAgICAgICAqIGF0IEBucl92YWxpZGF0ZWRfcHRlcyBoYWQgUEdU
X3BhcnRpYWwgc2V0IGFzIGEgcmVzdWx0IG9mIGFuCisgICAgICAgICAqIG9w
ZXJhdGlvbiBvbiB0aGUgY3VycmVudCBwYWdlLiAgKFRoYXQgcGFnZSBtYXkg
b3IgbWF5IG5vdAorICAgICAgICAgKiBzdGlsbCBoYXZlIFBHVF9wYXJ0aWFs
IHNldC4pCiAgICAgICAgICAqCi0gICAgICAgICAqIElmIEBwYXJ0aWFsX3B0
ZSBpcyBuZWdhdGl2ZSB0aGVuIFBURSBhdCBAbnJfdmFsaWRhdGVkX3B0ZXMr
MSBoYXMKLSAgICAgICAgICogYmVlbiBwYXJ0aWFsbHkgaW52YWxpZGF0ZWQu
IFRoaXMgaXMgYmFzaWNhbGx5IHRoZSBvcHBvc2l0ZSBjYXNlIG9mCi0gICAg
ICAgICAqIGFib3ZlLCBpLmUuIHRoZSBnZW5lcmFsIHJlZmVyZW5jZSB0byB0
aGUgcGFnZSB3YXMgbm90IGRyb3BwZWQgaW4KLSAgICAgICAgICogcHV0X3Bh
Z2VfZnJvbV9sTmUoKSAoZHVlIHRvIHRoZSBhcHBhcmVudCBmYWlsdXJlKSwg
YW5kIGhlbmNlIGl0Ci0gICAgICAgICAqIG11c3QgYmUgZHJvcHBlZCB3aGVu
IHRoZSBwdXQgb3BlcmF0aW9uIGlzIHJlc3VtZWQgKGFuZCBjb21wbGV0ZXMp
LAotICAgICAgICAgKiBidXQgaXQgbXVzdCBub3QgYmUgYWNxdWlyZWQgaWYg
cGlja2luZyB1cCB0aGUgcGFnZSBmb3IgdmFsaWRhdGlvbi4KKyAgICAgICAg
ICogSWYgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgc2V0LCB0aGVuIHRo
ZSBQVEUgYXQKKyAgICAgICAgICogQG5yX3ZhbGlkYXRlZF9wdGVmIGhvbGRz
IGEgZ2VuZXJhbCByZWZlcmVuY2UgY291bnQgZm9yIHRoZQorICAgICAgICAg
KiBwYWdlLgorICAgICAgICAgKgorICAgICAgICAgKiBUaGlzIGhhcHBlbnM6
CisgICAgICAgICAqIC0gRHVyaW5nIGRlLXZhbGlkYXRpb24sIGlmIGRlLXZh
bGlkYXRpb24gb2YgdGhlIHBhZ2Ugd2FzCisgICAgICAgICAqICAgaW50ZXJy
dXB0ZWQKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiwgaWYgYW4g
aW52YWxpZCBlbnRyeSBpcyBlbmNvdW50ZXJlZCBhbmQKKyAgICAgICAgICog
ICB2YWxpZGF0aW9uIGlzIHByZWVtcHRpYmxlCisgICAgICAgICAqIC0gRHVy
aW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIHdh
cyBzZXQgb24KKyAgICAgICAgICogICB0aGlzIGVudHJ5IHRvIGJlZ2luIHdp
dGggKHBlcmhhcHMgYmVjYXVzZSB3ZSdyZSBwaWNraW5nCisgICAgICAgICAq
ICAgdXAgZnJvbSBhIHBhcnRpYWwgZGUtdmFsaWRhdGlvbikuCisgICAgICAg
ICAqCisgICAgICAgICAqIFdoZW4gcmVzdW1pbmcgdmFsaWRhdGlvbiwgaWYg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgaXMgY2xlYXIsCisgICAgICAgICAq
IHRoZW4gYSBnZW5lcmFsIHJlZmVyZW5jZSBtdXN0IGJlIHJlLWFjcXVpcmVk
OyBpZiBpdCBpcyBzZXQsIG5vCisgICAgICAgICAqIHJlZmVyZW5jZSBzaG91
bGQgYmUgYWNxdWlyZWQuCisgICAgICAgICAqCisgICAgICAgICAqIFdoZW4g
cmVzdW1pbmcgZGUtdmFsaWRhdGlvbiwgaWYgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYgaXMKKyAgICAgICAgICogY2xlYXIsIG5vIHJlZmVyZW5jZSBzaG91
bGQgYmUgZHJvcHBlZDsgaWYgaXQgaXMgc2V0LCBhCisgICAgICAgICAqIHJl
ZmVyZW5jZSBzaG91bGQgYmUgZHJvcHBlZC4KKyAgICAgICAgICoKKyAgICAg
ICAgICogTkIgdGhhdCBQVEZfcGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0aWFs
X2dlbmVyYWxfcmVmIGFyZQorICAgICAgICAgKiBkZWZpbmVkIGluIG1tLmMs
IHRoZSBvbmx5IHBsYWNlIHdoZXJlIHRoZXkgYXJlIHVzZWQuCiAgICAgICAg
ICAqCiAgICAgICAgICAqIFRoZSAzcmQgZmllbGQsIEBsaW5lYXJfcHRfY291
bnQsIGluZGljYXRlcwogICAgICAgICAgKiAtIGJ5IGEgcG9zaXRpdmUgdmFs
dWUsIGhvdyBtYW55IHNhbWUtbGV2ZWwgcGFnZSB0YWJsZSBlbnRyaWVzIGEg
cGFnZQpAQCAtMjU0LDcgKzI2OSw3IEBAIHN0cnVjdCBwYWdlX2luZm8KICAg
ICAgICAgc3RydWN0IHsKICAgICAgICAgICAgIHUxNiBucl92YWxpZGF0ZWRf
cHRlczpQQUdFVEFCTEVfT1JERVIgKyAxOwogICAgICAgICAgICAgdTE2IDox
NiAtIFBBR0VUQUJMRV9PUkRFUiAtIDEgLSAyOwotICAgICAgICAgICAgczE2
IHBhcnRpYWxfcHRlOjI7CisgICAgICAgICAgICB1MTYgcGFydGlhbF9mbGFn
czoyOwogICAgICAgICAgICAgczE2IGxpbmVhcl9wdF9jb3VudDsKICAgICAg
ICAgfTsKIAotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Disposition: attachment;
 filename="xsa299/0004-x86-mm-Use-flags-for-_put_page_type-rather-than-a-bo.patch"
Content-Transfer-Encoding: base64

RnJvbSAwN2NjNzI4MjY3YWQxZTY1OTc1N2FjMmEzMmU0Njc0MzhkYWUxMDMy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA0LzExXSB4
ODYvbW06IFVzZSBmbGFncyBmb3IgX3B1dF9wYWdlX3R5cGUgcmF0aGVyIHRo
YW4gYQogYm9vbGVhbgoKVGhpcyBpcyBpbiBtYWlubHkgaW4gcHJlcGFyYXRp
b24gZm9yIF9wdXRfcGFnZV90eXBlIHRha2luZyB0aGUKcGFydGlhbF9mbGFn
cyB2YWx1ZSBpbiB0aGUgZnV0dXJlLiAgSXQgYWxzbyBtYWtlcyBpdCBlYXNp
ZXIgdG8gcmVhZCBpbgp0aGUgY2FsbGVyIChzaW5jZSB5b3Ugc2VlIGEgZmxh
ZyBuYW1lIHJhdGhlciB0aGFuIGB0cnVlYCBvciBgZmFsc2VgKS4KCk5vIGZ1
bmN0aW9uYWwgY2hhbmdlIGludGVuZGVkLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0yOTkuCgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2
L21tLmMgfCAyNSArKysrKysrKysrKysrLS0tLS0tLS0tLS0tCiAxIGZpbGUg
Y2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA2YWJkZDIwYjg5Li42OGQxN2RiNGFkIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTE3MCw3ICsxMTcwLDcgQEAgZ2V0X3BhZ2VfZnJvbV9sNGUoCiB9CiAj
ZW5kaWYgLyogQ09ORklHX1BWICovCiAKLXN0YXRpYyBpbnQgX3B1dF9wYWdl
X3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgYm9vbCBwcmVlbXB0aWJs
ZSwKK3N0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwdHBnKTsKIAogdm9pZCBw
dXRfcGFnZV9mcm9tX2wxZShsMV9wZ2VudHJ5X3QgbDFlLCBzdHJ1Y3QgZG9t
YWluICpsMWVfb3duZXIpCkBAIC0xMjkwLDcgKzEyOTAsNyBAQCBzdGF0aWMg
aW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2ln
bmVkIGxvbmcgcGZuLAogICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQg
KQogICAgICAgICB7CiAgICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBU
Rl9kZWZlcikpOwotICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShw
ZywgdHJ1ZSwgcHRwZyk7CisgICAgICAgICAgICByYyA9IF9wdXRfcGFnZV90
eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgICAg
IHsKQEAgLTEyOTksNyArMTI5OSw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2Vf
ZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4s
CiAgICAgICAgIH0KICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAg
ICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKKyAg
ICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0
aWJsZSwgcHRwZyk7CiAgICAgICAgICAgICBpZiAoIGxpa2VseSghcmMpICkK
ICAgICAgICAgICAgICAgICBwdXRfcGFnZShwZyk7CiAgICAgICAgIH0KQEAg
LTEzMzYsNyArMTMzNiw3IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9s
M2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAg
ICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgIHsKICAgICAgICAgQVNTRVJU
KCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsKLSAgICAgICAgcmV0dXJuIF9wdXRf
cGFnZV90eXBlKHBnLCB0cnVlLCBtZm5fdG9fcGFnZShfbWZuKHBmbikpKTsK
KyAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1w
dGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZuKSkpOwogICAgIH0KIAogICAg
IGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQpAQCAtMTM0Niw3ICsxMzQ2LDcg
QEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19wZ2VudHJ5X3Qg
bDNlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgcmV0dXJuIDA7CiAg
ICAgfQogCi0gICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgbWZu
X3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAgcmMgPSBfcHV0X3BhZ2VfdHlw
ZShwZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9fcGFnZShfbWZuKHBmbikp
KTsKICAgICBpZiAoIGxpa2VseSghcmMpICkKICAgICAgICAgcHV0X3BhZ2Uo
cGcpOwogCkBAIC0xMzY3LDcgKzEzNjcsNyBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcg
cGZuLAogICAgICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBBU1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikp
OwotICAgICAgICAgICAgcmV0dXJuIF9wdXRfcGFnZV90eXBlKHBnLCB0cnVl
LCBtZm5fdG9fcGFnZShfbWZuKHBmbikpKTsKKyAgICAgICAgICAgIHJldHVy
biBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBtZm5fdG9f
cGFnZShfbWZuKHBmbikpKTsKICAgICAgICAgfQogCiAgICAgICAgIGlmICgg
ZmxhZ3MgJiBQVEZfZGVmZXIgKQpAQCAtMTM3Nyw3ICsxMzc3LDcgQEAgc3Rh
dGljIGludCBwdXRfcGFnZV9mcm9tX2w0ZShsNF9wZ2VudHJ5X3QgbDRlLCB1
bnNpZ25lZCBsb25nIHBmbiwKICAgICAgICAgICAgIHJldHVybiAwOwogICAg
ICAgICB9CiAKLSAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1
ZSwgbWZuX3RvX3BhZ2UoX21mbihwZm4pKSk7CisgICAgICAgIHJjID0gX3B1
dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2Uo
X21mbihwZm4pKSk7CiAgICAgICAgIGlmICggbGlrZWx5KCFyYykgKQogICAg
ICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgIH0KQEAgLTI3MjcsMTAgKzI3
MjcsMTEgQEAgc3RhdGljIGludCBfcHV0X2ZpbmFsX3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiB9CiAK
IAotc3RhdGljIGludCBfcHV0X3BhZ2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZv
ICpwYWdlLCBib29sIHByZWVtcHRpYmxlLAorc3RhdGljIGludCBfcHV0X3Bh
Z2VfdHlwZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBpbnQg
ZmxhZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBwYWdl
X2luZm8gKnB0cGcpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBueCwgeCwgeSA9
IHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvOworICAgIGJvb2wgcHJlZW1wdGli
bGUgPSBmbGFncyAmIFBURl9wcmVlbXB0aWJsZTsKIAogICAgIEFTU0VSVChj
dXJyZW50X2xvY2tlZF9wYWdlX25lX2NoZWNrKHBhZ2UpKTsKIApAQCAtMjkz
Niw3ICsyOTM3LDcgQEAgc3RhdGljIGludCBfZ2V0X3BhZ2VfdHlwZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUsCiAKICAg
ICAgICAgICAgIGlmICggdW5saWtlbHkocmMpICkKICAgICAgICAgICAgIHsK
LSAgICAgICAgICAgICAgICBfcHV0X3BhZ2VfdHlwZShwYWdlLCBmYWxzZSwg
TlVMTCk7CisgICAgICAgICAgICAgICAgX3B1dF9wYWdlX3R5cGUocGFnZSwg
MCwgTlVMTCk7CiAgICAgICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAg
ICAgICB9CiAgICAgICAgIH0KQEAgLTI5NjIsNyArMjk2Myw3IEBAIHN0YXRp
YyBpbnQgX2dldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwg
dW5zaWduZWQgbG9uZyB0eXBlLAogCiB2b2lkIHB1dF9wYWdlX3R5cGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKIHsKLSAgICBpbnQgcmMgPSBfcHV0X3Bh
Z2VfdHlwZShwYWdlLCBmYWxzZSwgTlVMTCk7CisgICAgaW50IHJjID0gX3B1
dF9wYWdlX3R5cGUocGFnZSwgMCwgTlVMTCk7CiAgICAgQVNTRVJUKHJjID09
IDApOwogICAgICh2b2lkKXJjOwogfQpAQCAtMjk3OSw3ICsyOTgwLDcgQEAg
aW50IGdldF9wYWdlX3R5cGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5z
aWduZWQgbG9uZyB0eXBlKQogCiBpbnQgcHV0X3BhZ2VfdHlwZV9wcmVlbXB0
aWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogewotICAgIHJldHVybiBf
cHV0X3BhZ2VfdHlwZShwYWdlLCB0cnVlLCBOVUxMKTsKKyAgICByZXR1cm4g
X3B1dF9wYWdlX3R5cGUocGFnZSwgUFRGX3ByZWVtcHRpYmxlLCBOVUxMKTsK
IH0KIAogaW50IGdldF9wYWdlX3R5cGVfcHJlZW1wdGlibGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQpAQCAtMjk5Niw3
ICsyOTk3LDcgQEAgaW50IHB1dF9vbGRfZ3Vlc3RfdGFibGUoc3RydWN0IHZj
cHUgKnYpCiAgICAgaWYgKCAhdi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQog
ICAgICAgICByZXR1cm4gMDsKIAotICAgIHN3aXRjaCAoIHJjID0gX3B1dF9w
YWdlX3R5cGUodi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUsIHRydWUsCisgICAg
c3dpdGNoICggcmMgPSBfcHV0X3BhZ2VfdHlwZSh2LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSwgUFRGX3ByZWVtcHRpYmxlLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZykgKQogICAg
IHsKICAgICBjYXNlIC1FSU5UUjoKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Disposition: attachment;
 filename="xsa299/0005-x86-mm-Rework-get_page_and_type_from_mfn-conditional.patch"
Content-Transfer-Encoding: base64

RnJvbSAxYjE5YjhkNjQzYjA3MmFiNGQ0Y2QyNWE2ODRkNzMxNWFiMGExNTEy
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA1LzExXSB4
ODYvbW06IFJld29yayBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbiBjb25k
aXRpb25hbAoKTWFrZSBpdCBlYXNpZXIgdG8gcmVhZCBieSBkZWNsYXJpbmcg
dGhlIGNvbmRpdGlvbnMgaW4gd2hpY2ggd2Ugd2lsbApyZXRhaW4gdGhlIHJl
ZiwgcmF0aGVyIHRoYW4gdGhlIGNvbmRpdGlvbnMgdW5kZXIgd2hpY2ggd2Ug
cmVsZWFzZSBpdC4KClRoZSBvbmx5IHdheSAocGFnZSA9PSBjdXJyZW50LT5h
cmNoLm9sZF9ndWVzdF90YWJsZSkgY2FuIGJlIHRydWUgaXMgaWYKcHJlZW1w
dGlibGUgaXMgdHJ1ZTsgc28gcmVtb3ZlIHRoaXMgZnJvbSB0aGUgcXVlcnkg
aXRzZWxmLCBhbmQgYWRkIGFuCkFTU0VSVCgpIHRvIHRoYXQgZWZmZWN0IG9u
IHRoZSBvcHBvc2l0ZSBwYXRoLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50
ZW5kZWQuCgpOQiB0aGF0IGFsbG9jX2xOX3RhYmxlKCkgbWlzaGFuZGxlIHRo
ZSAibGluZWFyIHB0IGZhaWx1cmUiIHNpdHVhdGlvbgpkZXNjcmliZWQgaW4g
dGhlIGNvbW1lbnQ7IHRoaXMgd2lsbCBiZSBhZGRyZXNzZWQgaW4gYSBmdXR1
cmUgcGF0Y2guCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDM5ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogMSBmaWxlIGNo
YW5nZWQsIDM3IGluc2VydGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCA2OGQxN2RiNGFkLi5kYTQ3YTY2ZjhiIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTA5Miw4ICsxMDkyLDQzIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5
cGVfZnJvbV9tZm4oCiAKICAgICByYyA9IF9nZXRfcGFnZV90eXBlKHBhZ2Us
IHR5cGUsIHByZWVtcHRpYmxlKTsKIAotICAgIGlmICggdW5saWtlbHkocmMp
ICYmICFwYXJ0aWFsX3JlZiAmJgotICAgICAgICAgKCFwcmVlbXB0aWJsZSB8
fCBwYWdlICE9IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKSApCisg
ICAgLyoKKyAgICAgKiBSZXRhaW4gdGhlIHJlZmNvdW50IGlmOgorICAgICAq
IC0gcGFnZSBpcyBmdWxseSB2YWxpZGF0ZWQgKHJjID09IDApCisgICAgICog
LSBwYWdlIGlzIG5vdCB2YWxpZGF0ZWQgKHJjIDwgMCkgYnV0OgorICAgICAq
ICAgLSBXZSBjYW1lIGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfcmVm
KQorICAgICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0
IHRoZXJlJ3MgYmVlbiBhbiBlcnJvcgorICAgICAqICAgICAocGFnZSA9PSBj
dXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkKKyAgICAgKgorICAgICAq
IFRoZSBwYXJ0aWFsX3JlZi1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4g
ZXhwbGFuYXRpb24uICBUaGVyZQorICAgICAqIGFyZSB0d28gc2NlbmFyaW9z
IHdoZXJlIHBhcnRpYWxfcmVmIG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgor
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBkZW1vdGVkIGFzIHR5
cGUgYHR5cGVgOyBpLmUuIGhhcworICAgICAqICAgUEdUX3BhcnRpYWwgc2V0
CisgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMg
TCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgorICAgICAqICAgcGFnZTsgZS5n
LiB3ZSdyZSBiZWluZyBjYWxsZWQgZnJvbSBnZXRfcGFnZV9mcm9tX2wyZSB3
aXRoCisgICAgICogICB0eXBlID09IFBHVF9sMV90YWJsZSwgYnV0IHRoZSBt
Zm4gaXMgUEdUX2wyX3RhYmxlKQorICAgICAqCisgICAgICogSWYgdGhlcmUn
cyBhbiBlcnJvciwgaW4gdGhlIGZpcnN0IGNhc2UsIF9nZXRfcGFnZV90eXBl
IHdpbGwKKyAgICAgKiBlaXRoZXIgcmV0dXJuIC1FUkVTVEFSVCwgaW4gd2hp
Y2ggY2FzZSB3ZSB3YW50IHRvIHJldGFpbiB0aGUKKyAgICAgKiByZWYgKGFz
IHRoZSBjYWxsZXIgd2lsbCBjb25zaWRlciBpdCByZXRhaW5lZCksIG9yIC1F
SU5WQUwsIGluCisgICAgICogd2hpY2ggY2FzZSBvbGRfZ3Vlc3RfdGFibGUg
d2lsbCBiZSBzZXQ7IGluIGJvdGggY2FzZXMsIHdlIG5lZWQKKyAgICAgKiB0
byByZXRhaW4gdGhlIHJlZi4KKyAgICAgKgorICAgICAqIEluIHRoZSBzZWNv
bmQgY2FzZSwgaWYgdGhlcmUncyBhbiBlcnJvciwgX2dldF9wYWdlX3R5cGUo
KSBjYW4KKyAgICAgKiAqb25seSogcmV0dXJuIC1FSU5WQUwsIGFuZCAqbmV2
ZXIqIHNldCBvbGRfZ3Vlc3RfdGFibGUuICBJbgorICAgICAqIHRoYXQgY2Fz
ZSB3ZSBhbHNvIHdhbnQgdG8gcmV0YWluIHRoZSByZWZlcmVuY2UsIHRvIGFs
bG93IHRoZQorICAgICAqIHBhZ2UgdG8gY29udGludWUgdG8gYmUgdG9ybiBk
b3duIChpLmUuLCBQR1RfcGFydGlhbCBjbGVhcmVkKQorICAgICAqIHNhZmVs
eS4KKyAgICAgKgorICAgICAqIEFsc28gbm90ZSB0aGF0IHdlIHNob3VsZG4n
dCBiZSBhYmxlIHRvIGxlYXZlIHdpdGggdGhlIHJlZmVyZW5jZQorICAgICAq
IGNvdW50IHJldGFpbmVkIHVubGVzcyB3ZSBzdWNjZWVkZWQsIG9yIHRoZSBv
cGVyYXRpb24gd2FzCisgICAgICogcHJlZW1wdGlibGUuCisgICAgICovCisg
ICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFsX3JlZiApCisgICAgICAg
IC8qIG5vdGhpbmcgKi87CisgICAgZWxzZSBpZiAoIHBhZ2UgPT0gY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQorICAgICAgICBBU1NFUlQocHJl
ZW1wdGlibGUpOworICAgIGVsc2UKICAgICAgICAgcHV0X3BhZ2UocGFnZSk7
CiAKICAgICByZXR1cm4gcmM7Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Disposition: attachment;
 filename="xsa299/0006-x86-mm-Have-alloc_l-23-_table-clear-partial_flags-wh.patch"
Content-Transfer-Encoding: base64

RnJvbSA5YzEzYzVjZDdmZmQwZjQyMWE4Y2ZkNjUxMDQ1MGI4ZGFjN2IxYzQw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA2LzExXSB4
ODYvbW06IEhhdmUgYWxsb2NfbFsyM11fdGFibGUgY2xlYXIgcGFydGlhbF9m
bGFncyB3aGVuCiBwcmVlbXB0aW5nCgpJbiBvcmRlciB0byBhbGxvdyByZWN1
cnNpdmUgcGFnZXRhYmxlIHByb21vdGlvbnMgYW5kIGRlbW90aW9ucyB0byBi
ZQppbnRlcnJ1cHRlZCwgWGVuIG11c3Qga2VlcCB0cmFjayBvZiB0aGUgc3Rh
dGUgb2YgdGhlIHN1Yi1wYWdlcwpwcm9tb3RlZCBvciBkZW1vdGVkLiAgVGhp
cyBpcyBzdG9yZWQgaW4gdHdvIGVsZW1lbnRzIGluIHRoZSBwYWdlCnN0cnVj
dDogbnJfZW50cmllc192YWxpZGF0ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpU
aGUgcnVsZSBpcyB0aGF0IGVudHJpZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRh
dGVkKSBzaG91bGQgYWx3YXlzIGJlCnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdl
bmVyYWwgcmVmZXJlbmNlIGNvdW50LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6
ZXJvLCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlk
YXRlZCBhbmQgbm8gcmVmZXJlbmNlCmNvdW50IGlzIGhlbGQuICBJZiBQVEZf
cGFydGlhbF9zZXQgaXMgc2V0LCB0aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRl
ZF0KaXMgcGFydGlhbGx5IHZhbGlkYXRlZC4KCkF0IHRoZSBtb21lbnQsIGEg
ZGlzdGluY3Rpb24gaXMgbWFkZSBiZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVt
b3Rpb24Kd2l0aCByZWdhcmQgdG8gd2hldGhlciB0aGUgZW50cnkgaXRzZWxm
ICJob2xkcyIgYSBnZW5lcmFsIHJlZmVyZW5jZQpjb3VudDogd2hlbiBlbnRy
eSBwcm9tb3Rpb24gaXMgaW50ZXJydXB0ZWQgKGkuZS4sIHJldHVybnMgLUVS
RVNUQVJUKSwKdGhlIGVudHJ5IGlzIG5vdCBjb25zaWRlcmVkIHRvIGhvbGQg
YSByZWZlcmVuY2U7IHdoZW4gZW50cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0
ZWQsIHRoZSBlbnRyeSBpcyBzdGlsbCBjb25zaWRlcmVkIHRvIGhvbGQgYSBn
ZW5lcmFsCnJlZmVyZW5jZS4KClBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IHVzZWQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYg
Y2xlYXIsIGl0J3MgYSBwYXJ0aWFsIHByb21vdGlvbiA9PiBubyBnZW5lcmFs
IHJlZmVyZW5jZSBjb3VudCBoZWxkCmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBp
dCdzIHBhcnRpYWwgZGVtb3Rpb24sIHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UK
Y291bnQgaGVsZC4gIEJlY2F1c2UgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25z
IGNhbiBiZSBpbnRlcmxlYXZlZCwgdGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8g
Z2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21f
bCplLAp0byBiZSBhYmxlIHRvIHByb3Blcmx5IGhhbmRsZSByZWZlcmVuY2Ug
Y291bnRzLgoKVW5mb3J0dW5hdGVseSwgd2hlbiBhbGxvY19sWzIzXV90YWJs
ZSBjaGVjayBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpCmFuZCByZXR1cm4g
LUVSRVNUQVJULCB0aGV5IHNldCBucl9lbnRyaWVzX3ZhbGlkYXRlZCwgYnV0
IGRvbid0IGNsZWFyCnBhcnRpYWxfZmxhZ3MuCgpJZiB3ZSB3ZXJlIHBpY2tp
bmcgdXAgZnJvbSBhIHByZXZpb3VzbHktaW50ZXJydXB0ZWQgcHJvbW90aW9u
LCB0aGF0Cm1lYW5zIHRoYXQgUFRGX3BhcnRpYWxfc2V0IHdvdWxkIGJlIHNl
dCBldmVuIHRob3VnaApbbnJfZW50cmllc192YWxpZGF0ZWRdIHdhcyBub3Qg
cGFydGlhbGx5IHZhbGlkYXRlZC4gIFRoaXMgbWVhbnMgdGhhdAppZiB0aGUg
cGFnZSBpbiB0aGlzIHN0YXRlIHdlcmUgZGUtdmFsaWRhdGVkLCBwdXRfcGFn
ZV90eXBlKCkgd291bGQKZXJyb25lb3VzbHkgYmUgY2FsbGVkIG9uIHRoYXQg
ZW50cnkuCgpQZXJoYXBzIHdvcnNlLCBpZiB3ZSB3ZXJlIHJhY2luZyB3aXRo
IGEgZGUtdmFsaWRhdGlvbiwgdGhlbiB3ZSBtaWdodApsZWF2ZSBib3RoIFBU
Rl9wYXJ0aWFsX3NldCBhbmQgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7IGFu
ZCB3aGVuCmRlLXZhbGlkYXRpb24gcGlja2VkIHVwIGFnYWluLCBib3RoIHRo
ZSB0eXBlIGFuZCB0aGUgZ2VuZXJhbCByZWYgd291bGQKYmUgZXJyb25lb3Vz
bHkgZHJvcHBlZCBmcm9tIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0uCgpJbiBh
IHNlbnNlLCB0aGUgcmVhbCBpc3N1ZSBoZXJlIGlzIGNvZGUgZHVwbGljYXRp
b24uICBSYXRoZXIgdGhhbgpkdXBsaWNhdGUgdGhlIGludGVycnVwdGlvbiBj
b2RlLCBzZXQgcmMgdG8gLUVJTlRSIGFuZCBmYWxsIHRocm91Z2ggdG8KdGhl
IGNvZGUgd2hpY2ggYWxyZWFkeSBoYW5kbGVzIHRoYXQgY2FzZSBjb3JyZWN0
bHkuCgpHaXZlbiB0aGUgbG9naWMgYXQgdGhpcyBwb2ludCwgaXQgc2hvdWxk
IGJlIGltcG9zc2libGUgZm9yCnBhcnRpYWxfZmxhZ3MgdG8gYmUgbm9uLXpl
cm87IGFkZCBhbiBBU1NFUlQoKSB0byBjYXRjaCBhbnkgY2hhbmdlcy4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgMjUgKysrKysrLS0tLS0tLS0tLS0t
LS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDYgaW5zZXJ0aW9ucygrKSwgMTkg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMg
Yi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBkYTQ3YTY2ZjhiLi4yNGNlOGQ3
YzUwIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4v
YXJjaC94ODYvbW0uYwpAQCAtMTUyNSwyMSArMTUyNSwxMyBAQCBzdGF0aWMg
aW50IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVu
c2lnbmVkIGxvbmcgdHlwZSkKICAgICBmb3IgKCBpID0gcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXM7IGkgPCBMMl9QQUdFVEFCTEVfRU5UUklFUzsKICAgICAg
ICAgICBpKyssIHBhcnRpYWxfZmxhZ3MgPSAwICkKICAgICB7Ci0gICAgICAg
IGwyX3BnZW50cnlfdCBsMmU7CisgICAgICAgIGwyX3BnZW50cnlfdCBsMmUg
PSBwbDJlW2ldOwogCiAgICAgICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQotICAg
ICAgICB7Ci0gICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKLSAgICAgICAgICAg
IGJyZWFrOwotICAgICAgICB9Ci0KLSAgICAgICAgaWYgKCAhaXNfZ3Vlc3Rf
bDJfc2xvdChkLCB0eXBlLCBpKSApCisgICAgICAgICAgICByYyA9IC1FSU5U
UjsKKyAgICAgICAgZWxzZSBpZiAoICFpc19ndWVzdF9sMl9zbG90KGQsIHR5
cGUsIGkpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwotCi0gICAgICAgIGwy
ZSA9IHBsMmVbaV07Ci0KLSAgICAgICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3Mo
bDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKKyAgICAgICAgZWxzZSBpZiAoICEo
bDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBpZiAoICFwdl9sMXRmX2NoZWNrX2wyZShkLCBs
MmUpICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTE2MTIsMTMg
KzE2MDQsOCBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCiAgICAgICAgIGwzX3BnZW50cnlfdCBsM2UgPSBw
bDNlW2ldOwogCiAgICAgICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlkYXRl
ZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQotICAgICAg
ICB7Ci0gICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7
Ci0gICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKLSAgICAgICAgICAgIGJy
ZWFrOwotICAgICAgICB9Ci0KLSAgICAgICAgaWYgKCBpc19wdl8zMmJpdF9k
b21haW4oZCkgJiYgKGkgPT0gMykgKQorICAgICAgICAgICAgcmMgPSAtRUlO
VFI7CisgICAgICAgIGVsc2UgaWYgKCBpc19wdl8zMmJpdF9kb21haW4oZCkg
JiYgKGkgPT0gMykgKQogICAgICAgICB7CiAgICAgICAgICAgICBpZiAoICEo
bDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgfHwKICAgICAg
ICAgICAgICAgICAgKGwzZV9nZXRfZmxhZ3MobDNlKSAmIGwzX2Rpc2FsbG93
X21hc2soZCkpICkKLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Disposition: attachment;
 filename="xsa299/0007-x86-mm-Always-retain-a-general-ref-on-partial.patch"
Content-Transfer-Encoding: base64

RnJvbSBiOWI4ZjlhNTU0ODA2MzcwODQ2MDlkMDdmOTRiNGM0NTNjNzFiOTUw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA3LzExXSB4
ODYvbW06IEFsd2F5cyByZXRhaW4gYSBnZW5lcmFsIHJlZiBvbiBwYXJ0aWFs
CgpJbiBvcmRlciB0byBhbGxvdyByZWN1cnNpdmUgcGFnZXRhYmxlIHByb21v
dGlvbnMgYW5kIGRlbW90aW9ucyB0byBiZQppbnRlcnJ1cHRlZCwgWGVuIG11
c3Qga2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIHN1Yi1wYWdlcwpw
cm9tb3RlZCBvciBkZW1vdGVkLiAgVGhpcyBpcyBzdG9yZWQgaW4gdHdvIGVs
ZW1lbnRzIGluIHRoZSBwYWdlIHN0cnVjdDoKbnJfZW50cmllc192YWxpZGF0
ZWQgYW5kIHBhcnRpYWxfZmxhZ3MuCgpUaGUgcnVsZSBpcyB0aGF0IGVudHJp
ZXMgWzAsIG5yX2VudHJpZXNfdmFsaWRhdGVkKSBzaG91bGQgYWx3YXlzIGJl
CnZhbGlkYXRlZCBhbmQgaG9sZCBhIGdlbmVyYWwgcmVmZXJlbmNlIGNvdW50
LiAgSWYgcGFydGlhbF9mbGFncyBpcwp6ZXJvLCB0aGVuIFtucl9lbnRyaWVz
X3ZhbGlkYXRlZF0gaXMgbm90IHZhbGlkYXRlZCBhbmQgbm8gcmVmZXJlbmNl
CmNvdW50IGlzIGhlbGQuICBJZiBQVEZfcGFydGlhbF9zZXQgaXMgc2V0LCB0
aGVuIFtucl9lbnRyaWVzX3ZhbGlkYXRlZF0KaXMgcGFydGlhbGx5IHZhbGlk
YXRlZC4KCkF0IHRoZSBtb21lbnQsIGEgZGlzdGluY3Rpb24gaXMgbWFkZSBi
ZXR3ZWVuIHByb21vdGlvbiBhbmQgZGVtb3Rpb24Kd2l0aCByZWdhcmQgdG8g
d2hldGhlciB0aGUgZW50cnkgaXRzZWxmICJob2xkcyIgYSBnZW5lcmFsIHJl
ZmVyZW5jZQpjb3VudDogd2hlbiBlbnRyeSBwcm9tb3Rpb24gaXMgaW50ZXJy
dXB0ZWQgKGkuZS4sIHJldHVybnMgLUVSRVNUQVJUKSwKdGhlIGVudHJ5IGlz
IG5vdCBjb25zaWRlcmVkIHRvIGhvbGQgYSByZWZlcmVuY2U7IHdoZW4gZW50
cnkgZGVtb3Rpb24KaXMgaW50ZXJydXB0ZWQsIHRoZSBlbnRyeSBpcyBzdGls
bCBjb25zaWRlcmVkIHRvIGhvbGQgYSBnZW5lcmFsCnJlZmVyZW5jZS4KClBU
Rl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzIHVzZWQgdG8gZGlzdGluZ3Vpc2gg
YmV0d2VlbiB0aGVzZSBjYXNlcy4KSWYgY2xlYXIsIGl0J3MgYSBwYXJ0aWFs
IHByb21vdGlvbiA9PiBubyBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBoZWxk
CmJ5IHRoZSBlbnRyeTsgaWYgc2V0LCBpdCdzIHBhcnRpYWwgZGVtb3Rpb24s
IHNvIGEgZ2VuZXJhbCByZWZlcmVuY2UKY291bnQgaGVsZC4gIEJlY2F1c2Ug
cHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIGNhbiBiZSBpbnRlcmxlYXZlZCwg
dGhpcwp2YWx1ZSBpcyBwYXNzZWQgdG8gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4gYW5kIHB1dF9wYWdlX2Zyb21fbCplLAp0byBiZSBhYmxlIHRvIHBy
b3Blcmx5IGhhbmRsZSByZWZlcmVuY2UgY291bnRzLgoKVW5mb3J0dW5hdGVs
eSwgYmVjYXVzZSBhIHJlZmNvdW50IGlzIG5vdCBoZWxkLCBpdCBpcyBwb3Nz
aWJsZSB0bwplbmdpbmVlciBhIHNpdHVhdGlvbiB3aGVyZSBQRlRfcGFydGlh
bF9zZXQgaXMgc2V0IGJ1dCB0aGUgcGFnZSBpbgpxdWVzdGlvbiBoYXMgYmVl
biBhc3NpZ25lZCB0byBhbm90aGVyIGRvbWFpbi4gIEEgc2tldGNoIGlzIHBy
b3ZpZGVkIGluCnRoZSBhcHBlbmRpeC4KCkZpeCB0aGlzIGJ5IGhhdmluZyB0
aGUgcGFyZW50IHBhZ2UgdGFibGUgZW50cnkgaG9sZCBhIGdlbmVyYWwKcmVm
ZXJlbmNlIGNvdW50IHdoZW5ldmVyIFBGVF9wYXJ0aWFsX3NldCBpcyBzZXQu
ICAoRm9yIGNsYXJpdHkgb2YKY2hhbmdlLCBrZWVwIHR3byBzZXBhcmF0ZSBm
bGFncy4gIFRoZXNlIHdpbGwgYmUgY29sbGFwc2VkIGluIGEKc3Vic2VxdWVu
dCBjaGFuZ2VzZXQuKQoKVGhpcyBoYXMgdHdvIGJhc2ljIGltcGxpY2F0aW9u
cy4gIE9uIHRoZSBwdXRfcGFnZV9mcm9tX2xOZSgpIHNpZGUsCnRoaXMgbWVh
biB0aGF0IHRoZSAocGFydGlhbF9zZXQgJiYgIXBhcnRpYWxfcmVmKSBjYXNl
IGNhbiBuZXZlciBoYXBwZW4sCmFuZCBubyBsb25nZXIgbmVlZHMgdG8gYmUg
c3BlY2lhbC1jYXNlZC4KClNlY29uZGx5LCBiZWNhdXNlIGJvdGggZmxhZ3Mg
YXJlIHNldCB0b2dldGhlciwgdGhlcmUncyBubyBuZWVkIHRvIGNhcnJ5IG92
ZXIKZXhpc3RpbmcgYml0cyBmcm9tIHBhcnRpYWxfcHRlLgoKKE5CIHRoZXJl
IGlzIHN0aWxsIGFub3RoZXIgaXNzdWUgd2l0aCBjYWxsaW5nIF9wdXRfcGFn
ZV90eXBlKCkgb24gYQpwYWdlIHdoaWNoIGhhZCBQR1RfcGFydGlhbCBzZXQ7
IHRoYXQgd2lsbCBiZSBoYW5kbGVkIGluIGEgc3Vic2VxdWVudApwYXRjaC4p
CgpPbiB0aGUgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oKSBzaWRlLCB3
ZSBuZWVkIHRvIGRpc3Rpbmd1aXNoCmJldHdlZW4gY2FsbGVycyB3aGljaCBo
b2xkIGEgcmVmZXJlbmNlIG9uIHBhcnRpYWwgKGkuZS4sCmFsbG9jX2xOX3Rh
YmxlKCkpLCBhbmQgdGhvc2Ugd2hpY2ggZG8gbm90IChuZXdfY3IzLCBQSU5f
TE5fVEFCTEUsIGFuZApzbyBvbik6IHBhc3MgYSBmbGFnIGlmIHRoZSB0eXBl
IHNob3VsZCBiZSByZXRhaW5lZCBvbiBpbnRlcnJ1cHRpb24uCgpOQiB0aGF0
IHNpbmNlIGwxIHByb21vdGlvbiBjYW4ndCBiZSBwcmVlbXB0ZWQsIHRoYXQg
Z2V0X3BhZ2VfZnJvbV9sMmUKY2FuJ3QgcmV0dXJuIC1FUkVTVEFSVC4KClRo
aXMgaXMgcGFydCBvZiBYU0EtMjk5LgoKUmVwb3J0ZWQtYnk6IEdlb3JnZSBE
dW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1i
eTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgot
LS0tLQoqIEFwcGVuZGl4OiBFbmdpbmVlcmluZyBQVEZfcGFydGlhbF9zZXQg
d2hpbGUgYSBwYWdlIGJlbG9uZ3MgdG8gYQogIGZvcmVpZ24gZG9tYWluCgpT
dXBwb3NlIEEgaXMgYSBwYWdlIHdoaWNoIGNhbiBiZSBwcm9tb3RlZCB0byBh
biBsMywgYW5kIEIgaXMgYSBwYWdlCndoaWNoIGNhbiBiZSBwcm9tb3RlZCB0
byBhbiBsMiwgYW5kIEFbeF0gcG9pbnRzIHRvIEIuICBCIGhhcwpQR0NfYWxs
b2NhdGVkIHNldCBidXQgbm8gb3RoZXIgZ2VuZXJhbCByZWZlcmVuY2VzLgoK
VjE6ICBQSU5fTDMgQS4KICBBIGlzIHZhbGlkYXRlZCwgQiBpcyB2YWxpZGF0
ZWQuCiAgQS50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQgfCBQR1Rf
cGlubmVkCiAgQi50eXBlX2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBC
LmNvdW50ID0gMiB8IFBHQ19hbGxvY2F0ZWQgKEFbeF0gaG9sZHMgYSBnZW5l
cmFsIHJlZikKClYxOiBVTlBJTiBBLgogIEEgYmVnaW5zIGRlLXZhbGlkYXRp
b24uCiAgQXJyYW5nZSB0byBiZSBpbnRlcnJ1cHRlZCB3aGVuIGkgPCB4CiAg
VjEtPm9sZF9ndWVzdF90YWJsZSA9IEEKICBWMS0+b2xkX2d1ZXN0X3RhYmxl
X3JlZl9oZWxkID0gZmFsc2UKICBBLnR5cGVfY291bnQgPSAxIHwgUEdUX3Bh
cnRpYWwKICBBLm5yX3ZhbGlkYXRlZF9lbnRyaWVzID0gaSA8IHgKICBCLnR5
cGVfY291bnQgPSAwCiAgQi5jb3VudCA9IDEgfCBQR0NfYWxsb2NhdGVkCgpW
MjogTU9EX0w0X0VOVFJZIHRvIHBvaW50IHNvbWUgbDRlIHRvIEEuCiAgUGlj
a3MgdXAgcmUtdmFsaWRhdGlvbiBvZiBBLgogIEFycmFuZ2UgdG8gYmUgaW50
ZXJydXB0ZWQgaGFsZndheSB0aHJvdWdoIEIncyB2YWxpZGF0aW9uCiAgQi50
eXBlX2NvdW50ID0gMSB8IFBHVF9wYXJ0aWFsCiAgQi5jb3VudCA9IDIgfCBQ
R0NfYWxsb2NhdGVkIChQR1RfcGFydGlhbCBob2xkcyBhIGdlbmVyYWwgcmVm
KQogIEEudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFs
aWRhdGVkX2VudHJpZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IFBURl9wYXJ0
aWFsX3NldAoKVjM6IE1PRF9MM19FTlRSWSB0byBwb2ludCBzb21lIG90aGVy
IGwzZSAobm90IGluIEEpIHRvIEIuCiAgVmFsaWRhdGVzIEIuCiAgQi50eXBl
X2NvdW50ID0gMSB8IFBHVF92YWxpZGF0ZWQKICBCLmNvdW50ID0gMiB8IFBH
Q19hbGxvY2F0ZWQgKCJvdGhlciBsM2UiIGhvbGRzIGEgZ2VuZXJhbCByZWYp
CgpWMzogTU9EX0wzX0VOVFJZIHRvIGNsZWFyIGwzZSBwb2ludGluZyB0byBC
LgogIERldmFsaWRhdGVzIEIuCiAgQi50eXBlX2NvdW50ID0gMAogIEIuY291
bnQgPSAxIHwgUEdDX2FsbG9jYXRlZAoKVjM6IGRlY3JlYXNlX3Jlc2VydmF0
aW9uKEIpCiAgQ2xlYXJzIFBHQ19hbGxvY2F0ZWQKICBCLmNvdW50ID0gMCA9
PiBCIGlzIGZyZWVkCgpCIGdldHMgYXNzaWduZWQgdG8gYSBkaWZmZXJlbnQg
ZG9tYWluCgpWMTogUmVzdGFydHMgVU5QSU4gb2YgQQogIHB1dF9vbGRfZ3Vl
c3RfdGFibGUoQSkKICAgIC4uLgogICAgICBmcmVlX2wzX3RhYmxlKEEpCgpO
b3cgc2luY2UgQS5wYXJ0aWFsX2ZsYWdzIGhhcyBQVEZfcGFydGlhbF9zZXQs
IGZyZWVfbDNfdGFibGUoKSB3aWxsCmNhbGwgcHV0X3BhZ2VfZnJvbV9sM2Uo
KSBvbiBBW3hdLCB3aGljaCBwb2ludHMgdG8gQiwgd2hpbGUgQiBpcyBvd25l
ZApieSBhbm90aGVyIGRvbWFpbi4KCklmIEFbeF0gaGVsZCBhIGdlbmVyYWwg
cmVmY291bnQgZm9yIEIgb24gcGFydGlhbCB2YWxpZGF0aW9uLCBhcyBpdCBk
b2VzCmZvciBwYXJ0aWFsIGRlLXZhbGlkYXRpb24sIHRoZW4gQiB3b3VsZCBz
dGlsbCBoYXZlIGEgcmVmZXJlbmNlIGNvdW50IG9mCjEgYWZ0ZXIgUEdDX2Fs
bG9jYXRlZCB3YXMgZnJlZWQ7IHNvIEIgd291bGRuJ3QgYmUgZnJlZWQgdW50
aWwgYWZ0ZXIKcHV0X3BhZ2VfZnJvbV9sM2UoKSBoYWQgaGFwcGVuZCBvbiBB
W3hdLgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jICAgICAgICB8IDg0ICsrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9pbmNs
dWRlL2FzbS14ODYvbW0uaCB8IDE1ICsrKystLS0KIDIgZmlsZXMgY2hhbmdl
ZCwgNTggaW5zZXJ0aW9ucygrKSwgNDEgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwpp
bmRleCAyNGNlOGQ3YzUwLi5kMjk0YjA5YTM4IDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTA3
MiwxMCArMTA3MiwxMSBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKICAqIHBhZ2Ut
PnB0ZVtwYWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhlIGNv
bW1lbnQgaW4gbW0uaCBmb3IKICAqIG1vcmUgaW5mb3JtYXRpb24uCiAgKi8K
LSNkZWZpbmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgKDEgPDwgMCkKLSNk
ZWZpbmUgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYgKDEgPDwgMSkKLSNkZWZp
bmUgUFRGX3ByZWVtcHRpYmxlICAgICAgICAgKDEgPDwgMikKLSNkZWZpbmUg
UFRGX2RlZmVyICAgICAgICAgICAgICAgKDEgPDwgMykKKyNkZWZpbmUgUFRG
X3BhcnRpYWxfc2V0ICAgICAgICAgICAoMSA8PCAwKQorI2RlZmluZSBQVEZf
cGFydGlhbF9nZW5lcmFsX3JlZiAgICgxIDw8IDEpCisjZGVmaW5lIFBURl9w
cmVlbXB0aWJsZSAgICAgICAgICAgKDEgPDwgMikKKyNkZWZpbmUgUFRGX2Rl
ZmVyICAgICAgICAgICAgICAgICAoMSA8PCAzKQorI2RlZmluZSBQVEZfcmV0
YWluX3JlZl9vbl9yZXN0YXJ0ICgxIDw8IDQpCiAKIHN0YXRpYyBpbnQgZ2V0
X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAgbWZuX3QgbWZuLCB1bnNp
Z25lZCBsb25nIHR5cGUsIHN0cnVjdCBkb21haW4gKmQsCkBAIC0xMDg0LDcg
KzEwODUsMTEgQEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9t
X21mbigKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3RvX3Bh
Z2UobWZuKTsKICAgICBpbnQgcmM7CiAgICAgYm9vbCBwcmVlbXB0aWJsZSA9
IGZsYWdzICYgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAgcGFydGlhbF9y
ZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAg
ICAgcGFydGlhbF9yZWYgPSBmbGFncyAmIFBURl9wYXJ0aWFsX2dlbmVyYWxf
cmVmLAorICAgICAgICAgcGFydGlhbF9zZXQgPSBmbGFncyAmIFBURl9wYXJ0
aWFsX3NldCwKKyAgICAgICAgIHJldGFpbl9yZWYgID0gZmxhZ3MgJiBQVEZf
cmV0YWluX3JlZl9vbl9yZXN0YXJ0OworCisgICAgQVNTRVJUKHBhcnRpYWxf
cmVmID09IHBhcnRpYWxfc2V0KTsKIAogICAgIGlmICggbGlrZWx5KCFwYXJ0
aWFsX3JlZikgJiYKICAgICAgICAgIHVubGlrZWx5KCFnZXRfcGFnZV9mcm9t
X21mbihtZm4sIGQpKSApCkBAIC0xMDk3LDEzICsxMTAyLDE1IEBAIHN0YXRp
YyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oCiAgICAgICogLSBw
YWdlIGlzIGZ1bGx5IHZhbGlkYXRlZCAocmMgPT0gMCkKICAgICAgKiAtIHBh
Z2UgaXMgbm90IHZhbGlkYXRlZCAocmMgPCAwKSBidXQ6CiAgICAgICogICAt
IFdlIGNhbWUgaW4gd2l0aCBhIHJlZmVyZW5jZSAocGFydGlhbF9yZWYpCisg
ICAgICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCAocmMgPT0g
LUVSRVNUQVJUKSwgYW5kIHRoZQorICAgICAqICAgICBjYWxsZXIgaGFzIGFz
a2VkIHRoZSByZWYgdG8gYmUgcmV0YWluZWQgaW4gdGhhdCBjYXNlCiAgICAg
ICogICAtIHBhZ2UgaXMgcGFydGlhbGx5IHZhbGlkYXRlZCBidXQgdGhlcmUn
cyBiZWVuIGFuIGVycm9yCiAgICAgICogICAgIChwYWdlID09IGN1cnJlbnQt
PmFyY2gub2xkX2d1ZXN0X3RhYmxlKQogICAgICAqCiAgICAgICogVGhlIHBh
cnRpYWxfcmVmLW9uLWVycm9yIGNsYXVzZSBpcyB3b3J0aCBhbiBleHBsYW5h
dGlvbi4gIFRoZXJlCiAgICAgICogYXJlIHR3byBzY2VuYXJpb3Mgd2hlcmUg
cGFydGlhbF9yZWYgbWlnaHQgYmUgdHJ1ZSBjb21pbmcgaW46Ci0gICAgICog
LSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90ZWQgYXMgdHlwZSBgdHlw
ZWA7IGkuZS4gaGFzCi0gICAgICogICBQR1RfcGFydGlhbCBzZXQKKyAgICAg
KiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkgcHJvbW90ZWQgLyBkZW1vdGVk
IGFzIHR5cGUgYHR5cGVgOworICAgICAqICAgaS5lLiBoYXMgUEdUX3BhcnRp
YWwgc2V0CiAgICAgICogLSBtZm4gaGFzIGJlZW4gcGFydGlhbGx5IGRlbW90
ZWQgYXMgTCh0eXBlKzEpIChpLmUuLCBhIGxpbmVhcgogICAgICAqICAgcGFn
ZTsgZS5nLiB3ZSdyZSBiZWluZyBjYWxsZWQgZnJvbSBnZXRfcGFnZV9mcm9t
X2wyZSB3aXRoCiAgICAgICogICB0eXBlID09IFBHVF9sMV90YWJsZSwgYnV0
IHRoZSBtZm4gaXMgUEdUX2wyX3RhYmxlKQpAQCAtMTEyNiw3ICsxMTMzLDgg
QEAgc3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAg
ICAgKi8KICAgICBpZiAoIGxpa2VseSghcmMpIHx8IHBhcnRpYWxfcmVmICkK
ICAgICAgICAgLyogbm90aGluZyAqLzsKLSAgICBlbHNlIGlmICggcGFnZSA9
PSBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCisgICAgZWxzZSBp
ZiAoIHBhZ2UgPT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgfHwK
KyAgICAgICAgICAgICAgKHJldGFpbl9yZWYgJiYgcmMgPT0gLUVSRVNUQVJU
KSApCiAgICAgICAgIEFTU0VSVChwcmVlbXB0aWJsZSk7CiAgICAgZWxzZQog
ICAgICAgICBwdXRfcGFnZShwYWdlKTsKQEAgLTEzMjQsOCArMTMzMiw4IEBA
IHN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwy
ZSwgdW5zaWduZWQgbG9uZyBwZm4sCiAgICAgICAgIGlmICggKGZsYWdzICYg
KFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkg
PT0KICAgICAgICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKICAgICAgICAg
ewotICAgICAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQVEZfZGVmZXIpKTsK
LSAgICAgICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVl
bXB0aWJsZSwgcHRwZyk7CisgICAgICAgICAgICAvKiBwYXJ0aWFsX3NldCBz
aG91bGQgYWx3YXlzIGltcGx5IHBhcnRpYWxfcmVmICovCisgICAgICAgICAg
ICBCVUcoKTsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggZmxhZ3Mg
JiBQVEZfZGVmZXIgKQogICAgICAgICB7CkBAIC0xMzcwLDggKzEzNzgsOCBA
QCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBs
M2UsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgIGlmICggKGZsYWdzICYgKFBU
Rl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmKSkgPT0K
ICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCiAgICAgewotICAgICAgICBB
U1NFUlQoIShmbGFncyAmIFBURl9kZWZlcikpOwotICAgICAgICByZXR1cm4g
X3B1dF9wYWdlX3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3Bh
Z2UoX21mbihwZm4pKSk7CisgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3Vs
ZCBhbHdheXMgaW1wbHkgcGFydGlhbF9yZWYgKi8KKyAgICAgICAgQlVHKCk7
CiAgICAgfQogCiAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCkBAIC0x
NDAxLDggKzE0MDksOCBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRl
KGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcgcGZuLAogICAgICAg
ICBpZiAoIChmbGFncyAmIChQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZikpID09CiAgICAgICAgICAgICAgIFBURl9wYXJ0aWFs
X3NldCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIEFTU0VSVCghKGZsYWdz
ICYgUFRGX2RlZmVyKSk7Ci0gICAgICAgICAgICByZXR1cm4gX3B1dF9wYWdl
X3R5cGUocGcsIFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2UoX21mbihw
Zm4pKSk7CisgICAgICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3
YXlzIGltcGx5IHBhcnRpYWxfcmVmICovCisgICAgICAgICAgICBCVUcoKTsK
ICAgICAgICAgfQogCiAgICAgICAgIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIg
KQpAQCAtMTU0MCwxMyArMTU0OCwyMiBAQCBzdGF0aWMgaW50IGFsbG9jX2wy
X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UsIHVuc2lnbmVkIGxvbmcg
dHlwZSkKICAgICAgICAgZWxzZQogICAgICAgICAgICAgcmMgPSBnZXRfcGFn
ZV9mcm9tX2wyZShsMmUsIHBmbiwgZCwgcGFydGlhbF9mbGFncyk7CiAKLSAg
ICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQotICAgICAgICB7Ci0gICAg
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAg
ICAgICAvKiBTZXQgJ3NldCcsIHJldGFpbiAnZ2VuZXJhbCByZWYnICovCi0g
ICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFn
cyB8IFBURl9wYXJ0aWFsX3NldDsKLSAgICAgICAgfQotICAgICAgICBlbHNl
IGlmICggcmMgPT0gLUVJTlRSICYmIGkgKQorICAgICAgICAvKgorICAgICAg
ICAgKiBJdCBzaG91bGRuJ3QgYmUgcG9zc2libGUgZm9yIGdldF9wYWdlX2Zy
b21fbDJlIHRvIHJldHVybgorICAgICAgICAgKiAtRVJFU1RBUlQsIHNpbmNl
IHdlIG5ldmVyIGNhbGwgdGhpcyB3aXRoIFBURl9wcmVlbXB0aWJsZS4KKyAg
ICAgICAgICogKGFsbG9jX2wxX3RhYmxlIG1heSByZXR1cm4gLUVJTlRSIG9u
IGFuIEwxVEYtdnVsbmVyYWJsZQorICAgICAgICAgKiBlbnRyeS4pCisgICAg
ICAgICAqCisgICAgICAgICAqIE5CIHRoYXQgd2hpbGUgb24gYSAiY2xlYW4i
IHByb21vdGlvbiwgd2UgY2FuIG5ldmVyIGdldAorICAgICAgICAgKiBQR1Rf
cGFydGlhbC4gIEl0IGlzIHBvc3NpYmxlIHRvIGFycmFuZ2UgZm9yIGFuIGwy
ZSB0bworICAgICAgICAgKiBjb250YWluIGEgcGFydGlhbGx5LWRldmFsaWRh
dGVkIGwyOyBidXQgaW4gdGhhdCBjYXNlLCBib3RoCisgICAgICAgICAqIG9m
IHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIHdpbGwgZmFpbCBhbnl3YXkgKHRo
ZSBmaXJzdAorICAgICAgICAgKiBiZWNhdXNlIHRoZSBwYWdlIGluIHF1ZXN0
aW9uIGlzIG5vdCBhbiBsMTsgdGhlIHNlY29uZAorICAgICAgICAgKiBiZWNh
dXNlIHRoZSBwYWdlIGlzIG5vdCBmdWxseSB2YWxpZGF0ZWQpLgorICAgICAg
ICAgKi8KKyAgICAgICAgQVNTRVJUKHJjICE9IC1FUkVTVEFSVCk7CisKKyAg
ICAgICAgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKICAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOwpAQCAtMTU1Niw2ICsx
NTczLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAgICAgICAgIHsK
ICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLAogICAgICAg
ICAgICAgICAgICAgICAgIkZhaWx1cmUgJWQgaW4gYWxsb2NfbDJfdGFibGU6
IHNsb3QgJSN4XG4iLCByYywgaSk7CisgICAgICAgICAgICBBU1NFUlQoY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPT0gTlVMTCk7CiAgICAgICAg
ICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAg
IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKQEAgLTE2MTQsNyArMTYz
Miw3IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKICAgICAgICAgICAgICAgICByYyA9IGdldF9wYWdlX2Fu
ZF90eXBlX2Zyb21fbWZuKAogICAgICAgICAgICAgICAgICAgICBsM2VfZ2V0
X21mbihsM2UpLAogICAgICAgICAgICAgICAgICAgICBQR1RfbDJfcGFnZV90
YWJsZSB8IFBHVF9wYWVfeGVuX2wyLCBkLAotICAgICAgICAgICAgICAgICAg
ICBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3ByZWVtcHRpYmxlKTsKKyAgICAgICAg
ICAgICAgICAgICAgcGFydGlhbF9mbGFncyB8IFBURl9wcmVlbXB0aWJsZSB8
IFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQpOwogICAgICAgICB9CiAgICAg
ICAgIGVsc2UgaWYgKCAhKGwzZV9nZXRfZmxhZ3MobDNlKSAmIF9QQUdFX1BS
RVNFTlQpICkKICAgICAgICAgewpAQCAtMTYyMywxMyArMTY0MSwxNCBAQCBz
dGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAgICAgICAgICAgICByYyA9IC1FSU5UUjsKICAgICAgICAgfQogICAg
ICAgICBlbHNlCi0gICAgICAgICAgICByYyA9IGdldF9wYWdlX2Zyb21fbDNl
KGwzZSwgcGZuLCBkLCBwYXJ0aWFsX2ZsYWdzKTsKKyAgICAgICAgICAgIHJj
ID0gZ2V0X3BhZ2VfZnJvbV9sM2UobDNlLCBwZm4sIGQsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWxfZmxhZ3MgfCBQVEZf
cmV0YWluX3JlZl9vbl9yZXN0YXJ0KTsKIAogICAgICAgICBpZiAoIHJjID09
IC1FUkVTVEFSVCApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKICAgICAgICAgICAgIC8qIFNldCAnc2V0
JywgbGVhdmUgJ2dlbmVyYWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMg
c2V0ICovCi0gICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFy
dGlhbF9mbGFncyB8IFBURl9wYXJ0aWFsX3NldDsKKyAgICAgICAgICAgIHBh
Z2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFy
dGlhbF9nZW5lcmFsX3JlZjsKICAgICAgICAgfQogICAgICAgICBlbHNlIGlm
ICggcmMgPT0gLUVJTlRSICYmIGkgKQogICAgICAgICB7CkBAIC0xODA2LDEz
ICsxODI1LDE0IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDRfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKICAgICAgICAgICAgIHJjID0gLUVJTlRSOwog
ICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAgICAgICAgIHJjID0gZ2V0
X3BhZ2VfZnJvbV9sNGUobDRlLCBwZm4sIGQsIHBhcnRpYWxfZmxhZ3MpOwor
ICAgICAgICAgICAgcmMgPSBnZXRfcGFnZV9mcm9tX2w0ZShsNGUsIHBmbiwg
ZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlh
bF9mbGFncyB8IFBURl9yZXRhaW5fcmVmX29uX3Jlc3RhcnQpOwogCiAgICAg
ICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAgewogICAgICAg
ICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwogICAgICAgICAg
ICAgLyogU2V0ICdzZXQnLCBsZWF2ZSAnZ2VuZXJhbCByZWYnIHNldCBpZiB0
aGlzIGVudHJ5IHdhcyBzZXQgKi8KLSAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzIHwgUFRGX3BhcnRpYWxfc2V0Owor
ICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFs
X3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKQogICAgICAgICB7CkBAIC0xOTA5
LDkgKzE5MjksNyBAQCBzdGF0aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBlbHNlIGlmICggcmMgPT0gLUVSRVNU
QVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IChwYXJ0aWFs
X2ZsYWdzICYgUFRGX3BhcnRpYWxfc2V0KSA/Ci0gICAgICAgICAgICBwYXJ0
aWFsX2ZsYWdzIDoKLSAgICAgICAgICAgIChQVEZfcGFydGlhbF9zZXQgfCBQ
VEZfcGFydGlhbF9nZW5lcmFsX3JlZik7CisgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSBQVEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5l
cmFsX3JlZjsKICAgICB9CiAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAm
JiBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVMgLSAxICkKICAgICB7CkBAIC0x
OTU5LDkgKzE5NzcsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBpZiAoIHJjID09IC1FUkVTVEFS
VCApCiAgICAgewogICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7Ci0gICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAocGFydGlhbF9m
bGFncyAmIFBURl9wYXJ0aWFsX3NldCkgPwotICAgICAgICAgICAgcGFydGlh
bF9mbGFncyA6Ci0gICAgICAgICAgICAoUFRGX3BhcnRpYWxfc2V0IHwgUFRG
X3BhcnRpYWxfZ2VuZXJhbF9yZWYpOworICAgICAgICBwYWdlLT5wYXJ0aWFs
X2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWY7CiAgICAgfQogICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYg
aSA8IEwzX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCiAgICAgewpAQCAtMTk5
Miw5ICsyMDA4LDcgQEAgc3RhdGljIGludCBmcmVlX2w0X3RhYmxlKHN0cnVj
dCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQg
KQogICAgIHsKICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBp
OwotICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gKHBhcnRpYWxfZmxh
Z3MgJiBQVEZfcGFydGlhbF9zZXQpID8KLSAgICAgICAgICAgIHBhcnRpYWxf
ZmxhZ3MgOgotICAgICAgICAgICAgKFBURl9wYXJ0aWFsX3NldCB8IFBURl9w
YXJ0aWFsX2dlbmVyYWxfcmVmKTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9m
bGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxf
cmVmOwogICAgIH0KICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkg
PCBMNF9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQogICAgIHsKZGlmZiAtLWdp
dCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2Fz
bS14ODYvbW0uaAppbmRleCAwZTYyOGZhNDE3Li5iYTliZTRlZDQwIDEwMDY0
NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKKysrIGIveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9tbS5oCkBAIC0yNDEsMjIgKzI0MSwyNSBAQCBzdHJ1
Y3QgcGFnZV9pbmZvCiAgICAgICAgICAqIHBhZ2UuCiAgICAgICAgICAqCiAg
ICAgICAgICAqIFRoaXMgaGFwcGVuczoKLSAgICAgICAgICogLSBEdXJpbmcg
ZGUtdmFsaWRhdGlvbiwgaWYgZGUtdmFsaWRhdGlvbiBvZiB0aGUgcGFnZSB3
YXMKKyAgICAgICAgICogLSBEdXJpbmcgdmFsaWRhdGlvbiBvciBkZS12YWxp
ZGF0aW9uLCBpZiB0aGUgb3BlcmF0aW9uIHdhcwogICAgICAgICAgKiAgIGlu
dGVycnVwdGVkCiAgICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlm
IGFuIGludmFsaWQgZW50cnkgaXMgZW5jb3VudGVyZWQgYW5kCiAgICAgICAg
ICAqICAgdmFsaWRhdGlvbiBpcyBwcmVlbXB0aWJsZQogICAgICAgICAgKiAt
IER1cmluZyB2YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlhbF9nZW5lcmFsX3Jl
ZiB3YXMgc2V0IG9uCi0gICAgICAgICAqICAgdGhpcyBlbnRyeSB0byBiZWdp
biB3aXRoIChwZXJoYXBzIGJlY2F1c2Ugd2UncmUgcGlja2luZwotICAgICAg
ICAgKiAgIHVwIGZyb20gYSBwYXJ0aWFsIGRlLXZhbGlkYXRpb24pLgorICAg
ICAgICAgKiAgIHRoaXMgZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFwcyBi
ZWNhdXNlIGl0IHBpY2tlZCB1cCBhCisgICAgICAgICAqICAgcHJldmlvdXMg
b3BlcmF0aW9uKQogICAgICAgICAgKgotICAgICAgICAgKiBXaGVuIHJlc3Vt
aW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlz
IGNsZWFyLAotICAgICAgICAgKiB0aGVuIGEgZ2VuZXJhbCByZWZlcmVuY2Ug
bXVzdCBiZSByZS1hY3F1aXJlZDsgaWYgaXQgaXMgc2V0LCBubwotICAgICAg
ICAgKiByZWZlcmVuY2Ugc2hvdWxkIGJlIGFjcXVpcmVkLgorICAgICAgICAg
KiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dl
bmVyYWxfcmVmIGlzCisgICAgICAgICAqIGNsZWFyLCB0aGVuIGEgZ2VuZXJh
bCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1aXJlZDsgaWYgaXQKKyAgICAg
ICAgICogaXMgc2V0LCBubyByZWZlcmVuY2Ugc2hvdWxkIGJlIGFjcXVpcmVk
LgogICAgICAgICAgKgogICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIGRlLXZh
bGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzCiAgICAg
ICAgICAqIGNsZWFyLCBubyByZWZlcmVuY2Ugc2hvdWxkIGJlIGRyb3BwZWQ7
IGlmIGl0IGlzIHNldCwgYQogICAgICAgICAgKiByZWZlcmVuY2Ugc2hvdWxk
IGJlIGRyb3BwZWQuCiAgICAgICAgICAqCisgICAgICAgICAqIE5CIGF0IHRo
ZSBtb21lbnQsIFBURl9wYXJ0aWFsX3NldCBzaG91bGQgYmUgc2V0IGlmIGFu
ZCBvbmx5IGlmCisgICAgICAgICAqIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVm
IGlzIHNldC4KKyAgICAgICAgICoKICAgICAgICAgICogTkIgdGhhdCBQVEZf
cGFydGlhbF9zZXQgYW5kIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGFyZQog
ICAgICAgICAgKiBkZWZpbmVkIGluIG1tLmMsIHRoZSBvbmx5IHBsYWNlIHdo
ZXJlIHRoZXkgYXJlIHVzZWQuCiAgICAgICAgICAqCi0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Disposition: attachment;
 filename="xsa299/0008-x86-mm-Collapse-PTF_partial_set-and-PTF_partial_gene.patch"
Content-Transfer-Encoding: base64

RnJvbSA4OGFjNTA3N2JjMWQ4NDA1Zjg3ZGZlNWVmMWJkZDgwMzU5M2JmMmI1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA4LzExXSB4
ODYvbW06IENvbGxhcHNlIFBURl9wYXJ0aWFsX3NldCBhbmQKIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIGludG8gb25lCgouLi5ub3cgdGhhdCB0aGV5IGFy
ZSBlcXVpdmFsZW50LiAgTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQu
CgpSZXBvcnRlZC1ieTogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9y
Z2UuZHVubGFwQGNpdHJpeC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQogeGVuL2FyY2gveDg2L21tLmMg
ICAgICAgIHwgNTAgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oIHwgMjkgKysrKysr
KysrKystLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjYgaW5zZXJ0
aW9ucygrKSwgNTMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCBkMjk0YjA5
YTM4Li4wNjU1YzA1NzBiIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0u
YworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTA2NywxMyArMTA2Nywx
MiBAQCBnZXRfcGFnZV9mcm9tX2wxZSgKIAogLyoKICAqIFRoZSBmb2xsb3dp
bmcgZmxhZ3MgYXJlIHVzZWQgdG8gc3BlY2lmeSBiZWhhdmlvciBvZiB2YXJp
b3VzIGdldCBhbmQKLSAqIHB1dCBjb21tYW5kcy4gIFRoZSBmaXJzdCB0d28g
YXJlIGFsc28gc3RvcmVkIGluIHBhZ2UtPnBhcnRpYWxfZmxhZ3MKLSAqIHRv
IGluZGljYXRlIHRoZSBzdGF0ZSBvZiB0aGUgcGFnZSBwb2ludGVkIHRvIGJ5
CisgKiBwdXQgY29tbWFuZHMuICBUaGUgZmlyc3QgaXMgYWxzbyBzdG9yZWQg
aW4gcGFnZS0+cGFydGlhbF9mbGFncyB0bworICogaW5kaWNhdGUgdGhlIHN0
YXRlIG9mIHRoZSBwYWdlIHBvaW50ZWQgdG8gYnkKICAqIHBhZ2UtPnB0ZVtw
YWdlLT5ucl92YWxpZGF0ZWRfZW50cmllc10uICBTZWUgdGhlIGNvbW1lbnQg
aW4gbW0uaCBmb3IKICAqIG1vcmUgaW5mb3JtYXRpb24uCiAgKi8KICNkZWZp
bmUgUFRGX3BhcnRpYWxfc2V0ICAgICAgICAgICAoMSA8PCAwKQotI2RlZmlu
ZSBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiAgICgxIDw8IDEpCiAjZGVmaW5l
IFBURl9wcmVlbXB0aWJsZSAgICAgICAgICAgKDEgPDwgMikKICNkZWZpbmUg
UFRGX2RlZmVyICAgICAgICAgICAgICAgICAoMSA8PCAzKQogI2RlZmluZSBQ
VEZfcmV0YWluX3JlZl9vbl9yZXN0YXJ0ICgxIDw8IDQpCkBAIC0xMDg1LDEz
ICsxMDg0LDEwIEBAIHN0YXRpYyBpbnQgZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4oCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IG1mbl90b19w
YWdlKG1mbik7CiAgICAgaW50IHJjOwogICAgIGJvb2wgcHJlZW1wdGlibGUg
PSBmbGFncyAmIFBURl9wcmVlbXB0aWJsZSwKLSAgICAgICAgIHBhcnRpYWxf
cmVmID0gZmxhZ3MgJiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiwKICAgICAg
ICAgIHBhcnRpYWxfc2V0ID0gZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQsCiAg
ICAgICAgICByZXRhaW5fcmVmICA9IGZsYWdzICYgUFRGX3JldGFpbl9yZWZf
b25fcmVzdGFydDsKIAotICAgIEFTU0VSVChwYXJ0aWFsX3JlZiA9PSBwYXJ0
aWFsX3NldCk7Ci0KLSAgICBpZiAoIGxpa2VseSghcGFydGlhbF9yZWYpICYm
CisgICAgaWYgKCBsaWtlbHkoIXBhcnRpYWxfc2V0KSAmJgogICAgICAgICAg
dW5saWtlbHkoIWdldF9wYWdlX2Zyb21fbWZuKG1mbiwgZCkpICkKICAgICAg
ICAgcmV0dXJuIC1FSU5WQUw7CiAKQEAgLTExMDEsMTQgKzEwOTcsMTQgQEAg
c3RhdGljIGludCBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbigKICAgICAg
KiBSZXRhaW4gdGhlIHJlZmNvdW50IGlmOgogICAgICAqIC0gcGFnZSBpcyBm
dWxseSB2YWxpZGF0ZWQgKHJjID09IDApCiAgICAgICogLSBwYWdlIGlzIG5v
dCB2YWxpZGF0ZWQgKHJjIDwgMCkgYnV0OgotICAgICAqICAgLSBXZSBjYW1l
IGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfcmVmKQorICAgICAqICAg
LSBXZSBjYW1lIGluIHdpdGggYSByZWZlcmVuY2UgKHBhcnRpYWxfc2V0KQog
ICAgICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgKHJjID09
IC1FUkVTVEFSVCksIGFuZCB0aGUKICAgICAgKiAgICAgY2FsbGVyIGhhcyBh
c2tlZCB0aGUgcmVmIHRvIGJlIHJldGFpbmVkIGluIHRoYXQgY2FzZQogICAg
ICAqICAgLSBwYWdlIGlzIHBhcnRpYWxseSB2YWxpZGF0ZWQgYnV0IHRoZXJl
J3MgYmVlbiBhbiBlcnJvcgogICAgICAqICAgICAocGFnZSA9PSBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSkKICAgICAgKgotICAgICAqIFRoZSBw
YXJ0aWFsX3JlZi1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4gZXhwbGFu
YXRpb24uICBUaGVyZQotICAgICAqIGFyZSB0d28gc2NlbmFyaW9zIHdoZXJl
IHBhcnRpYWxfcmVmIG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgorICAgICAq
IFRoZSBwYXJ0aWFsX3NldC1vbi1lcnJvciBjbGF1c2UgaXMgd29ydGggYW4g
ZXhwbGFuYXRpb24uICBUaGVyZQorICAgICAqIGFyZSB0d28gc2NlbmFyaW9z
IHdoZXJlIHBhcnRpYWxfc2V0IG1pZ2h0IGJlIHRydWUgY29taW5nIGluOgog
ICAgICAqIC0gbWZuIGhhcyBiZWVuIHBhcnRpYWxseSBwcm9tb3RlZCAvIGRl
bW90ZWQgYXMgdHlwZSBgdHlwZWA7CiAgICAgICogICBpLmUuIGhhcyBQR1Rf
cGFydGlhbCBzZXQKICAgICAgKiAtIG1mbiBoYXMgYmVlbiBwYXJ0aWFsbHkg
ZGVtb3RlZCBhcyBMKHR5cGUrMSkgKGkuZS4sIGEgbGluZWFyCkBAIC0xMTMx
LDcgKzExMjcsNyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKAogICAgICAqIGNvdW50IHJldGFpbmVkIHVubGVzcyB3ZSBzdWNj
ZWVkZWQsIG9yIHRoZSBvcGVyYXRpb24gd2FzCiAgICAgICogcHJlZW1wdGli
bGUuCiAgICAgICovCi0gICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFs
X3JlZiApCisgICAgaWYgKCBsaWtlbHkoIXJjKSB8fCBwYXJ0aWFsX3NldCAp
CiAgICAgICAgIC8qIG5vdGhpbmcgKi87CiAgICAgZWxzZSBpZiAoIHBhZ2Ug
PT0gY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgfHwKICAgICAgICAg
ICAgICAgKHJldGFpbl9yZWYgJiYgcmMgPT0gLUVSRVNUQVJUKSApCkBAIC0x
MzI5LDEzICsxMzI1LDcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wy
ZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKICAgICAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBsMmVfZ2V0X3BhZ2UobDJlKTsK
ICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcHRwZyA9IG1mbl90b19wYWdl
KF9tZm4ocGZuKSk7CiAKLSAgICAgICAgaWYgKCAoZmxhZ3MgJiAoUFRGX3Bh
cnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWYpKSA9PQotICAg
ICAgICAgICAgICBQVEZfcGFydGlhbF9zZXQgKQotICAgICAgICB7Ci0gICAg
ICAgICAgICAvKiBwYXJ0aWFsX3NldCBzaG91bGQgYWx3YXlzIGltcGx5IHBh
cnRpYWxfcmVmICovCi0gICAgICAgICAgICBCVUcoKTsKLSAgICAgICAgfQot
ICAgICAgICBlbHNlIGlmICggZmxhZ3MgJiBQVEZfZGVmZXIgKQorICAgICAg
ICBpZiAoIGZsYWdzICYgUFRGX2RlZmVyICkKICAgICAgICAgewogICAgICAg
ICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IHB0cGc7CiAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBn
OwpAQCAtMTM3NSwxMyArMTM2NSw2IEBAIHN0YXRpYyBpbnQgcHV0X3BhZ2Vf
ZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBwZm4s
CiAKICAgICBwZyA9IGwzZV9nZXRfcGFnZShsM2UpOwogCi0gICAgaWYgKCAo
ZmxhZ3MgJiAoUFRGX3BhcnRpYWxfc2V0IHwgUFRGX3BhcnRpYWxfZ2VuZXJh
bF9yZWYpKSA9PQotICAgICAgICAgUFRGX3BhcnRpYWxfc2V0ICkKLSAgICB7
Ci0gICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdheXMgaW1wbHkg
cGFydGlhbF9yZWYgKi8KLSAgICAgICAgQlVHKCk7Ci0gICAgfQotCiAgICAg
aWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAgewogICAgICAgICBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gbWZuX3RvX3BhZ2UoX21mbihw
Zm4pKTsKQEAgLTE0MDYsMTMgKzEzODksNiBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVuc2lnbmVkIGxvbmcg
cGZuLAogICAgIHsKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBs
NGVfZ2V0X3BhZ2UobDRlKTsKIAotICAgICAgICBpZiAoIChmbGFncyAmIChQ
VEZfcGFydGlhbF9zZXQgfCBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZikpID09
Ci0gICAgICAgICAgICAgIFBURl9wYXJ0aWFsX3NldCApCi0gICAgICAgIHsK
LSAgICAgICAgICAgIC8qIHBhcnRpYWxfc2V0IHNob3VsZCBhbHdheXMgaW1w
bHkgcGFydGlhbF9yZWYgKi8KLSAgICAgICAgICAgIEJVRygpOwotICAgICAg
ICB9Ci0KICAgICAgICAgaWYgKCBmbGFncyAmIFBURl9kZWZlciApCiAgICAg
ICAgIHsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0
cGcgPSBtZm5fdG9fcGFnZShfbWZuKHBmbikpOwpAQCAtMTY0OCw3ICsxNjI0
LDcgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICAvKiBTZXQgJ3NldCcs
IGxlYXZlICdnZW5lcmFsIHJlZicgc2V0IGlmIHRoaXMgZW50cnkgd2FzIHNl
dCAqLwotICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9w
YXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldDsK
ICAgICAgICAgfQogICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYm
IGkgKQogICAgICAgICB7CkBAIC0xODMyLDcgKzE4MDgsNyBAQCBzdGF0aWMg
aW50IGFsbG9jX2w0X3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAg
ICAgICAgIHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKICAgICAgICAgICAgIC8qIFNldCAnc2V0JywgbGVhdmUgJ2dlbmVy
YWwgcmVmJyBzZXQgaWYgdGhpcyBlbnRyeSB3YXMgc2V0ICovCi0gICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0IHwg
UFRGX3BhcnRpYWxfZ2VuZXJhbF9yZWY7CisgICAgICAgICAgICBwYWdlLT5w
YXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OwogICAgICAgICB9CiAg
ICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKQogICAgICAgICB7CkBAIC0xOTI5
LDcgKzE5MDUsNyBAQCBzdGF0aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBlbHNlIGlmICggcmMgPT0gLUVSRVNU
QVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVz
ID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0
aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOworICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OwogICAgIH0K
ICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMMl9QQUdFVEFC
TEVfRU5UUklFUyAtIDEgKQogICAgIHsKQEAgLTE5NzcsNyArMTk1Myw3IEBA
IHN0YXRpYyBpbnQgZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAg
ICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFn
ZS0+cGFydGlhbF9mbGFncyA9IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmOworICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdz
ID0gUFRGX3BhcnRpYWxfc2V0OwogICAgIH0KICAgICBlbHNlIGlmICggcmMg
PT0gLUVJTlRSICYmIGkgPCBMM19QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQog
ICAgIHsKQEAgLTIwMDgsNyArMTk4NCw3IEBAIHN0YXRpYyBpbnQgZnJlZV9s
NF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgIGlmICggcmMg
PT0gLUVSRVNUQVJUICkKICAgICB7CiAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9
IFBURl9wYXJ0aWFsX3NldCB8IFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmOwor
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0
OwogICAgIH0KICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBM
NF9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQogICAgIHsKZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvbW0uaAppbmRleCBiYTliZTRlZDQwLi4zMjgwN2Q0ZGQ0IDEwMDY0NAot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9tbS5oCkBAIC0yMzYsNyArMjM2LDcgQEAgc3RydWN0IHBh
Z2VfaW5mbwogICAgICAgICAgKiBvcGVyYXRpb24gb24gdGhlIGN1cnJlbnQg
cGFnZS4gIChUaGF0IHBhZ2UgbWF5IG9yIG1heSBub3QKICAgICAgICAgICog
c3RpbGwgaGF2ZSBQR1RfcGFydGlhbCBzZXQuKQogICAgICAgICAgKgotICAg
ICAgICAgKiBJZiBQVEZfcGFydGlhbF9nZW5lcmFsX3JlZiBpcyBzZXQsIHRo
ZW4gdGhlIFBURSBhdAorICAgICAgICAgKiBBZGRpdGlvbmFsbHksIGlmIFBU
Rl9wYXJ0aWFsX3NldCBpcyBzZXQsIHRoZW4gdGhlIFBURSBhdAogICAgICAg
ICAgKiBAbnJfdmFsaWRhdGVkX3B0ZWYgaG9sZHMgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudCBmb3IgdGhlCiAgICAgICAgICAqIHBhZ2UuCiAgICAgICAg
ICAqCkBAIC0yNDUsMjMgKzI0NSwyMCBAQCBzdHJ1Y3QgcGFnZV9pbmZvCiAg
ICAgICAgICAqICAgaW50ZXJydXB0ZWQKICAgICAgICAgICogLSBEdXJpbmcg
dmFsaWRhdGlvbiwgaWYgYW4gaW52YWxpZCBlbnRyeSBpcyBlbmNvdW50ZXJl
ZCBhbmQKICAgICAgICAgICogICB2YWxpZGF0aW9uIGlzIHByZWVtcHRpYmxl
Ci0gICAgICAgICAqIC0gRHVyaW5nIHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0
aWFsX2dlbmVyYWxfcmVmIHdhcyBzZXQgb24KLSAgICAgICAgICogICB0aGlz
IGVudHJ5IHRvIGJlZ2luIHdpdGggKHBlcmhhcHMgYmVjYXVzZSBpdCBwaWNr
ZWQgdXAgYQorICAgICAgICAgKiAtIER1cmluZyB2YWxpZGF0aW9uLCBpZiBQ
VEZfcGFydGlhbF9zZXQgd2FzIHNldCBvbiB0aGlzCisgICAgICAgICAqICAg
ZW50cnkgdG8gYmVnaW4gd2l0aCAocGVyaGFwcyBiZWNhdXNlIGl0IHBpY2tl
ZCB1cCBhCiAgICAgICAgICAqICAgcHJldmlvdXMgb3BlcmF0aW9uKQogICAg
ICAgICAgKgotICAgICAgICAgKiBXaGVuIHJlc3VtaW5nIHZhbGlkYXRpb24s
IGlmIFBURl9wYXJ0aWFsX2dlbmVyYWxfcmVmIGlzCi0gICAgICAgICAqIGNs
ZWFyLCB0aGVuIGEgZ2VuZXJhbCByZWZlcmVuY2UgbXVzdCBiZSByZS1hY3F1
aXJlZDsgaWYgaXQKLSAgICAgICAgICogaXMgc2V0LCBubyByZWZlcmVuY2Ug
c2hvdWxkIGJlIGFjcXVpcmVkLgorICAgICAgICAgKiBXaGVuIHJlc3VtaW5n
IHZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFsX3NldCBpcyBjbGVhciwgdGhl
bgorICAgICAgICAgKiBhIGdlbmVyYWwgcmVmZXJlbmNlIG11c3QgYmUgcmUt
YWNxdWlyZWQ7IGlmIGl0IGlzIHNldCwgbm8KKyAgICAgICAgICogcmVmZXJl
bmNlIHNob3VsZCBiZSBhY3F1aXJlZC4KICAgICAgICAgICoKLSAgICAgICAg
ICogV2hlbiByZXN1bWluZyBkZS12YWxpZGF0aW9uLCBpZiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBpcwotICAgICAgICAgKiBjbGVhciwgbm8gcmVmZXJl
bmNlIHNob3VsZCBiZSBkcm9wcGVkOyBpZiBpdCBpcyBzZXQsIGEKLSAgICAg
ICAgICogcmVmZXJlbmNlIHNob3VsZCBiZSBkcm9wcGVkLgorICAgICAgICAg
KiBXaGVuIHJlc3VtaW5nIGRlLXZhbGlkYXRpb24sIGlmIFBURl9wYXJ0aWFs
X3NldCBpcyBjbGVhciwKKyAgICAgICAgICogbm8gcmVmZXJlbmNlIHNob3Vs
ZCBiZSBkcm9wcGVkOyBpZiBpdCBpcyBzZXQsIGEgcmVmZXJlbmNlCisgICAg
ICAgICAqIHNob3VsZCBiZSBkcm9wcGVkLgogICAgICAgICAgKgotICAgICAg
ICAgKiBOQiBhdCB0aGUgbW9tZW50LCBQVEZfcGFydGlhbF9zZXQgc2hvdWxk
IGJlIHNldCBpZiBhbmQgb25seSBpZgotICAgICAgICAgKiBQVEZfcGFydGlh
bF9nZW5lcmFsX3JlZiBpcyBzZXQuCi0gICAgICAgICAqCi0gICAgICAgICAq
IE5CIHRoYXQgUFRGX3BhcnRpYWxfc2V0IGFuZCBQVEZfcGFydGlhbF9nZW5l
cmFsX3JlZiBhcmUKLSAgICAgICAgICogZGVmaW5lZCBpbiBtbS5jLCB0aGUg
b25seSBwbGFjZSB3aGVyZSB0aGV5IGFyZSB1c2VkLgorICAgICAgICAgKiBO
QiB0aGF0IFBURl9wYXJ0aWFsX3NldCBpcyBkZWZpbmVkIGluIG1tLmMsIHRo
ZSBvbmx5IHBsYWNlCisgICAgICAgICAqIHdoZXJlIGl0IGlzIHVzZWQuCiAg
ICAgICAgICAqCiAgICAgICAgICAqIFRoZSAzcmQgZmllbGQsIEBsaW5lYXJf
cHRfY291bnQsIGluZGljYXRlcwogICAgICAgICAgKiAtIGJ5IGEgcG9zaXRp
dmUgdmFsdWUsIGhvdyBtYW55IHNhbWUtbGV2ZWwgcGFnZSB0YWJsZSBlbnRy
aWVzIGEgcGFnZQpAQCAtMjcxLDggKzI2OCw4IEBAIHN0cnVjdCBwYWdlX2lu
Zm8KICAgICAgICAgICovCiAgICAgICAgIHN0cnVjdCB7CiAgICAgICAgICAg
ICB1MTYgbnJfdmFsaWRhdGVkX3B0ZXM6UEFHRVRBQkxFX09SREVSICsgMTsK
LSAgICAgICAgICAgIHUxNiA6MTYgLSBQQUdFVEFCTEVfT1JERVIgLSAxIC0g
MjsKLSAgICAgICAgICAgIHUxNiBwYXJ0aWFsX2ZsYWdzOjI7CisgICAgICAg
ICAgICB1MTYgOjE2IC0gUEFHRVRBQkxFX09SREVSIC0gMSAtIDE7CisgICAg
ICAgICAgICB1MTYgcGFydGlhbF9mbGFnczoxOwogICAgICAgICAgICAgczE2
IGxpbmVhcl9wdF9jb3VudDsKICAgICAgICAgfTsKIAotLSAKMi4yMy4wCgo=

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Disposition: attachment;
 filename="xsa299/0009-x86-mm-Properly-handle-linear-pagetable-promotion-fa.patch"
Content-Transfer-Encoding: base64

RnJvbSAxMmY4MWM0OWJkOGZmMTgzNTAzZDhjYjk3NTUyYTZiODAxZWFiNjRj
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDA5LzExXSB4
ODYvbW06IFByb3Blcmx5IGhhbmRsZSBsaW5lYXIgcGFnZXRhYmxlIHByb21v
dGlvbgogZmFpbHVyZXMKCkluIG9yZGVyIHRvIGFsbG93IHJlY3Vyc2l2ZSBw
YWdldGFibGUgcHJvbW90aW9ucyBhbmQgZGVtb3Rpb25zIHRvIGJlCmludGVy
cnVwdGVkLCBYZW4gbXVzdCBrZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0
aGUgc3ViLXBhZ2VzCnByb21vdGVkIG9yIGRlbW90ZWQuICBUaGlzIGlzIHN0
b3JlZCBpbiB0d28gZWxlbWVudHMgaW4gdGhlIHBhZ2UKc3RydWN0OiBucl9l
bnRyaWVzX3ZhbGlkYXRlZCBhbmQgcGFydGlhbF9mbGFncy4KClRoZSBydWxl
IGlzIHRoYXQgZW50cmllcyBbMCwgbnJfZW50cmllc192YWxpZGF0ZWQpIHNo
b3VsZCBhbHdheXMgYmUKdmFsaWRhdGVkIGFuZCBob2xkIGEgZ2VuZXJhbCBy
ZWZlcmVuY2UgY291bnQuICBJZiBwYXJ0aWFsX2ZsYWdzIGlzCnplcm8sIHRo
ZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXSBpcyBub3QgdmFsaWRhdGVkIGFu
ZCBubyByZWZlcmVuY2UKY291bnQgaXMgaGVsZC4gIElmIFBURl9wYXJ0aWFs
X3NldCBpcyBzZXQsIHRoZW4gW25yX2VudHJpZXNfdmFsaWRhdGVkXQppcyBw
YXJ0aWFsbHkgdmFsaWRhdGVkLCBhbmQgYSBnZW5lcmFsIHJlZmVyZW5jZSBj
b3VudCBpcyBoZWxkLgoKVW5mb3J0dW5hdGVseSwgaW4gY2FzZXMgd2hlcmUg
YW4gZW50cnkgYmVnYW4gd2l0aCBQVEZfcGFydGlhbF9zZXQgc2V0LAphbmQg
Z2V0X3BhZ2VfZnJvbV9sTmUoKSByZXR1cm5zIC1FSU5WQUwsIHRoZSBQVEZf
cGFydGlhbF9zZXQgYml0IGlzCmVycm9uZW91c2x5IGRyb3BwZWQuICAoVGhp
cyBzY2VuYXJpbyBjYW4gYmUgZW5naW5lZXJlZCBtYWlubHkgYnkgdGhlCnVz
ZSBvZiBpbnRlcmxlYXZpbmcgb2YgcHJvbW90aW5nIGFuZCBkZW1vdGluZyBh
IHBhZ2Ugd2hpY2ggaGFzICJsaW5lYXIKcGFnZXRhYmxlIiBlbnRyaWVzOyBz
ZWUgdGhlIGFwcGVuZGl4IGZvciBhIHNrZXRjaC4pICBUaGlzIG1lYW5zIHRo
YXQKd2Ugd2lsbCAibGVhayIgYSBnZW5lcmFsIHJlZmVyZW5jZSBjb3VudCBv
biB0aGUgcGFnZSBpbiBxdWVzdGlvbiwKcHJldmVudGluZyB0aGUgcGFnZSBm
cm9tIGJlaW5nIGZyZWVkLgoKRml4IHRoaXMgYnkgc2V0dGluZyBwYWdlLT5w
YXJ0aWFsX2ZsYWdzIHRvIHRoZSBwYXJ0aWFsX2ZsYWdzIGxvY2FsCnZhcmlh
YmxlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yOTkuCgpSZXBvcnRlZC1ieTog
R2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1bmxhcEBjaXRyaXguY29tPgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJp
eC5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+Ci0tLS0tCkFwcGVuZGl4CgpTdXBwb3NlIEEgYW5kIEIgY2FuIGJv
dGggYmUgcHJvbW90ZWQgdG8gTDIgcGFnZXMsIGFuZCBBW3hdIHBvaW50cyB0
byBCLgoKVjE6IFBJTl9MMiBCLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1Rf
dmFsaWRhdGVkCiAgQi5jb3VudCA9IDIgfCBQR0NfYWxsb2NhdGVkCgpWMTog
TU9EX0wzX0VOVFJZIHBvaW50aW5nIHNvbWV0aGluZyB0byBBLgogIEluIHRo
ZSBwcm9jZXNzIG9mIHZhbGlkYXRpbmcgQVt4XSwgZ3JhYiBhbiBleHRyYSB0
eXBlIC8gcmVmIG9uIEI6CiAgQi50eXBlX2NvdW50ID0gMiB8IFBHVF92YWxp
ZGF0ZWQKICBCLmNvdW50ID0gMyB8IFBHQ19hbGxvY2F0ZWQKICBBLnR5cGVf
Y291bnQgPSAxIHwgUEdUX3ZhbGlkYXRlZAogIEEuY291bnQgPSAyIHwgUEdD
X2FsbG9jYXRlZAoKVjE6IFVOUElOIEIuCiAgQi50eXBlX2NvdW50ID0gMSB8
IFBHVF92YWxpZGF0ZQogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAoK
VjE6IE1PRF9MM19FTlRSWSByZW1vdmluZyB0aGUgcmVmZXJlbmNlIHRvIEEu
CiAgRGUtdmFsaWRhdGUgQSwgZG93biB0byBBW3hdLCB3aGljaCBwb2ludHMg
dG8gQi4KICBEcm9wIHRoZSBmaW5hbCB0eXBlIG9uIEIuICBBcnJhbmdlIHRv
IGJlIGludGVycnVwdGVkLgogIEIudHlwZV9jb3VudCA9IDEgfCBQR1RfcGFy
dGlhbAogIEIuY291bnQgPSAyIHwgUEdDX2FsbG9jYXRlZAogIEEudHlwZV9j
b3VudCA9IDEgfCBQR1RfcGFydGlhbAogIEEubnJfdmFsaWRhdGVkX2VudHJp
ZXMgPSB4CiAgQS5wYXJ0aWFsX3B0ZSA9IC0xCgpWMjogTU9EX0wzX0VOVFJZ
IGFkZHMgYSByZWZlcmVuY2UgdG8gQS4KCkF0IHRoaXMgcG9pbnQsIGdldF9w
YWdlX2Zyb21fbDJlKEFbeF0pIHRyaWVzCmdldF9wYWdlX2FuZF90eXBlX2Zy
b21fbWZuKCksIHdoaWNoIGZhaWxzIGJlY2F1c2UgaXQncyB0aGUgd3Jvbmcg
dHlwZTsKYW5kIGdldF9sMl9saW5lYXJfcGFnZXRhYmxlKCkgYWxzbyBmYWls
cywgYmVjYXVzZSBCIGlzbid0IHZhbGlkYXRlZCBhcwphbiBsMiBhbnltb3Jl
LgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5jIHwgNiArKystLS0KIDEgZmlsZSBj
aGFuZ2VkLCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0u
YwppbmRleCAwNjU1YzA1NzBiLi4wMGUxMTJmNjc0IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAt
MTU1Myw3ICsxNTUzLDcgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25nIHR5cGUpCiAg
ICAgICAgICAgICBpZiAoIGkgKQogICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gMDsKKyAgICAgICAgICAg
ICAgICBwYWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKICAg
ICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0g
TlVMTDsKICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF90YWJsZSA9IHBhZ2U7CiAgICAgICAgICAgICB9CkBAIC0xNjQ3LDcgKzE2
NDcsNyBAQCBzdGF0aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdl
X2luZm8gKnBhZ2UpCiAgICAgICAgIGlmICggaSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSAwOworICAgICAgICAgICAg
cGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAgICAg
ICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAg
ICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKICAgICAgICAgfQpAQCAtMTgxOCw3ICsxODE4LDcgQEAgc3RhdGljIGlu
dCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAg
ICAgICAgICAgaWYgKCBpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAg
ICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IDA7CisgICAgICAgICAgICAg
ICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRpYWxfZmxhZ3M7CiAgICAg
ICAgICAgICAgICAgaWYgKCByYyA9PSAtRUlOVFIgKQogICAgICAgICAgICAg
ICAgICAgICByYyA9IC1FUkVTVEFSVDsKICAgICAgICAgICAgICAgICBlbHNl
Ci0tIAoyLjIzLjAKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Disposition: attachment;
 filename="xsa299/0010-x86-mm-Fix-nested-de-validation-on-error.patch"
Content-Transfer-Encoding: base64

RnJvbSBlMmIwZjUxMjNkYzg0ZGIyM2Y1YjRkNGFkNjcyYzg5MDU1ZjBkOGJk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NDkgKzAxMDAKU3ViamVjdDogW1BBVENIIDEwLzExXSB4
ODYvbW06IEZpeCBuZXN0ZWQgZGUtdmFsaWRhdGlvbiBvbiBlcnJvcgoKSWYg
YW4gaW52YWxpZCBlbnRyeSBpcyBkaXNjb3ZlcmVkIHdoZW4gdmFsaWRhdGlu
ZyBhIHBhZ2UtdGFibGUgdHJlZSwKdGhlIGVudGlyZSB0cmVlIHdoaWNoIGhh
cyBzbyBmYXIgYmVlbiB2YWxpZGF0ZWQgbXVzdCBiZSBkZS12YWxpZGF0ZWQu
ClNpbmNlIHRoaXMgbWF5IHRha2UgYSBsb25nIHRpbWUsIGFsbG9jX2xbMi00
XV90YWJsZSgpIHNldCBjdXJyZW50CnZjcHUncyBvbGRfZ3Vlc3RfdGFibGUg
aW1tZWRpYXRlbHk7IHB1dF9vbGRfZ3Vlc3RfdGFibGUoKSB3aWxsIG1ha2UK
c3VyZSB0aGF0IHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxlZCB0byBm
aW5pc2ggb2ZmIHRoZQpkZS12YWxpZGF0aW9uIGJlZm9yZSBhbnkgb3RoZXIg
TU1VIG9wZXJhdGlvbnMgY2FuIGhhcHBlbiBvbiB0aGUgdmNwdS4KClRoZSBp
bnZhcmlhbnQgZm9yIHBhcnRpYWwgcGFnZXMgc2hvdWxkIGJlOgoKKiBFbnRy
aWVzIFswLCBucl92YWxpZGF0ZWRfcHRlcykgc2hvdWxkIGJlIGNvbXBsZXRl
bHkgdmFsaWRhdGVkOwogIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGRlLXZhbGlk
YXRlIHRoZXNlLgoKKiBJZiBbbnJfdmFsaWRhdGVkX3B0ZXNdIGlzIHBhcnRp
YWxseSB2YWxpZGF0ZWQsIHBhcnRpYWxfZmxhZ3Mgc2hvdWxkCiAgc2V0IFBU
Rl9wYXJ0aWFMX3NldC4gIHB1dF9wYWdlX3R5cGUoKSB3aWxsIGJlIGNhbGxl
ZCBvbiB0aGlzIHBhZ2UgdG8KICBmaW5pc2ggb2ZmIGRldmFsaWRhdGlvbiwg
YW5kIHRoZSBhcHByb3ByaWF0ZSByZWZjb3VudCBhZGp1c3RtZW50cwogIHdp
bGwgYmUgZG9uZS4KCmFsbG9jX2xbMi0zXV90YWJsZSgpIGluZGljYXRlcyBw
YXJ0aWFsIHZhbGlkYXRpb24gdG8gaXRzIGNhbGxlcnMgYnkKc2V0dGluZyBj
dXJyZW50LT5vbGRfZ3Vlc3RfdGFibGUuCgpVbmZvcnR1bmF0ZWx5LCB0aGlz
IGlzIG1pc2hhbmRsZWQuCgpUYWtlIHRoZSBjYXNlIHdoZXJlIHZhbGlkYXRp
bmcgbE5lW3hdIHJldHVybnMgYW4gZXJyb3IuCgpGaXJzdCwgYWxsb2NfbDNf
dGFibGUoKSBkb2Vzbid0IGNoZWNrIG9sZF9ndWVzdF90YWJsZSBhdCBhbGw7
IGFzIGEKcmVzdWx0LCBwYXJ0aWFsX2ZsYWdzIGlzIG5vdCBzZXQgd2hlbiBp
dCBzaG91bGQgYmUuICBucl92YWxpZGF0ZWRfcHRlcwppcyBzZXQgdG8geDsg
YW5kIHNpbmNlIFBGVF9wYXJ0aWFsX3NldCBjbGVhciwgZGUtdmFsaWRhdGlv
biByZXN1bWVzIGF0Cm5yX3ZhbGlkYXRlZF9wdGVzLTEuICBUaGlzIG1lYW5z
IHRoYXQgdGhlIGwyIHBhZ2UgYXQgcGwzZVt4XSB3aWxsIG5vdApoYXZlIHB1
dF9wYWdlX3R5cGUoKSBjYWxsZWQgb24gaXQgd2hlbiBkZS12YWxpZGF0aW5n
IHRoZSByZXN0IG9mIHRoZQpsMzogaXQgd2lsbCBiZSBzdHVjayBpbiB0aGUg
UEdUX3BhcnRpYWwgc3RhdGUgdW50aWwgdGhlIGRvbWFpbiBpcwpkZXN0cm95
ZWQsIG9yIHVudGlsIGl0IGlzIHJlLXVzZWQgYXMgYW4gbDIuICAoQW55IG90
aGVyIHBhZ2UgdHlwZSB3aWxsCmZhaWwuKQoKV29yc2UsIGFsbG9jX2w0X3Rh
YmxlKCksIHJhdGhlciB0aGFuIHNldHRpbmcgUFRGX3BhcnRpYWxfc2V0IGFz
IGl0CnNob3VsZCwgc2V0cyBucl92YWxpZGF0ZWRfcHRlcyB0byB4KzEuICBX
aGVuIGRlLXZhbGlkYXRpbmcsIHNpbmNlCnBhcnRpYWwgaXMgMCwgdGhpcyB3
aWxsIGNvcnJlY3RseSByZXN1bWUgY2FsbGluZyBwdXRfcGFnZV90eXBlIGF0
IFt4XTsKYnV0LCBpZiB0aGUgcHV0X3BhZ2VfdHlwZSgpIGlzIG5ldmVyIGNh
bGxlZCwgYnV0IGluc3RlYWQKZ2V0X3BhZ2VfdHlwZSgpIGlzIGNhbGxlZCwg
dmFsaWRhdGlvbiB3aWxsIHBpY2sgdXAgYXQgW3grMV0sCm5lZ2xlY3Rpbmcg
dG8gdmFsaWRhdGUgW3hdLiAgSWYgdGhlIHJlc3Qgb2YgdGhlIHZhbGlkYXRp
b24gc3VjY2VlZHMsCnRoZSBsNCB3aWxsIGJlIHZhbGlkYXRlZCBldmVuIHRo
b3VnaCBbeF0gaXMgaW52YWxpZC4KCkZpeCB0aGlzIGluIGJvdGggY2FzZXMg
Ynkgc2V0dGluZyBQVEZfcGFydGlhbF9zZXQgaWYgb2xkX2d1ZXN0X3RhYmxl
CmlzIHNldC4KCldoaWxlIGhlcmUsIGFkZCBzb21lIHNhZmV0eSBjYXRjaGVz
OgotIG9sZF9ndWVzdF90YWJsZSBtdXN0IHBvaW50IHRvIHRoZSBwYWdlIGNv
bnRhaW5lZCBpbgogIFtucl92YWxpZGF0ZWRfcHRlc10uCi0gYWxsb2NfbDFf
cGFnZSBzaG91bGRuJ3Qgc2V0IG9sZF9ndWVzdF90YWJsZQoKSWYgd2UgZXhw
ZXJpZW5jZSBvbmUgb2YgdGhlc2Ugc2l0dWF0aW9ucyBpbiBwcm9kdWN0aW9u
IGJ1aWxkcywgaXQncwpzYWZlciB0byBhdm9pZCBjYWxsaW5nIHB1dF9wYWdl
X3R5cGUgZm9yIHRoZSBwYWdlcyBpbiBxdWVzdGlvbi4gIElmCnRoZXkgaGF2
ZSBQR1RfcGFydGlhbCBzZXQsIHRoZXkgd2lsbCBiZSBjbGVhbmVkIHVwIG9u
IGRvbWFpbgpkZXN0cnVjdGlvbjsgaWYgbm90LCB3ZSBoYXZlIG5vIGlkZWEg
d2hldGhlciBhIHR5cGUgY291bnQgaXMgc2FmZSB0bwpkcm9wLiAgUmV0YWlu
aW5nIGFuIGV4dHJhIHR5cGUgcmVmIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBk
cm9wcGVkIG1heQp0cmlnZ2VyIGEgQlVHKCkgb24gdGhlIGZyZWVfZG9tYWlu
X3BhZ2UoKSBwYXRoLCBidXQgZHJvcHBpbmcgYSB0eXBlCmNvdW50IHRoYXQg
c2hvdWxkbid0IGJlIGRyb3BwZWQgbWF5IGNhdXNlIGEgcHJpdmlsZWdlIGVz
Y2FsYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5OS4KClJlcG9ydGVk
LWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBA
Y2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvbW0uYyB8IDUzICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tCiAx
IGZpbGUgY2hhbmdlZCwgNTEgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNo
L3g4Ni9tbS5jCmluZGV4IDAwZTExMmY2NzQuLjQzZmYzNjI3ZWIgMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCkBAIC0xNTUyLDYgKzE1NTIsMjAgQEAgc3RhdGljIGludCBhbGxvY19s
Ml90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlLCB1bnNpZ25lZCBsb25n
IHR5cGUpCiAgICAgICAgICAgICBBU1NFUlQoY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfdGFibGUgPT0gTlVMTCk7CiAgICAgICAgICAgICBpZiAoIGkgKQog
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAg
ICAgICAgICogYWxsb2NfbDFfdGFibGUoKSBkb2Vzbid0IHNldCBvbGRfZ3Vl
c3RfdGFibGU7IGl0IGRvZXMKKyAgICAgICAgICAgICAgICAgKiBpdHMgb3du
IHRlYXItZG93biBpbW1lZGlhdGVseSBvbiBmYWlsdXJlLiAgSWYgaXQKKyAg
ICAgICAgICAgICAgICAgKiBkaWQgd2UnZCBuZWVkIHRvIGNoZWNrIGl0IGFu
ZCBzZXQgcGFydGlhbF9mbGFncyBhcyB3ZQorICAgICAgICAgICAgICAgICAq
IGRvIGluIGFsbG9jX2xbMzRdX3RhYmxlKCkuCisgICAgICAgICAgICAgICAg
ICoKKyAgICAgICAgICAgICAgICAgKiBOb3RlIG9uIHRoZSB1c2Ugb2YgQVNT
RVJUOiBpZiBpdCdzIG5vbi1udWxsIGFuZAorICAgICAgICAgICAgICAgICAq
IGhhc24ndCBiZWVuIGNsZWFuZWQgdXAgeWV0LCBpdCBzaG91bGQgaGF2ZQor
ICAgICAgICAgICAgICAgICAqIFBHVF9wYXJ0aWFsIHNldDsgYW5kIHNvIHRo
ZSB0eXBlIHdpbGwgYmUgY2xlYW5lZCB1cAorICAgICAgICAgICAgICAgICAq
IG9uIGRvbWFpbiBkZXN0cnVjdGlvbi4gIFVuZm9ydHVuYXRlbHksIHdlIHdv
dWxkCisgICAgICAgICAgICAgICAgICogbGVhayB0aGUgZ2VuZXJhbCByZWYg
aGVsZCBieSBvbGRfZ3Vlc3RfdGFibGU7IGJ1dAorICAgICAgICAgICAgICAg
ICAqIGxlYWtpbmcgYSBwYWdlIGlzIGxlc3MgYmFkIHRoYW4gYSBob3N0IGNy
YXNoLgorICAgICAgICAgICAgICAgICAqLworICAgICAgICAgICAgICAgIEFT
U0VSVChjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9PSBOVUxMKTsK
ICAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7
CiAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IHBhcnRp
YWxfZmxhZ3M7CiAgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CkBAIC0xNTc5LDYgKzE1OTMsNyBAQCBzdGF0
aWMgaW50IGFsbG9jX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2Up
CiAgICAgdW5zaWduZWQgaW50ICAgaTsKICAgICBpbnQgICAgICAgICAgICBy
YyA9IDA7CiAgICAgdW5zaWduZWQgaW50ICAgcGFydGlhbF9mbGFncyA9IHBh
Z2UtPnBhcnRpYWxfZmxhZ3M7CisgICAgbDNfcGdlbnRyeV90ICAgbDNlID0g
bDNlX2VtcHR5KCk7CiAKICAgICBwbDNlID0gbWFwX2RvbWFpbl9wYWdlKF9t
Zm4ocGZuKSk7CiAKQEAgLTE1OTUsNyArMTYxMCw3IEBAIHN0YXRpYyBpbnQg
YWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKICAgICBm
b3IgKCBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMM19QQUdF
VEFCTEVfRU5UUklFUzsKICAgICAgICAgICBpKyssIHBhcnRpYWxfZmxhZ3Mg
PSAwICkKICAgICB7Ci0gICAgICAgIGwzX3BnZW50cnlfdCBsM2UgPSBwbDNl
W2ldOworICAgICAgICBsM2UgPSBwbDNlW2ldOwogCiAgICAgICAgIGlmICgg
aSA+IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVl
bXB0X2NoZWNrKCkgKQogICAgICAgICAgICAgcmMgPSAtRUlOVFI7CkBAIC0x
NjQ4LDYgKzE2NjMsMjQgQEAgc3RhdGljIGludCBhbGxvY19sM190YWJsZShz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQogICAgICAgICB7CiAgICAgICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CiAgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX2ZsYWdzID0gcGFydGlhbF9mbGFnczsKKyAgICAgICAg
ICAgIGlmICggY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgKQorICAg
ICAgICAgICAgeworICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAg
ICAgICogV2UndmUgZXhwZXJpZW5jZWQgYSB2YWxpZGF0aW9uIGZhaWx1cmUu
ICBJZgorICAgICAgICAgICAgICAgICAqIG9sZF9ndWVzdF90YWJsZSBpcyBz
ZXQsICJ0cmFuc2ZlciIgdGhlIGdlbmVyYWwKKyAgICAgICAgICAgICAgICAg
KiByZWZlcmVuY2UgY291bnQgdG8gcGwzZVtucl92YWxpZGF0ZWRfcHRlc10g
YnkKKyAgICAgICAgICAgICAgICAgKiBzZXR0aW5nIFBURl9wYXJ0aWFsX3Nl
dC4KKyAgICAgICAgICAgICAgICAgKgorICAgICAgICAgICAgICAgICAqIEFz
IGEgcHJlY2F1dGlvbiwgY2hlY2sgdGhhdCBvbGRfZ3Vlc3RfdGFibGUgaXMg
dGhlCisgICAgICAgICAgICAgICAgICogcGFnZSBwb2ludGVkIHRvIGJ5IHBs
M2VbbnJfdmFsaWRhdGVkX3B0ZXNdLiAgSWYKKyAgICAgICAgICAgICAgICAg
KiBub3QsIGl0J3Mgc2FmZXIgdG8gbGVhayBhIHR5cGUgcmVmIG9uIHByb2R1
Y3Rpb24KKyAgICAgICAgICAgICAgICAgKiBidWlsZHMuCisgICAgICAgICAg
ICAgICAgICovCisgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBsM2VfZ2V0X3BhZ2UobDNlKSApCisgICAg
ICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFy
dGlhbF9zZXQ7CisgICAgICAgICAgICAgICAgZWxzZQorICAgICAgICAgICAg
ICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICAgICAgICAgIH0K
ICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBO
VUxMOwogICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGUgPSBwYWdlOwogICAgICAgICB9CkBAIC0xODI0LDcgKzE4NTcsMjMgQEAg
c3RhdGljIGludCBhbGxvY19sNF90YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQogICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfdGFibGUgKQotICAgICAgICAgICAgICAgICAgICAgICAgcGFnZS0+
bnJfdmFsaWRhdGVkX3B0ZXMrKzsKKyAgICAgICAgICAgICAgICAgICAgewor
ICAgICAgICAgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAqIFdlJ3ZlIGV4cGVyaWVuY2VkIGEgdmFsaWRhdGlvbiBmYWls
dXJlLiAgSWYKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIG9sZF9ndWVz
dF90YWJsZSBpcyBzZXQsICJ0cmFuc2ZlciIgdGhlIGdlbmVyYWwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAqIHJlZmVyZW5jZSBjb3VudCB0byBwbDNl
W25yX3ZhbGlkYXRlZF9wdGVzXSBieQorICAgICAgICAgICAgICAgICAgICAg
ICAgICogc2V0dGluZyBQVEZfcGFydGlhbF9zZXQuCisgICAgICAgICAgICAg
ICAgICAgICAgICAgKgorICAgICAgICAgICAgICAgICAgICAgICAgICogQXMg
YSBwcmVjYXV0aW9uLCBjaGVjayB0aGF0IG9sZF9ndWVzdF90YWJsZSBpcyB0
aGUKKyAgICAgICAgICAgICAgICAgICAgICAgICAqIHBhZ2UgcG9pbnRlZCB0
byBieSBwbDRlW25yX3ZhbGlkYXRlZF9wdGVzXS4gIElmCisgICAgICAgICAg
ICAgICAgICAgICAgICAgKiBub3QsIGl0J3Mgc2FmZXIgdG8gbGVhayBhIHR5
cGUgcmVmIG9uIHByb2R1Y3Rpb24KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAqIGJ1aWxkcy4KKyAgICAgICAgICAgICAgICAgICAgICAgICAqLworICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9PSBsNGVfZ2V0X3BhZ2UobDRlKSApCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9mbGFncyA9IFBURl9w
YXJ0aWFsX3NldDsKKyAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUo
KTsKKyAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg
ICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAg
ICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUg
PSBwYWdlOwogICAgICAgICAgICAgICAgIH0KLS0gCjIuMjMuMAoK

--=separator
Content-Type: application/octet-stream;
 name="xsa299/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Disposition: attachment;
 filename="xsa299/0011-x86-mm-Don-t-drop-a-type-ref-unless-you-held-a-ref-t.patch"
Content-Transfer-Encoding: base64

RnJvbSBlMDMzOTkwYzQ3MjAwMWE4YzM3YjBhYzFhNDEwZDdiNGVkMTNiZTY5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFRodSwgMTAgT2N0
IDIwMTkgMTc6NTc6NTAgKzAxMDAKU3ViamVjdDogW1BBVENIIDExLzExXSB4
ODYvbW06IERvbid0IGRyb3AgYSB0eXBlIHJlZiB1bmxlc3MgeW91IGhlbGQg
YSByZWYgdG8KIGJlZ2luIHdpdGgKClZhbGlkYXRpb24gYW5kIGRlLXZhbGlk
YXRpb24gb2YgcGFnZXRhYmxlIHRyZWVzIG1heSB0YWtlIGFyYml0cmFyaWx5
CmxhcmdlIGFtb3VudHMgb2YgdGltZSwgYW5kIHNvIG11c3QgYmUgcHJlZW1w
dGlibGUuICBUaGlzIGlzIGluZGljYXRlZApieSBzZXR0aW5nIHRoZSBQR1Rf
cGFydGlhbCBiaXQgaW4gdGhlIHR5cGVfaW5mbywgYW5kIHNldHRpbmcKbnJf
dmFsaWRhdGVkX2VudHJpZXMgYW5kIHBhcnRpYWxfZmxhZ3MgYXBwcm9wcmlh
dGVseS4gIFNwZWNpZmljYWxseSwKaWYgdGhlIGVudHJ5IGF0IFtucl92YWxp
ZGF0ZWRfZW50cmllc10gaXMgcGFydGlhbGx5IHZhbGlkYXRlZCwKcGFydGlh
bF9mbGFncyBzaG91bGQgaGF2ZSB0aGUgUEdUX3BhcnRpYWxfc2V0IGJpdCBz
ZXQsIGFuZCB0aGUgZW50cnkKc2hvdWxkIGhvbGQgYSBnZW5lcmFsIHJlZmVy
ZW5jZSBjb3VudC4gIER1cmluZyBkZS12YWxpZGF0aW9uLApwdXRfcGFnZV90
eXBlKCkgaXMgY2FsbGVkIG9uIHBhcnRpYWxseSB2YWxpZGF0ZWQgZW50cmll
cy4KClVuZm9ydHVuYXRlbHksIHRoZXJlIGFyZSBhIG51bWJlciBvZiBpc3N1
ZXMgd2l0aCB0aGUgY3VycmVudCBhbGdvcml0aG0uCgpGaXJzdCwgZG9pbmcg
YSAibm9ybWFsIiBwdXRfcGFnZV90eXBlKCkgaXMgbm90IHNhZmUgd2hlbiBu
byB0eXBlIHJlZgppcyBoZWxkOiB0aGVyZSBpcyBub3RoaW5nIHRvIHN0b3Ag
YW5vdGhlciB2Y3B1IGZyb20gY29taW5nIGFsb25nIGFuZApwaWNraW5nIHVw
IHZhbGlkYXRpb24gYWdhaW46IGF0IHdoaWNoIHBvaW50IHRoZSBwdXRfcGFn
ZV90eXBlIG1heSBkcm9wCnRoZSBvbmx5IHBhZ2UgcmVmIG9uIGFuIGluLXVz
ZSBwYWdlLiAgU29tZSBleGFtcGxlcyBhcmUgbGlzdGVkIGluIHRoZQphcHBl
bmRpeC4KClRoZSBjb3JlIGlzc3VlIGlzIHRoYXQgcHV0X3BhZ2VfdHlwZSgp
IGlzIGJlaW5nIGNhbGxlZCBib3RoIHRvIGNsZWFuCnVwIFBHVF9wYXJ0aWFs
LCBhbmQgdG8gZHJvcCBhIHR5cGUgY291bnQ7IGFuZCBoYXMgbm8gd2F5IG9m
IGtub3dpbmcKd2hpY2ggaXMgd2hpY2g7IGFuZCBzbyBpZiBpbiBiZXR3ZWVu
LCBQR1RfcGFydGlhbCBpcyBjbGVhcmVkLApwdXRfcGFnZV90eXBlKCkgd2ls
bCBkcm9wIHRoZSB0eXBlIHJlZiBlcnJvbmVvdXNseS4KCldoYXQgaXMgbmVl
ZGVkIGlzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gdHdvIHN0YXRlczoKLSBE
cm9wcGluZyBhIHR5cGUgcmVmIHdoaWNoIGlzIGhlbGQKLSBDbGVhbmluZyB1
cCBhIHBhZ2Ugd2hpY2ggaGFzIGJlZW4gcGFydGlhbGx5IGRlL3ZhbGlkYXRl
ZAoKRml4IHRoaXMgYnkgdGVsbGluZyBwdXRfcGFnZV90eXBlKCkgd2hpY2gg
b2YgdGhlIHR3byBhY3Rpdml0aWVzIHlvdQppbnRlbmQuCgpXaGVuIGNsZWFu
aW5nIHVwIGEgcGFydGlhbCBkZS92YWxpZGF0aW9uLCB0YWtlIG5vIGFjdGlv
biB1bmxlc3MgeW91CmZpbmQgYSBwYWdlIHBhcnRpYWxseSB2YWxpZGF0ZWQu
CgpJZiBwdXRfcGFnZV90eXBlKCkgaXMgY2FsbGVkIHdpdGhvdXQgUFRGX3Bh
cnRpYWxfc2V0LCBhbmQgZmluZHMgdGhlCnBhZ2UgaW4gYSBQR1RfcGFydGlh
bCBzdGF0ZSBhbnl3YXksIHRoZW4gdGhlcmUncyBjZXJ0YWlubHkgYmVlbiBh
Cm1pc2FjY291bnRpbmcgc29tZXdoZXJlLCBhbmQgY2Fycnlpbmcgb24gd291
bGQgYWxtb3N0IGNlcnRhaW5seSBjYXVzZQphIHNlY3VyaXR5IGlzc3VlLCBz
byBjcmFzaCB0aGUgaG9zdCBpbnN0ZWFkLgoKSW4gcHV0X3BhZ2VfZnJvbV9s
TmUsIHBhc3MgcGFydGlhbF9mbGFncyBvbiB0byBfcHV0X3BhZ2VfdHlwZSgp
LgoKb2xkX2d1ZXN0X3RhYmxlIG1heSBiZSBzZXQgZWl0aGVyIHdpdGggYSBm
dWxseSB2YWxpZGF0ZWQgcGFnZSAod2hlbgp1c2luZyB0aGUgImRlZmVycmVk
IHB1dCIgcGF0dGVybiksIG9yIHdpdGggYSBwYXJ0aWFsbHkgdmFsaWRhdGVk
IHBhZ2UKKHdoZW4gYSBub3JtYWwgImRlLXZhbGlkYXRpb24iIGlzIGludGVy
cnVwdGVkLCBvciB3aGVuIGEgdmFsaWRhdGlvbgpmYWlscyBwYXJ0LXdheSB0
aHJvdWdoIGR1ZSB0byBpbnZhbGlkIGVudHJpZXMpLiAgQWRkIGEgZmxhZywK
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwsIHRvIGluZGljYXRlIHdoaWNoIG9m
IHRoZXNlIGl0IGlzLCBhbmQgdXNlCnRoYXQgdG8gcGFzcyB0aGUgYXBwcm9w
cmlhdGUgZmxhZyB0byBfcHV0X3BhZ2VfdHlwZSgpLgoKV2hpbGUgaGVyZSwg
ZGVsZXRlIHN0cmF5IHRyYWlsaW5nIHdoaXRlc3BhY2UuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTI5OS4KClJlcG9ydGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxn
ZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3Jn
ZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2aWV3ZWQt
Ynk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tLS0KQXBw
ZW5kaXg6CgpTdXBwb3NlIHBhZ2UgQSwgd2hlbiBpbnRlcnByZXRlZCBhcyBh
biBsMyBwYWdldGFibGUsIGNvbnRhaW5zIGFsbAp2YWxpZCBlbnRyaWVzOyBh
bmQgc3VwcG9zZSBBW3hdIHBvaW50cyB0byBwYWdlIEIsIHdoaWNoIHdoZW4K
aW50ZXJwcmV0ZWQgYXMgYW4gbDIgcGFnZXRhYmxlLCBjb250YWlucyBhbGwg
dmFsaWQgZW50cmllcy4KClAxOiBQSU5fTDNfVEFCTEUKICBBIC0+IFBHVF9s
M190YWJsZSB8IDEgfCB2YWxpZAogIEIgLT4gUEdUX2wyX3RhYmxlIHwgMSB8
IHZhbGlkCgpQMTogVU5QSU5fVEFCTEUKICA+IEFycmFuZ2UgdG8gaW50ZXJy
dXB0IGFmdGVyIEIgaGFzIGJlZW4gZGUtdmFsaWRhdGVkCiAgQjoKICAgIHR5
cGVfaW5mbyAtPiBQR1RfbDJfdGFibGUgfCAwCiAgQToKICAgIHR5cGVfaW5m
byAtPiBQR1RfbDNfdGFibGUgfCAxIHwgcGFydGlhbAogICAgbnJfdmFsaWRh
dGVkX2VudGllcyAtPiAobGVzcyB0aGFuIHgpCgpQMjogbW9kX2w0X2VudHJ5
IHRvIHBvaW50IHRvIEEKICA+IEFycmFuZ2UgZm9yIHRoaXMgdG8gYmUgaW50
ZXJydXB0ZWQgd2hpbGUgQiBpcyBiZWluZyB2YWxpZGF0ZWQKICBCOgogICAg
dHlwZV9pbmZvIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBwYXJ0aWFsCiAgICAo
bnJfdmFsaWRhdGVkX2VudGlyZXMgJmMgc2V0IGFzIGFwcHJvcHJpYXRlKQog
IEE6CiAgICB0eXBlX2luZm8gLT4gUEdUX2wzX3RhYmxlIHwgMSB8IHBhcnRp
YWwKICAgIG5yX3ZhbGlkYXRlZF9lbnRyaWVzIC0+IHgKICAgIHBhcnRpYWxf
cHRlID0gMQoKUDM6IG1vZF9sM19lbnRyeSBzb21lIG90aGVyIHVucmVsYXRl
ZCBsMyB0byBwb2ludCB0byBCOgogIEI6CiAgICB0eXBlX2luZm8gLT4gUEdU
X2wyX3RhYmxlIHwgMQoKUDE6IFJlc3RhcnQgVU5QSU5fVEFCTEUKCkF0IHRo
aXMgcG9pbnQsIHNpbmNlIEEubnJfdmFsaWRhdGVfZW50cmllcyA9PSB4IGFu
ZCBBLnBhcnRpYWxfcHRlICE9CjAsIGZyZWVfbDNfdGFibGUoKSB3aWxsIGNh
bGwgcHV0X3BhZ2VfZnJvbV9sM2UoKSBvbiBwbDNlW3hdLCBkcm9wcGluZwpp
dHMgdHlwZSBjb3VudCB0byAwIHdoaWxlIGl0J3Mgc3RpbGwgYmVpbmcgcG9p
bnRlZCB0byBieSBzb21lIG90aGVyIGwzCgpBIHNpbWlsYXIgaXNzdWUgYXJp
c2VzIHdpdGggb2xkX2d1ZXN0X3RhYmxlLiAgQ29uc2lkZXIgdGhlIGZvbGxv
d2luZwpzY2VuYXJpbzoKClN1cHBvc2UgQSBpcyBhIHBhZ2Ugd2hpY2gsIHdo
ZW4gaW50ZXJwcmV0ZWQgYXMgYW4gbDIsIGhhcyB2YWxpZCBlbnRyaWVzCnVu
dGlsIGVudHJ5IHgsIHdoaWNoIGlzIGludmFsaWQuCgpWMTogIFBJTl9MMl9U
QUJMRShBKQogIDxWYWxpZGF0ZSB1bnRpbCB3ZSB0cnkgdG8gdmFsaWRhdGUg
W3hdLCBnZXQgLUVJTlZBTD4KICBBIC0+IFBHVF9sMl90YWJsZSB8IDEgfCBQ
R1RfcGFydGlhbAogIFYxIC0+IG9sZF9ndWVzdF90YWJsZSA9IEEKICA8ZGVs
YXllZD4KClYyOiBQSU5fTDJfVEFCTEUoQSkKICA8UGljayB1cCB3aGVyZSBW
MSBsZWZ0IG9mZiwgdHJ5IHRvIHJlLXZhbGlkYXRlIFt4XSwgZ2V0IC1FSU5W
QUw+CiAgQSAtPiBQR1RfbDJfdGFibGUgfCAxIHwgUEdUX3BhcnRpYWwKICBW
MiAtPiBvbGRfZ3Vlc3RfdGFibGUgPSBBCiAgPHJlc3RhcnQ+CiAgcHV0X29s
ZF9ndWVzdF90YWJsZSgpCiAgICBfcHV0X3BhZ2VfdHlwZShBKQogICAgICBB
IC0+IFBHVF9sMl90YWJsZSB8IDAKClYxOiA8cmVzdGFydD4KICBwdXRfb2xk
X2d1ZXN0X3RhYmxlKCkKICAgIF9wdXRfcGFnZV90eXBlKEEpICMgVU5ERVJG
TE9XCgpJbmRlZWQsIGl0IGlzIHBvc3NpYmxlIHRvIGVuZ2luZWVyIGZvciBv
bGRfZ3Vlc3RfdGFibGUgZm9yIGV2ZXJ5IHZjcHUKYSBndWVzdCBoYXMgdG8g
cG9pbnQgdG8gdGhlIHNhbWUgcGFnZS4KLS0tCiB4ZW4vYXJjaC94ODYvZG9t
YWluLmMgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvbW0uYyAgICAg
ICAgICAgIHwgOTkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oIHwgIDQgKy0KIDMg
ZmlsZXMgY2hhbmdlZCwgOTUgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IGZlYmJiMjMzMzYuLjkxODU2NGE5
MTAgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94
ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTExNjgsOSArMTE2OCwxNSBAQCBp
bnQgYXJjaF9zZXRfaW5mb19ndWVzdCgKICAgICAgICAgICAgICAgICAgICAg
cmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAgIC8qIEZhbGx0
aHJvdWdoICovCiAgICAgICAgICAgICAgICAgY2FzZSAtRVJFU1RBUlQ6Cisg
ICAgICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgICAgICAgICAq
IE5CIHRoYXQgd2UncmUgcHV0dGluZyB0aGUga2VybmVsLW1vZGUgdGFibGUK
KyAgICAgICAgICAgICAgICAgICAgICogaGVyZSwgd2hpY2ggd2UndmUgYWxy
ZWFkeSBzdWNjZXNzZnVsbHkKKyAgICAgICAgICAgICAgICAgICAgICogdmFs
aWRhdGVkIGFib3ZlOyBoZW5jZSBwYXJ0aWFsID0gZmFsc2U7CisgICAgICAg
ICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgICB2LT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICAgICAg
di0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPQogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFnZXRhYmxlX2dldF9wYWdlKHYtPmFyY2guZ3Vlc3RfdGFibGUp
OworICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgIHYtPmFy
Y2guZ3Vlc3RfdGFibGUgPSBwYWdldGFibGVfbnVsbCgpOwogICAgICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICBkZWZhdWx0Ogpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYv
bW0uYwppbmRleCA0M2ZmMzYyN2ViLi43OWMzZTRjNDczIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpA
QCAtMTMyOSwxMCArMTMyOSwxMSBAQCBzdGF0aWMgaW50IHB1dF9wYWdlX2Zy
b21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLAog
ICAgICAgICB7CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVz
dF9wdHBnID0gcHRwZzsKICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xk
X2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgIH0K
ICAgICAgICAgZWxzZQogICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCBQVEZfcHJlZW1wdGlibGUsIHB0cGcpOworICAg
ICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgZmxhZ3MgfCBQVEZf
cHJlZW1wdGlibGUsIHB0cGcpOwogICAgICAgICAgICAgaWYgKCBsaWtlbHko
IXJjKSApCiAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGcpOwogICAgICAg
ICB9CkBAIC0xMzU1LDYgKzEzNTYsNyBAQCBzdGF0aWMgaW50IHB1dF9wYWdl
X2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcgcGZu
LAogICAgICAgICB1bnNpZ25lZCBsb25nIG1mbiA9IGwzZV9nZXRfcGZuKGwz
ZSk7CiAgICAgICAgIGJvb2wgd3JpdGVhYmxlID0gbDNlX2dldF9mbGFncyhs
M2UpICYgX1BBR0VfUlc7CiAKKyAgICAgICAgQVNTRVJUKCEoZmxhZ3MgJiBQ
VEZfcGFydGlhbF9zZXQpKTsKICAgICAgICAgQVNTRVJUKCEobWZuICYgKCgx
VUwgPDwgKEwzX1BBR0VUQUJMRV9TSElGVCAtIFBBR0VfU0hJRlQpKSAtIDEp
KSk7CiAgICAgICAgIGRvIHsKICAgICAgICAgICAgIHB1dF9kYXRhX3BhZ2Uo
bWZuX3RvX3BhZ2UoX21mbihtZm4pKSwgd3JpdGVhYmxlKTsKQEAgLTEzNjcs
MTIgKzEzNjksMTQgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShs
M19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwKIAogICAgIGlm
ICggZmxhZ3MgJiBQVEZfZGVmZXIgKQogICAgIHsKKyAgICAgICAgQVNTRVJU
KCEoZmxhZ3MgJiBQVEZfcGFydGlhbF9zZXQpKTsKICAgICAgICAgY3VycmVu
dC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZu
KSk7CiAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0g
cGc7CisgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3Bh
cnRpYWwgPSBmYWxzZTsKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCi0g
ICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgUFRGX3ByZWVtcHRpYmxlLCBt
Zm5fdG9fcGFnZShfbWZuKHBmbikpKTsKKyAgICByYyA9IF9wdXRfcGFnZV90
eXBlKHBnLCBmbGFncyB8IFBURl9wcmVlbXB0aWJsZSwgbWZuX3RvX3BhZ2Uo
X21mbihwZm4pKSk7CiAgICAgaWYgKCBsaWtlbHkoIXJjKSApCiAgICAgICAg
IHB1dF9wYWdlKHBnKTsKIApAQCAtMTM5MSwxMiArMTM5NSwxNSBAQCBzdGF0
aWMgaW50IHB1dF9wYWdlX2Zyb21fbDRlKGw0X3BnZW50cnlfdCBsNGUsIHVu
c2lnbmVkIGxvbmcgcGZuLAogCiAgICAgICAgIGlmICggZmxhZ3MgJiBQVEZf
ZGVmZXIgKQogICAgICAgICB7CisgICAgICAgICAgICBBU1NFUlQoIShmbGFn
cyAmIFBURl9wYXJ0aWFsX3NldCkpOwogICAgICAgICAgICAgY3VycmVudC0+
YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7
CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9
IHBnOworICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFi
bGVfcGFydGlhbCA9IGZhbHNlOwogICAgICAgICAgICAgcmV0dXJuIDA7CiAg
ICAgICAgIH0KIAotICAgICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBQ
VEZfcHJlZW1wdGlibGUsIG1mbl90b19wYWdlKF9tZm4ocGZuKSkpOworICAg
ICAgICByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBmbGFncyB8IFBURl9wcmVl
bXB0aWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5fdG9f
cGFnZShfbWZuKHBmbikpKTsKICAgICAgICAgaWYgKCBsaWtlbHkoIXJjKSAp
CiAgICAgICAgICAgICBwdXRfcGFnZShwZyk7CiAgICAgfQpAQCAtMTUwNiw2
ICsxNTEzLDE0IEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgbG9uZyB0eXBlKQogCiAgICAg
cGwyZSA9IG1hcF9kb21haW5fcGFnZShfbWZuKHBmbikpOwogCisgICAgLyoK
KyAgICAgKiBOQiB0aGF0IGFsbG9jX2wyX3RhYmxlIHdpbGwgbmV2ZXIgc2V0
IHBhcnRpYWxfcHRlIG9uIGFuIGwyOyBidXQKKyAgICAgKiBmcmVlX2wyX3Rh
YmxlIG1pZ2h0IGlmIGEgbGluZWFyX3BhZ2V0YWJsZSBlbnRyeSBpcyBpbnRl
cnJ1cHRlZAorICAgICAqIHBhcnR3YXkgdGhyb3VnaCBkZS12YWxpZGF0aW9u
LiAgSW4gdGhhdCBjaXJjdW1zdGFuY2UsCisgICAgICogZ2V0X3BhZ2VfZnJv
bV9sMmUoKSB3aWxsIGFsd2F5cyByZXR1cm4gLUVJTlZBTDsgYW5kIHdlIG11
c3QKKyAgICAgKiByZXRhaW4gdGhlIHR5cGUgcmVmIGJ5IGRvaW5nIHRoZSBu
b3JtYWwgcGFydGlhbF9mbGFncyB0cmFja2luZy4KKyAgICAgKi8KKwogICAg
IGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwyX1BB
R0VUQUJMRV9FTlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbF9mbGFn
cyA9IDAgKQogICAgIHsKQEAgLTE1NzAsNiArMTU4NSw3IEBAIHN0YXRpYyBp
bnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSwgdW5z
aWduZWQgbG9uZyB0eXBlKQogICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfZmxhZ3MgPSBwYXJ0aWFsX2ZsYWdzOwogICAgICAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsK
KyAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZV9wYXJ0aWFsID0gdHJ1ZTsKICAgICAgICAgICAgIH0KICAgICAgICAgfQog
ICAgICAgICBpZiAoIHJjIDwgMCApCkBAIC0xNjc3LDEyICsxNjkzLDE2IEBA
IHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSkKICAgICAgICAgICAgICAgICAgKiBidWlsZHMuCiAgICAgICAgICAg
ICAgICAgICovCiAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50LT5hcmNo
Lm9sZF9ndWVzdF90YWJsZSA9PSBsM2VfZ2V0X3BhZ2UobDNlKSApCisgICAg
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICBBU1NFUlQoY3Vy
cmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCk7CiAgICAgICAg
ICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfZmxhZ3MgPSBQVEZfcGFydGlh
bF9zZXQ7CisgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIGVs
c2UKICAgICAgICAgICAgICAgICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7
CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9s
ZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgIGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgIGN1cnJl
bnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogICAg
ICAgICB9CiAgICAgICAgIHdoaWxlICggaS0tID4gMCApCiAgICAgICAgICAg
ICBwbDNlW2ldID0gdW5hZGp1c3RfZ3Vlc3RfbDNlKHBsM2VbaV0sIGQpOwpA
QCAtMTg3MCwxMiArMTg5MCwxNiBAQCBzdGF0aWMgaW50IGFsbG9jX2w0X3Rh
YmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgKiBidWlsZHMuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
Ki8KICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudC0+YXJj
aC5vbGRfZ3Vlc3RfdGFibGUgPT0gbDRlX2dldF9wYWdlKGw0ZSkgKQorICAg
ICAgICAgICAgICAgICAgICAgICAgeworICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZV9w
YXJ0aWFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlLT5w
YXJ0aWFsX2ZsYWdzID0gUFRGX3BhcnRpYWxfc2V0OworICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJM
RSgpOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg
ICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAg
ICAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJs
ZSA9IHBhZ2U7CisgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gu
b2xkX2d1ZXN0X3RhYmxlX3BhcnRpYWwgPSB0cnVlOwogICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgIH0KICAgICAgICAgfQpAQCAtMjgwMSw2ICsy
ODI1LDI4IEBAIHN0YXRpYyBpbnQgX3B1dF9wYWdlX3R5cGUoc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSwgdW5zaWduZWQgaW50IGZsYWdzLAogICAgICAgICB4
ICA9IHk7CiAgICAgICAgIG54ID0geCAtIDE7CiAKKyAgICAgICAgLyoKKyAg
ICAgICAgICogSXMgdGhpcyBleHBlY3RlZCB0byBkbyBhIGZ1bGwgcmVmZXJl
bmNlIGRyb3AsIG9yIG9ubHkKKyAgICAgICAgICogY2xlYW51cCBwYXJ0aWFs
IHZhbGlkYXRpb24gLyBkZXZhbGlkYXRpb24/CisgICAgICAgICAqCisgICAg
ICAgICAqIElmIHRoZSBmb3JtZXIsIHRoZSBjYWxsZXIgbXVzdCBob2xkIGEg
ImZ1bGwiIHR5cGUgcmVmOworICAgICAgICAgKiB3aGljaCBtZWFucyB0aGUg
cGFnZSBtdXN0IGJlIHZhbGlkYXRlZC4gIElmIHRoZSBwYWdlIGlzCisgICAg
ICAgICAqICpub3QqIGZ1bGx5IHZhbGlkYXRlZCwgY29udGludWluZyB3b3Vs
ZCBhbG1vc3QgY2VydGFpbmx5CisgICAgICAgICAqIG9wZW4gdXAgYSBzZWN1
cml0eSBob2xlLiAgQW4gZXhjZXB0aW9uIHRvIHRoaXMgaXMgZHVyaW5nCisg
ICAgICAgICAqIGRvbWFpbiBkZXN0cnVjdGlvbiwgd2hlcmUgUEdUX3ZhbGlk
YXRlZCBjYW4gYmUgZHJvcHBlZAorICAgICAgICAgKiB3aXRob3V0IGRyb3Bw
aW5nIGEgdHlwZSByZWYuCisgICAgICAgICAqCisgICAgICAgICAqIElmIHRo
ZSBsYXR0ZXIsIGRvIG5vdGhpbmcgdW5sZXNzIHR5cGUgUEdUX3BhcnRpYWwg
aXMgc2V0LgorICAgICAgICAgKiBJZiBpdCBpcyBzZXQsIHRoZSB0eXBlIGNv
dW50IG11c3QgYmUgMS4KKyAgICAgICAgICovCisgICAgICAgIGlmICggIShm
bGFncyAmIFBURl9wYXJ0aWFsX3NldCkgKQorICAgICAgICAgICAgQlVHX09O
KCh4ICYgUEdUX3BhcnRpYWwpIHx8CisgICAgICAgICAgICAgICAgICAgISgo
eCAmIFBHVF92YWxpZGF0ZWQpIHx8IHBhZ2VfZ2V0X293bmVyKHBhZ2UpLT5p
c19keWluZykpOworICAgICAgICBlbHNlIGlmICggISh4ICYgUEdUX3BhcnRp
YWwpICkKKyAgICAgICAgICAgIHJldHVybiAwOworICAgICAgICBlbHNlCisg
ICAgICAgICAgICBCVUdfT04oKHggJiBQR1RfY291bnRfbWFzaykgIT0gMSk7
CisKICAgICAgICAgQVNTRVJUKCh4ICYgUEdUX2NvdW50X21hc2spICE9IDAp
OwogCiAgICAgICAgIHN3aXRjaCAoIG54ICYgKFBHVF9sb2NrZWQgfCBQR1Rf
Y291bnRfbWFzaykgKQpAQCAtMzA1OCwxNyArMzEwNCwzNCBAQCBpbnQgcHV0
X29sZF9ndWVzdF90YWJsZShzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoICF2
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSApCiAgICAgICAgIHJldHVybiAwOwog
Ci0gICAgc3dpdGNoICggcmMgPSBfcHV0X3BhZ2VfdHlwZSh2LT5hcmNoLm9s
ZF9ndWVzdF90YWJsZSwgUFRGX3ByZWVtcHRpYmxlLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZykg
KQorICAgIHJjID0gX3B1dF9wYWdlX3R5cGUodi0+YXJjaC5vbGRfZ3Vlc3Rf
dGFibGUsCisgICAgICAgICAgICAgICAgICAgICAgICBQVEZfcHJlZW1wdGli
bGUgfAorICAgICAgICAgICAgICAgICAgICAgICAgKCB2LT5hcmNoLm9sZF9n
dWVzdF90YWJsZV9wYXJ0aWFsID8KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgUFRGX3BhcnRpYWxfc2V0IDogMCApLAorICAgICAgICAgICAgICAgICAg
ICAgICAgdi0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyk7CisKKyAgICBpZiAoIHJj
ID09IC1FUkVTVEFSVCB8fCByYyA9PSAtRUlOVFIgKQogICAgIHsKLSAgICBj
YXNlIC1FSU5UUjoKLSAgICBjYXNlIC1FUkVTVEFSVDoKKyAgICAgICAgdi0+
YXJjaC5vbGRfZ3Vlc3RfdGFibGVfcGFydGlhbCA9IChyYyA9PSAtRVJFU1RB
UlQpOwogICAgICAgICByZXR1cm4gLUVSRVNUQVJUOwotICAgIGNhc2UgMDoK
LSAgICAgICAgcHV0X3BhZ2Uodi0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUpOwog
ICAgIH0KIAorICAgIC8qCisgICAgICogSXQgc2hvdWxkbid0IGJlIHBvc3Np
YmxlIGZvciBfcHV0X3BhZ2VfdHlwZSgpIHRvIHJldHVybgorICAgICAqIGFu
eXRoaW5nIGVsc2UgYXQgdGhlIG1vbWVudDsgYnV0IGlmIGl0IGRvZXMgaGFw
cGVuIGluCisgICAgICogcHJvZHVjdGlvbiwgbGVha2luZyB0aGUgdHlwZSBy
ZWYgaXMgcHJvYmFibHkgdGhlIGJlc3QgdGhpbmcgdG8KKyAgICAgKiBkby4g
IEVpdGhlciB3YXksIGRyb3AgdGhlIGdlbmVyYWwgcmVmIGhlbGQgYnkgb2xk
X2d1ZXN0X3RhYmxlLgorICAgICAqLworICAgIEFTU0VSVChyYyA9PSAwKTsK
KworICAgIHB1dF9wYWdlKHYtPmFyY2gub2xkX2d1ZXN0X3RhYmxlKTsKICAg
ICB2LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IE5VTEw7CisgICAgdi0+YXJj
aC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CisgICAgLyoKKyAgICAgKiBTYWZl
c3QgZGVmYXVsdCBpZiBzb21lb25lIHNldHMgb2xkX2d1ZXN0X3RhYmxlIHdp
dGhvdXQKKyAgICAgKiBleHBsaWNpdGx5IHNldHRpbmcgb2xkX2d1ZXN0X3Rh
YmxlX3BhcnRpYWwuCisgICAgICovCisgICAgdi0+YXJjaC5vbGRfZ3Vlc3Rf
dGFibGVfcGFydGlhbCA9IHRydWU7CiAKICAgICByZXR1cm4gcmM7CiB9CkBA
IC0zMjE5LDExICszMjgyLDExIEBAIGludCBuZXdfZ3Vlc3RfY3IzKG1mbl90
IG1mbikKICAgICAgICAgICAgIHN3aXRjaCAoIHJjID0gcHV0X3BhZ2VfYW5k
X3R5cGVfcHJlZW1wdGlibGUocGFnZSkgKQogICAgICAgICAgICAgewogICAg
ICAgICAgICAgY2FzZSAtRUlOVFI6Ci0gICAgICAgICAgICAgICAgcmMgPSAt
RVJFU1RBUlQ7Ci0gICAgICAgICAgICAgICAgLyogZmFsbHRocm91Z2ggKi8K
ICAgICAgICAgICAgIGNhc2UgLUVSRVNUQVJUOgogICAgICAgICAgICAgICAg
IGN1cnItPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBOVUxMOwogICAgICAgICAg
ICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAg
ICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZV9wYXJ0
aWFsID0gKHJjID09IC1FUkVTVEFSVCk7CisgICAgICAgICAgICAgICAgcmMg
PSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg
ICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgIEJVR19PTihyYyk7CkBA
IC0zNDYwLDYgKzM1MjMsNyBAQCBsb25nIGRvX21tdWV4dF9vcCgKICAgICAg
ICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgY3Vy
ci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAgICAgICAg
ICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7
CisgICAgICAgICAgICAgICAgICAgICAgICBjdXJyLT5hcmNoLm9sZF9ndWVz
dF90YWJsZV9wYXJ0aWFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9CkBAIC0zNDk0
LDYgKzM1NTgsMTEgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgICAg
ICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAgICBjdXJyLT5hcmNo
Lm9sZF9ndWVzdF9wdHBnID0gTlVMTDsKICAgICAgICAgICAgICAgICBjdXJy
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICAg
ICAgLyoKKyAgICAgICAgICAgICAgICAgKiBFSU5UUiBtZWFucyB3ZSBzdGls
bCBob2xkIHRoZSB0eXBlIHJlZjsgRVJFU1RBUlQKKyAgICAgICAgICAgICAg
ICAgKiBtZWFucyBQR1RfcGFydGlhbCBob2xkcyB0aGUgdHlwZSByZWYKKyAg
ICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgICAgICBjdXJyLT5hcmNo
Lm9sZF9ndWVzdF90YWJsZV9wYXJ0aWFsID0gKHJjID09IC1FUkVTVEFSVCk7
CiAgICAgICAgICAgICAgICAgcmMgPSAwOwogICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgZGVmYXVsdDoKQEAgLTM1NjIsMTEgKzM2MzEs
MTUgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgICAgICAgICAgc3dp
dGNoICggcmMgPSBwdXRfcGFnZV9hbmRfdHlwZV9wcmVlbXB0aWJsZShwYWdl
KSApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIGNhc2Ug
LUVJTlRSOgotICAgICAgICAgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsK
LSAgICAgICAgICAgICAgICAgICAgLyogZmFsbHRocm91Z2ggKi8KICAgICAg
ICAgICAgICAgICBjYXNlIC1FUkVTVEFSVDoKICAgICAgICAgICAgICAgICAg
ICAgY3Vyci0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CiAgICAgICAg
ICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGFn
ZTsKKyAgICAgICAgICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAgICAg
ICAgICogRUlOVFIgbWVhbnMgd2Ugc3RpbGwgaG9sZCB0aGUgdHlwZSByZWY7
CisgICAgICAgICAgICAgICAgICAgICAqIEVSRVNUQVJUIG1lYW5zIFBHVF9w
YXJ0aWFsIGhvbGRzIHRoZSByZWYKKyAgICAgICAgICAgICAgICAgICAgICov
CisgICAgICAgICAgICAgICAgICAgIGN1cnItPmFyY2gub2xkX2d1ZXN0X3Rh
YmxlX3BhcnRpYWwgPSAocmMgPT0gLUVSRVNUQVJUKTsKKyAgICAgICAgICAg
ICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CiAgICAgICAgICAgICAgICAgICAg
IGJyZWFrOwogICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAg
ICAgICAgICAgIEJVR19PTihyYyk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9hc20teDg2L2RvbWFpbi5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21h
aW4uaAppbmRleCA3Y2ViZmE0ZmI5Li4yMTIzMDNmMzcxIDEwMDY0NAotLS0g
YS94ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oCisrKyBiL3hlbi9pbmNs
dWRlL2FzbS14ODYvZG9tYWluLmgKQEAgLTMwMiw3ICszMDIsNyBAQCBzdHJ1
Y3QgYXJjaF9kb21haW4KIAogICAgIHN0cnVjdCBwYWdpbmdfZG9tYWluIHBh
Z2luZzsKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtOwotICAgIC8qIFRv
IGVuZm9yY2UgbG9jayBvcmRlcmluZyBpbiB0aGUgcG9kIGNvZGUgd3J0IHRo
ZSAKKyAgICAvKiBUbyBlbmZvcmNlIGxvY2sgb3JkZXJpbmcgaW4gdGhlIHBv
ZCBjb2RlIHdydCB0aGUKICAgICAgKiBwYWdlX2FsbG9jIGxvY2sgKi8KICAg
ICBpbnQgcGFnZV9hbGxvY191bmxvY2tfbGV2ZWw7CiAKQEAgLTU3MSw2ICs1
NzEsOCBAQCBzdHJ1Y3QgYXJjaF92Y3B1CiAgICAgc3RydWN0IHBhZ2VfaW5m
byAqb2xkX2d1ZXN0X3RhYmxlOyAgLyogcGFydGlhbGx5IGRlc3RydWN0ZWQg
cGFnZXRhYmxlICovCiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqb2xkX2d1ZXN0
X3B0cGc7ICAgLyogY29udGFpbmluZyBwYWdlIHRhYmxlIG9mIHRoZSAqLwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGZv
cm1lciwgaWYgYW55ICovCisgICAgYm9vbCBvbGRfZ3Vlc3RfdGFibGVfcGFy
dGlhbDsgICAgICAgLyogQXJlIHdlIGRyb3BwaW5nIGEgdHlwZSByZWYsIG9y
IGp1c3QKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKiBmaW5pc2hpbmcgdXAgYSBwYXJ0aWFsIGRlLXZhbGlkYXRpb24/ICov
CiAgICAgLyogZ3Vlc3RfdGFibGUgaG9sZHMgYSByZWYgdG8gdGhlIHBhZ2Us
IGFuZCBhbHNvIGEgdHlwZS1jb3VudCB1bmxlc3MKICAgICAgKiBzaGFkb3cg
cmVmY291bnRzIGFyZSBpbiB1c2UgKi8KICAgICBwYWdldGFibGVfdCBzaGFk
b3dfdGFibGVbNF07ICAgICAgICAvKiAoTUZOKSBzaGFkb3cocykgb2YgZ3Vl
c3QgKi8KLS0gCjIuMjMuMAoK

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DEBABB2BF7
	for <lists+xen-devel@lfdr.de>; Sat, 14 Sep 2019 17:42:37 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9A7k-0001M8-Qn; Sat, 14 Sep 2019 15:38:08 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=mwje=XJ=invisiblethingslab.com=marmarek@srs-us1.protection.inumbo.net>)
 id 1i9A7j-0001LU-1q
 for xen-devel@lists.xenproject.org; Sat, 14 Sep 2019 15:38:07 +0000
X-Inumbo-ID: 995f9702-d705-11e9-b299-bc764e2007e4
Received: from new1-smtp.messagingengine.com (unknown [66.111.4.221])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 995f9702-d705-11e9-b299-bc764e2007e4;
 Sat, 14 Sep 2019 15:37:46 +0000 (UTC)
Received: from compute7.internal (compute7.nyi.internal [10.202.2.47])
 by mailnew.nyi.internal (Postfix) with ESMTP id DDB98292F;
 Sat, 14 Sep 2019 11:37:45 -0400 (EDT)
Received: from mailfrontend2 ([10.202.2.163])
 by compute7.internal (MEProxy); Sat, 14 Sep 2019 11:37:45 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:in-reply-to:message-id:mime-version:references
 :subject:to:x-me-proxy:x-me-proxy:x-me-sender:x-me-sender
 :x-sasl-enc; s=fm3; bh=XziRV+SUFoq9HrmcsJFUw/GIdKBfs0bngnqPI9cD5
 Tc=; b=Emu6SOM/XDfHsL/371zHPFA8tQE4WpPaqzPnb5JgqIAKshibPwzaUoQFa
 A8WsqjCGwiaTrv7PpcQeUjaem8p5k+OHjSSgDbIs4O8piimJVTPZnlJIX96S1FGP
 j3mufkcFOKqcTT5Mck7tuJ2Y4TELWg2qAa3VGVqyw6gDZwZT0mtRzmN68jV/c2OM
 tkjbq2oGRkNODCCkHlDevHIaqwguHZ3bctUckZehlNLYEsLQhFLVYO1FN+k1qwGu
 b5+Q+HXmfrZFoBW92B3nbT+rMr10YBwsIb7Ry9qnOhFvZhnx6uZPoOrWG1Jg/825
 CRaNW2VotSV2ajIviiCjh+yCImJ8A==
X-ME-Sender: <xms:SQl9XTh5Vm7q0voz-z-i_3o9vFMmsCLbJICPRhTl9bhSm204v2NFZA>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgedufedrtdelgdelfecutefuodetggdotefrodftvf
 curfhrohhfihhlvgemucfhrghsthforghilhdpqfgfvfdpuffrtefokffrpgfnqfghnecu
 uegrihhlohhuthemuceftddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenuc
 fjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeforghrvghk
 ucforghrtgiihihkohifshhkihdqifpkrhgvtghkihcuoehmrghrmhgrrhgvkhesihhnvh
 hishhisghlvghthhhinhhgshhlrggsrdgtohhmqeenucfkphepledurdeihedrfeegrdef
 feenucfrrghrrghmpehmrghilhhfrhhomhepmhgrrhhmrghrvghksehinhhvihhsihgslh
 gvthhhihhnghhslhgrsgdrtghomhenucevlhhushhtvghrufhiiigvpedt
X-ME-Proxy: <xmx:SQl9XQJu6wXS8FYIPPOmUmpApiY4aZKRh-I8oNcCQdXVOMcXnxGJHQ>
 <xmx:SQl9XbCsvp2qpQdr1JqQsGtyKHxcF3DhZBl1JUyxoeHSbIG88eoGcQ>
 <xmx:SQl9XYhnxK7E6_rbXLom35dyQ0HKSvWdSBLgLv7UqbWIZXOaatzDJQ>
 <xmx:SQl9XdfXNWKxV2V-6gOCd6-t97-F-pVZB8XW79Pr0xrkYKRr6-dnTA>
Received: from localhost.localdomain (ip5b412221.dynamic.kabel-deutschland.de
 [91.65.34.33])
 by mail.messagingengine.com (Postfix) with ESMTPA id 2246ED6005F;
 Sat, 14 Sep 2019 11:37:44 -0400 (EDT)
From: =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 14 Sep 2019 17:37:20 +0200
Message-Id: <819398f808613a1109bc06440268b8746e7540d4.1568475323.git-series.marmarek@invisiblethingslab.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.4c97023e719e059ea99137f2cadea319eb87495d.1568475323.git-series.marmarek@invisiblethingslab.com>
References: <cover.4c97023e719e059ea99137f2cadea319eb87495d.1568475323.git-series.marmarek@invisiblethingslab.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v6 5/6] xen/x86: add PHYSDEVOP_interrupt_control
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Daniel De Graaf <dgdegra@tycho.nsa.gov>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWxsb3cgZGV2aWNlIG1vZGVsIHJ1bm5pbmcgaW4gc3R1YmRvbWFpbiB0byBlbmFibGUvZGlzYWJs
ZSBJTlR4L01TSSgtWCksCmJ5cGFzc2luZyBwY2liYWNrLiBXaGlsZSBwY2liYWNrIGlzIHN0aWxs
IHVzZWQgdG8gYWNjZXNzIGNvbmZpZyBzcGFjZQpmcm9tIHdpdGhpbiBzdHViZG9tYWluLCBpdCBy
ZWZ1c2UgdG8gd3JpdGUgdG8KUENJX01TSV9GTEFHU19FTkFCTEUvUENJX01TSVhfRkxBR1NfRU5B
QkxFL1BDSV9DT01NQU5EX0lOVFhfRElTQUJMRQppbiBub24tcGVybWlzc2l2ZSBtb2RlLiBXaGlj
aCBpcyB0aGUgcmlnaHQgdGhpbmcgdG8gZG8gZm9yIFBWIGRvbWFpbgoodGhlIG1haW4gdXNlIGNh
c2UgZm9yIHBjaWJhY2spLCBhcyBQViBkb21haW4gc2hvdWxkIHVzZSBYRU5fUENJX09QXyoKY29t
bWFuZHMgZm9yIHRoYXQuIFVuZm9ydHVuYXRlbHkgdGhvc2UgY29tbWFuZHMgYXJlIG5vdCBnb29k
IGZvcgpzdHViZG9tYWluIHVzZSwgYXMgdGhleSBjb25maWd1cmUgTVNJIGluIGRvbTAncyBrZXJu
ZWwgdG9vLCB3aGljaCBzaG91bGQKbm90IGhhcHBlbiBmb3IgSFZNIGRvbWFpbi4KClRoaXMgbmV3
IHBoeXNkZXZvcCBpcyBhbGxvd2VkIG9ubHkgZm9yIHN0dWJkb21haW4gY29udHJvbGxpbmcgdGhl
IGRvbWFpbgp3aGljaCBvd24gdGhlIGRldmljZS4KClNpZ25lZC1vZmYtYnk6IE1hcmVrIE1hcmN6
eWtvd3NraS1Hw7NyZWNraSA8bWFybWFyZWtAaW52aXNpYmxldGhpbmdzbGFiLmNvbT4KLS0tCkNo
YW5nZXMgaW4gdjM6CiAtIG5ldyBwYXRjaApDaGFuZ2VzIGluIHY0OgogLSBhZGp1c3QgY29kZSBz
dHlsZQogLSBzL21zaV9tc2l4L21zaS8KIC0gYWRkIG1zaV9zZXRfZW5hYmxlIFhTTSBob29rCiAt
IGZsYXR0ZW4gc3RydWN0IHBoeXNkZXZfbXNpX3NldF9lbmFibGUKIC0gYWRkIHRvIGluY2x1ZGUv
eGxhdC5sc3QKQ2hhbmdlcyBpbiB2NToKIC0gcmVuYW1lIHRvIFBIWVNERVZPUF9tc2lfY29udHJv
bAogLSBjb21iaW5lICJtb2RlIiBhbmQgImVuYWJsZSIgaW50byAiZmxhZ3MiCiAtIHJlZnVzZSB0
byBlbmFibGUgYm90aCBNU0kgYW5kIE1TSS1YLCBhbmQgYWxzbyB0byBlbmFibGUgTVNJKC1YKSBv
bgogICBpbmNhcGFibGUgZGV2aWNlCiAtIGRpc2FibGUvZW5hYmxlIElOVHggd2hlbiBlbmFibGlu
Zy9kaXNhYmxpbmcgTVNJICg/KQogLSByZWZ1c2UgaWYgIXVzZV9tc2kKIC0gYWRqdXN0IGZsYXNr
IGhvb2sgdG8gbWFrZSBtb3JlIHNlbnNlIChyZXF1aXJlICJzZXR1cCIgYWNjZXNzIG9uCiAgIGRl
dmljZSwgbm90IG9uIGRvbWFpbikKIC0gcmViYXNlIG9uIG1hc3RlcgpDaGFuZ2VzIGluIHY2Ogog
LSByZW5hbWUgdG8gUEhZU0RFVk9QX2ludGVycnVwdF9jb250cm9sCiAtIGV4dGVuZCB3aXRoIElO
VHggY29udHJvbAogLSBFbnN1cmUgdGhhbiBNU0koLVgpIGNhbid0IGJlIGVuYWJsZWQgdG9nZXRo
ZXIgd2l0aCBJTlR4IGFuZCB0aGUgb3RoZXIgTVNJKC1YKS4KIC0gZGVkdXBsaWNhdGUgY29kZSBp
biBtc2lfY29udHJvbAogLSBleHBsaWNpdGx5IHJlZnVzZSB0byBvcGVyYXRlIG9uIGhpZGRlbiBk
ZXZpY2VzCiAtIGV4cGFuZCBmbGFncyB0byB1aW50MTZfdCB0byBhdm9pZCBpbXBsaWNpdCBwYWRk
aW5nCgpJJ20gbm90IHN1cmUgaWYgWFNNIHBhcnQgaXMgY29ycmVjdCwgY29tcGlsZS10ZXN0ZWQg
b25seSwgYXMgSSdtIG5vdApzdXJlIGhvdyB0byBzZXQgdGhlIHBvbGljeS4KLS0tCiB4ZW4vYXJj
aC94ODYvbXNpLmMgICAgICAgICAgICAgICAgICB8IDQ1ICsrKysrKysrKysrKysrKysrKysrKysr
KystCiB4ZW4vYXJjaC94ODYvcGh5c2Rldi5jICAgICAgICAgICAgICB8IDUzICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKy0KIHhlbi9hcmNoL3g4Ni94ODZfNjQvcGh5c2Rldi5jICAgICAg
IHwgIDQgKystCiB4ZW4vaW5jbHVkZS9hc20teDg2L21zaS5oICAgICAgICAgICB8ICAyICstCiB4
ZW4vaW5jbHVkZS9wdWJsaWMvcGh5c2Rldi5oICAgICAgICB8IDIzICsrKysrKysrKysrKystCiB4
ZW4vaW5jbHVkZS94bGF0LmxzdCAgICAgICAgICAgICAgICB8ICAxICstCiB4ZW4vaW5jbHVkZS94
c20vZHVtbXkuaCAgICAgICAgICAgICB8ICA3ICsrKystCiB4ZW4vaW5jbHVkZS94c20veHNtLmgg
ICAgICAgICAgICAgICB8ICA2ICsrKy0KIHhlbi94c20vZHVtbXkuYyAgICAgICAgICAgICAgICAg
ICAgIHwgIDEgKy0KIHhlbi94c20vZmxhc2svaG9va3MuYyAgICAgICAgICAgICAgIHwgMjQgKysr
KysrKysrKysrKystCiB4ZW4veHNtL2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVjdG9ycyB8ICAxICst
CiAxMSBmaWxlcyBjaGFuZ2VkLCAxNjcgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9tc2kuYyBiL3hlbi9hcmNoL3g4Ni9tc2kuYwppbmRleCBkNjMwNjAwLi5lY2VhOTFh
IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbXNpLmMKKysrIGIveGVuL2FyY2gveDg2L21zaS5j
CkBAIC0xNDQzLDYgKzE0NDMsNTEgQEAgaW50IHBjaV9yZXN0b3JlX21zaV9zdGF0ZShzdHJ1Y3Qg
cGNpX2RldiAqcGRldikKICAgICByZXR1cm4gMDsKIH0KIAoraW50IG1zaV9jb250cm9sKHN0cnVj
dCBwY2lfZGV2ICpwZGV2LCBib29sIG1zaXgsIGJvb2wgZW5hYmxlKQoreworICAgIHVuc2lnbmVk
IGludCBjYXAgPSBtc2l4ID8gUENJX0NBUF9JRF9NU0lYIDogUENJX0NBUF9JRF9NU0k7CisgICAg
dW5zaWduZWQgaW50IG90aGVyX2NhcCA9IG1zaXggPyBQQ0lfQ0FQX0lEX01TSSA6IFBDSV9DQVBf
SURfTVNJWDsKKyAgICB1aW50MTZfdCBjbWQ7CisKKyAgICBpZiAoICF1c2VfbXNpICkKKyAgICAg
ICAgcmV0dXJuIC1FT1BOT1RTVVBQOworCisgICAgaWYgKCAhcGNpX2ZpbmRfY2FwX29mZnNldChw
ZGV2LT5zZWcsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5idXMsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChwZGV2LT5kZXZmbiksCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBQQ0lfRlVOQyhwZGV2LT5kZXZmbiksCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjYXApICkKKyAgICAgICAgcmV0dXJuIC1FTk9ERVY7CisKKyAg
ICBjbWQgPSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQpOworCisgICAg
LyogZG9uJ3QgYWxsb3cgZW5hYmxpbmcgTVNJKC1YKSBhbmQgSU5UeCBhdCB0aGUgc2FtZSB0aW1l
ICovCisgICAgaWYgKCBlbmFibGUgJiYgISAoY21kICYgUENJX0NPTU1BTkRfSU5UWF9ESVNBQkxF
KSApCisgICAgICAgIHJldHVybiAtRUJVU1k7CisKKyAgICAvKiBkb24ndCBhbGxvdyBlbmFibGlu
ZyBib3RoIE1TSSBhbmQgTVNJLVggYXQgdGhlIHNhbWUgdGltZSAqLworICAgIGlmICggZW5hYmxl
ICYmIGZpbmRfbXNpX2VudHJ5KHBkZXYsIC0xLCBvdGhlcl9jYXApICkKKyAgICAgICAgcmV0dXJu
IC1FQlVTWTsKKworICAgIGlmICggbXNpeCApCisgICAgICAgIG1zaXhfc2V0X2VuYWJsZShwZGV2
LCBlbmFibGUpOworICAgIGVsc2UKKyAgICAgICAgbXNpX3NldF9lbmFibGUocGRldiwgZW5hYmxl
KTsKKworICAgIHJldHVybiAwOworfQorCitpbnQgaW50eF9jb250cm9sKHN0cnVjdCBwY2lfZGV2
ICpwZGV2LCBib29sIGVuYWJsZSkKK3sKKyAgICAvKiBkb24ndCBhbGxvdyBlbmFibGluZyBJTlR4
IGlmIE1TSSgtWCkgaXMgYWxyZWFkeSBlbmFibGVkICovCisgICAgaWYgKCBlbmFibGUgJiYgZmlu
ZF9tc2lfZW50cnkocGRldiwgLTEsIFBDSV9DQVBfSURfTVNJKSApCisgICAgICAgIHJldHVybiAt
RUJVU1k7CisgICAgaWYgKCBlbmFibGUgJiYgZmluZF9tc2lfZW50cnkocGRldiwgLTEsIFBDSV9D
QVBfSURfTVNJWCkgKQorICAgICAgICByZXR1cm4gLUVCVVNZOworICAgIHBjaV9pbnR4KHBkZXYs
IGVuYWJsZSk7CisgICAgcmV0dXJuIDA7Cit9CisKIHZvaWQgX19pbml0IGVhcmx5X21zaV9pbml0
KHZvaWQpCiB7CiAgICAgaWYgKCB1c2VfbXNpIDwgMCApCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94
ODYvcGh5c2Rldi5jIGIveGVuL2FyY2gveDg2L3BoeXNkZXYuYwppbmRleCAzYTNjMTU4Li43Yjcx
MDM5IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvcGh5c2Rldi5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9waHlzZGV2LmMKQEAgLTY2Miw2ICs2NjIsNTkgQEAgcmV0X3QgZG9fcGh5c2Rldl9vcChpbnQg
Y21kLCBYRU5fR1VFU1RfSEFORExFX1BBUkFNKHZvaWQpIGFyZykKICAgICAgICAgYnJlYWs7CiAg
ICAgfQogCisgICAgY2FzZSBQSFlTREVWT1BfaW50ZXJydXB0X2NvbnRyb2w6IHsKKyAgICAgICAg
c3RydWN0IHBoeXNkZXZfaW50ZXJydXB0X2NvbnRyb2wgb3A7CisgICAgICAgIHN0cnVjdCBwY2lf
ZGV2ICpwZGV2OworICAgICAgICBpbnQgaW50cl90eXBlOworICAgICAgICBib29sIGVuYWJsZTsK
KworICAgICAgICByZXQgPSAtRUZBVUxUOworICAgICAgICBpZiAoIGNvcHlfZnJvbV9ndWVzdCgm
b3AsIGFyZywgMSkgKQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAgcmV0ID0gLUVJTlZB
TDsKKyAgICAgICAgaWYgKCBvcC5mbGFncyAmIH4oUEhZU0RFVk9QX0lOVEVSUlVQVF9DT05UUk9M
X1RZUEVfTUFTSyB8CisgICAgICAgICAgICAgICAgICAgICAgICAgIFBIWVNERVZPUF9JTlRFUlJV
UFRfQ09OVFJPTF9FTkFCTEUpICkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgIGludHJf
dHlwZSA9IG9wLmZsYWdzICYgUEhZU0RFVk9QX0lOVEVSUlVQVF9DT05UUk9MX1RZUEVfTUFTSzsK
KyAgICAgICAgZW5hYmxlID0gb3AuZmxhZ3MgJiBQSFlTREVWT1BfSU5URVJSVVBUX0NPTlRST0xf
RU5BQkxFOworCisgICAgICAgIHBjaWRldnNfbG9jaygpOworICAgICAgICBwZGV2ID0gcGNpX2dl
dF9wZGV2KG9wLnNlZywgb3AuYnVzLCBvcC5kZXZmbik7CisgICAgICAgIHJldCA9IC1FTk9ERVY7
CisgICAgICAgIC8qIGV4cGxpY2l0bHkgZXhjbHVkZSBoaWRkZW4gZGV2aWNlcyAqLworICAgICAg
ICBpZiAoICFwZGV2IHx8IHBkZXYtPmRvbWFpbiA9PSBkb21feGVuICkKKyAgICAgICAgICAgIGdv
dG8gcGNpX3VubG9jazsKKworICAgICAgICByZXQgPSB4c21faW50ZXJydXB0X2NvbnRyb2woWFNN
X0RNX1BSSVYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5kb21h
aW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5zYmRmLnNiZGYs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRyX3R5cGUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGUpOworICAgICAgICBpZiAoIHJldCAp
CisgICAgICAgICAgICBnb3RvIHBjaV91bmxvY2s7CisKKyAgICAgICAgc3dpdGNoICggaW50cl90
eXBlICkKKyAgICAgICAgeworICAgICAgICAgICAgY2FzZSBQSFlTREVWT1BfSU5URVJSVVBUX0NP
TlRST0xfSU5UWDoKKyAgICAgICAgICAgICAgICByZXQgPSBpbnR4X2NvbnRyb2wocGRldiwgZW5h
YmxlKTsKKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIGNhc2UgUEhZU0RFVk9Q
X0lOVEVSUlVQVF9DT05UUk9MX01TSToKKyAgICAgICAgICAgICAgICByZXQgPSBtc2lfY29udHJv
bChwZGV2LCBmYWxzZSwgZW5hYmxlKTsKKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAg
ICAgIGNhc2UgUEhZU0RFVk9QX0lOVEVSUlVQVF9DT05UUk9MX01TSVg6CisgICAgICAgICAgICAg
ICAgcmV0ID0gbXNpX2NvbnRyb2wocGRldiwgdHJ1ZSwgZW5hYmxlKTsKKyAgICAgICAgICAgICAg
ICBicmVhazsKKyAgICAgICAgICAgIGRlZmF1bHQ6CisgICAgICAgICAgICAgICAgcmV0ID0gLUVJ
TlZBTDsKKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorcGNpX3VubG9jazoKKyAg
ICAgICAgcGNpZGV2c191bmxvY2soKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCiAgICAgZGVm
YXVsdDoKICAgICAgICAgcmV0ID0gLUVOT1NZUzsKICAgICAgICAgYnJlYWs7CmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYveDg2XzY0L3BoeXNkZXYuYyBiL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGh5
c2Rldi5jCmluZGV4IGM1YTAwZWEuLjZlMGU0ODggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni94
ODZfNjQvcGh5c2Rldi5jCisrKyBiL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGh5c2Rldi5jCkBAIC03
Niw2ICs3NiwxMCBAQCBDSEVDS19waHlzZGV2X3BjaV9kZXZpY2VfYWRkCiBDSEVDS19waHlzZGV2
X3BjaV9kZXZpY2UKICN1bmRlZiB4ZW5fcGh5c2Rldl9wY2lfZGV2aWNlCiAKKyNkZWZpbmUgeGVu
X3BoeXNkZXZfaW50ZXJydXB0X2NvbnRyb2wgcGh5c2Rldl9pbnRlcnJ1cHRfY29udHJvbAorQ0hF
Q0tfcGh5c2Rldl9pbnRlcnJ1cHRfY29udHJvbAorI3VuZGVmIHhlbl9waHlzZGV2X2ludGVycnVw
dF9jb250cm9sCisKICNkZWZpbmUgQ09NUEFUCiAjdW5kZWYgZ3Vlc3RfaGFuZGxlX29rYXkKICNk
ZWZpbmUgZ3Vlc3RfaGFuZGxlX29rYXkgICAgICAgICAgY29tcGF0X2hhbmRsZV9va2F5CmRpZmYg
LS1naXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L21zaS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9t
c2kuaAppbmRleCAxMDM4N2RjLi40YzEzZTZiIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20t
eDg2L21zaS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNpLmgKQEAgLTI1Miw1ICsyNTIs
NyBAQCB2b2lkIGd1ZXN0X21hc2tfbXNpX2lycShzdHJ1Y3QgaXJxX2Rlc2MgKiwgYm9vbCBtYXNr
KTsKIHZvaWQgYWNrX25vbm1hc2thYmxlX21zaV9pcnEoc3RydWN0IGlycV9kZXNjICopOwogdm9p
ZCBlbmRfbm9ubWFza2FibGVfbXNpX2lycShzdHJ1Y3QgaXJxX2Rlc2MgKiwgdTggdmVjdG9yKTsK
IHZvaWQgc2V0X21zaV9hZmZpbml0eShzdHJ1Y3QgaXJxX2Rlc2MgKiwgY29uc3QgY3B1bWFza190
ICopOworaW50IG1zaV9jb250cm9sKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBib29sIG1zaXgsIGJv
b2wgZW5hYmxlKTsKK2ludCBpbnR4X2NvbnRyb2woc3RydWN0IHBjaV9kZXYgKnBkZXYsIGJvb2wg
ZW5hYmxlKTsKIAogI2VuZGlmIC8qIF9fQVNNX01TSV9IICovCmRpZmYgLS1naXQgYS94ZW4vaW5j
bHVkZS9wdWJsaWMvcGh5c2Rldi5oIGIveGVuL2luY2x1ZGUvcHVibGljL3BoeXNkZXYuaAppbmRl
eCBiNmZhZjgzLi42ODljMTFlIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvcGh5c2Rl
di5oCisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9waHlzZGV2LmgKQEAgLTM0NSw2ICszNDUsMjkg
QEAgdHlwZWRlZiBzdHJ1Y3QgcGh5c2Rldl9kYmdwX29wIHBoeXNkZXZfZGJncF9vcF90OwogREVG
SU5FX1hFTl9HVUVTVF9IQU5ETEUocGh5c2Rldl9kYmdwX29wX3QpOwogCiAvKgorICogQ2hvb3Nl
IHdoaWNoIGludGVycnVwdCB0eXBlIHRvIGNvbnRyb2wuIElmIG5laXRoZXIgTVNJIG5vciBNU0kt
WCBpcyBjaG9zZW4sCisgKiB3aWxsIGFwcGx5IHRvIElOVHggLSBmb3IgY29udmVuaWVuY2UgZGVm
aW5lIFBIWVNERVZPUF9JTlRFUlJVUFRfQ09OVFJPTF9JTlRYCisgKiBhbmQgUEhZU0RFVk9QX0lO
VEVSUlVQVF9DT05UUk9MX1RZUEVfTUFTSworICovCisjZGVmaW5lIFBIWVNERVZPUF9JTlRFUlJV
UFRfQ09OVFJPTF9UWVBFX01BU0sgMworI2RlZmluZSBQSFlTREVWT1BfSU5URVJSVVBUX0NPTlRS
T0xfSU5UWCAgICAgIDAKKyNkZWZpbmUgUEhZU0RFVk9QX0lOVEVSUlVQVF9DT05UUk9MX01TSSAg
ICAgICAxCisjZGVmaW5lIFBIWVNERVZPUF9JTlRFUlJVUFRfQ09OVFJPTF9NU0lYICAgICAgMgor
Lyogd2hlbiBQSFlTREVWT1BfSU5URVJSVVBUX0NPTlRST0xfRU5BQkxFIG5vdCBzZXQsIGRpc2Fi
bGUgKi8KKyNkZWZpbmUgUEhZU0RFVk9QX0lOVEVSUlVQVF9DT05UUk9MX0VOQUJMRSAgICA0CisK
KyNkZWZpbmUgUEhZU0RFVk9QX2ludGVycnVwdF9jb250cm9sICAgMzIKK3N0cnVjdCBwaHlzZGV2
X2ludGVycnVwdF9jb250cm9sIHsKKyAgICAvKiBJTiAqLworICAgIHVpbnQxNl90IHNlZzsKKyAg
ICB1aW50OF90IGJ1czsKKyAgICB1aW50OF90IGRldmZuOworICAgIHVpbnQxNl90IGZsYWdzOwor
fTsKK3R5cGVkZWYgc3RydWN0IHBoeXNkZXZfaW50ZXJydXB0X2NvbnRyb2wgcGh5c2Rldl9pbnRl
cnJ1cHRfY29udHJvbF90OworREVGSU5FX1hFTl9HVUVTVF9IQU5ETEUocGh5c2Rldl9pbnRlcnJ1
cHRfY29udHJvbF90KTsKKworLyoKICAqIE5vdGlmeSB0aGF0IHNvbWUgUElSUS1ib3VuZCBldmVu
dCBjaGFubmVscyBoYXZlIGJlZW4gdW5tYXNrZWQuCiAgKiAqKiBUaGlzIGNvbW1hbmQgaXMgb2Jz
b2xldGUgc2luY2UgaW50ZXJmYWNlIHZlcnNpb24gMHgwMDAzMDIwMiBhbmQgaXMgKioKICAqICoq
IHVuc3VwcG9ydGVkIGJ5IG5ld2VyIHZlcnNpb25zIG9mIFhlbi4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAqKgpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGxhdC5sc3QgYi94ZW4vaW5j
bHVkZS94bGF0LmxzdAppbmRleCA5NWY1ZTU1Li4xOGFmNjYzIDEwMDY0NAotLS0gYS94ZW4vaW5j
bHVkZS94bGF0LmxzdAorKysgYi94ZW4vaW5jbHVkZS94bGF0LmxzdApAQCAtMTA0LDYgKzEwNCw3
IEBACiAhCXZudW1hX3RvcG9sb2d5X2luZm8JCW1lbW9yeS5oCiA/CXBoeXNkZXZfZW9pCQkJcGh5
c2Rldi5oCiA/CXBoeXNkZXZfZ2V0X2ZyZWVfcGlycQkJcGh5c2Rldi5oCis/CXBoeXNkZXZfaW50
ZXJydXB0X2NvbnRyb2wJcGh5c2Rldi5oCiA/CXBoeXNkZXZfaXJxCQkJcGh5c2Rldi5oCiA/CXBo
eXNkZXZfaXJxX3N0YXR1c19xdWVyeQlwaHlzZGV2LmgKID8JcGh5c2Rldl9tYW5hZ2VfcGNpCQlw
aHlzZGV2LmgKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hzbS9kdW1teS5oIGIveGVuL2luY2x1
ZGUveHNtL2R1bW15LmgKaW5kZXggZWY1MmJiMS4uNWE3NThjNSAxMDA2NDQKLS0tIGEveGVuL2lu
Y2x1ZGUveHNtL2R1bW15LmgKKysrIGIveGVuL2luY2x1ZGUveHNtL2R1bW15LmgKQEAgLTUxNCw2
ICs1MTQsMTMgQEAgc3RhdGljIFhTTV9JTkxJTkUgaW50IHhzbV9wY2lfY29uZmlnX3Blcm1pc3Np
b24oWFNNX0RFRkFVTFRfQVJHIHN0cnVjdCBkb21haW4gKmQKICAgICByZXR1cm4geHNtX2RlZmF1
bHRfYWN0aW9uKGFjdGlvbiwgY3VycmVudC0+ZG9tYWluLCBkKTsKIH0KIAorc3RhdGljIFhTTV9J
TkxJTkUgaW50IHhzbV9pbnRlcnJ1cHRfY29udHJvbChYU01fREVGQVVMVF9BUkcgc3RydWN0IGRv
bWFpbiAqZCwgdWludDMyX3QgbWFjaGluZV9iZGYsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgaW50cl90eXBlLCB1aW50OF90IGVuYWJsZSkKK3sK
KyAgICBYU01fQVNTRVJUX0FDVElPTihYU01fRE1fUFJJVik7CisgICAgcmV0dXJuIHhzbV9kZWZh
dWx0X2FjdGlvbihhY3Rpb24sIGN1cnJlbnQtPmRvbWFpbiwgZCk7Cit9CisKIHN0YXRpYyBYU01f
SU5MSU5FIGludCB4c21fYWRkX3RvX3BoeXNtYXAoWFNNX0RFRkFVTFRfQVJHIHN0cnVjdCBkb21h
aW4gKmQxLCBzdHJ1Y3QgZG9tYWluICpkMikKIHsKICAgICBYU01fQVNTRVJUX0FDVElPTihYU01f
VEFSR0VUKTsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hzbS94c20uaCBiL3hlbi9pbmNsdWRl
L3hzbS94c20uaAppbmRleCBlMjJkNjE2Li5mMDgwMTg5IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVk
ZS94c20veHNtLmgKKysrIGIveGVuL2luY2x1ZGUveHNtL3hzbS5oCkBAIC0xMDYsNiArMTA2LDcg
QEAgc3RydWN0IHhzbV9vcGVyYXRpb25zIHsKICAgICBpbnQgKCppb21lbV9wZXJtaXNzaW9uKSAo
c3RydWN0IGRvbWFpbiAqZCwgdWludDY0X3QgcywgdWludDY0X3QgZSwgdWludDhfdCBhbGxvdyk7
CiAgICAgaW50ICgqaW9tZW1fbWFwcGluZykgKHN0cnVjdCBkb21haW4gKmQsIHVpbnQ2NF90IHMs
IHVpbnQ2NF90IGUsIHVpbnQ4X3QgYWxsb3cpOwogICAgIGludCAoKnBjaV9jb25maWdfcGVybWlz
c2lvbikgKHN0cnVjdCBkb21haW4gKmQsIHVpbnQzMl90IG1hY2hpbmVfYmRmLCB1aW50MTZfdCBz
dGFydCwgdWludDE2X3QgZW5kLCB1aW50OF90IGFjY2Vzcyk7CisgICAgaW50ICgqaW50ZXJydXB0
X2NvbnRyb2wpIChzdHJ1Y3QgZG9tYWluICpkLCB1aW50MzJfdCBtYWNoaW5lX2JkZiwgdWludDhf
dCBpbnRyX3R5cGUsIHVpbnQ4X3QgZW5hYmxlKTsKIAogI2lmIGRlZmluZWQoQ09ORklHX0hBU19Q
QVNTVEhST1VHSCkgJiYgZGVmaW5lZChDT05GSUdfSEFTX1BDSSkKICAgICBpbnQgKCpnZXRfZGV2
aWNlX2dyb3VwKSAodWludDMyX3QgbWFjaGluZV9iZGYpOwpAQCAtNDY0LDYgKzQ2NSwxMSBAQCBz
dGF0aWMgaW5saW5lIGludCB4c21fcGNpX2NvbmZpZ19wZXJtaXNzaW9uICh4c21fZGVmYXVsdF90
IGRlZiwgc3RydWN0IGRvbWFpbiAqZAogICAgIHJldHVybiB4c21fb3BzLT5wY2lfY29uZmlnX3Bl
cm1pc3Npb24oZCwgbWFjaGluZV9iZGYsIHN0YXJ0LCBlbmQsIGFjY2Vzcyk7CiB9CiAKK3N0YXRp
YyBpbmxpbmUgaW50IHhzbV9pbnRlcnJ1cHRfY29udHJvbCAoeHNtX2RlZmF1bHRfdCBkZWYsIHN0
cnVjdCBkb21haW4gKmQsIHVpbnQzMl90IG1hY2hpbmVfYmRmLCB1aW50OF90IG1zaXgsIHVpbnQ4
X3QgZW5hYmxlKQoreworICAgIHJldHVybiB4c21fb3BzLT5pbnRlcnJ1cHRfY29udHJvbChkLCBt
YWNoaW5lX2JkZiwgbXNpeCwgZW5hYmxlKTsKK30KKwogI2lmIGRlZmluZWQoQ09ORklHX0hBU19Q
QVNTVEhST1VHSCkgJiYgZGVmaW5lZChDT05GSUdfSEFTX1BDSSkKIHN0YXRpYyBpbmxpbmUgaW50
IHhzbV9nZXRfZGV2aWNlX2dyb3VwKHhzbV9kZWZhdWx0X3QgZGVmLCB1aW50MzJfdCBtYWNoaW5l
X2JkZikKIHsKZGlmZiAtLWdpdCBhL3hlbi94c20vZHVtbXkuYyBiL3hlbi94c20vZHVtbXkuYwpp
bmRleCA1NzA1ZTUyLi4zMDgwYWU3IDEwMDY0NAotLS0gYS94ZW4veHNtL2R1bW15LmMKKysrIGIv
eGVuL3hzbS9kdW1teS5jCkBAIC04MSw2ICs4MSw3IEBAIHZvaWQgX19pbml0IHhzbV9maXh1cF9v
cHMgKHN0cnVjdCB4c21fb3BlcmF0aW9ucyAqb3BzKQogICAgIHNldF90b19kdW1teV9pZl9udWxs
KG9wcywgaW9tZW1fcGVybWlzc2lvbik7CiAgICAgc2V0X3RvX2R1bW15X2lmX251bGwob3BzLCBp
b21lbV9tYXBwaW5nKTsKICAgICBzZXRfdG9fZHVtbXlfaWZfbnVsbChvcHMsIHBjaV9jb25maWdf
cGVybWlzc2lvbik7CisgICAgc2V0X3RvX2R1bW15X2lmX251bGwob3BzLCBpbnRlcnJ1cHRfY29u
dHJvbCk7CiAgICAgc2V0X3RvX2R1bW15X2lmX251bGwob3BzLCBnZXRfdm51bWFpbmZvKTsKIAog
I2lmIGRlZmluZWQoQ09ORklHX0hBU19QQVNTVEhST1VHSCkgJiYgZGVmaW5lZChDT05GSUdfSEFT
X1BDSSkKZGlmZiAtLWdpdCBhL3hlbi94c20vZmxhc2svaG9va3MuYyBiL3hlbi94c20vZmxhc2sv
aG9va3MuYwppbmRleCA3OTFjMWY2Li5lZTJmYzUyIDEwMDY0NAotLS0gYS94ZW4veHNtL2ZsYXNr
L2hvb2tzLmMKKysrIGIveGVuL3hzbS9mbGFzay9ob29rcy5jCkBAIC0xMDgzLDYgKzEwODMsMjkg
QEAgc3RhdGljIGludCBmbGFza19wY2lfY29uZmlnX3Blcm1pc3Npb24oc3RydWN0IGRvbWFpbiAq
ZCwgdWludDMyX3QgbWFjaGluZV9iZGYsIHUKIAogfQogCitzdGF0aWMgaW50IGZsYXNrX2ludGVy
cnVwdF9jb250cm9sKHN0cnVjdCBkb21haW4gKmQsIHVpbnQzMl90IG1hY2hpbmVfYmRmLCB1aW50
OF90IHR5cGUsIHVpbnQ4X3QgZW5hYmxlKQoreworICAgIHVpbnQzMl90IGRzaWQsIHJzaWQ7Cisg
ICAgaW50IHJjID0gLUVQRVJNOworICAgIHN0cnVjdCBhdmNfYXVkaXRfZGF0YSBhZDsKKyAgICB1
aW50MzJfdCBwZXJtOworCisgICAgQVZDX0FVRElUX0RBVEFfSU5JVCgmYWQsIERFVik7CisgICAg
YWQuZGV2aWNlID0gbWFjaGluZV9iZGY7CisKKyAgICByYyA9IHNlY3VyaXR5X2RldmljZV9zaWQo
bWFjaGluZV9iZGYsICZyc2lkKTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgcmV0dXJuIHJjOwor
CisgICAgcmMgPSBhdmNfY3VycmVudF9oYXNfcGVybShyc2lkLCBTRUNDTEFTU19SRVNPVVJDRSwg
UkVTT1VSQ0VfX1NFVFVQLCAmYWQpOworICAgIGlmICggcmMgKQorICAgICAgICByZXR1cm4gcmM7
CisKKyAgICBwZXJtID0gZmxhc2tfaW9tbXVfcmVzb3VyY2VfdXNlX3Blcm0oKTsKKyAgICBkc2lk
ID0gZG9tYWluX3NpZChkKTsKKyAgICByZXR1cm4gYXZjX2hhc19wZXJtKGRzaWQsIHJzaWQsIFNF
Q0NMQVNTX1JFU09VUkNFLCBwZXJtLCAmYWQpOworfQorCiBzdGF0aWMgaW50IGZsYXNrX3Jlc291
cmNlX3BsdWdfY29yZSh2b2lkKQogewogICAgIHJldHVybiBhdmNfY3VycmVudF9oYXNfcGVybShT
RUNJTklUU0lEX0RPTVhFTiwgU0VDQ0xBU1NfUkVTT1VSQ0UsIFJFU09VUkNFX19QTFVHLCBOVUxM
KTsKQEAgLTE4MDAsNiArMTgyMyw3IEBAIHN0YXRpYyBzdHJ1Y3QgeHNtX29wZXJhdGlvbnMgZmxh
c2tfb3BzID0gewogICAgIC5pb21lbV9wZXJtaXNzaW9uID0gZmxhc2tfaW9tZW1fcGVybWlzc2lv
biwKICAgICAuaW9tZW1fbWFwcGluZyA9IGZsYXNrX2lvbWVtX21hcHBpbmcsCiAgICAgLnBjaV9j
b25maWdfcGVybWlzc2lvbiA9IGZsYXNrX3BjaV9jb25maWdfcGVybWlzc2lvbiwKKyAgICAuaW50
ZXJydXB0X2NvbnRyb2wgPSBmbGFza19pbnRlcnJ1cHRfY29udHJvbCwKIAogICAgIC5yZXNvdXJj
ZV9wbHVnX2NvcmUgPSBmbGFza19yZXNvdXJjZV9wbHVnX2NvcmUsCiAgICAgLnJlc291cmNlX3Vu
cGx1Z19jb3JlID0gZmxhc2tfcmVzb3VyY2VfdW5wbHVnX2NvcmUsCmRpZmYgLS1naXQgYS94ZW4v
eHNtL2ZsYXNrL3BvbGljeS9hY2Nlc3NfdmVjdG9ycyBiL3hlbi94c20vZmxhc2svcG9saWN5L2Fj
Y2Vzc192ZWN0b3JzCmluZGV4IDE5NGQ3NDMuLjgyZWFlYWMgMTAwNjQ0Ci0tLSBhL3hlbi94c20v
Zmxhc2svcG9saWN5L2FjY2Vzc192ZWN0b3JzCisrKyBiL3hlbi94c20vZmxhc2svcG9saWN5L2Fj
Y2Vzc192ZWN0b3JzCkBAIC00NjYsNiArNDY2LDcgQEAgY2xhc3MgcmVzb3VyY2UKICMgY2hlY2tl
ZCBmb3IgUEhZU0RFVk9QX3Jlc3RvcmVfbXNpKiAodGFyZ2V0IFBDSSBkZXZpY2UpCiAjIGNoZWNr
ZWQgZm9yIFBIWVNERVZPUF9zZXR1cF9nc2kgKHRhcmdldCBJUlEpCiAjIGNoZWNrZWQgZm9yIFBI
WVNERVZPUF9wY2lfbW1jZmdfcmVzZXJ2ZWQgKHRhcmdldCB4ZW5fdCkKKyMgY2hlY2tlZCBmb3Ig
UEhZU0RFVk9QX2ludGVycnVwdF9jb250cm9sICh0YXJnZXQgUENJIGRldmljZSkKICAgICBzZXR1
cAogfQogCi0tIApnaXQtc2VyaWVzIDAuOS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0
cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlz
dGluZm8veGVuLWRldmVs

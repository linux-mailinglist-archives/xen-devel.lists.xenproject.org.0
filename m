Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B4EE4BFBAD
	for <lists+xen-devel@lfdr.de>; Fri, 27 Sep 2019 01:14:39 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDcvO-0004fh-Tm; Thu, 26 Sep 2019 23:11:50 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=9/1y=XV=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1iDcvN-0004fS-DM
 for xen-devel@lists.xen.org; Thu, 26 Sep 2019 23:11:49 +0000
X-Inumbo-ID: 0418afbe-e0b3-11e9-97fb-bc764e2007e4
Received: from mail.kernel.org (unknown [198.145.29.99])
 by localhost (Halon) with ESMTPS
 id 0418afbe-e0b3-11e9-97fb-bc764e2007e4;
 Thu, 26 Sep 2019 23:11:48 +0000 (UTC)
Received: from localhost.localdomain (c-67-164-102-47.hsd1.ca.comcast.net
 [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id B8632206B7;
 Thu, 26 Sep 2019 23:11:47 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1569539508;
 bh=FM7i9CGuluygHwOsySBQ4ci8WCM0RGKONrHUebiP7TI=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=C5hypATe/5A6yri2xEvDuHxjQJrQ0hM7sjqw1jmF+P/vgOGq8eIWuH7ZDnAr8Gd0I
 uZ+HqeOfxtA2bZN91eBOlkNhU8zlvCB7fAcHYLi5BEqmITUMGyh+iSsYb46uKXuPjZ
 H/d5f5IrT6knB8m/6XuZRdNJ8hViyDfzmbrbQ9jI=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Thu, 26 Sep 2019 16:11:37 -0700
Message-Id: <20190926231144.16297-1-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1909261608430.2594@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1909261608430.2594@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v6 1/8] xen/arm: introduce
 handle_device_interrupts
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TW92ZSB0aGUgaW50ZXJydXB0IGhhbmRsaW5nIGNvZGUgb3V0IG9mIGhhbmRsZV9kZXZpY2UgdG8g
YSBuZXcgZnVuY3Rpb24Kc28gdGhhdCBpdCBjYW4gYmUgcmV1c2VkIGZvciBkb20wbGVzcyBWTXMg
KGl0IHdpbGwgYmUgdXNlZCBpbiBsYXRlcgpwYXRjaGVzKS4KClNpZ25lZC1vZmYtYnk6IFN0ZWZh
bm8gU3RhYmVsbGluaSA8c3RlZmFub3NAeGlsaW54LmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFs
bCA8anVsaWVuLmdyYWxsQGFybS5jb20+Ci0tLQpDaGFuZ2VzIGluIHY0OgotIHJlbmFtZSBoYW5k
bGVfaW50ZXJydXB0cyB0byBoYW5kbGVfZGV2aWNlX2ludGVycnVwdHMKLSBpbXByb3ZlIGluLWNv
ZGUgY29tbWVudAotIHJlbW92ZSByZXR1cm4gMSBpZiBtYXBwaW5nIGlzIGRvbmUKLSB1c2UgdW5z
aWduZWQKCkNoYW5nZXMgaW4gdjM6Ci0gYWRkIHBhdGNoCgpUaGUgZGlmZiBpcyBoYXJkIHRvIHJl
YWQgYnV0IEkganVzdCBtb3ZlZCB0aGUgaW50ZXJydXB0cyByZWxhdGVkIGNvZGUKZnJvbSBoYW5k
bGVfZGV2aWNlcyB0byBhIG5ldyBmdW5jdGlvbiBoYW5kbGVfZGV2aWNlX2ludGVycnVwdHMsIGFu
ZCB2ZXJ5CmxpdHRsZSBlbHNlLgotLS0KIHhlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyB8IDgw
ICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA1
MSBpbnNlcnRpb25zKCspLCAyOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9h
cm0vZG9tYWluX2J1aWxkLmMgYi94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKaW5kZXggYTBm
ZWUxZWYxMy4uMjE5ODU2MjhmMCAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL2RvbWFpbl9idWls
ZC5jCisrKyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYwpAQCAtMTIzOSw0MSArMTIzOSwy
MiBAQCBzdGF0aWMgaW50IF9faW5pdCBtYXBfZGV2aWNlX2NoaWxkcmVuKHN0cnVjdCBkb21haW4g
KmQsCiB9CiAKIC8qCi0gKiBGb3IgYSBnaXZlbiBkZXZpY2Ugbm9kZToKLSAqICAtIEdpdmUgcGVy
bWlzc2lvbiB0byB0aGUgZ3Vlc3QgdG8gbWFuYWdlIElSUSBhbmQgTU1JTyByYW5nZQotICogIC0g
UmV0cmlldmUgdGhlIElSUSBjb25maWd1cmF0aW9uIChpLmUgZWRnZS9sZXZlbCkgZnJvbSBkZXZp
Y2UgdHJlZQotICogV2hlbiB0aGUgZGV2aWNlIGlzIG5vdCBtYXJrZWQgZm9yIGd1ZXN0IHBhc3N0
aHJvdWdoOgotICogIC0gQXNzaWduIHRoZSBkZXZpY2UgdG8gdGhlIGd1ZXN0IGlmIGl0J3MgcHJv
dGVjdGVkIGJ5IGFuIElPTU1VCi0gKiAgLSBNYXAgdGhlIElSUXMgYW5kIGlvbWVtIHJlZ2lvbnMg
dG8gRE9NMAorICogaGFuZGxlX2RldmljZV9pbnRlcnJ1cHRzIHJldHJpZXZlcyB0aGUgaW50ZXJy
dXB0cyBjb25maWd1cmF0aW9uIGZyb20KKyAqIGEgZGV2aWNlIHRyZWUgbm9kZSBhbmQgbWFwcyB0
aG9zZSBpbnRlcnJ1cHRzIHRvIHRoZSB0YXJnZXQgZG9tYWluLgorICoKKyAqIFJldHVybnM6Cisg
KiAgIDwgMCBlcnJvcgorICogICAwICAgc3VjY2VzcwogICovCi1zdGF0aWMgaW50IF9faW5pdCBo
YW5kbGVfZGV2aWNlKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqZGV2
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1fdHlwZV90IHAybXQpCitzdGF0
aWMgaW50IF9faW5pdCBoYW5kbGVfZGV2aWNlX2ludGVycnVwdHMoc3RydWN0IGRvbWFpbiAqZCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZHRfZGV2
aWNlX25vZGUgKmRldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBib29sIG5lZWRfbWFwcGluZykKIHsKLSAgICB1bnNpZ25lZCBpbnQgbmlycTsKLSAgICB1bnNp
Z25lZCBpbnQgbmFkZHI7Ci0gICAgdW5zaWduZWQgaW50IGk7CisgICAgdW5zaWduZWQgaW50IGks
IG5pcnE7CiAgICAgaW50IHJlczsKICAgICBzdHJ1Y3QgZHRfcmF3X2lycSByaXJxOwotICAgIHU2
NCBhZGRyLCBzaXplOwotICAgIGJvb2wgbmVlZF9tYXBwaW5nID0gIWR0X2RldmljZV9mb3JfcGFz
c3Rocm91Z2goZGV2KTsKIAogICAgIG5pcnEgPSBkdF9udW1iZXJfb2ZfaXJxKGRldik7Ci0gICAg
bmFkZHIgPSBkdF9udW1iZXJfb2ZfYWRkcmVzcyhkZXYpOwotCi0gICAgZHRfZHByaW50aygiJXMg
cGFzc3Rocm91Z2ggPSAlZCBuaXJxID0gJWQgbmFkZHIgPSAldVxuIiwKLSAgICAgICAgICAgICAg
IGR0X25vZGVfZnVsbF9uYW1lKGRldiksIG5lZWRfbWFwcGluZywgbmlycSwgbmFkZHIpOwotCi0g
ICAgaWYgKCBkdF9kZXZpY2VfaXNfcHJvdGVjdGVkKGRldikgJiYgbmVlZF9tYXBwaW5nICkKLSAg
ICB7Ci0gICAgICAgIGR0X2RwcmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1bGxf
bmFtZShkZXYpKTsKLSAgICAgICAgcmVzID0gaW9tbXVfYXNzaWduX2R0X2RldmljZShkLCBkZXYp
OwotICAgICAgICBpZiAoIHJlcyApCi0gICAgICAgIHsKLSAgICAgICAgICAgIHByaW50ayhYRU5M
T0dfRVJSICJGYWlsZWQgdG8gc2V0dXAgdGhlIElPTU1VIGZvciAlc1xuIiwKLSAgICAgICAgICAg
ICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKLSAgICAgICAgICAgIHJldHVybiByZXM7
Ci0gICAgICAgIH0KLSAgICB9CiAKICAgICAvKiBHaXZlIHBlcm1pc3Npb24gYW5kIG1hcCBJUlFz
ICovCiAgICAgZm9yICggaSA9IDA7IGkgPCBuaXJxOyBpKysgKQpAQCAtMTMxMCw2ICsxMjkxLDQ3
IEBAIHN0YXRpYyBpbnQgX19pbml0IGhhbmRsZV9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3Ry
dWN0IGR0X2RldmljZV9ub2RlICpkZXYsCiAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgIH0K
IAorICAgIHJldHVybiAwOworfQorCisvKgorICogRm9yIGEgZ2l2ZW4gZGV2aWNlIG5vZGU6Cisg
KiAgLSBHaXZlIHBlcm1pc3Npb24gdG8gdGhlIGd1ZXN0IHRvIG1hbmFnZSBJUlEgYW5kIE1NSU8g
cmFuZ2UKKyAqICAtIFJldHJpZXZlIHRoZSBJUlEgY29uZmlndXJhdGlvbiAoaS5lIGVkZ2UvbGV2
ZWwpIGZyb20gZGV2aWNlIHRyZWUKKyAqIFdoZW4gdGhlIGRldmljZSBpcyBub3QgbWFya2VkIGZv
ciBndWVzdCBwYXNzdGhyb3VnaDoKKyAqICAtIEFzc2lnbiB0aGUgZGV2aWNlIHRvIHRoZSBndWVz
dCBpZiBpdCdzIHByb3RlY3RlZCBieSBhbiBJT01NVQorICogIC0gTWFwIHRoZSBJUlFzIGFuZCBp
b21lbSByZWdpb25zIHRvIERPTTAKKyAqLworc3RhdGljIGludCBfX2luaXQgaGFuZGxlX2Rldmlj
ZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKmRldiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcDJtX3R5cGVfdCBwMm10KQoreworICAgIHVuc2lnbmVk
IGludCBuYWRkcjsKKyAgICB1bnNpZ25lZCBpbnQgaTsKKyAgICBpbnQgcmVzOworICAgIHU2NCBh
ZGRyLCBzaXplOworICAgIGJvb2wgbmVlZF9tYXBwaW5nID0gIWR0X2RldmljZV9mb3JfcGFzc3Ro
cm91Z2goZGV2KTsKKworICAgIG5hZGRyID0gZHRfbnVtYmVyX29mX2FkZHJlc3MoZGV2KTsKKwor
ICAgIGR0X2RwcmludGsoIiVzIHBhc3N0aHJvdWdoID0gJWQgbmFkZHIgPSAldVxuIiwKKyAgICAg
ICAgICAgICAgIGR0X25vZGVfZnVsbF9uYW1lKGRldiksIG5lZWRfbWFwcGluZywgbmFkZHIpOwor
CisgICAgaWYgKCBkdF9kZXZpY2VfaXNfcHJvdGVjdGVkKGRldikgJiYgbmVlZF9tYXBwaW5nICkK
KyAgICB7CisgICAgICAgIGR0X2RwcmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1
bGxfbmFtZShkZXYpKTsKKyAgICAgICAgcmVzID0gaW9tbXVfYXNzaWduX2R0X2RldmljZShkLCBk
ZXYpOworICAgICAgICBpZiAoIHJlcyApCisgICAgICAgIHsKKyAgICAgICAgICAgIHByaW50ayhY
RU5MT0dfRVJSICJGYWlsZWQgdG8gc2V0dXAgdGhlIElPTU1VIGZvciAlc1xuIiwKKyAgICAgICAg
ICAgICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKKyAgICAgICAgICAgIHJldHVybiBy
ZXM7CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXMgPSBoYW5kbGVfZGV2aWNlX2ludGVycnVw
dHMoZCwgZGV2LCBuZWVkX21hcHBpbmcpOworICAgIGlmICggcmVzIDwgMCApCisgICAgICAgIHJl
dHVybiByZXM7CisKICAgICAvKiBHaXZlIHBlcm1pc3Npb24gYW5kIG1hcCBNTUlPcyAqLwogICAg
IGZvciAoIGkgPSAwOyBpIDwgbmFkZHI7IGkrKyApCiAgICAgewotLSAKMi4xNy4xCgoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxp
bmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5w
cm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

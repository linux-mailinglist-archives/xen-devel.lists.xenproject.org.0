Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E394778B88
	for <lists+xen-devel@lfdr.de>; Mon, 29 Jul 2019 14:15:31 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hs4Vn-0006iI-13; Mon, 29 Jul 2019 12:12:19 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=hB3/=V2=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1hs4Vl-0006g8-7o
 for xen-devel@lists.xenproject.org; Mon, 29 Jul 2019 12:12:17 +0000
X-Inumbo-ID: 19b088ac-b1fa-11e9-a069-5f339fc91643
Received: from esa6.hc3370-68.iphmx.com (unknown [216.71.155.175])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 19b088ac-b1fa-11e9-a069-5f339fc91643;
 Mon, 29 Jul 2019 12:12:14 +0000 (UTC)
Authentication-Results: esa6.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa6.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa6.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa6.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa6.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: LKzS8NoSYwXYckjPrFuU/jSEgH+mwYr/+8pfY0j2gMqDQ+VtyDJYnAFxUvgr4IFMOuOyHwgDEt
 7bRWw3IYy80DDpXuPjTTn+V9jjmi7m93rsST3N8LXGOW8wbg6XGfIdMXg5znAqYAGXEkZg3K+o
 I9ySh/HGj7wYu5HDULe1mNyjR7nb0ObyAXRMze7BhUmAPFln6LBFIcV1tU7Og2Ve2B45cPVXJ5
 IPum94ZhyPRNmAKH2ED09tf9727Xr2qG34rhmmUPYe/JSfJKQREz1Pw6/th3jckBRO1y3dtS38
 Amk=
X-SBRS: 2.7
X-MesageID: 3672669
X-Ironport-Server: esa6.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,322,1559534400"; 
   d="scan'208";a="3672669"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Mon, 29 Jul 2019 13:12:03 +0100
Message-ID: <20190729121204.13559-10-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190729121204.13559-1-andrew.cooper3@citrix.com>
References: <20190729121204.13559-1-andrew.cooper3@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 09/10] xen/nodemask: Sanitise the remainder
 of the nodemask API
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Julien Grall <julien.grall@arm.com>,
 Jan Beulich <JBeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIG5vZGVtYXNrIEFQSSBkaWZmZXJzIGZyb20gdGhlIGNwdW1hc2sgQVBJIGJlY2F1c2UgZWFj
aCB3cmFwcGVyIHRvIGJpdG1hcApvcGVyYXRpb25zIGlzIGZ1cnRoZXIgd3JhcHBlZCBieSBhIG1h
Y3JvIHdoaWNoIHRha2VzIHRoZSBhZGRyZXNzIG9mIHRoZQpub2RlbWFzayBvYmplY3RzLgoKVGhp
cyByZXN1bHRzIGluIGNvZGUgd2hpY2ggaXMgc2xpZ2h0bHkgY29uZnVzaW5nIHRvIHJlYWQgYXMg
aXQgZG9lc24ndCBmb2xsb3cKQydzIGNhbGxpbmcgY29udmVudGlvbnMsIGFuZCBwcm9oaWJpdHMg
dGhlIHVzZSBvZiBzbGlnaHRseSBtb3JlIGNvbXBsaWNhdGVkCmNvbnN0cnVjdHMgZm9yIHNwZWNp
ZnlpbmcgcGFyYW1ldGVycy4KCkRyb3AgYWxsIHdyYXBwaW5nIG1hY3JvcywgcmVuYW1lIHRoZSBu
b2RlbWFzayBzdGF0aWMgaW5saW5lIGZ1bmN0aW9ucyB0byBkcm9wCnRoZSBkb3VibGUgdW5kZXJz
Y29yZXMsIGFuZCBmZWVkIE1BWF9OVU1OT0RFUyBpbnRvIGFwcHJvcHJpYXRlIGxvY2F0aW9ucy4K
CkZ1cnRoZXJtb3JlLCB0aGUgbmFtaW5nIGlzIGluY29uc2lzdGVudC4gIEFzIHdlJ3JlIGNoYW5n
aW5nIGFsbCBjYWxsZXJzCmFueXdheSwgcmF0aW9uYWxpc2UgYWxsIHRoZSBuYW1pbmcgdG8gYmUg
b2YgdGhlIGZvcm0gbm9kZW1hc2tfKigpLCBhbmQgdXBkYXRlCnRoZSB0eXBlcyB0byBwZXIgWGVu
J3MgbGF0ZXN0IGV4cGVjdGF0aW9ucy4KClNpZ25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFu
ZHJldy5jb29wZXIzQGNpdHJpeC5jb20+Ci0tLQpDQzogSmFuIEJldWxpY2ggPEpCZXVsaWNoQHN1
c2UuY29tPgpDQzogV2VpIExpdSA8d2xAeGVuLm9yZz4KQ0M6IFJvZ2VyIFBhdSBNb25uw6kgPHJv
Z2VyLnBhdUBjaXRyaXguY29tPgpDQzogU3RlZmFubyBTdGFiZWxsaW5pIDxzc3RhYmVsbGluaUBr
ZXJuZWwub3JnPgpDQzogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KQ0M6IEdl
b3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAZXUuY2l0cml4LmNvbT4KCnYzOgogKiBTcGxpdCB2
YXJpb3VzIGJpdHMgb3V0IGludG8gZWFybGllciBwYXRjaGVzCiAqIFJlbmFtZSB0aGUgQVBJcyB0
byBiZSBjb25zaXN0ZW50Lgp2MjoKICogTmV3Ci0tLQogeGVuL2FyY2gveDg2L2RvbTBfYnVpbGQu
YyAgfCAgIDggKy0KIHhlbi9hcmNoL3g4Ni9udW1hLmMgICAgICAgIHwgICA0ICstCiB4ZW4vYXJj
aC94ODYvc3JhdC5jICAgICAgICB8ICAgOSArKy0KIHhlbi9jb21tb24vZG9tYWluLmMgICAgICAg
IHwgICA0ICstCiB4ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyAgICB8ICAyNiArKystLS0tCiB4ZW4v
Y29tbW9uL3NjaGVkX2NyZWRpdC5jICB8ICAgMiArLQogeGVuL2NvbW1vbi9zeXNjdGwuYyAgICAg
ICAgfCAgIDIgKy0KIHhlbi9pbmNsdWRlL3hlbi9ub2RlbWFzay5oIHwgMTg2ICsrKysrKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogOCBmaWxlcyBjaGFuZ2VkLCAxMDkg
aW5zZXJ0aW9ucygrKSwgMTMyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4
Ni9kb20wX2J1aWxkLmMgYi94ZW4vYXJjaC94ODYvZG9tMF9idWlsZC5jCmluZGV4IGM2MjVlNjRk
MDMuLmNiMGY2OTNkNzYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb20wX2J1aWxkLmMKKysr
IGIveGVuL2FyY2gveDg2L2RvbTBfYnVpbGQuYwpAQCAtMjQ3LDEwICsyNDcsMTAgQEAgdW5zaWdu
ZWQgaW50IF9faW5pdCBkb20wX21heF92Y3B1cyh2b2lkKQogICAgIGZvciAoIGkgPSAwOyBpIDwg
ZG9tMF9ucl9weG1zOyArK2kgKQogICAgICAgICBpZiAoIChub2RlID0gcHhtX3RvX25vZGUoZG9t
MF9weG1zW2ldKSkgIT0gTlVNQV9OT19OT0RFICkKICAgICAgICAgICAgIF9fbm9kZW1hc2tfc2V0
KG5vZGUsICZkb20wX25vZGVzKTsKLSAgICBub2Rlc19hbmQoZG9tMF9ub2RlcywgZG9tMF9ub2Rl
cywgbm9kZV9vbmxpbmVfbWFwKTsKLSAgICBpZiAoIG5vZGVzX2VtcHR5KGRvbTBfbm9kZXMpICkK
KyAgICBub2RlbWFza19hbmQoJmRvbTBfbm9kZXMsICZkb20wX25vZGVzLCAmbm9kZV9vbmxpbmVf
bWFwKTsKKyAgICBpZiAoIG5vZGVtYXNrX2VtcHR5KCZkb20wX25vZGVzKSApCiAgICAgICAgIGRv
bTBfbm9kZXMgPSBub2RlX29ubGluZV9tYXA7Ci0gICAgZm9yX2VhY2hfbm9kZV9tYXNrICggbm9k
ZSwgZG9tMF9ub2RlcyApCisgICAgZm9yX2VhY2hfbm9kZV9tYXNrICggbm9kZSwgJmRvbTBfbm9k
ZXMgKQogICAgICAgICBjcHVtYXNrX29yKCZkb20wX2NwdXMsICZkb20wX2NwdXMsICZub2RlX3Rv
X2NwdW1hc2sobm9kZSkpOwogICAgIGNwdW1hc2tfYW5kKCZkb20wX2NwdXMsICZkb20wX2NwdXMs
IGNwdXBvb2wwLT5jcHVfdmFsaWQpOwogICAgIGlmICggY3B1bWFza19lbXB0eSgmZG9tMF9jcHVz
KSApCkBAIC0zNDQsNyArMzQ0LDcgQEAgdW5zaWduZWQgbG9uZyBfX2luaXQgZG9tMF9jb21wdXRl
X25yX3BhZ2VzKAogICAgIGlmICggIWRvbTBfbWVtX3NldCAmJiBDT05GSUdfRE9NMF9NRU1bMF0g
KQogICAgICAgICBwYXJzZV9kb20wX21lbShDT05GSUdfRE9NMF9NRU0pOwogCi0gICAgZm9yX2Vh
Y2hfbm9kZV9tYXNrICggbm9kZSwgZG9tMF9ub2RlcyApCisgICAgZm9yX2VhY2hfbm9kZV9tYXNr
ICggbm9kZSwgJmRvbTBfbm9kZXMgKQogICAgICAgICBhdmFpbCArPSBhdmFpbF9kb21oZWFwX3Bh
Z2VzX3JlZ2lvbihub2RlLCAwLCAwKSArCiAgICAgICAgICAgICAgICAgIGluaXRpYWxfaW1hZ2Vz
X25ycGFnZXMobm9kZSk7CiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9udW1hLmMgYi94ZW4v
YXJjaC94ODYvbnVtYS5jCmluZGV4IDc0NzNmODNiN2IuLmQzZGIyMTM0MzIgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9udW1hLmMKKysrIGIveGVuL2FyY2gveDg2L251bWEuYwpAQCAtMTg2LDEz
ICsxODYsMTMgQEAgdm9pZCBfX2luaXQgbnVtYV9pbml0X2FycmF5KHZvaWQpCiAgICAgICAgbWFw
cGluZy4gVG8gYXZvaWQgdGhpcyBmaWxsIGluIHRoZSBtYXBwaW5nIGZvciBhbGwgcG9zc2libGUK
ICAgICAgICBDUFVzLCBhcyB0aGUgbnVtYmVyIG9mIENQVXMgaXMgbm90IGtub3duIHlldC4KICAg
ICAgICBXZSByb3VuZCByb2JpbiB0aGUgZXhpc3Rpbmcgbm9kZXMuICovCi0gICAgcnIgPSBmaXJz
dF9ub2RlKG5vZGVfb25saW5lX21hcCk7CisgICAgcnIgPSBub2RlbWFza19maXJzdCgmbm9kZV9v
bmxpbmVfbWFwKTsKICAgICBmb3IgKCBpID0gMDsgaSA8IG5yX2NwdV9pZHM7IGkrKyApCiAgICAg
ewogICAgICAgICBpZiAoIGNwdV90b19ub2RlW2ldICE9IE5VTUFfTk9fTk9ERSApCiAgICAgICAg
ICAgICBjb250aW51ZTsKICAgICAgICAgbnVtYV9zZXRfbm9kZShpLCBycik7Ci0gICAgICAgIHJy
ID0gY3ljbGVfbm9kZShyciwgbm9kZV9vbmxpbmVfbWFwKTsKKyAgICAgICAgcnIgPSBub2RlbWFz
a19jeWNsZShyciwgJm5vZGVfb25saW5lX21hcCk7CiAgICAgfQogfQogCmRpZmYgLS1naXQgYS94
ZW4vYXJjaC94ODYvc3JhdC5jIGIveGVuL2FyY2gveDg2L3NyYXQuYwppbmRleCA1ZjQ0YWMyN2Yx
Li45ZTM3ZTI0ZDcwIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvc3JhdC5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9zcmF0LmMKQEAgLTMzMiw3ICszMzIsNyBAQCBhY3BpX251bWFfbWVtb3J5X2FmZmlu
aXR5X2luaXQoY29uc3Qgc3RydWN0IGFjcGlfc3JhdF9tZW1fYWZmaW5pdHkgKm1hKQogCWlmICgh
KG1hLT5mbGFncyAmIEFDUElfU1JBVF9NRU1fSE9UX1BMVUdHQUJMRSkpIHsKIAkJc3RydWN0IG5v
ZGUgKm5kID0gJm5vZGVzW25vZGVdOwogCi0JCWlmICghbm9kZV90ZXN0X2FuZF9zZXQobm9kZSwg
bWVtb3J5X25vZGVzX3BhcnNlZCkpIHsKKwkJaWYgKCFub2RlbWFza190ZXN0X2FuZF9zZXQobm9k
ZSwgJm1lbW9yeV9ub2Rlc19wYXJzZWQpKSB7CiAJCQluZC0+c3RhcnQgPSBzdGFydDsKIAkJCW5k
LT5lbmQgPSBlbmQ7CiAJCX0gZWxzZSB7CkBAIC0zNzYsNyArMzc2LDcgQEAgc3RhdGljIGludCBf
X2luaXQgbm9kZXNfY292ZXJfbWVtb3J5KHZvaWQpCiAKIAkJZG8gewogCQkJZm91bmQgPSAwOwot
CQkJZm9yX2VhY2hfbm9kZV9tYXNrKGosIG1lbW9yeV9ub2Rlc19wYXJzZWQpCisJCQlmb3JfZWFj
aF9ub2RlX21hc2soIGosICZtZW1vcnlfbm9kZXNfcGFyc2VkICkKIAkJCQlpZiAoc3RhcnQgPCBu
b2Rlc1tqXS5lbmQKIAkJCQkgICAgJiYgZW5kID4gbm9kZXNbal0uc3RhcnQpIHsKIAkJCQkJaWYg
KHN0YXJ0ID49IG5vZGVzW2pdLnN0YXJ0KSB7CkBAIC00ODAsMTAgKzQ4MCwxMSBAQCBpbnQgX19p
bml0IGFjcGlfc2Nhbl9ub2Rlcyh1NjQgc3RhcnQsIHU2NCBlbmQpCiAJCXJldHVybiAtMTsKIAl9
CiAKLQlub2Rlc19vcihhbGxfbm9kZXNfcGFyc2VkLCBtZW1vcnlfbm9kZXNfcGFyc2VkLCBwcm9j
ZXNzb3Jfbm9kZXNfcGFyc2VkKTsKKwlub2RlbWFza19vcigmYWxsX25vZGVzX3BhcnNlZCwgJm1l
bW9yeV9ub2Rlc19wYXJzZWQsCisJCSAgICAmcHJvY2Vzc29yX25vZGVzX3BhcnNlZCk7CiAKIAkv
KiBGaW5hbGx5IHJlZ2lzdGVyIG5vZGVzICovCi0JZm9yX2VhY2hfbm9kZV9tYXNrKGksIGFsbF9u
b2Rlc19wYXJzZWQpCisJZm9yX2VhY2hfbm9kZV9tYXNrKCBpLCAmYWxsX25vZGVzX3BhcnNlZCAp
CiAJewogCQl1NjQgc2l6ZSA9IG5vZGVzW2ldLmVuZCAtIG5vZGVzW2ldLnN0YXJ0OwogCQlpZiAo
IHNpemUgPT0gMCApCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2RvbWFpbi5jIGIveGVuL2NvbW1v
bi9kb21haW4uYwppbmRleCA1ZGJjNjhjYmMzLi4zMjI4YjA4YjNhIDEwMDY0NAotLS0gYS94ZW4v
Y29tbW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTYzMCw3ICs2MzAs
NyBAQCB2b2lkIGRvbWFpbl91cGRhdGVfbm9kZV9hZmZpbml0eShzdHJ1Y3QgZG9tYWluICpkKQog
aW50IGRvbWFpbl9zZXRfbm9kZV9hZmZpbml0eShzdHJ1Y3QgZG9tYWluICpkLCBjb25zdCBub2Rl
bWFza190ICphZmZpbml0eSkKIHsKICAgICAvKiBCZWluZyBhZmZpbmUgd2l0aCBubyBub2RlcyBp
cyBqdXN0IHdyb25nICovCi0gICAgaWYgKCBub2Rlc19lbXB0eSgqYWZmaW5pdHkpICkKKyAgICBp
ZiAoIG5vZGVtYXNrX2VtcHR5KGFmZmluaXR5KSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwog
CiAgICAgc3Bpbl9sb2NrKCZkLT5ub2RlX2FmZmluaXR5X2xvY2spOwpAQCAtNjM5LDcgKzYzOSw3
IEBAIGludCBkb21haW5fc2V0X25vZGVfYWZmaW5pdHkoc3RydWN0IGRvbWFpbiAqZCwgY29uc3Qg
bm9kZW1hc2tfdCAqYWZmaW5pdHkpCiAgICAgICogQmVpbmcvYmVjb21pbmcgZXhwbGljaXRseSBh
ZmZpbmUgdG8gYWxsIG5vZGVzIGlzIG5vdCBwYXJ0aWN1bGFybHkKICAgICAgKiB1c2VmdWwuIExl
dCdzIHRha2UgaXQgYXMgdGhlIGByZXNldCBub2RlIGFmZmluaXR5YCBjb21tYW5kLgogICAgICAq
LwotICAgIGlmICggbm9kZXNfZnVsbCgqYWZmaW5pdHkpICkKKyAgICBpZiAoIG5vZGVtYXNrX2Z1
bGwoYWZmaW5pdHkpICkKICAgICB7CiAgICAgICAgIGQtPmF1dG9fbm9kZV9hZmZpbml0eSA9IDE7
CiAgICAgICAgIGdvdG8gb3V0OwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMg
Yi94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYwppbmRleCA3N2U2NDlkMDY1Li45NzUzOWZmZDY5IDEw
MDY0NAotLS0gYS94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYworKysgYi94ZW4vY29tbW9uL3BhZ2Vf
YWxsb2MuYwpAQCAtODIxLDEyICs4MjEsMTIgQEAgc3RhdGljIHN0cnVjdCBwYWdlX2luZm8gKmdl
dF9mcmVlX2J1ZGR5KHVuc2lnbmVkIGludCB6b25lX2xvLAogICAgICAqIG1heSBoYXZlIGJpdCBz
ZXQgb3V0c2lkZSBvZiBub2RlX29ubGluZV9tYXAuICBDbGFtcCBpdC4KICAgICAgKi8KICAgICBp
ZiAoIGQgKQotICAgICAgICBub2Rlc19hbmQobm9kZW1hc2ssIG5vZGVtYXNrLCBkLT5ub2RlX2Fm
ZmluaXR5KTsKKyAgICAgICAgbm9kZW1hc2tfYW5kKCZub2RlbWFzaywgJm5vZGVtYXNrLCAmZC0+
bm9kZV9hZmZpbml0eSk7CiAKICAgICBpZiAoIG5vZGUgPT0gTlVNQV9OT19OT0RFICkKICAgICB7
CiAgICAgICAgIGlmICggZCAhPSBOVUxMICkKLSAgICAgICAgICAgIG5vZGUgPSBjeWNsZV9ub2Rl
KGQtPmxhc3RfYWxsb2Nfbm9kZSwgbm9kZW1hc2spOworICAgICAgICAgICAgbm9kZSA9IG5vZGVt
YXNrX2N5Y2xlKGQtPmxhc3RfYWxsb2Nfbm9kZSwgJm5vZGVtYXNrKTsKIAogICAgICAgICBpZiAo
IG5vZGUgPj0gTUFYX05VTU5PREVTICkKICAgICAgICAgICAgIG5vZGUgPSBjcHVfdG9fbm9kZShz
bXBfcHJvY2Vzc29yX2lkKCkpOwpAQCAtODgyLDE5ICs4ODIsMTkgQEAgc3RhdGljIHN0cnVjdCBw
YWdlX2luZm8gKmdldF9mcmVlX2J1ZGR5KHVuc2lnbmVkIGludCB6b25lX2xvLAogICAgICAgICB7
CiAgICAgICAgICAgICAvKiBWZXJ5IGZpcnN0IG5vZGUgbWF5IGJlIGNhbGxlci1zcGVjaWZpZWQg
YW5kIG91dHNpZGUgbm9kZW1hc2suICovCiAgICAgICAgICAgICBBU1NFUlQoIW5vZGVtYXNrX3Jl
dHJ5KTsKLSAgICAgICAgICAgIGZpcnN0ID0gbm9kZSA9IGZpcnN0X25vZGUobm9kZW1hc2spOwor
ICAgICAgICAgICAgZmlyc3QgPSBub2RlID0gbm9kZW1hc2tfZmlyc3QoJm5vZGVtYXNrKTsKICAg
ICAgICAgICAgIGlmICggbm9kZSA8IE1BWF9OVU1OT0RFUyApCiAgICAgICAgICAgICAgICAgY29u
dGludWU7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIChub2RlID0gbmV4dF9ub2RlKG5v
ZGUsIG5vZGVtYXNrKSkgPj0gTUFYX05VTU5PREVTICkKLSAgICAgICAgICAgIG5vZGUgPSBmaXJz
dF9ub2RlKG5vZGVtYXNrKTsKKyAgICAgICAgZWxzZSBpZiAoIChub2RlID0gbm9kZW1hc2tfbmV4
dChub2RlLCAmbm9kZW1hc2spKSA+PSBNQVhfTlVNTk9ERVMgKQorICAgICAgICAgICAgbm9kZSA9
IG5vZGVtYXNrX2ZpcnN0KCZub2RlbWFzayk7CiAgICAgICAgIGlmICggbm9kZSA9PSBmaXJzdCAp
CiAgICAgICAgIHsKICAgICAgICAgICAgIC8qIFdoZW4gd2UgaGF2ZSB0cmllZCBhbGwgaW4gbm9k
ZW1hc2ssIHdlIGZhbGwgYmFjayB0byBvdGhlcnMuICovCiAgICAgICAgICAgICBpZiAoIChtZW1m
bGFncyAmIE1FTUZfZXhhY3Rfbm9kZSkgfHwgbm9kZW1hc2tfcmV0cnkrKyApCiAgICAgICAgICAg
ICAgICAgcmV0dXJuIE5VTEw7Ci0gICAgICAgICAgICBub2Rlc19hbmRub3Qobm9kZW1hc2ssIG5v
ZGVfb25saW5lX21hcCwgbm9kZW1hc2spOwotICAgICAgICAgICAgZmlyc3QgPSBub2RlID0gZmly
c3Rfbm9kZShub2RlbWFzayk7CisgICAgICAgICAgICBub2RlbWFza19hbmRub3QoJm5vZGVtYXNr
LCAmbm9kZV9vbmxpbmVfbWFwLCAmbm9kZW1hc2spOworICAgICAgICAgICAgZmlyc3QgPSBub2Rl
ID0gbm9kZW1hc2tfZmlyc3QoJm5vZGVtYXNrKTsKICAgICAgICAgICAgIGlmICggbm9kZSA+PSBN
QVhfTlVNTk9ERVMgKQogICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICB9CkBA
IC0xMTcxLDcgKzExNzEsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IG5vZGVfdG9fc2NydWIoYm9v
bCBnZXRfbm9kZSkKICAgICAgICAgbm9kZSA9IDA7CiAKICAgICBpZiAoIG5vZGVfbmVlZF9zY3J1
Yltub2RlXSAmJgotICAgICAgICAgKCFnZXRfbm9kZSB8fCAhbm9kZV90ZXN0X2FuZF9zZXQobm9k
ZSwgbm9kZV9zY3J1YmJpbmcpKSApCisgICAgICAgICAoIWdldF9ub2RlIHx8ICFub2RlbWFza190
ZXN0X2FuZF9zZXQobm9kZSwgJm5vZGVfc2NydWJiaW5nKSkgKQogICAgICAgICByZXR1cm4gbm9k
ZTsKIAogICAgIC8qCkBAIC0xMTgyLDcgKzExODIsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IG5v
ZGVfdG9fc2NydWIoYm9vbCBnZXRfbm9kZSkKICAgICBmb3IgKCA7IDsgKQogICAgIHsKICAgICAg
ICAgZG8gewotICAgICAgICAgICAgbm9kZSA9IGN5Y2xlX25vZGUobm9kZSwgbm9kZV9vbmxpbmVf
bWFwKTsKKyAgICAgICAgICAgIG5vZGUgPSBub2RlbWFza19jeWNsZShub2RlLCAmbm9kZV9vbmxp
bmVfbWFwKTsKICAgICAgICAgfSB3aGlsZSAoICFjcHVtYXNrX2VtcHR5KCZub2RlX3RvX2NwdW1h
c2sobm9kZSkpICYmCiAgICAgICAgICAgICAgICAgICAobm9kZSAhPSBsb2NhbF9ub2RlKSApOwog
CkBAIC0xMjA1LDEwICsxMjA1LDEwIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgbm9kZV90b19zY3J1
Yihib29sIGdldF9ub2RlKQogICAgICAgICAgICAgICogdGhlbiB3ZSdkIG5lZWQgdG8gdGFrZSB0
aGlzIGxvY2sgZXZlcnkgdGltZSB3ZSBjb21lIGluIGhlcmUuCiAgICAgICAgICAgICAgKi8KICAg
ICAgICAgICAgIGlmICggKGRpc3QgPCBzaG9ydGVzdCB8fCBjbG9zZXN0ID09IE5VTUFfTk9fTk9E
RSkgJiYKLSAgICAgICAgICAgICAgICAgIW5vZGVfdGVzdF9hbmRfc2V0KG5vZGUsIG5vZGVfc2Ny
dWJiaW5nKSApCisgICAgICAgICAgICAgICAgICFub2RlbWFza190ZXN0X2FuZF9zZXQobm9kZSwg
Jm5vZGVfc2NydWJiaW5nKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaWYgKCBj
bG9zZXN0ICE9IE5VTUFfTk9fTk9ERSApCi0gICAgICAgICAgICAgICAgICAgIG5vZGVfY2xlYXIo
Y2xvc2VzdCwgbm9kZV9zY3J1YmJpbmcpOworICAgICAgICAgICAgICAgICAgICBub2RlbWFza19j
bGVhcihjbG9zZXN0LCAmbm9kZV9zY3J1YmJpbmcpOwogICAgICAgICAgICAgICAgIHNob3J0ZXN0
ID0gZGlzdDsKICAgICAgICAgICAgICAgICBjbG9zZXN0ID0gbm9kZTsKICAgICAgICAgICAgIH0K
QEAgLTEzNjAsNyArMTM2MCw3IEBAIGJvb2wgc2NydWJfZnJlZV9wYWdlcyh2b2lkKQogICAgIHNw
aW5fdW5sb2NrKCZoZWFwX2xvY2spOwogCiAgb3V0X25vbG9jazoKLSAgICBub2RlX2NsZWFyKG5v
ZGUsIG5vZGVfc2NydWJiaW5nKTsKKyAgICBub2RlbWFza19jbGVhcihub2RlLCAmbm9kZV9zY3J1
YmJpbmcpOwogICAgIHJldHVybiBub2RlX3RvX3NjcnViKGZhbHNlKSAhPSBOVU1BX05PX05PREU7
CiB9CiAKQEAgLTIwMTAsNyArMjAxMCw3IEBAIHN0YXRpYyB2b2lkIF9faW5pdCBzY3J1Yl9oZWFw
X3BhZ2VzKHZvaWQpCiAgICAgICAgICAgICBjb250aW51ZTsKIAogICAgICAgICBsYXN0X2Rpc3Rh
bmNlID0gSU5UX01BWDsKLSAgICAgICAgYmVzdF9ub2RlID0gZmlyc3Rfbm9kZShub2RlX29ubGlu
ZV9tYXApOworICAgICAgICBiZXN0X25vZGUgPSBub2RlbWFza19maXJzdCgmbm9kZV9vbmxpbmVf
bWFwKTsKICAgICAgICAgLyogRmlndXJlIG91dCB3aGljaCBOT0RFIENQVXMgYXJlIGNsb3NlLiAq
LwogICAgICAgICBmb3JfZWFjaF9vbmxpbmVfbm9kZSAoIGogKQogICAgICAgICB7CmRpZmYgLS1n
aXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQu
YwppbmRleCA4MWRlZTVlNDcyLi4zZTU2OWQ2OTcwIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3Nj
aGVkX2NyZWRpdC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKQEAgLTE4MTAsNyAr
MTgxMCw3IEBAIGNzY2hlZF9sb2FkX2JhbGFuY2Uoc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYs
IGludCBjcHUsCiAgICAgICAgICAgICB9IHdoaWxlKCBwZWVyX2NwdSAhPSBmaXJzdF9jcHUgKTsK
IAogIG5leHRfbm9kZToKLSAgICAgICAgICAgIHBlZXJfbm9kZSA9IGN5Y2xlX25vZGUocGVlcl9u
b2RlLCBub2RlX29ubGluZV9tYXApOworICAgICAgICAgICAgcGVlcl9ub2RlID0gbm9kZW1hc2tf
Y3ljbGUocGVlcl9ub2RlLCAmbm9kZV9vbmxpbmVfbWFwKTsKICAgICAgICAgfSB3aGlsZSggcGVl
cl9ub2RlICE9IG5vZGUgKTsKICAgICB9CiAKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc3lzY3Rs
LmMgYi94ZW4vY29tbW9uL3N5c2N0bC5jCmluZGV4IDc2NWVmZmRlOGQuLmM4YzY4MDViYjQgMTAw
NjQ0Ci0tLSBhL3hlbi9jb21tb24vc3lzY3RsLmMKKysrIGIveGVuL2NvbW1vbi9zeXNjdGwuYwpA
QCAtMjgwLDcgKzI4MCw3IEBAIGxvbmcgZG9fc3lzY3RsKFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0o
eGVuX3N5c2N0bF90KSB1X3N5c2N0bCkKICAgICAgICAgYm9vbF90IGRvX21lbWluZm8gPSAhZ3Vl
c3RfaGFuZGxlX2lzX251bGwobmktPm1lbWluZm8pOwogICAgICAgICBib29sX3QgZG9fZGlzdGFu
Y2UgPSAhZ3Vlc3RfaGFuZGxlX2lzX251bGwobmktPmRpc3RhbmNlKTsKIAotICAgICAgICBudW1f
bm9kZXMgPSBsYXN0X25vZGUobm9kZV9vbmxpbmVfbWFwKSArIDE7CisgICAgICAgIG51bV9ub2Rl
cyA9IG5vZGVtYXNrX2xhc3QoJm5vZGVfb25saW5lX21hcCkgKyAxOwogCiAgICAgICAgIGlmICgg
ZG9fbWVtaW5mbyB8fCBkb19kaXN0YW5jZSApCiAgICAgICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9p
bmNsdWRlL3hlbi9ub2RlbWFzay5oIGIveGVuL2luY2x1ZGUveGVuL25vZGVtYXNrLmgKaW5kZXgg
MTYwNWMxYmNjNS4uZWQ5MThlNGE4ZCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL25vZGVt
YXNrLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL25vZGVtYXNrLmgKQEAgLTEwLDMwICsxMCwzMCBA
QAogICoKICAqIFRoZSBhdmFpbGFibGUgbm9kZW1hc2sgb3BlcmF0aW9ucyBhcmU6CiAgKgotICog
dm9pZCBub2RlX3NldChub2RlLCBtYXNrKQkJdHVybiBvbiBiaXQgJ25vZGUnIGluIG1hc2sKKyAq
IHZvaWQgbm9kZW1hc2tfc2V0KG5vZGUsIG1hc2spCXR1cm4gb24gYml0ICdub2RlJyBpbiBtYXNr
CiAgKiB2b2lkIF9fbm9kZW1hc2tfc2V0KG5vZGUsIG1hc2spCXR1cm4gb24gYml0ICdub2RlJyBp
biBtYXNrICh1bmxvY2tlZCkKLSAqIHZvaWQgbm9kZV9jbGVhcihub2RlLCBtYXNrKQkJdHVybiBv
ZmYgYml0ICdub2RlJyBpbiBtYXNrCisgKiB2b2lkIG5vZGVtYXNrX2NsZWFyKG5vZGUsIG1hc2sp
CXR1cm4gb2ZmIGJpdCAnbm9kZScgaW4gbWFzawogICogdm9pZCBfX25vZGVtYXNrX2NsZWFyKG5v
ZGUsIG1hc2spCXR1cm4gb2ZmIGJpdCAnbm9kZScgaW4gbWFzayAodW5sb2NrZWQpCiAgKiBib29s
IG5vZGVtYXNrX3Rlc3Qobm9kZSwgbWFzaykJdHJ1ZSBpZmYgYml0ICdub2RlJyBzZXQgaW4gbWFz
awotICogaW50IG5vZGVfdGVzdF9hbmRfc2V0KG5vZGUsIG1hc2spCXRlc3QgYW5kIHNldCBiaXQg
J25vZGUnIGluIG1hc2sKKyAqIGJvb2wgbm9kZW1hc2tfdGVzdF9hbmRfc2V0KG5vZGUsIG1hc2sp
IHRlc3QgYW5kIHNldCBiaXQgJ25vZGUnIGluIG1hc2sKICAqCi0gKiB2b2lkIG5vZGVzX2FuZChk
c3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNyYzEgJiBzcmMyICBbaW50ZXJzZWN0aW9uXQotICogdm9p
ZCBub2Rlc19vcihkc3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNyYzEgfCBzcmMyICBbdW5pb25dCi0g
KiB2b2lkIG5vZGVzX3hvcihkc3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNyYzEgXiBzcmMyCi0gKiB2
b2lkIG5vZGVzX2FuZG5vdChkc3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNyYzEgJiB+c3JjMgotICog
dm9pZCBub2Rlc19jb21wbGVtZW50KGRzdCwgc3JjKQlkc3QgPSB+c3JjCisgKiB2b2lkIG5vZGVt
YXNrX2FuZChkc3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNyYzEgJiBzcmMyICBbaW50ZXJzZWN0aW9u
XQorICogdm9pZCBub2RlbWFza19vcihkc3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNyYzEgfCBzcmMy
ICBbdW5pb25dCisgKiB2b2lkIG5vZGVtYXNrX3hvcihkc3QsIHNyYzEsIHNyYzIpCWRzdCA9IHNy
YzEgXiBzcmMyCisgKiB2b2lkIG5vZGVtYXNrX2FuZG5vdChkc3QsIHNyYzEsIHNyYzIpZHN0ID0g
c3JjMSAmIH5zcmMyCisgKiB2b2lkIG5vZGVtYXNrX2NvbXBsZW1lbnQoZHN0LCBzcmMpCWRzdCA9
IH5zcmMKICAqCi0gKiBpbnQgbm9kZXNfZXF1YWwobWFzazEsIG1hc2syKQlEb2VzIG1hc2sxID09
IG1hc2syPwotICogaW50IG5vZGVzX2ludGVyc2VjdHMobWFzazEsIG1hc2syKQlEbyBtYXNrMSBh
bmQgbWFzazIgaW50ZXJzZWN0PwotICogaW50IG5vZGVzX3N1YnNldChtYXNrMSwgbWFzazIpCUlz
IG1hc2sxIGEgc3Vic2V0IG9mIG1hc2syPwotICogaW50IG5vZGVzX2VtcHR5KG1hc2spCQlJcyBt
YXNrIGVtcHR5IChubyBiaXRzIHNldHMpPwotICogaW50IG5vZGVzX2Z1bGwobWFzaykJCQlJcyBt
YXNrIGZ1bGwgKGFsbCBiaXRzIHNldHMpPwotICogaW50IG5vZGVzX3dlaWdodChtYXNrKQkJSGFt
bWluZyB3ZWlnaHQgLSBudW1iZXIgb2Ygc2V0IGJpdHMKKyAqIGJvb2wgbm9kZW1hc2tfZXF1YWwo
bWFzazEsIG1hc2syKQlEb2VzIG1hc2sxID09IG1hc2syPworICogYm9vbCBub2RlbWFza19pbnRl
cnNlY3RzKG1hc2sxLCBtYXNrMikgRG8gbWFzazEgYW5kIG1hc2syIGludGVyc2VjdD8KKyAqIGJv
b2wgbm9kZW1hc2tfc3Vic2V0KG1hc2sxLCBtYXNrMikJSXMgbWFzazEgYSBzdWJzZXQgb2YgbWFz
azI/CisgKiBib29sIG5vZGVtYXNrX2VtcHR5KG1hc2spCQlJcyBtYXNrIGVtcHR5IChubyBiaXRz
IHNldHMpPworICogYm9vbCBub2RlbWFza19mdWxsKG1hc2spCQlJcyBtYXNrIGZ1bGwgKGFsbCBi
aXRzIHNldHMpPworICogdW5zaWduZWQgaW50IG5vZGVtYXNrX3dlaWdodChtYXNrKQlIYW1taW5n
IHdlaWdodCAtIG51bWJlciBvZiBzZXQgYml0cwogICoKLSAqIGludCBmaXJzdF9ub2RlKG1hc2sp
CQkJTnVtYmVyIGxvd2VzdCBzZXQgYml0LCBvciBNQVhfTlVNTk9ERVMKLSAqIGludCBuZXh0X25v
ZGUobm9kZSwgbWFzaykJCU5leHQgbm9kZSBwYXN0ICdub2RlJywgb3IgTUFYX05VTU5PREVTCi0g
KiBpbnQgbGFzdF9ub2RlKG1hc2spCQkJTnVtYmVyIGhpZ2hlc3Qgc2V0IGJpdCwgb3IgTUFYX05V
TU5PREVTCi0gKiBpbnQgY3ljbGVfbm9kZShub2RlLCBtYXNrKQkJTmV4dCBub2RlIGN5Y2xpbmcg
ZnJvbSAnbm9kZScsIG9yCisgKiBub2RlIG5vZGVtYXNrX2ZpcnN0KG1hc2spCQlOdW1iZXIgbG93
ZXN0IHNldCBiaXQsIG9yIE1BWF9OVU1OT0RFUworICogbm9kZSBub2RlbWFza19uZXh0KG5vZGUs
IG1hc2spIAlOZXh0IG5vZGUgcGFzdCAnbm9kZScsIG9yIE1BWF9OVU1OT0RFUworICogbm9kZSBu
b2RlbWFza19sYXN0KG1hc2spCQlOdW1iZXIgaGlnaGVzdCBzZXQgYml0LCBvciBNQVhfTlVNTk9E
RVMKKyAqIG5vZGUgbm9kZW1hc2tfY3ljbGUobm9kZSwgbWFzaykgCU5leHQgbm9kZSBjeWNsaW5n
IGZyb20gJ25vZGUnLCBvcgogICoJCQkJCU1BWF9OVU1OT0RFUwogICoKICAqIG5vZGVtYXNrX3Qg
Tk9ERU1BU0tfT0Yobm9kZSkJCUluaXRpYWxpemVyIC0gYml0ICdub2RlJyBzZXQKQEAgLTQzLDcg
KzQzLDcgQEAKICAqCiAgKiBmb3JfZWFjaF9ub2RlX21hc2sobm9kZSwgbWFzaykJZm9yLWxvb3Ag
bm9kZSBvdmVyIG1hc2sKICAqCi0gKiBpbnQgbnVtX29ubGluZV9ub2RlcygpCQlOdW1iZXIgb2Yg
b25saW5lIE5vZGVzCisgKiB1bnNpZ25lZCBpbnQgbnVtX29ubGluZV9ub2RlcygpCU51bWJlciBv
ZiBvbmxpbmUgTm9kZXMKICAqCiAgKiBib29sIG5vZGVfb25saW5lKG5vZGUpCQlJcyB0aGlzIG5v
ZGUgb25saW5lPwogICoKQEAgLTk2LDEwICs5Niw5IEBAIHR5cGVkZWYgc3RydWN0IHsgREVDTEFS
RV9CSVRNQVAoYml0cywgTUFYX05VTU5PREVTKTsgfSBub2RlbWFza190OwogCiAjZW5kaWYgLyog
TUFYX05VTU5PREVTICovCiAKLSNkZWZpbmUgbm9kZV9zZXQobm9kZSwgZHN0KSBfX25vZGVfc2V0
KChub2RlKSwgJihkc3QpKQotc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZV9zZXQoaW50IG5vZGUs
IHZvbGF0aWxlIG5vZGVtYXNrX3QgKmRzdHApCitzdGF0aWMgaW5saW5lIHZvaWQgbm9kZW1hc2tf
c2V0KHVuc2lnbmVkIGludCBub2RlLCBub2RlbWFza190ICpkc3QpCiB7Ci0Jc2V0X2JpdChub2Rl
LCBkc3RwLT5iaXRzKTsKKyAgICBzZXRfYml0KG5vZGUsIGRzdC0+Yml0cyk7CiB9CiAKIHN0YXRp
YyBpbmxpbmUgdm9pZCBfX25vZGVtYXNrX3NldCh1bnNpZ25lZCBpbnQgbm9kZSwgbm9kZW1hc2tf
dCAqZHN0KQpAQCAtMTA3LDEwICsxMDYsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgX19ub2RlbWFz
a19zZXQodW5zaWduZWQgaW50IG5vZGUsIG5vZGVtYXNrX3QgKmRzdCkKICAgICBfX3NldF9iaXQo
bm9kZSwgZHN0LT5iaXRzKTsKIH0KIAotI2RlZmluZSBub2RlX2NsZWFyKG5vZGUsIGRzdCkgX19u
b2RlX2NsZWFyKChub2RlKSwgJihkc3QpKQotc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZV9jbGVh
cihpbnQgbm9kZSwgdm9sYXRpbGUgbm9kZW1hc2tfdCAqZHN0cCkKK3N0YXRpYyBpbmxpbmUgdm9p
ZCBub2RlbWFza19jbGVhcih1bnNpZ25lZCBpbnQgbm9kZSwgbm9kZW1hc2tfdCAqZHN0KQogewot
CWNsZWFyX2JpdChub2RlLCBkc3RwLT5iaXRzKTsKKyAgICBjbGVhcl9iaXQobm9kZSwgZHN0LT5i
aXRzKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZW1hc2tfY2xlYXIodW5zaWduZWQg
aW50IG5vZGUsIG5vZGVtYXNrX3QgKmRzdCkKQEAgLTEyMywxMzkgKzEyMSwxMTcgQEAgc3RhdGlj
IGlubGluZSBib29sIG5vZGVtYXNrX3Rlc3QodW5zaWduZWQgaW50IG5vZGUsIGNvbnN0IG5vZGVt
YXNrX3QgKmRzdCkKICAgICByZXR1cm4gdGVzdF9iaXQobm9kZSwgZHN0LT5iaXRzKTsKIH0KIAot
I2RlZmluZSBub2RlX3Rlc3RfYW5kX3NldChub2RlLCBub2RlbWFzaykgXAotCQkJX19ub2RlX3Rl
c3RfYW5kX3NldCgobm9kZSksICYobm9kZW1hc2spKQotc3RhdGljIGlubGluZSBpbnQgX19ub2Rl
X3Rlc3RfYW5kX3NldChpbnQgbm9kZSwgbm9kZW1hc2tfdCAqYWRkcikKK3N0YXRpYyBpbmxpbmUg
Ym9vbCBub2RlbWFza190ZXN0X2FuZF9zZXQodW5zaWduZWQgaW50IG5vZGUsIG5vZGVtYXNrX3Qg
KmRzdCkKIHsKLQlyZXR1cm4gdGVzdF9hbmRfc2V0X2JpdChub2RlLCBhZGRyLT5iaXRzKTsKKyAg
ICByZXR1cm4gdGVzdF9hbmRfc2V0X2JpdChub2RlLCBkc3QtPmJpdHMpOwogfQogCi0jZGVmaW5l
IG5vZGVzX2FuZChkc3QsIHNyYzEsIHNyYzIpIFwKLQkJCV9fbm9kZXNfYW5kKCYoZHN0KSwgJihz
cmMxKSwgJihzcmMyKSwgTUFYX05VTU5PREVTKQotc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZXNf
YW5kKG5vZGVtYXNrX3QgKmRzdHAsIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzFwLAotCQkJCQljb25z
dCBub2RlbWFza190ICpzcmMycCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSB2b2lkIG5vZGVt
YXNrX2FuZChub2RlbWFza190ICpkc3QsIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzEsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVtYXNrX3QgKnNyYzIpCiB7Ci0JYml0
bWFwX2FuZChkc3RwLT5iaXRzLCBzcmMxcC0+Yml0cywgc3JjMnAtPmJpdHMsIG5iaXRzKTsKKyAg
ICBiaXRtYXBfYW5kKGRzdC0+Yml0cywgc3JjMS0+Yml0cywgc3JjMi0+Yml0cywgTUFYX05VTU5P
REVTKTsKIH0KIAotI2RlZmluZSBub2Rlc19vcihkc3QsIHNyYzEsIHNyYzIpIFwKLQkJCV9fbm9k
ZXNfb3IoJihkc3QpLCAmKHNyYzEpLCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5s
aW5lIHZvaWQgX19ub2Rlc19vcihub2RlbWFza190ICpkc3RwLCBjb25zdCBub2RlbWFza190ICpz
cmMxcCwKLQkJCQkJY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnAsIGludCBuYml0cykKK3N0YXRpYyBp
bmxpbmUgdm9pZCBub2RlbWFza19vcihub2RlbWFza190ICpkc3QsIGNvbnN0IG5vZGVtYXNrX3Qg
KnNyYzEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZW1hc2tfdCAq
c3JjMikKIHsKLQliaXRtYXBfb3IoZHN0cC0+Yml0cywgc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRz
LCBuYml0cyk7CisgICAgYml0bWFwX29yKGRzdC0+Yml0cywgc3JjMS0+Yml0cywgc3JjMi0+Yml0
cywgTUFYX05VTU5PREVTKTsKIH0KIAotI2RlZmluZSBub2Rlc194b3IoZHN0LCBzcmMxLCBzcmMy
KSBcCi0JCQlfX25vZGVzX3hvcigmKGRzdCksICYoc3JjMSksICYoc3JjMiksIE1BWF9OVU1OT0RF
UykKLXN0YXRpYyBpbmxpbmUgdm9pZCBfX25vZGVzX3hvcihub2RlbWFza190ICpkc3RwLCBjb25z
dCBub2RlbWFza190ICpzcmMxcCwKLQkJCQkJY29uc3Qgbm9kZW1hc2tfdCAqc3JjMnAsIGludCBu
Yml0cykKK3N0YXRpYyBpbmxpbmUgdm9pZCBub2RlbWFza194b3Iobm9kZW1hc2tfdCAqZHN0LCBj
b25zdCBub2RlbWFza190ICpzcmMxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBub2RlbWFza190ICpzcmMyKQogewotCWJpdG1hcF94b3IoZHN0cC0+Yml0cywgc3JjMXAt
PmJpdHMsIHNyYzJwLT5iaXRzLCBuYml0cyk7CisgICAgYml0bWFwX3hvcihkc3QtPmJpdHMsIHNy
YzEtPmJpdHMsIHNyYzItPmJpdHMsIE1BWF9OVU1OT0RFUyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNf
YW5kbm90KGRzdCwgc3JjMSwgc3JjMikgXAotCQkJX19ub2Rlc19hbmRub3QoJihkc3QpLCAmKHNy
YzEpLCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIHZvaWQgX19ub2Rlc19h
bmRub3Qobm9kZW1hc2tfdCAqZHN0cCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCi0JCQkJCWNv
bnN0IG5vZGVtYXNrX3QgKnNyYzJwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIHZvaWQgbm9k
ZW1hc2tfYW5kbm90KG5vZGVtYXNrX3QgKmRzdCwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMikK
IHsKLQliaXRtYXBfYW5kbm90KGRzdHAtPmJpdHMsIHNyYzFwLT5iaXRzLCBzcmMycC0+Yml0cywg
bmJpdHMpOworICAgIGJpdG1hcF9hbmRub3QoZHN0LT5iaXRzLCBzcmMxLT5iaXRzLCBzcmMyLT5i
aXRzLCBNQVhfTlVNTk9ERVMpOwogfQogCi0jZGVmaW5lIG5vZGVzX2NvbXBsZW1lbnQoZHN0LCBz
cmMpIFwKLQkJCV9fbm9kZXNfY29tcGxlbWVudCgmKGRzdCksICYoc3JjKSwgTUFYX05VTU5PREVT
KQotc3RhdGljIGlubGluZSB2b2lkIF9fbm9kZXNfY29tcGxlbWVudChub2RlbWFza190ICpkc3Rw
LAotCQkJCQljb25zdCBub2RlbWFza190ICpzcmNwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5l
IHZvaWQgbm9kZW1hc2tfY29tcGxlbWVudChub2RlbWFza190ICpkc3QsIGNvbnN0IG5vZGVtYXNr
X3QgKnNyYykKIHsKLQliaXRtYXBfY29tcGxlbWVudChkc3RwLT5iaXRzLCBzcmNwLT5iaXRzLCBu
Yml0cyk7CisgICAgYml0bWFwX2NvbXBsZW1lbnQoZHN0LT5iaXRzLCBzcmMtPmJpdHMsIE1BWF9O
VU1OT0RFUyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNfZXF1YWwoc3JjMSwgc3JjMikgXAotCQkJX19u
b2Rlc19lcXVhbCgmKHNyYzEpLCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5l
IGludCBfX25vZGVzX2VxdWFsKGNvbnN0IG5vZGVtYXNrX3QgKnNyYzFwLAotCQkJCQljb25zdCBu
b2RlbWFza190ICpzcmMycCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSBib29sIG5vZGVtYXNr
X2VxdWFsKGNvbnN0IG5vZGVtYXNrX3QgKnNyYzEsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMikKIHsKLQlyZXR1cm4gYml0bWFwX2VxdWFs
KHNyYzFwLT5iaXRzLCBzcmMycC0+Yml0cywgbmJpdHMpOworICAgIHJldHVybiBiaXRtYXBfZXF1
YWwoc3JjMS0+Yml0cywgc3JjMi0+Yml0cywgTUFYX05VTU5PREVTKTsKIH0KIAotI2RlZmluZSBu
b2Rlc19pbnRlcnNlY3RzKHNyYzEsIHNyYzIpIFwKLQkJCV9fbm9kZXNfaW50ZXJzZWN0cygmKHNy
YzEpLCAmKHNyYzIpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIGludCBfX25vZGVzX2lu
dGVyc2VjdHMoY29uc3Qgbm9kZW1hc2tfdCAqc3JjMXAsCi0JCQkJCWNvbnN0IG5vZGVtYXNrX3Qg
KnNyYzJwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIGJvb2wgbm9kZW1hc2tfaW50ZXJzZWN0
cyhjb25zdCBub2RlbWFza190ICpzcmMxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3Qgbm9kZW1hc2tfdCAqc3JjMikKIHsKLQlyZXR1cm4gYml0bWFwX2ludGVy
c2VjdHMoc3JjMXAtPmJpdHMsIHNyYzJwLT5iaXRzLCBuYml0cyk7CisgICAgcmV0dXJuIGJpdG1h
cF9pbnRlcnNlY3RzKHNyYzEtPmJpdHMsIHNyYzItPmJpdHMsIE1BWF9OVU1OT0RFUyk7CiB9CiAK
LSNkZWZpbmUgbm9kZXNfc3Vic2V0KHNyYzEsIHNyYzIpIFwKLQkJCV9fbm9kZXNfc3Vic2V0KCYo
c3JjMSksICYoc3JjMiksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fbm9kZXNf
c3Vic2V0KGNvbnN0IG5vZGVtYXNrX3QgKnNyYzFwLAotCQkJCQljb25zdCBub2RlbWFza190ICpz
cmMycCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSBib29sIG5vZGVtYXNrX3N1YnNldChjb25z
dCBub2RlbWFza190ICpzcmMxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBub2RlbWFza190ICpzcmMyKQogewotCXJldHVybiBiaXRtYXBfc3Vic2V0KHNyYzFwLT5i
aXRzLCBzcmMycC0+Yml0cywgbmJpdHMpOworICAgIHJldHVybiBiaXRtYXBfc3Vic2V0KHNyYzEt
PmJpdHMsIHNyYzItPmJpdHMsIE1BWF9OVU1OT0RFUyk7CiB9CiAKLSNkZWZpbmUgbm9kZXNfZW1w
dHkoc3JjKSBfX25vZGVzX2VtcHR5KCYoc3JjKSwgTUFYX05VTU5PREVTKQotc3RhdGljIGlubGlu
ZSBpbnQgX19ub2Rlc19lbXB0eShjb25zdCBub2RlbWFza190ICpzcmNwLCBpbnQgbmJpdHMpCitz
dGF0aWMgaW5saW5lIGJvb2wgbm9kZW1hc2tfZW1wdHkoY29uc3Qgbm9kZW1hc2tfdCAqc3JjKQog
ewotCXJldHVybiBiaXRtYXBfZW1wdHkoc3JjcC0+Yml0cywgbmJpdHMpOworICAgIHJldHVybiBi
aXRtYXBfZW1wdHkoc3JjLT5iaXRzLCBNQVhfTlVNTk9ERVMpOwogfQogCi0jZGVmaW5lIG5vZGVz
X2Z1bGwobm9kZW1hc2spIF9fbm9kZXNfZnVsbCgmKG5vZGVtYXNrKSwgTUFYX05VTU5PREVTKQot
c3RhdGljIGlubGluZSBpbnQgX19ub2Rlc19mdWxsKGNvbnN0IG5vZGVtYXNrX3QgKnNyY3AsIGlu
dCBuYml0cykKK3N0YXRpYyBpbmxpbmUgYm9vbCBub2RlbWFza19mdWxsKGNvbnN0IG5vZGVtYXNr
X3QgKnNyYykKIHsKLQlyZXR1cm4gYml0bWFwX2Z1bGwoc3JjcC0+Yml0cywgbmJpdHMpOworICAg
IHJldHVybiBiaXRtYXBfZnVsbChzcmMtPmJpdHMsIE1BWF9OVU1OT0RFUyk7CiB9CiAKLSNkZWZp
bmUgbm9kZXNfd2VpZ2h0KG5vZGVtYXNrKSBfX25vZGVzX3dlaWdodCgmKG5vZGVtYXNrKSwgTUFY
X05VTU5PREVTKQotc3RhdGljIGlubGluZSBpbnQgX19ub2Rlc193ZWlnaHQoY29uc3Qgbm9kZW1h
c2tfdCAqc3JjcCwgaW50IG5iaXRzKQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgbm9kZW1h
c2tfd2VpZ2h0KGNvbnN0IG5vZGVtYXNrX3QgKnNyYykKIHsKLQlyZXR1cm4gYml0bWFwX3dlaWdo
dChzcmNwLT5iaXRzLCBuYml0cyk7CisgICAgcmV0dXJuIGJpdG1hcF93ZWlnaHQoc3JjLT5iaXRz
LCBNQVhfTlVNTk9ERVMpOwogfQogCiAvKiBGSVhNRTogYmV0dGVyIHdvdWxkIGJlIHRvIGZpeCBh
bGwgYXJjaGl0ZWN0dXJlcyB0byBuZXZlciByZXR1cm4KICAgICAgICAgICA+IE1BWF9OVU1OT0RF
UywgdGhlbiB0aGUgc2lsbHkgbWluX3RzIGNvdWxkIGJlIGRyb3BwZWQuICovCiAKLSNkZWZpbmUg
Zmlyc3Rfbm9kZShzcmMpIF9fZmlyc3Rfbm9kZSgmKHNyYyksIE1BWF9OVU1OT0RFUykKLXN0YXRp
YyBpbmxpbmUgaW50IF9fZmlyc3Rfbm9kZShjb25zdCBub2RlbWFza190ICpzcmNwLCBpbnQgbmJp
dHMpCitzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBub2RlbWFza19maXJzdChjb25zdCBub2Rl
bWFza190ICpzcmMpCiB7Ci0JcmV0dXJuIG1pbl90KGludCwgbmJpdHMsIGZpbmRfZmlyc3RfYml0
KHNyY3AtPmJpdHMsIG5iaXRzKSk7CisgICAgcmV0dXJuIG1pbl90KHVuc2lnbmVkIGludCwgTUFY
X05VTU5PREVTLAorICAgICAgICAgICAgICAgICBmaW5kX2ZpcnN0X2JpdChzcmMtPmJpdHMsIE1B
WF9OVU1OT0RFUykpOwogfQogCi0jZGVmaW5lIG5leHRfbm9kZShuLCBzcmMpIF9fbmV4dF9ub2Rl
KChuKSwgJihzcmMpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIGludCBfX25leHRfbm9k
ZShpbnQgbiwgY29uc3Qgbm9kZW1hc2tfdCAqc3JjcCwgaW50IG5iaXRzKQorc3RhdGljIGlubGlu
ZSB1bnNpZ25lZCBpbnQgbm9kZW1hc2tfbmV4dCh1bnNpZ25lZCBpbnQgbiwgY29uc3Qgbm9kZW1h
c2tfdCAqc3JjKQogewotCXJldHVybiBtaW5fdChpbnQsIG5iaXRzLCBmaW5kX25leHRfYml0KHNy
Y3AtPmJpdHMsIG5iaXRzLCBuKzEpKTsKKyAgICByZXR1cm4gbWluX3QodW5zaWduZWQgaW50LCBN
QVhfTlVNTk9ERVMsCisgICAgICAgICAgICAgICAgIGZpbmRfbmV4dF9iaXQoc3JjLT5iaXRzLCBN
QVhfTlVNTk9ERVMsIG4gKyAxKSk7CiB9CiAKLSNkZWZpbmUgbGFzdF9ub2RlKHNyYykgX19sYXN0
X25vZGUoJihzcmMpLCBNQVhfTlVNTk9ERVMpCi1zdGF0aWMgaW5saW5lIGludCBfX2xhc3Rfbm9k
ZShjb25zdCBub2RlbWFza190ICpzcmNwLCBpbnQgbmJpdHMpCitzdGF0aWMgaW5saW5lIHVuc2ln
bmVkIGludCBub2RlbWFza19sYXN0KGNvbnN0IG5vZGVtYXNrX3QgKnNyYykKIHsKLQlpbnQgbm9k
ZSwgcG5vZGUgPSBuYml0czsKLQlmb3IgKG5vZGUgPSBfX2ZpcnN0X25vZGUoc3JjcCwgbmJpdHMp
OwotCSAgICAgbm9kZSA8IG5iaXRzOwotCSAgICAgbm9kZSA9IF9fbmV4dF9ub2RlKG5vZGUsIHNy
Y3AsIG5iaXRzKSkKLQkJcG5vZGUgPSBub2RlOwotCXJldHVybiBwbm9kZTsKKyAgICB1bnNpZ25l
ZCBpbnQgbm9kZSwgcG5vZGUgPSBNQVhfTlVNTk9ERVM7CisKKyAgICBmb3IgKCBub2RlID0gbm9k
ZW1hc2tfZmlyc3Qoc3JjKTsKKyAgICAgICAgICBub2RlIDwgTUFYX05VTU5PREVTOyBub2RlID0g
bm9kZW1hc2tfbmV4dChub2RlLCBzcmMpICkKKyAgICAgICAgcG5vZGUgPSBub2RlOworCisgICAg
cmV0dXJuIHBub2RlOwogfQogCi0jZGVmaW5lIGN5Y2xlX25vZGUobiwgc3JjKSBfX2N5Y2xlX25v
ZGUoKG4pLCAmKHNyYyksIE1BWF9OVU1OT0RFUykKLXN0YXRpYyBpbmxpbmUgaW50IF9fY3ljbGVf
bm9kZShpbnQgbiwgY29uc3Qgbm9kZW1hc2tfdCAqbWFza3AsIGludCBuYml0cykKK3N0YXRpYyBp
bmxpbmUgdW5zaWduZWQgaW50IG5vZGVtYXNrX2N5Y2xlKHVuc2lnbmVkIGludCBuLCBjb25zdCBu
b2RlbWFza190ICpzcmMpCiB7Ci0gICAgaW50IG54dCA9IF9fbmV4dF9ub2RlKG4sIG1hc2twLCBu
Yml0cyk7CisgICAgdW5zaWduZWQgaW50IG54dCA9IG5vZGVtYXNrX25leHQobiwgc3JjKTsKKwor
ICAgIGlmICggbnh0ID09IE1BWF9OVU1OT0RFUyApCisgICAgICAgIG54dCA9IG5vZGVtYXNrX2Zp
cnN0KHNyYyk7CiAKLSAgICBpZiAobnh0ID09IG5iaXRzKQotICAgICAgICBueHQgPSBfX2ZpcnN0
X25vZGUobWFza3AsIG5iaXRzKTsKICAgICByZXR1cm4gbnh0OwogfQogCiAjaWYgTUFYX05VTU5P
REVTID4gMQogI2RlZmluZSBmb3JfZWFjaF9ub2RlX21hc2sobm9kZSwgbWFzaykJCQlcCi0JZm9y
ICgobm9kZSkgPSBmaXJzdF9ub2RlKG1hc2spOwkJCVwKKwlmb3IgKChub2RlKSA9IG5vZGVtYXNr
X2ZpcnN0KG1hc2spOwkJXAogCQkobm9kZSkgPCBNQVhfTlVNTk9ERVM7CQkJXAotCQkobm9kZSkg
PSBuZXh0X25vZGUoKG5vZGUpLCAobWFzaykpKQorCQkobm9kZSkgPSBub2RlbWFza19uZXh0KG5v
ZGUsIG1hc2spKQogI2Vsc2UgLyogTUFYX05VTU5PREVTID09IDEgKi8KICNkZWZpbmUgZm9yX2Vh
Y2hfbm9kZV9tYXNrKG5vZGUsIG1hc2spCQkJXAotCWlmICghbm9kZXNfZW1wdHkobWFzaykpCQkJ
CVwKKwlpZiAoICFub2RlbWFza19lbXB0eShtYXNrKSApCQkJXAogCQlmb3IgKChub2RlKSA9IDA7
IChub2RlKSA8IDE7IChub2RlKSsrKQogI2VuZGlmIC8qIE1BWF9OVU1OT0RFUyAqLwogCkBAIC0y
NjcsMTYgKzI0MywxNiBAQCBzdGF0aWMgaW5saW5lIGludCBfX2N5Y2xlX25vZGUoaW50IG4sIGNv
bnN0IG5vZGVtYXNrX3QgKm1hc2twLCBpbnQgbmJpdHMpCiBleHRlcm4gbm9kZW1hc2tfdCBub2Rl
X29ubGluZV9tYXA7CiAKICNpZiBNQVhfTlVNTk9ERVMgPiAxCi0jZGVmaW5lIG51bV9vbmxpbmVf
bm9kZXMoKQlub2Rlc193ZWlnaHQobm9kZV9vbmxpbmVfbWFwKQorI2RlZmluZSBudW1fb25saW5l
X25vZGVzKCkJbm9kZW1hc2tfd2VpZ2h0KCZub2RlX29ubGluZV9tYXApCiAjZGVmaW5lIG5vZGVf
b25saW5lKG5vZGUpCW5vZGVtYXNrX3Rlc3Qobm9kZSwgJm5vZGVfb25saW5lX21hcCkKICNlbHNl
Ci0jZGVmaW5lIG51bV9vbmxpbmVfbm9kZXMoKQkxCisjZGVmaW5lIG51bV9vbmxpbmVfbm9kZXMo
KQkxVQogI2RlZmluZSBub2RlX29ubGluZShub2RlKQkoKG5vZGUpID09IDApCiAjZW5kaWYKIAot
I2RlZmluZSBub2RlX3NldF9vbmxpbmUobm9kZSkJICAgc2V0X2JpdCgobm9kZSksIG5vZGVfb25s
aW5lX21hcC5iaXRzKQotI2RlZmluZSBub2RlX3NldF9vZmZsaW5lKG5vZGUpCSAgIGNsZWFyX2Jp
dCgobm9kZSksIG5vZGVfb25saW5lX21hcC5iaXRzKQorI2RlZmluZSBub2RlX3NldF9vbmxpbmUo
bm9kZSkJICAgc2V0X2JpdChub2RlLCBub2RlX29ubGluZV9tYXAuYml0cykKKyNkZWZpbmUgbm9k
ZV9zZXRfb2ZmbGluZShub2RlKQkgICBjbGVhcl9iaXQobm9kZSwgbm9kZV9vbmxpbmVfbWFwLmJp
dHMpCiAKLSNkZWZpbmUgZm9yX2VhY2hfb25saW5lX25vZGUobm9kZSkgZm9yX2VhY2hfbm9kZV9t
YXNrKChub2RlKSwgbm9kZV9vbmxpbmVfbWFwKQorI2RlZmluZSBmb3JfZWFjaF9vbmxpbmVfbm9k
ZShub2RlKSBmb3JfZWFjaF9ub2RlX21hc2sobm9kZSwgJm5vZGVfb25saW5lX21hcCkKIAogI2Vu
ZGlmIC8qIF9fTElOVVhfTk9ERU1BU0tfSCAqLwotLSAKMi4xMS4wCgoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApY
ZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

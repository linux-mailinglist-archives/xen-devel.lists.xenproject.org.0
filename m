Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 212CC2FD93
	for <lists+xen-devel@lfdr.de>; Thu, 30 May 2019 16:21:37 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hWLt3-0003BJ-JX; Thu, 30 May 2019 14:18:33 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Fq1a=T6=bitdefender.com=ppircalabu@srs-us1.protection.inumbo.net>)
 id 1hWLt2-00039p-IX
 for xen-devel@lists.xenproject.org; Thu, 30 May 2019 14:18:32 +0000
X-Inumbo-ID: cb2f78ac-82e5-11e9-9ed3-eb07dfe1e9cd
Received: from mx01.bbu.dsd.mx.bitdefender.com (unknown [91.199.104.161])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id cb2f78ac-82e5-11e9-9ed3-eb07dfe1e9cd;
 Thu, 30 May 2019 14:18:28 +0000 (UTC)
Received: from smtp.bitdefender.com (smtp02.buh.bitdefender.net [10.17.80.76])
 by mx01.bbu.dsd.mx.bitdefender.com (Postfix) with ESMTPS id
 A95CB305FFA7; Thu, 30 May 2019 17:18:25 +0300 (EEST)
Received: from bitdefender.com (unknown [195.189.155.70])
 by smtp.bitdefender.com (Postfix) with ESMTPSA id 96D393051E79;
 Thu, 30 May 2019 17:18:25 +0300 (EEST)
From: Petre Pircalabu <ppircalabu@bitdefender.com>
To: xen-devel@lists.xenproject.org
Date: Thu, 30 May 2019 17:18:21 +0300
Message-Id: <a0e4fc0480220df3499207b58883c5000002a56b.1559224640.git.ppircalabu@bitdefender.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <cover.1559224640.git.ppircalabu@bitdefender.com>
References: <cover.1559224640.git.ppircalabu@bitdefender.com>
In-Reply-To: <cover.1559224640.git.ppircalabu@bitdefender.com>
References: <cover.1559224640.git.ppircalabu@bitdefender.com>
Subject: [Xen-devel] [PATCH 7/9] vm_event: Decouple implementation details
 from interface.
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Petre Pircalabu <ppircalabu@bitdefender.com>,
 Tamas K Lengyel <tamas@tklengyel.com>,
 Razvan Cojocaru <rcojocaru@bitdefender.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VG8gYWNjb21tb2RhdGUgYSBzZWNvbmQgaW1wbGVtZW50YXRpb24gb2YgdGhlIHZtX2V2ZW50IHN1
YnN5c3RlbSwgdGhlCmN1cnJlbnQgb25lIChyaW5nKSBzaG91bGQgYmUgZGVjb3VwbGVkIGZyb20g
dGhlIHhlbi92bV9ldmVudC5oIGludGVyZmFjZS4KClNpZ25lZC1vZmYtYnk6IFBldHJlIFBpcmNh
bGFidSA8cHBpcmNhbGFidUBiaXRkZWZlbmRlci5jb20+Ci0tLQogeGVuL2NvbW1vbi92bV9ldmVu
dC5jICAgICAgfCA0MDcgKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCiB4ZW4vaW5jbHVkZS94ZW4vdm1fZXZlbnQuaCB8ICA1NiArKysrKystCiAyIGZpbGVzIGNo
YW5nZWQsIDI1MiBpbnNlcnRpb25zKCspLCAyMTEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
eGVuL2NvbW1vbi92bV9ldmVudC5jIGIveGVuL2NvbW1vbi92bV9ldmVudC5jCmluZGV4IDAyYzU4
NTMuLjFkODVmM2UgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vdm1fZXZlbnQuYworKysgYi94ZW4v
Y29tbW9uL3ZtX2V2ZW50LmMKQEAgLTM1LDE3ICszNSwxMyBAQAogI2RlZmluZSB4ZW5fcm1iKCkg
IHNtcF9ybWIoKQogI2RlZmluZSB4ZW5fd21iKCkgIHNtcF93bWIoKQogCi0jZGVmaW5lIHZtX2V2
ZW50X3JpbmdfbG9ja19pbml0KF92ZWQpICBzcGluX2xvY2tfaW5pdCgmKF92ZWQpLT5yaW5nX2xv
Y2spCi0jZGVmaW5lIHZtX2V2ZW50X3JpbmdfbG9jayhfdmVkKSAgICAgICBzcGluX2xvY2soJihf
dmVkKS0+cmluZ19sb2NrKQotI2RlZmluZSB2bV9ldmVudF9yaW5nX3VubG9jayhfdmVkKSAgICAg
c3Bpbl91bmxvY2soJihfdmVkKS0+cmluZ19sb2NrKQorI2RlZmluZSB0b19yaW5nKF92ZWQpIGNv
bnRhaW5lcl9vZigoX3ZlZCksIHN0cnVjdCB2bV9ldmVudF9yaW5nX2RvbWFpbiwgdmVkKQogCi0v
KiBWTSBldmVudCAqLwotc3RydWN0IHZtX2V2ZW50X2RvbWFpbgorLyogVk0gZXZlbnQgcmluZyBp
bXBsZW1lbnRhdGlvbiAqLworc3RydWN0IHZtX2V2ZW50X3JpbmdfZG9tYWluCiB7Ci0gICAgLyog
RG9tYWluIHJlZmVyZW5jZSAqLwotICAgIHN0cnVjdCBkb21haW4gKmQ7Ci0gICAgLyogcmluZyBs
b2NrICovCi0gICAgc3BpbmxvY2tfdCByaW5nX2xvY2s7CisgICAgLyogVk0gZXZlbnQgZG9tYWlu
ICovCisgICAgc3RydWN0IHZtX2V2ZW50X2RvbWFpbiB2ZWQ7CiAgICAgLyogVGhlIHJpbmcgaGFz
IDY0IGVudHJpZXMgKi8KICAgICB1bnNpZ25lZCBjaGFyIGZvcmVpZ25fcHJvZHVjZXJzOwogICAg
IHVuc2lnbmVkIGNoYXIgdGFyZ2V0X3Byb2R1Y2VyczsKQEAgLTU2LDggKzUyLDYgQEAgc3RydWN0
IHZtX2V2ZW50X2RvbWFpbgogICAgIHZtX2V2ZW50X2Zyb250X3JpbmdfdCBmcm9udF9yaW5nOwog
ICAgIC8qIGV2ZW50IGNoYW5uZWwgcG9ydCAodmNwdTAgb25seSkgKi8KICAgICBpbnQgeGVuX3Bv
cnQ7Ci0gICAgLyogdm1fZXZlbnQgYml0IGZvciB2Y3B1LT5wYXVzZV9mbGFncyAqLwotICAgIGlu
dCBwYXVzZV9mbGFnOwogICAgIC8qIGxpc3Qgb2YgdmNwdXMgd2FpdGluZyBmb3Igcm9vbSBpbiB0
aGUgcmluZyAqLwogICAgIHN0cnVjdCB3YWl0cXVldWVfaGVhZCB3cTsKICAgICAvKiB0aGUgbnVt
YmVyIG9mIHZDUFVzIGJsb2NrZWQgKi8KQEAgLTY2LDQ4ICs2MCw1NCBAQCBzdHJ1Y3Qgdm1fZXZl
bnRfZG9tYWluCiAgICAgdW5zaWduZWQgaW50IGxhc3RfdmNwdV93YWtlX3VwOwogfTsKIAotc3Rh
dGljIGludCB2bV9ldmVudF9lbmFibGUoCitzdGF0aWMgY29uc3Qgc3RydWN0IHZtX2V2ZW50X29w
cyB2bV9ldmVudF9yaW5nX29wczsKKworc3RhdGljIGludCB2bV9ldmVudF9yaW5nX2VuYWJsZSgK
ICAgICBzdHJ1Y3QgZG9tYWluICpkLAogICAgIHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29w
ICp2ZWMsCi0gICAgc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqKnZlZCwKKyAgICBzdHJ1Y3Qgdm1f
ZXZlbnRfZG9tYWluICoqX3ZlZCwKICAgICBpbnQgcGF1c2VfZmxhZywKICAgICBpbnQgcGFyYW0s
CiAgICAgeGVuX2V2ZW50X2NoYW5uZWxfbm90aWZpY2F0aW9uX3Qgbm90aWZpY2F0aW9uX2ZuKQog
ewogICAgIGludCByYzsKICAgICB1bnNpZ25lZCBsb25nIHJpbmdfZ2ZuID0gZC0+YXJjaC5odm0u
cGFyYW1zW3BhcmFtXTsKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGw7CiAK
LSAgICBpZiAoICEqdmVkICkKLSAgICAgICAgKnZlZCA9IHh6YWxsb2Moc3RydWN0IHZtX2V2ZW50
X2RvbWFpbik7Ci0gICAgaWYgKCAhKnZlZCApCisgICAgaW1wbCA9ICgqX3ZlZCkgPyB0b19yaW5n
KCpfdmVkKSA6CisgICAgICAgICAgICB4emFsbG9jKHN0cnVjdCB2bV9ldmVudF9yaW5nX2RvbWFp
bik7CisgICAgaWYgKCAhaW1wbCApCiAgICAgICAgIHJldHVybiAtRU5PTUVNOwogCiAgICAgLyog
T25seSBvbmUgaGVscGVyIGF0IGEgdGltZS4gSWYgdGhlIGhlbHBlciBjcmFzaGVkLAogICAgICAq
IHRoZSByaW5nIGlzIGluIGFuIHVuZGVmaW5lZCBzdGF0ZSBhbmQgc28gaXMgdGhlIGd1ZXN0Lgog
ICAgICAqLwotICAgIGlmICggKCp2ZWQpLT5yaW5nX3BhZ2UgKQotICAgICAgICByZXR1cm4gLUVC
VVNZOzsKKyAgICBpZiAoIGltcGwtPnJpbmdfcGFnZSApCisgICAgICAgIHJldHVybiAtRUJVU1k7
CiAKICAgICAvKiBUaGUgcGFyYW1ldGVyIGRlZmF1bHRzIHRvIHplcm8sIGFuZCBpdCBzaG91bGQg
YmUKICAgICAgKiBzZXQgdG8gc29tZXRoaW5nICovCiAgICAgaWYgKCByaW5nX2dmbiA9PSAwICkK
ICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOwogCi0gICAgdm1fZXZlbnRfcmluZ19sb2NrX2lu
aXQoKnZlZCk7Ci0gICAgdm1fZXZlbnRfcmluZ19sb2NrKCp2ZWQpOworICAgIHNwaW5fbG9ja19p
bml0KCZpbXBsLT52ZWQubG9jayk7CisgICAgc3Bpbl9sb2NrKCZpbXBsLT52ZWQubG9jayk7CiAK
ICAgICByYyA9IHZtX2V2ZW50X2luaXRfZG9tYWluKGQpOwogCiAgICAgaWYgKCByYyA8IDAgKQog
ICAgICAgICBnb3RvIGVycjsKIAotICAgIHJjID0gcHJlcGFyZV9yaW5nX2Zvcl9oZWxwZXIoZCwg
cmluZ19nZm4sICYoKnZlZCktPnJpbmdfcGdfc3RydWN0LAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJigqdmVkKS0+cmluZ19wYWdlKTsKKyAgICBpbXBsLT52ZWQuZCA9IGQ7Cisg
ICAgaW1wbC0+dmVkLm9wcyA9ICZ2bV9ldmVudF9yaW5nX29wczsKKworICAgIHJjID0gcHJlcGFy
ZV9yaW5nX2Zvcl9oZWxwZXIoZCwgcmluZ19nZm4sICZpbXBsLT5yaW5nX3BnX3N0cnVjdCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZpbXBsLT5yaW5nX3BhZ2UpOwogICAgIGlm
ICggcmMgPCAwICkKICAgICAgICAgZ290byBlcnI7CiAKICAgICAvKiBTZXQgdGhlIG51bWJlciBv
ZiBjdXJyZW50bHkgYmxvY2tlZCB2Q1BVcyB0byAwLiAqLwotICAgICgqdmVkKS0+YmxvY2tlZCA9
IDA7CisgICAgaW1wbC0+YmxvY2tlZCA9IDA7CiAKICAgICAvKiBBbGxvY2F0ZSBldmVudCBjaGFu
bmVsICovCiAgICAgcmMgPSBhbGxvY191bmJvdW5kX3hlbl9ldmVudF9jaGFubmVsKGQsIDAsIGN1
cnJlbnQtPmRvbWFpbi0+ZG9tYWluX2lkLApAQCAtMTE1LDM3ICsxMTUsMzcgQEAgc3RhdGljIGlu
dCB2bV9ldmVudF9lbmFibGUoCiAgICAgaWYgKCByYyA8IDAgKQogICAgICAgICBnb3RvIGVycjsK
IAotICAgICgqdmVkKS0+eGVuX3BvcnQgPSB2ZWMtPnUuZW5hYmxlLnBvcnQgPSByYzsKKyAgICBp
bXBsLT54ZW5fcG9ydCA9IHZlYy0+dS5lbmFibGUucG9ydCA9IHJjOwogCiAgICAgLyogUHJlcGFy
ZSByaW5nIGJ1ZmZlciAqLwotICAgIEZST05UX1JJTkdfSU5JVCgmKCp2ZWQpLT5mcm9udF9yaW5n
LAotICAgICAgICAgICAgICAgICAgICAodm1fZXZlbnRfc3JpbmdfdCAqKSgqdmVkKS0+cmluZ19w
YWdlLAorICAgIEZST05UX1JJTkdfSU5JVCgmaW1wbC0+ZnJvbnRfcmluZywKKyAgICAgICAgICAg
ICAgICAgICAgKHZtX2V2ZW50X3NyaW5nX3QgKilpbXBsLT5yaW5nX3BhZ2UsCiAgICAgICAgICAg
ICAgICAgICAgIFBBR0VfU0laRSk7CiAKICAgICAvKiBTYXZlIHRoZSBwYXVzZSBmbGFnIGZvciB0
aGlzIHBhcnRpY3VsYXIgcmluZy4gKi8KLSAgICAoKnZlZCktPnBhdXNlX2ZsYWcgPSBwYXVzZV9m
bGFnOworICAgIGltcGwtPnZlZC5wYXVzZV9mbGFnID0gcGF1c2VfZmxhZzsKIAogICAgIC8qIElu
aXRpYWxpemUgdGhlIGxhc3QtY2hhbmNlIHdhaXQgcXVldWUuICovCi0gICAgaW5pdF93YWl0cXVl
dWVfaGVhZCgmKCp2ZWQpLT53cSk7CisgICAgaW5pdF93YWl0cXVldWVfaGVhZCgmaW1wbC0+d3Ep
OwogCi0gICAgdm1fZXZlbnRfcmluZ191bmxvY2soKnZlZCk7CisgICAgc3Bpbl91bmxvY2soJmlt
cGwtPnZlZC5sb2NrKTsKKyAgICAqX3ZlZCA9ICZpbXBsLT52ZWQ7CiAgICAgcmV0dXJuIDA7CiAK
ICBlcnI6Ci0gICAgZGVzdHJveV9yaW5nX2Zvcl9oZWxwZXIoJigqdmVkKS0+cmluZ19wYWdlLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICgqdmVkKS0+cmluZ19wZ19zdHJ1Y3QpOwotICAg
IHZtX2V2ZW50X3JpbmdfdW5sb2NrKCp2ZWQpOwotICAgIHhmcmVlKCp2ZWQpOwotICAgICp2ZWQg
PSBOVUxMOworICAgIGRlc3Ryb3lfcmluZ19mb3JfaGVscGVyKCZpbXBsLT5yaW5nX3BhZ2UsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1wbC0+cmluZ19wZ19zdHJ1Y3QpOworICAgIHNw
aW5fdW5sb2NrKCZpbXBsLT52ZWQubG9jayk7CisgICAgWEZSRUUoaW1wbCk7CiAKICAgICByZXR1
cm4gcmM7CiB9CiAKLXN0YXRpYyB1bnNpZ25lZCBpbnQgdm1fZXZlbnRfcmluZ19hdmFpbGFibGUo
c3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKQorc3RhdGljIHVuc2lnbmVkIGludCB2bV9ldmVu
dF9yaW5nX2F2YWlsYWJsZShzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwpCiB7Ci0g
ICAgaW50IGF2YWlsX3JlcSA9IFJJTkdfRlJFRV9SRVFVRVNUUygmdmVkLT5mcm9udF9yaW5nKTsK
LSAgICBhdmFpbF9yZXEgLT0gdmVkLT50YXJnZXRfcHJvZHVjZXJzOwotICAgIGF2YWlsX3JlcSAt
PSB2ZWQtPmZvcmVpZ25fcHJvZHVjZXJzOworICAgIGludCBhdmFpbF9yZXEgPSBSSU5HX0ZSRUVf
UkVRVUVTVFMoJmltcGwtPmZyb250X3JpbmcpOworICAgIGF2YWlsX3JlcSAtPSBpbXBsLT50YXJn
ZXRfcHJvZHVjZXJzOworICAgIGF2YWlsX3JlcSAtPSBpbXBsLT5mb3JlaWduX3Byb2R1Y2VyczsK
IAogICAgIEJVR19PTihhdmFpbF9yZXEgPCAwKTsKIApAQCAtMTUzLDQyICsxNTMsNDIgQEAgc3Rh
dGljIHVuc2lnbmVkIGludCB2bV9ldmVudF9yaW5nX2F2YWlsYWJsZShzdHJ1Y3Qgdm1fZXZlbnRf
ZG9tYWluICp2ZWQpCiB9CiAKIC8qCi0gKiB2bV9ldmVudF93YWtlX2Jsb2NrZWQoKSB3aWxsIHdh
a2V1cCB2Y3B1cyB3YWl0aW5nIGZvciByb29tIGluIHRoZQorICogdm1fZXZlbnRfcmluZ193YWtl
X2Jsb2NrZWQoKSB3aWxsIHdha2V1cCB2Y3B1cyB3YWl0aW5nIGZvciByb29tIGluIHRoZQogICog
cmluZy4gVGhlc2UgdkNQVXMgd2VyZSBwYXVzZWQgb24gdGhlaXIgd2F5IG91dCBhZnRlciBwbGFj
aW5nIGFuIGV2ZW50LAogICogYnV0IG5lZWQgdG8gYmUgcmVzdW1lZCB3aGVyZSB0aGUgcmluZyBp
cyBjYXBhYmxlIG9mIHByb2Nlc3NpbmcgYXQgbGVhc3QKICAqIG9uZSBldmVudCBmcm9tIHRoZW0u
CiAgKi8KLXN0YXRpYyB2b2lkIHZtX2V2ZW50X3dha2VfYmxvY2tlZChzdHJ1Y3Qgdm1fZXZlbnRf
ZG9tYWluICp2ZWQpCitzdGF0aWMgdm9pZCB2bV9ldmVudF9yaW5nX3dha2VfYmxvY2tlZChzdHJ1
Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwpCiB7CiAgICAgc3RydWN0IHZjcHUgKnY7Ci0g
ICAgdW5zaWduZWQgaW50IGF2YWlsX3JlcSA9IHZtX2V2ZW50X3JpbmdfYXZhaWxhYmxlKHZlZCk7
Ci0gICAgc3RydWN0IGRvbWFpbiAqZCA9IHZlZC0+ZDsKKyAgICB1bnNpZ25lZCBpbnQgYXZhaWxf
cmVxID0gdm1fZXZlbnRfcmluZ19hdmFpbGFibGUoaW1wbCk7CiAKLSAgICBpZiAoIGF2YWlsX3Jl
cSA9PSAwIHx8IHZlZC0+YmxvY2tlZCA9PSAwICkKKyAgICBpZiAoIGF2YWlsX3JlcSA9PSAwIHx8
IGltcGwtPmJsb2NrZWQgPT0gMCApCiAgICAgICAgIHJldHVybjsKIAogICAgIC8qIFdlIHJlbWVt
YmVyIHdoaWNoIHZjcHUgbGFzdCB3b2tlIHVwIHRvIGF2b2lkIHNjYW5uaW5nIGFsd2F5cyBsaW5l
YXJseQogICAgICAqIGZyb20gemVybyBhbmQgc3RhcnZpbmcgaGlnaGVyLW51bWJlcmVkIHZjcHVz
IHVuZGVyIGhpZ2ggbG9hZCAqLwotICAgIGlmICggZC0+dmNwdSApCisgICAgaWYgKCBpbXBsLT52
ZWQuZC0+dmNwdSApCiAgICAgewogICAgICAgICBpbnQgaSwgaiwgazsKIAotICAgICAgICBmb3Ig
KGkgPSB2ZWQtPmxhc3RfdmNwdV93YWtlX3VwICsgMSwgaiA9IDA7IGogPCBkLT5tYXhfdmNwdXM7
IGkrKywgaisrKQorICAgICAgICBmb3IgKCBpID0gaW1wbC0+bGFzdF92Y3B1X3dha2VfdXAgKyAx
LCBqID0gMDsKKyAgICAgICAgICAgICAgaiA8IGltcGwtPnZlZC5kLT5tYXhfdmNwdXM7IGkrKywg
aisrKQogICAgICAgICB7Ci0gICAgICAgICAgICBrID0gaSAlIGQtPm1heF92Y3B1czsKLSAgICAg
ICAgICAgIHYgPSBkLT52Y3B1W2tdOworICAgICAgICAgICAgayA9IGkgJSBpbXBsLT52ZWQuZC0+
bWF4X3ZjcHVzOworICAgICAgICAgICAgdiA9IGltcGwtPnZlZC5kLT52Y3B1W2tdOwogICAgICAg
ICAgICAgaWYgKCAhdiApCiAgICAgICAgICAgICAgICAgY29udGludWU7CiAKLSAgICAgICAgICAg
IGlmICggISh2ZWQtPmJsb2NrZWQpIHx8IGF2YWlsX3JlcSA9PSAwICkKKyAgICAgICAgICAgIGlm
ICggIShpbXBsLT5ibG9ja2VkKSB8fCBhdmFpbF9yZXEgPT0gMCApCiAgICAgICAgICAgICAgICBi
cmVhazsKIAotICAgICAgICAgICAgaWYgKCB0ZXN0X2FuZF9jbGVhcl9iaXQodmVkLT5wYXVzZV9m
bGFnLCAmdi0+cGF1c2VfZmxhZ3MpICkKKyAgICAgICAgICAgIGlmICggdGVzdF9hbmRfY2xlYXJf
Yml0KGltcGwtPnZlZC5wYXVzZV9mbGFnLCAmdi0+cGF1c2VfZmxhZ3MpICkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICB2Y3B1X3VucGF1c2Uodik7CiAgICAgICAgICAgICAgICAgYXZh
aWxfcmVxLS07Ci0gICAgICAgICAgICAgICAgdmVkLT5ibG9ja2VkLS07Ci0gICAgICAgICAgICAg
ICAgdmVkLT5sYXN0X3ZjcHVfd2FrZV91cCA9IGs7CisgICAgICAgICAgICAgICAgaW1wbC0+Ymxv
Y2tlZC0tOworICAgICAgICAgICAgICAgIGltcGwtPmxhc3RfdmNwdV93YWtlX3VwID0gazsKICAg
ICAgICAgICAgIH0KICAgICAgICAgfQogICAgIH0KQEAgLTE5OSw5MiArMTk5LDkwIEBAIHN0YXRp
YyB2b2lkIHZtX2V2ZW50X3dha2VfYmxvY2tlZChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQp
CiAgKiB3YXMgdW5hYmxlIHRvIGRvIHNvLCBpdCBpcyBxdWV1ZWQgb24gYSB3YWl0IHF1ZXVlLiAg
VGhlc2UgYXJlIHdva2VuIGFzCiAgKiBuZWVkZWQsIGFuZCB0YWtlIHByZWNlZGVuY2Ugb3ZlciB0
aGUgYmxvY2tlZCB2Q1BVcy4KICAqLwotc3RhdGljIHZvaWQgdm1fZXZlbnRfd2FrZV9xdWV1ZWQo
c3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKQorc3RhdGljIHZvaWQgdm1fZXZlbnRfcmluZ193
YWtlX3F1ZXVlZChzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwpCiB7Ci0gICAgdW5z
aWduZWQgaW50IGF2YWlsX3JlcSA9IHZtX2V2ZW50X3JpbmdfYXZhaWxhYmxlKHZlZCk7CisgICAg
dW5zaWduZWQgaW50IGF2YWlsX3JlcSA9IHZtX2V2ZW50X3JpbmdfYXZhaWxhYmxlKGltcGwpOwog
CiAgICAgaWYgKCBhdmFpbF9yZXEgPiAwICkKLSAgICAgICAgd2FrZV91cF9ucigmdmVkLT53cSwg
YXZhaWxfcmVxKTsKKyAgICAgICAgd2FrZV91cF9ucigmaW1wbC0+d3EsIGF2YWlsX3JlcSk7CiB9
CiAKIC8qCi0gKiB2bV9ldmVudF93YWtlKCkgd2lsbCB3YWtldXAgYWxsIHZjcHVzIHdhaXRpbmcg
Zm9yIHRoZSByaW5nIHRvCisgKiB2bV9ldmVudF9yaW5nX3dha2UoKSB3aWxsIHdha2V1cCBhbGwg
dmNwdXMgd2FpdGluZyBmb3IgdGhlIHJpbmcgdG8KICAqIGJlY29tZSBhdmFpbGFibGUuICBJZiB3
ZSBoYXZlIHF1ZXVlZCB2Q1BVcywgdGhleSBnZXQgdG9wIHByaW9yaXR5LiBXZQogICogYXJlIGd1
YXJhbnRlZWQgdGhhdCB0aGV5IHdpbGwgZ28gdGhyb3VnaCBjb2RlIHBhdGhzIHRoYXQgd2lsbCBl
dmVudHVhbGx5Ci0gKiBjYWxsIHZtX2V2ZW50X3dha2UoKSBhZ2FpbiwgZW5zdXJpbmcgdGhhdCBh
bnkgYmxvY2tlZCB2Q1BVcyB3aWxsIGdldAorICogY2FsbCB2bV9ldmVudF9yaW5nX3dha2UoKSBh
Z2FpbiwgZW5zdXJpbmcgdGhhdCBhbnkgYmxvY2tlZCB2Q1BVcyB3aWxsIGdldAogICogdW5wYXVz
ZWQgb25jZSBhbGwgdGhlIHF1ZXVlZCB2Q1BVcyBoYXZlIG1hZGUgaXQgdGhyb3VnaC4KICAqLwot
dm9pZCB2bV9ldmVudF93YWtlKHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKK3N0YXRpYyB2
b2lkIHZtX2V2ZW50X3Jpbmdfd2FrZShzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwp
CiB7Ci0gICAgaWYgKCFsaXN0X2VtcHR5KCZ2ZWQtPndxLmxpc3QpKQotICAgICAgICB2bV9ldmVu
dF93YWtlX3F1ZXVlZCh2ZWQpOworICAgIGlmICggIWxpc3RfZW1wdHkoJmltcGwtPndxLmxpc3Qp
ICkKKyAgICAgICAgdm1fZXZlbnRfcmluZ193YWtlX3F1ZXVlZChpbXBsKTsKICAgICBlbHNlCi0g
ICAgICAgIHZtX2V2ZW50X3dha2VfYmxvY2tlZCh2ZWQpOworICAgICAgICB2bV9ldmVudF9yaW5n
X3dha2VfYmxvY2tlZChpbXBsKTsKIH0KIAotc3RhdGljIGludCB2bV9ldmVudF9kaXNhYmxlKHN0
cnVjdCBkb21haW4gKmQsIHN0cnVjdCB2bV9ldmVudF9kb21haW4gKip2ZWQpCitzdGF0aWMgaW50
IHZtX2V2ZW50X3JpbmdfZGlzYWJsZShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICoqX3ZlZCkKIHsK
LSAgICBpZiAoIHZtX2V2ZW50X2NoZWNrKCp2ZWQpICkKLSAgICB7Ci0gICAgICAgIHN0cnVjdCB2
Y3B1ICp2OworICAgIHN0cnVjdCB2Y3B1ICp2OworICAgIHN0cnVjdCBkb21haW4gKmQgPSAoKl92
ZWQpLT5kOworICAgIHN0cnVjdCB2bV9ldmVudF9yaW5nX2RvbWFpbiAqaW1wbCA9IHRvX3Jpbmco
Kl92ZWQpOwogCi0gICAgICAgIHZtX2V2ZW50X3JpbmdfbG9jaygqdmVkKTsKKyAgICBzcGluX2xv
Y2soJigqX3ZlZCktPmxvY2spOwogCi0gICAgICAgIGlmICggIWxpc3RfZW1wdHkoJigqdmVkKS0+
d3EubGlzdCkgKQotICAgICAgICB7Ci0gICAgICAgICAgICB2bV9ldmVudF9yaW5nX3VubG9jaygq
dmVkKTsKLSAgICAgICAgICAgIHJldHVybiAtRUJVU1k7Ci0gICAgICAgIH0KKyAgICBpZiAoICFs
aXN0X2VtcHR5KCZpbXBsLT53cS5saXN0KSApCisgICAgeworICAgICAgICBzcGluX3VubG9jaygm
KCpfdmVkKS0+bG9jayk7CisgICAgICAgIHJldHVybiAtRUJVU1k7CisgICAgfQogCi0gICAgICAg
IC8qIEZyZWUgZG9tVSdzIGV2ZW50IGNoYW5uZWwgYW5kIGxlYXZlIHRoZSBvdGhlciBvbmUgdW5i
b3VuZCAqLwotICAgICAgICBmcmVlX3hlbl9ldmVudF9jaGFubmVsKGQsICgqdmVkKS0+eGVuX3Bv
cnQpOworICAgIC8qIEZyZWUgZG9tVSdzIGV2ZW50IGNoYW5uZWwgYW5kIGxlYXZlIHRoZSBvdGhl
ciBvbmUgdW5ib3VuZCAqLworICAgIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoZCwgaW1wbC0+eGVu
X3BvcnQpOwogCi0gICAgICAgIC8qIFVuYmxvY2sgYWxsIHZDUFVzICovCi0gICAgICAgIGZvcl9l
YWNoX3ZjcHUgKCBkLCB2ICkKKyAgICAvKiBVbmJsb2NrIGFsbCB2Q1BVcyAqLworICAgIGZvcl9l
YWNoX3ZjcHUgKCBkLCB2ICkKKyAgICB7CisgICAgICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0
KCgqX3ZlZCktPnBhdXNlX2ZsYWcsICZ2LT5wYXVzZV9mbGFncykgKQogICAgICAgICB7Ci0gICAg
ICAgICAgICBpZiAoIHRlc3RfYW5kX2NsZWFyX2JpdCgoKnZlZCktPnBhdXNlX2ZsYWcsICZ2LT5w
YXVzZV9mbGFncykgKQotICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIHZjcHVfdW5wYXVz
ZSh2KTsKLSAgICAgICAgICAgICAgICAoKnZlZCktPmJsb2NrZWQtLTsKLSAgICAgICAgICAgIH0K
KyAgICAgICAgICAgIHZjcHVfdW5wYXVzZSh2KTsKKyAgICAgICAgICAgIGltcGwtPmJsb2NrZWQt
LTsKICAgICAgICAgfQorICAgIH0KIAotICAgICAgICBkZXN0cm95X3JpbmdfZm9yX2hlbHBlcigm
KCp2ZWQpLT5yaW5nX3BhZ2UsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgqdmVk
KS0+cmluZ19wZ19zdHJ1Y3QpOwotCi0gICAgICAgIHZtX2V2ZW50X2NsZWFudXBfZG9tYWluKGQp
OworICAgIGRlc3Ryb3lfcmluZ19mb3JfaGVscGVyKCZpbXBsLT5yaW5nX3BhZ2UsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW1wbC0+cmluZ19wZ19zdHJ1Y3QpOwogCi0gICAgICAgIHZt
X2V2ZW50X3JpbmdfdW5sb2NrKCp2ZWQpOwotICAgIH0KKyAgICB2bV9ldmVudF9jbGVhbnVwX2Rv
bWFpbihkKTsKIAotICAgIHhmcmVlKCp2ZWQpOwotICAgICp2ZWQgPSBOVUxMOworICAgIHNwaW5f
dW5sb2NrKCYoKl92ZWQpLT5sb2NrKTsKIAorICAgIFhGUkVFKCpfdmVkKTsKICAgICByZXR1cm4g
MDsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHZtX2V2ZW50X3JlbGVhc2Vfc2xvdChzdHJ1Y3Qg
dm1fZXZlbnRfZG9tYWluICp2ZWQpCitzdGF0aWMgaW5saW5lIHZvaWQgdm1fZXZlbnRfcmluZ19y
ZWxlYXNlX3Nsb3Qoc3RydWN0IHZtX2V2ZW50X3JpbmdfZG9tYWluICppbXBsKQogewogICAgIC8q
IFVwZGF0ZSB0aGUgYWNjb3VudGluZyAqLwotICAgIGlmICggY3VycmVudC0+ZG9tYWluID09IHZl
ZC0+ZCApCi0gICAgICAgIHZlZC0+dGFyZ2V0X3Byb2R1Y2Vycy0tOworICAgIGlmICggY3VycmVu
dC0+ZG9tYWluID09IGltcGwtPnZlZC5kICkKKyAgICAgICAgaW1wbC0+dGFyZ2V0X3Byb2R1Y2Vy
cy0tOwogICAgIGVsc2UKLSAgICAgICAgdmVkLT5mb3JlaWduX3Byb2R1Y2Vycy0tOworICAgICAg
ICBpbXBsLT5mb3JlaWduX3Byb2R1Y2Vycy0tOwogCiAgICAgLyogS2ljayBhbnkgd2FpdGVycyAq
LwotICAgIHZtX2V2ZW50X3dha2UodmVkKTsKKyAgICB2bV9ldmVudF9yaW5nX3dha2UoaW1wbCk7
CiB9CiAKIC8qCi0gKiB2bV9ldmVudF9tYXJrX2FuZF9wYXVzZSgpIHRhZ3MgdmNwdSBhbmQgcHV0
IGl0IHRvIHNsZWVwLgotICogVGhlIHZjcHUgd2lsbCByZXN1bWUgZXhlY3V0aW9uIGluIHZtX2V2
ZW50X3dha2VfYmxvY2tlZCgpLgorICogdm1fZXZlbnRfcmluZ19tYXJrX2FuZF9wYXVzZSgpIHRh
Z3MgdmNwdSBhbmQgcHV0IGl0IHRvIHNsZWVwLgorICogVGhlIHZjcHUgd2lsbCByZXN1bWUgZXhl
Y3V0aW9uIGluIHZtX2V2ZW50X3Jpbmdfd2FrZV9ibG9ja2VkKCkuCiAgKi8KLXN0YXRpYyB2b2lk
IHZtX2V2ZW50X21hcmtfYW5kX3BhdXNlKHN0cnVjdCB2Y3B1ICp2LCBzdHJ1Y3Qgdm1fZXZlbnRf
ZG9tYWluICp2ZWQpCitzdGF0aWMgdm9pZCB2bV9ldmVudF9yaW5nX21hcmtfYW5kX3BhdXNlKHN0
cnVjdCB2Y3B1ICp2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGwpCiB7Ci0gICAgaWYgKCAhdGVzdF9hbmRf
c2V0X2JpdCh2ZWQtPnBhdXNlX2ZsYWcsICZ2LT5wYXVzZV9mbGFncykgKQorICAgIGlmICggIXRl
c3RfYW5kX3NldF9iaXQoaW1wbC0+dmVkLnBhdXNlX2ZsYWcsICZ2LT5wYXVzZV9mbGFncykgKQog
ICAgIHsKICAgICAgICAgdmNwdV9wYXVzZV9ub3N5bmModik7Ci0gICAgICAgIHZlZC0+YmxvY2tl
ZCsrOworICAgICAgICBpbXBsLT5ibG9ja2VkKys7CiAgICAgfQogfQogCkBAIC0yOTQsMzUgKzI5
MiwzMiBAQCBzdGF0aWMgdm9pZCB2bV9ldmVudF9tYXJrX2FuZF9wYXVzZShzdHJ1Y3QgdmNwdSAq
diwgc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKQogICogb3Zlcmx5IGZ1bGwgYW5kIGl0cyBj
b250aW51ZWQgZXhlY3V0aW9uIHdvdWxkIGNhdXNlIHN0YWxsaW5nIGFuZCBleGNlc3NpdmUKICAq
IHdhaXRpbmcuICBUaGUgdkNQVSB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgdW5wYXVzZWQgd2hlbiB0
aGUgcmluZyBjbGVhcnMuCiAgKi8KLXZvaWQgdm1fZXZlbnRfcHV0X3JlcXVlc3Qoc3RydWN0IHZt
X2V2ZW50X2RvbWFpbiAqdmVkLAotICAgICAgICAgICAgICAgICAgICAgICAgICB2bV9ldmVudF9y
ZXF1ZXN0X3QgKnJlcSkKK3N0YXRpYyB2b2lkIHZtX2V2ZW50X3JpbmdfcHV0X3JlcXVlc3Qoc3Ry
dWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2bV9ldmVudF9yZXF1ZXN0X3QgKnJlcSkKIHsKICAgICB2bV9ldmVudF9mcm9udF9y
aW5nX3QgKmZyb250X3Jpbmc7CiAgICAgaW50IGZyZWVfcmVxOwogICAgIHVuc2lnbmVkIGludCBh
dmFpbF9yZXE7CiAgICAgUklOR19JRFggcmVxX3Byb2Q7CiAgICAgc3RydWN0IHZjcHUgKmN1cnIg
PSBjdXJyZW50OwotICAgIHN0cnVjdCBkb21haW4gKmQgPSB2ZWQtPmQ7Ci0KLSAgICBpZiggIXZt
X2V2ZW50X2NoZWNrKHZlZCkpCi0gICAgICAgIHJldHVybjsKKyAgICBzdHJ1Y3Qgdm1fZXZlbnRf
cmluZ19kb21haW4gKmltcGwgPSB0b19yaW5nKHZlZCk7CiAKLSAgICBpZiAoIGN1cnItPmRvbWFp
biAhPSBkICkKKyAgICBpZiAoIGN1cnItPmRvbWFpbiAhPSB2ZWQtPmQgKQogICAgIHsKICAgICAg
ICAgcmVxLT5mbGFncyB8PSBWTV9FVkVOVF9GTEFHX0ZPUkVJR047CiAjaWZuZGVmIE5ERUJVRwog
ICAgICAgICBpZiAoICEocmVxLT5mbGFncyAmIFZNX0VWRU5UX0ZMQUdfVkNQVV9QQVVTRUQpICkK
ICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19HX1dBUk5JTkcsICJkJWR2JWQgd2FzIG5vdCBw
YXVzZWQuXG4iLAotICAgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCByZXEtPnZjcHVf
aWQpOworICAgICAgICAgICAgICAgICAgICAgdmVkLT5kLT5kb21haW5faWQsIHJlcS0+dmNwdV9p
ZCk7CiAjZW5kaWYKICAgICB9CiAKICAgICByZXEtPnZlcnNpb24gPSBWTV9FVkVOVF9JTlRFUkZB
Q0VfVkVSU0lPTjsKIAotICAgIHZtX2V2ZW50X3JpbmdfbG9jayh2ZWQpOworICAgIHNwaW5fbG9j
aygmaW1wbC0+dmVkLmxvY2spOwogCiAgICAgLyogRHVlIHRvIHRoZSByZXNlcnZhdGlvbnMsIHRo
aXMgc3RlcCBtdXN0IHN1Y2NlZWQuICovCi0gICAgZnJvbnRfcmluZyA9ICZ2ZWQtPmZyb250X3Jp
bmc7CisgICAgZnJvbnRfcmluZyA9ICZpbXBsLT5mcm9udF9yaW5nOwogICAgIGZyZWVfcmVxID0g
UklOR19GUkVFX1JFUVVFU1RTKGZyb250X3JpbmcpOwogICAgIEFTU0VSVChmcmVlX3JlcSA+IDAp
OwogCkBAIC0zMzYsMzUgKzMzMSwzNSBAQCB2b2lkIHZtX2V2ZW50X3B1dF9yZXF1ZXN0KHN0cnVj
dCB2bV9ldmVudF9kb21haW4gKnZlZCwKICAgICBSSU5HX1BVU0hfUkVRVUVTVFMoZnJvbnRfcmlu
Zyk7CiAKICAgICAvKiBXZSd2ZSBhY3R1YWxseSAqdXNlZCogb3VyIHJlc2VydmF0aW9uLCBzbyBy
ZWxlYXNlIHRoZSBzbG90LiAqLwotICAgIHZtX2V2ZW50X3JlbGVhc2Vfc2xvdCh2ZWQpOworICAg
IHZtX2V2ZW50X3JpbmdfcmVsZWFzZV9zbG90KGltcGwpOwogCiAgICAgLyogR2l2ZSB0aGlzIHZD
UFUgYSBibGFjayBleWUgaWYgbmVjZXNzYXJ5LCBvbiB0aGUgd2F5IG91dC4KICAgICAgKiBTZWUg
dGhlIGNvbW1lbnRzIGFib3ZlIHdha2VfYmxvY2tlZCgpIGZvciBtb3JlIGluZm9ybWF0aW9uCiAg
ICAgICogb24gaG93IHRoaXMgbWVjaGFuaXNtIHdvcmtzIHRvIGF2b2lkIHdhaXRpbmcuICovCi0g
ICAgYXZhaWxfcmVxID0gdm1fZXZlbnRfcmluZ19hdmFpbGFibGUodmVkKTsKLSAgICBpZiggY3Vy
ci0+ZG9tYWluID09IGQgJiYgYXZhaWxfcmVxIDwgZC0+bWF4X3ZjcHVzICYmCisgICAgYXZhaWxf
cmVxID0gdm1fZXZlbnRfcmluZ19hdmFpbGFibGUoaW1wbCk7CisgICAgaWYoIGN1cnItPmRvbWFp
biA9PSB2ZWQtPmQgJiYgYXZhaWxfcmVxIDwgdmVkLT5kLT5tYXhfdmNwdXMgJiYKICAgICAgICAg
IWF0b21pY19yZWFkKCZjdXJyLT52bV9ldmVudF9wYXVzZV9jb3VudCkgKQotICAgICAgICB2bV9l
dmVudF9tYXJrX2FuZF9wYXVzZShjdXJyLCB2ZWQpOworICAgICAgICB2bV9ldmVudF9yaW5nX21h
cmtfYW5kX3BhdXNlKGN1cnIsIGltcGwpOwogCi0gICAgdm1fZXZlbnRfcmluZ191bmxvY2sodmVk
KTsKKyAgICBzcGluX3VubG9jaygmaW1wbC0+dmVkLmxvY2spOwogCi0gICAgbm90aWZ5X3ZpYV94
ZW5fZXZlbnRfY2hhbm5lbChkLCB2ZWQtPnhlbl9wb3J0KTsKKyAgICBub3RpZnlfdmlhX3hlbl9l
dmVudF9jaGFubmVsKHZlZC0+ZCwgaW1wbC0+eGVuX3BvcnQpOwogfQogCi1zdGF0aWMgaW50IHZt
X2V2ZW50X2dldF9yZXNwb25zZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3Qgdm1fZXZlbnRfZG9t
YWluICp2ZWQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bV9ldmVudF9yZXNw
b25zZV90ICpyc3ApCitzdGF0aWMgaW50IHZtX2V2ZW50X3JpbmdfZ2V0X3Jlc3BvbnNlKHN0cnVj
dCB2bV9ldmVudF9yaW5nX2RvbWFpbiAqaW1wbCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdm1fZXZlbnRfcmVzcG9uc2VfdCAqcnNwKQogewogICAgIHZtX2V2ZW50X2Zy
b250X3JpbmdfdCAqZnJvbnRfcmluZzsKICAgICBSSU5HX0lEWCByc3BfY29uczsKIAotICAgIHZt
X2V2ZW50X3JpbmdfbG9jayh2ZWQpOworICAgIHNwaW5fbG9jaygmaW1wbC0+dmVkLmxvY2spOwog
Ci0gICAgZnJvbnRfcmluZyA9ICZ2ZWQtPmZyb250X3Jpbmc7CisgICAgZnJvbnRfcmluZyA9ICZp
bXBsLT5mcm9udF9yaW5nOwogICAgIHJzcF9jb25zID0gZnJvbnRfcmluZy0+cnNwX2NvbnM7CiAK
ICAgICBpZiAoICFSSU5HX0hBU19VTkNPTlNVTUVEX1JFU1BPTlNFUyhmcm9udF9yaW5nKSApCiAg
ICAgewotICAgICAgICB2bV9ldmVudF9yaW5nX3VubG9jayh2ZWQpOworICAgICAgICBzcGluX3Vu
bG9jaygmaW1wbC0+dmVkLmxvY2spOwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKQEAgLTM3
OCw5ICszNzMsOSBAQCBzdGF0aWMgaW50IHZtX2V2ZW50X2dldF9yZXNwb25zZShzdHJ1Y3QgZG9t
YWluICpkLCBzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQsCiAKICAgICAvKiBLaWNrIGFueSB3
YWl0ZXJzIC0tIHNpbmNlIHdlJ3ZlIGp1c3QgY29uc3VtZWQgYW4gZXZlbnQsCiAgICAgICogdGhl
cmUgbWF5IGJlIGFkZGl0aW9uYWwgc3BhY2UgYXZhaWxhYmxlIGluIHRoZSByaW5nLiAqLwotICAg
IHZtX2V2ZW50X3dha2UodmVkKTsKKyAgICB2bV9ldmVudF9yaW5nX3dha2UoaW1wbCk7CiAKLSAg
ICB2bV9ldmVudF9yaW5nX3VubG9jayh2ZWQpOworICAgIHNwaW5fdW5sb2NrKCZpbXBsLT52ZWQu
bG9jayk7CiAKICAgICByZXR1cm4gMTsKIH0KQEAgLTM5MywxMCArMzg4LDEzIEBAIHN0YXRpYyBp
bnQgdm1fZXZlbnRfZ2V0X3Jlc3BvbnNlKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB2bV9ldmVu
dF9kb21haW4gKnZlZCwKICAqIE5vdGU6IHJlc3BvbnNlcyBhcmUgaGFuZGxlZCB0aGUgc2FtZSB3
YXkgcmVnYXJkbGVzcyBvZiB3aGljaCByaW5nIHRoZXkKICAqIGFycml2ZSBvbi4KICAqLwotc3Rh
dGljIGludCB2bV9ldmVudF9yZXN1bWUoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHZtX2V2ZW50
X2RvbWFpbiAqdmVkKQorc3RhdGljIGludCB2bV9ldmVudF9yaW5nX3Jlc3VtZShzdHJ1Y3Qgdm1f
ZXZlbnRfcmluZ19kb21haW4gKmltcGwpCiB7CiAgICAgdm1fZXZlbnRfcmVzcG9uc2VfdCByc3A7
CiAKKyAgICBpZiAoIHVubGlrZWx5KCFpbXBsIHx8ICF2bV9ldmVudF9jaGVjaygmaW1wbC0+dmVk
KSkgKQorICAgICAgICAgcmV0dXJuIC1FTk9ERVY7CisKICAgICAvKgogICAgICAqIHZtX2V2ZW50
X3Jlc3VtZSgpIHJ1bnMgaW4gZWl0aGVyIFhFTl9WTV9FVkVOVF8qIGRvbWN0bHMsIG9yCiAgICAg
ICogRVZUQ0hOX3NlbmQgY29udGV4dCBmcm9tIHRoZSBpbnRyb3NwZWN0aW9uIGNvbnN1bWVyLiBC
b3RoIGNvbnRleHRzCkBAIC00MDUsMTMgKzQwMywxMCBAQCBzdGF0aWMgaW50IHZtX2V2ZW50X3Jl
c3VtZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpCiAgICAg
ICogYmVsb3csIHRoaXMgY292ZXJzIHRoZSBjYXNlIHdoZXJlIHdlIHdvdWxkIG5lZWQgdG8gaXRl
cmF0ZSBvdmVyIGFsbAogICAgICAqIG9mIHRoZW0gbW9yZSBzdWNjaW50bHkuCiAgICAgICovCi0g
ICAgQVNTRVJUKGQgIT0gY3VycmVudC0+ZG9tYWluKTsKLQotICAgIGlmICggdW5saWtlbHkoIXZt
X2V2ZW50X2NoZWNrKHZlZCkpICkKLSAgICAgICAgIHJldHVybiAtRU5PREVWOworICAgIEFTU0VS
VChpbXBsLT52ZWQuZCAhPSBjdXJyZW50LT5kb21haW4pOwogCiAgICAgLyogUHVsbCBhbGwgcmVz
cG9uc2VzIG9mZiB0aGUgcmluZy4gKi8KLSAgICB3aGlsZSAoIHZtX2V2ZW50X2dldF9yZXNwb25z
ZShkLCB2ZWQsICZyc3ApICkKKyAgICB3aGlsZSAoIHZtX2V2ZW50X3JpbmdfZ2V0X3Jlc3BvbnNl
KGltcGwsICZyc3ApICkKICAgICB7CiAgICAgICAgIHN0cnVjdCB2Y3B1ICp2OwogCkBAIC00MjIs
MTAgKzQxNywxMSBAQCBzdGF0aWMgaW50IHZtX2V2ZW50X3Jlc3VtZShzdHJ1Y3QgZG9tYWluICpk
LCBzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpCiAgICAgICAgIH0KIAogICAgICAgICAvKiBW
YWxpZGF0ZSB0aGUgdmNwdV9pZCBpbiB0aGUgcmVzcG9uc2UuICovCi0gICAgICAgIGlmICggKHJz
cC52Y3B1X2lkID49IGQtPm1heF92Y3B1cykgfHwgIWQtPnZjcHVbcnNwLnZjcHVfaWRdICkKKyAg
ICAgICAgaWYgKCAocnNwLnZjcHVfaWQgPj0gaW1wbC0+dmVkLmQtPm1heF92Y3B1cykgfHwKKyAg
ICAgICAgICAgICAgIWltcGwtPnZlZC5kLT52Y3B1W3JzcC52Y3B1X2lkXSApCiAgICAgICAgICAg
ICBjb250aW51ZTsKIAotICAgICAgICB2ID0gZC0+dmNwdVtyc3AudmNwdV9pZF07CisgICAgICAg
IHYgPSBpbXBsLT52ZWQuZC0+dmNwdVtyc3AudmNwdV9pZF07CiAKICAgICAgICAgLyoKICAgICAg
ICAgICogSW4gc29tZSBjYXNlcyB0aGUgcmVzcG9uc2UgdHlwZSBuZWVkcyBleHRyYSBoYW5kbGlu
Zywgc28gaGVyZQpAQCAtNDM3LDcgKzQzMyw3IEBAIHN0YXRpYyBpbnQgdm1fZXZlbnRfcmVzdW1l
KHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKICAgICAgICAg
ewogI2lmZGVmIENPTkZJR19IQVNfTUVNX1BBR0lORwogICAgICAgICAgICAgaWYgKCByc3AucmVh
c29uID09IFZNX0VWRU5UX1JFQVNPTl9NRU1fUEFHSU5HICkKLSAgICAgICAgICAgICAgICBwMm1f
bWVtX3BhZ2luZ19yZXN1bWUoZCwgJnJzcCk7CisgICAgICAgICAgICAgICAgcDJtX21lbV9wYWdp
bmdfcmVzdW1lKGltcGwtPnZlZC5kLCAmcnNwKTsKICNlbmRpZgogCiAgICAgICAgICAgICAvKgpA
QCAtNDU3LDcgKzQ1Myw3IEBAIHN0YXRpYyBpbnQgdm1fZXZlbnRfcmVzdW1lKHN0cnVjdCBkb21h
aW4gKmQsIHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKICAgICAgICAgICAgICAqIENoZWNr
IGluIGFyY2gtc3BlY2lmaWMgaGFuZGxlciB0byBhdm9pZCBiaXRtYXNrIG92ZXJoZWFkIHdoZW4K
ICAgICAgICAgICAgICAqIG5vdCBzdXBwb3J0ZWQuCiAgICAgICAgICAgICAgKi8KLSAgICAgICAg
ICAgIHZtX2V2ZW50X3RvZ2dsZV9zaW5nbGVzdGVwKGQsIHYsICZyc3ApOworICAgICAgICAgICAg
dm1fZXZlbnRfdG9nZ2xlX3NpbmdsZXN0ZXAoaW1wbC0+dmVkLmQsIHYsICZyc3ApOwogCiAgICAg
ICAgICAgICAvKiBDaGVjayBmb3IgYWx0cDJtIHN3aXRjaCAqLwogICAgICAgICAgICAgaWYgKCBy
c3AuZmxhZ3MgJiBWTV9FVkVOVF9GTEFHX0FMVEVSTkFURV9QMk0gKQpAQCAtNDc3LDY2ICs0NzMs
NjMgQEAgc3RhdGljIGludCB2bV9ldmVudF9yZXN1bWUoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0
IHZtX2V2ZW50X2RvbWFpbiAqdmVkKQogICAgIHJldHVybiAwOwogfQogCi12b2lkIHZtX2V2ZW50
X2NhbmNlbF9zbG90KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKK3N0YXRpYyB2b2lkIHZt
X2V2ZW50X3JpbmdfY2FuY2VsX3Nsb3Qoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKQogewot
ICAgIGlmKCAhdm1fZXZlbnRfY2hlY2sodmVkKSApCi0gICAgICAgIHJldHVybjsKLQotICAgIHZt
X2V2ZW50X3JpbmdfbG9jayh2ZWQpOwotICAgIHZtX2V2ZW50X3JlbGVhc2Vfc2xvdCh2ZWQpOwot
ICAgIHZtX2V2ZW50X3JpbmdfdW5sb2NrKHZlZCk7CisgICAgc3Bpbl9sb2NrKCZ2ZWQtPmxvY2sp
OworICAgIHZtX2V2ZW50X3JpbmdfcmVsZWFzZV9zbG90KHRvX3JpbmcodmVkKSk7CisgICAgc3Bp
bl91bmxvY2soJnZlZC0+bG9jayk7CiB9CiAKLXN0YXRpYyBpbnQgdm1fZXZlbnRfZ3JhYl9zbG90
KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCwgaW50IGZvcmVpZ24pCitzdGF0aWMgaW50IHZt
X2V2ZW50X3JpbmdfZ3JhYl9zbG90KHN0cnVjdCB2bV9ldmVudF9yaW5nX2RvbWFpbiAqaW1wbCwg
aW50IGZvcmVpZ24pCiB7CiAgICAgdW5zaWduZWQgaW50IGF2YWlsX3JlcTsKIAotICAgIGlmICgg
IXZlZC0+cmluZ19wYWdlICkKKyAgICBpZiAoICFpbXBsLT5yaW5nX3BhZ2UgKQogICAgICAgICBy
ZXR1cm4gLUVPUE5PVFNVUFA7CiAKLSAgICB2bV9ldmVudF9yaW5nX2xvY2sodmVkKTsKKyAgICBz
cGluX2xvY2soJmltcGwtPnZlZC5sb2NrKTsKIAotICAgIGF2YWlsX3JlcSA9IHZtX2V2ZW50X3Jp
bmdfYXZhaWxhYmxlKHZlZCk7CisgICAgYXZhaWxfcmVxID0gdm1fZXZlbnRfcmluZ19hdmFpbGFi
bGUoaW1wbCk7CiAgICAgaWYgKCBhdmFpbF9yZXEgPT0gMCApCiAgICAgewotICAgICAgICB2bV9l
dmVudF9yaW5nX3VubG9jayh2ZWQpOworICAgICAgICBzcGluX3VubG9jaygmaW1wbC0+dmVkLmxv
Y2spOwogICAgICAgICByZXR1cm4gLUVCVVNZOwogICAgIH0KIAogICAgIGlmICggIWZvcmVpZ24g
KQotICAgICAgICB2ZWQtPnRhcmdldF9wcm9kdWNlcnMrKzsKKyAgICAgICAgaW1wbC0+dGFyZ2V0
X3Byb2R1Y2VycysrOwogICAgIGVsc2UKLSAgICAgICAgdmVkLT5mb3JlaWduX3Byb2R1Y2Vycysr
OworICAgICAgICBpbXBsLT5mb3JlaWduX3Byb2R1Y2VycysrOwogCi0gICAgdm1fZXZlbnRfcmlu
Z191bmxvY2sodmVkKTsKKyAgICBzcGluX3VubG9jaygmaW1wbC0+dmVkLmxvY2spOwogCiAgICAg
cmV0dXJuIDA7CiB9CiAKIC8qIFNpbXBsZSB0cnlfZ3JhYiB3cmFwcGVyIGZvciB1c2UgaW4gdGhl
IHdhaXRfZXZlbnQoKSBtYWNyby4gKi8KLXN0YXRpYyBpbnQgdm1fZXZlbnRfd2FpdF90cnlfZ3Jh
YihzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQsIGludCAqcmMpCitzdGF0aWMgaW50IHZtX2V2
ZW50X3Jpbmdfd2FpdF90cnlfZ3JhYihzdHJ1Y3Qgdm1fZXZlbnRfcmluZ19kb21haW4gKmltcGws
IGludCAqcmMpCiB7Ci0gICAgKnJjID0gdm1fZXZlbnRfZ3JhYl9zbG90KHZlZCwgMCk7CisgICAg
KnJjID0gdm1fZXZlbnRfcmluZ19ncmFiX3Nsb3QoaW1wbCwgMCk7CiAgICAgcmV0dXJuICpyYzsK
IH0KIAotLyogQ2FsbCB2bV9ldmVudF9ncmFiX3Nsb3QoKSB1bnRpbCB0aGUgcmluZyBkb2Vzbid0
IGV4aXN0LCBvciBpcyBhdmFpbGFibGUuICovCi1zdGF0aWMgaW50IHZtX2V2ZW50X3dhaXRfc2xv
dChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpCisvKiBDYWxsIHZtX2V2ZW50X3JpbmdfZ3Jh
Yl9zbG90KCkgdW50aWwgdGhlIHJpbmcgZG9lc24ndCBleGlzdCwgb3IgaXMgYXZhaWxhYmxlLiAq
Lworc3RhdGljIGludCB2bV9ldmVudF9yaW5nX3dhaXRfc2xvdChzdHJ1Y3Qgdm1fZXZlbnRfcmlu
Z19kb21haW4gKmltcGwpCiB7CiAgICAgaW50IHJjID0gLUVCVVNZOwotICAgIHdhaXRfZXZlbnQo
dmVkLT53cSwgdm1fZXZlbnRfd2FpdF90cnlfZ3JhYih2ZWQsICZyYykgIT0gLUVCVVNZKTsKKyAg
ICB3YWl0X2V2ZW50KGltcGwtPndxLCB2bV9ldmVudF9yaW5nX3dhaXRfdHJ5X2dyYWIoaW1wbCwg
JnJjKSAhPSAtRUJVU1kpOwogICAgIHJldHVybiByYzsKIH0KIAotYm9vbCB2bV9ldmVudF9jaGVj
ayhzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpCitzdGF0aWMgYm9vbCB2bV9ldmVudF9yaW5n
X2NoZWNrKHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKIHsKLSAgICByZXR1cm4gKHZlZCAm
JiB2ZWQtPnJpbmdfcGFnZSk7CisgICAgcmV0dXJuICggdG9fcmluZyh2ZWQpLT5yaW5nX3BhZ2Ug
IT0gTlVMTCApOwogfQogCiAvKgogICogRGV0ZXJtaW5lcyB3aGV0aGVyIG9yIG5vdCB0aGUgY3Vy
cmVudCB2Q1BVIGJlbG9uZ3MgdG8gdGhlIHRhcmdldCBkb21haW4sCiAgKiBhbmQgY2FsbHMgdGhl
IGFwcHJvcHJpYXRlIHdhaXQgZnVuY3Rpb24uICBJZiBpdCBpcyBhIGd1ZXN0IHZDUFUsIHRoZW4g
d2UKLSAqIHVzZSB2bV9ldmVudF93YWl0X3Nsb3QoKSB0byByZXNlcnZlIGEgc2xvdC4gIEFzIGxv
bmcgYXMgdGhlcmUgaXMgYSByaW5nLAorICogdXNlIHZtX2V2ZW50X3Jpbmdfd2FpdF9zbG90KCkg
dG8gcmVzZXJ2ZSBhIHNsb3QuICBBcyBsb25nIGFzIHRoZXJlIGlzIGEgcmluZywKICAqIHRoaXMg
ZnVuY3Rpb24gd2lsbCBhbHdheXMgcmV0dXJuIDAgZm9yIGEgZ3Vlc3QuICBGb3IgYSBub24tZ3Vl
c3QsIHdlIGNoZWNrCiAgKiBmb3Igc3BhY2UgYW5kIHJldHVybiAtRUJVU1kgaWYgdGhlIHJpbmcg
aXMgbm90IGF2YWlsYWJsZS4KICAqCkBAIC01NDUsMzYgKzUzOCwzMyBAQCBib29sIHZtX2V2ZW50
X2NoZWNrKHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKICAqICAgICAgICAgICAgICAgMDog
YSBzcG90IGhhcyBiZWVuIHJlc2VydmVkCiAgKgogICovCi1pbnQgX192bV9ldmVudF9jbGFpbV9z
bG90KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCwgYm9vbCBhbGxvd19zbGVlcCkKK3N0YXRp
YyBpbnQgdm1fZXZlbnRfcmluZ19jbGFpbV9zbG90KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZl
ZCwgYm9vbCBhbGxvd19zbGVlcCkKIHsKLSAgICBpZiAoICF2bV9ldmVudF9jaGVjayh2ZWQpICkK
LSAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOwotCiAgICAgaWYgKCAoY3VycmVudC0+ZG9tYWlu
ID09IHZlZC0+ZCkgJiYgYWxsb3dfc2xlZXAgKQotICAgICAgICByZXR1cm4gdm1fZXZlbnRfd2Fp
dF9zbG90KHZlZCk7CisgICAgICAgIHJldHVybiB2bV9ldmVudF9yaW5nX3dhaXRfc2xvdCh0b19y
aW5nKHZlZCkpOwogICAgIGVsc2UKLSAgICAgICAgcmV0dXJuIHZtX2V2ZW50X2dyYWJfc2xvdCh2
ZWQsIChjdXJyZW50LT5kb21haW4gIT0gdmVkLT5kKSk7CisgICAgICAgIHJldHVybiB2bV9ldmVu
dF9yaW5nX2dyYWJfc2xvdCh0b19yaW5nKHZlZCksIChjdXJyZW50LT5kb21haW4gIT0gdmVkLT5k
KSk7CiB9CiAKICNpZmRlZiBDT05GSUdfSEFTX01FTV9QQUdJTkcKIC8qIFJlZ2lzdGVyZWQgd2l0
aCBYZW4tYm91bmQgZXZlbnQgY2hhbm5lbCBmb3IgaW5jb21pbmcgbm90aWZpY2F0aW9ucy4gKi8K
IHN0YXRpYyB2b2lkIG1lbV9wYWdpbmdfbm90aWZpY2F0aW9uKHN0cnVjdCB2Y3B1ICp2LCB1bnNp
Z25lZCBpbnQgcG9ydCkKIHsKLSAgICB2bV9ldmVudF9yZXN1bWUodi0+ZG9tYWluLCB2LT5kb21h
aW4tPnZtX2V2ZW50X3BhZ2luZyk7CisgICAgdm1fZXZlbnRfcmluZ19yZXN1bWUodG9fcmluZyh2
LT5kb21haW4tPnZtX2V2ZW50X3BhZ2luZykpOwogfQogI2VuZGlmCiAKIC8qIFJlZ2lzdGVyZWQg
d2l0aCBYZW4tYm91bmQgZXZlbnQgY2hhbm5lbCBmb3IgaW5jb21pbmcgbm90aWZpY2F0aW9ucy4g
Ki8KIHN0YXRpYyB2b2lkIG1vbml0b3Jfbm90aWZpY2F0aW9uKHN0cnVjdCB2Y3B1ICp2LCB1bnNp
Z25lZCBpbnQgcG9ydCkKIHsKLSAgICB2bV9ldmVudF9yZXN1bWUodi0+ZG9tYWluLCB2LT5kb21h
aW4tPnZtX2V2ZW50X21vbml0b3IpOworICAgIHZtX2V2ZW50X3JpbmdfcmVzdW1lKHRvX3Jpbmco
di0+ZG9tYWluLT52bV9ldmVudF9tb25pdG9yKSk7CiB9CiAKICNpZmRlZiBDT05GSUdfSEFTX01F
TV9TSEFSSU5HCiAvKiBSZWdpc3RlcmVkIHdpdGggWGVuLWJvdW5kIGV2ZW50IGNoYW5uZWwgZm9y
IGluY29taW5nIG5vdGlmaWNhdGlvbnMuICovCiBzdGF0aWMgdm9pZCBtZW1fc2hhcmluZ19ub3Rp
ZmljYXRpb24oc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwb3J0KQogewotICAgIHZtX2V2
ZW50X3Jlc3VtZSh2LT5kb21haW4sIHYtPmRvbWFpbi0+dm1fZXZlbnRfc2hhcmUpOworICAgIHZt
X2V2ZW50X3JpbmdfcmVzdW1lKHRvX3Jpbmcodi0+ZG9tYWluLT52bV9ldmVudF9zaGFyZSkpOwog
fQogI2VuZGlmCiAKQEAgLTU4MywzMiArNTczLDMyIEBAIHZvaWQgdm1fZXZlbnRfY2xlYW51cChz
dHJ1Y3QgZG9tYWluICpkKQogewogI2lmZGVmIENPTkZJR19IQVNfTUVNX1BBR0lORwogICAgIGlm
ICggdm1fZXZlbnRfY2hlY2soZC0+dm1fZXZlbnRfcGFnaW5nKSApCi0gICAgewotICAgICAgICAv
KiBEZXN0cm95aW5nIHRoZSB3YWl0IHF1ZXVlIGhlYWQgbWVhbnMgd2FraW5nIHVwIGFsbAotICAg
ICAgICAgKiBxdWV1ZWQgdmNwdXMuIFRoaXMgd2lsbCBkcmFpbiB0aGUgbGlzdCwgYWxsb3dpbmcK
LSAgICAgICAgICogdGhlIGRpc2FibGUgcm91dGluZSB0byBjb21wbGV0ZS4gSXQgd2lsbCBhbHNv
IGRyb3AKLSAgICAgICAgICogYWxsIGRvbWFpbiByZWZzIHRoZSB3YWl0LXF1ZXVlZCB2Y3B1cyBh
cmUgaG9sZGluZy4KLSAgICAgICAgICogRmluYWxseSwgYmVjYXVzZSB0aGlzIGNvZGUgcGF0aCBp
bnZvbHZlcyBwcmV2aW91c2x5Ci0gICAgICAgICAqIHBhdXNpbmcgdGhlIGRvbWFpbiAoZG9tYWlu
X2tpbGwpLCB1bnBhdXNpbmcgdGhlCi0gICAgICAgICAqIHZjcHVzIGNhdXNlcyBubyBoYXJtLiAq
LwotICAgICAgICBkZXN0cm95X3dhaXRxdWV1ZV9oZWFkKCZkLT52bV9ldmVudF9wYWdpbmctPndx
KTsKLSAgICAgICAgKHZvaWQpdm1fZXZlbnRfZGlzYWJsZShkLCAmZC0+dm1fZXZlbnRfcGFnaW5n
KTsKLSAgICB9CisgICAgICAgIGQtPnZtX2V2ZW50X3BhZ2luZy0+b3BzLT5jbGVhbnVwKCZkLT52
bV9ldmVudF9wYWdpbmcpOwogI2VuZGlmCisKICAgICBpZiAoIHZtX2V2ZW50X2NoZWNrKGQtPnZt
X2V2ZW50X21vbml0b3IpICkKLSAgICB7Ci0gICAgICAgIGRlc3Ryb3lfd2FpdHF1ZXVlX2hlYWQo
JmQtPnZtX2V2ZW50X21vbml0b3ItPndxKTsKLSAgICAgICAgKHZvaWQpdm1fZXZlbnRfZGlzYWJs
ZShkLCAmZC0+dm1fZXZlbnRfbW9uaXRvcik7Ci0gICAgfQorICAgICAgICBkLT52bV9ldmVudF9t
b25pdG9yLT5vcHMtPmNsZWFudXAoJmQtPnZtX2V2ZW50X21vbml0b3IpOworCiAjaWZkZWYgQ09O
RklHX0hBU19NRU1fU0hBUklORwogICAgIGlmICggdm1fZXZlbnRfY2hlY2soZC0+dm1fZXZlbnRf
c2hhcmUpICkKLSAgICB7Ci0gICAgICAgIGRlc3Ryb3lfd2FpdHF1ZXVlX2hlYWQoJmQtPnZtX2V2
ZW50X3NoYXJlLT53cSk7Ci0gICAgICAgICh2b2lkKXZtX2V2ZW50X2Rpc2FibGUoZCwgJmQtPnZt
X2V2ZW50X3NoYXJlKTsKLSAgICB9CisgICAgICAgIGQtPnZtX2V2ZW50X3NoYXJlLT5vcHMtPmNs
ZWFudXAoJmQtPnZtX2V2ZW50X3NoYXJlKTsKICNlbmRpZgogfQogCitzdGF0aWMgdm9pZCB2bV9l
dmVudF9yaW5nX2NsZWFudXAoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqKl92ZWQpCit7CisgICAg
c3RydWN0IHZtX2V2ZW50X3JpbmdfZG9tYWluICppbXBsID0gdG9fcmluZygqX3ZlZCk7CisgICAg
LyogRGVzdHJveWluZyB0aGUgd2FpdCBxdWV1ZSBoZWFkIG1lYW5zIHdha2luZyB1cCBhbGwKKyAg
ICAgKiBxdWV1ZWQgdmNwdXMuIFRoaXMgd2lsbCBkcmFpbiB0aGUgbGlzdCwgYWxsb3dpbmcKKyAg
ICAgKiB0aGUgZGlzYWJsZSByb3V0aW5lIHRvIGNvbXBsZXRlLiBJdCB3aWxsIGFsc28gZHJvcAor
ICAgICAqIGFsbCBkb21haW4gcmVmcyB0aGUgd2FpdC1xdWV1ZWQgdmNwdXMgYXJlIGhvbGRpbmcu
CisgICAgICogRmluYWxseSwgYmVjYXVzZSB0aGlzIGNvZGUgcGF0aCBpbnZvbHZlcyBwcmV2aW91
c2x5CisgICAgICogcGF1c2luZyB0aGUgZG9tYWluIChkb21haW5fa2lsbCksIHVucGF1c2luZyB0
aGUKKyAgICAgKiB2Y3B1cyBjYXVzZXMgbm8gaGFybS4gKi8KKyAgICBkZXN0cm95X3dhaXRxdWV1
ZV9oZWFkKCZpbXBsLT53cSk7CisgICAgKHZvaWQpdm1fZXZlbnRfcmluZ19kaXNhYmxlKF92ZWQp
OworfQorCiBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5f
ZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMsCiAgICAgICAgICAgICAgICAgICAgIFhFTl9HVUVTVF9I
QU5ETEVfUEFSQU0odm9pZCkgdV9kb21jdGwpCiB7CkBAIC02ODIsMjMgKzY3MiwyMiBAQCBpbnQg
dm1fZXZlbnRfZG9tY3RsKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2
ZW50X29wICp2ZWMsCiAgICAgICAgICAgICAgICAgYnJlYWs7CiAKICAgICAgICAgICAgIC8qIGRv
bWFpbl9wYXVzZSgpIG5vdCByZXF1aXJlZCBoZXJlLCBzZWUgWFNBLTk5ICovCi0gICAgICAgICAg
ICByYyA9IHZtX2V2ZW50X2VuYWJsZShkLCB2ZWMsICZkLT52bV9ldmVudF9wYWdpbmcsIF9WUEZf
bWVtX3BhZ2luZywKKyAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmluZ19lbmFibGUoZCwgdmVj
LCAmZC0+dm1fZXZlbnRfcGFnaW5nLCBfVlBGX21lbV9wYWdpbmcsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBIVk1fUEFSQU1fUEFHSU5HX1JJTkdfUEZOLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbWVtX3BhZ2luZ19ub3RpZmljYXRpb24pOwogICAgICAgICB9
CiAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIGNhc2UgWEVOX1ZNX0VWRU5UX0RJU0FCTEU6Ci0g
ICAgICAgICAgICBpZiAoIHZtX2V2ZW50X2NoZWNrKGQtPnZtX2V2ZW50X3BhZ2luZykgKQotICAg
ICAgICAgICAgewotICAgICAgICAgICAgICAgIGRvbWFpbl9wYXVzZShkKTsKLSAgICAgICAgICAg
ICAgICByYyA9IHZtX2V2ZW50X2Rpc2FibGUoZCwgJmQtPnZtX2V2ZW50X3BhZ2luZyk7Ci0gICAg
ICAgICAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7Ci0gICAgICAgICAgICB9CisgICAgICAgICAg
ICBpZiAoICF2bV9ldmVudF9jaGVjayhkLT52bV9ldmVudF9wYWdpbmcpICkKKyAgICAgICAgICAg
ICAgICBicmVhazsKKyAgICAgICAgICAgIGRvbWFpbl9wYXVzZShkKTsKKyAgICAgICAgICAgIHJj
ID0gdm1fZXZlbnRfcmluZ19kaXNhYmxlKCZkLT52bV9ldmVudF9wYWdpbmcpOworICAgICAgICAg
ICAgZG9tYWluX3VucGF1c2UoZCk7CiAgICAgICAgICAgICBicmVhazsKIAogICAgICAgICBjYXNl
IFhFTl9WTV9FVkVOVF9SRVNVTUU6Ci0gICAgICAgICAgICByYyA9IHZtX2V2ZW50X3Jlc3VtZShk
LCBkLT52bV9ldmVudF9wYWdpbmcpOworICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9yaW5nX3Jl
c3VtZSh0b19yaW5nKGQtPnZtX2V2ZW50X3BhZ2luZykpOwogICAgICAgICAgICAgYnJlYWs7CiAK
ICAgICAgICAgZGVmYXVsdDoKQEAgLTcyMCwyMyArNzA5LDIyIEBAIGludCB2bV9ldmVudF9kb21j
dGwoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHhlbl9kb21jdGxfdm1fZXZlbnRfb3AgKnZlYywK
ICAgICAgICAgICAgIHJjID0gYXJjaF9tb25pdG9yX2luaXRfZG9tYWluKGQpOwogICAgICAgICAg
ICAgaWYgKCByYyApCiAgICAgICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgICAgICByYyA9IHZt
X2V2ZW50X2VuYWJsZShkLCB2ZWMsICZkLT52bV9ldmVudF9tb25pdG9yLCBfVlBGX21lbV9hY2Nl
c3MsCisgICAgICAgICAgICByYyA9IHZtX2V2ZW50X3JpbmdfZW5hYmxlKGQsIHZlYywgJmQtPnZt
X2V2ZW50X21vbml0b3IsIF9WUEZfbWVtX2FjY2VzcywKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEhWTV9QQVJBTV9NT05JVE9SX1JJTkdfUEZOLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbW9uaXRvcl9ub3RpZmljYXRpb24pOwogICAgICAgICAgICAgYnJlYWs7
CiAKICAgICAgICAgY2FzZSBYRU5fVk1fRVZFTlRfRElTQUJMRToKLSAgICAgICAgICAgIGlmICgg
dm1fZXZlbnRfY2hlY2soZC0+dm1fZXZlbnRfbW9uaXRvcikgKQotICAgICAgICAgICAgewotICAg
ICAgICAgICAgICAgIGRvbWFpbl9wYXVzZShkKTsKLSAgICAgICAgICAgICAgICByYyA9IHZtX2V2
ZW50X2Rpc2FibGUoZCwgJmQtPnZtX2V2ZW50X21vbml0b3IpOwotICAgICAgICAgICAgICAgIGFy
Y2hfbW9uaXRvcl9jbGVhbnVwX2RvbWFpbihkKTsKLSAgICAgICAgICAgICAgICBkb21haW5fdW5w
YXVzZShkKTsKLSAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGlmICggIXZtX2V2ZW50X2NoZWNr
KGQtPnZtX2V2ZW50X21vbml0b3IpICkKKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAg
ICAgIGRvbWFpbl9wYXVzZShkKTsKKyAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmluZ19kaXNh
YmxlKCZkLT52bV9ldmVudF9tb25pdG9yKTsKKyAgICAgICAgICAgIGFyY2hfbW9uaXRvcl9jbGVh
bnVwX2RvbWFpbihkKTsKKyAgICAgICAgICAgIGRvbWFpbl91bnBhdXNlKGQpOwogICAgICAgICAg
ICAgYnJlYWs7CiAKICAgICAgICAgY2FzZSBYRU5fVk1fRVZFTlRfUkVTVU1FOgotICAgICAgICAg
ICAgcmMgPSB2bV9ldmVudF9yZXN1bWUoZCwgZC0+dm1fZXZlbnRfbW9uaXRvcik7CisgICAgICAg
ICAgICByYyA9IHZtX2V2ZW50X3JpbmdfcmVzdW1lKHRvX3JpbmcoZC0+dm1fZXZlbnRfbW9uaXRv
cikpOwogICAgICAgICAgICAgYnJlYWs7CiAKICAgICAgICAgZGVmYXVsdDoKQEAgLTc2NSwyMiAr
NzUzLDIxIEBAIGludCB2bV9ldmVudF9kb21jdGwoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHhl
bl9kb21jdGxfdm1fZXZlbnRfb3AgKnZlYywKICAgICAgICAgICAgICAgICBicmVhazsKIAogICAg
ICAgICAgICAgLyogZG9tYWluX3BhdXNlKCkgbm90IHJlcXVpcmVkIGhlcmUsIHNlZSBYU0EtOTkg
Ki8KLSAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfZW5hYmxlKGQsIHZlYywgJmQtPnZtX2V2ZW50
X3NoYXJlLCBfVlBGX21lbV9zaGFyaW5nLAorICAgICAgICAgICAgcmMgPSB2bV9ldmVudF9yaW5n
X2VuYWJsZShkLCB2ZWMsICZkLT52bV9ldmVudF9zaGFyZSwgX1ZQRl9tZW1fc2hhcmluZywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhWTV9QQVJBTV9TSEFSSU5HX1JJTkdfUEZO
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtX3NoYXJpbmdfbm90aWZpY2F0
aW9uKTsKICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIGNhc2UgWEVOX1ZNX0VWRU5UX0RJ
U0FCTEU6Ci0gICAgICAgICAgICBpZiAoIHZtX2V2ZW50X2NoZWNrKGQtPnZtX2V2ZW50X3NoYXJl
KSApCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgZG9tYWluX3BhdXNlKGQpOwotICAg
ICAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfZGlzYWJsZShkLCAmZC0+dm1fZXZlbnRfc2hhcmUp
OwotICAgICAgICAgICAgICAgIGRvbWFpbl91bnBhdXNlKGQpOwotICAgICAgICAgICAgfQorICAg
ICAgICAgICAgaWYgKCAhdm1fZXZlbnRfY2hlY2soZC0+dm1fZXZlbnRfc2hhcmUpICkKKyAgICAg
ICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIGRvbWFpbl9wYXVzZShkKTsKKyAgICAgICAg
ICAgIHJjID0gdm1fZXZlbnRfcmluZ19kaXNhYmxlKCZkLT52bV9ldmVudF9zaGFyZSk7CisgICAg
ICAgICAgICBkb21haW5fdW5wYXVzZShkKTsKICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAg
IGNhc2UgWEVOX1ZNX0VWRU5UX1JFU1VNRToKLSAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmVz
dW1lKGQsIGQtPnZtX2V2ZW50X3NoYXJlKTsKKyAgICAgICAgICAgIHJjID0gdm1fZXZlbnRfcmlu
Z19yZXN1bWUodG9fcmluZyhkLT52bV9ldmVudF9zaGFyZSkpOwogICAgICAgICAgICAgYnJlYWs7
CiAKICAgICAgICAgZGVmYXVsdDoKQEAgLTgzMiw2ICs4MTksMTQgQEAgdm9pZCB2bV9ldmVudF92
Y3B1X3VucGF1c2Uoc3RydWN0IHZjcHUgKnYpCiAgICAgdmNwdV91bnBhdXNlKHYpOwogfQogCitz
dGF0aWMgY29uc3Qgc3RydWN0IHZtX2V2ZW50X29wcyB2bV9ldmVudF9yaW5nX29wcyA9IHsKKyAg
ICAuY2hlY2sgPSB2bV9ldmVudF9yaW5nX2NoZWNrLAorICAgIC5jbGVhbnVwID0gdm1fZXZlbnRf
cmluZ19jbGVhbnVwLAorICAgIC5jbGFpbV9zbG90ID0gdm1fZXZlbnRfcmluZ19jbGFpbV9zbG90
LAorICAgIC5jYW5jZWxfc2xvdCA9IHZtX2V2ZW50X3JpbmdfY2FuY2VsX3Nsb3QsCisgICAgLnB1
dF9yZXF1ZXN0ID0gdm1fZXZlbnRfcmluZ19wdXRfcmVxdWVzdAorfTsKKwogLyoKICAqIExvY2Fs
IHZhcmlhYmxlczoKICAqIG1vZGU6IEMKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi92bV9l
dmVudC5oIGIveGVuL2luY2x1ZGUveGVuL3ZtX2V2ZW50LmgKaW5kZXggYTVjODJkNi4uMTVjMTVl
NiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3ZtX2V2ZW50LmgKKysrIGIveGVuL2luY2x1
ZGUveGVuL3ZtX2V2ZW50LmgKQEAgLTI2LDExICsyNiwzOCBAQAogI2luY2x1ZGUgPHhlbi9zY2hl
ZC5oPgogI2luY2x1ZGUgPHB1YmxpYy92bV9ldmVudC5oPgogCitzdHJ1Y3Qgdm1fZXZlbnRfb3Bz
Cit7CisgICAgYm9vbCAoKmNoZWNrKShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpOworICAg
IHZvaWQgKCpjbGVhbnVwKShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICoqX3ZlZCk7CisgICAgaW50
ICgqY2xhaW1fc2xvdCkoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLCBib29sIGFsbG93X3Ns
ZWVwKTsKKyAgICB2b2lkICgqY2FuY2VsX3Nsb3QpKHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZl
ZCk7CisgICAgdm9pZCAoKnB1dF9yZXF1ZXN0KShzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQs
IHZtX2V2ZW50X3JlcXVlc3RfdCAqcmVxKTsKK307CisKK3N0cnVjdCB2bV9ldmVudF9kb21haW4K
K3sKKyAgICAvKiBEb21haW4gcmVmZXJlbmNlICovCisgICAgc3RydWN0IGRvbWFpbiAqZDsKKwor
ICAgIC8qIHZtX2V2ZW50X29wcyAqLworICAgIGNvbnN0IHN0cnVjdCB2bV9ldmVudF9vcHMgKm9w
czsKKworICAgIC8qIHZtX2V2ZW50IGRvbWFpbiBsb2NrICovCisgICAgc3BpbmxvY2tfdCBsb2Nr
OworCisgICAgLyogdm1fZXZlbnQgYml0IGZvciB2Y3B1LT5wYXVzZV9mbGFncyAqLworICAgIGlu
dCBwYXVzZV9mbGFnOworfTsKKwogLyogQ2xlYW4gdXAgb24gZG9tYWluIGRlc3RydWN0aW9uICov
CiB2b2lkIHZtX2V2ZW50X2NsZWFudXAoc3RydWN0IGRvbWFpbiAqZCk7CiAKIC8qIFJldHVybnMg
d2hldGhlciB0aGUgVk0gZXZlbnQgZG9tYWluIGhhcyBiZWVuIHNldCB1cCAqLwotYm9vbCB2bV9l
dmVudF9jaGVjayhzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpOworc3RhdGljIGlubGluZSBi
b29sIHZtX2V2ZW50X2NoZWNrKHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKK3sKKyAgICBy
ZXR1cm4gKHZlZCkgJiYgdmVkLT5vcHMtPmNoZWNrKHZlZCk7Cit9CiAKIC8qIFJldHVybnMgMCBv
biBzdWNjZXNzLCAtRU5PU1lTIGlmIHRoZXJlIGlzIG5vIHJpbmcsIC1FQlVTWSBpZiB0aGVyZSBp
cyBubwogICogYXZhaWxhYmxlIHNwYWNlIGFuZCB0aGUgY2FsbGVyIGlzIGEgZm9yZWlnbiBkb21h
aW4uIElmIHRoZSBndWVzdCBpdHNlbGYKQEAgLTQ1LDcgKzcyLDE0IEBAIGJvb2wgdm1fZXZlbnRf
Y2hlY2soc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkKTsKICAqIGNhbmNlbF9zbG90KCksIGJv
dGggb2Ygd2hpY2ggYXJlIGd1YXJhbnRlZWQgdG8KICAqIHN1Y2NlZWQuCiAgKi8KLWludCBfX3Zt
X2V2ZW50X2NsYWltX3Nsb3Qoc3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLCBib29sIGFsbG93
X3NsZWVwKTsKK3N0YXRpYyBpbmxpbmUgaW50IF9fdm1fZXZlbnRfY2xhaW1fc2xvdChzdHJ1Y3Qg
dm1fZXZlbnRfZG9tYWluICp2ZWQsIGJvb2wgYWxsb3dfc2xlZXApCit7CisgICAgaWYgKCAhdm1f
ZXZlbnRfY2hlY2sodmVkKSApCisgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsKKworICAgIHJl
dHVybiB2ZWQtPm9wcy0+Y2xhaW1fc2xvdCh2ZWQsIGFsbG93X3NsZWVwKTsKK30KKwogc3RhdGlj
IGlubGluZSBpbnQgdm1fZXZlbnRfY2xhaW1fc2xvdChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2
ZWQpCiB7CiAgICAgcmV0dXJuIF9fdm1fZXZlbnRfY2xhaW1fc2xvdCh2ZWQsIHRydWUpOwpAQCAt
NTYsMTAgKzkwLDIyIEBAIHN0YXRpYyBpbmxpbmUgaW50IHZtX2V2ZW50X2NsYWltX3Nsb3Rfbm9z
bGVlcChzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpCiAgICAgcmV0dXJuIF9fdm1fZXZlbnRf
Y2xhaW1fc2xvdCh2ZWQsIGZhbHNlKTsKIH0KIAotdm9pZCB2bV9ldmVudF9jYW5jZWxfc2xvdChz
dHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2ZWQpOworc3RhdGljIGlubGluZSB2b2lkIHZtX2V2ZW50
X2NhbmNlbF9zbG90KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCkKK3sKKyAgICBpZiAoICF2
bV9ldmVudF9jaGVjayh2ZWQpICkKKyAgICAgICAgcmV0dXJuOwogCi12b2lkIHZtX2V2ZW50X3B1
dF9yZXF1ZXN0KHN0cnVjdCB2bV9ldmVudF9kb21haW4gKnZlZCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgdm1fZXZlbnRfcmVxdWVzdF90ICpyZXEpOworICAgIHZlZC0+b3BzLT5jYW5jZWxf
c2xvdCh2ZWQpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgdm1fZXZlbnRfcHV0X3JlcXVlc3Qo
c3RydWN0IHZtX2V2ZW50X2RvbWFpbiAqdmVkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHZtX2V2ZW50X3JlcXVlc3RfdCAqcmVxKQoreworICAgIGlmICggIXZtX2V2
ZW50X2NoZWNrKHZlZCkgKQorICAgICAgICByZXR1cm47CisKKyAgICB2ZWQtPm9wcy0+cHV0X3Jl
cXVlc3QodmVkLCByZXEpOworfQogCiBpbnQgdm1fZXZlbnRfZG9tY3RsKHN0cnVjdCBkb21haW4g
KmQsIHN0cnVjdCB4ZW5fZG9tY3RsX3ZtX2V2ZW50X29wICp2ZWMsCiAgICAgICAgICAgICAgICAg
ICAgIFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0odm9pZCkgdV9kb21jdGwpOwotLSAKMi43LjQKCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwg
bWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3Rz
LnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

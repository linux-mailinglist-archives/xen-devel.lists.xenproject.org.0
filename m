Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 085F1E4984
	for <lists+xen-devel@lfdr.de>; Fri, 25 Oct 2019 13:13:29 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iNxUm-0001rm-K1; Fri, 25 Oct 2019 11:11:04 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=PbB1=YS=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iNxUl-0001qt-7R
 for xen-devel@lists.xen.org; Fri, 25 Oct 2019 11:11:03 +0000
X-Inumbo-ID: 13f0e05c-f718-11e9-beca-bc764e2007e4
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 13f0e05c-f718-11e9-beca-bc764e2007e4;
 Fri, 25 Oct 2019 11:10:39 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUJ-0001W6-Aq; Fri, 25 Oct 2019 11:10:35 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUJ-0002iy-7t; Fri, 25 Oct 2019 11:10:35 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iNxUJ-0002iy-7t@xenbits.xenproject.org>
Date: Fri, 25 Oct 2019 11:10:35 +0000
Subject: [Xen-devel] Xen Security Advisory 290 v3 (CVE-2019-17344) - missing
 preemption in x86 PV page table unvalidation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-17344 / XSA-290
                              version 3

         missing preemption in x86 PV page table unvalidation

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

XSA-273 changes required, among other things, making any PTE updates
restartable.  The changes making PTE updates restartable assumed that L2
pagetables would always be promoted preemptibly; but this turns out not
to be the case when using the 'linear pagetable' feature; the result was
that interrupted operations are not handled properly in certain cases.

Furthermore, previous security work making pagetable update preemptible
failed to account for 'linear pagetables' at L3 and L4 levels, making it
possible for operations to run for longer than acceptable times.

IMPACT
======

Malicious or buggy x86 PV guest kernels can mount a Denial of Service
(DoS) attack affecting the whole system.

VULNERABLE SYSTEMS
==================

All Xen versions are vulnerable.

Only x86 systems are affected.  ARM systems are not affected.

Only Xen versions which permit linear page table use by PV guests are
vulnerable.

Only x86 PV guests can leverage this vulnerability.  x86 HVM guests
cannot leverage this vulnerability.

MITIGATION
==========

Not permitting linear page table use by PV guests avoids the
vulnerability.  This can be done both at build time, by turning off the
PV_LINEAR_PT configure option, or at runtime, by passing specifying
"pv-linear-pt=0" on the hypervisor command line.  Doing so would,
however, render PV guests using the functionality, like NetBSD,
unusable.

On systems where the guest kernel is controlled by the host rather than
guest administrator, running only kernels which only issue sane
hypercalls will prevent untrusted guest users from exploiting this
issue.  However untrusted guest administrators can still trigger it
unless further steps are taken to prevent them from loading code into
the kernel (e.g by disabling loadable modules etc) or from using other
mechanisms which allow them to run code at kernel privilege.

Running only HVM guests will avoid this vulnerability.

CREDITS
=======

This issue was discovered by Manuel Bouyer.

RESOLUTION
==========

Applying the appropriate pair of attached patches resolves this issue.

xsa290/unstable-?.patch         xen-unstable
xsa290/4.11-?.patch             Xen 4.11.x
xsa290/4.10-?.patch             Xen 4.10.x
xsa290/4.9-?.patch              Xen 4.9.x
xsa290/4.8-?.patch              Xen 4.8.x
xsa290/4.7-?.patch              Xen 4.7.x

$ sha256sum xsa290* xsa290*/*
e74014bf97f223f35dc6142fbfadd8a3df6c7ecf1818d5d04ebb717a1d600959  xsa290.meta
87ffaf9712bfd2283e845d168811e572b9ebc8a580e750128586a48e65ae4c67  xsa290/4.7-1.patch
4137eb15d963a77ff302cb65f9f04e402ea23f69042f89ece4baaf4b7a58d638  xsa290/4.7-2.patch
0f5ce8c13c99431cae69736e117c7420c3202e3a680b42a66027646ae0aa141c  xsa290/4.8-1.patch
bb4102dd6f3daf60859a88b6a2f0828bc8aeb224d3d3b6fd2d2cc96b3f131a24  xsa290/4.8-2.patch
a7e4902968529289c63149608d48e1eeac2feffa644e1337b1b5b9a624dc746d  xsa290/4.9-1.patch
7798b063a8db95fc18bca1ea25d84937fbe9c6e0add15056841fd97d5aec2885  xsa290/4.9-2.patch
3a0bf44875bb5a8525b4418d6efd49bd6ed6cfaffe669cbdcfde61a65fe9cdea  xsa290/4.10-1.patch
1e7dfe1b0c57e245daef1351db855a9312a4c225c05a6720460ea4aa1148ee22  xsa290/4.10-2.patch
3dd47f3bc1a004260d05cba548a80e475f85ffe60b663879de386e32a8e9ffbc  xsa290/4.11-1.patch
b3b17546fc553bf60572cf56023d8177f96973fcd072a8adfc622b4030e58d00  xsa290/4.11-2.patch
4ff1d857f46a781fd7483a30297ebf51bf079ccd1d598df799e5779ddc893674  xsa290/unstable-1.patch
3a85ecc426d482052aaf2a84bfde9840eb7a566638dbab042dac84b0019ca473  xsa290/unstable-2.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or the HVM-only as well as host controlled
kernel mitigations described above (or others which are substantially
similar) is permitted during the embargo, even on public-facing systems
with untrusted guest users and administrators.

HOWEVER deployment of the "pv-linear-pt=0" mitigation described above is
NOT permitted (except where all the affected systems and VMs are
administered and used only by organisations which are members of the Xen
Project Security Issues Predisclosure List).  Specifically, deployment
on public cloud systems is NOT permitted.

This is because in that case the configuration change is visible to the
guest, which could lead to the rediscovery of the vulnerability.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl2y19YMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZj0kIAK0GjYVugAQ4Neq0Dsr9JZFKdPCV+AiBRg2Di8ME
HvLYoMzG7OOP7L0LnyZh1qSxfCXalKuMitNhOFH4zUHIOl4XA8iSEmxKhE6aKXCu
TLngS5KCsqXb11+vDJsx7K4Z5UW7AXZwpI6jfi5nmXBEhRo9rdvO0y7I+j9x3v08
4TNSRE6lIO2OePCwOHbE9iUCHOvpldJ6PG9tDsBwsWdWgiMsPHk5XZI1Saiqa2r0
yoMD+ma6huWVph1Th+qlpjy1IORwcRp/y1OcSXzB8QX0Oz2ynaO/BZZNnm4LS3sD
Ub9BlY01fC/g1evvh97/M//D4GRP6xEe5g3n2V5drD6Zaws=
=dqbz
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa290.meta"
Content-Disposition: attachment; filename="xsa290.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyOTAsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIsCiAgICAiNC45IiwK
ICAgICI0LjgiLAogICAgIjQuNyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4
ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICJhMDE2YjhmMjA3YzdhM2ZlOGJkZDJiNmY3YzA4MDAyMGUzZTFj
ODIzIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAyODQs
CiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAogICAgICAgICAg
ICAyODgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAg
ICAgICAgICAgInhzYTI5MC80LjEwLVsxMl0ucGF0Y2giCiAgICAgICAgICBd
CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTEiOiB7CiAgICAg
ICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAiU3Rh
YmxlUmVmIjogIjg3ZjUxYmYzNjZjYTc5Yjk4ZTFlMjAxYmY5YmQ3YTljMTY0
NjMxZTIiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAgIDI4
NCwKICAgICAgICAgICAgMjg1LAogICAgICAgICAgICAyODcsCiAgICAgICAg
ICAgIDI4OAogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwog
ICAgICAgICAgICAieHNhMjkwLzQuMTEtWzEyXS5wYXRjaCIKICAgICAgICAg
IF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC43IjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICI3MTBjYzA5Njk3MTAxOWJjMmU1YTlhYWJiOWFmMWFjY2Ew
YjViOWU3IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAy
ODQsCiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAogICAgICAg
ICAgICAyODgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsK
ICAgICAgICAgICAgInhzYTI5MC80LjctWzEyXS5wYXRjaCIKICAgICAgICAg
IF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC44IjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICI5MDhlNzY4ZmFlNDlhOGRiMDA4OWU2ODE4ODY1MjA3OWUz
YmZhYTY2IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAy
ODQsCiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAogICAgICAg
ICAgICAyODgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsK
ICAgICAgICAgICAgInhzYTI5MC80LjgtWzEyXS5wYXRjaCIKICAgICAgICAg
IF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC45IjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICJmNWFjZjk3ZjY2OWM2YmM5NjkxZTAzNzcxYWQwNjcwM2Rh
NzdlMGQ1IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAy
ODQsCiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAogICAgICAg
ICAgICAyODgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsK
ICAgICAgICAgICAgInhzYTI5MC80LjktWzEyXS5wYXRjaCIKICAgICAgICAg
IF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAibWFzdGVyIjogewog
ICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAg
IlN0YWJsZVJlZiI6ICIyNGQ1MjgyNTI3ZjQ2NDc5MDdiMzU3MjgyMGI1MzM1
YzE1Y2QwMzU2IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAg
ICAyODQsCiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3LAogICAg
ICAgICAgICAyODgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6
IFsKICAgICAgICAgICAgInhzYTI5MC91bnN0YWJsZS1bMTJdLnBhdGNoIgog
ICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ==

--=separator
Content-Type: application/octet-stream; name="xsa290/4.7-1.patch"
Content-Disposition: attachment; filename="xsa290/4.7-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFsc28gYWxsb3cgTDIgKHVuKXZhbGlkYXRpb24gdG8gYmUg
cHJlZW1wdGlibGUKCkJlc2lkZXMgdGhpcyBoYXZpbmcgYmVjb21lIGEgcmVx
dWlyZW1lbnQgYXMgb2YgY29tbWl0IGM2MTI0ODFkMWMKKCJ4ODYvbW06IFBs
dW1iaW5nIHRvIGFsbG93IGFueSBQVEUgdXBkYXRlIHRvIGZhaWwgd2l0aCAt
RVJFU1RBUlQiKSwKd2hpY2ggYWRkZWQgYW4gYXNzZXJ0aW9uIHRvIGZyZWVf
bDJfdGFibGUoKSwgd2hpY2ggd2FzIG5vdyBvYnNlcnZlZCB0bwp0cmlnZ2Vy
IHdoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVzIGdldCBjbGVhbmVkIHVwLCBp
dCB3YXMgYWxzbyBhIG1pc3Rha2UKdG8gbm90IGV4dGVuZCBwcmVlbXB0aW9u
IHRvIEwyIHdoZW4gaXQgd2FzIGFkZGVkIHRvIEwzL0w0IHRhYmxlCmhhbmRs
aW5nLiBUaGlzIGlzIGJlY2F1c2UgaW4gdGhlIHJlY3Vyc2l2ZSBwYWdlIHRh
YmxlIGNhc2UgZXZlbiB0aGVyZQp0aGUgdGltZSB0YWtlbiB0byB1bnZhbGlk
YXRlIGEgc2luZ2xlIHRhYmxlIG1heSBiZSBleGNlc3NpdmUuCgpUaGUgdmFs
aWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0IGZvciBzeW1t
ZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKUmVwb3J0ZWQtYnk6
IE1hbnVlbCBCb3V5ZXIgPGJvdXllckBhbnRpb2NoZS5ldS5vcmc+ClRlc3Rl
ZC1ieTogTWFudWVsIEJvdXllciA8Ym91eWVyQGFudGlvY2hlLmV1Lm9yZz4K
U2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29t
PgpSZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNA
Y2l0cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9tbS5jCkBAIC0xMjM5LDcgKzEyMzksNyBAQCBnZXRfcGFn
ZV9mcm9tX2wxZSgKIGRlZmluZV9nZXRfbGluZWFyX3BhZ2V0YWJsZShsMik7
CiBzdGF0aWMgaW50CiBnZXRfcGFnZV9mcm9tX2wyZSgKLSAgICBsMl9wZ2Vu
dHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwgc3RydWN0IGRvbWFpbiAq
ZCkKKyAgICBsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwg
c3RydWN0IGRvbWFpbiAqZCwgaW50IHBhcnRpYWwpCiB7CiAgICAgdW5zaWdu
ZWQgbG9uZyBtZm4gPSBsMmVfZ2V0X3BmbihsMmUpOwogICAgIGludCByYzsK
QEAgLTEyNTUsNyArMTI1NSw4IEBAIGdldF9wYWdlX2Zyb21fbDJlKAogCiAg
ICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3MobDJlKSAmIF9QQUdFX1BTRSkgKQog
ICAgIHsKLSAgICAgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3Bh
Z2VucihtZm4sIFBHVF9sMV9wYWdlX3RhYmxlLCBkLCAwLCAwKTsKKyAgICAg
ICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX3BhZ2VucihtZm4sIFBH
VF9sMV9wYWdlX3RhYmxlLCBkLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHBhcnRpYWwsIDApOwogICAgICAgICBpZiAo
IHVubGlrZWx5KHJjID09IC1FSU5WQUwpICYmIGdldF9sMl9saW5lYXJfcGFn
ZXRhYmxlKGwyZSwgcGZuLCBkKSApCiAgICAgICAgICAgICByYyA9IDA7CiAg
ICAgICAgIHJldHVybiByYzsKQEAgLTE0NTAsOCArMTQ1MSwxMSBAQCB2b2lk
IHB1dF9wYWdlX2Zyb21fbDFlKGwxX3BnZW50cnlfdCBsMWUsCiAgKiBOQi4g
VmlydHVhbCBhZGRyZXNzICdsMmUnIG1hcHMgdG8gYSBtYWNoaW5lIGFkZHJl
c3Mgd2l0aGluIGZyYW1lICdwZm4nLgogICogTm90ZSBhbHNvIHRoYXQgdGhp
cyBhdXRvbWF0aWNhbGx5IGRlYWxzIGNvcnJlY3RseSB3aXRoIGxpbmVhciBw
LnQuJ3MuCiAgKi8KLXN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4pCitzdGF0aWMgaW50
IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVk
IGxvbmcgcGZuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQg
cGFydGlhbCwgYm9vbF90IGRlZmVyKQogeworICAgIGludCByYyA9IDA7CisK
ICAgICBpZiAoICEobDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0VfUFJFU0VO
VCkgfHwgKGwyZV9nZXRfcGZuKGwyZSkgPT0gcGZuKSApCiAgICAgICAgIHJl
dHVybiAxOwogCkBAIC0xNDYwLDEzICsxNDY0LDI3IEBAIHN0YXRpYyBpbnQg
cHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV8KICAgICBlbHNlCiAgICAg
ewogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGwyZV9nZXRfcGFn
ZShsMmUpOwotICAgICAgICBpbnQgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywg
MCwgbWZuX3RvX3BhZ2UocGZuKSk7CisgICAgICAgIHN0cnVjdCBwYWdlX2lu
Zm8gKnB0cGcgPSBtZm5fdG9fcGFnZShwZm4pOwogCi0gICAgICAgIEFTU0VS
VCghcmMpOwotICAgICAgICBwdXRfcGFnZShwZyk7CisgICAgICAgIGlmICgg
dW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgeworICAgICAgICAg
ICAgQVNTRVJUKCFkZWZlcik7CisgICAgICAgICAgICByYyA9IF9wdXRfcGFn
ZV90eXBlKHBnLCAxLCBwdHBnKTsKKyAgICAgICAgfQorICAgICAgICBlbHNl
IGlmICggZGVmZXIgKQorICAgICAgICB7CisgICAgICAgICAgICBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gcHRwZzsKKyAgICAgICAgICAgIGN1
cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAgIH0K
KyAgICAgICAgZWxzZQorICAgICAgICB7CisgICAgICAgICAgICByYyA9IF9w
dXRfcGFnZV90eXBlKHBnLCAxLCBwdHBnKTsKKyAgICAgICAgICAgIGlmICgg
bGlrZWx5KCFyYykgKQorICAgICAgICAgICAgICAgIHB1dF9wYWdlKHBnKTsK
KyAgICAgICAgfQogICAgIH0KIAotICAgIHJldHVybiAwOworICAgIHJldHVy
biByYzsKIH0KIAogc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wzZShsM19w
Z2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwKQEAgLTE2NDEsMTEg
KzE2NTksMTIgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3Qg
cGFnZV9pbgogICAgIHVuc2lnbmVkIGxvbmcgIHBmbiA9IHBhZ2VfdG9fbWZu
KHBhZ2UpOwogICAgIGwyX3BnZW50cnlfdCAgKnBsMmU7CiAgICAgdW5zaWdu
ZWQgaW50ICAgaTsKLSAgICBpbnQgICAgICAgICAgICByYyA9IDA7CisgICAg
aW50ICAgICAgICAgICAgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlh
bF9wdGU7CiAKICAgICBwbDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZu
KSk7CiAKLSAgICBmb3IgKCBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7
IGkgPCBMMl9QQUdFVEFCTEVfRU5UUklFUzsgaSsrICkKKyAgICBmb3IgKCBp
ID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMMl9QQUdFVEFCTEVf
RU5UUklFUzsKKyAgICAgICAgICBpKyssIHBhcnRpYWwgPSAwICkKICAgICB7
CiAgICAgICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzICYm
IGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQogICAgICAgICB7CkBAIC0x
NjU1LDIzICsxNjc0LDMzIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUo
c3RydWN0IHBhZ2VfaW4KICAgICAgICAgfQogCiAgICAgICAgIGlmICggIWlz
X2d1ZXN0X2wyX3Nsb3QoZCwgdHlwZSwgaSkgfHwKLSAgICAgICAgICAgICAo
cmMgPSBnZXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIGQpKSA+IDAg
KQorICAgICAgICAgICAgIChyYyA9IGdldF9wYWdlX2Zyb21fbDJlKHBsMmVb
aV0sIHBmbiwgZCwgcGFydGlhbCkpID4gMCApCiAgICAgICAgICAgICBjb250
aW51ZTsKIAotICAgICAgICBpZiAoIHVubGlrZWx5KHJjID09IC1FUkVTVEFS
VCkgKQorICAgICAgICBpZiAoIHJjID09IC1FUkVTVEFSVCApCiAgICAgICAg
IHsKICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsK
LSAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgcGFnZS0+cGFydGlh
bF9wdGUgPSBwYXJ0aWFsID86IDE7CiAgICAgICAgIH0KLQotICAgICAgICBp
ZiAoIHJjIDwgMCApCisgICAgICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIg
JiYgaSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRl
ID0gMDsKKyAgICAgICAgICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICB9
CisgICAgICAgIGVsc2UgaWYgKCByYyA8IDAgJiYgcmMgIT0gLUVJTlRSICkK
ICAgICAgICAgewogICAgICAgICAgICAgTUVNX0xPRygiRmFpbHVyZSBpbiBh
bGxvY19sMl90YWJsZTogZW50cnkgJWQiLCBpKTsKLSAgICAgICAgICAgIHdo
aWxlICggaS0tID4gMCApCi0gICAgICAgICAgICAgICAgaWYgKCBpc19ndWVz
dF9sMl9zbG90KGQsIHR5cGUsIGkpICkKLSAgICAgICAgICAgICAgICAgICAg
cHV0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuKTsKLSAgICAgICAgICAg
IGJyZWFrOworICAgICAgICAgICAgaWYgKCBpICkKKyAgICAgICAgICAgIHsK
KyAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7
CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAwOworICAg
ICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBO
VUxMOworICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0
X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgIH0KICAgICAgICAgfQorICAg
ICAgICBpZiAoIHJjIDwgMCApCisgICAgICAgICAgICBicmVhazsKIAogICAg
ICAgICBhZGp1c3RfZ3Vlc3RfbDJlKHBsMmVbaV0sIGQpOwogICAgIH0KQEAg
LTE4OTMsMjggKzE5MjIsNTAgQEAgc3RhdGljIGludCBmcmVlX2wyX3RhYmxl
KHN0cnVjdCBwYWdlX2luZgogICAgIHN0cnVjdCBkb21haW4gKmQgPSBwYWdl
X2dldF9vd25lcihwYWdlKTsKICAgICB1bnNpZ25lZCBsb25nIHBmbiA9IHBh
Z2VfdG9fbWZuKHBhZ2UpOwogICAgIGwyX3BnZW50cnlfdCAqcGwyZTsKLSAg
ICB1bnNpZ25lZCBpbnQgIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAt
IDE7Ci0gICAgaW50IGVyciA9IDA7CisgICAgaW50IHJjID0gMCwgcGFydGlh
bCA9IHBhZ2UtPnBhcnRpYWxfcHRlOworICAgIHVuc2lnbmVkIGludCBpID0g
cGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhcGFydGlhbDsKIAogICAgIHBs
MmUgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4pKTsKIAotICAgIEFTU0VS
VChwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyk7Ci0gICAgZG8gewotICAgICAg
ICBpZiAoIGlzX2d1ZXN0X2wyX3Nsb3QoZCwgcGFnZS0+dS5pbnVzZS50eXBl
X2luZm8sIGkpICYmCi0gICAgICAgICAgICAgcHV0X3BhZ2VfZnJvbV9sMmUo
cGwyZVtpXSwgcGZuKSA9PSAwICYmCi0gICAgICAgICAgICAgaSAmJiBoeXBl
cmNhbGxfcHJlZW1wdF9jaGVjaygpICkKKyAgICBmb3IgKCA7IDsgKQorICAg
IHsKKyAgICAgICAgaWYgKCBpc19ndWVzdF9sMl9zbG90KGQsIHBhZ2UtPnUu
aW51c2UudHlwZV9pbmZvLCBpKSApCisgICAgICAgICAgICByYyA9IHB1dF9w
YWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbiwgcGFydGlhbCwgMCk7CisgICAg
ICAgIGlmICggcmMgPCAwICkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAg
ICAgIHBhcnRpYWwgPSAwOworCisgICAgICAgIGlmICggIWktLSApCisgICAg
ICAgICAgICBicmVhazsKKworICAgICAgICBpZiAoIGh5cGVyY2FsbF9wcmVl
bXB0X2NoZWNrKCkgKQogICAgICAgICB7Ci0gICAgICAgICAgIHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgZXJyID0gLUVSRVNU
QVJUOworICAgICAgICAgICAgcmMgPSAtRUlOVFI7CisgICAgICAgICAgICBi
cmVhazsKICAgICAgICAgfQotICAgIH0gd2hpbGUgKCAhZXJyICYmIGktLSAp
OworICAgIH0KIAogICAgIHVubWFwX2RvbWFpbl9wYWdlKHBsMmUpOwogCi0g
ICAgaWYgKCAhZXJyICkKKyAgICBpZiAoIHJjID49IDAgKQorICAgIHsKICAg
ICAgICAgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJj0gflBHVF9wYWVfeGVu
X2wyOworICAgICAgICByYyA9IDA7CisgICAgfQorICAgIGVsc2UgaWYgKCBy
YyA9PSAtRVJFU1RBUlQgKQorICAgIHsKKyAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOworICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IHBhcnRpYWwgPzogLTE7CisgICAgfQorICAgIGVsc2UgaWYgKCByYyA9PSAt
RUlOVFIgJiYgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCisgICAg
eworICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGkgKyAxOwor
ICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgIHJjID0g
LUVSRVNUQVJUOworICAgIH0KIAotICAgIHJldHVybiBlcnI7CisgICAgcmV0
dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKQEAgLTIyMzksNyArMjI5MCw3IEBAIHN0YXRp
YyBpbnQgbW9kX2wyX2VudHJ5KGwyX3BnZW50cnlfdCAqcGwKICAgICAgICAg
ICAgIHJldHVybiAtRUJVU1k7CiAgICAgICAgIH0KIAotICAgICAgICBpZiAo
IHVubGlrZWx5KChyYyA9IGdldF9wYWdlX2Zyb21fbDJlKG5sMmUsIHBmbiwg
ZCkpIDwgMCkgKQorICAgICAgICBpZiAoIHVubGlrZWx5KChyYyA9IGdldF9w
YWdlX2Zyb21fbDJlKG5sMmUsIHBmbiwgZCwgMCkpIDwgMCkgKQogICAgICAg
ICAgICAgcmV0dXJuIHJjOwogCiAgICAgICAgIGFkanVzdF9ndWVzdF9sMmUo
bmwyZSwgZCk7CkBAIC0yMjU4LDcgKzIzMDksOCBAQCBzdGF0aWMgaW50IG1v
ZF9sMl9lbnRyeShsMl9wZ2VudHJ5X3QgKnBsCiAgICAgICAgIHJldHVybiAt
RUJVU1k7CiAgICAgfQogCi0gICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwg
cGZuKTsKKyAgICBwdXRfcGFnZV9mcm9tX2wyZShvbDJlLCBwZm4sIDAsIDEp
OworCiAgICAgcmV0dXJuIHJjOwogfQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa290/4.7-2.patch"
Content-Disposition: attachment; filename="xsa290/4.7-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFkZCBleHBsaWNpdCBwcmVlbXB0aW9uIGNoZWNrcyB0byBM
MyAodW4pdmFsaWRhdGlvbgoKV2hlbiByZWN1cnNpdmUgcGFnZSB0YWJsZXMg
YXJlIHVzZWQgYXQgdGhlIEwzIGxldmVsLCB1bnZhbGlkYXRpb24gb2YgYQpz
aW5nbGUgTDQgdGFibGUgbWF5IGluY3VyIHVudmFsaWRhdGlvbiBvZiB0d28g
bGV2ZWxzIG9mIEwzIHRhYmxlcywgaS5lLgphIG1heGltdW0gaXRlcmF0aW9u
IGNvdW50IG9mIDUxMl4zIGZvciB1bnZhbGlkYXRpbmcgYW4gTDQgdGFibGUu
IFRoZQpwcmVlbXB0aW9uIGNoZWNrIGluIGZyZWVfbDJfdGFibGUoKSBhcyB3
ZWxsIGFzIHRoZSBvbmUgaW4KX3B1dF9wYWdlX3R5cGUoKSBtYXkgbmV2ZXIg
YmUgcmVhY2hlZCwgc28gZXhwbGljaXQgY2hlY2tpbmcgaXMgbmVlZGVkIGlu
CmZyZWVfbDNfdGFibGUoKS4KCldoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVz
IGFyZSB1c2VkIGF0IHRoZSBMNCBsZXZlbCwgdGhlIGl0ZXJhdGlvbiBjb3Vu
dAphdCBMNCBhbG9uZSBpcyBjYXBwZWQgYXQgNTEyXjIuIEFzIHNvb24gYXMg
YSBwcmVzZW50IEwzIGVudHJ5IGlzIGhpdAp3aGljaCBpdHNlbGYgbmVlZHMg
dW52YWxpZGF0aW9uIChhbmQgaGVuY2UgcmVxdWlyaW5nIGFub3RoZXIgbmVz
dGVkIGxvb3AKd2l0aCA1MTIgaXRlcmF0aW9ucyksIHRoZSBwcmVlbXB0aW9u
IGNoZWNrcyBhZGRlZCBoZXJlIGtpY2sgaW4sIHNvIG5vCmZ1cnRoZXIgcHJl
ZW1wdGlvbiBjaGVja2luZyBpcyBuZWVkZWQgYXQgTDQgKHVudGlsIHdlIGRl
Y2lkZSB0byBwZXJtaXQKNS1sZXZlbCBwYWdpbmcgZm9yIFBWIGd1ZXN0cyku
CgpUaGUgdmFsaWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0
IGZvciBzeW1tZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0
cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCkBAIC0xNzQxLDYgKzE3NDEsMTMgQEAgc3RhdGljIGlu
dCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbgogICAgIGZvciAoIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQogICAgIHsK
KyAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYg
aHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KKwogICAgICAgICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSAm
JiAoaSA9PSAzKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggIShs
M2VfZ2V0X2ZsYWdzKHBsM2VbaV0pICYgX1BBR0VfUFJFU0VOVCkgfHwKQEAg
LTE5NzgsMTggKzE5ODUsMjggQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxl
KHN0cnVjdCBwYWdlX2luZgogCiAgICAgcGwzZSA9IG1hcF9kb21haW5fcGFn
ZShfbWZuKHBmbikpOwogCi0gICAgZG8geworICAgIGZvciAoIDsgOyApCisg
ICAgewogICAgICAgICBpZiAoIGlzX2d1ZXN0X2wzX3Nsb3QoaSkgKQogICAg
ICAgICB7CiAgICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBs
M2VbaV0sIHBmbiwgcGFydGlhbCwgMCk7CiAgICAgICAgICAgICBpZiAoIHJj
IDwgMCApCiAgICAgICAgICAgICAgICAgYnJlYWs7CisKICAgICAgICAgICAg
IHBhcnRpYWwgPSAwOwotICAgICAgICAgICAgaWYgKCByYyA+IDAgKQotICAg
ICAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICAgICAgdW5hZGp1c3Rf
Z3Vlc3RfbDNlKHBsM2VbaV0sIGQpOworICAgICAgICAgICAgaWYgKCByYyA9
PSAwICkKKyAgICAgICAgICAgICAgICB1bmFkanVzdF9ndWVzdF9sM2UocGwz
ZVtpXSwgZCk7CiAgICAgICAgIH0KLSAgICB9IHdoaWxlICggaS0tICk7CisK
KyAgICAgICAgaWYgKCAhaS0tICkKKyAgICAgICAgICAgIGJyZWFrOworCisg
ICAgICAgIGlmICggaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAgICAgICAg
YnJlYWs7CisgICAgICAgIH0KKyAgICB9CiAKICAgICB1bm1hcF9kb21haW5f
cGFnZShwbDNlKTsKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa290/4.8-1.patch"
Content-Disposition: attachment; filename="xsa290/4.8-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFsc28gYWxsb3cgTDIgKHVuKXZhbGlkYXRpb24gdG8gYmUg
cHJlZW1wdGlibGUKCkNvbW1pdCBjNjEyNDgxZDFjICgieDg2L21tOiBQbHVt
YmluZyB0byBhbGxvdyBhbnkgUFRFIHVwZGF0ZSB0byBmYWlsCndpdGggLUVS
RVNUQVJUIikgYWRkZWQgYXNzZXJ0aW9ucyBuZXh0IHRvIHRoZSB7YWxsb2Ms
ZnJlZX1fbDJfdGFibGUoKQppbnZvY2F0aW9ucyB0byBkb2N1bWVudCAoYW5k
IHZhbGlkYXRlIGluIGRlYnVnIGJ1aWxkcykgdGhhdCBMMgoodW4pdmFsaWRh
dGlvbnMgYXJlIGFsd2F5cyBwcmVlbXB0aWJsZS4KClRoZSBhc3NlcnRpb24g
aW4gZnJlZV9wYWdlX3R5cGUoKSB3YXMgbm93IG9ic2VydmVkIHRvIHRyaWdn
ZXIgd2hlbgpyZWN1cnNpdmUgTDIgcGFnZSB0YWJsZXMgZ2V0IGNsZWFuZWQg
dXAuCgpJbiBwYXJ0aWN1bGFyIHB1dF9wYWdlX2Zyb21fbDJlKCkncyBhc3N1
bXB0aW9uIHRoYXQgX3B1dF9wYWdlX3R5cGUoKQp3b3VsZCBhbHdheXMgc3Vj
Y2VlZCBpcyBub3cgd3JvbmcsIHJlc3VsdGluZyBpbiBhIHBhcnRpYWxseSB1
bi12YWxpZGF0ZWQKcGFnZSBsZWZ0IGluIGEgZG9tYWluLCB3aGljaCBoYXMg
bm8gb3RoZXIgbWVhbnMgb2YgZ2V0dGluZyBjbGVhbmVkIHVwCmxhdGVyIG9u
LiBJZiBub3QgY2F1c2luZyBhbnkgcHJvYmxlbXMgZWFybGllciwgdGhpcyB3
b3VsZCB1bHRpbWF0ZWx5CnRyaWdnZXIgdGhlIGNoZWNrIGZvciAtPnUuaW51
c2UudHlwZV9pbmZvIGhhdmluZyBhIHplcm8gY291bnQgd2hlbgpmcmVlaW5n
IHRoZSBwYWdlIGR1cmluZyBjbGVhbnVwIGFmdGVyIHRoZSBkb21haW4gaGFz
IGRpZWQuCgpBcyBhIHJlc3VsdCBpdCBzaG91bGQgYmUgY29uc2lkZXJlZCBh
IG1pc3Rha2UgdG8gbm90IGhhdmUgZXh0ZW5kZWQKcHJlZW1wdGlvbiBmdWxs
eSB0byBMMiB3aGVuIGl0IHdhcyBhZGRlZCB0byBMMy9MNCB0YWJsZSBoYW5k
bGluZywgd2hpY2gKdGhpcyBjaGFuZ2UgYWltcyB0byBjb3JyZWN0LgoKVGhl
IHZhbGlkYXRpb24gc2lkZSBhZGRpdGlvbnMgYXJlIGRvbmUganVzdCBmb3Ig
c3ltbWV0cnkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5MC4KClJlcG9ydGVk
LWJ5OiBNYW51ZWwgQm91eWVyIDxib3V5ZXJAYW50aW9jaGUuZXUub3JnPgpU
ZXN0ZWQtYnk6IE1hbnVlbCBCb3V5ZXIgPGJvdXllckBhbnRpb2NoZS5ldS5v
cmc+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29w
ZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysg
Yi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTI0MCw3ICsxMjQwLDcgQEAgZ2V0
X3BhZ2VfZnJvbV9sMWUoCiBkZWZpbmVfZ2V0X2xpbmVhcl9wYWdldGFibGUo
bDIpOwogc3RhdGljIGludAogZ2V0X3BhZ2VfZnJvbV9sMmUoCi0gICAgbDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21h
aW4gKmQpCisgICAgbDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBw
Zm4sIHN0cnVjdCBkb21haW4gKmQsIGludCBwYXJ0aWFsKQogewogICAgIHVu
c2lnbmVkIGxvbmcgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKICAgICBpbnQg
cmM7CkBAIC0xMjU2LDcgKzEyNTYsOCBAQCBnZXRfcGFnZV9mcm9tX2wyZSgK
IAogICAgIGlmICggIShsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QU0Up
ICkKICAgICB7Ci0gICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9wYWdlbnIobWZuLCBQR1RfbDFfcGFnZV90YWJsZSwgZCwgMCwgMCk7Cisg
ICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobWZu
LCBQR1RfbDFfcGFnZV90YWJsZSwgZCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsLCBmYWxzZSk7CiAgICAg
ICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkgJiYgZ2V0X2wyX2xp
bmVhcl9wYWdldGFibGUobDJlLCBwZm4sIGQpICkKICAgICAgICAgICAgIHJj
ID0gMDsKICAgICAgICAgcmV0dXJuIHJjOwpAQCAtMTQ1MSw4ICsxNDUyLDEx
IEBAIHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFfcGdlbnRyeV90IGwxZSwK
ICAqIE5CLiBWaXJ0dWFsIGFkZHJlc3MgJ2wyZScgbWFwcyB0byBhIG1hY2hp
bmUgYWRkcmVzcyB3aXRoaW4gZnJhbWUgJ3BmbicuCiAgKiBOb3RlIGFsc28g
dGhhdCB0aGlzIGF1dG9tYXRpY2FsbHkgZGVhbHMgY29ycmVjdGx5IHdpdGgg
bGluZWFyIHAudC4ncy4KICAqLwotc3RhdGljIGludCBwdXRfcGFnZV9mcm9t
X2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbikKK3N0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwg
dW5zaWduZWQgbG9uZyBwZm4sCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQogeworICAgIGludCByYyA9
IDA7CisKICAgICBpZiAoICEobDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0Vf
UFJFU0VOVCkgfHwgKGwyZV9nZXRfcGZuKGwyZSkgPT0gcGZuKSApCiAgICAg
ICAgIHJldHVybiAxOwogCkBAIC0xNDYxLDEzICsxNDY1LDI3IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV8KICAgICBlbHNl
CiAgICAgewogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGwyZV9n
ZXRfcGFnZShsMmUpOwotICAgICAgICBpbnQgcmMgPSBfcHV0X3BhZ2VfdHlw
ZShwZywgZmFsc2UsIG1mbl90b19wYWdlKHBmbikpOworICAgICAgICBzdHJ1
Y3QgcGFnZV9pbmZvICpwdHBnID0gbWZuX3RvX3BhZ2UocGZuKTsKIAotICAg
ICAgICBBU1NFUlQoIXJjKTsKLSAgICAgICAgcHV0X3BhZ2UocGcpOworICAg
ICAgICBpZiAoIHVubGlrZWx5KHBhcnRpYWwgPiAwKSApCisgICAgICAgIHsK
KyAgICAgICAgICAgIEFTU0VSVCghZGVmZXIpOworICAgICAgICAgICAgcmMg
PSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7CisgICAgICAgIH0K
KyAgICAgICAgZWxzZSBpZiAoIGRlZmVyICkKKyAgICAgICAgeworICAgICAg
ICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IHB0cGc7Cisg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBn
OworICAgICAgICB9CisgICAgICAgIGVsc2UKKyAgICAgICAgeworICAgICAg
ICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7Cisg
ICAgICAgICAgICBpZiAoIGxpa2VseSghcmMpICkKKyAgICAgICAgICAgICAg
ICBwdXRfcGFnZShwZyk7CisgICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1
cm4gMDsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBpbnQgcHV0X3Bh
Z2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBw
Zm4sCkBAIC0xNjQwLDExICsxNjU4LDEyIEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDJfdGFibGUoc3RydWN0IHBhZ2VfaW4KICAgICB1bnNpZ25lZCBsb25nICBw
Zm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsMl9wZ2VudHJ5X3QgICpw
bDJlOwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAg
ICAgcmMgPSAwOworICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlh
bCA9IHBhZ2UtPnBhcnRpYWxfcHRlOwogCiAgICAgcGwyZSA9IG1hcF9kb21h
aW5fcGFnZShfbWZuKHBmbikpOwogCi0gICAgZm9yICggaSA9IHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzOyBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkr
KyApCisgICAgZm9yICggaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzOyBp
IDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7CisgICAgICAgICAgaSsrLCBwYXJ0
aWFsID0gMCApCiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkK
ICAgICAgICAgewpAQCAtMTY1NCwyMyArMTY3MywzMyBAQCBzdGF0aWMgaW50
IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luCiAgICAgICAgIH0KIAog
ICAgICAgICBpZiAoICFpc19ndWVzdF9sMl9zbG90KGQsIHR5cGUsIGkpIHx8
Ci0gICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwyZVtp
XSwgcGZuLCBkKSkgPiAwICkKKyAgICAgICAgICAgICAocmMgPSBnZXRfcGFn
ZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIGQsIHBhcnRpYWwpKSA+IDAgKQog
ICAgICAgICAgICAgY29udGludWU7CiAKLSAgICAgICAgaWYgKCB1bmxpa2Vs
eShyYyA9PSAtRVJFU1RBUlQpICkKKyAgICAgICAgaWYgKCByYyA9PSAtRVJF
U1RBUlQgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBicmVhazsKKyAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAxOwogICAgICAg
ICB9Ci0KLSAgICAgICAgaWYgKCByYyA8IDAgKQorICAgICAgICBlbHNlIGlm
ICggcmMgPT0gLUVJTlRSICYmIGkgKQorICAgICAgICB7CisgICAgICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CisgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICByYyA9IC1FUkVT
VEFSVDsKKyAgICAgICAgfQorICAgICAgICBlbHNlIGlmICggcmMgPCAwICYm
IHJjICE9IC1FSU5UUiApCiAgICAgICAgIHsKICAgICAgICAgICAgIE1FTV9M
T0coIkZhaWx1cmUgaW4gYWxsb2NfbDJfdGFibGU6IGVudHJ5ICVkIiwgaSk7
Ci0gICAgICAgICAgICB3aGlsZSAoIGktLSA+IDAgKQotICAgICAgICAgICAg
ICAgIGlmICggaXNfZ3Vlc3RfbDJfc2xvdChkLCB0eXBlLCBpKSApCi0gICAg
ICAgICAgICAgICAgICAgIHB1dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBm
bik7Ci0gICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIGlmICggaSAp
CisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgcGFnZS0+bnJfdmFs
aWRhdGVkX3B0ZXMgPSBpOworICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRp
YWxfcHRlID0gMDsKKyAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9s
ZF9ndWVzdF9wdHBnID0gTlVMTDsKKyAgICAgICAgICAgICAgICBjdXJyZW50
LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICB9
CiAgICAgICAgIH0KKyAgICAgICAgaWYgKCByYyA8IDAgKQorICAgICAgICAg
ICAgYnJlYWs7CiAKICAgICAgICAgYWRqdXN0X2d1ZXN0X2wyZShwbDJlW2ld
LCBkKTsKICAgICB9CkBAIC0xODkyLDI4ICsxOTIxLDUwIEBAIHN0YXRpYyBp
bnQgZnJlZV9sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmYKICAgICBzdHJ1Y3Qg
ZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7CiAgICAgdW5zaWdu
ZWQgbG9uZyBwZm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsMl9wZ2Vu
dHJ5X3QgKnBsMmU7Ci0gICAgdW5zaWduZWQgaW50ICBpID0gcGFnZS0+bnJf
dmFsaWRhdGVkX3B0ZXMgLSAxOwotICAgIGludCBlcnIgPSAwOworICAgIGlu
dCByYyA9IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsKKyAgICB1
bnNpZ25lZCBpbnQgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzIC0gIXBh
cnRpYWw7CiAKICAgICBwbDJlID0gbWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZu
KSk7CiAKLSAgICBBU1NFUlQocGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMpOwot
ICAgIGRvIHsKLSAgICAgICAgaWYgKCBpc19ndWVzdF9sMl9zbG90KGQsIHBh
Z2UtPnUuaW51c2UudHlwZV9pbmZvLCBpKSAmJgotICAgICAgICAgICAgIHB1
dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbikgPT0gMCAmJgotICAgICAg
ICAgICAgIGkgJiYgaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAg
Zm9yICggOyA7ICkKKyAgICB7CisgICAgICAgIGlmICggaXNfZ3Vlc3RfbDJf
c2xvdChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkgKQorICAgICAg
ICAgICAgcmMgPSBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIHBh
cnRpYWwsIGZhbHNlKTsKKyAgICAgICAgaWYgKCByYyA8IDAgKQorICAgICAg
ICAgICAgYnJlYWs7CisKKyAgICAgICAgcGFydGlhbCA9IDA7CisKKyAgICAg
ICAgaWYgKCAhaS0tICkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAg
IGlmICggaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgIHsK
LSAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAg
ICAgICAgICBlcnIgPSAtRVJFU1RBUlQ7CisgICAgICAgICAgICByYyA9IC1F
SU5UUjsKKyAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9Ci0gICAgfSB3
aGlsZSAoICFlcnIgJiYgaS0tICk7CisgICAgfQogCiAgICAgdW5tYXBfZG9t
YWluX3BhZ2UocGwyZSk7CiAKLSAgICBpZiAoICFlcnIgKQorICAgIGlmICgg
cmMgPj0gMCApCisgICAgewogICAgICAgICBwYWdlLT51LmludXNlLnR5cGVf
aW5mbyAmPSB+UEdUX3BhZV94ZW5fbDI7CisgICAgICAgIHJjID0gMDsKKyAg
ICB9CisgICAgZWxzZSBpZiAoIHJjID09IC1FUkVTVEFSVCApCisgICAgewor
ICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CisgICAgICAg
IHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAtMTsKKyAgICB9Cisg
ICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpIDwgTDJfUEFHRVRBQkxF
X0VOVFJJRVMgLSAxICkKKyAgICB7CisgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaSArIDE7CisgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRl
ID0gMDsKKyAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CisgICAgfQogCi0gICAg
cmV0dXJuIGVycjsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBpbnQg
ZnJlZV9sM190YWJsZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQpAQCAtMjIz
OCw3ICsyMjg5LDcgQEAgc3RhdGljIGludCBtb2RfbDJfZW50cnkobDJfcGdl
bnRyeV90ICpwbAogICAgICAgICAgICAgcmV0dXJuIC1FQlVTWTsKICAgICAg
ICAgfQogCi0gICAgICAgIGlmICggdW5saWtlbHkoKHJjID0gZ2V0X3BhZ2Vf
ZnJvbV9sMmUobmwyZSwgcGZuLCBkKSkgPCAwKSApCisgICAgICAgIGlmICgg
dW5saWtlbHkoKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUobmwyZSwgcGZuLCBk
LCAwKSkgPCAwKSApCiAgICAgICAgICAgICByZXR1cm4gcmM7CiAKICAgICAg
ICAgYWRqdXN0X2d1ZXN0X2wyZShubDJlLCBkKTsKQEAgLTIyNTcsNyArMjMw
OCw4IEBAIHN0YXRpYyBpbnQgbW9kX2wyX2VudHJ5KGwyX3BnZW50cnlfdCAq
cGwKICAgICAgICAgcmV0dXJuIC1FQlVTWTsKICAgICB9CiAKLSAgICBwdXRf
cGFnZV9mcm9tX2wyZShvbDJlLCBwZm4pOworICAgIHB1dF9wYWdlX2Zyb21f
bDJlKG9sMmUsIHBmbiwgMCwgdHJ1ZSk7CisKICAgICByZXR1cm4gcmM7CiB9
CiAK

--=separator
Content-Type: application/octet-stream; name="xsa290/4.8-2.patch"
Content-Disposition: attachment; filename="xsa290/4.8-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFkZCBleHBsaWNpdCBwcmVlbXB0aW9uIGNoZWNrcyB0byBM
MyAodW4pdmFsaWRhdGlvbgoKV2hlbiByZWN1cnNpdmUgcGFnZSB0YWJsZXMg
YXJlIHVzZWQgYXQgdGhlIEwzIGxldmVsLCB1bnZhbGlkYXRpb24gb2YgYQpz
aW5nbGUgTDQgdGFibGUgbWF5IGluY3VyIHVudmFsaWRhdGlvbiBvZiB0d28g
bGV2ZWxzIG9mIEwzIHRhYmxlcywgaS5lLgphIG1heGltdW0gaXRlcmF0aW9u
IGNvdW50IG9mIDUxMl4zIGZvciB1bnZhbGlkYXRpbmcgYW4gTDQgdGFibGUu
IFRoZQpwcmVlbXB0aW9uIGNoZWNrIGluIGZyZWVfbDJfdGFibGUoKSBhcyB3
ZWxsIGFzIHRoZSBvbmUgaW4KX3B1dF9wYWdlX3R5cGUoKSBtYXkgbmV2ZXIg
YmUgcmVhY2hlZCwgc28gZXhwbGljaXQgY2hlY2tpbmcgaXMgbmVlZGVkIGlu
CmZyZWVfbDNfdGFibGUoKS4KCldoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVz
IGFyZSB1c2VkIGF0IHRoZSBMNCBsZXZlbCwgdGhlIGl0ZXJhdGlvbiBjb3Vu
dAphdCBMNCBhbG9uZSBpcyBjYXBwZWQgYXQgNTEyXjIuIEFzIHNvb24gYXMg
YSBwcmVzZW50IEwzIGVudHJ5IGlzIGhpdAp3aGljaCBpdHNlbGYgbmVlZHMg
dW52YWxpZGF0aW9uIChhbmQgaGVuY2UgcmVxdWlyaW5nIGFub3RoZXIgbmVz
dGVkIGxvb3AKd2l0aCA1MTIgaXRlcmF0aW9ucyksIHRoZSBwcmVlbXB0aW9u
IGNoZWNrcyBhZGRlZCBoZXJlIGtpY2sgaW4sIHNvIG5vCmZ1cnRoZXIgcHJl
ZW1wdGlvbiBjaGVja2luZyBpcyBuZWVkZWQgYXQgTDQgKHVudGlsIHdlIGRl
Y2lkZSB0byBwZXJtaXQKNS1sZXZlbCBwYWdpbmcgZm9yIFBWIGd1ZXN0cyku
CgpUaGUgdmFsaWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0
IGZvciBzeW1tZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0
cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCkBAIC0xNzQwLDYgKzE3NDAsMTMgQEAgc3RhdGljIGlu
dCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbgogICAgIGZvciAoIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQogICAgIHsK
KyAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYg
aHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KKwogICAgICAgICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSAm
JiAoaSA9PSAzKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggIShs
M2VfZ2V0X2ZsYWdzKHBsM2VbaV0pICYgX1BBR0VfUFJFU0VOVCkgfHwKQEAg
LTE5NzcsMTggKzE5ODQsMjggQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxl
KHN0cnVjdCBwYWdlX2luZgogCiAgICAgcGwzZSA9IG1hcF9kb21haW5fcGFn
ZShfbWZuKHBmbikpOwogCi0gICAgZG8geworICAgIGZvciAoIDsgOyApCisg
ICAgewogICAgICAgICBpZiAoIGlzX2d1ZXN0X2wzX3Nsb3QoaSkgKQogICAg
ICAgICB7CiAgICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBs
M2VbaV0sIHBmbiwgcGFydGlhbCwgMCk7CiAgICAgICAgICAgICBpZiAoIHJj
IDwgMCApCiAgICAgICAgICAgICAgICAgYnJlYWs7CisKICAgICAgICAgICAg
IHBhcnRpYWwgPSAwOwotICAgICAgICAgICAgaWYgKCByYyA+IDAgKQotICAg
ICAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICAgICAgdW5hZGp1c3Rf
Z3Vlc3RfbDNlKHBsM2VbaV0sIGQpOworICAgICAgICAgICAgaWYgKCByYyA9
PSAwICkKKyAgICAgICAgICAgICAgICB1bmFkanVzdF9ndWVzdF9sM2UocGwz
ZVtpXSwgZCk7CiAgICAgICAgIH0KLSAgICB9IHdoaWxlICggaS0tICk7CisK
KyAgICAgICAgaWYgKCAhaS0tICkKKyAgICAgICAgICAgIGJyZWFrOworCisg
ICAgICAgIGlmICggaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAgICAgICAg
YnJlYWs7CisgICAgICAgIH0KKyAgICB9CiAKICAgICB1bm1hcF9kb21haW5f
cGFnZShwbDNlKTsKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa290/4.9-1.patch"
Content-Disposition: attachment; filename="xsa290/4.9-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFsc28gYWxsb3cgTDIgKHVuKXZhbGlkYXRpb24gdG8gYmUg
cHJlZW1wdGlibGUKCkNvbW1pdCBjNjEyNDgxZDFjICgieDg2L21tOiBQbHVt
YmluZyB0byBhbGxvdyBhbnkgUFRFIHVwZGF0ZSB0byBmYWlsCndpdGggLUVS
RVNUQVJUIikgYWRkZWQgYXNzZXJ0aW9ucyBuZXh0IHRvIHRoZSB7YWxsb2Ms
ZnJlZX1fbDJfdGFibGUoKQppbnZvY2F0aW9ucyB0byBkb2N1bWVudCAoYW5k
IHZhbGlkYXRlIGluIGRlYnVnIGJ1aWxkcykgdGhhdCBMMgoodW4pdmFsaWRh
dGlvbnMgYXJlIGFsd2F5cyBwcmVlbXB0aWJsZS4KClRoZSBhc3NlcnRpb24g
aW4gZnJlZV9wYWdlX3R5cGUoKSB3YXMgbm93IG9ic2VydmVkIHRvIHRyaWdn
ZXIgd2hlbgpyZWN1cnNpdmUgTDIgcGFnZSB0YWJsZXMgZ2V0IGNsZWFuZWQg
dXAuCgpJbiBwYXJ0aWN1bGFyIHB1dF9wYWdlX2Zyb21fbDJlKCkncyBhc3N1
bXB0aW9uIHRoYXQgX3B1dF9wYWdlX3R5cGUoKQp3b3VsZCBhbHdheXMgc3Vj
Y2VlZCBpcyBub3cgd3JvbmcsIHJlc3VsdGluZyBpbiBhIHBhcnRpYWxseSB1
bi12YWxpZGF0ZWQKcGFnZSBsZWZ0IGluIGEgZG9tYWluLCB3aGljaCBoYXMg
bm8gb3RoZXIgbWVhbnMgb2YgZ2V0dGluZyBjbGVhbmVkIHVwCmxhdGVyIG9u
LiBJZiBub3QgY2F1c2luZyBhbnkgcHJvYmxlbXMgZWFybGllciwgdGhpcyB3
b3VsZCB1bHRpbWF0ZWx5CnRyaWdnZXIgdGhlIGNoZWNrIGZvciAtPnUuaW51
c2UudHlwZV9pbmZvIGhhdmluZyBhIHplcm8gY291bnQgd2hlbgpmcmVlaW5n
IHRoZSBwYWdlIGR1cmluZyBjbGVhbnVwIGFmdGVyIHRoZSBkb21haW4gaGFz
IGRpZWQuCgpBcyBhIHJlc3VsdCBpdCBzaG91bGQgYmUgY29uc2lkZXJlZCBh
IG1pc3Rha2UgdG8gbm90IGhhdmUgZXh0ZW5kZWQKcHJlZW1wdGlvbiBmdWxs
eSB0byBMMiB3aGVuIGl0IHdhcyBhZGRlZCB0byBMMy9MNCB0YWJsZSBoYW5k
bGluZywgd2hpY2gKdGhpcyBjaGFuZ2UgYWltcyB0byBjb3JyZWN0LgoKVGhl
IHZhbGlkYXRpb24gc2lkZSBhZGRpdGlvbnMgYXJlIGRvbmUganVzdCBmb3Ig
c3ltbWV0cnkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5MC4KClJlcG9ydGVk
LWJ5OiBNYW51ZWwgQm91eWVyIDxib3V5ZXJAYW50aW9jaGUuZXUub3JnPgpU
ZXN0ZWQtYnk6IE1hbnVlbCBCb3V5ZXIgPGJvdXllckBhbnRpb2NoZS5ldS5v
cmc+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29w
ZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysg
Yi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTI2MSw3ICsxMjYxLDcgQEAgZ2V0
X3BhZ2VfZnJvbV9sMWUoCiBkZWZpbmVfZ2V0X2xpbmVhcl9wYWdldGFibGUo
bDIpOwogc3RhdGljIGludAogZ2V0X3BhZ2VfZnJvbV9sMmUoCi0gICAgbDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21h
aW4gKmQpCisgICAgbDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBw
Zm4sIHN0cnVjdCBkb21haW4gKmQsIGludCBwYXJ0aWFsKQogewogICAgIHVu
c2lnbmVkIGxvbmcgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKICAgICBpbnQg
cmM7CkBAIC0xMjc4LDcgKzEyNzgsOCBAQCBnZXRfcGFnZV9mcm9tX2wyZSgK
IAogICAgIGlmICggIShsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QU0Up
ICkKICAgICB7Ci0gICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9wYWdlbnIobWZuLCBQR1RfbDFfcGFnZV90YWJsZSwgZCwgMCwgMCk7Cisg
ICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9wYWdlbnIobWZu
LCBQR1RfbDFfcGFnZV90YWJsZSwgZCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsLCBmYWxzZSk7CiAgICAg
ICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkgJiYgZ2V0X2wyX2xp
bmVhcl9wYWdldGFibGUobDJlLCBwZm4sIGQpICkKICAgICAgICAgICAgIHJj
ID0gMDsKICAgICAgICAgcmV0dXJuIHJjOwpAQCAtMTQ3Nyw4ICsxNDc4LDEx
IEBAIHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFfcGdlbnRyeV90IGwxZSwK
ICAqIE5CLiBWaXJ0dWFsIGFkZHJlc3MgJ2wyZScgbWFwcyB0byBhIG1hY2hp
bmUgYWRkcmVzcyB3aXRoaW4gZnJhbWUgJ3BmbicuCiAgKiBOb3RlIGFsc28g
dGhhdCB0aGlzIGF1dG9tYXRpY2FsbHkgZGVhbHMgY29ycmVjdGx5IHdpdGgg
bGluZWFyIHAudC4ncy4KICAqLwotc3RhdGljIGludCBwdXRfcGFnZV9mcm9t
X2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbikKK3N0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwyZSwg
dW5zaWduZWQgbG9uZyBwZm4sCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQogeworICAgIGludCByYyA9
IDA7CisKICAgICBpZiAoICEobDJlX2dldF9mbGFncyhsMmUpICYgX1BBR0Vf
UFJFU0VOVCkgfHwgKGwyZV9nZXRfcGZuKGwyZSkgPT0gcGZuKSApCiAgICAg
ICAgIHJldHVybiAxOwogCkBAIC0xNDg3LDEzICsxNDkxLDI3IEBAIHN0YXRp
YyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV8KICAgICBlbHNl
CiAgICAgewogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGwyZV9n
ZXRfcGFnZShsMmUpOwotICAgICAgICBpbnQgcmMgPSBfcHV0X3BhZ2VfdHlw
ZShwZywgZmFsc2UsIG1mbl90b19wYWdlKHBmbikpOworICAgICAgICBzdHJ1
Y3QgcGFnZV9pbmZvICpwdHBnID0gbWZuX3RvX3BhZ2UocGZuKTsKIAotICAg
ICAgICBBU1NFUlQoIXJjKTsKLSAgICAgICAgcHV0X3BhZ2UocGcpOworICAg
ICAgICBpZiAoIHVubGlrZWx5KHBhcnRpYWwgPiAwKSApCisgICAgICAgIHsK
KyAgICAgICAgICAgIEFTU0VSVCghZGVmZXIpOworICAgICAgICAgICAgcmMg
PSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7CisgICAgICAgIH0K
KyAgICAgICAgZWxzZSBpZiAoIGRlZmVyICkKKyAgICAgICAgeworICAgICAg
ICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IHB0cGc7Cisg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90YWJsZSA9IHBn
OworICAgICAgICB9CisgICAgICAgIGVsc2UKKyAgICAgICAgeworICAgICAg
ICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRwZyk7Cisg
ICAgICAgICAgICBpZiAoIGxpa2VseSghcmMpICkKKyAgICAgICAgICAgICAg
ICBwdXRfcGFnZShwZyk7CisgICAgICAgIH0KICAgICB9CiAKLSAgICByZXR1
cm4gMDsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0YXRpYyBpbnQgcHV0X3Bh
Z2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwgdW5zaWduZWQgbG9uZyBw
Zm4sCkBAIC0xNjY2LDExICsxNjg0LDEyIEBAIHN0YXRpYyBpbnQgYWxsb2Nf
bDJfdGFibGUoc3RydWN0IHBhZ2VfaW4KICAgICB1bnNpZ25lZCBsb25nICBw
Zm4gPSBwYWdlX3RvX21mbihwYWdlKTsKICAgICBsMl9wZ2VudHJ5X3QgICpw
bDJlOwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAg
ICAgcmMgPSAwOworICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlh
bCA9IHBhZ2UtPnBhcnRpYWxfcHRlOwogCiAgICAgcGwyZSA9IG1hcF9kb21h
aW5fcGFnZShfbWZuKHBmbikpOwogCi0gICAgZm9yICggaSA9IHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzOyBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkr
KyApCisgICAgZm9yICggaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzOyBp
IDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7CisgICAgICAgICAgaSsrLCBwYXJ0
aWFsID0gMCApCiAgICAgewogICAgICAgICBpZiAoIGkgPiBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkK
ICAgICAgICAgewpAQCAtMTY4MCwyMyArMTY5OSwzMyBAQCBzdGF0aWMgaW50
IGFsbG9jX2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luCiAgICAgICAgIH0KIAog
ICAgICAgICBpZiAoICFpc19ndWVzdF9sMl9zbG90KGQsIHR5cGUsIGkpIHx8
Ci0gICAgICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwyZVtp
XSwgcGZuLCBkKSkgPiAwICkKKyAgICAgICAgICAgICAocmMgPSBnZXRfcGFn
ZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4sIGQsIHBhcnRpYWwpKSA+IDAgKQog
ICAgICAgICAgICAgY29udGludWU7CiAKLSAgICAgICAgaWYgKCB1bmxpa2Vs
eShyYyA9PSAtRVJFU1RBUlQpICkKKyAgICAgICAgaWYgKCByYyA9PSAtRVJF
U1RBUlQgKQogICAgICAgICB7CiAgICAgICAgICAgICBwYWdlLT5ucl92YWxp
ZGF0ZWRfcHRlcyA9IGk7Ci0gICAgICAgICAgICBicmVhazsKKyAgICAgICAg
ICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gcGFydGlhbCA/OiAxOwogICAgICAg
ICB9Ci0KLSAgICAgICAgaWYgKCByYyA8IDAgKQorICAgICAgICBlbHNlIGlm
ICggcmMgPT0gLUVJTlRSICYmIGkgKQorICAgICAgICB7CisgICAgICAgICAg
ICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7CisgICAgICAgICAgICBw
YWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICByYyA9IC1FUkVT
VEFSVDsKKyAgICAgICAgfQorICAgICAgICBlbHNlIGlmICggcmMgPCAwICYm
IHJjICE9IC1FSU5UUiApCiAgICAgICAgIHsKICAgICAgICAgICAgIGdkcHJp
bnRrKFhFTkxPR19XQVJOSU5HLCAiRmFpbHVyZSBpbiBhbGxvY19sMl90YWJs
ZTogc2xvdCAlI3hcbiIsIGkpOwotICAgICAgICAgICAgd2hpbGUgKCBpLS0g
PiAwICkKLSAgICAgICAgICAgICAgICBpZiAoIGlzX2d1ZXN0X2wyX3Nsb3Qo
ZCwgdHlwZSwgaSkgKQotICAgICAgICAgICAgICAgICAgICBwdXRfcGFnZV9m
cm9tX2wyZShwbDJlW2ldLCBwZm4pOwotICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgICAgICBpZiAoIGkgKQorICAgICAgICAgICAgeworICAgICAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
ICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgICAgICAg
ICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfcHRwZyA9IE5VTEw7CisgICAg
ICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBw
YWdlOworICAgICAgICAgICAgfQogICAgICAgICB9CisgICAgICAgIGlmICgg
cmMgPCAwICkKKyAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIGFkanVz
dF9ndWVzdF9sMmUocGwyZVtpXSwgZCk7CiAgICAgfQpAQCAtMTkxOSwyOCAr
MTk0OCw1MCBAQCBzdGF0aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0IHBh
Z2VfaW5mCiAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVy
KHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcgcGZuID0gcGFnZV90b19tZm4o
cGFnZSk7CiAgICAgbDJfcGdlbnRyeV90ICpwbDJlOwotICAgIHVuc2lnbmVk
IGludCAgaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzIC0gMTsKLSAgICBp
bnQgZXJyID0gMDsKKyAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+
cGFydGlhbF9wdGU7CisgICAgdW5zaWduZWQgaW50IGkgPSBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyAtICFwYXJ0aWFsOwogCiAgICAgcGwyZSA9IG1hcF9k
b21haW5fcGFnZShfbWZuKHBmbikpOwogCi0gICAgQVNTRVJUKHBhZ2UtPm5y
X3ZhbGlkYXRlZF9wdGVzKTsKLSAgICBkbyB7Ci0gICAgICAgIGlmICggaXNf
Z3Vlc3RfbDJfc2xvdChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkg
JiYKLSAgICAgICAgICAgICBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBw
Zm4pID09IDAgJiYKLSAgICAgICAgICAgICBpICYmIGh5cGVyY2FsbF9wcmVl
bXB0X2NoZWNrKCkgKQorICAgIGZvciAoIDsgOyApCisgICAgeworICAgICAg
ICBpZiAoIGlzX2d1ZXN0X2wyX3Nsb3QoZCwgcGFnZS0+dS5pbnVzZS50eXBl
X2luZm8sIGkpICkKKyAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9s
MmUocGwyZVtpXSwgcGZuLCBwYXJ0aWFsLCBmYWxzZSk7CisgICAgICAgIGlm
ICggcmMgPCAwICkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgIHBh
cnRpYWwgPSAwOworCisgICAgICAgIGlmICggIWktLSApCisgICAgICAgICAg
ICBicmVhazsKKworICAgICAgICBpZiAoIGh5cGVyY2FsbF9wcmVlbXB0X2No
ZWNrKCkgKQogICAgICAgICB7Ci0gICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgZXJyID0gLUVSRVNUQVJUOwor
ICAgICAgICAgICAgcmMgPSAtRUlOVFI7CisgICAgICAgICAgICBicmVhazsK
ICAgICAgICAgfQotICAgIH0gd2hpbGUgKCAhZXJyICYmIGktLSApOworICAg
IH0KIAogICAgIHVubWFwX2RvbWFpbl9wYWdlKHBsMmUpOwogCi0gICAgaWYg
KCAhZXJyICkKKyAgICBpZiAoIHJjID49IDAgKQorICAgIHsKICAgICAgICAg
cGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJj0gflBHVF9wYWVfeGVuX2wyOwor
ICAgICAgICByYyA9IDA7CisgICAgfQorICAgIGVsc2UgaWYgKCByYyA9PSAt
RVJFU1RBUlQgKQorICAgIHsKKyAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXMgPSBpOworICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IHBhcnRp
YWwgPzogLTE7CisgICAgfQorICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIg
JiYgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCisgICAgeworICAg
ICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGkgKyAxOworICAgICAg
ICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgIHJjID0gLUVSRVNU
QVJUOworICAgIH0KIAotICAgIHJldHVybiBlcnI7CisgICAgcmV0dXJuIHJj
OwogfQogCiBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSkKQEAgLTIyNjcsNyArMjMxOCw3IEBAIHN0YXRpYyBpbnQg
bW9kX2wyX2VudHJ5KGwyX3BnZW50cnlfdCAqcGwKICAgICAgICAgICAgIHJl
dHVybiAtRUJVU1k7CiAgICAgICAgIH0KIAotICAgICAgICBpZiAoIHVubGlr
ZWx5KChyYyA9IGdldF9wYWdlX2Zyb21fbDJlKG5sMmUsIHBmbiwgZCkpIDwg
MCkgKQorICAgICAgICBpZiAoIHVubGlrZWx5KChyYyA9IGdldF9wYWdlX2Zy
b21fbDJlKG5sMmUsIHBmbiwgZCwgMCkpIDwgMCkgKQogICAgICAgICAgICAg
cmV0dXJuIHJjOwogCiAgICAgICAgIGFkanVzdF9ndWVzdF9sMmUobmwyZSwg
ZCk7CkBAIC0yMjg2LDcgKzIzMzcsOCBAQCBzdGF0aWMgaW50IG1vZF9sMl9l
bnRyeShsMl9wZ2VudHJ5X3QgKnBsCiAgICAgICAgIHJldHVybiAtRUJVU1k7
CiAgICAgfQogCi0gICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgcGZuKTsK
KyAgICBwdXRfcGFnZV9mcm9tX2wyZShvbDJlLCBwZm4sIDAsIHRydWUpOwor
CiAgICAgcmV0dXJuIHJjOwogfQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa290/4.9-2.patch"
Content-Disposition: attachment; filename="xsa290/4.9-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFkZCBleHBsaWNpdCBwcmVlbXB0aW9uIGNoZWNrcyB0byBM
MyAodW4pdmFsaWRhdGlvbgoKV2hlbiByZWN1cnNpdmUgcGFnZSB0YWJsZXMg
YXJlIHVzZWQgYXQgdGhlIEwzIGxldmVsLCB1bnZhbGlkYXRpb24gb2YgYQpz
aW5nbGUgTDQgdGFibGUgbWF5IGluY3VyIHVudmFsaWRhdGlvbiBvZiB0d28g
bGV2ZWxzIG9mIEwzIHRhYmxlcywgaS5lLgphIG1heGltdW0gaXRlcmF0aW9u
IGNvdW50IG9mIDUxMl4zIGZvciB1bnZhbGlkYXRpbmcgYW4gTDQgdGFibGUu
IFRoZQpwcmVlbXB0aW9uIGNoZWNrIGluIGZyZWVfbDJfdGFibGUoKSBhcyB3
ZWxsIGFzIHRoZSBvbmUgaW4KX3B1dF9wYWdlX3R5cGUoKSBtYXkgbmV2ZXIg
YmUgcmVhY2hlZCwgc28gZXhwbGljaXQgY2hlY2tpbmcgaXMgbmVlZGVkIGlu
CmZyZWVfbDNfdGFibGUoKS4KCldoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVz
IGFyZSB1c2VkIGF0IHRoZSBMNCBsZXZlbCwgdGhlIGl0ZXJhdGlvbiBjb3Vu
dAphdCBMNCBhbG9uZSBpcyBjYXBwZWQgYXQgNTEyXjIuIEFzIHNvb24gYXMg
YSBwcmVzZW50IEwzIGVudHJ5IGlzIGhpdAp3aGljaCBpdHNlbGYgbmVlZHMg
dW52YWxpZGF0aW9uIChhbmQgaGVuY2UgcmVxdWlyaW5nIGFub3RoZXIgbmVz
dGVkIGxvb3AKd2l0aCA1MTIgaXRlcmF0aW9ucyksIHRoZSBwcmVlbXB0aW9u
IGNoZWNrcyBhZGRlZCBoZXJlIGtpY2sgaW4sIHNvIG5vCmZ1cnRoZXIgcHJl
ZW1wdGlvbiBjaGVja2luZyBpcyBuZWVkZWQgYXQgTDQgKHVudGlsIHdlIGRl
Y2lkZSB0byBwZXJtaXQKNS1sZXZlbCBwYWdpbmcgZm9yIFBWIGd1ZXN0cyku
CgpUaGUgdmFsaWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0
IGZvciBzeW1tZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0
cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCkBAIC0xNzY2LDYgKzE3NjYsMTMgQEAgc3RhdGljIGlu
dCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbgogICAgIGZvciAoIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQogICAgIHsK
KyAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYg
aHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KKwogICAgICAgICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSAm
JiAoaSA9PSAzKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggIShs
M2VfZ2V0X2ZsYWdzKHBsM2VbaV0pICYgX1BBR0VfUFJFU0VOVCkgfHwKQEAg
LTIwMDQsMTggKzIwMTEsMjggQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxl
KHN0cnVjdCBwYWdlX2luZgogCiAgICAgcGwzZSA9IG1hcF9kb21haW5fcGFn
ZShfbWZuKHBmbikpOwogCi0gICAgZG8geworICAgIGZvciAoIDsgOyApCisg
ICAgewogICAgICAgICBpZiAoIGlzX2d1ZXN0X2wzX3Nsb3QoaSkgKQogICAg
ICAgICB7CiAgICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBs
M2VbaV0sIHBmbiwgcGFydGlhbCwgMCk7CiAgICAgICAgICAgICBpZiAoIHJj
IDwgMCApCiAgICAgICAgICAgICAgICAgYnJlYWs7CisKICAgICAgICAgICAg
IHBhcnRpYWwgPSAwOwotICAgICAgICAgICAgaWYgKCByYyA+IDAgKQotICAg
ICAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICAgICAgdW5hZGp1c3Rf
Z3Vlc3RfbDNlKHBsM2VbaV0sIGQpOworICAgICAgICAgICAgaWYgKCByYyA9
PSAwICkKKyAgICAgICAgICAgICAgICB1bmFkanVzdF9ndWVzdF9sM2UocGwz
ZVtpXSwgZCk7CiAgICAgICAgIH0KLSAgICB9IHdoaWxlICggaS0tICk7CisK
KyAgICAgICAgaWYgKCAhaS0tICkKKyAgICAgICAgICAgIGJyZWFrOworCisg
ICAgICAgIGlmICggaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIHJjID0gLUVJTlRSOworICAgICAgICAgICAg
YnJlYWs7CisgICAgICAgIH0KKyAgICB9CiAKICAgICB1bm1hcF9kb21haW5f
cGFnZShwbDNlKTsKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa290/4.10-1.patch"
Content-Disposition: attachment; filename="xsa290/4.10-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFsc28gYWxsb3cgTDIgKHVuKXZhbGlkYXRpb24gdG8gYmUg
cHJlZW1wdGlibGUKCkNvbW1pdCBjNjEyNDgxZDFjICgieDg2L21tOiBQbHVt
YmluZyB0byBhbGxvdyBhbnkgUFRFIHVwZGF0ZSB0byBmYWlsCndpdGggLUVS
RVNUQVJUIikgYWRkZWQgYXNzZXJ0aW9ucyBuZXh0IHRvIHRoZSB7YWxsb2Ms
ZnJlZX1fbDJfdGFibGUoKQppbnZvY2F0aW9ucyB0byBkb2N1bWVudCAoYW5k
IHZhbGlkYXRlIGluIGRlYnVnIGJ1aWxkcykgdGhhdCBMMgoodW4pdmFsaWRh
dGlvbnMgYXJlIGFsd2F5cyBwcmVlbXB0aWJsZS4KClRoZSBhc3NlcnRpb24g
aW4gZnJlZV9wYWdlX3R5cGUoKSB3YXMgbm93IG9ic2VydmVkIHRvIHRyaWdn
ZXIgd2hlbgpyZWN1cnNpdmUgTDIgcGFnZSB0YWJsZXMgZ2V0IGNsZWFuZWQg
dXAuCgpJbiBwYXJ0aWN1bGFyIHB1dF9wYWdlX2Zyb21fbDJlKCkncyBhc3N1
bXB0aW9uIHRoYXQgX3B1dF9wYWdlX3R5cGUoKQp3b3VsZCBhbHdheXMgc3Vj
Y2VlZCBpcyBub3cgd3JvbmcsIHJlc3VsdGluZyBpbiBhIHBhcnRpYWxseSB1
bi12YWxpZGF0ZWQKcGFnZSBsZWZ0IGluIGEgZG9tYWluLCB3aGljaCBoYXMg
bm8gb3RoZXIgbWVhbnMgb2YgZ2V0dGluZyBjbGVhbmVkIHVwCmxhdGVyIG9u
LiBJZiBub3QgY2F1c2luZyBhbnkgcHJvYmxlbXMgZWFybGllciwgdGhpcyB3
b3VsZCB1bHRpbWF0ZWx5CnRyaWdnZXIgdGhlIGNoZWNrIGZvciAtPnUuaW51
c2UudHlwZV9pbmZvIGhhdmluZyBhIHplcm8gY291bnQgd2hlbgpmcmVlaW5n
IHRoZSBwYWdlIGR1cmluZyBjbGVhbnVwIGFmdGVyIHRoZSBkb21haW4gaGFz
IGRpZWQuCgpBcyBhIHJlc3VsdCBpdCBzaG91bGQgYmUgY29uc2lkZXJlZCBh
IG1pc3Rha2UgdG8gbm90IGhhdmUgZXh0ZW5kZWQKcHJlZW1wdGlvbiBmdWxs
eSB0byBMMiB3aGVuIGl0IHdhcyBhZGRlZCB0byBMMy9MNCB0YWJsZSBoYW5k
bGluZywgd2hpY2gKdGhpcyBjaGFuZ2UgYWltcyB0byBjb3JyZWN0LgoKVGhl
IHZhbGlkYXRpb24gc2lkZSBhZGRpdGlvbnMgYXJlIGRvbmUganVzdCBmb3Ig
c3ltbWV0cnkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5MC4KClJlcG9ydGVk
LWJ5OiBNYW51ZWwgQm91eWVyIDxib3V5ZXJAYW50aW9jaGUuZXUub3JnPgpU
ZXN0ZWQtYnk6IE1hbnVlbCBCb3V5ZXIgPGJvdXllckBhbnRpb2NoZS5ldS5v
cmc+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29w
ZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysg
Yi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTE2OCw3ICsxMTY4LDcgQEAgZ2V0
X3BhZ2VfZnJvbV9sMWUoCiBkZWZpbmVfZ2V0X2xpbmVhcl9wYWdldGFibGUo
bDIpOwogc3RhdGljIGludAogZ2V0X3BhZ2VfZnJvbV9sMmUoCi0gICAgbDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21h
aW4gKmQpCisgICAgbDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBw
Zm4sIHN0cnVjdCBkb21haW4gKmQsIGludCBwYXJ0aWFsKQogewogICAgIHVu
c2lnbmVkIGxvbmcgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKICAgICBpbnQg
cmM7CkBAIC0xMTg1LDcgKzExODUsOCBAQCBnZXRfcGFnZV9mcm9tX2wyZSgK
IAogICAgIGlmICggIShsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QU0Up
ICkKICAgICB7Ci0gICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJv
bV9tZm4oX21mbihtZm4pLCBQR1RfbDFfcGFnZV90YWJsZSwgZCwgMCwgMCk7
CisgICAgICAgIHJjID0gZ2V0X3BhZ2VfYW5kX3R5cGVfZnJvbV9tZm4oX21m
bihtZm4pLCBQR1RfbDFfcGFnZV90YWJsZSwgZCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWFsLCBmYWxzZSk7CiAg
ICAgICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkgJiYgZ2V0X2wy
X2xpbmVhcl9wYWdldGFibGUobDJlLCBwZm4sIGQpICkKICAgICAgICAgICAg
IHJjID0gMDsKICAgICAgICAgcmV0dXJuIHJjOwpAQCAtMTMyNiw4ICsxMzI3
LDExIEBAIHZvaWQgcHV0X3BhZ2VfZnJvbV9sMWUobDFfcGdlbnRyeV90IGwx
ZSwKICAqIE5CLiBWaXJ0dWFsIGFkZHJlc3MgJ2wyZScgbWFwcyB0byBhIG1h
Y2hpbmUgYWRkcmVzcyB3aXRoaW4gZnJhbWUgJ3BmbicuCiAgKiBOb3RlIGFs
c28gdGhhdCB0aGlzIGF1dG9tYXRpY2FsbHkgZGVhbHMgY29ycmVjdGx5IHdp
dGggbGluZWFyIHAudC4ncy4KICAqLwotc3RhdGljIGludCBwdXRfcGFnZV9m
cm9tX2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbikK
K3N0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV90IGwy
ZSwgdW5zaWduZWQgbG9uZyBwZm4sCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBwYXJ0aWFsLCBib29sIGRlZmVyKQogeworICAgIGludCBy
YyA9IDA7CisKICAgICBpZiAoICEobDJlX2dldF9mbGFncyhsMmUpICYgX1BB
R0VfUFJFU0VOVCkgfHwgKGwyZV9nZXRfcGZuKGwyZSkgPT0gcGZuKSApCiAg
ICAgICAgIHJldHVybiAxOwogCkBAIC0xMzQyLDEzICsxMzQ2LDI3IEBAIHN0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdlbnRyeV8KICAgICBl
bHNlCiAgICAgewogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwZyA9IGwy
ZV9nZXRfcGFnZShsMmUpOwotICAgICAgICBpbnQgcmMgPSBfcHV0X3BhZ2Vf
dHlwZShwZywgZmFsc2UsIG1mbl90b19wYWdlKF9tZm4ocGZuKSkpOworICAg
ICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwdHBnID0gbWZuX3RvX3BhZ2UoX21m
bihwZm4pKTsKIAotICAgICAgICBBU1NFUlQoIXJjKTsKLSAgICAgICAgcHV0
X3BhZ2UocGcpOworICAgICAgICBpZiAoIHVubGlrZWx5KHBhcnRpYWwgPiAw
KSApCisgICAgICAgIHsKKyAgICAgICAgICAgIEFTU0VSVCghZGVmZXIpOwor
ICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywgdHJ1ZSwgcHRw
Zyk7CisgICAgICAgIH0KKyAgICAgICAgZWxzZSBpZiAoIGRlZmVyICkKKyAg
ICAgICAgeworICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3Rf
cHRwZyA9IHB0cGc7CisgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9n
dWVzdF90YWJsZSA9IHBnOworICAgICAgICB9CisgICAgICAgIGVsc2UKKyAg
ICAgICAgeworICAgICAgICAgICAgcmMgPSBfcHV0X3BhZ2VfdHlwZShwZywg
dHJ1ZSwgcHRwZyk7CisgICAgICAgICAgICBpZiAoIGxpa2VseSghcmMpICkK
KyAgICAgICAgICAgICAgICBwdXRfcGFnZShwZyk7CisgICAgICAgIH0KICAg
ICB9CiAKLSAgICByZXR1cm4gMDsKKyAgICByZXR1cm4gcmM7CiB9CiAKIHN0
YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sM2UobDNfcGdlbnRyeV90IGwzZSwg
dW5zaWduZWQgbG9uZyBwZm4sCkBAIC0xNTE4LDExICsxNTM2LDEyIEBAIHN0
YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW4KICAgICB1
bnNpZ25lZCBsb25nICBwZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7
CiAgICAgbDJfcGdlbnRyeV90ICAqcGwyZTsKICAgICB1bnNpZ25lZCBpbnQg
ICBpOwotICAgIGludCAgICAgICAgICAgIHJjID0gMDsKKyAgICBpbnQgICAg
ICAgICAgICByYyA9IDAsIHBhcnRpYWwgPSBwYWdlLT5wYXJ0aWFsX3B0ZTsK
IAogICAgIHBsMmUgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4pKTsKIAot
ICAgIGZvciAoIGkgPSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwy
X1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQorICAgIGZvciAoIGkgPSBwYWdl
LT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVT
OworICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQogICAgIHsKICAgICAg
ICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYgaHlwZXJj
YWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgIHsKQEAgLTE1MzIsMjMg
KzE1NTEsMzMgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShzdHJ1Y3Qg
cGFnZV9pbgogICAgICAgICB9CiAKICAgICAgICAgaWYgKCAhaXNfZ3Vlc3Rf
bDJfc2xvdChkLCB0eXBlLCBpKSB8fAotICAgICAgICAgICAgIChyYyA9IGdl
dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbiwgZCkpID4gMCApCisgICAg
ICAgICAgICAgKHJjID0gZ2V0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZu
LCBkLCBwYXJ0aWFsKSkgPiAwICkKICAgICAgICAgICAgIGNvbnRpbnVlOwog
Ci0gICAgICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVSRVNUQVJUKSApCisg
ICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKICAgICAgICAgewogICAg
ICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwotICAgICAg
ICAgICAgYnJlYWs7CisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9
IHBhcnRpYWwgPzogMTsKICAgICAgICAgfQotCi0gICAgICAgIGlmICggcmMg
PCAwICkKKyAgICAgICAgZWxzZSBpZiAoIHJjID09IC1FSU5UUiAmJiBpICkK
KyAgICAgICAgeworICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0
ZXMgPSBpOworICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSAwOwor
ICAgICAgICAgICAgcmMgPSAtRVJFU1RBUlQ7CisgICAgICAgIH0KKyAgICAg
ICAgZWxzZSBpZiAoIHJjIDwgMCAmJiByYyAhPSAtRUlOVFIgKQogICAgICAg
ICB7CiAgICAgICAgICAgICBnZHByaW50ayhYRU5MT0dfV0FSTklORywgIkZh
aWx1cmUgaW4gYWxsb2NfbDJfdGFibGU6IHNsb3QgJSN4XG4iLCBpKTsKLSAg
ICAgICAgICAgIHdoaWxlICggaS0tID4gMCApCi0gICAgICAgICAgICAgICAg
aWYgKCBpc19ndWVzdF9sMl9zbG90KGQsIHR5cGUsIGkpICkKLSAgICAgICAg
ICAgICAgICAgICAgcHV0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuKTsK
LSAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgaWYgKCBpICkKKyAg
ICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyA9IGk7CisgICAgICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9w
dGUgPSAwOworICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1
ZXN0X3B0cGcgPSBOVUxMOworICAgICAgICAgICAgICAgIGN1cnJlbnQtPmFy
Y2gub2xkX2d1ZXN0X3RhYmxlID0gcGFnZTsKKyAgICAgICAgICAgIH0KICAg
ICAgICAgfQorICAgICAgICBpZiAoIHJjIDwgMCApCisgICAgICAgICAgICBi
cmVhazsKIAogICAgICAgICBwbDJlW2ldID0gYWRqdXN0X2d1ZXN0X2wyZShw
bDJlW2ldLCBkKTsKICAgICB9CkBAIC0xODI4LDI4ICsxODU3LDUwIEBAIHN0
YXRpYyBpbnQgZnJlZV9sMl90YWJsZShzdHJ1Y3QgcGFnZV9pbmYKICAgICBz
dHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7CiAgICAg
dW5zaWduZWQgbG9uZyBwZm4gPSBtZm5feChwYWdlX3RvX21mbihwYWdlKSk7
CiAgICAgbDJfcGdlbnRyeV90ICpwbDJlOwotICAgIHVuc2lnbmVkIGludCAg
aSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzIC0gMTsKLSAgICBpbnQgZXJy
ID0gMDsKKyAgICBpbnQgcmMgPSAwLCBwYXJ0aWFsID0gcGFnZS0+cGFydGlh
bF9wdGU7CisgICAgdW5zaWduZWQgaW50IGkgPSBwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyAtICFwYXJ0aWFsOwogCiAgICAgcGwyZSA9IG1hcF9kb21haW5f
cGFnZShfbWZuKHBmbikpOwogCi0gICAgQVNTRVJUKHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzKTsKLSAgICBkbyB7Ci0gICAgICAgIGlmICggaXNfZ3Vlc3Rf
bDJfc2xvdChkLCBwYWdlLT51LmludXNlLnR5cGVfaW5mbywgaSkgJiYKLSAg
ICAgICAgICAgICBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4pID09
IDAgJiYKLSAgICAgICAgICAgICBpICYmIGh5cGVyY2FsbF9wcmVlbXB0X2No
ZWNrKCkgKQorICAgIGZvciAoIDsgOyApCisgICAgeworICAgICAgICBpZiAo
IGlzX2d1ZXN0X2wyX3Nsb3QoZCwgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8s
IGkpICkKKyAgICAgICAgICAgIHJjID0gcHV0X3BhZ2VfZnJvbV9sMmUocGwy
ZVtpXSwgcGZuLCBwYXJ0aWFsLCBmYWxzZSk7CisgICAgICAgIGlmICggcmMg
PCAwICkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgIHBhcnRpYWwg
PSAwOworCisgICAgICAgIGlmICggIWktLSApCisgICAgICAgICAgICBicmVh
azsKKworICAgICAgICBpZiAoIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkg
KQogICAgICAgICB7Ci0gICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9w
dGVzID0gaTsKLSAgICAgICAgICAgZXJyID0gLUVSRVNUQVJUOworICAgICAg
ICAgICAgcmMgPSAtRUlOVFI7CisgICAgICAgICAgICBicmVhazsKICAgICAg
ICAgfQotICAgIH0gd2hpbGUgKCAhZXJyICYmIGktLSApOworICAgIH0KIAog
ICAgIHVubWFwX2RvbWFpbl9wYWdlKHBsMmUpOwogCi0gICAgaWYgKCAhZXJy
ICkKKyAgICBpZiAoIHJjID49IDAgKQorICAgIHsKICAgICAgICAgcGFnZS0+
dS5pbnVzZS50eXBlX2luZm8gJj0gflBHVF9wYWVfeGVuX2wyOworICAgICAg
ICByYyA9IDA7CisgICAgfQorICAgIGVsc2UgaWYgKCByYyA9PSAtRVJFU1RB
UlQgKQorICAgIHsKKyAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMg
PSBpOworICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IHBhcnRpYWwgPzog
LTE7CisgICAgfQorICAgIGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSA8
IEwyX1BBR0VUQUJMRV9FTlRSSUVTIC0gMSApCisgICAgeworICAgICAgICBw
YWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGkgKyAxOworICAgICAgICBwYWdl
LT5wYXJ0aWFsX3B0ZSA9IDA7CisgICAgICAgIHJjID0gLUVSRVNUQVJUOwor
ICAgIH0KIAotICAgIHJldHVybiBlcnI7CisgICAgcmV0dXJuIHJjOwogfQog
CiBzdGF0aWMgaW50IGZyZWVfbDNfdGFibGUoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSkKQEAgLTIxMTUsNyArMjE2Niw3IEBAIHN0YXRpYyBpbnQgbW9kX2wy
X2VudHJ5KGwyX3BnZW50cnlfdCAqcGwKICAgICAgICAgICAgIHJldHVybiAt
RUJVU1k7CiAgICAgICAgIH0KIAotICAgICAgICBpZiAoIHVubGlrZWx5KChy
YyA9IGdldF9wYWdlX2Zyb21fbDJlKG5sMmUsIHBmbiwgZCkpIDwgMCkgKQor
ICAgICAgICBpZiAoIHVubGlrZWx5KChyYyA9IGdldF9wYWdlX2Zyb21fbDJl
KG5sMmUsIHBmbiwgZCwgMCkpIDwgMCkgKQogICAgICAgICAgICAgcmV0dXJu
IHJjOwogCiAgICAgICAgIG5sMmUgPSBhZGp1c3RfZ3Vlc3RfbDJlKG5sMmUs
IGQpOwpAQCAtMjEzNCw3ICsyMTg1LDggQEAgc3RhdGljIGludCBtb2RfbDJf
ZW50cnkobDJfcGdlbnRyeV90ICpwbAogICAgICAgICByZXR1cm4gLUVCVVNZ
OwogICAgIH0KIAotICAgIHB1dF9wYWdlX2Zyb21fbDJlKG9sMmUsIHBmbik7
CisgICAgcHV0X3BhZ2VfZnJvbV9sMmUob2wyZSwgcGZuLCAwLCB0cnVlKTsK
KwogICAgIHJldHVybiByYzsKIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa290/4.10-2.patch"
Content-Disposition: attachment; filename="xsa290/4.10-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFkZCBleHBsaWNpdCBwcmVlbXB0aW9uIGNoZWNrcyB0byBM
MyAodW4pdmFsaWRhdGlvbgoKV2hlbiByZWN1cnNpdmUgcGFnZSB0YWJsZXMg
YXJlIHVzZWQgYXQgdGhlIEwzIGxldmVsLCB1bnZhbGlkYXRpb24gb2YgYQpz
aW5nbGUgTDQgdGFibGUgbWF5IGluY3VyIHVudmFsaWRhdGlvbiBvZiB0d28g
bGV2ZWxzIG9mIEwzIHRhYmxlcywgaS5lLgphIG1heGltdW0gaXRlcmF0aW9u
IGNvdW50IG9mIDUxMl4zIGZvciB1bnZhbGlkYXRpbmcgYW4gTDQgdGFibGUu
IFRoZQpwcmVlbXB0aW9uIGNoZWNrIGluIGZyZWVfbDJfdGFibGUoKSBhcyB3
ZWxsIGFzIHRoZSBvbmUgaW4KX3B1dF9wYWdlX3R5cGUoKSBtYXkgbmV2ZXIg
YmUgcmVhY2hlZCwgc28gZXhwbGljaXQgY2hlY2tpbmcgaXMgbmVlZGVkIGlu
CmZyZWVfbDNfdGFibGUoKS4KCldoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVz
IGFyZSB1c2VkIGF0IHRoZSBMNCBsZXZlbCwgdGhlIGl0ZXJhdGlvbiBjb3Vu
dAphdCBMNCBhbG9uZSBpcyBjYXBwZWQgYXQgNTEyXjIuIEFzIHNvb24gYXMg
YSBwcmVzZW50IEwzIGVudHJ5IGlzIGhpdAp3aGljaCBpdHNlbGYgbmVlZHMg
dW52YWxpZGF0aW9uIChhbmQgaGVuY2UgcmVxdWlyaW5nIGFub3RoZXIgbmVz
dGVkIGxvb3AKd2l0aCA1MTIgaXRlcmF0aW9ucyksIHRoZSBwcmVlbXB0aW9u
IGNoZWNrcyBhZGRlZCBoZXJlIGtpY2sgaW4sIHNvIG5vCmZ1cnRoZXIgcHJl
ZW1wdGlvbiBjaGVja2luZyBpcyBuZWVkZWQgYXQgTDQgKHVudGlsIHdlIGRl
Y2lkZSB0byBwZXJtaXQKNS1sZXZlbCBwYWdpbmcgZm9yIFBWIGd1ZXN0cyku
CgpUaGUgdmFsaWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0
IGZvciBzeW1tZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0
cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCkBAIC0xNjEyLDYgKzE2MTIsMTMgQEAgc3RhdGljIGlu
dCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbgogICAgIGZvciAoIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQogICAgIHsK
KyAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYg
aHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KKwogICAgICAgICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSAm
JiAoaSA9PSAzKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggIShs
M2VfZ2V0X2ZsYWdzKHBsM2VbaV0pICYgX1BBR0VfUFJFU0VOVCkgfHwKQEAg
LTE5MTMsMTUgKzE5MjAsMjUgQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxl
KHN0cnVjdCBwYWdlX2luZgogCiAgICAgcGwzZSA9IG1hcF9kb21haW5fcGFn
ZShfbWZuKHBmbikpOwogCi0gICAgZG8geworICAgIGZvciAoIDsgOyApCisg
ICAgewogICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0s
IHBmbiwgcGFydGlhbCwgMCk7CiAgICAgICAgIGlmICggcmMgPCAwICkKICAg
ICAgICAgICAgIGJyZWFrOworCiAgICAgICAgIHBhcnRpYWwgPSAwOwotICAg
ICAgICBpZiAoIHJjID4gMCApCi0gICAgICAgICAgICBjb250aW51ZTsKLSAg
ICAgICAgcGwzZVtpXSA9IHVuYWRqdXN0X2d1ZXN0X2wzZShwbDNlW2ldLCBk
KTsKLSAgICB9IHdoaWxlICggaS0tICk7CisgICAgICAgIGlmICggcmMgPT0g
MCApCisgICAgICAgICAgICBwbDNlW2ldID0gdW5hZGp1c3RfZ3Vlc3RfbDNl
KHBsM2VbaV0sIGQpOworCisgICAgICAgIGlmICggIWktLSApCisgICAgICAg
ICAgICBicmVhazsKKworICAgICAgICBpZiAoIGh5cGVyY2FsbF9wcmVlbXB0
X2NoZWNrKCkgKQorICAgICAgICB7CisgICAgICAgICAgICByYyA9IC1FSU5U
UjsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICB9CisgICAgfQogCiAg
ICAgdW5tYXBfZG9tYWluX3BhZ2UocGwzZSk7CiAK

--=separator
Content-Type: application/octet-stream; name="xsa290/4.11-1.patch"
Content-Disposition: attachment; filename="xsa290/4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFsc28gYWxsb3cgTDIgKHVuKXZhbGlkYXRpb24gdG8gYmUg
cHJlZW1wdGlibGUKCkNvbW1pdCBjNjEyNDgxZDFjICgieDg2L21tOiBQbHVt
YmluZyB0byBhbGxvdyBhbnkgUFRFIHVwZGF0ZSB0byBmYWlsCndpdGggLUVS
RVNUQVJUIikgYWRkZWQgYXNzZXJ0aW9ucyBuZXh0IHRvIHRoZSB7YWxsb2Ms
ZnJlZX1fbDJfdGFibGUoKQppbnZvY2F0aW9ucyB0byBkb2N1bWVudCAoYW5k
IHZhbGlkYXRlIGluIGRlYnVnIGJ1aWxkcykgdGhhdCBMMgoodW4pdmFsaWRh
dGlvbnMgYXJlIGFsd2F5cyBwcmVlbXB0aWJsZS4KClRoZSBhc3NlcnRpb24g
aW4gZnJlZV9wYWdlX3R5cGUoKSB3YXMgbm93IG9ic2VydmVkIHRvIHRyaWdn
ZXIgd2hlbgpyZWN1cnNpdmUgTDIgcGFnZSB0YWJsZXMgZ2V0IGNsZWFuZWQg
dXAuCgpJbiBwYXJ0aWN1bGFyIHB1dF9wYWdlX2Zyb21fbDJlKCkncyBhc3N1
bXB0aW9uIHRoYXQgX3B1dF9wYWdlX3R5cGUoKQp3b3VsZCBhbHdheXMgc3Vj
Y2VlZCBpcyBub3cgd3JvbmcsIHJlc3VsdGluZyBpbiBhIHBhcnRpYWxseSB1
bi12YWxpZGF0ZWQKcGFnZSBsZWZ0IGluIGEgZG9tYWluLCB3aGljaCBoYXMg
bm8gb3RoZXIgbWVhbnMgb2YgZ2V0dGluZyBjbGVhbmVkIHVwCmxhdGVyIG9u
LiBJZiBub3QgY2F1c2luZyBhbnkgcHJvYmxlbXMgZWFybGllciwgdGhpcyB3
b3VsZCB1bHRpbWF0ZWx5CnRyaWdnZXIgdGhlIGNoZWNrIGZvciAtPnUuaW51
c2UudHlwZV9pbmZvIGhhdmluZyBhIHplcm8gY291bnQgd2hlbgpmcmVlaW5n
IHRoZSBwYWdlIGR1cmluZyBjbGVhbnVwIGFmdGVyIHRoZSBkb21haW4gaGFz
IGRpZWQuCgpBcyBhIHJlc3VsdCBpdCBzaG91bGQgYmUgY29uc2lkZXJlZCBh
IG1pc3Rha2UgdG8gbm90IGhhdmUgZXh0ZW5kZWQKcHJlZW1wdGlvbiBmdWxs
eSB0byBMMiB3aGVuIGl0IHdhcyBhZGRlZCB0byBMMy9MNCB0YWJsZSBoYW5k
bGluZywgd2hpY2gKdGhpcyBjaGFuZ2UgYWltcyB0byBjb3JyZWN0LgoKVGhl
IHZhbGlkYXRpb24gc2lkZSBhZGRpdGlvbnMgYXJlIGRvbmUganVzdCBmb3Ig
c3ltbWV0cnkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5MC4KClJlcG9ydGVk
LWJ5OiBNYW51ZWwgQm91eWVyIDxib3V5ZXJAYW50aW9jaGUuZXUub3JnPgpU
ZXN0ZWQtYnk6IE1hbnVlbCBCb3V5ZXIgPGJvdXllckBhbnRpb2NoZS5ldS5v
cmc+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29w
ZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysg
Yi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTEyNiw3ICsxMTI2LDcgQEAgZ2V0
X3BhZ2VfZnJvbV9sMWUoCiBkZWZpbmVfZ2V0X2xpbmVhcl9wYWdldGFibGUo
bDIpOwogc3RhdGljIGludAogZ2V0X3BhZ2VfZnJvbV9sMmUoCi0gICAgbDJf
cGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4sIHN0cnVjdCBkb21h
aW4gKmQpCisgICAgbDJfcGdlbnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBw
Zm4sIHN0cnVjdCBkb21haW4gKmQsIGludCBwYXJ0aWFsKQogewogICAgIHVu
c2lnbmVkIGxvbmcgbWZuID0gbDJlX2dldF9wZm4obDJlKTsKICAgICBpbnQg
cmM7CkBAIC0xMTQxLDcgKzExNDEsOCBAQCBnZXRfcGFnZV9mcm9tX2wyZSgK
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgfQogCi0gICAgcmMgPSBn
ZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21mbihfbWZuKG1mbiksIFBHVF9sMV9w
YWdlX3RhYmxlLCBkLCAwLCAwKTsKKyAgICByYyA9IGdldF9wYWdlX2FuZF90
eXBlX2Zyb21fbWZuKF9tZm4obWZuKSwgUEdUX2wxX3BhZ2VfdGFibGUsIGQs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWFs
LCBmYWxzZSk7CiAgICAgaWYgKCB1bmxpa2VseShyYyA9PSAtRUlOVkFMKSAm
JiBnZXRfbDJfbGluZWFyX3BhZ2V0YWJsZShsMmUsIHBmbiwgZCkgKQogICAg
ICAgICByYyA9IDA7CiAKQEAgLTEyOTUsOCArMTI5NiwxMSBAQCB2b2lkIHB1
dF9wYWdlX2Zyb21fbDFlKGwxX3BnZW50cnlfdCBsMWUsCiAgKiBOQi4gVmly
dHVhbCBhZGRyZXNzICdsMmUnIG1hcHMgdG8gYSBtYWNoaW5lIGFkZHJlc3Mg
d2l0aGluIGZyYW1lICdwZm4nLgogICogTm90ZSBhbHNvIHRoYXQgdGhpcyBh
dXRvbWF0aWNhbGx5IGRlYWxzIGNvcnJlY3RseSB3aXRoIGxpbmVhciBwLnQu
J3MuCiAgKi8KLXN0YXRpYyBpbnQgcHV0X3BhZ2VfZnJvbV9sMmUobDJfcGdl
bnRyeV90IGwyZSwgdW5zaWduZWQgbG9uZyBwZm4pCitzdGF0aWMgaW50IHB1
dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxv
bmcgcGZuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcGFy
dGlhbCwgYm9vbCBkZWZlcikKIHsKKyAgICBpbnQgcmMgPSAwOworCiAgICAg
aWYgKCAhKGwyZV9nZXRfZmxhZ3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpIHx8
IChsMmVfZ2V0X3BmbihsMmUpID09IHBmbikgKQogICAgICAgICByZXR1cm4g
MTsKIApAQCAtMTMxMSwxMyArMTMxNSwyNyBAQCBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfCiAgICAgZWxzZQogICAgIHsKICAg
ICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGcgPSBsMmVfZ2V0X3BhZ2UobDJl
KTsKLSAgICAgICAgaW50IHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIGZhbHNl
LCBtZm5fdG9fcGFnZShfbWZuKHBmbikpKTsKKyAgICAgICAgc3RydWN0IHBh
Z2VfaW5mbyAqcHRwZyA9IG1mbl90b19wYWdlKF9tZm4ocGZuKSk7CiAKLSAg
ICAgICAgQVNTRVJUKCFyYyk7Ci0gICAgICAgIHB1dF9wYWdlKHBnKTsKKyAg
ICAgICAgaWYgKCB1bmxpa2VseShwYXJ0aWFsID4gMCkgKQorICAgICAgICB7
CisgICAgICAgICAgICBBU1NFUlQoIWRlZmVyKTsKKyAgICAgICAgICAgIHJj
ID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIHB0cGcpOworICAgICAgICB9
CisgICAgICAgIGVsc2UgaWYgKCBkZWZlciApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3B0cGcgPSBwdHBnOwor
ICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBw
ZzsKKyAgICAgICAgfQorICAgICAgICBlbHNlCisgICAgICAgIHsKKyAgICAg
ICAgICAgIHJjID0gX3B1dF9wYWdlX3R5cGUocGcsIHRydWUsIHB0cGcpOwor
ICAgICAgICAgICAgaWYgKCBsaWtlbHkoIXJjKSApCisgICAgICAgICAgICAg
ICAgcHV0X3BhZ2UocGcpOworICAgICAgICB9CiAgICAgfQogCi0gICAgcmV0
dXJuIDA7CisgICAgcmV0dXJuIHJjOwogfQogCiBzdGF0aWMgaW50IHB1dF9w
YWdlX2Zyb21fbDNlKGwzX3BnZW50cnlfdCBsM2UsIHVuc2lnbmVkIGxvbmcg
cGZuLApAQCAtMTQ4NywxMSArMTUwNSwxMiBAQCBzdGF0aWMgaW50IGFsbG9j
X2wyX3RhYmxlKHN0cnVjdCBwYWdlX2luCiAgICAgdW5zaWduZWQgbG9uZyAg
cGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwogICAgIGwyX3BnZW50
cnlfdCAgKnBsMmU7CiAgICAgdW5zaWduZWQgaW50ICAgaTsKLSAgICBpbnQg
ICAgICAgICAgICByYyA9IDA7CisgICAgaW50ICAgICAgICAgICAgcmMgPSAw
LCBwYXJ0aWFsID0gcGFnZS0+cGFydGlhbF9wdGU7CiAKICAgICBwbDJlID0g
bWFwX2RvbWFpbl9wYWdlKF9tZm4ocGZuKSk7CiAKLSAgICBmb3IgKCBpID0g
cGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXM7IGkgPCBMMl9QQUdFVEFCTEVfRU5U
UklFUzsgaSsrICkKKyAgICBmb3IgKCBpID0gcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXM7IGkgPCBMMl9QQUdFVEFCTEVfRU5UUklFUzsKKyAgICAgICAgICBp
KyssIHBhcnRpYWwgPSAwICkKICAgICB7CiAgICAgICAgIGlmICggaSA+IHBh
Z2UtPm5yX3ZhbGlkYXRlZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVlbXB0X2No
ZWNrKCkgKQogICAgICAgICB7CkBAIC0xNTAxLDIzICsxNTIwLDMzIEBAIHN0
YXRpYyBpbnQgYWxsb2NfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW4KICAgICAg
ICAgfQogCiAgICAgICAgIGlmICggIWlzX2d1ZXN0X2wyX3Nsb3QoZCwgdHlw
ZSwgaSkgfHwKLSAgICAgICAgICAgICAocmMgPSBnZXRfcGFnZV9mcm9tX2wy
ZShwbDJlW2ldLCBwZm4sIGQpKSA+IDAgKQorICAgICAgICAgICAgIChyYyA9
IGdldF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbiwgZCwgcGFydGlhbCkp
ID4gMCApCiAgICAgICAgICAgICBjb250aW51ZTsKIAotICAgICAgICBpZiAo
IHVubGlrZWx5KHJjID09IC1FUkVTVEFSVCkgKQorICAgICAgICBpZiAoIHJj
ID09IC1FUkVTVEFSVCApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBhZ2Ut
Pm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKLSAgICAgICAgICAgIGJyZWFrOwor
ICAgICAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IDE7
CiAgICAgICAgIH0KLQotICAgICAgICBpZiAoIHJjIDwgMCApCisgICAgICAg
IGVsc2UgaWYgKCByYyA9PSAtRUlOVFIgJiYgaSApCisgICAgICAgIHsKKyAg
ICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAg
ICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAgICAgICAgIHJj
ID0gLUVSRVNUQVJUOworICAgICAgICB9CisgICAgICAgIGVsc2UgaWYgKCBy
YyA8IDAgJiYgcmMgIT0gLUVJTlRSICkKICAgICAgICAgewogICAgICAgICAg
ICAgZ2RwcmludGsoWEVOTE9HX1dBUk5JTkcsICJGYWlsdXJlIGluIGFsbG9j
X2wyX3RhYmxlOiBzbG90ICUjeFxuIiwgaSk7Ci0gICAgICAgICAgICB3aGls
ZSAoIGktLSA+IDAgKQotICAgICAgICAgICAgICAgIGlmICggaXNfZ3Vlc3Rf
bDJfc2xvdChkLCB0eXBlLCBpKSApCi0gICAgICAgICAgICAgICAgICAgIHB1
dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbik7Ci0gICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgICAgIGlmICggaSApCisgICAgICAgICAgICB7Cisg
ICAgICAgICAgICAgICAgcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpOwor
ICAgICAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRlID0gMDsKKyAgICAg
ICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gTlVM
TDsKKyAgICAgICAgICAgICAgICBjdXJyZW50LT5hcmNoLm9sZF9ndWVzdF90
YWJsZSA9IHBhZ2U7CisgICAgICAgICAgICB9CiAgICAgICAgIH0KKyAgICAg
ICAgaWYgKCByYyA8IDAgKQorICAgICAgICAgICAgYnJlYWs7CiAKICAgICAg
ICAgcGwyZVtpXSA9IGFkanVzdF9ndWVzdF9sMmUocGwyZVtpXSwgZCk7CiAg
ICAgfQpAQCAtMTc5NywyOCArMTgyNiw1MCBAQCBzdGF0aWMgaW50IGZyZWVf
bDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mCiAgICAgc3RydWN0IGRvbWFpbiAq
ZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogICAgIHVuc2lnbmVkIGxvbmcg
cGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwogICAgIGwyX3BnZW50
cnlfdCAqcGwyZTsKLSAgICB1bnNpZ25lZCBpbnQgIGkgPSBwYWdlLT5ucl92
YWxpZGF0ZWRfcHRlcyAtIDE7Ci0gICAgaW50IGVyciA9IDA7CisgICAgaW50
IHJjID0gMCwgcGFydGlhbCA9IHBhZ2UtPnBhcnRpYWxfcHRlOworICAgIHVu
c2lnbmVkIGludCBpID0gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgLSAhcGFy
dGlhbDsKIAogICAgIHBsMmUgPSBtYXBfZG9tYWluX3BhZ2UoX21mbihwZm4p
KTsKIAotICAgIEFTU0VSVChwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyk7Ci0g
ICAgZG8gewotICAgICAgICBpZiAoIGlzX2d1ZXN0X2wyX3Nsb3QoZCwgcGFn
ZS0+dS5pbnVzZS50eXBlX2luZm8sIGkpICYmCi0gICAgICAgICAgICAgcHV0
X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuKSA9PSAwICYmCi0gICAgICAg
ICAgICAgaSAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKKyAgICBm
b3IgKCA7IDsgKQorICAgIHsKKyAgICAgICAgaWYgKCBpc19ndWVzdF9sMl9z
bG90KGQsIHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvLCBpKSApCisgICAgICAg
ICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDJlKHBsMmVbaV0sIHBmbiwgcGFy
dGlhbCwgZmFsc2UpOworICAgICAgICBpZiAoIHJjIDwgMCApCisgICAgICAg
ICAgICBicmVhazsKKworICAgICAgICBwYXJ0aWFsID0gMDsKKworICAgICAg
ICBpZiAoICFpLS0gKQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAg
aWYgKCBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKICAgICAgICAgewot
ICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgICAgIGVyciA9IC1FUkVTVEFSVDsKKyAgICAgICAgICAgIHJjID0gLUVJ
TlRSOworICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KLSAgICB9IHdo
aWxlICggIWVyciAmJiBpLS0gKTsKKyAgICB9CiAKICAgICB1bm1hcF9kb21h
aW5fcGFnZShwbDJlKTsKIAotICAgIGlmICggIWVyciApCisgICAgaWYgKCBy
YyA+PSAwICkKKyAgICB7CiAgICAgICAgIHBhZ2UtPnUuaW51c2UudHlwZV9p
bmZvICY9IH5QR1RfcGFlX3hlbl9sMjsKKyAgICAgICAgcmMgPSAwOworICAg
IH0KKyAgICBlbHNlIGlmICggcmMgPT0gLUVSRVNUQVJUICkKKyAgICB7Cisg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
cGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IC0xOworICAgIH0KKyAg
ICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBMMl9QQUdFVEFCTEVf
RU5UUklFUyAtIDEgKQorICAgIHsKKyAgICAgICAgcGFnZS0+bnJfdmFsaWRh
dGVkX3B0ZXMgPSBpICsgMTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUg
PSAwOworICAgICAgICByYyA9IC1FUkVTVEFSVDsKKyAgICB9CiAKLSAgICBy
ZXR1cm4gZXJyOworICAgIHJldHVybiByYzsKIH0KIAogc3RhdGljIGludCBm
cmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCkBAIC0yMTM4
LDcgKzIxODksNyBAQCBzdGF0aWMgaW50IG1vZF9sMl9lbnRyeShsMl9wZ2Vu
dHJ5X3QgKnBsCiAgICAgICAgICAgICByZXR1cm4gLUVCVVNZOwogICAgICAg
ICB9CiAKLSAgICAgICAgaWYgKCB1bmxpa2VseSgocmMgPSBnZXRfcGFnZV9m
cm9tX2wyZShubDJlLCBwZm4sIGQpKSA8IDApICkKKyAgICAgICAgaWYgKCB1
bmxpa2VseSgocmMgPSBnZXRfcGFnZV9mcm9tX2wyZShubDJlLCBwZm4sIGQs
IDApKSA8IDApICkKICAgICAgICAgICAgIHJldHVybiByYzsKIAogICAgICAg
ICBubDJlID0gYWRqdXN0X2d1ZXN0X2wyZShubDJlLCBkKTsKQEAgLTIxNTcs
NyArMjIwOCw4IEBAIHN0YXRpYyBpbnQgbW9kX2wyX2VudHJ5KGwyX3BnZW50
cnlfdCAqcGwKICAgICAgICAgcmV0dXJuIC1FQlVTWTsKICAgICB9CiAKLSAg
ICBwdXRfcGFnZV9mcm9tX2wyZShvbDJlLCBwZm4pOworICAgIHB1dF9wYWdl
X2Zyb21fbDJlKG9sMmUsIHBmbiwgMCwgdHJ1ZSk7CisKICAgICByZXR1cm4g
cmM7CiB9CiAK

--=separator
Content-Type: application/octet-stream; name="xsa290/4.11-2.patch"
Content-Disposition: attachment; filename="xsa290/4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFkZCBleHBsaWNpdCBwcmVlbXB0aW9uIGNoZWNrcyB0byBM
MyAodW4pdmFsaWRhdGlvbgoKV2hlbiByZWN1cnNpdmUgcGFnZSB0YWJsZXMg
YXJlIHVzZWQgYXQgdGhlIEwzIGxldmVsLCB1bnZhbGlkYXRpb24gb2YgYQpz
aW5nbGUgTDQgdGFibGUgbWF5IGluY3VyIHVudmFsaWRhdGlvbiBvZiB0d28g
bGV2ZWxzIG9mIEwzIHRhYmxlcywgaS5lLgphIG1heGltdW0gaXRlcmF0aW9u
IGNvdW50IG9mIDUxMl4zIGZvciB1bnZhbGlkYXRpbmcgYW4gTDQgdGFibGUu
IFRoZQpwcmVlbXB0aW9uIGNoZWNrIGluIGZyZWVfbDJfdGFibGUoKSBhcyB3
ZWxsIGFzIHRoZSBvbmUgaW4KX3B1dF9wYWdlX3R5cGUoKSBtYXkgbmV2ZXIg
YmUgcmVhY2hlZCwgc28gZXhwbGljaXQgY2hlY2tpbmcgaXMgbmVlZGVkIGlu
CmZyZWVfbDNfdGFibGUoKS4KCldoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVz
IGFyZSB1c2VkIGF0IHRoZSBMNCBsZXZlbCwgdGhlIGl0ZXJhdGlvbiBjb3Vu
dAphdCBMNCBhbG9uZSBpcyBjYXBwZWQgYXQgNTEyXjIuIEFzIHNvb24gYXMg
YSBwcmVzZW50IEwzIGVudHJ5IGlzIGhpdAp3aGljaCBpdHNlbGYgbmVlZHMg
dW52YWxpZGF0aW9uIChhbmQgaGVuY2UgcmVxdWlyaW5nIGFub3RoZXIgbmVz
dGVkIGxvb3AKd2l0aCA1MTIgaXRlcmF0aW9ucyksIHRoZSBwcmVlbXB0aW9u
IGNoZWNrcyBhZGRlZCBoZXJlIGtpY2sgaW4sIHNvIG5vCmZ1cnRoZXIgcHJl
ZW1wdGlvbiBjaGVja2luZyBpcyBuZWVkZWQgYXQgTDQgKHVudGlsIHdlIGRl
Y2lkZSB0byBwZXJtaXQKNS1sZXZlbCBwYWdpbmcgZm9yIFBWIGd1ZXN0cyku
CgpUaGUgdmFsaWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0
IGZvciBzeW1tZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0
cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tbS5jCkBAIC0xNTgxLDYgKzE1ODEsMTMgQEAgc3RhdGljIGlu
dCBhbGxvY19sM190YWJsZShzdHJ1Y3QgcGFnZV9pbgogICAgIGZvciAoIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlczsgaSA8IEwzX1BBR0VUQUJMRV9F
TlRSSUVTOwogICAgICAgICAgIGkrKywgcGFydGlhbCA9IDAgKQogICAgIHsK
KyAgICAgICAgaWYgKCBpID4gcGFnZS0+bnJfdmFsaWRhdGVkX3B0ZXMgJiYg
aHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0gaTsKKyAgICAgICAg
ICAgIHJjID0gLUVSRVNUQVJUOworICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIH0KKwogICAgICAgICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSAm
JiAoaSA9PSAzKSApCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggIShs
M2VfZ2V0X2ZsYWdzKHBsM2VbaV0pICYgX1BBR0VfUFJFU0VOVCkgfHwKQEAg
LTE4ODIsMTUgKzE4ODksMjUgQEAgc3RhdGljIGludCBmcmVlX2wzX3RhYmxl
KHN0cnVjdCBwYWdlX2luZgogCiAgICAgcGwzZSA9IG1hcF9kb21haW5fcGFn
ZShfbWZuKHBmbikpOwogCi0gICAgZG8geworICAgIGZvciAoIDsgOyApCisg
ICAgewogICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNlKHBsM2VbaV0s
IHBmbiwgcGFydGlhbCwgMCk7CiAgICAgICAgIGlmICggcmMgPCAwICkKICAg
ICAgICAgICAgIGJyZWFrOworCiAgICAgICAgIHBhcnRpYWwgPSAwOwotICAg
ICAgICBpZiAoIHJjID4gMCApCi0gICAgICAgICAgICBjb250aW51ZTsKLSAg
ICAgICAgcGwzZVtpXSA9IHVuYWRqdXN0X2d1ZXN0X2wzZShwbDNlW2ldLCBk
KTsKLSAgICB9IHdoaWxlICggaS0tICk7CisgICAgICAgIGlmICggcmMgPT0g
MCApCisgICAgICAgICAgICBwbDNlW2ldID0gdW5hZGp1c3RfZ3Vlc3RfbDNl
KHBsM2VbaV0sIGQpOworCisgICAgICAgIGlmICggIWktLSApCisgICAgICAg
ICAgICBicmVhazsKKworICAgICAgICBpZiAoIGh5cGVyY2FsbF9wcmVlbXB0
X2NoZWNrKCkgKQorICAgICAgICB7CisgICAgICAgICAgICByYyA9IC1FSU5U
UjsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICB9CisgICAgfQogCiAg
ICAgdW5tYXBfZG9tYWluX3BhZ2UocGwzZSk7CiAK

--=separator
Content-Type: application/octet-stream; name="xsa290/unstable-1.patch"
Content-Disposition: attachment; filename="xsa290/unstable-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFsc28gYWxsb3cgTDIgKHVuKXZhbGlkYXRpb24gdG8gYmUg
ZnVsbHkgcHJlZW1wdGlibGUKCkNvbW1pdCBjNjEyNDgxZDFjICgieDg2L21t
OiBQbHVtYmluZyB0byBhbGxvdyBhbnkgUFRFIHVwZGF0ZSB0byBmYWlsCndp
dGggLUVSRVNUQVJUIikgYWRkZWQgYXNzZXJ0aW9ucyBuZXh0IHRvIHRoZSB7
YWxsb2MsZnJlZX1fbDJfdGFibGUoKQppbnZvY2F0aW9ucyB0byBkb2N1bWVu
dCAoYW5kIHZhbGlkYXRlIGluIGRlYnVnIGJ1aWxkcykgdGhhdCBMMgoodW4p
dmFsaWRhdGlvbnMgYXJlIGFsd2F5cyBwcmVlbXB0aWJsZS4KClRoZSBhc3Nl
cnRpb24gaW4gZnJlZV9wYWdlX3R5cGUoKSB3YXMgbm93IG9ic2VydmVkIHRv
IHRyaWdnZXIgd2hlbgpyZWN1cnNpdmUgTDIgcGFnZSB0YWJsZXMgZ2V0IGNs
ZWFuZWQgdXAuCgpJbiBwYXJ0aWN1bGFyIHB1dF9wYWdlX2Zyb21fbDJlKCkn
cyBhc3N1bXB0aW9uIHRoYXQgX3B1dF9wYWdlX3R5cGUoKQp3b3VsZCBhbHdh
eXMgc3VjY2VlZCBpcyBub3cgd3JvbmcsIHJlc3VsdGluZyBpbiBhIHBhcnRp
YWxseSB1bi12YWxpZGF0ZWQKcGFnZSBsZWZ0IGluIGEgZG9tYWluLCB3aGlj
aCBoYXMgbm8gb3RoZXIgbWVhbnMgb2YgZ2V0dGluZyBjbGVhbmVkIHVwCmxh
dGVyIG9uLiBJZiBub3QgY2F1c2luZyBhbnkgcHJvYmxlbXMgZWFybGllciwg
dGhpcyB3b3VsZCB1bHRpbWF0ZWx5CnRyaWdnZXIgdGhlIGNoZWNrIGZvciAt
PnUuaW51c2UudHlwZV9pbmZvIGhhdmluZyBhIHplcm8gY291bnQgd2hlbgpm
cmVlaW5nIHRoZSBwYWdlIGR1cmluZyBjbGVhbnVwIGFmdGVyIHRoZSBkb21h
aW4gaGFzIGRpZWQuCgpBcyBhIHJlc3VsdCBpdCBzaG91bGQgYmUgY29uc2lk
ZXJlZCBhIG1pc3Rha2UgdG8gbm90IGhhdmUgZXh0ZW5kZWQKcHJlZW1wdGlv
biBmdWxseSB0byBMMiB3aGVuIGl0IHdhcyBhZGRlZCB0byBMMy9MNCB0YWJs
ZSBoYW5kbGluZywgd2hpY2gKdGhpcyBjaGFuZ2UgYWltcyB0byBjb3JyZWN0
LgoKVGhlIHZhbGlkYXRpb24gc2lkZSBhZGRpdGlvbnMgYXJlIGRvbmUganVz
dCBmb3Igc3ltbWV0cnkuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTI5MC4KClJl
cG9ydGVkLWJ5OiBNYW51ZWwgQm91eWVyIDxib3V5ZXJAYW50aW9jaGUuZXUu
b3JnPgpUZXN0ZWQtYnk6IE1hbnVlbCBCb3V5ZXIgPGJvdXllckBhbnRpb2No
ZS5ldS5vcmc+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJl
dy5jb29wZXIzQGNpdHJpeC5jb20+Ci0tLQp2MzogUmUtd3JpdHRlbiBkZXNj
cmlwdGlvbi4KdjI6IENsYXJpZnkgdGhhdCBpdCdzIG1haW5seSB1bnZhbGlk
YXRpb24gd2hpY2ggbmVlZHMgYWRqdXN0bWVudC4KCi0tLSBhL3hlbi9hcmNo
L3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC0xMTIzLDcg
KzExMjMsNyBAQCBzdGF0aWMgaW50IGdldF9wYWdlX2FuZF90eXBlX2Zyb21f
bWZuKAogZGVmaW5lX2dldF9saW5lYXJfcGFnZXRhYmxlKGwyKTsKIHN0YXRp
YyBpbnQKIGdldF9wYWdlX2Zyb21fbDJlKAotICAgIGwyX3BnZW50cnlfdCBs
MmUsIHVuc2lnbmVkIGxvbmcgcGZuLCBzdHJ1Y3QgZG9tYWluICpkKQorICAg
IGwyX3BnZW50cnlfdCBsMmUsIHVuc2lnbmVkIGxvbmcgcGZuLCBzdHJ1Y3Qg
ZG9tYWluICpkLCBpbnQgcGFydGlhbCkKIHsKICAgICB1bnNpZ25lZCBsb25n
IG1mbiA9IGwyZV9nZXRfcGZuKGwyZSk7CiAgICAgaW50IHJjOwpAQCAtMTEz
NSw3ICsxMTM1LDggQEAgZ2V0X3BhZ2VfZnJvbV9sMmUoCiAgICAgICAgIHJl
dHVybiAtRUlOVkFMOwogICAgIH0KIAotICAgIHJjID0gZ2V0X3BhZ2VfYW5k
X3R5cGVfZnJvbV9tZm4oX21mbihtZm4pLCBQR1RfbDFfcGFnZV90YWJsZSwg
ZCwgMCwgMCk7CisgICAgcmMgPSBnZXRfcGFnZV9hbmRfdHlwZV9mcm9tX21m
bihfbWZuKG1mbiksIFBHVF9sMV9wYWdlX3RhYmxlLCBkLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydGlhbCwgZmFsc2UpOwog
ICAgIGlmICggdW5saWtlbHkocmMgPT0gLUVJTlZBTCkgJiYgZ2V0X2wyX2xp
bmVhcl9wYWdldGFibGUobDJlLCBwZm4sIGQpICkKICAgICAgICAgcmMgPSAw
OwogCkBAIC0xMjgxLDggKzEyODIsMTEgQEAgc3RhdGljIHZvaWQgcHV0X2Rh
dGFfcGFnZShzdHJ1Y3QgcGFnZV9pbgogICogTkIuIFZpcnR1YWwgYWRkcmVz
cyAnbDJlJyBtYXBzIHRvIGEgbWFjaGluZSBhZGRyZXNzIHdpdGhpbiBmcmFt
ZSAncGZuJy4KICAqIE5vdGUgYWxzbyB0aGF0IHRoaXMgYXV0b21hdGljYWxs
eSBkZWFscyBjb3JyZWN0bHkgd2l0aCBsaW5lYXIgcC50LidzLgogICovCi1z
dGF0aWMgaW50IHB1dF9wYWdlX2Zyb21fbDJlKGwyX3BnZW50cnlfdCBsMmUs
IHVuc2lnbmVkIGxvbmcgcGZuKQorc3RhdGljIGludCBwdXRfcGFnZV9mcm9t
X2wyZShsMl9wZ2VudHJ5X3QgbDJlLCB1bnNpZ25lZCBsb25nIHBmbiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHBhcnRpYWwsIGJvb2wg
ZGVmZXIpCiB7CisgICAgaW50IHJjID0gMDsKKwogICAgIGlmICggIShsMmVf
Z2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QUkVTRU5UKSB8fCAobDJlX2dldF9w
Zm4obDJlKSA9PSBwZm4pICkKICAgICAgICAgcmV0dXJuIDE7CiAKQEAgLTEz
MDAsMTMgKzEzMDQsMjcgQEAgc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wy
ZShsMl9wZ2VudHJ5XwogICAgIGVsc2UKICAgICB7CiAgICAgICAgIHN0cnVj
dCBwYWdlX2luZm8gKnBnID0gbDJlX2dldF9wYWdlKGwyZSk7Ci0gICAgICAg
IGludCByYyA9IF9wdXRfcGFnZV90eXBlKHBnLCBmYWxzZSwgbWZuX3RvX3Bh
Z2UoX21mbihwZm4pKSk7CisgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnB0
cGcgPSBtZm5fdG9fcGFnZShfbWZuKHBmbikpOwogCi0gICAgICAgIEFTU0VS
VCghcmMpOwotICAgICAgICBwdXRfcGFnZShwZyk7CisgICAgICAgIGlmICgg
dW5saWtlbHkocGFydGlhbCA+IDApICkKKyAgICAgICAgeworICAgICAgICAg
ICAgQVNTRVJUKCFkZWZlcik7CisgICAgICAgICAgICByYyA9IF9wdXRfcGFn
ZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKKyAgICAgICAgfQorICAgICAgICBl
bHNlIGlmICggZGVmZXIgKQorICAgICAgICB7CisgICAgICAgICAgICBjdXJy
ZW50LT5hcmNoLm9sZF9ndWVzdF9wdHBnID0gcHRwZzsKKyAgICAgICAgICAg
IGN1cnJlbnQtPmFyY2gub2xkX2d1ZXN0X3RhYmxlID0gcGc7CisgICAgICAg
IH0KKyAgICAgICAgZWxzZQorICAgICAgICB7CisgICAgICAgICAgICByYyA9
IF9wdXRfcGFnZV90eXBlKHBnLCB0cnVlLCBwdHBnKTsKKyAgICAgICAgICAg
IGlmICggbGlrZWx5KCFyYykgKQorICAgICAgICAgICAgICAgIHB1dF9wYWdl
KHBnKTsKKyAgICAgICAgfQogICAgIH0KIAotICAgIHJldHVybiAwOworICAg
IHJldHVybiByYzsKIH0KIAogc3RhdGljIGludCBwdXRfcGFnZV9mcm9tX2wz
ZShsM19wZ2VudHJ5X3QgbDNlLCB1bnNpZ25lZCBsb25nIHBmbiwKQEAgLTE0
ODAsMTEgKzE0OTgsMTIgQEAgc3RhdGljIGludCBhbGxvY19sMl90YWJsZShz
dHJ1Y3QgcGFnZV9pbgogICAgIHVuc2lnbmVkIGxvbmcgIHBmbiA9IG1mbl94
KHBhZ2VfdG9fbWZuKHBhZ2UpKTsKICAgICBsMl9wZ2VudHJ5X3QgICpwbDJl
OwogICAgIHVuc2lnbmVkIGludCAgIGk7Ci0gICAgaW50ICAgICAgICAgICAg
cmMgPSAwOworICAgIGludCAgICAgICAgICAgIHJjID0gMCwgcGFydGlhbCA9
IHBhZ2UtPnBhcnRpYWxfcHRlOwogCiAgICAgcGwyZSA9IG1hcF9kb21haW5f
cGFnZShfbWZuKHBmbikpOwogCi0gICAgZm9yICggaSA9IHBhZ2UtPm5yX3Zh
bGlkYXRlZF9wdGVzOyBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyAp
CisgICAgZm9yICggaSA9IHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzOyBpIDwg
TDJfUEFHRVRBQkxFX0VOVFJJRVM7CisgICAgICAgICAgaSsrLCBwYXJ0aWFs
ID0gMCApCiAgICAgewogICAgICAgICBsMl9wZ2VudHJ5X3QgbDJlOwogCkBA
IC0xNTA3LDIyICsxNTI2LDMyIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDJfdGFi
bGUoc3RydWN0IHBhZ2VfaW4KICAgICAgICAgICAgIHJjID0gLUVSRVNUQVJU
OwogICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAgICAgICAgIHJjID0g
Z2V0X3BhZ2VfZnJvbV9sMmUobDJlLCBwZm4sIGQpOworICAgICAgICAgICAg
cmMgPSBnZXRfcGFnZV9mcm9tX2wyZShsMmUsIHBmbiwgZCwgcGFydGlhbCk7
CiAKLSAgICAgICAgaWYgKCB1bmxpa2VseShyYyA9PSAtRVJFU1RBUlQpICkK
KyAgICAgICAgaWYgKCByYyA9PSAtRVJFU1RBUlQgKQogICAgICAgICB7CiAg
ICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9IGk7Ci0gICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgICAgIHBhZ2UtPnBhcnRpYWxfcHRl
ID0gcGFydGlhbCA/OiAxOwogICAgICAgICB9Ci0KLSAgICAgICAgaWYgKCBy
YyA8IDAgKQorICAgICAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkg
KQorICAgICAgICB7CisgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRf
cHRlcyA9IGk7CisgICAgICAgICAgICBwYWdlLT5wYXJ0aWFsX3B0ZSA9IDA7
CisgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKKyAgICAgICAgfQorICAg
ICAgICBlbHNlIGlmICggcmMgPCAwICYmIHJjICE9IC1FSU5UUiApCiAgICAg
ICAgIHsKICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLCAi
RmFpbHVyZSBpbiBhbGxvY19sMl90YWJsZTogc2xvdCAlI3hcbiIsIGkpOwot
ICAgICAgICAgICAgd2hpbGUgKCBpLS0gPiAwICkKLSAgICAgICAgICAgICAg
ICBpZiAoIGlzX2d1ZXN0X2wyX3Nsb3QoZCwgdHlwZSwgaSkgKQotICAgICAg
ICAgICAgICAgICAgICBwdXRfcGFnZV9mcm9tX2wyZShwbDJlW2ldLCBwZm4p
OwotICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICBpZiAoIGkgKQor
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzID0gaTsKKyAgICAgICAgICAgICAgICBwYWdlLT5wYXJ0aWFs
X3B0ZSA9IDA7CisgICAgICAgICAgICAgICAgY3VycmVudC0+YXJjaC5vbGRf
Z3Vlc3RfcHRwZyA9IE5VTEw7CisgICAgICAgICAgICAgICAgY3VycmVudC0+
YXJjaC5vbGRfZ3Vlc3RfdGFibGUgPSBwYWdlOworICAgICAgICAgICAgfQog
ICAgICAgICB9CisgICAgICAgIGlmICggcmMgPCAwICkKKyAgICAgICAgICAg
IGJyZWFrOwogCiAgICAgICAgIHBsMmVbaV0gPSBhZGp1c3RfZ3Vlc3RfbDJl
KGwyZSwgZCk7CiAgICAgfQpAQCAtMTgyMywyOCArMTg1Miw1MCBAQCBzdGF0
aWMgaW50IGZyZWVfbDJfdGFibGUoc3RydWN0IHBhZ2VfaW5mCiAgICAgc3Ry
dWN0IGRvbWFpbiAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOwogICAgIHVu
c2lnbmVkIGxvbmcgcGZuID0gbWZuX3gocGFnZV90b19tZm4ocGFnZSkpOwog
ICAgIGwyX3BnZW50cnlfdCAqcGwyZTsKLSAgICB1bnNpZ25lZCBpbnQgIGkg
PSBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyAtIDE7Ci0gICAgaW50IGVyciA9
IDA7CisgICAgaW50IHJjID0gMCwgcGFydGlhbCA9IHBhZ2UtPnBhcnRpYWxf
cHRlOworICAgIHVuc2lnbmVkIGludCBpID0gcGFnZS0+bnJfdmFsaWRhdGVk
X3B0ZXMgLSAhcGFydGlhbDsKIAogICAgIHBsMmUgPSBtYXBfZG9tYWluX3Bh
Z2UoX21mbihwZm4pKTsKIAotICAgIEFTU0VSVChwYWdlLT5ucl92YWxpZGF0
ZWRfcHRlcyk7Ci0gICAgZG8gewotICAgICAgICBpZiAoIGlzX2d1ZXN0X2wy
X3Nsb3QoZCwgcGFnZS0+dS5pbnVzZS50eXBlX2luZm8sIGkpICYmCi0gICAg
ICAgICAgICAgcHV0X3BhZ2VfZnJvbV9sMmUocGwyZVtpXSwgcGZuKSA9PSAw
ICYmCi0gICAgICAgICAgICAgaSAmJiBoeXBlcmNhbGxfcHJlZW1wdF9jaGVj
aygpICkKKyAgICBmb3IgKCA7IDsgKQorICAgIHsKKyAgICAgICAgaWYgKCBp
c19ndWVzdF9sMl9zbG90KGQsIHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvLCBp
KSApCisgICAgICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDJlKHBsMmVb
aV0sIHBmbiwgcGFydGlhbCwgZmFsc2UpOworICAgICAgICBpZiAoIHJjIDwg
MCApCisgICAgICAgICAgICBicmVhazsKKworICAgICAgICBwYXJ0aWFsID0g
MDsKKworICAgICAgICBpZiAoICFpLS0gKQorICAgICAgICAgICAgYnJlYWs7
CisKKyAgICAgICAgaWYgKCBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkK
ICAgICAgICAgewotICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRl
cyA9IGk7Ci0gICAgICAgICAgIGVyciA9IC1FUkVTVEFSVDsKKyAgICAgICAg
ICAgIHJjID0gLUVJTlRSOworICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg
IH0KLSAgICB9IHdoaWxlICggIWVyciAmJiBpLS0gKTsKKyAgICB9CiAKICAg
ICB1bm1hcF9kb21haW5fcGFnZShwbDJlKTsKIAotICAgIGlmICggIWVyciAp
CisgICAgaWYgKCByYyA+PSAwICkKKyAgICB7CiAgICAgICAgIHBhZ2UtPnUu
aW51c2UudHlwZV9pbmZvICY9IH5QR1RfcGFlX3hlbl9sMjsKKyAgICAgICAg
cmMgPSAwOworICAgIH0KKyAgICBlbHNlIGlmICggcmMgPT0gLUVSRVNUQVJU
ICkKKyAgICB7CisgICAgICAgIHBhZ2UtPm5yX3ZhbGlkYXRlZF9wdGVzID0g
aTsKKyAgICAgICAgcGFnZS0+cGFydGlhbF9wdGUgPSBwYXJ0aWFsID86IC0x
OworICAgIH0KKyAgICBlbHNlIGlmICggcmMgPT0gLUVJTlRSICYmIGkgPCBM
Ml9QQUdFVEFCTEVfRU5UUklFUyAtIDEgKQorICAgIHsKKyAgICAgICAgcGFn
ZS0+bnJfdmFsaWRhdGVkX3B0ZXMgPSBpICsgMTsKKyAgICAgICAgcGFnZS0+
cGFydGlhbF9wdGUgPSAwOworICAgICAgICByYyA9IC1FUkVTVEFSVDsKKyAg
ICB9CiAKLSAgICByZXR1cm4gZXJyOworICAgIHJldHVybiByYzsKIH0KIAog
c3RhdGljIGludCBmcmVlX2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCkBAIC0yMTY2LDcgKzIyMTcsNyBAQCBzdGF0aWMgaW50IG1vZF9sMl9l
bnRyeShsMl9wZ2VudHJ5X3QgKnBsCiAgICAgICAgICAgICByZXR1cm4gLUVC
VVNZOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKCB1bmxpa2VseSgocmMg
PSBnZXRfcGFnZV9mcm9tX2wyZShubDJlLCBwZm4sIGQpKSA8IDApICkKKyAg
ICAgICAgaWYgKCB1bmxpa2VseSgocmMgPSBnZXRfcGFnZV9mcm9tX2wyZShu
bDJlLCBwZm4sIGQsIDApKSA8IDApICkKICAgICAgICAgICAgIHJldHVybiBy
YzsKIAogICAgICAgICBubDJlID0gYWRqdXN0X2d1ZXN0X2wyZShubDJlLCBk
KTsKQEAgLTIxODUsNyArMjIzNiw4IEBAIHN0YXRpYyBpbnQgbW9kX2wyX2Vu
dHJ5KGwyX3BnZW50cnlfdCAqcGwKICAgICAgICAgcmV0dXJuIC1FQlVTWTsK
ICAgICB9CiAKLSAgICBwdXRfcGFnZV9mcm9tX2wyZShvbDJlLCBwZm4pOwor
ICAgIHB1dF9wYWdlX2Zyb21fbDJlKG9sMmUsIHBmbiwgMCwgdHJ1ZSk7CisK
ICAgICByZXR1cm4gcmM7CiB9CiAK

--=separator
Content-Type: application/octet-stream; name="xsa290/unstable-2.patch"
Content-Disposition: attachment; filename="xsa290/unstable-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvbW06IGFkZCBleHBsaWNpdCBwcmVlbXB0aW9uIGNoZWNrcyB0byBM
MyAodW4pdmFsaWRhdGlvbgoKV2hlbiByZWN1cnNpdmUgcGFnZSB0YWJsZXMg
YXJlIHVzZWQgYXQgdGhlIEwzIGxldmVsLCB1bnZhbGlkYXRpb24gb2YgYQpz
aW5nbGUgTDQgdGFibGUgbWF5IGluY3VyIHVudmFsaWRhdGlvbiBvZiB0d28g
bGV2ZWxzIG9mIEwzIHRhYmxlcywgaS5lLgphIG1heGltdW0gaXRlcmF0aW9u
IGNvdW50IG9mIDUxMl4zIGZvciB1bnZhbGlkYXRpbmcgYW4gTDQgdGFibGUu
IFRoZQpwcmVlbXB0aW9uIGNoZWNrIGluIGZyZWVfbDJfdGFibGUoKSBhcyB3
ZWxsIGFzIHRoZSBvbmUgaW4KX3B1dF9wYWdlX3R5cGUoKSBtYXkgbmV2ZXIg
YmUgcmVhY2hlZCwgc28gZXhwbGljaXQgY2hlY2tpbmcgaXMgbmVlZGVkIGlu
CmZyZWVfbDNfdGFibGUoKS4KCldoZW4gcmVjdXJzaXZlIHBhZ2UgdGFibGVz
IGFyZSB1c2VkIGF0IHRoZSBMNCBsZXZlbCwgdGhlIGl0ZXJhdGlvbiBjb3Vu
dAphdCBMNCBhbG9uZSBpcyBjYXBwZWQgYXQgNTEyXjIuIEFzIHNvb24gYXMg
YSBwcmVzZW50IEwzIGVudHJ5IGlzIGhpdAp3aGljaCBpdHNlbGYgbmVlZHMg
dW52YWxpZGF0aW9uIChhbmQgaGVuY2UgcmVxdWlyaW5nIGFub3RoZXIgbmVz
dGVkIGxvb3AKd2l0aCA1MTIgaXRlcmF0aW9ucyksIHRoZSBwcmVlbXB0aW9u
IGNoZWNrcyBhZGRlZCBoZXJlIGtpY2sgaW4sIHNvIG5vCmZ1cnRoZXIgcHJl
ZW1wdGlvbiBjaGVja2luZyBpcyBuZWVkZWQgYXQgTDQgKHVudGlsIHdlIGRl
Y2lkZSB0byBwZXJtaXQKNS1sZXZlbCBwYWdpbmcgZm9yIFBWIGd1ZXN0cyku
CgpUaGUgdmFsaWRhdGlvbiBzaWRlIGFkZGl0aW9ucyBhcmUgZG9uZSBqdXN0
IGZvciBzeW1tZXRyeS4KClRoaXMgaXMgcGFydCBvZiBYU0EtMjkwLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0
cml4LmNvbT4KLS0tCnYyOiBDbGFyaWZ5IHRoYXQgaXQncyBtYWlubHkgdW52
YWxpZGF0aW9uIHdoaWNoIG5lZWRzIGFkanVzdG1lbnQuCgotLS0gYS94ZW4v
YXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtMTU4
OCw2ICsxNTg4LDEzIEBAIHN0YXRpYyBpbnQgYWxsb2NfbDNfdGFibGUoc3Ry
dWN0IHBhZ2VfaW4KICAgICB7CiAgICAgICAgIGwzX3BnZW50cnlfdCBsM2Ug
PSBwbDNlW2ldOwogCisgICAgICAgIGlmICggaSA+IHBhZ2UtPm5yX3ZhbGlk
YXRlZF9wdGVzICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQorICAg
ICAgICB7CisgICAgICAgICAgICBwYWdlLT5ucl92YWxpZGF0ZWRfcHRlcyA9
IGk7CisgICAgICAgICAgICByYyA9IC1FUkVTVEFSVDsKKyAgICAgICAgICAg
IGJyZWFrOworICAgICAgICB9CisKICAgICAgICAgaWYgKCBpc19wdl8zMmJp
dF9kb21haW4oZCkgJiYgKGkgPT0gMykgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBpZiAoICEobDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VO
VCkgfHwKQEAgLTE5MDgsMTUgKzE5MTUsMjUgQEAgc3RhdGljIGludCBmcmVl
X2wzX3RhYmxlKHN0cnVjdCBwYWdlX2luZgogCiAgICAgcGwzZSA9IG1hcF9k
b21haW5fcGFnZShfbWZuKHBmbikpOwogCi0gICAgZG8geworICAgIGZvciAo
IDsgOyApCisgICAgewogICAgICAgICByYyA9IHB1dF9wYWdlX2Zyb21fbDNl
KHBsM2VbaV0sIHBmbiwgcGFydGlhbCwgMCk7CiAgICAgICAgIGlmICggcmMg
PCAwICkKICAgICAgICAgICAgIGJyZWFrOworCiAgICAgICAgIHBhcnRpYWwg
PSAwOwotICAgICAgICBpZiAoIHJjID4gMCApCi0gICAgICAgICAgICBjb250
aW51ZTsKLSAgICAgICAgcGwzZVtpXSA9IHVuYWRqdXN0X2d1ZXN0X2wzZShw
bDNlW2ldLCBkKTsKLSAgICB9IHdoaWxlICggaS0tICk7CisgICAgICAgIGlm
ICggcmMgPT0gMCApCisgICAgICAgICAgICBwbDNlW2ldID0gdW5hZGp1c3Rf
Z3Vlc3RfbDNlKHBsM2VbaV0sIGQpOworCisgICAgICAgIGlmICggIWktLSAp
CisgICAgICAgICAgICBicmVhazsKKworICAgICAgICBpZiAoIGh5cGVyY2Fs
bF9wcmVlbXB0X2NoZWNrKCkgKQorICAgICAgICB7CisgICAgICAgICAgICBy
YyA9IC1FSU5UUjsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICB9Cisg
ICAgfQogCiAgICAgdW5tYXBfZG9tYWluX3BhZ2UocGwzZSk7CiAK

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


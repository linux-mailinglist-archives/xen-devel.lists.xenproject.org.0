Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E329B14F0D6
	for <lists+xen-devel@lfdr.de>; Fri, 31 Jan 2020 17:47:32 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ixZQM-0000IM-Ma; Fri, 31 Jan 2020 16:45:42 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=r7oN=3U=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1ixZQL-0000IA-E1
 for xen-devel@lists.xenproject.org; Fri, 31 Jan 2020 16:45:41 +0000
X-Inumbo-ID: 1d49bbbe-4449-11ea-8bec-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 1d49bbbe-4449-11ea-8bec-12813bfff9fa;
 Fri, 31 Jan 2020 16:45:40 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 0B62AAD3C;
 Fri, 31 Jan 2020 16:45:40 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
References: <d9ac8ea4-9f2a-93d5-7656-48d93930ed2e@suse.com>
Message-ID: <060e64dd-d107-1d1c-e2eb-da21559f8f5f@suse.com>
Date: Fri, 31 Jan 2020 17:45:42 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko/20100101
 Thunderbird/68.4.2
MIME-Version: 1.0
In-Reply-To: <d9ac8ea4-9f2a-93d5-7656-48d93930ed2e@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH v4 6/7] x86/mm: drop p2mt parameter from
 map_domain_gfn()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 =?UTF-8?Q?Roger_Pau_Monn=c3=a9?= <roger.pau@citrix.com>, Wei Liu <wl@xen.org>,
 Paul Durrant <paul@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Tm8gY2FsbGVyIGFjdHVhbGx5IGNvbnN1bWVzIGl0LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KdjQ6IE5ldy4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9o
dm0vZG9tMF9idWlsZC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vZG9tMF9idWlsZC5jCkBAIC0y
NzgsNyArMjc4LDYgQEAgc3RhdGljIGludCBfX2luaXQgcHZoX2FkZF9tZW1fcmFuZ2Uoc3RydQog
CiBzdGF0aWMgaW50IF9faW5pdCBwdmhfc2V0dXBfdm14X3JlYWxtb2RlX2hlbHBlcnMoc3RydWN0
IGRvbWFpbiAqZCkKIHsKLSAgICBwMm1fdHlwZV90IHAybXQ7CiAgICAgdWludDMyX3QgcmMsICpp
ZGVudF9wdDsKICAgICBtZm5fdCBtZm47CiAgICAgcGFkZHJfdCBnYWRkcjsKQEAgLTMxNyw3ICsz
MTYsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBwdmhfc2V0dXBfdm14X3JlYWxtb2RlCiAgICAgICog
c3VwZXJwYWdlcy4KICAgICAgKi8KICAgICBpZGVudF9wdCA9IG1hcF9kb21haW5fZ2ZuKHAybV9n
ZXRfaG9zdHAybShkKSwgX2dmbihQRk5fRE9XTihnYWRkcikpLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJm1mbiwgJnAybXQsIDAsICZyYyk7CisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAmbWZuLCAwLCAmcmMpOwogICAgIGlmICggaWRlbnRfcHQgPT0gTlVMTCApCiAgICAg
ewogICAgICAgICBwcmludGsoIlVuYWJsZSB0byBtYXAgaWRlbnRpdHkgcGFnZSB0YWJsZXNcbiIp
OwotLS0gYS94ZW4vYXJjaC94ODYvbW0vZ3Vlc3Rfd2Fsay5jCisrKyBiL3hlbi9hcmNoL3g4Ni9t
bS9ndWVzdF93YWxrLmMKQEAgLTg2LDcgKzg2LDYgQEAgZ3Vlc3Rfd2Fsa190YWJsZXMoY29uc3Qg
c3RydWN0IHZjcHUgKnYsCiAgICAgICAgICAgICAgICAgICBnZm5fdCB0b3BfZ2ZuLCBtZm5fdCB0
b3BfbWZuLCB2b2lkICp0b3BfbWFwKQogewogICAgIHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21h
aW47Ci0gICAgcDJtX3R5cGVfdCBwMm10OwogICAgIGd1ZXN0X2wxZV90ICpsMXAgPSBOVUxMOwog
ICAgIGd1ZXN0X2wyZV90ICpsMnAgPSBOVUxMOwogI2lmIEdVRVNUX1BBR0lOR19MRVZFTFMgPj0g
NCAvKiA2NC1iaXQgb25seS4uLiAqLwpAQCAtMTY1LDcgKzE2NCw2IEBAIGd1ZXN0X3dhbGtfdGFi
bGVzKGNvbnN0IHN0cnVjdCB2Y3B1ICp2LAogICAgIGwzcCA9IG1hcF9kb21haW5fZ2ZuKHAybSwK
ICAgICAgICAgICAgICAgICAgICAgICAgICBndWVzdF9sNGVfZ2V0X2dmbihndy0+bDRlKSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAmZ3ctPmwzbWZuLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICZwMm10LAogICAgICAgICAgICAgICAgICAgICAgICAgIHF0LAogICAgICAgICAgICAgICAg
ICAgICAgICAgICZyYyk7CiAgICAgaWYgKCBsM3AgPT0gTlVMTCApCkBAIC0yNTcsNyArMjU1LDYg
QEAgZ3Vlc3Rfd2Fsa190YWJsZXMoY29uc3Qgc3RydWN0IHZjcHUgKnYsCiAgICAgbDJwID0gbWFw
X2RvbWFpbl9nZm4ocDJtLAogICAgICAgICAgICAgICAgICAgICAgICAgIGd1ZXN0X2wzZV9nZXRf
Z2ZuKGd3LT5sM2UpLAogICAgICAgICAgICAgICAgICAgICAgICAgICZndy0+bDJtZm4sCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgJnAybXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgcXQs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgJnJjKTsKICAgICBpZiAoIGwycCA9PSBOVUxMICkK
QEAgLTM1Nyw3ICszNTQsNiBAQCBndWVzdF93YWxrX3RhYmxlcyhjb25zdCBzdHJ1Y3QgdmNwdSAq
diwKICAgICBsMXAgPSBtYXBfZG9tYWluX2dmbihwMm0sCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ3Vlc3RfbDJlX2dldF9nZm4oZ3ctPmwyZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAg
Jmd3LT5sMW1mbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAmcDJtdCwKICAgICAgICAgICAg
ICAgICAgICAgICAgICBxdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAmcmMpOwogICAgIGlm
ICggbDFwID09IE5VTEwgKQotLS0gYS94ZW4vYXJjaC94ODYvbW0vaGFwL25lc3RlZF9lcHQuYwor
KysgYi94ZW4vYXJjaC94ODYvbW0vaGFwL25lc3RlZF9lcHQuYwpAQCAtMTUxLDcgKzE1MSw2IEBA
IHN0YXRpYyB1aW50MzJfdAogbmVwdF93YWxrX3RhYmxlcyhzdHJ1Y3QgdmNwdSAqdiwgdW5zaWdu
ZWQgbG9uZyBsMmdhLCBlcHRfd2Fsa190ICpndykKIHsKICAgICBpbnQgbHZsOwotICAgIHAybV90
eXBlX3QgcDJtdDsKICAgICB1aW50MzJfdCByYyA9IDAsIHJldCA9IDAsIGdmbGFnczsKICAgICBz
dHJ1Y3QgZG9tYWluICpkID0gdi0+ZG9tYWluOwogICAgIHN0cnVjdCBwMm1fZG9tYWluICpwMm0g
PSBkLT5hcmNoLnAybTsKQEAgLTE2Myw3ICsxNjIsNyBAQCBuZXB0X3dhbGtfdGFibGVzKHN0cnVj
dCB2Y3B1ICp2LCB1bnNpZ25lCiAKICAgICBmb3IgKGx2bCA9IDQ7IGx2bCA+IDA7IGx2bC0tKQog
ICAgIHsKLSAgICAgICAgbHhwID0gbWFwX2RvbWFpbl9nZm4ocDJtLCBiYXNlX2dmbiwgJmx4bWZu
LCAmcDJtdCwgUDJNX0FMTE9DLCAmcmMpOworICAgICAgICBseHAgPSBtYXBfZG9tYWluX2dmbihw
Mm0sIGJhc2VfZ2ZuLCAmbHhtZm4sIFAyTV9BTExPQywgJnJjKTsKICAgICAgICAgaWYgKCAhbHhw
ICkKICAgICAgICAgICAgIGdvdG8gbWFwX2VycjsKICAgICAgICAgZ3ctPmx4ZVtsdmxdID0gbHhw
W2VwdF9sdmxfdGFibGVfb2Zmc2V0KGwyZ2EsIGx2bCldOwotLS0gYS94ZW4vYXJjaC94ODYvbW0v
cDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0yMjE0LDggKzIyMTQsOSBAQCB1
bnNpZ25lZCBsb25nIHBhZ2luZ19ndmFfdG9fZ2ZuKHN0cnVjdCB2CiAgKiBzeW50aGV0aWMvc3Ry
dWN0dXJlIFBGRUNfKiBiaXRzLgogICovCiB2b2lkICptYXBfZG9tYWluX2dmbihzdHJ1Y3QgcDJt
X2RvbWFpbiAqcDJtLCBnZm5fdCBnZm4sIG1mbl90ICptZm4sCi0gICAgICAgICAgICAgICAgICAg
ICBwMm1fdHlwZV90ICpwMm10LCBwMm1fcXVlcnlfdCBxLCB1aW50MzJfdCAqcGZlYykKKyAgICAg
ICAgICAgICAgICAgICAgIHAybV9xdWVyeV90IHEsIHVpbnQzMl90ICpwZmVjKQogeworICAgIHAy
bV90eXBlX3QgcDJtdDsKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOwogCiAgICAgaWYgKCAh
Z2ZuX3ZhbGlkKHAybS0+ZG9tYWluLCBnZm4pICkKQEAgLTIyMjUsOCArMjIyNiw4IEBAIHZvaWQg
Km1hcF9kb21haW5fZ2ZuKHN0cnVjdCBwMm1fZG9tYWluICoKICAgICB9CiAKICAgICAvKiBUcmFu
c2xhdGUgdGhlIGdmbiwgdW5zaGFyaW5nIGlmIHNoYXJlZC4gKi8KLSAgICBwYWdlID0gcDJtX2dl
dF9wYWdlX2Zyb21fZ2ZuKHAybSwgZ2ZuLCBwMm10LCBOVUxMLCBxKTsKLSAgICBpZiAoIHAybV9p
c19wYWdpbmcoKnAybXQpICkKKyAgICBwYWdlID0gcDJtX2dldF9wYWdlX2Zyb21fZ2ZuKHAybSwg
Z2ZuLCAmcDJtdCwgTlVMTCwgcSk7CisgICAgaWYgKCBwMm1faXNfcGFnaW5nKHAybXQpICkKICAg
ICB7CiAgICAgICAgIEFTU0VSVChwMm1faXNfaG9zdHAybShwMm0pKTsKICAgICAgICAgaWYgKCBw
YWdlICkKQEAgLTIyMzUsNyArMjIzNiw3IEBAIHZvaWQgKm1hcF9kb21haW5fZ2ZuKHN0cnVjdCBw
Mm1fZG9tYWluICoKICAgICAgICAgKnBmZWMgPSBQRkVDX3BhZ2VfcGFnZWQ7CiAgICAgICAgIHJl
dHVybiBOVUxMOwogICAgIH0KLSAgICBpZiAoIHAybV9pc19zaGFyZWQoKnAybXQpICkKKyAgICBp
ZiAoIHAybV9pc19zaGFyZWQocDJtdCkgKQogICAgIHsKICAgICAgICAgaWYgKCBwYWdlICkKICAg
ICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3AybS5o
CisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKQEAgLTc2Miw3ICs3NjIsNyBAQCBpbnQg
X19tdXN0X2NoZWNrIHAybV9zZXRfZW50cnkoc3RydWN0IHAyCiBleHRlcm4gdm9pZCBwMm1fcHRf
aW5pdChzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtKTsKIAogdm9pZCAqbWFwX2RvbWFpbl9nZm4oc3Ry
dWN0IHAybV9kb21haW4gKnAybSwgZ2ZuX3QgZ2ZuLCBtZm5fdCAqbWZuLAotICAgICAgICAgICAg
ICAgICAgICAgcDJtX3R5cGVfdCAqcDJtdCwgcDJtX3F1ZXJ5X3QgcSwgdWludDMyX3QgKnBmZWMp
OworICAgICAgICAgICAgICAgICAgICAgcDJtX3F1ZXJ5X3QgcSwgdWludDMyX3QgKnBmZWMpOwog
CiAvKiBEZWJ1Z2dpbmcgYW5kIGF1ZGl0aW5nIG9mIHRoZSBQMk0gY29kZT8gKi8KICNpZm5kZWYg
TkRFQlVHCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
WGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0
cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

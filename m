Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 43D4E129804
	for <lists+xen-devel@lfdr.de>; Mon, 23 Dec 2019 16:21:46 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ijPT3-0006KH-H5; Mon, 23 Dec 2019 15:17:57 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=o8ed=2N=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1ijPT2-0006KA-I1
 for xen-devel@lists.xenproject.org; Mon, 23 Dec 2019 15:17:56 +0000
X-Inumbo-ID: 61ae7b80-2597-11ea-b6f1-bc764e2007e4
Received: from mail-qt1-x835.google.com (unknown [2607:f8b0:4864:20::835])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 61ae7b80-2597-11ea-b6f1-bc764e2007e4;
 Mon, 23 Dec 2019 15:17:49 +0000 (UTC)
Received: by mail-qt1-x835.google.com with SMTP id j5so15624423qtq.9
 for <xen-devel@lists.xenproject.org>; Mon, 23 Dec 2019 07:17:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :in-reply-to:references;
 bh=BdM7Aa9ODykWX2XVW3cQ+dGYhtK+6pwO9eA+HlT05yk=;
 b=n0c65eRRIn9A+De1j8SevSoUI5aHs41RezoU/DUwz+O7dRP5rQ0hWB37y58dBM1K9m
 nFppgqEQUoOy/okfEObY2Bq+oFVRICU4m1ks616c+3mAoIn3Cq/mnmoSsYkgbmlIzjXd
 UAYska63g7WOpw1pGCU+o5WjYKl7GiZyaDJzfuesRYEsHEqccp+ksWTFNjOsns8uKyRD
 tJnMy9QJBR81wOEkBf5V582+MmLutJYFNk9F7+Fxl/P6JPA4AlE1W5fCBLSslJDQSDnw
 pOg2Q9ePxs5KSfQR5CO60FAR0AMsPQxSIycfxey3Gi21HiXdJ9t0M7mI+Q0gXvlKcZ3Q
 55Vg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:in-reply-to:references;
 bh=BdM7Aa9ODykWX2XVW3cQ+dGYhtK+6pwO9eA+HlT05yk=;
 b=R3ov3S6WA7WcfEe4wu3JrfAPDGEUAp4Z3WWnywVEggK9GuKsTRcgn/TMA/258W9kx+
 BlDZvZWIOXCIfGMRJegXlChUKNiUn4/ZWgYQbgN2DQF1jiOJpbm1274TfzmnZCp5EdR/
 GQAkAPDc/GQjDwdv7yu/BQDm+aCAQwcA4vJ2C0DzwlGp/OSwBJ9SG1w5/fbQD3QdYIka
 HW+I/0MyVVaLd/2+OtJRk32fisSwjYfjFxo5SBSnbF32OERprdccj5/6G7/Wg9rW6Xxv
 q+ssMu+OATcytLVrlrp36raRnt3ynCGiFAwMm0w9i751LQhmSaF9dyBZzLNe+njZwuwR
 S1JA==
X-Gm-Message-State: APjAAAXnVTOzsDvqxyanxjqwIniotCDEFTJdLRH4aXcJneqw0bEc8T3h
 O5oaRe8VHpKvsIjbr7z7A46SW5A8
X-Google-Smtp-Source: APXvYqzRgre0HLcQgxwq8M6zlA4eshPzVIx03Lrl1/O8WiPTioiiPcpUwj4/9RAbUNmX07Yaimieyw==
X-Received: by 2002:ac8:1e8e:: with SMTP id c14mr21595805qtm.330.1577114268116; 
 Mon, 23 Dec 2019 07:17:48 -0800 (PST)
Received: from four.lan (cpe-67-241-56-252.twcny.res.rr.com. [67.241.56.252])
 by smtp.gmail.com with ESMTPSA id
 u15sm5823907qku.67.2019.12.23.07.17.46
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 23 Dec 2019 07:17:47 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
X-Google-Original-From: Nick Rosbrook <rosbrookn@ainfosec.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 23 Dec 2019 10:17:03 -0500
Message-Id: <8b574d23f6abfc5356b65c958f637f3c22be5d9d.1577111872.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <cover.1577111872.git.rosbrookn@ainfosec.com>
References: <cover.1577111872.git.rosbrookn@ainfosec.com>
In-Reply-To: <cover.1577111872.git.rosbrookn@ainfosec.com>
References: <cover.1577111872.git.rosbrookn@ainfosec.com>
Subject: [Xen-devel] [PATCH v4 2/6] golang/xenlight: begin Go to C type
 marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW1wbGVtZW50IGNvbnZlcnNpb24gb2YgYmFzaWMgdHlwZSBjb252ZXJzaW9ucyBzdWNoIGFzIHN0
cmluZ3MKYW5kIGludGVnZXIgdHlwZXMgaW4gdG9DIGZ1bmN0aW9ucy4KClNpZ25lZC1vZmYtYnk6
IE5pY2sgUm9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29sYW5n
L3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkgIHwgICA4MCArKwogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2hlbHBlcnMuZ2VuLmdvIHwgMTAxNSArKysrKysrKysrKysrKysrKysrKysrKysrKwogMiBmaWxl
cyBjaGFuZ2VkLCAxMDk1IGluc2VydGlvbnMoKykKCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcv
eGVubGlnaHQvZ2VuZ290eXBlcy5weSBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVz
LnB5CmluZGV4IDg4NTdlMmU4ZmQuLjlkNWY4MzAwYTIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2dvbGFu
Zy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5n
b3R5cGVzLnB5CkBAIC0yMzQsNiArMjM0LDkgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5lcmF0
ZV9oZWxwZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5vbmUsIGNvbW1lbnQgPSBOb25lKToKICAg
ICAgICAgICAgICAgICBmLndyaXRlKGV4dHJhKQogICAgICAgICAgICAgICAgIGYud3JpdGUoJ1xu
JykKIAorICAgICAgICAgICAgZi53cml0ZSh4ZW5saWdodF9nb2xhbmdfZGVmaW5lX3RvX0ModHkp
KQorICAgICAgICAgICAgZi53cml0ZSgnXG4nKQorCiAgICAgZ29fZm10KHBhdGgpCiAKIGRlZiB4
ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSA9IE5vbmUpOgpAQCAtNDM0LDYgKzQzNyw4
MyBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2FycmF5X2Zyb21fQyh0eSA9IE5vbmUpOgogCiAgICAg
cmV0dXJuIHMKIAorZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfdG9fQyh0eSA9IE5vbmUsIHR5
cGVuYW1lID0gTm9uZSwgbmVzdGVkID0gRmFsc2UpOgorICAgIHMgPSAnJworCisgICAgZ290eXBl
bmFtZSA9IGN0eXBlbmFtZSA9ICcnCisKKyAgICBpZiB0eXBlbmFtZSBpcyBub3QgTm9uZToKKyAg
ICAgICAgZ290eXBlbmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eXBlbmFtZSkKKyAg
ICAgICAgY3R5cGVuYW1lICA9IHR5cGVuYW1lCisgICAgZWxzZToKKyAgICAgICAgZ290eXBlbmFt
ZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eS50eXBlbmFtZSkKKyAgICAgICAgY3R5cGVu
YW1lICA9IHR5LnR5cGVuYW1lCisKKyAgICBpZiBub3QgbmVzdGVkOgorICAgICAgICBzICs9ICdm
dW5jICh4ICp7fSkgdG9DKCkgKHhjIEMue30sZXJyIGVycm9yKSB7e1xuJy5mb3JtYXQoZ290eXBl
bmFtZSxjdHlwZW5hbWUpCisgICAgICAgIHMgKz0gJ0Mue30oJnhjKVxuJy5mb3JtYXQodHkuaW5p
dF9mbikKKworICAgIGZvciBmIGluIHR5LmZpZWxkczoKKyAgICAgICAgaWYgZi50eXBlLnR5cGVu
YW1lIGlzIG5vdCBOb25lOgorICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5B
cnJheSk6CisgICAgICAgICAgICAgICAgIyBUT0RPCisgICAgICAgICAgICAgICAgY29udGludWUK
KworICAgICAgICAgICAgZ290eXBlbmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShmLnR5
cGUudHlwZW5hbWUpCisgICAgICAgICAgICBjdHlwZW5hbWUgID0gZi50eXBlLnR5cGVuYW1lCisg
ICAgICAgICAgICBnb2ZuYW1lICAgID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGYubmFtZSkK
KyAgICAgICAgICAgIGNmbmFtZSAgICAgPSBmLm5hbWUKKworICAgICAgICAgICAgIyBJbiBjZ28s
IEMgbmFtZXMgdGhhdCBjb25mbGljdCB3aXRoIEdvIGtleXdvcmRzIGNhbiBiZQorICAgICAgICAg
ICAgIyBhY2Nlc3NlZCBieSBwcmVwZW5kaW5nIGFuIHVuZGVyc2NvcmUgdG8gdGhlIG5hbWUuCisg
ICAgICAgICAgICBpZiBjZm5hbWUgaW4gZ29fa2V5d29yZHM6CisgICAgICAgICAgICAgICAgY2Zu
YW1lID0gJ18nICsgY2ZuYW1lCisKKyAgICAgICAgICAgICMgSWYgdGhpcyBpcyBuZXN0ZWQsIHdl
IG5lZWQgdGhlIG91dGVyIG5hbWUgdG9vLgorICAgICAgICAgICAgaWYgbmVzdGVkIGFuZCB0eXBl
bmFtZSBpcyBub3QgTm9uZToKKyAgICAgICAgICAgICAgICBnb25hbWUgPSB4ZW5saWdodF9nb2xh
bmdfZm10X25hbWUodHlwZW5hbWUpCisgICAgICAgICAgICAgICAgZ29uYW1lID0gJ3t9Lnt9Jy5m
b3JtYXQoZ29uYW1lLCBnb2ZuYW1lKQorICAgICAgICAgICAgICAgIGNuYW1lICA9ICd7fS57fScu
Zm9ybWF0KHR5cGVuYW1lLCBjZm5hbWUpCisKKyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAg
ICAgICAgZ29uYW1lID0gZ29mbmFtZQorICAgICAgICAgICAgICAgIGNuYW1lICA9IGNmbmFtZQor
CisgICAgICAgICAgICBpc19jYXN0YWJsZSA9IChmLnR5cGUuanNvbl9wYXJzZV90eXBlID09ICdK
U09OX0lOVEVHRVInIG9yCisgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2luc3RhbmNlKGYu
dHlwZSwgaWRsLkVudW1lcmF0aW9uKSBvcgorICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290
eXBlbmFtZSBpbiBnb19idWlsdGluX3R5cGVzKQorCisgICAgICAgICAgICBpZiBpc19jYXN0YWJs
ZToKKyAgICAgICAgICAgICAgICAjIFVzZSB0aGUgY2dvIGhlbHBlciBmb3IgY29udmVydGluZyBD
IHN0cmluZ3MuCisgICAgICAgICAgICAgICAgaWYgZ290eXBlbmFtZSA9PSAnc3RyaW5nJzoKKyAg
ICAgICAgICAgICAgICAgICAgcyArPSAneGMue30gPSBDLkNTdHJpbmcoeC57fSlcbicuZm9ybWF0
KGNuYW1lLGdvbmFtZSkKKyAgICAgICAgICAgICAgICAgICAgY29udGludWUKKworICAgICAgICAg
ICAgICAgIHMgKz0gJ3hjLnt9ID0gQy57fSh4Lnt9KVxuJy5mb3JtYXQoY25hbWUsY3R5cGVuYW1l
LGdvbmFtZSkKKworICAgICAgICAgICAgZWxzZToKKyAgICAgICAgICAgICAgICBzICs9ICd4Yy57
fSwgZXJyID0geC57fS50b0MoKVxuJy5mb3JtYXQoY25hbWUsZ29uYW1lKQorICAgICAgICAgICAg
ICAgIHMgKz0gJ2lmIGVyciAhPSBuaWwge1xuJworICAgICAgICAgICAgICAgIHMgKz0gJ0Mue30o
JnhjKVxuJy5mb3JtYXQodHkuZGlzcG9zZV9mbikKKyAgICAgICAgICAgICAgICBzICs9ICdyZXR1
cm4geGMsIGVyclxuJworICAgICAgICAgICAgICAgIHMgKz0gJ31cbicKKworICAgICAgICBlbGlm
IGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuU3RydWN0KToKKyAgICAgICAgICAgIHMgKz0geGVubGln
aHRfZ29sYW5nX2RlZmluZV90b19DKGYudHlwZSwgdHlwZW5hbWU9Zi5uYW1lLCBuZXN0ZWQ9VHJ1
ZSkKKworICAgICAgICBlbGlmIGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuS2V5ZWRVbmlvbik6Cisg
ICAgICAgICAgICAjIFRPRE8KKyAgICAgICAgICAgIHBhc3MKKworICAgICAgICBlbHNlOgorICAg
ICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCd0eXBlIHt9IG5vdCBzdXBwb3J0ZWQnLmZvcm1hdChm
LnR5cGUpKQorCisgICAgaWYgbm90IG5lc3RlZDoKKyAgICAgICAgcyArPSAncmV0dXJuIHhjLCBu
aWwnCisgICAgICAgIHMgKz0gJ31cbicKKworICAgIHJldHVybiBzCisKIGRlZiB4ZW5saWdodF9n
b2xhbmdfZm10X25hbWUobmFtZSwgZXhwb3J0ZWQgPSBUcnVlKToKICAgICAiIiIKICAgICBUYWtl
IGEgZ2l2ZW4gdHlwZSBuYW1lIGFuZCByZXR1cm4gYW4KZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFu
Zy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJz
Lmdlbi5nbwppbmRleCAyNTI5NGJhMjkyLi5iZTgwZDZjNzE4IDEwMDY0NAotLS0gYS90b29scy9n
b2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2hlbHBlcnMuZ2VuLmdvCkBAIC0zNyw2ICszNywxMyBAQCBmdW5jICh4ICpJb3BvcnRSYW5nZSkg
ZnJvbUMoeGMgKkMubGlieGxfaW9wb3J0X3JhbmdlKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQog
CitmdW5jICh4ICpJb3BvcnRSYW5nZSkgdG9DKCkgKHhjIEMubGlieGxfaW9wb3J0X3JhbmdlLCBl
cnIgZXJyb3IpIHsKKwlDLmxpYnhsX2lvcG9ydF9yYW5nZV9pbml0KCZ4YykKKwl4Yy5maXJzdCA9
IEMudWludDMyX3QoeC5GaXJzdCkKKwl4Yy5udW1iZXIgPSBDLnVpbnQzMl90KHguTnVtYmVyKQor
CXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKklvbWVtUmFuZ2UpIGZyb21DKHhjICpDLmxp
YnhsX2lvbWVtX3JhbmdlKSBlcnJvciB7CiAJeC5TdGFydCA9IHVpbnQ2NCh4Yy5zdGFydCkKIAl4
Lk51bWJlciA9IHVpbnQ2NCh4Yy5udW1iZXIpCkBAIC00NSwxMiArNTIsMjYgQEAgZnVuYyAoeCAq
SW9tZW1SYW5nZSkgZnJvbUMoeGMgKkMubGlieGxfaW9tZW1fcmFuZ2UpIGVycm9yIHsKIAlyZXR1
cm4gbmlsCiB9CiAKK2Z1bmMgKHggKklvbWVtUmFuZ2UpIHRvQygpICh4YyBDLmxpYnhsX2lvbWVt
X3JhbmdlLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2lvbWVtX3JhbmdlX2luaXQoJnhjKQorCXhj
LnN0YXJ0ID0gQy51aW50NjRfdCh4LlN0YXJ0KQorCXhjLm51bWJlciA9IEMudWludDY0X3QoeC5O
dW1iZXIpCisJeGMuZ2ZuID0gQy51aW50NjRfdCh4LkdmbikKKwlyZXR1cm4geGMsIG5pbAorfQor
CiBmdW5jICh4ICpWZ2FJbnRlcmZhY2VJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92Z2FfaW50ZXJm
YWNlX2luZm8pIGVycm9yIHsKIAl4LktpbmQgPSBWZ2FJbnRlcmZhY2VUeXBlKHhjLmtpbmQpCiAK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZnYUludGVyZmFjZUluZm8pIHRvQygpICh4YyBD
LmxpYnhsX3ZnYV9pbnRlcmZhY2VfaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92Z2FfaW50
ZXJmYWNlX2luZm9faW5pdCgmeGMpCisJeGMua2luZCA9IEMubGlieGxfdmdhX2ludGVyZmFjZV90
eXBlKHguS2luZCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWbmNJbmZvKSBmcm9t
Qyh4YyAqQy5saWJ4bF92bmNfaW5mbykgZXJyb3IgewogCWlmIGVyciA6PSB4LkVuYWJsZS5mcm9t
QygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBlcnIKQEAgLTY1LDYgKzg2LDI0
IEBAIGZ1bmMgKHggKlZuY0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSBlcnJvciB7
CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWbmNJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92
bmNfaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92bmNfaW5mb19pbml0KCZ4YykKKwl4Yy5l
bmFibGUsIGVyciA9IHguRW5hYmxlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxf
dm5jX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmxpc3RlbiA9
IEMuQ1N0cmluZyh4Lkxpc3RlbikKKwl4Yy5wYXNzd2QgPSBDLkNTdHJpbmcoeC5QYXNzd2QpCisJ
eGMuZGlzcGxheSA9IEMuaW50KHguRGlzcGxheSkKKwl4Yy5maW5kdW51c2VkLCBlcnIgPSB4LkZp
bmR1bnVzZWQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF92bmNfaW5mb19kaXNw
b3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVu
YyAoeCAqU3BpY2VJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zcGljZV9pbmZvKSBlcnJvciB7CiAJ
aWYgZXJyIDo9IHguRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKIAkJcmV0
dXJuIGVycgpAQCAtOTIsNiArMTMxLDQzIEBAIGZ1bmMgKHggKlNwaWNlSW5mbykgZnJvbUMoeGMg
KkMubGlieGxfc3BpY2VfaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAq
U3BpY2VJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9zcGljZV9pbmZvLCBlcnIgZXJyb3IpIHsKKwlD
LmxpYnhsX3NwaWNlX2luZm9faW5pdCgmeGMpCisJeGMuZW5hYmxlLCBlcnIgPSB4LkVuYWJsZS50
b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3NwaWNlX2luZm9fZGlzcG9zZSgmeGMp
CisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnBvcnQgPSBDLmludCh4LlBvcnQpCisJeGMudGxz
X3BvcnQgPSBDLmludCh4LlRsc1BvcnQpCisJeGMuaG9zdCA9IEMuQ1N0cmluZyh4Lkhvc3QpCisJ
eGMuZGlzYWJsZV90aWNrZXRpbmcsIGVyciA9IHguRGlzYWJsZVRpY2tldGluZy50b0MoKQorCWlm
IGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3NwaWNlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVy
biB4YywgZXJyCisJfQorCXhjLnBhc3N3ZCA9IEMuQ1N0cmluZyh4LlBhc3N3ZCkKKwl4Yy5hZ2Vu
dF9tb3VzZSwgZXJyID0geC5BZ2VudE1vdXNlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMu
bGlieGxfc3BpY2VfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMu
dmRhZ2VudCwgZXJyID0geC5WZGFnZW50LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGli
eGxfc3BpY2VfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY2xp
cGJvYXJkX3NoYXJpbmcsIGVyciA9IHguQ2xpcGJvYXJkU2hhcmluZy50b0MoKQorCWlmIGVyciAh
PSBuaWwgeworCQlDLmxpYnhsX3NwaWNlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4Yywg
ZXJyCisJfQorCXhjLnVzYnJlZGlyZWN0aW9uID0gQy5pbnQoeC5Vc2JyZWRpcmVjdGlvbikKKwl4
Yy5pbWFnZV9jb21wcmVzc2lvbiA9IEMuQ1N0cmluZyh4LkltYWdlQ29tcHJlc3Npb24pCisJeGMu
c3RyZWFtaW5nX3ZpZGVvID0gQy5DU3RyaW5nKHguU3RyZWFtaW5nVmlkZW8pCisJcmV0dXJuIHhj
LCBuaWwKK30KKwogZnVuYyAoeCAqU2RsSW5mbykgZnJvbUMoeGMgKkMubGlieGxfc2RsX2luZm8p
IGVycm9yIHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJvbUMoJnhjLmVuYWJsZSk7IGVyciAhPSBu
aWwgewogCQlyZXR1cm4gZXJyCkBAIC0xMDUsNiArMTgxLDIzIEBAIGZ1bmMgKHggKlNkbEluZm8p
IGZyb21DKHhjICpDLmxpYnhsX3NkbF9pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpTZGxJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9zZGxfaW5mbywgZXJyIGVycm9yKSB7
CisJQy5saWJ4bF9zZGxfaW5mb19pbml0KCZ4YykKKwl4Yy5lbmFibGUsIGVyciA9IHguRW5hYmxl
LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfc2RsX2luZm9fZGlzcG9zZSgmeGMp
CisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLm9wZW5nbCwgZXJyID0geC5PcGVuZ2wudG9DKCkK
KwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9zZGxfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0
dXJuIHhjLCBlcnIKKwl9CisJeGMuZGlzcGxheSA9IEMuQ1N0cmluZyh4LkRpc3BsYXkpCisJeGMu
eGF1dGhvcml0eSA9IEMuQ1N0cmluZyh4LlhhdXRob3JpdHkpCisJcmV0dXJuIHhjLCBuaWwKK30K
KwogZnVuYyAoeCAqRG9taW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9taW5mbykgZXJyb3Igewog
CWlmIGVyciA6PSB4LlV1aWQuZnJvbUMoJnhjLnV1aWQpOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJu
IGVycgpAQCAtMTMzLDYgKzIyNiwzNiBAQCBmdW5jICh4ICpEb21pbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kb21pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEb21pbmZv
KSB0b0MoKSAoeGMgQy5saWJ4bF9kb21pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RvbWlu
Zm9faW5pdCgmeGMpCisJeGMudXVpZCwgZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5p
bCB7CisJCUMubGlieGxfZG9taW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9
CisJeGMuZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguRG9taWQpCisJeGMuc3NpZHJlZiA9IEMudWlu
dDMyX3QoeC5Tc2lkcmVmKQorCXhjLnNzaWRfbGFiZWwgPSBDLkNTdHJpbmcoeC5Tc2lkTGFiZWwp
CisJeGMucnVubmluZyA9IEMuYm9vbCh4LlJ1bm5pbmcpCisJeGMuYmxvY2tlZCA9IEMuYm9vbCh4
LkJsb2NrZWQpCisJeGMucGF1c2VkID0gQy5ib29sKHguUGF1c2VkKQorCXhjLnNodXRkb3duID0g
Qy5ib29sKHguU2h1dGRvd24pCisJeGMuZHlpbmcgPSBDLmJvb2woeC5EeWluZykKKwl4Yy5uZXZl
cl9zdG9wID0gQy5ib29sKHguTmV2ZXJTdG9wKQorCXhjLnNodXRkb3duX3JlYXNvbiA9IEMubGli
eGxfc2h1dGRvd25fcmVhc29uKHguU2h1dGRvd25SZWFzb24pCisJeGMub3V0c3RhbmRpbmdfbWVt
a2IgPSBDLnVpbnQ2NF90KHguT3V0c3RhbmRpbmdNZW1rYikKKwl4Yy5jdXJyZW50X21lbWtiID0g
Qy51aW50NjRfdCh4LkN1cnJlbnRNZW1rYikKKwl4Yy5zaGFyZWRfbWVta2IgPSBDLnVpbnQ2NF90
KHguU2hhcmVkTWVta2IpCisJeGMucGFnZWRfbWVta2IgPSBDLnVpbnQ2NF90KHguUGFnZWRNZW1r
YikKKwl4Yy5tYXhfbWVta2IgPSBDLnVpbnQ2NF90KHguTWF4TWVta2IpCisJeGMuY3B1X3RpbWUg
PSBDLnVpbnQ2NF90KHguQ3B1VGltZSkKKwl4Yy52Y3B1X21heF9pZCA9IEMudWludDMyX3QoeC5W
Y3B1TWF4SWQpCisJeGMudmNwdV9vbmxpbmUgPSBDLnVpbnQzMl90KHguVmNwdU9ubGluZSkKKwl4
Yy5jcHVwb29sID0gQy51aW50MzJfdCh4LkNwdXBvb2wpCisJeGMuZG9tYWluX3R5cGUgPSBDLmxp
YnhsX2RvbWFpbl90eXBlKHguRG9tYWluVHlwZSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5j
ICh4ICpDcHVwb29saW5mbykgZnJvbUMoeGMgKkMubGlieGxfY3B1cG9vbGluZm8pIGVycm9yIHsK
IAl4LlBvb2xpZCA9IHVpbnQzMih4Yy5wb29saWQpCiAJeC5Qb29sTmFtZSA9IEMuR29TdHJpbmco
eGMucG9vbF9uYW1lKQpAQCAtMTQ1LDYgKzI2OCwyMCBAQCBmdW5jICh4ICpDcHVwb29saW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfY3B1cG9vbGluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAK
K2Z1bmMgKHggKkNwdXBvb2xpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9jcHVwb29saW5mbywgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9jcHVwb29saW5mb19pbml0KCZ4YykKKwl4Yy5wb29saWQgPSBD
LnVpbnQzMl90KHguUG9vbGlkKQorCXhjLnBvb2xfbmFtZSA9IEMuQ1N0cmluZyh4LlBvb2xOYW1l
KQorCXhjLnNjaGVkID0gQy5saWJ4bF9zY2hlZHVsZXIoeC5TY2hlZCkKKwl4Yy5uX2RvbSA9IEMu
dWludDMyX3QoeC5ORG9tKQorCXhjLmNwdW1hcCwgZXJyID0geC5DcHVtYXAudG9DKCkKKwlpZiBl
cnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9jcHVwb29saW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJu
IHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqQ2hhbm5lbGluZm8p
IGZyb21DKHhjICpDLmxpYnhsX2NoYW5uZWxpbmZvKSBlcnJvciB7CiAJeC5CYWNrZW5kID0gQy5H
b1N0cmluZyh4Yy5iYWNrZW5kKQogCXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQp
CkBAIC0xNzksNiArMzE2LDE5IEBAIGZ1bmMgKHggKkNoYW5uZWxpbmZvQ29ubmVjdGlvblVuaW9u
UHR5KSBmcm9tQyh4YyAqQy5saWJ4bF9jaGFubmVsaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwK
IH0KIAorZnVuYyAoeCAqQ2hhbm5lbGluZm8pIHRvQygpICh4YyBDLmxpYnhsX2NoYW5uZWxpbmZv
LCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2NoYW5uZWxpbmZvX2luaXQoJnhjKQorCXhjLmJhY2tl
bmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90KHgu
QmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJvbnRlbmQpCisJeGMuZnJv
bnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZpZCA9IEMubGlieGxf
ZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJeGMuZXZ0Y2ggPSBD
LmludCh4LkV2dGNoKQorCXhjLnJyZWYgPSBDLmludCh4LlJyZWYpCisJcmV0dXJuIHhjLCBuaWwK
K30KKwogZnVuYyAoeCAqVm1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bWluZm8pIGVycm9yIHsK
IAlpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CiAJCXJldHVy
biBlcnIKQEAgLTE4OCw2ICszMzgsMTcgQEAgZnVuYyAoeCAqVm1pbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF92bWluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZtaW5mbykg
dG9DKCkgKHhjIEMubGlieGxfdm1pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3ZtaW5mb19p
bml0KCZ4YykKKwl4Yy51dWlkLCBlcnIgPSB4LlV1aWQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsK
KwkJQy5saWJ4bF92bWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhj
LmRvbWlkID0gQy5saWJ4bF9kb21pZCh4LkRvbWlkKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1
bmMgKHggKlZlcnNpb25JbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92ZXJzaW9uX2luZm8pIGVycm9y
IHsKIAl4LlhlblZlcnNpb25NYWpvciA9IGludCh4Yy54ZW5fdmVyc2lvbl9tYWpvcikKIAl4Llhl
blZlcnNpb25NaW5vciA9IGludCh4Yy54ZW5fdmVyc2lvbl9taW5vcikKQEAgLTIwNiw2ICszNjcs
MjQgQEAgZnVuYyAoeCAqVmVyc2lvbkluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZlcnNpb25faW5m
bykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVmVyc2lvbkluZm8pIHRvQygp
ICh4YyBDLmxpYnhsX3ZlcnNpb25faW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92ZXJzaW9u
X2luZm9faW5pdCgmeGMpCisJeGMueGVuX3ZlcnNpb25fbWFqb3IgPSBDLmludCh4LlhlblZlcnNp
b25NYWpvcikKKwl4Yy54ZW5fdmVyc2lvbl9taW5vciA9IEMuaW50KHguWGVuVmVyc2lvbk1pbm9y
KQorCXhjLnhlbl92ZXJzaW9uX2V4dHJhID0gQy5DU3RyaW5nKHguWGVuVmVyc2lvbkV4dHJhKQor
CXhjLmNvbXBpbGVyID0gQy5DU3RyaW5nKHguQ29tcGlsZXIpCisJeGMuY29tcGlsZV9ieSA9IEMu
Q1N0cmluZyh4LkNvbXBpbGVCeSkKKwl4Yy5jb21waWxlX2RvbWFpbiA9IEMuQ1N0cmluZyh4LkNv
bXBpbGVEb21haW4pCisJeGMuY29tcGlsZV9kYXRlID0gQy5DU3RyaW5nKHguQ29tcGlsZURhdGUp
CisJeGMuY2FwYWJpbGl0aWVzID0gQy5DU3RyaW5nKHguQ2FwYWJpbGl0aWVzKQorCXhjLmNoYW5n
ZXNldCA9IEMuQ1N0cmluZyh4LkNoYW5nZXNldCkKKwl4Yy52aXJ0X3N0YXJ0ID0gQy51aW50NjRf
dCh4LlZpcnRTdGFydCkKKwl4Yy5wYWdlc2l6ZSA9IEMuaW50KHguUGFnZXNpemUpCisJeGMuY29t
bWFuZGxpbmUgPSBDLkNTdHJpbmcoeC5Db21tYW5kbGluZSkKKwl4Yy5idWlsZF9pZCA9IEMuQ1N0
cmluZyh4LkJ1aWxkSWQpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluQ3Jl
YXRlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvKSBlcnJvciB7CiAJ
eC5UeXBlID0gRG9tYWluVHlwZSh4Yy5fdHlwZSkKIAlpZiBlcnIgOj0geC5IYXAuZnJvbUMoJnhj
LmhhcCk7IGVyciAhPSBuaWwgewpAQCAtMjM5LDYgKzQxOCw1MyBAQCBmdW5jICh4ICpEb21haW5D
cmVhdGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIHRvQygpICh4YyBD
LmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kb21haW5f
Y3JlYXRlX2luZm9faW5pdCgmeGMpCisJeGMuX3R5cGUgPSBDLmxpYnhsX2RvbWFpbl90eXBlKHgu
VHlwZSkKKwl4Yy5oYXAsIGVyciA9IHguSGFwLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMu
bGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy5vb3MsIGVyciA9IHguT29zLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGli
eGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0K
Kwl4Yy5zc2lkcmVmID0gQy51aW50MzJfdCh4LlNzaWRyZWYpCisJeGMuc3NpZF9sYWJlbCA9IEMu
Q1N0cmluZyh4LlNzaWRMYWJlbCkKKwl4Yy5uYW1lID0gQy5DU3RyaW5nKHguTmFtZSkKKwl4Yy51
dWlkLCBlcnIgPSB4LlV1aWQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21h
aW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnhz
ZGF0YSwgZXJyID0geC5Yc2RhdGEudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9k
b21haW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhj
LnBsYXRmb3JtZGF0YSwgZXJyID0geC5QbGF0Zm9ybWRhdGEudG9DKCkKKwlpZiBlcnIgIT0gbmls
IHsKKwkJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4
YywgZXJyCisJfQorCXhjLnBvb2xpZCA9IEMudWludDMyX3QoeC5Qb29saWQpCisJeGMucG9vbF9u
YW1lID0gQy5DU3RyaW5nKHguUG9vbE5hbWUpCisJeGMucnVuX2hvdHBsdWdfc2NyaXB0cywgZXJy
ID0geC5SdW5Ib3RwbHVnU2NyaXB0cy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhs
X2RvbWFpbl9jcmVhdGVfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJ
eGMuZHJpdmVyX2RvbWFpbiwgZXJyID0geC5Ecml2ZXJEb21haW4udG9DKCkKKwlpZiBlcnIgIT0g
bmlsIHsKKwkJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVy
biB4YywgZXJyCisJfQorCXhjLnBhc3N0aHJvdWdoID0gQy5saWJ4bF9wYXNzdGhyb3VnaCh4LlBh
c3N0aHJvdWdoKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpblJlc3RvcmVQ
YXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgZXJyb3Igewog
CXguQ2hlY2twb2ludGVkU3RyZWFtID0gaW50KHhjLmNoZWNrcG9pbnRlZF9zdHJlYW0pCiAJeC5T
dHJlYW1WZXJzaW9uID0gdWludDMyKHhjLnN0cmVhbV92ZXJzaW9uKQpAQCAtMjUwLDYgKzQ3Niwx
OSBAQCBmdW5jICh4ICpEb21haW5SZXN0b3JlUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21h
aW5fcmVzdG9yZV9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRv
bWFpblJlc3RvcmVQYXJhbXMpIHRvQygpICh4YyBDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFt
cywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXNfaW5pdCgmeGMp
CisJeGMuY2hlY2twb2ludGVkX3N0cmVhbSA9IEMuaW50KHguQ2hlY2twb2ludGVkU3RyZWFtKQor
CXhjLnN0cmVhbV92ZXJzaW9uID0gQy51aW50MzJfdCh4LlN0cmVhbVZlcnNpb24pCisJeGMuY29s
b19wcm94eV9zY3JpcHQgPSBDLkNTdHJpbmcoeC5Db2xvUHJveHlTY3JpcHQpCisJeGMudXNlcnNw
YWNlX2NvbG9fcHJveHksIGVyciA9IHguVXNlcnNwYWNlQ29sb1Byb3h5LnRvQygpCisJaWYgZXJy
ICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3Jlc3RvcmVfcGFyYW1zX2Rpc3Bvc2UoJnhjKQor
CQlyZXR1cm4geGMsIGVycgorCX0KKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpTY2hl
ZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfcGFyYW1zKSBlcnJvciB7CiAJeC5WY3B1
aWQgPSBpbnQoeGMudmNwdWlkKQogCXguV2VpZ2h0ID0gaW50KHhjLndlaWdodCkKQEAgLTI2MSw2
ICs1MDAsMTcgQEAgZnVuYyAoeCAqU2NoZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX3NjaGVk
X3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqU2NoZWRQYXJhbXMp
IHRvQygpICh4YyBDLmxpYnhsX3NjaGVkX3BhcmFtcywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9z
Y2hlZF9wYXJhbXNfaW5pdCgmeGMpCisJeGMudmNwdWlkID0gQy5pbnQoeC5WY3B1aWQpCisJeGMu
d2VpZ2h0ID0gQy5pbnQoeC5XZWlnaHQpCisJeGMuY2FwID0gQy5pbnQoeC5DYXApCisJeGMucGVy
aW9kID0gQy5pbnQoeC5QZXJpb2QpCisJeGMuZXh0cmF0aW1lID0gQy5pbnQoeC5FeHRyYXRpbWUp
CisJeGMuYnVkZ2V0ID0gQy5pbnQoeC5CdWRnZXQpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVu
YyAoeCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFt
cykgZXJyb3IgewogCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2NoZWQpCiAJbnVtVmNwdXMgOj0g
aW50KHhjLm51bV92Y3B1cykKQEAgLTI3NSw2ICs1MjUsMTIgQEAgZnVuYyAoeCAqVmNwdVNjaGVk
UGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXJl
dHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4
bF92Y3B1X3NjaGVkX3BhcmFtcywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92Y3B1X3NjaGVkX3Bh
cmFtc19pbml0KCZ4YykKKwl4Yy5zY2hlZCA9IEMubGlieGxfc2NoZWR1bGVyKHguU2NoZWQpCisJ
cmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluU2NoZWRQYXJhbXMpIGZyb21DKHhj
ICpDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXMpIGVycm9yIHsKIAl4LlNjaGVkID0gU2NoZWR1
bGVyKHhjLnNjaGVkKQogCXguV2VpZ2h0ID0gaW50KHhjLndlaWdodCkKQEAgLTI4OCw2ICs1NDQs
MTkgQEAgZnVuYyAoeCAqRG9tYWluU2NoZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFp
bl9zY2hlZF9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFp
blNjaGVkUGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zLCBlcnIg
ZXJyb3IpIHsKKwlDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXNfaW5pdCgmeGMpCisJeGMuc2No
ZWQgPSBDLmxpYnhsX3NjaGVkdWxlcih4LlNjaGVkKQorCXhjLndlaWdodCA9IEMuaW50KHguV2Vp
Z2h0KQorCXhjLmNhcCA9IEMuaW50KHguQ2FwKQorCXhjLnBlcmlvZCA9IEMuaW50KHguUGVyaW9k
KQorCXhjLmJ1ZGdldCA9IEMuaW50KHguQnVkZ2V0KQorCXhjLmV4dHJhdGltZSA9IEMuaW50KHgu
RXh0cmF0aW1lKQorCXhjLnNsaWNlID0gQy5pbnQoeC5TbGljZSkKKwl4Yy5sYXRlbmN5ID0gQy5p
bnQoeC5MYXRlbmN5KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZub2RlSW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfdm5vZGVfaW5mbykgZXJyb3IgewogCXguTWVta2IgPSB1aW50NjQo
eGMubWVta2IpCiAJbnVtRGlzdGFuY2VzIDo9IGludCh4Yy5udW1fZGlzdGFuY2VzKQpAQCAtMzA0
LDYgKzU3MywxOCBAQCBmdW5jICh4ICpWbm9kZUluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Zub2Rl
X2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZub2RlSW5mbykgdG9D
KCkgKHhjIEMubGlieGxfdm5vZGVfaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92bm9kZV9p
bmZvX2luaXQoJnhjKQorCXhjLm1lbWtiID0gQy51aW50NjRfdCh4Lk1lbWtiKQorCXhjLnBub2Rl
ID0gQy51aW50MzJfdCh4LlBub2RlKQorCXhjLnZjcHVzLCBlcnIgPSB4LlZjcHVzLnRvQygpCisJ
aWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdm5vZGVfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0
dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqUmRtUmVzZXJ2
ZSkgZnJvbUMoeGMgKkMubGlieGxfcmRtX3Jlc2VydmUpIGVycm9yIHsKIAl4LlN0cmF0ZWd5ID0g
UmRtUmVzZXJ2ZVN0cmF0ZWd5KHhjLnN0cmF0ZWd5KQogCXguUG9saWN5ID0gUmRtUmVzZXJ2ZVBv
bGljeSh4Yy5wb2xpY3kpCkBAIC0zMTEsNiArNTkyLDEzIEBAIGZ1bmMgKHggKlJkbVJlc2VydmUp
IGZyb21DKHhjICpDLmxpYnhsX3JkbV9yZXNlcnZlKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQog
CitmdW5jICh4ICpSZG1SZXNlcnZlKSB0b0MoKSAoeGMgQy5saWJ4bF9yZG1fcmVzZXJ2ZSwgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9yZG1fcmVzZXJ2ZV9pbml0KCZ4YykKKwl4Yy5zdHJhdGVneSA9
IEMubGlieGxfcmRtX3Jlc2VydmVfc3RyYXRlZ3koeC5TdHJhdGVneSkKKwl4Yy5wb2xpY3kgPSBD
LmxpYnhsX3JkbV9yZXNlcnZlX3BvbGljeSh4LlBvbGljeSkKKwlyZXR1cm4geGMsIG5pbAorfQor
CiBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWls
ZF9pbmZvKSBlcnJvciB7CiAJeC5NYXhWY3B1cyA9IGludCh4Yy5tYXhfdmNwdXMpCiAJaWYgZXJy
IDo9IHguQXZhaWxWY3B1cy5mcm9tQygmeGMuYXZhaWxfdmNwdXMpOyBlcnIgIT0gbmlsIHsKQEAg
LTYxMyw2ICs5MDEsMTMwIEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvblB2aCkg
ZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yCiAJcmV0dXJuIG5pbAog
fQogCitmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQygpICh4YyBDLmxpYnhsX2RvbWFpbl9i
dWlsZF9pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2luaXQo
JnhjKQorCXhjLm1heF92Y3B1cyA9IEMuaW50KHguTWF4VmNwdXMpCisJeGMuYXZhaWxfdmNwdXMs
IGVyciA9IHguQXZhaWxWY3B1cy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2Rv
bWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5j
cHVtYXAsIGVyciA9IHguQ3B1bWFwLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxf
ZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhj
Lm5vZGVtYXAsIGVyciA9IHguTm9kZW1hcC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxp
YnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0K
Kwl4Yy5udW1hX3BsYWNlbWVudCwgZXJyID0geC5OdW1hUGxhY2VtZW50LnRvQygpCisJaWYgZXJy
ICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJl
dHVybiB4YywgZXJyCisJfQorCXhjLnRzY19tb2RlID0gQy5saWJ4bF90c2NfbW9kZSh4LlRzY01v
ZGUpCisJeGMubWF4X21lbWtiID0gQy51aW50NjRfdCh4Lk1heE1lbWtiKQorCXhjLnRhcmdldF9t
ZW1rYiA9IEMudWludDY0X3QoeC5UYXJnZXRNZW1rYikKKwl4Yy52aWRlb19tZW1rYiA9IEMudWlu
dDY0X3QoeC5WaWRlb01lbWtiKQorCXhjLnNoYWRvd19tZW1rYiA9IEMudWludDY0X3QoeC5TaGFk
b3dNZW1rYikKKwl4Yy5pb21tdV9tZW1rYiA9IEMudWludDY0X3QoeC5Jb21tdU1lbWtiKQorCXhj
LnJ0Y190aW1lb2Zmc2V0ID0gQy51aW50MzJfdCh4LlJ0Y1RpbWVvZmZzZXQpCisJeGMuZXhlY19z
c2lkcmVmID0gQy51aW50MzJfdCh4LkV4ZWNTc2lkcmVmKQorCXhjLmV4ZWNfc3NpZF9sYWJlbCA9
IEMuQ1N0cmluZyh4LkV4ZWNTc2lkTGFiZWwpCisJeGMubG9jYWx0aW1lLCBlcnIgPSB4LkxvY2Fs
dGltZS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZv
X2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5kaXNhYmxlX21pZ3JhdGUs
IGVyciA9IHguRGlzYWJsZU1pZ3JhdGUudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4
bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJ
eGMuY3B1aWQsIGVyciA9IHguQ3B1aWQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4
bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJ
eGMuYmxrZGV2X3N0YXJ0ID0gQy5DU3RyaW5nKHguQmxrZGV2U3RhcnQpCisJeGMubWF4X2dyYW50
X2ZyYW1lcyA9IEMudWludDMyX3QoeC5NYXhHcmFudEZyYW1lcykKKwl4Yy5tYXhfbWFwdHJhY2tf
ZnJhbWVzID0gQy51aW50MzJfdCh4Lk1heE1hcHRyYWNrRnJhbWVzKQorCXhjLmRldmljZV9tb2Rl
bF92ZXJzaW9uID0gQy5saWJ4bF9kZXZpY2VfbW9kZWxfdmVyc2lvbih4LkRldmljZU1vZGVsVmVy
c2lvbikKKwl4Yy5kZXZpY2VfbW9kZWxfc3R1YmRvbWFpbiwgZXJyID0geC5EZXZpY2VNb2RlbFN0
dWJkb21haW4udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZGV2aWNlX21vZGVs
ID0gQy5DU3RyaW5nKHguRGV2aWNlTW9kZWwpCisJeGMuZGV2aWNlX21vZGVsX3NzaWRyZWYgPSBD
LnVpbnQzMl90KHguRGV2aWNlTW9kZWxTc2lkcmVmKQorCXhjLmRldmljZV9tb2RlbF9zc2lkX2xh
YmVsID0gQy5DU3RyaW5nKHguRGV2aWNlTW9kZWxTc2lkTGFiZWwpCisJeGMuZGV2aWNlX21vZGVs
X3VzZXIgPSBDLkNTdHJpbmcoeC5EZXZpY2VNb2RlbFVzZXIpCisJeGMuZXh0cmEsIGVyciA9IHgu
RXh0cmEudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5m
b19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZXh0cmFfcHYsIGVyciA9
IHguRXh0cmFQdi50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWls
ZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5leHRyYV9odm0s
IGVyciA9IHguRXh0cmFIdm0udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21h
aW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuc2No
ZWRfcGFyYW1zLCBlcnIgPSB4LlNjaGVkUGFyYW1zLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJ
CUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJy
CisJfQorCXhjLmNsYWltX21vZGUsIGVyciA9IHguQ2xhaW1Nb2RlLnRvQygpCisJaWYgZXJyICE9
IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVy
biB4YywgZXJyCisJfQorCXhjLmV2ZW50X2NoYW5uZWxzID0gQy51aW50MzJfdCh4LkV2ZW50Q2hh
bm5lbHMpCisJeGMua2VybmVsID0gQy5DU3RyaW5nKHguS2VybmVsKQorCXhjLmNtZGxpbmUgPSBD
LkNTdHJpbmcoeC5DbWRsaW5lKQorCXhjLnJhbWRpc2sgPSBDLkNTdHJpbmcoeC5SYW1kaXNrKQor
CXhjLmRldmljZV90cmVlID0gQy5DU3RyaW5nKHguRGV2aWNlVHJlZSkKKwl4Yy5hY3BpLCBlcnIg
PSB4LkFjcGkudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuYm9vdGxvYWRlciA9
IEMuQ1N0cmluZyh4LkJvb3Rsb2FkZXIpCisJeGMuYm9vdGxvYWRlcl9hcmdzLCBlcnIgPSB4LkJv
b3Rsb2FkZXJBcmdzLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1
aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnRpbWVyX21v
ZGUgPSBDLmxpYnhsX3RpbWVyX21vZGUoeC5UaW1lck1vZGUpCisJeGMubmVzdGVkX2h2bSwgZXJy
ID0geC5OZXN0ZWRIdm0udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5f
YnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuYXBpYywg
ZXJyID0geC5BcGljLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1
aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmRtX3Jlc3Ry
aWN0LCBlcnIgPSB4LkRtUmVzdHJpY3QudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4
bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJ
eGMudGVlID0gQy5saWJ4bF90ZWVfdHlwZSh4LlRlZSkKKwl4Yy5hcmNoX2FybS5naWNfdmVyc2lv
biA9IEMubGlieGxfZ2ljX3ZlcnNpb24oeC5BcmNoQXJtLkdpY1ZlcnNpb24pCisJeGMuYXJjaF9h
cm0udnVhcnQgPSBDLmxpYnhsX3Z1YXJ0X3R5cGUoeC5BcmNoQXJtLlZ1YXJ0KQorCXhjLmFsdHAy
bSA9IEMubGlieGxfYWx0cDJtX21vZGUoeC5BbHRwMk0pCisJcmV0dXJuIHhjLCBuaWwKK30KKwog
ZnVuYyAoeCAqRGV2aWNlVmZiKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmZiKSBlcnJvciB7
CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERv
bW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTYyOCw2ICsxMDQwLDI1
IEBAIGZ1bmMgKHggKkRldmljZVZmYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgZXJy
b3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlVmZiKSB0b0MoKSAoeGMgQy5s
aWJ4bF9kZXZpY2VfdmZiLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RldmljZV92ZmJfaW5pdCgm
eGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJ
eGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUpCisJeGMuZGV2
aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMudm5jLCBlcnIgPSB4LlZuYy50b0MoKQor
CWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RldmljZV92ZmJfZGlzcG9zZSgmeGMpCisJCXJl
dHVybiB4YywgZXJyCisJfQorCXhjLnNkbCwgZXJyID0geC5TZGwudG9DKCkKKwlpZiBlcnIgIT0g
bmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfdmZiX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVy
cgorCX0KKwl4Yy5rZXltYXAgPSBDLkNTdHJpbmcoeC5LZXltYXApCisJcmV0dXJuIHhjLCBuaWwK
K30KKwogZnVuYyAoeCAqRGV2aWNlVmtiKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmtiKSBl
cnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFj
a2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTY0OCw2ICsx
MDc5LDI2IEBAIGZ1bmMgKHggKkRldmljZVZrYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3Zr
YikgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlVmtiKSB0b0MoKSAo
eGMgQy5saWJ4bF9kZXZpY2VfdmtiLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RldmljZV92a2Jf
aW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5kRG9t
aWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUpCisJ
eGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMuYmFja2VuZF90eXBlID0gQy5s
aWJ4bF92a2JfYmFja2VuZCh4LkJhY2tlbmRUeXBlKQorCXhjLnVuaXF1ZV9pZCA9IEMuQ1N0cmlu
Zyh4LlVuaXF1ZUlkKQorCXhjLmZlYXR1cmVfZGlzYWJsZV9rZXlib2FyZCA9IEMuYm9vbCh4LkZl
YXR1cmVEaXNhYmxlS2V5Ym9hcmQpCisJeGMuZmVhdHVyZV9kaXNhYmxlX3BvaW50ZXIgPSBDLmJv
b2woeC5GZWF0dXJlRGlzYWJsZVBvaW50ZXIpCisJeGMuZmVhdHVyZV9hYnNfcG9pbnRlciA9IEMu
Ym9vbCh4LkZlYXR1cmVBYnNQb2ludGVyKQorCXhjLmZlYXR1cmVfcmF3X3BvaW50ZXIgPSBDLmJv
b2woeC5GZWF0dXJlUmF3UG9pbnRlcikKKwl4Yy5mZWF0dXJlX211bHRpX3RvdWNoID0gQy5ib29s
KHguRmVhdHVyZU11bHRpVG91Y2gpCisJeGMud2lkdGggPSBDLnVpbnQzMl90KHguV2lkdGgpCisJ
eGMuaGVpZ2h0ID0gQy51aW50MzJfdCh4LkhlaWdodCkKKwl4Yy5tdWx0aV90b3VjaF93aWR0aCA9
IEMudWludDMyX3QoeC5NdWx0aVRvdWNoV2lkdGgpCisJeGMubXVsdGlfdG91Y2hfaGVpZ2h0ID0g
Qy51aW50MzJfdCh4Lk11bHRpVG91Y2hIZWlnaHQpCisJeGMubXVsdGlfdG91Y2hfbnVtX2NvbnRh
Y3RzID0gQy51aW50MzJfdCh4Lk11bHRpVG91Y2hOdW1Db250YWN0cykKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VEaXNrKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfZGlz
aykgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4
LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC02Nzgs
NiArMTEyOSw0MiBAQCBmdW5jICh4ICpEZXZpY2VEaXNrKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZp
Y2VfZGlzaykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlRGlzaykg
dG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX2Rpc2ssIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2
aWNlX2Rpc2tfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5C
YWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERv
bW5hbWUpCisJeGMucGRldl9wYXRoID0gQy5DU3RyaW5nKHguUGRldlBhdGgpCisJeGMudmRldiA9
IEMuQ1N0cmluZyh4LlZkZXYpCisJeGMuYmFja2VuZCA9IEMubGlieGxfZGlza19iYWNrZW5kKHgu
QmFja2VuZCkKKwl4Yy5mb3JtYXQgPSBDLmxpYnhsX2Rpc2tfZm9ybWF0KHguRm9ybWF0KQorCXhj
LnNjcmlwdCA9IEMuQ1N0cmluZyh4LlNjcmlwdCkKKwl4Yy5yZW1vdmFibGUgPSBDLmludCh4LlJl
bW92YWJsZSkKKwl4Yy5yZWFkd3JpdGUgPSBDLmludCh4LlJlYWR3cml0ZSkKKwl4Yy5pc19jZHJv
bSA9IEMuaW50KHguSXNDZHJvbSkKKwl4Yy5kaXJlY3RfaW9fc2FmZSA9IEMuYm9vbCh4LkRpcmVj
dElvU2FmZSkKKwl4Yy5kaXNjYXJkX2VuYWJsZSwgZXJyID0geC5EaXNjYXJkRW5hYmxlLnRvQygp
CisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZGV2aWNlX2Rpc2tfZGlzcG9zZSgmeGMpCisJ
CXJldHVybiB4YywgZXJyCisJfQorCXhjLmNvbG9fZW5hYmxlLCBlcnIgPSB4LkNvbG9FbmFibGUu
dG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfZGlza19kaXNwb3NlKCZ4
YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY29sb19yZXN0b3JlX2VuYWJsZSwgZXJyID0g
eC5Db2xvUmVzdG9yZUVuYWJsZS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2Rl
dmljZV9kaXNrX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5jb2xvX2hv
c3QgPSBDLkNTdHJpbmcoeC5Db2xvSG9zdCkKKwl4Yy5jb2xvX3BvcnQgPSBDLmludCh4LkNvbG9Q
b3J0KQorCXhjLmNvbG9fZXhwb3J0ID0gQy5DU3RyaW5nKHguQ29sb0V4cG9ydCkKKwl4Yy5hY3Rp
dmVfZGlzayA9IEMuQ1N0cmluZyh4LkFjdGl2ZURpc2spCisJeGMuaGlkZGVuX2Rpc2sgPSBDLkNT
dHJpbmcoeC5IaWRkZW5EaXNrKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmlj
ZU5pYykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX25pYykgZXJyb3IgewogCXguQmFja2VuZERv
bWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0
cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC03NDgsNiArMTIzNSw3OCBAQCBmdW5jICh4ICpE
ZXZpY2VOaWMpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9uaWMpIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZU5pYykgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX25p
YywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfbmljX2luaXQoJnhjKQorCXhjLmJhY2tl
bmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQorCXhjLmJhY2tlbmRfZG9t
bmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhjLmRldmlkID0gQy5saWJ4bF9k
ZXZpZCh4LkRldmlkKQorCXhjLm10dSA9IEMuaW50KHguTXR1KQorCXhjLm1vZGVsID0gQy5DU3Ry
aW5nKHguTW9kZWwpCisJeGMubWFjLCBlcnIgPSB4Lk1hYy50b0MoKQorCWlmIGVyciAhPSBuaWwg
eworCQlDLmxpYnhsX2RldmljZV9uaWNfZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJ
fQorCXhjLmlwID0gQy5DU3RyaW5nKHguSXApCisJeGMuYnJpZGdlID0gQy5DU3RyaW5nKHguQnJp
ZGdlKQorCXhjLmlmbmFtZSA9IEMuQ1N0cmluZyh4LklmbmFtZSkKKwl4Yy5zY3JpcHQgPSBDLkNT
dHJpbmcoeC5TY3JpcHQpCisJeGMubmljdHlwZSA9IEMubGlieGxfbmljX3R5cGUoeC5OaWN0eXBl
KQorCXhjLnJhdGVfYnl0ZXNfcGVyX2ludGVydmFsID0gQy51aW50NjRfdCh4LlJhdGVCeXRlc1Bl
ckludGVydmFsKQorCXhjLnJhdGVfaW50ZXJ2YWxfdXNlY3MgPSBDLnVpbnQzMl90KHguUmF0ZUlu
dGVydmFsVXNlY3MpCisJeGMuZ2F0ZXdheWRldiA9IEMuQ1N0cmluZyh4LkdhdGV3YXlkZXYpCisJ
eGMuY29sb2Z0X2ZvcndhcmRkZXYgPSBDLkNTdHJpbmcoeC5Db2xvZnRGb3J3YXJkZGV2KQorCXhj
LmNvbG9fc29ja19taXJyb3JfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja01pcnJvcklkKQorCXhj
LmNvbG9fc29ja19taXJyb3JfaXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja01pcnJvcklwKQorCXhj
LmNvbG9fc29ja19taXJyb3JfcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrTWlycm9yUG9ydCkK
Kwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9wcmlfaW5faWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja0Nv
bXBhcmVQcmlJbklkKQorCXhjLmNvbG9fc29ja19jb21wYXJlX3ByaV9pbl9pcCA9IEMuQ1N0cmlu
Zyh4LkNvbG9Tb2NrQ29tcGFyZVByaUluSXApCisJeGMuY29sb19zb2NrX2NvbXBhcmVfcHJpX2lu
X3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja0NvbXBhcmVQcmlJblBvcnQpCisJeGMuY29sb19z
b2NrX2NvbXBhcmVfc2VjX2luX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlU2VjSW5J
ZCkKKwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9zZWNfaW5faXAgPSBDLkNTdHJpbmcoeC5Db2xvU29j
a0NvbXBhcmVTZWNJbklwKQorCXhjLmNvbG9fc29ja19jb21wYXJlX3NlY19pbl9wb3J0ID0gQy5D
U3RyaW5nKHguQ29sb1NvY2tDb21wYXJlU2VjSW5Qb3J0KQorCXhjLmNvbG9fc29ja19jb21wYXJl
X25vdGlmeV9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrQ29tcGFyZU5vdGlmeUlkKQorCXhjLmNv
bG9fc29ja19jb21wYXJlX25vdGlmeV9pcCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrQ29tcGFyZU5v
dGlmeUlwKQorCXhjLmNvbG9fc29ja19jb21wYXJlX25vdGlmeV9wb3J0ID0gQy5DU3RyaW5nKHgu
Q29sb1NvY2tDb21wYXJlTm90aWZ5UG9ydCkKKwl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjBfaWQg
PSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0b3IwSWQpCisJeGMuY29sb19zb2NrX3JlZGly
ZWN0b3IwX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRpcmVjdG9yMElwKQorCXhjLmNvbG9f
c29ja19yZWRpcmVjdG9yMF9wb3J0ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRpcmVjdG9yMFBv
cnQpCisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IxX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tS
ZWRpcmVjdG9yMUlkKQorCXhjLmNvbG9fc29ja19yZWRpcmVjdG9yMV9pcCA9IEMuQ1N0cmluZyh4
LkNvbG9Tb2NrUmVkaXJlY3RvcjFJcCkKKwl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjFfcG9ydCA9
IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjFQb3J0KQorCXhjLmNvbG9fc29ja19yZWRp
cmVjdG9yMl9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjJJZCkKKwl4Yy5jb2xv
X3NvY2tfcmVkaXJlY3RvcjJfaXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0b3IySXAp
CisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IyX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1Jl
ZGlyZWN0b3IyUG9ydCkKKwl4Yy5jb2xvX2ZpbHRlcl9taXJyb3JfcXVldWUgPSBDLkNTdHJpbmco
eC5Db2xvRmlsdGVyTWlycm9yUXVldWUpCisJeGMuY29sb19maWx0ZXJfbWlycm9yX291dGRldiA9
IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJNaXJyb3JPdXRkZXYpCisJeGMuY29sb19maWx0ZXJfcmVk
aXJlY3RvcjBfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyUmVkaXJlY3RvcjBRdWV1ZSkK
Kwl4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMF9pbmRldiA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0
ZXJSZWRpcmVjdG9yMEluZGV2KQorCXhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3IwX291dGRldiA9
IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yME91dGRldikKKwl4Yy5jb2xvX2ZpbHRl
cl9yZWRpcmVjdG9yMV9xdWV1ZSA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMVF1
ZXVlKQorCXhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3IxX2luZGV2ID0gQy5DU3RyaW5nKHguQ29s
b0ZpbHRlclJlZGlyZWN0b3IxSW5kZXYpCisJeGMuY29sb19maWx0ZXJfcmVkaXJlY3RvcjFfb3V0
ZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJlZGlyZWN0b3IxT3V0ZGV2KQorCXhjLmNvbG9f
Y29tcGFyZV9wcmlfaW4gPSBDLkNTdHJpbmcoeC5Db2xvQ29tcGFyZVByaUluKQorCXhjLmNvbG9f
Y29tcGFyZV9zZWNfaW4gPSBDLkNTdHJpbmcoeC5Db2xvQ29tcGFyZVNlY0luKQorCXhjLmNvbG9f
Y29tcGFyZV9vdXQgPSBDLkNTdHJpbmcoeC5Db2xvQ29tcGFyZU91dCkKKwl4Yy5jb2xvX2NvbXBh
cmVfbm90aWZ5X2RldiA9IEMuQ1N0cmluZyh4LkNvbG9Db21wYXJlTm90aWZ5RGV2KQorCXhjLmNv
bG9fc29ja19zZWNfcmVkaXJlY3RvcjBfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1NlY1JlZGly
ZWN0b3IwSWQpCisJeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMF9pcCA9IEMuQ1N0cmluZyh4
LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjBJcCkKKwl4Yy5jb2xvX3NvY2tfc2VjX3JlZGlyZWN0b3Iw
X3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IwUG9ydCkKKwl4Yy5jb2xv
X3NvY2tfc2VjX3JlZGlyZWN0b3IxX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tTZWNSZWRpcmVj
dG9yMUlkKQorCXhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjFfaXAgPSBDLkNTdHJpbmcoeC5D
b2xvU29ja1NlY1JlZGlyZWN0b3IxSXApCisJeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMV9w
b3J0ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMVBvcnQpCisJeGMuY29sb19m
aWx0ZXJfc2VjX3JlZGlyZWN0b3IwX3F1ZXVlID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1Jl
ZGlyZWN0b3IwUXVldWUpCisJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IwX2luZGV2ID0g
Qy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IwSW5kZXYpCisJeGMuY29sb19maWx0
ZXJfc2VjX3JlZGlyZWN0b3IwX291dGRldiA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJTZWNSZWRp
cmVjdG9yME91dGRldikKKwl4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfcXVldWUgPSBD
LkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3RvcjFRdWV1ZSkKKwl4Yy5jb2xvX2ZpbHRl
cl9zZWNfcmVkaXJlY3RvcjFfaW5kZXYgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmVkaXJl
Y3RvcjFJbmRldikKKwl4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfb3V0ZGV2ID0gQy5D
U3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxT3V0ZGV2KQorCXhjLmNvbG9fZmlsdGVy
X3NlY19yZXdyaXRlcjBfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmV3cml0ZXIw
UXVldWUpCisJeGMuY29sb19jaGVja3BvaW50X2hvc3QgPSBDLkNTdHJpbmcoeC5Db2xvQ2hlY2tw
b2ludEhvc3QpCisJeGMuY29sb19jaGVja3BvaW50X3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvQ2hl
Y2twb2ludFBvcnQpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlUGNpKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcGNpKSBlcnJvciB7CiAJeC5GdW5jID0gYnl0ZSh4Yy5f
ZnVuYykKIAl4LkRldiA9IGJ5dGUoeGMuZGV2KQpAQCAtNzY0LDYgKzEzMjMsMjIgQEAgZnVuYyAo
eCAqRGV2aWNlUGNpKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcGNpKSBlcnJvciB7CiAJcmV0
dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VQY2kpIHRvQygpICh4YyBDLmxpYnhsX2Rldmlj
ZV9wY2ksIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX3BjaV9pbml0KCZ4YykKKwl4Yy5f
ZnVuYyA9IEMudWludDhfdCh4LkZ1bmMpCisJeGMuZGV2ID0gQy51aW50OF90KHguRGV2KQorCXhj
LmJ1cyA9IEMudWludDhfdCh4LkJ1cykKKwl4Yy5kb21haW4gPSBDLmludCh4LkRvbWFpbikKKwl4
Yy52ZGV2Zm4gPSBDLnVpbnQzMl90KHguVmRldmZuKQorCXhjLnZmdW5jX21hc2sgPSBDLnVpbnQz
Ml90KHguVmZ1bmNNYXNrKQorCXhjLm1zaXRyYW5zbGF0ZSA9IEMuYm9vbCh4Lk1zaXRyYW5zbGF0
ZSkKKwl4Yy5wb3dlcl9tZ210ID0gQy5ib29sKHguUG93ZXJNZ210KQorCXhjLnBlcm1pc3NpdmUg
PSBDLmJvb2woeC5QZXJtaXNzaXZlKQorCXhjLnNlaXplID0gQy5ib29sKHguU2VpemUpCisJeGMu
cmRtX3BvbGljeSA9IEMubGlieGxfcmRtX3Jlc2VydmVfcG9saWN5KHguUmRtUG9saWN5KQorCXJl
dHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVJkbSkgZnJvbUMoeGMgKkMubGlieGxf
ZGV2aWNlX3JkbSkgZXJyb3IgewogCXguU3RhcnQgPSB1aW50NjQoeGMuc3RhcnQpCiAJeC5TaXpl
ID0gdWludDY0KHhjLnNpemUpCkBAIC03NzIsNiArMTM0NywxNCBAQCBmdW5jICh4ICpEZXZpY2VS
ZG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9yZG0pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKkRldmljZVJkbSkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3JkbSwgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfcmRtX2luaXQoJnhjKQorCXhjLnN0YXJ0ID0gQy51
aW50NjRfdCh4LlN0YXJ0KQorCXhjLnNpemUgPSBDLnVpbnQ2NF90KHguU2l6ZSkKKwl4Yy5wb2xp
Y3kgPSBDLmxpYnhsX3JkbV9yZXNlcnZlX3BvbGljeSh4LlBvbGljeSkKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
dXNiY3RybCkgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90eXBlKQogCXguRGV2
aWQgPSBEZXZpZCh4Yy5kZXZpZCkKQEAgLTc4Myw2ICsxMzY2LDE3IEBAIGZ1bmMgKHggKkRldmlj
ZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JjdHJsKSBlcnJvciB7CiAJcmV0
dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSB0b0MoKSAoeGMgQy5saWJ4bF9k
ZXZpY2VfdXNiY3RybCwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdXNiY3RybF9pbml0
KCZ4YykKKwl4Yy5fdHlwZSA9IEMubGlieGxfdXNiY3RybF90eXBlKHguVHlwZSkKKwl4Yy5kZXZp
ZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy52ZXJzaW9uID0gQy5pbnQoeC5WZXJzaW9u
KQorCXhjLnBvcnRzID0gQy5pbnQoeC5Qb3J0cykKKwl4Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4
bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNrZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmco
eC5CYWNrZW5kRG9tbmFtZSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VV
c2JkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JkZXYpIGVycm9yIHsKIAl4LkN0cmwg
PSBEZXZpZCh4Yy5jdHJsKQogCXguUG9ydCA9IGludCh4Yy5wb3J0KQpAQCAtODEyLDEyICsxNDA2
LDI1IEBAIGZ1bmMgKHggKkRldmljZVVzYmRldlR5cGVVbmlvbkhvc3RkZXYpIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV91c2JkZXYpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHgg
KkRldmljZVVzYmRldikgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3VzYmRldiwgZXJyIGVycm9y
KSB7CisJQy5saWJ4bF9kZXZpY2VfdXNiZGV2X2luaXQoJnhjKQorCXhjLmN0cmwgPSBDLmxpYnhs
X2RldmlkKHguQ3RybCkKKwl4Yy5wb3J0ID0gQy5pbnQoeC5Qb3J0KQorCXJldHVybiB4Yywgbmls
Cit9CisKIGZ1bmMgKHggKkRldmljZUR0ZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfZHRk
ZXYpIGVycm9yIHsKIAl4LlBhdGggPSBDLkdvU3RyaW5nKHhjLnBhdGgpCiAKIAlyZXR1cm4gbmls
CiB9CiAKK2Z1bmMgKHggKkRldmljZUR0ZGV2KSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfZHRk
ZXYsIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX2R0ZGV2X2luaXQoJnhjKQorCXhjLnBh
dGggPSBDLkNTdHJpbmcoeC5QYXRoKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRl
dmljZVZ0cG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJvciB7CiAJeC5CYWNr
ZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBD
LkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTgyOSw2ICsxNDM2LDE5IEBAIGZ1bmMg
KHggKkRldmljZVZ0cG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJvciB7CiAJ
cmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VWdHBtKSB0b0MoKSAoeGMgQy5saWJ4bF9k
ZXZpY2VfdnRwbSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdnRwbV9pbml0KCZ4YykK
Kwl4Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5i
YWNrZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9
IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy51dWlkLCBlcnIgPSB4LlV1aWQudG9DKCkKKwlp
ZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfdnRwbV9kaXNwb3NlKCZ4YykKKwkJcmV0
dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlUDkp
IGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9wOSkgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0g
RG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4
Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC04NDAsNiArMTQ2MCwxNyBAQCBmdW5jICh4ICpEZXZpY2VQ
OSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3A5KSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQog
CitmdW5jICh4ICpEZXZpY2VQOSkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3A5LCBlcnIgZXJy
b3IpIHsKKwlDLmxpYnhsX2RldmljZV9wOV9pbml0KCZ4YykKKwl4Yy5iYWNrZW5kX2RvbWlkID0g
Qy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNrZW5kX2RvbW5hbWUgPSBDLkNT
dHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy50YWcgPSBDLkNTdHJpbmcoeC5UYWcpCisJeGMu
cGF0aCA9IEMuQ1N0cmluZyh4LlBhdGgpCisJeGMuc2VjdXJpdHlfbW9kZWwgPSBDLkNTdHJpbmco
eC5TZWN1cml0eU1vZGVsKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXJl
dHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVB2Y2FsbHNpZikgZnJvbUMoeGMgKkMu
bGlieGxfZGV2aWNlX3B2Y2FsbHNpZikgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQo
eGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNr
ZW5kX2RvbW5hbWUpCkBAIC04NDgsNiArMTQ3OSwxNCBAQCBmdW5jICh4ICpEZXZpY2VQdmNhbGxz
aWYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9wdmNhbGxzaWYpIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVB2Y2FsbHNpZikgdG9DKCkgKHhjIEMubGlieGxfZGV2
aWNlX3B2Y2FsbHNpZiwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmX2lu
aXQoJnhjKQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlk
KQorCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhj
LmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1
bmMgKHggKkRldmljZUNoYW5uZWwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9jaGFubmVsKSBl
cnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFj
a2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTg3OCw2ICsx
NTE3LDE1IEBAIGZ1bmMgKHggKkRldmljZUNoYW5uZWxDb25uZWN0aW9uVW5pb25Tb2NrZXQpIGZy
b21DKHhjICpDLmxpYnhsX2RldmljZV9jaGFubmVsKSBlCiAJcmV0dXJuIG5pbAogfQogCitmdW5j
ICh4ICpEZXZpY2VDaGFubmVsKSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCwgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfY2hhbm5lbF9pbml0KCZ4YykKKwl4Yy5iYWNrZW5k
X2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNrZW5kX2RvbW5h
bWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2
aWQoeC5EZXZpZCkKKwl4Yy5uYW1lID0gQy5DU3RyaW5nKHguTmFtZSkKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpDb25uZWN0b3JQYXJhbSkgZnJvbUMoeGMgKkMubGlieGxfY29ubmVj
dG9yX3BhcmFtKSBlcnJvciB7CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lk
KQogCXguV2lkdGggPSB1aW50MzIoeGMud2lkdGgpCkBAIC04ODYsNiArMTUzNCwxNCBAQCBmdW5j
ICh4ICpDb25uZWN0b3JQYXJhbSkgZnJvbUMoeGMgKkMubGlieGxfY29ubmVjdG9yX3BhcmFtKSBl
cnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpDb25uZWN0b3JQYXJhbSkgdG9DKCkg
KHhjIEMubGlieGxfY29ubmVjdG9yX3BhcmFtLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2Nvbm5l
Y3Rvcl9wYXJhbV9pbml0KCZ4YykKKwl4Yy51bmlxdWVfaWQgPSBDLkNTdHJpbmcoeC5VbmlxdWVJ
ZCkKKwl4Yy53aWR0aCA9IEMudWludDMyX3QoeC5XaWR0aCkKKwl4Yy5oZWlnaHQgPSBDLnVpbnQz
Ml90KHguSGVpZ2h0KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZkaXNw
bCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZkaXNwbCkgZXJyb3IgewogCXguQmFja2VuZERv
bWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0
cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC05MDMsNiArMTU1OSwxNSBAQCBmdW5jICh4ICpE
ZXZpY2VWZGlzcGwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92ZGlzcGwpIGVycm9yIHsKIAly
ZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVZkaXNwbCkgdG9DKCkgKHhjIEMubGlieGxf
ZGV2aWNlX3ZkaXNwbCwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdmRpc3BsX2luaXQo
JnhjKQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQor
CXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhjLmRl
dmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLmJlX2FsbG9jID0gQy5ib29sKHguQmVB
bGxvYykKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWc25kUGFyYW1zKSBmcm9tQyh4
YyAqQy5saWJ4bF92c25kX3BhcmFtcykgZXJyb3IgewogCW51bVNhbXBsZVJhdGVzIDo9IGludCh4
Yy5udW1fc2FtcGxlX3JhdGVzKQogCWNTYW1wbGVSYXRlcyA6PSAoKlsxIDw8IDI4XUMudWludDMy
X3QpKHVuc2FmZS5Qb2ludGVyKHhjLnNhbXBsZV9yYXRlcykpWzpudW1TYW1wbGVSYXRlczpudW1T
YW1wbGVSYXRlc10KQEAgLTkyMyw2ICsxNTg4LDE0IEBAIGZ1bmMgKHggKlZzbmRQYXJhbXMpIGZy
b21DKHhjICpDLmxpYnhsX3ZzbmRfcGFyYW1zKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpWc25kUGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF92c25kX3BhcmFtcywgZXJyIGVy
cm9yKSB7CisJQy5saWJ4bF92c25kX3BhcmFtc19pbml0KCZ4YykKKwl4Yy5jaGFubmVsc19taW4g
PSBDLnVpbnQzMl90KHguQ2hhbm5lbHNNaW4pCisJeGMuY2hhbm5lbHNfbWF4ID0gQy51aW50MzJf
dCh4LkNoYW5uZWxzTWF4KQorCXhjLmJ1ZmZlcl9zaXplID0gQy51aW50MzJfdCh4LkJ1ZmZlclNp
emUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVnNuZFN0cmVhbSkgZnJvbUMoeGMg
KkMubGlieGxfdnNuZF9zdHJlYW0pIGVycm9yIHsKIAl4LlVuaXF1ZUlkID0gQy5Hb1N0cmluZyh4
Yy51bmlxdWVfaWQpCiAJeC5UeXBlID0gVnNuZFN0cmVhbVR5cGUoeGMuX3R5cGUpCkBAIC05MzMs
NiArMTYwNiwxOCBAQCBmdW5jICh4ICpWc25kU3RyZWFtKSBmcm9tQyh4YyAqQy5saWJ4bF92c25k
X3N0cmVhbSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnNuZFN0cmVhbSkg
dG9DKCkgKHhjIEMubGlieGxfdnNuZF9zdHJlYW0sIGVyciBlcnJvcikgeworCUMubGlieGxfdnNu
ZF9zdHJlYW1faW5pdCgmeGMpCisJeGMudW5pcXVlX2lkID0gQy5DU3RyaW5nKHguVW5pcXVlSWQp
CisJeGMuX3R5cGUgPSBDLmxpYnhsX3ZzbmRfc3RyZWFtX3R5cGUoeC5UeXBlKQorCXhjLnBhcmFt
cywgZXJyID0geC5QYXJhbXMudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF92c25k
X3N0cmVhbV9kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBu
aWwKK30KKwogZnVuYyAoeCAqVnNuZFBjbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wY20pIGVy
cm9yIHsKIAl4Lk5hbWUgPSBDLkdvU3RyaW5nKHhjLm5hbWUpCiAJaWYgZXJyIDo9IHguUGFyYW1z
LmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsKQEAgLTk1MCw2ICsxNjM1LDE3IEBAIGZ1
bmMgKHggKlZzbmRQY20pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSBlcnJvciB7CiAJcmV0
dXJuIG5pbAogfQogCitmdW5jICh4ICpWc25kUGNtKSB0b0MoKSAoeGMgQy5saWJ4bF92c25kX3Bj
bSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92c25kX3BjbV9pbml0KCZ4YykKKwl4Yy5uYW1lID0g
Qy5DU3RyaW5nKHguTmFtZSkKKwl4Yy5wYXJhbXMsIGVyciA9IHguUGFyYW1zLnRvQygpCisJaWYg
ZXJyICE9IG5pbCB7CisJCUMubGlieGxfdnNuZF9wY21fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4
YywgZXJyCisJfQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZzbmQpIGZy
b21DKHhjICpDLmxpYnhsX2RldmljZV92c25kKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBE
b21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhj
LmJhY2tlbmRfZG9tbmFtZSkKQEAgLTk3MSw2ICsxNjY3LDIxIEBAIGZ1bmMgKHggKkRldmljZVZz
bmQpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92c25kKSBlcnJvciB7CiAJcmV0dXJuIG5pbAog
fQogCitmdW5jICh4ICpEZXZpY2VWc25kKSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfdnNuZCwg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdnNuZF9pbml0KCZ4YykKKwl4Yy5iYWNrZW5k
X2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNrZW5kX2RvbW5h
bWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2
aWQoeC5EZXZpZCkKKwl4Yy5zaG9ydF9uYW1lID0gQy5DU3RyaW5nKHguU2hvcnROYW1lKQorCXhj
LmxvbmdfbmFtZSA9IEMuQ1N0cmluZyh4LkxvbmdOYW1lKQorCXhjLnBhcmFtcywgZXJyID0geC5Q
YXJhbXMudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfdnNuZF9kaXNw
b3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVu
YyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJv
ciB7CiAJaWYgZXJyIDo9IHguQ0luZm8uZnJvbUMoJnhjLmNfaW5mbyk7IGVyciAhPSBuaWwgewog
CQlyZXR1cm4gZXJyCkBAIC0xMTA3LDYgKzE4MTgsMjYgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmln
KSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJvciB7CiAJcmV0dXJuIG5pbAog
fQogCitmdW5jICh4ICpEb21haW5Db25maWcpIHRvQygpICh4YyBDLmxpYnhsX2RvbWFpbl9jb25m
aWcsIGVyciBlcnJvcikgeworCUMubGlieGxfZG9tYWluX2NvbmZpZ19pbml0KCZ4YykKKwl4Yy5j
X2luZm8sIGVyciA9IHguQ0luZm8udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9k
b21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5iX2lu
Zm8sIGVyciA9IHguQkluZm8udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21h
aW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5vbl9wb3dl
cm9mZiA9IEMubGlieGxfYWN0aW9uX29uX3NodXRkb3duKHguT25Qb3dlcm9mZikKKwl4Yy5vbl9y
ZWJvb3QgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uUmVib290KQorCXhjLm9uX3dh
dGNoZG9nID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PbldhdGNoZG9nKQorCXhjLm9u
X2NyYXNoID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PbkNyYXNoKQorCXhjLm9uX3Nv
ZnRfcmVzZXQgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uU29mdFJlc2V0KQorCXJl
dHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRpc2tpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9k
aXNraW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4
LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTEyMCw2ICsxODUxLDE5IEBA
IGZ1bmMgKHggKkRpc2tpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kaXNraW5mbykgZXJyb3Igewog
CXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGlza2luZm8pIHRvQygpICh4YyBDLmxpYnhsX2Rp
c2tpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2Rpc2tpbmZvX2luaXQoJnhjKQorCXhjLmJh
Y2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90
KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJvbnRlbmQpCisJeGMu
ZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZpZCA9IEMubGli
eGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJeGMuZXZ0Y2gg
PSBDLmludCh4LkV2dGNoKQorCXhjLnJyZWYgPSBDLmludCh4LlJyZWYpCisJcmV0dXJuIHhjLCBu
aWwKK30KKwogZnVuYyAoeCAqTmljaW5mbykgZnJvbUMoeGMgKkMubGlieGxfbmljaW5mbykgZXJy
b3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9
IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTEzNCw2ICsxODc4LDIwIEBAIGZ1bmMgKHggKk5p
Y2luZm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKk5pY2luZm8pIHRvQygpICh4YyBDLmxpYnhsX25pY2luZm8sIGVyciBlcnJv
cikgeworCUMubGlieGxfbmljaW5mb19pbml0KCZ4YykKKwl4Yy5iYWNrZW5kID0gQy5DU3RyaW5n
KHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkKKwl4
Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lkID0gQy51
aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQp
CisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRjaCkK
Kwl4Yy5ycmVmX3R4ID0gQy5pbnQoeC5ScmVmVHgpCisJeGMucnJlZl9yeCA9IEMuaW50KHguUnJl
ZlJ4KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZ0cG1pbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF92dHBtaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTE1MCw2ICsx
OTA4LDI0IEBAIGZ1bmMgKHggKlZ0cG1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92dHBtaW5mbykg
ZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnRwbWluZm8pIHRvQygpICh4YyBD
LmxpYnhsX3Z0cG1pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3Z0cG1pbmZvX2luaXQoJnhj
KQorCXhjLmJhY2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQgPSBD
LnVpbnQzMl90KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJvbnRl
bmQpCisJeGMuZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZp
ZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJ
eGMuZXZ0Y2ggPSBDLmludCh4LkV2dGNoKQorCXhjLnJyZWYgPSBDLmludCh4LlJyZWYpCisJeGMu
dXVpZCwgZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdnRw
bWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4Yywgbmls
Cit9CisKIGZ1bmMgKHggKlVzYmN0cmxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF91c2JjdHJsaW5m
bykgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90eXBlKQogCXguRGV2aWQgPSBE
ZXZpZCh4Yy5kZXZpZCkKQEAgLTExNjcsNiArMTk0MywyMyBAQCBmdW5jICh4ICpVc2JjdHJsaW5m
bykgZnJvbUMoeGMgKkMubGlieGxfdXNiY3RybGluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKlVzYmN0cmxpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF91c2JjdHJsaW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF91c2JjdHJsaW5mb19pbml0KCZ4YykKKwl4Yy5fdHlwZSA9
IEMubGlieGxfdXNiY3RybF90eXBlKHguVHlwZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQo
eC5EZXZpZCkKKwl4Yy52ZXJzaW9uID0gQy5pbnQoeC5WZXJzaW9uKQorCXhjLnBvcnRzID0gQy5p
bnQoeC5Qb3J0cykKKwl4Yy5iYWNrZW5kID0gQy5DU3RyaW5nKHguQmFja2VuZCkKKwl4Yy5iYWNr
ZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkKKwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmlu
Zyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lkID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQp
CisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRjaCkK
Kwl4Yy5yZWZfdXJiID0gQy5pbnQoeC5SZWZVcmIpCisJeGMucmVmX2Nvbm4gPSBDLmludCh4LlJl
ZkNvbm4pCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVmNwdWluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3ZjcHVpbmZvKSBlcnJvciB7CiAJeC5WY3B1aWQgPSB1aW50MzIoeGMudmNwdWlk
KQogCXguQ3B1ID0gdWludDMyKHhjLmNwdSkKQEAgLTExODQsNiArMTk3NywyNyBAQCBmdW5jICh4
ICpWY3B1aW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmNwdWluZm8pIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKK2Z1bmMgKHggKlZjcHVpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92Y3B1aW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF92Y3B1aW5mb19pbml0KCZ4YykKKwl4Yy52Y3B1aWQgPSBD
LnVpbnQzMl90KHguVmNwdWlkKQorCXhjLmNwdSA9IEMudWludDMyX3QoeC5DcHUpCisJeGMub25s
aW5lID0gQy5ib29sKHguT25saW5lKQorCXhjLmJsb2NrZWQgPSBDLmJvb2woeC5CbG9ja2VkKQor
CXhjLnJ1bm5pbmcgPSBDLmJvb2woeC5SdW5uaW5nKQorCXhjLnZjcHVfdGltZSA9IEMudWludDY0
X3QoeC5WY3B1VGltZSkKKwl4Yy5jcHVtYXAsIGVyciA9IHguQ3B1bWFwLnRvQygpCisJaWYgZXJy
ICE9IG5pbCB7CisJCUMubGlieGxfdmNwdWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4Yywg
ZXJyCisJfQorCXhjLmNwdW1hcF9zb2Z0LCBlcnIgPSB4LkNwdW1hcFNvZnQudG9DKCkKKwlpZiBl
cnIgIT0gbmlsIHsKKwkJQy5saWJ4bF92Y3B1aW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhj
LCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqUGh5c2luZm8pIGZyb21D
KHhjICpDLmxpYnhsX3BoeXNpbmZvKSBlcnJvciB7CiAJeC5UaHJlYWRzUGVyQ29yZSA9IHVpbnQz
Mih4Yy50aHJlYWRzX3Blcl9jb3JlKQogCXguQ29yZXNQZXJTb2NrZXQgPSB1aW50MzIoeGMuY29y
ZXNfcGVyX3NvY2tldCkKQEAgLTEyMTEsNiArMjAyNSwzNSBAQCBmdW5jICh4ICpQaHlzaW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfcGh5c2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1
bmMgKHggKlBoeXNpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9waHlzaW5mbywgZXJyIGVycm9yKSB7
CisJQy5saWJ4bF9waHlzaW5mb19pbml0KCZ4YykKKwl4Yy50aHJlYWRzX3Blcl9jb3JlID0gQy51
aW50MzJfdCh4LlRocmVhZHNQZXJDb3JlKQorCXhjLmNvcmVzX3Blcl9zb2NrZXQgPSBDLnVpbnQz
Ml90KHguQ29yZXNQZXJTb2NrZXQpCisJeGMubWF4X2NwdV9pZCA9IEMudWludDMyX3QoeC5NYXhD
cHVJZCkKKwl4Yy5ucl9jcHVzID0gQy51aW50MzJfdCh4Lk5yQ3B1cykKKwl4Yy5jcHVfa2h6ID0g
Qy51aW50MzJfdCh4LkNwdUtoeikKKwl4Yy50b3RhbF9wYWdlcyA9IEMudWludDY0X3QoeC5Ub3Rh
bFBhZ2VzKQorCXhjLmZyZWVfcGFnZXMgPSBDLnVpbnQ2NF90KHguRnJlZVBhZ2VzKQorCXhjLnNj
cnViX3BhZ2VzID0gQy51aW50NjRfdCh4LlNjcnViUGFnZXMpCisJeGMub3V0c3RhbmRpbmdfcGFn
ZXMgPSBDLnVpbnQ2NF90KHguT3V0c3RhbmRpbmdQYWdlcykKKwl4Yy5zaGFyaW5nX2ZyZWVkX3Bh
Z2VzID0gQy51aW50NjRfdCh4LlNoYXJpbmdGcmVlZFBhZ2VzKQorCXhjLnNoYXJpbmdfdXNlZF9m
cmFtZXMgPSBDLnVpbnQ2NF90KHguU2hhcmluZ1VzZWRGcmFtZXMpCisJeGMubWF4X3Bvc3NpYmxl
X21mbiA9IEMudWludDY0X3QoeC5NYXhQb3NzaWJsZU1mbikKKwl4Yy5ucl9ub2RlcyA9IEMudWlu
dDMyX3QoeC5Ock5vZGVzKQorCXhjLmh3X2NhcCwgZXJyID0geC5Id0NhcC50b0MoKQorCWlmIGVy
ciAhPSBuaWwgeworCQlDLmxpYnhsX3BoeXNpbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMs
IGVycgorCX0KKwl4Yy5jYXBfaHZtID0gQy5ib29sKHguQ2FwSHZtKQorCXhjLmNhcF9wdiA9IEMu
Ym9vbCh4LkNhcFB2KQorCXhjLmNhcF9odm1fZGlyZWN0aW8gPSBDLmJvb2woeC5DYXBIdm1EaXJl
Y3RpbykKKwl4Yy5jYXBfaGFwID0gQy5ib29sKHguQ2FwSGFwKQorCXhjLmNhcF9zaGFkb3cgPSBD
LmJvb2woeC5DYXBTaGFkb3cpCisJeGMuY2FwX2lvbW11X2hhcF9wdF9zaGFyZSA9IEMuYm9vbCh4
LkNhcElvbW11SGFwUHRTaGFyZSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpDb25u
ZWN0b3JpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JpbmZvKSBlcnJvciB7CiAJeC5V
bmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQogCXguV2lkdGggPSB1aW50MzIoeGMu
d2lkdGgpCkBAIC0xMjIzLDYgKzIwNjYsMTggQEAgZnVuYyAoeCAqQ29ubmVjdG9yaW5mbykgZnJv
bUMoeGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAor
ZnVuYyAoeCAqQ29ubmVjdG9yaW5mbykgdG9DKCkgKHhjIEMubGlieGxfY29ubmVjdG9yaW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF9jb25uZWN0b3JpbmZvX2luaXQoJnhjKQorCXhjLnVuaXF1
ZV9pZCA9IEMuQ1N0cmluZyh4LlVuaXF1ZUlkKQorCXhjLndpZHRoID0gQy51aW50MzJfdCh4Lldp
ZHRoKQorCXhjLmhlaWdodCA9IEMudWludDMyX3QoeC5IZWlnaHQpCisJeGMucmVxX2V2dGNoID0g
Qy5pbnQoeC5SZXFFdnRjaCkKKwl4Yy5yZXFfcnJlZiA9IEMuaW50KHguUmVxUnJlZikKKwl4Yy5l
dnRfZXZ0Y2ggPSBDLmludCh4LkV2dEV2dGNoKQorCXhjLmV2dF9ycmVmID0gQy5pbnQoeC5FdnRS
cmVmKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZkaXNwbGluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3ZkaXNwbGluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhj
LmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTEyNDMs
NiArMjA5OCwxOCBAQCBmdW5jICh4ICpWZGlzcGxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92ZGlz
cGxpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWZGlzcGxpbmZvKSB0
b0MoKSAoeGMgQy5saWJ4bF92ZGlzcGxpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3ZkaXNw
bGluZm9faW5pdCgmeGMpCisJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQpCisJeGMu
YmFja2VuZF9pZCA9IEMudWludDMyX3QoeC5CYWNrZW5kSWQpCisJeGMuZnJvbnRlbmQgPSBDLkNT
dHJpbmcoeC5Gcm9udGVuZCkKKwl4Yy5mcm9udGVuZF9pZCA9IEMudWludDMyX3QoeC5Gcm9udGVu
ZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLnN0YXRlID0gQy5p
bnQoeC5TdGF0ZSkKKwl4Yy5iZV9hbGxvYyA9IEMuYm9vbCh4LkJlQWxsb2MpCisJcmV0dXJuIHhj
LCBuaWwKK30KKwogZnVuYyAoeCAqU3RyZWFtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfc3RyZWFt
aW5mbykgZXJyb3IgewogCXguUmVxRXZ0Y2ggPSBpbnQoeGMucmVxX2V2dGNoKQogCXguUmVxUnJl
ZiA9IGludCh4Yy5yZXFfcnJlZikKQEAgLTEyNTAsNiArMjExNywxMyBAQCBmdW5jICh4ICpTdHJl
YW1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zdHJlYW1pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpTdHJlYW1pbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9zdHJlYW1pbmZv
LCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3N0cmVhbWluZm9faW5pdCgmeGMpCisJeGMucmVxX2V2
dGNoID0gQy5pbnQoeC5SZXFFdnRjaCkKKwl4Yy5yZXFfcnJlZiA9IEMuaW50KHguUmVxUnJlZikK
KwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpQY21pbmZvKSBmcm9tQyh4YyAqQy5saWJ4
bF9wY21pbmZvKSBlcnJvciB7CiAJbnVtVnNuZFN0cmVhbXMgOj0gaW50KHhjLm51bV92c25kX3N0
cmVhbXMpCiAJY1N0cmVhbXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3N0cmVhbWluZm8pKHVuc2Fm
ZS5Qb2ludGVyKHhjLnN0cmVhbXMpKVs6bnVtVnNuZFN0cmVhbXM6bnVtVnNuZFN0cmVhbXNdCkBA
IC0xMjYzLDYgKzIxMzcsMTEgQEAgZnVuYyAoeCAqUGNtaW5mbykgZnJvbUMoeGMgKkMubGlieGxf
cGNtaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqUGNtaW5mbykgdG9D
KCkgKHhjIEMubGlieGxfcGNtaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9wY21pbmZvX2lu
aXQoJnhjKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZzbmRpbmZvKSBmcm9tQyh4
YyAqQy5saWJ4bF92c25kaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMu
YmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTI4Miw2
ICsyMTYxLDE3IEBAIGZ1bmMgKHggKlZzbmRpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kaW5m
bykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnNuZGluZm8pIHRvQygpICh4
YyBDLmxpYnhsX3ZzbmRpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3ZzbmRpbmZvX2luaXQo
JnhjKQorCXhjLmJhY2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQg
PSBDLnVpbnQzMl90KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJv
bnRlbmQpCisJeGMuZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5k
ZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUp
CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVmtiaW5mbykgZnJvbUMoeGMgKkMubGli
eGxfdmtiaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkK
IAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTI5NSw2ICsyMTg1LDE5
IEBAIGZ1bmMgKHggKlZrYmluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZrYmluZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZrYmluZm8pIHRvQygpICh4YyBDLmxpYnhsX3Zr
YmluZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfdmtiaW5mb19pbml0KCZ4YykKKwl4Yy5iYWNr
ZW5kID0gQy5DU3RyaW5nKHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4
LkJhY2tlbmRJZCkKKwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZy
b250ZW5kX2lkID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhs
X2RldmlkKHguRGV2aWQpCisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0g
Qy5pbnQoeC5FdnRjaCkKKwl4Yy5ycmVmID0gQy5pbnQoeC5ScmVmKQorCXJldHVybiB4Yywgbmls
Cit9CisKIGZ1bmMgKHggKk51bWFpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9udW1haW5mbykgZXJy
b3IgewogCXguU2l6ZSA9IHVpbnQ2NCh4Yy5zaXplKQogCXguRnJlZSA9IHVpbnQ2NCh4Yy5mcmVl
KQpAQCAtMTMwOCw2ICsyMjExLDEzIEBAIGZ1bmMgKHggKk51bWFpbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF9udW1haW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqTnVtYWlu
Zm8pIHRvQygpICh4YyBDLmxpYnhsX251bWFpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX251
bWFpbmZvX2luaXQoJnhjKQorCXhjLnNpemUgPSBDLnVpbnQ2NF90KHguU2l6ZSkKKwl4Yy5mcmVl
ID0gQy51aW50NjRfdCh4LkZyZWUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqQ3B1
dG9wb2xvZ3kpIGZyb21DKHhjICpDLmxpYnhsX2NwdXRvcG9sb2d5KSBlcnJvciB7CiAJeC5Db3Jl
ID0gdWludDMyKHhjLmNvcmUpCiAJeC5Tb2NrZXQgPSB1aW50MzIoeGMuc29ja2V0KQpAQCAtMTMx
Niw2ICsyMjI2LDE0IEBAIGZ1bmMgKHggKkNwdXRvcG9sb2d5KSBmcm9tQyh4YyAqQy5saWJ4bF9j
cHV0b3BvbG9neSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqQ3B1dG9wb2xv
Z3kpIHRvQygpICh4YyBDLmxpYnhsX2NwdXRvcG9sb2d5LCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhs
X2NwdXRvcG9sb2d5X2luaXQoJnhjKQorCXhjLmNvcmUgPSBDLnVpbnQzMl90KHguQ29yZSkKKwl4
Yy5zb2NrZXQgPSBDLnVpbnQzMl90KHguU29ja2V0KQorCXhjLm5vZGUgPSBDLnVpbnQzMl90KHgu
Tm9kZSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpQY2l0b3BvbG9neSkgZnJvbUMo
eGMgKkMubGlieGxfcGNpdG9wb2xvZ3kpIGVycm9yIHsKIAl4LlNlZyA9IHVpbnQxNih4Yy5zZWcp
CiAJeC5CdXMgPSBieXRlKHhjLmJ1cykKQEAgLTEzMjUsNiArMjI0MywxNSBAQCBmdW5jICh4ICpQ
Y2l0b3BvbG9neSkgZnJvbUMoeGMgKkMubGlieGxfcGNpdG9wb2xvZ3kpIGVycm9yIHsKIAlyZXR1
cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlBjaXRvcG9sb2d5KSB0b0MoKSAoeGMgQy5saWJ4bF9wY2l0
b3BvbG9neSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9wY2l0b3BvbG9neV9pbml0KCZ4YykKKwl4
Yy5zZWcgPSBDLnVpbnQxNl90KHguU2VnKQorCXhjLmJ1cyA9IEMudWludDhfdCh4LkJ1cykKKwl4
Yy5kZXZmbiA9IEMudWludDhfdCh4LkRldmZuKQorCXhjLm5vZGUgPSBDLnVpbnQzMl90KHguTm9k
ZSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykgZnJv
bUMoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtcykgZXJyb3IgewogCXguVHNsaWNlTXMg
PSBpbnQoeGMudHNsaWNlX21zKQogCXguUmF0ZWxpbWl0VXMgPSBpbnQoeGMucmF0ZWxpbWl0X3Vz
KQpAQCAtMTMzMywxMiArMjI2MCwyNiBAQCBmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykgZnJv
bUMoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwK
IH0KIAorZnVuYyAoeCAqU2NoZWRDcmVkaXRQYXJhbXMpIHRvQygpICh4YyBDLmxpYnhsX3NjaGVk
X2NyZWRpdF9wYXJhbXMsIGVyciBlcnJvcikgeworCUMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFt
c19pbml0KCZ4YykKKwl4Yy50c2xpY2VfbXMgPSBDLmludCh4LlRzbGljZU1zKQorCXhjLnJhdGVs
aW1pdF91cyA9IEMuaW50KHguUmF0ZWxpbWl0VXMpCisJeGMudmNwdV9taWdyX2RlbGF5X3VzID0g
Qy5pbnQoeC5WY3B1TWlnckRlbGF5VXMpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAq
U2NoZWRDcmVkaXQyUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFt
cykgZXJyb3IgewogCXguUmF0ZWxpbWl0VXMgPSBpbnQoeGMucmF0ZWxpbWl0X3VzKQogCiAJcmV0
dXJuIG5pbAogfQogCitmdW5jICh4ICpTY2hlZENyZWRpdDJQYXJhbXMpIHRvQygpICh4YyBDLmxp
YnhsX3NjaGVkX2NyZWRpdDJfcGFyYW1zLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3NjaGVkX2Ny
ZWRpdDJfcGFyYW1zX2luaXQoJnhjKQorCXhjLnJhdGVsaW1pdF91cyA9IEMuaW50KHguUmF0ZWxp
bWl0VXMpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluUmVtdXNJbmZvKSBm
cm9tQyh4YyAqQy5saWJ4bF9kb21haW5fcmVtdXNfaW5mbykgZXJyb3IgewogCXguSW50ZXJ2YWwg
PSBpbnQoeGMuaW50ZXJ2YWwpCiAJaWYgZXJyIDo9IHguQWxsb3dVbnNhZmUuZnJvbUMoJnhjLmFs
bG93X3Vuc2FmZSk7IGVyciAhPSBuaWwgewpAQCAtMTM2Nyw2ICsyMzA4LDQ4IEBAIGZ1bmMgKHgg
KkRvbWFpblJlbXVzSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFpblJlbXVzSW5mbykgdG9DKCkg
KHhjIEMubGlieGxfZG9tYWluX3JlbXVzX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfZG9t
YWluX3JlbXVzX2luZm9faW5pdCgmeGMpCisJeGMuaW50ZXJ2YWwgPSBDLmludCh4LkludGVydmFs
KQorCXhjLmFsbG93X3Vuc2FmZSwgZXJyID0geC5BbGxvd1Vuc2FmZS50b0MoKQorCWlmIGVyciAh
PSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1
cm4geGMsIGVycgorCX0KKwl4Yy5ibGFja2hvbGUsIGVyciA9IHguQmxhY2tob2xlLnRvQygpCisJ
aWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgmeGMp
CisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmNvbXByZXNzaW9uLCBlcnIgPSB4LkNvbXByZXNz
aW9uLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3JlbXVzX2luZm9f
ZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLm5ldGJ1ZiwgZXJyID0geC5O
ZXRidWYudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fcmVtdXNfaW5m
b19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMubmV0YnVmc2NyaXB0ID0g
Qy5DU3RyaW5nKHguTmV0YnVmc2NyaXB0KQorCXhjLmRpc2tidWYsIGVyciA9IHguRGlza2J1Zi50
b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2Rpc3Bv
c2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5jb2xvLCBlcnIgPSB4LkNvbG8udG9D
KCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fcmVtdXNfaW5mb19kaXNwb3Nl
KCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMudXNlcnNwYWNlX2NvbG9fcHJveHksIGVy
ciA9IHguVXNlcnNwYWNlQ29sb1Byb3h5LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGli
eGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQor
CXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9l
dmVudCkgZXJyb3IgewogCWlmIGVyciA6PSB4LkxpbmsuZnJvbUMoJnhjLmxpbmspOyBlcnIgIT0g
bmlsIHsKIAkJcmV0dXJuIGVycgpAQCAtMTQzNiw2ICsyNDE5LDIzIEBAIGZ1bmMgKHggKkV2ZW50
VHlwZVVuaW9uT3BlcmF0aW9uQ29tcGxldGUpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJv
ciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpFdmVudCkgdG9DKCkgKHhjIEMubGlieGxf
ZXZlbnQsIGVyciBlcnJvcikgeworCUMubGlieGxfZXZlbnRfaW5pdCgmeGMpCisJeGMubGluaywg
ZXJyID0geC5MaW5rLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZXZlbnRfZGlz
cG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmRvbWlkID0gQy5saWJ4bF9kb21p
ZCh4LkRvbWlkKQorCXhjLmRvbXV1aWQsIGVyciA9IHguRG9tdXVpZC50b0MoKQorCWlmIGVyciAh
PSBuaWwgeworCQlDLmxpYnhsX2V2ZW50X2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy5mb3JfdXNlciA9IEMudWludDY0X3QoeC5Gb3JVc2VyKQorCXJldHVybiB4Yywgbmls
Cit9CisKIGZ1bmMgKHggKlBzckNhdEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9jYXRfaW5m
bykgZXJyb3IgewogCXguSWQgPSB1aW50MzIoeGMuaWQpCiAJeC5Db3NNYXggPSB1aW50MzIoeGMu
Y29zX21heCkKQEAgLTE0NDUsNiArMjQ0NSwxNSBAQCBmdW5jICh4ICpQc3JDYXRJbmZvKSBmcm9t
Qyh4YyAqQy5saWJ4bF9wc3JfY2F0X2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1
bmMgKHggKlBzckNhdEluZm8pIHRvQygpICh4YyBDLmxpYnhsX3Bzcl9jYXRfaW5mbywgZXJyIGVy
cm9yKSB7CisJQy5saWJ4bF9wc3JfY2F0X2luZm9faW5pdCgmeGMpCisJeGMuaWQgPSBDLnVpbnQz
Ml90KHguSWQpCisJeGMuY29zX21heCA9IEMudWludDMyX3QoeC5Db3NNYXgpCisJeGMuY2JtX2xl
biA9IEMudWludDMyX3QoeC5DYm1MZW4pCisJeGMuY2RwX2VuYWJsZWQgPSBDLmJvb2woeC5DZHBF
bmFibGVkKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlBzckh3SW5mbykgZnJvbUMo
eGMgKkMubGlieGxfcHNyX2h3X2luZm8pIGVycm9yIHsKIAl4LklkID0gdWludDMyKHhjLmlkKQog
CXguVHlwZSA9IFBzckZlYXRUeXBlKHhjLl90eXBlKQpAQCAtMTQ5MSwzICsyNTAwLDkgQEAgZnVu
YyAoeCAqUHNySHdJbmZvVHlwZVVuaW9uTWJhKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfaHdfaW5m
bykgZXJyb3IgewogCXguTGluZWFyID0gYm9vbCh0bXAubGluZWFyKQogCXJldHVybiBuaWwKIH0K
KworZnVuYyAoeCAqUHNySHdJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9wc3JfaHdfaW5mbywgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9wc3JfaHdfaW5mb19pbml0KCZ4YykKKwl4Yy5pZCA9IEMudWlu
dDMyX3QoeC5JZCkKKwlyZXR1cm4geGMsIG5pbAorfQotLSAKMi4xNy4xCgoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlz
dApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

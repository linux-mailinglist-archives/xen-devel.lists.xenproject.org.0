Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 71C5F116A43
	for <lists+xen-devel@lfdr.de>; Mon,  9 Dec 2019 10:54:21 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ieFgu-0004Y5-Aa; Mon, 09 Dec 2019 09:50:56 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=3VR8=Z7=redhat.com=philmd@srs-us1.protection.inumbo.net>)
 id 1ieFgt-0004Xe-Ax
 for xen-devel@lists.xenproject.org; Mon, 09 Dec 2019 09:50:55 +0000
X-Inumbo-ID: 638c6703-1a69-11ea-87af-12813bfff9fa
Received: from us-smtp-delivery-1.mimecast.com (unknown [207.211.31.120])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTP
 id 638c6703-1a69-11ea-87af-12813bfff9fa;
 Mon, 09 Dec 2019 09:50:54 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1575885053;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=1vV4BdXxrJs33eazwg4k8OQaJDOeixo6CZUflsfdJpk=;
 b=Wq/ID6ZSCyg3uTZmpe+foqyoU0fnxKlfId2jc+CJePqKBt1PB/ElJYNF0rDscGtkZJP+5Y
 x/OI9Sfddc4gEOdi+D3UC8MfxGgy+VlgD5+PjgJEaRGw0ZF4H3s9W1NdyALMuVAfR+s8Vo
 xoX79Oq0LKQ6nQ5/TWeXlr9UZC6x/YI=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-73-55SXMpbaMIG-zKzwsagGjA-1; Mon, 09 Dec 2019 04:50:52 -0500
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id A8729107ACC4;
 Mon,  9 Dec 2019 09:50:50 +0000 (UTC)
Received: from x1w.redhat.com (ovpn-205-142.brq.redhat.com [10.40.205.142])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id C4BF319C5B;
 Mon,  9 Dec 2019 09:50:45 +0000 (UTC)
From: =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>
To: qemu-devel@nongnu.org
Date: Mon,  9 Dec 2019 10:50:01 +0100
Message-Id: <20191209095002.32194-6-philmd@redhat.com>
In-Reply-To: <20191209095002.32194-1-philmd@redhat.com>
References: <20191209095002.32194-1-philmd@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-MC-Unique: 55SXMpbaMIG-zKzwsagGjA-1
X-Mimecast-Spam-Score: 0
Subject: [Xen-devel] [PATCH-for-5.0 v3 5/6] hw/pci-host/i440fx: Extract the
 IGD passthrough host bridge device
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Thomas Huth <thuth@redhat.com>, Stefano Stabellini <sstabellini@kernel.org>,
 "Michael S. Tsirkin" <mst@redhat.com>, Paul Durrant <paul@xen.org>,
 Markus Armbruster <armbru@redhat.com>,
 Alex Williamson <alex.williamson@redhat.com>,
 Marcel Apfelbaum <marcel.apfelbaum@gmail.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 Anthony Perard <anthony.perard@citrix.com>, xen-devel@lists.xenproject.org,
 =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

V2UgY2FuIHVzZSBhIGk0NDBGWCB3aXRob3V0IHRoZSBJR0QgcGFzc3Rocm91Z2ggaG9zdCBicmlk
Z2UuCkV4dHJhY3QgaXQgaW50byBhIG5ldyBmaWxlLCAnaHcvcGNpLWhvc3QvaWdkX3B0LmMnLgoK
U2lnbmVkLW9mZi1ieTogUGhpbGlwcGUgTWF0aGlldS1EYXVkw6kgPHBoaWxtZEByZWRoYXQuY29t
PgotLS0KdjM6Ci0gUmVuYW1lIGFzICd4ZW5faWdkX3B0LmMnIChBbGV4IFdpbGxpYW1zb24pCi0g
QWRkIGFuIGVudHJ5IGluIE1BSU5UQUlORVJTOjpYZW4KLS0tCiBody9wY2ktaG9zdC9pNDQwZngu
YyAgICAgIHwgIDg0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBody9wY2ktaG9zdC94ZW5f
aWdkX3B0LmMgIHwgMTIwICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBN
QUlOVEFJTkVSUyAgICAgICAgICAgICAgIHwgICAxICsKIGh3L3BjaS1ob3N0L01ha2VmaWxlLm9i
anMgfCAgIDEgKwogNCBmaWxlcyBjaGFuZ2VkLCAxMjIgaW5zZXJ0aW9ucygrKSwgODQgZGVsZXRp
b25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgaHcvcGNpLWhvc3QveGVuX2lnZF9wdC5jCgpkaWZm
IC0tZ2l0IGEvaHcvcGNpLWhvc3QvaTQ0MGZ4LmMgYi9ody9wY2ktaG9zdC9pNDQwZnguYwppbmRl
eCA0MTQxMzg1OTViLi5iYWU3YjQyMzI3IDEwMDY0NAotLS0gYS9ody9wY2ktaG9zdC9pNDQwZngu
YworKysgYi9ody9wY2ktaG9zdC9pNDQwZnguYwpAQCAtMzY4LDg5ICszNjgsNiBAQCBzdGF0aWMg
Y29uc3QgVHlwZUluZm8gaTQ0MGZ4X2luZm8gPSB7CiAgICAgfSwKIH07CiAKLS8qIElHRCBQYXNz
dGhyb3VnaCBIb3N0IEJyaWRnZS4gKi8KLXR5cGVkZWYgc3RydWN0IHsKLSAgICB1aW50OF90IG9m
ZnNldDsKLSAgICB1aW50OF90IGxlbjsKLX0gSUdESG9zdEluZm87Ci0KLS8qIEhlcmUgd2UganVz
dCBleHBvc2UgbWluaW1hbCBob3N0IGJyaWRnZSBvZmZzZXQgc3Vic2V0LiAqLwotc3RhdGljIGNv
bnN0IElHREhvc3RJbmZvIGlnZF9ob3N0X2JyaWRnZV9pbmZvc1tdID0gewotICAgIHtQQ0lfUkVW
SVNJT05fSUQsICAgICAgICAgMn0sCi0gICAge1BDSV9TVUJTWVNURU1fVkVORE9SX0lELCAyfSwK
LSAgICB7UENJX1NVQlNZU1RFTV9JRCwgICAgICAgIDJ9LAotICAgIHsweDUwLCAgICAgICAgICAg
ICAgICAgICAgMn0sIC8qIFNOQjogcHJvY2Vzc29yIGdyYXBoaWNzIGNvbnRyb2wgcmVnaXN0ZXIg
Ki8KLSAgICB7MHg1MiwgICAgICAgICAgICAgICAgICAgIDJ9LCAvKiBwcm9jZXNzb3IgZ3JhcGhp
Y3MgY29udHJvbCByZWdpc3RlciAqLwotICAgIHsweGE0LCAgICAgICAgICAgICAgICAgICAgNH0s
IC8qIFNOQjogZ3JhcGhpY3MgYmFzZSBvZiBzdG9sZW4gbWVtb3J5ICovCi0gICAgezB4YTgsICAg
ICAgICAgICAgICAgICAgICA0fSwgLyogU05COiBiYXNlIG9mIEdUVCBzdG9sZW4gbWVtb3J5ICov
Ci19OwotCi1zdGF0aWMgdm9pZCBob3N0X3BjaV9jb25maWdfcmVhZChpbnQgcG9zLCBpbnQgbGVu
LCB1aW50MzJfdCAqdmFsLCBFcnJvciAqKmVycnApCi17Ci0gICAgaW50IHJjLCBjb25maWdfZmQ7
Ci0gICAgLyogQWNjZXNzIHJlYWwgaG9zdCBicmlkZ2UuICovCi0gICAgY2hhciAqcGF0aCA9IGdf
c3RyZHVwX3ByaW50ZigiL3N5cy9idXMvcGNpL2RldmljZXMvJTA0eDolMDJ4OiUwMnguJWQvJXMi
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgMCwgMCwgMCwgImNvbmZpZyIp
OwotCi0gICAgY29uZmlnX2ZkID0gb3BlbihwYXRoLCBPX1JEV1IpOwotICAgIGlmIChjb25maWdf
ZmQgPCAwKSB7Ci0gICAgICAgIGVycm9yX3NldGdfZXJybm8oZXJycCwgZXJybm8sICJGYWlsZWQg
dG8gb3BlbjogJXMiLCBwYXRoKTsKLSAgICAgICAgZ290byBvdXQ7Ci0gICAgfQotCi0gICAgaWYg
KGxzZWVrKGNvbmZpZ19mZCwgcG9zLCBTRUVLX1NFVCkgIT0gcG9zKSB7Ci0gICAgICAgIGVycm9y
X3NldGdfZXJybm8oZXJycCwgZXJybm8sICJGYWlsZWQgdG8gc2VlazogJXMiLCBwYXRoKTsKLSAg
ICAgICAgZ290byBvdXRfY2xvc2VfZmQ7Ci0gICAgfQotCi0gICAgZG8gewotICAgICAgICByYyA9
IHJlYWQoY29uZmlnX2ZkLCAodWludDhfdCAqKXZhbCwgbGVuKTsKLSAgICB9IHdoaWxlIChyYyA8
IDAgJiYgKGVycm5vID09IEVJTlRSIHx8IGVycm5vID09IEVBR0FJTikpOwotICAgIGlmIChyYyAh
PSBsZW4pIHsKLSAgICAgICAgZXJyb3Jfc2V0Z19lcnJubyhlcnJwLCBlcnJubywgIkZhaWxlZCB0
byByZWFkOiAlcyIsIHBhdGgpOwotICAgIH0KLQotb3V0X2Nsb3NlX2ZkOgotICAgIGNsb3NlKGNv
bmZpZ19mZCk7Ci1vdXQ6Ci0gICAgZ19mcmVlKHBhdGgpOwotfQotCi1zdGF0aWMgdm9pZCBpZ2Rf
cHRfaTQ0MGZ4X3JlYWxpemUoUENJRGV2aWNlICpwY2lfZGV2LCBFcnJvciAqKmVycnApCi17Ci0g
ICAgdWludDMyX3QgdmFsID0gMDsKLSAgICBzaXplX3QgaTsKLSAgICBpbnQgcG9zLCBsZW47Ci0g
ICAgRXJyb3IgKmxvY2FsX2VyciA9IE5VTEw7Ci0KLSAgICBmb3IgKGkgPSAwOyBpIDwgQVJSQVlf
U0laRShpZ2RfaG9zdF9icmlkZ2VfaW5mb3MpOyBpKyspIHsKLSAgICAgICAgcG9zID0gaWdkX2hv
c3RfYnJpZGdlX2luZm9zW2ldLm9mZnNldDsKLSAgICAgICAgbGVuID0gaWdkX2hvc3RfYnJpZGdl
X2luZm9zW2ldLmxlbjsKLSAgICAgICAgaG9zdF9wY2lfY29uZmlnX3JlYWQocG9zLCBsZW4sICZ2
YWwsICZsb2NhbF9lcnIpOwotICAgICAgICBpZiAobG9jYWxfZXJyKSB7Ci0gICAgICAgICAgICBl
cnJvcl9wcm9wYWdhdGUoZXJycCwgbG9jYWxfZXJyKTsKLSAgICAgICAgICAgIHJldHVybjsKLSAg
ICAgICAgfQotICAgICAgICBwY2lfZGVmYXVsdF93cml0ZV9jb25maWcocGNpX2RldiwgcG9zLCB2
YWwsIGxlbik7Ci0gICAgfQotfQotCi1zdGF0aWMgdm9pZCBpZ2RfcGFzc3Rocm91Z2hfaTQ0MGZ4
X2NsYXNzX2luaXQoT2JqZWN0Q2xhc3MgKmtsYXNzLCB2b2lkICpkYXRhKQotewotICAgIERldmlj
ZUNsYXNzICpkYyA9IERFVklDRV9DTEFTUyhrbGFzcyk7Ci0gICAgUENJRGV2aWNlQ2xhc3MgKmsg
PSBQQ0lfREVWSUNFX0NMQVNTKGtsYXNzKTsKLQotICAgIGstPnJlYWxpemUgPSBpZ2RfcHRfaTQ0
MGZ4X3JlYWxpemU7Ci0gICAgZGMtPmRlc2MgPSAiSUdEIFBhc3N0aHJvdWdoIEhvc3QgYnJpZGdl
IjsKLX0KLQotc3RhdGljIGNvbnN0IFR5cGVJbmZvIGlnZF9wYXNzdGhyb3VnaF9pNDQwZnhfaW5m
byA9IHsKLSAgICAubmFtZSAgICAgICAgICA9IFRZUEVfSUdEX1BBU1NUSFJPVUdIX0k0NDBGWF9Q
Q0lfREVWSUNFLAotICAgIC5wYXJlbnQgICAgICAgID0gVFlQRV9JNDQwRlhfUENJX0RFVklDRSwK
LSAgICAuaW5zdGFuY2Vfc2l6ZSA9IHNpemVvZihQQ0lJNDQwRlhTdGF0ZSksCi0gICAgLmNsYXNz
X2luaXQgICAgPSBpZ2RfcGFzc3Rocm91Z2hfaTQ0MGZ4X2NsYXNzX2luaXQsCi19OwotCiBzdGF0
aWMgY29uc3QgY2hhciAqaTQ0MGZ4X3BjaWhvc3Rfcm9vdF9idXNfcGF0aChQQ0lIb3N0U3RhdGUg
Kmhvc3RfYnJpZGdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgUENJQnVzICpyb290YnVzKQogewpAQCAtNDk1LDcgKzQxMiw2IEBAIHN0YXRpYyBjb25z
dCBUeXBlSW5mbyBpNDQwZnhfcGNpaG9zdF9pbmZvID0gewogc3RhdGljIHZvaWQgaTQ0MGZ4X3Jl
Z2lzdGVyX3R5cGVzKHZvaWQpCiB7CiAgICAgdHlwZV9yZWdpc3Rlcl9zdGF0aWMoJmk0NDBmeF9p
bmZvKTsKLSAgICB0eXBlX3JlZ2lzdGVyX3N0YXRpYygmaWdkX3Bhc3N0aHJvdWdoX2k0NDBmeF9p
bmZvKTsKICAgICB0eXBlX3JlZ2lzdGVyX3N0YXRpYygmaTQ0MGZ4X3BjaWhvc3RfaW5mbyk7CiB9
CiAKZGlmZiAtLWdpdCBhL2h3L3BjaS1ob3N0L3hlbl9pZ2RfcHQuYyBiL2h3L3BjaS1ob3N0L3hl
bl9pZ2RfcHQuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi5lZmNjOTM0
N2ZmCi0tLSAvZGV2L251bGwKKysrIGIvaHcvcGNpLWhvc3QveGVuX2lnZF9wdC5jCkBAIC0wLDAg
KzEsMTIwIEBACisvKgorICogUUVNVSBJbnRlbCBJR0QgUGFzc3Rocm91Z2ggSG9zdCBCcmlkZ2Ug
RW11bGF0aW9uCisgKgorICogQ29weXJpZ2h0IChjKSAyMDA2IEZhYnJpY2UgQmVsbGFyZAorICoK
KyAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQKKyAqCisgKiBQZXJtaXNzaW9uIGlzIGhl
cmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBj
b3B5CisgKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmls
ZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAorICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQg
cmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cworICog
dG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNl
bnNlLCBhbmQvb3Igc2VsbAorICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1p
dCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCisgKiBmdXJuaXNoZWQgdG8gZG8gc28s
IHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgorICoKKyAqIFRoZSBhYm92ZSBj
b3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1
ZGVkIGluCisgKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0
d2FyZS4KKyAqCisgKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBX
QVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgorICogSU1QTElFRCwgSU5DTFVESU5HIEJV
VCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCisgKiBG
SVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBO
TyBFVkVOVCBTSEFMTAorICogVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElB
QkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKKyAqIExJQUJJTElUWSwgV0hFVEhF
UiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZS
T00sCisgKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUg
VVNFIE9SIE9USEVSIERFQUxJTkdTIElOCisgKiBUSEUgU09GVFdBUkUuCisgKi8KKworI2luY2x1
ZGUgInFlbXUvb3NkZXAuaCIKKyNpbmNsdWRlICJody9wY2kvcGNpLmgiCisjaW5jbHVkZSAiaHcv
cGNpL3BjaV9ob3N0LmgiCisjaW5jbHVkZSAiaHcvcGNpLWhvc3QvaTQ0MGZ4LmgiCisjaW5jbHVk
ZSAicWFwaS9lcnJvci5oIgorCit0eXBlZGVmIHN0cnVjdCB7CisgICAgdWludDhfdCBvZmZzZXQ7
CisgICAgdWludDhfdCBsZW47Cit9IElHREhvc3RJbmZvOworCisvKiBIZXJlIHdlIGp1c3QgZXhw
b3NlIG1pbmltYWwgaG9zdCBicmlkZ2Ugb2Zmc2V0IHN1YnNldC4gKi8KK3N0YXRpYyBjb25zdCBJ
R0RIb3N0SW5mbyBpZ2RfaG9zdF9icmlkZ2VfaW5mb3NbXSA9IHsKKyAgICB7UENJX1JFVklTSU9O
X0lELCAgICAgICAgIDJ9LAorICAgIHtQQ0lfU1VCU1lTVEVNX1ZFTkRPUl9JRCwgMn0sCisgICAg
e1BDSV9TVUJTWVNURU1fSUQsICAgICAgICAyfSwKKyAgICB7MHg1MCwgICAgICAgICAgICAgICAg
ICAgIDJ9LCAvKiBTTkI6IHByb2Nlc3NvciBncmFwaGljcyBjb250cm9sIHJlZ2lzdGVyICovCisg
ICAgezB4NTIsICAgICAgICAgICAgICAgICAgICAyfSwgLyogcHJvY2Vzc29yIGdyYXBoaWNzIGNv
bnRyb2wgcmVnaXN0ZXIgKi8KKyAgICB7MHhhNCwgICAgICAgICAgICAgICAgICAgIDR9LCAvKiBT
TkI6IGdyYXBoaWNzIGJhc2Ugb2Ygc3RvbGVuIG1lbW9yeSAqLworICAgIHsweGE4LCAgICAgICAg
ICAgICAgICAgICAgNH0sIC8qIFNOQjogYmFzZSBvZiBHVFQgc3RvbGVuIG1lbW9yeSAqLworfTsK
Kworc3RhdGljIHZvaWQgaG9zdF9wY2lfY29uZmlnX3JlYWQoaW50IHBvcywgaW50IGxlbiwgdWlu
dDMyX3QgKnZhbCwgRXJyb3IgKiplcnJwKQoreworICAgIGludCByYywgY29uZmlnX2ZkOworICAg
IC8qIEFjY2VzcyByZWFsIGhvc3QgYnJpZGdlLiAqLworICAgIGNoYXIgKnBhdGggPSBnX3N0cmR1
cF9wcmludGYoIi9zeXMvYnVzL3BjaS9kZXZpY2VzLyUwNHg6JTAyeDolMDJ4LiVkLyVzIiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsIDAsIDAsIDAsICJjb25maWciKTsKKwor
ICAgIGNvbmZpZ19mZCA9IG9wZW4ocGF0aCwgT19SRFdSKTsKKyAgICBpZiAoY29uZmlnX2ZkIDwg
MCkgeworICAgICAgICBlcnJvcl9zZXRnX2Vycm5vKGVycnAsIGVycm5vLCAiRmFpbGVkIHRvIG9w
ZW46ICVzIiwgcGF0aCk7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAgIGlmIChsc2Vl
ayhjb25maWdfZmQsIHBvcywgU0VFS19TRVQpICE9IHBvcykgeworICAgICAgICBlcnJvcl9zZXRn
X2Vycm5vKGVycnAsIGVycm5vLCAiRmFpbGVkIHRvIHNlZWs6ICVzIiwgcGF0aCk7CisgICAgICAg
IGdvdG8gb3V0X2Nsb3NlX2ZkOworICAgIH0KKworICAgIGRvIHsKKyAgICAgICAgcmMgPSByZWFk
KGNvbmZpZ19mZCwgKHVpbnQ4X3QgKil2YWwsIGxlbik7CisgICAgfSB3aGlsZSAocmMgPCAwICYm
IChlcnJubyA9PSBFSU5UUiB8fCBlcnJubyA9PSBFQUdBSU4pKTsKKyAgICBpZiAocmMgIT0gbGVu
KSB7CisgICAgICAgIGVycm9yX3NldGdfZXJybm8oZXJycCwgZXJybm8sICJGYWlsZWQgdG8gcmVh
ZDogJXMiLCBwYXRoKTsKKyAgICB9CisKKyBvdXRfY2xvc2VfZmQ6CisgICAgY2xvc2UoY29uZmln
X2ZkKTsKKyBvdXQ6CisgICAgZ19mcmVlKHBhdGgpOworfQorCitzdGF0aWMgdm9pZCBpZ2RfcHRf
aTQ0MGZ4X3JlYWxpemUoUENJRGV2aWNlICpwY2lfZGV2LCBFcnJvciAqKmVycnApCit7CisgICAg
dWludDMyX3QgdmFsID0gMDsKKyAgICBzaXplX3QgaTsKKyAgICBpbnQgcG9zLCBsZW47CisgICAg
RXJyb3IgKmxvY2FsX2VyciA9IE5VTEw7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0la
RShpZ2RfaG9zdF9icmlkZ2VfaW5mb3MpOyBpKyspIHsKKyAgICAgICAgcG9zID0gaWdkX2hvc3Rf
YnJpZGdlX2luZm9zW2ldLm9mZnNldDsKKyAgICAgICAgbGVuID0gaWdkX2hvc3RfYnJpZGdlX2lu
Zm9zW2ldLmxlbjsKKyAgICAgICAgaG9zdF9wY2lfY29uZmlnX3JlYWQocG9zLCBsZW4sICZ2YWws
ICZsb2NhbF9lcnIpOworICAgICAgICBpZiAobG9jYWxfZXJyKSB7CisgICAgICAgICAgICBlcnJv
cl9wcm9wYWdhdGUoZXJycCwgbG9jYWxfZXJyKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAg
ICAgfQorICAgICAgICBwY2lfZGVmYXVsdF93cml0ZV9jb25maWcocGNpX2RldiwgcG9zLCB2YWws
IGxlbik7CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBpZ2RfcGFzc3Rocm91Z2hfaTQ0MGZ4X2Ns
YXNzX2luaXQoT2JqZWN0Q2xhc3MgKmtsYXNzLCB2b2lkICpkYXRhKQoreworICAgIERldmljZUNs
YXNzICpkYyA9IERFVklDRV9DTEFTUyhrbGFzcyk7CisgICAgUENJRGV2aWNlQ2xhc3MgKmsgPSBQ
Q0lfREVWSUNFX0NMQVNTKGtsYXNzKTsKKworICAgIGstPnJlYWxpemUgPSBpZ2RfcHRfaTQ0MGZ4
X3JlYWxpemU7CisgICAgZGMtPmRlc2MgPSAiSUdEIFBhc3N0aHJvdWdoIEhvc3QgYnJpZGdlIjsK
K30KKworc3RhdGljIGNvbnN0IFR5cGVJbmZvIGlnZF9wYXNzdGhyb3VnaF9pNDQwZnhfaW5mbyA9
IHsKKyAgICAubmFtZSAgICAgICAgICA9IFRZUEVfSUdEX1BBU1NUSFJPVUdIX0k0NDBGWF9QQ0lf
REVWSUNFLAorICAgIC5wYXJlbnQgICAgICAgID0gVFlQRV9JNDQwRlhfUENJX0RFVklDRSwKKyAg
ICAuaW5zdGFuY2Vfc2l6ZSA9IHNpemVvZihQQ0lJNDQwRlhTdGF0ZSksCisgICAgLmNsYXNzX2lu
aXQgICAgPSBpZ2RfcGFzc3Rocm91Z2hfaTQ0MGZ4X2NsYXNzX2luaXQsCit9OworCitzdGF0aWMg
dm9pZCBpZ2RfcHRfaTQ0MGZ4X3JlZ2lzdGVyX3R5cGVzKHZvaWQpCit7CisgICAgdHlwZV9yZWdp
c3Rlcl9zdGF0aWMoJmlnZF9wYXNzdGhyb3VnaF9pNDQwZnhfaW5mbyk7Cit9CisKK3R5cGVfaW5p
dChpZ2RfcHRfaTQ0MGZ4X3JlZ2lzdGVyX3R5cGVzKQpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMg
Yi9NQUlOVEFJTkVSUwppbmRleCA1ZTVlM2U1MmQ2Li42MmJjZjVlOTRlIDEwMDY0NAotLS0gYS9N
QUlOVEFJTkVSUworKysgYi9NQUlOVEFJTkVSUwpAQCAtNDE5LDYgKzQxOSw3IEBAIEY6IGh3L2Js
b2NrL2RhdGFwbGFuZS94ZW4qCiBGOiBody94ZW4vCiBGOiBody94ZW5wdi8KIEY6IGh3L2kzODYv
eGVuLworRjogaHcvcGNpLWhvc3QveGVuX2lnZF9wdC5jCiBGOiBpbmNsdWRlL2h3L2Jsb2NrL2Rh
dGFwbGFuZS94ZW4qCiBGOiBpbmNsdWRlL2h3L3hlbi8KIEY6IGluY2x1ZGUvc3lzZW11L3hlbi1t
YXBjYWNoZS5oCmRpZmYgLS1naXQgYS9ody9wY2ktaG9zdC9NYWtlZmlsZS5vYmpzIGIvaHcvcGNp
LWhvc3QvTWFrZWZpbGUub2JqcwppbmRleCBlZmQ3NTJiNzY2Li5mYTZkMTU1NmMwIDEwMDY0NAot
LS0gYS9ody9wY2ktaG9zdC9NYWtlZmlsZS5vYmpzCisrKyBiL2h3L3BjaS1ob3N0L01ha2VmaWxl
Lm9ianMKQEAgLTE0LDYgKzE0LDcgQEAgY29tbW9uLW9iai0kKENPTkZJR19WRVJTQVRJTEVfUENJ
KSArPSB2ZXJzYXRpbGUubwogY29tbW9uLW9iai0kKENPTkZJR19QQ0lfU0FCUkUpICs9IHNhYnJl
Lm8KIGNvbW1vbi1vYmotJChDT05GSUdfRlVMT05HKSArPSBib25pdG8ubwogY29tbW9uLW9iai0k
KENPTkZJR19QQ0lfSTQ0MEZYKSArPSBpNDQwZngubworY29tbW9uLW9iai0kKENPTkZJR19QQ0lf
STQ0MEZYKSArPSB4ZW5faWdkX3B0Lm8KIGNvbW1vbi1vYmotJChDT05GSUdfUENJX0VYUFJFU1Nf
UTM1KSArPSBxMzUubwogY29tbW9uLW9iai0kKENPTkZJR19QQ0lfRVhQUkVTU19HRU5FUklDX0JS
SURHRSkgKz0gZ3BleC5vCiBjb21tb24tb2JqLSQoQ09ORklHX1BDSV9FWFBSRVNTX1hJTElOWCkg
Kz0geGlsaW54LXBjaWUubwotLSAKMi4yMS4wCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlz
dHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3hlbi1kZXZlbA==

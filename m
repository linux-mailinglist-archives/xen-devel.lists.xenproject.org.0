Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4DA63140D0E
	for <lists+xen-devel@lfdr.de>; Fri, 17 Jan 2020 15:50:46 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1isSuv-0003mC-Q2; Fri, 17 Jan 2020 14:48:09 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=zPxh=3G=citrix.com=ian.jackson@srs-us1.protection.inumbo.net>)
 id 1isSut-0003kU-Mi
 for xen-devel@lists.xenproject.org; Fri, 17 Jan 2020 14:48:07 +0000
X-Inumbo-ID: 516867e0-3938-11ea-b833-bc764e2007e4
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 516867e0-3938-11ea-b833-bc764e2007e4;
 Fri, 17 Jan 2020 14:47:43 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1579272463;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=4/MmfM4vKbmx1eoLotZ8civNAsmhUcG90E0O2rb8Wy8=;
 b=a5jeu5x1/SIaQkpd5BZfMaAPbScY8w9/mMGgSauXi4x/Z9ftEYY+CMlF
 rA5GYhjif8i0P+J2zLFdc4NHmMoexx6Nne/ZR9MW1Wwfp/n1et1m1GgGx
 YEpZ7a0WgUtDEcTt6G/Jo7hzXoJ8roaIur5CoxzOUgNXegdFSPjJyUgyb A=;
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=ian.jackson@eu.citrix.com;
 spf=Pass smtp.mailfrom=Ian.Jackson@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 ian.jackson@eu.citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="Ian.Jackson@citrix.com";
 x-sender="ian.jackson@eu.citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa4.hc3370-68.iphmx.com: domain of
 Ian.Jackson@citrix.com designates 162.221.158.21 as permitted
 sender) identity=mailfrom; client-ip=162.221.158.21;
 receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="Ian.Jackson@citrix.com";
 x-sender="Ian.Jackson@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="Ian.Jackson@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: ueDYeXBwfSACPJ5XGtfrkmk60xr5GJTScuuqde28eEsygS39qx4sulFCMBNDymNO1csEmiYZml
 9U+xGHmrSHGlQ1dkAxUVmocBEZ+mGCaPwKoVW8gOXZNreEy4PmkRoDmsQHamioajLKpN1C3Qgq
 0rcuO4X5VzJ8fD6fdGgpB2iHBIzcwVWwz4S+0tzqGYRdlUvJDwYPDcQtDuLKHlRt4DgDU9ha1y
 d689PTMbHYzRZrdLNI2TdL20qGMcZAlHJX77HzScMa51o9394U4CFWPqjVzMNE5Ws3X4tN0E5E
 cL4=
X-SBRS: 2.7
X-MesageID: 11669887
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.70,330,1574139600"; d="scan'208";a="11669887"
From: Ian Jackson <ian.jackson@eu.citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Fri, 17 Jan 2020 14:47:20 +0000
Message-ID: <20200117144726.582-5-ian.jackson@eu.citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20200117144726.582-1-ian.jackson@eu.citrix.com>
References: <20200117144726.582-1-ian.jackson@eu.citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 04/10] libxl: event: Make
 LIBXL__EVENT_DISASTER take a gc, not an egc
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

V2UgYXJlIGdvaW5nIHRvIHdhbnQgdG8gY2hhbmdlIGxpYnhsX19wb2xsZXJfd2FrZXVwIHRvIHRh
a2UgYSBnYy4KCkluIHRoZW9yeSB0aGVyZSBpcyBhIHJpc2sgaGVyZSB0aGF0IGl0IHdvdWxkIGJl
IGNhbGxlZCBpbmFwcHJvcHJpYXRlbHkKaW4gYSBmdXR1cmUgcGF0Y2ggYnV0IHRoaXMgc2VlbXMg
dW5saWtlbHkuCgpTaWduZWQtb2ZmLWJ5OiBJYW4gSmFja3NvbiA8aWFuLmphY2tzb25AZXUuY2l0
cml4LmNvbT4KVGVzdGVkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5j
b20+ClJldmlld2VkLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
Ci0tLQp2MjogTmV3IHBhdGNoCi0tLQogdG9vbHMvbGlieGwvbGlieGxfYW91dGlscy5jICB8ICAy
ICstCiB0b29scy9saWJ4bC9saWJ4bF9kaXNrLmMgICAgIHwgIDQgKystLQogdG9vbHMvbGlieGwv
bGlieGxfZG9tYWluLmMgICB8ICAyICstCiB0b29scy9saWJ4bC9saWJ4bF9ldmVudC5jICAgIHwg
MjEgKysrKysrKysrKy0tLS0tLS0tLS0tCiB0b29scy9saWJ4bC9saWJ4bF9mb3JrLmMgICAgIHwg
MTEgKysrKysrLS0tLS0KIHRvb2xzL2xpYnhsL2xpYnhsX2ludGVybmFsLmggfCAxMCArKysrKy0t
LS0tCiA2IGZpbGVzIGNoYW5nZWQsIDI1IGluc2VydGlvbnMoKyksIDI1IGRlbGV0aW9ucygtKQoK
ZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xpYnhsX2FvdXRpbHMuYyBiL3Rvb2xzL2xpYnhsL2xp
YnhsX2FvdXRpbHMuYwppbmRleCBlMjRlNGVlZDUzLi4xYmU4NThjOTNjIDEwMDY0NAotLS0gYS90
b29scy9saWJ4bC9saWJ4bF9hb3V0aWxzLmMKKysrIGIvdG9vbHMvbGlieGwvbGlieGxfYW91dGls
cy5jCkBAIC0yODIsNyArMjgyLDcgQEAgc3RhdGljIHZvaWQgZGF0YWNvcGllcl9yZWFkYWJsZShs
aWJ4bF9fZWdjICplZ2MsIGxpYnhsX19ldl9mZCAqZXYsCiAgICAgICAgICAgICAgICAgaHVwY2hr
LnJldmVudHMgPSAwOwogICAgICAgICAgICAgICAgIHIgPSBwb2xsKCZodXBjaGssIDEsIDApOwog
ICAgICAgICAgICAgICAgIGlmIChyIDwgMCkKLSAgICAgICAgICAgICAgICAgICAgTElCWExfX0VW
RU5UX0RJU0FTVEVSKGVnYywKKyAgICAgICAgICAgICAgICAgICAgTElCWExfX0VWRU5UX0RJU0FT
VEVSKGdjLAogICAgICAidW5leHBlY3RlZCBmYWlsdXJlIHBvbGxpbmcgZmQgZm9yIGRhdGFjb3Bp
ZXIgZW9mIGh1cCBjaGVjayIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJy
bm8sIDApOwogICAgICAgICAgICAgICAgIGlmIChkYXRhY29waWVyX3BvbGxodXBfaGFuZGxlZChl
Z2MsIGRjLCBmZCwgaHVwY2hrLnJldmVudHMsIDApKQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwv
bGlieGxfZGlzay5jIGIvdG9vbHMvbGlieGwvbGlieGxfZGlzay5jCmluZGV4IDY0YTY2OTE0MjQu
LmE0NjMzMzQxMzAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhsX2Rpc2suYworKysgYi90
b29scy9saWJ4bC9saWJ4bF9kaXNrLmMKQEAgLTMzLDcgKzMzLDcgQEAgc3RhdGljIHZvaWQgZGlz
a19lamVjdF94c3dhdGNoX2NhbGxiYWNrKGxpYnhsX19lZ2MgKmVnYywgbGlieGxfX2V2X3hzd2F0
Y2ggKncsCiAgICAgICAgIHJldHVybjsKIAogICAgIGlmIChsaWJ4bF9feHNfcHJpbnRmKGdjLCBY
QlRfTlVMTCwgd3BhdGgsICIiKSkgewotICAgICAgICBMSUJYTF9fRVZFTlRfRElTQVNURVIoZWdj
LCAieHNfd3JpdGUgZmFpbGVkIGFja25vd2xlZGdpbmcgZWplY3QiLAorICAgICAgICBMSUJYTF9f
RVZFTlRfRElTQVNURVIoZ2MsICJ4c193cml0ZSBmYWlsZWQgYWNrbm93bGVkZ2luZyBlamVjdCIs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJubywgTElCWExfRVZFTlRfVFlQRV9E
SVNLX0VKRUNUKTsKICAgICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTQzLDcgKzQzLDcgQEAgc3Rh
dGljIHZvaWQgZGlza19lamVjdF94c3dhdGNoX2NhbGxiYWNrKGxpYnhsX19lZ2MgKmVnYywgbGli
eGxfX2V2X3hzd2F0Y2ggKncsCiAKICAgICByYyA9IGxpYnhsX194c19yZWFkX2NoZWNrZWQoZ2Ms
IFhCVF9OVUxMLCBldmctPmJlX3B0cl9wYXRoLCAmYmFja2VuZCk7CiAgICAgaWYgKHJjKSB7Ci0g
ICAgICAgIExJQlhMX19FVkVOVF9ESVNBU1RFUihlZ2MsICJ4c19yZWFkIGZhaWxlZCByZWFkaW5n
IGJlX3B0cl9wYXRoIiwKKyAgICAgICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGdjLCAieHNfcmVh
ZCBmYWlsZWQgcmVhZGluZyBiZV9wdHJfcGF0aCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBlcnJubywgTElCWExfRVZFTlRfVFlQRV9ESVNLX0VKRUNUKTsKICAgICAgICAgcmV0dXJu
OwogICAgIH0KZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xpYnhsX2RvbWFpbi5jIGIvdG9vbHMv
bGlieGwvbGlieGxfZG9tYWluLmMKaW5kZXggNTcxNDUwMTc3OC4uYjU5Y2M2NTc1MCAxMDA2NDQK
LS0tIGEvdG9vbHMvbGlieGwvbGlieGxfZG9tYWluLmMKKysrIGIvdG9vbHMvbGlieGwvbGlieGxf
ZG9tYWluLmMKQEAgLTg5Miw3ICs4OTIsNyBAQCBzdGF0aWMgdm9pZCBkb21haW5fZGVhdGhfeHN3
YXRjaF9jYWxsYmFjayhsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX19ldl94c3dhdGNoICp3LAogCiAg
ICAgICAgIHJjID0geGNfZG9tYWluX2dldGluZm9saXN0KENUWC0+eGNoLCBldmctPmRvbWlkLCBu
ZW50cmllcywgZG9tYWluaW5mb3MpOwogICAgICAgICBpZiAocmMgPT0gLTEpIHsKLSAgICAgICAg
ICAgIExJQlhMX19FVkVOVF9ESVNBU1RFUihlZ2MsICJ4Y19kb21haW5fZ2V0aW5mb2xpc3QgZmFp
bGVkIHdoaWxlIgorICAgICAgICAgICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGdjLCAieGNfZG9t
YWluX2dldGluZm9saXN0IGZhaWxlZCB3aGlsZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAiIHByb2Nlc3NpbmcgQHJlbGVhc2VEb21haW4gd2F0Y2ggZXZlbnQiLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm5vLCAwKTsKICAgICAgICAgICAgIGdvdG8g
b3V0OwpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGxfZXZlbnQuYyBiL3Rvb2xzL2xpYnhs
L2xpYnhsX2V2ZW50LmMKaW5kZXggYmUzN2UxMmJiMC4uMTZlNjc4Njg4OSAxMDA2NDQKLS0tIGEv
dG9vbHMvbGlieGwvbGlieGxfZXZlbnQuYworKysgYi90b29scy9saWJ4bC9saWJ4bF9ldmVudC5j
CkBAIC0yNjEsNyArMjYxLDcgQEAgc2hvcnQgbGlieGxfX2ZkX3BvbGxfcmVjaGVjayhsaWJ4bF9f
ZWdjICplZ2MsIGludCBmZCwgc2hvcnQgZXZlbnRzKSB7CiAgICAgICAgICAgICBicmVhazsKICAg
ICAgICAgYXNzZXJ0KHI8MCk7CiAgICAgICAgIGlmIChlcnJubyAhPSBFSU5UUikgewotICAgICAg
ICAgICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGVnYywgImZhaWxlZCBwb2xsIHRvIGNoZWNrIGZv
ciBmZCIsIGVycm5vLCAwKTsKKyAgICAgICAgICAgIExJQlhMX19FVkVOVF9ESVNBU1RFUihnYywg
ImZhaWxlZCBwb2xsIHRvIGNoZWNrIGZvciBmZCIsIGVycm5vLCAwKTsKICAgICAgICAgICAgIHJl
dHVybiAwOwogICAgICAgICB9CiAgICAgfQpAQCAtNTA5LDE0ICs1MDksMTQgQEAgc3RhdGljIHZv
aWQgd2F0Y2hmZF9jYWxsYmFjayhsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX19ldl9mZCAqZXYsCiAg
ICAgRUdDX0dDOwogCiAgICAgaWYgKHJldmVudHMgJiAoUE9MTEVSUnxQT0xMSFVQKSkKLSAgICAg
ICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGVnYywgInVuZXhwZWN0ZWQgcG9sbCBldmVudCBvbiB3
YXRjaCBmZCIsIDAsIDApOworICAgICAgICBMSUJYTF9fRVZFTlRfRElTQVNURVIoZ2MsICJ1bmV4
cGVjdGVkIHBvbGwgZXZlbnQgb24gd2F0Y2ggZmQiLCAwLCAwKTsKIAogICAgIGZvciAoOzspIHsK
ICAgICAgICAgY2hhciAqKmV2ZW50ID0geHNfY2hlY2tfd2F0Y2goQ1RYLT54c2gpOwogICAgICAg
ICBpZiAoIWV2ZW50KSB7CiAgICAgICAgICAgICBpZiAoZXJybm8gPT0gRUFHQUlOKSBicmVhazsK
ICAgICAgICAgICAgIGlmIChlcnJubyA9PSBFSU5UUikgY29udGludWU7Ci0gICAgICAgICAgICBM
SUJYTF9fRVZFTlRfRElTQVNURVIoZWdjLCAiY2Fubm90IGNoZWNrL3JlYWQgd2F0Y2hlcyIsIGVy
cm5vLCAwKTsKKyAgICAgICAgICAgIExJQlhMX19FVkVOVF9ESVNBU1RFUihnYywgImNhbm5vdCBj
aGVjay9yZWFkIHdhdGNoZXMiLCBlcnJubywgMCk7CiAgICAgICAgICAgICByZXR1cm47CiAgICAg
ICAgIH0KIApAQCAtNzA1LDcgKzcwNSw3IEBAIHN0YXRpYyBpbnQgZXZ0Y2huX3JldmVudHNfY2hl
Y2sobGlieGxfX2VnYyAqZWdjLCBpbnQgcmV2ZW50cykKIAogICAgIGlmIChyZXZlbnRzICYgflBP
TExJTikgewogICAgICAgICBMT0coRVJST1IsICJ1bmV4cGVjdGVkIHBvbGwgZXZlbnQgb24gZXZl
bnQgY2hhbm5lbCBmZDogJXgiLCByZXZlbnRzKTsKLSAgICAgICAgTElCWExfX0VWRU5UX0RJU0FT
VEVSKGVnYywKKyAgICAgICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGdjLAogICAgICAgICAgICAg
ICAgICAgICJ1bmV4cGVjdGVkIHBvbGwgZXZlbnQgb24gZXZlbnQgY2hhbm5lbCBmZCIsIDAsIDAp
OwogICAgICAgICBsaWJ4bF9fZXZfZmRfZGVyZWdpc3RlcihnYywgJkNUWC0+ZXZ0Y2huX2VmZCk7
CiAgICAgICAgIHJldHVybiBFUlJPUl9GQUlMOwpAQCAtNzQ2LDcgKzc0Niw3IEBAIHN0YXRpYyB2
b2lkIGV2dGNobl9mZF9jYWxsYmFjayhsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX19ldl9mZCAqZXYs
CiAgICAgICAgIGlmIChwb3J0IDwgMCkgewogICAgICAgICAgICAgaWYgKGVycm5vID09IEVBR0FJ
TikKICAgICAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgICAgIExJQlhMX19FVkVOVF9ESVNB
U1RFUihlZ2MsCisgICAgICAgICAgICBMSUJYTF9fRVZFTlRfRElTQVNURVIoZ2MsCiAgICAgICJ1
bmV4cGVjdGVkIGZhaWx1cmUgZmV0Y2hpbmcgb2NjdXJyaW5nIGV2ZW50IHBvcnQgbnVtYmVyIGZy
b20gZXZ0Y2huIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJubywgMCk7
CiAgICAgICAgICAgICByZXR1cm47CkBAIC05NjYsNyArOTY2LDcgQEAgc3RhdGljIHZvaWQgZG9t
YWluZGVhdGhjaGVja19jYWxsYmFjayhsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX19ldl94c3dhdGNo
ICp3LAogICAgIGxpYnhsX19kb21haW5kZWF0aGNoZWNrX3N0b3AoZ2MsZGMpOwogCiAgICAgaWYg
KGVycm5vIT1FTk9FTlQpIHsKLSAgICAgICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGVnYywiZmFp
bGVkIHRvIHJlYWQgeGVuc3RvcmUiCisgICAgICAgIExJQlhMX19FVkVOVF9ESVNBU1RFUihnYywi
ZmFpbGVkIHRvIHJlYWQgeGVuc3RvcmUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi
IGZvciBkb21haW4gZGV0YWNoIGNoZWNrIiwgZXJybm8sIDApOwogICAgICAgICByZXR1cm47CiAg
ICAgfQpAQCAtMTI3OSw3ICsxMjc5LDcgQEAgc3RhdGljIHZvaWQgYWZ0ZXJwb2xsX2ludGVybmFs
KGxpYnhsX19lZ2MgKmVnYywgbGlieGxfX3BvbGxlciAqcG9sbGVyLAogCiAgICAgaWYgKGFmdGVy
cG9sbF9jaGVja19mZChwb2xsZXIsZmRzLG5mZHMsIHBvbGxlci0+d2FrZXVwX3BpcGVbMF0sUE9M
TElOKSkgewogICAgICAgICBpbnQgZSA9IGxpYnhsX19zZWxmX3BpcGVfZWF0YWxsKHBvbGxlci0+
d2FrZXVwX3BpcGVbMF0pOwotICAgICAgICBpZiAoZSkgTElCWExfX0VWRU5UX0RJU0FTVEVSKGVn
YywgInJlYWQgd2FrZXVwIiwgZSwgMCk7CisgICAgICAgIGlmIChlKSBMSUJYTF9fRVZFTlRfRElT
QVNURVIoZ2MsICJyZWFkIHdha2V1cCIsIGUsIDApOwogICAgIH0KIAogICAgIGZvciAoOzspIHsK
QEAgLTEzNjUsMTIgKzEzNjUsMTAgQEAgdm9pZCBsaWJ4bF9vc2V2ZW50X29jY3VycmVkX3RpbWVv
dXQobGlieGxfY3R4ICpjdHgsIHZvaWQgKmZvcl9saWJ4bCkKICAgICBDVFhfVU5MT0NLX0VHQ19G
UkVFOwogfQogCi12b2lkIGxpYnhsX19ldmVudF9kaXNhc3RlcihsaWJ4bF9fZWdjICplZ2MsIGNv
bnN0IGNoYXIgKm1zZywgaW50IGVycm5vdmFsLAordm9pZCBsaWJ4bF9fZXZlbnRfZGlzYXN0ZXIo
bGlieGxfX2djICpnYywgY29uc3QgY2hhciAqbXNnLCBpbnQgZXJybm92YWwsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBsaWJ4bF9ldmVudF90eXBlIHR5cGUgLyogbWF5IGJlIDAgKi8sCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpmaWxlLCBpbnQgbGluZSwgY29u
c3QgY2hhciAqZnVuYykKIHsKLSAgICBFR0NfR0M7Ci0KICAgICBsaWJ4bF9fbG9nKENUWCwgWFRM
X0NSSVRJQ0FMLCBlcnJub3ZhbCwgZmlsZSwgbGluZSwgZnVuYywgSU5WQUxJRF9ET01JRCwKICAg
ICAgICAgICAgICAgICJESVNBU1RFUiBpbiBldmVudCBsb29wOiAlcyVzJXMlcyIsCiAgICAgICAg
ICAgICAgICBtc2csCkBAIC0xNjcyLDggKzE2NzAsOSBAQCB2b2lkIGxpYnhsX19wb2xsZXJfcHV0
KGxpYnhsX2N0eCAqY3R4LCBsaWJ4bF9fcG9sbGVyICpwKQogCiB2b2lkIGxpYnhsX19wb2xsZXJf
d2FrZXVwKGxpYnhsX19lZ2MgKmVnYywgbGlieGxfX3BvbGxlciAqcCkKIHsKKyAgICBFR0NfR0M7
CiAgICAgaW50IGUgPSBsaWJ4bF9fc2VsZl9waXBlX3dha2V1cChwLT53YWtldXBfcGlwZVsxXSk7
Ci0gICAgaWYgKGUpIExJQlhMX19FVkVOVF9ESVNBU1RFUihlZ2MsICJjYW5ub3QgcG9rZSB3YXRj
aCBwaXBlIiwgZSwgMCk7CisgICAgaWYgKGUpIExJQlhMX19FVkVOVF9ESVNBU1RFUihnYywgImNh
bm5vdCBwb2tlIHdhdGNoIHBpcGUiLCBlLCAwKTsKIH0KIAogLyoKZGlmZiAtLWdpdCBhL3Rvb2xz
L2xpYnhsL2xpYnhsX2ZvcmsuYyBiL3Rvb2xzL2xpYnhsL2xpYnhsX2ZvcmsuYwppbmRleCBjZjE3
MGI5MDg1Li45YTQ3MDliOWE0IDEwMDY0NAotLS0gYS90b29scy9saWJ4bC9saWJ4bF9mb3JrLmMK
KysrIGIvdG9vbHMvbGlieGwvbGlieGxfZm9yay5jCkBAIC0yMTEsNiArMjExLDcgQEAgaW50IGxp
YnhsX19jYXJlZmRfZmQoY29uc3QgbGlieGxfX2NhcmVmZCAqY2YpCiAvKiBMaWtlIHdhaXRwaWQo
LCxXTk9IQU5HKSBidXQgaGFuZGxlcyBhbGwgZXJyb3JzIGV4Y2VwdCBFQ0hJTEQuICovCiBzdGF0
aWMgcGlkX3QgY2hlY2tlZF93YWl0cGlkKGxpYnhsX19lZ2MgKmVnYywgcGlkX3Qgd2FudCwgaW50
ICpzdGF0dXMpCiB7CisgICAgRUdDX0dDOwogICAgIGZvciAoOzspIHsKICAgICAgICAgcGlkX3Qg
Z290ID0gd2FpdHBpZCh3YW50LCBzdGF0dXMsIFdOT0hBTkcpOwogICAgICAgICBpZiAoZ290ICE9
IC0xKQpAQCAtMjE5LDcgKzIyMCw3IEBAIHN0YXRpYyBwaWRfdCBjaGVja2VkX3dhaXRwaWQobGli
eGxfX2VnYyAqZWdjLCBwaWRfdCB3YW50LCBpbnQgKnN0YXR1cykKICAgICAgICAgICAgIHJldHVy
biBnb3Q7CiAgICAgICAgIGlmIChlcnJubyA9PSBFSU5UUikKICAgICAgICAgICAgIGNvbnRpbnVl
OwotICAgICAgICBMSUJYTF9fRVZFTlRfRElTQVNURVIoZWdjLCAid2FpdHBpZCgpIGZhaWxlZCIs
IGVycm5vLCAwKTsKKyAgICAgICAgTElCWExfX0VWRU5UX0RJU0FTVEVSKGdjLCAid2FpdHBpZCgp
IGZhaWxlZCIsIGVycm5vLCAwKTsKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogfQpAQCAtNTA3
LDcgKzUwOCw3IEBAIHN0YXRpYyB2b2lkIGNoaWxkcHJvY19jaGVja2FsbChsaWJ4bF9fZWdjICpl
Z2MpCiAgICAgZm91bmQ6CiAgICAgICAgIGlmIChnb3QgPT0gLTEpIHsKICAgICAgICAgICAgIExJ
QlhMX19FVkVOVF9ESVNBU1RFUgotICAgICAgICAgICAgICAgIChlZ2MsICJ3YWl0cGlkKCkgZ2F2
ZSBFQ0hJTEQgYnV0IHdlIGhhdmUgYSBjaGlsZCIsCisgICAgICAgICAgICAgICAgKGdjLCAid2Fp
dHBpZCgpIGdhdmUgRUNISUxEIGJ1dCB3ZSBoYXZlIGEgY2hpbGQiLAogICAgICAgICAgICAgICAg
ICBFQ0hJTEQsIDApOwogICAgICAgICAgICAgLyogaXQgbXVzdCBoYXZlIGZpbmlzaGVkIGJ1dCB3
ZSBkb24ndCBrbm93IGl0cyBzdGF0dXMgKi8KICAgICAgICAgICAgIHN0YXR1cyA9IDI1NTw8ODsg
Lyogbm8gd2FpdC5oIG1hY3JvIGZvciB0aGlzISAqLwpAQCAtNTQ1LDE0ICs1NDYsMTQgQEAgc3Rh
dGljIHZvaWQgc2lnY2hsZF9zZWxmcGlwZV9oYW5kbGVyKGxpYnhsX19lZ2MgKmVnYywgbGlieGxf
X2V2X2ZkICpldiwKIAogICAgIGlmIChyZXZlbnRzICYgflBPTExJTikgewogICAgICAgICBMT0co
RVJST1IsICJ1bmV4cGVjdGVkIHBvbGwgZXZlbnQgMHgleCBvbiBTSUdDSExEIHNlbGYgcGlwZSIs
IHJldmVudHMpOwotICAgICAgICBMSUJYTF9fRVZFTlRfRElTQVNURVIoZWdjLAorICAgICAgICBM
SUJYTF9fRVZFTlRfRElTQVNURVIoZ2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi
dW5leHBlY3RlZCBwb2xsIGV2ZW50IG9uIFNJR0NITEQgc2VsZiBwaXBlIiwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDAsIDApOwogICAgIH0KICAgICBhc3NlcnQocmV2ZW50cyAmIFBP
TExJTik7CiAKICAgICBpbnQgZSA9IGxpYnhsX19zZWxmX3BpcGVfZWF0YWxsKHNlbGZwaXBlKTsK
LSAgICBpZiAoZSkgTElCWExfX0VWRU5UX0RJU0FTVEVSKGVnYywgInJlYWQgc2lnY2hsZCBwaXBl
IiwgZSwgMCk7CisgICAgaWYgKGUpIExJQlhMX19FVkVOVF9ESVNBU1RFUihnYywgInJlYWQgc2ln
Y2hsZCBwaXBlIiwgZSwgMCk7CiAKICAgICBpZiAoQ1RYLT5jaGlsZHByb2NfaG9va3MtPmNobGRv
d25lcgogICAgICAgICA9PSBsaWJ4bF9zaWdjaGxkX293bmVyX2xpYnhsX2Fsd2F5c19zZWxlY3Rp
dmVfcmVhcCkgewpAQCAtNTgxLDcgKzU4Miw3IEBAIHN0YXRpYyB2b2lkIHNpZ2NobGRfc2VsZnBp
cGVfaGFuZGxlcihsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX19ldl9mZCAqZXYsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICIgbGlieGxfY2hpbGRwcm9jX2hvb2tzLT5yZWFwZWRfY2FsbGJh
Y2siCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgKGZvciBwaWQ9JWx1LCBzdGF0dXM9
JWQ7IGVycm9yIGNvZGUgJWQpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHVuc2ln
bmVkIGxvbmcpcGlkLCBzdGF0dXMsIHJjKTsKLSAgICAgICAgICAgICAgICAgICAgTElCWExfX0VW
RU5UX0RJU0FTVEVSKGVnYywgZGlzYXN0ZXJidWYsIDAsIDApOworICAgICAgICAgICAgICAgICAg
ICBMSUJYTF9fRVZFTlRfRElTQVNURVIoZ2MsIGRpc2FzdGVyYnVmLCAwLCAwKTsKICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgIH0gZWxz
ZSB7CmRpZmYgLS1naXQgYS90b29scy9saWJ4bC9saWJ4bF9pbnRlcm5hbC5oIGIvdG9vbHMvbGli
eGwvbGlieGxfaW50ZXJuYWwuaAppbmRleCA5ODNmZmZhYzdhLi4zMjhlY2YzZTFlIDEwMDY0NAot
LS0gYS90b29scy9saWJ4bC9saWJ4bF9pbnRlcm5hbC5oCisrKyBiL3Rvb2xzL2xpYnhsL2xpYnhs
X2ludGVybmFsLmgKQEAgLTEyODEsOCArMTI4MSw4IEBAIF9oaWRkZW4gbGlieGxfZXZlbnQgKmxp
YnhsX19ldmVudF9uZXcobGlieGxfX2VnYyosIGxpYnhsX2V2ZW50X3R5cGUsCiAvKgogICogSW4g
Z2VuZXJhbCwgY2FsbCB0aGlzIHZpYSB0aGUgbWFjcm8gTElCWExfX0VWRU5UX0RJU0FTVEVSLgog
ICoKLSAqIEV2ZW50LWdlbmVyYXRpbmcgZnVuY3Rpb25zIG1heSBjYWxsIHRoaXMgaWYgdGhleSBt
aWdodCBoYXZlIHdhbnRlZAotICogdG8gZ2VuZXJhdGUgYW4gZXZlbnQgKGVpdGhlciBhbiBpbnRl
cm5hbCBvbmUgaWUgYQorICogRXZlbnQtZ2VuZXJhdGluZyBmdW5jdGlvbnMsIG9yIGFvIG1hY2hp
bmVyeSwgbWF5IGNhbGwgdGhpcyBpZiB0aGV5CisgKiBtaWdodCBoYXZlIHdhbnRlZCB0byBnZW5l
cmF0ZSBhbiBldmVudCAoZWl0aGVyIGFuIGludGVybmFsIG9uZSBpZSBhCiAgKiBsaWJ4bF9fZXZf
Rk9PX2NhbGxiYWNrIG9yIGFuIGFwcGxpY2F0aW9uIGV2ZW50KSwgYnV0IGFyZSBwcmV2ZW50ZWQK
ICAqIGZyb20gZG9pbmcgc28gZHVlIHRvIGVnIGxhY2sgb2YgbWVtb3J5LgogICoKQEAgLTEyOTAs
MTIgKzEyOTAsMTIgQEAgX2hpZGRlbiBsaWJ4bF9ldmVudCAqbGlieGxfX2V2ZW50X25ldyhsaWJ4
bF9fZWdjKiwgbGlieGxfZXZlbnRfdHlwZSwKICAqIHRoZW4gY3Jhc2gsIGFsdGhvdWdoIGl0IG1h
eSBmYWlsIChhbmQgaGVuY2Vmb3J0aCBsZWF2ZSB0aGluZ3MgaW4gYQogICogc3RhdGUgd2hlcmUg
bWFueSBvciBhbGwgY2FsbHMgZmFpbCkuCiAgKi8KLV9oaWRkZW4gdm9pZCBsaWJ4bF9fZXZlbnRf
ZGlzYXN0ZXIobGlieGxfX2VnYyosIGNvbnN0IGNoYXIgKm1zZywgaW50IGVycm5vdmFsLAorX2hp
ZGRlbiB2b2lkIGxpYnhsX19ldmVudF9kaXNhc3RlcihsaWJ4bF9fZ2MqLCBjb25zdCBjaGFyICpt
c2csIGludCBlcnJub3ZhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGli
eGxfZXZlbnRfdHlwZSB0eXBlIC8qIG1heSBiZSAwICovLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBjaGFyICpmaWxlLCBpbnQgbGluZSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZnVuYyk7Ci0jZGVmaW5lIExJQlhMX19F
VkVOVF9ESVNBU1RFUihlZ2MsIG1zZywgZXJybm92YWwsIHR5cGUpIFwKLSAgICBsaWJ4bF9fZXZl
bnRfZGlzYXN0ZXIoZWdjLCBtc2csIGVycm5vdmFsLCB0eXBlLCBfX0ZJTEVfXyxfX0xJTkVfXyxf
X2Z1bmNfXykKKyNkZWZpbmUgTElCWExfX0VWRU5UX0RJU0FTVEVSKGdjLCBtc2csIGVycm5vdmFs
LCB0eXBlKSBcCisgICAgbGlieGxfX2V2ZW50X2Rpc2FzdGVyKGdjLCBtc2csIGVycm5vdmFsLCB0
eXBlLCBfX0ZJTEVfXyxfX0xJTkVfXyxfX2Z1bmNfXykKIAogCiAvKiBGaWxscyBpbiwgb3IgZGlz
cG9zZXMgb2YsIHRoZSByZXNvdXJjZXMgaGVsZCBieSwgYSBwb2xsZXIgd2hvc2UKLS0gCjIuMTEu
MAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

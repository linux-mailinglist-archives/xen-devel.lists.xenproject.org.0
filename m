Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id ACA1A1528EE
	for <lists+xen-devel@lfdr.de>; Wed,  5 Feb 2020 11:14:43 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1izHf4-0003Kj-Qv; Wed, 05 Feb 2020 10:11:58 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=lMay=3Z=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1izHf3-0003Jt-0k
 for xen-devel@lists.xenproject.org; Wed, 05 Feb 2020 10:11:57 +0000
X-Inumbo-ID: e9ce50f2-47ff-11ea-90ba-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id e9ce50f2-47ff-11ea-90ba-12813bfff9fa;
 Wed, 05 Feb 2020 10:11:46 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 48D4BAFF1;
 Wed,  5 Feb 2020 10:11:45 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Wed,  5 Feb 2020 11:11:37 +0100
Message-Id: <20200205101141.24769-5-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20200205101141.24769-1-jgross@suse.com>
References: <20200205101141.24769-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v4 4/8] libs: add libxenhypfs
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIHRoZSBuZXcgbGlicmFyeSBsaWJ4ZW5oeXBmcyBmb3IgYWNjZXNzIHRvIHRoZSBoeXBlcnZp
c29yIGZpbGVzeXN0ZW0uCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3Vz
ZS5jb20+Ci0tLQpWMToKLSByZW5hbWUgdG8gbGlieGVuaHlwZnMKLSBhZGQgeGVuaHlwZnNfd3Jp
dGUoKQoKVjM6Ci0gbWFqb3IgcmV3b3JrIGR1ZSB0byBuZXcgaHlwZXJ2aXNvciBpbnRlcmZhY2UK
LSBhZGQgZGVjb21wcmVzc2lvbiBjYXBhYmlsaXR5CgpWNDoKLSBhZGQgZGVwZW5kZW5jeSB0byBs
aWJ6IGluIHBrZ2NvbmZpZyBmaWxlIChXZWkgTGl1KQotLS0KIC5naXRpZ25vcmUgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAyICsKIHRvb2xzL1J1bGVzLm1rICAgICAgICAgICAgICAgICAg
ICAgIHwgICA2ICsKIHRvb2xzL2xpYnMvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICAxICsK
IHRvb2xzL2xpYnMvaHlwZnMvTWFrZWZpbGUgICAgICAgICAgIHwgIDE2ICsrCiB0b29scy9saWJz
L2h5cGZzL2NvcmUuYyAgICAgICAgICAgICB8IDUzMyArKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysKIHRvb2xzL2xpYnMvaHlwZnMvaW5jbHVkZS94ZW5oeXBmcy5oIHwgIDc1ICsr
KysrCiB0b29scy9saWJzL2h5cGZzL2xpYnhlbmh5cGZzLm1hcCAgICB8ICAxMCArCiB0b29scy9s
aWJzL2h5cGZzL3hlbmh5cGZzLnBjLmluICAgICB8ICAxMCArCiA4IGZpbGVzIGNoYW5nZWQsIDY1
MyBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgdG9vbHMvbGlicy9oeXBmcy9NYWtl
ZmlsZQogY3JlYXRlIG1vZGUgMTAwNjQ0IHRvb2xzL2xpYnMvaHlwZnMvY29yZS5jCiBjcmVhdGUg
bW9kZSAxMDA2NDQgdG9vbHMvbGlicy9oeXBmcy9pbmNsdWRlL3hlbmh5cGZzLmgKIGNyZWF0ZSBt
b2RlIDEwMDY0NCB0b29scy9saWJzL2h5cGZzL2xpYnhlbmh5cGZzLm1hcAogY3JlYXRlIG1vZGUg
MTAwNjQ0IHRvb2xzL2xpYnMvaHlwZnMveGVuaHlwZnMucGMuaW4KCmRpZmYgLS1naXQgYS8uZ2l0
aWdub3JlIGIvLmdpdGlnbm9yZQppbmRleCBiMjYyNGRmNzlhLi5lOThjM2YwNTZkIDEwMDY0NAot
LS0gYS8uZ2l0aWdub3JlCisrKyBiLy5naXRpZ25vcmUKQEAgLTEwOSw2ICsxMDksOCBAQCB0b29s
cy9saWJzL2V2dGNobi9oZWFkZXJzLmNoawogdG9vbHMvbGlicy9ldnRjaG4veGVuZXZ0Y2huLnBj
CiB0b29scy9saWJzL2dudHRhYi9oZWFkZXJzLmNoawogdG9vbHMvbGlicy9nbnR0YWIveGVuZ250
dGFiLnBjCit0b29scy9saWJzL2h5cGZzL2hlYWRlcnMuY2hrCit0b29scy9saWJzL2h5cGZzL3hl
bmh5cGZzLnBjCiB0b29scy9saWJzL2NhbGwvaGVhZGVycy5jaGsKIHRvb2xzL2xpYnMvY2FsbC94
ZW5jYWxsLnBjCiB0b29scy9saWJzL2ZvcmVpZ25tZW1vcnkvaGVhZGVycy5jaGsKZGlmZiAtLWdp
dCBhL3Rvb2xzL1J1bGVzLm1rIGIvdG9vbHMvUnVsZXMubWsKaW5kZXggNTJmNDdiZTNmOC4uYTA0
Njk3YTMzYyAxMDA2NDQKLS0tIGEvdG9vbHMvUnVsZXMubWsKKysrIGIvdG9vbHMvUnVsZXMubWsK
QEAgLTE5LDYgKzE5LDcgQEAgWEVOX0xJQlhFTkdOVFRBQiAgID0gJChYRU5fUk9PVCkvdG9vbHMv
bGlicy9nbnR0YWIKIFhFTl9MSUJYRU5DQUxMICAgICA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xpYnMv
Y2FsbAogWEVOX0xJQlhFTkZPUkVJR05NRU1PUlkgPSAkKFhFTl9ST09UKS90b29scy9saWJzL2Zv
cmVpZ25tZW1vcnkKIFhFTl9MSUJYRU5ERVZJQ0VNT0RFTCA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xp
YnMvZGV2aWNlbW9kZWwKK1hFTl9MSUJYRU5IWVBGUyAgICA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xp
YnMvaHlwZnMKIFhFTl9MSUJYQyAgICAgICAgICA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xpYnhjCiBY
RU5fWEVOTElHSFQgICAgICAgPSAkKFhFTl9ST09UKS90b29scy9saWJ4bAogIyBDdXJyZW50bHkg
bGlieGx1dGlsIGxpdmVzIGluIHRoZSBzYW1lIGRpcmVjdG9yeSBhcyBsaWJ4ZW5saWdodApAQCAt
MTM0LDYgKzEzNSwxMSBAQCBTSERFUFNfbGlieGVuZGV2aWNlbW9kZWwgPSAkKFNITElCX2xpYnhl
bnRvb2xsb2cpICQoU0hMSUJfbGlieGVudG9vbGNvcmUpICQoU0hMSQogTERMSUJTX2xpYnhlbmRl
dmljZW1vZGVsID0gJChTSERFUFNfbGlieGVuZGV2aWNlbW9kZWwpICQoWEVOX0xJQlhFTkRFVklD
RU1PREVMKS9saWJ4ZW5kZXZpY2Vtb2RlbCQobGliZXh0ZW5zaW9uKQogU0hMSUJfbGlieGVuZGV2
aWNlbW9kZWwgID0gJChTSERFUFNfbGlieGVuZGV2aWNlbW9kZWwpIC1XbCwtcnBhdGgtbGluaz0k
KFhFTl9MSUJYRU5ERVZJQ0VNT0RFTCkKIAorQ0ZMQUdTX2xpYnhlbmh5cGZzID0gLUkkKFhFTl9M
SUJYRU5IWVBGUykvaW5jbHVkZSAkKENGTEFHU194ZW5pbmNsdWRlKQorU0hERVBTX2xpYnhlbmh5
cGZzID0gJChTSExJQl9saWJ4ZW50b29sbG9nKSAkKFNITElCX2xpYnhlbnRvb2xjb3JlKSAkKFNI
TElCX3hlbmNhbGwpCitMRExJQlNfbGlieGVuaHlwZnMgPSAkKFNIREVQU19saWJ4ZW5oeXBmcykg
JChYRU5fTElCWEVOSFlQRlMpL2xpYnhlbmh5cGZzJChsaWJleHRlbnNpb24pCitTSExJQl9saWJ4
ZW5oeXBmcyAgPSAkKFNIREVQU19saWJ4ZW5oeXBmcykgLVdsLC1ycGF0aC1saW5rPSQoWEVOX0xJ
QlhFTkhZUEZTKQorCiAjIGNvZGUgd2hpY2ggY29tcGlsZXMgYWdhaW5zdCBsaWJ4ZW5jdHJsIGdl
dCBfX1hFTl9UT09MU19fIGFuZAogIyB0aGVyZWZvcmUgc2VlcyB0aGUgdW5zdGFibGUgaHlwZXJj
YWxsIGludGVyZmFjZXMuCiBDRkxBR1NfbGlieGVuY3RybCA9IC1JJChYRU5fTElCWEMpL2luY2x1
ZGUgJChDRkxBR1NfbGlieGVudG9vbGxvZykgJChDRkxBR1NfbGlieGVuZm9yZWlnbm1lbW9yeSkg
JChDRkxBR1NfbGlieGVuZGV2aWNlbW9kZWwpICQoQ0ZMQUdTX3hlbmluY2x1ZGUpIC1EX19YRU5f
VE9PTFNfXwpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlicy9NYWtlZmlsZSBiL3Rvb2xzL2xpYnMvTWFr
ZWZpbGUKaW5kZXggODg5MDFlNzM0MS4uNjljZGZiNTk3NSAxMDA2NDQKLS0tIGEvdG9vbHMvbGli
cy9NYWtlZmlsZQorKysgYi90b29scy9saWJzL01ha2VmaWxlCkBAIC05LDYgKzksNyBAQCBTVUJE
SVJTLXkgKz0gZ250dGFiCiBTVUJESVJTLXkgKz0gY2FsbAogU1VCRElSUy15ICs9IGZvcmVpZ25t
ZW1vcnkKIFNVQkRJUlMteSArPSBkZXZpY2Vtb2RlbAorU1VCRElSUy15ICs9IGh5cGZzCiAKIGlm
ZXEgKCQoQ09ORklHX1JVTVApLHkpCiBTVUJESVJTLXkgOj0gdG9vbGNvcmUKZGlmZiAtLWdpdCBh
L3Rvb2xzL2xpYnMvaHlwZnMvTWFrZWZpbGUgYi90b29scy9saWJzL2h5cGZzL01ha2VmaWxlCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAuLjA2ZGQ0NDk5MjkKLS0tIC9kZXYv
bnVsbAorKysgYi90b29scy9saWJzL2h5cGZzL01ha2VmaWxlCkBAIC0wLDAgKzEsMTYgQEAKK1hF
Tl9ST09UID0gJChDVVJESVIpLy4uLy4uLy4uCitpbmNsdWRlICQoWEVOX1JPT1QpL3Rvb2xzL1J1
bGVzLm1rCisKK01BSk9SICAgID0gMQorTUlOT1IgICAgPSAwCitMSUJOQU1FICA6PSBoeXBmcwor
VVNFTElCUyAgOj0gdG9vbGxvZyB0b29sY29yZSBjYWxsCisKK0FQUEVORF9MREZMQUdTICs9IC1s
egorCitTUkNTLXkgICAgICAgICAgICAgICAgICs9IGNvcmUuYworCitpbmNsdWRlIC4uL2xpYnMu
bWsKKworJChQS0dfQ09ORklHX0xPQ0FMKTogUEtHX0NPTkZJR19JTkNESVIgPSAkKFhFTl9MSUJY
RU5IWVBGUykvaW5jbHVkZQorJChQS0dfQ09ORklHX0xPQ0FMKTogUEtHX0NPTkZJR19DRkxBR1Nf
TE9DQUwgPSAkKENGTEFHU194ZW5pbmNsdWRlKQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlicy9oeXBm
cy9jb3JlLmMgYi90b29scy9saWJzL2h5cGZzL2NvcmUuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAwLi5jZWQ2MTZjODc5Ci0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvbGli
cy9oeXBmcy9jb3JlLmMKQEAgLTAsMCArMSw1MzMgQEAKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIw
MTkgU1VTRSBTb2Z0d2FyZSBTb2x1dGlvbnMgR2VybWFueSBHbWJICisgKgorICogVGhpcyBsaWJy
YXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICog
bW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1Ymxp
YworICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlv
bjsKKyAqIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLgorICoKKyAqIFRoaXMgbGlicmFyeSBp
cyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0
IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkg
b2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUgR05VCisgKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9y
ZSBkZXRhaWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhl
IEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxp
YnJhcnk7IElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyAqLwor
CisjZGVmaW5lIF9fWEVOX1RPT0xTX18gMQorCisjZGVmaW5lIF9HTlVfU09VUkNFCisKKyNpbmNs
dWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGludHR5cGVzLmg+CisjaW5jbHVkZSA8c3RkbGliLmg+
CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVkZSA8emxpYi5oPgorCisjaW5jbHVkZSA8eGVu
dG9vbGxvZy5oPgorI2luY2x1ZGUgPHhlbmh5cGZzLmg+CisjaW5jbHVkZSA8eGVuY2FsbC5oPgor
I2luY2x1ZGUgPHhlbnRvb2xjb3JlX2ludGVybmFsLmg+CisKKyNpbmNsdWRlIDx4ZW4veGVuLmg+
CisjaW5jbHVkZSA8eGVuL2h5cGZzLmg+CisKKyNkZWZpbmUgQlVGX1NJWkUgNDA5NgorCitzdHJ1
Y3QgeGVuaHlwZnNfaGFuZGxlIHsKKyAgICB4ZW50b29sbG9nX2xvZ2dlciAqbG9nZ2VyLCAqbG9n
Z2VyX3RvZnJlZTsKKyAgICB1bnNpZ25lZCBpbnQgZmxhZ3M7CisgICAgeGVuY2FsbF9oYW5kbGUg
KnhjYWxsOworfTsKKworeGVuaHlwZnNfaGFuZGxlICp4ZW5oeXBmc19vcGVuKHhlbnRvb2xsb2df
bG9nZ2VyICpsb2dnZXIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
b3Blbl9mbGFncykKK3sKKyAgICB4ZW5oeXBmc19oYW5kbGUgKmZzaGRsID0gY2FsbG9jKDEsIHNp
emVvZigqZnNoZGwpKTsKKworICAgIGlmICghZnNoZGwpCisgICAgICAgIHJldHVybiBOVUxMOwor
CisgICAgZnNoZGwtPmZsYWdzID0gb3Blbl9mbGFnczsKKyAgICBmc2hkbC0+bG9nZ2VyID0gbG9n
Z2VyOworICAgIGZzaGRsLT5sb2dnZXJfdG9mcmVlID0gTlVMTDsKKworICAgIGlmICghZnNoZGwt
PmxvZ2dlcikgeworICAgICAgICBmc2hkbC0+bG9nZ2VyID0gZnNoZGwtPmxvZ2dlcl90b2ZyZWUg
PQorICAgICAgICAgICAgKHhlbnRvb2xsb2dfbG9nZ2VyKikKKyAgICAgICAgICAgIHh0bF9jcmVh
dGVsb2dnZXJfc3RkaW9zdHJlYW0oc3RkZXJyLCBYVExfUFJPR1JFU1MsIDApOworICAgICAgICBp
ZiAoIWZzaGRsLT5sb2dnZXIpCisgICAgICAgICAgICBnb3RvIGVycjsKKyAgICB9CisKKyAgICBm
c2hkbC0+eGNhbGwgPSB4ZW5jYWxsX29wZW4oZnNoZGwtPmxvZ2dlciwgMCk7CisgICAgaWYgKCFm
c2hkbC0+eGNhbGwpCisgICAgICAgIGdvdG8gZXJyOworCisgICAgLyogTm8gbmVlZCB0byByZW1l
bWJlciBzdXBwb3J0ZWQgdmVyc2lvbiwgd2Ugb25seSBzdXBwb3J0IFYxLiAqLworICAgIGlmICh4
ZW5jYWxsMShmc2hkbC0+eGNhbGwsIF9fSFlQRVJWSVNPUl9oeXBmc19vcCwKKyAgICAgICAgICAg
ICAgICAgWEVOX0hZUEZTX09QX2dldF92ZXJzaW9uKSA8IDApCisgICAgICAgIGdvdG8gZXJyOwor
CisgICAgcmV0dXJuIGZzaGRsOworCitlcnI6CisgICAgeHRsX2xvZ2dlcl9kZXN0cm95KGZzaGRs
LT5sb2dnZXJfdG9mcmVlKTsKKyAgICB4ZW5jYWxsX2Nsb3NlKGZzaGRsLT54Y2FsbCk7CisgICAg
ZnJlZShmc2hkbCk7CisgICAgcmV0dXJuIE5VTEw7Cit9CisKK2ludCB4ZW5oeXBmc19jbG9zZSh4
ZW5oeXBmc19oYW5kbGUgKmZzaGRsKQoreworICAgIGlmICghZnNoZGwpCisgICAgICAgIHJldHVy
biAwOworCisgICAgeGVuY2FsbF9jbG9zZShmc2hkbC0+eGNhbGwpOworICAgIHh0bF9sb2dnZXJf
ZGVzdHJveShmc2hkbC0+bG9nZ2VyX3RvZnJlZSk7CisgICAgZnJlZShmc2hkbCk7CisgICAgcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgeGVuaHlwZnNfZ2V0X3BhdGhidWYoeGVuaHlwZnNfaGFu
ZGxlICpmc2hkbCwgY29uc3QgY2hhciAqcGF0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY2hhciAqKnBhdGhfYnVmKQoreworICAgIGludCByZXQgPSAtMTsKKyAgICBpbnQgcGF0
aF9zejsKKworICAgIGlmICghZnNoZGwpIHsKKyAgICAgICAgZXJybm8gPSBFQkFERjsKKyAgICAg
ICAgZ290byBvdXQ7CisgICAgfQorCisgICAgcGF0aF9zeiA9IHN0cmxlbihwYXRoKSArIDE7Cisg
ICAgaWYgKHBhdGhfc3ogPiBYRU5fSFlQRlNfTUFYX1BBVEhMRU4pCisgICAgeworICAgICAgICBl
cnJubyA9IEVOQU1FVE9PTE9ORzsKKyAgICAgICAgZ290byBvdXQ7CisgICAgfQorCisgICAgKnBh
dGhfYnVmID0geGVuY2FsbF9hbGxvY19idWZmZXIoZnNoZGwtPnhjYWxsLCBwYXRoX3N6KTsKKyAg
ICBpZiAoISpwYXRoX2J1ZikgeworICAgICAgICBlcnJubyA9IEVOT01FTTsKKyAgICAgICAgZ290
byBvdXQ7CisgICAgfQorICAgIHN0cmNweSgqcGF0aF9idWYsIHBhdGgpOworCisgICAgcmV0ID0g
cGF0aF9zejsKKworIG91dDoKKyAgICByZXR1cm4gcmV0OworfQorCitzdGF0aWMgdm9pZCAqeGVu
aHlwZnNfaW5mbGF0ZSh2b2lkICppbl9kYXRhLCBzaXplX3QgKnN6KQoreworICAgIHVuc2lnbmVk
IGNoYXIgKndvcmtidWY7CisgICAgdm9pZCAqY29udGVudCA9IE5VTEw7CisgICAgdW5zaWduZWQg
aW50IG91dF9zejsKKyAgICB6X3N0cmVhbSB6ID0geyAub3BhcXVlID0gTlVMTCB9OworICAgIGlu
dCByZXQ7CisKKyAgICB3b3JrYnVmID0gbWFsbG9jKEJVRl9TSVpFKTsKKyAgICBpZiAoIXdvcmti
dWYpCisgICAgICAgIHJldHVybiBOVUxMOworCisgICAgei5uZXh0X2luID0gaW5fZGF0YTsKKyAg
ICB6LmF2YWlsX2luID0gKnN6OworICAgIHJldCA9IGluZmxhdGVJbml0MigmeiwgTUFYX1dCSVRT
ICsgMzIpOyAvKiAzMiA9PSBnemlwICovCisKKyAgICBmb3IgKCpzeiA9IDA7IHJldCA9PSBaX09L
OyAqc3ogKz0gb3V0X3N6KSB7CisgICAgICAgIHoubmV4dF9vdXQgPSB3b3JrYnVmOworICAgICAg
ICB6LmF2YWlsX291dCA9IEJVRl9TSVpFOworICAgICAgICByZXQgPSBpbmZsYXRlKCZ6LCBaX1NZ
TkNfRkxVU0gpOworICAgICAgICBpZiAocmV0ICE9IFpfT0sgJiYgcmV0ICE9IFpfU1RSRUFNX0VO
RCkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgIG91dF9zeiA9IHoubmV4dF9vdXQgLSB3
b3JrYnVmOworICAgICAgICBjb250ZW50ID0gcmVhbGxvYyhjb250ZW50LCAqc3ogKyBvdXRfc3op
OworICAgICAgICBpZiAoIWNvbnRlbnQpIHsKKyAgICAgICAgICAgIHJldCA9IFpfTUVNX0VSUk9S
OworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyAgICAgICAgbWVtY3B5KGNvbnRlbnQg
KyAqc3osIHdvcmtidWYsIG91dF9zeik7CisgICAgfQorCisgICAgaW5mbGF0ZUVuZCgmeik7Cisg
ICAgaWYgKHJldCAhPSBaX1NUUkVBTV9FTkQpIHsKKyAgICAgICAgZnJlZShjb250ZW50KTsKKyAg
ICAgICAgY29udGVudCA9IE5VTEw7CisgICAgICAgIGVycm5vID0gRUlPOworICAgIH0KKyAgICBm
cmVlKHdvcmtidWYpOworICAgIHJldHVybiBjb250ZW50OworfQorCitzdGF0aWMgdm9pZCB4ZW5o
eXBmc19zZXRfYXR0cnMoc3RydWN0IHhlbl9oeXBmc19kaXJlbnRyeSAqZW50cnksCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhlbmh5cGZzX2RpcmVudCAqZGlyZW50KQor
eworICAgIGRpcmVudC0+c2l6ZSA9IGVudHJ5LT5jb250ZW50X2xlbjsKKworICAgIHN3aXRjaChl
bnRyeS0+dHlwZSkgeworICAgIGNhc2UgWEVOX0hZUEZTX1RZUEVfRElSOgorICAgICAgICBkaXJl
bnQtPnR5cGUgPSB4ZW5oeXBmc190eXBlX2RpcjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBY
RU5fSFlQRlNfVFlQRV9CTE9COgorICAgICAgICBkaXJlbnQtPnR5cGUgPSB4ZW5oeXBmc190eXBl
X2Jsb2I7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgWEVOX0hZUEZTX1RZUEVfU1RSSU5HOgor
ICAgICAgICBkaXJlbnQtPnR5cGUgPSB4ZW5oeXBmc190eXBlX3N0cmluZzsKKyAgICAgICAgYnJl
YWs7CisgICAgY2FzZSBYRU5fSFlQRlNfVFlQRV9VSU5UOgorICAgICAgICBkaXJlbnQtPnR5cGUg
PSB4ZW5oeXBmc190eXBlX3VpbnQ7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgWEVOX0hZUEZT
X1RZUEVfSU5UOgorICAgICAgICBkaXJlbnQtPnR5cGUgPSB4ZW5oeXBmc190eXBlX2ludDsKKyAg
ICAgICAgYnJlYWs7CisgICAgY2FzZSBYRU5fSFlQRlNfVFlQRV9CT09MOgorICAgICAgICBkaXJl
bnQtPnR5cGUgPSB4ZW5oeXBmc190eXBlX2Jvb2w7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1
bHQ6CisgICAgICAgIGRpcmVudC0+dHlwZSA9IHhlbmh5cGZzX3R5cGVfYmxvYjsKKyAgICB9CisK
KyAgICBzd2l0Y2ggKGVudHJ5LT5lbmNvZGluZykgeworICAgIGNhc2UgWEVOX0hZUEZTX0VOQ19Q
TEFJTjoKKyAgICAgICAgZGlyZW50LT5lbmNvZGluZyA9IHhlbmh5cGZzX2VuY19wbGFpbjsKKyAg
ICAgICAgYnJlYWs7CisgICAgY2FzZSBYRU5fSFlQRlNfRU5DX0daSVA6CisgICAgICAgIGRpcmVu
dC0+ZW5jb2RpbmcgPSB4ZW5oeXBmc19lbmNfZ3ppcDsKKyAgICAgICAgYnJlYWs7CisgICAgZGVm
YXVsdDoKKyAgICAgICAgZGlyZW50LT5lbmNvZGluZyA9IHhlbmh5cGZzX2VuY19wbGFpbjsKKyAg
ICAgICAgZGlyZW50LT50eXBlID0geGVuaHlwZnNfdHlwZV9ibG9iOworICAgIH0KKworICAgIGRp
cmVudC0+aXNfd3JpdGFibGUgPSBlbnRyeS0+ZmxhZ3MgJiBYRU5fSFlQRlNfV1JJVEVBQkxFOwor
fQorCit2b2lkICp4ZW5oeXBmc19yZWFkX3Jhdyh4ZW5oeXBmc19oYW5kbGUgKmZzaGRsLCBjb25z
dCBjaGFyICpwYXRoLAorICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhlbmh5cGZzX2Rp
cmVudCAqKmRpcmVudCkKK3sKKyAgICB2b2lkICpyZXRidWYgPSBOVUxMLCAqY29udGVudCA9IE5V
TEw7CisgICAgY2hhciAqcGF0aF9idWYgPSBOVUxMOworICAgIGNvbnN0IGNoYXIgKm5hbWU7Cisg
ICAgc3RydWN0IHhlbl9oeXBmc19kaXJlbnRyeSAqZW50cnk7CisgICAgaW50IHJldDsKKyAgICBp
bnQgc3osIHBhdGhfc3o7CisKKyAgICAqZGlyZW50ID0gTlVMTDsKKyAgICByZXQgPSB4ZW5oeXBm
c19nZXRfcGF0aGJ1Zihmc2hkbCwgcGF0aCwgJnBhdGhfYnVmKTsKKyAgICBpZiAocmV0IDwgMCkK
KyAgICAgICAgZ290byBvdXQ7CisKKyAgICBwYXRoX3N6ID0gcmV0OworCisgICAgZm9yIChzeiA9
IEJVRl9TSVpFOzsgc3ogPSBzaXplb2YoKmVudHJ5KSArIGVudHJ5LT5jb250ZW50X2xlbikgewor
ICAgICAgICBpZiAocmV0YnVmKQorICAgICAgICAgICAgeGVuY2FsbF9mcmVlX2J1ZmZlcihmc2hk
bC0+eGNhbGwsIHJldGJ1Zik7CisKKyAgICAgICAgcmV0YnVmID0geGVuY2FsbF9hbGxvY19idWZm
ZXIoZnNoZGwtPnhjYWxsLCBzeik7CisgICAgICAgIGlmICghcmV0YnVmKSB7CisgICAgICAgICAg
ICBlcnJubyA9IEVOT01FTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAgICB9CisgICAg
ICAgIGVudHJ5ID0gcmV0YnVmOworCisgICAgICAgIHJldCA9IHhlbmNhbGw1KGZzaGRsLT54Y2Fs
bCwgX19IWVBFUlZJU09SX2h5cGZzX29wLCBYRU5fSFlQRlNfT1BfcmVhZCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgKHVuc2lnbmVkIGxvbmcpcGF0aF9idWYsIHBhdGhfc3osCisgICAgICAgICAg
ICAgICAgICAgICAgICh1bnNpZ25lZCBsb25nKXJldGJ1Ziwgc3opOworICAgICAgICBpZiAoIXJl
dCkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgIGlmIChyZXQgIT0gRU5PQlVGUykgewor
ICAgICAgICAgICAgZXJybm8gPSAtcmV0OworICAgICAgICAgICAgZ290byBvdXQ7CisgICAgICAg
IH0KKyAgICB9CisKKyAgICBjb250ZW50ID0gbWFsbG9jKGVudHJ5LT5jb250ZW50X2xlbik7Cisg
ICAgaWYgKCFjb250ZW50KQorICAgICAgICBnb3RvIG91dDsKKyAgICBtZW1jcHkoY29udGVudCwg
ZW50cnkgKyAxLCBlbnRyeS0+Y29udGVudF9sZW4pOworCisgICAgbmFtZSA9IHN0cnJjaHIocGF0
aCwgJy8nKTsKKyAgICBpZiAoIW5hbWUpCisgICAgICAgIG5hbWUgPSBwYXRoOworICAgIGVsc2Ug
eworICAgICAgICBuYW1lKys7CisgICAgICAgIGlmICghKm5hbWUpCisgICAgICAgICAgICBuYW1l
LS07CisgICAgfQorICAgICpkaXJlbnQgPSBjYWxsb2MoMSwgc2l6ZW9mKHN0cnVjdCB4ZW5oeXBm
c19kaXJlbnQpICsgc3RybGVuKG5hbWUpICsgMSk7CisgICAgaWYgKCEqZGlyZW50KSB7CisgICAg
ICAgIGZyZWUoY29udGVudCk7CisgICAgICAgIGNvbnRlbnQgPSBOVUxMOworICAgICAgICBlcnJu
byA9IEVOT01FTTsKKyAgICAgICAgZ290byBvdXQ7CisgICAgfQorICAgICgqZGlyZW50KS0+bmFt
ZSA9IChjaGFyICopKCpkaXJlbnQgKyAxKTsKKyAgICBzdHJjcHkoKCpkaXJlbnQpLT5uYW1lLCBu
YW1lKTsKKyAgICB4ZW5oeXBmc19zZXRfYXR0cnMoZW50cnksICpkaXJlbnQpOworCisgb3V0Ogor
ICAgIHJldCA9IGVycm5vOworICAgIHhlbmNhbGxfZnJlZV9idWZmZXIoZnNoZGwtPnhjYWxsLCBw
YXRoX2J1Zik7CisgICAgeGVuY2FsbF9mcmVlX2J1ZmZlcihmc2hkbC0+eGNhbGwsIHJldGJ1Zik7
CisgICAgZXJybm8gPSByZXQ7CisKKyAgICByZXR1cm4gY29udGVudDsKK30KKworY2hhciAqeGVu
aHlwZnNfcmVhZCh4ZW5oeXBmc19oYW5kbGUgKmZzaGRsLCBjb25zdCBjaGFyICpwYXRoKQorewor
ICAgIGNoYXIgKmJ1ZiwgKnJldF9idWYgPSBOVUxMOworICAgIHN0cnVjdCB4ZW5oeXBmc19kaXJl
bnQgKmRpcmVudDsKKyAgICBpbnQgcmV0OworCisgICAgYnVmID0geGVuaHlwZnNfcmVhZF9yYXco
ZnNoZGwsIHBhdGgsICZkaXJlbnQpOworICAgIGlmICghYnVmKQorICAgICAgICBnb3RvIG91dDsK
KworICAgIHN3aXRjaCAoZGlyZW50LT5lbmNvZGluZykgeworICAgIGNhc2UgeGVuaHlwZnNfZW5j
X3BsYWluOgorICAgICAgICBicmVhazsKKyAgICBjYXNlIHhlbmh5cGZzX2VuY19nemlwOgorICAg
ICAgICByZXRfYnVmID0geGVuaHlwZnNfaW5mbGF0ZShidWYsICZkaXJlbnQtPnNpemUpOworICAg
ICAgICBpZiAoIXJldF9idWYpCisgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAgZnJlZShi
dWYpOworICAgICAgICBidWYgPSByZXRfYnVmOworICAgICAgICByZXRfYnVmID0gTlVMTDsKKyAg
ICAgICAgYnJlYWs7CisgICAgfQorCisgICAgc3dpdGNoIChkaXJlbnQtPnR5cGUpIHsKKyAgICBj
YXNlIHhlbmh5cGZzX3R5cGVfZGlyOgorICAgICAgICBlcnJubyA9IEVJU0RJUjsKKyAgICAgICAg
YnJlYWs7CisgICAgY2FzZSB4ZW5oeXBmc190eXBlX2Jsb2I6CisgICAgICAgIGVycm5vID0gRURP
TTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSB4ZW5oeXBmc190eXBlX3N0cmluZzoKKyAgICAg
ICAgcmV0X2J1ZiA9IGJ1ZjsKKyAgICAgICAgYnVmID0gTlVMTDsKKyAgICAgICAgYnJlYWs7Cisg
ICAgY2FzZSB4ZW5oeXBmc190eXBlX3VpbnQ6CisgICAgY2FzZSB4ZW5oeXBmc190eXBlX2Jvb2w6
CisgICAgICAgIHN3aXRjaCAoZGlyZW50LT5zaXplKSB7CisgICAgICAgIGNhc2UgMToKKyAgICAg
ICAgICAgIHJldCA9IGFzcHJpbnRmKCZyZXRfYnVmLCAiJSJQUkl1OCwgKih1aW50OF90ICopYnVm
KTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIDI6CisgICAgICAgICAgICByZXQg
PSBhc3ByaW50ZigmcmV0X2J1ZiwgIiUiUFJJdTE2LCAqKHVpbnQxNl90ICopYnVmKTsKKyAgICAg
ICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIDQ6CisgICAgICAgICAgICByZXQgPSBhc3ByaW50
ZigmcmV0X2J1ZiwgIiUiUFJJdTMyLCAqKHVpbnQzMl90ICopYnVmKTsKKyAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICBjYXNlIDg6CisgICAgICAgICAgICByZXQgPSBhc3ByaW50ZigmcmV0X2J1
ZiwgIiUiUFJJdTY0LCAqKHVpbnQ2NF90ICopYnVmKTsKKyAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICBkZWZhdWx0OgorICAgICAgICAgICAgcmV0ID0gLTE7CisgICAgICAgICAgICBlcnJubyA9
IEVET007CisgICAgICAgIH0KKyAgICAgICAgaWYgKHJldCA8IDApCisgICAgICAgICAgICByZXRf
YnVmID0gTlVMTDsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSB4ZW5oeXBmc190eXBlX2ludDoK
KyAgICAgICAgc3dpdGNoIChkaXJlbnQtPnNpemUpIHsKKyAgICAgICAgY2FzZSAxOgorICAgICAg
ICAgICAgcmV0ID0gYXNwcmludGYoJnJldF9idWYsICIlIlBSSWQ4LCAqKGludDhfdCAqKWJ1Zik7
CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSAyOgorICAgICAgICAgICAgcmV0ID0g
YXNwcmludGYoJnJldF9idWYsICIlIlBSSWQxNiwgKihpbnQxNl90ICopYnVmKTsKKyAgICAgICAg
ICAgIGJyZWFrOworICAgICAgICBjYXNlIDQ6CisgICAgICAgICAgICByZXQgPSBhc3ByaW50Zigm
cmV0X2J1ZiwgIiUiUFJJZDMyLCAqKGludDMyX3QgKilidWYpOworICAgICAgICAgICAgYnJlYWs7
CisgICAgICAgIGNhc2UgODoKKyAgICAgICAgICAgIHJldCA9IGFzcHJpbnRmKCZyZXRfYnVmLCAi
JSJQUklkNjQsICooaW50NjRfdCAqKWJ1Zik7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAg
ZGVmYXVsdDoKKyAgICAgICAgICAgIHJldCA9IC0xOworICAgICAgICAgICAgZXJybm8gPSBFRE9N
OworICAgICAgICB9CisgICAgICAgIGlmIChyZXQgPCAwKQorICAgICAgICAgICAgcmV0X2J1ZiA9
IE5VTEw7CisgICAgICAgIGJyZWFrOworICAgIH0KKworIG91dDoKKyAgICByZXQgPSBlcnJubzsK
KyAgICBmcmVlKGJ1Zik7CisgICAgZnJlZShkaXJlbnQpOworICAgIGVycm5vID0gcmV0OworCisg
ICAgcmV0dXJuIHJldF9idWY7Cit9CisKK3N0cnVjdCB4ZW5oeXBmc19kaXJlbnQgKnhlbmh5cGZz
X3JlYWRkaXIoeGVuaHlwZnNfaGFuZGxlICpmc2hkbCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqcGF0aCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpudW1fZW50cmllcykKK3sKKyAgICB2
b2lkICpidWYsICpjdXJyOworICAgIGludCByZXQ7CisgICAgY2hhciAqbmFtZXM7CisgICAgc3Ry
dWN0IHhlbmh5cGZzX2RpcmVudCAqcmV0X2J1ZiA9IE5VTEwsICpkaXJlbnQ7CisgICAgdW5zaWdu
ZWQgaW50IG4gPSAwLCBuYW1lX3N6ID0gMDsKKyAgICBzdHJ1Y3QgeGVuX2h5cGZzX2Rpcmxpc3Rl
bnRyeSAqZW50cnk7CisKKyAgICBidWYgPSB4ZW5oeXBmc19yZWFkX3Jhdyhmc2hkbCwgcGF0aCwg
JmRpcmVudCk7CisgICAgaWYgKCFidWYpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgaWYgKGRp
cmVudC0+dHlwZSAhPSB4ZW5oeXBmc190eXBlX2RpciB8fAorICAgICAgICBkaXJlbnQtPmVuY29k
aW5nICE9IHhlbmh5cGZzX2VuY19wbGFpbikgeworICAgICAgICBlcnJubyA9IEVOT1RESVI7Cisg
ICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAgIGlmIChkaXJlbnQtPnNpemUpIHsKKyAgICAg
ICAgY3VyciA9IGJ1ZjsKKyAgICAgICAgZm9yIChuID0gMTs7IG4rKykgeworICAgICAgICAgICAg
ZW50cnkgPSBjdXJyOworICAgICAgICAgICAgbmFtZV9zeiArPSBzdHJsZW4oZW50cnktPm5hbWUp
ICsgMTsKKyAgICAgICAgICAgIGlmICghZW50cnktPm9mZl9uZXh0KQorICAgICAgICAgICAgICAg
IGJyZWFrOworCisgICAgICAgICAgICBjdXJyICs9IGVudHJ5LT5vZmZfbmV4dDsKKyAgICAgICAg
fQorICAgIH0KKworICAgIHJldF9idWYgPSBtYWxsb2MobiAqIHNpemVvZigqcmV0X2J1ZikgKyBu
YW1lX3N6KTsKKyAgICBpZiAoIXJldF9idWYpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgKm51
bV9lbnRyaWVzID0gbjsKKyAgICBuYW1lcyA9IChjaGFyICopKHJldF9idWYgKyBuKTsKKyAgICBj
dXJyID0gYnVmOworICAgIGZvciAobiA9IDA7IG4gPCAqbnVtX2VudHJpZXM7IG4rKykgeworICAg
ICAgICBlbnRyeSA9IGN1cnI7CisgICAgICAgIHhlbmh5cGZzX3NldF9hdHRycygmZW50cnktPmUs
IHJldF9idWYgKyBuKTsKKyAgICAgICAgcmV0X2J1ZltuXS5uYW1lID0gbmFtZXM7CisgICAgICAg
IHN0cmNweShuYW1lcywgZW50cnktPm5hbWUpOworICAgICAgICBuYW1lcyArPSBzdHJsZW4oZW50
cnktPm5hbWUpICsgMTsKKyAgICAgICAgY3VyciArPSBlbnRyeS0+b2ZmX25leHQ7CisgICAgfQor
Cisgb3V0OgorICAgIHJldCA9IGVycm5vOworICAgIGZyZWUoYnVmKTsKKyAgICBmcmVlKGRpcmVu
dCk7CisgICAgZXJybm8gPSByZXQ7CisKKyAgICByZXR1cm4gcmV0X2J1ZjsKK30KKworaW50IHhl
bmh5cGZzX3dyaXRlKHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBhdGgsIGNv
bnN0IGNoYXIgKnZhbCkKK3sKKyAgICB2b2lkICpidWYgPSBOVUxMOworICAgIGNoYXIgKnBhdGhf
YnVmID0gTlVMTCwgKnZhbF9lbmQ7CisgICAgaW50IHJldCwgc2F2ZWRfZXJybm87CisgICAgaW50
IHN6LCBwYXRoX3N6OworICAgIHN0cnVjdCB4ZW5faHlwZnNfZGlyZW50cnkgKmVudHJ5OworICAg
IHVpbnQ2NF90IG1hc2s7CisKKyAgICByZXQgPSB4ZW5oeXBmc19nZXRfcGF0aGJ1Zihmc2hkbCwg
cGF0aCwgJnBhdGhfYnVmKTsKKyAgICBpZiAocmV0IDwgMCkKKyAgICAgICAgZ290byBvdXQ7CisK
KyAgICBwYXRoX3N6ID0gcmV0OworICAgIHJldCA9IC0xOworCisgICAgc3ogPSBCVUZfU0laRTsK
KyAgICBidWYgPSB4ZW5jYWxsX2FsbG9jX2J1ZmZlcihmc2hkbC0+eGNhbGwsIHN6KTsKKyAgICBp
ZiAoIWJ1ZikgeworICAgICAgICBlcnJubyA9IEVOT01FTTsKKyAgICAgICAgZ290byBvdXQ7Cisg
ICAgfQorCisgICAgcmV0ID0geGVuY2FsbDUoZnNoZGwtPnhjYWxsLCBfX0hZUEVSVklTT1JfaHlw
ZnNfb3AsIFhFTl9IWVBGU19PUF9yZWFkLAorICAgICAgICAgICAgICAgICAgICh1bnNpZ25lZCBs
b25nKXBhdGhfYnVmLCBwYXRoX3N6LAorICAgICAgICAgICAgICAgICAgICh1bnNpZ25lZCBsb25n
KWJ1Ziwgc2l6ZW9mKCplbnRyeSkpOworICAgIGlmIChyZXQpCisgICAgICAgIGdvdG8gb3V0Owor
ICAgIHJldCA9IC0xOworICAgIGVudHJ5ID0gYnVmOworICAgIGlmICghKGVudHJ5LT5mbGFncyAm
IFhFTl9IWVBGU19XUklURUFCTEUpKSB7CisgICAgICAgIGVycm5vID0gRUFDQ0VTOworICAgICAg
ICBnb3RvIG91dDsKKyAgICB9CisgICAgaWYgKGVudHJ5LT5lbmNvZGluZyAhPSBYRU5fSFlQRlNf
RU5DX1BMQUlOKSB7CisgICAgICAgIC8qIFdyaXRpbmcgY29tcHJlc3NlZCBkYXRhIGN1cnJlbnRs
eSBub3Qgc3VwcG9ydGVkLiAqLworICAgICAgICBlcnJubyA9IEVET007CisgICAgICAgIGdvdG8g
b3V0OworICAgIH0KKworICAgIHN3aXRjaCAoZW50cnktPnR5cGUpIHsKKyAgICBjYXNlIFhFTl9I
WVBGU19UWVBFX1NUUklORzoKKyAgICAgICAgaWYgKHN6IDwgc3RybGVuKHZhbCkgKyAxKSB7Cisg
ICAgICAgICAgICBzeiA9IHN0cmxlbih2YWwpICsgMTsKKyAgICAgICAgICAgIHhlbmNhbGxfZnJl
ZV9idWZmZXIoZnNoZGwtPnhjYWxsLCBidWYpOworICAgICAgICAgICAgYnVmID0geGVuY2FsbF9h
bGxvY19idWZmZXIoZnNoZGwtPnhjYWxsLCBzeik7CisgICAgICAgICAgICBpZiAoIWJ1Zikgewor
ICAgICAgICAgICAgICAgIGVycm5vID0gRU5PTUVNOworICAgICAgICAgICAgICAgIGdvdG8gb3V0
OworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgICAgIHN0cmNweShidWYsIHZhbCk7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgWEVOX0hZUEZTX1RZUEVfVUlOVDoKKyAgICAgICAgc3og
PSBlbnRyeS0+Y29udGVudF9sZW47CisgICAgICAgIGVycm5vID0gMDsKKyAgICAgICAgKih1bnNp
Z25lZCBsb25nIGxvbmcgKilidWYgPSBzdHJ0b3VsbCh2YWwsICZ2YWxfZW5kLCAwKTsKKyAgICAg
ICAgaWYgKGVycm5vIHx8ICEqdmFsIHx8ICp2YWxfZW5kKQorICAgICAgICAgICAgZ290byBvdXQ7
CisgICAgICAgIG1hc2sgPSB+MFVMTCA8PCAoOCAqIHN6KTsKKyAgICAgICAgaWYgKCgqKHVpbnQ2
NF90ICopYnVmICYgbWFzaykgJiYgKCgqKHVpbnQ2NF90ICopYnVmICYgbWFzaykgIT0gbWFzaykp
IHsKKyAgICAgICAgICAgIGVycm5vID0gRVJBTkdFOworICAgICAgICAgICAgZ290byBvdXQ7Cisg
ICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBYRU5fSFlQRlNfVFlQRV9JTlQ6Cisg
ICAgICAgIHN6ID0gZW50cnktPmNvbnRlbnRfbGVuOworICAgICAgICBlcnJubyA9IDA7CisgICAg
ICAgICoodW5zaWduZWQgbG9uZyBsb25nICopYnVmID0gc3RydG9sbCh2YWwsICZ2YWxfZW5kLCAw
KTsKKyAgICAgICAgaWYgKGVycm5vIHx8ICEqdmFsIHx8ICp2YWxfZW5kKQorICAgICAgICAgICAg
Z290byBvdXQ7CisgICAgICAgIG1hc2sgPSAoc3ogPT0gOCkgPyAwIDogfjBVTEwgPDwgKDggKiBz
eik7CisgICAgICAgIGlmICgoKih1aW50NjRfdCAqKWJ1ZiAmIG1hc2spICYmICgoKih1aW50NjRf
dCAqKWJ1ZiAmIG1hc2spICE9IG1hc2spKSB7CisgICAgICAgICAgICBlcnJubyA9IEVSQU5HRTsK
KyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGNh
c2UgWEVOX0hZUEZTX1RZUEVfQk9PTDoKKyAgICAgICAgKih1bnNpZ25lZCBsb25nIGxvbmcgKili
dWYgPSAwOworICAgICAgICBpZiAoIXN0cmNtcCh2YWwsICIxIikgfHwgIXN0cmNtcCh2YWwsICJv
biIpIHx8ICFzdHJjbXAodmFsLCAieWVzIikgfHwKKyAgICAgICAgICAgICFzdHJjbXAodmFsLCAi
dHJ1ZSIpIHx8ICFzdHJjbXAodmFsLCAiZW5hYmxlIikpCisgICAgICAgICAgICAqKHVuc2lnbmVk
IGxvbmcgbG9uZyAqKWJ1ZiA9IDE7CisgICAgICAgIGVsc2UgaWYgKHN0cmNtcCh2YWwsICIwIikg
JiYgc3RyY21wKHZhbCwgIm5vIikgJiYgc3RyY21wKHZhbCwgIm9mZiIpICYmCisgICAgICAgICAg
ICAgICAgIHN0cmNtcCh2YWwsICJmYWxzZSIpICYmIHN0cmNtcCh2YWwsICJkaXNhYmxlIikpIHsK
KyAgICAgICAgICAgIGVycm5vID0gRURPTTsKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgICAg
ICB9CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIC8qIE5vIHN1cHBvcnQg
Zm9yIG90aGVyIHR5cGVzICh5ZXQpLiAqLworICAgICAgICBlcnJubyA9IEVET007CisgICAgICAg
IGdvdG8gb3V0OworICAgIH0KKworICAgIHJldCA9IHhlbmNhbGw1KGZzaGRsLT54Y2FsbCwgX19I
WVBFUlZJU09SX2h5cGZzX29wLAorICAgICAgICAgICAgICAgICAgIFhFTl9IWVBGU19PUF93cml0
ZV9jb250ZW50cywKKyAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZylwYXRoX2J1Ziwg
cGF0aF9zeiwKKyAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZylidWYsIHN6KTsKKwor
IG91dDoKKyAgICBzYXZlZF9lcnJubyA9IGVycm5vOworICAgIHhlbmNhbGxfZnJlZV9idWZmZXIo
ZnNoZGwtPnhjYWxsLCBwYXRoX2J1Zik7CisgICAgeGVuY2FsbF9mcmVlX2J1ZmZlcihmc2hkbC0+
eGNhbGwsIGJ1Zik7CisgICAgZXJybm8gPSBzYXZlZF9lcnJubzsKKyAgICByZXR1cm4gcmV0Owor
fQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlicy9oeXBmcy9pbmNsdWRlL3hlbmh5cGZzLmggYi90b29s
cy9saWJzL2h5cGZzL2luY2x1ZGUveGVuaHlwZnMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwLi4yOWM2OTcxMmNlCi0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvbGlicy9o
eXBmcy9pbmNsdWRlL3hlbmh5cGZzLmgKQEAgLTAsMCArMSw3NSBAQAorLyoKKyAqIENvcHlyaWdo
dCAoYykgMjAxOSBTVVNFIFNvZnR3YXJlIFNvbHV0aW9ucyBHZXJtYW55IEdtYkgKKyAqCisgKiBU
aGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5k
L29yCisgKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVy
YWwgUHVibGljCisgKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBG
b3VuZGF0aW9uOworICogdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UuCisgKgorICogVGhpcyBs
aWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWws
CisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3
YXJyYW50eSBvZgorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxB
UiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisgKgorICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29w
eSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICogTGljZW5zZSBhbG9uZyB3aXRo
IHRoaXMgbGlicmFyeTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+
LgorICovCisjaWZuZGVmIFhFTkhZUEZTX0gKKyNkZWZpbmUgWEVOSFlQRlNfSAorCisjaW5jbHVk
ZSA8c3RkYm9vbC5oPgorI2luY2x1ZGUgPHN0ZGludC5oPgorI2luY2x1ZGUgPHN5cy90eXBlcy5o
PgorCisvKiBDYWxsZXJzIHdobyBkb24ndCBjYXJlIGRvbid0IG5lZWQgdG8gI2luY2x1ZGUgPHhl
bnRvb2xsb2cuaD4gKi8KK3N0cnVjdCB4ZW50b29sbG9nX2xvZ2dlcjsKKwordHlwZWRlZiBzdHJ1
Y3QgeGVuaHlwZnNfaGFuZGxlIHhlbmh5cGZzX2hhbmRsZTsKKworc3RydWN0IHhlbmh5cGZzX2Rp
cmVudCB7CisgICAgY2hhciAqbmFtZTsKKyAgICBzaXplX3Qgc2l6ZTsKKyAgICBlbnVtIHsKKyAg
ICAgICAgeGVuaHlwZnNfdHlwZV9kaXIsCisgICAgICAgIHhlbmh5cGZzX3R5cGVfYmxvYiwKKyAg
ICAgICAgeGVuaHlwZnNfdHlwZV9zdHJpbmcsCisgICAgICAgIHhlbmh5cGZzX3R5cGVfdWludCwK
KyAgICAgICAgeGVuaHlwZnNfdHlwZV9pbnQsCisgICAgICAgIHhlbmh5cGZzX3R5cGVfYm9vbAor
ICAgIH0gdHlwZTsKKyAgICBlbnVtIHsKKyAgICAgICAgeGVuaHlwZnNfZW5jX3BsYWluLAorICAg
ICAgICB4ZW5oeXBmc19lbmNfZ3ppcAorICAgIH0gZW5jb2Rpbmc7CisgICAgYm9vbCBpc193cml0
YWJsZTsKK307CisKK3hlbmh5cGZzX2hhbmRsZSAqeGVuaHlwZnNfb3BlbihzdHJ1Y3QgeGVudG9v
bGxvZ19sb2dnZXIgKmxvZ2dlciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgb3Blbl9mbGFncyk7CitpbnQgeGVuaHlwZnNfY2xvc2UoeGVuaHlwZnNfaGFuZGxl
ICpmc2hkbCk7CisKKy8qIFJldHVybmVkIGJ1ZmZlciBhbmQgZGlyZW50IHNob3VsZCBiZSBmcmVl
ZCB2aWEgZnJlZSgpLiAqLwordm9pZCAqeGVuaHlwZnNfcmVhZF9yYXcoeGVuaHlwZnNfaGFuZGxl
ICpmc2hkbCwgY29uc3QgY2hhciAqcGF0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCB4ZW5oeXBmc19kaXJlbnQgKipkaXJlbnQpOworCisvKiBSZXR1cm5lZCBidWZmZXIgc2hvdWxk
IGJlIGZyZWVkIHZpYSBmcmVlKCkuICovCitjaGFyICp4ZW5oeXBmc19yZWFkKHhlbmh5cGZzX2hh
bmRsZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBhdGgpOworCisvKiBSZXR1cm5lZCBidWZmZXIgc2hv
dWxkIGJlIGZyZWVkIHZpYSBmcmVlKCkuICovCitzdHJ1Y3QgeGVuaHlwZnNfZGlyZW50ICp4ZW5o
eXBmc19yZWFkZGlyKHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKnBhdGgsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqbnVtX2VudHJpZXMpOworCitp
bnQgeGVuaHlwZnNfd3JpdGUoeGVuaHlwZnNfaGFuZGxlICpmc2hkbCwgY29uc3QgY2hhciAqcGF0
aCwgY29uc3QgY2hhciAqdmFsKTsKKworI2VuZGlmIC8qIFhFTkhZUEZTX0ggKi8KKworLyoKKyAq
IExvY2FsIHZhcmlhYmxlczoKKyAqIG1vZGU6IEMKKyAqIGMtZmlsZS1zdHlsZTogIkJTRCIKKyAq
IGMtYmFzaWMtb2Zmc2V0OiA0CisgKiB0YWItd2lkdGg6IDQKKyAqIGluZGVudC10YWJzLW1vZGU6
IG5pbAorICogRW5kOgorICovCmRpZmYgLS1naXQgYS90b29scy9saWJzL2h5cGZzL2xpYnhlbmh5
cGZzLm1hcCBiL3Rvb2xzL2xpYnMvaHlwZnMvbGlieGVuaHlwZnMubWFwCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAuLjQ3ZjFlZGRhM2UKLS0tIC9kZXYvbnVsbAorKysgYi90
b29scy9saWJzL2h5cGZzL2xpYnhlbmh5cGZzLm1hcApAQCAtMCwwICsxLDEwIEBACitWRVJTXzEu
MCB7CisJZ2xvYmFsOgorCQl4ZW5oeXBmc19vcGVuOworCQl4ZW5oeXBmc19jbG9zZTsKKwkJeGVu
aHlwZnNfcmVhZF9yYXc7CisJCXhlbmh5cGZzX3JlYWQ7CisJCXhlbmh5cGZzX3JlYWRkaXI7CisJ
CXhlbmh5cGZzX3dyaXRlOworCWxvY2FsOiAqOyAvKiBEbyBub3QgZXhwb3NlIGFueXRoaW5nIGJ5
IGRlZmF1bHQgKi8KK307CmRpZmYgLS1naXQgYS90b29scy9saWJzL2h5cGZzL3hlbmh5cGZzLnBj
LmluIGIvdG9vbHMvbGlicy9oeXBmcy94ZW5oeXBmcy5wYy5pbgpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwLi45MmEyNjJjN2EyCi0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMv
bGlicy9oeXBmcy94ZW5oeXBmcy5wYy5pbgpAQCAtMCwwICsxLDEwIEBACitwcmVmaXg9QEBwcmVm
aXhAQAoraW5jbHVkZWRpcj1AQGluY2RpckBACitsaWJkaXI9QEBsaWJkaXJAQAorCitOYW1lOiBY
ZW5oeXBmcworRGVzY3JpcHRpb246IFRoZSBYZW5oeXBmcyBsaWJyYXJ5IGZvciBYZW4gaHlwZXJ2
aXNvcgorVmVyc2lvbjogQEB2ZXJzaW9uQEAKK0NmbGFnczogLUkke2luY2x1ZGVkaXJ9IEBAY2Zs
YWdzbG9jYWxAQAorTGliczogQEBsaWJzZmxhZ0BAJHtsaWJkaXJ9IC1seGVuaHlwZnMKK1JlcXVp
cmVzLnByaXZhdGU6IHhlbnRvb2xjb3JlLHhlbnRvb2xsb2cseGVuY2FsbCx6Ci0tIAoyLjE2LjQK
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2
ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xp
c3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

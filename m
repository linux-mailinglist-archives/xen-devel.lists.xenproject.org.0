Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DDF42272BDE
	for <lists+xen-devel@lfdr.de>; Mon, 21 Sep 2020 18:25:41 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1kKOcQ-0002dA-AM; Mon, 21 Sep 2020 16:24:46 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=p/3p=C6=redhat.com=stefanha@srs-us1.protection.inumbo.net>)
 id 1kKOcN-0002d5-Pg
 for xen-devel@lists.xenproject.org; Mon, 21 Sep 2020 16:24:44 +0000
X-Inumbo-ID: 50208831-16b4-4fa2-88df-2e0036a69a25
Received: from us-smtp-1.mimecast.com (unknown [205.139.110.120])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTP
 id 50208831-16b4-4fa2-88df-2e0036a69a25;
 Mon, 21 Sep 2020 16:24:31 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1600705471;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:
 content-transfer-encoding:content-transfer-encoding;
 bh=SpF3rhTBlmxaHTu2ADfEloN5vapnda/yJkPgqJrwlfw=;
 b=Sel23dkFO0wvIcSp2nHo9FJ7s8FigBJqtBfBQTLgVw66bGfCInMfgiQ+Da5uWRviKiXzCM
 nHukUH4mQ+r10IOxc8x7+9hKdBCu684FFon50RXRadDfK8FQZ0IVEzjZmjFOKK1Ku0K7VG
 leFlc0psJQ/dK5H+pWzTEMf4xjMNUFo=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-226-oAYxgLFQMXKg_sKX0F8s9Q-1; Mon, 21 Sep 2020 12:24:14 -0400
X-MC-Unique: oAYxgLFQMXKg_sKX0F8s9Q-1
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 66B6B1017DC2;
 Mon, 21 Sep 2020 16:24:06 +0000 (UTC)
Received: from localhost (ovpn-112-39.ams2.redhat.com [10.36.112.39])
 by smtp.corp.redhat.com (Postfix) with ESMTP id C77575C1D0;
 Mon, 21 Sep 2020 16:23:47 +0000 (UTC)
From: Stefan Hajnoczi <stefanha@redhat.com>
To: qemu-devel@nongnu.org
Cc: qemu-riscv@nongnu.org, Fam Zheng <fam@euphon.net>,
 Yoshinori Sato <ysato@users.sourceforge.jp>,
 Alberto Garcia <berto@igalia.com>, Jiri Slaby <jslaby@suse.cz>,
 Richard Henderson <rth@twiddle.net>, Peter Lieven <pl@kamp.de>,
 David Hildenbrand <david@redhat.com>, Halil Pasic <pasic@linux.ibm.com>,
 Eric Blake <eblake@redhat.com>, Max Reitz <mreitz@redhat.com>,
 =?UTF-8?q?Marc-Andr=C3=A9=20Lureau?= <marcandre.lureau@redhat.com>,
 =?UTF-8?q?Daniel=20P=2E=20Berrang=C3=A9?= <berrange@redhat.com>,
 Palmer Dabbelt <palmer@dabbelt.com>, Markus Armbruster <armbru@redhat.com>,
 kvm@vger.kernel.org, Yuval Shaia <yuval.shaia.ml@gmail.com>,
 "Michael S. Tsirkin" <mst@redhat.com>, Cornelia Huck <cohuck@redhat.com>,
 qemu-block@nongnu.org, Stefan Weil <sw@weilnetz.de>,
 "Dr. David Alan Gilbert" <dgilbert@redhat.com>,
 Michael Roth <mdroth@linux.vnet.ibm.com>,
 Jiaxun Yang <jiaxun.yang@flygoat.com>, John Snow <jsnow@redhat.com>,
 Max Filippov <jcmvbkbc@gmail.com>,
 Marcel Apfelbaum <marcel.apfelbaum@gmail.com>,
 Alistair Francis <Alistair.Francis@wdc.com>,
 Aurelien Jarno <aurelien@aurel32.net>,
 Aleksandar Rikalo <aleksandar.rikalo@syrmia.com>,
 Huacai Chen <chenhc@lemote.com>,
 Aleksandar Markovic <aleksandar.qemu.devel@gmail.com>,
 Eduardo Habkost <ehabkost@redhat.com>,
 Christian Borntraeger <borntraeger@de.ibm.com>,
 Sunil Muthuswamy <sunilmut@microsoft.com>, Thomas Huth <thuth@redhat.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Anthony Perard <anthony.perard@citrix.com>,
 Gerd Hoffmann <kraxel@redhat.com>,
 Peter Maydell <peter.maydell@linaro.org>, Liu Yuan <namei.unix@gmail.com>,
 Paul Durrant <paul@xen.org>, Stefan Hajnoczi <stefanha@redhat.com>,
 Kevin Wolf <kwolf@redhat.com>,
 Bastian Koppelmann <kbastian@mail.uni-paderborn.de>,
 Sagar Karandikar <sagark@eecs.berkeley.edu>,
 Jason Wang <jasowang@redhat.com>, Laurent Vivier <laurent@vivier.eu>,
 xen-devel@lists.xenproject.org, Matthew Rosato <mjrosato@linux.ibm.com>,
 sheepdog@lists.wpkg.org, qemu-s390x@nongnu.org, qemu-arm@nongnu.org,
 Juan Quintela <quintela@redhat.com>,
 Hailiang Zhang <zhang.zhanghailiang@huawei.com>
Subject: [PATCH] qemu/atomic.h: prefix qemu_ to solve <stdatomic.h> collisions
Date: Mon, 21 Sep 2020 17:23:46 +0100
Message-Id: <20200921162346.188997-1-stefanha@redhat.com>
MIME-Version: 1.0
Content-Transfer-Encoding: base64
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Y2xhbmcncyBDMTEgYXRvbWljX2ZldGNoXyooKSBmdW5jdGlvbnMgb25seSB0YWtlIGEgQzExIGF0
b21pYyB0eXBlCnBvaW50ZXIgYXJndW1lbnQuIFFFTVUgdXNlcyBkaXJlY3QgdHlwZXMgKGludCwg
ZXRjKSBhbmQgdGhpcyBjYXVzZXMgYQpjb21waWxlciBlcnJvciB3aGVuIGEgUUVNVSBjb2RlIGNh
bGxzIHRoZXNlIGZ1bmN0aW9ucyBpbiBhIHNvdXJjZSBmaWxlCnRoYXQgYWxzbyBpbmNsdWRlZCA8
c3RkYXRvbWljLmg+IHZpYSBhIHN5c3RlbSBoZWFkZXIgZmlsZToKCiAgJCBDQz1jbGFuZyBDWFg9
Y2xhbmcrKyAuL2NvbmZpZ3VyZSAuLi4gJiYgbWFrZQogIC4uL3V0aWwvYXN5bmMuYzo3OToxNzog
ZXJyb3I6IGFkZHJlc3MgYXJndW1lbnQgdG8gYXRvbWljIG9wZXJhdGlvbiBtdXN0IGJlIGEgcG9p
bnRlciB0byBfQXRvbWljIHR5cGUgKCd1bnNpZ25lZCBpbnQgKicgaW52YWxpZCkKCkF2b2lkIHVz
aW5nIGF0b21pY18qKCkgbmFtZXMgaW4gUUVNVSdzIGF0b21pYy5oIHNpbmNlIHRoYXQgbmFtZXNw
YWNlIGlzCnVzZWQgYnkgPHN0ZGF0b21pYy5oPi4gUHJlZml4IFFFTVUncyBBUElzIHdpdGggcWVt
dV8gc28gdGhhdCBhdG9taWMuaAphbmQgPHN0ZGF0b21pYy5oPiBjYW4gY28tZXhpc3QuCgpUaGlz
IHBhdGNoIHdhcyBnZW5lcmF0ZWQgdXNpbmc6CgogICQgZ2l0IGRpZmYgfCBncmVwIC1vICdcPGF0
b21pY19bYS16MC05X11cKycgfCBzb3J0IC11ID4vdG1wL2NoYW5nZWRfaWRlbnRpZmllcnMKICAk
IGZvciBpZGVudGlmaWVyIGluICQoPC90bXAvY2hhbmdlZF9pZGVudGlmaWVyczY0KTsgZG8gXAog
ICAgICAgc2VkIC1pICJzJVw8JGlkZW50aWZpZXJcPiVxZW11XyRpZGVudGlmaWVyJSIgJChnaXQg
Z3JlcCAtbCAiXDwkaWRlbnRpZmllclw+IikgXAogICAgZG9uZQoKSSBtYW51YWxseSBmaXhlZCBs
aW5lLXdyYXAgaXNzdWVzIGFuZCBtaXNhbGlnbmVkIHJTVCB0YWJsZXMuCgpTaWduZWQtb2ZmLWJ5
OiBTdGVmYW4gSGFqbm9jemkgPHN0ZWZhbmhhQHJlZGhhdC5jb20+Ci0tLQogZG9jcy9kZXZlbC9s
b2NrY250LnR4dCAgICAgICAgICAgICAgICAgICAgICAgIHwgIDE0ICstCiBkb2NzL2RldmVsL3Jj
dS50eHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgNDAgKy0tCiBhY2NlbC90Y2cvYXRv
bWljX3RlbXBsYXRlLmggICAgICAgICAgICAgICAgICAgfCAgMjAgKy0KIGluY2x1ZGUvYmxvY2sv
YWlvLXdhaXQuaCAgICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogaW5jbHVkZS9ibG9jay9h
aW8uaCAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA4ICstCiBpbmNsdWRlL2V4ZWMvY3B1
X2xkc3QuaCAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGluY2x1ZGUvZXhlYy9leGVj
LWFsbC5oICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogaW5jbHVkZS9leGVjL2xvZy5o
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA2ICstCiBpbmNsdWRlL2V4ZWMvbWVtb3J5
LmggICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGluY2x1ZGUvZXhlYy9yYW1fYWRk
ci5oICAgICAgICAgICAgICAgICAgICAgICB8ICAyNyArLQogaW5jbHVkZS9leGVjL3JhbWxpc3Qu
aCAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiBpbmNsdWRlL2V4ZWMvdGItbG9va3Vw
LmggICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIGluY2x1ZGUvaHcvY29yZS9jcHUuaCAg
ICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogaW5jbHVkZS9xZW11L2F0b21pYy5oICAg
ICAgICAgICAgICAgICAgICAgICAgIHwgMjU4ICsrKysrKystLS0tLS0tCiBpbmNsdWRlL3FlbXUv
YXRvbWljMTI4LmggICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIGluY2x1ZGUvcWVtdS9i
aXRvcHMuaCAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogaW5jbHVkZS9xZW11L2Nv
cm91dGluZS5oICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiBpbmNsdWRlL3FlbXUvbG9n
LmggICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIGluY2x1ZGUvcWVtdS9xdWV1
ZS5oICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgOCArLQogaW5jbHVkZS9xZW11L3JjdS5o
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEwICstCiBpbmNsdWRlL3FlbXUvcmN1X3F1
ZXVlLmggICAgICAgICAgICAgICAgICAgICAgfCAxMDMgKysrLS0tCiBpbmNsdWRlL3FlbXUvc2Vx
bG9jay5oICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDggKy0KIGluY2x1ZGUvcWVtdS9zdGF0
czY0LmggICAgICAgICAgICAgICAgICAgICAgICB8ICAyOCArLQogaW5jbHVkZS9xZW11L3RocmVh
ZC5oICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDM3ICstCiAuLi4vaW5maW5pYmFuZC9ody92
bXdfcHZyZG1hL3B2cmRtYV9yaW5nLmggICAgfCAgMTQgKy0KIGxpbnV4LXVzZXIvcWVtdS5oICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogdGNnL2kzODYvdGNnLXRhcmdldC5o
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0Y2cvczM5MC90Y2ctdGFyZ2V0Lmgg
ICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIHRjZy90Y2kvdGNnLXRhcmdldC5oICAg
ICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogYWNjZWwva3ZtL2t2bS1hbGwuYyAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwgIDEyICstCiBhY2NlbC90Y2cvY3B1LWV4ZWMuYyAgICAg
ICAgICAgICAgICAgICAgICAgICAgfCAgMTYgKy0KIGFjY2VsL3RjZy9jcHV0bGIuYyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8ICAyNCArLQogYWNjZWwvdGNnL3RjZy1hbGwuYyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgICAyICstCiBhY2NlbC90Y2cvdHJhbnNsYXRlLWFsbC5jICAg
ICAgICAgICAgICAgICAgICAgfCAgNTYgKy0tCiBhdWRpby9qYWNrYXVkaW8uYyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgMjAgKy0KIGJsb2NrLmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgNCArLQogYmxvY2svYmxvY2stYmFja2VuZC5jICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgIDE1ICstCiBibG9jay9pby5jICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgNDggKy0tCiBibG9jay9uZnMuYyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDIgKy0KIGJsb2NrL3NoZWVwZG9nLmMgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8ICAgMiArLQogYmxvY2svdGhyb3R0bGUtZ3JvdXBzLmMgICAgICAgICAg
ICAgICAgICAgICAgIHwgIDEzICstCiBibG9jay90aHJvdHRsZS5jICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfCAgIDQgKy0KIGJsb2NrZGV2LmMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgMiArLQogYmxvY2tqb2IuYyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgICAyICstCiBjb250cmliL2xpYnZob3N0LXVzZXIvbGlidmhvc3QtdXNlci5j
ICAgICAgICAgfCAgIDIgKy0KIGNwdXMtY29tbW9uLmMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8ICAyNiArLQogZHVtcC9kdW1wLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgICA4ICstCiBleGVjLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgNDkgKy0tCiBody9jb3JlL2NwdS5jICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgIDYgKy0KIGh3L2Rpc3BsYXkvcXhsLmMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8ICAgNyArLQogaHcvaHlwZXJ2L2h5cGVydi5jICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHwgIDExICstCiBody9oeXBlcnYvdm1idXMuYyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgIDIgKy0KIGh3L2kzODYveGVuL3hlbi1odm0uYyAgICAgICAgICAgICAgICAgICAgICAg
ICB8ICAgMiArLQogaHcvaW50Yy9yeF9pY3UuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgIDEyICstCiBody9pbnRjL3NpZml2ZV9wbGljLmMgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgIDQgKy0KIGh3L21pc2MvZWR1LmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAxNiArLQogaHcvbmV0L3ZpcnRpby1uZXQuYyAgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
IDEwICstCiBody9yZG1hL3JkbWFfYmFja2VuZC5jICAgICAgICAgICAgICAgICAgICAgICAgfCAg
MTkgKy0KIGh3L3JkbWEvcmRtYV9ybS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAg
MiArLQogaHcvcmRtYS92bXcvcHZyZG1hX2Rldl9yaW5nLmMgICAgICAgICAgICAgICAgIHwgICA0
ICstCiBody9zMzkweC9zMzkwLXBjaS1idXMuYyAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIg
Ky0KIGh3L3MzOTB4L3ZpcnRpby1jY3cuYyAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiAr
LQogaHcvdmlydGlvL3Zob3N0LmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICst
CiBody92aXJ0aW8vdmlydGlvLW1taW8uYyAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0K
IGh3L3ZpcnRpby92aXJ0aW8tcGNpLmMgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQog
aHcvdmlydGlvL3ZpcnRpby5jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDE2ICstCiBo
dy94dGVuc2EvcGljX2NwdS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIGlv
dGhyZWFkLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogbGlu
dXgtdXNlci9ocHBhL2NwdV9sb29wLmMgICAgICAgICAgICAgICAgICAgIHwgIDExICstCiBsaW51
eC11c2VyL3NpZ25hbC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDggKy0KIG1pZ3Jh
dGlvbi9jb2xvLWZhaWxvdmVyLmMgICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogbWlncmF0
aW9uL21pZ3JhdGlvbi5jICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA4ICstCiBtaWdyYXRp
b24vbXVsdGlmZC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMTggKy0KIG1pZ3JhdGlv
bi9wb3N0Y29weS1yYW0uYyAgICAgICAgICAgICAgICAgICAgICB8ICAzNSArLQogbWlncmF0aW9u
L3JkbWEuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDM0ICstCiBtb25pdG9yL2ht
cC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIG1vbml0b3IvbWlz
Yy5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgMiArLQogbW9uaXRvci9tb25p
dG9yLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA2ICstCiBxZW11LW5iZC5jICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIHFnYS9jb21tYW5kcy5j
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAxMiArLQogcW9tL29iamVjdC5jICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDIwICstCiBzY3NpL3FlbXUtcHItaGVs
cGVyLmMgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIHNvZnRtbXUvY3B1LXRocm90
dGxlLmMgICAgICAgICAgICAgICAgICAgICAgICB8ICAxMCArLQogc29mdG1tdS9jcHVzLmMgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDQyICstLQogc29mdG1tdS9tZW1vcnkuYyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICA2ICstCiBzb2Z0bW11L3ZsLmMgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIHRhcmdldC9hcm0vbXRlX2hlbHBl
ci5jICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogdGFyZ2V0L2hwcGEvb3BfaGVscGVy
LmMgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0YXJnZXQvaTM4Ni9tZW1faGVscGVy
LmMgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIHRhcmdldC9pMzg2L3docHgtYWxsLmMg
ICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogdGFyZ2V0L3Jpc2N2L2NwdV9oZWxwZXIu
YyAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0YXJnZXQvczM5MHgvbWVtX2hlbHBlci5j
ICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KIHRhcmdldC94dGVuc2EvZXhjX2hlbHBlci5j
ICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQogdGFyZ2V0L3h0ZW5zYS9vcF9oZWxwZXIuYyAg
ICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0Y2cvdGNnLmMgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgNTkgKystLQogdGNnL3RjaS5jICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0ZXN0cy9hdG9taWM2NC1iZW5jaC5jICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgMTQgKy0KIHRlc3RzL2F0b21pY19hZGQtYmVuY2guYyAgICAg
ICAgICAgICAgICAgICAgICB8ICAxNCArLQogdGVzdHMvaW90aHJlYWQuYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAyICstCiB0ZXN0cy9xaHQtYmVuY2guYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgMTIgKy0KIHRlc3RzL3JjdXRvcnR1cmUuYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8ICAyNCArLQogdGVzdHMvdGVzdC1haW8tbXVsdGl0aHJlYWQuYyAgICAg
ICAgICAgICAgICAgIHwgIDUyICstLQogdGVzdHMvdGVzdC1sb2dnaW5nLmMgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgICA0ICstCiB0ZXN0cy90ZXN0LXJjdS1saXN0LmMgICAgICAgICAgICAg
ICAgICAgICAgICAgfCAgMzggKy0KIHRlc3RzL3Rlc3QtdGhyZWFkLXBvb2wuYyAgICAgICAgICAg
ICAgICAgICAgICB8ICAxMCArLQogdXRpbC9haW8tcG9zaXguYyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgIDE1ICstCiB1dGlsL2Fpby13YWl0LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgIDIgKy0KIHV0aWwvYWlvLXdpbjMyLmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8ICAgNiArLQogdXRpbC9hc3luYy5jICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgIDM3ICstCiB1dGlsL2F0b21pYzY0LmMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgMTAgKy0KIHV0aWwvYml0bWFwLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8ICAxNCArLQogdXRpbC9jYWNoZWluZm8uYyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHwgICAyICstCiB1dGlsL2ZkbW9uLWVwb2xsLmMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgIDQgKy0KIHV0aWwvZmRtb24taW9fdXJpbmcuYyAgICAgICAgICAgICAgICAgICAgICAg
ICB8ICAxMyArLQogdXRpbC9sb2NrY250LmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgIDU5ICsrLS0KIHV0aWwvbG9nLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8ICAxMCArLQogdXRpbC9xZW11LWNvcm91dGluZS1sb2NrLmMgICAgICAgICAgICAgICAgICAg
IHwgIDE5ICstCiB1dGlsL3FlbXUtY29yb3V0aW5lLXNsZWVwLmMgICAgICAgICAgICAgICAgICAg
fCAgIDQgKy0KIHV0aWwvcWVtdS1jb3JvdXRpbmUuYyAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAgNiArLQogdXRpbC9xZW11LXNvY2tldHMuYyAgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
ICA0ICstCiB1dGlsL3FlbXUtdGhyZWFkLXBvc2l4LmMgICAgICAgICAgICAgICAgICAgICAgfCAg
MTIgKy0KIHV0aWwvcWVtdS10aHJlYWQtd2luMzIuYyAgICAgICAgICAgICAgICAgICAgICB8ICAx
MiArLQogdXRpbC9xZW11LXRpbWVyLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDEy
ICstCiB1dGlsL3FodC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgNTcg
Ky0tCiB1dGlsL3FzcC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgNTAg
Ky0tCiB1dGlsL3JjdS5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgMzYg
Ky0KIHV0aWwvc3RhdHM2NC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAzNCAr
LQogZG9jcy9kZXZlbC9hdG9taWNzLnJzdCAgICAgICAgICAgICAgICAgICAgICAgIHwgMzI2ICsr
KysrKysrKy0tLS0tLS0tLQogLi4uL29wZW5zYmktcmlzY3YzMi1nZW5lcmljLWZ3X2R5bmFtaWMu
ZWxmICAgIHwgQmluIDU1ODY2OCAtPiA1NTg2OTggYnl0ZXMKIC4uLi9vcGVuc2JpLXJpc2N2NjQt
Z2VuZXJpYy1md19keW5hbWljLmVsZiAgICB8IEJpbiA2MjA0MjQgLT4gNjIwNDU0IGJ5dGVzCiBz
Y3JpcHRzL2tlcm5lbC1kb2MgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIHRj
Zy9hYXJjaDY0L3RjZy10YXJnZXQuYy5pbmMgICAgICAgICAgICAgICAgICB8ICAgMiArLQogdGNn
L21pcHMvdGNnLXRhcmdldC5jLmluYyAgICAgICAgICAgICAgICAgICAgIHwgICAyICstCiB0Y2cv
cHBjL3RjZy10YXJnZXQuYy5pbmMgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIHRjZy9z
cGFyYy90Y2ctdGFyZ2V0LmMuaW5jICAgICAgICAgICAgICAgICAgICB8ICAgNSArLQogMTM1IGZp
bGVzIGNoYW5nZWQsIDExOTUgaW5zZXJ0aW9ucygrKSwgMTEzMCBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9kb2NzL2RldmVsL2xvY2tjbnQudHh0IGIvZG9jcy9kZXZlbC9sb2NrY250LnR4dApp
bmRleCA3YzA5OWJjNmM4Li5kYzkyOGY4NWY5IDEwMDY0NAotLS0gYS9kb2NzL2RldmVsL2xvY2tj
bnQudHh0CisrKyBiL2RvY3MvZGV2ZWwvbG9ja2NudC50eHQKQEAgLTk1LDEwICs5NSwxMCBAQCBu
b3QganVzdCBmcmVlcywgdGhvdWdoIHRoZXJlIGNvdWxkIGJlIGNhc2VzIHdoZXJlIHRoaXMgaXMg
bm90IG5lY2Vzc2FyeS4KIAogUmVhZHMsIGluc3RlYWQsIGNhbiBiZSBkb25lIHdpdGhvdXQgdGFr
aW5nIHRoZSBtdXRleCwgYXMgbG9uZyBhcyB0aGUKIHJlYWRlcnMgYW5kIHdyaXRlcnMgdXNlIHRo
ZSBzYW1lIG1hY3JvcyB0aGF0IGFyZSB1c2VkIGZvciBSQ1UsIGZvcgotZXhhbXBsZSBhdG9taWNf
cmN1X3JlYWQsIGF0b21pY19yY3Vfc2V0LCBRTElTVF9GT1JFQUNIX1JDVSwgZXRjLiAgVGhpcyBp
cwotYmVjYXVzZSB0aGUgcmVhZHMgYXJlIGRvbmUgb3V0c2lkZSBhIGxvY2sgYW5kIGEgc2V0IG9y
IFFMSVNUX0lOU0VSVF9IRUFECi1jYW4gaGFwcGVuIGNvbmN1cnJlbnRseSB3aXRoIHRoZSByZWFk
LiAgVGhlIFJDVSBBUEkgZW5zdXJlcyB0aGF0IHRoZQotcHJvY2Vzc29yIGFuZCB0aGUgY29tcGls
ZXIgc2VlIGFsbCByZXF1aXJlZCBtZW1vcnkgYmFycmllcnMuCitleGFtcGxlIHFlbXVfYXRvbWlj
X3JjdV9yZWFkLCBxZW11X2F0b21pY19yY3Vfc2V0LCBRTElTVF9GT1JFQUNIX1JDVSwgZXRjLgor
VGhpcyBpcyBiZWNhdXNlIHRoZSByZWFkcyBhcmUgZG9uZSBvdXRzaWRlIGEgbG9jayBhbmQgYSBz
ZXQgb3IKK1FMSVNUX0lOU0VSVF9IRUFEIGNhbiBoYXBwZW4gY29uY3VycmVudGx5IHdpdGggdGhl
IHJlYWQuICBUaGUgUkNVIEFQSSBlbnN1cmVzCit0aGF0IHRoZSBwcm9jZXNzb3IgYW5kIHRoZSBj
b21waWxlciBzZWUgYWxsIHJlcXVpcmVkIG1lbW9yeSBiYXJyaWVycy4KIAogVGhpcyBjb3VsZCBi
ZSBpbXBsZW1lbnRlZCBzaW1wbHkgYnkgcHJvdGVjdGluZyB0aGUgY291bnRlciB3aXRoIHRoZQog
bXV0ZXgsIGZvciBleGFtcGxlOgpAQCAtMTg5LDcgKzE4OSw3IEBAIHFlbXVfbG9ja2NudF9sb2Nr
IGFuZCBxZW11X2xvY2tjbnRfdW5sb2NrOgogICAgIGlmICgheHl6KSB7CiAgICAgICAgIG5ld194
eXogPSBnX25ldyhYWVosIDEpOwogICAgICAgICAuLi4KLSAgICAgICAgYXRvbWljX3JjdV9zZXQo
Jnh5eiwgbmV3X3h5eik7CisgICAgICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoJnh5eiwgbmV3X3h5
eik7CiAgICAgfQogICAgIHFlbXVfbG9ja2NudF91bmxvY2soJnh5el9sb2NrY250KTsKIApAQCAt
MTk4LDcgKzE5OCw3IEBAIHFlbXVfbG9ja2NudF9kZWM6CiAKICAgICBxZW11X2xvY2tjbnRfaW5j
KCZ4eXpfbG9ja2NudCk7CiAgICAgaWYgKHh5eikgewotICAgICAgICBYWVogKnAgPSBhdG9taWNf
cmN1X3JlYWQoJnh5eik7CisgICAgICAgIFhZWiAqcCA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZ4
eXopOwogICAgICAgICAuLi4KICAgICAgICAgLyogQWNjZXNzZXMgY2FuIG5vdyBiZSBkb25lIHRo
cm91Z2ggInAiLiAgKi8KICAgICB9CkBAIC0yMjIsNyArMjIyLDcgQEAgdGhlIGRlY3JlbWVudCwg
dGhlIGxvY2tpbmcgYW5kIHRoZSBjaGVjayBvbiBjb3VudCBhcyBmb2xsb3dzOgogCiAgICAgcWVt
dV9sb2NrY250X2luYygmeHl6X2xvY2tjbnQpOwogICAgIGlmICh4eXopIHsKLSAgICAgICAgWFla
ICpwID0gYXRvbWljX3JjdV9yZWFkKCZ4eXopOworICAgICAgICBYWVogKnAgPSBxZW11X2F0b21p
Y19yY3VfcmVhZCgmeHl6KTsKICAgICAgICAgLi4uCiAgICAgICAgIC8qIEFjY2Vzc2VzIGNhbiBu
b3cgYmUgZG9uZSB0aHJvdWdoICJwIi4gICovCiAgICAgfQpkaWZmIC0tZ2l0IGEvZG9jcy9kZXZl
bC9yY3UudHh0IGIvZG9jcy9kZXZlbC9yY3UudHh0CmluZGV4IDBjZTE1YmExOTguLmQwNDc5MWM5
MTUgMTAwNjQ0Ci0tLSBhL2RvY3MvZGV2ZWwvcmN1LnR4dAorKysgYi9kb2NzL2RldmVsL3JjdS50
eHQKQEAgLTEzMCwxMyArMTMwLDEzIEBAIFRoZSBjb3JlIFJDVSBBUEkgaXMgc21hbGw6CiAKICAg
ICAgICAgICAgIGdfZnJlZV9yY3UoJmZvbywgcmN1KTsKIAotICAgICB0eXBlb2YoKnApIGF0b21p
Y19yY3VfcmVhZChwKTsKKyAgICAgdHlwZW9mKCpwKSBxZW11X2F0b21pY19yY3VfcmVhZChwKTsK
IAotICAgICAgICBhdG9taWNfcmN1X3JlYWQoKSBpcyBzaW1pbGFyIHRvIGF0b21pY19sb2FkX2Fj
cXVpcmUoKSwgYnV0IGl0IG1ha2VzCi0gICAgICAgIHNvbWUgYXNzdW1wdGlvbnMgb24gdGhlIGNv
ZGUgdGhhdCBjYWxscyBpdC4gIFRoaXMgYWxsb3dzIGEgbW9yZQorCXFlbXVfYXRvbWljX3JjdV9y
ZWFkKCkgaXMgc2ltaWxhciB0byBxZW11X2F0b21pY19sb2FkX2FjcXVpcmUoKSwgYnV0IGl0CisJ
bWFrZXMgc29tZSBhc3N1bXB0aW9ucyBvbiB0aGUgY29kZSB0aGF0IGNhbGxzIGl0LiAgVGhpcyBh
bGxvd3MgYSBtb3JlCiAgICAgICAgIG9wdGltaXplZCBpbXBsZW1lbnRhdGlvbi4KIAotICAgICAg
ICBhdG9taWNfcmN1X3JlYWQgYXNzdW1lcyB0aGF0IHdoZW5ldmVyIGEgc2luZ2xlIFJDVSBjcml0
aWNhbAorICAgICAgICBxZW11X2F0b21pY19yY3VfcmVhZCBhc3N1bWVzIHRoYXQgd2hlbmV2ZXIg
YSBzaW5nbGUgUkNVIGNyaXRpY2FsCiAgICAgICAgIHNlY3Rpb24gcmVhZHMgbXVsdGlwbGUgc2hh
cmVkIGRhdGEsIHRoZXNlIHJlYWRzIGFyZSBlaXRoZXIKICAgICAgICAgZGF0YS1kZXBlbmRlbnQg
b3IgbmVlZCBubyBvcmRlcmluZy4gIFRoaXMgaXMgYWxtb3N0IGFsd2F5cyB0aGUKICAgICAgICAg
Y2FzZSB3aGVuIHVzaW5nIFJDVSwgYmVjYXVzZSByZWFkLXNpZGUgY3JpdGljYWwgc2VjdGlvbnMg
dHlwaWNhbGx5CkBAIC0xNDQsNyArMTQ0LDcgQEAgVGhlIGNvcmUgUkNVIEFQSSBpcyBzbWFsbDoK
ICAgICAgICAgZXZlcnkgdXBkYXRlKSB1bnRpbCByZWFjaGluZyBhIGRhdGEgc3RydWN0dXJlIG9m
IGludGVyZXN0LAogICAgICAgICBhbmQgdGhlbiByZWFkIGZyb20gdGhlcmUuCiAKLSAgICAgICAg
UkNVIHJlYWQtc2lkZSBjcml0aWNhbCBzZWN0aW9ucyBtdXN0IHVzZSBhdG9taWNfcmN1X3JlYWQo
KSB0bworICAgICAgICBSQ1UgcmVhZC1zaWRlIGNyaXRpY2FsIHNlY3Rpb25zIG11c3QgdXNlIHFl
bXVfYXRvbWljX3JjdV9yZWFkKCkgdG8KICAgICAgICAgcmVhZCBkYXRhLCB1bmxlc3MgY29uY3Vy
cmVudCB3cml0ZXMgYXJlIHByZXZlbnRlZCBieSBhbm90aGVyCiAgICAgICAgIHN5bmNocm9uaXph
dGlvbiBtZWNoYW5pc20uCiAKQEAgLTE1MiwxOCArMTUyLDE4IEBAIFRoZSBjb3JlIFJDVSBBUEkg
aXMgc21hbGw6CiAgICAgICAgIGRhdGEgc3RydWN0dXJlIGluIGEgc2luZ2xlIGRpcmVjdGlvbiwg
b3Bwb3NpdGUgdG8gdGhlIGRpcmVjdGlvbgogICAgICAgICBpbiB3aGljaCB0aGUgdXBkYXRlciBp
bml0aWFsaXplcyBpdC4KIAotICAgICB2b2lkIGF0b21pY19yY3Vfc2V0KHAsIHR5cGVvZigqcCkg
dik7CisgICAgIHZvaWQgcWVtdV9hdG9taWNfcmN1X3NldChwLCB0eXBlb2YoKnApIHYpOwogCi0g
ICAgICAgIGF0b21pY19yY3Vfc2V0KCkgaXMgc2ltaWxhciB0byBhdG9taWNfc3RvcmVfcmVsZWFz
ZSgpLCB0aG91Z2ggaXQgYWxzbwotICAgICAgICBtYWtlcyBhc3N1bXB0aW9ucyBvbiB0aGUgY29k
ZSB0aGF0IGNhbGxzIGl0IGluIG9yZGVyIHRvIGFsbG93IGEgbW9yZQotICAgICAgICBvcHRpbWl6
ZWQgaW1wbGVtZW50YXRpb24uCisJcWVtdV9hdG9taWNfcmN1X3NldCgpIGlzIHNpbWlsYXIgdG8g
cWVtdV9hdG9taWNfc3RvcmVfcmVsZWFzZSgpLCB0aG91Z2gKKwlpdCBhbHNvIG1ha2VzIGFzc3Vt
cHRpb25zIG9uIHRoZSBjb2RlIHRoYXQgY2FsbHMgaXQgaW4gb3JkZXIgdG8gYWxsb3cgYQorICAg
ICAgICBtb3JlIG9wdGltaXplZCBpbXBsZW1lbnRhdGlvbi4KIAotICAgICAgICBJbiBwYXJ0aWN1
bGFyLCBhdG9taWNfcmN1X3NldCgpIHN1ZmZpY2VzIGZvciBzeW5jaHJvbml6YXRpb24KKyAgICAg
ICAgSW4gcGFydGljdWxhciwgcWVtdV9hdG9taWNfcmN1X3NldCgpIHN1ZmZpY2VzIGZvciBzeW5j
aHJvbml6YXRpb24KICAgICAgICAgd2l0aCByZWFkZXJzLCBpZiB0aGUgdXBkYXRlciBuZXZlciBt
dXRhdGVzIGEgZmllbGQgd2l0aGluIGEKICAgICAgICAgZGF0YSBpdGVtIHRoYXQgaXMgYWxyZWFk
eSBhY2Nlc3NpYmxlIHRvIHJlYWRlcnMuICBUaGlzIGlzIHRoZQogICAgICAgICBjYXNlIHdoZW4g
aW5pdGlhbGl6aW5nIGEgbmV3IGNvcHkgb2YgdGhlIFJDVS1wcm90ZWN0ZWQgZGF0YQogICAgICAg
ICBzdHJ1Y3R1cmU7IGp1c3QgZW5zdXJlIHRoYXQgaW5pdGlhbGl6YXRpb24gb2YgKnAgaXMgY2Fy
cmllZCBvdXQKLSAgICAgICAgYmVmb3JlIGF0b21pY19yY3Vfc2V0KCkgbWFrZXMgdGhlIGRhdGEg
aXRlbSB2aXNpYmxlIHRvIHJlYWRlcnMuCisgICAgICAgIGJlZm9yZSBxZW11X2F0b21pY19yY3Vf
c2V0KCkgbWFrZXMgdGhlIGRhdGEgaXRlbSB2aXNpYmxlIHRvIHJlYWRlcnMuCiAgICAgICAgIElm
IHRoaXMgcnVsZSBpcyBvYnNlcnZlZCwgd3JpdGVzIHdpbGwgaGFwcGVuIGluIHRoZSBvcHBvc2l0
ZQogICAgICAgICBvcmRlciBhcyByZWFkcyBpbiB0aGUgUkNVIHJlYWQtc2lkZSBjcml0aWNhbCBz
ZWN0aW9ucyAob3IgaWYKICAgICAgICAgdGhlcmUgaXMganVzdCBvbmUgdXBkYXRlKSwgYW5kIHRo
ZXJlIHdpbGwgYmUgbm8gbmVlZCBmb3Igb3RoZXIKQEAgLTIxMiw3ICsyMTIsNyBAQCBESUZGRVJF
TkNFUyBXSVRIIExJTlVYCiAgIHByb2dyYW1taW5nOyBub3QgYWxsb3dpbmcgdGhpcyB3b3VsZCBw
cmV2ZW50IHVwZ3JhZGluZyBhbiBSQ1UgcmVhZC1zaWRlCiAgIGNyaXRpY2FsIHNlY3Rpb24gdG8g
YmVjb21lIGFuIHVwZGF0ZXIuCiAKLS0gYXRvbWljX3JjdV9yZWFkIGFuZCBhdG9taWNfcmN1X3Nl
dCByZXBsYWNlIHJjdV9kZXJlZmVyZW5jZSBhbmQKKy0gcWVtdV9hdG9taWNfcmN1X3JlYWQgYW5k
IHFlbXVfYXRvbWljX3JjdV9zZXQgcmVwbGFjZSByY3VfZGVyZWZlcmVuY2UgYW5kCiAgIHJjdV9h
c3NpZ25fcG9pbnRlci4gIFRoZXkgdGFrZSBhIF9wb2ludGVyXyB0byB0aGUgdmFyaWFibGUgYmVp
bmcgYWNjZXNzZWQuCiAKIC0gY2FsbF9yY3UgaXMgYSBtYWNybyB0aGF0IGhhcyBhbiBleHRyYSBh
cmd1bWVudCAodGhlIG5hbWUgb2YgdGhlIGZpcnN0CkBAIC0yNTcsNyArMjU3LDcgQEAgbWF5IGJl
IHVzZWQgYXMgYSByZXN0cmljdGVkIHJlZmVyZW5jZS1jb3VudGluZyBtZWNoYW5pc20uICBGb3Ig
ZXhhbXBsZSwKIGNvbnNpZGVyIHRoZSBmb2xsb3dpbmcgY29kZSBmcmFnbWVudDoKIAogICAgIHJj
dV9yZWFkX2xvY2soKTsKLSAgICBwID0gYXRvbWljX3JjdV9yZWFkKCZmb28pOworICAgIHAgPSBx
ZW11X2F0b21pY19yY3VfcmVhZCgmZm9vKTsKICAgICAvKiBkbyBzb21ldGhpbmcgd2l0aCBwLiAq
LwogICAgIHJjdV9yZWFkX3VubG9jaygpOwogCkBAIC0yNjgsNyArMjY4LDcgQEAgVGhlIHdyaXRl
IHNpZGUgbG9va3Mgc2ltcGx5IGxpa2UgdGhpcyAod2l0aCBhcHByb3ByaWF0ZSBsb2NraW5nKToK
IAogICAgIHFlbXVfbXV0ZXhfbG9jaygmZm9vX211dGV4KTsKICAgICBvbGQgPSBmb287Ci0gICAg
YXRvbWljX3JjdV9zZXQoJmZvbywgbmV3KTsKKyAgICBxZW11X2F0b21pY19yY3Vfc2V0KCZmb28s
IG5ldyk7CiAgICAgcWVtdV9tdXRleF91bmxvY2soJmZvb19tdXRleCk7CiAgICAgc3luY2hyb25p
emVfcmN1KCk7CiAgICAgZnJlZShvbGQpOwpAQCAtMjc3LDcgKzI3Nyw3IEBAIElmIHRoZSBwcm9j
ZXNzaW5nIGNhbm5vdCBiZSBkb25lIHB1cmVseSB3aXRoaW4gdGhlIGNyaXRpY2FsIHNlY3Rpb24s
IGl0CiBpcyBwb3NzaWJsZSB0byBjb21iaW5lIHRoaXMgaWRpb20gd2l0aCBhICJyZWFsIiByZWZl
cmVuY2UgY291bnQ6CiAKICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAgcCA9IGF0b21pY19yY3Vf
cmVhZCgmZm9vKTsKKyAgICBwID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJmZvbyk7CiAgICAgZm9v
X3JlZihwKTsKICAgICByY3VfcmVhZF91bmxvY2soKTsKICAgICAvKiBkbyBzb21ldGhpbmcgd2l0
aCBwLiAqLwpAQCAtMjg3LDcgKzI4Nyw3IEBAIFRoZSB3cml0ZSBzaWRlIGNhbiBiZSBsaWtlIHRo
aXM6CiAKICAgICBxZW11X211dGV4X2xvY2soJmZvb19tdXRleCk7CiAgICAgb2xkID0gZm9vOwot
ICAgIGF0b21pY19yY3Vfc2V0KCZmb28sIG5ldyk7CisgICAgcWVtdV9hdG9taWNfcmN1X3NldCgm
Zm9vLCBuZXcpOwogICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZmb29fbXV0ZXgpOwogICAgIHN5bmNo
cm9uaXplX3JjdSgpOwogICAgIGZvb191bnJlZihvbGQpOwpAQCAtMjk2LDcgKzI5Niw3IEBAIG9y
IHdpdGggY2FsbF9yY3U6CiAKICAgICBxZW11X211dGV4X2xvY2soJmZvb19tdXRleCk7CiAgICAg
b2xkID0gZm9vOwotICAgIGF0b21pY19yY3Vfc2V0KCZmb28sIG5ldyk7CisgICAgcWVtdV9hdG9t
aWNfcmN1X3NldCgmZm9vLCBuZXcpOwogICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZmb29fbXV0ZXgp
OwogICAgIGNhbGxfcmN1KGZvb191bnJlZiwgb2xkLCByY3UpOwogCkBAIC0zMDcsNyArMzA3LDcg
QEAgbGFzdCByZWZlcmVuY2UgbWF5IGJlIGRyb3BwZWQgb24gdGhlIHJlYWQgc2lkZS4gIEhlbmNl
IHlvdSBjYW4KIHVzZSBjYWxsX3JjdSgpIGluc3RlYWQ6CiAKICAgICAgZm9vX3VucmVmKHN0cnVj
dCBmb28gKnApIHsKLSAgICAgICAgaWYgKGF0b21pY19mZXRjaF9kZWMoJnAtPnJlZmNvdW50KSA9
PSAxKSB7CisgICAgICAgIGlmIChxZW11X2F0b21pY19mZXRjaF9kZWMoJnAtPnJlZmNvdW50KSA9
PSAxKSB7CiAgICAgICAgICAgICBjYWxsX3JjdShmb29fZGVzdHJveSwgcCwgcmN1KTsKICAgICAg
ICAgfQogICAgIH0KQEAgLTM3NSw3ICszNzUsNyBAQCBJbnN0ZWFkLCB3ZSBzdG9yZSB0aGUgc2l6
ZSBvZiB0aGUgYXJyYXkgd2l0aCB0aGUgYXJyYXkgaXRzZWxmOgogCiAgICAgcmVhZCBzaWRlOgog
ICAgICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAgICAgIHN0cnVjdCBhcnIgKmFycmF5ID0gYXRv
bWljX3JjdV9yZWFkKCZnbG9iYWxfYXJyYXkpOworICAgICAgICBzdHJ1Y3QgYXJyICphcnJheSA9
IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZnbG9iYWxfYXJyYXkpOwogICAgICAgICB4ID0gaSA8IGFy
cmF5LT5zaXplID8gYXJyYXktPmRhdGFbaV0gOiAtMTsKICAgICAgICAgcmN1X3JlYWRfdW5sb2Nr
KCk7CiAgICAgICAgIHJldHVybiB4OwpAQCAtMzkyLDcgKzM5Miw3IEBAIEluc3RlYWQsIHdlIHN0
b3JlIHRoZSBzaXplIG9mIHRoZSBhcnJheSB3aXRoIHRoZSBhcnJheSBpdHNlbGY6CiAKICAgICAg
ICAgICAgIC8qIFJlbW92YWwgcGhhc2UuICAqLwogICAgICAgICAgICAgb2xkX2FycmF5ID0gZ2xv
YmFsX2FycmF5OwotICAgICAgICAgICAgYXRvbWljX3JjdV9zZXQoJm5ld19hcnJheS0+ZGF0YSwg
bmV3X2FycmF5KTsKKyAgICAgICAgICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoJm5ld19hcnJheS0+
ZGF0YSwgbmV3X2FycmF5KTsKICAgICAgICAgICAgIHN5bmNocm9uaXplX3JjdSgpOwogCiAgICAg
ICAgICAgICAvKiBSZWNsYW1hdGlvbiBwaGFzZS4gICovCmRpZmYgLS1naXQgYS9hY2NlbC90Y2cv
YXRvbWljX3RlbXBsYXRlLmggYi9hY2NlbC90Y2cvYXRvbWljX3RlbXBsYXRlLmgKaW5kZXggMjY5
Njk0ODdkNi4uNmU5ZTIyMWY3OCAxMDA2NDQKLS0tIGEvYWNjZWwvdGNnL2F0b21pY190ZW1wbGF0
ZS5oCisrKyBiL2FjY2VsL3RjZy9hdG9taWNfdGVtcGxhdGUuaApAQCAtODMsNyArODMsNyBAQCBB
QklfVFlQRSBBVE9NSUNfTkFNRShjbXB4Y2hnKShDUFVBcmNoU3RhdGUgKmVudiwgdGFyZ2V0X3Vs
b25nIGFkZHIsCiAjaWYgREFUQV9TSVpFID09IDE2CiAgICAgcmV0ID0gYXRvbWljMTZfY21weGNo
ZyhoYWRkciwgY21wdiwgbmV3dik7CiAjZWxzZQotICAgIHJldCA9IGF0b21pY19jbXB4Y2hnX19u
b2NoZWNrKGhhZGRyLCBjbXB2LCBuZXd2KTsKKyAgICByZXQgPSBxZW11X2F0b21pY19jbXB4Y2hn
X19ub2NoZWNrKGhhZGRyLCBjbXB2LCBuZXd2KTsKICNlbmRpZgogICAgIEFUT01JQ19NTVVfQ0xF
QU5VUDsKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsKQEAgLTEz
MSw3ICsxMzEsNyBAQCBBQklfVFlQRSBBVE9NSUNfTkFNRSh4Y2hnKShDUFVBcmNoU3RhdGUgKmVu
diwgdGFyZ2V0X3Vsb25nIGFkZHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEFUT01JQ19NTVVfSURYKTsKIAogICAgIGF0b21pY190cmFjZV9ybXdfcHJlKGVudiwg
YWRkciwgaW5mbyk7Ci0gICAgcmV0ID0gYXRvbWljX3hjaGdfX25vY2hlY2soaGFkZHIsIHZhbCk7
CisgICAgcmV0ID0gcWVtdV9hdG9taWNfeGNoZ19fbm9jaGVjayhoYWRkciwgdmFsKTsKICAgICBB
VE9NSUNfTU1VX0NMRUFOVVA7CiAgICAgYXRvbWljX3RyYWNlX3Jtd19wb3N0KGVudiwgYWRkciwg
aW5mbyk7CiAgICAgcmV0dXJuIHJldDsKQEAgLTE0Nyw3ICsxNDcsNyBAQCBBQklfVFlQRSBBVE9N
SUNfTkFNRShYKShDUFVBcmNoU3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25nIGFkZHIsICAgICAgIFwK
ICAgICB1aW50MTZfdCBpbmZvID0gdHJhY2VfbWVtX2J1aWxkX2luZm8oU0hJRlQsIGZhbHNlLCAw
LCBmYWxzZSwgICAgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBB
VE9NSUNfTU1VX0lEWCk7ICAgICAgICAgICBcCiAgICAgYXRvbWljX3RyYWNlX3Jtd19wcmUoZW52
LCBhZGRyLCBpbmZvKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICByZXQgPSBhdG9t
aWNfIyNYKGhhZGRyLCB2YWwpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAor
ICAgIHJldCA9IHFlbXVfYXRvbWljXyMjWChoYWRkciwgdmFsKTsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCiAgICAgQVRPTUlDX01NVV9DTEVBTlVQOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52
LCBhZGRyLCBpbmZvKTsgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIHJldHVybiByZXQ7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCkBA
IC0xODIsMTAgKzE4MiwxMCBAQCBBQklfVFlQRSBBVE9NSUNfTkFNRShYKShDUFVBcmNoU3RhdGUg
KmVudiwgdGFyZ2V0X3Vsb25nIGFkZHIsICAgICAgIFwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgQVRPTUlDX01NVV9JRFgpOyAgICAgICAgICAgXAogICAgIGF0b21p
Y190cmFjZV9ybXdfcHJlKGVudiwgYWRkciwgaW5mbyk7ICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCiAgICAgc21wX21iKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKLSAgICBjbXAgPSBhdG9taWNfcmVhZF9fbm9jaGVjayhoYWRkcik7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIGNtcCA9IHFlbXVfYXRvbWljX3Jl
YWRfX25vY2hlY2soaGFkZHIpOyAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKICAgICAgICAgb2xkID0gY21wOyBuZXcgPSBGTihvbGQsIHZhbCk7ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAotICAgICAgICBjbXAgPSBhdG9taWNfY21weGNoZ19fbm9jaGVjayho
YWRkciwgb2xkLCBuZXcpOyAgICAgICAgICAgICBcCisgICAgICAgIGNtcCA9IHFlbXVfYXRvbWlj
X2NtcHhjaGdfX25vY2hlY2soaGFkZHIsIG9sZCwgbmV3KTsgICAgICAgIFwKICAgICB9IHdoaWxl
IChjbXAgIT0gb2xkKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAogICAgIEFUT01JQ19NTVVfQ0xFQU5VUDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCiAgICAgYXRvbWljX3RyYWNlX3Jtd19wb3N0KGVudiwgYWRkciwgaW5m
byk7ICAgICAgICAgICAgICAgICAgICAgICAgIFwKQEAgLTIzMCw3ICsyMzAsNyBAQCBBQklfVFlQ
RSBBVE9NSUNfTkFNRShjbXB4Y2hnKShDUFVBcmNoU3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25nIGFk
ZHIsCiAjaWYgREFUQV9TSVpFID09IDE2CiAgICAgcmV0ID0gYXRvbWljMTZfY21weGNoZyhoYWRk
ciwgQlNXQVAoY21wdiksIEJTV0FQKG5ld3YpKTsKICNlbHNlCi0gICAgcmV0ID0gYXRvbWljX2Nt
cHhjaGdfX25vY2hlY2soaGFkZHIsIEJTV0FQKGNtcHYpLCBCU1dBUChuZXd2KSk7CisgICAgcmV0
ID0gcWVtdV9hdG9taWNfY21weGNoZ19fbm9jaGVjayhoYWRkciwgQlNXQVAoY21wdiksIEJTV0FQ
KG5ld3YpKTsKICNlbmRpZgogICAgIEFUT01JQ19NTVVfQ0xFQU5VUDsKICAgICBhdG9taWNfdHJh
Y2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsKQEAgLTI4MCw3ICsyODAsNyBAQCBBQklfVFlQ
RSBBVE9NSUNfTkFNRSh4Y2hnKShDUFVBcmNoU3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25nIGFkZHIs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFUT01JQ19NTVVfSURY
KTsKIAogICAgIGF0b21pY190cmFjZV9ybXdfcHJlKGVudiwgYWRkciwgaW5mbyk7Ci0gICAgcmV0
ID0gYXRvbWljX3hjaGdfX25vY2hlY2soaGFkZHIsIEJTV0FQKHZhbCkpOworICAgIHJldCA9IHFl
bXVfYXRvbWljX3hjaGdfX25vY2hlY2soaGFkZHIsIEJTV0FQKHZhbCkpOwogICAgIEFUT01JQ19N
TVVfQ0xFQU5VUDsKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52LCBhZGRyLCBpbmZvKTsK
ICAgICByZXR1cm4gQlNXQVAocmV0KTsKQEAgLTI5Niw3ICsyOTYsNyBAQCBBQklfVFlQRSBBVE9N
SUNfTkFNRShYKShDUFVBcmNoU3RhdGUgKmVudiwgdGFyZ2V0X3Vsb25nIGFkZHIsICAgICAgIFwK
ICAgICB1aW50MTZfdCBpbmZvID0gdHJhY2VfbWVtX2J1aWxkX2luZm8oU0hJRlQsIGZhbHNlLCBN
T19CU1dBUCwgICAgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm
YWxzZSwgQVRPTUlDX01NVV9JRFgpOyAgICBcCiAgICAgYXRvbWljX3RyYWNlX3Jtd19wcmUoZW52
LCBhZGRyLCBpbmZvKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICByZXQgPSBhdG9t
aWNfIyNYKGhhZGRyLCBCU1dBUCh2YWwpKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAor
ICAgIHJldCA9IHFlbXVfYXRvbWljXyMjWChoYWRkciwgQlNXQVAodmFsKSk7ICAgICAgICAgICAg
ICAgICAgICAgICBcCiAgICAgQVRPTUlDX01NVV9DTEVBTlVQOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBhdG9taWNfdHJhY2Vfcm13X3Bvc3QoZW52
LCBhZGRyLCBpbmZvKTsgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIHJldHVybiBCU1dB
UChyZXQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCkBA
IC0zMjksMTAgKzMyOSwxMCBAQCBBQklfVFlQRSBBVE9NSUNfTkFNRShYKShDUFVBcmNoU3RhdGUg
KmVudiwgdGFyZ2V0X3Vsb25nIGFkZHIsICAgICAgIFwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZmFsc2UsIEFUT01JQ19NTVVfSURYKTsgICAgXAogICAgIGF0b21p
Y190cmFjZV9ybXdfcHJlKGVudiwgYWRkciwgaW5mbyk7ICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCiAgICAgc21wX21iKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKLSAgICBsZG4gPSBhdG9taWNfcmVhZF9fbm9jaGVjayhoYWRkcik7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIGxkbiA9IHFlbXVfYXRvbWljX3Jl
YWRfX25vY2hlY2soaGFkZHIpOyAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKICAgICAgICAgbGRvID0gbGRuOyBvbGQgPSBCU1dBUChsZG8pOyBuZXcgPSBGTihvbGQsIHZh
bCk7ICAgICAgICAgICAgXAotICAgICAgICBsZG4gPSBhdG9taWNfY21weGNoZ19fbm9jaGVjayho
YWRkciwgbGRvLCBCU1dBUChuZXcpKTsgICAgICBcCisgICAgICAgIGxkbiA9IHFlbXVfYXRvbWlj
X2NtcHhjaGdfX25vY2hlY2soaGFkZHIsIGxkbywgQlNXQVAobmV3KSk7IFwKICAgICB9IHdoaWxl
IChsZG8gIT0gbGRuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAogICAgIEFUT01JQ19NTVVfQ0xFQU5VUDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCiAgICAgYXRvbWljX3RyYWNlX3Jtd19wb3N0KGVudiwgYWRkciwgaW5m
byk7ICAgICAgICAgICAgICAgICAgICAgICAgIFwKZGlmZiAtLWdpdCBhL2luY2x1ZGUvYmxvY2sv
YWlvLXdhaXQuaCBiL2luY2x1ZGUvYmxvY2svYWlvLXdhaXQuaAppbmRleCA3MTZkMjYzOWRmLi44
ZjVhODkwNjY2IDEwMDY0NAotLS0gYS9pbmNsdWRlL2Jsb2NrL2Fpby13YWl0LmgKKysrIGIvaW5j
bHVkZS9ibG9jay9haW8td2FpdC5oCkBAIC04MCw3ICs4MCw3IEBAIGV4dGVybiBBaW9XYWl0IGds
b2JhbF9haW9fd2FpdDsKICAgICBBaW9XYWl0ICp3YWl0XyA9ICZnbG9iYWxfYWlvX3dhaXQ7ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgQWlvQ29udGV4dCAqY3R4XyA9IChjdHgp
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIC8qIEluY3JlbWVu
dCB3YWl0Xy0+bnVtX3dhaXRlcnMgYmVmb3JlIGV2YWx1YXRpbmcgY29uZC4gKi8gICAgIFwKLSAg
ICBhdG9taWNfaW5jKCZ3YWl0Xy0+bnVtX3dhaXRlcnMpOyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgcWVtdV9hdG9taWNfaW5jKCZ3YWl0Xy0+bnVtX3dhaXRlcnMpOyAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAogICAgIGlmIChjdHhfICYmIGluX2Fpb19jb250ZXh0X2hv
bWVfdGhyZWFkKGN0eF8pKSB7ICAgICAgICAgICAgICAgIFwKICAgICAgICAgd2hpbGUgKChjb25k
KSkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAg
ICAgICBhaW9fcG9sbChjdHhfLCB0cnVlKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXApAQCAtMTAwLDcgKzEwMCw3IEBAIGV4dGVybiBBaW9XYWl0IGdsb2JhbF9haW9fd2FpdDsK
ICAgICAgICAgICAgIHdhaXRlZF8gPSB0cnVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCiAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNfZGVjKCZ3
YWl0Xy0+bnVtX3dhaXRlcnMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
cWVtdV9hdG9taWNfZGVjKCZ3YWl0Xy0+bnVtX3dhaXRlcnMpOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAogICAgIHdhaXRlZF87IH0pCiAKIC8qKgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9ibG9j
ay9haW8uaCBiL2luY2x1ZGUvYmxvY2svYWlvLmgKaW5kZXggYjJmNzAzZmEzZi4uMDU3ZTczYzQ4
YyAxMDA2NDQKLS0tIGEvaW5jbHVkZS9ibG9jay9haW8uaAorKysgYi9pbmNsdWRlL2Jsb2NrL2Fp
by5oCkBAIC01OTUsNyArNTk1LDcgQEAgaW50NjRfdCBhaW9fY29tcHV0ZV90aW1lb3V0KEFpb0Nv
bnRleHQgKmN0eCk7CiAgKi8KIHN0YXRpYyBpbmxpbmUgdm9pZCBhaW9fZGlzYWJsZV9leHRlcm5h
bChBaW9Db250ZXh0ICpjdHgpCiB7Ci0gICAgYXRvbWljX2luYygmY3R4LT5leHRlcm5hbF9kaXNh
YmxlX2NudCk7CisgICAgcWVtdV9hdG9taWNfaW5jKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250
KTsKIH0KIAogLyoqCkBAIC02MDgsNyArNjA4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGFpb19l
bmFibGVfZXh0ZXJuYWwoQWlvQ29udGV4dCAqY3R4KQogewogICAgIGludCBvbGQ7CiAKLSAgICBv
bGQgPSBhdG9taWNfZmV0Y2hfZGVjKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KTsKKyAgICBv
bGQgPSBxZW11X2F0b21pY19mZXRjaF9kZWMoJmN0eC0+ZXh0ZXJuYWxfZGlzYWJsZV9jbnQpOwog
ICAgIGFzc2VydChvbGQgPiAwKTsKICAgICBpZiAob2xkID09IDEpIHsKICAgICAgICAgLyogS2lj
ayBldmVudCBsb29wIHNvIGl0IHJlLWFybXMgZmlsZSBkZXNjcmlwdG9ycyAqLwpAQCAtNjI0LDcg
KzYyNCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBhaW9fZW5hYmxlX2V4dGVybmFsKEFpb0NvbnRl
eHQgKmN0eCkKICAqLwogc3RhdGljIGlubGluZSBib29sIGFpb19leHRlcm5hbF9kaXNhYmxlZChB
aW9Db250ZXh0ICpjdHgpCiB7Ci0gICAgcmV0dXJuIGF0b21pY19yZWFkKCZjdHgtPmV4dGVybmFs
X2Rpc2FibGVfY250KTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfcmVhZCgmY3R4LT5leHRlcm5h
bF9kaXNhYmxlX2NudCk7CiB9CiAKIC8qKgpAQCAtNjM3LDcgKzYzNyw3IEBAIHN0YXRpYyBpbmxp
bmUgYm9vbCBhaW9fZXh0ZXJuYWxfZGlzYWJsZWQoQWlvQ29udGV4dCAqY3R4KQogICovCiBzdGF0
aWMgaW5saW5lIGJvb2wgYWlvX25vZGVfY2hlY2soQWlvQ29udGV4dCAqY3R4LCBib29sIGlzX2V4
dGVybmFsKQogewotICAgIHJldHVybiAhaXNfZXh0ZXJuYWwgfHwgIWF0b21pY19yZWFkKCZjdHgt
PmV4dGVybmFsX2Rpc2FibGVfY250KTsKKyAgICByZXR1cm4gIWlzX2V4dGVybmFsIHx8ICFxZW11
X2F0b21pY19yZWFkKCZjdHgtPmV4dGVybmFsX2Rpc2FibGVfY250KTsKIH0KIAogLyoqCmRpZmYg
LS1naXQgYS9pbmNsdWRlL2V4ZWMvY3B1X2xkc3QuaCBiL2luY2x1ZGUvZXhlYy9jcHVfbGRzdC5o
CmluZGV4IGMxNGE0OGY2NWUuLjZkY2YxN2YzN2IgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZXhlYy9j
cHVfbGRzdC5oCisrKyBiL2luY2x1ZGUvZXhlYy9jcHVfbGRzdC5oCkBAIC0yOTksNyArMjk5LDcg
QEAgc3RhdGljIGlubGluZSB0YXJnZXRfdWxvbmcgdGxiX2FkZHJfd3JpdGUoY29uc3QgQ1BVVExC
RW50cnkgKmVudHJ5KQogI2lmIFRDR19PVkVSU0laRURfR1VFU1QKICAgICByZXR1cm4gZW50cnkt
PmFkZHJfd3JpdGU7CiAjZWxzZQotICAgIHJldHVybiBhdG9taWNfcmVhZCgmZW50cnktPmFkZHJf
d3JpdGUpOworICAgIHJldHVybiBxZW11X2F0b21pY19yZWFkKCZlbnRyeS0+YWRkcl93cml0ZSk7
CiAjZW5kaWYKIH0KIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9leGVjL2V4ZWMtYWxsLmggYi9pbmNs
dWRlL2V4ZWMvZXhlYy1hbGwuaAppbmRleCAzY2Y4ODI3MmRmLi4wNWFkNjVhNzE0IDEwMDY0NAot
LS0gYS9pbmNsdWRlL2V4ZWMvZXhlYy1hbGwuaAorKysgYi9pbmNsdWRlL2V4ZWMvZXhlYy1hbGwu
aApAQCAtODksNyArODksNyBAQCB2b2lkIFFFTVVfTk9SRVRVUk4gY3B1X2xvb3BfZXhpdF9hdG9t
aWMoQ1BVU3RhdGUgKmNwdSwgdWludHB0cl90IHBjKTsKICAqLwogc3RhdGljIGlubGluZSBib29s
IGNwdV9sb29wX2V4aXRfcmVxdWVzdGVkKENQVVN0YXRlICpjcHUpCiB7Ci0gICAgcmV0dXJuIChp
bnQzMl90KWF0b21pY19yZWFkKCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUzMikgPCAwOwor
ICAgIHJldHVybiAoaW50MzJfdClxZW11X2F0b21pY19yZWFkKCZjcHVfbmVnKGNwdSktPmljb3Vu
dF9kZWNyLnUzMikgPCAwOwogfQogCiAjaWYgIWRlZmluZWQoQ09ORklHX1VTRVJfT05MWSkKQEAg
LTQ4NywxMCArNDg3LDEwIEBAIHN0cnVjdCBUcmFuc2xhdGlvbkJsb2NrIHsKIAogZXh0ZXJuIGJv
b2wgcGFyYWxsZWxfY3B1czsKIAotLyogSGlkZSB0aGUgYXRvbWljX3JlYWQgdG8gbWFrZSBjb2Rl
IGEgbGl0dGxlIGVhc2llciBvbiB0aGUgZXllcyAqLworLyogSGlkZSB0aGUgcWVtdV9hdG9taWNf
cmVhZCB0byBtYWtlIGNvZGUgYSBsaXR0bGUgZWFzaWVyIG9uIHRoZSBleWVzICovCiBzdGF0aWMg
aW5saW5lIHVpbnQzMl90IHRiX2NmbGFncyhjb25zdCBUcmFuc2xhdGlvbkJsb2NrICp0YikKIHsK
LSAgICByZXR1cm4gYXRvbWljX3JlYWQoJnRiLT5jZmxhZ3MpOworICAgIHJldHVybiBxZW11X2F0
b21pY19yZWFkKCZ0Yi0+Y2ZsYWdzKTsKIH0KIAogLyogY3VycmVudCBjZmxhZ3MgZm9yIGhhc2hp
bmcvY29tcGFyaXNvbiAqLwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9leGVjL2xvZy5oIGIvaW5jbHVk
ZS9leGVjL2xvZy5oCmluZGV4IDNlZDc5N2MxYzguLjJmZjBhYzBmN2YgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvZXhlYy9sb2cuaAorKysgYi9pbmNsdWRlL2V4ZWMvbG9nLmgKQEAgLTE5LDcgKzE5LDcg
QEAgc3RhdGljIGlubGluZSB2b2lkIGxvZ19jcHVfc3RhdGUoQ1BVU3RhdGUgKmNwdSwgaW50IGZs
YWdzKQogCiAgICAgaWYgKHFlbXVfbG9nX2VuYWJsZWQoKSkgewogICAgICAgICByY3VfcmVhZF9s
b2NrKCk7Ci0gICAgICAgIGxvZ2ZpbGUgPSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7
CisgICAgICAgIGxvZ2ZpbGUgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsK
ICAgICAgICAgaWYgKGxvZ2ZpbGUpIHsKICAgICAgICAgICAgIGNwdV9kdW1wX3N0YXRlKGNwdSwg
bG9nZmlsZS0+ZmQsIGZsYWdzKTsKICAgICAgICAgfQpAQCAtNDksNyArNDksNyBAQCBzdGF0aWMg
aW5saW5lIHZvaWQgbG9nX3RhcmdldF9kaXNhcyhDUFVTdGF0ZSAqY3B1LCB0YXJnZXRfdWxvbmcg
c3RhcnQsCiB7CiAgICAgUWVtdUxvZ0ZpbGUgKmxvZ2ZpbGU7CiAgICAgcmN1X3JlYWRfbG9jaygp
OwotICAgIGxvZ2ZpbGUgPSBhdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CisgICAgbG9n
ZmlsZSA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZxZW11X2xvZ2ZpbGUpOwogICAgIGlmIChsb2dm
aWxlKSB7CiAgICAgICAgIHRhcmdldF9kaXNhcyhsb2dmaWxlLT5mZCwgY3B1LCBzdGFydCwgbGVu
KTsKICAgICB9CkBAIC02MCw3ICs2MCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBsb2dfZGlzYXMo
dm9pZCAqY29kZSwgdW5zaWduZWQgbG9uZyBzaXplLCBjb25zdCBjaGFyICpub3RlKQogewogICAg
IFFlbXVMb2dGaWxlICpsb2dmaWxlOwogICAgIHJjdV9yZWFkX2xvY2soKTsKLSAgICBsb2dmaWxl
ID0gYXRvbWljX3JjdV9yZWFkKCZxZW11X2xvZ2ZpbGUpOworICAgIGxvZ2ZpbGUgPSBxZW11X2F0
b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsKICAgICBpZiAobG9nZmlsZSkgewogICAgICAg
ICBkaXNhcyhsb2dmaWxlLT5mZCwgY29kZSwgc2l6ZSwgbm90ZSk7CiAgICAgfQpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9leGVjL21lbW9yeS5oIGIvaW5jbHVkZS9leGVjL21lbW9yeS5oCmluZGV4IGYx
YmIyYTdkZjUuLmQ4NzlkODJkMGYgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZXhlYy9tZW1vcnkuaAor
KysgYi9pbmNsdWRlL2V4ZWMvbWVtb3J5LmgKQEAgLTY4NSw3ICs2ODUsNyBAQCBzdHJ1Y3QgRmxh
dFZpZXcgewogCiBzdGF0aWMgaW5saW5lIEZsYXRWaWV3ICphZGRyZXNzX3NwYWNlX3RvX2ZsYXR2
aWV3KEFkZHJlc3NTcGFjZSAqYXMpCiB7Ci0gICAgcmV0dXJuIGF0b21pY19yY3VfcmVhZCgmYXMt
PmN1cnJlbnRfbWFwKTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfcmN1X3JlYWQoJmFzLT5jdXJy
ZW50X21hcCk7CiB9CiAKIApkaWZmIC0tZ2l0IGEvaW5jbHVkZS9leGVjL3JhbV9hZGRyLmggYi9p
bmNsdWRlL2V4ZWMvcmFtX2FkZHIuaAppbmRleCAzZWY3MjlhMjNjLi42ZTczMTNkNzM2IDEwMDY0
NAotLS0gYS9pbmNsdWRlL2V4ZWMvcmFtX2FkZHIuaAorKysgYi9pbmNsdWRlL2V4ZWMvcmFtX2Fk
ZHIuaApAQCAtMTY0LDcgKzE2NCw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBjcHVfcGh5c2ljYWxf
bWVtb3J5X2dldF9kaXJ0eShyYW1fYWRkcl90IHN0YXJ0LAogICAgIHBhZ2UgPSBzdGFydCA+PiBU
QVJHRVRfUEFHRV9CSVRTOwogCiAgICAgV0lUSF9SQ1VfUkVBRF9MT0NLX0dVQVJEKCkgewotICAg
ICAgICBibG9ja3MgPSBhdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtjbGll
bnRdKTsKKyAgICAgICAgYmxvY2tzID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRp
cnR5X21lbW9yeVtjbGllbnRdKTsKIAogICAgICAgICBpZHggPSBwYWdlIC8gRElSVFlfTUVNT1JZ
X0JMT0NLX1NJWkU7CiAgICAgICAgIG9mZnNldCA9IHBhZ2UgJSBESVJUWV9NRU1PUllfQkxPQ0tf
U0laRTsKQEAgLTIwNSw3ICsyMDUsNyBAQCBzdGF0aWMgaW5saW5lIGJvb2wgY3B1X3BoeXNpY2Fs
X21lbW9yeV9hbGxfZGlydHkocmFtX2FkZHJfdCBzdGFydCwKIAogICAgIFJDVV9SRUFEX0xPQ0tf
R1VBUkQoKTsKIAotICAgIGJsb2NrcyA9IGF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlf
bWVtb3J5W2NsaWVudF0pOworICAgIGJsb2NrcyA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZyYW1f
bGlzdC5kaXJ0eV9tZW1vcnlbY2xpZW50XSk7CiAKICAgICBpZHggPSBwYWdlIC8gRElSVFlfTUVN
T1JZX0JMT0NLX1NJWkU7CiAgICAgb2Zmc2V0ID0gcGFnZSAlIERJUlRZX01FTU9SWV9CTE9DS19T
SVpFOwpAQCAtMjc4LDcgKzI3OCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBjcHVfcGh5c2ljYWxf
bWVtb3J5X3NldF9kaXJ0eV9mbGFnKHJhbV9hZGRyX3QgYWRkciwKIAogICAgIFJDVV9SRUFEX0xP
Q0tfR1VBUkQoKTsKIAotICAgIGJsb2NrcyA9IGF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGly
dHlfbWVtb3J5W2NsaWVudF0pOworICAgIGJsb2NrcyA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZy
YW1fbGlzdC5kaXJ0eV9tZW1vcnlbY2xpZW50XSk7CiAKICAgICBzZXRfYml0X2F0b21pYyhvZmZz
ZXQsIGJsb2Nrcy0+YmxvY2tzW2lkeF0pOwogfQpAQCAtMzAxLDcgKzMwMSw3IEBAIHN0YXRpYyBp
bmxpbmUgdm9pZCBjcHVfcGh5c2ljYWxfbWVtb3J5X3NldF9kaXJ0eV9yYW5nZShyYW1fYWRkcl90
IHN0YXJ0LAogCiAgICAgV0lUSF9SQ1VfUkVBRF9MT0NLX0dVQVJEKCkgewogICAgICAgICBmb3Ig
KGkgPSAwOyBpIDwgRElSVFlfTUVNT1JZX05VTTsgaSsrKSB7Ci0gICAgICAgICAgICBibG9ja3Nb
aV0gPSBhdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtpXSk7CisgICAgICAg
ICAgICBibG9ja3NbaV0gPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVt
b3J5W2ldKTsKICAgICAgICAgfQogCiAgICAgICAgIGlkeCA9IHBhZ2UgLyBESVJUWV9NRU1PUllf
QkxPQ0tfU0laRTsKQEAgLTM2MSwyMyArMzYxLDI2IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBjcHVf
cGh5c2ljYWxfbWVtb3J5X3NldF9kaXJ0eV9sZWJpdG1hcCh1bnNpZ25lZCBsb25nICpiaXRtYXAs
CiAKICAgICAgICAgV0lUSF9SQ1VfUkVBRF9MT0NLX0dVQVJEKCkgewogICAgICAgICAgICAgZm9y
IChpID0gMDsgaSA8IERJUlRZX01FTU9SWV9OVU07IGkrKykgewotICAgICAgICAgICAgICAgIGJs
b2Nrc1tpXSA9IGF0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVtb3J5W2ldKS0+Ymxv
Y2tzOworICAgICAgICAgICAgICAgIGJsb2Nrc1tpXSA9CisgICAgICAgICAgICAgICAgICAgIHFl
bXVfYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbaV0pLT5ibG9ja3M7CiAg
ICAgICAgICAgICB9CiAKICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBucjsgaysrKSB7CiAg
ICAgICAgICAgICAgICAgaWYgKGJpdG1hcFtrXSkgewogICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBsb25nIHRlbXAgPSBsZXVsX3RvX2NwdShiaXRtYXBba10pOwogCi0gICAgICAgICAgICAg
ICAgICAgIGF0b21pY19vcigmYmxvY2tzW0RJUlRZX01FTU9SWV9WR0FdW2lkeF1bb2Zmc2V0XSwg
dGVtcCk7CisgICAgICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX29yKCZibG9ja3NbRElSVFlf
TUVNT1JZX1ZHQV1baWR4XVtvZmZzZXRdLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB0ZW1wKTsKIAogICAgICAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsX2RpcnR5X2xvZykg
ewotICAgICAgICAgICAgICAgICAgICAgICAgYXRvbWljX29yKCZibG9ja3NbRElSVFlfTUVNT1JZ
X01JR1JBVElPTl1baWR4XVtvZmZzZXRdLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHRlbXApOworICAgICAgICAgICAgICAgICAgICAgICAgcWVtdV9hdG9taWNfb3IoCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJmJsb2Nrc1tESVJUWV9NRU1PUllfTUlHUkFUSU9OXVtp
ZHhdW29mZnNldF0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCk7CiAgICAgICAg
ICAgICAgICAgICAgIH0KIAogICAgICAgICAgICAgICAgICAgICBpZiAodGNnX2VuYWJsZWQoKSkg
ewotICAgICAgICAgICAgICAgICAgICAgICAgYXRvbWljX29yKCZibG9ja3NbRElSVFlfTUVNT1JZ
X0NPREVdW2lkeF1bb2Zmc2V0XSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0
ZW1wKTsKKyAgICAgICAgICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX29yKCZibG9ja3NbRElS
VFlfTUVNT1JZX0NPREVdW2lkeF1bb2Zmc2V0XSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRlbXApOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg
ICAgfQogCkBAIC00NjEsMTIgKzQ2NCwxMiBAQCB1aW50NjRfdCBjcHVfcGh5c2ljYWxfbWVtb3J5
X3N5bmNfZGlydHlfYml0bWFwKFJBTUJsb2NrICpyYiwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBESVJUWV9NRU1PUllfQkxPQ0tfU0laRSk7CiAgICAgICAgIHVuc2ln
bmVkIGxvbmcgcGFnZSA9IEJJVF9XT1JEKHN0YXJ0ID4+IFRBUkdFVF9QQUdFX0JJVFMpOwogCi0g
ICAgICAgIHNyYyA9IGF0b21pY19yY3VfcmVhZCgKKyAgICAgICAgc3JjID0gcWVtdV9hdG9taWNf
cmN1X3JlYWQoCiAgICAgICAgICAgICAgICAgJnJhbV9saXN0LmRpcnR5X21lbW9yeVtESVJUWV9N
RU1PUllfTUlHUkFUSU9OXSktPmJsb2NrczsKIAogICAgICAgICBmb3IgKGsgPSBwYWdlOyBrIDwg
cGFnZSArIG5yOyBrKyspIHsKICAgICAgICAgICAgIGlmIChzcmNbaWR4XVtvZmZzZXRdKSB7Ci0g
ICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBiaXRzID0gYXRvbWljX3hjaGcoJnNyY1tpZHhd
W29mZnNldF0sIDApOworICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgYml0cyA9IHFlbXVf
YXRvbWljX3hjaGcoJnNyY1tpZHhdW29mZnNldF0sIDApOwogICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGxvbmcgbmV3X2RpcnR5OwogICAgICAgICAgICAgICAgIG5ld19kaXJ0eSA9IH5kZXN0W2td
OwogICAgICAgICAgICAgICAgIGRlc3Rba10gfD0gYml0czsKZGlmZiAtLWdpdCBhL2luY2x1ZGUv
ZXhlYy9yYW1saXN0LmggYi9pbmNsdWRlL2V4ZWMvcmFtbGlzdC5oCmluZGV4IGJjNGZhYTFiMDAu
LmFmNTgwNmYxNDMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZXhlYy9yYW1saXN0LmgKKysrIGIvaW5j
bHVkZS9leGVjL3JhbWxpc3QuaApAQCAtMTksNyArMTksNyBAQCB0eXBlZGVmIHN0cnVjdCBSQU1C
bG9ja05vdGlmaWVyIFJBTUJsb2NrTm90aWZpZXI7CiAgKiAgIHJjdV9yZWFkX2xvY2soKTsKICAq
CiAgKiAgIERpcnR5TWVtb3J5QmxvY2tzICpibG9ja3MgPQotICogICAgICAgYXRvbWljX3JjdV9y
ZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbRElSVFlfTUVNT1JZX01JR1JBVElPTl0pOworICog
ICAgICAgcWVtdV9hdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtESVJUWV9N
RU1PUllfTUlHUkFUSU9OXSk7CiAgKgogICogICByYW1fYWRkcl90IGlkeCA9IChhZGRyID4+IFRB
UkdFVF9QQUdFX0JJVFMpIC8gRElSVFlfTUVNT1JZX0JMT0NLX1NJWkU7CiAgKiAgIHVuc2lnbmVk
IGxvbmcgKmJsb2NrID0gYmxvY2tzLmJsb2Nrc1tpZHhdOwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9l
eGVjL3RiLWxvb2t1cC5oIGIvaW5jbHVkZS9leGVjL3RiLWxvb2t1cC5oCmluZGV4IDI2OTIxYjZk
YWYuLjg1ZWFkZWQyMDEgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvZXhlYy90Yi1sb29rdXAuaAorKysg
Yi9pbmNsdWRlL2V4ZWMvdGItbG9va3VwLmgKQEAgLTI3LDcgKzI3LDcgQEAgdGJfbG9va3VwX19j
cHVfc3RhdGUoQ1BVU3RhdGUgKmNwdSwgdGFyZ2V0X3Vsb25nICpwYywgdGFyZ2V0X3Vsb25nICpj
c19iYXNlLAogCiAgICAgY3B1X2dldF90Yl9jcHVfc3RhdGUoZW52LCBwYywgY3NfYmFzZSwgZmxh
Z3MpOwogICAgIGhhc2ggPSB0Yl9qbXBfY2FjaGVfaGFzaF9mdW5jKCpwYyk7Ci0gICAgdGIgPSBh
dG9taWNfcmN1X3JlYWQoJmNwdS0+dGJfam1wX2NhY2hlW2hhc2hdKTsKKyAgICB0YiA9IHFlbXVf
YXRvbWljX3JjdV9yZWFkKCZjcHUtPnRiX2ptcF9jYWNoZVtoYXNoXSk7CiAKICAgICBjZl9tYXNr
ICY9IH5DRl9DTFVTVEVSX01BU0s7CiAgICAgY2ZfbWFzayB8PSBjcHUtPmNsdXN0ZXJfaW5kZXgg
PDwgQ0ZfQ0xVU1RFUl9TSElGVDsKQEAgLTQ0LDcgKzQ0LDcgQEAgdGJfbG9va3VwX19jcHVfc3Rh
dGUoQ1BVU3RhdGUgKmNwdSwgdGFyZ2V0X3Vsb25nICpwYywgdGFyZ2V0X3Vsb25nICpjc19iYXNl
LAogICAgIGlmICh0YiA9PSBOVUxMKSB7CiAgICAgICAgIHJldHVybiBOVUxMOwogICAgIH0KLSAg
ICBhdG9taWNfc2V0KCZjcHUtPnRiX2ptcF9jYWNoZVtoYXNoXSwgdGIpOworICAgIHFlbXVfYXRv
bWljX3NldCgmY3B1LT50Yl9qbXBfY2FjaGVbaGFzaF0sIHRiKTsKICAgICByZXR1cm4gdGI7CiB9
CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvaHcvY29yZS9jcHUuaCBiL2luY2x1ZGUvaHcvY29yZS9j
cHUuaAppbmRleCA5OWRjMzNmZmViLi4zMjMxY2FhODYwIDEwMDY0NAotLS0gYS9pbmNsdWRlL2h3
L2NvcmUvY3B1LmgKKysrIGIvaW5jbHVkZS9ody9jb3JlL2NwdS5oCkBAIC00ODIsNyArNDgyLDcg
QEAgc3RhdGljIGlubGluZSB2b2lkIGNwdV90Yl9qbXBfY2FjaGVfY2xlYXIoQ1BVU3RhdGUgKmNw
dSkKICAgICB1bnNpZ25lZCBpbnQgaTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCBUQl9KTVBfQ0FD
SEVfU0laRTsgaSsrKSB7Ci0gICAgICAgIGF0b21pY19zZXQoJmNwdS0+dGJfam1wX2NhY2hlW2ld
LCBOVUxMKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZjcHUtPnRiX2ptcF9jYWNoZVtpXSwg
TlVMTCk7CiAgICAgfQogfQogCmRpZmYgLS1naXQgYS9pbmNsdWRlL3FlbXUvYXRvbWljLmggYi9p
bmNsdWRlL3FlbXUvYXRvbWljLmgKaW5kZXggZmY3MmRiNTExNS4uZjJjNDA2ZWI0OSAxMDA2NDQK
LS0tIGEvaW5jbHVkZS9xZW11L2F0b21pYy5oCisrKyBiL2luY2x1ZGUvcWVtdS9hdG9taWMuaApA
QCAtMTI1LDQ5ICsxMjUsNDkgQEAKICAqIG5vIGVmZmVjdCBvbiB0aGUgZ2VuZXJhdGVkIGNvZGUg
YnV0IG5vdCB1c2luZyB0aGUgYXRvbWljIHByaW1pdGl2ZXMKICAqIHdpbGwgZ2V0IGZsYWdnZWQg
Ynkgc2FuaXRpemVycyBhcyBhIHZpb2xhdGlvbi4KICAqLwotI2RlZmluZSBhdG9taWNfcmVhZF9f
bm9jaGVjayhwdHIpIFwKKyNkZWZpbmUgcWVtdV9hdG9taWNfcmVhZF9fbm9jaGVjayhwdHIpIFwK
ICAgICBfX2F0b21pY19sb2FkX24ocHRyLCBfX0FUT01JQ19SRUxBWEVEKQogCi0jZGVmaW5lIGF0
b21pY19yZWFkKHB0cikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFl
bXVfYXRvbWljX3JlYWQocHRyKSAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgKHsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgUUVNVV9C
VUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIpID4gQVRPTUlDX1JFR19TSVpFKTsgXAotICAgIGF0b21p
Y19yZWFkX19ub2NoZWNrKHB0cik7ICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHFlbXVf
YXRvbWljX3JlYWRfX25vY2hlY2socHRyKTsgICAgICAgICAgICAgICAgICAgXAogICAgIH0pCiAK
LSNkZWZpbmUgYXRvbWljX3NldF9fbm9jaGVjayhwdHIsIGkpIFwKKyNkZWZpbmUgcWVtdV9hdG9t
aWNfc2V0X19ub2NoZWNrKHB0ciwgaSkgXAogICAgIF9fYXRvbWljX3N0b3JlX24ocHRyLCBpLCBf
X0FUT01JQ19SRUxBWEVEKQogCi0jZGVmaW5lIGF0b21pY19zZXQocHRyLCBpKSAgZG8geyAgICAg
ICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFlbXVfYXRvbWljX3NldChwdHIsIGkpICBkbyB7
ICAgICAgICAgICAgICAgICAgXAogICAgIFFFTVVfQlVJTERfQlVHX09OKHNpemVvZigqcHRyKSA+
IEFUT01JQ19SRUdfU0laRSk7IFwKLSAgICBhdG9taWNfc2V0X19ub2NoZWNrKHB0ciwgaSk7ICAg
ICAgICAgICAgICAgICAgICAgIFwKKyAgICBxZW11X2F0b21pY19zZXRfX25vY2hlY2socHRyLCBp
KTsgICAgICAgICAgICAgICAgICBcCiB9IHdoaWxlKDApCiAKIC8qIFNlZSBhYm92ZTogbW9zdCBj
b21waWxlcnMgY3VycmVudGx5IHRyZWF0IGNvbnN1bWUgYW5kIGFjcXVpcmUgdGhlCi0gKiBzYW1l
LCBidXQgdGhpcyBzbG93cyBkb3duIGF0b21pY19yY3VfcmVhZCB1bm5lY2Vzc2FyaWx5LgorICog
c2FtZSwgYnV0IHRoaXMgc2xvd3MgZG93biBxZW11X2F0b21pY19yY3VfcmVhZCB1bm5lY2Vzc2Fy
aWx5LgogICovCiAjaWZkZWYgX19TQU5JVElaRV9USFJFQURfXwotI2RlZmluZSBhdG9taWNfcmN1
X3JlYWRfX25vY2hlY2socHRyLCB2YWxwdHIpICAgICAgICAgICBcCisjZGVmaW5lIHFlbXVfYXRv
bWljX3JjdV9yZWFkX19ub2NoZWNrKHB0ciwgdmFscHRyKSAgICAgIFwKICAgICBfX2F0b21pY19s
b2FkKHB0ciwgdmFscHRyLCBfX0FUT01JQ19DT05TVU1FKTsKICNlbHNlCi0jZGVmaW5lIGF0b21p
Y19yY3VfcmVhZF9fbm9jaGVjayhwdHIsIHZhbHB0cikgICAgICAgICAgIFwKKyNkZWZpbmUgcWVt
dV9hdG9taWNfcmN1X3JlYWRfX25vY2hlY2socHRyLCB2YWxwdHIpICAgICAgXAogICAgIF9fYXRv
bWljX2xvYWQocHRyLCB2YWxwdHIsIF9fQVRPTUlDX1JFTEFYRUQpOyAgICAgICBcCiAgICAgc21w
X3JlYWRfYmFycmllcl9kZXBlbmRzKCk7CiAjZW5kaWYKIAotI2RlZmluZSBhdG9taWNfcmN1X3Jl
YWQocHRyKSAgICAgICAgICAgICAgICAgICAgICAgICAgXAorI2RlZmluZSBxZW11X2F0b21pY19y
Y3VfcmVhZChwdHIpICAgICAgICAgICAgICAgICAgICAgXAogICAgICh7ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIFFFTVVfQlVJTERfQlVHX09O
KHNpemVvZigqcHRyKSA+IEFUT01JQ19SRUdfU0laRSk7IFwKICAgICB0eXBlb2Zfc3RyaXBfcXVh
bCgqcHRyKSBfdmFsOyAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNfcmN1X3JlYWRf
X25vY2hlY2socHRyLCAmX3ZhbCk7ICAgICAgICAgICAgIFwKKyAgICBxZW11X2F0b21pY19yY3Vf
cmVhZF9fbm9jaGVjayhwdHIsICZfdmFsKTsgICAgICAgIFwKICAgICBfdmFsOyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICB9KQogCi0jZGVmaW5lIGF0
b21pY19yY3Vfc2V0KHB0ciwgaSkgZG8geyAgICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFl
bXVfYXRvbWljX3JjdV9zZXQocHRyLCBpKSBkbyB7ICAgICAgICAgICAgICBcCiAgICAgUUVNVV9C
VUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIpID4gQVRPTUlDX1JFR19TSVpFKTsgXAogICAgIF9fYXRv
bWljX3N0b3JlX24ocHRyLCBpLCBfX0FUT01JQ19SRUxFQVNFKTsgICAgICAgXAogfSB3aGlsZSgw
KQogCi0jZGVmaW5lIGF0b21pY19sb2FkX2FjcXVpcmUocHRyKSAgICAgICAgICAgICAgICAgICAg
ICAgIFwKKyNkZWZpbmUgcWVtdV9hdG9taWNfbG9hZF9hY3F1aXJlKHB0cikgICAgICAgICAgICAg
ICAgICAgXAogICAgICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCiAgICAgUUVNVV9CVUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIpID4gQVRPTUlDX1JF
R19TSVpFKTsgIFwKICAgICB0eXBlb2Zfc3RyaXBfcXVhbCgqcHRyKSBfdmFsOyAgICAgICAgICAg
ICAgICAgICAgICAgXApAQCAtMTc1LDcgKzE3NSw3IEBACiAgICAgX3ZhbDsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICB9KQogCi0jZGVmaW5lIGF0
b21pY19zdG9yZV9yZWxlYXNlKHB0ciwgaSkgIGRvIHsgICAgICAgICAgICAgIFwKKyNkZWZpbmUg
cWVtdV9hdG9taWNfc3RvcmVfcmVsZWFzZShwdHIsIGkpICBkbyB7ICAgICAgICAgXAogICAgIFFF
TVVfQlVJTERfQlVHX09OKHNpemVvZigqcHRyKSA+IEFUT01JQ19SRUdfU0laRSk7ICBcCiAgICAg
X19hdG9taWNfc3RvcmVfbihwdHIsIGksIF9fQVRPTUlDX1JFTEVBU0UpOyAgICAgICAgIFwKIH0g
d2hpbGUoMCkKQEAgLTE4Myw1NiArMTgzLDc1IEBACiAKIC8qIEFsbCB0aGUgcmVtYWluaW5nIG9w
ZXJhdGlvbnMgYXJlIGZ1bGx5IHNlcXVlbnRpYWxseSBjb25zaXN0ZW50ICovCiAKLSNkZWZpbmUg
YXRvbWljX3hjaGdfX25vY2hlY2socHRyLCBpKSAgICAoeyAgICAgICAgICAgICAgICAgIFwKKyNk
ZWZpbmUgcWVtdV9hdG9taWNfeGNoZ19fbm9jaGVjayhwdHIsIGkpICAgICh7ICAgICAgICAgICAg
IFwKICAgICBfX2F0b21pY19leGNoYW5nZV9uKHB0ciwgKGkpLCBfX0FUT01JQ19TRVFfQ1NUKTsg
ICAgICAgIFwKIH0pCiAKLSNkZWZpbmUgYXRvbWljX3hjaGcocHRyLCBpKSAgICAoeyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUgcWVtdV9hdG9taWNfeGNoZyhwdHIsIGkpICAg
ICh7ICAgICAgICAgICAgICAgICAgICAgIFwKICAgICBRRU1VX0JVSUxEX0JVR19PTihzaXplb2Yo
KnB0cikgPiBBVE9NSUNfUkVHX1NJWkUpOyAgICAgIFwKLSAgICBhdG9taWNfeGNoZ19fbm9jaGVj
ayhwdHIsIGkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBxZW11X2F0b21pY194
Y2hnX19ub2NoZWNrKHB0ciwgaSk7ICAgICAgICAgICAgICAgICAgICAgIFwKIH0pCiAKIC8qIFJl
dHVybnMgdGhlIGV2ZW50dWFsIHZhbHVlLCBmYWlsZWQgb3Igbm90ICovCi0jZGVmaW5lIGF0b21p
Y19jbXB4Y2hnX19ub2NoZWNrKHB0ciwgb2xkLCBuZXcpICAgICh7ICAgICAgICAgICAgICAgICAg
ICBcCisjZGVmaW5lIHFlbXVfYXRvbWljX2NtcHhjaGdfX25vY2hlY2socHRyLCBvbGQsIG5ldykg
ICAgKHsgICAgICAgICAgICAgICBcCiAgICAgdHlwZW9mX3N0cmlwX3F1YWwoKnB0cikgX29sZCA9
IChvbGQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgKHZvaWQpX19hdG9t
aWNfY29tcGFyZV9leGNoYW5nZV9uKHB0ciwgJl9vbGQsIG5ldywgZmFsc2UsICAgICAgICAgICBc
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX0FUT01JQ19TRVFfQ1NULCBfX0FUT01J
Q19TRVFfQ1NUKTsgICAgICBcCiAgICAgX29sZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiB9KQogCi0jZGVmaW5lIGF0b21p
Y19jbXB4Y2hnKHB0ciwgb2xkLCBuZXcpICAgICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCisjZGVmaW5lIHFlbXVfYXRvbWljX2NtcHhjaGcocHRyLCBvbGQsIG5ldykgICAgKHsgICAg
ICAgICAgICAgICAgICAgICAgICBcCiAgICAgUUVNVV9CVUlMRF9CVUdfT04oc2l6ZW9mKCpwdHIp
ID4gQVRPTUlDX1JFR19TSVpFKTsgICAgICAgICAgICAgICAgICBcCi0gICAgYXRvbWljX2NtcHhj
aGdfX25vY2hlY2socHRyLCBvbGQsIG5ldyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CisgICAgcWVtdV9hdG9taWNfY21weGNoZ19fbm9jaGVjayhwdHIsIG9sZCwgbmV3KTsgICAgICAg
ICAgICAgICAgICAgICAgICBcCiB9KQogCiAvKiBQcm92aWRlIHNob3J0ZXIgbmFtZXMgZm9yIEdD
QyBhdG9taWMgYnVpbHRpbnMsIHJldHVybiBvbGQgdmFsdWUgKi8KLSNkZWZpbmUgYXRvbWljX2Zl
dGNoX2luYyhwdHIpICBfX2F0b21pY19mZXRjaF9hZGQocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NU
KQotI2RlZmluZSBhdG9taWNfZmV0Y2hfZGVjKHB0cikgIF9fYXRvbWljX2ZldGNoX3N1YihwdHIs
IDEsIF9fQVRPTUlDX1NFUV9DU1QpCisjZGVmaW5lIHFlbXVfYXRvbWljX2ZldGNoX2luYyhwdHIp
IFwKKyAgICBfX2F0b21pY19mZXRjaF9hZGQocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NUKQorI2Rl
ZmluZSBxZW11X2F0b21pY19mZXRjaF9kZWMocHRyKSBcCisgICAgX19hdG9taWNfZmV0Y2hfc3Vi
KHB0ciwgMSwgX19BVE9NSUNfU0VRX0NTVCkKIAotI2lmbmRlZiBhdG9taWNfZmV0Y2hfYWRkCi0j
ZGVmaW5lIGF0b21pY19mZXRjaF9hZGQocHRyLCBuKSBfX2F0b21pY19mZXRjaF9hZGQocHRyLCBu
LCBfX0FUT01JQ19TRVFfQ1NUKQotI2RlZmluZSBhdG9taWNfZmV0Y2hfc3ViKHB0ciwgbikgX19h
dG9taWNfZmV0Y2hfc3ViKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkKLSNkZWZpbmUgYXRvbWlj
X2ZldGNoX2FuZChwdHIsIG4pIF9fYXRvbWljX2ZldGNoX2FuZChwdHIsIG4sIF9fQVRPTUlDX1NF
UV9DU1QpCi0jZGVmaW5lIGF0b21pY19mZXRjaF9vcihwdHIsIG4pICBfX2F0b21pY19mZXRjaF9v
cihwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCi0jZGVmaW5lIGF0b21pY19mZXRjaF94b3IocHRy
LCBuKSBfX2F0b21pY19mZXRjaF94b3IocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQotI2VuZGlm
CisjZGVmaW5lIHFlbXVfYXRvbWljX2ZldGNoX2FkZChwdHIsIG4pIFwKKyAgICBfX2F0b21pY19m
ZXRjaF9hZGQocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQorI2RlZmluZSBxZW11X2F0b21pY19m
ZXRjaF9zdWIocHRyLCBuKSBcCisgICAgX19hdG9taWNfZmV0Y2hfc3ViKHB0ciwgbiwgX19BVE9N
SUNfU0VRX0NTVCkKKyNkZWZpbmUgcWVtdV9hdG9taWNfZmV0Y2hfYW5kKHB0ciwgbikgXAorICAg
IF9fYXRvbWljX2ZldGNoX2FuZChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCisjZGVmaW5lIHFl
bXVfYXRvbWljX2ZldGNoX29yKHB0ciwgbikgXAorICAgIF9fYXRvbWljX2ZldGNoX29yKHB0ciwg
biwgX19BVE9NSUNfU0VRX0NTVCkKKyNkZWZpbmUgcWVtdV9hdG9taWNfZmV0Y2hfeG9yKHB0ciwg
bikgXAorICAgIF9fYXRvbWljX2ZldGNoX3hvcihwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCiAK
LSNkZWZpbmUgYXRvbWljX2luY19mZXRjaChwdHIpICAgIF9fYXRvbWljX2FkZF9mZXRjaChwdHIs
IDEsIF9fQVRPTUlDX1NFUV9DU1QpCi0jZGVmaW5lIGF0b21pY19kZWNfZmV0Y2gocHRyKSAgICBf
X2F0b21pY19zdWJfZmV0Y2gocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NUKQotI2RlZmluZSBhdG9t
aWNfYWRkX2ZldGNoKHB0ciwgbikgX19hdG9taWNfYWRkX2ZldGNoKHB0ciwgbiwgX19BVE9NSUNf
U0VRX0NTVCkKLSNkZWZpbmUgYXRvbWljX3N1Yl9mZXRjaChwdHIsIG4pIF9fYXRvbWljX3N1Yl9m
ZXRjaChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCi0jZGVmaW5lIGF0b21pY19hbmRfZmV0Y2go
cHRyLCBuKSBfX2F0b21pY19hbmRfZmV0Y2gocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQotI2Rl
ZmluZSBhdG9taWNfb3JfZmV0Y2gocHRyLCBuKSAgX19hdG9taWNfb3JfZmV0Y2gocHRyLCBuLCBf
X0FUT01JQ19TRVFfQ1NUKQotI2RlZmluZSBhdG9taWNfeG9yX2ZldGNoKHB0ciwgbikgX19hdG9t
aWNfeG9yX2ZldGNoKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkKKyNkZWZpbmUgcWVtdV9hdG9t
aWNfaW5jX2ZldGNoKHB0cikgXAorICAgIF9fYXRvbWljX2FkZF9mZXRjaChwdHIsIDEsIF9fQVRP
TUlDX1NFUV9DU1QpCisjZGVmaW5lIHFlbXVfYXRvbWljX2RlY19mZXRjaChwdHIpIFwKKyAgICBf
X2F0b21pY19zdWJfZmV0Y2gocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NUKQorI2RlZmluZSBxZW11
X2F0b21pY19hZGRfZmV0Y2gocHRyLCBuKSBcCisgICAgX19hdG9taWNfYWRkX2ZldGNoKHB0ciwg
biwgX19BVE9NSUNfU0VRX0NTVCkKKyNkZWZpbmUgcWVtdV9hdG9taWNfc3ViX2ZldGNoKHB0ciwg
bikgXAorICAgIF9fYXRvbWljX3N1Yl9mZXRjaChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpCisj
ZGVmaW5lIHFlbXVfYXRvbWljX2FuZF9mZXRjaChwdHIsIG4pIFwKKyAgICBfX2F0b21pY19hbmRf
ZmV0Y2gocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQorI2RlZmluZSBxZW11X2F0b21pY19vcl9m
ZXRjaChwdHIsIG4pIFwKKyAgICBfX2F0b21pY19vcl9mZXRjaChwdHIsIG4sIF9fQVRPTUlDX1NF
UV9DU1QpCisjZGVmaW5lIHFlbXVfYXRvbWljX3hvcl9mZXRjaChwdHIsIG4pIFwKKyAgICBfX2F0
b21pY194b3JfZmV0Y2gocHRyLCBuLCBfX0FUT01JQ19TRVFfQ1NUKQogCiAvKiBBbmQgZXZlbiBz
aG9ydGVyIG5hbWVzIHRoYXQgcmV0dXJuIHZvaWQuICAqLwotI2RlZmluZSBhdG9taWNfaW5jKHB0
cikgICAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9hZGQocHRyLCAxLCBfX0FUT01JQ19TRVFfQ1NU
KSkKLSNkZWZpbmUgYXRvbWljX2RlYyhwdHIpICAgICgodm9pZCkgX19hdG9taWNfZmV0Y2hfc3Vi
KHB0ciwgMSwgX19BVE9NSUNfU0VRX0NTVCkpCi0jZGVmaW5lIGF0b21pY19hZGQocHRyLCBuKSAo
KHZvaWQpIF9fYXRvbWljX2ZldGNoX2FkZChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpKQotI2Rl
ZmluZSBhdG9taWNfc3ViKHB0ciwgbikgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9zdWIocHRyLCBu
LCBfX0FUT01JQ19TRVFfQ1NUKSkKLSNkZWZpbmUgYXRvbWljX2FuZChwdHIsIG4pICgodm9pZCkg
X19hdG9taWNfZmV0Y2hfYW5kKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkpCi0jZGVmaW5lIGF0
b21pY19vcihwdHIsIG4pICAoKHZvaWQpIF9fYXRvbWljX2ZldGNoX29yKHB0ciwgbiwgX19BVE9N
SUNfU0VRX0NTVCkpCi0jZGVmaW5lIGF0b21pY194b3IocHRyLCBuKSAoKHZvaWQpIF9fYXRvbWlj
X2ZldGNoX3hvcihwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpKQorI2RlZmluZSBxZW11X2F0b21p
Y19pbmMocHRyKSBcCisgICAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9hZGQocHRyLCAxLCBfX0FU
T01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWVtdV9hdG9taWNfZGVjKHB0cikgXAorICAgICgodm9p
ZCkgX19hdG9taWNfZmV0Y2hfc3ViKHB0ciwgMSwgX19BVE9NSUNfU0VRX0NTVCkpCisjZGVmaW5l
IHFlbXVfYXRvbWljX2FkZChwdHIsIG4pIFwKKyAgICAoKHZvaWQpIF9fYXRvbWljX2ZldGNoX2Fk
ZChwdHIsIG4sIF9fQVRPTUlDX1NFUV9DU1QpKQorI2RlZmluZSBxZW11X2F0b21pY19zdWIocHRy
LCBuKSBcCisgICAgKCh2b2lkKSBfX2F0b21pY19mZXRjaF9zdWIocHRyLCBuLCBfX0FUT01JQ19T
RVFfQ1NUKSkKKyNkZWZpbmUgcWVtdV9hdG9taWNfYW5kKHB0ciwgbikgXAorICAgICgodm9pZCkg
X19hdG9taWNfZmV0Y2hfYW5kKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NTVCkpCisjZGVmaW5lIHFl
bXVfYXRvbWljX29yKHB0ciwgbikgXAorICAgICgodm9pZCkgX19hdG9taWNfZmV0Y2hfb3IocHRy
LCBuLCBfX0FUT01JQ19TRVFfQ1NUKSkKKyNkZWZpbmUgcWVtdV9hdG9taWNfeG9yKHB0ciwgbikg
XAorICAgICgodm9pZCkgX19hdG9taWNfZmV0Y2hfeG9yKHB0ciwgbiwgX19BVE9NSUNfU0VRX0NT
VCkpCiAKICNlbHNlIC8qIF9fQVRPTUlDX1JFTEFYRUQgKi8KIApAQCAtMjcyLDcgKzI5MSw3IEBA
CiAgKiBidXQgaXQgaXMgYSBmdWxsIGJhcnJpZXIgYXQgdGhlIGhhcmR3YXJlIGxldmVsLiAgQWRk
IGEgY29tcGlsZXIgYmFycmllcgogICogdG8gbWFrZSBpdCBhIGZ1bGwgYmFycmllciBhbHNvIGF0
IHRoZSBjb21waWxlciBsZXZlbC4KICAqLwotI2RlZmluZSBhdG9taWNfeGNoZyhwdHIsIGkpICAg
IChiYXJyaWVyKCksIF9fc3luY19sb2NrX3Rlc3RfYW5kX3NldChwdHIsIGkpKQorI2RlZmluZSBx
ZW11X2F0b21pY194Y2hnKHB0ciwgaSkgKGJhcnJpZXIoKSwgX19zeW5jX2xvY2tfdGVzdF9hbmRf
c2V0KHB0ciwgaSkpCiAKICNlbGlmIGRlZmluZWQoX0FSQ0hfUFBDKQogCkBAIC0zMjUsMTQgKzM0
NCwxNSBAQAogLyogVGhlc2Ugd2lsbCBvbmx5IGJlIGF0b21pYyBpZiB0aGUgcHJvY2Vzc29yIGRv
ZXMgdGhlIGZldGNoIG9yIHN0b3JlCiAgKiBpbiBhIHNpbmdsZSBpc3N1ZSBtZW1vcnkgb3BlcmF0
aW9uCiAgKi8KLSNkZWZpbmUgYXRvbWljX3JlYWRfX25vY2hlY2socCkgICAoKihfX3R5cGVvZl9f
KCoocCkpIHZvbGF0aWxlKikgKHApKQotI2RlZmluZSBhdG9taWNfc2V0X19ub2NoZWNrKHAsIGkp
ICgoKihfX3R5cGVvZl9fKCoocCkpIHZvbGF0aWxlKikgKHApKSA9IChpKSkKKyNkZWZpbmUgcWVt
dV9hdG9taWNfcmVhZF9fbm9jaGVjayhwKSAoKihfX3R5cGVvZl9fKCoocCkpIHZvbGF0aWxlKikg
KHApKQorI2RlZmluZSBxZW11X2F0b21pY19zZXRfX25vY2hlY2socCwgaSkgXAorICAgICgoKihf
X3R5cGVvZl9fKCoocCkpIHZvbGF0aWxlKikgKHApKSA9IChpKSkKIAotI2RlZmluZSBhdG9taWNf
cmVhZChwdHIpICAgICAgIGF0b21pY19yZWFkX19ub2NoZWNrKHB0cikKLSNkZWZpbmUgYXRvbWlj
X3NldChwdHIsIGkpICAgICBhdG9taWNfc2V0X19ub2NoZWNrKHB0cixpKQorI2RlZmluZSBxZW11
X2F0b21pY19yZWFkKHB0cikgICAgICAgcWVtdV9hdG9taWNfcmVhZF9fbm9jaGVjayhwdHIpCisj
ZGVmaW5lIHFlbXVfYXRvbWljX3NldChwdHIsIGkpICAgICBxZW11X2F0b21pY19zZXRfX25vY2hl
Y2socHRyLGkpCiAKIC8qKgotICogYXRvbWljX3JjdV9yZWFkIC0gcmVhZHMgYSBSQ1UtcHJvdGVj
dGVkIHBvaW50ZXIgdG8gYSBsb2NhbCB2YXJpYWJsZQorICogcWVtdV9hdG9taWNfcmN1X3JlYWQg
LSByZWFkcyBhIFJDVS1wcm90ZWN0ZWQgcG9pbnRlciB0byBhIGxvY2FsIHZhcmlhYmxlCiAgKiBp
bnRvIGEgUkNVIHJlYWQtc2lkZSBjcml0aWNhbCBzZWN0aW9uLiBUaGUgcG9pbnRlciBjYW4gbGF0
ZXIgYmUgc2FmZWx5CiAgKiBkZXJlZmVyZW5jZWQgd2l0aGluIHRoZSBjcml0aWNhbCBzZWN0aW9u
LgogICoKQEAgLTM0MiwyMSArMzYyLDIyIEBACiAgKiBJbnNlcnRzIG1lbW9yeSBiYXJyaWVycyBv
biBhcmNoaXRlY3R1cmVzIHRoYXQgcmVxdWlyZSB0aGVtIChjdXJyZW50bHkgb25seQogICogQWxw
aGEpIGFuZCBkb2N1bWVudHMgd2hpY2ggcG9pbnRlcnMgYXJlIHByb3RlY3RlZCBieSBSQ1UuCiAg
KgotICogYXRvbWljX3JjdV9yZWFkIGFsc28gaW5jbHVkZXMgYSBjb21waWxlciBiYXJyaWVyIHRv
IGVuc3VyZSB0aGF0CisgKiBxZW11X2F0b21pY19yY3VfcmVhZCBhbHNvIGluY2x1ZGVzIGEgY29t
cGlsZXIgYmFycmllciB0byBlbnN1cmUgdGhhdAogICogdmFsdWUtc3BlY3VsYXRpdmUgb3B0aW1p
emF0aW9ucyAoZS5nLiBWU1M6IFZhbHVlIFNwZWN1bGF0aW9uCiAgKiBTY2hlZHVsaW5nKSBkb2Vz
IG5vdCBwZXJmb3JtIHRoZSBkYXRhIHJlYWQgYmVmb3JlIHRoZSBwb2ludGVyIHJlYWQKICAqIGJ5
IHNwZWN1bGF0aW5nIHRoZSB2YWx1ZSBvZiB0aGUgcG9pbnRlci4KICAqCi0gKiBTaG91bGQgbWF0
Y2ggYXRvbWljX3JjdV9zZXQoKSwgYXRvbWljX3hjaGcoKSwgYXRvbWljX2NtcHhjaGcoKS4KKyAq
IFNob3VsZCBtYXRjaCBxZW11X2F0b21pY19yY3Vfc2V0KCksIHFlbXVfYXRvbWljX3hjaGcoKSwK
KyAqIGFuZCBxZW11X2F0b21pY19jbXB4Y2hnKCkuCiAgKi8KLSNkZWZpbmUgYXRvbWljX3JjdV9y
ZWFkKHB0cikgICAgKHsgICAgICAgICAgICAgICAgXAotICAgIHR5cGVvZigqcHRyKSBfdmFsID0g
YXRvbWljX3JlYWQocHRyKTsgICAgICAgICBcCisjZGVmaW5lIHFlbXVfYXRvbWljX3JjdV9yZWFk
KHB0cikgICAgKHsgICAgICAgICAgIFwKKyAgICB0eXBlb2YoKnB0cikgX3ZhbCA9IHFlbXVfYXRv
bWljX3JlYWQocHRyKTsgICAgXAogICAgIHNtcF9yZWFkX2JhcnJpZXJfZGVwZW5kcygpOyAgICAg
ICAgICAgICAgICAgICBcCiAgICAgX3ZhbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKIH0pCiAKIC8qKgotICogYXRvbWljX3JjdV9zZXQgLSBhc3NpZ25zIChwdWJs
aWNpemVzKSBhIHBvaW50ZXIgdG8gYSBuZXcgZGF0YSBzdHJ1Y3R1cmUKKyAqIHFlbXVfYXRvbWlj
X3JjdV9zZXQgLSBhc3NpZ25zIChwdWJsaWNpemVzKSBhIHBvaW50ZXIgdG8gYSBuZXcgZGF0YSBz
dHJ1Y3R1cmUKICAqIG1lYW50IHRvIGJlIHJlYWQgYnkgUkNVIHJlYWQtc2lkZSBjcml0aWNhbCBz
ZWN0aW9ucy4KICAqCiAgKiBEb2N1bWVudHMgd2hpY2ggcG9pbnRlcnMgd2lsbCBiZSBkZXJlZmVy
ZW5jZWQgYnkgUkNVIHJlYWQtc2lkZSBjcml0aWNhbApAQCAtMzY0LDY1ICszODUsNjMgQEAKICAq
IHRoZW0uIEl0IGFsc28gbWFrZXMgc3VyZSB0aGUgY29tcGlsZXIgZG9lcyBub3QgcmVvcmRlciBj
b2RlIGluaXRpYWxpemluZyB0aGUKICAqIGRhdGEgc3RydWN0dXJlIGJlZm9yZSBpdHMgcHVibGlj
YXRpb24uCiAgKgotICogU2hvdWxkIG1hdGNoIGF0b21pY19yY3VfcmVhZCgpLgorICogU2hvdWxk
IG1hdGNoIHFlbXVfYXRvbWljX3JjdV9yZWFkKCkuCiAgKi8KLSNkZWZpbmUgYXRvbWljX3JjdV9z
ZXQocHRyLCBpKSAgZG8geyAgICAgICAgICAgICAgXAorI2RlZmluZSBxZW11X2F0b21pY19yY3Vf
c2V0KHB0ciwgaSkgIGRvIHsgICAgICAgICBcCiAgICAgc21wX3dtYigpOyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNfc2V0KHB0ciwgaSk7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIHFlbXVfYXRvbWljX3NldChwdHIsIGkpOyAgICAgICAg
ICAgICAgICAgICAgICBcCiB9IHdoaWxlICgwKQogCi0jZGVmaW5lIGF0b21pY19sb2FkX2FjcXVp
cmUocHRyKSAgICAoeyAgICAgIFwKLSAgICB0eXBlb2YoKnB0cikgX3ZhbCA9IGF0b21pY19yZWFk
KHB0cik7ICAgXAotICAgIHNtcF9tYl9hY3F1aXJlKCk7ICAgICAgICAgICAgICAgICAgICAgICBc
Ci0gICAgX3ZhbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUg
cWVtdV9hdG9taWNfbG9hZF9hY3F1aXJlKHB0cikgICAgKHsgICAgXAorICAgIHR5cGVvZigqcHRy
KSBfdmFsID0gcWVtdV9hdG9taWNfcmVhZChwdHIpOyBcCisgICAgc21wX21iX2FjcXVpcmUoKTsg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBfdmFsOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAogfSkKIAotI2RlZmluZSBhdG9taWNfc3RvcmVfcmVsZWFzZShw
dHIsIGkpICBkbyB7ICBcCi0gICAgc21wX21iX3JlbGVhc2UoKTsgICAgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICBhdG9taWNfc2V0KHB0ciwgaSk7ICAgICAgICAgICAgICAgICAgICAgXAorI2Rl
ZmluZSBxZW11X2F0b21pY19zdG9yZV9yZWxlYXNlKHB0ciwgaSkgIGRvIHsgIFwKKyAgICBzbXBf
bWJfcmVsZWFzZSgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgcWVtdV9hdG9t
aWNfc2V0KHB0ciwgaSk7ICAgICAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSAoMCkKIAotI2lm
bmRlZiBhdG9taWNfeGNoZwogI2lmIGRlZmluZWQoX19jbGFuZ19fKQotI2RlZmluZSBhdG9taWNf
eGNoZyhwdHIsIGkpICAgIF9fc3luY19zd2FwKHB0ciwgaSkKKyNkZWZpbmUgcWVtdV9hdG9taWNf
eGNoZyhwdHIsIGkpIF9fc3luY19zd2FwKHB0ciwgaSkKICNlbHNlCiAvKiBfX3N5bmNfbG9ja190
ZXN0X2FuZF9zZXQoKSBpcyBkb2N1bWVudGVkIHRvIGJlIGFuIGFjcXVpcmUgYmFycmllciBvbmx5
LiAgKi8KLSNkZWZpbmUgYXRvbWljX3hjaGcocHRyLCBpKSAgICAoc21wX21iKCksIF9fc3luY19s
b2NrX3Rlc3RfYW5kX3NldChwdHIsIGkpKQorI2RlZmluZSBxZW11X2F0b21pY194Y2hnKHB0ciwg
aSkgKHNtcF9tYigpLCBfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQocHRyLCBpKSkKICNlbmRpZgot
I2VuZGlmCi0jZGVmaW5lIGF0b21pY194Y2hnX19ub2NoZWNrICBhdG9taWNfeGNoZworI2RlZmlu
ZSBxZW11X2F0b21pY194Y2hnX19ub2NoZWNrICBxZW11X2F0b21pY194Y2hnCiAKIC8qIFByb3Zp
ZGUgc2hvcnRlciBuYW1lcyBmb3IgR0NDIGF0b21pYyBidWlsdGlucy4gICovCi0jZGVmaW5lIGF0
b21pY19mZXRjaF9pbmMocHRyKSAgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRyLCAxKQotI2RlZmlu
ZSBhdG9taWNfZmV0Y2hfZGVjKHB0cikgIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgLTEpCisj
ZGVmaW5lIHFlbXVfYXRvbWljX2ZldGNoX2luYyhwdHIpICBfX3N5bmNfZmV0Y2hfYW5kX2FkZChw
dHIsIDEpCisjZGVmaW5lIHFlbXVfYXRvbWljX2ZldGNoX2RlYyhwdHIpICBfX3N5bmNfZmV0Y2hf
YW5kX2FkZChwdHIsIC0xKQogCi0jaWZuZGVmIGF0b21pY19mZXRjaF9hZGQKLSNkZWZpbmUgYXRv
bWljX2ZldGNoX2FkZChwdHIsIG4pIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgbikKLSNkZWZp
bmUgYXRvbWljX2ZldGNoX3N1YihwdHIsIG4pIF9fc3luY19mZXRjaF9hbmRfc3ViKHB0ciwgbikK
LSNkZWZpbmUgYXRvbWljX2ZldGNoX2FuZChwdHIsIG4pIF9fc3luY19mZXRjaF9hbmRfYW5kKHB0
ciwgbikKLSNkZWZpbmUgYXRvbWljX2ZldGNoX29yKHB0ciwgbikgX19zeW5jX2ZldGNoX2FuZF9v
cihwdHIsIG4pCi0jZGVmaW5lIGF0b21pY19mZXRjaF94b3IocHRyLCBuKSBfX3N5bmNfZmV0Y2hf
YW5kX3hvcihwdHIsIG4pCi0jZW5kaWYKKyNkZWZpbmUgcWVtdV9hdG9taWNfZmV0Y2hfYWRkKHB0
ciwgbikgX19zeW5jX2ZldGNoX2FuZF9hZGQocHRyLCBuKQorI2RlZmluZSBxZW11X2F0b21pY19m
ZXRjaF9zdWIocHRyLCBuKSBfX3N5bmNfZmV0Y2hfYW5kX3N1YihwdHIsIG4pCisjZGVmaW5lIHFl
bXVfYXRvbWljX2ZldGNoX2FuZChwdHIsIG4pIF9fc3luY19mZXRjaF9hbmRfYW5kKHB0ciwgbikK
KyNkZWZpbmUgcWVtdV9hdG9taWNfZmV0Y2hfb3IocHRyLCBuKSBfX3N5bmNfZmV0Y2hfYW5kX29y
KHB0ciwgbikKKyNkZWZpbmUgcWVtdV9hdG9taWNfZmV0Y2hfeG9yKHB0ciwgbikgX19zeW5jX2Zl
dGNoX2FuZF94b3IocHRyLCBuKQogCi0jZGVmaW5lIGF0b21pY19pbmNfZmV0Y2gocHRyKSAgX19z
eW5jX2FkZF9hbmRfZmV0Y2gocHRyLCAxKQotI2RlZmluZSBhdG9taWNfZGVjX2ZldGNoKHB0cikg
IF9fc3luY19hZGRfYW5kX2ZldGNoKHB0ciwgLTEpCi0jZGVmaW5lIGF0b21pY19hZGRfZmV0Y2go
cHRyLCBuKSBfX3N5bmNfYWRkX2FuZF9mZXRjaChwdHIsIG4pCi0jZGVmaW5lIGF0b21pY19zdWJf
ZmV0Y2gocHRyLCBuKSBfX3N5bmNfc3ViX2FuZF9mZXRjaChwdHIsIG4pCi0jZGVmaW5lIGF0b21p
Y19hbmRfZmV0Y2gocHRyLCBuKSBfX3N5bmNfYW5kX2FuZF9mZXRjaChwdHIsIG4pCi0jZGVmaW5l
IGF0b21pY19vcl9mZXRjaChwdHIsIG4pIF9fc3luY19vcl9hbmRfZmV0Y2gocHRyLCBuKQotI2Rl
ZmluZSBhdG9taWNfeG9yX2ZldGNoKHB0ciwgbikgX19zeW5jX3hvcl9hbmRfZmV0Y2gocHRyLCBu
KQorI2RlZmluZSBxZW11X2F0b21pY19pbmNfZmV0Y2gocHRyKSAgX19zeW5jX2FkZF9hbmRfZmV0
Y2gocHRyLCAxKQorI2RlZmluZSBxZW11X2F0b21pY19kZWNfZmV0Y2gocHRyKSAgX19zeW5jX2Fk
ZF9hbmRfZmV0Y2gocHRyLCAtMSkKKyNkZWZpbmUgcWVtdV9hdG9taWNfYWRkX2ZldGNoKHB0ciwg
bikgX19zeW5jX2FkZF9hbmRfZmV0Y2gocHRyLCBuKQorI2RlZmluZSBxZW11X2F0b21pY19zdWJf
ZmV0Y2gocHRyLCBuKSBfX3N5bmNfc3ViX2FuZF9mZXRjaChwdHIsIG4pCisjZGVmaW5lIHFlbXVf
YXRvbWljX2FuZF9mZXRjaChwdHIsIG4pIF9fc3luY19hbmRfYW5kX2ZldGNoKHB0ciwgbikKKyNk
ZWZpbmUgcWVtdV9hdG9taWNfb3JfZmV0Y2gocHRyLCBuKSBfX3N5bmNfb3JfYW5kX2ZldGNoKHB0
ciwgbikKKyNkZWZpbmUgcWVtdV9hdG9taWNfeG9yX2ZldGNoKHB0ciwgbikgX19zeW5jX3hvcl9h
bmRfZmV0Y2gocHRyLCBuKQogCi0jZGVmaW5lIGF0b21pY19jbXB4Y2hnKHB0ciwgb2xkLCBuZXcp
IF9fc3luY192YWxfY29tcGFyZV9hbmRfc3dhcChwdHIsIG9sZCwgbmV3KQotI2RlZmluZSBhdG9t
aWNfY21weGNoZ19fbm9jaGVjayhwdHIsIG9sZCwgbmV3KSAgYXRvbWljX2NtcHhjaGcocHRyLCBv
bGQsIG5ldykKKyNkZWZpbmUgcWVtdV9hdG9taWNfY21weGNoZyhwdHIsIG9sZCwgbmV3KSBcCisg
ICAgX19zeW5jX3ZhbF9jb21wYXJlX2FuZF9zd2FwKHB0ciwgb2xkLCBuZXcpCisjZGVmaW5lIHFl
bXVfYXRvbWljX2NtcHhjaGdfX25vY2hlY2socHRyLCBvbGQsIG5ldykgXAorICAgIHFlbXVfYXRv
bWljX2NtcHhjaGcocHRyLCBvbGQsIG5ldykKIAogLyogQW5kIGV2ZW4gc2hvcnRlciBuYW1lcyB0
aGF0IHJldHVybiB2b2lkLiAgKi8KLSNkZWZpbmUgYXRvbWljX2luYyhwdHIpICAgICAgICAoKHZv
aWQpIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgMSkpCi0jZGVmaW5lIGF0b21pY19kZWMocHRy
KSAgICAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZChwdHIsIC0xKSkKLSNkZWZpbmUg
YXRvbWljX2FkZChwdHIsIG4pICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwg
bikpCi0jZGVmaW5lIGF0b21pY19zdWIocHRyLCBuKSAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hf
YW5kX3N1YihwdHIsIG4pKQotI2RlZmluZSBhdG9taWNfYW5kKHB0ciwgbikgICAgICgodm9pZCkg
X19zeW5jX2ZldGNoX2FuZF9hbmQocHRyLCBuKSkKLSNkZWZpbmUgYXRvbWljX29yKHB0ciwgbikg
ICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9hbmRfb3IocHRyLCBuKSkKLSNkZWZpbmUgYXRvbWlj
X3hvcihwdHIsIG4pICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9hbmRfeG9yKHB0ciwgbikpCisj
ZGVmaW5lIHFlbXVfYXRvbWljX2luYyhwdHIpICAgICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9h
bmRfYWRkKHB0ciwgMSkpCisjZGVmaW5lIHFlbXVfYXRvbWljX2RlYyhwdHIpICAgICAgICAoKHZv
aWQpIF9fc3luY19mZXRjaF9hbmRfYWRkKHB0ciwgLTEpKQorI2RlZmluZSBxZW11X2F0b21pY19h
ZGQocHRyLCBuKSAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hfYW5kX2FkZChwdHIsIG4pKQorI2Rl
ZmluZSBxZW11X2F0b21pY19zdWIocHRyLCBuKSAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hfYW5k
X3N1YihwdHIsIG4pKQorI2RlZmluZSBxZW11X2F0b21pY19hbmQocHRyLCBuKSAgICAgKCh2b2lk
KSBfX3N5bmNfZmV0Y2hfYW5kX2FuZChwdHIsIG4pKQorI2RlZmluZSBxZW11X2F0b21pY19vcihw
dHIsIG4pICAgICAgKCh2b2lkKSBfX3N5bmNfZmV0Y2hfYW5kX29yKHB0ciwgbikpCisjZGVmaW5l
IHFlbXVfYXRvbWljX3hvcihwdHIsIG4pICAgICAoKHZvaWQpIF9fc3luY19mZXRjaF9hbmRfeG9y
KHB0ciwgbikpCiAKICNlbmRpZiAvKiBfX0FUT01JQ19SRUxBWEVEICovCiAKQEAgLTQzNiwxMSAr
NDU1LDExIEBACiAvKiBUaGlzIGlzIG1vcmUgZWZmaWNpZW50IHRoYW4gYSBzdG9yZSBwbHVzIGEg
ZmVuY2UuICAqLwogI2lmICFkZWZpbmVkKF9fU0FOSVRJWkVfVEhSRUFEX18pCiAjaWYgZGVmaW5l
ZChfX2kzODZfXykgfHwgZGVmaW5lZChfX3g4Nl82NF9fKSB8fCBkZWZpbmVkKF9fczM5MHhfXykK
LSNkZWZpbmUgYXRvbWljX21iX3NldChwdHIsIGkpICAoKHZvaWQpYXRvbWljX3hjaGcocHRyLCBp
KSkKKyNkZWZpbmUgcWVtdV9hdG9taWNfbWJfc2V0KHB0ciwgaSkgICgodm9pZClxZW11X2F0b21p
Y194Y2hnKHB0ciwgaSkpCiAjZW5kaWYKICNlbmRpZgogCi0vKiBhdG9taWNfbWJfcmVhZC9zZXQg
c2VtYW50aWNzIG1hcCBKYXZhIHZvbGF0aWxlIHZhcmlhYmxlcy4gVGhleSBhcmUKKy8qIHFlbXVf
YXRvbWljX21iX3JlYWQvc2V0IHNlbWFudGljcyBtYXAgSmF2YSB2b2xhdGlsZSB2YXJpYWJsZXMu
IFRoZXkgYXJlCiAgKiBsZXNzIGV4cGVuc2l2ZSBvbiBzb21lIHBsYXRmb3JtcyAobm90YWJseSBQ
T1dFUikgdGhhbiBmdWxseQogICogc2VxdWVudGlhbGx5IGNvbnNpc3RlbnQgb3BlcmF0aW9ucy4K
ICAqCkBAIC00NDgsNTggKzQ2Nyw1NSBAQAogICogdXNlLiBTZWUgZG9jcy9kZXZlbC9hdG9taWNz
LnR4dCBmb3IgbW9yZSBkaXNjdXNzaW9uLgogICovCiAKLSNpZm5kZWYgYXRvbWljX21iX3JlYWQK
LSNkZWZpbmUgYXRvbWljX21iX3JlYWQocHRyKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAotICAgIGF0b21pY19sb2FkX2FjcXVpcmUocHRyKQotI2VuZGlmCisjZGVmaW5lIHFlbXVfYXRv
bWljX21iX3JlYWQocHRyKSBxZW11X2F0b21pY19sb2FkX2FjcXVpcmUocHRyKQogCi0jaWZuZGVm
IGF0b21pY19tYl9zZXQKLSNkZWZpbmUgYXRvbWljX21iX3NldChwdHIsIGkpICBkbyB7ICAgICAg
ICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19zdG9yZV9yZWxlYXNlKHB0ciwgaSk7ICAgICAg
ICAgICAgICAgICAgICAgICBcCisjaWZuZGVmIHFlbXVfYXRvbWljX21iX3NldAorI2RlZmluZSBx
ZW11X2F0b21pY19tYl9zZXQocHRyLCBpKSAgZG8geyAgICAgICAgICAgICAgICBcCisgICAgcWVt
dV9hdG9taWNfc3RvcmVfcmVsZWFzZShwdHIsIGkpOyAgICAgICAgICAgICAgICAgIFwKICAgICBz
bXBfbWIoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSB3
aGlsZSgwKQogI2VuZGlmCiAKLSNkZWZpbmUgYXRvbWljX2ZldGNoX2luY19ub256ZXJvKHB0cikg
KHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICB0eXBlb2Zfc3RyaXBfcXVh
bCgqcHRyKSBfb2xkbiA9IGF0b21pY19yZWFkKHB0cik7ICAgICAgICAgICAgICAgICAgIFwKLSAg
ICB3aGlsZSAoX29sZG4gJiYgYXRvbWljX2NtcHhjaGcocHRyLCBfb2xkbiwgX29sZG4gKyAxKSAh
PSBfb2xkbikgeyAgIFwKLSAgICAgICAgX29sZG4gPSBhdG9taWNfcmVhZChwdHIpOyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUgcWVtdV9hdG9taWNfZmV0
Y2hfaW5jX25vbnplcm8ocHRyKSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICB0
eXBlb2Zfc3RyaXBfcXVhbCgqcHRyKSBfb2xkbiA9IHFlbXVfYXRvbWljX3JlYWQocHRyKTsgICAg
ICAgICAgICAgIFwKKyAgICB3aGlsZSAoX29sZG4gJiYgcWVtdV9hdG9taWNfY21weGNoZyhwdHIs
IF9vbGRuLCBfb2xkbiArIDEpICE9IF9vbGRuKSB7IFwKKyAgICAgICAgX29sZG4gPSBxZW11X2F0
b21pY19yZWFkKHB0cik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICB9
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKICAgICBfb2xkbjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKIH0pCiAKIC8qIEFic3RyYWN0aW9ucyB0byBh
Y2Nlc3MgYXRvbWljYWxseSAoaS5lLiAib25jZSIpIGk2NC91NjQgdmFyaWFibGVzICovCiAjaWZk
ZWYgQ09ORklHX0FUT01JQzY0Ci1zdGF0aWMgaW5saW5lIGludDY0X3QgYXRvbWljX3JlYWRfaTY0
KGNvbnN0IGludDY0X3QgKnB0cikKK3N0YXRpYyBpbmxpbmUgaW50NjRfdCBxZW11X2F0b21pY19y
ZWFkX2k2NChjb25zdCBpbnQ2NF90ICpwdHIpCiB7CiAgICAgLyogdXNlIF9fbm9jaGVjayBiZWNh
dXNlIHNpemVvZih2b2lkICopIG1pZ2h0IGJlIDwgc2l6ZW9mKHU2NCkgKi8KLSAgICByZXR1cm4g
YXRvbWljX3JlYWRfX25vY2hlY2socHRyKTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfcmVhZF9f
bm9jaGVjayhwdHIpOwogfQogCi1zdGF0aWMgaW5saW5lIHVpbnQ2NF90IGF0b21pY19yZWFkX3U2
NChjb25zdCB1aW50NjRfdCAqcHRyKQorc3RhdGljIGlubGluZSB1aW50NjRfdCBxZW11X2F0b21p
Y19yZWFkX3U2NChjb25zdCB1aW50NjRfdCAqcHRyKQogewotICAgIHJldHVybiBhdG9taWNfcmVh
ZF9fbm9jaGVjayhwdHIpOworICAgIHJldHVybiBxZW11X2F0b21pY19yZWFkX19ub2NoZWNrKHB0
cik7CiB9CiAKLXN0YXRpYyBpbmxpbmUgdm9pZCBhdG9taWNfc2V0X2k2NChpbnQ2NF90ICpwdHIs
IGludDY0X3QgdmFsKQorc3RhdGljIGlubGluZSB2b2lkIHFlbXVfYXRvbWljX3NldF9pNjQoaW50
NjRfdCAqcHRyLCBpbnQ2NF90IHZhbCkKIHsKLSAgICBhdG9taWNfc2V0X19ub2NoZWNrKHB0ciwg
dmFsKTsKKyAgICBxZW11X2F0b21pY19zZXRfX25vY2hlY2socHRyLCB2YWwpOwogfQogCi1zdGF0
aWMgaW5saW5lIHZvaWQgYXRvbWljX3NldF91NjQodWludDY0X3QgKnB0ciwgdWludDY0X3QgdmFs
KQorc3RhdGljIGlubGluZSB2b2lkIHFlbXVfYXRvbWljX3NldF91NjQodWludDY0X3QgKnB0ciwg
dWludDY0X3QgdmFsKQogewotICAgIGF0b21pY19zZXRfX25vY2hlY2socHRyLCB2YWwpOworICAg
IHFlbXVfYXRvbWljX3NldF9fbm9jaGVjayhwdHIsIHZhbCk7CiB9CiAKLXN0YXRpYyBpbmxpbmUg
dm9pZCBhdG9taWM2NF9pbml0KHZvaWQpCitzdGF0aWMgaW5saW5lIHZvaWQgcWVtdV9hdG9taWM2
NF9pbml0KHZvaWQpCiB7CiB9CiAjZWxzZSAvKiAhQ09ORklHX0FUT01JQzY0ICovCi1pbnQ2NF90
ICBhdG9taWNfcmVhZF9pNjQoY29uc3QgaW50NjRfdCAqcHRyKTsKLXVpbnQ2NF90IGF0b21pY19y
ZWFkX3U2NChjb25zdCB1aW50NjRfdCAqcHRyKTsKLXZvaWQgYXRvbWljX3NldF9pNjQoaW50NjRf
dCAqcHRyLCBpbnQ2NF90IHZhbCk7Ci12b2lkIGF0b21pY19zZXRfdTY0KHVpbnQ2NF90ICpwdHIs
IHVpbnQ2NF90IHZhbCk7Ci12b2lkIGF0b21pYzY0X2luaXQodm9pZCk7CitpbnQ2NF90ICBxZW11
X2F0b21pY19yZWFkX2k2NChjb25zdCBpbnQ2NF90ICpwdHIpOwordWludDY0X3QgcWVtdV9hdG9t
aWNfcmVhZF91NjQoY29uc3QgdWludDY0X3QgKnB0cik7Cit2b2lkIHFlbXVfYXRvbWljX3NldF9p
NjQoaW50NjRfdCAqcHRyLCBpbnQ2NF90IHZhbCk7Cit2b2lkIHFlbXVfYXRvbWljX3NldF91NjQo
dWludDY0X3QgKnB0ciwgdWludDY0X3QgdmFsKTsKK3ZvaWQgcWVtdV9hdG9taWM2NF9pbml0KHZv
aWQpOwogI2VuZGlmIC8qICFDT05GSUdfQVRPTUlDNjQgKi8KIAogI2VuZGlmIC8qIFFFTVVfQVRP
TUlDX0ggKi8KZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVtdS9hdG9taWMxMjguaCBiL2luY2x1ZGUv
cWVtdS9hdG9taWMxMjguaAppbmRleCA2YjM0NDg0ZTE1Li4xZmJiNTE0YzU5IDEwMDY0NAotLS0g
YS9pbmNsdWRlL3FlbXUvYXRvbWljMTI4LmgKKysrIGIvaW5jbHVkZS9xZW11L2F0b21pYzEyOC5o
CkBAIC00NCw3ICs0NCw3IEBACiAjaWYgZGVmaW5lZChDT05GSUdfQVRPTUlDMTI4KQogc3RhdGlj
IGlubGluZSBJbnQxMjggYXRvbWljMTZfY21weGNoZyhJbnQxMjggKnB0ciwgSW50MTI4IGNtcCwg
SW50MTI4IG5ldykKIHsKLSAgICByZXR1cm4gYXRvbWljX2NtcHhjaGdfX25vY2hlY2socHRyLCBj
bXAsIG5ldyk7CisgICAgcmV0dXJuIHFlbXVfYXRvbWljX2NtcHhjaGdfX25vY2hlY2socHRyLCBj
bXAsIG5ldyk7CiB9CiAjIGRlZmluZSBIQVZFX0NNUFhDSEcxMjggMQogI2VsaWYgZGVmaW5lZChD
T05GSUdfQ01QWENIRzEyOCkKQEAgLTg5LDEyICs4OSwxMiBAQCBJbnQxMjggUUVNVV9FUlJPUigi
dW5zdXBwb3J0ZWQgYXRvbWljIikKICNpZiBkZWZpbmVkKENPTkZJR19BVE9NSUMxMjgpCiBzdGF0
aWMgaW5saW5lIEludDEyOCBhdG9taWMxNl9yZWFkKEludDEyOCAqcHRyKQogewotICAgIHJldHVy
biBhdG9taWNfcmVhZF9fbm9jaGVjayhwdHIpOworICAgIHJldHVybiBxZW11X2F0b21pY19yZWFk
X19ub2NoZWNrKHB0cik7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBhdG9taWMxNl9zZXQoSW50
MTI4ICpwdHIsIEludDEyOCB2YWwpCiB7Ci0gICAgYXRvbWljX3NldF9fbm9jaGVjayhwdHIsIHZh
bCk7CisgICAgcWVtdV9hdG9taWNfc2V0X19ub2NoZWNrKHB0ciwgdmFsKTsKIH0KIAogIyBkZWZp
bmUgSEFWRV9BVE9NSUMxMjggMQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9xZW11L2JpdG9wcy5oIGIv
aW5jbHVkZS9xZW11L2JpdG9wcy5oCmluZGV4IGY1NWNlOGIzMjAuLmY3NDYwMGRlOTAgMTAwNjQ0
Ci0tLSBhL2luY2x1ZGUvcWVtdS9iaXRvcHMuaAorKysgYi9pbmNsdWRlL3FlbXUvYml0b3BzLmgK
QEAgLTUxLDcgKzUxLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHNldF9iaXRfYXRvbWljKGxvbmcg
bnIsIHVuc2lnbmVkIGxvbmcgKmFkZHIpCiAgICAgdW5zaWduZWQgbG9uZyBtYXNrID0gQklUX01B
U0sobnIpOwogICAgIHVuc2lnbmVkIGxvbmcgKnAgPSBhZGRyICsgQklUX1dPUkQobnIpOwogCi0g
ICAgYXRvbWljX29yKHAsIG1hc2spOworICAgIHFlbXVfYXRvbWljX29yKHAsIG1hc2spOwogfQog
CiAvKioKZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVtdS9jb3JvdXRpbmUuaCBiL2luY2x1ZGUvcWVt
dS9jb3JvdXRpbmUuaAppbmRleCBkZmQyNjFjNWIxLi40ZDcwMjBkMTg4IDEwMDY0NAotLS0gYS9p
bmNsdWRlL3FlbXUvY29yb3V0aW5lLmgKKysrIGIvaW5jbHVkZS9xZW11L2Nvcm91dGluZS5oCkBA
IC0xNzksNyArMTc5LDcgQEAgc3RhdGljIGlubGluZSBjb3JvdXRpbmVfZm4gdm9pZCBxZW11X2Nv
X211dGV4X2Fzc2VydF9sb2NrZWQoQ29NdXRleCAqbXV0ZXgpCiAgICAgICogYmVjYXVzZSB0aGUg
Y29uZGl0aW9uIHdpbGwgYmUgZmFsc2Ugbm8gbWF0dGVyIHdoZXRoZXIgd2UgcmVhZCBOVUxMIG9y
CiAgICAgICogdGhlIHBvaW50ZXIgZm9yIGFueSBvdGhlciBjb3JvdXRpbmUuCiAgICAgICovCi0g
ICAgYXNzZXJ0KGF0b21pY19yZWFkKCZtdXRleC0+bG9ja2VkKSAmJgorICAgIGFzc2VydChxZW11
X2F0b21pY19yZWFkKCZtdXRleC0+bG9ja2VkKSAmJgogICAgICAgICAgICBtdXRleC0+aG9sZGVy
ID09IHFlbXVfY29yb3V0aW5lX3NlbGYoKSk7CiB9CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVt
dS9sb2cuaCBiL2luY2x1ZGUvcWVtdS9sb2cuaAppbmRleCBmNDcyNGY3MzMwLi5lNGQ0NTRjY2Zh
IDEwMDY0NAotLS0gYS9pbmNsdWRlL3FlbXUvbG9nLmgKKysrIGIvaW5jbHVkZS9xZW11L2xvZy5o
CkBAIC0zNiw3ICszNiw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBxZW11X2xvZ19zZXBhcmF0ZSh2
b2lkKQogICAgIGJvb2wgcmVzID0gZmFsc2U7CiAKICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAg
bG9nZmlsZSA9IGF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsKKyAgICBsb2dmaWxlID0g
cWVtdV9hdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgaWYgKGxvZ2ZpbGUgJiYg
bG9nZmlsZS0+ZmQgIT0gc3RkZXJyKSB7CiAgICAgICAgIHJlcyA9IHRydWU7CiAgICAgfQpAQCAt
NzUsNyArNzUsNyBAQCBzdGF0aWMgaW5saW5lIEZJTEUgKnFlbXVfbG9nX2xvY2sodm9pZCkKIHsK
ICAgICBRZW11TG9nRmlsZSAqbG9nZmlsZTsKICAgICByY3VfcmVhZF9sb2NrKCk7Ci0gICAgbG9n
ZmlsZSA9IGF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsKKyAgICBsb2dmaWxlID0gcWVt
dV9hdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAgaWYgKGxvZ2ZpbGUpIHsKICAg
ICAgICAgcWVtdV9mbG9ja2ZpbGUobG9nZmlsZS0+ZmQpOwogICAgICAgICByZXR1cm4gbG9nZmls
ZS0+ZmQ7CkBAIC0xMDIsNyArMTAyLDcgQEAgcWVtdV9sb2dfdnByaW50Zihjb25zdCBjaGFyICpm
bXQsIHZhX2xpc3QgdmEpCiAgICAgUWVtdUxvZ0ZpbGUgKmxvZ2ZpbGU7CiAKICAgICByY3VfcmVh
ZF9sb2NrKCk7Ci0gICAgbG9nZmlsZSA9IGF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsK
KyAgICBsb2dmaWxlID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAg
aWYgKGxvZ2ZpbGUpIHsKICAgICAgICAgdmZwcmludGYobG9nZmlsZS0+ZmQsIGZtdCwgdmEpOwog
ICAgIH0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVtdS9xdWV1ZS5oIGIvaW5jbHVkZS9xZW11L3F1
ZXVlLmgKaW5kZXggNDU2YTViMDFlZS4uNzA3YWUxMDA2MiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9x
ZW11L3F1ZXVlLmgKKysrIGIvaW5jbHVkZS9xZW11L3F1ZXVlLmgKQEAgLTIxOCwxMiArMjE4LDEz
IEBAIHN0cnVjdCB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgdHlwZW9mKGVsbSkgc2F2ZV9zbGVfbmV4dDsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgICAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCiAgICAgICAgICAgICBzYXZlX3NsZV9uZXh0ID0gKGVsbSktPmZpZWxkLnNsZV9u
ZXh0ID0gKGhlYWQpLT5zbGhfZmlyc3Q7ICAgICAgIFwKLSAgICAgICAgfSB3aGlsZSAoYXRvbWlj
X2NtcHhjaGcoJihoZWFkKS0+c2xoX2ZpcnN0LCBzYXZlX3NsZV9uZXh0LCAoZWxtKSkgIT0gXAor
ICAgICAgICB9IHdoaWxlIChxZW11X2F0b21pY19jbXB4Y2hnKCYoaGVhZCktPnNsaF9maXJzdCwg
ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc2F2ZV9zbGVfbmV4dCwgKGVsbSkpICE9ICAgICAgICAgICAgICAgIFwKICAgICAgICAgICAg
ICAgICAgc2F2ZV9zbGVfbmV4dCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzApCiAKICNkZWZpbmUgUVNMSVNUX01P
VkVfQVRPTUlDKGRlc3QsIHNyYykgZG8geyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
Ci0gICAgICAgIChkZXN0KS0+c2xoX2ZpcnN0ID0gYXRvbWljX3hjaGcoJihzcmMpLT5zbGhfZmly
c3QsIE5VTEwpOyAgICAgICAgXAorICAgICAgICAoZGVzdCktPnNsaF9maXJzdCA9IHFlbXVfYXRv
bWljX3hjaGcoJihzcmMpLT5zbGhfZmlyc3QsIE5VTEwpOyAgIFwKIH0gd2hpbGUgKC8qQ09OU1RD
T05EKi8wKQogCiAjZGVmaW5lIFFTTElTVF9SRU1PVkVfSEVBRChoZWFkLCBmaWVsZCkgZG8geyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXApAQCAtMzc2LDcgKzM3Nyw4IEBAIHN0cnVjdCB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKIC8qCiAgKiBTaW1wbGUgcXVldWUgYWNjZXNzIG1ldGhvZHMuCiAgKi8KLSNkZWZp
bmUgUVNJTVBMRVFfRU1QVFlfQVRPTUlDKGhlYWQpIChhdG9taWNfcmVhZCgmKChoZWFkKS0+c3Fo
X2ZpcnN0KSkgPT0gTlVMTCkKKyNkZWZpbmUgUVNJTVBMRVFfRU1QVFlfQVRPTUlDKGhlYWQpIFwK
KyAgICAocWVtdV9hdG9taWNfcmVhZCgmKChoZWFkKS0+c3FoX2ZpcnN0KSkgPT0gTlVMTCkKICNk
ZWZpbmUgUVNJTVBMRVFfRU1QVFkoaGVhZCkgICAgICAgICgoaGVhZCktPnNxaF9maXJzdCA9PSBO
VUxMKQogI2RlZmluZSBRU0lNUExFUV9GSVJTVChoZWFkKSAgICAgICAgKChoZWFkKS0+c3FoX2Zp
cnN0KQogI2RlZmluZSBRU0lNUExFUV9ORVhUKGVsbSwgZmllbGQpICAgKChlbG0pLT5maWVsZC5z
cWVfbmV4dCkKZGlmZiAtLWdpdCBhL2luY2x1ZGUvcWVtdS9yY3UuaCBiL2luY2x1ZGUvcWVtdS9y
Y3UuaAppbmRleCAwZTM3NWViZTEzLi45NmExYmI5MDM5IDEwMDY0NAotLS0gYS9pbmNsdWRlL3Fl
bXUvcmN1LmgKKysrIGIvaW5jbHVkZS9xZW11L3JjdS5oCkBAIC03OSw4ICs3OSw4IEBAIHN0YXRp
YyBpbmxpbmUgdm9pZCByY3VfcmVhZF9sb2NrKHZvaWQpCiAgICAgICAgIHJldHVybjsKICAgICB9
CiAKLSAgICBjdHIgPSBhdG9taWNfcmVhZCgmcmN1X2dwX2N0cik7Ci0gICAgYXRvbWljX3NldCgm
cF9yY3VfcmVhZGVyLT5jdHIsIGN0cik7CisgICAgY3RyID0gcWVtdV9hdG9taWNfcmVhZCgmcmN1
X2dwX2N0cik7CisgICAgcWVtdV9hdG9taWNfc2V0KCZwX3JjdV9yZWFkZXItPmN0ciwgY3RyKTsK
IAogICAgIC8qIFdyaXRlIHBfcmN1X3JlYWRlci0+Y3RyIGJlZm9yZSByZWFkaW5nIFJDVS1wcm90
ZWN0ZWQgcG9pbnRlcnMuICAqLwogICAgIHNtcF9tYl9wbGFjZWhvbGRlcigpOwpAQCAtMTAwLDEy
ICsxMDAsMTIgQEAgc3RhdGljIGlubGluZSB2b2lkIHJjdV9yZWFkX3VubG9jayh2b2lkKQogICAg
ICAqIHNtcF9tYl9wbGFjZWhvbGRlcigpLCB0aGlzIGVuc3VyZXMgd3JpdGVzIHRvIHBfcmN1X3Jl
YWRlci0+Y3RyCiAgICAgICogYXJlIHNlcXVlbnRpYWxseSBjb25zaXN0ZW50LgogICAgICAqLwot
ICAgIGF0b21pY19zdG9yZV9yZWxlYXNlKCZwX3JjdV9yZWFkZXItPmN0ciwgMCk7CisgICAgcWVt
dV9hdG9taWNfc3RvcmVfcmVsZWFzZSgmcF9yY3VfcmVhZGVyLT5jdHIsIDApOwogCiAgICAgLyog
V3JpdGUgcF9yY3VfcmVhZGVyLT5jdHIgYmVmb3JlIHJlYWRpbmcgcF9yY3VfcmVhZGVyLT53YWl0
aW5nLiAgKi8KICAgICBzbXBfbWJfcGxhY2Vob2xkZXIoKTsKLSAgICBpZiAodW5saWtlbHkoYXRv
bWljX3JlYWQoJnBfcmN1X3JlYWRlci0+d2FpdGluZykpKSB7Ci0gICAgICAgIGF0b21pY19zZXQo
JnBfcmN1X3JlYWRlci0+d2FpdGluZywgZmFsc2UpOworICAgIGlmICh1bmxpa2VseShxZW11X2F0
b21pY19yZWFkKCZwX3JjdV9yZWFkZXItPndhaXRpbmcpKSkgeworICAgICAgICBxZW11X2F0b21p
Y19zZXQoJnBfcmN1X3JlYWRlci0+d2FpdGluZywgZmFsc2UpOwogICAgICAgICBxZW11X2V2ZW50
X3NldCgmcmN1X2dwX2V2ZW50KTsKICAgICB9CiB9CmRpZmYgLS1naXQgYS9pbmNsdWRlL3FlbXUv
cmN1X3F1ZXVlLmggYi9pbmNsdWRlL3FlbXUvcmN1X3F1ZXVlLmgKaW5kZXggNTU4OTYxY2MyNy4u
Mzk0YjFkN2RhZiAxMDA2NDQKLS0tIGEvaW5jbHVkZS9xZW11L3JjdV9xdWV1ZS5oCisrKyBiL2lu
Y2x1ZGUvcWVtdS9yY3VfcXVldWUuaApAQCAtMzYsOSArMzYsMTAgQEAgZXh0ZXJuICJDIiB7CiAv
KgogICogTGlzdCBhY2Nlc3MgbWV0aG9kcy4KICAqLwotI2RlZmluZSBRTElTVF9FTVBUWV9SQ1Uo
aGVhZCkgKGF0b21pY19yZWFkKCYoaGVhZCktPmxoX2ZpcnN0KSA9PSBOVUxMKQotI2RlZmluZSBR
TElTVF9GSVJTVF9SQ1UoaGVhZCkgKGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5saF9maXJzdCkp
Ci0jZGVmaW5lIFFMSVNUX05FWFRfUkNVKGVsbSwgZmllbGQpIChhdG9taWNfcmN1X3JlYWQoJihl
bG0pLT5maWVsZC5sZV9uZXh0KSkKKyNkZWZpbmUgUUxJU1RfRU1QVFlfUkNVKGhlYWQpIChxZW11
X2F0b21pY19yZWFkKCYoaGVhZCktPmxoX2ZpcnN0KSA9PSBOVUxMKQorI2RlZmluZSBRTElTVF9G
SVJTVF9SQ1UoaGVhZCkgKHFlbXVfYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPmxoX2ZpcnN0KSkK
KyNkZWZpbmUgUUxJU1RfTkVYVF9SQ1UoZWxtLCBmaWVsZCkgXAorICAgIChxZW11X2F0b21pY19y
Y3VfcmVhZCgmKGVsbSktPmZpZWxkLmxlX25leHQpKQogCiAvKgogICogTGlzdCBmdW5jdGlvbnMu
CkBAIC00Niw3ICs0Nyw3IEBAIGV4dGVybiAiQyIgewogCiAKIC8qCi0gKiAgVGhlIGRpZmZlcmVu
Y2UgYmV0d2VlbiBhdG9taWNfcmVhZC9zZXQgYW5kIGF0b21pY19yY3VfcmVhZC9zZXQKKyAqICBU
aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHFlbXVfYXRvbWljX3JlYWQvc2V0IGFuZCBxZW11X2F0b21p
Y19yY3VfcmVhZC9zZXQKICAqICBpcyBpbiB0aGUgaW5jbHVkaW5nIG9mIGEgcmVhZC93cml0ZSBt
ZW1vcnkgYmFycmllciB0byB0aGUgdm9sYXRpbGUKICAqICBhY2Nlc3MuIGF0b21pY19yY3VfKiBt
YWNyb3MgaW5jbHVkZSB0aGUgbWVtb3J5IGJhcnJpZXIsIHRoZQogICogIHBsYWluIGF0b21pYyBt
YWNyb3MgZG8gbm90LiBUaGVyZWZvcmUsIGl0IHNob3VsZCBiZSBjb3JyZWN0IHRvCkBAIC02Niw3
ICs2Nyw3IEBAIGV4dGVybiAiQyIgewogI2RlZmluZSBRTElTVF9JTlNFUlRfQUZURVJfUkNVKGxp
c3RlbG0sIGVsbSwgZmllbGQpIGRvIHsgICAgXAogICAgIChlbG0pLT5maWVsZC5sZV9uZXh0ID0g
KGxpc3RlbG0pLT5maWVsZC5sZV9uZXh0OyAgICAgICAgXAogICAgIChlbG0pLT5maWVsZC5sZV9w
cmV2ID0gJihsaXN0ZWxtKS0+ZmllbGQubGVfbmV4dDsgICAgICAgXAotICAgIGF0b21pY19yY3Vf
c2V0KCYobGlzdGVsbSktPmZpZWxkLmxlX25leHQsIChlbG0pKTsgICAgICAgXAorICAgIHFlbXVf
YXRvbWljX3JjdV9zZXQoJihsaXN0ZWxtKS0+ZmllbGQubGVfbmV4dCwgKGVsbSkpOyAgICAgICBc
CiAgICAgaWYgKChlbG0pLT5maWVsZC5sZV9uZXh0ICE9IE5VTEwpIHsgICAgICAgICAgICAgICAg
ICAgICBcCiAgICAgICAgKGVsbSktPmZpZWxkLmxlX25leHQtPmZpZWxkLmxlX3ByZXYgPSAgICAg
ICAgICAgICAgICBcCiAgICAgICAgICYoZWxtKS0+ZmllbGQubGVfbmV4dDsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBcCkBAIC04Miw3ICs4Myw3IEBAIGV4dGVybiAiQyIgewogI2RlZmlu
ZSBRTElTVF9JTlNFUlRfQkVGT1JFX1JDVShsaXN0ZWxtLCBlbG0sIGZpZWxkKSBkbyB7ICAgXAog
ICAgIChlbG0pLT5maWVsZC5sZV9wcmV2ID0gKGxpc3RlbG0pLT5maWVsZC5sZV9wcmV2OyAgICAg
ICAgXAogICAgIChlbG0pLT5maWVsZC5sZV9uZXh0ID0gKGxpc3RlbG0pOyAgICAgICAgICAgICAg
ICAgICAgICAgXAotICAgIGF0b21pY19yY3Vfc2V0KChsaXN0ZWxtKS0+ZmllbGQubGVfcHJldiwg
KGVsbSkpOyAgICAgICAgXAorICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoKGxpc3RlbG0pLT5maWVs
ZC5sZV9wcmV2LCAoZWxtKSk7ICAgICAgICBcCiAgICAgKGxpc3RlbG0pLT5maWVsZC5sZV9wcmV2
ID0gJihlbG0pLT5maWVsZC5sZV9uZXh0OyAgICAgICBcCiB9IHdoaWxlICgvKkNPTlNUQ09ORCov
MCkKIApAQCAtOTUsNyArOTYsNyBAQCBleHRlcm4gIkMiIHsKICNkZWZpbmUgUUxJU1RfSU5TRVJU
X0hFQURfUkNVKGhlYWQsIGVsbSwgZmllbGQpIGRvIHsgICAgXAogICAgIChlbG0pLT5maWVsZC5s
ZV9wcmV2ID0gJihoZWFkKS0+bGhfZmlyc3Q7ICAgICAgICAgICBcCiAgICAgKGVsbSktPmZpZWxk
LmxlX25leHQgPSAoaGVhZCktPmxoX2ZpcnN0OyAgICAgICAgICAgIFwKLSAgICBhdG9taWNfcmN1
X3NldCgoJihoZWFkKS0+bGhfZmlyc3QpLCAoZWxtKSk7ICAgICAgICAgXAorICAgIHFlbXVfYXRv
bWljX3JjdV9zZXQoKCYoaGVhZCktPmxoX2ZpcnN0KSwgKGVsbSkpOyAgICAgICAgIFwKICAgICBp
ZiAoKGVsbSktPmZpZWxkLmxlX25leHQgIT0gTlVMTCkgeyAgICAgICAgICAgICAgICAgXAogICAg
ICAgIChlbG0pLT5maWVsZC5sZV9uZXh0LT5maWVsZC5sZV9wcmV2ID0gICAgICAgICAgICBcCiAg
ICAgICAgICYoZWxtKS0+ZmllbGQubGVfbmV4dDsgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
QEAgLTExMiwyMCArMTEzLDIwIEBAIGV4dGVybiAiQyIgewogICAgICAgIChlbG0pLT5maWVsZC5s
ZV9uZXh0LT5maWVsZC5sZV9wcmV2ID0gICAgICAgIFwKICAgICAgICAgKGVsbSktPmZpZWxkLmxl
X3ByZXY7ICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgfSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19zZXQoKGVsbSktPmZpZWxk
LmxlX3ByZXYsIChlbG0pLT5maWVsZC5sZV9uZXh0KTsgXAorICAgIHFlbXVfYXRvbWljX3NldCgo
ZWxtKS0+ZmllbGQubGVfcHJldiwgKGVsbSktPmZpZWxkLmxlX25leHQpOyBcCiB9IHdoaWxlICgv
KkNPTlNUQ09ORCovMCkKIAogLyogTGlzdCB0cmF2ZXJzYWwgbXVzdCBvY2N1ciB3aXRoaW4gYW4g
UkNVIGNyaXRpY2FsIHNlY3Rpb24uICAqLwogI2RlZmluZSBRTElTVF9GT1JFQUNIX1JDVSh2YXIs
IGhlYWQsIGZpZWxkKSAgICAgICAgICAgICAgICAgXAotICAgICAgICBmb3IgKCh2YXIpID0gYXRv
bWljX3JjdV9yZWFkKCYoaGVhZCktPmxoX2ZpcnN0KTsgICAgXAorICAgICAgICBmb3IgKCh2YXIp
ID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+bGhfZmlyc3QpOyAgICBcCiAgICAgICAg
ICAgICAgICAgKHZhcik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0g
ICAgICAgICAgICAgICAgKHZhcikgPSBhdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC5sZV9u
ZXh0KSkKKyAgICAgICAgICAgICAgICAodmFyKSA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCYodmFy
KS0+ZmllbGQubGVfbmV4dCkpCiAKIC8qIExpc3QgdHJhdmVyc2FsIG11c3Qgb2NjdXIgd2l0aGlu
IGFuIFJDVSBjcml0aWNhbCBzZWN0aW9uLiAgKi8KICNkZWZpbmUgUUxJU1RfRk9SRUFDSF9TQUZF
X1JDVSh2YXIsIGhlYWQsIGZpZWxkLCBuZXh0X3ZhcikgICAgICAgICAgIFwKLSAgICBmb3IgKCh2
YXIpID0gKGF0b21pY19yY3VfcmVhZCgmKGhlYWQpLT5saF9maXJzdCkpOyAgICAgICAgICAgICAg
IFwKKyAgICBmb3IgKCh2YXIpID0gKHFlbXVfYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPmxoX2Zp
cnN0KSk7ICAgICAgICAgICAgICAgXAogICAgICAgKHZhcikgJiYgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgICgobmV4dF92
YXIpID0gYXRvbWljX3JjdV9yZWFkKCYodmFyKS0+ZmllbGQubGVfbmV4dCksIDEpOyAgXAorICAg
ICAgICAgICgobmV4dF92YXIpID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC5s
ZV9uZXh0KSwgMSk7ICBcCiAgICAgICAgICAgICh2YXIpID0gKG5leHRfdmFyKSkKIAogLyoKQEAg
LTEzMyw5ICsxMzQsMTEgQEAgZXh0ZXJuICJDIiB7CiAgKi8KIAogLyogU2ltcGxlIHF1ZXVlIGFj
Y2VzcyBtZXRob2RzICovCi0jZGVmaW5lIFFTSU1QTEVRX0VNUFRZX1JDVShoZWFkKSAgICAgIChh
dG9taWNfcmVhZCgmKGhlYWQpLT5zcWhfZmlyc3QpID09IE5VTEwpCi0jZGVmaW5lIFFTSU1QTEVR
X0ZJUlNUX1JDVShoZWFkKSAgICAgICBhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c3FoX2ZpcnN0
KQotI2RlZmluZSBRU0lNUExFUV9ORVhUX1JDVShlbG0sIGZpZWxkKSAgYXRvbWljX3JjdV9yZWFk
KCYoZWxtKS0+ZmllbGQuc3FlX25leHQpCisjZGVmaW5lIFFTSU1QTEVRX0VNUFRZX1JDVShoZWFk
KSBcCisgICAgKHFlbXVfYXRvbWljX3JlYWQoJihoZWFkKS0+c3FoX2ZpcnN0KSA9PSBOVUxMKQor
I2RlZmluZSBRU0lNUExFUV9GSVJTVF9SQ1UoaGVhZCkgcWVtdV9hdG9taWNfcmN1X3JlYWQoJiho
ZWFkKS0+c3FoX2ZpcnN0KQorI2RlZmluZSBRU0lNUExFUV9ORVhUX1JDVShlbG0sIGZpZWxkKSBc
CisgICAgcWVtdV9hdG9taWNfcmN1X3JlYWQoJihlbG0pLT5maWVsZC5zcWVfbmV4dCkKIAogLyog
U2ltcGxlIHF1ZXVlIGZ1bmN0aW9ucyAqLwogI2RlZmluZSBRU0lNUExFUV9JTlNFUlRfSEVBRF9S
Q1UoaGVhZCwgZWxtLCBmaWVsZCkgZG8geyAgICAgICAgIFwKQEAgLTE0MywxMiArMTQ2LDEyIEBA
IGV4dGVybiAiQyIgewogICAgIGlmICgoZWxtKS0+ZmllbGQuc3FlX25leHQgPT0gTlVMTCkgeyAg
ICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgKGhlYWQpLT5zcWhfbGFzdCA9ICYoZWxt
KS0+ZmllbGQuc3FlX25leHQ7ICAgICAgICAgICAgICBcCiAgICAgfSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19y
Y3Vfc2V0KCYoaGVhZCktPnNxaF9maXJzdCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgIFwKKyAg
ICBxZW11X2F0b21pY19yY3Vfc2V0KCYoaGVhZCktPnNxaF9maXJzdCwgKGVsbSkpOyAgICAgICAg
ICAgICAgICAgIFwKIH0gd2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTSU1QTEVR
X0lOU0VSVF9UQUlMX1JDVShoZWFkLCBlbG0sIGZpZWxkKSBkbyB7ICAgIFwKICAgICAoZWxtKS0+
ZmllbGQuc3FlX25leHQgPSBOVUxMOyAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0
b21pY19yY3Vfc2V0KChoZWFkKS0+c3FoX2xhc3QsIChlbG0pKTsgICAgICAgICAgICAgICBcCisg
ICAgcWVtdV9hdG9taWNfcmN1X3NldCgoaGVhZCktPnNxaF9sYXN0LCAoZWxtKSk7ICAgICAgICAg
ICAgICAgXAogICAgIChoZWFkKS0+c3FoX2xhc3QgPSAmKGVsbSktPmZpZWxkLnNxZV9uZXh0OyAg
ICAgICAgICAgICBcCiB9IHdoaWxlICgvKkNPTlNUQ09ORCovMCkKIApAQCAtMTU3LDExICsxNjAs
MTEgQEAgZXh0ZXJuICJDIiB7CiAgICAgaWYgKChlbG0pLT5maWVsZC5zcWVfbmV4dCA9PSBOVUxM
KSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIChoZWFkKS0+c3Fo
X2xhc3QgPSAmKGVsbSktPmZpZWxkLnNxZV9uZXh0OyAgICAgICAgICAgICAgICAgICAgICBcCiAg
ICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCi0gICAgYXRvbWljX3JjdV9zZXQoJihsaXN0ZWxtKS0+ZmllbGQuc3Fl
X25leHQsIChlbG0pKTsgICAgICAgICAgICAgICAgICBcCisgICAgcWVtdV9hdG9taWNfcmN1X3Nl
dCgmKGxpc3RlbG0pLT5maWVsZC5zcWVfbmV4dCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgIFwK
IH0gd2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTSU1QTEVRX1JFTU9WRV9IRUFE
X1JDVShoZWFkLCBmaWVsZCkgZG8geyAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNf
c2V0KCYoaGVhZCktPnNxaF9maXJzdCwgKGhlYWQpLT5zcWhfZmlyc3QtPmZpZWxkLnNxZV9uZXh0
KTsgXAorICAgIHFlbXVfYXRvbWljX3NldCgmKGhlYWQpLT5zcWhfZmlyc3QsIChoZWFkKS0+c3Fo
X2ZpcnN0LT5maWVsZC5zcWVfbmV4dCk7IFwKICAgICBpZiAoKGhlYWQpLT5zcWhfZmlyc3QgPT0g
TlVMTCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgICAgICAoaGVh
ZCktPnNxaF9sYXN0ID0gJihoZWFkKS0+c3FoX2ZpcnN0OyAgICAgICAgICAgICAgICAgICAgICAg
ICBcCiAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKQEAgLTE3NSw3ICsxNzgsNyBAQCBleHRlcm4gIkMiIHsKICAg
ICAgICAgd2hpbGUgKGN1cnItPmZpZWxkLnNxZV9uZXh0ICE9IChlbG0pKSB7ICAgICAgICAgICAg
ICAgICAgICAgXAogICAgICAgICAgICAgY3VyciA9IGN1cnItPmZpZWxkLnNxZV9uZXh0OyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgYXRvbWljX3Nl
dCgmY3Vyci0+ZmllbGQuc3FlX25leHQsICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAg
ICAgICBxZW11X2F0b21pY19zZXQoJmN1cnItPmZpZWxkLnNxZV9uZXh0LCAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKICAgICAgICAgICAgICAgICAgICBjdXJyLT5maWVsZC5zcWVfbmV4dC0+
ZmllbGQuc3FlX25leHQpOyAgICAgICAgICAgXAogICAgICAgICBpZiAoY3Vyci0+ZmllbGQuc3Fl
X25leHQgPT0gTlVMTCkgeyAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgICAgICAo
aGVhZCktPnNxaF9sYXN0ID0gJihjdXJyKS0+ZmllbGQuc3FlX25leHQ7ICAgICAgICAgICAgIFwK
QEAgLTE4NCwxMyArMTg3LDEzIEBAIGV4dGVybiAiQyIgewogfSB3aGlsZSAoLypDT05TVENPTkQq
LzApCiAKICNkZWZpbmUgUVNJTVBMRVFfRk9SRUFDSF9SQ1UodmFyLCBoZWFkLCBmaWVsZCkgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBmb3IgKCh2YXIpID0gYXRvbWljX3JjdV9yZWFk
KCYoaGVhZCktPnNxaF9maXJzdCk7ICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCh2YXIp
ID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c3FoX2ZpcnN0KTsgICAgICAgICAgICAg
ICAgICAgXAogICAgICAgICAgKHZhcik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgKHZhcikgPSBhdG9taWNfcmN1X3Jl
YWQoJih2YXIpLT5maWVsZC5zcWVfbmV4dCkpCisgICAgICAgICAodmFyKSA9IHFlbXVfYXRvbWlj
X3JjdV9yZWFkKCYodmFyKS0+ZmllbGQuc3FlX25leHQpKQogCiAjZGVmaW5lIFFTSU1QTEVRX0ZP
UkVBQ0hfU0FGRV9SQ1UodmFyLCBoZWFkLCBmaWVsZCwgbmV4dCkgICAgICAgICAgICAgICAgXAot
ICAgIGZvciAoKHZhcikgPSBhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c3FoX2ZpcnN0KTsgICAg
ICAgICAgICAgICAgICAgIFwKLSAgICAgICAgICh2YXIpICYmICgobmV4dCkgPSBhdG9taWNfcmN1
X3JlYWQoJih2YXIpLT5maWVsZC5zcWVfbmV4dCksIDEpOyBcCisgICAgZm9yICgodmFyKSA9IHFl
bXVfYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnNxaF9maXJzdCk7ICAgICAgICAgICAgICAgICAg
ICBcCisgICAgICAgICAodmFyKSAmJiAoKG5leHQpID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJih2
YXIpLT5maWVsZC5zcWVfbmV4dCksIDEpOyBcCiAgICAgICAgICAodmFyKSA9IChuZXh0KSkKIAog
LyoKQEAgLTE5OCw5ICsyMDEsMTEgQEAgZXh0ZXJuICJDIiB7CiAgKi8KIAogLyogVGFpbCBxdWV1
ZSBhY2Nlc3MgbWV0aG9kcyAqLwotI2RlZmluZSBRVEFJTFFfRU1QVFlfUkNVKGhlYWQpICAgICAg
KGF0b21pY19yZWFkKCYoaGVhZCktPnRxaF9maXJzdCkgPT0gTlVMTCkKLSNkZWZpbmUgUVRBSUxR
X0ZJUlNUX1JDVShoZWFkKSAgICAgICBhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+dHFoX2ZpcnN0
KQotI2RlZmluZSBRVEFJTFFfTkVYVF9SQ1UoZWxtLCBmaWVsZCkgIGF0b21pY19yY3VfcmVhZCgm
KGVsbSktPmZpZWxkLnRxZV9uZXh0KQorI2RlZmluZSBRVEFJTFFfRU1QVFlfUkNVKGhlYWQpIFwK
KyAgICAocWVtdV9hdG9taWNfcmVhZCgmKGhlYWQpLT50cWhfZmlyc3QpID09IE5VTEwpCisjZGVm
aW5lIFFUQUlMUV9GSVJTVF9SQ1UoaGVhZCkgcWVtdV9hdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+
dHFoX2ZpcnN0KQorI2RlZmluZSBRVEFJTFFfTkVYVF9SQ1UoZWxtLCBmaWVsZCkgXAorICAgIHFl
bXVfYXRvbWljX3JjdV9yZWFkKCYoZWxtKS0+ZmllbGQudHFlX25leHQpCiAKIC8qIFRhaWwgcXVl
dWUgZnVuY3Rpb25zICovCiAjZGVmaW5lIFFUQUlMUV9JTlNFUlRfSEVBRF9SQ1UoaGVhZCwgZWxt
LCBmaWVsZCkgZG8geyAgICAgICAgICAgICAgICAgICBcCkBAIC0yMTEsMTQgKzIxNiwxNCBAQCBl
eHRlcm4gIkMiIHsKICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgKGhlYWQpLT50cWhfY2lyYy50
cWxfcHJldiA9ICYoZWxtKS0+ZmllbGQudHFlX2NpcmM7ICAgICAgICAgICAgIFwKICAgICB9ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKLSAgICBhdG9taWNfcmN1X3NldCgmKGhlYWQpLT50cWhfZmlyc3QsIChlbG0pKTsg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBxZW11X2F0b21pY19yY3Vfc2V0KCYoaGVh
ZCktPnRxaF9maXJzdCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIChl
bG0pLT5maWVsZC50cWVfY2lyYy50cWxfcHJldiA9ICYoaGVhZCktPnRxaF9jaXJjOyAgICAgICAg
ICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzApCiAKICNkZWZpbmUgUVRBSUxRX0lO
U0VSVF9UQUlMX1JDVShoZWFkLCBlbG0sIGZpZWxkKSBkbyB7ICAgICAgICAgICAgICAgICAgIFwK
ICAgICAoZWxtKS0+ZmllbGQudHFlX25leHQgPSBOVUxMOyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFwKICAgICAoZWxtKS0+ZmllbGQudHFlX2NpcmMudHFsX3ByZXYgPSAo
aGVhZCktPnRxaF9jaXJjLnRxbF9wcmV2OyAgICAgICAgIFwKLSAgICBhdG9taWNfcmN1X3NldCgm
KGhlYWQpLT50cWhfY2lyYy50cWxfcHJldi0+dHFsX25leHQsIChlbG0pKTsgICAgICAgIFwKKyAg
ICBxZW11X2F0b21pY19yY3Vfc2V0KCYoaGVhZCktPnRxaF9jaXJjLnRxbF9wcmV2LT50cWxfbmV4
dCwgKGVsbSkpOyAgICAgICAgXAogICAgIChoZWFkKS0+dHFoX2NpcmMudHFsX3ByZXYgPSAmKGVs
bSktPmZpZWxkLnRxZV9jaXJjOyAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENP
TkQqLzApCiAKQEAgLTIzMCwxNCArMjM1LDE1IEBAIGV4dGVybiAiQyIgewogICAgIH0gZWxzZSB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAogICAgICAgICAoaGVhZCktPnRxaF9jaXJjLnRxbF9wcmV2ID0gJihlbG0pLT5maWVsZC50
cWVfY2lyYzsgICAgICAgICAgICAgXAogICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19yY3Vf
c2V0KCYobGlzdGVsbSktPmZpZWxkLnRxZV9uZXh0LCAoZWxtKSk7ICAgICAgICAgICAgICAgICAg
XAorICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoJihsaXN0ZWxtKS0+ZmllbGQudHFlX25leHQsIChl
bG0pKTsgICAgICAgICAgICAgICAgICBcCiAgICAgKGVsbSktPmZpZWxkLnRxZV9jaXJjLnRxbF9w
cmV2ID0gJihsaXN0ZWxtKS0+ZmllbGQudHFlX2NpcmM7ICAgICAgICBcCiB9IHdoaWxlICgvKkNP
TlNUQ09ORCovMCkKIAogI2RlZmluZSBRVEFJTFFfSU5TRVJUX0JFRk9SRV9SQ1UobGlzdGVsbSwg
ZWxtLCBmaWVsZCkgZG8geyAgICAgICAgICAgICAgICBcCiAgICAgKGVsbSktPmZpZWxkLnRxZV9j
aXJjLnRxbF9wcmV2ID0gKGxpc3RlbG0pLT5maWVsZC50cWVfY2lyYy50cWxfcHJldjsgIFwKICAg
ICAoZWxtKS0+ZmllbGQudHFlX25leHQgPSAobGlzdGVsbSk7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19yY3Vfc2V0KCYobGlzdGVsbSktPmZpZWxkLnRx
ZV9jaXJjLnRxbF9wcmV2LT50cWxfbmV4dCwgKGVsbSkpOyBcCisgICAgcWVtdV9hdG9taWNfcmN1
X3NldCgmKGxpc3RlbG0pLT5maWVsZC50cWVfY2lyYy50cWxfcHJldi0+dHFsX25leHQsICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgICAgIChlbG0pKTsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAogICAgIChsaXN0ZWxtKS0+ZmllbGQudHFlX2NpcmMudHFsX3By
ZXYgPSAmKGVsbSktPmZpZWxkLnRxZV9jaXJjOyAgICAgICAgICBcCiB9IHdoaWxlICgvKkNPTlNU
Q09ORCovMCkKIApAQCAtMjQ4LDE4ICsyNTQsMTkgQEAgZXh0ZXJuICJDIiB7CiAgICAgfSBlbHNl
IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCiAgICAgICAgIChoZWFkKS0+dHFoX2NpcmMudHFsX3ByZXYgPSAoZWxtKS0+ZmllbGQu
dHFlX2NpcmMudHFsX3ByZXY7ICAgICBcCiAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgYXRvbWljX3Nl
dCgmKGVsbSktPmZpZWxkLnRxZV9jaXJjLnRxbF9wcmV2LT50cWxfbmV4dCwgKGVsbSktPmZpZWxk
LnRxZV9uZXh0KTsgXAorICAgIHFlbXVfYXRvbWljX3NldCgmKGVsbSktPmZpZWxkLnRxZV9jaXJj
LnRxbF9wcmV2LT50cWxfbmV4dCwgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAoZWxt
KS0+ZmllbGQudHFlX25leHQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIChl
bG0pLT5maWVsZC50cWVfY2lyYy50cWxfcHJldiA9IE5VTEw7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAogfSB3aGlsZSAoLypDT05TVENPTkQqLzApCiAKICNkZWZpbmUgUVRBSUxRX0ZP
UkVBQ0hfUkNVKHZhciwgaGVhZCwgZmllbGQpICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
LSAgICBmb3IgKCh2YXIpID0gYXRvbWljX3JjdV9yZWFkKCYoaGVhZCktPnRxaF9maXJzdCk7ICAg
ICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCh2YXIpID0gcWVtdV9hdG9taWNfcmN1X3JlYWQo
JihoZWFkKS0+dHFoX2ZpcnN0KTsgICAgICAgICAgICAgICAgICAgXAogICAgICAgICAgKHZhcik7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAotICAgICAgICAgKHZhcikgPSBhdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC50cWVfbmV4
dCkpCisgICAgICAgICAodmFyKSA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCYodmFyKS0+ZmllbGQu
dHFlX25leHQpKQogCiAjZGVmaW5lIFFUQUlMUV9GT1JFQUNIX1NBRkVfUkNVKHZhciwgaGVhZCwg
ZmllbGQsIG5leHQpICAgICAgICAgICAgICAgICAgXAotICAgIGZvciAoKHZhcikgPSBhdG9taWNf
cmN1X3JlYWQoJihoZWFkKS0+dHFoX2ZpcnN0KTsgICAgICAgICAgICAgICAgICAgIFwKLSAgICAg
ICAgICh2YXIpICYmICgobmV4dCkgPSBhdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC50cWVf
bmV4dCksIDEpOyBcCisgICAgZm9yICgodmFyKSA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCYoaGVh
ZCktPnRxaF9maXJzdCk7ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAodmFyKSAmJiAo
KG5leHQpID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC50cWVfbmV4dCksIDEp
OyBcCiAgICAgICAgICAodmFyKSA9IChuZXh0KSkKIAogLyoKQEAgLTI2NywyMyArMjc0LDI1IEBA
IGV4dGVybiAiQyIgewogICovCiAKIC8qIFNpbmdseS1saW5rZWQgbGlzdCBhY2Nlc3MgbWV0aG9k
cyAqLwotI2RlZmluZSBRU0xJU1RfRU1QVFlfUkNVKGhlYWQpICAgICAgKGF0b21pY19yZWFkKCYo
aGVhZCktPnNsaF9maXJzdCkgPT0gTlVMTCkKLSNkZWZpbmUgUVNMSVNUX0ZJUlNUX1JDVShoZWFk
KSAgICAgICBhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c2xoX2ZpcnN0KQotI2RlZmluZSBRU0xJ
U1RfTkVYVF9SQ1UoZWxtLCBmaWVsZCkgIGF0b21pY19yY3VfcmVhZCgmKGVsbSktPmZpZWxkLnNs
ZV9uZXh0KQorI2RlZmluZSBRU0xJU1RfRU1QVFlfUkNVKGhlYWQpIFwKKyAgICAocWVtdV9hdG9t
aWNfcmVhZCgmKGhlYWQpLT5zbGhfZmlyc3QpID09IE5VTEwpCisjZGVmaW5lIFFTTElTVF9GSVJT
VF9SQ1UoaGVhZCkgcWVtdV9hdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c2xoX2ZpcnN0KQorI2Rl
ZmluZSBRU0xJU1RfTkVYVF9SQ1UoZWxtLCBmaWVsZCkgXAorICAgIHFlbXVfYXRvbWljX3JjdV9y
ZWFkKCYoZWxtKS0+ZmllbGQuc2xlX25leHQpCiAKIC8qIFNpbmdseS1saW5rZWQgbGlzdCBmdW5j
dGlvbnMgKi8KICNkZWZpbmUgUVNMSVNUX0lOU0VSVF9IRUFEX1JDVShoZWFkLCBlbG0sIGZpZWxk
KSBkbyB7ICAgICAgICAgICBcCiAgICAgKGVsbSktPmZpZWxkLnNsZV9uZXh0ID0gKGhlYWQpLT5z
bGhfZmlyc3Q7ICAgICAgICAgICAgICAgICAgXAotICAgIGF0b21pY19yY3Vfc2V0KCYoaGVhZCkt
PnNsaF9maXJzdCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgIFwKKyAgICBxZW11X2F0b21pY19y
Y3Vfc2V0KCYoaGVhZCktPnNsaF9maXJzdCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgIFwKIH0g
d2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTTElTVF9JTlNFUlRfQUZURVJfUkNV
KGhlYWQsIGxpc3RlbG0sIGVsbSwgZmllbGQpIGRvIHsgICAgICAgICBcCiAgICAgKGVsbSktPmZp
ZWxkLnNsZV9uZXh0ID0gKGxpc3RlbG0pLT5maWVsZC5zbGVfbmV4dDsgICAgICAgICAgICAgICAg
ICBcCi0gICAgYXRvbWljX3JjdV9zZXQoJihsaXN0ZWxtKS0+ZmllbGQuc2xlX25leHQsIChlbG0p
KTsgICAgICAgICAgICAgICAgICBcCisgICAgcWVtdV9hdG9taWNfcmN1X3NldCgmKGxpc3RlbG0p
LT5maWVsZC5zbGVfbmV4dCwgKGVsbSkpOyAgICAgICAgICAgICAgICAgIFwKIH0gd2hpbGUgKC8q
Q09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTTElTVF9SRU1PVkVfSEVBRF9SQ1UoaGVhZCwgZmll
bGQpIGRvIHsgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICBhdG9taWNfc2V0KCYoaGVhZCkt
PnNsaF9maXJzdCwgKGhlYWQpLT5zbGhfZmlyc3QtPmZpZWxkLnNsZV9uZXh0KTsgXAorICAgIHFl
bXVfYXRvbWljX3NldCgmKGhlYWQpLT5zbGhfZmlyc3QsIChoZWFkKS0+c2xoX2ZpcnN0LT5maWVs
ZC5zbGVfbmV4dCk7IFwKIH0gd2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVmaW5lIFFTTElT
VF9SRU1PVkVfUkNVKGhlYWQsIGVsbSwgdHlwZSwgZmllbGQpIGRvIHsgICAgICAgICAgICAgIFwK
QEAgLTI5NCwxOSArMzAzLDE5IEBAIGV4dGVybiAiQyIgewogICAgICAgICB3aGlsZSAoY3Vyci0+
ZmllbGQuc2xlX25leHQgIT0gKGVsbSkpIHsgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAg
ICAgICBjdXJyID0gY3Vyci0+ZmllbGQuc2xlX25leHQ7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAotICAgICAgICBhdG9taWNfc2V0KCZjdXJyLT5maWVsZC5zbGVf
bmV4dCwgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIHFlbXVfYXRvbWljX3Nl
dCgmY3Vyci0+ZmllbGQuc2xlX25leHQsICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAg
ICAgICAgICAgICAgICAgIGN1cnItPmZpZWxkLnNsZV9uZXh0LT5maWVsZC5zbGVfbmV4dCk7ICAg
ICAgICAgICBcCiAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKIH0gd2hpbGUgKC8qQ09OU1RDT05EKi8wKQogCiAjZGVm
aW5lIFFTTElTVF9GT1JFQUNIX1JDVSh2YXIsIGhlYWQsIGZpZWxkKSAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAotICAgIGZvciAoKHZhcikgPSBhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c2xo
X2ZpcnN0KTsgICAgICAgICAgICAgICAgICAgXAorICAgIGZvciAoKHZhcikgPSBxZW11X2F0b21p
Y19yY3VfcmVhZCgmKGhlYWQpLT5zbGhfZmlyc3QpOyAgICAgICAgICAgICAgICAgICBcCiAgICAg
ICAgICAodmFyKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCi0gICAgICAgICAodmFyKSA9IGF0b21pY19yY3VfcmVhZCgmKHZhciktPmZp
ZWxkLnNsZV9uZXh0KSkKKyAgICAgICAgICh2YXIpID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJih2
YXIpLT5maWVsZC5zbGVfbmV4dCkpCiAKICNkZWZpbmUgUVNMSVNUX0ZPUkVBQ0hfU0FGRV9SQ1Uo
dmFyLCBoZWFkLCBmaWVsZCwgbmV4dCkgICAgICAgICAgICAgICAgXAotICAgIGZvciAoKHZhcikg
PSBhdG9taWNfcmN1X3JlYWQoJihoZWFkKS0+c2xoX2ZpcnN0KTsgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICh2YXIpICYmICgobmV4dCkgPSBhdG9taWNfcmN1X3JlYWQoJih2YXIpLT5m
aWVsZC5zbGVfbmV4dCksIDEpOyBcCisgICAgZm9yICgodmFyKSA9IHFlbXVfYXRvbWljX3JjdV9y
ZWFkKCYoaGVhZCktPnNsaF9maXJzdCk7ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAo
dmFyKSAmJiAoKG5leHQpID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJih2YXIpLT5maWVsZC5zbGVf
bmV4dCksIDEpOyBcCiAgICAgICAgICAodmFyKSA9IChuZXh0KSkKIAogI2lmZGVmIF9fY3BsdXNw
bHVzCmRpZmYgLS1naXQgYS9pbmNsdWRlL3FlbXUvc2VxbG9jay5oIGIvaW5jbHVkZS9xZW11L3Nl
cWxvY2suaAppbmRleCA4YjZiNGVlNGJiLi5iMjgyYWVmMDc4IDEwMDY0NAotLS0gYS9pbmNsdWRl
L3FlbXUvc2VxbG9jay5oCisrKyBiL2luY2x1ZGUvcWVtdS9zZXFsb2NrLmgKQEAgLTMyLDcgKzMy
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHNlcWxvY2tfaW5pdChRZW11U2VxTG9jayAqc2wpCiAv
KiBMb2NrIG91dCBvdGhlciB3cml0ZXJzIGFuZCB1cGRhdGUgdGhlIGNvdW50LiAgKi8KIHN0YXRp
YyBpbmxpbmUgdm9pZCBzZXFsb2NrX3dyaXRlX2JlZ2luKFFlbXVTZXFMb2NrICpzbCkKIHsKLSAg
ICBhdG9taWNfc2V0KCZzbC0+c2VxdWVuY2UsIHNsLT5zZXF1ZW5jZSArIDEpOworICAgIHFlbXVf
YXRvbWljX3NldCgmc2wtPnNlcXVlbmNlLCBzbC0+c2VxdWVuY2UgKyAxKTsKIAogICAgIC8qIFdy
aXRlIHNlcXVlbmNlIGJlZm9yZSB1cGRhdGluZyBvdGhlciBmaWVsZHMuICAqLwogICAgIHNtcF93
bWIoKTsKQEAgLTQzLDcgKzQzLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHNlcWxvY2tfd3JpdGVf
ZW5kKFFlbXVTZXFMb2NrICpzbCkKICAgICAvKiBXcml0ZSBvdGhlciBmaWVsZHMgYmVmb3JlIGZp
bmFsaXppbmcgc2VxdWVuY2UuICAqLwogICAgIHNtcF93bWIoKTsKIAotICAgIGF0b21pY19zZXQo
JnNsLT5zZXF1ZW5jZSwgc2wtPnNlcXVlbmNlICsgMSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZz
bC0+c2VxdWVuY2UsIHNsLT5zZXF1ZW5jZSArIDEpOwogfQogCiAvKiBMb2NrIG91dCBvdGhlciB3
cml0ZXJzIGFuZCB1cGRhdGUgdGhlIGNvdW50LiAgKi8KQEAgLTY4LDcgKzY4LDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIHNlcWxvY2tfd3JpdGVfdW5sb2NrX2ltcGwoUWVtdVNlcUxvY2sgKnNsLCBR
ZW11TG9ja2FibGUgKmxvY2sKIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgc2VxbG9ja19yZWFkX2Jl
Z2luKGNvbnN0IFFlbXVTZXFMb2NrICpzbCkKIHsKICAgICAvKiBBbHdheXMgZmFpbCBpZiBhIHdy
aXRlIGlzIGluIHByb2dyZXNzLiAgKi8KLSAgICB1bnNpZ25lZCByZXQgPSBhdG9taWNfcmVhZCgm
c2wtPnNlcXVlbmNlKTsKKyAgICB1bnNpZ25lZCByZXQgPSBxZW11X2F0b21pY19yZWFkKCZzbC0+
c2VxdWVuY2UpOwogCiAgICAgLyogUmVhZCBzZXF1ZW5jZSBiZWZvcmUgcmVhZGluZyBvdGhlciBm
aWVsZHMuICAqLwogICAgIHNtcF9ybWIoKTsKQEAgLTc5LDcgKzc5LDcgQEAgc3RhdGljIGlubGlu
ZSBpbnQgc2VxbG9ja19yZWFkX3JldHJ5KGNvbnN0IFFlbXVTZXFMb2NrICpzbCwgdW5zaWduZWQg
c3RhcnQpCiB7CiAgICAgLyogUmVhZCBvdGhlciBmaWVsZHMgYmVmb3JlIHJlYWRpbmcgZmluYWwg
c2VxdWVuY2UuICAqLwogICAgIHNtcF9ybWIoKTsKLSAgICByZXR1cm4gdW5saWtlbHkoYXRvbWlj
X3JlYWQoJnNsLT5zZXF1ZW5jZSkgIT0gc3RhcnQpOworICAgIHJldHVybiB1bmxpa2VseShxZW11
X2F0b21pY19yZWFkKCZzbC0+c2VxdWVuY2UpICE9IHN0YXJ0KTsKIH0KIAogI2VuZGlmCmRpZmYg
LS1naXQgYS9pbmNsdWRlL3FlbXUvc3RhdHM2NC5oIGIvaW5jbHVkZS9xZW11L3N0YXRzNjQuaApp
bmRleCAxOWE1YWM0YzU2Li5kNDNlY2ExZGQyIDEwMDY0NAotLS0gYS9pbmNsdWRlL3FlbXUvc3Rh
dHM2NC5oCisrKyBiL2luY2x1ZGUvcWVtdS9zdGF0czY0LmgKQEAgLTM3LDI3ICszNywyNyBAQCBz
dGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X2luaXQoU3RhdDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkK
IAogc3RhdGljIGlubGluZSB1aW50NjRfdCBzdGF0NjRfZ2V0KGNvbnN0IFN0YXQ2NCAqcykKIHsK
LSAgICByZXR1cm4gYXRvbWljX3JlYWRfX25vY2hlY2soJnMtPnZhbHVlKTsKKyAgICByZXR1cm4g
cWVtdV9hdG9taWNfcmVhZF9fbm9jaGVjaygmcy0+dmFsdWUpOwogfQogCiBzdGF0aWMgaW5saW5l
IHZvaWQgc3RhdDY0X2FkZChTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogewotICAgIGF0b21p
Y19hZGQoJnMtPnZhbHVlLCB2YWx1ZSk7CisgICAgcWVtdV9hdG9taWNfYWRkKCZzLT52YWx1ZSwg
dmFsdWUpOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X21pbihTdGF0NjQgKnMsIHVp
bnQ2NF90IHZhbHVlKQogewotICAgIHVpbnQ2NF90IG9yaWcgPSBhdG9taWNfcmVhZF9fbm9jaGVj
aygmcy0+dmFsdWUpOworICAgIHVpbnQ2NF90IG9yaWcgPSBxZW11X2F0b21pY19yZWFkX19ub2No
ZWNrKCZzLT52YWx1ZSk7CiAgICAgd2hpbGUgKG9yaWcgPiB2YWx1ZSkgewotICAgICAgICBvcmln
ID0gYXRvbWljX2NtcHhjaGdfX25vY2hlY2soJnMtPnZhbHVlLCBvcmlnLCB2YWx1ZSk7CisgICAg
ICAgIG9yaWcgPSBxZW11X2F0b21pY19jbXB4Y2hnX19ub2NoZWNrKCZzLT52YWx1ZSwgb3JpZywg
dmFsdWUpOwogICAgIH0KIH0KIAogc3RhdGljIGlubGluZSB2b2lkIHN0YXQ2NF9tYXgoU3RhdDY0
ICpzLCB1aW50NjRfdCB2YWx1ZSkKIHsKLSAgICB1aW50NjRfdCBvcmlnID0gYXRvbWljX3JlYWRf
X25vY2hlY2soJnMtPnZhbHVlKTsKKyAgICB1aW50NjRfdCBvcmlnID0gcWVtdV9hdG9taWNfcmVh
ZF9fbm9jaGVjaygmcy0+dmFsdWUpOwogICAgIHdoaWxlIChvcmlnIDwgdmFsdWUpIHsKLSAgICAg
ICAgb3JpZyA9IGF0b21pY19jbXB4Y2hnX19ub2NoZWNrKCZzLT52YWx1ZSwgb3JpZywgdmFsdWUp
OworICAgICAgICBvcmlnID0gcWVtdV9hdG9taWNfY21weGNoZ19fbm9jaGVjaygmcy0+dmFsdWUs
IG9yaWcsIHZhbHVlKTsKICAgICB9CiB9CiAjZWxzZQpAQCAtNzksNyArNzksNyBAQCBzdGF0aWMg
aW5saW5lIHZvaWQgc3RhdDY0X2FkZChTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgIGxv
dyA9ICh1aW50MzJfdCkgdmFsdWU7CiAgICAgaWYgKCFsb3cpIHsKICAgICAgICAgaWYgKGhpZ2gp
IHsKLSAgICAgICAgICAgIGF0b21pY19hZGQoJnMtPmhpZ2gsIGhpZ2gpOworICAgICAgICAgICAg
cWVtdV9hdG9taWNfYWRkKCZzLT5oaWdoLCBoaWdoKTsKICAgICAgICAgfQogICAgICAgICByZXR1
cm47CiAgICAgfQpAQCAtMTAxLDcgKzEwMSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzdGF0NjRf
YWRkKFN0YXQ2NCAqcywgdWludDY0X3QgdmFsdWUpCiAgICAgICAgICAqIHRoZSBoaWdoIDMyIGJp
dHMsIHNvIGl0IGNhbiByYWNlIGp1c3QgZmluZSB3aXRoIHN0YXQ2NF9hZGQzMl9jYXJyeQogICAg
ICAgICAgKiBhbmQgZXZlbiBzdGF0NjRfZ2V0IQogICAgICAgICAgKi8KLSAgICAgICAgb2xkID0g
YXRvbWljX2NtcHhjaGcoJnMtPmxvdywgb3JpZywgcmVzdWx0KTsKKyAgICAgICAgb2xkID0gcWVt
dV9hdG9taWNfY21weGNoZygmcy0+bG93LCBvcmlnLCByZXN1bHQpOwogICAgICAgICBpZiAob3Jp
ZyA9PSBvbGQpIHsKICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgfQpAQCAtMTE2LDcgKzEx
Niw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzdGF0NjRfbWluKFN0YXQ2NCAqcywgdWludDY0X3Qg
dmFsdWUpCiAgICAgaGlnaCA9IHZhbHVlID4+IDMyOwogICAgIGxvdyA9ICh1aW50MzJfdCkgdmFs
dWU7CiAgICAgZG8gewotICAgICAgICBvcmlnX2hpZ2ggPSBhdG9taWNfcmVhZCgmcy0+aGlnaCk7
CisgICAgICAgIG9yaWdfaGlnaCA9IHFlbXVfYXRvbWljX3JlYWQoJnMtPmhpZ2gpOwogICAgICAg
ICBpZiAob3JpZ19oaWdoIDwgaGlnaCkgewogICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICB9
CkBAIC0xMjgsNyArMTI4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHN0YXQ2NF9taW4oU3RhdDY0
ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAgICAgICAgICAgICAqIHRoZSB3cml0ZSBiYXJyaWVyIGlu
IHN0YXQ2NF9taW5fc2xvdy4KICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgc21wX3JtYigp
OwotICAgICAgICAgICAgb3JpZ19sb3cgPSBhdG9taWNfcmVhZCgmcy0+bG93KTsKKyAgICAgICAg
ICAgIG9yaWdfbG93ID0gcWVtdV9hdG9taWNfcmVhZCgmcy0+bG93KTsKICAgICAgICAgICAgIGlm
IChvcmlnX2xvdyA8PSBsb3cpIHsKICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg
ICB9CkBAIC0xMzgsNyArMTM4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHN0YXQ2NF9taW4oU3Rh
dDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAgICAgICAgICAgICAqIHdlIG1heSBtaXNzIGJlaW5n
IGx1Y2t5LgogICAgICAgICAgICAgICovCiAgICAgICAgICAgICBzbXBfcm1iKCk7Ci0gICAgICAg
ICAgICBvcmlnX2hpZ2ggPSBhdG9taWNfcmVhZCgmcy0+aGlnaCk7CisgICAgICAgICAgICBvcmln
X2hpZ2ggPSBxZW11X2F0b21pY19yZWFkKCZzLT5oaWdoKTsKICAgICAgICAgICAgIGlmIChvcmln
X2hpZ2ggPCBoaWdoKSB7CiAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgfQpA
QCAtMTU2LDcgKzE1Niw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzdGF0NjRfbWF4KFN0YXQ2NCAq
cywgdWludDY0X3QgdmFsdWUpCiAgICAgaGlnaCA9IHZhbHVlID4+IDMyOwogICAgIGxvdyA9ICh1
aW50MzJfdCkgdmFsdWU7CiAgICAgZG8gewotICAgICAgICBvcmlnX2hpZ2ggPSBhdG9taWNfcmVh
ZCgmcy0+aGlnaCk7CisgICAgICAgIG9yaWdfaGlnaCA9IHFlbXVfYXRvbWljX3JlYWQoJnMtPmhp
Z2gpOwogICAgICAgICBpZiAob3JpZ19oaWdoID4gaGlnaCkgewogICAgICAgICAgICAgcmV0dXJu
OwogICAgICAgICB9CkBAIC0xNjgsNyArMTY4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHN0YXQ2
NF9tYXgoU3RhdDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAgICAgICAgICAgICAqIHRoZSB3cml0
ZSBiYXJyaWVyIGluIHN0YXQ2NF9tYXhfc2xvdy4KICAgICAgICAgICAgICAqLwogICAgICAgICAg
ICAgc21wX3JtYigpOwotICAgICAgICAgICAgb3JpZ19sb3cgPSBhdG9taWNfcmVhZCgmcy0+bG93
KTsKKyAgICAgICAgICAgIG9yaWdfbG93ID0gcWVtdV9hdG9taWNfcmVhZCgmcy0+bG93KTsKICAg
ICAgICAgICAgIGlmIChvcmlnX2xvdyA+PSBsb3cpIHsKICAgICAgICAgICAgICAgICByZXR1cm47
CiAgICAgICAgICAgICB9CkBAIC0xNzgsNyArMTc4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHN0
YXQ2NF9tYXgoU3RhdDY0ICpzLCB1aW50NjRfdCB2YWx1ZSkKICAgICAgICAgICAgICAqIHdlIG1h
eSBtaXNzIGJlaW5nIGx1Y2t5LgogICAgICAgICAgICAgICovCiAgICAgICAgICAgICBzbXBfcm1i
KCk7Ci0gICAgICAgICAgICBvcmlnX2hpZ2ggPSBhdG9taWNfcmVhZCgmcy0+aGlnaCk7CisgICAg
ICAgICAgICBvcmlnX2hpZ2ggPSBxZW11X2F0b21pY19yZWFkKCZzLT5oaWdoKTsKICAgICAgICAg
ICAgIGlmIChvcmlnX2hpZ2ggPiBoaWdoKSB7CiAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg
ICAgICAgICAgfQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9xZW11L3RocmVhZC5oIGIvaW5jbHVkZS9x
ZW11L3RocmVhZC5oCmluZGV4IDRiYWY0ZDE3MTUuLjEwNGU4MTEyMzYgMTAwNjQ0Ci0tLSBhL2lu
Y2x1ZGUvcWVtdS90aHJlYWQuaAorKysgYi9pbmNsdWRlL3FlbXUvdGhyZWFkLmgKQEAgLTY5LDM1
ICs2OSwzOCBAQCBleHRlcm4gUWVtdUNvbmRUaW1lZFdhaXRGdW5jIHFlbXVfY29uZF90aW1lZHdh
aXRfZnVuYzsKICNkZWZpbmUgcWVtdV9jb25kX3RpbWVkd2FpdChjLCBtLCBtcykgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgICAgIHFlbXVfY29uZF90aW1lZHdh
aXRfaW1wbChjLCBtLCBtcywgX19GSUxFX18sIF9fTElORV9fKQogI2Vsc2UKLSNkZWZpbmUgcWVt
dV9tdXRleF9sb2NrKG0pICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKLSAgICAgICAgICAgIFFlbXVNdXRleExvY2tGdW5jIF9mID0gYXRvbWljX3JlYWQoJnFl
bXVfbXV0ZXhfbG9ja19mdW5jKTsgIFwKLSAgICAgICAgICAgIF9mKG0sIF9fRklMRV9fLCBfX0xJ
TkVfXyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUgcWVtdV9t
dXRleF9sb2NrKG0pICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAorICAgICAgICAgICAgUWVtdU11dGV4TG9ja0Z1bmMgX2YgPSBxZW11X2F0b21pY19y
ZWFkKCZxZW11X211dGV4X2xvY2tfZnVuYyk7ICBcCisgICAgICAgICAgICBfZihtLCBfX0ZJTEVf
XywgX19MSU5FX18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAg
ICAgICAgfSkKIAogI2RlZmluZSBxZW11X211dGV4X3RyeWxvY2sobSkgKHsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgICAgUWVtdU11dGV4VHJ5bG9j
a0Z1bmMgX2YgPSBhdG9taWNfcmVhZCgmcWVtdV9tdXRleF90cnlsb2NrX2Z1bmMpOyBcCisgICAg
ICAgICAgICBRZW11TXV0ZXhUcnlsb2NrRnVuYyBfZiA9ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgcWVtdV9hdG9taWNfcmVhZCgmcWVtdV9tdXRl
eF90cnlsb2NrX2Z1bmMpOyAgICAgICAgICAgICBcCiAgICAgICAgICAgICBfZihtLCBfX0ZJTEVf
XywgX19MSU5FX18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAg
IH0pCiAKICNkZWZpbmUgcWVtdV9yZWNfbXV0ZXhfbG9jayhtKSAoeyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAgIFFlbXVSZWNNdXRleExvY2tGdW5j
IF9mID0gYXRvbWljX3JlYWQoJnFlbXVfcmVjX211dGV4X2xvY2tfZnVuYyk7IFwKKyAgICAgICAg
ICAgIFFlbXVSZWNNdXRleExvY2tGdW5jIF9mID0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgICAgICBxZW11X2F0b21pY19yZWFkKCZxZW11X3JlY19tdXRl
eF9sb2NrX2Z1bmMpOyAgICAgICAgICAgIFwKICAgICAgICAgICAgIF9mKG0sIF9fRklMRV9fLCBf
X0xJTkVfXyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgfSkK
IAotI2RlZmluZSBxZW11X3JlY19tdXRleF90cnlsb2NrKG0pICh7ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKLSAgICAgICAgICAgIFFlbXVSZWNNdXRleFRyeWxvY2tGdW5jIF9mOyAgICAg
ICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICBfZiA9IGF0b21pY19yZWFkKCZxZW11
X3JlY19tdXRleF90cnlsb2NrX2Z1bmMpOyAgICAgXAotICAgICAgICAgICAgX2YobSwgX19GSUxF
X18sIF9fTElORV9fKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyNkZWZpbmUgcWVtdV9y
ZWNfbXV0ZXhfdHJ5bG9jayhtKSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgIFFlbXVSZWNNdXRleFRyeWxvY2tGdW5jIF9mOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgICAgIF9mID0gcWVtdV9hdG9taWNfcmVhZCgmcWVtdV9y
ZWNfbXV0ZXhfdHJ5bG9ja19mdW5jKTsgICAgIFwKKyAgICAgICAgICAgIF9mKG0sIF9fRklMRV9f
LCBfX0xJTkVfXyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgfSkK
IAotI2RlZmluZSBxZW11X2NvbmRfd2FpdChjLCBtKSAoeyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAotICAgICAgICAgICAgUWVtdUNvbmRXYWl0RnVuYyBfZiA9IGF0
b21pY19yZWFkKCZxZW11X2NvbmRfd2FpdF9mdW5jKTsgICAgXAotICAgICAgICAgICAgX2YoYywg
bSwgX19GSUxFX18sIF9fTElORV9fKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAor
I2RlZmluZSBxZW11X2NvbmRfd2FpdChjLCBtKSAoeyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICBRZW11Q29uZFdhaXRGdW5jIF9mID0g
cWVtdV9hdG9taWNfcmVhZCgmcWVtdV9jb25kX3dhaXRfZnVuYyk7ICAgIFwKKyAgICAgICAgICAg
IF9mKGMsIG0sIF9fRklMRV9fLCBfX0xJTkVfXyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAogICAgICAgICB9KQogCi0jZGVmaW5lIHFlbXVfY29uZF90aW1lZHdhaXQoYywg
bSwgbXMpICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotICAgICAg
ICAgICAgUWVtdUNvbmRUaW1lZFdhaXRGdW5jIF9mID0gYXRvbWljX3JlYWQoJnFlbXVfY29uZF90
aW1lZHdhaXRfZnVuYyk7IFwKLSAgICAgICAgICAgIF9mKGMsIG0sIG1zLCBfX0ZJTEVfXywgX19M
SU5FX18pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisjZGVmaW5lIHFlbXVf
Y29uZF90aW1lZHdhaXQoYywgbSwgbXMpICh7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgIFFlbXVDb25kVGltZWRXYWl0RnVuYyBfZiA9ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgIHFlbXVfYXRv
bWljX3JlYWQoJnFlbXVfY29uZF90aW1lZHdhaXRfZnVuYyk7ICAgICAgICAgICAgICAgICBcCisg
ICAgICAgICAgICBfZihjLCBtLCBtcywgX19GSUxFX18sIF9fTElORV9fKTsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKICAgICAgICAgfSkKICNlbmRpZgogCkBAIC0yMzYsNyArMjM5
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHFlbXVfc3Bpbl9sb2NrKFFlbXVTcGluICpzcGluKQog
ICAgIF9fdHNhbl9tdXRleF9wcmVfbG9jayhzcGluLCAwKTsKICNlbmRpZgogICAgIHdoaWxlICh1
bmxpa2VseShfX3N5bmNfbG9ja190ZXN0X2FuZF9zZXQoJnNwaW4tPnZhbHVlLCB0cnVlKSkpIHsK
LSAgICAgICAgd2hpbGUgKGF0b21pY19yZWFkKCZzcGluLT52YWx1ZSkpIHsKKyAgICAgICAgd2hp
bGUgKHFlbXVfYXRvbWljX3JlYWQoJnNwaW4tPnZhbHVlKSkgewogICAgICAgICAgICAgY3B1X3Jl
bGF4KCk7CiAgICAgICAgIH0KICAgICB9CkBAIC0yNjEsNyArMjY0LDcgQEAgc3RhdGljIGlubGlu
ZSBib29sIHFlbXVfc3Bpbl90cnlsb2NrKFFlbXVTcGluICpzcGluKQogCiBzdGF0aWMgaW5saW5l
IGJvb2wgcWVtdV9zcGluX2xvY2tlZChRZW11U3BpbiAqc3BpbikKIHsKLSAgICByZXR1cm4gYXRv
bWljX3JlYWQoJnNwaW4tPnZhbHVlKTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfcmVhZCgmc3Bp
bi0+dmFsdWUpOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgcWVtdV9zcGluX3VubG9jayhRZW11
U3BpbiAqc3BpbikKZGlmZiAtLWdpdCBhL2luY2x1ZGUvc3RhbmRhcmQtaGVhZGVycy9kcml2ZXJz
L2luZmluaWJhbmQvaHcvdm13X3B2cmRtYS9wdnJkbWFfcmluZy5oIGIvaW5jbHVkZS9zdGFuZGFy
ZC1oZWFkZXJzL2RyaXZlcnMvaW5maW5pYmFuZC9ody92bXdfcHZyZG1hL3B2cmRtYV9yaW5nLmgK
aW5kZXggYWNkNGM4MzQ2ZC4uOGU3MTI5MDRlOSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9zdGFuZGFy
ZC1oZWFkZXJzL2RyaXZlcnMvaW5maW5pYmFuZC9ody92bXdfcHZyZG1hL3B2cmRtYV9yaW5nLmgK
KysrIGIvaW5jbHVkZS9zdGFuZGFyZC1oZWFkZXJzL2RyaXZlcnMvaW5maW5pYmFuZC9ody92bXdf
cHZyZG1hL3B2cmRtYV9yaW5nLmgKQEAgLTY4LDcgKzY4LDcgQEAgc3RhdGljIGlubGluZSBpbnQg
cHZyZG1hX2lkeF92YWxpZCh1aW50MzJfdCBpZHgsIHVpbnQzMl90IG1heF9lbGVtcykKIAogc3Rh
dGljIGlubGluZSBpbnQzMl90IHB2cmRtYV9pZHgoaW50ICp2YXIsIHVpbnQzMl90IG1heF9lbGVt
cykKIHsKLQljb25zdCB1bnNpZ25lZCBpbnQgaWR4ID0gYXRvbWljX3JlYWQodmFyKTsKKwljb25z
dCB1bnNpZ25lZCBpbnQgaWR4ID0gcWVtdV9hdG9taWNfcmVhZCh2YXIpOwogCiAJaWYgKHB2cmRt
YV9pZHhfdmFsaWQoaWR4LCBtYXhfZWxlbXMpKQogCQlyZXR1cm4gaWR4ICYgKG1heF9lbGVtcyAt
IDEpOwpAQCAtNzcsMTcgKzc3LDE3IEBAIHN0YXRpYyBpbmxpbmUgaW50MzJfdCBwdnJkbWFfaWR4
KGludCAqdmFyLCB1aW50MzJfdCBtYXhfZWxlbXMpCiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBwdnJk
bWFfaWR4X3JpbmdfaW5jKGludCAqdmFyLCB1aW50MzJfdCBtYXhfZWxlbXMpCiB7Ci0JdWludDMy
X3QgaWR4ID0gYXRvbWljX3JlYWQodmFyKSArIDE7CS8qIEluY3JlbWVudC4gKi8KKwl1aW50MzJf
dCBpZHggPSBxZW11X2F0b21pY19yZWFkKHZhcikgKyAxOwkvKiBJbmNyZW1lbnQuICovCiAKIAlp
ZHggJj0gKG1heF9lbGVtcyA8PCAxKSAtIDE7CQkvKiBNb2R1bG8gc2l6ZSwgZmxpcCBnZW4uICov
Ci0JYXRvbWljX3NldCh2YXIsIGlkeCk7CisJcWVtdV9hdG9taWNfc2V0KHZhciwgaWR4KTsKIH0K
IAogc3RhdGljIGlubGluZSBpbnQzMl90IHB2cmRtYV9pZHhfcmluZ19oYXNfc3BhY2UoY29uc3Qg
c3RydWN0IHB2cmRtYV9yaW5nICpyLAogCQkJCQkgICAgICB1aW50MzJfdCBtYXhfZWxlbXMsIHVp
bnQzMl90ICpvdXRfdGFpbCkKIHsKLQljb25zdCB1aW50MzJfdCB0YWlsID0gYXRvbWljX3JlYWQo
JnItPnByb2RfdGFpbCk7Ci0JY29uc3QgdWludDMyX3QgaGVhZCA9IGF0b21pY19yZWFkKCZyLT5j
b25zX2hlYWQpOworCWNvbnN0IHVpbnQzMl90IHRhaWwgPSBxZW11X2F0b21pY19yZWFkKCZyLT5w
cm9kX3RhaWwpOworCWNvbnN0IHVpbnQzMl90IGhlYWQgPSBxZW11X2F0b21pY19yZWFkKCZyLT5j
b25zX2hlYWQpOwogCiAJaWYgKHB2cmRtYV9pZHhfdmFsaWQodGFpbCwgbWF4X2VsZW1zKSAmJgog
CSAgICBwdnJkbWFfaWR4X3ZhbGlkKGhlYWQsIG1heF9lbGVtcykpIHsKQEAgLTEwMCw4ICsxMDAs
OCBAQCBzdGF0aWMgaW5saW5lIGludDMyX3QgcHZyZG1hX2lkeF9yaW5nX2hhc19zcGFjZShjb25z
dCBzdHJ1Y3QgcHZyZG1hX3JpbmcgKnIsCiBzdGF0aWMgaW5saW5lIGludDMyX3QgcHZyZG1hX2lk
eF9yaW5nX2hhc19kYXRhKGNvbnN0IHN0cnVjdCBwdnJkbWFfcmluZyAqciwKIAkJCQkJICAgICB1
aW50MzJfdCBtYXhfZWxlbXMsIHVpbnQzMl90ICpvdXRfaGVhZCkKIHsKLQljb25zdCB1aW50MzJf
dCB0YWlsID0gYXRvbWljX3JlYWQoJnItPnByb2RfdGFpbCk7Ci0JY29uc3QgdWludDMyX3QgaGVh
ZCA9IGF0b21pY19yZWFkKCZyLT5jb25zX2hlYWQpOworCWNvbnN0IHVpbnQzMl90IHRhaWwgPSBx
ZW11X2F0b21pY19yZWFkKCZyLT5wcm9kX3RhaWwpOworCWNvbnN0IHVpbnQzMl90IGhlYWQgPSBx
ZW11X2F0b21pY19yZWFkKCZyLT5jb25zX2hlYWQpOwogCiAJaWYgKHB2cmRtYV9pZHhfdmFsaWQo
dGFpbCwgbWF4X2VsZW1zKSAmJgogCSAgICBwdnJkbWFfaWR4X3ZhbGlkKGhlYWQsIG1heF9lbGVt
cykpIHsKZGlmZiAtLWdpdCBhL2xpbnV4LXVzZXIvcWVtdS5oIGIvbGludXgtdXNlci9xZW11LmgK
aW5kZXggYTY5YTBiZDM0Ny4uZjllODM1ZGU4MCAxMDA2NDQKLS0tIGEvbGludXgtdXNlci9xZW11
LmgKKysrIGIvbGludXgtdXNlci9xZW11LmgKQEAgLTE0Niw4ICsxNDYsOCBAQCB0eXBlZGVmIHN0
cnVjdCBUYXNrU3RhdGUgewogICAgIC8qIE5vbnplcm8gaWYgcHJvY2Vzc19wZW5kaW5nX3NpZ25h
bHMoKSBuZWVkcyB0byBkbyBzb21ldGhpbmcgKGVpdGhlcgogICAgICAqIGhhbmRsZSBhIHBlbmRp
bmcgc2lnbmFsIG9yIHVuYmxvY2sgc2lnbmFscykuCiAgICAgICogVGhpcyBmbGFnIGlzIHdyaXR0
ZW4gZnJvbSBhIHNpZ25hbCBoYW5kbGVyIHNvIHNob3VsZCBiZSBhY2Nlc3NlZCB2aWEKLSAgICAg
KiB0aGUgYXRvbWljX3JlYWQoKSBhbmQgYXRvbWljX3NldCgpIGZ1bmN0aW9ucy4gKEl0IGlzIG5v
dCBhY2Nlc3NlZAotICAgICAqIGZyb20gbXVsdGlwbGUgdGhyZWFkcy4pCisgICAgICogdGhlIHFl
bXVfYXRvbWljX3JlYWQoKSBhbmQgcWVtdV9hdG9taWNfc2V0KCkgZnVuY3Rpb25zLiAoSXQgaXMg
bm90CisgICAgICogYWNjZXNzZWQgZnJvbSBtdWx0aXBsZSB0aHJlYWRzLikKICAgICAgKi8KICAg
ICBpbnQgc2lnbmFsX3BlbmRpbmc7CiAKZGlmZiAtLWdpdCBhL3RjZy9pMzg2L3RjZy10YXJnZXQu
aCBiL3RjZy9pMzg2L3RjZy10YXJnZXQuaAppbmRleCA5OWFjMWUzOTU4Li44ZWVkZTI5ZTMyIDEw
MDY0NAotLS0gYS90Y2cvaTM4Ni90Y2ctdGFyZ2V0LmgKKysrIGIvdGNnL2kzODYvdGNnLXRhcmdl
dC5oCkBAIC0yMTUsNyArMjE1LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHRiX3RhcmdldF9zZXRf
am1wX3RhcmdldCh1aW50cHRyX3QgdGNfcHRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50cHRyX3Qgam1wX2FkZHIsIHVpbnRwdHJfdCBhZGRyKQogewog
ICAgIC8qIHBhdGNoIHRoZSBicmFuY2ggZGVzdGluYXRpb24gKi8KLSAgICBhdG9taWNfc2V0KChp
bnQzMl90ICopam1wX2FkZHIsIGFkZHIgLSAoam1wX2FkZHIgKyA0KSk7CisgICAgcWVtdV9hdG9t
aWNfc2V0KChpbnQzMl90ICopam1wX2FkZHIsIGFkZHIgLSAoam1wX2FkZHIgKyA0KSk7CiAgICAg
Lyogbm8gbmVlZCB0byBmbHVzaCBpY2FjaGUgZXhwbGljaXRseSAqLwogfQogCmRpZmYgLS1naXQg
YS90Y2cvczM5MC90Y2ctdGFyZ2V0LmggYi90Y2cvczM5MC90Y2ctdGFyZ2V0LmgKaW5kZXggMDdh
Y2NhYmJkMS4uYjhhNmI1MTU1NiAxMDA2NDQKLS0tIGEvdGNnL3MzOTAvdGNnLXRhcmdldC5oCisr
KyBiL3RjZy9zMzkwL3RjZy10YXJnZXQuaApAQCAtMTU0LDcgKzE1NCw3IEBAIHN0YXRpYyBpbmxp
bmUgdm9pZCB0Yl90YXJnZXRfc2V0X2ptcF90YXJnZXQodWludHB0cl90IHRjX3B0ciwKIHsKICAg
ICAvKiBwYXRjaCB0aGUgYnJhbmNoIGRlc3RpbmF0aW9uICovCiAgICAgaW50cHRyX3QgZGlzcCA9
IGFkZHIgLSAoam1wX2FkZHIgLSAyKTsKLSAgICBhdG9taWNfc2V0KChpbnQzMl90ICopam1wX2Fk
ZHIsIGRpc3AgLyAyKTsKKyAgICBxZW11X2F0b21pY19zZXQoKGludDMyX3QgKilqbXBfYWRkciwg
ZGlzcCAvIDIpOwogICAgIC8qIG5vIG5lZWQgdG8gZmx1c2ggaWNhY2hlIGV4cGxpY2l0bHkgKi8K
IH0KIApkaWZmIC0tZ2l0IGEvdGNnL3RjaS90Y2ctdGFyZ2V0LmggYi90Y2cvdGNpL3RjZy10YXJn
ZXQuaAppbmRleCA4YjkwYWI3MWNiLi4yZmFjMTE1ZGI2IDEwMDY0NAotLS0gYS90Y2cvdGNpL3Rj
Zy10YXJnZXQuaAorKysgYi90Y2cvdGNpL3RjZy10YXJnZXQuaApAQCAtMjA2LDcgKzIwNiw3IEBA
IHN0YXRpYyBpbmxpbmUgdm9pZCB0Yl90YXJnZXRfc2V0X2ptcF90YXJnZXQodWludHB0cl90IHRj
X3B0ciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0
cl90IGptcF9hZGRyLCB1aW50cHRyX3QgYWRkcikKIHsKICAgICAvKiBwYXRjaCB0aGUgYnJhbmNo
IGRlc3RpbmF0aW9uICovCi0gICAgYXRvbWljX3NldCgoaW50MzJfdCAqKWptcF9hZGRyLCBhZGRy
IC0gKGptcF9hZGRyICsgNCkpOworICAgIHFlbXVfYXRvbWljX3NldCgoaW50MzJfdCAqKWptcF9h
ZGRyLCBhZGRyIC0gKGptcF9hZGRyICsgNCkpOwogICAgIC8qIG5vIG5lZWQgdG8gZmx1c2ggaWNh
Y2hlIGV4cGxpY2l0bHkgKi8KIH0KIApkaWZmIC0tZ2l0IGEvYWNjZWwva3ZtL2t2bS1hbGwuYyBi
L2FjY2VsL2t2bS9rdm0tYWxsLmMKaW5kZXggYWQ4YjMxNWIzNS4uMDZlNTBiOGFjNiAxMDA2NDQK
LS0tIGEvYWNjZWwva3ZtL2t2bS1hbGwuYworKysgYi9hY2NlbC9rdm0va3ZtLWFsbC5jCkBAIC0y
Mzc5LDcgKzIzNzksNyBAQCBzdGF0aWMgX190aHJlYWQgYm9vbCBoYXZlX3NpZ2J1c19wZW5kaW5n
OwogCiBzdGF0aWMgdm9pZCBrdm1fY3B1X2tpY2soQ1BVU3RhdGUgKmNwdSkKIHsKLSAgICBhdG9t
aWNfc2V0KCZjcHUtPmt2bV9ydW4tPmltbWVkaWF0ZV9leGl0LCAxKTsKKyAgICBxZW11X2F0b21p
Y19zZXQoJmNwdS0+a3ZtX3J1bi0+aW1tZWRpYXRlX2V4aXQsIDEpOwogfQogCiBzdGF0aWMgdm9p
ZCBrdm1fY3B1X2tpY2tfc2VsZih2b2lkKQpAQCAtMjQwMCw3ICsyNDAwLDcgQEAgc3RhdGljIHZv
aWQga3ZtX2VhdF9zaWduYWxzKENQVVN0YXRlICpjcHUpCiAgICAgaW50IHI7CiAKICAgICBpZiAo
a3ZtX2ltbWVkaWF0ZV9leGl0KSB7Ci0gICAgICAgIGF0b21pY19zZXQoJmNwdS0+a3ZtX3J1bi0+
aW1tZWRpYXRlX2V4aXQsIDApOworICAgICAgICBxZW11X2F0b21pY19zZXQoJmNwdS0+a3ZtX3J1
bi0+aW1tZWRpYXRlX2V4aXQsIDApOwogICAgICAgICAvKiBXcml0ZSBrdm1fcnVuLT5pbW1lZGlh
dGVfZXhpdCBiZWZvcmUgdGhlIGNwdS0+ZXhpdF9yZXF1ZXN0CiAgICAgICAgICAqIHdyaXRlIGlu
IGt2bV9jcHVfZXhlYy4KICAgICAgICAgICovCkBAIC0yNDM0LDcgKzI0MzQsNyBAQCBpbnQga3Zt
X2NwdV9leGVjKENQVVN0YXRlICpjcHUpCiAgICAgRFBSSU5URigia3ZtX2NwdV9leGVjKClcbiIp
OwogCiAgICAgaWYgKGt2bV9hcmNoX3Byb2Nlc3NfYXN5bmNfZXZlbnRzKGNwdSkpIHsKLSAgICAg
ICAgYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDApOworICAgICAgICBxZW11X2F0b21p
Y19zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCAwKTsKICAgICAgICAgcmV0dXJuIEVYQ1BfSExUOwog
ICAgIH0KIApAQCAtMjQ1MCw3ICsyNDUwLDcgQEAgaW50IGt2bV9jcHVfZXhlYyhDUFVTdGF0ZSAq
Y3B1KQogICAgICAgICB9CiAKICAgICAgICAga3ZtX2FyY2hfcHJlX3J1bihjcHUsIHJ1bik7Ci0g
ICAgICAgIGlmIChhdG9taWNfcmVhZCgmY3B1LT5leGl0X3JlcXVlc3QpKSB7CisgICAgICAgIGlm
IChxZW11X2F0b21pY19yZWFkKCZjcHUtPmV4aXRfcmVxdWVzdCkpIHsKICAgICAgICAgICAgIERQ
UklOVEYoImludGVycnVwdCBleGl0IHJlcXVlc3RlZFxuIik7CiAgICAgICAgICAgICAvKgogICAg
ICAgICAgICAgICogS1ZNIHJlcXVpcmVzIHVzIHRvIHJlZW50ZXIgdGhlIGtlcm5lbCBhZnRlciBJ
TyBleGl0cyB0byBjb21wbGV0ZQpAQCAtMjU3Nyw3ICsyNTc3LDcgQEAgaW50IGt2bV9jcHVfZXhl
YyhDUFVTdGF0ZSAqY3B1KQogICAgICAgICB2bV9zdG9wKFJVTl9TVEFURV9JTlRFUk5BTF9FUlJP
Uik7CiAgICAgfQogCi0gICAgYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDApOworICAg
IHFlbXVfYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDApOwogICAgIHJldHVybiByZXQ7
CiB9CiAKQEAgLTI5OTQsNyArMjk5NCw3IEBAIGludCBrdm1fb25fc2lnYnVzX3ZjcHUoQ1BVU3Rh
dGUgKmNwdSwgaW50IGNvZGUsIHZvaWQgKmFkZHIpCiAgICAgaGF2ZV9zaWdidXNfcGVuZGluZyA9
IHRydWU7CiAgICAgcGVuZGluZ19zaWdidXNfYWRkciA9IGFkZHI7CiAgICAgcGVuZGluZ19zaWdi
dXNfY29kZSA9IGNvZGU7Ci0gICAgYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDEpOwor
ICAgIHFlbXVfYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIDEpOwogICAgIHJldHVybiAw
OwogI2Vsc2UKICAgICByZXR1cm4gMTsKZGlmZiAtLWdpdCBhL2FjY2VsL3RjZy9jcHUtZXhlYy5j
IGIvYWNjZWwvdGNnL2NwdS1leGVjLmMKaW5kZXggNjZkMzhmOWQ4NS4uYWJiZDVlOTU4OCAxMDA2
NDQKLS0tIGEvYWNjZWwvdGNnL2NwdS1leGVjLmMKKysrIGIvYWNjZWwvdGNnL2NwdS1leGVjLmMK
QEAgLTM2Nyw3ICszNjcsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdGJfYWRkX2p1bXAoVHJhbnNs
YXRpb25CbG9jayAqdGIsIGludCBuLAogICAgICAgICBnb3RvIG91dF91bmxvY2tfbmV4dDsKICAg
ICB9CiAgICAgLyogQXRvbWljYWxseSBjbGFpbSB0aGUganVtcCBkZXN0aW5hdGlvbiBzbG90IG9u
bHkgaWYgaXQgd2FzIE5VTEwgKi8KLSAgICBvbGQgPSBhdG9taWNfY21weGNoZygmdGItPmptcF9k
ZXN0W25dLCAodWludHB0cl90KU5VTEwsICh1aW50cHRyX3QpdGJfbmV4dCk7CisgICAgb2xkID0g
cWVtdV9hdG9taWNfY21weGNoZygmdGItPmptcF9kZXN0W25dLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKHVpbnRwdHJfdClOVUxMLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKHVpbnRwdHJfdCl0Yl9uZXh0KTsKICAgICBpZiAob2xkKSB7CiAgICAgICAgIGdvdG8gb3V0
X3VubG9ja19uZXh0OwogICAgIH0KQEAgLTQwNyw3ICs0MDksNyBAQCBzdGF0aWMgaW5saW5lIFRy
YW5zbGF0aW9uQmxvY2sgKnRiX2ZpbmQoQ1BVU3RhdGUgKmNwdSwKICAgICAgICAgdGIgPSB0Yl9n
ZW5fY29kZShjcHUsIHBjLCBjc19iYXNlLCBmbGFncywgY2ZfbWFzayk7CiAgICAgICAgIG1tYXBf
dW5sb2NrKCk7CiAgICAgICAgIC8qIFdlIGFkZCB0aGUgVEIgaW4gdGhlIHZpcnR1YWwgcGMgaGFz
aCB0YWJsZSBmb3IgdGhlIGZhc3QgbG9va3VwICovCi0gICAgICAgIGF0b21pY19zZXQoJmNwdS0+
dGJfam1wX2NhY2hlW3RiX2ptcF9jYWNoZV9oYXNoX2Z1bmMocGMpXSwgdGIpOworICAgICAgICBx
ZW11X2F0b21pY19zZXQoJmNwdS0+dGJfam1wX2NhY2hlW3RiX2ptcF9jYWNoZV9oYXNoX2Z1bmMo
cGMpXSwgdGIpOwogICAgIH0KICNpZm5kZWYgQ09ORklHX1VTRVJfT05MWQogICAgIC8qIFdlIGRv
bid0IHRha2UgY2FyZSBvZiBkaXJlY3QganVtcHMgd2hlbiBhZGRyZXNzIG1hcHBpbmcgY2hhbmdl
cyBpbgpAQCAtNTM2LDkgKzUzOCw5IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBjcHVfaGFuZGxlX2lu
dGVycnVwdChDUFVTdGF0ZSAqY3B1LAogICAgICAqIEVuc3VyZSB6ZXJvaW5nIGhhcHBlbnMgYmVm
b3JlIHJlYWRpbmcgY3B1LT5leGl0X3JlcXVlc3Qgb3IKICAgICAgKiBjcHUtPmludGVycnVwdF9y
ZXF1ZXN0IChzZWUgYWxzbyBzbXBfd21iIGluIGNwdV9leGl0KCkpCiAgICAgICovCi0gICAgYXRv
bWljX21iX3NldCgmY3B1X25lZyhjcHUpLT5pY291bnRfZGVjci51MTYuaGlnaCwgMCk7CisgICAg
cWVtdV9hdG9taWNfbWJfc2V0KCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUxNi5oaWdoLCAw
KTsKIAotICAgIGlmICh1bmxpa2VseShhdG9taWNfcmVhZCgmY3B1LT5pbnRlcnJ1cHRfcmVxdWVz
dCkpKSB7CisgICAgaWYgKHVubGlrZWx5KHFlbXVfYXRvbWljX3JlYWQoJmNwdS0+aW50ZXJydXB0
X3JlcXVlc3QpKSkgewogICAgICAgICBpbnQgaW50ZXJydXB0X3JlcXVlc3Q7CiAgICAgICAgIHFl
bXVfbXV0ZXhfbG9ja19pb3RocmVhZCgpOwogICAgICAgICBpbnRlcnJ1cHRfcmVxdWVzdCA9IGNw
dS0+aW50ZXJydXB0X3JlcXVlc3Q7CkBAIC02MTMsMTAgKzYxNSwxMCBAQCBzdGF0aWMgaW5saW5l
IGJvb2wgY3B1X2hhbmRsZV9pbnRlcnJ1cHQoQ1BVU3RhdGUgKmNwdSwKICAgICB9CiAKICAgICAv
KiBGaW5hbGx5LCBjaGVjayBpZiB3ZSBuZWVkIHRvIGV4aXQgdG8gdGhlIG1haW4gbG9vcC4gICov
Ci0gICAgaWYgKHVubGlrZWx5KGF0b21pY19yZWFkKCZjcHUtPmV4aXRfcmVxdWVzdCkpCisgICAg
aWYgKHVubGlrZWx5KHFlbXVfYXRvbWljX3JlYWQoJmNwdS0+ZXhpdF9yZXF1ZXN0KSkKICAgICAg
ICAgfHwgKHVzZV9pY291bnQKICAgICAgICAgICAgICYmIGNwdV9uZWcoY3B1KS0+aWNvdW50X2Rl
Y3IudTE2LmxvdyArIGNwdS0+aWNvdW50X2V4dHJhID09IDApKSB7Ci0gICAgICAgIGF0b21pY19z
ZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCAwKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZjcHUt
PmV4aXRfcmVxdWVzdCwgMCk7CiAgICAgICAgIGlmIChjcHUtPmV4Y2VwdGlvbl9pbmRleCA9PSAt
MSkgewogICAgICAgICAgICAgY3B1LT5leGNlcHRpb25faW5kZXggPSBFWENQX0lOVEVSUlVQVDsK
ICAgICAgICAgfQpAQCAtNjQyLDcgKzY0NCw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBjcHVfbG9v
cF9leGVjX3RiKENQVVN0YXRlICpjcHUsIFRyYW5zbGF0aW9uQmxvY2sgKnRiLAogICAgIH0KIAog
ICAgICpsYXN0X3RiID0gTlVMTDsKLSAgICBpbnNuc19sZWZ0ID0gYXRvbWljX3JlYWQoJmNwdV9u
ZWcoY3B1KS0+aWNvdW50X2RlY3IudTMyKTsKKyAgICBpbnNuc19sZWZ0ID0gcWVtdV9hdG9taWNf
cmVhZCgmY3B1X25lZyhjcHUpLT5pY291bnRfZGVjci51MzIpOwogICAgIGlmIChpbnNuc19sZWZ0
IDwgMCkgewogICAgICAgICAvKiBTb21ldGhpbmcgYXNrZWQgdXMgdG8gc3RvcCBleGVjdXRpbmcg
Y2hhaW5lZCBUQnM7IGp1c3QKICAgICAgICAgICogY29udGludWUgcm91bmQgdGhlIG1haW4gbG9v
cC4gV2hhdGV2ZXIgcmVxdWVzdGVkIHRoZSBleGl0CmRpZmYgLS1naXQgYS9hY2NlbC90Y2cvY3B1
dGxiLmMgYi9hY2NlbC90Y2cvY3B1dGxiLmMKaW5kZXggNjQ4OWFiYmY4Yy4uZWFhZjBhZjU3NCAx
MDA2NDQKLS0tIGEvYWNjZWwvdGNnL2NwdXRsYi5jCisrKyBiL2FjY2VsL3RjZy9jcHV0bGIuYwpA
QCAtMzEyLDkgKzMxMiw5IEBAIHZvaWQgdGxiX2ZsdXNoX2NvdW50cyhzaXplX3QgKnBmdWxsLCBz
aXplX3QgKnBwYXJ0LCBzaXplX3QgKnBlbGlkZSkKICAgICBDUFVfRk9SRUFDSChjcHUpIHsKICAg
ICAgICAgQ1BVQXJjaFN0YXRlICplbnYgPSBjcHUtPmVudl9wdHI7CiAKLSAgICAgICAgZnVsbCAr
PSBhdG9taWNfcmVhZCgmZW52X3RsYihlbnYpLT5jLmZ1bGxfZmx1c2hfY291bnQpOwotICAgICAg
ICBwYXJ0ICs9IGF0b21pY19yZWFkKCZlbnZfdGxiKGVudiktPmMucGFydF9mbHVzaF9jb3VudCk7
Ci0gICAgICAgIGVsaWRlICs9IGF0b21pY19yZWFkKCZlbnZfdGxiKGVudiktPmMuZWxpZGVfZmx1
c2hfY291bnQpOworICAgICAgICBmdWxsICs9IHFlbXVfYXRvbWljX3JlYWQoJmVudl90bGIoZW52
KS0+Yy5mdWxsX2ZsdXNoX2NvdW50KTsKKyAgICAgICAgcGFydCArPSBxZW11X2F0b21pY19yZWFk
KCZlbnZfdGxiKGVudiktPmMucGFydF9mbHVzaF9jb3VudCk7CisgICAgICAgIGVsaWRlICs9IHFl
bXVfYXRvbWljX3JlYWQoJmVudl90bGIoZW52KS0+Yy5lbGlkZV9mbHVzaF9jb3VudCk7CiAgICAg
fQogICAgICpwZnVsbCA9IGZ1bGw7CiAgICAgKnBwYXJ0ID0gcGFydDsKQEAgLTM0OSwxMyArMzQ5
LDEzIEBAIHN0YXRpYyB2b2lkIHRsYl9mbHVzaF9ieV9tbXVpZHhfYXN5bmNfd29yayhDUFVTdGF0
ZSAqY3B1LCBydW5fb25fY3B1X2RhdGEgZGF0YSkKICAgICBjcHVfdGJfam1wX2NhY2hlX2NsZWFy
KGNwdSk7CiAKICAgICBpZiAodG9fY2xlYW4gPT0gQUxMX01NVUlEWF9CSVRTKSB7Ci0gICAgICAg
IGF0b21pY19zZXQoJmVudl90bGIoZW52KS0+Yy5mdWxsX2ZsdXNoX2NvdW50LAorICAgICAgICBx
ZW11X2F0b21pY19zZXQoJmVudl90bGIoZW52KS0+Yy5mdWxsX2ZsdXNoX2NvdW50LAogICAgICAg
ICAgICAgICAgICAgIGVudl90bGIoZW52KS0+Yy5mdWxsX2ZsdXNoX2NvdW50ICsgMSk7CiAgICAg
fSBlbHNlIHsKLSAgICAgICAgYXRvbWljX3NldCgmZW52X3RsYihlbnYpLT5jLnBhcnRfZmx1c2hf
Y291bnQsCisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmZW52X3RsYihlbnYpLT5jLnBhcnRfZmx1
c2hfY291bnQsCiAgICAgICAgICAgICAgICAgICAgZW52X3RsYihlbnYpLT5jLnBhcnRfZmx1c2hf
Y291bnQgKyBjdHBvcDE2KHRvX2NsZWFuKSk7CiAgICAgICAgIGlmICh0b19jbGVhbiAhPSBhc2tl
ZCkgewotICAgICAgICAgICAgYXRvbWljX3NldCgmZW52X3RsYihlbnYpLT5jLmVsaWRlX2ZsdXNo
X2NvdW50LAorICAgICAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZlbnZfdGxiKGVudiktPmMuZWxp
ZGVfZmx1c2hfY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgIGVudl90bGIoZW52KS0+Yy5l
bGlkZV9mbHVzaF9jb3VudCArCiAgICAgICAgICAgICAgICAgICAgICAgIGN0cG9wMTYoYXNrZWQg
JiB+dG9fY2xlYW4pKTsKICAgICAgICAgfQpAQCAtNjkzLDcgKzY5Myw3IEBAIHZvaWQgdGxiX3Vu
cHJvdGVjdF9jb2RlKHJhbV9hZGRyX3QgcmFtX2FkZHIpCiAgKiBnZW5lcmF0ZWQgY29kZS4KICAq
CiAgKiBPdGhlciB2Q1BVcyBtaWdodCBiZSByZWFkaW5nIHRoZWlyIFRMQnMgZHVyaW5nIGd1ZXN0
IGV4ZWN1dGlvbiwgc28gd2UgdXBkYXRlCi0gKiB0ZS0+YWRkcl93cml0ZSB3aXRoIGF0b21pY19z
ZXQuIFdlIGRvbid0IG5lZWQgdG8gd29ycnkgYWJvdXQgdGhpcyBmb3IKKyAqIHRlLT5hZGRyX3dy
aXRlIHdpdGggcWVtdV9hdG9taWNfc2V0LiBXZSBkb24ndCBuZWVkIHRvIHdvcnJ5IGFib3V0IHRo
aXMgZm9yCiAgKiBvdmVyc2l6ZWQgZ3Vlc3RzIGFzIE1UVENHIGlzIGRpc2FibGVkIGZvciB0aGVt
LgogICoKICAqIENhbGxlZCB3aXRoIHRsYl9jLmxvY2sgaGVsZC4KQEAgLTcxMSw3ICs3MTEsNyBA
QCBzdGF0aWMgdm9pZCB0bGJfcmVzZXRfZGlydHlfcmFuZ2VfbG9ja2VkKENQVVRMQkVudHJ5ICp0
bGJfZW50cnksCiAjaWYgVENHX09WRVJTSVpFRF9HVUVTVAogICAgICAgICAgICAgdGxiX2VudHJ5
LT5hZGRyX3dyaXRlIHw9IFRMQl9OT1RESVJUWTsKICNlbHNlCi0gICAgICAgICAgICBhdG9taWNf
c2V0KCZ0bGJfZW50cnktPmFkZHJfd3JpdGUsCisgICAgICAgICAgICBxZW11X2F0b21pY19zZXQo
JnRsYl9lbnRyeS0+YWRkcl93cml0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgdGxiX2VudHJ5
LT5hZGRyX3dyaXRlIHwgVExCX05PVERJUlRZKTsKICNlbmRpZgogICAgICAgICB9CkBAIC0xMTM4
LDggKzExMzgsOCBAQCBzdGF0aWMgaW5saW5lIHRhcmdldF91bG9uZyB0bGJfcmVhZF9vZnMoQ1BV
VExCRW50cnkgKmVudHJ5LCBzaXplX3Qgb2ZzKQogI2lmIFRDR19PVkVSU0laRURfR1VFU1QKICAg
ICByZXR1cm4gKih0YXJnZXRfdWxvbmcgKikoKHVpbnRwdHJfdCllbnRyeSArIG9mcyk7CiAjZWxz
ZQotICAgIC8qIG9mcyBtaWdodCBjb3JyZXNwb25kIHRvIC5hZGRyX3dyaXRlLCBzbyB1c2UgYXRv
bWljX3JlYWQgKi8KLSAgICByZXR1cm4gYXRvbWljX3JlYWQoKHRhcmdldF91bG9uZyAqKSgodWlu
dHB0cl90KWVudHJ5ICsgb2ZzKSk7CisgICAgLyogb2ZzIG1pZ2h0IGNvcnJlc3BvbmQgdG8gLmFk
ZHJfd3JpdGUsIHNvIHVzZSBxZW11X2F0b21pY19yZWFkICovCisgICAgcmV0dXJuIHFlbXVfYXRv
bWljX3JlYWQoKHRhcmdldF91bG9uZyAqKSgodWludHB0cl90KWVudHJ5ICsgb2ZzKSk7CiAjZW5k
aWYKIH0KIApAQCAtMTE1NSwxMSArMTE1NSwxMSBAQCBzdGF0aWMgYm9vbCB2aWN0aW1fdGxiX2hp
dChDUFVBcmNoU3RhdGUgKmVudiwgc2l6ZV90IG1tdV9pZHgsIHNpemVfdCBpbmRleCwKICAgICAg
ICAgQ1BVVExCRW50cnkgKnZ0bGIgPSAmZW52X3RsYihlbnYpLT5kW21tdV9pZHhdLnZ0YWJsZVt2
aWR4XTsKICAgICAgICAgdGFyZ2V0X3Vsb25nIGNtcDsKIAotICAgICAgICAvKiBlbHRfb2ZzIG1p
Z2h0IGNvcnJlc3BvbmQgdG8gLmFkZHJfd3JpdGUsIHNvIHVzZSBhdG9taWNfcmVhZCAqLworICAg
ICAgICAvKiBlbHRfb2ZzIG1pZ2h0IGNvcnJlc3BvbmQgdG8gLmFkZHJfd3JpdGUsIHNvIHVzZSBx
ZW11X2F0b21pY19yZWFkICovCiAjaWYgVENHX09WRVJTSVpFRF9HVUVTVAogICAgICAgICBjbXAg
PSAqKHRhcmdldF91bG9uZyAqKSgodWludHB0cl90KXZ0bGIgKyBlbHRfb2ZzKTsKICNlbHNlCi0g
ICAgICAgIGNtcCA9IGF0b21pY19yZWFkKCh0YXJnZXRfdWxvbmcgKikoKHVpbnRwdHJfdCl2dGxi
ICsgZWx0X29mcykpOworICAgICAgICBjbXAgPSBxZW11X2F0b21pY19yZWFkKCh0YXJnZXRfdWxv
bmcgKikoKHVpbnRwdHJfdCl2dGxiICsgZWx0X29mcykpOwogI2VuZGlmCiAKICAgICAgICAgaWYg
KGNtcCA9PSBwYWdlKSB7CmRpZmYgLS1naXQgYS9hY2NlbC90Y2cvdGNnLWFsbC5jIGIvYWNjZWwv
dGNnL3RjZy1hbGwuYwppbmRleCA3MDk4YWQ5NmMzLi4yZDJlYTIxYjc4IDEwMDY0NAotLS0gYS9h
Y2NlbC90Y2cvdGNnLWFsbC5jCisrKyBiL2FjY2VsL3RjZy90Y2ctYWxsLmMKQEAgLTY1LDcgKzY1
LDcgQEAgc3RhdGljIHZvaWQgdGNnX2hhbmRsZV9pbnRlcnJ1cHQoQ1BVU3RhdGUgKmNwdSwgaW50
IG1hc2spCiAgICAgaWYgKCFxZW11X2NwdV9pc19zZWxmKGNwdSkpIHsKICAgICAgICAgcWVtdV9j
cHVfa2ljayhjcHUpOwogICAgIH0gZWxzZSB7Ci0gICAgICAgIGF0b21pY19zZXQoJmNwdV9uZWco
Y3B1KS0+aWNvdW50X2RlY3IudTE2LmhpZ2gsIC0xKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0
KCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUxNi5oaWdoLCAtMSk7CiAgICAgICAgIGlmICh1
c2VfaWNvdW50ICYmCiAgICAgICAgICAgICAhY3B1LT5jYW5fZG9faW8KICAgICAgICAgICAgICYm
IChtYXNrICYgfm9sZF9tYXNrKSAhPSAwKSB7CmRpZmYgLS1naXQgYS9hY2NlbC90Y2cvdHJhbnNs
YXRlLWFsbC5jIGIvYWNjZWwvdGNnL3RyYW5zbGF0ZS1hbGwuYwppbmRleCAyZDgzMDEzNjMzLi4y
Y2NjNDQ2OTRiIDEwMDY0NAotLS0gYS9hY2NlbC90Y2cvdHJhbnNsYXRlLWFsbC5jCisrKyBiL2Fj
Y2VsL3RjZy90cmFuc2xhdGUtYWxsLmMKQEAgLTM3Nyw5ICszNzcsOSBAQCBzdGF0aWMgaW50IGNw
dV9yZXN0b3JlX3N0YXRlX2Zyb21fdGIoQ1BVU3RhdGUgKmNwdSwgVHJhbnNsYXRpb25CbG9jayAq
dGIsCiAgICAgcmVzdG9yZV9zdGF0ZV90b19vcGMoZW52LCB0YiwgZGF0YSk7CiAKICNpZmRlZiBD
T05GSUdfUFJPRklMRVIKLSAgICBhdG9taWNfc2V0KCZwcm9mLT5yZXN0b3JlX3RpbWUsCisgICAg
cWVtdV9hdG9taWNfc2V0KCZwcm9mLT5yZXN0b3JlX3RpbWUsCiAgICAgICAgICAgICAgICAgcHJv
Zi0+cmVzdG9yZV90aW1lICsgcHJvZmlsZV9nZXRjbG9jaygpIC0gdGkpOwotICAgIGF0b21pY19z
ZXQoJnByb2YtPnJlc3RvcmVfY291bnQsIHByb2YtPnJlc3RvcmVfY291bnQgKyAxKTsKKyAgICBx
ZW11X2F0b21pY19zZXQoJnByb2YtPnJlc3RvcmVfY291bnQsIHByb2YtPnJlc3RvcmVfY291bnQg
KyAxKTsKICNlbmRpZgogICAgIHJldHVybiAwOwogfQpAQCAtNTA5LDcgKzUwOSw3IEBAIHN0YXRp
YyBQYWdlRGVzYyAqcGFnZV9maW5kX2FsbG9jKHRiX3BhZ2VfYWRkcl90IGluZGV4LCBpbnQgYWxs
b2MpCiAKICAgICAvKiBMZXZlbCAyLi5OLTEuICAqLwogICAgIGZvciAoaSA9IHZfbDJfbGV2ZWxz
OyBpID4gMDsgaS0tKSB7Ci0gICAgICAgIHZvaWQgKipwID0gYXRvbWljX3JjdV9yZWFkKGxwKTsK
KyAgICAgICAgdm9pZCAqKnAgPSBxZW11X2F0b21pY19yY3VfcmVhZChscCk7CiAKICAgICAgICAg
aWYgKHAgPT0gTlVMTCkgewogICAgICAgICAgICAgdm9pZCAqZXhpc3Rpbmc7CkBAIC01MTgsNyAr
NTE4LDcgQEAgc3RhdGljIFBhZ2VEZXNjICpwYWdlX2ZpbmRfYWxsb2ModGJfcGFnZV9hZGRyX3Qg
aW5kZXgsIGludCBhbGxvYykKICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgIHAgPSBnX25ldzAodm9pZCAqLCBWX0wyX1NJWkUpOwotICAgICAg
ICAgICAgZXhpc3RpbmcgPSBhdG9taWNfY21weGNoZyhscCwgTlVMTCwgcCk7CisgICAgICAgICAg
ICBleGlzdGluZyA9IHFlbXVfYXRvbWljX2NtcHhjaGcobHAsIE5VTEwsIHApOwogICAgICAgICAg
ICAgaWYgKHVubGlrZWx5KGV4aXN0aW5nKSkgewogICAgICAgICAgICAgICAgIGdfZnJlZShwKTsK
ICAgICAgICAgICAgICAgICBwID0gZXhpc3Rpbmc7CkBAIC01MjgsNyArNTI4LDcgQEAgc3RhdGlj
IFBhZ2VEZXNjICpwYWdlX2ZpbmRfYWxsb2ModGJfcGFnZV9hZGRyX3QgaW5kZXgsIGludCBhbGxv
YykKICAgICAgICAgbHAgPSBwICsgKChpbmRleCA+PiAoaSAqIFZfTDJfQklUUykpICYgKFZfTDJf
U0laRSAtIDEpKTsKICAgICB9CiAKLSAgICBwZCA9IGF0b21pY19yY3VfcmVhZChscCk7CisgICAg
cGQgPSBxZW11X2F0b21pY19yY3VfcmVhZChscCk7CiAgICAgaWYgKHBkID09IE5VTEwpIHsKICAg
ICAgICAgdm9pZCAqZXhpc3Rpbmc7CiAKQEAgLTU0NSw3ICs1NDUsNyBAQCBzdGF0aWMgUGFnZURl
c2MgKnBhZ2VfZmluZF9hbGxvYyh0Yl9wYWdlX2FkZHJfdCBpbmRleCwgaW50IGFsbG9jKQogICAg
ICAgICAgICAgfQogICAgICAgICB9CiAjZW5kaWYKLSAgICAgICAgZXhpc3RpbmcgPSBhdG9taWNf
Y21weGNoZyhscCwgTlVMTCwgcGQpOworICAgICAgICBleGlzdGluZyA9IHFlbXVfYXRvbWljX2Nt
cHhjaGcobHAsIE5VTEwsIHBkKTsKICAgICAgICAgaWYgKHVubGlrZWx5KGV4aXN0aW5nKSkgewog
I2lmbmRlZiBDT05GSUdfVVNFUl9PTkxZCiAgICAgICAgICAgICB7CkBAIC0xMjUzLDcgKzEyNTMs
NyBAQCBzdGF0aWMgdm9pZCBkb190Yl9mbHVzaChDUFVTdGF0ZSAqY3B1LCBydW5fb25fY3B1X2Rh
dGEgdGJfZmx1c2hfY291bnQpCiAgICAgdGNnX3JlZ2lvbl9yZXNldF9hbGwoKTsKICAgICAvKiBY
WFg6IGZsdXNoIHByb2Nlc3NvciBpY2FjaGUgYXQgdGhpcyBwb2ludCBpZiBjYWNoZSBmbHVzaCBp
cwogICAgICAgIGV4cGVuc2l2ZSAqLwotICAgIGF0b21pY19tYl9zZXQoJnRiX2N0eC50Yl9mbHVz
aF9jb3VudCwgdGJfY3R4LnRiX2ZsdXNoX2NvdW50ICsgMSk7CisgICAgcWVtdV9hdG9taWNfbWJf
c2V0KCZ0Yl9jdHgudGJfZmx1c2hfY291bnQsIHRiX2N0eC50Yl9mbHVzaF9jb3VudCArIDEpOwog
CiBkb25lOgogICAgIG1tYXBfdW5sb2NrKCk7CkBAIC0xMjY1LDcgKzEyNjUsNyBAQCBkb25lOgog
dm9pZCB0Yl9mbHVzaChDUFVTdGF0ZSAqY3B1KQogewogICAgIGlmICh0Y2dfZW5hYmxlZCgpKSB7
Ci0gICAgICAgIHVuc2lnbmVkIHRiX2ZsdXNoX2NvdW50ID0gYXRvbWljX21iX3JlYWQoJnRiX2N0
eC50Yl9mbHVzaF9jb3VudCk7CisgICAgICAgIHVuc2lnbmVkIHRiX2ZsdXNoX2NvdW50ID0gcWVt
dV9hdG9taWNfbWJfcmVhZCgmdGJfY3R4LnRiX2ZsdXNoX2NvdW50KTsKIAogICAgICAgICBpZiAo
Y3B1X2luX2V4Y2x1c2l2ZV9jb250ZXh0KGNwdSkpIHsKICAgICAgICAgICAgIGRvX3RiX2ZsdXNo
KGNwdSwgUlVOX09OX0NQVV9IT1NUX0lOVCh0Yl9mbHVzaF9jb3VudCkpOwpAQCAtMTM1OCw3ICsx
MzU4LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHRiX3JlbW92ZV9mcm9tX2ptcF9saXN0KFRyYW5z
bGF0aW9uQmxvY2sgKm9yaWcsIGludCBuX29yaWcpCiAgICAgaW50IG47CiAKICAgICAvKiBtYXJr
IHRoZSBMU0Igb2Ygam1wX2Rlc3RbXSBzbyB0aGF0IG5vIGZ1cnRoZXIganVtcHMgY2FuIGJlIGlu
c2VydGVkICovCi0gICAgcHRyID0gYXRvbWljX29yX2ZldGNoKCZvcmlnLT5qbXBfZGVzdFtuX29y
aWddLCAxKTsKKyAgICBwdHIgPSBxZW11X2F0b21pY19vcl9mZXRjaCgmb3JpZy0+am1wX2Rlc3Rb
bl9vcmlnXSwgMSk7CiAgICAgZGVzdCA9IChUcmFuc2xhdGlvbkJsb2NrICopKHB0ciAmIH4xKTsK
ICAgICBpZiAoZGVzdCA9PSBOVUxMKSB7CiAgICAgICAgIHJldHVybjsKQEAgLTEzNjksNyArMTM2
OSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB0Yl9yZW1vdmVfZnJvbV9qbXBfbGlzdChUcmFuc2xh
dGlvbkJsb2NrICpvcmlnLCBpbnQgbl9vcmlnKQogICAgICAqIFdoaWxlIGFjcXVpcmluZyB0aGUg
bG9jaywgdGhlIGp1bXAgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgaWYgdGhlCiAgICAgICogZGVz
dGluYXRpb24gVEIgd2FzIGludmFsaWRhdGVkOyBjaGVjayBhZ2Fpbi4KICAgICAgKi8KLSAgICBw
dHJfbG9ja2VkID0gYXRvbWljX3JlYWQoJm9yaWctPmptcF9kZXN0W25fb3JpZ10pOworICAgIHB0
cl9sb2NrZWQgPSBxZW11X2F0b21pY19yZWFkKCZvcmlnLT5qbXBfZGVzdFtuX29yaWddKTsKICAg
ICBpZiAocHRyX2xvY2tlZCAhPSBwdHIpIHsKICAgICAgICAgcWVtdV9zcGluX3VubG9jaygmZGVz
dC0+am1wX2xvY2spOwogICAgICAgICAvKgpAQCAtMTQxNSw3ICsxNDE1LDcgQEAgc3RhdGljIGlu
bGluZSB2b2lkIHRiX2ptcF91bmxpbmsoVHJhbnNsYXRpb25CbG9jayAqZGVzdCkKIAogICAgIFRC
X0ZPUl9FQUNIX0pNUChkZXN0LCB0YiwgbikgewogICAgICAgICB0Yl9yZXNldF9qdW1wKHRiLCBu
KTsKLSAgICAgICAgYXRvbWljX2FuZCgmdGItPmptcF9kZXN0W25dLCAodWludHB0cl90KU5VTEwg
fCAxKTsKKyAgICAgICAgcWVtdV9hdG9taWNfYW5kKCZ0Yi0+am1wX2Rlc3Rbbl0sICh1aW50cHRy
X3QpTlVMTCB8IDEpOwogICAgICAgICAvKiBObyBuZWVkIHRvIGNsZWFyIHRoZSBsaXN0IGVudHJ5
OyBzZXR0aW5nIHRoZSBkZXN0IHB0ciBpcyBlbm91Z2ggKi8KICAgICB9CiAgICAgZGVzdC0+am1w
X2xpc3RfaGVhZCA9ICh1aW50cHRyX3QpTlVMTDsKQEAgLTE0MzksNyArMTQzOSw3IEBAIHN0YXRp
YyB2b2lkIGRvX3RiX3BoeXNfaW52YWxpZGF0ZShUcmFuc2xhdGlvbkJsb2NrICp0YiwgYm9vbCBy
bV9mcm9tX3BhZ2VfbGlzdCkKIAogICAgIC8qIG1ha2Ugc3VyZSBubyBmdXJ0aGVyIGluY29taW5n
IGp1bXBzIHdpbGwgYmUgY2hhaW5lZCB0byB0aGlzIFRCICovCiAgICAgcWVtdV9zcGluX2xvY2so
JnRiLT5qbXBfbG9jayk7Ci0gICAgYXRvbWljX3NldCgmdGItPmNmbGFncywgdGItPmNmbGFncyB8
IENGX0lOVkFMSUQpOworICAgIHFlbXVfYXRvbWljX3NldCgmdGItPmNmbGFncywgdGItPmNmbGFn
cyB8IENGX0lOVkFMSUQpOwogICAgIHFlbXVfc3Bpbl91bmxvY2soJnRiLT5qbXBfbG9jayk7CiAK
ICAgICAvKiByZW1vdmUgdGhlIFRCIGZyb20gdGhlIGhhc2ggbGlzdCAqLwpAQCAtMTQ2Niw4ICsx
NDY2LDggQEAgc3RhdGljIHZvaWQgZG9fdGJfcGh5c19pbnZhbGlkYXRlKFRyYW5zbGF0aW9uQmxv
Y2sgKnRiLCBib29sIHJtX2Zyb21fcGFnZV9saXN0KQogICAgIC8qIHJlbW92ZSB0aGUgVEIgZnJv
bSB0aGUgaGFzaCBsaXN0ICovCiAgICAgaCA9IHRiX2ptcF9jYWNoZV9oYXNoX2Z1bmModGItPnBj
KTsKICAgICBDUFVfRk9SRUFDSChjcHUpIHsKLSAgICAgICAgaWYgKGF0b21pY19yZWFkKCZjcHUt
PnRiX2ptcF9jYWNoZVtoXSkgPT0gdGIpIHsKLSAgICAgICAgICAgIGF0b21pY19zZXQoJmNwdS0+
dGJfam1wX2NhY2hlW2hdLCBOVUxMKTsKKyAgICAgICAgaWYgKHFlbXVfYXRvbWljX3JlYWQoJmNw
dS0+dGJfam1wX2NhY2hlW2hdKSA9PSB0YikgeworICAgICAgICAgICAgcWVtdV9hdG9taWNfc2V0
KCZjcHUtPnRiX2ptcF9jYWNoZVtoXSwgTlVMTCk7CiAgICAgICAgIH0KICAgICB9CiAKQEAgLTE0
NzgsNyArMTQ3OCw3IEBAIHN0YXRpYyB2b2lkIGRvX3RiX3BoeXNfaW52YWxpZGF0ZShUcmFuc2xh
dGlvbkJsb2NrICp0YiwgYm9vbCBybV9mcm9tX3BhZ2VfbGlzdCkKICAgICAvKiBzdXBwcmVzcyBh
bnkgcmVtYWluaW5nIGp1bXBzIHRvIHRoaXMgVEIgKi8KICAgICB0Yl9qbXBfdW5saW5rKHRiKTsK
IAotICAgIGF0b21pY19zZXQoJnRjZ19jdHgtPnRiX3BoeXNfaW52YWxpZGF0ZV9jb3VudCwKKyAg
ICBxZW11X2F0b21pY19zZXQoJnRjZ19jdHgtPnRiX3BoeXNfaW52YWxpZGF0ZV9jb3VudCwKICAg
ICAgICAgICAgICAgIHRjZ19jdHgtPnRiX3BoeXNfaW52YWxpZGF0ZV9jb3VudCArIDEpOwogfQog
CkBAIC0xNzMzLDcgKzE3MzMsNyBAQCBUcmFuc2xhdGlvbkJsb2NrICp0Yl9nZW5fY29kZShDUFVT
dGF0ZSAqY3B1LAogCiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCiAgICAgLyogaW5jbHVkZXMgYWJv
cnRlZCB0cmFuc2xhdGlvbnMgYmVjYXVzZSBvZiBleGNlcHRpb25zICovCi0gICAgYXRvbWljX3Nl
dCgmcHJvZi0+dGJfY291bnQxLCBwcm9mLT50Yl9jb3VudDEgKyAxKTsKKyAgICBxZW11X2F0b21p
Y19zZXQoJnByb2YtPnRiX2NvdW50MSwgcHJvZi0+dGJfY291bnQxICsgMSk7CiAgICAgdGkgPSBw
cm9maWxlX2dldGNsb2NrKCk7CiAjZW5kaWYKIApAQCAtMTc1OCw4ICsxNzU4LDkgQEAgVHJhbnNs
YXRpb25CbG9jayAqdGJfZ2VuX2NvZGUoQ1BVU3RhdGUgKmNwdSwKICAgICB9CiAKICNpZmRlZiBD
T05GSUdfUFJPRklMRVIKLSAgICBhdG9taWNfc2V0KCZwcm9mLT50Yl9jb3VudCwgcHJvZi0+dGJf
Y291bnQgKyAxKTsKLSAgICBhdG9taWNfc2V0KCZwcm9mLT5pbnRlcm1fdGltZSwgcHJvZi0+aW50
ZXJtX3RpbWUgKyBwcm9maWxlX2dldGNsb2NrKCkgLSB0aSk7CisgICAgcWVtdV9hdG9taWNfc2V0
KCZwcm9mLT50Yl9jb3VudCwgcHJvZi0+dGJfY291bnQgKyAxKTsKKyAgICBxZW11X2F0b21pY19z
ZXQoJnByb2YtPmludGVybV90aW1lLAorICAgICAgICAgICAgICAgICAgICBwcm9mLT5pbnRlcm1f
dGltZSArIHByb2ZpbGVfZ2V0Y2xvY2soKSAtIHRpKTsKICAgICB0aSA9IHByb2ZpbGVfZ2V0Y2xv
Y2soKTsKICNlbmRpZgogCkBAIC0xODA0LDEwICsxODA1LDExIEBAIFRyYW5zbGF0aW9uQmxvY2sg
KnRiX2dlbl9jb2RlKENQVVN0YXRlICpjcHUsCiAgICAgdGItPnRjLnNpemUgPSBnZW5fY29kZV9z
aXplOwogCiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCi0gICAgYXRvbWljX3NldCgmcHJvZi0+Y29k
ZV90aW1lLCBwcm9mLT5jb2RlX3RpbWUgKyBwcm9maWxlX2dldGNsb2NrKCkgLSB0aSk7Ci0gICAg
YXRvbWljX3NldCgmcHJvZi0+Y29kZV9pbl9sZW4sIHByb2YtPmNvZGVfaW5fbGVuICsgdGItPnNp
emUpOwotICAgIGF0b21pY19zZXQoJnByb2YtPmNvZGVfb3V0X2xlbiwgcHJvZi0+Y29kZV9vdXRf
bGVuICsgZ2VuX2NvZGVfc2l6ZSk7Ci0gICAgYXRvbWljX3NldCgmcHJvZi0+c2VhcmNoX291dF9s
ZW4sIHByb2YtPnNlYXJjaF9vdXRfbGVuICsgc2VhcmNoX3NpemUpOworICAgIHFlbXVfYXRvbWlj
X3NldCgmcHJvZi0+Y29kZV90aW1lLAorICAgICAgICAgICAgICAgICAgICBwcm9mLT5jb2RlX3Rp
bWUgKyBwcm9maWxlX2dldGNsb2NrKCkgLSB0aSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZwcm9m
LT5jb2RlX2luX2xlbiwgcHJvZi0+Y29kZV9pbl9sZW4gKyB0Yi0+c2l6ZSk7CisgICAgcWVtdV9h
dG9taWNfc2V0KCZwcm9mLT5jb2RlX291dF9sZW4sIHByb2YtPmNvZGVfb3V0X2xlbiArIGdlbl9j
b2RlX3NpemUpOworICAgIHFlbXVfYXRvbWljX3NldCgmcHJvZi0+c2VhcmNoX291dF9sZW4sIHBy
b2YtPnNlYXJjaF9vdXRfbGVuICsgc2VhcmNoX3NpemUpOwogI2VuZGlmCiAKICNpZmRlZiBERUJV
R19ESVNBUwpAQCAtMTg2OSw3ICsxODcxLDcgQEAgVHJhbnNsYXRpb25CbG9jayAqdGJfZ2VuX2Nv
ZGUoQ1BVU3RhdGUgKmNwdSwKICAgICB9CiAjZW5kaWYKIAotICAgIGF0b21pY19zZXQoJnRjZ19j
dHgtPmNvZGVfZ2VuX3B0ciwgKHZvaWQgKikKKyAgICBxZW11X2F0b21pY19zZXQoJnRjZ19jdHgt
PmNvZGVfZ2VuX3B0ciwgKHZvaWQgKikKICAgICAgICAgUk9VTkRfVVAoKHVpbnRwdHJfdClnZW5f
Y29kZV9idWYgKyBnZW5fY29kZV9zaXplICsgc2VhcmNoX3NpemUsCiAgICAgICAgICAgICAgICAg
IENPREVfR0VOX0FMSUdOKSk7CiAKQEAgLTE5MDUsNyArMTkwNyw3IEBAIFRyYW5zbGF0aW9uQmxv
Y2sgKnRiX2dlbl9jb2RlKENQVVN0YXRlICpjcHUsCiAgICAgICAgIHVpbnRwdHJfdCBvcmlnX2Fs
aWduZWQgPSAodWludHB0cl90KWdlbl9jb2RlX2J1ZjsKIAogICAgICAgICBvcmlnX2FsaWduZWQg
LT0gUk9VTkRfVVAoc2l6ZW9mKCp0YiksIHFlbXVfaWNhY2hlX2xpbmVzaXplKTsKLSAgICAgICAg
YXRvbWljX3NldCgmdGNnX2N0eC0+Y29kZV9nZW5fcHRyLCAodm9pZCAqKW9yaWdfYWxpZ25lZCk7
CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmdGNnX2N0eC0+Y29kZV9nZW5fcHRyLCAodm9pZCAq
KW9yaWdfYWxpZ25lZCk7CiAgICAgICAgIHRiX2Rlc3Ryb3kodGIpOwogICAgICAgICByZXR1cm4g
ZXhpc3RpbmdfdGI7CiAgICAgfQpAQCAtMjI3Myw3ICsyMjc1LDcgQEAgc3RhdGljIHZvaWQgdGJf
am1wX2NhY2hlX2NsZWFyX3BhZ2UoQ1BVU3RhdGUgKmNwdSwgdGFyZ2V0X3Vsb25nIHBhZ2VfYWRk
cikKICAgICB1bnNpZ25lZCBpbnQgaSwgaTAgPSB0Yl9qbXBfY2FjaGVfaGFzaF9wYWdlKHBhZ2Vf
YWRkcik7CiAKICAgICBmb3IgKGkgPSAwOyBpIDwgVEJfSk1QX1BBR0VfU0laRTsgaSsrKSB7Ci0g
ICAgICAgIGF0b21pY19zZXQoJmNwdS0+dGJfam1wX2NhY2hlW2kwICsgaV0sIE5VTEwpOworICAg
ICAgICBxZW11X2F0b21pY19zZXQoJmNwdS0+dGJfam1wX2NhY2hlW2kwICsgaV0sIE5VTEwpOwog
ICAgIH0KIH0KIApAQCAtMjM5Myw3ICsyMzk1LDcgQEAgdm9pZCBkdW1wX2V4ZWNfaW5mbyh2b2lk
KQogCiAgICAgcWVtdV9wcmludGYoIlxuU3RhdGlzdGljczpcbiIpOwogICAgIHFlbXVfcHJpbnRm
KCJUQiBmbHVzaCBjb3VudCAgICAgICV1XG4iLAotICAgICAgICAgICAgICAgIGF0b21pY19yZWFk
KCZ0Yl9jdHgudGJfZmx1c2hfY291bnQpKTsKKyAgICAgICAgICAgICAgICBxZW11X2F0b21pY19y
ZWFkKCZ0Yl9jdHgudGJfZmx1c2hfY291bnQpKTsKICAgICBxZW11X3ByaW50ZigiVEIgaW52YWxp
ZGF0ZSBjb3VudCAlenVcbiIsCiAgICAgICAgICAgICAgICAgdGNnX3RiX3BoeXNfaW52YWxpZGF0
ZV9jb3VudCgpKTsKIApAQCAtMjQxNSw3ICsyNDE3LDcgQEAgdm9pZCBjcHVfaW50ZXJydXB0KENQ
VVN0YXRlICpjcHUsIGludCBtYXNrKQogewogICAgIGdfYXNzZXJ0KHFlbXVfbXV0ZXhfaW90aHJl
YWRfbG9ja2VkKCkpOwogICAgIGNwdS0+aW50ZXJydXB0X3JlcXVlc3QgfD0gbWFzazsKLSAgICBh
dG9taWNfc2V0KCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUxNi5oaWdoLCAtMSk7CisgICAg
cWVtdV9hdG9taWNfc2V0KCZjcHVfbmVnKGNwdSktPmljb3VudF9kZWNyLnUxNi5oaWdoLCAtMSk7
CiB9CiAKIC8qCmRpZmYgLS1naXQgYS9hdWRpby9qYWNrYXVkaW8uYyBiL2F1ZGlvL2phY2thdWRp
by5jCmluZGV4IDcyZWQ3YzQ5MjkuLmUwZTllMDA1YjcgMTAwNjQ0Ci0tLSBhL2F1ZGlvL2phY2th
dWRpby5jCisrKyBiL2F1ZGlvL2phY2thdWRpby5jCkBAIC0xMDQsNyArMTA0LDcgQEAgc3RhdGlj
IHZvaWQgcWphY2tfYnVmZmVyX2NyZWF0ZShRSmFja0J1ZmZlciAqYnVmZmVyLCBpbnQgY2hhbm5l
bHMsIGludCBmcmFtZXMpCiBzdGF0aWMgdm9pZCBxamFja19idWZmZXJfY2xlYXIoUUphY2tCdWZm
ZXIgKmJ1ZmZlcikKIHsKICAgICBhc3NlcnQoYnVmZmVyLT5kYXRhKTsKLSAgICBhdG9taWNfc3Rv
cmVfcmVsZWFzZSgmYnVmZmVyLT51c2VkLCAwKTsKKyAgICBxZW11X2F0b21pY19zdG9yZV9yZWxl
YXNlKCZidWZmZXItPnVzZWQsIDApOwogICAgIGJ1ZmZlci0+cnB0ciA9IDA7CiAgICAgYnVmZmVy
LT53cHRyID0gMDsKIH0KQEAgLTEyOSw3ICsxMjksOCBAQCBzdGF0aWMgaW50IHFqYWNrX2J1ZmZl
cl93cml0ZShRSmFja0J1ZmZlciAqYnVmZmVyLCBmbG9hdCAqZGF0YSwgaW50IHNpemUpCiAgICAg
YXNzZXJ0KGJ1ZmZlci0+ZGF0YSk7CiAgICAgY29uc3QgaW50IHNhbXBsZXMgPSBzaXplIC8gc2l6
ZW9mKGZsb2F0KTsKICAgICBpbnQgZnJhbWVzICAgICAgICA9IHNhbXBsZXMgLyBidWZmZXItPmNo
YW5uZWxzOwotICAgIGNvbnN0IGludCBhdmFpbCAgID0gYnVmZmVyLT5mcmFtZXMgLSBhdG9taWNf
bG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOworICAgIGNvbnN0IGludCBhdmFpbCAgID0gYnVm
ZmVyLT5mcmFtZXMgLQorICAgICAgICAgICAgICAgICAgICAgICAgcWVtdV9hdG9taWNfbG9hZF9h
Y3F1aXJlKCZidWZmZXItPnVzZWQpOwogCiAgICAgaWYgKGZyYW1lcyA+IGF2YWlsKSB7CiAgICAg
ICAgIGZyYW1lcyA9IGF2YWlsOwpAQCAtMTUzLDcgKzE1NCw3IEBAIHN0YXRpYyBpbnQgcWphY2tf
YnVmZmVyX3dyaXRlKFFKYWNrQnVmZmVyICpidWZmZXIsIGZsb2F0ICpkYXRhLCBpbnQgc2l6ZSkK
IAogICAgIGJ1ZmZlci0+d3B0ciA9IHdwdHI7CiAKLSAgICBhdG9taWNfYWRkKCZidWZmZXItPnVz
ZWQsIGZyYW1lcyk7CisgICAgcWVtdV9hdG9taWNfYWRkKCZidWZmZXItPnVzZWQsIGZyYW1lcyk7
CiAgICAgcmV0dXJuIGZyYW1lcyAqIGJ1ZmZlci0+Y2hhbm5lbHMgKiBzaXplb2YoZmxvYXQpOwog
fTsKIApAQCAtMTYxLDcgKzE2Miw4IEBAIHN0YXRpYyBpbnQgcWphY2tfYnVmZmVyX3dyaXRlKFFK
YWNrQnVmZmVyICpidWZmZXIsIGZsb2F0ICpkYXRhLCBpbnQgc2l6ZSkKIHN0YXRpYyBpbnQgcWph
Y2tfYnVmZmVyX3dyaXRlX2woUUphY2tCdWZmZXIgKmJ1ZmZlciwgZmxvYXQgKipkZXN0LCBpbnQg
ZnJhbWVzKQogewogICAgIGFzc2VydChidWZmZXItPmRhdGEpOwotICAgIGNvbnN0IGludCBhdmFp
bCAgID0gYnVmZmVyLT5mcmFtZXMgLSBhdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQp
OworICAgIGNvbnN0IGludCBhdmFpbCAgID0gYnVmZmVyLT5mcmFtZXMgLQorICAgICAgICAgICAg
ICAgICAgICAgICAgcWVtdV9hdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOwogICAg
IGludCB3cHRyID0gYnVmZmVyLT53cHRyOwogCiAgICAgaWYgKGZyYW1lcyA+IGF2YWlsKSB7CkBA
IC0xODUsNyArMTg3LDcgQEAgc3RhdGljIGludCBxamFja19idWZmZXJfd3JpdGVfbChRSmFja0J1
ZmZlciAqYnVmZmVyLCBmbG9hdCAqKmRlc3QsIGludCBmcmFtZXMpCiAgICAgfQogICAgIGJ1ZmZl
ci0+d3B0ciA9IHdwdHI7CiAKLSAgICBhdG9taWNfYWRkKCZidWZmZXItPnVzZWQsIGZyYW1lcyk7
CisgICAgcWVtdV9hdG9taWNfYWRkKCZidWZmZXItPnVzZWQsIGZyYW1lcyk7CiAgICAgcmV0dXJu
IGZyYW1lczsKIH0KIApAQCAtMTk1LDcgKzE5Nyw3IEBAIHN0YXRpYyBpbnQgcWphY2tfYnVmZmVy
X3JlYWQoUUphY2tCdWZmZXIgKmJ1ZmZlciwgZmxvYXQgKmRlc3QsIGludCBzaXplKQogICAgIGFz
c2VydChidWZmZXItPmRhdGEpOwogICAgIGNvbnN0IGludCBzYW1wbGVzID0gc2l6ZSAvIHNpemVv
ZihmbG9hdCk7CiAgICAgaW50IGZyYW1lcyAgICAgICAgPSBzYW1wbGVzIC8gYnVmZmVyLT5jaGFu
bmVsczsKLSAgICBjb25zdCBpbnQgYXZhaWwgICA9IGF0b21pY19sb2FkX2FjcXVpcmUoJmJ1ZmZl
ci0+dXNlZCk7CisgICAgY29uc3QgaW50IGF2YWlsICAgPSBxZW11X2F0b21pY19sb2FkX2FjcXVp
cmUoJmJ1ZmZlci0+dXNlZCk7CiAKICAgICBpZiAoZnJhbWVzID4gYXZhaWwpIHsKICAgICAgICAg
ZnJhbWVzID0gYXZhaWw7CkBAIC0yMTksNyArMjIxLDcgQEAgc3RhdGljIGludCBxamFja19idWZm
ZXJfcmVhZChRSmFja0J1ZmZlciAqYnVmZmVyLCBmbG9hdCAqZGVzdCwgaW50IHNpemUpCiAKICAg
ICBidWZmZXItPnJwdHIgPSBycHRyOwogCi0gICAgYXRvbWljX3N1YigmYnVmZmVyLT51c2VkLCBm
cmFtZXMpOworICAgIHFlbXVfYXRvbWljX3N1YigmYnVmZmVyLT51c2VkLCBmcmFtZXMpOwogICAg
IHJldHVybiBmcmFtZXMgKiBidWZmZXItPmNoYW5uZWxzICogc2l6ZW9mKGZsb2F0KTsKIH0KIApA
QCAtMjI4LDcgKzIzMCw3IEBAIHN0YXRpYyBpbnQgcWphY2tfYnVmZmVyX3JlYWRfbChRSmFja0J1
ZmZlciAqYnVmZmVyLCBmbG9hdCAqKmRlc3QsIGludCBmcmFtZXMpCiB7CiAgICAgYXNzZXJ0KGJ1
ZmZlci0+ZGF0YSk7CiAgICAgaW50IGNvcHkgICAgICAgPSBmcmFtZXM7Ci0gICAgY29uc3QgaW50
IHVzZWQgPSBhdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOworICAgIGNvbnN0IGlu
dCB1c2VkID0gcWVtdV9hdG9taWNfbG9hZF9hY3F1aXJlKCZidWZmZXItPnVzZWQpOwogICAgIGlu
dCBycHRyICAgICAgID0gYnVmZmVyLT5ycHRyOwogCiAgICAgaWYgKGNvcHkgPiB1c2VkKSB7CkBA
IC0yNTIsNyArMjU0LDcgQEAgc3RhdGljIGludCBxamFja19idWZmZXJfcmVhZF9sKFFKYWNrQnVm
ZmVyICpidWZmZXIsIGZsb2F0ICoqZGVzdCwgaW50IGZyYW1lcykKICAgICB9CiAgICAgYnVmZmVy
LT5ycHRyID0gcnB0cjsKIAotICAgIGF0b21pY19zdWIoJmJ1ZmZlci0+dXNlZCwgY29weSk7Cisg
ICAgcWVtdV9hdG9taWNfc3ViKCZidWZmZXItPnVzZWQsIGNvcHkpOwogICAgIHJldHVybiBjb3B5
OwogfQogCmRpZmYgLS1naXQgYS9ibG9jay5jIGIvYmxvY2suYwppbmRleCA5NTM4YWY0ODg0Li41
NDk4N2IzYWQ1IDEwMDY0NAotLS0gYS9ibG9jay5jCisrKyBiL2Jsb2NrLmMKQEAgLTE2OTQsNyAr
MTY5NCw3IEBAIHN0YXRpYyBpbnQgYmRydl9vcGVuX2NvbW1vbihCbG9ja0RyaXZlclN0YXRlICpi
cywgQmxvY2tCYWNrZW5kICpmaWxlLAogICAgIH0KIAogICAgIC8qIGJkcnZfbmV3KCkgYW5kIGJk
cnZfY2xvc2UoKSBtYWtlIGl0IHNvICovCi0gICAgYXNzZXJ0KGF0b21pY19yZWFkKCZicy0+Y29w
eV9vbl9yZWFkKSA9PSAwKTsKKyAgICBhc3NlcnQocWVtdV9hdG9taWNfcmVhZCgmYnMtPmNvcHlf
b25fcmVhZCkgPT0gMCk7CiAKICAgICBpZiAoYnMtPm9wZW5fZmxhZ3MgJiBCRFJWX09fQ09QWV9P
Tl9SRUFEKSB7CiAgICAgICAgIGlmICghYnMtPnJlYWRfb25seSkgewpAQCAtNDQzNiw3ICs0NDM2
LDcgQEAgc3RhdGljIHZvaWQgYmRydl9jbG9zZShCbG9ja0RyaXZlclN0YXRlICpicykKICAgICBi
cy0+ZmlsZSA9IE5VTEw7CiAgICAgZ19mcmVlKGJzLT5vcGFxdWUpOwogICAgIGJzLT5vcGFxdWUg
PSBOVUxMOwotICAgIGF0b21pY19zZXQoJmJzLT5jb3B5X29uX3JlYWQsIDApOworICAgIHFlbXVf
YXRvbWljX3NldCgmYnMtPmNvcHlfb25fcmVhZCwgMCk7CiAgICAgYnMtPmJhY2tpbmdfZmlsZVsw
XSA9ICdcMCc7CiAgICAgYnMtPmJhY2tpbmdfZm9ybWF0WzBdID0gJ1wwJzsKICAgICBicy0+dG90
YWxfc2VjdG9ycyA9IDA7CmRpZmYgLS1naXQgYS9ibG9jay9ibG9jay1iYWNrZW5kLmMgYi9ibG9j
ay9ibG9jay1iYWNrZW5kLmMKaW5kZXggMjRkZDA2NzBkMS4uMDUzOTAyMDlhNiAxMDA2NDQKLS0t
IGEvYmxvY2svYmxvY2stYmFja2VuZC5jCisrKyBiL2Jsb2NrL2Jsb2NrLWJhY2tlbmQuYwpAQCAt
MTM1MywxMiArMTM1MywxMiBAQCBpbnQgYmxrX21ha2VfemVybyhCbG9ja0JhY2tlbmQgKmJsaywg
QmRydlJlcXVlc3RGbGFncyBmbGFncykKIAogdm9pZCBibGtfaW5jX2luX2ZsaWdodChCbG9ja0Jh
Y2tlbmQgKmJsaykKIHsKLSAgICBhdG9taWNfaW5jKCZibGstPmluX2ZsaWdodCk7CisgICAgcWVt
dV9hdG9taWNfaW5jKCZibGstPmluX2ZsaWdodCk7CiB9CiAKIHZvaWQgYmxrX2RlY19pbl9mbGln
aHQoQmxvY2tCYWNrZW5kICpibGspCiB7Ci0gICAgYXRvbWljX2RlYygmYmxrLT5pbl9mbGlnaHQp
OworICAgIHFlbXVfYXRvbWljX2RlYygmYmxrLT5pbl9mbGlnaHQpOwogICAgIGFpb193YWl0X2tp
Y2soKTsKIH0KIApAQCAtMTcyMCw3ICsxNzIwLDcgQEAgdm9pZCBibGtfZHJhaW4oQmxvY2tCYWNr
ZW5kICpibGspCiAKICAgICAvKiBXZSBtYXkgaGF2ZSAtRU5PTUVESVVNIGNvbXBsZXRpb25zIGlu
IGZsaWdodCAqLwogICAgIEFJT19XQUlUX1dISUxFKGJsa19nZXRfYWlvX2NvbnRleHQoYmxrKSwK
LSAgICAgICAgICAgICAgICAgICBhdG9taWNfbWJfcmVhZCgmYmxrLT5pbl9mbGlnaHQpID4gMCk7
CisgICAgICAgICAgICAgICAgICAgcWVtdV9hdG9taWNfbWJfcmVhZCgmYmxrLT5pbl9mbGlnaHQp
ID4gMCk7CiAKICAgICBpZiAoYnMpIHsKICAgICAgICAgYmRydl9kcmFpbmVkX2VuZChicyk7CkBA
IC0xNzM5LDcgKzE3MzksNyBAQCB2b2lkIGJsa19kcmFpbl9hbGwodm9pZCkKICAgICAgICAgYWlv
X2NvbnRleHRfYWNxdWlyZShjdHgpOwogCiAgICAgICAgIC8qIFdlIG1heSBoYXZlIC1FTk9NRURJ
VU0gY29tcGxldGlvbnMgaW4gZmxpZ2h0ICovCi0gICAgICAgIEFJT19XQUlUX1dISUxFKGN0eCwg
YXRvbWljX21iX3JlYWQoJmJsay0+aW5fZmxpZ2h0KSA+IDApOworICAgICAgICBBSU9fV0FJVF9X
SElMRShjdHgsIHFlbXVfYXRvbWljX21iX3JlYWQoJmJsay0+aW5fZmxpZ2h0KSA+IDApOwogCiAg
ICAgICAgIGFpb19jb250ZXh0X3JlbGVhc2UoY3R4KTsKICAgICB9CkBAIC0yMzQ2LDYgKzIzNDYs
NyBAQCB2b2lkIGJsa19pb19saW1pdHNfdXBkYXRlX2dyb3VwKEJsb2NrQmFja2VuZCAqYmxrLCBj
b25zdCBjaGFyICpncm91cCkKIHN0YXRpYyB2b2lkIGJsa19yb290X2RyYWluZWRfYmVnaW4oQmRy
dkNoaWxkICpjaGlsZCkKIHsKICAgICBCbG9ja0JhY2tlbmQgKmJsayA9IGNoaWxkLT5vcGFxdWU7
CisgICAgVGhyb3R0bGVHcm91cE1lbWJlciAqdGdtID0gJmJsay0+cHVibGljLnRocm90dGxlX2dy
b3VwX21lbWJlcjsKIAogICAgIGlmICgrK2Jsay0+cXVpZXNjZV9jb3VudGVyID09IDEpIHsKICAg
ICAgICAgaWYgKGJsay0+ZGV2X29wcyAmJiBibGstPmRldl9vcHMtPmRyYWluZWRfYmVnaW4pIHsK
QEAgLTIzNTYsOCArMjM1Nyw4IEBAIHN0YXRpYyB2b2lkIGJsa19yb290X2RyYWluZWRfYmVnaW4o
QmRydkNoaWxkICpjaGlsZCkKICAgICAvKiBOb3RlIHRoYXQgYmxrLT5yb290IG1heSBub3QgYmUg
YWNjZXNzaWJsZSBoZXJlIHlldCBpZiB3ZSBhcmUganVzdAogICAgICAqIGF0dGFjaGluZyB0byBh
IEJsb2NrRHJpdmVyU3RhdGUgdGhhdCBpcyBkcmFpbmVkLiBVc2UgY2hpbGQgaW5zdGVhZC4gKi8K
IAotICAgIGlmIChhdG9taWNfZmV0Y2hfaW5jKCZibGstPnB1YmxpYy50aHJvdHRsZV9ncm91cF9t
ZW1iZXIuaW9fbGltaXRzX2Rpc2FibGVkKSA9PSAwKSB7Ci0gICAgICAgIHRocm90dGxlX2dyb3Vw
X3Jlc3RhcnRfdGdtKCZibGstPnB1YmxpYy50aHJvdHRsZV9ncm91cF9tZW1iZXIpOworICAgIGlm
IChxZW11X2F0b21pY19mZXRjaF9pbmMoJnRnbS0+aW9fbGltaXRzX2Rpc2FibGVkKSA9PSAwKSB7
CisgICAgICAgIHRocm90dGxlX2dyb3VwX3Jlc3RhcnRfdGdtKHRnbSk7CiAgICAgfQogfQogCkBA
IC0yMzc0LDcgKzIzNzUsNyBAQCBzdGF0aWMgdm9pZCBibGtfcm9vdF9kcmFpbmVkX2VuZChCZHJ2
Q2hpbGQgKmNoaWxkLCBpbnQgKmRyYWluZWRfZW5kX2NvdW50ZXIpCiAgICAgYXNzZXJ0KGJsay0+
cXVpZXNjZV9jb3VudGVyKTsKIAogICAgIGFzc2VydChibGstPnB1YmxpYy50aHJvdHRsZV9ncm91
cF9tZW1iZXIuaW9fbGltaXRzX2Rpc2FibGVkKTsKLSAgICBhdG9taWNfZGVjKCZibGstPnB1Ymxp
Yy50aHJvdHRsZV9ncm91cF9tZW1iZXIuaW9fbGltaXRzX2Rpc2FibGVkKTsKKyAgICBxZW11X2F0
b21pY19kZWMoJmJsay0+cHVibGljLnRocm90dGxlX2dyb3VwX21lbWJlci5pb19saW1pdHNfZGlz
YWJsZWQpOwogCiAgICAgaWYgKC0tYmxrLT5xdWllc2NlX2NvdW50ZXIgPT0gMCkgewogICAgICAg
ICBpZiAoYmxrLT5kZXZfb3BzICYmIGJsay0+ZGV2X29wcy0+ZHJhaW5lZF9lbmQpIHsKZGlmZiAt
LWdpdCBhL2Jsb2NrL2lvLmMgYi9ibG9jay9pby5jCmluZGV4IGEyMzg5YmIzOGMuLjU4YTE1MmVl
NTkgMTAwNjQ0Ci0tLSBhL2Jsb2NrL2lvLmMKKysrIGIvYmxvY2svaW8uYwpAQCAtNjksNyArNjks
NyBAQCB2b2lkIGJkcnZfcGFyZW50X2RyYWluZWRfZW5kX3NpbmdsZShCZHJ2Q2hpbGQgKmMpCiB7
CiAgICAgaW50IGRyYWluZWRfZW5kX2NvdW50ZXIgPSAwOwogICAgIGJkcnZfcGFyZW50X2RyYWlu
ZWRfZW5kX3NpbmdsZV9ub19wb2xsKGMsICZkcmFpbmVkX2VuZF9jb3VudGVyKTsKLSAgICBCRFJW
X1BPTExfV0hJTEUoYy0+YnMsIGF0b21pY19yZWFkKCZkcmFpbmVkX2VuZF9jb3VudGVyKSA+IDAp
OworICAgIEJEUlZfUE9MTF9XSElMRShjLT5icywgcWVtdV9hdG9taWNfcmVhZCgmZHJhaW5lZF9l
bmRfY291bnRlcikgPiAwKTsKIH0KIAogc3RhdGljIHZvaWQgYmRydl9wYXJlbnRfZHJhaW5lZF9l
bmQoQmxvY2tEcml2ZXJTdGF0ZSAqYnMsIEJkcnZDaGlsZCAqaWdub3JlLApAQCAtMTg2LDEyICsx
ODYsMTIgQEAgdm9pZCBiZHJ2X3JlZnJlc2hfbGltaXRzKEJsb2NrRHJpdmVyU3RhdGUgKmJzLCBF
cnJvciAqKmVycnApCiAgKi8KIHZvaWQgYmRydl9lbmFibGVfY29weV9vbl9yZWFkKEJsb2NrRHJp
dmVyU3RhdGUgKmJzKQogewotICAgIGF0b21pY19pbmMoJmJzLT5jb3B5X29uX3JlYWQpOworICAg
IHFlbXVfYXRvbWljX2luYygmYnMtPmNvcHlfb25fcmVhZCk7CiB9CiAKIHZvaWQgYmRydl9kaXNh
YmxlX2NvcHlfb25fcmVhZChCbG9ja0RyaXZlclN0YXRlICpicykKIHsKLSAgICBpbnQgb2xkID0g
YXRvbWljX2ZldGNoX2RlYygmYnMtPmNvcHlfb25fcmVhZCk7CisgICAgaW50IG9sZCA9IHFlbXVf
YXRvbWljX2ZldGNoX2RlYygmYnMtPmNvcHlfb25fcmVhZCk7CiAgICAgYXNzZXJ0KG9sZCA+PSAx
KTsKIH0KIApAQCAtMjE5LDkgKzIxOSw5IEBAIHN0YXRpYyB2b2lkIGNvcm91dGluZV9mbiBiZHJ2
X2RyYWluX2ludm9rZV9lbnRyeSh2b2lkICpvcGFxdWUpCiAgICAgfQogCiAgICAgLyogU2V0IGRh
dGEtPmRvbmUgYW5kIGRlY3JlbWVudCBkcmFpbmVkX2VuZF9jb3VudGVyIGJlZm9yZSBiZHJ2X3dh
a2V1cCgpICovCi0gICAgYXRvbWljX21iX3NldCgmZGF0YS0+ZG9uZSwgdHJ1ZSk7CisgICAgcWVt
dV9hdG9taWNfbWJfc2V0KCZkYXRhLT5kb25lLCB0cnVlKTsKICAgICBpZiAoIWRhdGEtPmJlZ2lu
KSB7Ci0gICAgICAgIGF0b21pY19kZWMoZGF0YS0+ZHJhaW5lZF9lbmRfY291bnRlcik7CisgICAg
ICAgIHFlbXVfYXRvbWljX2RlYyhkYXRhLT5kcmFpbmVkX2VuZF9jb3VudGVyKTsKICAgICB9CiAg
ICAgYmRydl9kZWNfaW5fZmxpZ2h0KGJzKTsKIApAQCAtMjQ4LDcgKzI0OCw3IEBAIHN0YXRpYyB2
b2lkIGJkcnZfZHJhaW5faW52b2tlKEJsb2NrRHJpdmVyU3RhdGUgKmJzLCBib29sIGJlZ2luLAog
ICAgIH07CiAKICAgICBpZiAoIWJlZ2luKSB7Ci0gICAgICAgIGF0b21pY19pbmMoZHJhaW5lZF9l
bmRfY291bnRlcik7CisgICAgICAgIHFlbXVfYXRvbWljX2luYyhkcmFpbmVkX2VuZF9jb3VudGVy
KTsKICAgICB9CiAKICAgICAvKiBNYWtlIHN1cmUgdGhlIGRyaXZlciBjYWxsYmFjayBjb21wbGV0
ZXMgZHVyaW5nIHRoZSBwb2xsaW5nIHBoYXNlIGZvcgpAQCAtMjY4LDcgKzI2OCw3IEBAIGJvb2wg
YmRydl9kcmFpbl9wb2xsKEJsb2NrRHJpdmVyU3RhdGUgKmJzLCBib29sIHJlY3Vyc2l2ZSwKICAg
ICAgICAgcmV0dXJuIHRydWU7CiAgICAgfQogCi0gICAgaWYgKGF0b21pY19yZWFkKCZicy0+aW5f
ZmxpZ2h0KSkgeworICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZicy0+aW5fZmxpZ2h0KSkgewog
ICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CiAKQEAgLTM4Miw3ICszODIsNyBAQCB2b2lkIGJk
cnZfZG9fZHJhaW5lZF9iZWdpbl9xdWllc2NlKEJsb2NrRHJpdmVyU3RhdGUgKmJzLAogICAgIGFz
c2VydCghcWVtdV9pbl9jb3JvdXRpbmUoKSk7CiAKICAgICAvKiBTdG9wIHRoaW5ncyBpbiBwYXJl
bnQtdG8tY2hpbGQgb3JkZXIgKi8KLSAgICBpZiAoYXRvbWljX2ZldGNoX2luYygmYnMtPnF1aWVz
Y2VfY291bnRlcikgPT0gMCkgeworICAgIGlmIChxZW11X2F0b21pY19mZXRjaF9pbmMoJmJzLT5x
dWllc2NlX2NvdW50ZXIpID09IDApIHsKICAgICAgICAgYWlvX2Rpc2FibGVfZXh0ZXJuYWwoYmRy
dl9nZXRfYWlvX2NvbnRleHQoYnMpKTsKICAgICB9CiAKQEAgLTQ3Myw3ICs0NzMsNyBAQCBzdGF0
aWMgdm9pZCBiZHJ2X2RvX2RyYWluZWRfZW5kKEJsb2NrRHJpdmVyU3RhdGUgKmJzLCBib29sIHJl
Y3Vyc2l2ZSwKICAgICBiZHJ2X3BhcmVudF9kcmFpbmVkX2VuZChicywgcGFyZW50LCBpZ25vcmVf
YmRzX3BhcmVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhaW5lZF9lbmRfY291
bnRlcik7CiAKLSAgICBvbGRfcXVpZXNjZV9jb3VudGVyID0gYXRvbWljX2ZldGNoX2RlYygmYnMt
PnF1aWVzY2VfY291bnRlcik7CisgICAgb2xkX3F1aWVzY2VfY291bnRlciA9IHFlbXVfYXRvbWlj
X2ZldGNoX2RlYygmYnMtPnF1aWVzY2VfY291bnRlcik7CiAgICAgaWYgKG9sZF9xdWllc2NlX2Nv
dW50ZXIgPT0gMSkgewogICAgICAgICBhaW9fZW5hYmxlX2V4dGVybmFsKGJkcnZfZ2V0X2Fpb19j
b250ZXh0KGJzKSk7CiAgICAgfQpAQCAtNDkyLDcgKzQ5Miw3IEBAIHZvaWQgYmRydl9kcmFpbmVk
X2VuZChCbG9ja0RyaXZlclN0YXRlICpicykKIHsKICAgICBpbnQgZHJhaW5lZF9lbmRfY291bnRl
ciA9IDA7CiAgICAgYmRydl9kb19kcmFpbmVkX2VuZChicywgZmFsc2UsIE5VTEwsIGZhbHNlLCAm
ZHJhaW5lZF9lbmRfY291bnRlcik7Ci0gICAgQkRSVl9QT0xMX1dISUxFKGJzLCBhdG9taWNfcmVh
ZCgmZHJhaW5lZF9lbmRfY291bnRlcikgPiAwKTsKKyAgICBCRFJWX1BPTExfV0hJTEUoYnMsIHFl
bXVfYXRvbWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CiB9CiAKIHZvaWQgYmRy
dl9kcmFpbmVkX2VuZF9ub19wb2xsKEJsb2NrRHJpdmVyU3RhdGUgKmJzLCBpbnQgKmRyYWluZWRf
ZW5kX2NvdW50ZXIpCkBAIC01MDQsNyArNTA0LDcgQEAgdm9pZCBiZHJ2X3N1YnRyZWVfZHJhaW5l
ZF9lbmQoQmxvY2tEcml2ZXJTdGF0ZSAqYnMpCiB7CiAgICAgaW50IGRyYWluZWRfZW5kX2NvdW50
ZXIgPSAwOwogICAgIGJkcnZfZG9fZHJhaW5lZF9lbmQoYnMsIHRydWUsIE5VTEwsIGZhbHNlLCAm
ZHJhaW5lZF9lbmRfY291bnRlcik7Ci0gICAgQkRSVl9QT0xMX1dISUxFKGJzLCBhdG9taWNfcmVh
ZCgmZHJhaW5lZF9lbmRfY291bnRlcikgPiAwKTsKKyAgICBCRFJWX1BPTExfV0hJTEUoYnMsIHFl
bXVfYXRvbWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CiB9CiAKIHZvaWQgYmRy
dl9hcHBseV9zdWJ0cmVlX2RyYWluKEJkcnZDaGlsZCAqY2hpbGQsIEJsb2NrRHJpdmVyU3RhdGUg
Km5ld19wYXJlbnQpCkBAIC01MjYsNyArNTI2LDcgQEAgdm9pZCBiZHJ2X3VuYXBwbHlfc3VidHJl
ZV9kcmFpbihCZHJ2Q2hpbGQgKmNoaWxkLCBCbG9ja0RyaXZlclN0YXRlICpvbGRfcGFyZW50KQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZkcmFpbmVkX2VuZF9jb3VudGVyKTsKICAgICB9
CiAKLSAgICBCRFJWX1BPTExfV0hJTEUoY2hpbGQtPmJzLCBhdG9taWNfcmVhZCgmZHJhaW5lZF9l
bmRfY291bnRlcikgPiAwKTsKKyAgICBCRFJWX1BPTExfV0hJTEUoY2hpbGQtPmJzLCBxZW11X2F0
b21pY19yZWFkKCZkcmFpbmVkX2VuZF9jb3VudGVyKSA+IDApOwogfQogCiAvKgpAQCAtNTUzLDcg
KzU1Myw3IEBAIHN0YXRpYyB2b2lkIGJkcnZfZHJhaW5fYXNzZXJ0X2lkbGUoQmxvY2tEcml2ZXJT
dGF0ZSAqYnMpCiB7CiAgICAgQmRydkNoaWxkICpjaGlsZCwgKm5leHQ7CiAKLSAgICBhc3NlcnQo
YXRvbWljX3JlYWQoJmJzLT5pbl9mbGlnaHQpID09IDApOworICAgIGFzc2VydChxZW11X2F0b21p
Y19yZWFkKCZicy0+aW5fZmxpZ2h0KSA9PSAwKTsKICAgICBRTElTVF9GT1JFQUNIX1NBRkUoY2hp
bGQsICZicy0+Y2hpbGRyZW4sIG5leHQsIG5leHQpIHsKICAgICAgICAgYmRydl9kcmFpbl9hc3Nl
cnRfaWRsZShjaGlsZC0+YnMpOwogICAgIH0KQEAgLTY1NSw3ICs2NTUsNyBAQCB2b2lkIGJkcnZf
ZHJhaW5fYWxsX2VuZCh2b2lkKQogICAgIH0KIAogICAgIGFzc2VydChxZW11X2dldF9jdXJyZW50
X2Fpb19jb250ZXh0KCkgPT0gcWVtdV9nZXRfYWlvX2NvbnRleHQoKSk7Ci0gICAgQUlPX1dBSVRf
V0hJTEUoTlVMTCwgYXRvbWljX3JlYWQoJmRyYWluZWRfZW5kX2NvdW50ZXIpID4gMCk7CisgICAg
QUlPX1dBSVRfV0hJTEUoTlVMTCwgcWVtdV9hdG9taWNfcmVhZCgmZHJhaW5lZF9lbmRfY291bnRl
cikgPiAwKTsKIAogICAgIGFzc2VydChiZHJ2X2RyYWluX2FsbF9jb3VudCA+IDApOwogICAgIGJk
cnZfZHJhaW5fYWxsX2NvdW50LS07CkBAIC02NzUsNyArNjc1LDcgQEAgdm9pZCBiZHJ2X2RyYWlu
X2FsbCh2b2lkKQogc3RhdGljIHZvaWQgdHJhY2tlZF9yZXF1ZXN0X2VuZChCZHJ2VHJhY2tlZFJl
cXVlc3QgKnJlcSkKIHsKICAgICBpZiAocmVxLT5zZXJpYWxpc2luZykgewotICAgICAgICBhdG9t
aWNfZGVjKCZyZXEtPmJzLT5zZXJpYWxpc2luZ19pbl9mbGlnaHQpOworICAgICAgICBxZW11X2F0
b21pY19kZWMoJnJlcS0+YnMtPnNlcmlhbGlzaW5nX2luX2ZsaWdodCk7CiAgICAgfQogCiAgICAg
cWVtdV9jb19tdXRleF9sb2NrKCZyZXEtPmJzLT5yZXFzX2xvY2spOwpAQCAtNzc3LDcgKzc3Nyw3
IEBAIGJvb2wgYmRydl9tYXJrX3JlcXVlc3Rfc2VyaWFsaXNpbmcoQmRydlRyYWNrZWRSZXF1ZXN0
ICpyZXEsIHVpbnQ2NF90IGFsaWduKQogCiAgICAgcWVtdV9jb19tdXRleF9sb2NrKCZicy0+cmVx
c19sb2NrKTsKICAgICBpZiAoIXJlcS0+c2VyaWFsaXNpbmcpIHsKLSAgICAgICAgYXRvbWljX2lu
YygmcmVxLT5icy0+c2VyaWFsaXNpbmdfaW5fZmxpZ2h0KTsKKyAgICAgICAgcWVtdV9hdG9taWNf
aW5jKCZyZXEtPmJzLT5zZXJpYWxpc2luZ19pbl9mbGlnaHQpOwogICAgICAgICByZXEtPnNlcmlh
bGlzaW5nID0gdHJ1ZTsKICAgICB9CiAKQEAgLTg0MSw3ICs4NDEsNyBAQCBzdGF0aWMgaW50IGJk
cnZfZ2V0X2NsdXN0ZXJfc2l6ZShCbG9ja0RyaXZlclN0YXRlICpicykKIAogdm9pZCBiZHJ2X2lu
Y19pbl9mbGlnaHQoQmxvY2tEcml2ZXJTdGF0ZSAqYnMpCiB7Ci0gICAgYXRvbWljX2luYygmYnMt
PmluX2ZsaWdodCk7CisgICAgcWVtdV9hdG9taWNfaW5jKCZicy0+aW5fZmxpZ2h0KTsKIH0KIAog
dm9pZCBiZHJ2X3dha2V1cChCbG9ja0RyaXZlclN0YXRlICpicykKQEAgLTg1MSw3ICs4NTEsNyBA
QCB2b2lkIGJkcnZfd2FrZXVwKEJsb2NrRHJpdmVyU3RhdGUgKmJzKQogCiB2b2lkIGJkcnZfZGVj
X2luX2ZsaWdodChCbG9ja0RyaXZlclN0YXRlICpicykKIHsKLSAgICBhdG9taWNfZGVjKCZicy0+
aW5fZmxpZ2h0KTsKKyAgICBxZW11X2F0b21pY19kZWMoJmJzLT5pbl9mbGlnaHQpOwogICAgIGJk
cnZfd2FrZXVwKGJzKTsKIH0KIApAQCAtODYwLDcgKzg2MCw3IEBAIHN0YXRpYyBib29sIGNvcm91
dGluZV9mbiBiZHJ2X3dhaXRfc2VyaWFsaXNpbmdfcmVxdWVzdHMoQmRydlRyYWNrZWRSZXF1ZXN0
ICpzZWxmCiAgICAgQmxvY2tEcml2ZXJTdGF0ZSAqYnMgPSBzZWxmLT5iczsKICAgICBib29sIHdh
aXRlZCA9IGZhbHNlOwogCi0gICAgaWYgKCFhdG9taWNfcmVhZCgmYnMtPnNlcmlhbGlzaW5nX2lu
X2ZsaWdodCkpIHsKKyAgICBpZiAoIXFlbXVfYXRvbWljX3JlYWQoJmJzLT5zZXJpYWxpc2luZ19p
bl9mbGlnaHQpKSB7CiAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICB9CiAKQEAgLTE3NDcsNyAr
MTc0Nyw3IEBAIGludCBjb3JvdXRpbmVfZm4gYmRydl9jb19wcmVhZHZfcGFydChCZHJ2Q2hpbGQg
KmNoaWxkLAogICAgIGJkcnZfaW5jX2luX2ZsaWdodChicyk7CiAKICAgICAvKiBEb24ndCBkbyBj
b3B5LW9uLXJlYWQgaWYgd2UgcmVhZCBkYXRhIGJlZm9yZSB3cml0ZSBvcGVyYXRpb24gKi8KLSAg
ICBpZiAoYXRvbWljX3JlYWQoJmJzLT5jb3B5X29uX3JlYWQpKSB7CisgICAgaWYgKHFlbXVfYXRv
bWljX3JlYWQoJmJzLT5jb3B5X29uX3JlYWQpKSB7CiAgICAgICAgIGZsYWdzIHw9IEJEUlZfUkVR
X0NPUFlfT05fUkVBRDsKICAgICB9CiAKQEAgLTE5MzUsNyArMTkzNSw3IEBAIGJkcnZfY29fd3Jp
dGVfcmVxX2ZpbmlzaChCZHJ2Q2hpbGQgKmNoaWxkLCBpbnQ2NF90IG9mZnNldCwgdWludDY0X3Qg
Ynl0ZXMsCiAgICAgaW50NjRfdCBlbmRfc2VjdG9yID0gRElWX1JPVU5EX1VQKG9mZnNldCArIGJ5
dGVzLCBCRFJWX1NFQ1RPUl9TSVpFKTsKICAgICBCbG9ja0RyaXZlclN0YXRlICpicyA9IGNoaWxk
LT5iczsKIAotICAgIGF0b21pY19pbmMoJmJzLT53cml0ZV9nZW4pOworICAgIHFlbXVfYXRvbWlj
X2luYygmYnMtPndyaXRlX2dlbik7CiAKICAgICAvKgogICAgICAqIERpc2NhcmQgY2Fubm90IGV4
dGVuZCB0aGUgaW1hZ2UsIGJ1dCBpbiBlcnJvciBoYW5kbGluZyBjYXNlcywgc3VjaCBhcwpAQCAt
Mjc2OCw3ICsyNzY4LDcgQEAgaW50IGNvcm91dGluZV9mbiBiZHJ2X2NvX2ZsdXNoKEJsb2NrRHJp
dmVyU3RhdGUgKmJzKQogICAgIH0KIAogICAgIHFlbXVfY29fbXV0ZXhfbG9jaygmYnMtPnJlcXNf
bG9jayk7Ci0gICAgY3VycmVudF9nZW4gPSBhdG9taWNfcmVhZCgmYnMtPndyaXRlX2dlbik7Cisg
ICAgY3VycmVudF9nZW4gPSBxZW11X2F0b21pY19yZWFkKCZicy0+d3JpdGVfZ2VuKTsKIAogICAg
IC8qIFdhaXQgdW50aWwgYW55IHByZXZpb3VzIGZsdXNoZXMgYXJlIGNvbXBsZXRlZCAqLwogICAg
IHdoaWxlIChicy0+YWN0aXZlX2ZsdXNoX3JlcSkgewpAQCAtMzExNiw3ICszMTE2LDcgQEAgdm9p
ZCBiZHJ2X2lvX3BsdWcoQmxvY2tEcml2ZXJTdGF0ZSAqYnMpCiAgICAgICAgIGJkcnZfaW9fcGx1
ZyhjaGlsZC0+YnMpOwogICAgIH0KIAotICAgIGlmIChhdG9taWNfZmV0Y2hfaW5jKCZicy0+aW9f
cGx1Z2dlZCkgPT0gMCkgeworICAgIGlmIChxZW11X2F0b21pY19mZXRjaF9pbmMoJmJzLT5pb19w
bHVnZ2VkKSA9PSAwKSB7CiAgICAgICAgIEJsb2NrRHJpdmVyICpkcnYgPSBicy0+ZHJ2OwogICAg
ICAgICBpZiAoZHJ2ICYmIGRydi0+YmRydl9pb19wbHVnKSB7CiAgICAgICAgICAgICBkcnYtPmJk
cnZfaW9fcGx1Zyhicyk7CkBAIC0zMTI5LDcgKzMxMjksNyBAQCB2b2lkIGJkcnZfaW9fdW5wbHVn
KEJsb2NrRHJpdmVyU3RhdGUgKmJzKQogICAgIEJkcnZDaGlsZCAqY2hpbGQ7CiAKICAgICBhc3Nl
cnQoYnMtPmlvX3BsdWdnZWQpOwotICAgIGlmIChhdG9taWNfZmV0Y2hfZGVjKCZicy0+aW9fcGx1
Z2dlZCkgPT0gMSkgeworICAgIGlmIChxZW11X2F0b21pY19mZXRjaF9kZWMoJmJzLT5pb19wbHVn
Z2VkKSA9PSAxKSB7CiAgICAgICAgIEJsb2NrRHJpdmVyICpkcnYgPSBicy0+ZHJ2OwogICAgICAg
ICBpZiAoZHJ2ICYmIGRydi0+YmRydl9pb191bnBsdWcpIHsKICAgICAgICAgICAgIGRydi0+YmRy
dl9pb191bnBsdWcoYnMpOwpkaWZmIC0tZ2l0IGEvYmxvY2svbmZzLmMgYi9ibG9jay9uZnMuYwpp
bmRleCA2MWEyNDlhOWZjLi5kMjY2ZjkzZDhjIDEwMDY0NAotLS0gYS9ibG9jay9uZnMuYworKysg
Yi9ibG9jay9uZnMuYwpAQCAtNzIxLDcgKzcyMSw3IEBAIG5mc19nZXRfYWxsb2NhdGVkX2ZpbGVf
c2l6ZV9jYihpbnQgcmV0LCBzdHJ1Y3QgbmZzX2NvbnRleHQgKm5mcywgdm9pZCAqZGF0YSwKICAg
ICB9CiAKICAgICAvKiBTZXQgdGFzay0+Y29tcGxldGUgYmVmb3JlIHJlYWRpbmcgYnMtPndha2V1
cC4gICovCi0gICAgYXRvbWljX21iX3NldCgmdGFzay0+Y29tcGxldGUsIDEpOworICAgIHFlbXVf
YXRvbWljX21iX3NldCgmdGFzay0+Y29tcGxldGUsIDEpOwogICAgIGJkcnZfd2FrZXVwKHRhc2st
PmJzKTsKIH0KIApkaWZmIC0tZ2l0IGEvYmxvY2svc2hlZXBkb2cuYyBiL2Jsb2NrL3NoZWVwZG9n
LmMKaW5kZXggY2JiZWJjMWFhZi4uYjUzNTgzMDc5OSAxMDA2NDQKLS0tIGEvYmxvY2svc2hlZXBk
b2cuYworKysgYi9ibG9jay9zaGVlcGRvZy5jCkBAIC02NjUsNyArNjY1LDcgQEAgb3V0OgogICAg
IHNyY28tPmNvID0gTlVMTDsKICAgICBzcmNvLT5yZXQgPSByZXQ7CiAgICAgLyogU2V0IHNyY28t
PmZpbmlzaGVkIGJlZm9yZSByZWFkaW5nIGJzLT53YWtldXAuICAqLwotICAgIGF0b21pY19tYl9z
ZXQoJnNyY28tPmZpbmlzaGVkLCB0cnVlKTsKKyAgICBxZW11X2F0b21pY19tYl9zZXQoJnNyY28t
PmZpbmlzaGVkLCB0cnVlKTsKICAgICBpZiAoc3Jjby0+YnMpIHsKICAgICAgICAgYmRydl93YWtl
dXAoc3Jjby0+YnMpOwogICAgIH0KZGlmZiAtLWdpdCBhL2Jsb2NrL3Rocm90dGxlLWdyb3Vwcy5j
IGIvYmxvY2svdGhyb3R0bGUtZ3JvdXBzLmMKaW5kZXggNGUyODM2NWQ4ZC4uOGQ4NGQ3Y2Y2MSAx
MDA2NDQKLS0tIGEvYmxvY2svdGhyb3R0bGUtZ3JvdXBzLmMKKysrIGIvYmxvY2svdGhyb3R0bGUt
Z3JvdXBzLmMKQEAgLTIyOCw3ICsyMjgsNyBAQCBzdGF0aWMgVGhyb3R0bGVHcm91cE1lbWJlciAq
bmV4dF90aHJvdHRsZV90b2tlbihUaHJvdHRsZUdyb3VwTWVtYmVyICp0Z20sCiAgICAgICogaW1t
ZWRpYXRlbHkgaWYgaXQgaGFzIHBlbmRpbmcgcmVxdWVzdHMuIE90aGVyd2lzZSB3ZSBjb3VsZCBi
ZQogICAgICAqIGZvcmNpbmcgaXQgdG8gd2FpdCBmb3Igb3RoZXIgbWVtYmVyJ3MgdGhyb3R0bGVk
IHJlcXVlc3RzLiAqLwogICAgIGlmICh0Z21faGFzX3BlbmRpbmdfcmVxcyh0Z20sIGlzX3dyaXRl
KSAmJgotICAgICAgICBhdG9taWNfcmVhZCgmdGdtLT5pb19saW1pdHNfZGlzYWJsZWQpKSB7Cisg
ICAgICAgIHFlbXVfYXRvbWljX3JlYWQoJnRnbS0+aW9fbGltaXRzX2Rpc2FibGVkKSkgewogICAg
ICAgICByZXR1cm4gdGdtOwogICAgIH0KIApAQCAtMjcyLDcgKzI3Miw3IEBAIHN0YXRpYyBib29s
IHRocm90dGxlX2dyb3VwX3NjaGVkdWxlX3RpbWVyKFRocm90dGxlR3JvdXBNZW1iZXIgKnRnbSwK
ICAgICBUaHJvdHRsZVRpbWVycyAqdHQgPSAmdGdtLT50aHJvdHRsZV90aW1lcnM7CiAgICAgYm9v
bCBtdXN0X3dhaXQ7CiAKLSAgICBpZiAoYXRvbWljX3JlYWQoJnRnbS0+aW9fbGltaXRzX2Rpc2Fi
bGVkKSkgeworICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZ0Z20tPmlvX2xpbWl0c19kaXNhYmxl
ZCkpIHsKICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KIApAQCAtNDE3LDcgKzQxNyw3IEBA
IHN0YXRpYyB2b2lkIGNvcm91dGluZV9mbiB0aHJvdHRsZV9ncm91cF9yZXN0YXJ0X3F1ZXVlX2Vu
dHJ5KHZvaWQgKm9wYXF1ZSkKIAogICAgIGdfZnJlZShkYXRhKTsKIAotICAgIGF0b21pY19kZWMo
JnRnbS0+cmVzdGFydF9wZW5kaW5nKTsKKyAgICBxZW11X2F0b21pY19kZWMoJnRnbS0+cmVzdGFy
dF9wZW5kaW5nKTsKICAgICBhaW9fd2FpdF9raWNrKCk7CiB9CiAKQEAgLTQzNCw3ICs0MzQsNyBA
QCBzdGF0aWMgdm9pZCB0aHJvdHRsZV9ncm91cF9yZXN0YXJ0X3F1ZXVlKFRocm90dGxlR3JvdXBN
ZW1iZXIgKnRnbSwgYm9vbCBpc193cml0ZQogICAgICAqIGJlIG5vIHRpbWVyIHBlbmRpbmcgb24g
dGhpcyB0Z20gYXQgdGhpcyBwb2ludCAqLwogICAgIGFzc2VydCghdGltZXJfcGVuZGluZyh0Z20t
PnRocm90dGxlX3RpbWVycy50aW1lcnNbaXNfd3JpdGVdKSk7CiAKLSAgICBhdG9taWNfaW5jKCZ0
Z20tPnJlc3RhcnRfcGVuZGluZyk7CisgICAgcWVtdV9hdG9taWNfaW5jKCZ0Z20tPnJlc3RhcnRf
cGVuZGluZyk7CiAKICAgICBjbyA9IHFlbXVfY29yb3V0aW5lX2NyZWF0ZSh0aHJvdHRsZV9ncm91
cF9yZXN0YXJ0X3F1ZXVlX2VudHJ5LCByZCk7CiAgICAgYWlvX2NvX2VudGVyKHRnbS0+YWlvX2Nv
bnRleHQsIGNvKTsKQEAgLTU0NCw3ICs1NDQsNyBAQCB2b2lkIHRocm90dGxlX2dyb3VwX3JlZ2lz
dGVyX3RnbShUaHJvdHRsZUdyb3VwTWVtYmVyICp0Z20sCiAKICAgICB0Z20tPnRocm90dGxlX3N0
YXRlID0gdHM7CiAgICAgdGdtLT5haW9fY29udGV4dCA9IGN0eDsKLSAgICBhdG9taWNfc2V0KCZ0
Z20tPnJlc3RhcnRfcGVuZGluZywgMCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZ0Z20tPnJlc3Rh
cnRfcGVuZGluZywgMCk7CiAKICAgICBxZW11X211dGV4X2xvY2soJnRnLT5sb2NrKTsKICAgICAv
KiBJZiB0aGUgVGhyb3R0bGVHcm91cCBpcyBuZXcgc2V0IHRoaXMgVGhyb3R0bGVHcm91cE1lbWJl
ciBhcyB0aGUgdG9rZW4gKi8KQEAgLTU5Miw3ICs1OTIsOCBAQCB2b2lkIHRocm90dGxlX2dyb3Vw
X3VucmVnaXN0ZXJfdGdtKFRocm90dGxlR3JvdXBNZW1iZXIgKnRnbSkKICAgICB9CiAKICAgICAv
KiBXYWl0IGZvciB0aHJvdHRsZV9ncm91cF9yZXN0YXJ0X3F1ZXVlX2VudHJ5KCkgY29yb3V0aW5l
cyB0byBmaW5pc2ggKi8KLSAgICBBSU9fV0FJVF9XSElMRSh0Z20tPmFpb19jb250ZXh0LCBhdG9t
aWNfcmVhZCgmdGdtLT5yZXN0YXJ0X3BlbmRpbmcpID4gMCk7CisgICAgQUlPX1dBSVRfV0hJTEUo
dGdtLT5haW9fY29udGV4dCwKKyAgICAgICAgICAgICAgICAgICBxZW11X2F0b21pY19yZWFkKCZ0
Z20tPnJlc3RhcnRfcGVuZGluZykgPiAwKTsKIAogICAgIHFlbXVfbXV0ZXhfbG9jaygmdGctPmxv
Y2spOwogICAgIGZvciAoaSA9IDA7IGkgPCAyOyBpKyspIHsKZGlmZiAtLWdpdCBhL2Jsb2NrL3Ro
cm90dGxlLmMgYi9ibG9jay90aHJvdHRsZS5jCmluZGV4IDlhMGYzODE0OWEuLjg3OWNkZTY1ZDcg
MTAwNjQ0Ci0tLSBhL2Jsb2NrL3Rocm90dGxlLmMKKysrIGIvYmxvY2svdGhyb3R0bGUuYwpAQCAt
MjE3LDcgKzIxNyw3IEBAIHN0YXRpYyB2b2lkIHRocm90dGxlX3Jlb3Blbl9hYm9ydChCRFJWUmVv
cGVuU3RhdGUgKnJlb3Blbl9zdGF0ZSkKIHN0YXRpYyB2b2lkIGNvcm91dGluZV9mbiB0aHJvdHRs
ZV9jb19kcmFpbl9iZWdpbihCbG9ja0RyaXZlclN0YXRlICpicykKIHsKICAgICBUaHJvdHRsZUdy
b3VwTWVtYmVyICp0Z20gPSBicy0+b3BhcXVlOwotICAgIGlmIChhdG9taWNfZmV0Y2hfaW5jKCZ0
Z20tPmlvX2xpbWl0c19kaXNhYmxlZCkgPT0gMCkgeworICAgIGlmIChxZW11X2F0b21pY19mZXRj
aF9pbmMoJnRnbS0+aW9fbGltaXRzX2Rpc2FibGVkKSA9PSAwKSB7CiAgICAgICAgIHRocm90dGxl
X2dyb3VwX3Jlc3RhcnRfdGdtKHRnbSk7CiAgICAgfQogfQpAQCAtMjI2LDcgKzIyNiw3IEBAIHN0
YXRpYyB2b2lkIGNvcm91dGluZV9mbiB0aHJvdHRsZV9jb19kcmFpbl9lbmQoQmxvY2tEcml2ZXJT
dGF0ZSAqYnMpCiB7CiAgICAgVGhyb3R0bGVHcm91cE1lbWJlciAqdGdtID0gYnMtPm9wYXF1ZTsK
ICAgICBhc3NlcnQodGdtLT5pb19saW1pdHNfZGlzYWJsZWQpOwotICAgIGF0b21pY19kZWMoJnRn
bS0+aW9fbGltaXRzX2Rpc2FibGVkKTsKKyAgICBxZW11X2F0b21pY19kZWMoJnRnbS0+aW9fbGlt
aXRzX2Rpc2FibGVkKTsKIH0KIAogc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHRocm90dGxlX3N0
cm9uZ19ydW50aW1lX29wdHNbXSA9IHsKZGlmZiAtLWdpdCBhL2Jsb2NrZGV2LmMgYi9ibG9ja2Rl
di5jCmluZGV4IDdmMjU2MTA4MWUuLjZjNzJhYzQ2ZjQgMTAwNjQ0Ci0tLSBhL2Jsb2NrZGV2LmMK
KysrIGIvYmxvY2tkZXYuYwpAQCAtMTYwNCw3ICsxNjA0LDcgQEAgc3RhdGljIHZvaWQgZXh0ZXJu
YWxfc25hcHNob3RfY29tbWl0KEJsa0FjdGlvblN0YXRlICpjb21tb24pCiAgICAgLyogV2UgZG9u
J3QgbmVlZCAob3Igd2FudCkgdG8gdXNlIHRoZSB0cmFuc2FjdGlvbmFsCiAgICAgICogYmRydl9y
ZW9wZW5fbXVsdGlwbGUoKSBhY3Jvc3MgYWxsIHRoZSBlbnRyaWVzIGF0IG9uY2UsIGJlY2F1c2Ug
d2UKICAgICAgKiBkb24ndCB3YW50IHRvIGFib3J0IGFsbCBvZiB0aGVtIGlmIG9uZSBvZiB0aGVt
IGZhaWxzIHRoZSByZW9wZW4gKi8KLSAgICBpZiAoIWF0b21pY19yZWFkKCZzdGF0ZS0+b2xkX2Jz
LT5jb3B5X29uX3JlYWQpKSB7CisgICAgaWYgKCFxZW11X2F0b21pY19yZWFkKCZzdGF0ZS0+b2xk
X2JzLT5jb3B5X29uX3JlYWQpKSB7CiAgICAgICAgIGJkcnZfcmVvcGVuX3NldF9yZWFkX29ubHko
c3RhdGUtPm9sZF9icywgdHJ1ZSwgTlVMTCk7CiAgICAgfQogCmRpZmYgLS1naXQgYS9ibG9ja2pv
Yi5jIGIvYmxvY2tqb2IuYwppbmRleCA0NzBmYWNmZDQ3Li5lMjFlMmNlNzdjIDEwMDY0NAotLS0g
YS9ibG9ja2pvYi5jCisrKyBiL2Jsb2Nram9iLmMKQEAgLTI5OCw3ICsyOTgsNyBAQCBCbG9ja0pv
YkluZm8gKmJsb2NrX2pvYl9xdWVyeShCbG9ja0pvYiAqam9iLCBFcnJvciAqKmVycnApCiAgICAg
aW5mbyA9IGdfbmV3MChCbG9ja0pvYkluZm8sIDEpOwogICAgIGluZm8tPnR5cGUgICAgICA9IGdf
c3RyZHVwKGpvYl90eXBlX3N0cigmam9iLT5qb2IpKTsKICAgICBpbmZvLT5kZXZpY2UgICAgPSBn
X3N0cmR1cChqb2ItPmpvYi5pZCk7Ci0gICAgaW5mby0+YnVzeSAgICAgID0gYXRvbWljX3JlYWQo
JmpvYi0+am9iLmJ1c3kpOworICAgIGluZm8tPmJ1c3kgICAgICA9IHFlbXVfYXRvbWljX3JlYWQo
JmpvYi0+am9iLmJ1c3kpOwogICAgIGluZm8tPnBhdXNlZCAgICA9IGpvYi0+am9iLnBhdXNlX2Nv
dW50ID4gMDsKICAgICBpbmZvLT5vZmZzZXQgICAgPSBqb2ItPmpvYi5wcm9ncmVzcy5jdXJyZW50
OwogICAgIGluZm8tPmxlbiAgICAgICA9IGpvYi0+am9iLnByb2dyZXNzLnRvdGFsOwpkaWZmIC0t
Z2l0IGEvY29udHJpYi9saWJ2aG9zdC11c2VyL2xpYnZob3N0LXVzZXIuYyBiL2NvbnRyaWIvbGli
dmhvc3QtdXNlci9saWJ2aG9zdC11c2VyLmMKaW5kZXggNTNmMTZiZGYwOC4uOGQ5NjIzYmNiYyAx
MDA2NDQKLS0tIGEvY29udHJpYi9saWJ2aG9zdC11c2VyL2xpYnZob3N0LXVzZXIuYworKysgYi9j
b250cmliL2xpYnZob3N0LXVzZXIvbGlidmhvc3QtdXNlci5jCkBAIC00NDgsNyArNDQ4LDcgQEAg
c3RhdGljIHZvaWQKIHZ1X2xvZ19wYWdlKHVpbnQ4X3QgKmxvZ190YWJsZSwgdWludDY0X3QgcGFn
ZSkKIHsKICAgICBEUFJJTlQoIkxvZ2dlZCBkaXJ0eSBndWVzdCBwYWdlOiAlIlBSSWQ2NCJcbiIs
IHBhZ2UpOwotICAgIGF0b21pY19vcigmbG9nX3RhYmxlW3BhZ2UgLyA4XSwgMSA8PCAocGFnZSAl
IDgpKTsKKyAgICBxZW11X2F0b21pY19vcigmbG9nX3RhYmxlW3BhZ2UgLyA4XSwgMSA8PCAocGFn
ZSAlIDgpKTsKIH0KIAogc3RhdGljIHZvaWQKZGlmZiAtLWdpdCBhL2NwdXMtY29tbW9uLmMgYi9j
cHVzLWNvbW1vbi5jCmluZGV4IDM0MDQ0ZjRlNGMuLjZhNmI4MmRlNTIgMTAwNjQ0Ci0tLSBhL2Nw
dXMtY29tbW9uLmMKKysrIGIvY3B1cy1jb21tb24uYwpAQCAtMTQ4LDcgKzE0OCw3IEBAIHZvaWQg
ZG9fcnVuX29uX2NwdShDUFVTdGF0ZSAqY3B1LCBydW5fb25fY3B1X2Z1bmMgZnVuYywgcnVuX29u
X2NwdV9kYXRhIGRhdGEsCiAgICAgd2kuZXhjbHVzaXZlID0gZmFsc2U7CiAKICAgICBxdWV1ZV93
b3JrX29uX2NwdShjcHUsICZ3aSk7Ci0gICAgd2hpbGUgKCFhdG9taWNfbWJfcmVhZCgmd2kuZG9u
ZSkpIHsKKyAgICB3aGlsZSAoIXFlbXVfYXRvbWljX21iX3JlYWQoJndpLmRvbmUpKSB7CiAgICAg
ICAgIENQVVN0YXRlICpzZWxmX2NwdSA9IGN1cnJlbnRfY3B1OwogCiAgICAgICAgIHFlbXVfY29u
ZF93YWl0KCZxZW11X3dvcmtfY29uZCwgbXV0ZXgpOwpAQCAtMTg4LDIwICsxODgsMjAgQEAgdm9p
ZCBzdGFydF9leGNsdXNpdmUodm9pZCkKICAgICBleGNsdXNpdmVfaWRsZSgpOwogCiAgICAgLyog
TWFrZSBhbGwgb3RoZXIgY3B1cyBzdG9wIGV4ZWN1dGluZy4gICovCi0gICAgYXRvbWljX3NldCgm
cGVuZGluZ19jcHVzLCAxKTsKKyAgICBxZW11X2F0b21pY19zZXQoJnBlbmRpbmdfY3B1cywgMSk7
CiAKICAgICAvKiBXcml0ZSBwZW5kaW5nX2NwdXMgYmVmb3JlIHJlYWRpbmcgb3RoZXJfY3B1LT5y
dW5uaW5nLiAgKi8KICAgICBzbXBfbWIoKTsKICAgICBydW5uaW5nX2NwdXMgPSAwOwogICAgIENQ
VV9GT1JFQUNIKG90aGVyX2NwdSkgewotICAgICAgICBpZiAoYXRvbWljX3JlYWQoJm90aGVyX2Nw
dS0+cnVubmluZykpIHsKKyAgICAgICAgaWYgKHFlbXVfYXRvbWljX3JlYWQoJm90aGVyX2NwdS0+
cnVubmluZykpIHsKICAgICAgICAgICAgIG90aGVyX2NwdS0+aGFzX3dhaXRlciA9IHRydWU7CiAg
ICAgICAgICAgICBydW5uaW5nX2NwdXMrKzsKICAgICAgICAgICAgIHFlbXVfY3B1X2tpY2sob3Ro
ZXJfY3B1KTsKICAgICAgICAgfQogICAgIH0KIAotICAgIGF0b21pY19zZXQoJnBlbmRpbmdfY3B1
cywgcnVubmluZ19jcHVzICsgMSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZwZW5kaW5nX2NwdXMs
IHJ1bm5pbmdfY3B1cyArIDEpOwogICAgIHdoaWxlIChwZW5kaW5nX2NwdXMgPiAxKSB7CiAgICAg
ICAgIHFlbXVfY29uZF93YWl0KCZleGNsdXNpdmVfY29uZCwgJnFlbXVfY3B1X2xpc3RfbG9jayk7
CiAgICAgfQpAQCAtMjIwLDcgKzIyMCw3IEBAIHZvaWQgZW5kX2V4Y2x1c2l2ZSh2b2lkKQogICAg
IGN1cnJlbnRfY3B1LT5pbl9leGNsdXNpdmVfY29udGV4dCA9IGZhbHNlOwogCiAgICAgcWVtdV9t
dXRleF9sb2NrKCZxZW11X2NwdV9saXN0X2xvY2spOwotICAgIGF0b21pY19zZXQoJnBlbmRpbmdf
Y3B1cywgMCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZwZW5kaW5nX2NwdXMsIDApOwogICAgIHFl
bXVfY29uZF9icm9hZGNhc3QoJmV4Y2x1c2l2ZV9yZXN1bWUpOwogICAgIHFlbXVfbXV0ZXhfdW5s
b2NrKCZxZW11X2NwdV9saXN0X2xvY2spOwogfQpAQCAtMjI4LDcgKzIyOCw3IEBAIHZvaWQgZW5k
X2V4Y2x1c2l2ZSh2b2lkKQogLyogV2FpdCBmb3IgZXhjbHVzaXZlIG9wcyB0byBmaW5pc2gsIGFu
ZCBiZWdpbiBjcHUgZXhlY3V0aW9uLiAgKi8KIHZvaWQgY3B1X2V4ZWNfc3RhcnQoQ1BVU3RhdGUg
KmNwdSkKIHsKLSAgICBhdG9taWNfc2V0KCZjcHUtPnJ1bm5pbmcsIHRydWUpOworICAgIHFlbXVf
YXRvbWljX3NldCgmY3B1LT5ydW5uaW5nLCB0cnVlKTsKIAogICAgIC8qIFdyaXRlIGNwdS0+cnVu
bmluZyBiZWZvcmUgcmVhZGluZyBwZW5kaW5nX2NwdXMuICAqLwogICAgIHNtcF9tYigpOwpAQCAt
MjQ2LDE3ICsyNDYsMTcgQEAgdm9pZCBjcHVfZXhlY19zdGFydChDUFVTdGF0ZSAqY3B1KQogICAg
ICAqIDMuIHBlbmRpbmdfY3B1cyA9PSAwLiAgVGhlbiBzdGFydF9leGNsdXNpdmUgaXMgZGVmaW5p
dGVseSBnb2luZyB0bwogICAgICAqIHNlZSBjcHUtPnJ1bm5pbmcgPT0gdHJ1ZSwgYW5kIGl0IHdp
bGwga2ljayB0aGUgQ1BVLgogICAgICAqLwotICAgIGlmICh1bmxpa2VseShhdG9taWNfcmVhZCgm
cGVuZGluZ19jcHVzKSkpIHsKKyAgICBpZiAodW5saWtlbHkocWVtdV9hdG9taWNfcmVhZCgmcGVu
ZGluZ19jcHVzKSkpIHsKICAgICAgICAgUUVNVV9MT0NLX0dVQVJEKCZxZW11X2NwdV9saXN0X2xv
Y2spOwogICAgICAgICBpZiAoIWNwdS0+aGFzX3dhaXRlcikgewogICAgICAgICAgICAgLyogTm90
IGNvdW50ZWQgaW4gcGVuZGluZ19jcHVzLCBsZXQgdGhlIGV4Y2x1c2l2ZSBpdGVtCiAgICAgICAg
ICAgICAgKiBydW4uICBTaW5jZSB3ZSBoYXZlIHRoZSBsb2NrLCBqdXN0IHNldCBjcHUtPnJ1bm5p
bmcgdG8gdHJ1ZQogICAgICAgICAgICAgICogd2hpbGUgaG9sZGluZyBpdDsgbm8gbmVlZCB0byBj
aGVjayBwZW5kaW5nX2NwdXMgYWdhaW4uCiAgICAgICAgICAgICAgKi8KLSAgICAgICAgICAgIGF0
b21pY19zZXQoJmNwdS0+cnVubmluZywgZmFsc2UpOworICAgICAgICAgICAgcWVtdV9hdG9taWNf
c2V0KCZjcHUtPnJ1bm5pbmcsIGZhbHNlKTsKICAgICAgICAgICAgIGV4Y2x1c2l2ZV9pZGxlKCk7
CiAgICAgICAgICAgICAvKiBOb3cgcGVuZGluZ19jcHVzIGlzIHplcm8uICAqLwotICAgICAgICAg
ICAgYXRvbWljX3NldCgmY3B1LT5ydW5uaW5nLCB0cnVlKTsKKyAgICAgICAgICAgIHFlbXVfYXRv
bWljX3NldCgmY3B1LT5ydW5uaW5nLCB0cnVlKTsKICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg
ICAgIC8qIENvdW50ZWQgaW4gcGVuZGluZ19jcHVzLCBnbyBhaGVhZCBhbmQgcmVsZWFzZSB0aGUK
ICAgICAgICAgICAgICAqIHdhaXRlciBhdCBjcHVfZXhlY19lbmQuCkBAIC0yNjgsNyArMjY4LDcg
QEAgdm9pZCBjcHVfZXhlY19zdGFydChDUFVTdGF0ZSAqY3B1KQogLyogTWFyayBjcHUgYXMgbm90
IGV4ZWN1dGluZywgYW5kIHJlbGVhc2UgcGVuZGluZyBleGNsdXNpdmUgb3BzLiAgKi8KIHZvaWQg
Y3B1X2V4ZWNfZW5kKENQVVN0YXRlICpjcHUpCiB7Ci0gICAgYXRvbWljX3NldCgmY3B1LT5ydW5u
aW5nLCBmYWxzZSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZjcHUtPnJ1bm5pbmcsIGZhbHNlKTsK
IAogICAgIC8qIFdyaXRlIGNwdS0+cnVubmluZyBiZWZvcmUgcmVhZGluZyBwZW5kaW5nX2NwdXMu
ICAqLwogICAgIHNtcF9tYigpOwpAQCAtMjg4LDExICsyODgsMTEgQEAgdm9pZCBjcHVfZXhlY19l
bmQoQ1BVU3RhdGUgKmNwdSkKICAgICAgKiBzZWUgY3B1LT5ydW5uaW5nID09IGZhbHNlLCBhbmQg
aXQgY2FuIGlnbm9yZSB0aGlzIENQVSB1bnRpbCB0aGUKICAgICAgKiBuZXh0IGNwdV9leGVjX3N0
YXJ0LgogICAgICAqLwotICAgIGlmICh1bmxpa2VseShhdG9taWNfcmVhZCgmcGVuZGluZ19jcHVz
KSkpIHsKKyAgICBpZiAodW5saWtlbHkocWVtdV9hdG9taWNfcmVhZCgmcGVuZGluZ19jcHVzKSkp
IHsKICAgICAgICAgUUVNVV9MT0NLX0dVQVJEKCZxZW11X2NwdV9saXN0X2xvY2spOwogICAgICAg
ICBpZiAoY3B1LT5oYXNfd2FpdGVyKSB7CiAgICAgICAgICAgICBjcHUtPmhhc193YWl0ZXIgPSBm
YWxzZTsKLSAgICAgICAgICAgIGF0b21pY19zZXQoJnBlbmRpbmdfY3B1cywgcGVuZGluZ19jcHVz
IC0gMSk7CisgICAgICAgICAgICBxZW11X2F0b21pY19zZXQoJnBlbmRpbmdfY3B1cywgcGVuZGlu
Z19jcHVzIC0gMSk7CiAgICAgICAgICAgICBpZiAocGVuZGluZ19jcHVzID09IDEpIHsKICAgICAg
ICAgICAgICAgICBxZW11X2NvbmRfc2lnbmFsKCZleGNsdXNpdmVfY29uZCk7CiAgICAgICAgICAg
ICB9CkBAIC0zNDYsNyArMzQ2LDcgQEAgdm9pZCBwcm9jZXNzX3F1ZXVlZF9jcHVfd29yayhDUFVT
dGF0ZSAqY3B1KQogICAgICAgICBpZiAod2ktPmZyZWUpIHsKICAgICAgICAgICAgIGdfZnJlZSh3
aSk7CiAgICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICBhdG9taWNfbWJfc2V0KCZ3aS0+ZG9u
ZSwgdHJ1ZSk7CisgICAgICAgICAgICBxZW11X2F0b21pY19tYl9zZXQoJndpLT5kb25lLCB0cnVl
KTsKICAgICAgICAgfQogICAgIH0KICAgICBxZW11X211dGV4X3VubG9jaygmY3B1LT53b3JrX211
dGV4KTsKZGlmZiAtLWdpdCBhL2R1bXAvZHVtcC5jIGIvZHVtcC9kdW1wLmMKaW5kZXggMTNmZGE0
NDBhNC4uMWIyZmJiNjQ0MiAxMDA2NDQKLS0tIGEvZHVtcC9kdW1wLmMKKysrIGIvZHVtcC9kdW1w
LmMKQEAgLTE1NzIsNyArMTU3Miw3IEBAIHN0YXRpYyB2b2lkIGR1bXBfc3RhdGVfcHJlcGFyZShE
dW1wU3RhdGUgKnMpCiBib29sIGR1bXBfaW5fcHJvZ3Jlc3Modm9pZCkKIHsKICAgICBEdW1wU3Rh
dGUgKnN0YXRlID0gJmR1bXBfc3RhdGVfZ2xvYmFsOwotICAgIHJldHVybiAoYXRvbWljX3JlYWQo
JnN0YXRlLT5zdGF0dXMpID09IERVTVBfU1RBVFVTX0FDVElWRSk7CisgICAgcmV0dXJuIChxZW11
X2F0b21pY19yZWFkKCZzdGF0ZS0+c3RhdHVzKSA9PSBEVU1QX1NUQVRVU19BQ1RJVkUpOwogfQog
CiAvKiBjYWxjdWxhdGUgdG90YWwgc2l6ZSBvZiBtZW1vcnkgdG8gYmUgZHVtcGVkICh0YWtpbmcg
ZmlsdGVyIGludG8KQEAgLTE4ODIsNyArMTg4Miw3IEBAIHN0YXRpYyB2b2lkIGR1bXBfcHJvY2Vz
cyhEdW1wU3RhdGUgKnMsIEVycm9yICoqZXJycCkKIAogICAgIC8qIG1ha2Ugc3VyZSBzdGF0dXMg
aXMgd3JpdHRlbiBhZnRlciB3cml0dGVuX3NpemUgdXBkYXRlcyAqLwogICAgIHNtcF93bWIoKTsK
LSAgICBhdG9taWNfc2V0KCZzLT5zdGF0dXMsCisgICAgcWVtdV9hdG9taWNfc2V0KCZzLT5zdGF0
dXMsCiAgICAgICAgICAgICAgICAobG9jYWxfZXJyID8gRFVNUF9TVEFUVVNfRkFJTEVEIDogRFVN
UF9TVEFUVVNfQ09NUExFVEVEKSk7CiAKICAgICAvKiBzZW5kIERVTVBfQ09NUExFVEVEIG1lc3Nh
Z2UgKHVuY29uZGl0aW9uYWxseSkgKi8KQEAgLTE5MDgsNyArMTkwOCw3IEBAIER1bXBRdWVyeVJl
c3VsdCAqcW1wX3F1ZXJ5X2R1bXAoRXJyb3IgKiplcnJwKQogewogICAgIER1bXBRdWVyeVJlc3Vs
dCAqcmVzdWx0ID0gZ19uZXcoRHVtcFF1ZXJ5UmVzdWx0LCAxKTsKICAgICBEdW1wU3RhdGUgKnN0
YXRlID0gJmR1bXBfc3RhdGVfZ2xvYmFsOwotICAgIHJlc3VsdC0+c3RhdHVzID0gYXRvbWljX3Jl
YWQoJnN0YXRlLT5zdGF0dXMpOworICAgIHJlc3VsdC0+c3RhdHVzID0gcWVtdV9hdG9taWNfcmVh
ZCgmc3RhdGUtPnN0YXR1cyk7CiAgICAgLyogbWFrZSBzdXJlIHdlIGFyZSByZWFkaW5nIHN0YXR1
cyBhbmQgd3JpdHRlbl9zaXplIGluIG9yZGVyICovCiAgICAgc21wX3JtYigpOwogICAgIHJlc3Vs
dC0+Y29tcGxldGVkID0gc3RhdGUtPndyaXR0ZW5fc2l6ZTsKQEAgLTIwMTMsNyArMjAxMyw3IEBA
IHZvaWQgcW1wX2R1bXBfZ3Vlc3RfbWVtb3J5KGJvb2wgcGFnaW5nLCBjb25zdCBjaGFyICpmaWxl
LAogICAgICAgICAgICAgICBiZWdpbiwgbGVuZ3RoLCAmbG9jYWxfZXJyKTsKICAgICBpZiAobG9j
YWxfZXJyKSB7CiAgICAgICAgIGVycm9yX3Byb3BhZ2F0ZShlcnJwLCBsb2NhbF9lcnIpOwotICAg
ICAgICBhdG9taWNfc2V0KCZzLT5zdGF0dXMsIERVTVBfU1RBVFVTX0ZBSUxFRCk7CisgICAgICAg
IHFlbXVfYXRvbWljX3NldCgmcy0+c3RhdHVzLCBEVU1QX1NUQVRVU19GQUlMRUQpOwogICAgICAg
ICByZXR1cm47CiAgICAgfQogCmRpZmYgLS1naXQgYS9leGVjLmMgYi9leGVjLmMKaW5kZXggZTM0
YjYwMmJkZi4uMjM2ZTllY2ExYSAxMDA2NDQKLS0tIGEvZXhlYy5jCisrKyBiL2V4ZWMuYwpAQCAt
MzUzLDEzICszNTMsMTMgQEAgc3RhdGljIE1lbW9yeVJlZ2lvblNlY3Rpb24gKmFkZHJlc3Nfc3Bh
Y2VfbG9va3VwX3JlZ2lvbihBZGRyZXNzU3BhY2VEaXNwYXRjaCAqZCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHdhZGRyIGFkZHIsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJv
b2wgcmVzb2x2ZV9zdWJwYWdlKQogewotICAgIE1lbW9yeVJlZ2lvblNlY3Rpb24gKnNlY3Rpb24g
PSBhdG9taWNfcmVhZCgmZC0+bXJ1X3NlY3Rpb24pOworICAgIE1lbW9yeVJlZ2lvblNlY3Rpb24g
KnNlY3Rpb24gPSBxZW11X2F0b21pY19yZWFkKCZkLT5tcnVfc2VjdGlvbik7CiAgICAgc3VicGFn
ZV90ICpzdWJwYWdlOwogCiAgICAgaWYgKCFzZWN0aW9uIHx8IHNlY3Rpb24gPT0gJmQtPm1hcC5z
ZWN0aW9uc1tQSFlTX1NFQ1RJT05fVU5BU1NJR05FRF0gfHwKICAgICAgICAgIXNlY3Rpb25fY292
ZXJzX2FkZHIoc2VjdGlvbiwgYWRkcikpIHsKICAgICAgICAgc2VjdGlvbiA9IHBoeXNfcGFnZV9m
aW5kKGQsIGFkZHIpOwotICAgICAgICBhdG9taWNfc2V0KCZkLT5tcnVfc2VjdGlvbiwgc2VjdGlv
bik7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmZC0+bXJ1X3NlY3Rpb24sIHNlY3Rpb24pOwog
ICAgIH0KICAgICBpZiAocmVzb2x2ZV9zdWJwYWdlICYmIHNlY3Rpb24tPm1yLT5zdWJwYWdlKSB7
CiAgICAgICAgIHN1YnBhZ2UgPSBjb250YWluZXJfb2Yoc2VjdGlvbi0+bXIsIHN1YnBhZ2VfdCwg
aW9tZW0pOwpAQCAtNjk1LDcgKzY5NSw4IEBAIGFkZHJlc3Nfc3BhY2VfdHJhbnNsYXRlX2Zvcl9p
b3RsYihDUFVTdGF0ZSAqY3B1LCBpbnQgYXNpZHgsIGh3YWRkciBhZGRyLAogICAgIElPTU1VTWVt
b3J5UmVnaW9uQ2xhc3MgKmltcmM7CiAgICAgSU9NTVVUTEJFbnRyeSBpb3RsYjsKICAgICBpbnQg
aW9tbXVfaWR4OwotICAgIEFkZHJlc3NTcGFjZURpc3BhdGNoICpkID0gYXRvbWljX3JjdV9yZWFk
KCZjcHUtPmNwdV9hc2VzW2FzaWR4XS5tZW1vcnlfZGlzcGF0Y2gpOworICAgIEFkZHJlc3NTcGFj
ZURpc3BhdGNoICpkID0KKyAgICAgICAgcWVtdV9hdG9taWNfcmN1X3JlYWQoJmNwdS0+Y3B1X2Fz
ZXNbYXNpZHhdLm1lbW9yeV9kaXNwYXRjaCk7CiAKICAgICBmb3IgKDs7KSB7CiAgICAgICAgIHNl
Y3Rpb24gPSBhZGRyZXNzX3NwYWNlX3RyYW5zbGF0ZV9pbnRlcm5hbChkLCBhZGRyLCAmYWRkciwg
cGxlbiwgZmFsc2UpOwpAQCAtMTI0Nyw3ICsxMjQ4LDcgQEAgc3RhdGljIFJBTUJsb2NrICpxZW11
X2dldF9yYW1fYmxvY2socmFtX2FkZHJfdCBhZGRyKQogewogICAgIFJBTUJsb2NrICpibG9jazsK
IAotICAgIGJsb2NrID0gYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5tcnVfYmxvY2spOworICAg
IGJsb2NrID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0Lm1ydV9ibG9jayk7CiAgICAg
aWYgKGJsb2NrICYmIGFkZHIgLSBibG9jay0+b2Zmc2V0IDwgYmxvY2stPm1heF9sZW5ndGgpIHsK
ICAgICAgICAgcmV0dXJuIGJsb2NrOwogICAgIH0KQEAgLTEyNzMsNyArMTI3NCw3IEBAIGZvdW5k
OgogICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxfcmN1
KHJlY2xhaW1fcmFtYmxvY2ssIHh4eCk7CiAgICAgICogICAgICAgICAgICAgICAgICByY3VfcmVh
ZF91bmxvY2soKQogICAgICAqCi0gICAgICogYXRvbWljX3JjdV9zZXQgaXMgbm90IG5lZWRlZCBo
ZXJlLiAgVGhlIGJsb2NrIHdhcyBhbHJlYWR5IHB1Ymxpc2hlZAorICAgICAqIHFlbXVfYXRvbWlj
X3JjdV9zZXQgaXMgbm90IG5lZWRlZCBoZXJlLiAgVGhlIGJsb2NrIHdhcyBhbHJlYWR5IHB1Ymxp
c2hlZAogICAgICAqIHdoZW4gaXQgd2FzIHBsYWNlZCBpbnRvIHRoZSBsaXN0LiAgSGVyZSB3ZSdy
ZSBqdXN0IG1ha2luZyBhbiBleHRyYQogICAgICAqIGNvcHkgb2YgdGhlIHBvaW50ZXIuCiAgICAg
ICovCkBAIC0xMzIxLDcgKzEzMjIsNyBAQCBib29sIGNwdV9waHlzaWNhbF9tZW1vcnlfdGVzdF9h
bmRfY2xlYXJfZGlydHkocmFtX2FkZHJfdCBzdGFydCwKICAgICBwYWdlID0gc3RhcnRfcGFnZTsK
IAogICAgIFdJVEhfUkNVX1JFQURfTE9DS19HVUFSRCgpIHsKLSAgICAgICAgYmxvY2tzID0gYXRv
bWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbY2xpZW50XSk7CisgICAgICAgIGJs
b2NrcyA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlbY2xpZW50
XSk7CiAgICAgICAgIHJhbWJsb2NrID0gcWVtdV9nZXRfcmFtX2Jsb2NrKHN0YXJ0KTsKICAgICAg
ICAgLyogUmFuZ2Ugc2FuaXR5IGNoZWNrIG9uIHRoZSByYW1ibG9jayAqLwogICAgICAgICBhc3Nl
cnQoc3RhcnQgPj0gcmFtYmxvY2stPm9mZnNldCAmJgpAQCAtMTM3MSw3ICsxMzcyLDcgQEAgRGly
dHlCaXRtYXBTbmFwc2hvdCAqY3B1X3BoeXNpY2FsX21lbW9yeV9zbmFwc2hvdF9hbmRfY2xlYXJf
ZGlydHkKICAgICBkZXN0ID0gMDsKIAogICAgIFdJVEhfUkNVX1JFQURfTE9DS19HVUFSRCgpIHsK
LSAgICAgICAgYmxvY2tzID0gYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5kaXJ0eV9tZW1vcnlb
Y2xpZW50XSk7CisgICAgICAgIGJsb2NrcyA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlz
dC5kaXJ0eV9tZW1vcnlbY2xpZW50XSk7CiAKICAgICAgICAgd2hpbGUgKHBhZ2UgPCBlbmQpIHsK
ICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgaWR4ID0gcGFnZSAvIERJUlRZX01FTU9SWV9CTE9D
S19TSVpFOwpAQCAtMjIwNyw3ICsyMjA4LDcgQEAgc3RhdGljIHZvaWQgZGlydHlfbWVtb3J5X2V4
dGVuZChyYW1fYWRkcl90IG9sZF9yYW1fc2l6ZSwKICAgICAgICAgRGlydHlNZW1vcnlCbG9ja3Mg
Km5ld19ibG9ja3M7CiAgICAgICAgIGludCBqOwogCi0gICAgICAgIG9sZF9ibG9ja3MgPSBhdG9t
aWNfcmN1X3JlYWQoJnJhbV9saXN0LmRpcnR5X21lbW9yeVtpXSk7CisgICAgICAgIG9sZF9ibG9j
a3MgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcmFtX2xpc3QuZGlydHlfbWVtb3J5W2ldKTsKICAg
ICAgICAgbmV3X2Jsb2NrcyA9IGdfbWFsbG9jKHNpemVvZigqbmV3X2Jsb2NrcykgKwogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKG5ld19ibG9ja3MtPmJsb2Nrc1swXSkgKiBu
ZXdfbnVtX2Jsb2Nrcyk7CiAKQEAgLTIyMjAsNyArMjIyMSw3IEBAIHN0YXRpYyB2b2lkIGRpcnR5
X21lbW9yeV9leHRlbmQocmFtX2FkZHJfdCBvbGRfcmFtX3NpemUsCiAgICAgICAgICAgICBuZXdf
YmxvY2tzLT5ibG9ja3Nbal0gPSBiaXRtYXBfbmV3KERJUlRZX01FTU9SWV9CTE9DS19TSVpFKTsK
ICAgICAgICAgfQogCi0gICAgICAgIGF0b21pY19yY3Vfc2V0KCZyYW1fbGlzdC5kaXJ0eV9tZW1v
cnlbaV0sIG5ld19ibG9ja3MpOworICAgICAgICBxZW11X2F0b21pY19yY3Vfc2V0KCZyYW1fbGlz
dC5kaXJ0eV9tZW1vcnlbaV0sIG5ld19ibG9ja3MpOwogCiAgICAgICAgIGlmIChvbGRfYmxvY2tz
KSB7CiAgICAgICAgICAgICBnX2ZyZWVfcmN1KG9sZF9ibG9ja3MsIHJjdSk7CkBAIC0yNjY3LDcg
KzI2NjgsNyBAQCBSQU1CbG9jayAqcWVtdV9yYW1fYmxvY2tfZnJvbV9ob3N0KHZvaWQgKnB0ciwg
Ym9vbCByb3VuZF9vZmZzZXQsCiAgICAgfQogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgpOwot
ICAgIGJsb2NrID0gYXRvbWljX3JjdV9yZWFkKCZyYW1fbGlzdC5tcnVfYmxvY2spOworICAgIGJs
b2NrID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJnJhbV9saXN0Lm1ydV9ibG9jayk7CiAgICAgaWYg
KGJsb2NrICYmIGJsb2NrLT5ob3N0ICYmIGhvc3QgLSBibG9jay0+aG9zdCA8IGJsb2NrLT5tYXhf
bGVuZ3RoKSB7CiAgICAgICAgIGdvdG8gZm91bmQ7CiAgICAgfQpAQCAtMjkxMiw3ICsyOTEzLDcg
QEAgTWVtb3J5UmVnaW9uU2VjdGlvbiAqaW90bGJfdG9fc2VjdGlvbihDUFVTdGF0ZSAqY3B1LAog
ewogICAgIGludCBhc2lkeCA9IGNwdV9hc2lkeF9mcm9tX2F0dHJzKGNwdSwgYXR0cnMpOwogICAg
IENQVUFkZHJlc3NTcGFjZSAqY3B1YXMgPSAmY3B1LT5jcHVfYXNlc1thc2lkeF07Ci0gICAgQWRk
cmVzc1NwYWNlRGlzcGF0Y2ggKmQgPSBhdG9taWNfcmN1X3JlYWQoJmNwdWFzLT5tZW1vcnlfZGlz
cGF0Y2gpOworICAgIEFkZHJlc3NTcGFjZURpc3BhdGNoICpkID0gcWVtdV9hdG9taWNfcmN1X3Jl
YWQoJmNwdWFzLT5tZW1vcnlfZGlzcGF0Y2gpOwogICAgIE1lbW9yeVJlZ2lvblNlY3Rpb24gKnNl
Y3Rpb25zID0gZC0+bWFwLnNlY3Rpb25zOwogCiAgICAgcmV0dXJuICZzZWN0aW9uc1tpbmRleCAm
IH5UQVJHRVRfUEFHRV9NQVNLXTsKQEAgLTI5OTYsNyArMjk5Nyw3IEBAIHN0YXRpYyB2b2lkIHRj
Z19jb21taXQoTWVtb3J5TGlzdGVuZXIgKmxpc3RlbmVyKQogICAgICAqIG1heSBoYXZlIHNwbGl0
IHRoZSBSQ1UgY3JpdGljYWwgc2VjdGlvbi4KICAgICAgKi8KICAgICBkID0gYWRkcmVzc19zcGFj
ZV90b19kaXNwYXRjaChjcHVhcy0+YXMpOwotICAgIGF0b21pY19yY3Vfc2V0KCZjcHVhcy0+bWVt
b3J5X2Rpc3BhdGNoLCBkKTsKKyAgICBxZW11X2F0b21pY19yY3Vfc2V0KCZjcHVhcy0+bWVtb3J5
X2Rpc3BhdGNoLCBkKTsKICAgICB0bGJfZmx1c2goY3B1YXMtPmNwdSk7CiB9CiAKQEAgLTM0NDMs
NyArMzQ0NCw3IEBAIHZvaWQgY3B1X3JlZ2lzdGVyX21hcF9jbGllbnQoUUVNVUJIICpiaCkKICAg
ICBxZW11X211dGV4X2xvY2soJm1hcF9jbGllbnRfbGlzdF9sb2NrKTsKICAgICBjbGllbnQtPmJo
ID0gYmg7CiAgICAgUUxJU1RfSU5TRVJUX0hFQUQoJm1hcF9jbGllbnRfbGlzdCwgY2xpZW50LCBs
aW5rKTsKLSAgICBpZiAoIWF0b21pY19yZWFkKCZib3VuY2UuaW5fdXNlKSkgeworICAgIGlmICgh
cWVtdV9hdG9taWNfcmVhZCgmYm91bmNlLmluX3VzZSkpIHsKICAgICAgICAgY3B1X25vdGlmeV9t
YXBfY2xpZW50c19sb2NrZWQoKTsKICAgICB9CiAgICAgcWVtdV9tdXRleF91bmxvY2soJm1hcF9j
bGllbnRfbGlzdF9sb2NrKTsKQEAgLTM1NzcsNyArMzU3OCw3IEBAIHZvaWQgKmFkZHJlc3Nfc3Bh
Y2VfbWFwKEFkZHJlc3NTcGFjZSAqYXMsCiAgICAgbXIgPSBmbGF0dmlld190cmFuc2xhdGUoZnYs
IGFkZHIsICZ4bGF0LCAmbCwgaXNfd3JpdGUsIGF0dHJzKTsKIAogICAgIGlmICghbWVtb3J5X2Fj
Y2Vzc19pc19kaXJlY3QobXIsIGlzX3dyaXRlKSkgewotICAgICAgICBpZiAoYXRvbWljX3hjaGco
JmJvdW5jZS5pbl91c2UsIHRydWUpKSB7CisgICAgICAgIGlmIChxZW11X2F0b21pY194Y2hnKCZi
b3VuY2UuaW5fdXNlLCB0cnVlKSkgewogICAgICAgICAgICAgKnBsZW4gPSAwOwogICAgICAgICAg
ICAgcmV0dXJuIE5VTEw7CiAgICAgICAgIH0KQEAgLTM2MzYsNyArMzYzNyw3IEBAIHZvaWQgYWRk
cmVzc19zcGFjZV91bm1hcChBZGRyZXNzU3BhY2UgKmFzLCB2b2lkICpidWZmZXIsIGh3YWRkciBs
ZW4sCiAgICAgcWVtdV92ZnJlZShib3VuY2UuYnVmZmVyKTsKICAgICBib3VuY2UuYnVmZmVyID0g
TlVMTDsKICAgICBtZW1vcnlfcmVnaW9uX3VucmVmKGJvdW5jZS5tcik7Ci0gICAgYXRvbWljX21i
X3NldCgmYm91bmNlLmluX3VzZSwgZmFsc2UpOworICAgIHFlbXVfYXRvbWljX21iX3NldCgmYm91
bmNlLmluX3VzZSwgZmFsc2UpOwogICAgIGNwdV9ub3RpZnlfbWFwX2NsaWVudHMoKTsKIH0KIApA
QCAtNDEwNSwxNiArNDEwNiwxNyBAQCBpbnQgcmFtX2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZShib29s
IHN0YXRlKQogICAgIGludCBvbGQ7CiAKICAgICBpZiAoIXN0YXRlKSB7Ci0gICAgICAgIGF0b21p
Y19kZWMoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKTsKKyAgICAgICAgcWVtdV9hdG9taWNf
ZGVjKCZyYW1fYmxvY2tfZGlzY2FyZF9kaXNhYmxlZCk7CiAgICAgICAgIHJldHVybiAwOwogICAg
IH0KIAogICAgIGRvIHsKLSAgICAgICAgb2xkID0gYXRvbWljX3JlYWQoJnJhbV9ibG9ja19kaXNj
YXJkX2Rpc2FibGVkKTsKKyAgICAgICAgb2xkID0gcWVtdV9hdG9taWNfcmVhZCgmcmFtX2Jsb2Nr
X2Rpc2NhcmRfZGlzYWJsZWQpOwogICAgICAgICBpZiAob2xkIDwgMCkgewogICAgICAgICAgICAg
cmV0dXJuIC1FQlVTWTsKICAgICAgICAgfQotICAgIH0gd2hpbGUgKGF0b21pY19jbXB4Y2hnKCZy
YW1fYmxvY2tfZGlzY2FyZF9kaXNhYmxlZCwgb2xkLCBvbGQgKyAxKSAhPSBvbGQpOworICAgIH0g
d2hpbGUgKHFlbXVfYXRvbWljX2NtcHhjaGcoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkLCBvbGQgKyAxKSAhPSBvbGQpOwog
ICAgIHJldHVybiAwOwogfQogCkBAIC00MTIzLDI3ICs0MTI1LDI4IEBAIGludCByYW1fYmxvY2tf
ZGlzY2FyZF9yZXF1aXJlKGJvb2wgc3RhdGUpCiAgICAgaW50IG9sZDsKIAogICAgIGlmICghc3Rh
dGUpIHsKLSAgICAgICAgYXRvbWljX2luYygmcmFtX2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZWQpOwor
ICAgICAgICBxZW11X2F0b21pY19pbmMoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKTsKICAg
ICAgICAgcmV0dXJuIDA7CiAgICAgfQogCiAgICAgZG8gewotICAgICAgICBvbGQgPSBhdG9taWNf
cmVhZCgmcmFtX2Jsb2NrX2Rpc2NhcmRfZGlzYWJsZWQpOworICAgICAgICBvbGQgPSBxZW11X2F0
b21pY19yZWFkKCZyYW1fYmxvY2tfZGlzY2FyZF9kaXNhYmxlZCk7CiAgICAgICAgIGlmIChvbGQg
PiAwKSB7CiAgICAgICAgICAgICByZXR1cm4gLUVCVVNZOwogICAgICAgICB9Ci0gICAgfSB3aGls
ZSAoYXRvbWljX2NtcHhjaGcoJnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkLCBvbGQsIG9sZCAt
IDEpICE9IG9sZCk7CisgICAgfSB3aGlsZSAocWVtdV9hdG9taWNfY21weGNoZygmcmFtX2Jsb2Nr
X2Rpc2NhcmRfZGlzYWJsZWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGQs
IG9sZCAtIDEpICE9IG9sZCk7CiAgICAgcmV0dXJuIDA7CiB9CiAKIGJvb2wgcmFtX2Jsb2NrX2Rp
c2NhcmRfaXNfZGlzYWJsZWQodm9pZCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJnJhbV9i
bG9ja19kaXNjYXJkX2Rpc2FibGVkKSA+IDA7CisgICAgcmV0dXJuIHFlbXVfYXRvbWljX3JlYWQo
JnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKSA+IDA7CiB9CiAKIGJvb2wgcmFtX2Jsb2NrX2Rp
c2NhcmRfaXNfcmVxdWlyZWQodm9pZCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJnJhbV9i
bG9ja19kaXNjYXJkX2Rpc2FibGVkKSA8IDA7CisgICAgcmV0dXJuIHFlbXVfYXRvbWljX3JlYWQo
JnJhbV9ibG9ja19kaXNjYXJkX2Rpc2FibGVkKSA8IDA7CiB9CiAKICNlbmRpZgpkaWZmIC0tZ2l0
IGEvaHcvY29yZS9jcHUuYyBiL2h3L2NvcmUvY3B1LmMKaW5kZXggOGY2NTM4M2ZmYi4uZGRhNDU3
NjRmNSAxMDA2NDQKLS0tIGEvaHcvY29yZS9jcHUuYworKysgYi9ody9jb3JlL2NwdS5jCkBAIC0x
MTEsMTAgKzExMSwxMCBAQCB2b2lkIGNwdV9yZXNldF9pbnRlcnJ1cHQoQ1BVU3RhdGUgKmNwdSwg
aW50IG1hc2spCiAKIHZvaWQgY3B1X2V4aXQoQ1BVU3RhdGUgKmNwdSkKIHsKLSAgICBhdG9taWNf
c2V0KCZjcHUtPmV4aXRfcmVxdWVzdCwgMSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZjcHUtPmV4
aXRfcmVxdWVzdCwgMSk7CiAgICAgLyogRW5zdXJlIGNwdV9leGVjIHdpbGwgc2VlIHRoZSBleGl0
IHJlcXVlc3QgYWZ0ZXIgVENHIGhhcyBleGl0ZWQuICAqLwogICAgIHNtcF93bWIoKTsKLSAgICBh
dG9taWNfc2V0KCZjcHUtPmljb3VudF9kZWNyX3B0ci0+dTE2LmhpZ2gsIC0xKTsKKyAgICBxZW11
X2F0b21pY19zZXQoJmNwdS0+aWNvdW50X2RlY3JfcHRyLT51MTYuaGlnaCwgLTEpOwogfQogCiBp
bnQgY3B1X3dyaXRlX2VsZjMyX3FlbXVub3RlKFdyaXRlQ29yZUR1bXBGdW5jdGlvbiBmLCBDUFVT
dGF0ZSAqY3B1LApAQCAtMjYxLDcgKzI2MSw3IEBAIHN0YXRpYyB2b2lkIGNwdV9jb21tb25fcmVz
ZXQoRGV2aWNlU3RhdGUgKmRldikKICAgICBjcHUtPmhhbHRlZCA9IGNwdS0+c3RhcnRfcG93ZXJl
ZF9vZmY7CiAgICAgY3B1LT5tZW1faW9fcGMgPSAwOwogICAgIGNwdS0+aWNvdW50X2V4dHJhID0g
MDsKLSAgICBhdG9taWNfc2V0KCZjcHUtPmljb3VudF9kZWNyX3B0ci0+dTMyLCAwKTsKKyAgICBx
ZW11X2F0b21pY19zZXQoJmNwdS0+aWNvdW50X2RlY3JfcHRyLT51MzIsIDApOwogICAgIGNwdS0+
Y2FuX2RvX2lvID0gMTsKICAgICBjcHUtPmV4Y2VwdGlvbl9pbmRleCA9IC0xOwogICAgIGNwdS0+
Y3Jhc2hfb2NjdXJyZWQgPSBmYWxzZTsKZGlmZiAtLWdpdCBhL2h3L2Rpc3BsYXkvcXhsLmMgYi9o
dy9kaXNwbGF5L3F4bC5jCmluZGV4IDExODcxMzQwZTcuLjBhMzMwMjc2ODUgMTAwNjQ0Ci0tLSBh
L2h3L2Rpc3BsYXkvcXhsLmMKKysrIGIvaHcvZGlzcGxheS9xeGwuYwpAQCAtMTkwOCw3ICsxOTA4
LDcgQEAgc3RhdGljIHZvaWQgcXhsX3NlbmRfZXZlbnRzKFBDSVFYTERldmljZSAqZCwgdWludDMy
X3QgZXZlbnRzKQogICAgIC8qCiAgICAgICogT2xkZXIgdmVyc2lvbnMgb2YgU3BpY2UgZm9yZ290
IHRvIGRlZmluZSB0aGUgUVhMUmFtIHN0cnVjdAogICAgICAqIHdpdGggdGhlICdfX2FsaWduZWRf
Xyg0KScgYXR0cmlidXRlLiBjbGFuZyA3IGFuZCBuZXdlciB3aWxsCi0gICAgICogdGh1cyB3YXJu
IHRoYXQgYXRvbWljX2ZldGNoX29yKCZkLT5yYW0tPmludF9wZW5kaW5nLCAuLi4pCisgICAgICog
dGh1cyB3YXJuIHRoYXQgcWVtdV9hdG9taWNfZmV0Y2hfb3IoJmQtPnJhbS0+aW50X3BlbmRpbmcs
IC4uLikKICAgICAgKiBtaWdodCBiZSBhIG1pc2FsaWduZWQgYXRvbWljIGFjY2VzcywgYW5kIHdp
bGwgZ2VuZXJhdGUgYW4KICAgICAgKiBvdXQtb2YtbGluZSBjYWxsIGZvciBpdCwgd2hpY2ggcmVz
dWx0cyBpbiBhIGxpbmsgZXJyb3Igc2luY2UKICAgICAgKiB3ZSBkb24ndCBjdXJyZW50bHkgbGlu
ayBhZ2FpbnN0IGxpYmF0b21pYy4KQEAgLTE5MjgsOCArMTkyOCw5IEBAIHN0YXRpYyB2b2lkIHF4
bF9zZW5kX2V2ZW50cyhQQ0lRWExEZXZpY2UgKmQsIHVpbnQzMl90IGV2ZW50cykKICNkZWZpbmUg
QUxJR05FRF9VSU5UMzJfUFRSKFApICgodWludDMyX3QgKilQKQogI2VuZGlmCiAKLSAgICBvbGRf
cGVuZGluZyA9IGF0b21pY19mZXRjaF9vcihBTElHTkVEX1VJTlQzMl9QVFIoJmQtPnJhbS0+aW50
X3BlbmRpbmcpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlX2V2ZW50cyk7
CisgICAgb2xkX3BlbmRpbmcgPQorICAgICAgICBxZW11X2F0b21pY19mZXRjaF9vcihBTElHTkVE
X1VJTlQzMl9QVFIoJmQtPnJhbS0+aW50X3BlbmRpbmcpLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsZV9ldmVudHMpOwogICAgIGlmICgob2xkX3BlbmRpbmcgJiBsZV9ldmVudHMpID09
IGxlX2V2ZW50cykgewogICAgICAgICByZXR1cm47CiAgICAgfQpkaWZmIC0tZ2l0IGEvaHcvaHlw
ZXJ2L2h5cGVydi5jIGIvaHcvaHlwZXJ2L2h5cGVydi5jCmluZGV4IGFhNWEyYTliZDguLmE4MzJi
ODVhZDAgMTAwNjQ0Ci0tLSBhL2h3L2h5cGVydi9oeXBlcnYuYworKysgYi9ody9oeXBlcnYvaHlw
ZXJ2LmMKQEAgLTIzMyw3ICsyMzMsNyBAQCBzdGF0aWMgdm9pZCBzaW50X21zZ19iaCh2b2lkICpv
cGFxdWUpCiAgICAgSHZTaW50Um91dGUgKnNpbnRfcm91dGUgPSBvcGFxdWU7CiAgICAgSHZTaW50
U3RhZ2VkTWVzc2FnZSAqc3RhZ2VkX21zZyA9IHNpbnRfcm91dGUtPnN0YWdlZF9tc2c7CiAKLSAg
ICBpZiAoYXRvbWljX3JlYWQoJnN0YWdlZF9tc2ctPnN0YXRlKSAhPSBIVl9TVEFHRURfTVNHX1BP
U1RFRCkgeworICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZzdGFnZWRfbXNnLT5zdGF0ZSkgIT0g
SFZfU1RBR0VEX01TR19QT1NURUQpIHsKICAgICAgICAgLyogc3RhdHVzIG5vciByZWFkeSB5ZXQg
KHNwdXJpb3VzIGFjayBmcm9tIGd1ZXN0PyksIGlnbm9yZSAqLwogICAgICAgICByZXR1cm47CiAg
ICAgfQpAQCAtMjQyLDcgKzI0Miw3IEBAIHN0YXRpYyB2b2lkIHNpbnRfbXNnX2JoKHZvaWQgKm9w
YXF1ZSkKICAgICBzdGFnZWRfbXNnLT5zdGF0dXMgPSAwOwogCiAgICAgLyogc3RhZ2VkIG1lc3Nh
Z2UgcHJvY2Vzc2luZyBmaW5pc2hlZCwgcmVhZHkgdG8gc3RhcnQgb3ZlciAqLwotICAgIGF0b21p
Y19zZXQoJnN0YWdlZF9tc2ctPnN0YXRlLCBIVl9TVEFHRURfTVNHX0ZSRUUpOworICAgIHFlbXVf
YXRvbWljX3NldCgmc3RhZ2VkX21zZy0+c3RhdGUsIEhWX1NUQUdFRF9NU0dfRlJFRSk7CiAgICAg
LyogZHJvcCB0aGUgcmVmZXJlbmNlIHRha2VuIGluIGh5cGVydl9wb3N0X21zZyAqLwogICAgIGh5
cGVydl9zaW50X3JvdXRlX3VucmVmKHNpbnRfcm91dGUpOwogfQpAQCAtMjgwLDcgKzI4MCw3IEBA
IHN0YXRpYyB2b2lkIGNwdV9wb3N0X21zZyhDUFVTdGF0ZSAqY3MsIHJ1bl9vbl9jcHVfZGF0YSBk
YXRhKQogICAgIG1lbW9yeV9yZWdpb25fc2V0X2RpcnR5KCZzeW5pYy0+bXNnX3BhZ2VfbXIsIDAs
IHNpemVvZigqc3luaWMtPm1zZ19wYWdlKSk7CiAKIHBvc3RlZDoKLSAgICBhdG9taWNfc2V0KCZz
dGFnZWRfbXNnLT5zdGF0ZSwgSFZfU1RBR0VEX01TR19QT1NURUQpOworICAgIHFlbXVfYXRvbWlj
X3NldCgmc3RhZ2VkX21zZy0+c3RhdGUsIEhWX1NUQUdFRF9NU0dfUE9TVEVEKTsKICAgICAvKgog
ICAgICAqIE5vdGlmeSB0aGUgbXNnIG9yaWdpbmF0b3Igb2YgdGhlIHByb2dyZXNzIG1hZGU7IGlm
IHRoZSBzbG90IHdhcyBidXN5IHdlCiAgICAgICogc2V0IG1zZ19wZW5kaW5nIGZsYWcgaW4gaXQg
c28gaXQgd2lsbCBiZSB0aGUgZ3Vlc3Qgd2hvIHdpbGwgZG8gRU9NIGFuZApAQCAtMzAzLDcgKzMw
Myw3IEBAIGludCBoeXBlcnZfcG9zdF9tc2coSHZTaW50Um91dGUgKnNpbnRfcm91dGUsIHN0cnVj
dCBoeXBlcnZfbWVzc2FnZSAqc3JjX21zZykKICAgICBhc3NlcnQoc3RhZ2VkX21zZyk7CiAKICAg
ICAvKiBncmFiIHRoZSBzdGFnaW5nIGFyZWEgKi8KLSAgICBpZiAoYXRvbWljX2NtcHhjaGcoJnN0
YWdlZF9tc2ctPnN0YXRlLCBIVl9TVEFHRURfTVNHX0ZSRUUsCisgICAgaWYgKHFlbXVfYXRvbWlj
X2NtcHhjaGcoJnN0YWdlZF9tc2ctPnN0YXRlLCBIVl9TVEFHRURfTVNHX0ZSRUUsCiAgICAgICAg
ICAgICAgICAgICAgICAgIEhWX1NUQUdFRF9NU0dfQlVTWSkgIT0gSFZfU1RBR0VEX01TR19GUkVF
KSB7CiAgICAgICAgIHJldHVybiAtRUFHQUlOOwogICAgIH0KQEAgLTM1Myw3ICszNTMsOCBAQCBp
bnQgaHlwZXJ2X3NldF9ldmVudF9mbGFnKEh2U2ludFJvdXRlICpzaW50X3JvdXRlLCB1bnNpZ25l
ZCBldmVudG5vKQogICAgIHNldF9tYXNrID0gQklUX01BU0soZXZlbnRubyk7CiAgICAgZmxhZ3Mg
PSBzeW5pYy0+ZXZlbnRfcGFnZS0+c2xvdFtzaW50X3JvdXRlLT5zaW50XS5mbGFnczsKIAotICAg
IGlmICgoYXRvbWljX2ZldGNoX29yKCZmbGFnc1tzZXRfaWR4XSwgc2V0X21hc2spICYgc2V0X21h
c2spICE9IHNldF9tYXNrKSB7CisgICAgaWYgKChxZW11X2F0b21pY19mZXRjaF9vcigmZmxhZ3Nb
c2V0X2lkeF0sIHNldF9tYXNrKSAmIHNldF9tYXNrKSAhPQorICAgICAgICAgICAgc2V0X21hc2sp
IHsKICAgICAgICAgbWVtb3J5X3JlZ2lvbl9zZXRfZGlydHkoJnN5bmljLT5ldmVudF9wYWdlX21y
LCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplb2YoKnN5bmljLT5ldmVu
dF9wYWdlKSk7CiAgICAgICAgIHJldCA9IGh5cGVydl9zaW50X3JvdXRlX3NldF9zaW50KHNpbnRf
cm91dGUpOwpkaWZmIC0tZ2l0IGEvaHcvaHlwZXJ2L3ZtYnVzLmMgYi9ody9oeXBlcnYvdm1idXMu
YwppbmRleCA2ZWY4OTViYzM1Li5jNWFkMjYxNjAwIDEwMDY0NAotLS0gYS9ody9oeXBlcnYvdm1i
dXMuYworKysgYi9ody9oeXBlcnYvdm1idXMuYwpAQCAtNzQ3LDcgKzc0Nyw3IEBAIHN0YXRpYyBp
bnQgdm1idXNfY2hhbm5lbF9ub3RpZnlfZ3Vlc3QoVk1CdXNDaGFubmVsICpjaGFuKQogCiAgICAg
aWR4ID0gQklUX1dPUkQoY2hhbi0+aWQpOwogICAgIG1hc2sgPSBCSVRfTUFTSyhjaGFuLT5pZCk7
Ci0gICAgaWYgKChhdG9taWNfZmV0Y2hfb3IoJmludF9tYXBbaWR4XSwgbWFzaykgJiBtYXNrKSAh
PSBtYXNrKSB7CisgICAgaWYgKChxZW11X2F0b21pY19mZXRjaF9vcigmaW50X21hcFtpZHhdLCBt
YXNrKSAmIG1hc2spICE9IG1hc2spIHsKICAgICAgICAgcmVzID0gaHlwZXJ2X3NpbnRfcm91dGVf
c2V0X3NpbnQoY2hhbi0+bm90aWZ5X3JvdXRlKTsKICAgICAgICAgZGlydHkgPSBsZW47CiAgICAg
fQpkaWZmIC0tZ2l0IGEvaHcvaTM4Ni94ZW4veGVuLWh2bS5jIGIvaHcvaTM4Ni94ZW4veGVuLWh2
bS5jCmluZGV4IGNkZTk4MWJhZDYuLmNhNmIzZTI0MDggMTAwNjQ0Ci0tLSBhL2h3L2kzODYveGVu
L3hlbi1odm0uYworKysgYi9ody9pMzg2L3hlbi94ZW4taHZtLmMKQEAgLTExNDAsNyArMTE0MCw3
IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2J1ZmZlcmVkX2lvcGFnZShYZW5JT1N0YXRlICpzdGF0ZSkK
ICAgICAgICAgYXNzZXJ0KHJlcS5kaXIgPT0gSU9SRVFfV1JJVEUpOwogICAgICAgICBhc3NlcnQo
IXJlcS5kYXRhX2lzX3B0cik7CiAKLSAgICAgICAgYXRvbWljX2FkZCgmYnVmX3BhZ2UtPnJlYWRf
cG9pbnRlciwgcXcgKyAxKTsKKyAgICAgICAgcWVtdV9hdG9taWNfYWRkKCZidWZfcGFnZS0+cmVh
ZF9wb2ludGVyLCBxdyArIDEpOwogICAgIH0KIAogICAgIHJldHVybiByZXEuY291bnQ7CmRpZmYg
LS1naXQgYS9ody9pbnRjL3J4X2ljdS5jIGIvaHcvaW50Yy9yeF9pY3UuYwppbmRleCBkZjRiNmE4
ZDIyLi40MjIwMTIwNzM5IDEwMDY0NAotLS0gYS9ody9pbnRjL3J4X2ljdS5jCisrKyBiL2h3L2lu
dGMvcnhfaWN1LmMKQEAgLTgxLDggKzgxLDggQEAgc3RhdGljIHZvaWQgcnhpY3VfcmVxdWVzdChS
WElDVVN0YXRlICppY3UsIGludCBuX0lSUSkKICAgICBpbnQgZW5hYmxlOwogCiAgICAgZW5hYmxl
ID0gaWN1LT5pZXJbbl9JUlEgLyA4XSAmICgxIDw8IChuX0lSUSAmIDcpKTsKLSAgICBpZiAobl9J
UlEgPiAwICYmIGVuYWJsZSAhPSAwICYmIGF0b21pY19yZWFkKCZpY3UtPnJlcV9pcnEpIDwgMCkg
ewotICAgICAgICBhdG9taWNfc2V0KCZpY3UtPnJlcV9pcnEsIG5fSVJRKTsKKyAgICBpZiAobl9J
UlEgPiAwICYmIGVuYWJsZSAhPSAwICYmIHFlbXVfYXRvbWljX3JlYWQoJmljdS0+cmVxX2lycSkg
PCAwKSB7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmaWN1LT5yZXFfaXJxLCBuX0lSUSk7CiAg
ICAgICAgIHNldF9pcnEoaWN1LCBuX0lSUSwgcnhpY3VfbGV2ZWwoaWN1LCBuX0lSUSkpOwogICAg
IH0KIH0KQEAgLTEyNCwxMCArMTI0LDEwIEBAIHN0YXRpYyB2b2lkIHJ4aWN1X3NldF9pcnEodm9p
ZCAqb3BhcXVlLCBpbnQgbl9JUlEsIGludCBsZXZlbCkKICAgICB9CiAgICAgaWYgKGlzc3VlID09
IDAgJiYgc3JjLT5zZW5zZSA9PSBUUkdfTEVWRUwpIHsKICAgICAgICAgaWN1LT5pcltuX0lSUV0g
PSAwOwotICAgICAgICBpZiAoYXRvbWljX3JlYWQoJmljdS0+cmVxX2lycSkgPT0gbl9JUlEpIHsK
KyAgICAgICAgaWYgKHFlbXVfYXRvbWljX3JlYWQoJmljdS0+cmVxX2lycSkgPT0gbl9JUlEpIHsK
ICAgICAgICAgICAgIC8qIGNsZWFyIHJlcXVlc3QgKi8KICAgICAgICAgICAgIHNldF9pcnEoaWN1
LCBuX0lSUSwgMCk7Ci0gICAgICAgICAgICBhdG9taWNfc2V0KCZpY3UtPnJlcV9pcnEsIC0xKTsK
KyAgICAgICAgICAgIHFlbXVfYXRvbWljX3NldCgmaWN1LT5yZXFfaXJxLCAtMSk7CiAgICAgICAg
IH0KICAgICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTE0NCwxMSArMTQ0LDExIEBAIHN0YXRpYyB2
b2lkIHJ4aWN1X2Fja19pcnEodm9pZCAqb3BhcXVlLCBpbnQgbm8sIGludCBsZXZlbCkKICAgICBp
bnQgbl9JUlE7CiAgICAgaW50IG1heF9wcmk7CiAKLSAgICBuX0lSUSA9IGF0b21pY19yZWFkKCZp
Y3UtPnJlcV9pcnEpOworICAgIG5fSVJRID0gcWVtdV9hdG9taWNfcmVhZCgmaWN1LT5yZXFfaXJx
KTsKICAgICBpZiAobl9JUlEgPCAwKSB7CiAgICAgICAgIHJldHVybjsKICAgICB9Ci0gICAgYXRv
bWljX3NldCgmaWN1LT5yZXFfaXJxLCAtMSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZpY3UtPnJl
cV9pcnEsIC0xKTsKICAgICBpZiAoaWN1LT5zcmNbbl9JUlFdLnNlbnNlICE9IFRSR19MRVZFTCkg
ewogICAgICAgICBpY3UtPmlyW25fSVJRXSA9IDA7CiAgICAgfQpkaWZmIC0tZ2l0IGEvaHcvaW50
Yy9zaWZpdmVfcGxpYy5jIGIvaHcvaW50Yy9zaWZpdmVfcGxpYy5jCmluZGV4IGFmNjExZjhkYjgu
LjRiOWU0MDFiNzkgMTAwNjQ0Ci0tLSBhL2h3L2ludGMvc2lmaXZlX3BsaWMuYworKysgYi9ody9p
bnRjL3NpZml2ZV9wbGljLmMKQEAgLTg5LDEyICs4OSwxMiBAQCBzdGF0aWMgdm9pZCBzaWZpdmVf
cGxpY19wcmludF9zdGF0ZShTaUZpdmVQTElDU3RhdGUgKnBsaWMpCiAKIHN0YXRpYyB1aW50MzJf
dCBhdG9taWNfc2V0X21hc2tlZCh1aW50MzJfdCAqYSwgdWludDMyX3QgbWFzaywgdWludDMyX3Qg
dmFsdWUpCiB7Ci0gICAgdWludDMyX3Qgb2xkLCBuZXcsIGNtcCA9IGF0b21pY19yZWFkKGEpOwor
ICAgIHVpbnQzMl90IG9sZCwgbmV3LCBjbXAgPSBxZW11X2F0b21pY19yZWFkKGEpOwogCiAgICAg
ZG8gewogICAgICAgICBvbGQgPSBjbXA7CiAgICAgICAgIG5ldyA9IChvbGQgJiB+bWFzaykgfCAo
dmFsdWUgJiBtYXNrKTsKLSAgICAgICAgY21wID0gYXRvbWljX2NtcHhjaGcoYSwgb2xkLCBuZXcp
OworICAgICAgICBjbXAgPSBxZW11X2F0b21pY19jbXB4Y2hnKGEsIG9sZCwgbmV3KTsKICAgICB9
IHdoaWxlIChvbGQgIT0gY21wKTsKIAogICAgIHJldHVybiBvbGQ7CmRpZmYgLS1naXQgYS9ody9t
aXNjL2VkdS5jIGIvaHcvbWlzYy9lZHUuYwppbmRleCAwZmY5ZDFhYzc4Li5jMjE5NmRhZmI1IDEw
MDY0NAotLS0gYS9ody9taXNjL2VkdS5jCisrKyBiL2h3L21pc2MvZWR1LmMKQEAgLTIxMiw3ICsy
MTIsNyBAQCBzdGF0aWMgdWludDY0X3QgZWR1X21taW9fcmVhZCh2b2lkICpvcGFxdWUsIGh3YWRk
ciBhZGRyLCB1bnNpZ25lZCBzaXplKQogICAgICAgICBxZW11X211dGV4X3VubG9jaygmZWR1LT50
aHJfbXV0ZXgpOwogICAgICAgICBicmVhazsKICAgICBjYXNlIDB4MjA6Ci0gICAgICAgIHZhbCA9
IGF0b21pY19yZWFkKCZlZHUtPnN0YXR1cyk7CisgICAgICAgIHZhbCA9IHFlbXVfYXRvbWljX3Jl
YWQoJmVkdS0+c3RhdHVzKTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSAweDI0OgogICAgICAg
ICB2YWwgPSBlZHUtPmlycV9zdGF0dXM7CkBAIC0yNTIsNyArMjUyLDcgQEAgc3RhdGljIHZvaWQg
ZWR1X21taW9fd3JpdGUodm9pZCAqb3BhcXVlLCBod2FkZHIgYWRkciwgdWludDY0X3QgdmFsLAog
ICAgICAgICBlZHUtPmFkZHI0ID0gfnZhbDsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSAweDA4
OgotICAgICAgICBpZiAoYXRvbWljX3JlYWQoJmVkdS0+c3RhdHVzKSAmIEVEVV9TVEFUVVNfQ09N
UFVUSU5HKSB7CisgICAgICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZlZHUtPnN0YXR1cykgJiBF
RFVfU1RBVFVTX0NPTVBVVElORykgewogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KICAg
ICAgICAgLyogRURVX1NUQVRVU19DT01QVVRJTkcgY2Fubm90IGdvIDAtPjEgY29uY3VycmVudGx5
LCBiZWNhdXNlIGl0IGlzIG9ubHkKQEAgLTI2MCwxNSArMjYwLDE1IEBAIHN0YXRpYyB2b2lkIGVk
dV9tbWlvX3dyaXRlKHZvaWQgKm9wYXF1ZSwgaHdhZGRyIGFkZHIsIHVpbnQ2NF90IHZhbCwKICAg
ICAgICAgICovCiAgICAgICAgIHFlbXVfbXV0ZXhfbG9jaygmZWR1LT50aHJfbXV0ZXgpOwogICAg
ICAgICBlZHUtPmZhY3QgPSB2YWw7Ci0gICAgICAgIGF0b21pY19vcigmZWR1LT5zdGF0dXMsIEVE
VV9TVEFUVVNfQ09NUFVUSU5HKTsKKyAgICAgICAgcWVtdV9hdG9taWNfb3IoJmVkdS0+c3RhdHVz
LCBFRFVfU1RBVFVTX0NPTVBVVElORyk7CiAgICAgICAgIHFlbXVfY29uZF9zaWduYWwoJmVkdS0+
dGhyX2NvbmQpOwogICAgICAgICBxZW11X211dGV4X3VubG9jaygmZWR1LT50aHJfbXV0ZXgpOwog
ICAgICAgICBicmVhazsKICAgICBjYXNlIDB4MjA6CiAgICAgICAgIGlmICh2YWwgJiBFRFVfU1RB
VFVTX0lSUUZBQ1QpIHsKLSAgICAgICAgICAgIGF0b21pY19vcigmZWR1LT5zdGF0dXMsIEVEVV9T
VEFUVVNfSVJRRkFDVCk7CisgICAgICAgICAgICBxZW11X2F0b21pY19vcigmZWR1LT5zdGF0dXMs
IEVEVV9TVEFUVVNfSVJRRkFDVCk7CiAgICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICBhdG9t
aWNfYW5kKCZlZHUtPnN0YXR1cywgfkVEVV9TVEFUVVNfSVJRRkFDVCk7CisgICAgICAgICAgICBx
ZW11X2F0b21pY19hbmQoJmVkdS0+c3RhdHVzLCB+RURVX1NUQVRVU19JUlFGQUNUKTsKICAgICAg
ICAgfQogICAgICAgICBicmVhazsKICAgICBjYXNlIDB4NjA6CkBAIC0zMjIsNyArMzIyLDcgQEAg
c3RhdGljIHZvaWQgKmVkdV9mYWN0X3RocmVhZCh2b2lkICpvcGFxdWUpCiAgICAgICAgIHVpbnQz
Ml90IHZhbCwgcmV0ID0gMTsKIAogICAgICAgICBxZW11X211dGV4X2xvY2soJmVkdS0+dGhyX211
dGV4KTsKLSAgICAgICAgd2hpbGUgKChhdG9taWNfcmVhZCgmZWR1LT5zdGF0dXMpICYgRURVX1NU
QVRVU19DT01QVVRJTkcpID09IDAgJiYKKyAgICAgICAgd2hpbGUgKChxZW11X2F0b21pY19yZWFk
KCZlZHUtPnN0YXR1cykgJiBFRFVfU1RBVFVTX0NPTVBVVElORykgPT0gMCAmJgogICAgICAgICAg
ICAgICAgICAgICAgICAgIWVkdS0+c3RvcHBpbmcpIHsKICAgICAgICAgICAgIHFlbXVfY29uZF93
YWl0KCZlZHUtPnRocl9jb25kLCAmZWR1LT50aHJfbXV0ZXgpOwogICAgICAgICB9CkBAIC0zNDcs
OSArMzQ3LDkgQEAgc3RhdGljIHZvaWQgKmVkdV9mYWN0X3RocmVhZCh2b2lkICpvcGFxdWUpCiAg
ICAgICAgIHFlbXVfbXV0ZXhfbG9jaygmZWR1LT50aHJfbXV0ZXgpOwogICAgICAgICBlZHUtPmZh
Y3QgPSByZXQ7CiAgICAgICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZlZHUtPnRocl9tdXRleCk7Ci0g
ICAgICAgIGF0b21pY19hbmQoJmVkdS0+c3RhdHVzLCB+RURVX1NUQVRVU19DT01QVVRJTkcpOwor
ICAgICAgICBxZW11X2F0b21pY19hbmQoJmVkdS0+c3RhdHVzLCB+RURVX1NUQVRVU19DT01QVVRJ
TkcpOwogCi0gICAgICAgIGlmIChhdG9taWNfcmVhZCgmZWR1LT5zdGF0dXMpICYgRURVX1NUQVRV
U19JUlFGQUNUKSB7CisgICAgICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZlZHUtPnN0YXR1cykg
JiBFRFVfU1RBVFVTX0lSUUZBQ1QpIHsKICAgICAgICAgICAgIHFlbXVfbXV0ZXhfbG9ja19pb3Ro
cmVhZCgpOwogICAgICAgICAgICAgZWR1X3JhaXNlX2lycShlZHUsIEZBQ1RfSVJRKTsKICAgICAg
ICAgICAgIHFlbXVfbXV0ZXhfdW5sb2NrX2lvdGhyZWFkKCk7CmRpZmYgLS1naXQgYS9ody9uZXQv
dmlydGlvLW5ldC5jIGIvaHcvbmV0L3ZpcnRpby1uZXQuYwppbmRleCBjYjBkMjcwODRjLi4wYzlj
MjUzMzY3IDEwMDY0NAotLS0gYS9ody9uZXQvdmlydGlvLW5ldC5jCisrKyBiL2h3L25ldC92aXJ0
aW8tbmV0LmMKQEAgLTkzMyw3ICs5MzMsNyBAQCBzdGF0aWMgdm9pZCB2aXJ0aW9fbmV0X3NldF9m
ZWF0dXJlcyhWaXJ0SU9EZXZpY2UgKnZkZXYsIHVpbnQ2NF90IGZlYXR1cmVzKQogCiAgICAgaWYg
KHZpcnRpb19oYXNfZmVhdHVyZShmZWF0dXJlcywgVklSVElPX05FVF9GX1NUQU5EQlkpKSB7CiAg
ICAgICAgIHFhcGlfZXZlbnRfc2VuZF9mYWlsb3Zlcl9uZWdvdGlhdGVkKG4tPm5ldGNsaWVudF9u
YW1lKTsKLSAgICAgICAgYXRvbWljX3NldCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlkZGVuLCBm
YWxzZSk7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlk
ZGVuLCBmYWxzZSk7CiAgICAgICAgIGZhaWxvdmVyX2FkZF9wcmltYXJ5KG4sICZlcnIpOwogICAg
ICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgICBuLT5wcmltYXJ5X2RldiA9IHZpcnRpb19jb25u
ZWN0X2ZhaWxvdmVyX2RldmljZXMobiwgbi0+cWRldiwgJmVycik7CkBAIC0zMTY4LDcgKzMxNjgs
NyBAQCBzdGF0aWMgdm9pZCB2aXJ0aW9fbmV0X2hhbmRsZV9taWdyYXRpb25fcHJpbWFyeShWaXJ0
SU9OZXQgKm4sCiAgICAgYm9vbCBzaG91bGRfYmVfaGlkZGVuOwogICAgIEVycm9yICplcnIgPSBO
VUxMOwogCi0gICAgc2hvdWxkX2JlX2hpZGRlbiA9IGF0b21pY19yZWFkKCZuLT5wcmltYXJ5X3No
b3VsZF9iZV9oaWRkZW4pOworICAgIHNob3VsZF9iZV9oaWRkZW4gPSBxZW11X2F0b21pY19yZWFk
KCZuLT5wcmltYXJ5X3Nob3VsZF9iZV9oaWRkZW4pOwogCiAgICAgaWYgKCFuLT5wcmltYXJ5X2Rl
dikgewogICAgICAgICBuLT5wcmltYXJ5X2RldiA9IHZpcnRpb19jb25uZWN0X2ZhaWxvdmVyX2Rl
dmljZXMobiwgbi0+cWRldiwgJmVycik7CkBAIC0zMTgzLDcgKzMxODMsNyBAQCBzdGF0aWMgdm9p
ZCB2aXJ0aW9fbmV0X2hhbmRsZV9taWdyYXRpb25fcHJpbWFyeShWaXJ0SU9OZXQgKm4sCiAgICAg
ICAgICAgICAgICAgICAgIHFkZXZfZ2V0X3Ztc2Qobi0+cHJpbWFyeV9kZXYpLAogICAgICAgICAg
ICAgICAgICAgICBuLT5wcmltYXJ5X2Rldik7CiAgICAgICAgICAgICBxYXBpX2V2ZW50X3NlbmRf
dW5wbHVnX3ByaW1hcnkobi0+cHJpbWFyeV9kZXZpY2VfaWQpOwotICAgICAgICAgICAgYXRvbWlj
X3NldCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlkZGVuLCB0cnVlKTsKKyAgICAgICAgICAgIHFl
bXVfYXRvbWljX3NldCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlkZGVuLCB0cnVlKTsKICAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgIHdhcm5fcmVwb3J0KCJjb3VsZG4ndCB1bnBsdWcgcHJp
bWFyeSBkZXZpY2UiKTsKICAgICAgICAgfQpAQCAtMzIzNCw3ICszMjM0LDcgQEAgc3RhdGljIGlu
dCB2aXJ0aW9fbmV0X3ByaW1hcnlfc2hvdWxkX2JlX2hpZGRlbihEZXZpY2VMaXN0ZW5lciAqbGlz
dGVuZXIsCiAgICAgbi0+cHJpbWFyeV9kZXZpY2Vfb3B0cyA9IGRldmljZV9vcHRzOwogCiAgICAg
LyogcHJpbWFyeV9zaG91bGRfYmVfaGlkZGVuIGlzIHNldCBkdXJpbmcgZmVhdHVyZSBuZWdvdGlh
dGlvbiAqLwotICAgIGhpZGUgPSBhdG9taWNfcmVhZCgmbi0+cHJpbWFyeV9zaG91bGRfYmVfaGlk
ZGVuKTsKKyAgICBoaWRlID0gcWVtdV9hdG9taWNfcmVhZCgmbi0+cHJpbWFyeV9zaG91bGRfYmVf
aGlkZGVuKTsKIAogICAgIGlmIChuLT5wcmltYXJ5X2RldmljZV9kaWN0KSB7CiAgICAgICAgIGdf
ZnJlZShuLT5wcmltYXJ5X2RldmljZV9pZCk7CkBAIC0zMjkxLDcgKzMyOTEsNyBAQCBzdGF0aWMg
dm9pZCB2aXJ0aW9fbmV0X2RldmljZV9yZWFsaXplKERldmljZVN0YXRlICpkZXYsIEVycm9yICoq
ZXJycCkKICAgICBpZiAobi0+ZmFpbG92ZXIpIHsKICAgICAgICAgbi0+cHJpbWFyeV9saXN0ZW5l
ci5zaG91bGRfYmVfaGlkZGVuID0KICAgICAgICAgICAgIHZpcnRpb19uZXRfcHJpbWFyeV9zaG91
bGRfYmVfaGlkZGVuOwotICAgICAgICBhdG9taWNfc2V0KCZuLT5wcmltYXJ5X3Nob3VsZF9iZV9o
aWRkZW4sIHRydWUpOworICAgICAgICBxZW11X2F0b21pY19zZXQoJm4tPnByaW1hcnlfc2hvdWxk
X2JlX2hpZGRlbiwgdHJ1ZSk7CiAgICAgICAgIGRldmljZV9saXN0ZW5lcl9yZWdpc3Rlcigmbi0+
cHJpbWFyeV9saXN0ZW5lcik7CiAgICAgICAgIG4tPm1pZ3JhdGlvbl9zdGF0ZS5ub3RpZnkgPSB2
aXJ0aW9fbmV0X21pZ3JhdGlvbl9zdGF0ZV9ub3RpZmllcjsKICAgICAgICAgYWRkX21pZ3JhdGlv
bl9zdGF0ZV9jaGFuZ2Vfbm90aWZpZXIoJm4tPm1pZ3JhdGlvbl9zdGF0ZSk7CmRpZmYgLS1naXQg
YS9ody9yZG1hL3JkbWFfYmFja2VuZC5jIGIvaHcvcmRtYS9yZG1hX2JhY2tlbmQuYwppbmRleCBk
YjdlNWM4YmU1Li44ODZjZTg3NThlIDEwMDY0NAotLS0gYS9ody9yZG1hL3JkbWFfYmFja2VuZC5j
CisrKyBiL2h3L3JkbWEvcmRtYV9iYWNrZW5kLmMKQEAgLTY4LDcgKzY4LDcgQEAgc3RhdGljIHZv
aWQgZnJlZV9jcWVfY3R4KGdwb2ludGVyIGRhdGEsIGdwb2ludGVyIHVzZXJfZGF0YSkKICAgICBi
Y3R4ID0gcmRtYV9ybV9nZXRfY3FlX2N0eChyZG1hX2Rldl9yZXMsIGNxZV9jdHhfaWQpOwogICAg
IGlmIChiY3R4KSB7CiAgICAgICAgIHJkbWFfcm1fZGVhbGxvY19jcWVfY3R4KHJkbWFfZGV2X3Jl
cywgY3FlX2N0eF9pZCk7Ci0gICAgICAgIGF0b21pY19kZWMoJnJkbWFfZGV2X3Jlcy0+c3RhdHMu
bWlzc2luZ19jcWUpOworICAgICAgICBxZW11X2F0b21pY19kZWMoJnJkbWFfZGV2X3Jlcy0+c3Rh
dHMubWlzc2luZ19jcWUpOwogICAgIH0KICAgICBnX2ZyZWUoYmN0eCk7CiB9CkBAIC04MSw3ICs4
MSw3IEBAIHN0YXRpYyB2b2lkIGNsZWFuX3JlY3ZfbWFkcyhSZG1hQmFja2VuZERldiAqYmFja2Vu
ZF9kZXYpCiAgICAgICAgIGNxZV9jdHhfaWQgPSByZG1hX3Byb3RlY3RlZF9xbGlzdF9wb3BfaW50
NjQoJmJhY2tlbmRfZGV2LT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZWN2X21hZHNfbGlzdCk7CiAgICAgICAgIGlmIChjcWVfY3R4X2lkICE9
IC1FTk9FTlQpIHsKLSAgICAgICAgICAgIGF0b21pY19pbmMoJmJhY2tlbmRfZGV2LT5yZG1hX2Rl
dl9yZXMtPnN0YXRzLm1pc3NpbmdfY3FlKTsKKyAgICAgICAgICAgIHFlbXVfYXRvbWljX2luYygm
YmFja2VuZF9kZXYtPnJkbWFfZGV2X3Jlcy0+c3RhdHMubWlzc2luZ19jcWUpOwogICAgICAgICAg
ICAgZnJlZV9jcWVfY3R4KEdJTlRfVE9fUE9JTlRFUihjcWVfY3R4X2lkKSwKICAgICAgICAgICAg
ICAgICAgICAgICAgICBiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzKTsKICAgICAgICAgfQpAQCAt
MTIzLDcgKzEyMyw3IEBAIHN0YXRpYyBpbnQgcmRtYV9wb2xsX2NxKFJkbWFEZXZpY2VSZXNvdXJj
ZXMgKnJkbWFfZGV2X3Jlcywgc3RydWN0IGlidl9jcSAqaWJjcSkKICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgIHRvdGFsX25lICs9IG5lOwogICAgICAgICB9IHdoaWxlIChuZSA+IDApOwotICAg
ICAgICBhdG9taWNfc3ViKCZyZG1hX2Rldl9yZXMtPnN0YXRzLm1pc3NpbmdfY3FlLCB0b3RhbF9u
ZSk7CisgICAgICAgIHFlbXVfYXRvbWljX3N1YigmcmRtYV9kZXZfcmVzLT5zdGF0cy5taXNzaW5n
X2NxZSwgdG90YWxfbmUpOwogICAgIH0KIAogICAgIGlmIChuZSA8IDApIHsKQEAgLTE5NSwxNyAr
MTk1LDE4IEBAIHN0YXRpYyB2b2lkICpjb21wX2hhbmRsZXJfdGhyZWFkKHZvaWQgKmFyZykKIAog
c3RhdGljIGlubGluZSB2b2lkIGRpc2FibGVfcmRtYWNtX211eF9hc3luYyhSZG1hQmFja2VuZERl
diAqYmFja2VuZF9kZXYpCiB7Ci0gICAgYXRvbWljX3NldCgmYmFja2VuZF9kZXYtPnJkbWFjbV9t
dXguY2FuX3JlY2VpdmUsIDApOworICAgIHFlbXVfYXRvbWljX3NldCgmYmFja2VuZF9kZXYtPnJk
bWFjbV9tdXguY2FuX3JlY2VpdmUsIDApOwogfQogCiBzdGF0aWMgaW5saW5lIHZvaWQgZW5hYmxl
X3JkbWFjbV9tdXhfYXN5bmMoUmRtYUJhY2tlbmREZXYgKmJhY2tlbmRfZGV2KQogewotICAgIGF0
b21pY19zZXQoJmJhY2tlbmRfZGV2LT5yZG1hY21fbXV4LmNhbl9yZWNlaXZlLCBzaXplb2YoUmRt
YUNtTXV4TXNnKSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZiYWNrZW5kX2Rldi0+cmRtYWNtX211
eC5jYW5fcmVjZWl2ZSwKKyAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKFJkbWFDbU11eE1zZykp
OwogfQogCiBzdGF0aWMgaW5saW5lIGludCByZG1hY21fbXV4X2Nhbl9wcm9jZXNzX2FzeW5jKFJk
bWFCYWNrZW5kRGV2ICpiYWNrZW5kX2RldikKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJmJh
Y2tlbmRfZGV2LT5yZG1hY21fbXV4LmNhbl9yZWNlaXZlKTsKKyAgICByZXR1cm4gcWVtdV9hdG9t
aWNfcmVhZCgmYmFja2VuZF9kZXYtPnJkbWFjbV9tdXguY2FuX3JlY2VpdmUpOwogfQogCiBzdGF0
aWMgaW50IHJkbWFjbV9tdXhfY2hlY2tfb3Bfc3RhdHVzKENoYXJCYWNrZW5kICptYWRfY2hyX2Jl
KQpAQCAtNTU1LDcgKzU1Niw3IEBAIHZvaWQgcmRtYV9iYWNrZW5kX3Bvc3Rfc2VuZChSZG1hQmFj
a2VuZERldiAqYmFja2VuZF9kZXYsCiAgICAgICAgIGdvdG8gZXJyX2RlYWxsb2NfY3FlX2N0eDsK
ICAgICB9CiAKLSAgICBhdG9taWNfaW5jKCZiYWNrZW5kX2Rldi0+cmRtYV9kZXZfcmVzLT5zdGF0
cy5taXNzaW5nX2NxZSk7CisgICAgcWVtdV9hdG9taWNfaW5jKCZiYWNrZW5kX2Rldi0+cmRtYV9k
ZXZfcmVzLT5zdGF0cy5taXNzaW5nX2NxZSk7CiAgICAgYmFja2VuZF9kZXYtPnJkbWFfZGV2X3Jl
cy0+c3RhdHMudHgrKzsKIAogICAgIHJldHVybjsKQEAgLTY1OCw3ICs2NTksNyBAQCB2b2lkIHJk
bWFfYmFja2VuZF9wb3N0X3JlY3YoUmRtYUJhY2tlbmREZXYgKmJhY2tlbmRfZGV2LAogICAgICAg
ICBnb3RvIGVycl9kZWFsbG9jX2NxZV9jdHg7CiAgICAgfQogCi0gICAgYXRvbWljX2luYygmYmFj
a2VuZF9kZXYtPnJkbWFfZGV2X3Jlcy0+c3RhdHMubWlzc2luZ19jcWUpOworICAgIHFlbXVfYXRv
bWljX2luYygmYmFja2VuZF9kZXYtPnJkbWFfZGV2X3Jlcy0+c3RhdHMubWlzc2luZ19jcWUpOwog
ICAgIGJhY2tlbmRfZGV2LT5yZG1hX2Rldl9yZXMtPnN0YXRzLnJ4X2J1ZnMrKzsKIAogICAgIHJl
dHVybjsKQEAgLTcxMCw3ICs3MTEsNyBAQCB2b2lkIHJkbWFfYmFja2VuZF9wb3N0X3NycV9yZWN2
KFJkbWFCYWNrZW5kRGV2ICpiYWNrZW5kX2RldiwKICAgICAgICAgZ290byBlcnJfZGVhbGxvY19j
cWVfY3R4OwogICAgIH0KIAotICAgIGF0b21pY19pbmMoJmJhY2tlbmRfZGV2LT5yZG1hX2Rldl9y
ZXMtPnN0YXRzLm1pc3NpbmdfY3FlKTsKKyAgICBxZW11X2F0b21pY19pbmMoJmJhY2tlbmRfZGV2
LT5yZG1hX2Rldl9yZXMtPnN0YXRzLm1pc3NpbmdfY3FlKTsKICAgICBiYWNrZW5kX2Rldi0+cmRt
YV9kZXZfcmVzLT5zdGF0cy5yeF9idWZzKys7CiAgICAgYmFja2VuZF9kZXYtPnJkbWFfZGV2X3Jl
cy0+c3RhdHMucnhfc3JxKys7CiAKZGlmZiAtLWdpdCBhL2h3L3JkbWEvcmRtYV9ybS5jIGIvaHcv
cmRtYS9yZG1hX3JtLmMKaW5kZXggNjA5NTdmODhkYi4uZDY5NTVkMWQxYiAxMDA2NDQKLS0tIGEv
aHcvcmRtYS9yZG1hX3JtLmMKKysrIGIvaHcvcmRtYS9yZG1hX3JtLmMKQEAgLTc5MCw3ICs3OTAs
NyBAQCBpbnQgcmRtYV9ybV9pbml0KFJkbWFEZXZpY2VSZXNvdXJjZXMgKmRldl9yZXMsIHN0cnVj
dCBpYnZfZGV2aWNlX2F0dHIgKmRldl9hdHRyKQogICAgIHFlbXVfbXV0ZXhfaW5pdCgmZGV2X3Jl
cy0+bG9jayk7CiAKICAgICBtZW1zZXQoJmRldl9yZXMtPnN0YXRzLCAwLCBzaXplb2YoZGV2X3Jl
cy0+c3RhdHMpKTsKLSAgICBhdG9taWNfc2V0KCZkZXZfcmVzLT5zdGF0cy5taXNzaW5nX2NxZSwg
MCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZkZXZfcmVzLT5zdGF0cy5taXNzaW5nX2NxZSwgMCk7
CiAKICAgICByZXR1cm4gMDsKIH0KZGlmZiAtLWdpdCBhL2h3L3JkbWEvdm13L3B2cmRtYV9kZXZf
cmluZy5jIGIvaHcvcmRtYS92bXcvcHZyZG1hX2Rldl9yaW5nLmMKaW5kZXggYzEyMmZlNzAzNS4u
NDNjN2RmYmQ1MiAxMDA2NDQKLS0tIGEvaHcvcmRtYS92bXcvcHZyZG1hX2Rldl9yaW5nLmMKKysr
IGIvaHcvcmRtYS92bXcvcHZyZG1hX2Rldl9yaW5nLmMKQEAgLTM4LDggKzM4LDggQEAgaW50IHB2
cmRtYV9yaW5nX2luaXQoUHZyZG1hUmluZyAqcmluZywgY29uc3QgY2hhciAqbmFtZSwgUENJRGV2
aWNlICpkZXYsCiAgICAgcmluZy0+bWF4X2VsZW1zID0gbWF4X2VsZW1zOwogICAgIHJpbmctPmVs
ZW1fc3ogPSBlbGVtX3N6OwogICAgIC8qIFRPRE86IEdpdmUgYSBtb21lbnQgdG8gdGhpbmsgaWYg
d2Ugd2FudCB0byByZWRvIGRyaXZlciBzZXR0aW5ncwotICAgIGF0b21pY19zZXQoJnJpbmctPnJp
bmdfc3RhdGUtPnByb2RfdGFpbCwgMCk7Ci0gICAgYXRvbWljX3NldCgmcmluZy0+cmluZ19zdGF0
ZS0+Y29uc19oZWFkLCAwKTsKKyAgICBxZW11X2F0b21pY19zZXQoJnJpbmctPnJpbmdfc3RhdGUt
PnByb2RfdGFpbCwgMCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZyaW5nLT5yaW5nX3N0YXRlLT5j
b25zX2hlYWQsIDApOwogICAgICovCiAgICAgcmluZy0+bnBhZ2VzID0gbnBhZ2VzOwogICAgIHJp
bmctPnBhZ2VzID0gZ19tYWxsb2MobnBhZ2VzICogc2l6ZW9mKHZvaWQgKikpOwpkaWZmIC0tZ2l0
IGEvaHcvczM5MHgvczM5MC1wY2ktYnVzLmMgYi9ody9zMzkweC9zMzkwLXBjaS1idXMuYwppbmRl
eCA5MjE0NmEyMTE5Li44NGU0MGI0Mzk1IDEwMDY0NAotLS0gYS9ody9zMzkweC9zMzkwLXBjaS1i
dXMuYworKysgYi9ody9zMzkweC9zMzkwLXBjaS1idXMuYwpAQCAtNjUwLDcgKzY1MCw3IEBAIHN0
YXRpYyB1aW50OF90IHNldF9pbmRfYXRvbWljKHVpbnQ2NF90IGluZF9sb2MsIHVpbnQ4X3QgdG9f
YmVfc2V0KQogICAgIGFjdHVhbCA9ICppbmRfYWRkcjsKICAgICBkbyB7CiAgICAgICAgIGV4cGVj
dGVkID0gYWN0dWFsOwotICAgICAgICBhY3R1YWwgPSBhdG9taWNfY21weGNoZyhpbmRfYWRkciwg
ZXhwZWN0ZWQsIGV4cGVjdGVkIHwgdG9fYmVfc2V0KTsKKyAgICAgICAgYWN0dWFsID0gcWVtdV9h
dG9taWNfY21weGNoZyhpbmRfYWRkciwgZXhwZWN0ZWQsIGV4cGVjdGVkIHwgdG9fYmVfc2V0KTsK
ICAgICB9IHdoaWxlIChhY3R1YWwgIT0gZXhwZWN0ZWQpOwogICAgIGNwdV9waHlzaWNhbF9tZW1v
cnlfdW5tYXAoKHZvaWQgKilpbmRfYWRkciwgbGVuLCAxLCBsZW4pOwogCmRpZmYgLS1naXQgYS9o
dy9zMzkweC92aXJ0aW8tY2N3LmMgYi9ody9zMzkweC92aXJ0aW8tY2N3LmMKaW5kZXggOGZlYjM0
NTFhMC4uOGFlZjJjYzhhMSAxMDA2NDQKLS0tIGEvaHcvczM5MHgvdmlydGlvLWNjdy5jCisrKyBi
L2h3L3MzOTB4L3ZpcnRpby1jY3cuYwpAQCAtODAwLDcgKzgwMCw3IEBAIHN0YXRpYyB1aW50OF90
IHZpcnRpb19zZXRfaW5kX2F0b21pYyhTdWJjaERldiAqc2NoLCB1aW50NjRfdCBpbmRfbG9jLAog
ICAgIGFjdHVhbCA9ICppbmRfYWRkcjsKICAgICBkbyB7CiAgICAgICAgIGV4cGVjdGVkID0gYWN0
dWFsOwotICAgICAgICBhY3R1YWwgPSBhdG9taWNfY21weGNoZyhpbmRfYWRkciwgZXhwZWN0ZWQs
IGV4cGVjdGVkIHwgdG9fYmVfc2V0KTsKKyAgICAgICAgYWN0dWFsID0gcWVtdV9hdG9taWNfY21w
eGNoZyhpbmRfYWRkciwgZXhwZWN0ZWQsIGV4cGVjdGVkIHwgdG9fYmVfc2V0KTsKICAgICB9IHdo
aWxlIChhY3R1YWwgIT0gZXhwZWN0ZWQpOwogICAgIHRyYWNlX3ZpcnRpb19jY3dfc2V0X2luZChp
bmRfbG9jLCBhY3R1YWwsIGFjdHVhbCB8IHRvX2JlX3NldCk7CiAgICAgY3B1X3BoeXNpY2FsX21l
bW9yeV91bm1hcCgodm9pZCAqKWluZF9hZGRyLCBsZW4sIDEsIGxlbik7CmRpZmYgLS1naXQgYS9o
dy92aXJ0aW8vdmhvc3QuYyBiL2h3L3ZpcnRpby92aG9zdC5jCmluZGV4IDFhMTM4NGU3YTYuLmVh
MTNhOTA4OTEgMTAwNjQ0Ci0tLSBhL2h3L3ZpcnRpby92aG9zdC5jCisrKyBiL2h3L3ZpcnRpby92
aG9zdC5jCkBAIC05MCw3ICs5MCw3IEBAIHN0YXRpYyB2b2lkIHZob3N0X2Rldl9zeW5jX3JlZ2lv
bihzdHJ1Y3Qgdmhvc3RfZGV2ICpkZXYsCiAgICAgICAgIH0KICAgICAgICAgLyogRGF0YSBtdXN0
IGJlIHJlYWQgYXRvbWljYWxseS4gV2UgZG9uJ3QgcmVhbGx5IG5lZWQgYmFycmllciBzZW1hbnRp
Y3MKICAgICAgICAgICogYnV0IGl0J3MgZWFzaWVyIHRvIHVzZSBhdG9taWNfKiB0aGFuIHJvbGwg
b3VyIG93bi4gKi8KLSAgICAgICAgbG9nID0gYXRvbWljX3hjaGcoZnJvbSwgMCk7CisgICAgICAg
IGxvZyA9IHFlbXVfYXRvbWljX3hjaGcoZnJvbSwgMCk7CiAgICAgICAgIHdoaWxlIChsb2cpIHsK
ICAgICAgICAgICAgIGludCBiaXQgPSBjdHpsKGxvZyk7CiAgICAgICAgICAgICBod2FkZHIgcGFn
ZV9hZGRyOwpkaWZmIC0tZ2l0IGEvaHcvdmlydGlvL3ZpcnRpby1tbWlvLmMgYi9ody92aXJ0aW8v
dmlydGlvLW1taW8uYwppbmRleCBmMTJkMTU5NWFhLi5kMDExN2EwYjZmIDEwMDY0NAotLS0gYS9o
dy92aXJ0aW8vdmlydGlvLW1taW8uYworKysgYi9ody92aXJ0aW8vdmlydGlvLW1taW8uYwpAQCAt
MTc5LDcgKzE3OSw3IEBAIHN0YXRpYyB1aW50NjRfdCB2aXJ0aW9fbW1pb19yZWFkKHZvaWQgKm9w
YXF1ZSwgaHdhZGRyIG9mZnNldCwgdW5zaWduZWQgc2l6ZSkKICAgICAgICAgfQogICAgICAgICBy
ZXR1cm4gcHJveHktPnZxc1t2ZGV2LT5xdWV1ZV9zZWxdLmVuYWJsZWQ7CiAgICAgY2FzZSBWSVJU
SU9fTU1JT19JTlRFUlJVUFRfU1RBVFVTOgotICAgICAgICByZXR1cm4gYXRvbWljX3JlYWQoJnZk
ZXYtPmlzcik7CisgICAgICAgIHJldHVybiBxZW11X2F0b21pY19yZWFkKCZ2ZGV2LT5pc3IpOwog
ICAgIGNhc2UgVklSVElPX01NSU9fU1RBVFVTOgogICAgICAgICByZXR1cm4gdmRldi0+c3RhdHVz
OwogICAgIGNhc2UgVklSVElPX01NSU9fQ09ORklHX0dFTkVSQVRJT046CkBAIC0zNzAsNyArMzcw
LDcgQEAgc3RhdGljIHZvaWQgdmlydGlvX21taW9fd3JpdGUodm9pZCAqb3BhcXVlLCBod2FkZHIg
b2Zmc2V0LCB1aW50NjRfdCB2YWx1ZSwKICAgICAgICAgfQogICAgICAgICBicmVhazsKICAgICBj
YXNlIFZJUlRJT19NTUlPX0lOVEVSUlVQVF9BQ0s6Ci0gICAgICAgIGF0b21pY19hbmQoJnZkZXYt
PmlzciwgfnZhbHVlKTsKKyAgICAgICAgcWVtdV9hdG9taWNfYW5kKCZ2ZGV2LT5pc3IsIH52YWx1
ZSk7CiAgICAgICAgIHZpcnRpb191cGRhdGVfaXJxKHZkZXYpOwogICAgICAgICBicmVhazsKICAg
ICBjYXNlIFZJUlRJT19NTUlPX1NUQVRVUzoKQEAgLTQ5Niw3ICs0OTYsNyBAQCBzdGF0aWMgdm9p
ZCB2aXJ0aW9fbW1pb191cGRhdGVfaXJxKERldmljZVN0YXRlICpvcGFxdWUsIHVpbnQxNl90IHZl
Y3RvcikKICAgICBpZiAoIXZkZXYpIHsKICAgICAgICAgcmV0dXJuOwogICAgIH0KLSAgICBsZXZl
bCA9IChhdG9taWNfcmVhZCgmdmRldi0+aXNyKSAhPSAwKTsKKyAgICBsZXZlbCA9IChxZW11X2F0
b21pY19yZWFkKCZ2ZGV2LT5pc3IpICE9IDApOwogICAgIHRyYWNlX3ZpcnRpb19tbWlvX3NldHRp
bmdfaXJxKGxldmVsKTsKICAgICBxZW11X3NldF9pcnEocHJveHktPmlycSwgbGV2ZWwpOwogfQpk
aWZmIC0tZ2l0IGEvaHcvdmlydGlvL3ZpcnRpby1wY2kuYyBiL2h3L3ZpcnRpby92aXJ0aW8tcGNp
LmMKaW5kZXggNWJjNzY5ZjY4NS4uOGRkNmEwMGVlNSAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL3Zp
cnRpby1wY2kuYworKysgYi9ody92aXJ0aW8vdmlydGlvLXBjaS5jCkBAIC03Miw3ICs3Miw3IEBA
IHN0YXRpYyB2b2lkIHZpcnRpb19wY2lfbm90aWZ5KERldmljZVN0YXRlICpkLCB1aW50MTZfdCB2
ZWN0b3IpCiAgICAgICAgIG1zaXhfbm90aWZ5KCZwcm94eS0+cGNpX2RldiwgdmVjdG9yKTsKICAg
ICBlbHNlIHsKICAgICAgICAgVmlydElPRGV2aWNlICp2ZGV2ID0gdmlydGlvX2J1c19nZXRfZGV2
aWNlKCZwcm94eS0+YnVzKTsKLSAgICAgICAgcGNpX3NldF9pcnEoJnByb3h5LT5wY2lfZGV2LCBh
dG9taWNfcmVhZCgmdmRldi0+aXNyKSAmIDEpOworICAgICAgICBwY2lfc2V0X2lycSgmcHJveHkt
PnBjaV9kZXYsIHFlbXVfYXRvbWljX3JlYWQoJnZkZXYtPmlzcikgJiAxKTsKICAgICB9CiB9CiAK
QEAgLTM5OCw3ICszOTgsNyBAQCBzdGF0aWMgdWludDMyX3QgdmlydGlvX2lvcG9ydF9yZWFkKFZp
cnRJT1BDSVByb3h5ICpwcm94eSwgdWludDMyX3QgYWRkcikKICAgICAgICAgYnJlYWs7CiAgICAg
Y2FzZSBWSVJUSU9fUENJX0lTUjoKICAgICAgICAgLyogcmVhZGluZyBmcm9tIHRoZSBJU1IgYWxz
byBjbGVhcnMgaXQuICovCi0gICAgICAgIHJldCA9IGF0b21pY194Y2hnKCZ2ZGV2LT5pc3IsIDAp
OworICAgICAgICByZXQgPSBxZW11X2F0b21pY194Y2hnKCZ2ZGV2LT5pc3IsIDApOwogICAgICAg
ICBwY2lfaXJxX2RlYXNzZXJ0KCZwcm94eS0+cGNpX2Rldik7CiAgICAgICAgIGJyZWFrOwogICAg
IGNhc2UgVklSVElPX01TSV9DT05GSUdfVkVDVE9SOgpAQCAtMTM2Miw3ICsxMzYyLDcgQEAgc3Rh
dGljIHVpbnQ2NF90IHZpcnRpb19wY2lfaXNyX3JlYWQodm9pZCAqb3BhcXVlLCBod2FkZHIgYWRk
ciwKIHsKICAgICBWaXJ0SU9QQ0lQcm94eSAqcHJveHkgPSBvcGFxdWU7CiAgICAgVmlydElPRGV2
aWNlICp2ZGV2ID0gdmlydGlvX2J1c19nZXRfZGV2aWNlKCZwcm94eS0+YnVzKTsKLSAgICB1aW50
NjRfdCB2YWwgPSBhdG9taWNfeGNoZygmdmRldi0+aXNyLCAwKTsKKyAgICB1aW50NjRfdCB2YWwg
PSBxZW11X2F0b21pY194Y2hnKCZ2ZGV2LT5pc3IsIDApOwogICAgIHBjaV9pcnFfZGVhc3NlcnQo
JnByb3h5LT5wY2lfZGV2KTsKIAogICAgIHJldHVybiB2YWw7CmRpZmYgLS1naXQgYS9ody92aXJ0
aW8vdmlydGlvLmMgYi9ody92aXJ0aW8vdmlydGlvLmMKaW5kZXggZTk4MzAyNTIxNy4uMDhmM2Mx
Y2RkNyAxMDA2NDQKLS0tIGEvaHcvdmlydGlvL3ZpcnRpby5jCisrKyBiL2h3L3ZpcnRpby92aXJ0
aW8uYwpAQCAtMTQ5LDggKzE0OSw4IEBAIHN0YXRpYyB2b2lkIHZpcnRpb192aXJ0cXVldWVfcmVz
ZXRfcmVnaW9uX2NhY2hlKHN0cnVjdCBWaXJ0UXVldWUgKnZxKQogewogICAgIFZSaW5nTWVtb3J5
UmVnaW9uQ2FjaGVzICpjYWNoZXM7CiAKLSAgICBjYWNoZXMgPSBhdG9taWNfcmVhZCgmdnEtPnZy
aW5nLmNhY2hlcyk7Ci0gICAgYXRvbWljX3JjdV9zZXQoJnZxLT52cmluZy5jYWNoZXMsIE5VTEwp
OworICAgIGNhY2hlcyA9IHFlbXVfYXRvbWljX3JlYWQoJnZxLT52cmluZy5jYWNoZXMpOworICAg
IHFlbXVfYXRvbWljX3JjdV9zZXQoJnZxLT52cmluZy5jYWNoZXMsIE5VTEwpOwogICAgIGlmIChj
YWNoZXMpIHsKICAgICAgICAgY2FsbF9yY3UoY2FjaGVzLCB2aXJ0aW9fZnJlZV9yZWdpb25fY2Fj
aGUsIHJjdSk7CiAgICAgfQpAQCAtMTk3LDcgKzE5Nyw3IEBAIHN0YXRpYyB2b2lkIHZpcnRpb19p
bml0X3JlZ2lvbl9jYWNoZShWaXJ0SU9EZXZpY2UgKnZkZXYsIGludCBuKQogICAgICAgICBnb3Rv
IGVycl9hdmFpbDsKICAgICB9CiAKLSAgICBhdG9taWNfcmN1X3NldCgmdnEtPnZyaW5nLmNhY2hl
cywgbmV3KTsKKyAgICBxZW11X2F0b21pY19yY3Vfc2V0KCZ2cS0+dnJpbmcuY2FjaGVzLCBuZXcp
OwogICAgIGlmIChvbGQpIHsKICAgICAgICAgY2FsbF9yY3Uob2xkLCB2aXJ0aW9fZnJlZV9yZWdp
b25fY2FjaGUsIHJjdSk7CiAgICAgfQpAQCAtMjgzLDcgKzI4Myw3IEBAIHN0YXRpYyB2b2lkIHZy
aW5nX3BhY2tlZF9mbGFnc193cml0ZShWaXJ0SU9EZXZpY2UgKnZkZXYsCiAvKiBDYWxsZWQgd2l0
aGluIHJjdV9yZWFkX2xvY2soKS4gICovCiBzdGF0aWMgVlJpbmdNZW1vcnlSZWdpb25DYWNoZXMg
KnZyaW5nX2dldF9yZWdpb25fY2FjaGVzKHN0cnVjdCBWaXJ0UXVldWUgKnZxKQogewotICAgIHJl
dHVybiBhdG9taWNfcmN1X3JlYWQoJnZxLT52cmluZy5jYWNoZXMpOworICAgIHJldHVybiBxZW11
X2F0b21pY19yY3VfcmVhZCgmdnEtPnZyaW5nLmNhY2hlcyk7CiB9CiAKIC8qIENhbGxlZCB3aXRo
aW4gcmN1X3JlYWRfbG9jaygpLiAgKi8KQEAgLTIwMDcsNyArMjAwNyw3IEBAIHZvaWQgdmlydGlv
X3Jlc2V0KHZvaWQgKm9wYXF1ZSkKICAgICB2ZGV2LT5xdWV1ZV9zZWwgPSAwOwogICAgIHZkZXYt
PnN0YXR1cyA9IDA7CiAgICAgdmRldi0+ZGlzYWJsZWQgPSBmYWxzZTsKLSAgICBhdG9taWNfc2V0
KCZ2ZGV2LT5pc3IsIDApOworICAgIHFlbXVfYXRvbWljX3NldCgmdmRldi0+aXNyLCAwKTsKICAg
ICB2ZGV2LT5jb25maWdfdmVjdG9yID0gVklSVElPX05PX1ZFQ1RPUjsKICAgICB2aXJ0aW9fbm90
aWZ5X3ZlY3Rvcih2ZGV2LCB2ZGV2LT5jb25maWdfdmVjdG9yKTsKIApAQCAtMjQzOSwxMyArMjQz
OSwxMyBAQCB2b2lkIHZpcnRpb19kZWxfcXVldWUoVmlydElPRGV2aWNlICp2ZGV2LCBpbnQgbikK
IAogc3RhdGljIHZvaWQgdmlydGlvX3NldF9pc3IoVmlydElPRGV2aWNlICp2ZGV2LCBpbnQgdmFs
dWUpCiB7Ci0gICAgdWludDhfdCBvbGQgPSBhdG9taWNfcmVhZCgmdmRldi0+aXNyKTsKKyAgICB1
aW50OF90IG9sZCA9IHFlbXVfYXRvbWljX3JlYWQoJnZkZXYtPmlzcik7CiAKICAgICAvKiBEbyBu
b3Qgd3JpdGUgSVNSIGlmIGl0IGRvZXMgbm90IGNoYW5nZSwgc28gdGhhdCBpdHMgY2FjaGVsaW5l
IHJlbWFpbnMKICAgICAgKiBzaGFyZWQgaW4gdGhlIGNvbW1vbiBjYXNlIHdoZXJlIHRoZSBndWVz
dCBkb2VzIG5vdCByZWFkIGl0LgogICAgICAqLwogICAgIGlmICgob2xkICYgdmFsdWUpICE9IHZh
bHVlKSB7Ci0gICAgICAgIGF0b21pY19vcigmdmRldi0+aXNyLCB2YWx1ZSk7CisgICAgICAgIHFl
bXVfYXRvbWljX29yKCZ2ZGV2LT5pc3IsIHZhbHVlKTsKICAgICB9CiB9CiAKQEAgLTMyNTQsNyAr
MzI1NCw3IEBAIHZvaWQgdmlydGlvX2luaXQoVmlydElPRGV2aWNlICp2ZGV2LCBjb25zdCBjaGFy
ICpuYW1lLAogICAgIHZkZXYtPnN0YXJ0ZWQgPSBmYWxzZTsKICAgICB2ZGV2LT5kZXZpY2VfaWQg
PSBkZXZpY2VfaWQ7CiAgICAgdmRldi0+c3RhdHVzID0gMDsKLSAgICBhdG9taWNfc2V0KCZ2ZGV2
LT5pc3IsIDApOworICAgIHFlbXVfYXRvbWljX3NldCgmdmRldi0+aXNyLCAwKTsKICAgICB2ZGV2
LT5xdWV1ZV9zZWwgPSAwOwogICAgIHZkZXYtPmNvbmZpZ192ZWN0b3IgPSBWSVJUSU9fTk9fVkVD
VE9SOwogICAgIHZkZXYtPnZxID0gZ19tYWxsb2MwKHNpemVvZihWaXJ0UXVldWUpICogVklSVElP
X1FVRVVFX01BWCk7CmRpZmYgLS1naXQgYS9ody94dGVuc2EvcGljX2NwdS5jIGIvaHcveHRlbnNh
L3BpY19jcHUuYwppbmRleCAxZDU5ODJhOWU0Li4yZDI4MzkyYjdhIDEwMDY0NAotLS0gYS9ody94
dGVuc2EvcGljX2NwdS5jCisrKyBiL2h3L3h0ZW5zYS9waWNfY3B1LmMKQEAgLTcyLDkgKzcyLDkg
QEAgc3RhdGljIHZvaWQgeHRlbnNhX3NldF9pcnEodm9pZCAqb3BhcXVlLCBpbnQgaXJxLCBpbnQg
YWN0aXZlKQogICAgICAgICB1aW50MzJfdCBpcnFfYml0ID0gMSA8PCBpcnE7CiAKICAgICAgICAg
aWYgKGFjdGl2ZSkgewotICAgICAgICAgICAgYXRvbWljX29yKCZlbnYtPnNyZWdzW0lOVFNFVF0s
IGlycV9iaXQpOworICAgICAgICAgICAgcWVtdV9hdG9taWNfb3IoJmVudi0+c3JlZ3NbSU5UU0VU
XSwgaXJxX2JpdCk7CiAgICAgICAgIH0gZWxzZSBpZiAoZW52LT5jb25maWctPmludGVycnVwdFtp
cnFdLmludHR5cGUgPT0gSU5UVFlQRV9MRVZFTCkgewotICAgICAgICAgICAgYXRvbWljX2FuZCgm
ZW52LT5zcmVnc1tJTlRTRVRdLCB+aXJxX2JpdCk7CisgICAgICAgICAgICBxZW11X2F0b21pY19h
bmQoJmVudi0+c3JlZ3NbSU5UU0VUXSwgfmlycV9iaXQpOwogICAgICAgICB9CiAKICAgICAgICAg
Y2hlY2tfaW50ZXJydXB0cyhlbnYpOwpkaWZmIC0tZ2l0IGEvaW90aHJlYWQuYyBiL2lvdGhyZWFk
LmMKaW5kZXggM2EzODYwYTA5Yy4uNTRlMmQzMGMzZCAxMDA2NDQKLS0tIGEvaW90aHJlYWQuYwor
KysgYi9pb3RocmVhZC5jCkBAIC03Niw3ICs3Niw3IEBAIHN0YXRpYyB2b2lkICppb3RocmVhZF9y
dW4odm9pZCAqb3BhcXVlKQogICAgICAgICAgKiBXZSBtdXN0IGNoZWNrIHRoZSBydW5uaW5nIHN0
YXRlIGFnYWluIGluIGNhc2UgaXQgd2FzCiAgICAgICAgICAqIGNoYW5nZWQgaW4gcHJldmlvdXMg
YWlvX3BvbGwoKQogICAgICAgICAgKi8KLSAgICAgICAgaWYgKGlvdGhyZWFkLT5ydW5uaW5nICYm
IGF0b21pY19yZWFkKCZpb3RocmVhZC0+cnVuX2djb250ZXh0KSkgeworICAgICAgICBpZiAoaW90
aHJlYWQtPnJ1bm5pbmcgJiYgcWVtdV9hdG9taWNfcmVhZCgmaW90aHJlYWQtPnJ1bl9nY29udGV4
dCkpIHsKICAgICAgICAgICAgIGdfbWFpbl9sb29wX3J1bihpb3RocmVhZC0+bWFpbl9sb29wKTsK
ICAgICAgICAgfQogICAgIH0KQEAgLTExNiw3ICsxMTYsNyBAQCBzdGF0aWMgdm9pZCBpb3RocmVh
ZF9pbnN0YW5jZV9pbml0KE9iamVjdCAqb2JqKQogICAgIGlvdGhyZWFkLT50aHJlYWRfaWQgPSAt
MTsKICAgICBxZW11X3NlbV9pbml0KCZpb3RocmVhZC0+aW5pdF9kb25lX3NlbSwgMCk7CiAgICAg
LyogQnkgZGVmYXVsdCwgd2UgZG9uJ3QgcnVuIGdjb250ZXh0ICovCi0gICAgYXRvbWljX3NldCgm
aW90aHJlYWQtPnJ1bl9nY29udGV4dCwgMCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZpb3RocmVh
ZC0+cnVuX2djb250ZXh0LCAwKTsKIH0KIAogc3RhdGljIHZvaWQgaW90aHJlYWRfaW5zdGFuY2Vf
ZmluYWxpemUoT2JqZWN0ICpvYmopCkBAIC0zNDgsNyArMzQ4LDcgQEAgSU9UaHJlYWRJbmZvTGlz
dCAqcW1wX3F1ZXJ5X2lvdGhyZWFkcyhFcnJvciAqKmVycnApCiAKIEdNYWluQ29udGV4dCAqaW90
aHJlYWRfZ2V0X2dfbWFpbl9jb250ZXh0KElPVGhyZWFkICppb3RocmVhZCkKIHsKLSAgICBhdG9t
aWNfc2V0KCZpb3RocmVhZC0+cnVuX2djb250ZXh0LCAxKTsKKyAgICBxZW11X2F0b21pY19zZXQo
JmlvdGhyZWFkLT5ydW5fZ2NvbnRleHQsIDEpOwogICAgIGFpb19ub3RpZnkoaW90aHJlYWQtPmN0
eCk7CiAgICAgcmV0dXJuIGlvdGhyZWFkLT53b3JrZXJfY29udGV4dDsKIH0KZGlmZiAtLWdpdCBh
L2xpbnV4LXVzZXIvaHBwYS9jcHVfbG9vcC5jIGIvbGludXgtdXNlci9ocHBhL2NwdV9sb29wLmMK
aW5kZXggOTkxNTQ1NmExZC4uN2VmMzEzYzMyNSAxMDA2NDQKLS0tIGEvbGludXgtdXNlci9ocHBh
L2NwdV9sb29wLmMKKysrIGIvbGludXgtdXNlci9ocHBhL2NwdV9sb29wLmMKQEAgLTM5LDcgKzM5
LDcgQEAgc3RhdGljIGFiaV91bG9uZyBocHBhX2x3cyhDUFVIUFBBU3RhdGUgKmVudikKICAgICAg
ICAgfQogICAgICAgICBvbGQgPSB0c3dhcDMyKG9sZCk7CiAgICAgICAgIG5ldyA9IHRzd2FwMzIo
bmV3KTsKLSAgICAgICAgcmV0ID0gYXRvbWljX2NtcHhjaGcoKHVpbnQzMl90ICopZzJoKGFkZHIp
LCBvbGQsIG5ldyk7CisgICAgICAgIHJldCA9IHFlbXVfYXRvbWljX2NtcHhjaGcoKHVpbnQzMl90
ICopZzJoKGFkZHIpLCBvbGQsIG5ldyk7CiAgICAgICAgIHJldCA9IHRzd2FwMzIocmV0KTsKICAg
ICAgICAgYnJlYWs7CiAKQEAgLTYwLDE5ICs2MCwxOSBAQCBzdGF0aWMgYWJpX3Vsb25nIGhwcGFf
bHdzKENQVUhQUEFTdGF0ZSAqZW52KQogICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICBvbGQg
PSAqKHVpbnQ4X3QgKilnMmgob2xkKTsKICAgICAgICAgICAgIG5ldyA9ICoodWludDhfdCAqKWcy
aChuZXcpOwotICAgICAgICAgICAgcmV0ID0gYXRvbWljX2NtcHhjaGcoKHVpbnQ4X3QgKilnMmgo
YWRkciksIG9sZCwgbmV3KTsKKyAgICAgICAgICAgIHJldCA9IHFlbXVfYXRvbWljX2NtcHhjaGco
KHVpbnQ4X3QgKilnMmgoYWRkciksIG9sZCwgbmV3KTsKICAgICAgICAgICAgIHJldCA9IHJldCAh
PSBvbGQ7CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAg
b2xkID0gKih1aW50MTZfdCAqKWcyaChvbGQpOwogICAgICAgICAgICAgbmV3ID0gKih1aW50MTZf
dCAqKWcyaChuZXcpOwotICAgICAgICAgICAgcmV0ID0gYXRvbWljX2NtcHhjaGcoKHVpbnQxNl90
ICopZzJoKGFkZHIpLCBvbGQsIG5ldyk7CisgICAgICAgICAgICByZXQgPSBxZW11X2F0b21pY19j
bXB4Y2hnKCh1aW50MTZfdCAqKWcyaChhZGRyKSwgb2xkLCBuZXcpOwogICAgICAgICAgICAgcmV0
ID0gcmV0ICE9IG9sZDsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIDI6CiAgICAg
ICAgICAgICBvbGQgPSAqKHVpbnQzMl90ICopZzJoKG9sZCk7CiAgICAgICAgICAgICBuZXcgPSAq
KHVpbnQzMl90ICopZzJoKG5ldyk7Ci0gICAgICAgICAgICByZXQgPSBhdG9taWNfY21weGNoZygo
dWludDMyX3QgKilnMmgoYWRkciksIG9sZCwgbmV3KTsKKyAgICAgICAgICAgIHJldCA9IHFlbXVf
YXRvbWljX2NtcHhjaGcoKHVpbnQzMl90ICopZzJoKGFkZHIpLCBvbGQsIG5ldyk7CiAgICAgICAg
ICAgICByZXQgPSByZXQgIT0gb2xkOwogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2Ug
MzoKQEAgLTgxLDcgKzgxLDggQEAgc3RhdGljIGFiaV91bG9uZyBocHBhX2x3cyhDUFVIUFBBU3Rh
dGUgKmVudikKICAgICAgICAgICAgICAgICBvNjQgPSAqKHVpbnQ2NF90ICopZzJoKG9sZCk7CiAg
ICAgICAgICAgICAgICAgbjY0ID0gKih1aW50NjRfdCAqKWcyaChuZXcpOwogI2lmZGVmIENPTkZJ
R19BVE9NSUM2NAotICAgICAgICAgICAgICAgIHI2NCA9IGF0b21pY19jbXB4Y2hnX19ub2NoZWNr
KCh1aW50NjRfdCAqKWcyaChhZGRyKSwgbzY0LCBuNjQpOworICAgICAgICAgICAgICAgIHI2NCA9
IHFlbXVfYXRvbWljX2NtcHhjaGdfX25vY2hlY2soKHVpbnQ2NF90ICopZzJoKGFkZHIpLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbzY0LCBuNjQp
OwogICAgICAgICAgICAgICAgIHJldCA9IHI2NCAhPSBvNjQ7CiAjZWxzZQogICAgICAgICAgICAg
ICAgIHN0YXJ0X2V4Y2x1c2l2ZSgpOwpkaWZmIC0tZ2l0IGEvbGludXgtdXNlci9zaWduYWwuYyBi
L2xpbnV4LXVzZXIvc2lnbmFsLmMKaW5kZXggOGNmNTFmZmVjZC4uYWM0ZWVlNzNmMCAxMDA2NDQK
LS0tIGEvbGludXgtdXNlci9zaWduYWwuYworKysgYi9saW51eC11c2VyL3NpZ25hbC5jCkBAIC0x
OTUsNyArMTk1LDcgQEAgaW50IGJsb2NrX3NpZ25hbHModm9pZCkKICAgICBzaWdmaWxsc2V0KCZz
ZXQpOwogICAgIHNpZ3Byb2NtYXNrKFNJR19TRVRNQVNLLCAmc2V0LCAwKTsKIAotICAgIHJldHVy
biBhdG9taWNfeGNoZygmdHMtPnNpZ25hbF9wZW5kaW5nLCAxKTsKKyAgICByZXR1cm4gcWVtdV9h
dG9taWNfeGNoZygmdHMtPnNpZ25hbF9wZW5kaW5nLCAxKTsKIH0KIAogLyogV3JhcHBlciBmb3Ig
c2lncHJvY21hc2sgZnVuY3Rpb24KQEAgLTY4OCw3ICs2ODgsNyBAQCBpbnQgcXVldWVfc2lnbmFs
KENQVUFyY2hTdGF0ZSAqZW52LCBpbnQgc2lnLCBpbnQgc2lfdHlwZSwKICAgICB0cy0+c3luY19z
aWduYWwuaW5mbyA9ICppbmZvOwogICAgIHRzLT5zeW5jX3NpZ25hbC5wZW5kaW5nID0gc2lnOwog
ICAgIC8qIHNpZ25hbCB0aGF0IGEgbmV3IHNpZ25hbCBpcyBwZW5kaW5nICovCi0gICAgYXRvbWlj
X3NldCgmdHMtPnNpZ25hbF9wZW5kaW5nLCAxKTsKKyAgICBxZW11X2F0b21pY19zZXQoJnRzLT5z
aWduYWxfcGVuZGluZywgMSk7CiAgICAgcmV0dXJuIDE7IC8qIGluZGljYXRlcyB0aGF0IHRoZSBz
aWduYWwgd2FzIHF1ZXVlZCAqLwogfQogCkBAIC0xMDA1LDcgKzEwMDUsNyBAQCB2b2lkIHByb2Nl
c3NfcGVuZGluZ19zaWduYWxzKENQVUFyY2hTdGF0ZSAqY3B1X2VudikKICAgICBzaWdzZXRfdCBz
ZXQ7CiAgICAgc2lnc2V0X3QgKmJsb2NrZWRfc2V0OwogCi0gICAgd2hpbGUgKGF0b21pY19yZWFk
KCZ0cy0+c2lnbmFsX3BlbmRpbmcpKSB7CisgICAgd2hpbGUgKHFlbXVfYXRvbWljX3JlYWQoJnRz
LT5zaWduYWxfcGVuZGluZykpIHsKICAgICAgICAgLyogRklYTUU6IFRoaXMgaXMgbm90IHRocmVh
ZHNhZmUuICAqLwogICAgICAgICBzaWdmaWxsc2V0KCZzZXQpOwogICAgICAgICBzaWdwcm9jbWFz
ayhTSUdfU0VUTUFTSywgJnNldCwgMCk7CkBAIC0xMDQ5LDcgKzEwNDksNyBAQCB2b2lkIHByb2Nl
c3NfcGVuZGluZ19zaWduYWxzKENQVUFyY2hTdGF0ZSAqY3B1X2VudikKICAgICAgICAgICogb2Yg
dW5ibG9ja2luZyBtaWdodCBjYXVzZSB1cyB0byB0YWtlIGFub3RoZXIgaG9zdCBzaWduYWwgd2hp
Y2gKICAgICAgICAgICogd2lsbCBzZXQgc2lnbmFsX3BlbmRpbmcgYWdhaW4pLgogICAgICAgICAg
Ki8KLSAgICAgICAgYXRvbWljX3NldCgmdHMtPnNpZ25hbF9wZW5kaW5nLCAwKTsKKyAgICAgICAg
cWVtdV9hdG9taWNfc2V0KCZ0cy0+c2lnbmFsX3BlbmRpbmcsIDApOwogICAgICAgICB0cy0+aW5f
c2lnc3VzcGVuZCA9IDA7CiAgICAgICAgIHNldCA9IHRzLT5zaWduYWxfbWFzazsKICAgICAgICAg
c2lnZGVsc2V0KCZzZXQsIFNJR1NFR1YpOwpkaWZmIC0tZ2l0IGEvbWlncmF0aW9uL2NvbG8tZmFp
bG92ZXIuYyBiL21pZ3JhdGlvbi9jb2xvLWZhaWxvdmVyLmMKaW5kZXggZTljYTBiNDc3NC4uYjk2
MWQyNTFmYSAxMDA2NDQKLS0tIGEvbWlncmF0aW9uL2NvbG8tZmFpbG92ZXIuYworKysgYi9taWdy
YXRpb24vY29sby1mYWlsb3Zlci5jCkBAIC02Myw3ICs2Myw3IEBAIEZhaWxvdmVyU3RhdHVzIGZh
aWxvdmVyX3NldF9zdGF0ZShGYWlsb3ZlclN0YXR1cyBvbGRfc3RhdGUsCiB7CiAgICAgRmFpbG92
ZXJTdGF0dXMgb2xkOwogCi0gICAgb2xkID0gYXRvbWljX2NtcHhjaGcoJmZhaWxvdmVyX3N0YXRl
LCBvbGRfc3RhdGUsIG5ld19zdGF0ZSk7CisgICAgb2xkID0gcWVtdV9hdG9taWNfY21weGNoZygm
ZmFpbG92ZXJfc3RhdGUsIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKTsKICAgICBpZiAob2xkID09IG9s
ZF9zdGF0ZSkgewogICAgICAgICB0cmFjZV9jb2xvX2ZhaWxvdmVyX3NldF9zdGF0ZShGYWlsb3Zl
clN0YXR1c19zdHIobmV3X3N0YXRlKSk7CiAgICAgfQpAQCAtNzIsNyArNzIsNyBAQCBGYWlsb3Zl
clN0YXR1cyBmYWlsb3Zlcl9zZXRfc3RhdGUoRmFpbG92ZXJTdGF0dXMgb2xkX3N0YXRlLAogCiBG
YWlsb3ZlclN0YXR1cyBmYWlsb3Zlcl9nZXRfc3RhdGUodm9pZCkKIHsKLSAgICByZXR1cm4gYXRv
bWljX3JlYWQoJmZhaWxvdmVyX3N0YXRlKTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfcmVhZCgm
ZmFpbG92ZXJfc3RhdGUpOwogfQogCiB2b2lkIHFtcF94X2NvbG9fbG9zdF9oZWFydGJlYXQoRXJy
b3IgKiplcnJwKQpkaWZmIC0tZ2l0IGEvbWlncmF0aW9uL21pZ3JhdGlvbi5jIGIvbWlncmF0aW9u
L21pZ3JhdGlvbi5jCmluZGV4IDU4YTU0NTI0NzEuLjA0NGU3YzFmZTcgMTAwNjQ0Ci0tLSBhL21p
Z3JhdGlvbi9taWdyYXRpb24uYworKysgYi9taWdyYXRpb24vbWlncmF0aW9uLmMKQEAgLTE1OTUs
NyArMTU5NSw3IEBAIHZvaWQgcW1wX21pZ3JhdGVfc3RhcnRfcG9zdGNvcHkoRXJyb3IgKiplcnJw
KQogICAgICAqIHdlIGRvbid0IGVycm9yIGlmIG1pZ3JhdGlvbiBoYXMgZmluaXNoZWQgc2luY2Ug
dGhhdCB3b3VsZCBiZSByYWN5CiAgICAgICogd2l0aCBpc3N1aW5nIHRoaXMgY29tbWFuZC4KICAg
ICAgKi8KLSAgICBhdG9taWNfc2V0KCZzLT5zdGFydF9wb3N0Y29weSwgdHJ1ZSk7CisgICAgcWVt
dV9hdG9taWNfc2V0KCZzLT5zdGFydF9wb3N0Y29weSwgdHJ1ZSk7CiB9CiAKIC8qIHNoYXJlZCBt
aWdyYXRpb24gaGVscGVycyAqLwpAQCAtMTYwMyw3ICsxNjAzLDcgQEAgdm9pZCBxbXBfbWlncmF0
ZV9zdGFydF9wb3N0Y29weShFcnJvciAqKmVycnApCiB2b2lkIG1pZ3JhdGVfc2V0X3N0YXRlKGlu
dCAqc3RhdGUsIGludCBvbGRfc3RhdGUsIGludCBuZXdfc3RhdGUpCiB7CiAgICAgYXNzZXJ0KG5l
d19zdGF0ZSA8IE1JR1JBVElPTl9TVEFUVVNfX01BWCk7Ci0gICAgaWYgKGF0b21pY19jbXB4Y2hn
KHN0YXRlLCBvbGRfc3RhdGUsIG5ld19zdGF0ZSkgPT0gb2xkX3N0YXRlKSB7CisgICAgaWYgKHFl
bXVfYXRvbWljX2NtcHhjaGcoc3RhdGUsIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKSA9PSBvbGRfc3Rh
dGUpIHsKICAgICAgICAgdHJhY2VfbWlncmF0ZV9zZXRfc3RhdGUoTWlncmF0aW9uU3RhdHVzX3N0
cihuZXdfc3RhdGUpKTsKICAgICAgICAgbWlncmF0ZV9nZW5lcmF0ZV9ldmVudChuZXdfc3RhdGUp
OwogICAgIH0KQEAgLTE5NTQsNyArMTk1NCw3IEBAIHZvaWQgcW1wX21pZ3JhdGVfcmVjb3Zlcihj
b25zdCBjaGFyICp1cmksIEVycm9yICoqZXJycCkKICAgICAgICAgcmV0dXJuOwogICAgIH0KIAot
ICAgIGlmIChhdG9taWNfY21weGNoZygmbWlzLT5wb3N0Y29weV9yZWNvdmVyX3RyaWdnZXJlZCwK
KyAgICBpZiAocWVtdV9hdG9taWNfY21weGNoZygmbWlzLT5wb3N0Y29weV9yZWNvdmVyX3RyaWdn
ZXJlZCwKICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UsIHRydWUpID09IHRydWUpIHsKICAg
ICAgICAgZXJyb3Jfc2V0ZyhlcnJwLCAiTWlncmF0ZSByZWNvdmVyeSBpcyB0cmlnZ2VyZWQgYWxy
ZWFkeSIpOwogICAgICAgICByZXR1cm47CkBAIC0zMzI5LDcgKzMzMjksNyBAQCBzdGF0aWMgTWln
SXRlcmF0ZVN0YXRlIG1pZ3JhdGlvbl9pdGVyYXRpb25fcnVuKE1pZ3JhdGlvblN0YXRlICpzKQog
ICAgIGlmIChwZW5kaW5nX3NpemUgJiYgcGVuZGluZ19zaXplID49IHMtPnRocmVzaG9sZF9zaXpl
KSB7CiAgICAgICAgIC8qIFN0aWxsIGEgc2lnbmlmaWNhbnQgYW1vdW50IHRvIHRyYW5zZmVyICov
CiAgICAgICAgIGlmICghaW5fcG9zdGNvcHkgJiYgcGVuZF9wcmUgPD0gcy0+dGhyZXNob2xkX3Np
emUgJiYKLSAgICAgICAgICAgIGF0b21pY19yZWFkKCZzLT5zdGFydF9wb3N0Y29weSkpIHsKKyAg
ICAgICAgICAgIHFlbXVfYXRvbWljX3JlYWQoJnMtPnN0YXJ0X3Bvc3Rjb3B5KSkgewogICAgICAg
ICAgICAgaWYgKHBvc3Rjb3B5X3N0YXJ0KHMpKSB7CiAgICAgICAgICAgICAgICAgZXJyb3JfcmVw
b3J0KCIlczogcG9zdGNvcHkgZmFpbGVkIHRvIHN0YXJ0IiwgX19mdW5jX18pOwogICAgICAgICAg
ICAgfQpkaWZmIC0tZ2l0IGEvbWlncmF0aW9uL211bHRpZmQuYyBiL21pZ3JhdGlvbi9tdWx0aWZk
LmMKaW5kZXggZDA0NDEyMDJhYS4uOTRjOTY3OTI2MiAxMDA2NDQKLS0tIGEvbWlncmF0aW9uL211
bHRpZmQuYworKysgYi9taWdyYXRpb24vbXVsdGlmZC5jCkBAIC00MTAsNyArNDEwLDcgQEAgc3Rh
dGljIGludCBtdWx0aWZkX3NlbmRfcGFnZXMoUUVNVUZpbGUgKmYpCiAgICAgTXVsdGlGRFBhZ2Vz
X3QgKnBhZ2VzID0gbXVsdGlmZF9zZW5kX3N0YXRlLT5wYWdlczsKICAgICB1aW50NjRfdCB0cmFu
c2ZlcnJlZDsKIAotICAgIGlmIChhdG9taWNfcmVhZCgmbXVsdGlmZF9zZW5kX3N0YXRlLT5leGl0
aW5nKSkgeworICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZtdWx0aWZkX3NlbmRfc3RhdGUtPmV4
aXRpbmcpKSB7CiAgICAgICAgIHJldHVybiAtMTsKICAgICB9CiAKQEAgLTUwOCw3ICs1MDgsNyBA
QCBzdGF0aWMgdm9pZCBtdWx0aWZkX3NlbmRfdGVybWluYXRlX3RocmVhZHMoRXJyb3IgKmVycikK
ICAgICAgKiB0aHJlYWRzIGF0IHRoZSBzYW1lIHRpbWUsIHdlIGNhbiBlbmQgY2FsbGluZyB0aGlz
IGZ1bmN0aW9uCiAgICAgICogdHdpY2UuCiAgICAgICovCi0gICAgaWYgKGF0b21pY194Y2hnKCZt
dWx0aWZkX3NlbmRfc3RhdGUtPmV4aXRpbmcsIDEpKSB7CisgICAgaWYgKHFlbXVfYXRvbWljX3hj
aGcoJm11bHRpZmRfc2VuZF9zdGF0ZS0+ZXhpdGluZywgMSkpIHsKICAgICAgICAgcmV0dXJuOwog
ICAgIH0KIApAQCAtNjMyLDcgKzYzMiw3IEBAIHN0YXRpYyB2b2lkICptdWx0aWZkX3NlbmRfdGhy
ZWFkKHZvaWQgKm9wYXF1ZSkKICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICBxZW11X3NlbV93
YWl0KCZwLT5zZW0pOwogCi0gICAgICAgIGlmIChhdG9taWNfcmVhZCgmbXVsdGlmZF9zZW5kX3N0
YXRlLT5leGl0aW5nKSkgeworICAgICAgICBpZiAocWVtdV9hdG9taWNfcmVhZCgmbXVsdGlmZF9z
ZW5kX3N0YXRlLT5leGl0aW5nKSkgewogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KICAg
ICAgICAgcWVtdV9tdXRleF9sb2NrKCZwLT5tdXRleCk7CkBAIC03NjAsNyArNzYwLDcgQEAgaW50
IG11bHRpZmRfc2F2ZV9zZXR1cChFcnJvciAqKmVycnApCiAgICAgbXVsdGlmZF9zZW5kX3N0YXRl
LT5wYXJhbXMgPSBnX25ldzAoTXVsdGlGRFNlbmRQYXJhbXMsIHRocmVhZF9jb3VudCk7CiAgICAg
bXVsdGlmZF9zZW5kX3N0YXRlLT5wYWdlcyA9IG11bHRpZmRfcGFnZXNfaW5pdChwYWdlX2NvdW50
KTsKICAgICBxZW11X3NlbV9pbml0KCZtdWx0aWZkX3NlbmRfc3RhdGUtPmNoYW5uZWxzX3JlYWR5
LCAwKTsKLSAgICBhdG9taWNfc2V0KCZtdWx0aWZkX3NlbmRfc3RhdGUtPmV4aXRpbmcsIDApOwor
ICAgIHFlbXVfYXRvbWljX3NldCgmbXVsdGlmZF9zZW5kX3N0YXRlLT5leGl0aW5nLCAwKTsKICAg
ICBtdWx0aWZkX3NlbmRfc3RhdGUtPm9wcyA9IG11bHRpZmRfb3BzW21pZ3JhdGVfbXVsdGlmZF9j
b21wcmVzc2lvbigpXTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCB0aHJlYWRfY291bnQ7IGkrKykg
ewpAQCAtOTk3LDcgKzk5Nyw3IEBAIGludCBtdWx0aWZkX2xvYWRfc2V0dXAoRXJyb3IgKiplcnJw
KQogICAgIHRocmVhZF9jb3VudCA9IG1pZ3JhdGVfbXVsdGlmZF9jaGFubmVscygpOwogICAgIG11
bHRpZmRfcmVjdl9zdGF0ZSA9IGdfbWFsbG9jMChzaXplb2YoKm11bHRpZmRfcmVjdl9zdGF0ZSkp
OwogICAgIG11bHRpZmRfcmVjdl9zdGF0ZS0+cGFyYW1zID0gZ19uZXcwKE11bHRpRkRSZWN2UGFy
YW1zLCB0aHJlYWRfY291bnQpOwotICAgIGF0b21pY19zZXQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+
Y291bnQsIDApOworICAgIHFlbXVfYXRvbWljX3NldCgmbXVsdGlmZF9yZWN2X3N0YXRlLT5jb3Vu
dCwgMCk7CiAgICAgcWVtdV9zZW1faW5pdCgmbXVsdGlmZF9yZWN2X3N0YXRlLT5zZW1fc3luYywg
MCk7CiAgICAgbXVsdGlmZF9yZWN2X3N0YXRlLT5vcHMgPSBtdWx0aWZkX29wc1ttaWdyYXRlX211
bHRpZmRfY29tcHJlc3Npb24oKV07CiAKQEAgLTEwMzcsNyArMTAzNyw3IEBAIGJvb2wgbXVsdGlm
ZF9yZWN2X2FsbF9jaGFubmVsc19jcmVhdGVkKHZvaWQpCiAgICAgICAgIHJldHVybiB0cnVlOwog
ICAgIH0KIAotICAgIHJldHVybiB0aHJlYWRfY291bnQgPT0gYXRvbWljX3JlYWQoJm11bHRpZmRf
cmVjdl9zdGF0ZS0+Y291bnQpOworICAgIHJldHVybiB0aHJlYWRfY291bnQgPT0gcWVtdV9hdG9t
aWNfcmVhZCgmbXVsdGlmZF9yZWN2X3N0YXRlLT5jb3VudCk7CiB9CiAKIC8qCkBAIC0xMDU4LDcg
KzEwNTgsNyBAQCBib29sIG11bHRpZmRfcmVjdl9uZXdfY2hhbm5lbChRSU9DaGFubmVsICppb2Ms
IEVycm9yICoqZXJycCkKICAgICAgICAgZXJyb3JfcHJvcGFnYXRlX3ByZXBlbmQoZXJycCwgbG9j
YWxfZXJyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmFpbGVkIHRvIHJlY2Vp
dmUgcGFja2V0IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIHZpYSBtdWx0aWZk
IGNoYW5uZWwgJWQ6ICIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0b21pY19y
ZWFkKCZtdWx0aWZkX3JlY3Zfc3RhdGUtPmNvdW50KSk7CisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHFlbXVfYXRvbWljX3JlYWQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpKTsK
ICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KICAgICB0cmFjZV9tdWx0aWZkX3JlY3ZfbmV3
X2NoYW5uZWwoaWQpOwpAQCAtMTA3OSw3ICsxMDc5LDcgQEAgYm9vbCBtdWx0aWZkX3JlY3ZfbmV3
X2NoYW5uZWwoUUlPQ2hhbm5lbCAqaW9jLCBFcnJvciAqKmVycnApCiAgICAgcC0+cnVubmluZyA9
IHRydWU7CiAgICAgcWVtdV90aHJlYWRfY3JlYXRlKCZwLT50aHJlYWQsIHAtPm5hbWUsIG11bHRp
ZmRfcmVjdl90aHJlYWQsIHAsCiAgICAgICAgICAgICAgICAgICAgICAgIFFFTVVfVEhSRUFEX0pP
SU5BQkxFKTsKLSAgICBhdG9taWNfaW5jKCZtdWx0aWZkX3JlY3Zfc3RhdGUtPmNvdW50KTsKLSAg
ICByZXR1cm4gYXRvbWljX3JlYWQoJm11bHRpZmRfcmVjdl9zdGF0ZS0+Y291bnQpID09CisgICAg
cWVtdV9hdG9taWNfaW5jKCZtdWx0aWZkX3JlY3Zfc3RhdGUtPmNvdW50KTsKKyAgICByZXR1cm4g
cWVtdV9hdG9taWNfcmVhZCgmbXVsdGlmZF9yZWN2X3N0YXRlLT5jb3VudCkgPT0KICAgICAgICAg
ICAgbWlncmF0ZV9tdWx0aWZkX2NoYW5uZWxzKCk7CiB9CmRpZmYgLS1naXQgYS9taWdyYXRpb24v
cG9zdGNvcHktcmFtLmMgYi9taWdyYXRpb24vcG9zdGNvcHktcmFtLmMKaW5kZXggMWJiMjJmMmI2
Yy4uMDhjYTI2NWQ1YSAxMDA2NDQKLS0tIGEvbWlncmF0aW9uL3Bvc3Rjb3B5LXJhbS5jCisrKyBi
L21pZ3JhdGlvbi9wb3N0Y29weS1yYW0uYwpAQCAtNTMwLDcgKzUzMCw3IEBAIGludCBwb3N0Y29w
eV9yYW1faW5jb21pbmdfY2xlYW51cChNaWdyYXRpb25JbmNvbWluZ1N0YXRlICptaXMpCiAgICAg
ICAgIEVycm9yICpsb2NhbF9lcnIgPSBOVUxMOwogCiAgICAgICAgIC8qIExldCB0aGUgZmF1bHQg
dGhyZWFkIHF1aXQgKi8KLSAgICAgICAgYXRvbWljX3NldCgmbWlzLT5mYXVsdF90aHJlYWRfcXVp
dCwgMSk7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmbWlzLT5mYXVsdF90aHJlYWRfcXVpdCwg
MSk7CiAgICAgICAgIHBvc3Rjb3B5X2ZhdWx0X3RocmVhZF9ub3RpZnkobWlzKTsKICAgICAgICAg
dHJhY2VfcG9zdGNvcHlfcmFtX2luY29taW5nX2NsZWFudXBfam9pbigpOwogICAgICAgICBxZW11
X3RocmVhZF9qb2luKCZtaXMtPmZhdWx0X3RocmVhZCk7CkBAIC03NDIsMTIgKzc0MiwxMiBAQCBz
dGF0aWMgdm9pZCBtYXJrX3Bvc3Rjb3B5X2Jsb2NrdGltZV9iZWdpbih1aW50cHRyX3QgYWRkciwg
dWludDMyX3QgcHRpZCwKIAogICAgIGxvd190aW1lX29mZnNldCA9IGdldF9sb3dfdGltZV9vZmZz
ZXQoZGMpOwogICAgIGlmIChkYy0+dmNwdV9hZGRyW2NwdV0gPT0gMCkgewotICAgICAgICBhdG9t
aWNfaW5jKCZkYy0+c21wX2NwdXNfZG93bik7CisgICAgICAgIHFlbXVfYXRvbWljX2luYygmZGMt
PnNtcF9jcHVzX2Rvd24pOwogICAgIH0KIAotICAgIGF0b21pY194Y2hnKCZkYy0+bGFzdF9iZWdp
biwgbG93X3RpbWVfb2Zmc2V0KTsKLSAgICBhdG9taWNfeGNoZygmZGMtPnBhZ2VfZmF1bHRfdmNw
dV90aW1lW2NwdV0sIGxvd190aW1lX29mZnNldCk7Ci0gICAgYXRvbWljX3hjaGcoJmRjLT52Y3B1
X2FkZHJbY3B1XSwgYWRkcik7CisgICAgcWVtdV9hdG9taWNfeGNoZygmZGMtPmxhc3RfYmVnaW4s
IGxvd190aW1lX29mZnNldCk7CisgICAgcWVtdV9hdG9taWNfeGNoZygmZGMtPnBhZ2VfZmF1bHRf
dmNwdV90aW1lW2NwdV0sIGxvd190aW1lX29mZnNldCk7CisgICAgcWVtdV9hdG9taWNfeGNoZygm
ZGMtPnZjcHVfYWRkcltjcHVdLCBhZGRyKTsKIAogICAgIC8qCiAgICAgICogY2hlY2sgaXQgaGVy
ZSwgbm90IGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGZ1bmN0aW9uLApAQCAtNzU2LDkgKzc1Niw5
IEBAIHN0YXRpYyB2b2lkIG1hcmtfcG9zdGNvcHlfYmxvY2t0aW1lX2JlZ2luKHVpbnRwdHJfdCBh
ZGRyLCB1aW50MzJfdCBwdGlkLAogICAgICAqLwogICAgIGFscmVhZHlfcmVjZWl2ZWQgPSByYW1i
bG9ja19yZWN2X2JpdG1hcF90ZXN0KHJiLCAodm9pZCAqKWFkZHIpOwogICAgIGlmIChhbHJlYWR5
X3JlY2VpdmVkKSB7Ci0gICAgICAgIGF0b21pY194Y2hnKCZkYy0+dmNwdV9hZGRyW2NwdV0sIDAp
OwotICAgICAgICBhdG9taWNfeGNoZygmZGMtPnBhZ2VfZmF1bHRfdmNwdV90aW1lW2NwdV0sIDAp
OwotICAgICAgICBhdG9taWNfZGVjKCZkYy0+c21wX2NwdXNfZG93bik7CisgICAgICAgIHFlbXVf
YXRvbWljX3hjaGcoJmRjLT52Y3B1X2FkZHJbY3B1XSwgMCk7CisgICAgICAgIHFlbXVfYXRvbWlj
X3hjaGcoJmRjLT5wYWdlX2ZhdWx0X3ZjcHVfdGltZVtjcHVdLCAwKTsKKyAgICAgICAgcWVtdV9h
dG9taWNfZGVjKCZkYy0+c21wX2NwdXNfZG93bik7CiAgICAgfQogICAgIHRyYWNlX21hcmtfcG9z
dGNvcHlfYmxvY2t0aW1lX2JlZ2luKGFkZHIsIGRjLCBkYy0+cGFnZV9mYXVsdF92Y3B1X3RpbWVb
Y3B1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcHUsIGFscmVh
ZHlfcmVjZWl2ZWQpOwpAQCAtODEzLDI4ICs4MTMsMjkgQEAgc3RhdGljIHZvaWQgbWFya19wb3N0
Y29weV9ibG9ja3RpbWVfZW5kKHVpbnRwdHJfdCBhZGRyKQogICAgIGZvciAoaSA9IDA7IGkgPCBz
bXBfY3B1czsgaSsrKSB7CiAgICAgICAgIHVpbnQzMl90IHZjcHVfYmxvY2t0aW1lID0gMDsKIAot
ICAgICAgICByZWFkX3ZjcHVfdGltZSA9IGF0b21pY19mZXRjaF9hZGQoJmRjLT5wYWdlX2ZhdWx0
X3ZjcHVfdGltZVtpXSwgMCk7Ci0gICAgICAgIGlmIChhdG9taWNfZmV0Y2hfYWRkKCZkYy0+dmNw
dV9hZGRyW2ldLCAwKSAhPSBhZGRyIHx8CisgICAgICAgIHJlYWRfdmNwdV90aW1lID0KKyAgICAg
ICAgICAgIHFlbXVfYXRvbWljX2ZldGNoX2FkZCgmZGMtPnBhZ2VfZmF1bHRfdmNwdV90aW1lW2ld
LCAwKTsKKyAgICAgICAgaWYgKHFlbXVfYXRvbWljX2ZldGNoX2FkZCgmZGMtPnZjcHVfYWRkcltp
XSwgMCkgIT0gYWRkciB8fAogICAgICAgICAgICAgcmVhZF92Y3B1X3RpbWUgPT0gMCkgewogICAg
ICAgICAgICAgY29udGludWU7CiAgICAgICAgIH0KLSAgICAgICAgYXRvbWljX3hjaGcoJmRjLT52
Y3B1X2FkZHJbaV0sIDApOworICAgICAgICBxZW11X2F0b21pY194Y2hnKCZkYy0+dmNwdV9hZGRy
W2ldLCAwKTsKICAgICAgICAgdmNwdV9ibG9ja3RpbWUgPSBsb3dfdGltZV9vZmZzZXQgLSByZWFk
X3ZjcHVfdGltZTsKICAgICAgICAgYWZmZWN0ZWRfY3B1ICs9IDE7CiAgICAgICAgIC8qIHdlIG5l
ZWQgdG8ga25vdyBpcyB0aGF0IG1hcmtfcG9zdGNvcHlfZW5kIHdhcyBkdWUgdG8KICAgICAgICAg
ICogZmF1bHRlZCBwYWdlLCBhbm90aGVyIHBvc3NpYmxlIGNhc2UgaXQncyBwcmVmZXRjaGVkCiAg
ICAgICAgICAqIHBhZ2UgYW5kIGluIHRoYXQgY2FzZSB3ZSBzaG91bGRuJ3QgYmUgaGVyZSAqLwog
ICAgICAgICBpZiAoIXZjcHVfdG90YWxfYmxvY2t0aW1lICYmCi0gICAgICAgICAgICBhdG9taWNf
ZmV0Y2hfYWRkKCZkYy0+c21wX2NwdXNfZG93biwgMCkgPT0gc21wX2NwdXMpIHsKKyAgICAgICAg
ICAgIHFlbXVfYXRvbWljX2ZldGNoX2FkZCgmZGMtPnNtcF9jcHVzX2Rvd24sIDApID09IHNtcF9j
cHVzKSB7CiAgICAgICAgICAgICB2Y3B1X3RvdGFsX2Jsb2NrdGltZSA9IHRydWU7CiAgICAgICAg
IH0KICAgICAgICAgLyogY29udGludWUgY3ljbGUsIGR1ZSB0byBvbmUgcGFnZSBjb3VsZCBhZmZl
Y3Qgc2V2ZXJhbCB2Q1BVcyAqLwogICAgICAgICBkYy0+dmNwdV9ibG9ja3RpbWVbaV0gKz0gdmNw
dV9ibG9ja3RpbWU7CiAgICAgfQogCi0gICAgYXRvbWljX3N1YigmZGMtPnNtcF9jcHVzX2Rvd24s
IGFmZmVjdGVkX2NwdSk7CisgICAgcWVtdV9hdG9taWNfc3ViKCZkYy0+c21wX2NwdXNfZG93biwg
YWZmZWN0ZWRfY3B1KTsKICAgICBpZiAodmNwdV90b3RhbF9ibG9ja3RpbWUpIHsKLSAgICAgICAg
ZGMtPnRvdGFsX2Jsb2NrdGltZSArPSBsb3dfdGltZV9vZmZzZXQgLSBhdG9taWNfZmV0Y2hfYWRk
KAorICAgICAgICBkYy0+dG90YWxfYmxvY2t0aW1lICs9IGxvd190aW1lX29mZnNldCAtIHFlbXVf
YXRvbWljX2ZldGNoX2FkZCgKICAgICAgICAgICAgICAgICAmZGMtPmxhc3RfYmVnaW4sIDApOwog
ICAgIH0KICAgICB0cmFjZV9tYXJrX3Bvc3Rjb3B5X2Jsb2NrdGltZV9lbmQoYWRkciwgZGMsIGRj
LT50b3RhbF9ibG9ja3RpbWUsCkBAIC05MjgsNyArOTI5LDcgQEAgc3RhdGljIHZvaWQgKnBvc3Rj
b3B5X3JhbV9mYXVsdF90aHJlYWQodm9pZCAqb3BhcXVlKQogICAgICAgICAgICAgICAgIGVycm9y
X3JlcG9ydCgiJXM6IHJlYWQoKSBmYWlsZWQiLCBfX2Z1bmNfXyk7CiAgICAgICAgICAgICB9CiAK
LSAgICAgICAgICAgIGlmIChhdG9taWNfcmVhZCgmbWlzLT5mYXVsdF90aHJlYWRfcXVpdCkpIHsK
KyAgICAgICAgICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZtaXMtPmZhdWx0X3RocmVhZF9xdWl0
KSkgewogICAgICAgICAgICAgICAgIHRyYWNlX3Bvc3Rjb3B5X3JhbV9mYXVsdF90aHJlYWRfcXVp
dCgpOwogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgfQpAQCAtMTQxMCwxMyAr
MTQxMSwxMyBAQCBzdGF0aWMgUG9zdGNvcHlTdGF0ZSBpbmNvbWluZ19wb3N0Y29weV9zdGF0ZTsK
IAogUG9zdGNvcHlTdGF0ZSAgcG9zdGNvcHlfc3RhdGVfZ2V0KHZvaWQpCiB7Ci0gICAgcmV0dXJu
IGF0b21pY19tYl9yZWFkKCZpbmNvbWluZ19wb3N0Y29weV9zdGF0ZSk7CisgICAgcmV0dXJuIHFl
bXVfYXRvbWljX21iX3JlYWQoJmluY29taW5nX3Bvc3Rjb3B5X3N0YXRlKTsKIH0KIAogLyogU2V0
IHRoZSBzdGF0ZSBhbmQgcmV0dXJuIHRoZSBvbGQgc3RhdGUgKi8KIFBvc3Rjb3B5U3RhdGUgcG9z
dGNvcHlfc3RhdGVfc2V0KFBvc3Rjb3B5U3RhdGUgbmV3X3N0YXRlKQogewotICAgIHJldHVybiBh
dG9taWNfeGNoZygmaW5jb21pbmdfcG9zdGNvcHlfc3RhdGUsIG5ld19zdGF0ZSk7CisgICAgcmV0
dXJuIHFlbXVfYXRvbWljX3hjaGcoJmluY29taW5nX3Bvc3Rjb3B5X3N0YXRlLCBuZXdfc3RhdGUp
OwogfQogCiAvKiBSZWdpc3RlciBhIGhhbmRsZXIgZm9yIGV4dGVybmFsIHNoYXJlZCBtZW1vcnkg
cG9zdGNvcHkKZGlmZiAtLWdpdCBhL21pZ3JhdGlvbi9yZG1hLmMgYi9taWdyYXRpb24vcmRtYS5j
CmluZGV4IDFkYzU2M2VjM2YuLmM0YTM4MDM0OGQgMTAwNjQ0Ci0tLSBhL21pZ3JhdGlvbi9yZG1h
LmMKKysrIGIvbWlncmF0aW9uL3JkbWEuYwpAQCAtMjY4MCw3ICsyNjgwLDcgQEAgc3RhdGljIHNz
aXplX3QgcWlvX2NoYW5uZWxfcmRtYV93cml0ZXYoUUlPQ2hhbm5lbCAqaW9jLAogICAgIHNpemVf
dCBsZW4gPSAwOwogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgpOwotICAgIHJkbWEgPSBhdG9t
aWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFvdXQpOworICAgIHJkbWEgPSBxZW11X2F0b21pY19yY3Vf
cmVhZCgmcmlvYy0+cmRtYW91dCk7CiAKICAgICBpZiAoIXJkbWEpIHsKICAgICAgICAgcmV0dXJu
IC1FSU87CkBAIC0yNzYyLDcgKzI3NjIsNyBAQCBzdGF0aWMgc3NpemVfdCBxaW9fY2hhbm5lbF9y
ZG1hX3JlYWR2KFFJT0NoYW5uZWwgKmlvYywKICAgICBzaXplX3QgZG9uZSA9IDA7CiAKICAgICBS
Q1VfUkVBRF9MT0NLX0dVQVJEKCk7Ci0gICAgcmRtYSA9IGF0b21pY19yY3VfcmVhZCgmcmlvYy0+
cmRtYWluKTsKKyAgICByZG1hID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFpbik7
CiAKICAgICBpZiAoIXJkbWEpIHsKICAgICAgICAgcmV0dXJuIC1FSU87CkBAIC0yODc3LDkgKzI4
NzcsOSBAQCBxaW9fY2hhbm5lbF9yZG1hX3NvdXJjZV9wcmVwYXJlKEdTb3VyY2UgKnNvdXJjZSwK
IAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsKICAgICBpZiAocnNvdXJjZS0+Y29uZGl0aW9u
ID09IEdfSU9fSU4pIHsKLSAgICAgICAgcmRtYSA9IGF0b21pY19yY3VfcmVhZCgmcnNvdXJjZS0+
cmlvYy0+cmRtYWluKTsKKyAgICAgICAgcmRtYSA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZyc291
cmNlLT5yaW9jLT5yZG1haW4pOwogICAgIH0gZWxzZSB7Ci0gICAgICAgIHJkbWEgPSBhdG9taWNf
cmN1X3JlYWQoJnJzb3VyY2UtPnJpb2MtPnJkbWFvdXQpOworICAgICAgICByZG1hID0gcWVtdV9h
dG9taWNfcmN1X3JlYWQoJnJzb3VyY2UtPnJpb2MtPnJkbWFvdXQpOwogICAgIH0KIAogICAgIGlm
ICghcmRtYSkgewpAQCAtMjkwNCw5ICsyOTA0LDkgQEAgcWlvX2NoYW5uZWxfcmRtYV9zb3VyY2Vf
Y2hlY2soR1NvdXJjZSAqc291cmNlKQogCiAgICAgUkNVX1JFQURfTE9DS19HVUFSRCgpOwogICAg
IGlmIChyc291cmNlLT5jb25kaXRpb24gPT0gR19JT19JTikgewotICAgICAgICByZG1hID0gYXRv
bWljX3JjdV9yZWFkKCZyc291cmNlLT5yaW9jLT5yZG1haW4pOworICAgICAgICByZG1hID0gcWVt
dV9hdG9taWNfcmN1X3JlYWQoJnJzb3VyY2UtPnJpb2MtPnJkbWFpbik7CiAgICAgfSBlbHNlIHsK
LSAgICAgICAgcmRtYSA9IGF0b21pY19yY3VfcmVhZCgmcnNvdXJjZS0+cmlvYy0+cmRtYW91dCk7
CisgICAgICAgIHJkbWEgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcnNvdXJjZS0+cmlvYy0+cmRt
YW91dCk7CiAgICAgfQogCiAgICAgaWYgKCFyZG1hKSB7CkBAIC0yOTM0LDkgKzI5MzQsOSBAQCBx
aW9fY2hhbm5lbF9yZG1hX3NvdXJjZV9kaXNwYXRjaChHU291cmNlICpzb3VyY2UsCiAKICAgICBS
Q1VfUkVBRF9MT0NLX0dVQVJEKCk7CiAgICAgaWYgKHJzb3VyY2UtPmNvbmRpdGlvbiA9PSBHX0lP
X0lOKSB7Ci0gICAgICAgIHJkbWEgPSBhdG9taWNfcmN1X3JlYWQoJnJzb3VyY2UtPnJpb2MtPnJk
bWFpbik7CisgICAgICAgIHJkbWEgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcnNvdXJjZS0+cmlv
Yy0+cmRtYWluKTsKICAgICB9IGVsc2UgewotICAgICAgICByZG1hID0gYXRvbWljX3JjdV9yZWFk
KCZyc291cmNlLT5yaW9jLT5yZG1hb3V0KTsKKyAgICAgICAgcmRtYSA9IHFlbXVfYXRvbWljX3Jj
dV9yZWFkKCZyc291cmNlLT5yaW9jLT5yZG1hb3V0KTsKICAgICB9CiAKICAgICBpZiAoIXJkbWEp
IHsKQEAgLTMwMzcsMTIgKzMwMzcsMTIgQEAgc3RhdGljIGludCBxaW9fY2hhbm5lbF9yZG1hX2Ns
b3NlKFFJT0NoYW5uZWwgKmlvYywKIAogICAgIHJkbWFpbiA9IHJpb2MtPnJkbWFpbjsKICAgICBp
ZiAocmRtYWluKSB7Ci0gICAgICAgIGF0b21pY19yY3Vfc2V0KCZyaW9jLT5yZG1haW4sIE5VTEwp
OworICAgICAgICBxZW11X2F0b21pY19yY3Vfc2V0KCZyaW9jLT5yZG1haW4sIE5VTEwpOwogICAg
IH0KIAogICAgIHJkbWFvdXQgPSByaW9jLT5yZG1hb3V0OwogICAgIGlmIChyZG1hb3V0KSB7Ci0g
ICAgICAgIGF0b21pY19yY3Vfc2V0KCZyaW9jLT5yZG1hb3V0LCBOVUxMKTsKKyAgICAgICAgcWVt
dV9hdG9taWNfcmN1X3NldCgmcmlvYy0+cmRtYW91dCwgTlVMTCk7CiAgICAgfQogCiAgICAgcmN1
LT5yZG1haW4gPSByZG1haW47CkBAIC0zMDYyLDggKzMwNjIsOCBAQCBxaW9fY2hhbm5lbF9yZG1h
X3NodXRkb3duKFFJT0NoYW5uZWwgKmlvYywKIAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsK
IAotICAgIHJkbWFpbiA9IGF0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYWluKTsKLSAgICByZG1h
b3V0ID0gYXRvbWljX3JjdV9yZWFkKCZyaW9jLT5yZG1haW4pOworICAgIHJkbWFpbiA9IHFlbXVf
YXRvbWljX3JjdV9yZWFkKCZyaW9jLT5yZG1haW4pOworICAgIHJkbWFvdXQgPSBxZW11X2F0b21p
Y19yY3VfcmVhZCgmcmlvYy0+cmRtYWluKTsKIAogICAgIHN3aXRjaCAoaG93KSB7CiAgICAgY2Fz
ZSBRSU9fQ0hBTk5FTF9TSFVURE9XTl9SRUFEOgpAQCAtMzEzMyw3ICszMTMzLDcgQEAgc3RhdGlj
IHNpemVfdCBxZW11X3JkbWFfc2F2ZV9wYWdlKFFFTVVGaWxlICpmLCB2b2lkICpvcGFxdWUsCiAg
ICAgaW50IHJldDsKIAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsKLSAgICByZG1hID0gYXRv
bWljX3JjdV9yZWFkKCZyaW9jLT5yZG1hb3V0KTsKKyAgICByZG1hID0gcWVtdV9hdG9taWNfcmN1
X3JlYWQoJnJpb2MtPnJkbWFvdXQpOwogCiAgICAgaWYgKCFyZG1hKSB7CiAgICAgICAgIHJldHVy
biAtRUlPOwpAQCAtMzQ1Myw3ICszNDUzLDcgQEAgc3RhdGljIGludCBxZW11X3JkbWFfcmVnaXN0
cmF0aW9uX2hhbmRsZShRRU1VRmlsZSAqZiwgdm9pZCAqb3BhcXVlKQogICAgIGludCBpID0gMDsK
IAogICAgIFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsKLSAgICByZG1hID0gYXRvbWljX3JjdV9yZWFk
KCZyaW9jLT5yZG1haW4pOworICAgIHJkbWEgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcmlvYy0+
cmRtYWluKTsKIAogICAgIGlmICghcmRtYSkgewogICAgICAgICByZXR1cm4gLUVJTzsKQEAgLTM3
MTYsNyArMzcxNiw3IEBAIHJkbWFfYmxvY2tfbm90aWZpY2F0aW9uX2hhbmRsZShRSU9DaGFubmVs
UkRNQSAqcmlvYywgY29uc3QgY2hhciAqbmFtZSkKICAgICBpbnQgZm91bmQgPSAtMTsKIAogICAg
IFJDVV9SRUFEX0xPQ0tfR1VBUkQoKTsKLSAgICByZG1hID0gYXRvbWljX3JjdV9yZWFkKCZyaW9j
LT5yZG1haW4pOworICAgIHJkbWEgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYWlu
KTsKIAogICAgIGlmICghcmRtYSkgewogICAgICAgICByZXR1cm4gLUVJTzsKQEAgLTM3NjQsNyAr
Mzc2NCw3IEBAIHN0YXRpYyBpbnQgcWVtdV9yZG1hX3JlZ2lzdHJhdGlvbl9zdGFydChRRU1VRmls
ZSAqZiwgdm9pZCAqb3BhcXVlLAogICAgIFJETUFDb250ZXh0ICpyZG1hOwogCiAgICAgUkNVX1JF
QURfTE9DS19HVUFSRCgpOwotICAgIHJkbWEgPSBhdG9taWNfcmN1X3JlYWQoJnJpb2MtPnJkbWFv
dXQpOworICAgIHJkbWEgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYW91dCk7CiAg
ICAgaWYgKCFyZG1hKSB7CiAgICAgICAgIHJldHVybiAtRUlPOwogICAgIH0KQEAgLTM3OTUsNyAr
Mzc5NSw3IEBAIHN0YXRpYyBpbnQgcWVtdV9yZG1hX3JlZ2lzdHJhdGlvbl9zdG9wKFFFTVVGaWxl
ICpmLCB2b2lkICpvcGFxdWUsCiAgICAgaW50IHJldCA9IDA7CiAKICAgICBSQ1VfUkVBRF9MT0NL
X0dVQVJEKCk7Ci0gICAgcmRtYSA9IGF0b21pY19yY3VfcmVhZCgmcmlvYy0+cmRtYW91dCk7Cisg
ICAgcmRtYSA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZyaW9jLT5yZG1hb3V0KTsKICAgICBpZiAo
IXJkbWEpIHsKICAgICAgICAgcmV0dXJuIC1FSU87CiAgICAgfQpkaWZmIC0tZ2l0IGEvbW9uaXRv
ci9obXAuYyBiL21vbml0b3IvaG1wLmMKaW5kZXggZDU5OGRkMDJiYi4uYTQyNjUzZTU3MyAxMDA2
NDQKLS0tIGEvbW9uaXRvci9obXAuYworKysgYi9tb25pdG9yL2htcC5jCkBAIC0xMzM3LDE5ICsx
MzM3LDE5IEBAIHN0YXRpYyB2b2lkIG1vbml0b3JfZXZlbnQodm9pZCAqb3BhcXVlLCBRRU1VQ2hy
RXZlbnQgZXZlbnQpCiAgICAgICAgICAgICBtb25pdG9yX3Jlc3VtZShtb24pOwogICAgICAgICAg
ICAgbW9uaXRvcl9mbHVzaChtb24pOwogICAgICAgICB9IGVsc2UgewotICAgICAgICAgICAgYXRv
bWljX21iX3NldCgmbW9uLT5zdXNwZW5kX2NudCwgMCk7CisgICAgICAgICAgICBxZW11X2F0b21p
Y19tYl9zZXQoJm1vbi0+c3VzcGVuZF9jbnQsIDApOwogICAgICAgICB9CiAgICAgICAgIGJyZWFr
OwogCiAgICAgY2FzZSBDSFJfRVZFTlRfTVVYX09VVDoKICAgICAgICAgaWYgKG1vbi0+cmVzZXRf
c2VlbikgewotICAgICAgICAgICAgaWYgKGF0b21pY19tYl9yZWFkKCZtb24tPnN1c3BlbmRfY250
KSA9PSAwKSB7CisgICAgICAgICAgICBpZiAocWVtdV9hdG9taWNfbWJfcmVhZCgmbW9uLT5zdXNw
ZW5kX2NudCkgPT0gMCkgewogICAgICAgICAgICAgICAgIG1vbml0b3JfcHJpbnRmKG1vbiwgIlxu
Iik7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBtb25pdG9yX2ZsdXNoKG1vbik7CiAgICAg
ICAgICAgICBtb25pdG9yX3N1c3BlbmQobW9uKTsKICAgICAgICAgfSBlbHNlIHsKLSAgICAgICAg
ICAgIGF0b21pY19pbmMoJm1vbi0+c3VzcGVuZF9jbnQpOworICAgICAgICAgICAgcWVtdV9hdG9t
aWNfaW5jKCZtb24tPnN1c3BlbmRfY250KTsKICAgICAgICAgfQogICAgICAgICBxZW11X211dGV4
X2xvY2soJm1vbi0+bW9uX2xvY2spOwogICAgICAgICBtb24tPm11eF9vdXQgPSAxOwpkaWZmIC0t
Z2l0IGEvbW9uaXRvci9taXNjLmMgYi9tb25pdG9yL21pc2MuYwppbmRleCAwYjFiOWIxOTZjLi5j
MDUyYjA2ZjEyIDEwMDY0NAotLS0gYS9tb25pdG9yL21pc2MuYworKysgYi9tb25pdG9yL21pc2Mu
YwpAQCAtNzUxLDcgKzc1MSw3IEBAIHN0YXRpYyB1aW50NjRfdCB2dG9wKHZvaWQgKnB0ciwgRXJy
b3IgKiplcnJwKQogICAgIH0KIAogICAgIC8qIEZvcmNlIGNvcHktb24td3JpdGUgaWYgbmVjZXNz
YXJ5LiAgKi8KLSAgICBhdG9taWNfYWRkKCh1aW50OF90ICopcHRyLCAwKTsKKyAgICBxZW11X2F0
b21pY19hZGQoKHVpbnQ4X3QgKilwdHIsIDApOwogCiAgICAgaWYgKHByZWFkKGZkLCAmcGluZm8s
IHNpemVvZihwaW5mbyksIG9mZnNldCkgIT0gc2l6ZW9mKHBpbmZvKSkgewogICAgICAgICBlcnJv
cl9zZXRnX2Vycm5vKGVycnAsIGVycm5vLCAiQ2Fubm90IHJlYWQgcGFnZW1hcCIpOwpkaWZmIC0t
Z2l0IGEvbW9uaXRvci9tb25pdG9yLmMgYi9tb25pdG9yL21vbml0b3IuYwppbmRleCBiMzg1YTNk
NTY5Li43MWZhOWJlYTZlIDEwMDY0NAotLS0gYS9tb25pdG9yL21vbml0b3IuYworKysgYi9tb25p
dG9yL21vbml0b3IuYwpAQCAtNDQ5LDcgKzQ0OSw3IEBAIGludCBtb25pdG9yX3N1c3BlbmQoTW9u
aXRvciAqbW9uKQogICAgICAgICByZXR1cm4gLUVOT1RUWTsKICAgICB9CiAKLSAgICBhdG9taWNf
aW5jKCZtb24tPnN1c3BlbmRfY250KTsKKyAgICBxZW11X2F0b21pY19pbmMoJm1vbi0+c3VzcGVu
ZF9jbnQpOwogCiAgICAgaWYgKG1vbi0+dXNlX2lvX3RocmVhZCkgewogICAgICAgICAvKgpAQCAt
NDc2LDcgKzQ3Niw3IEBAIHZvaWQgbW9uaXRvcl9yZXN1bWUoTW9uaXRvciAqbW9uKQogICAgICAg
ICByZXR1cm47CiAgICAgfQogCi0gICAgaWYgKGF0b21pY19kZWNfZmV0Y2goJm1vbi0+c3VzcGVu
ZF9jbnQpID09IDApIHsKKyAgICBpZiAocWVtdV9hdG9taWNfZGVjX2ZldGNoKCZtb24tPnN1c3Bl
bmRfY250KSA9PSAwKSB7CiAgICAgICAgIEFpb0NvbnRleHQgKmN0eDsKIAogICAgICAgICBpZiAo
bW9uLT51c2VfaW9fdGhyZWFkKSB7CkBAIC01MDEsNyArNTAxLDcgQEAgaW50IG1vbml0b3JfY2Fu
X3JlYWQodm9pZCAqb3BhcXVlKQogewogICAgIE1vbml0b3IgKm1vbiA9IG9wYXF1ZTsKIAotICAg
IHJldHVybiAhYXRvbWljX21iX3JlYWQoJm1vbi0+c3VzcGVuZF9jbnQpOworICAgIHJldHVybiAh
cWVtdV9hdG9taWNfbWJfcmVhZCgmbW9uLT5zdXNwZW5kX2NudCk7CiB9CiAKIHZvaWQgbW9uaXRv
cl9saXN0X2FwcGVuZChNb25pdG9yICptb24pCmRpZmYgLS1naXQgYS9xZW11LW5iZC5jIGIvcWVt
dS1uYmQuYwppbmRleCAzMzQ3NmExMDAwLi5iNjNhNzVjM2Y4IDEwMDY0NAotLS0gYS9xZW11LW5i
ZC5jCisrKyBiL3FlbXUtbmJkLmMKQEAgLTE1OCw3ICsxNTgsNyBAQCBRRU1VX0NPUFlSSUdIVCAi
XG4iCiAjaWYgSEFWRV9OQkRfREVWSUNFCiBzdGF0aWMgdm9pZCB0ZXJtc2lnX2hhbmRsZXIoaW50
IHNpZ251bSkKIHsKLSAgICBhdG9taWNfY21weGNoZygmc3RhdGUsIFJVTk5JTkcsIFRFUk1JTkFU
RSk7CisgICAgcWVtdV9hdG9taWNfY21weGNoZygmc3RhdGUsIFJVTk5JTkcsIFRFUk1JTkFURSk7
CiAgICAgcWVtdV9ub3RpZnlfZXZlbnQoKTsKIH0KICNlbmRpZiAvKiBIQVZFX05CRF9ERVZJQ0Ug
Ki8KZGlmZiAtLWdpdCBhL3FnYS9jb21tYW5kcy5jIGIvcWdhL2NvbW1hbmRzLmMKaW5kZXggZDNm
ZWM4MDdjMS4uODNmM2E1NGQxNSAxMDA2NDQKLS0tIGEvcWdhL2NvbW1hbmRzLmMKKysrIGIvcWdh
L2NvbW1hbmRzLmMKQEAgLTE2NiwxMyArMTY2LDEzIEBAIEd1ZXN0RXhlY1N0YXR1cyAqcW1wX2d1
ZXN0X2V4ZWNfc3RhdHVzKGludDY0X3QgcGlkLCBFcnJvciAqKmVycnApCiAKICAgICBnZXMgPSBn
X25ldzAoR3Vlc3RFeGVjU3RhdHVzLCAxKTsKIAotICAgIGJvb2wgZmluaXNoZWQgPSBhdG9taWNf
bWJfcmVhZCgmZ2VpLT5maW5pc2hlZCk7CisgICAgYm9vbCBmaW5pc2hlZCA9IHFlbXVfYXRvbWlj
X21iX3JlYWQoJmdlaS0+ZmluaXNoZWQpOwogCiAgICAgLyogbmVlZCB0byB3YWl0IHRpbGwgb3V0
cHV0IGNoYW5uZWxzIGFyZSBjbG9zZWQKICAgICAgKiB0byBiZSBzdXJlIHdlIGNhcHR1cmVkIGFs
bCBvdXRwdXQgYXQgdGhpcyBwb2ludCAqLwogICAgIGlmIChnZWktPmhhc19vdXRwdXQpIHsKLSAg
ICAgICAgZmluaXNoZWQgPSBmaW5pc2hlZCAmJiBhdG9taWNfbWJfcmVhZCgmZ2VpLT5vdXQuY2xv
c2VkKTsKLSAgICAgICAgZmluaXNoZWQgPSBmaW5pc2hlZCAmJiBhdG9taWNfbWJfcmVhZCgmZ2Vp
LT5lcnIuY2xvc2VkKTsKKyAgICAgICAgZmluaXNoZWQgPSBmaW5pc2hlZCAmJiBxZW11X2F0b21p
Y19tYl9yZWFkKCZnZWktPm91dC5jbG9zZWQpOworICAgICAgICBmaW5pc2hlZCA9IGZpbmlzaGVk
ICYmIHFlbXVfYXRvbWljX21iX3JlYWQoJmdlaS0+ZXJyLmNsb3NlZCk7CiAgICAgfQogCiAgICAg
Z2VzLT5leGl0ZWQgPSBmaW5pc2hlZDsKQEAgLTI3NCw3ICsyNzQsNyBAQCBzdGF0aWMgdm9pZCBn
dWVzdF9leGVjX2NoaWxkX3dhdGNoKEdQaWQgcGlkLCBnaW50IHN0YXR1cywgZ3BvaW50ZXIgZGF0
YSkKICAgICAgICAgICAgIChpbnQzMl90KWdwaWRfdG9faW50NjQocGlkKSwgKHVpbnQzMl90KXN0
YXR1cyk7CiAKICAgICBnZWktPnN0YXR1cyA9IHN0YXR1czsKLSAgICBhdG9taWNfbWJfc2V0KCZn
ZWktPmZpbmlzaGVkLCB0cnVlKTsKKyAgICBxZW11X2F0b21pY19tYl9zZXQoJmdlaS0+ZmluaXNo
ZWQsIHRydWUpOwogCiAgICAgZ19zcGF3bl9jbG9zZV9waWQocGlkKTsKIH0KQEAgLTMzMCw3ICsz
MzAsNyBAQCBzdGF0aWMgZ2Jvb2xlYW4gZ3Vlc3RfZXhlY19pbnB1dF93YXRjaChHSU9DaGFubmVs
ICpjaCwKIGRvbmU6CiAgICAgZ19pb19jaGFubmVsX3NodXRkb3duKGNoLCB0cnVlLCBOVUxMKTsK
ICAgICBnX2lvX2NoYW5uZWxfdW5yZWYoY2gpOwotICAgIGF0b21pY19tYl9zZXQoJnAtPmNsb3Nl
ZCwgdHJ1ZSk7CisgICAgcWVtdV9hdG9taWNfbWJfc2V0KCZwLT5jbG9zZWQsIHRydWUpOwogICAg
IGdfZnJlZShwLT5kYXRhKTsKIAogICAgIHJldHVybiBmYWxzZTsKQEAgLTM4NCw3ICszODQsNyBA
QCBzdGF0aWMgZ2Jvb2xlYW4gZ3Vlc3RfZXhlY19vdXRwdXRfd2F0Y2goR0lPQ2hhbm5lbCAqY2gs
CiBjbG9zZToKICAgICBnX2lvX2NoYW5uZWxfc2h1dGRvd24oY2gsIHRydWUsIE5VTEwpOwogICAg
IGdfaW9fY2hhbm5lbF91bnJlZihjaCk7Ci0gICAgYXRvbWljX21iX3NldCgmcC0+Y2xvc2VkLCB0
cnVlKTsKKyAgICBxZW11X2F0b21pY19tYl9zZXQoJnAtPmNsb3NlZCwgdHJ1ZSk7CiAgICAgcmV0
dXJuIGZhbHNlOwogfQogCmRpZmYgLS1naXQgYS9xb20vb2JqZWN0LmMgYi9xb20vb2JqZWN0LmMK
aW5kZXggMzg3ZWZiMjVlYi4uMzZjMWZmMTRjOCAxMDA2NDQKLS0tIGEvcW9tL29iamVjdC5jCisr
KyBiL3FvbS9vYmplY3QuYwpAQCAtODM3LDcgKzgzNyw3IEBAIE9iamVjdCAqb2JqZWN0X2R5bmFt
aWNfY2FzdF9hc3NlcnQoT2JqZWN0ICpvYmosIGNvbnN0IGNoYXIgKnR5cGVuYW1lLAogICAgIE9i
amVjdCAqaW5zdDsKIAogICAgIGZvciAoaSA9IDA7IG9iaiAmJiBpIDwgT0JKRUNUX0NMQVNTX0NB
U1RfQ0FDSEU7IGkrKykgewotICAgICAgICBpZiAoYXRvbWljX3JlYWQoJm9iai0+Y2xhc3MtPm9i
amVjdF9jYXN0X2NhY2hlW2ldKSA9PSB0eXBlbmFtZSkgeworICAgICAgICBpZiAocWVtdV9hdG9t
aWNfcmVhZCgmb2JqLT5jbGFzcy0+b2JqZWN0X2Nhc3RfY2FjaGVbaV0pID09IHR5cGVuYW1lKSB7
CiAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAgICAgfQogICAgIH0KQEAgLTg1NCwxMCArODU0
LDEwIEBAIE9iamVjdCAqb2JqZWN0X2R5bmFtaWNfY2FzdF9hc3NlcnQoT2JqZWN0ICpvYmosIGNv
bnN0IGNoYXIgKnR5cGVuYW1lLAogCiAgICAgaWYgKG9iaiAmJiBvYmogPT0gaW5zdCkgewogICAg
ICAgICBmb3IgKGkgPSAxOyBpIDwgT0JKRUNUX0NMQVNTX0NBU1RfQ0FDSEU7IGkrKykgewotICAg
ICAgICAgICAgYXRvbWljX3NldCgmb2JqLT5jbGFzcy0+b2JqZWN0X2Nhc3RfY2FjaGVbaSAtIDFd
LAotICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfcmVhZCgmb2JqLT5jbGFzcy0+b2JqZWN0
X2Nhc3RfY2FjaGVbaV0pKTsKKyAgICAgICAgICAgIHFlbXVfYXRvbWljX3NldCgmb2JqLT5jbGFz
cy0+b2JqZWN0X2Nhc3RfY2FjaGVbaSAtIDFdLAorICAgICAgICAgICAgICAgICAgICAgICBxZW11
X2F0b21pY19yZWFkKCZvYmotPmNsYXNzLT5vYmplY3RfY2FzdF9jYWNoZVtpXSkpOwogICAgICAg
ICB9Ci0gICAgICAgIGF0b21pY19zZXQoJm9iai0+Y2xhc3MtPm9iamVjdF9jYXN0X2NhY2hlW2kg
LSAxXSwgdHlwZW5hbWUpOworICAgICAgICBxZW11X2F0b21pY19zZXQoJm9iai0+Y2xhc3MtPm9i
amVjdF9jYXN0X2NhY2hlW2kgLSAxXSwgdHlwZW5hbWUpOwogICAgIH0KIAogb3V0OgpAQCAtOTI3
LDcgKzkyNyw3IEBAIE9iamVjdENsYXNzICpvYmplY3RfY2xhc3NfZHluYW1pY19jYXN0X2Fzc2Vy
dChPYmplY3RDbGFzcyAqY2xhc3MsCiAgICAgaW50IGk7CiAKICAgICBmb3IgKGkgPSAwOyBjbGFz
cyAmJiBpIDwgT0JKRUNUX0NMQVNTX0NBU1RfQ0FDSEU7IGkrKykgewotICAgICAgICBpZiAoYXRv
bWljX3JlYWQoJmNsYXNzLT5jbGFzc19jYXN0X2NhY2hlW2ldKSA9PSB0eXBlbmFtZSkgeworICAg
ICAgICBpZiAocWVtdV9hdG9taWNfcmVhZCgmY2xhc3MtPmNsYXNzX2Nhc3RfY2FjaGVbaV0pID09
IHR5cGVuYW1lKSB7CiAgICAgICAgICAgICByZXQgPSBjbGFzczsKICAgICAgICAgICAgIGdvdG8g
b3V0OwogICAgICAgICB9CkBAIC05NDgsMTAgKzk0OCwxMCBAQCBPYmplY3RDbGFzcyAqb2JqZWN0
X2NsYXNzX2R5bmFtaWNfY2FzdF9hc3NlcnQoT2JqZWN0Q2xhc3MgKmNsYXNzLAogI2lmZGVmIENP
TkZJR19RT01fQ0FTVF9ERUJVRwogICAgIGlmIChjbGFzcyAmJiByZXQgPT0gY2xhc3MpIHsKICAg
ICAgICAgZm9yIChpID0gMTsgaSA8IE9CSkVDVF9DTEFTU19DQVNUX0NBQ0hFOyBpKyspIHsKLSAg
ICAgICAgICAgIGF0b21pY19zZXQoJmNsYXNzLT5jbGFzc19jYXN0X2NhY2hlW2kgLSAxXSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgYXRvbWljX3JlYWQoJmNsYXNzLT5jbGFzc19jYXN0X2NhY2hl
W2ldKSk7CisgICAgICAgICAgICBxZW11X2F0b21pY19zZXQoJmNsYXNzLT5jbGFzc19jYXN0X2Nh
Y2hlW2kgLSAxXSwKKyAgICAgICAgICAgICAgICAgICAgICAgcWVtdV9hdG9taWNfcmVhZCgmY2xh
c3MtPmNsYXNzX2Nhc3RfY2FjaGVbaV0pKTsKICAgICAgICAgfQotICAgICAgICBhdG9taWNfc2V0
KCZjbGFzcy0+Y2xhc3NfY2FzdF9jYWNoZVtpIC0gMV0sIHR5cGVuYW1lKTsKKyAgICAgICAgcWVt
dV9hdG9taWNfc2V0KCZjbGFzcy0+Y2xhc3NfY2FzdF9jYWNoZVtpIC0gMV0sIHR5cGVuYW1lKTsK
ICAgICB9CiBvdXQ6CiAjZW5kaWYKQEAgLTExMzYsNyArMTEzNiw3IEBAIE9iamVjdCAqb2JqZWN0
X3JlZih2b2lkICpvYmpwdHIpCiAgICAgaWYgKCFvYmopIHsKICAgICAgICAgcmV0dXJuIE5VTEw7
CiAgICAgfQotICAgIGF0b21pY19pbmMoJm9iai0+cmVmKTsKKyAgICBxZW11X2F0b21pY19pbmMo
Jm9iai0+cmVmKTsKICAgICByZXR1cm4gb2JqOwogfQogCkBAIC0xMTQ5LDcgKzExNDksNyBAQCB2
b2lkIG9iamVjdF91bnJlZih2b2lkICpvYmpwdHIpCiAgICAgZ19hc3NlcnQob2JqLT5yZWYgPiAw
KTsKIAogICAgIC8qIHBhcmVudCBhbHdheXMgaG9sZHMgYSByZWZlcmVuY2UgdG8gaXRzIGNoaWxk
cmVuICovCi0gICAgaWYgKGF0b21pY19mZXRjaF9kZWMoJm9iai0+cmVmKSA9PSAxKSB7CisgICAg
aWYgKHFlbXVfYXRvbWljX2ZldGNoX2RlYygmb2JqLT5yZWYpID09IDEpIHsKICAgICAgICAgb2Jq
ZWN0X2ZpbmFsaXplKG9iaik7CiAgICAgfQogfQpkaWZmIC0tZ2l0IGEvc2NzaS9xZW11LXByLWhl
bHBlci5jIGIvc2NzaS9xZW11LXByLWhlbHBlci5jCmluZGV4IDU3YWQ4MzBkNTQuLjk1ZWJlODky
ZmYgMTAwNjQ0Ci0tLSBhL3Njc2kvcWVtdS1wci1oZWxwZXIuYworKysgYi9zY3NpL3FlbXUtcHIt
aGVscGVyLmMKQEAgLTc0Nyw3ICs3NDcsNyBAQCBzdGF0aWMgdm9pZCBjb3JvdXRpbmVfZm4gcHJo
X2NvX2VudHJ5KHZvaWQgKm9wYXF1ZSkKICAgICAgICAgZ290byBvdXQ7CiAgICAgfQogCi0gICAg
d2hpbGUgKGF0b21pY19yZWFkKCZzdGF0ZSkgPT0gUlVOTklORykgeworICAgIHdoaWxlIChxZW11
X2F0b21pY19yZWFkKCZzdGF0ZSkgPT0gUlVOTklORykgewogICAgICAgICBQUkhlbHBlclJlcXVl
c3QgcmVxOwogICAgICAgICBQUkhlbHBlclJlc3BvbnNlIHJlc3A7CiAgICAgICAgIGludCBzejsK
QEAgLTgxNiw3ICs4MTYsNyBAQCBzdGF0aWMgZ2Jvb2xlYW4gYWNjZXB0X2NsaWVudChRSU9DaGFu
bmVsICppb2MsIEdJT0NvbmRpdGlvbiBjb25kLCBncG9pbnRlciBvcGFxdQogCiBzdGF0aWMgdm9p
ZCB0ZXJtc2lnX2hhbmRsZXIoaW50IHNpZ251bSkKIHsKLSAgICBhdG9taWNfY21weGNoZygmc3Rh
dGUsIFJVTk5JTkcsIFRFUk1JTkFURSk7CisgICAgcWVtdV9hdG9taWNfY21weGNoZygmc3RhdGUs
IFJVTk5JTkcsIFRFUk1JTkFURSk7CiAgICAgcWVtdV9ub3RpZnlfZXZlbnQoKTsKIH0KIApkaWZm
IC0tZ2l0IGEvc29mdG1tdS9jcHUtdGhyb3R0bGUuYyBiL3NvZnRtbXUvY3B1LXRocm90dGxlLmMK
aW5kZXggNGU2YjI4MThjYS4uN2I3ZGJjYzlkYyAxMDA2NDQKLS0tIGEvc29mdG1tdS9jcHUtdGhy
b3R0bGUuYworKysgYi9zb2Z0bW11L2NwdS10aHJvdHRsZS5jCkBAIC02NCw3ICs2NCw3IEBAIHN0
YXRpYyB2b2lkIGNwdV90aHJvdHRsZV90aHJlYWQoQ1BVU3RhdGUgKmNwdSwgcnVuX29uX2NwdV9k
YXRhIG9wYXF1ZSkKICAgICAgICAgfQogICAgICAgICBzbGVlcHRpbWVfbnMgPSBlbmR0aW1lX25z
IC0gcWVtdV9jbG9ja19nZXRfbnMoUUVNVV9DTE9DS19SRUFMVElNRSk7CiAgICAgfQotICAgIGF0
b21pY19zZXQoJmNwdS0+dGhyb3R0bGVfdGhyZWFkX3NjaGVkdWxlZCwgMCk7CisgICAgcWVtdV9h
dG9taWNfc2V0KCZjcHUtPnRocm90dGxlX3RocmVhZF9zY2hlZHVsZWQsIDApOwogfQogCiBzdGF0
aWMgdm9pZCBjcHVfdGhyb3R0bGVfdGltZXJfdGljayh2b2lkICpvcGFxdWUpCkBAIC03Nyw3ICs3
Nyw3IEBAIHN0YXRpYyB2b2lkIGNwdV90aHJvdHRsZV90aW1lcl90aWNrKHZvaWQgKm9wYXF1ZSkK
ICAgICAgICAgcmV0dXJuOwogICAgIH0KICAgICBDUFVfRk9SRUFDSChjcHUpIHsKLSAgICAgICAg
aWYgKCFhdG9taWNfeGNoZygmY3B1LT50aHJvdHRsZV90aHJlYWRfc2NoZWR1bGVkLCAxKSkgewor
ICAgICAgICBpZiAoIXFlbXVfYXRvbWljX3hjaGcoJmNwdS0+dGhyb3R0bGVfdGhyZWFkX3NjaGVk
dWxlZCwgMSkpIHsKICAgICAgICAgICAgIGFzeW5jX3J1bl9vbl9jcHUoY3B1LCBjcHVfdGhyb3R0
bGVfdGhyZWFkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSVU5fT05fQ1BVX05VTEwp
OwogICAgICAgICB9CkBAIC05NCw3ICs5NCw3IEBAIHZvaWQgY3B1X3Rocm90dGxlX3NldChpbnQg
bmV3X3Rocm90dGxlX3BjdCkKICAgICBuZXdfdGhyb3R0bGVfcGN0ID0gTUlOKG5ld190aHJvdHRs
ZV9wY3QsIENQVV9USFJPVFRMRV9QQ1RfTUFYKTsKICAgICBuZXdfdGhyb3R0bGVfcGN0ID0gTUFY
KG5ld190aHJvdHRsZV9wY3QsIENQVV9USFJPVFRMRV9QQ1RfTUlOKTsKIAotICAgIGF0b21pY19z
ZXQoJnRocm90dGxlX3BlcmNlbnRhZ2UsIG5ld190aHJvdHRsZV9wY3QpOworICAgIHFlbXVfYXRv
bWljX3NldCgmdGhyb3R0bGVfcGVyY2VudGFnZSwgbmV3X3Rocm90dGxlX3BjdCk7CiAKICAgICB0
aW1lcl9tb2QodGhyb3R0bGVfdGltZXIsIHFlbXVfY2xvY2tfZ2V0X25zKFFFTVVfQ0xPQ0tfVklS
VFVBTF9SVCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1BVX1RI
Uk9UVExFX1RJTUVTTElDRV9OUyk7CkBAIC0xMDIsNyArMTAyLDcgQEAgdm9pZCBjcHVfdGhyb3R0
bGVfc2V0KGludCBuZXdfdGhyb3R0bGVfcGN0KQogCiB2b2lkIGNwdV90aHJvdHRsZV9zdG9wKHZv
aWQpCiB7Ci0gICAgYXRvbWljX3NldCgmdGhyb3R0bGVfcGVyY2VudGFnZSwgMCk7CisgICAgcWVt
dV9hdG9taWNfc2V0KCZ0aHJvdHRsZV9wZXJjZW50YWdlLCAwKTsKIH0KIAogYm9vbCBjcHVfdGhy
b3R0bGVfYWN0aXZlKHZvaWQpCkBAIC0xMTIsNyArMTEyLDcgQEAgYm9vbCBjcHVfdGhyb3R0bGVf
YWN0aXZlKHZvaWQpCiAKIGludCBjcHVfdGhyb3R0bGVfZ2V0X3BlcmNlbnRhZ2Uodm9pZCkKIHsK
LSAgICByZXR1cm4gYXRvbWljX3JlYWQoJnRocm90dGxlX3BlcmNlbnRhZ2UpOworICAgIHJldHVy
biBxZW11X2F0b21pY19yZWFkKCZ0aHJvdHRsZV9wZXJjZW50YWdlKTsKIH0KIAogdm9pZCBjcHVf
dGhyb3R0bGVfaW5pdCh2b2lkKQpkaWZmIC0tZ2l0IGEvc29mdG1tdS9jcHVzLmMgYi9zb2Z0bW11
L2NwdXMuYwppbmRleCBlM2I5ODA2NWM5Li45NGZjYWRlYTRhIDEwMDY0NAotLS0gYS9zb2Z0bW11
L2NwdXMuYworKysgYi9zb2Z0bW11L2NwdXMuYwpAQCAtMTkyLDcgKzE5Miw3IEBAIHN0YXRpYyB2
b2lkIGNwdV91cGRhdGVfaWNvdW50X2xvY2tlZChDUFVTdGF0ZSAqY3B1KQogICAgIGludDY0X3Qg
ZXhlY3V0ZWQgPSBjcHVfZ2V0X2ljb3VudF9leGVjdXRlZChjcHUpOwogICAgIGNwdS0+aWNvdW50
X2J1ZGdldCAtPSBleGVjdXRlZDsKIAotICAgIGF0b21pY19zZXRfaTY0KCZ0aW1lcnNfc3RhdGUu
cWVtdV9pY291bnQsCisgICAgcWVtdV9hdG9taWNfc2V0X2k2NCgmdGltZXJzX3N0YXRlLnFlbXVf
aWNvdW50LAogICAgICAgICAgICAgICAgICAgIHRpbWVyc19zdGF0ZS5xZW11X2ljb3VudCArIGV4
ZWN1dGVkKTsKIH0KIApAQCAtMjIzLDEzICsyMjMsMTMgQEAgc3RhdGljIGludDY0X3QgY3B1X2dl
dF9pY291bnRfcmF3X2xvY2tlZCh2b2lkKQogICAgICAgICBjcHVfdXBkYXRlX2ljb3VudF9sb2Nr
ZWQoY3B1KTsKICAgICB9CiAgICAgLyogVGhlIHJlYWQgaXMgcHJvdGVjdGVkIGJ5IHRoZSBzZXFs
b2NrLCBidXQgbmVlZHMgYXRvbWljNjQgdG8gYXZvaWQgVUIgKi8KLSAgICByZXR1cm4gYXRvbWlj
X3JlYWRfaTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnQpOworICAgIHJldHVybiBxZW11X2F0
b21pY19yZWFkX2k2NCgmdGltZXJzX3N0YXRlLnFlbXVfaWNvdW50KTsKIH0KIAogc3RhdGljIGlu
dDY0X3QgY3B1X2dldF9pY291bnRfbG9ja2VkKHZvaWQpCiB7CiAgICAgaW50NjRfdCBpY291bnQg
PSBjcHVfZ2V0X2ljb3VudF9yYXdfbG9ja2VkKCk7Ci0gICAgcmV0dXJuIGF0b21pY19yZWFkX2k2
NCgmdGltZXJzX3N0YXRlLnFlbXVfaWNvdW50X2JpYXMpICsKKyAgICByZXR1cm4gcWVtdV9hdG9t
aWNfcmVhZF9pNjQoJnRpbWVyc19zdGF0ZS5xZW11X2ljb3VudF9iaWFzKSArCiAgICAgICAgIGNw
dV9pY291bnRfdG9fbnMoaWNvdW50KTsKIH0KIApAQCAtMjYyLDcgKzI2Miw3IEBAIGludDY0X3Qg
Y3B1X2dldF9pY291bnQodm9pZCkKIAogaW50NjRfdCBjcHVfaWNvdW50X3RvX25zKGludDY0X3Qg
aWNvdW50KQogewotICAgIHJldHVybiBpY291bnQgPDwgYXRvbWljX3JlYWQoJnRpbWVyc19zdGF0
ZS5pY291bnRfdGltZV9zaGlmdCk7CisgICAgcmV0dXJuIGljb3VudCA8PCBxZW11X2F0b21pY19y
ZWFkKCZ0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQpOwogfQogCiBzdGF0aWMgaW50NjRf
dCBjcHVfZ2V0X3RpY2tzX2xvY2tlZCh2b2lkKQpAQCAtMzkzLDE4ICszOTMsMTggQEAgc3RhdGlj
IHZvaWQgaWNvdW50X2FkanVzdCh2b2lkKQogICAgICAgICAmJiBsYXN0X2RlbHRhICsgSUNPVU5U
X1dPQkJMRSA8IGRlbHRhICogMgogICAgICAgICAmJiB0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVf
c2hpZnQgPiAwKSB7CiAgICAgICAgIC8qIFRoZSBndWVzdCBpcyBnZXR0aW5nIHRvbyBmYXIgYWhl
YWQuICBTbG93IHRpbWUgZG93bi4gICovCi0gICAgICAgIGF0b21pY19zZXQoJnRpbWVyc19zdGF0
ZS5pY291bnRfdGltZV9zaGlmdCwKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZ0aW1lcnNfc3Rh
dGUuaWNvdW50X3RpbWVfc2hpZnQsCiAgICAgICAgICAgICAgICAgICAgdGltZXJzX3N0YXRlLmlj
b3VudF90aW1lX3NoaWZ0IC0gMSk7CiAgICAgfQogICAgIGlmIChkZWx0YSA8IDAKICAgICAgICAg
JiYgbGFzdF9kZWx0YSAtIElDT1VOVF9XT0JCTEUgPiBkZWx0YSAqIDIKICAgICAgICAgJiYgdGlt
ZXJzX3N0YXRlLmljb3VudF90aW1lX3NoaWZ0IDwgTUFYX0lDT1VOVF9TSElGVCkgewogICAgICAg
ICAvKiBUaGUgZ3Vlc3QgaXMgZ2V0dGluZyB0b28gZmFyIGJlaGluZC4gIFNwZWVkIHRpbWUgdXAu
ICAqLwotICAgICAgICBhdG9taWNfc2V0KCZ0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQs
CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmdGltZXJzX3N0YXRlLmljb3VudF90aW1lX3NoaWZ0
LAogICAgICAgICAgICAgICAgICAgIHRpbWVyc19zdGF0ZS5pY291bnRfdGltZV9zaGlmdCArIDEp
OwogICAgIH0KICAgICBsYXN0X2RlbHRhID0gZGVsdGE7Ci0gICAgYXRvbWljX3NldF9pNjQoJnRp
bWVyc19zdGF0ZS5xZW11X2ljb3VudF9iaWFzLAorICAgIHFlbXVfYXRvbWljX3NldF9pNjQoJnRp
bWVyc19zdGF0ZS5xZW11X2ljb3VudF9iaWFzLAogICAgICAgICAgICAgICAgICAgIGN1cl9pY291
bnQgLSAodGltZXJzX3N0YXRlLnFlbXVfaWNvdW50CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA8PCB0aW1lcnNfc3RhdGUuaWNvdW50X3RpbWVfc2hpZnQpKTsKICAgICBzZXFsb2Nr
X3dyaXRlX3VubG9jaygmdGltZXJzX3N0YXRlLnZtX2Nsb2NrX3NlcWxvY2ssCkBAIC00MjgsNyAr
NDI4LDcgQEAgc3RhdGljIHZvaWQgaWNvdW50X2FkanVzdF92bSh2b2lkICpvcGFxdWUpCiAKIHN0
YXRpYyBpbnQ2NF90IHFlbXVfaWNvdW50X3JvdW5kKGludDY0X3QgY291bnQpCiB7Ci0gICAgaW50
IHNoaWZ0ID0gYXRvbWljX3JlYWQoJnRpbWVyc19zdGF0ZS5pY291bnRfdGltZV9zaGlmdCk7Cisg
ICAgaW50IHNoaWZ0ID0gcWVtdV9hdG9taWNfcmVhZCgmdGltZXJzX3N0YXRlLmljb3VudF90aW1l
X3NoaWZ0KTsKICAgICByZXR1cm4gKGNvdW50ICsgKDEgPDwgc2hpZnQpIC0gMSkgPj4gc2hpZnQ7
CiB9CiAKQEAgLTQ2Niw3ICs0NjYsNyBAQCBzdGF0aWMgdm9pZCBpY291bnRfd2FycF9ydCh2b2lk
KQogICAgICAgICAgICAgaW50NjRfdCBkZWx0YSA9IGNsb2NrIC0gY3VyX2ljb3VudDsKICAgICAg
ICAgICAgIHdhcnBfZGVsdGEgPSBNSU4od2FycF9kZWx0YSwgZGVsdGEpOwogICAgICAgICB9Ci0g
ICAgICAgIGF0b21pY19zZXRfaTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnRfYmlhcywKKyAg
ICAgICAgcWVtdV9hdG9taWNfc2V0X2k2NCgmdGltZXJzX3N0YXRlLnFlbXVfaWNvdW50X2JpYXMs
CiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyc19zdGF0ZS5xZW11X2ljb3VudF9iaWFzICsg
d2FycF9kZWx0YSk7CiAgICAgfQogICAgIHRpbWVyc19zdGF0ZS52bV9jbG9ja193YXJwX3N0YXJ0
ID0gLTE7CkBAIC00OTksNyArNDk5LDcgQEAgdm9pZCBxdGVzdF9jbG9ja193YXJwKGludDY0X3Qg
ZGVzdCkKIAogICAgICAgICBzZXFsb2NrX3dyaXRlX2xvY2soJnRpbWVyc19zdGF0ZS52bV9jbG9j
a19zZXFsb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJnRpbWVyc19zdGF0ZS52bV9j
bG9ja19sb2NrKTsKLSAgICAgICAgYXRvbWljX3NldF9pNjQoJnRpbWVyc19zdGF0ZS5xZW11X2lj
b3VudF9iaWFzLAorICAgICAgICBxZW11X2F0b21pY19zZXRfaTY0KCZ0aW1lcnNfc3RhdGUucWVt
dV9pY291bnRfYmlhcywKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXJzX3N0YXRlLnFlbXVf
aWNvdW50X2JpYXMgKyB3YXJwKTsKICAgICAgICAgc2VxbG9ja193cml0ZV91bmxvY2soJnRpbWVy
c19zdGF0ZS52bV9jbG9ja19zZXFsb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAm
dGltZXJzX3N0YXRlLnZtX2Nsb2NrX2xvY2spOwpAQCAtNTgzLDcgKzU4Myw3IEBAIHZvaWQgcWVt
dV9zdGFydF93YXJwX3RpbWVyKHZvaWQpCiAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgIHNl
cWxvY2tfd3JpdGVfbG9jaygmdGltZXJzX3N0YXRlLnZtX2Nsb2NrX3NlcWxvY2ssCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJnRpbWVyc19zdGF0ZS52bV9jbG9ja19sb2NrKTsKLSAg
ICAgICAgICAgIGF0b21pY19zZXRfaTY0KCZ0aW1lcnNfc3RhdGUucWVtdV9pY291bnRfYmlhcywK
KyAgICAgICAgICAgIHFlbXVfYXRvbWljX3NldF9pNjQoJnRpbWVyc19zdGF0ZS5xZW11X2ljb3Vu
dF9iaWFzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZXJzX3N0YXRlLnFlbXVfaWNv
dW50X2JpYXMgKyBkZWFkbGluZSk7CiAgICAgICAgICAgICBzZXFsb2NrX3dyaXRlX3VubG9jaygm
dGltZXJzX3N0YXRlLnZtX2Nsb2NrX3NlcWxvY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAmdGltZXJzX3N0YXRlLnZtX2Nsb2NrX2xvY2spOwpAQCAtODM3LDExICs4MzcsMTEg
QEAgc3RhdGljIHZvaWQgcWVtdV9jcHVfa2lja19ycl9uZXh0X2NwdSh2b2lkKQogewogICAgIENQ
VVN0YXRlICpjcHU7CiAgICAgZG8gewotICAgICAgICBjcHUgPSBhdG9taWNfbWJfcmVhZCgmdGNn
X2N1cnJlbnRfcnJfY3B1KTsKKyAgICAgICAgY3B1ID0gcWVtdV9hdG9taWNfbWJfcmVhZCgmdGNn
X2N1cnJlbnRfcnJfY3B1KTsKICAgICAgICAgaWYgKGNwdSkgewogICAgICAgICAgICAgY3B1X2V4
aXQoY3B1KTsKICAgICAgICAgfQotICAgIH0gd2hpbGUgKGNwdSAhPSBhdG9taWNfbWJfcmVhZCgm
dGNnX2N1cnJlbnRfcnJfY3B1KSk7CisgICAgfSB3aGlsZSAoY3B1ICE9IHFlbXVfYXRvbWljX21i
X3JlYWQoJnRjZ19jdXJyZW50X3JyX2NwdSkpOwogfQogCiAvKiBLaWNrIGFsbCBSUiB2Q1BVcyAq
LwpAQCAtMTExMCw3ICsxMTEwLDcgQEAgc3RhdGljIHZvaWQgcWVtdV9jcHVfc3RvcChDUFVTdGF0
ZSAqY3B1LCBib29sIGV4aXQpCiAKIHN0YXRpYyB2b2lkIHFlbXVfd2FpdF9pb19ldmVudF9jb21t
b24oQ1BVU3RhdGUgKmNwdSkKIHsKLSAgICBhdG9taWNfbWJfc2V0KCZjcHUtPnRocmVhZF9raWNr
ZWQsIGZhbHNlKTsKKyAgICBxZW11X2F0b21pY19tYl9zZXQoJmNwdS0+dGhyZWFkX2tpY2tlZCwg
ZmFsc2UpOwogICAgIGlmIChjcHUtPnN0b3ApIHsKICAgICAgICAgcWVtdV9jcHVfc3RvcChjcHUs
IGZhbHNlKTsKICAgICB9CkBAIC0xMzU2LDcgKzEzNTYsNyBAQCBzdGF0aWMgaW50IHRjZ19jcHVf
ZXhlYyhDUFVTdGF0ZSAqY3B1KQogICAgIHJldCA9IGNwdV9leGVjKGNwdSk7CiAgICAgY3B1X2V4
ZWNfZW5kKGNwdSk7CiAjaWZkZWYgQ09ORklHX1BST0ZJTEVSCi0gICAgYXRvbWljX3NldCgmdGNn
X2N0eC0+cHJvZi5jcHVfZXhlY190aW1lLAorICAgIHFlbXVfYXRvbWljX3NldCgmdGNnX2N0eC0+
cHJvZi5jcHVfZXhlY190aW1lLAogICAgICAgICAgICAgICAgdGNnX2N0eC0+cHJvZi5jcHVfZXhl
Y190aW1lICsgcHJvZmlsZV9nZXRjbG9jaygpIC0gdGkpOwogI2VuZGlmCiAgICAgcmV0dXJuIHJl
dDsKQEAgLTE0NDMsNyArMTQ0Myw3IEBAIHN0YXRpYyB2b2lkICpxZW11X3RjZ19ycl9jcHVfdGhy
ZWFkX2ZuKHZvaWQgKmFyZykKIAogICAgICAgICB3aGlsZSAoY3B1ICYmIGNwdV93b3JrX2xpc3Rf
ZW1wdHkoY3B1KSAmJiAhY3B1LT5leGl0X3JlcXVlc3QpIHsKIAotICAgICAgICAgICAgYXRvbWlj
X21iX3NldCgmdGNnX2N1cnJlbnRfcnJfY3B1LCBjcHUpOworICAgICAgICAgICAgcWVtdV9hdG9t
aWNfbWJfc2V0KCZ0Y2dfY3VycmVudF9ycl9jcHUsIGNwdSk7CiAgICAgICAgICAgICBjdXJyZW50
X2NwdSA9IGNwdTsKIAogICAgICAgICAgICAgcWVtdV9jbG9ja19lbmFibGUoUUVNVV9DTE9DS19W
SVJUVUFMLApAQCAtMTQ3OSwxMSArMTQ3OSwxMSBAQCBzdGF0aWMgdm9pZCAqcWVtdV90Y2dfcnJf
Y3B1X3RocmVhZF9mbih2b2lkICphcmcpCiAgICAgICAgICAgICBjcHUgPSBDUFVfTkVYVChjcHUp
OwogICAgICAgICB9IC8qIHdoaWxlIChjcHUgJiYgIWNwdS0+ZXhpdF9yZXF1ZXN0KS4uICovCiAK
LSAgICAgICAgLyogRG9lcyBub3QgbmVlZCBhdG9taWNfbWJfc2V0IGJlY2F1c2UgYSBzcHVyaW91
cyB3YWtldXAgaXMgb2theS4gICovCi0gICAgICAgIGF0b21pY19zZXQoJnRjZ19jdXJyZW50X3Jy
X2NwdSwgTlVMTCk7CisgICAgICAgIC8qIERvZXNuJ3QgbmVlZCBxZW11X2F0b21pY19tYl9zZXQg
YmVjYXVzZSBhIHNwdXJpb3VzIHdha2V1cCBpcyBva2F5ICovCisgICAgICAgIHFlbXVfYXRvbWlj
X3NldCgmdGNnX2N1cnJlbnRfcnJfY3B1LCBOVUxMKTsKIAogICAgICAgICBpZiAoY3B1ICYmIGNw
dS0+ZXhpdF9yZXF1ZXN0KSB7Ci0gICAgICAgICAgICBhdG9taWNfbWJfc2V0KCZjcHUtPmV4aXRf
cmVxdWVzdCwgMCk7CisgICAgICAgICAgICBxZW11X2F0b21pY19tYl9zZXQoJmNwdS0+ZXhpdF9y
ZXF1ZXN0LCAwKTsKICAgICAgICAgfQogCiAgICAgICAgIGlmICh1c2VfaWNvdW50ICYmIGFsbF9j
cHVfdGhyZWFkc19pZGxlKCkpIHsKQEAgLTE2ODcsNyArMTY4Nyw3IEBAIHN0YXRpYyB2b2lkICpx
ZW11X3RjZ19jcHVfdGhyZWFkX2ZuKHZvaWQgKmFyZykKICAgICAgICAgICAgIH0KICAgICAgICAg
fQogCi0gICAgICAgIGF0b21pY19tYl9zZXQoJmNwdS0+ZXhpdF9yZXF1ZXN0LCAwKTsKKyAgICAg
ICAgcWVtdV9hdG9taWNfbWJfc2V0KCZjcHUtPmV4aXRfcmVxdWVzdCwgMCk7CiAgICAgICAgIHFl
bXVfd2FpdF9pb19ldmVudChjcHUpOwogICAgIH0gd2hpbGUgKCFjcHUtPnVucGx1ZyB8fCBjcHVf
Y2FuX3J1bihjcHUpKTsKIApAQCAtMTc3Niw3ICsxNzc2LDcgQEAgYm9vbCBxZW11X211dGV4X2lv
dGhyZWFkX2xvY2tlZCh2b2lkKQogICovCiB2b2lkIHFlbXVfbXV0ZXhfbG9ja19pb3RocmVhZF9p
bXBsKGNvbnN0IGNoYXIgKmZpbGUsIGludCBsaW5lKQogewotICAgIFFlbXVNdXRleExvY2tGdW5j
IGJxbF9sb2NrID0gYXRvbWljX3JlYWQoJnFlbXVfYnFsX211dGV4X2xvY2tfZnVuYyk7CisgICAg
UWVtdU11dGV4TG9ja0Z1bmMgYnFsX2xvY2sgPSBxZW11X2F0b21pY19yZWFkKCZxZW11X2JxbF9t
dXRleF9sb2NrX2Z1bmMpOwogCiAgICAgZ19hc3NlcnQoIXFlbXVfbXV0ZXhfaW90aHJlYWRfbG9j
a2VkKCkpOwogICAgIGJxbF9sb2NrKCZxZW11X2dsb2JhbF9tdXRleCwgZmlsZSwgbGluZSk7CmRp
ZmYgLS1naXQgYS9zb2Z0bW11L21lbW9yeS5jIGIvc29mdG1tdS9tZW1vcnkuYwppbmRleCBkMDMw
ZWI2ZjdjLi5jYWJiZDRlYTNhIDEwMDY0NAotLS0gYS9zb2Z0bW11L21lbW9yeS5jCisrKyBiL3Nv
ZnRtbXUvbWVtb3J5LmMKQEAgLTI5NCwxMiArMjk0LDEyIEBAIHN0YXRpYyB2b2lkIGZsYXR2aWV3
X2Rlc3Ryb3koRmxhdFZpZXcgKnZpZXcpCiAKIHN0YXRpYyBib29sIGZsYXR2aWV3X3JlZihGbGF0
VmlldyAqdmlldykKIHsKLSAgICByZXR1cm4gYXRvbWljX2ZldGNoX2luY19ub256ZXJvKCZ2aWV3
LT5yZWYpID4gMDsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfZmV0Y2hfaW5jX25vbnplcm8oJnZp
ZXctPnJlZikgPiAwOwogfQogCiB2b2lkIGZsYXR2aWV3X3VucmVmKEZsYXRWaWV3ICp2aWV3KQog
ewotICAgIGlmIChhdG9taWNfZmV0Y2hfZGVjKCZ2aWV3LT5yZWYpID09IDEpIHsKKyAgICBpZiAo
cWVtdV9hdG9taWNfZmV0Y2hfZGVjKCZ2aWV3LT5yZWYpID09IDEpIHsKICAgICAgICAgdHJhY2Vf
ZmxhdHZpZXdfZGVzdHJveV9yY3Uodmlldywgdmlldy0+cm9vdCk7CiAgICAgICAgIGFzc2VydCh2
aWV3LT5yb290KTsKICAgICAgICAgY2FsbF9yY3UodmlldywgZmxhdHZpZXdfZGVzdHJveSwgcmN1
KTsKQEAgLTEwMjcsNyArMTAyNyw3IEBAIHN0YXRpYyB2b2lkIGFkZHJlc3Nfc3BhY2Vfc2V0X2Zs
YXR2aWV3KEFkZHJlc3NTcGFjZSAqYXMpCiAgICAgfQogCiAgICAgLyogV3JpdGVzIGFyZSBwcm90
ZWN0ZWQgYnkgdGhlIEJRTC4gICovCi0gICAgYXRvbWljX3JjdV9zZXQoJmFzLT5jdXJyZW50X21h
cCwgbmV3X3ZpZXcpOworICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoJmFzLT5jdXJyZW50X21hcCwg
bmV3X3ZpZXcpOwogICAgIGlmIChvbGRfdmlldykgewogICAgICAgICBmbGF0dmlld191bnJlZihv
bGRfdmlldyk7CiAgICAgfQpkaWZmIC0tZ2l0IGEvc29mdG1tdS92bC5jIGIvc29mdG1tdS92bC5j
CmluZGV4IGY3YjEwMzQ2N2MuLjM2YWM1NWNiOTEgMTAwNjQ0Ci0tLSBhL3NvZnRtbXUvdmwuYwor
KysgYi9zb2Z0bW11L3ZsLmMKQEAgLTEzMjAsNyArMTMyMCw3IEBAIFNodXRkb3duQ2F1c2UgcWVt
dV9yZXNldF9yZXF1ZXN0ZWRfZ2V0KHZvaWQpCiAKIHN0YXRpYyBpbnQgcWVtdV9zaHV0ZG93bl9y
ZXF1ZXN0ZWQodm9pZCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3hjaGcoJnNodXRkb3duX3JlcXVl
c3RlZCwgU0hVVERPV05fQ0FVU0VfTk9ORSk7CisgICAgcmV0dXJuIHFlbXVfYXRvbWljX3hjaGco
JnNodXRkb3duX3JlcXVlc3RlZCwgU0hVVERPV05fQ0FVU0VfTk9ORSk7CiB9CiAKIHN0YXRpYyB2
b2lkIHFlbXVfa2lsbF9yZXBvcnQodm9pZCkKZGlmZiAtLWdpdCBhL3RhcmdldC9hcm0vbXRlX2hl
bHBlci5jIGIvdGFyZ2V0L2FybS9tdGVfaGVscGVyLmMKaW5kZXggODkxMzA2ZjViMC4uZTFhZGY1
YWUzMyAxMDA2NDQKLS0tIGEvdGFyZ2V0L2FybS9tdGVfaGVscGVyLmMKKysrIGIvdGFyZ2V0L2Fy
bS9tdGVfaGVscGVyLmMKQEAgLTMxMywxMSArMzEzLDExIEBAIHN0YXRpYyB2b2lkIHN0b3JlX3Rh
ZzEodWludDY0X3QgcHRyLCB1aW50OF90ICptZW0sIGludCB0YWcpCiBzdGF0aWMgdm9pZCBzdG9y
ZV90YWcxX3BhcmFsbGVsKHVpbnQ2NF90IHB0ciwgdWludDhfdCAqbWVtLCBpbnQgdGFnKQogewog
ICAgIGludCBvZnMgPSBleHRyYWN0MzIocHRyLCBMT0cyX1RBR19HUkFOVUxFLCAxKSAqIDQ7Ci0g
ICAgdWludDhfdCBvbGQgPSBhdG9taWNfcmVhZChtZW0pOworICAgIHVpbnQ4X3Qgb2xkID0gcWVt
dV9hdG9taWNfcmVhZChtZW0pOwogCiAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgdWludDhfdCBu
ZXcgPSBkZXBvc2l0MzIob2xkLCBvZnMsIDQsIHRhZyk7Ci0gICAgICAgIHVpbnQ4X3QgY21wID0g
YXRvbWljX2NtcHhjaGcobWVtLCBvbGQsIG5ldyk7CisgICAgICAgIHVpbnQ4X3QgY21wID0gcWVt
dV9hdG9taWNfY21weGNoZyhtZW0sIG9sZCwgbmV3KTsKICAgICAgICAgaWYgKGxpa2VseShjbXAg
PT0gb2xkKSkgewogICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICB9CkBAIC0zOTgsNyArMzk4
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGRvX3N0MmcoQ1BVQVJNU3RhdGUgKmVudiwgdWludDY0
X3QgcHRyLCB1aW50NjRfdCB4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAy
ICogVEFHX0dSQU5VTEUsIE1NVV9EQVRBX1NUT1JFLCAxLCByYSk7CiAgICAgICAgIGlmIChtZW0x
KSB7CiAgICAgICAgICAgICB0YWcgfD0gdGFnIDw8IDQ7Ci0gICAgICAgICAgICBhdG9taWNfc2V0
KG1lbTEsIHRhZyk7CisgICAgICAgICAgICBxZW11X2F0b21pY19zZXQobWVtMSwgdGFnKTsKICAg
ICAgICAgfQogICAgIH0KIH0KZGlmZiAtLWdpdCBhL3RhcmdldC9ocHBhL29wX2hlbHBlci5jIGIv
dGFyZ2V0L2hwcGEvb3BfaGVscGVyLmMKaW5kZXggNTY4NWUzMDNhYi4uYmEzM2NiYTI3YyAxMDA2
NDQKLS0tIGEvdGFyZ2V0L2hwcGEvb3BfaGVscGVyLmMKKysrIGIvdGFyZ2V0L2hwcGEvb3BfaGVs
cGVyLmMKQEAgLTY3LDcgKzY3LDcgQEAgc3RhdGljIHZvaWQgYXRvbWljX3N0b3JlXzMoQ1BVSFBQ
QVN0YXRlICplbnYsIHRhcmdldF91bG9uZyBhZGRyLCB1aW50MzJfdCB2YWwsCiAgICAgb2xkID0g
KmhhZGRyOwogICAgIHdoaWxlICgxKSB7CiAgICAgICAgIG5ldyA9IChvbGQgJiB+bWFzaykgfCAo
dmFsICYgbWFzayk7Ci0gICAgICAgIGNtcCA9IGF0b21pY19jbXB4Y2hnKGhhZGRyLCBvbGQsIG5l
dyk7CisgICAgICAgIGNtcCA9IHFlbXVfYXRvbWljX2NtcHhjaGcoaGFkZHIsIG9sZCwgbmV3KTsK
ICAgICAgICAgaWYgKGNtcCA9PSBvbGQpIHsKICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg
fQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L2kzODYvbWVtX2hlbHBlci5jIGIvdGFyZ2V0L2kzODYvbWVt
X2hlbHBlci5jCmluZGV4IGFjZjQxZjg4ODUuLmRhN2I0ZDZkNjcgMTAwNjQ0Ci0tLSBhL3Rhcmdl
dC9pMzg2L21lbV9oZWxwZXIuYworKysgYi90YXJnZXQvaTM4Ni9tZW1faGVscGVyLmMKQEAgLTY4
LDcgKzY4LDcgQEAgdm9pZCBoZWxwZXJfY21weGNoZzhiKENQVVg4NlN0YXRlICplbnYsIHRhcmdl
dF91bG9uZyBhMCkKICAgICAgICAgdWludDY0X3QgKmhhZGRyID0gZzJoKGEwKTsKICAgICAgICAg
Y21wdiA9IGNwdV90b19sZTY0KGNtcHYpOwogICAgICAgICBuZXd2ID0gY3B1X3RvX2xlNjQobmV3
dik7Ci0gICAgICAgIG9sZHYgPSBhdG9taWNfY21weGNoZ19fbm9jaGVjayhoYWRkciwgY21wdiwg
bmV3dik7CisgICAgICAgIG9sZHYgPSBxZW11X2F0b21pY19jbXB4Y2hnX19ub2NoZWNrKGhhZGRy
LCBjbXB2LCBuZXd2KTsKICAgICAgICAgb2xkdiA9IGxlNjRfdG9fY3B1KG9sZHYpOwogICAgIH0K
ICNlbHNlCmRpZmYgLS1naXQgYS90YXJnZXQvaTM4Ni93aHB4LWFsbC5jIGIvdGFyZ2V0L2kzODYv
d2hweC1hbGwuYwppbmRleCBjNzhiYWFjNmRmLi41N2Q1NmQzODMxIDEwMDY0NAotLS0gYS90YXJn
ZXQvaTM4Ni93aHB4LWFsbC5jCisrKyBiL3RhcmdldC9pMzg2L3docHgtYWxsLmMKQEAgLTk0Niw3
ICs5NDYsNyBAQCBzdGF0aWMgaW50IHdocHhfdmNwdV9ydW4oQ1BVU3RhdGUgKmNwdSkKICAgICB3
aHB4X3ZjcHVfcHJvY2Vzc19hc3luY19ldmVudHMoY3B1KTsKICAgICBpZiAoY3B1LT5oYWx0ZWQp
IHsKICAgICAgICAgY3B1LT5leGNlcHRpb25faW5kZXggPSBFWENQX0hMVDsKLSAgICAgICAgYXRv
bWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIGZhbHNlKTsKKyAgICAgICAgcWVtdV9hdG9taWNf
c2V0KCZjcHUtPmV4aXRfcmVxdWVzdCwgZmFsc2UpOwogICAgICAgICByZXR1cm4gMDsKICAgICB9
CiAKQEAgLTk2MSw3ICs5NjEsNyBAQCBzdGF0aWMgaW50IHdocHhfdmNwdV9ydW4oQ1BVU3RhdGUg
KmNwdSkKIAogICAgICAgICB3aHB4X3ZjcHVfcHJlX3J1bihjcHUpOwogCi0gICAgICAgIGlmIChh
dG9taWNfcmVhZCgmY3B1LT5leGl0X3JlcXVlc3QpKSB7CisgICAgICAgIGlmIChxZW11X2F0b21p
Y19yZWFkKCZjcHUtPmV4aXRfcmVxdWVzdCkpIHsKICAgICAgICAgICAgIHdocHhfdmNwdV9raWNr
KGNwdSk7CiAgICAgICAgIH0KIApAQCAtMTExMyw3ICsxMTEzLDcgQEAgc3RhdGljIGludCB3aHB4
X3ZjcHVfcnVuKENQVVN0YXRlICpjcHUpCiAgICAgcWVtdV9tdXRleF9sb2NrX2lvdGhyZWFkKCk7
CiAgICAgY3VycmVudF9jcHUgPSBjcHU7CiAKLSAgICBhdG9taWNfc2V0KCZjcHUtPmV4aXRfcmVx
dWVzdCwgZmFsc2UpOworICAgIHFlbXVfYXRvbWljX3NldCgmY3B1LT5leGl0X3JlcXVlc3QsIGZh
bHNlKTsKIAogICAgIHJldHVybiByZXQgPCAwOwogfQpkaWZmIC0tZ2l0IGEvdGFyZ2V0L3Jpc2N2
L2NwdV9oZWxwZXIuYyBiL3RhcmdldC9yaXNjdi9jcHVfaGVscGVyLmMKaW5kZXggZjRjNDExMTUz
Ni4uNDE3NzllMzA2OCAxMDA2NDQKLS0tIGEvdGFyZ2V0L3Jpc2N2L2NwdV9oZWxwZXIuYworKysg
Yi90YXJnZXQvcmlzY3YvY3B1X2hlbHBlci5jCkBAIC01MzcsNyArNTM3LDcgQEAgcmVzdGFydDoK
ICAgICAgICAgICAgICAgICAgICAgKnB0ZV9wYSA9IHB0ZSA9IHVwZGF0ZWRfcHRlOwogI2Vsc2UK
ICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X3Vsb25nIG9sZF9wdGUgPQotICAgICAgICAgICAg
ICAgICAgICAgICAgYXRvbWljX2NtcHhjaGcocHRlX3BhLCBwdGUsIHVwZGF0ZWRfcHRlKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX2NtcHhjaGcocHRlX3BhLCBwdGUsIHVw
ZGF0ZWRfcHRlKTsKICAgICAgICAgICAgICAgICAgICAgaWYgKG9sZF9wdGUgIT0gcHRlKSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgICBnb3RvIHJlc3RhcnQ7CiAgICAgICAgICAgICAgICAgICAg
IH0gZWxzZSB7CmRpZmYgLS1naXQgYS90YXJnZXQvczM5MHgvbWVtX2hlbHBlci5jIGIvdGFyZ2V0
L3MzOTB4L21lbV9oZWxwZXIuYwppbmRleCBhMjM3ZGVjNzU3Li4yNmQ5N2RkMGM1IDEwMDY0NAot
LS0gYS90YXJnZXQvczM5MHgvbWVtX2hlbHBlci5jCisrKyBiL3RhcmdldC9zMzkweC9tZW1faGVs
cGVyLmMKQEAgLTE3ODAsNyArMTc4MCw3IEBAIHN0YXRpYyB1aW50MzJfdCBkb19jc3N0KENQVVMz
OTBYU3RhdGUgKmVudiwgdWludDMyX3QgcjMsIHVpbnQ2NF90IGExLAogICAgICAgICAgICAgaWYg
KHBhcmFsbGVsKSB7CiAjaWZkZWYgQ09ORklHX1VTRVJfT05MWQogICAgICAgICAgICAgICAgIHVp
bnQzMl90ICpoYWRkciA9IGcyaChhMSk7Ci0gICAgICAgICAgICAgICAgb3YgPSBhdG9taWNfY21w
eGNoZ19fbm9jaGVjayhoYWRkciwgY3YsIG52KTsKKyAgICAgICAgICAgICAgICBvdiA9IHFlbXVf
YXRvbWljX2NtcHhjaGdfX25vY2hlY2soaGFkZHIsIGN2LCBudik7CiAjZWxzZQogICAgICAgICAg
ICAgICAgIFRDR01lbU9wSWR4IG9pID0gbWFrZV9tZW1vcF9pZHgoTU9fVEVVTCB8IE1PX0FMSUdO
LCBtZW1faWR4KTsKICAgICAgICAgICAgICAgICBvdiA9IGhlbHBlcl9hdG9taWNfY21weGNoZ2xf
YmVfbW11KGVudiwgYTEsIGN2LCBudiwgb2ksIHJhKTsKQEAgLTE4MDQsNyArMTgwNCw3IEBAIHN0
YXRpYyB1aW50MzJfdCBkb19jc3N0KENQVVMzOTBYU3RhdGUgKmVudiwgdWludDMyX3QgcjMsIHVp
bnQ2NF90IGExLAogI2lmZGVmIENPTkZJR19BVE9NSUM2NAogIyBpZmRlZiBDT05GSUdfVVNFUl9P
TkxZCiAgICAgICAgICAgICAgICAgdWludDY0X3QgKmhhZGRyID0gZzJoKGExKTsKLSAgICAgICAg
ICAgICAgICBvdiA9IGF0b21pY19jbXB4Y2hnX19ub2NoZWNrKGhhZGRyLCBjdiwgbnYpOworICAg
ICAgICAgICAgICAgIG92ID0gcWVtdV9hdG9taWNfY21weGNoZ19fbm9jaGVjayhoYWRkciwgY3Ys
IG52KTsKICMgZWxzZQogICAgICAgICAgICAgICAgIFRDR01lbU9wSWR4IG9pID0gbWFrZV9tZW1v
cF9pZHgoTU9fVEVRIHwgTU9fQUxJR04sIG1lbV9pZHgpOwogICAgICAgICAgICAgICAgIG92ID0g
aGVscGVyX2F0b21pY19jbXB4Y2hncV9iZV9tbXUoZW52LCBhMSwgY3YsIG52LCBvaSwgcmEpOwpk
aWZmIC0tZ2l0IGEvdGFyZ2V0L3h0ZW5zYS9leGNfaGVscGVyLmMgYi90YXJnZXQveHRlbnNhL2V4
Y19oZWxwZXIuYwppbmRleCA1OGE2NGU2ZDYyLi5kZDNmODIyNmI5IDEwMDY0NAotLS0gYS90YXJn
ZXQveHRlbnNhL2V4Y19oZWxwZXIuYworKysgYi90YXJnZXQveHRlbnNhL2V4Y19oZWxwZXIuYwpA
QCAtMTI4LDEzICsxMjgsMTMgQEAgdm9pZCBIRUxQRVIoY2hlY2tfaW50ZXJydXB0cykoQ1BVWHRl
bnNhU3RhdGUgKmVudikKIAogdm9pZCBIRUxQRVIoaW50c2V0KShDUFVYdGVuc2FTdGF0ZSAqZW52
LCB1aW50MzJfdCB2KQogewotICAgIGF0b21pY19vcigmZW52LT5zcmVnc1tJTlRTRVRdLAorICAg
IHFlbXVfYXRvbWljX29yKCZlbnYtPnNyZWdzW0lOVFNFVF0sCiAgICAgICAgICAgICAgIHYgJiBl
bnYtPmNvbmZpZy0+aW50dHlwZV9tYXNrW0lOVFRZUEVfU09GVFdBUkVdKTsKIH0KIAogc3RhdGlj
IHZvaWQgaW50Y2xlYXIoQ1BVWHRlbnNhU3RhdGUgKmVudiwgdWludDMyX3QgdikKIHsKLSAgICBh
dG9taWNfYW5kKCZlbnYtPnNyZWdzW0lOVFNFVF0sIH52KTsKKyAgICBxZW11X2F0b21pY19hbmQo
JmVudi0+c3JlZ3NbSU5UU0VUXSwgfnYpOwogfQogCiB2b2lkIEhFTFBFUihpbnRjbGVhcikoQ1BV
WHRlbnNhU3RhdGUgKmVudiwgdWludDMyX3QgdikKZGlmZiAtLWdpdCBhL3RhcmdldC94dGVuc2Ev
b3BfaGVscGVyLmMgYi90YXJnZXQveHRlbnNhL29wX2hlbHBlci5jCmluZGV4IDA5ZjQ5NjJkMDAu
LjhiMmIyNmM2MjIgMTAwNjQ0Ci0tLSBhL3RhcmdldC94dGVuc2Evb3BfaGVscGVyLmMKKysrIGIv
dGFyZ2V0L3h0ZW5zYS9vcF9oZWxwZXIuYwpAQCAtNjIsNyArNjIsNyBAQCB2b2lkIEhFTFBFUih1
cGRhdGVfY2NvbXBhcmUpKENQVVh0ZW5zYVN0YXRlICplbnYsIHVpbnQzMl90IGkpCiB7CiAgICAg
dWludDY0X3QgZGNjOwogCi0gICAgYXRvbWljX2FuZCgmZW52LT5zcmVnc1tJTlRTRVRdLAorICAg
IHFlbXVfYXRvbWljX2FuZCgmZW52LT5zcmVnc1tJTlRTRVRdLAogICAgICAgICAgICAgICAgfigx
dSA8PCBlbnYtPmNvbmZpZy0+dGltZXJpbnRbaV0pKTsKICAgICBIRUxQRVIodXBkYXRlX2Njb3Vu
dCkoZW52KTsKICAgICBkY2MgPSAodWludDY0X3QpKGVudi0+c3JlZ3NbQ0NPTVBBUkUgKyBpXSAt
IGVudi0+c3JlZ3NbQ0NPVU5UXSAtIDEpICsgMTsKZGlmZiAtLWdpdCBhL3RjZy90Y2cuYyBiL3Rj
Zy90Y2cuYwppbmRleCA2MmYyOTllMzZlLi44ODE1MmFlNGRmIDEwMDY0NAotLS0gYS90Y2cvdGNn
LmMKKysrIGIvdGNnL3RjZy5jCkBAIC01OTcsNyArNTk3LDcgQEAgc3RhdGljIGlubGluZSBib29s
IHRjZ19yZWdpb25faW5pdGlhbF9hbGxvY19fbG9ja2VkKFRDR0NvbnRleHQgKnMpCiAvKiBDYWxs
IGZyb20gYSBzYWZlLXdvcmsgY29udGV4dCAqLwogdm9pZCB0Y2dfcmVnaW9uX3Jlc2V0X2FsbCh2
b2lkKQogewotICAgIHVuc2lnbmVkIGludCBuX2N0eHMgPSBhdG9taWNfcmVhZCgmbl90Y2dfY3R4
cyk7CisgICAgdW5zaWduZWQgaW50IG5fY3R4cyA9IHFlbXVfYXRvbWljX3JlYWQoJm5fdGNnX2N0
eHMpOwogICAgIHVuc2lnbmVkIGludCBpOwogCiAgICAgcWVtdV9tdXRleF9sb2NrKCZyZWdpb24u
bG9jayk7CkBAIC02MDUsNyArNjA1LDcgQEAgdm9pZCB0Y2dfcmVnaW9uX3Jlc2V0X2FsbCh2b2lk
KQogICAgIHJlZ2lvbi5hZ2dfc2l6ZV9mdWxsID0gMDsKIAogICAgIGZvciAoaSA9IDA7IGkgPCBu
X2N0eHM7IGkrKykgewotICAgICAgICBUQ0dDb250ZXh0ICpzID0gYXRvbWljX3JlYWQoJnRjZ19j
dHhzW2ldKTsKKyAgICAgICAgVENHQ29udGV4dCAqcyA9IHFlbXVfYXRvbWljX3JlYWQoJnRjZ19j
dHhzW2ldKTsKICAgICAgICAgYm9vbCBlcnIgPSB0Y2dfcmVnaW9uX2luaXRpYWxfYWxsb2NfX2xv
Y2tlZChzKTsKIAogICAgICAgICBnX2Fzc2VydCghZXJyKTsKQEAgLTc5NCw5ICs3OTQsOSBAQCB2
b2lkIHRjZ19yZWdpc3Rlcl90aHJlYWQodm9pZCkKICAgICB9CiAKICAgICAvKiBDbGFpbSBhbiBl
bnRyeSBpbiB0Y2dfY3R4cyAqLwotICAgIG4gPSBhdG9taWNfZmV0Y2hfaW5jKCZuX3RjZ19jdHhz
KTsKKyAgICBuID0gcWVtdV9hdG9taWNfZmV0Y2hfaW5jKCZuX3RjZ19jdHhzKTsKICAgICBnX2Fz
c2VydChuIDwgbXMtPnNtcC5tYXhfY3B1cyk7Ci0gICAgYXRvbWljX3NldCgmdGNnX2N0eHNbbl0s
IHMpOworICAgIHFlbXVfYXRvbWljX3NldCgmdGNnX2N0eHNbbl0sIHMpOwogCiAgICAgaWYgKG4g
PiAwKSB7CiAgICAgICAgIGFsbG9jX3RjZ19wbHVnaW5fY29udGV4dChzKTsKQEAgLTgxOSwxNyAr
ODE5LDE3IEBAIHZvaWQgdGNnX3JlZ2lzdGVyX3RocmVhZCh2b2lkKQogICovCiBzaXplX3QgdGNn
X2NvZGVfc2l6ZSh2b2lkKQogewotICAgIHVuc2lnbmVkIGludCBuX2N0eHMgPSBhdG9taWNfcmVh
ZCgmbl90Y2dfY3R4cyk7CisgICAgdW5zaWduZWQgaW50IG5fY3R4cyA9IHFlbXVfYXRvbWljX3Jl
YWQoJm5fdGNnX2N0eHMpOwogICAgIHVuc2lnbmVkIGludCBpOwogICAgIHNpemVfdCB0b3RhbDsK
IAogICAgIHFlbXVfbXV0ZXhfbG9jaygmcmVnaW9uLmxvY2spOwogICAgIHRvdGFsID0gcmVnaW9u
LmFnZ19zaXplX2Z1bGw7CiAgICAgZm9yIChpID0gMDsgaSA8IG5fY3R4czsgaSsrKSB7Ci0gICAg
ICAgIGNvbnN0IFRDR0NvbnRleHQgKnMgPSBhdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0pOworICAg
ICAgICBjb25zdCBUQ0dDb250ZXh0ICpzID0gcWVtdV9hdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0p
OwogICAgICAgICBzaXplX3Qgc2l6ZTsKIAotICAgICAgICBzaXplID0gYXRvbWljX3JlYWQoJnMt
PmNvZGVfZ2VuX3B0cikgLSBzLT5jb2RlX2dlbl9idWZmZXI7CisgICAgICAgIHNpemUgPSBxZW11
X2F0b21pY19yZWFkKCZzLT5jb2RlX2dlbl9wdHIpIC0gcy0+Y29kZV9nZW5fYnVmZmVyOwogICAg
ICAgICBnX2Fzc2VydChzaXplIDw9IHMtPmNvZGVfZ2VuX2J1ZmZlcl9zaXplKTsKICAgICAgICAg
dG90YWwgKz0gc2l6ZTsKICAgICB9CkBAIC04NTUsMTQgKzg1NSwxNCBAQCBzaXplX3QgdGNnX2Nv
ZGVfY2FwYWNpdHkodm9pZCkKIAogc2l6ZV90IHRjZ190Yl9waHlzX2ludmFsaWRhdGVfY291bnQo
dm9pZCkKIHsKLSAgICB1bnNpZ25lZCBpbnQgbl9jdHhzID0gYXRvbWljX3JlYWQoJm5fdGNnX2N0
eHMpOworICAgIHVuc2lnbmVkIGludCBuX2N0eHMgPSBxZW11X2F0b21pY19yZWFkKCZuX3RjZ19j
dHhzKTsKICAgICB1bnNpZ25lZCBpbnQgaTsKICAgICBzaXplX3QgdG90YWwgPSAwOwogCiAgICAg
Zm9yIChpID0gMDsgaSA8IG5fY3R4czsgaSsrKSB7Ci0gICAgICAgIGNvbnN0IFRDR0NvbnRleHQg
KnMgPSBhdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0pOworICAgICAgICBjb25zdCBUQ0dDb250ZXh0
ICpzID0gcWVtdV9hdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0pOwogCi0gICAgICAgIHRvdGFsICs9
IGF0b21pY19yZWFkKCZzLT50Yl9waHlzX2ludmFsaWRhdGVfY291bnQpOworICAgICAgICB0b3Rh
bCArPSBxZW11X2F0b21pY19yZWFkKCZzLT50Yl9waHlzX2ludmFsaWRhdGVfY291bnQpOwogICAg
IH0KICAgICByZXR1cm4gdG90YWw7CiB9CkBAIC0xMDQxLDcgKzEwNDEsNyBAQCBUcmFuc2xhdGlv
bkJsb2NrICp0Y2dfdGJfYWxsb2MoVENHQ29udGV4dCAqcykKICAgICAgICAgfQogICAgICAgICBn
b3RvIHJldHJ5OwogICAgIH0KLSAgICBhdG9taWNfc2V0KCZzLT5jb2RlX2dlbl9wdHIsIG5leHQp
OworICAgIHFlbXVfYXRvbWljX3NldCgmcy0+Y29kZV9nZW5fcHRyLCBuZXh0KTsKICAgICBzLT5k
YXRhX2dlbl9wdHIgPSBOVUxMOwogICAgIHJldHVybiB0YjsKIH0KQEAgLTIxMzQsNyArMjEzNCw3
IEBAIHN0YXRpYyB2b2lkIHRjZ19kdW1wX29wcyhUQ0dDb250ZXh0ICpzLCBib29sIGhhdmVfcHJl
ZnMpCiAgICAgICAgICAgICBRZW11TG9nRmlsZSAqbG9nZmlsZTsKIAogICAgICAgICAgICAgcmN1
X3JlYWRfbG9jaygpOwotICAgICAgICAgICAgbG9nZmlsZSA9IGF0b21pY19yY3VfcmVhZCgmcWVt
dV9sb2dmaWxlKTsKKyAgICAgICAgICAgIGxvZ2ZpbGUgPSBxZW11X2F0b21pY19yY3VfcmVhZCgm
cWVtdV9sb2dmaWxlKTsKICAgICAgICAgICAgIGlmIChsb2dmaWxlKSB7CiAgICAgICAgICAgICAg
ICAgZm9yICg7IGNvbCA8IDQwOyArK2NvbCkgewogICAgICAgICAgICAgICAgICAgICBwdXRjKCcg
JywgbG9nZmlsZS0+ZmQpOwpAQCAtMjM0MSw3ICsyMzQxLDcgQEAgdm9pZCB0Y2dfb3BfcmVtb3Zl
KFRDR0NvbnRleHQgKnMsIFRDR09wICpvcCkKICAgICBzLT5uYl9vcHMtLTsKIAogI2lmZGVmIENP
TkZJR19QUk9GSUxFUgotICAgIGF0b21pY19zZXQoJnMtPnByb2YuZGVsX29wX2NvdW50LCBzLT5w
cm9mLmRlbF9vcF9jb3VudCArIDEpOworICAgIHFlbXVfYXRvbWljX3NldCgmcy0+cHJvZi5kZWxf
b3BfY291bnQsIHMtPnByb2YuZGVsX29wX2NvdW50ICsgMSk7CiAjZW5kaWYKIH0KIApAQCAtMzk2
NCwxMiArMzk2NCwxMiBAQCBzdGF0aWMgdm9pZCB0Y2dfcmVnX2FsbG9jX2NhbGwoVENHQ29udGV4
dCAqcywgVENHT3AgKm9wKQogLyogYXZvaWQgY29weS9wYXN0ZSBlcnJvcnMgKi8KICNkZWZpbmUg
UFJPRl9BREQodG8sIGZyb20sIGZpZWxkKSAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIGRv
IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAg
ICAgICh0byktPmZpZWxkICs9IGF0b21pY19yZWFkKCYoKGZyb20pLT5maWVsZCkpOyAgIFwKKyAg
ICAgICAgKHRvKS0+ZmllbGQgKz0gcWVtdV9hdG9taWNfcmVhZCgmKChmcm9tKS0+ZmllbGQpKTsg
ICBcCiAgICAgfSB3aGlsZSAoMCkKIAogI2RlZmluZSBQUk9GX01BWCh0bywgZnJvbSwgZmllbGQp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIGRvIHsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAotICAgICAgICB0eXBlb2YoKGZyb20pLT5maWVsZCkgdmFsX18gPSBhdG9taWNfcmVhZCgmKChm
cm9tKS0+ZmllbGQpKTsgICAgXAorICAgICAgICB0eXBlb2YoKGZyb20pLT5maWVsZCkgdmFsX18g
PSBxZW11X2F0b21pY19yZWFkKCYoKGZyb20pLT5maWVsZCkpOyAgICBcCiAgICAgICAgIGlmICh2
YWxfXyA+ICh0byktPmZpZWxkKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCiAgICAgICAgICAgICAodG8pLT5maWVsZCA9IHZhbF9fOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCiAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCkBAIC0zOTc5LDExICszOTc5
LDExIEBAIHN0YXRpYyB2b2lkIHRjZ19yZWdfYWxsb2NfY2FsbChUQ0dDb250ZXh0ICpzLCBUQ0dP
cCAqb3ApCiBzdGF0aWMgaW5saW5lCiB2b2lkIHRjZ19wcm9maWxlX3NuYXBzaG90KFRDR1Byb2Zp
bGUgKnByb2YsIGJvb2wgY291bnRlcnMsIGJvb2wgdGFibGUpCiB7Ci0gICAgdW5zaWduZWQgaW50
IG5fY3R4cyA9IGF0b21pY19yZWFkKCZuX3RjZ19jdHhzKTsKKyAgICB1bnNpZ25lZCBpbnQgbl9j
dHhzID0gcWVtdV9hdG9taWNfcmVhZCgmbl90Y2dfY3R4cyk7CiAgICAgdW5zaWduZWQgaW50IGk7
CiAKICAgICBmb3IgKGkgPSAwOyBpIDwgbl9jdHhzOyBpKyspIHsKLSAgICAgICAgVENHQ29udGV4
dCAqcyA9IGF0b21pY19yZWFkKCZ0Y2dfY3R4c1tpXSk7CisgICAgICAgIFRDR0NvbnRleHQgKnMg
PSBxZW11X2F0b21pY19yZWFkKCZ0Y2dfY3R4c1tpXSk7CiAgICAgICAgIGNvbnN0IFRDR1Byb2Zp
bGUgKm9yaWcgPSAmcy0+cHJvZjsKIAogICAgICAgICBpZiAoY291bnRlcnMpIHsKQEAgLTQwNDIs
MTUgKzQwNDIsMTUgQEAgdm9pZCB0Y2dfZHVtcF9vcF9jb3VudCh2b2lkKQogCiBpbnQ2NF90IHRj
Z19jcHVfZXhlY190aW1lKHZvaWQpCiB7Ci0gICAgdW5zaWduZWQgaW50IG5fY3R4cyA9IGF0b21p
Y19yZWFkKCZuX3RjZ19jdHhzKTsKKyAgICB1bnNpZ25lZCBpbnQgbl9jdHhzID0gcWVtdV9hdG9t
aWNfcmVhZCgmbl90Y2dfY3R4cyk7CiAgICAgdW5zaWduZWQgaW50IGk7CiAgICAgaW50NjRfdCBy
ZXQgPSAwOwogCiAgICAgZm9yIChpID0gMDsgaSA8IG5fY3R4czsgaSsrKSB7Ci0gICAgICAgIGNv
bnN0IFRDR0NvbnRleHQgKnMgPSBhdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0pOworICAgICAgICBj
b25zdCBUQ0dDb250ZXh0ICpzID0gcWVtdV9hdG9taWNfcmVhZCgmdGNnX2N0eHNbaV0pOwogICAg
ICAgICBjb25zdCBUQ0dQcm9maWxlICpwcm9mID0gJnMtPnByb2Y7CiAKLSAgICAgICAgcmV0ICs9
IGF0b21pY19yZWFkKCZwcm9mLT5jcHVfZXhlY190aW1lKTsKKyAgICAgICAgcmV0ICs9IHFlbXVf
YXRvbWljX3JlYWQoJnByb2YtPmNwdV9leGVjX3RpbWUpOwogICAgIH0KICAgICByZXR1cm4gcmV0
OwogfQpAQCAtNDA4MywxNSArNDA4MywxNSBAQCBpbnQgdGNnX2dlbl9jb2RlKFRDR0NvbnRleHQg
KnMsIFRyYW5zbGF0aW9uQmxvY2sgKnRiKQogICAgICAgICBRVEFJTFFfRk9SRUFDSChvcCwgJnMt
Pm9wcywgbGluaykgewogICAgICAgICAgICAgbisrOwogICAgICAgICB9Ci0gICAgICAgIGF0b21p
Y19zZXQoJnByb2YtPm9wX2NvdW50LCBwcm9mLT5vcF9jb3VudCArIG4pOworICAgICAgICBxZW11
X2F0b21pY19zZXQoJnByb2YtPm9wX2NvdW50LCBwcm9mLT5vcF9jb3VudCArIG4pOwogICAgICAg
ICBpZiAobiA+IHByb2YtPm9wX2NvdW50X21heCkgewotICAgICAgICAgICAgYXRvbWljX3NldCgm
cHJvZi0+b3BfY291bnRfbWF4LCBuKTsKKyAgICAgICAgICAgIHFlbXVfYXRvbWljX3NldCgmcHJv
Zi0+b3BfY291bnRfbWF4LCBuKTsKICAgICAgICAgfQogCiAgICAgICAgIG4gPSBzLT5uYl90ZW1w
czsKLSAgICAgICAgYXRvbWljX3NldCgmcHJvZi0+dGVtcF9jb3VudCwgcHJvZi0+dGVtcF9jb3Vu
dCArIG4pOworICAgICAgICBxZW11X2F0b21pY19zZXQoJnByb2YtPnRlbXBfY291bnQsIHByb2Yt
PnRlbXBfY291bnQgKyBuKTsKICAgICAgICAgaWYgKG4gPiBwcm9mLT50ZW1wX2NvdW50X21heCkg
ewotICAgICAgICAgICAgYXRvbWljX3NldCgmcHJvZi0+dGVtcF9jb3VudF9tYXgsIG4pOworICAg
ICAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZwcm9mLT50ZW1wX2NvdW50X21heCwgbik7CiAgICAg
ICAgIH0KICAgICB9CiAjZW5kaWYKQEAgLTQxMjUsNyArNDEyNSw3IEBAIGludCB0Y2dfZ2VuX2Nv
ZGUoVENHQ29udGV4dCAqcywgVHJhbnNsYXRpb25CbG9jayAqdGIpCiAjZW5kaWYKIAogI2lmZGVm
IENPTkZJR19QUk9GSUxFUgotICAgIGF0b21pY19zZXQoJnByb2YtPm9wdF90aW1lLCBwcm9mLT5v
cHRfdGltZSAtIHByb2ZpbGVfZ2V0Y2xvY2soKSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZwcm9m
LT5vcHRfdGltZSwgcHJvZi0+b3B0X3RpbWUgLSBwcm9maWxlX2dldGNsb2NrKCkpOwogI2VuZGlm
CiAKICNpZmRlZiBVU0VfVENHX09QVElNSVpBVElPTlMKQEAgLTQxMzMsOCArNDEzMyw4IEBAIGlu
dCB0Y2dfZ2VuX2NvZGUoVENHQ29udGV4dCAqcywgVHJhbnNsYXRpb25CbG9jayAqdGIpCiAjZW5k
aWYKIAogI2lmZGVmIENPTkZJR19QUk9GSUxFUgotICAgIGF0b21pY19zZXQoJnByb2YtPm9wdF90
aW1lLCBwcm9mLT5vcHRfdGltZSArIHByb2ZpbGVfZ2V0Y2xvY2soKSk7Ci0gICAgYXRvbWljX3Nl
dCgmcHJvZi0+bGFfdGltZSwgcHJvZi0+bGFfdGltZSAtIHByb2ZpbGVfZ2V0Y2xvY2soKSk7Cisg
ICAgcWVtdV9hdG9taWNfc2V0KCZwcm9mLT5vcHRfdGltZSwgcHJvZi0+b3B0X3RpbWUgKyBwcm9m
aWxlX2dldGNsb2NrKCkpOworICAgIHFlbXVfYXRvbWljX3NldCgmcHJvZi0+bGFfdGltZSwgcHJv
Zi0+bGFfdGltZSAtIHByb2ZpbGVfZ2V0Y2xvY2soKSk7CiAjZW5kaWYKIAogICAgIHJlYWNoYWJs
ZV9jb2RlX3Bhc3Mocyk7CkBAIC00MTU5LDcgKzQxNTksNyBAQCBpbnQgdGNnX2dlbl9jb2RlKFRD
R0NvbnRleHQgKnMsIFRyYW5zbGF0aW9uQmxvY2sgKnRiKQogICAgIH0KIAogI2lmZGVmIENPTkZJ
R19QUk9GSUxFUgotICAgIGF0b21pY19zZXQoJnByb2YtPmxhX3RpbWUsIHByb2YtPmxhX3RpbWUg
KyBwcm9maWxlX2dldGNsb2NrKCkpOworICAgIHFlbXVfYXRvbWljX3NldCgmcHJvZi0+bGFfdGlt
ZSwgcHJvZi0+bGFfdGltZSArIHByb2ZpbGVfZ2V0Y2xvY2soKSk7CiAjZW5kaWYKIAogI2lmZGVm
IERFQlVHX0RJU0FTCkBAIC00MTkwLDcgKzQxOTAsOCBAQCBpbnQgdGNnX2dlbl9jb2RlKFRDR0Nv
bnRleHQgKnMsIFRyYW5zbGF0aW9uQmxvY2sgKnRiKQogICAgICAgICBUQ0dPcGNvZGUgb3BjID0g
b3AtPm9wYzsKIAogI2lmZGVmIENPTkZJR19QUk9GSUxFUgotICAgICAgICBhdG9taWNfc2V0KCZw
cm9mLT50YWJsZV9vcF9jb3VudFtvcGNdLCBwcm9mLT50YWJsZV9vcF9jb3VudFtvcGNdICsgMSk7
CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmcHJvZi0+dGFibGVfb3BfY291bnRbb3BjXSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgIHByb2YtPnRhYmxlX29wX2NvdW50W29wY10gKyAxKTsKICNl
bmRpZgogCiAgICAgICAgIHN3aXRjaCAob3BjKSB7CmRpZmYgLS1naXQgYS90Y2cvdGNpLmMgYi90
Y2cvdGNpLmMKaW5kZXggNDZmZTljZTYzZi4uZTBmZWQ5MDJiMiAxMDA2NDQKLS0tIGEvdGNnL3Rj
aS5jCisrKyBiL3RjZy90Y2kuYwpAQCAtMTExNSw3ICsxMTE1LDcgQEAgdWludHB0cl90IHRjZ19x
ZW11X3RiX2V4ZWMoQ1BVQXJjaFN0YXRlICplbnYsIHVpbnQ4X3QgKnRiX3B0cikKICAgICAgICAg
Y2FzZSBJTkRFWF9vcF9nb3RvX3RiOgogICAgICAgICAgICAgLyogSnVtcCBhZGRyZXNzIGlzIGFs
aWduZWQgKi8KICAgICAgICAgICAgIHRiX3B0ciA9IFFFTVVfQUxJR05fUFRSX1VQKHRiX3B0ciwg
NCk7Ci0gICAgICAgICAgICB0MCA9IGF0b21pY19yZWFkKChpbnQzMl90ICopdGJfcHRyKTsKKyAg
ICAgICAgICAgIHQwID0gcWVtdV9hdG9taWNfcmVhZCgoaW50MzJfdCAqKXRiX3B0cik7CiAgICAg
ICAgICAgICB0Yl9wdHIgKz0gc2l6ZW9mKGludDMyX3QpOwogICAgICAgICAgICAgdGNpX2Fzc2Vy
dCh0Yl9wdHIgPT0gb2xkX2NvZGVfcHRyICsgb3Bfc2l6ZSk7CiAgICAgICAgICAgICB0Yl9wdHIg
Kz0gKGludDMyX3QpdDA7CmRpZmYgLS1naXQgYS90ZXN0cy9hdG9taWM2NC1iZW5jaC5jIGIvdGVz
dHMvYXRvbWljNjQtYmVuY2guYwppbmRleCAxMjFhOGMxNGY0Li42ZjU2YWUyZWM1IDEwMDY0NAot
LS0gYS90ZXN0cy9hdG9taWM2NC1iZW5jaC5jCisrKyBiL3Rlc3RzL2F0b21pYzY0LWJlbmNoLmMK
QEAgLTU2LDE3ICs1NiwxNyBAQCBzdGF0aWMgdm9pZCAqdGhyZWFkX2Z1bmModm9pZCAqYXJnKQog
ewogICAgIHN0cnVjdCB0aHJlYWRfaW5mbyAqaW5mbyA9IGFyZzsKIAotICAgIGF0b21pY19pbmMo
Jm5fcmVhZHlfdGhyZWFkcyk7Ci0gICAgd2hpbGUgKCFhdG9taWNfcmVhZCgmdGVzdF9zdGFydCkp
IHsKKyAgICBxZW11X2F0b21pY19pbmMoJm5fcmVhZHlfdGhyZWFkcyk7CisgICAgd2hpbGUgKCFx
ZW11X2F0b21pY19yZWFkKCZ0ZXN0X3N0YXJ0KSkgewogICAgICAgICBjcHVfcmVsYXgoKTsKICAg
ICB9CiAKLSAgICB3aGlsZSAoIWF0b21pY19yZWFkKCZ0ZXN0X3N0b3ApKSB7CisgICAgd2hpbGUg
KCFxZW11X2F0b21pY19yZWFkKCZ0ZXN0X3N0b3ApKSB7CiAgICAgICAgIHVuc2lnbmVkIGludCBp
bmRleDsKIAogICAgICAgICBpbmZvLT5yID0geG9yc2hpZnQ2NHN0YXIoaW5mby0+cik7CiAgICAg
ICAgIGluZGV4ID0gaW5mby0+ciAmIChyYW5nZSAtIDEpOwotICAgICAgICBhdG9taWNfcmVhZF9p
NjQoJmNvdW50c1tpbmRleF0uaTY0KTsKKyAgICAgICAgcWVtdV9hdG9taWNfcmVhZF9pNjQoJmNv
dW50c1tpbmRleF0uaTY0KTsKICAgICAgICAgaW5mby0+YWNjZXNzZXMrKzsKICAgICB9CiAgICAg
cmV0dXJuIE5VTEw7CkBAIC03NiwxMyArNzYsMTMgQEAgc3RhdGljIHZvaWQgcnVuX3Rlc3Qodm9p
ZCkKIHsKICAgICB1bnNpZ25lZCBpbnQgaTsKIAotICAgIHdoaWxlIChhdG9taWNfcmVhZCgmbl9y
ZWFkeV90aHJlYWRzKSAhPSBuX3RocmVhZHMpIHsKKyAgICB3aGlsZSAocWVtdV9hdG9taWNfcmVh
ZCgmbl9yZWFkeV90aHJlYWRzKSAhPSBuX3RocmVhZHMpIHsKICAgICAgICAgY3B1X3JlbGF4KCk7
CiAgICAgfQogCi0gICAgYXRvbWljX3NldCgmdGVzdF9zdGFydCwgdHJ1ZSk7CisgICAgcWVtdV9h
dG9taWNfc2V0KCZ0ZXN0X3N0YXJ0LCB0cnVlKTsKICAgICBnX3VzbGVlcChkdXJhdGlvbiAqIEdf
VVNFQ19QRVJfU0VDKTsKLSAgICBhdG9taWNfc2V0KCZ0ZXN0X3N0b3AsIHRydWUpOworICAgIHFl
bXVfYXRvbWljX3NldCgmdGVzdF9zdG9wLCB0cnVlKTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCBu
X3RocmVhZHM7IGkrKykgewogICAgICAgICBxZW11X3RocmVhZF9qb2luKCZ0aHJlYWRzW2ldKTsK
ZGlmZiAtLWdpdCBhL3Rlc3RzL2F0b21pY19hZGQtYmVuY2guYyBiL3Rlc3RzL2F0b21pY19hZGQt
YmVuY2guYwppbmRleCA1NjY2ZjZiYmZmLi44ZDA5NWI4OTg4IDEwMDY0NAotLS0gYS90ZXN0cy9h
dG9taWNfYWRkLWJlbmNoLmMKKysrIGIvdGVzdHMvYXRvbWljX2FkZC1iZW5jaC5jCkBAIC01Mywx
MiArNTMsMTIgQEAgc3RhdGljIHZvaWQgKnRocmVhZF9mdW5jKHZvaWQgKmFyZykKIHsKICAgICBz
dHJ1Y3QgdGhyZWFkX2luZm8gKmluZm8gPSBhcmc7CiAKLSAgICBhdG9taWNfaW5jKCZuX3JlYWR5
X3RocmVhZHMpOwotICAgIHdoaWxlICghYXRvbWljX3JlYWQoJnRlc3Rfc3RhcnQpKSB7CisgICAg
cWVtdV9hdG9taWNfaW5jKCZuX3JlYWR5X3RocmVhZHMpOworICAgIHdoaWxlICghcWVtdV9hdG9t
aWNfcmVhZCgmdGVzdF9zdGFydCkpIHsKICAgICAgICAgY3B1X3JlbGF4KCk7CiAgICAgfQogCi0g
ICAgd2hpbGUgKCFhdG9taWNfcmVhZCgmdGVzdF9zdG9wKSkgeworICAgIHdoaWxlICghcWVtdV9h
dG9taWNfcmVhZCgmdGVzdF9zdG9wKSkgewogICAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXg7CiAK
ICAgICAgICAgaW5mby0+ciA9IHhvcnNoaWZ0NjRzdGFyKGluZm8tPnIpOwpAQCAtNjgsNyArNjgs
NyBAQCBzdGF0aWMgdm9pZCAqdGhyZWFkX2Z1bmModm9pZCAqYXJnKQogICAgICAgICAgICAgY291
bnRzW2luZGV4XS52YWwgKz0gMTsKICAgICAgICAgICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZjb3Vu
dHNbaW5kZXhdLmxvY2spOwogICAgICAgICB9IGVsc2UgewotICAgICAgICAgICAgYXRvbWljX2lu
YygmY291bnRzW2luZGV4XS52YWwpOworICAgICAgICAgICAgcWVtdV9hdG9taWNfaW5jKCZjb3Vu
dHNbaW5kZXhdLnZhbCk7CiAgICAgICAgIH0KICAgICB9CiAgICAgcmV0dXJuIE5VTEw7CkBAIC03
OCwxMyArNzgsMTMgQEAgc3RhdGljIHZvaWQgcnVuX3Rlc3Qodm9pZCkKIHsKICAgICB1bnNpZ25l
ZCBpbnQgaTsKIAotICAgIHdoaWxlIChhdG9taWNfcmVhZCgmbl9yZWFkeV90aHJlYWRzKSAhPSBu
X3RocmVhZHMpIHsKKyAgICB3aGlsZSAocWVtdV9hdG9taWNfcmVhZCgmbl9yZWFkeV90aHJlYWRz
KSAhPSBuX3RocmVhZHMpIHsKICAgICAgICAgY3B1X3JlbGF4KCk7CiAgICAgfQogCi0gICAgYXRv
bWljX3NldCgmdGVzdF9zdGFydCwgdHJ1ZSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZ0ZXN0X3N0
YXJ0LCB0cnVlKTsKICAgICBnX3VzbGVlcChkdXJhdGlvbiAqIEdfVVNFQ19QRVJfU0VDKTsKLSAg
ICBhdG9taWNfc2V0KCZ0ZXN0X3N0b3AsIHRydWUpOworICAgIHFlbXVfYXRvbWljX3NldCgmdGVz
dF9zdG9wLCB0cnVlKTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCBuX3RocmVhZHM7IGkrKykgewog
ICAgICAgICBxZW11X3RocmVhZF9qb2luKCZ0aHJlYWRzW2ldKTsKZGlmZiAtLWdpdCBhL3Rlc3Rz
L2lvdGhyZWFkLmMgYi90ZXN0cy9pb3RocmVhZC5jCmluZGV4IGQzYTJlZTlhMDEuLjZkODZkN2Nh
MjQgMTAwNjQ0Ci0tLSBhL3Rlc3RzL2lvdGhyZWFkLmMKKysrIGIvdGVzdHMvaW90aHJlYWQuYwpA
QCAtNzQsNyArNzQsNyBAQCBzdGF0aWMgdm9pZCAqaW90aHJlYWRfcnVuKHZvaWQgKm9wYXF1ZSkK
ICAgICBxZW11X2NvbmRfc2lnbmFsKCZpb3RocmVhZC0+aW5pdF9kb25lX2NvbmQpOwogICAgIHFl
bXVfbXV0ZXhfdW5sb2NrKCZpb3RocmVhZC0+aW5pdF9kb25lX2xvY2spOwogCi0gICAgd2hpbGUg
KCFhdG9taWNfcmVhZCgmaW90aHJlYWQtPnN0b3BwaW5nKSkgeworICAgIHdoaWxlICghcWVtdV9h
dG9taWNfcmVhZCgmaW90aHJlYWQtPnN0b3BwaW5nKSkgewogICAgICAgICBhaW9fcG9sbChpb3Ro
cmVhZC0+Y3R4LCB0cnVlKTsKICAgICB9CiAKZGlmZiAtLWdpdCBhL3Rlc3RzL3FodC1iZW5jaC5j
IGIvdGVzdHMvcWh0LWJlbmNoLmMKaW5kZXggMzYyZjAzY2IwMy4uY2YyOTkwYjM1MyAxMDA2NDQK
LS0tIGEvdGVzdHMvcWh0LWJlbmNoLmMKKysrIGIvdGVzdHMvcWh0LWJlbmNoLmMKQEAgLTIwOSwx
MyArMjA5LDEzIEBAIHN0YXRpYyB2b2lkICp0aHJlYWRfZnVuYyh2b2lkICpwKQogCiAgICAgcmN1
X3JlZ2lzdGVyX3RocmVhZCgpOwogCi0gICAgYXRvbWljX2luYygmbl9yZWFkeV90aHJlYWRzKTsK
LSAgICB3aGlsZSAoIWF0b21pY19yZWFkKCZ0ZXN0X3N0YXJ0KSkgeworICAgIHFlbXVfYXRvbWlj
X2luYygmbl9yZWFkeV90aHJlYWRzKTsKKyAgICB3aGlsZSAoIXFlbXVfYXRvbWljX3JlYWQoJnRl
c3Rfc3RhcnQpKSB7CiAgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0KIAogICAgIHJjdV9yZWFk
X2xvY2soKTsKLSAgICB3aGlsZSAoIWF0b21pY19yZWFkKCZ0ZXN0X3N0b3ApKSB7CisgICAgd2hp
bGUgKCFxZW11X2F0b21pY19yZWFkKCZ0ZXN0X3N0b3ApKSB7CiAgICAgICAgIGluZm8tPnNlZWQg
PSB4b3JzaGlmdDY0c3RhcihpbmZvLT5zZWVkKTsKICAgICAgICAgaW5mby0+ZnVuYyhpbmZvKTsK
ICAgICB9CkBAIC00MjMsMTMgKzQyMywxMyBAQCBzdGF0aWMgdm9pZCBydW5fdGVzdCh2b2lkKQog
ewogICAgIGludCBpOwogCi0gICAgd2hpbGUgKGF0b21pY19yZWFkKCZuX3JlYWR5X3RocmVhZHMp
ICE9IG5fcndfdGhyZWFkcyArIG5fcnpfdGhyZWFkcykgeworICAgIHdoaWxlIChxZW11X2F0b21p
Y19yZWFkKCZuX3JlYWR5X3RocmVhZHMpICE9IG5fcndfdGhyZWFkcyArIG5fcnpfdGhyZWFkcykg
ewogICAgICAgICBjcHVfcmVsYXgoKTsKICAgICB9CiAKLSAgICBhdG9taWNfc2V0KCZ0ZXN0X3N0
YXJ0LCB0cnVlKTsKKyAgICBxZW11X2F0b21pY19zZXQoJnRlc3Rfc3RhcnQsIHRydWUpOwogICAg
IGdfdXNsZWVwKGR1cmF0aW9uICogR19VU0VDX1BFUl9TRUMpOwotICAgIGF0b21pY19zZXQoJnRl
c3Rfc3RvcCwgdHJ1ZSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZ0ZXN0X3N0b3AsIHRydWUpOwog
CiAgICAgZm9yIChpID0gMDsgaSA8IG5fcndfdGhyZWFkczsgaSsrKSB7CiAgICAgICAgIHFlbXVf
dGhyZWFkX2pvaW4oJnJ3X3RocmVhZHNbaV0pOwpkaWZmIC0tZ2l0IGEvdGVzdHMvcmN1dG9ydHVy
ZS5jIGIvdGVzdHMvcmN1dG9ydHVyZS5jCmluZGV4IDczMmYwM2FiZGEuLjc4MTQ4MTQwZDcgMTAw
NjQ0Ci0tLSBhL3Rlc3RzL3JjdXRvcnR1cmUuYworKysgYi90ZXN0cy9yY3V0b3J0dXJlLmMKQEAg
LTEyMyw3ICsxMjMsNyBAQCBzdGF0aWMgdm9pZCAqcmN1X3JlYWRfcGVyZl90ZXN0KHZvaWQgKmFy
ZykKICAgICByY3VfcmVnaXN0ZXJfdGhyZWFkKCk7CiAKICAgICAqKHN0cnVjdCByY3VfcmVhZGVy
X2RhdGEgKiopYXJnID0gJnJjdV9yZWFkZXI7Ci0gICAgYXRvbWljX2luYygmbnRocmVhZHNydW5u
aW5nKTsKKyAgICBxZW11X2F0b21pY19pbmMoJm50aHJlYWRzcnVubmluZyk7CiAgICAgd2hpbGUg
KGdvZmxhZyA9PSBHT0ZMQUdfSU5JVCkgewogICAgICAgICBnX3VzbGVlcCgxMDAwKTsKICAgICB9
CkBAIC0xNDksNyArMTQ5LDcgQEAgc3RhdGljIHZvaWQgKnJjdV91cGRhdGVfcGVyZl90ZXN0KHZv
aWQgKmFyZykKICAgICByY3VfcmVnaXN0ZXJfdGhyZWFkKCk7CiAKICAgICAqKHN0cnVjdCByY3Vf
cmVhZGVyX2RhdGEgKiopYXJnID0gJnJjdV9yZWFkZXI7Ci0gICAgYXRvbWljX2luYygmbnRocmVh
ZHNydW5uaW5nKTsKKyAgICBxZW11X2F0b21pY19pbmMoJm50aHJlYWRzcnVubmluZyk7CiAgICAg
d2hpbGUgKGdvZmxhZyA9PSBHT0ZMQUdfSU5JVCkgewogICAgICAgICBnX3VzbGVlcCgxMDAwKTsK
ICAgICB9CkBAIC0xNzIsNyArMTcyLDcgQEAgc3RhdGljIHZvaWQgcGVyZnRlc3Rpbml0KHZvaWQp
CiAKIHN0YXRpYyB2b2lkIHBlcmZ0ZXN0cnVuKGludCBudGhyZWFkcywgaW50IGR1cmF0aW9uLCBp
bnQgbnJlYWRlcnMsIGludCBudXBkYXRlcnMpCiB7Ci0gICAgd2hpbGUgKGF0b21pY19yZWFkKCZu
dGhyZWFkc3J1bm5pbmcpIDwgbnRocmVhZHMpIHsKKyAgICB3aGlsZSAocWVtdV9hdG9taWNfcmVh
ZCgmbnRocmVhZHNydW5uaW5nKSA8IG50aHJlYWRzKSB7CiAgICAgICAgIGdfdXNsZWVwKDEwMDAp
OwogICAgIH0KICAgICBnb2ZsYWcgPSBHT0ZMQUdfUlVOOwpAQCAtMjU5LDggKzI1OSw4IEBAIHN0
YXRpYyB2b2lkICpyY3VfcmVhZF9zdHJlc3NfdGVzdCh2b2lkICphcmcpCiAgICAgfQogICAgIHdo
aWxlIChnb2ZsYWcgPT0gR09GTEFHX1JVTikgewogICAgICAgICByY3VfcmVhZF9sb2NrKCk7Ci0g
ICAgICAgIHAgPSBhdG9taWNfcmN1X3JlYWQoJnJjdV9zdHJlc3NfY3VycmVudCk7Ci0gICAgICAg
IGlmIChhdG9taWNfcmVhZCgmcC0+bWJ0ZXN0KSA9PSAwKSB7CisgICAgICAgIHAgPSBxZW11X2F0
b21pY19yY3VfcmVhZCgmcmN1X3N0cmVzc19jdXJyZW50KTsKKyAgICAgICAgaWYgKHFlbXVfYXRv
bWljX3JlYWQoJnAtPm1idGVzdCkgPT0gMCkgewogICAgICAgICAgICAgbl9tYmVycm9yKys7CiAg
ICAgICAgIH0KICAgICAgICAgcmN1X3JlYWRfbG9jaygpOwpAQCAtMjY4LDcgKzI2OCw3IEBAIHN0
YXRpYyB2b2lkICpyY3VfcmVhZF9zdHJlc3NfdGVzdCh2b2lkICphcmcpCiAgICAgICAgICAgICBn
YXJiYWdlKys7CiAgICAgICAgIH0KICAgICAgICAgcmN1X3JlYWRfdW5sb2NrKCk7Ci0gICAgICAg
IHBjID0gYXRvbWljX3JlYWQoJnAtPmFnZSk7CisgICAgICAgIHBjID0gcWVtdV9hdG9taWNfcmVh
ZCgmcC0+YWdlKTsKICAgICAgICAgcmN1X3JlYWRfdW5sb2NrKCk7CiAgICAgICAgIGlmICgocGMg
PiBSQ1VfU1RSRVNTX1BJUEVfTEVOKSB8fCAocGMgPCAwKSkgewogICAgICAgICAgICAgcGMgPSBS
Q1VfU1RSRVNTX1BJUEVfTEVOOwpAQCAtMzAxLDcgKzMwMSw3IEBAIHN0YXRpYyB2b2lkICpyY3Vf
cmVhZF9zdHJlc3NfdGVzdCh2b2lkICphcmcpCiBzdGF0aWMgdm9pZCAqcmN1X3VwZGF0ZV9zdHJl
c3NfdGVzdCh2b2lkICphcmcpCiB7CiAgICAgaW50IGksIHJjdV9zdHJlc3NfaWR4ID0gMDsKLSAg
ICBzdHJ1Y3QgcmN1X3N0cmVzcyAqY3AgPSBhdG9taWNfcmVhZCgmcmN1X3N0cmVzc19jdXJyZW50
KTsKKyAgICBzdHJ1Y3QgcmN1X3N0cmVzcyAqY3AgPSBxZW11X2F0b21pY19yZWFkKCZyY3Vfc3Ry
ZXNzX2N1cnJlbnQpOwogCiAgICAgcmN1X3JlZ2lzdGVyX3RocmVhZCgpOwogICAgICooc3RydWN0
IHJjdV9yZWFkZXJfZGF0YSAqKilhcmcgPSAmcmN1X3JlYWRlcjsKQEAgLTMxOSwxMSArMzE5LDEx
IEBAIHN0YXRpYyB2b2lkICpyY3VfdXBkYXRlX3N0cmVzc190ZXN0KHZvaWQgKmFyZykKICAgICAg
ICAgcCA9ICZyY3Vfc3RyZXNzX2FycmF5W3JjdV9zdHJlc3NfaWR4XTsKICAgICAgICAgLyogY2F0
Y2hpbmcgdXAgd2l0aCBvdXJzZWx2ZXMgd291bGQgYmUgYSBidWcgKi8KICAgICAgICAgYXNzZXJ0
KHAgIT0gY3ApOwotICAgICAgICBhdG9taWNfc2V0KCZwLT5tYnRlc3QsIDApOworICAgICAgICBx
ZW11X2F0b21pY19zZXQoJnAtPm1idGVzdCwgMCk7CiAgICAgICAgIHNtcF9tYigpOwotICAgICAg
ICBhdG9taWNfc2V0KCZwLT5hZ2UsIDApOwotICAgICAgICBhdG9taWNfc2V0KCZwLT5tYnRlc3Qs
IDEpOwotICAgICAgICBhdG9taWNfcmN1X3NldCgmcmN1X3N0cmVzc19jdXJyZW50LCBwKTsKKyAg
ICAgICAgcWVtdV9hdG9taWNfc2V0KCZwLT5hZ2UsIDApOworICAgICAgICBxZW11X2F0b21pY19z
ZXQoJnAtPm1idGVzdCwgMSk7CisgICAgICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoJnJjdV9zdHJl
c3NfY3VycmVudCwgcCk7CiAgICAgICAgIGNwID0gcDsKICAgICAgICAgLyoKICAgICAgICAgICog
TmV3IFJDVSBzdHJ1Y3R1cmUgaXMgbm93IGxpdmUsIHVwZGF0ZSBwaXBlIGNvdW50cyBvbiBvbGQK
QEAgLTMzMSw3ICszMzEsNyBAQCBzdGF0aWMgdm9pZCAqcmN1X3VwZGF0ZV9zdHJlc3NfdGVzdCh2
b2lkICphcmcpCiAgICAgICAgICAqLwogICAgICAgICBmb3IgKGkgPSAwOyBpIDwgUkNVX1NUUkVT
U19QSVBFX0xFTjsgaSsrKSB7CiAgICAgICAgICAgICBpZiAoaSAhPSByY3Vfc3RyZXNzX2lkeCkg
ewotICAgICAgICAgICAgICAgIGF0b21pY19zZXQoJnJjdV9zdHJlc3NfYXJyYXlbaV0uYWdlLAor
ICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX3NldCgmcmN1X3N0cmVzc19hcnJheVtpXS5hZ2Us
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByY3Vfc3RyZXNzX2FycmF5W2ldLmFnZSArIDEp
OwogICAgICAgICAgICAgfQogICAgICAgICB9CmRpZmYgLS1naXQgYS90ZXN0cy90ZXN0LWFpby1t
dWx0aXRocmVhZC5jIGIvdGVzdHMvdGVzdC1haW8tbXVsdGl0aHJlYWQuYwppbmRleCBkMzE0NGJl
N2UwLi5kODY0Y2EwN2NkIDEwMDY0NAotLS0gYS90ZXN0cy90ZXN0LWFpby1tdWx0aXRocmVhZC5j
CisrKyBiL3Rlc3RzL3Rlc3QtYWlvLW11bHRpdGhyZWFkLmMKQEAgLTExOCwxNiArMTE4LDE2IEBA
IHN0YXRpYyBib29sIHNjaGVkdWxlX25leHQoaW50IG4pCiB7CiAgICAgQ29yb3V0aW5lICpjbzsK
IAotICAgIGNvID0gYXRvbWljX3hjaGcoJnRvX3NjaGVkdWxlW25dLCBOVUxMKTsKKyAgICBjbyA9
IHFlbXVfYXRvbWljX3hjaGcoJnRvX3NjaGVkdWxlW25dLCBOVUxMKTsKICAgICBpZiAoIWNvKSB7
Ci0gICAgICAgIGF0b21pY19pbmMoJmNvdW50X3JldHJ5KTsKKyAgICAgICAgcWVtdV9hdG9taWNf
aW5jKCZjb3VudF9yZXRyeSk7CiAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICB9CiAKICAgICBp
ZiAobiA9PSBpZCkgewotICAgICAgICBhdG9taWNfaW5jKCZjb3VudF9oZXJlKTsKKyAgICAgICAg
cWVtdV9hdG9taWNfaW5jKCZjb3VudF9oZXJlKTsKICAgICB9IGVsc2UgewotICAgICAgICBhdG9t
aWNfaW5jKCZjb3VudF9vdGhlcik7CisgICAgICAgIHFlbXVfYXRvbWljX2luYygmY291bnRfb3Ro
ZXIpOwogICAgIH0KIAogICAgIGFpb19jb19zY2hlZHVsZShjdHhbbl0sIGNvKTsKQEAgLTE0Mywx
MyArMTQzLDEzIEBAIHN0YXRpYyBjb3JvdXRpbmVfZm4gdm9pZCB0ZXN0X211bHRpX2NvX3NjaGVk
dWxlX2VudHJ5KHZvaWQgKm9wYXF1ZSkKIHsKICAgICBnX2Fzc2VydCh0b19zY2hlZHVsZVtpZF0g
PT0gTlVMTCk7CiAKLSAgICB3aGlsZSAoIWF0b21pY19tYl9yZWFkKCZub3dfc3RvcHBpbmcpKSB7
CisgICAgd2hpbGUgKCFxZW11X2F0b21pY19tYl9yZWFkKCZub3dfc3RvcHBpbmcpKSB7CiAgICAg
ICAgIGludCBuOwogCiAgICAgICAgIG4gPSBnX3Rlc3RfcmFuZF9pbnRfcmFuZ2UoMCwgTlVNX0NP
TlRFWFRTKTsKICAgICAgICAgc2NoZWR1bGVfbmV4dChuKTsKIAotICAgICAgICBhdG9taWNfbWJf
c2V0KCZ0b19zY2hlZHVsZVtpZF0sIHFlbXVfY29yb3V0aW5lX3NlbGYoKSk7CisgICAgICAgIHFl
bXVfYXRvbWljX21iX3NldCgmdG9fc2NoZWR1bGVbaWRdLCBxZW11X2Nvcm91dGluZV9zZWxmKCkp
OwogICAgICAgICBxZW11X2Nvcm91dGluZV95aWVsZCgpOwogICAgICAgICBnX2Fzc2VydCh0b19z
Y2hlZHVsZVtpZF0gPT0gTlVMTCk7CiAgICAgfQpAQCAtMTcxLDcgKzE3MSw3IEBAIHN0YXRpYyB2
b2lkIHRlc3RfbXVsdGlfY29fc2NoZWR1bGUoaW50IHNlY29uZHMpCiAKICAgICBnX3VzbGVlcChz
ZWNvbmRzICogMTAwMDAwMCk7CiAKLSAgICBhdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRy
dWUpOworICAgIHFlbXVfYXRvbWljX21iX3NldCgmbm93X3N0b3BwaW5nLCB0cnVlKTsKICAgICBm
b3IgKGkgPSAwOyBpIDwgTlVNX0NPTlRFWFRTOyBpKyspIHsKICAgICAgICAgY3R4X3J1bihpLCBm
aW5pc2hfY2IsIE5VTEwpOwogICAgICAgICB0b19zY2hlZHVsZVtpXSA9IE5VTEw7CkBAIC0yMDIs
NyArMjAyLDcgQEAgc3RhdGljIENvTXV0ZXggY29tdXRleDsKIAogc3RhdGljIHZvaWQgY29yb3V0
aW5lX2ZuIHRlc3RfbXVsdGlfY29fbXV0ZXhfZW50cnkodm9pZCAqb3BhcXVlKQogewotICAgIHdo
aWxlICghYXRvbWljX21iX3JlYWQoJm5vd19zdG9wcGluZykpIHsKKyAgICB3aGlsZSAoIXFlbXVf
YXRvbWljX21iX3JlYWQoJm5vd19zdG9wcGluZykpIHsKICAgICAgICAgcWVtdV9jb19tdXRleF9s
b2NrKCZjb211dGV4KTsKICAgICAgICAgY291bnRlcisrOwogICAgICAgICBxZW11X2NvX211dGV4
X3VubG9jaygmY29tdXRleCk7CkBAIC0yMTIsOSArMjEyLDkgQEAgc3RhdGljIHZvaWQgY29yb3V0
aW5lX2ZuIHRlc3RfbXVsdGlfY29fbXV0ZXhfZW50cnkodm9pZCAqb3BhcXVlKQogICAgICAgICAg
KiBleGl0cyBiZWZvcmUgdGhlIGNvcm91dGluZSBpcyB3b2tlbiB1cCwgY2F1c2luZyBhIHNwdXJp
b3VzCiAgICAgICAgICAqIGFzc2VydGlvbiBmYWlsdXJlLgogICAgICAgICAgKi8KLSAgICAgICAg
YXRvbWljX2luYygmYXRvbWljX2NvdW50ZXIpOworICAgICAgICBxZW11X2F0b21pY19pbmMoJmF0
b21pY19jb3VudGVyKTsKICAgICB9Ci0gICAgYXRvbWljX2RlYygmcnVubmluZyk7CisgICAgcWVt
dV9hdG9taWNfZGVjKCZydW5uaW5nKTsKIH0KIAogc3RhdGljIHZvaWQgdGVzdF9tdWx0aV9jb19t
dXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCkBAIC0yMzYsNyArMjM2LDcgQEAgc3RhdGlj
IHZvaWQgdGVzdF9tdWx0aV9jb19tdXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCiAKICAg
ICBnX3VzbGVlcChzZWNvbmRzICogMTAwMDAwMCk7CiAKLSAgICBhdG9taWNfbWJfc2V0KCZub3df
c3RvcHBpbmcsIHRydWUpOworICAgIHFlbXVfYXRvbWljX21iX3NldCgmbm93X3N0b3BwaW5nLCB0
cnVlKTsKICAgICB3aGlsZSAocnVubmluZyA+IDApIHsKICAgICAgICAgZ191c2xlZXAoMTAwMDAw
KTsKICAgICB9CkBAIC0yOTYsOSArMjk2LDkgQEAgc3RhdGljIHZvaWQgbWNzX211dGV4X2xvY2so
dm9pZCkKIAogICAgIG5vZGVzW2lkXS5uZXh0ID0gLTE7CiAgICAgbm9kZXNbaWRdLmxvY2tlZCA9
IDE7Ci0gICAgcHJldiA9IGF0b21pY194Y2hnKCZtdXRleF9oZWFkLCBpZCk7CisgICAgcHJldiA9
IHFlbXVfYXRvbWljX3hjaGcoJm11dGV4X2hlYWQsIGlkKTsKICAgICBpZiAocHJldiAhPSAtMSkg
ewotICAgICAgICBhdG9taWNfc2V0KCZub2Rlc1twcmV2XS5uZXh0LCBpZCk7CisgICAgICAgIHFl
bXVfYXRvbWljX3NldCgmbm9kZXNbcHJldl0ubmV4dCwgaWQpOwogICAgICAgICBxZW11X2Z1dGV4
X3dhaXQoJm5vZGVzW2lkXS5sb2NrZWQsIDEpOwogICAgIH0KIH0KQEAgLTMwNiwxMyArMzA2LDEz
IEBAIHN0YXRpYyB2b2lkIG1jc19tdXRleF9sb2NrKHZvaWQpCiBzdGF0aWMgdm9pZCBtY3NfbXV0
ZXhfdW5sb2NrKHZvaWQpCiB7CiAgICAgaW50IG5leHQ7Ci0gICAgaWYgKGF0b21pY19yZWFkKCZu
b2Rlc1tpZF0ubmV4dCkgPT0gLTEpIHsKLSAgICAgICAgaWYgKGF0b21pY19yZWFkKCZtdXRleF9o
ZWFkKSA9PSBpZCAmJgotICAgICAgICAgICAgYXRvbWljX2NtcHhjaGcoJm11dGV4X2hlYWQsIGlk
LCAtMSkgPT0gaWQpIHsKKyAgICBpZiAocWVtdV9hdG9taWNfcmVhZCgmbm9kZXNbaWRdLm5leHQp
ID09IC0xKSB7CisgICAgICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZtdXRleF9oZWFkKSA9PSBp
ZCAmJgorICAgICAgICAgICAgcWVtdV9hdG9taWNfY21weGNoZygmbXV0ZXhfaGVhZCwgaWQsIC0x
KSA9PSBpZCkgewogICAgICAgICAgICAgLyogTGFzdCBpdGVtIGluIHRoZSBsaXN0LCBleGl0LiAg
Ki8KICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgfQotICAgICAgICB3aGlsZSAoYXRvbWlj
X3JlYWQoJm5vZGVzW2lkXS5uZXh0KSA9PSAtMSkgeworICAgICAgICB3aGlsZSAocWVtdV9hdG9t
aWNfcmVhZCgmbm9kZXNbaWRdLm5leHQpID09IC0xKSB7CiAgICAgICAgICAgICAvKiBtY3NfbXV0
ZXhfbG9jayBkaWQgdGhlIHhjaGcsIGJ1dCBoYXMgbm90IHVwZGF0ZWQKICAgICAgICAgICAgICAq
IG5vZGVzW3ByZXZdLm5leHQgeWV0LgogICAgICAgICAgICAgICovCkBAIC0zMjAsMjAgKzMyMCwy
MCBAQCBzdGF0aWMgdm9pZCBtY3NfbXV0ZXhfdW5sb2NrKHZvaWQpCiAgICAgfQogCiAgICAgLyog
V2FrZSB1cCB0aGUgbmV4dCBpbiBsaW5lLiAgKi8KLSAgICBuZXh0ID0gYXRvbWljX3JlYWQoJm5v
ZGVzW2lkXS5uZXh0KTsKKyAgICBuZXh0ID0gcWVtdV9hdG9taWNfcmVhZCgmbm9kZXNbaWRdLm5l
eHQpOwogICAgIG5vZGVzW25leHRdLmxvY2tlZCA9IDA7CiAgICAgcWVtdV9mdXRleF93YWtlKCZu
b2Rlc1tuZXh0XS5sb2NrZWQsIDEpOwogfQogCiBzdGF0aWMgdm9pZCB0ZXN0X211bHRpX2ZhaXJf
bXV0ZXhfZW50cnkodm9pZCAqb3BhcXVlKQogewotICAgIHdoaWxlICghYXRvbWljX21iX3JlYWQo
Jm5vd19zdG9wcGluZykpIHsKKyAgICB3aGlsZSAoIXFlbXVfYXRvbWljX21iX3JlYWQoJm5vd19z
dG9wcGluZykpIHsKICAgICAgICAgbWNzX211dGV4X2xvY2soKTsKICAgICAgICAgY291bnRlcisr
OwogICAgICAgICBtY3NfbXV0ZXhfdW5sb2NrKCk7Ci0gICAgICAgIGF0b21pY19pbmMoJmF0b21p
Y19jb3VudGVyKTsKKyAgICAgICAgcWVtdV9hdG9taWNfaW5jKCZhdG9taWNfY291bnRlcik7CiAg
ICAgfQotICAgIGF0b21pY19kZWMoJnJ1bm5pbmcpOworICAgIHFlbXVfYXRvbWljX2RlYygmcnVu
bmluZyk7CiB9CiAKIHN0YXRpYyB2b2lkIHRlc3RfbXVsdGlfZmFpcl9tdXRleChpbnQgdGhyZWFk
cywgaW50IHNlY29uZHMpCkBAIC0zNTUsNyArMzU1LDcgQEAgc3RhdGljIHZvaWQgdGVzdF9tdWx0
aV9mYWlyX211dGV4KGludCB0aHJlYWRzLCBpbnQgc2Vjb25kcykKIAogICAgIGdfdXNsZWVwKHNl
Y29uZHMgKiAxMDAwMDAwKTsKIAotICAgIGF0b21pY19tYl9zZXQoJm5vd19zdG9wcGluZywgdHJ1
ZSk7CisgICAgcWVtdV9hdG9taWNfbWJfc2V0KCZub3dfc3RvcHBpbmcsIHRydWUpOwogICAgIHdo
aWxlIChydW5uaW5nID4gMCkgewogICAgICAgICBnX3VzbGVlcCgxMDAwMDApOwogICAgIH0KQEAg
LTM4MywxMyArMzgzLDEzIEBAIHN0YXRpYyBRZW11TXV0ZXggbXV0ZXg7CiAKIHN0YXRpYyB2b2lk
IHRlc3RfbXVsdGlfbXV0ZXhfZW50cnkodm9pZCAqb3BhcXVlKQogewotICAgIHdoaWxlICghYXRv
bWljX21iX3JlYWQoJm5vd19zdG9wcGluZykpIHsKKyAgICB3aGlsZSAoIXFlbXVfYXRvbWljX21i
X3JlYWQoJm5vd19zdG9wcGluZykpIHsKICAgICAgICAgcWVtdV9tdXRleF9sb2NrKCZtdXRleCk7
CiAgICAgICAgIGNvdW50ZXIrKzsKICAgICAgICAgcWVtdV9tdXRleF91bmxvY2soJm11dGV4KTsK
LSAgICAgICAgYXRvbWljX2luYygmYXRvbWljX2NvdW50ZXIpOworICAgICAgICBxZW11X2F0b21p
Y19pbmMoJmF0b21pY19jb3VudGVyKTsKICAgICB9Ci0gICAgYXRvbWljX2RlYygmcnVubmluZyk7
CisgICAgcWVtdV9hdG9taWNfZGVjKCZydW5uaW5nKTsKIH0KIAogc3RhdGljIHZvaWQgdGVzdF9t
dWx0aV9tdXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCkBAIC00MTEsNyArNDExLDcgQEAg
c3RhdGljIHZvaWQgdGVzdF9tdWx0aV9tdXRleChpbnQgdGhyZWFkcywgaW50IHNlY29uZHMpCiAK
ICAgICBnX3VzbGVlcChzZWNvbmRzICogMTAwMDAwMCk7CiAKLSAgICBhdG9taWNfbWJfc2V0KCZu
b3dfc3RvcHBpbmcsIHRydWUpOworICAgIHFlbXVfYXRvbWljX21iX3NldCgmbm93X3N0b3BwaW5n
LCB0cnVlKTsKICAgICB3aGlsZSAocnVubmluZyA+IDApIHsKICAgICAgICAgZ191c2xlZXAoMTAw
MDAwKTsKICAgICB9CmRpZmYgLS1naXQgYS90ZXN0cy90ZXN0LWxvZ2dpbmcuYyBiL3Rlc3RzL3Rl
c3QtbG9nZ2luZy5jCmluZGV4IDhiMTUyMmNmZWQuLjMyZDRhMjcwYWMgMTAwNjQ0Ci0tLSBhL3Rl
c3RzL3Rlc3QtbG9nZ2luZy5jCisrKyBiL3Rlc3RzL3Rlc3QtbG9nZ2luZy5jCkBAIC0xMzMsNyAr
MTMzLDcgQEAgc3RhdGljIHZvaWQgdGVzdF9sb2dmaWxlX3dyaXRlKGdjb25zdHBvaW50ZXIgZGF0
YSkKICAgICAgKi8KICAgICBxZW11X3NldF9sb2dfZmlsZW5hbWUoZmlsZV9wYXRoLCAmZXJyb3Jf
YWJvcnQpOwogICAgIHJjdV9yZWFkX2xvY2soKTsKLSAgICBsb2dmaWxlID0gYXRvbWljX3JjdV9y
ZWFkKCZxZW11X2xvZ2ZpbGUpOworICAgIGxvZ2ZpbGUgPSBxZW11X2F0b21pY19yY3VfcmVhZCgm
cWVtdV9sb2dmaWxlKTsKICAgICBvcmlnX2ZkID0gbG9nZmlsZS0+ZmQ7CiAgICAgZ19hc3NlcnQo
bG9nZmlsZSAmJiBsb2dmaWxlLT5mZCk7CiAgICAgZnByaW50Zihsb2dmaWxlLT5mZCwgIiVzIDFz
dCB3cml0ZSB0byBmaWxlXG4iLCBfX2Z1bmNfXyk7CkBAIC0xNDEsNyArMTQxLDcgQEAgc3RhdGlj
IHZvaWQgdGVzdF9sb2dmaWxlX3dyaXRlKGdjb25zdHBvaW50ZXIgZGF0YSkKIAogICAgIC8qIENo
YW5nZSB0aGUgbG9nZmlsZSBhbmQgZW5zdXJlIHRoYXQgdGhlIGhhbmRsZSBpcyBzdGlsbCB2YWxp
ZC4gKi8KICAgICBxZW11X3NldF9sb2dfZmlsZW5hbWUoZmlsZV9wYXRoMSwgJmVycm9yX2Fib3J0
KTsKLSAgICBsb2dmaWxlMiA9IGF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsKKyAgICBs
b2dmaWxlMiA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZxZW11X2xvZ2ZpbGUpOwogICAgIGdfYXNz
ZXJ0KGxvZ2ZpbGUtPmZkID09IG9yaWdfZmQpOwogICAgIGdfYXNzZXJ0KGxvZ2ZpbGUyLT5mZCAh
PSBsb2dmaWxlLT5mZCk7CiAgICAgZnByaW50Zihsb2dmaWxlLT5mZCwgIiVzIDJuZCB3cml0ZSB0
byBmaWxlXG4iLCBfX2Z1bmNfXyk7CmRpZmYgLS1naXQgYS90ZXN0cy90ZXN0LXJjdS1saXN0LmMg
Yi90ZXN0cy90ZXN0LXJjdS1saXN0LmMKaW5kZXggOTJiZTUxZWM1MC4uZDAxNGUzZjIxYiAxMDA2
NDQKLS0tIGEvdGVzdHMvdGVzdC1yY3UtbGlzdC5jCisrKyBiL3Rlc3RzL3Rlc3QtcmN1LWxpc3Qu
YwpAQCAtMTA2LDcgKzEwNiw3IEBAIHN0YXRpYyB2b2lkIHJlY2xhaW1fbGlzdF9lbChzdHJ1Y3Qg
cmN1X2hlYWQgKnByY3UpCiAgICAgc3RydWN0IGxpc3RfZWxlbWVudCAqZWwgPSBjb250YWluZXJf
b2YocHJjdSwgc3RydWN0IGxpc3RfZWxlbWVudCwgcmN1KTsKICAgICBnX2ZyZWUoZWwpOwogICAg
IC8qIEFjY2Vzc2VkIG9ubHkgZnJvbSBjYWxsX3JjdSB0aHJlYWQuICAqLwotICAgIGF0b21pY19z
ZXRfaTY0KCZuX3JlY2xhaW1zLCBuX3JlY2xhaW1zICsgMSk7CisgICAgcWVtdV9hdG9taWNfc2V0
X2k2NCgmbl9yZWNsYWltcywgbl9yZWNsYWltcyArIDEpOwogfQogCiAjaWYgVEVTVF9MSVNUX1RZ
UEUgPT0gMQpAQCAtMTcyLDE2ICsxNzIsMTYgQEAgc3RhdGljIHZvaWQgKnJjdV9xX3JlYWRlcih2
b2lkICphcmcpCiAgICAgcmN1X3JlZ2lzdGVyX3RocmVhZCgpOwogCiAgICAgKihzdHJ1Y3QgcmN1
X3JlYWRlcl9kYXRhICoqKWFyZyA9ICZyY3VfcmVhZGVyOwotICAgIGF0b21pY19pbmMoJm50aHJl
YWRzcnVubmluZyk7Ci0gICAgd2hpbGUgKGF0b21pY19yZWFkKCZnb2ZsYWcpID09IEdPRkxBR19J
TklUKSB7CisgICAgcWVtdV9hdG9taWNfaW5jKCZudGhyZWFkc3J1bm5pbmcpOworICAgIHdoaWxl
IChxZW11X2F0b21pY19yZWFkKCZnb2ZsYWcpID09IEdPRkxBR19JTklUKSB7CiAgICAgICAgIGdf
dXNsZWVwKDEwMDApOwogICAgIH0KIAotICAgIHdoaWxlIChhdG9taWNfcmVhZCgmZ29mbGFnKSA9
PSBHT0ZMQUdfUlVOKSB7CisgICAgd2hpbGUgKHFlbXVfYXRvbWljX3JlYWQoJmdvZmxhZykgPT0g
R09GTEFHX1JVTikgewogICAgICAgICByY3VfcmVhZF9sb2NrKCk7CiAgICAgICAgIFRFU1RfTElT
VF9GT1JFQUNIX1JDVShlbCwgJlFfbGlzdF9oZWFkLCBlbnRyeSkgewogICAgICAgICAgICAgbl9y
ZWFkc19sb2NhbCsrOwotICAgICAgICAgICAgaWYgKGF0b21pY19yZWFkKCZnb2ZsYWcpID09IEdP
RkxBR19TVE9QKSB7CisgICAgICAgICAgICBpZiAocWVtdV9hdG9taWNfcmVhZCgmZ29mbGFnKSA9
PSBHT0ZMQUdfU1RPUCkgewogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgfQog
ICAgICAgICB9CkBAIC0yMDcsMTIgKzIwNywxMiBAQCBzdGF0aWMgdm9pZCAqcmN1X3FfdXBkYXRl
cih2b2lkICphcmcpCiAgICAgc3RydWN0IGxpc3RfZWxlbWVudCAqZWwsICpwcmV2X2VsOwogCiAg
ICAgKihzdHJ1Y3QgcmN1X3JlYWRlcl9kYXRhICoqKWFyZyA9ICZyY3VfcmVhZGVyOwotICAgIGF0
b21pY19pbmMoJm50aHJlYWRzcnVubmluZyk7Ci0gICAgd2hpbGUgKGF0b21pY19yZWFkKCZnb2Zs
YWcpID09IEdPRkxBR19JTklUKSB7CisgICAgcWVtdV9hdG9taWNfaW5jKCZudGhyZWFkc3J1bm5p
bmcpOworICAgIHdoaWxlIChxZW11X2F0b21pY19yZWFkKCZnb2ZsYWcpID09IEdPRkxBR19JTklU
KSB7CiAgICAgICAgIGdfdXNsZWVwKDEwMDApOwogICAgIH0KIAotICAgIHdoaWxlIChhdG9taWNf
cmVhZCgmZ29mbGFnKSA9PSBHT0ZMQUdfUlVOKSB7CisgICAgd2hpbGUgKHFlbXVfYXRvbWljX3Jl
YWQoJmdvZmxhZykgPT0gR09GTEFHX1JVTikgewogICAgICAgICB0YXJnZXRfZWwgPSBzZWxlY3Rf
cmFuZG9tX2VsKFJDVV9RX0xFTik7CiAgICAgICAgIGogPSAwOwogICAgICAgICAvKiBGT1JFQUNI
X1JDVSBjb3VsZCB3b3JrIGhlcmUgYnV0IGxldCdzIHVzZSBib3RoIG1hY3JvcyAqLwpAQCAtMjI2
LDcgKzIyNiw3IEBAIHN0YXRpYyB2b2lkICpyY3VfcV91cGRhdGVyKHZvaWQgKmFyZykKICAgICAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgIH0KICAgICAgICAgfQotICAgICAgICBpZiAo
YXRvbWljX3JlYWQoJmdvZmxhZykgPT0gR09GTEFHX1NUT1ApIHsKKyAgICAgICAgaWYgKHFlbXVf
YXRvbWljX3JlYWQoJmdvZmxhZykgPT0gR09GTEFHX1NUT1ApIHsKICAgICAgICAgICAgIGJyZWFr
OwogICAgICAgICB9CiAgICAgICAgIHRhcmdldF9lbCA9IHNlbGVjdF9yYW5kb21fZWwoUkNVX1Ff
TEVOKTsKQEAgLTI0OCw3ICsyNDgsNyBAQCBzdGF0aWMgdm9pZCAqcmN1X3FfdXBkYXRlcih2b2lk
ICphcmcpCiAgICAgcWVtdV9tdXRleF9sb2NrKCZjb3VudHNfbXV0ZXgpOwogICAgIG5fbm9kZXMg
Kz0gbl9ub2Rlc19sb2NhbDsKICAgICBuX3VwZGF0ZXMgKz0gbl91cGRhdGVzX2xvY2FsOwotICAg
IGF0b21pY19zZXRfaTY0KCZuX25vZGVzX3JlbW92ZWQsIG5fbm9kZXNfcmVtb3ZlZCArIG5fcmVt
b3ZlZF9sb2NhbCk7CisgICAgcWVtdV9hdG9taWNfc2V0X2k2NCgmbl9ub2Rlc19yZW1vdmVkLCBu
X25vZGVzX3JlbW92ZWQgKyBuX3JlbW92ZWRfbG9jYWwpOwogICAgIHFlbXVfbXV0ZXhfdW5sb2Nr
KCZjb3VudHNfbXV0ZXgpOwogICAgIHJldHVybiBOVUxMOwogfQpAQCAtMjcxLDEzICsyNzEsMTMg
QEAgc3RhdGljIHZvaWQgcmN1X3F0ZXN0X2luaXQodm9pZCkKIHN0YXRpYyB2b2lkIHJjdV9xdGVz
dF9ydW4oaW50IGR1cmF0aW9uLCBpbnQgbnJlYWRlcnMpCiB7CiAgICAgaW50IG50aHJlYWRzID0g
bnJlYWRlcnMgKyAxOwotICAgIHdoaWxlIChhdG9taWNfcmVhZCgmbnRocmVhZHNydW5uaW5nKSA8
IG50aHJlYWRzKSB7CisgICAgd2hpbGUgKHFlbXVfYXRvbWljX3JlYWQoJm50aHJlYWRzcnVubmlu
ZykgPCBudGhyZWFkcykgewogICAgICAgICBnX3VzbGVlcCgxMDAwKTsKICAgICB9CiAKLSAgICBh
dG9taWNfc2V0KCZnb2ZsYWcsIEdPRkxBR19SVU4pOworICAgIHFlbXVfYXRvbWljX3NldCgmZ29m
bGFnLCBHT0ZMQUdfUlVOKTsKICAgICBzbGVlcChkdXJhdGlvbik7Ci0gICAgYXRvbWljX3NldCgm
Z29mbGFnLCBHT0ZMQUdfU1RPUCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZnb2ZsYWcsIEdPRkxB
R19TVE9QKTsKICAgICB3YWl0X2FsbF90aHJlYWRzKCk7CiB9CiAKQEAgLTMwMiwyMSArMzAyLDIz
IEBAIHN0YXRpYyB2b2lkIHJjdV9xdGVzdChjb25zdCBjaGFyICp0ZXN0LCBpbnQgZHVyYXRpb24s
IGludCBucmVhZGVycykKICAgICAgICAgbl9yZW1vdmVkX2xvY2FsKys7CiAgICAgfQogICAgIHFl
bXVfbXV0ZXhfbG9jaygmY291bnRzX211dGV4KTsKLSAgICBhdG9taWNfc2V0X2k2NCgmbl9ub2Rl
c19yZW1vdmVkLCBuX25vZGVzX3JlbW92ZWQgKyBuX3JlbW92ZWRfbG9jYWwpOworICAgIHFlbXVf
YXRvbWljX3NldF9pNjQoJm5fbm9kZXNfcmVtb3ZlZCwgbl9ub2Rlc19yZW1vdmVkICsgbl9yZW1v
dmVkX2xvY2FsKTsKICAgICBxZW11X211dGV4X3VubG9jaygmY291bnRzX211dGV4KTsKICAgICBz
eW5jaHJvbml6ZV9yY3UoKTsKLSAgICB3aGlsZSAoYXRvbWljX3JlYWRfaTY0KCZuX25vZGVzX3Jl
bW92ZWQpID4gYXRvbWljX3JlYWRfaTY0KCZuX3JlY2xhaW1zKSkgeworICAgIHdoaWxlIChxZW11
X2F0b21pY19yZWFkX2k2NCgmbl9ub2Rlc19yZW1vdmVkKSA+CisgICAgICAgICAgIHFlbXVfYXRv
bWljX3JlYWRfaTY0KCZuX3JlY2xhaW1zKSkgewogICAgICAgICBnX3VzbGVlcCgxMDApOwogICAg
ICAgICBzeW5jaHJvbml6ZV9yY3UoKTsKICAgICB9CiAgICAgaWYgKGdfdGVzdF9pbl9jaGFyZ2Up
IHsKLSAgICAgICAgZ19hc3NlcnRfY21waW50KGF0b21pY19yZWFkX2k2NCgmbl9ub2Rlc19yZW1v
dmVkKSwgPT0sCi0gICAgICAgICAgICAgICAgICAgICAgICBhdG9taWNfcmVhZF9pNjQoJm5fcmVj
bGFpbXMpKTsKKyAgICAgICAgZ19hc3NlcnRfY21waW50KHFlbXVfYXRvbWljX3JlYWRfaTY0KCZu
X25vZGVzX3JlbW92ZWQpLCA9PSwKKyAgICAgICAgICAgICAgICAgICAgICAgIHFlbXVfYXRvbWlj
X3JlYWRfaTY0KCZuX3JlY2xhaW1zKSk7CiAgICAgfSBlbHNlIHsKICAgICAgICAgcHJpbnRmKCIl
czogJWQgcmVhZGVyczsgMSB1cGRhdGVyOyBub2RlcyByZWFkOiAiICBcCiAgICAgICAgICAgICAg
ICAiJWxsZCwgbm9kZXMgcmVtb3ZlZDogJSJQUklpNjQiOyBub2RlcyByZWNsYWltZWQ6ICUiUFJJ
aTY0IlxuIiwKICAgICAgICAgICAgICAgIHRlc3QsIG50aHJlYWRzcnVubmluZyAtIDEsIG5fcmVh
ZHMsCi0gICAgICAgICAgICAgICBhdG9taWNfcmVhZF9pNjQoJm5fbm9kZXNfcmVtb3ZlZCksIGF0
b21pY19yZWFkX2k2NCgmbl9yZWNsYWltcykpOworICAgICAgICAgICAgICAgcWVtdV9hdG9taWNf
cmVhZF9pNjQoJm5fbm9kZXNfcmVtb3ZlZCksCisgICAgICAgICAgICAgICBxZW11X2F0b21pY19y
ZWFkX2k2NCgmbl9yZWNsYWltcykpOwogICAgICAgICBleGl0KDApOwogICAgIH0KIH0KZGlmZiAt
LWdpdCBhL3Rlc3RzL3Rlc3QtdGhyZWFkLXBvb2wuYyBiL3Rlc3RzL3Rlc3QtdGhyZWFkLXBvb2wu
YwppbmRleCAwYjY3NTkyM2Y2Li4wZTUzZTg2N2Q5IDEwMDY0NAotLS0gYS90ZXN0cy90ZXN0LXRo
cmVhZC1wb29sLmMKKysrIGIvdGVzdHMvdGVzdC10aHJlYWQtcG9vbC5jCkBAIC0yMSwxNSArMjEs
MTUgQEAgdHlwZWRlZiBzdHJ1Y3Qgewogc3RhdGljIGludCB3b3JrZXJfY2Iodm9pZCAqb3BhcXVl
KQogewogICAgIFdvcmtlclRlc3REYXRhICpkYXRhID0gb3BhcXVlOwotICAgIHJldHVybiBhdG9t
aWNfZmV0Y2hfaW5jKCZkYXRhLT5uKTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfZmV0Y2hfaW5j
KCZkYXRhLT5uKTsKIH0KIAogc3RhdGljIGludCBsb25nX2NiKHZvaWQgKm9wYXF1ZSkKIHsKICAg
ICBXb3JrZXJUZXN0RGF0YSAqZGF0YSA9IG9wYXF1ZTsKLSAgICBpZiAoYXRvbWljX2NtcHhjaGco
JmRhdGEtPm4sIDAsIDEpID09IDApIHsKKyAgICBpZiAocWVtdV9hdG9taWNfY21weGNoZygmZGF0
YS0+biwgMCwgMSkgPT0gMCkgewogICAgICAgICBnX3VzbGVlcCgyMDAwMDAwKTsKLSAgICAgICAg
YXRvbWljX29yKCZkYXRhLT5uLCAyKTsKKyAgICAgICAgcWVtdV9hdG9taWNfb3IoJmRhdGEtPm4s
IDIpOwogICAgIH0KICAgICByZXR1cm4gMDsKIH0KQEAgLTE3Miw3ICsxNzIsNyBAQCBzdGF0aWMg
dm9pZCBkb190ZXN0X2NhbmNlbChib29sIHN5bmMpCiAgICAgLyogQ2FuY2VsIHRoZSBqb2JzIHRo
YXQgaGF2ZW4ndCBiZWVuIHN0YXJ0ZWQgeWV0LiAgKi8KICAgICBudW1fY2FuY2VsZWQgPSAwOwog
ICAgIGZvciAoaSA9IDA7IGkgPCAxMDA7IGkrKykgewotICAgICAgICBpZiAoYXRvbWljX2NtcHhj
aGcoJmRhdGFbaV0ubiwgMCwgNCkgPT0gMCkgeworICAgICAgICBpZiAocWVtdV9hdG9taWNfY21w
eGNoZygmZGF0YVtpXS5uLCAwLCA0KSA9PSAwKSB7CiAgICAgICAgICAgICBkYXRhW2ldLnJldCA9
IC1FQ0FOQ0VMRUQ7CiAgICAgICAgICAgICBpZiAoc3luYykgewogICAgICAgICAgICAgICAgIGJk
cnZfYWlvX2NhbmNlbChkYXRhW2ldLmFpb2NiKTsKQEAgLTE4Niw3ICsxODYsNyBAQCBzdGF0aWMg
dm9pZCBkb190ZXN0X2NhbmNlbChib29sIHN5bmMpCiAgICAgZ19hc3NlcnRfY21waW50KG51bV9j
YW5jZWxlZCwgPCwgMTAwKTsKIAogICAgIGZvciAoaSA9IDA7IGkgPCAxMDA7IGkrKykgewotICAg
ICAgICBpZiAoZGF0YVtpXS5haW9jYiAmJiBhdG9taWNfcmVhZCgmZGF0YVtpXS5uKSA8IDQpIHsK
KyAgICAgICAgaWYgKGRhdGFbaV0uYWlvY2IgJiYgcWVtdV9hdG9taWNfcmVhZCgmZGF0YVtpXS5u
KSA8IDQpIHsKICAgICAgICAgICAgIGlmIChzeW5jKSB7CiAgICAgICAgICAgICAgICAgLyogQ2Fu
Y2VsaW5nIHRoZSBvdGhlcnMgd2lsbCBiZSBhIGJsb2NraW5nIG9wZXJhdGlvbi4gICovCiAgICAg
ICAgICAgICAgICAgYmRydl9haW9fY2FuY2VsKGRhdGFbaV0uYWlvY2IpOwpkaWZmIC0tZ2l0IGEv
dXRpbC9haW8tcG9zaXguYyBiL3V0aWwvYWlvLXBvc2l4LmMKaW5kZXggZjdmMTNlYmZjMi4uNzc3
ZWFlNGQxZCAxMDA2NDQKLS0tIGEvdXRpbC9haW8tcG9zaXguYworKysgYi91dGlsL2Fpby1wb3Np
eC5jCkBAIC0yNyw3ICsyNyw3IEBACiAKIGJvb2wgYWlvX3BvbGxfZGlzYWJsZWQoQWlvQ29udGV4
dCAqY3R4KQogewotICAgIHJldHVybiBhdG9taWNfcmVhZCgmY3R4LT5wb2xsX2Rpc2FibGVfY250
KTsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNfcmVhZCgmY3R4LT5wb2xsX2Rpc2FibGVfY250KTsK
IH0KIAogdm9pZCBhaW9fYWRkX3JlYWR5X2hhbmRsZXIoQWlvSGFuZGxlckxpc3QgKnJlYWR5X2xp
c3QsCkBAIC0xNDgsOCArMTQ4LDggQEAgdm9pZCBhaW9fc2V0X2ZkX2hhbmRsZXIoQWlvQ29udGV4
dCAqY3R4LAogICAgICAqIENoYW5naW5nIGhhbmRsZXJzIGlzIGEgcmFyZSBldmVudCwgYW5kIGEg
bGl0dGxlIHdhc3RlZCBwb2xsaW5nIHVudGlsCiAgICAgICogdGhlIGFpb19ub3RpZnkgYmVsb3cg
aXMgbm90IGFuIGlzc3VlLgogICAgICAqLwotICAgIGF0b21pY19zZXQoJmN0eC0+cG9sbF9kaXNh
YmxlX2NudCwKLSAgICAgICAgICAgICAgIGF0b21pY19yZWFkKCZjdHgtPnBvbGxfZGlzYWJsZV9j
bnQpICsgcG9sbF9kaXNhYmxlX2NoYW5nZSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZjdHgtPnBv
bGxfZGlzYWJsZV9jbnQsCisgICAgICAgICAgICAgICBxZW11X2F0b21pY19yZWFkKCZjdHgtPnBv
bGxfZGlzYWJsZV9jbnQpICsgcG9sbF9kaXNhYmxlX2NoYW5nZSk7CiAKICAgICBjdHgtPmZkbW9u
X29wcy0+dXBkYXRlKGN0eCwgbm9kZSwgbmV3X25vZGUpOwogICAgIGlmIChub2RlKSB7CkBAIC01
ODEsNyArNTgxLDggQEAgYm9vbCBhaW9fcG9sbChBaW9Db250ZXh0ICpjdHgsIGJvb2wgYmxvY2tp
bmcpCiAgICAgICovCiAgICAgdXNlX25vdGlmeV9tZSA9IHRpbWVvdXQgIT0gMDsKICAgICBpZiAo
dXNlX25vdGlmeV9tZSkgewotICAgICAgICBhdG9taWNfc2V0KCZjdHgtPm5vdGlmeV9tZSwgYXRv
bWljX3JlYWQoJmN0eC0+bm90aWZ5X21lKSArIDIpOworICAgICAgICBxZW11X2F0b21pY19zZXQo
JmN0eC0+bm90aWZ5X21lLAorICAgICAgICAgICAgICAgICAgICAgICAgcWVtdV9hdG9taWNfcmVh
ZCgmY3R4LT5ub3RpZnlfbWUpICsgMik7CiAgICAgICAgIC8qCiAgICAgICAgICAqIFdyaXRlIGN0
eC0+bm90aWZ5X21lIGJlZm9yZSByZWFkaW5nIGN0eC0+bm90aWZpZWQuICBQYWlycyB3aXRoCiAg
ICAgICAgICAqIHNtcF9tYiBpbiBhaW9fbm90aWZ5KCkuCkBAIC01ODksNyArNTkwLDcgQEAgYm9v
bCBhaW9fcG9sbChBaW9Db250ZXh0ICpjdHgsIGJvb2wgYmxvY2tpbmcpCiAgICAgICAgIHNtcF9t
YigpOwogCiAgICAgICAgIC8qIERvbid0IGJsb2NrIGlmIGFpb19ub3RpZnkoKSB3YXMgY2FsbGVk
ICovCi0gICAgICAgIGlmIChhdG9taWNfcmVhZCgmY3R4LT5ub3RpZmllZCkpIHsKKyAgICAgICAg
aWYgKHFlbXVfYXRvbWljX3JlYWQoJmN0eC0+bm90aWZpZWQpKSB7CiAgICAgICAgICAgICB0aW1l
b3V0ID0gMDsKICAgICAgICAgfQogICAgIH0KQEAgLTYwMyw4ICs2MDQsOCBAQCBib29sIGFpb19w
b2xsKEFpb0NvbnRleHQgKmN0eCwgYm9vbCBibG9ja2luZykKIAogICAgIGlmICh1c2Vfbm90aWZ5
X21lKSB7CiAgICAgICAgIC8qIEZpbmlzaCB0aGUgcG9sbCBiZWZvcmUgY2xlYXJpbmcgdGhlIGZs
YWcuICAqLwotICAgICAgICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5ub3RpZnlfbWUsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9tZSkg
LSAyKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5ub3RpZnlfbWUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX3JlYWQoJmN0eC0+bm90
aWZ5X21lKSAtIDIpOwogICAgIH0KIAogICAgIGFpb19ub3RpZnlfYWNjZXB0KGN0eCk7CmRpZmYg
LS1naXQgYS91dGlsL2Fpby13YWl0LmMgYi91dGlsL2Fpby13YWl0LmMKaW5kZXggYjQ4Nzc0OTNm
OC4uMWFlYTZlN2ZhMCAxMDA2NDQKLS0tIGEvdXRpbC9haW8td2FpdC5jCisrKyBiL3V0aWwvYWlv
LXdhaXQuYwpAQCAtMzYsNyArMzYsNyBAQCBzdGF0aWMgdm9pZCBkdW1teV9iaF9jYih2b2lkICpv
cGFxdWUpCiB2b2lkIGFpb193YWl0X2tpY2sodm9pZCkKIHsKICAgICAvKiBUaGUgYmFycmllciAo
b3IgYW4gYXRvbWljIG9wKSBpcyBpbiB0aGUgY2FsbGVyLiAgKi8KLSAgICBpZiAoYXRvbWljX3Jl
YWQoJmdsb2JhbF9haW9fd2FpdC5udW1fd2FpdGVycykpIHsKKyAgICBpZiAocWVtdV9hdG9taWNf
cmVhZCgmZ2xvYmFsX2Fpb193YWl0Lm51bV93YWl0ZXJzKSkgewogICAgICAgICBhaW9fYmhfc2No
ZWR1bGVfb25lc2hvdChxZW11X2dldF9haW9fY29udGV4dCgpLCBkdW1teV9iaF9jYiwgTlVMTCk7
CiAgICAgfQogfQpkaWZmIC0tZ2l0IGEvdXRpbC9haW8td2luMzIuYyBiL3V0aWwvYWlvLXdpbjMy
LmMKaW5kZXggNDliZDkwZTYyZS4uY2ZhODFjNjIxNyAxMDA2NDQKLS0tIGEvdXRpbC9haW8td2lu
MzIuYworKysgYi91dGlsL2Fpby13aW4zMi5jCkBAIC0zNDUsNyArMzQ1LDggQEAgYm9vbCBhaW9f
cG9sbChBaW9Db250ZXh0ICpjdHgsIGJvb2wgYmxvY2tpbmcpCiAgICAgICogc28gZGlzYWJsZSB0
aGUgb3B0aW1pemF0aW9uIG5vdy4KICAgICAgKi8KICAgICBpZiAoYmxvY2tpbmcpIHsKLSAgICAg
ICAgYXRvbWljX3NldCgmY3R4LT5ub3RpZnlfbWUsIGF0b21pY19yZWFkKCZjdHgtPm5vdGlmeV9t
ZSkgKyAyKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZjdHgtPm5vdGlmeV9tZSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX3JlYWQoJmN0eC0+bm90aWZ5X21lKSArIDIp
OwogICAgICAgICAvKgogICAgICAgICAgKiBXcml0ZSBjdHgtPm5vdGlmeV9tZSBiZWZvcmUgY29t
cHV0aW5nIHRoZSB0aW1lb3V0CiAgICAgICAgICAqIChyZWFkaW5nIGJvdHRvbSBoYWxmIGZsYWdz
LCBldGMuKS4gIFBhaXJzIHdpdGgKQEAgLTM4NCw3ICszODUsOCBAQCBib29sIGFpb19wb2xsKEFp
b0NvbnRleHQgKmN0eCwgYm9vbCBibG9ja2luZykKICAgICAgICAgcmV0ID0gV2FpdEZvck11bHRp
cGxlT2JqZWN0cyhjb3VudCwgZXZlbnRzLCBGQUxTRSwgdGltZW91dCk7CiAgICAgICAgIGlmIChi
bG9ja2luZykgewogICAgICAgICAgICAgYXNzZXJ0KGZpcnN0KTsKLSAgICAgICAgICAgIGF0b21p
Y19zdG9yZV9yZWxlYXNlKCZjdHgtPm5vdGlmeV9tZSwgYXRvbWljX3JlYWQoJmN0eC0+bm90aWZ5
X21lKSAtIDIpOworICAgICAgICAgICAgcWVtdV9hdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5u
b3RpZnlfbWUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFlbXVfYXRv
bWljX3JlYWQoJmN0eC0+bm90aWZ5X21lKSAtIDIpOwogICAgICAgICAgICAgYWlvX25vdGlmeV9h
Y2NlcHQoY3R4KTsKICAgICAgICAgfQogCmRpZmYgLS1naXQgYS91dGlsL2FzeW5jLmMgYi91dGls
L2FzeW5jLmMKaW5kZXggNDI2Njc0NWRlZS4uOTM0MWFhY2RjZCAxMDA2NDQKLS0tIGEvdXRpbC9h
c3luYy5jCisrKyBiL3V0aWwvYXN5bmMuYwpAQCAtNzAsMTMgKzcwLDEzIEBAIHN0YXRpYyB2b2lk
IGFpb19iaF9lbnF1ZXVlKFFFTVVCSCAqYmgsIHVuc2lnbmVkIG5ld19mbGFncykKICAgICB1bnNp
Z25lZCBvbGRfZmxhZ3M7CiAKICAgICAvKgotICAgICAqIFRoZSBtZW1vcnkgYmFycmllciBpbXBs
aWNpdCBpbiBhdG9taWNfZmV0Y2hfb3IgbWFrZXMgc3VyZSB0aGF0OgorICAgICAqIFRoZSBtZW1v
cnkgYmFycmllciBpbXBsaWNpdCBpbiBxZW11X2F0b21pY19mZXRjaF9vciBtYWtlcyBzdXJlIHRo
YXQ6CiAgICAgICogMS4gaWRsZSAmIGFueSB3cml0ZXMgbmVlZGVkIGJ5IHRoZSBjYWxsYmFjayBh
cmUgZG9uZSBiZWZvcmUgdGhlCiAgICAgICogICAgbG9jYXRpb25zIGFyZSByZWFkIGluIHRoZSBh
aW9fYmhfcG9sbC4KICAgICAgKiAyLiBjdHggaXMgbG9hZGVkIGJlZm9yZSB0aGUgY2FsbGJhY2sg
aGFzIGEgY2hhbmNlIHRvIGV4ZWN1dGUgYW5kIGJoCiAgICAgICogICAgY291bGQgYmUgZnJlZWQu
CiAgICAgICovCi0gICAgb2xkX2ZsYWdzID0gYXRvbWljX2ZldGNoX29yKCZiaC0+ZmxhZ3MsIEJI
X1BFTkRJTkcgfCBuZXdfZmxhZ3MpOworICAgIG9sZF9mbGFncyA9IHFlbXVfYXRvbWljX2ZldGNo
X29yKCZiaC0+ZmxhZ3MsIEJIX1BFTkRJTkcgfCBuZXdfZmxhZ3MpOwogICAgIGlmICghKG9sZF9m
bGFncyAmIEJIX1BFTkRJTkcpKSB7CiAgICAgICAgIFFTTElTVF9JTlNFUlRfSEVBRF9BVE9NSUMo
JmN0eC0+YmhfbGlzdCwgYmgsIG5leHQpOwogICAgIH0KQEAgLTk2LDEzICs5NiwxMyBAQCBzdGF0
aWMgUUVNVUJIICphaW9fYmhfZGVxdWV1ZShCSExpc3QgKmhlYWQsIHVuc2lnbmVkICpmbGFncykK
ICAgICBRU0xJU1RfUkVNT1ZFX0hFQUQoaGVhZCwgbmV4dCk7CiAKICAgICAvKgotICAgICAqIFRo
ZSBhdG9taWNfYW5kIGlzIHBhaXJlZCB3aXRoIGFpb19iaF9lbnF1ZXVlKCkuICBUaGUgaW1wbGlj
aXQgbWVtb3J5Ci0gICAgICogYmFycmllciBlbnN1cmVzIHRoYXQgdGhlIGNhbGxiYWNrIHNlZXMg
YWxsIHdyaXRlcyBkb25lIGJ5IHRoZSBzY2hlZHVsaW5nCi0gICAgICogdGhyZWFkLiAgSXQgYWxz
byBlbnN1cmVzIHRoYXQgdGhlIHNjaGVkdWxpbmcgdGhyZWFkIHNlZXMgdGhlIGNsZWFyZWQKLSAg
ICAgKiBmbGFnIGJlZm9yZSBiaC0+Y2IgaGFzIHJ1biwgYW5kIHRodXMgd2lsbCBjYWxsIGFpb19u
b3RpZnkgYWdhaW4gaWYKLSAgICAgKiBuZWNlc3NhcnkuCisgICAgICogVGhlIHFlbXVfYXRvbWlj
X2FuZCBpcyBwYWlyZWQgd2l0aCBhaW9fYmhfZW5xdWV1ZSgpLiAgVGhlIGltcGxpY2l0CisgICAg
ICogbWVtb3J5IGJhcnJpZXIgZW5zdXJlcyB0aGF0IHRoZSBjYWxsYmFjayBzZWVzIGFsbCB3cml0
ZXMgZG9uZSBieSB0aGUKKyAgICAgKiBzY2hlZHVsaW5nIHRocmVhZC4gIEl0IGFsc28gZW5zdXJl
cyB0aGF0IHRoZSBzY2hlZHVsaW5nIHRocmVhZCBzZWVzIHRoZQorICAgICAqIGNsZWFyZWQgZmxh
ZyBiZWZvcmUgYmgtPmNiIGhhcyBydW4sIGFuZCB0aHVzIHdpbGwgY2FsbCBhaW9fbm90aWZ5IGFn
YWluCisgICAgICogaWYgbmVjZXNzYXJ5LgogICAgICAqLwotICAgICpmbGFncyA9IGF0b21pY19m
ZXRjaF9hbmQoJmJoLT5mbGFncywKKyAgICAqZmxhZ3MgPSBxZW11X2F0b21pY19mZXRjaF9hbmQo
JmJoLT5mbGFncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH4oQkhfUEVORElORyB8
IEJIX1NDSEVEVUxFRCB8IEJIX0lETEUpKTsKICAgICByZXR1cm4gYmg7CiB9CkBAIC0xODUsNyAr
MTg1LDcgQEAgdm9pZCBxZW11X2JoX3NjaGVkdWxlKFFFTVVCSCAqYmgpCiAgKi8KIHZvaWQgcWVt
dV9iaF9jYW5jZWwoUUVNVUJIICpiaCkKIHsKLSAgICBhdG9taWNfYW5kKCZiaC0+ZmxhZ3MsIH5C
SF9TQ0hFRFVMRUQpOworICAgIHFlbXVfYXRvbWljX2FuZCgmYmgtPmZsYWdzLCB+QkhfU0NIRURV
TEVEKTsKIH0KIAogLyogVGhpcyBmdW5jIGlzIGFzeW5jLlRoZSBib3R0b20gaGFsZiB3aWxsIGRv
IHRoZSBkZWxldGUgYWN0aW9uIGF0IHRoZSBmaW5pYWwKQEAgLTI0OSw3ICsyNDksNyBAQCBhaW9f
Y3R4X3ByZXBhcmUoR1NvdXJjZSAqc291cmNlLCBnaW50ICAgICp0aW1lb3V0KQogewogICAgIEFp
b0NvbnRleHQgKmN0eCA9IChBaW9Db250ZXh0ICopIHNvdXJjZTsKIAotICAgIGF0b21pY19zZXQo
JmN0eC0+bm90aWZ5X21lLCBhdG9taWNfcmVhZCgmY3R4LT5ub3RpZnlfbWUpIHwgMSk7CisgICAg
cWVtdV9hdG9taWNfc2V0KCZjdHgtPm5vdGlmeV9tZSwgcWVtdV9hdG9taWNfcmVhZCgmY3R4LT5u
b3RpZnlfbWUpIHwgMSk7CiAKICAgICAvKgogICAgICAqIFdyaXRlIGN0eC0+bm90aWZ5X21lIGJl
Zm9yZSBjb21wdXRpbmcgdGhlIHRpbWVvdXQKQEAgLTI3Niw3ICsyNzYsOCBAQCBhaW9fY3R4X2No
ZWNrKEdTb3VyY2UgKnNvdXJjZSkKICAgICBCSExpc3RTbGljZSAqczsKIAogICAgIC8qIEZpbmlz
aCBjb21wdXRpbmcgdGhlIHRpbWVvdXQgYmVmb3JlIGNsZWFyaW5nIHRoZSBmbGFnLiAgKi8KLSAg
ICBhdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5ub3RpZnlfbWUsIGF0b21pY19yZWFkKCZjdHgt
Pm5vdGlmeV9tZSkgJiB+MSk7CisgICAgcWVtdV9hdG9taWNfc3RvcmVfcmVsZWFzZSgmY3R4LT5u
b3RpZnlfbWUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxZW11X2F0b21pY19yZWFk
KCZjdHgtPm5vdGlmeV9tZSkgJiB+MSk7CiAgICAgYWlvX25vdGlmeV9hY2NlcHQoY3R4KTsKIAog
ICAgIFFTTElTVF9GT1JFQUNIX1JDVShiaCwgJmN0eC0+YmhfbGlzdCwgbmV4dCkgewpAQCAtNDI0
LDIxICs0MjUsMjEgQEAgdm9pZCBhaW9fbm90aWZ5KEFpb0NvbnRleHQgKmN0eCkKICAgICAgKiBh
aW9fbm90aWZ5X2FjY2VwdC4KICAgICAgKi8KICAgICBzbXBfd21iKCk7Ci0gICAgYXRvbWljX3Nl
dCgmY3R4LT5ub3RpZmllZCwgdHJ1ZSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZjdHgtPm5vdGlm
aWVkLCB0cnVlKTsKIAogICAgIC8qCiAgICAgICogV3JpdGUgY3R4LT5ub3RpZmllZCBiZWZvcmUg
cmVhZGluZyBjdHgtPm5vdGlmeV9tZS4gIFBhaXJzCiAgICAgICogd2l0aCBzbXBfbWIgaW4gYWlv
X2N0eF9wcmVwYXJlIG9yIGFpb19wb2xsLgogICAgICAqLwogICAgIHNtcF9tYigpOwotICAgIGlm
IChhdG9taWNfcmVhZCgmY3R4LT5ub3RpZnlfbWUpKSB7CisgICAgaWYgKHFlbXVfYXRvbWljX3Jl
YWQoJmN0eC0+bm90aWZ5X21lKSkgewogICAgICAgICBldmVudF9ub3RpZmllcl9zZXQoJmN0eC0+
bm90aWZpZXIpOwogICAgIH0KIH0KIAogdm9pZCBhaW9fbm90aWZ5X2FjY2VwdChBaW9Db250ZXh0
ICpjdHgpCiB7Ci0gICAgYXRvbWljX3NldCgmY3R4LT5ub3RpZmllZCwgZmFsc2UpOworICAgIHFl
bXVfYXRvbWljX3NldCgmY3R4LT5ub3RpZmllZCwgZmFsc2UpOwogCiAgICAgLyoKICAgICAgKiBX
cml0ZSBjdHgtPm5vdGlmaWVkIGJlZm9yZSByZWFkaW5nIGUuZy4gYmgtPmZsYWdzLiAgUGFpcnMg
d2l0aCBzbXBfd21iCkBAIC00NjUsNyArNDY2LDcgQEAgc3RhdGljIGJvb2wgYWlvX2NvbnRleHRf
bm90aWZpZXJfcG9sbCh2b2lkICpvcGFxdWUpCiAgICAgRXZlbnROb3RpZmllciAqZSA9IG9wYXF1
ZTsKICAgICBBaW9Db250ZXh0ICpjdHggPSBjb250YWluZXJfb2YoZSwgQWlvQ29udGV4dCwgbm90
aWZpZXIpOwogCi0gICAgcmV0dXJuIGF0b21pY19yZWFkKCZjdHgtPm5vdGlmaWVkKTsKKyAgICBy
ZXR1cm4gcWVtdV9hdG9taWNfcmVhZCgmY3R4LT5ub3RpZmllZCk7CiB9CiAKIHN0YXRpYyB2b2lk
IGNvX3NjaGVkdWxlX2JoX2NiKHZvaWQgKm9wYXF1ZSkKQEAgLTQ4OSw3ICs0OTAsNyBAQCBzdGF0
aWMgdm9pZCBjb19zY2hlZHVsZV9iaF9jYih2b2lkICpvcGFxdWUpCiAgICAgICAgIGFpb19jb250
ZXh0X2FjcXVpcmUoY3R4KTsKIAogICAgICAgICAvKiBQcm90ZWN0ZWQgYnkgd3JpdGUgYmFycmll
ciBpbiBxZW11X2Fpb19jb3JvdXRpbmVfZW50ZXIgKi8KLSAgICAgICAgYXRvbWljX3NldCgmY28t
PnNjaGVkdWxlZCwgTlVMTCk7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmY28tPnNjaGVkdWxl
ZCwgTlVMTCk7CiAgICAgICAgIHFlbXVfYWlvX2Nvcm91dGluZV9lbnRlcihjdHgsIGNvKTsKICAg
ICAgICAgYWlvX2NvbnRleHRfcmVsZWFzZShjdHgpOwogICAgIH0KQEAgLTU0Niw3ICs1NDcsNyBA
QCBmYWlsOgogdm9pZCBhaW9fY29fc2NoZWR1bGUoQWlvQ29udGV4dCAqY3R4LCBDb3JvdXRpbmUg
KmNvKQogewogICAgIHRyYWNlX2Fpb19jb19zY2hlZHVsZShjdHgsIGNvKTsKLSAgICBjb25zdCBj
aGFyICpzY2hlZHVsZWQgPSBhdG9taWNfY21weGNoZygmY28tPnNjaGVkdWxlZCwgTlVMTCwKKyAg
ICBjb25zdCBjaGFyICpzY2hlZHVsZWQgPSBxZW11X2F0b21pY19jbXB4Y2hnKCZjby0+c2NoZWR1
bGVkLCBOVUxMLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9f
ZnVuY19fKTsKIAogICAgIGlmIChzY2hlZHVsZWQpIHsKQEAgLTU3Nyw3ICs1NzgsNyBAQCB2b2lk
IGFpb19jb193YWtlKHN0cnVjdCBDb3JvdXRpbmUgKmNvKQogICAgICAqIHFlbXVfY29yb3V0aW5l
X2VudGVyLgogICAgICAqLwogICAgIHNtcF9yZWFkX2JhcnJpZXJfZGVwZW5kcygpOwotICAgIGN0
eCA9IGF0b21pY19yZWFkKCZjby0+Y3R4KTsKKyAgICBjdHggPSBxZW11X2F0b21pY19yZWFkKCZj
by0+Y3R4KTsKIAogICAgIGFpb19jb19lbnRlcihjdHgsIGNvKTsKIH0KZGlmZiAtLWdpdCBhL3V0
aWwvYXRvbWljNjQuYyBiL3V0aWwvYXRvbWljNjQuYwppbmRleCBiMTk4YTZjOWM4Li44N2U1OWJi
YWMwIDEwMDY0NAotLS0gYS91dGlsL2F0b21pYzY0LmMKKysrIGIvdXRpbC9hdG9taWM2NC5jCkBA
IC01MSw4ICs1MSw4IEBAIHN0YXRpYyBRZW11U3BpbiAqYWRkcl90b19sb2NrKGNvbnN0IHZvaWQg
KmFkZHIpCiAgICAgICAgIHJldHVybiByZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CiAgICAgfQogCi1HRU5fUkVBRChhdG9taWNfcmVhZF9pNjQsIGludDY0X3QpCi1HRU5fUkVBRChh
dG9taWNfcmVhZF91NjQsIHVpbnQ2NF90KQorR0VOX1JFQUQocWVtdV9hdG9taWNfcmVhZF9pNjQs
IGludDY0X3QpCitHRU5fUkVBRChxZW11X2F0b21pY19yZWFkX3U2NCwgdWludDY0X3QpCiAjdW5k
ZWYgR0VOX1JFQUQKIAogI2RlZmluZSBHRU5fU0VUKG5hbWUsIHR5cGUpICAgICAgICAgICAgICAg
ICAgICAgXApAQCAtNjUsMTEgKzY1LDExIEBAIEdFTl9SRUFEKGF0b21pY19yZWFkX3U2NCwgdWlu
dDY0X3QpCiAgICAgICAgIHFlbXVfc3Bpbl91bmxvY2sobG9jayk7ICAgICAgICAgICAgICAgICBc
CiAgICAgfQogCi1HRU5fU0VUKGF0b21pY19zZXRfaTY0LCBpbnQ2NF90KQotR0VOX1NFVChhdG9t
aWNfc2V0X3U2NCwgdWludDY0X3QpCitHRU5fU0VUKHFlbXVfYXRvbWljX3NldF9pNjQsIGludDY0
X3QpCitHRU5fU0VUKHFlbXVfYXRvbWljX3NldF91NjQsIHVpbnQ2NF90KQogI3VuZGVmIEdFTl9T
RVQKIAotdm9pZCBhdG9taWM2NF9pbml0KHZvaWQpCit2b2lkIHFlbXVfYXRvbWljNjRfaW5pdCh2
b2lkKQogewogICAgIGludCBpOwogCmRpZmYgLS1naXQgYS91dGlsL2JpdG1hcC5jIGIvdXRpbC9i
aXRtYXAuYwppbmRleCAxNzUzZmY3ZjViLi5kNzk5NTc3NmFiIDEwMDY0NAotLS0gYS91dGlsL2Jp
dG1hcC5jCisrKyBiL3V0aWwvYml0bWFwLmMKQEAgLTE5MCw3ICsxOTAsNyBAQCB2b2lkIGJpdG1h
cF9zZXRfYXRvbWljKHVuc2lnbmVkIGxvbmcgKm1hcCwgbG9uZyBzdGFydCwgbG9uZyBucikKIAog
ICAgIC8qIEZpcnN0IHdvcmQgKi8KICAgICBpZiAobnIgLSBiaXRzX3RvX3NldCA+IDApIHsKLSAg
ICAgICAgYXRvbWljX29yKHAsIG1hc2tfdG9fc2V0KTsKKyAgICAgICAgcWVtdV9hdG9taWNfb3Io
cCwgbWFza190b19zZXQpOwogICAgICAgICBuciAtPSBiaXRzX3RvX3NldDsKICAgICAgICAgYml0
c190b19zZXQgPSBCSVRTX1BFUl9MT05HOwogICAgICAgICBtYXNrX3RvX3NldCA9IH4wVUw7CkBA
IC0yMDksOSArMjA5LDkgQEAgdm9pZCBiaXRtYXBfc2V0X2F0b21pYyh1bnNpZ25lZCBsb25nICpt
YXAsIGxvbmcgc3RhcnQsIGxvbmcgbnIpCiAgICAgLyogTGFzdCB3b3JkICovCiAgICAgaWYgKG5y
KSB7CiAgICAgICAgIG1hc2tfdG9fc2V0ICY9IEJJVE1BUF9MQVNUX1dPUkRfTUFTSyhzaXplKTsK
LSAgICAgICAgYXRvbWljX29yKHAsIG1hc2tfdG9fc2V0KTsKKyAgICAgICAgcWVtdV9hdG9taWNf
b3IocCwgbWFza190b19zZXQpOwogICAgIH0gZWxzZSB7Ci0gICAgICAgIC8qIElmIHdlIGF2b2lk
ZWQgdGhlIGZ1bGwgYmFycmllciBpbiBhdG9taWNfb3IoKSwgaXNzdWUgYQorICAgICAgICAvKiBJ
ZiB3ZSBhdm9pZGVkIHRoZSBmdWxsIGJhcnJpZXIgaW4gcWVtdV9hdG9taWNfb3IoKSwgaXNzdWUg
YQogICAgICAgICAgKiBiYXJyaWVyIHRvIGFjY291bnQgZm9yIHRoZSBhc3NpZ25tZW50cyBpbiB0
aGUgd2hpbGUgbG9vcC4KICAgICAgICAgICovCiAgICAgICAgIHNtcF9tYigpOwpAQCAtMjUzLDcg
KzI1Myw3IEBAIGJvb2wgYml0bWFwX3Rlc3RfYW5kX2NsZWFyX2F0b21pYyh1bnNpZ25lZCBsb25n
ICptYXAsIGxvbmcgc3RhcnQsIGxvbmcgbnIpCiAKICAgICAvKiBGaXJzdCB3b3JkICovCiAgICAg
aWYgKG5yIC0gYml0c190b19jbGVhciA+IDApIHsKLSAgICAgICAgb2xkX2JpdHMgPSBhdG9taWNf
ZmV0Y2hfYW5kKHAsIH5tYXNrX3RvX2NsZWFyKTsKKyAgICAgICAgb2xkX2JpdHMgPSBxZW11X2F0
b21pY19mZXRjaF9hbmQocCwgfm1hc2tfdG9fY2xlYXIpOwogICAgICAgICBkaXJ0eSB8PSBvbGRf
Yml0cyAmIG1hc2tfdG9fY2xlYXI7CiAgICAgICAgIG5yIC09IGJpdHNfdG9fY2xlYXI7CiAgICAg
ICAgIGJpdHNfdG9fY2xlYXIgPSBCSVRTX1BFUl9MT05HOwpAQCAtMjY1LDcgKzI2NSw3IEBAIGJv
b2wgYml0bWFwX3Rlc3RfYW5kX2NsZWFyX2F0b21pYyh1bnNpZ25lZCBsb25nICptYXAsIGxvbmcg
c3RhcnQsIGxvbmcgbnIpCiAgICAgaWYgKGJpdHNfdG9fY2xlYXIgPT0gQklUU19QRVJfTE9ORykg
ewogICAgICAgICB3aGlsZSAobnIgPj0gQklUU19QRVJfTE9ORykgewogICAgICAgICAgICAgaWYg
KCpwKSB7Ci0gICAgICAgICAgICAgICAgb2xkX2JpdHMgPSBhdG9taWNfeGNoZyhwLCAwKTsKKyAg
ICAgICAgICAgICAgICBvbGRfYml0cyA9IHFlbXVfYXRvbWljX3hjaGcocCwgMCk7CiAgICAgICAg
ICAgICAgICAgZGlydHkgfD0gb2xkX2JpdHM7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBu
ciAtPSBCSVRTX1BFUl9MT05HOwpAQCAtMjc2LDcgKzI3Niw3IEBAIGJvb2wgYml0bWFwX3Rlc3Rf
YW5kX2NsZWFyX2F0b21pYyh1bnNpZ25lZCBsb25nICptYXAsIGxvbmcgc3RhcnQsIGxvbmcgbnIp
CiAgICAgLyogTGFzdCB3b3JkICovCiAgICAgaWYgKG5yKSB7CiAgICAgICAgIG1hc2tfdG9fY2xl
YXIgJj0gQklUTUFQX0xBU1RfV09SRF9NQVNLKHNpemUpOwotICAgICAgICBvbGRfYml0cyA9IGF0
b21pY19mZXRjaF9hbmQocCwgfm1hc2tfdG9fY2xlYXIpOworICAgICAgICBvbGRfYml0cyA9IHFl
bXVfYXRvbWljX2ZldGNoX2FuZChwLCB+bWFza190b19jbGVhcik7CiAgICAgICAgIGRpcnR5IHw9
IG9sZF9iaXRzICYgbWFza190b19jbGVhcjsKICAgICB9IGVsc2UgewogICAgICAgICBpZiAoIWRp
cnR5KSB7CkBAIC0yOTEsNyArMjkxLDcgQEAgdm9pZCBiaXRtYXBfY29weV9hbmRfY2xlYXJfYXRv
bWljKHVuc2lnbmVkIGxvbmcgKmRzdCwgdW5zaWduZWQgbG9uZyAqc3JjLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbnIpCiB7CiAgICAgd2hpbGUgKG5yID4gMCkgewot
ICAgICAgICAqZHN0ID0gYXRvbWljX3hjaGcoc3JjLCAwKTsKKyAgICAgICAgKmRzdCA9IHFlbXVf
YXRvbWljX3hjaGcoc3JjLCAwKTsKICAgICAgICAgZHN0Kys7CiAgICAgICAgIHNyYysrOwogICAg
ICAgICBuciAtPSBCSVRTX1BFUl9MT05HOwpkaWZmIC0tZ2l0IGEvdXRpbC9jYWNoZWluZm8uYyBi
L3V0aWwvY2FjaGVpbmZvLmMKaW5kZXggZDk0ZGM2YWRjOC4uNDg4MWZmMzU2OCAxMDA2NDQKLS0t
IGEvdXRpbC9jYWNoZWluZm8uYworKysgYi91dGlsL2NhY2hlaW5mby5jCkBAIC0xOTMsNSArMTkz
LDUgQEAgc3RhdGljIHZvaWQgX19hdHRyaWJ1dGVfXygoY29uc3RydWN0b3IpKSBpbml0X2NhY2hl
X2luZm8odm9pZCkKICAgICBxZW11X2RjYWNoZV9saW5lc2l6ZSA9IGRzaXplOwogICAgIHFlbXVf
ZGNhY2hlX2xpbmVzaXplX2xvZyA9IGN0ejMyKGRzaXplKTsKIAotICAgIGF0b21pYzY0X2luaXQo
KTsKKyAgICBxZW11X2F0b21pYzY0X2luaXQoKTsKIH0KZGlmZiAtLWdpdCBhL3V0aWwvZmRtb24t
ZXBvbGwuYyBiL3V0aWwvZmRtb24tZXBvbGwuYwppbmRleCBmY2Q5ODlkNDdkLi4wMjQ0N2VhODlh
IDEwMDY0NAotLS0gYS91dGlsL2ZkbW9uLWVwb2xsLmMKKysrIGIvdXRpbC9mZG1vbi1lcG9sbC5j
CkBAIC02NSw3ICs2NSw3IEBAIHN0YXRpYyBpbnQgZmRtb25fZXBvbGxfd2FpdChBaW9Db250ZXh0
ICpjdHgsIEFpb0hhbmRsZXJMaXN0ICpyZWFkeV9saXN0LAogICAgIHN0cnVjdCBlcG9sbF9ldmVu
dCBldmVudHNbMTI4XTsKIAogICAgIC8qIEZhbGwgYmFjayB3aGlsZSBleHRlcm5hbCBjbGllbnRz
IGFyZSBkaXNhYmxlZCAqLwotICAgIGlmIChhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNh
YmxlX2NudCkpIHsKKyAgICBpZiAocWVtdV9hdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNh
YmxlX2NudCkpIHsKICAgICAgICAgcmV0dXJuIGZkbW9uX3BvbGxfb3BzLndhaXQoY3R4LCByZWFk
eV9saXN0LCB0aW1lb3V0KTsKICAgICB9CiAKQEAgLTEzMiw3ICsxMzIsNyBAQCBib29sIGZkbW9u
X2Vwb2xsX3RyeV91cGdyYWRlKEFpb0NvbnRleHQgKmN0eCwgdW5zaWduZWQgbnBmZCkKICAgICB9
CiAKICAgICAvKiBEbyBub3QgdXBncmFkZSB3aGlsZSBleHRlcm5hbCBjbGllbnRzIGFyZSBkaXNh
YmxlZCAqLwotICAgIGlmIChhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCkp
IHsKKyAgICBpZiAocWVtdV9hdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCkp
IHsKICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KIApkaWZmIC0tZ2l0IGEvdXRpbC9mZG1v
bi1pb191cmluZy5jIGIvdXRpbC9mZG1vbi1pb191cmluZy5jCmluZGV4IDFkMTQxNzdkZjAuLmIx
MjIyZTUzNzAgMTAwNjQ0Ci0tLSBhL3V0aWwvZmRtb24taW9fdXJpbmcuYworKysgYi91dGlsL2Zk
bW9uLWlvX3VyaW5nLmMKQEAgLTEwMyw3ICsxMDMsOCBAQCBzdGF0aWMgdm9pZCBlbnF1ZXVlKEFp
b0hhbmRsZXJTTGlzdCAqaGVhZCwgQWlvSGFuZGxlciAqbm9kZSwgdW5zaWduZWQgZmxhZ3MpCiB7
CiAgICAgdW5zaWduZWQgb2xkX2ZsYWdzOwogCi0gICAgb2xkX2ZsYWdzID0gYXRvbWljX2ZldGNo
X29yKCZub2RlLT5mbGFncywgRkRNT05fSU9fVVJJTkdfUEVORElORyB8IGZsYWdzKTsKKyAgICBv
bGRfZmxhZ3MgPSBxZW11X2F0b21pY19mZXRjaF9vcigmbm9kZS0+ZmxhZ3MsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgRkRNT05fSU9fVVJJTkdfUEVORElORyB8IGZsYWdz
KTsKICAgICBpZiAoIShvbGRfZmxhZ3MgJiBGRE1PTl9JT19VUklOR19QRU5ESU5HKSkgewogICAg
ICAgICBRU0xJU1RfSU5TRVJUX0hFQURfQVRPTUlDKGhlYWQsIG5vZGUsIG5vZGVfc3VibWl0dGVk
KTsKICAgICB9CkBAIC0xMjcsNyArMTI4LDcgQEAgc3RhdGljIEFpb0hhbmRsZXIgKmRlcXVldWUo
QWlvSGFuZGxlclNMaXN0ICpoZWFkLCB1bnNpZ25lZCAqZmxhZ3MpCiAgICAgICogdGVsbGluZyBw
cm9jZXNzX2NxZSgpIHRvIGRlbGV0ZSB0aGUgQWlvSGFuZGxlciB3aGVuIGl0cwogICAgICAqIElP
UklOR19PUF9QT0xMX0FERCBjb21wbGV0ZXMuCiAgICAgICovCi0gICAgKmZsYWdzID0gYXRvbWlj
X2ZldGNoX2FuZCgmbm9kZS0+ZmxhZ3MsIH4oRkRNT05fSU9fVVJJTkdfUEVORElORyB8CisgICAg
KmZsYWdzID0gcWVtdV9hdG9taWNfZmV0Y2hfYW5kKCZub2RlLT5mbGFncywgfihGRE1PTl9JT19V
UklOR19QRU5ESU5HIHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBGRE1PTl9JT19VUklOR19BREQpKTsKICAgICByZXR1cm4gbm9kZTsKIH0KQEAgLTIzMyw3
ICsyMzQsNyBAQCBzdGF0aWMgYm9vbCBwcm9jZXNzX2NxZShBaW9Db250ZXh0ICpjdHgsCiAgICAg
ICogd2l0aCBlbnF1ZXVlKCkgaGVyZSB0aGVuIHdlIGNhbiBzYWZlbHkgY2xlYXIgdGhlIEZETU9O
X0lPX1VSSU5HX1JFTU9WRQogICAgICAqIGJpdCBiZWZvcmUgSU9SSU5HX09QX1BPTExfUkVNT1ZF
IGlzIHN1Ym1pdHRlZC4KICAgICAgKi8KLSAgICBmbGFncyA9IGF0b21pY19mZXRjaF9hbmQoJm5v
ZGUtPmZsYWdzLCB+RkRNT05fSU9fVVJJTkdfUkVNT1ZFKTsKKyAgICBmbGFncyA9IHFlbXVfYXRv
bWljX2ZldGNoX2FuZCgmbm9kZS0+ZmxhZ3MsIH5GRE1PTl9JT19VUklOR19SRU1PVkUpOwogICAg
IGlmIChmbGFncyAmIEZETU9OX0lPX1VSSU5HX1JFTU9WRSkgewogICAgICAgICBRTElTVF9JTlNF
UlRfSEVBRF9SQ1UoJmN0eC0+ZGVsZXRlZF9haW9faGFuZGxlcnMsIG5vZGUsIG5vZGVfZGVsZXRl
ZCk7CiAgICAgICAgIHJldHVybiBmYWxzZTsKQEAgLTI3Myw3ICsyNzQsNyBAQCBzdGF0aWMgaW50
IGZkbW9uX2lvX3VyaW5nX3dhaXQoQWlvQ29udGV4dCAqY3R4LCBBaW9IYW5kbGVyTGlzdCAqcmVh
ZHlfbGlzdCwKICAgICBpbnQgcmV0OwogCiAgICAgLyogRmFsbCBiYWNrIHdoaWxlIGV4dGVybmFs
IGNsaWVudHMgYXJlIGRpc2FibGVkICovCi0gICAgaWYgKGF0b21pY19yZWFkKCZjdHgtPmV4dGVy
bmFsX2Rpc2FibGVfY250KSkgeworICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZjdHgtPmV4dGVy
bmFsX2Rpc2FibGVfY250KSkgewogICAgICAgICByZXR1cm4gZmRtb25fcG9sbF9vcHMud2FpdChj
dHgsIHJlYWR5X2xpc3QsIHRpbWVvdXQpOwogICAgIH0KIApAQCAtMzEyLDcgKzMxMyw3IEBAIHN0
YXRpYyBib29sIGZkbW9uX2lvX3VyaW5nX25lZWRfd2FpdChBaW9Db250ZXh0ICpjdHgpCiAgICAg
fQogCiAgICAgLyogQXJlIHdlIGZhbGxpbmcgYmFjayB0byBmZG1vbi1wb2xsPyAqLwotICAgIHJl
dHVybiBhdG9taWNfcmVhZCgmY3R4LT5leHRlcm5hbF9kaXNhYmxlX2NudCk7CisgICAgcmV0dXJu
IHFlbXVfYXRvbWljX3JlYWQoJmN0eC0+ZXh0ZXJuYWxfZGlzYWJsZV9jbnQpOwogfQogCiBzdGF0
aWMgY29uc3QgRkRNb25PcHMgZmRtb25faW9fdXJpbmdfb3BzID0gewpAQCAtMzQ0LDcgKzM0NSw3
IEBAIHZvaWQgZmRtb25faW9fdXJpbmdfZGVzdHJveShBaW9Db250ZXh0ICpjdHgpCiAKICAgICAg
ICAgLyogTW92ZSBoYW5kbGVycyBkdWUgdG8gYmUgcmVtb3ZlZCBvbnRvIHRoZSBkZWxldGVkIGxp
c3QgKi8KICAgICAgICAgd2hpbGUgKChub2RlID0gUVNMSVNUX0ZJUlNUX1JDVSgmY3R4LT5zdWJt
aXRfbGlzdCkpKSB7Ci0gICAgICAgICAgICB1bnNpZ25lZCBmbGFncyA9IGF0b21pY19mZXRjaF9h
bmQoJm5vZGUtPmZsYWdzLAorICAgICAgICAgICAgdW5zaWduZWQgZmxhZ3MgPSBxZW11X2F0b21p
Y19mZXRjaF9hbmQoJm5vZGUtPmZsYWdzLAogICAgICAgICAgICAgICAgICAgICB+KEZETU9OX0lP
X1VSSU5HX1BFTkRJTkcgfAogICAgICAgICAgICAgICAgICAgICAgIEZETU9OX0lPX1VSSU5HX0FE
RCB8CiAgICAgICAgICAgICAgICAgICAgICAgRkRNT05fSU9fVVJJTkdfUkVNT1ZFKSk7CmRpZmYg
LS1naXQgYS91dGlsL2xvY2tjbnQuYyBiL3V0aWwvbG9ja2NudC5jCmluZGV4IDRmODhkY2Y4Yjgu
Ljg0MWQ5ZGY2OWMgMTAwNjQ0Ci0tLSBhL3V0aWwvbG9ja2NudC5jCisrKyBiL3V0aWwvbG9ja2Nu
dC5jCkBAIC02MSw3ICs2MSw3IEBAIHN0YXRpYyBib29sIHFlbXVfbG9ja2NudF9jbXB4Y2hnX29y
X3dhaXQoUWVtdUxvY2tDbnQgKmxvY2tjbnQsIGludCAqdmFsLAogICAgICAgICBpbnQgZXhwZWN0
ZWQgPSAqdmFsOwogCiAgICAgICAgIHRyYWNlX2xvY2tjbnRfZmFzdF9wYXRoX2F0dGVtcHQobG9j
a2NudCwgZXhwZWN0ZWQsIG5ld19pZl9mcmVlKTsKLSAgICAgICAgKnZhbCA9IGF0b21pY19jbXB4
Y2hnKCZsb2NrY250LT5jb3VudCwgZXhwZWN0ZWQsIG5ld19pZl9mcmVlKTsKKyAgICAgICAgKnZh
bCA9IHFlbXVfYXRvbWljX2NtcHhjaGcoJmxvY2tjbnQtPmNvdW50LCBleHBlY3RlZCwgbmV3X2lm
X2ZyZWUpOwogICAgICAgICBpZiAoKnZhbCA9PSBleHBlY3RlZCkgewogICAgICAgICAgICAgdHJh
Y2VfbG9ja2NudF9mYXN0X3BhdGhfc3VjY2Vzcyhsb2NrY250LCBleHBlY3RlZCwgbmV3X2lmX2Zy
ZWUpOwogICAgICAgICAgICAgKnZhbCA9IG5ld19pZl9mcmVlOwpAQCAtODEsNyArODEsNyBAQCBz
dGF0aWMgYm9vbCBxZW11X2xvY2tjbnRfY21weGNoZ19vcl93YWl0KFFlbXVMb2NrQ250ICpsb2Nr
Y250LCBpbnQgKnZhbCwKICAgICAgICAgICAgIGludCBuZXcgPSBleHBlY3RlZCAtIFFFTVVfTE9D
S0NOVF9TVEFURV9MT0NLRUQgKyBRRU1VX0xPQ0tDTlRfU1RBVEVfV0FJVElORzsKIAogICAgICAg
ICAgICAgdHJhY2VfbG9ja2NudF9mdXRleF93YWl0X3ByZXBhcmUobG9ja2NudCwgZXhwZWN0ZWQs
IG5ldyk7Ci0gICAgICAgICAgICAqdmFsID0gYXRvbWljX2NtcHhjaGcoJmxvY2tjbnQtPmNvdW50
LCBleHBlY3RlZCwgbmV3KTsKKyAgICAgICAgICAgICp2YWwgPSBxZW11X2F0b21pY19jbXB4Y2hn
KCZsb2NrY250LT5jb3VudCwgZXhwZWN0ZWQsIG5ldyk7CiAgICAgICAgICAgICBpZiAoKnZhbCA9
PSBleHBlY3RlZCkgewogICAgICAgICAgICAgICAgICp2YWwgPSBuZXc7CiAgICAgICAgICAgICB9
CkBAIC05Miw3ICs5Miw3IEBAIHN0YXRpYyBib29sIHFlbXVfbG9ja2NudF9jbXB4Y2hnX29yX3dh
aXQoUWVtdUxvY2tDbnQgKmxvY2tjbnQsIGludCAqdmFsLAogICAgICAgICAgICAgKndhaXRlZCA9
IHRydWU7CiAgICAgICAgICAgICB0cmFjZV9sb2NrY250X2Z1dGV4X3dhaXQobG9ja2NudCwgKnZh
bCk7CiAgICAgICAgICAgICBxZW11X2Z1dGV4X3dhaXQoJmxvY2tjbnQtPmNvdW50LCAqdmFsKTsK
LSAgICAgICAgICAgICp2YWwgPSBhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOworICAgICAg
ICAgICAgKnZhbCA9IHFlbXVfYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKICAgICAgICAg
ICAgIHRyYWNlX2xvY2tjbnRfZnV0ZXhfd2FpdF9yZXN1bWUobG9ja2NudCwgKnZhbCk7CiAgICAg
ICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQpAQCAtMTEwLDE5ICsxMTAsMjIgQEAgc3RhdGlj
IHZvaWQgbG9ja2NudF93YWtlKFFlbXVMb2NrQ250ICpsb2NrY250KQogCiB2b2lkIHFlbXVfbG9j
a2NudF9pbmMoUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7Ci0gICAgaW50IHZhbCA9IGF0b21pY19y
ZWFkKCZsb2NrY250LT5jb3VudCk7CisgICAgaW50IHZhbCA9IHFlbXVfYXRvbWljX3JlYWQoJmxv
Y2tjbnQtPmNvdW50KTsKICAgICBib29sIHdhaXRlZCA9IGZhbHNlOwogCiAgICAgZm9yICg7Oykg
ewogICAgICAgICBpZiAodmFsID49IFFFTVVfTE9DS0NOVF9DT1VOVF9TVEVQKSB7CiAgICAgICAg
ICAgICBpbnQgZXhwZWN0ZWQgPSB2YWw7Ci0gICAgICAgICAgICB2YWwgPSBhdG9taWNfY21weGNo
ZygmbG9ja2NudC0+Y291bnQsIHZhbCwgdmFsICsgUUVNVV9MT0NLQ05UX0NPVU5UX1NURVApOwor
ICAgICAgICAgICAgdmFsID0gcWVtdV9hdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZh
bCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsICsgUUVNVV9MT0NL
Q05UX0NPVU5UX1NURVApOwogICAgICAgICAgICAgaWYgKHZhbCA9PSBleHBlY3RlZCkgewogICAg
ICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgfQogICAgICAgICB9IGVsc2UgewogICAg
ICAgICAgICAgLyogVGhlIGZhc3QgcGF0aCBpcyAoMCwgdW5sb2NrZWQpLT4oMSwgdW5sb2NrZWQp
LiAgKi8KLSAgICAgICAgICAgIGlmIChxZW11X2xvY2tjbnRfY21weGNoZ19vcl93YWl0KGxvY2tj
bnQsICZ2YWwsIFFFTVVfTE9DS0NOVF9DT1VOVF9TVEVQLAorICAgICAgICAgICAgaWYgKHFlbXVf
bG9ja2NudF9jbXB4Y2hnX29yX3dhaXQobG9ja2NudCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICZ2YWwsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBRRU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZ3YWl0ZWQpKSB7CiAgICAgICAgICAgICAg
ICAgYnJlYWs7CiAgICAgICAgICAgICB9CkBAIC0xNDIsNyArMTQ1LDcgQEAgdm9pZCBxZW11X2xv
Y2tjbnRfaW5jKFFlbXVMb2NrQ250ICpsb2NrY250KQogCiB2b2lkIHFlbXVfbG9ja2NudF9kZWMo
UWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7Ci0gICAgYXRvbWljX3N1YigmbG9ja2NudC0+Y291bnQs
IFFFTVVfTE9DS0NOVF9DT1VOVF9TVEVQKTsKKyAgICBxZW11X2F0b21pY19zdWIoJmxvY2tjbnQt
PmNvdW50LCBRRU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCk7CiB9CiAKIC8qIERlY3JlbWVudCBhIGNv
dW50ZXIsIGFuZCByZXR1cm4gbG9ja2VkIGlmIGl0IGlzIGRlY3JlbWVudGVkIHRvIHplcm8uCkBA
IC0xNTEsMTQgKzE1NCwxNSBAQCB2b2lkIHFlbXVfbG9ja2NudF9kZWMoUWVtdUxvY2tDbnQgKmxv
Y2tjbnQpCiAgKi8KIGJvb2wgcWVtdV9sb2NrY250X2RlY19hbmRfbG9jayhRZW11TG9ja0NudCAq
bG9ja2NudCkKIHsKLSAgICBpbnQgdmFsID0gYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsK
KyAgICBpbnQgdmFsID0gcWVtdV9hdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOwogICAgIGlu
dCBsb2NrZWRfc3RhdGUgPSBRRU1VX0xPQ0tDTlRfU1RBVEVfTE9DS0VEOwogICAgIGJvb2wgd2Fp
dGVkID0gZmFsc2U7CiAKICAgICBmb3IgKDs7KSB7CiAgICAgICAgIGlmICh2YWwgPj0gMiAqIFFF
TVVfTE9DS0NOVF9DT1VOVF9TVEVQKSB7CiAgICAgICAgICAgICBpbnQgZXhwZWN0ZWQgPSB2YWw7
Ci0gICAgICAgICAgICB2YWwgPSBhdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZhbCwg
dmFsIC0gUUVNVV9MT0NLQ05UX0NPVU5UX1NURVApOworICAgICAgICAgICAgdmFsID0gcWVtdV9h
dG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZhbCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdmFsIC0gUUVNVV9MT0NLQ05UX0NPVU5UX1NURVApOwogICAgICAg
ICAgICAgaWYgKHZhbCA9PSBleHBlY3RlZCkgewogICAgICAgICAgICAgICAgIGJyZWFrOwogICAg
ICAgICAgICAgfQpAQCAtMTY2LDcgKzE3MCw4IEBAIGJvb2wgcWVtdV9sb2NrY250X2RlY19hbmRf
bG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKICAgICAgICAgICAgIC8qIElmIGNvdW50IGlzIGdv
aW5nIDEtPjAsIHRha2UgdGhlIGxvY2suIFRoZSBmYXN0IHBhdGggaXMKICAgICAgICAgICAgICAq
ICgxLCB1bmxvY2tlZCktPigwLCBsb2NrZWQpIG9yICgxLCB1bmxvY2tlZCktPigwLCB3YWl0aW5n
KS4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgaWYgKHFlbXVfbG9ja2NudF9jbXB4Y2hn
X29yX3dhaXQobG9ja2NudCwgJnZhbCwgbG9ja2VkX3N0YXRlLCAmd2FpdGVkKSkgeworICAgICAg
ICAgICAgaWYgKHFlbXVfbG9ja2NudF9jbXB4Y2hnX29yX3dhaXQobG9ja2NudCwgJnZhbCwgbG9j
a2VkX3N0YXRlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JndhaXRlZCkpIHsKICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgIH0K
IApAQCAtMTk5LDcgKzIwNCw3IEBAIGJvb2wgcWVtdV9sb2NrY250X2RlY19hbmRfbG9jayhRZW11
TG9ja0NudCAqbG9ja2NudCkKICAqLwogYm9vbCBxZW11X2xvY2tjbnRfZGVjX2lmX2xvY2soUWVt
dUxvY2tDbnQgKmxvY2tjbnQpCiB7Ci0gICAgaW50IHZhbCA9IGF0b21pY19yZWFkKCZsb2NrY250
LT5jb3VudCk7CisgICAgaW50IHZhbCA9IHFlbXVfYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50
KTsKICAgICBpbnQgbG9ja2VkX3N0YXRlID0gUUVNVV9MT0NLQ05UX1NUQVRFX0xPQ0tFRDsKICAg
ICBib29sIHdhaXRlZCA9IGZhbHNlOwogCkBAIC0yMzMsNyArMjM4LDcgQEAgYm9vbCBxZW11X2xv
Y2tjbnRfZGVjX2lmX2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAKIHZvaWQgcWVtdV9sb2Nr
Y250X2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7Ci0gICAgaW50IHZhbCA9IGF0b21pY19y
ZWFkKCZsb2NrY250LT5jb3VudCk7CisgICAgaW50IHZhbCA9IHFlbXVfYXRvbWljX3JlYWQoJmxv
Y2tjbnQtPmNvdW50KTsKICAgICBpbnQgc3RlcCA9IFFFTVVfTE9DS0NOVF9TVEFURV9MT0NLRUQ7
CiAgICAgYm9vbCB3YWl0ZWQgPSBmYWxzZTsKIApAQCAtMjU1LDEyICsyNjAsMTIgQEAgdm9pZCBx
ZW11X2xvY2tjbnRfaW5jX2FuZF91bmxvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7CiAgICAg
aW50IGV4cGVjdGVkLCBuZXcsIHZhbDsKIAotICAgIHZhbCA9IGF0b21pY19yZWFkKCZsb2NrY250
LT5jb3VudCk7CisgICAgdmFsID0gcWVtdV9hdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOwog
ICAgIGRvIHsKICAgICAgICAgZXhwZWN0ZWQgPSB2YWw7CiAgICAgICAgIG5ldyA9ICh2YWwgKyBR
RU1VX0xPQ0tDTlRfQ09VTlRfU1RFUCkgJiB+UUVNVV9MT0NLQ05UX1NUQVRFX01BU0s7CiAgICAg
ICAgIHRyYWNlX2xvY2tjbnRfdW5sb2NrX2F0dGVtcHQobG9ja2NudCwgdmFsLCBuZXcpOwotICAg
ICAgICB2YWwgPSBhdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZhbCwgbmV3KTsKKyAg
ICAgICAgdmFsID0gcWVtdV9hdG9taWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZhbCwgbmV3
KTsKICAgICB9IHdoaWxlICh2YWwgIT0gZXhwZWN0ZWQpOwogCiAgICAgdHJhY2VfbG9ja2NudF91
bmxvY2tfc3VjY2Vzcyhsb2NrY250LCB2YWwsIG5ldyk7CkBAIC0yNzMsMTIgKzI3OCwxMiBAQCB2
b2lkIHFlbXVfbG9ja2NudF91bmxvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7CiAgICAgaW50
IGV4cGVjdGVkLCBuZXcsIHZhbDsKIAotICAgIHZhbCA9IGF0b21pY19yZWFkKCZsb2NrY250LT5j
b3VudCk7CisgICAgdmFsID0gcWVtdV9hdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOwogICAg
IGRvIHsKICAgICAgICAgZXhwZWN0ZWQgPSB2YWw7CiAgICAgICAgIG5ldyA9IHZhbCAmIH5RRU1V
X0xPQ0tDTlRfU1RBVEVfTUFTSzsKICAgICAgICAgdHJhY2VfbG9ja2NudF91bmxvY2tfYXR0ZW1w
dChsb2NrY250LCB2YWwsIG5ldyk7Ci0gICAgICAgIHZhbCA9IGF0b21pY19jbXB4Y2hnKCZsb2Nr
Y250LT5jb3VudCwgdmFsLCBuZXcpOworICAgICAgICB2YWwgPSBxZW11X2F0b21pY19jbXB4Y2hn
KCZsb2NrY250LT5jb3VudCwgdmFsLCBuZXcpOwogICAgIH0gd2hpbGUgKHZhbCAhPSBleHBlY3Rl
ZCk7CiAKICAgICB0cmFjZV9sb2NrY250X3VubG9ja19zdWNjZXNzKGxvY2tjbnQsIHZhbCwgbmV3
KTsKQEAgLTI4OSw3ICsyOTQsNyBAQCB2b2lkIHFlbXVfbG9ja2NudF91bmxvY2soUWVtdUxvY2tD
bnQgKmxvY2tjbnQpCiAKIHVuc2lnbmVkIHFlbXVfbG9ja2NudF9jb3VudChRZW11TG9ja0NudCAq
bG9ja2NudCkKIHsKLSAgICByZXR1cm4gYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KSA+PiBR
RU1VX0xPQ0tDTlRfQ09VTlRfU0hJRlQ7CisgICAgcmV0dXJuIHFlbXVfYXRvbWljX3JlYWQoJmxv
Y2tjbnQtPmNvdW50KSA+PiBRRU1VX0xPQ0tDTlRfQ09VTlRfU0hJRlQ7CiB9CiAjZWxzZQogdm9p
ZCBxZW11X2xvY2tjbnRfaW5pdChRZW11TG9ja0NudCAqbG9ja2NudCkKQEAgLTMwNywxMyArMzEy
LDEzIEBAIHZvaWQgcWVtdV9sb2NrY250X2luYyhRZW11TG9ja0NudCAqbG9ja2NudCkKIHsKICAg
ICBpbnQgb2xkOwogICAgIGZvciAoOzspIHsKLSAgICAgICAgb2xkID0gYXRvbWljX3JlYWQoJmxv
Y2tjbnQtPmNvdW50KTsKKyAgICAgICAgb2xkID0gcWVtdV9hdG9taWNfcmVhZCgmbG9ja2NudC0+
Y291bnQpOwogICAgICAgICBpZiAob2xkID09IDApIHsKICAgICAgICAgICAgIHFlbXVfbG9ja2Nu
dF9sb2NrKGxvY2tjbnQpOwogICAgICAgICAgICAgcWVtdV9sb2NrY250X2luY19hbmRfdW5sb2Nr
KGxvY2tjbnQpOwogICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICB9IGVsc2UgewotICAgICAg
ICAgICAgaWYgKGF0b21pY19jbXB4Y2hnKCZsb2NrY250LT5jb3VudCwgb2xkLCBvbGQgKyAxKSA9
PSBvbGQpIHsKKyAgICAgICAgICAgIGlmIChxZW11X2F0b21pY19jbXB4Y2hnKCZsb2NrY250LT5j
b3VudCwgb2xkLCBvbGQgKyAxKSA9PSBvbGQpIHsKICAgICAgICAgICAgICAgICByZXR1cm47CiAg
ICAgICAgICAgICB9CiAgICAgICAgIH0KQEAgLTMyMiw3ICszMjcsNyBAQCB2b2lkIHFlbXVfbG9j
a2NudF9pbmMoUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAKIHZvaWQgcWVtdV9sb2NrY250X2RlYyhR
ZW11TG9ja0NudCAqbG9ja2NudCkKIHsKLSAgICBhdG9taWNfZGVjKCZsb2NrY250LT5jb3VudCk7
CisgICAgcWVtdV9hdG9taWNfZGVjKCZsb2NrY250LT5jb3VudCk7CiB9CiAKIC8qIERlY3JlbWVu
dCBhIGNvdW50ZXIsIGFuZCByZXR1cm4gbG9ja2VkIGlmIGl0IGlzIGRlY3JlbWVudGVkIHRvIHpl
cm8uCkBAIC0zMzEsOSArMzM2LDkgQEAgdm9pZCBxZW11X2xvY2tjbnRfZGVjKFFlbXVMb2NrQ250
ICpsb2NrY250KQogICovCiBib29sIHFlbXVfbG9ja2NudF9kZWNfYW5kX2xvY2soUWVtdUxvY2tD
bnQgKmxvY2tjbnQpCiB7Ci0gICAgaW50IHZhbCA9IGF0b21pY19yZWFkKCZsb2NrY250LT5jb3Vu
dCk7CisgICAgaW50IHZhbCA9IHFlbXVfYXRvbWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKICAg
ICB3aGlsZSAodmFsID4gMSkgewotICAgICAgICBpbnQgb2xkID0gYXRvbWljX2NtcHhjaGcoJmxv
Y2tjbnQtPmNvdW50LCB2YWwsIHZhbCAtIDEpOworICAgICAgICBpbnQgb2xkID0gcWVtdV9hdG9t
aWNfY21weGNoZygmbG9ja2NudC0+Y291bnQsIHZhbCwgdmFsIC0gMSk7CiAgICAgICAgIGlmIChv
bGQgIT0gdmFsKSB7CiAgICAgICAgICAgICB2YWwgPSBvbGQ7CiAgICAgICAgICAgICBjb250aW51
ZTsKQEAgLTM0Myw3ICszNDgsNyBAQCBib29sIHFlbXVfbG9ja2NudF9kZWNfYW5kX2xvY2soUWVt
dUxvY2tDbnQgKmxvY2tjbnQpCiAgICAgfQogCiAgICAgcWVtdV9sb2NrY250X2xvY2sobG9ja2Nu
dCk7Ci0gICAgaWYgKGF0b21pY19mZXRjaF9kZWMoJmxvY2tjbnQtPmNvdW50KSA9PSAxKSB7Cisg
ICAgaWYgKHFlbXVfYXRvbWljX2ZldGNoX2RlYygmbG9ja2NudC0+Y291bnQpID09IDEpIHsKICAg
ICAgICAgcmV0dXJuIHRydWU7CiAgICAgfQogCkBAIC0zNjAsMTMgKzM2NSwxMyBAQCBib29sIHFl
bXVfbG9ja2NudF9kZWNfYW5kX2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiBib29sIHFlbXVf
bG9ja2NudF9kZWNfaWZfbG9jayhRZW11TG9ja0NudCAqbG9ja2NudCkKIHsKICAgICAvKiBObyBu
ZWVkIGZvciBhY3F1aXJlIHNlbWFudGljcyBpZiB3ZSByZXR1cm4gZmFsc2UuICAqLwotICAgIGlu
dCB2YWwgPSBhdG9taWNfcmVhZCgmbG9ja2NudC0+Y291bnQpOworICAgIGludCB2YWwgPSBxZW11
X2F0b21pY19yZWFkKCZsb2NrY250LT5jb3VudCk7CiAgICAgaWYgKHZhbCA+IDEpIHsKICAgICAg
ICAgcmV0dXJuIGZhbHNlOwogICAgIH0KIAogICAgIHFlbXVfbG9ja2NudF9sb2NrKGxvY2tjbnQp
OwotICAgIGlmIChhdG9taWNfZmV0Y2hfZGVjKCZsb2NrY250LT5jb3VudCkgPT0gMSkgeworICAg
IGlmIChxZW11X2F0b21pY19mZXRjaF9kZWMoJmxvY2tjbnQtPmNvdW50KSA9PSAxKSB7CiAgICAg
ICAgIHJldHVybiB0cnVlOwogICAgIH0KIApAQCAtMzgxLDcgKzM4Niw3IEBAIHZvaWQgcWVtdV9s
b2NrY250X2xvY2soUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiAKIHZvaWQgcWVtdV9sb2NrY250X2lu
Y19hbmRfdW5sb2NrKFFlbXVMb2NrQ250ICpsb2NrY250KQogewotICAgIGF0b21pY19pbmMoJmxv
Y2tjbnQtPmNvdW50KTsKKyAgICBxZW11X2F0b21pY19pbmMoJmxvY2tjbnQtPmNvdW50KTsKICAg
ICBxZW11X211dGV4X3VubG9jaygmbG9ja2NudC0+bXV0ZXgpOwogfQogCkBAIC0zOTIsNiArMzk3
LDYgQEAgdm9pZCBxZW11X2xvY2tjbnRfdW5sb2NrKFFlbXVMb2NrQ250ICpsb2NrY250KQogCiB1
bnNpZ25lZCBxZW11X2xvY2tjbnRfY291bnQoUWVtdUxvY2tDbnQgKmxvY2tjbnQpCiB7Ci0gICAg
cmV0dXJuIGF0b21pY19yZWFkKCZsb2NrY250LT5jb3VudCk7CisgICAgcmV0dXJuIHFlbXVfYXRv
bWljX3JlYWQoJmxvY2tjbnQtPmNvdW50KTsKIH0KICNlbmRpZgpkaWZmIC0tZ2l0IGEvdXRpbC9s
b2cuYyBiL3V0aWwvbG9nLmMKaW5kZXggYmRiM2Q3MTJlOC4uZTJhOGViNGZlZCAxMDA2NDQKLS0t
IGEvdXRpbC9sb2cuYworKysgYi91dGlsL2xvZy5jCkBAIC00MSw3ICs0MSw3IEBAIGludCBxZW11
X2xvZyhjb25zdCBjaGFyICpmbXQsIC4uLikKICAgICBRZW11TG9nRmlsZSAqbG9nZmlsZTsKIAog
ICAgIHJjdV9yZWFkX2xvY2soKTsKLSAgICBsb2dmaWxlID0gYXRvbWljX3JjdV9yZWFkKCZxZW11
X2xvZ2ZpbGUpOworICAgIGxvZ2ZpbGUgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dm
aWxlKTsKICAgICBpZiAobG9nZmlsZSkgewogICAgICAgICB2YV9saXN0IGFwOwogICAgICAgICB2
YV9zdGFydChhcCwgZm10KTsKQEAgLTk4LDcgKzk4LDcgQEAgdm9pZCBxZW11X3NldF9sb2coaW50
IGxvZ19mbGFncykKICAgICBRRU1VX0xPQ0tfR1VBUkQoJnFlbXVfbG9nZmlsZV9tdXRleCk7CiAg
ICAgaWYgKHFlbXVfbG9nZmlsZSAmJiAhbmVlZF90b19vcGVuX2ZpbGUpIHsKICAgICAgICAgbG9n
ZmlsZSA9IHFlbXVfbG9nZmlsZTsKLSAgICAgICAgYXRvbWljX3JjdV9zZXQoJnFlbXVfbG9nZmls
ZSwgTlVMTCk7CisgICAgICAgIHFlbXVfYXRvbWljX3JjdV9zZXQoJnFlbXVfbG9nZmlsZSwgTlVM
TCk7CiAgICAgICAgIGNhbGxfcmN1KGxvZ2ZpbGUsIHFlbXVfbG9nZmlsZV9mcmVlLCByY3UpOwog
ICAgIH0gZWxzZSBpZiAoIXFlbXVfbG9nZmlsZSAmJiBuZWVkX3RvX29wZW5fZmlsZSkgewogICAg
ICAgICBsb2dmaWxlID0gZ19uZXcwKFFlbXVMb2dGaWxlLCAxKTsKQEAgLTEzNSw3ICsxMzUsNyBA
QCB2b2lkIHFlbXVfc2V0X2xvZyhpbnQgbG9nX2ZsYWdzKQogI2VuZGlmCiAgICAgICAgICAgICBs
b2dfYXBwZW5kID0gMTsKICAgICAgICAgfQotICAgICAgICBhdG9taWNfcmN1X3NldCgmcWVtdV9s
b2dmaWxlLCBsb2dmaWxlKTsKKyAgICAgICAgcWVtdV9hdG9taWNfcmN1X3NldCgmcWVtdV9sb2dm
aWxlLCBsb2dmaWxlKTsKICAgICB9CiB9CiAKQEAgLTI3Miw3ICsyNzIsNyBAQCB2b2lkIHFlbXVf
bG9nX2ZsdXNoKHZvaWQpCiAgICAgUWVtdUxvZ0ZpbGUgKmxvZ2ZpbGU7CiAKICAgICByY3VfcmVh
ZF9sb2NrKCk7Ci0gICAgbG9nZmlsZSA9IGF0b21pY19yY3VfcmVhZCgmcWVtdV9sb2dmaWxlKTsK
KyAgICBsb2dmaWxlID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJnFlbXVfbG9nZmlsZSk7CiAgICAg
aWYgKGxvZ2ZpbGUpIHsKICAgICAgICAgZmZsdXNoKGxvZ2ZpbGUtPmZkKTsKICAgICB9CkBAIC0y
ODgsNyArMjg4LDcgQEAgdm9pZCBxZW11X2xvZ19jbG9zZSh2b2lkKQogICAgIGxvZ2ZpbGUgPSBx
ZW11X2xvZ2ZpbGU7CiAKICAgICBpZiAobG9nZmlsZSkgewotICAgICAgICBhdG9taWNfcmN1X3Nl
dCgmcWVtdV9sb2dmaWxlLCBOVUxMKTsKKyAgICAgICAgcWVtdV9hdG9taWNfcmN1X3NldCgmcWVt
dV9sb2dmaWxlLCBOVUxMKTsKICAgICAgICAgY2FsbF9yY3UobG9nZmlsZSwgcWVtdV9sb2dmaWxl
X2ZyZWUsIHJjdSk7CiAgICAgfQogICAgIHFlbXVfbXV0ZXhfdW5sb2NrKCZxZW11X2xvZ2ZpbGVf
bXV0ZXgpOwpkaWZmIC0tZ2l0IGEvdXRpbC9xZW11LWNvcm91dGluZS1sb2NrLmMgYi91dGlsL3Fl
bXUtY29yb3V0aW5lLWxvY2suYwppbmRleCA1ZGE1MjM0MTU1Li45NDJmNWM0M2YyIDEwMDY0NAot
LS0gYS91dGlsL3FlbXUtY29yb3V0aW5lLWxvY2suYworKysgYi91dGlsL3FlbXUtY29yb3V0aW5l
LWxvY2suYwpAQCAtMjEyLDEwICsyMTIsMTAgQEAgc3RhdGljIHZvaWQgY29yb3V0aW5lX2ZuIHFl
bXVfY29fbXV0ZXhfbG9ja19zbG93cGF0aChBaW9Db250ZXh0ICpjdHgsCiAgICAgLyogVGhpcyBp
cyB0aGUgIlJlc3BvbnNpYmlsaXR5IEhhbmQtT2ZmIiBwcm90b2NvbDsgYSBsb2NrKCkgcGlja3Mg
ZnJvbQogICAgICAqIGEgY29uY3VycmVudCB1bmxvY2soKSB0aGUgcmVzcG9uc2liaWxpdHkgb2Yg
d2FraW5nIHNvbWVib2R5IHVwLgogICAgICAqLwotICAgIG9sZF9oYW5kb2ZmID0gYXRvbWljX21i
X3JlYWQoJm11dGV4LT5oYW5kb2ZmKTsKKyAgICBvbGRfaGFuZG9mZiA9IHFlbXVfYXRvbWljX21i
X3JlYWQoJm11dGV4LT5oYW5kb2ZmKTsKICAgICBpZiAob2xkX2hhbmRvZmYgJiYKICAgICAgICAg
aGFzX3dhaXRlcnMobXV0ZXgpICYmCi0gICAgICAgIGF0b21pY19jbXB4Y2hnKCZtdXRleC0+aGFu
ZG9mZiwgb2xkX2hhbmRvZmYsIDApID09IG9sZF9oYW5kb2ZmKSB7CisgICAgICAgIHFlbXVfYXRv
bWljX2NtcHhjaGcoJm11dGV4LT5oYW5kb2ZmLCBvbGRfaGFuZG9mZiwgMCkgPT0gb2xkX2hhbmRv
ZmYpIHsKICAgICAgICAgLyogVGhlcmUgY2FuIGJlIG5vIGNvbmN1cnJlbnQgcG9wcywgYmVjYXVz
ZSB0aGVyZSBjYW4gYmUgb25seQogICAgICAgICAgKiBvbmUgYWN0aXZlIGhhbmRvZmYgYXQgYSB0
aW1lLgogICAgICAgICAgKi8KQEAgLTI1MCwxOCArMjUwLDE4IEBAIHZvaWQgY29yb3V0aW5lX2Zu
IHFlbXVfY29fbXV0ZXhfbG9jayhDb011dGV4ICptdXRleCkKICAgICAgKi8KICAgICBpID0gMDsK
IHJldHJ5X2Zhc3RfcGF0aDoKLSAgICB3YWl0ZXJzID0gYXRvbWljX2NtcHhjaGcoJm11dGV4LT5s
b2NrZWQsIDAsIDEpOworICAgIHdhaXRlcnMgPSBxZW11X2F0b21pY19jbXB4Y2hnKCZtdXRleC0+
bG9ja2VkLCAwLCAxKTsKICAgICBpZiAod2FpdGVycyAhPSAwKSB7CiAgICAgICAgIHdoaWxlICh3
YWl0ZXJzID09IDEgJiYgKytpIDwgMTAwMCkgewotICAgICAgICAgICAgaWYgKGF0b21pY19yZWFk
KCZtdXRleC0+Y3R4KSA9PSBjdHgpIHsKKyAgICAgICAgICAgIGlmIChxZW11X2F0b21pY19yZWFk
KCZtdXRleC0+Y3R4KSA9PSBjdHgpIHsKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
ICAgIH0KLSAgICAgICAgICAgIGlmIChhdG9taWNfcmVhZCgmbXV0ZXgtPmxvY2tlZCkgPT0gMCkg
eworICAgICAgICAgICAgaWYgKHFlbXVfYXRvbWljX3JlYWQoJm11dGV4LT5sb2NrZWQpID09IDAp
IHsKICAgICAgICAgICAgICAgICBnb3RvIHJldHJ5X2Zhc3RfcGF0aDsKICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgIGNwdV9yZWxheCgpOwogICAgICAgICB9Ci0gICAgICAgIHdhaXRlcnMgPSBh
dG9taWNfZmV0Y2hfaW5jKCZtdXRleC0+bG9ja2VkKTsKKyAgICAgICAgd2FpdGVycyA9IHFlbXVf
YXRvbWljX2ZldGNoX2luYygmbXV0ZXgtPmxvY2tlZCk7CiAgICAgfQogCiAgICAgaWYgKHdhaXRl
cnMgPT0gMCkgewpAQCAtMjg4LDcgKzI4OCw3IEBAIHZvaWQgY29yb3V0aW5lX2ZuIHFlbXVfY29f
bXV0ZXhfdW5sb2NrKENvTXV0ZXggKm11dGV4KQogICAgIG11dGV4LT5jdHggPSBOVUxMOwogICAg
IG11dGV4LT5ob2xkZXIgPSBOVUxMOwogICAgIHNlbGYtPmxvY2tzX2hlbGQtLTsKLSAgICBpZiAo
YXRvbWljX2ZldGNoX2RlYygmbXV0ZXgtPmxvY2tlZCkgPT0gMSkgeworICAgIGlmIChxZW11X2F0
b21pY19mZXRjaF9kZWMoJm11dGV4LT5sb2NrZWQpID09IDEpIHsKICAgICAgICAgLyogTm8gd2Fp
dGluZyBxZW11X2NvX211dGV4X2xvY2soKS4gIFBmZXcsIHRoYXQgd2FzIGVhc3khICAqLwogICAg
ICAgICByZXR1cm47CiAgICAgfQpAQCAtMzExLDcgKzMxMSw3IEBAIHZvaWQgY29yb3V0aW5lX2Zu
IHFlbXVfY29fbXV0ZXhfdW5sb2NrKENvTXV0ZXggKm11dGV4KQogICAgICAgICB9CiAKICAgICAg
ICAgb3VyX2hhbmRvZmYgPSBtdXRleC0+c2VxdWVuY2U7Ci0gICAgICAgIGF0b21pY19tYl9zZXQo
Jm11dGV4LT5oYW5kb2ZmLCBvdXJfaGFuZG9mZik7CisgICAgICAgIHFlbXVfYXRvbWljX21iX3Nl
dCgmbXV0ZXgtPmhhbmRvZmYsIG91cl9oYW5kb2ZmKTsKICAgICAgICAgaWYgKCFoYXNfd2FpdGVy
cyhtdXRleCkpIHsKICAgICAgICAgICAgIC8qIFRoZSBjb25jdXJyZW50IGxvY2sgaGFzIG5vdCBh
ZGRlZCBpdHNlbGYgeWV0LCBzbyBpdAogICAgICAgICAgICAgICogd2lsbCBiZSBhYmxlIHRvIHBp
Y2sgb3VyIGhhbmRvZmYuCkBAIC0zMjIsNyArMzIyLDggQEAgdm9pZCBjb3JvdXRpbmVfZm4gcWVt
dV9jb19tdXRleF91bmxvY2soQ29NdXRleCAqbXV0ZXgpCiAgICAgICAgIC8qIFRyeSB0byBkbyB0
aGUgaGFuZG9mZiBwcm90b2NvbCBvdXJzZWx2ZXM7IGlmIHNvbWVib2R5IGVsc2UgaGFzCiAgICAg
ICAgICAqIGFscmVhZHkgdGFrZW4gaXQsIGhvd2V2ZXIsIHdlJ3JlIGRvbmUgYW5kIHRoZXkncmUg
cmVzcG9uc2libGUuCiAgICAgICAgICAqLwotICAgICAgICBpZiAoYXRvbWljX2NtcHhjaGcoJm11
dGV4LT5oYW5kb2ZmLCBvdXJfaGFuZG9mZiwgMCkgIT0gb3VyX2hhbmRvZmYpIHsKKyAgICAgICAg
aWYgKHFlbXVfYXRvbWljX2NtcHhjaGcoJm11dGV4LT5oYW5kb2ZmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBvdXJfaGFuZG9mZiwgMCkgIT0gb3VyX2hhbmRvZmYpIHsKICAgICAg
ICAgICAgIGJyZWFrOwogICAgICAgICB9CiAgICAgfQpkaWZmIC0tZ2l0IGEvdXRpbC9xZW11LWNv
cm91dGluZS1zbGVlcC5jIGIvdXRpbC9xZW11LWNvcm91dGluZS1zbGVlcC5jCmluZGV4IDc2OWE3
NmU1N2QuLjlhODFhN2Q2ZWUgMTAwNjQ0Ci0tLSBhL3V0aWwvcWVtdS1jb3JvdXRpbmUtc2xlZXAu
YworKysgYi91dGlsL3FlbXUtY29yb3V0aW5lLXNsZWVwLmMKQEAgLTI4LDcgKzI4LDcgQEAgc3Ry
dWN0IFFlbXVDb1NsZWVwU3RhdGUgewogdm9pZCBxZW11X2NvX3NsZWVwX3dha2UoUWVtdUNvU2xl
ZXBTdGF0ZSAqc2xlZXBfc3RhdGUpCiB7CiAgICAgLyogV3JpdGUgb2Ygc2NoZWR1bGUgcHJvdGVj
dGVkIGJ5IGJhcnJpZXIgd3JpdGUgaW4gYWlvX2NvX3NjaGVkdWxlICovCi0gICAgY29uc3QgY2hh
ciAqc2NoZWR1bGVkID0gYXRvbWljX2NtcHhjaGcoJnNsZWVwX3N0YXRlLT5jby0+c2NoZWR1bGVk
LAorICAgIGNvbnN0IGNoYXIgKnNjaGVkdWxlZCA9IHFlbXVfYXRvbWljX2NtcHhjaGcoJnNsZWVw
X3N0YXRlLT5jby0+c2NoZWR1bGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHFlbXVfY29fc2xlZXBfbnNfX3NjaGVkdWxlZCwgTlVMTCk7CiAKICAgICBhc3Nl
cnQoc2NoZWR1bGVkID09IHFlbXVfY29fc2xlZXBfbnNfX3NjaGVkdWxlZCk7CkBAIC01NCw3ICs1
NCw3IEBAIHZvaWQgY29yb3V0aW5lX2ZuIHFlbXVfY29fc2xlZXBfbnNfd2FrZWFibGUoUUVNVUNs
b2NrVHlwZSB0eXBlLCBpbnQ2NF90IG5zLAogICAgICAgICAudXNlcl9zdGF0ZV9wb2ludGVyID0g
c2xlZXBfc3RhdGUsCiAgICAgfTsKIAotICAgIGNvbnN0IGNoYXIgKnNjaGVkdWxlZCA9IGF0b21p
Y19jbXB4Y2hnKCZzdGF0ZS5jby0+c2NoZWR1bGVkLCBOVUxMLAorICAgIGNvbnN0IGNoYXIgKnNj
aGVkdWxlZCA9IHFlbXVfYXRvbWljX2NtcHhjaGcoJnN0YXRlLmNvLT5zY2hlZHVsZWQsIE5VTEws
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWVtdV9jb19zbGVl
cF9uc19fc2NoZWR1bGVkKTsKICAgICBpZiAoc2NoZWR1bGVkKSB7CiAgICAgICAgIGZwcmludGYo
c3RkZXJyLApkaWZmIC0tZ2l0IGEvdXRpbC9xZW11LWNvcm91dGluZS5jIGIvdXRpbC9xZW11LWNv
cm91dGluZS5jCmluZGV4IGMzY2FhNmM3NzAuLmFkMjg2MDNhNzEgMTAwNjQ0Ci0tLSBhL3V0aWwv
cWVtdS1jb3JvdXRpbmUuYworKysgYi91dGlsL3FlbXUtY29yb3V0aW5lLmMKQEAgLTYwLDcgKzYw
LDcgQEAgQ29yb3V0aW5lICpxZW11X2Nvcm91dGluZV9jcmVhdGUoQ29yb3V0aW5lRW50cnkgKmVu
dHJ5LCB2b2lkICpvcGFxdWUpCiAgICAgICAgICAgICAgICAgICogcmVsZWFzZV9wb29sX3NpemUg
YW5kIHRoZSBhY3R1YWwgc2l6ZSBvZiByZWxlYXNlX3Bvb2wuICBCdXQKICAgICAgICAgICAgICAg
ICAgKiBpdCBpcyBqdXN0IGEgaGV1cmlzdGljLCBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHBlcmZl
Y3QuCiAgICAgICAgICAgICAgICAgICovCi0gICAgICAgICAgICAgICAgYWxsb2NfcG9vbF9zaXpl
ID0gYXRvbWljX3hjaGcoJnJlbGVhc2VfcG9vbF9zaXplLCAwKTsKKyAgICAgICAgICAgICAgICBh
bGxvY19wb29sX3NpemUgPSBxZW11X2F0b21pY194Y2hnKCZyZWxlYXNlX3Bvb2xfc2l6ZSwgMCk7
CiAgICAgICAgICAgICAgICAgUVNMSVNUX01PVkVfQVRPTUlDKCZhbGxvY19wb29sLCAmcmVsZWFz
ZV9wb29sKTsKICAgICAgICAgICAgICAgICBjbyA9IFFTTElTVF9GSVJTVCgmYWxsb2NfcG9vbCk7
CiAgICAgICAgICAgICB9CkBAIC04OCw3ICs4OCw3IEBAIHN0YXRpYyB2b2lkIGNvcm91dGluZV9k
ZWxldGUoQ29yb3V0aW5lICpjbykKICAgICBpZiAoQ09ORklHX0NPUk9VVElORV9QT09MKSB7CiAg
ICAgICAgIGlmIChyZWxlYXNlX3Bvb2xfc2l6ZSA8IFBPT0xfQkFUQ0hfU0laRSAqIDIpIHsKICAg
ICAgICAgICAgIFFTTElTVF9JTlNFUlRfSEVBRF9BVE9NSUMoJnJlbGVhc2VfcG9vbCwgY28sIHBv
b2xfbmV4dCk7Ci0gICAgICAgICAgICBhdG9taWNfaW5jKCZyZWxlYXNlX3Bvb2xfc2l6ZSk7Cisg
ICAgICAgICAgICBxZW11X2F0b21pY19pbmMoJnJlbGVhc2VfcG9vbF9zaXplKTsKICAgICAgICAg
ICAgIHJldHVybjsKICAgICAgICAgfQogICAgICAgICBpZiAoYWxsb2NfcG9vbF9zaXplIDwgUE9P
TF9CQVRDSF9TSVpFKSB7CkBAIC0xMTUsNyArMTE1LDcgQEAgdm9pZCBxZW11X2Fpb19jb3JvdXRp
bmVfZW50ZXIoQWlvQ29udGV4dCAqY3R4LCBDb3JvdXRpbmUgKmNvKQogCiAgICAgICAgIC8qIENh
bm5vdCByZWx5IG9uIHRoZSByZWFkIGJhcnJpZXIgZm9yIHRvIGluIGFpb19jb193YWtlKCksIGFz
IHRoZXJlIGFyZQogICAgICAgICAgKiBjYWxsZXJzIG91dHNpZGUgb2YgYWlvX2NvX3dha2UoKSAq
LwotICAgICAgICBjb25zdCBjaGFyICpzY2hlZHVsZWQgPSBhdG9taWNfbWJfcmVhZCgmdG8tPnNj
aGVkdWxlZCk7CisgICAgICAgIGNvbnN0IGNoYXIgKnNjaGVkdWxlZCA9IHFlbXVfYXRvbWljX21i
X3JlYWQoJnRvLT5zY2hlZHVsZWQpOwogCiAgICAgICAgIFFTSU1QTEVRX1JFTU9WRV9IRUFEKCZw
ZW5kaW5nLCBjb19xdWV1ZV9uZXh0KTsKIApkaWZmIC0tZ2l0IGEvdXRpbC9xZW11LXNvY2tldHMu
YyBiL3V0aWwvcWVtdS1zb2NrZXRzLmMKaW5kZXggYjM3ZDI4ODg2Ni4uMjk0ZWEyMTQ0NiAxMDA2
NDQKLS0tIGEvdXRpbC9xZW11LXNvY2tldHMuYworKysgYi91dGlsL3FlbXUtc29ja2V0cy5jCkBA
IC0zOTUsNyArMzk1LDcgQEAgc3RhdGljIHN0cnVjdCBhZGRyaW5mbyAqaW5ldF9wYXJzZV9jb25u
ZWN0X3NhZGRyKEluZXRTb2NrZXRBZGRyZXNzICpzYWRkciwKICAgICBtZW1zZXQoJmFpLCAwLCBz
aXplb2YoYWkpKTsKIAogICAgIGFpLmFpX2ZsYWdzID0gQUlfQ0FOT05OQU1FIHwgQUlfQUREUkNP
TkZJRzsKLSAgICBpZiAoYXRvbWljX3JlYWQoJnVzZVY0TWFwcGVkKSkgeworICAgIGlmIChxZW11
X2F0b21pY19yZWFkKCZ1c2VWNE1hcHBlZCkpIHsKICAgICAgICAgYWkuYWlfZmxhZ3MgfD0gQUlf
VjRNQVBQRUQ7CiAgICAgfQogICAgIGFpLmFpX2ZhbWlseSA9IGluZXRfYWlfZmFtaWx5X2Zyb21f
YWRkcmVzcyhzYWRkciwgJmVycik7CkBAIC00MjEsNyArNDIxLDcgQEAgc3RhdGljIHN0cnVjdCBh
ZGRyaW5mbyAqaW5ldF9wYXJzZV9jb25uZWN0X3NhZGRyKEluZXRTb2NrZXRBZGRyZXNzICpzYWRk
ciwKICAgICAgKi8KICAgICBpZiAocmMgPT0gRUFJX0JBREZMQUdTICYmCiAgICAgICAgIChhaS5h
aV9mbGFncyAmIEFJX1Y0TUFQUEVEKSkgewotICAgICAgICBhdG9taWNfc2V0KCZ1c2VWNE1hcHBl
ZCwgMCk7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmdXNlVjRNYXBwZWQsIDApOwogICAgICAg
ICBhaS5haV9mbGFncyAmPSB+QUlfVjRNQVBQRUQ7CiAgICAgICAgIHJjID0gZ2V0YWRkcmluZm8o
c2FkZHItPmhvc3QsIHNhZGRyLT5wb3J0LCAmYWksICZyZXMpOwogICAgIH0KZGlmZiAtLWdpdCBh
L3V0aWwvcWVtdS10aHJlYWQtcG9zaXguYyBiL3V0aWwvcWVtdS10aHJlYWQtcG9zaXguYwppbmRl
eCBiNGMyMzU5MjcyLi42NDU3ZmRhMTY1IDEwMDY0NAotLS0gYS91dGlsL3FlbXUtdGhyZWFkLXBv
c2l4LmMKKysrIGIvdXRpbC9xZW11LXRocmVhZC1wb3NpeC5jCkBAIC00MTQsOCArNDE0LDggQEAg
dm9pZCBxZW11X2V2ZW50X3NldChRZW11RXZlbnQgKmV2KQogICAgICAqLwogICAgIGFzc2VydChl
di0+aW5pdGlhbGl6ZWQpOwogICAgIHNtcF9tYigpOwotICAgIGlmIChhdG9taWNfcmVhZCgmZXYt
PnZhbHVlKSAhPSBFVl9TRVQpIHsKLSAgICAgICAgaWYgKGF0b21pY194Y2hnKCZldi0+dmFsdWUs
IEVWX1NFVCkgPT0gRVZfQlVTWSkgeworICAgIGlmIChxZW11X2F0b21pY19yZWFkKCZldi0+dmFs
dWUpICE9IEVWX1NFVCkgeworICAgICAgICBpZiAocWVtdV9hdG9taWNfeGNoZygmZXYtPnZhbHVl
LCBFVl9TRVQpID09IEVWX0JVU1kpIHsKICAgICAgICAgICAgIC8qIFRoZXJlIHdlcmUgd2FpdGVy
cywgd2FrZSB0aGVtIHVwLiAgKi8KICAgICAgICAgICAgIHFlbXVfZnV0ZXhfd2FrZShldiwgSU5U
X01BWCk7CiAgICAgICAgIH0KQEAgLTQyNywxNCArNDI3LDE0IEBAIHZvaWQgcWVtdV9ldmVudF9y
ZXNldChRZW11RXZlbnQgKmV2KQogICAgIHVuc2lnbmVkIHZhbHVlOwogCiAgICAgYXNzZXJ0KGV2
LT5pbml0aWFsaXplZCk7Ci0gICAgdmFsdWUgPSBhdG9taWNfcmVhZCgmZXYtPnZhbHVlKTsKKyAg
ICB2YWx1ZSA9IHFlbXVfYXRvbWljX3JlYWQoJmV2LT52YWx1ZSk7CiAgICAgc21wX21iX2FjcXVp
cmUoKTsKICAgICBpZiAodmFsdWUgPT0gRVZfU0VUKSB7CiAgICAgICAgIC8qCiAgICAgICAgICAq
IElmIHRoZXJlIHdhcyBhIGNvbmN1cnJlbnQgcmVzZXQgKG9yIGV2ZW4gcmVzZXQrd2FpdCksCiAg
ICAgICAgICAqIGRvIG5vdGhpbmcuICBPdGhlcndpc2UgY2hhbmdlIEVWX1NFVC0+RVZfRlJFRS4K
ICAgICAgICAgICovCi0gICAgICAgIGF0b21pY19vcigmZXYtPnZhbHVlLCBFVl9GUkVFKTsKKyAg
ICAgICAgcWVtdV9hdG9taWNfb3IoJmV2LT52YWx1ZSwgRVZfRlJFRSk7CiAgICAgfQogfQogCkBA
IC00NDMsNyArNDQzLDcgQEAgdm9pZCBxZW11X2V2ZW50X3dhaXQoUWVtdUV2ZW50ICpldikKICAg
ICB1bnNpZ25lZCB2YWx1ZTsKIAogICAgIGFzc2VydChldi0+aW5pdGlhbGl6ZWQpOwotICAgIHZh
bHVlID0gYXRvbWljX3JlYWQoJmV2LT52YWx1ZSk7CisgICAgdmFsdWUgPSBxZW11X2F0b21pY19y
ZWFkKCZldi0+dmFsdWUpOwogICAgIHNtcF9tYl9hY3F1aXJlKCk7CiAgICAgaWYgKHZhbHVlICE9
IEVWX1NFVCkgewogICAgICAgICBpZiAodmFsdWUgPT0gRVZfRlJFRSkgewpAQCAtNDUzLDcgKzQ1
Myw3IEBAIHZvaWQgcWVtdV9ldmVudF93YWl0KFFlbXVFdmVudCAqZXYpCiAgICAgICAgICAgICAg
KiBhIGNvbmN1cnJlbnQgYnVzeS0+ZnJlZSB0cmFuc2l0aW9uLiAgQWZ0ZXIgdGhlIENBUywgdGhl
CiAgICAgICAgICAgICAgKiBldmVudCB3aWxsIGJlIGVpdGhlciBzZXQgb3IgYnVzeS4KICAgICAg
ICAgICAgICAqLwotICAgICAgICAgICAgaWYgKGF0b21pY19jbXB4Y2hnKCZldi0+dmFsdWUsIEVW
X0ZSRUUsIEVWX0JVU1kpID09IEVWX1NFVCkgeworICAgICAgICAgICAgaWYgKHFlbXVfYXRvbWlj
X2NtcHhjaGcoJmV2LT52YWx1ZSwgRVZfRlJFRSwgRVZfQlVTWSkgPT0gRVZfU0VUKSB7CiAgICAg
ICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgfQogICAgICAgICB9CmRpZmYgLS1naXQg
YS91dGlsL3FlbXUtdGhyZWFkLXdpbjMyLmMgYi91dGlsL3FlbXUtdGhyZWFkLXdpbjMyLmMKaW5k
ZXggNTZhODMzMzNkYS4uNDA5YjI4ZDIxYiAxMDA2NDQKLS0tIGEvdXRpbC9xZW11LXRocmVhZC13
aW4zMi5jCisrKyBiL3V0aWwvcWVtdS10aHJlYWQtd2luMzIuYwpAQCAtMjUwLDggKzI1MCw4IEBA
IHZvaWQgcWVtdV9ldmVudF9zZXQoUWVtdUV2ZW50ICpldikKICAgICAgKiBldi0+dmFsdWUgd2Ug
bmVlZCBhIGZ1bGwgbWVtb3J5IGJhcnJpZXIgaGVyZS4KICAgICAgKi8KICAgICBzbXBfbWIoKTsK
LSAgICBpZiAoYXRvbWljX3JlYWQoJmV2LT52YWx1ZSkgIT0gRVZfU0VUKSB7Ci0gICAgICAgIGlm
IChhdG9taWNfeGNoZygmZXYtPnZhbHVlLCBFVl9TRVQpID09IEVWX0JVU1kpIHsKKyAgICBpZiAo
cWVtdV9hdG9taWNfcmVhZCgmZXYtPnZhbHVlKSAhPSBFVl9TRVQpIHsKKyAgICAgICAgaWYgKHFl
bXVfYXRvbWljX3hjaGcoJmV2LT52YWx1ZSwgRVZfU0VUKSA9PSBFVl9CVVNZKSB7CiAgICAgICAg
ICAgICAvKiBUaGVyZSB3ZXJlIHdhaXRlcnMsIHdha2UgdGhlbSB1cC4gICovCiAgICAgICAgICAg
ICBTZXRFdmVudChldi0+ZXZlbnQpOwogICAgICAgICB9CkBAIC0yNjMsMTMgKzI2MywxMyBAQCB2
b2lkIHFlbXVfZXZlbnRfcmVzZXQoUWVtdUV2ZW50ICpldikKICAgICB1bnNpZ25lZCB2YWx1ZTsK
IAogICAgIGFzc2VydChldi0+aW5pdGlhbGl6ZWQpOwotICAgIHZhbHVlID0gYXRvbWljX3JlYWQo
JmV2LT52YWx1ZSk7CisgICAgdmFsdWUgPSBxZW11X2F0b21pY19yZWFkKCZldi0+dmFsdWUpOwog
ICAgIHNtcF9tYl9hY3F1aXJlKCk7CiAgICAgaWYgKHZhbHVlID09IEVWX1NFVCkgewogICAgICAg
ICAvKiBJZiB0aGVyZSB3YXMgYSBjb25jdXJyZW50IHJlc2V0IChvciBldmVuIHJlc2V0K3dhaXQp
LAogICAgICAgICAgKiBkbyBub3RoaW5nLiAgT3RoZXJ3aXNlIGNoYW5nZSBFVl9TRVQtPkVWX0ZS
RUUuCiAgICAgICAgICAqLwotICAgICAgICBhdG9taWNfb3IoJmV2LT52YWx1ZSwgRVZfRlJFRSk7
CisgICAgICAgIHFlbXVfYXRvbWljX29yKCZldi0+dmFsdWUsIEVWX0ZSRUUpOwogICAgIH0KIH0K
IApAQCAtMjc4LDcgKzI3OCw3IEBAIHZvaWQgcWVtdV9ldmVudF93YWl0KFFlbXVFdmVudCAqZXYp
CiAgICAgdW5zaWduZWQgdmFsdWU7CiAKICAgICBhc3NlcnQoZXYtPmluaXRpYWxpemVkKTsKLSAg
ICB2YWx1ZSA9IGF0b21pY19yZWFkKCZldi0+dmFsdWUpOworICAgIHZhbHVlID0gcWVtdV9hdG9t
aWNfcmVhZCgmZXYtPnZhbHVlKTsKICAgICBzbXBfbWJfYWNxdWlyZSgpOwogICAgIGlmICh2YWx1
ZSAhPSBFVl9TRVQpIHsKICAgICAgICAgaWYgKHZhbHVlID09IEVWX0ZSRUUpIHsKQEAgLTI5Miw3
ICsyOTIsNyBAQCB2b2lkIHFlbXVfZXZlbnRfd2FpdChRZW11RXZlbnQgKmV2KQogICAgICAgICAg
ICAgICogYmVjYXVzZSB0aGVyZSBjYW5ub3QgYmUgYSBjb25jdXJlbnQgYnVzeS0+ZnJlZSB0cmFu
c2l0aW9uLgogICAgICAgICAgICAgICogQWZ0ZXIgdGhlIENBUywgdGhlIGV2ZW50IHdpbGwgYmUg
ZWl0aGVyIHNldCBvciBidXN5LgogICAgICAgICAgICAgICovCi0gICAgICAgICAgICBpZiAoYXRv
bWljX2NtcHhjaGcoJmV2LT52YWx1ZSwgRVZfRlJFRSwgRVZfQlVTWSkgPT0gRVZfU0VUKSB7Cisg
ICAgICAgICAgICBpZiAocWVtdV9hdG9taWNfY21weGNoZygmZXYtPnZhbHVlLCBFVl9GUkVFLCBF
Vl9CVVNZKSA9PSBFVl9TRVQpIHsKICAgICAgICAgICAgICAgICB2YWx1ZSA9IEVWX1NFVDsKICAg
ICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgdmFsdWUgPSBFVl9CVVNZOwpkaWZm
IC0tZ2l0IGEvdXRpbC9xZW11LXRpbWVyLmMgYi91dGlsL3FlbXUtdGltZXIuYwppbmRleCA4Nzhk
ODBmZDVlLi5hNzBjMDNmYzU5IDEwMDY0NAotLS0gYS91dGlsL3FlbXUtdGltZXIuYworKysgYi91
dGlsL3FlbXUtdGltZXIuYwpAQCAtMTcwLDcgKzE3MCw3IEBAIHZvaWQgcWVtdV9jbG9ja19lbmFi
bGUoUUVNVUNsb2NrVHlwZSB0eXBlLCBib29sIGVuYWJsZWQpCiAKIGJvb2wgdGltZXJsaXN0X2hh
c190aW1lcnMoUUVNVVRpbWVyTGlzdCAqdGltZXJfbGlzdCkKIHsKLSAgICByZXR1cm4gISFhdG9t
aWNfcmVhZCgmdGltZXJfbGlzdC0+YWN0aXZlX3RpbWVycyk7CisgICAgcmV0dXJuICEhcWVtdV9h
dG9taWNfcmVhZCgmdGltZXJfbGlzdC0+YWN0aXZlX3RpbWVycyk7CiB9CiAKIGJvb2wgcWVtdV9j
bG9ja19oYXNfdGltZXJzKFFFTVVDbG9ja1R5cGUgdHlwZSkKQEAgLTE4Myw3ICsxODMsNyBAQCBi
b29sIHRpbWVybGlzdF9leHBpcmVkKFFFTVVUaW1lckxpc3QgKnRpbWVyX2xpc3QpCiB7CiAgICAg
aW50NjRfdCBleHBpcmVfdGltZTsKIAotICAgIGlmICghYXRvbWljX3JlYWQoJnRpbWVyX2xpc3Qt
PmFjdGl2ZV90aW1lcnMpKSB7CisgICAgaWYgKCFxZW11X2F0b21pY19yZWFkKCZ0aW1lcl9saXN0
LT5hY3RpdmVfdGltZXJzKSkgewogICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgfQogCkBAIC0y
MTMsNyArMjEzLDcgQEAgaW50NjRfdCB0aW1lcmxpc3RfZGVhZGxpbmVfbnMoUUVNVVRpbWVyTGlz
dCAqdGltZXJfbGlzdCkKICAgICBpbnQ2NF90IGRlbHRhOwogICAgIGludDY0X3QgZXhwaXJlX3Rp
bWU7CiAKLSAgICBpZiAoIWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGltZXJzKSkg
eworICAgIGlmICghcWVtdV9hdG9taWNfcmVhZCgmdGltZXJfbGlzdC0+YWN0aXZlX3RpbWVycykp
IHsKICAgICAgICAgcmV0dXJuIC0xOwogICAgIH0KIApAQCAtMzg1LDcgKzM4NSw3IEBAIHN0YXRp
YyB2b2lkIHRpbWVyX2RlbF9sb2NrZWQoUUVNVVRpbWVyTGlzdCAqdGltZXJfbGlzdCwgUUVNVVRp
bWVyICp0cykKICAgICAgICAgaWYgKCF0KQogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIGlm
ICh0ID09IHRzKSB7Ci0gICAgICAgICAgICBhdG9taWNfc2V0KHB0LCB0LT5uZXh0KTsKKyAgICAg
ICAgICAgIHFlbXVfYXRvbWljX3NldChwdCwgdC0+bmV4dCk7CiAgICAgICAgICAgICBicmVhazsK
ICAgICAgICAgfQogICAgICAgICBwdCA9ICZ0LT5uZXh0OwpAQCAtNDA4LDcgKzQwOCw3IEBAIHN0
YXRpYyBib29sIHRpbWVyX21vZF9uc19sb2NrZWQoUUVNVVRpbWVyTGlzdCAqdGltZXJfbGlzdCwK
ICAgICB9CiAgICAgdHMtPmV4cGlyZV90aW1lID0gTUFYKGV4cGlyZV90aW1lLCAwKTsKICAgICB0
cy0+bmV4dCA9ICpwdDsKLSAgICBhdG9taWNfc2V0KHB0LCB0cyk7CisgICAgcWVtdV9hdG9taWNf
c2V0KHB0LCB0cyk7CiAKICAgICByZXR1cm4gcHQgPT0gJnRpbWVyX2xpc3QtPmFjdGl2ZV90aW1l
cnM7CiB9CkBAIC01MDIsNyArNTAyLDcgQEAgYm9vbCB0aW1lcmxpc3RfcnVuX3RpbWVycyhRRU1V
VGltZXJMaXN0ICp0aW1lcl9saXN0KQogICAgIFFFTVVUaW1lckNCICpjYjsKICAgICB2b2lkICpv
cGFxdWU7CiAKLSAgICBpZiAoIWF0b21pY19yZWFkKCZ0aW1lcl9saXN0LT5hY3RpdmVfdGltZXJz
KSkgeworICAgIGlmICghcWVtdV9hdG9taWNfcmVhZCgmdGltZXJfbGlzdC0+YWN0aXZlX3RpbWVy
cykpIHsKICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KIApkaWZmIC0tZ2l0IGEvdXRpbC9x
aHQuYyBiL3V0aWwvcWh0LmMKaW5kZXggNjdlNWQ1YjkxNi4uMmNlZGMxYWUzNSAxMDA2NDQKLS0t
IGEvdXRpbC9xaHQuYworKysgYi91dGlsL3FodC5jCkBAIC0xMzEsMTEgKzEzMSwxMSBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgcWh0X3VubG9jayhzdHJ1Y3QgcWh0ICpodCkKIAogLyoKICAqIE5vdGU6
IHJlYWRpbmcgcGFydGlhbGx5LXVwZGF0ZWQgcG9pbnRlcnMgaW4gQHBvaW50ZXJzIGNvdWxkIGxl
YWQgdG8KLSAqIHNlZ2ZhdWx0cy4gV2UgdGh1cyBhY2Nlc3MgdGhlbSB3aXRoIGF0b21pY19yZWFk
L3NldDsgdGhpcyBndWFyYW50ZWVzCisgKiBzZWdmYXVsdHMuIFdlIHRodXMgYWNjZXNzIHRoZW0g
d2l0aCBxZW11X2F0b21pY19yZWFkL3NldDsgdGhpcyBndWFyYW50ZWVzCiAgKiB0aGF0IHRoZSBj
b21waWxlciBtYWtlcyBhbGwgdGhvc2UgYWNjZXNzZXMgYXRvbWljLiBXZSBhbHNvIG5lZWQgdGhl
Ci0gKiB2b2xhdGlsZS1saWtlIGJlaGF2aW9yIGluIGF0b21pY19yZWFkLCBzaW5jZSBvdGhlcndp
c2UgdGhlIGNvbXBpbGVyCisgKiB2b2xhdGlsZS1saWtlIGJlaGF2aW9yIGluIHFlbXVfYXRvbWlj
X3JlYWQsIHNpbmNlIG90aGVyd2lzZSB0aGUgY29tcGlsZXIKICAqIG1pZ2h0IHJlZmV0Y2ggdGhl
IHBvaW50ZXIuCi0gKiBhdG9taWNfcmVhZCdzIGFyZSBvZiBjb3Vyc2Ugbm90IG5lY2Vzc2FyeSB3
aGVuIHRoZSBidWNrZXQgbG9jayBpcyBoZWxkLgorICogcWVtdV9hdG9taWNfcmVhZCdzIGFyZSBv
ZiBjb3Vyc2Ugbm90IG5lY2Vzc2FyeSB3aGVuIHRoZSBidWNrZXQgbG9jayBpcyBoZWxkLgogICoK
ICAqIElmIGJvdGggaHQtPmxvY2sgYW5kIGItPmxvY2sgYXJlIGdyYWJiZWQsIGh0LT5sb2NrIHNo
b3VsZCBhbHdheXMKICAqIGJlIGdyYWJiZWQgZmlyc3QuCkBAIC0yODYsNyArMjg2LDcgQEAgdm9p
ZCBxaHRfbWFwX2xvY2tfYnVja2V0c19fbm9fc3RhbGUoc3RydWN0IHFodCAqaHQsIHN0cnVjdCBx
aHRfbWFwICoqcG1hcCkKIHsKICAgICBzdHJ1Y3QgcWh0X21hcCAqbWFwOwogCi0gICAgbWFwID0g
YXRvbWljX3JjdV9yZWFkKCZodC0+bWFwKTsKKyAgICBtYXAgPSBxZW11X2F0b21pY19yY3VfcmVh
ZCgmaHQtPm1hcCk7CiAgICAgcWh0X21hcF9sb2NrX2J1Y2tldHMobWFwKTsKICAgICBpZiAobGlr
ZWx5KCFxaHRfbWFwX2lzX3N0YWxlX19sb2NrZWQoaHQsIG1hcCkpKSB7CiAgICAgICAgICpwbWFw
ID0gbWFwOwpAQCAtMzE4LDcgKzMxOCw3IEBAIHN0cnVjdCBxaHRfYnVja2V0ICpxaHRfYnVja2V0
X2xvY2tfX25vX3N0YWxlKHN0cnVjdCBxaHQgKmh0LCB1aW50MzJfdCBoYXNoLAogICAgIHN0cnVj
dCBxaHRfYnVja2V0ICpiOwogICAgIHN0cnVjdCBxaHRfbWFwICptYXA7CiAKLSAgICBtYXAgPSBh
dG9taWNfcmN1X3JlYWQoJmh0LT5tYXApOworICAgIG1hcCA9IHFlbXVfYXRvbWljX3JjdV9yZWFk
KCZodC0+bWFwKTsKICAgICBiID0gcWh0X21hcF90b19idWNrZXQobWFwLCBoYXNoKTsKIAogICAg
IHFlbXVfc3Bpbl9sb2NrKCZiLT5sb2NrKTsKQEAgLTM0MCw3ICszNDAsOCBAQCBzdHJ1Y3QgcWh0
X2J1Y2tldCAqcWh0X2J1Y2tldF9sb2NrX19ub19zdGFsZShzdHJ1Y3QgcWh0ICpodCwgdWludDMy
X3QgaGFzaCwKIAogc3RhdGljIGlubGluZSBib29sIHFodF9tYXBfbmVlZHNfcmVzaXplKGNvbnN0
IHN0cnVjdCBxaHRfbWFwICptYXApCiB7Ci0gICAgcmV0dXJuIGF0b21pY19yZWFkKCZtYXAtPm5f
YWRkZWRfYnVja2V0cykgPiBtYXAtPm5fYWRkZWRfYnVja2V0c190aHJlc2hvbGQ7CisgICAgcmV0
dXJuIHFlbXVfYXRvbWljX3JlYWQoJm1hcC0+bl9hZGRlZF9idWNrZXRzKSA+CisgICAgICAgICAg
IG1hcC0+bl9hZGRlZF9idWNrZXRzX3RocmVzaG9sZDsKIH0KIAogc3RhdGljIGlubGluZSB2b2lk
IHFodF9jaGFpbl9kZXN0cm95KGNvbnN0IHN0cnVjdCBxaHRfYnVja2V0ICpoZWFkKQpAQCAtNDA0
LDcgKzQwNSw3IEBAIHZvaWQgcWh0X2luaXQoc3RydWN0IHFodCAqaHQsIHFodF9jbXBfZnVuY190
IGNtcCwgc2l6ZV90IG5fZWxlbXMsCiAgICAgaHQtPm1vZGUgPSBtb2RlOwogICAgIHFlbXVfbXV0
ZXhfaW5pdCgmaHQtPmxvY2spOwogICAgIG1hcCA9IHFodF9tYXBfY3JlYXRlKG5fYnVja2V0cyk7
Ci0gICAgYXRvbWljX3JjdV9zZXQoJmh0LT5tYXAsIG1hcCk7CisgICAgcWVtdV9hdG9taWNfcmN1
X3NldCgmaHQtPm1hcCwgbWFwKTsKIH0KIAogLyogY2FsbCBvbmx5IHdoZW4gdGhlcmUgYXJlIG5v
IHJlYWRlcnMvd3JpdGVycyBsZWZ0ICovCkBAIC00MjUsOCArNDI2LDggQEAgc3RhdGljIHZvaWQg
cWh0X2J1Y2tldF9yZXNldF9fbG9ja2VkKHN0cnVjdCBxaHRfYnVja2V0ICpoZWFkKQogICAgICAg
ICAgICAgaWYgKGItPnBvaW50ZXJzW2ldID09IE5VTEwpIHsKICAgICAgICAgICAgICAgICBnb3Rv
IGRvbmU7CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBhdG9taWNfc2V0KCZiLT5oYXNoZXNb
aV0sIDApOwotICAgICAgICAgICAgYXRvbWljX3NldCgmYi0+cG9pbnRlcnNbaV0sIE5VTEwpOwor
ICAgICAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZiLT5oYXNoZXNbaV0sIDApOworICAgICAgICAg
ICAgcWVtdV9hdG9taWNfc2V0KCZiLT5wb2ludGVyc1tpXSwgTlVMTCk7CiAgICAgICAgIH0KICAg
ICAgICAgYiA9IGItPm5leHQ7CiAgICAgfSB3aGlsZSAoYik7CkBAIC00OTIsMTkgKzQ5MywxOSBA
QCB2b2lkICpxaHRfZG9fbG9va3VwKGNvbnN0IHN0cnVjdCBxaHRfYnVja2V0ICpoZWFkLCBxaHRf
bG9va3VwX2Z1bmNfdCBmdW5jLAogCiAgICAgZG8gewogICAgICAgICBmb3IgKGkgPSAwOyBpIDwg
UUhUX0JVQ0tFVF9FTlRSSUVTOyBpKyspIHsKLSAgICAgICAgICAgIGlmIChhdG9taWNfcmVhZCgm
Yi0+aGFzaGVzW2ldKSA9PSBoYXNoKSB7CisgICAgICAgICAgICBpZiAocWVtdV9hdG9taWNfcmVh
ZCgmYi0+aGFzaGVzW2ldKSA9PSBoYXNoKSB7CiAgICAgICAgICAgICAgICAgLyogVGhlIHBvaW50
ZXIgaXMgZGVyZWZlcmVuY2VkIGJlZm9yZSBzZXFsb2NrX3JlYWRfcmV0cnksCiAgICAgICAgICAg
ICAgICAgICogc28gKHVubGlrZSBxaHRfaW5zZXJ0X19sb2NrZWQpIHdlIG5lZWQgdG8gdXNlCi0g
ICAgICAgICAgICAgICAgICogYXRvbWljX3JjdV9yZWFkIGhlcmUuCisgICAgICAgICAgICAgICAg
ICogcWVtdV9hdG9taWNfcmN1X3JlYWQgaGVyZS4KICAgICAgICAgICAgICAgICAgKi8KLSAgICAg
ICAgICAgICAgICB2b2lkICpwID0gYXRvbWljX3JjdV9yZWFkKCZiLT5wb2ludGVyc1tpXSk7Cisg
ICAgICAgICAgICAgICAgdm9pZCAqcCA9IHFlbXVfYXRvbWljX3JjdV9yZWFkKCZiLT5wb2ludGVy
c1tpXSk7CiAKICAgICAgICAgICAgICAgICBpZiAobGlrZWx5KHApICYmIGxpa2VseShmdW5jKHAs
IHVzZXJwKSkpIHsKICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHA7CiAgICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICAgfQogICAgICAgICB9Ci0gICAgICAgIGIgPSBhdG9taWNfcmN1X3Jl
YWQoJmItPm5leHQpOworICAgICAgICBiID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJmItPm5leHQp
OwogICAgIH0gd2hpbGUgKGIpOwogCiAgICAgcmV0dXJuIE5VTEw7CkBAIC01MzIsNyArNTMzLDcg
QEAgdm9pZCAqcWh0X2xvb2t1cF9jdXN0b20oY29uc3Qgc3RydWN0IHFodCAqaHQsIGNvbnN0IHZv
aWQgKnVzZXJwLCB1aW50MzJfdCBoYXNoLAogICAgIHVuc2lnbmVkIGludCB2ZXJzaW9uOwogICAg
IHZvaWQgKnJldDsKIAotICAgIG1hcCA9IGF0b21pY19yY3VfcmVhZCgmaHQtPm1hcCk7CisgICAg
bWFwID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJmh0LT5tYXApOwogICAgIGIgPSBxaHRfbWFwX3Rv
X2J1Y2tldChtYXAsIGhhc2gpOwogCiAgICAgdmVyc2lvbiA9IHNlcWxvY2tfcmVhZF9iZWdpbigm
Yi0+c2VxdWVuY2UpOwpAQCAtNTg0LDcgKzU4NSw3IEBAIHN0YXRpYyB2b2lkICpxaHRfaW5zZXJ0
X19sb2NrZWQoY29uc3Qgc3RydWN0IHFodCAqaHQsIHN0cnVjdCBxaHRfbWFwICptYXAsCiAgICAg
bWVtc2V0KGIsIDAsIHNpemVvZigqYikpOwogICAgIG5ldyA9IGI7CiAgICAgaSA9IDA7Ci0gICAg
YXRvbWljX2luYygmbWFwLT5uX2FkZGVkX2J1Y2tldHMpOworICAgIHFlbXVfYXRvbWljX2luYygm
bWFwLT5uX2FkZGVkX2J1Y2tldHMpOwogICAgIGlmICh1bmxpa2VseShxaHRfbWFwX25lZWRzX3Jl
c2l6ZShtYXApKSAmJiBuZWVkc19yZXNpemUpIHsKICAgICAgICAgKm5lZWRzX3Jlc2l6ZSA9IHRy
dWU7CiAgICAgfQpAQCAtNTkzLDExICs1OTQsMTEgQEAgc3RhdGljIHZvaWQgKnFodF9pbnNlcnRf
X2xvY2tlZChjb25zdCBzdHJ1Y3QgcWh0ICpodCwgc3RydWN0IHFodF9tYXAgKm1hcCwKICAgICAv
KiBmb3VuZCBhbiBlbXB0eSBrZXk6IGFjcXVpcmUgdGhlIHNlcWxvY2sgYW5kIHdyaXRlICovCiAg
ICAgc2VxbG9ja193cml0ZV9iZWdpbigmaGVhZC0+c2VxdWVuY2UpOwogICAgIGlmIChuZXcpIHsK
LSAgICAgICAgYXRvbWljX3JjdV9zZXQoJnByZXYtPm5leHQsIGIpOworICAgICAgICBxZW11X2F0
b21pY19yY3Vfc2V0KCZwcmV2LT5uZXh0LCBiKTsKICAgICB9CiAgICAgLyogc21wX3dtYigpIGlt
cGxpY2l0IGluIHNlcWxvY2tfd3JpdGVfYmVnaW4uICAqLwotICAgIGF0b21pY19zZXQoJmItPmhh
c2hlc1tpXSwgaGFzaCk7Ci0gICAgYXRvbWljX3NldCgmYi0+cG9pbnRlcnNbaV0sIHApOworICAg
IHFlbXVfYXRvbWljX3NldCgmYi0+aGFzaGVzW2ldLCBoYXNoKTsKKyAgICBxZW11X2F0b21pY19z
ZXQoJmItPnBvaW50ZXJzW2ldLCBwKTsKICAgICBzZXFsb2NrX3dyaXRlX2VuZCgmaGVhZC0+c2Vx
dWVuY2UpOwogICAgIHJldHVybiBOVUxMOwogfQpAQCAtNjY4LDExICs2NjksMTEgQEAgcWh0X2Vu
dHJ5X21vdmUoc3RydWN0IHFodF9idWNrZXQgKnRvLCBpbnQgaSwgc3RydWN0IHFodF9idWNrZXQg
KmZyb20sIGludCBqKQogICAgIHFodF9kZWJ1Z19hc3NlcnQodG8tPnBvaW50ZXJzW2ldKTsKICAg
ICBxaHRfZGVidWdfYXNzZXJ0KGZyb20tPnBvaW50ZXJzW2pdKTsKIAotICAgIGF0b21pY19zZXQo
JnRvLT5oYXNoZXNbaV0sIGZyb20tPmhhc2hlc1tqXSk7Ci0gICAgYXRvbWljX3NldCgmdG8tPnBv
aW50ZXJzW2ldLCBmcm9tLT5wb2ludGVyc1tqXSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZ0by0+
aGFzaGVzW2ldLCBmcm9tLT5oYXNoZXNbal0pOworICAgIHFlbXVfYXRvbWljX3NldCgmdG8tPnBv
aW50ZXJzW2ldLCBmcm9tLT5wb2ludGVyc1tqXSk7CiAKLSAgICBhdG9taWNfc2V0KCZmcm9tLT5o
YXNoZXNbal0sIDApOwotICAgIGF0b21pY19zZXQoJmZyb20tPnBvaW50ZXJzW2pdLCBOVUxMKTsK
KyAgICBxZW11X2F0b21pY19zZXQoJmZyb20tPmhhc2hlc1tqXSwgMCk7CisgICAgcWVtdV9hdG9t
aWNfc2V0KCZmcm9tLT5wb2ludGVyc1tqXSwgTlVMTCk7CiB9CiAKIC8qCkBAIC02ODcsNyArNjg4
LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHFodF9idWNrZXRfcmVtb3ZlX2VudHJ5KHN0cnVjdCBx
aHRfYnVja2V0ICpvcmlnLCBpbnQgcG9zKQogCiAgICAgaWYgKHFodF9lbnRyeV9pc19sYXN0KG9y
aWcsIHBvcykpIHsKICAgICAgICAgb3JpZy0+aGFzaGVzW3Bvc10gPSAwOwotICAgICAgICBhdG9t
aWNfc2V0KCZvcmlnLT5wb2ludGVyc1twb3NdLCBOVUxMKTsKKyAgICAgICAgcWVtdV9hdG9taWNf
c2V0KCZvcmlnLT5wb2ludGVyc1twb3NdLCBOVUxMKTsKICAgICAgICAgcmV0dXJuOwogICAgIH0K
ICAgICBkbyB7CkBAIC04MDMsNyArODA0LDcgQEAgZG9fcWh0X2l0ZXIoc3RydWN0IHFodCAqaHQs
IGNvbnN0IHN0cnVjdCBxaHRfaXRlciAqaXRlciwgdm9pZCAqdXNlcnApCiB7CiAgICAgc3RydWN0
IHFodF9tYXAgKm1hcDsKIAotICAgIG1hcCA9IGF0b21pY19yY3VfcmVhZCgmaHQtPm1hcCk7Cisg
ICAgbWFwID0gcWVtdV9hdG9taWNfcmN1X3JlYWQoJmh0LT5tYXApOwogICAgIHFodF9tYXBfbG9j
a19idWNrZXRzKG1hcCk7CiAgICAgcWh0X21hcF9pdGVyX19hbGxfbG9ja2VkKG1hcCwgaXRlciwg
dXNlcnApOwogICAgIHFodF9tYXBfdW5sb2NrX2J1Y2tldHMobWFwKTsKQEAgLTg3Niw3ICs4Nzcs
NyBAQCBzdGF0aWMgdm9pZCBxaHRfZG9fcmVzaXplX3Jlc2V0KHN0cnVjdCBxaHQgKmh0LCBzdHJ1
Y3QgcWh0X21hcCAqbmV3LCBib29sIHJlc2V0KQogICAgIHFodF9tYXBfaXRlcl9fYWxsX2xvY2tl
ZChvbGQsICZpdGVyLCAmZGF0YSk7CiAgICAgcWh0X21hcF9kZWJ1Z19fYWxsX2xvY2tlZChuZXcp
OwogCi0gICAgYXRvbWljX3JjdV9zZXQoJmh0LT5tYXAsIG5ldyk7CisgICAgcWVtdV9hdG9taWNf
cmN1X3NldCgmaHQtPm1hcCwgbmV3KTsKICAgICBxaHRfbWFwX3VubG9ja19idWNrZXRzKG9sZCk7
CiAgICAgY2FsbF9yY3Uob2xkLCBxaHRfbWFwX2Rlc3Ryb3ksIHJjdSk7CiB9CkBAIC05MDUsNyAr
OTA2LDcgQEAgdm9pZCBxaHRfc3RhdGlzdGljc19pbml0KGNvbnN0IHN0cnVjdCBxaHQgKmh0LCBz
dHJ1Y3QgcWh0X3N0YXRzICpzdGF0cykKICAgICBjb25zdCBzdHJ1Y3QgcWh0X21hcCAqbWFwOwog
ICAgIGludCBpOwogCi0gICAgbWFwID0gYXRvbWljX3JjdV9yZWFkKCZodC0+bWFwKTsKKyAgICBt
YXAgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmaHQtPm1hcCk7CiAKICAgICBzdGF0cy0+dXNlZF9o
ZWFkX2J1Y2tldHMgPSAwOwogICAgIHN0YXRzLT5lbnRyaWVzID0gMDsKQEAgLTkzMywxMyArOTM0
LDEzIEBAIHZvaWQgcWh0X3N0YXRpc3RpY3NfaW5pdChjb25zdCBzdHJ1Y3QgcWh0ICpodCwgc3Ry
dWN0IHFodF9zdGF0cyAqc3RhdHMpCiAgICAgICAgICAgICBiID0gaGVhZDsKICAgICAgICAgICAg
IGRvIHsKICAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgUUhUX0JVQ0tFVF9FTlRSSUVT
OyBqKyspIHsKLSAgICAgICAgICAgICAgICAgICAgaWYgKGF0b21pY19yZWFkKCZiLT5wb2ludGVy
c1tqXSkgPT0gTlVMTCkgeworICAgICAgICAgICAgICAgICAgICBpZiAocWVtdV9hdG9taWNfcmVh
ZCgmYi0+cG9pbnRlcnNbal0pID09IE5VTEwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgIGVudHJpZXMr
KzsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgYnVja2V0cysrOwotICAgICAg
ICAgICAgICAgIGIgPSBhdG9taWNfcmN1X3JlYWQoJmItPm5leHQpOworICAgICAgICAgICAgICAg
IGIgPSBxZW11X2F0b21pY19yY3VfcmVhZCgmYi0+bmV4dCk7CiAgICAgICAgICAgICB9IHdoaWxl
IChiKTsKICAgICAgICAgfSB3aGlsZSAoc2VxbG9ja19yZWFkX3JldHJ5KCZoZWFkLT5zZXF1ZW5j
ZSwgdmVyc2lvbikpOwogCmRpZmYgLS1naXQgYS91dGlsL3FzcC5jIGIvdXRpbC9xc3AuYwppbmRl
eCA3ZDUxNDdmMWIyLi4zMWVjMmEyNDgyIDEwMDY0NAotLS0gYS91dGlsL3FzcC5jCisrKyBiL3V0
aWwvcXNwLmMKQEAgLTI0NSwxMSArMjQ1LDExIEBAIHN0YXRpYyB2b2lkIHFzcF9kb19pbml0KHZv
aWQpCiAKIHN0YXRpYyBfX2F0dHJpYnV0ZV9fKChub2lubGluZSkpIHZvaWQgcXNwX2luaXRfX3Ns
b3dwYXRoKHZvaWQpCiB7Ci0gICAgaWYgKGF0b21pY19jbXB4Y2hnKCZxc3BfaW5pdGlhbGl6aW5n
LCBmYWxzZSwgdHJ1ZSkgPT0gZmFsc2UpIHsKKyAgICBpZiAocWVtdV9hdG9taWNfY21weGNoZygm
cXNwX2luaXRpYWxpemluZywgZmFsc2UsIHRydWUpID09IGZhbHNlKSB7CiAgICAgICAgIHFzcF9k
b19pbml0KCk7Ci0gICAgICAgIGF0b21pY19zZXQoJnFzcF9pbml0aWFsaXplZCwgdHJ1ZSk7Cisg
ICAgICAgIHFlbXVfYXRvbWljX3NldCgmcXNwX2luaXRpYWxpemVkLCB0cnVlKTsKICAgICB9IGVs
c2UgewotICAgICAgICB3aGlsZSAoIWF0b21pY19yZWFkKCZxc3BfaW5pdGlhbGl6ZWQpKSB7Cisg
ICAgICAgIHdoaWxlICghcWVtdV9hdG9taWNfcmVhZCgmcXNwX2luaXRpYWxpemVkKSkgewogICAg
ICAgICAgICAgY3B1X3JlbGF4KCk7CiAgICAgICAgIH0KICAgICB9CkBAIC0yNTgsNyArMjU4LDcg
QEAgc3RhdGljIF9fYXR0cmlidXRlX18oKG5vaW5saW5lKSkgdm9pZCBxc3BfaW5pdF9fc2xvd3Bh
dGgodm9pZCkKIC8qIHFzcF9pbml0KCkgbXVzdCBiZSBjYWxsZWQgZnJvbSBfYWxsXyBleHBvcnRl
ZCBmdW5jdGlvbnMgKi8KIHN0YXRpYyBpbmxpbmUgdm9pZCBxc3BfaW5pdCh2b2lkKQogewotICAg
IGlmIChsaWtlbHkoYXRvbWljX3JlYWQoJnFzcF9pbml0aWFsaXplZCkpKSB7CisgICAgaWYgKGxp
a2VseShxZW11X2F0b21pY19yZWFkKCZxc3BfaW5pdGlhbGl6ZWQpKSkgewogICAgICAgICByZXR1
cm47CiAgICAgfQogICAgIHFzcF9pbml0X19zbG93cGF0aCgpOwpAQCAtMzQ2LDkgKzM0Niw5IEBA
IHN0YXRpYyBRU1BFbnRyeSAqcXNwX2VudHJ5X2dldChjb25zdCB2b2lkICpvYmosIGNvbnN0IGNo
YXIgKmZpbGUsIGludCBsaW5lLAogICovCiBzdGF0aWMgaW5saW5lIHZvaWQgZG9fcXNwX2VudHJ5
X3JlY29yZChRU1BFbnRyeSAqZSwgaW50NjRfdCBkZWx0YSwgYm9vbCBhY3EpCiB7Ci0gICAgYXRv
bWljX3NldF91NjQoJmUtPm5zLCBlLT5ucyArIGRlbHRhKTsKKyAgICBxZW11X2F0b21pY19zZXRf
dTY0KCZlLT5ucywgZS0+bnMgKyBkZWx0YSk7CiAgICAgaWYgKGFjcSkgewotICAgICAgICBhdG9t
aWNfc2V0X3U2NCgmZS0+bl9hY3FzLCBlLT5uX2FjcXMgKyAxKTsKKyAgICAgICAgcWVtdV9hdG9t
aWNfc2V0X3U2NCgmZS0+bl9hY3FzLCBlLT5uX2FjcXMgKyAxKTsKICAgICB9CiB9CiAKQEAgLTQz
MiwyOSArNDMyLDI5IEBAIHFzcF9jb25kX3RpbWVkd2FpdChRZW11Q29uZCAqY29uZCwgUWVtdU11
dGV4ICptdXRleCwgaW50IG1zLAogCiBib29sIHFzcF9pc19lbmFibGVkKHZvaWQpCiB7Ci0gICAg
cmV0dXJuIGF0b21pY19yZWFkKCZxZW11X211dGV4X2xvY2tfZnVuYykgPT0gcXNwX211dGV4X2xv
Y2s7CisgICAgcmV0dXJuIHFlbXVfYXRvbWljX3JlYWQoJnFlbXVfbXV0ZXhfbG9ja19mdW5jKSA9
PSBxc3BfbXV0ZXhfbG9jazsKIH0KIAogdm9pZCBxc3BfZW5hYmxlKHZvaWQpCiB7Ci0gICAgYXRv
bWljX3NldCgmcWVtdV9tdXRleF9sb2NrX2Z1bmMsIHFzcF9tdXRleF9sb2NrKTsKLSAgICBhdG9t
aWNfc2V0KCZxZW11X211dGV4X3RyeWxvY2tfZnVuYywgcXNwX211dGV4X3RyeWxvY2spOwotICAg
IGF0b21pY19zZXQoJnFlbXVfYnFsX211dGV4X2xvY2tfZnVuYywgcXNwX2JxbF9tdXRleF9sb2Nr
KTsKLSAgICBhdG9taWNfc2V0KCZxZW11X3JlY19tdXRleF9sb2NrX2Z1bmMsIHFzcF9yZWNfbXV0
ZXhfbG9jayk7Ci0gICAgYXRvbWljX3NldCgmcWVtdV9yZWNfbXV0ZXhfdHJ5bG9ja19mdW5jLCBx
c3BfcmVjX211dGV4X3RyeWxvY2spOwotICAgIGF0b21pY19zZXQoJnFlbXVfY29uZF93YWl0X2Z1
bmMsIHFzcF9jb25kX3dhaXQpOwotICAgIGF0b21pY19zZXQoJnFlbXVfY29uZF90aW1lZHdhaXRf
ZnVuYywgcXNwX2NvbmRfdGltZWR3YWl0KTsKKyAgICBxZW11X2F0b21pY19zZXQoJnFlbXVfbXV0
ZXhfbG9ja19mdW5jLCBxc3BfbXV0ZXhfbG9jayk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZxZW11
X211dGV4X3RyeWxvY2tfZnVuYywgcXNwX211dGV4X3RyeWxvY2spOworICAgIHFlbXVfYXRvbWlj
X3NldCgmcWVtdV9icWxfbXV0ZXhfbG9ja19mdW5jLCBxc3BfYnFsX211dGV4X2xvY2spOworICAg
IHFlbXVfYXRvbWljX3NldCgmcWVtdV9yZWNfbXV0ZXhfbG9ja19mdW5jLCBxc3BfcmVjX211dGV4
X2xvY2spOworICAgIHFlbXVfYXRvbWljX3NldCgmcWVtdV9yZWNfbXV0ZXhfdHJ5bG9ja19mdW5j
LCBxc3BfcmVjX211dGV4X3RyeWxvY2spOworICAgIHFlbXVfYXRvbWljX3NldCgmcWVtdV9jb25k
X3dhaXRfZnVuYywgcXNwX2NvbmRfd2FpdCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZxZW11X2Nv
bmRfdGltZWR3YWl0X2Z1bmMsIHFzcF9jb25kX3RpbWVkd2FpdCk7CiB9CiAKIHZvaWQgcXNwX2Rp
c2FibGUodm9pZCkKIHsKLSAgICBhdG9taWNfc2V0KCZxZW11X211dGV4X2xvY2tfZnVuYywgcWVt
dV9tdXRleF9sb2NrX2ltcGwpOwotICAgIGF0b21pY19zZXQoJnFlbXVfbXV0ZXhfdHJ5bG9ja19m
dW5jLCBxZW11X211dGV4X3RyeWxvY2tfaW1wbCk7Ci0gICAgYXRvbWljX3NldCgmcWVtdV9icWxf
bXV0ZXhfbG9ja19mdW5jLCBxZW11X211dGV4X2xvY2tfaW1wbCk7Ci0gICAgYXRvbWljX3NldCgm
cWVtdV9yZWNfbXV0ZXhfbG9ja19mdW5jLCBxZW11X3JlY19tdXRleF9sb2NrX2ltcGwpOwotICAg
IGF0b21pY19zZXQoJnFlbXVfcmVjX211dGV4X3RyeWxvY2tfZnVuYywgcWVtdV9yZWNfbXV0ZXhf
dHJ5bG9ja19pbXBsKTsKLSAgICBhdG9taWNfc2V0KCZxZW11X2NvbmRfd2FpdF9mdW5jLCBxZW11
X2NvbmRfd2FpdF9pbXBsKTsKLSAgICBhdG9taWNfc2V0KCZxZW11X2NvbmRfdGltZWR3YWl0X2Z1
bmMsIHFlbXVfY29uZF90aW1lZHdhaXRfaW1wbCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZxZW11
X211dGV4X2xvY2tfZnVuYywgcWVtdV9tdXRleF9sb2NrX2ltcGwpOworICAgIHFlbXVfYXRvbWlj
X3NldCgmcWVtdV9tdXRleF90cnlsb2NrX2Z1bmMsIHFlbXVfbXV0ZXhfdHJ5bG9ja19pbXBsKTsK
KyAgICBxZW11X2F0b21pY19zZXQoJnFlbXVfYnFsX211dGV4X2xvY2tfZnVuYywgcWVtdV9tdXRl
eF9sb2NrX2ltcGwpOworICAgIHFlbXVfYXRvbWljX3NldCgmcWVtdV9yZWNfbXV0ZXhfbG9ja19m
dW5jLCBxZW11X3JlY19tdXRleF9sb2NrX2ltcGwpOworICAgIHFlbXVfYXRvbWljX3NldCgmcWVt
dV9yZWNfbXV0ZXhfdHJ5bG9ja19mdW5jLCBxZW11X3JlY19tdXRleF90cnlsb2NrX2ltcGwpOwor
ICAgIHFlbXVfYXRvbWljX3NldCgmcWVtdV9jb25kX3dhaXRfZnVuYywgcWVtdV9jb25kX3dhaXRf
aW1wbCk7CisgICAgcWVtdV9hdG9taWNfc2V0KCZxZW11X2NvbmRfdGltZWR3YWl0X2Z1bmMsIHFl
bXVfY29uZF90aW1lZHdhaXRfaW1wbCk7CiB9CiAKIHN0YXRpYyBnaW50IHFzcF90cmVlX2NtcChn
Y29uc3Rwb2ludGVyIGFwLCBnY29uc3Rwb2ludGVyIGJwLCBncG9pbnRlciB1cCkKQEAgLTUzOCw4
ICs1MzgsOCBAQCBzdGF0aWMgdm9pZCBxc3BfYWdncmVnYXRlKHZvaWQgKnAsIHVpbnQzMl90IGgs
IHZvaWQgKnVwKQogICAgICAqIFRoZSBlbnRyeSBpcyBpbiB0aGUgZ2xvYmFsIGhhc2ggdGFibGU7
IHJlYWQgZnJvbSBpdCBhdG9taWNhbGx5IChhcyBpbgogICAgICAqICJyZWFkIG9uY2UiKS4KICAg
ICAgKi8KLSAgICBhZ2ctPm5zICs9IGF0b21pY19yZWFkX3U2NCgmZS0+bnMpOwotICAgIGFnZy0+
bl9hY3FzICs9IGF0b21pY19yZWFkX3U2NCgmZS0+bl9hY3FzKTsKKyAgICBhZ2ctPm5zICs9IHFl
bXVfYXRvbWljX3JlYWRfdTY0KCZlLT5ucyk7CisgICAgYWdnLT5uX2FjcXMgKz0gcWVtdV9hdG9t
aWNfcmVhZF91NjQoJmUtPm5fYWNxcyk7CiB9CiAKIHN0YXRpYyB2b2lkIHFzcF9pdGVyX2RpZmYo
dm9pZCAqcCwgdWludDMyX3QgaGFzaCwgdm9pZCAqaHRwKQpAQCAtNjEwLDcgKzYxMCw3IEBAIHN0
YXRpYyB2b2lkIHFzcF9ta3RyZWUoR1RyZWUgKnRyZWUsIGJvb2wgY2FsbHNpdGVfY29hbGVzY2Up
CiAgICAgICogd2l0aCB0aGUgc25hcHNob3QuCiAgICAgICovCiAgICAgV0lUSF9SQ1VfUkVBRF9M
T0NLX0dVQVJEKCkgewotICAgICAgICBRU1BTbmFwc2hvdCAqc25hcCA9IGF0b21pY19yY3VfcmVh
ZCgmcXNwX3NuYXBzaG90KTsKKyAgICAgICAgUVNQU25hcHNob3QgKnNuYXAgPSBxZW11X2F0b21p
Y19yY3VfcmVhZCgmcXNwX3NuYXBzaG90KTsKIAogICAgICAgICAvKiBBZ2dyZWdhdGUgYWxsIHJl
c3VsdHMgZnJvbSB0aGUgZ2xvYmFsIGhhc2ggdGFibGUgaW50byBhIGxvY2FsIG9uZSAqLwogICAg
ICAgICBxaHRfaW5pdCgmaHQsIHFzcF9lbnRyeV9ub190aHJlYWRfY21wLCBRU1BfSU5JVElBTF9T
SVpFLApAQCAtODA2LDcgKzgwNiw3IEBAIHZvaWQgcXNwX3Jlc2V0KHZvaWQpCiAgICAgcWh0X2l0
ZXIoJnFzcF9odCwgcXNwX2FnZ3JlZ2F0ZSwgJm5ldy0+aHQpOwogCiAgICAgLyogcmVwbGFjZSB0
aGUgcHJldmlvdXMgc25hcHNob3QsIGlmIGFueSAqLwotICAgIG9sZCA9IGF0b21pY194Y2hnKCZx
c3Bfc25hcHNob3QsIG5ldyk7CisgICAgb2xkID0gcWVtdV9hdG9taWNfeGNoZygmcXNwX3NuYXBz
aG90LCBuZXcpOwogICAgIGlmIChvbGQpIHsKICAgICAgICAgY2FsbF9yY3Uob2xkLCBxc3Bfc25h
cHNob3RfZGVzdHJveSwgcmN1KTsKICAgICB9CmRpZmYgLS1naXQgYS91dGlsL3JjdS5jIGIvdXRp
bC9yY3UuYwppbmRleCBjNGZlZmE5MzMzLi45MmExNGUwYTBmIDEwMDY0NAotLS0gYS91dGlsL3Jj
dS5jCisrKyBiL3V0aWwvcmN1LmMKQEAgLTU3LDcgKzU3LDcgQEAgc3RhdGljIGlubGluZSBpbnQg
cmN1X2dwX29uZ29pbmcodW5zaWduZWQgbG9uZyAqY3RyKQogewogICAgIHVuc2lnbmVkIGxvbmcg
djsKIAotICAgIHYgPSBhdG9taWNfcmVhZChjdHIpOworICAgIHYgPSBxZW11X2F0b21pY19yZWFk
KGN0cik7CiAgICAgcmV0dXJuIHYgJiYgKHYgIT0gcmN1X2dwX2N0cik7CiB9CiAKQEAgLTgyLDE0
ICs4MiwxNCBAQCBzdGF0aWMgdm9pZCB3YWl0X2Zvcl9yZWFkZXJzKHZvaWQpCiAgICAgICAgICAq
LwogICAgICAgICBxZW11X2V2ZW50X3Jlc2V0KCZyY3VfZ3BfZXZlbnQpOwogCi0gICAgICAgIC8q
IEluc3RlYWQgb2YgdXNpbmcgYXRvbWljX21iX3NldCBmb3IgaW5kZXgtPndhaXRpbmcsIGFuZAot
ICAgICAgICAgKiBhdG9taWNfbWJfcmVhZCBmb3IgaW5kZXgtPmN0ciwgbWVtb3J5IGJhcnJpZXJz
IGFyZSBwbGFjZWQKKyAgICAgICAgLyogSW5zdGVhZCBvZiB1c2luZyBxZW11X2F0b21pY19tYl9z
ZXQgZm9yIGluZGV4LT53YWl0aW5nLCBhbmQKKyAgICAgICAgICogcWVtdV9hdG9taWNfbWJfcmVh
ZCBmb3IgaW5kZXgtPmN0ciwgbWVtb3J5IGJhcnJpZXJzIGFyZSBwbGFjZWQKICAgICAgICAgICog
bWFudWFsbHkgc2luY2Ugd3JpdGVzIHRvIGRpZmZlcmVudCB0aHJlYWRzIGFyZSBpbmRlcGVuZGVu
dC4KICAgICAgICAgICogcWVtdV9ldmVudF9yZXNldCBoYXMgYWNxdWlyZSBzZW1hbnRpY3MsIHNv
IG5vIG1lbW9yeSBiYXJyaWVyCiAgICAgICAgICAqIGlzIG5lZWRlZCBoZXJlLgogICAgICAgICAg
Ki8KICAgICAgICAgUUxJU1RfRk9SRUFDSChpbmRleCwgJnJlZ2lzdHJ5LCBub2RlKSB7Ci0gICAg
ICAgICAgICBhdG9taWNfc2V0KCZpbmRleC0+d2FpdGluZywgdHJ1ZSk7CisgICAgICAgICAgICBx
ZW11X2F0b21pY19zZXQoJmluZGV4LT53YWl0aW5nLCB0cnVlKTsKICAgICAgICAgfQogCiAgICAg
ICAgIC8qIEhlcmUsIG9yZGVyIHRoZSBzdG9yZXMgdG8gaW5kZXgtPndhaXRpbmcgYmVmb3JlIHRo
ZSBsb2FkcyBvZgpAQCAtMTA2LDcgKzEwNiw3IEBAIHN0YXRpYyB2b2lkIHdhaXRfZm9yX3JlYWRl
cnModm9pZCkKICAgICAgICAgICAgICAgICAvKiBObyBuZWVkIGZvciBtYl9zZXQgaGVyZSwgd29y
c3Qgb2YgYWxsIHdlCiAgICAgICAgICAgICAgICAgICogZ2V0IHNvbWUgZXh0cmEgZnV0ZXggd2Fr
ZXVwcy4KICAgICAgICAgICAgICAgICAgKi8KLSAgICAgICAgICAgICAgICBhdG9taWNfc2V0KCZp
bmRleC0+d2FpdGluZywgZmFsc2UpOworICAgICAgICAgICAgICAgIHFlbXVfYXRvbWljX3NldCgm
aW5kZXgtPndhaXRpbmcsIGZhbHNlKTsKICAgICAgICAgICAgIH0KICAgICAgICAgfQogCkBAIC0x
NTEsNyArMTUxLDcgQEAgdm9pZCBzeW5jaHJvbml6ZV9yY3Uodm9pZCkKIAogICAgIFFFTVVfTE9D
S19HVUFSRCgmcmN1X3JlZ2lzdHJ5X2xvY2spOwogICAgIGlmICghUUxJU1RfRU1QVFkoJnJlZ2lz
dHJ5KSkgewotICAgICAgICAvKiBJbiBlaXRoZXIgY2FzZSwgdGhlIGF0b21pY19tYl9zZXQgYmVs
b3cgYmxvY2tzIHN0b3JlcyB0aGF0IGZyZWUKKyAgICAgICAgLyogSW4gZWl0aGVyIGNhc2UsIHRo
ZSBxZW11X2F0b21pY19tYl9zZXQgYmVsb3cgYmxvY2tzIHN0b3JlcyB0aGF0IGZyZWUKICAgICAg
ICAgICogb2xkIFJDVS1wcm90ZWN0ZWQgcG9pbnRlcnMuCiAgICAgICAgICAqLwogICAgICAgICBp
ZiAoc2l6ZW9mKHJjdV9ncF9jdHIpIDwgOCkgewpAQCAtMTYwLDEyICsxNjAsMTIgQEAgdm9pZCBz
eW5jaHJvbml6ZV9yY3Uodm9pZCkKICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgKiBTd2l0
Y2ggcGFyaXR5OiAwIC0+IDEsIDEgLT4gMC4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAg
YXRvbWljX21iX3NldCgmcmN1X2dwX2N0ciwgcmN1X2dwX2N0ciBeIFJDVV9HUF9DVFIpOworICAg
ICAgICAgICAgcWVtdV9hdG9taWNfbWJfc2V0KCZyY3VfZ3BfY3RyLCByY3VfZ3BfY3RyIF4gUkNV
X0dQX0NUUik7CiAgICAgICAgICAgICB3YWl0X2Zvcl9yZWFkZXJzKCk7Ci0gICAgICAgICAgICBh
dG9taWNfbWJfc2V0KCZyY3VfZ3BfY3RyLCByY3VfZ3BfY3RyIF4gUkNVX0dQX0NUUik7CisgICAg
ICAgICAgICBxZW11X2F0b21pY19tYl9zZXQoJnJjdV9ncF9jdHIsIHJjdV9ncF9jdHIgXiBSQ1Vf
R1BfQ1RSKTsKICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgIC8qIEluY3JlbWVudCBjdXJy
ZW50IGdyYWNlIHBlcmlvZC4gICovCi0gICAgICAgICAgICBhdG9taWNfbWJfc2V0KCZyY3VfZ3Bf
Y3RyLCByY3VfZ3BfY3RyICsgUkNVX0dQX0NUUik7CisgICAgICAgICAgICBxZW11X2F0b21pY19t
Yl9zZXQoJnJjdV9ncF9jdHIsIHJjdV9ncF9jdHIgKyBSQ1VfR1BfQ1RSKTsKICAgICAgICAgfQog
CiAgICAgICAgIHdhaXRfZm9yX3JlYWRlcnMoKTsKQEAgLTE4OCw4ICsxODgsOCBAQCBzdGF0aWMg
dm9pZCBlbnF1ZXVlKHN0cnVjdCByY3VfaGVhZCAqbm9kZSkKICAgICBzdHJ1Y3QgcmN1X2hlYWQg
KipvbGRfdGFpbDsKIAogICAgIG5vZGUtPm5leHQgPSBOVUxMOwotICAgIG9sZF90YWlsID0gYXRv
bWljX3hjaGcoJnRhaWwsICZub2RlLT5uZXh0KTsKLSAgICBhdG9taWNfbWJfc2V0KG9sZF90YWls
LCBub2RlKTsKKyAgICBvbGRfdGFpbCA9IHFlbXVfYXRvbWljX3hjaGcoJnRhaWwsICZub2RlLT5u
ZXh0KTsKKyAgICBxZW11X2F0b21pY19tYl9zZXQob2xkX3RhaWwsIG5vZGUpOwogfQogCiBzdGF0
aWMgc3RydWN0IHJjdV9oZWFkICp0cnlfZGVxdWV1ZSh2b2lkKQpAQCAtMjAzLDcgKzIwMyw3IEBA
IHJldHJ5OgogICAgICAqIFRoZSB0YWlsLCBiZWNhdXNlIGl0IGlzIHRoZSBmaXJzdCBzdGVwIGlu
IHRoZSBlbnF1ZXVpbmcuCiAgICAgICogSXQgaXMgb25seSB0aGUgbmV4dCBwb2ludGVycyB0aGF0
IG1pZ2h0IGJlIGluY29uc2lzdGVudC4KICAgICAgKi8KLSAgICBpZiAoaGVhZCA9PSAmZHVtbXkg
JiYgYXRvbWljX21iX3JlYWQoJnRhaWwpID09ICZkdW1teS5uZXh0KSB7CisgICAgaWYgKGhlYWQg
PT0gJmR1bW15ICYmIHFlbXVfYXRvbWljX21iX3JlYWQoJnRhaWwpID09ICZkdW1teS5uZXh0KSB7
CiAgICAgICAgIGFib3J0KCk7CiAgICAgfQogCkBAIC0yMTEsNyArMjExLDcgQEAgcmV0cnk6CiAg
ICAgICogd3JvbmcgYW5kIHdlIG5lZWQgdG8gd2FpdCB1bnRpbCBpdHMgZW5xdWV1ZXIgZmluaXNo
ZXMgdGhlIHVwZGF0ZS4KICAgICAgKi8KICAgICBub2RlID0gaGVhZDsKLSAgICBuZXh0ID0gYXRv
bWljX21iX3JlYWQoJmhlYWQtPm5leHQpOworICAgIG5leHQgPSBxZW11X2F0b21pY19tYl9yZWFk
KCZoZWFkLT5uZXh0KTsKICAgICBpZiAoIW5leHQpIHsKICAgICAgICAgcmV0dXJuIE5VTEw7CiAg
ICAgfQpAQCAtMjQwLDcgKzI0MCw3IEBAIHN0YXRpYyB2b2lkICpjYWxsX3JjdV90aHJlYWQodm9p
ZCAqb3BhcXVlKQogCiAgICAgZm9yICg7OykgewogICAgICAgICBpbnQgdHJpZXMgPSAwOwotICAg
ICAgICBpbnQgbiA9IGF0b21pY19yZWFkKCZyY3VfY2FsbF9jb3VudCk7CisgICAgICAgIGludCBu
ID0gcWVtdV9hdG9taWNfcmVhZCgmcmN1X2NhbGxfY291bnQpOwogCiAgICAgICAgIC8qIEhldXJp
c3RpY2FsbHkgd2FpdCBmb3IgYSBkZWNlbnQgbnVtYmVyIG9mIGNhbGxiYWNrcyB0byBwaWxlIHVw
LgogICAgICAgICAgKiBGZXRjaCByY3VfY2FsbF9jb3VudCBub3csIHdlIG9ubHkgbXVzdCBwcm9j
ZXNzIGVsZW1lbnRzIHRoYXQgd2VyZQpAQCAtMjUwLDcgKzI1MCw3IEBAIHN0YXRpYyB2b2lkICpj
YWxsX3JjdV90aHJlYWQodm9pZCAqb3BhcXVlKQogICAgICAgICAgICAgZ191c2xlZXAoMTAwMDAp
OwogICAgICAgICAgICAgaWYgKG4gPT0gMCkgewogICAgICAgICAgICAgICAgIHFlbXVfZXZlbnRf
cmVzZXQoJnJjdV9jYWxsX3JlYWR5X2V2ZW50KTsKLSAgICAgICAgICAgICAgICBuID0gYXRvbWlj
X3JlYWQoJnJjdV9jYWxsX2NvdW50KTsKKyAgICAgICAgICAgICAgICBuID0gcWVtdV9hdG9taWNf
cmVhZCgmcmN1X2NhbGxfY291bnQpOwogICAgICAgICAgICAgICAgIGlmIChuID09IDApIHsKICNp
ZiBkZWZpbmVkKENPTkZJR19NQUxMT0NfVFJJTSkKICAgICAgICAgICAgICAgICAgICAgbWFsbG9j
X3RyaW0oNCAqIDEwMjQgKiAxMDI0KTsKQEAgLTI1OCwxMCArMjU4LDEwIEBAIHN0YXRpYyB2b2lk
ICpjYWxsX3JjdV90aHJlYWQodm9pZCAqb3BhcXVlKQogICAgICAgICAgICAgICAgICAgICBxZW11
X2V2ZW50X3dhaXQoJnJjdV9jYWxsX3JlYWR5X2V2ZW50KTsKICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICB9Ci0gICAgICAgICAgICBuID0gYXRvbWljX3JlYWQoJnJjdV9jYWxsX2NvdW50
KTsKKyAgICAgICAgICAgIG4gPSBxZW11X2F0b21pY19yZWFkKCZyY3VfY2FsbF9jb3VudCk7CiAg
ICAgICAgIH0KIAotICAgICAgICBhdG9taWNfc3ViKCZyY3VfY2FsbF9jb3VudCwgbik7CisgICAg
ICAgIHFlbXVfYXRvbWljX3N1YigmcmN1X2NhbGxfY291bnQsIG4pOwogICAgICAgICBzeW5jaHJv
bml6ZV9yY3UoKTsKICAgICAgICAgcWVtdV9tdXRleF9sb2NrX2lvdGhyZWFkKCk7CiAgICAgICAg
IHdoaWxlIChuID4gMCkgewpAQCAtMjg5LDcgKzI4OSw3IEBAIHZvaWQgY2FsbF9yY3UxKHN0cnVj
dCByY3VfaGVhZCAqbm9kZSwgdm9pZCAoKmZ1bmMpKHN0cnVjdCByY3VfaGVhZCAqbm9kZSkpCiB7
CiAgICAgbm9kZS0+ZnVuYyA9IGZ1bmM7CiAgICAgZW5xdWV1ZShub2RlKTsKLSAgICBhdG9taWNf
aW5jKCZyY3VfY2FsbF9jb3VudCk7CisgICAgcWVtdV9hdG9taWNfaW5jKCZyY3VfY2FsbF9jb3Vu
dCk7CiAgICAgcWVtdV9ldmVudF9zZXQoJnJjdV9jYWxsX3JlYWR5X2V2ZW50KTsKIH0KIApkaWZm
IC0tZ2l0IGEvdXRpbC9zdGF0czY0LmMgYi91dGlsL3N0YXRzNjQuYwppbmRleCAzODljMzY1YTll
Li5hOTNjMDRkY2UwIDEwMDY0NAotLS0gYS91dGlsL3N0YXRzNjQuYworKysgYi91dGlsL3N0YXRz
NjQuYwpAQCAtMTgsMjcgKzE4LDI3IEBACiBzdGF0aWMgaW5saW5lIHZvaWQgc3RhdDY0X3JkbG9j
ayhTdGF0NjQgKnMpCiB7CiAgICAgLyogS2VlcCBvdXQgaW5jb21pbmcgd3JpdGVycyB0byBhdm9p
ZCB0aGVtIHN0YXJ2aW5nIHVzLiAqLwotICAgIGF0b21pY19hZGQoJnMtPmxvY2ssIDIpOworICAg
IHFlbXVfYXRvbWljX2FkZCgmcy0+bG9jaywgMik7CiAKICAgICAvKiBJZiB0aGVyZSBpcyBhIGNv
bmN1cnJlbnQgd3JpdGVyLCB3YWl0IGZvciBpdC4gICovCi0gICAgd2hpbGUgKGF0b21pY19yZWFk
KCZzLT5sb2NrKSAmIDEpIHsKKyAgICB3aGlsZSAocWVtdV9hdG9taWNfcmVhZCgmcy0+bG9jaykg
JiAxKSB7CiAgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0KIH0KIAogc3RhdGljIGlubGluZSB2
b2lkIHN0YXQ2NF9yZHVubG9jayhTdGF0NjQgKnMpCiB7Ci0gICAgYXRvbWljX3N1Yigmcy0+bG9j
aywgMik7CisgICAgcWVtdV9hdG9taWNfc3ViKCZzLT5sb2NrLCAyKTsKIH0KIAogc3RhdGljIGlu
bGluZSBib29sIHN0YXQ2NF93cnRyeWxvY2soU3RhdDY0ICpzKQogewotICAgIHJldHVybiBhdG9t
aWNfY21weGNoZygmcy0+bG9jaywgMCwgMSkgPT0gMDsKKyAgICByZXR1cm4gcWVtdV9hdG9taWNf
Y21weGNoZygmcy0+bG9jaywgMCwgMSkgPT0gMDsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIHN0
YXQ2NF93cnVubG9jayhTdGF0NjQgKnMpCiB7Ci0gICAgYXRvbWljX2RlYygmcy0+bG9jayk7Cisg
ICAgcWVtdV9hdG9taWNfZGVjKCZzLT5sb2NrKTsKIH0KIAogdWludDY0X3Qgc3RhdDY0X2dldChj
b25zdCBTdGF0NjQgKnMpCkBAIC01MCw4ICs1MCw4IEBAIHVpbnQ2NF90IHN0YXQ2NF9nZXQoY29u
c3QgU3RhdDY0ICpzKQogICAgIC8qIDY0LWJpdCB3cml0ZXMgYWx3YXlzIHRha2UgdGhlIGxvY2ss
IHNvIHdlIGNhbiByZWFkIGluCiAgICAgICogYW55IG9yZGVyLgogICAgICAqLwotICAgIGhpZ2gg
PSBhdG9taWNfcmVhZCgmcy0+aGlnaCk7Ci0gICAgbG93ID0gYXRvbWljX3JlYWQoJnMtPmxvdyk7
CisgICAgaGlnaCA9IHFlbXVfYXRvbWljX3JlYWQoJnMtPmhpZ2gpOworICAgIGxvdyA9IHFlbXVf
YXRvbWljX3JlYWQoJnMtPmxvdyk7CiAgICAgc3RhdDY0X3JkdW5sb2NrKChTdGF0NjQgKilzKTsK
IAogICAgIHJldHVybiAoKHVpbnQ2NF90KWhpZ2ggPDwgMzIpIHwgbG93OwpAQCAtNzAsOSArNzAs
OSBAQCBib29sIHN0YXQ2NF9hZGQzMl9jYXJyeShTdGF0NjQgKnMsIHVpbnQzMl90IGxvdywgdWlu
dDMyX3QgaGlnaCkKICAgICAgKiBvcmRlciBvZiBvdXIgdXBkYXRlLiAgQnkgdXBkYXRpbmcgcy0+
bG93IGZpcnN0LCB3ZSBjYW4gY2hlY2sKICAgICAgKiB3aGV0aGVyIHdlIGhhdmUgdG8gY2Fycnkg
aW50byBzLT5oaWdoLgogICAgICAqLwotICAgIG9sZCA9IGF0b21pY19mZXRjaF9hZGQoJnMtPmxv
dywgbG93KTsKKyAgICBvbGQgPSBxZW11X2F0b21pY19mZXRjaF9hZGQoJnMtPmxvdywgbG93KTsK
ICAgICBoaWdoICs9IChvbGQgKyBsb3cpIDwgb2xkOwotICAgIGF0b21pY19hZGQoJnMtPmhpZ2gs
IGhpZ2gpOworICAgIHFlbXVfYXRvbWljX2FkZCgmcy0+aGlnaCwgaGlnaCk7CiAgICAgc3RhdDY0
X3dydW5sb2NrKHMpOwogICAgIHJldHVybiB0cnVlOwogfQpAQCAtODcsOCArODcsOCBAQCBib29s
IHN0YXQ2NF9taW5fc2xvdyhTdGF0NjQgKnMsIHVpbnQ2NF90IHZhbHVlKQogICAgICAgICByZXR1
cm4gZmFsc2U7CiAgICAgfQogCi0gICAgaGlnaCA9IGF0b21pY19yZWFkKCZzLT5oaWdoKTsKLSAg
ICBsb3cgPSBhdG9taWNfcmVhZCgmcy0+bG93KTsKKyAgICBoaWdoID0gcWVtdV9hdG9taWNfcmVh
ZCgmcy0+aGlnaCk7CisgICAgbG93ID0gcWVtdV9hdG9taWNfcmVhZCgmcy0+bG93KTsKIAogICAg
IG9yaWcgPSAoKHVpbnQ2NF90KWhpZ2ggPDwgMzIpIHwgbG93OwogICAgIGlmICh2YWx1ZSA8IG9y
aWcpIHsKQEAgLTk4LDkgKzk4LDkgQEAgYm9vbCBzdGF0NjRfbWluX3Nsb3coU3RhdDY0ICpzLCB1
aW50NjRfdCB2YWx1ZSkKICAgICAgICAgICogZWZmZWN0IG9uIHN0YXQ2NF9taW4gaXMgdGhhdCB0
aGUgc2xvdyBwYXRoIG1heSBiZSB0cmlnZ2VyZWQKICAgICAgICAgICogdW5uZWNlc3NhcmlseS4K
ICAgICAgICAgICovCi0gICAgICAgIGF0b21pY19zZXQoJnMtPmxvdywgKHVpbnQzMl90KXZhbHVl
KTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZzLT5sb3csICh1aW50MzJfdCl2YWx1ZSk7CiAg
ICAgICAgIHNtcF93bWIoKTsKLSAgICAgICAgYXRvbWljX3NldCgmcy0+aGlnaCwgdmFsdWUgPj4g
MzIpOworICAgICAgICBxZW11X2F0b21pY19zZXQoJnMtPmhpZ2gsIHZhbHVlID4+IDMyKTsKICAg
ICB9CiAgICAgc3RhdDY0X3dydW5sb2NrKHMpOwogICAgIHJldHVybiB0cnVlOwpAQCAtMTE2LDgg
KzExNiw4IEBAIGJvb2wgc3RhdDY0X21heF9zbG93KFN0YXQ2NCAqcywgdWludDY0X3QgdmFsdWUp
CiAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICB9CiAKLSAgICBoaWdoID0gYXRvbWljX3JlYWQo
JnMtPmhpZ2gpOwotICAgIGxvdyA9IGF0b21pY19yZWFkKCZzLT5sb3cpOworICAgIGhpZ2ggPSBx
ZW11X2F0b21pY19yZWFkKCZzLT5oaWdoKTsKKyAgICBsb3cgPSBxZW11X2F0b21pY19yZWFkKCZz
LT5sb3cpOwogCiAgICAgb3JpZyA9ICgodWludDY0X3QpaGlnaCA8PCAzMikgfCBsb3c7CiAgICAg
aWYgKHZhbHVlID4gb3JpZykgewpAQCAtMTI3LDkgKzEyNyw5IEBAIGJvb2wgc3RhdDY0X21heF9z
bG93KFN0YXQ2NCAqcywgdWludDY0X3QgdmFsdWUpCiAgICAgICAgICAqIGVmZmVjdCBvbiBzdGF0
NjRfbWF4IGlzIHRoYXQgdGhlIHNsb3cgcGF0aCBtYXkgYmUgdHJpZ2dlcmVkCiAgICAgICAgICAq
IHVubmVjZXNzYXJpbHkuCiAgICAgICAgICAqLwotICAgICAgICBhdG9taWNfc2V0KCZzLT5sb3cs
ICh1aW50MzJfdCl2YWx1ZSk7CisgICAgICAgIHFlbXVfYXRvbWljX3NldCgmcy0+bG93LCAodWlu
dDMyX3QpdmFsdWUpOwogICAgICAgICBzbXBfd21iKCk7Ci0gICAgICAgIGF0b21pY19zZXQoJnMt
PmhpZ2gsIHZhbHVlID4+IDMyKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCZzLT5oaWdoLCB2
YWx1ZSA+PiAzMik7CiAgICAgfQogICAgIHN0YXQ2NF93cnVubG9jayhzKTsKICAgICByZXR1cm4g
dHJ1ZTsKZGlmZiAtLWdpdCBhL2RvY3MvZGV2ZWwvYXRvbWljcy5yc3QgYi9kb2NzL2RldmVsL2F0
b21pY3MucnN0CmluZGV4IDQ0NWMzYjM1MDMuLjQ3ZDJmYjAzOWUgMTAwNjQ0Ci0tLSBhL2RvY3Mv
ZGV2ZWwvYXRvbWljcy5yc3QKKysrIGIvZG9jcy9kZXZlbC9hdG9taWNzLnJzdApAQCAtMjMsOSAr
MjMsOSBAQCBwcm92aWRlcyBtYWNyb3MgdGhhdCBmYWxsIGluIHRocmVlIGNhbXBzOgogCiAtIGNv
bXBpbGVyIGJhcnJpZXJzOiBgYGJhcnJpZXIoKWBgOwogCi0tIHdlYWsgYXRvbWljIGFjY2VzcyBh
bmQgbWFudWFsIG1lbW9yeSBiYXJyaWVyczogYGBhdG9taWNfcmVhZCgpYGAsCi0gIGBgYXRvbWlj
X3NldCgpYGAsIGBgc21wX3JtYigpYGAsIGBgc21wX3dtYigpYGAsIGBgc21wX21iKClgYCwgYGBz
bXBfbWJfYWNxdWlyZSgpYGAsCi0gIGBgc21wX21iX3JlbGVhc2UoKWBgLCBgYHNtcF9yZWFkX2Jh
cnJpZXJfZGVwZW5kcygpYGA7CistIHdlYWsgYXRvbWljIGFjY2VzcyBhbmQgbWFudWFsIG1lbW9y
eSBiYXJyaWVyczogYGBxZW11X2F0b21pY19yZWFkKClgYCwKKyAgYGBxZW11X2F0b21pY19zZXQo
KWBgLCBgYHNtcF9ybWIoKWBgLCBgYHNtcF93bWIoKWBgLCBgYHNtcF9tYigpYGAsCisgIGBgc21w
X21iX2FjcXVpcmUoKWBgLCBgYHNtcF9tYl9yZWxlYXNlKClgYCwgYGBzbXBfcmVhZF9iYXJyaWVy
X2RlcGVuZHMoKWBgOwogCiAtIHNlcXVlbnRpYWxseSBjb25zaXN0ZW50IGF0b21pYyBhY2Nlc3M6
IGV2ZXJ5dGhpbmcgZWxzZS4KIApAQCAtNjcsMjMgKzY3LDIzIEBAIGluIHRoZSBvcmRlciBzcGVj
aWZpZWQgYnkgaXRzIHByb2dyYW0iLgogYGBxZW11L2F0b21pYy5oYGAgcHJvdmlkZXMgdGhlIGZv
bGxvd2luZyBzZXQgb2YgYXRvbWljIHJlYWQtbW9kaWZ5LXdyaXRlCiBvcGVyYXRpb25zOjoKIAot
ICAgIHZvaWQgYXRvbWljX2luYyhwdHIpCi0gICAgdm9pZCBhdG9taWNfZGVjKHB0cikKLSAgICB2
b2lkIGF0b21pY19hZGQocHRyLCB2YWwpCi0gICAgdm9pZCBhdG9taWNfc3ViKHB0ciwgdmFsKQot
ICAgIHZvaWQgYXRvbWljX2FuZChwdHIsIHZhbCkKLSAgICB2b2lkIGF0b21pY19vcihwdHIsIHZh
bCkKKyAgICB2b2lkIHFlbXVfYXRvbWljX2luYyhwdHIpCisgICAgdm9pZCBxZW11X2F0b21pY19k
ZWMocHRyKQorICAgIHZvaWQgcWVtdV9hdG9taWNfYWRkKHB0ciwgdmFsKQorICAgIHZvaWQgcWVt
dV9hdG9taWNfc3ViKHB0ciwgdmFsKQorICAgIHZvaWQgcWVtdV9hdG9taWNfYW5kKHB0ciwgdmFs
KQorICAgIHZvaWQgcWVtdV9hdG9taWNfb3IocHRyLCB2YWwpCiAKLSAgICB0eXBlb2YoKnB0cikg
YXRvbWljX2ZldGNoX2luYyhwdHIpCi0gICAgdHlwZW9mKCpwdHIpIGF0b21pY19mZXRjaF9kZWMo
cHRyKQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNfZmV0Y2hfYWRkKHB0ciwgdmFsKQotICAgIHR5
cGVvZigqcHRyKSBhdG9taWNfZmV0Y2hfc3ViKHB0ciwgdmFsKQotICAgIHR5cGVvZigqcHRyKSBh
dG9taWNfZmV0Y2hfYW5kKHB0ciwgdmFsKQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNfZmV0Y2hf
b3IocHRyLCB2YWwpCi0gICAgdHlwZW9mKCpwdHIpIGF0b21pY19mZXRjaF94b3IocHRyLCB2YWwp
Ci0gICAgdHlwZW9mKCpwdHIpIGF0b21pY19mZXRjaF9pbmNfbm9uemVybyhwdHIpCi0gICAgdHlw
ZW9mKCpwdHIpIGF0b21pY194Y2hnKHB0ciwgdmFsKQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNf
Y21weGNoZyhwdHIsIG9sZCwgbmV3KQorICAgIHR5cGVvZigqcHRyKSBxZW11X2F0b21pY19mZXRj
aF9pbmMocHRyKQorICAgIHR5cGVvZigqcHRyKSBxZW11X2F0b21pY19mZXRjaF9kZWMocHRyKQor
ICAgIHR5cGVvZigqcHRyKSBxZW11X2F0b21pY19mZXRjaF9hZGQocHRyLCB2YWwpCisgICAgdHlw
ZW9mKCpwdHIpIHFlbXVfYXRvbWljX2ZldGNoX3N1YihwdHIsIHZhbCkKKyAgICB0eXBlb2YoKnB0
cikgcWVtdV9hdG9taWNfZmV0Y2hfYW5kKHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxZW11
X2F0b21pY19mZXRjaF9vcihwdHIsIHZhbCkKKyAgICB0eXBlb2YoKnB0cikgcWVtdV9hdG9taWNf
ZmV0Y2hfeG9yKHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxZW11X2F0b21pY19mZXRjaF9p
bmNfbm9uemVybyhwdHIpCisgICAgdHlwZW9mKCpwdHIpIHFlbXVfYXRvbWljX3hjaGcocHRyLCB2
YWwpCisgICAgdHlwZW9mKCpwdHIpIHFlbXVfYXRvbWljX2NtcHhjaGcocHRyLCBvbGQsIG5ldykK
IAogYWxsIG9mIHdoaWNoIHJldHVybiB0aGUgb2xkIHZhbHVlIG9mIGBgKnB0cmBgLiAgVGhlc2Ug
b3BlcmF0aW9ucyBhcmUKIHBvbHltb3JwaGljOyB0aGV5IG9wZXJhdGUgb24gYW55IHR5cGUgdGhh
dCBpcyBhcyB3aWRlIGFzIGEgcG9pbnRlciBvcgpAQCAtOTEsMTkgKzkxLDE5IEBAIHNtYWxsZXIu
CiAKIFNpbWlsYXIgb3BlcmF0aW9ucyByZXR1cm4gdGhlIG5ldyB2YWx1ZSBvZiBgYCpwdHJgYDo6
CiAKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX2luY19mZXRjaChwdHIpCi0gICAgdHlwZW9mKCpw
dHIpIGF0b21pY19kZWNfZmV0Y2gocHRyKQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNfYWRkX2Zl
dGNoKHB0ciwgdmFsKQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNfc3ViX2ZldGNoKHB0ciwgdmFs
KQotICAgIHR5cGVvZigqcHRyKSBhdG9taWNfYW5kX2ZldGNoKHB0ciwgdmFsKQotICAgIHR5cGVv
ZigqcHRyKSBhdG9taWNfb3JfZmV0Y2gocHRyLCB2YWwpCi0gICAgdHlwZW9mKCpwdHIpIGF0b21p
Y194b3JfZmV0Y2gocHRyLCB2YWwpCisgICAgdHlwZW9mKCpwdHIpIHFlbXVfYXRvbWljX2luY19m
ZXRjaChwdHIpCisgICAgdHlwZW9mKCpwdHIpIHFlbXVfYXRvbWljX2RlY19mZXRjaChwdHIpCisg
ICAgdHlwZW9mKCpwdHIpIHFlbXVfYXRvbWljX2FkZF9mZXRjaChwdHIsIHZhbCkKKyAgICB0eXBl
b2YoKnB0cikgcWVtdV9hdG9taWNfc3ViX2ZldGNoKHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRy
KSBxZW11X2F0b21pY19hbmRfZmV0Y2gocHRyLCB2YWwpCisgICAgdHlwZW9mKCpwdHIpIHFlbXVf
YXRvbWljX29yX2ZldGNoKHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxZW11X2F0b21pY194
b3JfZmV0Y2gocHRyLCB2YWwpCiAKIGBgcWVtdS9hdG9taWMuaGBgIGFsc28gcHJvdmlkZXMgbG9h
ZHMgYW5kIHN0b3JlcyB0aGF0IGNhbm5vdCBiZSByZW9yZGVyZWQKIHdpdGggZWFjaCBvdGhlcjo6
CiAKLSAgICB0eXBlb2YoKnB0cikgYXRvbWljX21iX3JlYWQocHRyKQotICAgIHZvaWQgICAgICAg
ICBhdG9taWNfbWJfc2V0KHB0ciwgdmFsKQorICAgIHR5cGVvZigqcHRyKSBxZW11X2F0b21pY19t
Yl9yZWFkKHB0cikKKyAgICB2b2lkICAgICAgICAgcWVtdV9hdG9taWNfbWJfc2V0KHB0ciwgdmFs
KQogCiBIb3dldmVyIHRoZXNlIGRvIG5vdCBwcm92aWRlIHNlcXVlbnRpYWwgY29uc2lzdGVuY3kg
YW5kLCBpbiBwYXJ0aWN1bGFyLAogdGhleSBkbyBub3QgcGFydGljaXBhdGUgaW4gdGhlIHRvdGFs
IG9yZGVyaW5nIGVuZm9yY2VkIGJ5CkBAIC0xMTUsMTIgKzExNSwxMiBAQCBlYXNpZXN0IHRvIGhh
cmRlc3QpOgogCiAtIGxpZ2h0d2VpZ2h0IHN5bmNocm9uaXphdGlvbiBwcmltaXRpdmVzIHN1Y2gg
YXMgYGBRZW11RXZlbnRgYAogCi0tIFJDVSBvcGVyYXRpb25zIChgYGF0b21pY19yY3VfcmVhZGBg
LCBgYGF0b21pY19yY3Vfc2V0YGApIHdoZW4gcHVibGlzaGluZwotICBvciBhY2Nlc3NpbmcgYSBu
ZXcgdmVyc2lvbiBvZiBhIGRhdGEgc3RydWN0dXJlCistIFJDVSBvcGVyYXRpb25zIChgYHFlbXVf
YXRvbWljX3JjdV9yZWFkYGAsIGBgcWVtdV9hdG9taWNfcmN1X3NldGBgKSB3aGVuCisgIHB1Ymxp
c2hpbmcgb3IgYWNjZXNzaW5nIGEgbmV3IHZlcnNpb24gb2YgYSBkYXRhIHN0cnVjdHVyZQogCi0t
IG90aGVyIGF0b21pYyBhY2Nlc3NlczogYGBhdG9taWNfcmVhZGBgIGFuZCBgYGF0b21pY19sb2Fk
X2FjcXVpcmVgYCBmb3IKLSAgbG9hZHMsIGBgYXRvbWljX3NldGBgIGFuZCBgYGF0b21pY19zdG9y
ZV9yZWxlYXNlYGAgZm9yIHN0b3JlcywgYGBzbXBfbWJgYAotICB0byBmb3JiaWQgcmVvcmRlcmlu
ZyBzdWJzZXF1ZW50IGxvYWRzIGJlZm9yZSBhIHN0b3JlLgorLSBvdGhlciBhdG9taWMgYWNjZXNz
ZXM6IGBgcWVtdV9hdG9taWNfcmVhZGBgIGFuZCBgYHFlbXVfYXRvbWljX2xvYWRfYWNxdWlyZWBg
CisgIGZvciBsb2FkcywgYGBxZW11X2F0b21pY19zZXRgYCBhbmQgYGBxZW11X2F0b21pY19zdG9y
ZV9yZWxlYXNlYGAgZm9yIHN0b3JlcywKKyAgYGBzbXBfbWJgYCB0byBmb3JiaWQgcmVvcmRlcmlu
ZyBzdWJzZXF1ZW50IGxvYWRzIGJlZm9yZSBhIHN0b3JlLgogCiAKIFdlYWsgYXRvbWljIGFjY2Vz
cyBhbmQgbWFudWFsIG1lbW9yeSBiYXJyaWVycwpAQCAtMTQ5LDIyICsxNDksMjIgQEAgVGhlIG9u
bHkgZ3VhcmFudGVlcyB0aGF0IHlvdSBjYW4gcmVseSB1cG9uIGluIHRoaXMgY2FzZSBhcmU6CiAK
IFdoZW4gdXNpbmcgdGhpcyBtb2RlbCwgdmFyaWFibGVzIGFyZSBhY2Nlc3NlZCB3aXRoOgogCi0t
IGBgYXRvbWljX3JlYWQoKWBgIGFuZCBgYGF0b21pY19zZXQoKWBgOyB0aGVzZSBwcmV2ZW50IHRo
ZSBjb21waWxlciBmcm9tCi0gIG9wdGltaXppbmcgYWNjZXNzZXMgb3V0IG9mIGV4aXN0ZW5jZSBh
bmQgY3JlYXRpbmcgdW5zb2xpY2l0ZWQKKy0gYGBxZW11X2F0b21pY19yZWFkKClgYCBhbmQgYGBx
ZW11X2F0b21pY19zZXQoKWBgOyB0aGVzZSBwcmV2ZW50IHRoZSBjb21waWxlcgorICBmcm9tIG9w
dGltaXppbmcgYWNjZXNzZXMgb3V0IG9mIGV4aXN0ZW5jZSBhbmQgY3JlYXRpbmcgdW5zb2xpY2l0
ZWQKICAgYWNjZXNzZXMsIGJ1dCBkbyBub3Qgb3RoZXJ3aXNlIGltcG9zZSBhbnkgb3JkZXJpbmcg
b24gbG9hZHMgYW5kCiAgIHN0b3JlczogYm90aCB0aGUgY29tcGlsZXIgYW5kIHRoZSBwcm9jZXNz
b3IgYXJlIGZyZWUgdG8gcmVvcmRlcgogICB0aGVtLgogCi0tIGBgYXRvbWljX2xvYWRfYWNxdWly
ZSgpYGAsIHdoaWNoIGd1YXJhbnRlZXMgdGhlIExPQUQgdG8gYXBwZWFyIHRvCistIGBgcWVtdV9h
dG9taWNfbG9hZF9hY3F1aXJlKClgYCwgd2hpY2ggZ3VhcmFudGVlcyB0aGUgTE9BRCB0byBhcHBl
YXIgdG8KICAgaGFwcGVuLCB3aXRoIHJlc3BlY3QgdG8gdGhlIG90aGVyIGNvbXBvbmVudHMgb2Yg
dGhlIHN5c3RlbSwKICAgYmVmb3JlIGFsbCB0aGUgTE9BRCBvciBTVE9SRSBvcGVyYXRpb25zIHNw
ZWNpZmllZCBhZnRlcndhcmRzLgotICBPcGVyYXRpb25zIGNvbWluZyBiZWZvcmUgYGBhdG9taWNf
bG9hZF9hY3F1aXJlKClgYCBjYW4gc3RpbGwgYmUKKyAgT3BlcmF0aW9ucyBjb21pbmcgYmVmb3Jl
IGBgcWVtdV9hdG9taWNfbG9hZF9hY3F1aXJlKClgYCBjYW4gc3RpbGwgYmUKICAgcmVvcmRlcmVk
IGFmdGVyIGl0LgogCi0tIGBgYXRvbWljX3N0b3JlX3JlbGVhc2UoKWBgLCB3aGljaCBndWFyYW50
ZWVzIHRoZSBTVE9SRSB0byBhcHBlYXIgdG8KKy0gYGBxZW11X2F0b21pY19zdG9yZV9yZWxlYXNl
KClgYCwgd2hpY2ggZ3VhcmFudGVlcyB0aGUgU1RPUkUgdG8gYXBwZWFyIHRvCiAgIGhhcHBlbiwg
d2l0aCByZXNwZWN0IHRvIHRoZSBvdGhlciBjb21wb25lbnRzIG9mIHRoZSBzeXN0ZW0sCiAgIGFm
dGVyIGFsbCB0aGUgTE9BRCBvciBTVE9SRSBvcGVyYXRpb25zIHNwZWNpZmllZCBiZWZvcmUuCi0g
IE9wZXJhdGlvbnMgY29taW5nIGFmdGVyIGBgYXRvbWljX3N0b3JlX3JlbGVhc2UoKWBgIGNhbiBz
dGlsbCBiZQorICBPcGVyYXRpb25zIGNvbWluZyBhZnRlciBgYHFlbXVfYXRvbWljX3N0b3JlX3Jl
bGVhc2UoKWBgIGNhbiBzdGlsbCBiZQogICByZW9yZGVyZWQgYmVmb3JlIGl0LgogCiBSZXN0cmlj
dGlvbnMgdG8gdGhlIG9yZGVyaW5nIG9mIGFjY2Vzc2VzIGNhbiBhbHNvIGJlIHNwZWNpZmllZApA
QCAtMjI5LDE4ICsyMjksMTggQEAgVGhleSBjb21lIGluIHNpeCBraW5kczoKICAgZGVwZW5kZW5j
eSBhbmQgYSBmdWxsIHJlYWQgYmFycmllciBvciBiZXR0ZXIgaXMgcmVxdWlyZWQuCiAKIAotTWVt
b3J5IGJhcnJpZXJzIGFuZCBgYGF0b21pY19sb2FkX2FjcXVpcmVgYC9gYGF0b21pY19zdG9yZV9y
ZWxlYXNlYGAgYXJlCi1tb3N0bHkgdXNlZCB3aGVuIGEgZGF0YSBzdHJ1Y3R1cmUgaGFzIG9uZSB0
aHJlYWQgdGhhdCBpcyBhbHdheXMgYSB3cml0ZXIKK01lbW9yeSBiYXJyaWVycyBhbmQgYGBxZW11
X2F0b21pY19sb2FkX2FjcXVpcmVgYC9gYHFlbXVfYXRvbWljX3N0b3JlX3JlbGVhc2VgYAorYXJl
IG1vc3RseSB1c2VkIHdoZW4gYSBkYXRhIHN0cnVjdHVyZSBoYXMgb25lIHRocmVhZCB0aGF0IGlz
IGFsd2F5cyBhIHdyaXRlcgogYW5kIG9uZSB0aHJlYWQgdGhhdCBpcyBhbHdheXMgYSByZWFkZXI6
CiAKLSAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tKwotICAgIHwgdGhyZWFkIDEgICAgICAgICAgICAgICAgICAg
ICAgICAgfCB0aHJlYWQgMiAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAgKz09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PSsKLSAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgOjogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAgfCAgIGF0
b21pY19zdG9yZV9yZWxlYXNlKCZhLCB4KTsgICB8ICAgeSA9IGF0b21pY19sb2FkX2FjcXVpcmUo
JmIpOyAgIHwKLSAgICB8ICAgYXRvbWljX3N0b3JlX3JlbGVhc2UoJmIsIHkpOyAgIHwgICB4ID0g
YXRvbWljX2xvYWRfYWNxdWlyZSgmYSk7ICAgfAotICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgICAgKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgICAgfCB0aHJlYWQgMSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgdGhyZWFkIDIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgICAg
Kz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSs9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0rCisgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Cisg
ICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgfCAgIHFlbXVfYXRvbWljX3N0b3JlX3Jl
bGVhc2UoJmEsIHgpOyAgIHwgICB5ID0gcWVtdV9hdG9taWNfbG9hZF9hY3F1aXJlKCZiKTsgICB8
CisgICAgfCAgIHFlbXVfYXRvbWljX3N0b3JlX3JlbGVhc2UoJmIsIHkpOyAgIHwgICB4ID0gcWVt
dV9hdG9taWNfbG9hZF9hY3F1aXJlKCZhKTsgICB8CisgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0rCiAKIEluIHRoaXMgY2FzZSwgY29ycmVjdG5lc3MgaXMgZWFzeSB0byBjaGVjayBmb3IgdXNp
bmcgdGhlICJwYWlyaW5nIgogdHJpY2sgdGhhdCBpcyBleHBsYWluZWQgYmVsb3cuCkBAIC0yNTEs
NTQgKzI1MSw1NCBAQCB0aHJlYWQsIGV4YWN0bHkgb25lIG90aGVyIHRocmVhZCB3aWxsIHJlYWQg
b3Igd3JpdGUgZWFjaCBvZiB0aGVzZQogdmFyaWFibGVzKS4gIEluIHRoaXMgY2FzZSwgaXQgaXMg
cG9zc2libGUgdG8gImhvaXN0IiB0aGUgYmFycmllcnMKIG91dHNpZGUgYSBsb29wLiAgRm9yIGV4
YW1wbGU6CiAKLSAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
Ky0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCi0gICAgfCBiZWZvcmUgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYWZ0ZXIgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfAotICAgICs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0r
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKLSAgICB8IDo6ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8Ci0gICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgIHwgICBuID0gMDsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgbiA9IDA7ICAgICAgICAgICAgICAgICAgICAg
ICAgIHwKLSAgICB8ICAgZm9yIChpID0gMDsgaSA8IDEwOyBpKyspICAgICAgICAgICAgICAgfCAg
IGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAgICAgICB8Ci0gICAgfCAgICAgbiArPSBhdG9taWNf
bG9hZF9hY3F1aXJlKCZhW2ldKTsgICAgIHwgICAgIG4gKz0gYXRvbWljX3JlYWQoJmFbaV0pOyAg
ICAgfAotICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAg
c21wX21iX2FjcXVpcmUoKTsgICAgICAgICAgICAgIHwKLSAgICArLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0rCi0gICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgOjog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgIHwgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwKLSAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIHNt
cF9tYl9yZWxlYXNlKCk7ICAgICAgICAgICAgICB8Ci0gICAgfCAgIGZvciAoaSA9IDA7IGkgPCAx
MDsgaSsrKSAgICAgICAgICAgICAgIHwgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgICAgICAg
fAotICAgIHwgICAgIGF0b21pY19zdG9yZV9yZWxlYXNlKCZhW2ldLCBmYWxzZSk7ICB8ICAgICBh
dG9taWNfc2V0KCZhW2ldLCBmYWxzZSk7ICAgIHwKLSAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0r
CisgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAgICB8IGJlZm9yZSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGFmdGVyICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfAorICAgICs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PSs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0r
CisgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCA6
OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKKyAgICB8ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfAorICAgIHwgICBuID0gMDsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICBuID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
CisgICAgfCAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAgICAgICAgICAgICAgICAgICAgfCAg
IGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAgICAgICAgICAgIHwKKyAgICB8ICAgICBuICs9IHFl
bXVfYXRvbWljX2xvYWRfYWNxdWlyZSgmYVtpXSk7ICAgICB8ICAgICBuICs9IHFlbXVfYXRvbWlj
X3JlYWQoJmFbaV0pOyAgICAgfAorICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICBzbXBfbWJfYWNxdWlyZSgpOyAgICAgICAgICAgICAgICAgICB8
CisgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAgICB8IDo6ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IDo6ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfAorICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
CisgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAg
IHNtcF9tYl9yZWxlYXNlKCk7ICAgICAgICAgICAgICAgICAgIHwKKyAgICB8ICAgZm9yIChpID0g
MDsgaSA8IDEwOyBpKyspICAgICAgICAgICAgICAgICAgICB8ICAgZm9yIChpID0gMDsgaSA8IDEw
OyBpKyspICAgICAgICAgICAgfAorICAgIHwgICAgIHFlbXVfYXRvbWljX3N0b3JlX3JlbGVhc2Uo
JmFbaV0sIGZhbHNlKTsgIHwgICAgIHFlbXVfYXRvbWljX3NldCgmYVtpXSwgZmFsc2UpOyAgICB8
CisgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKIAogU3BsaXR0aW5nIGEgbG9v
cCBjYW4gYWxzbyBiZSB1c2VmdWwgdG8gcmVkdWNlIHRoZSBudW1iZXIgb2YgYmFycmllcnM6CiAK
LSAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCi0gICAgfCBiZWZvcmUgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgYWZ0ZXIgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAot
ICAgICs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PSsKLSAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0g
ICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgIHwgICBuID0gMDsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgICBzbXBfbWJfcmVsZWFzZSgpOyAgICAgICAgICAgIHwKLSAg
ICB8ICAgZm9yIChpID0gMDsgaSA8IDEwOyBpKyspIHsgICAgICAgICAgICAgfCAgICAgZm9yIChp
ID0gMDsgaSA8IDEwOyBpKyspICAgICB8Ci0gICAgfCAgICAgYXRvbWljX3N0b3JlX3JlbGVhc2Uo
JmFbaV0sIGZhbHNlKTsgIHwgICAgICAgYXRvbWljX3NldCgmYVtpXSwgZmFsc2UpOyAgfAotICAg
IHwgICAgIHNtcF9tYigpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICBzbWJfbWIo
KTsgICAgICAgICAgICAgICAgICAgIHwKLSAgICB8ICAgICBuICs9IGF0b21pY19yZWFkKCZiW2ld
KTsgICAgICAgICAgICAgfCAgICAgbiA9IDA7ICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAg
fCAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgIGZvciAoaSA9
IDA7IGkgPCAxMDsgaSsrKSAgICAgfAotICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8ICAgICAgIG4gKz0gYXRvbWljX3JlYWQoJmJbaV0pOyAgIHwKLSAgICAr
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LSsKKyAgICB8IGJlZm9yZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
IGFmdGVyICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAorICAgICs9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSs9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0rCisgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwKKyAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAorICAgIHwgICBuID0gMDsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgIHNtcF9tYl9yZWxlYXNl
KCk7ICAgICAgICAgICAgICAgICB8CisgICAgfCAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSB7
ICAgICAgICAgICAgICAgICAgfCAgICAgZm9yIChpID0gMDsgaSA8IDEwOyBpKyspICAgICAgICAg
IHwKKyAgICB8ICAgICBxZW11X2F0b21pY19zdG9yZV9yZWxlYXNlKCZhW2ldLCBmYWxzZSk7ICB8
ICAgICAgIHFlbXVfYXRvbWljX3NldCgmYVtpXSwgZmFsc2UpOyAgfAorICAgIHwgICAgIHNtcF9t
YigpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgIHNtYl9tYigpOyAgICAg
ICAgICAgICAgICAgICAgICAgICB8CisgICAgfCAgICAgbiArPSBxZW11X2F0b21pY19yZWFkKCZi
W2ldKTsgICAgICAgICAgICAgfCAgICAgbiA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwKKyAgICB8ICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
ICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgICAgICAgICAgfAorICAgIHwgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgbiArPSBxZW11X2F0
b21pY19yZWFkKCZiW2ldKTsgICB8CisgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LSsKIAogSW4gdGhpcyBjYXNlLCBhIGBgc21wX21iX3JlbGVhc2UoKWBgIGlzIGFsc28gcmVwbGFj
ZWQgd2l0aCBhIChwb3NzaWJseSBjaGVhcGVyLCBhbmQgY2xlYXJlcgogYXMgd2VsbCkgYGBzbXBf
d21iKClgYDoKIAotICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKLSAgICB8IGJlZm9yZSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBhZnRlciAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB8Ci0gICAgKz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PSs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KwotICAgIHwgOjogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwKLSAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gICAgfCAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgIHNtcF9tYl9yZWxlYXNlKCk7ICAgICAg
ICAgICAgfAotICAgIHwgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgeyAgICAgICAgICAgICB8
ICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgICAgIHwKLSAgICB8ICAgICBhdG9taWNfc3Rv
cmVfcmVsZWFzZSgmYVtpXSwgZmFsc2UpOyAgfCAgICAgICBhdG9taWNfc2V0KCZhW2ldLCBmYWxz
ZSk7ICB8Ci0gICAgfCAgICAgYXRvbWljX3N0b3JlX3JlbGVhc2UoJmJbaV0sIGZhbHNlKTsgIHwg
ICAgIHNtYl93bWIoKTsgICAgICAgICAgICAgICAgICAgfAotICAgIHwgICB9ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykg
ICAgIHwKLSAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAg
ICAgICBhdG9taWNfc2V0KCZiW2ldLCBmYWxzZSk7ICB8Ci0gICAgKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tKworICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgICAgfCBiZWZvcmUg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBhZnRlciAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwKKyAgICArPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09KworICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgfCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwKKyAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8ICAgICBzbXBfbWJfcmVsZWFzZSgpOyAgICAgICAgICAgICAg
ICAgfAorICAgIHwgICBmb3IgKGkgPSAwOyBpIDwgMTA7IGkrKykgeyAgICAgICAgICAgICAgICAg
IHwgICAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAgICAgICAgICB8CisgICAgfCAgICAgcWVt
dV9hdG9taWNfc3RvcmVfcmVsZWFzZSgmYVtpXSwgZmFsc2UpOyAgfCAgICAgICBxZW11X2F0b21p
Y19zZXQoJmFbaV0sIGZhbHNlKTsgIHwKKyAgICB8ICAgICBxZW11X2F0b21pY19zdG9yZV9yZWxl
YXNlKCZiW2ldLCBmYWxzZSk7ICB8ICAgICBzbWJfd21iKCk7ICAgICAgICAgICAgICAgICAgICAg
ICAgfAorICAgIHwgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgICAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSAgICAgICAgICB8CisgICAgfCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICBxZW11X2F0b21p
Y19zZXQoJmJbaV0sIGZhbHNlKTsgIHwKKyAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tKwogCiAKIC4uIF9hY3FyZWw6CkBAIC0zMDYsOCArMzA2LDggQEAgYXMgd2VsbCkgYGBzbXBf
d21iKClgYDoKIEFjcXVpcmUvcmVsZWFzZSBwYWlyaW5nIGFuZCB0aGUgKnN5bmNocm9uaXplcy13
aXRoKiByZWxhdGlvbgogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCiAKLUF0b21pYyBvcGVyYXRpb25zIG90aGVyIHRoYW4gYGBhdG9t
aWNfc2V0KClgYCBhbmQgYGBhdG9taWNfcmVhZCgpYGAgaGF2ZQotZWl0aGVyICphY3F1aXJlKiBv
ciAqcmVsZWFzZSogc2VtYW50aWNzIFsjcm13XV8uICBUaGlzIGhhcyB0d28gZWZmZWN0czoKK0F0
b21pYyBvcGVyYXRpb25zIG90aGVyIHRoYW4gYGBxZW11X2F0b21pY19zZXQoKWBgIGFuZCBgYHFl
bXVfYXRvbWljX3JlYWQoKWBgCitoYXZlIGVpdGhlciAqYWNxdWlyZSogb3IgKnJlbGVhc2UqIHNl
bWFudGljcyBbI3Jtd11fLiAgVGhpcyBoYXMgdHdvIGVmZmVjdHM6CiAKIC4uIFsjcm13XSBSZWFk
LW1vZGlmeS13cml0ZSBvcGVyYXRpb25zIGNhbiBoYXZlIGJvdGgtLS1hY3F1aXJlIGFwcGxpZXMg
dG8gdGhlCiAgICAgICAgICAgcmVhZCBwYXJ0LCBhbmQgcmVsZWFzZSB0byB0aGUgd3JpdGUuCkBA
IC0zNTcsMzAgKzM1NywzMCBAQCB0aHJlYWQgMiBpcyByZWx5aW5nIG9uIHRoZSAqc3luY2hyb25p
emVzLXdpdGgqIHJlbGF0aW9uIGJldHdlZW4gYGBwdGhyZWFkX2V4aXRgYAogCiBTeW5jaHJvbml6
YXRpb24gYmV0d2VlbiB0aHJlYWRzIGJhc2ljYWxseSBkZXNjZW5kcyBmcm9tIHRoaXMgcGFpcmlu
ZyBvZgogYSByZWxlYXNlIG9wZXJhdGlvbiBhbmQgYW4gYWNxdWlyZSBvcGVyYXRpb24uICBUaGVy
ZWZvcmUsIGF0b21pYyBvcGVyYXRpb25zCi1vdGhlciB0aGFuIGBgYXRvbWljX3NldCgpYGAgYW5k
IGBgYXRvbWljX3JlYWQoKWBgIHdpbGwgYWxtb3N0IGFsd2F5cyBiZQotcGFpcmVkIHdpdGggYW5v
dGhlciBvcGVyYXRpb24gb2YgdGhlIG9wcG9zaXRlIGtpbmQ6IGFuIGFjcXVpcmUgb3BlcmF0aW9u
CitvdGhlciB0aGFuIGBgcWVtdV9hdG9taWNfc2V0KClgYCBhbmQgYGBxZW11X2F0b21pY19yZWFk
KClgYCB3aWxsIGFsbW9zdCBhbHdheXMKK2JlIHBhaXJlZCB3aXRoIGFub3RoZXIgb3BlcmF0aW9u
IG9mIHRoZSBvcHBvc2l0ZSBraW5kOiBhbiBhY3F1aXJlIG9wZXJhdGlvbgogd2lsbCBwYWlyIHdp
dGggYSByZWxlYXNlIG9wZXJhdGlvbiBhbmQgdmljZSB2ZXJzYS4gIFRoaXMgcnVsZSBvZiB0aHVt
YiBpcwogZXh0cmVtZWx5IHVzZWZ1bDsgaW4gdGhlIGNhc2Ugb2YgUUVNVSwgaG93ZXZlciwgbm90
ZSB0aGF0IHRoZSBvdGhlcgogb3BlcmF0aW9uIG1heSBhY3R1YWxseSBiZSBpbiBhIGRyaXZlciB0
aGF0IHJ1bnMgaW4gdGhlIGd1ZXN0IQogCiBgYHNtcF9yZWFkX2JhcnJpZXJfZGVwZW5kcygpYGAs
IGBgc21wX3JtYigpYGAsIGBgc21wX21iX2FjcXVpcmUoKWBgLAotYGBhdG9taWNfbG9hZF9hY3F1
aXJlKClgYCBhbmQgYGBhdG9taWNfcmN1X3JlYWQoKWBgIGFsbCBjb3VudAorYGBxZW11X2F0b21p
Y19sb2FkX2FjcXVpcmUoKWBgIGFuZCBgYHFlbXVfYXRvbWljX3JjdV9yZWFkKClgYCBhbGwgY291
bnQKIGFzIGFjcXVpcmUgb3BlcmF0aW9ucy4gIGBgc21wX3dtYigpYGAsIGBgc21wX21iX3JlbGVh
c2UoKWBgLAotYGBhdG9taWNfc3RvcmVfcmVsZWFzZSgpYGAgYW5kIGBgYXRvbWljX3JjdV9zZXQo
KWBgIGFsbCBjb3VudCBhcyByZWxlYXNlCi1vcGVyYXRpb25zLiAgYGBzbXBfbWIoKWBgIGNvdW50
cyBhcyBib3RoIGFjcXVpcmUgYW5kIHJlbGVhc2UsIHRoZXJlZm9yZQorYGBxZW11X2F0b21pY19z
dG9yZV9yZWxlYXNlKClgYCBhbmQgYGBxZW11X2F0b21pY19yY3Vfc2V0KClgYCBhbGwgY291bnQg
YXMKK3JlbGVhc2Ugb3BlcmF0aW9ucy4gIGBgc21wX21iKClgYCBjb3VudHMgYXMgYm90aCBhY3F1
aXJlIGFuZCByZWxlYXNlLCB0aGVyZWZvcmUKIGl0IGNhbiBwYWlyIHdpdGggYW55IG90aGVyIGF0
b21pYyBvcGVyYXRpb24uICBIZXJlIGlzIGFuIGV4YW1wbGU6CiAKLSAgICAgICstLS0tLS0tLS0t
LS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKLSAgICAgIHwgdGhy
ZWFkIDEgICAgICAgICAgICAgfCB0aHJlYWQgMiAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAg
ICs9PT09PT09PT09PT09PT09PT09PT09Kz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsK
LSAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHwKLSAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwKLSAgICAgIHwgICBhdG9taWNfc2V0KCZhLCAxKTsgfCAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICBzbXBfd21iKCk7ICAgICAgICAgfCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICBhdG9taWNfc2V0KCZiLCAyKTsgfCAg
IHggPSBhdG9taWNfcmVhZCgmYik7ICAgICAgIHwKLSAgICAgIHwgICAgICAgICAgICAgICAgICAg
ICAgfCAgIHNtcF9ybWIoKTsgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICAgICAgICAgICAg
ICAgICAgICAgfCAgIHkgPSBhdG9taWNfcmVhZCgmYSk7ICAgICAgIHwKLSAgICAgICstLS0tLS0t
LS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAgICAgICst
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
KworICAgICAgfCB0aHJlYWQgMSAgICAgICAgICAgICAgICAgIHwgdGhyZWFkIDIgICAgICAgICAg
ICAgICAgICAgICB8CisgICAgICArPT09PT09PT09PT09PT09PT09PT09PT09PT09Kz09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PSsKKyAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAg
ICB8IDo6ICAgICAgICAgICAgICAgICAgICAgICAgICAgfAorICAgICAgfCAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgICB8ICAg
cWVtdV9hdG9taWNfc2V0KCZhLCAxKTsgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwK
KyAgICAgIHwgICBzbXBfd21iKCk7ICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfAorICAgICAgfCAgIHFlbXVfYXRvbWljX3NldCgmYiwgMik7IHwgICB4ID0gcWVt
dV9hdG9taWNfcmVhZCgmYik7ICB8CisgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgIHNtcF9ybWIoKTsgICAgICAgICAgICAgICAgIHwKKyAgICAgIHwgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgeSA9IHFlbXVfYXRvbWljX3JlYWQoJmEpOyAgfAorICAgICAgKy0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAK
IE5vdGUgdGhhdCBhIGxvYWQtc3RvcmUgcGFpciBvbmx5IGNvdW50cyBpZiB0aGUgdHdvIG9wZXJh
dGlvbnMgYWNjZXNzIHRoZQogc2FtZSB2YXJpYWJsZTogdGhhdCBpcywgYSBzdG9yZS1yZWxlYXNl
IG9uIGEgdmFyaWFibGUgYGB4YGAgKnN5bmNocm9uaXplcwpAQCAtMzg4LDE1ICszODgsMTUgQEAg
d2l0aCogYSBsb2FkLWFjcXVpcmUgb24gYSB2YXJpYWJsZSBgYHhgYCwgd2hpbGUgYSByZWxlYXNl
IGJhcnJpZXIKIHN5bmNocm9uaXplcyB3aXRoIGFueSBhY3F1aXJlIG9wZXJhdGlvbi4gIFRoZSBm
b2xsb3dpbmcgZXhhbXBsZSBzaG93cwogY29ycmVjdCBzeW5jaHJvbml6YXRpb246CiAKLSAgICAg
ICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLSsKLSAgICAgIHwgdGhyZWFkIDEgICAgICAgICAgICAgICAgICAgICAgIHwgdGhy
ZWFkIDIgICAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAgICs9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PSs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKLSAgICAgIHwg
OjogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwKLSAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICBhdG9taWNfc2V0KCZhLCAxKTsg
ICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICBh
dG9taWNfc3RvcmVfcmVsZWFzZSgmYiwgMik7IHwgICB4ID0gYXRvbWljX2xvYWRfYWNxdWlyZSgm
Yik7IHwKLSAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICB5ID0gYXRv
bWljX3JlYWQoJmEpOyAgICAgICAgIHwKLSAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKKyAgICAgICstLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0rCisgICAgICB8IHRocmVhZCAxICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgdGhyZWFkIDIgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAorICAgICAgKz09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PSsKKyAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCA6OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgICB8ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfAorICAgICAgfCAgIHFlbXVfYXRvbWljX3NldCgmYSwgMSk7ICAgICAgICAgICB8
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKKyAgICAgIHwgICBxZW11X2F0
b21pY19zdG9yZV9yZWxlYXNlKCZiLCAyKTsgfCAgIHggPSBxZW11X2F0b21pY19sb2FkX2FjcXVp
cmUoJmIpOyB8CisgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
ICB5ID0gcWVtdV9hdG9taWNfcmVhZCgmYSk7ICAgICAgICAgfAorICAgICAgKy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSsKIAogQWNxdWlyZSBhbmQgcmVsZWFzZSBzZW1hbnRpY3Mgb2YgaGlnaGVyLWxldmVs
IHByaW1pdGl2ZXMgY2FuIGFsc28gYmUKIHJlbGllZCB1cG9uIGZvciB0aGUgcHVycG9zZSBvZiBl
c3RhYmxpc2hpbmcgdGhlICpzeW5jaHJvbml6ZXMgd2l0aCoKQEAgLTQxMiwyMSArNDEyLDIxIEBA
IEZpbmFsbHksIHRoaXMgbW9yZSBjb21wbGV4IGV4YW1wbGUgaGFzIG1vcmUgdGhhbiB0d28gYWNj
ZXNzZXMgYW5kIGRhdGEKIGRlcGVuZGVuY3kgYmFycmllcnMuICBJdCBhbHNvIGRvZXMgbm90IHVz
ZSBhdG9taWMgYWNjZXNzZXMgd2hlbmV2ZXIgdGhlcmUKIGNhbm5vdCBiZSBhIGRhdGEgcmFjZToK
IAotICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tKwotICAgICAgfCB0aHJlYWQgMSAgICAgICAgICAgICB8IHRocmVhZCAyICAgICAgICAg
ICAgICAgICAgICAgfAotICAgICAgKz09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09KwotICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICB8IDo6ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgICAgfCAgIGJbMl0gPSAxOyAgICAg
ICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgICAgfCAgIHNtcF93bWIo
KTsgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgICAgfCAgIHgt
PmkgPSAyOyAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAgICAg
fCAgIHNtcF93bWIoKTsgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAot
ICAgICAgfCAgIGF0b21pY19zZXQoJmEsIHgpOyB8ICB4ID0gYXRvbWljX3JlYWQoJmEpOyAgICAg
ICAgfAotICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICBzbXBfcmVhZF9iYXJyaWVyX2Rl
cGVuZHMoKTsgfAotICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICB5ID0geC0+aTsgICAg
ICAgICAgICAgICAgICAgfAotICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICBzbXBfcmVh
ZF9iYXJyaWVyX2RlcGVuZHMoKTsgfAotICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICB6
ID0gYlt5XTsgICAgICAgICAgICAgICAgICAgfAotICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKworICAgICAgKy0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgICAgICB8IHRo
cmVhZCAxICAgICAgICAgICAgICAgICAgfCB0aHJlYWQgMiAgICAgICAgICAgICAgICAgICAgIHwK
KyAgICAgICs9PT09PT09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09KworICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAgIHwgOjogICAgICAg
ICAgICAgICAgICAgICAgICAgICB8CisgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKKyAgICAgIHwgICBiWzJdID0gMTsgICAg
ICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAorICAgICAgfCAgIHNt
cF93bWIoKTsgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Cisg
ICAgICB8ICAgeC0+aSA9IDI7ICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwKKyAgICAgIHwgICBzbXBfd21iKCk7ICAgICAgICAgICAgICB8ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfAorICAgICAgfCAgIHFlbXVfYXRvbWljX3NldCgmYSwgeCk7IHwg
IHggPSBxZW11X2F0b21pY19yZWFkKCZhKTsgICB8CisgICAgICB8ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgc21wX3JlYWRfYmFycmllcl9kZXBlbmRzKCk7IHwKKyAgICAgIHwgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8ICB5ID0geC0+aTsgICAgICAgICAgICAgICAgICAgfAorICAg
ICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIHNtcF9yZWFkX2JhcnJpZXJfZGVwZW5k
cygpOyB8CisgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgeiA9IGJbeV07ICAg
ICAgICAgICAgICAgICAgIHwKKyAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKwogCiBDb21wYXJpc29uIHdpdGggTGludXgga2Vy
bmVsIHByaW1pdGl2ZXMKID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpA
QCAtNDM4LDMwICs0MzgsMzAgQEAgYW5kIG1lbW9yeSBiYXJyaWVycywgYW5kIHRoZSBlcXVpdmFs
ZW50cyBpbiBRRU1VOgogICB1c2UgYSBib3hlZCBgYGF0b21pY190YGAgdHlwZTsgYXRvbWljIG9w
ZXJhdGlvbnMgaW4gUUVNVSBhcmUgcG9seW1vcnBoaWMKICAgYW5kIHVzZSBub3JtYWwgQyB0eXBl
cy4KIAotLSBPcmlnaW5hbGx5LCBgYGF0b21pY19yZWFkYGAgYW5kIGBgYXRvbWljX3NldGBgIGlu
IExpbnV4IGdhdmUgbm8gZ3VhcmFudGVlCi0gIGF0IGFsbC4gTGludXggNC4xIHVwZGF0ZWQgdGhl
bSB0byBpbXBsZW1lbnQgdm9sYXRpbGUKKy0gT3JpZ2luYWxseSwgYGBxZW11X2F0b21pY19yZWFk
YGAgYW5kIGBgcWVtdV9hdG9taWNfc2V0YGAgaW4gTGludXggZ2F2ZSBubworICBndWFyYW50ZWUg
YXQgYWxsLiBMaW51eCA0LjEgdXBkYXRlZCB0aGVtIHRvIGltcGxlbWVudCB2b2xhdGlsZQogICBz
ZW1hbnRpY3MgdmlhIGBgQUNDRVNTX09OQ0VgYCAob3IgdGhlIG1vcmUgcmVjZW50IGBgUkVBRGBg
L2BgV1JJVEVfT05DRWBgKS4KIAotICBRRU1VJ3MgYGBhdG9taWNfcmVhZGBgIGFuZCBgYGF0b21p
Y19zZXRgYCBpbXBsZW1lbnQgQzExIGF0b21pYyByZWxheGVkCi0gIHNlbWFudGljcyBpZiB0aGUg
Y29tcGlsZXIgc3VwcG9ydHMgaXQsIGFuZCB2b2xhdGlsZSBzZW1hbnRpY3Mgb3RoZXJ3aXNlLgot
ICBCb3RoIHNlbWFudGljcyBwcmV2ZW50IHRoZSBjb21waWxlciBmcm9tIGRvaW5nIGNlcnRhaW4g
dHJhbnNmb3JtYXRpb25zOwotICB0aGUgZGlmZmVyZW5jZSBpcyB0aGF0IGF0b21pYyBhY2Nlc3Nl
cyBhcmUgZ3VhcmFudGVlZCB0byBiZSBhdG9taWMsCi0gIHdoaWxlIHZvbGF0aWxlIGFjY2Vzc2Vz
IGFyZW4ndC4gVGh1cywgaW4gdGhlIHZvbGF0aWxlIGNhc2Ugd2UganVzdCBjcm9zcwotICBvdXIg
ZmluZ2VycyBob3BpbmcgdGhhdCB0aGUgY29tcGlsZXIgd2lsbCBnZW5lcmF0ZSBhdG9taWMgYWNj
ZXNzZXMsCi0gIHNpbmNlIHdlIGFzc3VtZSB0aGUgdmFyaWFibGVzIHBhc3NlZCBhcmUgbWFjaGlu
ZS13b3JkIHNpemVkIGFuZAotICBwcm9wZXJseSBhbGlnbmVkLgorICBRRU1VJ3MgYGBxZW11X2F0
b21pY19yZWFkYGAgYW5kIGBgcWVtdV9hdG9taWNfc2V0YGAgaW1wbGVtZW50IEMxMSBhdG9taWMK
KyAgcmVsYXhlZCBzZW1hbnRpY3MgaWYgdGhlIGNvbXBpbGVyIHN1cHBvcnRzIGl0LCBhbmQgdm9s
YXRpbGUgc2VtYW50aWNzCisgIG90aGVyd2lzZS4gQm90aCBzZW1hbnRpY3MgcHJldmVudCB0aGUg
Y29tcGlsZXIgZnJvbSBkb2luZyBjZXJ0YWluCisgIHRyYW5zZm9ybWF0aW9uczsgdGhlIGRpZmZl
cmVuY2UgaXMgdGhhdCBhdG9taWMgYWNjZXNzZXMgYXJlIGd1YXJhbnRlZWQgdG8gYmUKKyAgYXRv
bWljLCB3aGlsZSB2b2xhdGlsZSBhY2Nlc3NlcyBhcmVuJ3QuIFRodXMsIGluIHRoZSB2b2xhdGls
ZSBjYXNlIHdlIGp1c3QKKyAgY3Jvc3Mgb3VyIGZpbmdlcnMgaG9waW5nIHRoYXQgdGhlIGNvbXBp
bGVyIHdpbGwgZ2VuZXJhdGUgYXRvbWljIGFjY2Vzc2VzLAorICBzaW5jZSB3ZSBhc3N1bWUgdGhl
IHZhcmlhYmxlcyBwYXNzZWQgYXJlIG1hY2hpbmUtd29yZCBzaXplZCBhbmQgcHJvcGVybHkKKyAg
YWxpZ25lZC4KIAotICBObyBiYXJyaWVycyBhcmUgaW1wbGllZCBieSBgYGF0b21pY19yZWFkYGAg
YW5kIGBgYXRvbWljX3NldGBgIGluIGVpdGhlciBMaW51eAotICBvciBRRU1VLgorICBObyBiYXJy
aWVycyBhcmUgaW1wbGllZCBieSBgYHFlbXVfYXRvbWljX3JlYWRgYCBhbmQgYGBxZW11X2F0b21p
Y19zZXRgYCBpbgorICBlaXRoZXIgTGludXggb3IgUUVNVS4KIAogLSBhdG9taWMgcmVhZC1tb2Rp
Znktd3JpdGUgb3BlcmF0aW9ucyBpbiBMaW51eCBhcmUgb2YgdGhyZWUga2luZHM6CiAKLSAgICAg
ICAgID09PT09PT09PT09PT09PT09PT09PSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQotICAgICAgICAgYGBhdG9taWNfT1BgYCAgICAgICAgIHJldHVybnMgdm9pZAot
ICAgICAgICAgYGBhdG9taWNfT1BfcmV0dXJuYGAgIHJldHVybnMgbmV3IHZhbHVlIG9mIHRoZSB2
YXJpYWJsZQotICAgICAgICAgYGBhdG9taWNfZmV0Y2hfT1BgYCAgIHJldHVybnMgdGhlIG9sZCB2
YWx1ZSBvZiB0aGUgdmFyaWFibGUKLSAgICAgICAgIGBgYXRvbWljX2NtcHhjaGdgYCAgICByZXR1
cm5zIHRoZSBvbGQgdmFsdWUgb2YgdGhlIHZhcmlhYmxlCi0gICAgICAgICA9PT09PT09PT09PT09
PT09PT09PT0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKyAgICAg
ICAgID09PT09PT09PT09PT09PT09PT09PT09ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09CisgICAgICAgICBgYGF0b21pY19PUGBgICAgICAgICAgICByZXR1cm5zIHZv
aWQKKyAgICAgICAgIGBgYXRvbWljX09QX3JldHVybmBgICAgIHJldHVybnMgbmV3IHZhbHVlIG9m
IHRoZSB2YXJpYWJsZQorICAgICAgICAgYGBhdG9taWNfZmV0Y2hfT1BgYCAgICAgcmV0dXJucyB0
aGUgb2xkIHZhbHVlIG9mIHRoZSB2YXJpYWJsZQorICAgICAgICAgYGBxZW11X2F0b21pY19jbXB4
Y2hnYGAgcmV0dXJucyB0aGUgb2xkIHZhbHVlIG9mIHRoZSB2YXJpYWJsZQorICAgICAgICAgPT09
PT09PT09PT09PT09PT09PT09PT0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KIAogICBJbiBRRU1VLCB0aGUgc2Vjb25kIGtpbmQgaXMgbmFtZWQgYGBhdG9taWNfT1Bf
ZmV0Y2hgYC4KIApAQCAtNDY5LDE5ICs0NjksMTkgQEAgYW5kIG1lbW9yeSBiYXJyaWVycywgYW5k
IHRoZSBlcXVpdmFsZW50cyBpbiBRRU1VOgogICBhIGRpZmZlcmVudCBzZXQgb2YgbWVtb3J5IGJh
cnJpZXJzOyBpbiBRRU1VLCBhbGwgb2YgdGhlbSBlbmZvcmNlCiAgIHNlcXVlbnRpYWwgY29uc2lz
dGVuY3kuCiAKLS0gaW4gUUVNVSwgYGBhdG9taWNfcmVhZCgpYGAgYW5kIGBgYXRvbWljX3NldCgp
YGAgZG8gbm90IHBhcnRpY2lwYXRlIGluCi0gIHRoZSB0b3RhbCBvcmRlcmluZyBlbmZvcmNlZCBi
eSBzZXF1ZW50aWFsbHktY29uc2lzdGVudCBvcGVyYXRpb25zLgorLSBpbiBRRU1VLCBgYHFlbXVf
YXRvbWljX3JlYWQoKWBgIGFuZCBgYHFlbXVfYXRvbWljX3NldCgpYGAgZG8gbm90IHBhcnRpY2lw
YXRlCisgIGluIHRoZSB0b3RhbCBvcmRlcmluZyBlbmZvcmNlZCBieSBzZXF1ZW50aWFsbHktY29u
c2lzdGVudCBvcGVyYXRpb25zLgogICBUaGlzIGlzIGJlY2F1c2UgUUVNVSB1c2VzIHRoZSBDMTEg
bWVtb3J5IG1vZGVsLiAgVGhlIGZvbGxvd2luZyBleGFtcGxlCiAgIGlzIGNvcnJlY3QgaW4gTGlu
dXggYnV0IG5vdCBpbiBRRU1VOgogCi0gICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKLSAgICAgIHwgTGludXgg
KGNvcnJlY3QpICAgICAgICAgICAgICAgICAgfCBRRU1VIChpbmNvcnJlY3QpICAgICAgICAgICAg
ICAgfAotICAgICAgKz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0rCi0gICAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwgOjogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKLSAgICAgIHwgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfAotICAgICAgfCAgIGEgPSBhdG9taWNfZmV0Y2hfYWRkKCZ4LCAyKTsgICB8ICAgYSA9
IGF0b21pY19mZXRjaF9hZGQoJngsIDIpOyB8Ci0gICAgICB8ICAgYiA9IFJFQURfT05DRSgmeSk7
ICAgICAgICAgICAgIHwgICBiID0gYXRvbWljX3JlYWQoJnkpOyAgICAgICAgIHwKLSAgICAgICst
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tKworICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0r
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCisgICAgICB8IExpbnV4IChjb3JyZWN0
KSAgICAgICAgICAgICAgICAgICAgIHwgUUVNVSAoaW5jb3JyZWN0KSAgICAgICAgICAgICAgIHwK
KyAgICAgICs9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Kz09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09KworICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8IDo6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CisgICAgICB8ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHwKKyAgICAgIHwgICBhID0gcWVtdV9hdG9taWNfZmV0Y2hfYWRkKCZ4LCAyKTsg
fCAgIGEgPSBhdG9taWNfZmV0Y2hfYWRkKCZ4LCAyKTsgfAorICAgICAgfCAgIGIgPSBSRUFEX09O
Q0UoJnkpOyAgICAgICAgICAgICAgICB8ICAgYiA9IHFlbXVfYXRvbWljX3JlYWQoJnkpOyAgICB8
CisgICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKIAogICBiZWNhdXNlIHRoZSByZWFkIG9mIGBgeWBgIGNh
biBiZSBtb3ZlZCAoYnkgZWl0aGVyIHRoZSBwcm9jZXNzb3Igb3IgdGhlCiAgIGNvbXBpbGVyKSBi
ZWZvcmUgdGhlIHdyaXRlIG9mIGBgeGBgLgpAQCAtNDk1LDEwICs0OTUsMTAgQEAgYW5kIG1lbW9y
eSBiYXJyaWVycywgYW5kIHRoZSBlcXVpdmFsZW50cyBpbiBRRU1VOgogICAgICAgKz09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09KwogICAgICAgfCA6OiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgfAogICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICAg
ICAgfCAgIGEgPSBhdG9taWNfcmVhZCgmeCk7ICAgICAgICAgfAotICAgICAgfCAgIGF0b21pY19z
ZXQoJngsIGEgKyAyKTsgICAgICAgfAorICAgICAgfCAgIGEgPSBxZW11X2F0b21pY19yZWFkKCZ4
KTsgICAgfAorICAgICAgfCAgIHFlbXVfYXRvbWljX3NldCgmeCwgYSArIDIpOyAgfAogICAgICAg
fCAgIHNtcF9tYigpOyAgICAgICAgICAgICAgICAgICAgfAotICAgICAgfCAgIGIgPSBhdG9taWNf
cmVhZCgmeSk7ICAgICAgICAgfAorICAgICAgfCAgIGIgPSBxZW11X2F0b21pY19yZWFkKCZ5KTsg
ICAgfAogICAgICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKwogCiBTb3VyY2Vz
CmRpZmYgLS1naXQgYS9wYy1iaW9zL29wZW5zYmktcmlzY3YzMi1nZW5lcmljLWZ3X2R5bmFtaWMu
ZWxmIGIvcGMtYmlvcy9vcGVuc2JpLXJpc2N2MzItZ2VuZXJpYy1md19keW5hbWljLmVsZgppbmRl
eCBlYjllYmY1Njc0ZDM5NTNhYjI1ZGU2YmY0ZGIxMzRhYmU5MDRlYjIwLi4zNWI4MDUxMjQ0NmRj
ZjVjNDk0MjRhZTkwY2FhY2YzYzU3OWJlMWI1IDEwMDY0NApHSVQgYmluYXJ5IHBhdGNoCmRlbHRh
IDk4CnpjbVhAcHF4N21yc2lCM2pne2coUGc9R3Q/ITR1WlApWkVoZT9MZFpANVFJSjU/SGcrbWd4
UzkxOCFIZ0FaUXQ+WQpjZVNITn5YP2l8SzVmaFlzdnlrSTk3bkhyRmhHUGFOMEhwI2FeOGYkPAoK
ZGVsdGEgNjIKemNtYUZXcWphVzZzaUIzamd7ZyhQZz1HdD8hSVNOI1BndW8tclUhZ3VFb3dqaGpU
TU81d2pjay16UEA2NmJ2e1FDClMpQW1uPTlKamYpVSNqN2whM2g5WmoycUdiCgpkaWZmIC0tZ2l0
IGEvcGMtYmlvcy9vcGVuc2JpLXJpc2N2NjQtZ2VuZXJpYy1md19keW5hbWljLmVsZiBiL3BjLWJp
b3Mvb3BlbnNiaS1yaXNjdjY0LWdlbmVyaWMtZndfZHluYW1pYy5lbGYKaW5kZXggNjQyYTY0ZTI0
MGQwOWIyZGRiOWZjMTJjNzQ3MThhZThkMzg2YjlkMy4uOWNmMmNmMjNiNzQ3Y2I1YmUxZDMzODlh
MDYxMWQ4Njk3NjA5YzZmOCAxMDA2NDQKR0lUIGJpbmFyeSBwYXRjaApkZWx0YSAxMDIKemNtZUJw
dWUkOExZQ3tXUzNzVmJvMyhGU1BNR3NnRFEqJXE+dyp3aDZMSjs9IWVWPHMxQWsyMXkmI1hZcTJF
Xj4hCmU0TCk8cyZ3KG1HQUoxOUQxWjZ1V2FVU1Bfdk4+YCY4QEs+KlJWWXZaCgpkZWx0YSA2Ngp6
Y21aNFhVYlctQllDe1dTM3NWYm8zKEZTUE1Hdit3ZjUwanVIMnVVVSl9blUlJiNYWXEyRV4+IT9M
VHdPJilOUHMKVXAwa0spZHNHdFZhanh4Wnh0dEFMME5wPHZKXiVtIQoKZGlmZiAtLWdpdCBhL3Nj
cmlwdHMva2VybmVsLWRvYyBiL3NjcmlwdHMva2VybmVsLWRvYwppbmRleCAwMzBiNWM4NjkxLi45
ZWMzOGExYmYxIDEwMDc1NQotLS0gYS9zY3JpcHRzL2tlcm5lbC1kb2MKKysrIGIvc2NyaXB0cy9r
ZXJuZWwtZG9jCkBAIC0xNjI1LDcgKzE2MjUsNyBAQCBzdWIgZHVtcF9mdW5jdGlvbigkJCkgewog
ICAgICMgSWYgeW91IG1lc3Mgd2l0aCB0aGVzZSByZWdleHBzLCBpdCdzIGEgZ29vZCBpZGVhIHRv
IGNoZWNrIHRoYXQKICAgICAjIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zJyBkb2N1bWVudGF0aW9u
IHN0aWxsIGNvbWVzIG91dCByaWdodDoKICAgICAjIC0gcGFycG9ydF9yZWdpc3Rlcl9kZXZpY2Ug
KGZ1bmN0aW9uIHBvaW50ZXIgcGFyYW1ldGVycykKLSAgICAjIC0gYXRvbWljX3NldCAobWFjcm8p
CisgICAgIyAtIHFlbXVfYXRvbWljX3NldCAobWFjcm8pCiAgICAgIyAtIHBjaV9tYXRjaF9kZXZp
Y2UsIF9fY29weV90b191c2VyIChsb25nIHJldHVybiB0eXBlKQogCiAgICAgaWYgKCRkZWZpbmUg
JiYgJHByb3RvdHlwZSA9fiBtL14oKShbYS16QS1aMC05X346XSspXHMrLykgewpkaWZmIC0tZ2l0
IGEvdGNnL2FhcmNoNjQvdGNnLXRhcmdldC5jLmluYyBiL3RjZy9hYXJjaDY0L3RjZy10YXJnZXQu
Yy5pbmMKaW5kZXggOTQ4YzM1ZDgyNS4uMzNkOTBjNmRhMyAxMDA2NDQKLS0tIGEvdGNnL2FhcmNo
NjQvdGNnLXRhcmdldC5jLmluYworKysgYi90Y2cvYWFyY2g2NC90Y2ctdGFyZ2V0LmMuaW5jCkBA
IC0xMzY1LDcgKzEzNjUsNyBAQCB2b2lkIHRiX3RhcmdldF9zZXRfam1wX3RhcmdldCh1aW50cHRy
X3QgdGNfcHRyLCB1aW50cHRyX3Qgam1wX2FkZHIsCiAgICAgICAgIGkyID0gSTM0MDFfQURESSB8
IHJ0IDw8IDMxIHwgKGFkZHIgJiAweGZmZikgPDwgMTAgfCByZCA8PCA1IHwgcmQ7CiAgICAgfQog
ICAgIHBhaXIgPSAodWludDY0X3QpaTIgPDwgMzIgfCBpMTsKLSAgICBhdG9taWNfc2V0KCh1aW50
NjRfdCAqKWptcF9hZGRyLCBwYWlyKTsKKyAgICBxZW11X2F0b21pY19zZXQoKHVpbnQ2NF90ICop
am1wX2FkZHIsIHBhaXIpOwogICAgIGZsdXNoX2ljYWNoZV9yYW5nZShqbXBfYWRkciwgam1wX2Fk
ZHIgKyA4KTsKIH0KIApkaWZmIC0tZ2l0IGEvdGNnL21pcHMvdGNnLXRhcmdldC5jLmluYyBiL3Rj
Zy9taXBzL3RjZy10YXJnZXQuYy5pbmMKaW5kZXggYmQ1YjhlMDlhMC4uMzY0YWEyZjY0YSAxMDA2
NDQKLS0tIGEvdGNnL21pcHMvdGNnLXRhcmdldC5jLmluYworKysgYi90Y2cvbWlwcy90Y2ctdGFy
Z2V0LmMuaW5jCkBAIC0yNjYyLDcgKzI2NjIsNyBAQCBzdGF0aWMgdm9pZCB0Y2dfdGFyZ2V0X2lu
aXQoVENHQ29udGV4dCAqcykKIHZvaWQgdGJfdGFyZ2V0X3NldF9qbXBfdGFyZ2V0KHVpbnRwdHJf
dCB0Y19wdHIsIHVpbnRwdHJfdCBqbXBfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVpbnRwdHJfdCBhZGRyKQogewotICAgIGF0b21pY19zZXQoKHVpbnQzMl90ICopam1wX2Fk
ZHIsIGRlcG9zaXQzMihPUENfSiwgMCwgMjYsIGFkZHIgPj4gMikpOworICAgIHFlbXVfYXRvbWlj
X3NldCgodWludDMyX3QgKilqbXBfYWRkciwgZGVwb3NpdDMyKE9QQ19KLCAwLCAyNiwgYWRkciA+
PiAyKSk7CiAgICAgZmx1c2hfaWNhY2hlX3JhbmdlKGptcF9hZGRyLCBqbXBfYWRkciArIDQpOwog
fQogCmRpZmYgLS1naXQgYS90Y2cvcHBjL3RjZy10YXJnZXQuYy5pbmMgYi90Y2cvcHBjL3RjZy10
YXJnZXQuYy5pbmMKaW5kZXggMzkzYzRiMzBlMC4uMjFhY2NmNjBmZSAxMDA2NDQKLS0tIGEvdGNn
L3BwYy90Y2ctdGFyZ2V0LmMuaW5jCisrKyBiL3RjZy9wcGMvdGNnLXRhcmdldC5jLmluYwpAQCAt
MTc1NiwxMyArMTc1NiwxMyBAQCB2b2lkIHRiX3RhcmdldF9zZXRfam1wX3RhcmdldCh1aW50cHRy
X3QgdGNfcHRyLCB1aW50cHRyX3Qgam1wX2FkZHIsCiAjZW5kaWYKIAogICAgICAgICAvKiBBcyBw
ZXIgdGhlIGVuY2xvc2luZyBpZiwgdGhpcyBpcyBwcGM2NC4gIEF2b2lkIHRoZSBfU3RhdGljX2Fz
c2VydAotICAgICAgICAgICB3aXRoaW4gYXRvbWljX3NldCB0aGF0IHdvdWxkIGZhaWwgdG8gYnVp
bGQgYSBwcGMzMiBob3N0LiAgKi8KLSAgICAgICAgYXRvbWljX3NldF9fbm9jaGVjaygodWludDY0
X3QgKilqbXBfYWRkciwgcGFpcik7CisgICAgICAgICAgIHdpdGhpbiBxZW11X2F0b21pY19zZXQg
dGhhdCB3b3VsZCBmYWlsIHRvIGJ1aWxkIGEgcHBjMzIgaG9zdC4gICovCisgICAgICAgIHFlbXVf
YXRvbWljX3NldF9fbm9jaGVjaygodWludDY0X3QgKilqbXBfYWRkciwgcGFpcik7CiAgICAgICAg
IGZsdXNoX2ljYWNoZV9yYW5nZShqbXBfYWRkciwgam1wX2FkZHIgKyA4KTsKICAgICB9IGVsc2Ug
ewogICAgICAgICBpbnRwdHJfdCBkaWZmID0gYWRkciAtIGptcF9hZGRyOwogICAgICAgICB0Y2df
ZGVidWdfYXNzZXJ0KGluX3JhbmdlX2IoZGlmZikpOwotICAgICAgICBhdG9taWNfc2V0KCh1aW50
MzJfdCAqKWptcF9hZGRyLCBCIHwgKGRpZmYgJiAweDNmZmZmZmMpKTsKKyAgICAgICAgcWVtdV9h
dG9taWNfc2V0KCh1aW50MzJfdCAqKWptcF9hZGRyLCBCIHwgKGRpZmYgJiAweDNmZmZmZmMpKTsK
ICAgICAgICAgZmx1c2hfaWNhY2hlX3JhbmdlKGptcF9hZGRyLCBqbXBfYWRkciArIDQpOwogICAg
IH0KIH0KZGlmZiAtLWdpdCBhL3RjZy9zcGFyYy90Y2ctdGFyZ2V0LmMuaW5jIGIvdGNnL3NwYXJj
L3RjZy10YXJnZXQuYy5pbmMKaW5kZXggMGYxZDkxZmMyMS4uYzI0ZmI0MDNkYSAxMDA2NDQKLS0t
IGEvdGNnL3NwYXJjL3RjZy10YXJnZXQuYy5pbmMKKysrIGIvdGNnL3NwYXJjL3RjZy10YXJnZXQu
Yy5pbmMKQEAgLTE4MzksNyArMTgzOSw4IEBAIHZvaWQgdGJfdGFyZ2V0X3NldF9qbXBfdGFyZ2V0
KHVpbnRwdHJfdCB0Y19wdHIsIHVpbnRwdHJfdCBqbXBfYWRkciwKICAgICB0Y2dfZGVidWdfYXNz
ZXJ0KGJyX2Rpc3AgPT0gKGludDMyX3QpYnJfZGlzcCk7CiAKICAgICBpZiAoIVVTRV9SRUdfVEIp
IHsKLSAgICAgICAgYXRvbWljX3NldCgodWludDMyX3QgKilqbXBfYWRkciwgZGVwb3NpdDMyKENB
TEwsIDAsIDMwLCBicl9kaXNwID4+IDIpKTsKKyAgICAgICAgcWVtdV9hdG9taWNfc2V0KCh1aW50
MzJfdCAqKWptcF9hZGRyLAorCQkgICAgICAgIGRlcG9zaXQzMihDQUxMLCAwLCAzMCwgYnJfZGlz
cCA+PiAyKSk7CiAgICAgICAgIGZsdXNoX2ljYWNoZV9yYW5nZShqbXBfYWRkciwgam1wX2FkZHIg
KyA0KTsKICAgICAgICAgcmV0dXJuOwogICAgIH0KQEAgLTE4NjMsNiArMTg2NCw2IEBAIHZvaWQg
dGJfdGFyZ2V0X3NldF9qbXBfdGFyZ2V0KHVpbnRwdHJfdCB0Y19wdHIsIHVpbnRwdHJfdCBqbXBf
YWRkciwKICAgICAgICAgICAgICAgfCBJTlNOX0lNTTEzKCh0Yl9kaXNwICYgMHgzZmYpIHwgLTB4
NDAwKSk7CiAgICAgfQogCi0gICAgYXRvbWljX3NldCgodWludDY0X3QgKilqbXBfYWRkciwgZGVw
b3NpdDY0KGkyLCAzMiwgMzIsIGkxKSk7CisgICAgcWVtdV9hdG9taWNfc2V0KCh1aW50NjRfdCAq
KWptcF9hZGRyLCBkZXBvc2l0NjQoaTIsIDMyLCAzMiwgaTEpKTsKICAgICBmbHVzaF9pY2FjaGVf
cmFuZ2Uoam1wX2FkZHIsIGptcF9hZGRyICsgOCk7CiB9Ci0tIAoyLjI2LjIKCg==



Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9C9BE763B3
	for <lists+xen-devel@lfdr.de>; Fri, 26 Jul 2019 12:41:43 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hqxbl-0006Z5-Si; Fri, 26 Jul 2019 10:37:53 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=gQyu=VX=gmail.com=andrii.anisov@srs-us1.protection.inumbo.net>)
 id 1hqxbj-0006Yh-QC
 for xen-devel@lists.xenproject.org; Fri, 26 Jul 2019 10:37:51 +0000
X-Inumbo-ID: 6a395883-af91-11e9-8980-bc764e045a96
Received: from mail-lf1-x142.google.com (unknown [2a00:1450:4864:20::142])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 6a395883-af91-11e9-8980-bc764e045a96;
 Fri, 26 Jul 2019 10:37:50 +0000 (UTC)
Received: by mail-lf1-x142.google.com with SMTP id s19so36751526lfb.9
 for <xen-devel@lists.xenproject.org>; Fri, 26 Jul 2019 03:37:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=D23SaDmMes/5rLk7esszHz1ov4+y99tR1u40eMXh+wA=;
 b=hi8w1xokQ+1fLlzpVqiUDin0oatRCd/qhpzeNDSs/Spm98Ir+9OkAQ/7wRRdTxjnqP
 G0+ecuRC5ee7OZUk9Oc+vzyXxzZZYwR9HxJe11bHezLlaoadI3OlNPuBx9rE5+z3+gYf
 2HUyjN6jjRfWs8kQUCcBzxdTNYa2eWgQ/MO5n9RIGRVI8zsNhfdndJg2Csnh0gzZY/uX
 X6pTM42THxJHPq72Q0yI88ggniNS0voqlk3vPU3ZSp8o738TkWrKX2Mwj3bRDWMnHPyP
 kHtc/vsSRVfCDUiTGkjgggpX24haR92UuDGnzj/Gt5Lnh2ImLvHk0ft+a/UFxZwWrqSe
 WtrQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=D23SaDmMes/5rLk7esszHz1ov4+y99tR1u40eMXh+wA=;
 b=jcBdnSeDoTXnpWjqo50mjpiySvPSbmI/oSArztxrARZHrezWxTMPLNdxvKndcuyQET
 1JeSq6Fs2f3uyvpvEpNo5Lu5Hh5abKEl12XKDo7mvA5dA4kUTXJVh7OJEwACuJSYHrmG
 /RLdq5PSSHEpx3k2UmQVM9iYDMwJxp5Rm6iRC4okJxTKIcbYJWidXUepRJ34ZkOkMdwQ
 RzTHXjAPZ2qLbxxyMTkmMttCc78yHB5lg8Qm+tQw8DpGl7Tx5MF1Q1mlaAeI8WE6VdcK
 uw3EVWQAuiHyuH+tzpaMmP14AB2q+1k+XiAZAQ7K/c5j7tTtlcE1vnBG9HE6CfCO2UX9
 DVDA==
X-Gm-Message-State: APjAAAU7BapOLj4du2phj5tiByeNQjQXAQIkuhA9wawna/grD7csSMLY
 mI4WFHE9UGfMQwQX3o/AmFU0sB0S
X-Google-Smtp-Source: APXvYqwhDnkKYPKaAsFCvVBcWCL344LKoLD8j+pk9K4PRKK/NgAbZ2S4oC/Myup42mxgATYcPQOqAQ==
X-Received: by 2002:a05:6512:51c:: with SMTP id
 o28mr45535842lfb.67.1564137468910; 
 Fri, 26 Jul 2019 03:37:48 -0700 (PDT)
Received: from aanisov-work.kyiv.epam.com (ll-22.209.223.85.sovam.net.ua.
 [85.223.209.22])
 by smtp.gmail.com with ESMTPSA id m4sm9938274ljc.56.2019.07.26.03.37.47
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
 Fri, 26 Jul 2019 03:37:48 -0700 (PDT)
From: Andrii Anisov <andrii.anisov@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 26 Jul 2019 13:37:37 +0300
Message-Id: <1564137460-25629-5-git-send-email-andrii.anisov@gmail.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1564137460-25629-1-git-send-email-andrii.anisov@gmail.com>
References: <1564137460-25629-1-git-send-email-andrii.anisov@gmail.com>
Subject: [Xen-devel] [RFC 4/6] xentop: show CPU load information
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Ian Jackson <ian.jackson@eu.citrix.com>,
 Andrii Anisov <andrii_anisov@epam.com>, Wei Liu <wl@xen.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogQW5kcmlpIEFuaXNvdiA8YW5kcmlpX2FuaXNvdkBlcGFtLmNvbT4KCkxldCB4ZW50b3Ag
cmVxdWVzdCBhbmQgc2hvdyBpbmZvcm1hdGlvbiBhYm91dCBDUFUgbG9hZAooaHlwZXJ2aXNvciwg
Z3Vlc3QgYW5kIGlkbGUgaW5mb3JtYXRpb24pCgpTaWduZWQtb2ZmLWJ5OiBBbmRyaWkgQW5pc292
IDxhbmRyaWlfYW5pc292QGVwYW0uY29tPgotLS0KIHRvb2xzL3hlbnN0YXQvbGlieGVuc3RhdC9z
cmMveGVuc3RhdC5jICAgICAgfCAzOCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogdG9v
bHMveGVuc3RhdC9saWJ4ZW5zdGF0L3NyYy94ZW5zdGF0LmggICAgICB8ICA5ICsrKysrKysKIHRv
b2xzL3hlbnN0YXQvbGlieGVuc3RhdC9zcmMveGVuc3RhdF9wcml2LmggfCAgMyArKysKIHRvb2xz
L3hlbnN0YXQveGVudG9wL3hlbnRvcC5jICAgICAgICAgICAgICAgfCAzMCArKysrKysrKysrKysr
KysrKysrKysrKwogNCBmaWxlcyBjaGFuZ2VkLCA4MCBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0
IGEvdG9vbHMveGVuc3RhdC9saWJ4ZW5zdGF0L3NyYy94ZW5zdGF0LmMgYi90b29scy94ZW5zdGF0
L2xpYnhlbnN0YXQvc3JjL3hlbnN0YXQuYwppbmRleCBiYmExNDNlLi5lNDAyOWQyIDEwMDY0NAot
LS0gYS90b29scy94ZW5zdGF0L2xpYnhlbnN0YXQvc3JjL3hlbnN0YXQuYworKysgYi90b29scy94
ZW5zdGF0L2xpYnhlbnN0YXQvc3JjL3hlbnN0YXQuYwpAQCAtMTQ4LDYgKzE0OCw5IEBAIHN0YXRp
YyBpbmxpbmUgdW5zaWduZWQgbG9uZyBsb25nIHBhcnNlKGNoYXIgKnMsIGNoYXIgKm1hdGNoKQog
eGVuc3RhdF9ub2RlICp4ZW5zdGF0X2dldF9ub2RlKHhlbnN0YXRfaGFuZGxlICogaGFuZGxlLCB1
bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CiAjZGVmaW5lIERPTUFJTl9DSFVOS19TSVpFIDI1NgorCXhj
X2NwdWluZm9fdCAqY3B1aW5mbzsKKwlpbnQgbWF4X2NwdXMsIG5yX2NwdXM7CisKIAl4ZW5zdGF0
X25vZGUgKm5vZGU7CiAJeGNfcGh5c2luZm9fdCBwaHlzaW5mbyA9IHsgMCB9OwogCXhjX2RvbWFp
bmluZm9fdCBkb21haW5pbmZvW0RPTUFJTl9DSFVOS19TSVpFXTsKQEAgLTE3Nyw2ICsxODAsMjYg
QEAgeGVuc3RhdF9ub2RlICp4ZW5zdGF0X2dldF9ub2RlKHhlbnN0YXRfaGFuZGxlICogaGFuZGxl
LCB1bnNpZ25lZCBpbnQgZmxhZ3MpCiAJICAgICogaGFuZGxlLT5wYWdlX3NpemU7CiAKIAlub2Rl
LT5mcmVlYWJsZV9tYiA9IDA7CisKKwltYXhfY3B1cyA9IG5vZGUtPm51bV9jcHVzOworCisJY3B1
aW5mbyA9IGNhbGxvYyhtYXhfY3B1cywgc2l6ZW9mKHhjX2NwdWluZm9fdCkpOworCWlmICghY3B1
aW5mbykKKwkJcmV0dXJuIE5VTEw7CisKKwlpZiAoeGNfZ2V0Y3B1aW5mbyhoYW5kbGUtPnhjX2hh
bmRsZSwgbWF4X2NwdXMsIGNwdWluZm8sICZucl9jcHVzKSA8IDApIHsKKwkJZnJlZShjcHVpbmZv
KTsKKwkJcmV0dXJuIE5VTEw7CisJfQorCisJZm9yICggaSA9IDA7IGkgPCBucl9jcHVzOyBpKysp
IHsKKwkJbm9kZS0+aWRsZV90aW1lICs9IGNwdWluZm9baV0uaWRsZXRpbWU7CisJCW5vZGUtPmh5
cF90aW1lICs9IGNwdWluZm9baV0uaHlwdGltZTsKKwkJbm9kZS0+Z3Vlc3RfdGltZSArPSBjcHVp
bmZvW2ldLmd1ZXN0dGltZTsKKwl9CisKKwlmcmVlKGNwdWluZm8pOworCiAJLyogbWFsbG9jKDAp
IGlzIG5vdCBwb3J0YWJsZSwgc28gYWxsb2NhdGUgYSBzaW5nbGUgZG9tYWluLiAgVGhpcyB3aWxs
CiAJICogYmUgcmVzaXplZCBiZWxvdy4gKi8KIAlub2RlLT5kb21haW5zID0gbWFsbG9jKHNpemVv
Zih4ZW5zdGF0X2RvbWFpbikpOwpAQCAtMzQ2LDYgKzM2OSwyMSBAQCB1bnNpZ25lZCBsb25nIGxv
bmcgeGVuc3RhdF9ub2RlX2NwdV9oeih4ZW5zdGF0X25vZGUgKiBub2RlKQogCXJldHVybiBub2Rl
LT5jcHVfaHo7CiB9CiAKK3Vuc2lnbmVkIGxvbmcgbG9uZyB4ZW5zdGF0X25vZGVfaWRsZV90aW1l
KHhlbnN0YXRfbm9kZSAqIG5vZGUpCit7CisJcmV0dXJuIG5vZGUtPmlkbGVfdGltZTsKK30KKwor
dW5zaWduZWQgbG9uZyBsb25nIHhlbnN0YXRfbm9kZV9ndWVzdF90aW1lKHhlbnN0YXRfbm9kZSAq
IG5vZGUpCit7CisJcmV0dXJuIG5vZGUtPmd1ZXN0X3RpbWU7Cit9CisKK3Vuc2lnbmVkIGxvbmcg
bG9uZyB4ZW5zdGF0X25vZGVfaHlwX3RpbWUoeGVuc3RhdF9ub2RlICogbm9kZSkKK3sKKwlyZXR1
cm4gbm9kZS0+aHlwX3RpbWU7Cit9CisKIC8qIEdldCB0aGUgZG9tYWluIElEIGZvciB0aGlzIGRv
bWFpbiAqLwogdW5zaWduZWQgeGVuc3RhdF9kb21haW5faWQoeGVuc3RhdF9kb21haW4gKiBkb21h
aW4pCiB7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdGF0L2xpYnhlbnN0YXQvc3JjL3hlbnN0YXQu
aCBiL3Rvb2xzL3hlbnN0YXQvbGlieGVuc3RhdC9zcmMveGVuc3RhdC5oCmluZGV4IDc2YTY2MGYu
LjViMzQ0NjEgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0YXQvbGlieGVuc3RhdC9zcmMveGVuc3Rh
dC5oCisrKyBiL3Rvb2xzL3hlbnN0YXQvbGlieGVuc3RhdC9zcmMveGVuc3RhdC5oCkBAIC04MCw2
ICs4MCwxNSBAQCB1bnNpZ25lZCBpbnQgeGVuc3RhdF9ub2RlX251bV9jcHVzKHhlbnN0YXRfbm9k
ZSAqIG5vZGUpOwogLyogR2V0IGluZm9ybWF0aW9uIGFib3V0IHRoZSBDUFUgc3BlZWQgKi8KIHVu
c2lnbmVkIGxvbmcgbG9uZyB4ZW5zdGF0X25vZGVfY3B1X2h6KHhlbnN0YXRfbm9kZSAqIG5vZGUp
OwogCisvKiBHZXQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIENQVSBpZGxlIHRpbWUgKi8KK3Vuc2ln
bmVkIGxvbmcgbG9uZyB4ZW5zdGF0X25vZGVfaWRsZV90aW1lKHhlbnN0YXRfbm9kZSAqIG5vZGUp
OworCisvKiBHZXQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIENQVSBndWVzdCBleGVjdXRpb24gdGlt
ZSAqLwordW5zaWduZWQgbG9uZyBsb25nIHhlbnN0YXRfbm9kZV9ndWVzdF90aW1lKHhlbnN0YXRf
bm9kZSAqIG5vZGUpOworCisvKiBHZXQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIENQVSBoeXBlcnZp
c29yIGV4ZWN1dGlvbiB0aW1lICovCit1bnNpZ25lZCBsb25nIGxvbmcgeGVuc3RhdF9ub2RlX2h5
cF90aW1lKHhlbnN0YXRfbm9kZSAqIG5vZGUpOworCiAvKgogICogRG9tYWluIGZ1bmN0aW9ucyAt
IGV4dHJhY3QgaW5mb3JtYXRpb24gZnJvbSBhIHhlbnN0YXRfZG9tYWluCiAgKi8KZGlmZiAtLWdp
dCBhL3Rvb2xzL3hlbnN0YXQvbGlieGVuc3RhdC9zcmMveGVuc3RhdF9wcml2LmggYi90b29scy94
ZW5zdGF0L2xpYnhlbnN0YXQvc3JjL3hlbnN0YXRfcHJpdi5oCmluZGV4IDRlYjQ0YTguLjc4YWQ4
YzQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0YXQvbGlieGVuc3RhdC9zcmMveGVuc3RhdF9wcml2
LmgKKysrIGIvdG9vbHMveGVuc3RhdC9saWJ4ZW5zdGF0L3NyYy94ZW5zdGF0X3ByaXYuaApAQCAt
NDUsNiArNDUsOSBAQCBzdHJ1Y3QgeGVuc3RhdF9ub2RlIHsKIAl1bnNpZ25lZCBpbnQgZmxhZ3M7
CiAJdW5zaWduZWQgbG9uZyBsb25nIGNwdV9oejsKIAl1bnNpZ25lZCBpbnQgbnVtX2NwdXM7CisJ
dW5zaWduZWQgbG9uZyBsb25nIGh5cF90aW1lOworCXVuc2lnbmVkIGxvbmcgbG9uZyBndWVzdF90
aW1lOworCXVuc2lnbmVkIGxvbmcgbG9uZyBpZGxlX3RpbWU7CiAJdW5zaWduZWQgbG9uZyBsb25n
IHRvdF9tZW07CiAJdW5zaWduZWQgbG9uZyBsb25nIGZyZWVfbWVtOwogCXVuc2lnbmVkIGludCBu
dW1fZG9tYWluczsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0YXQveGVudG9wL3hlbnRvcC5jIGIv
dG9vbHMveGVuc3RhdC94ZW50b3AveGVudG9wLmMKaW5kZXggYWYxMWViZi4uYWE2ZTliMCAxMDA2
NDQKLS0tIGEvdG9vbHMveGVuc3RhdC94ZW50b3AveGVudG9wLmMKKysrIGIvdG9vbHMveGVuc3Rh
dC94ZW50b3AveGVudG9wLmMKQEAgLTkzMCw2ICs5MzAsMzQgQEAgdm9pZCBhZGp1c3RfZmllbGRf
d2lkdGhzKHhlbnN0YXRfZG9tYWluICpkb21haW4pCiAJCWZpZWxkc1tGSUVMRF9WQkRfV1NFQ1Qt
MV0uZGVmYXVsdF93aWR0aCA9IGxlbmd0aDsKIH0KIAordm9pZCBkb191dGlsaXphdGlvbih2b2lk
KQoreworCWRvdWJsZSB1c19lbGFwc2VkID0gMC4wLAorCQkgICB1c19oeXAgPSAwLjAsCisJCSAg
IHVzX2d1ZXN0ID0gMC4wLAorCQkgICB1c19pZGxlID0gMC4wOworCisJLyogQ2FuJ3QgY2FsY3Vs
YXRlIENQVSBwZXJjZW50YWdlIHdpdGhvdXQgYSBjdXJyZW50IGFuZCBhIHByZXZpb3VzIHNhbXBs
ZS4qLworCWlmKHByZXZfbm9kZSAhPSBOVUxMICYmIGN1cl9ub2RlICE9IE5VTEwpIHsKKworCQkv
KiBDYWxjdWxhdGUgdGhlIHRpbWUgZWxhcHNlZCBpbiBtaWNyb3NlY29uZHMgKi8KKwkJdXNfZWxh
cHNlZCA9ICgoY3VydGltZS50dl9zZWMtb2xkdGltZS50dl9zZWMpKjEwMDAwMDAuMAorCQkJCSAg
KyhjdXJ0aW1lLnR2X3VzZWMgLSBvbGR0aW1lLnR2X3VzZWMpKTsKKworCQkvKiBJbiB0aGUgZm9s
bG93aW5nLCBuYW5vc2Vjb25kcyBtdXN0IGJlIG11bHRpcGxpZWQgYnkgMTAwMC4wIHRvCisJCSAq
IGNvbnZlcnQgdG8gbWljcm9zZWNvbmRzLCB0aGVuIGRpdmlkZWQgYnkgMTAwLjAgdG8gZ2V0IGEg
cGVyY2VudGFnZSwKKwkJICogcmVzdWx0aW5nIGluIGEgbXVsdGlwbGljYXRpb24gYnkgMTAuMCAq
LworCQl1c19pZGxlID0gKCh4ZW5zdGF0X25vZGVfaWRsZV90aW1lKGN1cl9ub2RlKSAtCisJCQkJ
ICAgeGVuc3RhdF9ub2RlX2lkbGVfdGltZShwcmV2X25vZGUpKS8xMC4wKS91c19lbGFwc2VkOwor
CQl1c19ndWVzdCA9ICgoeGVuc3RhdF9ub2RlX2d1ZXN0X3RpbWUoY3VyX25vZGUpIC0KKwkJCQkg
ICB4ZW5zdGF0X25vZGVfZ3Vlc3RfdGltZShwcmV2X25vZGUpKS8xMC4wKS91c19lbGFwc2VkOwor
CQl1c19oeXAgPSAoKHhlbnN0YXRfbm9kZV9oeXBfdGltZShjdXJfbm9kZSkgLQorCQkJCSAgIHhl
bnN0YXRfbm9kZV9oeXBfdGltZShwcmV2X25vZGUpKS8xMC4wKS91c19lbGFwc2VkOworCX0KKwor
CXByaW50KCIlJUNQVShzKTogJTYuMWYgZ3UsICU2LjFmIGh5LCAlNi4xZiBpZCBcbiIsCisJCSAg
dXNfZ3Vlc3QsIHVzX2h5cCwgdXNfaWRsZSk7Cit9CiAKIC8qIFNlY3Rpb24gcHJpbnRpbmcgZnVu
Y3Rpb25zICovCiAvKiBQcmludHMgdGhlIHRvcCBzdW1tYXJ5LCBhYm92ZSB0aGUgZG9tYWluIHRh
YmxlICovCkBAIC05NzIsNiArMTAwMCw4IEBAIHZvaWQgZG9fc3VtbWFyeSh2b2lkKQogCXVzZWQg
PSB4ZW5zdGF0X25vZGVfdG90X21lbShjdXJfbm9kZSk7CiAJZnJlZWFibGVfbWIgPSAwOwogCisJ
ZG9fdXRpbGl6YXRpb24oKTsKKwogCS8qIER1bXAgbm9kZSBtZW1vcnkgYW5kIGNwdSBpbmZvcm1h
dGlvbiAqLwogCWlmICggZnJlZWFibGVfbWIgPD0gMCApCiAJICAgICBwcmludCgiTWVtOiAlbGx1
ayB0b3RhbCwgJWxsdWsgdXNlZCwgJWxsdWsgZnJlZSAgICAiLAotLSAKMi43LjQKCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGlu
ZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnBy
b2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

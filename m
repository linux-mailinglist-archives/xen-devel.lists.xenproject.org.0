Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4479C173D4D
	for <lists+xen-devel@lfdr.de>; Fri, 28 Feb 2020 17:43:52 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j7igq-0008VO-Gb; Fri, 28 Feb 2020 16:40:40 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=F9pE=4Q=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1j7igo-0008VH-Dr
 for xen-devel@lists.xenproject.org; Fri, 28 Feb 2020 16:40:38 +0000
X-Inumbo-ID: 0c2e1076-5a49-11ea-aea3-bc764e2007e4
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 0c2e1076-5a49-11ea-aea3-bc764e2007e4;
 Fri, 28 Feb 2020 16:40:37 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id DFAEEAD86;
 Fri, 28 Feb 2020 16:40:35 +0000 (UTC)
To: =?UTF-8?Q?Roger_Pau_Monn=c3=a9?= <roger.pau@citrix.com>
References: <20200219174354.84726-1-roger.pau@citrix.com>
 <20200219174354.84726-3-roger.pau@citrix.com>
 <b58bdc3e-f051-0cd8-ed93-ff88c1387229@suse.com>
 <20200228161919.GB24458@Air-de-Roger.citrite.net>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <cff30d21-450a-876b-6d17-9dbb1d7dbae2@suse.com>
Date: Fri, 28 Feb 2020 17:40:44 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko/20100101
 Thunderbird/68.5.0
MIME-Version: 1.0
In-Reply-To: <20200228161919.GB24458@Air-de-Roger.citrite.net>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v5 2/7] x86/paging: add TLB flush hooks
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Tim Deegan <tim@xen.org>,
 Wei Liu <wl@xen.org>, xen-devel@lists.xenproject.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMjguMDIuMjAyMCAxNzoxOSwgUm9nZXIgUGF1IE1vbm7DqSB3cm90ZToKPiBPbiBGcmksIEZl
YiAyOCwgMjAyMCBhdCAwMzo1MDozMVBNICswMTAwLCBKYW4gQmV1bGljaCB3cm90ZToKPj4gT24g
MTkuMDIuMjAyMCAxODo0MywgUm9nZXIgUGF1IE1vbm5lIHdyb3RlOgo+Pj4gQWRkIHNoYWRvdyBh
bmQgaGFwIGltcGxlbWVudGF0aW9uIHNwZWNpZmljIGhlbHBlcnMgdG8gcGVyZm9ybSBndWVzdAo+
Pj4gVExCIGZsdXNoZXMuIE5vdGUgdGhhdCB0aGUgY29kZSBmb3IgYm90aCBpcyBleGFjdGx5IHRo
ZSBzYW1lIGF0IHRoZQo+Pj4gbW9tZW50LCBhbmQgaXMgY29waWVkIGZyb20gaHZtX2ZsdXNoX3Zj
cHVfdGxiLiBUaGlzIHdpbGwgYmUgY2hhbmdlZCBieQo+Pj4gZnVydGhlciBwYXRjaGVzIHRoYXQg
d2lsbCBhZGQgaW1wbGVtZW50YXRpb24gc3BlY2lmaWMgb3B0aW1pemF0aW9ucyB0bwo+Pj4gdGhl
bS4KPj4+Cj4+PiBObyBmdW5jdGlvbmFsIGNoYW5nZSBpbnRlbmRlZC4KPj4+Cj4+PiBTaWduZWQt
b2ZmLWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4KPj4+IFJldmll
d2VkLWJ5OiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgo+Pj4gQWNrZWQtYnk6IFRpbSBEZWVnYW4gPHRp
bUB4ZW4ub3JnPgo+Pgo+PiBUaGlzIGxvb2tzIGdvb2QgaW4gcHJpbmNpcGxlLCB3aXRoIG9uZSBw
b3NzaWJsZSBhbm9tYWx5Ogo+Pgo+Pj4gLS0tIGEveGVuL2FyY2gveDg2L2h2bS9odm0uYwo+Pj4g
KysrIGIveGVuL2FyY2gveDg2L2h2bS9odm0uYwo+Pj4gQEAgLTM5OTAsNTUgKzM5OTAsMTAgQEAg
c3RhdGljIHZvaWQgaHZtX3MzX3Jlc3VtZShzdHJ1Y3QgZG9tYWluICpkKQo+Pj4gIGJvb2wgaHZt
X2ZsdXNoX3ZjcHVfdGxiKGJvb2wgKCpmbHVzaF92Y3B1KSh2b2lkICpjdHh0LCBzdHJ1Y3QgdmNw
dSAqdiksCj4+PiAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqY3R4dCkKPj4+ICB7Cj4+
PiAtICAgIHN0YXRpYyBERUZJTkVfUEVSX0NQVShjcHVtYXNrX3QsIGZsdXNoX2NwdW1hc2spOwo+
Pj4gLSAgICBjcHVtYXNrX3QgKm1hc2sgPSAmdGhpc19jcHUoZmx1c2hfY3B1bWFzayk7Cj4+PiAt
ICAgIHN0cnVjdCBkb21haW4gKmQgPSBjdXJyZW50LT5kb21haW47Cj4+PiAtICAgIHN0cnVjdCB2
Y3B1ICp2Owo+Pj4gLQo+Pj4gLSAgICAvKiBBdm9pZCBkZWFkbG9jayBpZiBtb3JlIHRoYW4gb25l
IHZjcHUgdHJpZXMgdGhpcyBhdCB0aGUgc2FtZSB0aW1lLiAqLwo+Pj4gLSAgICBpZiAoICFzcGlu
X3RyeWxvY2soJmQtPmh5cGVyY2FsbF9kZWFkbG9ja19tdXRleCkgKQo+Pj4gLSAgICAgICAgcmV0
dXJuIGZhbHNlOwo+Pj4gLQo+Pj4gLSAgICAvKiBQYXVzZSBhbGwgb3RoZXIgdmNwdXMuICovCj4+
PiAtICAgIGZvcl9lYWNoX3ZjcHUgKCBkLCB2ICkKPj4+IC0gICAgICAgIGlmICggdiAhPSBjdXJy
ZW50ICYmIGZsdXNoX3ZjcHUoY3R4dCwgdikgKQo+Pj4gLSAgICAgICAgICAgIHZjcHVfcGF1c2Vf
bm9zeW5jKHYpOwo+Pj4gLQo+Pj4gLSAgICAvKiBOb3cgdGhhdCBhbGwgVkNQVXMgYXJlIHNpZ25h
bGxlZCB0byBkZXNjaGVkdWxlLCB3ZSB3YWl0Li4uICovCj4+PiAtICAgIGZvcl9lYWNoX3ZjcHUg
KCBkLCB2ICkKPj4+IC0gICAgICAgIGlmICggdiAhPSBjdXJyZW50ICYmIGZsdXNoX3ZjcHUoY3R4
dCwgdikgKQo+Pj4gLSAgICAgICAgICAgIHdoaWxlICggIXZjcHVfcnVubmFibGUodikgJiYgdi0+
aXNfcnVubmluZyApCj4+PiAtICAgICAgICAgICAgICAgIGNwdV9yZWxheCgpOwo+Pj4gLQo+Pj4g
LSAgICAvKiBBbGwgb3RoZXIgdmNwdXMgYXJlIHBhdXNlZCwgc2FmZSB0byB1bmxvY2sgbm93LiAq
Lwo+Pj4gLSAgICBzcGluX3VubG9jaygmZC0+aHlwZXJjYWxsX2RlYWRsb2NrX211dGV4KTsKPj4+
IC0KPj4+IC0gICAgY3B1bWFza19jbGVhcihtYXNrKTsKPj4+IC0KPj4+IC0gICAgLyogRmx1c2gg
cGFnaW5nLW1vZGUgc29mdCBzdGF0ZSAoZS5nLiwgdmEtPmdmbiBjYWNoZTsgUEFFIFBEUEUgY2Fj
aGUpLiAqLwo+Pj4gLSAgICBmb3JfZWFjaF92Y3B1ICggZCwgdiApCj4+PiAtICAgIHsKPj4+IC0g
ICAgICAgIHVuc2lnbmVkIGludCBjcHU7Cj4+PiAtCj4+PiAtICAgICAgICBpZiAoICFmbHVzaF92
Y3B1KGN0eHQsIHYpICkKPj4+IC0gICAgICAgICAgICBjb250aW51ZTsKPj4+IC0KPj4+IC0gICAg
ICAgIHBhZ2luZ191cGRhdGVfY3IzKHYsIGZhbHNlKTsKPj4+ICsgICAgc3RydWN0IGRvbWFpbiAq
Y3VycmQgPSBjdXJyZW50LT5kb21haW47Cj4+PiAgCj4+PiAtICAgICAgICBjcHUgPSByZWFkX2F0
b21pYygmdi0+ZGlydHlfY3B1KTsKPj4+IC0gICAgICAgIGlmICggaXNfdmNwdV9kaXJ0eV9jcHUo
Y3B1KSApCj4+PiAtICAgICAgICAgICAgX19jcHVtYXNrX3NldF9jcHUoY3B1LCBtYXNrKTsKPj4+
IC0gICAgfQo+Pj4gLQo+Pj4gLSAgICAvKiBGbHVzaCBUTEJzIG9uIGFsbCBDUFVzIHdpdGggZGly
dHkgdmNwdSBzdGF0ZS4gKi8KPj4+IC0gICAgZmx1c2hfdGxiX21hc2sobWFzayk7Cj4+PiAtCj4+
PiAtICAgIC8qIERvbmUuICovCj4+PiAtICAgIGZvcl9lYWNoX3ZjcHUgKCBkLCB2ICkKPj4+IC0g
ICAgICAgIGlmICggdiAhPSBjdXJyZW50ICYmIGZsdXNoX3ZjcHUoY3R4dCwgdikgKQo+Pj4gLSAg
ICAgICAgICAgIHZjcHVfdW5wYXVzZSh2KTsKPj4+IC0KPj4+IC0gICAgcmV0dXJuIHRydWU7Cj4+
PiArICAgIHJldHVybiBzaGFkb3dfbW9kZV9lbmFibGVkKGN1cnJkKSA/IHNoYWRvd19mbHVzaF90
bGIoZmx1c2hfdmNwdSwgY3R4dCkKPj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDogaGFwX2ZsdXNoX3RsYihmbHVzaF92Y3B1LCBjdHh0KTsKPj4+ICB9Cj4+Cj4+IEZv
bGxvd2luZyBvdXIgY3VycmVudCBtb2RlbCBJIHRoaW5rIHRoaXMgc2hvdWxkIGJlIGEgbmV3IHBv
aW50ZXIKPj4gaW4gc3RydWN0IHBhZ2luZ19tb2RlICh0aGVuIHRydWx5IGZpdHRpbmcgImhvb2tz
IiBpbiB0aGUgdGl0bGUpLgo+IAo+IEkgdHJpZWQgZG9pbmcgaXQgdGhhdCB3YXksIGJ1dCB0aGVy
ZSB3YXMgc29tZXRoaW5nIHdlaXJkIGFib3V0IGl0LCB0aGUKPiBwYWdpbmcgbW9kZSBpcyBwZXIt
dmNwdSwgYW5kIGhlbmNlIEkgbmVlZGVkIHRvIGRvIHNvbWV0aGluZyBsaWtlOgo+IAo+IHBhZ2lu
Z19nZXRfaG9zdG1vZGUoY3VycmVudCktPmZsdXNoKGN1cnJlbnQtPmRvbWFpbiwgLi4uKQoKSSBk
b24ndCBzZWUgYW55dGhpbmcgd3Jvbmcgd2l0aCB0aGUgbGVmdCBzaWRlIG9mIHRoZSAtPiAoaXQK
cGFyYWxsZWxzIHdoYXQgaXMgbmVlZGVkIGZvciB0aGUgd3JpdGVfcDJtX2VudHJ5KCkgaG9vayku
IEZvcgp0aGUgcmlnaHQgSSBjYW4ndCBzZWUgd2h5IHlvdSdkIHdhbnQgdG8gaGF2ZSBjdXJyZW50
LT5kb21haW4KdGhlcmUgd2hlbiBib3RoIGZ1bmN0aW9ucyB3YW50IGZsdXNoX3ZjcHUgYW5kIGN0
eHQuIFVsdGltYXRlbHkKd2UgcHJvYmFibHkgd2FudCBwZXItdkNQVSBhbmQgcGVyLWRvbWFpbiBo
b29rcyBpbiBzZXBhcmF0ZQpzdHJ1Y3R1cmVzICh0aGUgZm9ybWVyIGZvciBob29rcyB3aGVyZSB0
aGUgY3VycmVudCBwYWdpbmcgbW9kZQptYXR0ZXJzLCB0aGUgbGF0dGVyIGZvciB0aG9zZSB3aGVy
ZSBpdCBkb2Vzbid0IG1hdHRlciksIGJ1dCBvZgpjb3Vyc2UgdGhhdCdzIG5vdGhpbmcgSSdtIG1l
YW5pbmcgdG8gYXNrIHlvdSB0byBkby4KCj4gSSBjYW4gdHJ5IHRvIG1vdmUgaXQgdG8gYmVpbmcg
YSBwYWdpbmdfbW9kZSBob29rIGlmIHlvdSBwcmVmZXIuCgpJdCB3b3VsZCBzZWVtIGNsZWFuZXIg
dG8gbWUsIGJ1dCAuLi4KCj4+IEkgY2FuIHNlZSB0aGUgZGVzaXJlIHRvIGF2b2lkIHRoZSBpbmRp
cmVjdCBjYWxsIHRob3VnaCwgYnV0IEkKPj4gYWxzbyB0aGluayB0aGF0IGlmIHdlIHdlcmUgdG8g
Z28gdGhhdCByb3V0ZSwgd2Ugc2hvdWxkIHNldHRsZSBvbgo+PiBzd2l0Y2hpbmcgYXJvdW5kIG90
aGVycyBhcyB3ZWxsIHdoaWNoIGFyZSBwYWdpbmcgbW9kZSBkZXBlbmRlbnQuCj4+IChGQU9EIHRo
aXMgaXMgbm90aGluZyBJIGFzayB5b3UgdG8gZG8gaGVyZS4pIEFuZHJldywgdGhvdWdodHM/Cgou
Li4gYXMgc2FpZCBJJ2QgcHJlZmVyIHRvIGFsc28ga25vdyBBbmRyZXcncyBvcGluaW9uLCBpbgpw
YXJ0aWN1bGFyIHRvIHNldHRsZSB3aGVyZSB3ZSB3b3VsZCB3YW50IHRoaXMgdG8gbW92ZSBpbiB0
aGUKbWlkIHRvIGxvbmcgdGVybS4gV2hlcmVhcyAuLi4KCj4gSSB0aGluayBpdCdzIGFscmVhZHkg
cXVpdGUgb2YgYSBtaXhlZCBiYWcsIHNlZSB0cmFja19kaXJ0eV92cmFtIGZvcgo+IGV4YW1wbGUg
d2hpY2ggdXNlcyBhIHNpbWlsYXIgbW9kZWwuCgouLi4geW91IHByb2JhYmx5IGtub3cgbXkgdHlw
aWNhbCByZXNwb25zZSB0byBzb21ldGhpbmcgbGlrZQp0aGlzOiBCYWQgZXhhbXBsZXMgYXJlbid0
IHRvIGJlIHRha2VuIGFzIGV4Y3VzZSB0byBpbnRyb2R1Y2UKZnVydGhlciBpbmNvbnNpc3RlbmNp
ZXMuCgpKYW4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
Clhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0
dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4A011F7673
	for <lists+xen-devel@lfdr.de>; Mon, 11 Nov 2019 15:34:02 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iUAjb-00021X-35; Mon, 11 Nov 2019 14:32:03 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=SdMF=ZD=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1iUAjZ-00021Q-SN
 for xen-devel@lists.xenproject.org; Mon, 11 Nov 2019 14:32:01 +0000
X-Inumbo-ID: 04f6e5c6-0490-11ea-9631-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 04f6e5c6-0490-11ea-9631-bc764e2007e4;
 Mon, 11 Nov 2019 14:31:59 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 11D91B53B;
 Mon, 11 Nov 2019 14:31:59 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: Juergen Gross <jgross@suse.com>,
 Boris Ostrovsky <boris.ostrovsky@oracle.com>,
 Andy Lutomirski <luto@kernel.org>
References: <d66b1da4-8096-9b77-1ca6-d6b9954b113c@suse.com>
Message-ID: <32d8713d-25a7-84ab-b74b-aa3e88abce6b@suse.com>
Date: Mon, 11 Nov 2019 15:32:12 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.1
MIME-Version: 1.0
In-Reply-To: <d66b1da4-8096-9b77-1ca6-d6b9954b113c@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH 1/2] x86/Xen/32: make xen_iret_crit_fixup
 independent of frame layout
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>,
 the arch/x86 maintainers <x86@kernel.org>, lkml <linux-kernel@vger.kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Tm93IHRoYXQgU1M6RVNQIGFsd2F5cyBnZXQgc2F2ZWQgYnkgU0FWRV9BTEwsIHRoaXMgYWxzbyBu
ZWVkcyB0byBiZQphY2NvdW50ZWQgZm9yIGluIHhlbl9pcmV0X2NyaXRfZml4dXAuIE90aGVyd2lz
ZSB0aGUgb2xkX2F4IHZhbHVlIGdldHMKaW50ZXJwcmV0ZWQgYXMgRUZMQUdTLCBhbmQgaGVuY2Ug
Vk04NiBtb2RlIGFwcGVhcnMgdG8gYmUgYWN0aXZlIGFsbAp0aGUgdGltZSwgbGVhZGluZyB0byBy
YW5kb20gInZtODZfMzI6IG5vIHVzZXJfdm04NjogQkFEIiBsb2cgbWVzc2FnZXMKYWxvbmdzaWRl
IHByb2Nlc3NlcyByYW5kb21seSBjcmFzaGluZy4KClNpbmNlIGZvbGxvd2luZyB0aGUgcHJldmlv
dXMgbW9kZWwgKHNpdHRpbmcgYWZ0ZXIgU0FWRV9BTEwpIHdvdWxkCmZ1cnRoZXIgY29tcGxpY2F0
ZSB0aGUgY29kZSBfYW5kXyByZXRhaW4gdGhlIGRlcGVuZGVuY3kgb2YKeGVuX2lyZXRfY3JpdF9m
aXh1cCBvbiBmcmFtZSBtYW5pcHVsYXRpb25zIGRvbmUgYnkgZW50cnlfMzIuUywgc3dpdGNoCnRo
aW5ncyBhcm91bmQgYW5kIGRvIHRoZSBhZGp1c3RtZW50IGFoZWFkIG9mIFNBVkVfQUxMLgoKRml4
ZXM6IDNjODhjNjkyYzI4NyAoIng4Ni9zdGFja2ZyYW1lLzMyOiBQcm92aWRlIGNvbnNpc3RlbnQg
cHRfcmVncyIpClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4K
Ci0tLSBhL2FyY2gveDg2L2VudHJ5L2VudHJ5XzMyLlMKKysrIGIvYXJjaC94ODYvZW50cnkvZW50
cnlfMzIuUwpAQCAtMTM0MSwxMSArMTM0MSw2IEBAIEVORChzcHVyaW91c19pbnRlcnJ1cHRfYnVn
KQogCiAjaWZkZWYgQ09ORklHX1hFTl9QVgogRU5UUlkoeGVuX2h5cGVydmlzb3JfY2FsbGJhY2sp
Ci0JcHVzaGwJJC0xCQkJCS8qIG9yaWdfYXggPSAtMSA9PiBub3QgYSBzeXN0ZW0gY2FsbCAqLwot
CVNBVkVfQUxMCi0JRU5DT0RFX0ZSQU1FX1BPSU5URVIKLQlUUkFDRV9JUlFTX09GRgotCiAJLyoK
IAkgKiBDaGVjayB0byBzZWUgaWYgd2UgZ290IHRoZSBldmVudCBpbiB0aGUgY3JpdGljYWwKIAkg
KiByZWdpb24gaW4geGVuX2lyZXRfZGlyZWN0LCBhZnRlciB3ZSd2ZSByZWVuYWJsZWQKQEAgLTEz
NTMsMTYgKzEzNDgsMTcgQEAgRU5UUlkoeGVuX2h5cGVydmlzb3JfY2FsbGJhY2spCiAJICogaXJl
dCBpbnN0cnVjdGlvbidzIGJlaGF2aW91ciB3aGVyZSBpdCBkZWxpdmVycyBhCiAJICogcGVuZGlu
ZyBpbnRlcnJ1cHQgd2hlbiBlbmFibGluZyBpbnRlcnJ1cHRzOgogCSAqLwotCW1vdmwJUFRfRUlQ
KCVlc3ApLCAlZWF4Ci0JY21wbAkkeGVuX2lyZXRfc3RhcnRfY3JpdCwgJWVheAorCWNtcGwJJHhl
bl9pcmV0X3N0YXJ0X2NyaXQsICglZXNwKQogCWpiCTFmCi0JY21wbAkkeGVuX2lyZXRfZW5kX2Ny
aXQsICVlYXgKKwljbXBsCSR4ZW5faXJldF9lbmRfY3JpdCwgKCVlc3ApCiAJamFlCTFmCi0KLQlq
bXAJeGVuX2lyZXRfY3JpdF9maXh1cAotCi1FTlRSWSh4ZW5fZG9fdXBjYWxsKQotMToJbW92CSVl
c3AsICVlYXgKKwljYWxsCXhlbl9pcmV0X2NyaXRfZml4dXAKKzE6CisJcHVzaGwJJC0xCQkJCS8q
IG9yaWdfYXggPSAtMSA9PiBub3QgYSBzeXN0ZW0gY2FsbCAqLworCVNBVkVfQUxMCisJRU5DT0RF
X0ZSQU1FX1BPSU5URVIKKwlUUkFDRV9JUlFTX09GRgorCW1vdgklZXNwLCAlZWF4CiAJY2FsbAl4
ZW5fZXZ0Y2huX2RvX3VwY2FsbAogI2lmbmRlZiBDT05GSUdfUFJFRU1QVElPTgogCWNhbGwJeGVu
X21heWJlX3ByZWVtcHRfaGNhbGwKLS0tIGEvYXJjaC94ODYveGVuL3hlbi1hc21fMzIuUworKysg
Yi9hcmNoL3g4Ni94ZW4veGVuLWFzbV8zMi5TCkBAIC0xMjYsMTAgKzEyNiw5IEBAIGh5cGVyX2ly
ZXQ6CiAJLmdsb2JsIHhlbl9pcmV0X3N0YXJ0X2NyaXQsIHhlbl9pcmV0X2VuZF9jcml0CiAKIC8q
Ci0gKiBUaGlzIGlzIGNhbGxlZCBieSB4ZW5faHlwZXJ2aXNvcl9jYWxsYmFjayBpbiBlbnRyeS5T
IHdoZW4gaXQgc2VlcworICogVGhpcyBpcyBjYWxsZWQgYnkgeGVuX2h5cGVydmlzb3JfY2FsbGJh
Y2sgaW4gZW50cnlfMzIuUyB3aGVuIGl0IHNlZXMKICAqIHRoYXQgdGhlIEVJUCBhdCB0aGUgdGlt
ZSBvZiBpbnRlcnJ1cHQgd2FzIGJldHdlZW4KLSAqIHhlbl9pcmV0X3N0YXJ0X2NyaXQgYW5kIHhl
bl9pcmV0X2VuZF9jcml0LiAgV2UncmUgcGFzc2VkIHRoZSBFSVAgaW4KLSAqICVlYXggc28gd2Ug
Y2FuIGRvIGEgbW9yZSByZWZpbmVkIGRldGVybWluYXRpb24gb2Ygd2hhdCB0byBkby4KKyAqIHhl
bl9pcmV0X3N0YXJ0X2NyaXQgYW5kIHhlbl9pcmV0X2VuZF9jcml0LgogICoKICAqIFRoZSBzdGFj
ayBmb3JtYXQgYXQgdGhpcyBwb2ludCBpczoKICAqCS0tLS0tLS0tLS0tLS0tLS0KQEAgLTEzOCwz
NCArMTM3LDIzIEBAIGh5cGVyX2lyZXQ6CiAgKgkgZWZsYWdzCQl9ICBvdXRlciBleGNlcHRpb24g
aW5mbwogICoJIGNzCQl9CiAgKgkgZWlwCQl9Ci0gKgktLS0tLS0tLS0tLS0tLS0tIDwtIGVkaSAo
Y29weSBkZXN0KQotICoJIGVheAkJOiAgb3V0ZXIgZWF4IGlmIGl0IGhhc24ndCBiZWVuIHJlc3Rv
cmVkCiAgKgktLS0tLS0tLS0tLS0tLS0tCi0gKgkgZWZsYWdzCQl9ICBuZXN0ZWQgZXhjZXB0aW9u
IGluZm8KLSAqCSBjcwkJfSAgIChubyBzcy9lc3AgYmVjYXVzZSB3ZSdyZSBuZXN0ZWQKLSAqCSBl
aXAJCX0gICAgZnJvbSB0aGUgc2FtZSByaW5nKQotICoJIG9yaWdfZWF4CX08LSBlc2kgKGNvcHkg
c3JjKQotICoJIC0gLSAtIC0gLSAtIC0gLQotICoJIGZzCQl9Ci0gKgkgZXMJCX0KLSAqCSBkcwkJ
fSAgU0FWRV9BTEwgc3RhdGUKLSAqCSBlYXgJCX0KLSAqCSAgOgkJOgotICoJIGVieAkJfTwtIGVz
cAorICoJIGVheAkJOiAgb3V0ZXIgZWF4IGlmIGl0IGhhc24ndCBiZWVuIHJlc3RvcmVkCiAgKgkt
LS0tLS0tLS0tLS0tLS0tCisgKgkgZWZsYWdzCQl9CisgKgkgY3MJCX0gIG5lc3RlZCBleGNlcHRp
b24gaW5mbworICoJIGVpcAkJfQorICoJIHJldHVybiBhZGRyZXNzCTogKGludG8geGVuX2h5cGVy
dmlzb3JfY2FsbGJhY2spCiAgKgotICogSW4gb3JkZXIgdG8gZGVsaXZlciB0aGUgbmVzdGVkIGV4
Y2VwdGlvbiBwcm9wZXJseSwgd2UgbmVlZCB0byBzaGlmdAotICogZXZlcnl0aGluZyBmcm9tIHRo
ZSByZXR1cm4gYWRkciB1cCB0byB0aGUgZXJyb3IgY29kZSBzbyBpdCBzaXRzCi0gKiBqdXN0IHVu
ZGVyIHRoZSBvdXRlciBleGNlcHRpb24gaW5mby4gIFRoaXMgbWVhbnMgdGhhdCB3aGVuIHdlCi0g
KiBoYW5kbGUgdGhlIGV4Y2VwdGlvbiwgd2UgZG8gaXQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIG91
dGVyCi0gKiBleGNlcHRpb24gcmF0aGVyIHRoYW4gc3RhcnRpbmcgYSBuZXcgb25lLgorICogSW4g
b3JkZXIgdG8gZGVsaXZlciB0aGUgbmVzdGVkIGV4Y2VwdGlvbiBwcm9wZXJseSwgd2UgbmVlZCB0
byBkaXNjYXJkIHRoZQorICogbmVzdGVkIGV4Y2VwdGlvbiBmcmFtZSBzdWNoIHRoYXQgd2hlbiB3
ZSBoYW5kbGUgdGhlIGV4Y2VwdGlvbiwgd2UgZG8gaXQKKyAqIGluIHRoZSBjb250ZXh0IG9mIHRo
ZSBvdXRlciBleGNlcHRpb24gcmF0aGVyIHRoYW4gc3RhcnRpbmcgYSBuZXcgb25lLgogICoKLSAq
IFRoZSBvbmx5IGNhdmVhdCBpcyB0aGF0IGlmIHRoZSBvdXRlciBlYXggaGFzbid0IGJlZW4gcmVz
dG9yZWQgeWV0Ci0gKiAoaWUsIGl0J3Mgc3RpbGwgb24gc3RhY2spLCB3ZSBuZWVkIHRvIGluc2Vy
dCBpdHMgdmFsdWUgaW50byB0aGUKLSAqIFNBVkVfQUxMIHN0YXRlIGJlZm9yZSBnb2luZyBvbiwg
c2luY2UgaXQncyB1c2VybW9kZSBzdGF0ZSB3aGljaCB3ZQotICogZXZlbnR1YWxseSBuZWVkIHRv
IHJlc3RvcmUuCisgKiBUaGUgb25seSBjYXZlYXQgaXMgdGhhdCBpZiB0aGUgb3V0ZXIgZWF4IGhh
c24ndCBiZWVuIHJlc3RvcmVkIHlldCAoaS5lLgorICogaXQncyBzdGlsbCBvbiBzdGFjayksIHdl
IG5lZWQgdG8gcmVzdG9yZSBpdHMgdmFsdWUgaGVyZS4KICAqLwogRU5UUlkoeGVuX2lyZXRfY3Jp
dF9maXh1cCkKKwlwdXNobCAlZWN4CiAJLyoKIAkgKiBQYXJhbm9pYTogTWFrZSBzdXJlIHdlJ3Jl
IHJlYWxseSBjb21pbmcgZnJvbSBrZXJuZWwgc3BhY2UuCiAJICogT25lIGNvdWxkIGltYWdpbmUg
YSBjYXNlIHdoZXJlIHVzZXJzcGFjZSBqdW1wcyBpbnRvIHRoZQpAQCAtMTc2LDMyICsxNjQsMjYg
QEAgRU5UUlkoeGVuX2lyZXRfY3JpdF9maXh1cCkKIAkgKiBqdW1wIGluc3RydWN0aW9uIGl0c2Vs
Ziwgbm90IHRoZSBkZXN0aW5hdGlvbiwgYnV0IHNvbWUKIAkgKiB2aXJ0dWFsIGVudmlyb25tZW50
cyBnZXQgdGhpcyB3cm9uZy4KIAkgKi8KLQltb3ZsIFBUX0NTKCVlc3ApLCAlZWN4CisJbW92bCAz
KjQoJWVzcCksICVlY3gJCS8qIG5lc3RlZCBDUyAqLwogCWFuZGwgJFNFR01FTlRfUlBMX01BU0ss
ICVlY3gKIAljbXBsICRVU0VSX1JQTCwgJWVjeAorCXBvcGwgJWVjeAogCWplIDJmCiAKLQlsZWEg
UFRfT1JJR19FQVgoJWVzcCksICVlc2kKLQlsZWEgUFRfRUZMQUdTKCVlc3ApLCAlZWRpCi0KIAkv
KgogCSAqIElmIGVpcCBpcyBiZWZvcmUgaXJldF9yZXN0b3JlX2VuZCB0aGVuIHN0YWNrCiAJICog
aGFzbid0IGJlZW4gcmVzdG9yZWQgeWV0LgogCSAqLwotCWNtcCAkaXJldF9yZXN0b3JlX2VuZCwg
JWVheAorCWNtcGwgJGlyZXRfcmVzdG9yZV9lbmQsIDEqNCglZXNwKQogCWphZSAxZgogCi0JbW92
bCAwKzQoJWVkaSksICVlYXgJCS8qIGNvcHkgRUFYIChqdXN0IGFib3ZlIHRvcCBvZiBmcmFtZSkg
Ki8KLQltb3ZsICVlYXgsIFBUX0VBWCglZXNwKQotCi0JbGVhIEVTUF9PRkZTRVQoJWVkaSksICVl
ZGkJLyogbW92ZSBkZXN0IHVwIG92ZXIgc2F2ZWQgcmVncyAqLwotCi0JLyogc2V0IHVwIHRoZSBj
b3B5ICovCi0xOglzdGQKLQltb3YgJFBUX0VJUCAvIDQsICVlY3gJCS8qIHNhdmVkIHJlZ3MgdXAg
dG8gb3JpZ19lYXggKi8KLQlyZXAgbW92c2wKLQljbGQKLQotCWxlYSA0KCVlZGkpLCAlZXNwCQkv
KiBwb2ludCBlc3AgdG8gbmV3IGZyYW1lICovCi0yOglqbXAgeGVuX2RvX3VwY2FsbAotCisJbW92
bCA0KjQoJWVzcCksICVlYXgJCS8qIGxvYWQgb3V0ZXIgRUFYICovCisJcmV0ICQ0KjQJCQkvKiBk
aXNjYXJkIG5lc3RlZCBFSVAsIENTLCBhbmQgRUZMQUdTIGFzCisJCQkJCSAqIHdlbGwgYXMgdGhl
IGp1c3QgcmVzdG9yZWQgRUFYICovCisKKzE6CisJcmV0ICQzKjQJCQkvKiBkaXNjYXJkIG5lc3Rl
ZCBFSVAsIENTLCBhbmQgRUZMQUdTICovCisKKzI6CisJcmV0CitFTkQoeGVuX2lyZXRfY3JpdF9m
aXh1cCkKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpY
ZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRw
czovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

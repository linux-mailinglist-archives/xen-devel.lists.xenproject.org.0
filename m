Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DE41E79019
	for <lists+xen-devel@lfdr.de>; Mon, 29 Jul 2019 18:00:29 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hs828-0002fs-6n; Mon, 29 Jul 2019 15:57:56 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Q6P6=V2=citrix.com=anthony.perard@srs-us1.protection.inumbo.net>)
 id 1hs826-0002ee-1e
 for xen-devel@lists.xenproject.org; Mon, 29 Jul 2019 15:57:54 +0000
X-Inumbo-ID: 9ea0acee-b219-11e9-a07c-e71bd933fb2f
Received: from esa3.hc3370-68.iphmx.com (unknown [216.71.145.155])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 9ea0acee-b219-11e9-a07c-e71bd933fb2f;
 Mon, 29 Jul 2019 15:57:51 +0000 (UTC)
Authentication-Results: esa3.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=anthony.perard@citrix.com;
 spf=Pass smtp.mailfrom=anthony.perard@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 anthony.perard@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="anthony.perard@citrix.com";
 x-sender="anthony.perard@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa3.hc3370-68.iphmx.com: domain of
 anthony.perard@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="anthony.perard@citrix.com";
 x-sender="anthony.perard@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="anthony.perard@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: OC6mMAihpiEm/z+j/9INK1n1VEKj4W74Jcaqh/22VSU8VzgAaAfdeua/gSU/m9dGf+hD9W5bBM
 bfRudTxQXubG+kvoSr79HxZqLtG0QrdaLhiFWVWe30sg9qTAs3xMl/5SC59lxbZOwHch7w/n96
 RexiAZDQ4ygq1okVTHMn8aisiS9UABWicwFCxOldgbfQ40bcFCdmA9BYc18JSTEPoRA5oNBiK5
 Ji80P7qaXUk1apXSTxZWRlGVqjcShqV3Jwf+qrMNWb3zyJgI0/7IiBmFqazAfMAax5DOg434iG
 Bj0=
X-SBRS: 2.7
X-MesageID: 3579626
X-Ironport-Server: esa3.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,323,1559534400"; 
   d="scan'208";a="3579626"
From: Anthony PERARD <anthony.perard@citrix.com>
To: <devel@edk2.groups.io>
Date: Mon, 29 Jul 2019 16:39:32 +0100
Message-ID: <20190729153944.24239-24-anthony.perard@citrix.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190729153944.24239-1-anthony.perard@citrix.com>
References: <20190729153944.24239-1-anthony.perard@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v4 23/35] OvmfPkg/XenPlatformPei: Rework memory
 detection
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Ard Biesheuvel <ard.biesheuvel@linaro.org>,
 Jordan Justen <jordan.l.justen@intel.com>, Julien Grall <julien.grall@arm.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Anthony PERARD <anthony.perard@citrix.com>, xen-devel@lists.xenproject.org,
 Laszlo Ersek <lersek@redhat.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

V2hlbiBydW5uaW5nIGFzIGEgWGVuIFBWSCBndWVzdCwgdGhlcmUgaXMgbm8gQ01PUyB0byByZWFk
IHRoZSBtZW1vcnkKc2l6ZSBmcm9tLiAgUmV3b3JrIEdldFN5c3RlbU1lbW9yeVNpemUoQmVsb3d8
QWJvdmUpNGdiKCkgc28gdGhleSBjYW4Kd29yayB3aXRob3V0IENNT1MgYnkgcmVhZGluZyB0aGUg
ZTgyMCB0YWJsZS4KClJld29yayBYZW5QdWJsaXNoUmFtUmVnaW9ucyB0byBhbHNvIGNhcmUgZm9y
IHRoZSByZXNlcnZlZCBhbmQgQUNQSQplbnRyeSBpbiB0aGUgZTgyMCB0YWJsZS4gVGhlIHJlZ2lv
biB0aGF0IHdhcyBhZGRlZCBieSBJbml0aWFsaXplWGVuKCkKaXNuJ3QgbmVlZGVkIGFzIHRoYXQg
c2FtZSBlbnRyeSBpcyBpbiB0aGUgZTgyMCB0YWJsZSBwcm92aWRlZCBieQpodm1sb2FkZXIuCgpN
VFJSIHNldHRpbmdzIGFyZW4ndCBtb2RpZmllZCBhbnltb3JlLCBvbiBIVk0gaXQncyBhbHJlYWR5
IGRvbmUgYnkKaHZtbG9hZGVyLCBvbiBQVkggaXQgaXMgc3VwcG9zZWQgdG8gaGF2ZSBzYW5lIGRl
ZmF1bHQuIE1UUlIgd2lsbCBuZWVkCnRvIGJlIGRvbmUgcHJvcGVybHkgYnV0IGtlZXBpbmcgd2hh
dCdzIGFscmVhZHkgYmVlbiBkb25lIGJ5IHByb2dyYW1tZXMKdGhhdCBoYXMgcnVubmVkIGJlZm9y
ZSBPVk1GIHdpbGwgZG8gZm9yIG5vdy4KClJlZjogaHR0cHM6Ly9idWd6aWxsYS50aWFub2NvcmUu
b3JnL3Nob3dfYnVnLmNnaT9pZD0xNjg5ClNpZ25lZC1vZmYtYnk6IEFudGhvbnkgUEVSQVJEIDxh
bnRob255LnBlcmFyZEBjaXRyaXguY29tPgpBY2tlZC1ieTogTGFzemxvIEVyc2VrIDxsZXJzZWtA
cmVkaGF0LmNvbT4KLS0tCgpOb3RlczoKICAgIHY0OgogICAgLSBzb21lIGNvZGluZyBzdHlsZQog
ICAgLSBBZGRlZCBBZGRSZXNlcnZlZE1lbW9yeVJhbmdlSG9iLCBhbmQgdXNpbmcgaXQuCiAgICAt
IHRoaXMgcGF0Y2ggbm93IHJlcGxhY2UgIk92bWZQa2cvWGVuUGxhdGZvcm1QZWk6IFJlc2VydmUg
aHZtbG9hZGVyJ3MgbWVtb3J5IG9ubHkgd2hlbiBpdCBoYXMgcnVuIgogICAgICBmcm9tIHYzLiAg
aHZtbG9hZGVyIGhhdmUgYWRkZWQgYW4gZW50cnkgaW4gdGhlIGU4MjAgdGFibGUsIHRoZXJlIGlz
IG5vCiAgICAgIG5lZWQgZm9yIGEgc3BlY2lhbCBjYXNlLgogICAgLSBub3csIGV2ZXJ5dGhpbmcg
dGhhdCBpcyBpbiB0aGUgZTgyMCB0YWJsZSBpcyBhZGRlZCB0byBPVk1GJ3MgbWVtb3J5CiAgICAg
IG1hcCwgbm8gbW9yZSBza2lwcGluZyBBQ1BJIGVudHJpZXMgb3IgaHZtbG9hZGVyJ3MgcmVzZXJ2
ZWQgZW50cmllcy4KICAgICAgSW5zdGVhZCwgd2UgbG9vayBmb3IgdGhlIGxvY2FsIEFQSUMgcmVn
aW9uIGFuZCBhdm9pZCBpdCBpZiBpdCBpcwogICAgICBwcmVzZW50IGluIHRoZSBlODIwLgogICAg
LSByZXdvcmsgY29tbWl0IG1lc3NhZ2UKCiBPdm1mUGtnL1hlblBsYXRmb3JtUGVpL1BsYXRmb3Jt
LmggIHwgMTMgKysrKysrCiBPdm1mUGtnL1hlblBsYXRmb3JtUGVpL01lbURldGVjdC5jIHwgNjkg
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIE92bWZQa2cvWGVuUGxhdGZvcm1QZWkvUGxh
dGZvcm0uYyAgfCAxMSArKysrKwogT3ZtZlBrZy9YZW5QbGF0Zm9ybVBlaS9YZW4uYyAgICAgICB8
IDcwICsrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLQogNCBmaWxlcyBjaGFuZ2VkLCAxMzcg
aW5zZXJ0aW9ucygrKSwgMjYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvT3ZtZlBrZy9YZW5Q
bGF0Zm9ybVBlaS9QbGF0Zm9ybS5oIGIvT3ZtZlBrZy9YZW5QbGF0Zm9ybVBlaS9QbGF0Zm9ybS5o
CmluZGV4IGRiOWE2MjU3MmYuLjc2NjFmNGE4ZGUgMTAwNjQ0Ci0tLSBhL092bWZQa2cvWGVuUGxh
dGZvcm1QZWkvUGxhdGZvcm0uaAorKysgYi9Pdm1mUGtnL1hlblBsYXRmb3JtUGVpL1BsYXRmb3Jt
LmgKQEAgLTQ0LDYgKzQ0LDEzIEBAIEFkZFJlc2VydmVkTWVtb3J5QmFzZVNpemVIb2IgKAogICBC
T09MRUFOICAgICAgICAgICAgICAgICAgICAgQ2FjaGVhYmxlDQogICApOw0KIA0KK1ZPSUQNCitB
ZGRSZXNlcnZlZE1lbW9yeVJhbmdlSG9iICgNCisgIEVGSV9QSFlTSUNBTF9BRERSRVNTICAgICAg
ICBNZW1vcnlCYXNlLA0KKyAgRUZJX1BIWVNJQ0FMX0FERFJFU1MgICAgICAgIE1lbW9yeUxpbWl0
LA0KKyAgQk9PTEVBTiAgICAgICAgICAgICAgICAgICAgIENhY2hlYWJsZQ0KKyAgKTsNCisNCiBW
T0lEDQogQWRkcmVzc1dpZHRoSW5pdGlhbGl6YXRpb24gKA0KICAgVk9JRA0KQEAgLTExNCw2ICsx
MjEsMTIgQEAgWGVuUHVibGlzaFJhbVJlZ2lvbnMgKAogICBWT0lEDQogICApOw0KIA0KK0VGSV9T
VEFUVVMNCitYZW5HZXRFODIwTWFwICgNCisgIEVGSV9FODIwX0VOVFJZNjQgKipFbnRyaWVzLA0K
KyAgVUlOVDMyICpDb3VudA0KKyAgKTsNCisNCiBleHRlcm4gRUZJX0JPT1RfTU9ERSBtQm9vdE1v
ZGU7DQogDQogZXh0ZXJuIFVJTlQ4IG1QaHlzTWVtQWRkcmVzc1dpZHRoOw0KZGlmZiAtLWdpdCBh
L092bWZQa2cvWGVuUGxhdGZvcm1QZWkvTWVtRGV0ZWN0LmMgYi9Pdm1mUGtnL1hlblBsYXRmb3Jt
UGVpL01lbURldGVjdC5jCmluZGV4IGNmOTVmOWM0NzQuLjFmODFlZWU0MDcgMTAwNjQ0Ci0tLSBh
L092bWZQa2cvWGVuUGxhdGZvcm1QZWkvTWVtRGV0ZWN0LmMKKysrIGIvT3ZtZlBrZy9YZW5QbGF0
Zm9ybVBlaS9NZW1EZXRlY3QuYwpAQCAtOTYsNiArOTYsNDUgQEAgUTM1VHNlZ01ieXRlc0luaXRp
YWxpemF0aW9uICgKICAgbVEzNVRzZWdNYnl0ZXMgPSBFeHRlbmRlZFRzZWdNYnl0ZXM7DQogfQ0K
IA0KK1NUQVRJQw0KK1VJTlQ2NA0KK0dldEhpZ2hlc3RTeXN0ZW1NZW1vcnlBZGRyZXNzICgNCisg
IEJPT0xFQU4gICAgICAgQmVsb3c0Z2INCisgICkNCit7DQorICBFRklfRTgyMF9FTlRSWTY0ICAg
ICpFODIwTWFwOw0KKyAgVUlOVDMyICAgICAgICAgICAgICBFODIwRW50cmllc0NvdW50Ow0KKyAg
RUZJX0U4MjBfRU5UUlk2NCAgICAqRW50cnk7DQorICBFRklfU1RBVFVTICAgICAgICAgIFN0YXR1
czsNCisgIFVJTlQzMiAgICAgICAgICAgICAgTG9vcDsNCisgIFVJTlQ2NCAgICAgICAgICAgICAg
SGlnaGVzdEFkZHJlc3M7DQorICBVSU5UNjQgICAgICAgICAgICAgIEVudHJ5RW5kOw0KKw0KKyAg
SGlnaGVzdEFkZHJlc3MgPSAwOw0KKw0KKyAgU3RhdHVzID0gWGVuR2V0RTgyME1hcCAoJkU4MjBN
YXAsICZFODIwRW50cmllc0NvdW50KTsNCisgIEFTU0VSVF9FRklfRVJST1IgKFN0YXR1cyk7DQor
DQorICBmb3IgKExvb3AgPSAwOyBMb29wIDwgRTgyMEVudHJpZXNDb3VudDsgTG9vcCsrKSB7DQor
ICAgIEVudHJ5ID0gRTgyME1hcCArIExvb3A7DQorICAgIEVudHJ5RW5kID0gRW50cnktPkJhc2VB
ZGRyICsgRW50cnktPkxlbmd0aDsNCisNCisgICAgaWYgKEVudHJ5LT5UeXBlID09IEVmaUFjcGlB
ZGRyZXNzUmFuZ2VNZW1vcnkgJiYNCisgICAgICAgIEVudHJ5RW5kID4gSGlnaGVzdEFkZHJlc3Mp
IHsNCisNCisgICAgICBpZiAoQmVsb3c0Z2IgJiYgKEVudHJ5RW5kIDw9IEJBU0VfNEdCKSkgew0K
KyAgICAgICAgSGlnaGVzdEFkZHJlc3MgPSBFbnRyeUVuZDsNCisgICAgICB9IGVsc2UgaWYgKCFC
ZWxvdzRnYiAmJiAoRW50cnlFbmQgPj0gQkFTRV80R0IpKSB7DQorICAgICAgICBIaWdoZXN0QWRk
cmVzcyA9IEVudHJ5RW5kOw0KKyAgICAgIH0NCisgICAgfQ0KKyAgfQ0KKw0KKyAgLy8NCisgIC8v
IFJvdW5kIGRvd24gdGhlIGVuZCBhZGRyZXNzLg0KKyAgLy8NCisgIHJldHVybiBIaWdoZXN0QWRk
cmVzcyAmIH4oVUlOVDY0KUVGSV9QQUdFX01BU0s7DQorfQ0KIA0KIFVJTlQzMg0KIEdldFN5c3Rl
bU1lbW9yeVNpemVCZWxvdzRnYiAoDQpAQCAtMTA1LDYgKzE0NCwxOSBAQCBHZXRTeXN0ZW1NZW1v
cnlTaXplQmVsb3c0Z2IgKAogICBVSU5UOCBDbW9zMHgzNDsNCiAgIFVJTlQ4IENtb3MweDM1Ow0K
IA0KKyAgLy8NCisgIC8vIEluIFBWSCBjYXNlLCB0aGVyZSBpcyBubyBDTU9TLCB3ZSBoYXZlIHRv
IGNhbGN1bGF0ZSB0aGUgbWVtb3J5IHNpemUNCisgIC8vIGZyb20gcGFyc2luZyB0aGUgRTgyMA0K
KyAgLy8NCisgIGlmIChYZW5QdmhEZXRlY3RlZCAoKSkgew0KKyAgICBVSU5UNjQgIEhpZ2hlc3RB
ZGRyZXNzOw0KKw0KKyAgICBIaWdoZXN0QWRkcmVzcyA9IEdldEhpZ2hlc3RTeXN0ZW1NZW1vcnlB
ZGRyZXNzIChUUlVFKTsNCisgICAgQVNTRVJUIChIaWdoZXN0QWRkcmVzcyA+IDAgJiYgSGlnaGVz
dEFkZHJlc3MgPD0gQkFTRV80R0IpOw0KKw0KKyAgICByZXR1cm4gSGlnaGVzdEFkZHJlc3M7DQor
ICB9DQorDQogICAvLw0KICAgLy8gQ01PUyAweDM0LzB4MzUgc3BlY2lmaWVzIHRoZSBzeXN0ZW0g
bWVtb3J5IGFib3ZlIDE2IE1CLg0KICAgLy8gKiBDTU9TKDB4MzUpIGlzIHRoZSBoaWdoIGJ5dGUN
CkBAIC0xMjksNiArMTgxLDIzIEBAIEdldFN5c3RlbU1lbW9yeVNpemVBYm92ZTRnYiAoCiAgIFVJ
TlQzMiBTaXplOw0KICAgVUlOVE4gIENtb3NJbmRleDsNCiANCisgIC8vDQorICAvLyBJbiBQVkgg
Y2FzZSwgdGhlcmUgaXMgbm8gQ01PUywgd2UgaGF2ZSB0byBjYWxjdWxhdGUgdGhlIG1lbW9yeSBz
aXplDQorICAvLyBmcm9tIHBhcnNpbmcgdGhlIEU4MjANCisgIC8vDQorICBpZiAoWGVuUHZoRGV0
ZWN0ZWQgKCkpIHsNCisgICAgVUlOVDY0ICBIaWdoZXN0QWRkcmVzczsNCisNCisgICAgSGlnaGVz
dEFkZHJlc3MgPSBHZXRIaWdoZXN0U3lzdGVtTWVtb3J5QWRkcmVzcyAoRkFMU0UpOw0KKyAgICBB
U1NFUlQgKEhpZ2hlc3RBZGRyZXNzID09IDAgfHwgSGlnaGVzdEFkZHJlc3MgPj0gQkFTRV80R0Ip
Ow0KKw0KKyAgICBpZiAoSGlnaGVzdEFkZHJlc3MgPj0gQkFTRV80R0IpIHsNCisgICAgICBIaWdo
ZXN0QWRkcmVzcyAtPSBCQVNFXzRHQjsNCisgICAgfQ0KKw0KKyAgICByZXR1cm4gSGlnaGVzdEFk
ZHJlc3M7DQorICB9DQorDQogICAvLw0KICAgLy8gQ01PUyAweDViLTB4NWQgc3BlY2lmaWVzIHRo
ZSBzeXN0ZW0gbWVtb3J5IGFib3ZlIDRHQiBNQi4NCiAgIC8vICogQ01PUygweDVkKSBpcyB0aGUg
bW9zdCBzaWduaWZpY2FudCBzaXplIGJ5dGUNCmRpZmYgLS1naXQgYS9Pdm1mUGtnL1hlblBsYXRm
b3JtUGVpL1BsYXRmb3JtLmMgYi9Pdm1mUGtnL1hlblBsYXRmb3JtUGVpL1BsYXRmb3JtLmMKaW5k
ZXggNmFhYWZjM2VlOS4uMmY0MmNhNmNjZCAxMDA2NDQKLS0tIGEvT3ZtZlBrZy9YZW5QbGF0Zm9y
bVBlaS9QbGF0Zm9ybS5jCisrKyBiL092bWZQa2cvWGVuUGxhdGZvcm1QZWkvUGxhdGZvcm0uYwpA
QCAtMTAyLDYgKzEwMiwxNyBAQCBBZGRSZXNlcnZlZE1lbW9yeUJhc2VTaXplSG9iICgKICAgICAp
Ow0KIH0NCiANCitWT0lEDQorQWRkUmVzZXJ2ZWRNZW1vcnlSYW5nZUhvYiAoDQorICBFRklfUEhZ
U0lDQUxfQUREUkVTUyAgICAgICAgTWVtb3J5QmFzZSwNCisgIEVGSV9QSFlTSUNBTF9BRERSRVNT
ICAgICAgICBNZW1vcnlMaW1pdCwNCisgIEJPT0xFQU4gICAgICAgICAgICAgICAgICAgICBDYWNo
ZWFibGUNCisgICkNCit7DQorICBBZGRSZXNlcnZlZE1lbW9yeUJhc2VTaXplSG9iIChNZW1vcnlC
YXNlLA0KKyAgICAoVUlOVDY0KShNZW1vcnlMaW1pdCAtIE1lbW9yeUJhc2UpLCBDYWNoZWFibGUp
Ow0KK30NCisNCiBWT0lEDQogQWRkSW9NZW1vcnlSYW5nZUhvYiAoDQogICBFRklfUEhZU0lDQUxf
QUREUkVTUyAgICAgICAgTWVtb3J5QmFzZSwNCmRpZmYgLS1naXQgYS9Pdm1mUGtnL1hlblBsYXRm
b3JtUGVpL1hlbi5jIGIvT3ZtZlBrZy9YZW5QbGF0Zm9ybVBlaS9YZW4uYwppbmRleCBhMjFkNjU3
MzU3Li4xODJlOTZjYzViIDEwMDY0NAotLS0gYS9Pdm1mUGtnL1hlblBsYXRmb3JtUGVpL1hlbi5j
CisrKyBiL092bWZQa2cvWGVuUGxhdGZvcm1QZWkvWGVuLmMKQEAgLTI3Niw5ICsyNzYsMTIgQEAg
WGVuUHVibGlzaFJhbVJlZ2lvbnMgKAogICBWT0lEDQogICApDQogew0KLSAgRUZJX0U4MjBfRU5U
Ulk2NCAgKkU4MjBNYXA7DQotICBVSU5UMzIgICAgICAgICAgICBFODIwRW50cmllc0NvdW50Ow0K
LSAgRUZJX1NUQVRVUyAgICAgICAgU3RhdHVzOw0KKyAgRUZJX0U4MjBfRU5UUlk2NCAgICAgICpF
ODIwTWFwOw0KKyAgVUlOVDMyICAgICAgICAgICAgICAgIEU4MjBFbnRyaWVzQ291bnQ7DQorICBF
RklfU1RBVFVTICAgICAgICAgICAgU3RhdHVzOw0KKyAgRUZJX0U4MjBfRU5UUlk2NCAgICAgICpF
bnRyeTsNCisgIFVJTlROICAgICAgICAgICAgICAgICBJbmRleDsNCisgIEVGSV9QSFlTSUNBTF9B
RERSRVNTICBMb2NhbEFwaWM7DQogDQogICBERUJVRyAoKERFQlVHX0lORk8sICJVc2luZyBtZW1v
cnkgbWFwIHByb3ZpZGVkIGJ5IFhlblxuIikpOw0KIA0KQEAgLTI4NywyNiArMjkwLDQ3IEBAIFhl
blB1Ymxpc2hSYW1SZWdpb25zICgKICAgLy8NCiAgIEU4MjBFbnRyaWVzQ291bnQgPSAwOw0KICAg
U3RhdHVzID0gWGVuR2V0RTgyME1hcCAoJkU4MjBNYXAsICZFODIwRW50cmllc0NvdW50KTsNCi0N
CiAgIEFTU0VSVF9FRklfRVJST1IgKFN0YXR1cyk7DQogDQotICBpZiAoRTgyMEVudHJpZXNDb3Vu
dCA+IDApIHsNCi0gICAgRUZJX0U4MjBfRU5UUlk2NCAqRW50cnk7DQotICAgIFVJTlQzMiBMb29w
Ow0KLQ0KLSAgICBmb3IgKExvb3AgPSAwOyBMb29wIDwgRTgyMEVudHJpZXNDb3VudDsgTG9vcCsr
KSB7DQotICAgICAgRW50cnkgPSBFODIwTWFwICsgTG9vcDsNCi0NCi0gICAgICAvLw0KLSAgICAg
IC8vIE9ubHkgY2FyZSBhYm91dCBSQU0NCi0gICAgICAvLw0KLSAgICAgIGlmIChFbnRyeS0+VHlw
ZSAhPSBFZmlBY3BpQWRkcmVzc1JhbmdlTWVtb3J5KSB7DQotICAgICAgICBjb250aW51ZTsNCisg
IExvY2FsQXBpYyA9IFBjZEdldDMyKFBjZENwdUxvY2FsQXBpY0Jhc2VBZGRyZXNzKTsNCisgIEFk
ZElvTWVtb3J5QmFzZVNpemVIb2IgKExvY2FsQXBpYywgU0laRV8xTUIpOw0KKw0KKyAgZm9yIChJ
bmRleCA9IDA7IEluZGV4IDwgRTgyMEVudHJpZXNDb3VudDsgSW5kZXgrKykgew0KKyAgICBVSU5U
NjQgQmFzZTsNCisgICAgVUlOVDY0IEVuZDsNCisNCisgICAgRW50cnkgPSAmRTgyME1hcFtJbmRl
eF07DQorDQorICAgIC8vDQorICAgIC8vIFJvdW5kIHVwIHRoZSBzdGFydCBhZGRyZXNzLCBhbmQg
cm91bmQgZG93biB0aGUgZW5kIGFkZHJlc3MuDQorICAgIC8vDQorICAgIEJhc2UgPSBBTElHTl9W
QUxVRSAoRW50cnktPkJhc2VBZGRyLCAoVUlOVDY0KUVGSV9QQUdFX1NJWkUpOw0KKyAgICBFbmQg
PSAoRW50cnktPkJhc2VBZGRyICsgRW50cnktPkxlbmd0aCkgJiB+KFVJTlQ2NClFRklfUEFHRV9N
QVNLOw0KKw0KKyAgICBzd2l0Y2ggKEVudHJ5LT5UeXBlKSB7DQorICAgIGNhc2UgRWZpQWNwaUFk
ZHJlc3NSYW5nZU1lbW9yeToNCisgICAgICBBZGRNZW1vcnlSYW5nZUhvYiAoQmFzZSwgRW5kKTsN
CisgICAgICBicmVhazsNCisgICAgY2FzZSBFZmlBY3BpQWRkcmVzc1JhbmdlQUNQSToNCisgICAg
ICBBZGRSZXNlcnZlZE1lbW9yeVJhbmdlSG9iIChCYXNlLCBFbmQsIEZBTFNFKTsNCisgICAgICBi
cmVhazsNCisgICAgY2FzZSBFZmlBY3BpQWRkcmVzc1JhbmdlUmVzZXJ2ZWQ6DQorICAgICAgaWYg
KEJhc2UgPCBMb2NhbEFwaWMgJiYgTG9jYWxBcGljIDwgRW5kKSB7DQorICAgICAgICAvLw0KKyAg
ICAgICAgLy8gaHZtbG9hZGVyIG1hcmtzIGEgcmFuZ2UgdGhhdCBvdmVybGFwcyB3aXRoIHRoZSBs
b2NhbCBBUElDIG1lbW9yeQ0KKyAgICAgICAgLy8gbWFwcGVkIHJlZ2lvbiBhcyByZXNlcnZlZCwg
YnV0IENwdUR4ZSB3YW50cyBpdCBhcyBtYXBwZWQgSU8uIFdlDQorICAgICAgICAvLyBoYXZlIGFs
cmVhZHkgYWRkZWQgaXQgYXMgbWFwcGVkIElPLCBzbyBza2lwIGl0IGhlcmUuDQorICAgICAgICAv
Lw0KKyAgICAgICAgQWRkUmVzZXJ2ZWRNZW1vcnlSYW5nZUhvYiAoQmFzZSwgTG9jYWxBcGljLCBG
QUxTRSk7DQorICAgICAgICBpZiAoRW5kID4gKExvY2FsQXBpYyArIFNJWkVfMU1CKSkgew0KKyAg
ICAgICAgICBBZGRSZXNlcnZlZE1lbW9yeVJhbmdlSG9iIChMb2NhbEFwaWMgKyBTSVpFXzFNQiwg
RW5kLCBGQUxTRSk7DQorICAgICAgICB9DQorICAgICAgfSBlbHNlIHsNCisgICAgICAgIEFkZFJl
c2VydmVkTWVtb3J5UmFuZ2VIb2IgKEJhc2UsIEVuZCwgRkFMU0UpOw0KICAgICAgIH0NCi0NCi0g
ICAgICBBZGRNZW1vcnlCYXNlU2l6ZUhvYiAoRW50cnktPkJhc2VBZGRyLCBFbnRyeS0+TGVuZ3Ro
KTsNCi0NCi0gICAgICBNdHJyU2V0TWVtb3J5QXR0cmlidXRlIChFbnRyeS0+QmFzZUFkZHIsIEVu
dHJ5LT5MZW5ndGgsIENhY2hlV3JpdGVCYWNrKTsNCisgICAgICBicmVhazsNCisgICAgZGVmYXVs
dDoNCisgICAgICBicmVhazsNCiAgICAgfQ0KICAgfQ0KIH0NCkBAIC0zMjYsMTIgKzM1MCw2IEBA
IEluaXRpYWxpemVYZW4gKAogew0KICAgUkVUVVJOX1NUQVRVUyBQY2RTdGF0dXM7DQogDQotICAv
Lw0KLSAgLy8gUmVzZXJ2ZSBhd2F5IEhWTUxPQURFUiByZXNlcnZlZCBtZW1vcnkgWzB4RkMwMDAw
MDAsMHhGRDAwMDAwMCkuDQotICAvLyBUaGlzIG5lZWRzIHRvIG1hdGNoIEhWTUxPQURFUiBSRVNF
UlZFRF9NRU1CQVNFL1JFU0VSVkVEX01FTVNJWkUuDQotICAvLw0KLSAgQWRkUmVzZXJ2ZWRNZW1v
cnlCYXNlU2l6ZUhvYiAoMHhGQzAwMDAwMCwgMHgxMDAwMDAwLCBGQUxTRSk7DQotDQogICBQY2RT
dGF0dXMgPSBQY2RTZXRCb29sUyAoUGNkUGNpRGlzYWJsZUJ1c0VudW1lcmF0aW9uLCBUUlVFKTsN
CiAgIEFTU0VSVF9SRVRVUk5fRVJST1IgKFBjZFN0YXR1cyk7DQogDQotLSAKQW50aG9ueSBQRVJB
UkQKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C82ACB2AA1
	for <lists+xen-devel@lfdr.de>; Sat, 14 Sep 2019 10:56:12 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i93nq-0007a0-Fj; Sat, 14 Sep 2019 08:53:10 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=rDpt=XJ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1i93no-0007YR-MQ
 for xen-devel@lists.xenproject.org; Sat, 14 Sep 2019 08:53:08 +0000
X-Inumbo-ID: 0b0ea304-d6cd-11e9-95c1-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 0b0ea304-d6cd-11e9-95c1-12813bfff9fa;
 Sat, 14 Sep 2019 08:52:55 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id CC780B061;
 Sat, 14 Sep 2019 08:52:54 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 14 Sep 2019 10:52:06 +0200
Message-Id: <20190914085251.18816-3-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190914085251.18816-1-jgross@suse.com>
References: <20190914085251.18816-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v3 02/47] xen/sched: move per-vcpu scheduler
 private data pointer to sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBwcmVwYXJlcyBtYWtpbmcgdGhlIGRpZmZlcmVudCBzY2hlZHVsZXJzIHZjcHUgYWdub3N0
aWMuCgpOb3RlIHRoYXQgc29tZSBzY2hlZHVsZXIgc3BlY2lmaWMgYWNjZXNzb3IgZnVuY3Rpb24g
YXJlIG1pc25hbWVkIGFmdGVyCnRoaXMgcGF0Y2guIFRoaXMgd2lsbCBiZSBjb3JyZWN0ZWQgaW4g
bGF0ZXIgcGF0Y2hlcy4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNl
LmNvbT4KUmV2aWV3ZWQtYnk6IERhcmlvIEZhZ2dpb2xpIDxkZmFnZ2lvbGlAc3VzZS5jb20+Ci0t
LQogeGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jIHwgIDQgKystLQogeGVuL2NvbW1vbi9zY2hl
ZF9jcmVkaXQuYyAgIHwgIDYgKysrLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyAgfCAx
MCArKysrKy0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX251bGwuYyAgICAgfCAgNCArKy0tCiB4ZW4v
Y29tbW9uL3NjaGVkX3J0LmMgICAgICAgfCAgNCArKy0tCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMg
ICAgICAgfCAxNCArKysrKysrLS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggICAgIHwg
IDIgKy0KIDcgZmlsZXMgY2hhbmdlZCwgMjIgaW5zZXJ0aW9ucygrKSwgMjIgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jIGIveGVuL2NvbW1vbi9z
Y2hlZF9hcmluYzY1My5jCmluZGV4IGU4YjEzYTAwMjIuLmNkZjVjMmNjOTcgMTAwNjQ0Ci0tLSBh
L3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2FyaW5j
NjUzLmMKQEAgLTUzLDcgKzUzLDcgQEAKICAqIFJldHVybiBhIHBvaW50ZXIgdG8gdGhlIEFSSU5D
IDY1My1zcGVjaWZpYyBzY2hlZHVsZXIgZGF0YSBpbmZvcm1hdGlvbgogICogYXNzb2NpYXRlZCB3
aXRoIHRoZSBnaXZlbiBWQ1BVICh2YykKICAqLwotI2RlZmluZSBBVkNQVSh2YykgKChhcmluYzY1
M192Y3B1X3QgKikodmMpLT5zY2hlZF9wcml2KQorI2RlZmluZSBBVkNQVSh2YykgKChhcmluYzY1
M192Y3B1X3QgKikodmMpLT5zY2hlZF91bml0LT5wcml2KQogCiAvKioKICAqIFJldHVybiB0aGUg
Z2xvYmFsIHNjaGVkdWxlciBwcml2YXRlIGRhdGEgZ2l2ZW4gdGhlIHNjaGVkdWxlciBvcHMgcG9p
bnRlcgpAQCAtNjQ3LDcgKzY0Nyw3IEBAIGE2NTNfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVs
ZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAKICAgICBBU1NFUlQoIXBkYXRhICYmIHN2
YyAmJiBpc19pZGxlX3ZjcHUoc3ZjLT52YykpOwogCi0gICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVk
X3ByaXYgPSB2ZGF0YTsKKyAgICBpZGxlX3ZjcHVbY3B1XS0+c2NoZWRfdW5pdC0+cHJpdiA9IHZk
YXRhOwogCiAgICAgcmV0dXJuICZzZC0+X2xvY2s7CiB9CmRpZmYgLS1naXQgYS94ZW4vY29tbW9u
L3NjaGVkX2NyZWRpdC5jIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwppbmRleCA5NGQ3MzNk
Y2I1Li5mNDM3MWQ3YzVlIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCisr
KyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKQEAgLTgzLDcgKzgzLDcgQEAKICAgICAoKHN0
cnVjdCBjc2NoZWRfcHJpdmF0ZSAqKSgoX29wcyktPnNjaGVkX2RhdGEpKQogI2RlZmluZSBDU0NI
RURfUENQVShfYykgICAgIFwKICAgICAoKHN0cnVjdCBjc2NoZWRfcGNwdSAqKXBlcl9jcHUoc2No
ZWR1bGVfZGF0YSwgX2MpLnNjaGVkX3ByaXYpCi0jZGVmaW5lIENTQ0hFRF9WQ1BVKF92Y3B1KSAg
KChzdHJ1Y3QgY3NjaGVkX3ZjcHUgKikgKF92Y3B1KS0+c2NoZWRfcHJpdikKKyNkZWZpbmUgQ1ND
SEVEX1ZDUFUoX3ZjcHUpICAoKHN0cnVjdCBjc2NoZWRfdmNwdSAqKSAoX3ZjcHUpLT5zY2hlZF91
bml0LT5wcml2KQogI2RlZmluZSBDU0NIRURfRE9NKF9kb20pICAgICgoc3RydWN0IGNzY2hlZF9k
b20gKikgKF9kb20pLT5zY2hlZF9wcml2KQogI2RlZmluZSBSVU5RKF9jcHUpICAgICAgICAgICgm
KENTQ0hFRF9QQ1BVKF9jcHUpLT5ydW5xKSkKIApAQCAtNjM0LDcgKzYzNCw3IEBAIGNzY2hlZF9z
d2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxlciAqbmV3X29wcywgdW5zaWduZWQgaW50IGNwdSwK
IAogICAgIEFTU0VSVChzdmMgJiYgaXNfaWRsZV92Y3B1KHN2Yy0+dmNwdSkpOwogCi0gICAgaWRs
ZV92Y3B1W2NwdV0tPnNjaGVkX3ByaXYgPSB2ZGF0YTsKKyAgICBpZGxlX3ZjcHVbY3B1XS0+c2No
ZWRfdW5pdC0+cHJpdiA9IHZkYXRhOwogCiAgICAgLyoKICAgICAgKiBXZSBhcmUgaG9sZGluZyB0
aGUgcnVucXVldWUgbG9jayBhbHJlYWR5IChpdCdzIGJlZW4gdGFrZW4gaW4KQEAgLTEwMTcsNyAr
MTAxNyw3IEBAIHN0YXRpYyB2b2lkCiBjc2NoZWRfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1Y3QgdmNw
dSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7Ci0gICAgc3RydWN0IGNzY2hlZF92Y3B1ICpzdmMgPSB2
Yy0+c2NoZWRfcHJpdjsKKyAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2YyA9IHVuaXQtPnByaXY7
CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKIAogICAgIEJVR19PTiggaXNfaWRsZV92Y3B1KHZjKSAp
OwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMgYi94ZW4vY29tbW9uL3Nj
aGVkX2NyZWRpdDIuYwppbmRleCAxOTczZGJkZGNjLi4yODUyYTIyMGM0IDEwMDY0NAotLS0gYS94
ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIu
YwpAQCAtNTczLDcgKzU3Myw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGNzY2hlZDJfcGNwdSAq
Y3NjaGVkMl9wY3B1KHVuc2lnbmVkIGludCBjcHUpCiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGNz
Y2hlZDJfdmNwdSAqY3NjaGVkMl92Y3B1KGNvbnN0IHN0cnVjdCB2Y3B1ICp2KQogewotICAgIHJl
dHVybiB2LT5zY2hlZF9wcml2OworICAgIHJldHVybiB2LT5zY2hlZF91bml0LT5wcml2OwogfQog
CiBzdGF0aWMgaW5saW5lIHN0cnVjdCBjc2NoZWQyX2RvbSAqY3NjaGVkMl9kb20oY29uc3Qgc3Ry
dWN0IGRvbWFpbiAqZCkKQEAgLTk3MSw3ICs5NzEsNyBAQCBfcnVucV9hc3NpZ24oc3RydWN0IGNz
Y2hlZDJfdmNwdSAqc3ZjLCBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQpCiBzdGF0
aWMgdm9pZAogcnVucV9hc3NpZ24oY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qg
dmNwdSAqdmMpCiB7Ci0gICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjID0gdmMtPnNjaGVkX3By
aXY7CisgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjID0gdmMtPnNjaGVkX3VuaXQtPnByaXY7
CiAKICAgICBBU1NFUlQoc3ZjLT5ycWQgPT0gTlVMTCk7CiAKQEAgLTk5OCw3ICs5OTgsNyBAQCBf
cnVucV9kZWFzc2lnbihzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMpCiBzdGF0aWMgdm9pZAogcnVu
cV9kZWFzc2lnbihjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykK
IHsKLSAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2Yy0+c2NoZWRfcHJpdjsKKyAgICBz
dHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2Yy0+c2NoZWRfdW5pdC0+cHJpdjsKIAogICAgIEFT
U0VSVChzdmMtPnJxZCA9PSBjMnJxZChvcHMsIHZjLT5wcm9jZXNzb3IpKTsKIApAQCAtMzEwOSw3
ICszMTA5LDcgQEAgc3RhdGljIHZvaWQKIGNzY2hlZDJfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1Y3Qg
dmNwdSAqdmMgPSB1bml0LT52Y3B1X2xpc3Q7Ci0gICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3Zj
ID0gdmMtPnNjaGVkX3ByaXY7CisgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjID0gdW5pdC0+
cHJpdjsKICAgICBzdHJ1Y3QgY3NjaGVkMl9kb20gKiBjb25zdCBzZG9tID0gc3ZjLT5zZG9tOwog
ICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAKQEAgLTM4OTEsNyArMzg5MSw3IEBAIGNzY2hlZDJfc3dp
dGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAg
ICAgQVNTRVJUKCFsb2NhbF9pcnFfaXNfZW5hYmxlZCgpKTsKICAgICB3cml0ZV9sb2NrKCZwcnYt
PmxvY2spOwogCi0gICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3ByaXYgPSB2ZGF0YTsKKyAgICBp
ZGxlX3ZjcHVbY3B1XS0+c2NoZWRfdW5pdC0+cHJpdiA9IHZkYXRhOwogCiAgICAgcnFpID0gaW5p
dF9wZGF0YShwcnYsIHBkYXRhLCBjcHUpOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVk
X251bGwuYyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCmluZGV4IGE1YTljZTJkNTcuLmJiOWZl
ZDhhYWIgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCisrKyBiL3hlbi9jb21t
b24vc2NoZWRfbnVsbC5jCkBAIC0xMTYsNyArMTE2LDcgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3Qg
bnVsbF9wcml2YXRlICpudWxsX3ByaXYoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzKQogCiBz
dGF0aWMgaW5saW5lIHN0cnVjdCBudWxsX3ZjcHUgKm51bGxfdmNwdShjb25zdCBzdHJ1Y3QgdmNw
dSAqdikKIHsKLSAgICByZXR1cm4gdi0+c2NoZWRfcHJpdjsKKyAgICByZXR1cm4gdi0+c2NoZWRf
dW5pdC0+cHJpdjsKIH0KIAogc3RhdGljIGlubGluZSBib29sIHZjcHVfY2hlY2tfYWZmaW5pdHko
c3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBjcHUsCkBAIC00MjIsNyArNDIyLDcgQEAgc3Rh
dGljIHNwaW5sb2NrX3QgKm51bGxfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19v
cHMsCiAKICAgICBBU1NFUlQobnZjICYmIGlzX2lkbGVfdmNwdShudmMtPnZjcHUpKTsKIAotICAg
IGlkbGVfdmNwdVtjcHVdLT5zY2hlZF9wcml2ID0gdmRhdGE7CisgICAgaWRsZV92Y3B1W2NwdV0t
PnNjaGVkX3VuaXQtPnByaXYgPSB2ZGF0YTsKIAogICAgIC8qCiAgICAgICogV2UgYXJlIGhvbGRp
bmcgdGhlIHJ1bnF1ZXVlIGxvY2sgYWxyZWFkeSAoaXQncyBiZWVuIHRha2VuIGluCmRpZmYgLS1n
aXQgYS94ZW4vY29tbW9uL3NjaGVkX3J0LmMgYi94ZW4vY29tbW9uL3NjaGVkX3J0LmMKaW5kZXgg
MGY1ZTBlYmNjMS4uZGQ1MTYxMzg0NSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9ydC5j
CisrKyBiL3hlbi9jb21tb24vc2NoZWRfcnQuYwpAQCAtMjM1LDcgKzIzNSw3IEBAIHN0YXRpYyBp
bmxpbmUgc3RydWN0IHJ0X3ByaXZhdGUgKnJ0X3ByaXYoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzKQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBydF92Y3B1ICpydF92Y3B1KGNvbnN0IHN0cnVj
dCB2Y3B1ICp2Y3B1KQogewotICAgIHJldHVybiB2Y3B1LT5zY2hlZF9wcml2OworICAgIHJldHVy
biB2Y3B1LT5zY2hlZF91bml0LT5wcml2OwogfQogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBsaXN0
X2hlYWQgKnJ0X3J1bnEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzKQpAQCAtNzYwLDcgKzc2
MCw3IEBAIHJ0X3N3aXRjaF9zY2hlZChzdHJ1Y3Qgc2NoZWR1bGVyICpuZXdfb3BzLCB1bnNpZ25l
ZCBpbnQgY3B1LAogICAgICAgICBkcHJpbnRrKFhFTkxPR19ERUJVRywgIlJURFM6IHRpbWVyIGlu
aXRpYWxpemVkIG9uIGNwdSAldVxuIiwgY3B1KTsKICAgICB9CiAKLSAgICBpZGxlX3ZjcHVbY3B1
XS0+c2NoZWRfcHJpdiA9IHZkYXRhOworICAgIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91bml0LT5w
cml2ID0gdmRhdGE7CiAKICAgICByZXR1cm4gJnBydi0+bG9jazsKIH0KZGlmZiAtLWdpdCBhL3hl
bi9jb21tb24vc2NoZWR1bGUuYyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwppbmRleCA0MWFmNTJi
YzJiLi44OGI2NmY4MDhjIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMKKysrIGIv
eGVuL2NvbW1vbi9zY2hlZHVsZS5jCkBAIC04MSw3ICs4MSw3IEBAIHN0YXRpYyBzcGlubG9ja190
ICoKIHNjaGVkX2lkbGVfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVu
c2lnbmVkIGludCBjcHUsCiAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpwZGF0YSwgdm9p
ZCAqdmRhdGEpCiB7Ci0gICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3ByaXYgPSBOVUxMOworICAg
IGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91bml0LT5wcml2ID0gTlVMTDsKIAogICAgIHJldHVybiAm
c2NoZWRfZnJlZV9jcHVfbG9jazsKIH0KQEAgLTMyOCw4ICszMjgsOCBAQCBpbnQgc2NoZWRfaW5p
dF92Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yKQogICAgIGluaXRf
dGltZXIoJnYtPnBvbGxfdGltZXIsIHBvbGxfdGltZXJfZm4sCiAgICAgICAgICAgICAgICB2LCB2
LT5wcm9jZXNzb3IpOwogCi0gICAgdi0+c2NoZWRfcHJpdiA9IHNjaGVkX2FsbG9jX3ZkYXRhKGRv
bV9zY2hlZHVsZXIoZCksIHVuaXQsIGQtPnNjaGVkX3ByaXYpOwotICAgIGlmICggdi0+c2NoZWRf
cHJpdiA9PSBOVUxMICkKKyAgICB1bml0LT5wcml2ID0gc2NoZWRfYWxsb2NfdmRhdGEoZG9tX3Nj
aGVkdWxlcihkKSwgdW5pdCwgZC0+c2NoZWRfcHJpdik7CisgICAgaWYgKCB1bml0LT5wcml2ID09
IE5VTEwgKQogICAgIHsKICAgICAgICAgdi0+c2NoZWRfdW5pdCA9IE5VTEw7CiAgICAgICAgIHhm
cmVlKHVuaXQpOwpAQCAtNDI0LDcgKzQyNCw3IEBAIGludCBzY2hlZF9tb3ZlX2RvbWFpbihzdHJ1
Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICB7CiAgICAgICAgIHNwaW5sb2Nr
X3QgKmxvY2s7CiAKLSAgICAgICAgdmNwdWRhdGEgPSB2LT5zY2hlZF9wcml2OworICAgICAgICB2
Y3B1ZGF0YSA9IHYtPnNjaGVkX3VuaXQtPnByaXY7CiAKICAgICAgICAgbWlncmF0ZV90aW1lcigm
di0+cGVyaW9kaWNfdGltZXIsIG5ld19wKTsKICAgICAgICAgbWlncmF0ZV90aW1lcigmdi0+c2lu
Z2xlc2hvdF90aW1lciwgbmV3X3ApOwpAQCAtNDQyLDcgKzQ0Miw3IEBAIGludCBzY2hlZF9tb3Zl
X2RvbWFpbihzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICAgICAgICov
CiAgICAgICAgIHNwaW5fdW5sb2NrX2lycShsb2NrKTsKIAotICAgICAgICB2LT5zY2hlZF9wcml2
ID0gdmNwdV9wcml2W3YtPnZjcHVfaWRdOworICAgICAgICB2LT5zY2hlZF91bml0LT5wcml2ID0g
dmNwdV9wcml2W3YtPnZjcHVfaWRdOwogICAgICAgICBpZiAoICFkLT5pc19keWluZyApCiAgICAg
ICAgICAgICBzY2hlZF9tb3ZlX2lycXModik7CiAKQEAgLTQ3NCw3ICs0NzQsNyBAQCB2b2lkIHNj
aGVkX2Rlc3Ryb3lfdmNwdShzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoIHRlc3RfYW5kX2NsZWFy
X2Jvb2wodi0+aXNfdXJnZW50KSApCiAgICAgICAgIGF0b21pY19kZWMoJnBlcl9jcHUoc2NoZWR1
bGVfZGF0YSwgdi0+cHJvY2Vzc29yKS51cmdlbnRfY291bnQpOwogICAgIHNjaGVkX3JlbW92ZV91
bml0KHZjcHVfc2NoZWR1bGVyKHYpLCB1bml0KTsKLSAgICBzY2hlZF9mcmVlX3ZkYXRhKHZjcHVf
c2NoZWR1bGVyKHYpLCB2LT5zY2hlZF9wcml2KTsKKyAgICBzY2hlZF9mcmVlX3ZkYXRhKHZjcHVf
c2NoZWR1bGVyKHYpLCB1bml0LT5wcml2KTsKICAgICB2LT5zY2hlZF91bml0ID0gTlVMTDsKICAg
ICB4ZnJlZSh1bml0KTsKIH0KQEAgLTE5MjksNyArMTkyOSw3IEBAIGludCBzY2hlZHVsZV9jcHVf
c3dpdGNoKHVuc2lnbmVkIGludCBjcHUsIHN0cnVjdCBjcHVwb29sICpjKQogICAgICAqLwogICAg
IG9sZF9sb2NrID0gcGNwdV9zY2hlZHVsZV9sb2NrX2lycXNhdmUoY3B1LCAmZmxhZ3MpOwogCi0g
ICAgdnByaXZfb2xkID0gaWRsZS0+c2NoZWRfcHJpdjsKKyAgICB2cHJpdl9vbGQgPSBpZGxlLT5z
Y2hlZF91bml0LT5wcml2OwogICAgIHBwcml2X29sZCA9IHNkLT5zY2hlZF9wcml2OwogICAgIG5l
d19sb2NrID0gc2NoZWRfc3dpdGNoX3NjaGVkKG5ld19vcHMsIGNwdSwgcHByaXYsIHZwcml2KTsK
IApkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmggYi94ZW4vaW5jbHVkZS94ZW4v
c2NoZWQuaAppbmRleCAzODY1NDllYmJiLi4xZjU4YjcyMzQxIDEwMDY0NAotLS0gYS94ZW4vaW5j
bHVkZS94ZW4vc2NoZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaApAQCAtMTYyLDcg
KzE2Miw2IEBAIHN0cnVjdCB2Y3B1CiAgICAgc3RydWN0IHRpbWVyICAgICBwb2xsX3RpbWVyOyAg
ICAvKiB0aW1lb3V0IGZvciBTQ0hFRE9QX3BvbGwgKi8KIAogICAgIHN0cnVjdCBzY2hlZF91bml0
ICpzY2hlZF91bml0OwotICAgIHZvaWQgICAgICAgICAgICAqc2NoZWRfcHJpdjsgICAgLyogc2No
ZWR1bGVyLXNwZWNpZmljIGRhdGEgKi8KIAogICAgIHN0cnVjdCB2Y3B1X3J1bnN0YXRlX2luZm8g
cnVuc3RhdGU7CiAjaWZuZGVmIENPTkZJR19DT01QQVQKQEAgLTI3Nyw2ICsyNzYsNyBAQCBzdHJ1
Y3QgdmNwdQogc3RydWN0IHNjaGVkX3VuaXQgewogICAgIHN0cnVjdCBkb21haW4gICAgICAgICAq
ZG9tYWluOwogICAgIHN0cnVjdCB2Y3B1ICAgICAgICAgICAqdmNwdV9saXN0OworICAgIHZvaWQg
ICAgICAgICAgICAgICAgICAqcHJpdjsgICAgICAvKiBzY2hlZHVsZXIgcHJpdmF0ZSBkYXRhICov
CiAgICAgdW5zaWduZWQgaW50ICAgICAgICAgICB1bml0X2lkOwogfTsKIAotLSAKMi4xNi40CgoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

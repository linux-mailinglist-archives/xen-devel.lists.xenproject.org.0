Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 3EF46B67CC
	for <lists+xen-devel@lfdr.de>; Wed, 18 Sep 2019 18:12:25 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iAcWj-0002vH-Jl; Wed, 18 Sep 2019 16:09:57 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=rYmb=XN=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1iAcWh-0002up-Rg
 for xen-devel@lists.xenproject.org; Wed, 18 Sep 2019 16:09:55 +0000
X-Inumbo-ID: bfa04e12-da2e-11e9-b299-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id bfa04e12-da2e-11e9-b299-bc764e2007e4;
 Wed, 18 Sep 2019 16:09:53 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 84ABBAF2A;
 Wed, 18 Sep 2019 16:09:52 +0000 (UTC)
To: Andrew Cooper <andrew.cooper3@citrix.com>
References: <20190913192759.10795-1-andrew.cooper3@citrix.com>
 <20190913192759.10795-9-andrew.cooper3@citrix.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <9619667f-e43a-7ad9-2e71-40fbe7421484@suse.com>
Date: Wed, 18 Sep 2019 18:09:59 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <20190913192759.10795-9-andrew.cooper3@citrix.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v2 08/10] tools/libxc: Rework
 xc_cpuid_apply_policy() to use {get, set}_cpu_policy()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Xen-devel <xen-devel@lists.xenproject.org>,
 =?UTF-8?Q?Roger_Pau_Monn=c3=a9?= <roger.pau@citrix.com>, Wei Liu <wl@xen.org>,
 Ian Jackson <Ian.Jackson@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMTMuMDkuMjAxOSAyMToyNywgQW5kcmV3IENvb3BlciB3cm90ZToKPiBAQCAtMTA1NCwzICs0
NDYsMTkxIEBAIGludCB4Y19jcHVpZF9zZXQoCj4gIAo+ICAgICAgcmV0dXJuIHJjOwo+ICB9Cj4g
Kwo+ICtpbnQgeGNfY3B1aWRfYXBwbHlfcG9saWN5KHhjX2ludGVyZmFjZSAqeGNoLCB1aW50MzJf
dCBkb21pZCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJfdCAqZmVh
dHVyZXNldCwgdW5zaWduZWQgaW50IG5yX2ZlYXR1cmVzKQo+ICt7Cj4gKyAgICBpbnQgcmM7Cj4g
KyAgICB4Y19kb21pbmZvX3QgZGk7Cj4gKyAgICB1bnNpZ25lZCBpbnQgaSwgbnJfbGVhdmVzLCBu
cl9tc3JzOwo+ICsgICAgeGVuX2NwdWlkX2xlYWZfdCAqbGVhdmVzID0gTlVMTDsKPiArICAgIHN0
cnVjdCBjcHVpZF9wb2xpY3kgKnAgPSBOVUxMOwo+ICsgICAgdWludDMyX3QgZXJyX2xlYWYgPSAt
MSwgZXJyX3N1YmxlYWYgPSAtMSwgZXJyX21zciA9IC0xOwo+ICsKPiArICAgIGlmICggeGNfZG9t
YWluX2dldGluZm8oeGNoLCBkb21pZCwgMSwgJmRpKSAhPSAxIHx8Cj4gKyAgICAgICAgIGRpLmRv
bWlkICE9IGRvbWlkICkKPiArICAgIHsKPiArICAgICAgICBFUlJPUigiRmFpbGVkIHRvIG9idGFp
biBkJWQgaW5mbyIsIGRvbWlkKTsKPiArICAgICAgICByYyA9IC1FU1JDSDsKPiArICAgICAgICBn
b3RvIG91dDsKPiArICAgIH0KPiArCj4gKyAgICByYyA9IHhjX2dldF9jcHVfcG9saWN5X3NpemUo
eGNoLCAmbnJfbGVhdmVzLCAmbnJfbXNycyk7Cj4gKyAgICBpZiAoIHJjICkKPiArICAgIHsKPiAr
ICAgICAgICBQRVJST1IoIkZhaWxlZCB0byBvYnRhaW4gcG9saWN5IGluZm8gc2l6ZSIpOwo+ICsg
ICAgICAgIHJjID0gLWVycm5vOwo+ICsgICAgICAgIGdvdG8gb3V0Owo+ICsgICAgfQo+ICsKPiAr
ICAgIHJjID0gLUVOT01FTTsKPiArICAgIGlmICggKGxlYXZlcyA9IGNhbGxvYyhucl9sZWF2ZXMs
IHNpemVvZigqbGVhdmVzKSkpID09IE5VTEwgfHwKPiArICAgICAgICAgKHAgPSBjYWxsb2MoMSwg
c2l6ZW9mKCpwKSkpID09IE5VTEwgKQo+ICsgICAgICAgIGdvdG8gb3V0Owo+ICsKPiArICAgIG5y
X21zcnMgPSAwOwo+ICsgICAgcmMgPSB4Y19nZXRfZG9tYWluX2NwdV9wb2xpY3koeGNoLCBkb21p
ZCwgJm5yX2xlYXZlcywgbGVhdmVzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJm5yX21zcnMsIE5VTEwpOwo+ICsgICAgaWYgKCByYyApCj4gKyAgICB7Cj4gKyAgICAgICAg
UEVSUk9SKCJGYWlsZWQgdG8gb2J0YWluIGQlZCdzIHBvbGljeSIsIGRvbWlkKTsKPiArICAgICAg
ICByYyA9IC1lcnJubzsKPiArICAgICAgICBnb3RvIG91dDsKPiArICAgIH0KPiArCj4gKyAgICBy
YyA9IHg4Nl9jcHVpZF9jb3B5X2Zyb21fYnVmZmVyKHAsIGxlYXZlcywgbnJfbGVhdmVzLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZXJyX2xlYWYsICZlcnJfc3VibGVh
Zik7Cj4gKyAgICBpZiAoIHJjICkKPiArICAgIHsKPiArICAgICAgICBFUlJPUigiRmFpbGVkIHRv
IGRlc2VyaWFsaXNlIENQVUlEIChlcnIgbGVhZiAlI3gsIHN1YmxlYWYgJSN4KSAoJWQgPSAlcyki
LAo+ICsgICAgICAgICAgICAgIGVycl9sZWFmLCBlcnJfc3VibGVhZiwgLXJjLCBzdHJlcnJvcigt
cmMpKTsKPiArICAgICAgICBnb3RvIG91dDsKPiArICAgIH0KPiArCj4gKyAgICBpZiAoIGZlYXR1
cmVzZXQgKQo+ICsgICAgewo+ICsgICAgICAgIHVpbnQzMl90IGRpc2FibGVkX2ZlYXR1cmVzW0ZF
QVRVUkVTRVRfTlJfRU5UUklFU10sCj4gKyAgICAgICAgICAgIGZlYXRbRkVBVFVSRVNFVF9OUl9F
TlRSSUVTXSA9IHt9Owo+ICsgICAgICAgIHN0YXRpYyBjb25zdCB1aW50MzJfdCBkZWVwX2ZlYXR1
cmVzW10gPSBJTklUX0RFRVBfRkVBVFVSRVM7Cj4gKyAgICAgICAgdW5zaWduZWQgaW50IGksIGI7
Cj4gKwo+ICsgICAgICAgIC8qCj4gKyAgICAgICAgICogVGhlIHVzZXIgc3VwcGxpZWQgZmVhdHVy
ZXNldCBtYXkgYmUgc2hvcnRlciBvciBsb25nZXIgdGhhbgo+ICsgICAgICAgICAqIEZFQVRVUkVT
RVRfTlJfRU5UUklFUy4gIFNob3J0ZXIgaXMgZmluZSwgYW5kIHdlIHdpbGwgemVyby1leHRlbmQu
Cj4gKyAgICAgICAgICogTG9uZ2VyIGlzIGZpbmUsIHNvIGxvbmcgYXMgaXQgb25seSBwYWRkZWQg
d2l0aCB6ZXJvcy4KPiArICAgICAgICAgKi8KPiArICAgICAgICB1bnNpZ25lZCBpbnQgdXNlcl9s
ZW4gPSBtaW4oRkVBVFVSRVNFVF9OUl9FTlRSSUVTICsgMHUsIG5yX2ZlYXR1cmVzKTsKPiArCj4g
KyAgICAgICAgLyogQ2hlY2sgZm9yIHRydW5jYXRlZCBzZXQgYml0cy4gKi8KPiArICAgICAgICBy
YyA9IC1FT1BOT1RTVVBQOwo+ICsgICAgICAgIGZvciAoIGkgPSB1c2VyX2xlbjsgaSA8IG5yX2Zl
YXR1cmVzOyArK2kgKQo+ICsgICAgICAgICAgICBpZiAoIGZlYXR1cmVzZXRbaV0gIT0gMCApCj4g
KyAgICAgICAgICAgICAgICBnb3RvIG91dDsKPiArCj4gKyAgICAgICAgbWVtY3B5KGZlYXQsIGZl
YXR1cmVzZXQsIHNpemVvZigqZmVhdHVyZXNldCkgKiB1c2VyX2xlbik7Cj4gKwo+ICsgICAgICAg
IC8qIERpc2FibGUgZGVlcCBkZXBlbmRlbmNpZXMgb2YgZGlzYWJsZWQgZmVhdHVyZXMuICovCj4g
KyAgICAgICAgZm9yICggaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRpc2FibGVkX2ZlYXR1cmVzKTsg
KytpICkKPiArICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXNbaV0gPSB+ZmVhdFtpXSAmIGRl
ZXBfZmVhdHVyZXNbaV07Cj4gKwo+ICsgICAgICAgIGZvciAoIGIgPSAwOyBiIDwgc2l6ZW9mKGRp
c2FibGVkX2ZlYXR1cmVzKSAqIENIQVJfQklUOyArK2IgKQo+ICsgICAgICAgIHsKPiArICAgICAg
ICAgICAgY29uc3QgdWludDMyX3QgKmRmczsKPiArCj4gKyAgICAgICAgICAgIGlmICggIXRlc3Rf
Yml0KGIsIGRpc2FibGVkX2ZlYXR1cmVzKSB8fAo+ICsgICAgICAgICAgICAgICAgICEoZGZzID0g
eDg2X2NwdWlkX2xvb2t1cF9kZWVwX2RlcHMoYikpICkKPiArICAgICAgICAgICAgICAgIGNvbnRp
bnVlOwo+ICsKPiArICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRpc2Fi
bGVkX2ZlYXR1cmVzKTsgKytpICkKPiArICAgICAgICAgICAgewo+ICsgICAgICAgICAgICAgICAg
ZmVhdFtpXSAmPSB+ZGZzW2ldOwo+ICsgICAgICAgICAgICAgICAgZGlzYWJsZWRfZmVhdHVyZXNb
aV0gJj0gfmRmc1tpXTsKPiArICAgICAgICAgICAgfQo+ICsgICAgICAgIH0KPiArCj4gKyAgICAg
ICAgY3B1aWRfZmVhdHVyZXNldF90b19wb2xpY3koZmVhdCwgcCk7Cj4gKyAgICB9Cj4gKwo+ICsg
ICAgaWYgKCAhZGkuaHZtICkKPiArICAgIHsKPiArICAgICAgICB1aW50MzJfdCBob3N0X2ZlYXR1
cmVzZXRbRkVBVFVSRVNFVF9OUl9FTlRSSUVTXSA9IHt9Owo+ICsgICAgICAgIHVpbnQzMl90IGxl
biA9IEFSUkFZX1NJWkUoaG9zdF9mZWF0dXJlc2V0KTsKPiArCj4gKyAgICAgICAgcmMgPSB4Y19n
ZXRfY3B1X2ZlYXR1cmVzZXQoeGNoLCBYRU5fU1lTQ1RMX2NwdV9mZWF0dXJlc2V0X2hvc3QsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmxlbiwgaG9zdF9mZWF0dXJlc2V0
KTsKPiArICAgICAgICBpZiAoIHJjICkKPiArICAgICAgICB7Cj4gKyAgICAgICAgICAgIC8qIFRv
bGVyYXRlICJidWZmZXIgdG9vIHNtYWxsIiwgYXMgd2UndmUgZ290IHRoZSBiaXRzIHdlIG5lZWQu
ICovCj4gKyAgICAgICAgICAgIGlmICggZXJybm8gPT0gRU5PQlVGUyApCj4gKyAgICAgICAgICAg
ICAgICByYyA9IDA7Cj4gKyAgICAgICAgICAgIGVsc2UKPiArICAgICAgICAgICAgewo+ICsgICAg
ICAgICAgICAgICAgUEVSUk9SKCJGYWlsZWQgdG8gb2J0YWluIGhvc3QgZmVhdHVyZXNldCIpOwo+
ICsgICAgICAgICAgICAgICAgcmMgPSAtZXJybm87Cj4gKyAgICAgICAgICAgICAgICBnb3RvIG91
dDsKPiArICAgICAgICAgICAgfQo+ICsgICAgICAgIH0KPiArCj4gKyAgICAgICAgLyoKPiArICAg
ICAgICAgKiBPbiBoYXJkd2FyZSB3aXRob3V0IENQVUlEIEZhdWx0aW5nLCBQViBndWVzdHMgc2Vl
IHJlYWwgdG9wb2xvZ3kuCj4gKyAgICAgICAgICogQXMgYSBjb25zZXF1ZW5jZSwgdGhleSBhbHNv
IG5lZWQgdG8gc2VlIHRoZSBob3N0IGh0dC9jbXAgZmllbGRzLgo+ICsgICAgICAgICAqLwo+ICsg
ICAgICAgIHAtPmJhc2ljLmh0dCAgICAgICA9IHRlc3RfYml0KFg4Nl9GRUFUVVJFX0hUVCwgaG9z
dF9mZWF0dXJlc2V0KTsKPiArICAgICAgICBwLT5leHRkLmNtcF9sZWdhY3kgPSB0ZXN0X2JpdChY
ODZfRkVBVFVSRV9DTVBfTEVHQUNZLCBob3N0X2ZlYXR1cmVzZXQpOwo+ICsgICAgfQo+ICsgICAg
ZWxzZQo+ICsgICAgewo+ICsgICAgICAgIC8qCj4gKyAgICAgICAgICogVG9wb2xvZ3kgZm9yIEhW
TSBndWVzdHMgaXMgZW50aXJlbHkgY29udHJvbGxlZCBieSBYZW4uICBGb3Igbm93LCB3ZQo+ICsg
ICAgICAgICAqIGhhcmRjb2RlIEFQSUNfSUQgPSB2Y3B1X2lkICogMiB0byBnaXZlIHRoZSBpbGx1
c2lvbiBvZiBubyBTTVQuCj4gKyAgICAgICAgICovCj4gKyAgICAgICAgcC0+YmFzaWMuaHR0ID0g
dHJ1ZTsKPiArICAgICAgICBwLT5leHRkLmNtcF9sZWdhY3kgPSBmYWxzZTsKPiArCj4gKyAgICAg
ICAgcC0+YmFzaWMubHBwcCAqPSAyOwoKU28gYXMgSSd2ZSBqdXN0IGxlYXJuZWQgZnJvbSBpbnZl
c3RpZ2F0aW5nIHRoZSBtdWx0aS12Q1BVIGd1ZXN0IGJvb3QKaXNzdWUgb24gUm9tZSwgdGhpcyAu
Li4KCj4gKyAgICAgICAgc3dpdGNoICggcC0+eDg2X3ZlbmRvciApCj4gKyAgICAgICAgewo+ICsg
ICAgICAgIGNhc2UgWDg2X1ZFTkRPUl9JTlRFTDoKPiArICAgICAgICAgICAgZm9yICggaSA9IDA7
IChwLT5jYWNoZS5zdWJsZWFmW2ldLnR5cGUgJiYKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICBpIDwgQVJSQVlfU0laRShwLT5jYWNoZS5yYXcpKTsgKytpICkKPiArICAgICAgICAgICAgewo+
ICsgICAgICAgICAgICAgICAgcC0+Y2FjaGUuc3VibGVhZltpXS5jb3Jlc19wZXJfcGFja2FnZSA9
Cj4gKyAgICAgICAgICAgICAgICAgICAgKHAtPmNhY2hlLnN1YmxlYWZbaV0uY29yZXNfcGVyX3Bh
Y2thZ2UgPDwgMSkgfCAxOwoKLi4uLCB0aGlzLCBhbmQgLi4uCgo+ICsgICAgICAgICAgICAgICAg
cC0+Y2FjaGUuc3VibGVhZltpXS50aHJlYWRzX3Blcl9jYWNoZSA9IDA7Cj4gKyAgICAgICAgICAg
IH0KPiArICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgIGNhc2UgWDg2X1ZFTkRPUl9B
TUQ6Cj4gKyAgICAgICAgY2FzZSBYODZfVkVORE9SX0hZR09OOgo+ICsgICAgICAgICAgICBwLT5l
eHRkLm5jID0gKHAtPmV4dGQubmMgPDwgMSkgfCAxOwoKLi4uIHRoaXMgY2FuIG92ZXJmbG93IChp
biB0aGUgZmlyc3QgY2FzZSBpbiBwYXJ0aWN1bGFyIGxlYWRpbmcgdG8KYSB2YWx1ZSBvZiB6ZXJv
IHdoZW4gdGhlIGluaXRpYWwgdmFsdWUgd2FzIDEyOCkuIEkgdGhpbmsgaXQKd291bGRuJ3QgYmUg
YmFkIGlmIGFsbCBvZiB0aGVzZSB3ZXJlIG1hZGUgc2F0dXJhdGluZyBvcGVyYXRpb25zCmluIHRo
aXMgbmV3IGNvZGUsIGRlc3BpdGUgdGhpcyBub3QgYmVpbmcgYW4gZXhhY3QgZXF1aXZhbGVudCBv
Zgp0aGUgb2xkIGNvZGUuIEkgaGF2ZW4ndCB0cmllZCBvdXQgeWV0IHdoZXRoZXIgY29ycmVjdGlu
ZyB0aGlzIGluCnRoZSBvbGQgY29kZSAodGh1cyBhcHBsaWNhYmxlIHRvIDQuMTIgYW5kIG9sZGVy
KSB3aWxsIGJlIGVub3VnaAp0byBmaXggdGhlIGlzc3VlLCBidXQgaXQgaXMgY2VydGFpbmx5IHBh
cnQgb2Ygd2hhdCdzIG5lZWRlZC4KCkphbgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMu
eGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL3hlbi1kZXZlbA==

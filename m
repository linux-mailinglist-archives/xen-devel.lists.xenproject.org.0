Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 29FAF86DCE
	for <lists+xen-devel@lfdr.de>; Fri,  9 Aug 2019 01:15:23 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hvraT-00034b-JX; Thu, 08 Aug 2019 23:12:49 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=lyhG=WE=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1hvraQ-00032T-QK
 for xen-devel@lists.xen.org; Thu, 08 Aug 2019 23:12:46 +0000
X-Inumbo-ID: 0710baa3-ba32-11e9-8980-bc764e045a96
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 0710baa3-ba32-11e9-8980-bc764e045a96;
 Thu, 08 Aug 2019 23:12:44 +0000 (UTC)
Received: from sstabellini-ThinkPad-T480s.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 97FBA21743;
 Thu,  8 Aug 2019 23:12:43 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1565305963;
 bh=kmVqqtFCam4g889Lm7JzMLZpNmNLKy+Cl7Zb+S/MwBQ=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=l4r9qwXi5vfBr7vpfgYWDyxjWcHhbzb1jbWfmQAOHU7rh3GLy9NcfOWBThTPa2qLv
 hD323QI+q8r6FAK5e78yAeopBgygc7zXjbmTsy6F6FRdhOmWSVHtSTD5Z+iDF6quu6
 LM9f4rt8o4Y+0ZdWnxalzwWScJlr2r4Adkpb4I3k=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Thu,  8 Aug 2019 16:12:38 -0700
Message-Id: <20190808231242.26424-2-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1908081609510.22196@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1908081609510.22196@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v3 2/6] xen/arm: copy dtb fragment to guest dtb
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UmVhZCB0aGUgZHRiIGZyYWdtZW50IGNvcnJlc3BvbmRpbmcgdG8gYSBwYXNzdGhyb3VnaCBkZXZp
Y2UgZnJvbSBtZW1vcnkKYXQgdGhlIGxvY2F0aW9uIHJlZmVycmVkIHRvIGJ5IHRoZSAibXVsdGli
b290LGR0YiIgY29tcGF0aWJsZSBub2RlLgoKQ29weSB0aGUgZnJhZ21lbnQgdG8gdGhlIGd1ZXN0
IGR0Yi4KCkFkZCBhIGR0Yl9ib290bW9kdWxlIGZpZWxkIHRvIHN0cnVjdCBrZXJuZWxfaW5mbyB0
byBmaW5kIHRoZSBkdGIKZnJhZ21lbnQgZm9yIGEgZ3Vlc3QuCgpTb21lIG9mIHRoZSBjb2RlIGJl
bG93IGlzIHRha2VuIGZyb20gdG9vbHMvbGlieGwvbGlieGxfYXJtLmMuIE5vdGUgdGhhdAppdCBp
cyBPSyB0byB0YWtlIExHUEwgMi4xIGNvZGUgYW5kIGluY2x1ZGluZyBpdCBpbnRvIGEgR1BMdjIg
Y29kZSBiYXNlLgpUaGUgcmVzdWx0IGlzIEdQTHYyIGNvZGUuCgpTaWduZWQtb2ZmLWJ5OiBTdGVm
YW5vIFN0YWJlbGxpbmkgPHN0ZWZhbm9zQHhpbGlueC5jb20+CgotLS0tCkNoYW5nZXMgaW4gdjM6
Ci0gc3dpdGNoIHRvIHVzaW5nIGRldmljZV90cmVlX2Zvcl9lYWNoX25vZGUgZm9yIHRoZSBjb3B5
CgpDaGFuZ2VzIGluIHYyOgotIGFkZCBhIG5vdGUgYWJvdXQgdGhlIGNvZGUgY29taW5nIGZyb20g
bGlieGwgaW4gdGhlIGNvbW1pdCBtZXNzYWdlCi0gY29weSAvYWxpYXNlcwotIGNvZGUgc3R5bGUK
LS0tCiB4ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMgIHwgMTAzICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCiB4ZW4vaW5jbHVkZS9hc20tYXJtL2tlcm5lbC5oIHwgICAyICst
CiAyIGZpbGVzIGNoYW5nZWQsIDEwNCBpbnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jIGIveGVuL2FyY2gvYXJtL2RvbWFp
bl9idWlsZC5jCmluZGV4IDAwZGRiM2IwNWQuLjcwYmNkYzQ0OWQgMTAwNjQ0Ci0tLSBhL3hlbi9h
cmNoL2FybS9kb21haW5fYnVpbGQuYworKysgYi94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMK
QEAgLTE0LDYgKzE0LDcgQEAKICNpbmNsdWRlIDx4ZW4vZ3Vlc3RfYWNjZXNzLmg+CiAjaW5jbHVk
ZSA8eGVuL2lvY2FwLmg+CiAjaW5jbHVkZSA8eGVuL2FjcGkuaD4KKyNpbmNsdWRlIDx4ZW4vdm1h
cC5oPgogI2luY2x1ZGUgPHhlbi93YXJuaW5nLmg+CiAjaW5jbHVkZSA8YWNwaS9hY3RhYmxlcy5o
PgogI2luY2x1ZGUgPGFzbS9kZXZpY2UuaD4KQEAgLTE3MDYsNiArMTcwNywxMDIgQEAgc3RhdGlj
IGludCBfX2luaXQgbWFrZV92cGwwMTFfdWFydF9ub2RlKGNvbnN0IHN0cnVjdCBkb21haW4gKmQs
IHZvaWQgKmZkdCkKIH0KICNlbmRpZgogCitzdGF0aWMgaW50IF9faW5pdCBoYW5kbGVfcHJvcGVy
dGllcyhzdHJ1Y3QgZG9tYWluICpkLCB2b2lkICpmZHQsIGNvbnN0IHZvaWQgKnBmZHQsIGludCBu
b2Rlb2ZmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTMyIGFkZHJlc3Nf
Y2VsbHMsIHUzMiBzaXplX2NlbGxzKQoreworICAgIGludCBwcm9wb2ZmLCBuYW1lb2ZmLCByOwor
ICAgIGNvbnN0IHN0cnVjdCBmZHRfcHJvcGVydHkgKnByb3A7CisKKyAgICBmb3IgKCBwcm9wb2Zm
ID0gZmR0X2ZpcnN0X3Byb3BlcnR5X29mZnNldChwZmR0LCBub2Rlb2ZmKTsKKyAgICAgICAgICBw
cm9wb2ZmID49IDA7CisgICAgICAgICAgcHJvcG9mZiA9IGZkdF9uZXh0X3Byb3BlcnR5X29mZnNl
dChwZmR0LCBwcm9wb2ZmKSApCisgICAgeworCisgICAgICAgIGlmICggIShwcm9wID0gZmR0X2dl
dF9wcm9wZXJ0eV9ieV9vZmZzZXQocGZkdCwgcHJvcG9mZiwgTlVMTCkpICkKKyAgICAgICAgICAg
IHJldHVybiAtRkRUX0VSUl9JTlRFUk5BTDsKKworICAgICAgICBuYW1lb2ZmID0gZmR0MzJfdG9f
Y3B1KHByb3AtPm5hbWVvZmYpOworICAgICAgICByID0gZmR0X3Byb3BlcnR5KGZkdCwgZmR0X3N0
cmluZyhwZmR0LCBuYW1lb2ZmKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wLT5kYXRh
LCBmZHQzMl90b19jcHUocHJvcC0+bGVuKSk7CisgICAgICAgIGlmICggciApCisgICAgICAgICAg
ICByZXR1cm4gcjsKKyAgICB9CisKKyAgICAvKiBGRFRfRVJSX05PVEZPVU5EID0+IFRoZXJlIGlz
IG5vIG1vcmUgcHJvcGVydGllcyBmb3IgdGhpcyBub2RlICovCisgICAgcmV0dXJuICggcHJvcG9m
ZiAhPSAtRkRUX0VSUl9OT1RGT1VORCApID8gcHJvcG9mZiA6IDA7Cit9CisKK3N0YXRpYyBpbnQg
X19pbml0IHNjYW5fcHRfbm9kZShjb25zdCB2b2lkICpwZmR0LAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBub2Rlb2ZmLCBjb25zdCBjaGFyICpuYW1lLCBpbnQgZGVwdGgsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTMyIGFkZHJlc3NfY2VsbHMsIHUzMiBzaXpl
X2NlbGxzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmRhdGEpCit7Cisg
ICAgaW50IHJjOworICAgIGludCBpLCBudW07CisgICAgc3RydWN0IGtlcm5lbF9pbmZvICpraW5m
byA9IGRhdGE7CisgICAgdm9pZCAqZmR0ID0ga2luZm8tPmZkdDsKKyAgICBpbnQgZGVwdGhfbmV4
dCA9IGRlcHRoOworICAgIGludCBub2RlX25leHQ7CisKKyAgICAvKiBubyBuZWVkIHRvIHBhcnNl
IGluaXRpYWwgbm9kZSAqLworICAgIGlmICggIWRlcHRoICkKKyAgICAgICAgcmV0dXJuIDA7CisK
KyAgICByYyA9IGZkdF9iZWdpbl9ub2RlKGZkdCwgZmR0X2dldF9uYW1lKHBmZHQsIG5vZGVvZmYs
IE5VTEwpKTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgcmV0dXJuIHJjOworCisgICAgcmMgPSBo
YW5kbGVfcHJvcGVydGllcyhraW5mby0+ZCwgZmR0LCBwZmR0LCBub2Rlb2ZmLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYWRkcmVzc19jZWxscywgc2l6ZV9jZWxscyk7CisgICAgaWYgKCBy
YyApCisgICAgICAgIHJldHVybiByYzsKKworICAgIG5vZGVfbmV4dCA9IGZkdF9uZXh0X25vZGUo
cGZkdCwgbm9kZW9mZiwgJmRlcHRoX25leHQpOworCisgICAgLyoKKyAgICAgKiBJZiB0aGUgbmV4
dCBub2RlIGlzIGEgc2libGluZywgdGhlbiB3ZSBuZWVkIHRvIGNhbGwKKyAgICAgKiBmZHRfZW5k
X25vZGUgb25jZS4gSWYgdGhlIG5leHQgbm9kZSBpcyBvbmUgbGV2ZWwgdXAsIHdlIG5lZWQgdG8K
KyAgICAgKiBjYWxsIGl0IHR3aWNlOiBvbmNlIGZvciB1cyBhbmQgdGhlIHNlY29uZCB0aW1lIGZv
ciBvdXIgcGFyZW50LgorICAgICAqIEJvdGggdGhlc2UgdHdvIGNvbmRpdGlvbnMgYXJlIGV4cHJl
c3NlZCB0b2dldGhlciBieSBkZXB0aCAtCisgICAgICogZGVwdGhfbmV4dCArIDEuCisgICAgICoK
KyAgICAgKiBJZiB3ZSByZWFjaGVkIHRoZSBlbmQgb2YgdGhlIGRldmljZSB0cmVlIGZyYWdtZW50
LCB0aGVuIGl0IGlzCisgICAgICogZWFzeTogd2UgbmVlZCB0byBjYWxsIGZkdF9lbmRfbm9kZSBv
bmNlIGZvciBldmVyeSBsZXZlbCBvZiBkZXB0aAorICAgICAqIHRvIGNsb3NlIGFsbCBvcGVuIG5v
ZGVzLgorICAgICAqLworICAgIGlmICggZGVwdGhfbmV4dCA8IDAgKQorICAgICAgICBudW0gPSBk
ZXB0aDsKKyAgICBlbHNlCisgICAgICAgIG51bSA9IGRlcHRoIC0gZGVwdGhfbmV4dCArIDE7CisK
KyAgICBmb3IgKCBpID0gMDsgaSA8IG51bTsgaSsrICkKKyAgICB7CisgICAgICAgIHJjID0gZmR0
X2VuZF9ub2RlKGZkdCk7CisgICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgcmV0dXJuIHJj
OworICAgIH0KKworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgaW50IF9faW5pdCBkb21haW5f
aGFuZGxlX2R0Yl9ib290bW9kdWxlKHN0cnVjdCBkb21haW4gKmQsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8p
Cit7CisgICAgdm9pZCAqcGZkdDsKKyAgICBpbnQgcmVzOworCisgICAgcGZkdCA9IGlvcmVtYXBf
Y2FjaGUoa2luZm8tPmR0Yl9ib290bW9kdWxlLT5zdGFydCwKKyAgICAgICAgICAgIGtpbmZvLT5k
dGJfYm9vdG1vZHVsZS0+c2l6ZSk7CisgICAgaWYgKCBwZmR0ID09IE5VTEwgKQorICAgICAgICBy
ZXR1cm4gLUVGQVVMVDsKKworICAgIHJlcyA9IGRldmljZV90cmVlX2Zvcl9lYWNoX25vZGUocGZk
dCwgc2Nhbl9wdF9ub2RlLCBraW5mbyk7CisKKyAgICBpb3VubWFwKHBmZHQpOworCisgICAgcmV0
dXJuIHJlczsKK30KKwogLyoKICAqIFRoZSBtYXggc2l6ZSBmb3IgRFQgaXMgMk1CLiBIb3dldmVy
LCB0aGUgZ2VuZXJhdGVkIERUIGlzIHNtYWxsLCA0S0IKICAqIGFyZSBlbm91Z2ggZm9yIG5vdywg
YnV0IHdlIG1pZ2h0IGhhdmUgdG8gaW5jcmVhc2UgaXQgaW4gdGhlIGZ1dHVyZS4KQEAgLTE3Nzcs
NiArMTg3NCwxMiBAQCBzdGF0aWMgaW50IF9faW5pdCBwcmVwYXJlX2R0Yl9kb21VKHN0cnVjdCBk
b21haW4gKmQsIHN0cnVjdCBrZXJuZWxfaW5mbyAqa2luZm8pCiAgICAgICAgICAgICBnb3RvIGVy
cjsKICAgICB9CiAKKyAgICBpZiAoIGtpbmZvLT5kdGJfYm9vdG1vZHVsZSApIHsKKyAgICAgICAg
cmV0ID0gZG9tYWluX2hhbmRsZV9kdGJfYm9vdG1vZHVsZShkLCBraW5mbyk7CisgICAgICAgIGlm
ICggcmV0ICkKKyAgICAgICAgICAgIHJldHVybiByZXQ7CisgICAgfQorCiAgICAgcmV0ID0gZmR0
X2VuZF9ub2RlKGtpbmZvLT5mZHQpOwogICAgIGlmICggcmV0IDwgMCApCiAgICAgICAgIGdvdG8g
ZXJyOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLWFybS9rZXJuZWwuaCBiL3hlbi9pbmNs
dWRlL2FzbS1hcm0va2VybmVsLmgKaW5kZXggMzNmM2U3MmIxMS4uNzIwZGVjNDA3MSAxMDA2NDQK
LS0tIGEveGVuL2luY2x1ZGUvYXNtLWFybS9rZXJuZWwuaAorKysgYi94ZW4vaW5jbHVkZS9hc20t
YXJtL2tlcm5lbC5oCkBAIC0yOCw3ICsyOCw3IEBAIHN0cnVjdCBrZXJuZWxfaW5mbyB7CiAgICAg
cGFkZHJfdCBnbnR0YWJfc2l6ZTsKIAogICAgIC8qIGJvb3QgYmxvYiBsb2FkIGFkZHJlc3NlcyAq
LwotICAgIGNvbnN0IHN0cnVjdCBib290bW9kdWxlICprZXJuZWxfYm9vdG1vZHVsZSwgKmluaXRy
ZF9ib290bW9kdWxlOworICAgIGNvbnN0IHN0cnVjdCBib290bW9kdWxlICprZXJuZWxfYm9vdG1v
ZHVsZSwgKmluaXRyZF9ib290bW9kdWxlLCAqZHRiX2Jvb3Rtb2R1bGU7CiAgICAgY29uc3QgY2hh
ciogY21kbGluZTsKICAgICBwYWRkcl90IGR0Yl9wYWRkcjsKICAgICBwYWRkcl90IGluaXRyZF9w
YWRkcjsKLS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2pl
Y3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4t
ZGV2ZWw=

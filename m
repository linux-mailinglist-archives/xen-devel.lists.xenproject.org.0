Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DEF2991AB1
	for <lists+xen-devel@lfdr.de>; Mon, 19 Aug 2019 03:26:45 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hzWMv-0001Kb-6f; Mon, 19 Aug 2019 01:21:57 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=JIwN=WP=intel.com=chao.gao@srs-us1.protection.inumbo.net>)
 id 1hzWMs-0001Ik-Qp
 for xen-devel@lists.xenproject.org; Mon, 19 Aug 2019 01:21:54 +0000
X-Inumbo-ID: ba902162-c21f-11e9-8be6-12813bfff9fa
Received: from mga03.intel.com (unknown [134.134.136.65])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id ba902162-c21f-11e9-8be6-12813bfff9fa;
 Mon, 19 Aug 2019 01:21:54 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by orsmga103.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 18 Aug 2019 18:21:54 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,403,1559545200"; d="scan'208";a="261683929"
Received: from gao-cwp.sh.intel.com ([10.239.159.26])
 by orsmga001.jf.intel.com with ESMTP; 18 Aug 2019 18:21:52 -0700
From: Chao Gao <chao.gao@intel.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 19 Aug 2019 09:25:23 +0800
Message-Id: <1566177928-19114-11-git-send-email-chao.gao@intel.com>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <1566177928-19114-1-git-send-email-chao.gao@intel.com>
References: <1566177928-19114-1-git-send-email-chao.gao@intel.com>
Subject: [Xen-devel] [PATCH v9 10/15] microcode: split out apply_microcode()
 from cpu_request_microcode()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Ashok Raj <ashok.raj@intel.com>, Wei Liu <wl@xen.org>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Jan Beulich <jbeulich@suse.com>,
 Chao Gao <chao.gao@intel.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RHVyaW5nIGxhdGUgbWljcm9jb2RlIGxvYWRpbmcsIGFwcGx5X21pY3JvY29kZSgpIGlzIGludm9r
ZWQgaW4KY3B1X3JlcXVlc3RfbWljcm9jb2RlKCkuIFRvIG1ha2UgbGF0ZSBtaWNyb2NvZGUgdXBk
YXRlIG1vcmUgcmVsaWFibGUsCndlIHdhbnQgdG8gcHV0IHRoZSBhcHBseV9taWNyb2NvZGUoKSBp
bnRvIHN0b3BfbWFjaGluZSBjb250ZXh0LiBTbwp3ZSBzcGxpdCBvdXQgaXQgZnJvbSBjcHVfcmVx
dWVzdF9taWNyb2NvZGUoKS4gSW4gZ2VuZXJhbCwgZm9yIGJvdGgKZWFybHkgbG9hZGluZyBvbiBC
U1AgYW5kIGxhdGUgbG9hZGluZywgY3B1X3JlcXVlc3RfbWljcm9jb2RlKCkgaXMKY2FsbGVkIGZp
cnN0IHRvIGdldCB0aGUgbWF0Y2hpbmcgbWljcm9jb2RlIHVwZGF0ZSBjb250YWluZWQgYnkKdGhl
IGJsb2IgYW5kIHRoZW4gYXBwbHlfbWljcm9jb2RlKCkgaXMgaW52b2tlZCBleHBsaWNpdGx5IG9u
IGVhY2gKY3B1IGluIGNvbW1vbiBjb2RlLgoKR2l2ZW4gdGhhdCBhbGwgQ1BVcyBhcmUgc3VwcG9z
ZWQgdG8gaGF2ZSB0aGUgc2FtZSBzaWduYXR1cmUsIHBhcnNpbmcKbWljcm9jb2RlIG9ubHkgbmVl
ZHMgdG8gYmUgZG9uZSBvbmNlLiBTbyBjcHVfcmVxdWVzdF9taWNyb2NvZGUoKSBpcwphbHNvIG1v
dmVkIG91dCBvZiBtaWNyb2NvZGVfdXBkYXRlX2NwdSgpLgoKSW4gc29tZSBjYXNlcyAoZS5nLiBh
IGJyb2tlbiBiaW9zKSwgdGhlIHN5c3RlbSBtYXkgaGF2ZSBtdWx0aXBsZQpyZXZpc2lvbnMgb2Yg
bWljcm9jb2RlIHVwZGF0ZS4gU28gd2Ugd291bGQgdHJ5IHRvIGxvYWQgYSBtaWNyb2NvZGUKdXBk
YXRlIGFzIGxvbmcgYXMgaXQgY292ZXJzIGN1cnJlbnQgY3B1LiBBbmQgaWYgYSBjcHUgbG9hZHMg
dGhpcyBwYXRjaApzdWNjZXNzZnVsbHksIHRoZSBwYXRjaCB3b3VsZCBiZSBzdG9yZWQgaW50byB0
aGUgcGF0Y2ggY2FjaGUuCgpTaWduZWQtb2ZmLWJ5OiBDaGFvIEdhbyA8Y2hhby5nYW9AaW50ZWwu
Y29tPgotLS0KQ2hhbmdlcyBpbiB2OToKIC0gcmVtb3ZlIHRoZSBjYWxsaW5nIG9mIC0+Y29tcGFy
ZV9wYXRjaCBpbiBtaWNyb2NvZGVfdXBkYXRlX2NwdSgpLgogLSBkcm9wICJtaWNyb2NvZGVfIiBw
cmVmaXggZm9yIHN0YXRpYyBmdW5jdGlvbiAtIG1pY3JvY29kZV9wYXJzZV9ibG9iKCkuCiAtIHJl
YmFzZSBhbmQgZml4IGNvbmZsaWN0CgpDaGFuZ2VzIGluIHY4OgogLSBkaXZpZGUgdGhlIG9yaWdp
bmFsIHBhdGNoIGludG8gdGhyZWUgcGF0Y2hlcyB0byBpbXByb3ZlIHJlYWRhYmlsaXR5CiAtIGxv
YWQgYW4gdXBkYXRlIG9uIGVhY2ggY3B1IGFzIGxvbmcgYXMgdGhlIHVwZGF0ZSBjb3ZlcnMgY3Vy
cmVudCBjcHUKIC0gc3RvcmUgYW4gdXBkYXRlIGFmdGVyIHRoZSBmaXJzdCBzdWNjZXNzZnVsIGxv
YWRpbmcgb24gYSBDUFUKIC0gTWFrZSBzdXJlIHRoZSBjdXJyZW50IENQVSAoZXNwZWNpYWxseSBw
ZiB2YWx1ZSkgaXMgY292ZXJlZAogYnkgdXBkYXRlcy4KCmNoYW5nZXMgaW4gdjc6CiAtIHRvIGhh
bmRsZSBsb2FkIGZhaWx1cmUsIHVudmFsaWRhdGVkIHBhdGNoZXMgd29uJ3QgYmUgY2FjaGVkLiBU
aGV5CiBhcmUgcGFzc2VkIGFzIGZ1bmN0aW9uIGFyZ3VtZW50cy4gU28gaWYgdXBkYXRlIGZhaWxl
ZCwgd2UgbmVlZG4ndAogYW55IGNsZWFudXAgdG8gbWljcm9jb2RlIGNhY2hlLgotLS0KIHhlbi9h
cmNoL3g4Ni9taWNyb2NvZGUuYyAgICAgICAgfCAxNzcgKysrKysrKysrKysrKysrKysrKysrKysr
KystLS0tLS0tLS0tLS0tLQogeGVuL2FyY2gveDg2L21pY3JvY29kZV9hbWQuYyAgICB8ICAzOCAr
KysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9taWNyb2NvZGVfaW50ZWwuYyAgfCAgNjYgKysrKysrKy0t
LS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21pY3JvY29kZS5oIHwgICA1ICstCiA0IGZpbGVz
IGNoYW5nZWQsIDE3MiBpbnNlcnRpb25zKCspLCAxMTQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L21pY3JvY29kZS5jIGIveGVuL2FyY2gveDg2L21pY3JvY29kZS5jCmlu
ZGV4IDBlOTMyMmEuLmEyZmViYzcgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9taWNyb2NvZGUu
YworKysgYi94ZW4vYXJjaC94ODYvbWljcm9jb2RlLmMKQEAgLTE4OSwxMiArMTg5LDE5IEBAIHN0
YXRpYyBERUZJTkVfU1BJTkxPQ0sobWljcm9jb2RlX211dGV4KTsKIAogREVGSU5FX1BFUl9DUFUo
c3RydWN0IGNwdV9zaWduYXR1cmUsIGNwdV9zaWcpOwogCi1zdHJ1Y3QgbWljcm9jb2RlX2luZm8g
ewotICAgIHVuc2lnbmVkIGludCBjcHU7Ci0gICAgdWludDMyX3QgYnVmZmVyX3NpemU7Ci0gICAg
aW50IGVycm9yOwotICAgIGNoYXIgYnVmZmVyWzFdOwotfTsKKy8qCisgKiBSZXR1cm4gYSBwYXRj
aCB0aGF0IGNvdmVycyBjdXJyZW50IENQVS4gSWYgdGhlcmUgYXJlIG11bHRpcGxlIHBhdGNoZXMs
CisgKiByZXR1cm4gdGhlIG9uZSB3aXRoIHRoZSBoaWdoZXN0IHJldmlzaW9uIG51bWJlci4gUmV0
dXJuIGVycm9yIElmIG5vCisgKiBwYXRjaCBpcyBmb3VuZCBhbmQgYW4gZXJyb3Igb2NjdXJzIGR1
cmluZyB0aGUgcGFyc2luZyBwcm9jZXNzLiBPdGhlcndpc2UKKyAqIHJldHVybiBOVUxMLgorICov
CitzdGF0aWMgc3RydWN0IG1pY3JvY29kZV9wYXRjaCAqcGFyc2VfYmxvYihjb25zdCBjaGFyICpi
dWYsIHVpbnQzMl90IGxlbikKK3sKKyAgICBpZiAoIGxpa2VseSghbWljcm9jb2RlX29wcy0+Y29s
bGVjdF9jcHVfaW5mbygmdGhpc19jcHUoY3B1X3NpZykpKSApCisgICAgICAgIHJldHVybiBtaWNy
b2NvZGVfb3BzLT5jcHVfcmVxdWVzdF9taWNyb2NvZGUoYnVmLCBsZW4pOworCisgICAgcmV0dXJu
IE5VTEw7Cit9CiAKIGludCBtaWNyb2NvZGVfcmVzdW1lX2NwdSh2b2lkKQogewpAQCAtMjIwLDEz
ICsyMjcsNiBAQCB2b2lkIG1pY3JvY29kZV9mcmVlX3BhdGNoKHN0cnVjdCBtaWNyb2NvZGVfcGF0
Y2ggKm1pY3JvY29kZV9wYXRjaCkKICAgICB4ZnJlZShtaWNyb2NvZGVfcGF0Y2gpOwogfQogCi1j
b25zdCBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICptaWNyb2NvZGVfZ2V0X2NhY2hlKHZvaWQpCi17
Ci0gICAgQVNTRVJUKHNwaW5faXNfbG9ja2VkKCZtaWNyb2NvZGVfbXV0ZXgpKTsKLQotICAgIHJl
dHVybiBtaWNyb2NvZGVfY2FjaGU7Ci19Ci0KIC8qIFJldHVybiB0cnVlIGlmIGNhY2hlIGdldHMg
dXBkYXRlZC4gT3RoZXJ3aXNlLCByZXR1cm4gZmFsc2UgKi8KIGJvb2wgbWljcm9jb2RlX3VwZGF0
ZV9jYWNoZShzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICpwYXRjaCkKIHsKQEAgLTI1MCw0OSArMjUw
LDcxIEBAIGJvb2wgbWljcm9jb2RlX3VwZGF0ZV9jYWNoZShzdHJ1Y3QgbWljcm9jb2RlX3BhdGNo
ICpwYXRjaCkKICAgICByZXR1cm4gdHJ1ZTsKIH0KIAotc3RhdGljIGludCBtaWNyb2NvZGVfdXBk
YXRlX2NwdShjb25zdCB2b2lkICpidWYsIHNpemVfdCBzaXplKQorLyoKKyAqIExvYWQgYSBtaWNy
b2NvZGUgdXBkYXRlIHRvIGN1cnJlbnQgQ1BVLgorICoKKyAqIElmIG5vIHBhdGNoIGlzIHByb3Zp
ZGVkLCB0aGUgY2FjaGVkIHBhdGNoIHdpbGwgYmUgbG9hZGVkLiBNaWNyb2NvZGUgdXBkYXRlCisg
KiBkdXJpbmcgQVBzIGJyaW5ndXAgYW5kIENQVSByZXN1bWluZyBmYWxscyBpbnRvIHRoaXMgY2Fz
ZS4KKyAqLworc3RhdGljIGludCBtaWNyb2NvZGVfdXBkYXRlX2NwdShjb25zdCBzdHJ1Y3QgbWlj
cm9jb2RlX3BhdGNoICpwYXRjaCkKIHsKLSAgICBpbnQgZXJyOwotICAgIHVuc2lnbmVkIGludCBj
cHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7Ci0gICAgc3RydWN0IGNwdV9zaWduYXR1cmUgKnNpZyA9
ICZwZXJfY3B1KGNwdV9zaWcsIGNwdSk7CisgICAgaW50IGVyciA9IG1pY3JvY29kZV9vcHMtPmNv
bGxlY3RfY3B1X2luZm8oJnRoaXNfY3B1KGNwdV9zaWcpKTsKIAotICAgIHNwaW5fbG9jaygmbWlj
cm9jb2RlX211dGV4KTsKKyAgICBpZiAoIHVubGlrZWx5KGVycikgKQorICAgICAgICByZXR1cm4g
ZXJyOwogCi0gICAgZXJyID0gbWljcm9jb2RlX29wcy0+Y29sbGVjdF9jcHVfaW5mbyhzaWcpOwot
ICAgIGlmICggbGlrZWx5KCFlcnIpICkKLSAgICAgICAgZXJyID0gbWljcm9jb2RlX29wcy0+Y3B1
X3JlcXVlc3RfbWljcm9jb2RlKGJ1Ziwgc2l6ZSk7Ci0gICAgc3Bpbl91bmxvY2soJm1pY3JvY29k
ZV9tdXRleCk7CisgICAgaWYgKCBwYXRjaCApCisgICAgICAgIGVyciA9IG1pY3JvY29kZV9vcHMt
PmFwcGx5X21pY3JvY29kZShwYXRjaCk7CisgICAgZWxzZSBpZiAoIG1pY3JvY29kZV9jYWNoZSAp
CisgICAgeworICAgICAgICBzcGluX2xvY2soJm1pY3JvY29kZV9tdXRleCk7CisgICAgICAgIGVy
ciA9IG1pY3JvY29kZV9vcHMtPmFwcGx5X21pY3JvY29kZShtaWNyb2NvZGVfY2FjaGUpOworICAg
ICAgICBpZiAoIGVyciA9PSAtRUlPICkKKyAgICAgICAgeworICAgICAgICAgICAgbWljcm9jb2Rl
X2ZyZWVfcGF0Y2gobWljcm9jb2RlX2NhY2hlKTsKKyAgICAgICAgICAgIG1pY3JvY29kZV9jYWNo
ZSA9IE5VTEw7CisgICAgICAgIH0KKyAgICAgICAgc3Bpbl91bmxvY2soJm1pY3JvY29kZV9tdXRl
eCk7CisgICAgfQorICAgIGVsc2UKKyAgICAgICAgLyogTm8gcGF0Y2ggdG8gdXBkYXRlICovCisg
ICAgICAgIGVyciA9IC1FTk9FTlQ7CiAKICAgICByZXR1cm4gZXJyOwogfQogCi1zdGF0aWMgbG9u
ZyBkb19taWNyb2NvZGVfdXBkYXRlKHZvaWQgKl9pbmZvKQorc3RhdGljIGxvbmcgZG9fbWljcm9j
b2RlX3VwZGF0ZSh2b2lkICpwYXRjaCkKIHsKLSAgICBzdHJ1Y3QgbWljcm9jb2RlX2luZm8gKmlu
Zm8gPSBfaW5mbzsKLSAgICBpbnQgZXJyb3I7Ci0KLSAgICBCVUdfT04oaW5mby0+Y3B1ICE9IHNt
cF9wcm9jZXNzb3JfaWQoKSk7CisgICAgdW5zaWduZWQgaW50IGNwdTsKIAotICAgIGVycm9yID0g
bWljcm9jb2RlX3VwZGF0ZV9jcHUoaW5mby0+YnVmZmVyLCBpbmZvLT5idWZmZXJfc2l6ZSk7Ci0g
ICAgaWYgKCBlcnJvciApCi0gICAgICAgIGluZm8tPmVycm9yID0gZXJyb3I7CisgICAgLyogU3Rv
cmUgdGhlIHBhdGNoIGFmdGVyIGEgc3VjY2Vzc2Z1bCBsb2FkaW5nICovCisgICAgaWYgKCAhbWlj
cm9jb2RlX3VwZGF0ZV9jcHUocGF0Y2gpICYmIHBhdGNoICkKKyAgICB7CisgICAgICAgIHNwaW5f
bG9jaygmbWljcm9jb2RlX211dGV4KTsKKyAgICAgICAgbWljcm9jb2RlX3VwZGF0ZV9jYWNoZShw
YXRjaCk7CisgICAgICAgIHNwaW5fdW5sb2NrKCZtaWNyb2NvZGVfbXV0ZXgpOworICAgICAgICBw
YXRjaCA9IE5VTEw7CisgICAgfQogCiAgICAgaWYgKCBtaWNyb2NvZGVfb3BzLT5lbmRfdXBkYXRl
ICkKICAgICAgICAgbWljcm9jb2RlX29wcy0+ZW5kX3VwZGF0ZSgpOwogCi0gICAgaW5mby0+Y3B1
ID0gY3B1bWFza19uZXh0KGluZm8tPmNwdSwgJmNwdV9vbmxpbmVfbWFwKTsKLSAgICBpZiAoIGlu
Zm8tPmNwdSA8IG5yX2NwdV9pZHMgKQotICAgICAgICByZXR1cm4gY29udGludWVfaHlwZXJjYWxs
X29uX2NwdShpbmZvLT5jcHUsIGRvX21pY3JvY29kZV91cGRhdGUsIGluZm8pOworICAgIGNwdSA9
IGNwdW1hc2tfbmV4dChzbXBfcHJvY2Vzc29yX2lkKCksICZjcHVfb25saW5lX21hcCk7CisgICAg
aWYgKCBjcHUgPCBucl9jcHVfaWRzICkKKyAgICAgICAgcmV0dXJuIGNvbnRpbnVlX2h5cGVyY2Fs
bF9vbl9jcHUoY3B1LCBkb19taWNyb2NvZGVfdXBkYXRlLCBwYXRjaCk7CiAKLSAgICBlcnJvciA9
IGluZm8tPmVycm9yOwotICAgIHhmcmVlKGluZm8pOwotICAgIHJldHVybiBlcnJvcjsKKyAgICAv
KiBGcmVlIHRoZSBwYXRjaCBpZiBubyBDUFUgaGFzIGxvYWRlZCBpdCBzdWNjZXNzZnVsbHkuICov
CisgICAgaWYgKCBwYXRjaCApCisgICAgICAgIG1pY3JvY29kZV9mcmVlX3BhdGNoKHBhdGNoKTsK
KworICAgIHJldHVybiAwOwogfQogCiBpbnQgbWljcm9jb2RlX3VwZGF0ZShYRU5fR1VFU1RfSEFO
RExFX1BBUkFNKGNvbnN0X3ZvaWQpIGJ1ZiwgdW5zaWduZWQgbG9uZyBsZW4pCiB7CiAgICAgaW50
IHJldDsKLSAgICBzdHJ1Y3QgbWljcm9jb2RlX2luZm8gKmluZm87CisgICAgdm9pZCAqYnVmZmVy
OworICAgIHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnBhdGNoOwogCiAgICAgaWYgKCBsZW4gIT0g
KHVpbnQzMl90KWxlbiApCiAgICAgICAgIHJldHVybiAtRTJCSUc7CkBAIC0zMDAsMzIgKzMyMiw0
NCBAQCBpbnQgbWljcm9jb2RlX3VwZGF0ZShYRU5fR1VFU1RfSEFORExFX1BBUkFNKGNvbnN0X3Zv
aWQpIGJ1ZiwgdW5zaWduZWQgbG9uZyBsZW4pCiAgICAgaWYgKCBtaWNyb2NvZGVfb3BzID09IE5V
TEwgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAotICAgIGluZm8gPSB4bWFsbG9jX2J5dGVz
KHNpemVvZigqaW5mbykgKyBsZW4pOwotICAgIGlmICggaW5mbyA9PSBOVUxMICkKKyAgICBidWZm
ZXIgPSB4bWFsbG9jX2J5dGVzKGxlbik7CisgICAgaWYgKCAhYnVmZmVyICkKICAgICAgICAgcmV0
dXJuIC1FTk9NRU07CiAKLSAgICByZXQgPSBjb3B5X2Zyb21fZ3Vlc3QoaW5mby0+YnVmZmVyLCBi
dWYsIGxlbik7Ci0gICAgaWYgKCByZXQgIT0gMCApCisgICAgaWYgKCBjb3B5X2Zyb21fZ3Vlc3Qo
YnVmZmVyLCBidWYsIGxlbikgKQogICAgIHsKLSAgICAgICAgeGZyZWUoaW5mbyk7Ci0gICAgICAg
IHJldHVybiByZXQ7CisgICAgICAgIHJldCA9IC1FRkFVTFQ7CisgICAgICAgIGdvdG8gZnJlZTsK
ICAgICB9CiAKLSAgICBpbmZvLT5idWZmZXJfc2l6ZSA9IGxlbjsKLSAgICBpbmZvLT5lcnJvciA9
IDA7Ci0gICAgaW5mby0+Y3B1ID0gY3B1bWFza19maXJzdCgmY3B1X29ubGluZV9tYXApOwotCiAg
ICAgaWYgKCBtaWNyb2NvZGVfb3BzLT5zdGFydF91cGRhdGUgKQogICAgIHsKICAgICAgICAgcmV0
ID0gbWljcm9jb2RlX29wcy0+c3RhcnRfdXBkYXRlKCk7CiAgICAgICAgIGlmICggcmV0ICE9IDAg
KQotICAgICAgICB7Ci0gICAgICAgICAgICB4ZnJlZShpbmZvKTsKLSAgICAgICAgICAgIHJldHVy
biByZXQ7Ci0gICAgICAgIH0KKyAgICAgICAgICAgIGdvdG8gZnJlZTsKICAgICB9CiAKLSAgICBy
ZXR1cm4gY29udGludWVfaHlwZXJjYWxsX29uX2NwdShpbmZvLT5jcHUsIGRvX21pY3JvY29kZV91
cGRhdGUsIGluZm8pOworICAgIHBhdGNoID0gcGFyc2VfYmxvYihidWZmZXIsIGxlbik7CisgICAg
aWYgKCBJU19FUlIocGF0Y2gpICkKKyAgICB7CisgICAgICAgIHJldCA9IFBUUl9FUlIocGF0Y2gp
OworICAgICAgICBwcmludGsoWEVOTE9HX0lORk8gIlBhcnNpbmcgbWljcm9jb2RlIGJsb2IgZXJy
b3IgJWRcbiIsIHJldCk7CisgICAgICAgIGdvdG8gZnJlZTsKKyAgICB9CisKKyAgICBpZiAoICFw
YXRjaCApCisgICAgeworICAgICAgICBwcmludGsoWEVOTE9HX0lORk8gIk5vIHVjb2RlIGZvdW5k
LiBVcGRhdGUgYWJvcnRlZCFcbiIpOworICAgICAgICByZXQgPSAtRUlOVkFMOworICAgICAgICBn
b3RvIGZyZWU7CisgICAgfQorCisgICAgcmV0ID0gY29udGludWVfaHlwZXJjYWxsX29uX2NwdShj
cHVtYXNrX2ZpcnN0KCZjcHVfb25saW5lX21hcCksCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkb19taWNyb2NvZGVfdXBkYXRlLCBwYXRjaCk7CisKKyBmcmVlOgorICAgIHhm
cmVlKGJ1ZmZlcik7CisgICAgcmV0dXJuIHJldDsKIH0KIAogc3RhdGljIGludCBfX2luaXQgbWlj
cm9jb2RlX2luaXQodm9pZCkKQEAgLTM3MiwyMyArNDA2LDQ2IEBAIGludCBfX2luaXQgZWFybHlf
bWljcm9jb2RlX3VwZGF0ZV9jcHUoYm9vbCBzdGFydF91cGRhdGUpCiAKICAgICBtaWNyb2NvZGVf
b3BzLT5jb2xsZWN0X2NwdV9pbmZvKCZ0aGlzX2NwdShjcHVfc2lnKSk7CiAKLSAgICBpZiAoIGRh
dGEgKQorICAgIGlmICggIWRhdGEgKQorICAgICAgICByZXR1cm4gLUVOT01FTTsKKworICAgIGlm
ICggc3RhcnRfdXBkYXRlICkKICAgICB7Ci0gICAgICAgIGlmICggc3RhcnRfdXBkYXRlICYmIG1p
Y3JvY29kZV9vcHMtPnN0YXJ0X3VwZGF0ZSApCisgICAgICAgIHN0cnVjdCBtaWNyb2NvZGVfcGF0
Y2ggKnBhdGNoOworCisgICAgICAgIGlmICggbWljcm9jb2RlX29wcy0+c3RhcnRfdXBkYXRlICkK
ICAgICAgICAgICAgIHJjID0gbWljcm9jb2RlX29wcy0+c3RhcnRfdXBkYXRlKCk7CiAKICAgICAg
ICAgaWYgKCByYyApCiAgICAgICAgICAgICByZXR1cm4gcmM7CiAKLSAgICAgICAgcmMgPSBtaWNy
b2NvZGVfdXBkYXRlX2NwdShkYXRhLCBsZW4pOworICAgICAgICBwYXRjaCA9IHBhcnNlX2Jsb2Io
ZGF0YSwgbGVuKTsKKyAgICAgICAgaWYgKCBJU19FUlIocGF0Y2gpICkKKyAgICAgICAgeworICAg
ICAgICAgICAgcHJpbnRrKFhFTkxPR19JTkZPICJQYXJzaW5nIG1pY3JvY29kZSBibG9iIGVycm9y
ICVsZFxuIiwKKyAgICAgICAgICAgICAgICAgICBQVFJfRVJSKHBhdGNoKSk7CisgICAgICAgICAg
ICByZXR1cm4gUFRSX0VSUihwYXRjaCk7CisgICAgICAgIH0KKworICAgICAgICBpZiAoICFwYXRj
aCApCisgICAgICAgIHsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiTm8gdWNvZGUg
Zm91bmQuIFVwZGF0ZSBhYm9ydGVkIVxuIik7CisgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsK
KyAgICAgICAgfQogCi0gICAgICAgIGlmICggbWljcm9jb2RlX29wcy0+ZW5kX3VwZGF0ZSApCi0g
ICAgICAgICAgICBtaWNyb2NvZGVfb3BzLT5lbmRfdXBkYXRlKCk7CisgICAgICAgIHNwaW5fbG9j
aygmbWljcm9jb2RlX211dGV4KTsKKyAgICAgICAgcmMgPSBtaWNyb2NvZGVfdXBkYXRlX2NhY2hl
KHBhdGNoKTsKKyAgICAgICAgc3Bpbl91bmxvY2soJm1pY3JvY29kZV9tdXRleCk7CiAKLSAgICAg
ICAgcmV0dXJuIHJjOworICAgICAgICBBU1NFUlQocmMpOwogICAgIH0KLSAgICBlbHNlCi0gICAg
ICAgIHJldHVybiAtRU5PTUVNOworCisgICAgcmMgPSBtaWNyb2NvZGVfdXBkYXRlX2NwdShOVUxM
KTsKKworICAgIGlmICggbWljcm9jb2RlX29wcy0+ZW5kX3VwZGF0ZSApCisgICAgICAgIG1pY3Jv
Y29kZV9vcHMtPmVuZF91cGRhdGUoKTsKKworICAgIHJldHVybiByYzsKIH0KIAogaW50IF9faW5p
dCBlYXJseV9taWNyb2NvZGVfaW5pdCh2b2lkKQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21p
Y3JvY29kZV9hbWQuYyBiL3hlbi9hcmNoL3g4Ni9taWNyb2NvZGVfYW1kLmMKaW5kZXggMjFjZGZl
MC4uNjM1MzMyMyAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9hbWQuYworKysg
Yi94ZW4vYXJjaC94ODYvbWljcm9jb2RlX2FtZC5jCkBAIC00NDcsOSArNDQ3LDExIEBAIHN0YXRp
YyBib29sX3QgY2hlY2tfZmluYWxfcGF0Y2hfbGV2ZWxzKHVuc2lnbmVkIGludCBjcHUpCiAgICAg
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY3B1X3JlcXVlc3RfbWljcm9jb2RlKGNvbnN0IHZv
aWQgKmJ1Ziwgc2l6ZV90IGJ1ZnNpemUpCitzdGF0aWMgc3RydWN0IG1pY3JvY29kZV9wYXRjaCAq
Y3B1X3JlcXVlc3RfbWljcm9jb2RlKGNvbnN0IHZvaWQgKmJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IGJ1ZnNpemUpCiB7CiAg
ICAgc3RydWN0IG1pY3JvY29kZV9hbWQgKm1jX2FtZDsKKyAgICBzdHJ1Y3QgbWljcm9jb2RlX3Bh
dGNoICpwYXRjaCA9IE5VTEw7CiAgICAgc2l6ZV90IG9mZnNldCA9IDA7CiAgICAgaW50IGVycm9y
ID0gMDsKICAgICB1bnNpZ25lZCBpbnQgY3VycmVudF9jcHVfaWQ7CkBAIC01NDgsMTkgKzU1MCwy
MiBAQCBzdGF0aWMgaW50IGNwdV9yZXF1ZXN0X21pY3JvY29kZShjb25zdCB2b2lkICpidWYsIHNp
emVfdCBidWZzaXplKQogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KIAotICAgICAgICAv
KiBVcGRhdGUgY2FjaGUgaWYgdGhpcyBwYXRjaCBjb3ZlcnMgY3VycmVudCBDUFUgKi8KLSAgICAg
ICAgaWYgKCBtaWNyb2NvZGVfZml0cyhuZXdfcGF0Y2gtPm1jX2FtZCkgIT0gTUlTX1VDT0RFICkK
LSAgICAgICAgICAgIG1pY3JvY29kZV91cGRhdGVfY2FjaGUobmV3X3BhdGNoKTsKLSAgICAgICAg
ZWxzZQotICAgICAgICAgICAgbWljcm9jb2RlX2ZyZWVfcGF0Y2gobmV3X3BhdGNoKTsKLQotICAg
ICAgICBpZiAoIG1hdGNoX2NwdShtaWNyb2NvZGVfZ2V0X2NhY2hlKCkpICkKKyAgICAgICAgLyoK
KyAgICAgICAgICogSWYgdGhlIG5ldyBwYXRjaCBjb3ZlcnMgY3VycmVudCBDUFUsIGNvbXBhcmUg
cGF0Y2hlcyBhbmQgc3RvcmUgdGhlCisgICAgICAgICAqIG9uZSB3aXRoIGhpZ2hlciByZXZpc2lv
bi4KKyAgICAgICAgICovCisgICAgICAgIGlmICggKG1pY3JvY29kZV9maXRzKG5ld19wYXRjaC0+
bWNfYW1kKSAhPSBNSVNfVUNPREUpICYmCisgICAgICAgICAgICAgKCFwYXRjaCB8fCAoY29tcGFy
ZV9wYXRjaChuZXdfcGF0Y2gsIHBhdGNoKSA9PSBORVdfVUNPREUpKSApCiAgICAgICAgIHsKLSAg
ICAgICAgICAgIGVycm9yID0gYXBwbHlfbWljcm9jb2RlKG1pY3JvY29kZV9nZXRfY2FjaGUoKSk7
Ci0gICAgICAgICAgICBpZiAoIGVycm9yICkKLSAgICAgICAgICAgICAgICBicmVhazsKKyAgICAg
ICAgICAgIHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnRtcCA9IHBhdGNoOworCisgICAgICAgICAg
ICBwYXRjaCA9IG5ld19wYXRjaDsKKyAgICAgICAgICAgIG5ld19wYXRjaCA9IHRtcDsKICAgICAg
ICAgfQogCisgICAgICAgIGlmICggbmV3X3BhdGNoICkKKyAgICAgICAgICAgIG1pY3JvY29kZV9m
cmVlX3BhdGNoKG5ld19wYXRjaCk7CisKICAgICAgICAgaWYgKCBvZmZzZXQgPj0gYnVmc2l6ZSAp
CiAgICAgICAgICAgICBicmVhazsKIApAQCAtNTkzLDEzICs1OTgsMTAgQEAgc3RhdGljIGludCBj
cHVfcmVxdWVzdF9taWNyb2NvZGUoY29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgYnVmc2l6ZSkKICAg
ICB4ZnJlZShtY19hbWQpOwogCiAgIG91dDoKLSAgICAvKgotICAgICAqIEluIHNvbWUgY2FzZXMg
d2UgbWF5IHJldHVybiBhbiBlcnJvciBldmVuIGlmIHByb2Nlc3NvcidzIG1pY3JvY29kZSBoYXMK
LSAgICAgKiBiZWVuIHVwZGF0ZWQuIEZvciBleGFtcGxlLCB0aGUgZmlyc3QgcGF0Y2ggaW4gYSBj
b250YWluZXIgZmlsZSBpcyBsb2FkZWQKLSAgICAgKiBzdWNjZXNzZnVsbHkgYnV0IHN1YnNlcXVl
bnQgY29udGFpbmVyIGZpbGUgcHJvY2Vzc2luZyBlbmNvdW50ZXJzIGEKLSAgICAgKiBmYWlsdXJl
LgotICAgICAqLwotICAgIHJldHVybiBlcnJvcjsKKyAgICBpZiAoIGVycm9yICYmICFwYXRjaCAp
CisgICAgICAgIHBhdGNoID0gRVJSX1BUUihlcnJvcik7CisKKyAgICByZXR1cm4gcGF0Y2g7CiB9
CiAKIHN0YXRpYyBpbnQgc3RhcnRfdXBkYXRlKHZvaWQpCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94
ODYvbWljcm9jb2RlX2ludGVsLmMgYi94ZW4vYXJjaC94ODYvbWljcm9jb2RlX2ludGVsLmMKaW5k
ZXggOGMwMDA4Yy4uOTZiMzhmOCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21pY3JvY29kZV9p
bnRlbC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9taWNyb2NvZGVfaW50ZWwuYwpAQCAtMjgyLDE0ICsy
ODIsOSBAQCBzdGF0aWMgZW51bSBtaWNyb2NvZGVfbWF0Y2hfcmVzdWx0IGNvbXBhcmVfcGF0Y2go
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgT0xEX1VDT0RFOwogfQogCi0vKgotICogcmV0dXJuIDAgLSBubyB1cGRhdGUgZm91
bmQKLSAqIHJldHVybiAxIC0gZm91bmQgdXBkYXRlCi0gKiByZXR1cm4gPCAwIC0gZXJyb3IKLSAq
Lwotc3RhdGljIGludCBnZXRfbWF0Y2hpbmdfbWljcm9jb2RlKGNvbnN0IHZvaWQgKm1jKQorc3Rh
dGljIHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKmFsbG9jX21pY3JvY29kZV9wYXRjaCgKKyAgICBj
b25zdCBzdHJ1Y3QgbWljcm9jb2RlX2hlYWRlcl9pbnRlbCAqbWNfaGVhZGVyKQogewotICAgIGNv
bnN0IHN0cnVjdCBtaWNyb2NvZGVfaGVhZGVyX2ludGVsICptY19oZWFkZXIgPSBtYzsKICAgICB1
bnNpZ25lZCBsb25nIHRvdGFsX3NpemUgPSBnZXRfdG90YWxzaXplKG1jX2hlYWRlcik7CiAgICAg
dm9pZCAqbmV3X21jID0geG1hbGxvY19ieXRlcyh0b3RhbF9zaXplKTsKICAgICBzdHJ1Y3QgbWlj
cm9jb2RlX3BhdGNoICpuZXdfcGF0Y2ggPSB4bWFsbG9jKHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2gp
OwpAQCAtMjk4LDI1ICsyOTMsMTIgQEAgc3RhdGljIGludCBnZXRfbWF0Y2hpbmdfbWljcm9jb2Rl
KGNvbnN0IHZvaWQgKm1jKQogICAgIHsKICAgICAgICAgeGZyZWUobmV3X3BhdGNoKTsKICAgICAg
ICAgeGZyZWUobmV3X21jKTsKLSAgICAgICAgcmV0dXJuIC1FTk9NRU07CisgICAgICAgIHJldHVy
biBFUlJfUFRSKC1FTk9NRU0pOwogICAgIH0KLSAgICBtZW1jcHkobmV3X21jLCBtYywgdG90YWxf
c2l6ZSk7CisgICAgbWVtY3B5KG5ld19tYywgbWNfaGVhZGVyLCB0b3RhbF9zaXplKTsKICAgICBu
ZXdfcGF0Y2gtPm1jX2ludGVsID0gbmV3X21jOwogCi0gICAgLyogTWFrZSBzdXJlIHRoYXQgdGhp
cyBwYXRjaCBjb3ZlcnMgY3VycmVudCBDUFUgKi8KLSAgICBpZiAoIG1pY3JvY29kZV91cGRhdGVf
bWF0Y2gobWMpID09IE1JU19VQ09ERSApCi0gICAgewotICAgICAgICBtaWNyb2NvZGVfZnJlZV9w
YXRjaChuZXdfcGF0Y2gpOwotICAgICAgICByZXR1cm4gMDsKLSAgICB9Ci0KLSAgICBtaWNyb2Nv
ZGVfdXBkYXRlX2NhY2hlKG5ld19wYXRjaCk7Ci0KLSAgICBwcl9kZWJ1ZygibWljcm9jb2RlOiBD
UFUlZCBmb3VuZCBhIG1hdGNoaW5nIG1pY3JvY29kZSB1cGRhdGUgd2l0aCIKLSAgICAgICAgICAg
ICAiIHZlcnNpb24gJSN4IChjdXJyZW50PSUjeClcbiIsCi0gICAgICAgICAgICAgc21wX3Byb2Nl
c3Nvcl9pZCgpLCBtY19oZWFkZXItPnJldiwgdGhpc19jcHUoY3B1X3NpZykucmV2KTsKLQotICAg
IHJldHVybiAxOworICAgIHJldHVybiBuZXdfcGF0Y2g7CiB9CiAKIHN0YXRpYyBpbnQgYXBwbHlf
bWljcm9jb2RlKGNvbnN0IHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnBhdGNoKQpAQCAtMzkyLDI2
ICszNzQsNDQgQEAgc3RhdGljIGxvbmcgZ2V0X25leHRfdWNvZGVfZnJvbV9idWZmZXIodm9pZCAq
Km1jLCBjb25zdCB1OCAqYnVmLAogICAgIHJldHVybiBvZmZzZXQgKyB0b3RhbF9zaXplOwogfQog
Ci1zdGF0aWMgaW50IGNwdV9yZXF1ZXN0X21pY3JvY29kZShjb25zdCB2b2lkICpidWYsIHNpemVf
dCBzaXplKQorc3RhdGljIHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKmNwdV9yZXF1ZXN0X21pY3Jv
Y29kZShjb25zdCB2b2lkICpidWYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNpemVfdCBzaXplKQogewogICAgIGxvbmcgb2Zmc2V0ID0gMDsK
ICAgICBpbnQgZXJyb3IgPSAwOwogICAgIHZvaWQgKm1jOworICAgIHN0cnVjdCBtaWNyb2NvZGVf
cGF0Y2ggKnBhdGNoID0gTlVMTDsKIAogICAgIHdoaWxlICggKG9mZnNldCA9IGdldF9uZXh0X3Vj
b2RlX2Zyb21fYnVmZmVyKCZtYywgYnVmLCBzaXplLCBvZmZzZXQpKSA+IDAgKQogICAgIHsKKyAg
ICAgICAgc3RydWN0IG1pY3JvY29kZV9wYXRjaCAqbmV3X3BhdGNoOworCiAgICAgICAgIGVycm9y
ID0gbWljcm9jb2RlX3Nhbml0eV9jaGVjayhtYyk7CiAgICAgICAgIGlmICggZXJyb3IgKQogICAg
ICAgICAgICAgYnJlYWs7Ci0gICAgICAgIGVycm9yID0gZ2V0X21hdGNoaW5nX21pY3JvY29kZSht
Yyk7Ci0gICAgICAgIGlmICggZXJyb3IgPCAwICkKKworICAgICAgICBuZXdfcGF0Y2ggPSBhbGxv
Y19taWNyb2NvZGVfcGF0Y2gobWMpOworICAgICAgICBpZiAoIElTX0VSUihuZXdfcGF0Y2gpICkK
KyAgICAgICAgeworICAgICAgICAgICAgZXJyb3IgPSBQVFJfRVJSKG5ld19wYXRjaCk7CiAgICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgfQorCiAgICAgICAgIC8qCi0gICAgICAgICAqIEl0J3Mg
cG9zc2libGUgdGhlIGRhdGEgZmlsZSBoYXMgbXVsdGlwbGUgbWF0Y2hpbmcgdWNvZGUsCi0gICAg
ICAgICAqIGxldHMga2VlcCBzZWFyY2hpbmcgdGlsbCB0aGUgbGF0ZXN0IHZlcnNpb24KKyAgICAg
ICAgICogSWYgdGhlIG5ldyBwYXRjaCBjb3ZlcnMgY3VycmVudCBDUFUsIGNvbXBhcmUgcGF0Y2hl
cyBhbmQgc3RvcmUgdGhlCisgICAgICAgICAqIG9uZSB3aXRoIGhpZ2hlciByZXZpc2lvbi4KICAg
ICAgICAgICovCi0gICAgICAgIGlmICggZXJyb3IgPT0gMSApCi0gICAgICAgICAgICBlcnJvciA9
IDA7CisgICAgICAgIGlmICggKG1pY3JvY29kZV91cGRhdGVfbWF0Y2goJm5ld19wYXRjaC0+bWNf
aW50ZWwtPmhkcikgIT0gTUlTX1VDT0RFKSAmJgorICAgICAgICAgICAgICghcGF0Y2ggfHwgKGNv
bXBhcmVfcGF0Y2gobmV3X3BhdGNoLCBwYXRjaCkgPT0gTkVXX1VDT0RFKSkgKQorICAgICAgICB7
CisgICAgICAgICAgICBzdHJ1Y3QgbWljcm9jb2RlX3BhdGNoICp0bXAgPSBwYXRjaDsKKworICAg
ICAgICAgICAgcGF0Y2ggPSBuZXdfcGF0Y2g7CisgICAgICAgICAgICBuZXdfcGF0Y2ggPSB0bXA7
CisgICAgICAgIH0KKworICAgICAgICBpZiAoIG5ld19wYXRjaCApCisgICAgICAgICAgICBtaWNy
b2NvZGVfZnJlZV9wYXRjaChuZXdfcGF0Y2gpOwogCiAgICAgICAgIHhmcmVlKG1jKTsKICAgICB9
CkBAIC00MjAsMTAgKzQyMCwxMCBAQCBzdGF0aWMgaW50IGNwdV9yZXF1ZXN0X21pY3JvY29kZShj
b25zdCB2b2lkICpidWYsIHNpemVfdCBzaXplKQogICAgIGlmICggb2Zmc2V0IDwgMCApCiAgICAg
ICAgIGVycm9yID0gb2Zmc2V0OwogCi0gICAgaWYgKCAhZXJyb3IgJiYgbWF0Y2hfY3B1KG1pY3Jv
Y29kZV9nZXRfY2FjaGUoKSkgKQotICAgICAgICBlcnJvciA9IGFwcGx5X21pY3JvY29kZShtaWNy
b2NvZGVfZ2V0X2NhY2hlKCkpOworICAgIGlmICggZXJyb3IgJiYgIXBhdGNoICkKKyAgICAgICAg
cGF0Y2ggPSBFUlJfUFRSKGVycm9yKTsKIAotICAgIHJldHVybiBlcnJvcjsKKyAgICByZXR1cm4g
cGF0Y2g7CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgbWljcm9jb2RlX29wcyBtaWNyb2NvZGVf
aW50ZWxfb3BzID0gewpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9taWNyb2NvZGUu
aCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbWljcm9jb2RlLmgKaW5kZXggOGM3ZGU5ZC4uOGU3MTYx
NSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9taWNyb2NvZGUuaAorKysgYi94ZW4v
aW5jbHVkZS9hc20teDg2L21pY3JvY29kZS5oCkBAIC0yMCw3ICsyMCw4IEBAIHN0cnVjdCBtaWNy
b2NvZGVfcGF0Y2ggewogfTsKIAogc3RydWN0IG1pY3JvY29kZV9vcHMgewotICAgIGludCAoKmNw
dV9yZXF1ZXN0X21pY3JvY29kZSkoY29uc3Qgdm9pZCAqYnVmLCBzaXplX3Qgc2l6ZSk7CisgICAg
c3RydWN0IG1pY3JvY29kZV9wYXRjaCAqKCpjcHVfcmVxdWVzdF9taWNyb2NvZGUpKGNvbnN0IHZv
aWQgKmJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2l6ZV90IHNpemUpOwogICAgIGludCAoKmNvbGxlY3RfY3B1X2luZm8pKHN0cnVjdCBj
cHVfc2lnbmF0dXJlICpjc2lnKTsKICAgICBpbnQgKCphcHBseV9taWNyb2NvZGUpKGNvbnN0IHN0
cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnBhdGNoKTsKICAgICBpbnQgKCpzdGFydF91cGRhdGUpKHZv
aWQpOwpAQCAtNDEsOCArNDIsNiBAQCBzdHJ1Y3QgY3B1X3NpZ25hdHVyZSB7CiBERUNMQVJFX1BF
Ul9DUFUoc3RydWN0IGNwdV9zaWduYXR1cmUsIGNwdV9zaWcpOwogZXh0ZXJuIGNvbnN0IHN0cnVj
dCBtaWNyb2NvZGVfb3BzICptaWNyb2NvZGVfb3BzOwogCi1jb25zdCBzdHJ1Y3QgbWljcm9jb2Rl
X3BhdGNoICptaWNyb2NvZGVfZ2V0X2NhY2hlKHZvaWQpOwotYm9vbCBtaWNyb2NvZGVfdXBkYXRl
X2NhY2hlKHN0cnVjdCBtaWNyb2NvZGVfcGF0Y2ggKnBhdGNoKTsKIHZvaWQgbWljcm9jb2RlX2Zy
ZWVfcGF0Y2goc3RydWN0IG1pY3JvY29kZV9wYXRjaCAqcGF0Y2gpOwogCiAjZW5kaWYgLyogQVNN
X1g4Nl9fTUlDUk9DT0RFX0ggKi8KLS0gCjEuOC4zLjEKCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZl
bEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxt
YW4vbGlzdGluZm8veGVuLWRldmVs

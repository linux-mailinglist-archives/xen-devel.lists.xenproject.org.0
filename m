Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E52A91C35
	for <lists+xen-devel@lfdr.de>; Mon, 19 Aug 2019 07:03:50 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hzZni-0003T5-Gb; Mon, 19 Aug 2019 05:01:50 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=SjD+=WP=invisiblethingslab.com=mkow@srs-us1.protection.inumbo.net>)
 id 1hzXMr-0007Xn-EC
 for xen-devel@lists.xenproject.org; Mon, 19 Aug 2019 02:25:57 +0000
X-Inumbo-ID: ac99d8b0-c228-11e9-b90c-bc764e2007e4
Received: from out4-smtp.messagingengine.com (unknown [66.111.4.28])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id ac99d8b0-c228-11e9-b90c-bc764e2007e4;
 Mon, 19 Aug 2019 02:25:56 +0000 (UTC)
Received: from compute2.internal (compute2.nyi.internal [10.202.2.42])
 by mailout.nyi.internal (Postfix) with ESMTP id 0446E20F24;
 Sun, 18 Aug 2019 22:25:56 -0400 (EDT)
Received: from mailfrontend1 ([10.202.2.162])
 by compute2.internal (MEProxy); Sun, 18 Aug 2019 22:25:56 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:message-id:mime-version:subject:to:x-me-proxy
 :x-me-proxy:x-me-sender:x-me-sender:x-sasl-enc; s=fm3; bh=/CVNj+
 SHPZl6K/KJ86ocKbDglMh3IcSz6hX1P4cLp3k=; b=AYf9EwLKx7g/SsGfpsItt2
 5btyqU+qDSQaAjda4hhK9dn8vBrd8lz9+3390JRgK0uIK/WA0izFuRHyjvbxz6D5
 ekgHZTpprzDPhjkoRBxIXEn9EQwOfMNNFTxuAJUrtKKDGoqTBvu1kZeXF0qqjX7A
 s1xdr4OyykDy10XhPflUJpoA5Xqp2k4mrpg3DaXSl8iXex6tRtj1HpY66OvB4PoK
 FHXAk48MeephgRjUZsArVQQn8u8eVIVAmQCoLa80utYMYO6dFlSccN8XTrROMMI4
 EbZ/iMGzYFiX+x8NzLjPJVvq/OWZQ40mQCP82Y4KB/7AEf3SiwvuZHU7ONUzfovg
 ==
X-ME-Sender: <xms:swhaXc9hRPin6efU_LKm_6uAkRiytoJq6Ol3n-8ohot4bbakVRZCJQ>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgeduvddrudefkedgheekucetufdoteggodetrfdotf
 fvucfrrhhofhhilhgvmecuhfgrshhtofgrihhlpdfqfgfvpdfurfetoffkrfgpnffqhgen
 uceurghilhhouhhtmecufedttdenucesvcftvggtihhpihgvnhhtshculddquddttddmne
 cujfgurhephffvufffkffogggtgfesthekredtredtjeenucfhrhhomhepofhitghhrghl
 ucfmohifrghltgiihihkuceomhhkohifsehinhhvihhsihgslhgvthhhihhnghhslhgrsg
 drtghomheqnecuffhomhgrihhnpehtrhgrmhhpohhlihhnvgdrshgspdifrghkvghuphdr
 shgsnecukfhppeekledrieegrdduledruddvfeenucfrrghrrghmpehmrghilhhfrhhomh
 epmhhkohifsehinhhvihhsihgslhgvthhhihhnghhslhgrsgdrtghomhenucevlhhushht
 vghrufhiiigvpedt
X-ME-Proxy: <xmx:swhaXeaBXq9LbmWaWUPwDR-EEw82B0kwpGSMWCtdCPg0YWRbjtEa4g>
 <xmx:swhaXRU0W8cK39q75Ldy5cLdbKhYzs1RHSUne8eqRBgIQa7mu-OIYA>
 <xmx:swhaXUgp_RvZXU2RhUs7AOUxapmng9_8vFUQKxXvmE0A49UMrBylCg>
 <xmx:swhaXQOAOg_arBrhiZYoPmIRLXeLsftGynuFzZuXGRvDOmCVqoM1Fw>
Received: from localhost.localdomain (89-64-19-123.dynamic.chello.pl
 [89.64.19.123])
 by mail.messagingengine.com (Postfix) with ESMTPA id A392E8005B;
 Sun, 18 Aug 2019 22:25:53 -0400 (EDT)
From: =?UTF-8?q?Micha=C5=82=20Kowalczyk?= <mkow@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 19 Aug 2019 04:23:33 +0200
Message-Id: <1c917278029b206317a2155fb78e63ed14b621e5.1566176127.git.mkow@invisiblethingslab.com>
X-Mailer: git-send-email 2.11.0
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 19 Aug 2019 05:01:49 +0000
Subject: [Xen-devel] [PATCH v1] x86: Restore IA32_MISC_ENABLE on wakeup
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Wei Liu <wl@xen.org>,
 =?UTF-8?q?Micha=C5=82=20Kowalczyk?= <mkow@invisiblethingslab.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Q29kZSBpbiBpbnRlbC5jOmVhcmx5X2luaXRfaW50ZWwoKSBtb2RpZmllcyBJQTMyX01JU0NfRU5B
QkxFIE1TUi4gVGhvc2UKbW9kaWZpY2F0aW9ucyBtdXN0IGJlIHJlc3RvcmVkIGFmdGVyIHJlc3Vt
aW5nIGZyb20gUzMgKHNlZSBlLmcuIExpbnV4IHdha2V1cApjb2RlKSwgb3RoZXJ3aXNlIGJhZCB0
aGluZ3MgbWF5IGhhcHBlbiAoZS5nLiB3YWtldXAgY29kZSBtYXkgY2F1c2UgI0dQIHdoZW4KdHJ5
aW5nIHRvIHNldCBJQTMyX0VGRVIuTlhFIFsxXSkuCgpUaGlzIGJ1ZyB3YXMgbm90aWNlZCBvbiBh
IFRoaW5rUGFkIHgyMzAgd2l0aCBOWCBkaXNhYmxlZCBpbiB0aGUgQklPUzoKWGVuIGNvdWxkIGNv
cnJlY3RseSBib290LCBidXQgY3Jhc2hlZCB3aGVuIHJlc3VtaW5nIGZyb20gc3VzcGVuZC4KQXBw
bHlpbmcgdGhpcyBwYXRjaCBmaXhlZCB0aGUgcHJvYmxlbS4KClsxXSBJbnRlbCBTRE0gdm9sIDM6
ICJJZiB0aGUgZXhlY3V0ZS1kaXNhYmxlIGNhcGFiaWxpdHkgaXMgbm90CmF2YWlsYWJsZSwgYSB3
cml0ZSB0byBzZXQgSUEzMl9FRkVSLk5YRSBwcm9kdWNlcyBhICNHUCBleGNlcHRpb24uIgoKU2ln
bmVkLW9mZi1ieTogTWljaGHFgiBLb3dhbGN6eWsgPG1rb3dAaW52aXNpYmxldGhpbmdzbGFiLmNv
bT4KLS0tCiB4ZW4vYXJjaC94ODYvYm9vdC90cmFtcG9saW5lLlMgIHwgIDYgKysrLS0tCiB4ZW4v
YXJjaC94ODYvYm9vdC93YWtldXAuUyAgICAgIHwgMTUgKysrKysrKysrKysrKysrCiB4ZW4vYXJj
aC94ODYvY3B1L2ludGVsLmMgICAgICAgIHwgIDIgKy0KIHhlbi9pbmNsdWRlL2FzbS14ODYvcHJv
Y2Vzc29yLmggfCAgMiArLQogNCBmaWxlcyBjaGFuZ2VkLCAyMCBpbnNlcnRpb25zKCspLCA1IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9ib290L3RyYW1wb2xpbmUuUyBi
L3hlbi9hcmNoL3g4Ni9ib290L3RyYW1wb2xpbmUuUwppbmRleCA3YzZhMjMyOGQyLi5mY2FhM2Vl
YWYxIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvYm9vdC90cmFtcG9saW5lLlMKKysrIGIveGVu
L2FyY2gveDg2L2Jvb3QvdHJhbXBvbGluZS5TCkBAIC04NSw3ICs4NSw3IEBAIHRyYW1wb2xpbmVf
Z2R0OgogICAgICAgICAubG9uZyAgIHRyYW1wb2xpbmVfZ2R0ICsgQk9PVF9QU0VVRE9STV9EUyAr
IDIgLSAuCiAgICAgICAgIC5wb3BzZWN0aW9uCiAKLUdMT0JBTCh0cmFtcG9saW5lX21pc2NfZW5h
YmxlX29mZikKK0dMT0JBTChtaXNjX2VuYWJsZV9vZmYpCiAgICAgICAgIC5xdWFkICAgMAogCiBH
TE9CQUwoY3B1aWRfZXh0X2ZlYXR1cmVzKQpAQCAtMTE3LDggKzExNyw4IEBAIHRyYW1wb2xpbmVf
cHJvdG1vZGVfZW50cnk6CiAgICAgICAgIG1vdiAgICAgJWVheCwlY3IzCiAKICAgICAgICAgLyog
QWRqdXN0IElBMzJfTUlTQ19FTkFCTEUgaWYgbmVlZGVkIChmb3IgTlggZW5hYmxpbmcgYmVsb3cp
LiAqLwotICAgICAgICBtb3YgICAgIGJvb3RzeW1fcmVsKHRyYW1wb2xpbmVfbWlzY19lbmFibGVf
b2ZmLDQsJWVzaSkKLSAgICAgICAgbW92ICAgICBib290c3ltX3JlbCh0cmFtcG9saW5lX21pc2Nf
ZW5hYmxlX29mZis0LDQsJWVkaSkKKyAgICAgICAgbW92ICAgICBib290c3ltX3JlbChtaXNjX2Vu
YWJsZV9vZmYsNCwlZXNpKQorICAgICAgICBtb3YgICAgIGJvb3RzeW1fcmVsKG1pc2NfZW5hYmxl
X29mZis0LDQsJWVkaSkKICAgICAgICAgbW92ICAgICAlZXNpLCVlYXgKICAgICAgICAgb3IgICAg
ICAlZWRpLCVlYXgKICAgICAgICAganogICAgICAxZgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L2Jvb3Qvd2FrZXVwLlMgYi94ZW4vYXJjaC94ODYvYm9vdC93YWtldXAuUwppbmRleCBlM2NiOWUw
MzNhLi5iNWY4MjVlOTgzIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvYm9vdC93YWtldXAuUwor
KysgYi94ZW4vYXJjaC94ODYvYm9vdC93YWtldXAuUwpAQCAtMTM4LDYgKzEzOCwyMSBAQCB3YWtl
dXBfMzI6CiAgICAgICAgIGFkZCAgICAgYm9vdHN5bV9yZWwodHJhbXBvbGluZV94ZW5fcGh5c19z
dGFydCw0LCVlYXgpCiAgICAgICAgIG1vdiAgICAgJWVheCwlY3IzCiAKKyAgICAgICAgLyogUmVh
cHBseSBJQTMyX01JU0NfRU5BQkxFIG1vZGlmaWNhdGlvbnMgZnJvbSBlYXJseV9pbml0X2ludGVs
KCkuICovCisgICAgICAgIG1vdiAgICAgYm9vdHN5bV9yZWwobWlzY19lbmFibGVfb2ZmLCA0LCAl
ZXNpKQorICAgICAgICBtb3YgICAgIGJvb3RzeW1fcmVsKG1pc2NfZW5hYmxlX29mZis0LCA0LCAl
ZWRpKQorICAgICAgICBtb3YgICAgICVlc2ksICVlYXgKKyAgICAgICAgb3IgICAgICAlZWRpLCAl
ZWF4CisgICAgICAgIGp6ICAgICAgMWYKKyAgICAgICAgbW92ICAgICAkTVNSX0lBMzJfTUlTQ19F
TkFCTEUsICVlY3gKKyAgICAgICAgcmRtc3IKKyAgICAgICAgbm90ICAgICAlZXNpCisgICAgICAg
IG5vdCAgICAgJWVkaQorICAgICAgICBhbmQgICAgICVlc2ksICVlYXgKKyAgICAgICAgYW5kICAg
ICAlZWRpLCAlZWR4CisgICAgICAgIHdybXNyCisxOgorCiAgICAgICAgIC8qIFdpbGwgY3B1aWQg
ZmVhdHVyZSBjaGFuZ2UgYWZ0ZXIgcmVzdW1lPyAqLwogICAgICAgICAvKiBTZXQgdXAgRUZFUiAo
RXh0ZW5kZWQgRmVhdHVyZSBFbmFibGUgUmVnaXN0ZXIpLiAqLwogICAgICAgICBtb3YgICAgIGJv
b3RzeW1fcmVsKGNwdWlkX2V4dF9mZWF0dXJlcyw0LCVlZGkpCmRpZmYgLS1naXQgYS94ZW4vYXJj
aC94ODYvY3B1L2ludGVsLmMgYi94ZW4vYXJjaC94ODYvY3B1L2ludGVsLmMKaW5kZXggNTM1NmE2
YWUxMC4uYTAxZTUxOTI4MSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2NwdS9pbnRlbC5jCisr
KyBiL3hlbi9hcmNoL3g4Ni9jcHUvaW50ZWwuYwpAQCAtMjY5LDcgKzI2OSw3IEBAIHN0YXRpYyB2
b2lkIGVhcmx5X2luaXRfaW50ZWwoc3RydWN0IGNwdWluZm9feDg2ICpjKQogCQkJCSBNU1JfSUEz
Ml9NSVNDX0VOQUJMRV9YRF9ESVNBQkxFKTsKIAlpZiAoZGlzYWJsZSkgewogCQl3cm1zcmwoTVNS
X0lBMzJfTUlTQ19FTkFCTEUsIG1pc2NfZW5hYmxlICYgfmRpc2FibGUpOwotCQlib290c3ltKHRy
YW1wb2xpbmVfbWlzY19lbmFibGVfb2ZmKSB8PSBkaXNhYmxlOworCQlib290c3ltKG1pc2NfZW5h
YmxlX29mZikgfD0gZGlzYWJsZTsKIAl9CiAKIAlpZiAoZGlzYWJsZSAmIE1TUl9JQTMyX01JU0Nf
RU5BQkxFX0xJTUlUX0NQVUlEKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9j
ZXNzb3IuaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvcHJvY2Vzc29yLmgKaW5kZXggMjg2MjMyMWVl
ZS4uYjMyNWU0YjBkZiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wcm9jZXNzb3Iu
aAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L3Byb2Nlc3Nvci5oCkBAIC0xNTIsNyArMTUyLDcg
QEAgZXh0ZXJuIHZvaWQgKCpjdHh0X3N3aXRjaF9tYXNraW5nKShjb25zdCBzdHJ1Y3QgdmNwdSAq
bmV4dCk7CiAKIGV4dGVybiBib29sX3Qgb3B0X2NwdV9pbmZvOwogZXh0ZXJuIHUzMiBjcHVpZF9l
eHRfZmVhdHVyZXM7Ci1leHRlcm4gdTY0IHRyYW1wb2xpbmVfbWlzY19lbmFibGVfb2ZmOworZXh0
ZXJuIHU2NCBtaXNjX2VuYWJsZV9vZmY7CiAKIC8qIE1heGltdW0gd2lkdGggb2YgcGh5c2ljYWwg
YWRkcmVzc2VzIHN1cHBvcnRlZCBieSB0aGUgaGFyZHdhcmUuICovCiBleHRlcm4gdW5zaWduZWQg
aW50IHBhZGRyX2JpdHM7Ci0tIAoyLjExLjAKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0
cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlz
dGluZm8veGVuLWRldmVs

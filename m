Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 405CC98BD1
	for <lists+xen-devel@lfdr.de>; Thu, 22 Aug 2019 08:56:41 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i0gx2-0002Zn-TG; Thu, 22 Aug 2019 06:52:04 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=ng0H=WS=citrix.com=roger.pau@srs-us1.protection.inumbo.net>)
 id 1i0gx1-0002Zi-6R
 for xen-devel@lists.xenproject.org; Thu, 22 Aug 2019 06:52:03 +0000
X-Inumbo-ID: 5643114c-c4a9-11e9-ac23-bc764e2007e4
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 5643114c-c4a9-11e9-ac23-bc764e2007e4;
 Thu, 22 Aug 2019 06:51:59 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1566456719;
 h=from:to:cc:subject:date:message-id:mime-version:
 content-transfer-encoding;
 bh=5DHEuR0Ijdpig51Ag9q9iN3jLpUwlQzwFlyKldASa3E=;
 b=UxlQF6Nb8nOFXXuvhrzmPJx9+uexOK1+vu5SLA9F481qEWhqG1qeDaIO
 cX6f05cAFUnpuj1plr7hBMJzJ7LCEwgb9zi4FNzHKgeOUxB+9FXxnGYwA
 m6a9c1H714ZdDyuD5CxPAxGYaEkgGIlbWMPj5Vi6I5gCM9vgERruf/9Hp A=;
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=roger.pau@citrix.com;
 spf=Pass smtp.mailfrom=roger.pau@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 roger.pau@citrix.com) identity=pra; client-ip=162.221.158.21;
 receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa4.hc3370-68.iphmx.com: domain of
 roger.pau@citrix.com designates 162.221.158.21 as permitted
 sender) identity=mailfrom; client-ip=162.221.158.21;
 receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: 1PSuxCKzrY34nugcQ31a2bHwHGgkKLgJjYkARB6wr5KNCTmRWBH6TqIcs6jAMgT87K1PMh9YRW
 D+Igx9Mu2NEqKeFFe1GyjiJPXOAeUWJUh1Sur08K2egOZHz0+mB5GT3jdW639lf6ro3E1Ap2ju
 t2DTtf2A3eu22yKzuoJ9AjZRZmlrcD2AjEcdG4URpACK/phEWaWcol/v7RyyNLUkcPFLN0omUu
 OFSG4gE9Dx/8OlfSZAzSzgR7vyYcB4dbjG/WvtL4mELrBLdOdfFyex9QUgTnYhRliItVZyVIN6
 BS4=
X-SBRS: 2.7
X-MesageID: 4821127
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,415,1559534400"; 
   d="scan'208";a="4821127"
From: Roger Pau Monne <roger.pau@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 22 Aug 2019 08:51:32 +0200
Message-ID: <20190822065132.48200-1-roger.pau@citrix.com>
X-Mailer: git-send-email 2.22.0
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2] print: introduce a format specifier for
 pci_sbdf_t
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Brian Woods <brian.woods@amd.com>, Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIG5ldyBmb3JtYXQgc3BlY2lmaWVyIGlzICclcHAnLCBhbmQgcHJpbnRzIGEgcGNpX3NiZGZf
dCB1c2luZyB0aGUKc2VnOmJ1czpkZXYuZnVuYyBmb3JtYXQuIFJlcGxhY2UgYWxsIFNCREZzIHBy
aW50ZWQgdXNpbmcKJyUwNHg6JTAyeDolMDJ4LiV1JyB0byB1c2UgdGhlIG5ldyBmb3JtYXQgc3Bl
Y2lmaWVyLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpTaWduZWQtb2ZmLWJ5OiBS
b2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4KLS0tCkNoYW5nZXMgc2luY2Ug
djE6CiAtIFVzZSBiYXNlIDggdG8gcHJpbnQgdGhlIGZ1bmN0aW9uIG51bWJlci4KIC0gU29ydCB0
aGUgYWRkaXRpb24gaW4gdGhlIHBvaW50ZXIgZnVuY3Rpb24gYWxwaGFiZXRpY2FsbHkuCi0tLQog
ZG9jcy9taXNjL3ByaW50ay1mb3JtYXRzLnR4dCAgICAgICAgICAgICAgICB8ICAgNSArCiB4ZW4v
YXJjaC94ODYvaHZtL3Ztc2kuYyAgICAgICAgICAgICAgICAgICAgIHwgIDEwICstCiB4ZW4vYXJj
aC94ODYvbXNpLmMgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDM1ICsrKy0tLQogeGVuL2Nv
bW1vbi92c3ByaW50Zi5jICAgICAgICAgICAgICAgICAgICAgICB8ICAxOCArKysrCiB4ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfYWNwaS5jICAgIHwgIDE3ICsrLQogeGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jICAgICB8ICAgNSArLQogeGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL2lvbW11X2RldGVjdC5jICB8ICAgNSArLQogeGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYyAgICB8ICAxMiArLS0KIHhlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMgICAgfCAgIDMgKy0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9wY2lfYW1kX2lvbW11LmMgfCAgMjUgKystLS0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3BjaS5jICAgICAgICAgICAgICAgfCAxMTQgKysrKysrKystLS0tLS0tLS0tLS0KIHhlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmMgICAgICAgICAgfCAgMjUgKysrLS0KIHhlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pbnRyZW1hcC5jICAgICAgfCAgMTEgKy0KIHhlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jICAgICAgICAgfCAgODAgKysrKysrLS0tLS0tLS0K
IHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xdWlya3MuYyAgICAgICAgfCAgMjIgKystLQog
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3V0aWxzLmMgICAgICAgICB8ICAgNiArLQogeGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0cy5jICAgICAgICAgICB8ICAxMyArLS0KIHhlbi9k
cml2ZXJzL3ZwY2kvaGVhZGVyLmMgICAgICAgICAgICAgICAgICAgfCAgMTEgKy0KIHhlbi9kcml2
ZXJzL3ZwY2kvbXNpLmMgICAgICAgICAgICAgICAgICAgICAgfCAgIDYgKy0KIHhlbi9kcml2ZXJz
L3ZwY2kvbXNpeC5jICAgICAgICAgICAgICAgICAgICAgfCAgMjQgKystLS0KIDIwIGZpbGVzIGNo
YW5nZWQsIDE4OSBpbnNlcnRpb25zKCspLCAyNTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
ZG9jcy9taXNjL3ByaW50ay1mb3JtYXRzLnR4dCBiL2RvY3MvbWlzYy9wcmludGstZm9ybWF0cy50
eHQKaW5kZXggMDgwZjQ5OGY2NS4uOGY2NjZmNjk2YSAxMDA2NDQKLS0tIGEvZG9jcy9taXNjL3By
aW50ay1mb3JtYXRzLnR4dAorKysgYi9kb2NzL21pc2MvcHJpbnRrLWZvcm1hdHMudHh0CkBAIC00
OCwzICs0OCw4IEBAIERvbWFpbiBhbmQgdkNQVSBpbmZvcm1hdGlvbjoKICAgICAgICAgICAgICAg
IFRoZSBkb21haW4gcGFydCBhcyBhYm92ZSwgd2l0aCB0aGUgdmNwdV9pZCBwcmludGVkIGluIGRl
Y2ltYWwuCiAgICAgICAgICAgICAgICAgIGUuZy4gIGQwdjEKICAgICAgICAgICAgICAgICAgICAg
ICAgZFtJRExFXXYwCisKK1BDSToKKworICAgICAgICVwcCAgICAgUENJIGRldmljZSBhZGRyZXNz
IGluIFM6QjpELkYgZm9ybWF0IGZyb20gYSBwY2lfc2JkZl90LgorICAgICAgICAgICAgICAgICBl
LmcuICAwMDA0OjAyOjAwLjAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm1zaS5jIGIv
eGVuL2FyY2gveDg2L2h2bS92bXNpLmMKaW5kZXggNjU5N2Q5ZjcxOS4uYzljZDFjMjZjNiAxMDA2
NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2bS92bXNpLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92
bXNpLmMKQEAgLTY5MywxMCArNjkzLDggQEAgc3RhdGljIGludCB2cGNpX21zaV91cGRhdGUoY29u
c3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVpbnQzMl90IGRhdGEsCiAKICAgICAgICAgaWYgKCBy
YyApCiAgICAgICAgIHsKLSAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19FUlIsCi0gICAgICAg
ICAgICAgICAgICAgICAiJTA0eDolMDJ4OiUwMnguJXU6IGZhaWxlZCB0byBiaW5kIFBJUlEgJXU6
ICVkXG4iLAotICAgICAgICAgICAgICAgICAgICAgcGRldi0+c2VnLCBwZGV2LT5idXMsIFBDSV9T
TE9UKHBkZXYtPmRldmZuKSwKLSAgICAgICAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYtPmRl
dmZuKSwgcGlycSArIGksIHJjKTsKKyAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19FUlIsICIl
cHA6IGZhaWxlZCB0byBiaW5kIFBJUlEgJXU6ICVkXG4iLAorICAgICAgICAgICAgICAgICAgICAg
JnBkZXYtPnNiZGYsIHBpcnEgKyBpLCByYyk7CiAgICAgICAgICAgICB3aGlsZSAoIGJpbmQubWFj
aGluZV9pcnEtLSA+IHBpcnEgKQogICAgICAgICAgICAgICAgIHB0X2lycV9kZXN0cm95X2JpbmQo
cGRldi0+ZG9tYWluLCAmYmluZCk7CiAgICAgICAgICAgICByZXR1cm4gcmM7CkBAIC03NTAsOSAr
NzQ4LDcgQEAgc3RhdGljIGludCB2cGNpX21zaV9lbmFibGUoY29uc3Qgc3RydWN0IHBjaV9kZXYg
KnBkZXYsIHVpbnQzMl90IGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZtc2lfaW5mbyk7CiAgICAgaWYgKCByYyApCiAgICAgewotICAgICAgICBnZHByaW50ayhYRU5M
T0dfRVJSLCAiJTA0eDolMDJ4OiUwMnguJXU6IGZhaWxlZCB0byBtYXAgUElSUTogJWRcbiIsCi0g
ICAgICAgICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xPVChwZGV2LT5kZXZm
biksCi0gICAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYtPmRldmZuKSwgcmMpOworICAgICAg
ICBnZHByaW50ayhYRU5MT0dfRVJSLCAiJXBwOiBmYWlsZWQgdG8gbWFwIFBJUlE6ICVkXG4iLCAm
cGRldi0+c2JkZiwgcmMpOwogICAgICAgICByZXR1cm4gcmM7CiAgICAgfQogCmRpZmYgLS1naXQg
YS94ZW4vYXJjaC94ODYvbXNpLmMgYi94ZW4vYXJjaC94ODYvbXNpLmMKaW5kZXggZDYzMDYwMDVh
OS4uMTRkODZmOTE5NSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21zaS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9tc2kuYwpAQCAtNDI4LDggKzQyOCw4IEBAIHN0YXRpYyBib29sIG1zaV9zZXRfbWFz
a19iaXQoc3RydWN0IGlycV9kZXNjICpkZXNjLCBib29sIGhvc3QsIGJvb2wgZ3Vlc3QpCiAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgcGRldi0+bXNpeC0+d2FybmVkID0gZG9taWQ7CiAg
ICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19HX1dBUk5JTkcKLSAgICAgICAgICAgICAgICAg
ICAgICAgImNhbm5vdCBtYXNrIElSUSAlZDogbWFza2luZyBNU0ktWCBvbiBEb20lZCdzICUwNHg6
JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAgICAgICBkZXNjLT5pcnEsIGRvbWlk
LCBzZWcsIGJ1cywgc2xvdCwgZnVuYyk7CisgICAgICAgICAgICAgICAgICAgICAgICJjYW5ub3Qg
bWFzayBJUlEgJWQ6IG1hc2tpbmcgTVNJLVggb24gRG9tJWQncyAlcHBcbiIsCisgICAgICAgICAg
ICAgICAgICAgICAgIGRlc2MtPmlycSwgZG9taWQsICZwZGV2LT5zYmRmKTsKICAgICAgICAgICAg
IH0KICAgICAgICAgfQogICAgICAgICBwZGV2LT5tc2l4LT5ob3N0X21hc2thbGwgPSBtYXNrYWxs
OwpAQCAtOTg3LDExICs5ODcsMTEgQEAgc3RhdGljIGludCBtc2l4X2NhcGFiaWxpdHlfaW5pdChz
dHJ1Y3QgcGNpX2RldiAqZGV2LAogICAgICAgICAgICAgc3RydWN0IGRvbWFpbiAqZCA9IGRldi0+
ZG9tYWluID86IGN1cnJkOwogCiAgICAgICAgICAgICBpZiAoICFpc19oYXJkd2FyZV9kb21haW4o
Y3VycmQpIHx8IGQgIT0gY3VycmQgKQotICAgICAgICAgICAgICAgIHByaW50aygiJXMgdXNlIG9m
IE1TSS1YIG9uICUwNHg6JTAyeDolMDJ4LiV1IGJ5IERvbSVkXG4iLAorICAgICAgICAgICAgICAg
IHByaW50aygiJXMgdXNlIG9mIE1TSS1YIG9uICVwcCBieSAlcGRcbiIsCiAgICAgICAgICAgICAg
ICAgICAgICAgIGlzX2hhcmR3YXJlX2RvbWFpbihjdXJyZCkKICAgICAgICAgICAgICAgICAgICAg
ICAgPyBYRU5MT0dfV0FSTklORyAiUG90ZW50aWFsbHkgaW5zZWN1cmUiCiAgICAgICAgICAgICAg
ICAgICAgICAgIDogWEVOTE9HX0VSUiAiSW5zZWN1cmUiLAotICAgICAgICAgICAgICAgICAgICAg
ICBzZWcsIGJ1cywgc2xvdCwgZnVuYywgZC0+ZG9tYWluX2lkKTsKKyAgICAgICAgICAgICAgICAg
ICAgICAgJmRldi0+c2JkZiwgZCk7CiAgICAgICAgICAgICBpZiAoICFpc19oYXJkd2FyZV9kb21h
aW4oZCkgJiYKICAgICAgICAgICAgICAgICAgLyogQXNzdW1lIGEgZG9tYWluIHdpdGhvdXQgbWVt
b3J5IGhhcyBubyBtYXBwaW5ncyB5ZXQuICovCiAgICAgICAgICAgICAgICAgICghaXNfaGFyZHdh
cmVfZG9tYWluKGN1cnJkKSB8fCBkLT50b3RfcGFnZXMpICkKQEAgLTEwNDYsMTggKzEwNDYsMTUg
QEAgc3RhdGljIGludCBfX3BjaV9lbmFibGVfbXNpKHN0cnVjdCBtc2lfaW5mbyAqbXNpLCBzdHJ1
Y3QgbXNpX2Rlc2MgKipkZXNjKQogICAgIG9sZF9kZXNjID0gZmluZF9tc2lfZW50cnkocGRldiwg
bXNpLT5pcnEsIFBDSV9DQVBfSURfTVNJKTsKICAgICBpZiAoIG9sZF9kZXNjICkKICAgICB7Ci0g
ICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJpcnEgJWQgYWxyZWFkeSBtYXBwZWQgdG8gTVNJIG9u
ICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgbXNpLT5pcnEsIG1zaS0+c2Vn
LCBtc2ktPmJ1cywKLSAgICAgICAgICAgICAgIFBDSV9TTE9UKG1zaS0+ZGV2Zm4pLCBQQ0lfRlVO
Qyhtc2ktPmRldmZuKSk7CisgICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJpcnEgJWQgYWxyZWFk
eSBtYXBwZWQgdG8gTVNJIG9uICVwcFxuIiwKKyAgICAgICAgICAgICAgIG1zaS0+aXJxLCAmcGRl
di0+c2JkZik7CiAgICAgICAgIHJldHVybiAtRUVYSVNUOwogICAgIH0KIAogICAgIG9sZF9kZXNj
ID0gZmluZF9tc2lfZW50cnkocGRldiwgLTEsIFBDSV9DQVBfSURfTVNJWCk7CiAgICAgaWYgKCBv
bGRfZGVzYyApCiAgICAgewotICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIk1TSS1YIGFs
cmVhZHkgaW4gdXNlIG9uICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgbXNp
LT5zZWcsIG1zaS0+YnVzLAotICAgICAgICAgICAgICAgUENJX1NMT1QobXNpLT5kZXZmbiksIFBD
SV9GVU5DKG1zaS0+ZGV2Zm4pKTsKKyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HICJNU0kt
WCBhbHJlYWR5IGluIHVzZSBvbiAlcHBcbiIsICZwZGV2LT5zYmRmKTsKICAgICAgICAgX19wY2lf
ZGlzYWJsZV9tc2l4KG9sZF9kZXNjKTsKICAgICB9CiAKQEAgLTExMTQsMTYgKzExMTEsMTUgQEAg
c3RhdGljIGludCBfX3BjaV9lbmFibGVfbXNpeChzdHJ1Y3QgbXNpX2luZm8gKm1zaSwgc3RydWN0
IG1zaV9kZXNjICoqZGVzYykKICAgICBvbGRfZGVzYyA9IGZpbmRfbXNpX2VudHJ5KHBkZXYsIG1z
aS0+aXJxLCBQQ0lfQ0FQX0lEX01TSVgpOwogICAgIGlmICggb2xkX2Rlc2MgKQogICAgIHsKLSAg
ICAgICAgcHJpbnRrKFhFTkxPR19FUlIgImlycSAlZCBhbHJlYWR5IG1hcHBlZCB0byBNU0ktWCBv
biAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgIG1zaS0+aXJxLCBtc2ktPnNl
ZywgbXNpLT5idXMsIHNsb3QsIGZ1bmMpOworICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiaXJx
ICVkIGFscmVhZHkgbWFwcGVkIHRvIE1TSS1YIG9uICVwcFxuIiwKKyAgICAgICAgICAgICAgIG1z
aS0+aXJxLCAmcGRldi0+c2JkZik7CiAgICAgICAgIHJldHVybiAtRUVYSVNUOwogICAgIH0KIAog
ICAgIG9sZF9kZXNjID0gZmluZF9tc2lfZW50cnkocGRldiwgLTEsIFBDSV9DQVBfSURfTVNJKTsK
ICAgICBpZiAoIG9sZF9kZXNjICkKICAgICB7Ci0gICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklO
RyAiTVNJIGFscmVhZHkgaW4gdXNlIG9uICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAg
ICAgICAgbXNpLT5zZWcsIG1zaS0+YnVzLCBzbG90LCBmdW5jKTsKKyAgICAgICAgcHJpbnRrKFhF
TkxPR19XQVJOSU5HICJNU0kgYWxyZWFkeSBpbiB1c2Ugb24gJXBwXG4iLCAmcGRldi0+c2JkZik7
CiAgICAgICAgIF9fcGNpX2Rpc2FibGVfbXNpKG9sZF9kZXNjKTsKICAgICB9CiAKQEAgLTExNzAs
OSArMTE2Niw4IEBAIHN0YXRpYyB2b2lkIF9fcGNpX2Rpc2FibGVfbXNpeChzdHJ1Y3QgbXNpX2Rl
c2MgKmVudHJ5KQogICAgICAgICB3cml0ZWwoMSwgZW50cnktPm1hc2tfYmFzZSArIFBDSV9NU0lY
X0VOVFJZX1ZFQ1RPUl9DVFJMX09GRlNFVCk7CiAgICAgZWxzZSBpZiAoICEoY29udHJvbCAmIFBD
SV9NU0lYX0ZMQUdTX01BU0tBTEwpICkKICAgICB7Ci0gICAgICAgIHByaW50ayhYRU5MT0dfV0FS
TklORwotICAgICAgICAgICAgICAgImNhbm5vdCBkaXNhYmxlIElSUSAlZDogbWFza2luZyBNU0kt
WCBvbiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgIGVudHJ5LT5pcnEsIHNl
ZywgYnVzLCBzbG90LCBmdW5jKTsKKyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HICJjYW5u
b3QgZGlzYWJsZSBJUlEgJWQ6IG1hc2tpbmcgTVNJLVggb24gJXBwXG4iLAorICAgICAgICAgICAg
ICAgZW50cnktPmlycSwgJmRldi0+c2JkZik7CiAgICAgICAgIG1hc2thbGwgPSB0cnVlOwogICAg
IH0KICAgICBkZXYtPm1zaXgtPmhvc3RfbWFza2FsbCA9IG1hc2thbGw7CkBAIC0xMzQwLDcgKzEz
MzUsNiBAQCBpbnQgcGNpX3Jlc3RvcmVfbXNpX3N0YXRlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQog
ICAgIHN0cnVjdCBtc2lfZGVzYyAqZW50cnksICp0bXA7CiAgICAgc3RydWN0IGlycV9kZXNjICpk
ZXNjOwogICAgIHN0cnVjdCBtc2lfbXNnIG1zZzsKLSAgICB1OCBzbG90ID0gUENJX1NMT1QocGRl
di0+ZGV2Zm4pLCBmdW5jID0gUENJX0ZVTkMocGRldi0+ZGV2Zm4pOwogICAgIHVuc2lnbmVkIGlu
dCB0eXBlID0gMCwgcG9zID0gMDsKICAgICB1MTYgY29udHJvbCA9IDA7CiAKQEAgLTEzNjksOSAr
MTM2Myw4IEBAIGludCBwY2lfcmVzdG9yZV9tc2lfc3RhdGUoc3RydWN0IHBjaV9kZXYgKnBkZXYp
CiAgICAgICAgIGlmIChkZXNjLT5tc2lfZGVzYyAhPSBlbnRyeSkKICAgICAgICAgewogICAgIGJv
Z3VzOgotICAgICAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSLAotICAgICAgICAgICAgICAgICAg
ICAiUmVzdG9yZSBNU0kgZm9yICUwNHg6JTAyeDolMDJ4OiV1IGVudHJ5ICV1IG5vdCBzZXQ/XG4i
LAotICAgICAgICAgICAgICAgICAgICBwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywg
aSk7CisgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIsICJSZXN0b3JlIE1TSSBmb3IgJXBw
IGVudHJ5ICV1IG5vdCBzZXQ/XG4iLAorICAgICAgICAgICAgICAgICAgICAmcGRldi0+c2JkZiwg
aSk7CiAgICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZkZXNjLT5sb2NrLCBmbGFn
cyk7CiAgICAgICAgICAgICBpZiAoIHR5cGUgPT0gUENJX0NBUF9JRF9NU0lYICkKICAgICAgICAg
ICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIG1zaXhfY29udHJvbF9yZWcocG9z
KSwKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vdnNwcmludGYuYyBiL3hlbi9jb21tb24vdnNwcmlu
dGYuYwppbmRleCAxODNkM2VkNGJiLi4xODVhNGJkNTYxIDEwMDY0NAotLS0gYS94ZW4vY29tbW9u
L3ZzcHJpbnRmLmMKKysrIGIveGVuL2NvbW1vbi92c3ByaW50Zi5jCkBAIC0zOTQsNiArMzk0LDIw
IEBAIHN0YXRpYyBjaGFyICpwcmludF92Y3B1KGNoYXIgKnN0ciwgY29uc3QgY2hhciAqZW5kLCBj
b25zdCBzdHJ1Y3QgdmNwdSAqdikKICAgICByZXR1cm4gbnVtYmVyKHN0ciArIDEsIGVuZCwgdi0+
dmNwdV9pZCwgMTAsIC0xLCAtMSwgMCk7CiB9CiAKK3N0YXRpYyBjaGFyICpwcmludF9wY2lfYWRk
cihjaGFyICpzdHIsIGNvbnN0IGNoYXIgKmVuZCwgY29uc3QgcGNpX3NiZGZfdCAqc2JkZikKK3sK
KyAgICBzdHIgPSBudW1iZXIoc3RyLCBlbmQsIHNiZGYtPnNlZywgMTYsIDQsIC0xLCBaRVJPUEFE
KTsKKyAgICBpZiAoIHN0ciA8IGVuZCApCisgICAgICAgICpzdHIgPSAnOic7CisgICAgc3RyID0g
bnVtYmVyKHN0ciArIDEsIGVuZCwgc2JkZi0+YnVzLCAxNiwgMiwgLTEsIFpFUk9QQUQpOworICAg
IGlmICggc3RyIDwgZW5kICkKKyAgICAgICAgKnN0ciA9ICc6JzsKKyAgICBzdHIgPSBudW1iZXIo
c3RyICsgMSwgZW5kLCBzYmRmLT5kZXYsIDE2LCAyLCAtMSwgWkVST1BBRCk7CisgICAgaWYgKCBz
dHIgPCBlbmQgKQorICAgICAgICAqc3RyID0gJy4nOworICAgIHJldHVybiBudW1iZXIoc3RyICsg
MSwgZW5kLCBzYmRmLT5mbiwgOCwgLTEsIC0xLCAwKTsKK30KKwogc3RhdGljIGNoYXIgKnBvaW50
ZXIoY2hhciAqc3RyLCBjb25zdCBjaGFyICplbmQsIGNvbnN0IGNoYXIgKipmbXRfcHRyLAogICAg
ICAgICAgICAgICAgICAgICAgY29uc3Qgdm9pZCAqYXJnLCBpbnQgZmllbGRfd2lkdGgsIGludCBw
cmVjaXNpb24sCiAgICAgICAgICAgICAgICAgICAgICBpbnQgZmxhZ3MpCkBAIC00NzYsNiArNDkw
LDEwIEBAIHN0YXRpYyBjaGFyICpwb2ludGVyKGNoYXIgKnN0ciwgY29uc3QgY2hhciAqZW5kLCBj
b25zdCBjaGFyICoqZm10X3B0ciwKICAgICAgICAgfQogICAgIH0KIAorICAgIGNhc2UgJ3AnOiAv
KiBQQ0kgU0JERi4gKi8KKyAgICAgICAgKysqZm10X3B0cjsKKyAgICAgICAgcmV0dXJuIHByaW50
X3BjaV9hZGRyKHN0ciwgZW5kLCBhcmcpOworCiAgICAgY2FzZSAncyc6IC8qIFN5bWJvbCBuYW1l
IHdpdGggb2Zmc2V0IGFuZCBzaXplIChpZmYgb2Zmc2V0ICE9IDApICovCiAgICAgY2FzZSAnUyc6
IC8qIFN5bWJvbCBuYW1lIHVuY29uZGl0aW9uYWxseSB3aXRoIG9mZnNldCBhbmQgc2l6ZSAqLwog
ICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3Bp
LmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfYWNwaS5jCmluZGV4IDY2OGE5
ODA1ZWYuLjk0N2EyNGQ3MTkgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdV9hY3BpLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2Fj
cGkuYwpAQCAtNzI0LDkgKzcyNCw4IEBAIHN0YXRpYyB1MTYgX19pbml0IHBhcnNlX2l2aGRfZGV2
aWNlX3NwZWNpYWwoCiAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAotICAgIEFNRF9JT01NVV9E
RUJVRygiSVZIRCBTcGVjaWFsOiAlMDR4OiUwMng6JTAyeC4ldSB2YXJpZXR5ICUjeCBoYW5kbGUg
JSN4XG4iLAotICAgICAgICAgICAgICAgICAgICBzZWcsIFBDSV9CVVMoYmRmKSwgUENJX1NMT1Qo
YmRmKSwgUENJX0ZVTkMoYmRmKSwKLSAgICAgICAgICAgICAgICAgICAgc3BlY2lhbC0+dmFyaWV0
eSwgc3BlY2lhbC0+aGFuZGxlKTsKKyAgICBBTURfSU9NTVVfREVCVUcoIklWSEQgU3BlY2lhbDog
JXBwIHZhcmlldHkgJSN4IGhhbmRsZSAlI3hcbiIsCisgICAgICAgICAgICAgICAgICAgICZQQ0lf
U0JERjIoc2VnLCBiZGYpLCBzcGVjaWFsLT52YXJpZXR5LCBzcGVjaWFsLT5oYW5kbGUpOwogICAg
IGFkZF9pdnJzX21hcHBpbmdfZW50cnkoYmRmLCBiZGYsIHNwZWNpYWwtPmhlYWRlci5kYXRhX3Nl
dHRpbmcsIGlvbW11KTsKIAogICAgIHN3aXRjaCAoIHNwZWNpYWwtPnZhcmlldHkgKQpAQCAtNzQ5
LDkgKzc0OCw5IEBAIHN0YXRpYyB1MTYgX19pbml0IHBhcnNlX2l2aGRfZGV2aWNlX3NwZWNpYWwo
CiAgICAgICAgIGlmICggaWR4IDwgbnJfaW9hcGljX3NiZGYgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBBTURfSU9NTVVfREVCVUcoIklWSEQ6IENvbW1hbmQgbGluZSBvdmVycmlkZSBwcmVzZW50
IGZvciBJTy1BUElDICUjeCIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAiKElWUlM6ICUj
eCBkZXZJRCAlMDR4OiUwMng6JTAyeC4ldSlcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW9hcGljX3NiZGZbaWR4XS5pZCwgc3BlY2lhbC0+aGFuZGxlLCBzZWcsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgUENJX0JVUyhiZGYpLCBQQ0lfU0xPVChiZGYpLCBQQ0lfRlVOQyhi
ZGYpKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAiKElWUlM6ICUjeCBkZXZJRCAlcHAp
XG4iLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlvYXBpY19zYmRmW2lkeF0uaWQsIHNw
ZWNpYWwtPmhhbmRsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAmUENJX1NCREYyKHNl
ZywgYmRmKSk7CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgfQogCkBAIC04MjEsOSArODIw
LDkgQEAgc3RhdGljIHUxNiBfX2luaXQgcGFyc2VfaXZoZF9kZXZpY2Vfc3BlY2lhbCgKICAgICAg
ICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIEhQRVRfQ01ETDoKICAgICAgICAgICAgIEFNRF9J
T01NVV9ERUJVRygiSVZIRDogQ29tbWFuZCBsaW5lIG92ZXJyaWRlIHByZXNlbnQgZm9yIEhQRVQg
JSN4ICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAiKElWUlM6ICUjeCBkZXZJRCAlMDR4
OiUwMng6JTAyeC4ldSlcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHBldF9zYmRm
LmlkLCBzcGVjaWFsLT5oYW5kbGUsIHNlZywgUENJX0JVUyhiZGYpLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFBDSV9TTE9UKGJkZiksIFBDSV9GVU5DKGJkZikpOworICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICIoSVZSUzogJSN4IGRldklEICVwcClcbiIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgaHBldF9zYmRmLmlkLCBzcGVjaWFsLT5oYW5kbGUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGMihzZWcsIGJkZikpOwogICAgICAgICAgICAgYnJl
YWs7CiAgICAgICAgIGNhc2UgSFBFVF9OT05FOgogICAgICAgICAgICAgLyogc2V0IGRldmljZSBp
ZCBvZiBocGV0ICovCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfY21kLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKaW5kZXgg
YWYzYTFmYjg2NS4uM2VlYjIxNGJhMyAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2NtZC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9jbWQuYwpAQCAtMjk2LDkgKzI5Niw4IEBAIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2lvdGxiKHU4
IGRldmZuLCBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwKIAogICAgIGlmICggIWlvbW11ICkK
ICAgICB7Ci0gICAgICAgIEFNRF9JT01NVV9ERUJVRygiJXM6IENhbid0IGZpbmQgaW9tbXUgZm9y
ICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgX19mdW5jX18s
IHBkZXYtPnNlZywgcGRldi0+YnVzLAotICAgICAgICAgICAgICAgICAgICAgICAgUENJX1NMT1Qo
cGRldi0+ZGV2Zm4pLCBQQ0lfRlVOQyhwZGV2LT5kZXZmbikpOworICAgICAgICBBTURfSU9NTVVf
REVCVUcoIiVzOiBDYW4ndCBmaW5kIGlvbW11IGZvciAlcHBcbiIsCisgICAgICAgICAgICAgICAg
ICAgICAgICBfX2Z1bmNfXywgJnBkZXYtPnNiZGYpOwogICAgICAgICByZXR1cm47CiAgICAgfQog
CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfZGV0ZWN0LmMg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfZGV0ZWN0LmMKaW5kZXggZDc4MmU2
NmVlZS4uMjFhNTI3NWQ2ZCAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2RldGVjdC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9k
ZXRlY3QuYwpAQCAtMTg1LDkgKzE4NSw4IEBAIGludCBfX2luaXQgYW1kX2lvbW11X2RldGVjdF9v
bmVfYWNwaSgKIAogICAgIHJ0ID0gcGNpX3JvX2RldmljZShpb21tdS0+c2VnLCBidXMsIFBDSV9E
RVZGTihkZXYsIGZ1bmMpKTsKICAgICBpZiAoIHJ0ICkKLSAgICAgICAgcHJpbnRrKFhFTkxPR19F
UlIKLSAgICAgICAgICAgICAgICJDb3VsZCBub3QgbWFyayBjb25maWcgc3BhY2Ugb2YgJTA0eDol
MDJ4OiUwMnguJXUgcmVhZC1vbmx5ICglZClcbiIsCi0gICAgICAgICAgICAgICBpb21tdS0+c2Vn
LCBidXMsIGRldiwgZnVuYywgcnQpOworICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiQ291bGQg
bm90IG1hcmsgY29uZmlnIHNwYWNlIG9mICVwcCByZWFkLW9ubHkgKCVkKVxuIiwKKyAgICAgICAg
ICAgICAgICZQQ0lfU0JERjIoaW9tbXUtPnNlZywgaW9tbXUtPmJkZiksIHJ0KTsKIAogICAgIGxp
c3RfYWRkX3RhaWwoJmlvbW11LT5saXN0LCAmYW1kX2lvbW11X2hlYWQpOwogICAgIHJ0ID0gMDsK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMgYi94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCmluZGV4IGJiNWEzZTU3Yzku
LjYzNGMxNjc5ODIgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9pbml0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYwpA
QCAtNzc4LDkgKzc3OCw4IEBAIHN0YXRpYyBib29sX3QgX19pbml0IHNldF9pb21tdV9pbnRlcnJ1
cHRfaGFuZGxlcihzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKICAgICBwY2lkZXZzX3VubG9jaygp
OwogICAgIGlmICggIWlvbW11LT5tc2kuZGV2ICkKICAgICB7Ci0gICAgICAgIEFNRF9JT01NVV9E
RUJVRygiSU9NTVU6IG5vIHBkZXYgZm9yICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAg
ICAgICAgICAgICAgICAgaW9tbXUtPnNlZywgUENJX0JVUyhpb21tdS0+YmRmKSwKLSAgICAgICAg
ICAgICAgICAgICAgICAgIFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRm
KSk7CisgICAgICAgIEFNRF9JT01NVV9ERUJVRygiSU9NTVU6IG5vIHBkZXYgZm9yICVwcFxuIiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERjIoaW9tbXUtPnNlZywgaW9tbXUtPmJk
ZikpOwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKQEAgLTg2Niw5ICs4NjUsNiBAQCBfX2lu
aXRjYWxsKGlvdl9hZGp1c3RfaXJxX2FmZmluaXRpZXMpOwogc3RhdGljIHZvaWQgYW1kX2lvbW11
X2VycmF0dW1fNzQ2X3dvcmthcm91bmQoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCiB7CiAgICAg
dTMyIHZhbHVlOwotICAgIHU4IGJ1cyA9IFBDSV9CVVMoaW9tbXUtPmJkZik7Ci0gICAgdTggZGV2
ID0gUENJX1NMT1QoaW9tbXUtPmJkZik7Ci0gICAgdTggZnVuYyA9IFBDSV9GVU5DKGlvbW11LT5i
ZGYpOwogCiAgICAgaWYgKCAoYm9vdF9jcHVfZGF0YS54ODYgIT0gMHgxNSkgfHwKICAgICAgICAg
IChib290X2NwdV9kYXRhLng4Nl9tb2RlbCA8IDB4MTApIHx8CkBAIC04ODYsOCArODgyLDggQEAg
c3RhdGljIHZvaWQgYW1kX2lvbW11X2VycmF0dW1fNzQ2X3dvcmthcm91bmQoc3RydWN0IGFtZF9p
b21tdSAqaW9tbXUpCiAKICAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9TQkRGMihpb21tdS0+c2Vn
LCBpb21tdS0+YmRmKSwgMHhmNCwgdmFsdWUgfCAoMSA8PCAyKSk7CiAgICAgcHJpbnRrKFhFTkxP
R19JTkZPCi0gICAgICAgICAgICJBTUQtVmk6IEFwcGx5aW5nIGVycmF0dW0gNzQ2IHdvcmthcm91
bmQgZm9yIElPTU1VIGF0ICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICBpb21tdS0+
c2VnLCBidXMsIGRldiwgZnVuYyk7CisgICAgICAgICAgICJBTUQtVmk6IEFwcGx5aW5nIGVycmF0
dW0gNzQ2IHdvcmthcm91bmQgZm9yIElPTU1VIGF0ICVwcFxuIiwKKyAgICAgICAgICAgJlBDSV9T
QkRGMihpb21tdS0+c2VnLCBpb21tdS0+YmRmKSk7CiAKICAgICAvKiBDbGVhciB0aGUgZW5hYmxl
IHdyaXRpbmcgYml0ICovCiAgICAgcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JERjIoaW9tbXUtPnNl
ZywgaW9tbXUtPmJkZiksIDB4ZjAsIDB4OTApOwpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X2ludHIuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9pbnRyLmMKaW5kZXggMDE2NGNlYWMzYi4uNjg3YTdmYTkyMiAxMDA2NDQKLS0tIGEveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2ludHIuYworKysgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50ci5jCkBAIC02ODUsOCArNjg1LDcgQEAgc3RhdGljIHN0
cnVjdCBhbWRfaW9tbXUgKl9maW5kX2lvbW11X2Zvcl9kZXZpY2UoaW50IHNlZywgaW50IGJkZikK
ICAgICBpZiAoIGlvbW11ICkKICAgICAgICAgcmV0dXJuIGlvbW11OwogCi0gICAgQU1EX0lPTU1V
X0RFQlVHKCJObyBJT01NVSBmb3IgTVNJIGRldiA9ICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAg
ICAgICAgICAgICAgICAgICBzZWcsIFBDSV9CVVMoYmRmKSwgUENJX1NMT1QoYmRmKSwgUENJX0ZV
TkMoYmRmKSk7CisgICAgQU1EX0lPTU1VX0RFQlVHKCJObyBJT01NVSBmb3IgTVNJIGRldiA9ICVw
cFxuIiwgJlBDSV9TQkRGMihzZWcsIGJkZikpOwogICAgIHJldHVybiBFUlJfUFRSKC1FSU5WQUwp
OwogfQogCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9p
b21tdS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwppbmRl
eCA4ZDRhNWZiYzM3Li5hZTIwZTliNmU1IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9wY2lfYW1kX2lvbW11LmMKQEAgLTUyLDkgKzUyLDggQEAgc3RydWN0IGFtZF9pb21tdSAqZmlu
ZF9pb21tdV9mb3JfZGV2aWNlKGludCBzZWcsIGludCBiZGYpCiAgICAgICAgICAgICAgICAgdG1w
LmR0ZV9yZXF1ZXN0b3JfaWQgPSBiZGY7CiAgICAgICAgICAgICBpdnJzX21hcHBpbmdzW2JkZl0g
PSB0bXA7CiAKLSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyAiJTA0eDolMDJ4OiUw
MnguJXUgbm90IGZvdW5kIGluIEFDUEkgdGFibGVzOyIKLSAgICAgICAgICAgICAgICAgICAiIHVz
aW5nIHNhbWUgSU9NTVUgYXMgZnVuY3Rpb24gMFxuIiwKLSAgICAgICAgICAgICAgICAgICBzZWcs
IFBDSV9CVVMoYmRmKSwgUENJX1NMT1QoYmRmKSwgUENJX0ZVTkMoYmRmKSk7CisgICAgICAgICAg
ICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIiVwcCBub3QgZm91bmQgaW4gQUNQSSB0YWJsZXM7Igor
ICAgICAgICAgICAgICAgICAgICIgdXNpbmcgc2FtZSBJT01NVSBhcyBmdW5jdGlvbiAwXG4iLCAm
UENJX1NCREYyKHNlZywgYmRmKSk7CiAKICAgICAgICAgICAgIC8qIHdyaXRlIGlvbW11IGZpZWxk
IGxhc3QgKi8KICAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRmXS5pb21tdSA9IGl2cnNfbWFw
cGluZ3NbYmQwXS5pb21tdTsKQEAgLTMzNyw5ICszMzYsOCBAQCBzdGF0aWMgaW50IHJlYXNzaWdu
X2RldmljZShzdHJ1Y3QgZG9tYWluICpzb3VyY2UsIHN0cnVjdCBkb21haW4gKnRhcmdldCwKICAg
ICAgICAgcmV0dXJuIHJjOwogCiAgICAgYW1kX2lvbW11X3NldHVwX2RvbWFpbl9kZXZpY2UodGFy
Z2V0LCBpb21tdSwgZGV2Zm4sIHBkZXYpOwotICAgIEFNRF9JT01NVV9ERUJVRygiUmUtYXNzaWdu
ICUwNHg6JTAyeDolMDJ4LiV1IGZyb20gZG9tJWQgdG8gZG9tJWRcbiIsCi0gICAgICAgICAgICAg
ICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRl
dmZuKSwKLSAgICAgICAgICAgICAgICAgICAgc291cmNlLT5kb21haW5faWQsIHRhcmdldC0+ZG9t
YWluX2lkKTsKKyAgICBBTURfSU9NTVVfREVCVUcoIlJlLWFzc2lnbiAlcHAgZnJvbSBkb20lZCB0
byBkb20lZFxuIiwKKyAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHNvdXJjZS0+ZG9t
YWluX2lkLCB0YXJnZXQtPmRvbWFpbl9pZCk7CiAKICAgICByZXR1cm4gMDsKIH0KQEAgLTQ0Niwx
NSArNDQ0LDEyIEBAIHN0YXRpYyBpbnQgYW1kX2lvbW11X2FkZF9kZXZpY2UodTggZGV2Zm4sIHN0
cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBpZiAoIHBkZXYtPnR5cGUgPT0gREVWX1RZUEVf
UENJX0hPU1RfQlJJREdFICYmCiAgICAgICAgICAgICAgaXNfaGFyZHdhcmVfZG9tYWluKHBkZXYt
PmRvbWFpbikgKQogICAgICAgICB7Ci0gICAgICAgICAgICBBTURfSU9NTVVfREVCVUcoIlNraXBw
aW5nIGhvc3QgYnJpZGdlICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xPVChkZXZmbiksCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgICAgIEFNRF9J
T01NVV9ERUJVRygiU2tpcHBpbmcgaG9zdCBicmlkZ2UgJXBwXG4iLCAmcGRldi0+c2JkZik7CiAg
ICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgfQogCi0gICAgICAgIEFNRF9JT01NVV9ERUJV
RygiTm8gaW9tbXUgZm9yICUwNHg6JTAyeDolMDJ4LiV1OyBjYW5ub3QgYmUgaGFuZGVkIHRvIGQl
ZFxuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lf
U0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAgICAgICAgICAgICAgICAgIHBk
ZXYtPmRvbWFpbi0+ZG9tYWluX2lkKTsKKyAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJObyBpb21t
dSBmb3IgJXBwOyBjYW5ub3QgYmUgaGFuZGVkIHRvIGQlZFxuIiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICZwZGV2LT5zYmRmLCBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCk7CiAgICAgICAgIHJl
dHVybiAtRU5PREVWOwogICAgIH0KIApAQCAtNDczLDEwICs0NjgsOCBAQCBzdGF0aWMgaW50IGFt
ZF9pb21tdV9yZW1vdmVfZGV2aWNlKHU4IGRldmZuLCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAg
ICBpb21tdSA9IGZpbmRfaW9tbXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7CiAgICAgaWYg
KCAhaW9tbXUgKQogICAgIHsKLSAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJGYWlsIHRvIGZpbmQg
aW9tbXUuIgotICAgICAgICAgICAgICAgICAgICAgICAgIiAlMDR4OiUwMng6JTAyeC4ldSBjYW5u
b3QgYmUgcmVtb3ZlZCBmcm9tIGRvbSVkXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgcGRl
di0+c2VnLCBwZGV2LT5idXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLAotICAg
ICAgICAgICAgICAgICAgICAgICAgcGRldi0+ZG9tYWluLT5kb21haW5faWQpOworICAgICAgICBB
TURfSU9NTVVfREVCVUcoIkZhaWwgdG8gZmluZCBpb21tdS4gJXBwIGNhbm5vdCBiZSByZW1vdmVk
IGZyb20gJXBkXG4iLAorICAgICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHBkZXYt
PmRvbWFpbik7CiAgICAgICAgIHJldHVybiAtRU5PREVWOwogICAgIH0KIApkaWZmIC0tZ2l0IGEv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9w
Y2kuYwppbmRleCA3YzE5NmJhNThiLi5iYjkxNmQ0Mjk0IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9wY2kuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwpA
QCAtMjM4LDExICsyMzgsNyBAQCBzdGF0aWMgdm9pZCBjaGVja19wZGV2KGNvbnN0IHN0cnVjdCBw
Y2lfZGV2ICpwZGV2KQogICAgIChQQ0lfU1RBVFVTX1BBUklUWSB8IFBDSV9TVEFUVVNfU0lHX1RB
UkdFVF9BQk9SVCB8IFwKICAgICAgUENJX1NUQVRVU19SRUNfVEFSR0VUX0FCT1JUIHwgUENJX1NU
QVRVU19SRUNfTUFTVEVSX0FCT1JUIHwgXAogICAgICBQQ0lfU1RBVFVTX1NJR19TWVNURU1fRVJS
T1IgfCBQQ0lfU1RBVFVTX0RFVEVDVEVEX1BBUklUWSkKLSAgICB1MTYgc2VnID0gcGRldi0+c2Vn
OwotICAgIHU4IGJ1cyA9IHBkZXYtPmJ1czsKLSAgICB1OCBkZXYgPSBQQ0lfU0xPVChwZGV2LT5k
ZXZmbik7Ci0gICAgdTggZnVuYyA9IFBDSV9GVU5DKHBkZXYtPmRldmZuKTsKLSAgICB1MTYgdmFs
OworICAgICB1MTYgdmFsOwogCiAgICAgaWYgKCBjb21tYW5kX21hc2sgKQogICAgIHsKQEAgLTI1
Miw4ICsyNDgsOCBAQCBzdGF0aWMgdm9pZCBjaGVja19wZGV2KGNvbnN0IHN0cnVjdCBwY2lfZGV2
ICpwZGV2KQogICAgICAgICB2YWwgPSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX1NU
QVRVUyk7CiAgICAgICAgIGlmICggdmFsICYgUENJX1NUQVRVU19DSEVDSyApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiJTA0eDolMDJ4OiUwMnguJXUgc3RhdHVz
ICUwNHggLT4gJTA0eFxuIiwKLSAgICAgICAgICAgICAgICAgICBzZWcsIGJ1cywgZGV2LCBmdW5j
LCB2YWwsIHZhbCAmIH5QQ0lfU1RBVFVTX0NIRUNLKTsKKyAgICAgICAgICAgIHByaW50ayhYRU5M
T0dfSU5GTyAiJXBwIHN0YXR1cyAlMDR4IC0+ICUwNHhcbiIsCisgICAgICAgICAgICAgICAgICAg
JnBkZXYtPnNiZGYsIHZhbCwgdmFsICYgflBDSV9TVEFUVVNfQ0hFQ0spOwogICAgICAgICAgICAg
cGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBQQ0lfU1RBVFVTLCB2YWwgJiBQQ0lfU1RBVFVT
X0NIRUNLKTsKICAgICAgICAgfQogICAgIH0KQEAgLTI3MCw5ICsyNjYsOCBAQCBzdGF0aWMgdm9p
ZCBjaGVja19wZGV2KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICB2YWwgPSBw
Y2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX1NFQ19TVEFUVVMpOwogICAgICAgICBpZiAo
IHZhbCAmIFBDSV9TVEFUVVNfQ0hFQ0sgKQogICAgICAgICB7Ci0gICAgICAgICAgICBwcmludGso
WEVOTE9HX0lORk8KLSAgICAgICAgICAgICAgICAgICAiJTA0eDolMDJ4OiUwMnguJXUgc2Vjb25k
YXJ5IHN0YXR1cyAlMDR4IC0+ICUwNHhcbiIsCi0gICAgICAgICAgICAgICAgICAgc2VnLCBidXMs
IGRldiwgZnVuYywgdmFsLCB2YWwgJiB+UENJX1NUQVRVU19DSEVDSyk7CisgICAgICAgICAgICBw
cmludGsoWEVOTE9HX0lORk8gIiVwcCBzZWNvbmRhcnkgc3RhdHVzICUwNHggLT4gJTA0eFxuIiwK
KyAgICAgICAgICAgICAgICAgICAmcGRldi0+c2JkZiwgdmFsLCB2YWwgJiB+UENJX1NUQVRVU19D
SEVDSyk7CiAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9TRUNf
U1RBVFVTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwgJiBQQ0lfU1RBVFVTX0NI
RUNLKTsKICAgICAgICAgfQpAQCAtNDExLDggKzQwNiw4IEBAIHN0YXRpYyBzdHJ1Y3QgcGNpX2Rl
diAqYWxsb2NfcGRldihzdHJ1Y3QgcGNpX3NlZyAqcHNlZywgdTggYnVzLCB1OCBkZXZmbikKICAg
ICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIGRlZmF1bHQ6Ci0gICAgICAgICAgICBwcmludGso
WEVOTE9HX1dBUk5JTkcgIiUwNHg6JTAyeDolMDJ4LiV1OiB1bmtub3duIHR5cGUgJWRcbiIsCi0g
ICAgICAgICAgICAgICAgICAgcHNlZy0+bnIsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVO
QyhkZXZmbiksIHBkZXYtPnR5cGUpOworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5H
ICIlcHA6IHVua25vd24gdHlwZSAlZFxuIiwKKyAgICAgICAgICAgICAgICAgICAmcGRldi0+c2Jk
ZiwgcGRldi0+dHlwZSk7CiAgICAgICAgICAgICBicmVhazsKICAgICB9CiAKQEAgLTY0NCw5ICs2
MzksOSBAQCB1bnNpZ25lZCBpbnQgcGNpX3NpemVfbWVtX2JhcihwY2lfc2JkZl90IHNiZGYsIHVu
c2lnbmVkIGludCBwb3MsCiAgICAgICAgIGlmICggZmxhZ3MgJiBQQ0lfQkFSX0xBU1QgKQogICAg
ICAgICB7CiAgICAgICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcKLSAgICAgICAgICAgICAg
ICAgICAiJXNkZXZpY2UgJTA0eDolMDJ4OiUwMnguJXUgd2l0aCA2NC1iaXQgJXNCQVIgaW4gbGFz
dCBzbG90XG4iLAotICAgICAgICAgICAgICAgICAgIChmbGFncyAmIFBDSV9CQVJfVkYpID8gIlNS
LUlPViAiIDogIiIsIHNiZGYuc2VnLCBzYmRmLmJ1cywKLSAgICAgICAgICAgICAgICAgICBzYmRm
LmRldiwgc2JkZi5mbiwgKGZsYWdzICYgUENJX0JBUl9WRikgPyAidmYgIiA6ICIiKTsKKyAgICAg
ICAgICAgICAgICAgICAiJXNkZXZpY2UgJXBwIHdpdGggNjQtYml0ICVzQkFSIGluIGxhc3Qgc2xv
dFxuIiwKKyAgICAgICAgICAgICAgICAgICAoZmxhZ3MgJiBQQ0lfQkFSX1ZGKSA/ICJTUi1JT1Yg
IiA6ICIiLCAmc2JkZiwKKyAgICAgICAgICAgICAgICAgICAoZmxhZ3MgJiBQQ0lfQkFSX1ZGKSA/
ICJ2ZiAiIDogIiIpOwogICAgICAgICAgICAgKnBzaXplID0gMDsKICAgICAgICAgICAgIHJldHVy
biAxOwogICAgICAgICB9CkBAIC03NTAsOSArNzQ1LDggQEAgaW50IHBjaV9hZGRfZGV2aWNlKHUx
NiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4sCiAgICAgICAgICAgICAgICAgICAgICBQQ0lfQkFTRV9B
RERSRVNTX1NQQUNFX0lPICkKICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
IHByaW50ayhYRU5MT0dfV0FSTklORwotICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNSLUlP
ViBkZXZpY2UgJTA0eDolMDJ4OiUwMnguJXUgd2l0aCB2ZiBCQVIldSIKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICIgaW4gSU8gc3BhY2VcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICBzZWcsIGJ1cywgc2xvdCwgZnVuYywgaSk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAi
U1ItSU9WIGRldmljZSAlcHAgd2l0aCB2ZiBCQVIldSBpbiBJTyBzcGFjZVxuIiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICZwZGV2LT5zYmRmLCBpKTsKICAgICAgICAgICAgICAgICAgICAg
Y29udGludWU7CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIHJldCA9IHBjaV9z
aXplX21lbV9iYXIoc2JkZiwgaWR4LCBOVUxMLCAmcGRldi0+dmZfcmxlbltpXSwKQEAgLTc2NCwx
MCArNzU4LDggQEAgaW50IHBjaV9hZGRfZGV2aWNlKHUxNiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4s
CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICAgICAgZWxzZQotICAgICAgICAgICAgcHJp
bnRrKFhFTkxPR19XQVJOSU5HCi0gICAgICAgICAgICAgICAgICAgIlNSLUlPViBkZXZpY2UgJTA0
eDolMDJ4OiUwMnguJXUgaGFzIGl0cyB2aXJ0dWFsIgotICAgICAgICAgICAgICAgICAgICIgZnVu
Y3Rpb25zIGFscmVhZHkgZW5hYmxlZCAoJTA0eClcbiIsCi0gICAgICAgICAgICAgICAgICAgc2Vn
LCBidXMsIHNsb3QsIGZ1bmMsIGN0cmwpOworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJO
SU5HICJTUi1JT1YgZGV2aWNlICVwcCBoYXMgaXRzIHZpcnR1YWwiCisgICAgICAgICAgICAgICAg
ICAgIiBmdW5jdGlvbnMgYWxyZWFkeSBlbmFibGVkICglMDR4KVxuIiwgJnBkZXYtPnNiZGYsIGN0
cmwpOwogICAgIH0KIAogICAgIGNoZWNrX3BkZXYocGRldik7CkBAIC03OTQsMTUgKzc4NiwxNCBA
QCBvdXQ6CiAgICAgcGNpZGV2c191bmxvY2soKTsKICAgICBpZiAoICFyZXQgKQogICAgIHsKLSAg
ICAgICAgcHJpbnRrKFhFTkxPR19ERUJVRyAiUENJIGFkZCAlcyAlMDR4OiUwMng6JTAyeC4ldVxu
IiwgcGRldl90eXBlLAotICAgICAgICAgICAgICAgc2VnLCBidXMsIHNsb3QsIGZ1bmMpOworICAg
ICAgICBwcmludGsoWEVOTE9HX0RFQlVHICJQQ0kgYWRkICVzICVwcFxuIiwgcGRldl90eXBlLCAg
JnBkZXYtPnNiZGYpOwogICAgICAgICB3aGlsZSAoIHBkZXYtPnBoYW50b21fc3RyaWRlICkKICAg
ICAgICAgewogICAgICAgICAgICAgZnVuYyArPSBwZGV2LT5waGFudG9tX3N0cmlkZTsKICAgICAg
ICAgICAgIGlmICggUENJX1NMT1QoZnVuYykgKQogICAgICAgICAgICAgICAgIGJyZWFrOwotICAg
ICAgICAgICAgcHJpbnRrKFhFTkxPR19ERUJVRyAiUENJIHBoYW50b20gJTA0eDolMDJ4OiUwMngu
JXVcbiIsCi0gICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIHNsb3QsIGZ1bmMpOworICAgICAg
ICAgICAgcHJpbnRrKFhFTkxPR19ERUJVRyAiUENJIHBoYW50b20gJXBwXG4iLAorICAgICAgICAg
ICAgICAgICAgICZQQ0lfU0JERihzZWcsIGJ1cywgc2xvdCwgZnVuYykpOwogICAgICAgICB9CiAg
ICAgfQogICAgIHJldHVybiByZXQ7CkBAIC04MzEsOSArODIyLDggQEAgaW50IHBjaV9yZW1vdmVf
ZGV2aWNlKHUxNiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4pCiAgICAgICAgICAgICBpZiAoIHBkZXYt
PmRvbWFpbiApCiAgICAgICAgICAgICAgICAgbGlzdF9kZWwoJnBkZXYtPmRvbWFpbl9saXN0KTsK
ICAgICAgICAgICAgIHBjaV9jbGVhbnVwX21zaShwZGV2KTsKKyAgICAgICAgICAgIHByaW50ayhY
RU5MT0dfREVCVUcgIlBDSSByZW1vdmUgZGV2aWNlICVwcFxuIiwgJnBkZXYtPnNiZGYpOwogICAg
ICAgICAgICAgZnJlZV9wZGV2KHBzZWcsIHBkZXYpOwotICAgICAgICAgICAgcHJpbnRrKFhFTkxP
R19ERUJVRyAiUENJIHJlbW92ZSBkZXZpY2UgJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAg
ICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsK
ICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAKQEAgLTkwNyw5ICs4OTcsOCBAQCBpbnQg
cGNpX3JlbGVhc2VfZGV2aWNlcyhzdHJ1Y3QgZG9tYWluICpkKQogICAgICAgICBidXMgPSBwZGV2
LT5idXM7CiAgICAgICAgIGRldmZuID0gcGRldi0+ZGV2Zm47CiAgICAgICAgIGlmICggZGVhc3Np
Z25fZGV2aWNlKGQsIHBkZXYtPnNlZywgYnVzLCBkZXZmbikgKQotICAgICAgICAgICAgcHJpbnRr
KCJkb21haW4gJWQ6IGRlYXNzaWduIGRldmljZSAoJTA0eDolMDJ4OiUwMnguJXUpIGZhaWxlZCFc
biIsCi0gICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCBwZGV2LT5zZWcsIGJ1cywKLSAg
ICAgICAgICAgICAgICAgICBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7CisgICAg
ICAgICAgICBwcmludGsoImRvbWFpbiAlZDogZGVhc3NpZ24gZGV2aWNlICglcHApIGZhaWxlZCFc
biIsCisgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCAmcGRldi0+c2JkZik7CiAgICAg
fQogICAgIHBjaWRldnNfdW5sb2NrKCk7CiAKQEAgLTEwNTYsOCArMTA0NSw4IEBAIHN0YXRpYyBp
bnQgX19pbml0IF9zY2FuX3BjaV9kZXZpY2VzKHN0cnVjdCBwY2lfc2VnICpwc2VnLCB2b2lkICph
cmcpCiAgICAgICAgICAgICAgICAgcGRldiA9IGFsbG9jX3BkZXYocHNlZywgYnVzLCBQQ0lfREVW
Rk4oZGV2LCBmdW5jKSk7CiAgICAgICAgICAgICAgICAgaWYgKCAhcGRldiApCiAgICAgICAgICAg
ICAgICAgewotICAgICAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIiUwNHg6
JTAyeDolMDJ4LiV1OiBhbGxvY19wZGV2IGZhaWxlZFxuIiwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHBzZWctPm5yLCBidXMsIGRldiwgZnVuYyk7CisgICAgICAgICAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfV0FSTklORyAiJXBwOiBhbGxvY19wZGV2IGZhaWxlZFxuIiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERihwc2VnLT5uciwgYnVzLCBkZXYsIGZ1bmMpKTsK
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07CiAgICAgICAgICAgICAgICAgfQog
CkBAIC0xMDk4LDkgKzEwODcsOCBAQCBzdGF0aWMgdm9pZCBfX2h3ZG9tX2luaXQgc2V0dXBfb25l
X2h3ZG9tX2RldmljZShjb25zdCBzdHJ1Y3Qgc2V0dXBfaHdkb20gKmN0eHQsCiAgICAgICAgIGVy
ciA9IGN0eHQtPmhhbmRsZXIoZGV2Zm4sIHBkZXYpOwogICAgICAgICBpZiAoIGVyciApCiAgICAg
ICAgIHsKLSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJzZXR1cCAlMDR4OiUwMng6JTAy
eC4ldSBmb3IgZCVkIGZhaWxlZCAoJWQpXG4iLAotICAgICAgICAgICAgICAgICAgIHBkZXYtPnNl
ZywgcGRldi0+YnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAg
ICAgICAgICAgICBjdHh0LT5kLT5kb21haW5faWQsIGVycik7CisgICAgICAgICAgICBwcmludGso
WEVOTE9HX0VSUiAic2V0dXAgJXBwIGZvciBkJWQgZmFpbGVkICglZClcbiIsCisgICAgICAgICAg
ICAgICAgICAgJnBkZXYtPnNiZGYsIGN0eHQtPmQtPmRvbWFpbl9pZCwgZXJyKTsKICAgICAgICAg
ICAgIGlmICggZGV2Zm4gPT0gcGRldi0+ZGV2Zm4gKQogICAgICAgICAgICAgICAgIHJldHVybjsK
ICAgICAgICAgfQpAQCAtMTE0MSw5ICsxMTI5LDggQEAgc3RhdGljIGludCBfX2h3ZG9tX2luaXQg
X3NldHVwX2h3ZG9tX3BjaV9kZXZpY2VzKHN0cnVjdCBwY2lfc2VnICpwc2VnLCB2b2lkICphcmcK
ICAgICAgICAgICAgICAgICBwZGV2LT5kb21haW4gPSBkb21feGVuOwogICAgICAgICAgICAgfQog
ICAgICAgICAgICAgZWxzZSBpZiAoIHBkZXYtPmRvbWFpbiAhPSBjdHh0LT5kICkKLSAgICAgICAg
ICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIkRvbSVkIG93bmluZyAlMDR4OiUwMng6JTAy
eC4ldT9cbiIsCi0gICAgICAgICAgICAgICAgICAgICAgIHBkZXYtPmRvbWFpbi0+ZG9tYWluX2lk
LCBwc2VnLT5uciwgYnVzLAotICAgICAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChkZXZmbiks
IFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5H
ICJEb20lZCBvd25pbmcgJXBwP1xuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+ZG9t
YWluLT5kb21haW5faWQsICZwZGV2LT5zYmRmKTsKIAogICAgICAgICAgICAgaWYgKCBpb21tdV92
ZXJib3NlICkKICAgICAgICAgICAgIHsKQEAgLTEyNzksMTAgKzEyNjYsOCBAQCBzdGF0aWMgaW50
IF9kdW1wX3BjaV9kZXZpY2VzKHN0cnVjdCBwY2lfc2VnICpwc2VnLCB2b2lkICphcmcpCiAKICAg
ICBsaXN0X2Zvcl9lYWNoX2VudHJ5ICggcGRldiwgJnBzZWctPmFsbGRldnNfbGlzdCwgYWxsZGV2
c19saXN0ICkKICAgICB7Ci0gICAgICAgIHByaW50aygiJTA0eDolMDJ4OiUwMnguJXUgLSBkb20g
JS0zZCAtIG5vZGUgJS0zZCAtIE1TSXMgPCAiLAotICAgICAgICAgICAgICAgcHNlZy0+bnIsIHBk
ZXYtPmJ1cywKLSAgICAgICAgICAgICAgIFBDSV9TTE9UKHBkZXYtPmRldmZuKSwgUENJX0ZVTkMo
cGRldi0+ZGV2Zm4pLAotICAgICAgICAgICAgICAgcGRldi0+ZG9tYWluID8gcGRldi0+ZG9tYWlu
LT5kb21haW5faWQgOiAtMSwKKyAgICAgICAgcHJpbnRrKCIlcHAgLSBkb20gJS0zZCAtIG5vZGUg
JS0zZCAtIE1TSXMgPCAiLAorICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHBkZXYtPmRvbWFp
biA/IHBkZXYtPmRvbWFpbi0+ZG9tYWluX2lkIDogLTEsCiAgICAgICAgICAgICAgICAocGRldi0+
bm9kZSAhPSBOVU1BX05PX05PREUpID8gcGRldi0+bm9kZSA6IC0xKTsKICAgICAgICAgbGlzdF9m
b3JfZWFjaF9lbnRyeSAoIG1zaSwgJnBkZXYtPm1zaV9saXN0LCBsaXN0ICkKICAgICAgICAgICAg
ICAgIHByaW50aygiJWQgIiwgbXNpLT5pcnEpOwpAQCAtMTM0Nyw4ICsxMzMyLDggQEAgc3RhdGlj
IGludCBpb21tdV9hZGRfZGV2aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICAgICAg
cmV0dXJuIDA7CiAgICAgICAgIHJjID0gaGQtPnBsYXRmb3JtX29wcy0+YWRkX2RldmljZShkZXZm
biwgcGNpX3RvX2RldihwZGV2KSk7CiAgICAgICAgIGlmICggcmMgKQotICAgICAgICAgICAgcHJp
bnRrKFhFTkxPR19XQVJOSU5HICJJT01NVTogYWRkICUwNHg6JTAyeDolMDJ4LiV1IGZhaWxlZCAo
JWQpXG4iLAotICAgICAgICAgICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xP
VChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwgcmMpOworICAgICAgICAgICAgcHJpbnRrKFhFTkxP
R19XQVJOSU5HICJJT01NVTogYWRkICVwcCBmYWlsZWQgKCVkKVxuIiwKKyAgICAgICAgICAgICAg
ICAgICAmcGRldi0+c2JkZiwgcmMpOwogICAgIH0KIH0KIApAQCAtMTM5Miw4ICsxMzc3LDcgQEAg
c3RhdGljIGludCBpb21tdV9yZW1vdmVfZGV2aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAg
ICAgICBpZiAoICFyYyApCiAgICAgICAgICAgICBjb250aW51ZTsKIAotICAgICAgICBwcmludGso
WEVOTE9HX0VSUiAiSU9NTVU6IHJlbW92ZSAlMDR4OiUwMng6JTAyeC4ldSBmYWlsZWQgKCVkKVxu
IiwKLSAgICAgICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xPVChkZXZmbiks
IFBDSV9GVU5DKGRldmZuKSwgcmMpOworICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiSU9NTVU6
IHJlbW92ZSAlcHAgZmFpbGVkICglZClcbiIsICZwZGV2LT5zYmRmLCByYyk7CiAgICAgICAgIHJl
dHVybiByYzsKICAgICB9CiAKQEAgLTE0NjMsOSArMTQ0Nyw4IEBAIHN0YXRpYyBpbnQgYXNzaWdu
X2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCB1MTYgc2VnLCB1OCBidXMsIHU4IGRldmZuLCB1MzIg
ZmxhZykKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICByYyA9IGhkLT5wbGF0Zm9ybV9vcHMt
PmFzc2lnbl9kZXZpY2UoZCwgZGV2Zm4sIHBjaV90b19kZXYocGRldiksIGZsYWcpOwogICAgICAg
ICBpZiAoIHJjICkKLSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfR19XQVJOSU5HICJkJWQ6IGFz
c2lnbiAlMDR4OiUwMng6JTAyeC4ldSBmYWlsZWQgKCVkKVxuIiwKLSAgICAgICAgICAgICAgICAg
ICBkLT5kb21haW5faWQsIHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZu
KSwKLSAgICAgICAgICAgICAgICAgICByYyk7CisgICAgICAgICAgICBwcmludGsoWEVOTE9HX0df
V0FSTklORyAiZCVkOiBhc3NpZ24gJXBwIGZhaWxlZCAoJWQpXG4iLAorICAgICAgICAgICAgICAg
ICAgIGQtPmRvbWFpbl9pZCwgJlBDSV9TQkRGMyhzZWcsIGJ1cywgZGV2Zm4pLCByYyk7CiAgICAg
fQogCiAgZG9uZToKQEAgLTE1MDEsOCArMTQ4NCw4IEBAIGludCBkZWFzc2lnbl9kZXZpY2Uoc3Ry
dWN0IGRvbWFpbiAqZCwgdTE2IHNlZywgdTggYnVzLCB1OCBkZXZmbikKICAgICAgICAgaWYgKCAh
cmV0ICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgIHByaW50ayhYRU5MT0dfR19F
UlIgImQlZDogZGVhc3NpZ24gJTA0eDolMDJ4OiUwMnguJXUgZmFpbGVkICglZClcbiIsCi0gICAg
ICAgICAgICAgICBkLT5kb21haW5faWQsIHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9G
VU5DKGRldmZuKSwgcmV0KTsKKyAgICAgICAgcHJpbnRrKFhFTkxPR19HX0VSUiAiZCVkOiBkZWFz
c2lnbiAlcHAgZmFpbGVkICglZClcbiIsCisgICAgICAgICAgICAgICBkLT5kb21haW5faWQsICZQ
Q0lfU0JERjMoc2VnLCBidXMsIGRldmZuKSwgcmV0KTsKICAgICAgICAgcmV0dXJuIHJldDsKICAg
ICB9CiAKQEAgLTE1MTEsOSArMTQ5NCw4IEBAIGludCBkZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRv
bWFpbiAqZCwgdTE2IHNlZywgdTggYnVzLCB1OCBkZXZmbikKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcGNpX3RvX2RldihwZGV2KSk7CiAgICAgaWYgKCByZXQg
KQogICAgIHsKLSAgICAgICAgZHByaW50ayhYRU5MT0dfR19FUlIsCi0gICAgICAgICAgICAgICAg
ImQlZDogZGVhc3NpZ24gZGV2aWNlICglMDR4OiUwMng6JTAyeC4ldSkgZmFpbGVkXG4iLAotICAg
ICAgICAgICAgICAgIGQtPmRvbWFpbl9pZCwgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJ
X0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgZHByaW50ayhYRU5MT0dfR19FUlIsICJkJWQ6IGRlYXNz
aWduIGRldmljZSAoJXBwKSBmYWlsZWRcbiIsCisgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lk
LCAmcGRldi0+c2JkZik7CiAgICAgICAgIHJldHVybiByZXQ7CiAgICAgfQogCkBAIC0xNTkwLDEw
ICsxNTcyLDggQEAgdm9pZCBpb21tdV9kZXZfaW90bGJfZmx1c2hfdGltZW91dChzdHJ1Y3QgZG9t
YWluICpkLCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICBfcGNpX2hpZGVfZGV2aWNlKHBkZXYp
OwogCiAgICAgaWYgKCAhZC0+aXNfc2h1dHRpbmdfZG93biAmJiBwcmludGtfcmF0ZWxpbWl0KCkg
KQotICAgICAgICBwcmludGsoWEVOTE9HX0VSUgotICAgICAgICAgICAgICAgImRvbSVkOiBBVFMg
ZGV2aWNlICUwNHg6JTAyeDolMDJ4LiV1IGZsdXNoIGZhaWxlZFxuIiwKLSAgICAgICAgICAgICAg
IGQtPmRvbWFpbl9pZCwgcGRldi0+c2VnLCBwZGV2LT5idXMsIFBDSV9TTE9UKHBkZXYtPmRldmZu
KSwKLSAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYtPmRldmZuKSk7CisgICAgICAgIHByaW50
ayhYRU5MT0dfRVJSICJkb20lZDogQVRTIGRldmljZSAlcHAgZmx1c2ggZmFpbGVkXG4iLAorICAg
ICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCAmcGRldi0+c2JkZik7CiAgICAgaWYgKCAhaXNfaGFy
ZHdhcmVfZG9tYWluKGQpICkKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwogCkBAIC0xNjgyLDkg
KzE2NjIsOCBAQCBpbnQgaW9tbXVfZG9fcGNpX2RvbWN0bCgKICAgICAgICAgewogICAgICAgICAg
ICAgaWYgKCByZXQgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIHByaW50ayhYRU5M
T0dfR19JTkZPCi0gICAgICAgICAgICAgICAgICAgICAgICIlMDR4OiUwMng6JTAyeC4ldSBhbHJl
YWR5IGFzc2lnbmVkLCBvciBub24tZXhpc3RlbnRcbiIsCi0gICAgICAgICAgICAgICAgICAgICAg
IHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAg
ICAgICAgcHJpbnRrKFhFTkxPR19HX0lORk8gIiVwcCBhbHJlYWR5IGFzc2lnbmVkLCBvciBub24t
ZXhpc3RlbnRcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERjMoc2VnLCBidXMs
IGRldmZuKSk7CiAgICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTY5Niw5ICsxNjc1LDggQEAgaW50IGlvbW11X2RvX3Bj
aV9kb21jdGwoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAiaCIsIHVfZG9tY3RsKTsKICAgICAgICAgZWxzZSBpZiAoIHJldCApCiAgICAgICAgICAgICBw
cmludGsoWEVOTE9HX0dfRVJSICJYRU5fRE9NQ1RMX2Fzc2lnbl9kZXZpY2U6ICIKLSAgICAgICAg
ICAgICAgICAgICAiYXNzaWduICUwNHg6JTAyeDolMDJ4LiV1IHRvIGRvbSVkIGZhaWxlZCAoJWQp
XG4iLAotICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9G
VU5DKGRldmZuKSwKLSAgICAgICAgICAgICAgICAgICBkLT5kb21haW5faWQsIHJldCk7CisgICAg
ICAgICAgICAgICAgICAgImFzc2lnbiAlcHAgdG8gZG9tJWQgZmFpbGVkICglZClcbiIsCisgICAg
ICAgICAgICAgICAgICAgJlBDSV9TQkRGMyhzZWcsIGJ1cywgZGV2Zm4pLCBkLT5kb21haW5faWQs
IHJldCk7CiAKICAgICAgICAgYnJlYWs7CiAKQEAgLTE3MzIsMTAgKzE3MTAsOCBAQCBpbnQgaW9t
bXVfZG9fcGNpX2RvbWN0bCgKICAgICAgICAgcmV0ID0gZGVhc3NpZ25fZGV2aWNlKGQsIHNlZywg
YnVzLCBkZXZmbik7CiAgICAgICAgIHBjaWRldnNfdW5sb2NrKCk7CiAgICAgICAgIGlmICggcmV0
ICkKLSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfR19FUlIKLSAgICAgICAgICAgICAgICAgICAi
ZGVhc3NpZ24gJTA0eDolMDJ4OiUwMnguJXUgZnJvbSBkb20lZCBmYWlsZWQgKCVkKVxuIiwKLSAg
ICAgICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZm
biksCi0gICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCByZXQpOworICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19HX0VSUiAiZGVhc3NpZ24gJXBwIGZyb20gZG9tJWQgZmFpbGVkICglZClc
biIsCisgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGMyhzZWcsIGJ1cywgZGV2Zm4pLCBkLT5k
b21haW5faWQsIHJldCk7CiAKICAgICAgICAgYnJlYWs7CiAKZGlmZiAtLWdpdCBhL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
ZG1hci5jCmluZGV4IDljOTRkZWFjMGIuLjRjMGQyZjY2NzIgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
dnRkL2RtYXIuYwpAQCAtMzYxLDkgKzM2MSw4IEBAIHN0YXRpYyBpbnQgX19pbml0IGFjcGlfcGFy
c2VfZGV2X3Njb3BlKAogICAgICAgICAgICAgc3ViX2J1cyA9IHBjaV9jb25mX3JlYWQ4KFBDSV9T
QkRGKHNlZywgYnVzLCBwYXRoLT5kZXYsIHBhdGgtPmZuKSwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBQQ0lfU1VCT1JESU5BVEVfQlVTKTsKICAgICAgICAgICAgIGlmICgg
aW9tbXVfdmVyYm9zZSApCi0gICAgICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWAotICAgICAg
ICAgICAgICAgICAgICAgICAiIGJyaWRnZTogJTA0eDolMDJ4OiUwMnguJXUgc3RhcnQ9JXggc2Vj
PSV4IHN1Yj0leFxuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIHBhdGgtPmRl
diwgcGF0aC0+Zm4sCisgICAgICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWCAiIGJyaWRnZTog
JXBwIHN0YXJ0PSV4IHNlYz0leCBzdWI9JXhcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICZQ
Q0lfU0JERihzZWcsIGJ1cywgcGF0aC0+ZGV2LCBwYXRoLT5mbiksCiAgICAgICAgICAgICAgICAg
ICAgICAgIGFjcGlfc2NvcGUtPmJ1cywgc2VjX2J1cywgc3ViX2J1cyk7CiAKICAgICAgICAgICAg
IGRtYXJfc2NvcGVfYWRkX2J1c2VzKHNjb3BlLCBzZWNfYnVzLCBzdWJfYnVzKTsKQEAgLTM3MSw4
ICszNzAsOCBAQCBzdGF0aWMgaW50IF9faW5pdCBhY3BpX3BhcnNlX2Rldl9zY29wZSgKIAogICAg
ICAgICBjYXNlIEFDUElfRE1BUl9TQ09QRV9UWVBFX0hQRVQ6CiAgICAgICAgICAgICBpZiAoIGlv
bW11X3ZlcmJvc2UgKQotICAgICAgICAgICAgICAgIHByaW50ayhWVERQUkVGSVggIiBNU0kgSFBF
VDogJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgIHNlZywgYnVz
LCBwYXRoLT5kZXYsIHBhdGgtPmZuKTsKKyAgICAgICAgICAgICAgICBwcmludGsoVlREUFJFRklY
ICIgTVNJIEhQRVQ6ICVwcFxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGKHNl
ZywgYnVzLCBwYXRoLT5kZXYsIHBhdGgtPmZuKSk7CiAKICAgICAgICAgICAgIGlmICggZHJoZCAp
CiAgICAgICAgICAgICB7CkBAIC0zOTMsOCArMzkyLDggQEAgc3RhdGljIGludCBfX2luaXQgYWNw
aV9wYXJzZV9kZXZfc2NvcGUoCiAKICAgICAgICAgY2FzZSBBQ1BJX0RNQVJfU0NPUEVfVFlQRV9F
TkRQT0lOVDoKICAgICAgICAgICAgIGlmICggaW9tbXVfdmVyYm9zZSApCi0gICAgICAgICAgICAg
ICAgcHJpbnRrKFZURFBSRUZJWCAiIGVuZHBvaW50OiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAg
ICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIHBhdGgtPmRldiwgcGF0aC0+Zm4pOworICAg
ICAgICAgICAgICAgIHByaW50ayhWVERQUkVGSVggIiBlbmRwb2ludDogJXBwXG4iLAorICAgICAg
ICAgICAgICAgICAgICAgICAmUENJX1NCREYoc2VnLCBidXMsIHBhdGgtPmRldiwgcGF0aC0+Zm4p
KTsKIAogICAgICAgICAgICAgaWYgKCBkcmhkICkKICAgICAgICAgICAgIHsKQEAgLTQwNyw4ICs0
MDYsOCBAQCBzdGF0aWMgaW50IF9faW5pdCBhY3BpX3BhcnNlX2Rldl9zY29wZSgKIAogICAgICAg
ICBjYXNlIEFDUElfRE1BUl9TQ09QRV9UWVBFX0lPQVBJQzoKICAgICAgICAgICAgIGlmICggaW9t
bXVfdmVyYm9zZSApCi0gICAgICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWCAiIElPQVBJQzog
JTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBw
YXRoLT5kZXYsIHBhdGgtPmZuKTsKKyAgICAgICAgICAgICAgICBwcmludGsoVlREUFJFRklYICIg
SU9BUElDOiAlcHBcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERihzZWcsIGJ1
cywgcGF0aC0+ZGV2LCBwYXRoLT5mbikpOwogCiAgICAgICAgICAgICBpZiAoIGRyaGQgKQogICAg
ICAgICAgICAgewpAQCAtNTM3LDggKzUzNiw4IEBAIGFjcGlfcGFyc2Vfb25lX2RyaGQoc3RydWN0
IGFjcGlfZG1hcl9oZWFkZXIgKmhlYWRlcikKIAogICAgICAgICAgICAgaWYgKCAhcGNpX2Rldmlj
ZV9kZXRlY3QoZHJoZC0+c2VnbWVudCwgYiwgZCwgZikgKQogICAgICAgICAgICAgICAgIHByaW50
ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAgICAgICAgICAgICAgICAgIiBOb24t
ZXhpc3RlbnQgZGV2aWNlICglMDR4OiUwMng6JTAyeC4ldSkgaW4gdGhpcyBEUkhEJ3Mgc2NvcGUh
XG4iLAotICAgICAgICAgICAgICAgICAgICAgICBkcmhkLT5zZWdtZW50LCBiLCBkLCBmKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgIiBOb24tZXhpc3RlbnQgZGV2aWNlICglcHApIGluIHRoaXMg
RFJIRCdzIHNjb3BlIVxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGKGRyaGQt
PnNlZ21lbnQsIGIsIGQsIGYpKTsKICAgICAgICAgfQogCiAgICAgICAgIGFjcGlfcmVnaXN0ZXJf
ZHJoZF91bml0KGRtYXJ1KTsKQEAgLTU3NCw5ICs1NzMsOSBAQCBzdGF0aWMgaW50IHJlZ2lzdGVy
X29uZV9ybXJyKHN0cnVjdCBhY3BpX3JtcnJfdW5pdCAqcm1ycnUpCiAgICAgICAgIGlmICggcGNp
X2RldmljZV9kZXRlY3Qocm1ycnUtPnNlZ21lbnQsIGIsIGQsIGYpID09IDAgKQogICAgICAgICB7
CiAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWCwKLSAgICAgICAg
ICAgICAgICAgICAgIiBOb24tZXhpc3RlbnQgZGV2aWNlICglMDR4OiUwMng6JTAyeC4ldSkgaXMg
cmVwb3J0ZWQiCisgICAgICAgICAgICAgICAgICAgICIgTm9uLWV4aXN0ZW50IGRldmljZSAoJXBw
KSBpcyByZXBvcnRlZCIKICAgICAgICAgICAgICAgICAgICAgIiBpbiBSTVJSICglIlBSSXg2NCIs
ICUiUFJJeDY0IikncyBzY29wZSFcbiIsCi0gICAgICAgICAgICAgICAgICAgIHJtcnJ1LT5zZWdt
ZW50LCBiLCBkLCBmLAorICAgICAgICAgICAgICAgICAgICAmUENJX1NCREYocm1ycnUtPnNlZ21l
bnQsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICBybXJydS0+YmFzZV9hZGRyZXNzLCBy
bXJydS0+ZW5kX2FkZHJlc3MpOwogICAgICAgICAgICAgaWdub3JlID0gdHJ1ZTsKICAgICAgICAg
fQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2ludHJlbWFwLmMgYi94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW50cmVtYXAuYwppbmRleCBkZjBlOGFjNWNiLi45
Yjg2ZmE4YmI3IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW50cmVt
YXAuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW50cmVtYXAuYwpAQCAtNTI0
LDE2ICs1MjQsMTMgQEAgc3RhdGljIHZvaWQgc2V0X21zaV9zb3VyY2VfaWQoc3RydWN0IHBjaV9k
ZXYgKnBkZXYsIHN0cnVjdCBpcmVtYXBfZW50cnkgKmlyZSkKICAgICAgICAgfQogICAgICAgICBl
bHNlCiAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWCwKLSAgICAg
ICAgICAgICAgICAgICAgImQlZDogbm8gdXBzdHJlYW0gYnJpZGdlIGZvciAlMDR4OiUwMng6JTAy
eC4ldVxuIiwKLSAgICAgICAgICAgICAgICAgICAgcGRldi0+ZG9tYWluLT5kb21haW5faWQsCi0g
ICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRl
dmZuKSk7CisgICAgICAgICAgICAgICAgICAgICJkJWQ6IG5vIHVwc3RyZWFtIGJyaWRnZSBmb3Ig
JXBwXG4iLAorICAgICAgICAgICAgICAgICAgICBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCwgJnBk
ZXYtPnNiZGYpOwogICAgICAgICBicmVhazsKIAogICAgIGRlZmF1bHQ6Ci0gICAgICAgIGRwcmlu
dGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklYLAotICAgICAgICAgICAgICAgICJkJWQ6IHVua25v
d24oJXUpOiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgICBwZGV2LT5kb21h
aW4tPmRvbWFpbl9pZCwgcGRldi0+dHlwZSwKLSAgICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJ
X1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbikpOworICAgICAgICBkcHJpbnRrKFhFTkxPR19X
QVJOSU5HIFZURFBSRUZJWCwgImQlZDogdW5rbm93bigldSk6ICVwcFxuIiwKKyAgICAgICAgICAg
ICAgICBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCwgcGRldi0+dHlwZSwgJnBkZXYtPnNiZGYpOwog
ICAgICAgICBicmVhazsKICAgIH0KIH0KZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKaW5k
ZXggNWQ3MjI3MGM1Yi4uY2ZhZWUxNTAzZiAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11
LmMKQEAgLTg4MiwyNyArODgyLDI0IEBAIHN0YXRpYyBpbnQgaW9tbXVfcGFnZV9mYXVsdF9kb19v
bmUoc3RydWN0IGlvbW11ICppb21tdSwgaW50IHR5cGUsCiAgICAgewogICAgIGNhc2UgRE1BX1JF
TUFQOgogICAgICAgICBwcmludGsoWEVOTE9HX0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAg
ICAgICAgICJETUFSOlslc10gUmVxdWVzdCBkZXZpY2UgWyUwNHg6JTAyeDolMDJ4LiV1XSAiCisg
ICAgICAgICAgICAgICAiRE1BUjpbJXNdIFJlcXVlc3QgZGV2aWNlIFslcHBdICIKICAgICAgICAg
ICAgICAgICJmYXVsdCBhZGRyICUiUFJJeDY0IiwgaW9tbXUgcmVnID0gJXBcbiIsCiAgICAgICAg
ICAgICAgICAodHlwZSA/ICJETUEgUmVhZCIgOiAiRE1BIFdyaXRlIiksCi0gICAgICAgICAgICAg
ICBzZWcsIFBDSV9CVVMoc291cmNlX2lkKSwgUENJX1NMT1Qoc291cmNlX2lkKSwKLSAgICAgICAg
ICAgICAgIFBDSV9GVU5DKHNvdXJjZV9pZCksIGFkZHIsIGlvbW11LT5yZWcpOworICAgICAgICAg
ICAgICAgJlBDSV9TQkRGMihzZWcsIHNvdXJjZV9pZCksIGFkZHIsIGlvbW11LT5yZWcpOwogICAg
ICAgICBraW5kID0gIkRNQVIiOwogICAgICAgICBicmVhazsKICAgICBjYXNlIElOVFJfUkVNQVA6
CiAgICAgICAgIHByaW50ayhYRU5MT0dfR19XQVJOSU5HIFZURFBSRUZJWAotICAgICAgICAgICAg
ICAgIklOVFItUkVNQVA6IFJlcXVlc3QgZGV2aWNlIFslMDR4OiUwMng6JTAyeC4ldV0gIgorICAg
ICAgICAgICAgICAgIklOVFItUkVNQVA6IFJlcXVlc3QgZGV2aWNlIFslcHBdICIKICAgICAgICAg
ICAgICAgICJmYXVsdCBpbmRleCAlIlBSSXg2NCIsIGlvbW11IHJlZyA9ICVwXG4iLAotICAgICAg
ICAgICAgICAgc2VnLCBQQ0lfQlVTKHNvdXJjZV9pZCksIFBDSV9TTE9UKHNvdXJjZV9pZCksCi0g
ICAgICAgICAgICAgICBQQ0lfRlVOQyhzb3VyY2VfaWQpLCBhZGRyID4+IDQ4LCBpb21tdS0+cmVn
KTsKKyAgICAgICAgICAgICAgICZQQ0lfU0JERjIoc2VnLCBzb3VyY2VfaWQpLCBhZGRyID4+IDQ4
LCBpb21tdS0+cmVnKTsKICAgICAgICAga2luZCA9ICJJTlRSLVJFTUFQIjsKICAgICAgICAgYnJl
YWs7CiAgICAgZGVmYXVsdDoKICAgICAgICAgcHJpbnRrKFhFTkxPR19HX1dBUk5JTkcgVlREUFJF
RklYCi0gICAgICAgICAgICAgICAiVU5LTk9XTjogUmVxdWVzdCBkZXZpY2UgWyUwNHg6JTAyeDol
MDJ4LiV1XSAiCisgICAgICAgICAgICAgICAiVU5LTk9XTjogUmVxdWVzdCBkZXZpY2UgWyVwcF0g
IgogICAgICAgICAgICAgICAgImZhdWx0IGFkZHIgJSJQUkl4NjQiLCBpb21tdSByZWcgPSAlcFxu
IiwKLSAgICAgICAgICAgICAgIHNlZywgUENJX0JVUyhzb3VyY2VfaWQpLCBQQ0lfU0xPVChzb3Vy
Y2VfaWQpLAotICAgICAgICAgICAgICAgUENJX0ZVTkMoc291cmNlX2lkKSwgYWRkciwgaW9tbXUt
PnJlZyk7CisgICAgICAgICAgICAgICAmUENJX1NCREYyKHNlZywgc291cmNlX2lkKSwgYWRkciwg
aW9tbXUtPnJlZyk7CiAgICAgICAgIGtpbmQgPSAiVU5LTk9XTiI7CiAgICAgICAgIGJyZWFrOwog
ICAgIH0KQEAgLTEzNTQsMTEgKzEzNTEsOSBAQCBpbnQgZG9tYWluX2NvbnRleHRfbWFwcGluZ19v
bmUoCiAgICAgICAgIHsKICAgICAgICAgICAgIGlmICggcGRldi0+ZG9tYWluICE9IGRvbWFpbiAp
CiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19HX0lORk8gVlRE
UFJFRklYCi0gICAgICAgICAgICAgICAgICAgICAgICJkJWQ6ICUwNHg6JTAyeDolMDJ4LiV1IG93
bmVkIGJ5IGQlZCEiLAotICAgICAgICAgICAgICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwK
LSAgICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZV
TkMoZGV2Zm4pLAotICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5kb21haW4gPyBwZGV2LT5k
b21haW4tPmRvbWFpbl9pZCA6IC0xKTsKKyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0df
SU5GTyBWVERQUkVGSVggIiVwZDogJXBwIG93bmVkIGJ5ICVwZCEiLAorICAgICAgICAgICAgICAg
ICAgICAgICBkb21haW4sICZQQ0lfU0JERjMoc2VnLCBidXMsIGRldmZuKSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgcGRldi0+ZG9tYWluID86IE5VTEwpOwogICAgICAgICAgICAgICAgIHJlcyA9
IC1FSU5WQUw7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KQEAgLTEzNzAsMTggKzEzNjUsMTUg
QEAgaW50IGRvbWFpbl9jb250ZXh0X21hcHBpbmdfb25lKAogICAgICAgICAgICAgaWYgKCBjZG9t
YWluIDwgMCApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19H
X1dBUk5JTkcgVlREUFJFRklYCi0gICAgICAgICAgICAgICAgICAgICAgICJkJWQ6ICUwNHg6JTAy
eDolMDJ4LiV1IG1hcHBlZCwgYnV0IGNhbid0IGZpbmQgb3duZXIhXG4iLAotICAgICAgICAgICAg
ICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwKLSAgICAgICAgICAgICAgICAgICAgICAgc2Vn
LCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgICAgICAg
ICAgICAgICAgIiVwZDogJXBwIG1hcHBlZCwgYnV0IGNhbid0IGZpbmQgb3duZXIhXG4iLAorICAg
ICAgICAgICAgICAgICAgICAgICBkb21haW4sICZQQ0lfU0JERjMoc2VnLCBidXMsIGRldmZuKSk7
CiAgICAgICAgICAgICAgICAgcmVzID0gLUVJTlZBTDsKICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgIGVsc2UgaWYgKCBjZG9tYWluICE9IGRvbWFpbi0+ZG9tYWluX2lkICkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0dfSU5GTyBWVERQUkVGSVgKLSAgICAg
ICAgICAgICAgICAgICAgICAgImQlZDogJTA0eDolMDJ4OiUwMnguJXUgYWxyZWFkeSBtYXBwZWQg
dG8gZCVkISIsCi0gICAgICAgICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLAotICAg
ICAgICAgICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhk
ZXZmbiksCi0gICAgICAgICAgICAgICAgICAgICAgIGNkb21haW4pOworICAgICAgICAgICAgICAg
ICAgICAgICAiJXBkOiAlcHAgYWxyZWFkeSBtYXBwZWQgdG8gZCVkISIsCisgICAgICAgICAgICAg
ICAgICAgICAgIGRvbWFpbiwgJlBDSV9TQkRGMyhzZWcsIGJ1cywgZGV2Zm4pLCBjZG9tYWluKTsK
ICAgICAgICAgICAgICAgICByZXMgPSAtRUlOVkFMOwogICAgICAgICAgICAgfQogICAgICAgICB9
CkBAIC0xNDk2LDkgKzE0ODgsOCBAQCBzdGF0aWMgaW50IGRvbWFpbl9jb250ZXh0X21hcHBpbmco
c3RydWN0IGRvbWFpbiAqZG9tYWluLCB1OCBkZXZmbiwKICAgICB7CiAgICAgY2FzZSBERVZfVFlQ
RV9QQ0lfSE9TVF9CUklER0U6CiAgICAgICAgIGlmICggaW9tbXVfZGVidWcgKQotICAgICAgICAg
ICAgcHJpbnRrKFZURFBSRUZJWCAiZCVkOkhvc3RicmlkZ2U6IHNraXAgJTA0eDolMDJ4OiUwMngu
JXUgbWFwXG4iLAotICAgICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLCBzZWcsIGJ1
cywKLSAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7
CisgICAgICAgICAgICBwcmludGsoVlREUFJFRklYICIlcGQ6SG9zdGJyaWRnZTogc2tpcCAlcHAg
bWFwXG4iLAorICAgICAgICAgICAgICAgICAgIGRvbWFpbiwgJlBDSV9TQkRGMyhzZWcsIGJ1cywg
ZGV2Zm4pKTsKICAgICAgICAgaWYgKCAhaXNfaGFyZHdhcmVfZG9tYWluKGRvbWFpbikgKQogICAg
ICAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAgICAgICAgYnJlYWs7CkBAIC0xNTEwLDkgKzE1MDEs
OCBAQCBzdGF0aWMgaW50IGRvbWFpbl9jb250ZXh0X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZG9t
YWluLCB1OCBkZXZmbiwKIAogICAgIGNhc2UgREVWX1RZUEVfUENJZV9FTkRQT0lOVDoKICAgICAg
ICAgaWYgKCBpb21tdV9kZWJ1ZyApCi0gICAgICAgICAgICBwcmludGsoVlREUFJFRklYICJkJWQ6
UENJZTogbWFwICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAgIGRvbWFp
bi0+ZG9tYWluX2lkLCBzZWcsIGJ1cywKLSAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChkZXZm
biksIFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAgICBwcmludGsoVlREUFJFRklYICIlcGQ6
UENJZTogbWFwICVwcFxuIiwKKyAgICAgICAgICAgICAgICAgICBkb21haW4sICZQQ0lfU0JERjMo
c2VnLCBidXMsIGRldmZuKSk7CiAgICAgICAgIHJldCA9IGRvbWFpbl9jb250ZXh0X21hcHBpbmdf
b25lKGRvbWFpbiwgZHJoZC0+aW9tbXUsIGJ1cywgZGV2Zm4sCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBkZXYpOwogICAgICAgICBpZiAoICFyZXQgJiYgZGV2Zm4g
PT0gcGRldi0+ZGV2Zm4gJiYgYXRzX2RldmljZShwZGV2LCBkcmhkKSA+IDAgKQpAQCAtMTUyMiw5
ICsxNTEyLDggQEAgc3RhdGljIGludCBkb21haW5fY29udGV4dF9tYXBwaW5nKHN0cnVjdCBkb21h
aW4gKmRvbWFpbiwgdTggZGV2Zm4sCiAKICAgICBjYXNlIERFVl9UWVBFX1BDSToKICAgICAgICAg
aWYgKCBpb21tdV9kZWJ1ZyApCi0gICAgICAgICAgICBwcmludGsoVlREUFJFRklYICJkJWQ6UENJ
OiBtYXAgJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgZG9tYWluLT5k
b21haW5faWQsIHNlZywgYnVzLAotICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGRldmZuKSwg
UENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgICAgIHByaW50ayhWVERQUkVGSVggIiVwZDpQQ0k6
IG1hcCAlcHBcbiIsCisgICAgICAgICAgICAgICAgICAgZG9tYWluLCAmUENJX1NCREYzKHNlZywg
YnVzLCBkZXZmbikpOwogCiAgICAgICAgIHJldCA9IGRvbWFpbl9jb250ZXh0X21hcHBpbmdfb25l
KGRvbWFpbiwgZHJoZC0+aW9tbXUsIGJ1cywgZGV2Zm4sCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHBkZXYpOwpAQCAtMTU1MCw5ICsxNTM5LDggQEAgc3RhdGljIGlu
dCBkb21haW5fY29udGV4dF9tYXBwaW5nKHN0cnVjdCBkb21haW4gKmRvbWFpbiwgdTggZGV2Zm4s
CiAgICAgICAgIGJyZWFrOwogCiAgICAgZGVmYXVsdDoKLSAgICAgICAgZHByaW50ayhYRU5MT0df
RVJSIFZURFBSRUZJWCwgImQlZDp1bmtub3duKCV1KTogJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0g
ICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsIHBkZXYtPnR5cGUsCi0gICAgICAgICAg
ICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAg
ICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJWCwgIiVwZDp1bmtub3duKCV1KTogJXBwXG4i
LAorICAgICAgICAgICAgICAgIGRvbWFpbiwgcGRldi0+dHlwZSwgJlBDSV9TQkRGMyhzZWcsIGJ1
cywgZGV2Zm4pKTsKICAgICAgICAgcmV0ID0gLUVJTlZBTDsKICAgICAgICAgYnJlYWs7CiAgICAg
fQpAQCAtMTY0Nyw5ICsxNjM1LDggQEAgc3RhdGljIGludCBkb21haW5fY29udGV4dF91bm1hcChz
dHJ1Y3QgZG9tYWluICpkb21haW4sIHU4IGRldmZuLAogICAgIHsKICAgICBjYXNlIERFVl9UWVBF
X1BDSV9IT1NUX0JSSURHRToKICAgICAgICAgaWYgKCBpb21tdV9kZWJ1ZyApCi0gICAgICAgICAg
ICBwcmludGsoVlREUFJFRklYICJkJWQ6SG9zdGJyaWRnZTogc2tpcCAlMDR4OiUwMng6JTAyeC4l
dSB1bm1hcFxuIiwKLSAgICAgICAgICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwgc2VnLCBi
dXMsCi0gICAgICAgICAgICAgICAgICAgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbikp
OworICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWCAiJXBkOkhvc3RicmlkZ2U6IHNraXAgJXBw
IHVubWFwXG4iLAorICAgICAgICAgICAgICAgICAgIGRvbWFpbiwgJlBDSV9TQkRGMyhzZWcsIGJ1
cywgZGV2Zm4pKTsKICAgICAgICAgaWYgKCAhaXNfaGFyZHdhcmVfZG9tYWluKGRvbWFpbikgKQog
ICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKICAgICAgICAgZ290byBvdXQ7CkBAIC0xNjYxLDkg
KzE2NDgsOCBAQCBzdGF0aWMgaW50IGRvbWFpbl9jb250ZXh0X3VubWFwKHN0cnVjdCBkb21haW4g
KmRvbWFpbiwgdTggZGV2Zm4sCiAKICAgICBjYXNlIERFVl9UWVBFX1BDSWVfRU5EUE9JTlQ6CiAg
ICAgICAgIGlmICggaW9tbXVfZGVidWcgKQotICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWCAi
ZCVkOlBDSWU6IHVubWFwICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAg
IGRvbWFpbi0+ZG9tYWluX2lkLCBzZWcsIGJ1cywKLSAgICAgICAgICAgICAgICAgICBQQ0lfU0xP
VChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAgICBwcmludGsoVlREUFJFRklY
ICIlcGQ6UENJZTogdW5tYXAgJXBwXG4iLAorICAgICAgICAgICAgICAgICAgIGRvbWFpbiwgJlBD
SV9TQkRGMyhzZWcsIGJ1cywgZGV2Zm4pKTsKICAgICAgICAgcmV0ID0gZG9tYWluX2NvbnRleHRf
dW5tYXBfb25lKGRvbWFpbiwgaW9tbXUsIGJ1cywgZGV2Zm4pOwogICAgICAgICBpZiAoICFyZXQg
JiYgZGV2Zm4gPT0gcGRldi0+ZGV2Zm4gJiYgYXRzX2RldmljZShwZGV2LCBkcmhkKSA+IDAgKQog
ICAgICAgICAgICAgZGlzYWJsZV9hdHNfZGV2aWNlKHBkZXYpOwpAQCAtMTY3Miw4ICsxNjU4LDgg
QEAgc3RhdGljIGludCBkb21haW5fY29udGV4dF91bm1hcChzdHJ1Y3QgZG9tYWluICpkb21haW4s
IHU4IGRldmZuLAogCiAgICAgY2FzZSBERVZfVFlQRV9QQ0k6CiAgICAgICAgIGlmICggaW9tbXVf
ZGVidWcgKQotICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWCAiZCVkOlBDSTogdW5tYXAgJTA0
eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQs
IHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAg
ICBwcmludGsoVlREUFJFRklYICIlcGQ6UENJOiB1bm1hcCAlcHBcbiIsCisgICAgICAgICAgICAg
ICAgICAgZG9tYWluLCAmUENJX1NCREYzKHNlZywgYnVzLCBkZXZmbikpOwogICAgICAgICByZXQg
PSBkb21haW5fY29udGV4dF91bm1hcF9vbmUoZG9tYWluLCBpb21tdSwgYnVzLCBkZXZmbik7CiAg
ICAgICAgIGlmICggcmV0ICkKICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTY5OCw5ICsxNjg0LDgg
QEAgc3RhdGljIGludCBkb21haW5fY29udGV4dF91bm1hcChzdHJ1Y3QgZG9tYWluICpkb21haW4s
IHU4IGRldmZuLAogICAgICAgICBicmVhazsKIAogICAgIGRlZmF1bHQ6Ci0gICAgICAgIGRwcmlu
dGsoWEVOTE9HX0VSUiBWVERQUkVGSVgsICJkJWQ6dW5rbm93bigldSk6ICUwNHg6JTAyeDolMDJ4
LiV1XG4iLAotICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLCBwZGV2LT50eXBlLAot
ICAgICAgICAgICAgICAgIHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZu
KSk7CisgICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiBWVERQUkVGSVgsICIlcGQ6dW5rbm93bigl
dSk6ICVwcFxuIiwKKyAgICAgICAgICAgICAgICBkb21haW4sIHBkZXYtPnR5cGUsICZQQ0lfU0JE
RjMoc2VnLCBidXMsIGRldmZuKSk7CiAgICAgICAgIHJldCA9IC1FSU5WQUw7CiAgICAgICAgIGdv
dG8gb3V0OwogICAgIH0KQEAgLTI0OTgsMTIgKzI0ODMsMTEgQEAgc3RhdGljIGludCBpbnRlbF9p
b21tdV9hc3NpZ25fZGV2aWNlKAogICAgICAgICAgICAgYm9vbF90IHJlbGF4ZWQgPSAhIShmbGFn
ICYgWEVOX0RPTUNUTF9ERVZfUkRNX1JFTEFYRUQpOwogCiAgICAgICAgICAgICBwcmludGsoWEVO
TE9HX0dVRVNUICIlcyIgVlREUFJFRklYCi0gICAgICAgICAgICAgICAgICAgIiBJdCdzICVzIHRv
IGFzc2lnbiAlMDR4OiUwMng6JTAyeC4ldSIKLSAgICAgICAgICAgICAgICAgICAiIHdpdGggc2hh
cmVkIFJNUlIgYXQgJSJQUkl4NjQiIGZvciBEb20lZC5cbiIsCisgICAgICAgICAgICAgICAgICAg
IiBJdCdzICVzIHRvIGFzc2lnbiAlcHAiCisgICAgICAgICAgICAgICAgICAgIiB3aXRoIHNoYXJl
ZCBSTVJSIGF0ICUiUFJJeDY0IiBmb3IgJXBkLlxuIiwKICAgICAgICAgICAgICAgICAgICByZWxh
eGVkID8gWEVOTE9HX1dBUk5JTkcgOiBYRU5MT0dfRVJSLAogICAgICAgICAgICAgICAgICAgIHJl
bGF4ZWQgPyAicmlza3kiIDogImRpc2FsbG93ZWQiLAotICAgICAgICAgICAgICAgICAgIHNlZywg
YnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAgICAgICAgICAg
ICBybXJyLT5iYXNlX2FkZHJlc3MsIGQtPmRvbWFpbl9pZCk7CisgICAgICAgICAgICAgICAgICAg
JlBDSV9TQkRGMyhzZWcsIGJ1cywgZGV2Zm4pLCBybXJyLT5iYXNlX2FkZHJlc3MsIGQpOwogICAg
ICAgICAgICAgaWYgKCAhcmVsYXhlZCApCiAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsK
ICAgICAgICAgfQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3F1aXJr
cy5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jCmluZGV4IDE5ZmZhZTY5
YzkuLmNkODg0MmVkNDMgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9x
dWlya3MuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVpcmtzLmMKQEAgLTQx
NSw4ICs0MTUsNiBAQCB2b2lkIHBjaV92dGRfcXVpcmsoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBk
ZXYpCiB7CiAgICAgaW50IHNlZyA9IHBkZXYtPnNlZzsKICAgICBpbnQgYnVzID0gcGRldi0+YnVz
OwotICAgIGludCBkZXYgPSBQQ0lfU0xPVChwZGV2LT5kZXZmbik7Ci0gICAgaW50IGZ1bmMgPSBQ
Q0lfRlVOQyhwZGV2LT5kZXZmbik7CiAgICAgaW50IHBvczsKICAgICBib29sX3QgZmY7CiAgICAg
dTMyIHZhbCwgdmFsMjsKQEAgLTQ0MCw4ICs0MzgsNyBAQCB2b2lkIHBjaV92dGRfcXVpcmsoY29u
c3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgY2FzZSAweDNjMjg6IC8qIFNhbmR5YnJpZGdl
ICovCiAgICAgICAgIHZhbCA9IHBjaV9jb25mX3JlYWQzMihwZGV2LT5zYmRmLCAweDFBQyk7CiAg
ICAgICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2JkZiwgMHgxQUMsIHZhbCB8ICgxIDw8IDMx
KSk7Ci0gICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiTWFza2VkIFZULWQgZXJyb3Igc2lnbmFs
aW5nIG9uICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgc2VnLCBidXMsIGRl
diwgZnVuYyk7CisgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiTWFza2VkIFZULWQgZXJyb3Ig
c2lnbmFsaW5nIG9uICVwcFxuIiwgJnBkZXYtPnNiZGYpOwogICAgICAgICBicmVhazsKIAogICAg
IC8qIFR5bGVyc2J1cmcgKEVQKS9Cb3hib3JvIChNUCkgY2hpcHNldHMgKE5ITS1FUC9FWCwgV1NN
LUVQL0VYKSAqLwpAQCAtNDc2LDggKzQ3Myw3IEBAIHZvaWQgcGNpX3Z0ZF9xdWlyayhjb25zdCBz
dHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAgICAgICAgIGZmID0gcGNpZV9hZXJfZ2V0X2Zpcm13
YXJlX2ZpcnN0KHBkZXYpOwogICAgICAgICBpZiAoICFwb3MgKQogICAgICAgICB7Ci0gICAgICAg
ICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIiUwNHg6JTAyeDolMDJ4LiV1IHdpdGhvdXQgQUVS
IGNhcGFiaWxpdHk/XG4iLAotICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBkZXYsIGZ1bmMp
OworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HICIlcHAgd2l0aG91dCBBRVIgY2Fw
YWJpbGl0eT9cbiIsICZwZGV2LT5zYmRmKTsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9
CiAKQEAgLTUwMCw4ICs0OTYsNyBAQCB2b2lkIHBjaV92dGRfcXVpcmsoY29uc3Qgc3RydWN0IHBj
aV9kZXYgKnBkZXYpCiAgICAgICAgIHZhbCA9IHBjaV9jb25mX3JlYWQzMihwZGV2LT5zYmRmLCAw
eDIwYyk7CiAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2JkZiwgMHgyMGMsIHZhbCB8
ICgxIDw8IDQpKTsKIAotICAgICAgICBwcmludGsoWEVOTE9HX0lORk8gIiVzIFVSIHNpZ25hbGlu
ZyBvbiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgIGFjdGlvbiwgc2VnLCBi
dXMsIGRldiwgZnVuYyk7CisgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiJXMgVVIgc2lnbmFs
aW5nIG9uICVwcFxuIiwgYWN0aW9uLCAmcGRldi0+c2JkZik7CiAgICAgICAgIGJyZWFrOwogCiAg
ICAgY2FzZSAweDAwNDA6IGNhc2UgMHgwMDQ0OiBjYXNlIDB4MDA0ODogLyogTmVoYWxlbS9XZXN0
bWVyZSAqLwpAQCAtNTI2LDE2ICs1MjEsMTUgQEAgdm9pZCBwY2lfdnRkX3F1aXJrKGNvbnN0IHN0
cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIF9fc2V0
X2JpdCgweDFjOCAqIDggKyAyMCwgdmEpOwogICAgICAgICAgICAgICAgIGlvdW5tYXAodmEpOwot
ICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiTWFza2VkIFVSIHNpZ25hbGluZyBv
biAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMs
IGRldiwgZnVuYyk7CisgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19JTkZPICJNYXNrZWQg
VVIgc2lnbmFsaW5nIG9uICVwcFxuIiwgJnBkZXYtPnNiZGYpOwogICAgICAgICAgICAgfQogICAg
ICAgICAgICAgZWxzZQotICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJDb3VsZCBu
b3QgbWFwICUiUFJJcGFkZHIiIGZvciAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAg
ICAgICAgICAgICAgcGEsIHNlZywgYnVzLCBkZXYsIGZ1bmMpOworICAgICAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfRVJSICJDb3VsZCBub3QgbWFwICUiUFJJcGFkZHIiIGZvciAlcHBcbiIsCisg
ICAgICAgICAgICAgICAgICAgICAgIHBhLCAmcGRldi0+c2JkZik7CiAgICAgICAgIH0KICAgICAg
ICAgZWxzZQotICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HICJCb2d1cyBETUlCQVIg
JSMiUFJJeDY0IiBvbiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgICAgICBi
YXIsIHNlZywgYnVzLCBkZXYsIGZ1bmMpOworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJO
SU5HICJCb2d1cyBETUlCQVIgJSMiUFJJeDY0IiBvbiAlcHBcbiIsCisgICAgICAgICAgICAgICAg
ICAgYmFyLCAmcGRldi0+c2JkZik7CiAgICAgICAgIGJyZWFrOwogICAgIH0KIH0KZGlmZiAtLWdp
dCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC91dGlscy5jIGIveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvdnRkL3V0aWxzLmMKaW5kZXggOTRhNmU0ZWVjOS4uNjgzMDRhNjFlOCAxMDA2NDQK
LS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3V0aWxzLmMKKysrIGIveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvdnRkL3V0aWxzLmMKQEAgLTk1LDkgKzk1LDkgQEAgdm9pZCBwcmludF92
dGRfZW50cmllcyhzdHJ1Y3QgaW9tbXUgKmlvbW11LCBpbnQgYnVzLCBpbnQgZGV2Zm4sIHU2NCBn
bWZuKQogICAgIHU2NCAqbCwgdmFsOwogICAgIHUzMiBsX2luZGV4LCBsZXZlbDsKIAotICAgIHBy
aW50aygicHJpbnRfdnRkX2VudHJpZXM6IGlvbW11ICMldSBkZXYgJTA0eDolMDJ4OiUwMnguJXUg
Z21mbiAlIlBSSV9nZm4iXG4iLAotICAgICAgICAgICBpb21tdS0+aW5kZXgsIGlvbW11LT5pbnRl
bC0+ZHJoZC0+c2VnbWVudCwgYnVzLAotICAgICAgICAgICBQQ0lfU0xPVChkZXZmbiksIFBDSV9G
VU5DKGRldmZuKSwgZ21mbik7CisgICAgcHJpbnRrKCJwcmludF92dGRfZW50cmllczogaW9tbXUg
IyV1IGRldiAlcHAgZ21mbiAlIlBSSV9nZm4iXG4iLAorICAgICAgICAgICBpb21tdS0+aW5kZXgs
ICZQQ0lfU0JERjMoaW9tbXUtPmludGVsLT5kcmhkLT5zZWdtZW50LCBidXMsIGRldmZuKSwKKyAg
ICAgICAgICAgZ21mbik7CiAKICAgICBpZiAoIGlvbW11LT5yb290X21hZGRyID09IDAgKQogICAg
IHsKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9hdHMuYyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9hdHMuYwppbmRleCAzZWVhN2Y4OWZjLi5kYzA1ODRiNDIz
IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvYXRzLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0cy5jCkBAIC0zMSw4ICszMSw3IEBAIGludCBlbmFi
bGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgc3RydWN0IGxpc3RfaGVhZCAqYXRz
X2xpc3QpCiAgICAgQlVHX09OKCFwb3MpOwogCiAgICAgaWYgKCBpb21tdV92ZXJib3NlICkKLSAg
ICAgICAgZHByaW50ayhYRU5MT0dfSU5GTywgIiUwNHg6JTAyeDolMDJ4LiV1OiBBVFMgY2FwYWJp
bGl0eSBmb3VuZFxuIiwKLSAgICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4p
LCBQQ0lfRlVOQyhkZXZmbikpOworICAgICAgICBkcHJpbnRrKFhFTkxPR19JTkZPLCAiJXBwOiBB
VFMgY2FwYWJpbGl0eSBmb3VuZFxuIiwgJnBkZXYtPnNiZGYpOwogCiAgICAgdmFsdWUgPSBwY2lf
Y29uZl9yZWFkMTYocGRldi0+c2JkZiwgcG9zICsgQVRTX1JFR19DVEwpOwogICAgIGlmICggdmFs
dWUgJiBBVFNfRU5BQkxFICkKQEAgLTYzLDkgKzYyLDggQEAgaW50IGVuYWJsZV9hdHNfZGV2aWNl
KHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBzdHJ1Y3QgbGlzdF9oZWFkICphdHNfbGlzdCkKICAgICB9
CiAKICAgICBpZiAoIGlvbW11X3ZlcmJvc2UgKQotICAgICAgICBkcHJpbnRrKFhFTkxPR19JTkZP
LCAiJTA0eDolMDJ4OiUwMnguJXU6IEFUUyAlcyBlbmFibGVkXG4iLAotICAgICAgICAgICAgICAg
IHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAgICAg
ICAgICBwb3MgPyAiaXMiIDogIndhcyIpOworICAgICAgICBkcHJpbnRrKFhFTkxPR19JTkZPLCAi
JXBwOiBBVFMgJXMgZW5hYmxlZFxuIiwKKyAgICAgICAgICAgICAgICAmcGRldi0+c2JkZiwgcG9z
ID8gImlzIiA6ICJ3YXMiKTsKIAogICAgIHJldHVybiBwb3M7CiB9CkBAIC03Myw4ICs3MSw2IEBA
IGludCBlbmFibGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgc3RydWN0IGxpc3Rf
aGVhZCAqYXRzX2xpc3QpCiB2b2lkIGRpc2FibGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2RldiAq
cGRldikKIHsKICAgICB1MzIgdmFsdWU7Ci0gICAgdTE2IHNlZyA9IHBkZXYtPnNlZzsKLSAgICB1
OCBidXMgPSBwZGV2LT5idXMsIGRldmZuID0gcGRldi0+ZGV2Zm47CiAKICAgICBCVUdfT04oIXBk
ZXYtPmF0cy5jYXBfcG9zKTsKIApAQCAtODUsNiArODEsNSBAQCB2b2lkIGRpc2FibGVfYXRzX2Rl
dmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICBsaXN0X2RlbCgmcGRldi0+YXRzLmxpc3Qp
OwogCiAgICAgaWYgKCBpb21tdV92ZXJib3NlICkKLSAgICAgICAgZHByaW50ayhYRU5MT0dfSU5G
TywgIiUwNHg6JTAyeDolMDJ4LiV1OiBBVFMgaXMgZGlzYWJsZWRcbiIsCi0gICAgICAgICAgICAg
ICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAg
ZHByaW50ayhYRU5MT0dfSU5GTywgIiVwcDogQVRTIGlzIGRpc2FibGVkXG4iLCAmcGRldi0+c2Jk
Zik7CiB9CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5jIGIveGVuL2RyaXZl
cnMvdnBjaS9oZWFkZXIuYwppbmRleCAzYzc5NGY0ODZkLi5iYTlhMDM2MjAyIDEwMDY0NAotLS0g
YS94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5jCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVy
LmMKQEAgLTM1NSw3ICszNTUsNiBAQCBzdGF0aWMgdm9pZCBiYXJfd3JpdGUoY29uc3Qgc3RydWN0
IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgICAgICAgICAgICAgICAgICAg
dWludDMyX3QgdmFsLCB2b2lkICpkYXRhKQogewogICAgIHN0cnVjdCB2cGNpX2JhciAqYmFyID0g
ZGF0YTsKLSAgICB1aW50OF90IHNsb3QgPSBQQ0lfU0xPVChwZGV2LT5kZXZmbiksIGZ1bmMgPSBQ
Q0lfRlVOQyhwZGV2LT5kZXZmbik7CiAgICAgYm9vbCBoaSA9IGZhbHNlOwogCiAgICAgaWYgKCBi
YXItPnR5cGUgPT0gVlBDSV9CQVJfTUVNNjRfSEkgKQpAQCAtMzcyLDkgKzM3MSw4IEBAIHN0YXRp
YyB2b2lkIGJhcl93cml0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50
IHJlZywKICAgICAgICAgLyogSWYgdGhlIHZhbHVlIHdyaXR0ZW4gaXMgdGhlIGN1cnJlbnQgb25l
IGF2b2lkIHByaW50aW5nIGEgd2FybmluZy4gKi8KICAgICAgICAgaWYgKCB2YWwgIT0gKHVpbnQz
Ml90KShiYXItPmFkZHIgPj4gKGhpID8gMzIgOiAwKSkgKQogICAgICAgICAgICAgZ3ByaW50ayhY
RU5MT0dfV0FSTklORywKLSAgICAgICAgICAgICAgICAgICAgIiUwNHg6JTAyeDolMDJ4LiV1OiBp
Z25vcmVkIEJBUiAlbHUgd3JpdGUgd2l0aCBtZW1vcnkgZGVjb2RpbmcgZW5hYmxlZFxuIiwKLSAg
ICAgICAgICAgICAgICAgICAgcGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsCi0gICAg
ICAgICAgICAgICAgICAgIGJhciAtIHBkZXYtPnZwY2ktPmhlYWRlci5iYXJzICsgaGkpOworICAg
ICAgICAgICAgICAgICAgICAiJXBwOiBpZ25vcmVkIEJBUiAlbHUgd3JpdGUgd2l0aCBtZW1vcnkg
ZGVjb2RpbmcgZW5hYmxlZFxuIiwKKyAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIGJh
ciAtIHBkZXYtPnZwY2ktPmhlYWRlci5iYXJzICsgaGkpOwogICAgICAgICByZXR1cm47CiAgICAg
fQogCkBAIC00MDIsMTUgKzQwMCwxNCBAQCBzdGF0aWMgdm9pZCByb21fd3JpdGUoY29uc3Qgc3Ry
dWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiB7CiAgICAgc3RydWN0IHZwY2lf
aGVhZGVyICpoZWFkZXIgPSAmcGRldi0+dnBjaS0+aGVhZGVyOwogICAgIHN0cnVjdCB2cGNpX2Jh
ciAqcm9tID0gZGF0YTsKLSAgICB1aW50OF90IHNsb3QgPSBQQ0lfU0xPVChwZGV2LT5kZXZmbiks
IGZ1bmMgPSBQQ0lfRlVOQyhwZGV2LT5kZXZmbik7CiAgICAgdWludDE2X3QgY21kID0gcGNpX2Nv
bmZfcmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5EKTsKICAgICBib29sIG5ld19lbmFibGVk
ID0gdmFsICYgUENJX1JPTV9BRERSRVNTX0VOQUJMRTsKIAogICAgIGlmICggKGNtZCAmIFBDSV9D
T01NQU5EX01FTU9SWSkgJiYgaGVhZGVyLT5yb21fZW5hYmxlZCAmJiBuZXdfZW5hYmxlZCApCiAg
ICAgewogICAgICAgICBncHJpbnRrKFhFTkxPR19XQVJOSU5HLAotICAgICAgICAgICAgICAgICIl
MDR4OiUwMng6JTAyeC4ldTogaWdub3JlZCBST00gQkFSIHdyaXRlIHdpdGggbWVtb3J5IGRlY29k
aW5nIGVuYWJsZWRcbiIsCi0gICAgICAgICAgICAgICAgcGRldi0+c2VnLCBwZGV2LT5idXMsIHNs
b3QsIGZ1bmMpOworICAgICAgICAgICAgICAgICIlcHA6IGlnbm9yZWQgUk9NIEJBUiB3cml0ZSB3
aXRoIG1lbW9yeSBkZWNvZGluZyBlbmFibGVkXG4iLAorICAgICAgICAgICAgICAgICZwZGV2LT5z
YmRmKTsKICAgICAgICAgcmV0dXJuOwogICAgIH0KIApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
dnBjaS9tc2kuYyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpLmMKaW5kZXggNWI2NjAyZjNjMi4uNDBl
NGZjYTEzMiAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvdnBjaS9tc2kuYworKysgYi94ZW4vZHJp
dmVycy92cGNpL21zaS5jCkBAIC0yOTAsOCArMjkwLDcgQEAgdm9pZCB2cGNpX2R1bXBfbXNpKHZv
aWQpCiAgICAgICAgICAgICBtc2kgPSBwZGV2LT52cGNpLT5tc2k7CiAgICAgICAgICAgICBpZiAo
IG1zaSAmJiBtc2ktPmVuYWJsZWQgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIHBy
aW50aygiJTA0eDolMDJ4OiUwMnguJXUgTVNJXG4iLCBwZGV2LT5zZWcsIHBkZXYtPmJ1cywKLSAg
ICAgICAgICAgICAgICAgICAgICAgUENJX1NMT1QocGRldi0+ZGV2Zm4pLCBQQ0lfRlVOQyhwZGV2
LT5kZXZmbikpOworICAgICAgICAgICAgICAgIHByaW50aygiJXBwIE1TSVxuIiwgJnBkZXYtPnNi
ZGYpOwogCiAgICAgICAgICAgICAgICAgcHJpbnRrKCIgIGVuYWJsZWQ6ICVkIDY0LWJpdDogJWQi
LAogICAgICAgICAgICAgICAgICAgICAgICBtc2ktPmVuYWJsZWQsIG1zaS0+YWRkcmVzczY0KTsK
QEAgLTMwOCw4ICszMDcsNyBAQCB2b2lkIHZwY2lfZHVtcF9tc2kodm9pZCkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICBpbnQgcmM7CiAKLSAgICAgICAgICAgICAgICBwcmludGsoIiUw
NHg6JTAyeDolMDJ4LiV1IE1TSS1YXG4iLCBwZGV2LT5zZWcsIHBkZXYtPmJ1cywKLSAgICAgICAg
ICAgICAgICAgICAgICAgUENJX1NMT1QocGRldi0+ZGV2Zm4pLCBQQ0lfRlVOQyhwZGV2LT5kZXZm
bikpOworICAgICAgICAgICAgICAgIHByaW50aygiJXBwIE1TSS1YXG4iLCAmcGRldi0+c2JkZik7
CiAKICAgICAgICAgICAgICAgICBwcmludGsoIiAgZW50cmllczogJXUgbWFza2FsbDogJWQgZW5h
YmxlZDogJWRcbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIG1zaXgtPm1heF9lbnRyaWVzLCBt
c2l4LT5tYXNrZWQsIG1zaXgtPmVuYWJsZWQpOwpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBj
aS9tc2l4LmMgYi94ZW4vZHJpdmVycy92cGNpL21zaXguYwppbmRleCAzOGMxZTdlNWRkLi42NGRk
MGE5MjljIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy92cGNpL21zaXguYworKysgYi94ZW4vZHJp
dmVycy92cGNpL21zaXguYwpAQCAtNDIsMTUgKzQyLDE0IEBAIHN0YXRpYyB1aW50MzJfdCBjb250
cm9sX3JlYWQoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiBz
dGF0aWMgaW50IHVwZGF0ZV9lbnRyeShzdHJ1Y3QgdnBjaV9tc2l4X2VudHJ5ICplbnRyeSwKICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1bnNpZ25l
ZCBpbnQgbnIpCiB7Ci0gICAgdWludDhfdCBzbG90ID0gUENJX1NMT1QocGRldi0+ZGV2Zm4pLCBm
dW5jID0gUENJX0ZVTkMocGRldi0+ZGV2Zm4pOwogICAgIGludCByYyA9IHZwY2lfbXNpeF9hcmNo
X2Rpc2FibGVfZW50cnkoZW50cnksIHBkZXYpOwogCiAgICAgLyogSWdub3JlIEVOT0VOVCwgaXQg
bWVhbnMgdGhlIGVudHJ5IHdhc24ndCBzZXR1cC4gKi8KICAgICBpZiAoIHJjICYmIHJjICE9IC1F
Tk9FTlQgKQogICAgIHsKICAgICAgICAgZ3ByaW50ayhYRU5MT0dfV0FSTklORywKLSAgICAgICAg
ICAgICAgICAiJTA0eDolMDJ4OiUwMnguJXU6IHVuYWJsZSB0byBkaXNhYmxlIGVudHJ5ICV1IGZv
ciB1cGRhdGU6ICVkXG4iLAotICAgICAgICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBz
bG90LCBmdW5jLCBuciwgcmMpOworICAgICAgICAgICAgICAgICIlcHA6IHVuYWJsZSB0byBkaXNh
YmxlIGVudHJ5ICV1IGZvciB1cGRhdGU6ICVkXG4iLAorICAgICAgICAgICAgICAgICZwZGV2LT5z
YmRmLCBuciwgcmMpOwogICAgICAgICByZXR1cm4gcmM7CiAgICAgfQogCkBAIC01OSw5ICs1OCw4
IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2VudHJ5KHN0cnVjdCB2cGNpX21zaXhfZW50cnkgKmVudHJ5
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
VlBDSV9NU0lYX1RBQkxFKSk7CiAgICAgaWYgKCByYyApCiAgICAgewotICAgICAgICBncHJpbnRr
KFhFTkxPR19XQVJOSU5HLAotICAgICAgICAgICAgICAgICIlMDR4OiUwMng6JTAyeC4ldTogdW5h
YmxlIHRvIGVuYWJsZSBlbnRyeSAldTogJWRcbiIsCi0gICAgICAgICAgICAgICAgcGRldi0+c2Vn
LCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsIG5yLCByYyk7CisgICAgICAgIGdwcmludGsoWEVOTE9H
X1dBUk5JTkcsICIlcHA6IHVuYWJsZSB0byBlbmFibGUgZW50cnkgJXU6ICVkXG4iLAorICAgICAg
ICAgICAgICAgICZwZGV2LT5zYmRmLCBuciwgcmMpOwogICAgICAgICAvKiBFbnRyeSBpcyBsaWtl
bHkgbm90IHByb3Blcmx5IGNvbmZpZ3VyZWQuICovCiAgICAgICAgIHJldHVybiByYzsKICAgICB9
CkBAIC03Miw3ICs3MCw2IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2VudHJ5KHN0cnVjdCB2cGNpX21z
aXhfZW50cnkgKmVudHJ5LAogc3RhdGljIHZvaWQgY29udHJvbF93cml0ZShjb25zdCBzdHJ1Y3Qg
cGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdWludDMyX3QgdmFsLCB2b2lkICpkYXRhKQogewotICAgIHVpbnQ4X3Qgc2xvdCA9IFBDSV9T
TE9UKHBkZXYtPmRldmZuKSwgZnVuYyA9IFBDSV9GVU5DKHBkZXYtPmRldmZuKTsKICAgICBzdHJ1
Y3QgdnBjaV9tc2l4ICptc2l4ID0gZGF0YTsKICAgICBib29sIG5ld19tYXNrZWQgPSB2YWwgJiBQ
Q0lfTVNJWF9GTEFHU19NQVNLQUxMOwogICAgIGJvb2wgbmV3X2VuYWJsZWQgPSB2YWwgJiBQQ0lf
TVNJWF9GTEFHU19FTkFCTEU7CkBAIC0xMzMsOSArMTMwLDggQEAgc3RhdGljIHZvaWQgY29udHJv
bF93cml0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKICAg
ICAgICAgICAgICAgICAvKiBJZ25vcmUgbm9uLXByZXNlbnQgZW50cnkuICovCiAgICAgICAgICAg
ICAgICAgYnJlYWs7CiAgICAgICAgICAgICBkZWZhdWx0OgotICAgICAgICAgICAgICAgIGdwcmlu
dGsoWEVOTE9HX1dBUk5JTkcsCi0gICAgICAgICAgICAgICAgICAgICAgICAiJTA0eDolMDJ4OiUw
MnguJXU6IHVuYWJsZSB0byBkaXNhYmxlIGVudHJ5ICV1OiAlZFxuIiwKLSAgICAgICAgICAgICAg
ICAgICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLCBpLCByYyk7CisgICAg
ICAgICAgICAgICAgZ3ByaW50ayhYRU5MT0dfV0FSTklORywgIiVwcDogdW5hYmxlIHRvIGRpc2Fi
bGUgZW50cnkgJXU6ICVkXG4iLAorICAgICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYs
IGksIHJjKTsKICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICB9CiAgICAgICAg
IH0KQEAgLTE4MCw4ICsxNzYsNyBAQCBzdGF0aWMgYm9vbCBhY2Nlc3NfYWxsb3dlZChjb25zdCBz
dHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAgICByZXR1cm4g
dHJ1ZTsKIAogICAgIGdwcmludGsoWEVOTE9HX1dBUk5JTkcsCi0gICAgICAgICAgICAiJTA0eDol
MDJ4OiUwMnguJXU6IHVuYWxpZ25lZCBvciBpbnZhbGlkIHNpemUgTVNJLVggdGFibGUgYWNjZXNz
XG4iLAotICAgICAgICAgICAgcGRldi0+c2VnLCBwZGV2LT5idXMsIFBDSV9TTE9UKHBkZXYtPmRl
dmZuKSwgUENJX0ZVTkMocGRldi0+ZGV2Zm4pKTsKKyAgICAgICAgICAgICIlcHA6IHVuYWxpZ25l
ZCBvciBpbnZhbGlkIHNpemUgTVNJLVggdGFibGUgYWNjZXNzXG4iLCAmcGRldi0+c2JkZik7CiAK
ICAgICByZXR1cm4gZmFsc2U7CiB9CkBAIC00MzEsMTAgKzQyNiw5IEBAIGludCB2cGNpX21ha2Vf
bXNpeF9ob2xlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICAgICAgZGVmYXVs
dDoKICAgICAgICAgICAgICAgICBwdXRfZ2ZuKGQsIHN0YXJ0KTsKICAgICAgICAgICAgICAgICBn
cHJpbnRrKFhFTkxPR19XQVJOSU5HLAotICAgICAgICAgICAgICAgICAgICAgICAgIiUwNHg6JTAy
eDolMDJ4LiV1OiBleGlzdGluZyBtYXBwaW5nIChtZm46ICUiIFBSSV9tZm4KKyAgICAgICAgICAg
ICAgICAgICAgICAgICIlcHA6IGV4aXN0aW5nIG1hcHBpbmcgKG1mbjogJSIgUFJJX21mbgogICAg
ICAgICAgICAgICAgICAgICAgICAgInR5cGU6ICVkKSBhdCAlI2x4IGNsb2JiZXJzIE1TSVggTU1J
TyBhcmVhXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+c2VnLCBwZGV2LT5idXMs
IFBDSV9TTE9UKHBkZXYtPmRldmZuKSwKLSAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9GVU5D
KHBkZXYtPmRldmZuKSwgbWZuX3gobWZuKSwgdCwgc3RhcnQpOworICAgICAgICAgICAgICAgICAg
ICAgICAgJnBkZXYtPnNiZGYsIG1mbl94KG1mbiksIHQsIHN0YXJ0KTsKICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVFWElTVDsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIHB1dF9nZm4oZCwg
c3RhcnQpOwotLSAKMi4yMi4wCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJv
amVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hl
bi1kZXZlbA==

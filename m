Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 37D06FC6FD
	for <lists+xen-devel@lfdr.de>; Thu, 14 Nov 2019 14:10:08 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVEr8-0007X5-Pj; Thu, 14 Nov 2019 13:08:14 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=KGQC=ZG=amazon.de=prvs=2141b557b=wipawel@srs-us1.protection.inumbo.net>)
 id 1iVEr7-0007WI-GC
 for xen-devel@lists.xenproject.org; Thu, 14 Nov 2019 13:08:13 +0000
X-Inumbo-ID: ce190c58-06df-11ea-a24b-12813bfff9fa
Received: from smtp-fw-6002.amazon.com (unknown [52.95.49.90])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id ce190c58-06df-11ea-a24b-12813bfff9fa;
 Thu, 14 Nov 2019 13:08:09 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1573736889; x=1605272889;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=ueZYEcaxRSg/bCV70lganUCWGPqkkn8EFV3G4VYyUgA=;
 b=QJuf6FJpOQePtebG9Hi5GNUjFT9O+RK/qMkiLC95IOjaugjq0lKQA8aV
 nqDcWmLNsFIsnbwqIn8IDzlBR3ISUUGUwPSWlzQ8jfeHG+asZPyOdNBrs
 l3Tm3J8OO/tVhSQ6WekS791zLC3ElcjKSg4CQ/n/Oicnub0WbfaldPwE4 U=;
IronPort-SDR: y3bUe/tjuo6nJTDbxDrhFgW1fivDaX9phTQIp508096/oPnGUfxHuWHwkbRJn4UbxTUrtr+Vzw
 cuksZuRhw3bw==
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1d-5dd976cd.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-6002.iad6.amazon.com with ESMTP;
 14 Nov 2019 13:08:09 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-5dd976cd.us-east-1.amazon.com (Postfix) with ESMTPS
 id 344AEA2C0E; Thu, 14 Nov 2019 13:08:05 +0000 (UTC)
Received: from EX13D03EUA001.ant.amazon.com (10.43.165.33) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 14 Nov 2019 13:07:51 +0000
Received: from EX13MTAUWA001.ant.amazon.com (10.43.160.58) by
 EX13D03EUA001.ant.amazon.com (10.43.165.33) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 14 Nov 2019 13:07:50 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.160.118) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Thu, 14 Nov 2019 13:07:46 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 14 Nov 2019 13:06:51 +0000
Message-ID: <20191114130653.51185-11-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20191114130653.51185-1-wipawel@amazon.de>
References: <20191114130653.51185-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v5 10/12] livepatch: Handle arbitrary size names
 with the list operation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>, Andrew
 Cooper <andrew.cooper3@citrix.com>, Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Pawel Wieczorkiewicz <wipawel@amazon.de>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHBheWxvYWRzJyBuYW1lIHN0cmluZ3MgY2FuIGJlIG9mIGFyYml0cmFyeSBzaXplICh0eXBp
Y2FsbHkgc21hbGwKd2l0aCBhbiB1cHBlciBib3VuZCBvZiBYRU5fTElWRVBBVENIX05BTUVfU0la
RSkuCkN1cnJlbnQgaW1wbGVtZW50YXRpb24gb2YgdGhlIGxpc3Qgb3BlcmF0aW9uIGludGVyZmFj
ZSBhbGxvd3MgdG8gY29weQpuYW1lcyBpbiB0aGUgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUgY2h1
bmtzIHJlZ2FyZGxlc3Mgb2YgaXRzIGFjdHVhbApzaXplIGFuZCBlbmZvcmNlcyBzcGFjZSBhbGxv
Y2F0aW9uIHJlcXVpcmVtZW50cyBvbiB1c2VybGFuZCB0b29scy4KClRvIHVuaWZ5IGFuZCBzaW1w
bGlmeSB0aGUgaW50ZXJmYWNlLCBoYW5kbGUgdGhlIG5hbWUgc3RyaW5ncyBvZgphcmJpdHJhcnkg
c2l6ZSBieSBjb3B5aW5nIHRoZW0gaW4gYWRoZXJpbmcgY2h1bmtzIHRvIHRoZSB1c2VybGFuZC4K
SW4gb3JkZXIgdG8gbGV0IHRoZSB1c2VybGFuZCBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgZm9yIHRo
ZSBpbmNvbWluZwpkYXRhIGFkZCBhbiBhdXhpbGlhcnkgaW50ZXJmYWNlIHhjX2xpdmVwYXRjaF9s
aXN0X2dldF9zaXplcygpIHRoYXQKcHJvdmlkZXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxv
YWQgZW50cmllcyBhbmQgdGhlIHRvdGFsIHNpemUgb2YKYWxsIG5hbWUgc3RyaW5ncy4gVGhpcyBp
cyBhY2hpZXZlZCBieSBleHRlbmRpbmcgdGhlIHN5c2N0bCBsaXN0CmludGVyZmFjZSB3aXRoIGFu
IGV4dHJhIGZpZWxkczogbmFtZV90b3RhbF9zaXplLgoKVGhlIHhjX2xpdmVwYXRjaF9saXN0X2dl
dF9zaXplcygpIGlzc3VlcyB0aGUgbGl2ZXBhdGNoIHN5c2N0bCBsaXN0Cm9wZXJhdGlvbiB3aXRo
IHRoZSBuciBmaWVsZCBzZXQgdG8gMC4gSW4gdGhpcyBtb2RlIHRoZSBvcGVyYXRpb24KcmV0dXJu
cyB0aGUgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcyBhbmQgY2FsY3VsYXRlcyB0aGUgdG90YWwg
c2l6ZXMKZm9yIGFsbCBwYXlsb2FkcycgbmFtZXMuCldoZW4gdGhlIHN5c2N0bCBvcGVyYXRpb24g
aXMgaXNzdWVkIHdpdGggYSBub24temVybyBuciBmaWVsZCAoZm9yCmluc3RhbmNlIHdpdGggYSB2
YWx1ZSBvYnRhaW5lZCBlYXJsaWVyIHdpdGggdGhlIHByaW9yIGNhbGwgdG8gdGhlCnhjX2xpdmVw
YXRjaF9saXN0X2dldF9zaXplcygpKSB0aGUgbmV3IGZpZWxkIG5hbWVfdG90YWxfc2l6ZSBwcm92
aWRlcwp0aGUgdG90YWwgc2l6ZSBvZiBhY3R1YWxseSBjb3BpZWQgZGF0YS4KCkV4dGVuZCB0aGUg
bGlieGMgdG8gaGFuZGxlIHRoZSBuYW1lIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycy4KClRo
ZSB4ZW4tbGl2ZXBhdGNoIHRvb2wgaXMgbW9kaWZpZWQgdG8gc3RhcnQgdGhlIGxpc3Qgb3BlcmF0
aW9uIHdpdGggYQpjYWxsIHRvIHRoZSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSB0byBv
YnRhaW4gdGhlIGFjdHVhbCBudW1iZXIKb2YgcGF5bG9hZHMgYXMgd2VsbCBhcyB0aGUgbmVjZXNz
YXJ5IHNwYWNlIGZvciBuYW1lcy4KVGhlIHRvb2wgbm93IGFsd2F5cyByZXF1ZXN0cyB0aGUgYWN0
dWFsIG51bWJlciBvZiBlbnRyaWVzIGFuZCBsZWF2ZXMKdGhlIHByZWVtcHRpb24gaGFuZGxpbmcg
dG8gdGhlIGxpYnhjIHJvdXRpbmUuIFRoZSBsaWJ4YyBzdGlsbCByZXR1cm5zCidkb25lJyBhbmQg
J2xlZnQnIHBhcmFtZXRlcnMgd2l0aCB0aGUgc2FtZSBzZW1hbnRpYyBhbGxvd2luZyB0aGUgdG9v
bAp0byBkZXRlY3QgYW5vbWFsaWVzIGFuZCByZWFjdCB0byB0aGVtLiBBdCB0aGUgbW9tZW50IGl0
IGlzIGV4cGVjdGVkCnRoYXQgdGhlIHRvb2wgcmVjZWl2ZXMgdGhlIGV4YWN0IG51bWJlciBvZiBl
bnRyaWVzIGFzIHJlcXVlc3RlZC4KVGhlIHhlbi1saXZlcGF0Y2ggdG9vbCBoYXMgYmVlbiBhbHNv
IG1vZGlmaWVkIHRvIGhhbmRsZSB0aGUgbmFtZQpiYWNrLXRvLWJhY2sgdHJhbnNmZXJzIGNvcnJl
Y3RseS4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpv
bi5kZT4KUmV2aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9u
LmNvbT4KUmV2aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmll
d2VkLWJ5OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5
OiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+Ci0tLQpDaGFu
Z2VkIHNpbmNlIHY0OgogICogcmVtb3ZlICdwYWQnIGZpZWxkIGZyb20gbGlzdCBzeXNjdGwKCkNo
YW5nZWQgc2luY2UgdjM6CiAgKiB1c2UgdWludDMyX3QgaW5zdGVhZCBvZiB1aW50NjRfdCBhbmQg
b2ZmX3QgZm9yIG5hbWVfdG90YWxfc2l6ZQogICAgYW5kIHJlbGF0ZWQgdmFyaWFibGVzCgpDaGFu
Z2VkIHNpbmNlIHYxOgogICogYWRkZWQgY29ycmVzcG9uZGluZyBkb2N1bWVudGF0aW9uCi0tLQog
ZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MgICAgfCAgMjYgKysrKystLS0tLQogdG9vbHMvbGli
eGMvaW5jbHVkZS94ZW5jdHJsLmggfCAgNDkgKysrKysrKysrKysrKy0tLS0tLQogdG9vbHMvbGli
eGMveGNfbWlzYy5jICAgICAgICAgfCAxMDAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0t
LS0tLS0tLQogdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMgICAgfCAxMTEgKysrKysrKysrKysr
KysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tCiB4ZW4vY29tbW9uL2xpdmVwYXRjaC5jICAg
ICAgICB8ICAzNCArKysrKysrKystLS0tCiB4ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmggICB8
ICAxNiArKystLS0KIDYgZmlsZXMgY2hhbmdlZCwgMjE4IGluc2VydGlvbnMoKyksIDExOCBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYyBiL2RvY3Mv
bWlzYy9saXZlcGF0Y2gucGFuZG9jCmluZGV4IDRmOTIzOGQyMzUuLjQzZDA4OTZhYTggMTAwNjQ0
Ci0tLSBhL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCisrKyBiL2RvY3MvbWlzYy9saXZlcGF0
Y2gucGFuZG9jCkBAIC03MTcsMTcgKzcxNywxOSBAQCBUaGUgY2FsbGVyIHByb3ZpZGVzOgogICog
YGlkeGAgSW5kZXggaXRlcmF0b3IuIFRoZSBpbmRleCBpbnRvIHRoZSBoeXBlcnZpc29yJ3MgcGF5
bG9hZCBjb3VudC4gSXQgaXMKICAgICByZWNvbW1lbmRlZCB0aGF0IG9uIGZpcnN0IGludm9jYXRp
b24gemVybyBiZSB1c2VkIHNvIHRoYXQgYG5yYCAod2hpY2ggdGhlCiAgICAgaHlwZXJ2aXNvciB3
aWxsIHVwZGF0ZSB3aXRoIHRoZSByZW1haW5pbmcgcGF5bG9hZCBjb3VudCkgYmUgcHJvdmlkZWQu
Ci0gICAgQWxzbyB0aGUgaHlwZXJ2aXNvciB3aWxsIHByb3ZpZGUgYHZlcnNpb25gIHdpdGggdGhl
IG1vc3QgY3VycmVudCB2YWx1ZS4KKyAgICBBbHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlk
ZSBgdmVyc2lvbmAgd2l0aCB0aGUgbW9zdCBjdXJyZW50IHZhbHVlIGFuZAorICAgIGNhbGN1bGF0
ZWQgdG90YWwgc2l6ZSBmb3IgYWxsIHBheWxvYWRzJyBuYW1lcy4KICAqIGBucmAgVGhlIG1heCBu
dW1iZXIgb2YgZW50cmllcyB0byBwb3B1bGF0ZS4gQ2FuIGJlIHplcm8gd2hpY2ggd2lsbCByZXN1
bHQKICAgICBpbiB0aGUgaHlwZXJjYWxsIGJlaW5nIGEgcHJvYmluZyBvbmUgYW5kIHJldHVybiB0
aGUgbnVtYmVyIG9mIHBheWxvYWRzCiAgICAgKGFuZCB1cGRhdGUgdGhlIGB2ZXJzaW9uYCkuCi0g
KiBgcGFkYCAtICpNVVNUKiBiZSB6ZXJvLgogICogYHN0YXR1c2AgVmlydHVhbCBhZGRyZXNzIG9m
IHdoZXJlIHRvIHdyaXRlIGBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXNgCiAgICBzdHJ1Y3R1
cmVzLiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4KLSAqIGBuYW1l
YCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgdW5pcXVlIG5hbWUgb2Yg
dGhlIHBheWxvYWQuCi0gICBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhl
bS4gRWFjaCAqTVVTVCogYmUgb2YKLSAgICoqWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUqKiBzaXpl
LiBOb3RlIHRoYXQgKipYRU5fTElWRVBBVENIX05BTUVfU0laRSoqIGluY2x1ZGVzCi0gICB0aGUg
TlVMIHRlcm1pbmF0b3IuCisgKiBgbmFtZWAgLSBWaXJ0dWFsIGFkZHJlc3Mgb2Ygd2hlcmUgdG8g
d3JpdGUgdGhlIHVuaXF1ZSBuYW1lIG9mIHRoZSBwYXlsb2Fkcy4KKyAgIENhbGxlciAqTVVTVCog
YWxsb2NhdGUgZW5vdWdoIHNwYWNlIHRvIGJlIGFibGUgdG8gc3RvcmUgYWxsIHJlY2VpdmVkIGRh
dGEKKyAgIChpLmUuIHRvdGFsIGFsbG9jYXRlZCBzcGFjZSAqTVVTVCogbWF0Y2ggdGhlIGBuYW1l
X3RvdGFsX3NpemVgIHZhbHVlCisgICBwcm92aWRlZCBieSB0aGUgaHlwZXJ2aXNvcikuIEluZGl2
aWR1YWwgcGF5bG9hZCBuYW1lIGNhbm5vdCBiZSBsb25nZXIgdGhhbgorICAgKipYRU5fTElWRVBB
VENIX05BTUVfU0laRSoqIGJ5dGVzLiBOb3RlIHRoYXQgKipYRU5fTElWRVBBVENIX05BTUVfU0la
RSoqCisgICBpbmNsdWRlcyB0aGUgTlVMIHRlcm1pbmF0b3IuCiAgKiBgbGVuYCAtIFZpcnR1YWwg
YWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgbGVuZ3RoIG9mIGVhY2ggdW5pcXVlIG5hbWUK
ICAgIG9mIHRoZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2Yg
dGhlbS4gRWFjaCAqTVVTVCogYmUKICAgIG9mIHNpemVvZih1aW50MzJfdCkgKDQgYnl0ZXMpLgpA
QCAtNzM2LDcgKzczOCw4IEBAIElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBhbiBwb3NpdGl2ZSBu
dW1iZXIsIGl0IGlzIHRoZSBudW1iZXIgKHVwdG8gYG5yYAogcHJvdmlkZWQgdG8gdGhlIGh5cGVy
Y2FsbCkgb2YgdGhlIHBheWxvYWRzIHJldHVybmVkLCBhbG9uZyB3aXRoIGBucmAgdXBkYXRlZAog
d2l0aCB0aGUgbnVtYmVyIG9mIHJlbWFpbmluZyBwYXlsb2FkcywgYHZlcnNpb25gIHVwZGF0ZWQg
KGl0IG1heSBiZSB0aGUgc2FtZQogYWNyb3NzIGh5cGVyY2FsbHMgLSBpZiBpdCB2YXJpZXMgdGhl
IGRhdGEgaXMgc3RhbGUgYW5kIGZ1cnRoZXIgY2FsbHMgY291bGQKLWZhaWwpLiBUaGUgYHN0YXR1
c2AsIGBuYW1lYCwgYW5kIGBsZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4
CitmYWlsKSBhbmQgdGhlIGBuYW1lX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZSBv
ZiB0cmFuc2ZlcnJlZCBkYXRhIGZvcgordGhlIGFycmF5LiBUaGUgYHN0YXR1c2AsIGBuYW1lYCwg
YW5kIGBsZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4CiB2YWx1ZSAoYGlk
eGApIHdpdGggdGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCiAKIElmIHRoZSBoeXBlcmNhbGwg
cmV0dXJucyAtWEVOX0UyQklHIHRoZSBgbnJgIGlzIHRvbyBiaWcgYW5kIHNob3VsZCBiZQpAQCAt
Nzc0LDEyICs3NzcsMTMgQEAgVGhlIHN0cnVjdHVyZSBpcyBhcyBmb2xsb3c6CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG91bGQgYmUgZmlsbGVk
IG91dC4gQ2FuIGJlIHplcm8gdG8gZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBhbW91bnQgb2YgcGF5bG9hZHMgYW5kIHZlcnNpb24uCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPVVQ6IEhvdyBt
YW55IHBheWxvYWRzIGxlZnQuICovCi0gICAgICAgIHVpbnQzMl90IHBhZDsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAvKiBJTjogTXVzdCBiZSB6ZXJvLiAqLworICAgICAgICB1aW50MzJfdCBu
YW1lX3RvdGFsX3NpemU7ICAgICAgICAgICAgICAgLyogT1VUOiBUb3RhbCBzaXplIG9mIGFsbCB0
cmFuc2ZlciBuYW1lcyAqLwogICAgICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHhlbl9saXZlcGF0
Y2hfc3RhdHVzX3QpIHN0YXR1czsgIC8qIE9VVC4gTXVzdCBoYXZlIGVub3VnaAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2UgYWxsb2NhdGUg
Zm9yIG5yIG9mIHRoZW0uICovCi0gICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgaWQ7
ICAgICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIG5hbWVzLiBFYWNoIG1lbWJlcgotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTVVTVCBYRU5fTElWRVBB
VENIX05BTUVfU0laRSBpbiBzaXplLgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCisgICAgICAgIFhFTl9H
VUVTVF9IQU5ETEVfNjQoY2hhcikgbmFtZTsgICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIG5hbWVz
LiBFYWNoIG1lbWJlcgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbWF5IGhhdmUgYW4gYXJiaXRyYXJ5IGxlbmd0aCB1cCB0bworICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWEVOX0xJVkVQQVRDSF9OQU1F
X1NJWkUgYnl0ZXMuIE11c3QgaGF2ZQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbnIgb2YgdGhlbS4gKi8KICAgICAgICAgWEVOX0dVRVNUX0hBTkRM
RV82NCh1aW50MzIpIGxlbjsgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBvZiBuYW1l
J3MuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBN
dXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KICAgICB9OwpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMv
aW5jbHVkZS94ZW5jdHJsLmggYi90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaAppbmRleCBi
MDY3MzhjNDcxLi5mNDkwYTZkZWJjIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy9pbmNsdWRlL3hl
bmN0cmwuaAorKysgYi90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaApAQCAtMjU1OCw3ICsy
NTU4LDI1IEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFjZSAqeGNoLAogICAgICAg
ICAgICAgICAgICAgICAgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCAqc3RhdHVzKTsKIAogLyoKLSAq
IFRoZSBoZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIGdldCBhbiBhcnJheSBvZiB4ZW5fbGl2
ZXBhdGNoX3N0YXR1c190LgorICogR2V0IGEgbnVtYmVyIG9mIGF2YWlsYWJsZSBwYXlsb2FkcyBh
bmQgZ2V0IGFjdHVhbCB0b3RhbCBzaXplIG9mCisgKiB0aGUgcGF5bG9hZHMnIG5hbWUgYXJyYXku
CisgKgorICogVGhpcyBmdW5jdGlvbnMgaXMgdHlwaWNhbGx5IGV4ZWN1dGVkIGZpcnN0IGJlZm9y
ZSB0aGUgeGNfbGl2ZXBhdGNoX2xpc3QoKQorICogdG8gb2J0YWluIHRoZSBzaXplcyBhbmQgY29y
cmVjdGx5IGFsbG9jYXRlIGFsbCBuZWNlc3NhcnkgZGF0YSByZXNvdXJjZXMuCisgKgorICogVGhl
IHJldHVybiB2YWx1ZSBpcyB6ZXJvIGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nlc3Nm
dWxseS4KKyAqCisgKiBJZiB0aGVyZSB3YXMgYW4gZXJyb3IgcGVyZm9ybWluZyB0aGUgc3lzY3Rs
IG9wZXJhdGlvbiwgdGhlIHJldHVybiB2YWx1ZQorICogd2lsbCBjb250YWluIHRoZSBoeXBlcmNh
bGwgZXJyb3IgY29kZSB2YWx1ZS4KKyAqLworaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXpl
cyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludDMyX3QgKm5hbWVfdG90YWxfc2l6ZSk7CisKKy8qCisgKiBUaGUg
aGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBnZXQgYW4gYXJyYXkgb2YgdGhlIGZvbGxvd2lu
ZyBvYmplY3RzOgorICogICAtIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3Q6IHN0YXRlcyBhbmQgcmV0
dXJuIGNvZGVzIG9mIHBheWxvYWRzCisgKiAgIC0gbmFtZTogbmFtZXMgb2YgcGF5bG9hZHMKKyAq
ICAgLSBsZW46IGxlbmd0aHMgb2YgY29ycmVzcG9uZGluZyBwYXlsb2FkcycgbmFtZXMKICAqCiAg
KiBIb3dldmVyIGl0IGlzIGNvbXBsZXggYmVjYXVzZSBpdCBoYXMgdG8gZGVhbCB3aXRoIHRoZSBo
eXBlcnZpc29yCiAgKiByZXR1cm5pbmcgc29tZSBvZiB0aGUgcmVxdWVzdGVkIGRhdGEgb3IgZGF0
YSBiZWluZyBzdGFsZQpAQCAtMjU2OSwyMSArMjU4NywyMCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dl
dCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqICdsZWZ0JyBhcmUgYWxzbyB1cGRhdGVkIHdpdGggdGhl
IG51bWJlciBvZiBlbnRyaWVzIGZpbGxlZCBvdXQKICAqIGFuZCByZXNwZWN0aXZlbHkgdGhlIG51
bWJlciBvZiBlbnRyaWVzIGxlZnQgdG8gZ2V0IGZyb20gaHlwZXJ2aXNvci4KICAqCi0gKiBJdCBp
cyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlvbiB3aWxsIHRha2UgdGhl
Ci0gKiAnbGVmdCcgYW5kIHVzZSB0aGUgdmFsdWUgZm9yICdzdGFydCcuIFRoaXMgd2F5IHdlIGhh
dmUgYW4KLSAqIGN1cnNvciBpbiB0aGUgYXJyYXkuIE5vdGUgdGhhdCB0aGUgJ2luZm8nLCduYW1l
JywgYW5kICdsZW4nIHdpbGwKLSAqIGJlIHVwZGF0ZWQgYXQgdGhlIHN1YnNlcXVlbnQgY2FsbHMu
CisgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlvbiB3aWxs
IGZpcnN0IGlzc3VlIHRoZQorICogeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKCkgaW4gb3Jk
ZXIgdG8gb2J0YWluIHRvdGFsIHNpemVzIG9mIG5hbWVzCisgKiBhcyB3ZWxsIGFzIHRoZSBjdXJy
ZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJpZXMuCisgKiBUaGUgdG90YWwgc2l6ZXMgYXJlIHJl
cXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhlICduYW1lX3RvdGFsX3NpemUnCisgKiBwYXJhbWV0
ZXIuCiAgKgotICogVGhlICdtYXgnIGlzIHRvIGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0
aCB0aGUgbWF4aW11bQotICogbnVtYmVyIG9mIGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywg
YW5kICdsZW4nIGFycmF5cyBjYW4KLSAqIGJlIGZpbGxlZCB1cCB3aXRoLgotICoKLSAqIEVhY2gg
ZW50cnkgaW4gdGhlICduYW1lJyBhcnJheSBpcyBleHBlY3RlZCB0byBiZSBvZiBYRU5fTElWRVBB
VENIX05BTUVfU0laRQotICogbGVuZ3RoLgorICogVGhlICdtYXgnIGlzIHRvIGJlIHByb3ZpZGVk
IGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4aW11bSBudW1iZXIgb2YKKyAqIGVudHJpZXMgdGhh
dCAnaW5mbycsICduYW1lJywgJ2xlbicgYXJyYXlzIGNhbiBiZSBmaWxsZWQgdXAgd2l0aC4KICAq
CiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnaW5mbycgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2Yg
eGVuX2xpdmVwYXRjaF9zdGF0dXNfdAogICogc3RydWN0dXJlIHNpemUuCiAgKgorICogRWFjaCBl
bnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IG1heSBoYXZlIGFuIGFyYml0cmFyeSBzaXplLgorICoK
ICAqIEVhY2ggZW50cnkgaW4gdGhlICdsZW4nIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVp
bnQzMl90IHNpemUuCiAgKgogICogVGhlIHJldHVybiB2YWx1ZSBpcyB6ZXJvIGlmIHRoZSBoeXBl
cmNhbGwgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4KQEAgLTI1OTUsMTAgKzI2MTIsMTIgQEAgaW50
IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAgKiB3aWxsIGNvbnRhaW4gdGhl
IG51bWJlciBvZiBlbnRyaWVzIHRoYXQgaGFkIGJlZW4gc3VjY2VzZnVsbHkKICAqIHJldHJpZXZl
ZCAoaWYgYW55KS4KICAqLwotaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNo
LCB1bnNpZ25lZCBpbnQgbWF4LCB1bnNpZ25lZCBpbnQgc3RhcnQsCi0gICAgICAgICAgICAgICAg
ICAgICAgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCAqaW5mbywgY2hhciAqbmFtZSwKLSAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCAqbGVuLCB1bnNpZ25lZCBpbnQgKmRvbmUsCi0gICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpsZWZ0KTsKK2ludCB4Y19saXZlcGF0Y2hfbGlz
dCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKKyAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgc3RhcnQsCisgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHhlbl9saXZlcGF0Y2hfc3RhdHVzICppbmZvLAorICAgICAgICAgICAgICAgICAg
ICAgIGNoYXIgKm5hbWUsIHVpbnQzMl90ICpsZW4sCisgICAgICAgICAgICAgICAgICAgICAgY29u
c3QgdWludDMyX3QgbmFtZV90b3RhbF9zaXplLAorICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCAqZG9uZSwgdW5zaWduZWQgaW50ICpsZWZ0KTsKIAogLyoKICAqIFRoZSBvcGVyYXRp
b25zIGFyZSBhc3luY2hyb25vdXMgYW5kIHRoZSBoeXBlcnZpc29yIG1heSB0YWtlIGEgd2hpbGUK
ZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhjL3hjX21pc2MuYyBiL3Rvb2xzL2xpYnhjL3hjX21pc2Mu
YwppbmRleCAyZGM1MjZiZGE3Li40ZjI2Y2RiNjIzIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94
Y19taXNjLmMKKysrIGIvdG9vbHMvbGlieGMveGNfbWlzYy5jCkBAIC02NjIsNyArNjYyLDQ4IEBA
IGludCB4Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFjZSAqeGNoLAogfQogCiAvKgotICogVGhl
IGhlYXJ0IG9mIHRoaXMgZnVuY3Rpb24gaXMgdG8gZ2V0IGFuIGFycmF5IG9mIHhlbl9saXZlcGF0
Y2hfc3RhdHVzX3QuCisgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxhYmxlIHBheWxvYWRzIGFuZCBn
ZXQgYWN0dWFsIHRvdGFsIHNpemUgb2YKKyAqIHRoZSBwYXlsb2FkcycgbmFtZSBhcnJheS4KKyAq
CisgKiBUaGlzIGZ1bmN0aW9ucyBpcyB0eXBpY2FsbHkgZXhlY3V0ZWQgZmlyc3QgYmVmb3JlIHRo
ZSB4Y19saXZlcGF0Y2hfbGlzdCgpCisgKiB0byBvYnRhaW4gdGhlIHNpemVzIGFuZCBjb3JyZWN0
bHkgYWxsb2NhdGUgYWxsIG5lY2Vzc2FyeSBkYXRhIHJlc291cmNlcy4KKyAqCisgKiBUaGUgcmV0
dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVyY2FsbCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5
LgorICoKKyAqIElmIHRoZXJlIHdhcyBhbiBlcnJvciBwZXJmb3JtaW5nIHRoZSBzeXNjdGwgb3Bl
cmF0aW9uLCB0aGUgcmV0dXJuIHZhbHVlCisgKiB3aWxsIGNvbnRhaW4gdGhlIGh5cGVyY2FsbCBl
cnJvciBjb2RlIHZhbHVlLgorICovCitpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhj
X2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3RhbF9zaXplKQoreworICAgIERFQ0xBUkVfU1lT
Q1RMOworICAgIGludCByYzsKKworICAgIGlmICggIW5yIHx8ICFuYW1lX3RvdGFsX3NpemUgKQor
ICAgIHsKKyAgICAgICAgZXJybm8gPSBFSU5WQUw7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9
CisKKyAgICBtZW1zZXQoJnN5c2N0bCwgMCwgc2l6ZW9mKHN5c2N0bCkpOworICAgIHN5c2N0bC5j
bWQgPSBYRU5fU1lTQ1RMX2xpdmVwYXRjaF9vcDsKKyAgICBzeXNjdGwudS5saXZlcGF0Y2guY21k
ID0gWEVOX1NZU0NUTF9MSVZFUEFUQ0hfTElTVDsKKworICAgIHJjID0gZG9fc3lzY3RsKHhjaCwg
JnN5c2N0bCk7CisgICAgaWYgKCByYyApCisgICAgICAgIHJldHVybiByYzsKKworICAgICpuciA9
IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubnI7CisgICAgKm5hbWVfdG90YWxfc2l6ZSA9IHN5
c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90b3RhbF9zaXplOworCisgICAgcmV0dXJuIDA7
Cit9CisKKy8qCisgKiBUaGUgaGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBnZXQgYW4gYXJy
YXkgb2YgdGhlIGZvbGxvd2luZyBvYmplY3RzOgorICogICAtIHhlbl9saXZlcGF0Y2hfc3RhdHVz
X3Q6IHN0YXRlcyBhbmQgcmV0dXJuIGNvZGVzIG9mIHBheWxvYWRzCisgKiAgIC0gbmFtZTogbmFt
ZXMgb2YgcGF5bG9hZHMKKyAqICAgLSBsZW46IGxlbmd0aHMgb2YgY29ycmVzcG9uZGluZyBwYXls
b2FkcycgbmFtZXMKICAqCiAgKiBIb3dldmVyIGl0IGlzIGNvbXBsZXggYmVjYXVzZSBpdCBoYXMg
dG8gZGVhbCB3aXRoIHRoZSBoeXBlcnZpc29yCiAgKiByZXR1cm5pbmcgc29tZSBvZiB0aGUgcmVx
dWVzdGVkIGRhdGEgb3IgZGF0YSBiZWluZyBzdGFsZQpAQCAtNjczLDIxICs3MTQsMjAgQEAgaW50
IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAgKiAnbGVmdCcgYXJlIGFsc28g
dXBkYXRlZCB3aXRoIHRoZSBudW1iZXIgb2YgZW50cmllcyBmaWxsZWQgb3V0CiAgKiBhbmQgcmVz
cGVjdGl2ZWx5IHRoZSBudW1iZXIgb2YgZW50cmllcyBsZWZ0IHRvIGdldCBmcm9tIGh5cGVydmlz
b3IuCiAgKgotICogSXQgaXMgZXhwZWN0ZWQgdGhhdCB0aGUgY2FsbGVyIG9mIHRoaXMgZnVuY3Rp
b24gd2lsbCB0YWtlIHRoZQotICogJ2xlZnQnIGFuZCB1c2UgdGhlIHZhbHVlIGZvciAnc3RhcnQn
LiBUaGlzIHdheSB3ZSBoYXZlIGFuCi0gKiBjdXJzb3IgaW4gdGhlIGFycmF5LiBOb3RlIHRoYXQg
dGhlICdpbmZvJywnbmFtZScsIGFuZCAnbGVuJyB3aWxsCi0gKiBiZSB1cGRhdGVkIGF0IHRoZSBz
dWJzZXF1ZW50IGNhbGxzLgorICogSXQgaXMgZXhwZWN0ZWQgdGhhdCB0aGUgY2FsbGVyIG9mIHRo
aXMgZnVuY3Rpb24gd2lsbCBmaXJzdCBpc3N1ZSB0aGUKKyAqIHhjX2xpdmVwYXRjaF9saXN0X2dl
dF9zaXplcygpIGluIG9yZGVyIHRvIG9idGFpbiB0b3RhbCBzaXplcyBvZiBuYW1lcworICogYXMg
d2VsbCBhcyB0aGUgY3VycmVudCBudW1iZXIgb2YgcGF5bG9hZCBlbnRyaWVzLgorICogVGhlIHRv
dGFsIHNpemVzIGFyZSByZXF1aXJlZCBhbmQgc3VwcGxpZWQgdmlhIHRoZSAnbmFtZV90b3RhbF9z
aXplJworICogcGFyYW1ldGVyLgogICoKLSAqIFRoZSAnbWF4JyBpcyB0byBiZSBwcm92aWRlZCBi
eSB0aGUgY2FsbGVyIHdpdGggdGhlIG1heGltdW0KLSAqIG51bWJlciBvZiBlbnRyaWVzIHRoYXQg
J2luZm8nLCAnbmFtZScsIGFuZCAnbGVuJyBhcnJheXMgY2FuCi0gKiBiZSBmaWxsZWQgdXAgd2l0
aC4KLSAqCi0gKiBFYWNoIGVudHJ5IGluIHRoZSAnbmFtZScgYXJyYXkgaXMgZXhwZWN0ZWQgdG8g
YmUgb2YgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUKLSAqIGxlbmd0aC4KKyAqIFRoZSAnbWF4JyBp
cyB0byBiZSBwcm92aWRlZCBieSB0aGUgY2FsbGVyIHdpdGggdGhlIG1heGltdW0gbnVtYmVyIG9m
CisgKiBlbnRyaWVzIHRoYXQgJ2luZm8nLCAnbmFtZScsICdsZW4nIGFycmF5cyBjYW4gYmUgZmls
bGVkIHVwIHdpdGguCiAgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2luZm8nIGFycmF5IGlzIGV4
cGVjdGVkIHRvIGJlIG9mIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QKICAqIHN0cnVjdHVyZSBzaXpl
LgogICoKKyAqIEVhY2ggZW50cnkgaW4gdGhlICduYW1lJyBhcnJheSBtYXkgaGF2ZSBhbiBhcmJp
dHJhcnkgc2l6ZS4KKyAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnbGVuJyBhcnJheSBpcyBleHBl
Y3RlZCB0byBiZSBvZiB1aW50MzJfdCBzaXplLgogICoKICAqIFRoZSByZXR1cm4gdmFsdWUgaXMg
emVybyBpZiB0aGUgaHlwZXJjYWxsIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuCkBAIC02OTksMTEg
KzczOSwxMiBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdp
bGwgY29udGFpbiB0aGUgbnVtYmVyIG9mIGVudHJpZXMgdGhhdCBoYWQgYmVlbiBzdWNjZXNmdWxs
eQogICogcmV0cmlldmVkIChpZiBhbnkpLgogICovCi1pbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKK2lu
dCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50
IG1heCwKKyAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgc3RhcnQsCiAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHhlbl9saXZlcGF0Y2hfc3RhdHVzICppbmZvLAog
ICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm5hbWUsIHVpbnQzMl90ICpsZW4sCi0gICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpkb25lLAotICAgICAgICAgICAgICAgICAgICAg
IHVuc2lnbmVkIGludCAqbGVmdCkKKyAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJf
dCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpk
b25lLCB1bnNpZ25lZCBpbnQgKmxlZnQpCiB7CiAgICAgaW50IHJjOwogICAgIERFQ0xBUkVfU1lT
Q1RMOwpAQCAtNzE0LDI3ICs3NTUsMzMgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVy
ZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgbWF4LCB1bnNpZ25lZCBpbnQgc3RhcnQsCiAgICAgdWlu
dDMyX3QgbWF4X2JhdGNoX3N6LCBucjsKICAgICB1aW50MzJfdCB2ZXJzaW9uID0gMCwgcmV0cmll
cyA9IDA7CiAgICAgdWludDMyX3QgYWRqdXN0ID0gMDsKLSAgICBzc2l6ZV90IHN6OworICAgIHVp
bnQzMl90IG5hbWVfb2ZmID0gMDsKKyAgICB1aW50MzJfdCBuYW1lX3N6OwogCi0gICAgaWYgKCAh
bWF4IHx8ICFpbmZvIHx8ICFuYW1lIHx8ICFsZW4gKQorICAgIGlmICggIW1heCB8fCAhaW5mbyB8
fCAhbmFtZSB8fCAhbGVuIHx8ICFkb25lIHx8ICFsZWZ0ICkKICAgICB7CiAgICAgICAgIGVycm5v
ID0gRUlOVkFMOwogICAgICAgICByZXR1cm4gLTE7CiAgICAgfQogCisgICAgaWYgKCBuYW1lX3Rv
dGFsX3NpemUgPT0gMCApCisgICAgeworICAgICAgICBlcnJubyA9IEVOT0VOVDsKKyAgICAgICAg
cmV0dXJuIC0xOworICAgIH0KKworICAgIG1lbXNldCgmc3lzY3RsLCAwLCBzaXplb2Yoc3lzY3Rs
KSk7CiAgICAgc3lzY3RsLmNtZCA9IFhFTl9TWVNDVExfbGl2ZXBhdGNoX29wOwogICAgIHN5c2N0
bC51LmxpdmVwYXRjaC5jbWQgPSBYRU5fU1lTQ1RMX0xJVkVQQVRDSF9MSVNUOwotICAgIHN5c2N0
bC51LmxpdmVwYXRjaC5wYWQgPSAwOwotICAgIHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QudmVy
c2lvbiA9IDA7CiAgICAgc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5pZHggPSBzdGFydDsKLSAg
ICBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0LnBhZCA9IDA7CiAKICAgICBtYXhfYmF0Y2hfc3og
PSBtYXg7Ci0gICAgLyogQ29udmllbmNlIHZhbHVlLiAqLwotICAgIHN6ID0gc2l6ZW9mKCpuYW1l
KSAqIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFOworICAgIG5hbWVfc3ogPSBuYW1lX3RvdGFsX3Np
emU7CiAgICAgKmRvbmUgPSAwOwogICAgICpsZWZ0ID0gMDsKICAgICBkbyB7CisgICAgICAgIHVp
bnQzMl90IF9uYW1lX3N6OworCiAgICAgICAgIC8qCiAgICAgICAgICAqIFRoZSBmaXJzdCB0aW1l
IHdlIGdvIGluIHRoaXMgbG9vcCBvdXIgJ21heCcgbWF5IGJlIGJpZ2dlcgogICAgICAgICAgKiB0
aGFuIHdoYXQgdGhlIGh5cGVydmlzb3IgaXMgY29tZm9ydGFibGUgd2l0aCAtIGhlbmNlIHRoZSBm
aXJzdApAQCAtNzU0LDExICs4MDEsMTEgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVy
ZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgbWF4LCB1bnNpZ25lZCBpbnQgc3RhcnQsCiAgICAgICAg
IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubnIgPSBucjsKICAgICAgICAgLyogRml4IHRoZSBz
aXplIChtYXkgdmFyeSBiZXR3ZWVuIGh5cGVyY2FsbHMpLiAqLwogICAgICAgICBIWVBFUkNBTExf
Qk9VTkNFX1NFVF9TSVpFKGluZm8sIG5yICogc2l6ZW9mKCppbmZvKSk7Ci0gICAgICAgIEhZUEVS
Q0FMTF9CT1VOQ0VfU0VUX1NJWkUobmFtZSwgbnIgKiBucik7CisgICAgICAgIEhZUEVSQ0FMTF9C
T1VOQ0VfU0VUX1NJWkUobmFtZSwgbmFtZV9zeik7CiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0Vf
U0VUX1NJWkUobGVuLCBuciAqIHNpemVvZigqbGVuKSk7CiAgICAgICAgIC8qIE1vdmUgdGhlIHBv
aW50ZXIgdG8gcHJvcGVyIG9mZnNldCBpbnRvICdpbmZvJy4gKi8KICAgICAgICAgKEhZUEVSQ0FM
TF9CVUZGRVIoaW5mbykpLT51YnVmID0gaW5mbyArICpkb25lOwotICAgICAgICAoSFlQRVJDQUxM
X0JVRkZFUihuYW1lKSktPnVidWYgPSBuYW1lICsgKHN6ICogKmRvbmUpOworICAgICAgICAoSFlQ
RVJDQUxMX0JVRkZFUihuYW1lKSktPnVidWYgPSBuYW1lICsgbmFtZV9vZmY7CiAgICAgICAgIChI
WVBFUkNBTExfQlVGRkVSKGxlbikpLT51YnVmID0gbGVuICsgKmRvbmU7CiAgICAgICAgIC8qIEFs
bG9jYXRlIG1lbW9yeS4gKi8KICAgICAgICAgcmMgPSB4Y19oeXBlcmNhbGxfYm91bmNlX3ByZSh4
Y2gsIGluZm8pOwpAQCAtODI3LDE0ICs4NzQsMTkgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhj
X2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgbWF4LCB1bnNpZ25lZCBpbnQgc3RhcnQsCiAg
ICAgICAgICAgICBicmVhazsKICAgICAgICAgfQogICAgICAgICAqbGVmdCA9IHN5c2N0bC51Lmxp
dmVwYXRjaC51Lmxpc3QubnI7IC8qIFRvdGFsIHJlbWFpbmluZyBjb3VudC4gKi8KKyAgICAgICAg
X25hbWVfc3ogPSBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0Lm5hbWVfdG90YWxfc2l6ZTsgLyog
VG90YWwgcmVjZWl2ZWQgbmFtZSBzaXplLiAqLwogICAgICAgICAvKiBDb3B5IG9ubHkgdXAgJ3Jj
JyBvZiBkYXRhJyAtIHdlIGNvdWxkIGFkZCAnbWluKHJjLG5yKSBpZiBkZXNpcmVkLiAqLwogICAg
ICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGluZm8sIChyYyAqIHNpemVvZigqaW5mbykp
KTsKLSAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCAocmMgKiBzeikpOwor
ICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG5hbWUsIF9uYW1lX3N6KTsKICAgICAg
ICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShsZW4sIChyYyAqIHNpemVvZigqbGVuKSkpOwog
ICAgICAgICAvKiBCb3VuY2UgdGhlIGRhdGEgYW5kIGZyZWUgdGhlIGJvdW5jZSBidWZmZXIuICov
CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGluZm8pOwogICAgICAgICB4
Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBuYW1lKTsKICAgICAgICAgeGNfaHlwZXJjYWxs
X2JvdW5jZV9wb3N0KHhjaCwgbGVuKTsKKworICAgICAgICBuYW1lX3N6IC09IF9uYW1lX3N6Owor
ICAgICAgICBuYW1lX29mZiArPSBfbmFtZV9zejsKKwogICAgICAgICAvKiBBbmQgdXBkYXRlIGhv
dyBtYW55IGVsZW1lbnRzIG9mIGluZm8gd2UgaGF2ZSBjb3BpZWQgaW50by4gKi8KICAgICAgICAg
KmRvbmUgKz0gcmM7CiAgICAgICAgIC8qIFVwZGF0ZSBpZHguICovCmRpZmYgLS1naXQgYS90b29s
cy9taXNjL3hlbi1saXZlcGF0Y2guYyBiL3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jCmluZGV4
IGI0NjliMjUzYWQuLmM5M2M1MDA0MGMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL21pc2MveGVuLWxpdmVw
YXRjaC5jCisrKyBiL3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jCkBAIC02NCwxNCArNjQsMTMg
QEAgc3RhdGljIGNvbnN0IGNoYXIgKnN0YXRlMnN0cih1bnNpZ25lZCBpbnQgc3RhdGUpCiAgICAg
cmV0dXJuIG5hbWVzW3N0YXRlXTsKIH0KIAotLyogVGhpcyB2YWx1ZSB3YXMgY2hvb3NlbiBhZGhv
Yy4gSXQgY291bGQgYmUgNDIgdG9vLiAqLwotI2RlZmluZSBNQVhfTEVOIDExCiBzdGF0aWMgaW50
IGxpc3RfZnVuYyhpbnQgYXJnYywgY2hhciAqYXJndltdKQogewotICAgIHVuc2lnbmVkIGludCBp
ZHgsIGRvbmUsIGxlZnQsIGk7CisgICAgdW5zaWduZWQgaW50IG5yLCBkb25lLCBsZWZ0LCBpOwog
ICAgIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QgKmluZm8gPSBOVUxMOwogICAgIGNoYXIgKm5hbWUg
PSBOVUxMOwogICAgIHVpbnQzMl90ICpsZW4gPSBOVUxMOworICAgIHVpbnQzMl90IG5hbWVfdG90
YWxfc2l6ZSwgbmFtZV9vZmY7CiAgICAgaW50IHJjID0gRU5PTUVNOwogCiAgICAgaWYgKCBhcmdj
ICkKQEAgLTc5LDY1ICs3OCw3MyBAQCBzdGF0aWMgaW50IGxpc3RfZnVuYyhpbnQgYXJnYywgY2hh
ciAqYXJndltdKQogICAgICAgICBzaG93X2hlbHAoKTsKICAgICAgICAgcmV0dXJuIC0xOwogICAg
IH0KLSAgICBpZHggPSBsZWZ0ID0gMDsKLSAgICBpbmZvID0gbWFsbG9jKHNpemVvZigqaW5mbykg
KiBNQVhfTEVOKTsKLSAgICBpZiAoICFpbmZvICkKLSAgICAgICAgcmV0dXJuIHJjOwotICAgIG5h
bWUgPSBtYWxsb2Moc2l6ZW9mKCpuYW1lKSAqIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFICogTUFY
X0xFTik7Ci0gICAgaWYgKCAhbmFtZSApCisgICAgZG9uZSA9IGxlZnQgPSAwOworCisgICAgcmMg
PSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNoLCAmbnIsICZuYW1lX3RvdGFsX3NpemUp
OworICAgIGlmICggcmMgKQogICAgIHsKLSAgICAgICAgZnJlZShpbmZvKTsKKyAgICAgICAgcmMg
PSBlcnJubzsKKyAgICAgICAgZnByaW50ZihzdGRlcnIsICJGYWlsZWQgdG8gZ2V0IGxpc3Qgc2l6
ZXMuXG4iCisgICAgICAgICAgICAgICAgIkVycm9yICVkOiAlc1xuIiwKKyAgICAgICAgICAgICAg
ICByYywgc3RyZXJyb3IocmMpKTsKICAgICAgICAgcmV0dXJuIHJjOwogICAgIH0KLSAgICBsZW4g
PSBtYWxsb2Moc2l6ZW9mKCpsZW4pICogTUFYX0xFTik7Ci0gICAgaWYgKCAhbGVuICkgewotICAg
ICAgICBmcmVlKG5hbWUpOwotICAgICAgICBmcmVlKGluZm8pOworCisgICAgaWYgKCBuciA9PSAw
ICkKKyAgICB7CisgICAgICAgIGZwcmludGYoc3Rkb3V0LCAiTm90aGluZyB0byBsaXN0XG4iKTsK
KyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorCisgICAgaW5mbyA9IG1hbGxvYyhuciAqIHNpemVv
ZigqaW5mbykpOworICAgIGlmICggIWluZm8gKQogICAgICAgICByZXR1cm4gcmM7CisKKyAgICBu
YW1lID0gbWFsbG9jKG5hbWVfdG90YWxfc2l6ZSAqIHNpemVvZigqbmFtZSkpOworICAgIGlmICgg
IW5hbWUgKQorICAgICAgICBnb3RvIGVycm9yX25hbWU7CisKKyAgICBsZW4gPSBtYWxsb2MobnIg
KiBzaXplb2YoKmxlbikpOworICAgIGlmICggIWxlbiApCisgICAgICAgIGdvdG8gZXJyb3JfbGVu
OworCisgICAgbWVtc2V0KGluZm8sICdBJywgbnIgKiBzaXplb2YoKmluZm8pKTsKKyAgICBtZW1z
ZXQobmFtZSwgJ0InLCBuYW1lX3RvdGFsX3NpemUgKiBzaXplb2YoKm5hbWUpKTsKKyAgICBtZW1z
ZXQobGVuLCAnQycsIG5yICogc2l6ZW9mKCpsZW4pKTsKKyAgICBuYW1lX29mZiA9IDA7CisKKyAg
ICByYyA9IHhjX2xpdmVwYXRjaF9saXN0KHhjaCwgbnIsIDAsIGluZm8sIG5hbWUsIGxlbiwgbmFt
ZV90b3RhbF9zaXplLCAmZG9uZSwgJmxlZnQpOworICAgIGlmICggcmMgfHwgZG9uZSAhPSBuciB8
fCBsZWZ0ID4gMCkKKyAgICB7CisgICAgICAgIHJjID0gZXJybm87CisgICAgICAgIGZwcmludGYo
c3RkZXJyLCAiRmFpbGVkIHRvIGxpc3QgJWQvJWQuXG4iCisgICAgICAgICAgICAgICAgIkVycm9y
ICVkOiAlc1xuIiwKKyAgICAgICAgICAgICAgICBsZWZ0LCBuciwgcmMsIHN0cmVycm9yKHJjKSk7
CisgICAgICAgIGdvdG8gZXJyb3I7CiAgICAgfQogCi0gICAgZG8gewotICAgICAgICBkb25lID0g
MDsKLSAgICAgICAgLyogVGhlIG1lbXNldCBpcyBkb25lIHRvIGNhdGNoIGVycm9ycy4gKi8KLSAg
ICAgICAgbWVtc2V0KGluZm8sICdBJywgc2l6ZW9mKCppbmZvKSAqIE1BWF9MRU4pOwotICAgICAg
ICBtZW1zZXQobmFtZSwgJ0InLCBzaXplb2YoKm5hbWUpICogTUFYX0xFTiAqIFhFTl9MSVZFUEFU
Q0hfTkFNRV9TSVpFKTsKLSAgICAgICAgbWVtc2V0KGxlbiwgJ0MnLCBzaXplb2YoKmxlbikgKiBN
QVhfTEVOKTsKLSAgICAgICAgcmMgPSB4Y19saXZlcGF0Y2hfbGlzdCh4Y2gsIE1BWF9MRU4sIGlk
eCwgaW5mbywgbmFtZSwgbGVuLCAmZG9uZSwgJmxlZnQpOwotICAgICAgICBpZiAoIHJjICkKLSAg
ICAgICAgewotICAgICAgICAgICAgcmMgPSBlcnJubzsKLSAgICAgICAgICAgIGZwcmludGYoc3Rk
ZXJyLCAiRmFpbGVkIHRvIGxpc3QgJWQvJWQuXG4iCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIkVycm9yICVkOiAlc1xuIiwKLSAgICAgICAgICAgICAgICAgICAgaWR4LCBsZWZ0LCByYywg
c3RyZXJyb3IocmMpKTsKLSAgICAgICAgICAgIGJyZWFrOwotICAgICAgICB9Ci0gICAgICAgIGlm
ICggIWlkeCApCi0gICAgICAgICAgICBmcHJpbnRmKHN0ZG91dCwiIElEICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHwgc3RhdHVzXG4iCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0t
LS1cbiIpOworICAgIGZwcmludGYoc3Rkb3V0LCIgSUQgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfCBzdGF0dXNcbiIKKyAgICAgICAgICAgICAgICAgICAiLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS1cbiIpOwogCi0gICAgICAg
IGZvciAoIGkgPSAwOyBpIDwgZG9uZTsgaSsrICkKLSAgICAgICAgewotICAgICAgICAgICAgdW5z
aWduZWQgaW50IGo7Ci0gICAgICAgICAgICB1aW50MzJfdCBzejsKLSAgICAgICAgICAgIGNoYXIg
KnN0cjsKLQotICAgICAgICAgICAgc3ogPSBsZW5baV07Ci0gICAgICAgICAgICBzdHIgPSBuYW1l
ICsgKGkgKiBYRU5fTElWRVBBVENIX05BTUVfU0laRSk7Ci0gICAgICAgICAgICBmb3IgKCBqID0g
c3o7IGogPCBYRU5fTElWRVBBVENIX05BTUVfU0laRTsgaisrICkKLSAgICAgICAgICAgICAgICBz
dHJbal0gPSAnXDAnOwotCi0gICAgICAgICAgICBwcmludGYoIiUtNDBzfCAlcyIsIHN0ciwgc3Rh
dGUyc3RyKGluZm9baV0uc3RhdGUpKTsKLSAgICAgICAgICAgIGlmICggaW5mb1tpXS5yYyApCi0g
ICAgICAgICAgICAgICAgcHJpbnRmKCIgKCVkLCAlcylcbiIsIC1pbmZvW2ldLnJjLCBzdHJlcnJv
cigtaW5mb1tpXS5yYykpOwotICAgICAgICAgICAgZWxzZQotICAgICAgICAgICAgICAgIHB1dHMo
IiIpOwotICAgICAgICB9Ci0gICAgICAgIGlkeCArPSBkb25lOwotICAgIH0gd2hpbGUgKCBsZWZ0
ICk7CisgICAgZm9yICggaSA9IDA7IGkgPCBkb25lOyBpKysgKQorICAgIHsKKyAgICAgICAgY2hh
ciAqbmFtZV9zdHIgPSBuYW1lICsgbmFtZV9vZmY7CisKKyAgICAgICAgcHJpbnRmKCIlLTQwLipz
fCAlcyIsIGxlbltpXSwgbmFtZV9zdHIsIHN0YXRlMnN0cihpbmZvW2ldLnN0YXRlKSk7CisgICAg
ICAgIGlmICggaW5mb1tpXS5yYyApCisgICAgICAgICAgICBwcmludGYoIiAoJWQsICVzKVxuIiwg
LWluZm9baV0ucmMsIHN0cmVycm9yKC1pbmZvW2ldLnJjKSk7CisgICAgICAgIGVsc2UKKyAgICAg
ICAgICAgIHB1dHMoIiIpOworCisgICAgICAgIG5hbWVfb2ZmICs9IGxlbltpXTsKKyAgICB9CiAK
K2Vycm9yOgorICAgIGZyZWUobGVuKTsKK2Vycm9yX2xlbjoKICAgICBmcmVlKG5hbWUpOworZXJy
b3JfbmFtZToKICAgICBmcmVlKGluZm8pOwotICAgIGZyZWUobGVuKTsKICAgICByZXR1cm4gcmM7
CiB9CiAjdW5kZWYgTUFYX0xFTgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9saXZlcGF0Y2guYyBi
L3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKaW5kZXggNDhhYmY2NzhjMC4uNzZmNWI3Mjc0MCAxMDA2
NDQKLS0tIGEveGVuL2NvbW1vbi9saXZlcGF0Y2guYworKysgYi94ZW4vY29tbW9uL2xpdmVwYXRj
aC5jCkBAIC0xMTU5LDEyICsxMTU5LDggQEAgc3RhdGljIGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1
Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlzdCkKICAgICBpZiAoIGxpc3QtPm5yID4g
MTAyNCApCiAgICAgICAgIHJldHVybiAtRTJCSUc7CiAKLSAgICBpZiAoIGxpc3QtPnBhZCApCi0g
ICAgICAgIHJldHVybiAtRUlOVkFMOwotCiAgICAgaWYgKCBsaXN0LT5uciAmJgogICAgICAgICAg
KCFndWVzdF9oYW5kbGVfb2theShsaXN0LT5zdGF0dXMsIGxpc3QtPm5yKSB8fAotICAgICAgICAg
ICFndWVzdF9oYW5kbGVfb2theShsaXN0LT5uYW1lLCBYRU5fTElWRVBBVENIX05BTUVfU0laRSAq
IGxpc3QtPm5yKSB8fAogICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShsaXN0LT5sZW4sIGxp
c3QtPm5yKSkgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIApAQCAtMTE3NSwyMyArMTE3MSwz
NSBAQCBzdGF0aWMgaW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRj
aF9saXN0ICpsaXN0KQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKICAgICB9CiAKKyAgICBsaXN0
LT5uYW1lX3RvdGFsX3NpemUgPSAwOwogICAgIGlmICggbGlzdC0+bnIgKQogICAgIHsKKyAgICAg
ICAgdWludDY0X3QgbmFtZV9vZmZzZXQgPSAwOworCiAgICAgICAgIGxpc3RfZm9yX2VhY2hfZW50
cnkoIGRhdGEsICZwYXlsb2FkX2xpc3QsIGxpc3QgKQogICAgICAgICB7Ci0gICAgICAgICAgICB1
aW50MzJfdCBsZW47CisgICAgICAgICAgICB1aW50MzJfdCBuYW1lX2xlbjsKIAogICAgICAgICAg
ICAgaWYgKCBsaXN0LT5pZHggPiBpKysgKQogICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogCiAg
ICAgICAgICAgICBzdGF0dXMuc3RhdGUgPSBkYXRhLT5zdGF0ZTsKICAgICAgICAgICAgIHN0YXR1
cy5yYyA9IGRhdGEtPnJjOwotICAgICAgICAgICAgbGVuID0gc3RybGVuKGRhdGEtPm5hbWUpICsg
MTsKKworICAgICAgICAgICAgbmFtZV9sZW4gPSBzdHJsZW4oZGF0YS0+bmFtZSkgKyAxOworICAg
ICAgICAgICAgbGlzdC0+bmFtZV90b3RhbF9zaXplICs9IG5hbWVfbGVuOworCisgICAgICAgICAg
ICBpZiAoICFndWVzdF9oYW5kbGVfc3VicmFuZ2Vfb2theShsaXN0LT5uYW1lLCBuYW1lX29mZnNl
dCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVfb2Zm
c2V0ICsgbmFtZV9sZW4gLSAxKSApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgcmMg
PSAtRUlOVkFMOworICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgfQogCiAgICAg
ICAgICAgICAvKiBOLkIuICdpZHgnICE9ICdpJy4gKi8KLSAgICAgICAgICAgIGlmICggX19jb3B5
X3RvX2d1ZXN0X29mZnNldChsaXN0LT5uYW1lLCBpZHggKiBYRU5fTElWRVBBVENIX05BTUVfU0la
RSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5uYW1lLCBs
ZW4pIHx8Ci0gICAgICAgICAgICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChsaXN0LT5sZW4s
IGlkeCwgJmxlbiwgMSkgfHwKKyAgICAgICAgICAgIGlmICggX19jb3B5X3RvX2d1ZXN0X29mZnNl
dChsaXN0LT5uYW1lLCBuYW1lX29mZnNldCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkYXRhLT5uYW1lLCBuYW1lX2xlbikgfHwKKyAgICAgICAgICAgICAgICBfX2Nv
cHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPmxlbiwgaWR4LCAmbmFtZV9sZW4sIDEpIHx8CiAgICAg
ICAgICAgICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChsaXN0LT5zdGF0dXMsIGlkeCwgJnN0
YXR1cywgMSkgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHJjID0gLUVGQVVMVDsK
QEAgLTExOTksMTEgKzEyMDcsMTkgQEAgc3RhdGljIGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3Qg
eGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlzdCkKICAgICAgICAgICAgIH0KIAogICAgICAg
ICAgICAgaWR4Kys7CisgICAgICAgICAgICBuYW1lX29mZnNldCArPSBuYW1lX2xlbjsKIAogICAg
ICAgICAgICAgaWYgKCAoaWR4ID49IGxpc3QtPm5yKSB8fCBoeXBlcmNhbGxfcHJlZW1wdF9jaGVj
aygpICkKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgfQogICAgIH0KKyAgICBlbHNl
CisgICAgeworICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KCBkYXRhLCAmcGF5bG9hZF9saXN0
LCBsaXN0ICkKKyAgICAgICAgeworICAgICAgICAgICAgbGlzdC0+bmFtZV90b3RhbF9zaXplICs9
IHN0cmxlbihkYXRhLT5uYW1lKSArIDE7CisgICAgICAgIH0KKyAgICB9CiAgICAgbGlzdC0+bnIg
PSBwYXlsb2FkX2NudCAtIGk7IC8qIFJlbWFpbmluZyBhbW91bnQuICovCiAgICAgbGlzdC0+dmVy
c2lvbiA9IHBheWxvYWRfdmVyc2lvbjsKICAgICBzcGluX3VubG9jaygmcGF5bG9hZF9sb2NrKTsK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCBiL3hlbi9pbmNsdWRlL3B1
YmxpYy9zeXNjdGwuaAppbmRleCBlYzZmMTZmMGU2Li40YmZkMTQ3NWJmIDEwMDY0NAotLS0gYS94
ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0
bC5oCkBAIC05MzksMTAgKzkzOSwxMSBAQCBzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfZ2V0
IHsKICAqCiAgKiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgYW4gcG9zaXRpdmUgbnVtYmVyLCBp
dCBpcyB0aGUgbnVtYmVyICh1cCB0byBgbnJgKQogICogb2YgdGhlIHBheWxvYWRzIHJldHVybmVk
LCBhbG9uZyB3aXRoIGBucmAgdXBkYXRlZCB3aXRoIHRoZSBudW1iZXIgb2YgcmVtYWluaW5nCi0g
KiBwYXlsb2FkcywgYHZlcnNpb25gIHVwZGF0ZWQgKGl0IG1heSBiZSB0aGUgc2FtZSBhY3Jvc3Mg
aHlwZXJjYWxscy4gSWYgaXQKLSAqIHZhcmllcyB0aGUgZGF0YSBpcyBzdGFsZSBhbmQgZnVydGhl
ciBjYWxscyBjb3VsZCBmYWlsKS4gVGhlIGBzdGF0dXNgLAotICogYG5hbWVgLCBhbmQgYGxlbmAn
IGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4IHZhbHVlIChgaWR4YCkgd2l0aAot
ICogdGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCisgKiBwYXlsb2FkcywgYHZlcnNpb25gIHVw
ZGF0ZWQgKGl0IG1heSBiZSB0aGUgc2FtZSBhY3Jvc3MgaHlwZXJjYWxscy4gSWYgaXQgdmFyaWVz
CisgKiB0aGUgZGF0YSBpcyBzdGFsZSBhbmQgZnVydGhlciBjYWxscyBjb3VsZCBmYWlsKSBhbmQg
dGhlIG5hbWVfdG90YWxfc2l6ZQorICogY29udGFpbmluZyB0b3RhbCBzaXplIG9mIHRyYW5zZmVy
cmVkIGRhdGEgZm9yIHRoZSBhcnJheS4KKyAqIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBgbGVuYCBh
cmUgdXBkYXRlZCBhdCB0aGVpciBkZXNpZ25lZCBpbmRleCB2YWx1ZSAoYGlkeGApCisgKiB3aXRo
IHRoZSByZXR1cm5lZCB2YWx1ZSBvZiBkYXRhLgogICoKICAqIElmIHRoZSBoeXBlcmNhbGwgcmV0
dXJucyBFMkJJRyB0aGUgYG5yYCBpcyB0b28gYmlnIGFuZCBzaG91bGQgYmUKICAqIGxvd2VyZWQu
IFRoZSB1cHBlciBsaW1pdCBvZiBgbnJgIGlzIGxlZnQgdG8gdGhlIGltcGxlbWVudGlvbi4KQEAg
LTk2NCwxMiArOTY1LDEzIEBAIHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0IHsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkIGZpbGwg
b3V0LiBDYW4gYmUgemVybyB0byBnZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYW1vdW50IG9mIHBheWxvYWRzIGFuZCB2ZXJzaW9uLgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPVVQ6IEhvdyBtYW55IHBheWxv
YWRzIGxlZnQuICovCi0gICAgdWludDMyX3QgcGFkOyAgICAgICAgICAgICAgICAgICAgICAgICAg
IC8qIElOOiBNdXN0IGJlIHplcm8uICovCisgICAgdWludDMyX3QgbmFtZV90b3RhbF9zaXplOyAg
ICAgICAgICAgICAgIC8qIE9VVDogVG90YWwgc2l6ZSBvZiBhbGwgdHJhbnNmZXIgbmFtZXMgKi8K
ICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QpIHN0YXR1czsg
IC8qIE9VVC4gTXVzdCBoYXZlIGVub3VnaAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzcGFjZSBhbGxvY2F0ZSBmb3IgbnIgb2YgdGhlbS4gKi8KICAgICBY
RU5fR1VFU1RfSEFORExFXzY0KGNoYXIpIG5hbWU7ICAgICAgICAgLyogT1VUOiBBcnJheSBvZiBu
YW1lcy4gRWFjaCBtZW1iZXIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgTVVTVCBYRU5fTElWRVBBVENIX05BTUVfU0laRSBpbiBzaXplLgotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhl
bS4gKi8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF5
IGhhdmUgYW4gYXJiaXRyYXJ5IGxlbmd0aCB1cCB0bworICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBYRU5fTElWRVBBVENIX05BTUVfU0laRSBieXRlcy4gTXVz
dCBoYXZlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5y
IG9mIHRoZW0uICovCiAgICAgWEVOX0dVRVNUX0hBTkRMRV82NCh1aW50MzIpIGxlbjsgICAgICAg
IC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBvZiBuYW1lJ3MuCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLwogfTsK
LS0gCjIuMTYuNQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdtYkgKS3Jh
dXNlbnN0ci4gMzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0aWFuIFNj
aGxhZWdlciwgUmFsZiBIZXJicmljaApFaW5nZXRyYWdlbiBhbSBBbXRzZ2VyaWNodCBDaGFybG90
dGVuYnVyZyB1bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVzdC1JRDogREUgMjg5IDIz
NyA4NzkKCgoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
Clhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0
dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

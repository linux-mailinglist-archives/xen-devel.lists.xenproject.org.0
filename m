Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 5A30E36F77
	for <lists+xen-devel@lfdr.de>; Thu,  6 Jun 2019 11:06:22 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hYoIS-0006wU-Q8; Thu, 06 Jun 2019 09:02:56 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=/1VA=UF=citrix.com=roger.pau@srs-us1.protection.inumbo.net>)
 id 1hYoIR-0006vZ-EQ
 for xen-devel@lists.xenproject.org; Thu, 06 Jun 2019 09:02:55 +0000
X-Inumbo-ID: ddd6d1d6-8839-11e9-98e0-cb5d052e1489
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id ddd6d1d6-8839-11e9-98e0-cb5d052e1489;
 Thu, 06 Jun 2019 09:02:52 +0000 (UTC)
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=roger.pau@citrix.com;
 spf=SoftFail smtp.mailfrom=roger.pau@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 roger.pau@citrix.com) identity=pra; client-ip=162.221.158.21;
 receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com"; x-conformance=sidf_compatible
Received-SPF: SoftFail (esa4.hc3370-68.iphmx.com: domain of
 roger.pau@citrix.com is inclined to not designate
 162.221.158.21 as permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 include:spf.citrix.com
 include:spf2.citrix.com include:ironport.citrix.com
 exists:%{i}._spf.mta.salesforce.com ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: tWmD8RpI41ekMyJjed40/LX+EO0UgFIrIn5hpOixC810pT5dibI6EVGZXlobGnliBe9S4njQrS
 UUJTBzIEAXVnmO153J4veCLUWwyVF+ZOU0iPiOUdNXc7sPiotv4NQqsDbywrIUHKpUPHiNOZ7g
 K1OvF7mHgWqgQ46opxH1Uy8JaW/imlv8bC5YCr0J1uXdr64gV+FeMQ7dHOA9IAO3OMGis+Xucc
 2UYn2Q1QspVRI9qe06LsItSxQtPE8SeFOChN+m2/DyGWsVBIFard8KlpccGMhsRZ09cl/BQ3Cj
 hGQ=
X-SBRS: -0.9
X-MesageID: 1386124
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,558,1557201600"; 
   d="scan'208";a="1386124"
From: Roger Pau Monne <roger.pau@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 6 Jun 2019 11:01:45 +0200
Message-ID: <20190606090146.77381-12-roger.pau@citrix.com>
X-Mailer: git-send-email 2.20.1 (Apple Git-117)
In-Reply-To: <20190606090146.77381-1-roger.pau@citrix.com>
References: <20190606090146.77381-1-roger.pau@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 11/12] pci: switch pci_conf_write32 to use
 pci_sbdf_t
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin
 Tian <kevin.tian@intel.com>, Stefano Stabellini <sstabellini@kernel.org>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>, George
 Dunlap <George.Dunlap@eu.citrix.com>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Brian Woods <brian.woods@amd.com>, Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyByZWR1Y2VzIHRoZSBudW1iZXIgb2YgcGFyYW1ldGVycyBvZiB0aGUgZnVuY3Rpb24gdG8g
dHdvLCBhbmQKc2ltcGxpZmllcyBzb21lIG9mIHRoZSBjYWxsaW5nIHNpdGVzLgoKU2lnbmVkLW9m
Zi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+Ci0tLQpDYzogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpDYzogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KQ2M6IFdlaSBMaXUgPHdsQHhlbi5vcmc+CkNjOiBHZW9yZ2UgRHVu
bGFwIDxHZW9yZ2UuRHVubGFwQGV1LmNpdHJpeC5jb20+CkNjOiBJYW4gSmFja3NvbiA8aWFuLmph
Y2tzb25AZXUuY2l0cml4LmNvbT4KQ2M6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdyYWxsQGFybS5j
b20+CkNjOiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+CkNj
OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CkNjOiBUaW0gRGVl
Z2FuIDx0aW1AeGVuLm9yZz4KQ2M6IFN1cmF2ZWUgU3V0aGlrdWxwYW5pdCA8c3VyYXZlZS5zdXRo
aWt1bHBhbml0QGFtZC5jb20+CkNjOiBCcmlhbiBXb29kcyA8YnJpYW4ud29vZHNAYW1kLmNvbT4K
Q2M6IEtldmluIFRpYW4gPGtldmluLnRpYW5AaW50ZWwuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9j
cHUvYW1kLmMgICAgICAgICAgICAgICAgICAgfCAgNCArKy0tCiB4ZW4vYXJjaC94ODYvbXNpLmMg
ICAgICAgICAgICAgICAgICAgICAgIHwgMTIgKysrKy0tLS0tLS0tCiB4ZW4vYXJjaC94ODYvb3By
b2ZpbGUvb3BfbW9kZWxfYXRobG9uLmMgIHwgIDQgKysrLQogeGVuL2FyY2gveDg2L3g4Nl82NC9w
Y2kuYyAgICAgICAgICAgICAgICB8IDE3ICsrKystLS0tLS0tLS0tLS0tCiB4ZW4vZHJpdmVycy9j
aGFyL2VoY2ktZGJncC5jICAgICAgICAgICAgIHwgIDUgKysrLS0KIHhlbi9kcml2ZXJzL2NoYXIv
bnMxNjU1MC5jICAgICAgICAgICAgICAgfCAyMiArKysrKysrKysrKystLS0tLS0tLS0tCiB4ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jIHwgIDggKysrKy0tLS0KIHhlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jICAgICAgICAgICAgfCAgOCArKysrLS0tLQogeGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jICAgICB8ICA4ICsrKystLS0tCiB4ZW4vZHJp
dmVycy92cGNpL2hlYWRlci5jICAgICAgICAgICAgICAgIHwgIDcgKysrLS0tLQogeGVuL2RyaXZl
cnMvdnBjaS92cGNpLmMgICAgICAgICAgICAgICAgICB8ICAyICstCiB4ZW4vaW5jbHVkZS94ZW4v
cGNpLmggICAgICAgICAgICAgICAgICAgIHwgIDQgKy0tLQogMTIgZmlsZXMgY2hhbmdlZCwgNDUg
aW5zZXJ0aW9ucygrKSwgNTYgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L2NwdS9hbWQuYyBiL3hlbi9hcmNoL3g4Ni9jcHUvYW1kLmMKaW5kZXggYWEyMmE2OGZhMi4uOWIy
YzBiMzlkNyAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2NwdS9hbWQuYworKysgYi94ZW4vYXJj
aC94ODYvY3B1L2FtZC5jCkBAIC03MDcsMTEgKzcwNywxMSBAQCBzdGF0aWMgdm9pZCBpbml0X2Ft
ZChzdHJ1Y3QgY3B1aW5mb194ODYgKmMpCiAJCQkJICAgICAgIChoICYgMHgxKSA/ICJjbGVhcmlu
ZyBEMThGM3g1Q1swXSIgOiAiIik7CiAKIAkJCWlmIChsICYgMHgxZikKLQkJCQlwY2lfY29uZl93
cml0ZTMyKDAsIDAsIDB4MTgsIDMsIDB4NTgsCisJCQkJcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JE
RigwLCAwLCAweDE4LCAzKSwgMHg1OCwKIAkJCQkJCSBsICYgfjB4MWYpOwogCiAJCQlpZiAoaCAm
IDB4MSkKLQkJCQlwY2lfY29uZl93cml0ZTMyKDAsIDAsIDB4MTgsIDMsIDB4NWMsCisJCQkJcGNp
X2NvbmZfd3JpdGUzMihQQ0lfU0JERigwLCAwLCAweDE4LCAzKSwgMHg1YywKIAkJCQkJCSBoICYg
fjB4MSk7CiAJCX0KIApkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21zaS5jIGIveGVuL2FyY2gv
eDg2L21zaS5jCmluZGV4IGNiYzFlM2IzZjAuLjlhMWNlMzNiNDIgMTAwNjQ0Ci0tLSBhL3hlbi9h
cmNoL3g4Ni9tc2kuYworKysgYi94ZW4vYXJjaC94ODYvbXNpLmMKQEAgLTI1MSwyMSArMjUxLDE3
IEBAIHN0YXRpYyBpbnQgd3JpdGVfbXNpX21zZyhzdHJ1Y3QgbXNpX2Rlc2MgKmVudHJ5LCBzdHJ1
Y3QgbXNpX21zZyAqbXNnKQogICAgIHsKICAgICAgICAgc3RydWN0IHBjaV9kZXYgKmRldiA9IGVu
dHJ5LT5kZXY7CiAgICAgICAgIGludCBwb3MgPSBlbnRyeS0+bXNpX2F0dHJpYi5wb3M7Ci0gICAg
ICAgIHUxNiBzZWcgPSBkZXYtPnNlZzsKLSAgICAgICAgdTggYnVzID0gZGV2LT5idXM7Ci0gICAg
ICAgIHU4IHNsb3QgPSBQQ0lfU0xPVChkZXYtPmRldmZuKTsKLSAgICAgICAgdTggZnVuYyA9IFBD
SV9GVU5DKGRldi0+ZGV2Zm4pOwogICAgICAgICBpbnQgbnIgPSBlbnRyeS0+bXNpX2F0dHJpYi5l
bnRyeV9ucjsKIAogICAgICAgICBBU1NFUlQoKG1zZy0+ZGF0YSAmIChlbnRyeVstbnJdLm1zaS5u
dmVjIC0gMSkpID09IG5yKTsKICAgICAgICAgaWYgKCBuciApCiAgICAgICAgICAgICByZXR1cm4g
MDsKIAotICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2lf
bG93ZXJfYWRkcmVzc19yZWcocG9zKSwKKyAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihkZXYtPnNi
ZGYsIG1zaV9sb3dlcl9hZGRyZXNzX3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAgICAgICAg
IG1zZy0+YWRkcmVzc19sbyk7CiAgICAgICAgIGlmICggZW50cnktPm1zaV9hdHRyaWIuaXNfNjQg
KQogICAgICAgICB7Ci0gICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNlZywgYnVzLCBzbG90
LCBmdW5jLCBtc2lfdXBwZXJfYWRkcmVzc19yZWcocG9zKSwKKyAgICAgICAgICAgIHBjaV9jb25m
X3dyaXRlMzIoZGV2LT5zYmRmLCBtc2lfdXBwZXJfYWRkcmVzc19yZWcocG9zKSwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbXNnLT5hZGRyZXNzX2hpKTsKICAgICAgICAgICAgIHBjaV9j
b25mX3dyaXRlMTYoZGV2LT5zYmRmLCBtc2lfZGF0YV9yZWcocG9zLCAxKSwgbXNnLT5kYXRhKTsK
ICAgICAgICAgfQpAQCAtMzk1LDcgKzM5MSw3IEBAIHN0YXRpYyBib29sIG1zaV9zZXRfbWFza19i
aXQoc3RydWN0IGlycV9kZXNjICpkZXNjLCBib29sIGhvc3QsIGJvb2wgZ3Vlc3QpCiAgICAgICAg
ICAgICBtYXNrX2JpdHMgPSBwY2lfY29uZl9yZWFkMzIocGRldi0+c2JkZiwgZW50cnktPm1zaS5t
cG9zKTsKICAgICAgICAgICAgIG1hc2tfYml0cyAmPSB+KCh1MzIpMSA8PCBlbnRyeS0+bXNpX2F0
dHJpYi5lbnRyeV9ucik7CiAgICAgICAgICAgICBtYXNrX2JpdHMgfD0gKHUzMilmbGFnIDw8IGVu
dHJ5LT5tc2lfYXR0cmliLmVudHJ5X25yOwotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihz
ZWcsIGJ1cywgc2xvdCwgZnVuYywgZW50cnktPm1zaS5tcG9zLCBtYXNrX2JpdHMpOworICAgICAg
ICAgICAgcGNpX2NvbmZfd3JpdGUzMihwZGV2LT5zYmRmLCBlbnRyeS0+bXNpLm1wb3MsIG1hc2tf
Yml0cyk7CiAgICAgICAgIH0KICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSBQQ0lfQ0FQX0lEX01T
SVg6CkBAIC03MTYsNyArNzEyLDcgQEAgc3RhdGljIGludCBtc2lfY2FwYWJpbGl0eV9pbml0KHN0
cnVjdCBwY2lfZGV2ICpkZXYsCiAgICAgICAgIC8qIEFsbCBNU0lzIGFyZSB1bm1hc2tlZCBieSBk
ZWZhdWx0LCBNYXNrIHRoZW0gYWxsICovCiAgICAgICAgIG1hc2tiaXRzID0gcGNpX2NvbmZfcmVh
ZDMyKGRldi0+c2JkZiwgbXBvcyk7CiAgICAgICAgIG1hc2tiaXRzIHw9IH4odTMyKTAgPj4gKDMy
IC0gbWF4dmVjKTsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihzZWcsIGJ1cywgc2xvdCwgZnVu
YywgbXBvcywgbWFza2JpdHMpOworICAgICAgICBwY2lfY29uZl93cml0ZTMyKGRldi0+c2JkZiwg
bXBvcywgbWFza2JpdHMpOwogICAgIH0KICAgICBsaXN0X2FkZF90YWlsKCZlbnRyeS0+bGlzdCwg
JmRldi0+bXNpX2xpc3QpOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvb3Byb2ZpbGUvb3Bf
bW9kZWxfYXRobG9uLmMgYi94ZW4vYXJjaC94ODYvb3Byb2ZpbGUvb3BfbW9kZWxfYXRobG9uLmMK
aW5kZXggM2JmMGIwMjE0ZC4uNWM0OGY4NjhhZSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L29w
cm9maWxlL29wX21vZGVsX2F0aGxvbi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9vcHJvZmlsZS9vcF9t
b2RlbF9hdGhsb24uYwpAQCAtNDcyLDcgKzQ3Miw5IEBAIHN0YXRpYyBpbnQgX19pbml0IGluaXRf
aWJzX25taSh2b2lkKQogCQkJCWlmICgodmVuZG9yX2lkID09IFBDSV9WRU5ET1JfSURfQU1EKSAm
JgogCQkJCQkoZGV2X2lkID09IFBDSV9ERVZJQ0VfSURfQU1EXzEwSF9OQl9NSVNDKSkgewogCi0J
CQkJCXBjaV9jb25mX3dyaXRlMzIoMCwgYnVzLCBkZXYsIGZ1bmMsIElCU0NUTCwKKwkJCQkJcGNp
X2NvbmZfd3JpdGUzMigKKwkJCQkJCVBDSV9TQkRGKDAsIGJ1cywgZGV2LCBmdW5jKSwKKwkJCQkJ
CUlCU0NUTCwKIAkJCQkJCUlCU0NUTF9MVlRPRkZTRVRWQUwgfCBBUElDX0VJTFZUX0xWVE9GRl9J
QlMpOwogCiAJCQkJCXZhbHVlID0gcGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRGKDAsIGJ1cywgZGV2
LCBmdW5jKSwKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGNpLmMgYi94ZW4vYXJj
aC94ODYveDg2XzY0L3BjaS5jCmluZGV4IGYwMTRmZTBmYzUuLmFhZDFjM2Y3Y2YgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGNpLmMKKysrIGIveGVuL2FyY2gveDg2L3g4Nl82NC9w
Y2kuYwpAQCAtNjYsMTkgKzY2LDEwIEBAIHZvaWQgcGNpX2NvbmZfd3JpdGUxNihwY2lfc2JkZl90
IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVpbnQxNl90IGRhdGEpCiAgICAgICAgIHBjaV9jb25m
X3dyaXRlKFBDSV9DT05GX0FERFJFU1Moc2JkZiwgcmVnKSwgcmVnICYgMiwgMiwgZGF0YSk7CiB9
CiAKLSN1bmRlZiBQQ0lfQ09ORl9BRERSRVNTCi0jZGVmaW5lIFBDSV9DT05GX0FERFJFU1MoYnVz
LCBkZXYsIGZ1bmMsIHJlZykgXAotICAgICgweDgwMDAwMDAwIHwgKGJ1cyA8PCAxNikgfCAoZGV2
IDw8IDExKSB8IChmdW5jIDw8IDgpIHwgKHJlZyAmIH4zKSkKLQotdm9pZCBwY2lfY29uZl93cml0
ZTMyKAotICAgIHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVkIGludCBidXMsIHVuc2lnbmVkIGlu
dCBkZXYsIHVuc2lnbmVkIGludCBmdW5jLAotICAgIHVuc2lnbmVkIGludCByZWcsIHVpbnQzMl90
IGRhdGEpCit2b2lkIHBjaV9jb25mX3dyaXRlMzIocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBp
bnQgcmVnLCB1aW50MzJfdCBkYXRhKQogewotICAgIGlmICggc2VnIHx8IHJlZyA+IDI1NSApCi0g
ICAgICAgIHBjaV9tbWNmZ193cml0ZShzZWcsIGJ1cywgUENJX0RFVkZOKGRldiwgZnVuYyksIHJl
ZywgNCwgZGF0YSk7CisgICAgaWYgKCBzYmRmLnNlZyB8fCByZWcgPiAyNTUgKQorICAgICAgICBw
Y2lfbW1jZmdfd3JpdGUoc2JkZi5zZWcsIHNiZGYuYnVzLCBzYmRmLmRldmZuLCByZWcsIDQsIGRh
dGEpOwogICAgIGVsc2UKLSAgICB7Ci0gICAgICAgIEJVR19PTigoYnVzID4gMjU1KSB8fCAoZGV2
ID4gMzEpIHx8IChmdW5jID4gNykpOwotICAgICAgICBwY2lfY29uZl93cml0ZShQQ0lfQ09ORl9B
RERSRVNTKGJ1cywgZGV2LCBmdW5jLCByZWcpLCAwLCA0LCBkYXRhKTsKLSAgICB9CisgICAgICAg
IHBjaV9jb25mX3dyaXRlKFBDSV9DT05GX0FERFJFU1Moc2JkZiwgcmVnKSwgMCwgNCwgZGF0YSk7
CiB9CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9jaGFyL2VoY2ktZGJncC5jIGIveGVuL2RyaXZl
cnMvY2hhci9laGNpLWRiZ3AuYwppbmRleCBiNzgwMzM0OTUzLi5iNmUxNTVkMTdiIDEwMDY0NAot
LS0gYS94ZW4vZHJpdmVycy9jaGFyL2VoY2ktZGJncC5jCisrKyBiL3hlbi9kcml2ZXJzL2NoYXIv
ZWhjaS1kYmdwLmMKQEAgLTEwMTIsNyArMTAxMiw4IEBAIHN0YXRpYyB2b2lkIG52aWRpYV9zZXRf
ZGVidWdfcG9ydChzdHJ1Y3QgZWhjaV9kYmdwICpkYmdwLCB1bnNpZ25lZCBpbnQgcG9ydCkKIAog
ICAgIGR3b3JkICY9IH4oMHgwZiA8PCAxMik7CiAgICAgZHdvcmQgfD0gKHBvcnQgJiAweDBmKSA8
PCAxMjsKLSAgICBwY2lfY29uZl93cml0ZTMyKDAsIGRiZ3AtPmJ1cywgZGJncC0+c2xvdCwgZGJn
cC0+ZnVuYywgMHg3NCwgZHdvcmQpOworICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwg
ZGJncC0+YnVzLCBkYmdwLT5zbG90LCBkYmdwLT5mdW5jKSwgMHg3NCwKKyAgICAgICAgICAgICAg
ICAgICAgIGR3b3JkKTsKICAgICBkYmdwX3ByaW50aygic2V0IGRlYnVnIHBvcnQgdG8gJXVcbiIs
IHBvcnQpOwogfQogCkBAIC0xNDM2LDcgKzE0MzcsNyBAQCBzdGF0aWMgdm9pZCBlaGNpX2RiZ3Bf
cmVzdW1lKHN0cnVjdCBzZXJpYWxfcG9ydCAqcG9ydCkKICAgICBpZiAoICFkYmdwLT5laGNpX2Rl
YnVnICkKICAgICAgICAgcmV0dXJuOwogCi0gICAgcGNpX2NvbmZfd3JpdGUzMigwLCBkYmdwLT5i
dXMsIGRiZ3AtPnNsb3QsIGRiZ3AtPmZ1bmMsIGRiZ3AtPmJhciwKKyAgICBwY2lfY29uZl93cml0
ZTMyKFBDSV9TQkRGKDAsIGRiZ3AtPmJ1cywgZGJncC0+c2xvdCwgZGJncC0+ZnVuYyksIGRiZ3At
PmJhciwKICAgICAgICAgICAgICAgICAgICAgIGRiZ3AtPmJhcl92YWwpOwogICAgIHBjaV9jb25m
X3dyaXRlMTYoUENJX1NCREYoMCwgZGJncC0+YnVzLCBkYmdwLT5zbG90LCBkYmdwLT5mdW5jKSwK
ICAgICAgICAgICAgICAgICAgICAgIFBDSV9DT01NQU5ELCBkYmdwLT5wY2lfY3IpOwpkaWZmIC0t
Z2l0IGEveGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMgYi94ZW4vZHJpdmVycy9jaGFyL25zMTY1
NTAuYwppbmRleCAyMGVhZWNlZTU5Li5lNTE4ZjJkNzkwIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVy
cy9jaGFyL25zMTY1NTAuYworKysgYi94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYwpAQCAtNjMw
LDcgKzYzMCw4IEBAIHN0YXRpYyB2b2lkIHBjaV9zZXJpYWxfZWFybHlfaW5pdChzdHJ1Y3QgbnMx
NjU1MCAqdWFydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAodWFydC0+aW9fYmFzZSAmIDB4
RjAwMCkgfAogICAgICAgICAgICAgICAgICAgICAgICAgICgodWFydC0+aW9fYmFzZSAmIDB4RjAw
MCkgPj4gOCkpOwogCi0gICAgcGNpX2NvbmZfd3JpdGUzMigwLCB1YXJ0LT5wc19iZGZbMF0sIHVh
cnQtPnBzX2JkZlsxXSwgdWFydC0+cHNfYmRmWzJdLAorICAgIHBjaV9jb25mX3dyaXRlMzIoUENJ
X1NCREYoMCwgdWFydC0+cHNfYmRmWzBdLCB1YXJ0LT5wc19iZGZbMV0sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1YXJ0LT5wc19iZGZbMl0pLAogICAgICAgICAgICAgICAgICAgICAg
UENJX0JBU0VfQUREUkVTU18wLAogICAgICAgICAgICAgICAgICAgICAgdWFydC0+aW9fYmFzZSB8
IFBDSV9CQVNFX0FERFJFU1NfU1BBQ0VfSU8pOwogICAgIHBjaV9jb25mX3dyaXRlMTYoUENJX1NC
REYoMCwgdWFydC0+cHNfYmRmWzBdLCB1YXJ0LT5wc19iZGZbMV0sCkBAIC04NjAsMTMgKzg2MSwx
NCBAQCBzdGF0aWMgdm9pZCBfbnMxNjU1MF9yZXN1bWUoc3RydWN0IHNlcmlhbF9wb3J0ICpwb3J0
KQogCiAgICAgaWYgKCB1YXJ0LT5iYXIgKQogICAgIHsKLSAgICAgICBwY2lfY29uZl93cml0ZTMy
KDAsIHVhcnQtPnBzX2JkZlswXSwgdWFydC0+cHNfYmRmWzFdLCB1YXJ0LT5wc19iZGZbMl0sCisg
ICAgICAgcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JERigwLCB1YXJ0LT5wc19iZGZbMF0sIHVhcnQt
PnBzX2JkZlsxXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVhcnQtPnBzX2Jk
ZlsyXSksCiAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfQkFTRV9BRERSRVNTXzAgKyB1YXJ0
LT5iYXJfaWR4KjQsIHVhcnQtPmJhcik7CiAKICAgICAgICAgLyogSWYgNjQgYml0IEJBUiwgd3Jp
dGUgaGlnaGVyIDMyIGJpdHMgdG8gQkFSKzQgKi8KICAgICAgICAgaWYgKCB1YXJ0LT5iYXIgJiBQ
Q0lfQkFTRV9BRERSRVNTX01FTV9UWVBFXzY0ICkKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRl
MzIoMCwgdWFydC0+cHNfYmRmWzBdLAotICAgICAgICAgICAgICAgICAgICAgICAgdWFydC0+cHNf
YmRmWzFdLCB1YXJ0LT5wc19iZGZbMl0sCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKFBD
SV9TQkRGKDAsIHVhcnQtPnBzX2JkZlswXSwgIHVhcnQtPnBzX2JkZlsxXSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWFydC0+cHNfYmRmWzJdKSwKICAgICAgICAgICAg
ICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCArICh1YXJ0LT5iYXJfaWR4KzEpKjQsIHVh
cnQtPmJhcjY0KTsKIAogICAgICAgIHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwgdWFydC0+
cHNfYmRmWzBdLCB1YXJ0LT5wc19iZGZbMV0sCkBAIC0xMTIxLDExICsxMTIzLDExIEBAIHBjaV91
YXJ0X2NvbmZpZyhzdHJ1Y3QgbnMxNjU1MCAqdWFydCwgYm9vbF90IHNraXBfYW10LCB1bnNpZ25l
ZCBpbnQgaWR4KQogICAgICAgICAgICAgICAgIC8qIE1NSU8gYmFzZWQgKi8KICAgICAgICAgICAg
ICAgICBpZiAoIHBhcmFtLT5tbWlvICYmICEoYmFyICYgUENJX0JBU0VfQUREUkVTU19TUEFDRV9J
TykgKQogICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3Jp
dGUzMigwLCBiLCBkLCBmLAorICAgICAgICAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKFBD
SV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFBDSV9CQVNFX0FERFJFU1NfMCArIGJhcl9pZHgqNCwgfjB1KTsKICAgICAgICAgICAgICAgICAg
ICAgbGVuID0gcGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wICsgYmFy
X2lkeCAqIDQpOwotICAgICAgICAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKDAsIGIsIGQs
IGYsCisgICAgICAgICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwgYiwg
ZCwgZiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQURE
UkVTU18wICsgYmFyX2lkeCo0LCBiYXIpOwogCiAgICAgICAgICAgICAgICAgICAgIC8qIEhhbmRs
ZSA2NCBiaXQgQkFSIGlmIGZvdW5kICovCkBAIC0xMTMzLDExICsxMTM1LDExIEBAIHBjaV91YXJ0
X2NvbmZpZyhzdHJ1Y3QgbnMxNjU1MCAqdWFydCwgYm9vbF90IHNraXBfYW10LCB1bnNpZ25lZCBp
bnQgaWR4KQogICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICBi
YXJfNjQgPSBwY2lfY29uZl9yZWFkMzIoUENJX1NCREYoMCwgYiwgZCwgZiksCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCArIChiYXJfaWR4
ICsgMSkgKiA0KTsKLSAgICAgICAgICAgICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoMCwg
YiwgZCwgZiwKKyAgICAgICAgICAgICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NC
REYoMCwgYiwgZCwgZiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lf
QkFTRV9BRERSRVNTXzAgKyAoYmFyX2lkeCsxKSo0LCB+MHUpOwogICAgICAgICAgICAgICAgICAg
ICAgICAgbGVuXzY0ID0gcGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wICsgKGJh
cl9pZHggKyAxKSAqIDQpOwotICAgICAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUz
MigwLCBiLCBkLCBmLAorICAgICAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihQ
Q0lfU0JERigwLCBiLCBkLCBmKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFBDSV9CQVNFX0FERFJFU1NfMCArIChiYXJfaWR4KzEpKjQsIGJhcl82NCk7CiAgICAgICAgICAg
ICAgICAgICAgICAgICBzaXplICA9ICgodTY0KX4wIDw8IDMyKSB8IFBDSV9CQVNFX0FERFJFU1Nf
TUVNX01BU0s7CiAgICAgICAgICAgICAgICAgICAgICAgICBzaXplICY9ICgodTY0KWxlbl82NCA8
PCAzMikgfCBsZW47CkBAIC0xMTUxLDExICsxMTUzLDExIEBAIHBjaV91YXJ0X2NvbmZpZyhzdHJ1
Y3QgbnMxNjU1MCAqdWFydCwgYm9vbF90IHNraXBfYW10LCB1bnNpZ25lZCBpbnQgaWR4KQogICAg
ICAgICAgICAgICAgIC8qIElPIGJhc2VkICovCiAgICAgICAgICAgICAgICAgZWxzZSBpZiAoICFw
YXJhbS0+bW1pbyAmJiAoYmFyICYgUENJX0JBU0VfQUREUkVTU19TUEFDRV9JTykgKQogICAgICAg
ICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMigwLCBiLCBk
LCBmLAorICAgICAgICAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9TQkRGKDAsIGIs
IGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FE
RFJFU1NfMCArIGJhcl9pZHgqNCwgfjB1KTsKICAgICAgICAgICAgICAgICAgICAgbGVuID0gcGNp
X2NvbmZfcmVhZDMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wKTsKLSAgICAgICAgICAgICAg
ICAgICAgcGNpX2NvbmZfd3JpdGUzMigwLCBiLCBkLCBmLAorICAgICAgICAgICAgICAgICAgICBw
Y2lfY29uZl93cml0ZTMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCArIGJhcl9pZHgqNCwgYmFyKTsK
ICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IGxlbiAmIFBDSV9CQVNFX0FERFJFU1NfSU9fTUFT
SzsKIApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQu
YyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMKaW5kZXggNjA4M2Q1
MWI5MS4uZDE5NTMxNDkzYiAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5p
dC5jCkBAIC04NDMsMjIgKzg0MywyMiBAQCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfZXJyYXR1bV83
NDZfd29ya2Fyb3VuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKICAgICAgICAgIChib290X2Nw
dV9kYXRhLng4Nl9tb2RlbCA+IDB4MWYpICkKICAgICAgICAgcmV0dXJuOwogCi0gICAgcGNpX2Nv
bmZfd3JpdGUzMihpb21tdS0+c2VnLCBidXMsIGRldiwgZnVuYywgMHhmMCwgMHg5MCk7CisgICAg
cGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JERjIoaW9tbXUtPnNlZywgaW9tbXUtPmJkZiksIDB4ZjAs
IDB4OTApOwogICAgIHZhbHVlID0gcGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRGMihpb21tdS0+c2Vn
LCBpb21tdS0+YmRmKSwgMHhmNCk7CiAKICAgICBpZiAoIHZhbHVlICYgKDEgPDwgMikgKQogICAg
ICAgICByZXR1cm47CiAKICAgICAvKiBTZWxlY3QgTkIgaW5kaXJlY3QgcmVnaXN0ZXIgMHg5MCBh
bmQgZW5hYmxlIHdyaXRpbmcgKi8KLSAgICBwY2lfY29uZl93cml0ZTMyKGlvbW11LT5zZWcsIGJ1
cywgZGV2LCBmdW5jLCAweGYwLCAweDkwIHwgKDEgPDwgOCkpOworICAgIHBjaV9jb25mX3dyaXRl
MzIoUENJX1NCREYyKGlvbW11LT5zZWcsIGlvbW11LT5iZGYpLCAweGYwLCAweDkwIHwgKDEgPDwg
OCkpOwogCi0gICAgcGNpX2NvbmZfd3JpdGUzMihpb21tdS0+c2VnLCBidXMsIGRldiwgZnVuYywg
MHhmNCwgdmFsdWUgfCAoMSA8PCAyKSk7CisgICAgcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JERjIo
aW9tbXUtPnNlZywgaW9tbXUtPmJkZiksIDB4ZjQsIHZhbHVlIHwgKDEgPDwgMikpOwogICAgIHBy
aW50ayhYRU5MT0dfSU5GTwogICAgICAgICAgICAiQU1ELVZpOiBBcHBseWluZyBlcnJhdHVtIDc0
NiB3b3JrYXJvdW5kIGZvciBJT01NVSBhdCAlMDR4OiUwMng6JTAyeC4ldVxuIiwKICAgICAgICAg
ICAgaW9tbXUtPnNlZywgYnVzLCBkZXYsIGZ1bmMpOwogCiAgICAgLyogQ2xlYXIgdGhlIGVuYWJs
ZSB3cml0aW5nIGJpdCAqLwotICAgIHBjaV9jb25mX3dyaXRlMzIoaW9tbXUtPnNlZywgYnVzLCBk
ZXYsIGZ1bmMsIDB4ZjAsIDB4OTApOworICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYyKGlv
bW11LT5zZWcsIGlvbW11LT5iZGYpLCAweGYwLCAweDkwKTsKIH0KIAogc3RhdGljIHZvaWQgZW5h
YmxlX2lvbW11KHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvcGNpLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwppbmRl
eCAwN2M5MjFmMTc2Li5kM2ZmYWFmODU4IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9wY2kuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwpAQCAtNjM4LDcg
KzYzOCw3IEBAIHVuc2lnbmVkIGludCBwY2lfc2l6ZV9tZW1fYmFyKHBjaV9zYmRmX3Qgc2JkZiwg
dW5zaWduZWQgaW50IHBvcywKICAgICBBU1NFUlQoISgoZmxhZ3MgJiBQQ0lfQkFSX1ZGKSAmJiAo
ZmxhZ3MgJiBQQ0lfQkFSX1JPTSkpKTsKICAgICBBU1NFUlQoKGZsYWdzICYgUENJX0JBUl9ST00p
IHx8CiAgICAgICAgICAgIChiYXIgJiBQQ0lfQkFTRV9BRERSRVNTX1NQQUNFKSA9PSBQQ0lfQkFT
RV9BRERSRVNTX1NQQUNFX01FTU9SWSk7Ci0gICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLnNlZywg
c2JkZi5idXMsIHNiZGYuZGV2LCBzYmRmLmZ1bmMsIHBvcywgfjApOworICAgIHBjaV9jb25mX3dy
aXRlMzIoc2JkZiwgcG9zLCB+MCk7CiAgICAgaWYgKCBpczY0Yml0cyApCiAgICAgewogICAgICAg
ICBpZiAoIGZsYWdzICYgUENJX0JBUl9MQVNUICkKQEAgLTY1MSwxNyArNjUxLDE3IEBAIHVuc2ln
bmVkIGludCBwY2lfc2l6ZV9tZW1fYmFyKHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHBv
cywKICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICB9CiAgICAgICAgIGhpID0gcGNpX2Nv
bmZfcmVhZDMyKHNiZGYsIHBvcyArIDQpOwotICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNiZGYu
c2VnLCBzYmRmLmJ1cywgc2JkZi5kZXYsIHNiZGYuZnVuYywgcG9zICsgNCwgfjApOworICAgICAg
ICBwY2lfY29uZl93cml0ZTMyKHNiZGYsIHBvcyArIDQsIH4wKTsKICAgICB9CiAgICAgc2l6ZSA9
IHBjaV9jb25mX3JlYWQzMihzYmRmLCBwb3MpICYgbWFzazsKICAgICBpZiAoIGlzNjRiaXRzICkK
ICAgICB7CiAgICAgICAgIHNpemUgfD0gKHVpbnQ2NF90KXBjaV9jb25mX3JlYWQzMihzYmRmLCBw
b3MgKyA0KSA8PCAzMjsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLnNlZywgc2JkZi5i
dXMsIHNiZGYuZGV2LCBzYmRmLmZ1bmMsIHBvcyArIDQsIGhpKTsKKyAgICAgICAgcGNpX2NvbmZf
d3JpdGUzMihzYmRmLCBwb3MgKyA0LCBoaSk7CiAgICAgfQogICAgIGVsc2UgaWYgKCBzaXplICkK
ICAgICAgICAgc2l6ZSB8PSAodWludDY0X3QpfjAgPDwgMzI7Ci0gICAgcGNpX2NvbmZfd3JpdGUz
MihzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYuZGV2LCBzYmRmLmZ1bmMsIHBvcywgYmFyKTsKKyAg
ICBwY2lfY29uZl93cml0ZTMyKHNiZGYsIHBvcywgYmFyKTsKICAgICBzaXplID0gLXNpemU7CiAK
ICAgICBpZiAoIHBhZGRyICkKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0
ZC9xdWlya3MuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xdWlya3MuYwppbmRleCAy
OGU5NTk3MDE0Li5iNmUyZDMxM2YwIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC92dGQvcXVpcmtzLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5j
CkBAIC00NDEsNyArNDQxLDcgQEAgdm9pZCBwY2lfdnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lf
ZGV2ICpwZGV2KQogICAgIGNhc2UgMHgzNzI4OiAvKiBYZW9uIEM1NTAwL0MzNTAwIChKYXNwZXJG
b3Jlc3QpICovCiAgICAgY2FzZSAweDNjMjg6IC8qIFNhbmR5YnJpZGdlICovCiAgICAgICAgIHZh
bCA9IHBjaV9jb25mX3JlYWQzMihwZGV2LT5zYmRmLCAweDFBQyk7Ci0gICAgICAgIHBjaV9jb25m
X3dyaXRlMzIoc2VnLCBidXMsIGRldiwgZnVuYywgMHgxQUMsIHZhbCB8ICgxIDw8IDMxKSk7Cisg
ICAgICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2JkZiwgMHgxQUMsIHZhbCB8ICgxIDw8IDMx
KSk7CiAgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiTWFza2VkIFZULWQgZXJyb3Igc2lnbmFs
aW5nIG9uICUwNHg6JTAyeDolMDJ4LiV1XG4iLAogICAgICAgICAgICAgICAgc2VnLCBidXMsIGRl
diwgZnVuYyk7CiAgICAgICAgIGJyZWFrOwpAQCAtNDg5LDkgKzQ4OSw5IEBAIHZvaWQgcGNpX3Z0
ZF9xdWlyayhjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAgICAgICAgIGFjdGlvbiA9
ICJGb3VuZCBtYXNrZWQiOwogICAgICAgICBlbHNlIGlmICggIWZmICkKICAgICAgICAgewotICAg
ICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihzZWcsIGJ1cywgZGV2LCBmdW5jLCBwb3MgKyBQQ0lf
RVJSX1VOQ09SX01BU0ssCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYtPnNiZGYs
IHBvcyArIFBDSV9FUlJfVU5DT1JfTUFTSywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dmFsIHwgUENJX0VSUl9VTkNfVU5TVVApOwotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihz
ZWcsIGJ1cywgZGV2LCBmdW5jLCBwb3MgKyBQQ0lfRVJSX0NPUl9NQVNLLAorICAgICAgICAgICAg
cGNpX2NvbmZfd3JpdGUzMihwZGV2LT5zYmRmLCBwb3MgKyBQQ0lfRVJSX0NPUl9NQVNLLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwyIHwgUENJX0VSUl9DT1JfQURWX05GQVQpOwog
ICAgICAgICAgICAgYWN0aW9uID0gIk1hc2tlZCI7CiAgICAgICAgIH0KQEAgLTUwMCw3ICs1MDAs
NyBAQCB2b2lkIHBjaV92dGRfcXVpcmsoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAKICAg
ICAgICAgLyogWFBVTkNFUlJNU0sgU2VuZCBDb21wbGV0aW9uIHdpdGggVW5zdXBwb3J0ZWQgUmVx
dWVzdCAqLwogICAgICAgICB2YWwgPSBwY2lfY29uZl9yZWFkMzIocGRldi0+c2JkZiwgMHgyMGMp
OwotICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNlZywgYnVzLCBkZXYsIGZ1bmMsIDB4MjBjLCB2
YWwgfCAoMSA8PCA0KSk7CisgICAgICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2JkZiwgMHgy
MGMsIHZhbCB8ICgxIDw8IDQpKTsKIAogICAgICAgICBwcmludGsoWEVOTE9HX0lORk8gIiVzIFVS
IHNpZ25hbGluZyBvbiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKICAgICAgICAgICAgICAgIGFjdGlv
biwgc2VnLCBidXMsIGRldiwgZnVuYyk7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL2hl
YWRlci5jIGIveGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYwppbmRleCA1ZDEwNDAyMTQyLi4yM2Yw
NmU2NDAzIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5jCisrKyBiL3hlbi9k
cml2ZXJzL3ZwY2kvaGVhZGVyLmMKQEAgLTg1LDcgKzg1LDYgQEAgc3RhdGljIHZvaWQgbW9kaWZ5
X2RlY29kaW5nKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1aW50MTZfdCBjbWQsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCByb21fb25seSkKIHsKICAgICBzdHJ1Y3QgdnBj
aV9oZWFkZXIgKmhlYWRlciA9ICZwZGV2LT52cGNpLT5oZWFkZXI7Ci0gICAgdWludDhfdCBzbG90
ID0gUENJX1NMT1QocGRldi0+ZGV2Zm4pLCBmdW5jID0gUENJX0ZVTkMocGRldi0+ZGV2Zm4pOwog
ICAgIGJvb2wgbWFwID0gY21kICYgUENJX0NPTU1BTkRfTUVNT1JZOwogICAgIHVuc2lnbmVkIGlu
dCBpOwogCkBAIC0xMTMsNyArMTEyLDcgQEAgc3RhdGljIHZvaWQgbW9kaWZ5X2RlY29kaW5nKGNv
bnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1aW50MTZfdCBjbWQsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAobWFwID8gUENJX1JPTV9BRERSRVNTX0VOQUJMRSA6IDApOwogCiAgICAgICAg
ICAgICBoZWFkZXItPmJhcnNbaV0uZW5hYmxlZCA9IGhlYWRlci0+cm9tX2VuYWJsZWQgPSBtYXA7
Ci0gICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90
LCBmdW5jLCByb21fcG9zLCB2YWwpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihwZGV2
LT5zYmRmLCByb21fcG9zLCB2YWwpOwogICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICB9CiAK
QEAgLTM5NSw3ICszOTQsNyBAQCBzdGF0aWMgdm9pZCBiYXJfd3JpdGUoY29uc3Qgc3RydWN0IHBj
aV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgICAgIHZhbCB8PSBiYXItPnByZWZl
dGNoYWJsZSA/IFBDSV9CQVNFX0FERFJFU1NfTUVNX1BSRUZFVENIIDogMDsKICAgICB9CiAKLSAg
ICBwY2lfY29uZl93cml0ZTMyKHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLCByZWcs
IHZhbCk7CisgICAgcGNpX2NvbmZfd3JpdGUzMihwZGV2LT5zYmRmLCByZWcsIHZhbCk7CiB9CiAK
IHN0YXRpYyB2b2lkIHJvbV93cml0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWdu
ZWQgaW50IHJlZywKQEAgLTQyNiw3ICs0MjUsNyBAQCBzdGF0aWMgdm9pZCByb21fd3JpdGUoY29u
c3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgewogICAgICAg
ICAvKiBKdXN0IHVwZGF0ZSB0aGUgUk9NIEJBUiBmaWVsZC4gKi8KICAgICAgICAgaGVhZGVyLT5y
b21fZW5hYmxlZCA9IG5ld19lbmFibGVkOwotICAgICAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYt
PnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLCByZWcsIHZhbCk7CisgICAgICAgIHBjaV9jb25m
X3dyaXRlMzIocGRldi0+c2JkZiwgcmVnLCB2YWwpOwogICAgIH0KICAgICAvKgogICAgICAqIFBh
c3MgUENJX0NPTU1BTkRfTUVNT1JZIG9yIDAgdG8gc2lnbmFsIGEgbWFwL3VubWFwIHJlcXVlc3Qs
IG5vdGUgdGhhdApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMgYi94ZW4vZHJp
dmVycy92cGNpL3ZwY2kuYwppbmRleCAwZjA2ODgwOTNmLi43NThkOTQyMGU3IDEwMDY0NAotLS0g
YS94ZW4vZHJpdmVycy92cGNpL3ZwY2kuYworKysgYi94ZW4vZHJpdmVycy92cGNpL3ZwY2kuYwpA
QCAtMjUzLDcgKzI1Myw3IEBAIHN0YXRpYyB2b2lkIHZwY2lfd3JpdGVfaHcocGNpX3NiZGZfdCBz
YmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBpbnQgc2l6ZSwKICAgICBzd2l0Y2ggKCBz
aXplICkKICAgICB7CiAgICAgY2FzZSA0OgotICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNiZGYu
c2VnLCBzYmRmLmJ1cywgc2JkZi5kZXYsIHNiZGYuZnVuYywgcmVnLCBkYXRhKTsKKyAgICAgICAg
cGNpX2NvbmZfd3JpdGUzMihzYmRmLCByZWcsIGRhdGEpOwogICAgICAgICBicmVhazsKIAogICAg
IGNhc2UgMzoKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9wY2kuaCBiL3hlbi9pbmNsdWRl
L3hlbi9wY2kuaAppbmRleCA4MjA4MTM3YTUxLi40Y2Q2NWM0M2MzIDEwMDY0NAotLS0gYS94ZW4v
aW5jbHVkZS94ZW4vcGNpLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3BjaS5oCkBAIC0xNzcsOSAr
MTc3LDcgQEAgdWludDE2X3QgcGNpX2NvbmZfcmVhZDE2KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWdu
ZWQgaW50IHJlZyk7CiB1aW50MzJfdCBwY2lfY29uZl9yZWFkMzIocGNpX3NiZGZfdCBzYmRmLCB1
bnNpZ25lZCBpbnQgcmVnKTsKIHZvaWQgcGNpX2NvbmZfd3JpdGU4KHBjaV9zYmRmX3Qgc2JkZiwg
dW5zaWduZWQgaW50IHJlZywgdWludDhfdCBkYXRhKTsKIHZvaWQgcGNpX2NvbmZfd3JpdGUxNihw
Y2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVpbnQxNl90IGRhdGEpOwotdm9pZCBw
Y2lfY29uZl93cml0ZTMyKAotICAgIHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVkIGludCBidXMs
IHVuc2lnbmVkIGludCBkZXYsIHVuc2lnbmVkIGludCBmdW5jLAotICAgIHVuc2lnbmVkIGludCBy
ZWcsIHVpbnQzMl90IGRhdGEpOwordm9pZCBwY2lfY29uZl93cml0ZTMyKHBjaV9zYmRmX3Qgc2Jk
ZiwgdW5zaWduZWQgaW50IHJlZywgdWludDMyX3QgZGF0YSk7CiB1aW50MzJfdCBwY2lfY29uZl9y
ZWFkKHVpbnQzMl90IGNmOCwgdWludDhfdCBvZmZzZXQsIHVpbnQ4X3QgYnl0ZXMpOwogdm9pZCBw
Y2lfY29uZl93cml0ZSh1aW50MzJfdCBjZjgsIHVpbnQ4X3Qgb2Zmc2V0LCB1aW50OF90IGJ5dGVz
LCB1aW50MzJfdCBkYXRhKTsKIGludCBwY2lfbW1jZmdfcmVhZCh1bnNpZ25lZCBpbnQgc2VnLCB1
bnNpZ25lZCBpbnQgYnVzLAotLSAKMi4yMC4xIChBcHBsZSBHaXQtMTE3KQoKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxp
c3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVj
dC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

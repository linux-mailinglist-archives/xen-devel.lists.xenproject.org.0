Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 86D1E2C47E
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:36:51 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZRG-00074k-GR; Tue, 28 May 2019 10:34:38 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZQH-0004zV-Dz
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:33:37 +0000
X-Inumbo-ID: 0812c476-8134-11e9-a058-4b86fa8e8f68
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 0812c476-8134-11e9-a058-4b86fa8e8f68;
 Tue, 28 May 2019 10:33:29 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id E7F14B066;
 Tue, 28 May 2019 10:33:27 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:32:57 +0200
Message-Id: <20190528103313.1343-45-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 44/60] xen/sched: add fall back to idle vcpu
 when scheduling unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Dario Faggioli <dfaggioli@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

V2hlbiBzY2hlZHVsaW5nIGFuIHVuaXQgd2l0aCBtdWx0aXBsZSB2Y3B1cyB0aGVyZSBpcyBubyBn
dWFyYW50ZWUgYWxsCnZjcHVzIGFyZSBhdmFpbGFibGUgKGUuZy4gYWJvdmUgbWF4dmNwdXMgb3Ig
dmNwdSBvZmZsaW5lKS4gRmFsbCBiYWNrIHRvCmlkbGUgdmNwdSBvZiB0aGUgY3VycmVudCBjcHUg
aW4gdGhhdCBjYXNlLiBUaGlzIHJlcXVpcmVzIHRvIHN0b3JlIHRoZQpjb3JyZWN0IHNjaGVkdWxl
X3VuaXQgcG9pbnRlciBpbiB0aGUgaWRsZSB2Y3B1IGFzIGxvbmcgYXMgaXQgdXNlZCBhcwpmYWxs
YmFjayB2Y3B1LgoKSW4gb3JkZXIgdG8gbW9kaWZ5IHRoZSBydW5zdGF0ZXMgb2YgdGhlIGNvcnJl
Y3QgdmNwdXMgd2hlbiBzd2l0Y2hpbmcKc2NoZWR1bGUgdW5pdHMgbWVyZ2Ugc2NoZWRfdW5pdF9y
dW5zdGF0ZV9jaGFuZ2UoKSBpbnRvCnNjaGVkX3N3aXRjaF91bml0cygpIGFuZCBsb29wIG92ZXIg
dGhlIGFmZmVjdGVkIHBoeXNpY2FsIGNwdXMgaW5zdGVhZApvZiB0aGUgdW5pdCdzIHZjcHVzLiBU
aGlzIGluIHR1cm4gcmVxdWlyZXMgYW4gYWNjZXNzIGZ1bmN0aW9uIHRvIHRoZQpjdXJyZW50IHZh
cmlhYmxlIG9mIG90aGVyIGNwdXMuCgpUb2RheSBjb250ZXh0X3NhdmVkKCkgaXMgY2FsbGVkIGlu
IGNhc2UgcHJldmlvdXMgYW5kIG5leHQgdmNwdXMgZGlmZmVyCndoZW4gZG9pbmcgYSBjb250ZXh0
IHN3aXRjaC4gV2l0aCBhbiBpZGxlIHZjcHUgYmVpbmcgY2FwYWJsZSB0byBiZSBhCnN1YnN0aXR1
dGUgZm9yIGFuIG9mZmxpbmUgdmNwdSB0aGlzIGlzIHByb2JsZW1hdGljIHdoZW4gc3dpdGNoaW5n
IHRvCmFuIGlkbGUgc2NoZWR1bGluZyB1bml0LiBBbiBpZGxlIHByZXZpb3VzIHZjcHUgbGVhdmVz
IHVzIGluIGRvdWJ0IHdoaWNoCnNjaGVkdWxlIHVuaXQgd2FzIGFjdGl2ZSBwcmV2aW91c2x5LCBz
byBzYXZlIHRoZSBwcmV2aW91cyB1bml0IHBvaW50ZXIKaW4gdGhlIHBlci1zY2hlZHVsZSByZXNv
dXJjZSBhcmVhIGFuZCB1c2UgaXRzIHZhbHVlIGJlaW5nIG5vbi1OVUxMIGFzCmEgaGludCB3aGV0
aGVyIGNvbnRleHRfc2F2ZWQoKSBzaG91bGQgYmUgY2FsbGVkLgoKV2hlbiBydW5uaW5nIGFuIGlk
bGUgdmNwdSBpbiBhIG5vbi1pZGxlIHNjaGVkdWxpbmcgdW5pdCB1c2UgYSBzcGVjaWZpYwpndWVz
dCBpZGxlIGxvb3Agbm90IHBlcmZvcm1pbmcgYW55IHRhc2tsZXRzLCBtZW1vcnkgc2NydWJiaW5n
IGFuZApsaXZlcGF0Y2hpbmcgaW4gb3JkZXIgdG8gYXZvaWQgcG9wdWxhdGluZyB0aGUgY3B1IGNh
Y2hlcyB3aXRoIG1lbW9yeQp1c2VkIGJ5IG90aGVyIGRvbWFpbnMgKGFzIGZhciBhcyBwb3NzaWJs
ZSkuIFNvZnRpcnFzIGFyZSBjb25zaWRlcmVkIHRvCmJlIHNhdmUgKHRpbWVycyBtaWdodCB3YW50
IHRvIGJlIGV4Y2x1ZGVkLCBidXQgdGhpcyBjYW4gYmUgZmluZS10dW5lZApsYXRlcikuCgpTaWdu
ZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+Ci0tLQpSRkMgVjI6IG5l
dyBwYXRjaCAoQW5kcmV3IENvb3BlcikKVjE6IHVzZSB1cmdlbnRfY291bnQgdG8gc2VsZWN0IGNv
cnJlY3QgaWRsZSByb3V0aW5lIChKYW4gQmV1bGljaCkKLS0tCiB4ZW4vYXJjaC94ODYvZG9tYWlu
LmMgICAgICAgICB8ICAyMSArKysrKysKIHhlbi9jb21tb24vc2NoZWR1bGUuYyAgICAgICAgIHwg
MTU1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLQogeGVuL2luY2x1
ZGUvYXNtLWFybS9jdXJyZW50LmggfCAgIDEgKwogeGVuL2luY2x1ZGUvYXNtLXg4Ni9jdXJyZW50
LmggfCAgIDcgKy0KIHhlbi9pbmNsdWRlL2FzbS14ODYvc21wLmggICAgIHwgICAzICsKIHhlbi9p
bmNsdWRlL3hlbi9zY2hlZC1pZi5oICAgIHwgICA0ICstCiB4ZW4vaW5jbHVkZS94ZW4vc2NoZWQu
aCAgICAgICB8ICAgMSArCiA3IGZpbGVzIGNoYW5nZWQsIDE0MCBpbnNlcnRpb25zKCspLCA1MiBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJj
aC94ODYvZG9tYWluLmMKaW5kZXggOThkMjkzOWRhZi4uMzlhMmMxYTA0NyAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gveDg2L2RvbWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtMTU5
LDYgKzE1OSwyMyBAQCBzdGF0aWMgdm9pZCBpZGxlX2xvb3Aodm9pZCkKICAgICB9CiB9CiAKKy8q
CisgKiBJZGxlIGxvb3AgZm9yIHNpYmxpbmdzIG9mIGFjdGl2ZSBzY2hlZHVsZSB1bml0cy4KKyAq
IFdlIGRvbid0IGRvIGFueSBzdGFuZGFyZCBpZGxlIHdvcmsgbGlrZSB0YXNrbGV0cywgcGFnZSBz
Y3J1YmJpbmcgb3IKKyAqIGxpdmVwYXRjaGluZy4KKyAqLworc3RhdGljIHZvaWQgZ3Vlc3RfaWRs
ZV9sb29wKHZvaWQpCit7CisgICAgdW5zaWduZWQgaW50IGNwdSA9IHNtcF9wcm9jZXNzb3JfaWQo
KTsKKworICAgIGZvciAoIDsgOyApCisgICAgeworICAgICAgICBpZiAoICFzb2Z0aXJxX3BlbmRp
bmcoY3B1KSApCisgICAgICAgICAgICBzY2hlZF9ndWVzdF9pZGxlKHBtX2lkbGUsIGNwdSk7Cisg
ICAgICAgIGRvX3NvZnRpcnEoKTsKKyAgICB9Cit9CisKIHZvaWQgc3RhcnR1cF9jcHVfaWRsZV9s
b29wKHZvaWQpCiB7CiAgICAgc3RydWN0IHZjcHUgKnYgPSBjdXJyZW50OwpAQCAtMTcyLDYgKzE4
OSwxMCBAQCB2b2lkIHN0YXJ0dXBfY3B1X2lkbGVfbG9vcCh2b2lkKQogCiBzdGF0aWMgdm9pZCBu
b3JldHVybiBjb250aW51ZV9pZGxlX2RvbWFpbihzdHJ1Y3QgdmNwdSAqdikKIHsKKyAgICAvKiBJ
ZGxlIHZjcHVzIG1pZ2h0IGJlIGF0dGFjaGVkIHRvIG5vbi1pZGxlIHVuaXRzISAqLworICAgIGlm
ICggIWlzX2lkbGVfZG9tYWluKHYtPnNjaGVkX3VuaXQtPmRvbWFpbikgKQorICAgICAgICByZXNl
dF9zdGFja19hbmRfanVtcChndWVzdF9pZGxlX2xvb3ApOworCiAgICAgcmVzZXRfc3RhY2tfYW5k
X2p1bXAoaWRsZV9sb29wKTsKIH0KIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZHVsZS5j
IGIveGVuL2NvbW1vbi9zY2hlZHVsZS5jCmluZGV4IDU4ZDNkZTM0MGUuLmUwMTAzZmRiMWQgMTAw
NjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWR1bGUuYworKysgYi94ZW4vY29tbW9uL3NjaGVkdWxl
LmMKQEAgLTgyLDcgKzgyLDE4IEBAIHN0YXRpYyBzdHJ1Y3Qgc2NoZWR1bGVyIF9fcmVhZF9tb3N0
bHkgb3BzOwogc3RhdGljIGlubGluZSBzdHJ1Y3QgdmNwdSAqc2NoZWRfdW5pdDJ2Y3B1X2NwdShz
dHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGNwdSkKIHsKLSAgICByZXR1cm4gdW5pdC0+ZG9t
YWluLT52Y3B1W3VuaXQtPnVuaXRfaWQgKyBwZXJfY3B1KHNjaGVkX3Jlc19pZHgsIGNwdSldOwor
ICAgIHVuc2lnbmVkIGludCBpZHggPSB1bml0LT51bml0X2lkICsgcGVyX2NwdShzY2hlZF9yZXNf
aWR4LCBjcHUpOworICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKmQgPSB1bml0LT5kb21haW47Cisg
ICAgc3RydWN0IHZjcHUgKnY7CisKKyAgICBpZiAoIGlkeCA8IGQtPm1heF92Y3B1cyAmJiBkLT52
Y3B1W2lkeF0gKQorICAgIHsKKyAgICAgICAgdiA9IGQtPnZjcHVbaWR4XTsKKyAgICAgICAgaWYg
KCB2LT5uZXdfc3RhdGUgPT0gUlVOU1RBVEVfcnVubmluZyApCisgICAgICAgICAgICByZXR1cm4g
djsKKyAgICB9CisKKyAgICByZXR1cm4gaWRsZV92Y3B1W2NwdV07CiB9CiAKIHN0YXRpYyBpbmxp
bmUgc3RydWN0IHNjaGVkdWxlciAqZG9tX3NjaGVkdWxlcihjb25zdCBzdHJ1Y3QgZG9tYWluICpk
KQpAQCAtMTk2LDggKzIwNywxMSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdmNwdV9ydW5zdGF0ZV9j
aGFuZ2UoCiAKICAgICB0cmFjZV9ydW5zdGF0ZV9jaGFuZ2UodiwgbmV3X3N0YXRlKTsKIAotICAg
IHVuaXQtPnJ1bnN0YXRlX2NudFt2LT5ydW5zdGF0ZS5zdGF0ZV0tLTsKLSAgICB1bml0LT5ydW5z
dGF0ZV9jbnRbbmV3X3N0YXRlXSsrOworICAgIGlmICggIWlzX2lkbGVfdmNwdSh2KSApCisgICAg
eworICAgICAgICB1bml0LT5ydW5zdGF0ZV9jbnRbdi0+cnVuc3RhdGUuc3RhdGVdLS07CisgICAg
ICAgIHVuaXQtPnJ1bnN0YXRlX2NudFtuZXdfc3RhdGVdKys7CisgICAgfQogCiAgICAgZGVsdGEg
PSBuZXdfZW50cnlfdGltZSAtIHYtPnJ1bnN0YXRlLnN0YXRlX2VudHJ5X3RpbWU7CiAgICAgaWYg
KCBkZWx0YSA+IDAgKQpAQCAtMjA5LDE5ICsyMjMsMTEgQEAgc3RhdGljIGlubGluZSB2b2lkIHZj
cHVfcnVuc3RhdGVfY2hhbmdlKAogICAgIHYtPnJ1bnN0YXRlLnN0YXRlID0gbmV3X3N0YXRlOwog
fQogCi1zdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfdW5pdF9ydW5zdGF0ZV9jaGFuZ2Uoc3RydWN0
IHNjaGVkX3VuaXQgKnVuaXQsCi0gICAgYm9vbCBydW5uaW5nLCBzX3RpbWVfdCBuZXdfZW50cnlf
dGltZSkKK3ZvaWQgc2NoZWRfZ3Vlc3RfaWRsZSh2b2lkICgqaWRsZSkgKHZvaWQpLCB1bnNpZ25l
ZCBpbnQgY3B1KQogewotICAgIHN0cnVjdCB2Y3B1ICp2OwotCi0gICAgZm9yX2VhY2hfc2NoZWRf
dW5pdF92Y3B1ICggdW5pdCwgdiApCi0gICAgICAgIGlmICggcnVubmluZyApCi0gICAgICAgICAg
ICB2Y3B1X3J1bnN0YXRlX2NoYW5nZSh2LCB2LT5uZXdfc3RhdGUsIG5ld19lbnRyeV90aW1lKTsK
LSAgICAgICAgZWxzZQotICAgICAgICAgICAgdmNwdV9ydW5zdGF0ZV9jaGFuZ2UodiwKLSAgICAg
ICAgICAgICAgICAoKHYtPnBhdXNlX2ZsYWdzICYgVlBGX2Jsb2NrZWQpID8gUlVOU1RBVEVfYmxv
Y2tlZCA6Ci0gICAgICAgICAgICAgICAgICh2Y3B1X3J1bm5hYmxlKHYpID8gUlVOU1RBVEVfcnVu
bmFibGUgOiBSVU5TVEFURV9vZmZsaW5lKSksCi0gICAgICAgICAgICAgICAgbmV3X2VudHJ5X3Rp
bWUpOworICAgIGF0b21pY19pbmMoJmdldF9zY2hlZF9yZXMoY3B1KS0+dXJnZW50X2NvdW50KTsK
KyAgICBpZGxlKCk7CisgICAgYXRvbWljX2RlYygmZ2V0X3NjaGVkX3JlcyhjcHUpLT51cmdlbnRf
Y291bnQpOwogfQogCiB2b2lkIHZjcHVfcnVuc3RhdGVfZ2V0KHN0cnVjdCB2Y3B1ICp2LCBzdHJ1
Y3QgdmNwdV9ydW5zdGF0ZV9pbmZvICpydW5zdGF0ZSkKQEAgLTQ2MSw2ICs0NjcsNyBAQCBpbnQg
c2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2KQogICAgIGlmICggaXNfaWRsZV9kb21haW4o
ZCkgKQogICAgIHsKICAgICAgICAgZ2V0X3NjaGVkX3Jlcyh2LT5wcm9jZXNzb3IpLT5jdXJyID0g
dW5pdDsKKyAgICAgICAgZ2V0X3NjaGVkX3Jlcyh2LT5wcm9jZXNzb3IpLT5zY2hlZF91bml0X2lk
bGUgPSB1bml0OwogICAgICAgICB2LT5pc19ydW5uaW5nID0gMTsKICAgICAgICAgdW5pdC0+aXNf
cnVubmluZyA9IDE7CiAgICAgICAgIHVuaXQtPnN0YXRlX2VudHJ5X3RpbWUgPSBOT1coKTsKQEAg
LTE2MzcsMzMgKzE2NDQsNjcgQEAgc3RhdGljIHZvaWQgc2NoZWRfc3dpdGNoX3VuaXRzKHN0cnVj
dCBzY2hlZF9yZXNvdXJjZSAqc2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHNjaGVkX3VuaXQgKm5leHQsIHN0cnVjdCBzY2hlZF91bml0ICpwcmV2LAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNfdGltZV90IG5vdykKIHsKLSAgICBzZC0+Y3VyciA9IG5l
eHQ7Ci0KLSAgICBUUkFDRV8zRChUUkNfU0NIRURfU1dJVENIX0lORlBSRVYsIHByZXYtPmRvbWFp
bi0+ZG9tYWluX2lkLCBwcmV2LT51bml0X2lkLAotICAgICAgICAgICAgIG5vdyAtIHByZXYtPnN0
YXRlX2VudHJ5X3RpbWUpOwotICAgIFRSQUNFXzREKFRSQ19TQ0hFRF9TV0lUQ0hfSU5GTkVYVCwg
bmV4dC0+ZG9tYWluLT5kb21haW5faWQsIG5leHQtPnVuaXRfaWQsCi0gICAgICAgICAgICAgKG5l
eHQtPnZjcHUtPnJ1bnN0YXRlLnN0YXRlID09IFJVTlNUQVRFX3J1bm5hYmxlKSA/Ci0gICAgICAg
ICAgICAgKG5vdyAtIG5leHQtPnN0YXRlX2VudHJ5X3RpbWUpIDogMCwgcHJldi0+bmV4dF90aW1l
KTsKKyAgICBpbnQgY3B1OwogCiAgICAgQVNTRVJUKHVuaXRfcnVubmluZyhwcmV2KSk7CiAKLSAg
ICBUUkFDRV80RChUUkNfU0NIRURfU1dJVENILCBwcmV2LT5kb21haW4tPmRvbWFpbl9pZCwgcHJl
di0+dW5pdF9pZCwKLSAgICAgICAgICAgICBuZXh0LT5kb21haW4tPmRvbWFpbl9pZCwgbmV4dC0+
dW5pdF9pZCk7CisgICAgaWYgKCBwcmV2ICE9IG5leHQgKQorICAgIHsKKyAgICAgICAgc2QtPmN1
cnIgPSBuZXh0OworICAgICAgICBzZC0+cHJldiA9IHByZXY7CiAKLSAgICBzY2hlZF91bml0X3J1
bnN0YXRlX2NoYW5nZShwcmV2LCBmYWxzZSwgbm93KTsKLSAgICBwcmV2LT5sYXN0X3J1bl90aW1l
ID0gbm93OworICAgICAgICBUUkFDRV8zRChUUkNfU0NIRURfU1dJVENIX0lORlBSRVYsIHByZXYt
PmRvbWFpbi0+ZG9tYWluX2lkLAorICAgICAgICAgICAgICAgICBwcmV2LT51bml0X2lkLCBub3cg
LSBwcmV2LT5zdGF0ZV9lbnRyeV90aW1lKTsKKyAgICAgICAgVFJBQ0VfNEQoVFJDX1NDSEVEX1NX
SVRDSF9JTkZORVhULCBuZXh0LT5kb21haW4tPmRvbWFpbl9pZCwKKyAgICAgICAgICAgICAgICAg
bmV4dC0+dW5pdF9pZCwKKyAgICAgICAgICAgICAgICAgKG5leHQtPnZjcHUtPnJ1bnN0YXRlLnN0
YXRlID09IFJVTlNUQVRFX3J1bm5hYmxlKSA/CisgICAgICAgICAgICAgICAgIChub3cgLSBuZXh0
LT5zdGF0ZV9lbnRyeV90aW1lKSA6IDAsIHByZXYtPm5leHRfdGltZSk7CisgICAgICAgIFRSQUNF
XzREKFRSQ19TQ0hFRF9TV0lUQ0gsIHByZXYtPmRvbWFpbi0+ZG9tYWluX2lkLCBwcmV2LT51bml0
X2lkLAorICAgICAgICAgICAgICAgICBuZXh0LT5kb21haW4tPmRvbWFpbl9pZCwgbmV4dC0+dW5p
dF9pZCk7CiAKLSAgICBBU1NFUlQoIXVuaXRfcnVubmluZyhuZXh0KSk7Ci0gICAgc2NoZWRfdW5p
dF9ydW5zdGF0ZV9jaGFuZ2UobmV4dCwgdHJ1ZSwgbm93KTsKKyAgICAgICAgcHJldi0+bGFzdF9y
dW5fdGltZSA9IG5vdzsKIAotICAgIC8qCi0gICAgICogTkIuIERvbid0IGFkZCBhbnkgdHJhY2Ug
cmVjb3JkcyBmcm9tIGhlcmUgdW50aWwgdGhlIGFjdHVhbCBjb250ZXh0Ci0gICAgICogc3dpdGNo
LCBlbHNlIGxvc3RfcmVjb3JkcyByZXN1bWUgd2lsbCBub3Qgd29yayBwcm9wZXJseS4KLSAgICAg
Ki8KKyAgICAgICAgQVNTRVJUKCF1bml0X3J1bm5pbmcobmV4dCkpOworCisgICAgICAgIC8qCisg
ICAgICAgICAqIE5CLiBEb24ndCBhZGQgYW55IHRyYWNlIHJlY29yZHMgZnJvbSBoZXJlIHVudGls
IHRoZSBhY3R1YWwgY29udGV4dAorICAgICAgICAgKiBzd2l0Y2gsIGVsc2UgbG9zdF9yZWNvcmRz
IHJlc3VtZSB3aWxsIG5vdCB3b3JrIHByb3Blcmx5LgorICAgICAgICAgKi8KIAotICAgIEFTU0VS
VCghbmV4dC0+aXNfcnVubmluZyk7Ci0gICAgbmV4dC0+dmNwdS0+aXNfcnVubmluZyA9IDE7Ci0g
ICAgbmV4dC0+aXNfcnVubmluZyA9IDE7CisgICAgICAgIEFTU0VSVCghbmV4dC0+aXNfcnVubmlu
Zyk7CisgICAgICAgIG5leHQtPmlzX3J1bm5pbmcgPSAxOworCisgICAgICAgIGlmICggaXNfaWRs
ZV91bml0KHByZXYpICkKKyAgICAgICAgeworICAgICAgICAgICAgcHJldi0+cnVuc3RhdGVfY250
W1JVTlNUQVRFX3J1bm5pbmddID0gMDsKKyAgICAgICAgICAgIHByZXYtPnJ1bnN0YXRlX2NudFtS
VU5TVEFURV9ydW5uYWJsZV0gPSBzY2hlZF9ncmFudWxhcml0eTsKKyAgICAgICAgfQorICAgICAg
ICBpZiAoIGlzX2lkbGVfdW5pdChuZXh0KSApCisgICAgICAgIHsKKyAgICAgICAgICAgIG5leHQt
PnJ1bnN0YXRlX2NudFtSVU5TVEFURV9ydW5uaW5nXSA9IHNjaGVkX2dyYW51bGFyaXR5OworICAg
ICAgICAgICAgbmV4dC0+cnVuc3RhdGVfY250W1JVTlNUQVRFX3J1bm5hYmxlXSA9IDA7CisgICAg
ICAgIH0KKyAgICB9CisKKyAgICBmb3JfZWFjaF9jcHUgKCBjcHUsIHNkLT5jcHVzICkKKyAgICB7
CisgICAgICAgIHN0cnVjdCB2Y3B1ICp2cHJldiA9IGdldF9jcHVfY3VycmVudChjcHUpOworICAg
ICAgICBzdHJ1Y3QgdmNwdSAqdm5leHQgPSBzY2hlZF91bml0MnZjcHVfY3B1KG5leHQsIGNwdSk7
CisKKyAgICAgICAgaWYgKCB2cHJldiAhPSB2bmV4dCB8fCB2cHJldi0+cnVuc3RhdGUuc3RhdGUg
IT0gdm5leHQtPm5ld19zdGF0ZSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHZjcHVfcnVuc3Rh
dGVfY2hhbmdlKHZwcmV2LAorICAgICAgICAgICAgICAgICgodnByZXYtPnBhdXNlX2ZsYWdzICYg
VlBGX2Jsb2NrZWQpID8gUlVOU1RBVEVfYmxvY2tlZCA6CisgICAgICAgICAgICAgICAgICh2Y3B1
X3J1bm5hYmxlKHZwcmV2KSA/IFJVTlNUQVRFX3J1bm5hYmxlIDogUlVOU1RBVEVfb2ZmbGluZSkp
LAorICAgICAgICAgICAgICAgIG5vdyk7CisgICAgICAgICAgICB2Y3B1X3J1bnN0YXRlX2NoYW5n
ZSh2bmV4dCwgdm5leHQtPm5ld19zdGF0ZSwgbm93KTsKKyAgICAgICAgfQorCisgICAgICAgIHZu
ZXh0LT5pc19ydW5uaW5nID0gMTsKKworICAgICAgICBpZiAoIGlzX2lkbGVfdmNwdSh2bmV4dCkg
KQorICAgICAgICAgICAgdm5leHQtPnNjaGVkX3VuaXQgPSBuZXh0OworICAgIH0KIH0KIAogc3Rh
dGljIGJvb2wgc2NoZWRfdGFza2xldF9jaGVja19jcHUodW5zaWduZWQgaW50IGNwdSkKQEAgLTE3
MTksMjUgKzE3NjAsMjUgQEAgc3RhdGljIHN0cnVjdCBzY2hlZF91bml0ICpkb19zY2hlZHVsZShz
dHJ1Y3Qgc2NoZWRfdW5pdCAqcHJldiwgc190aW1lX3Qgbm93LAogICAgIGlmICggcHJldi0+bmV4
dF90aW1lID49IDAgKSAvKiAtdmUgbWVhbnMgbm8gbGltaXQgKi8KICAgICAgICAgc2V0X3RpbWVy
KCZzZC0+c190aW1lciwgbm93ICsgcHJldi0+bmV4dF90aW1lKTsKIAotICAgIGlmICggbGlrZWx5
KHByZXYgIT0gbmV4dCkgKQotICAgICAgICBzY2hlZF9zd2l0Y2hfdW5pdHMoc2QsIG5leHQsIHBy
ZXYsIG5vdyk7CisgICAgc2NoZWRfc3dpdGNoX3VuaXRzKHNkLCBuZXh0LCBwcmV2LCBub3cpOwog
CiAgICAgcmV0dXJuIG5leHQ7CiB9CiAKLXN0YXRpYyB2b2lkIGNvbnRleHRfc2F2ZWQoc3RydWN0
IHZjcHUgKnByZXYpCitzdGF0aWMgdm9pZCBjb250ZXh0X3NhdmVkKHN0cnVjdCBzY2hlZF91bml0
ICp1bml0KQogewotICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0ID0gcHJldi0+c2NoZWRfdW5p
dDsKLQogICAgIHVuaXQtPmlzX3J1bm5pbmcgPSAwOwogICAgIHVuaXQtPnN0YXRlX2VudHJ5X3Rp
bWUgPSBOT1coKTsKKyAgICBnZXRfc2NoZWRfcmVzKHNtcF9wcm9jZXNzb3JfaWQoKSktPnByZXYg
PSBOVUxMOwogCiAgICAgLyogQ2hlY2sgZm9yIG1pZ3JhdGlvbiByZXF1ZXN0IC9hZnRlci8gY2xl
YXJpbmcgcnVubmluZyBmbGFnLiAqLwogICAgIHNtcF9tYigpOwogCi0gICAgc2NoZWRfY29udGV4
dF9zYXZlZCh2Y3B1X3NjaGVkdWxlcihwcmV2KSwgdW5pdCk7CisgICAgc2NoZWRfY29udGV4dF9z
YXZlZCh2Y3B1X3NjaGVkdWxlcih1bml0LT52Y3B1KSwgdW5pdCk7CiAKLSAgICBzY2hlZF91bml0
X21pZ3JhdGVfZmluaXNoKHVuaXQpOworICAgIC8qIElkbGUgbmV2ZXIgbWlncmF0ZXMgYW5kIGlk
bGUgdmNwdXMgbWlnaHQgYmVsb25nIHRvIG90aGVyIHVuaXRzLiAqLworICAgIGlmICggIWlzX2lk
bGVfdW5pdCh1bml0KSApCisgICAgICAgIHNjaGVkX3VuaXRfbWlncmF0ZV9maW5pc2godW5pdCk7
CiB9CiAKIC8qCkBAIC0xNzU0LDExICsxNzk1LDEzIEBAIHN0YXRpYyB2b2lkIGNvbnRleHRfc2F2
ZWQoc3RydWN0IHZjcHUgKnByZXYpCiB2b2lkIHNjaGVkX2NvbnRleHRfc3dpdGNoZWQoc3RydWN0
IHZjcHUgKnZwcmV2LCBzdHJ1Y3QgdmNwdSAqdm5leHQpCiB7CiAgICAgc3RydWN0IHNjaGVkX3Vu
aXQgKm5leHQgPSB2bmV4dC0+c2NoZWRfdW5pdDsKKyAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2Ug
KnNkID0gZ2V0X3NjaGVkX3JlcyhzbXBfcHJvY2Vzc29yX2lkKCkpOwogCiAgICAgLyogQ2xlYXIg
cnVubmluZyBmbGFnIC9hZnRlci8gd3JpdGluZyBjb250ZXh0IHRvIG1lbW9yeS4gKi8KICAgICBz
bXBfd21iKCk7CiAKLSAgICB2cHJldi0+aXNfcnVubmluZyA9IDA7CisgICAgaWYgKCB2cHJldiAh
PSB2bmV4dCApCisgICAgICAgIHZwcmV2LT5pc19ydW5uaW5nID0gMDsKIAogICAgIGlmICggYXRv
bWljX3JlYWQoJm5leHQtPnJlbmRlenZvdXNfb3V0X2NudCkgKQogICAgIHsKQEAgLTE3NjcsMjAg
KzE4MTAsMjMgQEAgdm9pZCBzY2hlZF9jb250ZXh0X3N3aXRjaGVkKHN0cnVjdCB2Y3B1ICp2cHJl
diwgc3RydWN0IHZjcHUgKnZuZXh0KQogICAgICAgICAvKiBDYWxsIGNvbnRleHRfc2F2ZWQoKSBi
ZWZvcmUgcmVsZWFzaW5nIG90aGVyIHdhaXRlcnMuICovCiAgICAgICAgIGlmICggY250ID09IDEg
KQogICAgICAgICB7Ci0gICAgICAgICAgICBpZiAoIHZwcmV2ICE9IHZuZXh0ICkKLSAgICAgICAg
ICAgICAgICBjb250ZXh0X3NhdmVkKHZwcmV2KTsKKyAgICAgICAgICAgIGlmICggc2QtPnByZXYg
KQorICAgICAgICAgICAgICAgIGNvbnRleHRfc2F2ZWQoc2QtPnByZXYpOwogICAgICAgICAgICAg
YXRvbWljX3NldCgmbmV4dC0+cmVuZGV6dm91c19vdXRfY250LCAwKTsKICAgICAgICAgfQogICAg
ICAgICBlbHNlCiAgICAgICAgICAgICB3aGlsZSAoIGF0b21pY19yZWFkKCZuZXh0LT5yZW5kZXp2
b3VzX291dF9jbnQpICkKICAgICAgICAgICAgICAgICBjcHVfcmVsYXgoKTsKICAgICB9Ci0gICAg
ZWxzZSBpZiAoIHZwcmV2ICE9IHZuZXh0ICYmIHNjaGVkX2dyYW51bGFyaXR5ID09IDEgKQotICAg
ICAgICBjb250ZXh0X3NhdmVkKHZwcmV2KTsKKyAgICBlbHNlIGlmICggc2QtPnByZXYgKQorICAg
ICAgICBjb250ZXh0X3NhdmVkKHNkLT5wcmV2KTsKKworICAgIGlmICggaXNfaWRsZV92Y3B1KHZw
cmV2KSAmJiB2cHJldiAhPSB2bmV4dCApCisgICAgICAgIHZwcmV2LT5zY2hlZF91bml0ID0gc2Qt
PnNjaGVkX3VuaXRfaWRsZTsKIH0KIAogc3RhdGljIHZvaWQgc2NoZWRfY29udGV4dF9zd2l0Y2go
c3RydWN0IHZjcHUgKnZwcmV2LCBzdHJ1Y3QgdmNwdSAqdm5leHQsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzX3RpbWVfdCBub3cpCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBib29sIHJlc2V0X2lkbGVfdW5pdCwgc190aW1lX3Qgbm93KQogewogICAgIGlmICgg
dW5saWtlbHkodnByZXYgPT0gdm5leHQpICkKICAgICB7CkBAIC0xNzg5LDYgKzE4MzUsMTEgQEAg
c3RhdGljIHZvaWQgc2NoZWRfY29udGV4dF9zd2l0Y2goc3RydWN0IHZjcHUgKnZwcmV2LCBzdHJ1
Y3QgdmNwdSAqdm5leHQsCiAgICAgICAgICAgICAgICAgIG5vdyAtIHZwcmV2LT5ydW5zdGF0ZS5z
dGF0ZV9lbnRyeV90aW1lLAogICAgICAgICAgICAgICAgICB2cHJldi0+c2NoZWRfdW5pdC0+bmV4
dF90aW1lKTsKICAgICAgICAgc2NoZWRfY29udGV4dF9zd2l0Y2hlZCh2cHJldiwgdm5leHQpOwor
CisgICAgICAgIGlmICggcmVzZXRfaWRsZV91bml0ICkKKyAgICAgICAgICAgIHZuZXh0LT5zY2hl
ZF91bml0ID0KKyAgICAgICAgICAgICAgICBnZXRfc2NoZWRfcmVzKHNtcF9wcm9jZXNzb3JfaWQo
KSktPnNjaGVkX3VuaXRfaWRsZTsKKwogICAgICAgICB0cmFjZV9jb250aW51ZV9ydW5uaW5nKHZu
ZXh0KTsKICAgICAgICAgcmV0dXJuIGNvbnRpbnVlX3J1bm5pbmcodnByZXYpOwogICAgIH0KQEAg
LTE4NzAsNyArMTkyMSw4IEBAIHN0YXRpYyB2b2lkIHNjaGVkX3NsYXZlKHZvaWQpCiAKICAgICBw
Y3B1X3NjaGVkdWxlX3VubG9ja19pcnEobG9jaywgY3B1KTsKIAotICAgIHNjaGVkX2NvbnRleHRf
c3dpdGNoKHZwcmV2LCBzY2hlZF91bml0MnZjcHVfY3B1KG5leHQsIGNwdSksIG5vdyk7CisgICAg
c2NoZWRfY29udGV4dF9zd2l0Y2godnByZXYsIHNjaGVkX3VuaXQydmNwdV9jcHUobmV4dCwgY3B1
KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICBpc19pZGxlX3VuaXQobmV4dCkgJiYgIWlzX2lk
bGVfdW5pdChwcmV2KSwgbm93KTsKIH0KIAogLyoKQEAgLTE5MzAsNyArMTk4Miw4IEBAIHN0YXRp
YyB2b2lkIHNjaGVkdWxlKHZvaWQpCiAgICAgcGNwdV9zY2hlZHVsZV91bmxvY2tfaXJxKGxvY2ss
IGNwdSk7CiAKICAgICB2bmV4dCA9IHNjaGVkX3VuaXQydmNwdV9jcHUobmV4dCwgY3B1KTsKLSAg
ICBzY2hlZF9jb250ZXh0X3N3aXRjaCh2cHJldiwgdm5leHQsIG5vdyk7CisgICAgc2NoZWRfY29u
dGV4dF9zd2l0Y2godnByZXYsIHZuZXh0LAorICAgICAgICAgICAgICAgICAgICAgICAgICFpc19p
ZGxlX3VuaXQocHJldikgJiYgaXNfaWRsZV91bml0KG5leHQpLCBub3cpOwogfQogCiAvKiBUaGUg
c2NoZWR1bGVyIHRpbWVyOiBmb3JjZSBhIHJ1biB0aHJvdWdoIHRoZSBzY2hlZHVsZXIgKi8KQEAg
LTIwMTUsNiArMjA2OCw3IEBAIHN0YXRpYyBpbnQgY3B1X3NjaGVkdWxlX3VwKHVuc2lnbmVkIGlu
dCBjcHUpCiAgICAgICAgIHJldHVybiAtRU5PTUVNOwogCiAgICAgc2QtPmN1cnIgPSBpZGxlX3Zj
cHVbY3B1XS0+c2NoZWRfdW5pdDsKKyAgICBzZC0+c2NoZWRfdW5pdF9pZGxlID0gaWRsZV92Y3B1
W2NwdV0tPnNjaGVkX3VuaXQ7CiAKICAgICAvKgogICAgICAqIFdlIGRvbid0IHdhbnQgdG8gcmlz
ayBjYWxsaW5nIHhmcmVlKCkgb24gYW4gc2QtPnNjaGVkX3ByaXYKQEAgLTIyMTYsNiArMjI3MCw3
IEBAIHZvaWQgX19pbml0IHNjaGVkdWxlcl9pbml0KHZvaWQpCiAgICAgaWYgKCB2Y3B1X2NyZWF0
ZShpZGxlX2RvbWFpbiwgMCkgPT0gTlVMTCApCiAgICAgICAgIEJVRygpOwogICAgIGdldF9zY2hl
ZF9yZXMoMCktPmN1cnIgPSBpZGxlX3ZjcHVbMF0tPnNjaGVkX3VuaXQ7CisgICAgZ2V0X3NjaGVk
X3JlcygwKS0+c2NoZWRfdW5pdF9pZGxlID0gaWRsZV92Y3B1WzBdLT5zY2hlZF91bml0OwogICAg
IGdldF9zY2hlZF9yZXMoMCktPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxvY19wZGF0YSgmb3BzLCAw
KTsKICAgICBCVUdfT04oSVNfRVJSKGdldF9zY2hlZF9yZXMoMCktPnNjaGVkX3ByaXYpKTsKICAg
ICBzY2hlZHVsZXJfcGVyY3B1X2luaXQoMCk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS9hc20t
YXJtL2N1cnJlbnQuaCBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vY3VycmVudC5oCmluZGV4IGM0YWY2
NmZiYjkuLmE3NjAyZWVmOGMgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS1hcm0vY3VycmVu
dC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vY3VycmVudC5oCkBAIC0xOCw2ICsxOCw3IEBA
IERFQ0xBUkVfUEVSX0NQVShzdHJ1Y3QgdmNwdSAqLCBjdXJyX3ZjcHUpOwogCiAjZGVmaW5lIGN1
cnJlbnQgICAgICAgICAgICAodGhpc19jcHUoY3Vycl92Y3B1KSkKICNkZWZpbmUgc2V0X2N1cnJl
bnQodmNwdSkgIGRvIHsgY3VycmVudCA9ICh2Y3B1KTsgfSB3aGlsZSAoMCkKKyNkZWZpbmUgZ2V0
X2NwdV9jdXJyZW50KGNwdSkgIChwZXJfY3B1KGN1cnJfdmNwdSwgY3B1KSkKIAogLyogUGVyLVZD
UFUgc3RhdGUgdGhhdCBsaXZlcyBhdCB0aGUgdG9wIG9mIHRoZSBzdGFjayAqLwogc3RydWN0IGNw
dV9pbmZvIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvY3VycmVudC5oIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9jdXJyZW50LmgKaW5kZXggZjM1MDhjM2MwOC4uMWU4MDdkNjNjZiAx
MDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9jdXJyZW50LmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9jdXJyZW50LmgKQEAgLTc3LDYgKzc3LDExIEBAIHN0cnVjdCBjcHVfaW5mbyB7
CiAgICAgLyogZ2V0X3N0YWNrX2JvdHRvbSgpIG11c3QgYmUgMTYtYnl0ZSBhbGlnbmVkICovCiB9
OwogCitzdGF0aWMgaW5saW5lIHN0cnVjdCBjcHVfaW5mbyAqZ2V0X2NwdV9pbmZvX2Zyb21fc3Rh
Y2sodW5zaWduZWQgbG9uZyBzcCkKK3sKKyAgICByZXR1cm4gKHN0cnVjdCBjcHVfaW5mbyAqKSgo
c3AgfCAoU1RBQ0tfU0laRSAtIDEpKSArIDEpIC0gMTsKK30KKwogc3RhdGljIGlubGluZSBzdHJ1
Y3QgY3B1X2luZm8gKmdldF9jcHVfaW5mbyh2b2lkKQogewogI2lmZGVmIF9fY2xhbmdfXwpAQCAt
ODcsNyArOTIsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBjcHVfaW5mbyAqZ2V0X2NwdV9pbmZv
KHZvaWQpCiAgICAgcmVnaXN0ZXIgdW5zaWduZWQgbG9uZyBzcCBhc20oInJzcCIpOwogI2VuZGlm
CiAKLSAgICByZXR1cm4gKHN0cnVjdCBjcHVfaW5mbyAqKSgoc3AgfCAoU1RBQ0tfU0laRSAtIDEp
KSArIDEpIC0gMTsKKyAgICByZXR1cm4gZ2V0X2NwdV9pbmZvX2Zyb21fc3RhY2soc3ApOwogfQog
CiAjZGVmaW5lIGdldF9jdXJyZW50KCkgICAgICAgICAoZ2V0X2NwdV9pbmZvKCktPmN1cnJlbnRf
dmNwdSkKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvc21wLmggYi94ZW4vaW5jbHVk
ZS9hc20teDg2L3NtcC5oCmluZGV4IDlmNTMzZjkwNzIuLjUxYTMxYWIwMGEgMTAwNjQ0Ci0tLSBh
L3hlbi9pbmNsdWRlL2FzbS14ODYvc21wLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9zbXAu
aApAQCAtNzYsNiArNzYsOSBAQCB2b2lkIHNldF9ucl9zb2NrZXRzKHZvaWQpOwogLyogUmVwcmVz
ZW50aW5nIEhUIGFuZCBjb3JlIHNpYmxpbmdzIGluIGVhY2ggc29ja2V0LiAqLwogZXh0ZXJuIGNw
dW1hc2tfdCAqKnNvY2tldF9jcHVtYXNrOwogCisjZGVmaW5lIGdldF9jcHVfY3VycmVudChjcHUp
IFwKKyAgICAoZ2V0X2NwdV9pbmZvX2Zyb21fc3RhY2soKHVuc2lnbmVkIGxvbmcpc3RhY2tfYmFz
ZVtjcHVdKS0+Y3VycmVudF92Y3B1KQorCiAjZW5kaWYgLyogIV9fQVNTRU1CTFlfXyAqLwogCiAj
ZW5kaWYKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIGIveGVuL2luY2x1
ZGUveGVuL3NjaGVkLWlmLmgKaW5kZXggZTkzZmU5ZjNiZS4uYTFhZWZhMmEyNSAxMDA2NDQKLS0t
IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVk
LWlmLmgKQEAgLTM5LDYgKzM5LDggQEAgc3RydWN0IHNjaGVkX3Jlc291cmNlIHsKICAgICBzcGlu
bG9ja190ICAgICAgICAgKnNjaGVkdWxlX2xvY2ssCiAgICAgICAgICAgICAgICAgICAgICAgIF9s
b2NrOwogICAgIHN0cnVjdCBzY2hlZF91bml0ICAqY3VycjsgICAgICAgICAgIC8qIGN1cnJlbnQg
dGFzayAgICAgICAgICAgICAgICAgICAgKi8KKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAgKnNjaGVk
X3VuaXRfaWRsZTsKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAgKnByZXY7ICAgICAgICAgICAvKiBw
cmV2aW91cyB0YXNrICAgICAgICAgICAgICAgICAgICovCiAgICAgdm9pZCAgICAgICAgICAgICAg
ICpzY2hlZF9wcml2OwogICAgIHN0cnVjdCB0aW1lciAgICAgICAgc190aW1lcjsgICAgICAgIC8q
IHNjaGVkdWxpbmcgdGltZXIgICAgICAgICAgICAgICAgKi8KICAgICBhdG9taWNfdCAgICAgICAg
ICAgIHVyZ2VudF9jb3VudDsgICAvKiBob3cgbWFueSB1cmdlbnQgdmNwdXMgICAgICAgICAgICov
CkBAIC0xNjgsNyArMTcwLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2NsZWFyX3BhdXNl
X2ZsYWdzX2F0b21pYyhzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwKIAogc3RhdGljIGlubGluZSBz
dHJ1Y3Qgc2NoZWRfdW5pdCAqc2NoZWRfaWRsZV91bml0KHVuc2lnbmVkIGludCBjcHUpCiB7Ci0g
ICAgcmV0dXJuIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91bml0OworICAgIHJldHVybiBnZXRfc2No
ZWRfcmVzKGNwdSktPnNjaGVkX3VuaXRfaWRsZTsKIH0KIAogc3RhdGljIGlubGluZSB1bnNpZ25l
ZCBpbnQgc2NoZWRfZ2V0X3Jlc291cmNlX2NwdSh1bnNpZ25lZCBpbnQgY3B1KQpkaWZmIC0tZ2l0
IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmggYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAppbmRl
eCBhZjRjOTM0ZTBiLi4wNTgxYzdkNDRmIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2No
ZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaApAQCAtOTIxLDYgKzkyMSw3IEBAIGlu
dCB2Y3B1X3Bpbl9vdmVycmlkZShzdHJ1Y3QgdmNwdSAqdiwgaW50IGNwdSk7CiB2b2lkIHZjcHVf
cnVuc3RhdGVfZ2V0KHN0cnVjdCB2Y3B1ICp2LCBzdHJ1Y3QgdmNwdV9ydW5zdGF0ZV9pbmZvICpy
dW5zdGF0ZSk7CiB1aW50NjRfdCBnZXRfY3B1X2lkbGVfdGltZSh1bnNpZ25lZCBpbnQgY3B1KTsK
IGludCBzY2hlZF9oYXNfdXJnZW50X3ZjcHUodm9pZCk7Cit2b2lkIHNjaGVkX2d1ZXN0X2lkbGUo
dm9pZCAoKmlkbGUpICh2b2lkKSwgdW5zaWduZWQgaW50IGNwdSk7CiAKIC8qCiAgKiBVc2VkIGJ5
IGlkbGUgbG9vcCB0byBkZWNpZGUgd2hldGhlciB0aGVyZSBpcyB3b3JrIHRvIGRvOgotLSAKMi4x
Ni40CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVu
LWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6
Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

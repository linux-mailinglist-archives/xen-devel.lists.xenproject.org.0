Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id AD3FC2C459
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:35:42 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZQD-0004qH-U9; Tue, 28 May 2019 10:33:33 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZQ6-0004dV-IN
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:33:26 +0000
X-Inumbo-ID: 04cb3fda-8134-11e9-8980-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 04cb3fda-8134-11e9-8980-bc764e045a96;
 Tue, 28 May 2019 10:33:23 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id C8B57B039;
 Tue, 28 May 2019 10:33:21 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:32:32 +0200
Message-Id: <20190528103313.1343-20-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 19/60] xen/sched: add is_running indicator to
 struct sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Meng Xu <mengxu@cis.upenn.edu>,
 Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIGFuIGlzX3J1bm5pbmcgaW5kaWNhdG9yIHRvIHN0cnVjdCBzY2hlZF91bml0IHdoaWNoIHdp
bGwgYmUgc2V0CndoZW5ldmVyIHRoZSB1bml0IGlzIGJlaW5nIHNjaGVkdWxlZC4gU3dpdGNoIHNj
aGVkdWxlciBjb2RlIHRvIHVzZQp1bml0LT5pc19ydW5uaW5nIGluc3RlYWQgb2YgdmNwdS0+aXNf
cnVubmluZyBmb3Igc2NoZWR1bGluZyBkZWNpc2lvbnMuCgpBdCB0aGUgc2FtZSB0aW1lIGludHJv
ZHVjZSBhIHN0YXRlX2VudHJ5X3RpbWUgZmllbGQgaW4gc3RydWN0CnNjaGVkX3VuaXQgYmVpbmcg
dXBkYXRlZCB3aGVuZXZlciB0aGUgaXNfcnVubmluZyBpbmRpY2F0b3IgaXMgY2hhbmdlZC4KVXNl
IHRoYXQgbmV3IGZpZWxkIGluIHRoZSBzY2hlZHVsZXJzIGluc3RlYWQgb2YgdGhlIHNpbWlsYXIg
dmNwdSBmaWVsZC4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNv
bT4KLS0tClJGQyBWMjogZml4IGFybSBidWlsZCwgZG9uJ3QgZHJvcCB2LT5pc19ydW5uaW5nCi0t
LQogeGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYyAgfCAxMiArKysrKysrLS0tLS0KIHhlbi9jb21t
b24vc2NoZWRfY3JlZGl0Mi5jIHwgMTggKysrKysrKysrLS0tLS0tLS0tCiB4ZW4vY29tbW9uL3Nj
aGVkX3J0LmMgICAgICB8ICAyICstCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAgICB8IDE1ICsr
KysrKysrKysrLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggICAgfCAgNCArKysrCiA1IGZp
bGVzIGNoYW5nZWQsIDMyIGluc2VydGlvbnMoKyksIDE5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5j
CmluZGV4IDY5MDhlMzczZGMuLmI3MDBjYzA3Y2UgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2No
ZWRfY3JlZGl0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtNzE0LDcgKzcx
NCw3IEBAIF9fY3NjaGVkX3ZjcHVfaXNfbWlncmF0ZWFibGUoY29uc3Qgc3RydWN0IGNzY2hlZF9w
cml2YXRlICpwcnYsIHN0cnVjdCB2Y3B1ICp2YywKICAgICAgKiBUaGUgY2FsbGVyIGlzIHN1cHBv
c2VkIHRvIGhhdmUgYWxyZWFkeSBjaGVja2VkIHRoYXQgdmMgaXMgYWxzbwogICAgICAqIG5vdCBy
dW5uaW5nLgogICAgICAqLwotICAgIEFTU0VSVCghdmMtPmlzX3J1bm5pbmcpOworICAgIEFTU0VS
VCghdmMtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcpOwogCiAgICAgcmV0dXJuICFfX2NzY2hlZF92
Y3B1X2lzX2NhY2hlX2hvdChwcnYsIHZjKSAmJgogICAgICAgICAgICBjcHVtYXNrX3Rlc3RfY3B1
KGRlc3RfY3B1LCBtYXNrKTsKQEAgLTEwMzgsNyArMTAzOCw4IEBAIGNzY2hlZF91bml0X2luc2Vy
dChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQog
CiAgICAgbG9jayA9IHVuaXRfc2NoZWR1bGVfbG9ja19pcnEodW5pdCk7CiAKLSAgICBpZiAoICFf
X3ZjcHVfb25fcnVucShzdmMpICYmIHZjcHVfcnVubmFibGUodmMpICYmICF2Yy0+aXNfcnVubmlu
ZyApCisgICAgaWYgKCAhX192Y3B1X29uX3J1bnEoc3ZjKSAmJiB2Y3B1X3J1bm5hYmxlKHZjKSAm
JgorICAgICAgICAgIXZjLT5zY2hlZF91bml0LT5pc19ydW5uaW5nICkKICAgICAgICAgcnVucV9p
bnNlcnQoc3ZjKTsKIAogICAgIHVuaXRfc2NoZWR1bGVfdW5sb2NrX2lycShsb2NrLCB1bml0KTsK
QEAgLTE2NTEsOCArMTY1Miw5IEBAIGNzY2hlZF9ydW5xX3N0ZWFsKGludCBwZWVyX2NwdSwgaW50
IGNwdSwgaW50IHByaSwgaW50IGJhbGFuY2Vfc3RlcCkKICAgICAgICAgICogdkNQVXMgd2l0aCB1
c2VmdWwgc29mdCBhZmZpbml0aWVzIGluIHNvbWUgc29ydCBvZiBiaXRtYXAKICAgICAgICAgICog
b3IgY291bnRlci4KICAgICAgICAgICovCi0gICAgICAgIGlmICggdmMtPmlzX3J1bm5pbmcgfHwg
KGJhbGFuY2Vfc3RlcCA9PSBCQUxBTkNFX1NPRlRfQUZGSU5JVFkgJiYKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIWhhc19zb2Z0X2FmZmluaXR5KHZjLT5zY2hlZF91bml0KSkgKQor
ICAgICAgICBpZiAoIHZjLT5zY2hlZF91bml0LT5pc19ydW5uaW5nIHx8CisgICAgICAgICAgICAg
KGJhbGFuY2Vfc3RlcCA9PSBCQUxBTkNFX1NPRlRfQUZGSU5JVFkgJiYKKyAgICAgICAgICAgICAg
IWhhc19zb2Z0X2FmZmluaXR5KHZjLT5zY2hlZF91bml0KSkgKQogICAgICAgICAgICAgY29udGlu
dWU7CiAKICAgICAgICAgYWZmaW5pdHlfYmFsYW5jZV9jcHVtYXNrKHZjLT5zY2hlZF91bml0LCBi
YWxhbmNlX3N0ZXAsIGNwdW1hc2tfc2NyYXRjaCk7CkBAIC0xODYwLDcgKzE4NjIsNyBAQCBjc2No
ZWRfc2NoZWR1bGUoCiAgICAgICAgICAgICAgICAgICAgICh1bnNpZ25lZCBjaGFyICopJmQpOwog
ICAgIH0KIAotICAgIHJ1bnRpbWUgPSBub3cgLSBjdXJyZW50LT5ydW5zdGF0ZS5zdGF0ZV9lbnRy
eV90aW1lOworICAgIHJ1bnRpbWUgPSBub3cgLSBjdXJyZW50LT5zY2hlZF91bml0LT5zdGF0ZV9l
bnRyeV90aW1lOwogICAgIGlmICggcnVudGltZSA8IDAgKSAvKiBEb2VzIHRoaXMgZXZlciBoYXBw
ZW4/ICovCiAgICAgICAgIHJ1bnRpbWUgPSAwOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3Nj
aGVkX2NyZWRpdDIuYyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jCmluZGV4IGFlYTA1ZWRi
YjIuLmVmMjlhM2Q4NzQgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jCisr
KyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jCkBAIC0xMjgzLDcgKzEyODMsNyBAQCBydW5x
X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBjc2NoZWQyX3VuaXQg
KnN2YykKIAogICAgIEFTU0VSVCgmc3ZjLT5ycWQtPnJ1bnEgPT0gcnVucSk7CiAgICAgQVNTRVJU
KCFpc19pZGxlX3ZjcHUoc3ZjLT52Y3B1KSk7Ci0gICAgQVNTRVJUKCFzdmMtPnZjcHUtPmlzX3J1
bm5pbmcpOworICAgIEFTU0VSVCghc3ZjLT52Y3B1LT5zY2hlZF91bml0LT5pc19ydW5uaW5nKTsK
ICAgICBBU1NFUlQoIShzdmMtPmZsYWdzICYgQ1NGTEFHX3NjaGVkdWxlZCkpOwogCiAgICAgbGlz
dF9mb3JfZWFjaCggaXRlciwgcnVucSApCkBAIC0xMzQwLDggKzEzNDAsOCBAQCBzdGF0aWMgaW5s
aW5lIGJvb2wgaXNfcHJlZW1wdGFibGUoY29uc3Qgc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjLAog
ICAgIGlmICggcmF0ZWxpbWl0IDw9IENTQ0hFRDJfUkFURUxJTUlUX1RJQ0tMRV9UT0xFUkFOQ0Ug
KQogICAgICAgICByZXR1cm4gdHJ1ZTsKIAotICAgIEFTU0VSVChzdmMtPnZjcHUtPmlzX3J1bm5p
bmcpOwotICAgIHJldHVybiBub3cgLSBzdmMtPnZjcHUtPnJ1bnN0YXRlLnN0YXRlX2VudHJ5X3Rp
bWUgPgorICAgIEFTU0VSVChzdmMtPnZjcHUtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcpOworICAg
IHJldHVybiBub3cgLSBzdmMtPnZjcHUtPnNjaGVkX3VuaXQtPnN0YXRlX2VudHJ5X3RpbWUgPgog
ICAgICAgICAgICByYXRlbGltaXQgLSBDU0NIRUQyX1JBVEVMSU1JVF9USUNLTEVfVE9MRVJBTkNF
OwogfQogCkBAIC0yOTMxLDcgKzI5MzEsNyBAQCBjc2NoZWQyX2RvbV9jbnRsKAogICAgICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgc3ZjID0gY3NjaGVkMl91bml0KHYtPnNjaGVk
X3VuaXQpOwogICAgICAgICAgICAgICAgICAgICBsb2NrID0gdW5pdF9zY2hlZHVsZV9sb2NrKHN2
Yy0+dmNwdS0+c2NoZWRfdW5pdCk7Ci0gICAgICAgICAgICAgICAgICAgIGlmICggdi0+aXNfcnVu
bmluZyApCisgICAgICAgICAgICAgICAgICAgIGlmICggdi0+c2NoZWRfdW5pdC0+aXNfcnVubmlu
ZyApCiAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBjcHUgPSB2LT5wcm9jZXNzb3I7CiAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQgPSBjMnJxZChvcHMsIGNwdSk7CkBAIC0zMjA0
LDggKzMyMDQsOCBAQCBjc2NoZWQyX3J1bnRpbWUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
LCBpbnQgY3B1LAogICAgIGlmICggcHJ2LT5yYXRlbGltaXRfdXMgKQogICAgIHsKICAgICAgICAg
c190aW1lX3QgcmF0ZWxpbWl0X21pbiA9IE1JQ1JPU0VDUyhwcnYtPnJhdGVsaW1pdF91cyk7Ci0g
ICAgICAgIGlmICggc25leHQtPnZjcHUtPmlzX3J1bm5pbmcgKQotICAgICAgICAgICAgcmF0ZWxp
bWl0X21pbiA9IHNuZXh0LT52Y3B1LT5ydW5zdGF0ZS5zdGF0ZV9lbnRyeV90aW1lICsKKyAgICAg
ICAgaWYgKCBzbmV4dC0+dmNwdS0+c2NoZWRfdW5pdC0+aXNfcnVubmluZyApCisgICAgICAgICAg
ICByYXRlbGltaXRfbWluID0gc25leHQtPnZjcHUtPnNjaGVkX3VuaXQtPnN0YXRlX2VudHJ5X3Rp
bWUgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1JQ1JPU0VDUyhwcnYtPnJhdGVsaW1p
dF91cykgLSBub3c7CiAgICAgICAgIGlmICggcmF0ZWxpbWl0X21pbiA+IG1pbl90aW1lICkKICAg
ICAgICAgICAgIG1pbl90aW1lID0gcmF0ZWxpbWl0X21pbjsKQEAgLTMzMDIsNyArMzMwMiw3IEBA
IHJ1bnFfY2FuZGlkYXRlKHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwKICAgICAg
KiBubyBwb2ludCBmb3JjaW5nIGl0IHRvIGRvIHNvIHVudGlsIHJhdGUgbGltaXRpbmcgZXhwaXJl
cy4KICAgICAgKi8KICAgICBpZiAoICF5aWVsZCAmJiBwcnYtPnJhdGVsaW1pdF91cyAmJiB2Y3B1
X3J1bm5hYmxlKHNjdXJyLT52Y3B1KSAmJgotICAgICAgICAgKG5vdyAtIHNjdXJyLT52Y3B1LT5y
dW5zdGF0ZS5zdGF0ZV9lbnRyeV90aW1lKSA8CisgICAgICAgICAobm93IC0gc2N1cnItPnZjcHUt
PnNjaGVkX3VuaXQtPnN0YXRlX2VudHJ5X3RpbWUpIDwKICAgICAgICAgICBNSUNST1NFQ1MocHJ2
LT5yYXRlbGltaXRfdXMpICkKICAgICB7CiAgICAgICAgIGlmICggdW5saWtlbHkodGJfaW5pdF9k
b25lKSApCkBAIC0zMzEzLDcgKzMzMTMsNyBAQCBydW5xX2NhbmRpZGF0ZShzdHJ1Y3QgY3NjaGVk
Ml9ydW5xdWV1ZV9kYXRhICpycWQsCiAgICAgICAgICAgICB9IGQ7CiAgICAgICAgICAgICBkLmRv
bSA9IHNjdXJyLT52Y3B1LT5kb21haW4tPmRvbWFpbl9pZDsKICAgICAgICAgICAgIGQudmNwdSA9
IHNjdXJyLT52Y3B1LT52Y3B1X2lkOwotICAgICAgICAgICAgZC5ydW50aW1lID0gbm93IC0gc2N1
cnItPnZjcHUtPnJ1bnN0YXRlLnN0YXRlX2VudHJ5X3RpbWU7CisgICAgICAgICAgICBkLnJ1bnRp
bWUgPSBub3cgLSBzY3Vyci0+dmNwdS0+c2NoZWRfdW5pdC0+c3RhdGVfZW50cnlfdGltZTsKICAg
ICAgICAgICAgIF9fdHJhY2VfdmFyKFRSQ19DU0NIRUQyX1JBVEVMSU1JVCwgMSwKICAgICAgICAg
ICAgICAgICAgICAgICAgIHNpemVvZihkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICh1bnNp
Z25lZCBjaGFyICopJmQpOwpAQCAtMzU2MSw3ICszNTYxLDcgQEAgY3NjaGVkMl9zY2hlZHVsZSgK
ICAgICAgICAgaWYgKCBzbmV4dCAhPSBzY3VyciApCiAgICAgICAgIHsKICAgICAgICAgICAgIEFT
U0VSVChzbmV4dC0+cnFkID09IHJxZCk7Ci0gICAgICAgICAgICBBU1NFUlQoIXNuZXh0LT52Y3B1
LT5pc19ydW5uaW5nKTsKKyAgICAgICAgICAgIEFTU0VSVCghc25leHQtPnZjcHUtPnNjaGVkX3Vu
aXQtPmlzX3J1bm5pbmcpOwogCiAgICAgICAgICAgICBydW5xX3JlbW92ZShzbmV4dCk7CiAgICAg
ICAgICAgICBfX3NldF9iaXQoX19DU0ZMQUdfc2NoZWR1bGVkLCAmc25leHQtPmZsYWdzKTsKZGlm
ZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfcnQuYyBiL3hlbi9jb21tb24vc2NoZWRfcnQuYwpp
bmRleCBmNzgxZTQ2ZjlmLi41YjFmNjQ1OWNjIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVk
X3J0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCkBAIC05MDcsNyArOTA3LDcgQEAgcnRf
dW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5p
dCAqdW5pdCkKICAgICB7CiAgICAgICAgIHJlcGxxX2luc2VydChvcHMsIHN2Yyk7CiAKLSAgICAg
ICAgaWYgKCAhdmMtPmlzX3J1bm5pbmcgKQorICAgICAgICBpZiAoICF1bml0LT5pc19ydW5uaW5n
ICkKICAgICAgICAgICAgIHJ1bnFfaW5zZXJ0KG9wcywgc3ZjKTsKICAgICB9CiAgICAgdW5pdF9z
Y2hlZHVsZV91bmxvY2tfaXJxKGxvY2ssIHVuaXQpOwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9z
Y2hlZHVsZS5jIGIveGVuL2NvbW1vbi9zY2hlZHVsZS5jCmluZGV4IGY0YWZmNzIxMDUuLjUzYTNl
NTVmMGIgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWR1bGUuYworKysgYi94ZW4vY29tbW9u
L3NjaGVkdWxlLmMKQEAgLTM1Myw2ICszNTMsOCBAQCBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVj
dCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yKQogICAgIHsKICAgICAgICAgZ2V0X3Nj
aGVkX3Jlcyh2LT5wcm9jZXNzb3IpLT5jdXJyID0gdW5pdDsKICAgICAgICAgdi0+aXNfcnVubmlu
ZyA9IDE7CisgICAgICAgIHVuaXQtPmlzX3J1bm5pbmcgPSAxOworICAgICAgICB1bml0LT5zdGF0
ZV9lbnRyeV90aW1lID0gTk9XKCk7CiAgICAgfQogICAgIGVsc2UKICAgICB7CkBAIC02NzMsNyAr
Njc1LDggQEAgc3RhdGljIHZvaWQgdmNwdV9taWdyYXRlX2ZpbmlzaChzdHJ1Y3QgdmNwdSAqdikK
ICAgICAgKiBjb250ZXh0X3NhdmVkKCk7IGFuZCBpbiBhbnkgY2FzZSwgaWYgdGhlIGJpdCBpcyBj
bGVhcmVkLCB0aGVuCiAgICAgICogc29tZW9uZSBlbHNlIGhhcyBhbHJlYWR5IGRvbmUgdGhlIHdv
cmsgc28gd2UgZG9uJ3QgbmVlZCB0by4KICAgICAgKi8KLSAgICBpZiAoIHYtPmlzX3J1bm5pbmcg
fHwgIXRlc3RfYml0KF9WUEZfbWlncmF0aW5nLCAmdi0+cGF1c2VfZmxhZ3MpICkKKyAgICBpZiAo
IHYtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcgfHwKKyAgICAgICAgICF0ZXN0X2JpdChfVlBGX21p
Z3JhdGluZywgJnYtPnBhdXNlX2ZsYWdzKSApCiAgICAgICAgIHJldHVybjsKIAogICAgIG9sZF9j
cHUgPSBuZXdfY3B1ID0gdi0+cHJvY2Vzc29yOwpAQCAtNzI3LDcgKzczMCw3IEBAIHN0YXRpYyB2
b2lkIHZjcHVfbWlncmF0ZV9maW5pc2goc3RydWN0IHZjcHUgKnYpCiAgICAgICogYmVjYXVzZSB0
aGV5IGJvdGggaGFwcGVuIGluIChkaWZmZXJlbnQpIHNwaW5sb2NrIHJlZ2lvbnMsIGFuZCB0aG9z
ZQogICAgICAqIHJlZ2lvbnMgYXJlIHN0cmljdGx5IHNlcmlhbGlzZWQuCiAgICAgICovCi0gICAg
aWYgKCB2LT5pc19ydW5uaW5nIHx8CisgICAgaWYgKCB2LT5zY2hlZF91bml0LT5pc19ydW5uaW5n
IHx8CiAgICAgICAgICAhdGVzdF9hbmRfY2xlYXJfYml0KF9WUEZfbWlncmF0aW5nLCAmdi0+cGF1
c2VfZmxhZ3MpICkKICAgICB7CiAgICAgICAgIHNjaGVkX3NwaW5fdW5sb2NrX2RvdWJsZShvbGRf
bG9jaywgbmV3X2xvY2ssIGZsYWdzKTsKQEAgLTc1NSw3ICs3NTgsNyBAQCB2b2lkIHZjcHVfZm9y
Y2VfcmVzY2hlZHVsZShzdHJ1Y3QgdmNwdSAqdikKIHsKICAgICBzcGlubG9ja190ICpsb2NrID0g
dW5pdF9zY2hlZHVsZV9sb2NrX2lycSh2LT5zY2hlZF91bml0KTsKIAotICAgIGlmICggdi0+aXNf
cnVubmluZyApCisgICAgaWYgKCB2LT5zY2hlZF91bml0LT5pc19ydW5uaW5nICkKICAgICAgICAg
dmNwdV9taWdyYXRlX3N0YXJ0KHYpOwogCiAgICAgdW5pdF9zY2hlZHVsZV91bmxvY2tfaXJxKGxv
Y2ssIHYtPnNjaGVkX3VuaXQpOwpAQCAtMTU4Miw4ICsxNTg1LDEwIEBAIHN0YXRpYyB2b2lkIHNj
aGVkdWxlKHZvaWQpCiAgICAgICogc3dpdGNoLCBlbHNlIGxvc3RfcmVjb3JkcyByZXN1bWUgd2ls
bCBub3Qgd29yayBwcm9wZXJseS4KICAgICAgKi8KIAotICAgIEFTU0VSVCghbmV4dC0+aXNfcnVu
bmluZyk7CisgICAgQVNTRVJUKCFuZXh0LT5zY2hlZF91bml0LT5pc19ydW5uaW5nKTsKICAgICBu
ZXh0LT5pc19ydW5uaW5nID0gMTsKKyAgICBuZXh0LT5zY2hlZF91bml0LT5pc19ydW5uaW5nID0g
MTsKKyAgICBuZXh0LT5zY2hlZF91bml0LT5zdGF0ZV9lbnRyeV90aW1lID0gbm93OwogCiAgICAg
cGNwdV9zY2hlZHVsZV91bmxvY2tfaXJxKGxvY2ssIGNwdSk7CiAKQEAgLTE2MDUsNiArMTYxMCw4
IEBAIHZvaWQgY29udGV4dF9zYXZlZChzdHJ1Y3QgdmNwdSAqcHJldikKICAgICBzbXBfd21iKCk7
CiAKICAgICBwcmV2LT5pc19ydW5uaW5nID0gMDsKKyAgICBwcmV2LT5zY2hlZF91bml0LT5pc19y
dW5uaW5nID0gMDsKKyAgICBwcmV2LT5zY2hlZF91bml0LT5zdGF0ZV9lbnRyeV90aW1lID0gTk9X
KCk7CiAKICAgICAvKiBDaGVjayBmb3IgbWlncmF0aW9uIHJlcXVlc3QgL2FmdGVyLyBjbGVhcmlu
ZyBydW5uaW5nIGZsYWcuICovCiAgICAgc21wX21iKCk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS94ZW4vc2NoZWQuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCmluZGV4IGM3NmI4MWViZWYu
LjEzYmFiMjU4ZDUgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCisrKyBiL3hl
bi9pbmNsdWRlL3hlbi9zY2hlZC5oCkBAIC0yNzAsNyArMjcwLDExIEBAIHN0cnVjdCBzY2hlZF91
bml0IHsKIAogICAgIC8qIExhc3QgdGltZSB3aGVuIHVuaXQgaGFzIGJlZW4gc2NoZWR1bGVkIG91
dC4gKi8KICAgICB1aW50NjRfdCAgICAgICAgICAgICAgIGxhc3RfcnVuX3RpbWU7CisgICAgLyog
TGFzdCB0aW1lIHVuaXQgZ290IChkZS0pc2NoZWR1bGVkLiAqLworICAgIHVpbnQ2NF90ICAgICAg
ICAgICAgICAgc3RhdGVfZW50cnlfdGltZTsKIAorICAgIC8qIEN1cnJlbnRseSBydW5uaW5nIG9u
IGEgQ1BVPyAqLworICAgIGJvb2wgICAgICAgICAgICAgICAgICAgaXNfcnVubmluZzsKICAgICAv
KiBJdGVtIG5lZWRzIGFmZmluaXR5IHJlc3RvcmVkLiAqLwogICAgIGJvb2wgICAgICAgICAgICAg
ICAgICAgYWZmaW5pdHlfYnJva2VuOwogICAgIC8qIERvZXMgc29mdCBhZmZpbml0eSBhY3R1YWxs
eSBwbGF5IGEgcm9sZSAoZ2l2ZW4gaGFyZCBhZmZpbml0eSk/ICovCi0tIAoyLjE2LjQKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

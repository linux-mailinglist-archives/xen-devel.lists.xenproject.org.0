Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id A21C0BCB92
	for <lists+xen-devel@lfdr.de>; Tue, 24 Sep 2019 17:34:37 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iCmmm-00082S-7C; Tue, 24 Sep 2019 15:31:28 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Y7zL=XT=gmail.com=olekstysh@srs-us1.protection.inumbo.net>)
 id 1iCmmj-00081e-Vh
 for xen-devel@lists.xenproject.org; Tue, 24 Sep 2019 15:31:26 +0000
X-Inumbo-ID: 4e0bfc04-dee0-11e9-bf31-bc764e2007e4
Received: from mail-lf1-x141.google.com (unknown [2a00:1450:4864:20::141])
 by localhost (Halon) with ESMTPS
 id 4e0bfc04-dee0-11e9-bf31-bc764e2007e4;
 Tue, 24 Sep 2019 15:30:58 +0000 (UTC)
Received: by mail-lf1-x141.google.com with SMTP id u3so1739657lfl.10
 for <xen-devel@lists.xenproject.org>; Tue, 24 Sep 2019 08:30:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=fx31G+xE30gvwkp/PyhDSOqp0zx0pQGOVGh0hjTeTJQ=;
 b=pAhklr1xt+wXGNd+UeI1wUFdonF0bkm/xD7OXtEBWfcQv+Pw63rDEkpXKvFdOc+HSQ
 tusC46G163cMTrPe3K5Udtex0qoG33XfOkPzQ6DDFbz3ZWdXcC8tXYVf/RzLvWWgysEA
 r1t/W/7LuNuVTn0F6/n7TkMA6fynvAr5ngijtDsSjYJFL8uAW2g/YzkvlHi4q66jgYHh
 Vw+QgPDO5bJFwucbubO2HtiHWBl3Bby3qygK/tJ2w6HE1ZLIiH5EL6QWK7E/ieOhzGS7
 nrx/g2KD7iN0H6ZJN5wA48dIO93kY3dDNBTNitspm1wF6s2+u19c9TJIvdvX4nBAehqk
 BOjg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=fx31G+xE30gvwkp/PyhDSOqp0zx0pQGOVGh0hjTeTJQ=;
 b=DEMyXBRtmEROYO4deUgCakhWceCnETIiv6ZTMxiamBb2iuDNtS15o5qrVTbhjYcQRy
 KFpblZYRHXdoVjiy3NJaotbf0ZM3HpTJr4sfreDM6jvSaZvf0OkpBjb8XAiFh1OPCRuu
 wwD0Y30u+lQFVNNniefgEjq09CcmN70S4QGbXi49PglMM0VzcNOZltlta5SLrrmQCXAK
 IoPjadxNduRhK0H9PaKz1fss68/J0126FAx1JA+E+ABbEOA/5r1k1RLCWhL9agiGksnv
 sUmv5j/eGXMJjRIvbJXP3ZbCqfCqraNE6EDr9WoBeeqJOQaJkcZ1Ut73T4k+s6kMIUSZ
 dJRw==
X-Gm-Message-State: APjAAAU0CqtAX3Uvi+DQJMU7GxIVq7dNK8RXNDAl7Pgx+EJqhim0kNG0
 uVLVYxf0p6j4fcjc7FOR34/l/rX3Erc=
X-Google-Smtp-Source: APXvYqyooF/bRI+8Rcptb8sjQ+KkxYLORSBaLT7tYBi9TTv04to6CsenaRgBQTvPMz8bYxCwYmHvDg==
X-Received: by 2002:a05:6512:488:: with SMTP id
 v8mr2329190lfq.37.1569339056923; 
 Tue, 24 Sep 2019 08:30:56 -0700 (PDT)
Received: from otyshchenko.kyiv.epam.com (ll-74.141.223.85.sovam.net.ua.
 [85.223.141.74])
 by smtp.gmail.com with ESMTPSA id z128sm525818lfa.1.2019.09.24.08.30.55
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
 Tue, 24 Sep 2019 08:30:56 -0700 (PDT)
From: Oleksandr Tyshchenko <olekstysh@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 24 Sep 2019 18:30:26 +0300
Message-Id: <1569339027-19484-8-git-send-email-olekstysh@gmail.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1569339027-19484-1-git-send-email-olekstysh@gmail.com>
References: <1569339027-19484-1-git-send-email-olekstysh@gmail.com>
Subject: [Xen-devel] [PATCH V5 7/8] iommu/arm: Introduce iommu_add_dt_device
 API
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Oleksandr Tyshchenko <oleksandr_tyshchenko@epam.com>, julien.grall@arm.com,
 sstabellini@kernel.org, volodymyr_babchuk@epam.com,
 Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogT2xla3NhbmRyIFR5c2hjaGVua28gPG9sZWtzYW5kcl90eXNoY2hlbmtvQGVwYW0uY29t
PgoKVGhlIG1haW4gcHVwcm9zZSBvZiB0aGlzIHBhdGNoIGlzIHRvIGFkZCBhIHdheSB0byByZWdp
c3RlciBEVCBkZXZpY2UKKHdoaWNoIGlzIGJlaGluZCB0aGUgSU9NTVUpIHVzaW5nIHRoZSBnZW5l
cmljIElPTU1VIERUIGJpbmRpbmdzIFsxXQpiZWZvcmUgYXNzaWduaW5nIHRoYXQgZGV2aWNlIHRv
IGEgZG9tYWluLgoKU28sIHRoaXMgcGF0Y2ggYWRkcyBuZXcgImlvbW11X2FkZF9kdF9kZXZpY2Ui
IEFQSSBmb3IgYWRkaW5nIERUIGRldmljZQp0byB0aGUgSU9NTVUgdXNpbmcgZ2VuZXJpYyBJT01N
VSBEVCBiaW5kaW5ncyBhbmQgcHJldmlvdXNseSBhZGRlZAoiaW9tbXVfZndzcGVjIiBzdXBwb3J0
LiBBcyBkZXZpY2VzIGNhbiBiZSBhc3NpZ25lZCB0byB0aGUgaGFyZHdhcmUgZG9tYWluCmFuZCBv
dGhlciBkb21haW5zIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdHdvIHBsYWNlczogaGFu
ZGxlX2RldmljZSgpCmFuZCBpb21tdV9kb19kdF9kb21jdGwoKS4KCkJlc2lkZXMgdGhhdCwgdGhp
cyBwYXRjaCBhZGRzIG5ldyAiZHRfeGxhdGUiIGNhbGxiYWNrIChib3Jyb3dlZCBmcm9tCkxpbnV4
ICJvZl94bGF0ZSIpIGZvciBwcm92aWRpbmcgdGhlIGRyaXZlciB3aXRoIERUIElPTU1VIHNwZWNp
Zmllcgp3aGljaCBkZXNjcmliZXMgdGhlIElPTU1VIG1hc3RlciBpbnRlcmZhY2VzIG9mIHRoYXQg
ZGV2aWNlIChkZXZpY2UgSURzLCBldGMpLgpBY2NvcmRpbmcgdG8gdGhlIGdlbmVyaWMgSU9NTVUg
RFQgYmluZGluZ3MgdGhlIGNvbnRleHQgb2YgcmVxdWlyZWQKcHJvcGVydGllcyBmb3IgSU9NTVUg
ZGV2aWNlL21hc3RlciBub2RlICgjaW9tbXUtY2VsbHMsIGlvbW11cykgZGVwZW5kcwpvbiBtYW55
IGZhY3RvcnMgYW5kIGlzIHJlYWxseSBkcml2ZXIgZGVwZW5kZWQgdGhpbmcuCgpQbGVhc2Ugbm90
ZSwgYWxsIElPTU1VIGRyaXZlcnMgd2hpY2ggc3VwcG9ydCBnZW5lcmljIElPTU1VIERUIGJpbmRp
bmdzCnNob3VsZCB1c2UgImR0X3hsYXRlIiBhbmQgImFkZF9kZXZpY2UiIGNhbGxiYWNrcy4KClsx
XSBodHRwczovL3d3dy5rZXJuZWwub3JnL2RvYy9Eb2N1bWVudGF0aW9uL2RldmljZXRyZWUvYmlu
ZGluZ3MvaW9tbXUvaW9tbXUudHh0CgpTaWduZWQtb2ZmLWJ5OiBPbGVrc2FuZHIgVHlzaGNoZW5r
byA8b2xla3NhbmRyX3R5c2hjaGVua29AZXBhbS5jb20+CkNDOiBKdWxpZW4gR3JhbGwgPGp1bGll
bi5ncmFsbEBhcm0uY29tPgpDQzogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoKLS0t
CkNoYW5nZXMgVjQgLT4gVjU6CiAgICAgLSBhZGRlZCAiY29uc3QiIHRvIHN0cnVjdCBkdF9waGFu
ZGxlX2FyZ3MgKmFyZ3MgaW4gZHRfeGxhdGUKICAgICAtIG1vdmVkIGlvbW11X2FkZF9kdF9kZXZp
Y2UoKSB0byB4ZW4vcGFzc3Rocm91Z2gvZGV2aWNlX3RyZWUuYwogICAgIC0gbW9kaWZpZWQgbG9n
aWMsIGRvbid0IHRyeSB0byBhZGQgImFsbCIgZGV2aWNlcyB0byB0aGUgSU9NTVUKICAgICAgIHdo
ZW4gY29uc3RydWN0aW5nIERvbTAsIGJ1dCBvbmx5IGRldmljZXMgd2hpY2ggYXJlIGdvaW5nIHRv
IGJlCiAgICAgICBhc3NpZ25lZCB0byBod2RvbQogICAgIC0gdXBkYXRlZCBpb21tdV9kb19kdF9k
b21jdGwoKSB0byBjYWxsIGlvbW11X2FkZF9kdF9kZXZpY2UoKQogICAgIC0gY2xhcmlmaWVkIHBh
dGNoIGRlc2NyaXB0aW9uCiAgICAgLSByZW1vdmVkICJfX2luaXQiIGZyb20gaW9tbXVfYWRkX2R0
X2RldmljZSgpCgpDaGFuZ2VzIFYzIC0+IFY0OgogICAgIC0gc3F1YXNoZWQgd2l0aCAiaW9tbXU6
IEFkZCBvZl94bGF0ZSBjYWxsYmFjayIgcGF0Y2gKICAgICAtIHJlbmFtZWQgIm9mX3hsYXRlIiB0
byAiZHRfeGxhdGUiCiAgICAgLSByZXdvcmtlZCBwYXRjaCBkZXNjcmlwdGlvbgogICAgIC0gY2xh
cmlmaWVkIGNvbW1lbnRzIGluIGNvZGUsIHJlbW92ZWQgY29uZnVzaW5nIHdvcmQKICAgICAgICJp
bml0aWFsaXplIGRldmljZSIsIGV0YwogICAgIC0gdXBkYXRlZCBkZWJ1ZyBtZXNzYWdlIGluIGhh
bmRsZV9kZXZpY2UoKQogICAgIC0gbW9kaWZpZWQgdG8gY2hlY2sgb3BzLT5vZl94bGF0ZSBhbmQg
b3BzLT5hZGRfZGV2aWNlCiAgICAgICBvbmx5IGlmICJpb21tdXMiIHByb3BlcnR5IGlzIGV4aXN0
cwoKQ2hhbmdlcyBWMiAtPiBWMzoKICAgIC0gY2xhcmlmaWVkIHBhdGNoIGRlc2NyaXB0aW9uCiAg
ICAtIGNsYXJpZmllZCBjb21tZW50cyBpbiBjb2RlCiAgICAtIG1vZGlmaWVkIHRvIHByb3ZpZGUg
RFQgSU9NTVUgc3BlY2lmaWVyIHRvIHRoZSBkcml2ZXIKICAgICAgdXNpbmcgIm9mX3hsYXRlIiBj
YWxsYmFjawogICAgLSBkb2N1bWVudGVkIGZ1bmN0aW9uIHVzYWdlCiAgICAtIG1vZGlmaWVkIHRv
IHJldHVybiBhbiBlcnJvciBpZiBvcHMgaXMgbm90IHByZXNlbnQvaW1wbGVtZW50ZWQsCiAgICAt
IGFkZGVkIGFiaWxpdHkgdG8gcmV0dXJuIGEgcG9zc2l0aXZlIHZhbHVlIHRvIGluZGljYXRlCiAg
ICAgIHRoYXQgZGV2aWNlIGRvZXNuJ3QgbmVlZCB0byBiZSBwcm90ZWN0ZWQKICAgIC0gcmVtb3Zl
ZCBjaGVjayBmb3IgdGhlICJpb21tdSIgcHJvcGVydHkgcHJlc2VuY2UKICAgICAgaW4gdGhlIGNv
bW1vbiBjb2RlCiAgICAtIGluY2x1ZGVkIDxhc20vaW9tbXVfZndzcGVjLmg+IGRpcmVjdGx5Ci0t
LQogeGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jICAgICAgICAgICB8IDIyICsrKysrKystLS0t
CiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jIHwgNzEgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysKIHhlbi9pbmNsdWRlL3hlbi9pb21tdS5oICAgICAgICAg
ICAgICAgfCAyMSArKysrKysrKysrKwogMyBmaWxlcyBjaGFuZ2VkLCAxMDcgaW5zZXJ0aW9ucygr
KSwgNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxk
LmMgYi94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKaW5kZXggYTBmZWUxZS4uODA0ODc4OSAx
MDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCisrKyBiL3hlbi9hcmNoL2Fy
bS9kb21haW5fYnVpbGQuYwpAQCAtMTI0Myw2ICsxMjQzLDcgQEAgc3RhdGljIGludCBfX2luaXQg
bWFwX2RldmljZV9jaGlsZHJlbihzdHJ1Y3QgZG9tYWluICpkLAogICogIC0gR2l2ZSBwZXJtaXNz
aW9uIHRvIHRoZSBndWVzdCB0byBtYW5hZ2UgSVJRIGFuZCBNTUlPIHJhbmdlCiAgKiAgLSBSZXRy
aWV2ZSB0aGUgSVJRIGNvbmZpZ3VyYXRpb24gKGkuZSBlZGdlL2xldmVsKSBmcm9tIGRldmljZSB0
cmVlCiAgKiBXaGVuIHRoZSBkZXZpY2UgaXMgbm90IG1hcmtlZCBmb3IgZ3Vlc3QgcGFzc3Rocm91
Z2g6CisgKiAgLSBUcnkgdG8gY2FsbCBpb21tdV9hZGRfZHRfZGV2aWNlIHRvIHByb3RlY3QgdGhl
IGRldmljZSBieSBhbiBJT01NVQogICogIC0gQXNzaWduIHRoZSBkZXZpY2UgdG8gdGhlIGd1ZXN0
IGlmIGl0J3MgcHJvdGVjdGVkIGJ5IGFuIElPTU1VCiAgKiAgLSBNYXAgdGhlIElSUXMgYW5kIGlv
bWVtIHJlZ2lvbnMgdG8gRE9NMAogICovCkBAIC0xMjYzLDE1ICsxMjY0LDIyIEBAIHN0YXRpYyBp
bnQgX19pbml0IGhhbmRsZV9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGR0X2Rldmlj
ZV9ub2RlICpkZXYsCiAgICAgZHRfZHByaW50aygiJXMgcGFzc3Rocm91Z2ggPSAlZCBuaXJxID0g
JWQgbmFkZHIgPSAldVxuIiwKICAgICAgICAgICAgICAgIGR0X25vZGVfZnVsbF9uYW1lKGRldiks
IG5lZWRfbWFwcGluZywgbmlycSwgbmFkZHIpOwogCi0gICAgaWYgKCBkdF9kZXZpY2VfaXNfcHJv
dGVjdGVkKGRldikgJiYgbmVlZF9tYXBwaW5nICkKKyAgICBpZiAoIG5lZWRfbWFwcGluZyApCiAg
ICAgewotICAgICAgICBkdF9kcHJpbnRrKCIlcyBzZXR1cCBpb21tdVxuIiwgZHRfbm9kZV9mdWxs
X25hbWUoZGV2KSk7Ci0gICAgICAgIHJlcyA9IGlvbW11X2Fzc2lnbl9kdF9kZXZpY2UoZCwgZGV2
KTsKLSAgICAgICAgaWYgKCByZXMgKQotICAgICAgICB7Ci0gICAgICAgICAgICBwcmludGsoWEVO
TE9HX0VSUiAiRmFpbGVkIHRvIHNldHVwIHRoZSBJT01NVSBmb3IgJXNcbiIsCisgICAgICAgIGR0
X2RwcmludGsoIkNoZWNrIGlmICVzIGlzIGJlaGluZCB0aGUgSU9NTVUgYW5kIGFkZCBpdFxuIiwK
ICAgICAgICAgICAgICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKLSAgICAgICAgICAg
IHJldHVybiByZXM7CisKKyAgICAgICAgaW9tbXVfYWRkX2R0X2RldmljZShkZXYpOworICAgICAg
ICBpZiAoIGR0X2RldmljZV9pc19wcm90ZWN0ZWQoZGV2KSApCisgICAgICAgIHsKKyAgICAgICAg
ICAgIGR0X2RwcmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1bGxfbmFtZShkZXYp
KTsKKyAgICAgICAgICAgIHJlcyA9IGlvbW11X2Fzc2lnbl9kdF9kZXZpY2UoZCwgZGV2KTsKKyAg
ICAgICAgICAgIGlmICggcmVzICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBwcmlu
dGsoWEVOTE9HX0VSUiAiRmFpbGVkIHRvIHNldHVwIHRoZSBJT01NVSBmb3IgJXNcbiIsCisgICAg
ICAgICAgICAgICAgICAgICAgIGR0X25vZGVfZnVsbF9uYW1lKGRldikpOworICAgICAgICAgICAg
ICAgIHJldHVybiByZXM7CisgICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICB9CiAKZGlmZiAt
LWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVlLmMgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jCmluZGV4IDNmMzI4ZjQuLjBmZDI0ODggMTAwNjQ0
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVlLmMKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvZGV2aWNlX3RyZWUuYwpAQCAtMjIsNiArMjIsOCBAQAogI2luY2x1
ZGUgPHhlbi9zY2hlZC5oPgogI2luY2x1ZGUgPHhzbS94c20uaD4KIAorI2luY2x1ZGUgPGFzbS9p
b21tdV9md3NwZWMuaD4KKwogc3RhdGljIHNwaW5sb2NrX3QgZHRkZXZzX2xvY2sgPSBTUElOX0xP
Q0tfVU5MT0NLRUQ7CiAKIGludCBpb21tdV9hc3NpZ25fZHRfZGV2aWNlKHN0cnVjdCBkb21haW4g
KmQsIHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqZGV2KQpAQCAtMTM2LDYgKzEzOCw2OCBAQCBpbnQg
aW9tbXVfcmVsZWFzZV9kdF9kZXZpY2VzKHN0cnVjdCBkb21haW4gKmQpCiAgICAgcmV0dXJuIDA7
CiB9CiAKK2ludCBpb21tdV9hZGRfZHRfZGV2aWNlKHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqbnAp
Cit7CisgICAgY29uc3Qgc3RydWN0IGlvbW11X29wcyAqb3BzID0gaW9tbXVfZ2V0X29wcygpOwor
ICAgIHN0cnVjdCBkdF9waGFuZGxlX2FyZ3MgaW9tbXVfc3BlYzsKKyAgICBzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSBkdF90b19kZXYobnApOworICAgIGludCByYyA9IDEsIGluZGV4ID0gMDsKKworICAg
IGlmICggIWlvbW11X2VuYWJsZWQgKQorICAgICAgICByZXR1cm4gMTsKKworICAgIGlmICggIW9w
cyApCisgICAgICAgIHJldHVybiAtRUlOVkFMOworCisgICAgaWYgKCBkZXZfaW9tbXVfZndzcGVj
X2dldChkZXYpICkKKyAgICAgICAgcmV0dXJuIC1FRVhJU1Q7CisKKyAgICAvKgorICAgICAqIEFj
Y29yZGluZyB0byB0aGUgRG9jdW1lbnRhdGlvbi9kZXZpY2V0cmVlL2JpbmRpbmdzL2lvbW11L2lv
bW11LnR4dAorICAgICAqIGZyb20gTGludXguCisgICAgICovCisgICAgd2hpbGUgKCAhZHRfcGFy
c2VfcGhhbmRsZV93aXRoX2FyZ3MobnAsICJpb21tdXMiLCAiI2lvbW11LWNlbGxzIiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwgJmlvbW11X3NwZWMpICkK
KyAgICB7CisgICAgICAgIC8qCisgICAgICAgICAqIFRoZSBkcml2ZXIgd2hpY2ggc3VwcG9ydHMg
Z2VuZXJpYyBJT01NVSBEVCBiaW5kaW5ncyBtdXN0IGhhdmUKKyAgICAgICAgICogdGhlc2UgY2Fs
bGJhY2sgaW1wbGVtZW50ZWQuCisgICAgICAgICAqLworICAgICAgICBpZiAoICFvcHMtPmFkZF9k
ZXZpY2UgfHwgIW9wcy0+ZHRfeGxhdGUgKQorICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisK
KyAgICAgICAgaWYgKCAhZHRfZGV2aWNlX2lzX2F2YWlsYWJsZShpb21tdV9zcGVjLm5wKSApCisg
ICAgICAgICAgICBicmVhazsKKworICAgICAgICByYyA9IGlvbW11X2Z3c3BlY19pbml0KGRldiwg
JmlvbW11X3NwZWMubnAtPmRldik7CisgICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgYnJl
YWs7CisKKyAgICAgICAgLyoKKyAgICAgICAgICogUHJvdmlkZSBEVCBJT01NVSBzcGVjaWZpZXIg
d2hpY2ggZGVzY3JpYmVzIHRoZSBJT01NVSBtYXN0ZXIKKyAgICAgICAgICogaW50ZXJmYWNlcyBv
ZiB0aGF0IGRldmljZSAoZGV2aWNlIElEcywgZXRjKSB0byB0aGUgZHJpdmVyLgorICAgICAgICAg
KiBUaGUgZHJpdmVyIGlzIHJlc3BvbnNpYmxlIHRvIGRlY2lkZSBob3cgdG8gaW50ZXJwcmV0IHRo
ZW0uCisgICAgICAgICAqLworICAgICAgICByYyA9IG9wcy0+ZHRfeGxhdGUoZGV2LCAmaW9tbXVf
c3BlYyk7CisgICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAg
aW5kZXgrKzsKKyAgICB9CisKKyAgICAvKgorICAgICAqIEFkZCBtYXN0ZXIgZGV2aWNlIHRvIHRo
ZSBJT01NVSBpZiBsYXR0ZXIgaXMgcHJlc2VudCBhbmQgYXZhaWxhYmxlLgorICAgICAqIFRoZSBk
cml2ZXIgaXMgcmVzcG9uc2libGUgdG8gbWFyayB0aGF0IGRldmljZSBhcyBwcm90ZWN0ZWQuCisg
ICAgICovCisgICAgaWYgKCAhcmMgKQorICAgICAgICByYyA9IG9wcy0+YWRkX2RldmljZSgwLCBk
ZXYpOworCisgICAgaWYgKCByYyA8IDAgKQorICAgICAgICBpb21tdV9md3NwZWNfZnJlZShkZXYp
OworCisgICAgcmV0dXJuIHJjOworfQorCiBpbnQgaW9tbXVfZG9fZHRfZG9tY3RsKHN0cnVjdCB4
ZW5fZG9tY3RsICpkb21jdGwsIHN0cnVjdCBkb21haW4gKmQsCiAgICAgICAgICAgICAgICAgICAg
ICAgIFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0oeGVuX2RvbWN0bF90KSB1X2RvbWN0bCkKIHsKQEAg
LTE3Nyw2ICsyNDEsMTMgQEAgaW50IGlvbW11X2RvX2R0X2RvbWN0bChzdHJ1Y3QgeGVuX2RvbWN0
bCAqZG9tY3RsLCBzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg
IH0KIAorICAgICAgICBpb21tdV9hZGRfZHRfZGV2aWNlKGRldik7CisgICAgICAgIGlmICggIWR0
X2RldmljZV9pc19wcm90ZWN0ZWQoZGV2KSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHJldCA9
IC1FSU5WQUw7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorCiAgICAgICAgIHJldCA9
IGlvbW11X2Fzc2lnbl9kdF9kZXZpY2UoZCwgZGV2KTsKIAogICAgICAgICBpZiAoIHJldCApCmRp
ZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vaW9tbXUuaCBiL3hlbi9pbmNsdWRlL3hlbi9pb21t
dS5oCmluZGV4IGM1ZWQ3ZWYuLjJkMWNjNmUgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9p
b21tdS5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9pb21tdS5oCkBAIC0xODYsNiArMTg2LDE3IEBA
IGludCBpb21tdV9kZWFzc2lnbl9kdF9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGR0
X2RldmljZV9ub2RlICpkZXYpOwogaW50IGlvbW11X2R0X2RvbWFpbl9pbml0KHN0cnVjdCBkb21h
aW4gKmQpOwogaW50IGlvbW11X3JlbGVhc2VfZHRfZGV2aWNlcyhzdHJ1Y3QgZG9tYWluICpkKTsK
IAorLyoKKyAqIEhlbHBlciB0byBhZGQgbWFzdGVyIGRldmljZSB0byB0aGUgSU9NTVUgdXNpbmcg
Z2VuZXJpYyBJT01NVSBEVCBiaW5kaW5ncy4KKyAqCisgKiBSZXR1cm4gdmFsdWVzOgorICogIDAg
OiBkZXZpY2UgaXMgcHJvdGVjdGVkIGJ5IGFuIElPTU1VCisgKiA8MCA6IGRldmljZSBpcyBub3Qg
cHJvdGVjdGVkIGJ5IGFuIElPTU1VLCBidXQgbXVzdCBiZSAoZXJyb3IgY29uZGl0aW9uKQorICog
PjAgOiBkZXZpY2UgZG9lc24ndCBuZWVkIHRvIGJlIHByb3RlY3RlZCBieSBhbiBJT01NVQorICog
ICAgICAoSU9NTVUgaXMgbm90IGVuYWJsZWQvcHJlc2VudCBvciBkZXZpY2UgaXMgbm90IGNvbm5l
Y3RlZCB0byBpdCkuCisgKi8KK2ludCBpb21tdV9hZGRfZHRfZGV2aWNlKHN0cnVjdCBkdF9kZXZp
Y2Vfbm9kZSAqbnApOworCiBpbnQgaW9tbXVfZG9fZHRfZG9tY3RsKHN0cnVjdCB4ZW5fZG9tY3Rs
ICosIHN0cnVjdCBkb21haW4gKiwKICAgICAgICAgICAgICAgICAgICAgICAgWEVOX0dVRVNUX0hB
TkRMRV9QQVJBTSh4ZW5fZG9tY3RsX3QpKTsKIApAQCAtMjU0LDYgKzI2NSwxNiBAQCBzdHJ1Y3Qg
aW9tbXVfb3BzIHsKICAgICBpbnQgX19tdXN0X2NoZWNrICgqaW90bGJfZmx1c2hfYWxsKShzdHJ1
Y3QgZG9tYWluICpkKTsKICAgICBpbnQgKCpnZXRfcmVzZXJ2ZWRfZGV2aWNlX21lbW9yeSkoaW9t
bXVfZ3JkbV90ICosIHZvaWQgKik7CiAgICAgdm9pZCAoKmR1bXBfcDJtX3RhYmxlKShzdHJ1Y3Qg
ZG9tYWluICpkKTsKKworI2lmZGVmIENPTkZJR19IQVNfREVWSUNFX1RSRUUKKyAgICAvKgorICAg
ICAqIEFsbCBJT01NVSBkcml2ZXJzIHdoaWNoIHN1cHBvcnQgZ2VuZXJpYyBJT01NVSBEVCBiaW5k
aW5ncyBzaG91bGQgdXNlCisgICAgICogdGhpcyBjYWxsYmFjay4gVGhpcyBpcyBhIHdheSBmb3Ig
dGhlIGZyYW1ld29yayB0byBwcm92aWRlIHRoZSBkcml2ZXIKKyAgICAgKiB3aXRoIERUIElPTU1V
IHNwZWNpZmllciB3aGljaCBkZXNjcmliZXMgdGhlIElPTU1VIG1hc3RlciBpbnRlcmZhY2VzIG9m
CisgICAgICogdGhhdCBkZXZpY2UgKGRldmljZSBJRHMsIGV0YykuCisgICAgICovCisgICAgaW50
ICgqZHRfeGxhdGUpKGRldmljZV90ICpkZXYsIGNvbnN0IHN0cnVjdCBkdF9waGFuZGxlX2FyZ3Mg
KmFyZ3MpOworI2VuZGlmCiB9OwogCiAjaW5jbHVkZSA8YXNtL2lvbW11Lmg+Ci0tIAoyLjcuNAoK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZl
bCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlz
dHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

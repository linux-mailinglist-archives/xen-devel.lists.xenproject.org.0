Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id A53E6B2AA0
	for <lists+xen-devel@lfdr.de>; Sat, 14 Sep 2019 10:56:12 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i93oA-0007vx-DH; Sat, 14 Sep 2019 08:53:30 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=rDpt=XJ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1i93o8-0007uL-Kz
 for xen-devel@lists.xenproject.org; Sat, 14 Sep 2019 08:53:28 +0000
X-Inumbo-ID: 0ddb36ec-d6cd-11e9-95c1-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 0ddb36ec-d6cd-11e9-95c1-12813bfff9fa;
 Sat, 14 Sep 2019 08:53:00 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id DD27DB662;
 Sat, 14 Sep 2019 08:52:58 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 14 Sep 2019 10:52:16 +0200
Message-Id: <20190914085251.18816-13-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190914085251.18816-1-jgross@suse.com>
References: <20190914085251.18816-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v3 12/47] xen/sched: switch struct task_slice
 from vcpu to sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TGV0IHRoZSBzY2hlZHVsZXJzIHB1dCBhIHNjaGVkX3VuaXQgcG9pbnRlciBpbnRvIHN0cnVjdCB0
YXNrX3NsaWNlCmluc3RlYWQgb2YgYSB2Y3B1IHBvaW50ZXIuCgpTaWduZWQtb2ZmLWJ5OiBKdWVy
Z2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+Ci0tLQogeGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1
My5jIHwgIDggKysrKy0tLS0KIHhlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMgICB8ICA0ICsrLS0K
IHhlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jICB8ICA0ICsrLS0KIHhlbi9jb21tb24vc2NoZWRf
bnVsbC5jICAgICB8IDEyICsrKysrKy0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9ydC5jICAgICAg
IHwgIDIgKy0KIHhlbi9jb21tb24vc2NoZWR1bGUuYyAgICAgICB8ICA0ICsrLS0KIHhlbi9pbmNs
dWRlL3hlbi9zY2hlZC1pZi5oICB8ICA2ICsrKy0tLQogNyBmaWxlcyBjaGFuZ2VkLCAyMCBpbnNl
cnRpb25zKCspLCAyMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVk
X2FyaW5jNjUzLmMgYi94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMKaW5kZXggOThjZGQ3Zjg5
NC4uNmFlNTkyNDk4MCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jCisr
KyBiL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYwpAQCAtNTU0LDkgKzU1NCw5IEBAIGE2NTNz
Y2hlZF9kb19zY2hlZHVsZSgKIAogICAgIC8qCiAgICAgICogSWYgdGhlcmUgYXJlIG1vcmUgZG9t
YWlucyB0byBydW4gaW4gdGhlIGN1cnJlbnQgbWFqb3IgZnJhbWUsIHNldAotICAgICAqIG5ld190
YXNrIGVxdWFsIHRvIHRoZSBhZGRyZXNzIG9mIG5leHQgZG9tYWluJ3MgVkNQVSBzdHJ1Y3R1cmUu
Ci0gICAgICogT3RoZXJ3aXNlLCBzZXQgbmV3X3Rhc2sgZXF1YWwgdG8gdGhlIGFkZHJlc3Mgb2Yg
dGhlIGlkbGUgdGFzaydzIFZDUFUKLSAgICAgKiBzdHJ1Y3R1cmUuCisgICAgICogbmV3X3Rhc2sg
ZXF1YWwgdG8gdGhlIGFkZHJlc3Mgb2YgbmV4dCBkb21haW4ncyBzY2hlZF91bml0IHN0cnVjdHVy
ZS4KKyAgICAgKiBPdGhlcndpc2UsIHNldCBuZXdfdGFzayBlcXVhbCB0byB0aGUgYWRkcmVzcyBv
ZiB0aGUgaWRsZSB0YXNrJ3MKKyAgICAgKiBzY2hlZF91bml0IHN0cnVjdHVyZS4KICAgICAgKi8K
ICAgICBuZXdfdGFzayA9IChzY2hlZF9pbmRleCA8IHNjaGVkX3ByaXYtPm51bV9zY2hlZHVsZV9l
bnRyaWVzKQogICAgICAgICA/IHNjaGVkX3ByaXYtPnNjaGVkdWxlW3NjaGVkX2luZGV4XS52YwpA
QCAtNTkyLDcgKzU5Miw3IEBAIGE2NTNzY2hlZF9kb19zY2hlZHVsZSgKICAgICAgKiBvZiB0aGUg
c2VsZWN0ZWQgdGFzaydzIFZDUFUgc3RydWN0dXJlLgogICAgICAqLwogICAgIHJldC50aW1lID0g
bmV4dF9zd2l0Y2hfdGltZSAtIG5vdzsKLSAgICByZXQudGFzayA9IG5ld190YXNrOworICAgIHJl
dC50YXNrID0gbmV3X3Rhc2stPnNjaGVkX3VuaXQ7CiAgICAgcmV0Lm1pZ3JhdGVkID0gMDsKIAog
ICAgIEJVR19PTihyZXQudGltZSA8PSAwKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRf
Y3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4IGU0MzBjNGVmYTQuLjJi
ZjExYjA2MTYgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKKysrIGIveGVu
L2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtMTk5Myw5ICsxOTkzLDkgQEAgb3V0OgogICAgICAq
LwogICAgIHJldC50aW1lID0gKGlzX2lkbGVfdmNwdShzbmV4dC0+dmNwdSkgPwogICAgICAgICAg
ICAgICAgIC0xIDogdHNsaWNlKTsKLSAgICByZXQudGFzayA9IHNuZXh0LT52Y3B1OworICAgIHJl
dC50YXNrID0gc25leHQtPnZjcHUtPnNjaGVkX3VuaXQ7CiAKLSAgICBDU0NIRURfVkNQVV9DSEVD
SyhyZXQudGFzayk7CisgICAgQ1NDSEVEX1ZDUFVfQ0hFQ0socmV0LnRhc2stPnZjcHVfbGlzdCk7
CiAgICAgcmV0dXJuIHJldDsKIH0KIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9jcmVk
aXQyLmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwppbmRleCBkODJiN2E5Yzc1Li45MTA0
NDBkNWQ5IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYworKysgYi94ZW4v
Y29tbW9uL3NjaGVkX2NyZWRpdDIuYwpAQCAtMzYzNyw5ICszNjM3LDkgQEAgY3NjaGVkMl9zY2hl
ZHVsZSgKICAgICAgKiBSZXR1cm4gdGFzayB0byBydW4gbmV4dC4uLgogICAgICAqLwogICAgIHJl
dC50aW1lID0gY3NjaGVkMl9ydW50aW1lKG9wcywgY3B1LCBzbmV4dCwgbm93KTsKLSAgICByZXQu
dGFzayA9IHNuZXh0LT52Y3B1OworICAgIHJldC50YXNrID0gc25leHQtPnZjcHUtPnNjaGVkX3Vu
aXQ7CiAKLSAgICBDU0NIRUQyX1ZDUFVfQ0hFQ0socmV0LnRhc2spOworICAgIENTQ0hFRDJfVkNQ
VV9DSEVDSyhyZXQudGFzay0+dmNwdV9saXN0KTsKICAgICByZXR1cm4gcmV0OwogfQogCmRpZmYg
LS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX251bGwuYyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5j
CmluZGV4IDY2ZjgzODdmMTEuLjYzZWUxZjU0MzkgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2No
ZWRfbnVsbC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCkBAIC04MTksMTAgKzgxOSwx
MCBAQCBzdGF0aWMgc3RydWN0IHRhc2tfc2xpY2UgbnVsbF9zY2hlZHVsZShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsCiAgICAgaWYgKCB0YXNrbGV0X3dvcmtfc2NoZWR1bGVkICkKICAgICB7
CiAgICAgICAgIHRyYWNlX3ZhcihUUkNfU05VTExfVEFTS0xFVCwgMSwgMCwgTlVMTCk7Ci0gICAg
ICAgIHJldC50YXNrID0gaWRsZV92Y3B1W2NwdV07CisgICAgICAgIHJldC50YXNrID0gaWRsZV92
Y3B1W2NwdV0tPnNjaGVkX3VuaXQ7CiAgICAgfQogICAgIGVsc2UKLSAgICAgICAgcmV0LnRhc2sg
PSBwZXJfY3B1KG5wYywgY3B1KS52Y3B1OworICAgICAgICByZXQudGFzayA9IHBlcl9jcHUobnBj
LCBjcHUpLnZjcHUtPnNjaGVkX3VuaXQ7CiAgICAgcmV0Lm1pZ3JhdGVkID0gMDsKICAgICByZXQu
dGltZSA9IC0xOwogCkBAIC04NTcsNyArODU3LDcgQEAgc3RhdGljIHN0cnVjdCB0YXNrX3NsaWNl
IG51bGxfc2NoZWR1bGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAogICAgICAgICAgICAg
ICAgIHsKICAgICAgICAgICAgICAgICAgICAgdmNwdV9hc3NpZ24ocHJ2LCB3dmMtPnZjcHUsIGNw
dSk7CiAgICAgICAgICAgICAgICAgICAgIGxpc3RfZGVsX2luaXQoJnd2Yy0+d2FpdHFfZWxlbSk7
Ci0gICAgICAgICAgICAgICAgICAgIHJldC50YXNrID0gd3ZjLT52Y3B1OworICAgICAgICAgICAg
ICAgICAgICByZXQudGFzayA9IHd2Yy0+dmNwdS0+c2NoZWRfdW5pdDsKICAgICAgICAgICAgICAg
ICAgICAgZ290byB1bmxvY2s7CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgfQpAQCAt
ODY5LDEwICs4NjksMTAgQEAgc3RhdGljIHN0cnVjdCB0YXNrX3NsaWNlIG51bGxfc2NoZWR1bGUo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAogICAgICAgICAgICAgY3B1bWFza19zZXRfY3B1
KGNwdSwgJnBydi0+Y3B1c19mcmVlKTsKICAgICB9CiAKLSAgICBpZiAoIHVubGlrZWx5KHJldC50
YXNrID09IE5VTEwgfHwgIXZjcHVfcnVubmFibGUocmV0LnRhc2spKSApCi0gICAgICAgIHJldC50
YXNrID0gaWRsZV92Y3B1W2NwdV07CisgICAgaWYgKCB1bmxpa2VseShyZXQudGFzayA9PSBOVUxM
IHx8ICF1bml0X3J1bm5hYmxlKHJldC50YXNrKSkgKQorICAgICAgICByZXQudGFzayA9IGlkbGVf
dmNwdVtjcHVdLT5zY2hlZF91bml0OwogCi0gICAgTlVMTF9WQ1BVX0NIRUNLKHJldC50YXNrKTsK
KyAgICBOVUxMX1ZDUFVfQ0hFQ0socmV0LnRhc2stPnZjcHVfbGlzdCk7CiAgICAgcmV0dXJuIHJl
dDsKIH0KIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9ydC5jIGIveGVuL2NvbW1vbi9z
Y2hlZF9ydC5jCmluZGV4IGNkNDIyM2ZmZDYuLjhiNWFlMTU5YjIgMTAwNjQ0Ci0tLSBhL3hlbi9j
b21tb24vc2NoZWRfcnQuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX3J0LmMKQEAgLTExMzAsNyAr
MTEzMCw3IEBAIHJ0X3NjaGVkdWxlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc190aW1l
X3Qgbm93LCBib29sX3QgdGFza2xldF93b3JrX3NjaGVkCiAgICAgICAgIH0KICAgICAgICAgcmV0
LnRpbWUgPSBzbmV4dC0+Y3VyX2J1ZGdldDsgLyogaW52b2tlIHRoZSBzY2hlZHVsZXIgbmV4dCB0
aW1lICovCiAgICAgfQotICAgIHJldC50YXNrID0gc25leHQtPnZjcHU7CisgICAgcmV0LnRhc2sg
PSBzbmV4dC0+dmNwdS0+c2NoZWRfdW5pdDsKIAogICAgIHJldHVybiByZXQ7CiB9CmRpZmYgLS1n
aXQgYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKaW5kZXgg
MTUyYjc2Y2NkNi4uOTJhNzRiNzMxYiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZHVsZS5j
CisrKyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwpAQCAtMTE1LDcgKzExNSw3IEBAIHN0YXRpYyBz
dHJ1Y3QgdGFza19zbGljZSBzY2hlZF9pZGxlX3NjaGVkdWxlKAogICAgIGNvbnN0IHVuc2lnbmVk
IGludCBjcHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7CiAgICAgc3RydWN0IHRhc2tfc2xpY2UgcmV0
ID0geyAudGltZSA9IC0xIH07CiAKLSAgICByZXQudGFzayA9IGlkbGVfdmNwdVtjcHVdOworICAg
IHJldC50YXNrID0gc2NoZWRfaWRsZV91bml0KGNwdSk7CiAgICAgcmV0dXJuIHJldDsKIH0KIApA
QCAtMTYyNiw3ICsxNjI2LDcgQEAgc3RhdGljIHZvaWQgc2NoZWR1bGUodm9pZCkKICAgICBzY2hl
ZCA9IHRoaXNfY3B1KHNjaGVkdWxlcik7CiAgICAgbmV4dF9zbGljZSA9IHNjaGVkLT5kb19zY2hl
ZHVsZShzY2hlZCwgbm93LCB0YXNrbGV0X3dvcmtfc2NoZWR1bGVkKTsKIAotICAgIG5leHQgPSBu
ZXh0X3NsaWNlLnRhc2s7CisgICAgbmV4dCA9IG5leHRfc2xpY2UudGFzay0+dmNwdV9saXN0Owog
CiAgICAgc2QtPmN1cnIgPSBuZXh0LT5zY2hlZF91bml0OwogCmRpZmYgLS1naXQgYS94ZW4vaW5j
bHVkZS94ZW4vc2NoZWQtaWYuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCmluZGV4IGZh
M2NhNTFhOTAuLmQ2MjRiODFlNTMgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1p
Zi5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCkBAIC0xOTIsOSArMTkyLDkgQEAg
c3RhdGljIGlubGluZSBzcGlubG9ja190ICpwY3B1X3NjaGVkdWxlX3RyeWxvY2sodW5zaWduZWQg
aW50IGNwdSkKIH0KIAogc3RydWN0IHRhc2tfc2xpY2UgewotICAgIHN0cnVjdCB2Y3B1ICp0YXNr
OwotICAgIHNfdGltZV90ICAgICB0aW1lOwotICAgIGJvb2xfdCAgICAgICBtaWdyYXRlZDsKKyAg
ICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdGFzazsKKyAgICBzX3RpbWVfdCAgICAgICAgICAgdGltZTsK
KyAgICBib29sX3QgICAgICAgICAgICAgbWlncmF0ZWQ7CiB9OwogCiBzdHJ1Y3Qgc2NoZWR1bGVy
IHsKLS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=

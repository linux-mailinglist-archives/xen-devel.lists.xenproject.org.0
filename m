Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4DA8CFC6FE
	for <lists+xen-devel@lfdr.de>; Thu, 14 Nov 2019 14:10:18 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVErE-0007cH-Me; Thu, 14 Nov 2019 13:08:20 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=KGQC=ZG=amazon.de=prvs=2141b557b=wipawel@srs-us1.protection.inumbo.net>)
 id 1iVErC-0007aa-Gu
 for xen-devel@lists.xenproject.org; Thu, 14 Nov 2019 13:08:18 +0000
X-Inumbo-ID: cfa2b6fa-06df-11ea-a24c-12813bfff9fa
Received: from smtp-fw-6002.amazon.com (unknown [52.95.49.90])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id cfa2b6fa-06df-11ea-a24c-12813bfff9fa;
 Thu, 14 Nov 2019 13:08:11 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1573736892; x=1605272892;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=hM1NDkB9pTlCGJAiPycnc9NOLLKj7kwlO17KP0MSueM=;
 b=FFsFTCSC/fVKboL8LrkFCH13pUhtesr6zbZWBDwuKwjcGu7CN4uDKVx3
 g21zKz2xMdvl3m5yPwZRR3k7+WehDvciYtiHIheVh6ExZQICwPaqpwD2d
 GlxuOULjtxXUgVbGKz7wjDRY7s8evubLCm3bV4xNSBkaO3h1oxQuPU8Ol g=;
IronPort-SDR: tPsGtShfLgDZtNNLZs1P7MwqYlv6Qqh6ZVT2L5AOxqgEkf+s/VoVcwlcSyz1uATQoGR96u/+G9
 Z+Ni3cpOsZ5A==
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1d-5dd976cd.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-6002.iad6.amazon.com with ESMTP;
 14 Nov 2019 13:08:12 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-5dd976cd.us-east-1.amazon.com (Postfix) with ESMTPS
 id BF74DA2C0F; Thu, 14 Nov 2019 13:08:08 +0000 (UTC)
Received: from EX13D03EUA002.ant.amazon.com (10.43.165.166) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 14 Nov 2019 13:07:56 +0000
Received: from EX13MTAUWA001.ant.amazon.com (10.43.160.58) by
 EX13D03EUA002.ant.amazon.com (10.43.165.166) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 14 Nov 2019 13:07:55 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.160.118) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Thu, 14 Nov 2019 13:07:51 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 14 Nov 2019 13:06:52 +0000
Message-ID: <20191114130653.51185-12-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20191114130653.51185-1-wipawel@amazon.de>
References: <20191114130653.51185-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v5 11/12] livepatch: Add metadata runtime
 retrieval mechanism
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>, Andrew
 Cooper <andrew.cooper3@citrix.com>, Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Pawel Wieczorkiewicz <wipawel@amazon.de>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RXh0ZW5kIHRoZSBsaXZlcGF0Y2ggbGlzdCBvcGVyYXRpb24gdG8gZmV0Y2ggYWxzbyBwYXlsb2Fk
cycgbWV0YWRhdGEuClRoaXMgaXMgYWNoaWV2ZWQgYnkgZXh0ZW5kaW5nIHRoZSBzeXNjdGwgbGlz
dCBpbnRlcmZhY2Ugd2l0aCAyIGV4dHJhCmd1ZXN0IGhhbmRsZXM6CiogbWV0YWRhdGEgICAgIC0g
YW4gYXJyYXkgb2YgYXJiaXRyYXJ5IHNpemUgc3RyaW5ncwoqIG1ldGFkYXRhX2xlbiAtIGFuIGFy
cmF5IG9mIG1ldGFkYXRhIHN0cmluZ3MnIGxlbmd0aHMgKHVpbjMyX3QgZWFjaCkKClBheWxvYWRz
JyBtZXRhZGF0YSBpcyBhIHN0cmluZyBvZiBhcmJpdHJhcnkgc2l6ZSBhbmQgZG9lcyBub3QgaGF2
ZSBhbgp1cHBlciBib3VuZCBsaW1pdC4gSXQgbWF5IGFsc28gdmFyeSBpbiBzaXplIGJldHdlZW4g
cGF5bG9hZHMuCgpJbiBvcmRlciB0byBsZXQgdGhlIHVzZXJsYW5kIGFsbG9jYXRlIGVub3VnaCBz
cGFjZSBmb3IgdGhlIGluY29taW5nCmRhdGEgYWRkIGEgbWV0YWRhdGEgdG90YWwgc2l6ZSBmaWVs
ZCB0byB0aGUgbGlzdCBzeXNjdGwgb3BlcmF0aW9uIGFuZApmaWxsIGl0IHdpdGggdG90YWwgc2l6
ZSBvZiBhbGwgcGF5bG9hZHMnIG1ldGFkYXRhLgoKRXh0ZW5kIHRoZSBsaWJ4YyB0byBoYW5kbGUg
dGhlIG1ldGFkYXRhIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycwphcyB3ZWxsIGFzIG1ldGFk
YXRhIGxlbmd0aCBhcnJheSBkYXRhIHRyYW5zZmVycy4KClRoZSB4ZW4tbGl2ZXBhdGNoIHVzZXJs
YW5kIHRvb2wgaXMgZXh0ZW5kZWQgdG8gYWx3YXlzIGRpc3BsYXkgdGhlCm1ldGFkYXRhIGZvciBl
YWNoIHJlY2VpdmVkIG1vZHVsZS4gVGhlIG1ldGFkYXRhIGlzIHJlY2VpdmVkIHdpdGggdGhlCmZv
bGxvd2luZyBmb3JtYXQ6IGtleT12YWx1ZVwwa2V5PXZhbHVlXDAuLi5rZXk9dmFsdWVcMC4gVGhl
IGZvcm1hdCBpcwptb2RpZmllZCB0byB0aGUgZm9sbG93aW5nIG9uZToga2V5PXZhbHVlO2tleT12
YWx1ZTsuLi5rZXk9dmFsdWUuClRoZSBuZXcgZm9ybWF0IGFsbG93cyB0byBlYXNpbHkgcGFyc2Ug
dGhlIG1ldGFkYXRhIGZvciBhIGdpdmVuIG1vZHVsZQpieSBhIG1hY2hpbmUuCgpTaWduZWQtb2Zm
LWJ5OiBQYXdlbCBXaWVjem9ya2lld2ljeiA8d2lwYXdlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5
OiBBbmRyYS1JcmluYSBQYXJhc2NoaXYgPGFuZHJhcHJzQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5
OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTm9yYmVy
dCBNYW50aGV5IDxubWFudGhleUBhbWF6b24uZGU+ClNpZ25lZC1vZmYtYnk6IEtvbnJhZCBSemVz
enV0ZWsgV2lsayA8a29ucmFkLndpbGtAb3JhY2xlLmNvbT4KLS0tCkNoYW5nZWQgc2luY2UgdjQ6
CiAqIGFkZCAncGFkJyBmaWVsZCB0byBsaXN0IHN5c2N0bAoKQ2hhbmdlZCBzaW5jZSB2MzoKICAq
IHVzZSB1aW50MzJfdCBpbnN0ZWFkIG9mIHVpbnQ2NF90IGFuZCBvZmZfdCBmb3IKICAgIG1ldGFk
YXRhX3RvdGFsX3NpemUgYW5kIHJlbGF0ZWQgdmFyaWFibGVzCgpDaGFuZ2VkIHNpbmNlIHYxOgog
ICogYWRkZWQgY29ycmVzcG9uZGluZyBkb2N1bWVudGF0aW9uCiAgKiBtYWtlIG1ldGFkYXRhIG9w
dGlvbmFsIChkbyBub3QgZGlzcGxheSBpdCB3aGVuIGdpdmVuIHBheWxvYWQKICAgIGRvZXMgbm90
IGhhdmUgaXQpCi0tLQogZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MgICAgfCAzMyArKysrKysr
KysrKysrKysrKy0tLS0tCiB0b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaCB8IDIyICsrKysr
KysrKysrLS0tLQogdG9vbHMvbGlieGMveGNfbWlzYy5jICAgICAgICAgfCA2NCArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tCiB0b29scy9taXNjL3hlbi1saXZlcGF0
Y2guYyAgICB8IDQxICsrKysrKysrKysrKysrKysrKysrKy0tLS0tLQogeGVuL2NvbW1vbi9saXZl
cGF0Y2guYyAgICAgICAgfCAyNSArKysrKysrKysrKysrLS0tLQogeGVuL2luY2x1ZGUvcHVibGlj
L3N5c2N0bC5oICAgfCAyMCArKysrKysrKysrLS0tLQogNiBmaWxlcyBjaGFuZ2VkLCAxNjIgaW5z
ZXJ0aW9ucygrKSwgNDMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNjL2xpdmVw
YXRjaC5wYW5kb2MgYi9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwppbmRleCA0M2QwODk2YWE4
Li4yZjNmOTVlZDM3IDEwMDY0NAotLS0gYS9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYworKysg
Yi9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwpAQCAtNzA3LDggKzcwNyw4IEBAIFRoZSBzdHJ1
Y3R1cmUgaXMgYXMgZm9sbG93OgogCiAjIyMgWEVOX1NZU0NUTF9MSVZFUEFUQ0hfTElTVCAoMikK
IAotUmV0cmlldmUgYW4gYXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzIGFuZCBuYW1lcyBvZiBw
YXlsb2FkcyB0aGF0IGFyZSBsb2FkZWQgaW4gdGhlCi1oeXBlcnZpc29yLgorUmV0cmlldmUgYW4g
YXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzLCBuYW1lcyBhbmQgbWV0YWRhdGEgb2YgcGF5bG9h
ZHMgdGhhdCBhcmUKK2xvYWRlZCBpbiB0aGUgaHlwZXJ2aXNvci4KIAogVGhlIGNhbGxlciBwcm92
aWRlczoKIApAQCAtNzE3LDExICs3MTcsMTMgQEAgVGhlIGNhbGxlciBwcm92aWRlczoKICAqIGBp
ZHhgIEluZGV4IGl0ZXJhdG9yLiBUaGUgaW5kZXggaW50byB0aGUgaHlwZXJ2aXNvcidzIHBheWxv
YWQgY291bnQuIEl0IGlzCiAgICAgcmVjb21tZW5kZWQgdGhhdCBvbiBmaXJzdCBpbnZvY2F0aW9u
IHplcm8gYmUgdXNlZCBzbyB0aGF0IGBucmAgKHdoaWNoIHRoZQogICAgIGh5cGVydmlzb3Igd2ls
bCB1cGRhdGUgd2l0aCB0aGUgcmVtYWluaW5nIHBheWxvYWQgY291bnQpIGJlIHByb3ZpZGVkLgot
ICAgIEFsc28gdGhlIGh5cGVydmlzb3Igd2lsbCBwcm92aWRlIGB2ZXJzaW9uYCB3aXRoIHRoZSBt
b3N0IGN1cnJlbnQgdmFsdWUgYW5kCi0gICAgY2FsY3VsYXRlZCB0b3RhbCBzaXplIGZvciBhbGwg
cGF5bG9hZHMnIG5hbWVzLgorICAgIEFsc28gdGhlIGh5cGVydmlzb3Igd2lsbCBwcm92aWRlIGB2
ZXJzaW9uYCB3aXRoIHRoZSBtb3N0IGN1cnJlbnQgdmFsdWUsCisgICAgY2FsY3VsYXRlZCB0b3Rh
bCBzaXplIG9mIGFsbCBwYXlsb2FkcycgbmFtZXMgYW5kIGNhbGN1bGF0ZWQgdG90YWwgc2l6ZSBv
ZgorICAgIGFsbCBwYXlsb2FkJ3MgbWV0YWRhdGEuCiAgKiBgbnJgIFRoZSBtYXggbnVtYmVyIG9m
IGVudHJpZXMgdG8gcG9wdWxhdGUuIENhbiBiZSB6ZXJvIHdoaWNoIHdpbGwgcmVzdWx0CiAgICAg
aW4gdGhlIGh5cGVyY2FsbCBiZWluZyBhIHByb2Jpbmcgb25lIGFuZCByZXR1cm4gdGhlIG51bWJl
ciBvZiBwYXlsb2FkcwogICAgIChhbmQgdXBkYXRlIHRoZSBgdmVyc2lvbmApLgorICogYHBhZGAg
LSAqTVVTVCogYmUgemVyby4KICAqIGBzdGF0dXNgIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0
byB3cml0ZSBgc3RydWN0IHhlbl9saXZlcGF0Y2hfc3RhdHVzYAogICAgc3RydWN0dXJlcy4gQ2Fs
bGVyICpNVVNUKiBhbGxvY2F0ZSB1cCB0byBgbnJgIG9mIHRoZW0uCiAgKiBgbmFtZWAgLSBWaXJ0
dWFsIGFkZHJlc3Mgb2Ygd2hlcmUgdG8gd3JpdGUgdGhlIHVuaXF1ZSBuYW1lIG9mIHRoZSBwYXls
b2Fkcy4KQEAgLTczMywxNCArNzM1LDIzIEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBgbGVu
YCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgbGVuZ3RoIG9mIGVhY2gg
dW5pcXVlIG5hbWUKICAgIG9mIHRoZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVw
IHRvIGBucmAgb2YgdGhlbS4gRWFjaCAqTVVTVCogYmUKICAgIG9mIHNpemVvZih1aW50MzJfdCkg
KDQgYnl0ZXMpLgorICogYG1ldGFkYXRhYCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3
cml0ZSB0aGUgbWV0YWRhdGEgb2YgdGhlIHBheWxvYWRzLgorICAgQ2FsbGVyICpNVVNUKiBhbGxv
Y2F0ZSBlbm91Z2ggc3BhY2UgdG8gYmUgYWJsZSB0byBzdG9yZSBhbGwgcmVjZWl2ZWQgZGF0YQor
ICAgKGkuZS4gdG90YWwgYWxsb2NhdGVkIHNwYWNlICpNVVNUKiBtYXRjaCB0aGUgYG1ldGFkYXRh
X3RvdGFsX3NpemVgIHZhbHVlCisgICBwcm92aWRlZCBieSB0aGUgaHlwZXJ2aXNvcikuIEluZGl2
aWR1YWwgcGF5bG9hZCBtZXRhZGF0YSBzdHJpbmcgY2FuIGJlIG9mCisgICBhcmJpdHJhcnkgbGVu
Z3RoLiBUaGUgbWV0YWRhdGEgc3RyaW5nIGZvcm1hdCBpczoga2V5PXZhbHVlXDAuLi5rZXk9dmFs
dWVcMC4KKyAqIGBtZXRhZGF0YV9sZW5gIC0gVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdy
aXRlIHRoZSBsZW5ndGggb2YgZWFjaCBtZXRhZGF0YQorICAgc3RyaW5nIG9mIHRoZSBwYXlsb2Fk
LiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4gRWFjaCAqTVVTVCoK
KyAgIGJlIG9mIHNpemVvZih1aW50MzJfdCkgKDQgYnl0ZXMpLgogCiBJZiB0aGUgaHlwZXJjYWxs
IHJldHVybnMgYW4gcG9zaXRpdmUgbnVtYmVyLCBpdCBpcyB0aGUgbnVtYmVyICh1cHRvIGBucmAK
IHByb3ZpZGVkIHRvIHRoZSBoeXBlcmNhbGwpIG9mIHRoZSBwYXlsb2FkcyByZXR1cm5lZCwgYWxv
bmcgd2l0aCBgbnJgIHVwZGF0ZWQKIHdpdGggdGhlIG51bWJlciBvZiByZW1haW5pbmcgcGF5bG9h
ZHMsIGB2ZXJzaW9uYCB1cGRhdGVkIChpdCBtYXkgYmUgdGhlIHNhbWUKIGFjcm9zcyBoeXBlcmNh
bGxzIC0gaWYgaXQgdmFyaWVzIHRoZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNv
dWxkCi1mYWlsKSBhbmQgdGhlIGBuYW1lX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6
ZSBvZiB0cmFuc2ZlcnJlZCBkYXRhIGZvcgotdGhlIGFycmF5LiBUaGUgYHN0YXR1c2AsIGBuYW1l
YCwgYW5kIGBsZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4Ci12YWx1ZSAo
YGlkeGApIHdpdGggdGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCitmYWlsKSwgYG5hbWVfdG90
YWxfc2l6ZWAgYW5kIGBtZXRhZGF0YV90b3RhbF9zaXplYCBjb250YWluaW5nIHRvdGFsIHNpemVz
IG9mCit0cmFuc2ZlcnJlZCBkYXRhIGZvciBib3RoIHRoZSBhcnJheXMuCitUaGUgYHN0YXR1c2As
IGBuYW1lYCwgYGxlbmAsIGBtZXRhZGF0YWAgYW5kIGBtZXRhZGF0YV9sZW5gIGFyZSB1cGRhdGVk
IGF0IHRoZWlyCitkZXNpZ25lZCBpbmRleCB2YWx1ZSAoYGlkeGApIHdpdGggdGhlIHJldHVybmVk
IHZhbHVlIG9mIGRhdGEuCiAKIElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyAtWEVOX0UyQklHIHRo
ZSBgbnJgIGlzIHRvbyBiaWcgYW5kIHNob3VsZCBiZQogbG93ZXJlZC4KQEAgLTc3Nyw3ICs3ODgs
OSBAQCBUaGUgc3RydWN0dXJlIGlzIGFzIGZvbGxvdzoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZCBiZSBmaWxsZWQgb3V0LiBDYW4gYmUg
emVybyB0byBnZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGFtb3VudCBvZiBwYXlsb2FkcyBhbmQgdmVyc2lvbi4KICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9VVDogSG93IG1hbnkgcGF5bG9hZHMg
bGVmdC4gKi8KKyAgICAgICAgdWludDMyX3QgcGFkOyAgICAgICAgICAgICAgICAgICAgICAgICAg
IC8qIElOOiBNdXN0IGJlIHplcm8uICovCiAgICAgICAgIHVpbnQzMl90IG5hbWVfdG90YWxfc2l6
ZTsgICAgICAgICAgICAgICAvKiBPVVQ6IFRvdGFsIHNpemUgb2YgYWxsIHRyYW5zZmVyIG5hbWVz
ICovCisgICAgICAgIHVpbnQzMl90IG1ldGFkYXRhX3RvdGFsX3NpemU7ICAgICAgICAgICAvKiBP
VVQ6IFRvdGFsIHNpemUgb2YgYWxsIHRyYW5zZmVyIG1ldGFkYXRhICovCiAgICAgICAgIFhFTl9H
VUVTVF9IQU5ETEVfNjQoeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBN
dXN0IGhhdmUgZW5vdWdoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzcGFjZSBhbGxvY2F0ZSBmb3IgbnIgb2YgdGhlbS4gKi8KICAgICAgICAgWEVO
X0dVRVNUX0hBTkRMRV82NChjaGFyKSBuYW1lOyAgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFt
ZXMuIEVhY2ggbWVtYmVyCkBAIC03ODYsNiArNzk5LDEyIEBAIFRoZSBzdHJ1Y3R1cmUgaXMgYXMg
Zm9sbG93OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbnIgb2YgdGhlbS4gKi8KICAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NCh1aW50MzIpIGxl
bjsgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBvZiBuYW1lJ3MuCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2Yg
dGhlbS4gKi8KKyAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBtZXRhZGF0YTsgICAg
IC8qIE9VVDogQXJyYXkgb2YgbWV0YWRhdGEgc3RyaW5ncy4gRWFjaAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyIG1heSBoYXZlIGFuIGFy
Yml0cmFyeSBsZW5ndGguCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KKyAgICAgICAgWEVOX0dVRVNUX0hB
TkRMRV82NCh1aW50MzIpIG1ldGFkYXRhX2xlbjsgIC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBv
ZiBtZXRhZGF0YSdzLgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCisKICAgICB9OwogCiAjIyMgWEVO
X1NZU0NUTF9MSVZFUEFUQ0hfQUNUSU9OICgzKQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMvaW5j
bHVkZS94ZW5jdHJsLmggYi90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaAppbmRleCBmNDkw
YTZkZWJjLi5lNTQ5NzAyZmRkIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0
cmwuaAorKysgYi90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaApAQCAtMjU1OSw3ICsyNTU5
LDcgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAKIC8qCiAgKiBH
ZXQgYSBudW1iZXIgb2YgYXZhaWxhYmxlIHBheWxvYWRzIGFuZCBnZXQgYWN0dWFsIHRvdGFsIHNp
emUgb2YKLSAqIHRoZSBwYXlsb2FkcycgbmFtZSBhcnJheS4KKyAqIHRoZSBwYXlsb2FkcycgbmFt
ZSBhbmQgbWV0YWRhdGEgYXJyYXlzLgogICoKICAqIFRoaXMgZnVuY3Rpb25zIGlzIHR5cGljYWxs
eSBleGVjdXRlZCBmaXJzdCBiZWZvcmUgdGhlIHhjX2xpdmVwYXRjaF9saXN0KCkKICAqIHRvIG9i
dGFpbiB0aGUgc2l6ZXMgYW5kIGNvcnJlY3RseSBhbGxvY2F0ZSBhbGwgbmVjZXNzYXJ5IGRhdGEg
cmVzb3VyY2VzLgpAQCAtMjU3MCwxMyArMjU3MCwxNiBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4
Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdpbGwgY29udGFpbiB0aGUgaHlwZXJjYWxsIGVycm9yIGNv
ZGUgdmFsdWUuCiAgKi8KIGludCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJm
YWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVpbnQzMl90ICpuYW1lX3RvdGFsX3NpemUpOworICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1aW50MzJfdCAqbmFtZV90b3RhbF9zaXplLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50MzJfdCAqbWV0YWRhdGFfdG90YWxfc2l6ZSk7CiAKIC8qCiAgKiBUaGUg
aGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBnZXQgYW4gYXJyYXkgb2YgdGhlIGZvbGxvd2lu
ZyBvYmplY3RzOgogICogICAtIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3Q6IHN0YXRlcyBhbmQgcmV0
dXJuIGNvZGVzIG9mIHBheWxvYWRzCiAgKiAgIC0gbmFtZTogbmFtZXMgb2YgcGF5bG9hZHMKICAq
ICAgLSBsZW46IGxlbmd0aHMgb2YgY29ycmVzcG9uZGluZyBwYXlsb2FkcycgbmFtZXMKKyAqICAg
LSBtZXRhZGF0YTogcGF5bG9hZHMnIG1ldGFkYXRhCisgKiAgIC0gbWV0YWRhdGFfbGVuOiBsZW5n
dGhzIG9mIGNvcnJlc3BvbmRpbmcgcGF5bG9hZHMnIG1ldGFkYXRhCiAgKgogICogSG93ZXZlciBp
dCBpcyBjb21wbGV4IGJlY2F1c2UgaXQgaGFzIHRvIGRlYWwgd2l0aCB0aGUgaHlwZXJ2aXNvcgog
ICogcmV0dXJuaW5nIHNvbWUgb2YgdGhlIHJlcXVlc3RlZCBkYXRhIG9yIGRhdGEgYmVpbmcgc3Rh
bGUKQEAgLTI1ODksMTIgKzI1OTIsMTMgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXpl
cyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKICAqCiAgKiBJdCBpcyBleHBl
Y3RlZCB0aGF0IHRoZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlvbiB3aWxsIGZpcnN0IGlzc3VlIHRo
ZQogICogeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKCkgaW4gb3JkZXIgdG8gb2J0YWluIHRv
dGFsIHNpemVzIG9mIG5hbWVzCi0gKiBhcyB3ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBw
YXlsb2FkIGVudHJpZXMuCi0gKiBUaGUgdG90YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBw
bGllZCB2aWEgdGhlICduYW1lX3RvdGFsX3NpemUnCi0gKiBwYXJhbWV0ZXIuCisgKiBhbmQgYWxs
IG1ldGFkYXRhIGFzIHdlbGwgYXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmll
cy4KKyAqIFRoZSB0b3RhbCBzaXplcyBhcmUgcmVxdWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUg
J25hbWVfdG90YWxfc2l6ZScgYW5kCisgKiAnbWV0YWRhdGFfdG90YWxfc2l6ZScgcGFyYW1ldGVy
cy4KICAqCiAgKiBUaGUgJ21heCcgaXMgdG8gYmUgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciB3aXRo
IHRoZSBtYXhpbXVtIG51bWJlciBvZgotICogZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAn
bGVuJyBhcnJheXMgY2FuIGJlIGZpbGxlZCB1cCB3aXRoLgorICogZW50cmllcyB0aGF0ICdpbmZv
JywgJ25hbWUnLCAnbGVuJywgJ21ldGFkYXRhJyBhbmQgJ21ldGFkYXRhX2xlbicgYXJyYXlzCisg
KiBjYW4gYmUgZmlsbGVkIHVwIHdpdGguCiAgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2luZm8n
IGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QKICAqIHN0
cnVjdHVyZSBzaXplLgpAQCAtMjYwMyw2ICsyNjA3LDEwIEBAIGludCB4Y19saXZlcGF0Y2hfbGlz
dF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAgKgogICog
RWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWludDMy
X3Qgc2l6ZS4KICAqCisgKiBFYWNoIGVudHJ5IGluIHRoZSAnbWV0YWRhdGEnIGFycmF5IG1heSBo
YXZlIGFuIGFyYml0cmFyeSBzaXplLgorICoKKyAqIEVhY2ggZW50cnkgaW4gdGhlICdtZXRhZGF0
YV9sZW4nIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCisgKgogICog
VGhlIHJldHVybiB2YWx1ZSBpcyB6ZXJvIGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nl
c3NmdWxseS4KICAqIE5vdGUgdGhhdCB0aGUgcmV0dXJuIHZhbHVlIGlzIF9ub3RfIHRoZSBhbW91
bnQgb2YgZW50cmllcyBmaWxsZWQKICAqIG91dCAtIHRoYXQgaXMgc2F2ZWQgaW4gJ2RvbmUnLgpA
QCAtMjYxNyw2ICsyNjI1LDggQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAq
eGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCB4ZW5fbGl2ZXBhdGNoX3N0YXR1cyAqaW5mbywKICAgICAgICAgICAgICAgICAgICAgICBjaGFy
ICpuYW1lLCB1aW50MzJfdCAqbGVuLAogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVpbnQz
Ml90IG5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZXRhZGF0
YSwgdWludDMyX3QgKm1ldGFkYXRhX2xlbiwKKyAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1
aW50MzJfdCBtZXRhZGF0YV90b3RhbF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCAqZG9uZSwgdW5zaWduZWQgaW50ICpsZWZ0KTsKIAogLyoKZGlmZiAtLWdpdCBhL3Rv
b2xzL2xpYnhjL3hjX21pc2MuYyBiL3Rvb2xzL2xpYnhjL3hjX21pc2MuYwppbmRleCA0ZjI2Y2Ri
NjIzLi43NzQ3ZWE4M2FhIDEwMDY0NAotLS0gYS90b29scy9saWJ4Yy94Y19taXNjLmMKKysrIGIv
dG9vbHMvbGlieGMveGNfbWlzYy5jCkBAIC02NjMsNyArNjYzLDcgQEAgaW50IHhjX2xpdmVwYXRj
aF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAKIC8qCiAgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxh
YmxlIHBheWxvYWRzIGFuZCBnZXQgYWN0dWFsIHRvdGFsIHNpemUgb2YKLSAqIHRoZSBwYXlsb2Fk
cycgbmFtZSBhcnJheS4KKyAqIHRoZSBwYXlsb2FkcycgbmFtZSBhbmQgbWV0YWRhdGEgYXJyYXlz
LgogICoKICAqIFRoaXMgZnVuY3Rpb25zIGlzIHR5cGljYWxseSBleGVjdXRlZCBmaXJzdCBiZWZv
cmUgdGhlIHhjX2xpdmVwYXRjaF9saXN0KCkKICAqIHRvIG9idGFpbiB0aGUgc2l6ZXMgYW5kIGNv
cnJlY3RseSBhbGxvY2F0ZSBhbGwgbmVjZXNzYXJ5IGRhdGEgcmVzb3VyY2VzLgpAQCAtNjc0LDEy
ICs2NzQsMTMgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAgKiB3
aWxsIGNvbnRhaW4gdGhlIGh5cGVyY2FsbCBlcnJvciBjb2RlIHZhbHVlLgogICovCiBpbnQgeGNf
bGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQg
Km5yLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3Rh
bF9zaXplKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90
b3RhbF9zaXplLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbWV0
YWRhdGFfdG90YWxfc2l6ZSkKIHsKICAgICBERUNMQVJFX1NZU0NUTDsKICAgICBpbnQgcmM7CiAK
LSAgICBpZiAoICFuciB8fCAhbmFtZV90b3RhbF9zaXplICkKKyAgICBpZiAoICFuciB8fCAhbmFt
ZV90b3RhbF9zaXplIHx8ICFtZXRhZGF0YV90b3RhbF9zaXplICkKICAgICB7CiAgICAgICAgIGVy
cm5vID0gRUlOVkFMOwogICAgICAgICByZXR1cm4gLTE7CkBAIC02OTUsNiArNjk2LDcgQEAgaW50
IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQg
aW50ICpuciwKIAogICAgICpuciA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubnI7CiAgICAg
Km5hbWVfdG90YWxfc2l6ZSA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90b3RhbF9z
aXplOworICAgICptZXRhZGF0YV90b3RhbF9zaXplID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlz
dC5tZXRhZGF0YV90b3RhbF9zaXplOwogCiAgICAgcmV0dXJuIDA7CiB9CkBAIC03MDQsNiArNzA2
LDggQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwg
dW5zaWduZWQgaW50ICpuciwKICAqICAgLSB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190OiBzdGF0ZXMg
YW5kIHJldHVybiBjb2RlcyBvZiBwYXlsb2FkcwogICogICAtIG5hbWU6IG5hbWVzIG9mIHBheWxv
YWRzCiAgKiAgIC0gbGVuOiBsZW5ndGhzIG9mIGNvcnJlc3BvbmRpbmcgcGF5bG9hZHMnIG5hbWVz
CisgKiAgIC0gbWV0YWRhdGE6IHBheWxvYWRzJyBtZXRhZGF0YQorICogICAtIG1ldGFkYXRhX2xl
bjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxvYWRzJyBtZXRhZGF0YQogICoKICAqIEhv
d2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNlIGl0IGhhcyB0byBkZWFsIHdpdGggdGhlIGh5cGVy
dmlzb3IKICAqIHJldHVybmluZyBzb21lIG9mIHRoZSByZXF1ZXN0ZWQgZGF0YSBvciBkYXRhIGJl
aW5nIHN0YWxlCkBAIC03MTYsMTIgKzcyMCwxMyBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0
X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAogICoKICAqIEl0IGlz
IGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9uIHdpbGwgZmlyc3QgaXNz
dWUgdGhlCiAgKiB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSBpbiBvcmRlciB0byBvYnRh
aW4gdG90YWwgc2l6ZXMgb2YgbmFtZXMKLSAqIGFzIHdlbGwgYXMgdGhlIGN1cnJlbnQgbnVtYmVy
IG9mIHBheWxvYWQgZW50cmllcy4KLSAqIFRoZSB0b3RhbCBzaXplcyBhcmUgcmVxdWlyZWQgYW5k
IHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6ZScKLSAqIHBhcmFtZXRlci4KKyAqIGFu
ZCBhbGwgbWV0YWRhdGEgYXMgd2VsbCBhcyB0aGUgY3VycmVudCBudW1iZXIgb2YgcGF5bG9hZCBl
bnRyaWVzLgorICogVGhlIHRvdGFsIHNpemVzIGFyZSByZXF1aXJlZCBhbmQgc3VwcGxpZWQgdmlh
IHRoZSAnbmFtZV90b3RhbF9zaXplJyBhbmQKKyAqICdtZXRhZGF0YV90b3RhbF9zaXplJyBwYXJh
bWV0ZXJzLgogICoKICAqIFRoZSAnbWF4JyBpcyB0byBiZSBwcm92aWRlZCBieSB0aGUgY2FsbGVy
IHdpdGggdGhlIG1heGltdW0gbnVtYmVyIG9mCi0gKiBlbnRyaWVzIHRoYXQgJ2luZm8nLCAnbmFt
ZScsICdsZW4nIGFycmF5cyBjYW4gYmUgZmlsbGVkIHVwIHdpdGguCisgKiBlbnRyaWVzIHRoYXQg
J2luZm8nLCAnbmFtZScsICdsZW4nLCAnbWV0YWRhdGEnIGFuZCAnbWV0YWRhdGFfbGVuJyBhcnJh
eXMKKyAqIGNhbiBiZSBmaWxsZWQgdXAgd2l0aC4KICAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAn
aW5mbycgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdAog
ICogc3RydWN0dXJlIHNpemUuCkBAIC03MzAsNiArNzM1LDEwIEBAIGludCB4Y19saXZlcGF0Y2hf
bGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAgKgog
ICogRWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWlu
dDMyX3Qgc2l6ZS4KICAqCisgKiBFYWNoIGVudHJ5IGluIHRoZSAnbWV0YWRhdGEnIGFycmF5IG1h
eSBoYXZlIGFuIGFyYml0cmFyeSBzaXplLgorICoKKyAqIEVhY2ggZW50cnkgaW4gdGhlICdtZXRh
ZGF0YV9sZW4nIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCisgKgog
ICogVGhlIHJldHVybiB2YWx1ZSBpcyB6ZXJvIGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1
Y2Nlc3NmdWxseS4KICAqIE5vdGUgdGhhdCB0aGUgcmV0dXJuIHZhbHVlIGlzIF9ub3RfIHRoZSBh
bW91bnQgb2YgZW50cmllcyBmaWxsZWQKICAqIG91dCAtIHRoYXQgaXMgc2F2ZWQgaW4gJ2RvbmUn
LgpAQCAtNzQ0LDYgKzc1Myw4IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2Ug
KnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmluZm8sCiAgICAgICAgICAgICAgICAgICAgICAgY2hh
ciAqbmFtZSwgdWludDMyX3QgKmxlbiwKICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50
MzJfdCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWV0YWRh
dGEsIHVpbnQzMl90ICptZXRhZGF0YV9sZW4sCisgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
dWludDMyX3QgbWV0YWRhdGFfdG90YWxfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICB1bnNp
Z25lZCBpbnQgKmRvbmUsIHVuc2lnbmVkIGludCAqbGVmdCkKIHsKICAgICBpbnQgcmM7CkBAIC03
NTIsMTMgKzc2MywxNiBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gs
IGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAgREVDTEFSRV9IWVBFUkNBTExfQk9VTkNFKGlu
Zm8sIDAsIFhDX0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNFX09VVCk7CiAgICAgREVDTEFSRV9IWVBF
UkNBTExfQk9VTkNFKG5hbWUsIDAsIFhDX0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNFX09VVCk7CiAg
ICAgREVDTEFSRV9IWVBFUkNBTExfQk9VTkNFKGxlbiwgMCwgWENfSFlQRVJDQUxMX0JVRkZFUl9C
T1VOQ0VfT1VUKTsKKyAgICBERUNMQVJFX0hZUEVSQ0FMTF9CT1VOQ0UobWV0YWRhdGEsIDAsIFhD
X0hZUEVSQ0FMTF9CVUZGRVJfQk9VTkNFX09VVCk7CisgICAgREVDTEFSRV9IWVBFUkNBTExfQk9V
TkNFKG1ldGFkYXRhX2xlbiwgMCwgWENfSFlQRVJDQUxMX0JVRkZFUl9CT1VOQ0VfT1VUKTsKICAg
ICB1aW50MzJfdCBtYXhfYmF0Y2hfc3osIG5yOwogICAgIHVpbnQzMl90IHZlcnNpb24gPSAwLCBy
ZXRyaWVzID0gMDsKICAgICB1aW50MzJfdCBhZGp1c3QgPSAwOwotICAgIHVpbnQzMl90IG5hbWVf
b2ZmID0gMDsKLSAgICB1aW50MzJfdCBuYW1lX3N6OworICAgIHVpbnQzMl90IG5hbWVfb2ZmID0g
MCwgbWV0YWRhdGFfb2ZmID0gMDsKKyAgICB1aW50MzJfdCBuYW1lX3N6LCBtZXRhZGF0YV9zejsK
IAotICAgIGlmICggIW1heCB8fCAhaW5mbyB8fCAhbmFtZSB8fCAhbGVuIHx8ICFkb25lIHx8ICFs
ZWZ0ICkKKyAgICBpZiAoICFtYXggfHwgIWluZm8gfHwgIW5hbWUgfHwgIWxlbiB8fAorICAgICAg
ICAgIW1ldGFkYXRhIHx8ICFtZXRhZGF0YV9sZW4gfHwgIWRvbmUgfHwgIWxlZnQgKQogICAgIHsK
ICAgICAgICAgZXJybm8gPSBFSU5WQUw7CiAgICAgICAgIHJldHVybiAtMTsKQEAgLTc3NywxMCAr
NzkxLDExIEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3Qg
dW5zaWduZWQgaW50IG1heCwKIAogICAgIG1heF9iYXRjaF9zeiA9IG1heDsKICAgICBuYW1lX3N6
ID0gbmFtZV90b3RhbF9zaXplOworICAgIG1ldGFkYXRhX3N6ID0gbWV0YWRhdGFfdG90YWxfc2l6
ZTsKICAgICAqZG9uZSA9IDA7CiAgICAgKmxlZnQgPSAwOwogICAgIGRvIHsKLSAgICAgICAgdWlu
dDMyX3QgX25hbWVfc3o7CisgICAgICAgIHVpbnQzMl90IF9uYW1lX3N6LCBfbWV0YWRhdGFfc3o7
CiAKICAgICAgICAgLyoKICAgICAgICAgICogVGhlIGZpcnN0IHRpbWUgd2UgZ28gaW4gdGhpcyBs
b29wIG91ciAnbWF4JyBtYXkgYmUgYmlnZ2VyCkBAIC04MDMsMTAgKzgxOCwxNCBAQCBpbnQgeGNf
bGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgs
CiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUoaW5mbywgbnIgKiBzaXplb2YoKmlu
Zm8pKTsKICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBuYW1lX3N6KTsK
ICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShsZW4sIG5yICogc2l6ZW9mKCpsZW4p
KTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShtZXRhZGF0YSwgbWV0YWRhdGFf
c3opOworICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG1ldGFkYXRhX2xlbiwgbnIg
KiBzaXplb2YoKm1ldGFkYXRhX2xlbikpOwogICAgICAgICAvKiBNb3ZlIHRoZSBwb2ludGVyIHRv
IHByb3BlciBvZmZzZXQgaW50byAnaW5mbycuICovCiAgICAgICAgIChIWVBFUkNBTExfQlVGRkVS
KGluZm8pKS0+dWJ1ZiA9IGluZm8gKyAqZG9uZTsKICAgICAgICAgKEhZUEVSQ0FMTF9CVUZGRVIo
bmFtZSkpLT51YnVmID0gbmFtZSArIG5hbWVfb2ZmOwogICAgICAgICAoSFlQRVJDQUxMX0JVRkZF
UihsZW4pKS0+dWJ1ZiA9IGxlbiArICpkb25lOworICAgICAgICAoSFlQRVJDQUxMX0JVRkZFUiht
ZXRhZGF0YSkpLT51YnVmID0gbWV0YWRhdGEgKyBtZXRhZGF0YV9vZmY7CisgICAgICAgIChIWVBF
UkNBTExfQlVGRkVSKG1ldGFkYXRhX2xlbikpLT51YnVmID0gbWV0YWRhdGFfbGVuICsgKmRvbmU7
CiAgICAgICAgIC8qIEFsbG9jYXRlIG1lbW9yeS4gKi8KICAgICAgICAgcmMgPSB4Y19oeXBlcmNh
bGxfYm91bmNlX3ByZSh4Y2gsIGluZm8pOwogICAgICAgICBpZiAoIHJjICkKQEAgLTgyMCw5ICs4
MzksMTkgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1
bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICBpZiAoIHJjICkKICAgICAgICAgICAgIGJyZWFrOwog
CisgICAgICAgIHJjID0geGNfaHlwZXJjYWxsX2JvdW5jZV9wcmUoeGNoLCBtZXRhZGF0YSk7Cisg
ICAgICAgIGlmICggcmMgKQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAgcmMgPSB4Y19o
eXBlcmNhbGxfYm91bmNlX3ByZSh4Y2gsIG1ldGFkYXRhX2xlbik7CisgICAgICAgIGlmICggcmMg
KQorICAgICAgICAgICAgYnJlYWs7CisKICAgICAgICAgc2V0X3hlbl9ndWVzdF9oYW5kbGUoc3lz
Y3RsLnUubGl2ZXBhdGNoLnUubGlzdC5zdGF0dXMsIGluZm8pOwogICAgICAgICBzZXRfeGVuX2d1
ZXN0X2hhbmRsZShzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0Lm5hbWUsIG5hbWUpOwogICAgICAg
ICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0LmxlbiwgbGVu
KTsKKyAgICAgICAgc2V0X3hlbl9ndWVzdF9oYW5kbGUoc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlz
dC5tZXRhZGF0YSwgbWV0YWRhdGEpOworICAgICAgICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNj
dGwudS5saXZlcGF0Y2gudS5saXN0Lm1ldGFkYXRhX2xlbiwgbWV0YWRhdGFfbGVuKTsKIAogICAg
ICAgICByYyA9IGRvX3N5c2N0bCh4Y2gsICZzeXNjdGwpOwogICAgICAgICAvKgpAQCAtODM5LDYg
Kzg2OCw4IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3Qg
dW5zaWduZWQgaW50IG1heCwKICAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4
Y2gsIGluZm8pOwogICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbmFt
ZSk7CiAgICAgICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBsZW4pOworICAg
ICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGEpOworICAgICAg
ICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGFfbGVuKTsKICAgICAg
ICAgICAgIGNvbnRpbnVlOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYgKCByYyA8IDAgKSAv
KiBGb3IgYWxsIG90aGVyIGVycm9ycyB3ZSBiYWlsIG91dC4gKi8KQEAgLTg2Myw2ICs4OTQsOCBA
QCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVk
IGludCBtYXgsCiAgICAgICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBpbmZv
KTsKICAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAg
ICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbGVuKTsKKyAgICAgICAgICAg
IHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1ldGFkYXRhKTsKKyAgICAgICAgICAgIHhj
X2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1ldGFkYXRhX2xlbik7CiAgICAgICAgICAgICBj
b250aW51ZTsKICAgICAgICAgfQogCkBAIC04NzUsMTcgKzkwOCwyNCBAQCBpbnQgeGNfbGl2ZXBh
dGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAg
ICAgIH0KICAgICAgICAgKmxlZnQgPSBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0Lm5yOyAvKiBU
b3RhbCByZW1haW5pbmcgY291bnQuICovCiAgICAgICAgIF9uYW1lX3N6ID0gc3lzY3RsLnUubGl2
ZXBhdGNoLnUubGlzdC5uYW1lX3RvdGFsX3NpemU7IC8qIFRvdGFsIHJlY2VpdmVkIG5hbWUgc2l6
ZS4gKi8KKyAgICAgICAgX21ldGFkYXRhX3N6ID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5t
ZXRhZGF0YV90b3RhbF9zaXplOyAvKiBUb3RhbCByZWNlaXZlZCBtZXRhZGF0YSBzaXplLiAqLwog
ICAgICAgICAvKiBDb3B5IG9ubHkgdXAgJ3JjJyBvZiBkYXRhJyAtIHdlIGNvdWxkIGFkZCAnbWlu
KHJjLG5yKSBpZiBkZXNpcmVkLiAqLwogICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpF
KGluZm8sIChyYyAqIHNpemVvZigqaW5mbykpKTsKICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9T
RVRfU0laRShuYW1lLCBfbmFtZV9zeik7CiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJ
WkUobGVuLCAocmMgKiBzaXplb2YoKmxlbikpKTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9T
RVRfU0laRShtZXRhZGF0YSwgX21ldGFkYXRhX3N6KTsKKyAgICAgICAgSFlQRVJDQUxMX0JPVU5D
RV9TRVRfU0laRShtZXRhZGF0YV9sZW4sIChyYyAqIHNpemVvZigqbWV0YWRhdGFfbGVuKSkpOwog
ICAgICAgICAvKiBCb3VuY2UgdGhlIGRhdGEgYW5kIGZyZWUgdGhlIGJvdW5jZSBidWZmZXIuICov
CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGluZm8pOwogICAgICAgICB4
Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBuYW1lKTsKICAgICAgICAgeGNfaHlwZXJjYWxs
X2JvdW5jZV9wb3N0KHhjaCwgbGVuKTsKKyAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0
KHhjaCwgbWV0YWRhdGEpOworICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBt
ZXRhZGF0YV9sZW4pOwogCiAgICAgICAgIG5hbWVfc3ogLT0gX25hbWVfc3o7CiAgICAgICAgIG5h
bWVfb2ZmICs9IF9uYW1lX3N6OworICAgICAgICBtZXRhZGF0YV9zeiAtPSBfbWV0YWRhdGFfc3o7
CisgICAgICAgIG1ldGFkYXRhX29mZiArPSBfbWV0YWRhdGFfc3o7CiAKICAgICAgICAgLyogQW5k
IHVwZGF0ZSBob3cgbWFueSBlbGVtZW50cyBvZiBpbmZvIHdlIGhhdmUgY29waWVkIGludG8uICov
CiAgICAgICAgICpkb25lICs9IHJjOwpAQCAtODk4LDYgKzkzOCw4IEBAIGludCB4Y19saXZlcGF0
Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICAg
ICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbGVuKTsKICAgICAgICAgeGNfaHlwZXJj
YWxsX2JvdW5jZV9wb3N0KHhjaCwgbmFtZSk7CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2Vf
cG9zdCh4Y2gsIGluZm8pOworICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBt
ZXRhZGF0YSk7CisgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1ldGFkYXRh
X2xlbik7CiAgICAgfQogCiAgICAgcmV0dXJuIHJjID4gMCA/IDAgOiByYzsKZGlmZiAtLWdpdCBh
L3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMK
aW5kZXggYzkzYzUwMDQwYy4uMTZhNGE0N2FiNyAxMDA2NDQKLS0tIGEvdG9vbHMvbWlzYy94ZW4t
bGl2ZXBhdGNoLmMKKysrIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKQEAgLTY5LDggKzY5
LDEwIEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAg
dW5zaWduZWQgaW50IG5yLCBkb25lLCBsZWZ0LCBpOwogICAgIHhlbl9saXZlcGF0Y2hfc3RhdHVz
X3QgKmluZm8gPSBOVUxMOwogICAgIGNoYXIgKm5hbWUgPSBOVUxMOworICAgIGNoYXIgKm1ldGFk
YXRhID0gTlVMTDsKICAgICB1aW50MzJfdCAqbGVuID0gTlVMTDsKLSAgICB1aW50MzJfdCBuYW1l
X3RvdGFsX3NpemUsIG5hbWVfb2ZmOworICAgIHVpbnQzMl90ICptZXRhZGF0YV9sZW4gPSBOVUxM
OworICAgIHVpbnQzMl90IG5hbWVfdG90YWxfc2l6ZSwgbWV0YWRhdGFfdG90YWxfc2l6ZSwgbmFt
ZV9vZmYsIG1ldGFkYXRhX29mZjsKICAgICBpbnQgcmMgPSBFTk9NRU07CiAKICAgICBpZiAoIGFy
Z2MgKQpAQCAtODAsNyArODIsNyBAQCBzdGF0aWMgaW50IGxpc3RfZnVuYyhpbnQgYXJnYywgY2hh
ciAqYXJndltdKQogICAgIH0KICAgICBkb25lID0gbGVmdCA9IDA7CiAKLSAgICByYyA9IHhjX2xp
dmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y2gsICZuciwgJm5hbWVfdG90YWxfc2l6ZSk7CisgICAg
cmMgPSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNoLCAmbnIsICZuYW1lX3RvdGFsX3Np
emUsICZtZXRhZGF0YV90b3RhbF9zaXplKTsKICAgICBpZiAoIHJjICkKICAgICB7CiAgICAgICAg
IHJjID0gZXJybm87CkBAIC0xMDgsMTIgKzExMCwyMyBAQCBzdGF0aWMgaW50IGxpc3RfZnVuYyhp
bnQgYXJnYywgY2hhciAqYXJndltdKQogICAgIGlmICggIWxlbiApCiAgICAgICAgIGdvdG8gZXJy
b3JfbGVuOwogCisgICAgbWV0YWRhdGEgPSBtYWxsb2MobWV0YWRhdGFfdG90YWxfc2l6ZSAqIHNp
emVvZigqbWV0YWRhdGEpICsgMSk7CisgICAgaWYgKCAhbWV0YWRhdGEgKQorICAgICAgICBnb3Rv
IGVycm9yX21ldGFkYXRhOworCisgICAgbWV0YWRhdGFfbGVuID0gbWFsbG9jKG5yICogc2l6ZW9m
KCptZXRhZGF0YV9sZW4pKTsKKyAgICBpZiAoICFtZXRhZGF0YV9sZW4gKQorICAgICAgICBnb3Rv
IGVycm9yX21ldGFkYXRhX2xlbjsKKwogICAgIG1lbXNldChpbmZvLCAnQScsIG5yICogc2l6ZW9m
KCppbmZvKSk7CiAgICAgbWVtc2V0KG5hbWUsICdCJywgbmFtZV90b3RhbF9zaXplICogc2l6ZW9m
KCpuYW1lKSk7CiAgICAgbWVtc2V0KGxlbiwgJ0MnLCBuciAqIHNpemVvZigqbGVuKSk7Ci0gICAg
bmFtZV9vZmYgPSAwOworICAgIG1lbXNldChtZXRhZGF0YSwgJ0QnLCBtZXRhZGF0YV90b3RhbF9z
aXplICogc2l6ZW9mKCptZXRhZGF0YSkgKyAxKTsKKyAgICBtZW1zZXQobWV0YWRhdGFfbGVuLCAn
RScsIG5yICogc2l6ZW9mKCptZXRhZGF0YV9sZW4pKTsKKyAgICBuYW1lX29mZiA9IG1ldGFkYXRh
X29mZiA9IDA7CiAKLSAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0KHhjaCwgbnIsIDAsIGluZm8s
IG5hbWUsIGxlbiwgbmFtZV90b3RhbF9zaXplLCAmZG9uZSwgJmxlZnQpOworICAgIHJjID0geGNf
bGl2ZXBhdGNoX2xpc3QoeGNoLCBuciwgMCwgaW5mbywgbmFtZSwgbGVuLCBuYW1lX3RvdGFsX3Np
emUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YSwgbWV0YWRhdGFfbGVuLCBt
ZXRhZGF0YV90b3RhbF9zaXplLCAmZG9uZSwgJmxlZnQpOwogICAgIGlmICggcmMgfHwgZG9uZSAh
PSBuciB8fCBsZWZ0ID4gMCkKICAgICB7CiAgICAgICAgIHJjID0gZXJybm87CkBAIC0xMjMsMjMg
KzEzNiwzNSBAQCBzdGF0aWMgaW50IGxpc3RfZnVuYyhpbnQgYXJnYywgY2hhciAqYXJndltdKQog
ICAgICAgICBnb3RvIGVycm9yOwogICAgIH0KIAotICAgIGZwcmludGYoc3Rkb3V0LCIgSUQgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBzdGF0dXNcbiIKLSAgICAgICAgICAg
ICAgICAgICAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0t
LS0tLS1cbiIpOworICAgIGZwcmludGYoc3Rkb3V0LCIgSUQgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCBzdGF0dXMgICAgIHwgbWV0YWRhdGFcbiIKKyAgICAgICAgICAgICAg
ICAgICAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0t
LS0rLS0tLS0tLS0tLS0tLS0tXG4iKTsKIAogICAgIGZvciAoIGkgPSAwOyBpIDwgZG9uZTsgaSsr
ICkKICAgICB7CisgICAgICAgIHVuc2lnbmVkIGludCBqOwogICAgICAgICBjaGFyICpuYW1lX3N0
ciA9IG5hbWUgKyBuYW1lX29mZjsKKyAgICAgICAgY2hhciAqbWV0YWRhdGFfc3RyID0gbWV0YWRh
dGEgKyBtZXRhZGF0YV9vZmY7CiAKICAgICAgICAgcHJpbnRmKCIlLTQwLipzfCAlcyIsIGxlbltp
XSwgbmFtZV9zdHIsIHN0YXRlMnN0cihpbmZvW2ldLnN0YXRlKSk7CiAgICAgICAgIGlmICggaW5m
b1tpXS5yYyApCi0gICAgICAgICAgICBwcmludGYoIiAoJWQsICVzKVxuIiwgLWluZm9baV0ucmMs
IHN0cmVycm9yKC1pbmZvW2ldLnJjKSk7CisgICAgICAgICAgICBwcmludGYoIiAoJWQsICVzKSAg
ICB8ICIsIC1pbmZvW2ldLnJjLCBzdHJlcnJvcigtaW5mb1tpXS5yYykpOwogICAgICAgICBlbHNl
Ci0gICAgICAgICAgICBwdXRzKCIiKTsKKyAgICAgICAgICAgIHByaW50ZigiICAgIHwgIik7CisK
KyAgICAgICAgLyogUmVwbGFjZSBhbGwgJ1wwJyB3aXRoIHNlbWktY29sb25zLiAqLworICAgICAg
ICBmb3IgKCBqID0gMDsgbWV0YWRhdGFfbGVuW2ldICYmIGogPCBtZXRhZGF0YV9sZW5baV0gLSAx
OyBqKysgKQorICAgICAgICAgICAgbWV0YWRhdGFfc3RyW2pdID0gKG1ldGFkYXRhX3N0cltqXSA/
OiAnOycpOworICAgICAgICBwcmludGYoIiUuKnNcbiIsIG1ldGFkYXRhX2xlbltpXSwgbWV0YWRh
dGFfc3RyKTsKIAogICAgICAgICBuYW1lX29mZiArPSBsZW5baV07CisgICAgICAgIG1ldGFkYXRh
X29mZiArPSBtZXRhZGF0YV9sZW5baV07CiAgICAgfQogCiBlcnJvcjoKKyAgICBmcmVlKG1ldGFk
YXRhX2xlbik7CitlcnJvcl9tZXRhZGF0YV9sZW46CisgICAgZnJlZShtZXRhZGF0YSk7CitlcnJv
cl9tZXRhZGF0YToKICAgICBmcmVlKGxlbik7CiBlcnJvcl9sZW46CiAgICAgZnJlZShuYW1lKTsK
ZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMgYi94ZW4vY29tbW9uL2xpdmVwYXRj
aC5jCmluZGV4IDc2ZjViNzI3NDAuLmUyMTUzM2JmMmMgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
bGl2ZXBhdGNoLmMKKysrIGIveGVuL2NvbW1vbi9saXZlcGF0Y2guYwpAQCAtMTE1OSw5ICsxMTU5
LDEzIEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBh
dGNoX2xpc3QgKmxpc3QpCiAgICAgaWYgKCBsaXN0LT5uciA+IDEwMjQgKQogICAgICAgICByZXR1
cm4gLUUyQklHOwogCisgICAgaWYgKCBsaXN0LT5wYWQgKQorICAgICAgICByZXR1cm4gLUVJTlZB
TDsKKwogICAgIGlmICggbGlzdC0+bnIgJiYKICAgICAgICAgICghZ3Vlc3RfaGFuZGxlX29rYXko
bGlzdC0+c3RhdHVzLCBsaXN0LT5ucikgfHwKLSAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXko
bGlzdC0+bGVuLCBsaXN0LT5ucikpICkKKyAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlz
dC0+bGVuLCBsaXN0LT5ucikgfHwKKyAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlzdC0+
bWV0YWRhdGFfbGVuLCBsaXN0LT5ucikpICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKICAg
ICBzcGluX2xvY2soJnBheWxvYWRfbG9jayk7CkBAIC0xMTcyLDEzICsxMTc2LDE0IEBAIHN0YXRp
YyBpbnQgbGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxp
c3QpCiAgICAgfQogCiAgICAgbGlzdC0+bmFtZV90b3RhbF9zaXplID0gMDsKKyAgICBsaXN0LT5t
ZXRhZGF0YV90b3RhbF9zaXplID0gMDsKICAgICBpZiAoIGxpc3QtPm5yICkKICAgICB7Ci0gICAg
ICAgIHVpbnQ2NF90IG5hbWVfb2Zmc2V0ID0gMDsKKyAgICAgICAgdWludDY0X3QgbmFtZV9vZmZz
ZXQgPSAwLCBtZXRhZGF0YV9vZmZzZXQgPSAwOwogCiAgICAgICAgIGxpc3RfZm9yX2VhY2hfZW50
cnkoIGRhdGEsICZwYXlsb2FkX2xpc3QsIGxpc3QgKQogICAgICAgICB7Ci0gICAgICAgICAgICB1
aW50MzJfdCBuYW1lX2xlbjsKKyAgICAgICAgICAgIHVpbnQzMl90IG5hbWVfbGVuLCBtZXRhZGF0
YV9sZW47CiAKICAgICAgICAgICAgIGlmICggbGlzdC0+aWR4ID4gaSsrICkKICAgICAgICAgICAg
ICAgICBjb250aW51ZTsKQEAgLTExODksOCArMTE5NCwxMyBAQCBzdGF0aWMgaW50IGxpdmVwYXRj
aF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0KQogICAgICAgICAg
ICAgbmFtZV9sZW4gPSBzdHJsZW4oZGF0YS0+bmFtZSkgKyAxOwogICAgICAgICAgICAgbGlzdC0+
bmFtZV90b3RhbF9zaXplICs9IG5hbWVfbGVuOwogCisgICAgICAgICAgICBtZXRhZGF0YV9sZW4g
PSBkYXRhLT5tZXRhZGF0YS5sZW47CisgICAgICAgICAgICBsaXN0LT5tZXRhZGF0YV90b3RhbF9z
aXplICs9IG1ldGFkYXRhX2xlbjsKKwogICAgICAgICAgICAgaWYgKCAhZ3Vlc3RfaGFuZGxlX3N1
YnJhbmdlX29rYXkobGlzdC0+bmFtZSwgbmFtZV9vZmZzZXQsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lX29mZnNldCArIG5hbWVfbGVuIC0gMSkgKQor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZV9vZmZzZXQg
KyBuYW1lX2xlbiAtIDEpIHx8CisgICAgICAgICAgICAgICAgICFndWVzdF9oYW5kbGVfc3VicmFu
Z2Vfb2theShsaXN0LT5tZXRhZGF0YSwgbWV0YWRhdGFfb2Zmc2V0LAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFfb2Zmc2V0ICsgbWV0YWRhdGFf
bGVuIC0gMSkgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsK
ICAgICAgICAgICAgICAgICBicmVhazsKQEAgLTEyMDAsNyArMTIxMCwxMCBAQCBzdGF0aWMgaW50
IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0KQog
ICAgICAgICAgICAgaWYgKCBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm5hbWUsIG5hbWVf
b2Zmc2V0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPm5h
bWUsIG5hbWVfbGVuKSB8fAogICAgICAgICAgICAgICAgIF9fY29weV90b19ndWVzdF9vZmZzZXQo
bGlzdC0+bGVuLCBpZHgsICZuYW1lX2xlbiwgMSkgfHwKLSAgICAgICAgICAgICAgICBfX2NvcHlf
dG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPnN0YXR1cywgaWR4LCAmc3RhdHVzLCAxKSApCisgICAgICAg
ICAgICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChsaXN0LT5zdGF0dXMsIGlkeCwgJnN0YXR1
cywgMSkgfHwKKyAgICAgICAgICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm1l
dGFkYXRhLCBtZXRhZGF0YV9vZmZzZXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBkYXRhLT5tZXRhZGF0YS5kYXRhLCBtZXRhZGF0YV9sZW4pIHx8CisgICAgICAgICAg
ICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChsaXN0LT5tZXRhZGF0YV9sZW4sIGlkeCwgJm1l
dGFkYXRhX2xlbiwgMSkgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHJjID0gLUVG
QVVMVDsKICAgICAgICAgICAgICAgICBicmVhazsKQEAgLTEyMDgsNiArMTIyMSw3IEBAIHN0YXRp
YyBpbnQgbGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxp
c3QpCiAKICAgICAgICAgICAgIGlkeCsrOwogICAgICAgICAgICAgbmFtZV9vZmZzZXQgKz0gbmFt
ZV9sZW47CisgICAgICAgICAgICBtZXRhZGF0YV9vZmZzZXQgKz0gbWV0YWRhdGFfbGVuOwogCiAg
ICAgICAgICAgICBpZiAoIChpZHggPj0gbGlzdC0+bnIpIHx8IGh5cGVyY2FsbF9wcmVlbXB0X2No
ZWNrKCkgKQogICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTIxOCw2ICsxMjMyLDcgQEAgc3Rh
dGljIGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAq
bGlzdCkKICAgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeSggZGF0YSwgJnBheWxvYWRfbGlzdCwg
bGlzdCApCiAgICAgICAgIHsKICAgICAgICAgICAgIGxpc3QtPm5hbWVfdG90YWxfc2l6ZSArPSBz
dHJsZW4oZGF0YS0+bmFtZSkgKyAxOworICAgICAgICAgICAgbGlzdC0+bWV0YWRhdGFfdG90YWxf
c2l6ZSArPSBkYXRhLT5tZXRhZGF0YS5sZW47CiAgICAgICAgIH0KICAgICB9CiAgICAgbGlzdC0+
bnIgPSBwYXlsb2FkX2NudCAtIGk7IC8qIFJlbWFpbmluZyBhbW91bnQuICovCmRpZmYgLS1naXQg
YS94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmggYi94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3Rs
LmgKaW5kZXggNGJmZDE0NzViZi4uN2U0M2JmZTFiZCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUv
cHVibGljL3N5c2N0bC5oCisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaApAQCAtOTM0
LDE2ICs5MzQsMTcgQEAgc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2dldCB7CiB9OwogCiAv
KgotICogUmV0cmlldmUgYW4gYXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzIGFuZCBuYW1lcyBv
ZiBwYXlsb2FkcyB0aGF0IGFyZQotICogbG9hZGVkIGluIHRoZSBoeXBlcnZpc29yLgorICogUmV0
cmlldmUgYW4gYXJyYXkgb2YgYWJicmV2aWF0ZWQgc3RhdHVzLCBuYW1lcyBhbmQgbWV0YWRhdGEg
b2YgcGF5bG9hZHMgdGhhdAorICogYXJlIGxvYWRlZCBpbiB0aGUgaHlwZXJ2aXNvci4KICAqCiAg
KiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgYW4gcG9zaXRpdmUgbnVtYmVyLCBpdCBpcyB0aGUg
bnVtYmVyICh1cCB0byBgbnJgKQogICogb2YgdGhlIHBheWxvYWRzIHJldHVybmVkLCBhbG9uZyB3
aXRoIGBucmAgdXBkYXRlZCB3aXRoIHRoZSBudW1iZXIgb2YgcmVtYWluaW5nCiAgKiBwYXlsb2Fk
cywgYHZlcnNpb25gIHVwZGF0ZWQgKGl0IG1heSBiZSB0aGUgc2FtZSBhY3Jvc3MgaHlwZXJjYWxs
cy4gSWYgaXQgdmFyaWVzCi0gKiB0aGUgZGF0YSBpcyBzdGFsZSBhbmQgZnVydGhlciBjYWxscyBj
b3VsZCBmYWlsKSBhbmQgdGhlIG5hbWVfdG90YWxfc2l6ZQotICogY29udGFpbmluZyB0b3RhbCBz
aXplIG9mIHRyYW5zZmVycmVkIGRhdGEgZm9yIHRoZSBhcnJheS4KLSAqIFRoZSBgc3RhdHVzYCwg
YG5hbWVgLCBgbGVuYCBhcmUgdXBkYXRlZCBhdCB0aGVpciBkZXNpZ25lZCBpbmRleCB2YWx1ZSAo
YGlkeGApCi0gKiB3aXRoIHRoZSByZXR1cm5lZCB2YWx1ZSBvZiBkYXRhLgorICogdGhlIGRhdGEg
aXMgc3RhbGUgYW5kIGZ1cnRoZXIgY2FsbHMgY291bGQgZmFpbCksIGBuYW1lX3RvdGFsX3NpemVg
IGFuZAorICogYG1ldGFkYXRhX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZXMgb2Yg
dHJhbnNmZXJyZWQgZGF0YSBmb3IgYm90aCB0aGUKKyAqIGFycmF5cy4KKyAqIFRoZSBgc3RhdHVz
YCwgYG5hbWVgLCBgbGVuYCwgYG1ldGFkYXRhYCBhbmQgYG1ldGFkYXRhX2xlbmAgYXJlIHVwZGF0
ZWQgYXQgdGhlaXIKKyAqIGRlc2lnbmVkIGluZGV4IHZhbHVlIChgaWR4YCkgd2l0aCB0aGUgcmV0
dXJuZWQgdmFsdWUgb2YgZGF0YS4KICAqCiAgKiBJZiB0aGUgaHlwZXJjYWxsIHJldHVybnMgRTJC
SUcgdGhlIGBucmAgaXMgdG9vIGJpZyBhbmQgc2hvdWxkIGJlCiAgKiBsb3dlcmVkLiBUaGUgdXBw
ZXIgbGltaXQgb2YgYG5yYCBpcyBsZWZ0IHRvIHRoZSBpbXBsZW1lbnRpb24uCkBAIC05NjUsNyAr
OTY2LDkgQEAgc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgewogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG91bGQgZmlsbCBvdXQuIENhbiBi
ZSB6ZXJvIHRvIGdldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBhbW91bnQgb2YgcGF5bG9hZHMgYW5kIHZlcnNpb24uCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9VVDogSG93IG1hbnkgcGF5bG9hZHMgbGVmdC4g
Ki8KKyAgICB1aW50MzJfdCBwYWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogSU46IE11
c3QgYmUgemVyby4gKi8KICAgICB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemU7ICAgICAgICAgICAg
ICAgLyogT1VUOiBUb3RhbCBzaXplIG9mIGFsbCB0cmFuc2ZlciBuYW1lcyAqLworICAgIHVpbnQz
Ml90IG1ldGFkYXRhX3RvdGFsX3NpemU7ICAgICAgICAgICAvKiBPVVQ6IFRvdGFsIHNpemUgb2Yg
YWxsIHRyYW5zZmVyIG1ldGFkYXRhICovCiAgICAgWEVOX0dVRVNUX0hBTkRMRV82NCh4ZW5fbGl2
ZXBhdGNoX3N0YXR1c190KSBzdGF0dXM7ICAvKiBPVVQuIE11c3QgaGF2ZSBlbm91Z2gKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2UgYWxsb2NhdGUg
Zm9yIG5yIG9mIHRoZW0uICovCiAgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBuYW1lOyAg
ICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVtYmVyCkBAIC05NzQsNiArOTc3
LDExIEBAIHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0IHsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnIgb2YgdGhlbS4gKi8KICAgICBYRU5f
R1VFU1RfSEFORExFXzY0KHVpbnQzMikgbGVuOyAgICAgICAgLyogT1VUOiBBcnJheSBvZiBsZW5n
dGhzIG9mIG5hbWUncy4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCisgICAgWEVOX0dVRVNUX0hBTkRMRV82NChj
aGFyKSBtZXRhZGF0YTsgICAgIC8qIE9VVDogQXJyYXkgb2YgbWV0YWRhdGEgc3RyaW5ncy4gRWFj
aAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIg
bWF5IGhhdmUgYW4gYXJiaXRyYXJ5IGxlbmd0aC4KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCisgICAgWEVOX0dV
RVNUX0hBTkRMRV82NCh1aW50MzIpIG1ldGFkYXRhX2xlbjsgIC8qIE9VVDogQXJyYXkgb2YgbGVu
Z3RocyBvZiBtZXRhZGF0YSdzLgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KIH07CiAKIC8qCi0tIAoyLjE2
LjUKCgoKCkFtYXpvbiBEZXZlbG9wbWVudCBDZW50ZXIgR2VybWFueSBHbWJICktyYXVzZW5zdHIu
IDM4CjEwMTE3IEJlcmxpbgpHZXNjaGFlZnRzZnVlaHJ1bmc6IENocmlzdGlhbiBTY2hsYWVnZXIs
IFJhbGYgSGVyYnJpY2gKRWluZ2V0cmFnZW4gYW0gQW10c2dlcmljaHQgQ2hhcmxvdHRlbmJ1cmcg
dW50ZXIgSFJCIDE0OTE3MyBCClNpdHo6IEJlcmxpbgpVc3QtSUQ6IERFIDI4OSAyMzcgODc5CgoK
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2
ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xp
c3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

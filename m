Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B8111FE5FF
	for <lists+xen-devel@lfdr.de>; Fri, 15 Nov 2019 20:48:55 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVhY2-0002BS-5O; Fri, 15 Nov 2019 19:46:26 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=1SQg=ZH=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iVhY0-0002AH-Ik
 for xen-devel@lists.xenproject.org; Fri, 15 Nov 2019 19:46:24 +0000
X-Inumbo-ID: 74d240b8-07e0-11ea-9631-bc764e2007e4
Received: from mail-qk1-x730.google.com (unknown [2607:f8b0:4864:20::730])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 74d240b8-07e0-11ea-9631-bc764e2007e4;
 Fri, 15 Nov 2019 19:45:20 +0000 (UTC)
Received: by mail-qk1-x730.google.com with SMTP id i19so9061873qki.2
 for <xen-devel@lists.xenproject.org>; Fri, 15 Nov 2019 11:45:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=BjBCgX/mHAw3u2O0EjLUNnvbMhFn39TpMG0QC9EojiM=;
 b=nDcECmDi+F87YazNHQYRibtRtCnkjCyU6TkLsJVQS5UeUyeSrYxDsO/KisiwTNWd7q
 j0mlFHPN2VioXWraAnVV46irXg8mYmdaK68t2tlaKIGu0ZeIiK5wZ6s1EMCsg02GjloB
 mXn2VOKxUNnUs+p8dKvLzUFqPMim1TtX8PellnrUYCDBWgqzUy5ZKsOn3t5RLML/lAZg
 7IxhdMvI4FVgNUf86bL/6uampJmhNKnoJYt0vUtbaVHpjduAiODux9emtDV1GJM3GhEX
 G7AtRtEPjt8/Sbkavw5rLdchzwKxNWnzCgFVDBhYqAKUeoKViFQeeY4FtuWQTQqmPdZH
 2eog==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=BjBCgX/mHAw3u2O0EjLUNnvbMhFn39TpMG0QC9EojiM=;
 b=RutrN/OWgGxf5BXtgZAAw+im8YtYSufIBsFYgMfbyfL5KgJljqB2e2LO1l2ZSqQSXL
 m++d+hMFu+PIKITgpDemSMtekOTqKGhpA3RXJt/IxKR85e1Mf4vJp6EtLi9WFI6XQSOC
 tDhDkqn4TP4NVHkQvhRsY93y54AZv0G4QZDjGE9fOIvALHnuy9M+nc9PArS02G/MCj1S
 jksAHxylKNJMaXtJ+fKqguX4i+pPmJWSi/0d+bNwAv/gLkDOTwJJItRFFl30X/WBDCMW
 XX7qs+LhV0sbBNRKb19wT1Q74Wy1QuuJJiwIbWvhg9ND5wG5uRY0XgsbUMkOhLamt+kx
 b4hQ==
X-Gm-Message-State: APjAAAW4Ya/FmxhEBIvhoV+ecLJ3JZJVC79I4WUp/tlLUfMwylEWy8FG
 9B7tcHV9K54+nuGAIhpPPZTewwhF
X-Google-Smtp-Source: APXvYqym3v4FqJUcpVZY0gGTfXK5lTOoaptK7r64rAf4hxcXvrsAWzBClQIa6rns334o2w0VWVc8Mw==
X-Received: by 2002:a37:b14:: with SMTP id 20mr13811662qkl.1.1573847119312;
 Fri, 15 Nov 2019 11:45:19 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id y10sm4649679qkb.55.2019.11.15.11.45.18
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 15 Nov 2019 11:45:18 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 15 Nov 2019 14:44:24 -0500
Message-Id: <93cd55139c0e72d995385a252454871e314cba19.1573840474.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1573840473.git.rosbrookn@ainfosec.com>
References: <cover.1573840473.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 17/22] golang/xenlight: implement array C to
 Go marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClNpZ25lZC1vZmYt
Ynk6IE5pY2sgUm9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29s
YW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkgIHwgIDM5ICsrKy0KIHRvb2xzL2dvbGFuZy94ZW5s
aWdodC9oZWxwZXJzLmdlbi5nbyB8IDMwMCArKysrKysrKysrKysrKysrKysrKysrKysrKysKIDIg
ZmlsZXMgY2hhbmdlZCwgMzM4IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1n
aXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSBiL3Rvb2xzL2dvbGFuZy94
ZW5saWdodC9nZW5nb3R5cGVzLnB5CmluZGV4IDU3Y2VjZDU5ODkuLjcwODNjY2M4NzEgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CisrKyBiL3Rvb2xzL2dv
bGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CkBAIC0yNzAsNyArMjcwLDcgQEAgZGVmIHhlbmxp
Z2h0X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5ID0gTm9uZSwgdHlwZW5hbWUgPSBOb25lLCBuZXN0
ZWQgPSBGYWxzZSk6CiAgICAgZm9yIGYgaW4gdHkuZmllbGRzOgogICAgICAgICBpZiBmLnR5cGUu
dHlwZW5hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGYudHlwZSwg
aWRsLkFycmF5KToKLSAgICAgICAgICAgICAgICAjIFRPRE8KKyAgICAgICAgICAgICAgICBzICs9
IHhlbmxpZ2h0X2dvbGFuZ19hcnJheV9mcm9tX0MoZikKICAgICAgICAgICAgICAgICBjb250aW51
ZQogCiAgICAgICAgICAgICBnb3R5cGVuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGYu
dHlwZS50eXBlbmFtZSkKQEAgLTQ0MSw2ICs0NDEsNDMgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ191
bmlvbl9maWVsZHNfZnJvbV9DKHR5ID0gTm9uZSk6CiAKICAgICByZXR1cm4gcwogCitkZWYgeGVu
bGlnaHRfZ29sYW5nX2FycmF5X2Zyb21fQyh0eSA9IE5vbmUpOgorICAgICIiIgorICAgIENvbnZl
cnQgQyBhcnJheSB0byBHbyBzbGljZSB1c2luZyB0aGUgbWV0aG9kCisgICAgZGVzY3JpYmVkIGhl
cmU6CisKKyAgICBodHRwczovL2dpdGh1Yi5jb20vZ29sYW5nL2dvL3dpa2kvY2dvI3R1cm5pbmct
Yy1hcnJheXMtaW50by1nby1zbGljZXMKKyAgICAiIiIKKyAgICBzID0gJycKKworICAgIGdvdHlw
ZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUodHkudHlwZS5lbGVtX3R5cGUudHlwZW5h
bWUpCisgICAgZ29uYW1lICAgICA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eS5uYW1lKQor
ICAgIGN0eXBlbmFtZSAgPSB0eS50eXBlLmVsZW1fdHlwZS50eXBlbmFtZQorICAgIGNuYW1lICAg
ICAgPSB0eS5uYW1lCisgICAgY3NsaWNlICAgICA9ICdje30nLmZvcm1hdChnb25hbWUpCisgICAg
Y2xlbnZhciAgICA9IHR5LnR5cGUubGVudmFyLm5hbWUKKyAgICBnb2xlbnZhciAgID0geGVubGln
aHRfZ29sYW5nX2ZtdF9uYW1lKGNsZW52YXIsZXhwb3J0ZWQ9RmFsc2UpCisKKyAgICBzICs9ICd7
fSA6PSBpbnQoeGMue30pXG4nLmZvcm1hdChnb2xlbnZhciwgY2xlbnZhcikKKyAgICBzICs9ICd7
fSA6PSAnLmZvcm1hdChjc2xpY2UpCisgICAgcyArPScoKlsxPDwyOF1DLnt9KSh1bnNhZmUuUG9p
bnRlcih4Yy57fSkpWzp7fTp7fV1cbicuZm9ybWF0KGN0eXBlbmFtZSwgY25hbWUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Z29sZW52YXIsIGdvbGVudmFyKQorICAgIHMgKz0gJ3gue30gPSBtYWtlKFtde30sIHt9KVxuJy5m
b3JtYXQoZ29uYW1lLCBnb3R5cGVuYW1lLCBnb2xlbnZhcikKKyAgICBzICs9ICdmb3IgaSwgdiA6
PSByYW5nZSB7fSB7e1xuJy5mb3JtYXQoY3NsaWNlKQorCisgICAgaXNfZW51bSA9IGlzaW5zdGFu
Y2UodHkudHlwZS5lbGVtX3R5cGUsaWRsLkVudW1lcmF0aW9uKQorICAgIGlmIGdvdHlwZW5hbWUg
aW4gZ29fYnVpbHRpbl90eXBlcyBvciBpc19lbnVtOgorICAgICAgICBzICs9ICd4Lnt9W2ldID0g
e30odilcbicuZm9ybWF0KGdvbmFtZSwgZ290eXBlbmFtZSkKKyAgICBlbHNlOgorICAgICAgICBz
ICs9ICd2YXIgZSB7fVxuJy5mb3JtYXQoZ290eXBlbmFtZSkKKyAgICAgICAgcyArPSAnaWYgZXJy
IDo9IGUuZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHtcbicKKyAgICAgICAgcyArPSAncmV0dXJuIGVy
ciB9XG4nCisgICAgICAgIHMgKz0gJ3gue31baV0gPSBlXG4nLmZvcm1hdChnb25hbWUpCisKKyAg
ICBzICs9ICd9XG4nCisKKyAgICByZXR1cm4gcworCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9u
YW1lKG5hbWUsIGV4cG9ydGVkID0gVHJ1ZSk6CiAgICAgIiIiCiAgICAgVGFrZSBhIGdpdmVuIHR5
cGUgbmFtZSBhbmQgcmV0dXJuIGFuCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQv
aGVscGVycy5nZW4uZ28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5k
ZXggZDJkZDlmMjUwNy4uYWJkYmFlMWRjNyAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2hlbHBlcnMuZ2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdl
bi5nbwpAQCAtMzgzLDYgKzM4MywxNiBAQCBmdW5jICh4ICpTY2hlZFBhcmFtcykgZnJvbUMoeGMg
KkMubGlieGxfc2NoZWRfcGFyYW1zKSBlcnJvciB7CiAKIGZ1bmMgKHggKlZjcHVTY2hlZFBhcmFt
cykgZnJvbUMoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXMpIGVycm9yIHsKIAl4LlNjaGVk
ID0gU2NoZWR1bGVyKHhjLnNjaGVkKQorCW51bVZjcHVzIDo9IGludCh4Yy5udW1fdmNwdXMpCisJ
Y1ZjcHVzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9zY2hlZF9wYXJhbXMpKHVuc2FmZS5Qb2ludGVy
KHhjLnZjcHVzKSlbOm51bVZjcHVzOm51bVZjcHVzXQorCXguVmNwdXMgPSBtYWtlKFtdU2NoZWRQ
YXJhbXMsIG51bVZjcHVzKQorCWZvciBpLCB2IDo9IHJhbmdlIGNWY3B1cyB7CisJCXZhciBlIFNj
aGVkUGFyYW1zCisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1
cm4gZXJyCisJCX0KKwkJeC5WY3B1c1tpXSA9IGUKKwl9CiAJcmV0dXJuIG5pbAogfQogCkBAIC00
MDAsNiArNDEwLDEyIEBAIGZ1bmMgKHggKkRvbWFpblNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zKSBlcnJvciB7CiAKIGZ1bmMgKHggKlZub2RlSW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfdm5vZGVfaW5mbykgZXJyb3IgewogCXguTWVta2IgPSB1aW50NjQo
eGMubWVta2IpCisJbnVtRGlzdGFuY2VzIDo9IGludCh4Yy5udW1fZGlzdGFuY2VzKQorCWNEaXN0
YW5jZXMgOj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4Yy5kaXN0YW5j
ZXMpKVs6bnVtRGlzdGFuY2VzOm51bURpc3RhbmNlc10KKwl4LkRpc3RhbmNlcyA9IG1ha2UoW111
aW50MzIsIG51bURpc3RhbmNlcykKKwlmb3IgaSwgdiA6PSByYW5nZSBjRGlzdGFuY2VzIHsKKwkJ
eC5EaXN0YW5jZXNbaV0gPSB1aW50MzIodikKKwl9CiAJeC5Qbm9kZSA9IHVpbnQzMih4Yy5wbm9k
ZSkKIAl2YXIgYml0bWFwVmNwdXMgQml0bWFwCiAJaWYgZXJyIDo9IGJpdG1hcFZjcHVzLmZyb21D
KCZ4Yy52Y3B1cyk7IGVyciAhPSBuaWwgewpAQCAtNDMyLDYgKzQ0OCwyNiBAQCBmdW5jICh4ICpE
b21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSBlcnJv
ciB7CiAJCXJldHVybiBlcnIKIAl9CiAJeC5Ob2RlbWFwID0gYml0bWFwTm9kZW1hcAorCW51bVZj
cHVIYXJkQWZmaW5pdHkgOj0gaW50KHhjLm51bV92Y3B1X2hhcmRfYWZmaW5pdHkpCisJY1ZjcHVI
YXJkQWZmaW5pdHkgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2JpdG1hcCkodW5zYWZlLlBvaW50ZXIo
eGMudmNwdV9oYXJkX2FmZmluaXR5KSlbOm51bVZjcHVIYXJkQWZmaW5pdHk6bnVtVmNwdUhhcmRB
ZmZpbml0eV0KKwl4LlZjcHVIYXJkQWZmaW5pdHkgPSBtYWtlKFtdQml0bWFwLCBudW1WY3B1SGFy
ZEFmZmluaXR5KQorCWZvciBpLCB2IDo9IHJhbmdlIGNWY3B1SGFyZEFmZmluaXR5IHsKKwkJdmFy
IGUgQml0bWFwCisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1
cm4gZXJyCisJCX0KKwkJeC5WY3B1SGFyZEFmZmluaXR5W2ldID0gZQorCX0KKwludW1WY3B1U29m
dEFmZmluaXR5IDo9IGludCh4Yy5udW1fdmNwdV9zb2Z0X2FmZmluaXR5KQorCWNWY3B1U29mdEFm
ZmluaXR5IDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9iaXRtYXApKHVuc2FmZS5Qb2ludGVyKHhjLnZj
cHVfc29mdF9hZmZpbml0eSkpWzpudW1WY3B1U29mdEFmZmluaXR5Om51bVZjcHVTb2Z0QWZmaW5p
dHldCisJeC5WY3B1U29mdEFmZmluaXR5ID0gbWFrZShbXUJpdG1hcCwgbnVtVmNwdVNvZnRBZmZp
bml0eSkKKwlmb3IgaSwgdiA6PSByYW5nZSBjVmNwdVNvZnRBZmZpbml0eSB7CisJCXZhciBlIEJp
dG1hcAorCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVy
cgorCQl9CisJCXguVmNwdVNvZnRBZmZpbml0eVtpXSA9IGUKKwl9CiAJdmFyIGRlZmJvb2xOdW1h
UGxhY2VtZW50IERlZmJvb2wKIAlpZiBlcnIgOj0gZGVmYm9vbE51bWFQbGFjZW1lbnQuZnJvbUMo
JnhjLm51bWFfcGxhY2VtZW50KTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBlcnIKQEAgLTQ2Miw2
ICs0OTgsMTYgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9k
b21haW5fYnVpbGRfaW5mbykgZXJyb3IgewogCX0KIAl4LkNwdWlkID0gY3B1aWRQb2xpY3lMaXN0
Q3B1aWQKIAl4LkJsa2RldlN0YXJ0ID0gQy5Hb1N0cmluZyh4Yy5ibGtkZXZfc3RhcnQpCisJbnVt
Vm51bWFOb2RlcyA6PSBpbnQoeGMubnVtX3ZudW1hX25vZGVzKQorCWNWbnVtYU5vZGVzIDo9ICgq
WzEgPDwgMjhdQy5saWJ4bF92bm9kZV9pbmZvKSh1bnNhZmUuUG9pbnRlcih4Yy52bnVtYV9ub2Rl
cykpWzpudW1WbnVtYU5vZGVzOm51bVZudW1hTm9kZXNdCisJeC5WbnVtYU5vZGVzID0gbWFrZShb
XVZub2RlSW5mbywgbnVtVm51bWFOb2RlcykKKwlmb3IgaSwgdiA6PSByYW5nZSBjVm51bWFOb2Rl
cyB7CisJCXZhciBlIFZub2RlSW5mbworCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBu
aWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVm51bWFOb2Rlc1tpXSA9IGUKKwl9CiAJeC5N
YXhHcmFudEZyYW1lcyA9IHVpbnQzMih4Yy5tYXhfZ3JhbnRfZnJhbWVzKQogCXguTWF4TWFwdHJh
Y2tGcmFtZXMgPSB1aW50MzIoeGMubWF4X21hcHRyYWNrX2ZyYW1lcykKIAl4LkRldmljZU1vZGVs
VmVyc2lvbiA9IERldmljZU1vZGVsVmVyc2lvbih4Yy5kZXZpY2VfbW9kZWxfdmVyc2lvbikKQEAg
LTQ5NCw2ICs1NDAsMzIgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IgewogCQlyZXR1cm4gZXJyCiAJfQogCXguU2No
ZWRQYXJhbXMgPSBkb21haW5TY2hlZFBhcmFtc1NjaGVkUGFyYW1zCisJbnVtSW9wb3J0cyA6PSBp
bnQoeGMubnVtX2lvcG9ydHMpCisJY0lvcG9ydHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2lvcG9y
dF9yYW5nZSkodW5zYWZlLlBvaW50ZXIoeGMuaW9wb3J0cykpWzpudW1Jb3BvcnRzOm51bUlvcG9y
dHNdCisJeC5Jb3BvcnRzID0gbWFrZShbXUlvcG9ydFJhbmdlLCBudW1Jb3BvcnRzKQorCWZvciBp
LCB2IDo9IHJhbmdlIGNJb3BvcnRzIHsKKwkJdmFyIGUgSW9wb3J0UmFuZ2UKKwkJaWYgZXJyIDo9
IGUuZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LklvcG9y
dHNbaV0gPSBlCisJfQorCW51bUlycXMgOj0gaW50KHhjLm51bV9pcnFzKQorCWNJcnFzIDo9ICgq
WzEgPDwgMjhdQy51aW50MzJfdCkodW5zYWZlLlBvaW50ZXIoeGMuaXJxcykpWzpudW1JcnFzOm51
bUlycXNdCisJeC5JcnFzID0gbWFrZShbXXVpbnQzMiwgbnVtSXJxcykKKwlmb3IgaSwgdiA6PSBy
YW5nZSBjSXJxcyB7CisJCXguSXJxc1tpXSA9IHVpbnQzMih2KQorCX0KKwludW1Jb21lbSA6PSBp
bnQoeGMubnVtX2lvbWVtKQorCWNJb21lbSA6PSAoKlsxIDw8IDI4XUMubGlieGxfaW9tZW1fcmFu
Z2UpKHVuc2FmZS5Qb2ludGVyKHhjLmlvbWVtKSlbOm51bUlvbWVtOm51bUlvbWVtXQorCXguSW9t
ZW0gPSBtYWtlKFtdSW9tZW1SYW5nZSwgbnVtSW9tZW0pCisJZm9yIGksIHYgOj0gcmFuZ2UgY0lv
bWVtIHsKKwkJdmFyIGUgSW9tZW1SYW5nZQorCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAh
PSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguSW9tZW1baV0gPSBlCisJfQogCXZhciBk
ZWZib29sQ2xhaW1Nb2RlIERlZmJvb2wKIAlpZiBlcnIgOj0gZGVmYm9vbENsYWltTW9kZS5mcm9t
QygmeGMuY2xhaW1fbW9kZSk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZXJyCkBAIC05ODQsMTAg
KzEwNTYsMzIgQEAgZnVuYyAoeCAqRGV2aWNlVmRpc3BsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZp
Y2VfdmRpc3BsKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZF9kb21uYW1lKQogCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKIAl4LkJlQWxsb2MgPSBi
b29sKHhjLmJlX2FsbG9jKQorCW51bUNvbm5lY3RvcnMgOj0gaW50KHhjLm51bV9jb25uZWN0b3Jz
KQorCWNDb25uZWN0b3JzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9jb25uZWN0b3JfcGFyYW0pKHVu
c2FmZS5Qb2ludGVyKHhjLmNvbm5lY3RvcnMpKVs6bnVtQ29ubmVjdG9yczpudW1Db25uZWN0b3Jz
XQorCXguQ29ubmVjdG9ycyA9IG1ha2UoW11Db25uZWN0b3JQYXJhbSwgbnVtQ29ubmVjdG9ycykK
Kwlmb3IgaSwgdiA6PSByYW5nZSBjQ29ubmVjdG9ycyB7CisJCXZhciBlIENvbm5lY3RvclBhcmFt
CisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJ
CX0KKwkJeC5Db25uZWN0b3JzW2ldID0gZQorCX0KIAlyZXR1cm4gbmlsCiB9CiAKIGZ1bmMgKHgg
KlZzbmRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfcGFyYW1zKSBlcnJvciB7CisJbnVt
U2FtcGxlUmF0ZXMgOj0gaW50KHhjLm51bV9zYW1wbGVfcmF0ZXMpCisJY1NhbXBsZVJhdGVzIDo9
ICgqWzEgPDwgMjhdQy51aW50MzJfdCkodW5zYWZlLlBvaW50ZXIoeGMuc2FtcGxlX3JhdGVzKSlb
Om51bVNhbXBsZVJhdGVzOm51bVNhbXBsZVJhdGVzXQorCXguU2FtcGxlUmF0ZXMgPSBtYWtlKFtd
dWludDMyLCBudW1TYW1wbGVSYXRlcykKKwlmb3IgaSwgdiA6PSByYW5nZSBjU2FtcGxlUmF0ZXMg
eworCQl4LlNhbXBsZVJhdGVzW2ldID0gdWludDMyKHYpCisJfQorCW51bVNhbXBsZUZvcm1hdHMg
Oj0gaW50KHhjLm51bV9zYW1wbGVfZm9ybWF0cykKKwljU2FtcGxlRm9ybWF0cyA6PSAoKlsxIDw8
IDI4XUMubGlieGxfdnNuZF9wY21fZm9ybWF0KSh1bnNhZmUuUG9pbnRlcih4Yy5zYW1wbGVfZm9y
bWF0cykpWzpudW1TYW1wbGVGb3JtYXRzOm51bVNhbXBsZUZvcm1hdHNdCisJeC5TYW1wbGVGb3Jt
YXRzID0gbWFrZShbXVZzbmRQY21Gb3JtYXQsIG51bVNhbXBsZUZvcm1hdHMpCisJZm9yIGksIHYg
Oj0gcmFuZ2UgY1NhbXBsZUZvcm1hdHMgeworCQl4LlNhbXBsZUZvcm1hdHNbaV0gPSBWc25kUGNt
Rm9ybWF0KHYpCisJfQogCXguQ2hhbm5lbHNNaW4gPSB1aW50MzIoeGMuY2hhbm5lbHNfbWluKQog
CXguQ2hhbm5lbHNNYXggPSB1aW50MzIoeGMuY2hhbm5lbHNfbWF4KQogCXguQnVmZmVyU2l6ZSA9
IHVpbnQzMih4Yy5idWZmZXJfc2l6ZSkKQEAgLTEwMTIsNiArMTEwNiwxNiBAQCBmdW5jICh4ICpW
c25kUGNtKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kX3BjbSkgZXJyb3IgewogCQlyZXR1cm4gZXJy
CiAJfQogCXguUGFyYW1zID0gdnNuZFBhcmFtc1BhcmFtcworCW51bVZzbmRTdHJlYW1zIDo9IGlu
dCh4Yy5udW1fdnNuZF9zdHJlYW1zKQorCWNTdHJlYW1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF92
c25kX3N0cmVhbSkodW5zYWZlLlBvaW50ZXIoeGMuc3RyZWFtcykpWzpudW1Wc25kU3RyZWFtczpu
dW1Wc25kU3RyZWFtc10KKwl4LlN0cmVhbXMgPSBtYWtlKFtdVnNuZFN0cmVhbSwgbnVtVnNuZFN0
cmVhbXMpCisJZm9yIGksIHYgOj0gcmFuZ2UgY1N0cmVhbXMgeworCQl2YXIgZSBWc25kU3RyZWFt
CisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJ
CX0KKwkJeC5TdHJlYW1zW2ldID0gZQorCX0KIAlyZXR1cm4gbmlsCiB9CiAKQEAgLTEwMjYsNiAr
MTEzMCwxNiBAQCBmdW5jICh4ICpEZXZpY2VWc25kKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
dnNuZCkgZXJyb3IgewogCQlyZXR1cm4gZXJyCiAJfQogCXguUGFyYW1zID0gdnNuZFBhcmFtc1Bh
cmFtcworCW51bVZzbmRQY21zIDo9IGludCh4Yy5udW1fdnNuZF9wY21zKQorCWNQY21zIDo9ICgq
WzEgPDwgMjhdQy5saWJ4bF92c25kX3BjbSkodW5zYWZlLlBvaW50ZXIoeGMucGNtcykpWzpudW1W
c25kUGNtczpudW1Wc25kUGNtc10KKwl4LlBjbXMgPSBtYWtlKFtdVnNuZFBjbSwgbnVtVnNuZFBj
bXMpCisJZm9yIGksIHYgOj0gcmFuZ2UgY1BjbXMgeworCQl2YXIgZSBWc25kUGNtCisJCWlmIGVy
ciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5Q
Y21zW2ldID0gZQorCX0KIAlyZXR1cm4gbmlsCiB9CiAKQEAgLTEwNDAsNiArMTE1NCwxNTYgQEAg
ZnVuYyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBl
cnJvciB7CiAJCXJldHVybiBlcnIKIAl9CiAJeC5CSW5mbyA9IGRvbWFpbkJ1aWxkSW5mb0JJbmZv
CisJbnVtRGlza3MgOj0gaW50KHhjLm51bV9kaXNrcykKKwljRGlza3MgOj0gKCpbMSA8PCAyOF1D
LmxpYnhsX2RldmljZV9kaXNrKSh1bnNhZmUuUG9pbnRlcih4Yy5kaXNrcykpWzpudW1EaXNrczpu
dW1EaXNrc10KKwl4LkRpc2tzID0gbWFrZShbXURldmljZURpc2ssIG51bURpc2tzKQorCWZvciBp
LCB2IDo9IHJhbmdlIGNEaXNrcyB7CisJCXZhciBlIERldmljZURpc2sKKwkJaWYgZXJyIDo9IGUu
ZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LkRpc2tzW2ld
ID0gZQorCX0KKwludW1OaWNzIDo9IGludCh4Yy5udW1fbmljcykKKwljTmljcyA6PSAoKlsxIDw8
IDI4XUMubGlieGxfZGV2aWNlX25pYykodW5zYWZlLlBvaW50ZXIoeGMubmljcykpWzpudW1OaWNz
Om51bU5pY3NdCisJeC5OaWNzID0gbWFrZShbXURldmljZU5pYywgbnVtTmljcykKKwlmb3IgaSwg
diA6PSByYW5nZSBjTmljcyB7CisJCXZhciBlIERldmljZU5pYworCQlpZiBlcnIgOj0gZS5mcm9t
Qygmdik7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguTmljc1tpXSA9IGUK
Kwl9CisJbnVtUGNpZGV2cyA6PSBpbnQoeGMubnVtX3BjaWRldnMpCisJY1BjaWRldnMgOj0gKCpb
MSA8PCAyOF1DLmxpYnhsX2RldmljZV9wY2kpKHVuc2FmZS5Qb2ludGVyKHhjLnBjaWRldnMpKVs6
bnVtUGNpZGV2czpudW1QY2lkZXZzXQorCXguUGNpZGV2cyA9IG1ha2UoW11EZXZpY2VQY2ksIG51
bVBjaWRldnMpCisJZm9yIGksIHYgOj0gcmFuZ2UgY1BjaWRldnMgeworCQl2YXIgZSBEZXZpY2VQ
Y2kKKwkJaWYgZXJyIDo9IGUuZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIK
KwkJfQorCQl4LlBjaWRldnNbaV0gPSBlCisJfQorCW51bVJkbXMgOj0gaW50KHhjLm51bV9yZG1z
KQorCWNSZG1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfcmRtKSh1bnNhZmUuUG9pbnRl
cih4Yy5yZG1zKSlbOm51bVJkbXM6bnVtUmRtc10KKwl4LlJkbXMgPSBtYWtlKFtdRGV2aWNlUmRt
LCBudW1SZG1zKQorCWZvciBpLCB2IDo9IHJhbmdlIGNSZG1zIHsKKwkJdmFyIGUgRGV2aWNlUmRt
CisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJ
CX0KKwkJeC5SZG1zW2ldID0gZQorCX0KKwludW1EdGRldnMgOj0gaW50KHhjLm51bV9kdGRldnMp
CisJY0R0ZGV2cyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX2R0ZGV2KSh1bnNhZmUuUG9p
bnRlcih4Yy5kdGRldnMpKVs6bnVtRHRkZXZzOm51bUR0ZGV2c10KKwl4LkR0ZGV2cyA9IG1ha2Uo
W11EZXZpY2VEdGRldiwgbnVtRHRkZXZzKQorCWZvciBpLCB2IDo9IHJhbmdlIGNEdGRldnMgewor
CQl2YXIgZSBEZXZpY2VEdGRldgorCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBuaWwg
eworCQkJcmV0dXJuIGVycgorCQl9CisJCXguRHRkZXZzW2ldID0gZQorCX0KKwludW1WZmJzIDo9
IGludCh4Yy5udW1fdmZicykKKwljVmZicyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3Zm
YikodW5zYWZlLlBvaW50ZXIoeGMudmZicykpWzpudW1WZmJzOm51bVZmYnNdCisJeC5WZmJzID0g
bWFrZShbXURldmljZVZmYiwgbnVtVmZicykKKwlmb3IgaSwgdiA6PSByYW5nZSBjVmZicyB7CisJ
CXZhciBlIERldmljZVZmYgorCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBuaWwgewor
CQkJcmV0dXJuIGVycgorCQl9CisJCXguVmZic1tpXSA9IGUKKwl9CisJbnVtVmticyA6PSBpbnQo
eGMubnVtX3ZrYnMpCisJY1ZrYnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV92a2IpKHVu
c2FmZS5Qb2ludGVyKHhjLnZrYnMpKVs6bnVtVmticzpudW1Wa2JzXQorCXguVmticyA9IG1ha2Uo
W11EZXZpY2VWa2IsIG51bVZrYnMpCisJZm9yIGksIHYgOj0gcmFuZ2UgY1ZrYnMgeworCQl2YXIg
ZSBEZXZpY2VWa2IKKwkJaWYgZXJyIDo9IGUuZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJl
dHVybiBlcnIKKwkJfQorCQl4LlZrYnNbaV0gPSBlCisJfQorCW51bVZ0cG1zIDo9IGludCh4Yy5u
dW1fdnRwbXMpCisJY1Z0cG1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdnRwbSkodW5z
YWZlLlBvaW50ZXIoeGMudnRwbXMpKVs6bnVtVnRwbXM6bnVtVnRwbXNdCisJeC5WdHBtcyA9IG1h
a2UoW11EZXZpY2VWdHBtLCBudW1WdHBtcykKKwlmb3IgaSwgdiA6PSByYW5nZSBjVnRwbXMgewor
CQl2YXIgZSBEZXZpY2VWdHBtCisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7
CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5WdHBtc1tpXSA9IGUKKwl9CisJbnVtUDlTIDo9IGlu
dCh4Yy5udW1fcDlzKQorCWNQOVMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV9wOSkodW5z
YWZlLlBvaW50ZXIoeGMucDlzKSlbOm51bVA5UzpudW1QOVNdCisJeC5QOVMgPSBtYWtlKFtdRGV2
aWNlUDksIG51bVA5UykKKwlmb3IgaSwgdiA6PSByYW5nZSBjUDlTIHsKKwkJdmFyIGUgRGV2aWNl
UDkKKwkJaWYgZXJyIDo9IGUuZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIK
KwkJfQorCQl4LlA5U1tpXSA9IGUKKwl9CisJbnVtUHZjYWxsc2lmcyA6PSBpbnQoeGMubnVtX3B2
Y2FsbHNpZnMpCisJY1B2Y2FsbHNpZnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV9wdmNh
bGxzaWYpKHVuc2FmZS5Qb2ludGVyKHhjLnB2Y2FsbHNpZnMpKVs6bnVtUHZjYWxsc2lmczpudW1Q
dmNhbGxzaWZzXQorCXguUHZjYWxsc2lmcyA9IG1ha2UoW11EZXZpY2VQdmNhbGxzaWYsIG51bVB2
Y2FsbHNpZnMpCisJZm9yIGksIHYgOj0gcmFuZ2UgY1B2Y2FsbHNpZnMgeworCQl2YXIgZSBEZXZp
Y2VQdmNhbGxzaWYKKwkJaWYgZXJyIDo9IGUuZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJl
dHVybiBlcnIKKwkJfQorCQl4LlB2Y2FsbHNpZnNbaV0gPSBlCisJfQorCW51bVZkaXNwbHMgOj0g
aW50KHhjLm51bV92ZGlzcGxzKQorCWNWZGlzcGxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZp
Y2VfdmRpc3BsKSh1bnNhZmUuUG9pbnRlcih4Yy52ZGlzcGxzKSlbOm51bVZkaXNwbHM6bnVtVmRp
c3Bsc10KKwl4LlZkaXNwbHMgPSBtYWtlKFtdRGV2aWNlVmRpc3BsLCBudW1WZGlzcGxzKQorCWZv
ciBpLCB2IDo9IHJhbmdlIGNWZGlzcGxzIHsKKwkJdmFyIGUgRGV2aWNlVmRpc3BsCisJCWlmIGVy
ciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5W
ZGlzcGxzW2ldID0gZQorCX0KKwludW1Wc25kcyA6PSBpbnQoeGMubnVtX3ZzbmRzKQorCWNWc25k
cyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3ZzbmQpKHVuc2FmZS5Qb2ludGVyKHhjLnZz
bmRzKSlbOm51bVZzbmRzOm51bVZzbmRzXQorCXguVnNuZHMgPSBtYWtlKFtdRGV2aWNlVnNuZCwg
bnVtVnNuZHMpCisJZm9yIGksIHYgOj0gcmFuZ2UgY1ZzbmRzIHsKKwkJdmFyIGUgRGV2aWNlVnNu
ZAorCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgor
CQl9CisJCXguVnNuZHNbaV0gPSBlCisJfQorCW51bUNoYW5uZWxzIDo9IGludCh4Yy5udW1fY2hh
bm5lbHMpCisJY0NoYW5uZWxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCko
dW5zYWZlLlBvaW50ZXIoeGMuY2hhbm5lbHMpKVs6bnVtQ2hhbm5lbHM6bnVtQ2hhbm5lbHNdCisJ
eC5DaGFubmVscyA9IG1ha2UoW11EZXZpY2VDaGFubmVsLCBudW1DaGFubmVscykKKwlmb3IgaSwg
diA6PSByYW5nZSBjQ2hhbm5lbHMgeworCQl2YXIgZSBEZXZpY2VDaGFubmVsCisJCWlmIGVyciA6
PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5DaGFu
bmVsc1tpXSA9IGUKKwl9CisJbnVtVXNiY3RybHMgOj0gaW50KHhjLm51bV91c2JjdHJscykKKwlj
VXNiY3RybHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV91c2JjdHJsKSh1bnNhZmUuUG9p
bnRlcih4Yy51c2JjdHJscykpWzpudW1Vc2JjdHJsczpudW1Vc2JjdHJsc10KKwl4LlVzYmN0cmxz
ID0gbWFrZShbXURldmljZVVzYmN0cmwsIG51bVVzYmN0cmxzKQorCWZvciBpLCB2IDo9IHJhbmdl
IGNVc2JjdHJscyB7CisJCXZhciBlIERldmljZVVzYmN0cmwKKwkJaWYgZXJyIDo9IGUuZnJvbUMo
JnYpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlVzYmN0cmxzW2ldID0g
ZQorCX0KKwludW1Vc2JkZXZzIDo9IGludCh4Yy5udW1fdXNiZGV2cykKKwljVXNiZGV2cyA6PSAo
KlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3VzYmRldikodW5zYWZlLlBvaW50ZXIoeGMudXNiZGV2
cykpWzpudW1Vc2JkZXZzOm51bVVzYmRldnNdCisJeC5Vc2JkZXZzID0gbWFrZShbXURldmljZVVz
YmRldiwgbnVtVXNiZGV2cykKKwlmb3IgaSwgdiA6PSByYW5nZSBjVXNiZGV2cyB7CisJCXZhciBl
IERldmljZVVzYmRldgorCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJ
cmV0dXJuIGVycgorCQl9CisJCXguVXNiZGV2c1tpXSA9IGUKKwl9CiAJeC5PblBvd2Vyb2ZmID0g
QWN0aW9uT25TaHV0ZG93bih4Yy5vbl9wb3dlcm9mZikKIAl4Lk9uUmVib290ID0gQWN0aW9uT25T
aHV0ZG93bih4Yy5vbl9yZWJvb3QpCiAJeC5PbldhdGNoZG9nID0gQWN0aW9uT25TaHV0ZG93bih4
Yy5vbl93YXRjaGRvZykKQEAgLTExNzMsNiArMTQzNywxNiBAQCBmdW5jICh4ICpWZGlzcGxpbmZv
KSBmcm9tQyh4YyAqQy5saWJ4bF92ZGlzcGxpbmZvKSBlcnJvciB7CiAJeC5EZXZpZCA9IERldmlk
KHhjLmRldmlkKQogCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCiAJeC5CZUFsbG9jID0gYm9vbCh4
Yy5iZV9hbGxvYykKKwludW1Db25uZWN0b3JzIDo9IGludCh4Yy5udW1fY29ubmVjdG9ycykKKwlj
Q29ubmVjdG9ycyA6PSAoKlsxIDw8IDI4XUMubGlieGxfY29ubmVjdG9yaW5mbykodW5zYWZlLlBv
aW50ZXIoeGMuY29ubmVjdG9ycykpWzpudW1Db25uZWN0b3JzOm51bUNvbm5lY3RvcnNdCisJeC5D
b25uZWN0b3JzID0gbWFrZShbXUNvbm5lY3RvcmluZm8sIG51bUNvbm5lY3RvcnMpCisJZm9yIGks
IHYgOj0gcmFuZ2UgY0Nvbm5lY3RvcnMgeworCQl2YXIgZSBDb25uZWN0b3JpbmZvCisJCWlmIGVy
ciA6PSBlLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5D
b25uZWN0b3JzW2ldID0gZQorCX0KIAlyZXR1cm4gbmlsCiB9CiAKQEAgLTExODMsNiArMTQ1Nywx
NiBAQCBmdW5jICh4ICpTdHJlYW1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zdHJlYW1pbmZvKSBl
cnJvciB7CiB9CiAKIGZ1bmMgKHggKlBjbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3BjbWluZm8p
IGVycm9yIHsKKwludW1Wc25kU3RyZWFtcyA6PSBpbnQoeGMubnVtX3ZzbmRfc3RyZWFtcykKKwlj
U3RyZWFtcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfc3RyZWFtaW5mbykodW5zYWZlLlBvaW50ZXIo
eGMuc3RyZWFtcykpWzpudW1Wc25kU3RyZWFtczpudW1Wc25kU3RyZWFtc10KKwl4LlN0cmVhbXMg
PSBtYWtlKFtdU3RyZWFtaW5mbywgbnVtVnNuZFN0cmVhbXMpCisJZm9yIGksIHYgOj0gcmFuZ2Ug
Y1N0cmVhbXMgeworCQl2YXIgZSBTdHJlYW1pbmZvCisJCWlmIGVyciA6PSBlLmZyb21DKCZ2KTsg
ZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5TdHJlYW1zW2ldID0gZQorCX0K
IAlyZXR1cm4gbmlsCiB9CiAKQEAgLTExOTMsNiArMTQ3NywxNiBAQCBmdW5jICh4ICpWc25kaW5m
bykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8pIGVycm9yIHsKIAl4LkZyb250ZW5kSWQgPSB1
aW50MzIoeGMuZnJvbnRlbmRfaWQpCiAJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQogCXguU3Rh
dGUgPSBpbnQoeGMuc3RhdGUpCisJbnVtVnNuZFBjbXMgOj0gaW50KHhjLm51bV92c25kX3BjbXMp
CisJY1BjbXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3BjbWluZm8pKHVuc2FmZS5Qb2ludGVyKHhj
LnBjbXMpKVs6bnVtVnNuZFBjbXM6bnVtVnNuZFBjbXNdCisJeC5QY21zID0gbWFrZShbXVBjbWlu
Zm8sIG51bVZzbmRQY21zKQorCWZvciBpLCB2IDo9IHJhbmdlIGNQY21zIHsKKwkJdmFyIGUgUGNt
aW5mbworCQlpZiBlcnIgOj0gZS5mcm9tQygmdik7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVy
cgorCQl9CisJCXguUGNtc1tpXSA9IGUKKwl9CiAJcmV0dXJuIG5pbAogfQogCkBAIC0xMjExLDYg
KzE1MDUsMTIgQEAgZnVuYyAoeCAqVmtiaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmtiaW5mbykg
ZXJyb3IgewogZnVuYyAoeCAqTnVtYWluZm8pIGZyb21DKHhjICpDLmxpYnhsX251bWFpbmZvKSBl
cnJvciB7CiAJeC5TaXplID0gdWludDY0KHhjLnNpemUpCiAJeC5GcmVlID0gdWludDY0KHhjLmZy
ZWUpCisJbnVtRGlzdHMgOj0gaW50KHhjLm51bV9kaXN0cykKKwljRGlzdHMgOj0gKCpbMSA8PCAy
OF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4Yy5kaXN0cykpWzpudW1EaXN0czpudW1EaXN0
c10KKwl4LkRpc3RzID0gbWFrZShbXXVpbnQzMiwgbnVtRGlzdHMpCisJZm9yIGksIHYgOj0gcmFu
Z2UgY0Rpc3RzIHsKKwkJeC5EaXN0c1tpXSA9IHVpbnQzMih2KQorCX0KIAlyZXR1cm4gbmlsCiB9
CiAKLS0gCjIuMTkuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=

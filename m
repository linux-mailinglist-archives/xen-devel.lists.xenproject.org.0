Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 3C1F9109C01
	for <lists+xen-devel@lfdr.de>; Tue, 26 Nov 2019 11:11:20 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iZXmb-0007kQ-3t; Tue, 26 Nov 2019 10:09:21 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=XQNV=ZS=amazon.de=prvs=226749d31=wipawel@srs-us1.protection.inumbo.net>)
 id 1iZXmZ-0007js-K1
 for xen-devel@lists.xenproject.org; Tue, 26 Nov 2019 10:09:19 +0000
X-Inumbo-ID: cf000762-1034-11ea-a39d-12813bfff9fa
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id cf000762-1034-11ea-a39d-12813bfff9fa;
 Tue, 26 Nov 2019 10:09:19 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1574762959; x=1606298959;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=VotzsJuqfOnl3XulZ8I2zk0d9NIUBmvgTTBGG5XNvUA=;
 b=TEMvWUKzxQrmEzTSzPYKAabEIw1LHKKIDwaMenJKSG5ivlryFN4VVFqL
 bVzZmIJdopB87pHX9/uuzBfXJyGgvYZMd1NY0PnMXOsU6fqNKX3CjrrE4
 W2aOsHzqKSvqs+EkOdu2T44tOhQFemECBD0OOsGDoG01ORHulx4gv1WRd Q=;
IronPort-SDR: RyXTZvto4hZp5hzGgDWRo7acVRx7RYAkfs+XnZZLjL03aSoMDTdtRiHByjWjE7E6WeR8vHI+aw
 pYj/U2vADm5g==
X-IronPort-AV: E=Sophos;i="5.69,245,1571702400"; 
   d="scan'208";a="9921167"
Received: from sea32-co-svc-lb4-vlan3.sea.corp.amazon.com (HELO
 email-inbound-relay-1e-17c49630.us-east-1.amazon.com) ([10.47.23.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 26 Nov 2019 10:08:56 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1e-17c49630.us-east-1.amazon.com (Postfix) with ESMTPS
 id 038E9A2B3B; Tue, 26 Nov 2019 10:08:52 +0000 (UTC)
Received: from EX13D05EUB003.ant.amazon.com (10.43.166.253) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 26 Nov 2019 10:08:37 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D05EUB003.ant.amazon.com (10.43.166.253) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 26 Nov 2019 10:08:36 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Tue, 26 Nov 2019 10:08:34 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Tue, 26 Nov 2019 10:07:59 +0000
Message-ID: <20191126100801.124844-11-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20191126100801.124844-1-wipawel@amazon.de>
References: <20191126100801.124844-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v6 10/12] livepatch: Handle arbitrary size names
 with the list operation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>, Andrew
 Cooper <andrew.cooper3@citrix.com>, Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Pawel Wieczorkiewicz <wipawel@amazon.de>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHBheWxvYWRzJyBuYW1lIHN0cmluZ3MgY2FuIGJlIG9mIGFyYml0cmFyeSBzaXplICh0eXBp
Y2FsbHkgc21hbGwKd2l0aCBhbiB1cHBlciBib3VuZCBvZiBYRU5fTElWRVBBVENIX05BTUVfU0la
RSkuCkN1cnJlbnQgaW1wbGVtZW50YXRpb24gb2YgdGhlIGxpc3Qgb3BlcmF0aW9uIGludGVyZmFj
ZSBhbGxvd3MgdG8gY29weQpuYW1lcyBpbiB0aGUgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUgY2h1
bmtzIHJlZ2FyZGxlc3Mgb2YgaXRzIGFjdHVhbApzaXplIGFuZCBlbmZvcmNlcyBzcGFjZSBhbGxv
Y2F0aW9uIHJlcXVpcmVtZW50cyBvbiB1c2VybGFuZCB0b29scy4KClRvIHVuaWZ5IGFuZCBzaW1w
bGlmeSB0aGUgaW50ZXJmYWNlLCBoYW5kbGUgdGhlIG5hbWUgc3RyaW5ncyBvZgphcmJpdHJhcnkg
c2l6ZSBieSBjb3B5aW5nIHRoZW0gaW4gYWRoZXJpbmcgY2h1bmtzIHRvIHRoZSB1c2VybGFuZC4K
SW4gb3JkZXIgdG8gbGV0IHRoZSB1c2VybGFuZCBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgZm9yIHRo
ZSBpbmNvbWluZwpkYXRhIGFkZCBhbiBhdXhpbGlhcnkgaW50ZXJmYWNlIHhjX2xpdmVwYXRjaF9s
aXN0X2dldF9zaXplcygpIHRoYXQKcHJvdmlkZXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxv
YWQgZW50cmllcyBhbmQgdGhlIHRvdGFsIHNpemUgb2YKYWxsIG5hbWUgc3RyaW5ncy4gVGhpcyBp
cyBhY2hpZXZlZCBieSBleHRlbmRpbmcgdGhlIHN5c2N0bCBsaXN0CmludGVyZmFjZSB3aXRoIGFu
IGV4dHJhIGZpZWxkczogbmFtZV90b3RhbF9zaXplLgoKVGhlIHhjX2xpdmVwYXRjaF9saXN0X2dl
dF9zaXplcygpIGlzc3VlcyB0aGUgbGl2ZXBhdGNoIHN5c2N0bCBsaXN0Cm9wZXJhdGlvbiB3aXRo
IHRoZSBuciBmaWVsZCBzZXQgdG8gMC4gSW4gdGhpcyBtb2RlIHRoZSBvcGVyYXRpb24KcmV0dXJu
cyB0aGUgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcyBhbmQgY2FsY3VsYXRlcyB0aGUgdG90YWwg
c2l6ZXMKZm9yIGFsbCBwYXlsb2FkcycgbmFtZXMuCldoZW4gdGhlIHN5c2N0bCBvcGVyYXRpb24g
aXMgaXNzdWVkIHdpdGggYSBub24temVybyBuciBmaWVsZCAoZm9yCmluc3RhbmNlIHdpdGggYSB2
YWx1ZSBvYnRhaW5lZCBlYXJsaWVyIHdpdGggdGhlIHByaW9yIGNhbGwgdG8gdGhlCnhjX2xpdmVw
YXRjaF9saXN0X2dldF9zaXplcygpKSB0aGUgbmV3IGZpZWxkIG5hbWVfdG90YWxfc2l6ZSBwcm92
aWRlcwp0aGUgdG90YWwgc2l6ZSBvZiBhY3R1YWxseSBjb3BpZWQgZGF0YS4KCkV4dGVuZCB0aGUg
bGlieGMgdG8gaGFuZGxlIHRoZSBuYW1lIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycy4KClRo
ZSB4ZW4tbGl2ZXBhdGNoIHRvb2wgaXMgbW9kaWZpZWQgdG8gc3RhcnQgdGhlIGxpc3Qgb3BlcmF0
aW9uIHdpdGggYQpjYWxsIHRvIHRoZSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSB0byBv
YnRhaW4gdGhlIGFjdHVhbCBudW1iZXIKb2YgcGF5bG9hZHMgYXMgd2VsbCBhcyB0aGUgbmVjZXNz
YXJ5IHNwYWNlIGZvciBuYW1lcy4KVGhlIHRvb2wgbm93IGFsd2F5cyByZXF1ZXN0cyB0aGUgYWN0
dWFsIG51bWJlciBvZiBlbnRyaWVzIGFuZCBsZWF2ZXMKdGhlIHByZWVtcHRpb24gaGFuZGxpbmcg
dG8gdGhlIGxpYnhjIHJvdXRpbmUuIFRoZSBsaWJ4YyBzdGlsbCByZXR1cm5zCidkb25lJyBhbmQg
J2xlZnQnIHBhcmFtZXRlcnMgd2l0aCB0aGUgc2FtZSBzZW1hbnRpYyBhbGxvd2luZyB0aGUgdG9v
bAp0byBkZXRlY3QgYW5vbWFsaWVzIGFuZCByZWFjdCB0byB0aGVtLiBBdCB0aGUgbW9tZW50IGl0
IGlzIGV4cGVjdGVkCnRoYXQgdGhlIHRvb2wgcmVjZWl2ZXMgdGhlIGV4YWN0IG51bWJlciBvZiBl
bnRyaWVzIGFzIHJlcXVlc3RlZC4KVGhlIHhlbi1saXZlcGF0Y2ggdG9vbCBoYXMgYmVlbiBhbHNv
IG1vZGlmaWVkIHRvIGhhbmRsZSB0aGUgbmFtZQpiYWNrLXRvLWJhY2sgdHJhbnNmZXJzIGNvcnJl
Y3RseS4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpv
bi5kZT4KUmV2aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9u
LmNvbT4KUmV2aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmll
d2VkLWJ5OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5
OiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+ClJldmlld2Vk
LWJ5OiBSb3NzIExhZ2Vyd2FsbCA8cm9zcy5sYWdlcndhbGxAY2l0cml4LmNvbT4KLS0tCkNoYW5n
ZWQgc2luY2UgdjQ6CiAgKiByZW1vdmUgJ3BhZCcgZmllbGQgZnJvbSBsaXN0IHN5c2N0bAoKQ2hh
bmdlZCBzaW5jZSB2MzoKICAqIHVzZSB1aW50MzJfdCBpbnN0ZWFkIG9mIHVpbnQ2NF90IGFuZCBv
ZmZfdCBmb3IgbmFtZV90b3RhbF9zaXplCiAgICBhbmQgcmVsYXRlZCB2YXJpYWJsZXMKCkNoYW5n
ZWQgc2luY2UgdjE6CiAgKiBhZGRlZCBjb3JyZXNwb25kaW5nIGRvY3VtZW50YXRpb24KLS0tCiBk
b2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYyAgICB8ICAyNiArKysrKy0tLS0tCiB0b29scy9saWJ4
Yy9pbmNsdWRlL3hlbmN0cmwuaCB8ICA0OSArKysrKysrKysrKysrLS0tLS0tCiB0b29scy9saWJ4
Yy94Y19taXNjLmMgICAgICAgICB8IDEwMCArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0t
LS0tLS0tCiB0b29scy9taXNjL3hlbi1saXZlcGF0Y2guYyAgICB8IDExMSArKysrKysrKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9jb21tb24vbGl2ZXBhdGNoLmMgICAg
ICAgIHwgIDM0ICsrKysrKysrKy0tLS0KIHhlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCAgIHwg
IDE2ICsrKy0tLQogNiBmaWxlcyBjaGFuZ2VkLCAyMTggaW5zZXJ0aW9ucygrKSwgMTE4IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jIGIvZG9jcy9t
aXNjL2xpdmVwYXRjaC5wYW5kb2MKaW5kZXggNGY5MjM4ZDIzNS4uNDNkMDg5NmFhOCAxMDA2NDQK
LS0tIGEvZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MKKysrIGIvZG9jcy9taXNjL2xpdmVwYXRj
aC5wYW5kb2MKQEAgLTcxNywxNyArNzE3LDE5IEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBg
aWR4YCBJbmRleCBpdGVyYXRvci4gVGhlIGluZGV4IGludG8gdGhlIGh5cGVydmlzb3IncyBwYXls
b2FkIGNvdW50LiBJdCBpcwogICAgIHJlY29tbWVuZGVkIHRoYXQgb24gZmlyc3QgaW52b2NhdGlv
biB6ZXJvIGJlIHVzZWQgc28gdGhhdCBgbnJgICh3aGljaCB0aGUKICAgICBoeXBlcnZpc29yIHdp
bGwgdXBkYXRlIHdpdGggdGhlIHJlbWFpbmluZyBwYXlsb2FkIGNvdW50KSBiZSBwcm92aWRlZC4K
LSAgICBBbHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVyc2lvbmAgd2l0aCB0aGUg
bW9zdCBjdXJyZW50IHZhbHVlLgorICAgIEFsc28gdGhlIGh5cGVydmlzb3Igd2lsbCBwcm92aWRl
IGB2ZXJzaW9uYCB3aXRoIHRoZSBtb3N0IGN1cnJlbnQgdmFsdWUgYW5kCisgICAgY2FsY3VsYXRl
ZCB0b3RhbCBzaXplIGZvciBhbGwgcGF5bG9hZHMnIG5hbWVzLgogICogYG5yYCBUaGUgbWF4IG51
bWJlciBvZiBlbnRyaWVzIHRvIHBvcHVsYXRlLiBDYW4gYmUgemVybyB3aGljaCB3aWxsIHJlc3Vs
dAogICAgIGluIHRoZSBoeXBlcmNhbGwgYmVpbmcgYSBwcm9iaW5nIG9uZSBhbmQgcmV0dXJuIHRo
ZSBudW1iZXIgb2YgcGF5bG9hZHMKICAgICAoYW5kIHVwZGF0ZSB0aGUgYHZlcnNpb25gKS4KLSAq
IGBwYWRgIC0gKk1VU1QqIGJlIHplcm8uCiAgKiBgc3RhdHVzYCBWaXJ0dWFsIGFkZHJlc3Mgb2Yg
d2hlcmUgdG8gd3JpdGUgYHN0cnVjdCB4ZW5fbGl2ZXBhdGNoX3N0YXR1c2AKICAgIHN0cnVjdHVy
ZXMuIENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0aGVtLgotICogYG5hbWVg
IC0gVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdyaXRlIHRoZSB1bmlxdWUgbmFtZSBvZiB0
aGUgcGF5bG9hZC4KLSAgIENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0aGVt
LiBFYWNoICpNVVNUKiBiZSBvZgotICAgKipYRU5fTElWRVBBVENIX05BTUVfU0laRSoqIHNpemUu
IE5vdGUgdGhhdCAqKlhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFKiogaW5jbHVkZXMKLSAgIHRoZSBO
VUwgdGVybWluYXRvci4KKyAqIGBuYW1lYCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3
cml0ZSB0aGUgdW5pcXVlIG5hbWUgb2YgdGhlIHBheWxvYWRzLgorICAgQ2FsbGVyICpNVVNUKiBh
bGxvY2F0ZSBlbm91Z2ggc3BhY2UgdG8gYmUgYWJsZSB0byBzdG9yZSBhbGwgcmVjZWl2ZWQgZGF0
YQorICAgKGkuZS4gdG90YWwgYWxsb2NhdGVkIHNwYWNlICpNVVNUKiBtYXRjaCB0aGUgYG5hbWVf
dG90YWxfc2l6ZWAgdmFsdWUKKyAgIHByb3ZpZGVkIGJ5IHRoZSBoeXBlcnZpc29yKS4gSW5kaXZp
ZHVhbCBwYXlsb2FkIG5hbWUgY2Fubm90IGJlIGxvbmdlciB0aGFuCisgICAqKlhFTl9MSVZFUEFU
Q0hfTkFNRV9TSVpFKiogYnl0ZXMuIE5vdGUgdGhhdCAqKlhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpF
KioKKyAgIGluY2x1ZGVzIHRoZSBOVUwgdGVybWluYXRvci4KICAqIGBsZW5gIC0gVmlydHVhbCBh
ZGRyZXNzIG9mIHdoZXJlIHRvIHdyaXRlIHRoZSBsZW5ndGggb2YgZWFjaCB1bmlxdWUgbmFtZQog
ICAgb2YgdGhlIHBheWxvYWQuIENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0
aGVtLiBFYWNoICpNVVNUKiBiZQogICAgb2Ygc2l6ZW9mKHVpbnQzMl90KSAoNCBieXRlcykuCkBA
IC03MzYsNyArNzM4LDggQEAgSWYgdGhlIGh5cGVyY2FsbCByZXR1cm5zIGFuIHBvc2l0aXZlIG51
bWJlciwgaXQgaXMgdGhlIG51bWJlciAodXB0byBgbnJgCiBwcm92aWRlZCB0byB0aGUgaHlwZXJj
YWxsKSBvZiB0aGUgcGF5bG9hZHMgcmV0dXJuZWQsIGFsb25nIHdpdGggYG5yYCB1cGRhdGVkCiB3
aXRoIHRoZSBudW1iZXIgb2YgcmVtYWluaW5nIHBheWxvYWRzLCBgdmVyc2lvbmAgdXBkYXRlZCAo
aXQgbWF5IGJlIHRoZSBzYW1lCiBhY3Jvc3MgaHlwZXJjYWxscyAtIGlmIGl0IHZhcmllcyB0aGUg
ZGF0YSBpcyBzdGFsZSBhbmQgZnVydGhlciBjYWxscyBjb3VsZAotZmFpbCkuIFRoZSBgc3RhdHVz
YCwgYG5hbWVgLCBhbmQgYGxlbmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgK
K2ZhaWwpIGFuZCB0aGUgYG5hbWVfdG90YWxfc2l6ZWAgY29udGFpbmluZyB0b3RhbCBzaXplIG9m
IHRyYW5zZmVycmVkIGRhdGEgZm9yCit0aGUgYXJyYXkuIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBh
bmQgYGxlbmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgKIHZhbHVlIChgaWR4
YCkgd2l0aCB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4KIAogSWYgdGhlIGh5cGVyY2FsbCBy
ZXR1cm5zIC1YRU5fRTJCSUcgdGhlIGBucmAgaXMgdG9vIGJpZyBhbmQgc2hvdWxkIGJlCkBAIC03
NzQsMTIgKzc3NywxMyBAQCBUaGUgc3RydWN0dXJlIGlzIGFzIGZvbGxvdzoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZCBiZSBmaWxsZWQg
b3V0LiBDYW4gYmUgemVybyB0byBnZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGFtb3VudCBvZiBwYXlsb2FkcyBhbmQgdmVyc2lvbi4KICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9VVDogSG93IG1h
bnkgcGF5bG9hZHMgbGVmdC4gKi8KLSAgICAgICAgdWludDMyX3QgcGFkOyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIC8qIElOOiBNdXN0IGJlIHplcm8uICovCisgICAgICAgIHVpbnQzMl90IG5h
bWVfdG90YWxfc2l6ZTsgICAgICAgICAgICAgICAvKiBPVVQ6IFRvdGFsIHNpemUgb2YgYWxsIHRy
YW5zZmVyIG5hbWVzICovCiAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoeGVuX2xpdmVwYXRj
aF9zdGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBNdXN0IGhhdmUgZW5vdWdoCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFjZSBhbGxvY2F0ZSBm
b3IgbnIgb2YgdGhlbS4gKi8KLSAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBpZDsg
ICAgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVtYmVyCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNVVNUIFhFTl9MSVZFUEFU
Q0hfTkFNRV9TSVpFIGluIHNpemUuCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KKyAgICAgICAgWEVOX0dV
RVNUX0hBTkRMRV82NChjaGFyKSBuYW1lOyAgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFtZXMu
IEVhY2ggbWVtYmVyCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBtYXkgaGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoIHVwIHRvCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5fTElWRVBBVENIX05BTUVf
U0laRSBieXRlcy4gTXVzdCBoYXZlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBuciBvZiB0aGVtLiAqLwogICAgICAgICBYRU5fR1VFU1RfSEFORExF
XzY0KHVpbnQzMikgbGVuOyAgICAgICAgLyogT1VUOiBBcnJheSBvZiBsZW5ndGhzIG9mIG5hbWUn
cy4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11
c3QgaGF2ZSBuciBvZiB0aGVtLiAqLwogICAgIH07CmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy9p
bmNsdWRlL3hlbmN0cmwuaCBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCmluZGV4IGIw
NjczOGM0NzEuLmY0OTBhNmRlYmMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVu
Y3RybC5oCisrKyBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCkBAIC0yNTU4LDcgKzI1
NTgsMjUgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiAgICAgICAg
ICAgICAgICAgICAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICpzdGF0dXMpOwogCiAvKgotICog
VGhlIGhlYXJ0IG9mIHRoaXMgZnVuY3Rpb24gaXMgdG8gZ2V0IGFuIGFycmF5IG9mIHhlbl9saXZl
cGF0Y2hfc3RhdHVzX3QuCisgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxhYmxlIHBheWxvYWRzIGFu
ZCBnZXQgYWN0dWFsIHRvdGFsIHNpemUgb2YKKyAqIHRoZSBwYXlsb2FkcycgbmFtZSBhcnJheS4K
KyAqCisgKiBUaGlzIGZ1bmN0aW9ucyBpcyB0eXBpY2FsbHkgZXhlY3V0ZWQgZmlyc3QgYmVmb3Jl
IHRoZSB4Y19saXZlcGF0Y2hfbGlzdCgpCisgKiB0byBvYnRhaW4gdGhlIHNpemVzIGFuZCBjb3Jy
ZWN0bHkgYWxsb2NhdGUgYWxsIG5lY2Vzc2FyeSBkYXRhIHJlc291cmNlcy4KKyAqCisgKiBUaGUg
cmV0dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVyY2FsbCBjb21wbGV0ZWQgc3VjY2Vzc2Z1
bGx5LgorICoKKyAqIElmIHRoZXJlIHdhcyBhbiBlcnJvciBwZXJmb3JtaW5nIHRoZSBzeXNjdGwg
b3BlcmF0aW9uLCB0aGUgcmV0dXJuIHZhbHVlCisgKiB3aWxsIGNvbnRhaW4gdGhlIGh5cGVyY2Fs
bCBlcnJvciBjb2RlIHZhbHVlLgorICovCitpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVz
KHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3RhbF9zaXplKTsKKworLyoKKyAqIFRoZSBo
ZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIGdldCBhbiBhcnJheSBvZiB0aGUgZm9sbG93aW5n
IG9iamVjdHM6CisgKiAgIC0geGVuX2xpdmVwYXRjaF9zdGF0dXNfdDogc3RhdGVzIGFuZCByZXR1
cm4gY29kZXMgb2YgcGF5bG9hZHMKKyAqICAgLSBuYW1lOiBuYW1lcyBvZiBwYXlsb2FkcworICog
ICAtIGxlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxvYWRzJyBuYW1lcwogICoKICAq
IEhvd2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNlIGl0IGhhcyB0byBkZWFsIHdpdGggdGhlIGh5
cGVydmlzb3IKICAqIHJldHVybmluZyBzb21lIG9mIHRoZSByZXF1ZXN0ZWQgZGF0YSBvciBkYXRh
IGJlaW5nIHN0YWxlCkBAIC0yNTY5LDIxICsyNTg3LDIwIEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0
KHhjX2ludGVyZmFjZSAqeGNoLAogICogJ2xlZnQnIGFyZSBhbHNvIHVwZGF0ZWQgd2l0aCB0aGUg
bnVtYmVyIG9mIGVudHJpZXMgZmlsbGVkIG91dAogICogYW5kIHJlc3BlY3RpdmVseSB0aGUgbnVt
YmVyIG9mIGVudHJpZXMgbGVmdCB0byBnZXQgZnJvbSBoeXBlcnZpc29yLgogICoKLSAqIEl0IGlz
IGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9uIHdpbGwgdGFrZSB0aGUK
LSAqICdsZWZ0JyBhbmQgdXNlIHRoZSB2YWx1ZSBmb3IgJ3N0YXJ0Jy4gVGhpcyB3YXkgd2UgaGF2
ZSBhbgotICogY3Vyc29yIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHRoZSAnaW5mbycsJ25hbWUn
LCBhbmQgJ2xlbicgd2lsbAotICogYmUgdXBkYXRlZCBhdCB0aGUgc3Vic2VxdWVudCBjYWxscy4K
KyAqIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9uIHdpbGwg
Zmlyc3QgaXNzdWUgdGhlCisgKiB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSBpbiBvcmRl
ciB0byBvYnRhaW4gdG90YWwgc2l6ZXMgb2YgbmFtZXMKKyAqIGFzIHdlbGwgYXMgdGhlIGN1cnJl
bnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcy4KKyAqIFRoZSB0b3RhbCBzaXplcyBhcmUgcmVx
dWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6ZScKKyAqIHBhcmFtZXRl
ci4KICAqCi0gKiBUaGUgJ21heCcgaXMgdG8gYmUgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciB3aXRo
IHRoZSBtYXhpbXVtCi0gKiBudW1iZXIgb2YgZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCBh
bmQgJ2xlbicgYXJyYXlzIGNhbgotICogYmUgZmlsbGVkIHVwIHdpdGguCi0gKgotICogRWFjaCBl
bnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIFhFTl9MSVZFUEFU
Q0hfTkFNRV9TSVpFCi0gKiBsZW5ndGguCisgKiBUaGUgJ21heCcgaXMgdG8gYmUgcHJvdmlkZWQg
YnkgdGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtIG51bWJlciBvZgorICogZW50cmllcyB0aGF0
ICdpbmZvJywgJ25hbWUnLCAnbGVuJyBhcnJheXMgY2FuIGJlIGZpbGxlZCB1cCB3aXRoLgogICoK
ICAqIEVhY2ggZW50cnkgaW4gdGhlICdpbmZvJyBhcnJheSBpcyBleHBlY3RlZCB0byBiZSBvZiB4
ZW5fbGl2ZXBhdGNoX3N0YXR1c190CiAgKiBzdHJ1Y3R1cmUgc2l6ZS4KICAqCisgKiBFYWNoIGVu
dHJ5IGluIHRoZSAnbmFtZScgYXJyYXkgbWF5IGhhdmUgYW4gYXJiaXRyYXJ5IHNpemUuCisgKgog
ICogRWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWlu
dDMyX3Qgc2l6ZS4KICAqCiAgKiBUaGUgcmV0dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVy
Y2FsbCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LgpAQCAtMjU5NSwxMCArMjYxMiwxMiBAQCBpbnQg
eGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdpbGwgY29udGFpbiB0aGUg
bnVtYmVyIG9mIGVudHJpZXMgdGhhdCBoYWQgYmVlbiBzdWNjZXNmdWxseQogICogcmV0cmlldmVk
IChpZiBhbnkpLgogICovCi1pbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gs
IHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKLSAgICAgICAgICAgICAgICAg
ICAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICppbmZvLCBjaGFyICpuYW1lLAotICAgICAgICAg
ICAgICAgICAgICAgIHVpbnQzMl90ICpsZW4sIHVuc2lnbmVkIGludCAqZG9uZSwKLSAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmxlZnQpOworaW50IHhjX2xpdmVwYXRjaF9saXN0
KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAorICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBzdGFydCwKKyAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmluZm8sCisgICAgICAgICAgICAgICAgICAg
ICAgY2hhciAqbmFtZSwgdWludDMyX3QgKmxlbiwKKyAgICAgICAgICAgICAgICAgICAgICBjb25z
dCB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWdu
ZWQgaW50ICpkb25lLCB1bnNpZ25lZCBpbnQgKmxlZnQpOwogCiAvKgogICogVGhlIG9wZXJhdGlv
bnMgYXJlIGFzeW5jaHJvbm91cyBhbmQgdGhlIGh5cGVydmlzb3IgbWF5IHRha2UgYSB3aGlsZQpk
aWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfbWlzYy5jIGIvdG9vbHMvbGlieGMveGNfbWlzYy5j
CmluZGV4IDMzNjU4MDEzNWUuLjU4MGQyNTQ1OTMgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL3hj
X21pc2MuYworKysgYi90b29scy9saWJ4Yy94Y19taXNjLmMKQEAgLTY2Miw3ICs2NjIsNDggQEAg
aW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiB9CiAKIC8qCi0gKiBUaGUg
aGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBnZXQgYW4gYXJyYXkgb2YgeGVuX2xpdmVwYXRj
aF9zdGF0dXNfdC4KKyAqIEdldCBhIG51bWJlciBvZiBhdmFpbGFibGUgcGF5bG9hZHMgYW5kIGdl
dCBhY3R1YWwgdG90YWwgc2l6ZSBvZgorICogdGhlIHBheWxvYWRzJyBuYW1lIGFycmF5LgorICoK
KyAqIFRoaXMgZnVuY3Rpb25zIGlzIHR5cGljYWxseSBleGVjdXRlZCBmaXJzdCBiZWZvcmUgdGhl
IHhjX2xpdmVwYXRjaF9saXN0KCkKKyAqIHRvIG9idGFpbiB0aGUgc2l6ZXMgYW5kIGNvcnJlY3Rs
eSBhbGxvY2F0ZSBhbGwgbmVjZXNzYXJ5IGRhdGEgcmVzb3VyY2VzLgorICoKKyAqIFRoZSByZXR1
cm4gdmFsdWUgaXMgemVybyBpZiB0aGUgaHlwZXJjYWxsIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHku
CisgKgorICogSWYgdGhlcmUgd2FzIGFuIGVycm9yIHBlcmZvcm1pbmcgdGhlIHN5c2N0bCBvcGVy
YXRpb24sIHRoZSByZXR1cm4gdmFsdWUKKyAqIHdpbGwgY29udGFpbiB0aGUgaHlwZXJjYWxsIGVy
cm9yIGNvZGUgdmFsdWUuCisgKi8KK2ludCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNf
aW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVpbnQzMl90ICpuYW1lX3RvdGFsX3NpemUpCit7CisgICAgREVDTEFSRV9TWVND
VEw7CisgICAgaW50IHJjOworCisgICAgaWYgKCAhbnIgfHwgIW5hbWVfdG90YWxfc2l6ZSApCisg
ICAgeworICAgICAgICBlcnJubyA9IEVJTlZBTDsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0K
KworICAgIG1lbXNldCgmc3lzY3RsLCAwLCBzaXplb2Yoc3lzY3RsKSk7CisgICAgc3lzY3RsLmNt
ZCA9IFhFTl9TWVNDVExfbGl2ZXBhdGNoX29wOworICAgIHN5c2N0bC51LmxpdmVwYXRjaC5jbWQg
PSBYRU5fU1lTQ1RMX0xJVkVQQVRDSF9MSVNUOworCisgICAgcmMgPSBkb19zeXNjdGwoeGNoLCAm
c3lzY3RsKTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgcmV0dXJuIHJjOworCisgICAgKm5yID0g
c3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5ucjsKKyAgICAqbmFtZV90b3RhbF9zaXplID0gc3lz
Y3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uYW1lX3RvdGFsX3NpemU7CisKKyAgICByZXR1cm4gMDsK
K30KKworLyoKKyAqIFRoZSBoZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIGdldCBhbiBhcnJh
eSBvZiB0aGUgZm9sbG93aW5nIG9iamVjdHM6CisgKiAgIC0geGVuX2xpdmVwYXRjaF9zdGF0dXNf
dDogc3RhdGVzIGFuZCByZXR1cm4gY29kZXMgb2YgcGF5bG9hZHMKKyAqICAgLSBuYW1lOiBuYW1l
cyBvZiBwYXlsb2FkcworICogICAtIGxlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxv
YWRzJyBuYW1lcwogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNlIGl0IGhhcyB0
byBkZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBzb21lIG9mIHRoZSByZXF1
ZXN0ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC02NzMsMjEgKzcxNCwyMCBAQCBpbnQg
eGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqICdsZWZ0JyBhcmUgYWxzbyB1
cGRhdGVkIHdpdGggdGhlIG51bWJlciBvZiBlbnRyaWVzIGZpbGxlZCBvdXQKICAqIGFuZCByZXNw
ZWN0aXZlbHkgdGhlIG51bWJlciBvZiBlbnRyaWVzIGxlZnQgdG8gZ2V0IGZyb20gaHlwZXJ2aXNv
ci4KICAqCi0gKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlv
biB3aWxsIHRha2UgdGhlCi0gKiAnbGVmdCcgYW5kIHVzZSB0aGUgdmFsdWUgZm9yICdzdGFydCcu
IFRoaXMgd2F5IHdlIGhhdmUgYW4KLSAqIGN1cnNvciBpbiB0aGUgYXJyYXkuIE5vdGUgdGhhdCB0
aGUgJ2luZm8nLCduYW1lJywgYW5kICdsZW4nIHdpbGwKLSAqIGJlIHVwZGF0ZWQgYXQgdGhlIHN1
YnNlcXVlbnQgY2FsbHMuCisgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIgb2YgdGhp
cyBmdW5jdGlvbiB3aWxsIGZpcnN0IGlzc3VlIHRoZQorICogeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0
X3NpemVzKCkgaW4gb3JkZXIgdG8gb2J0YWluIHRvdGFsIHNpemVzIG9mIG5hbWVzCisgKiBhcyB3
ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJpZXMuCisgKiBUaGUgdG90
YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhlICduYW1lX3RvdGFsX3Np
emUnCisgKiBwYXJhbWV0ZXIuCiAgKgotICogVGhlICdtYXgnIGlzIHRvIGJlIHByb3ZpZGVkIGJ5
IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4aW11bQotICogbnVtYmVyIG9mIGVudHJpZXMgdGhhdCAn
aW5mbycsICduYW1lJywgYW5kICdsZW4nIGFycmF5cyBjYW4KLSAqIGJlIGZpbGxlZCB1cCB3aXRo
LgotICoKLSAqIEVhY2ggZW50cnkgaW4gdGhlICduYW1lJyBhcnJheSBpcyBleHBlY3RlZCB0byBi
ZSBvZiBYRU5fTElWRVBBVENIX05BTUVfU0laRQotICogbGVuZ3RoLgorICogVGhlICdtYXgnIGlz
IHRvIGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4aW11bSBudW1iZXIgb2YK
KyAqIGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgJ2xlbicgYXJyYXlzIGNhbiBiZSBmaWxs
ZWQgdXAgd2l0aC4KICAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnaW5mbycgYXJyYXkgaXMgZXhw
ZWN0ZWQgdG8gYmUgb2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdAogICogc3RydWN0dXJlIHNpemUu
CiAgKgorICogRWFjaCBlbnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IG1heSBoYXZlIGFuIGFyYml0
cmFyeSBzaXplLgorICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdsZW4nIGFycmF5IGlzIGV4cGVj
dGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCiAgKgogICogVGhlIHJldHVybiB2YWx1ZSBpcyB6
ZXJvIGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4KQEAgLTY5OSwxMSAr
NzM5LDEyIEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFjZSAqeGNoLAogICogd2ls
bCBjb250YWluIHRoZSBudW1iZXIgb2YgZW50cmllcyB0aGF0IGhhZCBiZWVuIHN1Y2Nlc2Z1bGx5
CiAgKiByZXRyaWV2ZWQgKGlmIGFueSkuCiAgKi8KLWludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19p
bnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50IG1heCwgdW5zaWduZWQgaW50IHN0YXJ0LAoraW50
IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQg
bWF4LAorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBzdGFydCwKICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmluZm8sCiAg
ICAgICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3QgKmxlbiwKLSAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmRvbmUsCi0gICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgaW50ICpsZWZ0KQorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVpbnQzMl90
IG5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmRv
bmUsIHVuc2lnbmVkIGludCAqbGVmdCkKIHsKICAgICBpbnQgcmM7CiAgICAgREVDTEFSRV9TWVND
VEw7CkBAIC03MTQsMjcgKzc1NSwzMyBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJm
YWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKICAgICB1aW50
MzJfdCBtYXhfYmF0Y2hfc3osIG5yOwogICAgIHVpbnQzMl90IHZlcnNpb24gPSAwLCByZXRyaWVz
ID0gMDsKICAgICB1aW50MzJfdCBhZGp1c3QgPSAwOwotICAgIHNzaXplX3Qgc3o7CisgICAgdWlu
dDMyX3QgbmFtZV9vZmYgPSAwOworICAgIHVpbnQzMl90IG5hbWVfc3o7CiAKLSAgICBpZiAoICFt
YXggfHwgIWluZm8gfHwgIW5hbWUgfHwgIWxlbiApCisgICAgaWYgKCAhbWF4IHx8ICFpbmZvIHx8
ICFuYW1lIHx8ICFsZW4gfHwgIWRvbmUgfHwgIWxlZnQgKQogICAgIHsKICAgICAgICAgZXJybm8g
PSBFSU5WQUw7CiAgICAgICAgIHJldHVybiAtMTsKICAgICB9CiAKKyAgICBpZiAoIG5hbWVfdG90
YWxfc2l6ZSA9PSAwICkKKyAgICB7CisgICAgICAgIGVycm5vID0gRU5PRU5UOworICAgICAgICBy
ZXR1cm4gLTE7CisgICAgfQorCisgICAgbWVtc2V0KCZzeXNjdGwsIDAsIHNpemVvZihzeXNjdGwp
KTsKICAgICBzeXNjdGwuY21kID0gWEVOX1NZU0NUTF9saXZlcGF0Y2hfb3A7CiAgICAgc3lzY3Rs
LnUubGl2ZXBhdGNoLmNtZCA9IFhFTl9TWVNDVExfTElWRVBBVENIX0xJU1Q7Ci0gICAgc3lzY3Rs
LnUubGl2ZXBhdGNoLnBhZCA9IDA7Ci0gICAgc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC52ZXJz
aW9uID0gMDsKICAgICBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0LmlkeCA9IHN0YXJ0OwotICAg
IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QucGFkID0gMDsKIAogICAgIG1heF9iYXRjaF9zeiA9
IG1heDsKLSAgICAvKiBDb252aWVuY2UgdmFsdWUuICovCi0gICAgc3ogPSBzaXplb2YoKm5hbWUp
ICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkU7CisgICAgbmFtZV9zeiA9IG5hbWVfdG90YWxfc2l6
ZTsKICAgICAqZG9uZSA9IDA7CiAgICAgKmxlZnQgPSAwOwogICAgIGRvIHsKKyAgICAgICAgdWlu
dDMyX3QgX25hbWVfc3o7CisKICAgICAgICAgLyoKICAgICAgICAgICogVGhlIGZpcnN0IHRpbWUg
d2UgZ28gaW4gdGhpcyBsb29wIG91ciAnbWF4JyBtYXkgYmUgYmlnZ2VyCiAgICAgICAgICAqIHRo
YW4gd2hhdCB0aGUgaHlwZXJ2aXNvciBpcyBjb21mb3J0YWJsZSB3aXRoIC0gaGVuY2UgdGhlIGZp
cnN0CkBAIC03NTQsMTEgKzgwMSwxMSBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJm
YWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKICAgICAgICAg
c3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uciA9IG5yOwogICAgICAgICAvKiBGaXggdGhlIHNp
emUgKG1heSB2YXJ5IGJldHdlZW4gaHlwZXJjYWxscykuICovCiAgICAgICAgIEhZUEVSQ0FMTF9C
T1VOQ0VfU0VUX1NJWkUoaW5mbywgbnIgKiBzaXplb2YoKmluZm8pKTsKLSAgICAgICAgSFlQRVJD
QUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBuciAqIG5yKTsKKyAgICAgICAgSFlQRVJDQUxMX0JP
VU5DRV9TRVRfU0laRShuYW1lLCBuYW1lX3N6KTsKICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9T
RVRfU0laRShsZW4sIG5yICogc2l6ZW9mKCpsZW4pKTsKICAgICAgICAgLyogTW92ZSB0aGUgcG9p
bnRlciB0byBwcm9wZXIgb2Zmc2V0IGludG8gJ2luZm8nLiAqLwogICAgICAgICAoSFlQRVJDQUxM
X0JVRkZFUihpbmZvKSktPnVidWYgPSBpbmZvICsgKmRvbmU7Ci0gICAgICAgIChIWVBFUkNBTExf
QlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyAoc3ogKiAqZG9uZSk7CisgICAgICAgIChIWVBF
UkNBTExfQlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyBuYW1lX29mZjsKICAgICAgICAgKEhZ
UEVSQ0FMTF9CVUZGRVIobGVuKSktPnVidWYgPSBsZW4gKyAqZG9uZTsKICAgICAgICAgLyogQWxs
b2NhdGUgbWVtb3J5LiAqLwogICAgICAgICByYyA9IHhjX2h5cGVyY2FsbF9ib3VuY2VfcHJlKHhj
aCwgaW5mbyk7CkBAIC04MjcsMTQgKzg3NCwxOSBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKICAg
ICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAgICAgICAgICpsZWZ0ID0gc3lzY3RsLnUubGl2
ZXBhdGNoLnUubGlzdC5ucjsgLyogVG90YWwgcmVtYWluaW5nIGNvdW50LiAqLworICAgICAgICBf
bmFtZV9zeiA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90b3RhbF9zaXplOyAvKiBU
b3RhbCByZWNlaXZlZCBuYW1lIHNpemUuICovCiAgICAgICAgIC8qIENvcHkgb25seSB1cCAncmMn
IG9mIGRhdGEnIC0gd2UgY291bGQgYWRkICdtaW4ocmMsbnIpIGlmIGRlc2lyZWQuICovCiAgICAg
ICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUoaW5mbywgKHJjICogc2l6ZW9mKCppbmZvKSkp
OwotICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG5hbWUsIChyYyAqIHN6KSk7Cisg
ICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobmFtZSwgX25hbWVfc3opOwogICAgICAg
ICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGxlbiwgKHJjICogc2l6ZW9mKCpsZW4pKSk7CiAg
ICAgICAgIC8qIEJvdW5jZSB0aGUgZGF0YSBhbmQgZnJlZSB0aGUgYm91bmNlIGJ1ZmZlci4gKi8K
ICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgaW5mbyk7CiAgICAgICAgIHhj
X2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAgICB4Y19oeXBlcmNhbGxf
Ym91bmNlX3Bvc3QoeGNoLCBsZW4pOworCisgICAgICAgIG5hbWVfc3ogLT0gX25hbWVfc3o7Cisg
ICAgICAgIG5hbWVfb2ZmICs9IF9uYW1lX3N6OworCiAgICAgICAgIC8qIEFuZCB1cGRhdGUgaG93
IG1hbnkgZWxlbWVudHMgb2YgaW5mbyB3ZSBoYXZlIGNvcGllZCBpbnRvLiAqLwogICAgICAgICAq
ZG9uZSArPSByYzsKICAgICAgICAgLyogVXBkYXRlIGlkeC4gKi8KZGlmZiAtLWdpdCBhL3Rvb2xz
L21pc2MveGVuLWxpdmVwYXRjaC5jIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKaW5kZXgg
YjQ2OWIyNTNhZC4uYzkzYzUwMDQwYyAxMDA2NDQKLS0tIGEvdG9vbHMvbWlzYy94ZW4tbGl2ZXBh
dGNoLmMKKysrIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKQEAgLTY0LDE0ICs2NCwxMyBA
QCBzdGF0aWMgY29uc3QgY2hhciAqc3RhdGUyc3RyKHVuc2lnbmVkIGludCBzdGF0ZSkKICAgICBy
ZXR1cm4gbmFtZXNbc3RhdGVdOwogfQogCi0vKiBUaGlzIHZhbHVlIHdhcyBjaG9vc2VuIGFkaG9j
LiBJdCBjb3VsZCBiZSA0MiB0b28uICovCi0jZGVmaW5lIE1BWF9MRU4gMTEKIHN0YXRpYyBpbnQg
bGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiB7Ci0gICAgdW5zaWduZWQgaW50IGlk
eCwgZG9uZSwgbGVmdCwgaTsKKyAgICB1bnNpZ25lZCBpbnQgbnIsIGRvbmUsIGxlZnQsIGk7CiAg
ICAgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCAqaW5mbyA9IE5VTEw7CiAgICAgY2hhciAqbmFtZSA9
IE5VTEw7CiAgICAgdWludDMyX3QgKmxlbiA9IE5VTEw7CisgICAgdWludDMyX3QgbmFtZV90b3Rh
bF9zaXplLCBuYW1lX29mZjsKICAgICBpbnQgcmMgPSBFTk9NRU07CiAKICAgICBpZiAoIGFyZ2Mg
KQpAQCAtNzksNjUgKzc4LDczIEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFy
ICphcmd2W10pCiAgICAgICAgIHNob3dfaGVscCgpOwogICAgICAgICByZXR1cm4gLTE7CiAgICAg
fQotICAgIGlkeCA9IGxlZnQgPSAwOwotICAgIGluZm8gPSBtYWxsb2Moc2l6ZW9mKCppbmZvKSAq
IE1BWF9MRU4pOwotICAgIGlmICggIWluZm8gKQotICAgICAgICByZXR1cm4gcmM7Ci0gICAgbmFt
ZSA9IG1hbGxvYyhzaXplb2YoKm5hbWUpICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUgKiBNQVhf
TEVOKTsKLSAgICBpZiAoICFuYW1lICkKKyAgICBkb25lID0gbGVmdCA9IDA7CisKKyAgICByYyA9
IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y2gsICZuciwgJm5hbWVfdG90YWxfc2l6ZSk7
CisgICAgaWYgKCByYyApCiAgICAgewotICAgICAgICBmcmVlKGluZm8pOworICAgICAgICByYyA9
IGVycm5vOworICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkZhaWxlZCB0byBnZXQgbGlzdCBzaXpl
cy5cbiIKKyAgICAgICAgICAgICAgICAiRXJyb3IgJWQ6ICVzXG4iLAorICAgICAgICAgICAgICAg
IHJjLCBzdHJlcnJvcihyYykpOwogICAgICAgICByZXR1cm4gcmM7CiAgICAgfQotICAgIGxlbiA9
IG1hbGxvYyhzaXplb2YoKmxlbikgKiBNQVhfTEVOKTsKLSAgICBpZiAoICFsZW4gKSB7Ci0gICAg
ICAgIGZyZWUobmFtZSk7Ci0gICAgICAgIGZyZWUoaW5mbyk7CisKKyAgICBpZiAoIG5yID09IDAg
KQorICAgIHsKKyAgICAgICAgZnByaW50ZihzdGRvdXQsICJOb3RoaW5nIHRvIGxpc3RcbiIpOwor
ICAgICAgICByZXR1cm4gMDsKKyAgICB9CisKKyAgICBpbmZvID0gbWFsbG9jKG5yICogc2l6ZW9m
KCppbmZvKSk7CisgICAgaWYgKCAhaW5mbyApCiAgICAgICAgIHJldHVybiByYzsKKworICAgIG5h
bWUgPSBtYWxsb2MobmFtZV90b3RhbF9zaXplICogc2l6ZW9mKCpuYW1lKSk7CisgICAgaWYgKCAh
bmFtZSApCisgICAgICAgIGdvdG8gZXJyb3JfbmFtZTsKKworICAgIGxlbiA9IG1hbGxvYyhuciAq
IHNpemVvZigqbGVuKSk7CisgICAgaWYgKCAhbGVuICkKKyAgICAgICAgZ290byBlcnJvcl9sZW47
CisKKyAgICBtZW1zZXQoaW5mbywgJ0EnLCBuciAqIHNpemVvZigqaW5mbykpOworICAgIG1lbXNl
dChuYW1lLCAnQicsIG5hbWVfdG90YWxfc2l6ZSAqIHNpemVvZigqbmFtZSkpOworICAgIG1lbXNl
dChsZW4sICdDJywgbnIgKiBzaXplb2YoKmxlbikpOworICAgIG5hbWVfb2ZmID0gMDsKKworICAg
IHJjID0geGNfbGl2ZXBhdGNoX2xpc3QoeGNoLCBuciwgMCwgaW5mbywgbmFtZSwgbGVuLCBuYW1l
X3RvdGFsX3NpemUsICZkb25lLCAmbGVmdCk7CisgICAgaWYgKCByYyB8fCBkb25lICE9IG5yIHx8
IGxlZnQgPiAwKQorICAgIHsKKyAgICAgICAgcmMgPSBlcnJubzsKKyAgICAgICAgZnByaW50Zihz
dGRlcnIsICJGYWlsZWQgdG8gbGlzdCAlZC8lZC5cbiIKKyAgICAgICAgICAgICAgICAiRXJyb3Ig
JWQ6ICVzXG4iLAorICAgICAgICAgICAgICAgIGxlZnQsIG5yLCByYywgc3RyZXJyb3IocmMpKTsK
KyAgICAgICAgZ290byBlcnJvcjsKICAgICB9CiAKLSAgICBkbyB7Ci0gICAgICAgIGRvbmUgPSAw
OwotICAgICAgICAvKiBUaGUgbWVtc2V0IGlzIGRvbmUgdG8gY2F0Y2ggZXJyb3JzLiAqLwotICAg
ICAgICBtZW1zZXQoaW5mbywgJ0EnLCBzaXplb2YoKmluZm8pICogTUFYX0xFTik7Ci0gICAgICAg
IG1lbXNldChuYW1lLCAnQicsIHNpemVvZigqbmFtZSkgKiBNQVhfTEVOICogWEVOX0xJVkVQQVRD
SF9OQU1FX1NJWkUpOwotICAgICAgICBtZW1zZXQobGVuLCAnQycsIHNpemVvZigqbGVuKSAqIE1B
WF9MRU4pOwotICAgICAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0KHhjaCwgTUFYX0xFTiwgaWR4
LCBpbmZvLCBuYW1lLCBsZW4sICZkb25lLCAmbGVmdCk7Ci0gICAgICAgIGlmICggcmMgKQotICAg
ICAgICB7Ci0gICAgICAgICAgICByYyA9IGVycm5vOwotICAgICAgICAgICAgZnByaW50ZihzdGRl
cnIsICJGYWlsZWQgdG8gbGlzdCAlZC8lZC5cbiIKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAiRXJyb3IgJWQ6ICVzXG4iLAotICAgICAgICAgICAgICAgICAgICBpZHgsIGxlZnQsIHJjLCBz
dHJlcnJvcihyYykpOwotICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgIH0KLSAgICAgICAgaWYg
KCAhaWR4ICkKLSAgICAgICAgICAgIGZwcmludGYoc3Rkb3V0LCIgSUQgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfCBzdGF0dXNcbiIKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0t
LVxuIik7CisgICAgZnByaW50ZihzdGRvdXQsIiBJRCAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8IHN0YXR1c1xuIgorICAgICAgICAgICAgICAgICAgICItLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLVxuIik7CiAKLSAgICAgICAg
Zm9yICggaSA9IDA7IGkgPCBkb25lOyBpKysgKQotICAgICAgICB7Ci0gICAgICAgICAgICB1bnNp
Z25lZCBpbnQgajsKLSAgICAgICAgICAgIHVpbnQzMl90IHN6OwotICAgICAgICAgICAgY2hhciAq
c3RyOwotCi0gICAgICAgICAgICBzeiA9IGxlbltpXTsKLSAgICAgICAgICAgIHN0ciA9IG5hbWUg
KyAoaSAqIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFKTsKLSAgICAgICAgICAgIGZvciAoIGogPSBz
ejsgaiA8IFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFOyBqKysgKQotICAgICAgICAgICAgICAgIHN0
cltqXSA9ICdcMCc7Ci0KLSAgICAgICAgICAgIHByaW50ZigiJS00MHN8ICVzIiwgc3RyLCBzdGF0
ZTJzdHIoaW5mb1tpXS5zdGF0ZSkpOwotICAgICAgICAgICAgaWYgKCBpbmZvW2ldLnJjICkKLSAg
ICAgICAgICAgICAgICBwcmludGYoIiAoJWQsICVzKVxuIiwgLWluZm9baV0ucmMsIHN0cmVycm9y
KC1pbmZvW2ldLnJjKSk7Ci0gICAgICAgICAgICBlbHNlCi0gICAgICAgICAgICAgICAgcHV0cygi
Iik7Ci0gICAgICAgIH0KLSAgICAgICAgaWR4ICs9IGRvbmU7Ci0gICAgfSB3aGlsZSAoIGxlZnQg
KTsKKyAgICBmb3IgKCBpID0gMDsgaSA8IGRvbmU7IGkrKyApCisgICAgeworICAgICAgICBjaGFy
ICpuYW1lX3N0ciA9IG5hbWUgKyBuYW1lX29mZjsKKworICAgICAgICBwcmludGYoIiUtNDAuKnN8
ICVzIiwgbGVuW2ldLCBuYW1lX3N0ciwgc3RhdGUyc3RyKGluZm9baV0uc3RhdGUpKTsKKyAgICAg
ICAgaWYgKCBpbmZvW2ldLnJjICkKKyAgICAgICAgICAgIHByaW50ZigiICglZCwgJXMpXG4iLCAt
aW5mb1tpXS5yYywgc3RyZXJyb3IoLWluZm9baV0ucmMpKTsKKyAgICAgICAgZWxzZQorICAgICAg
ICAgICAgcHV0cygiIik7CisKKyAgICAgICAgbmFtZV9vZmYgKz0gbGVuW2ldOworICAgIH0KIAor
ZXJyb3I6CisgICAgZnJlZShsZW4pOworZXJyb3JfbGVuOgogICAgIGZyZWUobmFtZSk7CitlcnJv
cl9uYW1lOgogICAgIGZyZWUoaW5mbyk7Ci0gICAgZnJlZShsZW4pOwogICAgIHJldHVybiByYzsK
IH0KICN1bmRlZiBNQVhfTEVOCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2xpdmVwYXRjaC5jIGIv
eGVuL2NvbW1vbi9saXZlcGF0Y2guYwppbmRleCAxMzNmNThiY2YyLi5iYzY0MzI5NWQ2IDEwMDY0
NAotLS0gYS94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCisrKyBiL3hlbi9jb21tb24vbGl2ZXBhdGNo
LmMKQEAgLTExNTksMTIgKzExNTksOCBAQCBzdGF0aWMgaW50IGxpdmVwYXRjaF9saXN0KHN0cnVj
dCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0KQogICAgIGlmICggbGlzdC0+bnIgPiAx
MDI0ICkKICAgICAgICAgcmV0dXJuIC1FMkJJRzsKIAotICAgIGlmICggbGlzdC0+cGFkICkKLSAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7Ci0KICAgICBpZiAoIGxpc3QtPm5yICYmCiAgICAgICAgICAo
IWd1ZXN0X2hhbmRsZV9va2F5KGxpc3QtPnN0YXR1cywgbGlzdC0+bnIpIHx8Ci0gICAgICAgICAg
IWd1ZXN0X2hhbmRsZV9va2F5KGxpc3QtPm5hbWUsIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFICog
bGlzdC0+bnIpIHx8CiAgICAgICAgICAgIWd1ZXN0X2hhbmRsZV9va2F5KGxpc3QtPmxlbiwgbGlz
dC0+bnIpKSApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCkBAIC0xMTc1LDIzICsxMTcxLDM1
IEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNo
X2xpc3QgKmxpc3QpCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogICAgIH0KIAorICAgIGxpc3Qt
Pm5hbWVfdG90YWxfc2l6ZSA9IDA7CiAgICAgaWYgKCBsaXN0LT5uciApCiAgICAgeworICAgICAg
ICB1aW50NjRfdCBuYW1lX29mZnNldCA9IDA7CisKICAgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRy
eSggZGF0YSwgJnBheWxvYWRfbGlzdCwgbGlzdCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHVp
bnQzMl90IGxlbjsKKyAgICAgICAgICAgIHVpbnQzMl90IG5hbWVfbGVuOwogCiAgICAgICAgICAg
ICBpZiAoIGxpc3QtPmlkeCA+IGkrKyApCiAgICAgICAgICAgICAgICAgY29udGludWU7CiAKICAg
ICAgICAgICAgIHN0YXR1cy5zdGF0ZSA9IGRhdGEtPnN0YXRlOwogICAgICAgICAgICAgc3RhdHVz
LnJjID0gZGF0YS0+cmM7Ci0gICAgICAgICAgICBsZW4gPSBzdHJsZW4oZGF0YS0+bmFtZSkgKyAx
OworCisgICAgICAgICAgICBuYW1lX2xlbiA9IHN0cmxlbihkYXRhLT5uYW1lKSArIDE7CisgICAg
ICAgICAgICBsaXN0LT5uYW1lX3RvdGFsX3NpemUgKz0gbmFtZV9sZW47CisKKyAgICAgICAgICAg
IGlmICggIWd1ZXN0X2hhbmRsZV9zdWJyYW5nZV9va2F5KGxpc3QtPm5hbWUsIG5hbWVfb2Zmc2V0
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZV9vZmZz
ZXQgKyBuYW1lX2xlbiAtIDEpICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICByYyA9
IC1FSU5WQUw7CisgICAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICB9CiAKICAgICAg
ICAgICAgIC8qIE4uQi4gJ2lkeCcgIT0gJ2knLiAqLwotICAgICAgICAgICAgaWYgKCBfX2NvcHlf
dG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm5hbWUsIGlkeCAqIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpF
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPm5hbWUsIGxl
bikgfHwKLSAgICAgICAgICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPmxlbiwg
aWR4LCAmbGVuLCAxKSB8fAorICAgICAgICAgICAgaWYgKCBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0
KGxpc3QtPm5hbWUsIG5hbWVfb2Zmc2V0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGRhdGEtPm5hbWUsIG5hbWVfbGVuKSB8fAorICAgICAgICAgICAgICAgIF9fY29w
eV90b19ndWVzdF9vZmZzZXQobGlzdC0+bGVuLCBpZHgsICZuYW1lX2xlbiwgMSkgfHwKICAgICAg
ICAgICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPnN0YXR1cywgaWR4LCAmc3Rh
dHVzLCAxKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSAtRUZBVUxUOwpA
QCAtMTE5OSwxMSArMTIwNywxOSBAQCBzdGF0aWMgaW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4
ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0KQogICAgICAgICAgICAgfQogCiAgICAgICAg
ICAgICBpZHgrKzsKKyAgICAgICAgICAgIG5hbWVfb2Zmc2V0ICs9IG5hbWVfbGVuOwogCiAgICAg
ICAgICAgICBpZiAoIChpZHggPj0gbGlzdC0+bnIpIHx8IGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNr
KCkgKQogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAgICAgfQorICAgIGVsc2UK
KyAgICB7CisgICAgICAgIGxpc3RfZm9yX2VhY2hfZW50cnkoIGRhdGEsICZwYXlsb2FkX2xpc3Qs
IGxpc3QgKQorICAgICAgICB7CisgICAgICAgICAgICBsaXN0LT5uYW1lX3RvdGFsX3NpemUgKz0g
c3RybGVuKGRhdGEtPm5hbWUpICsgMTsKKyAgICAgICAgfQorICAgIH0KICAgICBsaXN0LT5uciA9
IHBheWxvYWRfY250IC0gaTsgLyogUmVtYWluaW5nIGFtb3VudC4gKi8KICAgICBsaXN0LT52ZXJz
aW9uID0gcGF5bG9hZF92ZXJzaW9uOwogICAgIHNwaW5fdW5sb2NrKCZwYXlsb2FkX2xvY2spOwpk
aWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oIGIveGVuL2luY2x1ZGUvcHVi
bGljL3N5c2N0bC5oCmluZGV4IGVjNmYxNmYwZTYuLjRiZmQxNDc1YmYgMTAwNjQ0Ci0tLSBhL3hl
bi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaAorKysgYi94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3Rs
LmgKQEAgLTkzOSwxMCArOTM5LDExIEBAIHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9nZXQg
ewogICoKICAqIElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBhbiBwb3NpdGl2ZSBudW1iZXIsIGl0
IGlzIHRoZSBudW1iZXIgKHVwIHRvIGBucmApCiAgKiBvZiB0aGUgcGF5bG9hZHMgcmV0dXJuZWQs
IGFsb25nIHdpdGggYG5yYCB1cGRhdGVkIHdpdGggdGhlIG51bWJlciBvZiByZW1haW5pbmcKLSAq
IHBheWxvYWRzLCBgdmVyc2lvbmAgdXBkYXRlZCAoaXQgbWF5IGJlIHRoZSBzYW1lIGFjcm9zcyBo
eXBlcmNhbGxzLiBJZiBpdAotICogdmFyaWVzIHRoZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVy
IGNhbGxzIGNvdWxkIGZhaWwpLiBUaGUgYHN0YXR1c2AsCi0gKiBgbmFtZWAsIGFuZCBgbGVuYCcg
YXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXggdmFsdWUgKGBpZHhgKSB3aXRoCi0g
KiB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4KKyAqIHBheWxvYWRzLCBgdmVyc2lvbmAgdXBk
YXRlZCAoaXQgbWF5IGJlIHRoZSBzYW1lIGFjcm9zcyBoeXBlcmNhbGxzLiBJZiBpdCB2YXJpZXMK
KyAqIHRoZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNvdWxkIGZhaWwpIGFuZCB0
aGUgbmFtZV90b3RhbF9zaXplCisgKiBjb250YWluaW5nIHRvdGFsIHNpemUgb2YgdHJhbnNmZXJy
ZWQgZGF0YSBmb3IgdGhlIGFycmF5LgorICogVGhlIGBzdGF0dXNgLCBgbmFtZWAsIGBsZW5gIGFy
ZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4IHZhbHVlIChgaWR4YCkKKyAqIHdpdGgg
dGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCiAgKgogICogSWYgdGhlIGh5cGVyY2FsbCByZXR1
cm5zIEUyQklHIHRoZSBgbnJgIGlzIHRvbyBiaWcgYW5kIHNob3VsZCBiZQogICogbG93ZXJlZC4g
VGhlIHVwcGVyIGxpbWl0IG9mIGBucmAgaXMgbGVmdCB0byB0aGUgaW1wbGVtZW50aW9uLgpAQCAt
OTY0LDEyICs5NjUsMTMgQEAgc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgewogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG91bGQgZmlsbCBv
dXQuIENhbiBiZSB6ZXJvIHRvIGdldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBhbW91bnQgb2YgcGF5bG9hZHMgYW5kIHZlcnNpb24uCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9VVDogSG93IG1hbnkgcGF5bG9h
ZHMgbGVmdC4gKi8KLSAgICB1aW50MzJfdCBwYWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
LyogSU46IE11c3QgYmUgemVyby4gKi8KKyAgICB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemU7ICAg
ICAgICAgICAgICAgLyogT1VUOiBUb3RhbCBzaXplIG9mIGFsbCB0cmFuc2ZlciBuYW1lcyAqLwog
ICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCkgc3RhdHVzOyAg
LyogT1VULiBNdXN0IGhhdmUgZW5vdWdoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNwYWNlIGFsbG9jYXRlIGZvciBuciBvZiB0aGVtLiAqLwogICAgIFhF
Tl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgbmFtZTsgICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIG5h
bWVzLiBFYWNoIG1lbWJlcgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBNVVNUIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFIGluIHNpemUuCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVt
LiAqLworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXkg
aGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoIHVwIHRvCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFIGJ5dGVzLiBNdXN0
IGhhdmUKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnIg
b2YgdGhlbS4gKi8KICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHVpbnQzMikgbGVuOyAgICAgICAg
LyogT1VUOiBBcnJheSBvZiBsZW5ndGhzIG9mIG5hbWUncy4KICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCiB9Owot
LSAKMi4xNi41CgoKCgpBbWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkgR21iSApLcmF1
c2Vuc3RyLiAzOAoxMDExNyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJpc3RpYW4gU2No
bGFlZ2VyLCBSYWxmIEhlcmJyaWNoCkVpbmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0
ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3
IDg3OQoKCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
WGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0
cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

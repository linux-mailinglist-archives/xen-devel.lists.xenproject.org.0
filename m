Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8F8E456FB4
	for <lists+xen-devel@lfdr.de>; Wed, 26 Jun 2019 19:40:49 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hgBqY-0001Q2-2V; Wed, 26 Jun 2019 17:36:38 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=udJa=UZ=citrix.com=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1hgBqX-0001Px-2N
 for xen-devel@lists.xenproject.org; Wed, 26 Jun 2019 17:36:37 +0000
X-Inumbo-ID: ef8601cd-9838-11e9-8980-bc764e045a96
Received: from esa1.hc3370-68.iphmx.com (unknown [216.71.145.142])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id ef8601cd-9838-11e9-8980-bc764e045a96;
 Wed, 26 Jun 2019 17:36:32 +0000 (UTC)
Authentication-Results: esa1.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=andrew.cooper3@citrix.com;
 spf=Pass smtp.mailfrom=Andrew.Cooper3@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa1.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 andrew.cooper3@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="andrew.cooper3@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa1.hc3370-68.iphmx.com: domain of
 Andrew.Cooper3@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="Andrew.Cooper3@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa1.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa1.hc3370-68.iphmx.com;
 envelope-from="Andrew.Cooper3@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: vkZ5ZHuKiMLCdDWxdsSiRqsVbqYkRZoomVFUjkqowE25rG6LWBxBJg6+Cy1zIIzLwmZEyF73ig
 OremPQsmOKgXYyaNA5sXv/oxeneXVAGH8reReevnY+mTyRAHnUOUuu0XpGlXkqSzhwgKXKnSU5
 m4MpfxreVdmdeRL7YWN3viVzmPJexWVUAn5CYMXvoNgPlO2imPZAPrPxNN5CpFSmJ1MrfosIJ1
 K3uQSvcBxh5kUyx/sLan+p9QWwrq479QIVNm00Ro+D7DxyBlKylnSyk4Ywo9i9xUlQ50+7fbhI
 s4Q=
X-SBRS: 2.7
X-MesageID: 2287618
X-Ironport-Server: esa1.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,420,1557201600"; 
   d="scan'208";a="2287618"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xenproject.org>
Date: Wed, 26 Jun 2019 18:36:15 +0100
Message-ID: <20190626173615.12419-1-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.11.0
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH] xen/Kconfig: Fix -Wformat-security when
 compiling with Clang
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Q2xhbmcgb2JzZXJ2ZXM6Cgp0b29scy9rY29uZmlnL2NvbmYuYzo3NzoxMDoKd2FybmluZzogZm9y
bWF0IHN0cmluZyBpcyBub3QgYSBzdHJpbmcgbGl0ZXJhbCAocG90ZW50aWFsbHkgaW5zZWN1cmUp
CiAgICAgIFstV2Zvcm1hdC1zZWN1cml0eV0KICAgICAgICAgICAgICAgIHByaW50ZihfKCJhYm9y
dGVkIVxuXG4iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgXn5+fn5+fn5+fn5+fn5+fn4KCkFu
ZCBpdCBpcyBhYnNvbHV0ZWx5IGNvcnJlY3QuICBnZXR0ZXh0KCkgY2FuIGVhc2lseSByZXR1cm4g
YSBzdHJpbmcgd2l0aCBhICUKaW4uCgpUaGlzIGNvdWxkIGJlIGZpeGVkIGJ5IHN3aXRjaGluZyB0
byB1c2luZyBwcmludGYoIiVzIiwgXyguLi4pKSwgb3IgYnkKc3dpdGNoaW5nIHRvIHB1dHMoKSAo
YXMgdGhlcmUgaXMgbm8gZm9ybWF0dGluZyBnb2luZyBvbiksIGJ1dCB0aGUgYmV0dGVyCm9wdGlv
biBpcyBmb2xsb3cgTGludXggYW5kIHJlbW92ZSBsb2NhbGlzYXRpb24gc3VwcG9ydC4KCkxpbnV4
IGNoYW5nZXNldDogNjk0YzQ5YTdjMDFjYzg3MTk0YmU0MGNiMjY0MDRiNThiNjhjMjkxYwpBdXRo
b3I6IFNhbSBSYXZuYm9yZyA8c2FtQHJhdm5ib3JnLm9yZz4KRGF0ZTogICBUdWUgTWF5IDIyIDIw
OjM2OjEyIDIwMTgKCmtjb25maWc6IGRyb3AgbG9jYWxpemF0aW9uIHN1cHBvcnQKClRoZSBsb2Nh
bGl6YXRpb24gc3VwcG9ydCBpcyBicm9rZW4gYW5kIGFwcGVhcnMgdW51c2VkLgpUaGVyZSBpcyBu
byBnb29nbGUgaGl0cyBvbiB0aGUgdXBkYXRlLXBvLWNvbmZpZyB0YXJnZXQuCkFuZCB0aGVyZSBp
cyBubyByZWNlbnQgKDUgeWVhcnMpIGFjdGl2aXR5IHJlbGF0ZWQgdG8gdGhlIGxvY2FsaXphdGlv
bi4KClNvIGxldHMganVzdCBkcm9wIHRoaXMgYXMgaXQgaXMgbm8gbG9uZ2VyIHVzZWQuCgpTdWdn
ZXN0ZWQtYnk6IFVsZiBNYWdudXNzb24gPHVsZmFsaXplckBnbWFpbC5jb20+ClN1Z2dlc3RlZC1i
eTogTWFzYWhpcm8gWWFtYWRhIDx5YW1hZGEubWFzYWhpcm9Ac29jaW9uZXh0LmNvbT4KU2lnbmVk
LW9mZi1ieTogU2FtIFJhdm5ib3JnIDxzYW1AcmF2bmJvcmcub3JnPgpTaWduZWQtb2ZmLWJ5OiBN
YXNhaGlybyBZYW1hZGEgPHlhbWFkYS5tYXNhaGlyb0Bzb2Npb25leHQuY29tPgoKW1BvcnRlZCB0
byBYZW5dClJlcG9ydGVkLWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNv
bT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KLS0tCkNDOiBEb3VnIEdvbGRzdGVpbiA8Y2FyZG9lQGNhcmRvZS5jb20+Ci0tLQogeGVuL3Rv
b2xzL2tjb25maWcvLmdpdGlnbm9yZSAgICAgICAgICAgfCAgIDQgLQogeGVuL3Rvb2xzL2tjb25m
aWcvTWFrZWZpbGUgICAgICAgICAgICAgfCAgMzkgKy0tLS0tCiB4ZW4vdG9vbHMva2NvbmZpZy9Q
T1RGSUxFUy5pbiAgICAgICAgICB8ICAxMiAtLQogeGVuL3Rvb2xzL2tjb25maWcvY2hlY2suc2gg
ICAgICAgICAgICAgfCAgMTMgLS0KIHhlbi90b29scy9rY29uZmlnL2NvbmYuYyAgICAgICAgICAg
ICAgIHwgIDU3ICsrKystLS0tCiB4ZW4vdG9vbHMva2NvbmZpZy9jb25mZGF0YS5jICAgICAgICAg
ICB8ICAgNCArLQogeGVuL3Rvb2xzL2tjb25maWcvZ2NvbmYuYyAgICAgICAgICAgICAgfCAgNDYg
KysrLS0tLQogeGVuL3Rvb2xzL2tjb25maWcva3hnZXR0ZXh0LmMgICAgICAgICAgfCAyMzUgLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiB4ZW4vdG9vbHMva2NvbmZpZy9sa2MuaCAg
ICAgICAgICAgICAgICB8ICAxNCAtLQogeGVuL3Rvb2xzL2tjb25maWcvbHhkaWFsb2cvY2hlY2ts
aXN0LmMgfCAgIDQgKy0KIHhlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL2RpYWxvZy5oICAgIHwg
ICA2IC0KIHhlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL2lucHV0Ym94LmMgIHwgICA0ICstCiB4
ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy9tZW51Ym94LmMgICB8ICAxMCArLQogeGVuL3Rvb2xz
L2tjb25maWcvbHhkaWFsb2cvdGV4dGJveC5jICAgfCAgIDIgKy0KIHhlbi90b29scy9rY29uZmln
L2x4ZGlhbG9nL3llc25vLmMgICAgIHwgICA0ICstCiB4ZW4vdG9vbHMva2NvbmZpZy9tY29uZi5j
ICAgICAgICAgICAgICB8IDE0MSArKysrKysrKysrLS0tLS0tLS0tLQogeGVuL3Rvb2xzL2tjb25m
aWcvbWVudS5jICAgICAgICAgICAgICAgfCAgMTggKy0tCiB4ZW4vdG9vbHMva2NvbmZpZy9uY29u
Zi5jICAgICAgICAgICAgICB8IDE0OCArKysrKysrKysrLS0tLS0tLS0tLS0KIHhlbi90b29scy9r
Y29uZmlnL25jb25mLmggICAgICAgICAgICAgIHwgICAxIC0KIHhlbi90b29scy9rY29uZmlnL3Fj
b25mLmNjICAgICAgICAgICAgIHwgMTEyICsrKysrKystLS0tLS0tLS0KIHhlbi90b29scy9rY29u
ZmlnL3pjb25mLnRhYi5jX3NoaXBwZWQgIHwgICAyICstCiB4ZW4vdG9vbHMva2NvbmZpZy96Y29u
Zi55ICAgICAgICAgICAgICB8ICAgMiArLQogMjIgZmlsZXMgY2hhbmdlZCwgMjY1IGluc2VydGlv
bnMoKyksIDYxMyBkZWxldGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEwMDY0NCB4ZW4vdG9vbHMva2Nv
bmZpZy9QT1RGSUxFUy5pbgogZGVsZXRlIG1vZGUgMTAwNzU1IHhlbi90b29scy9rY29uZmlnL2No
ZWNrLnNoCiBkZWxldGUgbW9kZSAxMDA2NDQgeGVuL3Rvb2xzL2tjb25maWcva3hnZXR0ZXh0LmMK
CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMva2NvbmZpZy8uZ2l0aWdub3JlIGIveGVuL3Rvb2xzL2tj
b25maWcvLmdpdGlnbm9yZQppbmRleCBiZTYwM2M0ZmVmLi5jYTM4ZTk4M2Q2IDEwMDY0NAotLS0g
YS94ZW4vdG9vbHMva2NvbmZpZy8uZ2l0aWdub3JlCisrKyBiL3hlbi90b29scy9rY29uZmlnLy5n
aXRpZ25vcmUKQEAgLTcsOSArNyw2IEBAIGNvbmZpZyoKICoudGFiLmgKIHpjb25mLmhhc2guYwog
Ki5tb2MKLWdjb25mLmdsYWRlLmgKLSoucG90Ci0qLm1vCiAKICMKICMgY29uZmlndXJhdGlvbiBw
cm9ncmFtcwpAQCAtMTksNCArMTYsMyBAQCBtY29uZgogbmNvbmYKIHFjb25mCiBnY29uZgota3hn
ZXR0ZXh0CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMva2NvbmZpZy9NYWtlZmlsZSBiL3hlbi90b29s
cy9rY29uZmlnL01ha2VmaWxlCmluZGV4IGFjZWFhZWQwOTguLmM4YWQ2OTUwMWMgMTAwNjQ0Ci0t
LSBhL3hlbi90b29scy9rY29uZmlnL01ha2VmaWxlCisrKyBiL3hlbi90b29scy9rY29uZmlnL01h
a2VmaWxlCkBAIC0yLDcgKzIsNyBAQAogIyBLZXJuZWwgY29uZmlndXJhdGlvbiB0YXJnZXRzCiAj
IFRoZXNlIHRhcmdldHMgYXJlIHVzZWQgZnJvbSB0b3AtbGV2ZWwgbWFrZWZpbGUKIAotUEhPTlkg
Kz0geGNvbmZpZyBnY29uZmlnIG1lbnVjb25maWcgY29uZmlnIHNpbGVudG9sZGNvbmZpZyB1cGRh
dGUtcG8tY29uZmlnIFwKK1BIT05ZICs9IHhjb25maWcgZ2NvbmZpZyBtZW51Y29uZmlnIGNvbmZp
ZyBzaWxlbnRvbGRjb25maWcgXAogCWxvY2FsbW9kY29uZmlnIGxvY2FseWVzY29uZmlnCiAKIGlm
ZGVmIEtCVUlMRF9LQ09ORklHCkBAIC01MiwyOSArNTIsNiBAQCBsb2NhbHllc2NvbmZpZyBsb2Nh
bG1vZGNvbmZpZzogJChvYmopL3N0cmVhbWxpbmVfY29uZmlnLnBsICQob2JqKS9jb25mCiAJZmkK
IAkkKFEpcm0gLWYgLnRtcC5jb25maWcKIAotIyBDcmVhdGUgbmV3IGxpbnV4LnBvdCBmaWxlCi0j
IEFkanVzdCBjaGFyc2V0IHRvIFVURi04IGluIC5wbyBmaWxlIHRvIGFjY2VwdCBVVEYtOCBpbiBL
Y29uZmlnIGZpbGVzCi11cGRhdGUtcG8tY29uZmlnOiAkKG9iaikva3hnZXR0ZXh0ICQob2JqKS9n
Y29uZi5nbGFkZS5oCi0JJChRKSQoa2VjaG8pICIgIEdFTiAgICAgY29uZmlnLnBvdCIKLQkkKFEp
eGdldHRleHQgLS1kZWZhdWx0LWRvbWFpbj1saW51eCAgICAgICAgICAgICAgICAgICAgICAgICBc
Ci0JICAgIC0tYWRkLWNvbW1lbnRzIC0ta2V5d29yZD1fIC0ta2V5d29yZD1OXyAgICAgICAgICAg
ICAgICAgXAotCSAgICAtLWZyb20tY29kZT1VVEYtOCAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKLQkgICAgLS1maWxlcy1mcm9tPSQoc3JjdHJlZSkvc2NyaXB0cy9rY29u
ZmlnL1BPVEZJTEVTLmluICAgICBcCi0JICAgIC0tZGlyZWN0b3J5PSQoc3JjdHJlZSkgLS1kaXJl
Y3Rvcnk9JChvYmp0cmVlKSAgICAgICAgICAgXAotCSAgICAtLW91dHB1dCAkKG9iaikvY29uZmln
LnBvdAotCSQoUSlzZWQgLWkgcy9DSEFSU0VUL1VURi04LyAkKG9iaikvY29uZmlnLnBvdAotCSQo
USkoZm9yIGkgaW4gYGxzICQoc3JjdHJlZSkvYXJjaC8qL0tjb25maWcgICAgICBcCi0JICAgICQo
c3JjdHJlZSkvYXJjaC8qL3VtL0tjb25maWdgOyAgICAgICAgICAgICAgIFwKLQkgICAgZG8gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAotCQkkKGtlY2hvKSAiICBH
RU4gICAgICQkaSI7ICAgICAgICAgICAgICAgICAgICBcCi0JCSQob2JqKS9reGdldHRleHQgJCRp
ICAgICAgICAgICAgICAgICAgICAgXAotCQkgICAgID4+ICQob2JqKS9jb25maWcucG90OyAgICAg
ICAgICAgICAgIFwKLQkgICAgZG9uZSApCi0JJChRKSQoa2VjaG8pICIgIEdFTiAgICAgbGludXgu
cG90IgotCSQoUSltc2d1bmlxIC0tc29ydC1ieS1maWxlIC0tdG8tY29kZT1VVEYtOCAkKG9iaikv
Y29uZmlnLnBvdCBcCi0JICAgIC0tb3V0cHV0ICQob2JqKS9saW51eC5wb3QKLQkkKFEpcm0gLWYg
JChvYmopL2NvbmZpZy5wb3QKLQogIyBUaGVzZSB0YXJnZXRzIG1hcCAxOjEgdG8gdGhlIGNvbW1h
bmRsaW5lIG9wdGlvbnMgb2YgJ2NvbmYnCiBzaW1wbGUtdGFyZ2V0cyA6PSBvbGRjb25maWcgYWxs
bm9jb25maWcgYWxseWVzY29uZmlnIGFsbG1vZGNvbmZpZyBcCiAJYWxsZGVmY29uZmlnIHJhbmRj
b25maWcgbGlzdG5ld2NvbmZpZyBvbGRkZWZjb25maWcKQEAgLTE3NiwxNiArMTUzLDE0IEBAIGx4
ZGlhbG9nICs9IGx4ZGlhbG9nL3RleHRib3gubyBseGRpYWxvZy95ZXNuby5vIGx4ZGlhbG9nL21l
bnVib3gubwogY29uZi1vYmpzCTo9IGNvbmYubyAgemNvbmYudGFiLm8KIG1jb25mLW9ianMgICAg
IDo9IG1jb25mLm8gemNvbmYudGFiLm8gJChseGRpYWxvZykKIG5jb25mLW9ianMgICAgIDo9IG5j
b25mLm8gemNvbmYudGFiLm8gbmNvbmYuZ3VpLm8KLWt4Z2V0dGV4dC1vYmpzCTo9IGt4Z2V0dGV4
dC5vIHpjb25mLnRhYi5vCiBxY29uZi1jeHhvYmpzCTo9IHFjb25mLm8KIHFjb25mLW9ianMJOj0g
emNvbmYudGFiLm8KIGdjb25mLW9ianMJOj0gZ2NvbmYubyB6Y29uZi50YWIubwogCi1ob3N0cHJv
Z3MteSA6PSBjb25mIG5jb25mIG1jb25mIGt4Z2V0dGV4dCBxY29uZiBnY29uZgoraG9zdHByb2dz
LXkgOj0gY29uZiBuY29uZiBtY29uZiBxY29uZiBnY29uZgogCiBjbGVhbi1maWxlcwk6PSBxY29u
Zi5tb2MgLnRtcF9xdGNoZWNrIC50bXBfZ3RrY2hlY2sKLWNsZWFuLWZpbGVzCSs9IHpjb25mLnRh
Yi5jIHpjb25mLmxleC5jIHpjb25mLmhhc2guYyBnY29uZi5nbGFkZS5oCi1jbGVhbi1maWxlcyAg
ICAgKz0gY29uZmlnLnBvdCBsaW51eC5wb3QKK2NsZWFuLWZpbGVzCSs9IHpjb25mLnRhYi5jIHpj
b25mLmxleC5jIHpjb25mLmhhc2guYwogCiAjIENoZWNrIHRoYXQgd2UgaGF2ZSB0aGUgcmVxdWly
ZWQgbmN1cnNlcyBzdHVmZiBpbnN0YWxsZWQgZm9yIGx4ZGlhbG9nIChtZW51Y29uZmlnKQogUEhP
TlkgKz0gJChvYmopL2RvY2hlY2tseGRpYWxvZwpAQCAtMTk1LDkgKzE3MCw2IEBAICQob2JqKS9k
b2NoZWNrbHhkaWFsb2c6CiAKIGFsd2F5cyA6PSBkb2NoZWNrbHhkaWFsb2cKIAotIyBBZGQgZW52
aXJvbm1lbnQgc3BlY2lmaWMgZmxhZ3MKLUhPU1RfRVhUUkFDRkxBR1MgKz0gJChzaGVsbCAkKENP
TkZJR19TSEVMTCkgJChzcmN0cmVlKS8kKHNyYykvY2hlY2suc2ggJChIT1NUQ0MpICQoSE9TVENG
TEFHUykpCi0KICMgZ2VuZXJhdGVkIGZpbGVzIHNlZW0gdG8gbmVlZCB0aGlzIHRvIGZpbmQgbG9j
YWwgaW5jbHVkZSBmaWxlcwogSE9TVENGTEFHU196Y29uZi5sZXgubwk6PSAtSSQoc3JjKQogSE9T
VENGTEFHU196Y29uZi50YWIubwk6PSAtSSQoc3JjKQpAQCAtMzEwLDggKzI4MiwzIEBAIHF1aWV0
X2NtZF9tb2MgPSBNT0MgICAgICRACiAKICQob2JqKS8lLm1vYzogJChzcmMpLyUuaCAkKG9iaikv
LnRtcF9xdGNoZWNrCiAJJChjYWxsIGNtZCxtb2MpCi0KLSMgRXh0cmFjdCBnY29uZiBtZW51IGl0
ZW1zIGZvciBpMThuIHN1cHBvcnQKLSQob2JqKS9nY29uZi5nbGFkZS5oOiAkKG9iaikvZ2NvbmYu
Z2xhZGUKLQkkKFEpaW50bHRvb2wtZXh0cmFjdCAtLXR5cGU9Z2V0dGV4dC9nbGFkZSAtLXNyY2Rp
cj0kKHNyY3RyZWUpIFwKLQkkKG9iaikvZ2NvbmYuZ2xhZGUKZGlmZiAtLWdpdCBhL3hlbi90b29s
cy9rY29uZmlnL1BPVEZJTEVTLmluIGIveGVuL3Rvb2xzL2tjb25maWcvUE9URklMRVMuaW4KZGVs
ZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDk2NzQ1NzM5NjkuLjAwMDAwMDAwMDAKLS0tIGEv
eGVuL3Rvb2xzL2tjb25maWcvUE9URklMRVMuaW4KKysrIC9kZXYvbnVsbApAQCAtMSwxMiArMCww
IEBACi1zY3JpcHRzL2tjb25maWcvbHhkaWFsb2cvY2hlY2tsaXN0LmMKLXNjcmlwdHMva2NvbmZp
Zy9seGRpYWxvZy9pbnB1dGJveC5jCi1zY3JpcHRzL2tjb25maWcvbHhkaWFsb2cvbWVudWJveC5j
Ci1zY3JpcHRzL2tjb25maWcvbHhkaWFsb2cvdGV4dGJveC5jCi1zY3JpcHRzL2tjb25maWcvbHhk
aWFsb2cvdXRpbC5jCi1zY3JpcHRzL2tjb25maWcvbHhkaWFsb2cveWVzbm8uYwotc2NyaXB0cy9r
Y29uZmlnL21jb25mLmMKLXNjcmlwdHMva2NvbmZpZy9jb25mLmMKLXNjcmlwdHMva2NvbmZpZy9j
b25mZGF0YS5jCi1zY3JpcHRzL2tjb25maWcvZ2NvbmYuYwotc2NyaXB0cy9rY29uZmlnL2djb25m
LmdsYWRlLmgKLXNjcmlwdHMva2NvbmZpZy9xY29uZi5jYwpkaWZmIC0tZ2l0IGEveGVuL3Rvb2xz
L2tjb25maWcvY2hlY2suc2ggYi94ZW4vdG9vbHMva2NvbmZpZy9jaGVjay5zaApkZWxldGVkIGZp
bGUgbW9kZSAxMDA3NTUKaW5kZXggNTViNzliYTFiYS4uMDAwMDAwMDAwMAotLS0gYS94ZW4vdG9v
bHMva2NvbmZpZy9jaGVjay5zaAorKysgL2Rldi9udWxsCkBAIC0xLDEzICswLDAgQEAKLSMhL2Jp
bi9zaAotIyBOZWVkZWQgZm9yIHN5c3RlbXMgd2l0aG91dCBnZXR0ZXh0Ci0kKiAteCBjIC1vIC9k
ZXYvbnVsbCAtID4gL2Rldi9udWxsIDI+JjEgPDwgRU9GCi0jaW5jbHVkZSA8bGliaW50bC5oPgot
aW50IG1haW4oKQotewotCWdldHRleHQoIiIpOwotCXJldHVybiAwOwotfQotRU9GCi1pZiBbICEg
IiQ/IiAtZXEgIjAiICBdOyB0aGVuCi0JZWNobyAtREtCVUlMRF9OT19OTFM7Ci1maQpkaWZmIC0t
Z2l0IGEveGVuL3Rvb2xzL2tjb25maWcvY29uZi5jIGIveGVuL3Rvb2xzL2tjb25maWcvY29uZi5j
CmluZGV4IDZjMjA0MzE4YmMuLmQ5ODZmNDQwOTggMTAwNjQ0Ci0tLSBhL3hlbi90b29scy9rY29u
ZmlnL2NvbmYuYworKysgYi94ZW4vdG9vbHMva2NvbmZpZy9jb25mLmMKQEAgLTMsNyArMyw2IEBA
CiAgKiBSZWxlYXNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHUEwgdjIuMC4KICAqLwog
Ci0jaW5jbHVkZSA8bG9jYWxlLmg+CiAjaW5jbHVkZSA8Y3R5cGUuaD4KICNpbmNsdWRlIDxzdGRp
by5oPgogI2luY2x1ZGUgPHN0ZGxpYi5oPgpAQCAtNzQsOSArNzMsOSBAQCBzdGF0aWMgdm9pZCBz
dHJpcChjaGFyICpzdHIpCiBzdGF0aWMgdm9pZCBjaGVja19zdGRpbih2b2lkKQogewogCWlmICgh
dmFsaWRfc3RkaW4pIHsKLQkJcHJpbnRmKF8oImFib3J0ZWQhXG5cbiIpKTsKLQkJcHJpbnRmKF8o
IkNvbnNvbGUgaW5wdXQvb3V0cHV0IGlzIHJlZGlyZWN0ZWQuICIpKTsKLQkJcHJpbnRmKF8oIlJ1
biAnbWFrZSBvbGRjb25maWcnIHRvIHVwZGF0ZSBjb25maWd1cmF0aW9uLlxuXG4iKSk7CisJCXBy
aW50ZigiYWJvcnRlZCFcblxuIik7CisJCXByaW50ZigiQ29uc29sZSBpbnB1dC9vdXRwdXQgaXMg
cmVkaXJlY3RlZC4gIik7CisJCXByaW50ZigiUnVuICdtYWtlIG9sZGNvbmZpZycgdG8gdXBkYXRl
IGNvbmZpZ3VyYXRpb24uXG5cbiIpOwogCQlleGl0KDEpOwogCX0KIH0KQEAgLTg2LDcgKzg1LDcg
QEAgc3RhdGljIGludCBjb25mX2Fza3ZhbHVlKHN0cnVjdCBzeW1ib2wgKnN5bSwgY29uc3QgY2hh
ciAqZGVmKQogCWVudW0gc3ltYm9sX3R5cGUgdHlwZSA9IHN5bV9nZXRfdHlwZShzeW0pOwogCiAJ
aWYgKCFzeW1faGFzX3ZhbHVlKHN5bSkpCi0JCXByaW50ZihfKCIoTkVXKSAiKSk7CisJCXByaW50
ZigiKE5FVykgIik7CiAKIAlsaW5lWzBdID0gJ1xuJzsKIAlsaW5lWzFdID0gMDsKQEAgLTEzNiw3
ICsxMzUsNyBAQCBzdGF0aWMgaW50IGNvbmZfc3RyaW5nKHN0cnVjdCBtZW51ICptZW51KQogCWNv
bnN0IGNoYXIgKmRlZjsKIAogCXdoaWxlICgxKSB7Ci0JCXByaW50ZigiJSpzJXMgIiwgaW5kZW50
IC0gMSwgIiIsIF8obWVudS0+cHJvbXB0LT50ZXh0KSk7CisJCXByaW50ZigiJSpzJXMgIiwgaW5k
ZW50IC0gMSwgIiIsIG1lbnUtPnByb21wdC0+dGV4dCk7CiAJCXByaW50ZigiKCVzKSAiLCBzeW0t
Pm5hbWUpOwogCQlkZWYgPSBzeW1fZ2V0X3N0cmluZ192YWx1ZShzeW0pOwogCQlpZiAoc3ltX2dl
dF9zdHJpbmdfdmFsdWUoc3ltKSkKQEAgLTE2OSw3ICsxNjgsNyBAQCBzdGF0aWMgaW50IGNvbmZf
c3ltKHN0cnVjdCBtZW51ICptZW51KQogCXRyaXN0YXRlIG9sZHZhbCwgbmV3dmFsOwogCiAJd2hp
bGUgKDEpIHsKLQkJcHJpbnRmKCIlKnMlcyAiLCBpbmRlbnQgLSAxLCAiIiwgXyhtZW51LT5wcm9t
cHQtPnRleHQpKTsKKwkJcHJpbnRmKCIlKnMlcyAiLCBpbmRlbnQgLSAxLCAiIiwgbWVudS0+cHJv
bXB0LT50ZXh0KTsKIAkJaWYgKHN5bS0+bmFtZSkKIAkJCXByaW50ZigiKCVzKSAiLCBzeW0tPm5h
bWUpOwogCQlwdXRjaGFyKCdbJyk7CkBAIC0yNTYsNyArMjU1LDcgQEAgc3RhdGljIGludCBjb25m
X2Nob2ljZShzdHJ1Y3QgbWVudSAqbWVudSkKIAkJY2FzZSBubzoKIAkJCXJldHVybiAxOwogCQlj
YXNlIG1vZDoKLQkJCXByaW50ZigiJSpzJXNcbiIsIGluZGVudCAtIDEsICIiLCBfKG1lbnVfZ2V0
X3Byb21wdChtZW51KSkpOworCQkJcHJpbnRmKCIlKnMlc1xuIiwgaW5kZW50IC0gMSwgIiIsIG1l
bnVfZ2V0X3Byb21wdChtZW51KSk7CiAJCQlyZXR1cm4gMDsKIAkJY2FzZSB5ZXM6CiAJCQlicmVh
azsKQEAgLTI2Niw3ICsyNjUsNyBAQCBzdGF0aWMgaW50IGNvbmZfY2hvaWNlKHN0cnVjdCBtZW51
ICptZW51KQogCXdoaWxlICgxKSB7CiAJCWludCBjbnQsIGRlZjsKIAotCQlwcmludGYoIiUqcyVz
XG4iLCBpbmRlbnQgLSAxLCAiIiwgXyhtZW51X2dldF9wcm9tcHQobWVudSkpKTsKKwkJcHJpbnRm
KCIlKnMlc1xuIiwgaW5kZW50IC0gMSwgIiIsIG1lbnVfZ2V0X3Byb21wdChtZW51KSk7CiAJCWRl
Zl9zeW0gPSBzeW1fZ2V0X2Nob2ljZV92YWx1ZShzeW0pOwogCQljbnQgPSBkZWYgPSAwOwogCQls
aW5lWzBdID0gMDsKQEAgLTI3NCw3ICsyNzMsNyBAQCBzdGF0aWMgaW50IGNvbmZfY2hvaWNlKHN0
cnVjdCBtZW51ICptZW51KQogCQkJaWYgKCFtZW51X2lzX3Zpc2libGUoY2hpbGQpKQogCQkJCWNv
bnRpbnVlOwogCQkJaWYgKCFjaGlsZC0+c3ltKSB7Ci0JCQkJcHJpbnRmKCIlKmMgJXNcbiIsIGlu
ZGVudCwgJyonLCBfKG1lbnVfZ2V0X3Byb21wdChjaGlsZCkpKTsKKwkJCQlwcmludGYoIiUqYyAl
c1xuIiwgaW5kZW50LCAnKicsIG1lbnVfZ2V0X3Byb21wdChjaGlsZCkpOwogCQkJCWNvbnRpbnVl
OwogCQkJfQogCQkJY250Kys7CkBAIC0yODMsMTQgKzI4MiwxNCBAQCBzdGF0aWMgaW50IGNvbmZf
Y2hvaWNlKHN0cnVjdCBtZW51ICptZW51KQogCQkJCXByaW50ZigiJSpjIiwgaW5kZW50LCAnPicp
OwogCQkJfSBlbHNlCiAJCQkJcHJpbnRmKCIlKmMiLCBpbmRlbnQsICcgJyk7Ci0JCQlwcmludGYo
IiAlZC4gJXMiLCBjbnQsIF8obWVudV9nZXRfcHJvbXB0KGNoaWxkKSkpOworCQkJcHJpbnRmKCIg
JWQuICVzIiwgY250LCBtZW51X2dldF9wcm9tcHQoY2hpbGQpKTsKIAkJCWlmIChjaGlsZC0+c3lt
LT5uYW1lKQogCQkJCXByaW50ZigiICglcykiLCBjaGlsZC0+c3ltLT5uYW1lKTsKIAkJCWlmICgh
c3ltX2hhc192YWx1ZShjaGlsZC0+c3ltKSkKLQkJCQlwcmludGYoXygiIChORVcpIikpOworCQkJ
CXByaW50ZigiIChORVcpIik7CiAJCQlwcmludGYoIlxuIik7CiAJCX0KLQkJcHJpbnRmKF8oIiUq
c2Nob2ljZSIpLCBpbmRlbnQgLSAxLCAiIik7CisJCXByaW50ZigiJSpzY2hvaWNlIiwgaW5kZW50
IC0gMSwgIiIpOwogCQlpZiAoY250ID09IDEpIHsKIAkJCXByaW50ZigiWzFdOiAxXG4iKTsKIAkJ
CWdvdG8gY29uZl9jaGlsZHM7CkBAIC0zODAsNyArMzc5LDcgQEAgc3RhdGljIHZvaWQgY29uZihz
dHJ1Y3QgbWVudSAqbWVudSkKIAkJCWlmIChwcm9tcHQpCiAJCQkJcHJpbnRmKCIlKmNcbiUqYyAl
c1xuJSpjXG4iLAogCQkJCQlpbmRlbnQsICcqJywKLQkJCQkJaW5kZW50LCAnKicsIF8ocHJvbXB0
KSwKKwkJCQkJaW5kZW50LCAnKicsIHByb21wdCwKIAkJCQkJaW5kZW50LCAnKicpOwogCQlkZWZh
dWx0OgogCQkJOwpAQCAtNDM1LDcgKzQzNCw3IEBAIHN0YXRpYyB2b2lkIGNoZWNrX2NvbmYoc3Ry
dWN0IG1lbnUgKm1lbnUpCiAJCQkJfQogCQkJfSBlbHNlIGlmIChpbnB1dF9tb2RlICE9IG9sZGRl
ZmNvbmZpZykgewogCQkJCWlmICghY29uZl9jbnQrKykKLQkJCQkJcHJpbnRmKF8oIipcbiogUmVz
dGFydCBjb25maWcuLi5cbipcbiIpKTsKKwkJCQkJcHJpbnRmKCIqXG4qIFJlc3RhcnQgY29uZmln
Li4uXG4qXG4iKTsKIAkJCQlyb290RW50cnkgPSBtZW51X2dldF9wYXJlbnRfbWVudShtZW51KTsK
IAkJCQljb25mKHJvb3RFbnRyeSk7CiAJCQl9CkBAIC00OTUsMTAgKzQ5NCw2IEBAIGludCBtYWlu
KGludCBhYywgY2hhciAqKmF2KQogCWNvbnN0IGNoYXIgKm5hbWUsICpkZWZjb25maWdfZmlsZSA9
IE5VTEwgLyogZ2NjIHVuaW5pdCAqLzsKIAlzdHJ1Y3Qgc3RhdCB0bXBzdGF0OwogCi0Jc2V0bG9j
YWxlKExDX0FMTCwgIiIpOwotCWJpbmR0ZXh0ZG9tYWluKFBBQ0tBR0UsIExPQ0FMRURJUik7Ci0J
dGV4dGRvbWFpbihQQUNLQUdFKTsKLQogCXR0eV9zdGRpbyA9IGlzYXR0eSgwKSAmJiBpc2F0dHko
MSkgJiYgaXNhdHR5KDIpOwogCiAJd2hpbGUgKChvcHQgPSBnZXRvcHRfbG9uZyhhYywgYXYsICJz
IiwgbG9uZ19vcHRzLCBOVUxMKSkgIT0gLTEpIHsKQEAgLTU1Niw3ICs1NTEsNyBAQCBpbnQgbWFp
bihpbnQgYWMsIGNoYXIgKiphdikKIAkJfQogCX0KIAlpZiAoYWMgPT0gb3B0aW5kKSB7Ci0JCXBy
aW50ZihfKCIlczogS2NvbmZpZyBmaWxlIG1pc3NpbmdcbiIpLCBhdlswXSk7CisJCXByaW50Zigi
JXM6IEtjb25maWcgZmlsZSBtaXNzaW5nXG4iLCBhdlswXSk7CiAJCWNvbmZfdXNhZ2UocHJvZ25h
bWUpOwogCQlleGl0KDEpOwogCX0KQEAgLTU2NiwxMiArNTYxLDEyIEBAIGludCBtYWluKGludCBh
YywgY2hhciAqKmF2KQogCWlmIChzeW5jX2tjb25maWcpIHsKIAkJbmFtZSA9IGNvbmZfZ2V0X2Nv
bmZpZ25hbWUoKTsKIAkJaWYgKHN0YXQobmFtZSwgJnRtcHN0YXQpKSB7Ci0JCQlmcHJpbnRmKHN0
ZGVyciwgXygiKioqXG4iCisJCQlmcHJpbnRmKHN0ZGVyciwgIioqKlxuIgogCQkJCSIqKiogQ29u
ZmlndXJhdGlvbiBmaWxlIFwiJXNcIiBub3QgZm91bmQhXG4iCiAJCQkJIioqKlxuIgogCQkJCSIq
KiogUGxlYXNlIHJ1biBzb21lIGNvbmZpZ3VyYXRvciAoZS5nLiBcIm1ha2Ugb2xkY29uZmlnXCIg
b3JcbiIKIAkJCQkiKioqIFwibWFrZSBtZW51Y29uZmlnXCIgb3IgXCJtYWtlIHhjb25maWdcIiku
XG4iCi0JCQkJIioqKlxuIiksIG5hbWUpOworCQkJCSIqKipcbiIsIG5hbWUpOwogCQkJZXhpdCgx
KTsKIAkJfQogCX0KQEAgLTU4MSw5ICs1NzYsOSBAQCBpbnQgbWFpbihpbnQgYWMsIGNoYXIgKiph
dikKIAkJaWYgKCFkZWZjb25maWdfZmlsZSkKIAkJCWRlZmNvbmZpZ19maWxlID0gY29uZl9nZXRf
ZGVmYXVsdF9jb25mbmFtZSgpOwogCQlpZiAoY29uZl9yZWFkKGRlZmNvbmZpZ19maWxlKSkgewot
CQkJcHJpbnRmKF8oIioqKlxuIgorCQkJcHJpbnRmKCIqKipcbiIKIAkJCQkiKioqIENhbid0IGZp
bmQgZGVmYXVsdCBjb25maWd1cmF0aW9uIFwiJXNcIiFcbiIKLQkJCQkiKioqXG4iKSwgZGVmY29u
ZmlnX2ZpbGUpOworCQkJCSIqKipcbiIsIGRlZmNvbmZpZ19maWxlKTsKIAkJCWV4aXQoMSk7CiAJ
CX0KIAkJYnJlYWs7CkBAIC02MDYsNyArNjAxLDcgQEAgaW50IG1haW4oaW50IGFjLCBjaGFyICoq
YXYpCiAJCWlmICgoc3RyY21wKG5hbWUsICIiKSAhPSAwKSAmJiAoc3RyY21wKG5hbWUsICIxIikg
IT0gMCkpIHsKIAkJCWlmIChjb25mX3JlYWRfc2ltcGxlKG5hbWUsIFNfREVGX1VTRVIpKSB7CiAJ
CQkJZnByaW50ZihzdGRlcnIsCi0JCQkJCV8oIioqKiBDYW4ndCByZWFkIHNlZWQgY29uZmlndXJh
dGlvbiBcIiVzXCIhXG4iKSwKKwkJCQkJIioqKiBDYW4ndCByZWFkIHNlZWQgY29uZmlndXJhdGlv
biBcIiVzXCIhXG4iLAogCQkJCQluYW1lKTsKIAkJCQlleGl0KDEpOwogCQkJfQpAQCAtNjIzLDcg
KzYxOCw3IEBAIGludCBtYWluKGludCBhYywgY2hhciAqKmF2KQogCQlpZiAoY29uZl9yZWFkX3Np
bXBsZShuYW1lLCBTX0RFRl9VU0VSKSAmJgogCQkgICAgY29uZl9yZWFkX3NpbXBsZSgiYWxsLmNv
bmZpZyIsIFNfREVGX1VTRVIpKSB7CiAJCQlmcHJpbnRmKHN0ZGVyciwKLQkJCQlfKCIqKiogS0NP
TkZJR19BTExDT05GSUcgc2V0LCBidXQgbm8gXCIlc1wiIG9yIFwiYWxsLmNvbmZpZ1wiIGZpbGUg
Zm91bmRcbiIpLAorCQkJCSIqKiogS0NPTkZJR19BTExDT05GSUcgc2V0LCBidXQgbm8gXCIlc1wi
IG9yIFwiYWxsLmNvbmZpZ1wiIGZpbGUgZm91bmRcbiIsCiAJCQkJbmFtZSk7CiAJCQlleGl0KDEp
OwogCQl9CkBAIC02MzcsNyArNjMyLDcgQEAgaW50IG1haW4oaW50IGFjLCBjaGFyICoqYXYpCiAJ
CQluYW1lID0gZ2V0ZW52KCJLQ09ORklHX05PU0lMRU5UVVBEQVRFIik7CiAJCQlpZiAobmFtZSAm
JiAqbmFtZSkgewogCQkJCWZwcmludGYoc3RkZXJyLAotCQkJCQlfKCJcbioqKiBUaGUgY29uZmln
dXJhdGlvbiByZXF1aXJlcyBleHBsaWNpdCB1cGRhdGUuXG5cbiIpKTsKKwkJCQkJIlxuKioqIFRo
ZSBjb25maWd1cmF0aW9uIHJlcXVpcmVzIGV4cGxpY2l0IHVwZGF0ZS5cblxuIik7CiAJCQkJcmV0
dXJuIDE7CiAJCQl9CiAJCX0KQEAgLTY5MCwyMiArNjg1LDIyIEBAIGludCBtYWluKGludCBhYywg
Y2hhciAqKmF2KQogCQkgKiBBbGwgb3RoZXIgY29tbWFuZHMgYXJlIG9ubHkgdXNlZCB0byBnZW5l
cmF0ZSBhIGNvbmZpZy4KIAkJICovCiAJCWlmIChjb25mX2dldF9jaGFuZ2VkKCkgJiYgY29uZl93
cml0ZShOVUxMKSkgewotCQkJZnByaW50ZihzdGRlcnIsIF8oIlxuKioqIEVycm9yIGR1cmluZyB3
cml0aW5nIG9mIHRoZSBjb25maWd1cmF0aW9uLlxuXG4iKSk7CisJCQlmcHJpbnRmKHN0ZGVyciwg
IlxuKioqIEVycm9yIGR1cmluZyB3cml0aW5nIG9mIHRoZSBjb25maWd1cmF0aW9uLlxuXG4iKTsK
IAkJCWV4aXQoMSk7CiAJCX0KIAkJaWYgKGNvbmZfd3JpdGVfYXV0b2NvbmYoKSkgewotCQkJZnBy
aW50ZihzdGRlcnIsIF8oIlxuKioqIEVycm9yIGR1cmluZyB1cGRhdGUgb2YgdGhlIGNvbmZpZ3Vy
YXRpb24uXG5cbiIpKTsKKwkJCWZwcmludGYoc3RkZXJyLCAiXG4qKiogRXJyb3IgZHVyaW5nIHVw
ZGF0ZSBvZiB0aGUgY29uZmlndXJhdGlvbi5cblxuIik7CiAJCQlyZXR1cm4gMTsKIAkJfQogCX0g
ZWxzZSBpZiAoaW5wdXRfbW9kZSA9PSBzYXZlZGVmY29uZmlnKSB7CiAJCWlmIChjb25mX3dyaXRl
X2RlZmNvbmZpZyhkZWZjb25maWdfZmlsZSkpIHsKLQkJCWZwcmludGYoc3RkZXJyLCBfKCJuKioq
IEVycm9yIHdoaWxlIHNhdmluZyBkZWZjb25maWcgdG86ICVzXG5cbiIpLAorCQkJZnByaW50Zihz
dGRlcnIsICJuKioqIEVycm9yIHdoaWxlIHNhdmluZyBkZWZjb25maWcgdG86ICVzXG5cbiIsCiAJ
CQkJZGVmY29uZmlnX2ZpbGUpOwogCQkJcmV0dXJuIDE7CiAJCX0KIAl9IGVsc2UgaWYgKGlucHV0
X21vZGUgIT0gbGlzdG5ld2NvbmZpZykgewogCQlpZiAoY29uZl93cml0ZShOVUxMKSkgewotCQkJ
ZnByaW50ZihzdGRlcnIsIF8oIlxuKioqIEVycm9yIGR1cmluZyB3cml0aW5nIG9mIHRoZSBjb25m
aWd1cmF0aW9uLlxuXG4iKSk7CisJCQlmcHJpbnRmKHN0ZGVyciwgIlxuKioqIEVycm9yIGR1cmlu
ZyB3cml0aW5nIG9mIHRoZSBjb25maWd1cmF0aW9uLlxuXG4iKTsKIAkJCWV4aXQoMSk7CiAJCX0K
IAl9CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMva2NvbmZpZy9jb25mZGF0YS5jIGIveGVuL3Rvb2xz
L2tjb25maWcvY29uZmRhdGEuYwppbmRleCAwYjdkYzJmZDdiLi43ZDM4ZDg3YTJlIDEwMDY0NAot
LS0gYS94ZW4vdG9vbHMva2NvbmZpZy9jb25mZGF0YS5jCisrKyBiL3hlbi90b29scy9rY29uZmln
L2NvbmZkYXRhLmMKQEAgLTI3OSw3ICsyNzksNyBAQCBpbnQgY29uZl9yZWFkX3NpbXBsZShjb25z
dCBjaGFyICpuYW1lLCBpbnQgZGVmKQogCQkJbmFtZSA9IGNvbmZfZXhwYW5kX3ZhbHVlKHByb3At
PmV4cHItPmxlZnQuc3ltLT5uYW1lKTsKIAkJCWluID0gemNvbmZfZm9wZW4obmFtZSk7CiAJCQlp
ZiAoaW4pIHsKLQkJCQljb25mX21lc3NhZ2UoXygidXNpbmcgZGVmYXVsdHMgZm91bmQgaW4gJXMi
KSwKKwkJCQljb25mX21lc3NhZ2UoInVzaW5nIGRlZmF1bHRzIGZvdW5kIGluICVzIiwKIAkJCQkJ
IG5hbWUpOwogCQkJCWdvdG8gbG9hZDsKIAkJCX0KQEAgLTgyOCw3ICs4MjgsNyBAQCBpbnQgY29u
Zl93cml0ZShjb25zdCBjaGFyICpuYW1lKQogCQkJcmV0dXJuIDE7CiAJfQogCi0JY29uZl9tZXNz
YWdlKF8oImNvbmZpZ3VyYXRpb24gd3JpdHRlbiB0byAlcyIpLCBuZXduYW1lKTsKKwljb25mX21l
c3NhZ2UoImNvbmZpZ3VyYXRpb24gd3JpdHRlbiB0byAlcyIsIG5ld25hbWUpOwogCiAJc3ltX3Nl
dF9jaGFuZ2VfY291bnQoMCk7CiAKZGlmZiAtLWdpdCBhL3hlbi90b29scy9rY29uZmlnL2djb25m
LmMgYi94ZW4vdG9vbHMva2NvbmZpZy9nY29uZi5jCmluZGV4IDI2ZDIwOGI0MzUuLjQwNTE3ODc2
OTEgMTAwNjQ0Ci0tLSBhL3hlbi90b29scy9rY29uZmlnL2djb25mLmMKKysrIGIveGVuL3Rvb2xz
L2tjb25maWcvZ2NvbmYuYwpAQCAtMTM3LDcgKzEzNyw3IEBAIHZvaWQgaW5pdF9tYWluX3dpbmRv
dyhjb25zdCBnY2hhciAqIGdsYWRlX2ZpbGUpCiAKIAl4bWwgPSBnbGFkZV94bWxfbmV3KGdsYWRl
X2ZpbGUsICJ3aW5kb3cxIiwgTlVMTCk7CiAJaWYgKCF4bWwpCi0JCWdfZXJyb3IoXygiR1VJIGxv
YWRpbmcgZmFpbGVkICFcbiIpKTsKKwkJZ19lcnJvcigiR1VJIGxvYWRpbmcgZmFpbGVkICFcbiIp
OwogCWdsYWRlX3htbF9zaWduYWxfYXV0b2Nvbm5lY3QoeG1sKTsKIAogCW1haW5fd25kID0gZ2xh
ZGVfeG1sX2dldF93aWRnZXQoeG1sLCAid2luZG93MSIpOwpAQCAtMjMzLDcgKzIzMyw3IEBAIHZv
aWQgaW5pdF9sZWZ0X3RyZWUodm9pZCkKIAogCWNvbHVtbiA9IGd0a190cmVlX3ZpZXdfY29sdW1u
X25ldygpOwogCWd0a190cmVlX3ZpZXdfYXBwZW5kX2NvbHVtbih2aWV3LCBjb2x1bW4pOwotCWd0
a190cmVlX3ZpZXdfY29sdW1uX3NldF90aXRsZShjb2x1bW4sIF8oIk9wdGlvbnMiKSk7CisJZ3Rr
X3RyZWVfdmlld19jb2x1bW5fc2V0X3RpdGxlKGNvbHVtbiwgIk9wdGlvbnMiKTsKIAogCXJlbmRl
cmVyID0gZ3RrX2NlbGxfcmVuZGVyZXJfdG9nZ2xlX25ldygpOwogCWd0a190cmVlX3ZpZXdfY29s
dW1uX3BhY2tfc3RhcnQoR1RLX1RSRUVfVklFV19DT0xVTU4oY29sdW1uKSwKQEAgLTI3Niw3ICsy
NzYsNyBAQCB2b2lkIGluaXRfcmlnaHRfdHJlZSh2b2lkKQogCiAJY29sdW1uID0gZ3RrX3RyZWVf
dmlld19jb2x1bW5fbmV3KCk7CiAJZ3RrX3RyZWVfdmlld19hcHBlbmRfY29sdW1uKHZpZXcsIGNv
bHVtbik7Ci0JZ3RrX3RyZWVfdmlld19jb2x1bW5fc2V0X3RpdGxlKGNvbHVtbiwgXygiT3B0aW9u
cyIpKTsKKwlndGtfdHJlZV92aWV3X2NvbHVtbl9zZXRfdGl0bGUoY29sdW1uLCAiT3B0aW9ucyIp
OwogCiAJcmVuZGVyZXIgPSBndGtfY2VsbF9yZW5kZXJlcl9waXhidWZfbmV3KCk7CiAJZ3RrX3Ry
ZWVfdmlld19jb2x1bW5fcGFja19zdGFydChHVEtfVFJFRV9WSUVXX0NPTFVNTihjb2x1bW4pLApA
QCAtMzA1LDcgKzMwNSw3IEBAIHZvaWQgaW5pdF9yaWdodF90cmVlKHZvaWQpCiAKIAlyZW5kZXJl
ciA9IGd0a19jZWxsX3JlbmRlcmVyX3RleHRfbmV3KCk7CiAJZ3RrX3RyZWVfdmlld19pbnNlcnRf
Y29sdW1uX3dpdGhfYXR0cmlidXRlcyh2aWV3LCAtMSwKLQkJCQkJCSAgICBfKCJOYW1lIiksIHJl
bmRlcmVyLAorCQkJCQkJICAgICJOYW1lIiwgcmVuZGVyZXIsCiAJCQkJCQkgICAgInRleHQiLCBD
T0xfTkFNRSwKIAkJCQkJCSAgICAiZm9yZWdyb3VuZC1nZGsiLAogCQkJCQkJICAgIENPTF9DT0xP
UiwgTlVMTCk7CkBAIC0zMjksNyArMzI5LDcgQEAgdm9pZCBpbml0X3JpZ2h0X3RyZWUodm9pZCkK
IAkJCQkJCSAgICBDT0xfQ09MT1IsIE5VTEwpOwogCXJlbmRlcmVyID0gZ3RrX2NlbGxfcmVuZGVy
ZXJfdGV4dF9uZXcoKTsKIAlndGtfdHJlZV92aWV3X2luc2VydF9jb2x1bW5fd2l0aF9hdHRyaWJ1
dGVzKHZpZXcsIC0xLAotCQkJCQkJICAgIF8oIlZhbHVlIiksIHJlbmRlcmVyLAorCQkJCQkJICAg
ICJWYWx1ZSIsIHJlbmRlcmVyLAogCQkJCQkJICAgICJ0ZXh0IiwgQ09MX1ZBTFVFLAogCQkJCQkJ
ICAgICJlZGl0YWJsZSIsCiAJCQkJCQkgICAgQ09MX0VESVQsCkBAIC0zNjgsNyArMzY4LDcgQEAg
c3RhdGljIHZvaWQgdGV4dF9pbnNlcnRfaGVscChzdHJ1Y3QgbWVudSAqbWVudSkKIHsKIAlHdGtU
ZXh0QnVmZmVyICpidWZmZXI7CiAJR3RrVGV4dEl0ZXIgc3RhcnQsIGVuZDsKLQljb25zdCBjaGFy
ICpwcm9tcHQgPSBfKG1lbnVfZ2V0X3Byb21wdChtZW51KSk7CisJY29uc3QgY2hhciAqcHJvbXB0
ID0gbWVudV9nZXRfcHJvbXB0KG1lbnUpOwogCXN0cnVjdCBnc3RyIGhlbHAgPSBzdHJfbmV3KCk7
CiAKIAltZW51X2dldF9leHRfaGVscChtZW51LCAmaGVscCk7CkBAIC00MjIsNyArNDIyLDcgQEAg
Z2Jvb2xlYW4gb25fd2luZG93MV9kZWxldGVfZXZlbnQoR3RrV2lkZ2V0ICogd2lkZ2V0LCBHZGtF
dmVudCAqIGV2ZW50LAogCWlmICghY29uZl9nZXRfY2hhbmdlZCgpKQogCQlyZXR1cm4gRkFMU0U7
CiAKLQlkaWFsb2cgPSBndGtfZGlhbG9nX25ld193aXRoX2J1dHRvbnMoXygiV2FybmluZyAhIiks
CisJZGlhbG9nID0gZ3RrX2RpYWxvZ19uZXdfd2l0aF9idXR0b25zKCJXYXJuaW5nICEiLAogCQkJ
CQkgICAgIEdUS19XSU5ET1cobWFpbl93bmQpLAogCQkJCQkgICAgIChHdGtEaWFsb2dGbGFncykK
IAkJCQkJICAgICAoR1RLX0RJQUxPR19NT0RBTCB8CkBAIC00MzYsNyArNDM2LDcgQEAgZ2Jvb2xl
YW4gb25fd2luZG93MV9kZWxldGVfZXZlbnQoR3RrV2lkZ2V0ICogd2lkZ2V0LCBHZGtFdmVudCAq
IGV2ZW50LAogCWd0a19kaWFsb2dfc2V0X2RlZmF1bHRfcmVzcG9uc2UoR1RLX0RJQUxPRyhkaWFs
b2cpLAogCQkJCQlHVEtfUkVTUE9OU0VfQ0FOQ0VMKTsKIAotCWxhYmVsID0gZ3RrX2xhYmVsX25l
dyhfKCJcblNhdmUgY29uZmlndXJhdGlvbiA/XG4iKSk7CisJbGFiZWwgPSBndGtfbGFiZWxfbmV3
KCJcblNhdmUgY29uZmlndXJhdGlvbiA/XG4iKTsKIAlndGtfY29udGFpbmVyX2FkZChHVEtfQ09O
VEFJTkVSKEdUS19ESUFMT0coZGlhbG9nKS0+dmJveCksIGxhYmVsKTsKIAlndGtfd2lkZ2V0X3No
b3cobGFiZWwpOwogCkBAIC00OTYsNyArNDk2LDcgQEAgbG9hZF9maWxlbmFtZShHdGtGaWxlU2Vs
ZWN0aW9uICogZmlsZV9zZWxlY3RvciwgZ3BvaW50ZXIgdXNlcl9kYXRhKQogCQkJCQkgICAgICh1
c2VyX2RhdGEpKTsKIAogCWlmIChjb25mX3JlYWQoZm4pKQotCQl0ZXh0X2luc2VydF9tc2coXygi
RXJyb3IiKSwgXygiVW5hYmxlIHRvIGxvYWQgY29uZmlndXJhdGlvbiAhIikpOworCQl0ZXh0X2lu
c2VydF9tc2coIkVycm9yIiwgIlVuYWJsZSB0byBsb2FkIGNvbmZpZ3VyYXRpb24gISIpOwogCWVs
c2UKIAkJZGlzcGxheV90cmVlKCZyb290bWVudSk7CiB9CkBAIC01MDUsNyArNTA1LDcgQEAgdm9p
ZCBvbl9sb2FkMV9hY3RpdmF0ZShHdGtNZW51SXRlbSAqIG1lbnVpdGVtLCBncG9pbnRlciB1c2Vy
X2RhdGEpCiB7CiAJR3RrV2lkZ2V0ICpmczsKIAotCWZzID0gZ3RrX2ZpbGVfc2VsZWN0aW9uX25l
dyhfKCJMb2FkIGZpbGUuLi4iKSk7CisJZnMgPSBndGtfZmlsZV9zZWxlY3Rpb25fbmV3KCJMb2Fk
IGZpbGUuLi4iKTsKIAlnX3NpZ25hbF9jb25uZWN0KEdUS19PQkpFQ1QoR1RLX0ZJTEVfU0VMRUNU
SU9OKGZzKS0+b2tfYnV0dG9uKSwKIAkJCSAiY2xpY2tlZCIsCiAJCQkgR19DQUxMQkFDSyhsb2Fk
X2ZpbGVuYW1lKSwgKGdwb2ludGVyKSBmcyk7CkBAIC01MjQsNyArNTI0LDcgQEAgdm9pZCBvbl9s
b2FkMV9hY3RpdmF0ZShHdGtNZW51SXRlbSAqIG1lbnVpdGVtLCBncG9pbnRlciB1c2VyX2RhdGEp
CiB2b2lkIG9uX3NhdmVfYWN0aXZhdGUoR3RrTWVudUl0ZW0gKiBtZW51aXRlbSwgZ3BvaW50ZXIg
dXNlcl9kYXRhKQogewogCWlmIChjb25mX3dyaXRlKE5VTEwpKQotCQl0ZXh0X2luc2VydF9tc2co
XygiRXJyb3IiKSwgXygiVW5hYmxlIHRvIHNhdmUgY29uZmlndXJhdGlvbiAhIikpOworCQl0ZXh0
X2luc2VydF9tc2coIkVycm9yIiwgIlVuYWJsZSB0byBzYXZlIGNvbmZpZ3VyYXRpb24gISIpOwog
fQogCiAKQEAgLTUzNyw3ICs1MzcsNyBAQCBzdG9yZV9maWxlbmFtZShHdGtGaWxlU2VsZWN0aW9u
ICogZmlsZV9zZWxlY3RvciwgZ3BvaW50ZXIgdXNlcl9kYXRhKQogCQkJCQkgICAgICh1c2VyX2Rh
dGEpKTsKIAogCWlmIChjb25mX3dyaXRlKGZuKSkKLQkJdGV4dF9pbnNlcnRfbXNnKF8oIkVycm9y
IiksIF8oIlVuYWJsZSB0byBzYXZlIGNvbmZpZ3VyYXRpb24gISIpKTsKKwkJdGV4dF9pbnNlcnRf
bXNnKCJFcnJvciIsICJVbmFibGUgdG8gc2F2ZSBjb25maWd1cmF0aW9uICEiKTsKIAogCWd0a193
aWRnZXRfZGVzdHJveShHVEtfV0lER0VUKHVzZXJfZGF0YSkpOwogfQpAQCAtNTQ2LDcgKzU0Niw3
IEBAIHZvaWQgb25fc2F2ZV9hczFfYWN0aXZhdGUoR3RrTWVudUl0ZW0gKiBtZW51aXRlbSwgZ3Bv
aW50ZXIgdXNlcl9kYXRhKQogewogCUd0a1dpZGdldCAqZnM7CiAKLQlmcyA9IGd0a19maWxlX3Nl
bGVjdGlvbl9uZXcoXygiU2F2ZSBmaWxlIGFzLi4uIikpOworCWZzID0gZ3RrX2ZpbGVfc2VsZWN0
aW9uX25ldygiU2F2ZSBmaWxlIGFzLi4uIik7CiAJZ19zaWduYWxfY29ubmVjdChHVEtfT0JKRUNU
KEdUS19GSUxFX1NFTEVDVElPTihmcyktPm9rX2J1dHRvbiksCiAJCQkgImNsaWNrZWQiLAogCQkJ
IEdfQ0FMTEJBQ0soc3RvcmVfZmlsZW5hbWUpLCAoZ3BvaW50ZXIpIGZzKTsKQEAgLTYzOSw3ICs2
MzksNyBAQCBvbl9zZXRfb3B0aW9uX21vZGUzX2FjdGl2YXRlKEd0a01lbnVJdGVtICptZW51aXRl
bSwgZ3BvaW50ZXIgdXNlcl9kYXRhKQogdm9pZCBvbl9pbnRyb2R1Y3Rpb24xX2FjdGl2YXRlKEd0
a01lbnVJdGVtICogbWVudWl0ZW0sIGdwb2ludGVyIHVzZXJfZGF0YSkKIHsKIAlHdGtXaWRnZXQg
KmRpYWxvZzsKLQljb25zdCBnY2hhciAqaW50cm9fdGV4dCA9IF8oCisJY29uc3QgZ2NoYXIgKmlu
dHJvX3RleHQgPSAKIAkgICAgIldlbGNvbWUgdG8gZ2tjLCB0aGUgR1RLKyBncmFwaGljYWwgY29u
ZmlndXJhdGlvbiB0b29sXG4iCiAJICAgICJGb3IgZWFjaCBvcHRpb24sIGEgYmxhbmsgYm94IGlu
ZGljYXRlcyB0aGUgZmVhdHVyZSBpcyBkaXNhYmxlZCwgYVxuIgogCSAgICAiY2hlY2sgaW5kaWNh
dGVzIGl0IGlzIGVuYWJsZWQsIGFuZCBhIGRvdCBpbmRpY2F0ZXMgdGhhdCBpdCBpcyB0b1xuIgpA
QCAtNjU0LDcgKzY1NCw3IEBAIHZvaWQgb25faW50cm9kdWN0aW9uMV9hY3RpdmF0ZShHdGtNZW51
SXRlbSAqIG1lbnVpdGVtLCBncG9pbnRlciB1c2VyX2RhdGEpCiAJICAgICJvcHRpb24uXG4iCiAJ
ICAgICJcbiIKIAkgICAgIlRvZ2dsaW5nIFNob3cgRGVidWcgSW5mbyB1bmRlciB0aGUgT3B0aW9u
cyBtZW51IHdpbGwgc2hvdyBcbiIKLQkgICAgInRoZSBkZXBlbmRlbmNpZXMsIHdoaWNoIHlvdSBj
YW4gdGhlbiBtYXRjaCBieSBleGFtaW5pbmcgb3RoZXIgb3B0aW9ucy4iKTsKKwkgICAgInRoZSBk
ZXBlbmRlbmNpZXMsIHdoaWNoIHlvdSBjYW4gdGhlbiBtYXRjaCBieSBleGFtaW5pbmcgb3RoZXIg
b3B0aW9ucy4iOwogCiAJZGlhbG9nID0gZ3RrX21lc3NhZ2VfZGlhbG9nX25ldyhHVEtfV0lORE9X
KG1haW5fd25kKSwKIAkJCQkJR1RLX0RJQUxPR19ERVNUUk9ZX1dJVEhfUEFSRU5ULApAQCAtNjcx
LDggKzY3MSw4IEBAIHZvaWQgb25fYWJvdXQxX2FjdGl2YXRlKEd0a01lbnVJdGVtICogbWVudWl0
ZW0sIGdwb2ludGVyIHVzZXJfZGF0YSkKIHsKIAlHdGtXaWRnZXQgKmRpYWxvZzsKIAljb25zdCBn
Y2hhciAqYWJvdXRfdGV4dCA9Ci0JICAgIF8oImdrYyBpcyBjb3B5cmlnaHQgKGMpIDIwMDIgUm9t
YWluIExpZXZpbiA8cm9tc0BscGcudGljYWxjLm9yZz4uXG4iCi0JICAgICAgIkJhc2VkIG9uIHRo
ZSBzb3VyY2UgY29kZSBmcm9tIFJvbWFuIFppcHBlbC5cbiIpOworCSAgICAiZ2tjIGlzIGNvcHly
aWdodCAoYykgMjAwMiBSb21haW4gTGlldmluIDxyb21zQGxwZy50aWNhbGMub3JnPi5cbiIKKwkg
ICAgICAiQmFzZWQgb24gdGhlIHNvdXJjZSBjb2RlIGZyb20gUm9tYW4gWmlwcGVsLlxuIjsKIAog
CWRpYWxvZyA9IGd0a19tZXNzYWdlX2RpYWxvZ19uZXcoR1RLX1dJTkRPVyhtYWluX3duZCksCiAJ
CQkJCUdUS19ESUFMT0dfREVTVFJPWV9XSVRIX1BBUkVOVCwKQEAgLTY4OSw5ICs2ODksOSBAQCB2
b2lkIG9uX2xpY2Vuc2UxX2FjdGl2YXRlKEd0a01lbnVJdGVtICogbWVudWl0ZW0sIGdwb2ludGVy
IHVzZXJfZGF0YSkKIHsKIAlHdGtXaWRnZXQgKmRpYWxvZzsKIAljb25zdCBnY2hhciAqbGljZW5z
ZV90ZXh0ID0KLQkgICAgXygiZ2tjIGlzIHJlbGVhc2VkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
R05VIEdQTCB2Mi5cbiIKKwkgICAgImdrYyBpcyByZWxlYXNlZCB1bmRlciB0aGUgdGVybXMgb2Yg
dGhlIEdOVSBHUEwgdjIuXG4iCiAJICAgICAgIkZvciBtb3JlIGluZm9ybWF0aW9uLCBwbGVhc2Ug
c2VlIHRoZSBzb3VyY2UgY29kZSBvclxuIgotCSAgICAgICJ2aXNpdCBodHRwOi8vd3d3LmZzZi5v
cmcvbGljZW5zZXMvbGljZW5zZXMuaHRtbFxuIik7CisJICAgICAgInZpc2l0IGh0dHA6Ly93d3cu
ZnNmLm9yZy9saWNlbnNlcy9saWNlbnNlcy5odG1sXG4iOwogCiAJZGlhbG9nID0gZ3RrX21lc3Nh
Z2VfZGlhbG9nX25ldyhHVEtfV0lORE9XKG1haW5fd25kKSwKIAkJCQkJR1RLX0RJQUxPR19ERVNU
Uk9ZX1dJVEhfUEFSRU5ULApAQCAtMTA0OSw3ICsxMDQ5LDcgQEAgc3RhdGljIGdjaGFyICoqZmls
bF9yb3coc3RydWN0IG1lbnUgKm1lbnUpCiAJYnplcm8ocm93LCBzaXplb2Yocm93KSk7CiAKIAly
b3dbQ09MX09QVElPTl0gPQotCSAgICBnX3N0cmR1cF9wcmludGYoIiVzICVzIiwgXyhtZW51X2dl
dF9wcm9tcHQobWVudSkpLAorCSAgICBnX3N0cmR1cF9wcmludGYoIiVzICVzIiwgbWVudV9nZXRf
cHJvbXB0KG1lbnUpLAogCQkJICAgIHN5bSAmJiAhc3ltX2hhc192YWx1ZShzeW0pID8gIihORVcp
IiA6ICIiKTsKIAogCWlmIChvcHRfbW9kZSA9PSBPUFRfQUxMICYmICFtZW51X2lzX3Zpc2libGUo
bWVudSkpCkBAIC0xMTAyLDcgKzExMDIsNyBAQCBzdGF0aWMgZ2NoYXIgKipmaWxsX3JvdyhzdHJ1
Y3QgbWVudSAqbWVudSkKIAogCQlpZiAoZGVmX21lbnUpCiAJCQlyb3dbQ09MX1ZBTFVFXSA9Ci0J
CQkgICAgZ19zdHJkdXAoXyhtZW51X2dldF9wcm9tcHQoZGVmX21lbnUpKSk7CisJCQkgICAgZ19z
dHJkdXAobWVudV9nZXRfcHJvbXB0KGRlZl9tZW51KSk7CiAJfQogCWlmIChzeW0tPmZsYWdzICYg
U1lNQk9MX0NIT0lDRVZBTCkKIAkJcm93W0NPTF9CVE5SQURdID0gR0lOVF9UT19QT0lOVEVSKFRS
VUUpOwpAQCAtMTQ0NywxMCArMTQ0Nyw2IEBAIGludCBtYWluKGludCBhYywgY2hhciAqYXZbXSkK
IAljaGFyICplbnY7CiAJZ2NoYXIgKmdsYWRlX2ZpbGU7CiAKLQliaW5kdGV4dGRvbWFpbihQQUNL
QUdFLCBMT0NBTEVESVIpOwotCWJpbmRfdGV4dGRvbWFpbl9jb2Rlc2V0KFBBQ0tBR0UsICJVVEYt
OCIpOwotCXRleHRkb21haW4oUEFDS0FHRSk7Ci0KIAkvKiBHVEsgc3R1ZmZzICovCiAJZ3RrX3Nl
dF9sb2NhbGUoKTsKIAlndGtfaW5pdCgmYWMsICZhdik7CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMv
a2NvbmZpZy9reGdldHRleHQuYyBiL3hlbi90b29scy9rY29uZmlnL2t4Z2V0dGV4dC5jCmRlbGV0
ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAyODU4NzM4YjIyLi4wMDAwMDAwMDAwCi0tLSBhL3hl
bi90b29scy9rY29uZmlnL2t4Z2V0dGV4dC5jCisrKyAvZGV2L251bGwKQEAgLTEsMjM1ICswLDAg
QEAKLS8qCi0gKiBBcm5hbGRvIENhcnZhbGhvIGRlIE1lbG8gPGFjbWVAY29uZWN0aXZhLmNvbS5i
cj4sIDIwMDUKLSAqCi0gKiBSZWxlYXNlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHUEwg
djIuMAotICovCi0KLSNpbmNsdWRlIDxzdGRsaWIuaD4KLSNpbmNsdWRlIDxzdHJpbmcuaD4KLQot
I2luY2x1ZGUgImxrYy5oIgotCi1zdGF0aWMgY2hhciAqZXNjYXBlKGNvbnN0IGNoYXIqIHRleHQs
IGNoYXIgKmJmLCBpbnQgbGVuKQotewotCWNoYXIgKmJmcCA9IGJmOwotCWludCBtdWx0aWxpbmUg
PSBzdHJjaHIodGV4dCwgJ1xuJykgIT0gTlVMTDsKLQlpbnQgZW9sID0gMDsKLQlpbnQgdGV4dGxl
biA9IHN0cmxlbih0ZXh0KTsKLQotCWlmICgodGV4dGxlbiA+IDApICYmICh0ZXh0W3RleHRsZW4t
MV0gPT0gJ1xuJykpCi0JCWVvbCA9IDE7Ci0KLQkqYmZwKysgPSAnIic7Ci0JLS1sZW47Ci0KLQlp
ZiAobXVsdGlsaW5lKSB7Ci0JCSpiZnArKyA9ICciJzsKLQkJKmJmcCsrID0gJ1xuJzsKLQkJKmJm
cCsrID0gJyInOwotCQlsZW4gLT0gMzsKLQl9Ci0KLQl3aGlsZSAoKnRleHQgIT0gJ1wwJyAmJiBs
ZW4gPiAxKSB7Ci0JCWlmICgqdGV4dCA9PSAnIicpCi0JCQkqYmZwKysgPSAnXFwnOwotCQllbHNl
IGlmICgqdGV4dCA9PSAnXG4nKSB7Ci0JCQkqYmZwKysgPSAnXFwnOwotCQkJKmJmcCsrID0gJ24n
OwotCQkJKmJmcCsrID0gJyInOwotCQkJKmJmcCsrID0gJ1xuJzsKLQkJCSpiZnArKyA9ICciJzsK
LQkJCWxlbiAtPSA1OwotCQkJKyt0ZXh0OwotCQkJZ290byBuZXh0OwotCQl9Ci0JCWVsc2UgaWYg
KCp0ZXh0ID09ICdcXCcpIHsKLQkJCSpiZnArKyA9ICdcXCc7Ci0JCQlsZW4tLTsKLQkJfQotCQkq
YmZwKysgPSAqdGV4dCsrOwotbmV4dDoKLQkJLS1sZW47Ci0JfQotCi0JaWYgKG11bHRpbGluZSAm
JiBlb2wpCi0JCWJmcCAtPSAzOwotCi0JKmJmcCsrID0gJyInOwotCSpiZnAgPSAnXDAnOwotCi0J
cmV0dXJuIGJmOwotfQotCi1zdHJ1Y3QgZmlsZV9saW5lIHsKLQlzdHJ1Y3QgZmlsZV9saW5lICpu
ZXh0OwotCWNvbnN0IGNoYXIgKmZpbGU7Ci0JaW50IGxpbmVubzsKLX07Ci0KLXN0YXRpYyBzdHJ1
Y3QgZmlsZV9saW5lICpmaWxlX2xpbmVfX25ldyhjb25zdCBjaGFyICpmaWxlLCBpbnQgbGluZW5v
KQotewotCXN0cnVjdCBmaWxlX2xpbmUgKnNlbGYgPSBtYWxsb2Moc2l6ZW9mKCpzZWxmKSk7Ci0K
LQlpZiAoc2VsZiA9PSBOVUxMKQotCQlnb3RvIG91dDsKLQotCXNlbGYtPmZpbGUgICA9IGZpbGU7
Ci0Jc2VsZi0+bGluZW5vID0gbGluZW5vOwotCXNlbGYtPm5leHQgICA9IE5VTEw7Ci1vdXQ6Ci0J
cmV0dXJuIHNlbGY7Ci19Ci0KLXN0cnVjdCBtZXNzYWdlIHsKLQljb25zdCBjaGFyCSAqbXNnOwot
CWNvbnN0IGNoYXIJICpvcHRpb247Ci0Jc3RydWN0IG1lc3NhZ2UJICpuZXh0OwotCXN0cnVjdCBm
aWxlX2xpbmUgKmZpbGVzOwotfTsKLQotc3RhdGljIHN0cnVjdCBtZXNzYWdlICptZXNzYWdlX19s
aXN0OwotCi1zdGF0aWMgc3RydWN0IG1lc3NhZ2UgKm1lc3NhZ2VfX25ldyhjb25zdCBjaGFyICpt
c2csIGNoYXIgKm9wdGlvbiwKLQkJCQkgICAgY29uc3QgY2hhciAqZmlsZSwgaW50IGxpbmVubykK
LXsKLQlzdHJ1Y3QgbWVzc2FnZSAqc2VsZiA9IG1hbGxvYyhzaXplb2YoKnNlbGYpKTsKLQotCWlm
IChzZWxmID09IE5VTEwpCi0JCWdvdG8gb3V0OwotCi0Jc2VsZi0+ZmlsZXMgPSBmaWxlX2xpbmVf
X25ldyhmaWxlLCBsaW5lbm8pOwotCWlmIChzZWxmLT5maWxlcyA9PSBOVUxMKQotCQlnb3RvIG91
dF9mYWlsOwotCi0Jc2VsZi0+bXNnID0gc3RyZHVwKG1zZyk7Ci0JaWYgKHNlbGYtPm1zZyA9PSBO
VUxMKQotCQlnb3RvIG91dF9mYWlsX21zZzsKLQotCXNlbGYtPm9wdGlvbiA9IG9wdGlvbjsKLQlz
ZWxmLT5uZXh0ID0gTlVMTDsKLW91dDoKLQlyZXR1cm4gc2VsZjsKLW91dF9mYWlsX21zZzoKLQlm
cmVlKHNlbGYtPmZpbGVzKTsKLW91dF9mYWlsOgotCWZyZWUoc2VsZik7Ci0Jc2VsZiA9IE5VTEw7
Ci0JZ290byBvdXQ7Ci19Ci0KLXN0YXRpYyBzdHJ1Y3QgbWVzc2FnZSAqbWVzYWdlX19maW5kKGNv
bnN0IGNoYXIgKm1zZykKLXsKLQlzdHJ1Y3QgbWVzc2FnZSAqbSA9IG1lc3NhZ2VfX2xpc3Q7Ci0K
LQl3aGlsZSAobSAhPSBOVUxMKSB7Ci0JCWlmIChzdHJjbXAobS0+bXNnLCBtc2cpID09IDApCi0J
CQlicmVhazsKLQkJbSA9IG0tPm5leHQ7Ci0JfQotCi0JcmV0dXJuIG07Ci19Ci0KLXN0YXRpYyBp
bnQgbWVzc2FnZV9fYWRkX2ZpbGVfbGluZShzdHJ1Y3QgbWVzc2FnZSAqc2VsZiwgY29uc3QgY2hh
ciAqZmlsZSwKLQkJCQkgIGludCBsaW5lbm8pCi17Ci0JaW50IHJjID0gLTE7Ci0Jc3RydWN0IGZp
bGVfbGluZSAqZmwgPSBmaWxlX2xpbmVfX25ldyhmaWxlLCBsaW5lbm8pOwotCi0JaWYgKGZsID09
IE5VTEwpCi0JCWdvdG8gb3V0OwotCi0JZmwtPm5leHQgICAgPSBzZWxmLT5maWxlczsKLQlzZWxm
LT5maWxlcyA9IGZsOwotCXJjID0gMDsKLW91dDoKLQlyZXR1cm4gcmM7Ci19Ci0KLXN0YXRpYyBp
bnQgbWVzc2FnZV9fYWRkKGNvbnN0IGNoYXIgKm1zZywgY2hhciAqb3B0aW9uLCBjb25zdCBjaGFy
ICpmaWxlLAotCQkJaW50IGxpbmVubykKLXsKLQlpbnQgcmMgPSAwOwotCWNoYXIgYmZbMTYzODRd
OwotCWNoYXIgKmVzY2FwZWQgPSBlc2NhcGUobXNnLCBiZiwgc2l6ZW9mKGJmKSk7Ci0Jc3RydWN0
IG1lc3NhZ2UgKm0gPSBtZXNhZ2VfX2ZpbmQoZXNjYXBlZCk7Ci0KLQlpZiAobSAhPSBOVUxMKQot
CQlyYyA9IG1lc3NhZ2VfX2FkZF9maWxlX2xpbmUobSwgZmlsZSwgbGluZW5vKTsKLQllbHNlIHsK
LQkJbSA9IG1lc3NhZ2VfX25ldyhlc2NhcGVkLCBvcHRpb24sIGZpbGUsIGxpbmVubyk7Ci0KLQkJ
aWYgKG0gIT0gTlVMTCkgewotCQkJbS0+bmV4dAkgICAgICA9IG1lc3NhZ2VfX2xpc3Q7Ci0JCQlt
ZXNzYWdlX19saXN0ID0gbTsKLQkJfSBlbHNlCi0JCQlyYyA9IC0xOwotCX0KLQlyZXR1cm4gcmM7
Ci19Ci0KLXN0YXRpYyB2b2lkIG1lbnVfYnVpbGRfbWVzc2FnZV9saXN0KHN0cnVjdCBtZW51ICpt
ZW51KQotewotCXN0cnVjdCBtZW51ICpjaGlsZDsKLQotCW1lc3NhZ2VfX2FkZChtZW51X2dldF9w
cm9tcHQobWVudSksIE5VTEwsCi0JCSAgICAgbWVudS0+ZmlsZSA9PSBOVUxMID8gIlJvb3QgTWVu
dSIgOiBtZW51LT5maWxlLT5uYW1lLAotCQkgICAgIG1lbnUtPmxpbmVubyk7Ci0KLQlpZiAobWVu
dS0+c3ltICE9IE5VTEwgJiYgbWVudV9oYXNfaGVscChtZW51KSkKLQkJbWVzc2FnZV9fYWRkKG1l
bnVfZ2V0X2hlbHAobWVudSksIG1lbnUtPnN5bS0+bmFtZSwKLQkJCSAgICAgbWVudS0+ZmlsZSA9
PSBOVUxMID8gIlJvb3QgTWVudSIgOiBtZW51LT5maWxlLT5uYW1lLAotCQkJICAgICBtZW51LT5s
aW5lbm8pOwotCi0JZm9yIChjaGlsZCA9IG1lbnUtPmxpc3Q7IGNoaWxkICE9IE5VTEw7IGNoaWxk
ID0gY2hpbGQtPm5leHQpCi0JCWlmIChjaGlsZC0+cHJvbXB0ICE9IE5VTEwpCi0JCQltZW51X2J1
aWxkX21lc3NhZ2VfbGlzdChjaGlsZCk7Ci19Ci0KLXN0YXRpYyB2b2lkIG1lc3NhZ2VfX3ByaW50
X2ZpbGVfbGluZW5vKHN0cnVjdCBtZXNzYWdlICpzZWxmKQotewotCXN0cnVjdCBmaWxlX2xpbmUg
KmZsID0gc2VsZi0+ZmlsZXM7Ci0KLQlwdXRjaGFyKCdcbicpOwotCWlmIChzZWxmLT5vcHRpb24g
IT0gTlVMTCkKLQkJcHJpbnRmKCIjICVzOjAwMDAwXG4iLCBzZWxmLT5vcHRpb24pOwotCi0JcHJp
bnRmKCIjOiAlczolZCIsIGZsLT5maWxlLCBmbC0+bGluZW5vKTsKLQlmbCA9IGZsLT5uZXh0Owot
Ci0Jd2hpbGUgKGZsICE9IE5VTEwpIHsKLQkJcHJpbnRmKCIsICVzOiVkIiwgZmwtPmZpbGUsIGZs
LT5saW5lbm8pOwotCQlmbCA9IGZsLT5uZXh0OwotCX0KLQotCXB1dGNoYXIoJ1xuJyk7Ci19Ci0K
LXN0YXRpYyB2b2lkIG1lc3NhZ2VfX3ByaW50X2dldHRleHRfbXNnaWRfbXNnc3RyKHN0cnVjdCBt
ZXNzYWdlICpzZWxmKQotewotCW1lc3NhZ2VfX3ByaW50X2ZpbGVfbGluZW5vKHNlbGYpOwotCi0J
cHJpbnRmKCJtc2dpZCAlc1xuIgotCSAgICAgICAibXNnc3RyIFwiXCJcbiIsIHNlbGYtPm1zZyk7
Ci19Ci0KLXN0YXRpYyB2b2lkIG1lbnVfX3hnZXR0ZXh0KHZvaWQpCi17Ci0Jc3RydWN0IG1lc3Nh
Z2UgKm0gPSBtZXNzYWdlX19saXN0OwotCi0Jd2hpbGUgKG0gIT0gTlVMTCkgewotCQkvKiBza2lw
IGVtcHR5IGxpbmVzICgiIikgKi8KLQkJaWYgKHN0cmxlbihtLT5tc2cpID4gc2l6ZW9mKCJcIlwi
IikpCi0JCQltZXNzYWdlX19wcmludF9nZXR0ZXh0X21zZ2lkX21zZ3N0cihtKTsKLQkJbSA9IG0t
Pm5leHQ7Ci0JfQotfQotCi1pbnQgbWFpbihpbnQgYWMsIGNoYXIgKiphdikKLXsKLQljb25mX3Bh
cnNlKGF2WzFdKTsKLQotCW1lbnVfYnVpbGRfbWVzc2FnZV9saXN0KG1lbnVfZ2V0X3Jvb3RfbWVu
dShOVUxMKSk7Ci0JbWVudV9feGdldHRleHQoKTsKLQlyZXR1cm4gMDsKLX0KZGlmZiAtLWdpdCBh
L3hlbi90b29scy9rY29uZmlnL2xrYy5oIGIveGVuL3Rvb2xzL2tjb25maWcvbGtjLmgKaW5kZXgg
OTFjYTEyNmVhMC4uYmJjODUwY2VlMSAxMDA2NDQKLS0tIGEveGVuL3Rvb2xzL2tjb25maWcvbGtj
LmgKKysrIGIveGVuL3Rvb2xzL2tjb25maWcvbGtjLmgKQEAgLTgsMTUgKzgsNiBAQAogCiAjaW5j
bHVkZSAiZXhwci5oIgogCi0jaWZuZGVmIEtCVUlMRF9OT19OTFMKLSMgaW5jbHVkZSA8bGliaW50
bC5oPgotI2Vsc2UKLXN0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqZ2V0dGV4dChjb25zdCBjaGFy
ICp0eHQpIHsgcmV0dXJuIHR4dDsgfQotc3RhdGljIGlubGluZSB2b2lkIHRleHRkb21haW4oY29u
c3QgY2hhciAqZG9tYWlubmFtZSkge30KLXN0YXRpYyBpbmxpbmUgdm9pZCBiaW5kdGV4dGRvbWFp
bihjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFyICpkaXIpIHt9Ci1zdGF0aWMgaW5saW5lIGNo
YXIgKmJpbmRfdGV4dGRvbWFpbl9jb2Rlc2V0KGNvbnN0IGNoYXIgKmRuLCBjaGFyICpjKSB7IHJl
dHVybiBjOyB9Ci0jZW5kaWYKLQogI2lmZGVmIF9fY3BsdXNwbHVzCiBleHRlcm4gIkMiIHsKICNl
bmRpZgpAQCAtMjksMTEgKzIwLDYgQEAgZXh0ZXJuICJDIiB7CiAjZGVmaW5lIFBBQ0tBR0UgImxp
bnV4IgogI2VuZGlmCiAKLSNkZWZpbmUgTE9DQUxFRElSICIvdXNyL3NoYXJlL2xvY2FsZSIKLQot
I2RlZmluZSBfKHRleHQpIGdldHRleHQodGV4dCkKLSNkZWZpbmUgTl8odGV4dCkgKHRleHQpCi0K
ICNpZm5kZWYgQ09ORklHXwogI2RlZmluZSBDT05GSUdfICJDT05GSUdfIgogI2VuZGlmCmRpZmYg
LS1naXQgYS94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy9jaGVja2xpc3QuYyBiL3hlbi90b29s
cy9rY29uZmlnL2x4ZGlhbG9nL2NoZWNrbGlzdC5jCmluZGV4IDhkMDE2ZmFhMjguLjJlOTYzMjNh
ZDEgMTAwNjQ0Ci0tLSBhL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL2NoZWNrbGlzdC5jCisr
KyBiL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL2NoZWNrbGlzdC5jCkBAIC0xMDMsOCArMTAz
LDggQEAgc3RhdGljIHZvaWQgcHJpbnRfYnV0dG9ucyhXSU5ET1cgKiBkaWFsb2csIGludCBoZWln
aHQsIGludCB3aWR0aCwgaW50IHNlbGVjdGVkKQogCWludCB4ID0gd2lkdGggLyAyIC0gMTE7CiAJ
aW50IHkgPSBoZWlnaHQgLSAyOwogCi0JcHJpbnRfYnV0dG9uKGRpYWxvZywgZ2V0dGV4dCgiU2Vs
ZWN0IiksIHksIHgsIHNlbGVjdGVkID09IDApOwotCXByaW50X2J1dHRvbihkaWFsb2csIGdldHRl
eHQoIiBIZWxwICIpLCB5LCB4ICsgMTQsIHNlbGVjdGVkID09IDEpOworCXByaW50X2J1dHRvbihk
aWFsb2csICJTZWxlY3QiLCB5LCB4LCBzZWxlY3RlZCA9PSAwKTsKKwlwcmludF9idXR0b24oZGlh
bG9nLCAiIEhlbHAgIiwgeSwgeCArIDE0LCBzZWxlY3RlZCA9PSAxKTsKIAogCXdtb3ZlKGRpYWxv
ZywgeSwgeCArIDEgKyAxNCAqIHNlbGVjdGVkKTsKIAl3cmVmcmVzaChkaWFsb2cpOwpkaWZmIC0t
Z2l0IGEveGVuL3Rvb2xzL2tjb25maWcvbHhkaWFsb2cvZGlhbG9nLmggYi94ZW4vdG9vbHMva2Nv
bmZpZy9seGRpYWxvZy9kaWFsb2cuaAppbmRleCBmY2ZmZDViNDFmLi5jYzIyZTVhOTBlIDEwMDY0
NAotLS0gYS94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy9kaWFsb2cuaAorKysgYi94ZW4vdG9v
bHMva2NvbmZpZy9seGRpYWxvZy9kaWFsb2cuaApAQCAtMjYsMTIgKzI2LDYgQEAKICNpbmNsdWRl
IDxzdHJpbmcuaD4KICNpbmNsdWRlIDxzdGRib29sLmg+CiAKLSNpZm5kZWYgS0JVSUxEX05PX05M
UwotIyBpbmNsdWRlIDxsaWJpbnRsLmg+Ci0jZWxzZQotIyBkZWZpbmUgZ2V0dGV4dChNc2dpZCkg
KChjb25zdCBjaGFyICopIChNc2dpZCkpCi0jZW5kaWYKLQogI2lmZGVmIF9fc3VuX18KICNkZWZp
bmUgQ1VSU19NQUNST1MKICNlbmRpZgpkaWZmIC0tZ2l0IGEveGVuL3Rvb2xzL2tjb25maWcvbHhk
aWFsb2cvaW5wdXRib3guYyBiL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL2lucHV0Ym94LmMK
aW5kZXggZDU4ZGUxZGM1My4uZmU4MmZmNmQ3NCAxMDA2NDQKLS0tIGEveGVuL3Rvb2xzL2tjb25m
aWcvbHhkaWFsb2cvaW5wdXRib3guYworKysgYi94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy9p
bnB1dGJveC5jCkBAIC0zMSw4ICszMSw4IEBAIHN0YXRpYyB2b2lkIHByaW50X2J1dHRvbnMoV0lO
RE9XICogZGlhbG9nLCBpbnQgaGVpZ2h0LCBpbnQgd2lkdGgsIGludCBzZWxlY3RlZCkKIAlpbnQg
eCA9IHdpZHRoIC8gMiAtIDExOwogCWludCB5ID0gaGVpZ2h0IC0gMjsKIAotCXByaW50X2J1dHRv
bihkaWFsb2csIGdldHRleHQoIiAgT2sgICIpLCB5LCB4LCBzZWxlY3RlZCA9PSAwKTsKLQlwcmlu
dF9idXR0b24oZGlhbG9nLCBnZXR0ZXh0KCIgSGVscCAiKSwgeSwgeCArIDE0LCBzZWxlY3RlZCA9
PSAxKTsKKwlwcmludF9idXR0b24oZGlhbG9nLCAiICBPayAgIiwgeSwgeCwgc2VsZWN0ZWQgPT0g
MCk7CisJcHJpbnRfYnV0dG9uKGRpYWxvZywgIiBIZWxwICIsIHksIHggKyAxNCwgc2VsZWN0ZWQg
PT0gMSk7CiAKIAl3bW92ZShkaWFsb2csIHksIHggKyAxICsgMTQgKiBzZWxlY3RlZCk7CiAJd3Jl
ZnJlc2goZGlhbG9nKTsKZGlmZiAtLWdpdCBhL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL21l
bnVib3guYyBiL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL21lbnVib3guYwppbmRleCAxMWFl
OWFkN2FjLi5kNzBjYWIzNjEzIDEwMDY0NAotLS0gYS94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxv
Zy9tZW51Ym94LmMKKysrIGIveGVuL3Rvb2xzL2tjb25maWcvbHhkaWFsb2cvbWVudWJveC5jCkBA
IC0xNTcsMTEgKzE1NywxMSBAQCBzdGF0aWMgdm9pZCBwcmludF9idXR0b25zKFdJTkRPVyAqIHdp
biwgaW50IGhlaWdodCwgaW50IHdpZHRoLCBpbnQgc2VsZWN0ZWQpCiAJaW50IHggPSB3aWR0aCAv
IDIgLSAyODsKIAlpbnQgeSA9IGhlaWdodCAtIDI7CiAKLQlwcmludF9idXR0b24od2luLCBnZXR0
ZXh0KCJTZWxlY3QiKSwgeSwgeCwgc2VsZWN0ZWQgPT0gMCk7Ci0JcHJpbnRfYnV0dG9uKHdpbiwg
Z2V0dGV4dCgiIEV4aXQgIiksIHksIHggKyAxMiwgc2VsZWN0ZWQgPT0gMSk7Ci0JcHJpbnRfYnV0
dG9uKHdpbiwgZ2V0dGV4dCgiIEhlbHAgIiksIHksIHggKyAyNCwgc2VsZWN0ZWQgPT0gMik7Ci0J
cHJpbnRfYnV0dG9uKHdpbiwgZ2V0dGV4dCgiIFNhdmUgIiksIHksIHggKyAzNiwgc2VsZWN0ZWQg
PT0gMyk7Ci0JcHJpbnRfYnV0dG9uKHdpbiwgZ2V0dGV4dCgiIExvYWQgIiksIHksIHggKyA0OCwg
c2VsZWN0ZWQgPT0gNCk7CisJcHJpbnRfYnV0dG9uKHdpbiwgIlNlbGVjdCIsIHksIHgsIHNlbGVj
dGVkID09IDApOworCXByaW50X2J1dHRvbih3aW4sICIgRXhpdCAiLCB5LCB4ICsgMTIsIHNlbGVj
dGVkID09IDEpOworCXByaW50X2J1dHRvbih3aW4sICIgSGVscCAiLCB5LCB4ICsgMjQsIHNlbGVj
dGVkID09IDIpOworCXByaW50X2J1dHRvbih3aW4sICIgU2F2ZSAiLCB5LCB4ICsgMzYsIHNlbGVj
dGVkID09IDMpOworCXByaW50X2J1dHRvbih3aW4sICIgTG9hZCAiLCB5LCB4ICsgNDgsIHNlbGVj
dGVkID09IDQpOwogCiAJd21vdmUod2luLCB5LCB4ICsgMSArIDEyICogc2VsZWN0ZWQpOwogCXdy
ZWZyZXNoKHdpbik7CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy90ZXh0
Ym94LmMgYi94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy90ZXh0Ym94LmMKaW5kZXggMTc3MzMx
OWI5NS4uODhkMjgxOGVkOSAxMDA2NDQKLS0tIGEveGVuL3Rvb2xzL2tjb25maWcvbHhkaWFsb2cv
dGV4dGJveC5jCisrKyBiL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL3RleHRib3guYwpAQCAt
MTI5LDcgKzEyOSw3IEBAIGludCBkaWFsb2dfdGV4dGJveChjb25zdCBjaGFyICp0aXRsZSwgY2hh
ciAqdGJ1ZiwgaW50IGluaXRpYWxfaGVpZ2h0LAogCiAJcHJpbnRfdGl0bGUoZGlhbG9nLCB0aXRs
ZSwgd2lkdGgpOwogCi0JcHJpbnRfYnV0dG9uKGRpYWxvZywgZ2V0dGV4dCgiIEV4aXQgIiksIGhl
aWdodCAtIDIsIHdpZHRoIC8gMiAtIDQsIFRSVUUpOworCXByaW50X2J1dHRvbihkaWFsb2csICIg
RXhpdCAiLCBoZWlnaHQgLSAyLCB3aWR0aCAvIDIgLSA0LCBUUlVFKTsKIAl3bm91dHJlZnJlc2go
ZGlhbG9nKTsKIAlnZXR5eChkaWFsb2csIGN1cl95LCBjdXJfeCk7CS8qIFNhdmUgY3Vyc29yIHBv
c2l0aW9uICovCiAKZGlmZiAtLWdpdCBhL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL3llc25v
LmMgYi94ZW4vdG9vbHMva2NvbmZpZy9seGRpYWxvZy95ZXNuby5jCmluZGV4IDY3NmZiMmY4MjQu
LmNkMTIyM2M5MDMgMTAwNjQ0Ci0tLSBhL3hlbi90b29scy9rY29uZmlnL2x4ZGlhbG9nL3llc25v
LmMKKysrIGIveGVuL3Rvb2xzL2tjb25maWcvbHhkaWFsb2cveWVzbm8uYwpAQCAtMjksOCArMjks
OCBAQCBzdGF0aWMgdm9pZCBwcmludF9idXR0b25zKFdJTkRPVyAqIGRpYWxvZywgaW50IGhlaWdo
dCwgaW50IHdpZHRoLCBpbnQgc2VsZWN0ZWQpCiAJaW50IHggPSB3aWR0aCAvIDIgLSAxMDsKIAlp
bnQgeSA9IGhlaWdodCAtIDI7CiAKLQlwcmludF9idXR0b24oZGlhbG9nLCBnZXR0ZXh0KCIgWWVz
ICIpLCB5LCB4LCBzZWxlY3RlZCA9PSAwKTsKLQlwcmludF9idXR0b24oZGlhbG9nLCBnZXR0ZXh0
KCIgIE5vICAiKSwgeSwgeCArIDEzLCBzZWxlY3RlZCA9PSAxKTsKKwlwcmludF9idXR0b24oZGlh
bG9nLCAiIFllcyAiLCB5LCB4LCBzZWxlY3RlZCA9PSAwKTsKKwlwcmludF9idXR0b24oZGlhbG9n
LCAiICBObyAgIiwgeSwgeCArIDEzLCBzZWxlY3RlZCA9PSAxKTsKIAogCXdtb3ZlKGRpYWxvZywg
eSwgeCArIDEgKyAxMyAqIHNlbGVjdGVkKTsKIAl3cmVmcmVzaChkaWFsb2cpOwpkaWZmIC0tZ2l0
IGEveGVuL3Rvb2xzL2tjb25maWcvbWNvbmYuYyBiL3hlbi90b29scy9rY29uZmlnL21jb25mLmMK
aW5kZXggMzE1Y2UyYzdjYi4uMjQ4OWFmNjBiOSAxMDA2NDQKLS0tIGEveGVuL3Rvb2xzL2tjb25m
aWcvbWNvbmYuYworKysgYi94ZW4vdG9vbHMva2NvbmZpZy9tY29uZi5jCkBAIC0xNywxMiArMTcs
MTEgQEAKICNpbmNsdWRlIDxzdHJpbmcuaD4KICNpbmNsdWRlIDxzaWduYWwuaD4KICNpbmNsdWRl
IDx1bmlzdGQuaD4KLSNpbmNsdWRlIDxsb2NhbGUuaD4KIAogI2luY2x1ZGUgImxrYy5oIgogI2lu
Y2x1ZGUgImx4ZGlhbG9nL2RpYWxvZy5oIgogCi1zdGF0aWMgY29uc3QgY2hhciBtY29uZl9yZWFk
bWVbXSA9IE5fKAorc3RhdGljIGNvbnN0IGNoYXIgbWNvbmZfcmVhZG1lW10gPQogIk92ZXJ2aWV3
XG4iCiAiLS0tLS0tLS1cbiIKICJUaGlzIGludGVyZmFjZSBsZXRzIHlvdSBzZWxlY3QgZmVhdHVy
ZXMgYW5kIHBhcmFtZXRlcnMgZm9yIHRoZSBidWlsZC5cbiIKQEAgLTE3MSwzNyArMTcwLDM3IEBA
IHN0YXRpYyBjb25zdCBjaGFyIG1jb25mX3JlYWRtZVtdID0gTl8oCiAiIGJsYWNrYmcgICAgPT4g
c2VsZWN0cyBhIGNvbG9yIHNjaGVtZSB3aXRoIGJsYWNrIGJhY2tncm91bmRcbiIKICIgY2xhc3Np
YyAgICA9PiB0aGVtZSB3aXRoIGJsdWUgYmFja2dyb3VuZC4gVGhlIGNsYXNzaWMgbG9va1xuIgog
IiBibHVldGl0bGUgID0+IGFuIExDRCBmcmllbmRseSB2ZXJzaW9uIG9mIGNsYXNzaWMuIChkZWZh
dWx0KVxuIgotIlxuIiksCi1tZW51X2luc3RydWN0aW9uc1tdID0gTl8oCisiXG4iLAorbWVudV9p
bnN0cnVjdGlvbnNbXSA9CiAJIkFycm93IGtleXMgbmF2aWdhdGUgdGhlIG1lbnUuICAiCiAJIjxF
bnRlcj4gc2VsZWN0cyBzdWJtZW51cyAtLS0+IChvciBlbXB0eSBzdWJtZW51cyAtLS0tKS4gICIK
IAkiSGlnaGxpZ2h0ZWQgbGV0dGVycyBhcmUgaG90a2V5cy4gICIKIAkiUHJlc3NpbmcgPFk+IGlu
Y2x1ZGVzLCA8Tj4gZXhjbHVkZXMsIDxNPiBtb2R1bGFyaXplcyBmZWF0dXJlcy4gICIKIAkiUHJl
c3MgPEVzYz48RXNjPiB0byBleGl0LCA8Pz4gZm9yIEhlbHAsIDwvPiBmb3IgU2VhcmNoLiAgIgot
CSJMZWdlbmQ6IFsqXSBidWlsdC1pbiAgWyBdIGV4Y2x1ZGVkICA8TT4gbW9kdWxlICA8ID4gbW9k
dWxlIGNhcGFibGUiKSwKLXJhZGlvbGlzdF9pbnN0cnVjdGlvbnNbXSA9IE5fKAorCSJMZWdlbmQ6
IFsqXSBidWlsdC1pbiAgWyBdIGV4Y2x1ZGVkICA8TT4gbW9kdWxlICA8ID4gbW9kdWxlIGNhcGFi
bGUiLAorcmFkaW9saXN0X2luc3RydWN0aW9uc1tdID0KIAkiVXNlIHRoZSBhcnJvdyBrZXlzIHRv
IG5hdmlnYXRlIHRoaXMgd2luZG93IG9yICIKIAkicHJlc3MgdGhlIGhvdGtleSBvZiB0aGUgaXRl
bSB5b3Ugd2lzaCB0byBzZWxlY3QgIgogCSJmb2xsb3dlZCBieSB0aGUgPFNQQUNFIEJBUj4uICIK
LQkiUHJlc3MgPD8+IGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIGFib3V0IHRoaXMgb3B0aW9u
LiIpLAotaW5wdXRib3hfaW5zdHJ1Y3Rpb25zX2ludFtdID0gTl8oCisJIlByZXNzIDw/PiBmb3Ig
YWRkaXRpb25hbCBpbmZvcm1hdGlvbiBhYm91dCB0aGlzIG9wdGlvbi4iLAoraW5wdXRib3hfaW5z
dHJ1Y3Rpb25zX2ludFtdID0KIAkiUGxlYXNlIGVudGVyIGEgZGVjaW1hbCB2YWx1ZS4gIgogCSJG
cmFjdGlvbnMgd2lsbCBub3QgYmUgYWNjZXB0ZWQuICAiCi0JIlVzZSB0aGUgPFRBQj4ga2V5IHRv
IG1vdmUgZnJvbSB0aGUgaW5wdXQgZmllbGQgdG8gdGhlIGJ1dHRvbnMgYmVsb3cgaXQuIiksCi1p
bnB1dGJveF9pbnN0cnVjdGlvbnNfaGV4W10gPSBOXygKKwkiVXNlIHRoZSA8VEFCPiBrZXkgdG8g
bW92ZSBmcm9tIHRoZSBpbnB1dCBmaWVsZCB0byB0aGUgYnV0dG9ucyBiZWxvdyBpdC4iLAoraW5w
dXRib3hfaW5zdHJ1Y3Rpb25zX2hleFtdID0KIAkiUGxlYXNlIGVudGVyIGEgaGV4YWRlY2ltYWwg
dmFsdWUuICIKLQkiVXNlIHRoZSA8VEFCPiBrZXkgdG8gbW92ZSBmcm9tIHRoZSBpbnB1dCBmaWVs
ZCB0byB0aGUgYnV0dG9ucyBiZWxvdyBpdC4iKSwKLWlucHV0Ym94X2luc3RydWN0aW9uc19zdHJp
bmdbXSA9IE5fKAorCSJVc2UgdGhlIDxUQUI+IGtleSB0byBtb3ZlIGZyb20gdGhlIGlucHV0IGZp
ZWxkIHRvIHRoZSBidXR0b25zIGJlbG93IGl0LiIsCitpbnB1dGJveF9pbnN0cnVjdGlvbnNfc3Ry
aW5nW10gPQogCSJQbGVhc2UgZW50ZXIgYSBzdHJpbmcgdmFsdWUuICIKLQkiVXNlIHRoZSA8VEFC
PiBrZXkgdG8gbW92ZSBmcm9tIHRoZSBpbnB1dCBmaWVsZCB0byB0aGUgYnV0dG9ucyBiZWxvdyBp
dC4iKSwKLXNldG1vZF90ZXh0W10gPSBOXygKKwkiVXNlIHRoZSA8VEFCPiBrZXkgdG8gbW92ZSBm
cm9tIHRoZSBpbnB1dCBmaWVsZCB0byB0aGUgYnV0dG9ucyBiZWxvdyBpdC4iLAorc2V0bW9kX3Rl
eHRbXSA9CiAJIlRoaXMgZmVhdHVyZSBkZXBlbmRzIG9uIGFub3RoZXIgd2hpY2ggaGFzIGJlZW4g
Y29uZmlndXJlZCBhcyBhIG1vZHVsZS5cbiIKLQkiQXMgYSByZXN1bHQsIHRoaXMgZmVhdHVyZSB3
aWxsIGJlIGJ1aWx0IGFzIGEgbW9kdWxlLiIpLAotbG9hZF9jb25maWdfdGV4dFtdID0gTl8oCisJ
IkFzIGEgcmVzdWx0LCB0aGlzIGZlYXR1cmUgd2lsbCBiZSBidWlsdCBhcyBhIG1vZHVsZS4iLAor
bG9hZF9jb25maWdfdGV4dFtdID0KIAkiRW50ZXIgdGhlIG5hbWUgb2YgdGhlIGNvbmZpZ3VyYXRp
b24gZmlsZSB5b3Ugd2lzaCB0byBsb2FkLiAgIgogCSJBY2NlcHQgdGhlIG5hbWUgc2hvd24gdG8g
cmVzdG9yZSB0aGUgY29uZmlndXJhdGlvbiB5b3UgIgotCSJsYXN0IHJldHJpZXZlZC4gIExlYXZl
IGJsYW5rIHRvIGFib3J0LiIpLAotbG9hZF9jb25maWdfaGVscFtdID0gTl8oCisJImxhc3QgcmV0
cmlldmVkLiAgTGVhdmUgYmxhbmsgdG8gYWJvcnQuIiwKK2xvYWRfY29uZmlnX2hlbHBbXSA9CiAJ
IlxuIgogCSJGb3IgdmFyaW91cyByZWFzb25zLCBvbmUgbWF5IHdpc2ggdG8ga2VlcCBzZXZlcmFs
IGRpZmZlcmVudFxuIgogCSJjb25maWd1cmF0aW9ucyBhdmFpbGFibGUgb24gYSBzaW5nbGUgbWFj
aGluZS5cbiIKQEAgLTIxMSwxMSArMjEwLDExIEBAIGxvYWRfY29uZmlnX2hlbHBbXSA9IE5fKAog
CSJjb25maWd1cmF0aW9uLlxuIgogCSJcbiIKIAkiSWYgeW91IGFyZSB1bmNlcnRhaW4sIHRoZW4g
eW91IGhhdmUgcHJvYmFibHkgbmV2ZXIgdXNlZCBhbHRlcm5hdGVcbiIKLQkiY29uZmlndXJhdGlv
biBmaWxlcy4gWW91IHNob3VsZCB0aGVyZWZvcmUgbGVhdmUgdGhpcyBibGFuayB0byBhYm9ydC5c
biIpLAotc2F2ZV9jb25maWdfdGV4dFtdID0gTl8oCisJImNvbmZpZ3VyYXRpb24gZmlsZXMuIFlv
dSBzaG91bGQgdGhlcmVmb3JlIGxlYXZlIHRoaXMgYmxhbmsgdG8gYWJvcnQuXG4iLAorc2F2ZV9j
b25maWdfdGV4dFtdID0KIAkiRW50ZXIgYSBmaWxlbmFtZSB0byB3aGljaCB0aGlzIGNvbmZpZ3Vy
YXRpb24gc2hvdWxkIGJlIHNhdmVkICIKLQkiYXMgYW4gYWx0ZXJuYXRlLiAgTGVhdmUgYmxhbmsg
dG8gYWJvcnQuIiksCi1zYXZlX2NvbmZpZ19oZWxwW10gPSBOXygKKwkiYXMgYW4gYWx0ZXJuYXRl
LiAgTGVhdmUgYmxhbmsgdG8gYWJvcnQuIiwKK3NhdmVfY29uZmlnX2hlbHBbXSA9CiAJIlxuIgog
CSJGb3IgdmFyaW91cyByZWFzb25zLCBvbmUgbWF5IHdpc2ggdG8ga2VlcCBkaWZmZXJlbnQgY29u
ZmlndXJhdGlvbnNcbiIKIAkiYXZhaWxhYmxlIG9uIGEgc2luZ2xlIG1hY2hpbmUuXG4iCkBAIC0y
MjUsOCArMjI0LDggQEAgc2F2ZV9jb25maWdfaGVscFtdID0gTl8oCiAJImNvbmZpZ3VyYXRpb24g
b3B0aW9ucyB5b3UgaGF2ZSBzZWxlY3RlZCBhdCB0aGF0IHRpbWUuXG4iCiAJIlxuIgogCSJJZiB5
b3UgYXJlIHVuY2VydGFpbiB3aGF0IGFsbCB0aGlzIG1lYW5zIHRoZW4geW91IHNob3VsZCBwcm9i
YWJseVxuIgotCSJsZWF2ZSB0aGlzIGJsYW5rLlxuIiksCi1zZWFyY2hfaGVscFtdID0gTl8oCisJ
ImxlYXZlIHRoaXMgYmxhbmsuXG4iLAorc2VhcmNoX2hlbHBbXSA9CiAJIlxuIgogCSJTZWFyY2gg
Zm9yIHN5bWJvbHMgYW5kIGRpc3BsYXkgdGhlaXIgcmVsYXRpb25zLlxuIgogCSJSZWd1bGFyIGV4
cHJlc3Npb25zIGFyZSBhbGxvd2VkLlxuIgpAQCAtMjcxLDcgKzI3MCw3IEBAIHNlYXJjaF9oZWxw
W10gPSBOXygKIAkiRXhhbXBsZXM6IFVTQgk9PiBmaW5kIGFsbCBzeW1ib2xzIGNvbnRhaW5pbmcg
VVNCXG4iCiAJIiAgICAgICAgICBeVVNCID0+IGZpbmQgYWxsIHN5bWJvbHMgc3RhcnRpbmcgd2l0
aCBVU0JcbiIKIAkiICAgICAgICAgIFVTQiQgPT4gZmluZCBhbGwgc3ltYm9scyBlbmRpbmcgd2l0
aCBVU0JcbiIKLQkiXG4iKTsKKwkiXG4iOwogCiBzdGF0aWMgaW50IGluZGVudDsKIHN0YXRpYyBz
dHJ1Y3QgbWVudSAqY3VycmVudF9tZW51OwpAQCAtNDAwLDE5ICszOTksMTkgQEAgc3RhdGljIHZv
aWQgc2VhcmNoX2NvbmYodm9pZCkKIAlzdHJ1Y3Qgc3VidGl0bGVfcGFydCBzdHBhcnQ7CiAKIAl0
aXRsZSA9IHN0cl9uZXcoKTsKLQlzdHJfcHJpbnRmKCAmdGl0bGUsIF8oIkVudGVyIChzdWIpc3Ry
aW5nIG9yIHJlZ2V4cCB0byBzZWFyY2ggZm9yICIKLQkJCSAgICAgICIod2l0aCBvciB3aXRob3V0
IFwiJXNcIikiKSwgQ09ORklHXyk7CisJc3RyX3ByaW50ZiggJnRpdGxlLCAiRW50ZXIgKHN1Yilz
dHJpbmcgb3IgcmVnZXhwIHRvIHNlYXJjaCBmb3IgIgorCQkJICAgICAgIih3aXRoIG9yIHdpdGhv
dXQgXCIlc1wiKSIsIENPTkZJR18pOwogCiBhZ2FpbjoKIAlkaWFsb2dfY2xlYXIoKTsKLQlkcmVz
ID0gZGlhbG9nX2lucHV0Ym94KF8oIlNlYXJjaCBDb25maWd1cmF0aW9uIFBhcmFtZXRlciIpLAor
CWRyZXMgPSBkaWFsb2dfaW5wdXRib3goIlNlYXJjaCBDb25maWd1cmF0aW9uIFBhcmFtZXRlciIs
CiAJCQkgICAgICBzdHJfZ2V0KCZ0aXRsZSksCiAJCQkgICAgICAxMCwgNzUsICIiKTsKIAlzd2l0
Y2ggKGRyZXMpIHsKIAljYXNlIDA6CiAJCWJyZWFrOwogCWNhc2UgMToKLQkJc2hvd19oZWxwdGV4
dChfKCJTZWFyY2ggQ29uZmlndXJhdGlvbiIpLCBzZWFyY2hfaGVscCk7CisJCXNob3dfaGVscHRl
eHQoIlNlYXJjaCBDb25maWd1cmF0aW9uIiwgc2VhcmNoX2hlbHApOwogCQlnb3RvIGFnYWluOwog
CWRlZmF1bHQ6CiAJCXN0cl9mcmVlKCZ0aXRsZSk7CkBAIC00NDMsNyArNDQyLDcgQEAgc3RhdGlj
IHZvaWQgc2VhcmNoX2NvbmYodm9pZCkKIAogCQlyZXMgPSBnZXRfcmVsYXRpb25zX3N0cihzeW1f
YXJyLCAmaGVhZCk7CiAJCXNldF9zdWJ0aXRsZSgpOwotCQlkcmVzID0gc2hvd190ZXh0Ym94X2V4
dChfKCJTZWFyY2ggUmVzdWx0cyIpLCAoY2hhciAqKQorCQlkcmVzID0gc2hvd190ZXh0Ym94X2V4
dCgiU2VhcmNoIFJlc3VsdHMiLCAoY2hhciAqKQogCQkJCQlzdHJfZ2V0KCZyZXMpLCAwLCAwLCBr
ZXlzLCAmdnNjcm9sbCwKIAkJCQkJJmhzY3JvbGwsICZ1cGRhdGVfdGV4dCwgKHZvaWQgKikKIAkJ
CQkJJmRhdGEpOwpAQCAtNDkxLDcgKzQ5MCw3IEBAIHN0YXRpYyB2b2lkIGJ1aWxkX2NvbmYoc3Ry
dWN0IG1lbnUgKm1lbnUpCiAJCQlzd2l0Y2ggKHByb3AtPnR5cGUpIHsKIAkJCWNhc2UgUF9NRU5V
OgogCQkJCWNoaWxkX2NvdW50Kys7Ci0JCQkJcHJvbXB0ID0gXyhwcm9tcHQpOworCQkJCXByb21w
dCA9IHByb21wdDsKIAkJCQlpZiAoc2luZ2xlX21lbnVfbW9kZSkgewogCQkJCQlpdGVtX21ha2Uo
IiVzJSpjJXMiLAogCQkJCQkJICBtZW51LT5kYXRhID8gIi0tPiIgOiAiKys+IiwKQEAgLTUwOCw3
ICs1MDcsNyBAQCBzdGF0aWMgdm9pZCBidWlsZF9jb25mKHN0cnVjdCBtZW51ICptZW51KQogCQkJ
Y2FzZSBQX0NPTU1FTlQ6CiAJCQkJaWYgKHByb21wdCkgewogCQkJCQljaGlsZF9jb3VudCsrOwot
CQkJCQlpdGVtX21ha2UoIiAgICUqYyoqKiAlcyAqKioiLCBpbmRlbnQgKyAxLCAnICcsIF8ocHJv
bXB0KSk7CisJCQkJCWl0ZW1fbWFrZSgiICAgJSpjKioqICVzICoqKiIsIGluZGVudCArIDEsICcg
JywgcHJvbXB0KTsKIAkJCQkJaXRlbV9zZXRfdGFnKCc6Jyk7CiAJCQkJCWl0ZW1fc2V0X2RhdGEo
bWVudSk7CiAJCQkJfQpAQCAtNTE2LDcgKzUxNSw3IEBAIHN0YXRpYyB2b2lkIGJ1aWxkX2NvbmYo
c3RydWN0IG1lbnUgKm1lbnUpCiAJCQlkZWZhdWx0OgogCQkJCWlmIChwcm9tcHQpIHsKIAkJCQkJ
Y2hpbGRfY291bnQrKzsKLQkJCQkJaXRlbV9tYWtlKCItLS0lKmMlcyIsIGluZGVudCArIDEsICcg
JywgXyhwcm9tcHQpKTsKKwkJCQkJaXRlbV9tYWtlKCItLS0lKmMlcyIsIGluZGVudCArIDEsICcg
JywgcHJvbXB0KTsKIAkJCQkJaXRlbV9zZXRfdGFnKCc6Jyk7CiAJCQkJCWl0ZW1fc2V0X2RhdGEo
bWVudSk7CiAJCQkJfQpAQCAtNTYwLDEwICs1NTksMTAgQEAgc3RhdGljIHZvaWQgYnVpbGRfY29u
ZihzdHJ1Y3QgbWVudSAqbWVudSkKIAkJCWl0ZW1fc2V0X2RhdGEobWVudSk7CiAJCX0KIAotCQlp
dGVtX2FkZF9zdHIoIiUqYyVzIiwgaW5kZW50ICsgMSwgJyAnLCBfKG1lbnVfZ2V0X3Byb21wdCht
ZW51KSkpOworCQlpdGVtX2FkZF9zdHIoIiUqYyVzIiwgaW5kZW50ICsgMSwgJyAnLCBtZW51X2dl
dF9wcm9tcHQobWVudSkpOwogCQlpZiAodmFsID09IHllcykgewogCQkJaWYgKGRlZl9tZW51KSB7
Ci0JCQkJaXRlbV9hZGRfc3RyKCIgKCVzKSIsIF8obWVudV9nZXRfcHJvbXB0KGRlZl9tZW51KSkp
OworCQkJCWl0ZW1fYWRkX3N0cigiICglcykiLCBtZW51X2dldF9wcm9tcHQoZGVmX21lbnUpKTsK
IAkJCQlpdGVtX2FkZF9zdHIoIiAgLS0tPiIpOwogCQkJCWlmIChkZWZfbWVudS0+bGlzdCkgewog
CQkJCQlpbmRlbnQgKz0gMjsKQEAgLTU3NSw3ICs1NzQsNyBAQCBzdGF0aWMgdm9pZCBidWlsZF9j
b25mKHN0cnVjdCBtZW51ICptZW51KQogCQl9CiAJfSBlbHNlIHsKIAkJaWYgKG1lbnUgPT0gY3Vy
cmVudF9tZW51KSB7Ci0JCQlpdGVtX21ha2UoIi0tLSUqYyVzIiwgaW5kZW50ICsgMSwgJyAnLCBf
KG1lbnVfZ2V0X3Byb21wdChtZW51KSkpOworCQkJaXRlbV9tYWtlKCItLS0lKmMlcyIsIGluZGVu
dCArIDEsICcgJywgbWVudV9nZXRfcHJvbXB0KG1lbnUpKTsKIAkJCWl0ZW1fc2V0X3RhZygnOicp
OwogCQkJaXRlbV9zZXRfZGF0YShtZW51KTsKIAkJCWdvdG8gY29uZl9jaGlsZHM7CkBAIC02MTgs
MTcgKzYxNywxNyBAQCBzdGF0aWMgdm9pZCBidWlsZF9jb25mKHN0cnVjdCBtZW51ICptZW51KQog
CQkJCXRtcCA9IGluZGVudCAtIHRtcCArIDQ7CiAJCQkJaWYgKHRtcCA8IDApCiAJCQkJCXRtcCA9
IDA7Ci0JCQkJaXRlbV9hZGRfc3RyKCIlKmMlcyVzIiwgdG1wLCAnICcsIF8obWVudV9nZXRfcHJv
bXB0KG1lbnUpKSwKKwkJCQlpdGVtX2FkZF9zdHIoIiUqYyVzJXMiLCB0bXAsICcgJywgbWVudV9n
ZXRfcHJvbXB0KG1lbnUpLAogCQkJCQkgICAgIChzeW1faGFzX3ZhbHVlKHN5bSkgfHwgIXN5bV9p
c19jaGFuZ2FibGUoc3ltKSkgPwotCQkJCQkgICAgICIiIDogXygiIChORVcpIikpOworCQkJCQkg
ICAgICIiIDogIiAoTkVXKSIpOwogCQkJCWl0ZW1fc2V0X3RhZygncycpOwogCQkJCWl0ZW1fc2V0
X2RhdGEobWVudSk7CiAJCQkJZ290byBjb25mX2NoaWxkczsKIAkJCX0KIAkJfQotCQlpdGVtX2Fk
ZF9zdHIoIiUqYyVzJXMiLCBpbmRlbnQgKyAxLCAnICcsIF8obWVudV9nZXRfcHJvbXB0KG1lbnUp
KSwKKwkJaXRlbV9hZGRfc3RyKCIlKmMlcyVzIiwgaW5kZW50ICsgMSwgJyAnLCBtZW51X2dldF9w
cm9tcHQobWVudSksCiAJCQkgIChzeW1faGFzX3ZhbHVlKHN5bSkgfHwgIXN5bV9pc19jaGFuZ2Fi
bGUoc3ltKSkgPwotCQkJICAiIiA6IF8oIiAoTkVXKSIpKTsKKwkJCSAgIiIgOiAiIChORVcpIik7
CiAJCWlmIChtZW51LT5wcm9tcHQtPnR5cGUgPT0gUF9NRU5VKSB7CiAJCQlpdGVtX2FkZF9zdHIo
IiAgJXMiLCBtZW51X2lzX2VtcHR5KG1lbnUpID8gIi0tLS0iIDogIi0tLT4iKTsKIAkJCXJldHVy
bjsKQEAgLTY2NSw4ICs2NjQsOCBAQCBzdGF0aWMgdm9pZCBjb25mKHN0cnVjdCBtZW51ICptZW51
LCBzdHJ1Y3QgbWVudSAqYWN0aXZlX21lbnUpCiAJCQlicmVhazsKIAkJc2V0X3N1YnRpdGxlKCk7
CiAJCWRpYWxvZ19jbGVhcigpOwotCQlyZXMgPSBkaWFsb2dfbWVudShwcm9tcHQgPyBfKHByb21w
dCkgOiBfKCJNYWluIE1lbnUiKSwKLQkJCQkgIF8obWVudV9pbnN0cnVjdGlvbnMpLAorCQlyZXMg
PSBkaWFsb2dfbWVudShwcm9tcHQgPyBwcm9tcHQgOiAiTWFpbiBNZW51IiwKKwkJCQkgIG1lbnVf
aW5zdHJ1Y3Rpb25zLAogCQkJCSAgYWN0aXZlX21lbnUsICZzX3Njcm9sbCk7CiAJCWlmIChyZXMg
PT0gMSB8fCByZXMgPT0gS0VZX0VTQyB8fCByZXMgPT0gLUVSUkRJU1BMQVlUT09TTUFMTCkKIAkJ
CWJyZWFrOwpAQCAtNzA4LDcgKzcwNyw3IEBAIHN0YXRpYyB2b2lkIGNvbmYoc3RydWN0IG1lbnUg
Km1lbnUsIHN0cnVjdCBtZW51ICphY3RpdmVfbWVudSkKIAkJCQlzaG93X2hlbHAoc3VibWVudSk7
CiAJCQllbHNlIHsKIAkJCQlyZXNldF9zdWJ0aXRsZSgpOwotCQkJCXNob3dfaGVscHRleHQoXygi
UkVBRE1FIiksIF8obWNvbmZfcmVhZG1lKSk7CisJCQkJc2hvd19oZWxwdGV4dCgiUkVBRE1FIiwg
bWNvbmZfcmVhZG1lKTsKIAkJCX0KIAkJCWJyZWFrOwogCQljYXNlIDM6CkBAIC03OTMsMTMgKzc5
MiwxMyBAQCBzdGF0aWMgdm9pZCBzaG93X2hlbHAoc3RydWN0IG1lbnUgKm1lbnUpCiAJaGVscC5t
YXhfd2lkdGggPSBnZXRtYXh4KHN0ZHNjcikgLSAxMDsKIAltZW51X2dldF9leHRfaGVscChtZW51
LCAmaGVscCk7CiAKLQlzaG93X2hlbHB0ZXh0KF8obWVudV9nZXRfcHJvbXB0KG1lbnUpKSwgc3Ry
X2dldCgmaGVscCkpOworCXNob3dfaGVscHRleHQobWVudV9nZXRfcHJvbXB0KG1lbnUpLCBzdHJf
Z2V0KCZoZWxwKSk7CiAJc3RyX2ZyZWUoJmhlbHApOwogfQogCiBzdGF0aWMgdm9pZCBjb25mX2No
b2ljZShzdHJ1Y3QgbWVudSAqbWVudSkKIHsKLQljb25zdCBjaGFyICpwcm9tcHQgPSBfKG1lbnVf
Z2V0X3Byb21wdChtZW51KSk7CisJY29uc3QgY2hhciAqcHJvbXB0ID0gbWVudV9nZXRfcHJvbXB0
KG1lbnUpOwogCXN0cnVjdCBtZW51ICpjaGlsZDsKIAlzdHJ1Y3Qgc3ltYm9sICphY3RpdmU7CiAK
QEAgLTgxNCw5ICs4MTMsOSBAQCBzdGF0aWMgdm9pZCBjb25mX2Nob2ljZShzdHJ1Y3QgbWVudSAq
bWVudSkKIAkJCWlmICghbWVudV9pc192aXNpYmxlKGNoaWxkKSkKIAkJCQljb250aW51ZTsKIAkJ
CWlmIChjaGlsZC0+c3ltKQotCQkJCWl0ZW1fbWFrZSgiJXMiLCBfKG1lbnVfZ2V0X3Byb21wdChj
aGlsZCkpKTsKKwkJCQlpdGVtX21ha2UoIiVzIiwgbWVudV9nZXRfcHJvbXB0KGNoaWxkKSk7CiAJ
CQllbHNlIHsKLQkJCQlpdGVtX21ha2UoIioqKiAlcyAqKioiLCBfKG1lbnVfZ2V0X3Byb21wdChj
aGlsZCkpKTsKKwkJCQlpdGVtX21ha2UoIioqKiAlcyAqKioiLCBtZW51X2dldF9wcm9tcHQoY2hp
bGQpKTsKIAkJCQlpdGVtX3NldF90YWcoJzonKTsKIAkJCX0KIAkJCWl0ZW1fc2V0X2RhdGEoY2hp
bGQpOwpAQCAtODI2LDggKzgyNSw4IEBAIHN0YXRpYyB2b2lkIGNvbmZfY2hvaWNlKHN0cnVjdCBt
ZW51ICptZW51KQogCQkJCWl0ZW1fc2V0X3RhZygnWCcpOwogCQl9CiAJCWRpYWxvZ19jbGVhcigp
OwotCQlyZXMgPSBkaWFsb2dfY2hlY2tsaXN0KHByb21wdCA/IF8ocHJvbXB0KSA6IF8oIk1haW4g
TWVudSIpLAotCQkJCQlfKHJhZGlvbGlzdF9pbnN0cnVjdGlvbnMpLAorCQlyZXMgPSBkaWFsb2df
Y2hlY2tsaXN0KHByb21wdCA/IHByb21wdCA6ICJNYWluIE1lbnUiLAorCQkJCQlyYWRpb2xpc3Rf
aW5zdHJ1Y3Rpb25zLAogCQkJCQlNRU5VQk9YX0hFSUdUSF9NSU4sCiAJCQkJCU1FTlVCT1hfV0lE
VEhfTUlOLAogCQkJCQlDSEVDS0xJU1RfSEVJR1RIX01JTik7CkBAIC04NjgsMjYgKzg2NywyNiBA
QCBzdGF0aWMgdm9pZCBjb25mX3N0cmluZyhzdHJ1Y3QgbWVudSAqbWVudSkKIAogCQlzd2l0Y2gg
KHN5bV9nZXRfdHlwZShtZW51LT5zeW0pKSB7CiAJCWNhc2UgU19JTlQ6Ci0JCQloZWFkaW5nID0g
XyhpbnB1dGJveF9pbnN0cnVjdGlvbnNfaW50KTsKKwkJCWhlYWRpbmcgPSBpbnB1dGJveF9pbnN0
cnVjdGlvbnNfaW50OwogCQkJYnJlYWs7CiAJCWNhc2UgU19IRVg6Ci0JCQloZWFkaW5nID0gXyhp
bnB1dGJveF9pbnN0cnVjdGlvbnNfaGV4KTsKKwkJCWhlYWRpbmcgPSBpbnB1dGJveF9pbnN0cnVj
dGlvbnNfaGV4OwogCQkJYnJlYWs7CiAJCWNhc2UgU19TVFJJTkc6Ci0JCQloZWFkaW5nID0gXyhp
bnB1dGJveF9pbnN0cnVjdGlvbnNfc3RyaW5nKTsKKwkJCWhlYWRpbmcgPSBpbnB1dGJveF9pbnN0
cnVjdGlvbnNfc3RyaW5nOwogCQkJYnJlYWs7CiAJCWRlZmF1bHQ6Ci0JCQloZWFkaW5nID0gXygi
SW50ZXJuYWwgbWNvbmYgZXJyb3IhIik7CisJCQloZWFkaW5nID0gIkludGVybmFsIG1jb25mIGVy
cm9yISI7CiAJCX0KIAkJZGlhbG9nX2NsZWFyKCk7Ci0JCXJlcyA9IGRpYWxvZ19pbnB1dGJveChw
cm9tcHQgPyBfKHByb21wdCkgOiBfKCJNYWluIE1lbnUiKSwKKwkJcmVzID0gZGlhbG9nX2lucHV0
Ym94KHByb21wdCA/IHByb21wdCA6ICJNYWluIE1lbnUiLAogCQkJCSAgICAgIGhlYWRpbmcsIDEw
LCA3NSwKIAkJCQkgICAgICBzeW1fZ2V0X3N0cmluZ192YWx1ZShtZW51LT5zeW0pKTsKIAkJc3dp
dGNoIChyZXMpIHsKIAkJY2FzZSAwOgogCQkJaWYgKHN5bV9zZXRfc3RyaW5nX3ZhbHVlKG1lbnUt
PnN5bSwgZGlhbG9nX2lucHV0X3Jlc3VsdCkpCiAJCQkJcmV0dXJuOwotCQkJc2hvd190ZXh0Ym94
KE5VTEwsIF8oIllvdSBoYXZlIG1hZGUgYW4gaW52YWxpZCBlbnRyeS4iKSwgNSwgNDMpOworCQkJ
c2hvd190ZXh0Ym94KE5VTEwsICJZb3UgaGF2ZSBtYWRlIGFuIGludmFsaWQgZW50cnkuIiwgNSwg
NDMpOwogCQkJYnJlYWs7CiAJCWNhc2UgMToKIAkJCXNob3dfaGVscChtZW51KTsKQEAgLTkxNSwx
MCArOTE0LDEwIEBAIHN0YXRpYyB2b2lkIGNvbmZfbG9hZCh2b2lkKQogCQkJCXN5bV9zZXRfY2hh
bmdlX2NvdW50KDEpOwogCQkJCXJldHVybjsKIAkJCX0KLQkJCXNob3dfdGV4dGJveChOVUxMLCBf
KCJGaWxlIGRvZXMgbm90IGV4aXN0ISIpLCA1LCAzOCk7CisJCQlzaG93X3RleHRib3goTlVMTCwg
IkZpbGUgZG9lcyBub3QgZXhpc3QhIiwgNSwgMzgpOwogCQkJYnJlYWs7CiAJCWNhc2UgMToKLQkJ
CXNob3dfaGVscHRleHQoXygiTG9hZCBBbHRlcm5hdGUgQ29uZmlndXJhdGlvbiIpLCBsb2FkX2Nv
bmZpZ19oZWxwKTsKKwkJCXNob3dfaGVscHRleHQoIkxvYWQgQWx0ZXJuYXRlIENvbmZpZ3VyYXRp
b24iLCBsb2FkX2NvbmZpZ19oZWxwKTsKIAkJCWJyZWFrOwogCQljYXNlIEtFWV9FU0M6CiAJCQly
ZXR1cm47CkBAIC05NDEsMTAgKzk0MCwxMCBAQCBzdGF0aWMgdm9pZCBjb25mX3NhdmUodm9pZCkK
IAkJCQlzZXRfY29uZmlnX2ZpbGVuYW1lKGRpYWxvZ19pbnB1dF9yZXN1bHQpOwogCQkJCXJldHVy
bjsKIAkJCX0KLQkJCXNob3dfdGV4dGJveChOVUxMLCBfKCJDYW4ndCBjcmVhdGUgZmlsZSEgIFBy
b2JhYmx5IGEgbm9uZXhpc3RlbnQgZGlyZWN0b3J5LiIpLCA1LCA2MCk7CisJCQlzaG93X3RleHRi
b3goTlVMTCwgIkNhbid0IGNyZWF0ZSBmaWxlISAgUHJvYmFibHkgYSBub25leGlzdGVudCBkaXJl
Y3RvcnkuIiwgNSwgNjApOwogCQkJYnJlYWs7CiAJCWNhc2UgMToKLQkJCXNob3dfaGVscHRleHQo
XygiU2F2ZSBBbHRlcm5hdGUgQ29uZmlndXJhdGlvbiIpLCBzYXZlX2NvbmZpZ19oZWxwKTsKKwkJ
CXNob3dfaGVscHRleHQoIlNhdmUgQWx0ZXJuYXRlIENvbmZpZ3VyYXRpb24iLCBzYXZlX2NvbmZp
Z19oZWxwKTsKIAkJCWJyZWFrOwogCQljYXNlIEtFWV9FU0M6CiAJCQlyZXR1cm47CkBAIC05NjEs
OCArOTYwLDggQEAgc3RhdGljIGludCBoYW5kbGVfZXhpdCh2b2lkKQogCWRpYWxvZ19jbGVhcigp
OwogCWlmIChjb25mX2dldF9jaGFuZ2VkKCkpCiAJCXJlcyA9IGRpYWxvZ195ZXNubyhOVUxMLAot
CQkJCSAgIF8oIkRvIHlvdSB3aXNoIHRvIHNhdmUgeW91ciBuZXcgY29uZmlndXJhdGlvbj9cbiIK
LQkJCQkgICAgICIoUHJlc3MgPEVTQz48RVNDPiB0byBjb250aW51ZSBrZXJuZWwgY29uZmlndXJh
dGlvbi4pIiksCisJCQkJICAgIkRvIHlvdSB3aXNoIHRvIHNhdmUgeW91ciBuZXcgY29uZmlndXJh
dGlvbj9cbiIKKwkJCQkgICAgICIoUHJlc3MgPEVTQz48RVNDPiB0byBjb250aW51ZSBrZXJuZWwg
Y29uZmlndXJhdGlvbi4pIiwKIAkJCQkgICA2LCA2MCk7CiAJZWxzZQogCQlyZXMgPSAtMTsKQEAg
LTk3MiwyNiArOTcxLDI2IEBAIHN0YXRpYyBpbnQgaGFuZGxlX2V4aXQodm9pZCkKIAlzd2l0Y2gg
KHJlcykgewogCWNhc2UgMDoKIAkJaWYgKGNvbmZfd3JpdGUoZmlsZW5hbWUpKSB7Ci0JCQlmcHJp
bnRmKHN0ZGVyciwgXygiXG5cbiIKKwkJCWZwcmludGYoc3RkZXJyLCAiXG5cbiIKIAkJCQkJICAi
RXJyb3Igd2hpbGUgd3JpdGluZyBvZiB0aGUgY29uZmlndXJhdGlvbi5cbiIKIAkJCQkJICAiWW91
ciBjb25maWd1cmF0aW9uIGNoYW5nZXMgd2VyZSBOT1Qgc2F2ZWQuIgotCQkJCQkgICJcblxuIikp
OworCQkJCQkgICJcblxuIik7CiAJCQlyZXR1cm4gMTsKIAkJfQogCQkvKiBmYWxsIHRocm91Z2gg
Ki8KIAljYXNlIC0xOgogCQlpZiAoIXNpbGVudCkKLQkJCXByaW50ZihfKCJcblxuIgorCQkJcHJp
bnRmKCJcblxuIgogCQkJCSAiKioqIEVuZCBvZiB0aGUgY29uZmlndXJhdGlvbi5cbiIKIAkJCQkg
IioqKiBFeGVjdXRlICdtYWtlJyB0byBzdGFydCB0aGUgYnVpbGQgb3IgdHJ5ICdtYWtlIGhlbHAn
LiIKLQkJCQkgIlxuXG4iKSk7CisJCQkJICJcblxuIik7CiAJCXJlcyA9IDA7CiAJCWJyZWFrOwog
CWRlZmF1bHQ6CiAJCWlmICghc2lsZW50KQotCQkJZnByaW50ZihzdGRlcnIsIF8oIlxuXG4iCisJ
CQlmcHJpbnRmKHN0ZGVyciwgIlxuXG4iCiAJCQkJCSAgIllvdXIgY29uZmlndXJhdGlvbiBjaGFu
Z2VzIHdlcmUgTk9UIHNhdmVkLiIKLQkJCQkJICAiXG5cbiIpKTsKKwkJCQkJICAiXG5cbiIpOwog
CQlpZiAocmVzICE9IEtFWV9FU0MpCiAJCQlyZXMgPSAwOwogCX0KQEAgLTEwMDksMTAgKzEwMDgs
NiBAQCBpbnQgbWFpbihpbnQgYWMsIGNoYXIgKiphdikKIAljaGFyICptb2RlOwogCWludCByZXM7
CiAKLQlzZXRsb2NhbGUoTENfQUxMLCAiIik7Ci0JYmluZHRleHRkb21haW4oUEFDS0FHRSwgTE9D
QUxFRElSKTsKLQl0ZXh0ZG9tYWluKFBBQ0tBR0UpOwotCiAJc2lnbmFsKFNJR0lOVCwgc2lnX2hh
bmRsZXIpOwogCiAJaWYgKGFjID4gMSAmJiBzdHJjbXAoYXZbMV0sICItcyIpID09IDApIHsKQEAg
LTEwMzEsOCArMTAyNiw4IEBAIGludCBtYWluKGludCBhYywgY2hhciAqKmF2KQogCX0KIAogCWlm
IChpbml0X2RpYWxvZyhOVUxMKSkgewotCQlmcHJpbnRmKHN0ZGVyciwgTl8oIllvdXIgZGlzcGxh
eSBpcyB0b28gc21hbGwgdG8gcnVuIE1lbnVjb25maWchXG4iKSk7Ci0JCWZwcmludGYoc3RkZXJy
LCBOXygiSXQgbXVzdCBiZSBhdCBsZWFzdCAxOSBsaW5lcyBieSA4MCBjb2x1bW5zLlxuIikpOwor
CQlmcHJpbnRmKHN0ZGVyciwgIllvdXIgZGlzcGxheSBpcyB0b28gc21hbGwgdG8gcnVuIE1lbnVj
b25maWchXG4iKTsKKwkJZnByaW50ZihzdGRlcnIsICJJdCBtdXN0IGJlIGF0IGxlYXN0IDE5IGxp
bmVzIGJ5IDgwIGNvbHVtbnMuXG4iKTsKIAkJcmV0dXJuIDE7CiAJfQogCmRpZmYgLS1naXQgYS94
ZW4vdG9vbHMva2NvbmZpZy9tZW51LmMgYi94ZW4vdG9vbHMva2NvbmZpZy9tZW51LmMKaW5kZXgg
YjA1Y2MzZDRhOS4uNzFkMzFmMmJmNiAxMDA2NDQKLS0tIGEveGVuL3Rvb2xzL2tjb25maWcvbWVu
dS5jCisrKyBiL3hlbi90b29scy9rY29uZmlnL21lbnUuYwpAQCAtNTUwLDcgKzU1MCw3IEBAIHN0
YXRpYyB2b2lkIGdldF9wcm9tcHRfc3RyKHN0cnVjdCBnc3RyICpyLCBzdHJ1Y3QgcHJvcGVydHkg
KnByb3AsCiAJc3RydWN0IG1lbnUgKnN1Ym1lbnVbOF0sICptZW51LCAqbG9jYXRpb24gPSBOVUxM
OwogCXN0cnVjdCBqdW1wX2tleSAqanVtcCA9IE5VTEw7CiAKLQlzdHJfcHJpbnRmKHIsIF8oIlBy
b21wdDogJXNcbiIpLCBfKHByb3AtPnRleHQpKTsKKwlzdHJfcHJpbnRmKHIsICJQcm9tcHQ6ICVz
XG4iLCBwcm9wLT50ZXh0KTsKIAltZW51ID0gcHJvcC0+bWVudS0+cGFyZW50OwogCWZvciAoaSA9
IDA7IG1lbnUgIT0gJnJvb3RtZW51ICYmIGkgPCA4OyBtZW51ID0gbWVudS0+cGFyZW50KSB7CiAJ
CWJvb2wgYWNjZXNzaWJsZSA9IG1lbnVfaXNfdmlzaWJsZShtZW51KTsKQEAgLTU4MywxNiArNTgz
LDE2IEBAIHN0YXRpYyB2b2lkIGdldF9wcm9tcHRfc3RyKHN0cnVjdCBnc3RyICpyLCBzdHJ1Y3Qg
cHJvcGVydHkgKnByb3AsCiAJfQogCiAJaWYgKGkgPiAwKSB7Ci0JCXN0cl9wcmludGYociwgXygi
ICBMb2NhdGlvbjpcbiIpKTsKKwkJc3RyX3ByaW50ZihyLCAiICBMb2NhdGlvbjpcbiIpOwogCQlm
b3IgKGogPSA0OyAtLWkgPj0gMDsgaiArPSAyKSB7CiAJCQltZW51ID0gc3VibWVudVtpXTsKIAkJ
CWlmIChqdW1wICYmIG1lbnUgPT0gbG9jYXRpb24pCiAJCQkJanVtcC0+b2Zmc2V0ID0gc3RybGVu
KHItPnMpOwogCQkJc3RyX3ByaW50ZihyLCAiJSpjLT4gJXMiLCBqLCAnICcsCi0JCQkJICAgXyht
ZW51X2dldF9wcm9tcHQobWVudSkpKTsKKwkJCQkgICBtZW51X2dldF9wcm9tcHQobWVudSkpOwog
CQkJaWYgKG1lbnUtPnN5bSkgewogCQkJCXN0cl9wcmludGYociwgIiAoJXMgWz0lc10pIiwgbWVu
dS0+c3ltLT5uYW1lID8KLQkJCQkJbWVudS0+c3ltLT5uYW1lIDogXygiPGNob2ljZT4iKSwKKwkJ
CQkJbWVudS0+c3ltLT5uYW1lIDogIjxjaG9pY2U+IiwKIAkJCQkJc3ltX2dldF9zdHJpbmdfdmFs
dWUobWVudS0+c3ltKSk7CiAJCQl9CiAJCQlzdHJfYXBwZW5kKHIsICJcbiIpOwpAQCAtNjM5LDEw
ICs2MzksMTAgQEAgc3RhdGljIHZvaWQgZ2V0X3N5bWJvbF9zdHIoc3RydWN0IGdzdHIgKnIsIHN0
cnVjdCBzeW1ib2wgKnN5bSwKIAogCXByb3AgPSBnZXRfc3ltYm9sX3Byb3Aoc3ltKTsKIAlpZiAo
cHJvcCkgewotCQlzdHJfcHJpbnRmKHIsIF8oIiAgRGVmaW5lZCBhdCAlczolZFxuIiksIHByb3At
Pm1lbnUtPmZpbGUtPm5hbWUsCisJCXN0cl9wcmludGYociwgIiAgRGVmaW5lZCBhdCAlczolZFxu
IiwgcHJvcC0+bWVudS0+ZmlsZS0+bmFtZSwKIAkJCXByb3AtPm1lbnUtPmxpbmVubyk7CiAJCWlm
ICghZXhwcl9pc195ZXMocHJvcC0+dmlzaWJsZS5leHByKSkgewotCQkJc3RyX2FwcGVuZChyLCBf
KCIgIERlcGVuZHMgb246ICIpKTsKKwkJCXN0cl9hcHBlbmQociwgIiAgRGVwZW5kcyBvbjogIik7
CiAJCQlleHByX2dzdHJfcHJpbnQocHJvcC0+dmlzaWJsZS5leHByLCByKTsKIAkJCXN0cl9hcHBl
bmQociwgIlxuIik7CiAJCX0KQEAgLTY2MCw3ICs2NjAsNyBAQCBzdGF0aWMgdm9pZCBnZXRfc3lt
Ym9sX3N0cihzdHJ1Y3QgZ3N0ciAqciwgc3RydWN0IHN5bWJvbCAqc3ltLAogCWlmIChoaXQpCiAJ
CXN0cl9hcHBlbmQociwgIlxuIik7CiAJaWYgKHN5bS0+cmV2X2RlcC5leHByKSB7Ci0JCXN0cl9h
cHBlbmQociwgXygiICBTZWxlY3RlZCBieTogIikpOworCQlzdHJfYXBwZW5kKHIsICIgIFNlbGVj
dGVkIGJ5OiAiKTsKIAkJZXhwcl9nc3RyX3ByaW50KHN5bS0+cmV2X2RlcC5leHByLCByKTsKIAkJ
c3RyX2FwcGVuZChyLCAiXG4iKTsKIAl9CkBAIC02NzYsNyArNjc2LDcgQEAgc3RydWN0IGdzdHIg
Z2V0X3JlbGF0aW9uc19zdHIoc3RydWN0IHN5bWJvbCAqKnN5bV9hcnIsIHN0cnVjdCBsaXN0X2hl
YWQgKmhlYWQpCiAJZm9yIChpID0gMDsgc3ltX2FyciAmJiAoc3ltID0gc3ltX2FycltpXSk7IGkr
KykKIAkJZ2V0X3N5bWJvbF9zdHIoJnJlcywgc3ltLCBoZWFkKTsKIAlpZiAoIWkpCi0JCXN0cl9h
cHBlbmQoJnJlcywgXygiTm8gbWF0Y2hlcyBmb3VuZC5cbiIpKTsKKwkJc3RyX2FwcGVuZCgmcmVz
LCAiTm8gbWF0Y2hlcyBmb3VuZC5cbiIpOwogCXJldHVybiByZXM7CiB9CiAKQEAgLTY5MSw3ICs2
OTEsNyBAQCB2b2lkIG1lbnVfZ2V0X2V4dF9oZWxwKHN0cnVjdCBtZW51ICptZW51LCBzdHJ1Y3Qg
Z3N0ciAqaGVscCkKIAkJCXN0cl9wcmludGYoaGVscCwgIiVzJXM6XG5cbiIsIENPTkZJR18sIHN5
bS0+bmFtZSk7CiAJCWhlbHBfdGV4dCA9IG1lbnVfZ2V0X2hlbHAobWVudSk7CiAJfQotCXN0cl9w
cmludGYoaGVscCwgIiVzXG4iLCBfKGhlbHBfdGV4dCkpOworCXN0cl9wcmludGYoaGVscCwgIiVz
XG4iLCBoZWxwX3RleHQpOwogCWlmIChzeW0pCiAJCWdldF9zeW1ib2xfc3RyKGhlbHAsIHN5bSwg
TlVMTCk7CiB9CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMva2NvbmZpZy9uY29uZi5jIGIveGVuL3Rv
b2xzL2tjb25maWcvbmNvbmYuYwppbmRleCBkNDJkNTM0YTY2Li5iNmU0NGNiZTU5IDEwMDY0NAot
LS0gYS94ZW4vdG9vbHMva2NvbmZpZy9uY29uZi5jCisrKyBiL3hlbi90b29scy9rY29uZmlnL25j
b25mLmMKQEAgLTEzLDcgKzEzLDcgQEAKICNpbmNsdWRlICJuY29uZi5oIgogI2luY2x1ZGUgPGN0
eXBlLmg+CiAKLXN0YXRpYyBjb25zdCBjaGFyIG5jb25mX2dsb2JhbF9oZWxwW10gPSBOXygKK3N0
YXRpYyBjb25zdCBjaGFyIG5jb25mX2dsb2JhbF9oZWxwW10gPQogIkhlbHAgd2luZG93c1xuIgog
Ii0tLS0tLS0tLS0tLVxuIgogIm8gIEdsb2JhbCBoZWxwOiAgVW5sZXNzIGluIGEgZGF0YSBlbnRy
eSB3aW5kb3csIHByZXNzaW5nIDxGMT4gd2lsbCBnaXZlIFxuIgpAQCAtMTI4LDggKzEyOCw4IEBA
IHN0YXRpYyBjb25zdCBjaGFyIG5jb25mX2dsb2JhbF9oZWxwW10gPSBOXygKICJcbiIKICJOb3Rl
IHRoYXQgdGhpcyBtb2RlIGNhbiBldmVudHVhbGx5IGJlIGEgbGl0dGxlIG1vcmUgQ1BVIGV4cGVu
c2l2ZSB0aGFuXG4iCiAidGhlIGRlZmF1bHQgbW9kZSwgZXNwZWNpYWxseSB3aXRoIGEgbGFyZ2Vy
IG51bWJlciBvZiB1bmZvbGRlZCBzdWJtZW51cy5cbiIKLSJcbiIpLAotbWVudV9ub19mX2luc3Ry
dWN0aW9uc1tdID0gTl8oCisiXG4iLAorbWVudV9ub19mX2luc3RydWN0aW9uc1tdID0KICJMZWdl
bmQ6ICBbKl0gYnVpbHQtaW4gIFsgXSBleGNsdWRlZCAgPE0+IG1vZHVsZSAgPCA+IG1vZHVsZSBj
YXBhYmxlLlxuIgogIlN1Ym1lbnVzIGFyZSBkZXNpZ25hdGVkIGJ5IGEgdHJhaWxpbmcgXCItLS0+
XCIsIGVtcHR5IG9uZXMgYnkgXCItLS0tXCIuXG4iCiAiXG4iCkBAIC0xNDUsOCArMTQ1LDggQEAg
bWVudV9ub19mX2luc3RydWN0aW9uc1tdID0gTl8oCiAiWW91IGRvIG5vdCBoYXZlIGZ1bmN0aW9u
IGtleXMgc3VwcG9ydC5cbiIKICJQcmVzcyA8MT4gaW5zdGVhZCBvZiA8RjE+LCA8Mj4gaW5zdGVh
ZCBvZiA8RjI+LCBldGMuXG4iCiAiRm9yIHZlcmJvc2UgZ2xvYmFsIGhlbHAgdXNlIGtleSA8MT4u
XG4iCi0iRm9yIGhlbHAgcmVsYXRlZCB0byB0aGUgY3VycmVudCBtZW51IGVudHJ5IHByZXNzIDw/
PiBvciA8aD4uXG4iKSwKLW1lbnVfaW5zdHJ1Y3Rpb25zW10gPSBOXygKKyJGb3IgaGVscCByZWxh
dGVkIHRvIHRoZSBjdXJyZW50IG1lbnUgZW50cnkgcHJlc3MgPD8+IG9yIDxoPi5cbiIsCittZW51
X2luc3RydWN0aW9uc1tdID0KICJMZWdlbmQ6ICBbKl0gYnVpbHQtaW4gIFsgXSBleGNsdWRlZCAg
PE0+IG1vZHVsZSAgPCA+IG1vZHVsZSBjYXBhYmxlLlxuIgogIlN1Ym1lbnVzIGFyZSBkZXNpZ25h
dGVkIGJ5IGEgdHJhaWxpbmcgXCItLS0+XCIsIGVtcHR5IG9uZXMgYnkgXCItLS0tXCIuXG4iCiAi
XG4iCkBAIC0xNjEsMzAgKzE2MSwzMCBAQCBtZW51X2luc3RydWN0aW9uc1tdID0gTl8oCiAiXG4i
CiAiUHJlc3NpbmcgPDE+IG1heSBiZSB1c2VkIGluc3RlYWQgb2YgPEYxPiwgPDI+IGluc3RlYWQg
b2YgPEYyPiwgZXRjLlxuIgogIkZvciB2ZXJib3NlIGdsb2JhbCBoZWxwIHByZXNzIDxGMT4uXG4i
Ci0iRm9yIGhlbHAgcmVsYXRlZCB0byB0aGUgY3VycmVudCBtZW51IGVudHJ5IHByZXNzIDw/PiBv
ciA8aD4uXG4iKSwKLXJhZGlvbGlzdF9pbnN0cnVjdGlvbnNbXSA9IE5fKAorIkZvciBoZWxwIHJl
bGF0ZWQgdG8gdGhlIGN1cnJlbnQgbWVudSBlbnRyeSBwcmVzcyA8Pz4gb3IgPGg+LlxuIiwKK3Jh
ZGlvbGlzdF9pbnN0cnVjdGlvbnNbXSA9CiAiUHJlc3MgPFVwPiwgPERvd24+LCA8SG9tZT4gb3Ig
PEVuZD4gdG8gbmF2aWdhdGUgYSByYWRpb2xpc3QsIHNlbGVjdFxuIgogIndpdGggPFNwYWNlPi5c
biIKICJGb3IgaGVscCByZWxhdGVkIHRvIHRoZSBjdXJyZW50IGVudHJ5IHByZXNzIDw/PiBvciA8
aD4uXG4iCi0iRm9yIGdsb2JhbCBoZWxwIHByZXNzIDxGMT4uXG4iKSwKLWlucHV0Ym94X2luc3Ry
dWN0aW9uc19pbnRbXSA9IE5fKAorIkZvciBnbG9iYWwgaGVscCBwcmVzcyA8RjE+LlxuIiwKK2lu
cHV0Ym94X2luc3RydWN0aW9uc19pbnRbXSA9CiAiUGxlYXNlIGVudGVyIGEgZGVjaW1hbCB2YWx1
ZS5cbiIKICJGcmFjdGlvbnMgd2lsbCBub3QgYmUgYWNjZXB0ZWQuXG4iCi0iUHJlc3MgPEVudGVy
PiB0byBhcHBseSwgPEVzYz4gdG8gY2FuY2VsLiIpLAotaW5wdXRib3hfaW5zdHJ1Y3Rpb25zX2hl
eFtdID0gTl8oCisiUHJlc3MgPEVudGVyPiB0byBhcHBseSwgPEVzYz4gdG8gY2FuY2VsLiIsCitp
bnB1dGJveF9pbnN0cnVjdGlvbnNfaGV4W10gPQogIlBsZWFzZSBlbnRlciBhIGhleGFkZWNpbWFs
IHZhbHVlLlxuIgotIlByZXNzIDxFbnRlcj4gdG8gYXBwbHksIDxFc2M+IHRvIGNhbmNlbC4iKSwK
LWlucHV0Ym94X2luc3RydWN0aW9uc19zdHJpbmdbXSA9IE5fKAorIlByZXNzIDxFbnRlcj4gdG8g
YXBwbHksIDxFc2M+IHRvIGNhbmNlbC4iLAoraW5wdXRib3hfaW5zdHJ1Y3Rpb25zX3N0cmluZ1td
ID0KICJQbGVhc2UgZW50ZXIgYSBzdHJpbmcgdmFsdWUuXG4iCi0iUHJlc3MgPEVudGVyPiB0byBh
cHBseSwgPEVzYz4gdG8gY2FuY2VsLiIpLAotc2V0bW9kX3RleHRbXSA9IE5fKAorIlByZXNzIDxF
bnRlcj4gdG8gYXBwbHksIDxFc2M+IHRvIGNhbmNlbC4iLAorc2V0bW9kX3RleHRbXSA9CiAiVGhp
cyBmZWF0dXJlIGRlcGVuZHMgb24gYW5vdGhlciBmZWF0dXJlIHdoaWNoIGhhcyBiZWVuIGNvbmZp
Z3VyZWQgYXMgYVxuIgotIm1vZHVsZS4gIEFzIGEgcmVzdWx0LCB0aGUgY3VycmVudCBmZWF0dXJl
IHdpbGwgYmUgYnVpbHQgYXMgYSBtb2R1bGUgdG9vLiIpLAotbG9hZF9jb25maWdfdGV4dFtdID0g
Tl8oCisibW9kdWxlLiAgQXMgYSByZXN1bHQsIHRoZSBjdXJyZW50IGZlYXR1cmUgd2lsbCBiZSBi
dWlsdCBhcyBhIG1vZHVsZSB0b28uIiwKK2xvYWRfY29uZmlnX3RleHRbXSA9CiAiRW50ZXIgdGhl
IG5hbWUgb2YgdGhlIGNvbmZpZ3VyYXRpb24gZmlsZSB5b3Ugd2lzaCB0byBsb2FkLlxuIgogIkFj
Y2VwdCB0aGUgbmFtZSBzaG93biB0byByZXN0b3JlIHRoZSBjb25maWd1cmF0aW9uIHlvdSBsYXN0
XG4iCi0icmV0cmlldmVkLiAgTGVhdmUgZW1wdHkgdG8gYWJvcnQuIiksCi1sb2FkX2NvbmZpZ19o
ZWxwW10gPSBOXygKKyJyZXRyaWV2ZWQuICBMZWF2ZSBlbXB0eSB0byBhYm9ydC4iLAorbG9hZF9j
b25maWdfaGVscFtdID0KICJGb3IgdmFyaW91cyByZWFzb25zLCBvbmUgbWF5IHdpc2ggdG8ga2Vl
cCBzZXZlcmFsIGRpZmZlcmVudFxuIgogImNvbmZpZ3VyYXRpb25zIGF2YWlsYWJsZSBvbiBhIHNp
bmdsZSBtYWNoaW5lLlxuIgogIlxuIgpAQCAtMTkyLDExICsxOTIsMTEgQEAgbG9hZF9jb25maWdf
aGVscFtdID0gTl8oCiAiZGVmYXVsdCBvbmUsIGVudGVyaW5nIGl0cyBuYW1lIGhlcmUgd2lsbCBh
bGxvdyB5b3UgdG8gbG9hZCBhbmQgbW9kaWZ5XG4iCiAidGhhdCBjb25maWd1cmF0aW9uLlxuIgog
IlxuIgotIkxlYXZlIGVtcHR5IHRvIGFib3J0LlxuIiksCi1zYXZlX2NvbmZpZ190ZXh0W10gPSBO
XygKKyJMZWF2ZSBlbXB0eSB0byBhYm9ydC5cbiIsCitzYXZlX2NvbmZpZ190ZXh0W10gPQogIkVu
dGVyIGEgZmlsZW5hbWUgdG8gd2hpY2ggdGhpcyBjb25maWd1cmF0aW9uIHNob3VsZCBiZSBzYXZl
ZFxuIgotImFzIGFuIGFsdGVybmF0ZS4gIExlYXZlIGVtcHR5IHRvIGFib3J0LiIpLAotc2F2ZV9j
b25maWdfaGVscFtdID0gTl8oCisiYXMgYW4gYWx0ZXJuYXRlLiAgTGVhdmUgZW1wdHkgdG8gYWJv
cnQuIiwKK3NhdmVfY29uZmlnX2hlbHBbXSA9CiAiRm9yIHZhcmlvdXMgcmVhc29ucywgb25lIG1h
eSB3aXNoIHRvIGtlZXAgc2V2ZXJhbCBkaWZmZXJlbnRcbiIKICJjb25maWd1cmF0aW9ucyBhdmFp
bGFibGUgb24gYSBzaW5nbGUgbWFjaGluZS5cbiIKICJcbiIKQEAgLTIwNCw4ICsyMDQsOCBAQCBz
YXZlX2NvbmZpZ19oZWxwW10gPSBOXygKICJhbmQgdXNlIHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRp
b24gYXMgYW4gYWx0ZXJuYXRlIHRvIHdoYXRldmVyXG4iCiAiY29uZmlndXJhdGlvbiBvcHRpb25z
IHlvdSBoYXZlIHNlbGVjdGVkIGF0IHRoYXQgdGltZS5cbiIKICJcbiIKLSJMZWF2ZSBlbXB0eSB0
byBhYm9ydC5cbiIpLAotc2VhcmNoX2hlbHBbXSA9IE5fKAorIkxlYXZlIGVtcHR5IHRvIGFib3J0
LlxuIiwKK3NlYXJjaF9oZWxwW10gPQogIlNlYXJjaCBmb3Igc3ltYm9scyAoY29uZmlndXJhdGlv
biB2YXJpYWJsZSBuYW1lcyBDT05GSUdfKikgYW5kIGRpc3BsYXlcbiIKICJ0aGVpciByZWxhdGlv
bnMuICBSZWd1bGFyIGV4cHJlc3Npb25zIGFyZSBzdXBwb3J0ZWQuXG4iCiAiRXhhbXBsZTogIFNl
YXJjaCBmb3IgXCJeRk9PXCIuXG4iCkBAIC0yNDIsNyArMjQyLDcgQEAgc2VhcmNoX2hlbHBbXSA9
IE5fKAogIlVTQiAgPT4gZmluZCBhbGwgc3ltYm9scyBjb250YWluaW5nIFVTQlxuIgogIl5VU0Ig
PT4gZmluZCBhbGwgc3ltYm9scyBzdGFydGluZyB3aXRoIFVTQlxuIgogIlVTQiQgPT4gZmluZCBh
bGwgc3ltYm9scyBlbmRpbmcgd2l0aCBVU0JcbiIKLSJcbiIpOworIlxuIjsKIAogc3RydWN0IG1p
dGVtIHsKIAljaGFyIHN0clsyNTZdOwpAQCAtMzg2LDcgKzM4Niw3IEBAIHN0YXRpYyB2b2lkIHBy
aW50X2Z1bmN0aW9uX2xpbmUodm9pZCkKIHN0YXRpYyB2b2lkIGhhbmRsZV9mMShpbnQgKmtleSwg
c3RydWN0IG1lbnUgKmN1cnJlbnRfaXRlbSkKIHsKIAlzaG93X3Njcm9sbF93aW4obWFpbl93aW5k
b3csCi0JCQlfKCJHbG9iYWwgaGVscCIpLCBfKG5jb25mX2dsb2JhbF9oZWxwKSk7CisJCQkiR2xv
YmFsIGhlbHAiLCBuY29uZl9nbG9iYWxfaGVscCk7CiAJcmV0dXJuOwogfQogCkBAIC00MDEsOCAr
NDAxLDggQEAgc3RhdGljIHZvaWQgaGFuZGxlX2YyKGludCAqa2V5LCBzdHJ1Y3QgbWVudSAqY3Vy
cmVudF9pdGVtKQogc3RhdGljIHZvaWQgaGFuZGxlX2YzKGludCAqa2V5LCBzdHJ1Y3QgbWVudSAq
Y3VycmVudF9pdGVtKQogewogCXNob3dfc2Nyb2xsX3dpbihtYWluX3dpbmRvdywKLQkJCV8oIlNo
b3J0IGhlbHAiKSwKLQkJCV8oY3VycmVudF9pbnN0cnVjdGlvbnMpKTsKKwkJCSJTaG9ydCBoZWxw
IiwKKwkJCWN1cnJlbnRfaW5zdHJ1Y3Rpb25zKTsKIAlyZXR1cm47CiB9CiAKQEAgLTQxMCw3ICs0
MTAsNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfZjMoaW50ICprZXksIHN0cnVjdCBtZW51ICpjdXJy
ZW50X2l0ZW0pCiBzdGF0aWMgdm9pZCBoYW5kbGVfZjQoaW50ICprZXksIHN0cnVjdCBtZW51ICpj
dXJyZW50X2l0ZW0pCiB7CiAJaW50IHJlcyA9IGJ0bl9kaWFsb2cobWFpbl93aW5kb3csCi0JCQlf
KCJTaG93IGFsbCBzeW1ib2xzPyIpLAorCQkJIlNob3cgYWxsIHN5bWJvbHM/IiwKIAkJCTIsCiAJ
CQkiICAgPFNob3cgQWxsPiAgICIsCiAJCQkiPERvbid0IHNob3cgYWxsPiIpOwpAQCAtNjUxLDgg
KzY1MSw4IEBAIHN0YXRpYyBpbnQgZG9fZXhpdCh2b2lkKQogCQlyZXR1cm4gMDsKIAl9CiAJcmVz
ID0gYnRuX2RpYWxvZyhtYWluX3dpbmRvdywKLQkJCV8oIkRvIHlvdSB3aXNoIHRvIHNhdmUgeW91
ciBuZXcgY29uZmlndXJhdGlvbj9cbiIKLQkJCQkiPEVTQz4gdG8gY2FuY2VsIGFuZCByZXN1bWUg
bmNvbmZpZy4iKSwKKwkJCSJEbyB5b3Ugd2lzaCB0byBzYXZlIHlvdXIgbmV3IGNvbmZpZ3VyYXRp
b24/XG4iCisJCQkJIjxFU0M+IHRvIGNhbmNlbCBhbmQgcmVzdW1lIG5jb25maWcuIiwKIAkJCTIs
CiAJCQkiICAgPHNhdmU+ICAgIiwKIAkJCSI8ZG9uJ3Qgc2F2ZT4iKTsKQEAgLTY2OCwxNSArNjY4
LDE1IEBAIHN0YXRpYyBpbnQgZG9fZXhpdCh2b2lkKQogCQlpZiAocmVzKQogCQkJYnRuX2RpYWxv
ZygKIAkJCQltYWluX3dpbmRvdywKLQkJCQlfKCJFcnJvciBkdXJpbmcgd3JpdGluZyBvZiBjb25m
aWd1cmF0aW9uLlxuIgotCQkJCSAgIllvdXIgY29uZmlndXJhdGlvbiBjaGFuZ2VzIHdlcmUgTk9U
IHNhdmVkLiIpLAorCQkJCSJFcnJvciBkdXJpbmcgd3JpdGluZyBvZiBjb25maWd1cmF0aW9uLlxu
IgorCQkJCSAgIllvdXIgY29uZmlndXJhdGlvbiBjaGFuZ2VzIHdlcmUgTk9UIHNhdmVkLiIsCiAJ
CQkJICAxLAogCQkJCSAgIjxPSz4iKTsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKIAkJYnRuX2RpYWxv
ZygKIAkJCW1haW5fd2luZG93LAotCQkJXygiWW91ciBjb25maWd1cmF0aW9uIGNoYW5nZXMgd2Vy
ZSBOT1Qgc2F2ZWQuIiksCisJCQkiWW91ciBjb25maWd1cmF0aW9uIGNoYW5nZXMgd2VyZSBOT1Qg
c2F2ZWQuIiwKIAkJCTEsCiAJCQkiPE9LPiIpOwogCQlicmVhazsKQEAgLTY5NSwxMiArNjk1LDEy
IEBAIHN0YXRpYyB2b2lkIHNlYXJjaF9jb25mKHZvaWQpCiAJaW50IGRyZXM7CiAKIAl0aXRsZSA9
IHN0cl9uZXcoKTsKLQlzdHJfcHJpbnRmKCAmdGl0bGUsIF8oIkVudGVyIChzdWIpc3RyaW5nIG9y
IHJlZ2V4cCB0byBzZWFyY2ggZm9yICIKLQkJCSAgICAgICIod2l0aCBvciB3aXRob3V0IFwiJXNc
IikiKSwgQ09ORklHXyk7CisJc3RyX3ByaW50ZiggJnRpdGxlLCAiRW50ZXIgKHN1YilzdHJpbmcg
b3IgcmVnZXhwIHRvIHNlYXJjaCBmb3IgIgorCQkJICAgICAgIih3aXRoIG9yIHdpdGhvdXQgXCIl
c1wiKSIsIENPTkZJR18pOwogCiBhZ2FpbjoKIAlkcmVzID0gZGlhbG9nX2lucHV0Ym94KG1haW5f
d2luZG93LAotCQkJXygiU2VhcmNoIENvbmZpZ3VyYXRpb24gUGFyYW1ldGVyIiksCisJCQkiU2Vh
cmNoIENvbmZpZ3VyYXRpb24gUGFyYW1ldGVyIiwKIAkJCXN0cl9nZXQoJnRpdGxlKSwKIAkJCSIi
LCAmZGlhbG9nX2lucHV0X3Jlc3VsdCwgJmRpYWxvZ19pbnB1dF9yZXN1bHRfbGVuKTsKIAlzd2l0
Y2ggKGRyZXMpIHsKQEAgLTcwOCw3ICs3MDgsNyBAQCBzdGF0aWMgdm9pZCBzZWFyY2hfY29uZih2
b2lkKQogCQlicmVhazsKIAljYXNlIDE6CiAJCXNob3dfc2Nyb2xsX3dpbihtYWluX3dpbmRvdywK
LQkJCQlfKCJTZWFyY2ggQ29uZmlndXJhdGlvbiIpLCBzZWFyY2hfaGVscCk7CisJCQkJIlNlYXJj
aCBDb25maWd1cmF0aW9uIiwgc2VhcmNoX2hlbHApOwogCQlnb3RvIGFnYWluOwogCWRlZmF1bHQ6
CiAJCXN0cl9mcmVlKCZ0aXRsZSk7CkBAIC03MjQsNyArNzI0LDcgQEAgc3RhdGljIHZvaWQgc2Vh
cmNoX2NvbmYodm9pZCkKIAlyZXMgPSBnZXRfcmVsYXRpb25zX3N0cihzeW1fYXJyLCBOVUxMKTsK
IAlmcmVlKHN5bV9hcnIpOwogCXNob3dfc2Nyb2xsX3dpbihtYWluX3dpbmRvdywKLQkJCV8oIlNl
YXJjaCBSZXN1bHRzIiksIHN0cl9nZXQoJnJlcykpOworCQkJIlNlYXJjaCBSZXN1bHRzIiwgc3Ry
X2dldCgmcmVzKSk7CiAJc3RyX2ZyZWUoJnJlcyk7CiAJc3RyX2ZyZWUoJnRpdGxlKTsKIH0KQEAg
LTc1Miw3ICs3NTIsNyBAQCBzdGF0aWMgdm9pZCBidWlsZF9jb25mKHN0cnVjdCBtZW51ICptZW51
KQogCQkJc3dpdGNoIChwdHlwZSkgewogCQkJY2FzZSBQX01FTlU6CiAJCQkJY2hpbGRfY291bnQr
KzsKLQkJCQlwcm9tcHQgPSBfKHByb21wdCk7CisJCQkJcHJvbXB0ID0gcHJvbXB0OwogCQkJCWlm
IChzaW5nbGVfbWVudV9tb2RlKSB7CiAJCQkJCWl0ZW1fbWFrZShtZW51LCAnbScsCiAJCQkJCQki
JXMlKmMlcyIsCkBAIC03NzMsNyArNzczLDcgQEAgc3RhdGljIHZvaWQgYnVpbGRfY29uZihzdHJ1
Y3QgbWVudSAqbWVudSkKIAkJCQkJaXRlbV9tYWtlKG1lbnUsICc6JywKIAkJCQkJCSIgICAlKmMq
KiogJXMgKioqIiwKIAkJCQkJCWluZGVudCArIDEsICcgJywKLQkJCQkJCV8ocHJvbXB0KSk7CisJ
CQkJCQlwcm9tcHQpOwogCQkJCX0KIAkJCQlicmVhazsKIAkJCWRlZmF1bHQ6CkBAIC03ODEsNyAr
NzgxLDcgQEAgc3RhdGljIHZvaWQgYnVpbGRfY29uZihzdHJ1Y3QgbWVudSAqbWVudSkKIAkJCQkJ
Y2hpbGRfY291bnQrKzsKIAkJCQkJaXRlbV9tYWtlKG1lbnUsICc6JywgIi0tLSUqYyVzIiwKIAkJ
CQkJCWluZGVudCArIDEsICcgJywKLQkJCQkJCV8ocHJvbXB0KSk7CisJCQkJCQlwcm9tcHQpOwog
CQkJCX0KIAkJCX0KIAkJfSBlbHNlCkBAIC04MjcsMTEgKzgyNywxMSBAQCBzdGF0aWMgdm9pZCBi
dWlsZF9jb25mKHN0cnVjdCBtZW51ICptZW51KQogCQl9CiAKIAkJaXRlbV9hZGRfc3RyKCIlKmMl
cyIsIGluZGVudCArIDEsCi0JCQkJJyAnLCBfKG1lbnVfZ2V0X3Byb21wdChtZW51KSkpOworCQkJ
CScgJywgbWVudV9nZXRfcHJvbXB0KG1lbnUpKTsKIAkJaWYgKHZhbCA9PSB5ZXMpIHsKIAkJCWlm
IChkZWZfbWVudSkgewogCQkJCWl0ZW1fYWRkX3N0cigiICglcykiLAotCQkJCQlfKG1lbnVfZ2V0
X3Byb21wdChkZWZfbWVudSkpKTsKKwkJCQkJbWVudV9nZXRfcHJvbXB0KGRlZl9tZW51KSk7CiAJ
CQkJaXRlbV9hZGRfc3RyKCIgIC0tLT4iKTsKIAkJCQlpZiAoZGVmX21lbnUtPmxpc3QpIHsKIAkJ
CQkJaW5kZW50ICs9IDI7CkBAIC04NDUsNyArODQ1LDcgQEAgc3RhdGljIHZvaWQgYnVpbGRfY29u
ZihzdHJ1Y3QgbWVudSAqbWVudSkKIAkJaWYgKG1lbnUgPT0gY3VycmVudF9tZW51KSB7CiAJCQlp
dGVtX21ha2UobWVudSwgJzonLAogCQkJCSItLS0lKmMlcyIsIGluZGVudCArIDEsCi0JCQkJJyAn
LCBfKG1lbnVfZ2V0X3Byb21wdChtZW51KSkpOworCQkJCScgJywgbWVudV9nZXRfcHJvbXB0KG1l
bnUpKTsKIAkJCWdvdG8gY29uZl9jaGlsZHM7CiAJCX0KIAkJY2hpbGRfY291bnQrKzsKQEAgLTg5
MiwxNyArODkyLDE3IEBAIHN0YXRpYyB2b2lkIGJ1aWxkX2NvbmYoc3RydWN0IG1lbnUgKm1lbnUp
CiAJCQkJaWYgKHRtcCA8IDApCiAJCQkJCXRtcCA9IDA7CiAJCQkJaXRlbV9hZGRfc3RyKCIlKmMl
cyVzIiwgdG1wLCAnICcsCi0JCQkJCQlfKG1lbnVfZ2V0X3Byb21wdChtZW51KSksCisJCQkJCQlt
ZW51X2dldF9wcm9tcHQobWVudSksCiAJCQkJCQkoc3ltX2hhc192YWx1ZShzeW0pIHx8CiAJCQkJ
CQkgIXN5bV9pc19jaGFuZ2FibGUoc3ltKSkgPyAiIiA6Ci0JCQkJCQlfKCIgKE5FVykiKSk7CisJ
CQkJCQkiIChORVcpIik7CiAJCQkJZ290byBjb25mX2NoaWxkczsKIAkJCX0KIAkJfQogCQlpdGVt
X2FkZF9zdHIoIiUqYyVzJXMiLCBpbmRlbnQgKyAxLCAnICcsCi0JCQkJXyhtZW51X2dldF9wcm9t
cHQobWVudSkpLAorCQkJCW1lbnVfZ2V0X3Byb21wdChtZW51KSwKIAkJCQkoc3ltX2hhc192YWx1
ZShzeW0pIHx8ICFzeW1faXNfY2hhbmdhYmxlKHN5bSkpID8KLQkJCQkiIiA6IF8oIiAoTkVXKSIp
KTsKKwkJCQkiIiA6ICIgKE5FVykiKTsKIAkJaWYgKG1lbnUtPnByb21wdCAmJiBtZW51LT5wcm9t
cHQtPnR5cGUgPT0gUF9NRU5VKSB7CiAJCQlpdGVtX2FkZF9zdHIoIiAgJXMiLCBtZW51X2lzX2Vt
cHR5KG1lbnUpID8gIi0tLS0iIDogIi0tLT4iKTsKIAkJCXJldHVybjsKQEAgLTEwODQsOCArMTA4
NCw4IEBAIHN0YXRpYyB2b2lkIGNvbmYoc3RydWN0IG1lbnUgKm1lbnUpCiAJCWlmICghY2hpbGRf
Y291bnQpCiAJCQlicmVhazsKIAotCQlzaG93X21lbnUocHJvbXB0ID8gXyhwcm9tcHQpIDogXygi
TWFpbiBNZW51IiksCi0JCQkJXyhtZW51X2luc3RydWN0aW9ucyksCisJCXNob3dfbWVudShwcm9t
cHQgPyBwcm9tcHQgOiAiTWFpbiBNZW51IiwKKwkJCQltZW51X2luc3RydWN0aW9ucywKIAkJCQlj
dXJyZW50X2luZGV4LCAmbGFzdF90b3Bfcm93KTsKIAkJa2V5cGFkKChtZW51X3dpbihjdXJzZXNf
bWVudSkpLCBUUlVFKTsKIAkJd2hpbGUgKCFnbG9iYWxfZXhpdCkgewpAQCAtMTIyNSwxMyArMTIy
NSwxMyBAQCBzdGF0aWMgdm9pZCBzaG93X2hlbHAoc3RydWN0IG1lbnUgKm1lbnUpCiAKIAloZWxw
ID0gc3RyX25ldygpOwogCW1lbnVfZ2V0X2V4dF9oZWxwKG1lbnUsICZoZWxwKTsKLQlzaG93X3Nj
cm9sbF93aW4obWFpbl93aW5kb3csIF8obWVudV9nZXRfcHJvbXB0KG1lbnUpKSwgc3RyX2dldCgm
aGVscCkpOworCXNob3dfc2Nyb2xsX3dpbihtYWluX3dpbmRvdywgbWVudV9nZXRfcHJvbXB0KG1l
bnUpLCBzdHJfZ2V0KCZoZWxwKSk7CiAJc3RyX2ZyZWUoJmhlbHApOwogfQogCiBzdGF0aWMgdm9p
ZCBjb25mX2Nob2ljZShzdHJ1Y3QgbWVudSAqbWVudSkKIHsKLQljb25zdCBjaGFyICpwcm9tcHQg
PSBfKG1lbnVfZ2V0X3Byb21wdChtZW51KSk7CisJY29uc3QgY2hhciAqcHJvbXB0ID0gbWVudV9n
ZXRfcHJvbXB0KG1lbnUpOwogCXN0cnVjdCBtZW51ICpjaGlsZCA9IDA7CiAJc3RydWN0IHN5bWJv
bCAqYWN0aXZlOwogCWludCBzZWxlY3RlZF9pbmRleCA9IDA7CkBAIC0xMjU0LDEzICsxMjU0LDEz
IEBAIHN0YXRpYyB2b2lkIGNvbmZfY2hvaWNlKHN0cnVjdCBtZW51ICptZW51KQogCiAJCQlpZiAo
Y2hpbGQtPnN5bSA9PSBzeW1fZ2V0X2Nob2ljZV92YWx1ZShtZW51LT5zeW0pKQogCQkJCWl0ZW1f
bWFrZShjaGlsZCwgJzonLCAiPFg+ICVzIiwKLQkJCQkJCV8obWVudV9nZXRfcHJvbXB0KGNoaWxk
KSkpOworCQkJCQkJbWVudV9nZXRfcHJvbXB0KGNoaWxkKSk7CiAJCQllbHNlIGlmIChjaGlsZC0+
c3ltKQogCQkJCWl0ZW1fbWFrZShjaGlsZCwgJzonLCAiICAgICVzIiwKLQkJCQkJCV8obWVudV9n
ZXRfcHJvbXB0KGNoaWxkKSkpOworCQkJCQkJbWVudV9nZXRfcHJvbXB0KGNoaWxkKSk7CiAJCQll
bHNlCiAJCQkJaXRlbV9tYWtlKGNoaWxkLCAnOicsICIqKiogJXMgKioqIiwKLQkJCQkJCV8obWVu
dV9nZXRfcHJvbXB0KGNoaWxkKSkpOworCQkJCQkJbWVudV9nZXRfcHJvbXB0KGNoaWxkKSk7CiAK
IAkJCWlmIChjaGlsZC0+c3ltID09IGFjdGl2ZSl7CiAJCQkJbGFzdF90b3Bfcm93ID0gdG9wX3Jv
dyhjdXJzZXNfbWVudSk7CkBAIC0xMjY4LDggKzEyNjgsOCBAQCBzdGF0aWMgdm9pZCBjb25mX2No
b2ljZShzdHJ1Y3QgbWVudSAqbWVudSkKIAkJCX0KIAkJCWkrKzsKIAkJfQotCQlzaG93X21lbnUo
cHJvbXB0ID8gXyhwcm9tcHQpIDogXygiQ2hvaWNlIE1lbnUiKSwKLQkJCQlfKHJhZGlvbGlzdF9p
bnN0cnVjdGlvbnMpLAorCQlzaG93X21lbnUocHJvbXB0ID8gcHJvbXB0IDogIkNob2ljZSBNZW51
IiwKKwkJCQlyYWRpb2xpc3RfaW5zdHJ1Y3Rpb25zLAogCQkJCXNlbGVjdGVkX2luZGV4LAogCQkJ
CSZsYXN0X3RvcF9yb3cpOwogCQl3aGlsZSAoIWdsb2JhbF9leGl0KSB7CkBAIC0xMzU2LDE5ICsx
MzU2LDE5IEBAIHN0YXRpYyB2b2lkIGNvbmZfc3RyaW5nKHN0cnVjdCBtZW51ICptZW51KQogCiAJ
CXN3aXRjaCAoc3ltX2dldF90eXBlKG1lbnUtPnN5bSkpIHsKIAkJY2FzZSBTX0lOVDoKLQkJCWhl
YWRpbmcgPSBfKGlucHV0Ym94X2luc3RydWN0aW9uc19pbnQpOworCQkJaGVhZGluZyA9IGlucHV0
Ym94X2luc3RydWN0aW9uc19pbnQ7CiAJCQlicmVhazsKIAkJY2FzZSBTX0hFWDoKLQkJCWhlYWRp
bmcgPSBfKGlucHV0Ym94X2luc3RydWN0aW9uc19oZXgpOworCQkJaGVhZGluZyA9IGlucHV0Ym94
X2luc3RydWN0aW9uc19oZXg7CiAJCQlicmVhazsKIAkJY2FzZSBTX1NUUklORzoKLQkJCWhlYWRp
bmcgPSBfKGlucHV0Ym94X2luc3RydWN0aW9uc19zdHJpbmcpOworCQkJaGVhZGluZyA9IGlucHV0
Ym94X2luc3RydWN0aW9uc19zdHJpbmc7CiAJCQlicmVhazsKIAkJZGVmYXVsdDoKLQkJCWhlYWRp
bmcgPSBfKCJJbnRlcm5hbCBuY29uZiBlcnJvciEiKTsKKwkJCWhlYWRpbmcgPSAiSW50ZXJuYWwg
bmNvbmYgZXJyb3IhIjsKIAkJfQogCQlyZXMgPSBkaWFsb2dfaW5wdXRib3gobWFpbl93aW5kb3cs
Ci0JCQkJcHJvbXB0ID8gXyhwcm9tcHQpIDogXygiTWFpbiBNZW51IiksCisJCQkJcHJvbXB0ID8g
cHJvbXB0IDogIk1haW4gTWVudSIsCiAJCQkJaGVhZGluZywKIAkJCQlzeW1fZ2V0X3N0cmluZ192
YWx1ZShtZW51LT5zeW0pLAogCQkJCSZkaWFsb2dfaW5wdXRfcmVzdWx0LApAQCAtMTM3OSw3ICsx
Mzc5LDcgQEAgc3RhdGljIHZvaWQgY29uZl9zdHJpbmcoc3RydWN0IG1lbnUgKm1lbnUpCiAJCQkJ
CQlkaWFsb2dfaW5wdXRfcmVzdWx0KSkKIAkJCQlyZXR1cm47CiAJCQlidG5fZGlhbG9nKG1haW5f
d2luZG93LAotCQkJCV8oIllvdSBoYXZlIG1hZGUgYW4gaW52YWxpZCBlbnRyeS4iKSwgMCk7CisJ
CQkJIllvdSBoYXZlIG1hZGUgYW4gaW52YWxpZCBlbnRyeS4iLCAwKTsKIAkJCWJyZWFrOwogCQlj
YXNlIDE6CiAJCQlzaG93X2hlbHAobWVudSk7CkBAIC0xNDA4LDExICsxNDA4LDExIEBAIHN0YXRp
YyB2b2lkIGNvbmZfbG9hZCh2b2lkKQogCQkJCXN5bV9zZXRfY2hhbmdlX2NvdW50KDEpOwogCQkJ
CXJldHVybjsKIAkJCX0KLQkJCWJ0bl9kaWFsb2cobWFpbl93aW5kb3csIF8oIkZpbGUgZG9lcyBu
b3QgZXhpc3QhIiksIDApOworCQkJYnRuX2RpYWxvZyhtYWluX3dpbmRvdywgIkZpbGUgZG9lcyBu
b3QgZXhpc3QhIiwgMCk7CiAJCQlicmVhazsKIAkJY2FzZSAxOgogCQkJc2hvd19zY3JvbGxfd2lu
KG1haW5fd2luZG93LAotCQkJCQlfKCJMb2FkIEFsdGVybmF0ZSBDb25maWd1cmF0aW9uIiksCisJ
CQkJCSJMb2FkIEFsdGVybmF0ZSBDb25maWd1cmF0aW9uIiwKIAkJCQkJbG9hZF9jb25maWdfaGVs
cCk7CiAJCQlicmVhazsKIAkJY2FzZSBLRVlfRVhJVDoKQEAgLTE0MzksMTMgKzE0MzksMTMgQEAg
c3RhdGljIHZvaWQgY29uZl9zYXZlKHZvaWQpCiAJCQkJc2V0X2NvbmZpZ19maWxlbmFtZShkaWFs
b2dfaW5wdXRfcmVzdWx0KTsKIAkJCQlyZXR1cm47CiAJCQl9Ci0JCQlidG5fZGlhbG9nKG1haW5f
d2luZG93LCBfKCJDYW4ndCBjcmVhdGUgZmlsZSEgIgotCQkJCSJQcm9iYWJseSBhIG5vbmV4aXN0
ZW50IGRpcmVjdG9yeS4iKSwKKwkJCWJ0bl9kaWFsb2cobWFpbl93aW5kb3csICJDYW4ndCBjcmVh
dGUgZmlsZSEgIgorCQkJCSJQcm9iYWJseSBhIG5vbmV4aXN0ZW50IGRpcmVjdG9yeS4iLAogCQkJ
CTEsICI8T0s+Iik7CiAJCQlicmVhazsKIAkJY2FzZSAxOgogCQkJc2hvd19zY3JvbGxfd2luKG1h
aW5fd2luZG93LAotCQkJCV8oIlNhdmUgQWx0ZXJuYXRlIENvbmZpZ3VyYXRpb24iKSwKKwkJCQki
U2F2ZSBBbHRlcm5hdGUgQ29uZmlndXJhdGlvbiIsCiAJCQkJc2F2ZV9jb25maWdfaGVscCk7CiAJ
CQlicmVhazsKIAkJY2FzZSBLRVlfRVhJVDoKQEAgLTE0NzgsMTAgKzE0NzgsNiBAQCBpbnQgbWFp
bihpbnQgYWMsIGNoYXIgKiphdikKIAlpbnQgbGluZXMsIGNvbHVtbnM7CiAJY2hhciAqbW9kZTsK
IAotCXNldGxvY2FsZShMQ19BTEwsICIiKTsKLQliaW5kdGV4dGRvbWFpbihQQUNLQUdFLCBMT0NB
TEVESVIpOwotCXRleHRkb21haW4oUEFDS0FHRSk7Ci0KIAlpZiAoYWMgPiAxICYmIHN0cmNtcChh
dlsxXSwgIi1zIikgPT0gMCkgewogCQkvKiBTaWxlbmNlIGNvbmZfcmVhZCgpIHVudGlsIHRoZSBy
ZWFsIGNhbGxiYWNrIGlzIHNldCB1cCAqLwogCQljb25mX3NldF9tZXNzYWdlX2NhbGxiYWNrKE5V
TEwpOwpAQCAtMTUzOSw4ICsxNTM1LDggQEAgaW50IG1haW4oaW50IGFjLCBjaGFyICoqYXYpCiAJ
LyogY2hlY2sgZm9yIEtFWV9GVU5DKDEpICovCiAJaWYgKGhhc19rZXkoS0VZX0YoMSkpID09IEZB
TFNFKSB7CiAJCXNob3dfc2Nyb2xsX3dpbihtYWluX3dpbmRvdywKLQkJCQlfKCJJbnN0cnVjdGlv
bnMiKSwKLQkJCQlfKG1lbnVfbm9fZl9pbnN0cnVjdGlvbnMpKTsKKwkJCQkiSW5zdHJ1Y3Rpb25z
IiwKKwkJCQltZW51X25vX2ZfaW5zdHJ1Y3Rpb25zKTsKIAl9CiAKIAljb25mX3NldF9tZXNzYWdl
X2NhbGxiYWNrKGNvbmZfbWVzc2FnZV9jYWxsYmFjayk7CmRpZmYgLS1naXQgYS94ZW4vdG9vbHMv
a2NvbmZpZy9uY29uZi5oIGIveGVuL3Rvb2xzL2tjb25maWcvbmNvbmYuaAppbmRleCAwZDUyNjE3
MDVlLi41ZTk2ODE2M2E0IDEwMDY0NAotLS0gYS94ZW4vdG9vbHMva2NvbmZpZy9uY29uZi5oCisr
KyBiL3hlbi90b29scy9rY29uZmlnL25jb25mLmgKQEAgLTE0LDcgKzE0LDYgQEAKICNpbmNsdWRl
IDxzdGRsaWIuaD4KICNpbmNsdWRlIDxzdHJpbmcuaD4KICNpbmNsdWRlIDx1bmlzdGQuaD4KLSNp
bmNsdWRlIDxsb2NhbGUuaD4KICNpbmNsdWRlIDxjdXJzZXMuaD4KICNpbmNsdWRlIDxtZW51Lmg+
CiAjaW5jbHVkZSA8cGFuZWwuaD4KZGlmZiAtLWdpdCBhL3hlbi90b29scy9rY29uZmlnL3Fjb25m
LmNjIGIveGVuL3Rvb2xzL2tjb25maWcvcWNvbmYuY2MKaW5kZXggYzNiYjdmZThkZi4uZTE0MGFi
MDBhYiAxMDA2NDQKLS0tIGEveGVuL3Rvb2xzL2tjb25maWcvcWNvbmYuY2MKKysrIGIveGVuL3Rv
b2xzL2tjb25maWcvcWNvbmYuY2MKQEAgLTQ5LDEwICs0OSw2IEBACiAjaW5jbHVkZSAicWNvbmYu
bW9jIgogI2luY2x1ZGUgImltYWdlcy5jIgogCi0jaWZkZWYgXwotIyB1bmRlZiBfCi0jIGRlZmlu
ZSBfIHFnZXR0ZXh0Ci0jZW5kaWYKIAogc3RhdGljIFFBcHBsaWNhdGlvbiAqY29uZmlnQXBwOwog
c3RhdGljIENvbmZpZ1NldHRpbmdzICpjb25maWdTZXR0aW5nczsKQEAgLTYxLDEyICs1Nyw3IEBA
IFEzQWN0aW9uICpDb25maWdNYWluV2luZG93OjpzYXZlQWN0aW9uOwogCiBzdGF0aWMgaW5saW5l
IFFTdHJpbmcgcWdldHRleHQoY29uc3QgY2hhciogc3RyKQogewotCXJldHVybiBRU3RyaW5nOjpm
cm9tTG9jYWw4Qml0KGdldHRleHQoc3RyKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgUVN0cmluZyBx
Z2V0dGV4dChjb25zdCBRU3RyaW5nJiBzdHIpCi17Ci0JcmV0dXJuIFFTdHJpbmc6OmZyb21Mb2Nh
bDhCaXQoZ2V0dGV4dChzdHIubGF0aW4xKCkpKTsKKwlyZXR1cm4gUVN0cmluZzo6ZnJvbUxvY2Fs
OEJpdChzdHIpOwogfQogCiBDb25maWdTZXR0aW5nczo6Q29uZmlnU2V0dGluZ3MoKQpAQCAtMTM1
LDcgKzEyNiw3IEBAIHZvaWQgQ29uZmlnSXRlbTo6dXBkYXRlTWVudSh2b2lkKQogCiAJc3ltID0g
bWVudS0+c3ltOwogCXByb3AgPSBtZW51LT5wcm9tcHQ7Ci0JcHJvbXB0ID0gXyhtZW51X2dldF9w
cm9tcHQobWVudSkpOworCXByb21wdCA9IHFnZXR0ZXh0KG1lbnVfZ2V0X3Byb21wdChtZW51KSk7
CiAKIAlpZiAocHJvcCkgc3dpdGNoIChwcm9wLT50eXBlKSB7CiAJY2FzZSBQX01FTlU6CkBAIC0y
MjcsNyArMjE4LDcgQEAgdm9pZCBDb25maWdJdGVtOjp1cGRhdGVNZW51KHZvaWQpCiAJCWJyZWFr
OwogCX0KIAlpZiAoIXN5bV9oYXNfdmFsdWUoc3ltKSAmJiB2aXNpYmxlKQotCQlwcm9tcHQgKz0g
XygiIChORVcpIik7CisJCXByb21wdCArPSAiIChORVcpIjsKIHNldF9wcm9tcHQ6CiAJc2V0VGV4
dChwcm9tcHRDb2xJZHgsIHByb21wdCk7CiB9CkBAIC0zNjUsNyArMzU2LDcgQEAgQ29uZmlnTGlz
dDo6Q29uZmlnTGlzdChDb25maWdWaWV3KiBwLCBjb25zdCBjaGFyICpuYW1lKQogCiAJZm9yIChp
ID0gMDsgaSA8IGNvbE5yOyBpKyspCiAJCWNvbE1hcFtpXSA9IGNvbFJldk1hcFtpXSA9IC0xOwot
CWFkZENvbHVtbihwcm9tcHRDb2xJZHgsIF8oIk9wdGlvbiIpKTsKKwlhZGRDb2x1bW4ocHJvbXB0
Q29sSWR4LCAiT3B0aW9uIik7CiAKIAlyZWluaXQoKTsKIH0KQEAgLTM5MCwxNCArMzgxLDE0IEBA
IHZvaWQgQ29uZmlnTGlzdDo6cmVpbml0KHZvaWQpCiAJcmVtb3ZlQ29sdW1uKG5hbWVDb2xJZHgp
OwogCiAJaWYgKHNob3dOYW1lKQotCQlhZGRDb2x1bW4obmFtZUNvbElkeCwgXygiTmFtZSIpKTsK
KwkJYWRkQ29sdW1uKG5hbWVDb2xJZHgsICJOYW1lIik7CiAJaWYgKHNob3dSYW5nZSkgewogCQlh
ZGRDb2x1bW4obm9Db2xJZHgsICJOIik7CiAJCWFkZENvbHVtbihtb2RDb2xJZHgsICJNIik7CiAJ
CWFkZENvbHVtbih5ZXNDb2xJZHgsICJZIik7CiAJfQogCWlmIChzaG93RGF0YSkKLQkJYWRkQ29s
dW1uKGRhdGFDb2xJZHgsIF8oIlZhbHVlIikpOworCQlhZGRDb2x1bW4oZGF0YUNvbElkeCwgIlZh
bHVlIik7CiAKIAl1cGRhdGVMaXN0QWxsKCk7CiB9CkBAIC04MzEsNyArODIyLDcgQEAgdm9pZCBD
b25maWdMaXN0Ojpjb250ZXh0TWVudUV2ZW50KFFDb250ZXh0TWVudUV2ZW50ICplKQogCQkJUTNB
Y3Rpb24gKmFjdGlvbjsKIAogCQkJaGVhZGVyUG9wdXAgPSBuZXcgUTNQb3B1cE1lbnUodGhpcyk7
Ci0JCQlhY3Rpb24gPSBuZXcgUTNBY3Rpb24oTlVMTCwgXygiU2hvdyBOYW1lIiksIDAsIHRoaXMp
OworCQkJYWN0aW9uID0gbmV3IFEzQWN0aW9uKE5VTEwsICJTaG93IE5hbWUiLCAwLCB0aGlzKTsK
IAkJCSAgYWN0aW9uLT5zZXRUb2dnbGVBY3Rpb24oVFJVRSk7CiAJCQkgIGNvbm5lY3QoYWN0aW9u
LCBTSUdOQUwodG9nZ2xlZChib29sKSksCiAJCQkJICBwYXJlbnQoKSwgU0xPVChzZXRTaG93TmFt
ZShib29sKSkpOwpAQCAtODM5LDcgKzgzMCw3IEBAIHZvaWQgQ29uZmlnTGlzdDo6Y29udGV4dE1l
bnVFdmVudChRQ29udGV4dE1lbnVFdmVudCAqZSkKIAkJCQkgIGFjdGlvbiwgU0xPVChzZXRPbihi
b29sKSkpOwogCQkJICBhY3Rpb24tPnNldE9uKHNob3dOYW1lKTsKIAkJCSAgYWN0aW9uLT5hZGRU
byhoZWFkZXJQb3B1cCk7Ci0JCQlhY3Rpb24gPSBuZXcgUTNBY3Rpb24oTlVMTCwgXygiU2hvdyBS
YW5nZSIpLCAwLCB0aGlzKTsKKwkJCWFjdGlvbiA9IG5ldyBRM0FjdGlvbihOVUxMLCAiU2hvdyBS
YW5nZSIsIDAsIHRoaXMpOwogCQkJICBhY3Rpb24tPnNldFRvZ2dsZUFjdGlvbihUUlVFKTsKIAkJ
CSAgY29ubmVjdChhY3Rpb24sIFNJR05BTCh0b2dnbGVkKGJvb2wpKSwKIAkJCQkgIHBhcmVudCgp
LCBTTE9UKHNldFNob3dSYW5nZShib29sKSkpOwpAQCAtODQ3LDcgKzgzOCw3IEBAIHZvaWQgQ29u
ZmlnTGlzdDo6Y29udGV4dE1lbnVFdmVudChRQ29udGV4dE1lbnVFdmVudCAqZSkKIAkJCQkgIGFj
dGlvbiwgU0xPVChzZXRPbihib29sKSkpOwogCQkJICBhY3Rpb24tPnNldE9uKHNob3dSYW5nZSk7
CiAJCQkgIGFjdGlvbi0+YWRkVG8oaGVhZGVyUG9wdXApOwotCQkJYWN0aW9uID0gbmV3IFEzQWN0
aW9uKE5VTEwsIF8oIlNob3cgRGF0YSIpLCAwLCB0aGlzKTsKKwkJCWFjdGlvbiA9IG5ldyBRM0Fj
dGlvbihOVUxMLCAiU2hvdyBEYXRhIiwgMCwgdGhpcyk7CiAJCQkgIGFjdGlvbi0+c2V0VG9nZ2xl
QWN0aW9uKFRSVUUpOwogCQkJICBjb25uZWN0KGFjdGlvbiwgU0lHTkFMKHRvZ2dsZWQoYm9vbCkp
LAogCQkJCSAgcGFyZW50KCksIFNMT1Qoc2V0U2hvd0RhdGEoYm9vbCkpKTsKQEAgLTEwMjIsNyAr
MTAxMyw3IEBAIHZvaWQgQ29uZmlnSW5mb1ZpZXc6Om1lbnVJbmZvKHZvaWQpCiAJaWYgKHN5bSkg
ewogCQlpZiAoX21lbnUtPnByb21wdCkgewogCQkJaGVhZCArPSAiPGJpZz48Yj4iOwotCQkJaGVh
ZCArPSBwcmludF9maWx0ZXIoXyhfbWVudS0+cHJvbXB0LT50ZXh0KSk7CisJCQloZWFkICs9IHBy
aW50X2ZpbHRlcihfbWVudS0+cHJvbXB0LT50ZXh0KTsKIAkJCWhlYWQgKz0gIjwvYj48L2JpZz4i
OwogCQkJaWYgKHN5bS0+bmFtZSkgewogCQkJCWhlYWQgKz0gIiAoIjsKQEAgLTEwNTMsNyArMTA0
NCw3IEBAIHZvaWQgQ29uZmlnSW5mb1ZpZXc6Om1lbnVJbmZvKHZvaWQpCiAJCXN0cl9mcmVlKCZo
ZWxwX2dzdHIpOwogCX0gZWxzZSBpZiAoX21lbnUtPnByb21wdCkgewogCQloZWFkICs9ICI8Ymln
PjxiPiI7Ci0JCWhlYWQgKz0gcHJpbnRfZmlsdGVyKF8oX21lbnUtPnByb21wdC0+dGV4dCkpOwor
CQloZWFkICs9IHByaW50X2ZpbHRlcihfbWVudS0+cHJvbXB0LT50ZXh0KTsKIAkJaGVhZCArPSAi
PC9iPjwvYmlnPjxicj48YnI+IjsKIAkJaWYgKHNob3dEZWJ1ZygpKSB7CiAJCQlpZiAoX21lbnUt
PnByb21wdC0+dmlzaWJsZS5leHByKSB7CkBAIC0xMDg4LDcgKzEwNzksNyBAQCBRU3RyaW5nIENv
bmZpZ0luZm9WaWV3OjpkZWJ1Z19pbmZvKHN0cnVjdCBzeW1ib2wgKnN5bSkKIAkJY2FzZSBQX1BS
T01QVDoKIAkJY2FzZSBQX01FTlU6CiAJCQlkZWJ1ZyArPSBRU3RyaW5nKCkuc3ByaW50ZigicHJv
bXB0OiA8YSBocmVmPVwibSVwXCI+IiwgcHJvcC0+bWVudSk7Ci0JCQlkZWJ1ZyArPSBwcmludF9m
aWx0ZXIoXyhwcm9wLT50ZXh0KSk7CisJCQlkZWJ1ZyArPSBwcmludF9maWx0ZXIocHJvcC0+dGV4
dCk7CiAJCQlkZWJ1ZyArPSAiPC9hPjxicj4iOwogCQkJYnJlYWs7CiAJCWNhc2UgUF9ERUZBVUxU
OgpAQCAtMTE3MCw3ICsxMTYxLDcgQEAgdm9pZCBDb25maWdJbmZvVmlldzo6ZXhwcl9wcmludF9o
ZWxwKHZvaWQgKmRhdGEsIHN0cnVjdCBzeW1ib2wgKnN5bSwgY29uc3QgY2hhcgogUTNQb3B1cE1l
bnUqIENvbmZpZ0luZm9WaWV3OjpjcmVhdGVQb3B1cE1lbnUoY29uc3QgUVBvaW50JiBwb3MpCiB7
CiAJUTNQb3B1cE1lbnUqIHBvcHVwID0gUGFyZW50OjpjcmVhdGVQb3B1cE1lbnUocG9zKTsKLQlR
M0FjdGlvbiogYWN0aW9uID0gbmV3IFEzQWN0aW9uKE5VTEwsIF8oIlNob3cgRGVidWcgSW5mbyIp
LCAwLCBwb3B1cCk7CisJUTNBY3Rpb24qIGFjdGlvbiA9IG5ldyBRM0FjdGlvbihOVUxMLCAiU2hv
dyBEZWJ1ZyBJbmZvIiwgMCwgcG9wdXApOwogCSAgYWN0aW9uLT5zZXRUb2dnbGVBY3Rpb24oVFJV
RSk7CiAJICBjb25uZWN0KGFjdGlvbiwgU0lHTkFMKHRvZ2dsZWQoYm9vbCkpLCBTTE9UKHNldFNo
b3dEZWJ1Zyhib29sKSkpOwogCSAgY29ubmVjdCh0aGlzLCBTSUdOQUwoc2hvd0RlYnVnQ2hhbmdl
ZChib29sKSksIGFjdGlvbiwgU0xPVChzZXRPbihib29sKSkpOwpAQCAtMTE5MiwxMSArMTE4Mywx
MSBAQCBDb25maWdTZWFyY2hXaW5kb3c6OkNvbmZpZ1NlYXJjaFdpbmRvdyhDb25maWdNYWluV2lu
ZG93KiBwYXJlbnQsIGNvbnN0IGNoYXIgKm5hbQogCiAJUVZCb3hMYXlvdXQqIGxheW91dDEgPSBu
ZXcgUVZCb3hMYXlvdXQodGhpcywgMTEsIDYpOwogCVFIQm94TGF5b3V0KiBsYXlvdXQyID0gbmV3
IFFIQm94TGF5b3V0KDAsIDAsIDYpOwotCWxheW91dDItPmFkZFdpZGdldChuZXcgUUxhYmVsKF8o
IkZpbmQ6IiksIHRoaXMpKTsKKwlsYXlvdXQyLT5hZGRXaWRnZXQobmV3IFFMYWJlbCgiRmluZDoi
LCB0aGlzKSk7CiAJZWRpdEZpZWxkID0gbmV3IFFMaW5lRWRpdCh0aGlzKTsKIAljb25uZWN0KGVk
aXRGaWVsZCwgU0lHTkFMKHJldHVyblByZXNzZWQoKSksIFNMT1Qoc2VhcmNoKCkpKTsKIAlsYXlv
dXQyLT5hZGRXaWRnZXQoZWRpdEZpZWxkKTsKLQlzZWFyY2hCdXR0b24gPSBuZXcgUVB1c2hCdXR0
b24oXygiU2VhcmNoIiksIHRoaXMpOworCXNlYXJjaEJ1dHRvbiA9IG5ldyBRUHVzaEJ1dHRvbigi
U2VhcmNoIiwgdGhpcyk7CiAJc2VhcmNoQnV0dG9uLT5zZXRBdXRvRGVmYXVsdChGQUxTRSk7CiAJ
Y29ubmVjdChzZWFyY2hCdXR0b24sIFNJR05BTChjbGlja2VkKCkpLCBTTE9UKHNlYXJjaCgpKSk7
CiAJbGF5b3V0Mi0+YWRkV2lkZ2V0KHNlYXJjaEJ1dHRvbik7CkBAIC0xMzIyLDQwICsxMzEzLDQw
IEBAIENvbmZpZ01haW5XaW5kb3c6OkNvbmZpZ01haW5XaW5kb3codm9pZCkKIAltZW51ID0gbWVu
dUJhcigpOwogCXRvb2xCYXIgPSBuZXcgUTNUb29sQmFyKCJUb29scyIsIHRoaXMpOwogCi0JYmFj
a0FjdGlvbiA9IG5ldyBRM0FjdGlvbigiQmFjayIsIFFQaXhtYXAoeHBtX2JhY2spLCBfKCJCYWNr
IiksIDAsIHRoaXMpOworCWJhY2tBY3Rpb24gPSBuZXcgUTNBY3Rpb24oIkJhY2siLCBRUGl4bWFw
KHhwbV9iYWNrKSwgIkJhY2siLCAwLCB0aGlzKTsKIAkgIGNvbm5lY3QoYmFja0FjdGlvbiwgU0lH
TkFMKGFjdGl2YXRlZCgpKSwgU0xPVChnb0JhY2soKSkpOwogCSAgYmFja0FjdGlvbi0+c2V0RW5h
YmxlZChGQUxTRSk7Ci0JUTNBY3Rpb24gKnF1aXRBY3Rpb24gPSBuZXcgUTNBY3Rpb24oIlF1aXQi
LCBfKCImUXVpdCIpLCBRdDo6Q1RSTCArIFF0OjpLZXlfUSwgdGhpcyk7CisJUTNBY3Rpb24gKnF1
aXRBY3Rpb24gPSBuZXcgUTNBY3Rpb24oIlF1aXQiLCAiJlF1aXQiLCBRdDo6Q1RSTCArIFF0OjpL
ZXlfUSwgdGhpcyk7CiAJICBjb25uZWN0KHF1aXRBY3Rpb24sIFNJR05BTChhY3RpdmF0ZWQoKSks
IFNMT1QoY2xvc2UoKSkpOwotCVEzQWN0aW9uICpsb2FkQWN0aW9uID0gbmV3IFEzQWN0aW9uKCJM
b2FkIiwgUVBpeG1hcCh4cG1fbG9hZCksIF8oIiZMb2FkIiksIFF0OjpDVFJMICsgUXQ6OktleV9M
LCB0aGlzKTsKKwlRM0FjdGlvbiAqbG9hZEFjdGlvbiA9IG5ldyBRM0FjdGlvbigiTG9hZCIsIFFQ
aXhtYXAoeHBtX2xvYWQpLCAiJkxvYWQiLCBRdDo6Q1RSTCArIFF0OjpLZXlfTCwgdGhpcyk7CiAJ
ICBjb25uZWN0KGxvYWRBY3Rpb24sIFNJR05BTChhY3RpdmF0ZWQoKSksIFNMT1QobG9hZENvbmZp
ZygpKSk7Ci0Jc2F2ZUFjdGlvbiA9IG5ldyBRM0FjdGlvbigiU2F2ZSIsIFFQaXhtYXAoeHBtX3Nh
dmUpLCBfKCImU2F2ZSIpLCBRdDo6Q1RSTCArIFF0OjpLZXlfUywgdGhpcyk7CisJc2F2ZUFjdGlv
biA9IG5ldyBRM0FjdGlvbigiU2F2ZSIsIFFQaXhtYXAoeHBtX3NhdmUpLCAiJlNhdmUiLCBRdDo6
Q1RSTCArIFF0OjpLZXlfUywgdGhpcyk7CiAJICBjb25uZWN0KHNhdmVBY3Rpb24sIFNJR05BTChh
Y3RpdmF0ZWQoKSksIFNMT1Qoc2F2ZUNvbmZpZygpKSk7CiAJY29uZl9zZXRfY2hhbmdlZF9jYWxs
YmFjayhjb25mX2NoYW5nZWQpOwogCS8vIFNldCBzYXZlQWN0aW9uJ3MgaW5pdGlhbCBzdGF0ZQog
CWNvbmZfY2hhbmdlZCgpOwotCVEzQWN0aW9uICpzYXZlQXNBY3Rpb24gPSBuZXcgUTNBY3Rpb24o
IlNhdmUgQXMuLi4iLCBfKCJTYXZlICZBcy4uLiIpLCAwLCB0aGlzKTsKKwlRM0FjdGlvbiAqc2F2
ZUFzQWN0aW9uID0gbmV3IFEzQWN0aW9uKCJTYXZlIEFzLi4uIiwgIlNhdmUgJkFzLi4uIiwgMCwg
dGhpcyk7CiAJICBjb25uZWN0KHNhdmVBc0FjdGlvbiwgU0lHTkFMKGFjdGl2YXRlZCgpKSwgU0xP
VChzYXZlQ29uZmlnQXMoKSkpOwotCVEzQWN0aW9uICpzZWFyY2hBY3Rpb24gPSBuZXcgUTNBY3Rp
b24oIkZpbmQiLCBfKCImRmluZCIpLCBRdDo6Q1RSTCArIFF0OjpLZXlfRiwgdGhpcyk7CisJUTNB
Y3Rpb24gKnNlYXJjaEFjdGlvbiA9IG5ldyBRM0FjdGlvbigiRmluZCIsICImRmluZCIsIFF0OjpD
VFJMICsgUXQ6OktleV9GLCB0aGlzKTsKIAkgIGNvbm5lY3Qoc2VhcmNoQWN0aW9uLCBTSUdOQUwo
YWN0aXZhdGVkKCkpLCBTTE9UKHNlYXJjaENvbmZpZygpKSk7Ci0JUTNBY3Rpb24gKnNpbmdsZVZp
ZXdBY3Rpb24gPSBuZXcgUTNBY3Rpb24oIlNpbmdsZSBWaWV3IiwgUVBpeG1hcCh4cG1fc2luZ2xl
X3ZpZXcpLCBfKCJTaW5nbGUgVmlldyIpLCAwLCB0aGlzKTsKKwlRM0FjdGlvbiAqc2luZ2xlVmll
d0FjdGlvbiA9IG5ldyBRM0FjdGlvbigiU2luZ2xlIFZpZXciLCBRUGl4bWFwKHhwbV9zaW5nbGVf
dmlldyksICJTaW5nbGUgVmlldyIsIDAsIHRoaXMpOwogCSAgY29ubmVjdChzaW5nbGVWaWV3QWN0
aW9uLCBTSUdOQUwoYWN0aXZhdGVkKCkpLCBTTE9UKHNob3dTaW5nbGVWaWV3KCkpKTsKLQlRM0Fj
dGlvbiAqc3BsaXRWaWV3QWN0aW9uID0gbmV3IFEzQWN0aW9uKCJTcGxpdCBWaWV3IiwgUVBpeG1h
cCh4cG1fc3BsaXRfdmlldyksIF8oIlNwbGl0IFZpZXciKSwgMCwgdGhpcyk7CisJUTNBY3Rpb24g
KnNwbGl0Vmlld0FjdGlvbiA9IG5ldyBRM0FjdGlvbigiU3BsaXQgVmlldyIsIFFQaXhtYXAoeHBt
X3NwbGl0X3ZpZXcpLCAiU3BsaXQgVmlldyIsIDAsIHRoaXMpOwogCSAgY29ubmVjdChzcGxpdFZp
ZXdBY3Rpb24sIFNJR05BTChhY3RpdmF0ZWQoKSksIFNMT1Qoc2hvd1NwbGl0VmlldygpKSk7Ci0J
UTNBY3Rpb24gKmZ1bGxWaWV3QWN0aW9uID0gbmV3IFEzQWN0aW9uKCJGdWxsIFZpZXciLCBRUGl4
bWFwKHhwbV90cmVlX3ZpZXcpLCBfKCJGdWxsIFZpZXciKSwgMCwgdGhpcyk7CisJUTNBY3Rpb24g
KmZ1bGxWaWV3QWN0aW9uID0gbmV3IFEzQWN0aW9uKCJGdWxsIFZpZXciLCBRUGl4bWFwKHhwbV90
cmVlX3ZpZXcpLCAiRnVsbCBWaWV3IiwgMCwgdGhpcyk7CiAJICBjb25uZWN0KGZ1bGxWaWV3QWN0
aW9uLCBTSUdOQUwoYWN0aXZhdGVkKCkpLCBTTE9UKHNob3dGdWxsVmlldygpKSk7CiAKLQlRM0Fj
dGlvbiAqc2hvd05hbWVBY3Rpb24gPSBuZXcgUTNBY3Rpb24oTlVMTCwgXygiU2hvdyBOYW1lIiks
IDAsIHRoaXMpOworCVEzQWN0aW9uICpzaG93TmFtZUFjdGlvbiA9IG5ldyBRM0FjdGlvbihOVUxM
LCAiU2hvdyBOYW1lIiwgMCwgdGhpcyk7CiAJICBzaG93TmFtZUFjdGlvbi0+c2V0VG9nZ2xlQWN0
aW9uKFRSVUUpOwogCSAgY29ubmVjdChzaG93TmFtZUFjdGlvbiwgU0lHTkFMKHRvZ2dsZWQoYm9v
bCkpLCBjb25maWdWaWV3LCBTTE9UKHNldFNob3dOYW1lKGJvb2wpKSk7CiAJICBjb25uZWN0KGNv
bmZpZ1ZpZXcsIFNJR05BTChzaG93TmFtZUNoYW5nZWQoYm9vbCkpLCBzaG93TmFtZUFjdGlvbiwg
U0xPVChzZXRPbihib29sKSkpOwogCSAgc2hvd05hbWVBY3Rpb24tPnNldE9uKGNvbmZpZ1ZpZXct
PnNob3dOYW1lKCkpOwotCVEzQWN0aW9uICpzaG93UmFuZ2VBY3Rpb24gPSBuZXcgUTNBY3Rpb24o
TlVMTCwgXygiU2hvdyBSYW5nZSIpLCAwLCB0aGlzKTsKKwlRM0FjdGlvbiAqc2hvd1JhbmdlQWN0
aW9uID0gbmV3IFEzQWN0aW9uKE5VTEwsICJTaG93IFJhbmdlIiwgMCwgdGhpcyk7CiAJICBzaG93
UmFuZ2VBY3Rpb24tPnNldFRvZ2dsZUFjdGlvbihUUlVFKTsKIAkgIGNvbm5lY3Qoc2hvd1Jhbmdl
QWN0aW9uLCBTSUdOQUwodG9nZ2xlZChib29sKSksIGNvbmZpZ1ZpZXcsIFNMT1Qoc2V0U2hvd1Jh
bmdlKGJvb2wpKSk7CiAJICBjb25uZWN0KGNvbmZpZ1ZpZXcsIFNJR05BTChzaG93UmFuZ2VDaGFu
Z2VkKGJvb2wpKSwgc2hvd1JhbmdlQWN0aW9uLCBTTE9UKHNldE9uKGJvb2wpKSk7CiAJICBzaG93
UmFuZ2VBY3Rpb24tPnNldE9uKGNvbmZpZ0xpc3QtPnNob3dSYW5nZSk7Ci0JUTNBY3Rpb24gKnNo
b3dEYXRhQWN0aW9uID0gbmV3IFEzQWN0aW9uKE5VTEwsIF8oIlNob3cgRGF0YSIpLCAwLCB0aGlz
KTsKKwlRM0FjdGlvbiAqc2hvd0RhdGFBY3Rpb24gPSBuZXcgUTNBY3Rpb24oTlVMTCwgIlNob3cg
RGF0YSIsIDAsIHRoaXMpOwogCSAgc2hvd0RhdGFBY3Rpb24tPnNldFRvZ2dsZUFjdGlvbihUUlVF
KTsKIAkgIGNvbm5lY3Qoc2hvd0RhdGFBY3Rpb24sIFNJR05BTCh0b2dnbGVkKGJvb2wpKSwgY29u
ZmlnVmlldywgU0xPVChzZXRTaG93RGF0YShib29sKSkpOwogCSAgY29ubmVjdChjb25maWdWaWV3
LCBTSUdOQUwoc2hvd0RhdGFDaGFuZ2VkKGJvb2wpKSwgc2hvd0RhdGFBY3Rpb24sIFNMT1Qoc2V0
T24oYm9vbCkpKTsKQEAgLTEzNjksMTMgKzEzNjAsMTMgQEAgQ29uZmlnTWFpbldpbmRvdzo6Q29u
ZmlnTWFpbldpbmRvdyh2b2lkKQogCQlTTE9UKHNldE9wdGlvbk1vZGUoUUFjdGlvbiAqKSkpOwog
CiAjaWYgUVRfVkVSU0lPTiA+PSAweDA0MDAwMAotCWNvbmZpZ1ZpZXctPnNob3dOb3JtYWxBY3Rp
b24gPSBuZXcgUUFjdGlvbihfKCJTaG93IE5vcm1hbCBPcHRpb25zIiksIG9wdEdyb3VwKTsKLQlj
b25maWdWaWV3LT5zaG93QWxsQWN0aW9uID0gbmV3IFFBY3Rpb24oXygiU2hvdyBBbGwgT3B0aW9u
cyIpLCBvcHRHcm91cCk7Ci0JY29uZmlnVmlldy0+c2hvd1Byb21wdEFjdGlvbiA9IG5ldyBRQWN0
aW9uKF8oIlNob3cgUHJvbXB0IE9wdGlvbnMiKSwgb3B0R3JvdXApOworCWNvbmZpZ1ZpZXctPnNo
b3dOb3JtYWxBY3Rpb24gPSBuZXcgUUFjdGlvbigiU2hvdyBOb3JtYWwgT3B0aW9ucyIsIG9wdEdy
b3VwKTsKKwljb25maWdWaWV3LT5zaG93QWxsQWN0aW9uID0gbmV3IFFBY3Rpb24oIlNob3cgQWxs
IE9wdGlvbnMiLCBvcHRHcm91cCk7CisJY29uZmlnVmlldy0+c2hvd1Byb21wdEFjdGlvbiA9IG5l
dyBRQWN0aW9uKCJTaG93IFByb21wdCBPcHRpb25zIiwgb3B0R3JvdXApOwogI2Vsc2UKLQljb25m
aWdWaWV3LT5zaG93Tm9ybWFsQWN0aW9uID0gbmV3IFFBY3Rpb24oXygiU2hvdyBOb3JtYWwgT3B0
aW9ucyIpLCAwLCBvcHRHcm91cCk7Ci0JY29uZmlnVmlldy0+c2hvd0FsbEFjdGlvbiA9IG5ldyBR
QWN0aW9uKF8oIlNob3cgQWxsIE9wdGlvbnMiKSwgMCwgb3B0R3JvdXApOwotCWNvbmZpZ1ZpZXct
PnNob3dQcm9tcHRBY3Rpb24gPSBuZXcgUUFjdGlvbihfKCJTaG93IFByb21wdCBPcHRpb25zIiks
IDAsIG9wdEdyb3VwKTsKKwljb25maWdWaWV3LT5zaG93Tm9ybWFsQWN0aW9uID0gbmV3IFFBY3Rp
b24oIlNob3cgTm9ybWFsIE9wdGlvbnMiLCAwLCBvcHRHcm91cCk7CisJY29uZmlnVmlldy0+c2hv
d0FsbEFjdGlvbiA9IG5ldyBRQWN0aW9uKCJTaG93IEFsbCBPcHRpb25zIiwgMCwgb3B0R3JvdXAp
OworCWNvbmZpZ1ZpZXctPnNob3dQcm9tcHRBY3Rpb24gPSBuZXcgUUFjdGlvbigiU2hvdyBQcm9t
cHQgT3B0aW9ucyIsIDAsIG9wdEdyb3VwKTsKICNlbmRpZgogCWNvbmZpZ1ZpZXctPnNob3dOb3Jt
YWxBY3Rpb24tPnNldFRvZ2dsZUFjdGlvbihUUlVFKTsKIAljb25maWdWaWV3LT5zaG93Tm9ybWFs
QWN0aW9uLT5zZXRPbihjb25maWdMaXN0LT5vcHRNb2RlID09IG5vcm1hbE9wdCk7CkBAIC0xMzg0
LDE1ICsxMzc1LDE1IEBAIENvbmZpZ01haW5XaW5kb3c6OkNvbmZpZ01haW5XaW5kb3codm9pZCkK
IAljb25maWdWaWV3LT5zaG93UHJvbXB0QWN0aW9uLT5zZXRUb2dnbGVBY3Rpb24oVFJVRSk7CiAJ
Y29uZmlnVmlldy0+c2hvd1Byb21wdEFjdGlvbi0+c2V0T24oY29uZmlnTGlzdC0+b3B0TW9kZSA9
PSBwcm9tcHRPcHQpOwogCi0JUTNBY3Rpb24gKnNob3dEZWJ1Z0FjdGlvbiA9IG5ldyBRM0FjdGlv
bihOVUxMLCBfKCJTaG93IERlYnVnIEluZm8iKSwgMCwgdGhpcyk7CisJUTNBY3Rpb24gKnNob3dE
ZWJ1Z0FjdGlvbiA9IG5ldyBRM0FjdGlvbihOVUxMLCAiU2hvdyBEZWJ1ZyBJbmZvIiwgMCwgdGhp
cyk7CiAJICBzaG93RGVidWdBY3Rpb24tPnNldFRvZ2dsZUFjdGlvbihUUlVFKTsKIAkgIGNvbm5l
Y3Qoc2hvd0RlYnVnQWN0aW9uLCBTSUdOQUwodG9nZ2xlZChib29sKSksIGhlbHBUZXh0LCBTTE9U
KHNldFNob3dEZWJ1Zyhib29sKSkpOwogCSAgY29ubmVjdChoZWxwVGV4dCwgU0lHTkFMKHNob3dE
ZWJ1Z0NoYW5nZWQoYm9vbCkpLCBzaG93RGVidWdBY3Rpb24sIFNMT1Qoc2V0T24oYm9vbCkpKTsK
IAkgIHNob3dEZWJ1Z0FjdGlvbi0+c2V0T24oaGVscFRleHQtPnNob3dEZWJ1ZygpKTsKIAotCVEz
QWN0aW9uICpzaG93SW50cm9BY3Rpb24gPSBuZXcgUTNBY3Rpb24oTlVMTCwgXygiSW50cm9kdWN0
aW9uIiksIDAsIHRoaXMpOworCVEzQWN0aW9uICpzaG93SW50cm9BY3Rpb24gPSBuZXcgUTNBY3Rp
b24oTlVMTCwgIkludHJvZHVjdGlvbiIsIDAsIHRoaXMpOwogCSAgY29ubmVjdChzaG93SW50cm9B
Y3Rpb24sIFNJR05BTChhY3RpdmF0ZWQoKSksIFNMT1Qoc2hvd0ludHJvKCkpKTsKLQlRM0FjdGlv
biAqc2hvd0Fib3V0QWN0aW9uID0gbmV3IFEzQWN0aW9uKE5VTEwsIF8oIkFib3V0IiksIDAsIHRo
aXMpOworCVEzQWN0aW9uICpzaG93QWJvdXRBY3Rpb24gPSBuZXcgUTNBY3Rpb24oTlVMTCwgIkFi
b3V0IiwgMCwgdGhpcyk7CiAJICBjb25uZWN0KHNob3dBYm91dEFjdGlvbiwgU0lHTkFMKGFjdGl2
YXRlZCgpKSwgU0xPVChzaG93QWJvdXQoKSkpOwogCiAJLy8gaW5pdCB0b29sIGJhcgpAQCAtMTQw
Nyw3ICsxMzk4LDcgQEAgQ29uZmlnTWFpbldpbmRvdzo6Q29uZmlnTWFpbldpbmRvdyh2b2lkKQog
CiAJLy8gY3JlYXRlIGNvbmZpZyBtZW51CiAJUTNQb3B1cE1lbnUqIGNvbmZpZyA9IG5ldyBRM1Bv
cHVwTWVudSh0aGlzKTsKLQltZW51LT5pbnNlcnRJdGVtKF8oIiZGaWxlIiksIGNvbmZpZyk7CisJ
bWVudS0+aW5zZXJ0SXRlbSgiJkZpbGUiLCBjb25maWcpOwogCWxvYWRBY3Rpb24tPmFkZFRvKGNv
bmZpZyk7CiAJc2F2ZUFjdGlvbi0+YWRkVG8oY29uZmlnKTsKIAlzYXZlQXNBY3Rpb24tPmFkZFRv
KGNvbmZpZyk7CkBAIC0xNDE2LDEyICsxNDA3LDEyIEBAIENvbmZpZ01haW5XaW5kb3c6OkNvbmZp
Z01haW5XaW5kb3codm9pZCkKIAogCS8vIGNyZWF0ZSBlZGl0IG1lbnUKIAlRM1BvcHVwTWVudSog
ZWRpdE1lbnUgPSBuZXcgUTNQb3B1cE1lbnUodGhpcyk7Ci0JbWVudS0+aW5zZXJ0SXRlbShfKCIm
RWRpdCIpLCBlZGl0TWVudSk7CisJbWVudS0+aW5zZXJ0SXRlbSgiJkVkaXQiLCBlZGl0TWVudSk7
CiAJc2VhcmNoQWN0aW9uLT5hZGRUbyhlZGl0TWVudSk7CiAKIAkvLyBjcmVhdGUgb3B0aW9ucyBt
ZW51CiAJUTNQb3B1cE1lbnUqIG9wdGlvbk1lbnUgPSBuZXcgUTNQb3B1cE1lbnUodGhpcyk7Ci0J
bWVudS0+aW5zZXJ0SXRlbShfKCImT3B0aW9uIiksIG9wdGlvbk1lbnUpOworCW1lbnUtPmluc2Vy
dEl0ZW0oIiZPcHRpb24iLCBvcHRpb25NZW51KTsKIAlzaG93TmFtZUFjdGlvbi0+YWRkVG8ob3B0
aW9uTWVudSk7CiAJc2hvd1JhbmdlQWN0aW9uLT5hZGRUbyhvcHRpb25NZW51KTsKIAlzaG93RGF0
YUFjdGlvbi0+YWRkVG8ob3B0aW9uTWVudSk7CkBAIC0xNDMyLDcgKzE0MjMsNyBAQCBDb25maWdN
YWluV2luZG93OjpDb25maWdNYWluV2luZG93KHZvaWQpCiAJLy8gY3JlYXRlIGhlbHAgbWVudQog
CVEzUG9wdXBNZW51KiBoZWxwTWVudSA9IG5ldyBRM1BvcHVwTWVudSh0aGlzKTsKIAltZW51LT5p
bnNlcnRTZXBhcmF0b3IoKTsKLQltZW51LT5pbnNlcnRJdGVtKF8oIiZIZWxwIiksIGhlbHBNZW51
KTsKKwltZW51LT5pbnNlcnRJdGVtKCImSGVscCIsIGhlbHBNZW51KTsKIAlzaG93SW50cm9BY3Rp
b24tPmFkZFRvKGhlbHBNZW51KTsKIAlzaG93QWJvdXRBY3Rpb24tPmFkZFRvKGhlbHBNZW51KTsK
IApAQCAtMTQ4MCwxNCArMTQ3MSwxNCBAQCB2b2lkIENvbmZpZ01haW5XaW5kb3c6OmxvYWRDb25m
aWcodm9pZCkKIAlpZiAocy5pc051bGwoKSkKIAkJcmV0dXJuOwogCWlmIChjb25mX3JlYWQoUUZp
bGU6OmVuY29kZU5hbWUocykpKQotCQlRTWVzc2FnZUJveDo6aW5mb3JtYXRpb24odGhpcywgInFj
b25mIiwgXygiVW5hYmxlIHRvIGxvYWQgY29uZmlndXJhdGlvbiEiKSk7CisJCVFNZXNzYWdlQm94
OjppbmZvcm1hdGlvbih0aGlzLCAicWNvbmYiLCAiVW5hYmxlIHRvIGxvYWQgY29uZmlndXJhdGlv
biEiKTsKIAlDb25maWdWaWV3Ojp1cGRhdGVMaXN0QWxsKCk7CiB9CiAKIGJvb2wgQ29uZmlnTWFp
bldpbmRvdzo6c2F2ZUNvbmZpZyh2b2lkKQogewogCWlmIChjb25mX3dyaXRlKE5VTEwpKSB7Ci0J
CVFNZXNzYWdlQm94OjppbmZvcm1hdGlvbih0aGlzLCAicWNvbmYiLCBfKCJVbmFibGUgdG8gc2F2
ZSBjb25maWd1cmF0aW9uISIpKTsKKwkJUU1lc3NhZ2VCb3g6OmluZm9ybWF0aW9uKHRoaXMsICJx
Y29uZiIsICJVbmFibGUgdG8gc2F2ZSBjb25maWd1cmF0aW9uISIpOwogCQlyZXR1cm4gZmFsc2U7
CiAJfQogCXJldHVybiB0cnVlOwpAQCAtMTY0NCwxMSArMTYzNSwxMSBAQCB2b2lkIENvbmZpZ01h
aW5XaW5kb3c6OmNsb3NlRXZlbnQoUUNsb3NlRXZlbnQqIGUpCiAJCWUtPmFjY2VwdCgpOwogCQly
ZXR1cm47CiAJfQotCVFNZXNzYWdlQm94IG1iKCJxY29uZiIsIF8oIlNhdmUgY29uZmlndXJhdGlv
bj8iKSwgUU1lc3NhZ2VCb3g6Oldhcm5pbmcsCisJUU1lc3NhZ2VCb3ggbWIoInFjb25mIiwgIlNh
dmUgY29uZmlndXJhdGlvbj8iLCBRTWVzc2FnZUJveDo6V2FybmluZywKIAkJCVFNZXNzYWdlQm94
OjpZZXMgfCBRTWVzc2FnZUJveDo6RGVmYXVsdCwgUU1lc3NhZ2VCb3g6Ok5vLCBRTWVzc2FnZUJv
eDo6Q2FuY2VsIHwgUU1lc3NhZ2VCb3g6OkVzY2FwZSk7Ci0JbWIuc2V0QnV0dG9uVGV4dChRTWVz
c2FnZUJveDo6WWVzLCBfKCImU2F2ZSBDaGFuZ2VzIikpOwotCW1iLnNldEJ1dHRvblRleHQoUU1l
c3NhZ2VCb3g6Ok5vLCBfKCImRGlzY2FyZCBDaGFuZ2VzIikpOwotCW1iLnNldEJ1dHRvblRleHQo
UU1lc3NhZ2VCb3g6OkNhbmNlbCwgXygiQ2FuY2VsIEV4aXQiKSk7CisJbWIuc2V0QnV0dG9uVGV4
dChRTWVzc2FnZUJveDo6WWVzLCAiJlNhdmUgQ2hhbmdlcyIpOworCW1iLnNldEJ1dHRvblRleHQo
UU1lc3NhZ2VCb3g6Ok5vLCAiJkRpc2NhcmQgQ2hhbmdlcyIpOworCW1iLnNldEJ1dHRvblRleHQo
UU1lc3NhZ2VCb3g6OkNhbmNlbCwgIkNhbmNlbCBFeGl0Iik7CiAJc3dpdGNoIChtYi5leGVjKCkp
IHsKIAljYXNlIFFNZXNzYWdlQm94OjpZZXM6CiAJCWlmIChzYXZlQ29uZmlnKCkpCkBAIC0xNjY3
LDcgKzE2NTgsNyBAQCB2b2lkIENvbmZpZ01haW5XaW5kb3c6OmNsb3NlRXZlbnQoUUNsb3NlRXZl
bnQqIGUpCiAKIHZvaWQgQ29uZmlnTWFpbldpbmRvdzo6c2hvd0ludHJvKHZvaWQpCiB7Ci0Jc3Rh
dGljIGNvbnN0IFFTdHJpbmcgc3RyID0gXygiV2VsY29tZSB0byB0aGUgcWNvbmYgZ3JhcGhpY2Fs
IGNvbmZpZ3VyYXRpb24gdG9vbC5cblxuIgorCXN0YXRpYyBjb25zdCBRU3RyaW5nIHN0ciA9ICJX
ZWxjb21lIHRvIHRoZSBxY29uZiBncmFwaGljYWwgY29uZmlndXJhdGlvbiB0b29sLlxuXG4iCiAJ
CSJGb3IgZWFjaCBvcHRpb24sIGEgYmxhbmsgYm94IGluZGljYXRlcyB0aGUgZmVhdHVyZSBpcyBk
aXNhYmxlZCwgYSBjaGVja1xuIgogCQkiaW5kaWNhdGVzIGl0IGlzIGVuYWJsZWQsIGFuZCBhIGRv
dCBpbmRpY2F0ZXMgdGhhdCBpdCBpcyB0byBiZSBjb21waWxlZFxuIgogCQkiYXMgYSBtb2R1bGUu
ICBDbGlja2luZyBvbiB0aGUgYm94IHdpbGwgY3ljbGUgdGhyb3VnaCB0aGUgdGhyZWUgc3RhdGVz
LlxuXG4iCkBAIC0xNjg0LDggKzE2NzUsOCBAQCB2b2lkIENvbmZpZ01haW5XaW5kb3c6OnNob3dJ
bnRybyh2b2lkKQogCiB2b2lkIENvbmZpZ01haW5XaW5kb3c6OnNob3dBYm91dCh2b2lkKQogewot
CXN0YXRpYyBjb25zdCBRU3RyaW5nIHN0ciA9IF8oInFjb25mIGlzIENvcHlyaWdodCAoQykgMjAw
MiBSb21hbiBaaXBwZWwgPHppcHBlbEBsaW51eC1tNjhrLm9yZz4uXG5cbiIKLQkJIkJ1ZyByZXBv
cnRzIGFuZCBmZWF0dXJlIHJlcXVlc3QgY2FuIGFsc28gYmUgZW50ZXJlZCBhdCBodHRwOi8vYnVn
emlsbGEua2VybmVsLm9yZy9cbiIpOworCXN0YXRpYyBjb25zdCBRU3RyaW5nIHN0ciA9ICJxY29u
ZiBpcyBDb3B5cmlnaHQgKEMpIDIwMDIgUm9tYW4gWmlwcGVsIDx6aXBwZWxAbGludXgtbTY4ay5v
cmc+LlxuXG4iCisJCSJCdWcgcmVwb3J0cyBhbmQgZmVhdHVyZSByZXF1ZXN0IGNhbiBhbHNvIGJl
IGVudGVyZWQgYXQgaHR0cDovL2J1Z3ppbGxhLmtlcm5lbC5vcmcvXG4iOwogCiAJUU1lc3NhZ2VC
b3g6OmluZm9ybWF0aW9uKHRoaXMsICJxY29uZiIsIHN0cik7CiB9CkBAIC0xNzQ2LDcgKzE3Mzcs
NyBAQCBzdGF0aWMgY29uc3QgY2hhciAqcHJvZ25hbWU7CiAKIHN0YXRpYyB2b2lkIHVzYWdlKHZv
aWQpCiB7Ci0JcHJpbnRmKF8oIiVzIFstc10gPGNvbmZpZz5cbiIpLCBwcm9nbmFtZSk7CisJcHJp
bnRmKCIlcyBbLXNdIDxjb25maWc+XG4iLCBwcm9nbmFtZSk7CiAJZXhpdCgwKTsKIH0KIApAQCAt
MTc1NSw5ICsxNzQ2LDYgQEAgaW50IG1haW4oaW50IGFjLCBjaGFyKiogYXYpCiAJQ29uZmlnTWFp
bldpbmRvdyogdjsKIAljb25zdCBjaGFyICpuYW1lOwogCi0JYmluZHRleHRkb21haW4oUEFDS0FH
RSwgTE9DQUxFRElSKTsKLQl0ZXh0ZG9tYWluKFBBQ0tBR0UpOwotCiAJcHJvZ25hbWUgPSBhdlsw
XTsKIAljb25maWdBcHAgPSBuZXcgUUFwcGxpY2F0aW9uKGFjLCBhdik7CiAJaWYgKGFjID4gMSAm
JiBhdlsxXVswXSA9PSAnLScpIHsKZGlmZiAtLWdpdCBhL3hlbi90b29scy9rY29uZmlnL3pjb25m
LnRhYi5jX3NoaXBwZWQgYi94ZW4vdG9vbHMva2NvbmZpZy96Y29uZi50YWIuY19zaGlwcGVkCmlu
ZGV4IDdhNGQ2NThjMjAuLjBmMTY2MWQ3YjggMTAwNjQ0Ci0tLSBhL3hlbi90b29scy9rY29uZmln
L3pjb25mLnRhYi5jX3NoaXBwZWQKKysrIGIveGVuL3Rvb2xzL2tjb25maWcvemNvbmYudGFiLmNf
c2hpcHBlZApAQCAtMjM0OSw3ICsyMzQ5LDcgQEAgdm9pZCBjb25mX3BhcnNlKGNvbnN0IGNoYXIg
Km5hbWUpCiAJaWYgKCFtb2R1bGVzX3N5bSkKIAkJbW9kdWxlc19zeW0gPSBzeW1fZmluZCggIm4i
ICk7CiAKLQlyb290bWVudS5wcm9tcHQtPnRleHQgPSBfKHJvb3RtZW51LnByb21wdC0+dGV4dCk7
CisJcm9vdG1lbnUucHJvbXB0LT50ZXh0ID0gcm9vdG1lbnUucHJvbXB0LT50ZXh0OwogCXJvb3Rt
ZW51LnByb21wdC0+dGV4dCA9IHN5bV9leHBhbmRfc3RyaW5nX3ZhbHVlKHJvb3RtZW51LnByb21w
dC0+dGV4dCk7CiAKIAltZW51X2ZpbmFsaXplKCZyb290bWVudSk7CmRpZmYgLS1naXQgYS94ZW4v
dG9vbHMva2NvbmZpZy96Y29uZi55IGIveGVuL3Rvb2xzL2tjb25maWcvemNvbmYueQppbmRleCA3
MWJmOGJmZjY5Li42ZWZjZDVhMzYzIDEwMDY0NAotLS0gYS94ZW4vdG9vbHMva2NvbmZpZy96Y29u
Zi55CisrKyBiL3hlbi90b29scy9rY29uZmlnL3pjb25mLnkKQEAgLTUxMiw3ICs1MTIsNyBAQCB2
b2lkIGNvbmZfcGFyc2UoY29uc3QgY2hhciAqbmFtZSkKIAlpZiAoIW1vZHVsZXNfc3ltKQogCQlt
b2R1bGVzX3N5bSA9IHN5bV9maW5kKCAibiIgKTsKIAotCXJvb3RtZW51LnByb21wdC0+dGV4dCA9
IF8ocm9vdG1lbnUucHJvbXB0LT50ZXh0KTsKKwlyb290bWVudS5wcm9tcHQtPnRleHQgPSByb290
bWVudS5wcm9tcHQtPnRleHQ7CiAJcm9vdG1lbnUucHJvbXB0LT50ZXh0ID0gc3ltX2V4cGFuZF9z
dHJpbmdfdmFsdWUocm9vdG1lbnUucHJvbXB0LT50ZXh0KTsKIAogCW1lbnVfZmluYWxpemUoJnJv
b3RtZW51KTsKLS0gCjIuMTEuMAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnBy
b2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94
ZW4tZGV2ZWw=

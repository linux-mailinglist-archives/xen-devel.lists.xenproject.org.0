Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6B2FF74E2C3
	for <lists+xen-devel@lfdr.de>; Tue, 11 Jul 2023 02:47:01 +0200 (CEST)
Received: from list by lists.xenproject.org with outflank-mailman.561504.877932 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1qJ1WK-0001og-Ik; Tue, 11 Jul 2023 00:46:24 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 561504.877932; Tue, 11 Jul 2023 00:46:24 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1qJ1WK-0001lW-Fw; Tue, 11 Jul 2023 00:46:24 +0000
Received: by outflank-mailman (input) for mailman id 561504;
 Tue, 11 Jul 2023 00:46:23 +0000
Received: from se1-gles-sth1-in.inumbo.com ([159.253.27.254]
 helo=se1-gles-sth1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=DOJ8=C5=epam.com=prvs=15563ed9c2=volodymyr_babchuk@srs-se1.protection.inumbo.net>)
 id 1qJ1WI-0001lQ-Tx
 for xen-devel@lists.xenproject.org; Tue, 11 Jul 2023 00:46:23 +0000
Received: from mx0b-0039f301.pphosted.com (mx0b-0039f301.pphosted.com
 [148.163.137.242]) by se1-gles-sth1.inumbo.com (Halon) with ESMTPS
 id 59e3902f-1f84-11ee-b239-6b7b168915f2;
 Tue, 11 Jul 2023 02:46:20 +0200 (CEST)
Received: from pps.filterd (m0174681.ppops.net [127.0.0.1])
 by mx0b-0039f301.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 36AG006M009547; Tue, 11 Jul 2023 00:46:09 GMT
Received: from eur05-am6-obe.outbound.protection.outlook.com
 (mail-am6eur05lp2111.outbound.protection.outlook.com [104.47.18.111])
 by mx0b-0039f301.pphosted.com (PPS) with ESMTPS id 3rrbn9unxr-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 11 Jul 2023 00:46:08 +0000
Received: from VI1PR03MB3710.eurprd03.prod.outlook.com (2603:10a6:803:31::18)
 by DB9PR03MB7193.eurprd03.prod.outlook.com (2603:10a6:10:227::23)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6565.30; Tue, 11 Jul
 2023 00:46:05 +0000
Received: from VI1PR03MB3710.eurprd03.prod.outlook.com
 ([fe80::c192:26de:9053:ab05]) by VI1PR03MB3710.eurprd03.prod.outlook.com
 ([fe80::c192:26de:9053:ab05%6]) with mapi id 15.20.6565.028; Tue, 11 Jul 2023
 00:46:04 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: 59e3902f-1f84-11ee-b239-6b7b168915f2
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=bJPJYcqxTCFVvHGHGvIiaYFGlyRS5xWVzdFnALeaLMbYD2O2wuJGP+H8axavqMQE9w2jX0H9P1UpwHA6k/EGVWd52lA5pQKnA4sFS2sp/tBjSG/ZHJ7A2dRjXHIdjyNAwqHBldROZhG4nlbhJULfSXGO+tFYcvAO3mtHdvp9rp47kJfVHKfrLxspCXyZYF7YaNW016UHM+6Y7fAtdqFYH365ogdL2qtLvJ9CojGbvAIsT5PhP9cdYfW0wgWoHW9fhooOXmWRdESuwOZD4v0azCI6DUj62OVcHg7HSMoOkNnel4Y9iwukNMQP/P6WOlkvBLYWVaeNGN4qDdsQ50WNvg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=Oq7MAyYNyIyiERDgN5/HwhrVdFHh73QKIalzw9eg63s=;
 b=JeNcy17B76YEwFSEQ5yGmEVQ77ujrMtzJCLKHmathUF/GJsTe9ZBVK0/K9qGGZjaaHlmh4fUfFLWf8tyaZCUOOmR9DauLBvbQ9hMFEl967gf63xqDJr7yGJHBIdl9E20MFA3ZRtVdNpeqRzvXtJKRL0gTYxNFFKFmjY8H0y2lXiQBaBeA0LaySSygy/MeTsojMGzrP4zuNrOaIljTPNkOQNWPZty1+b2NTJ0P2GheUHJo89tk44/v5Xvz9UvJWqo1eIh+Cfalx/yLzcmw4abBlfCpnov5YDM3KsL06PCSZm6NSDDZN3gfL+JgOnMUX+9ODPlifEQksqayU9QlPAplA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=epam.com; dmarc=pass action=none header.from=epam.com;
 dkim=pass header.d=epam.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=epam.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Oq7MAyYNyIyiERDgN5/HwhrVdFHh73QKIalzw9eg63s=;
 b=cdRPTxIbiEFWjM19eB/RGnpHpGCkWp5sFnRhMZaUeP+8ACqLbHbQKcHcOLYPiPt1GuSj46knPBd5Ut9FerGsIi8wOW5/g9vWoMB5Re1J+VW1FQkZqSFrjQZ8ArQs/RWXTkRjP/iPljZvWiqWQLzOMEnJotPbHzhfgyGb1iyU3gQbdWwS7GCe4MW+qJLKxrSRGfVl0KFwkT28Ype9TrY8BWMLwQbl6hqOFUoTwhdSt5sluZGbHVd8IV3wFeTq4pDh6n+pustIG3epBFzDfgDG1QtMd3PAbFc60YuPo5aTRaZ6ka0/OjRZK52T2Y3NzHL+OaPatKhGTsgZdxW6lzMT1Q==
From: Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
CC: Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
        Jan Beulich
	<jbeulich@suse.com>,
        Andrew Cooper <andrew.cooper3@citrix.com>,
        =?utf-8?B?Um9nZXIgUGF1IE1vbm7DqQ==?= <roger.pau@citrix.com>,
        Wei Liu
	<wl@xen.org>, George Dunlap <george.dunlap@citrix.com>,
        Julien Grall
	<julien@xen.org>,
        Stefano Stabellini <sstabellini@kernel.org>,
        Jun Nakajima
	<jun.nakajima@intel.com>,
        Kevin Tian <kevin.tian@intel.com>, Paul Durrant
	<paul@xen.org>,
        Oleksandr Tyshchenko <olekstysh@gmail.com>,
        Oleksandr
 Andrushchenko <Oleksandr_Andrushchenko@epam.com>
Subject: [RFC PATCH] pci: introduce per-domain PCI rwlock
Thread-Topic: [RFC PATCH] pci: introduce per-domain PCI rwlock
Thread-Index: AQHZs5ESsjHhLtlMU0qzCbDGds6cOw==
Date: Tue, 11 Jul 2023 00:46:04 +0000
Message-ID: <20230711004537.888185-1-volodymyr_babchuk@epam.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.41.0
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: VI1PR03MB3710:EE_|DB9PR03MB7193:EE_
x-ms-office365-filtering-correlation-id: e1b96924-a563-4e8f-98b6-08db81a834bf
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: 
 YjVXgUF16h9tQ7lIrxSeOcM5UsWLVJjSUAj/NpbRA56uzyLSkUMxV/9w96lVcQpEgyQDWtdBYlFSDlMpRUteib71etnsyD5Hegmkboe7gUwMjsSs0/zamG/cRDcpuoonqzqKtSSpoDHk6hohx2UkyJcp7GAdhB/X11ZxIcsRJDQfMzqI+9f/Nibi8bTJYGaN3DMhbYMDweqzA4umDCcT1RQQlWvc0c/sRi/9HPfzUybbIF0SW4xqpGxHuG0QzH0FPk5ygfQWgzbsd8PrmQEp+IpYGOgu2u13cd5WK0rfIbEFKGb4d8iOXVDvgRMbFsGw3I+W5g1NVGe3SoLFHUfwK2JOFVgEt2YTGGgZLIBmfRqbsjaKkRrGxYqqZof4tSGCkGDX6OgpuAQSeggLQPYBb0gMj5RWZrhJf9EUnxowku3yu5exWPtL52/kMbEW/R4sePpBY5OJSD6+s7etOJAfQtlkcCqVRq+fI6Gzwe7kuytcFlwHeLsNLjMthSeXRPpPaoUXUjoEGDDTY6s5IUby1snKaXwtIgu/YKWoLBiPA9xDlLBS6SqzajaQyqUUfh/AJcLW78QjOHDuUdxNM/ot5s9aqOKmgRFNYzdmrGIcEdJJwbAoK/NlRXTptwmUtuskwfe+WMB6gNHDDeFkdw5Itw==
x-forefront-antispam-report: 
 CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:VI1PR03MB3710.eurprd03.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230028)(4636009)(376002)(346002)(39860400002)(366004)(396003)(136003)(451199021)(186003)(6506007)(26005)(1076003)(55236004)(2616005)(6512007)(107886003)(83380400001)(64756008)(41300700001)(4326008)(30864003)(66446008)(66556008)(5660300002)(2906002)(7416002)(316002)(8936002)(8676002)(66476007)(6916009)(66946007)(478600001)(6486002)(76116006)(71200400001)(91956017)(54906003)(36756003)(122000001)(38070700005)(38100700002)(86362001)(357404004);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: 
 =?utf-8?B?VER5cU9nZE1GT0FqRkE1c3pOKzZ1MEFrd0FWdC9RRW9sYmF6bEVaSjNrbXBs?=
 =?utf-8?B?Y3lVYjFMVFR5YmQ5R2RRMW9lRnEyUXA3di8rakw2cjNjRHpWUkJyMUdCWUcy?=
 =?utf-8?B?K1hXcjk0dU9tYmg2S0swTWZwZC9GQ3VNWng2UGZpYnNLaFBFVWhuNkdCRkk4?=
 =?utf-8?B?d290S25JTk56VE5Bb1Bqck93S0xBZGJoQ3pjR1NTWjVRQWJvbmdKcXBURDNa?=
 =?utf-8?B?Qm1hV0VtMzlPNGFyUTVVV0I0YUg2amtsWC9DTE13Nng5OFJpdWRNSGV3NkxZ?=
 =?utf-8?B?YnhjK2hQVWJDcXFVZzdMVmJwODREeWpKY29DVzlUV0tNU2NnVGNiMldmVEl4?=
 =?utf-8?B?OFJCUG9kTTFZWDdiNFljNzVlN2ZLQjBUV0NLaVR4cUZqSU9MZitSNlpidkcx?=
 =?utf-8?B?dXVTZ25jNWJhc1ErTitJSDI0QXRLeTZLZU9VVnM5enZhampvaDhseFFaNjU2?=
 =?utf-8?B?bFNDVSt4Rks0Tktzb3VDNEZpTDRVNEJHWE9ZdG5uWVJXODVDNDFubWlBem9r?=
 =?utf-8?B?YmRFTU1MRitZZ3ZON3lOYitxYUY0b1JBT2orTWgvS3p4UzAzT21pUnZVdndJ?=
 =?utf-8?B?eHJPSjBlTkdMWkFFQXJISHYwUTRqR1RtRmpmUitiaFNUN1pWL01YK01Od1pq?=
 =?utf-8?B?NVE5NWljWTZYNHVpOHA4U3NRVzhVRTJVMzB1UW8vandsQWg5QzR4YzRoUDg1?=
 =?utf-8?B?ajIvaXV5WDNXQzJST2wvMzZmbWdhWllYNy9LV01WMHR0cWV0LzFmdmdyNG04?=
 =?utf-8?B?MFRQMVpYZmNkcmc1NytVZnFIRk1uaGNaczlRZzN2bTlVTzJPUGxGaWN5OWJm?=
 =?utf-8?B?ZjlHVVdkdWVTMkdlRkI0TFkxNlFNYUI2eFAvNk9BRzIvWi9jaVlrbGp3TWkv?=
 =?utf-8?B?YmNWeTh2NXVWdkd0VURlR1c5YXRiS3dZSnFnK1JVNWVnU2hVQ1IwdHF6VGF3?=
 =?utf-8?B?dFU1TDByOXNQazJZRURZY1ZBeEkwL3ZYVVo3YllxaUJZNzVkMERzcmZ0dkdW?=
 =?utf-8?B?a2Nmc1BzQVMweWZyWmhUV3NIM2dOT296NkY4VGdabUFhaDRmT05ISnVlRjVZ?=
 =?utf-8?B?QWdqYis4Tnk3ck15UFM5d3RZaEUzUlQydlNmY3hka3ZvYXM2bG9LaDVkbXRG?=
 =?utf-8?B?akhycXlmamRrcWlrUkdiWmJhVStEZjc2d1VJT21uaW1kYUkrZnVHUlowV0E5?=
 =?utf-8?B?SllKbDIxa0xhSTljVjk2R29aeFZHV2l4YmpKUGphRVJYeHhSZ2hObFowL2NQ?=
 =?utf-8?B?YVgyaWFRQ0VBYm9zUTBFSEJxZVRHaDFWcFkrdGxJK3hBSFN0enk5b1Q2VkpP?=
 =?utf-8?B?ZlBNaWFhc1h3UEYrT3B2aEFNYy9mamREaXRnV1ZWMWxuSnk5NG50OVhVSjlS?=
 =?utf-8?B?RnpnbmtyVVJhYVBIaGFpMUc5V2NMR1laMnVIWExCdVZZdFlkMVhIRFBub0ox?=
 =?utf-8?B?Nks1ckpySldNM2l3eFh3WVg0MmVJS0IxR2s4c3lUVWJFMjB2bDE2eDhJRngv?=
 =?utf-8?B?REZLMHc2RVc5dnBvZ3RmN000RmVScTRUM1drUUlyQ0xQWnNWS3pJSS9Xb1hI?=
 =?utf-8?B?c2oyek5UcWEyZzBvaFl0NDNpV213TWN4blRSc2lWWXZkdnZsR3B1THNHTGw4?=
 =?utf-8?B?UTVxUzNxcy9hTEhMcW90YXdHT0VYUlRmTG9pZHB6VDRtUXJaOUtLcU9jK210?=
 =?utf-8?B?R3R0NkZMaVN6cGRhU1JPQXVaazdMYjFDblhkaHVUbWpFazBLNGRjYlJOME44?=
 =?utf-8?B?cUlZb3dFS0tsTGkrckVtb0VNa1Z5RWpTQWU3YllSMXltc1V4dEhwUW13bncz?=
 =?utf-8?B?dENiZG9QNlZzZTg2OHlpRnhOTVJRcXJSanFLNVdRN1Y2OHRJcE14R0lmMUFB?=
 =?utf-8?B?U1U4UVFmcjF6NEZMSzdNMlFYTVlNRU80OXZCaUVvLzBBSzdBNC9OVm1Eek5z?=
 =?utf-8?B?Rkg0cUs1ckNXSUxsSnY0dG8rQS85NHBwMFcvMW1tTFV0OU1aN01MSHFyMy9B?=
 =?utf-8?B?a1dJMHFKVHdQUnBPd2UrVGxOWjNxYjNhWFhLOHAzNStYQmlSREJBWUJydmda?=
 =?utf-8?B?eG0rREhtckZ5V2RBZ0dTdVJwa3FoY2FHTnlMTmFma0s0SDBhMVFFSlZFRGc5?=
 =?utf-8?B?cUZ6NXFodGFiNTQwTG82VFV5b3pBYkNrY1hwNGNaSElvU2EzSGZDSlBaeXp4?=
 =?utf-8?B?VFE9PQ==?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <C6AD6B9C91CF1F40B74094AFB835197A@eurprd03.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: epam.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: VI1PR03MB3710.eurprd03.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: e1b96924-a563-4e8f-98b6-08db81a834bf
X-MS-Exchange-CrossTenant-originalarrivaltime: 11 Jul 2023 00:46:04.2340
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b41b72d0-4e9f-4c26-8a69-f949f367c91d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: +kA99Zyl2wv0zTc3ulwJ8f7iYlYWVzQdeBTQQZXhTo/nWgg85Ea7Mm4PIRiSlMg14JDxg5lotw5ELHSTDRKngAVk3X0ww94qK25I4p1P69Q=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DB9PR03MB7193
X-Proofpoint-ORIG-GUID: Kj1vvoxhZxKhCnqne2mzUBrbrS5hpoVo
X-Proofpoint-GUID: Kj1vvoxhZxKhCnqne2mzUBrbrS5hpoVo
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.254,Aquarius:18.0.957,Hydra:6.0.591,FMLib:17.11.176.26
 definitions=2023-07-10_18,2023-07-06_02,2023-05-22_02
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0 phishscore=0 bulkscore=0
 impostorscore=0 mlxlogscore=999 priorityscore=1501 mlxscore=0
 lowpriorityscore=0 malwarescore=0 clxscore=1011 suspectscore=0
 adultscore=0 spamscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2305260000 definitions=main-2307110004

QWRkIHBlci1kb21haW4gZC0+cGNpX2xvY2sgdGhhdCBwcm90ZWN0cyBhY2Nlc3MgdG8NCmQtPnBk
ZXZfbGlzdC4gUHVycG9zZSBvZiB0aGlzIGxvY2sgaXMgdG8gZ2l2ZSBndWFyYW50ZWVzIHRvIFZQ
Q0kgY29kZQ0KdGhhdCB1bmRlcmx5aW5nIHBkZXYgd2lsbCBub3QgZGlzYXBwZWFyIHVuZGVyIGZl
ZXQuIExhdGVyIGl0IHdpbGwgYWxzbw0KcHJvdGVjdCBwZGV2LT52cGNpIHN0cnVjdHVyZSBhbmQg
cGRldiBhY2Nlc3MgaW4gbW9kaWZ5X2JhcnMoKS4NCg0KU3VnZ2VzdGVkLWJ5OiBSb2dlciBQYXUg
TW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4NClN1Z2dlc3RlZC1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPg0KU2lnbmVkLW9mZi1ieTogVm9sb2R5bXlyIEJhYmNodWsgPHZv
bG9keW15cl9iYWJjaHVrQGVwYW0uY29tPg0KDQotLS0NCg0KVGhpcyBwYXRjaCBzaG91bGQgYmUg
cGFydCBvZiBWUENJIHNlcmllcywgYnV0IEkgYW0gcG9zdGluZyBpdCBhcyBhDQpzaW5sZS1wYXRj
aCBSRkMgdG8gZGlzY3VzcyBjaGFuZ2VzIHRvIHg4NiBNTSBhbmQgSU9NTVUgY29kZS4NCg0KSSBv
cHRlZCB0byBmYWN0b3Igb3V0IHBhcnQgb2YgdGhlIGNoYW5nZXMgZnJvbSAidnBjaTogaW50cm9k
dWNlDQpwZXItZG9tYWluIGxvY2sgdG8gcHJvdGVjdCB2cGNpIHN0cnVjdHVyZSIgY29tbWl0IHRv
IGVhc2UgdXAgcmV2aWV3IHByb2Nlc3MuDQotLS0NCiB4ZW4vYXJjaC94ODYvaHZtL2h2bS5jICAg
ICAgICAgICAgICAgICAgICAgIHwgIDIgKw0KIHhlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3MuYyAg
ICAgICAgICAgICAgICAgfCAgMiArDQogeGVuL2FyY2gveDg2L21tLmMgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICA2ICsrDQogeGVuL2FyY2gveDg2L21tL3AybS1wb2QuYyAgICAgICAgICAg
ICAgICAgICB8ICA3ICsrKw0KIHhlbi9hcmNoL3g4Ni9tbS9wYWdpbmcuYyAgICAgICAgICAgICAg
ICAgICAgfCAgNiArKw0KIHhlbi9jb21tb24vZG9tYWluLmMgICAgICAgICAgICAgICAgICAgICAg
ICAgfCAgMSArDQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jICAgICB8
ICA0ICstDQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYyB8IDE1
ICsrKystDQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMgICAgICAgICAgICAgICB8IDcw
ICsrKysrKysrKysrKysrKysrLS0tLQ0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21t
dS5jICAgICAgICAgfCAxOSArKysrKy0NCiB4ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCAgICAgICAg
ICAgICAgICAgICAgIHwgIDEgKw0KIDExIGZpbGVzIGNoYW5nZWQsIDExNyBpbnNlcnRpb25zKCsp
LCAxNiBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMg
Yi94ZW4vYXJjaC94ODYvaHZtL2h2bS5jDQppbmRleCBhNjdlZjc5ZGMwLi4wODlmYmUzOGE3IDEw
MDY0NA0KLS0tIGEveGVuL2FyY2gveDg2L2h2bS9odm0uYw0KKysrIGIveGVuL2FyY2gveDg2L2h2
bS9odm0uYw0KQEAgLTIzODEsMTIgKzIzODEsMTQgQEAgaW50IGh2bV9zZXRfY3IwKHVuc2lnbmVk
IGxvbmcgdmFsdWUsIGJvb2wgbWF5X2RlZmVyKQ0KICAgICAgICAgfQ0KICAgICB9DQogDQorICAg
IHJlYWRfbG9jaygmZC0+cGNpX2xvY2spOw0KICAgICBpZiAoICgodmFsdWUgXiBvbGRfdmFsdWUp
ICYgWDg2X0NSMF9DRCkgJiYNCiAgICAgICAgICBpc19pb21tdV9lbmFibGVkKGQpICYmIGh2bV9m
dW5jcy5oYW5kbGVfY2QgJiYNCiAgICAgICAgICAoIXJhbmdlc2V0X2lzX2VtcHR5KGQtPmlvbWVt
X2NhcHMpIHx8DQogICAgICAgICAgICFyYW5nZXNldF9pc19lbXB0eShkLT5hcmNoLmlvcG9ydF9j
YXBzKSB8fA0KICAgICAgICAgICBoYXNfYXJjaF9wZGV2cyhkKSkgKQ0KICAgICAgICAgYWx0ZXJu
YXRpdmVfdmNhbGwoaHZtX2Z1bmNzLmhhbmRsZV9jZCwgdiwgdmFsdWUpOw0KKyAgICByZWFkX3Vu
bG9jaygmZC0+cGNpX2xvY2spOw0KIA0KICAgICBodm1fdXBkYXRlX2NyKHYsIDAsIHZhbHVlKTsN
CiANCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNzLmMgYi94ZW4vYXJjaC94
ODYvaHZtL3ZteC92bWNzLmMNCmluZGV4IGIyMDk1NjM2MjUuLjg4YmJjYmJkOTkgMTAwNjQ0DQot
LS0gYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNzLmMNCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0v
dm14L3ZtY3MuYw0KQEAgLTE4ODksNiArMTg4OSw3IEBAIHZvaWQgY2ZfY2hlY2sgdm14X2RvX3Jl
c3VtZSh2b2lkKQ0KICAgICAgICAgICogIDI6IGV4ZWN1dGUgd2JpbnZkIG9uIGFsbCBkaXJ0eSBw
Q1BVcyB3aGVuIGd1ZXN0IHdiaW52ZCBleGl0cy4NCiAgICAgICAgICAqIElmIFZULWQgZW5naW5l
IGNhbiBmb3JjZSBzbm9vcGluZywgd2UgZG9uJ3QgbmVlZCB0byBkbyB0aGVzZS4NCiAgICAgICAg
ICAqLw0KKyAgICAgICAgcmVhZF9sb2NrKCZ2LT5kb21haW4tPnBjaV9sb2NrKTsNCiAgICAgICAg
IGlmICggaGFzX2FyY2hfcGRldnModi0+ZG9tYWluKSAmJiAhaW9tbXVfc25vb3ANCiAgICAgICAg
ICAgICAgICAgJiYgIWNwdV9oYXNfd2JpbnZkX2V4aXRpbmcgKQ0KICAgICAgICAgew0KQEAgLTE4
OTYsNiArMTg5Nyw3IEBAIHZvaWQgY2ZfY2hlY2sgdm14X2RvX3Jlc3VtZSh2b2lkKQ0KICAgICAg
ICAgICAgIGlmICggY3B1ICE9IC0xICkNCiAgICAgICAgICAgICAgICAgZmx1c2hfbWFzayhjcHVt
YXNrX29mKGNwdSksIEZMVVNIX0NBQ0hFKTsNCiAgICAgICAgIH0NCisgICAgICAgIHJlYWRfdW5s
b2NrKCZ2LT5kb21haW4tPnBjaV9sb2NrKTsNCiANCiAgICAgICAgIHZteF9jbGVhcl92bWNzKHYp
Ow0KICAgICAgICAgdm14X2xvYWRfdm1jcyh2KTsNCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYv
bW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jDQppbmRleCBiZTJiMTBhMzkxLi5mMWU4ODJhOTgwIDEw
MDY0NA0KLS0tIGEveGVuL2FyY2gveDg2L21tLmMNCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jDQpA
QCAtODU4LDEyICs4NTgsMTUgQEAgZ2V0X3BhZ2VfZnJvbV9sMWUoDQogICAgICAgICByZXR1cm4g
MDsNCiAgICAgfQ0KIA0KKyAgICByZWFkX2xvY2soJmwxZV9vd25lci0+cGNpX2xvY2spOw0KICAg
ICBpZiAoIHVubGlrZWx5KGwxZiAmIGwxX2Rpc2FsbG93X21hc2sobDFlX293bmVyKSkgKQ0KICAg
ICB7DQogICAgICAgICBnZHByaW50ayhYRU5MT0dfV0FSTklORywgIkJhZCBMMSBmbGFncyAleFxu
IiwNCiAgICAgICAgICAgICAgICAgIGwxZiAmIGwxX2Rpc2FsbG93X21hc2sobDFlX293bmVyKSk7
DQorICAgICAgICByZWFkX3VubG9jaygmbDFlX293bmVyLT5wY2lfbG9jayk7DQogICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsNCiAgICAgfQ0KKyAgICByZWFkX3VubG9jaygmbDFlX293bmVyLT5wY2lf
bG9jayk7DQogDQogICAgIHZhbGlkID0gbWZuX3ZhbGlkKF9tZm4obWZuKSk7DQogDQpAQCAtMjE0
MiwxMiArMjE0NSwxNSBAQCBzdGF0aWMgaW50IG1vZF9sMV9lbnRyeShsMV9wZ2VudHJ5X3QgKnBs
MWUsIGwxX3BnZW50cnlfdCBubDFlLA0KICAgICB7DQogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZv
ICpwYWdlID0gTlVMTDsNCiANCisgICAgICAgIHJlYWRfbG9jaygmcHRfZG9tLT5wY2lfbG9jayk7
DQogICAgICAgICBpZiAoIHVubGlrZWx5KGwxZV9nZXRfZmxhZ3MobmwxZSkgJiBsMV9kaXNhbGxv
d19tYXNrKHB0X2RvbSkpICkNCiAgICAgICAgIHsNCiAgICAgICAgICAgICBnZHByaW50ayhYRU5M
T0dfV0FSTklORywgIkJhZCBMMSBmbGFncyAleFxuIiwNCiAgICAgICAgICAgICAgICAgICAgIGwx
ZV9nZXRfZmxhZ3MobmwxZSkgJiBsMV9kaXNhbGxvd19tYXNrKHB0X2RvbSkpOw0KKyAgICAgICAg
ICAgIHJlYWRfdW5sb2NrKCZwdF9kb20tPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICByZXR1cm4g
LUVJTlZBTDsNCiAgICAgICAgIH0NCisgICAgICAgIHJlYWRfdW5sb2NrKCZwdF9kb20tPnBjaV9s
b2NrKTsNCiANCiAgICAgICAgIC8qIFRyYW5zbGF0ZSBmb3JlaWduIGd1ZXN0IGFkZHJlc3MuICov
DQogICAgICAgICBpZiAoIGNtZCAhPSBNTVVfUFRfVVBEQVRFX05PX1RSQU5TTEFURSAmJg0KZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMgYi94ZW4vYXJjaC94ODYvbW0vcDJt
LXBvZC5jDQppbmRleCA5OTY5ZWI0NWZhLi4wN2UwYmVkYWQ3IDEwMDY0NA0KLS0tIGEveGVuL2Fy
Y2gveDg2L21tL3AybS1wb2QuYw0KKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1wb2QuYw0KQEAg
LTM0OSwxMCArMzQ5LDEyIEBAIHAybV9wb2Rfc2V0X21lbV90YXJnZXQoc3RydWN0IGRvbWFpbiAq
ZCwgdW5zaWduZWQgbG9uZyB0YXJnZXQpDQogDQogICAgIEFTU0VSVCggcG9kX3RhcmdldCA+PSBw
Mm0tPnBvZC5jb3VudCApOw0KIA0KKyAgICByZWFkX2xvY2soJmQtPnBjaV9sb2NrKTsNCiAgICAg
aWYgKCBoYXNfYXJjaF9wZGV2cyhkKSB8fCBjYWNoZV9mbHVzaF9wZXJtaXR0ZWQoZCkgKQ0KICAg
ICAgICAgcmV0ID0gLUVOT1RFTVBUWTsNCiAgICAgZWxzZQ0KICAgICAgICAgcmV0ID0gcDJtX3Bv
ZF9zZXRfY2FjaGVfdGFyZ2V0KHAybSwgcG9kX3RhcmdldCwgMS8qcHJlZW1wdGlibGUqLyk7DQor
ICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lfbG9jayk7DQogDQogb3V0Og0KICAgICBwb2RfdW5sb2Nr
KHAybSk7DQpAQCAtMTQwMSw4ICsxNDAzLDEzIEBAIGd1ZXN0X3BoeXNtYXBfbWFya19wb3B1bGF0
ZV9vbl9kZW1hbmQoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBnZm4sDQogICAgIGlm
ICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShkKSApDQogICAgICAgICByZXR1cm4gLUVJTlZBTDsN
CiANCisgICAgcmVhZF9sb2NrKCZkLT5wY2lfbG9jayk7DQogICAgIGlmICggaGFzX2FyY2hfcGRl
dnMoZCkgfHwgY2FjaGVfZmx1c2hfcGVybWl0dGVkKGQpICkNCisgICAgew0KKyAgICAgICAgcmVh
ZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiAgICAgICAgIHJldHVybiAtRU5PVEVNUFRZOw0KKyAg
ICB9DQorICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lfbG9jayk7DQogDQogICAgIGRvIHsNCiAgICAg
ICAgIHJjID0gbWFya19wb3B1bGF0ZV9vbl9kZW1hbmQoZCwgZ2ZuLCBjaHVua19vcmRlcik7DQpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tL3BhZ2luZy5jIGIveGVuL2FyY2gveDg2L21tL3Bh
Z2luZy5jDQppbmRleCAzNGQ4MzMyNTFiLi5mYjhmN2ZmN2NmIDEwMDY0NA0KLS0tIGEveGVuL2Fy
Y2gveDg2L21tL3BhZ2luZy5jDQorKysgYi94ZW4vYXJjaC94ODYvbW0vcGFnaW5nLmMNCkBAIC0y
MDUsMjEgKzIwNSwyNyBAQCBzdGF0aWMgaW50IHBhZ2luZ19sb2dfZGlydHlfZW5hYmxlKHN0cnVj
dCBkb21haW4gKmQpDQogew0KICAgICBpbnQgcmV0Ow0KIA0KKyAgICByZWFkX2xvY2soJmQtPnBj
aV9sb2NrKTsNCiAgICAgaWYgKCBoYXNfYXJjaF9wZGV2cyhkKSApDQogICAgIHsNCiAgICAgICAg
IC8qDQogICAgICAgICAgKiBSZWZ1c2UgdG8gdHVybiBvbiBnbG9iYWwgbG9nLWRpcnR5IG1vZGUN
CiAgICAgICAgICAqIGlmIHRoZSBkb21haW4gaXMgc2hhcmluZyB0aGUgUDJNIHdpdGggdGhlIElP
TU1VLg0KICAgICAgICAgICovDQorICAgICAgICByZWFkX3VubG9jaygmZC0+cGNpX2xvY2spOw0K
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQogICAgIH0NCiANCiAgICAgaWYgKCBwYWdpbmdfbW9k
ZV9sb2dfZGlydHkoZCkgKQ0KKyAgICB7DQorICAgICAgICByZWFkX3VubG9jaygmZC0+cGNpX2xv
Y2spOw0KICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQorICAgIH0NCiANCiAgICAgZG9tYWluX3Bh
dXNlKGQpOw0KICAgICByZXQgPSBkLT5hcmNoLnBhZ2luZy5sb2dfZGlydHkub3BzLT5lbmFibGUo
ZCk7DQogICAgIGRvbWFpbl91bnBhdXNlKGQpOw0KKyAgICByZWFkX3VubG9jaygmZC0+cGNpX2xv
Y2spOw0KIA0KICAgICByZXR1cm4gcmV0Ow0KIH0NCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2Rv
bWFpbi5jIGIveGVuL2NvbW1vbi9kb21haW4uYw0KaW5kZXggY2FhYTQwMjYzNy4uNWQ4YTg4MzZk
YSAxMDA2NDQNCi0tLSBhL3hlbi9jb21tb24vZG9tYWluLmMNCisrKyBiL3hlbi9jb21tb24vZG9t
YWluLmMNCkBAIC02NDUsNiArNjQ1LDcgQEAgc3RydWN0IGRvbWFpbiAqZG9tYWluX2NyZWF0ZShk
b21pZF90IGRvbWlkLA0KIA0KICNpZmRlZiBDT05GSUdfSEFTX1BDSQ0KICAgICBJTklUX0xJU1Rf
SEVBRCgmZC0+cGRldl9saXN0KTsNCisgICAgcndsb2NrX2luaXQoJmQtPnBjaV9sb2NrKTsNCiAj
ZW5kaWYNCiANCiAgICAgLyogQWxsIGVycm9yIHBhdGhzIGNhbiBkZXBlbmQgb24gdGhlIGFib3Zl
IHNldHVwLiAqLw0KZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9jbWQuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9jbWQuYw0KaW5kZXgg
NDBkZGYzNjZiYi4uYjY3YWVlMzFmNiAxMDA2NDQNCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdV9jbWQuYw0KKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X2NtZC5jDQpAQCAtMzA4LDExICszMDgsMTIgQEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW90
bGIodTggZGV2Zm4sIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LA0KICAgICBmbHVzaF9jb21t
YW5kX2J1ZmZlcihpb21tdSwgaW9tbXVfZGV2X2lvdGxiX3RpbWVvdXQpOw0KIH0NCiANCi1zdGF0
aWMgdm9pZCBhbWRfaW9tbXVfZmx1c2hfYWxsX2lvdGxicyhjb25zdCBzdHJ1Y3QgZG9tYWluICpk
LCBkYWRkcl90IGRhZGRyLA0KK3N0YXRpYyB2b2lkIGFtZF9pb21tdV9mbHVzaF9hbGxfaW90bGJz
KHN0cnVjdCBkb21haW4gKmQsIGRhZGRyX3QgZGFkZHIsDQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKQ0KIHsNCiAgICAgc3RydWN0IHBj
aV9kZXYgKnBkZXY7DQogDQorICAgIHJlYWRfbG9jaygmZC0+cGNpX2xvY2spOw0KICAgICBmb3Jf
ZWFjaF9wZGV2KCBkLCBwZGV2ICkNCiAgICAgew0KICAgICAgICAgdTggZGV2Zm4gPSBwZGV2LT5k
ZXZmbjsNCkBAIC0zMjMsNiArMzI0LDcgQEAgc3RhdGljIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2Fs
bF9pb3RsYnMoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgZGFkZHJfdCBkYWRkciwNCiAgICAgICAg
IH0gd2hpbGUgKCBkZXZmbiAhPSBwZGV2LT5kZXZmbiAmJg0KICAgICAgICAgICAgICAgICAgIFBD
SV9TTE9UKGRldmZuKSA9PSBQQ0lfU0xPVChwZGV2LT5kZXZmbikgKTsNCiAgICAgfQ0KKyAgICBy
ZWFkX3VubG9jaygmZC0+cGNpX2xvY2spOw0KIH0NCiANCiAvKiBGbHVzaCBpb21tdSBjYWNoZSBh
ZnRlciBwMm0gY2hhbmdlcy4gKi8NCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvcGNpX2FtZF9pb21tdS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9h
bWRfaW9tbXUuYw0KaW5kZXggOTRlMzc3NTUwNi4uODU0MWI2NmE5MyAxMDA2NDQNCi0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMNCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMNCkBAIC0xMDIsNiArMTAyLDggQEAg
c3RhdGljIGJvb2wgYW55X3BkZXZfYmVoaW5kX2lvbW11KGNvbnN0IHN0cnVjdCBkb21haW4gKmQs
DQogew0KICAgICBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldjsNCiANCisgICAgQVNTRVJUKHJ3
X2lzX2xvY2tlZCgmZC0+cGNpX2xvY2spKTsNCisNCiAgICAgZm9yX2VhY2hfcGRldiAoIGQsIHBk
ZXYgKQ0KICAgICB7DQogICAgICAgICBpZiAoIHBkZXYgPT0gZXhjbHVkZSApDQpAQCAtNDY3LDE3
ICs0NjksMjQgQEAgc3RhdGljIGludCBjZl9jaGVjayByZWFzc2lnbl9kZXZpY2UoDQogDQogICAg
IGlmICggIVFVQVJBTlRJTkVfU0tJUCh0YXJnZXQsIHBkZXYpICkNCiAgICAgew0KKwlyZWFkX2xv
Y2soJnRhcmdldC0+cGNpX2xvY2spOw0KICAgICAgICAgcmMgPSBhbWRfaW9tbXVfc2V0dXBfZG9t
YWluX2RldmljZSh0YXJnZXQsIGlvbW11LCBkZXZmbiwgcGRldik7DQogICAgICAgICBpZiAoIHJj
ICkNCiAgICAgICAgICAgICByZXR1cm4gcmM7DQorCXJlYWRfdW5sb2NrKCZ0YXJnZXQtPnBjaV9s
b2NrKTsNCiAgICAgfQ0KICAgICBlbHNlDQogICAgICAgICBhbWRfaW9tbXVfZGlzYWJsZV9kb21h
aW5fZGV2aWNlKHNvdXJjZSwgaW9tbXUsIGRldmZuLCBwZGV2KTsNCiANCiAgICAgaWYgKCBkZXZm
biA9PSBwZGV2LT5kZXZmbiAmJiBwZGV2LT5kb21haW4gIT0gdGFyZ2V0ICkNCiAgICAgew0KLSAg
ICAgICAgbGlzdF9tb3ZlKCZwZGV2LT5kb21haW5fbGlzdCwgJnRhcmdldC0+cGRldl9saXN0KTsN
Ci0gICAgICAgIHBkZXYtPmRvbWFpbiA9IHRhcmdldDsNCisgICAgICAgIHdyaXRlX2xvY2soJnBk
ZXYtPmRvbWFpbi0+cGNpX2xvY2spOw0KKyAgICAgICAgbGlzdF9kZWwoJnBkZXYtPmRvbWFpbl9s
aXN0KTsNCisgICAgICAgIHdyaXRlX3VubG9jaygmcGRldi0+ZG9tYWluLT5wY2lfbG9jayk7DQor
DQorICAgICAgICB3cml0ZV9sb2NrKCZ0YXJnZXQtPnBjaV9sb2NrKTsNCisgICAgICAgIGxpc3Rf
YWRkKCZwZGV2LT5kb21haW5fbGlzdCwgJnRhcmdldC0+cGRldl9saXN0KTsNCisgICAgICAgIHdy
aXRlX3VubG9jaygmdGFyZ2V0LT5wY2lfbG9jayk7DQogICAgIH0NCiANCiAgICAgLyoNCkBAIC02
MjgsMTIgKzYzNywxNCBAQCBzdGF0aWMgaW50IGNmX2NoZWNrIGFtZF9pb21tdV9hZGRfZGV2aWNl
KHU4IGRldmZuLCBzdHJ1Y3QgcGNpX2RldiAqcGRldikNCiAgICAgICAgIGZyZXNoX2RvbWlkID0g
dHJ1ZTsNCiAgICAgfQ0KIA0KKyAgICByZWFkX2xvY2soJnBkZXYtPmRvbWFpbi0+cGNpX2xvY2sp
Ow0KICAgICByZXQgPSBhbWRfaW9tbXVfc2V0dXBfZG9tYWluX2RldmljZShwZGV2LT5kb21haW4s
IGlvbW11LCBkZXZmbiwgcGRldik7DQogICAgIGlmICggcmV0ICYmIGZyZXNoX2RvbWlkICkNCiAg
ICAgew0KICAgICAgICAgaW9tbXVfZnJlZV9kb21pZChwZGV2LT5hcmNoLnBzZXVkb19kb21pZCwg
aW9tbXUtPmRvbWlkX21hcCk7DQogICAgICAgICBwZGV2LT5hcmNoLnBzZXVkb19kb21pZCA9IERP
TUlEX0lOVkFMSUQ7DQogICAgIH0NCisgICAgcmVhZF91bmxvY2soJnBkZXYtPmRvbWFpbi0+cGNp
X2xvY2spOw0KIA0KICAgICByZXR1cm4gcmV0Ow0KIH0NCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9wY2kuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jDQppbmRl
eCAwN2QxOTg2ZDMzLi4xODMxZTFiMGMwIDEwMDY0NA0KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvcGNpLmMNCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jDQpAQCAtNDU0
LDcgKzQ1NCw5IEBAIHN0YXRpYyB2b2lkIF9faW5pdCBfcGNpX2hpZGVfZGV2aWNlKHN0cnVjdCBw
Y2lfZGV2ICpwZGV2KQ0KICAgICBpZiAoIHBkZXYtPmRvbWFpbiApDQogICAgICAgICByZXR1cm47
DQogICAgIHBkZXYtPmRvbWFpbiA9IGRvbV94ZW47DQorICAgIHdyaXRlX2xvY2soJmRvbV94ZW4t
PnBjaV9sb2NrKTsNCiAgICAgbGlzdF9hZGQoJnBkZXYtPmRvbWFpbl9saXN0LCAmZG9tX3hlbi0+
cGRldl9saXN0KTsNCisgICAgd3JpdGVfdW5sb2NrKCZkb21feGVuLT5wY2lfbG9jayk7DQogfQ0K
IA0KIGludCBfX2luaXQgcGNpX2hpZGVfZGV2aWNlKHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVk
IGludCBidXMsDQpAQCAtNTMwLDcgKzUzMiw3IEBAIHN0cnVjdCBwY2lfZGV2ICpwY2lfZ2V0X3Bk
ZXYoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgcGNpX3NiZGZfdCBzYmRmKQ0KIHsNCiAgICAgc3Ry
dWN0IHBjaV9kZXYgKnBkZXY7DQogDQotICAgIEFTU0VSVChkIHx8IHBjaWRldnNfbG9ja2VkKCkp
Ow0KKyAgICBBU1NFUlQoKGQgJiYgcndfaXNfbG9ja2VkKCZkLT5wY2lfbG9jaykpIHx8IHBjaWRl
dnNfbG9ja2VkKCkpOw0KIA0KICAgICAvKg0KICAgICAgKiBUaGUgaGFyZHdhcmUgZG9tYWluIG93
bnMgdGhlIG1ham9yaXR5IG9mIHRoZSBkZXZpY2VzIGluIHRoZSBzeXN0ZW0uDQpAQCAtNzQ4LDcg
Kzc1MCw5IEBAIGludCBwY2lfYWRkX2RldmljZSh1MTYgc2VnLCB1OCBidXMsIHU4IGRldmZuLA0K
ICAgICBpZiAoICFwZGV2LT5kb21haW4gKQ0KICAgICB7DQogICAgICAgICBwZGV2LT5kb21haW4g
PSBoYXJkd2FyZV9kb21haW47DQorICAgICAgICB3cml0ZV9sb2NrKCZoYXJkd2FyZV9kb21haW4t
PnBjaV9sb2NrKTsNCiAgICAgICAgIGxpc3RfYWRkKCZwZGV2LT5kb21haW5fbGlzdCwgJmhhcmR3
YXJlX2RvbWFpbi0+cGRldl9saXN0KTsNCisgICAgICAgIHdyaXRlX3VubG9jaygmaGFyZHdhcmVf
ZG9tYWluLT5wY2lfbG9jayk7DQogDQogICAgICAgICAvKg0KICAgICAgICAgICogRm9yIGRldmlj
ZXMgbm90IGRpc2NvdmVyZWQgYnkgWGVuIGR1cmluZyBib290LCBhZGQgdlBDSSBoYW5kbGVycw0K
QEAgLTg4NywyNiArODkxLDYyIEBAIHN0YXRpYyBpbnQgZGVhc3NpZ25fZGV2aWNlKHN0cnVjdCBk
b21haW4gKmQsIHVpbnQxNl90IHNlZywgdWludDhfdCBidXMsDQogDQogaW50IHBjaV9yZWxlYXNl
X2RldmljZXMoc3RydWN0IGRvbWFpbiAqZCkNCiB7DQotICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2
LCAqdG1wOw0KLSAgICB1OCBidXMsIGRldmZuOw0KLSAgICBpbnQgcmV0Ow0KKyAgICBpbnQgY29t
YmluZWRfcmV0Ow0KKyAgICBMSVNUX0hFQUQoZmFpbGVkX3BkZXZzKTsNCiANCiAgICAgcGNpZGV2
c19sb2NrKCk7DQotICAgIHJldCA9IGFyY2hfcGNpX2NsZWFuX3BpcnFzKGQpOw0KLSAgICBpZiAo
IHJldCApDQorICAgIHdyaXRlX2xvY2soJmQtPnBjaV9sb2NrKTsNCisgICAgY29tYmluZWRfcmV0
ID0gYXJjaF9wY2lfY2xlYW5fcGlycXMoZCk7DQorICAgIGlmICggY29tYmluZWRfcmV0ICkNCiAg
ICAgew0KICAgICAgICAgcGNpZGV2c191bmxvY2soKTsNCi0gICAgICAgIHJldHVybiByZXQ7DQor
ICAgICAgICB3cml0ZV91bmxvY2soJmQtPnBjaV9sb2NrKTsNCisgICAgICAgIHJldHVybiBjb21i
aW5lZF9yZXQ7DQogICAgIH0NCi0gICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlICggcGRldiwg
dG1wLCAmZC0+cGRldl9saXN0LCBkb21haW5fbGlzdCApDQorDQorICAgIHdoaWxlICggIWxpc3Rf
ZW1wdHkoJmQtPnBkZXZfbGlzdCkgKQ0KICAgICB7DQotICAgICAgICBidXMgPSBwZGV2LT5idXM7
DQotICAgICAgICBkZXZmbiA9IHBkZXYtPmRldmZuOw0KLSAgICAgICAgcmV0ID0gZGVhc3NpZ25f
ZGV2aWNlKGQsIHBkZXYtPnNlZywgYnVzLCBkZXZmbikgPzogcmV0Ow0KKyAgICAgICAgc3RydWN0
IHBjaV9kZXYgKnBkZXYgPSBsaXN0X2ZpcnN0X2VudHJ5KCZkLT5wZGV2X2xpc3QsDQorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHBjaV9kZXYs
DQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWlu
X2xpc3QpOw0KKyAgICAgICAgdWludDE2X3Qgc2VnID0gcGRldi0+c2VnOw0KKyAgICAgICAgdWlu
dDhfdCBidXMgPSBwZGV2LT5idXM7DQorICAgICAgICB1aW50OF90IGRldmZuID0gcGRldi0+ZGV2
Zm47DQorICAgICAgICBpbnQgcmV0Ow0KKw0KKyAgICAgICAgd3JpdGVfdW5sb2NrKCZkLT5wY2lf
bG9jayk7DQorICAgICAgICByZXQgPSBkZWFzc2lnbl9kZXZpY2UoZCwgc2VnLCBidXMsIGRldmZu
KTsNCisgICAgICAgIHdyaXRlX2xvY2soJmQtPnBjaV9sb2NrKTsNCisgICAgICAgIGlmICggcmV0
ICkNCisgICAgICAgIHsNCisgICAgICAgICAgICBib29sIHN0aWxsX3ByZXNlbnQgPSBmYWxzZTsN
CisgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqdG1wOw0KKw0KKyAgICAgICAgICAg
IC8qDQorICAgICAgICAgICAgICogV2UgbmVlZCB0byBjaGVjayBpZiBkZWFzc2lnbl9kZXZpY2Uo
KSBsZWZ0IG91ciBwZGV2IGluDQorICAgICAgICAgICAgICogZG9tYWluJ3MgbGlzdC4gQXMgd2Ug
ZHJvcHBlZCB0aGUgbG9jaywgd2UgY2FuJ3QgYmUgc3VyZQ0KKyAgICAgICAgICAgICAqIHRoYXQg
bGlzdCB3YXNuJ3QgcGVybXV0YXRlZCBpbiBzb21lIHJhbmRvbSB3YXksIHNvIHdlDQorICAgICAg
ICAgICAgICogbmVlZCB0byB0cmF2ZXJzZSB0aGUgd2hvbGUgbGlzdC4NCisgICAgICAgICAgICAg
Ki8NCisgICAgICAgICAgICBmb3JfZWFjaF9wZGV2ICggZCwgdG1wICkNCisgICAgICAgICAgICB7
DQorICAgICAgICAgICAgICAgIGlmICggdG1wID09IHBkZXYgKQ0KKyAgICAgICAgICAgICAgICB7
DQorICAgICAgICAgICAgICAgICAgICBzdGlsbF9wcmVzZW50ID0gdHJ1ZTsNCisgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOw0KKyAgICAgICAgICAgICAgICB9DQorICAgICAgICAgICAgfQ0KKyAg
ICAgICAgICAgIGlmICggc3RpbGxfcHJlc2VudCApDQorICAgICAgICAgICAgICAgIGxpc3RfbW92
ZSgmcGRldi0+ZG9tYWluX2xpc3QsICZmYWlsZWRfcGRldnMpOw0KKyAgICAgICAgICAgIGNvbWJp
bmVkX3JldCA9IHJldDsNCisgICAgICAgIH0NCiAgICAgfQ0KKw0KKyAgICBsaXN0X3NwbGljZSgm
ZmFpbGVkX3BkZXZzLCAmZC0+cGRldl9saXN0KTsNCisgICAgd3JpdGVfdW5sb2NrKCZkLT5wY2lf
bG9jayk7DQogICAgIHBjaWRldnNfdW5sb2NrKCk7DQogDQotICAgIHJldHVybiByZXQ7DQorICAg
IHJldHVybiBjb21iaW5lZF9yZXQ7DQogfQ0KIA0KICNkZWZpbmUgUENJX0NMQVNTX0JSSURHRV9I
T1NUICAgIDB4MDYwMA0KQEAgLTExMjUsNyArMTE2NSw5IEBAIHN0YXRpYyBpbnQgX19od2RvbV9p
bml0IGNmX2NoZWNrIF9zZXR1cF9od2RvbV9wY2lfZGV2aWNlcygNCiAgICAgICAgICAgICBpZiAo
ICFwZGV2LT5kb21haW4gKQ0KICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgcGRldi0+
ZG9tYWluID0gY3R4dC0+ZDsNCisgICAgICAgICAgICAgICAgd3JpdGVfbG9jaygmY3R4dC0+ZC0+
cGNpX2xvY2spOw0KICAgICAgICAgICAgICAgICBsaXN0X2FkZCgmcGRldi0+ZG9tYWluX2xpc3Qs
ICZjdHh0LT5kLT5wZGV2X2xpc3QpOw0KKyAgICAgICAgICAgICAgICB3cml0ZV91bmxvY2soJmN0
eHQtPmQtPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICAgICAgc2V0dXBfb25lX2h3ZG9tX2Rldmlj
ZShjdHh0LCBwZGV2KTsNCiAgICAgICAgICAgICB9DQogICAgICAgICAgICAgZWxzZSBpZiAoIHBk
ZXYtPmRvbWFpbiA9PSBkb21feGVuICkNCkBAIC0xNDg3LDYgKzE1MjksNyBAQCBzdGF0aWMgaW50
IGlvbW11X2dldF9kZXZpY2VfZ3JvdXAoDQogICAgICAgICByZXR1cm4gZ3JvdXBfaWQ7DQogDQog
ICAgIHBjaWRldnNfbG9jaygpOw0KKyAgICByZWFkX2xvY2soJmQtPnBjaV9sb2NrKTsNCiAgICAg
Zm9yX2VhY2hfcGRldiggZCwgcGRldiApDQogICAgIHsNCiAgICAgICAgIHVuc2lnbmVkIGludCBi
ID0gcGRldi0+YnVzOw0KQEAgLTE1MDEsNiArMTU0NCw3IEBAIHN0YXRpYyBpbnQgaW9tbXVfZ2V0
X2RldmljZV9ncm91cCgNCiAgICAgICAgIHNkZXZfaWQgPSBpb21tdV9jYWxsKG9wcywgZ2V0X2Rl
dmljZV9ncm91cF9pZCwgc2VnLCBiLCBkZik7DQogICAgICAgICBpZiAoIHNkZXZfaWQgPCAwICkN
CiAgICAgICAgIHsNCisgICAgICAgICAgICByZWFkX3VubG9jaygmZC0+cGNpX2xvY2spOw0KICAg
ICAgICAgICAgIHBjaWRldnNfdW5sb2NrKCk7DQogICAgICAgICAgICAgcmV0dXJuIHNkZXZfaWQ7
DQogICAgICAgICB9DQpAQCAtMTUxMSw2ICsxNTU1LDcgQEAgc3RhdGljIGludCBpb21tdV9nZXRf
ZGV2aWNlX2dyb3VwKA0KIA0KICAgICAgICAgICAgIGlmICggdW5saWtlbHkoY29weV90b19ndWVz
dF9vZmZzZXQoYnVmLCBpLCAmYmRmLCAxKSkgKQ0KICAgICAgICAgICAgIHsNCisgICAgICAgICAg
ICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICAgICAgcGNpZGV2
c191bmxvY2soKTsNCiAgICAgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQogICAgICAgICAg
ICAgfQ0KQEAgLTE1MTgsNiArMTU2Myw3IEBAIHN0YXRpYyBpbnQgaW9tbXVfZ2V0X2RldmljZV9n
cm91cCgNCiAgICAgICAgIH0NCiAgICAgfQ0KIA0KKyAgICByZWFkX3VubG9jaygmZC0+cGNpX2xv
Y2spOw0KICAgICBwY2lkZXZzX3VubG9jaygpOw0KIA0KICAgICByZXR1cm4gaTsNCmRpZmYgLS1n
aXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3Z0ZC9pb21tdS5jDQppbmRleCAwZTMwNjJjODIwLi42YTM2Y2MxOGZlIDEwMDY0
NA0KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMNCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jDQpAQCAtMTg2LDYgKzE4Niw4IEBAIHN0YXRp
YyBib29sIGFueV9wZGV2X2JlaGluZF9pb21tdShjb25zdCBzdHJ1Y3QgZG9tYWluICpkLA0KIHsN
CiAgICAgY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXY7DQogDQorICAgIEFTU0VSVChyd19pc19s
b2NrZWQoJmQtPnBjaV9sb2NrKSk7DQorDQogICAgIGZvcl9lYWNoX3BkZXYgKCBkLCBwZGV2ICkN
CiAgICAgew0KICAgICAgICAgY29uc3Qgc3RydWN0IGFjcGlfZHJoZF91bml0ICpkcmhkOw0KQEAg
LTI3NjUsNiArMjc2Nyw3IEBAIHN0YXRpYyBpbnQgY2ZfY2hlY2sgcmVhc3NpZ25fZGV2aWNlX293
bmVyc2hpcCgNCiANCiAgICAgaWYgKCAhUVVBUkFOVElORV9TS0lQKHRhcmdldCwgcGRldi0+YXJj
aC52dGQucGdkX21hZGRyKSApDQogICAgIHsNCisgICAgICAgIHJlYWRfbG9jaygmdGFyZ2V0LT5w
Y2lfbG9jayk7DQogICAgICAgICBpZiAoICFoYXNfYXJjaF9wZGV2cyh0YXJnZXQpICkNCiAgICAg
ICAgICAgICB2bXhfcGlfaG9va3NfYXNzaWduKHRhcmdldCk7DQogDQpAQCAtMjc4MCwyMSArMjc4
MywyNiBAQCBzdGF0aWMgaW50IGNmX2NoZWNrIHJlYXNzaWduX2RldmljZV9vd25lcnNoaXAoDQog
I2VuZGlmDQogDQogICAgICAgICByZXQgPSBkb21haW5fY29udGV4dF9tYXBwaW5nKHRhcmdldCwg
ZGV2Zm4sIHBkZXYpOw0KKyAgICAgICAgcmVhZF91bmxvY2soJnRhcmdldC0+cGNpX2xvY2spOw0K
IA0KICAgICAgICAgaWYgKCAhcmV0ICYmIHBkZXYtPmRldmZuID09IGRldmZuICYmDQogICAgICAg
ICAgICAgICFRVUFSQU5USU5FX1NLSVAoc291cmNlLCBwZGV2LT5hcmNoLnZ0ZC5wZ2RfbWFkZHIp
ICkNCiAgICAgICAgIHsNCiAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgYWNwaV9kcmhkX3VuaXQg
KmRyaGQgPSBhY3BpX2ZpbmRfbWF0Y2hlZF9kcmhkX3VuaXQocGRldik7DQogDQorICAgICAgICAg
ICAgcmVhZF9sb2NrKCZzb3VyY2UtPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICBpZiAoIGRyaGQg
KQ0KICAgICAgICAgICAgICAgICBjaGVja19jbGVhbnVwX2RvbWlkX21hcChzb3VyY2UsIHBkZXYs
IGRyaGQtPmlvbW11KTsNCisgICAgICAgICAgICByZWFkX3VubG9jaygmc291cmNlLT5wY2lfbG9j
ayk7DQogICAgICAgICB9DQogICAgIH0NCiAgICAgZWxzZQ0KICAgICB7DQogICAgICAgICBjb25z
dCBzdHJ1Y3QgYWNwaV9kcmhkX3VuaXQgKmRyaGQ7DQogDQorICAgICAgICByZWFkX2xvY2soJnNv
dXJjZS0+cGNpX2xvY2spOw0KICAgICAgICAgZHJoZCA9IGRvbWFpbl9jb250ZXh0X3VubWFwKHNv
dXJjZSwgZGV2Zm4sIHBkZXYpOw0KKyAgICAgICAgcmVhZF91bmxvY2soJnNvdXJjZS0+cGNpX2xv
Y2spOw0KICAgICAgICAgcmV0ID0gSVNfRVJSKGRyaGQpID8gUFRSX0VSUihkcmhkKSA6IDA7DQog
ICAgIH0NCiAgICAgaWYgKCByZXQgKQ0KQEAgLTI4MDYsMTIgKzI4MTQsMjEgQEAgc3RhdGljIGlu
dCBjZl9jaGVjayByZWFzc2lnbl9kZXZpY2Vfb3duZXJzaGlwKA0KIA0KICAgICBpZiAoIGRldmZu
ID09IHBkZXYtPmRldmZuICYmIHBkZXYtPmRvbWFpbiAhPSB0YXJnZXQgKQ0KICAgICB7DQotICAg
ICAgICBsaXN0X21vdmUoJnBkZXYtPmRvbWFpbl9saXN0LCAmdGFyZ2V0LT5wZGV2X2xpc3QpOw0K
KyAgICAgICAgd3JpdGVfbG9jaygmcGRldi0+ZG9tYWluLT5wY2lfbG9jayk7DQorICAgICAgICBs
aXN0X2RlbCgmcGRldi0+ZG9tYWluX2xpc3QpOw0KKyAgICAgICAgd3JpdGVfdW5sb2NrKCZwZGV2
LT5kb21haW4tPnBjaV9sb2NrKTsNCisNCisgICAgICAgIHdyaXRlX2xvY2soJnRhcmdldC0+cGNp
X2xvY2spOw0KKyAgICAgICAgbGlzdF9hZGQoJnBkZXYtPmRvbWFpbl9saXN0LCAmdGFyZ2V0LT5w
ZGV2X2xpc3QpOw0KKyAgICAgICAgd3JpdGVfdW5sb2NrKCZ0YXJnZXQtPnBjaV9sb2NrKTsNCisN
CiAgICAgICAgIHBkZXYtPmRvbWFpbiA9IHRhcmdldDsNCiAgICAgfQ0KIA0KKyAgICByZWFkX2xv
Y2soJnNvdXJjZS0+cGNpX2xvY2spOw0KICAgICBpZiAoICFoYXNfYXJjaF9wZGV2cyhzb3VyY2Up
ICkNCiAgICAgICAgIHZteF9waV9ob29rc19kZWFzc2lnbihzb3VyY2UpOw0KKyAgICByZWFkX3Vu
bG9jaygmc291cmNlLT5wY2lfbG9jayk7DQogDQogICAgIC8qDQogICAgICAqIElmIHRoZSBkZXZp
Y2UgYmVsb25ncyB0byB0aGUgaGFyZHdhcmUgZG9tYWluLCBhbmQgaXQgaGFzIFJNUlIsIGRvbid0
DQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmggYi94ZW4vaW5jbHVkZS94ZW4v
c2NoZWQuaA0KaW5kZXggODUyNDJhNzNkMy4uODBkZDE1MGJiZiAxMDA2NDQNCi0tLSBhL3hlbi9p
bmNsdWRlL3hlbi9zY2hlZC5oDQorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaA0KQEAgLTQ2
MCw2ICs0NjAsNyBAQCBzdHJ1Y3QgZG9tYWluDQogDQogI2lmZGVmIENPTkZJR19IQVNfUENJDQog
ICAgIHN0cnVjdCBsaXN0X2hlYWQgcGRldl9saXN0Ow0KKyAgICByd2xvY2tfdCBwY2lfbG9jazsN
CiAjZW5kaWYNCiANCiAjaWZkZWYgQ09ORklHX0hBU19QQVNTVEhST1VHSA0KLS0gDQoyLjQxLjAN
Cg==


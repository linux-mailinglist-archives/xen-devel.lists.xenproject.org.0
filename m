Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C6771E4993
	for <lists+xen-devel@lfdr.de>; Fri, 25 Oct 2019 13:14:22 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iNxVz-0003Kz-TI; Fri, 25 Oct 2019 11:12:19 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=PbB1=YS=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iNxVx-0003IP-Gr
 for xen-devel@lists.xen.org; Fri, 25 Oct 2019 11:12:17 +0000
X-Inumbo-ID: 2d6305a7-f718-11e9-94c5-12813bfff9fa
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 2d6305a7-f718-11e9-94c5-12813bfff9fa;
 Fri, 25 Oct 2019 11:11:23 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUx-0001aA-AP; Fri, 25 Oct 2019 11:11:15 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iNxUx-0003zV-7X; Fri, 25 Oct 2019 11:11:15 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iNxUx-0003zV-7X@xenbits.xenproject.org>
Date: Fri, 25 Oct 2019 11:11:15 +0000
Subject: [Xen-devel] Xen Security Advisory 288 v3 (CVE-2019-17343) - x86:
 Inconsistent PV IOMMU discipline
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-17343 / XSA-288
                              version 3

                 x86: Inconsistent PV IOMMU discipline

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

In order for a PV domain to set up DMA from a passed-through device to
one of its pages, the page must be mapped in the IOMMU.  On the other
hand, before a PV page may be used as a "special" page type (such as a
pagetable or descriptor table), it _must not_ be writable in the IOMMU
(otherwise a malicious guest could DMA arbitrary page tables into the
memory, bypassing Xen's safety checks); and Xen's current rule is to
have such pages not in the IOMMU at all.

Until now, in order to accomplish this, the code has borrowed HVM
domain's "physmap" concept: When a page is assigned to a guest,
guess_physmap_add_entry() is called, which for PV guests, will create
a writable IOMMU mapping; and when a page is removed,
guest_physmap_remove_entry() is called, which will remove the mapping.

Additionally, when a page gains the PGT_writable page type, the page
will be added into the IOMMU; and when the page changes away from a
PGT_writable type, the page will be removed from the IOMMU.

Unfortunately, borrowing the "physmap" concept from HVM domains is
problematic.  HVM domains have a lock on their p2m tables, ensuring
synchronization between modifications to the p2m; and all hypercall
parameters must first be translated through the p2m before being used.
Trying to mix this locked-and-gated approach with PV's lock-free
approach leads to several races and inconsistencies.

IMPACT
======

An untrusted PV domain with access to a physical device can DMA into
its own pagetables, leading to privilege escalation.

VULNERABLE SYSTEMS
==================

Only x86 systems are vulnerable.  ARM systems are not vulnerable.

Only systems where PV guests are given direct access to physical
devices (PCI pass-through) are vulnerable.  Systems with only HVM
guests, or systems which do not use PCI pass-through, are not
vulnerable.

MITIGATION
==========

Only assigning devices to HVM guests will avoid these vulnerabilities.

CREDITS
=======

This issue was discovered by Paul Durrant of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa288.patch           xen-unstable
xsa288-4.11.patch      Xen 4.11.x, Xen 4.10.x
xsa288-4.9.patch       Xen 4.9.x
xsa288-4.8.patch       Xen 4.8.x
xsa288-4.7.patch       Xen 4.7.x

$ sha256sum xsa288*
7254f0ce791b5543aec68643ec47e2bcf7823650949c7eb32db5122591f12e8c  xsa288.meta
e1159cb5c1c5a01b28753739b6a78b555ebe4b920cae766db47e0f2a1a21c188  xsa288.patch
e9986ceda84e7391c27d80fd541a0e5edf1eadef302a560b4e445ca9bad4c56e  xsa288-4.7.patch
14856543ccaa5b3db2a209d25637ed025f2eb940294d0cd07e03f56630a9e5af  xsa288-4.8.patch
df5e4a367f58491d54c778e2997142792c881d4f7b5a2a1d3339d2a3f1abafe5  xsa288-4.9.patch
58ba46b4814695dc34beaa5fb644931253bd0b0c6a8dc843c735beec152ae722  xsa288-4.11.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl2y19AMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZmCoH/3PTKQLGVnhe5iGtXVgfbb1h+vz/8t/BATDFgreL
LXSvxxK42FZ+inbr/qz/NUPS21yISOUu9agqWFzTq5qYpU1E4+FybwdjvIHBE6tG
16gFjHYfawvA3QAPndaZR8vdWVqOEu/YdhOSa7m9vRiUnxh2B44nX0oT/bXuGdKv
pyKrQk91hpeWPXxWzJ2k1hy1+/I+eEDxLvauvVaIulO/0bQyMTWcCDRCYdzShJEp
njdVj3+4ZvvNbtc4zrWmVtfyZfMLWFdYwCTcTQ7Gy0b9wVmGhD1UhZsgXd4i8H2Z
62HfUOesi7yO2OtI1T08GaRFoo9ArcUbyEKvxTGW5Iyh6NE=
=EvlR
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa288.meta"
Content-Disposition: attachment; filename="xsa288.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyODgsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIsCiAgICAiNC45IiwK
ICAgICI0LjgiLAogICAgIjQuNyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4
ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICJhMDE2YjhmMjA3YzdhM2ZlOGJkZDJiNmY3YzA4MDAyMGUzZTFj
ODIzIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAyODQs
CiAgICAgICAgICAgIDI4NSwKICAgICAgICAgICAgMjg3CiAgICAgICAgICBd
LAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EyODgt
NC4xMS5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAg
IH0sCiAgICAiNC4xMSI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAgICAgICAg
InhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYiOiAiODdmNTFiZjM2NmNh
NzliOThlMWUyMDFiZjliZDdhOWMxNjQ2MzFlMiIsCiAgICAgICAgICAiUHJl
cmVxcyI6IFsKICAgICAgICAgICAgMjg0LAogICAgICAgICAgICAyODUsCiAg
ICAgICAgICAgIDI4NwogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVz
IjogWwogICAgICAgICAgICAieHNhMjg4LTQuMTEucGF0Y2giCiAgICAgICAg
ICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuNyI6IHsKICAg
ICAgIlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJT
dGFibGVSZWYiOiAiNzEwY2MwOTY5NzEwMTliYzJlNWE5YWFiYjlhZjFhY2Nh
MGI1YjllNyIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAg
Mjg0LAogICAgICAgICAgICAyODUsCiAgICAgICAgICAgIDI4NwogICAgICAg
ICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNh
Mjg4LTQuNy5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0K
ICAgIH0sCiAgICAiNC44IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAg
ICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICI5MDhlNzY4ZmFl
NDlhOGRiMDA4OWU2ODE4ODY1MjA3OWUzYmZhYTY2IiwKICAgICAgICAgICJQ
cmVyZXFzIjogWwogICAgICAgICAgICAyODQsCiAgICAgICAgICAgIDI4NSwK
ICAgICAgICAgICAgMjg3CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNo
ZXMiOiBbCiAgICAgICAgICAgICJ4c2EyODgtNC44LnBhdGNoIgogICAgICAg
ICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjkiOiB7CiAg
ICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAi
U3RhYmxlUmVmIjogImY1YWNmOTdmNjY5YzZiYzk2OTFlMDM3NzFhZDA2NzAz
ZGE3N2UwZDUiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAg
IDI4NCwKICAgICAgICAgICAgMjg1LAogICAgICAgICAgICAyODcKICAgICAg
ICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhz
YTI4OC00LjkucGF0Y2giCiAgICAgICAgICBdCiAgICAgICAgfQogICAgICB9
CiAgICB9LAogICAgIm1hc3RlciI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAg
ICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYiOiAiMjRkNTI4
MjUyN2Y0NjQ3OTA3YjM1NzI4MjBiNTMzNWMxNWNkMDM1NiIsCiAgICAgICAg
ICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjg0LAogICAgICAgICAgICAy
ODUsCiAgICAgICAgICAgIDI4NwogICAgICAgICAgXSwKICAgICAgICAgICJQ
YXRjaGVzIjogWwogICAgICAgICAgICAieHNhMjg4LnBhdGNoIgogICAgICAg
ICAgXQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ==

--=separator
Content-Type: application/octet-stream; name="xsa288.patch"
Content-Disposition: attachment; filename="xsa288.patch"
Content-Transfer-Encoding: base64

RnJvbSAzYWEwZjk5ZmEyNzU0MGVhNWUzY2UwYWUzNTRjN2M4OTAzNDhjNjdh
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMjMgSmFu
IDIwMTkgMTE6NTc6NDYgKzAwMDAKU3ViamVjdDogW1BBVENIXSB4ZW46IE1h
a2UgY29oZXJlbnQgUFYgSU9NTVUgZGlzY2lwbGluZQoKSW4gb3JkZXIgZm9y
IGEgUFYgZG9tYWluIHRvIHNldCB1cCBETUEgZnJvbSBhIHBhc3NlZC10aHJv
dWdoIGRldmljZSB0bwpvbmUgb2YgaXRzIHBhZ2VzLCB0aGUgcGFnZSBtdXN0
IGJlIG1hcHBlZCBpbiB0aGUgSU9NTVUuICBPbiB0aGUgb3RoZXIKaGFuZCwg
YmVmb3JlIGEgUFYgcGFnZSBtYXkgYmUgdXNlZCBhcyBhICJzcGVjaWFsIiBw
YWdlIHR5cGUgKHN1Y2ggYXMgYQpwYWdldGFibGUgb3IgZGVzY3JpcHRvciB0
YWJsZSksIGl0IF9tdXN0IG5vdF8gYmUgd3JpdGFibGUgaW4gdGhlIElPTU1V
CihvdGhlcndpc2UgYSBtYWxpY2lvdXMgZ3Vlc3QgY291bGQgRE1BIGFyYml0
cmFyeSBwYWdlIHRhYmxlcyBpbnRvIHRoZQptZW1vcnksIGJ5cGFzc2luZyBY
ZW4ncyBzYWZldHkgY2hlY2tzKTsgYW5kIFhlbidzIGN1cnJlbnQgcnVsZSBp
cyB0bwpoYXZlIHN1Y2ggcGFnZXMgbm90IGluIHRoZSBJT01NVSBhdCBhbGwu
CgpBdCB0aGUgbW9tZW50LCBpbiBvcmRlciB0byBhY2NvbXBsaXNoIHRoaXMs
IHRoZSBjb2RlIGJvcnJvd3MgSFZNCmRvbWFpbidzICJwaHlzbWFwIiBjb25j
ZXB0OiBXaGVuIGEgcGFnZSBpcyBhc3NpZ25lZCB0byBhIGd1ZXN0LApndWVz
c19waHlzbWFwX2FkZF9lbnRyeSgpIGlzIGNhbGxlZCwgd2hpY2ggZm9yIFBW
IGd1ZXN0cywgd2lsbCBjcmVhdGUKYSB3cml0YWJsZSBJT01NVSBtYXBwaW5n
OyBhbmQgd2hlbiBhIHBhZ2UgaXMgcmVtb3ZlZCwKZ3Vlc3RfcGh5c21hcF9y
ZW1vdmVfZW50cnkoKSBpcyBjYWxsZWQsIHdoaWNoIHdpbGwgcmVtb3ZlIHRo
ZSBtYXBwaW5nLgoKQWRkaXRpb25hbGx5LCB3aGVuIGEgcGFnZSBnYWlucyB0
aGUgUEdUX3dyaXRhYmxlIHBhZ2UgdHlwZSwgdGhlIHBhZ2UKd2lsbCBiZSBh
ZGRlZCBpbnRvIHRoZSBJT01NVTsgYW5kIHdoZW4gdGhlIHBhZ2UgY2hhbmdl
cyBhd2F5IGZyb20gYQpQR1Rfd3JpdGFibGUgdHlwZSwgdGhlIHBhZ2Ugd2ls
bCBiZSByZW1vdmVkIGZyb20gdGhlIElPTU1VLgoKVW5mb3J0dW5hdGVseSwg
Ym9ycm93aW5nIHRoZSAicGh5c21hcCIgY29uY2VwdCBmcm9tIEhWTSBkb21h
aW5zIGlzCnByb2JsZW1hdGljLiAgSFZNIGRvbWFpbnMgaGF2ZSBhIGxvY2sg
b24gdGhlaXIgcDJtIHRhYmxlcywgZW5zdXJpbmcKc3luY2hyb25pemF0aW9u
IGJldHdlZW4gbW9kaWZpY2F0aW9ucyB0byB0aGUgcDJtOyBhbmQgYWxsIGh5
cGVyY2FsbApwYXJhbWV0ZXJzIG11c3QgZmlyc3QgYmUgdHJhbnNsYXRlZCB0
aHJvdWdoIHRoZSBwMm0gYmVmb3JlIGJlaW5nIHVzZWQuCgpUcnlpbmcgdG8g
bWl4IHRoaXMgbG9ja2VkLWFuZC1nYXRlZCBhcHByb2FjaCB3aXRoIFBWJ3Mg
bG9jay1mcmVlCmFwcHJvYWNoIGxlYWRzIHRvIHNldmVyYWwgcmFjZXMgYW5k
IGluY29uc2lzdGVuY2llczoKCiogQSByYWNlIGJldHdlZW4gYSBwYWdlIGJl
aW5nIGFzc2lnbmVkIGFuZCBpdCBiZWluZyBwdXQgaW50byB0aGUKICBwaHlz
bWFwOyBmb3IgZXhhbXBsZToKICAtIFAxOiBjYWxsIHBvcHVsYXRlX3BoeXNt
YXAoKSB7IEEgPSBhbGxvY2F0ZV9kb21oZWFwX3BhZ2VzKCkgfQogIC0gUDI6
IEd1ZXNzIHBhZ2UgQSdzIG1mbiwgYW5kIGNhbGwgZGVjcmVhc2VfcmVzZXJ2
YXRpb24oQSkuICBBIGlzIG93bmVkIGJ5IHRoZSBkb21haW4sCiAgICAgICAg
YW5kIHNvIFhlbiB3aWxsIGNsZWFyIHRoZSBQR0NfYWxsb2NhdGVkIGJpdCBh
bmQgZnJlZSB0aGUgcGFnZQogIC0gUDE6IGZpbmlzaGVzIHBvcHVsYXRlX3Bo
eXNtYXAoKSB7IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KCkgfQoKICBOb3cg
dGhlIGRvbWFpbiBoYXMgYSB3cml0YWJsZSBJT01NVSBtYXBwaW5nIHRvIGEg
cGFnZSBpdCBubyBsb25nZXIgb3ducy4KCiogUGFnZXMgc3RhcnQgb3V0IGFz
IHR5cGUgUEdUX25vbmUsIGJ1dCB3aXRoIGEgd3JpdGFibGUgSU9NTVUgbWFw
cGluZy4KICBJZiBhIGd1ZXN0IHVzZXMgYSBwYWdlIGFzIGEgcGFnZSB0YWJs
ZSB3aXRob3V0IGV2ZXIgaGF2aW5nIGNyZWF0ZWQgYQogIHdyaXRhYmxlIG1h
cHBpbmcsIHRoZSBJT01NVSBtYXBwaW5nIHdpbGwgbm90IGJlIHJlbW92ZWQ7
IHRoZSBndWVzdAogIHdpbGwgaGF2ZSBhIHdyaXRhYmxlIElPTU1VIG1hcHBp
bmcgdG8gYSBwYWdlIGl0IGlzIGN1cnJlbnRseSB1c2luZwogIGFzIGEgcGFn
ZSB0YWJsZS4KCiogQSBuZXdseS1hbGxvY2F0ZWQgcGFnZSBjYW4gYmUgRE1B
J2QgaW50byB3aXRoIG5vIHNwZWNpYWwgYWN0aW9ucyBvbgogIHRoZSBwYXJ0
IG9mIHRoZSBndWVzdDsgSG93ZXZlciwgaWYgYSBwYWdlIGlzIHByb21vdGVk
IHRvIGEKICBub24td3JpdGFibGUgdHlwZSwgdGhlIHBhZ2UgbXVzdCBiZSBt
YXBwZWQgd2l0aCBhIHdyaXRhYmxlIHR5cGUgYmVmb3JlCiAgRE1BJ2luZyB0
byBpdCBhZ2Fpbiwgb3IgdGhlIHRyYW5zYWN0aW9uIHdpbGwgZmFpbC4KClRv
IGZpeCB0aGlzLCBkbyBhd2F5IHdpdGggdGhlICJQViBwaHlzbWFwIiBjb25j
ZXB0IGVudGlyZWx5LCBhbmQKcmVwbGFjZSBpdCB3aXRoIHRoZSBmb2xsb3dp
bmcgSU9NTVUgZGlzY2lwbGluZSBmb3IgUFYgZ3Vlc3RzOgogLSAodHlwZSA9
PSBQR1Rfd3JpdGFibGUpIDw9PiBpbiBpb21tdSAoZXZlbiBpZiB0eXBlX2Nv
dW50ID09IDApCiAtIFVwb24gYSBmaW5hbCBwdXRfcGFnZSgpLCBjaGVjayB0
byBzZWUgaWYgdHlwZSBpcyBQR1Rfd3JpdGFibGU7IGlmIHNvLAogICBpb21t
dV91bm1hcC4KCkluIG9yZGVyIHRvIGFjaGlldmUgdGhhdDoKCi0gUmVtb3Zl
IFBWIElPTU1VIHJlbGF0ZWQgY29kZSBmcm9tIGd1ZXN0X3BoeXNtYXBfKgoK
LSBSZXB1cnBvc2UgY2xlYW51cF9wYWdlX2NhY2hlYXR0cigpIGludG8gYSBn
ZW5lcmFsCiAgY2xlYW51cF9wYWdlX21hcHBpbmdzKCkgZnVuY3Rpb24sIHdo
aWNoIHdpbGwgYm90aCBmaXggdXAgWGVuCiAgbWFwcGluZ3MgZm9yIHBhZ2Vz
IHdpdGggc3BlY2lhbCBjYWNoZSBhdHRyaWJ1dGVzLCBhbmQgYWxzbyBjaGVj
ayBmb3IKICBhIFBHVF93cml0YWJsZSB0eXBlIGFuZCByZW1vdmUgcGFnZXMg
aWYgYXBwcm9wcmlhdGUuCgotIEZvciBjb21wYXRpYmlsaXR5IHdpdGggY3Vy
cmVudCBndWVzdHMsIGdyYWItYW5kLXJlbGVhc2UgYQogIFBHVF93cml0YWJs
ZV9wYWdlIHR5cGUgZm9yIFBWIGd1ZXN0cyBpbiBndWVzdF9waHlzbWFwX2Fk
ZF9lbnRyeSgpLgogIFRoaXMgd2lsbCBjYXVzZSBtb3N0ICJub3JtYWwiIGd1
ZXN0IHBhZ2VzIHRvIHN0YXJ0IG91dCBsaWZlIHdpdGgKICBQR1Rfd3JpdGFi
bGVfcGFnZSB0eXBlIChhbmQgdGh1cyBhbiBJT01NVSBtYXBwaW5nKSwgYnV0
IG5vIHR5cGUKICBjb3VudCAoc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIGFz
IHNwZWNpYWwgY2FzZXMgYXQgd2lsbCkuCgpBbHNvLCBub3RlIHRoYXQgdGhl
cmUgaXMgb25lIGV4Y2VwdGlvbiB0byB0byB0aGUgIlBHVF93cml0YWJsZSA9
PiBpbgppb21tdSIgcnVsZTogeGVuaGVhcCBwYWdlcyBzaGFyZWQgd2l0aCBn
dWVzdHMgbWF5IGJlIGdpdmVuIGEKUEdUX3dyaXRhYmxlIHR5cGUgd2l0aCBv
bmUgdHlwZSByZWZlcmVuY2UuICBUaGlzIHJlZmVyZW5jZSBwcmV2ZW50cwp0
aGUgdHlwZSBmcm9tIGNoYW5naW5nLCB3aGljaCBpbiB0dXJuIHByZXZlbnRz
IHBhZ2UgZnJvbSBnYWluaW5nIGFuCklPTU1VIG1hcHBpbmcgaW4gZ2V0X3Bh
Z2VfdHlwZSgpLiAgSXQncyBub3QgY2xlYXIgd2hldGhlciB0aGlzIHdhcwpp
bnRlbnRpb25hbCBvciBub3QsIGJ1dCBpdCdzIG5vdCBzb21ldGhpbmcgdG8g
Y2hhbmdlIGluIGEgc2VjdXJpdHkKdXBkYXRlLgoKVGhpcyBpcyBYU0EtMjg4
LgoKUmVwb3J0ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNp
dHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3Jn
ZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICB8IDk1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9tbS9wMm0uYyB8IDM1ICsrKysrKysr
KysrKystLS0KIDIgZmlsZXMgY2hhbmdlZCwgMTE2IGluc2VydGlvbnMoKyks
IDE0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9t
bS5jIGIveGVuL2FyY2gveDg2L21tLmMKaW5kZXggNGQzYjE3ZjNhOC4uNzFi
Mzk4NGRkMSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysrIGIv
eGVuL2FyY2gveDg2L21tLmMKQEAgLTgxLDYgKzgxLDIyIEBACiAgKiBPUydz
LCB3aGljaCB3aWxsIGdlbmVyYWxseSB1c2UgdGhlIFdQIGJpdCB0byBzaW1w
bGlmeSBjb3B5LW9uLXdyaXRlCiAgKiBpbXBsZW1lbnRhdGlvbiAoaW4gdGhh
dCBjYXNlLCBPUyB3YW50cyBhIGZhdWx0IHdoZW4gaXQgd3JpdGVzIHRvCiAg
KiBhbiBhcHBsaWNhdGlvbi1zdXBwbGllZCBidWZmZXIpLgorICoKKyAqIFBW
IGRvbVVzIGFuZCBJT01NVXM6CisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLQor
ICogRm9yIGEgZ3Vlc3QgdG8gYmUgYWJsZSB0byBETUEgaW50byBhIHBhZ2Us
IHRoYXQgcGFnZSBtdXN0IGJlIGluIHRoZQorICogZG9tYWluJ3MgSU9NTVUu
ICBIb3dldmVyLCB3ZSAqbXVzdCBub3QqIGFsbG93IERNQSBpbnRvICdzcGVj
aWFsJworICogcGFnZXMgKHN1Y2ggYXMgcGFnZSB0YWJsZSBwYWdlcywgZGVz
Y3JpcHRvciB0YWJsZXMsICZjKTsgYW5kIHdlCisgKiBtdXN0IGFsc28gZW5z
dXJlIHRoYXQgbWFwcGluZ3MgYXJlIHJlbW92ZWQgZnJvbSB0aGUgSU9NTVUg
d2hlbiB0aGUKKyAqIHBhZ2UgaXMgZnJlZWQuICBGaW5hbGx5LCBpdCBpcyBp
bmhlcmVudGx5IHJhY3kgdG8gbWFrZSBhbnkgY2hhbmdlcworICogYmFzZWQg
b24gYSBwYWdlIHdpdGggYSBub24temVybyB0eXBlIGNvdW50LgorICoKKyAq
IFRvIHRoYXQgZW5kLCB3ZSBwdXQgdGhlIHBhZ2UgaW4gdGhlIElPTU1VIG9u
bHkgd2hlbiBhIHBhZ2UgZ2FpbnMKKyAqIHRoZSBQR1Rfd3JpdGVhYmxlIHR5
cGU7IGFuZCB3ZSByZW1vdmUgdGhlIHBhZ2Ugd2hlbiBpdCBsb3NlcyB0aGUK
KyAqIFBHVF93cml0ZWFibGUgdHlwZSAobm90IHdoZW4gdGhlIHR5cGUgY291
bnQgZ29lcyB0byB6ZXJvKS4gIFRoaXMKKyAqIGVmZmVjdGl2ZWx5IHByb3Rl
Y3RzIHRoZSBJT01NVSBzdGF0dXMgdXBkYXRlIHdpdGggdGhlIHR5cGUgY291
bnQgd2UKKyAqIGhhdmUganVzdCBhY3F1aXJlZC4gIFdlIG11c3QgYWxzbyBj
aGVjayBmb3IgUEdUX3dyaXRhYmxlIHR5cGUgd2hlbgorICogZG9pbmcgdGhl
IGZpbmFsIHB1dF9wYWdlKCksIGFuZCByZW1vdmUgaXQgZnJvbSB0aGUgaW9t
bXUgaWYgc28uCiAgKi8KIAogI2luY2x1ZGUgPHhlbi9pbml0Lmg+CkBAIC0y
MzIwLDE5ICsyMzM2LDc5IEBAIHN0YXRpYyBpbnQgbW9kX2w0X2VudHJ5KGw0
X3BnZW50cnlfdCAqcGw0ZSwKIH0KICNlbmRpZiAvKiBDT05GSUdfUFYgKi8K
IAotc3RhdGljIGludCBjbGVhbnVwX3BhZ2VfY2FjaGVhdHRyKHN0cnVjdCBw
YWdlX2luZm8gKnBhZ2UpCisvKgorICogSW4gdGhlIGNvdXJzZSBvZiBhIHBh
Z2UncyB1c2UsIGl0IG1heSBoYXZlIGNhdXNlZCBvdGhlciBzZWNvbmRhcnkK
KyAqIG1hcHBpbmdzIHRvIGhhdmUgY2hhbmdlZDoKKyAqIC0gWGVuJ3MgbWFw
cGluZ3MgbWF5IGhhdmUgYmVlbiBjaGFuZ2VkIHRvIGFjY29tb2RhdGUgdGhl
IHJlcXVlc3RlZAorICogICBjYWNoZSBhdHRpYnV0ZXMKKyAqIC0gQSBwYWdl
IG1heSBoYXZlIGJlZW4gcHV0IGludG8gdGhlIElPTU1VIG9mIGEgUFYgZ3Vl
c3Qgd2hlbiBpdAorICogICBnYWluZWQgYSB3cml0YWJsZSBtYXBwaW5nLgor
ICoKKyAqIE5vdyB0aGF0IHRoZSBwYWdlIGlzIGJlaW5nIGZyZWVkLCBjbGVh
biB1cCB0aGVzZSBtYXBwaW5ncyBpZgorICogYXBwcm9wcmlhdGUuICBOQiB0
aGF0IGF0IHRoaXMgcG9pbnQgdGhlIHBhZ2UgaXMgc3RpbGwgImFsbG9jYXRl
ZCIsCisgKiBidXQgbm90ICJsaXZlIiAoaS5lLiwgaXRzIHJlZmNvdW50IGlz
IDApLCBzbyBpdCdzIHNhZmUgdG8gcmVhZCB0aGUKKyAqIGNvdW50X2luZm8s
IG93bmVyLCBhbmQgdHlwZV9pbmZvIHdpdGhvdXQgc3luY2hyb25pemF0aW9u
LgorICovCitzdGF0aWMgaW50IGNsZWFudXBfcGFnZV9tYXBwaW5ncyhzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogewogICAgIHVuc2lnbmVkIGludCBjYWNo
ZWF0dHIgPQogICAgICAgICAocGFnZS0+Y291bnRfaW5mbyAmIFBHQ19jYWNo
ZWF0dHJfbWFzaykgPj4gUEdDX2NhY2hlYXR0cl9iYXNlOworICAgIGludCBy
YyA9IDA7CisgICAgdW5zaWduZWQgbG9uZyBtZm4gPSBtZm5feChwYWdlX3Rv
X21mbihwYWdlKSk7CiAKLSAgICBpZiAoIGxpa2VseShjYWNoZWF0dHIgPT0g
MCkgKQotICAgICAgICByZXR1cm4gMDsKKyAgICAvKgorICAgICAqIElmIHdl
J3ZlIG1vZGlmaWVkIHhlbiBtYXBwaW5ncyBhcyBhIHJlc3VsdCBvZiBndWVz
dCBjYWNoZQorICAgICAqIGF0dHJpYnV0ZXMsIHJlc3RvcmUgdGhlbSB0byB0
aGUgIm5vcm1hbCIgc3RhdGUuCisgICAgICovCisgICAgaWYgKCB1bmxpa2Vs
eShjYWNoZWF0dHIpICkKKyAgICB7CisgICAgICAgIHBhZ2UtPmNvdW50X2lu
Zm8gJj0gflBHQ19jYWNoZWF0dHJfbWFzazsKIAotICAgIHBhZ2UtPmNvdW50
X2luZm8gJj0gflBHQ19jYWNoZWF0dHJfbWFzazsKKyAgICAgICAgQlVHX09O
KGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkpOwogCi0gICAgQlVHX09OKGlzX3hl
bl9oZWFwX3BhZ2UocGFnZSkpOworICAgICAgICByYyA9IHVwZGF0ZV94ZW5f
bWFwcGluZ3MobWZuLCAwKTsKKyAgICB9CiAKLSAgICByZXR1cm4gdXBkYXRl
X3hlbl9tYXBwaW5ncyhtZm5feChwYWdlX3RvX21mbihwYWdlKSksIDApOwor
ICAgIC8qCisgICAgICogSWYgdGhpcyBtYXkgYmUgaW4gYSBQViBkb21haW4n
cyBJT01NVSwgcmVtb3ZlIGl0LgorICAgICAqCisgICAgICogTkIgdGhhdCB3
cml0YWJsZSB4ZW5oZWFwIHBhZ2VzIGhhdmUgdGhlaXIgdHlwZSBzZXQgYW5k
IGNsZWFyZWQgYnkKKyAgICAgKiBpbXBsZW1lbnRhdGlvbi1zcGVjaWZpYyBj
b2RlLCByYXRoZXIgdGhhbiBieSBnZXRfcGFnZV90eXBlKCkuICBBcyBzdWNo
OgorICAgICAqIC0gVGhleSBhcmVuJ3QgZXhwZWN0ZWQgdG8gaGF2ZSBhbiBJ
T01NVSBtYXBwaW5nLCBhbmQKKyAgICAgKiAtIFdlIGRvbid0IG5lY2Vzc2Fy
aWx5IGV4cGVjdCB0aGUgdHlwZSBjb3VudCB0byBiZSB6ZXJvIHdoZW4gdGhl
IGZpbmFsCisgICAgICogcHV0X3BhZ2UgaGFwcGVucy4KKyAgICAgKgorICAg
ICAqIEdvIGFoZWFkIGFuZCBhdHRlbXAgdG8gY2FsbCBpb21tdV91bm1hcCgp
IG9uIHhlbmhlYXAgcGFnZXMgYW55d2F5LCBqdXN0CisgICAgICogaW4gY2Fz
ZTsgYnV0IG9ubHkgQVNTRVJUKCkgdGhhdCB0aGUgdHlwZSBjb3VudCBpcyB6
ZXJvIGFuZCByZW1vdmUgdGhlCisgICAgICogUEdUX3dyaXRhYmxlIHR5cGUg
Zm9yIG5vbi14ZW5oZWFwIHBhZ2VzLgorICAgICAqLworICAgIGlmICggKHBh
Z2UtPnUuaW51c2UudHlwZV9pbmZvICYgUEdUX3R5cGVfbWFzaykgPT0gUEdU
X3dyaXRhYmxlX3BhZ2UgKQorICAgIHsKKyAgICAgICAgc3RydWN0IGRvbWFp
biAqZCA9IHBhZ2VfZ2V0X293bmVyKHBhZ2UpOworCisgICAgICAgIGlmICgg
ZCAmJiBpc19wdl9kb21haW4oZCkgJiYgdW5saWtlbHkobmVlZF9pb21tdV9w
dF9zeW5jKGQpKSApCisgICAgICAgIHsKKyAgICAgICAgICAgIGludCByYzIg
PSBpb21tdV9sZWdhY3lfdW5tYXAoZCwgX2RmbihtZm4pLCBQQUdFX09SREVS
XzRLKTsKKworICAgICAgICAgICAgaWYgKCAhcmMgKQorICAgICAgICAgICAg
ICAgIHJjID0gcmMyOworICAgICAgICB9CisKKyAgICAgICAgaWYgKCBsaWtl
bHkoIWlzX3hlbl9oZWFwX3BhZ2UocGFnZSkpICkKKyAgICAgICAgeworICAg
ICAgICAgICAgQVNTRVJUKChwYWdlLT51LmludXNlLnR5cGVfaW5mbyAmCisg
ICAgICAgICAgICAgICAgICAgIChQR1RfdHlwZV9tYXNrIHwgUEdUX2NvdW50
X21hc2spKSA9PSBQR1Rfd3JpdGFibGVfcGFnZSk7CisgICAgICAgICAgICAv
KgorICAgICAgICAgICAgICogQ2xlYXIgdGhlIHR5cGUgdG8gcmVjb3JkIHRo
ZSBmYWN0IHRoYXQgYWxsIHdyaXRhYmxlIG1hcHBpbmdzCisgICAgICAgICAg
ICAgKiBoYXZlIGJlZW4gcmVtb3ZlZC4gIEJ1dCBpZiBlaXRoZXIgb3BlcmF0
aW9uIGZhaWxlZCwgbGVhdmUKKyAgICAgICAgICAgICAqIHR5cGVfaW5mbyBh
bG9uZS4KKyAgICAgICAgICAgICAqLworICAgICAgICAgICAgaWYgKCBsaWtl
bHkoIXJjKSApCisgICAgICAgICAgICAgICAgcGFnZS0+dS5pbnVzZS50eXBl
X2luZm8gJj0gfihQR1RfdHlwZV9tYXNrIHwgUEdUX2NvdW50X21hc2spOwor
ICAgICAgICB9CisgICAgfQorCisgICAgcmV0dXJuIHJjOwogfQogCiB2b2lk
IHB1dF9wYWdlKHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCkBAIC0yMzQ4LDcg
KzI0MjQsNyBAQCB2b2lkIHB1dF9wYWdlKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAKICAgICBpZiAoIHVubGlrZWx5KChueCAmIFBHQ19jb3VudF9tYXNr
KSA9PSAwKSApCiAgICAgewotICAgICAgICBpZiAoIGNsZWFudXBfcGFnZV9j
YWNoZWF0dHIocGFnZSkgPT0gMCApCisgICAgICAgIGlmICggIWNsZWFudXBf
cGFnZV9tYXBwaW5ncyhwYWdlKSApCiAgICAgICAgICAgICBmcmVlX2RvbWhl
YXBfcGFnZShwYWdlKTsKICAgICAgICAgZWxzZQogICAgICAgICAgICAgZ2Rw
cmludGsoWEVOTE9HX1dBUk5JTkcsCkBAIC00MDQzLDkgKzQxMTksMTAgQEAg
aW50IHN0ZWFsX3BhZ2UoCiAgICAgICogTkIgdGhpcyBpcyBzYWZlIGV2ZW4g
aWYgdGhlIHBhZ2UgZW5kcyB1cCBiZWluZyBnaXZlbiBiYWNrIHRvCiAgICAg
ICogdGhlIGRvbWFpbiwgYmVjYXVzZSB0aGUgY291bnQgaXMgemVybzogc3Vi
c2VxdWVudCBtYXBwaW5ncyB3aWxsCiAgICAgICogY2F1c2UgdGhlIGNhY2hl
IGF0dHJpYnV0ZXMgdG8gYmUgcmUtaW5zdGF0ZWQgaW5zaWRlCi0gICAgICog
Z2V0X3BhZ2VfZnJvbV9sMWUoKS4KKyAgICAgKiBnZXRfcGFnZV9mcm9tX2wx
ZSgpLCBvciB0aGUgcGFnZSB0byBiZSBhZGRlZCBiYWNrIHRvIHRoZSBJT01N
VQorICAgICAqIHVwb24gdGhlIHR5cGUgY2hhbmdpbmcgdG8gUEdUX3dyaXRl
YWJsZSwgYXMgYXBwcm9wcmlhdGUuCiAgICAgICovCi0gICAgaWYgKCAocmMg
PSBjbGVhbnVwX3BhZ2VfY2FjaGVhdHRyKHBhZ2UpKSApCisgICAgaWYgKCAo
cmMgPSBjbGVhbnVwX3BhZ2VfbWFwcGluZ3MocGFnZSkpICkKICAgICB7CiAg
ICAgICAgIC8qCiAgICAgICAgICAqIENvdWxkbid0IGZpeHVwIFhlbidzIG1h
cHBpbmdzOyBwdXQgdGhpbmdzIHRoZSB3YXkgd2UgZm91bmQKZGlmZiAtLWdp
dCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYyBiL3hlbi9hcmNoL3g4Ni9tbS9w
Mm0uYwppbmRleCBkMTRjZTU3ZGQ1Li5lNmViODQyMTcyIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0vcDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21t
L3AybS5jCkBAIC03NzgsOSArNzc4LDkgQEAgcDJtX3JlbW92ZV9wYWdlKHN0
cnVjdCBwMm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcgZ2ZuX2wsIHVu
c2lnbmVkIGxvbmcgbWZuLAogICAgIHAybV90eXBlX3QgdDsKICAgICBwMm1f
YWNjZXNzX3QgYTsKIAorICAgIC8qIElPTU1VIGZvciBQViBndWVzdHMgaXMg
aGFuZGxlZCBpbiBnZXRfcGFnZV90eXBlKCkgYW5kIHB1dF9wYWdlKCkuICov
CiAgICAgaWYgKCAhcGFnaW5nX21vZGVfdHJhbnNsYXRlKHAybS0+ZG9tYWlu
KSApCi0gICAgICAgIHJldHVybiBuZWVkX2lvbW11X3B0X3N5bmMocDJtLT5k
b21haW4pID8KLSAgICAgICAgICAgIGlvbW11X2xlZ2FjeV91bm1hcChwMm0t
PmRvbWFpbiwgX2RmbihtZm4pLCBwYWdlX29yZGVyKSA6IDA7CisgICAgICAg
IHJldHVybiAwOwogCiAgICAgQVNTRVJUKGdmbl9sb2NrZWRfYnlfbWUocDJt
LCBnZm4pKTsKICAgICBQMk1fREVCVUcoInJlbW92aW5nIGdmbj0lI2x4IG1m
bj0lI2x4XG4iLCBnZm5fbCwgbWZuKTsKQEAgLTgyNSwxMCArODI1LDM1IEBA
IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIGdm
bl90IGdmbiwgbWZuX3QgbWZuLAogICAgIGludCBwb2RfY291bnQgPSAwOwog
ICAgIGludCByYyA9IDA7CiAKKyAgICAvKiBJT01NVSBmb3IgUFYgZ3Vlc3Rz
IGlzIGhhbmRsZWQgaW4gZ2V0X3BhZ2VfdHlwZSgpIGFuZCBwdXRfcGFnZSgp
LiAqLwogICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShkKSApCi0g
ICAgICAgIHJldHVybiAobmVlZF9pb21tdV9wdF9zeW5jKGQpICYmIHQgPT0g
cDJtX3JhbV9ydykgPwotICAgICAgICAgICAgaW9tbXVfbGVnYWN5X21hcChk
LCBfZGZuKG1mbl94KG1mbikpLCBtZm4sIHBhZ2Vfb3JkZXIsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIElPTU1VRl9yZWFkYWJsZSB8IElPTU1V
Rl93cml0YWJsZSkgOiAwOworICAgIHsKKyAgICAgICAgc3RydWN0IHBhZ2Vf
aW5mbyAqcGFnZSA9IG1mbl90b19wYWdlKG1mbik7CisKKyAgICAgICAgLyoK
KyAgICAgICAgICogT3VyIGludGVyZmFjZSBmb3IgUFYgZ3Vlc3RzIHdydCBJ
T01NVSBlbnRyaWVzIGhhc24ndCBiZWVuIHZlcnkKKyAgICAgICAgICogY2xl
YXI7IGJ1dCBoaXN0b3JpY2FsbHksIHBhZ2VzIGhhdmUgc3RhcnRlZCBvdXQg
d2l0aCBJT01NVSBtYXBwaW5ncywKKyAgICAgICAgICogYW5kIG9ubHkgbG9z
ZSB0aGVtIHdoZW4gY2hhbmdlZCB0byBhIGRpZmZlcmVudCBwYWdlIHR5cGUu
CisgICAgICAgICAqCisgICAgICAgICAqIFJldGFpbiB0aGlzIHByb3BlcnR5
IGJ5IGdyYWJiaW5nIGEgd3JpdGFibGUgdHlwZSByZWYgYW5kIHRoZW4KKyAg
ICAgICAgICogZHJvcHBpbmcgaXQgaW1tZWRpYXRlbHkuICBUaGUgcmVzdWx0
IHdpbGwgYmUgcGFnZXMgdGhhdCBoYXZlIGEKKyAgICAgICAgICogd3JpdGFi
bGUgdHlwZSAoYW5kIGFuIElPTU1VIGVudHJ5KSwgYnV0IGEgY291bnQgb2Yg
MCAoc3VjaCB0aGF0CisgICAgICAgICAqIGFueSBndWVzdC1yZXF1ZXN0ZWQg
dHlwZSBjaGFuZ2VzIHN1Y2NlZWQgYW5kIHJlbW92ZSB0aGUgSU9NTVUKKyAg
ICAgICAgICogZW50cnkpLgorICAgICAgICAgKi8KKyAgICAgICAgaWYgKCAh
bmVlZF9pb21tdV9wdF9zeW5jKGQpIHx8IHQgIT0gcDJtX3JhbV9ydyApCisg
ICAgICAgICAgICByZXR1cm4gMDsKKworICAgICAgICBmb3IgKCBpID0gMDsg
aSA8ICgxVUwgPDwgcGFnZV9vcmRlcik7ICsraSwgKytwYWdlICkKKyAgICAg
ICAgeworICAgICAgICAgICAgaWYgKCBnZXRfcGFnZV9hbmRfdHlwZShwYWdl
LCBkLCBQR1Rfd3JpdGFibGVfcGFnZSkgKQorICAgICAgICAgICAgICAgIHB1
dF9wYWdlX2FuZF90eXBlKHBhZ2UpOworICAgICAgICAgICAgZWxzZQorICAg
ICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOworICAgICAgICB9CisKKyAg
ICAgICAgcmV0dXJuIDA7CisgICAgfQogCiAgICAgLyogZm9yZWlnbiBwYWdl
cyBhcmUgYWRkZWQgdGhydSBwMm1fYWRkX2ZvcmVpZ24gKi8KICAgICBpZiAo
IHAybV9pc19mb3JlaWduKHQpICkKLS0gCjIuMjAuMQoK

--=separator
Content-Type: application/octet-stream; name="xsa288-4.7.patch"
Content-Disposition: attachment; filename="xsa288-4.7.patch"
Content-Transfer-Encoding: base64

RnJvbSBkYzkzODU1YThiMzlmYmMyNmYzM2JmZmExMzRmYzk0ZDM2NzI2YTlm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMjMgSmFu
IDIwMTkgMTE6NTc6NDYgKzAwMDAKU3ViamVjdDogW1BBVENIXSB4ZW46IE1h
a2UgY29oZXJlbnQgUFYgSU9NTVUgZGlzY2lwbGluZQoKSW4gb3JkZXIgZm9y
IGEgUFYgZG9tYWluIHRvIHNldCB1cCBETUEgZnJvbSBhIHBhc3NlZC10aHJv
dWdoIGRldmljZSB0bwpvbmUgb2YgaXRzIHBhZ2VzLCB0aGUgcGFnZSBtdXN0
IGJlIG1hcHBlZCBpbiB0aGUgSU9NTVUuICBPbiB0aGUgb3RoZXIKaGFuZCwg
YmVmb3JlIGEgUFYgcGFnZSBtYXkgYmUgdXNlZCBhcyBhICJzcGVjaWFsIiBw
YWdlIHR5cGUgKHN1Y2ggYXMgYQpwYWdldGFibGUgb3IgZGVzY3JpcHRvciB0
YWJsZSksIGl0IF9tdXN0IG5vdF8gYmUgd3JpdGFibGUgaW4gdGhlIElPTU1V
CihvdGhlcndpc2UgYSBtYWxpY2lvdXMgZ3Vlc3QgY291bGQgRE1BIGFyYml0
cmFyeSBwYWdlIHRhYmxlcyBpbnRvIHRoZQptZW1vcnksIGJ5cGFzc2luZyBY
ZW4ncyBzYWZldHkgY2hlY2tzKTsgYW5kIFhlbidzIGN1cnJlbnQgcnVsZSBp
cyB0bwpoYXZlIHN1Y2ggcGFnZXMgbm90IGluIHRoZSBJT01NVSBhdCBhbGwu
CgpBdCB0aGUgbW9tZW50LCBpbiBvcmRlciB0byBhY2NvbXBsaXNoIHRoaXMs
IHRoZSBjb2RlIGJvcnJvd3MgSFZNCmRvbWFpbidzICJwaHlzbWFwIiBjb25j
ZXB0OiBXaGVuIGEgcGFnZSBpcyBhc3NpZ25lZCB0byBhIGd1ZXN0LApndWVz
c19waHlzbWFwX2FkZF9lbnRyeSgpIGlzIGNhbGxlZCwgd2hpY2ggZm9yIFBW
IGd1ZXN0cywgd2lsbCBjcmVhdGUKYSB3cml0YWJsZSBJT01NVSBtYXBwaW5n
OyBhbmQgd2hlbiBhIHBhZ2UgaXMgcmVtb3ZlZCwKZ3Vlc3RfcGh5c21hcF9y
ZW1vdmVfZW50cnkoKSBpcyBjYWxsZWQsIHdoaWNoIHdpbGwgcmVtb3ZlIHRo
ZSBtYXBwaW5nLgoKQWRkaXRpb25hbGx5LCB3aGVuIGEgcGFnZSBnYWlucyB0
aGUgUEdUX3dyaXRhYmxlIHBhZ2UgdHlwZSwgdGhlIHBhZ2UKd2lsbCBiZSBh
ZGRlZCBpbnRvIHRoZSBJT01NVTsgYW5kIHdoZW4gdGhlIHBhZ2UgY2hhbmdl
cyBhd2F5IGZyb20gYQpQR1Rfd3JpdGFibGUgdHlwZSwgdGhlIHBhZ2Ugd2ls
bCBiZSByZW1vdmVkIGZyb20gdGhlIElPTU1VLgoKVW5mb3J0dW5hdGVseSwg
Ym9ycm93aW5nIHRoZSAicGh5c21hcCIgY29uY2VwdCBmcm9tIEhWTSBkb21h
aW5zIGlzCnByb2JsZW1hdGljLiAgSFZNIGRvbWFpbnMgaGF2ZSBhIGxvY2sg
b24gdGhlaXIgcDJtIHRhYmxlcywgZW5zdXJpbmcKc3luY2hyb25pemF0aW9u
IGJldHdlZW4gbW9kaWZpY2F0aW9ucyB0byB0aGUgcDJtOyBhbmQgYWxsIGh5
cGVyY2FsbApwYXJhbWV0ZXJzIG11c3QgZmlyc3QgYmUgdHJhbnNsYXRlZCB0
aHJvdWdoIHRoZSBwMm0gYmVmb3JlIGJlaW5nIHVzZWQuCgpUcnlpbmcgdG8g
bWl4IHRoaXMgbG9ja2VkLWFuZC1nYXRlZCBhcHByb2FjaCB3aXRoIFBWJ3Mg
bG9jay1mcmVlCmFwcHJvYWNoIGxlYWRzIHRvIHNldmVyYWwgcmFjZXMgYW5k
IGluY29uc2lzdGVuY2llczoKCiogQSByYWNlIGJldHdlZW4gYSBwYWdlIGJl
aW5nIGFzc2lnbmVkIGFuZCBpdCBiZWluZyBwdXQgaW50byB0aGUKICBwaHlz
bWFwOyBmb3IgZXhhbXBsZToKICAtIFAxOiBjYWxsIHBvcHVsYXRlX3BoeXNt
YXAoKSB7IEEgPSBhbGxvY2F0ZV9kb21oZWFwX3BhZ2VzKCkgfQogIC0gUDI6
IEd1ZXNzIHBhZ2UgQSdzIG1mbiwgYW5kIGNhbGwgZGVjcmVhc2VfcmVzZXJ2
YXRpb24oQSkuICBBIGlzIG93bmVkIGJ5IHRoZSBkb21haW4sCiAgICAgICAg
YW5kIHNvIFhlbiB3aWxsIGNsZWFyIHRoZSBQR0NfYWxsb2NhdGVkIGJpdCBh
bmQgZnJlZSB0aGUgcGFnZQogIC0gUDE6IGZpbmlzaGVzIHBvcHVsYXRlX3Bo
eXNtYXAoKSB7IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KCkgfQoKICBOb3cg
dGhlIGRvbWFpbiBoYXMgYSB3cml0YWJsZSBJT01NVSBtYXBwaW5nIHRvIGEg
cGFnZSBpdCBubyBsb25nZXIgb3ducy4KCiogUGFnZXMgc3RhcnQgb3V0IGFz
IHR5cGUgUEdUX25vbmUsIGJ1dCB3aXRoIGEgd3JpdGFibGUgSU9NTVUgbWFw
cGluZy4KICBJZiBhIGd1ZXN0IHVzZXMgYSBwYWdlIGFzIGEgcGFnZSB0YWJs
ZSB3aXRob3V0IGV2ZXIgaGF2aW5nIGNyZWF0ZWQgYQogIHdyaXRhYmxlIG1h
cHBpbmcsIHRoZSBJT01NVSBtYXBwaW5nIHdpbGwgbm90IGJlIHJlbW92ZWQ7
IHRoZSBndWVzdAogIHdpbGwgaGF2ZSBhIHdyaXRhYmxlIElPTU1VIG1hcHBp
bmcgdG8gYSBwYWdlIGl0IGlzIGN1cnJlbnRseSB1c2luZwogIGFzIGEgcGFn
ZSB0YWJsZS4KCiogQSBuZXdseS1hbGxvY2F0ZWQgcGFnZSBjYW4gYmUgRE1B
J2QgaW50byB3aXRoIG5vIHNwZWNpYWwgYWN0aW9ucyBvbgogIHRoZSBwYXJ0
IG9mIHRoZSBndWVzdDsgSG93ZXZlciwgaWYgYSBwYWdlIGlzIHByb21vdGVk
IHRvIGEKICBub24td3JpdGFibGUgdHlwZSwgdGhlIHBhZ2UgbXVzdCBiZSBt
YXBwZWQgd2l0aCBhIHdyaXRhYmxlIHR5cGUgYmVmb3JlCiAgRE1BJ2luZyB0
byBpdCBhZ2Fpbiwgb3IgdGhlIHRyYW5zYWN0aW9uIHdpbGwgZmFpbC4KClRv
IGZpeCB0aGlzLCBkbyBhd2F5IHdpdGggdGhlICJQViBwaHlzbWFwIiBjb25j
ZXB0IGVudGlyZWx5LCBhbmQKcmVwbGFjZSBpdCB3aXRoIHRoZSBmb2xsb3dp
bmcgSU9NTVUgZGlzY2lwbGluZSBmb3IgUFYgZ3Vlc3RzOgogLSAodHlwZSA9
PSBQR1Rfd3JpdGFibGUpIDw9PiBpbiBpb21tdSAoZXZlbiBpZiB0eXBlX2Nv
dW50ID09IDApCiAtIFVwb24gYSBmaW5hbCBwdXRfcGFnZSgpLCBjaGVjayB0
byBzZWUgaWYgdHlwZSBpcyBQR1Rfd3JpdGFibGU7IGlmIHNvLAogICBpb21t
dV91bm1hcC4KCkluIG9yZGVyIHRvIGFjaGlldmUgdGhhdDoKCi0gUmVtb3Zl
IFBWIElPTU1VIHJlbGF0ZWQgY29kZSBmcm9tIGd1ZXN0X3BoeXNtYXBfKgoK
LSBSZXB1cnBvc2UgY2xlYW51cF9wYWdlX2NhY2hlYXR0cigpIGludG8gYSBn
ZW5lcmFsCiAgY2xlYW51cF9wYWdlX21hcHBpbmdzKCkgZnVuY3Rpb24sIHdo
aWNoIHdpbGwgYm90aCBmaXggdXAgWGVuCiAgbWFwcGluZ3MgZm9yIHBhZ2Vz
IHdpdGggc3BlY2lhbCBjYWNoZSBhdHRyaWJ1dGVzLCBhbmQgYWxzbyBjaGVj
ayBmb3IKICBhIFBHVF93cml0YWJsZSB0eXBlIGFuZCByZW1vdmUgcGFnZXMg
aWYgYXBwcm9wcmlhdGUuCgotIEZvciBjb21wYXRpYmlsaXR5IHdpdGggY3Vy
cmVudCBndWVzdHMsIGdyYWItYW5kLXJlbGVhc2UgYQogIFBHVF93cml0YWJs
ZV9wYWdlIHR5cGUgZm9yIFBWIGd1ZXN0cyBpbiBndWVzdF9waHlzbWFwX2Fk
ZF9lbnRyeSgpLgogIFRoaXMgd2lsbCBjYXVzZSBtb3N0ICJub3JtYWwiIGd1
ZXN0IHBhZ2VzIHRvIHN0YXJ0IG91dCBsaWZlIHdpdGgKICBQR1Rfd3JpdGFi
bGVfcGFnZSB0eXBlIChhbmQgdGh1cyBhbiBJT01NVSBtYXBwaW5nKSwgYnV0
IG5vIHR5cGUKICBjb3VudCAoc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIGFz
IHNwZWNpYWwgY2FzZXMgYXQgd2lsbCkuCgpBbHNvLCBub3RlIHRoYXQgdGhl
cmUgaXMgb25lIGV4Y2VwdGlvbiB0byB0byB0aGUgIlBHVF93cml0YWJsZSA9
PiBpbgppb21tdSIgcnVsZTogeGVuaGVhcCBwYWdlcyBzaGFyZWQgd2l0aCBn
dWVzdHMgbWF5IGJlIGdpdmVuIGEKUEdUX3dyaXRhYmxlIHR5cGUgd2l0aCBv
bmUgdHlwZSByZWZlcmVuY2UuICBUaGlzIHJlZmVyZW5jZSBwcmV2ZW50cwp0
aGUgdHlwZSBmcm9tIGNoYW5naW5nLCB3aGljaCBpbiB0dXJuIHByZXZlbnRz
IHBhZ2UgZnJvbSBnYWluaW5nIGFuCklPTU1VIG1hcHBpbmcgaW4gZ2V0X3Bh
Z2VfdHlwZSgpLiAgSXQncyBub3QgY2xlYXIgd2hldGhlciB0aGlzIHdhcwpp
bnRlbnRpb25hbCBvciBub3QsIGJ1dCBpdCdzIG5vdCBzb21ldGhpbmcgdG8g
Y2hhbmdlIGluIGEgc2VjdXJpdHkKdXBkYXRlLgoKVGhpcyBpcyBYU0EtMjg4
LgoKUmVwb3J0ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNp
dHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3Jn
ZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICB8IDk1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9tbS9wMm0uYyB8IDQxICsrKysrKysr
KysrLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMTEwIGluc2VydGlvbnMo
KyksIDI2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4
Ni9tbS5jIGIveGVuL2FyY2gveDg2L21tLmMKaW5kZXggNDdmNGFhNGY2YS4u
MTQ0NDc5ODIwYiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21tLmMKKysr
IGIveGVuL2FyY2gveDg2L21tLmMKQEAgLTgxLDYgKzgxLDIyIEBACiAgKiBP
UydzLCB3aGljaCB3aWxsIGdlbmVyYWxseSB1c2UgdGhlIFdQIGJpdCB0byBz
aW1wbGlmeSBjb3B5LW9uLXdyaXRlCiAgKiBpbXBsZW1lbnRhdGlvbiAoaW4g
dGhhdCBjYXNlLCBPUyB3YW50cyBhIGZhdWx0IHdoZW4gaXQgd3JpdGVzIHRv
CiAgKiBhbiBhcHBsaWNhdGlvbi1zdXBwbGllZCBidWZmZXIpLgorICoKKyAq
IFBWIGRvbVVzIGFuZCBJT01NVXM6CisgKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LQorICogRm9yIGEgZ3Vlc3QgdG8gYmUgYWJsZSB0byBETUEgaW50byBhIHBh
Z2UsIHRoYXQgcGFnZSBtdXN0IGJlIGluIHRoZQorICogZG9tYWluJ3MgSU9N
TVUuICBIb3dldmVyLCB3ZSAqbXVzdCBub3QqIGFsbG93IERNQSBpbnRvICdz
cGVjaWFsJworICogcGFnZXMgKHN1Y2ggYXMgcGFnZSB0YWJsZSBwYWdlcywg
ZGVzY3JpcHRvciB0YWJsZXMsICZjKTsgYW5kIHdlCisgKiBtdXN0IGFsc28g
ZW5zdXJlIHRoYXQgbWFwcGluZ3MgYXJlIHJlbW92ZWQgZnJvbSB0aGUgSU9N
TVUgd2hlbiB0aGUKKyAqIHBhZ2UgaXMgZnJlZWQuICBGaW5hbGx5LCBpdCBp
cyBpbmhlcmVudGx5IHJhY3kgdG8gbWFrZSBhbnkgY2hhbmdlcworICogYmFz
ZWQgb24gYSBwYWdlIHdpdGggYSBub24temVybyB0eXBlIGNvdW50LgorICoK
KyAqIFRvIHRoYXQgZW5kLCB3ZSBwdXQgdGhlIHBhZ2UgaW4gdGhlIElPTU1V
IG9ubHkgd2hlbiBhIHBhZ2UgZ2FpbnMKKyAqIHRoZSBQR1Rfd3JpdGVhYmxl
IHR5cGU7IGFuZCB3ZSByZW1vdmUgdGhlIHBhZ2Ugd2hlbiBpdCBsb3NlcyB0
aGUKKyAqIFBHVF93cml0ZWFibGUgdHlwZSAobm90IHdoZW4gdGhlIHR5cGUg
Y291bnQgZ29lcyB0byB6ZXJvKS4gIFRoaXMKKyAqIGVmZmVjdGl2ZWx5IHBy
b3RlY3RzIHRoZSBJT01NVSBzdGF0dXMgdXBkYXRlIHdpdGggdGhlIHR5cGUg
Y291bnQgd2UKKyAqIGhhdmUganVzdCBhY3F1aXJlZC4gIFdlIG11c3QgYWxz
byBjaGVjayBmb3IgUEdUX3dyaXRhYmxlIHR5cGUgd2hlbgorICogZG9pbmcg
dGhlIGZpbmFsIHB1dF9wYWdlKCksIGFuZCByZW1vdmUgaXQgZnJvbSB0aGUg
aW9tbXUgaWYgc28uCiAgKi8KIAogI2luY2x1ZGUgPHhlbi9rY29uZmlnLmg+
CkBAIC0yMzc5LDE5ICsyMzk1LDc5IEBAIHN0YXRpYyBpbnQgbW9kX2w0X2Vu
dHJ5KGw0X3BnZW50cnlfdCAqcGw0ZSwKICAgICByZXR1cm4gcmM7CiB9CiAK
LXN0YXRpYyBpbnQgY2xlYW51cF9wYWdlX2NhY2hlYXR0cihzdHJ1Y3QgcGFn
ZV9pbmZvICpwYWdlKQorLyoKKyAqIEluIHRoZSBjb3Vyc2Ugb2YgYSBwYWdl
J3MgdXNlLCBpdCBtYXkgaGF2ZSBjYXVzZWQgb3RoZXIgc2Vjb25kYXJ5Cisg
KiBtYXBwaW5ncyB0byBoYXZlIGNoYW5nZWQ6CisgKiAtIFhlbidzIG1hcHBp
bmdzIG1heSBoYXZlIGJlZW4gY2hhbmdlZCB0byBhY2NvbW9kYXRlIHRoZSBy
ZXF1ZXN0ZWQKKyAqICAgY2FjaGUgYXR0aWJ1dGVzCisgKiAtIEEgcGFnZSBt
YXkgaGF2ZSBiZWVuIHB1dCBpbnRvIHRoZSBJT01NVSBvZiBhIFBWIGd1ZXN0
IHdoZW4gaXQKKyAqICAgZ2FpbmVkIGEgd3JpdGFibGUgbWFwcGluZy4KKyAq
CisgKiBOb3cgdGhhdCB0aGUgcGFnZSBpcyBiZWluZyBmcmVlZCwgY2xlYW4g
dXAgdGhlc2UgbWFwcGluZ3MgaWYKKyAqIGFwcHJvcHJpYXRlLiAgTkIgdGhh
dCBhdCB0aGlzIHBvaW50IHRoZSBwYWdlIGlzIHN0aWxsICJhbGxvY2F0ZWQi
LAorICogYnV0IG5vdCAibGl2ZSIgKGkuZS4sIGl0cyByZWZjb3VudCBpcyAw
KSwgc28gaXQncyBzYWZlIHRvIHJlYWQgdGhlCisgKiBjb3VudF9pbmZvLCBv
d25lciwgYW5kIHR5cGVfaW5mbyB3aXRob3V0IHN5bmNocm9uaXphdGlvbi4K
KyAqLworc3RhdGljIGludCBjbGVhbnVwX3BhZ2VfbWFwcGluZ3Moc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKIHsKICAgICB1bnNpZ25lZCBpbnQgY2FjaGVh
dHRyID0KICAgICAgICAgKHBhZ2UtPmNvdW50X2luZm8gJiBQR0NfY2FjaGVh
dHRyX21hc2spID4+IFBHQ19jYWNoZWF0dHJfYmFzZTsKKyAgICBpbnQgcmMg
PSAwOworICAgIHVuc2lnbmVkIGxvbmcgbWZuID0gcGFnZV90b19tZm4ocGFn
ZSk7CiAKLSAgICBpZiAoIGxpa2VseShjYWNoZWF0dHIgPT0gMCkgKQotICAg
ICAgICByZXR1cm4gMDsKKyAgICAvKgorICAgICAqIElmIHdlJ3ZlIG1vZGlm
aWVkIHhlbiBtYXBwaW5ncyBhcyBhIHJlc3VsdCBvZiBndWVzdCBjYWNoZQor
ICAgICAqIGF0dHJpYnV0ZXMsIHJlc3RvcmUgdGhlbSB0byB0aGUgIm5vcm1h
bCIgc3RhdGUuCisgICAgICovCisgICAgaWYgKCB1bmxpa2VseShjYWNoZWF0
dHIpICkKKyAgICB7CisgICAgICAgIHBhZ2UtPmNvdW50X2luZm8gJj0gflBH
Q19jYWNoZWF0dHJfbWFzazsKIAotICAgIHBhZ2UtPmNvdW50X2luZm8gJj0g
flBHQ19jYWNoZWF0dHJfbWFzazsKKyAgICAgICAgQlVHX09OKGlzX3hlbl9o
ZWFwX3BhZ2UocGFnZSkpOwogCi0gICAgQlVHX09OKGlzX3hlbl9oZWFwX3Bh
Z2UocGFnZSkpOworICAgICAgICByYyA9IHVwZGF0ZV94ZW5fbWFwcGluZ3Mo
bWZuLCAwKTsKKyAgICB9CiAKLSAgICByZXR1cm4gdXBkYXRlX3hlbl9tYXBw
aW5ncyhwYWdlX3RvX21mbihwYWdlKSwgMCk7CisgICAgLyoKKyAgICAgKiBJ
ZiB0aGlzIG1heSBiZSBpbiBhIFBWIGRvbWFpbidzIElPTU1VLCByZW1vdmUg
aXQuCisgICAgICoKKyAgICAgKiBOQiB0aGF0IHdyaXRhYmxlIHhlbmhlYXAg
cGFnZXMgaGF2ZSB0aGVpciB0eXBlIHNldCBhbmQgY2xlYXJlZCBieQorICAg
ICAqIGltcGxlbWVudGF0aW9uLXNwZWNpZmljIGNvZGUsIHJhdGhlciB0aGFu
IGJ5IGdldF9wYWdlX3R5cGUoKS4gIEFzIHN1Y2g6CisgICAgICogLSBUaGV5
IGFyZW4ndCBleHBlY3RlZCB0byBoYXZlIGFuIElPTU1VIG1hcHBpbmcsIGFu
ZAorICAgICAqIC0gV2UgZG9uJ3QgbmVjZXNzYXJpbHkgZXhwZWN0IHRoZSB0
eXBlIGNvdW50IHRvIGJlIHplcm8gd2hlbiB0aGUgZmluYWwKKyAgICAgKiBw
dXRfcGFnZSBoYXBwZW5zLgorICAgICAqCisgICAgICogR28gYWhlYWQgYW5k
IGF0dGVtcCB0byBjYWxsIGlvbW11X3VubWFwKCkgb24geGVuaGVhcCBwYWdl
cyBhbnl3YXksIGp1c3QKKyAgICAgKiBpbiBjYXNlOyBidXQgb25seSBBU1NF
UlQoKSB0aGF0IHRoZSB0eXBlIGNvdW50IGlzIHplcm8gYW5kIHJlbW92ZSB0
aGUKKyAgICAgKiBQR1Rfd3JpdGFibGUgdHlwZSBmb3Igbm9uLXhlbmhlYXAg
cGFnZXMuCisgICAgICovCisgICAgaWYgKCAocGFnZS0+dS5pbnVzZS50eXBl
X2luZm8gJiBQR1RfdHlwZV9tYXNrKSA9PSBQR1Rfd3JpdGFibGVfcGFnZSAp
CisgICAgeworICAgICAgICBzdHJ1Y3QgZG9tYWluICpkID0gcGFnZV9nZXRf
b3duZXIocGFnZSk7CisKKyAgICAgICAgaWYgKCBkICYmIGlzX3B2X2RvbWFp
bihkKSAmJiB1bmxpa2VseShuZWVkX2lvbW11KGQpKSApCisgICAgICAgIHsK
KyAgICAgICAgICAgIGludCByYzIgPSBpb21tdV91bm1hcF9wYWdlKGQsIG1m
bik7CisKKyAgICAgICAgICAgIGlmICggIXJjICkKKyAgICAgICAgICAgICAg
ICByYyA9IHJjMjsKKyAgICAgICAgfQorCisgICAgICAgIGlmICggbGlrZWx5
KCFpc194ZW5faGVhcF9wYWdlKHBhZ2UpKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIEFTU0VSVCgocGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJgorICAg
ICAgICAgICAgICAgICAgICAoUEdUX3R5cGVfbWFzayB8IFBHVF9jb3VudF9t
YXNrKSkgPT0gUEdUX3dyaXRhYmxlX3BhZ2UpOworICAgICAgICAgICAgLyoK
KyAgICAgICAgICAgICAqIENsZWFyIHRoZSB0eXBlIHRvIHJlY29yZCB0aGUg
ZmFjdCB0aGF0IGFsbCB3cml0YWJsZSBtYXBwaW5ncworICAgICAgICAgICAg
ICogaGF2ZSBiZWVuIHJlbW92ZWQuICBCdXQgaWYgZWl0aGVyIG9wZXJhdGlv
biBmYWlsZWQsIGxlYXZlCisgICAgICAgICAgICAgKiB0eXBlX2luZm8gYWxv
bmUuCisgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgIGlmICggbGlrZWx5
KCFyYykgKQorICAgICAgICAgICAgICAgIHBhZ2UtPnUuaW51c2UudHlwZV9p
bmZvICY9IH4oUEdUX3R5cGVfbWFzayB8IFBHVF9jb3VudF9tYXNrKTsKKyAg
ICAgICAgfQorICAgIH0KKworICAgIHJldHVybiByYzsKIH0KIAogdm9pZCBw
dXRfcGFnZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKQpAQCAtMjQwNyw3ICsy
NDgzLDcgQEAgdm9pZCBwdXRfcGFnZShzdHJ1Y3QgcGFnZV9pbmZvICpwYWdl
KQogCiAgICAgaWYgKCB1bmxpa2VseSgobnggJiBQR0NfY291bnRfbWFzaykg
PT0gMCkgKQogICAgIHsKLSAgICAgICAgaWYgKCBjbGVhbnVwX3BhZ2VfY2Fj
aGVhdHRyKHBhZ2UpID09IDAgKQorICAgICAgICBpZiAoICFjbGVhbnVwX3Bh
Z2VfbWFwcGluZ3MocGFnZSkgKQogICAgICAgICAgICAgZnJlZV9kb21oZWFw
X3BhZ2UocGFnZSk7CiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIE1FTV9M
T0coIkxlYWtpbmcgcGZuICVseCIsIHBhZ2VfdG9fbWZuKHBhZ2UpKTsKQEAg
LTQ3NzEsOSArNDg0NywxMCBAQCBpbnQgc3RlYWxfcGFnZSgKICAgICAgKiBO
QiB0aGlzIGlzIHNhZmUgZXZlbiBpZiB0aGUgcGFnZSBlbmRzIHVwIGJlaW5n
IGdpdmVuIGJhY2sgdG8KICAgICAgKiB0aGUgZG9tYWluLCBiZWNhdXNlIHRo
ZSBjb3VudCBpcyB6ZXJvOiBzdWJzZXF1ZW50IG1hcHBpbmdzIHdpbGwKICAg
ICAgKiBjYXVzZSB0aGUgY2FjaGUgYXR0cmlidXRlcyB0byBiZSByZS1pbnN0
YXRlZCBpbnNpZGUKLSAgICAgKiBnZXRfcGFnZV9mcm9tX2wxZSgpLgorICAg
ICAqIGdldF9wYWdlX2Zyb21fbDFlKCksIG9yIHRoZSBwYWdlIHRvIGJlIGFk
ZGVkIGJhY2sgdG8gdGhlIElPTU1VCisgICAgICogdXBvbiB0aGUgdHlwZSBj
aGFuZ2luZyB0byBQR1Rfd3JpdGVhYmxlLCBhcyBhcHByb3ByaWF0ZS4KICAg
ICAgKi8KLSAgICBpZiAoIChyYyA9IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIo
cGFnZSkpICkKKyAgICBpZiAoIChyYyA9IGNsZWFudXBfcGFnZV9tYXBwaW5n
cyhwYWdlKSkgKQogICAgIHsKICAgICAgICAgLyoKICAgICAgICAgICogQ291
bGRuJ3QgZml4dXAgWGVuJ3MgbWFwcGluZ3M7IHB1dCB0aGluZ3MgdGhlIHdh
eSB3ZSBmb3VuZApkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tL3AybS5j
IGIveGVuL2FyY2gveDg2L21tL3AybS5jCmluZGV4IDdiYmI3ODJiZGUuLjE0
ZjViZGI3ODcgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwor
KysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLmMKQEAgLTY0MiwxMyArNjQyLDkg
QEAgcDJtX3JlbW92ZV9wYWdlKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIHVu
c2lnbmVkIGxvbmcgZ2ZuLCB1bnNpZ25lZCBsb25nIG1mbiwKICAgICBwMm1f
dHlwZV90IHQ7CiAgICAgcDJtX2FjY2Vzc190IGE7CiAKKyAgICAvKiBJT01N
VSBmb3IgUFYgZ3Vlc3RzIGlzIGhhbmRsZWQgaW4gZ2V0X3BhZ2VfdHlwZSgp
IGFuZCBwdXRfcGFnZSgpLiAqLwogICAgIGlmICggIXBhZ2luZ19tb2RlX3Ry
YW5zbGF0ZShwMm0tPmRvbWFpbikgKQotICAgIHsKLSAgICAgICAgaWYgKCBu
ZWVkX2lvbW11KHAybS0+ZG9tYWluKSApCi0gICAgICAgICAgICBmb3IgKCBp
ID0gMDsgaSA8ICgxIDw8IHBhZ2Vfb3JkZXIpOyBpKysgKQotICAgICAgICAg
ICAgICAgIGlvbW11X3VubWFwX3BhZ2UocDJtLT5kb21haW4sIG1mbiArIGkp
OwogICAgICAgICByZXR1cm4gMDsKLSAgICB9CiAKICAgICBBU1NFUlQoZ2Zu
X2xvY2tlZF9ieV9tZShwMm0sIGdmbikpOwogICAgIFAyTV9ERUJVRygicmVt
b3ZpbmcgZ2ZuPSUjbHggbWZuPSUjbHhcbiIsIGdmbiwgbWZuKTsKQEAgLTY5
MiwyMiArNjg4LDMzIEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVj
dCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLAogICAgIGludCBwb2Rf
Y291bnQgPSAwOwogICAgIGludCByYyA9IDA7CiAKKyAgICAvKiBJT01NVSBm
b3IgUFYgZ3Vlc3RzIGlzIGhhbmRsZWQgaW4gZ2V0X3BhZ2VfdHlwZSgpIGFu
ZCBwdXRfcGFnZSgpLiAqLwogICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5z
bGF0ZShkKSApCiAgICAgewotICAgICAgICBpZiAoIG5lZWRfaW9tbXUoZCkg
JiYgdCA9PSBwMm1fcmFtX3J3ICkKKyAgICAgICAgc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSA9IG1mbl90b19wYWdlKF9tZm4obWZuKSk7CisKKyAgICAgICAg
LyoKKyAgICAgICAgICogT3VyIGludGVyZmFjZSBmb3IgUFYgZ3Vlc3RzIHdy
dCBJT01NVSBlbnRyaWVzIGhhc24ndCBiZWVuIHZlcnkKKyAgICAgICAgICog
Y2xlYXI7IGJ1dCBoaXN0b3JpY2FsbHksIHBhZ2VzIGhhdmUgc3RhcnRlZCBv
dXQgd2l0aCBJT01NVSBtYXBwaW5ncywKKyAgICAgICAgICogYW5kIG9ubHkg
bG9zZSB0aGVtIHdoZW4gY2hhbmdlZCB0byBhIGRpZmZlcmVudCBwYWdlIHR5
cGUuCisgICAgICAgICAqCisgICAgICAgICAqIFJldGFpbiB0aGlzIHByb3Bl
cnR5IGJ5IGdyYWJiaW5nIGEgd3JpdGFibGUgdHlwZSByZWYgYW5kIHRoZW4K
KyAgICAgICAgICogZHJvcHBpbmcgaXQgaW1tZWRpYXRlbHkuICBUaGUgcmVz
dWx0IHdpbGwgYmUgcGFnZXMgdGhhdCBoYXZlIGEKKyAgICAgICAgICogd3Jp
dGFibGUgdHlwZSAoYW5kIGFuIElPTU1VIGVudHJ5KSwgYnV0IGEgY291bnQg
b2YgMCAoc3VjaCB0aGF0CisgICAgICAgICAqIGFueSBndWVzdC1yZXF1ZXN0
ZWQgdHlwZSBjaGFuZ2VzIHN1Y2NlZWQgYW5kIHJlbW92ZSB0aGUgSU9NTVUK
KyAgICAgICAgICogZW50cnkpLgorICAgICAgICAgKi8KKyAgICAgICAgaWYg
KCAhbmVlZF9pb21tdShkKSB8fCB0ICE9IHAybV9yYW1fcncgKQorICAgICAg
ICAgICAgcmV0dXJuIDA7CisKKyAgICAgICAgZm9yICggaSA9IDA7IGkgPCAo
MVVMIDw8IHBhZ2Vfb3JkZXIpOyArK2ksICsrcGFnZSApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDEgPDwgcGFnZV9vcmRl
cik7IGkrKyApCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcmMg
PSBpb21tdV9tYXBfcGFnZSgKLSAgICAgICAgICAgICAgICAgICAgZCwgbWZu
ICsgaSwgbWZuICsgaSwgSU9NTVVGX3JlYWRhYmxlfElPTU1VRl93cml0YWJs
ZSk7Ci0gICAgICAgICAgICAgICAgaWYgKCByYyAhPSAwICkKLSAgICAgICAg
ICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIHdoaWxlICggaS0tID4g
MCApCi0gICAgICAgICAgICAgICAgICAgICAgICBpb21tdV91bm1hcF9wYWdl
KGQsIG1mbiArIGkpOwotICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmM7
Ci0gICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgfQorICAgICAgICAg
ICAgaWYgKCBnZXRfcGFnZV9hbmRfdHlwZShwYWdlLCBkLCBQR1Rfd3JpdGFi
bGVfcGFnZSkgKQorICAgICAgICAgICAgICAgIHB1dF9wYWdlX2FuZF90eXBl
KHBhZ2UpOworICAgICAgICAgICAgZWxzZQorICAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOwogICAgICAgICB9CisKICAgICAgICAgcmV0dXJuIDA7
CiAgICAgfQogCi0tIAoyLjIwLjEKCg==

--=separator
Content-Type: application/octet-stream; name="xsa288-4.8.patch"
Content-Disposition: attachment; filename="xsa288-4.8.patch"
Content-Transfer-Encoding: base64

RnJvbSBjNDE2OWE3MmViMzkxYzZhMzgxYmMxODVlZmM4ZTgzZjI3MzQ1ODAx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMjMgSmFu
IDIwMTkgMTE6NTc6NDYgKzAwMDAKU3ViamVjdDogW1BBVENIXSB4ZW46IE1h
a2UgY29oZXJlbnQgUFYgSU9NTVUgZGlzY2lwbGluZQoKSW4gb3JkZXIgZm9y
IGEgUFYgZG9tYWluIHRvIHNldCB1cCBETUEgZnJvbSBhIHBhc3NlZC10aHJv
dWdoIGRldmljZSB0bwpvbmUgb2YgaXRzIHBhZ2VzLCB0aGUgcGFnZSBtdXN0
IGJlIG1hcHBlZCBpbiB0aGUgSU9NTVUuICBPbiB0aGUgb3RoZXIKaGFuZCwg
YmVmb3JlIGEgUFYgcGFnZSBtYXkgYmUgdXNlZCBhcyBhICJzcGVjaWFsIiBw
YWdlIHR5cGUgKHN1Y2ggYXMgYQpwYWdldGFibGUgb3IgZGVzY3JpcHRvciB0
YWJsZSksIGl0IF9tdXN0IG5vdF8gYmUgd3JpdGFibGUgaW4gdGhlIElPTU1V
CihvdGhlcndpc2UgYSBtYWxpY2lvdXMgZ3Vlc3QgY291bGQgRE1BIGFyYml0
cmFyeSBwYWdlIHRhYmxlcyBpbnRvIHRoZQptZW1vcnksIGJ5cGFzc2luZyBY
ZW4ncyBzYWZldHkgY2hlY2tzKTsgYW5kIFhlbidzIGN1cnJlbnQgcnVsZSBp
cyB0bwpoYXZlIHN1Y2ggcGFnZXMgbm90IGluIHRoZSBJT01NVSBhdCBhbGwu
CgpBdCB0aGUgbW9tZW50LCBpbiBvcmRlciB0byBhY2NvbXBsaXNoIHRoaXMs
IHRoZSBjb2RlIGJvcnJvd3MgSFZNCmRvbWFpbidzICJwaHlzbWFwIiBjb25j
ZXB0OiBXaGVuIGEgcGFnZSBpcyBhc3NpZ25lZCB0byBhIGd1ZXN0LApndWVz
c19waHlzbWFwX2FkZF9lbnRyeSgpIGlzIGNhbGxlZCwgd2hpY2ggZm9yIFBW
IGd1ZXN0cywgd2lsbCBjcmVhdGUKYSB3cml0YWJsZSBJT01NVSBtYXBwaW5n
OyBhbmQgd2hlbiBhIHBhZ2UgaXMgcmVtb3ZlZCwKZ3Vlc3RfcGh5c21hcF9y
ZW1vdmVfZW50cnkoKSBpcyBjYWxsZWQsIHdoaWNoIHdpbGwgcmVtb3ZlIHRo
ZSBtYXBwaW5nLgoKQWRkaXRpb25hbGx5LCB3aGVuIGEgcGFnZSBnYWlucyB0
aGUgUEdUX3dyaXRhYmxlIHBhZ2UgdHlwZSwgdGhlIHBhZ2UKd2lsbCBiZSBh
ZGRlZCBpbnRvIHRoZSBJT01NVTsgYW5kIHdoZW4gdGhlIHBhZ2UgY2hhbmdl
cyBhd2F5IGZyb20gYQpQR1Rfd3JpdGFibGUgdHlwZSwgdGhlIHBhZ2Ugd2ls
bCBiZSByZW1vdmVkIGZyb20gdGhlIElPTU1VLgoKVW5mb3J0dW5hdGVseSwg
Ym9ycm93aW5nIHRoZSAicGh5c21hcCIgY29uY2VwdCBmcm9tIEhWTSBkb21h
aW5zIGlzCnByb2JsZW1hdGljLiAgSFZNIGRvbWFpbnMgaGF2ZSBhIGxvY2sg
b24gdGhlaXIgcDJtIHRhYmxlcywgZW5zdXJpbmcKc3luY2hyb25pemF0aW9u
IGJldHdlZW4gbW9kaWZpY2F0aW9ucyB0byB0aGUgcDJtOyBhbmQgYWxsIGh5
cGVyY2FsbApwYXJhbWV0ZXJzIG11c3QgZmlyc3QgYmUgdHJhbnNsYXRlZCB0
aHJvdWdoIHRoZSBwMm0gYmVmb3JlIGJlaW5nIHVzZWQuCgpUcnlpbmcgdG8g
bWl4IHRoaXMgbG9ja2VkLWFuZC1nYXRlZCBhcHByb2FjaCB3aXRoIFBWJ3Mg
bG9jay1mcmVlCmFwcHJvYWNoIGxlYWRzIHRvIHNldmVyYWwgcmFjZXMgYW5k
IGluY29uc2lzdGVuY2llczoKCiogQSByYWNlIGJldHdlZW4gYSBwYWdlIGJl
aW5nIGFzc2lnbmVkIGFuZCBpdCBiZWluZyBwdXQgaW50byB0aGUKICBwaHlz
bWFwOyBmb3IgZXhhbXBsZToKICAtIFAxOiBjYWxsIHBvcHVsYXRlX3BoeXNt
YXAoKSB7IEEgPSBhbGxvY2F0ZV9kb21oZWFwX3BhZ2VzKCkgfQogIC0gUDI6
IEd1ZXNzIHBhZ2UgQSdzIG1mbiwgYW5kIGNhbGwgZGVjcmVhc2VfcmVzZXJ2
YXRpb24oQSkuICBBIGlzIG93bmVkIGJ5IHRoZSBkb21haW4sCiAgICAgICAg
YW5kIHNvIFhlbiB3aWxsIGNsZWFyIHRoZSBQR0NfYWxsb2NhdGVkIGJpdCBh
bmQgZnJlZSB0aGUgcGFnZQogIC0gUDE6IGZpbmlzaGVzIHBvcHVsYXRlX3Bo
eXNtYXAoKSB7IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KCkgfQoKICBOb3cg
dGhlIGRvbWFpbiBoYXMgYSB3cml0YWJsZSBJT01NVSBtYXBwaW5nIHRvIGEg
cGFnZSBpdCBubyBsb25nZXIgb3ducy4KCiogUGFnZXMgc3RhcnQgb3V0IGFz
IHR5cGUgUEdUX25vbmUsIGJ1dCB3aXRoIGEgd3JpdGFibGUgSU9NTVUgbWFw
cGluZy4KICBJZiBhIGd1ZXN0IHVzZXMgYSBwYWdlIGFzIGEgcGFnZSB0YWJs
ZSB3aXRob3V0IGV2ZXIgaGF2aW5nIGNyZWF0ZWQgYQogIHdyaXRhYmxlIG1h
cHBpbmcsIHRoZSBJT01NVSBtYXBwaW5nIHdpbGwgbm90IGJlIHJlbW92ZWQ7
IHRoZSBndWVzdAogIHdpbGwgaGF2ZSBhIHdyaXRhYmxlIElPTU1VIG1hcHBp
bmcgdG8gYSBwYWdlIGl0IGlzIGN1cnJlbnRseSB1c2luZwogIGFzIGEgcGFn
ZSB0YWJsZS4KCiogQSBuZXdseS1hbGxvY2F0ZWQgcGFnZSBjYW4gYmUgRE1B
J2QgaW50byB3aXRoIG5vIHNwZWNpYWwgYWN0aW9ucyBvbgogIHRoZSBwYXJ0
IG9mIHRoZSBndWVzdDsgSG93ZXZlciwgaWYgYSBwYWdlIGlzIHByb21vdGVk
IHRvIGEKICBub24td3JpdGFibGUgdHlwZSwgdGhlIHBhZ2UgbXVzdCBiZSBt
YXBwZWQgd2l0aCBhIHdyaXRhYmxlIHR5cGUgYmVmb3JlCiAgRE1BJ2luZyB0
byBpdCBhZ2Fpbiwgb3IgdGhlIHRyYW5zYWN0aW9uIHdpbGwgZmFpbC4KClRv
IGZpeCB0aGlzLCBkbyBhd2F5IHdpdGggdGhlICJQViBwaHlzbWFwIiBjb25j
ZXB0IGVudGlyZWx5LCBhbmQKcmVwbGFjZSBpdCB3aXRoIHRoZSBmb2xsb3dp
bmcgSU9NTVUgZGlzY2lwbGluZSBmb3IgUFYgZ3Vlc3RzOgogLSAodHlwZSA9
PSBQR1Rfd3JpdGFibGUpIDw9PiBpbiBpb21tdSAoZXZlbiBpZiB0eXBlX2Nv
dW50ID09IDApCiAtIFVwb24gYSBmaW5hbCBwdXRfcGFnZSgpLCBjaGVjayB0
byBzZWUgaWYgdHlwZSBpcyBQR1Rfd3JpdGFibGU7IGlmIHNvLAogICBpb21t
dV91bm1hcC4KCkluIG9yZGVyIHRvIGFjaGlldmUgdGhhdDoKCi0gUmVtb3Zl
IFBWIElPTU1VIHJlbGF0ZWQgY29kZSBmcm9tIGd1ZXN0X3BoeXNtYXBfKgoK
LSBSZXB1cnBvc2UgY2xlYW51cF9wYWdlX2NhY2hlYXR0cigpIGludG8gYSBn
ZW5lcmFsCiAgY2xlYW51cF9wYWdlX21hcHBpbmdzKCkgZnVuY3Rpb24sIHdo
aWNoIHdpbGwgYm90aCBmaXggdXAgWGVuCiAgbWFwcGluZ3MgZm9yIHBhZ2Vz
IHdpdGggc3BlY2lhbCBjYWNoZSBhdHRyaWJ1dGVzLCBhbmQgYWxzbyBjaGVj
ayBmb3IKICBhIFBHVF93cml0YWJsZSB0eXBlIGFuZCByZW1vdmUgcGFnZXMg
aWYgYXBwcm9wcmlhdGUuCgotIEZvciBjb21wYXRpYmlsaXR5IHdpdGggY3Vy
cmVudCBndWVzdHMsIGdyYWItYW5kLXJlbGVhc2UgYQogIFBHVF93cml0YWJs
ZV9wYWdlIHR5cGUgZm9yIFBWIGd1ZXN0cyBpbiBndWVzdF9waHlzbWFwX2Fk
ZF9lbnRyeSgpLgogIFRoaXMgd2lsbCBjYXVzZSBtb3N0ICJub3JtYWwiIGd1
ZXN0IHBhZ2VzIHRvIHN0YXJ0IG91dCBsaWZlIHdpdGgKICBQR1Rfd3JpdGFi
bGVfcGFnZSB0eXBlIChhbmQgdGh1cyBhbiBJT01NVSBtYXBwaW5nKSwgYnV0
IG5vIHR5cGUKICBjb3VudCAoc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIGFz
IHNwZWNpYWwgY2FzZXMgYXQgd2lsbCkuCgpBbHNvLCBub3RlIHRoYXQgdGhl
cmUgaXMgb25lIGV4Y2VwdGlvbiB0byB0byB0aGUgIlBHVF93cml0YWJsZSA9
PiBpbgppb21tdSIgcnVsZTogeGVuaGVhcCBwYWdlcyBzaGFyZWQgd2l0aCBn
dWVzdHMgbWF5IGJlIGdpdmVuIGEKUEdUX3dyaXRhYmxlIHR5cGUgd2l0aCBv
bmUgdHlwZSByZWZlcmVuY2UuICBUaGlzIHJlZmVyZW5jZSBwcmV2ZW50cwp0
aGUgdHlwZSBmcm9tIGNoYW5naW5nLCB3aGljaCBpbiB0dXJuIHByZXZlbnRz
IHBhZ2UgZnJvbSBnYWluaW5nIGFuCklPTU1VIG1hcHBpbmcgaW4gZ2V0X3Bh
Z2VfdHlwZSgpLiAgSXQncyBub3QgY2xlYXIgd2hldGhlciB0aGlzIHdhcwpp
bnRlbnRpb25hbCBvciBub3QsIGJ1dCBpdCdzIG5vdCBzb21ldGhpbmcgdG8g
Y2hhbmdlIGluIGEgc2VjdXJpdHkKdXBkYXRlLgoKVGhpcyBpcyBYU0EtMjg4
LgoKUmVwb3J0ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNp
dHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3Jn
ZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICB8IDk1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9tbS9wMm0uYyB8IDU3ICsrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDExMSBpbnNl
cnRpb25zKCspLCA0MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IGVmM2Iy
MDhmYjAuLjlmMzc1YmMyMzYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9t
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC04MSw2ICs4MSwyMiBA
QAogICogT1Mncywgd2hpY2ggd2lsbCBnZW5lcmFsbHkgdXNlIHRoZSBXUCBi
aXQgdG8gc2ltcGxpZnkgY29weS1vbi13cml0ZQogICogaW1wbGVtZW50YXRp
b24gKGluIHRoYXQgY2FzZSwgT1Mgd2FudHMgYSBmYXVsdCB3aGVuIGl0IHdy
aXRlcyB0bwogICogYW4gYXBwbGljYXRpb24tc3VwcGxpZWQgYnVmZmVyKS4K
KyAqCisgKiBQViBkb21VcyBhbmQgSU9NTVVzOgorICogLS0tLS0tLS0tLS0t
LS0tLS0tLS0KKyAqIEZvciBhIGd1ZXN0IHRvIGJlIGFibGUgdG8gRE1BIGlu
dG8gYSBwYWdlLCB0aGF0IHBhZ2UgbXVzdCBiZSBpbiB0aGUKKyAqIGRvbWFp
bidzIElPTU1VLiAgSG93ZXZlciwgd2UgKm11c3Qgbm90KiBhbGxvdyBETUEg
aW50byAnc3BlY2lhbCcKKyAqIHBhZ2VzIChzdWNoIGFzIHBhZ2UgdGFibGUg
cGFnZXMsIGRlc2NyaXB0b3IgdGFibGVzLCAmYyk7IGFuZCB3ZQorICogbXVz
dCBhbHNvIGVuc3VyZSB0aGF0IG1hcHBpbmdzIGFyZSByZW1vdmVkIGZyb20g
dGhlIElPTU1VIHdoZW4gdGhlCisgKiBwYWdlIGlzIGZyZWVkLiAgRmluYWxs
eSwgaXQgaXMgaW5oZXJlbnRseSByYWN5IHRvIG1ha2UgYW55IGNoYW5nZXMK
KyAqIGJhc2VkIG9uIGEgcGFnZSB3aXRoIGEgbm9uLXplcm8gdHlwZSBjb3Vu
dC4KKyAqCisgKiBUbyB0aGF0IGVuZCwgd2UgcHV0IHRoZSBwYWdlIGluIHRo
ZSBJT01NVSBvbmx5IHdoZW4gYSBwYWdlIGdhaW5zCisgKiB0aGUgUEdUX3dy
aXRlYWJsZSB0eXBlOyBhbmQgd2UgcmVtb3ZlIHRoZSBwYWdlIHdoZW4gaXQg
bG9zZXMgdGhlCisgKiBQR1Rfd3JpdGVhYmxlIHR5cGUgKG5vdCB3aGVuIHRo
ZSB0eXBlIGNvdW50IGdvZXMgdG8gemVybykuICBUaGlzCisgKiBlZmZlY3Rp
dmVseSBwcm90ZWN0cyB0aGUgSU9NTVUgc3RhdHVzIHVwZGF0ZSB3aXRoIHRo
ZSB0eXBlIGNvdW50IHdlCisgKiBoYXZlIGp1c3QgYWNxdWlyZWQuICBXZSBt
dXN0IGFsc28gY2hlY2sgZm9yIFBHVF93cml0YWJsZSB0eXBlIHdoZW4KKyAq
IGRvaW5nIHRoZSBmaW5hbCBwdXRfcGFnZSgpLCBhbmQgcmVtb3ZlIGl0IGZy
b20gdGhlIGlvbW11IGlmIHNvLgogICovCiAKICNpbmNsdWRlIDx4ZW4va2Nv
bmZpZy5oPgpAQCAtMjM4MCwxOSArMjM5Niw3OSBAQCBzdGF0aWMgaW50IG1v
ZF9sNF9lbnRyeShsNF9wZ2VudHJ5X3QgKnBsNGUsCiAgICAgcmV0dXJuIHJj
OwogfQogCi1zdGF0aWMgaW50IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIoc3Ry
dWN0IHBhZ2VfaW5mbyAqcGFnZSkKKy8qCisgKiBJbiB0aGUgY291cnNlIG9m
IGEgcGFnZSdzIHVzZSwgaXQgbWF5IGhhdmUgY2F1c2VkIG90aGVyIHNlY29u
ZGFyeQorICogbWFwcGluZ3MgdG8gaGF2ZSBjaGFuZ2VkOgorICogLSBYZW4n
cyBtYXBwaW5ncyBtYXkgaGF2ZSBiZWVuIGNoYW5nZWQgdG8gYWNjb21vZGF0
ZSB0aGUgcmVxdWVzdGVkCisgKiAgIGNhY2hlIGF0dGlidXRlcworICogLSBB
IHBhZ2UgbWF5IGhhdmUgYmVlbiBwdXQgaW50byB0aGUgSU9NTVUgb2YgYSBQ
ViBndWVzdCB3aGVuIGl0CisgKiAgIGdhaW5lZCBhIHdyaXRhYmxlIG1hcHBp
bmcuCisgKgorICogTm93IHRoYXQgdGhlIHBhZ2UgaXMgYmVpbmcgZnJlZWQs
IGNsZWFuIHVwIHRoZXNlIG1hcHBpbmdzIGlmCisgKiBhcHByb3ByaWF0ZS4g
IE5CIHRoYXQgYXQgdGhpcyBwb2ludCB0aGUgcGFnZSBpcyBzdGlsbCAiYWxs
b2NhdGVkIiwKKyAqIGJ1dCBub3QgImxpdmUiIChpLmUuLCBpdHMgcmVmY291
bnQgaXMgMCksIHNvIGl0J3Mgc2FmZSB0byByZWFkIHRoZQorICogY291bnRf
aW5mbywgb3duZXIsIGFuZCB0eXBlX2luZm8gd2l0aG91dCBzeW5jaHJvbml6
YXRpb24uCisgKi8KK3N0YXRpYyBpbnQgY2xlYW51cF9wYWdlX21hcHBpbmdz
KHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7CiAgICAgdW5zaWduZWQgaW50
IGNhY2hlYXR0ciA9CiAgICAgICAgIChwYWdlLT5jb3VudF9pbmZvICYgUEdD
X2NhY2hlYXR0cl9tYXNrKSA+PiBQR0NfY2FjaGVhdHRyX2Jhc2U7CisgICAg
aW50IHJjID0gMDsKKyAgICB1bnNpZ25lZCBsb25nIG1mbiA9IHBhZ2VfdG9f
bWZuKHBhZ2UpOwogCi0gICAgaWYgKCBsaWtlbHkoY2FjaGVhdHRyID09IDAp
ICkKLSAgICAgICAgcmV0dXJuIDA7CisgICAgLyoKKyAgICAgKiBJZiB3ZSd2
ZSBtb2RpZmllZCB4ZW4gbWFwcGluZ3MgYXMgYSByZXN1bHQgb2YgZ3Vlc3Qg
Y2FjaGUKKyAgICAgKiBhdHRyaWJ1dGVzLCByZXN0b3JlIHRoZW0gdG8gdGhl
ICJub3JtYWwiIHN0YXRlLgorICAgICAqLworICAgIGlmICggdW5saWtlbHko
Y2FjaGVhdHRyKSApCisgICAgeworICAgICAgICBwYWdlLT5jb3VudF9pbmZv
ICY9IH5QR0NfY2FjaGVhdHRyX21hc2s7CiAKLSAgICBwYWdlLT5jb3VudF9p
bmZvICY9IH5QR0NfY2FjaGVhdHRyX21hc2s7CisgICAgICAgIEJVR19PTihp
c194ZW5faGVhcF9wYWdlKHBhZ2UpKTsKIAotICAgIEJVR19PTihpc194ZW5f
aGVhcF9wYWdlKHBhZ2UpKTsKKyAgICAgICAgcmMgPSB1cGRhdGVfeGVuX21h
cHBpbmdzKG1mbiwgMCk7CisgICAgfQogCi0gICAgcmV0dXJuIHVwZGF0ZV94
ZW5fbWFwcGluZ3MocGFnZV90b19tZm4ocGFnZSksIDApOworICAgIC8qCisg
ICAgICogSWYgdGhpcyBtYXkgYmUgaW4gYSBQViBkb21haW4ncyBJT01NVSwg
cmVtb3ZlIGl0LgorICAgICAqCisgICAgICogTkIgdGhhdCB3cml0YWJsZSB4
ZW5oZWFwIHBhZ2VzIGhhdmUgdGhlaXIgdHlwZSBzZXQgYW5kIGNsZWFyZWQg
YnkKKyAgICAgKiBpbXBsZW1lbnRhdGlvbi1zcGVjaWZpYyBjb2RlLCByYXRo
ZXIgdGhhbiBieSBnZXRfcGFnZV90eXBlKCkuICBBcyBzdWNoOgorICAgICAq
IC0gVGhleSBhcmVuJ3QgZXhwZWN0ZWQgdG8gaGF2ZSBhbiBJT01NVSBtYXBw
aW5nLCBhbmQKKyAgICAgKiAtIFdlIGRvbid0IG5lY2Vzc2FyaWx5IGV4cGVj
dCB0aGUgdHlwZSBjb3VudCB0byBiZSB6ZXJvIHdoZW4gdGhlIGZpbmFsCisg
ICAgICogcHV0X3BhZ2UgaGFwcGVucy4KKyAgICAgKgorICAgICAqIEdvIGFo
ZWFkIGFuZCBhdHRlbXAgdG8gY2FsbCBpb21tdV91bm1hcCgpIG9uIHhlbmhl
YXAgcGFnZXMgYW55d2F5LCBqdXN0CisgICAgICogaW4gY2FzZTsgYnV0IG9u
bHkgQVNTRVJUKCkgdGhhdCB0aGUgdHlwZSBjb3VudCBpcyB6ZXJvIGFuZCBy
ZW1vdmUgdGhlCisgICAgICogUEdUX3dyaXRhYmxlIHR5cGUgZm9yIG5vbi14
ZW5oZWFwIHBhZ2VzLgorICAgICAqLworICAgIGlmICggKHBhZ2UtPnUuaW51
c2UudHlwZV9pbmZvICYgUEdUX3R5cGVfbWFzaykgPT0gUEdUX3dyaXRhYmxl
X3BhZ2UgKQorICAgIHsKKyAgICAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBh
Z2VfZ2V0X293bmVyKHBhZ2UpOworCisgICAgICAgIGlmICggZCAmJiBpc19w
dl9kb21haW4oZCkgJiYgdW5saWtlbHkobmVlZF9pb21tdShkKSkgKQorICAg
ICAgICB7CisgICAgICAgICAgICBpbnQgcmMyID0gaW9tbXVfdW5tYXBfcGFn
ZShkLCBtZm4pOworCisgICAgICAgICAgICBpZiAoICFyYyApCisgICAgICAg
ICAgICAgICAgcmMgPSByYzI7CisgICAgICAgIH0KKworICAgICAgICBpZiAo
IGxpa2VseSghaXNfeGVuX2hlYXBfcGFnZShwYWdlKSkgKQorICAgICAgICB7
CisgICAgICAgICAgICBBU1NFUlQoKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZv
ICYKKyAgICAgICAgICAgICAgICAgICAgKFBHVF90eXBlX21hc2sgfCBQR1Rf
Y291bnRfbWFzaykpID09IFBHVF93cml0YWJsZV9wYWdlKTsKKyAgICAgICAg
ICAgIC8qCisgICAgICAgICAgICAgKiBDbGVhciB0aGUgdHlwZSB0byByZWNv
cmQgdGhlIGZhY3QgdGhhdCBhbGwgd3JpdGFibGUgbWFwcGluZ3MKKyAgICAg
ICAgICAgICAqIGhhdmUgYmVlbiByZW1vdmVkLiAgQnV0IGlmIGVpdGhlciBv
cGVyYXRpb24gZmFpbGVkLCBsZWF2ZQorICAgICAgICAgICAgICogdHlwZV9p
bmZvIGFsb25lLgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBpZiAo
IGxpa2VseSghcmMpICkKKyAgICAgICAgICAgICAgICBwYWdlLT51LmludXNl
LnR5cGVfaW5mbyAmPSB+KFBHVF90eXBlX21hc2sgfCBQR1RfY291bnRfbWFz
ayk7CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXR1cm4gcmM7CiB9CiAK
IHZvaWQgcHV0X3BhZ2Uoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKQEAgLTI0
MDgsNyArMjQ4NCw3IEBAIHZvaWQgcHV0X3BhZ2Uoc3RydWN0IHBhZ2VfaW5m
byAqcGFnZSkKIAogICAgIGlmICggdW5saWtlbHkoKG54ICYgUEdDX2NvdW50
X21hc2spID09IDApICkKICAgICB7Ci0gICAgICAgIGlmICggY2xlYW51cF9w
YWdlX2NhY2hlYXR0cihwYWdlKSA9PSAwICkKKyAgICAgICAgaWYgKCAhY2xl
YW51cF9wYWdlX21hcHBpbmdzKHBhZ2UpICkKICAgICAgICAgICAgIGZyZWVf
ZG9taGVhcF9wYWdlKHBhZ2UpOwogICAgICAgICBlbHNlCiAgICAgICAgICAg
ICBNRU1fTE9HKCJMZWFraW5nIHBmbiAlbHgiLCBwYWdlX3RvX21mbihwYWdl
KSk7CkBAIC00Nzc2LDkgKzQ4NTIsMTAgQEAgaW50IHN0ZWFsX3BhZ2UoCiAg
ICAgICogTkIgdGhpcyBpcyBzYWZlIGV2ZW4gaWYgdGhlIHBhZ2UgZW5kcyB1
cCBiZWluZyBnaXZlbiBiYWNrIHRvCiAgICAgICogdGhlIGRvbWFpbiwgYmVj
YXVzZSB0aGUgY291bnQgaXMgemVybzogc3Vic2VxdWVudCBtYXBwaW5ncyB3
aWxsCiAgICAgICogY2F1c2UgdGhlIGNhY2hlIGF0dHJpYnV0ZXMgdG8gYmUg
cmUtaW5zdGF0ZWQgaW5zaWRlCi0gICAgICogZ2V0X3BhZ2VfZnJvbV9sMWUo
KS4KKyAgICAgKiBnZXRfcGFnZV9mcm9tX2wxZSgpLCBvciB0aGUgcGFnZSB0
byBiZSBhZGRlZCBiYWNrIHRvIHRoZSBJT01NVQorICAgICAqIHVwb24gdGhl
IHR5cGUgY2hhbmdpbmcgdG8gUEdUX3dyaXRlYWJsZSwgYXMgYXBwcm9wcmlh
dGUuCiAgICAgICovCi0gICAgaWYgKCAocmMgPSBjbGVhbnVwX3BhZ2VfY2Fj
aGVhdHRyKHBhZ2UpKSApCisgICAgaWYgKCAocmMgPSBjbGVhbnVwX3BhZ2Vf
bWFwcGluZ3MocGFnZSkpICkKICAgICB7CiAgICAgICAgIC8qCiAgICAgICAg
ICAqIENvdWxkbid0IGZpeHVwIFhlbidzIG1hcHBpbmdzOyBwdXQgdGhpbmdz
IHRoZSB3YXkgd2UgZm91bmQKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9t
bS9wMm0uYyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwppbmRleCAyMzlmOGU4
ODJiLi45YzE4NDliZjUyIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0v
cDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC02NDQsMjMg
KzY0NCw5IEBAIHAybV9yZW1vdmVfcGFnZShzdHJ1Y3QgcDJtX2RvbWFpbiAq
cDJtLCB1bnNpZ25lZCBsb25nIGdmbiwgdW5zaWduZWQgbG9uZyBtZm4sCiAg
ICAgcDJtX3R5cGVfdCB0OwogICAgIHAybV9hY2Nlc3NfdCBhOwogCisgICAg
LyogSU9NTVUgZm9yIFBWIGd1ZXN0cyBpcyBoYW5kbGVkIGluIGdldF9wYWdl
X3R5cGUoKSBhbmQgcHV0X3BhZ2UoKS4gKi8KICAgICBpZiAoICFwYWdpbmdf
bW9kZV90cmFuc2xhdGUocDJtLT5kb21haW4pICkKLSAgICB7Ci0gICAgICAg
IGludCByYyA9IDA7Ci0KLSAgICAgICAgaWYgKCBuZWVkX2lvbW11KHAybS0+
ZG9tYWluKSApCi0gICAgICAgIHsKLSAgICAgICAgICAgIGZvciAoIGkgPSAw
OyBpIDwgKDEgPDwgcGFnZV9vcmRlcik7IGkrKyApCi0gICAgICAgICAgICB7
Ci0gICAgICAgICAgICAgICAgaW50IHJldCA9IGlvbW11X3VubWFwX3BhZ2Uo
cDJtLT5kb21haW4sIG1mbiArIGkpOwotCi0gICAgICAgICAgICAgICAgaWYg
KCAhcmMgKQotICAgICAgICAgICAgICAgICAgICByYyA9IHJldDsKLSAgICAg
ICAgICAgIH0KLSAgICAgICAgfQotCi0gICAgICAgIHJldHVybiByYzsKLSAg
ICB9CisgICAgICAgIHJldHVybiAwOwogCiAgICAgQVNTRVJUKGdmbl9sb2Nr
ZWRfYnlfbWUocDJtLCBnZm4pKTsKICAgICBQMk1fREVCVUcoInJlbW92aW5n
IGdmbj0lI2x4IG1mbj0lI2x4XG4iLCBnZm4sIG1mbik7CkBAIC03MDMsMjYg
KzY4OSwzMyBAQCBndWVzdF9waHlzbWFwX2FkZF9lbnRyeShzdHJ1Y3QgZG9t
YWluICpkLCBnZm5fdCBnZm4sIG1mbl90IG1mbiwKICAgICBpbnQgcG9kX2Nv
dW50ID0gMDsKICAgICBpbnQgcmMgPSAwOwogCisgICAgLyogSU9NTVUgZm9y
IFBWIGd1ZXN0cyBpcyBoYW5kbGVkIGluIGdldF9wYWdlX3R5cGUoKSBhbmQg
cHV0X3BhZ2UoKS4gKi8KICAgICBpZiAoICFwYWdpbmdfbW9kZV90cmFuc2xh
dGUoZCkgKQogICAgIHsKLSAgICAgICAgaWYgKCBuZWVkX2lvbW11KGQpICYm
IHQgPT0gcDJtX3JhbV9ydyApCi0gICAgICAgIHsKLSAgICAgICAgICAgIGZv
ciAoIGkgPSAwOyBpIDwgKDEgPDwgcGFnZV9vcmRlcik7IGkrKyApCi0gICAg
ICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcmMgPSBpb21tdV9tYXBfcGFn
ZShkLCBtZm5feChtZm5fYWRkKG1mbiwgaSkpLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbWZuX3gobWZuX2FkZChtZm4sIGkpKSwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VRl9y
ZWFkYWJsZXxJT01NVUZfd3JpdGFibGUpOwotICAgICAgICAgICAgICAgIGlm
ICggcmMgIT0gMCApCi0gICAgICAgICAgICAgICAgewotICAgICAgICAgICAg
ICAgICAgICB3aGlsZSAoIGktLSA+IDAgKQotICAgICAgICAgICAgICAgICAg
ICAgICAgLyogSWYgc3RhdGVtZW50IHRvIHNhdGlzZnkgX19tdXN0X2NoZWNr
LiAqLwotICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBpb21tdV91bm1h
cF9wYWdlKGQsIG1mbl94KG1mbl9hZGQobWZuLCBpKSkpICkKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKKyAgICAgICAgc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSA9IG1mbl90b19wYWdlKG1mbik7CiAKLSAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIHJjOwotICAgICAgICAgICAgICAgIH0K
LSAgICAgICAgICAgIH0KKyAgICAgICAgLyoKKyAgICAgICAgICogT3VyIGlu
dGVyZmFjZSBmb3IgUFYgZ3Vlc3RzIHdydCBJT01NVSBlbnRyaWVzIGhhc24n
dCBiZWVuIHZlcnkKKyAgICAgICAgICogY2xlYXI7IGJ1dCBoaXN0b3JpY2Fs
bHksIHBhZ2VzIGhhdmUgc3RhcnRlZCBvdXQgd2l0aCBJT01NVSBtYXBwaW5n
cywKKyAgICAgICAgICogYW5kIG9ubHkgbG9zZSB0aGVtIHdoZW4gY2hhbmdl
ZCB0byBhIGRpZmZlcmVudCBwYWdlIHR5cGUuCisgICAgICAgICAqCisgICAg
ICAgICAqIFJldGFpbiB0aGlzIHByb3BlcnR5IGJ5IGdyYWJiaW5nIGEgd3Jp
dGFibGUgdHlwZSByZWYgYW5kIHRoZW4KKyAgICAgICAgICogZHJvcHBpbmcg
aXQgaW1tZWRpYXRlbHkuICBUaGUgcmVzdWx0IHdpbGwgYmUgcGFnZXMgdGhh
dCBoYXZlIGEKKyAgICAgICAgICogd3JpdGFibGUgdHlwZSAoYW5kIGFuIElP
TU1VIGVudHJ5KSwgYnV0IGEgY291bnQgb2YgMCAoc3VjaCB0aGF0CisgICAg
ICAgICAqIGFueSBndWVzdC1yZXF1ZXN0ZWQgdHlwZSBjaGFuZ2VzIHN1Y2Nl
ZWQgYW5kIHJlbW92ZSB0aGUgSU9NTVUKKyAgICAgICAgICogZW50cnkpLgor
ICAgICAgICAgKi8KKyAgICAgICAgaWYgKCAhbmVlZF9pb21tdShkKSB8fCB0
ICE9IHAybV9yYW1fcncgKQorICAgICAgICAgICAgcmV0dXJuIDA7CisKKyAg
ICAgICAgZm9yICggaSA9IDA7IGkgPCAoMVVMIDw8IHBhZ2Vfb3JkZXIpOyAr
K2ksICsrcGFnZSApCisgICAgICAgIHsKKyAgICAgICAgICAgIGlmICggZ2V0
X3BhZ2VfYW5kX3R5cGUocGFnZSwgZCwgUEdUX3dyaXRhYmxlX3BhZ2UpICkK
KyAgICAgICAgICAgICAgICBwdXRfcGFnZV9hbmRfdHlwZShwYWdlKTsKKyAg
ICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZB
TDsKICAgICAgICAgfQorCiAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAot
LSAKMi4yMC4xCgo=

--=separator
Content-Type: application/octet-stream; name="xsa288-4.9.patch"
Content-Disposition: attachment; filename="xsa288-4.9.patch"
Content-Transfer-Encoding: base64

RnJvbSBiYzQ0NTllOTEyMzM2NzljZDAxMzk5ODllZGY0NjU2NDE3ZTk1Yjg1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMjMgSmFu
IDIwMTkgMTE6NTc6NDYgKzAwMDAKU3ViamVjdDogW1BBVENIXSB4ZW46IE1h
a2UgY29oZXJlbnQgUFYgSU9NTVUgZGlzY2lwbGluZQoKSW4gb3JkZXIgZm9y
IGEgUFYgZG9tYWluIHRvIHNldCB1cCBETUEgZnJvbSBhIHBhc3NlZC10aHJv
dWdoIGRldmljZSB0bwpvbmUgb2YgaXRzIHBhZ2VzLCB0aGUgcGFnZSBtdXN0
IGJlIG1hcHBlZCBpbiB0aGUgSU9NTVUuICBPbiB0aGUgb3RoZXIKaGFuZCwg
YmVmb3JlIGEgUFYgcGFnZSBtYXkgYmUgdXNlZCBhcyBhICJzcGVjaWFsIiBw
YWdlIHR5cGUgKHN1Y2ggYXMgYQpwYWdldGFibGUgb3IgZGVzY3JpcHRvciB0
YWJsZSksIGl0IF9tdXN0IG5vdF8gYmUgd3JpdGFibGUgaW4gdGhlIElPTU1V
CihvdGhlcndpc2UgYSBtYWxpY2lvdXMgZ3Vlc3QgY291bGQgRE1BIGFyYml0
cmFyeSBwYWdlIHRhYmxlcyBpbnRvIHRoZQptZW1vcnksIGJ5cGFzc2luZyBY
ZW4ncyBzYWZldHkgY2hlY2tzKTsgYW5kIFhlbidzIGN1cnJlbnQgcnVsZSBp
cyB0bwpoYXZlIHN1Y2ggcGFnZXMgbm90IGluIHRoZSBJT01NVSBhdCBhbGwu
CgpBdCB0aGUgbW9tZW50LCBpbiBvcmRlciB0byBhY2NvbXBsaXNoIHRoaXMs
IHRoZSBjb2RlIGJvcnJvd3MgSFZNCmRvbWFpbidzICJwaHlzbWFwIiBjb25j
ZXB0OiBXaGVuIGEgcGFnZSBpcyBhc3NpZ25lZCB0byBhIGd1ZXN0LApndWVz
c19waHlzbWFwX2FkZF9lbnRyeSgpIGlzIGNhbGxlZCwgd2hpY2ggZm9yIFBW
IGd1ZXN0cywgd2lsbCBjcmVhdGUKYSB3cml0YWJsZSBJT01NVSBtYXBwaW5n
OyBhbmQgd2hlbiBhIHBhZ2UgaXMgcmVtb3ZlZCwKZ3Vlc3RfcGh5c21hcF9y
ZW1vdmVfZW50cnkoKSBpcyBjYWxsZWQsIHdoaWNoIHdpbGwgcmVtb3ZlIHRo
ZSBtYXBwaW5nLgoKQWRkaXRpb25hbGx5LCB3aGVuIGEgcGFnZSBnYWlucyB0
aGUgUEdUX3dyaXRhYmxlIHBhZ2UgdHlwZSwgdGhlIHBhZ2UKd2lsbCBiZSBh
ZGRlZCBpbnRvIHRoZSBJT01NVTsgYW5kIHdoZW4gdGhlIHBhZ2UgY2hhbmdl
cyBhd2F5IGZyb20gYQpQR1Rfd3JpdGFibGUgdHlwZSwgdGhlIHBhZ2Ugd2ls
bCBiZSByZW1vdmVkIGZyb20gdGhlIElPTU1VLgoKVW5mb3J0dW5hdGVseSwg
Ym9ycm93aW5nIHRoZSAicGh5c21hcCIgY29uY2VwdCBmcm9tIEhWTSBkb21h
aW5zIGlzCnByb2JsZW1hdGljLiAgSFZNIGRvbWFpbnMgaGF2ZSBhIGxvY2sg
b24gdGhlaXIgcDJtIHRhYmxlcywgZW5zdXJpbmcKc3luY2hyb25pemF0aW9u
IGJldHdlZW4gbW9kaWZpY2F0aW9ucyB0byB0aGUgcDJtOyBhbmQgYWxsIGh5
cGVyY2FsbApwYXJhbWV0ZXJzIG11c3QgZmlyc3QgYmUgdHJhbnNsYXRlZCB0
aHJvdWdoIHRoZSBwMm0gYmVmb3JlIGJlaW5nIHVzZWQuCgpUcnlpbmcgdG8g
bWl4IHRoaXMgbG9ja2VkLWFuZC1nYXRlZCBhcHByb2FjaCB3aXRoIFBWJ3Mg
bG9jay1mcmVlCmFwcHJvYWNoIGxlYWRzIHRvIHNldmVyYWwgcmFjZXMgYW5k
IGluY29uc2lzdGVuY2llczoKCiogQSByYWNlIGJldHdlZW4gYSBwYWdlIGJl
aW5nIGFzc2lnbmVkIGFuZCBpdCBiZWluZyBwdXQgaW50byB0aGUKICBwaHlz
bWFwOyBmb3IgZXhhbXBsZToKICAtIFAxOiBjYWxsIHBvcHVsYXRlX3BoeXNt
YXAoKSB7IEEgPSBhbGxvY2F0ZV9kb21oZWFwX3BhZ2VzKCkgfQogIC0gUDI6
IEd1ZXNzIHBhZ2UgQSdzIG1mbiwgYW5kIGNhbGwgZGVjcmVhc2VfcmVzZXJ2
YXRpb24oQSkuICBBIGlzIG93bmVkIGJ5IHRoZSBkb21haW4sCiAgICAgICAg
YW5kIHNvIFhlbiB3aWxsIGNsZWFyIHRoZSBQR0NfYWxsb2NhdGVkIGJpdCBh
bmQgZnJlZSB0aGUgcGFnZQogIC0gUDE6IGZpbmlzaGVzIHBvcHVsYXRlX3Bo
eXNtYXAoKSB7IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KCkgfQoKICBOb3cg
dGhlIGRvbWFpbiBoYXMgYSB3cml0YWJsZSBJT01NVSBtYXBwaW5nIHRvIGEg
cGFnZSBpdCBubyBsb25nZXIgb3ducy4KCiogUGFnZXMgc3RhcnQgb3V0IGFz
IHR5cGUgUEdUX25vbmUsIGJ1dCB3aXRoIGEgd3JpdGFibGUgSU9NTVUgbWFw
cGluZy4KICBJZiBhIGd1ZXN0IHVzZXMgYSBwYWdlIGFzIGEgcGFnZSB0YWJs
ZSB3aXRob3V0IGV2ZXIgaGF2aW5nIGNyZWF0ZWQgYQogIHdyaXRhYmxlIG1h
cHBpbmcsIHRoZSBJT01NVSBtYXBwaW5nIHdpbGwgbm90IGJlIHJlbW92ZWQ7
IHRoZSBndWVzdAogIHdpbGwgaGF2ZSBhIHdyaXRhYmxlIElPTU1VIG1hcHBp
bmcgdG8gYSBwYWdlIGl0IGlzIGN1cnJlbnRseSB1c2luZwogIGFzIGEgcGFn
ZSB0YWJsZS4KCiogQSBuZXdseS1hbGxvY2F0ZWQgcGFnZSBjYW4gYmUgRE1B
J2QgaW50byB3aXRoIG5vIHNwZWNpYWwgYWN0aW9ucyBvbgogIHRoZSBwYXJ0
IG9mIHRoZSBndWVzdDsgSG93ZXZlciwgaWYgYSBwYWdlIGlzIHByb21vdGVk
IHRvIGEKICBub24td3JpdGFibGUgdHlwZSwgdGhlIHBhZ2UgbXVzdCBiZSBt
YXBwZWQgd2l0aCBhIHdyaXRhYmxlIHR5cGUgYmVmb3JlCiAgRE1BJ2luZyB0
byBpdCBhZ2Fpbiwgb3IgdGhlIHRyYW5zYWN0aW9uIHdpbGwgZmFpbC4KClRv
IGZpeCB0aGlzLCBkbyBhd2F5IHdpdGggdGhlICJQViBwaHlzbWFwIiBjb25j
ZXB0IGVudGlyZWx5LCBhbmQKcmVwbGFjZSBpdCB3aXRoIHRoZSBmb2xsb3dp
bmcgSU9NTVUgZGlzY2lwbGluZSBmb3IgUFYgZ3Vlc3RzOgogLSAodHlwZSA9
PSBQR1Rfd3JpdGFibGUpIDw9PiBpbiBpb21tdSAoZXZlbiBpZiB0eXBlX2Nv
dW50ID09IDApCiAtIFVwb24gYSBmaW5hbCBwdXRfcGFnZSgpLCBjaGVjayB0
byBzZWUgaWYgdHlwZSBpcyBQR1Rfd3JpdGFibGU7IGlmIHNvLAogICBpb21t
dV91bm1hcC4KCkluIG9yZGVyIHRvIGFjaGlldmUgdGhhdDoKCi0gUmVtb3Zl
IFBWIElPTU1VIHJlbGF0ZWQgY29kZSBmcm9tIGd1ZXN0X3BoeXNtYXBfKgoK
LSBSZXB1cnBvc2UgY2xlYW51cF9wYWdlX2NhY2hlYXR0cigpIGludG8gYSBn
ZW5lcmFsCiAgY2xlYW51cF9wYWdlX21hcHBpbmdzKCkgZnVuY3Rpb24sIHdo
aWNoIHdpbGwgYm90aCBmaXggdXAgWGVuCiAgbWFwcGluZ3MgZm9yIHBhZ2Vz
IHdpdGggc3BlY2lhbCBjYWNoZSBhdHRyaWJ1dGVzLCBhbmQgYWxzbyBjaGVj
ayBmb3IKICBhIFBHVF93cml0YWJsZSB0eXBlIGFuZCByZW1vdmUgcGFnZXMg
aWYgYXBwcm9wcmlhdGUuCgotIEZvciBjb21wYXRpYmlsaXR5IHdpdGggY3Vy
cmVudCBndWVzdHMsIGdyYWItYW5kLXJlbGVhc2UgYQogIFBHVF93cml0YWJs
ZV9wYWdlIHR5cGUgZm9yIFBWIGd1ZXN0cyBpbiBndWVzdF9waHlzbWFwX2Fk
ZF9lbnRyeSgpLgogIFRoaXMgd2lsbCBjYXVzZSBtb3N0ICJub3JtYWwiIGd1
ZXN0IHBhZ2VzIHRvIHN0YXJ0IG91dCBsaWZlIHdpdGgKICBQR1Rfd3JpdGFi
bGVfcGFnZSB0eXBlIChhbmQgdGh1cyBhbiBJT01NVSBtYXBwaW5nKSwgYnV0
IG5vIHR5cGUKICBjb3VudCAoc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIGFz
IHNwZWNpYWwgY2FzZXMgYXQgd2lsbCkuCgpBbHNvLCBub3RlIHRoYXQgdGhl
cmUgaXMgb25lIGV4Y2VwdGlvbiB0byB0byB0aGUgIlBHVF93cml0YWJsZSA9
PiBpbgppb21tdSIgcnVsZTogeGVuaGVhcCBwYWdlcyBzaGFyZWQgd2l0aCBn
dWVzdHMgbWF5IGJlIGdpdmVuIGEKUEdUX3dyaXRhYmxlIHR5cGUgd2l0aCBv
bmUgdHlwZSByZWZlcmVuY2UuICBUaGlzIHJlZmVyZW5jZSBwcmV2ZW50cwp0
aGUgdHlwZSBmcm9tIGNoYW5naW5nLCB3aGljaCBpbiB0dXJuIHByZXZlbnRz
IHBhZ2UgZnJvbSBnYWluaW5nIGFuCklPTU1VIG1hcHBpbmcgaW4gZ2V0X3Bh
Z2VfdHlwZSgpLiAgSXQncyBub3QgY2xlYXIgd2hldGhlciB0aGlzIHdhcwpp
bnRlbnRpb25hbCBvciBub3QsIGJ1dCBpdCdzIG5vdCBzb21ldGhpbmcgdG8g
Y2hhbmdlIGluIGEgc2VjdXJpdHkKdXBkYXRlLgoKVGhpcyBpcyBYU0EtMjg4
LgoKUmVwb3J0ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNp
dHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3Jn
ZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICB8IDk1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9tbS9wMm0uYyB8IDU3ICsrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDExMSBpbnNl
cnRpb25zKCspLCA0MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IDQ3NmVm
OGVlODUuLjNhMTFjNjc0NzggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9t
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC04MSw2ICs4MSwyMiBA
QAogICogT1Mncywgd2hpY2ggd2lsbCBnZW5lcmFsbHkgdXNlIHRoZSBXUCBi
aXQgdG8gc2ltcGxpZnkgY29weS1vbi13cml0ZQogICogaW1wbGVtZW50YXRp
b24gKGluIHRoYXQgY2FzZSwgT1Mgd2FudHMgYSBmYXVsdCB3aGVuIGl0IHdy
aXRlcyB0bwogICogYW4gYXBwbGljYXRpb24tc3VwcGxpZWQgYnVmZmVyKS4K
KyAqCisgKiBQViBkb21VcyBhbmQgSU9NTVVzOgorICogLS0tLS0tLS0tLS0t
LS0tLS0tLS0KKyAqIEZvciBhIGd1ZXN0IHRvIGJlIGFibGUgdG8gRE1BIGlu
dG8gYSBwYWdlLCB0aGF0IHBhZ2UgbXVzdCBiZSBpbiB0aGUKKyAqIGRvbWFp
bidzIElPTU1VLiAgSG93ZXZlciwgd2UgKm11c3Qgbm90KiBhbGxvdyBETUEg
aW50byAnc3BlY2lhbCcKKyAqIHBhZ2VzIChzdWNoIGFzIHBhZ2UgdGFibGUg
cGFnZXMsIGRlc2NyaXB0b3IgdGFibGVzLCAmYyk7IGFuZCB3ZQorICogbXVz
dCBhbHNvIGVuc3VyZSB0aGF0IG1hcHBpbmdzIGFyZSByZW1vdmVkIGZyb20g
dGhlIElPTU1VIHdoZW4gdGhlCisgKiBwYWdlIGlzIGZyZWVkLiAgRmluYWxs
eSwgaXQgaXMgaW5oZXJlbnRseSByYWN5IHRvIG1ha2UgYW55IGNoYW5nZXMK
KyAqIGJhc2VkIG9uIGEgcGFnZSB3aXRoIGEgbm9uLXplcm8gdHlwZSBjb3Vu
dC4KKyAqCisgKiBUbyB0aGF0IGVuZCwgd2UgcHV0IHRoZSBwYWdlIGluIHRo
ZSBJT01NVSBvbmx5IHdoZW4gYSBwYWdlIGdhaW5zCisgKiB0aGUgUEdUX3dy
aXRlYWJsZSB0eXBlOyBhbmQgd2UgcmVtb3ZlIHRoZSBwYWdlIHdoZW4gaXQg
bG9zZXMgdGhlCisgKiBQR1Rfd3JpdGVhYmxlIHR5cGUgKG5vdCB3aGVuIHRo
ZSB0eXBlIGNvdW50IGdvZXMgdG8gemVybykuICBUaGlzCisgKiBlZmZlY3Rp
dmVseSBwcm90ZWN0cyB0aGUgSU9NTVUgc3RhdHVzIHVwZGF0ZSB3aXRoIHRo
ZSB0eXBlIGNvdW50IHdlCisgKiBoYXZlIGp1c3QgYWNxdWlyZWQuICBXZSBt
dXN0IGFsc28gY2hlY2sgZm9yIFBHVF93cml0YWJsZSB0eXBlIHdoZW4KKyAq
IGRvaW5nIHRoZSBmaW5hbCBwdXRfcGFnZSgpLCBhbmQgcmVtb3ZlIGl0IGZy
b20gdGhlIGlvbW11IGlmIHNvLgogICovCiAKICNpbmNsdWRlIDx4ZW4vaW5p
dC5oPgpAQCAtMjQxMSwxOSArMjQyNyw3OSBAQCBzdGF0aWMgaW50IG1vZF9s
NF9lbnRyeShsNF9wZ2VudHJ5X3QgKnBsNGUsCiAgICAgcmV0dXJuIHJjOwog
fQogCi1zdGF0aWMgaW50IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKKy8qCisgKiBJbiB0aGUgY291cnNlIG9mIGEg
cGFnZSdzIHVzZSwgaXQgbWF5IGhhdmUgY2F1c2VkIG90aGVyIHNlY29uZGFy
eQorICogbWFwcGluZ3MgdG8gaGF2ZSBjaGFuZ2VkOgorICogLSBYZW4ncyBt
YXBwaW5ncyBtYXkgaGF2ZSBiZWVuIGNoYW5nZWQgdG8gYWNjb21vZGF0ZSB0
aGUgcmVxdWVzdGVkCisgKiAgIGNhY2hlIGF0dGlidXRlcworICogLSBBIHBh
Z2UgbWF5IGhhdmUgYmVlbiBwdXQgaW50byB0aGUgSU9NTVUgb2YgYSBQViBn
dWVzdCB3aGVuIGl0CisgKiAgIGdhaW5lZCBhIHdyaXRhYmxlIG1hcHBpbmcu
CisgKgorICogTm93IHRoYXQgdGhlIHBhZ2UgaXMgYmVpbmcgZnJlZWQsIGNs
ZWFuIHVwIHRoZXNlIG1hcHBpbmdzIGlmCisgKiBhcHByb3ByaWF0ZS4gIE5C
IHRoYXQgYXQgdGhpcyBwb2ludCB0aGUgcGFnZSBpcyBzdGlsbCAiYWxsb2Nh
dGVkIiwKKyAqIGJ1dCBub3QgImxpdmUiIChpLmUuLCBpdHMgcmVmY291bnQg
aXMgMCksIHNvIGl0J3Mgc2FmZSB0byByZWFkIHRoZQorICogY291bnRfaW5m
bywgb3duZXIsIGFuZCB0eXBlX2luZm8gd2l0aG91dCBzeW5jaHJvbml6YXRp
b24uCisgKi8KK3N0YXRpYyBpbnQgY2xlYW51cF9wYWdlX21hcHBpbmdzKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7CiAgICAgdW5zaWduZWQgaW50IGNh
Y2hlYXR0ciA9CiAgICAgICAgIChwYWdlLT5jb3VudF9pbmZvICYgUEdDX2Nh
Y2hlYXR0cl9tYXNrKSA+PiBQR0NfY2FjaGVhdHRyX2Jhc2U7CisgICAgaW50
IHJjID0gMDsKKyAgICB1bnNpZ25lZCBsb25nIG1mbiA9IHBhZ2VfdG9fbWZu
KHBhZ2UpOwogCi0gICAgaWYgKCBsaWtlbHkoY2FjaGVhdHRyID09IDApICkK
LSAgICAgICAgcmV0dXJuIDA7CisgICAgLyoKKyAgICAgKiBJZiB3ZSd2ZSBt
b2RpZmllZCB4ZW4gbWFwcGluZ3MgYXMgYSByZXN1bHQgb2YgZ3Vlc3QgY2Fj
aGUKKyAgICAgKiBhdHRyaWJ1dGVzLCByZXN0b3JlIHRoZW0gdG8gdGhlICJu
b3JtYWwiIHN0YXRlLgorICAgICAqLworICAgIGlmICggdW5saWtlbHkoY2Fj
aGVhdHRyKSApCisgICAgeworICAgICAgICBwYWdlLT5jb3VudF9pbmZvICY9
IH5QR0NfY2FjaGVhdHRyX21hc2s7CiAKLSAgICBwYWdlLT5jb3VudF9pbmZv
ICY9IH5QR0NfY2FjaGVhdHRyX21hc2s7CisgICAgICAgIEJVR19PTihpc194
ZW5faGVhcF9wYWdlKHBhZ2UpKTsKIAotICAgIEJVR19PTihpc194ZW5faGVh
cF9wYWdlKHBhZ2UpKTsKKyAgICAgICAgcmMgPSB1cGRhdGVfeGVuX21hcHBp
bmdzKG1mbiwgMCk7CisgICAgfQogCi0gICAgcmV0dXJuIHVwZGF0ZV94ZW5f
bWFwcGluZ3MocGFnZV90b19tZm4ocGFnZSksIDApOworICAgIC8qCisgICAg
ICogSWYgdGhpcyBtYXkgYmUgaW4gYSBQViBkb21haW4ncyBJT01NVSwgcmVt
b3ZlIGl0LgorICAgICAqCisgICAgICogTkIgdGhhdCB3cml0YWJsZSB4ZW5o
ZWFwIHBhZ2VzIGhhdmUgdGhlaXIgdHlwZSBzZXQgYW5kIGNsZWFyZWQgYnkK
KyAgICAgKiBpbXBsZW1lbnRhdGlvbi1zcGVjaWZpYyBjb2RlLCByYXRoZXIg
dGhhbiBieSBnZXRfcGFnZV90eXBlKCkuICBBcyBzdWNoOgorICAgICAqIC0g
VGhleSBhcmVuJ3QgZXhwZWN0ZWQgdG8gaGF2ZSBhbiBJT01NVSBtYXBwaW5n
LCBhbmQKKyAgICAgKiAtIFdlIGRvbid0IG5lY2Vzc2FyaWx5IGV4cGVjdCB0
aGUgdHlwZSBjb3VudCB0byBiZSB6ZXJvIHdoZW4gdGhlIGZpbmFsCisgICAg
ICogcHV0X3BhZ2UgaGFwcGVucy4KKyAgICAgKgorICAgICAqIEdvIGFoZWFk
IGFuZCBhdHRlbXAgdG8gY2FsbCBpb21tdV91bm1hcCgpIG9uIHhlbmhlYXAg
cGFnZXMgYW55d2F5LCBqdXN0CisgICAgICogaW4gY2FzZTsgYnV0IG9ubHkg
QVNTRVJUKCkgdGhhdCB0aGUgdHlwZSBjb3VudCBpcyB6ZXJvIGFuZCByZW1v
dmUgdGhlCisgICAgICogUEdUX3dyaXRhYmxlIHR5cGUgZm9yIG5vbi14ZW5o
ZWFwIHBhZ2VzLgorICAgICAqLworICAgIGlmICggKHBhZ2UtPnUuaW51c2Uu
dHlwZV9pbmZvICYgUEdUX3R5cGVfbWFzaykgPT0gUEdUX3dyaXRhYmxlX3Bh
Z2UgKQorICAgIHsKKyAgICAgICAgc3RydWN0IGRvbWFpbiAqZCA9IHBhZ2Vf
Z2V0X293bmVyKHBhZ2UpOworCisgICAgICAgIGlmICggZCAmJiBpc19wdl9k
b21haW4oZCkgJiYgdW5saWtlbHkobmVlZF9pb21tdShkKSkgKQorICAgICAg
ICB7CisgICAgICAgICAgICBpbnQgcmMyID0gaW9tbXVfdW5tYXBfcGFnZShk
LCBtZm4pOworCisgICAgICAgICAgICBpZiAoICFyYyApCisgICAgICAgICAg
ICAgICAgcmMgPSByYzI7CisgICAgICAgIH0KKworICAgICAgICBpZiAoIGxp
a2VseSghaXNfeGVuX2hlYXBfcGFnZShwYWdlKSkgKQorICAgICAgICB7Cisg
ICAgICAgICAgICBBU1NFUlQoKHBhZ2UtPnUuaW51c2UudHlwZV9pbmZvICYK
KyAgICAgICAgICAgICAgICAgICAgKFBHVF90eXBlX21hc2sgfCBQR1RfY291
bnRfbWFzaykpID09IFBHVF93cml0YWJsZV9wYWdlKTsKKyAgICAgICAgICAg
IC8qCisgICAgICAgICAgICAgKiBDbGVhciB0aGUgdHlwZSB0byByZWNvcmQg
dGhlIGZhY3QgdGhhdCBhbGwgd3JpdGFibGUgbWFwcGluZ3MKKyAgICAgICAg
ICAgICAqIGhhdmUgYmVlbiByZW1vdmVkLiAgQnV0IGlmIGVpdGhlciBvcGVy
YXRpb24gZmFpbGVkLCBsZWF2ZQorICAgICAgICAgICAgICogdHlwZV9pbmZv
IGFsb25lLgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBpZiAoIGxp
a2VseSghcmMpICkKKyAgICAgICAgICAgICAgICBwYWdlLT51LmludXNlLnR5
cGVfaW5mbyAmPSB+KFBHVF90eXBlX21hc2sgfCBQR1RfY291bnRfbWFzayk7
CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXR1cm4gcmM7CiB9CiAKIHZv
aWQgcHV0X3BhZ2Uoc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSkKQEAgLTI0Mzks
NyArMjUxNSw3IEBAIHZvaWQgcHV0X3BhZ2Uoc3RydWN0IHBhZ2VfaW5mbyAq
cGFnZSkKIAogICAgIGlmICggdW5saWtlbHkoKG54ICYgUEdDX2NvdW50X21h
c2spID09IDApICkKICAgICB7Ci0gICAgICAgIGlmICggY2xlYW51cF9wYWdl
X2NhY2hlYXR0cihwYWdlKSA9PSAwICkKKyAgICAgICAgaWYgKCAhY2xlYW51
cF9wYWdlX21hcHBpbmdzKHBhZ2UpICkKICAgICAgICAgICAgIGZyZWVfZG9t
aGVhcF9wYWdlKHBhZ2UpOwogICAgICAgICBlbHNlCiAgICAgICAgICAgICBn
ZHByaW50ayhYRU5MT0dfV0FSTklORywKQEAgLTQ4MjksOSArNDkwNSwxMCBA
QCBpbnQgc3RlYWxfcGFnZSgKICAgICAgKiBOQiB0aGlzIGlzIHNhZmUgZXZl
biBpZiB0aGUgcGFnZSBlbmRzIHVwIGJlaW5nIGdpdmVuIGJhY2sgdG8KICAg
ICAgKiB0aGUgZG9tYWluLCBiZWNhdXNlIHRoZSBjb3VudCBpcyB6ZXJvOiBz
dWJzZXF1ZW50IG1hcHBpbmdzIHdpbGwKICAgICAgKiBjYXVzZSB0aGUgY2Fj
aGUgYXR0cmlidXRlcyB0byBiZSByZS1pbnN0YXRlZCBpbnNpZGUKLSAgICAg
KiBnZXRfcGFnZV9mcm9tX2wxZSgpLgorICAgICAqIGdldF9wYWdlX2Zyb21f
bDFlKCksIG9yIHRoZSBwYWdlIHRvIGJlIGFkZGVkIGJhY2sgdG8gdGhlIElP
TU1VCisgICAgICogdXBvbiB0aGUgdHlwZSBjaGFuZ2luZyB0byBQR1Rfd3Jp
dGVhYmxlLCBhcyBhcHByb3ByaWF0ZS4KICAgICAgKi8KLSAgICBpZiAoIChy
YyA9IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIocGFnZSkpICkKKyAgICBpZiAo
IChyYyA9IGNsZWFudXBfcGFnZV9tYXBwaW5ncyhwYWdlKSkgKQogICAgIHsK
ICAgICAgICAgLyoKICAgICAgICAgICogQ291bGRuJ3QgZml4dXAgWGVuJ3Mg
bWFwcGluZ3M7IHB1dCB0aGluZ3MgdGhlIHdheSB3ZSBmb3VuZApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21tL3AybS5jIGIveGVuL2FyY2gveDg2L21t
L3AybS5jCmluZGV4IGVjZTMyZmZiOGYuLjI1ZmVkMDhlZmIgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYworKysgYi94ZW4vYXJjaC94ODYv
bW0vcDJtLmMKQEAgLTcwNiwyMyArNzA2LDkgQEAgcDJtX3JlbW92ZV9wYWdl
KHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcgZ2ZuLCB1
bnNpZ25lZCBsb25nIG1mbiwKICAgICBwMm1fdHlwZV90IHQ7CiAgICAgcDJt
X2FjY2Vzc190IGE7CiAKKyAgICAvKiBJT01NVSBmb3IgUFYgZ3Vlc3RzIGlz
IGhhbmRsZWQgaW4gZ2V0X3BhZ2VfdHlwZSgpIGFuZCBwdXRfcGFnZSgpLiAq
LwogICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShwMm0tPmRvbWFp
bikgKQotICAgIHsKLSAgICAgICAgaW50IHJjID0gMDsKLQotICAgICAgICBp
ZiAoIG5lZWRfaW9tbXUocDJtLT5kb21haW4pICkKLSAgICAgICAgewotICAg
ICAgICAgICAgZm9yICggaSA9IDA7IGkgPCAoMSA8PCBwYWdlX29yZGVyKTsg
aSsrICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICBpbnQgcmV0
ID0gaW9tbXVfdW5tYXBfcGFnZShwMm0tPmRvbWFpbiwgbWZuICsgaSk7Ci0K
LSAgICAgICAgICAgICAgICBpZiAoICFyYyApCi0gICAgICAgICAgICAgICAg
ICAgIHJjID0gcmV0OwotICAgICAgICAgICAgfQotICAgICAgICB9Ci0KLSAg
ICAgICAgcmV0dXJuIHJjOwotICAgIH0KKyAgICAgICAgcmV0dXJuIDA7CiAK
ICAgICBBU1NFUlQoZ2ZuX2xvY2tlZF9ieV9tZShwMm0sIGdmbikpOwogICAg
IFAyTV9ERUJVRygicmVtb3ZpbmcgZ2ZuPSUjbHggbWZuPSUjbHhcbiIsIGdm
biwgbWZuKTsKQEAgLTc2NSwyNiArNzUxLDMzIEBAIGd1ZXN0X3BoeXNtYXBf
YWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQsIGdmbl90IGdmbiwgbWZuX3Qg
bWZuLAogICAgIGludCBwb2RfY291bnQgPSAwOwogICAgIGludCByYyA9IDA7
CiAKKyAgICAvKiBJT01NVSBmb3IgUFYgZ3Vlc3RzIGlzIGhhbmRsZWQgaW4g
Z2V0X3BhZ2VfdHlwZSgpIGFuZCBwdXRfcGFnZSgpLiAqLwogICAgIGlmICgg
IXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShkKSApCiAgICAgewotICAgICAgICBp
ZiAoIG5lZWRfaW9tbXUoZCkgJiYgdCA9PSBwMm1fcmFtX3J3ICkKLSAgICAg
ICAgewotICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCAoMSA8PCBwYWdl
X29yZGVyKTsgaSsrICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAg
ICByYyA9IGlvbW11X21hcF9wYWdlKGQsIG1mbl94KG1mbl9hZGQobWZuLCBp
KSksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5f
eChtZm5fYWRkKG1mbiwgaSkpLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgSU9NTVVGX3JlYWRhYmxlfElPTU1VRl93cml0YWJsZSk7
Ci0gICAgICAgICAgICAgICAgaWYgKCByYyAhPSAwICkKLSAgICAgICAgICAg
ICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIHdoaWxlICggaS0tID4gMCAp
Ci0gICAgICAgICAgICAgICAgICAgICAgICAvKiBJZiBzdGF0ZW1lbnQgdG8g
c2F0aXNmeSBfX211c3RfY2hlY2suICovCi0gICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoIGlvbW11X3VubWFwX3BhZ2UoZCwgbWZuX3gobWZuX2FkZCht
Zm4sIGkpKSkgKQotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRp
bnVlOworICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gbWZuX3Rv
X3BhZ2UobWZuKTsKIAotICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmM7
Ci0gICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgfQorICAgICAgICAv
KgorICAgICAgICAgKiBPdXIgaW50ZXJmYWNlIGZvciBQViBndWVzdHMgd3J0
IElPTU1VIGVudHJpZXMgaGFzbid0IGJlZW4gdmVyeQorICAgICAgICAgKiBj
bGVhcjsgYnV0IGhpc3RvcmljYWxseSwgcGFnZXMgaGF2ZSBzdGFydGVkIG91
dCB3aXRoIElPTU1VIG1hcHBpbmdzLAorICAgICAgICAgKiBhbmQgb25seSBs
b3NlIHRoZW0gd2hlbiBjaGFuZ2VkIHRvIGEgZGlmZmVyZW50IHBhZ2UgdHlw
ZS4KKyAgICAgICAgICoKKyAgICAgICAgICogUmV0YWluIHRoaXMgcHJvcGVy
dHkgYnkgZ3JhYmJpbmcgYSB3cml0YWJsZSB0eXBlIHJlZiBhbmQgdGhlbgor
ICAgICAgICAgKiBkcm9wcGluZyBpdCBpbW1lZGlhdGVseS4gIFRoZSByZXN1
bHQgd2lsbCBiZSBwYWdlcyB0aGF0IGhhdmUgYQorICAgICAgICAgKiB3cml0
YWJsZSB0eXBlIChhbmQgYW4gSU9NTVUgZW50cnkpLCBidXQgYSBjb3VudCBv
ZiAwIChzdWNoIHRoYXQKKyAgICAgICAgICogYW55IGd1ZXN0LXJlcXVlc3Rl
ZCB0eXBlIGNoYW5nZXMgc3VjY2VlZCBhbmQgcmVtb3ZlIHRoZSBJT01NVQor
ICAgICAgICAgKiBlbnRyeSkuCisgICAgICAgICAqLworICAgICAgICBpZiAo
ICFuZWVkX2lvbW11KGQpIHx8IHQgIT0gcDJtX3JhbV9ydyApCisgICAgICAg
ICAgICByZXR1cm4gMDsKKworICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgx
VUwgPDwgcGFnZV9vcmRlcik7ICsraSwgKytwYWdlICkKKyAgICAgICAgewor
ICAgICAgICAgICAgaWYgKCBnZXRfcGFnZV9hbmRfdHlwZShwYWdlLCBkLCBQ
R1Rfd3JpdGFibGVfcGFnZSkgKQorICAgICAgICAgICAgICAgIHB1dF9wYWdl
X2FuZF90eXBlKHBhZ2UpOworICAgICAgICAgICAgZWxzZQorICAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOwogICAgICAgICB9CisKICAgICAgICAg
cmV0dXJuIDA7CiAgICAgfQogCi0tIAoyLjIwLjEKCg==

--=separator
Content-Type: application/octet-stream; name="xsa288-4.11.patch"
Content-Disposition: attachment; filename="xsa288-4.11.patch"
Content-Transfer-Encoding: base64

RnJvbSA1ZDNhMDJlMzIwZjg4NzQ3Yjc1ZTM3OTRjMmU2OTQyODRhZTY0YzNl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBHZW9yZ2UgRHVubGFw
IDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+CkRhdGU6IFdlZCwgMjMgSmFu
IDIwMTkgMTE6NTc6NDYgKzAwMDAKU3ViamVjdDogW1BBVENIXSB4ZW46IE1h
a2UgY29oZXJlbnQgUFYgSU9NTVUgZGlzY2lwbGluZQoKSW4gb3JkZXIgZm9y
IGEgUFYgZG9tYWluIHRvIHNldCB1cCBETUEgZnJvbSBhIHBhc3NlZC10aHJv
dWdoIGRldmljZSB0bwpvbmUgb2YgaXRzIHBhZ2VzLCB0aGUgcGFnZSBtdXN0
IGJlIG1hcHBlZCBpbiB0aGUgSU9NTVUuICBPbiB0aGUgb3RoZXIKaGFuZCwg
YmVmb3JlIGEgUFYgcGFnZSBtYXkgYmUgdXNlZCBhcyBhICJzcGVjaWFsIiBw
YWdlIHR5cGUgKHN1Y2ggYXMgYQpwYWdldGFibGUgb3IgZGVzY3JpcHRvciB0
YWJsZSksIGl0IF9tdXN0IG5vdF8gYmUgd3JpdGFibGUgaW4gdGhlIElPTU1V
CihvdGhlcndpc2UgYSBtYWxpY2lvdXMgZ3Vlc3QgY291bGQgRE1BIGFyYml0
cmFyeSBwYWdlIHRhYmxlcyBpbnRvIHRoZQptZW1vcnksIGJ5cGFzc2luZyBY
ZW4ncyBzYWZldHkgY2hlY2tzKTsgYW5kIFhlbidzIGN1cnJlbnQgcnVsZSBp
cyB0bwpoYXZlIHN1Y2ggcGFnZXMgbm90IGluIHRoZSBJT01NVSBhdCBhbGwu
CgpBdCB0aGUgbW9tZW50LCBpbiBvcmRlciB0byBhY2NvbXBsaXNoIHRoaXMs
IHRoZSBjb2RlIGJvcnJvd3MgSFZNCmRvbWFpbidzICJwaHlzbWFwIiBjb25j
ZXB0OiBXaGVuIGEgcGFnZSBpcyBhc3NpZ25lZCB0byBhIGd1ZXN0LApndWVz
c19waHlzbWFwX2FkZF9lbnRyeSgpIGlzIGNhbGxlZCwgd2hpY2ggZm9yIFBW
IGd1ZXN0cywgd2lsbCBjcmVhdGUKYSB3cml0YWJsZSBJT01NVSBtYXBwaW5n
OyBhbmQgd2hlbiBhIHBhZ2UgaXMgcmVtb3ZlZCwKZ3Vlc3RfcGh5c21hcF9y
ZW1vdmVfZW50cnkoKSBpcyBjYWxsZWQsIHdoaWNoIHdpbGwgcmVtb3ZlIHRo
ZSBtYXBwaW5nLgoKQWRkaXRpb25hbGx5LCB3aGVuIGEgcGFnZSBnYWlucyB0
aGUgUEdUX3dyaXRhYmxlIHBhZ2UgdHlwZSwgdGhlIHBhZ2UKd2lsbCBiZSBh
ZGRlZCBpbnRvIHRoZSBJT01NVTsgYW5kIHdoZW4gdGhlIHBhZ2UgY2hhbmdl
cyBhd2F5IGZyb20gYQpQR1Rfd3JpdGFibGUgdHlwZSwgdGhlIHBhZ2Ugd2ls
bCBiZSByZW1vdmVkIGZyb20gdGhlIElPTU1VLgoKVW5mb3J0dW5hdGVseSwg
Ym9ycm93aW5nIHRoZSAicGh5c21hcCIgY29uY2VwdCBmcm9tIEhWTSBkb21h
aW5zIGlzCnByb2JsZW1hdGljLiAgSFZNIGRvbWFpbnMgaGF2ZSBhIGxvY2sg
b24gdGhlaXIgcDJtIHRhYmxlcywgZW5zdXJpbmcKc3luY2hyb25pemF0aW9u
IGJldHdlZW4gbW9kaWZpY2F0aW9ucyB0byB0aGUgcDJtOyBhbmQgYWxsIGh5
cGVyY2FsbApwYXJhbWV0ZXJzIG11c3QgZmlyc3QgYmUgdHJhbnNsYXRlZCB0
aHJvdWdoIHRoZSBwMm0gYmVmb3JlIGJlaW5nIHVzZWQuCgpUcnlpbmcgdG8g
bWl4IHRoaXMgbG9ja2VkLWFuZC1nYXRlZCBhcHByb2FjaCB3aXRoIFBWJ3Mg
bG9jay1mcmVlCmFwcHJvYWNoIGxlYWRzIHRvIHNldmVyYWwgcmFjZXMgYW5k
IGluY29uc2lzdGVuY2llczoKCiogQSByYWNlIGJldHdlZW4gYSBwYWdlIGJl
aW5nIGFzc2lnbmVkIGFuZCBpdCBiZWluZyBwdXQgaW50byB0aGUKICBwaHlz
bWFwOyBmb3IgZXhhbXBsZToKICAtIFAxOiBjYWxsIHBvcHVsYXRlX3BoeXNt
YXAoKSB7IEEgPSBhbGxvY2F0ZV9kb21oZWFwX3BhZ2VzKCkgfQogIC0gUDI6
IEd1ZXNzIHBhZ2UgQSdzIG1mbiwgYW5kIGNhbGwgZGVjcmVhc2VfcmVzZXJ2
YXRpb24oQSkuICBBIGlzIG93bmVkIGJ5IHRoZSBkb21haW4sCiAgICAgICAg
YW5kIHNvIFhlbiB3aWxsIGNsZWFyIHRoZSBQR0NfYWxsb2NhdGVkIGJpdCBh
bmQgZnJlZSB0aGUgcGFnZQogIC0gUDE6IGZpbmlzaGVzIHBvcHVsYXRlX3Bo
eXNtYXAoKSB7IGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KCkgfQoKICBOb3cg
dGhlIGRvbWFpbiBoYXMgYSB3cml0YWJsZSBJT01NVSBtYXBwaW5nIHRvIGEg
cGFnZSBpdCBubyBsb25nZXIgb3ducy4KCiogUGFnZXMgc3RhcnQgb3V0IGFz
IHR5cGUgUEdUX25vbmUsIGJ1dCB3aXRoIGEgd3JpdGFibGUgSU9NTVUgbWFw
cGluZy4KICBJZiBhIGd1ZXN0IHVzZXMgYSBwYWdlIGFzIGEgcGFnZSB0YWJs
ZSB3aXRob3V0IGV2ZXIgaGF2aW5nIGNyZWF0ZWQgYQogIHdyaXRhYmxlIG1h
cHBpbmcsIHRoZSBJT01NVSBtYXBwaW5nIHdpbGwgbm90IGJlIHJlbW92ZWQ7
IHRoZSBndWVzdAogIHdpbGwgaGF2ZSBhIHdyaXRhYmxlIElPTU1VIG1hcHBp
bmcgdG8gYSBwYWdlIGl0IGlzIGN1cnJlbnRseSB1c2luZwogIGFzIGEgcGFn
ZSB0YWJsZS4KCiogQSBuZXdseS1hbGxvY2F0ZWQgcGFnZSBjYW4gYmUgRE1B
J2QgaW50byB3aXRoIG5vIHNwZWNpYWwgYWN0aW9ucyBvbgogIHRoZSBwYXJ0
IG9mIHRoZSBndWVzdDsgSG93ZXZlciwgaWYgYSBwYWdlIGlzIHByb21vdGVk
IHRvIGEKICBub24td3JpdGFibGUgdHlwZSwgdGhlIHBhZ2UgbXVzdCBiZSBt
YXBwZWQgd2l0aCBhIHdyaXRhYmxlIHR5cGUgYmVmb3JlCiAgRE1BJ2luZyB0
byBpdCBhZ2Fpbiwgb3IgdGhlIHRyYW5zYWN0aW9uIHdpbGwgZmFpbC4KClRv
IGZpeCB0aGlzLCBkbyBhd2F5IHdpdGggdGhlICJQViBwaHlzbWFwIiBjb25j
ZXB0IGVudGlyZWx5LCBhbmQKcmVwbGFjZSBpdCB3aXRoIHRoZSBmb2xsb3dp
bmcgSU9NTVUgZGlzY2lwbGluZSBmb3IgUFYgZ3Vlc3RzOgogLSAodHlwZSA9
PSBQR1Rfd3JpdGFibGUpIDw9PiBpbiBpb21tdSAoZXZlbiBpZiB0eXBlX2Nv
dW50ID09IDApCiAtIFVwb24gYSBmaW5hbCBwdXRfcGFnZSgpLCBjaGVjayB0
byBzZWUgaWYgdHlwZSBpcyBQR1Rfd3JpdGFibGU7IGlmIHNvLAogICBpb21t
dV91bm1hcC4KCkluIG9yZGVyIHRvIGFjaGlldmUgdGhhdDoKCi0gUmVtb3Zl
IFBWIElPTU1VIHJlbGF0ZWQgY29kZSBmcm9tIGd1ZXN0X3BoeXNtYXBfKgoK
LSBSZXB1cnBvc2UgY2xlYW51cF9wYWdlX2NhY2hlYXR0cigpIGludG8gYSBn
ZW5lcmFsCiAgY2xlYW51cF9wYWdlX21hcHBpbmdzKCkgZnVuY3Rpb24sIHdo
aWNoIHdpbGwgYm90aCBmaXggdXAgWGVuCiAgbWFwcGluZ3MgZm9yIHBhZ2Vz
IHdpdGggc3BlY2lhbCBjYWNoZSBhdHRyaWJ1dGVzLCBhbmQgYWxzbyBjaGVj
ayBmb3IKICBhIFBHVF93cml0YWJsZSB0eXBlIGFuZCByZW1vdmUgcGFnZXMg
aWYgYXBwcm9wcmlhdGUuCgotIEZvciBjb21wYXRpYmlsaXR5IHdpdGggY3Vy
cmVudCBndWVzdHMsIGdyYWItYW5kLXJlbGVhc2UgYQogIFBHVF93cml0YWJs
ZV9wYWdlIHR5cGUgZm9yIFBWIGd1ZXN0cyBpbiBndWVzdF9waHlzbWFwX2Fk
ZF9lbnRyeSgpLgogIFRoaXMgd2lsbCBjYXVzZSBtb3N0ICJub3JtYWwiIGd1
ZXN0IHBhZ2VzIHRvIHN0YXJ0IG91dCBsaWZlIHdpdGgKICBQR1Rfd3JpdGFi
bGVfcGFnZSB0eXBlIChhbmQgdGh1cyBhbiBJT01NVSBtYXBwaW5nKSwgYnV0
IG5vIHR5cGUKICBjb3VudCAoc28gdGhhdCB0aGV5IGNhbiBiZSB1c2VkIGFz
IHNwZWNpYWwgY2FzZXMgYXQgd2lsbCkuCgpBbHNvLCBub3RlIHRoYXQgdGhl
cmUgaXMgb25lIGV4Y2VwdGlvbiB0byB0byB0aGUgIlBHVF93cml0YWJsZSA9
PiBpbgppb21tdSIgcnVsZTogeGVuaGVhcCBwYWdlcyBzaGFyZWQgd2l0aCBn
dWVzdHMgbWF5IGJlIGdpdmVuIGEKUEdUX3dyaXRhYmxlIHR5cGUgd2l0aCBv
bmUgdHlwZSByZWZlcmVuY2UuICBUaGlzIHJlZmVyZW5jZSBwcmV2ZW50cwp0
aGUgdHlwZSBmcm9tIGNoYW5naW5nLCB3aGljaCBpbiB0dXJuIHByZXZlbnRz
IHBhZ2UgZnJvbSBnYWluaW5nIGFuCklPTU1VIG1hcHBpbmcgaW4gZ2V0X3Bh
Z2VfdHlwZSgpLiAgSXQncyBub3QgY2xlYXIgd2hldGhlciB0aGlzIHdhcwpp
bnRlbnRpb25hbCBvciBub3QsIGJ1dCBpdCdzIG5vdCBzb21ldGhpbmcgdG8g
Y2hhbmdlIGluIGEgc2VjdXJpdHkKdXBkYXRlLgoKVGhpcyBpcyBYU0EtMjg4
LgoKUmVwb3J0ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNp
dHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEdlb3JnZSBEdW5sYXAgPGdlb3Jn
ZS5kdW5sYXBAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICB8IDk1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9tbS9wMm0uYyB8IDU3ICsrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDExMSBpbnNl
cnRpb25zKCspLCA0MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IGQ4ZmY1
OGM5MDEuLmFkOGFhY2FkNjggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9t
bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC04MSw2ICs4MSwyMiBA
QAogICogT1Mncywgd2hpY2ggd2lsbCBnZW5lcmFsbHkgdXNlIHRoZSBXUCBi
aXQgdG8gc2ltcGxpZnkgY29weS1vbi13cml0ZQogICogaW1wbGVtZW50YXRp
b24gKGluIHRoYXQgY2FzZSwgT1Mgd2FudHMgYSBmYXVsdCB3aGVuIGl0IHdy
aXRlcyB0bwogICogYW4gYXBwbGljYXRpb24tc3VwcGxpZWQgYnVmZmVyKS4K
KyAqCisgKiBQViBkb21VcyBhbmQgSU9NTVVzOgorICogLS0tLS0tLS0tLS0t
LS0tLS0tLS0KKyAqIEZvciBhIGd1ZXN0IHRvIGJlIGFibGUgdG8gRE1BIGlu
dG8gYSBwYWdlLCB0aGF0IHBhZ2UgbXVzdCBiZSBpbiB0aGUKKyAqIGRvbWFp
bidzIElPTU1VLiAgSG93ZXZlciwgd2UgKm11c3Qgbm90KiBhbGxvdyBETUEg
aW50byAnc3BlY2lhbCcKKyAqIHBhZ2VzIChzdWNoIGFzIHBhZ2UgdGFibGUg
cGFnZXMsIGRlc2NyaXB0b3IgdGFibGVzLCAmYyk7IGFuZCB3ZQorICogbXVz
dCBhbHNvIGVuc3VyZSB0aGF0IG1hcHBpbmdzIGFyZSByZW1vdmVkIGZyb20g
dGhlIElPTU1VIHdoZW4gdGhlCisgKiBwYWdlIGlzIGZyZWVkLiAgRmluYWxs
eSwgaXQgaXMgaW5oZXJlbnRseSByYWN5IHRvIG1ha2UgYW55IGNoYW5nZXMK
KyAqIGJhc2VkIG9uIGEgcGFnZSB3aXRoIGEgbm9uLXplcm8gdHlwZSBjb3Vu
dC4KKyAqCisgKiBUbyB0aGF0IGVuZCwgd2UgcHV0IHRoZSBwYWdlIGluIHRo
ZSBJT01NVSBvbmx5IHdoZW4gYSBwYWdlIGdhaW5zCisgKiB0aGUgUEdUX3dy
aXRlYWJsZSB0eXBlOyBhbmQgd2UgcmVtb3ZlIHRoZSBwYWdlIHdoZW4gaXQg
bG9zZXMgdGhlCisgKiBQR1Rfd3JpdGVhYmxlIHR5cGUgKG5vdCB3aGVuIHRo
ZSB0eXBlIGNvdW50IGdvZXMgdG8gemVybykuICBUaGlzCisgKiBlZmZlY3Rp
dmVseSBwcm90ZWN0cyB0aGUgSU9NTVUgc3RhdHVzIHVwZGF0ZSB3aXRoIHRo
ZSB0eXBlIGNvdW50IHdlCisgKiBoYXZlIGp1c3QgYWNxdWlyZWQuICBXZSBt
dXN0IGFsc28gY2hlY2sgZm9yIFBHVF93cml0YWJsZSB0eXBlIHdoZW4KKyAq
IGRvaW5nIHRoZSBmaW5hbCBwdXRfcGFnZSgpLCBhbmQgcmVtb3ZlIGl0IGZy
b20gdGhlIGlvbW11IGlmIHNvLgogICovCiAKICNpbmNsdWRlIDx4ZW4vaW5p
dC5oPgpAQCAtMjI3NSwxOSArMjI5MSw3OSBAQCBzdGF0aWMgaW50IG1vZF9s
NF9lbnRyeShsNF9wZ2VudHJ5X3QgKnBsNGUsCiAgICAgcmV0dXJuIHJjOwog
fQogCi1zdGF0aWMgaW50IGNsZWFudXBfcGFnZV9jYWNoZWF0dHIoc3RydWN0
IHBhZ2VfaW5mbyAqcGFnZSkKKy8qCisgKiBJbiB0aGUgY291cnNlIG9mIGEg
cGFnZSdzIHVzZSwgaXQgbWF5IGhhdmUgY2F1c2VkIG90aGVyIHNlY29uZGFy
eQorICogbWFwcGluZ3MgdG8gaGF2ZSBjaGFuZ2VkOgorICogLSBYZW4ncyBt
YXBwaW5ncyBtYXkgaGF2ZSBiZWVuIGNoYW5nZWQgdG8gYWNjb21vZGF0ZSB0
aGUgcmVxdWVzdGVkCisgKiAgIGNhY2hlIGF0dGlidXRlcworICogLSBBIHBh
Z2UgbWF5IGhhdmUgYmVlbiBwdXQgaW50byB0aGUgSU9NTVUgb2YgYSBQViBn
dWVzdCB3aGVuIGl0CisgKiAgIGdhaW5lZCBhIHdyaXRhYmxlIG1hcHBpbmcu
CisgKgorICogTm93IHRoYXQgdGhlIHBhZ2UgaXMgYmVpbmcgZnJlZWQsIGNs
ZWFuIHVwIHRoZXNlIG1hcHBpbmdzIGlmCisgKiBhcHByb3ByaWF0ZS4gIE5C
IHRoYXQgYXQgdGhpcyBwb2ludCB0aGUgcGFnZSBpcyBzdGlsbCAiYWxsb2Nh
dGVkIiwKKyAqIGJ1dCBub3QgImxpdmUiIChpLmUuLCBpdHMgcmVmY291bnQg
aXMgMCksIHNvIGl0J3Mgc2FmZSB0byByZWFkIHRoZQorICogY291bnRfaW5m
bywgb3duZXIsIGFuZCB0eXBlX2luZm8gd2l0aG91dCBzeW5jaHJvbml6YXRp
b24uCisgKi8KK3N0YXRpYyBpbnQgY2xlYW51cF9wYWdlX21hcHBpbmdzKHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2UpCiB7CiAgICAgdW5zaWduZWQgaW50IGNh
Y2hlYXR0ciA9CiAgICAgICAgIChwYWdlLT5jb3VudF9pbmZvICYgUEdDX2Nh
Y2hlYXR0cl9tYXNrKSA+PiBQR0NfY2FjaGVhdHRyX2Jhc2U7CisgICAgaW50
IHJjID0gMDsKKyAgICB1bnNpZ25lZCBsb25nIG1mbiA9IG1mbl94KHBhZ2Vf
dG9fbWZuKHBhZ2UpKTsKIAotICAgIGlmICggbGlrZWx5KGNhY2hlYXR0ciA9
PSAwKSApCi0gICAgICAgIHJldHVybiAwOworICAgIC8qCisgICAgICogSWYg
d2UndmUgbW9kaWZpZWQgeGVuIG1hcHBpbmdzIGFzIGEgcmVzdWx0IG9mIGd1
ZXN0IGNhY2hlCisgICAgICogYXR0cmlidXRlcywgcmVzdG9yZSB0aGVtIHRv
IHRoZSAibm9ybWFsIiBzdGF0ZS4KKyAgICAgKi8KKyAgICBpZiAoIHVubGlr
ZWx5KGNhY2hlYXR0cikgKQorICAgIHsKKyAgICAgICAgcGFnZS0+Y291bnRf
aW5mbyAmPSB+UEdDX2NhY2hlYXR0cl9tYXNrOwogCi0gICAgcGFnZS0+Y291
bnRfaW5mbyAmPSB+UEdDX2NhY2hlYXR0cl9tYXNrOworICAgICAgICBCVUdf
T04oaXNfeGVuX2hlYXBfcGFnZShwYWdlKSk7CiAKLSAgICBCVUdfT04oaXNf
eGVuX2hlYXBfcGFnZShwYWdlKSk7CisgICAgICAgIHJjID0gdXBkYXRlX3hl
bl9tYXBwaW5ncyhtZm4sIDApOworICAgIH0KIAotICAgIHJldHVybiB1cGRh
dGVfeGVuX21hcHBpbmdzKG1mbl94KHBhZ2VfdG9fbWZuKHBhZ2UpKSwgMCk7
CisgICAgLyoKKyAgICAgKiBJZiB0aGlzIG1heSBiZSBpbiBhIFBWIGRvbWFp
bidzIElPTU1VLCByZW1vdmUgaXQuCisgICAgICoKKyAgICAgKiBOQiB0aGF0
IHdyaXRhYmxlIHhlbmhlYXAgcGFnZXMgaGF2ZSB0aGVpciB0eXBlIHNldCBh
bmQgY2xlYXJlZCBieQorICAgICAqIGltcGxlbWVudGF0aW9uLXNwZWNpZmlj
IGNvZGUsIHJhdGhlciB0aGFuIGJ5IGdldF9wYWdlX3R5cGUoKS4gIEFzIHN1
Y2g6CisgICAgICogLSBUaGV5IGFyZW4ndCBleHBlY3RlZCB0byBoYXZlIGFu
IElPTU1VIG1hcHBpbmcsIGFuZAorICAgICAqIC0gV2UgZG9uJ3QgbmVjZXNz
YXJpbHkgZXhwZWN0IHRoZSB0eXBlIGNvdW50IHRvIGJlIHplcm8gd2hlbiB0
aGUgZmluYWwKKyAgICAgKiBwdXRfcGFnZSBoYXBwZW5zLgorICAgICAqCisg
ICAgICogR28gYWhlYWQgYW5kIGF0dGVtcCB0byBjYWxsIGlvbW11X3VubWFw
KCkgb24geGVuaGVhcCBwYWdlcyBhbnl3YXksIGp1c3QKKyAgICAgKiBpbiBj
YXNlOyBidXQgb25seSBBU1NFUlQoKSB0aGF0IHRoZSB0eXBlIGNvdW50IGlz
IHplcm8gYW5kIHJlbW92ZSB0aGUKKyAgICAgKiBQR1Rfd3JpdGFibGUgdHlw
ZSBmb3Igbm9uLXhlbmhlYXAgcGFnZXMuCisgICAgICovCisgICAgaWYgKCAo
cGFnZS0+dS5pbnVzZS50eXBlX2luZm8gJiBQR1RfdHlwZV9tYXNrKSA9PSBQ
R1Rfd3JpdGFibGVfcGFnZSApCisgICAgeworICAgICAgICBzdHJ1Y3QgZG9t
YWluICpkID0gcGFnZV9nZXRfb3duZXIocGFnZSk7CisKKyAgICAgICAgaWYg
KCBkICYmIGlzX3B2X2RvbWFpbihkKSAmJiB1bmxpa2VseShuZWVkX2lvbW11
KGQpKSApCisgICAgICAgIHsKKyAgICAgICAgICAgIGludCByYzIgPSBpb21t
dV91bm1hcF9wYWdlKGQsIG1mbik7CisKKyAgICAgICAgICAgIGlmICggIXJj
ICkKKyAgICAgICAgICAgICAgICByYyA9IHJjMjsKKyAgICAgICAgfQorCisg
ICAgICAgIGlmICggbGlrZWx5KCFpc194ZW5faGVhcF9wYWdlKHBhZ2UpKSAp
CisgICAgICAgIHsKKyAgICAgICAgICAgIEFTU0VSVCgocGFnZS0+dS5pbnVz
ZS50eXBlX2luZm8gJgorICAgICAgICAgICAgICAgICAgICAoUEdUX3R5cGVf
bWFzayB8IFBHVF9jb3VudF9tYXNrKSkgPT0gUEdUX3dyaXRhYmxlX3BhZ2Up
OworICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAqIENsZWFyIHRoZSB0
eXBlIHRvIHJlY29yZCB0aGUgZmFjdCB0aGF0IGFsbCB3cml0YWJsZSBtYXBw
aW5ncworICAgICAgICAgICAgICogaGF2ZSBiZWVuIHJlbW92ZWQuICBCdXQg
aWYgZWl0aGVyIG9wZXJhdGlvbiBmYWlsZWQsIGxlYXZlCisgICAgICAgICAg
ICAgKiB0eXBlX2luZm8gYWxvbmUuCisgICAgICAgICAgICAgKi8KKyAgICAg
ICAgICAgIGlmICggbGlrZWx5KCFyYykgKQorICAgICAgICAgICAgICAgIHBh
Z2UtPnUuaW51c2UudHlwZV9pbmZvICY9IH4oUEdUX3R5cGVfbWFzayB8IFBH
VF9jb3VudF9tYXNrKTsKKyAgICAgICAgfQorICAgIH0KKworICAgIHJldHVy
biByYzsKIH0KIAogdm9pZCBwdXRfcGFnZShzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlKQpAQCAtMjMwMyw3ICsyMzc5LDcgQEAgdm9pZCBwdXRfcGFnZShzdHJ1
Y3QgcGFnZV9pbmZvICpwYWdlKQogCiAgICAgaWYgKCB1bmxpa2VseSgobngg
JiBQR0NfY291bnRfbWFzaykgPT0gMCkgKQogICAgIHsKLSAgICAgICAgaWYg
KCBjbGVhbnVwX3BhZ2VfY2FjaGVhdHRyKHBhZ2UpID09IDAgKQorICAgICAg
ICBpZiAoICFjbGVhbnVwX3BhZ2VfbWFwcGluZ3MocGFnZSkgKQogICAgICAg
ICAgICAgZnJlZV9kb21oZWFwX3BhZ2UocGFnZSk7CiAgICAgICAgIGVsc2UK
ICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLApAQCAtNDAy
MCw5ICs0MDk2LDEwIEBAIGludCBzdGVhbF9wYWdlKAogICAgICAqIE5CIHRo
aXMgaXMgc2FmZSBldmVuIGlmIHRoZSBwYWdlIGVuZHMgdXAgYmVpbmcgZ2l2
ZW4gYmFjayB0bwogICAgICAqIHRoZSBkb21haW4sIGJlY2F1c2UgdGhlIGNv
dW50IGlzIHplcm86IHN1YnNlcXVlbnQgbWFwcGluZ3Mgd2lsbAogICAgICAq
IGNhdXNlIHRoZSBjYWNoZSBhdHRyaWJ1dGVzIHRvIGJlIHJlLWluc3RhdGVk
IGluc2lkZQotICAgICAqIGdldF9wYWdlX2Zyb21fbDFlKCkuCisgICAgICog
Z2V0X3BhZ2VfZnJvbV9sMWUoKSwgb3IgdGhlIHBhZ2UgdG8gYmUgYWRkZWQg
YmFjayB0byB0aGUgSU9NTVUKKyAgICAgKiB1cG9uIHRoZSB0eXBlIGNoYW5n
aW5nIHRvIFBHVF93cml0ZWFibGUsIGFzIGFwcHJvcHJpYXRlLgogICAgICAq
LwotICAgIGlmICggKHJjID0gY2xlYW51cF9wYWdlX2NhY2hlYXR0cihwYWdl
KSkgKQorICAgIGlmICggKHJjID0gY2xlYW51cF9wYWdlX21hcHBpbmdzKHBh
Z2UpKSApCiAgICAgewogICAgICAgICAvKgogICAgICAgICAgKiBDb3VsZG4n
dCBmaXh1cCBYZW4ncyBtYXBwaW5nczsgcHV0IHRoaW5ncyB0aGUgd2F5IHdl
IGZvdW5kCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMgYi94
ZW4vYXJjaC94ODYvbW0vcDJtLmMKaW5kZXggYzUzY2FiNDRkOS4uMmI2MmJj
NjFkZCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwpAQCAtNzA4LDIzICs3MDgsOSBAQCBw
Mm1fcmVtb3ZlX3BhZ2Uoc3RydWN0IHAybV9kb21haW4gKnAybSwgdW5zaWdu
ZWQgbG9uZyBnZm5fbCwgdW5zaWduZWQgbG9uZyBtZm4sCiAgICAgcDJtX3R5
cGVfdCB0OwogICAgIHAybV9hY2Nlc3NfdCBhOwogCisgICAgLyogSU9NTVUg
Zm9yIFBWIGd1ZXN0cyBpcyBoYW5kbGVkIGluIGdldF9wYWdlX3R5cGUoKSBh
bmQgcHV0X3BhZ2UoKS4gKi8KICAgICBpZiAoICFwYWdpbmdfbW9kZV90cmFu
c2xhdGUocDJtLT5kb21haW4pICkKLSAgICB7Ci0gICAgICAgIGludCByYyA9
IDA7Ci0KLSAgICAgICAgaWYgKCBuZWVkX2lvbW11KHAybS0+ZG9tYWluKSAp
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDEg
PDwgcGFnZV9vcmRlcik7IGkrKyApCi0gICAgICAgICAgICB7Ci0gICAgICAg
ICAgICAgICAgaW50IHJldCA9IGlvbW11X3VubWFwX3BhZ2UocDJtLT5kb21h
aW4sIG1mbiArIGkpOwotCi0gICAgICAgICAgICAgICAgaWYgKCAhcmMgKQot
ICAgICAgICAgICAgICAgICAgICByYyA9IHJldDsKLSAgICAgICAgICAgIH0K
LSAgICAgICAgfQotCi0gICAgICAgIHJldHVybiByYzsKLSAgICB9CisgICAg
ICAgIHJldHVybiAwOwogCiAgICAgQVNTRVJUKGdmbl9sb2NrZWRfYnlfbWUo
cDJtLCBnZm4pKTsKICAgICBQMk1fREVCVUcoInJlbW92aW5nIGdmbj0lI2x4
IG1mbj0lI2x4XG4iLCBnZm5fbCwgbWZuKTsKQEAgLTc2OSwyNiArNzU1LDMz
IEBAIGd1ZXN0X3BoeXNtYXBfYWRkX2VudHJ5KHN0cnVjdCBkb21haW4gKmQs
IGdmbl90IGdmbiwgbWZuX3QgbWZuLAogICAgIGludCBwb2RfY291bnQgPSAw
OwogICAgIGludCByYyA9IDA7CiAKKyAgICAvKiBJT01NVSBmb3IgUFYgZ3Vl
c3RzIGlzIGhhbmRsZWQgaW4gZ2V0X3BhZ2VfdHlwZSgpIGFuZCBwdXRfcGFn
ZSgpLiAqLwogICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShkKSAp
CiAgICAgewotICAgICAgICBpZiAoIG5lZWRfaW9tbXUoZCkgJiYgdCA9PSBw
Mm1fcmFtX3J3ICkKLSAgICAgICAgewotICAgICAgICAgICAgZm9yICggaSA9
IDA7IGkgPCAoMSA8PCBwYWdlX29yZGVyKTsgaSsrICkKLSAgICAgICAgICAg
IHsKLSAgICAgICAgICAgICAgICByYyA9IGlvbW11X21hcF9wYWdlKGQsIG1m
bl94KG1mbl9hZGQobWZuLCBpKSksCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBtZm5feChtZm5fYWRkKG1mbiwgaSkpLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVGX3JlYWRhYmxl
fElPTU1VRl93cml0YWJsZSk7Ci0gICAgICAgICAgICAgICAgaWYgKCByYyAh
PSAwICkKLSAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAg
IHdoaWxlICggaS0tID4gMCApCi0gICAgICAgICAgICAgICAgICAgICAgICAv
KiBJZiBzdGF0ZW1lbnQgdG8gc2F0aXNmeSBfX211c3RfY2hlY2suICovCi0g
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGlvbW11X3VubWFwX3BhZ2Uo
ZCwgbWZuX3gobWZuX2FkZChtZm4sIGkpKSkgKQotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlID0gbWZuX3RvX3BhZ2UobWZuKTsKIAotICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gcmM7Ci0gICAgICAgICAgICAgICAgfQotICAgICAg
ICAgICAgfQorICAgICAgICAvKgorICAgICAgICAgKiBPdXIgaW50ZXJmYWNl
IGZvciBQViBndWVzdHMgd3J0IElPTU1VIGVudHJpZXMgaGFzbid0IGJlZW4g
dmVyeQorICAgICAgICAgKiBjbGVhcjsgYnV0IGhpc3RvcmljYWxseSwgcGFn
ZXMgaGF2ZSBzdGFydGVkIG91dCB3aXRoIElPTU1VIG1hcHBpbmdzLAorICAg
ICAgICAgKiBhbmQgb25seSBsb3NlIHRoZW0gd2hlbiBjaGFuZ2VkIHRvIGEg
ZGlmZmVyZW50IHBhZ2UgdHlwZS4KKyAgICAgICAgICoKKyAgICAgICAgICog
UmV0YWluIHRoaXMgcHJvcGVydHkgYnkgZ3JhYmJpbmcgYSB3cml0YWJsZSB0
eXBlIHJlZiBhbmQgdGhlbgorICAgICAgICAgKiBkcm9wcGluZyBpdCBpbW1l
ZGlhdGVseS4gIFRoZSByZXN1bHQgd2lsbCBiZSBwYWdlcyB0aGF0IGhhdmUg
YQorICAgICAgICAgKiB3cml0YWJsZSB0eXBlIChhbmQgYW4gSU9NTVUgZW50
cnkpLCBidXQgYSBjb3VudCBvZiAwIChzdWNoIHRoYXQKKyAgICAgICAgICog
YW55IGd1ZXN0LXJlcXVlc3RlZCB0eXBlIGNoYW5nZXMgc3VjY2VlZCBhbmQg
cmVtb3ZlIHRoZSBJT01NVQorICAgICAgICAgKiBlbnRyeSkuCisgICAgICAg
ICAqLworICAgICAgICBpZiAoICFuZWVkX2lvbW11KGQpIHx8IHQgIT0gcDJt
X3JhbV9ydyApCisgICAgICAgICAgICByZXR1cm4gMDsKKworICAgICAgICBm
b3IgKCBpID0gMDsgaSA8ICgxVUwgPDwgcGFnZV9vcmRlcik7ICsraSwgKytw
YWdlICkKKyAgICAgICAgeworICAgICAgICAgICAgaWYgKCBnZXRfcGFnZV9h
bmRfdHlwZShwYWdlLCBkLCBQR1Rfd3JpdGFibGVfcGFnZSkgKQorICAgICAg
ICAgICAgICAgIHB1dF9wYWdlX2FuZF90eXBlKHBhZ2UpOworICAgICAgICAg
ICAgZWxzZQorICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwogICAg
ICAgICB9CisKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCi0tIAoyLjIw
LjEKCg==

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


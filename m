Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E9D22C499
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:39:48 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZTW-0001oZ-E1; Tue, 28 May 2019 10:36:58 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZTU-0001ne-Qs
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:36:56 +0000
X-Inumbo-ID: 06c100ec-8134-11e9-9fb4-7fd2d8c0f977
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 06c100ec-8134-11e9-9fb4-7fd2d8c0f977;
 Tue, 28 May 2019 10:33:26 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 0E208B033;
 Tue, 28 May 2019 10:33:26 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:32:49 +0200
Message-Id: <20190528103313.1343-37-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 36/60] xen/sched: introduce unit_runnable_state()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>,
 Dario Faggioli <dfaggioli@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VG9kYXkgdGhlIHZjcHUgcnVuc3RhdGUgb2YgYSBuZXcgc2NoZWR1bGVkIHZjcHUgaXMgYWx3YXlz
IHNldCB0bwoicnVubmluZyIgZXZlbiBpZiBhdCB0aGF0IHRpbWUgdmNwdV9ydW5uYWJsZSgpIGlz
IGFscmVhZHkgcmV0dXJuaW5nCmZhbHNlIGR1ZSB0byBhIHJhY2UgKGUuZy4gd2l0aCBwYXVzaW5n
IHRoZSB2Y3B1KS4KCldpdGggY29yZSBzY2hlZHVsaW5nIHRoaXMgY2FuIG5vIGxvbmdlciB3b3Jr
IGFzIG5vdCBhbGwgdmNwdXMgb2YgYQpzY2hlZHVsZSB1bml0IGhhdmUgdG8gYmUgInJ1bm5pbmci
IHdoZW4gYmVpbmcgc2NoZWR1bGVkLiBTbyB0aGUgdmNwdSdzCm5ldyBydW5zdGF0ZSBoYXMgdG8g
YmUgc2VsZWN0ZWQgYXQgdGhlIHNhbWUgdGltZSBhcyB0aGUgcnVubmFiaWxpdHkgb2YKdGhlIHJl
bGF0ZWQgc2NoZWR1bGUgdW5pdCBpcyBwcm9iZWQuCgpGb3IgdGhpcyBwdXJwb3NlIGludHJvZHVj
ZSBhIG5ldyBoZWxwZXIgdW5pdF9ydW5uYWJsZV9zdGF0ZSgpIHdoaWNoCndpbGwgc2F2ZSB0aGUg
bmV3IHJ1bnN0YXRlIG9mIGFsbCB0ZXN0ZWQgdmNwdXMgaW4gYSBuZXcgZmllbGQgb2YgdGhlCnZj
cHUgc3RydWN0LgoKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29t
PgotLS0KUkZDIFYyOiBuZXcgcGF0Y2gKLS0tCiB4ZW4vY29tbW9uL2RvbWFpbi5jICAgICAgICAg
fCAgMSArCiB4ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMgfCAgMiArLQogeGVuL2NvbW1vbi9z
Y2hlZF9jcmVkaXQuYyAgIHwgNDkgKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyAgfCAgNyArKysrLS0tCiB4ZW4v
Y29tbW9uL3NjaGVkX251bGwuYyAgICAgfCAgMyArKy0KIHhlbi9jb21tb24vc2NoZWRfcnQuYyAg
ICAgICB8ICA4ICsrKysrKystCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAgICAgfCAgMiArLQog
eGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmggIHwgMTQgKysrKysrKysrKysrKwogeGVuL2luY2x1
ZGUveGVuL3NjaGVkLmggICAgIHwgIDEgKwogOSBmaWxlcyBjaGFuZ2VkLCA1NyBpbnNlcnRpb25z
KCspLCAzMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2RvbWFpbi5jIGIv
eGVuL2NvbW1vbi9kb21haW4uYwppbmRleCA2NWY4YTM2OWMxLi4wZGFlZGNhNzI5IDEwMDY0NAot
LS0gYS94ZW4vY29tbW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTE1
MCw2ICsxNTAsNyBAQCBzdHJ1Y3QgdmNwdSAqdmNwdV9jcmVhdGUoc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgaW50IHZjcHVfaWQpCiAgICAgaWYgKCBpc19pZGxlX2RvbWFpbihkKSApCiAgICAg
ewogICAgICAgICB2LT5ydW5zdGF0ZS5zdGF0ZSA9IFJVTlNUQVRFX3J1bm5pbmc7CisgICAgICAg
IHYtPm5ld19zdGF0ZSA9IFJVTlNUQVRFX3J1bm5pbmc7CiAgICAgfQogICAgIGVsc2UKICAgICB7
CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMgYi94ZW4vY29tbW9uL3Nj
aGVkX2FyaW5jNjUzLmMKaW5kZXggMzRlZmNjMDdjOS4uNzU5YzQyYWI3MyAxMDA2NDQKLS0tIGEv
eGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2
NTMuYwpAQCAtNTU3LDcgKzU1Nyw3IEBAIGE2NTNzY2hlZF9kb19zY2hlZHVsZSgKICAgICBpZiAo
ICEoKG5ld190YXNrICE9IE5VTEwpCiAgICAgICAgICAgICYmIChBVU5JVChuZXdfdGFzaykgIT0g
TlVMTCkKICAgICAgICAgICAgJiYgQVVOSVQobmV3X3Rhc2spLT5hd2FrZQotICAgICAgICAgICAm
JiB1bml0X3J1bm5hYmxlKG5ld190YXNrKSkgKQorICAgICAgICAgICAmJiB1bml0X3J1bm5hYmxl
X3N0YXRlKG5ld190YXNrKSkgKQogICAgICAgICBuZXdfdGFzayA9IElETEVUQVNLKGNwdSk7CiAg
ICAgQlVHX09OKG5ld190YXNrID09IE5VTEwpOwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3Nj
aGVkX2NyZWRpdC5jIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwppbmRleCAxOTZmNjEzNDIw
Li4xNTMzOWU2ZmFlIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCisrKyBi
L3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKQEAgLTE4OTksNyArMTg5OSw3IEBAIHN0YXRpYyB2
b2lkIGNzY2hlZF9zY2hlZHVsZSgKICAgICBpZiAoICF0ZXN0X2JpdChDU0NIRURfRkxBR19VTklU
X1lJRUxELCAmc2N1cnItPmZsYWdzKQogICAgICAgICAgJiYgIXRhc2tsZXRfd29ya19zY2hlZHVs
ZWQKICAgICAgICAgICYmIHBydi0+cmF0ZWxpbWl0Ci0gICAgICAgICAmJiB1bml0X3J1bm5hYmxl
KHVuaXQpCisgICAgICAgICAmJiB1bml0X3J1bm5hYmxlX3N0YXRlKHVuaXQpCiAgICAgICAgICAm
JiAhaXNfaWRsZV91bml0KHVuaXQpCiAgICAgICAgICAmJiBydW50aW1lIDwgcHJ2LT5yYXRlbGlt
aXQgKQogICAgIHsKQEAgLTE5NDQsMzMgKzE5NDQsMzYgQEAgc3RhdGljIHZvaWQgY3NjaGVkX3Nj
aGVkdWxlKAogICAgICAgICBkZWNfbnJfcnVubmFibGUoc2NoZWRfY3B1KTsKICAgICB9CiAKLSAg
ICBzbmV4dCA9IF9fcnVucV9lbGVtKHJ1bnEtPm5leHQpOwotCi0gICAgLyogVGFza2xldCB3b3Jr
ICh3aGljaCBydW5zIGluIGlkbGUgVU5JVCBjb250ZXh0KSBvdmVycmlkZXMgYWxsIGVsc2UuICov
Ci0gICAgaWYgKCB0YXNrbGV0X3dvcmtfc2NoZWR1bGVkICkKLSAgICB7Ci0gICAgICAgIFRSQUNF
XzBEKFRSQ19DU0NIRURfU0NIRURfVEFTS0xFVCk7Ci0gICAgICAgIHNuZXh0ID0gQ1NDSEVEX1VO
SVQoc2NoZWRfaWRsZV91bml0KHNjaGVkX2NwdSkpOwotICAgICAgICBzbmV4dC0+cHJpID0gQ1ND
SEVEX1BSSV9UU19CT09TVDsKLSAgICB9Ci0KICAgICAvKgogICAgICAqIENsZWFyIFlJRUxEIGZs
YWcgYmVmb3JlIHNjaGVkdWxpbmcgb3V0CiAgICAgICovCiAgICAgY2xlYXJfYml0KENTQ0hFRF9G
TEFHX1VOSVRfWUlFTEQsICZzY3Vyci0+ZmxhZ3MpOwogCi0gICAgLyoKLSAgICAgKiBTTVAgTG9h
ZCBiYWxhbmNlOgotICAgICAqCi0gICAgICogSWYgdGhlIG5leHQgaGlnaGVzdCBwcmlvcml0eSBs
b2NhbCBydW5uYWJsZSBVTklUIGhhcyBhbHJlYWR5IGVhdGVuCi0gICAgICogdGhyb3VnaCBpdHMg
Y3JlZGl0cywgbG9vayBvbiBvdGhlciBQQ1BVcyB0byBzZWUgaWYgd2UgaGF2ZSBtb3JlCi0gICAg
ICogdXJnZW50IHdvcmsuLi4gSWYgbm90LCBjc2NoZWRfbG9hZF9iYWxhbmNlKCkgd2lsbCByZXR1
cm4gc25leHQsIGJ1dAotICAgICAqIGFscmVhZHkgcmVtb3ZlZCBmcm9tIHRoZSBydW5xLgotICAg
ICAqLwotICAgIGlmICggc25leHQtPnByaSA+IENTQ0hFRF9QUklfVFNfT1ZFUiApCi0gICAgICAg
IF9fcnVucV9yZW1vdmUoc25leHQpOwotICAgIGVsc2UKLSAgICAgICAgc25leHQgPSBjc2NoZWRf
bG9hZF9iYWxhbmNlKHBydiwgc2NoZWRfY3B1LCBzbmV4dCwgJm1pZ3JhdGVkKTsKKyAgICBkbyB7
CisgICAgICAgIHNuZXh0ID0gX19ydW5xX2VsZW0ocnVucS0+bmV4dCk7CisKKyAgICAgICAgLyog
VGFza2xldCB3b3JrICh3aGljaCBydW5zIGluIGlkbGUgVU5JVCBjb250ZXh0KSBvdmVycmlkZXMg
YWxsIGVsc2UuICovCisgICAgICAgIGlmICggdGFza2xldF93b3JrX3NjaGVkdWxlZCApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIFRSQUNFXzBEKFRSQ19DU0NIRURfU0NIRURfVEFTS0xFVCk7Cisg
ICAgICAgICAgICBzbmV4dCA9IENTQ0hFRF9VTklUKHNjaGVkX2lkbGVfdW5pdChzY2hlZF9jcHUp
KTsKKyAgICAgICAgICAgIHNuZXh0LT5wcmkgPSBDU0NIRURfUFJJX1RTX0JPT1NUOworICAgICAg
ICB9CisKKyAgICAgICAgLyoKKyAgICAgICAgICogU01QIExvYWQgYmFsYW5jZToKKyAgICAgICAg
ICoKKyAgICAgICAgICogSWYgdGhlIG5leHQgaGlnaGVzdCBwcmlvcml0eSBsb2NhbCBydW5uYWJs
ZSBVTklUIGhhcyBhbHJlYWR5IGVhdGVuCisgICAgICAgICAqIHRocm91Z2ggaXRzIGNyZWRpdHMs
IGxvb2sgb24gb3RoZXIgUENQVXMgdG8gc2VlIGlmIHdlIGhhdmUgbW9yZQorICAgICAgICAgKiB1
cmdlbnQgd29yay4uLiBJZiBub3QsIGNzY2hlZF9sb2FkX2JhbGFuY2UoKSB3aWxsIHJldHVybiBz
bmV4dCwgYnV0CisgICAgICAgICAqIGFscmVhZHkgcmVtb3ZlZCBmcm9tIHRoZSBydW5xLgorICAg
ICAgICAgKi8KKyAgICAgICAgaWYgKCBzbmV4dC0+cHJpID4gQ1NDSEVEX1BSSV9UU19PVkVSICkK
KyAgICAgICAgICAgIF9fcnVucV9yZW1vdmUoc25leHQpOworICAgICAgICBlbHNlCisgICAgICAg
ICAgICBzbmV4dCA9IGNzY2hlZF9sb2FkX2JhbGFuY2UocHJ2LCBzY2hlZF9jcHUsIHNuZXh0LCAm
bWlncmF0ZWQpOworCisgICAgfSB3aGlsZSAoICF1bml0X3J1bm5hYmxlX3N0YXRlKHNuZXh0LT51
bml0KSApOwogCiAgICAgLyoKICAgICAgKiBVcGRhdGUgaWRsZXJzIG1hc2sgaWYgbmVjZXNzYXJ5
LiBXaGVuIHdlJ3JlIGlkbGluZywgb3RoZXIgQ1BVcwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9z
Y2hlZF9jcmVkaXQyLmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwppbmRleCA2Njk1NDQx
NTg4Li4zYmZjZWVmYTQ2IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwor
KysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwpAQCAtMzI4OCw3ICszMjg4LDcgQEAgcnVu
cV9jYW5kaWRhdGUoc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFkLAogICAgICAqIElu
IGZhY3QsIGl0IG1heSBiZSB0aGUgY2FzZSB0aGF0IHNjdXJyIGlzIGFib3V0IHRvIHNwaW4sIGFu
ZCB0aGVyZSdzCiAgICAgICogbm8gcG9pbnQgZm9yY2luZyBpdCB0byBkbyBzbyB1bnRpbCByYXRl
IGxpbWl0aW5nIGV4cGlyZXMuCiAgICAgICovCi0gICAgaWYgKCAheWllbGQgJiYgcHJ2LT5yYXRl
bGltaXRfdXMgJiYgdW5pdF9ydW5uYWJsZShzY3Vyci0+dW5pdCkgJiYKKyAgICBpZiAoICF5aWVs
ZCAmJiBwcnYtPnJhdGVsaW1pdF91cyAmJiB1bml0X3J1bm5hYmxlX3N0YXRlKHNjdXJyLT51bml0
KSAmJgogICAgICAgICAgKG5vdyAtIHNjdXJyLT51bml0LT5zdGF0ZV9lbnRyeV90aW1lKSA8IE1J
Q1JPU0VDUyhwcnYtPnJhdGVsaW1pdF91cykgKQogICAgIHsKICAgICAgICAgaWYgKCB1bmxpa2Vs
eSh0Yl9pbml0X2RvbmUpICkKQEAgLTMzNDIsNyArMzM0Miw3IEBAIHJ1bnFfY2FuZGlkYXRlKHN0
cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwKICAgICAgKgogICAgICAqIE9mIGNvdXJz
ZSwgd2UgYWxzbyBkZWZhdWx0IHRvIGlkbGUgYWxzbyBpZiBzY3VyciBpcyBub3QgcnVubmFibGUu
CiAgICAgICovCi0gICAgaWYgKCB1bml0X3J1bm5hYmxlKHNjdXJyLT51bml0KSAmJiAhc29mdF9h
ZmZfcHJlZW1wdCApCisgICAgaWYgKCB1bml0X3J1bm5hYmxlX3N0YXRlKHNjdXJyLT51bml0KSAm
JiAhc29mdF9hZmZfcHJlZW1wdCApCiAgICAgICAgIHNuZXh0ID0gc2N1cnI7CiAgICAgZWxzZQog
ICAgICAgICBzbmV4dCA9IGNzY2hlZDJfdW5pdChzY2hlZF9pZGxlX3VuaXQoY3B1KSk7CkBAIC0z
NDAyLDcgKzM0MDIsOCBAQCBydW5xX2NhbmRpZGF0ZShzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9k
YXRhICpycWQsCiAgICAgICAgICAqIHNvbWUgYnVkZ2V0LCB0aGVuIGNob29zZSBpdC4KICAgICAg
ICAgICovCiAgICAgICAgIGlmICggKHlpZWxkIHx8IHN2Yy0+Y3JlZGl0ID4gc25leHQtPmNyZWRp
dCkgJiYKLSAgICAgICAgICAgICAoIWhhc19jYXAoc3ZjKSB8fCB1bml0X2dyYWJfYnVkZ2V0KHN2
YykpICkKKyAgICAgICAgICAgICAoIWhhc19jYXAoc3ZjKSB8fCB1bml0X2dyYWJfYnVkZ2V0KHN2
YykpICYmCisgICAgICAgICAgICAgdW5pdF9ydW5uYWJsZV9zdGF0ZShzdmMtPnVuaXQpICkKICAg
ICAgICAgICAgIHNuZXh0ID0gc3ZjOwogCiAgICAgICAgIC8qIEluIGFueSBjYXNlLCBpZiB3ZSBn
b3QgdGhpcyBmYXIsIGJyZWFrLiAqLwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9udWxs
LmMgYi94ZW4vY29tbW9uL3NjaGVkX251bGwuYwppbmRleCA1MzRkMGFlYTVmLi5lOTMzNmEyOTQ4
IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX251bGwuYworKysgYi94ZW4vY29tbW9uL3Nj
aGVkX251bGwuYwpAQCAtNzc2LDcgKzc3Niw4IEBAIHN0YXRpYyB2b2lkIG51bGxfc2NoZWR1bGUo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqcHJldiwKICAg
ICAgICAgc3Bpbl91bmxvY2soJnBydi0+d2FpdHFfbG9jayk7CiAgICAgfQogCi0gICAgaWYgKCB1
bmxpa2VseShwcmV2LT5uZXh0X3Rhc2sgPT0gTlVMTCB8fCAhdW5pdF9ydW5uYWJsZShwcmV2LT5u
ZXh0X3Rhc2spKSApCisgICAgaWYgKCB1bmxpa2VseShwcmV2LT5uZXh0X3Rhc2sgPT0gTlVMTCB8
fAorICAgICAgICAgICAgICAgICAgIXVuaXRfcnVubmFibGVfc3RhdGUocHJldi0+bmV4dF90YXNr
KSkgKQogICAgICAgICBwcmV2LT5uZXh0X3Rhc2sgPSBzY2hlZF9pZGxlX3VuaXQoc2NoZWRfY3B1
KTsKIAogICAgIE5VTExfVU5JVF9DSEVDSyhwcmV2LT5uZXh0X3Rhc2spOwpkaWZmIC0tZ2l0IGEv
eGVuL2NvbW1vbi9zY2hlZF9ydC5jIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCmluZGV4IGFlZDQ5
ODk3MGUuLjYyNThkZDJmMmEgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfcnQuYworKysg
Yi94ZW4vY29tbW9uL3NjaGVkX3J0LmMKQEAgLTEwOTQsMTIgKzEwOTQsMTggQEAgcnRfc2NoZWR1
bGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqY3VycnVu
aXQsCiAgICAgZWxzZQogICAgIHsKICAgICAgICAgc25leHQgPSBydW5xX3BpY2sob3BzLCBjcHVt
YXNrX29mKHNjaGVkX2NwdSkpOworCiAgICAgICAgIGlmICggc25leHQgPT0gTlVMTCApCiAgICAg
ICAgICAgICBzbmV4dCA9IHJ0X3VuaXQoc2NoZWRfaWRsZV91bml0KHNjaGVkX2NwdSkpOworICAg
ICAgICBlbHNlIGlmICggIXVuaXRfcnVubmFibGVfc3RhdGUoc25leHQtPnVuaXQpICkKKyAgICAg
ICAgeworICAgICAgICAgICAgcV9yZW1vdmUoc25leHQpOworICAgICAgICAgICAgc25leHQgPSBy
dF91bml0KHNjaGVkX2lkbGVfdW5pdChzY2hlZF9jcHUpKTsKKyAgICAgICAgfQogCiAgICAgICAg
IC8qIGlmIHNjdXJyIGhhcyBoaWdoZXIgcHJpb3JpdHkgYW5kIGJ1ZGdldCwgc3RpbGwgcGljayBz
Y3VyciAqLwogICAgICAgICBpZiAoICFpc19pZGxlX3VuaXQoY3VycnVuaXQpICYmCi0gICAgICAg
ICAgICAgdW5pdF9ydW5uYWJsZShjdXJydW5pdCkgJiYKKyAgICAgICAgICAgICB1bml0X3J1bm5h
YmxlX3N0YXRlKGN1cnJ1bml0KSAmJgogICAgICAgICAgICAgIHNjdXJyLT5jdXJfYnVkZ2V0ID4g
MCAmJgogICAgICAgICAgICAgICggaXNfaWRsZV91bml0KHNuZXh0LT51bml0KSB8fAogICAgICAg
ICAgICAgICAgY29tcGFyZV91bml0X3ByaW9yaXR5KHNjdXJyLCBzbmV4dCkgPiAwICkgKQpkaWZm
IC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jIGIveGVuL2NvbW1vbi9zY2hlZHVsZS5jCmlu
ZGV4IDlkZTMxNWFkYTEuLjM1MjgwMzYyMmQgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWR1
bGUuYworKysgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKQEAgLTIwNiw3ICsyMDYsNyBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgc2NoZWRfdW5pdF9ydW5zdGF0ZV9jaGFuZ2Uoc3RydWN0IHNjaGVkX3Vu
aXQgKnVuaXQsCiAgICAgc3RydWN0IHZjcHUgKnYgPSB1bml0LT52Y3B1OwogCiAgICAgaWYgKCBy
dW5uaW5nICkKLSAgICAgICAgdmNwdV9ydW5zdGF0ZV9jaGFuZ2UodiwgUlVOU1RBVEVfcnVubmlu
ZywgbmV3X2VudHJ5X3RpbWUpOworICAgICAgICB2Y3B1X3J1bnN0YXRlX2NoYW5nZSh2LCB2LT5u
ZXdfc3RhdGUsIG5ld19lbnRyeV90aW1lKTsKICAgICBlbHNlCiAgICAgICAgIHZjcHVfcnVuc3Rh
dGVfY2hhbmdlKHYsCiAgICAgICAgICAgICAoKHYtPnBhdXNlX2ZsYWdzICYgVlBGX2Jsb2NrZWQp
ID8gUlVOU1RBVEVfYmxvY2tlZCA6CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQt
aWYuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCmluZGV4IGU2NmQ4NjZmNDEuLjgwNWNl
ZmFhMDcgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCisrKyBiL3hlbi9p
bmNsdWRlL3hlbi9zY2hlZC1pZi5oCkBAIC03MCw2ICs3MCwyMCBAQCBzdGF0aWMgaW5saW5lIGJv
b2wgdW5pdF9ydW5uYWJsZShjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKICAgICByZXR1
cm4gdmNwdV9ydW5uYWJsZSh1bml0LT52Y3B1KTsKIH0KIAorc3RhdGljIGlubGluZSBib29sIHVu
aXRfcnVubmFibGVfc3RhdGUoY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCit7CisgICAg
c3RydWN0IHZjcHUgKnY7CisgICAgYm9vbCBydW5uYWJsZTsKKworICAgIHYgPSB1bml0LT52Y3B1
OworICAgIHJ1bm5hYmxlID0gdmNwdV9ydW5uYWJsZSh2KTsKKworICAgIHYtPm5ld19zdGF0ZSA9
IHJ1bm5hYmxlID8gUlVOU1RBVEVfcnVubmluZworICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDogKHYtPnBhdXNlX2ZsYWdzICYgVlBGX2Jsb2NrZWQpCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA/IFJVTlNUQVRFX2Jsb2NrZWQgOiBSVU5TVEFURV9vZmZsaW5lOworICAgIHJldHVy
biBydW5uYWJsZTsKK30KKwogc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3NldF9yZXMoc3RydWN0
IHNjaGVkX3VuaXQgKnVuaXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3Qgc2NoZWRfcmVzb3VyY2UgKnJlcykKIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9z
Y2hlZC5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKaW5kZXggOWZmOWNiMTQ4ZC4uZDViZjYx
Y2VkMCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2luY2x1
ZGUveGVuL3NjaGVkLmgKQEAgLTE3NCw2ICsxNzQsNyBAQCBzdHJ1Y3QgdmNwdQogICAgICAgICBY
RU5fR1VFU1RfSEFORExFKHZjcHVfcnVuc3RhdGVfaW5mb19jb21wYXRfdCkgY29tcGF0OwogICAg
IH0gcnVuc3RhdGVfZ3Vlc3Q7IC8qIGd1ZXN0IGFkZHJlc3MgKi8KICNlbmRpZgorICAgIGludCAg
ICAgICAgICAgICAgbmV3X3N0YXRlOwogCiAgICAgLyogSGFzIHRoZSBGUFUgYmVlbiBpbml0aWFs
aXNlZD8gKi8KICAgICBib29sICAgICAgICAgICAgIGZwdV9pbml0aWFsaXNlZDsKLS0gCjIuMTYu
NAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

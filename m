Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 1895E33494
	for <lists+xen-devel@lfdr.de>; Mon,  3 Jun 2019 18:08:02 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hXpRS-0001wP-6Q; Mon, 03 Jun 2019 16:04:10 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=fnY6=UC=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1hXpRQ-0001vx-Ev
 for xen-devel@lists.xenproject.org; Mon, 03 Jun 2019 16:04:08 +0000
X-Inumbo-ID: 3712eb4c-8619-11e9-8980-bc764e045a96
Received: from foss.arm.com (unknown [217.140.101.70])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTP
 id 3712eb4c-8619-11e9-8980-bc764e045a96;
 Mon, 03 Jun 2019 16:04:06 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.72.51.249])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 6331880D;
 Mon,  3 Jun 2019 09:04:06 -0700 (PDT)
Received: from e108454-lin.cambridge.arm.com (e108454-lin.cambridge.arm.com
 [10.1.196.50])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 4F5553F246;
 Mon,  3 Jun 2019 09:04:04 -0700 (PDT)
From: Julien Grall <julien.grall@arm.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  3 Jun 2019 17:03:40 +0100
Message-Id: <20190603160350.29806-5-julien.grall@arm.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190603160350.29806-1-julien.grall@arm.com>
References: <20190603160350.29806-1-julien.grall@arm.com>
Subject: [Xen-devel] [PATCH v3 04/14] xen: Convert hotplug page function to
 use typesafe MFN
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Q29udmVydCBvbmxpbmVfcGFnZSwgb2ZmbGluZV9wYWdlIGFuZCBxdWVyeV9wYWdlX29mZmxpbmUg
dG8gdXNlCnR5cGVzYWZlIE1GTi4KCkF0IHRoZSBzYW1lIHRpbWUsIHRoZSB0eXBlc2FmZSBpcyBw
cm9wYWdhdGVkIGFzIGZhciBhcyBwb3NzaWJsZSB3aXRob3V0Cm1ham9yIG1vZGlmaWNhdGlvbnMu
CgpOb3RlLCBmb3IgY2xhcml0eSwgdGhlIHdvcmRzIGhhdmUgYmVlbiByZS1vcmRlcmVkIGluIHRo
ZSBlcnJvciBtZXNzYWdlCnVwZGF0ZWQgYnkgdGhpcyBwYXRjaC4KCk5vIGZ1bmN0aW9uYWwgY2hh
bmdlcy4KClNpZ25lZC1vZmYtYnk6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdyYWxsQGFybS5jb20+
CkFja2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CgotLS0KICAgIENoYW5n
ZXMgaW4gdjM6CiAgICAgICAgLSBNZW50aW9uIGluIHRoZSBjb21taXQgbWVzc2FnZSB0aGF0IHRo
ZSB0eXBlc2FmZSBpcyBwcm9wYWdhdGVkCgogICAgQ2hhbmdlcyBpbiB2MjoKICAgICAgICAtIFVw
ZGF0ZSBlcnJvciBtZXNzYWdlCiAgICAgICAgLSBBZGQgSmFuJ3MgYWNrZWQtYnkKLS0tCiB4ZW4v
YXJjaC94ODYvY3B1L21jaGVjay9tY2FjdGlvbi5jIHwgMTggKysrKysrKysrKy0tLS0tLS0tCiB4
ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyAgICAgICAgICAgIHwgMjQgKysrKysrKysrKysrLS0tLS0t
LS0tLS0tCiB4ZW4vY29tbW9uL3N5c2N0bC5jICAgICAgICAgICAgICAgIHwgMTQgKysrKysrKy0t
LS0tLS0KIHhlbi9pbmNsdWRlL3hlbi9tbS5oICAgICAgICAgICAgICAgfCAgNiArKystLS0KIDQg
ZmlsZXMgY2hhbmdlZCwgMzIgaW5zZXJ0aW9ucygrKSwgMzAgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L2NwdS9tY2hlY2svbWNhY3Rpb24uYyBiL3hlbi9hcmNoL3g4Ni9j
cHUvbWNoZWNrL21jYWN0aW9uLmMKaW5kZXggZTQyMjY3NDE0ZS4uNjkzMzJmYjg0ZCAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2NwdS9tY2hlY2svbWNhY3Rpb24uYworKysgYi94ZW4vYXJjaC94
ODYvY3B1L21jaGVjay9tY2FjdGlvbi5jCkBAIC02LDcgKzYsNyBAQAogCiBzdGF0aWMgc3RydWN0
IG1jaW5mb19yZWNvdmVyeSAqCiBtY2lfYWN0aW9uX2FkZF9wYWdlb2ZmbGluZShpbnQgYmFuaywg
c3RydWN0IG1jX2luZm8gKm1pLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3Qg
bWZuLCB1aW50MzJfdCBzdGF0dXMpCisgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5fdCBt
Zm4sIHVpbnQzMl90IHN0YXR1cykKIHsKICAgICBzdHJ1Y3QgbWNpbmZvX3JlY292ZXJ5ICpyZWM7
CiAKQEAgLTIyLDcgKzIyLDcgQEAgbWNpX2FjdGlvbl9hZGRfcGFnZW9mZmxpbmUoaW50IGJhbmss
IHN0cnVjdCBtY19pbmZvICptaSwKIAogICAgIHJlYy0+bWNfYmFuayA9IGJhbms7CiAgICAgcmVj
LT5hY3Rpb25fdHlwZXMgPSBNQ19BQ1RJT05fUEFHRV9PRkZMSU5FOwotICAgIHJlYy0+YWN0aW9u
X2luZm8ucGFnZV9yZXRpcmUubWZuID0gbWZuOworICAgIHJlYy0+YWN0aW9uX2luZm8ucGFnZV9y
ZXRpcmUubWZuID0gbWZuX3gobWZuKTsKICAgICByZWMtPmFjdGlvbl9pbmZvLnBhZ2VfcmV0aXJl
LnN0YXR1cyA9IHN0YXR1czsKICAgICByZXR1cm4gcmVjOwogfQpAQCAtNDIsNyArNDIsOCBAQCBt
Y19tZW1lcnJfZGhhbmRsZXIoc3RydWN0IG1jYV9iaW5mbyAqYmluZm8sCiAgICAgc3RydWN0IG1j
aW5mb19iYW5rICpiYW5rID0gYmluZm8tPm1pYjsKICAgICBzdHJ1Y3QgbWNpbmZvX2dsb2JhbCAq
Z2xvYmFsID0gYmluZm8tPm1pZzsKICAgICBzdHJ1Y3QgZG9tYWluICpkOwotICAgIHVuc2lnbmVk
IGxvbmcgbWZuLCBnZm47CisgICAgbWZuX3QgbWZuOworICAgIHVuc2lnbmVkIGxvbmcgZ2ZuOwog
ICAgIHVpbnQzMl90IHN0YXR1czsKICAgICBpbnQgdm1jZV92Y3B1aWQ7CiAgICAgdW5zaWduZWQg
aW50IG1jX3ZjcHVpZDsKQEAgLTU0LDExICs1NSwxMiBAQCBtY19tZW1lcnJfZGhhbmRsZXIoc3Ry
dWN0IG1jYV9iaW5mbyAqYmluZm8sCiAgICAgICAgIHJldHVybjsKICAgICB9CiAKLSAgICBtZm4g
PSBiYW5rLT5tY19hZGRyID4+IFBBR0VfU0hJRlQ7CisgICAgbWZuID0gbWFkZHJfdG9fbWZuKGJh
bmstPm1jX2FkZHIpOwogICAgIGlmICggb2ZmbGluZV9wYWdlKG1mbiwgMSwgJnN0YXR1cykgKQog
ICAgIHsKICAgICAgICAgZHByaW50ayhYRU5MT0dfV0FSTklORywKLSAgICAgICAgICAgICAgICAi
RmFpbGVkIHRvIG9mZmxpbmUgcGFnZSAlbHggZm9yIE1DRSBlcnJvclxuIiwgbWZuKTsKKyAgICAg
ICAgICAgICAgICAiRmFpbGVkIHRvIG9mZmxpbmUgcGFnZSAlIlBSSV9tZm4iIGZvciBNQ0UgZXJy
b3JcbiIsCisgICAgICAgICAgICAgICAgbWZuX3gobWZuKSk7CiAgICAgICAgIHJldHVybjsKICAg
ICB9CiAKQEAgLTg5LDEwICs5MSwxMCBAQCBtY19tZW1lcnJfZGhhbmRsZXIoc3RydWN0IG1jYV9i
aW5mbyAqYmluZm8sCiAgICAgICAgICAgICAgICAgQVNTRVJUKGQpOwogICAgICAgICAgICAgICAg
IGdmbiA9IGdldF9ncGZuX2Zyb21fbWZuKChiYW5rLT5tY19hZGRyKSA+PiBQQUdFX1NISUZUKTsK
IAotICAgICAgICAgICAgICAgIGlmICggdW5tbWFwX2Jyb2tlbl9wYWdlKGQsIF9tZm4obWZuKSwg
Z2ZuKSApCisgICAgICAgICAgICAgICAgaWYgKCB1bm1tYXBfYnJva2VuX3BhZ2UoZCwgbWZuLCBn
Zm4pICkKICAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAgIHByaW50aygiVW5t
YXAgYnJva2VuIG1lbW9yeSAlbHggZm9yIERPTSVkIGZhaWxlZFxuIiwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG1mbiwgZC0+ZG9tYWluX2lkKTsKKyAgICAgICAgICAgICAgICAgICAgcHJp
bnRrKCJVbm1hcCBicm9rZW4gbWVtb3J5ICUiUFJJX21mbiIgZm9yIERPTSVkIGZhaWxlZFxuIiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl94KG1mbiksIGQtPmRvbWFpbl9pZCk7CiAg
ICAgICAgICAgICAgICAgICAgIGdvdG8gdm1jZV9mYWlsZWQ7CiAgICAgICAgICAgICAgICAgfQog
CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyBiL3hlbi9jb21tb24vcGFnZV9h
bGxvYy5jCmluZGV4IDc4MjVmZDhjNDIuLjcwNzVlMDg0YjQgMTAwNjQ0Ci0tLSBhL3hlbi9jb21t
b24vcGFnZV9hbGxvYy5jCisrKyBiL3hlbi9jb21tb24vcGFnZV9hbGxvYy5jCkBAIC0xNTU2LDIz
ICsxNTU2LDIzIEBAIHN0YXRpYyBpbnQgcmVzZXJ2ZV9oZWFwX3BhZ2Uoc3RydWN0IHBhZ2VfaW5m
byAqcGcpCiAKIH0KIAotaW50IG9mZmxpbmVfcGFnZSh1bnNpZ25lZCBsb25nIG1mbiwgaW50IGJy
b2tlbiwgdWludDMyX3QgKnN0YXR1cykKK2ludCBvZmZsaW5lX3BhZ2UobWZuX3QgbWZuLCBpbnQg
YnJva2VuLCB1aW50MzJfdCAqc3RhdHVzKQogewogICAgIHVuc2lnbmVkIGxvbmcgb2xkX2luZm8g
PSAwOwogICAgIHN0cnVjdCBkb21haW4gKm93bmVyOwogICAgIHN0cnVjdCBwYWdlX2luZm8gKnBn
OwogCi0gICAgaWYgKCAhbWZuX3ZhbGlkKF9tZm4obWZuKSkgKQorICAgIGlmICggIW1mbl92YWxp
ZChtZm4pICkKICAgICB7CiAgICAgICAgIGRwcmludGsoWEVOTE9HX1dBUk5JTkcsCi0gICAgICAg
ICAgICAgICAgInRyeSB0byBvZmZsaW5lIHBhZ2Ugb3V0IG9mIHJhbmdlICVseFxuIiwgbWZuKTsK
KyAgICAgICAgICAgICAgICAidHJ5IHRvIG9mZmxpbmUgb3V0IG9mIHJhbmdlIHBhZ2UgJSJQUklf
bWZuIlxuIiwgbWZuX3gobWZuKSk7CiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogICAgIH0KIAog
ICAgICpzdGF0dXMgPSAwOwotICAgIHBnID0gbWZuX3RvX3BhZ2UoX21mbihtZm4pKTsKKyAgICBw
ZyA9IG1mbl90b19wYWdlKG1mbik7CiAKLSAgICBpZiAoIGlzX3hlbl9maXhlZF9tZm4obWZuKSAp
CisgICAgaWYgKCBpc194ZW5fZml4ZWRfbWZuKG1mbl94KG1mbikpICkKICAgICB7CiAgICAgICAg
ICpzdGF0dXMgPSBQR19PRkZMSU5FX1hFTlBBR0UgfCBQR19PRkZMSU5FX0ZBSUxFRCB8CiAgICAg
ICAgICAgKERPTUlEX1hFTiA8PCBQR19PRkZMSU5FX09XTkVSX1NISUZUKTsKQEAgLTE1ODMsNyAr
MTU4Myw3IEBAIGludCBvZmZsaW5lX3BhZ2UodW5zaWduZWQgbG9uZyBtZm4sIGludCBicm9rZW4s
IHVpbnQzMl90ICpzdGF0dXMpCiAgICAgICogTi5CLiB4ZW4ncyB0eHQgaW4geDg2XzY0IGlzIG1h
cmtlZCByZXNlcnZlZCBhbmQgaGFuZGxlZCBhbHJlYWR5LgogICAgICAqIEFsc28ga2V4ZWMgcmFu
Z2UgaXMgcmVzZXJ2ZWQuCiAgICAgICovCi0gICAgaWYgKCAhcGFnZV9pc19yYW1fdHlwZShtZm4s
IFJBTV9UWVBFX0NPTlZFTlRJT05BTCkgKQorICAgIGlmICggIXBhZ2VfaXNfcmFtX3R5cGUobWZu
X3gobWZuKSwgUkFNX1RZUEVfQ09OVkVOVElPTkFMKSApCiAgICAgewogICAgICAgICAqc3RhdHVz
ID0gUEdfT0ZGTElORV9GQUlMRUQgfCBQR19PRkZMSU5FX05PVF9DT05WX1JBTTsKICAgICAgICAg
cmV0dXJuIC1FSU5WQUw7CkBAIC0xNjY1LDE5ICsxNjY1LDE5IEBAIGludCBvZmZsaW5lX3BhZ2Uo
dW5zaWduZWQgbG9uZyBtZm4sIGludCBicm9rZW4sIHVpbnQzMl90ICpzdGF0dXMpCiAgKiAgIFRo
ZSBjYWxsZXIgc2hvdWxkIG1ha2Ugc3VyZSBlbmRfcGZuIDw9IG1heF9wYWdlLAogICogICBpZiBu
b3QsIGV4cGFuZF9wYWdlcygpIHNob3VsZCBiZSBjYWxsZWQgcHJpb3IgdG8gb25saW5lX3BhZ2Uo
KS4KICAqLwotdW5zaWduZWQgaW50IG9ubGluZV9wYWdlKHVuc2lnbmVkIGxvbmcgbWZuLCB1aW50
MzJfdCAqc3RhdHVzKQordW5zaWduZWQgaW50IG9ubGluZV9wYWdlKG1mbl90IG1mbiwgdWludDMy
X3QgKnN0YXR1cykKIHsKICAgICB1bnNpZ25lZCBsb25nIHgsIG54LCB5OwogICAgIHN0cnVjdCBw
YWdlX2luZm8gKnBnOwogICAgIGludCByZXQ7CiAKLSAgICBpZiAoICFtZm5fdmFsaWQoX21mbiht
Zm4pKSApCisgICAgaWYgKCAhbWZuX3ZhbGlkKG1mbikgKQogICAgIHsKICAgICAgICAgZHByaW50
ayhYRU5MT0dfV0FSTklORywgImNhbGwgZXhwYW5kX3BhZ2VzKCkgZmlyc3RcbiIpOwogICAgICAg
ICByZXR1cm4gLUVJTlZBTDsKICAgICB9CiAKLSAgICBwZyA9IG1mbl90b19wYWdlKF9tZm4obWZu
KSk7CisgICAgcGcgPSBtZm5fdG9fcGFnZShtZm4pOwogCiAgICAgc3Bpbl9sb2NrKCZoZWFwX2xv
Y2spOwogCkBAIC0xNzE4LDExICsxNzE4LDExIEBAIHVuc2lnbmVkIGludCBvbmxpbmVfcGFnZSh1
bnNpZ25lZCBsb25nIG1mbiwgdWludDMyX3QgKnN0YXR1cykKICAgICByZXR1cm4gcmV0OwogfQog
Ci1pbnQgcXVlcnlfcGFnZV9vZmZsaW5lKHVuc2lnbmVkIGxvbmcgbWZuLCB1aW50MzJfdCAqc3Rh
dHVzKQoraW50IHF1ZXJ5X3BhZ2Vfb2ZmbGluZShtZm5fdCBtZm4sIHVpbnQzMl90ICpzdGF0dXMp
CiB7CiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGc7CiAKLSAgICBpZiAoICFtZm5fdmFsaWQoX21m
bihtZm4pKSB8fCAhcGFnZV9pc19yYW1fdHlwZShtZm4sIFJBTV9UWVBFX0NPTlZFTlRJT05BTCkg
KQorICAgIGlmICggIW1mbl92YWxpZChtZm4pIHx8ICFwYWdlX2lzX3JhbV90eXBlKG1mbl94KG1m
biksIFJBTV9UWVBFX0NPTlZFTlRJT05BTCkgKQogICAgIHsKICAgICAgICAgZHByaW50ayhYRU5M
T0dfV0FSTklORywgImNhbGwgZXhwYW5kX3BhZ2VzKCkgZmlyc3RcbiIpOwogICAgICAgICByZXR1
cm4gLUVJTlZBTDsKQEAgLTE3MzEsNyArMTczMSw3IEBAIGludCBxdWVyeV9wYWdlX29mZmxpbmUo
dW5zaWduZWQgbG9uZyBtZm4sIHVpbnQzMl90ICpzdGF0dXMpCiAgICAgKnN0YXR1cyA9IDA7CiAg
ICAgc3Bpbl9sb2NrKCZoZWFwX2xvY2spOwogCi0gICAgcGcgPSBtZm5fdG9fcGFnZShfbWZuKG1m
bikpOworICAgIHBnID0gbWZuX3RvX3BhZ2UobWZuKTsKIAogICAgIGlmICggcGFnZV9zdGF0ZV9p
cyhwZywgb2ZmbGluaW5nKSApCiAgICAgICAgICpzdGF0dXMgfD0gUEdfT0ZGTElORV9TVEFUVVNf
T0ZGTElORV9QRU5ESU5HOwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zeXNjdGwuYyBiL3hlbi9j
b21tb24vc3lzY3RsLmMKaW5kZXggNzY1ZWZmZGU4ZC4uZmNmMmQyZmQ3YyAxMDA2NDQKLS0tIGEv
eGVuL2NvbW1vbi9zeXNjdGwuYworKysgYi94ZW4vY29tbW9uL3N5c2N0bC5jCkBAIC0xODUsNyAr
MTg1LDcgQEAgbG9uZyBkb19zeXNjdGwoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fc3lzY3Rs
X3QpIHVfc3lzY3RsKQogICAgIGNhc2UgWEVOX1NZU0NUTF9wYWdlX29mZmxpbmVfb3A6CiAgICAg
ewogICAgICAgICB1aW50MzJfdCAqc3RhdHVzLCAqcHRyOwotICAgICAgICB1bnNpZ25lZCBsb25n
IHBmbjsKKyAgICAgICAgbWZuX3QgbWZuOwogCiAgICAgICAgIHJldCA9IHhzbV9wYWdlX29mZmxp
bmUoWFNNX0hPT0ssIG9wLT51LnBhZ2Vfb2ZmbGluZS5jbWQpOwogICAgICAgICBpZiAoIHJldCAp
CkBAIC0yMDQsMjEgKzIwNCwyMSBAQCBsb25nIGRvX3N5c2N0bChYRU5fR1VFU1RfSEFORExFX1BB
UkFNKHhlbl9zeXNjdGxfdCkgdV9zeXNjdGwpCiAgICAgICAgIG1lbXNldChzdGF0dXMsIFBHX09G
RkxJTkVfSU5WQUxJRCwgc2l6ZW9mKHVpbnQzMl90KSAqCiAgICAgICAgICAgICAgICAgICAgICAg
KG9wLT51LnBhZ2Vfb2ZmbGluZS5lbmQgLSBvcC0+dS5wYWdlX29mZmxpbmUuc3RhcnQgKyAxKSk7
CiAKLSAgICAgICAgZm9yICggcGZuID0gb3AtPnUucGFnZV9vZmZsaW5lLnN0YXJ0OwotICAgICAg
ICAgICAgICBwZm4gPD0gb3AtPnUucGFnZV9vZmZsaW5lLmVuZDsKLSAgICAgICAgICAgICAgcGZu
ICsrICkKKyAgICAgICAgZm9yICggbWZuID0gX21mbihvcC0+dS5wYWdlX29mZmxpbmUuc3RhcnQp
OworICAgICAgICAgICAgICBtZm5feChtZm4pIDw9IG9wLT51LnBhZ2Vfb2ZmbGluZS5lbmQ7Cisg
ICAgICAgICAgICAgIG1mbiA9IG1mbl9hZGQobWZuLCAxKSApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIHN3aXRjaCAoIG9wLT51LnBhZ2Vfb2ZmbGluZS5jbWQgKQogICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgIC8qIFNoYWxsIHJldmVydCBoZXIgaWYgZmFpbGVkLCBvciBsZWF2ZSBjYWxs
ZXIgZG8gaXQ/ICovCiAgICAgICAgICAgICAgICAgY2FzZSBzeXNjdGxfcGFnZV9vZmZsaW5lOgot
ICAgICAgICAgICAgICAgICAgICByZXQgPSBvZmZsaW5lX3BhZ2UocGZuLCAwLCBwdHIrKyk7Cisg
ICAgICAgICAgICAgICAgICAgIHJldCA9IG9mZmxpbmVfcGFnZShtZm4sIDAsIHB0cisrKTsKICAg
ICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgY2FzZSBzeXNjdGxfcGFn
ZV9vbmxpbmU6Ci0gICAgICAgICAgICAgICAgICAgIHJldCA9IG9ubGluZV9wYWdlKHBmbiwgcHRy
KyspOworICAgICAgICAgICAgICAgICAgICByZXQgPSBvbmxpbmVfcGFnZShtZm4sIHB0cisrKTsK
ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgY2FzZSBzeXNjdGxf
cXVlcnlfcGFnZV9vZmZsaW5lOgotICAgICAgICAgICAgICAgICAgICByZXQgPSBxdWVyeV9wYWdl
X29mZmxpbmUocGZuLCBwdHIrKyk7CisgICAgICAgICAgICAgICAgICAgIHJldCA9IHF1ZXJ5X3Bh
Z2Vfb2ZmbGluZShtZm4sIHB0cisrKTsKICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg
ICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9tbS5oIGIveGVuL2luY2x1ZGUveGVuL21tLmgK
aW5kZXggN2ZjMzAzOTU5My4uMTk2Y2U5ZmNkYSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVu
L21tLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL21tLmgKQEAgLTIwNiw5ICsyMDYsOSBAQCB1bnNp
Z25lZCBsb25nIGF2YWlsX2RvbWhlYXBfcGFnZXModm9pZCk7CiB1bnNpZ25lZCBsb25nIGF2YWls
X25vZGVfaGVhcF9wYWdlcyh1bnNpZ25lZCBpbnQpOwogI2RlZmluZSBhbGxvY19kb21oZWFwX3Bh
Z2UoZCxmKSAoYWxsb2NfZG9taGVhcF9wYWdlcyhkLDAsZikpCiAjZGVmaW5lIGZyZWVfZG9taGVh
cF9wYWdlKHApICAoZnJlZV9kb21oZWFwX3BhZ2VzKHAsMCkpCi11bnNpZ25lZCBpbnQgb25saW5l
X3BhZ2UodW5zaWduZWQgbG9uZyBtZm4sIHVpbnQzMl90ICpzdGF0dXMpOwotaW50IG9mZmxpbmVf
cGFnZSh1bnNpZ25lZCBsb25nIG1mbiwgaW50IGJyb2tlbiwgdWludDMyX3QgKnN0YXR1cyk7Ci1p
bnQgcXVlcnlfcGFnZV9vZmZsaW5lKHVuc2lnbmVkIGxvbmcgbWZuLCB1aW50MzJfdCAqc3RhdHVz
KTsKK3Vuc2lnbmVkIGludCBvbmxpbmVfcGFnZShtZm5fdCBtZm4sIHVpbnQzMl90ICpzdGF0dXMp
OworaW50IG9mZmxpbmVfcGFnZShtZm5fdCBtZm4sIGludCBicm9rZW4sIHVpbnQzMl90ICpzdGF0
dXMpOworaW50IHF1ZXJ5X3BhZ2Vfb2ZmbGluZShtZm5fdCBtZm4sIHVpbnQzMl90ICpzdGF0dXMp
OwogCiB2b2lkIGhlYXBfaW5pdF9sYXRlKHZvaWQpOwogCi0tIAoyLjExLjAKCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBs
aXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2pl
Y3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

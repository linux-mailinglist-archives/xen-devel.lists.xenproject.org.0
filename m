Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 2080CCE71B
	for <lists+xen-devel@lfdr.de>; Mon,  7 Oct 2019 17:16:55 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iHUig-0007Tn-Kt; Mon, 07 Oct 2019 15:14:42 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=0SFq=YA=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iHUif-0007TH-PO
 for xen-devel@lists.xenproject.org; Mon, 07 Oct 2019 15:14:41 +0000
X-Inumbo-ID: 0903c88c-e915-11e9-8c93-bc764e2007e4
Received: from mail-qk1-x741.google.com (unknown [2607:f8b0:4864:20::741])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 0903c88c-e915-11e9-8c93-bc764e2007e4;
 Mon, 07 Oct 2019 15:13:36 +0000 (UTC)
Received: by mail-qk1-x741.google.com with SMTP id y144so12884170qkb.7
 for <xen-devel@lists.xenproject.org>; Mon, 07 Oct 2019 08:13:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=2UsVtpDQx/GH4g6WuhNNT23rnCC0Le6n0pIDIcnnL7E=;
 b=JPttCl18A2aeL7ecgvuDjTs+fu/4pjUneLYmn0jRfWopDZiJRP5w4xyQukEZZvRZkg
 rwl5EluI9NLPOdjOYu361X8No0S3CgzS1judKDgjX1Fm5gl3fJTPmCqzAsxBnXRVO6vt
 BP0KzPwxHSTrL3NmqZwEob1OxfYm8phF93Fs91WW0A5pKXRJkbFELmRG/YvZTewQgiFg
 wBHXjjrOBozpIZV8LdRoYly8hxPL8FIgTmqWlWvb5AgiT4RjDge0twfhr6q0QEBnyyCf
 tc7ibV7Sm6JoIe+dZaMDpjKtM5x5rwIHLW+vpOdzeRQU4O5Qc4b+zy0/2lsmfyQnHTvq
 vYXA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=2UsVtpDQx/GH4g6WuhNNT23rnCC0Le6n0pIDIcnnL7E=;
 b=rZc0Ss7f7iibdITorRVhkQvJWognPuXlcfjIaMKdht5iWVDssIU8x4ad25JGOrGq9g
 BJlVPZRhRWr7Jp6SJem5C7/1IutwiPeSTvpguOEolG2enfO6kcDfAfBtxv36Wj9Tv7/k
 eopVXAcOJ3WGboMI3MmwTnvFRl+yUGDpdFPZI0NTvZA0sBjXeDiT3R0KuoKEfyl/RSkw
 W4OOfy1O5sCqEvieNnBa3Lc65J0uS2r0CjoT4dsCx/6pMdOVljJvs86wiEU1ULrtu9e0
 mJpj3udBls8NXgd4xXLBteUBLq5Xx+OMSVh73YCDi+1iFdzS5JVs8osHBYIKCQinvWH7
 Mqxg==
X-Gm-Message-State: APjAAAWq1Ju+dYbxaujZdjGSkL2B7k0DWZzQ466OntKmH4KbtZsDkUil
 0CXp0GiKIqZiiPIFw+2xriG0FMxH
X-Google-Smtp-Source: APXvYqwwXRCa1SmAcZN/CpupkYP3KVbGMdJVKIo297Fs/nk4B+hNA3vMU16k5gcZpJBARd3PT+xQYA==
X-Received: by 2002:a37:a709:: with SMTP id q9mr23157083qke.135.1570461215790; 
 Mon, 07 Oct 2019 08:13:35 -0700 (PDT)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id c185sm8354313qkg.74.2019.10.07.08.13.34
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 07 Oct 2019 08:13:35 -0700 (PDT)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  7 Oct 2019 11:13:04 -0400
Message-Id: <1e92395f2f4ef59a1a4e9f3c6b926182ba113653.1570456846.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1570456846.git.rosbrookn@ainfosec.com>
References: <cover.1570456846.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 17/24] golang/xenlight: implement keyed union C
 to Go marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClN3aXRjaCBvdmVy
IHVuaW9uIGtleSB0byBkZXRlcm1pbmUgaG93IHRvIHBvcHVsYXRlICd1bmlvbicgaW4gR28gc3Ry
dWN0LgoKU2luY2UgdGhlIHVuaW9ucyBvZiBDIHR5cGVzIGNhbm5vdCBiZSBkaXJlY3RseSBhY2Nl
c3NlZCwgYWRkIEMgc3RydWN0cyBpbgpjZ28gcHJlYW1ibGUgdG8gYXNzaXN0IGluIG1hcnNoYWxp
bmcga2V5ZWQgdW5pb25zLiBUaGlzIGFsbG93cyB0aGUgQwp0eXBlIGRlZmluZWQgaW4gdGhlIHBy
ZWFtYmxlIHRvIGJlIHBvcHVsYXRlZCBmaXJzdCwgYW5kIHRoZW4gYWNjZXNzZWQKZGlyZWN0bHkg
dG8gcG9wdWxhdGUgdGhlIEdvIHN0cnVjdC4KClNpZ25lZC1vZmYtYnk6IE5pY2sgUm9zYnJvb2sg
PHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQpDYzogR2VvcmdlIER1bmxhcCA8Z2VvcmdlLmR1
bmxhcEBjaXRyaXguY29tPgpDYzogSWFuIEphY2tzb24gPGlhbi5qYWNrc29uQGV1LmNpdHJpeC5j
b20+CkNjOiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgoKIHRvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5n
b3R5cGVzLnB5ICAgICAgIHwgMTM2ICsrKysrKy0KIHRvb2xzL2dvbGFuZy94ZW5saWdodC94ZW5s
aWdodF9oZWxwZXJzLmdvIHwgNDQwICsrKysrKysrKysrKysrKysrKysrKysKIDIgZmlsZXMgY2hh
bmdlZCwgNTc1IGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1naXQgYS90b29s
cy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9n
ZW5nb3R5cGVzLnB5CmluZGV4IDc1ZGNkMDE3MjQuLmVjZWNhYWZkNzIgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5s
aWdodC9nZW5nb3R5cGVzLnB5CkBAIC0yOCw2ICsyOCwxNCBAQCBnb19idWlsdGluX3R5cGVzID0g
Wydib29sJywgJ3N0cmluZycsICdpbnQnLCAnYnl0ZScsCiAjIGFmdGVyIGEgc3RydWN0IGRlZmlu
aXRpb24uCiB0eXBlX2V4dHJhcyA9IFtdCiAKKyMgY2dvIHByZWFtYmxlIGZvciB4ZW5saWdodF9o
ZWxwZXJzLmdvLCBjcmVhdGVkIGR1cmluZyB0eXBlIGdlbmVyYXRpb24gYW5kCisjIHdyaXR0ZW4g
bGF0ZXIuCitjZ29faGVscGVyc19wcmVhbWJsZSA9IFtdCisKKyMgTGlzdCBvZiBzdHJpbmdzIHRo
YXQgbmVlZCB0byBiZSB3cml0dGVuIHRvIGEgZmlsZQorIyBhZnRlciBhIGhlbHBlciBmdW5jIGRl
ZmluaXRpb24uCitoZWxwZXJfZXh0cmFzID0gW10KKwogZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5l
cmF0ZV90eXBlcyhwYXRoID0gTm9uZSwgdHlwZXMgPSBOb25lLCBjb21tZW50ID0gTm9uZSk6CiAg
ICAgIiIiCiAgICAgR2VuZXJhdGUgYSAuZ28gZmlsZSAoeGVubGlnaHRfdHlwZXMuZ28gYnkgZGVm
YXVsdCkKQEAgLTE1OSw2ICsxNjcsOCBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmluZV91bmlv
bih0eSA9IE5vbmUsIHN0cnVjdG5hbWUgPSAnJyk6CiAgICAgICAgIHMgPSB4ZW5saWdodF9nb2xh
bmdfZGVmaW5lX3N0cnVjdChmLnR5cGUsIHR5cGVuYW1lPW5hbWUpCiAgICAgICAgIHR5cGVfZXh0
cmFzLmFwcGVuZChzKQogCisgICAgICAgIHhlbmxpZ2h0X2dvbGFuZ191bmlvbl9jZ29fcHJlYW1i
bGUoZi50eXBlLCBuYW1lPW5hbWUpCisKICAgICAgICAgIyBEZWZpbmUgZnVuY3Rpb24gdG8gaW1w
bGVtZW50ICd1bmlvbicgaW50ZXJmYWNlCiAgICAgICAgIG5hbWUgPSB4ZW5saWdodF9nb2xhbmdf
Zm10X25hbWUobmFtZSkKICAgICAgICAgcyA9ICdmdW5jICh4IHt9KSBpc3t9KCl7e319XG4nLmZv
cm1hdChuYW1lLCBpbnRlcmZhY2VfbmFtZSkKQEAgLTE3NCw2ICsxODQsMTggQEAgZGVmIHhlbmxp
Z2h0X2dvbGFuZ19kZWZpbmVfdW5pb24odHkgPSBOb25lLCBzdHJ1Y3RuYW1lID0gJycpOgogCiAg
ICAgcmV0dXJuIHMKIAorZGVmIHhlbmxpZ2h0X2dvbGFuZ191bmlvbl9jZ29fcHJlYW1ibGUodHkg
PSBOb25lLCBuYW1lID0gJycpOgorICAgIHMgPSAnJworCisgICAgcyArPSAndHlwZWRlZiBzdHJ1
Y3Qge30ge3tcbicuZm9ybWF0KG5hbWUpCisKKyAgICBmb3IgZiBpbiB0eS5maWVsZHM6CisgICAg
ICAgIHMgKz0gJ1x0e30ge307XG4nLmZvcm1hdChmLnR5cGUudHlwZW5hbWUsIGYubmFtZSkKKwor
ICAgIHMgKz0gJ319IHt9O1xuJy5mb3JtYXQobmFtZSkKKworICAgIGNnb19oZWxwZXJzX3ByZWFt
YmxlLmFwcGVuZChzKQorCiBkZWYgeGVubGlnaHRfZ29sYW5nX2dlbmVyYXRlX2hlbHBlcnMocGF0
aCA9IE5vbmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAgICIiIgogICAgIEdl
bmVyYXRlIGEgLmdvIGZpbGUgKHhlbmxpZ2h0X2hlbHBlcnMuZ28gYnkgZGVmYXVsdCkKQEAgLTE4
Nyw2ICsyMDksNyBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2dlbmVyYXRlX2hlbHBlcnMocGF0aCA9
IE5vbmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAgICAgICBpZiBjb21tZW50
IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgZi53cml0ZShjb21tZW50KQogICAgICAgICBmLndy
aXRlKCdwYWNrYWdlIHhlbmxpZ2h0XG4nKQorICAgICAgICBmLndyaXRlKCdpbXBvcnQgKFxuInVu
c2FmZSJcbiJlcnJvcnMiXG4iZm10IlxuKVxuJykKIAogICAgICAgICAjIENnbyBwcmVhbWJsZQog
ICAgICAgICBmLndyaXRlKCcvKlxuJykKQEAgLTE5NSw2ICsyMTgsMTAgQEAgZGVmIHhlbmxpZ2h0
X2dvbGFuZ19nZW5lcmF0ZV9oZWxwZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5vbmUsIGNvbW1l
bnQgPSBOb25lKToKICAgICAgICAgZi53cml0ZSgnI2luY2x1ZGUgPGxpYnhsLmg+XG4nKQogICAg
ICAgICBmLndyaXRlKCdcbicpCiAKKyAgICAgICAgZm9yIHMgaW4gY2dvX2hlbHBlcnNfcHJlYW1i
bGU6CisgICAgICAgICAgICBmLndyaXRlKHMpCisgICAgICAgICAgICBmLndyaXRlKCdcbicpCisK
ICAgICAgICAgZi53cml0ZSgnKi9cbmltcG9ydCAiQyJcbicpCiAKICAgICAgICAgZm9yIHR5IGlu
IHR5cGVzOgpAQCAtMjA0LDYgKzIzMSwxMiBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2dlbmVyYXRl
X2hlbHBlcnMocGF0aCA9IE5vbmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAg
ICAgICAgICAgZi53cml0ZSh4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSkpCiAgICAg
ICAgICAgICBmLndyaXRlKCdcbicpCiAKKyAgICAgICAgICAgIGZvciBleHRyYSBpbiBoZWxwZXJf
ZXh0cmFzOgorICAgICAgICAgICAgICAgIGYud3JpdGUoZXh0cmEpCisgICAgICAgICAgICAgICAg
Zi53cml0ZSgnXG4nKQorCisgICAgICAgICAgICBkZWwgaGVscGVyX2V4dHJhc1s6XQorCiAgICAg
Z29fZm10KHBhdGgpCiAKIGRlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSA9IE5v
bmUsIHR5cGVuYW1lID0gTm9uZSwgbmVzdGVkID0gRmFsc2UpOgpAQCAtMjc1LDcgKzMwOCw3IEBA
IGRlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSA9IE5vbmUsIHR5cGVuYW1lID0g
Tm9uZSwgbmVzdGVkID0gRmFsc2UpOgogICAgICAgICAgICAgcyArPSB4ZW5saWdodF9nb2xhbmdf
ZGVmaW5lX2Zyb21fQyhmLnR5cGUsIHR5cGVuYW1lPWYubmFtZSwgbmVzdGVkPVRydWUpCiAKICAg
ICAgICAgZWxpZiBpc2luc3RhbmNlKGYudHlwZSwgaWRsLktleWVkVW5pb24pOgotICAgICAgICAg
ICAgcGFzcworICAgICAgICAgICAgcyArPSB4ZW5saWdodF9nb2xhbmdfdW5pb25fZnJvbV9DKGYu
dHlwZSwgZi5uYW1lLCB0eS50eXBlbmFtZSkKIAogICAgICAgICBlbHNlOgogICAgICAgICAgICAg
cmFpc2UgRXhjZXB0aW9uKCd0eXBlIHt9IG5vdCBzdXBwb3J0ZWQnLmZvcm1hdChmLnR5cGUpKQpA
QCAtMjg2LDYgKzMxOSwxMDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5
ID0gTm9uZSwgdHlwZW5hbWUgPSBOb25lLCBuZXN0ZWQgPSBGYWxzZSk6CiAKICAgICByZXR1cm4g
cwogCitkZWYgeGVubGlnaHRfZ29sYW5nX3VuaW9uX2Zyb21fQyh0eSA9IE5vbmUsIHVuaW9uX25h
bWUgPSAnJywgc3RydWN0X25hbWUgPSAnJyk6CisgICAga2V5bmFtZSAgID0gdHkua2V5dmFyLm5h
bWUKKyAgICBnb2tleW5hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUoa2V5bmFtZSkKKyAg
ICBrZXl0eXBlICAgPSB0eS5rZXl2YXIudHlwZS50eXBlbmFtZQorICAgIGdva2V5dHlwZSA9IHhl
bmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShrZXl0eXBlKQorCisgICAgaW50ZXJmYWNlX25hbWUgPSAn
e31fe31fdW5pb24nLmZvcm1hdChzdHJ1Y3RfbmFtZSwga2V5bmFtZSkKKyAgICBpbnRlcmZhY2Vf
bmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShpbnRlcmZhY2VfbmFtZSwgZXhwb3J0ZWQ9
RmFsc2UpCisKKyAgICBjZ29fa2V5bmFtZSA9IGtleW5hbWUKKyAgICBpZiBjZ29fa2V5bmFtZSBp
biBnb19rZXl3b3JkczoKKyAgICAgICAgY2dvX2tleW5hbWUgPSAnXycgKyBjZ29fa2V5bmFtZQor
CisgICAgY2FzZXMgPSB7fQorCisgICAgZm9yIGYgaW4gdHkuZmllbGRzOgorICAgICAgICB2YWwg
PSAne31fe30nLmZvcm1hdChrZXl0eXBlLCBmLm5hbWUpCisgICAgICAgIHZhbCA9IHhlbmxpZ2h0
X2dvbGFuZ19mbXRfbmFtZSh2YWwpCisKKyAgICAgICAgIyBBZGQgdG8gbGlzdCBvZiBjYXNlcyB0
byBtYWtlIGZvciB0aGUgc3dpdGNoCisgICAgICAgICMgc3RhdGVtZW50IGJlbG93LgorICAgICAg
ICBpZiBmLnR5cGUgaXMgTm9uZToKKyAgICAgICAgICAgIGNvbnRpbnVlCisKKyAgICAgICAgY2Fz
ZXNbZi5uYW1lXSA9IHZhbAorCisgICAgICAgICMgRGVmaW5lIGZyb21DIGZ1bmMgZm9yICd1bmlv
bicgc3RydWN0LgorICAgICAgICB0eXBlbmFtZSAgID0gJ3t9X3t9X3VuaW9uX3t9Jy5mb3JtYXQo
c3RydWN0X25hbWUsa2V5bmFtZSxmLm5hbWUpCisgICAgICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdo
dF9nb2xhbmdfZm10X25hbWUodHlwZW5hbWUpCisKKyAgICAgICAgIyBEZWZpbmUgdGhlIGZ1bmN0
aW9uIGhlcmUuIFRoZSBjYXNlcyBmb3Iga2V5ZWQgdW5pb25zIGFyZSBhIGxpdHRsZQorICAgICAg
ICAjIGRpZmZlcmVudC4KKyAgICAgICAgcyA9ICdmdW5jICh4ICp7fSkgZnJvbUMoeGMgKkMue30p
IGVycm9yIHt7XG4nLmZvcm1hdChnb3R5cGVuYW1lLHN0cnVjdF9uYW1lKQorICAgICAgICBzICs9
ICdpZiB7fSh4Yy57fSkgIT0ge30ge3tcbicuZm9ybWF0KGdva2V5dHlwZSxjZ29fa2V5bmFtZSx2
YWwpCisgICAgICAgIGVycl9zdHJpbmcgPSAnImV4cGVjdGVkIHVuaW9uIGtleSB7fSInLmZvcm1h
dCh2YWwpCisgICAgICAgIHMgKz0gJ3JldHVybiBlcnJvcnMuTmV3KHt9KVxuJy5mb3JtYXQoZXJy
X3N0cmluZykKKyAgICAgICAgcyArPSAnfVxuXG4nCisgICAgICAgIHMgKz0gJ3RtcCA6PSAoKkMu
e30pKHVuc2FmZS5Qb2ludGVyKCZ4Yy57fVswXSkpXG4nLmZvcm1hdCh0eXBlbmFtZSx1bmlvbl9u
YW1lKQorCisgICAgICAgIHMgKz0geGVubGlnaHRfZ29sYW5nX3VuaW9uX2ZpZWxkc19mcm9tX0Mo
Zi50eXBlKQorICAgICAgICBzICs9ICdyZXR1cm4gbmlsXG4nCisgICAgICAgIHMgKz0gJ31cbicK
KworICAgICAgICBoZWxwZXJfZXh0cmFzLmFwcGVuZChzKQorCisgICAgcyA9ICd4Lnt9ID0ge30o
eGMue30pXG4nLmZvcm1hdChnb2tleW5hbWUsZ29rZXl0eXBlLGNnb19rZXluYW1lKQorICAgIHMg
Kz0gJ3N3aXRjaCB4Lnt9e3tcbicuZm9ybWF0KGdva2V5bmFtZSkKKworICAgICMgQ3JlYXRlIHN3
aXRjaCBzdGF0ZW1lbnQgdG8gZGV0ZXJtaW5lIHdoaWNoICd1bmlvbiBlbGVtZW50JworICAgICMg
dG8gcG9wdWxhdGUgaW4gdGhlIEdvIHN0cnVjdC4KKyAgICBmb3IgY2FzZV9uYW1lLCBjYXNlX3Zh
bCBpbiBjYXNlcy5pdGVtcygpOgorICAgICAgICBzICs9ICdjYXNlIHt9OlxuJy5mb3JtYXQoY2Fz
ZV92YWwpCisKKyAgICAgICAgZ290eXBlID0gJ3t9X3t9X3VuaW9uX3t9Jy5mb3JtYXQoc3RydWN0
X25hbWUsa2V5bmFtZSxjYXNlX25hbWUpCisgICAgICAgIGdvdHlwZSA9IHhlbmxpZ2h0X2dvbGFu
Z19mbXRfbmFtZShnb3R5cGUpCisgICAgICAgIGdvbmFtZSA9ICd7fV97fScuZm9ybWF0KGtleW5h
bWUsY2FzZV9uYW1lKQorICAgICAgICBnb25hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUo
Z29uYW1lLGV4cG9ydGVkPUZhbHNlKQorCisgICAgICAgIHMgKz0gJ3ZhciB7fSB7fVxuJy5mb3Jt
YXQoZ29uYW1lLCBnb3R5cGUpCisgICAgICAgIHMgKz0gJ2lmIGVyciA6PSB7fS5mcm9tQyh4Yyk7
Jy5mb3JtYXQoZ29uYW1lKQorICAgICAgICBzICs9ICdlcnIgIT0gbmlsIHtcbiByZXR1cm4gZXJy
IFxufVxuJworCisgICAgICAgIGZpZWxkX25hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUo
J3t9X3VuaW9uJy5mb3JtYXQoa2V5bmFtZSkpCisgICAgICAgIHMgKz0gJ3gue30gPSB7fVxuJy5m
b3JtYXQoZmllbGRfbmFtZSwgZ29uYW1lKQorCisgICAgIyBFbmQgc3dpdGNoIHN0YXRlbWVudAor
ICAgIHMgKz0gJ2RlZmF1bHQ6XG4nCisgICAgZXJyX3N0cmluZyA9ICciaW52YWxpZCB1bmlvbiBr
ZXkgXCcldlwnIiwgeC57fScuZm9ybWF0KGdva2V5bmFtZSkKKyAgICBzICs9ICdyZXR1cm4gZm10
LkVycm9yZih7fSknLmZvcm1hdChlcnJfc3RyaW5nKQorICAgIHMgKz0gJ31cbicKKworICAgIHJl
dHVybiBzCisKK2RlZiB4ZW5saWdodF9nb2xhbmdfdW5pb25fZmllbGRzX2Zyb21fQyh0eSA9IE5v
bmUpOgorICAgIHMgPSAnJworCisgICAgZm9yIGYgaW4gdHkuZmllbGRzOgorICAgICAgICBnb3R5
cGVuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGYudHlwZS50eXBlbmFtZSkKKyAgICAg
ICAgY3R5cGVuYW1lICA9IGYudHlwZS50eXBlbmFtZQorICAgICAgICBnb2ZuYW1lICAgID0geGVu
bGlnaHRfZ29sYW5nX2ZtdF9uYW1lKGYubmFtZSkKKyAgICAgICAgY2ZuYW1lICAgICA9IGYubmFt
ZQorCisgICAgICAgIGlzX2Nhc3RhYmxlID0gKGYudHlwZS5qc29uX3BhcnNlX3R5cGUgPT0gJ0pT
T05fSU5URUdFUicgb3IKKyAgICAgICAgICAgICAgICAgICAgICAgaXNpbnN0YW5jZShmLnR5cGUs
IGlkbC5FbnVtZXJhdGlvbikgb3IKKyAgICAgICAgICAgICAgICAgICAgICAgZ290eXBlbmFtZSBp
biBnb19idWlsdGluX3R5cGVzKQorCisgICAgICAgIGlmIG5vdCBpc19jYXN0YWJsZToKKyAgICAg
ICAgICAgIHMgKz0gJ2lmIGVyciA6PSB4Lnt9LmZyb21DKCZ0bXAue30pOycuZm9ybWF0KGdvZm5h
bWUsY2ZuYW1lKQorICAgICAgICAgICAgcyArPSAnZXJyICE9IG5pbCB7XG4gcmV0dXJuIGVyciBc
bn1cbicKKworICAgICAgICAjIFdlIGp1c3QgZGlkIGFuIHVuc2FmZS5Qb2ludGVyIGNhc3QgZnJv
bSBbXWJ5dGUgdG8gdGhlICd1bmlvbicgdHlwZQorICAgICAgICAjIHN0cnVjdCwgc28gd2UgbmVl
ZCB0byBtYWtlIHN1cmUgdGhhdCBhbnkgc3RyaW5nIGZpZWxkcyBhcmUgYWN0dWFsbHkKKyAgICAg
ICAgIyBjb252ZXJ0ZWQgcHJvcGVybHkuCisgICAgICAgIGVsaWYgZ290eXBlbmFtZSA9PSAnc3Ry
aW5nJzoKKyAgICAgICAgICAgIHMgKz0gJ3gue30gPSBDLkdvU3RyaW5nKHRtcC57fSlcbicuZm9y
bWF0KGdvZm5hbWUsY2ZuYW1lKQorCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBzICs9ICd4
Lnt9ID0ge30odG1wLnt9KVxuJy5mb3JtYXQoZ29mbmFtZSxnb3R5cGVuYW1lLGNmbmFtZSkKKwor
ICAgIHJldHVybiBzCisKIGRlZiB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUobmFtZSwgZXhwb3J0
ZWQgPSBUcnVlKToKICAgICAiIiIKICAgICBUYWtlIGEgZ2l2ZW4gdHlwZSBuYW1lIGFuZCByZXR1
cm4gYW4KZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC94ZW5saWdodF9oZWxwZXJz
LmdvIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hlbmxpZ2h0X2hlbHBlcnMuZ28KaW5kZXggNGVj
ZTkwZGM2Yi4uYjhhYmVmODA2OCAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hl
bmxpZ2h0X2hlbHBlcnMuZ28KKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hlbmxpZ2h0X2hl
bHBlcnMuZ28KQEAgLTUsMTEgKzUsMTIyIEBACiAvLwogcGFja2FnZSB4ZW5saWdodAogCitpbXBv
cnQgKAorCSJlcnJvcnMiCisJImZtdCIKKwkidW5zYWZlIgorKQorCiAvKgogI2NnbyBMREZMQUdT
OiAtbHhlbmxpZ2h0CiAjaW5jbHVkZSA8c3RkbGliLmg+CiAjaW5jbHVkZSA8bGlieGwuaD4KIAor
dHlwZWRlZiBzdHJ1Y3QgbGlieGxfY2hhbm5lbGluZm9fY29ubmVjdGlvbl91bmlvbl9wdHkgewor
CWNoYXIgKiBwYXRoOworfSBsaWJ4bF9jaGFubmVsaW5mb19jb25uZWN0aW9uX3VuaW9uX3B0eTsK
KwordHlwZWRlZiBzdHJ1Y3QgbGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9odm0g
eworCWNoYXIgKiBmaXJtd2FyZTsKKwlsaWJ4bF9iaW9zX3R5cGUgYmlvczsKKwlsaWJ4bF9kZWZi
b29sIHBhZTsKKwlsaWJ4bF9kZWZib29sIGFwaWM7CisJbGlieGxfZGVmYm9vbCBhY3BpOworCWxp
YnhsX2RlZmJvb2wgYWNwaV9zMzsKKwlsaWJ4bF9kZWZib29sIGFjcGlfczQ7CisJbGlieGxfZGVm
Ym9vbCBhY3BpX2xhcHRvcF9zbGF0ZTsKKwlsaWJ4bF9kZWZib29sIG54OworCWxpYnhsX2RlZmJv
b2wgdmlyaWRpYW47CisJbGlieGxfYml0bWFwIHZpcmlkaWFuX2VuYWJsZTsKKwlsaWJ4bF9iaXRt
YXAgdmlyaWRpYW5fZGlzYWJsZTsKKwljaGFyICogdGltZW9mZnNldDsKKwlsaWJ4bF9kZWZib29s
IGhwZXQ7CisJbGlieGxfZGVmYm9vbCB2cHRfYWxpZ247CisJdWludDY0X3QgbW1pb19ob2xlX21l
bWtiOworCWxpYnhsX3RpbWVyX21vZGUgdGltZXJfbW9kZTsKKwlsaWJ4bF9kZWZib29sIG5lc3Rl
ZF9odm07CisJbGlieGxfZGVmYm9vbCBhbHRwMm07CisJY2hhciAqIHN5c3RlbV9maXJtd2FyZTsK
KwljaGFyICogc21iaW9zX2Zpcm13YXJlOworCWNoYXIgKiBhY3BpX2Zpcm13YXJlOworCWxpYnhs
X2hkdHlwZSBoZHR5cGU7CisJbGlieGxfZGVmYm9vbCBub2dyYXBoaWM7CisJbGlieGxfdmdhX2lu
dGVyZmFjZV9pbmZvIHZnYTsKKwlsaWJ4bF92bmNfaW5mbyB2bmM7CisJY2hhciAqIGtleW1hcDsK
KwlsaWJ4bF9zZGxfaW5mbyBzZGw7CisJbGlieGxfc3BpY2VfaW5mbyBzcGljZTsKKwlsaWJ4bF9k
ZWZib29sIGdmeF9wYXNzdGhydTsKKwlsaWJ4bF9nZnhfcGFzc3RocnVfa2luZCBnZnhfcGFzc3Ro
cnVfa2luZDsKKwljaGFyICogc2VyaWFsOworCWNoYXIgKiBib290OworCWxpYnhsX2RlZmJvb2wg
dXNiOworCWludCB1c2J2ZXJzaW9uOworCWNoYXIgKiB1c2JkZXZpY2U7CisJbGlieGxfZGVmYm9v
bCB2a2JfZGV2aWNlOworCWNoYXIgKiBzb3VuZGh3OworCWxpYnhsX2RlZmJvb2wgeGVuX3BsYXRm
b3JtX3BjaTsKKwlsaWJ4bF9zdHJpbmdfbGlzdCB1c2JkZXZpY2VfbGlzdDsKKwlsaWJ4bF92ZW5k
b3JfZGV2aWNlIHZlbmRvcl9kZXZpY2U7CisJbGlieGxfbXNfdm1fZ2VuaWQgbXNfdm1fZ2VuaWQ7
CisJbGlieGxfc3RyaW5nX2xpc3Qgc2VyaWFsX2xpc3Q7CisJbGlieGxfcmRtX3Jlc2VydmUgcmRt
OworCXVpbnQ2NF90IHJkbV9tZW1fYm91bmRhcnlfbWVta2I7CisJdWludDY0X3QgbWNhX2NhcHM7
Cit9IGxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5pb25faHZtOworCit0eXBlZGVmIHN0
cnVjdCBsaWJ4bF9kb21haW5fYnVpbGRfaW5mb190eXBlX3VuaW9uX3B2IHsKKwljaGFyICoga2Vy
bmVsOworCXVpbnQ2NF90IHNsYWNrX21lbWtiOworCWNoYXIgKiBib290bG9hZGVyOworCWxpYnhs
X3N0cmluZ19saXN0IGJvb3Rsb2FkZXJfYXJnczsKKwljaGFyICogY21kbGluZTsKKwljaGFyICog
cmFtZGlzazsKKwljaGFyICogZmVhdHVyZXM7CisJbGlieGxfZGVmYm9vbCBlODIwX2hvc3Q7Cit9
IGxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5pb25fcHY7CisKK3R5cGVkZWYgc3RydWN0
IGxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5pb25fcHZoIHsKKwlsaWJ4bF9kZWZib29s
IHB2c2hpbTsKKwljaGFyICogcHZzaGltX3BhdGg7CisJY2hhciAqIHB2c2hpbV9jbWRsaW5lOwor
CWNoYXIgKiBwdnNoaW1fZXh0cmE7Cit9IGxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5p
b25fcHZoOworCit0eXBlZGVmIHN0cnVjdCBsaWJ4bF9kZXZpY2VfdXNiZGV2X3R5cGVfdW5pb25f
aG9zdGRldiB7CisJdWludDhfdCBob3N0YnVzOworCXVpbnQ4X3QgaG9zdGFkZHI7Cit9IGxpYnhs
X2RldmljZV91c2JkZXZfdHlwZV91bmlvbl9ob3N0ZGV2OworCit0eXBlZGVmIHN0cnVjdCBsaWJ4
bF9kZXZpY2VfY2hhbm5lbF9jb25uZWN0aW9uX3VuaW9uX3NvY2tldCB7CisJY2hhciAqIHBhdGg7
Cit9IGxpYnhsX2RldmljZV9jaGFubmVsX2Nvbm5lY3Rpb25fdW5pb25fc29ja2V0OworCit0eXBl
ZGVmIHN0cnVjdCBsaWJ4bF9ldmVudF90eXBlX3VuaW9uX2RvbWFpbl9zaHV0ZG93biB7CisJdWlu
dDhfdCBzaHV0ZG93bl9yZWFzb247Cit9IGxpYnhsX2V2ZW50X3R5cGVfdW5pb25fZG9tYWluX3No
dXRkb3duOworCit0eXBlZGVmIHN0cnVjdCBsaWJ4bF9ldmVudF90eXBlX3VuaW9uX2Rpc2tfZWpl
Y3QgeworCWNoYXIgKiB2ZGV2OworCWxpYnhsX2RldmljZV9kaXNrIGRpc2s7Cit9IGxpYnhsX2V2
ZW50X3R5cGVfdW5pb25fZGlza19lamVjdDsKKwordHlwZWRlZiBzdHJ1Y3QgbGlieGxfZXZlbnRf
dHlwZV91bmlvbl9vcGVyYXRpb25fY29tcGxldGUgeworCWludCByYzsKK30gbGlieGxfZXZlbnRf
dHlwZV91bmlvbl9vcGVyYXRpb25fY29tcGxldGU7CisKK3R5cGVkZWYgc3RydWN0IGxpYnhsX3Bz
cl9od19pbmZvX3R5cGVfdW5pb25fY2F0IHsKKwl1aW50MzJfdCBjb3NfbWF4OworCXVpbnQzMl90
IGNibV9sZW47CisJYm9vbCBjZHBfZW5hYmxlZDsKK30gbGlieGxfcHNyX2h3X2luZm9fdHlwZV91
bmlvbl9jYXQ7CisKK3R5cGVkZWYgc3RydWN0IGxpYnhsX3Bzcl9od19pbmZvX3R5cGVfdW5pb25f
bWJhIHsKKwl1aW50MzJfdCBjb3NfbWF4OworCXVpbnQzMl90IHRocnRsX21heDsKKwlib29sIGxp
bmVhcjsKK30gbGlieGxfcHNyX2h3X2luZm9fdHlwZV91bmlvbl9tYmE7CisKICovCiBpbXBvcnQg
IkMiCiAKQEAgLTE1MSw2ICsyNjIsMjcgQEAgZnVuYyAoeCAqQ2hhbm5lbGluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX2NoYW5uZWxpbmZvKSBlcnJvciB7CiAJeC5TdGF0ZSA9IGludCh4Yy5zdGF0ZSkK
IAl4LkV2dGNoID0gaW50KHhjLmV2dGNoKQogCXguUnJlZiA9IGludCh4Yy5ycmVmKQorCXguQ29u
bmVjdGlvbiA9IENoYW5uZWxDb25uZWN0aW9uKHhjLmNvbm5lY3Rpb24pCisJc3dpdGNoIHguQ29u
bmVjdGlvbiB7CisJY2FzZSBDaGFubmVsQ29ubmVjdGlvblB0eToKKwkJdmFyIGNvbm5lY3Rpb25Q
dHkgQ2hhbm5lbGluZm9Db25uZWN0aW9uVW5pb25QdHkKKwkJaWYgZXJyIDo9IGNvbm5lY3Rpb25Q
dHkuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LkNvbm5l
Y3Rpb25VbmlvbiA9IGNvbm5lY3Rpb25QdHkKKwlkZWZhdWx0OgorCQlyZXR1cm4gZm10LkVycm9y
ZigiaW52YWxpZCB1bmlvbiBrZXkgJyV2JyIsIHguQ29ubmVjdGlvbikKKwl9CisJcmV0dXJuIG5p
bAorfQorCitmdW5jICh4ICpDaGFubmVsaW5mb0Nvbm5lY3Rpb25VbmlvblB0eSkgZnJvbUMoeGMg
KkMubGlieGxfY2hhbm5lbGluZm8pIGVycm9yIHsKKwlpZiBDaGFubmVsQ29ubmVjdGlvbih4Yy5j
b25uZWN0aW9uKSAhPSBDaGFubmVsQ29ubmVjdGlvblB0eSB7CisJCXJldHVybiBlcnJvcnMuTmV3
KCJleHBlY3RlZCB1bmlvbiBrZXkgQ2hhbm5lbENvbm5lY3Rpb25QdHkiKQorCX0KKworCXRtcCA6
PSAoKkMubGlieGxfY2hhbm5lbGluZm9fY29ubmVjdGlvbl91bmlvbl9wdHkpKHVuc2FmZS5Qb2lu
dGVyKCZ4Yy51WzBdKSkKKwl4LlBhdGggPSBDLkdvU3RyaW5nKHRtcC5wYXRoKQogCXJldHVybiBu
aWwKIH0KIApAQCAtMzk4LDEyICs1MzAsMTgwIEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKIAl9CiAJeC5EbVJl
c3RyaWN0ID0gZGVmYm9vbERtUmVzdHJpY3QKIAl4LlRlZSA9IFRlZVR5cGUoeGMudGVlKQorCXgu
VHlwZSA9IERvbWFpblR5cGUoeGMuX3R5cGUpCisJc3dpdGNoIHguVHlwZSB7CisJY2FzZSBEb21h
aW5UeXBlUHY6CisJCXZhciB0eXBlUHYgRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uUHYKKwkJaWYg
ZXJyIDo9IHR5cGVQdi5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9
CisJCXguVHlwZVVuaW9uID0gdHlwZVB2CisJY2FzZSBEb21haW5UeXBlSHZtOgorCQl2YXIgdHlw
ZUh2bSBEb21haW5CdWlsZEluZm9UeXBlVW5pb25Idm0KKwkJaWYgZXJyIDo9IHR5cGVIdm0uZnJv
bUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlR5cGVVbmlvbiA9
IHR5cGVIdm0KKwljYXNlIERvbWFpblR5cGVQdmg6CisJCXZhciB0eXBlUHZoIERvbWFpbkJ1aWxk
SW5mb1R5cGVVbmlvblB2aAorCQlpZiBlcnIgOj0gdHlwZVB2aC5mcm9tQyh4Yyk7IGVyciAhPSBu
aWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVHlwZVVuaW9uID0gdHlwZVB2aAorCWRlZmF1
bHQ6CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAnJXYnIiwgeC5UeXBl
KQorCX0KIAl4LkFyY2hBcm0uR2ljVmVyc2lvbiA9IEdpY1ZlcnNpb24oeGMuYXJjaF9hcm0uZ2lj
X3ZlcnNpb24pCiAJeC5BcmNoQXJtLlZ1YXJ0ID0gVnVhcnRUeXBlKHhjLmFyY2hfYXJtLnZ1YXJ0
KQogCXguQWx0cDJNID0gQWx0cDJNTW9kZSh4Yy5hbHRwMm0pCiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpEb21haW5CdWlsZEluZm9UeXBlVW5pb25Idm0pIGZyb21DKHhjICpDLmxpYnhsX2Rv
bWFpbl9idWlsZF9pbmZvKSBlcnJvciB7CisJaWYgRG9tYWluVHlwZSh4Yy5fdHlwZSkgIT0gRG9t
YWluVHlwZUh2bSB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgRG9t
YWluVHlwZUh2bSIpCisJfQorCisJdG1wIDo9ICgqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb190
eXBlX3VuaW9uX2h2bSkodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCXguRmlybXdhcmUgPSBD
LkdvU3RyaW5nKHRtcC5maXJtd2FyZSkKKwl4LkJpb3MgPSBCaW9zVHlwZSh0bXAuYmlvcykKKwlp
ZiBlcnIgOj0geC5QYWUuZnJvbUMoJnRtcC5wYWUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwlpZiBlcnIgOj0geC5BcGljLmZyb21DKCZ0bXAuYXBpYyk7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkFjcGkuZnJvbUMoJnRtcC5hY3BpKTsgZXJy
ICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguQWNwaVMzLmZyb21DKCZ0
bXAuYWNwaV9zMyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4
LkFjcGlTNC5mcm9tQygmdG1wLmFjcGlfczQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgor
CX0KKwlpZiBlcnIgOj0geC5BY3BpTGFwdG9wU2xhdGUuZnJvbUMoJnRtcC5hY3BpX2xhcHRvcF9z
bGF0ZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4Lk54LmZy
b21DKCZ0bXAubngpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0g
eC5WaXJpZGlhbi5mcm9tQygmdG1wLnZpcmlkaWFuKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJaWYgZXJyIDo9IHguVmlyaWRpYW5FbmFibGUuZnJvbUMoJnRtcC52aXJpZGlhbl9l
bmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5WaXJp
ZGlhbkRpc2FibGUuZnJvbUMoJnRtcC52aXJpZGlhbl9kaXNhYmxlKTsgZXJyICE9IG5pbCB7CisJ
CXJldHVybiBlcnIKKwl9CisJeC5UaW1lb2Zmc2V0ID0gQy5Hb1N0cmluZyh0bXAudGltZW9mZnNl
dCkKKwlpZiBlcnIgOj0geC5IcGV0LmZyb21DKCZ0bXAuaHBldCk7IGVyciAhPSBuaWwgeworCQly
ZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlZwdEFsaWduLmZyb21DKCZ0bXAudnB0X2FsaWdu
KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5NbWlvSG9sZU1lbWtiID0gdWlu
dDY0KHRtcC5tbWlvX2hvbGVfbWVta2IpCisJeC5UaW1lck1vZGUgPSBUaW1lck1vZGUodG1wLnRp
bWVyX21vZGUpCisJaWYgZXJyIDo9IHguTmVzdGVkSHZtLmZyb21DKCZ0bXAubmVzdGVkX2h2bSk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkFsdHAyTS5mcm9t
QygmdG1wLmFsdHAybSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguU3lzdGVt
RmlybXdhcmUgPSBDLkdvU3RyaW5nKHRtcC5zeXN0ZW1fZmlybXdhcmUpCisJeC5TbWJpb3NGaXJt
d2FyZSA9IEMuR29TdHJpbmcodG1wLnNtYmlvc19maXJtd2FyZSkKKwl4LkFjcGlGaXJtd2FyZSA9
IEMuR29TdHJpbmcodG1wLmFjcGlfZmlybXdhcmUpCisJeC5IZHR5cGUgPSBIZHR5cGUodG1wLmhk
dHlwZSkKKwlpZiBlcnIgOj0geC5Ob2dyYXBoaWMuZnJvbUMoJnRtcC5ub2dyYXBoaWMpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5WZ2EuZnJvbUMoJnRtcC52
Z2EpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5WbmMuZnJv
bUMoJnRtcC52bmMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LktleW1hcCA9
IEMuR29TdHJpbmcodG1wLmtleW1hcCkKKwlpZiBlcnIgOj0geC5TZGwuZnJvbUMoJnRtcC5zZGwp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5TcGljZS5mcm9t
QygmdG1wLnNwaWNlKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9
IHguR2Z4UGFzc3RocnUuZnJvbUMoJnRtcC5nZnhfcGFzc3RocnUpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwl4LkdmeFBhc3N0aHJ1S2luZCA9IEdmeFBhc3N0aHJ1S2luZCh0bXAu
Z2Z4X3Bhc3N0aHJ1X2tpbmQpCisJeC5TZXJpYWwgPSBDLkdvU3RyaW5nKHRtcC5zZXJpYWwpCisJ
eC5Cb290ID0gQy5Hb1N0cmluZyh0bXAuYm9vdCkKKwlpZiBlcnIgOj0geC5Vc2IuZnJvbUMoJnRt
cC51c2IpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlVzYnZlcnNpb24gPSBp
bnQodG1wLnVzYnZlcnNpb24pCisJeC5Vc2JkZXZpY2UgPSBDLkdvU3RyaW5nKHRtcC51c2JkZXZp
Y2UpCisJaWYgZXJyIDo9IHguVmtiRGV2aWNlLmZyb21DKCZ0bXAudmtiX2RldmljZSk7IGVyciAh
PSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguU291bmRodyA9IEMuR29TdHJpbmcodG1wLnNv
dW5kaHcpCisJaWYgZXJyIDo9IHguWGVuUGxhdGZvcm1QY2kuZnJvbUMoJnRtcC54ZW5fcGxhdGZv
cm1fcGNpKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguVXNi
ZGV2aWNlTGlzdC5mcm9tQygmdG1wLnVzYmRldmljZV9saXN0KTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBlcnIKKwl9CisJeC5WZW5kb3JEZXZpY2UgPSBWZW5kb3JEZXZpY2UodG1wLnZlbmRvcl9k
ZXZpY2UpCisJaWYgZXJyIDo9IHguTXNWbUdlbmlkLmZyb21DKCZ0bXAubXNfdm1fZ2VuaWQpOyBl
cnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5TZXJpYWxMaXN0LmZy
b21DKCZ0bXAuc2VyaWFsX2xpc3QpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlp
ZiBlcnIgOj0geC5SZG0uZnJvbUMoJnRtcC5yZG0pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwl4LlJkbU1lbUJvdW5kYXJ5TWVta2IgPSB1aW50NjQodG1wLnJkbV9tZW1fYm91bmRh
cnlfbWVta2IpCisJeC5NY2FDYXBzID0gdWludDY0KHRtcC5tY2FfY2FwcykKKwlyZXR1cm4gbmls
Cit9CisKK2Z1bmMgKHggKkRvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvblB2KSBmcm9tQyh4YyAqQy5s
aWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IgeworCWlmIERvbWFpblR5cGUoeGMuX3R5cGUp
ICE9IERvbWFpblR5cGVQdiB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBr
ZXkgRG9tYWluVHlwZVB2IikKKwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX2RvbWFpbl9idWlsZF9p
bmZvX3R5cGVfdW5pb25fcHYpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4Lktlcm5lbCA9
IEMuR29TdHJpbmcodG1wLmtlcm5lbCkKKwl4LlNsYWNrTWVta2IgPSB1aW50NjQodG1wLnNsYWNr
X21lbWtiKQorCXguQm9vdGxvYWRlciA9IEMuR29TdHJpbmcodG1wLmJvb3Rsb2FkZXIpCisJaWYg
ZXJyIDo9IHguQm9vdGxvYWRlckFyZ3MuZnJvbUMoJnRtcC5ib290bG9hZGVyX2FyZ3MpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkNtZGxpbmUgPSBDLkdvU3RyaW5nKHRtcC5j
bWRsaW5lKQorCXguUmFtZGlzayA9IEMuR29TdHJpbmcodG1wLnJhbWRpc2spCisJeC5GZWF0dXJl
cyA9IEMuR29TdHJpbmcodG1wLmZlYXR1cmVzKQorCWlmIGVyciA6PSB4LkU4MjBIb3N0LmZyb21D
KCZ0bXAuZTgyMF9ob3N0KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJcmV0dXJu
IG5pbAorfQorCitmdW5jICh4ICpEb21haW5CdWlsZEluZm9UeXBlVW5pb25QdmgpIGZyb21DKHhj
ICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSBlcnJvciB7CisJaWYgRG9tYWluVHlwZSh4Yy5f
dHlwZSkgIT0gRG9tYWluVHlwZVB2aCB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1
bmlvbiBrZXkgRG9tYWluVHlwZVB2aCIpCisJfQorCisJdG1wIDo9ICgqQy5saWJ4bF9kb21haW5f
YnVpbGRfaW5mb190eXBlX3VuaW9uX3B2aCkodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCWlm
IGVyciA6PSB4LlB2c2hpbS5mcm9tQygmdG1wLnB2c2hpbSk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gZXJyCisJfQorCXguUHZzaGltUGF0aCA9IEMuR29TdHJpbmcodG1wLnB2c2hpbV9wYXRoKQor
CXguUHZzaGltQ21kbGluZSA9IEMuR29TdHJpbmcodG1wLnB2c2hpbV9jbWRsaW5lKQorCXguUHZz
aGltRXh0cmEgPSBDLkdvU3RyaW5nKHRtcC5wdnNoaW1fZXh0cmEpCisJcmV0dXJuIG5pbAorfQor
CiBmdW5jICh4ICpEZXZpY2VWZmIpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92ZmIpIGVycm9y
IHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5k
RG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtNTgyLDYgKzg4Miwy
OCBAQCBmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNi
Y3RybCkgZXJyb3IgewogZnVuYyAoeCAqRGV2aWNlVXNiZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9k
ZXZpY2VfdXNiZGV2KSBlcnJvciB7CiAJeC5DdHJsID0gRGV2aWQoeGMuY3RybCkKIAl4LlBvcnQg
PSBpbnQoeGMucG9ydCkKKwl4LlR5cGUgPSBVc2JkZXZUeXBlKHhjLl90eXBlKQorCXN3aXRjaCB4
LlR5cGUgeworCWNhc2UgVXNiZGV2VHlwZUhvc3RkZXY6CisJCXZhciB0eXBlSG9zdGRldiBEZXZp
Y2VVc2JkZXZUeXBlVW5pb25Ib3N0ZGV2CisJCWlmIGVyciA6PSB0eXBlSG9zdGRldi5mcm9tQyh4
Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVHlwZVVuaW9uID0gdHlw
ZUhvc3RkZXYKKwlkZWZhdWx0OgorCQlyZXR1cm4gZm10LkVycm9yZigiaW52YWxpZCB1bmlvbiBr
ZXkgJyV2JyIsIHguVHlwZSkKKwl9CisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VV
c2JkZXZUeXBlVW5pb25Ib3N0ZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSBl
cnJvciB7CisJaWYgVXNiZGV2VHlwZSh4Yy5fdHlwZSkgIT0gVXNiZGV2VHlwZUhvc3RkZXYgewor
CQlyZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQgdW5pb24ga2V5IFVzYmRldlR5cGVIb3N0ZGV2
IikKKwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX2RldmljZV91c2JkZXZfdHlwZV91bmlvbl9ob3N0
ZGV2KSh1bnNhZmUuUG9pbnRlcigmeGMudVswXSkpCisJeC5Ib3N0YnVzID0gYnl0ZSh0bXAuaG9z
dGJ1cykKKwl4Lkhvc3RhZGRyID0gYnl0ZSh0bXAuaG9zdGFkZHIpCiAJcmV0dXJuIG5pbAogfQog
CkBAIC02MjQsNiArOTQ2LDI3IEBAIGZ1bmMgKHggKkRldmljZUNoYW5uZWwpIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV9jaGFubmVsKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29T
dHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQogCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKIAl4
Lk5hbWUgPSBDLkdvU3RyaW5nKHhjLm5hbWUpCisJeC5Db25uZWN0aW9uID0gQ2hhbm5lbENvbm5l
Y3Rpb24oeGMuY29ubmVjdGlvbikKKwlzd2l0Y2ggeC5Db25uZWN0aW9uIHsKKwljYXNlIENoYW5u
ZWxDb25uZWN0aW9uU29ja2V0OgorCQl2YXIgY29ubmVjdGlvblNvY2tldCBEZXZpY2VDaGFubmVs
Q29ubmVjdGlvblVuaW9uU29ja2V0CisJCWlmIGVyciA6PSBjb25uZWN0aW9uU29ja2V0LmZyb21D
KHhjKTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5Db25uZWN0aW9uVW5p
b24gPSBjb25uZWN0aW9uU29ja2V0CisJZGVmYXVsdDoKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImlu
dmFsaWQgdW5pb24ga2V5ICcldiciLCB4LkNvbm5lY3Rpb24pCisJfQorCXJldHVybiBuaWwKK30K
KworZnVuYyAoeCAqRGV2aWNlQ2hhbm5lbENvbm5lY3Rpb25VbmlvblNvY2tldCkgZnJvbUMoeGMg
KkMubGlieGxfZGV2aWNlX2NoYW5uZWwpIGVycm9yIHsKKwlpZiBDaGFubmVsQ29ubmVjdGlvbih4
Yy5jb25uZWN0aW9uKSAhPSBDaGFubmVsQ29ubmVjdGlvblNvY2tldCB7CisJCXJldHVybiBlcnJv
cnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgQ2hhbm5lbENvbm5lY3Rpb25Tb2NrZXQiKQorCX0K
KworCXRtcCA6PSAoKkMubGlieGxfZGV2aWNlX2NoYW5uZWxfY29ubmVjdGlvbl91bmlvbl9zb2Nr
ZXQpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4LlBhdGggPSBDLkdvU3RyaW5nKHRtcC5w
YXRoKQogCXJldHVybiBuaWwKIH0KIApAQCAtOTUwLDYgKzEyOTMsNjIgQEAgZnVuYyAoeCAqRXZl
bnQpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CiAJfQogCXguRG9tdXVpZCA9IHV1
aWREb211dWlkCiAJeC5Gb3JVc2VyID0gdWludDY0KHhjLmZvcl91c2VyKQorCXguVHlwZSA9IEV2
ZW50VHlwZSh4Yy5fdHlwZSkKKwlzd2l0Y2ggeC5UeXBlIHsKKwljYXNlIEV2ZW50VHlwZU9wZXJh
dGlvbkNvbXBsZXRlOgorCQl2YXIgdHlwZU9wZXJhdGlvbkNvbXBsZXRlIEV2ZW50VHlwZVVuaW9u
T3BlcmF0aW9uQ29tcGxldGUKKwkJaWYgZXJyIDo9IHR5cGVPcGVyYXRpb25Db21wbGV0ZS5mcm9t
Qyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVHlwZVVuaW9uID0g
dHlwZU9wZXJhdGlvbkNvbXBsZXRlCisJY2FzZSBFdmVudFR5cGVEb21haW5TaHV0ZG93bjoKKwkJ
dmFyIHR5cGVEb21haW5TaHV0ZG93biBFdmVudFR5cGVVbmlvbkRvbWFpblNodXRkb3duCisJCWlm
IGVyciA6PSB0eXBlRG9tYWluU2h1dGRvd24uZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJl
dHVybiBlcnIKKwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVEb21haW5TaHV0ZG93bgorCWNhc2Ug
RXZlbnRUeXBlRGlza0VqZWN0OgorCQl2YXIgdHlwZURpc2tFamVjdCBFdmVudFR5cGVVbmlvbkRp
c2tFamVjdAorCQlpZiBlcnIgOj0gdHlwZURpc2tFamVjdC5mcm9tQyh4Yyk7IGVyciAhPSBuaWwg
eworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVHlwZVVuaW9uID0gdHlwZURpc2tFamVjdAorCWRl
ZmF1bHQ6CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAnJXYnIiwgeC5U
eXBlKQorCX0KKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkV2ZW50VHlwZVVuaW9uRG9tYWlu
U2h1dGRvd24pIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CisJaWYgRXZlbnRUeXBl
KHhjLl90eXBlKSAhPSBFdmVudFR5cGVEb21haW5TaHV0ZG93biB7CisJCXJldHVybiBlcnJvcnMu
TmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgRXZlbnRUeXBlRG9tYWluU2h1dGRvd24iKQorCX0KKwor
CXRtcCA6PSAoKkMubGlieGxfZXZlbnRfdHlwZV91bmlvbl9kb21haW5fc2h1dGRvd24pKHVuc2Fm
ZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4LlNodXRkb3duUmVhc29uID0gYnl0ZSh0bXAuc2h1dGRv
d25fcmVhc29uKQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRXZlbnRUeXBlVW5pb25EaXNr
RWplY3QpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CisJaWYgRXZlbnRUeXBlKHhj
Ll90eXBlKSAhPSBFdmVudFR5cGVEaXNrRWplY3QgeworCQlyZXR1cm4gZXJyb3JzLk5ldygiZXhw
ZWN0ZWQgdW5pb24ga2V5IEV2ZW50VHlwZURpc2tFamVjdCIpCisJfQorCisJdG1wIDo9ICgqQy5s
aWJ4bF9ldmVudF90eXBlX3VuaW9uX2Rpc2tfZWplY3QpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBd
KSkKKwl4LlZkZXYgPSBDLkdvU3RyaW5nKHRtcC52ZGV2KQorCWlmIGVyciA6PSB4LkRpc2suZnJv
bUMoJnRtcC5kaXNrKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJcmV0dXJuIG5p
bAorfQorCitmdW5jICh4ICpFdmVudFR5cGVVbmlvbk9wZXJhdGlvbkNvbXBsZXRlKSBmcm9tQyh4
YyAqQy5saWJ4bF9ldmVudCkgZXJyb3IgeworCWlmIEV2ZW50VHlwZSh4Yy5fdHlwZSkgIT0gRXZl
bnRUeXBlT3BlcmF0aW9uQ29tcGxldGUgeworCQlyZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQg
dW5pb24ga2V5IEV2ZW50VHlwZU9wZXJhdGlvbkNvbXBsZXRlIikKKwl9CisKKwl0bXAgOj0gKCpD
LmxpYnhsX2V2ZW50X3R5cGVfdW5pb25fb3BlcmF0aW9uX2NvbXBsZXRlKSh1bnNhZmUuUG9pbnRl
cigmeGMudVswXSkpCisJeC5SYyA9IGludCh0bXAucmMpCiAJcmV0dXJuIG5pbAogfQogCkBAIC05
NjMsNSArMTM2Miw0NiBAQCBmdW5jICh4ICpQc3JDYXRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9w
c3JfY2F0X2luZm8pIGVycm9yIHsKIAogZnVuYyAoeCAqUHNySHdJbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF9wc3JfaHdfaW5mbykgZXJyb3IgewogCXguSWQgPSB1aW50MzIoeGMuaWQpCisJeC5UeXBl
ID0gUHNyRmVhdFR5cGUoeGMuX3R5cGUpCisJc3dpdGNoIHguVHlwZSB7CisJY2FzZSBQc3JGZWF0
VHlwZU1iYToKKwkJdmFyIHR5cGVNYmEgUHNySHdJbmZvVHlwZVVuaW9uTWJhCisJCWlmIGVyciA6
PSB0eXBlTWJhLmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJ
eC5UeXBlVW5pb24gPSB0eXBlTWJhCisJY2FzZSBQc3JGZWF0VHlwZUNhdDoKKwkJdmFyIHR5cGVD
YXQgUHNySHdJbmZvVHlwZVVuaW9uQ2F0CisJCWlmIGVyciA6PSB0eXBlQ2F0LmZyb21DKHhjKTsg
ZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlQ2F0
CisJZGVmYXVsdDoKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImludmFsaWQgdW5pb24ga2V5ICcldici
LCB4LlR5cGUpCisJfQorCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqUHNySHdJbmZvVHlwZVVu
aW9uQ2F0KSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfaHdfaW5mbykgZXJyb3IgeworCWlmIFBzckZl
YXRUeXBlKHhjLl90eXBlKSAhPSBQc3JGZWF0VHlwZUNhdCB7CisJCXJldHVybiBlcnJvcnMuTmV3
KCJleHBlY3RlZCB1bmlvbiBrZXkgUHNyRmVhdFR5cGVDYXQiKQorCX0KKworCXRtcCA6PSAoKkMu
bGlieGxfcHNyX2h3X2luZm9fdHlwZV91bmlvbl9jYXQpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBd
KSkKKwl4LkNvc01heCA9IHVpbnQzMih0bXAuY29zX21heCkKKwl4LkNibUxlbiA9IHVpbnQzMih0
bXAuY2JtX2xlbikKKwl4LkNkcEVuYWJsZWQgPSBib29sKHRtcC5jZHBfZW5hYmxlZCkKKwlyZXR1
cm4gbmlsCit9CisKK2Z1bmMgKHggKlBzckh3SW5mb1R5cGVVbmlvbk1iYSkgZnJvbUMoeGMgKkMu
bGlieGxfcHNyX2h3X2luZm8pIGVycm9yIHsKKwlpZiBQc3JGZWF0VHlwZSh4Yy5fdHlwZSkgIT0g
UHNyRmVhdFR5cGVNYmEgeworCQlyZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQgdW5pb24ga2V5
IFBzckZlYXRUeXBlTWJhIikKKwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX3Bzcl9od19pbmZvX3R5
cGVfdW5pb25fbWJhKSh1bnNhZmUuUG9pbnRlcigmeGMudVswXSkpCisJeC5Db3NNYXggPSB1aW50
MzIodG1wLmNvc19tYXgpCisJeC5UaHJ0bE1heCA9IHVpbnQzMih0bXAudGhydGxfbWF4KQorCXgu
TGluZWFyID0gYm9vbCh0bXAubGluZWFyKQogCXJldHVybiBuaWwKIH0KLS0gCjIuMTkuMQoKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBt
YWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMu
eGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

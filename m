Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 5AB1D109C02
	for <lists+xen-devel@lfdr.de>; Tue, 26 Nov 2019 11:11:20 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iZXmc-0007m2-PI; Tue, 26 Nov 2019 10:09:22 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=XQNV=ZS=amazon.de=prvs=226749d31=wipawel@srs-us1.protection.inumbo.net>)
 id 1iZXmb-0007lI-JE
 for xen-devel@lists.xenproject.org; Tue, 26 Nov 2019 10:09:21 +0000
X-Inumbo-ID: ce533db6-1034-11ea-a55d-bc764e2007e4
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id ce533db6-1034-11ea-a55d-bc764e2007e4;
 Tue, 26 Nov 2019 10:09:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1574762958; x=1606298958;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=24TSTVTHSeKlYd+URf8eqjSmAbgPntbKzdnYgCtV8Bk=;
 b=DhZsn/OQfECOZKdkJBHZYRZoSCjynhz0zI0HI2PN+QAwU1tWYQjbt+fT
 3f9M5MjzAuCDjygdLyDeJErbrANH1ROyya3kYTX/cmYllESJWNDR29TPc
 5zvSLi2I/wNRW8VQhEai0I2MgEyB89SxtnrR3logL3dxlZqRWyNidhQxb g=;
IronPort-SDR: Pyif2FEj3criulpAqet/sza9WkU1RVJ6pj6ShCO5saZ4wJNJbhZwQZrkMRARy+s4e38R6IN0Hj
 Bx38OG6cTphw==
X-IronPort-AV: E=Sophos;i="5.69,245,1571702400"; 
   d="scan'208";a="9921176"
Received: from sea32-co-svc-lb4-vlan3.sea.corp.amazon.com (HELO
 email-inbound-relay-1d-5dd976cd.us-east-1.amazon.com) ([10.47.23.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 26 Nov 2019 10:08:58 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1d-5dd976cd.us-east-1.amazon.com (Postfix) with ESMTPS
 id F136BA177E; Tue, 26 Nov 2019 10:08:54 +0000 (UTC)
Received: from EX13D03EUC003.ant.amazon.com (10.43.164.192) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 26 Nov 2019 10:08:39 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D03EUC003.ant.amazon.com (10.43.164.192) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 26 Nov 2019 10:08:38 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Tue, 26 Nov 2019 10:08:36 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Tue, 26 Nov 2019 10:08:00 +0000
Message-ID: <20191126100801.124844-12-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20191126100801.124844-1-wipawel@amazon.de>
References: <20191126100801.124844-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v6 11/12] livepatch: Add metadata runtime
 retrieval mechanism
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>, Andrew
 Cooper <andrew.cooper3@citrix.com>, Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Pawel Wieczorkiewicz <wipawel@amazon.de>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RXh0ZW5kIHRoZSBsaXZlcGF0Y2ggbGlzdCBvcGVyYXRpb24gdG8gZmV0Y2ggYWxzbyBwYXlsb2Fk
cycgbWV0YWRhdGEuClRoaXMgaXMgYWNoaWV2ZWQgYnkgZXh0ZW5kaW5nIHRoZSBzeXNjdGwgbGlz
dCBpbnRlcmZhY2Ugd2l0aCAyIGV4dHJhCmd1ZXN0IGhhbmRsZXM6CiogbWV0YWRhdGEgICAgIC0g
YW4gYXJyYXkgb2YgYXJiaXRyYXJ5IHNpemUgc3RyaW5ncwoqIG1ldGFkYXRhX2xlbiAtIGFuIGFy
cmF5IG9mIG1ldGFkYXRhIHN0cmluZ3MnIGxlbmd0aHMgKHVpbjMyX3QgZWFjaCkKClBheWxvYWRz
JyBtZXRhZGF0YSBpcyBhIHN0cmluZyBvZiBhcmJpdHJhcnkgc2l6ZSBhbmQgZG9lcyBub3QgaGF2
ZSBhbgp1cHBlciBib3VuZCBsaW1pdC4gSXQgbWF5IGFsc28gdmFyeSBpbiBzaXplIGJldHdlZW4g
cGF5bG9hZHMuCgpJbiBvcmRlciB0byBsZXQgdGhlIHVzZXJsYW5kIGFsbG9jYXRlIGVub3VnaCBz
cGFjZSBmb3IgdGhlIGluY29taW5nCmRhdGEgYWRkIGEgbWV0YWRhdGEgdG90YWwgc2l6ZSBmaWVs
ZCB0byB0aGUgbGlzdCBzeXNjdGwgb3BlcmF0aW9uIGFuZApmaWxsIGl0IHdpdGggdG90YWwgc2l6
ZSBvZiBhbGwgcGF5bG9hZHMnIG1ldGFkYXRhLgoKRXh0ZW5kIHRoZSBsaWJ4YyB0byBoYW5kbGUg
dGhlIG1ldGFkYXRhIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycwphcyB3ZWxsIGFzIG1ldGFk
YXRhIGxlbmd0aCBhcnJheSBkYXRhIHRyYW5zZmVycy4KClRoZSB4ZW4tbGl2ZXBhdGNoIHVzZXJs
YW5kIHRvb2wgaXMgZXh0ZW5kZWQgdG8gYWx3YXlzIGRpc3BsYXkgdGhlCm1ldGFkYXRhIGZvciBl
YWNoIHJlY2VpdmVkIG1vZHVsZS4gVGhlIG1ldGFkYXRhIGlzIHJlY2VpdmVkIHdpdGggdGhlCmZv
bGxvd2luZyBmb3JtYXQ6IGtleT12YWx1ZVwwa2V5PXZhbHVlXDAuLi5rZXk9dmFsdWVcMC4gVGhl
IGZvcm1hdCBpcwptb2RpZmllZCB0byB0aGUgZm9sbG93aW5nIG9uZToga2V5PXZhbHVlO2tleT12
YWx1ZTsuLi5rZXk9dmFsdWUuClRoZSBuZXcgZm9ybWF0IGFsbG93cyB0byBlYXNpbHkgcGFyc2Ug
dGhlIG1ldGFkYXRhIGZvciBhIGdpdmVuIG1vZHVsZQpieSBhIG1hY2hpbmUuCgpTaWduZWQtb2Zm
LWJ5OiBQYXdlbCBXaWVjem9ya2lld2ljeiA8d2lwYXdlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5
OiBBbmRyYS1JcmluYSBQYXJhc2NoaXYgPGFuZHJhcHJzQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5
OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTm9yYmVy
dCBNYW50aGV5IDxubWFudGhleUBhbWF6b24uZGU+ClNpZ25lZC1vZmYtYnk6IEtvbnJhZCBSemVz
enV0ZWsgV2lsayA8a29ucmFkLndpbGtAb3JhY2xlLmNvbT4KUmV2aWV3ZWQtYnk6IFJvc3MgTGFn
ZXJ3YWxsIDxyb3NzLmxhZ2Vyd2FsbEBjaXRyaXguY29tPgotLS0KQ2hhbmdlZCBzaW5jZSB2NDoK
ICogYWRkICdwYWQnIGZpZWxkIHRvIGxpc3Qgc3lzY3RsCgpDaGFuZ2VkIHNpbmNlIHYzOgogICog
dXNlIHVpbnQzMl90IGluc3RlYWQgb2YgdWludDY0X3QgYW5kIG9mZl90IGZvcgogICAgbWV0YWRh
dGFfdG90YWxfc2l6ZSBhbmQgcmVsYXRlZCB2YXJpYWJsZXMKCkNoYW5nZWQgc2luY2UgdjE6CiAg
KiBhZGRlZCBjb3JyZXNwb25kaW5nIGRvY3VtZW50YXRpb24KICAqIG1ha2UgbWV0YWRhdGEgb3B0
aW9uYWwgKGRvIG5vdCBkaXNwbGF5IGl0IHdoZW4gZ2l2ZW4gcGF5bG9hZAogICAgZG9lcyBub3Qg
aGF2ZSBpdCkKLS0tCiBkb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYyAgICB8IDMzICsrKysrKysr
KysrKysrKysrLS0tLS0KIHRvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oIHwgMjIgKysrKysr
KysrKystLS0tCiB0b29scy9saWJ4Yy94Y19taXNjLmMgICAgICAgICB8IDY0ICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0KIHRvb2xzL21pc2MveGVuLWxpdmVwYXRj
aC5jICAgIHwgNDEgKysrKysrKysrKysrKysrKysrKysrLS0tLS0tCiB4ZW4vY29tbW9uL2xpdmVw
YXRjaC5jICAgICAgICB8IDI1ICsrKysrKysrKysrKystLS0tCiB4ZW4vaW5jbHVkZS9wdWJsaWMv
c3lzY3RsLmggICB8IDIwICsrKysrKysrKystLS0tCiA2IGZpbGVzIGNoYW5nZWQsIDE2MiBpbnNl
cnRpb25zKCspLCA0MyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kb2NzL21pc2MvbGl2ZXBh
dGNoLnBhbmRvYyBiL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCmluZGV4IDQzZDA4OTZhYTgu
LjJmM2Y5NWVkMzcgMTAwNjQ0Ci0tLSBhL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCisrKyBi
L2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCkBAIC03MDcsOCArNzA3LDggQEAgVGhlIHN0cnVj
dHVyZSBpcyBhcyBmb2xsb3c6CiAKICMjIyBYRU5fU1lTQ1RMX0xJVkVQQVRDSF9MSVNUICgyKQog
Ci1SZXRyaWV2ZSBhbiBhcnJheSBvZiBhYmJyZXZpYXRlZCBzdGF0dXMgYW5kIG5hbWVzIG9mIHBh
eWxvYWRzIHRoYXQgYXJlIGxvYWRlZCBpbiB0aGUKLWh5cGVydmlzb3IuCitSZXRyaWV2ZSBhbiBh
cnJheSBvZiBhYmJyZXZpYXRlZCBzdGF0dXMsIG5hbWVzIGFuZCBtZXRhZGF0YSBvZiBwYXlsb2Fk
cyB0aGF0IGFyZQorbG9hZGVkIGluIHRoZSBoeXBlcnZpc29yLgogCiBUaGUgY2FsbGVyIHByb3Zp
ZGVzOgogCkBAIC03MTcsMTEgKzcxNywxMyBAQCBUaGUgY2FsbGVyIHByb3ZpZGVzOgogICogYGlk
eGAgSW5kZXggaXRlcmF0b3IuIFRoZSBpbmRleCBpbnRvIHRoZSBoeXBlcnZpc29yJ3MgcGF5bG9h
ZCBjb3VudC4gSXQgaXMKICAgICByZWNvbW1lbmRlZCB0aGF0IG9uIGZpcnN0IGludm9jYXRpb24g
emVybyBiZSB1c2VkIHNvIHRoYXQgYG5yYCAod2hpY2ggdGhlCiAgICAgaHlwZXJ2aXNvciB3aWxs
IHVwZGF0ZSB3aXRoIHRoZSByZW1haW5pbmcgcGF5bG9hZCBjb3VudCkgYmUgcHJvdmlkZWQuCi0g
ICAgQWxzbyB0aGUgaHlwZXJ2aXNvciB3aWxsIHByb3ZpZGUgYHZlcnNpb25gIHdpdGggdGhlIG1v
c3QgY3VycmVudCB2YWx1ZSBhbmQKLSAgICBjYWxjdWxhdGVkIHRvdGFsIHNpemUgZm9yIGFsbCBw
YXlsb2FkcycgbmFtZXMuCisgICAgQWxzbyB0aGUgaHlwZXJ2aXNvciB3aWxsIHByb3ZpZGUgYHZl
cnNpb25gIHdpdGggdGhlIG1vc3QgY3VycmVudCB2YWx1ZSwKKyAgICBjYWxjdWxhdGVkIHRvdGFs
IHNpemUgb2YgYWxsIHBheWxvYWRzJyBuYW1lcyBhbmQgY2FsY3VsYXRlZCB0b3RhbCBzaXplIG9m
CisgICAgYWxsIHBheWxvYWQncyBtZXRhZGF0YS4KICAqIGBucmAgVGhlIG1heCBudW1iZXIgb2Yg
ZW50cmllcyB0byBwb3B1bGF0ZS4gQ2FuIGJlIHplcm8gd2hpY2ggd2lsbCByZXN1bHQKICAgICBp
biB0aGUgaHlwZXJjYWxsIGJlaW5nIGEgcHJvYmluZyBvbmUgYW5kIHJldHVybiB0aGUgbnVtYmVy
IG9mIHBheWxvYWRzCiAgICAgKGFuZCB1cGRhdGUgdGhlIGB2ZXJzaW9uYCkuCisgKiBgcGFkYCAt
ICpNVVNUKiBiZSB6ZXJvLgogICogYHN0YXR1c2AgVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRv
IHdyaXRlIGBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXNgCiAgICBzdHJ1Y3R1cmVzLiBDYWxs
ZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4KICAqIGBuYW1lYCAtIFZpcnR1
YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgdW5pcXVlIG5hbWUgb2YgdGhlIHBheWxv
YWRzLgpAQCAtNzMzLDE0ICs3MzUsMjMgQEAgVGhlIGNhbGxlciBwcm92aWRlczoKICAqIGBsZW5g
IC0gVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdyaXRlIHRoZSBsZW5ndGggb2YgZWFjaCB1
bmlxdWUgbmFtZQogICAgb2YgdGhlIHBheWxvYWQuIENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAg
dG8gYG5yYCBvZiB0aGVtLiBFYWNoICpNVVNUKiBiZQogICAgb2Ygc2l6ZW9mKHVpbnQzMl90KSAo
NCBieXRlcykuCisgKiBgbWV0YWRhdGFgIC0gVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdy
aXRlIHRoZSBtZXRhZGF0YSBvZiB0aGUgcGF5bG9hZHMuCisgICBDYWxsZXIgKk1VU1QqIGFsbG9j
YXRlIGVub3VnaCBzcGFjZSB0byBiZSBhYmxlIHRvIHN0b3JlIGFsbCByZWNlaXZlZCBkYXRhCisg
ICAoaS5lLiB0b3RhbCBhbGxvY2F0ZWQgc3BhY2UgKk1VU1QqIG1hdGNoIHRoZSBgbWV0YWRhdGFf
dG90YWxfc2l6ZWAgdmFsdWUKKyAgIHByb3ZpZGVkIGJ5IHRoZSBoeXBlcnZpc29yKS4gSW5kaXZp
ZHVhbCBwYXlsb2FkIG1ldGFkYXRhIHN0cmluZyBjYW4gYmUgb2YKKyAgIGFyYml0cmFyeSBsZW5n
dGguIFRoZSBtZXRhZGF0YSBzdHJpbmcgZm9ybWF0IGlzOiBrZXk9dmFsdWVcMC4uLmtleT12YWx1
ZVwwLgorICogYG1ldGFkYXRhX2xlbmAgLSBWaXJ0dWFsIGFkZHJlc3Mgb2Ygd2hlcmUgdG8gd3Jp
dGUgdGhlIGxlbmd0aCBvZiBlYWNoIG1ldGFkYXRhCisgICBzdHJpbmcgb2YgdGhlIHBheWxvYWQu
IENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0aGVtLiBFYWNoICpNVVNUKgor
ICAgYmUgb2Ygc2l6ZW9mKHVpbnQzMl90KSAoNCBieXRlcykuCiAKIElmIHRoZSBoeXBlcmNhbGwg
cmV0dXJucyBhbiBwb3NpdGl2ZSBudW1iZXIsIGl0IGlzIHRoZSBudW1iZXIgKHVwdG8gYG5yYAog
cHJvdmlkZWQgdG8gdGhlIGh5cGVyY2FsbCkgb2YgdGhlIHBheWxvYWRzIHJldHVybmVkLCBhbG9u
ZyB3aXRoIGBucmAgdXBkYXRlZAogd2l0aCB0aGUgbnVtYmVyIG9mIHJlbWFpbmluZyBwYXlsb2Fk
cywgYHZlcnNpb25gIHVwZGF0ZWQgKGl0IG1heSBiZSB0aGUgc2FtZQogYWNyb3NzIGh5cGVyY2Fs
bHMgLSBpZiBpdCB2YXJpZXMgdGhlIGRhdGEgaXMgc3RhbGUgYW5kIGZ1cnRoZXIgY2FsbHMgY291
bGQKLWZhaWwpIGFuZCB0aGUgYG5hbWVfdG90YWxfc2l6ZWAgY29udGFpbmluZyB0b3RhbCBzaXpl
IG9mIHRyYW5zZmVycmVkIGRhdGEgZm9yCi10aGUgYXJyYXkuIFRoZSBgc3RhdHVzYCwgYG5hbWVg
LCBhbmQgYGxlbmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgKLXZhbHVlIChg
aWR4YCkgd2l0aCB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4KK2ZhaWwpLCBgbmFtZV90b3Rh
bF9zaXplYCBhbmQgYG1ldGFkYXRhX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZXMg
b2YKK3RyYW5zZmVycmVkIGRhdGEgZm9yIGJvdGggdGhlIGFycmF5cy4KK1RoZSBgc3RhdHVzYCwg
YG5hbWVgLCBgbGVuYCwgYG1ldGFkYXRhYCBhbmQgYG1ldGFkYXRhX2xlbmAgYXJlIHVwZGF0ZWQg
YXQgdGhlaXIKK2Rlc2lnbmVkIGluZGV4IHZhbHVlIChgaWR4YCkgd2l0aCB0aGUgcmV0dXJuZWQg
dmFsdWUgb2YgZGF0YS4KIAogSWYgdGhlIGh5cGVyY2FsbCByZXR1cm5zIC1YRU5fRTJCSUcgdGhl
IGBucmAgaXMgdG9vIGJpZyBhbmQgc2hvdWxkIGJlCiBsb3dlcmVkLgpAQCAtNzc3LDcgKzc4OCw5
IEBAIFRoZSBzdHJ1Y3R1cmUgaXMgYXMgZm9sbG93OgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkIGJlIGZpbGxlZCBvdXQuIENhbiBiZSB6
ZXJvIHRvIGdldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYW1vdW50IG9mIHBheWxvYWRzIGFuZCB2ZXJzaW9uLgogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT1VUOiBIb3cgbWFueSBwYXlsb2FkcyBs
ZWZ0LiAqLworICAgICAgICB1aW50MzJfdCBwYWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
LyogSU46IE11c3QgYmUgemVyby4gKi8KICAgICAgICAgdWludDMyX3QgbmFtZV90b3RhbF9zaXpl
OyAgICAgICAgICAgICAgIC8qIE9VVDogVG90YWwgc2l6ZSBvZiBhbGwgdHJhbnNmZXIgbmFtZXMg
Ki8KKyAgICAgICAgdWludDMyX3QgbWV0YWRhdGFfdG90YWxfc2l6ZTsgICAgICAgICAgIC8qIE9V
VDogVG90YWwgc2l6ZSBvZiBhbGwgdHJhbnNmZXIgbWV0YWRhdGEgKi8KICAgICAgICAgWEVOX0dV
RVNUX0hBTkRMRV82NCh4ZW5fbGl2ZXBhdGNoX3N0YXR1c190KSBzdGF0dXM7ICAvKiBPVVQuIE11
c3QgaGF2ZSBlbm91Z2gKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNwYWNlIGFsbG9jYXRlIGZvciBuciBvZiB0aGVtLiAqLwogICAgICAgICBYRU5f
R1VFU1RfSEFORExFXzY0KGNoYXIpIG5hbWU7ICAgICAgICAgLyogT1VUOiBBcnJheSBvZiBuYW1l
cy4gRWFjaCBtZW1iZXIKQEAgLTc4Niw2ICs3OTksMTIgQEAgVGhlIHN0cnVjdHVyZSBpcyBhcyBm
b2xsb3c6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBuciBvZiB0aGVtLiAqLwogICAgICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHVpbnQzMikgbGVu
OyAgICAgICAgLyogT1VUOiBBcnJheSBvZiBsZW5ndGhzIG9mIG5hbWUncy4KICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0
aGVtLiAqLworICAgICAgICBYRU5fR1VFU1RfSEFORExFXzY0KGNoYXIpIG1ldGFkYXRhOyAgICAg
LyogT1VUOiBBcnJheSBvZiBtZXRhZGF0YSBzdHJpbmdzLiBFYWNoCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIgbWF5IGhhdmUgYW4gYXJi
aXRyYXJ5IGxlbmd0aC4KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLworICAgICAgICBYRU5fR1VFU1RfSEFO
RExFXzY0KHVpbnQzMikgbWV0YWRhdGFfbGVuOyAgLyogT1VUOiBBcnJheSBvZiBsZW5ndGhzIG9m
IG1ldGFkYXRhJ3MuCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KKwogICAgIH07CiAKICMjIyBYRU5f
U1lTQ1RMX0xJVkVQQVRDSF9BQ1RJT04gKDMpCmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy9pbmNs
dWRlL3hlbmN0cmwuaCBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCmluZGV4IGY0OTBh
NmRlYmMuLmU1NDk3MDJmZGQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3Ry
bC5oCisrKyBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5oCkBAIC0yNTU5LDcgKzI1NTks
NyBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKIAogLyoKICAqIEdl
dCBhIG51bWJlciBvZiBhdmFpbGFibGUgcGF5bG9hZHMgYW5kIGdldCBhY3R1YWwgdG90YWwgc2l6
ZSBvZgotICogdGhlIHBheWxvYWRzJyBuYW1lIGFycmF5LgorICogdGhlIHBheWxvYWRzJyBuYW1l
IGFuZCBtZXRhZGF0YSBhcnJheXMuCiAgKgogICogVGhpcyBmdW5jdGlvbnMgaXMgdHlwaWNhbGx5
IGV4ZWN1dGVkIGZpcnN0IGJlZm9yZSB0aGUgeGNfbGl2ZXBhdGNoX2xpc3QoKQogICogdG8gb2J0
YWluIHRoZSBzaXplcyBhbmQgY29ycmVjdGx5IGFsbG9jYXRlIGFsbCBuZWNlc3NhcnkgZGF0YSBy
ZXNvdXJjZXMuCkBAIC0yNTcwLDEzICsyNTcwLDE2IEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhj
X2ludGVyZmFjZSAqeGNoLAogICogd2lsbCBjb250YWluIHRoZSBoeXBlcmNhbGwgZXJyb3IgY29k
ZSB2YWx1ZS4KICAqLwogaW50IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y19pbnRlcmZh
Y2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdWludDMyX3QgKm5hbWVfdG90YWxfc2l6ZSk7CisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQzMl90ICpuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVpbnQzMl90ICptZXRhZGF0YV90b3RhbF9zaXplKTsKIAogLyoKICAqIFRoZSBo
ZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIGdldCBhbiBhcnJheSBvZiB0aGUgZm9sbG93aW5n
IG9iamVjdHM6CiAgKiAgIC0geGVuX2xpdmVwYXRjaF9zdGF0dXNfdDogc3RhdGVzIGFuZCByZXR1
cm4gY29kZXMgb2YgcGF5bG9hZHMKICAqICAgLSBuYW1lOiBuYW1lcyBvZiBwYXlsb2FkcwogICog
ICAtIGxlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxvYWRzJyBuYW1lcworICogICAt
IG1ldGFkYXRhOiBwYXlsb2FkcycgbWV0YWRhdGEKKyAqICAgLSBtZXRhZGF0YV9sZW46IGxlbmd0
aHMgb2YgY29ycmVzcG9uZGluZyBwYXlsb2FkcycgbWV0YWRhdGEKICAqCiAgKiBIb3dldmVyIGl0
IGlzIGNvbXBsZXggYmVjYXVzZSBpdCBoYXMgdG8gZGVhbCB3aXRoIHRoZSBoeXBlcnZpc29yCiAg
KiByZXR1cm5pbmcgc29tZSBvZiB0aGUgcmVxdWVzdGVkIGRhdGEgb3IgZGF0YSBiZWluZyBzdGFs
ZQpAQCAtMjU4OSwxMiArMjU5MiwxMyBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVz
KHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAogICoKICAqIEl0IGlzIGV4cGVj
dGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9uIHdpbGwgZmlyc3QgaXNzdWUgdGhl
CiAgKiB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSBpbiBvcmRlciB0byBvYnRhaW4gdG90
YWwgc2l6ZXMgb2YgbmFtZXMKLSAqIGFzIHdlbGwgYXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBh
eWxvYWQgZW50cmllcy4KLSAqIFRoZSB0b3RhbCBzaXplcyBhcmUgcmVxdWlyZWQgYW5kIHN1cHBs
aWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6ZScKLSAqIHBhcmFtZXRlci4KKyAqIGFuZCBhbGwg
bWV0YWRhdGEgYXMgd2VsbCBhcyB0aGUgY3VycmVudCBudW1iZXIgb2YgcGF5bG9hZCBlbnRyaWVz
LgorICogVGhlIHRvdGFsIHNpemVzIGFyZSByZXF1aXJlZCBhbmQgc3VwcGxpZWQgdmlhIHRoZSAn
bmFtZV90b3RhbF9zaXplJyBhbmQKKyAqICdtZXRhZGF0YV90b3RhbF9zaXplJyBwYXJhbWV0ZXJz
LgogICoKICAqIFRoZSAnbWF4JyBpcyB0byBiZSBwcm92aWRlZCBieSB0aGUgY2FsbGVyIHdpdGgg
dGhlIG1heGltdW0gbnVtYmVyIG9mCi0gKiBlbnRyaWVzIHRoYXQgJ2luZm8nLCAnbmFtZScsICds
ZW4nIGFycmF5cyBjYW4gYmUgZmlsbGVkIHVwIHdpdGguCisgKiBlbnRyaWVzIHRoYXQgJ2luZm8n
LCAnbmFtZScsICdsZW4nLCAnbWV0YWRhdGEnIGFuZCAnbWV0YWRhdGFfbGVuJyBhcnJheXMKKyAq
IGNhbiBiZSBmaWxsZWQgdXAgd2l0aC4KICAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnaW5mbycg
YXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdAogICogc3Ry
dWN0dXJlIHNpemUuCkBAIC0yNjAzLDYgKzI2MDcsMTAgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0
X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKICAqCiAgKiBF
YWNoIGVudHJ5IGluIHRoZSAnbGVuJyBhcnJheSBpcyBleHBlY3RlZCB0byBiZSBvZiB1aW50MzJf
dCBzaXplLgogICoKKyAqIEVhY2ggZW50cnkgaW4gdGhlICdtZXRhZGF0YScgYXJyYXkgbWF5IGhh
dmUgYW4gYXJiaXRyYXJ5IHNpemUuCisgKgorICogRWFjaCBlbnRyeSBpbiB0aGUgJ21ldGFkYXRh
X2xlbicgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWludDMyX3Qgc2l6ZS4KKyAqCiAgKiBU
aGUgcmV0dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVyY2FsbCBjb21wbGV0ZWQgc3VjY2Vz
c2Z1bGx5LgogICogTm90ZSB0aGF0IHRoZSByZXR1cm4gdmFsdWUgaXMgX25vdF8gdGhlIGFtb3Vu
dCBvZiBlbnRyaWVzIGZpbGxlZAogICogb3V0IC0gdGhhdCBpcyBzYXZlZCBpbiAnZG9uZScuCkBA
IC0yNjE3LDYgKzI2MjUsOCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4
Y2gsIGNvbnN0IHVuc2lnbmVkIGludCBtYXgsCiAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHhlbl9saXZlcGF0Y2hfc3RhdHVzICppbmZvLAogICAgICAgICAgICAgICAgICAgICAgIGNoYXIg
Km5hbWUsIHVpbnQzMl90ICpsZW4sCiAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdWludDMy
X3QgbmFtZV90b3RhbF9zaXplLAorICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm1ldGFkYXRh
LCB1aW50MzJfdCAqbWV0YWRhdGFfbGVuLAorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVp
bnQzMl90IG1ldGFkYXRhX3RvdGFsX3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgdW5zaWdu
ZWQgaW50ICpkb25lLCB1bnNpZ25lZCBpbnQgKmxlZnQpOwogCiAvKgpkaWZmIC0tZ2l0IGEvdG9v
bHMvbGlieGMveGNfbWlzYy5jIGIvdG9vbHMvbGlieGMveGNfbWlzYy5jCmluZGV4IDU4MGQyNTQ1
OTMuLjBiMjFhNmFjYTQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL3hjX21pc2MuYworKysgYi90
b29scy9saWJ4Yy94Y19taXNjLmMKQEAgLTY2Myw3ICs2NjMsNyBAQCBpbnQgeGNfbGl2ZXBhdGNo
X2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKIAogLyoKICAqIEdldCBhIG51bWJlciBvZiBhdmFpbGFi
bGUgcGF5bG9hZHMgYW5kIGdldCBhY3R1YWwgdG90YWwgc2l6ZSBvZgotICogdGhlIHBheWxvYWRz
JyBuYW1lIGFycmF5LgorICogdGhlIHBheWxvYWRzJyBuYW1lIGFuZCBtZXRhZGF0YSBhcnJheXMu
CiAgKgogICogVGhpcyBmdW5jdGlvbnMgaXMgdHlwaWNhbGx5IGV4ZWN1dGVkIGZpcnN0IGJlZm9y
ZSB0aGUgeGNfbGl2ZXBhdGNoX2xpc3QoKQogICogdG8gb2J0YWluIHRoZSBzaXplcyBhbmQgY29y
cmVjdGx5IGFsbG9jYXRlIGFsbCBuZWNlc3NhcnkgZGF0YSByZXNvdXJjZXMuCkBAIC02NzQsMTIg
KzY3NCwxMyBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdp
bGwgY29udGFpbiB0aGUgaHlwZXJjYWxsIGVycm9yIGNvZGUgdmFsdWUuCiAgKi8KIGludCB4Y19s
aXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAq
bnIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpuYW1lX3RvdGFs
X3NpemUpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpuYW1lX3Rv
dGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICptZXRh
ZGF0YV90b3RhbF9zaXplKQogewogICAgIERFQ0xBUkVfU1lTQ1RMOwogICAgIGludCByYzsKIAot
ICAgIGlmICggIW5yIHx8ICFuYW1lX3RvdGFsX3NpemUgKQorICAgIGlmICggIW5yIHx8ICFuYW1l
X3RvdGFsX3NpemUgfHwgIW1ldGFkYXRhX3RvdGFsX3NpemUgKQogICAgIHsKICAgICAgICAgZXJy
bm8gPSBFSU5WQUw7CiAgICAgICAgIHJldHVybiAtMTsKQEAgLTY5NSw2ICs2OTYsNyBAQCBpbnQg
eGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBp
bnQgKm5yLAogCiAgICAgKm5yID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5ucjsKICAgICAq
bmFtZV90b3RhbF9zaXplID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uYW1lX3RvdGFsX3Np
emU7CisgICAgKm1ldGFkYXRhX3RvdGFsX3NpemUgPSBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0
Lm1ldGFkYXRhX3RvdGFsX3NpemU7CiAKICAgICByZXR1cm4gMDsKIH0KQEAgLTcwNCw2ICs3MDYs
OCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1
bnNpZ25lZCBpbnQgKm5yLAogICogICAtIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3Q6IHN0YXRlcyBh
bmQgcmV0dXJuIGNvZGVzIG9mIHBheWxvYWRzCiAgKiAgIC0gbmFtZTogbmFtZXMgb2YgcGF5bG9h
ZHMKICAqICAgLSBsZW46IGxlbmd0aHMgb2YgY29ycmVzcG9uZGluZyBwYXlsb2FkcycgbmFtZXMK
KyAqICAgLSBtZXRhZGF0YTogcGF5bG9hZHMnIG1ldGFkYXRhCisgKiAgIC0gbWV0YWRhdGFfbGVu
OiBsZW5ndGhzIG9mIGNvcnJlc3BvbmRpbmcgcGF5bG9hZHMnIG1ldGFkYXRhCiAgKgogICogSG93
ZXZlciBpdCBpcyBjb21wbGV4IGJlY2F1c2UgaXQgaGFzIHRvIGRlYWwgd2l0aCB0aGUgaHlwZXJ2
aXNvcgogICogcmV0dXJuaW5nIHNvbWUgb2YgdGhlIHJlcXVlc3RlZCBkYXRhIG9yIGRhdGEgYmVp
bmcgc3RhbGUKQEAgLTcxNiwxMiArNzIwLDEzIEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdF9nZXRf
c2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCiAgKgogICogSXQgaXMg
ZXhwZWN0ZWQgdGhhdCB0aGUgY2FsbGVyIG9mIHRoaXMgZnVuY3Rpb24gd2lsbCBmaXJzdCBpc3N1
ZSB0aGUKICAqIHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcygpIGluIG9yZGVyIHRvIG9idGFp
biB0b3RhbCBzaXplcyBvZiBuYW1lcwotICogYXMgd2VsbCBhcyB0aGUgY3VycmVudCBudW1iZXIg
b2YgcGF5bG9hZCBlbnRyaWVzLgotICogVGhlIHRvdGFsIHNpemVzIGFyZSByZXF1aXJlZCBhbmQg
c3VwcGxpZWQgdmlhIHRoZSAnbmFtZV90b3RhbF9zaXplJwotICogcGFyYW1ldGVyLgorICogYW5k
IGFsbCBtZXRhZGF0YSBhcyB3ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBwYXlsb2FkIGVu
dHJpZXMuCisgKiBUaGUgdG90YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBwbGllZCB2aWEg
dGhlICduYW1lX3RvdGFsX3NpemUnIGFuZAorICogJ21ldGFkYXRhX3RvdGFsX3NpemUnIHBhcmFt
ZXRlcnMuCiAgKgogICogVGhlICdtYXgnIGlzIHRvIGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIg
d2l0aCB0aGUgbWF4aW11bSBudW1iZXIgb2YKLSAqIGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1l
JywgJ2xlbicgYXJyYXlzIGNhbiBiZSBmaWxsZWQgdXAgd2l0aC4KKyAqIGVudHJpZXMgdGhhdCAn
aW5mbycsICduYW1lJywgJ2xlbicsICdtZXRhZGF0YScgYW5kICdtZXRhZGF0YV9sZW4nIGFycmF5
cworICogY2FuIGJlIGZpbGxlZCB1cCB3aXRoLgogICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdp
bmZvJyBhcnJheSBpcyBleHBlY3RlZCB0byBiZSBvZiB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190CiAg
KiBzdHJ1Y3R1cmUgc2l6ZS4KQEAgLTczMCw2ICs3MzUsMTAgQEAgaW50IHhjX2xpdmVwYXRjaF9s
aXN0X2dldF9zaXplcyh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50ICpuciwKICAqCiAg
KiBFYWNoIGVudHJ5IGluIHRoZSAnbGVuJyBhcnJheSBpcyBleHBlY3RlZCB0byBiZSBvZiB1aW50
MzJfdCBzaXplLgogICoKKyAqIEVhY2ggZW50cnkgaW4gdGhlICdtZXRhZGF0YScgYXJyYXkgbWF5
IGhhdmUgYW4gYXJiaXRyYXJ5IHNpemUuCisgKgorICogRWFjaCBlbnRyeSBpbiB0aGUgJ21ldGFk
YXRhX2xlbicgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgdWludDMyX3Qgc2l6ZS4KKyAqCiAg
KiBUaGUgcmV0dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVyY2FsbCBjb21wbGV0ZWQgc3Vj
Y2Vzc2Z1bGx5LgogICogTm90ZSB0aGF0IHRoZSByZXR1cm4gdmFsdWUgaXMgX25vdF8gdGhlIGFt
b3VudCBvZiBlbnRyaWVzIGZpbGxlZAogICogb3V0IC0gdGhhdCBpcyBzYXZlZCBpbiAnZG9uZScu
CkBAIC03NDQsNiArNzUzLDggQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAq
eGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCB4ZW5fbGl2ZXBhdGNoX3N0YXR1cyAqaW5mbywKICAgICAgICAgICAgICAgICAgICAgICBjaGFy
ICpuYW1lLCB1aW50MzJfdCAqbGVuLAogICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVpbnQz
Ml90IG5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZXRhZGF0
YSwgdWludDMyX3QgKm1ldGFkYXRhX2xlbiwKKyAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1
aW50MzJfdCBtZXRhZGF0YV90b3RhbF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCAqZG9uZSwgdW5zaWduZWQgaW50ICpsZWZ0KQogewogICAgIGludCByYzsKQEAgLTc1
MiwxMyArNzYzLDE2IEBAIGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwg
Y29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICBERUNMQVJFX0hZUEVSQ0FMTF9CT1VOQ0UoaW5m
bywgMCwgWENfSFlQRVJDQUxMX0JVRkZFUl9CT1VOQ0VfT1VUKTsKICAgICBERUNMQVJFX0hZUEVS
Q0FMTF9CT1VOQ0UobmFtZSwgMCwgWENfSFlQRVJDQUxMX0JVRkZFUl9CT1VOQ0VfT1VUKTsKICAg
ICBERUNMQVJFX0hZUEVSQ0FMTF9CT1VOQ0UobGVuLCAwLCBYQ19IWVBFUkNBTExfQlVGRkVSX0JP
VU5DRV9PVVQpOworICAgIERFQ0xBUkVfSFlQRVJDQUxMX0JPVU5DRShtZXRhZGF0YSwgMCwgWENf
SFlQRVJDQUxMX0JVRkZFUl9CT1VOQ0VfT1VUKTsKKyAgICBERUNMQVJFX0hZUEVSQ0FMTF9CT1VO
Q0UobWV0YWRhdGFfbGVuLCAwLCBYQ19IWVBFUkNBTExfQlVGRkVSX0JPVU5DRV9PVVQpOwogICAg
IHVpbnQzMl90IG1heF9iYXRjaF9zeiwgbnI7CiAgICAgdWludDMyX3QgdmVyc2lvbiA9IDAsIHJl
dHJpZXMgPSAwOwogICAgIHVpbnQzMl90IGFkanVzdCA9IDA7Ci0gICAgdWludDMyX3QgbmFtZV9v
ZmYgPSAwOwotICAgIHVpbnQzMl90IG5hbWVfc3o7CisgICAgdWludDMyX3QgbmFtZV9vZmYgPSAw
LCBtZXRhZGF0YV9vZmYgPSAwOworICAgIHVpbnQzMl90IG5hbWVfc3osIG1ldGFkYXRhX3N6Owog
Ci0gICAgaWYgKCAhbWF4IHx8ICFpbmZvIHx8ICFuYW1lIHx8ICFsZW4gfHwgIWRvbmUgfHwgIWxl
ZnQgKQorICAgIGlmICggIW1heCB8fCAhaW5mbyB8fCAhbmFtZSB8fCAhbGVuIHx8CisgICAgICAg
ICAhbWV0YWRhdGEgfHwgIW1ldGFkYXRhX2xlbiB8fCAhZG9uZSB8fCAhbGVmdCApCiAgICAgewog
ICAgICAgICBlcnJubyA9IEVJTlZBTDsKICAgICAgICAgcmV0dXJuIC0xOwpAQCAtNzc3LDEwICs3
OTEsMTEgQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1
bnNpZ25lZCBpbnQgbWF4LAogCiAgICAgbWF4X2JhdGNoX3N6ID0gbWF4OwogICAgIG5hbWVfc3og
PSBuYW1lX3RvdGFsX3NpemU7CisgICAgbWV0YWRhdGFfc3ogPSBtZXRhZGF0YV90b3RhbF9zaXpl
OwogICAgICpkb25lID0gMDsKICAgICAqbGVmdCA9IDA7CiAgICAgZG8gewotICAgICAgICB1aW50
MzJfdCBfbmFtZV9zejsKKyAgICAgICAgdWludDMyX3QgX25hbWVfc3osIF9tZXRhZGF0YV9zejsK
IAogICAgICAgICAvKgogICAgICAgICAgKiBUaGUgZmlyc3QgdGltZSB3ZSBnbyBpbiB0aGlzIGxv
b3Agb3VyICdtYXgnIG1heSBiZSBiaWdnZXIKQEAgLTgwMywxMCArODE4LDE0IEBAIGludCB4Y19s
aXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwK
ICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShpbmZvLCBuciAqIHNpemVvZigqaW5m
bykpOwogICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG5hbWUsIG5hbWVfc3opOwog
ICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGxlbiwgbnIgKiBzaXplb2YoKmxlbikp
OworICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG1ldGFkYXRhLCBtZXRhZGF0YV9z
eik7CisgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobWV0YWRhdGFfbGVuLCBuciAq
IHNpemVvZigqbWV0YWRhdGFfbGVuKSk7CiAgICAgICAgIC8qIE1vdmUgdGhlIHBvaW50ZXIgdG8g
cHJvcGVyIG9mZnNldCBpbnRvICdpbmZvJy4gKi8KICAgICAgICAgKEhZUEVSQ0FMTF9CVUZGRVIo
aW5mbykpLT51YnVmID0gaW5mbyArICpkb25lOwogICAgICAgICAoSFlQRVJDQUxMX0JVRkZFUihu
YW1lKSktPnVidWYgPSBuYW1lICsgbmFtZV9vZmY7CiAgICAgICAgIChIWVBFUkNBTExfQlVGRkVS
KGxlbikpLT51YnVmID0gbGVuICsgKmRvbmU7CisgICAgICAgIChIWVBFUkNBTExfQlVGRkVSKG1l
dGFkYXRhKSktPnVidWYgPSBtZXRhZGF0YSArIG1ldGFkYXRhX29mZjsKKyAgICAgICAgKEhZUEVS
Q0FMTF9CVUZGRVIobWV0YWRhdGFfbGVuKSktPnVidWYgPSBtZXRhZGF0YV9sZW4gKyAqZG9uZTsK
ICAgICAgICAgLyogQWxsb2NhdGUgbWVtb3J5LiAqLwogICAgICAgICByYyA9IHhjX2h5cGVyY2Fs
bF9ib3VuY2VfcHJlKHhjaCwgaW5mbyk7CiAgICAgICAgIGlmICggcmMgKQpAQCAtODIwLDkgKzgz
OSwxOSBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIGNvbnN0IHVu
c2lnbmVkIGludCBtYXgsCiAgICAgICAgIGlmICggcmMgKQogICAgICAgICAgICAgYnJlYWs7CiAK
KyAgICAgICAgcmMgPSB4Y19oeXBlcmNhbGxfYm91bmNlX3ByZSh4Y2gsIG1ldGFkYXRhKTsKKyAg
ICAgICAgaWYgKCByYyApCisgICAgICAgICAgICBicmVhazsKKworICAgICAgICByYyA9IHhjX2h5
cGVyY2FsbF9ib3VuY2VfcHJlKHhjaCwgbWV0YWRhdGFfbGVuKTsKKyAgICAgICAgaWYgKCByYyAp
CisgICAgICAgICAgICBicmVhazsKKwogICAgICAgICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNj
dGwudS5saXZlcGF0Y2gudS5saXN0LnN0YXR1cywgaW5mbyk7CiAgICAgICAgIHNldF94ZW5fZ3Vl
c3RfaGFuZGxlKHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZSwgbmFtZSk7CiAgICAgICAg
IHNldF94ZW5fZ3Vlc3RfaGFuZGxlKHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubGVuLCBsZW4p
OworICAgICAgICBzZXRfeGVuX2d1ZXN0X2hhbmRsZShzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0
Lm1ldGFkYXRhLCBtZXRhZGF0YSk7CisgICAgICAgIHNldF94ZW5fZ3Vlc3RfaGFuZGxlKHN5c2N0
bC51LmxpdmVwYXRjaC51Lmxpc3QubWV0YWRhdGFfbGVuLCBtZXRhZGF0YV9sZW4pOwogCiAgICAg
ICAgIHJjID0gZG9fc3lzY3RsKHhjaCwgJnN5c2N0bCk7CiAgICAgICAgIC8qCkBAIC04MzksNiAr
ODY4LDggQEAgaW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1
bnNpZ25lZCBpbnQgbWF4LAogICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhj
aCwgaW5mbyk7CiAgICAgICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBuYW1l
KTsKICAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGxlbik7CisgICAg
ICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBtZXRhZGF0YSk7CisgICAgICAg
ICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBtZXRhZGF0YV9sZW4pOwogICAgICAg
ICAgICAgY29udGludWU7CiAgICAgICAgIH0KICAgICAgICAgZWxzZSBpZiAoIHJjIDwgMCApIC8q
IEZvciBhbGwgb3RoZXIgZXJyb3JzIHdlIGJhaWwgb3V0LiAqLwpAQCAtODYzLDYgKzg5NCw4IEBA
IGludCB4Y19saXZlcGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQg
aW50IG1heCwKICAgICAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIGluZm8p
OwogICAgICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbmFtZSk7CiAgICAg
ICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBsZW4pOworICAgICAgICAgICAg
eGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGEpOworICAgICAgICAgICAgeGNf
aHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGFfbGVuKTsKICAgICAgICAgICAgIGNv
bnRpbnVlOwogICAgICAgICB9CiAKQEAgLTg3NSwxNyArOTA4LDI0IEBAIGludCB4Y19saXZlcGF0
Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgY29uc3QgdW5zaWduZWQgaW50IG1heCwKICAgICAg
ICAgfQogICAgICAgICAqbGVmdCA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubnI7IC8qIFRv
dGFsIHJlbWFpbmluZyBjb3VudC4gKi8KICAgICAgICAgX25hbWVfc3ogPSBzeXNjdGwudS5saXZl
cGF0Y2gudS5saXN0Lm5hbWVfdG90YWxfc2l6ZTsgLyogVG90YWwgcmVjZWl2ZWQgbmFtZSBzaXpl
LiAqLworICAgICAgICBfbWV0YWRhdGFfc3ogPSBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0Lm1l
dGFkYXRhX3RvdGFsX3NpemU7IC8qIFRvdGFsIHJlY2VpdmVkIG1ldGFkYXRhIHNpemUuICovCiAg
ICAgICAgIC8qIENvcHkgb25seSB1cCAncmMnIG9mIGRhdGEnIC0gd2UgY291bGQgYWRkICdtaW4o
cmMsbnIpIGlmIGRlc2lyZWQuICovCiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUo
aW5mbywgKHJjICogc2l6ZW9mKCppbmZvKSkpOwogICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NF
VF9TSVpFKG5hbWUsIF9uYW1lX3N6KTsKICAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0la
RShsZW4sIChyYyAqIHNpemVvZigqbGVuKSkpOworICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NF
VF9TSVpFKG1ldGFkYXRhLCBfbWV0YWRhdGFfc3opOworICAgICAgICBIWVBFUkNBTExfQk9VTkNF
X1NFVF9TSVpFKG1ldGFkYXRhX2xlbiwgKHJjICogc2l6ZW9mKCptZXRhZGF0YV9sZW4pKSk7CiAg
ICAgICAgIC8qIEJvdW5jZSB0aGUgZGF0YSBhbmQgZnJlZSB0aGUgYm91bmNlIGJ1ZmZlci4gKi8K
ICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgaW5mbyk7CiAgICAgICAgIHhj
X2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAgICB4Y19oeXBlcmNhbGxf
Ym91bmNlX3Bvc3QoeGNoLCBsZW4pOworICAgICAgICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3Qo
eGNoLCBtZXRhZGF0YSk7CisgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1l
dGFkYXRhX2xlbik7CiAKICAgICAgICAgbmFtZV9zeiAtPSBfbmFtZV9zejsKICAgICAgICAgbmFt
ZV9vZmYgKz0gX25hbWVfc3o7CisgICAgICAgIG1ldGFkYXRhX3N6IC09IF9tZXRhZGF0YV9zejsK
KyAgICAgICAgbWV0YWRhdGFfb2ZmICs9IF9tZXRhZGF0YV9zejsKIAogICAgICAgICAvKiBBbmQg
dXBkYXRlIGhvdyBtYW55IGVsZW1lbnRzIG9mIGluZm8gd2UgaGF2ZSBjb3BpZWQgaW50by4gKi8K
ICAgICAgICAgKmRvbmUgKz0gcmM7CkBAIC04OTgsNiArOTM4LDggQEAgaW50IHhjX2xpdmVwYXRj
aF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4LAogICAgICAg
ICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBsZW4pOwogICAgICAgICB4Y19oeXBlcmNh
bGxfYm91bmNlX3Bvc3QoeGNoLCBuYW1lKTsKICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9w
b3N0KHhjaCwgaW5mbyk7CisgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG1l
dGFkYXRhKTsKKyAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgbWV0YWRhdGFf
bGVuKTsKICAgICB9CiAKICAgICByZXR1cm4gcmMgPiAwID8gMCA6IHJjOwpkaWZmIC0tZ2l0IGEv
dG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMgYi90b29scy9taXNjL3hlbi1saXZlcGF0Y2guYwpp
bmRleCBjOTNjNTAwNDBjLi4xNmE0YTQ3YWI3IDEwMDY0NAotLS0gYS90b29scy9taXNjL3hlbi1s
aXZlcGF0Y2guYworKysgYi90b29scy9taXNjL3hlbi1saXZlcGF0Y2guYwpAQCAtNjksOCArNjks
MTAgQEAgc3RhdGljIGludCBsaXN0X2Z1bmMoaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKICAgICB1
bnNpZ25lZCBpbnQgbnIsIGRvbmUsIGxlZnQsIGk7CiAgICAgeGVuX2xpdmVwYXRjaF9zdGF0dXNf
dCAqaW5mbyA9IE5VTEw7CiAgICAgY2hhciAqbmFtZSA9IE5VTEw7CisgICAgY2hhciAqbWV0YWRh
dGEgPSBOVUxMOwogICAgIHVpbnQzMl90ICpsZW4gPSBOVUxMOwotICAgIHVpbnQzMl90IG5hbWVf
dG90YWxfc2l6ZSwgbmFtZV9vZmY7CisgICAgdWludDMyX3QgKm1ldGFkYXRhX2xlbiA9IE5VTEw7
CisgICAgdWludDMyX3QgbmFtZV90b3RhbF9zaXplLCBtZXRhZGF0YV90b3RhbF9zaXplLCBuYW1l
X29mZiwgbWV0YWRhdGFfb2ZmOwogICAgIGludCByYyA9IEVOT01FTTsKIAogICAgIGlmICggYXJn
YyApCkBAIC04MCw3ICs4Miw3IEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFy
ICphcmd2W10pCiAgICAgfQogICAgIGRvbmUgPSBsZWZ0ID0gMDsKIAotICAgIHJjID0geGNfbGl2
ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjaCwgJm5yLCAmbmFtZV90b3RhbF9zaXplKTsKKyAgICBy
YyA9IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y2gsICZuciwgJm5hbWVfdG90YWxfc2l6
ZSwgJm1ldGFkYXRhX3RvdGFsX3NpemUpOwogICAgIGlmICggcmMgKQogICAgIHsKICAgICAgICAg
cmMgPSBlcnJubzsKQEAgLTEwOCwxMiArMTEwLDIzIEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGlu
dCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgaWYgKCAhbGVuICkKICAgICAgICAgZ290byBlcnJv
cl9sZW47CiAKKyAgICBtZXRhZGF0YSA9IG1hbGxvYyhtZXRhZGF0YV90b3RhbF9zaXplICogc2l6
ZW9mKCptZXRhZGF0YSkgKyAxKTsKKyAgICBpZiAoICFtZXRhZGF0YSApCisgICAgICAgIGdvdG8g
ZXJyb3JfbWV0YWRhdGE7CisKKyAgICBtZXRhZGF0YV9sZW4gPSBtYWxsb2MobnIgKiBzaXplb2Yo
Km1ldGFkYXRhX2xlbikpOworICAgIGlmICggIW1ldGFkYXRhX2xlbiApCisgICAgICAgIGdvdG8g
ZXJyb3JfbWV0YWRhdGFfbGVuOworCiAgICAgbWVtc2V0KGluZm8sICdBJywgbnIgKiBzaXplb2Yo
KmluZm8pKTsKICAgICBtZW1zZXQobmFtZSwgJ0InLCBuYW1lX3RvdGFsX3NpemUgKiBzaXplb2Yo
Km5hbWUpKTsKICAgICBtZW1zZXQobGVuLCAnQycsIG5yICogc2l6ZW9mKCpsZW4pKTsKLSAgICBu
YW1lX29mZiA9IDA7CisgICAgbWVtc2V0KG1ldGFkYXRhLCAnRCcsIG1ldGFkYXRhX3RvdGFsX3Np
emUgKiBzaXplb2YoKm1ldGFkYXRhKSArIDEpOworICAgIG1lbXNldChtZXRhZGF0YV9sZW4sICdF
JywgbnIgKiBzaXplb2YoKm1ldGFkYXRhX2xlbikpOworICAgIG5hbWVfb2ZmID0gbWV0YWRhdGFf
b2ZmID0gMDsKIAotICAgIHJjID0geGNfbGl2ZXBhdGNoX2xpc3QoeGNoLCBuciwgMCwgaW5mbywg
bmFtZSwgbGVuLCBuYW1lX3RvdGFsX3NpemUsICZkb25lLCAmbGVmdCk7CisgICAgcmMgPSB4Y19s
aXZlcGF0Y2hfbGlzdCh4Y2gsIG5yLCAwLCBpbmZvLCBuYW1lLCBsZW4sIG5hbWVfdG90YWxfc2l6
ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLCBtZXRhZGF0YV9sZW4sIG1l
dGFkYXRhX3RvdGFsX3NpemUsICZkb25lLCAmbGVmdCk7CiAgICAgaWYgKCByYyB8fCBkb25lICE9
IG5yIHx8IGxlZnQgPiAwKQogICAgIHsKICAgICAgICAgcmMgPSBlcnJubzsKQEAgLTEyMywyMyAr
MTM2LDM1IEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiAg
ICAgICAgIGdvdG8gZXJyb3I7CiAgICAgfQogCi0gICAgZnByaW50ZihzdGRvdXQsIiBJRCAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IHN0YXR1c1xuIgotICAgICAgICAgICAg
ICAgICAgICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0t
LS0tLVxuIik7CisgICAgZnByaW50ZihzdGRvdXQsIiBJRCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8IHN0YXR1cyAgICAgfCBtZXRhZGF0YVxuIgorICAgICAgICAgICAgICAg
ICAgICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0t
LSstLS0tLS0tLS0tLS0tLS1cbiIpOwogCiAgICAgZm9yICggaSA9IDA7IGkgPCBkb25lOyBpKysg
KQogICAgIHsKKyAgICAgICAgdW5zaWduZWQgaW50IGo7CiAgICAgICAgIGNoYXIgKm5hbWVfc3Ry
ID0gbmFtZSArIG5hbWVfb2ZmOworICAgICAgICBjaGFyICptZXRhZGF0YV9zdHIgPSBtZXRhZGF0
YSArIG1ldGFkYXRhX29mZjsKIAogICAgICAgICBwcmludGYoIiUtNDAuKnN8ICVzIiwgbGVuW2ld
LCBuYW1lX3N0ciwgc3RhdGUyc3RyKGluZm9baV0uc3RhdGUpKTsKICAgICAgICAgaWYgKCBpbmZv
W2ldLnJjICkKLSAgICAgICAgICAgIHByaW50ZigiICglZCwgJXMpXG4iLCAtaW5mb1tpXS5yYywg
c3RyZXJyb3IoLWluZm9baV0ucmMpKTsKKyAgICAgICAgICAgIHByaW50ZigiICglZCwgJXMpICAg
IHwgIiwgLWluZm9baV0ucmMsIHN0cmVycm9yKC1pbmZvW2ldLnJjKSk7CiAgICAgICAgIGVsc2UK
LSAgICAgICAgICAgIHB1dHMoIiIpOworICAgICAgICAgICAgcHJpbnRmKCIgICAgfCAiKTsKKwor
ICAgICAgICAvKiBSZXBsYWNlIGFsbCAnXDAnIHdpdGggc2VtaS1jb2xvbnMuICovCisgICAgICAg
IGZvciAoIGogPSAwOyBtZXRhZGF0YV9sZW5baV0gJiYgaiA8IG1ldGFkYXRhX2xlbltpXSAtIDE7
IGorKyApCisgICAgICAgICAgICBtZXRhZGF0YV9zdHJbal0gPSAobWV0YWRhdGFfc3RyW2pdID86
ICc7Jyk7CisgICAgICAgIHByaW50ZigiJS4qc1xuIiwgbWV0YWRhdGFfbGVuW2ldLCBtZXRhZGF0
YV9zdHIpOwogCiAgICAgICAgIG5hbWVfb2ZmICs9IGxlbltpXTsKKyAgICAgICAgbWV0YWRhdGFf
b2ZmICs9IG1ldGFkYXRhX2xlbltpXTsKICAgICB9CiAKIGVycm9yOgorICAgIGZyZWUobWV0YWRh
dGFfbGVuKTsKK2Vycm9yX21ldGFkYXRhX2xlbjoKKyAgICBmcmVlKG1ldGFkYXRhKTsKK2Vycm9y
X21ldGFkYXRhOgogICAgIGZyZWUobGVuKTsKIGVycm9yX2xlbjoKICAgICBmcmVlKG5hbWUpOwpk
aWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9saXZlcGF0Y2guYyBiL3hlbi9jb21tb24vbGl2ZXBhdGNo
LmMKaW5kZXggYmM2NDMyOTVkNi4uMmE4YWIxMzg3OSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9s
aXZlcGF0Y2guYworKysgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCkBAIC0xMTU5LDkgKzExNTks
MTMgQEAgc3RhdGljIGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0
Y2hfbGlzdCAqbGlzdCkKICAgICBpZiAoIGxpc3QtPm5yID4gMTAyNCApCiAgICAgICAgIHJldHVy
biAtRTJCSUc7CiAKKyAgICBpZiAoIGxpc3QtPnBhZCApCisgICAgICAgIHJldHVybiAtRUlOVkFM
OworCiAgICAgaWYgKCBsaXN0LT5uciAmJgogICAgICAgICAgKCFndWVzdF9oYW5kbGVfb2theShs
aXN0LT5zdGF0dXMsIGxpc3QtPm5yKSB8fAotICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShs
aXN0LT5sZW4sIGxpc3QtPm5yKSkgKQorICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShsaXN0
LT5sZW4sIGxpc3QtPm5yKSB8fAorICAgICAgICAgICFndWVzdF9oYW5kbGVfb2theShsaXN0LT5t
ZXRhZGF0YV9sZW4sIGxpc3QtPm5yKSkgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAogICAg
IHNwaW5fbG9jaygmcGF5bG9hZF9sb2NrKTsKQEAgLTExNzIsMTMgKzExNzYsMTQgQEAgc3RhdGlj
IGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlz
dCkKICAgICB9CiAKICAgICBsaXN0LT5uYW1lX3RvdGFsX3NpemUgPSAwOworICAgIGxpc3QtPm1l
dGFkYXRhX3RvdGFsX3NpemUgPSAwOwogICAgIGlmICggbGlzdC0+bnIgKQogICAgIHsKLSAgICAg
ICAgdWludDY0X3QgbmFtZV9vZmZzZXQgPSAwOworICAgICAgICB1aW50NjRfdCBuYW1lX29mZnNl
dCA9IDAsIG1ldGFkYXRhX29mZnNldCA9IDA7CiAKICAgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRy
eSggZGF0YSwgJnBheWxvYWRfbGlzdCwgbGlzdCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHVp
bnQzMl90IG5hbWVfbGVuOworICAgICAgICAgICAgdWludDMyX3QgbmFtZV9sZW4sIG1ldGFkYXRh
X2xlbjsKIAogICAgICAgICAgICAgaWYgKCBsaXN0LT5pZHggPiBpKysgKQogICAgICAgICAgICAg
ICAgIGNvbnRpbnVlOwpAQCAtMTE4OSw4ICsxMTk0LDEzIEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNo
X2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAgICAgICAgICAg
ICBuYW1lX2xlbiA9IHN0cmxlbihkYXRhLT5uYW1lKSArIDE7CiAgICAgICAgICAgICBsaXN0LT5u
YW1lX3RvdGFsX3NpemUgKz0gbmFtZV9sZW47CiAKKyAgICAgICAgICAgIG1ldGFkYXRhX2xlbiA9
IGRhdGEtPm1ldGFkYXRhLmxlbjsKKyAgICAgICAgICAgIGxpc3QtPm1ldGFkYXRhX3RvdGFsX3Np
emUgKz0gbWV0YWRhdGFfbGVuOworCiAgICAgICAgICAgICBpZiAoICFndWVzdF9oYW5kbGVfc3Vi
cmFuZ2Vfb2theShsaXN0LT5uYW1lLCBuYW1lX29mZnNldCwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVfb2Zmc2V0ICsgbmFtZV9sZW4gLSAxKSApCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lX29mZnNldCAr
IG5hbWVfbGVuIC0gMSkgfHwKKyAgICAgICAgICAgICAgICAgIWd1ZXN0X2hhbmRsZV9zdWJyYW5n
ZV9va2F5KGxpc3QtPm1ldGFkYXRhLCBtZXRhZGF0YV9vZmZzZXQsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YV9vZmZzZXQgKyBtZXRhZGF0YV9s
ZW4gLSAxKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSAtRUlOVkFMOwog
ICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTIwMCw3ICsxMjEwLDEwIEBAIHN0YXRpYyBpbnQg
bGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAg
ICAgICAgICAgICBpZiAoIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bmFtZSwgbmFtZV9v
ZmZzZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS0+bmFt
ZSwgbmFtZV9sZW4pIHx8CiAgICAgICAgICAgICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChs
aXN0LT5sZW4sIGlkeCwgJm5hbWVfbGVuLCAxKSB8fAotICAgICAgICAgICAgICAgIF9fY29weV90
b19ndWVzdF9vZmZzZXQobGlzdC0+c3RhdHVzLCBpZHgsICZzdGF0dXMsIDEpICkKKyAgICAgICAg
ICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPnN0YXR1cywgaWR4LCAmc3RhdHVz
LCAxKSB8fAorICAgICAgICAgICAgICAgIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bWV0
YWRhdGEsIG1ldGFkYXRhX29mZnNldCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRhdGEtPm1ldGFkYXRhLmRhdGEsIG1ldGFkYXRhX2xlbikgfHwKKyAgICAgICAgICAg
ICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm1ldGFkYXRhX2xlbiwgaWR4LCAmbWV0
YWRhdGFfbGVuLCAxKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSAtRUZB
VUxUOwogICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTIwOCw2ICsxMjIxLDcgQEAgc3RhdGlj
IGludCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlz
dCkKIAogICAgICAgICAgICAgaWR4Kys7CiAgICAgICAgICAgICBuYW1lX29mZnNldCArPSBuYW1l
X2xlbjsKKyAgICAgICAgICAgIG1ldGFkYXRhX29mZnNldCArPSBtZXRhZGF0YV9sZW47CiAKICAg
ICAgICAgICAgIGlmICggKGlkeCA+PSBsaXN0LT5ucikgfHwgaHlwZXJjYWxsX3ByZWVtcHRfY2hl
Y2soKSApCiAgICAgICAgICAgICAgICAgYnJlYWs7CkBAIC0xMjE4LDYgKzEyMzIsNyBAQCBzdGF0
aWMgaW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICps
aXN0KQogICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KCBkYXRhLCAmcGF5bG9hZF9saXN0LCBs
aXN0ICkKICAgICAgICAgewogICAgICAgICAgICAgbGlzdC0+bmFtZV90b3RhbF9zaXplICs9IHN0
cmxlbihkYXRhLT5uYW1lKSArIDE7CisgICAgICAgICAgICBsaXN0LT5tZXRhZGF0YV90b3RhbF9z
aXplICs9IGRhdGEtPm1ldGFkYXRhLmxlbjsKICAgICAgICAgfQogICAgIH0KICAgICBsaXN0LT5u
ciA9IHBheWxvYWRfY250IC0gaTsgLyogUmVtYWluaW5nIGFtb3VudC4gKi8KZGlmZiAtLWdpdCBh
L3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCBiL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwu
aAppbmRleCA0YmZkMTQ3NWJmLi43ZTQzYmZlMWJkIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9w
dWJsaWMvc3lzY3RsLmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oCkBAIC05MzQs
MTYgKzkzNCwxNyBAQCBzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfZ2V0IHsKIH07CiAKIC8q
Ci0gKiBSZXRyaWV2ZSBhbiBhcnJheSBvZiBhYmJyZXZpYXRlZCBzdGF0dXMgYW5kIG5hbWVzIG9m
IHBheWxvYWRzIHRoYXQgYXJlCi0gKiBsb2FkZWQgaW4gdGhlIGh5cGVydmlzb3IuCisgKiBSZXRy
aWV2ZSBhbiBhcnJheSBvZiBhYmJyZXZpYXRlZCBzdGF0dXMsIG5hbWVzIGFuZCBtZXRhZGF0YSBv
ZiBwYXlsb2FkcyB0aGF0CisgKiBhcmUgbG9hZGVkIGluIHRoZSBoeXBlcnZpc29yLgogICoKICAq
IElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBhbiBwb3NpdGl2ZSBudW1iZXIsIGl0IGlzIHRoZSBu
dW1iZXIgKHVwIHRvIGBucmApCiAgKiBvZiB0aGUgcGF5bG9hZHMgcmV0dXJuZWQsIGFsb25nIHdp
dGggYG5yYCB1cGRhdGVkIHdpdGggdGhlIG51bWJlciBvZiByZW1haW5pbmcKICAqIHBheWxvYWRz
LCBgdmVyc2lvbmAgdXBkYXRlZCAoaXQgbWF5IGJlIHRoZSBzYW1lIGFjcm9zcyBoeXBlcmNhbGxz
LiBJZiBpdCB2YXJpZXMKLSAqIHRoZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNv
dWxkIGZhaWwpIGFuZCB0aGUgbmFtZV90b3RhbF9zaXplCi0gKiBjb250YWluaW5nIHRvdGFsIHNp
emUgb2YgdHJhbnNmZXJyZWQgZGF0YSBmb3IgdGhlIGFycmF5LgotICogVGhlIGBzdGF0dXNgLCBg
bmFtZWAsIGBsZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4IHZhbHVlIChg
aWR4YCkKLSAqIHdpdGggdGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCisgKiB0aGUgZGF0YSBp
cyBzdGFsZSBhbmQgZnVydGhlciBjYWxscyBjb3VsZCBmYWlsKSwgYG5hbWVfdG90YWxfc2l6ZWAg
YW5kCisgKiBgbWV0YWRhdGFfdG90YWxfc2l6ZWAgY29udGFpbmluZyB0b3RhbCBzaXplcyBvZiB0
cmFuc2ZlcnJlZCBkYXRhIGZvciBib3RoIHRoZQorICogYXJyYXlzLgorICogVGhlIGBzdGF0dXNg
LCBgbmFtZWAsIGBsZW5gLCBgbWV0YWRhdGFgIGFuZCBgbWV0YWRhdGFfbGVuYCBhcmUgdXBkYXRl
ZCBhdCB0aGVpcgorICogZGVzaWduZWQgaW5kZXggdmFsdWUgKGBpZHhgKSB3aXRoIHRoZSByZXR1
cm5lZCB2YWx1ZSBvZiBkYXRhLgogICoKICAqIElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBFMkJJ
RyB0aGUgYG5yYCBpcyB0b28gYmlnIGFuZCBzaG91bGQgYmUKICAqIGxvd2VyZWQuIFRoZSB1cHBl
ciBsaW1pdCBvZiBgbnJgIGlzIGxlZnQgdG8gdGhlIGltcGxlbWVudGlvbi4KQEAgLTk2NSw3ICs5
NjYsOSBAQCBzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZCBmaWxsIG91dC4gQ2FuIGJl
IHplcm8gdG8gZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGFtb3VudCBvZiBwYXlsb2FkcyBhbmQgdmVyc2lvbi4KICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgT1VUOiBIb3cgbWFueSBwYXlsb2FkcyBsZWZ0LiAq
LworICAgIHVpbnQzMl90IHBhZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBJTjogTXVz
dCBiZSB6ZXJvLiAqLwogICAgIHVpbnQzMl90IG5hbWVfdG90YWxfc2l6ZTsgICAgICAgICAgICAg
ICAvKiBPVVQ6IFRvdGFsIHNpemUgb2YgYWxsIHRyYW5zZmVyIG5hbWVzICovCisgICAgdWludDMy
X3QgbWV0YWRhdGFfdG90YWxfc2l6ZTsgICAgICAgICAgIC8qIE9VVDogVG90YWwgc2l6ZSBvZiBh
bGwgdHJhbnNmZXIgbWV0YWRhdGEgKi8KICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHhlbl9saXZl
cGF0Y2hfc3RhdHVzX3QpIHN0YXR1czsgIC8qIE9VVC4gTXVzdCBoYXZlIGVub3VnaAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFjZSBhbGxvY2F0ZSBm
b3IgbnIgb2YgdGhlbS4gKi8KICAgICBYRU5fR1VFU1RfSEFORExFXzY0KGNoYXIpIG5hbWU7ICAg
ICAgICAgLyogT1VUOiBBcnJheSBvZiBuYW1lcy4gRWFjaCBtZW1iZXIKQEAgLTk3NCw2ICs5Nzcs
MTEgQEAgc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgewogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuciBvZiB0aGVtLiAqLwogICAgIFhFTl9H
VUVTVF9IQU5ETEVfNjQodWludDMyKSBsZW47ICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIGxlbmd0
aHMgb2YgbmFtZSdzLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KKyAgICBYRU5fR1VFU1RfSEFORExFXzY0KGNo
YXIpIG1ldGFkYXRhOyAgICAgLyogT1VUOiBBcnJheSBvZiBtZXRhZGF0YSBzdHJpbmdzLiBFYWNo
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlciBt
YXkgaGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoLgorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8KKyAgICBYRU5fR1VF
U1RfSEFORExFXzY0KHVpbnQzMikgbWV0YWRhdGFfbGVuOyAgLyogT1VUOiBBcnJheSBvZiBsZW5n
dGhzIG9mIG1ldGFkYXRhJ3MuCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLwogfTsKIAogLyoKLS0gCjIuMTYu
NQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdtYkgKS3JhdXNlbnN0ci4g
MzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0aWFuIFNjaGxhZWdlciwg
UmFsZiBIZXJicmljaApFaW5nZXRyYWdlbiBhbSBBbXRzZ2VyaWNodCBDaGFybG90dGVuYnVyZyB1
bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVzdC1JRDogREUgMjg5IDIzNyA4NzkKCgoK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZl
bCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlz
dHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

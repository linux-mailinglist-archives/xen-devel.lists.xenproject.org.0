Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6DEFEC1135
	for <lists+xen-devel@lfdr.de>; Sat, 28 Sep 2019 17:20:21 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEETT-0001em-OZ; Sat, 28 Sep 2019 15:17:31 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=eHhM=XX=amazon.de=prvs=1678a297b=wipawel@srs-us1.protection.inumbo.net>)
 id 1iEETS-0001eV-O8
 for xen-devel@lists.xenproject.org; Sat, 28 Sep 2019 15:17:30 +0000
X-Inumbo-ID: 160d2d99-e203-11e9-969c-12813bfff9fa
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by localhost (Halon) with ESMTPS
 id 160d2d99-e203-11e9-969c-12813bfff9fa;
 Sat, 28 Sep 2019 15:17:30 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1569683850; x=1601219850;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=YQG0uIqpzSb+8mkH29tHLz7NO9hclm49VwNWGgfzauw=;
 b=EkKfsWzB4PXXWloVdgcSanuFJwHyaGWBdDzLD357TjysV3zuezV6XG42
 5nmbeYWKrtRKDZ99LJyQP49VjAtPFZufTWokgApUJUtnHolGaTH1a72wC
 02Xw8ABXpwD5Ulvg1tkRNzp7qZeNv+qjdJvoTzfiY751WV0XKp4XEOz5t A=;
X-IronPort-AV: E=Sophos;i="5.64,559,1559520000"; d="scan'208";a="705176535"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-1a-7d76a15f.us-east-1.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 28 Sep 2019 15:14:20 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1a-7d76a15f.us-east-1.amazon.com (Postfix) with ESMTPS
 id C98F8A24F4; Sat, 28 Sep 2019 15:14:00 +0000 (UTC)
Received: from EX13D05EUC001.ant.amazon.com (10.43.164.118) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:13:50 +0000
Received: from EX13MTAUWB001.ant.amazon.com (10.43.161.207) by
 EX13D05EUC001.ant.amazon.com (10.43.164.118) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:13:48 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.161.249) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Sat, 28 Sep 2019 15:13:45 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Sat, 28 Sep 2019 15:13:00 +0000
Message-ID: <20190928151305.127380-8-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190928151305.127380-1-wipawel@amazon.de>
References: <20190928151305.127380-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v4 07/12] livepatch: Add per-function
 applied/reverted state tracking marker
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TGl2ZXBhdGNoIG9ubHkgdHJhY2tzIGFuIGVudGlyZSBwYXlsb2FkIGFwcGxpZWQvcmV2ZXJ0ZWQg
c3RhdGUuIEJ1dCwKd2l0aCBhbiBvcHRpb24gdG8gc3VwcGx5IHRoZSBhcHBseV9wYXlsb2FkKCkg
YW5kL29yIHJldmVydF9wYXlsb2FkKCkKZnVuY3Rpb25zIGFzIG9wdGlvbmFsIGhvb2tzLCBpdCBi
ZWNvbWVzIHBvc3NpYmxlIHRvIGludGVybWl4IHRoZQpleGVjdXRpb24gb2YgdGhlIG9yaWdpbmFs
IGFwcGx5X3BheWxvYWQoKS9yZXZlcnRfcGF5bG9hZCgpIGZ1bmN0aW9ucwp3aXRoIHRoZWlyIGR5
bmFtaWNhbGx5IHN1cHBsaWVkIGNvdW50ZXJwYXJ0cy4KSXQgaXMgaW1wb3J0YW50IHRoZW4gdG8g
dHJhY2sgdGhlIGN1cnJlbnQgc3RhdGUgb2YgZXZlcnkgZnVuY3Rpb24KYmVpbmcgcGF0Y2hlZCBh
bmQgcHJldmVudCBzaXR1YXRpb25zIG9mIHVuaW50ZW50aW9uYWwgZG91YmxlLWFwcGx5Cm9yIHVu
YXBwbGllZCByZXZlcnQuCgpUbyBzdXBwb3J0IHRoYXQsIGl0IGlzIG5lY2Vzc2FyeSB0byBleHRl
bmQgcHVibGljIGludGVyZmFjZSBvZiB0aGUKbGl2ZXBhdGNoLiBUaGUgc3RydWN0IGxpdmVwYXRj
aF9mdW5jIGdldHMgYWRkaXRpb25hbCBmaWVsZCBob2xkaW5nCnRoZSBhcHBsaWVkL3JldmVydGVk
IHN0YXRlIG1hcmtlci4KClRvIHJlZmxlY3QgdGhlIGxpdmVwYXRjaCBwYXlsb2FkIEFCSSBjaGFu
Z2UsIGJ1bXAgdGhlIHZlcnNpb24gZmxhZwpMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OIHVwIHRv
IDIuCgpbQW5kIGFsc28gdXBkYXRlIHRoZSB0b3Agb2YgdGhlIGRlc2lnbiBkb2N1bWVudF0KClNp
Z25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpvbi5kZT4KUmV2
aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9uLmNvbT4KUmV2
aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBN
YXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5OiBLb25yYWQg
Unplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+CkFja2VkLWJ5OiBKdWxpZW4g
R3JhbGwgPGp1bGllbi5ncmFsbEBhcm0uY29tPgotLS0KQ2hhbmdlZCBzaW5jZSB2MzoKICAqIFVz
ZSBjb21tb25fbGl2ZXBhdGNoX3thcHBseSxyZXZlcnR9IGluc3RlYWQgb2YgbW9kaWZ5aW5nCiAg
ICBhcmNoX2xpdmVwYXRjaF97YXBwbHkscmV2ZXJ0fS4KICAqIHMvYm9vbF90L2Jvb2wvZwoKQ2hh
bmdlZCBzaW5jZSB2MjoKICAqIERvY3VtZW50YXRpb24gZml4ZXMKCkNoYW5nZWQgc2luY2UgdjE6
CiAgKiBzdXBwb3J0IHRoZSBmZWF0dXJlIGZvciBhbGwgYXJjaCAoYWRkIGhhbmRsaW5nIGZvciBB
cm0pCiAgKiBhZGQgY29tbW9uIGlzX2Z1bmNfYXBwbGllZCgpIGFuZCBpc19mdW5jX3JldmVydGVk
KCkgdG8gYmUKICAgIHVzZWQgYnkgYWxsIGFyY2gKICAqIHJlbW92ZSBleHBsaWNpdCBlbnVtIHZh
bHVlcyBmcm9tIGVudW0gbGl2ZXBhdGNoX2Z1bmNfc3RhdGUKICAqIGFkZGVkIGNvcnJlc3BvbmRp
bmcgZG9jdW1lbnRhdGlvbgogICogYWRkZWQgdGVzdHMKCiBkb2NzL21pc2MvbGl2ZXBhdGNoLnBh
bmRvYyAgICAgICAgICAgICAgICAgICAgIHwgIDE3ICsrLQogeGVuL2NvbW1vbi9saXZlcGF0Y2gu
YyAgICAgICAgICAgICAgICAgICAgICAgICB8ICAzOSArKysrKystCiB4ZW4vaW5jbHVkZS9wdWJs
aWMvc3lzY3RsLmggICAgICAgICAgICAgICAgICAgIHwgICA5ICstCiB4ZW4vaW5jbHVkZS94ZW4v
bGl2ZXBhdGNoLmggICAgICAgICAgICAgICAgICAgIHwgIDI4ICsrKysrCiB4ZW4vdGVzdC9saXZl
cGF0Y2gvTWFrZWZpbGUgICAgICAgICAgICAgICAgICAgIHwgIDI3ICsrKystCiB4ZW4vdGVzdC9s
aXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rcy5jICAgICAgICAgIHwgICAyICsKIHhlbi90ZXN0L2xp
dmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzX21hcmtlci5jICAgfCAxMTIgKysrKysrKysrKysrKysr
KysrKwogeGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3Nfbm9hcHBseS5jICB8IDEz
NiArKysrKysrKysrKysrKysrKysrKysrKwogeGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25f
aG9va3Nfbm9yZXZlcnQuYyB8IDE0MyArKysrKysrKysrKysrKysrKysrKysrKysrCiA5IGZpbGVz
IGNoYW5nZWQsIDUwNyBpbnNlcnRpb25zKCspLCA2IGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUg
MTAwNjQ0IHhlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzX21hcmtlci5jCiBjcmVh
dGUgbW9kZSAxMDA2NDQgeGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3Nfbm9hcHBs
eS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgeGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9v
a3Nfbm9yZXZlcnQuYwoKZGlmZiAtLWdpdCBhL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jIGIv
ZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MKaW5kZXggZTZjMjE4Y2NmNy4uYjlhMzdjYTcxNyAx
MDA2NDQKLS0tIGEvZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MKKysrIGIvZG9jcy9taXNjL2xp
dmVwYXRjaC5wYW5kb2MKQEAgLTEsNCArMSw0IEBACi0jIFhlbiBMaXZlIFBhdGNoaW5nIERlc2ln
biB2MQorIyBYZW4gTGl2ZSBQYXRjaGluZyBEZXNpZ24gdjIKIAogIyMgUmF0aW9uYWxlCiAKQEAg
LTI5NywxMCArMjk3LDE0IEBAIHdoaWNoIGRlc2NyaWJlIHRoZSBmdW5jdGlvbnMgdG8gYmUgcGF0
Y2hlZDoKICAgICAgICAgdWludDMyX3Qgb2xkX3NpemU7CiAgICAgICAgIHVpbnQ4X3QgdmVyc2lv
bjsKICAgICAgICAgdWludDhfdCBvcGFxdWVbMzFdOworICAgICAgICAvKiBBZGRlZCB0byBsaXZl
cGF0Y2ggcGF5bG9hZCB2ZXJzaW9uIDI6ICovCisgICAgICAgIHVpbnQ4X3QgYXBwbGllZDsKKyAg
ICAgICAgdWludDhfdCBfcGFkWzddOwogICAgIH07CiAKIFRoZSBzaXplIG9mIHRoZSBzdHJ1Y3R1
cmUgaXMgNjQgYnl0ZXMgb24gNjQtYml0IGh5cGVydmlzb3JzLiBJdCB3aWxsIGJlCiA1MiBvbiAz
Mi1iaXQgaHlwZXJ2aXNvcnMuCitUaGUgdmVyc2lvbiAyIG9mIHRoZSBwYXlsb2FkIGFkZHMgYWRk
aXRpb25hbCA4IGJ5dGVzIHRvIHRoZSBzdHJ1Y3R1cmUgc2l6ZS4KIAogICogYG5hbWVgIGlzIHRo
ZSBzeW1ib2wgbmFtZSBvZiB0aGUgb2xkIGZ1bmN0aW9uLiBPbmx5IHVzZWQgaWYgYG9sZF9hZGRy
YCBpcwogICAgemVybywgb3RoZXJ3aXNlIHdpbGwgYmUgdXNlZCBkdXJpbmcgZHluYW1pYyBsaW5r
aW5nICh3aGVuIGh5cGVydmlzb3IgbG9hZHMKQEAgLTMyNCw5ICszMjgsMTUgQEAgVGhlIHNpemUg
b2YgdGhlIHN0cnVjdHVyZSBpcyA2NCBieXRlcyBvbiA2NC1iaXQgaHlwZXJ2aXNvcnMuIEl0IHdp
bGwgYmUKICAgICogSWYgdGhlIHZhbHVlIG9mIGBuZXdfYWRkcmAgaXMgemVybyB0aGVuIGBuZXdf
c2l6ZWAgZGV0ZXJtaW5lcyBob3cgbWFueQogICAgIGluc3RydWN0aW9uIGJ5dGVzIHRvIE5PUCAo
dXAgdG8gb3BhcXVlIHNpemUgbW9kdWxvIHNtYWxsZXN0IHBsYXRmb3JtCiAgICAgaW5zdHJ1Y3Rp
b24gLSAxIGJ5dGUgeDg2IGFuZCA0IGJ5dGVzIG9uIEFSTSkuCi0gKiBgdmVyc2lvbmAgaXMgdG8g
YmUgb25lLgorICogYHZlcnNpb25gIGluZGljYXRlcyB2ZXJzaW9uIG9mIHRoZSBnZW5lcmF0ZWQg
cGF5bG9hZC4KICAqIGBvcGFxdWVgICoqTVVTVCoqIGJlIHplcm8uCiAKK1RoZSB2ZXJzaW9uIDIg
b2YgdGhlIHBheWxvYWQgYWRkcyB0aGUgZm9sbG93aW5nIGZpZWxkcyB0byB0aGUgc3RydWN0dXJl
OgorCisgICogYGFwcGxpZWRgIHRyYWNrcyBmdW5jdGlvbidzIGFwcGxpZWQvcmV2ZXJ0ZWQgc3Rh
dGUuIEl0IGhhcyBhIGJvb2xlYW4gdHlwZQorICAgIGVpdGhlciBMSVZFUEFUQ0hfRlVOQ19OT1Rf
QVBQTElFRCBvciBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVELgorICAqIGBfcGFkWzddYCBhZGRzIHBh
ZGRpbmcgdG8gYWxpZ24gdG8gOCBieXRlcy4KKwogVGhlIHNpemUgb2YgdGhlIGBsaXZlcGF0Y2hf
ZnVuY2AgYXJyYXkgaXMgZGV0ZXJtaW5lZCBmcm9tIHRoZSBFTEYgc2VjdGlvbgogc2l6ZS4KIApA
QCAtMzc4LDYgKzM4OCw5IEBAIEEgc2ltcGxlIGV4YW1wbGUgb2Ygd2hhdCBhIHBheWxvYWQgZmls
ZSBjYW4gYmU6CiAgICAgICAgIHVpbnQzMl90IG9sZF9zaXplOwogICAgICAgICB1aW50OF90IHZl
cnNpb247CiAgICAgICAgIHVpbnQ4X3QgcGFkWzMxXTsKKyAgICAgICAgLyogQWRkZWQgdG8gbGl2
ZXBhdGNoIHBheWxvYWQgdmVyc2lvbiAyOiAqLworICAgICAgICB1aW50OF90IGFwcGxpZWQ7Cisg
ICAgICAgIHVpbnQ4X3QgX3BhZFs3XTsKICAgICB9OwogCiAgICAgLyogT3VyIHJlcGxhY2VtZW50
IGZ1bmN0aW9uIGZvciB4ZW5fZXh0cmFfdmVyc2lvbi4gKi8KZGlmZiAtLWdpdCBhL3hlbi9jb21t
b24vbGl2ZXBhdGNoLmMgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCmluZGV4IGM3MGZkNWY2MDAu
LmQyMDE0NzliNDIgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKKysrIGIveGVu
L2NvbW1vbi9saXZlcGF0Y2guYwpAQCAtMTE3NCw3ICsxMTc0LDcgQEAgc3RhdGljIGludCBhcHBs
eV9wYXlsb2FkKHN0cnVjdCBwYXlsb2FkICpkYXRhKQogICAgIEFTU0VSVCghbG9jYWxfaXJxX2lz
X2VuYWJsZWQoKSk7CiAKICAgICBmb3IgKCBpID0gMDsgaSA8IGRhdGEtPm5mdW5jczsgaSsrICkK
LSAgICAgICAgYXJjaF9saXZlcGF0Y2hfYXBwbHkoJmRhdGEtPmZ1bmNzW2ldKTsKKyAgICAgICAg
Y29tbW9uX2xpdmVwYXRjaF9hcHBseSgmZGF0YS0+ZnVuY3NbaV0pOwogCiAgICAgYXJjaF9saXZl
cGF0Y2hfcmV2aXZlKCk7CiAKQEAgLTEyMDgsNyArMTIwOCw3IEBAIHN0YXRpYyBpbnQgcmV2ZXJ0
X3BheWxvYWQoc3RydWN0IHBheWxvYWQgKmRhdGEpCiAgICAgfQogCiAgICAgZm9yICggaSA9IDA7
IGkgPCBkYXRhLT5uZnVuY3M7IGkrKyApCi0gICAgICAgIGFyY2hfbGl2ZXBhdGNoX3JldmVydCgm
ZGF0YS0+ZnVuY3NbaV0pOworICAgICAgICBjb21tb25fbGl2ZXBhdGNoX3JldmVydCgmZGF0YS0+
ZnVuY3NbaV0pOwogCiAgICAgLyoKICAgICAgKiBTaW5jZSB3ZSBhcmUgcnVubmluZyB3aXRoIElS
UXMgZGlzYWJsZWQgYW5kIHRoZSBob29rcyBtYXkgY2FsbCBjb21tb24KQEAgLTEyNDAsNiArMTI0
MCwyOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgcmV2ZXJ0X3BheWxvYWRfdGFpbChzdHJ1Y3QgcGF5
bG9hZCAqZGF0YSkKICAgICBkYXRhLT5zdGF0ZSA9IExJVkVQQVRDSF9TVEFURV9DSEVDS0VEOwog
fQogCisvKgorICogQ2hlY2sgaWYgYW4gYWN0aW9uIGhhcyBhcHBsaWVkIHRoZSBzYW1lIHN0YXRl
IHRvIGFsbCBwYXlsb2FkJ3MgZnVuY3Rpb25zIGNvbnNpc3RlbnRseS4KKyAqLworc3RhdGljIGlu
bGluZSBib29sIHdhc19hY3Rpb25fY29uc2lzdGVudChjb25zdCBzdHJ1Y3QgcGF5bG9hZCAqZGF0
YSwgbGl2ZXBhdGNoX2Z1bmNfc3RhdGVfdCBleHBlY3RlZF9zdGF0ZSkKK3sKKyAgICBpbnQgaTsK
KworICAgIGZvciAoIGkgPSAwOyBpIDwgZGF0YS0+bmZ1bmNzOyBpKysgKQorICAgIHsKKyAgICAg
ICAgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmID0gJihkYXRhLT5mdW5jc1tpXSk7CisKKyAgICAg
ICAgaWYgKCBmLT5hcHBsaWVkICE9IGV4cGVjdGVkX3N0YXRlICkKKyAgICAgICAgeworICAgICAg
ICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENIICIlczogUGF5bG9hZCBoYXMgYSBmdW5j
dGlvbjogJyVzJyB3aXRoIGluY29uc2lzdGVudCBhcHBsaWVkIHN0YXRlLlxuIiwKKyAgICAgICAg
ICAgICAgICAgICBkYXRhLT5uYW1lLCBmLT5uYW1lID86ICJub25hbWUiKTsKKworICAgICAgICAg
ICAgcmV0dXJuIGZhbHNlOworICAgICAgICB9CisgICAgfQorCisgICAgcmV0dXJuIHRydWU7Cit9
CisKIC8qCiAgKiBUaGlzIGZ1bmN0aW9uIGlzIGV4ZWN1dGVkIGhhdmluZyBhbGwgb3RoZXIgQ1BV
cyB3aXRoIG5vIGRlZXAgc3RhY2sgKHdlIG1heQogICogaGF2ZSBjcHVfaWRsZSBvbiBpdCkgYW5k
IElSUXMgZGlzYWJsZWQuCkBAIC0xMjY2LDYgKzEyODksOSBAQCBzdGF0aWMgdm9pZCBsaXZlcGF0
Y2hfZG9fYWN0aW9uKHZvaWQpCiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIHJjID0gYXBwbHlf
cGF5bG9hZChkYXRhKTsKIAorICAgICAgICBpZiAoICF3YXNfYWN0aW9uX2NvbnNpc3RlbnQoZGF0
YSwgcmMgPyBMSVZFUEFUQ0hfRlVOQ19OT1RfQVBQTElFRCA6IExJVkVQQVRDSF9GVU5DX0FQUExJ
RUQpICkKKyAgICAgICAgICAgIHBhbmljKCJsaXZlcGF0Y2g6IHBhcnRpYWxseSBhcHBsaWVkIHBh
eWxvYWQgJyVzJyFcbiIsIGRhdGEtPm5hbWUpOworCiAgICAgICAgIGlmICggcmMgPT0gMCApCiAg
ICAgICAgICAgICBhcHBseV9wYXlsb2FkX3RhaWwoZGF0YSk7CiAgICAgICAgIGJyZWFrOwpAQCAt
MTI4MCw2ICsxMzA2LDkgQEAgc3RhdGljIHZvaWQgbGl2ZXBhdGNoX2RvX2FjdGlvbih2b2lkKQog
ICAgICAgICBlbHNlCiAgICAgICAgICAgICByYyA9IHJldmVydF9wYXlsb2FkKGRhdGEpOwogCisg
ICAgICAgIGlmICggIXdhc19hY3Rpb25fY29uc2lzdGVudChkYXRhLCByYyA/IExJVkVQQVRDSF9G
VU5DX0FQUExJRUQgOiBMSVZFUEFUQ0hfRlVOQ19OT1RfQVBQTElFRCkgKQorICAgICAgICAgICAg
cGFuaWMoImxpdmVwYXRjaDogcGFydGlhbGx5IHJldmVydGVkIHBheWxvYWQgJyVzJyFcbiIsIGRh
dGEtPm5hbWUpOworCiAgICAgICAgIGlmICggcmMgPT0gMCApCiAgICAgICAgICAgICByZXZlcnRf
cGF5bG9hZF90YWlsKGRhdGEpOwogICAgICAgICBicmVhazsKQEAgLTEzMDEsNiArMTMzMCw5IEBA
IHN0YXRpYyB2b2lkIGxpdmVwYXRjaF9kb19hY3Rpb24odm9pZCkKICAgICAgICAgICAgIGVsc2UK
ICAgICAgICAgICAgICAgICBvdGhlci0+cmMgPSByZXZlcnRfcGF5bG9hZChvdGhlcik7CiAKKyAg
ICAgICAgICAgIGlmICggIXdhc19hY3Rpb25fY29uc2lzdGVudChvdGhlciwgcmMgPyBMSVZFUEFU
Q0hfRlVOQ19BUFBMSUVEIDogTElWRVBBVENIX0ZVTkNfTk9UX0FQUExJRUQpICkKKyAgICAgICAg
ICAgICAgICBwYW5pYygibGl2ZXBhdGNoOiBwYXJ0aWFsbHkgcmV2ZXJ0ZWQgcGF5bG9hZCAnJXMn
IVxuIiwgb3RoZXItPm5hbWUpOworCiAgICAgICAgICAgICBpZiAoIG90aGVyLT5yYyA9PSAwICkK
ICAgICAgICAgICAgICAgICByZXZlcnRfcGF5bG9hZF90YWlsKG90aGVyKTsKICAgICAgICAgICAg
IGVsc2UKQEAgLTEzMjEsNiArMTM1Myw5IEBAIHN0YXRpYyB2b2lkIGxpdmVwYXRjaF9kb19hY3Rp
b24odm9pZCkKICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICByYyA9IGFwcGx5X3Bh
eWxvYWQoZGF0YSk7CiAKKyAgICAgICAgICAgIGlmICggIXdhc19hY3Rpb25fY29uc2lzdGVudChk
YXRhLCByYyA/IExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVEIDogTElWRVBBVENIX0ZVTkNfQVBQ
TElFRCkgKQorICAgICAgICAgICAgICAgIHBhbmljKCJsaXZlcGF0Y2g6IHBhcnRpYWxseSBhcHBs
aWVkIHBheWxvYWQgJyVzJyFcbiIsIGRhdGEtPm5hbWUpOworCiAgICAgICAgICAgICBpZiAoIHJj
ID09IDAgKQogICAgICAgICAgICAgICAgIGFwcGx5X3BheWxvYWRfdGFpbChkYXRhKTsKICAgICAg
ICAgfQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oIGIveGVuL2luY2x1
ZGUvcHVibGljL3N5c2N0bC5oCmluZGV4IDFiMmIxNjVhNmQuLjNiY2I4OTJjZTEgMTAwNjQ0Ci0t
LSBhL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaAorKysgYi94ZW4vaW5jbHVkZS9wdWJsaWMv
c3lzY3RsLmgKQEAgLTgxOCw3ICs4MTgsNyBAQCBzdHJ1Y3QgeGVuX3N5c2N0bF9jcHVfZmVhdHVy
ZXNldCB7CiAgKiAgICAgSWYgemVybyBleGl0IHdpdGggc3VjY2Vzcy4KICAqLwogCi0jZGVmaW5l
IExJVkVQQVRDSF9QQVlMT0FEX1ZFUlNJT04gMQorI2RlZmluZSBMSVZFUEFUQ0hfUEFZTE9BRF9W
RVJTSU9OIDIKIC8qCiAgKiAubGl2ZXBhdGNoLmZ1bmNzIHN0cnVjdHVyZSBsYXlvdXQgZGVmaW5l
ZCBpbiB0aGUgYFBheWxvYWQgZm9ybWF0YAogICogc2VjdGlvbiBpbiB0aGUgTGl2ZSBQYXRjaCBk
ZXNpZ24gZG9jdW1lbnQuCkBAIC04MjYsNiArODI2LDExIEBAIHN0cnVjdCB4ZW5fc3lzY3RsX2Nw
dV9mZWF0dXJlc2V0IHsKICAqIFdlIGd1YXJkIHRoaXMgd2l0aCBfX1hFTl9fIGFzIHRvb2xzdGFj
a3MgU0hPVUxEIG5vdCB1c2UgaXQuCiAgKi8KICNpZmRlZiBfX1hFTl9fCit0eXBlZGVmIGVudW0g
bGl2ZXBhdGNoX2Z1bmNfc3RhdGUgeworICAgIExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVELAor
ICAgIExJVkVQQVRDSF9GVU5DX0FQUExJRUQKK30gbGl2ZXBhdGNoX2Z1bmNfc3RhdGVfdDsKKwog
c3RydWN0IGxpdmVwYXRjaF9mdW5jIHsKICAgICBjb25zdCBjaGFyICpuYW1lOyAgICAgICAvKiBO
YW1lIG9mIGZ1bmN0aW9uIHRvIGJlIHBhdGNoZWQuICovCiAgICAgdm9pZCAqbmV3X2FkZHI7CkBA
IC04MzQsNiArODM5LDggQEAgc3RydWN0IGxpdmVwYXRjaF9mdW5jIHsKICAgICB1aW50MzJfdCBv
bGRfc2l6ZTsKICAgICB1aW50OF90IHZlcnNpb247ICAgICAgICAvKiBNVVNUIGJlIExJVkVQQVRD
SF9QQVlMT0FEX1ZFUlNJT04uICovCiAgICAgdWludDhfdCBvcGFxdWVbMzFdOworICAgIHVpbnQ4
X3QgYXBwbGllZDsKKyAgICB1aW50OF90IF9wYWRbN107CiB9OwogdHlwZWRlZiBzdHJ1Y3QgbGl2
ZXBhdGNoX2Z1bmMgbGl2ZXBhdGNoX2Z1bmNfdDsKICNlbmRpZgpkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUveGVuL2xpdmVwYXRjaC5oIGIveGVuL2luY2x1ZGUveGVuL2xpdmVwYXRjaC5oCmluZGV4
IDJhZWM1MzJlZTIuLjY0ZDFmYzJjYWUgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9saXZl
cGF0Y2guaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vbGl2ZXBhdGNoLmgKQEAgLTEyMiw2ICsxMjIs
MzQgQEAgdm9pZCBhcmNoX2xpdmVwYXRjaF9wb3N0X2FjdGlvbih2b2lkKTsKIAogdm9pZCBhcmNo
X2xpdmVwYXRjaF9tYXNrKHZvaWQpOwogdm9pZCBhcmNoX2xpdmVwYXRjaF91bm1hc2sodm9pZCk7
CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBjb21tb25fbGl2ZXBhdGNoX2FwcGx5KHN0cnVjdCBsaXZl
cGF0Y2hfZnVuYyAqZnVuYykKK3sKKyAgICAvKiBJZiB0aGUgYWN0aW9uIGhhcyBiZWVuIGFscmVh
ZHkgZXhlY3V0ZWQgb24gdGhpcyBmdW5jdGlvbiwgZG8gbm90aGluZy4gKi8KKyAgICBpZiAoIGZ1
bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCApCisgICAgeworICAgICAgICBw
cmludGsoWEVOTE9HX1dBUk5JTkcgTElWRVBBVENIICIlczogJXMgaGFzIGJlZW4gYWxyZWFkeSBh
cHBsaWVkIGJlZm9yZVxuIiwKKyAgICAgICAgICAgICAgICBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBhcmNoX2xpdmVwYXRjaF9hcHBseShmdW5j
KTsKKyAgICBmdW5jLT5hcHBsaWVkID0gTElWRVBBVENIX0ZVTkNfQVBQTElFRDsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkIGNvbW1vbl9saXZlcGF0Y2hfcmV2ZXJ0KHN0cnVjdCBsaXZlcGF0Y2hf
ZnVuYyAqZnVuYykKK3sKKyAgICAvKiBJZiB0aGUgYXBwbHkgYWN0aW9uIGhhc24ndCBiZWVuIGV4
ZWN1dGVkIG9uIHRoaXMgZnVuY3Rpb24sIGRvIG5vdGhpbmcuICovCisgICAgaWYgKCAhZnVuYy0+
b2xkX2FkZHIgfHwgZnVuYy0+YXBwbGllZCA9PSBMSVZFUEFUQ0hfRlVOQ19OT1RfQVBQTElFRCAp
CisgICAgeworICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgTElWRVBBVENIICIlczogJXMg
aGFzIG5vdCBiZWVuIGFwcGxpZWQgYmVmb3JlXG4iLAorICAgICAgICAgICAgICAgIF9fZnVuY19f
LCBmdW5jLT5uYW1lKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGFyY2hfbGl2ZXBh
dGNoX3JldmVydChmdW5jKTsKKyAgICBmdW5jLT5hcHBsaWVkID0gTElWRVBBVENIX0ZVTkNfTk9U
X0FQUExJRUQ7Cit9CiAjZWxzZQogCiAvKgpkaWZmIC0tZ2l0IGEveGVuL3Rlc3QvbGl2ZXBhdGNo
L01ha2VmaWxlIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL01ha2VmaWxlCmluZGV4IGJiYzZiZGFmNjQu
LjIzMTEzZDM0MTggMTAwNjQ0Ci0tLSBhL3hlbi90ZXN0L2xpdmVwYXRjaC9NYWtlZmlsZQorKysg
Yi94ZW4vdGVzdC9saXZlcGF0Y2gvTWFrZWZpbGUKQEAgLTI0LDYgKzI0LDkgQEAgTElWRVBBVENI
X1BSRVBPU1RfSE9PS1MgOj0geGVuX3ByZXBvc3RfaG9va3MubGl2ZXBhdGNoCiBMSVZFUEFUQ0hf
UFJFUE9TVF9IT09LU19GQUlMIDo9IHhlbl9wcmVwb3N0X2hvb2tzX2ZhaWwubGl2ZXBhdGNoCiBM
SVZFUEFUQ0hfQUNUSU9OX0hPT0tTIDo9IHhlbl9hY3Rpb25faG9va3MubGl2ZXBhdGNoCiBMSVZF
UEFUQ0hfQUNUSU9OX0hPT0tTX05PRlVOQyA6PSB4ZW5fYWN0aW9uX2hvb2tzX25vZnVuYy5saXZl
cGF0Y2gKK0xJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTUFSS0VSOj0geGVuX2FjdGlvbl9ob29rc19t
YXJrZXIubGl2ZXBhdGNoCitMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05PQVBQTFk6PSB4ZW5fYWN0
aW9uX2hvb2tzX25vYXBwbHkubGl2ZXBhdGNoCitMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05PUkVW
RVJUOj0geGVuX2FjdGlvbl9ob29rc19ub3JldmVydC5saXZlcGF0Y2gKIAogTElWRVBBVENIRVMg
Kz0gJChMSVZFUEFUQ0gpCiBMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9CWUUpCkBAIC0zNCw2
ICszNyw5IEBAIExJVkVQQVRDSEVTICs9ICQoTElWRVBBVENIX1BSRVBPU1RfSE9PS1MpCiBMSVZF
UEFUQ0hFUyArPSAkKExJVkVQQVRDSF9QUkVQT1NUX0hPT0tTX0ZBSUwpCiBMSVZFUEFUQ0hFUyAr
PSAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1MpCiBMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9B
Q1RJT05fSE9PS1NfTk9GVU5DKQorTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfQUNUSU9OX0hP
T0tTX01BUktFUikKK0xJVkVQQVRDSEVTICs9ICQoTElWRVBBVENIX0FDVElPTl9IT09LU19OT0FQ
UExZKQorTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05PUkVWRVJUKQog
CiBMSVZFUEFUQ0hfREVCVUdfRElSID89ICQoREVCVUdfRElSKS94ZW4tbGl2ZXBhdGNoCiAKQEAg
LTE1OCw3ICsxNjQsMjYgQEAgJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTKTogeGVuX2FjdGlvbl9o
b29rcy5vIHhlbl9oZWxsb193b3JsZF9mdW5jLm8gbm90ZS5vIHhlbl8KICQoTElWRVBBVENIX0FD
VElPTl9IT09LU19OT0ZVTkMpOiB4ZW5fYWN0aW9uX2hvb2tzX25vZnVuYy5vIG5vdGUubyB4ZW5f
bm90ZS5vCiAJJChMRCkgJChMREZMQUdTKSAkKGJ1aWxkX2lkX2xpbmtlcikgLXIgLW8gJChMSVZF
UEFUQ0hfQUNUSU9OX0hPT0tTX05PRlVOQykgJF4KIAoreGVuX2FjdGlvbnNfaG9va3NfbWFya2Vy
Lm86IGNvbmZpZy5oCisKKy5QSE9OWTogJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX01BUktFUikK
KyQoTElWRVBBVENIX0FDVElPTl9IT09LU19NQVJLRVIpOiB4ZW5fYWN0aW9uX2hvb2tzX21hcmtl
ci5vIHhlbl9oZWxsb193b3JsZF9mdW5jLm8gbm90ZS5vIHhlbl9ub3RlLm8KKwkkKExEKSAkKExE
RkxBR1MpICQoYnVpbGRfaWRfbGlua2VyKSAtciAtbyAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1Nf
TUFSS0VSKSAkXgorCit4ZW5fYWN0aW9uc19ob29rc19ub2FwcGx5Lm86IGNvbmZpZy5oCisKKy5Q
SE9OWTogJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05PQVBQTFkpCiskKExJVkVQQVRDSF9BQ1RJ
T05fSE9PS1NfTk9BUFBMWSk6IHhlbl9hY3Rpb25faG9va3NfbWFya2VyLm8geGVuX2hlbGxvX3dv
cmxkX2Z1bmMubyBub3RlLm8geGVuX25vdGUubworCSQoTEQpICQoTERGTEFHUykgJChidWlsZF9p
ZF9saW5rZXIpIC1yIC1vICQoTElWRVBBVENIX0FDVElPTl9IT09LU19OT0FQUExZKSAkXgorCit4
ZW5fYWN0aW9uc19ob29rc19ub3JldmVydC5vOiBjb25maWcuaAorCisuUEhPTlk6ICQoTElWRVBB
VENIX0FDVElPTl9IT09LU19OT1JFVkVSVCkKKyQoTElWRVBBVENIX0FDVElPTl9IT09LU19OT1JF
VkVSVCk6IHhlbl9hY3Rpb25faG9va3NfbWFya2VyLm8geGVuX2hlbGxvX3dvcmxkX2Z1bmMubyBu
b3RlLm8geGVuX25vdGUubworCSQoTEQpICQoTERGTEFHUykgJChidWlsZF9pZF9saW5rZXIpIC1y
IC1vICQoTElWRVBBVENIX0FDVElPTl9IT09LU19OT1JFVkVSVCkgJF4KKwogLlBIT05ZOiBsaXZl
cGF0Y2gKIGxpdmVwYXRjaDogJChMSVZFUEFUQ0gpICQoTElWRVBBVENIX0JZRSkgJChMSVZFUEFU
Q0hfUkVQTEFDRSkgJChMSVZFUEFUQ0hfTk9QKSAkKExJVkVQQVRDSF9OT19YRU5fQlVJTERJRCkg
XAogICAgICAgICAgICAkKExJVkVQQVRDSF9QUkVQT1NUX0hPT0tTKSAkKExJVkVQQVRDSF9QUkVQ
T1NUX0hPT0tTX0ZBSUwpICQoTElWRVBBVENIX0FDVElPTl9IT09LUykgXAotICAgICAgICAgICAk
KExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9GVU5DKQorICAgICAgICAgICAkKExJVkVQQVRDSF9B
Q1RJT05fSE9PS1NfTk9GVU5DKSAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTUFSS0VSKSAkKExJ
VkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9BUFBMWSkgXAorICAgICAgICAgICAkKExJVkVQQVRDSF9B
Q1RJT05fSE9PS1NfTk9SRVZFUlQpCmRpZmYgLS1naXQgYS94ZW4vdGVzdC9saXZlcGF0Y2gveGVu
X2FjdGlvbl9ob29rcy5jIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3MuYwpp
bmRleCBhOTQ3YWZjNDFmLi4zOWI1MzEzMDI3IDEwMDY0NAotLS0gYS94ZW4vdGVzdC9saXZlcGF0
Y2gveGVuX2FjdGlvbl9ob29rcy5jCisrKyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9u
X2hvb2tzLmMKQEAgLTI4LDYgKzI4LDcgQEAgc3RhdGljIGludCBhcHBseV9ob29rKGxpdmVwYXRj
aF9wYXlsb2FkX3QgKnBheWxvYWQpCiAgICAgewogICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1
bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CiAKKyAgICAgICAgZnVuYy0+YXBwbGllZCA9
IExJVkVQQVRDSF9GVU5DX0FQUExJRUQ7CiAgICAgICAgIGFwcGx5X2NudCsrOwogCiAgICAgICAg
IHByaW50ayhLRVJOX0RFQlVHICIlczogYXBwbHlpbmc6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+
bmFtZSk7CkBAIC00OCw2ICs0OSw3IEBAIHN0YXRpYyBpbnQgcmV2ZXJ0X2hvb2sobGl2ZXBhdGNo
X3BheWxvYWRfdCAqcGF5bG9hZCkKICAgICB7CiAgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVu
YyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKIAorICAgICAgICBmdW5jLT5hcHBsaWVkID0g
TElWRVBBVENIX0ZVTkNfTk9UX0FQUExJRUQ7CiAgICAgICAgIHJldmVydF9jbnQrKzsKIAogICAg
ICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHJldmVydGluZzogJXNcbiIsIF9fZnVuY19fLCBm
dW5jLT5uYW1lKTsKZGlmZiAtLWdpdCBhL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hv
b2tzX21hcmtlci5jIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3NfbWFya2Vy
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uNGY4MDdhNTc3ZgotLS0g
L2Rldi9udWxsCisrKyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzX21hcmtl
ci5jCkBAIC0wLDAgKzEsMTEyIEBACisvKgorICogQ29weXJpZ2h0IChjKSAyMDE5IEFtYXpvbi5j
b20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKgorICov
CisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlIDx4ZW4vbGliLmg+CisjaW5jbHVkZSA8
eGVuL3R5cGVzLmg+CisjaW5jbHVkZSA8eGVuL3ZlcnNpb24uaD4KKyNpbmNsdWRlIDx4ZW4vbGl2
ZXBhdGNoLmg+CisjaW5jbHVkZSA8eGVuL2xpdmVwYXRjaF9wYXlsb2FkLmg+CisKKyNpbmNsdWRl
IDxwdWJsaWMvc3lzY3RsLmg+CisKK3N0YXRpYyBjb25zdCBjaGFyIGhlbGxvX3dvcmxkX3BhdGNo
X3RoaXNfZm5jW10gPSAieGVuX2V4dHJhX3ZlcnNpb24iOworZXh0ZXJuIGNvbnN0IGNoYXIgKnhl
bl9oZWxsb193b3JsZCh2b2lkKTsKKworc3RhdGljIGludCBwcmVfYXBwbHlfaG9vayhsaXZlcGF0
Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5f
REVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0g
MDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVw
YXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19PTihm
dW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAgICBwcmludGso
S0VSTl9ERUJVRyAiJXM6IHByZSBhcHBsaWVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUp
OworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19m
dW5jX18pOworCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHBvc3RfYXBwbHlfaG9v
ayhsaXZlcGF0Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJp
bnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAg
Zm9yIChpID0gMDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3Ry
dWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAg
IEJVR19PTihmdW5jLT5hcHBsaWVkICE9IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAg
ICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHBvc3QgYXBwbGllZDogJXNcbiIsIF9fZnVuY19fLCBm
dW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9u
ZS5cbiIsIF9fZnVuY19fKTsKK30KKworc3RhdGljIGludCBwcmVfcmV2ZXJ0X2hvb2sobGl2ZXBh
dGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJO
X0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9
IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZl
cGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04o
ZnVuYy0+YXBwbGllZCAhPSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRr
KEtFUk5fREVCVUcgIiVzOiBwcmUgcmV2ZXJ0ZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFt
ZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBf
X2Z1bmNfXyk7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgcG9zdF9yZXZlcnRf
aG9vayhsaXZlcGF0Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAg
cHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisg
ICAgZm9yIChpID0gMDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAg
c3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAg
ICAgIEJVR19PTihmdW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAg
ICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHBvc3QgcmV2ZXJ0ZWQ6ICVzXG4iLCBfX2Z1bmNf
XywgZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29r
IGRvbmUuXG4iLCBfX2Z1bmNfXyk7Cit9CisKK0xJVkVQQVRDSF9QUkVBUFBMWV9IT09LKHByZV9h
cHBseV9ob29rKTsKK0xJVkVQQVRDSF9QT1NUQVBQTFlfSE9PSyhwb3N0X2FwcGx5X2hvb2spOwor
TElWRVBBVENIX1BSRVJFVkVSVF9IT09LKHByZV9yZXZlcnRfaG9vayk7CitMSVZFUEFUQ0hfUE9T
VFJFVkVSVF9IT09LKHBvc3RfcmV2ZXJ0X2hvb2spOworCitzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMg
X19zZWN0aW9uKCIubGl2ZXBhdGNoLmZ1bmNzIikgbGl2ZXBhdGNoX3hlbl9oZWxsb193b3JsZCA9
IHsKKyAgICAudmVyc2lvbiA9IExJVkVQQVRDSF9QQVlMT0FEX1ZFUlNJT04sCisgICAgLm5hbWUg
PSBoZWxsb193b3JsZF9wYXRjaF90aGlzX2ZuYywKKyAgICAubmV3X2FkZHIgPSB4ZW5faGVsbG9f
d29ybGQsCisgICAgLm9sZF9hZGRyID0geGVuX2V4dHJhX3ZlcnNpb24sCisgICAgLm5ld19zaXpl
ID0gTkVXX0NPREVfU1osCisgICAgLm9sZF9zaXplID0gT0xEX0NPREVfU1osCit9OworCisvKgor
ICogTG9jYWwgdmFyaWFibGVzOgorICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAiQlNEIgor
ICogYy1iYXNpYy1vZmZzZXQ6IDQKKyAqIHRhYi13aWR0aDogNAorICogaW5kZW50LXRhYnMtbW9k
ZTogbmlsCisgKiBFbmQ6CisgKi8KZGlmZiAtLWdpdCBhL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5f
YWN0aW9uX2hvb2tzX25vYXBwbHkuYyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hv
b2tzX25vYXBwbHkuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi40YzU1
YzE1NmE2Ci0tLSAvZGV2L251bGwKKysrIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25f
aG9va3Nfbm9hcHBseS5jCkBAIC0wLDAgKzEsMTM2IEBACisvKgorICogQ29weXJpZ2h0IChjKSAy
MDE5IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCisgKgorICovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlIDx4ZW4vbGliLmg+
CisjaW5jbHVkZSA8eGVuL3R5cGVzLmg+CisjaW5jbHVkZSA8eGVuL3ZlcnNpb24uaD4KKyNpbmNs
dWRlIDx4ZW4vbGl2ZXBhdGNoLmg+CisjaW5jbHVkZSA8eGVuL2xpdmVwYXRjaF9wYXlsb2FkLmg+
CisKKyNpbmNsdWRlIDxwdWJsaWMvc3lzY3RsLmg+CisKK3N0YXRpYyBjb25zdCBjaGFyIGhlbGxv
X3dvcmxkX3BhdGNoX3RoaXNfZm5jW10gPSAieGVuX2V4dHJhX3ZlcnNpb24iOworZXh0ZXJuIGNv
bnN0IGNoYXIgKnhlbl9oZWxsb193b3JsZCh2b2lkKTsKKworc3RhdGljIHVuc2lnbmVkIGludCBh
cHBseV9jbnQ7CisKK3N0YXRpYyBpbnQgcHJlX2FwcGx5X2hvb2sobGl2ZXBhdGNoX3BheWxvYWRf
dCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczog
SG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9IDA7IGkgPCBwYXls
b2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAq
ZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04oZnVuYy0+YXBwbGll
ZCA9PSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcg
IiVzOiBwcmUgYXBwbGllZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisK
KyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKKwor
ICAgIHJldHVybiAwOworfQorCitzdGF0aWMgaW50IGFwcGx5X2hvb2sobGl2ZXBhdGNoX3BheWxv
YWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJOX0RFQlVHICIl
czogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9IDA7IGkgPCBw
YXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVu
YyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBhcHBseV9jbnQrKzsKKyAg
ICAgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBhcHBseWluZzogJXNcbiIsIF9fZnVuY19fLCBm
dW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9u
ZS5cbiIsIF9fZnVuY19fKTsKKworICAgIHJldHVybiAtRUlOVkFMOyAvKiBNYXJrIGFjdGlvbiBh
cyBpbmNvbnNpc3RlbnQgKi8KK30KKworc3RhdGljIHZvaWQgcG9zdF9hcHBseV9ob29rKGxpdmVw
YXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VS
Tl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkg
PSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2
ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09O
KGFwcGx5X2NudCAhPSAxKTsKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBB
VENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcG9zdCBh
cHBsaWVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50
ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOworfQorCitzdGF0aWMg
aW50IHByZV9yZXZlcnRfaG9vayhsaXZlcGF0Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAg
IGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwg
X19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQor
ICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1
bmNzW2ldOworCisgICAgICAgIEJVR19PTihmdW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5D
X0FQUExJRUQpOworICAgICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHByZSByZXZlcnRlZDog
JXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9E
RUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKKworICAgIHJldHVybiAwOworfQor
CitzdGF0aWMgdm9pZCBwb3N0X3JldmVydF9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxv
YWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3Rh
cnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1
bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAm
cGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElW
RVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcG9z
dCByZXZlcnRlZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBw
cmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKK30KKworTElW
RVBBVENIX0FQUExZX0hPT0soYXBwbHlfaG9vayk7CisKK0xJVkVQQVRDSF9QUkVBUFBMWV9IT09L
KHByZV9hcHBseV9ob29rKTsKK0xJVkVQQVRDSF9QT1NUQVBQTFlfSE9PSyhwb3N0X2FwcGx5X2hv
b2spOworTElWRVBBVENIX1BSRVJFVkVSVF9IT09LKHByZV9yZXZlcnRfaG9vayk7CitMSVZFUEFU
Q0hfUE9TVFJFVkVSVF9IT09LKHBvc3RfcmV2ZXJ0X2hvb2spOworCitzdHJ1Y3QgbGl2ZXBhdGNo
X2Z1bmMgX19zZWN0aW9uKCIubGl2ZXBhdGNoLmZ1bmNzIikgbGl2ZXBhdGNoX3hlbl9oZWxsb193
b3JsZCA9IHsKKyAgICAudmVyc2lvbiA9IExJVkVQQVRDSF9QQVlMT0FEX1ZFUlNJT04sCisgICAg
Lm5hbWUgPSBoZWxsb193b3JsZF9wYXRjaF90aGlzX2ZuYywKKyAgICAubmV3X2FkZHIgPSB4ZW5f
aGVsbG9fd29ybGQsCisgICAgLm9sZF9hZGRyID0geGVuX2V4dHJhX3ZlcnNpb24sCisgICAgLm5l
d19zaXplID0gTkVXX0NPREVfU1osCisgICAgLm9sZF9zaXplID0gT0xEX0NPREVfU1osCit9Owor
CisvKgorICogTG9jYWwgdmFyaWFibGVzOgorICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAi
QlNEIgorICogYy1iYXNpYy1vZmZzZXQ6IDQKKyAqIHRhYi13aWR0aDogNAorICogaW5kZW50LXRh
YnMtbW9kZTogbmlsCisgKiBFbmQ6CisgKi8KZGlmZiAtLWdpdCBhL3hlbi90ZXN0L2xpdmVwYXRj
aC94ZW5fYWN0aW9uX2hvb2tzX25vcmV2ZXJ0LmMgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2Fj
dGlvbl9ob29rc19ub3JldmVydC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAuLmVmNzdlNzIwNzEKLS0tIC9kZXYvbnVsbAorKysgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVu
X2FjdGlvbl9ob29rc19ub3JldmVydC5jCkBAIC0wLDAgKzEsMTQzIEBACisvKgorICogQ29weXJp
Z2h0IChjKSAyMDE5IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCByaWdo
dHMgcmVzZXJ2ZWQuCisgKgorICovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlIDx4
ZW4vbGliLmg+CisjaW5jbHVkZSA8eGVuL3R5cGVzLmg+CisjaW5jbHVkZSA8eGVuL3ZlcnNpb24u
aD4KKyNpbmNsdWRlIDx4ZW4vbGl2ZXBhdGNoLmg+CisjaW5jbHVkZSA8eGVuL2xpdmVwYXRjaF9w
YXlsb2FkLmg+CisKKyNpbmNsdWRlIDxwdWJsaWMvc3lzY3RsLmg+CisKK3N0YXRpYyBjb25zdCBj
aGFyIGhlbGxvX3dvcmxkX3BhdGNoX3RoaXNfZm5jW10gPSAieGVuX2V4dHJhX3ZlcnNpb24iOwor
ZXh0ZXJuIGNvbnN0IGNoYXIgKnhlbl9oZWxsb193b3JsZCh2b2lkKTsKKworc3RhdGljIHVuc2ln
bmVkIGludCByZXZlcnRfY250OworCitzdGF0aWMgaW50IHByZV9hcHBseV9ob29rKGxpdmVwYXRj
aF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VSTl9E
RUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkgPSAw
OyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBh
dGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09OKGZ1
bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50ayhL
RVJOX0RFQlVHICIlczogcHJlIGFwcGxpZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7
CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1
bmNfXyk7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgcG9zdF9hcHBseV9ob29r
KGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmlu
dGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBm
b3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1
Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAg
QlVHX09OKGZ1bmMtPmFwcGxpZWQgIT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAg
IHByaW50ayhLRVJOX0RFQlVHICIlczogcG9zdCBhcHBsaWVkOiAlc1xuIiwgX19mdW5jX18sIGZ1
bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25l
LlxuIiwgX19mdW5jX18pOworfQorCitzdGF0aWMgaW50IHByZV9yZXZlcnRfaG9vayhsaXZlcGF0
Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5f
REVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0g
MDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVw
YXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19PTihm
dW5jLT5hcHBsaWVkICE9IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAgICBwcmludGso
S0VSTl9ERUJVRyAiJXM6IHByZSByZXZlcnRlZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1l
KTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9f
ZnVuY19fKTsKKworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgaW50IHJldmVydF9ob29rKGxp
dmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGso
S0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3Ig
KGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3Qg
bGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgcmV2
ZXJ0X2NudCsrOworICAgICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHJldmVydGluZzogJXNc
biIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJV
RyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKKworICAgIHJldHVybiAtRUlOVkFMOyAv
KiBNYXJrIGFjdGlvbiBhcyBpbmNvbnNpc3RlbnQgKi8KK30KKworc3RhdGljIHZvaWQgcG9zdF9y
ZXZlcnRfaG9vayhsaXZlcGF0Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOwor
CisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18p
OworCisgICAgZm9yIChpID0gMDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAg
ICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOwor
CisgICAgICAgIEJVR19PTihyZXZlcnRfY250ICE9IDEpOworICAgICAgICBCVUdfT04oZnVuYy0+
YXBwbGllZCAhPSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKworICAgICAgICAvKiBPdXRzaWRl
IG9mIHF1aWVzY2Ugem9uZTogTUFZIFRSSUdHRVIgSE9TVCBDUkFTSC9VTkRFRklORUQgQkVIQVZJ
T1IgKi8KKyAgICAgICAgYXJjaF9saXZlcGF0Y2hfcXVpZXNjZSgpOworICAgICAgICBjb21tb25f
bGl2ZXBhdGNoX3JldmVydChwYXlsb2FkKTsKKyAgICAgICAgYXJjaF9saXZlcGF0Y2hfcmV2aXZl
KCk7CisgICAgICAgIEJVR19PTihmdW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5DX0FQUExJ
RUQpOworCisgICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcG9zdCByZXZlcnRlZDogJXNc
biIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJV
RyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKK30KKworTElWRVBBVENIX0FQUExZX0hP
T0socmV2ZXJ0X2hvb2spOworCitMSVZFUEFUQ0hfUFJFQVBQTFlfSE9PSyhwcmVfYXBwbHlfaG9v
ayk7CitMSVZFUEFUQ0hfUE9TVEFQUExZX0hPT0socG9zdF9hcHBseV9ob29rKTsKK0xJVkVQQVRD
SF9QUkVSRVZFUlRfSE9PSyhwcmVfcmV2ZXJ0X2hvb2spOworTElWRVBBVENIX1BPU1RSRVZFUlRf
SE9PSyhwb3N0X3JldmVydF9ob29rKTsKKworc3RydWN0IGxpdmVwYXRjaF9mdW5jIF9fc2VjdGlv
bigiLmxpdmVwYXRjaC5mdW5jcyIpIGxpdmVwYXRjaF94ZW5faGVsbG9fd29ybGQgPSB7CisgICAg
LnZlcnNpb24gPSBMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OLAorICAgIC5uYW1lID0gaGVsbG9f
d29ybGRfcGF0Y2hfdGhpc19mbmMsCisgICAgLm5ld19hZGRyID0geGVuX2hlbGxvX3dvcmxkLAor
ICAgIC5vbGRfYWRkciA9IHhlbl9leHRyYV92ZXJzaW9uLAorICAgIC5uZXdfc2l6ZSA9IE5FV19D
T0RFX1NaLAorICAgIC5vbGRfc2l6ZSA9IE9MRF9DT0RFX1NaLAorfTsKKworLyoKKyAqIExvY2Fs
IHZhcmlhYmxlczoKKyAqIG1vZGU6IEMKKyAqIGMtZmlsZS1zdHlsZTogIkJTRCIKKyAqIGMtYmFz
aWMtb2Zmc2V0OiA0CisgKiB0YWItd2lkdGg6IDQKKyAqIGluZGVudC10YWJzLW1vZGU6IG5pbAor
ICogRW5kOgorICovCi0tIAoyLjE2LjUKCgoKCkFtYXpvbiBEZXZlbG9wbWVudCBDZW50ZXIgR2Vy
bWFueSBHbWJICktyYXVzZW5zdHIuIDM4CjEwMTE3IEJlcmxpbgpHZXNjaGFlZnRzZnVlaHJ1bmc6
IENocmlzdGlhbiBTY2hsYWVnZXIsIFJhbGYgSGVyYnJpY2gKRWluZ2V0cmFnZW4gYW0gQW10c2dl
cmljaHQgQ2hhcmxvdHRlbmJ1cmcgdW50ZXIgSFJCIDE0OTE3MyBCClNpdHo6IEJlcmxpbgpVc3Qt
SUQ6IERFIDI4OSAyMzcgODc5CgoKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5w
cm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8v
eGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6785213DA00
	for <lists+xen-devel@lfdr.de>; Thu, 16 Jan 2020 13:30:30 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1is4FY-0005Jz-HN; Thu, 16 Jan 2020 12:27:48 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=J9Dq=3F=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1is4FW-0005Jq-DW
 for xen-devel@lists.xenproject.org; Thu, 16 Jan 2020 12:27:46 +0000
X-Inumbo-ID: 9744af04-385b-11ea-8717-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 9744af04-385b-11ea-8717-12813bfff9fa;
 Thu, 16 Jan 2020 12:27:42 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 3053DAC18;
 Thu, 16 Jan 2020 12:27:41 +0000 (UTC)
To: Tamas K Lengyel <tamas.lengyel@intel.com>
References: <cover.1578503483.git.tamas.lengyel@intel.com>
 <b1d48d7dd680041709d5fc4ca2562560690c8db4.1578503483.git.tamas.lengyel@intel.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <e99f9fea-3173-83c8-110f-a7d5d72d2961@suse.com>
Date: Thu, 16 Jan 2020 13:27:42 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.1
MIME-Version: 1.0
In-Reply-To: <b1d48d7dd680041709d5fc4ca2562560690c8db4.1578503483.git.tamas.lengyel@intel.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH v4 01/18] x86/hvm: introduce
 hvm_copy_context_and_params
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: xen-devel@lists.xenproject.org,
 =?UTF-8?Q?Roger_Pau_Monn=c3=a9?= <roger.pau@citrix.com>, Wei Liu <wl@xen.org>,
 Andrew Cooper <andrew.cooper3@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMDguMDEuMjAyMCAxODoxMywgVGFtYXMgSyBMZW5neWVsIHdyb3RlOgo+IEBAIC00MTI5LDQ5
ICs0MTMwLDMyIEBAIHN0YXRpYyBpbnQgaHZtX2FsbG93X3NldF9wYXJhbShzdHJ1Y3QgZG9tYWlu
ICpkLAo+ICAgICAgcmV0dXJuIHJjOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IGh2bW9wX3NldF9w
YXJhbSgKPiAtICAgIFhFTl9HVUVTVF9IQU5ETEVfUEFSQU0oeGVuX2h2bV9wYXJhbV90KSBhcmcp
Cj4gK3N0YXRpYyBpbnQgaHZtX3NldF9wYXJhbShzdHJ1Y3QgZG9tYWluICpkLCB1aW50MzJfdCBp
bmRleCwgdWludDY0X3QgdmFsdWUpCj4gIHsKPiAgICAgIHN0cnVjdCBkb21haW4gKmN1cnJfZCA9
IGN1cnJlbnQtPmRvbWFpbjsKPiAtICAgIHN0cnVjdCB4ZW5faHZtX3BhcmFtIGE7Cj4gLSAgICBz
dHJ1Y3QgZG9tYWluICpkOwo+IC0gICAgc3RydWN0IHZjcHUgKnY7Cj4gICAgICBpbnQgcmM7Cj4g
KyAgICBzdHJ1Y3QgdmNwdSAqdjsKCk5pdDogUGVyc29uYWxseSBJJ2QgcHJlZmVyIGlmICJyYyIg
cmVtYWluZWQgbGFzdC4KCj4gK2ludCBodm1vcF9zZXRfcGFyYW0oCj4gKyAgICBYRU5fR1VFU1Rf
SEFORExFX1BBUkFNKHhlbl9odm1fcGFyYW1fdCkgYXJnKQo+ICt7Cj4gKyAgICBzdHJ1Y3QgeGVu
X2h2bV9wYXJhbSBhOwo+ICsgICAgc3RydWN0IGRvbWFpbiAqZDsKPiArICAgIGludCByYzsKPiAr
Cj4gKyAgICBpZiAoIGNvcHlfZnJvbV9ndWVzdCgmYSwgYXJnLCAxKSApCj4gKyAgICAgICAgcmV0
dXJuIC1FRkFVTFQ7Cj4gKwo+ICsgICAgaWYgKCBhLmluZGV4ID49IEhWTV9OUl9QQVJBTVMgKQo+
ICsgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsKPiArICAgIC8qIE1ha2Ugc3VyZSB0aGUgYWJv
dmUgYm91bmQgY2hlY2sgaXMgbm90IGJ5cGFzc2VkIGR1cmluZyBzcGVjdWxhdGlvbi4gKi8KPiAr
ICAgIGJsb2NrX3NwZWN1bGF0aW9uKCk7Cj4gKwo+ICsgICAgZCA9IHJjdV9sb2NrX2RvbWFpbl9i
eV9hbnlfaWQoYS5kb21pZCk7Cj4gKyAgICBpZiAoIGQgPT0gTlVMTCApCj4gKyAgICAgICAgcmV0
dXJuIC1FU1JDSDsKPiArCj4gKyAgICByYyA9IC1FSU5WQUw7Cj4gKyAgICBpZiAoICFpc19odm1f
ZG9tYWluKGQpICkKPiArICAgICAgICBnb3RvIG91dDsKPiArCj4gKyAgICByYyA9IGh2bV9zZXRf
cGFyYW0oZCwgYS5pbmRleCwgYS52YWx1ZSk7CgpXaXRoCgogICAgcmMgPSAtRUlOVkFMOwogICAg
aWYgKCBpc19odm1fZG9tYWluKGQpICkKICAgICAgICByYyA9IGh2bV9zZXRfcGFyYW0oZCwgYS5p
bmRleCwgYS52YWx1ZSk7Cgp0aGUgZnVuY3Rpb24gd291bGRuJ3QgbmVlZCBhbiAib3V0IiBsYWJl
bCAoYW5kIGhlbmNlIGFueSBnb3RvKQphbnltb3JlLiBJIGtub3cgb3RoZXJzIGFyZSBsZXNzIHBp
Y2t5IGFib3V0IGdvdG8tcyB0aGFuIG1lLCBidXQKSSB0aGluayBpbiBjYXNlcyB3aGVyZSBpdCdz
IGVhc3kgdG8gYXZvaWQgdGhlbSB0aGV5IHdvdWxkIGJldHRlcgpiZSBhdm9pZGVkLgoKPiBAQCAt
NDQwMCw2ICs0NDE0LDQzIEBAIHN0YXRpYyBpbnQgaHZtX2FsbG93X2dldF9wYXJhbShzdHJ1Y3Qg
ZG9tYWluICpkLAo+ICAgICAgcmV0dXJuIHJjOwo+ICB9Cj4gIAo+ICtzdGF0aWMgaW50IGh2bV9n
ZXRfcGFyYW0oc3RydWN0IGRvbWFpbiAqZCwgdWludDMyX3QgaW5kZXgsIHVpbnQ2NF90ICp2YWx1
ZSkKPiArewo+ICsgICAgaW50IHJjOwo+ICsKPiArICAgIGlmICggaW5kZXggPj0gSFZNX05SX1BB
UkFNUyB8fCAhdmFsdWUgKQo+ICsgICAgICAgIHJldHVybiAtRUlOVkFMOwoKSSBkb24ndCB0aGlu
ayB0aGUgcmFuZ2UgY2hlY2sgaXMgbmVlZGVkIGhlcmU6IEl0J3MgcmVkdW5kYW50IHdpdGgKdGhh
dCBpbiBodm1vcF9nZXRfcGFyYW0oKSBhbmQgcG9pbnRsZXNzIGZvciB0aGUgbmV3IGZ1bmN0aW9u
IHlvdQphZGQuIChTYW1lIGZvciAic2V0IiB0aGVuLCBidXQgSSBub3RpY2VkIGl0IGhlcmUgZmly
c3QuKSBJIGFsc28KZG9uJ3QgdGhpbmsgdmFsdWUgbmVlZHMgY2hlY2tpbmcgYWdhaW5zdCBOVUxM
IGluIGEgY2FzZSBsaWtlIHRoaXMKb25lICh3ZSBkb24ndCB0eXBpY2FsbHkgZG8gc28gZWxzZXdo
ZXJlIGluIHNpbWlsYXIgc2l0dWF0aW9ucykuCgo+IEBAIC01MjY2LDYgKzUyOTQsMzcgQEAgdm9p
ZCBodm1fc2V0X3NlZ21lbnRfcmVnaXN0ZXIoc3RydWN0IHZjcHUgKnYsIGVudW0geDg2X3NlZ21l
bnQgc2VnLAo+ICAgICAgYWx0ZXJuYXRpdmVfdmNhbGwoaHZtX2Z1bmNzLnNldF9zZWdtZW50X3Jl
Z2lzdGVyLCB2LCBzZWcsIHJlZyk7Cj4gIH0KPiAgCj4gK2ludCBodm1fY29weV9jb250ZXh0X2Fu
ZF9wYXJhbXMoc3RydWN0IGRvbWFpbiAqc3JjLCBzdHJ1Y3QgZG9tYWluICpkc3QpCgpGb2xsb3dp
bmcgbWVtY3B5KCkgYW5kIGFsaWtlLCBwZXJoYXBzIGJldHRlciB0byBoYXZlIGRzdCBmaXJzdCBh
bmQKc3JjIHNlY29uZD8KCj4gK3sKPiArICAgIGludCByYywgaTsKCnVuc2lnbmVkIGludCBmb3Ig
aSBwbGVhc2UuCgo+ICsgICAgc3RydWN0IGh2bV9kb21haW5fY29udGV4dCBjID0geyB9Owo+ICsK
PiArICAgIGMuc2l6ZSA9IGh2bV9zYXZlX3NpemUoc3JjKTsKClB1dCBpbiB0aGUgdmFyaWFibGUn
cyBpbml0aWFsaXplcj8KCj4gKyAgICBpZiAoIChjLmRhdGEgPSB4bWFsbG9jX2J5dGVzKGMuc2l6
ZSkpID09IE5VTEwgKQoKSG93IGxpa2VseSBpcyBpdCBmb3IgdGhpcyB0byBiZSBtb3JlIHRoYW4g
YSBwYWdlJ3Mgd29ydGggb2Ygc3BhY2U/CklPVyB3b3VsZG4ndCBpdCBiZSBiZXR0ZXIgdG8gdXNl
IHZtYWxsb2MoKSBoZXJlIHJpZ2h0IGF3YXksIGV2ZW4gaWYKcmlnaHQgbm93IHRoaXMgbWF5IHN0
aWxsIGZpdCBpbiBhIHBhZ2UgKHdoaWNoIEknbSBub3Qgc3VyZSBpdCBkb2VzKT8KCj4gKyAgICAg
ICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsgICAgZm9yICggaSA9IDA7IGkgPCBIVk1fTlJfUEFS
QU1TOyBpKysgKQo+ICsgICAgewo+ICsgICAgICAgIHVpbnQ2NF90IHZhbHVlID0gMDsKPiArCj4g
KyAgICAgICAgaWYgKCBodm1fZ2V0X3BhcmFtKHNyYywgaSwgJnZhbHVlKSB8fCAhdmFsdWUgKQo+
ICsgICAgICAgICAgICBjb250aW51ZTsKPiArCj4gKyAgICAgICAgaWYgKCAocmMgPSBodm1fc2V0
X3BhcmFtKGRzdCwgaSwgdmFsdWUpKSApCj4gKyAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsgICAg
fQo+ICsKPiArICAgIGlmICggKHJjID0gaHZtX3NhdmUoc3JjLCAmYykpICkKPiArICAgICAgICBn
b3RvIG91dDsKCkJldHRlciBkbyB0aGlzIGFoZWFkIG9mIHRoZSBsb29wPyBUaGVyZSdzIG5vIHBv
aW50IGluIGZpZGRsaW5nIHdpdGgKZHN0IGlmIHRoaXMgZmFpbHMsIEkgd291bGQgdGhpbmsuCgpK
YW4KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

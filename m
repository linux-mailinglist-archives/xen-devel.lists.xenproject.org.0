Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 61B512FBCA1
	for <lists+xen-devel@lfdr.de>; Tue, 19 Jan 2021 17:39:49 +0100 (CET)
Received: from list by lists.xenproject.org with outflank-mailman.70649.126829 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1l1u25-0006eF-Tx; Tue, 19 Jan 2021 16:39:05 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 70649.126829; Tue, 19 Jan 2021 16:39:05 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1l1u25-0006dg-NA; Tue, 19 Jan 2021 16:39:05 +0000
Received: by outflank-mailman (input) for mailman id 70649;
 Tue, 19 Jan 2021 16:39:03 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=g3v7=GW=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1l1tyS-0004wn-JP
 for xen-devel@lists.xen.org; Tue, 19 Jan 2021 16:35:20 +0000
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id eae1cead-d4f0-4d4b-86d1-40121555bc27;
 Tue, 19 Jan 2021 16:34:33 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1l1txQ-0004up-Lb; Tue, 19 Jan 2021 16:34:16 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1l1txQ-0002rl-Jk; Tue, 19 Jan 2021 16:34:16 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: eae1cead-d4f0-4d4b-86d1-40121555bc27
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=cqWVBDd27cbHoTRc9TLUjhmgDbieMl/R6Ls5zQLrEiU=; b=v4Ihiq4VZK3Eu7AuGz1Hz05Jpd
	xaQ0m1EvkTBfZLupkCK0yFLMbmB9Qt9M+KHfz0pNxTdBCxSgYZuSQbGzFFhM8FWJ0qBKGbQMlgXrg
	lrxG52JRhd4JaiFsPBfgNmnU4iHQgKJuUNl7Knv2mLhIgHidxNwAufGTJBQC7F3xR3gs=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 332 v4 (CVE-2020-27673) - Rogue guests can
 cause DoS of Dom0 via high frequency events
Message-Id: <E1l1txQ-0002rl-Jk@xenbits.xenproject.org>
Date: Tue, 19 Jan 2021 16:34:16 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2020-27673 / XSA-332
                              version 4

     Rogue guests can cause DoS of Dom0 via high frequency events

UPDATES IN VERSION 4
====================

CVE assigned.

ISSUE DESCRIPTION
=================

The handling of Xen events in the Linux kernel runs with interrupts
disabled in a loop until no further event is pending.

Whenever an event has been accepted by the kernel, another event can
come in via the same event channel.  This can result in the event
handling loop running for an extended time if new events are coming in
at a high rate.  In extreme cases this can lead to a complete hang of
the kernel, resulting in a DoS situation of the host when dom0 is
affected.

IMPACT
======

Malicious guests can hang the host by sending events to dom0 at a high
frequency.

VULNERABLE SYSTEMS
==================

All systems with a Linux dom0 are affected.

All Linux kernel versions are affected.

MITIGATION
==========

There is no known mitigation.

CREDITS
=======

This issue was discovered by Julien Grall from Arm

RESOLUTION
==========

Applying the appropriate attached patches resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa332-linux-??.patch  Linux

$ sha256sum xsa332*
92d0789e8e5b9ec7ae0cd8b01ef31e27930dbe9b81b727521d46328107f3c719  xsa332-linux-01.patch
0bd82febcaf7fc72b88082f46cae9b67f39786d03b3e6aae5f0789cf855e6143  xsa332-linux-02.patch
e646b7caf11ded7f22b209635b209f50ac583cbaeb3270148ce66a3cd922f0c1  xsa332-linux-03.patch
9bed2213774a8107a2f2c157aeb0ebfda7cc6384cee0a245017b3a9eb28cff7f  xsa332-linux-04.patch
8839af506b71946db35f223ff614aa92b4386aaf95e4d8b1408fbf31436ff80f  xsa332-linux-05.patch
b261706bd7f7120fadff0e928be366924cfc13418c81a67ad45724b4179e8a5c  xsa332-linux-06.patch
fc0c963a9a965fc7a72468b1a1ce0834dc866e77392ca0c1d9c8162457a526a0  xsa332-linux-07.patch
5d821c58dd7fcdb157c2844ba34675305c320de25f54409305ffcba610d5922b  xsa332-linux-08.patch
242eb83eca8e3b6d2d303e2943aa041b5f19ea54242cd0de20252d2ae3d128d1  xsa332-linux-09.patch
70a042006d1df3dbbefc4c7d4dfd50da8f3a8e47ee77c2d6d0ba1eda405ae574  xsa332-linux-10.patch
ebbfa66d11b8c81353b72ed5f381672e6784a67895df482f7e791a9fb4c6fbf0  xsa332-linux-11.patch
cda1cbcca19860d43804e80ec2d7d13b295a140b42aa7d16118bb2d20bd63cae  xsa332-linux-12.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmAHB6QMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZbAwIAIDvNzGNP3XXzGzMbI3yiEBTzixf3W/75IqO8sHA
fFGJVPv9GEk2miB9NbwX/3opX1LXOlX+l4Uq+Zh+LnVO3tOYFwpzNaL+ji6D0BCp
Pi1i8B1MRhvHITcmoB76I9bZYWnAOKwMSoPIYWVInh5STFSosERmccvFAA5ar7Rw
aJYcs9Cuxt/8cJTpETD9nvm1m7vmXuqcj7szAd0DSVmaJwidHwTiIr4Qs1pVSk3K
RqPeHkjfg7/KRhQkpwwZbELDVRRylo5oEL9RklBwUPyiS297EFLFJut6w5rmycbS
vTK7w7Sby5Z2hv6oUn+2w6Y62LzHWZIFp5fwbvO5x6EdGRc=
=/68h
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-01.patch"
Content-Disposition: attachment; filename="xsa332-linux-01.patch"
Content-Transfer-Encoding: base64

RnJvbSBiYTBmOTZmOWM1MDk3NTNmZGIzZDM2NDRlODc1Yjc5NGQ4OTNlNGU4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyNyArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDEvMTJdIHhlbi9ldmVudHM6
IGFkZCBhIHByb3BlciBiYXJyaWVyIHRvIDItbGV2ZWwgdWV2ZW50CiB1bm1h
c2tpbmcKCkEgZm9sbG93LXVwIHBhdGNoIHdpbGwgcmVxdWlyZSBjZXJ0YWlu
IHdyaXRlIHRvIGhhcHBlbiBiZWZvcmUgYW4gZXZlbnQKY2hhbm5lbCBpcyB1
bm1hc2tlZC4KCldoaWxlIHRoZSBtZW1vcnkgYmFycmllciBpcyBub3Qgc3Ry
aWN0bHkgbmVjZXNzYXJ5IGZvciBhbGwgdGhlIGNhbGxlcnMsCnRoZSBtYWlu
IG9uZSB3aWxsIG5lZWQgaXQuIEluIG9yZGVyIHRvIGF2b2lkIGFuIGV4dHJh
IG1lbW9yeSBiYXJyaWVyCndoZW4gdXNpbmcgZmlmbyBldmVudCBjaGFubmVs
cywgbWFuZGF0ZSBldnRjaG5fdW5tYXNrKCkgdG8gcHJvdmlkZQp3cml0ZSBv
cmRlcmluZy4KClRoZSAyLWxldmVsIGV2ZW50IGhhbmRsaW5nIHVubWFzayBv
cGVyYXRpb24gaXMgbWlzc2luZyBhbiBhcHByb3ByaWF0ZQpiYXJyaWVyLCBz
byBhZGQgaXQuIEZpZm8gZXZlbnQgY2hhbm5lbHMgYXJlIGZpbmUgaW4gdGhp
cyByZWdhcmQgZHVlIHRvCnVzaW5nIHN5bmNfY21weGNoZygpLgoKVGhpcyBp
cyBwYXJ0IG9mIFhTQS0zMzIuCgpDYzogc3RhYmxlQHZnZXIua2VybmVsLm9y
ZwpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW5AeGVuLm9yZz4K
U3VnZ2VzdGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1bGllbkB4ZW4ub3JnPgpT
aWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+
ClJldmlld2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGpncmFsbEBhbWF6b24uY29t
PgpSZXZpZXdlZC1ieTogV2VpIExpdSA8d2xAeGVuLm9yZz4KLS0tCiBkcml2
ZXJzL3hlbi9ldmVudHMvZXZlbnRzXzJsLmMgfCAyICsrCiAxIGZpbGUgY2hh
bmdlZCwgMiBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy94
ZW4vZXZlbnRzL2V2ZW50c18ybC5jIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2
ZW50c18ybC5jCmluZGV4IDY0ZGY5MTlhMjExMS4uZTFhZjVlMDkzZmY0IDEw
MDY0NAotLS0gYS9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzXzJsLmMKKysr
IGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c18ybC5jCkBAIC05MSw2ICs5
MSw4IEBAIHN0YXRpYyB2b2lkIGV2dGNobl8ybF91bm1hc2soZXZ0Y2huX3Bv
cnRfdCBwb3J0KQogCiAJQlVHX09OKCFpcnFzX2Rpc2FibGVkKCkpOwogCisJ
c21wX3dtYigpOwkvKiBBbGwgd3JpdGVzIGJlZm9yZSB1bm1hc2sgbXVzdCBi
ZSB2aXNpYmxlLiAqLworCiAJaWYgKHVubGlrZWx5KChjcHUgIT0gY3B1X2Zy
b21fZXZ0Y2huKHBvcnQpKSkpCiAJCWRvX2h5cGVyY2FsbCA9IDE7CiAJZWxz
ZSB7Ci0tIAoyLjI2LjIKCg==

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-02.patch"
Content-Disposition: attachment; filename="xsa332-linux-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA4ZjA3ODkwOGYwZDQyNjE2OGY1YmMzZDg5YWViOTc5ZDg1ZGE2Y2Vm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMjAgT2N0IDIwMjAgMDY6
NTI6NTUgKzAyMDAKU3ViamVjdDogW1BBVENIIDAyLzEyXSB4ZW4vZXZlbnRz
OiBmaXggcmFjZSBpbiBldnRjaG5fZmlmb191bm1hc2soKQoKVW5tYXNraW5n
IGEgZmlmbyBldmVudCBjaGFubmVsIGNhbiByZXN1bHQgaW4gdW5tYXNraW5n
IGl0IHR3aWNlLCBvbmNlCmRpcmVjdGx5IGluIHRoZSBrZXJuZWwgYW5kIG9u
Y2UgdmlhIGEgaHlwZXJjYWxsIGluIGNhc2UgdGhlIGV2ZW50IHdhcwpwZW5k
aW5nLgoKRml4IHRoYXQgYnkgZG9pbmcgdGhlIGxvY2FsIHVubWFzayBvbmx5
IGlmIHRoZSBldmVudCBpcyBub3QgcGVuZGluZy4KClRoaXMgaXMgcGFydCBv
ZiBYU0EtMzMyLgoKQ2M6IHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmcKUmVwb3J0
ZWQtYnk6IEp1bGllbiBHcmFsbCA8anVsaWVuQHhlbi5vcmc+ClNpZ25lZC1v
ZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3
ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCiBk
cml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ZpZm8uYyB8IDEzICsrKysrKysr
Ky0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA5IGluc2VydGlvbnMoKyksIDQgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2
ZW50c19maWZvLmMgYi9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ZpZm8u
YwppbmRleCBjNjBlZTA0NTAxNzMuLjdmZDM5YzY0ZDRiNSAxMDA2NDQKLS0t
IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMKKysrIGIvZHJp
dmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMKQEAgLTIyNywxOSArMjI3
LDI1IEBAIHN0YXRpYyBib29sIGV2dGNobl9maWZvX2lzX21hc2tlZChldnRj
aG5fcG9ydF90IHBvcnQpCiAJcmV0dXJuIHN5bmNfdGVzdF9iaXQoRVZUQ0hO
X0ZJRk9fQklUKE1BU0tFRCwgd29yZCksIEJNKHdvcmQpKTsKIH0KIC8qCi0g
KiBDbGVhciBNQVNLRUQsIHNwaW5uaW5nIGlmIEJVU1kgaXMgc2V0LgorICog
Q2xlYXIgTUFTS0VEIGlmIG5vdCBQRU5ESU5HLCBzcGlubmluZyBpZiBCVVNZ
IGlzIHNldC4KKyAqIFJldHVybiB0cnVlIGlmIG1hc2sgd2FzIGNsZWFyZWQu
CiAgKi8KLXN0YXRpYyB2b2lkIGNsZWFyX21hc2tlZCh2b2xhdGlsZSBldmVu
dF93b3JkX3QgKndvcmQpCitzdGF0aWMgYm9vbCBjbGVhcl9tYXNrZWRfY29u
ZCh2b2xhdGlsZSBldmVudF93b3JkX3QgKndvcmQpCiB7CiAJZXZlbnRfd29y
ZF90IG5ldywgb2xkLCB3OwogCiAJdyA9ICp3b3JkOwogCiAJZG8geworCQlp
ZiAodyAmICgxIDw8IEVWVENITl9GSUZPX1BFTkRJTkcpKQorCQkJcmV0dXJu
IGZhbHNlOworCiAJCW9sZCA9IHcgJiB+KDEgPDwgRVZUQ0hOX0ZJRk9fQlVT
WSk7CiAJCW5ldyA9IG9sZCAmIH4oMSA8PCBFVlRDSE5fRklGT19NQVNLRUQp
OwogCQl3ID0gc3luY19jbXB4Y2hnKHdvcmQsIG9sZCwgbmV3KTsKIAl9IHdo
aWxlICh3ICE9IG9sZCk7CisKKwlyZXR1cm4gdHJ1ZTsKIH0KIAogc3RhdGlj
IHZvaWQgZXZ0Y2huX2ZpZm9fdW5tYXNrKGV2dGNobl9wb3J0X3QgcG9ydCkK
QEAgLTI0OCw4ICsyNTQsNyBAQCBzdGF0aWMgdm9pZCBldnRjaG5fZmlmb191
bm1hc2soZXZ0Y2huX3BvcnRfdCBwb3J0KQogCiAJQlVHX09OKCFpcnFzX2Rp
c2FibGVkKCkpOwogCi0JY2xlYXJfbWFza2VkKHdvcmQpOwotCWlmIChldnRj
aG5fZmlmb19pc19wZW5kaW5nKHBvcnQpKSB7CisJaWYgKCFjbGVhcl9tYXNr
ZWRfY29uZCh3b3JkKSkgewogCQlzdHJ1Y3QgZXZ0Y2huX3VubWFzayB1bm1h
c2sgPSB7IC5wb3J0ID0gcG9ydCB9OwogCQkodm9pZClIWVBFUlZJU09SX2V2
ZW50X2NoYW5uZWxfb3AoRVZUQ0hOT1BfdW5tYXNrLCAmdW5tYXNrKTsKIAl9
Ci0tIAoyLjI2LjIKCg==

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-03.patch"
Content-Disposition: attachment; filename="xsa332-linux-03.patch"
Content-Transfer-Encoding: base64

RnJvbSAyYjk0NTIwZTg5MzdkZjNjZmFjYjE4M2Y2MTc3NGQyN2UwZmZiNGM5
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyNyArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDMvMTJdIHhlbi9ldmVudHM6
IGFkZCBhIG5ldyAibGF0ZSBFT0kiIGV2dGNobiBmcmFtZXdvcmsKCkluIG9y
ZGVyIHRvIGF2b2lkIHRpZ2h0IGV2ZW50IGNoYW5uZWwgcmVsYXRlZCBJUlEg
bG9vcHMgYWRkIGEgbmV3CmZyYW1ld29yayBvZiAibGF0ZSBFT0kiIGhhbmRs
aW5nOiB0aGUgSVJRIHRoZSBldmVudCBjaGFubmVsIGlzIGJvdW5kCnRvIHdp
bGwgYmUgbWFza2VkIHVudGlsIHRoZSBldmVudCBoYXMgYmVlbiBoYW5kbGVk
IGFuZCB0aGUgcmVsYXRlZApkcml2ZXIgaXMgY2FwYWJsZSB0byBoYW5kbGUg
YW5vdGhlciBldmVudC4gVGhlIGRyaXZlciBpcyByZXNwb25zaWJsZQpmb3Ig
dW5tYXNraW5nIHRoZSBldmVudCBjaGFubmVsIHZpYSB0aGUgbmV3IGZ1bmN0
aW9uIHhlbl9pcnFfbGF0ZWVvaSgpLgoKVGhpcyBpcyBzaW1pbGFyIHRvIGJp
bmRpbmcgYW4gZXZlbnQgY2hhbm5lbCB0byBhIHRocmVhZGVkIElSUSwgYnV0
CndpdGhvdXQgaGF2aW5nIHRvIHN0cnVjdHVyZSB0aGUgZHJpdmVyIGFjY29y
ZGluZ2x5LgoKSW4gb3JkZXIgdG8gc3VwcG9ydCBhIGZ1dHVyZSBzcGVjaWFs
IGhhbmRsaW5nIGluIGNhc2UgYSByb2d1ZSBndWVzdAppcyBzZW5kaW5nIGxv
dHMgb2YgdW5zb2xpY2l0ZWQgZXZlbnRzLCBhZGQgYSBmbGFnIHRvIHhlbl9p
cnFfbGF0ZWVvaSgpCndoaWNoIGNhbiBiZSBzZXQgYnkgdGhlIGNhbGxlciB0
byBpbmRpY2F0ZSB0aGUgZXZlbnQgd2FzIGEgc3B1cmlvdXMKb25lLgoKVGhp
cyBpcyBwYXJ0IG9mIFhTQS0zMzIuCgpDYzogc3RhYmxlQHZnZXIua2VybmVs
Lm9yZwpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW5AeGVuLm9y
Zz4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2Uu
Y29tPgpSZXZpZXdlZC1ieTogU3RlZmFubyBTdGFiZWxsaW5pIDxzc3RhYmVs
bGluaUBrZXJuZWwub3JnPgpSZXZpZXdlZC1ieTogV2VpIExpdSA8d2xAeGVu
Lm9yZz4KLS0tCiBkcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2Jhc2UuYyB8
IDE1MSArKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tCiBpbmNsdWRl
L3hlbi9ldmVudHMuaCAgICAgICAgICAgICB8ICAyMSArKysrKwogMiBmaWxl
cyBjaGFuZ2VkLCAxNTUgaW5zZXJ0aW9ucygrKSwgMTcgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNl
LmMgYi9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2Jhc2UuYwppbmRleCA0
MDc3NDFlY2UwODQuLjFlYmE4YmMyMDlhZCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy94ZW4vZXZlbnRzL2V2ZW50c19iYXNlLmMKKysrIGIvZHJpdmVycy94ZW4v
ZXZlbnRzL2V2ZW50c19iYXNlLmMKQEAgLTExMyw2ICsxMTMsNyBAQCBzdGF0
aWMgYm9vbCAoKnBpcnFfbmVlZHNfZW9pKSh1bnNpZ25lZCBpcnEpOwogc3Rh
dGljIHN0cnVjdCBpcnFfaW5mbyAqbGVnYWN5X2luZm9fcHRyc1tOUl9JUlFT
X0xFR0FDWV07CiAKIHN0YXRpYyBzdHJ1Y3QgaXJxX2NoaXAgeGVuX2R5bmFt
aWNfY2hpcDsKK3N0YXRpYyBzdHJ1Y3QgaXJxX2NoaXAgeGVuX2xhdGVlb2lf
Y2hpcDsKIHN0YXRpYyBzdHJ1Y3QgaXJxX2NoaXAgeGVuX3BlcmNwdV9jaGlw
Owogc3RhdGljIHN0cnVjdCBpcnFfY2hpcCB4ZW5fcGlycV9jaGlwOwogc3Rh
dGljIHZvaWQgZW5hYmxlX2R5bmlycShzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEp
OwpAQCAtMzk3LDYgKzM5OCwzMyBAQCB2b2lkIG5vdGlmeV9yZW1vdGVfdmlh
X2lycShpbnQgaXJxKQogfQogRVhQT1JUX1NZTUJPTF9HUEwobm90aWZ5X3Jl
bW90ZV92aWFfaXJxKTsKIAorc3RhdGljIHZvaWQgeGVuX2lycV9sYXRlZW9p
X2xvY2tlZChzdHJ1Y3QgaXJxX2luZm8gKmluZm8pCit7CisJZXZ0Y2huX3Bv
cnRfdCBldnRjaG47CisKKwlldnRjaG4gPSBpbmZvLT5ldnRjaG47CisJaWYg
KCFWQUxJRF9FVlRDSE4oZXZ0Y2huKSkKKwkJcmV0dXJuOworCisJdW5tYXNr
X2V2dGNobihldnRjaG4pOworfQorCit2b2lkIHhlbl9pcnFfbGF0ZWVvaSh1
bnNpZ25lZCBpbnQgaXJxLCB1bnNpZ25lZCBpbnQgZW9pX2ZsYWdzKQorewor
CXN0cnVjdCBpcnFfaW5mbyAqaW5mbzsKKwl1bnNpZ25lZCBsb25nIGZsYWdz
OworCisJcmVhZF9sb2NrX2lycXNhdmUoJmV2dGNobl9yd2xvY2ssIGZsYWdz
KTsKKworCWluZm8gPSBpbmZvX2Zvcl9pcnEoaXJxKTsKKworCWlmIChpbmZv
KQorCQl4ZW5faXJxX2xhdGVlb2lfbG9ja2VkKGluZm8pOworCisJcmVhZF91
bmxvY2tfaXJxcmVzdG9yZSgmZXZ0Y2huX3J3bG9jaywgZmxhZ3MpOworfQor
RVhQT1JUX1NZTUJPTF9HUEwoeGVuX2lycV9sYXRlZW9pKTsKKwogc3RhdGlj
IHZvaWQgeGVuX2lycV9pbml0KHVuc2lnbmVkIGlycSkKIHsKIAlzdHJ1Y3Qg
aXJxX2luZm8gKmluZm87CkBAIC04NjgsNyArODk2LDcgQEAgaW50IHhlbl9w
aXJxX2Zyb21faXJxKHVuc2lnbmVkIGlycSkKIH0KIEVYUE9SVF9TWU1CT0xf
R1BMKHhlbl9waXJxX2Zyb21faXJxKTsKIAotaW50IGJpbmRfZXZ0Y2huX3Rv
X2lycShldnRjaG5fcG9ydF90IGV2dGNobikKK3N0YXRpYyBpbnQgYmluZF9l
dnRjaG5fdG9faXJxX2NoaXAoZXZ0Y2huX3BvcnRfdCBldnRjaG4sIHN0cnVj
dCBpcnFfY2hpcCAqY2hpcCkKIHsKIAlpbnQgaXJxOwogCWludCByZXQ7CkBA
IC04ODUsNyArOTEzLDcgQEAgaW50IGJpbmRfZXZ0Y2huX3RvX2lycShldnRj
aG5fcG9ydF90IGV2dGNobikKIAkJaWYgKGlycSA8IDApCiAJCQlnb3RvIG91
dDsKIAotCQlpcnFfc2V0X2NoaXBfYW5kX2hhbmRsZXJfbmFtZShpcnEsICZ4
ZW5fZHluYW1pY19jaGlwLAorCQlpcnFfc2V0X2NoaXBfYW5kX2hhbmRsZXJf
bmFtZShpcnEsIGNoaXAsCiAJCQkJCSAgICAgIGhhbmRsZV9lZGdlX2lycSwg
ImV2ZW50Iik7CiAKIAkJcmV0ID0geGVuX2lycV9pbmZvX2V2dGNobl9zZXR1
cChpcnEsIGV2dGNobik7CkBAIC05MDYsOCArOTM0LDE5IEBAIGludCBiaW5k
X2V2dGNobl90b19pcnEoZXZ0Y2huX3BvcnRfdCBldnRjaG4pCiAKIAlyZXR1
cm4gaXJxOwogfQorCitpbnQgYmluZF9ldnRjaG5fdG9faXJxKGV2dGNobl9w
b3J0X3QgZXZ0Y2huKQoreworCXJldHVybiBiaW5kX2V2dGNobl90b19pcnFf
Y2hpcChldnRjaG4sICZ4ZW5fZHluYW1pY19jaGlwKTsKK30KIEVYUE9SVF9T
WU1CT0xfR1BMKGJpbmRfZXZ0Y2huX3RvX2lycSk7CiAKK2ludCBiaW5kX2V2
dGNobl90b19pcnFfbGF0ZWVvaShldnRjaG5fcG9ydF90IGV2dGNobikKK3sK
KwlyZXR1cm4gYmluZF9ldnRjaG5fdG9faXJxX2NoaXAoZXZ0Y2huLCAmeGVu
X2xhdGVlb2lfY2hpcCk7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChiaW5kX2V2
dGNobl90b19pcnFfbGF0ZWVvaSk7CisKIHN0YXRpYyBpbnQgYmluZF9pcGlf
dG9faXJxKHVuc2lnbmVkIGludCBpcGksIHVuc2lnbmVkIGludCBjcHUpCiB7
CiAJc3RydWN0IGV2dGNobl9iaW5kX2lwaSBiaW5kX2lwaTsKQEAgLTk0OSw4
ICs5ODgsOSBAQCBzdGF0aWMgaW50IGJpbmRfaXBpX3RvX2lycSh1bnNpZ25l
ZCBpbnQgaXBpLCB1bnNpZ25lZCBpbnQgY3B1KQogCXJldHVybiBpcnE7CiB9
CiAKLWludCBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnEodW5zaWdu
ZWQgaW50IHJlbW90ZV9kb21haW4sCi0JCQkJICAgZXZ0Y2huX3BvcnRfdCBy
ZW1vdGVfcG9ydCkKK3N0YXRpYyBpbnQgYmluZF9pbnRlcmRvbWFpbl9ldnRj
aG5fdG9faXJxX2NoaXAodW5zaWduZWQgaW50IHJlbW90ZV9kb21haW4sCisJ
CQkJCSAgICAgICBldnRjaG5fcG9ydF90IHJlbW90ZV9wb3J0LAorCQkJCQkg
ICAgICAgc3RydWN0IGlycV9jaGlwICpjaGlwKQogewogCXN0cnVjdCBldnRj
aG5fYmluZF9pbnRlcmRvbWFpbiBiaW5kX2ludGVyZG9tYWluOwogCWludCBl
cnI7CkBAIC05NjEsMTAgKzEwMDEsMjYgQEAgaW50IGJpbmRfaW50ZXJkb21h
aW5fZXZ0Y2huX3RvX2lycSh1bnNpZ25lZCBpbnQgcmVtb3RlX2RvbWFpbiwK
IAllcnIgPSBIWVBFUlZJU09SX2V2ZW50X2NoYW5uZWxfb3AoRVZUQ0hOT1Bf
YmluZF9pbnRlcmRvbWFpbiwKIAkJCQkJICAmYmluZF9pbnRlcmRvbWFpbik7
CiAKLQlyZXR1cm4gZXJyID8gOiBiaW5kX2V2dGNobl90b19pcnEoYmluZF9p
bnRlcmRvbWFpbi5sb2NhbF9wb3J0KTsKKwlyZXR1cm4gZXJyID8gOiBiaW5k
X2V2dGNobl90b19pcnFfY2hpcChiaW5kX2ludGVyZG9tYWluLmxvY2FsX3Bv
cnQsCisJCQkJCSAgICAgICBjaGlwKTsKK30KKworaW50IGJpbmRfaW50ZXJk
b21haW5fZXZ0Y2huX3RvX2lycSh1bnNpZ25lZCBpbnQgcmVtb3RlX2RvbWFp
biwKKwkJCQkgICBldnRjaG5fcG9ydF90IHJlbW90ZV9wb3J0KQoreworCXJl
dHVybiBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnFfY2hpcChyZW1v
dGVfZG9tYWluLCByZW1vdGVfcG9ydCwKKwkJCQkJCSAgICZ4ZW5fZHluYW1p
Y19jaGlwKTsKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKGJpbmRfaW50ZXJkb21h
aW5fZXZ0Y2huX3RvX2lycSk7CiAKK2ludCBiaW5kX2ludGVyZG9tYWluX2V2
dGNobl90b19pcnFfbGF0ZWVvaSh1bnNpZ25lZCBpbnQgcmVtb3RlX2RvbWFp
biwKKwkJCQkJICAgZXZ0Y2huX3BvcnRfdCByZW1vdGVfcG9ydCkKK3sKKwly
ZXR1cm4gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxX2NoaXAocmVt
b3RlX2RvbWFpbiwgcmVtb3RlX3BvcnQsCisJCQkJCQkgICAmeGVuX2xhdGVl
b2lfY2hpcCk7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChiaW5kX2ludGVyZG9t
YWluX2V2dGNobl90b19pcnFfbGF0ZWVvaSk7CisKIHN0YXRpYyBpbnQgZmlu
ZF92aXJxKHVuc2lnbmVkIGludCB2aXJxLCB1bnNpZ25lZCBpbnQgY3B1LCBl
dnRjaG5fcG9ydF90ICpldnRjaG4pCiB7CiAJc3RydWN0IGV2dGNobl9zdGF0
dXMgc3RhdHVzOwpAQCAtMTA2MSwxNCArMTExNywxNSBAQCBzdGF0aWMgdm9p
ZCB1bmJpbmRfZnJvbV9pcnEodW5zaWduZWQgaW50IGlycSkKIAltdXRleF91
bmxvY2soJmlycV9tYXBwaW5nX3VwZGF0ZV9sb2NrKTsKIH0KIAotaW50IGJp
bmRfZXZ0Y2huX3RvX2lycWhhbmRsZXIoZXZ0Y2huX3BvcnRfdCBldnRjaG4s
Ci0JCQkgICAgICBpcnFfaGFuZGxlcl90IGhhbmRsZXIsCi0JCQkgICAgICB1
bnNpZ25lZCBsb25nIGlycWZsYWdzLAotCQkJICAgICAgY29uc3QgY2hhciAq
ZGV2bmFtZSwgdm9pZCAqZGV2X2lkKQorc3RhdGljIGludCBiaW5kX2V2dGNo
bl90b19pcnFoYW5kbGVyX2NoaXAoZXZ0Y2huX3BvcnRfdCBldnRjaG4sCisJ
CQkJCSAgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLAorCQkJCQkgIHVuc2lnbmVk
IGxvbmcgaXJxZmxhZ3MsCisJCQkJCSAgY29uc3QgY2hhciAqZGV2bmFtZSwg
dm9pZCAqZGV2X2lkLAorCQkJCQkgIHN0cnVjdCBpcnFfY2hpcCAqY2hpcCkK
IHsKIAlpbnQgaXJxLCByZXR2YWw7CiAKLQlpcnEgPSBiaW5kX2V2dGNobl90
b19pcnEoZXZ0Y2huKTsKKwlpcnEgPSBiaW5kX2V2dGNobl90b19pcnFfY2hp
cChldnRjaG4sIGNoaXApOwogCWlmIChpcnEgPCAwKQogCQlyZXR1cm4gaXJx
OwogCXJldHZhbCA9IHJlcXVlc3RfaXJxKGlycSwgaGFuZGxlciwgaXJxZmxh
Z3MsIGRldm5hbWUsIGRldl9pZCk7CkBAIC0xMDc5LDE4ICsxMTM2LDM4IEBA
IGludCBiaW5kX2V2dGNobl90b19pcnFoYW5kbGVyKGV2dGNobl9wb3J0X3Qg
ZXZ0Y2huLAogCiAJcmV0dXJuIGlycTsKIH0KKworaW50IGJpbmRfZXZ0Y2hu
X3RvX2lycWhhbmRsZXIoZXZ0Y2huX3BvcnRfdCBldnRjaG4sCisJCQkgICAg
ICBpcnFfaGFuZGxlcl90IGhhbmRsZXIsCisJCQkgICAgICB1bnNpZ25lZCBs
b25nIGlycWZsYWdzLAorCQkJICAgICAgY29uc3QgY2hhciAqZGV2bmFtZSwg
dm9pZCAqZGV2X2lkKQoreworCXJldHVybiBiaW5kX2V2dGNobl90b19pcnFo
YW5kbGVyX2NoaXAoZXZ0Y2huLCBoYW5kbGVyLCBpcnFmbGFncywKKwkJCQkJ
ICAgICAgZGV2bmFtZSwgZGV2X2lkLAorCQkJCQkgICAgICAmeGVuX2R5bmFt
aWNfY2hpcCk7Cit9CiBFWFBPUlRfU1lNQk9MX0dQTChiaW5kX2V2dGNobl90
b19pcnFoYW5kbGVyKTsKIAotaW50IGJpbmRfaW50ZXJkb21haW5fZXZ0Y2hu
X3RvX2lycWhhbmRsZXIodW5zaWduZWQgaW50IHJlbW90ZV9kb21haW4sCi0J
CQkJCSAgZXZ0Y2huX3BvcnRfdCByZW1vdGVfcG9ydCwKLQkJCQkJICBpcnFf
aGFuZGxlcl90IGhhbmRsZXIsCi0JCQkJCSAgdW5zaWduZWQgbG9uZyBpcnFm
bGFncywKLQkJCQkJICBjb25zdCBjaGFyICpkZXZuYW1lLAotCQkJCQkgIHZv
aWQgKmRldl9pZCkKK2ludCBiaW5kX2V2dGNobl90b19pcnFoYW5kbGVyX2xh
dGVlb2koZXZ0Y2huX3BvcnRfdCBldnRjaG4sCisJCQkJICAgICAgaXJxX2hh
bmRsZXJfdCBoYW5kbGVyLAorCQkJCSAgICAgIHVuc2lnbmVkIGxvbmcgaXJx
ZmxhZ3MsCisJCQkJICAgICAgY29uc3QgY2hhciAqZGV2bmFtZSwgdm9pZCAq
ZGV2X2lkKQoreworCXJldHVybiBiaW5kX2V2dGNobl90b19pcnFoYW5kbGVy
X2NoaXAoZXZ0Y2huLCBoYW5kbGVyLCBpcnFmbGFncywKKwkJCQkJICAgICAg
ZGV2bmFtZSwgZGV2X2lkLAorCQkJCQkgICAgICAmeGVuX2xhdGVlb2lfY2hp
cCk7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChiaW5kX2V2dGNobl90b19pcnFo
YW5kbGVyX2xhdGVlb2kpOworCitzdGF0aWMgaW50IGJpbmRfaW50ZXJkb21h
aW5fZXZ0Y2huX3RvX2lycWhhbmRsZXJfY2hpcCgKKwkJdW5zaWduZWQgaW50
IHJlbW90ZV9kb21haW4sIGV2dGNobl9wb3J0X3QgcmVtb3RlX3BvcnQsCisJ
CWlycV9oYW5kbGVyX3QgaGFuZGxlciwgdW5zaWduZWQgbG9uZyBpcnFmbGFn
cywKKwkJY29uc3QgY2hhciAqZGV2bmFtZSwgdm9pZCAqZGV2X2lkLCBzdHJ1
Y3QgaXJxX2NoaXAgKmNoaXApCiB7CiAJaW50IGlycSwgcmV0dmFsOwogCi0J
aXJxID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxKHJlbW90ZV9k
b21haW4sIHJlbW90ZV9wb3J0KTsKKwlpcnEgPSBiaW5kX2ludGVyZG9tYWlu
X2V2dGNobl90b19pcnFfY2hpcChyZW1vdGVfZG9tYWluLCByZW1vdGVfcG9y
dCwKKwkJCQkJCSAgY2hpcCk7CiAJaWYgKGlycSA8IDApCiAJCXJldHVybiBp
cnE7CiAKQEAgLTExMDIsOCArMTE3OSwzMyBAQCBpbnQgYmluZF9pbnRlcmRv
bWFpbl9ldnRjaG5fdG9faXJxaGFuZGxlcih1bnNpZ25lZCBpbnQgcmVtb3Rl
X2RvbWFpbiwKIAogCXJldHVybiBpcnE7CiB9CisKK2ludCBiaW5kX2ludGVy
ZG9tYWluX2V2dGNobl90b19pcnFoYW5kbGVyKHVuc2lnbmVkIGludCByZW1v
dGVfZG9tYWluLAorCQkJCQkgIGV2dGNobl9wb3J0X3QgcmVtb3RlX3BvcnQs
CisJCQkJCSAgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLAorCQkJCQkgIHVuc2ln
bmVkIGxvbmcgaXJxZmxhZ3MsCisJCQkJCSAgY29uc3QgY2hhciAqZGV2bmFt
ZSwKKwkJCQkJICB2b2lkICpkZXZfaWQpCit7CisJcmV0dXJuIGJpbmRfaW50
ZXJkb21haW5fZXZ0Y2huX3RvX2lycWhhbmRsZXJfY2hpcChyZW1vdGVfZG9t
YWluLAorCQkJCXJlbW90ZV9wb3J0LCBoYW5kbGVyLCBpcnFmbGFncywgZGV2
bmFtZSwKKwkJCQlkZXZfaWQsICZ4ZW5fZHluYW1pY19jaGlwKTsKK30KIEVY
UE9SVF9TWU1CT0xfR1BMKGJpbmRfaW50ZXJkb21haW5fZXZ0Y2huX3RvX2ly
cWhhbmRsZXIpOwogCitpbnQgYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9f
aXJxaGFuZGxlcl9sYXRlZW9pKHVuc2lnbmVkIGludCByZW1vdGVfZG9tYWlu
LAorCQkJCQkJICBldnRjaG5fcG9ydF90IHJlbW90ZV9wb3J0LAorCQkJCQkJ
ICBpcnFfaGFuZGxlcl90IGhhbmRsZXIsCisJCQkJCQkgIHVuc2lnbmVkIGxv
bmcgaXJxZmxhZ3MsCisJCQkJCQkgIGNvbnN0IGNoYXIgKmRldm5hbWUsCisJ
CQkJCQkgIHZvaWQgKmRldl9pZCkKK3sKKwlyZXR1cm4gYmluZF9pbnRlcmRv
bWFpbl9ldnRjaG5fdG9faXJxaGFuZGxlcl9jaGlwKHJlbW90ZV9kb21haW4s
CisJCQkJcmVtb3RlX3BvcnQsIGhhbmRsZXIsIGlycWZsYWdzLCBkZXZuYW1l
LAorCQkJCWRldl9pZCwgJnhlbl9sYXRlZW9pX2NoaXApOworfQorRVhQT1JU
X1NZTUJPTF9HUEwoYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxaGFu
ZGxlcl9sYXRlZW9pKTsKKwogaW50IGJpbmRfdmlycV90b19pcnFoYW5kbGVy
KHVuc2lnbmVkIGludCB2aXJxLCB1bnNpZ25lZCBpbnQgY3B1LAogCQkJICAg
IGlycV9oYW5kbGVyX3QgaGFuZGxlciwKIAkJCSAgICB1bnNpZ25lZCBsb25n
IGlycWZsYWdzLCBjb25zdCBjaGFyICpkZXZuYW1lLCB2b2lkICpkZXZfaWQp
CkBAIC0xNjM3LDYgKzE3MzksMjEgQEAgc3RhdGljIHN0cnVjdCBpcnFfY2hp
cCB4ZW5fZHluYW1pY19jaGlwIF9fcmVhZF9tb3N0bHkgPSB7CiAJLmlycV9y
ZXRyaWdnZXIJCT0gcmV0cmlnZ2VyX2R5bmlycSwKIH07CiAKK3N0YXRpYyBz
dHJ1Y3QgaXJxX2NoaXAgeGVuX2xhdGVlb2lfY2hpcCBfX3JlYWRfbW9zdGx5
ID0geworCS8qIFRoZSBjaGlwIG5hbWUgbmVlZHMgdG8gY29udGFpbiAieGVu
LWR5biIgZm9yIGlycWJhbGFuY2UgdG8gd29yay4gKi8KKwkubmFtZQkJCT0g
Inhlbi1keW4tbGF0ZWVvaSIsCisKKwkuaXJxX2Rpc2FibGUJCT0gZGlzYWJs
ZV9keW5pcnEsCisJLmlycV9tYXNrCQk9IGRpc2FibGVfZHluaXJxLAorCS5p
cnFfdW5tYXNrCQk9IGVuYWJsZV9keW5pcnEsCisKKwkuaXJxX2FjawkJPSBt
YXNrX2Fja19keW5pcnEsCisJLmlycV9tYXNrX2FjawkJPSBtYXNrX2Fja19k
eW5pcnEsCisKKwkuaXJxX3NldF9hZmZpbml0eQk9IHNldF9hZmZpbml0eV9p
cnEsCisJLmlycV9yZXRyaWdnZXIJCT0gcmV0cmlnZ2VyX2R5bmlycSwKK307
CisKIHN0YXRpYyBzdHJ1Y3QgaXJxX2NoaXAgeGVuX3BpcnFfY2hpcCBfX3Jl
YWRfbW9zdGx5ID0gewogCS5uYW1lCQkJPSAieGVuLXBpcnEiLAogCmRpZmYg
LS1naXQgYS9pbmNsdWRlL3hlbi9ldmVudHMuaCBiL2luY2x1ZGUveGVuL2V2
ZW50cy5oCmluZGV4IGRmMWU2MzkxZjYzZi4uM2I4MTU1YzJlYTAzIDEwMDY0
NAotLS0gYS9pbmNsdWRlL3hlbi9ldmVudHMuaAorKysgYi9pbmNsdWRlL3hl
bi9ldmVudHMuaApAQCAtMTUsMTAgKzE1LDE1IEBACiB1bnNpZ25lZCB4ZW5f
ZXZ0Y2huX25yX2NoYW5uZWxzKHZvaWQpOwogCiBpbnQgYmluZF9ldnRjaG5f
dG9faXJxKGV2dGNobl9wb3J0X3QgZXZ0Y2huKTsKK2ludCBiaW5kX2V2dGNo
bl90b19pcnFfbGF0ZWVvaShldnRjaG5fcG9ydF90IGV2dGNobik7CiBpbnQg
YmluZF9ldnRjaG5fdG9faXJxaGFuZGxlcihldnRjaG5fcG9ydF90IGV2dGNo
biwKIAkJCSAgICAgIGlycV9oYW5kbGVyX3QgaGFuZGxlciwKIAkJCSAgICAg
IHVuc2lnbmVkIGxvbmcgaXJxZmxhZ3MsIGNvbnN0IGNoYXIgKmRldm5hbWUs
CiAJCQkgICAgICB2b2lkICpkZXZfaWQpOworaW50IGJpbmRfZXZ0Y2huX3Rv
X2lycWhhbmRsZXJfbGF0ZWVvaShldnRjaG5fcG9ydF90IGV2dGNobiwKKwkJ
CSAgICAgIGlycV9oYW5kbGVyX3QgaGFuZGxlciwKKwkJCSAgICAgIHVuc2ln
bmVkIGxvbmcgaXJxZmxhZ3MsIGNvbnN0IGNoYXIgKmRldm5hbWUsCisJCQkg
ICAgICB2b2lkICpkZXZfaWQpOwogaW50IGJpbmRfdmlycV90b19pcnEodW5z
aWduZWQgaW50IHZpcnEsIHVuc2lnbmVkIGludCBjcHUsIGJvb2wgcGVyY3B1
KTsKIGludCBiaW5kX3ZpcnFfdG9faXJxaGFuZGxlcih1bnNpZ25lZCBpbnQg
dmlycSwgdW5zaWduZWQgaW50IGNwdSwKIAkJCSAgICBpcnFfaGFuZGxlcl90
IGhhbmRsZXIsCkBAIC0zMiwxMiArMzcsMjAgQEAgaW50IGJpbmRfaXBpX3Rv
X2lycWhhbmRsZXIoZW51bSBpcGlfdmVjdG9yIGlwaSwKIAkJCSAgIHZvaWQg
KmRldl9pZCk7CiBpbnQgYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJx
KHVuc2lnbmVkIGludCByZW1vdGVfZG9tYWluLAogCQkJCSAgIGV2dGNobl9w
b3J0X3QgcmVtb3RlX3BvcnQpOworaW50IGJpbmRfaW50ZXJkb21haW5fZXZ0
Y2huX3RvX2lycV9sYXRlZW9pKHVuc2lnbmVkIGludCByZW1vdGVfZG9tYWlu
LAorCQkJCQkgICBldnRjaG5fcG9ydF90IHJlbW90ZV9wb3J0KTsKIGludCBi
aW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnFoYW5kbGVyKHVuc2lnbmVk
IGludCByZW1vdGVfZG9tYWluLAogCQkJCQkgIGV2dGNobl9wb3J0X3QgcmVt
b3RlX3BvcnQsCiAJCQkJCSAgaXJxX2hhbmRsZXJfdCBoYW5kbGVyLAogCQkJ
CQkgIHVuc2lnbmVkIGxvbmcgaXJxZmxhZ3MsCiAJCQkJCSAgY29uc3QgY2hh
ciAqZGV2bmFtZSwKIAkJCQkJICB2b2lkICpkZXZfaWQpOworaW50IGJpbmRf
aW50ZXJkb21haW5fZXZ0Y2huX3RvX2lycWhhbmRsZXJfbGF0ZWVvaSh1bnNp
Z25lZCBpbnQgcmVtb3RlX2RvbWFpbiwKKwkJCQkJCSAgZXZ0Y2huX3BvcnRf
dCByZW1vdGVfcG9ydCwKKwkJCQkJCSAgaXJxX2hhbmRsZXJfdCBoYW5kbGVy
LAorCQkJCQkJICB1bnNpZ25lZCBsb25nIGlycWZsYWdzLAorCQkJCQkJICBj
b25zdCBjaGFyICpkZXZuYW1lLAorCQkJCQkJICB2b2lkICpkZXZfaWQpOwog
CiAvKgogICogQ29tbW9uIHVuYmluZCBmdW5jdGlvbiBmb3IgYWxsIGV2ZW50
IHNvdXJjZXMuIFRha2VzIElSUSB0byB1bmJpbmQgZnJvbS4KQEAgLTQ2LDYg
KzU5LDE0IEBAIGludCBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnFo
YW5kbGVyKHVuc2lnbmVkIGludCByZW1vdGVfZG9tYWluLAogICovCiB2b2lk
IHVuYmluZF9mcm9tX2lycWhhbmRsZXIodW5zaWduZWQgaW50IGlycSwgdm9p
ZCAqZGV2X2lkKTsKIAorLyoKKyAqIFNlbmQgbGF0ZSBFT0kgZm9yIGFuIElS
USBib3VuZCB0byBhbiBldmVudCBjaGFubmVsIHZpYSBvbmUgb2YgdGhlICpf
bGF0ZWVvaQorICogZnVuY3Rpb25zIGFib3ZlLgorICovCit2b2lkIHhlbl9p
cnFfbGF0ZWVvaSh1bnNpZ25lZCBpbnQgaXJxLCB1bnNpZ25lZCBpbnQgZW9p
X2ZsYWdzKTsKKy8qIFNpZ25hbCBhbiBldmVudCB3YXMgc3B1cmlvdXMsIGku
ZS4gdGhlcmUgd2FzIG5vIGFjdGlvbiByZXN1bHRpbmcgZnJvbSBpdC4gKi8K
KyNkZWZpbmUgWEVOX0VPSV9GTEFHX1NQVVJJT1VTCTB4MDAwMDAwMDEKKwog
I2RlZmluZSBYRU5fSVJRX1BSSU9SSVRZX01BWCAgICAgRVZUQ0hOX0ZJRk9f
UFJJT1JJVFlfTUFYCiAjZGVmaW5lIFhFTl9JUlFfUFJJT1JJVFlfREVGQVVM
VCBFVlRDSE5fRklGT19QUklPUklUWV9ERUZBVUxUCiAjZGVmaW5lIFhFTl9J
UlFfUFJJT1JJVFlfTUlOICAgICBFVlRDSE5fRklGT19QUklPUklUWV9NSU4K
LS0gCjIuMjYuMgoK

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-04.patch"
Content-Disposition: attachment; filename="xsa332-linux-04.patch"
Content-Transfer-Encoding: base64

RnJvbSBjMmYxNzY0YTZhZTI1YzJlZmEwNDhlN2YyZTA3MDI0NzM5ZTk2OWQ2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyNyArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDQvMTJdIHhlbi9ibGtiYWNr
OiB1c2UgbGF0ZWVvaSBpcnEgYmluZGluZwoKSW4gb3JkZXIgdG8gcmVkdWNl
IHRoZSBjaGFuY2UgZm9yIHRoZSBzeXN0ZW0gYmVjb21pbmcgdW5yZXNwb25z
aXZlIGR1ZQp0byBldmVudCBzdG9ybXMgdHJpZ2dlcmVkIGJ5IGEgbWlzYmVo
YXZpbmcgYmxrZnJvbnQgdXNlIHRoZSBsYXRlZW9pCmlycSBiaW5kaW5nIGZv
ciBibGtiYWNrIGFuZCB1bm1hc2sgdGhlIGV2ZW50IGNoYW5uZWwgb25seSBh
ZnRlcgpwcm9jZXNzaW5nIGFsbCBwZW5kaW5nIHJlcXVlc3RzLgoKQXMgdGhl
IHRocmVhZCBwcm9jZXNzaW5nIHJlcXVlc3RzIGlzIHVzZWQgdG8gZG8gcHVy
Z2luZyB3b3JrIGluIHJlZ3VsYXIKaW50ZXJ2YWxzIGFuIEVPSSBtYXkgYmUg
c2VudCBvbmx5IGFmdGVyIGhhdmluZyByZWNlaXZlZCBhbiBldmVudC4gSWYK
dGhlcmUgd2FzIG5vIHBlbmRpbmcgSS9PIHJlcXVlc3QgZmxhZyB0aGUgRU9J
IGFzIHNwdXJpb3VzLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMzIuCgpDYzog
c3RhYmxlQHZnZXIua2VybmVsLm9yZwpSZXBvcnRlZC1ieTogSnVsaWVuIEdy
YWxsIDxqdWxpZW5AeGVuLm9yZz4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBH
cm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogV2VpIExpdSA8
d2xAeGVuLm9yZz4KLS0tCiBkcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Js
a2JhY2suYyB8IDIyICsrKysrKysrKysrKysrKysrLS0tLS0KIGRyaXZlcnMv
YmxvY2sveGVuLWJsa2JhY2sveGVuYnVzLmMgIHwgIDUgKystLS0KIDIgZmls
ZXMgY2hhbmdlZCwgMTkgaW5zZXJ0aW9ucygrKSwgOCBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Jsa2Jh
Y2suYyBiL2RyaXZlcnMvYmxvY2sveGVuLWJsa2JhY2svYmxrYmFjay5jCmlu
ZGV4IGFkZmM5MzUyMzUxZC4uNTAxZTlkYWNmZmY5IDEwMDY0NAotLS0gYS9k
cml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Jsa2JhY2suYworKysgYi9kcml2
ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Jsa2JhY2suYwpAQCAtMjAxLDcgKzIw
MSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzaHJpbmtfZnJlZV9wYWdlcG9v
bChzdHJ1Y3QgeGVuX2Jsa2lmX3JpbmcgKnJpbmcsIGludCBudW0pCiAKICNk
ZWZpbmUgdmFkZHIocGFnZSkgKCh1bnNpZ25lZCBsb25nKXBmbl90b19rYWRk
cihwYWdlX3RvX3BmbihwYWdlKSkpCiAKLXN0YXRpYyBpbnQgZG9fYmxvY2tf
aW9fb3Aoc3RydWN0IHhlbl9ibGtpZl9yaW5nICpyaW5nKTsKK3N0YXRpYyBp
bnQgZG9fYmxvY2tfaW9fb3Aoc3RydWN0IHhlbl9ibGtpZl9yaW5nICpyaW5n
LCB1bnNpZ25lZCBpbnQgKmVvaV9mbGFncyk7CiBzdGF0aWMgaW50IGRpc3Bh
dGNoX3J3X2Jsb2NrX2lvKHN0cnVjdCB4ZW5fYmxraWZfcmluZyAqcmluZywK
IAkJCQlzdHJ1Y3QgYmxraWZfcmVxdWVzdCAqcmVxLAogCQkJCXN0cnVjdCBw
ZW5kaW5nX3JlcSAqcGVuZGluZ19yZXEpOwpAQCAtNjEyLDYgKzYxMiw4IEBA
IGludCB4ZW5fYmxraWZfc2NoZWR1bGUodm9pZCAqYXJnKQogCXN0cnVjdCB4
ZW5fdmJkICp2YmQgPSAmYmxraWYtPnZiZDsKIAl1bnNpZ25lZCBsb25nIHRp
bWVvdXQ7CiAJaW50IHJldDsKKwlib29sIGRvX2VvaTsKKwl1bnNpZ25lZCBp
bnQgZW9pX2ZsYWdzID0gWEVOX0VPSV9GTEFHX1NQVVJJT1VTOwogCiAJc2V0
X2ZyZWV6YWJsZSgpOwogCXdoaWxlICgha3RocmVhZF9zaG91bGRfc3RvcCgp
KSB7CkBAIC02MzYsMTYgKzYzOCwyMyBAQCBpbnQgeGVuX2Jsa2lmX3NjaGVk
dWxlKHZvaWQgKmFyZykKIAkJaWYgKHRpbWVvdXQgPT0gMCkKIAkJCWdvdG8g
cHVyZ2VfZ250X2xpc3Q7CiAKKwkJZG9fZW9pID0gcmluZy0+d2FpdGluZ19y
ZXFzOworCiAJCXJpbmctPndhaXRpbmdfcmVxcyA9IDA7CiAJCXNtcF9tYigp
OyAvKiBjbGVhciBmbGFnICpiZWZvcmUqIGNoZWNraW5nIGZvciB3b3JrICov
CiAKLQkJcmV0ID0gZG9fYmxvY2tfaW9fb3AocmluZyk7CisJCXJldCA9IGRv
X2Jsb2NrX2lvX29wKHJpbmcsICZlb2lfZmxhZ3MpOwogCQlpZiAocmV0ID4g
MCkKIAkJCXJpbmctPndhaXRpbmdfcmVxcyA9IDE7CiAJCWlmIChyZXQgPT0g
LUVBQ0NFUykKIAkJCXdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZShyaW5nLT5z
aHV0ZG93bl93cSwKIAkJCQkJCSBrdGhyZWFkX3Nob3VsZF9zdG9wKCkpOwog
CisJCWlmIChkb19lb2kgJiYgIXJpbmctPndhaXRpbmdfcmVxcykgeworCQkJ
eGVuX2lycV9sYXRlZW9pKHJpbmctPmlycSwgZW9pX2ZsYWdzKTsKKwkJCWVv
aV9mbGFncyB8PSBYRU5fRU9JX0ZMQUdfU1BVUklPVVM7CisJCX0KKwogcHVy
Z2VfZ250X2xpc3Q6CiAJCWlmIChibGtpZi0+dmJkLmZlYXR1cmVfZ250X3Bl
cnNpc3RlbnQgJiYKIAkJICAgIHRpbWVfYWZ0ZXIoamlmZmllcywgcmluZy0+
bmV4dF9scnUpKSB7CkBAIC0xMTIxLDcgKzExMzAsNyBAQCBzdGF0aWMgdm9p
ZCBlbmRfYmxvY2tfaW9fb3Aoc3RydWN0IGJpbyAqYmlvKQogICogYW5kIHRy
YW5zbXV0ZSAgaXQgdG8gdGhlIGJsb2NrIEFQSSB0byBoYW5kIGl0IG92ZXIg
dG8gdGhlIHByb3BlciBibG9jayBkaXNrLgogICovCiBzdGF0aWMgaW50Ci1f
X2RvX2Jsb2NrX2lvX29wKHN0cnVjdCB4ZW5fYmxraWZfcmluZyAqcmluZykK
K19fZG9fYmxvY2tfaW9fb3Aoc3RydWN0IHhlbl9ibGtpZl9yaW5nICpyaW5n
LCB1bnNpZ25lZCBpbnQgKmVvaV9mbGFncykKIHsKIAl1bmlvbiBibGtpZl9i
YWNrX3JpbmdzICpibGtfcmluZ3MgPSAmcmluZy0+YmxrX3JpbmdzOwogCXN0
cnVjdCBibGtpZl9yZXF1ZXN0IHJlcTsKQEAgLTExNDQsNiArMTE1Myw5IEBA
IF9fZG9fYmxvY2tfaW9fb3Aoc3RydWN0IHhlbl9ibGtpZl9yaW5nICpyaW5n
KQogCQlpZiAoUklOR19SRVFVRVNUX0NPTlNfT1ZFUkZMT1coJmJsa19yaW5n
cy0+Y29tbW9uLCByYykpCiAJCQlicmVhazsKIAorCQkvKiBXZSd2ZSBzZWVu
IGEgcmVxdWVzdCwgc28gY2xlYXIgc3B1cmlvdXMgZW9pIGZsYWcuICovCisJ
CSplb2lfZmxhZ3MgJj0gflhFTl9FT0lfRkxBR19TUFVSSU9VUzsKKwogCQlp
ZiAoa3RocmVhZF9zaG91bGRfc3RvcCgpKSB7CiAJCQltb3JlX3RvX2RvID0g
MTsKIAkJCWJyZWFrOwpAQCAtMTIwMiwxMyArMTIxNCwxMyBAQCBfX2RvX2Js
b2NrX2lvX29wKHN0cnVjdCB4ZW5fYmxraWZfcmluZyAqcmluZykKIH0KIAog
c3RhdGljIGludAotZG9fYmxvY2tfaW9fb3Aoc3RydWN0IHhlbl9ibGtpZl9y
aW5nICpyaW5nKQorZG9fYmxvY2tfaW9fb3Aoc3RydWN0IHhlbl9ibGtpZl9y
aW5nICpyaW5nLCB1bnNpZ25lZCBpbnQgKmVvaV9mbGFncykKIHsKIAl1bmlv
biBibGtpZl9iYWNrX3JpbmdzICpibGtfcmluZ3MgPSAmcmluZy0+YmxrX3Jp
bmdzOwogCWludCBtb3JlX3RvX2RvOwogCiAJZG8gewotCQltb3JlX3RvX2Rv
ID0gX19kb19ibG9ja19pb19vcChyaW5nKTsKKwkJbW9yZV90b19kbyA9IF9f
ZG9fYmxvY2tfaW9fb3AocmluZywgZW9pX2ZsYWdzKTsKIAkJaWYgKG1vcmVf
dG9fZG8pCiAJCQlicmVhazsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ibG9j
ay94ZW4tYmxrYmFjay94ZW5idXMuYyBiL2RyaXZlcnMvYmxvY2sveGVuLWJs
a2JhY2sveGVuYnVzLmMKaW5kZXggYjlhYTVkMWFjMTBiLi41ZTdjMzZkNzNk
YzYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvYmxvY2sveGVuLWJsa2JhY2sveGVu
YnVzLmMKKysrIGIvZHJpdmVycy9ibG9jay94ZW4tYmxrYmFjay94ZW5idXMu
YwpAQCAtMjQ2LDkgKzI0Niw4IEBAIHN0YXRpYyBpbnQgeGVuX2Jsa2lmX21h
cChzdHJ1Y3QgeGVuX2Jsa2lmX3JpbmcgKnJpbmcsIGdyYW50X3JlZl90ICpn
cmVmLAogCWlmIChyZXFfcHJvZCAtIHJzcF9wcm9kID4gc2l6ZSkKIAkJZ290
byBmYWlsOwogCi0JZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9f
aXJxaGFuZGxlcihibGtpZi0+ZG9taWQsIGV2dGNobiwKLQkJCQkJCSAgICB4
ZW5fYmxraWZfYmVfaW50LCAwLAotCQkJCQkJICAgICJibGtpZi1iYWNrZW5k
IiwgcmluZyk7CisJZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9f
aXJxaGFuZGxlcl9sYXRlZW9pKGJsa2lmLT5kb21pZCwKKwkJCWV2dGNobiwg
eGVuX2Jsa2lmX2JlX2ludCwgMCwgImJsa2lmLWJhY2tlbmQiLCByaW5nKTsK
IAlpZiAoZXJyIDwgMCkKIAkJZ290byBmYWlsOwogCXJpbmctPmlycSA9IGVy
cjsKLS0gCjIuMjYuMgoK

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-05.patch"
Content-Disposition: attachment; filename="xsa332-linux-05.patch"
Content-Transfer-Encoding: base64

RnJvbSAxODNhYTEzNjZlY2UxNjZlZDg0YzM3ZmVhYTBiNGY4NjIzMWQyYmJk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyOCArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDUvMTJdIHhlbi9uZXRiYWNr
OiB1c2UgbGF0ZWVvaSBpcnEgYmluZGluZwoKSW4gb3JkZXIgdG8gcmVkdWNl
IHRoZSBjaGFuY2UgZm9yIHRoZSBzeXN0ZW0gYmVjb21pbmcgdW5yZXNwb25z
aXZlIGR1ZQp0byBldmVudCBzdG9ybXMgdHJpZ2dlcmVkIGJ5IGEgbWlzYmVo
YXZpbmcgbmV0ZnJvbnQgdXNlIHRoZSBsYXRlZW9pCmlycSBiaW5kaW5nIGZv
ciBuZXRiYWNrIGFuZCB1bm1hc2sgdGhlIGV2ZW50IGNoYW5uZWwgb25seSBq
dXN0IGJlZm9yZQpnb2luZyB0byBzbGVlcCB3YWl0aW5nIGZvciBuZXcgZXZl
bnRzLgoKTWFrZSBzdXJlIG5vdCB0byBpc3N1ZSBhbiBFT0kgd2hlbiBub25l
IGlzIHBlbmRpbmcgYnkgaW50cm9kdWNpbmcgYW4KZW9pX3BlbmRpbmcgZWxl
bWVudCB0byBzdHJ1Y3QgeGVudmlmX3F1ZXVlLgoKV2hlbiBubyByZXF1ZXN0
IGhhcyBiZWVuIGNvbnN1bWVkIHNldCB0aGUgc3B1cmlvdXMgZmxhZyB3aGVu
IHNlbmRpbmcKdGhlIEVPSSBmb3IgYW4gaW50ZXJydXB0LgoKVGhpcyBpcyBw
YXJ0IG9mIFhTQS0zMzIuCgpDYzogc3RhYmxlQHZnZXIua2VybmVsLm9yZwpS
ZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW5AeGVuLm9yZz4KU2ln
bmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogV2VpIExpdSA8d2xAeGVuLm9yZz4KLS0tCiBkcml2ZXJz
L25ldC94ZW4tbmV0YmFjay9jb21tb24uaCAgICB8IDE1ICsrKysrKysKIGRy
aXZlcnMvbmV0L3hlbi1uZXRiYWNrL2ludGVyZmFjZS5jIHwgNjEgKysrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0KIGRyaXZlcnMvbmV0L3hlbi1uZXRi
YWNrL25ldGJhY2suYyAgIHwgMTEgKysrKystCiBkcml2ZXJzL25ldC94ZW4t
bmV0YmFjay9yeC5jICAgICAgICB8IDEzICsrKystLQogNCBmaWxlcyBjaGFu
Z2VkLCA4NiBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9kcml2ZXJzL25ldC94ZW4tbmV0YmFjay9jb21tb24uaCBiL2Ry
aXZlcnMvbmV0L3hlbi1uZXRiYWNrL2NvbW1vbi5oCmluZGV4IGFlNDc3Zjc3
NTZhZi4uOGVlMjRlMzUxYmRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC94
ZW4tbmV0YmFjay9jb21tb24uaAorKysgYi9kcml2ZXJzL25ldC94ZW4tbmV0
YmFjay9jb21tb24uaApAQCAtMTQwLDYgKzE0MCwyMCBAQCBzdHJ1Y3QgeGVu
dmlmX3F1ZXVlIHsgLyogUGVyLXF1ZXVlIGRhdGEgZm9yIHhlbnZpZiAqLwog
CWNoYXIgbmFtZVtRVUVVRV9OQU1FX1NJWkVdOyAvKiBERVZOQU1FLXFOICov
CiAJc3RydWN0IHhlbnZpZiAqdmlmOyAvKiBQYXJlbnQgVklGICovCiAKKwkv
KgorCSAqIFRYL1JYIGNvbW1vbiBFT0kgaGFuZGxpbmcuCisJICogV2hlbiBm
ZWF0dXJlLXNwbGl0LWV2ZW50LWNoYW5uZWxzID0gMCwgaW50ZXJydXB0IGhh
bmRsZXIgc2V0cworCSAqIE5FVEJLX0NPTU1PTl9FT0ksIG90aGVyd2lzZSBO
RVRCS19SWF9FT0kgYW5kIE5FVEJLX1RYX0VPSSBhcmUgc2V0CisJICogYnkg
dGhlIFJYIGFuZCBUWCBpbnRlcnJ1cHQgaGFuZGxlcnMuCisJICogUlggYW5k
IFRYIGhhbmRsZXIgdGhyZWFkcyB3aWxsIGlzc3VlIGFuIEVPSSB3aGVuIGVp
dGhlcgorCSAqIE5FVEJLX0NPTU1PTl9FT0kgb3IgdGhlaXIgc3BlY2lmaWMg
Yml0cyAoTkVUQktfUlhfRU9JIG9yCisJICogTkVUQktfVFhfRU9JKSBhcmUg
c2V0IGFuZCB0aGV5IHdpbGwgcmVzZXQgdGhvc2UgYml0cy4KKwkgKi8KKwlh
dG9taWNfdCBlb2lfcGVuZGluZzsKKyNkZWZpbmUgTkVUQktfUlhfRU9JCQkw
eDAxCisjZGVmaW5lIE5FVEJLX1RYX0VPSQkJMHgwMgorI2RlZmluZSBORVRC
S19DT01NT05fRU9JCTB4MDQKKwogCS8qIFVzZSBOQVBJIGZvciBndWVzdCBU
WCAqLwogCXN0cnVjdCBuYXBpX3N0cnVjdCBuYXBpOwogCS8qIFdoZW4gZmVh
dHVyZS1zcGxpdC1ldmVudC1jaGFubmVscyA9IDAsIHR4X2lycSA9IHJ4X2ly
cS4gKi8KQEAgLTM3OCw2ICszOTIsNyBAQCBpbnQgeGVudmlmX2RlYWxsb2Nf
a3RocmVhZCh2b2lkICpkYXRhKTsKIAogaXJxcmV0dXJuX3QgeGVudmlmX2N0
cmxfaXJxX2ZuKGludCBpcnEsIHZvaWQgKmRhdGEpOwogCitib29sIHhlbnZp
Zl9oYXZlX3J4X3dvcmsoc3RydWN0IHhlbnZpZl9xdWV1ZSAqcXVldWUsIGJv
b2wgdGVzdF9rdGhyZWFkKTsKIHZvaWQgeGVudmlmX3J4X2FjdGlvbihzdHJ1
Y3QgeGVudmlmX3F1ZXVlICpxdWV1ZSk7CiB2b2lkIHhlbnZpZl9yeF9xdWV1
ZV90YWlsKHN0cnVjdCB4ZW52aWZfcXVldWUgKnF1ZXVlLCBzdHJ1Y3Qgc2tf
YnVmZiAqc2tiKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQveGVuLW5l
dGJhY2svaW50ZXJmYWNlLmMgYi9kcml2ZXJzL25ldC94ZW4tbmV0YmFjay9p
bnRlcmZhY2UuYwppbmRleCA4YWY0OTcyODU2OTEuLmFjYjc4NmQ4YjFkOCAx
MDA2NDQKLS0tIGEvZHJpdmVycy9uZXQveGVuLW5ldGJhY2svaW50ZXJmYWNl
LmMKKysrIGIvZHJpdmVycy9uZXQveGVuLW5ldGJhY2svaW50ZXJmYWNlLmMK
QEAgLTc3LDEyICs3NywyOCBAQCBpbnQgeGVudmlmX3NjaGVkdWxhYmxlKHN0
cnVjdCB4ZW52aWYgKnZpZikKIAkJIXZpZi0+ZGlzYWJsZWQ7CiB9CiAKK3N0
YXRpYyBib29sIHhlbnZpZl9oYW5kbGVfdHhfaW50ZXJydXB0KHN0cnVjdCB4
ZW52aWZfcXVldWUgKnF1ZXVlKQoreworCWJvb2wgcmM7CisKKwlyYyA9IFJJ
TkdfSEFTX1VOQ09OU1VNRURfUkVRVUVTVFMoJnF1ZXVlLT50eCk7CisJaWYg
KHJjKQorCQluYXBpX3NjaGVkdWxlKCZxdWV1ZS0+bmFwaSk7CisJcmV0dXJu
IHJjOworfQorCiBzdGF0aWMgaXJxcmV0dXJuX3QgeGVudmlmX3R4X2ludGVy
cnVwdChpbnQgaXJxLCB2b2lkICpkZXZfaWQpCiB7CiAJc3RydWN0IHhlbnZp
Zl9xdWV1ZSAqcXVldWUgPSBkZXZfaWQ7CisJaW50IG9sZDsKIAotCWlmIChS
SU5HX0hBU19VTkNPTlNVTUVEX1JFUVVFU1RTKCZxdWV1ZS0+dHgpKQotCQlu
YXBpX3NjaGVkdWxlKCZxdWV1ZS0+bmFwaSk7CisJb2xkID0gYXRvbWljX2Zl
dGNoX29yKE5FVEJLX1RYX0VPSSwgJnF1ZXVlLT5lb2lfcGVuZGluZyk7CisJ
V0FSTihvbGQgJiBORVRCS19UWF9FT0ksICJJbnRlcnJ1cHQgd2hpbGUgRU9J
IHBlbmRpbmdcbiIpOworCisJaWYgKCF4ZW52aWZfaGFuZGxlX3R4X2ludGVy
cnVwdChxdWV1ZSkpIHsKKwkJYXRvbWljX2FuZG5vdChORVRCS19UWF9FT0ks
ICZxdWV1ZS0+ZW9pX3BlbmRpbmcpOworCQl4ZW5faXJxX2xhdGVlb2koaXJx
LCBYRU5fRU9JX0ZMQUdfU1BVUklPVVMpOworCX0KIAogCXJldHVybiBJUlFf
SEFORExFRDsKIH0KQEAgLTExNiwxOSArMTMyLDQ2IEBAIHN0YXRpYyBpbnQg
eGVudmlmX3BvbGwoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVk
Z2V0KQogCXJldHVybiB3b3JrX2RvbmU7CiB9CiAKK3N0YXRpYyBib29sIHhl
bnZpZl9oYW5kbGVfcnhfaW50ZXJydXB0KHN0cnVjdCB4ZW52aWZfcXVldWUg
KnF1ZXVlKQoreworCWJvb2wgcmM7CisKKwlyYyA9IHhlbnZpZl9oYXZlX3J4
X3dvcmsocXVldWUsIGZhbHNlKTsKKwlpZiAocmMpCisJCXhlbnZpZl9raWNr
X3RocmVhZChxdWV1ZSk7CisJcmV0dXJuIHJjOworfQorCiBzdGF0aWMgaXJx
cmV0dXJuX3QgeGVudmlmX3J4X2ludGVycnVwdChpbnQgaXJxLCB2b2lkICpk
ZXZfaWQpCiB7CiAJc3RydWN0IHhlbnZpZl9xdWV1ZSAqcXVldWUgPSBkZXZf
aWQ7CisJaW50IG9sZDsKIAotCXhlbnZpZl9raWNrX3RocmVhZChxdWV1ZSk7
CisJb2xkID0gYXRvbWljX2ZldGNoX29yKE5FVEJLX1JYX0VPSSwgJnF1ZXVl
LT5lb2lfcGVuZGluZyk7CisJV0FSTihvbGQgJiBORVRCS19SWF9FT0ksICJJ
bnRlcnJ1cHQgd2hpbGUgRU9JIHBlbmRpbmdcbiIpOworCisJaWYgKCF4ZW52
aWZfaGFuZGxlX3J4X2ludGVycnVwdChxdWV1ZSkpIHsKKwkJYXRvbWljX2Fu
ZG5vdChORVRCS19SWF9FT0ksICZxdWV1ZS0+ZW9pX3BlbmRpbmcpOworCQl4
ZW5faXJxX2xhdGVlb2koaXJxLCBYRU5fRU9JX0ZMQUdfU1BVUklPVVMpOwor
CX0KIAogCXJldHVybiBJUlFfSEFORExFRDsKIH0KIAogaXJxcmV0dXJuX3Qg
eGVudmlmX2ludGVycnVwdChpbnQgaXJxLCB2b2lkICpkZXZfaWQpCiB7Ci0J
eGVudmlmX3R4X2ludGVycnVwdChpcnEsIGRldl9pZCk7Ci0JeGVudmlmX3J4
X2ludGVycnVwdChpcnEsIGRldl9pZCk7CisJc3RydWN0IHhlbnZpZl9xdWV1
ZSAqcXVldWUgPSBkZXZfaWQ7CisJaW50IG9sZDsKKworCW9sZCA9IGF0b21p
Y19mZXRjaF9vcihORVRCS19DT01NT05fRU9JLCAmcXVldWUtPmVvaV9wZW5k
aW5nKTsKKwlXQVJOKG9sZCwgIkludGVycnVwdCB3aGlsZSBFT0kgcGVuZGlu
Z1xuIik7CisKKwkvKiBVc2UgYml0d2lzZSBvciBhcyB3ZSBuZWVkIHRvIGNh
bGwgYm90aCBmdW5jdGlvbnMuICovCisJaWYgKCgheGVudmlmX2hhbmRsZV90
eF9pbnRlcnJ1cHQocXVldWUpIHwKKwkgICAgICF4ZW52aWZfaGFuZGxlX3J4
X2ludGVycnVwdChxdWV1ZSkpKSB7CisJCWF0b21pY19hbmRub3QoTkVUQktf
Q09NTU9OX0VPSSwgJnF1ZXVlLT5lb2lfcGVuZGluZyk7CisJCXhlbl9pcnFf
bGF0ZWVvaShpcnEsIFhFTl9FT0lfRkxBR19TUFVSSU9VUyk7CisJfQogCiAJ
cmV0dXJuIElSUV9IQU5ETEVEOwogfQpAQCAtNjA1LDcgKzY0OCw3IEBAIGlu
dCB4ZW52aWZfY29ubmVjdF9jdHJsKHN0cnVjdCB4ZW52aWYgKnZpZiwgZ3Jh
bnRfcmVmX3QgcmluZ19yZWYsCiAJaWYgKHJlcV9wcm9kIC0gcnNwX3Byb2Qg
PiBSSU5HX1NJWkUoJnZpZi0+Y3RybCkpCiAJCWdvdG8gZXJyX3VubWFwOwog
Ci0JZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxKHZpZi0+
ZG9taWQsIGV2dGNobik7CisJZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRj
aG5fdG9faXJxX2xhdGVlb2kodmlmLT5kb21pZCwgZXZ0Y2huKTsKIAlpZiAo
ZXJyIDwgMCkKIAkJZ290byBlcnJfdW5tYXA7CiAKQEAgLTcwOSw3ICs3NTIs
NyBAQCBpbnQgeGVudmlmX2Nvbm5lY3RfZGF0YShzdHJ1Y3QgeGVudmlmX3F1
ZXVlICpxdWV1ZSwKIAogCWlmICh0eF9ldnRjaG4gPT0gcnhfZXZ0Y2huKSB7
CiAJCS8qIGZlYXR1cmUtc3BsaXQtZXZlbnQtY2hhbm5lbHMgPT0gMCAqLwot
CQllcnIgPSBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnFoYW5kbGVy
KAorCQllcnIgPSBiaW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnFoYW5k
bGVyX2xhdGVlb2koCiAJCQlxdWV1ZS0+dmlmLT5kb21pZCwgdHhfZXZ0Y2hu
LCB4ZW52aWZfaW50ZXJydXB0LCAwLAogCQkJcXVldWUtPm5hbWUsIHF1ZXVl
KTsKIAkJaWYgKGVyciA8IDApCkBAIC03MjAsNyArNzYzLDcgQEAgaW50IHhl
bnZpZl9jb25uZWN0X2RhdGEoc3RydWN0IHhlbnZpZl9xdWV1ZSAqcXVldWUs
CiAJCS8qIGZlYXR1cmUtc3BsaXQtZXZlbnQtY2hhbm5lbHMgPT0gMSAqLwog
CQlzbnByaW50ZihxdWV1ZS0+dHhfaXJxX25hbWUsIHNpemVvZihxdWV1ZS0+
dHhfaXJxX25hbWUpLAogCQkJICIlcy10eCIsIHF1ZXVlLT5uYW1lKTsKLQkJ
ZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxaGFuZGxlcigK
KwkJZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxaGFuZGxl
cl9sYXRlZW9pKAogCQkJcXVldWUtPnZpZi0+ZG9taWQsIHR4X2V2dGNobiwg
eGVudmlmX3R4X2ludGVycnVwdCwgMCwKIAkJCXF1ZXVlLT50eF9pcnFfbmFt
ZSwgcXVldWUpOwogCQlpZiAoZXJyIDwgMCkKQEAgLTczMCw3ICs3NzMsNyBA
QCBpbnQgeGVudmlmX2Nvbm5lY3RfZGF0YShzdHJ1Y3QgeGVudmlmX3F1ZXVl
ICpxdWV1ZSwKIAogCQlzbnByaW50ZihxdWV1ZS0+cnhfaXJxX25hbWUsIHNp
emVvZihxdWV1ZS0+cnhfaXJxX25hbWUpLAogCQkJICIlcy1yeCIsIHF1ZXVl
LT5uYW1lKTsKLQkJZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9f
aXJxaGFuZGxlcigKKwkJZXJyID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5f
dG9faXJxaGFuZGxlcl9sYXRlZW9pKAogCQkJcXVldWUtPnZpZi0+ZG9taWQs
IHJ4X2V2dGNobiwgeGVudmlmX3J4X2ludGVycnVwdCwgMCwKIAkJCXF1ZXVl
LT5yeF9pcnFfbmFtZSwgcXVldWUpOwogCQlpZiAoZXJyIDwgMCkKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbmV0L3hlbi1uZXRiYWNrL25ldGJhY2suYyBiL2Ry
aXZlcnMvbmV0L3hlbi1uZXRiYWNrL25ldGJhY2suYwppbmRleCA2ZGZjYTcy
NjU2NDQuLmJjMzQyMWQxNDU3NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQv
eGVuLW5ldGJhY2svbmV0YmFjay5jCisrKyBiL2RyaXZlcnMvbmV0L3hlbi1u
ZXRiYWNrL25ldGJhY2suYwpAQCAtMTY5LDYgKzE2OSwxMCBAQCB2b2lkIHhl
bnZpZl9uYXBpX3NjaGVkdWxlX29yX2VuYWJsZV9ldmVudHMoc3RydWN0IHhl
bnZpZl9xdWV1ZSAqcXVldWUpCiAKIAlpZiAobW9yZV90b19kbykKIAkJbmFw
aV9zY2hlZHVsZSgmcXVldWUtPm5hcGkpOworCWVsc2UgaWYgKGF0b21pY19m
ZXRjaF9hbmRub3QoTkVUQktfVFhfRU9JIHwgTkVUQktfQ09NTU9OX0VPSSwK
KwkJCQkgICAgICZxdWV1ZS0+ZW9pX3BlbmRpbmcpICYKKwkJIChORVRCS19U
WF9FT0kgfCBORVRCS19DT01NT05fRU9JKSkKKwkJeGVuX2lycV9sYXRlZW9p
KHF1ZXVlLT50eF9pcnEsIDApOwogfQogCiBzdGF0aWMgdm9pZCB0eF9hZGRf
Y3JlZGl0KHN0cnVjdCB4ZW52aWZfcXVldWUgKnF1ZXVlKQpAQCAtMTY0Myw5
ICsxNjQ3LDE0IEBAIHN0YXRpYyBib29sIHhlbnZpZl9jdHJsX3dvcmtfdG9k
byhzdHJ1Y3QgeGVudmlmICp2aWYpCiBpcnFyZXR1cm5fdCB4ZW52aWZfY3Ry
bF9pcnFfZm4oaW50IGlycSwgdm9pZCAqZGF0YSkKIHsKIAlzdHJ1Y3QgeGVu
dmlmICp2aWYgPSBkYXRhOworCXVuc2lnbmVkIGludCBlb2lfZmxhZyA9IFhF
Tl9FT0lfRkxBR19TUFVSSU9VUzsKIAotCXdoaWxlICh4ZW52aWZfY3RybF93
b3JrX3RvZG8odmlmKSkKKwl3aGlsZSAoeGVudmlmX2N0cmxfd29ya190b2Rv
KHZpZikpIHsKIAkJeGVudmlmX2N0cmxfYWN0aW9uKHZpZik7CisJCWVvaV9m
bGFnID0gMDsKKwl9CisKKwl4ZW5faXJxX2xhdGVlb2koaXJxLCBlb2lfZmxh
Zyk7CiAKIAlyZXR1cm4gSVJRX0hBTkRMRUQ7CiB9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL25ldC94ZW4tbmV0YmFjay9yeC5jIGIvZHJpdmVycy9uZXQveGVu
LW5ldGJhY2svcnguYwppbmRleCBhYzAzNGY2OWExNzAuLmI4ZmViZTFkMWJm
ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQveGVuLW5ldGJhY2svcnguYwor
KysgYi9kcml2ZXJzL25ldC94ZW4tbmV0YmFjay9yeC5jCkBAIC01MDMsMTMg
KzUwMywxMyBAQCBzdGF0aWMgYm9vbCB4ZW52aWZfcnhfcXVldWVfcmVhZHko
c3RydWN0IHhlbnZpZl9xdWV1ZSAqcXVldWUpCiAJcmV0dXJuIHF1ZXVlLT5z
dGFsbGVkICYmIHByb2QgLSBjb25zID49IDE7CiB9CiAKLXN0YXRpYyBib29s
IHhlbnZpZl9oYXZlX3J4X3dvcmsoc3RydWN0IHhlbnZpZl9xdWV1ZSAqcXVl
dWUpCitib29sIHhlbnZpZl9oYXZlX3J4X3dvcmsoc3RydWN0IHhlbnZpZl9x
dWV1ZSAqcXVldWUsIGJvb2wgdGVzdF9rdGhyZWFkKQogewogCXJldHVybiB4
ZW52aWZfcnhfcmluZ19zbG90c19hdmFpbGFibGUocXVldWUpIHx8CiAJCShx
dWV1ZS0+dmlmLT5zdGFsbF90aW1lb3V0ICYmCiAJCSAoeGVudmlmX3J4X3F1
ZXVlX3N0YWxsZWQocXVldWUpIHx8CiAJCSAgeGVudmlmX3J4X3F1ZXVlX3Jl
YWR5KHF1ZXVlKSkpIHx8Ci0JCWt0aHJlYWRfc2hvdWxkX3N0b3AoKSB8fAor
CQkodGVzdF9rdGhyZWFkICYmIGt0aHJlYWRfc2hvdWxkX3N0b3AoKSkgfHwK
IAkJcXVldWUtPnZpZi0+ZGlzYWJsZWQ7CiB9CiAKQEAgLTU0MCwxNSArNTQw
LDIwIEBAIHN0YXRpYyB2b2lkIHhlbnZpZl93YWl0X2Zvcl9yeF93b3JrKHN0
cnVjdCB4ZW52aWZfcXVldWUgKnF1ZXVlKQogewogCURFRklORV9XQUlUKHdh
aXQpOwogCi0JaWYgKHhlbnZpZl9oYXZlX3J4X3dvcmsocXVldWUpKQorCWlm
ICh4ZW52aWZfaGF2ZV9yeF93b3JrKHF1ZXVlLCB0cnVlKSkKIAkJcmV0dXJu
OwogCiAJZm9yICg7OykgewogCQlsb25nIHJldDsKIAogCQlwcmVwYXJlX3Rv
X3dhaXQoJnF1ZXVlLT53cSwgJndhaXQsIFRBU0tfSU5URVJSVVBUSUJMRSk7
Ci0JCWlmICh4ZW52aWZfaGF2ZV9yeF93b3JrKHF1ZXVlKSkKKwkJaWYgKHhl
bnZpZl9oYXZlX3J4X3dvcmsocXVldWUsIHRydWUpKQogCQkJYnJlYWs7CisJ
CWlmIChhdG9taWNfZmV0Y2hfYW5kbm90KE5FVEJLX1JYX0VPSSB8IE5FVEJL
X0NPTU1PTl9FT0ksCisJCQkJCSZxdWV1ZS0+ZW9pX3BlbmRpbmcpICYKKwkJ
ICAgIChORVRCS19SWF9FT0kgfCBORVRCS19DT01NT05fRU9JKSkKKwkJCXhl
bl9pcnFfbGF0ZWVvaShxdWV1ZS0+cnhfaXJxLCAwKTsKKwogCQlyZXQgPSBz
Y2hlZHVsZV90aW1lb3V0KHhlbnZpZl9yeF9xdWV1ZV90aW1lb3V0KHF1ZXVl
KSk7CiAJCWlmICghcmV0KQogCQkJYnJlYWs7Ci0tIAoyLjI2LjIKCg==

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-06.patch"
Content-Disposition: attachment; filename="xsa332-linux-06.patch"
Content-Transfer-Encoding: base64

RnJvbSBmNDQ1MDI2NjRiM2YzYjg4MjkzNzc3MmMzZmI3MTY5NzFkYWE0YTdk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyOCArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDYvMTJdIHhlbi9zY3NpYmFj
azogdXNlIGxhdGVlb2kgaXJxIGJpbmRpbmcKCkluIG9yZGVyIHRvIHJlZHVj
ZSB0aGUgY2hhbmNlIGZvciB0aGUgc3lzdGVtIGJlY29taW5nIHVucmVzcG9u
c2l2ZSBkdWUKdG8gZXZlbnQgc3Rvcm1zIHRyaWdnZXJlZCBieSBhIG1pc2Jl
aGF2aW5nIHNjc2lmcm9udCB1c2UgdGhlIGxhdGVlb2kKaXJxIGJpbmRpbmcg
Zm9yIHNjc2liYWNrIGFuZCB1bm1hc2sgdGhlIGV2ZW50IGNoYW5uZWwgb25s
eSBqdXN0IGJlZm9yZQpsZWF2aW5nIHRoZSBldmVudCBoYW5kbGluZyBmdW5j
dGlvbi4KCkluIGNhc2Ugb2YgYSByaW5nIHByb3RvY29sIGVycm9yIGRvbid0
IGlzc3VlIGFuIEVPSSBpbiBvcmRlciB0byBhdm9pZAp0aGUgcG9zc2liaWxp
dHkgdG8gdXNlIHRoYXQgZm9yIHByb2R1Y2luZyBhbiBldmVudCBzdG9ybS4g
VGhpcyBhdCBvbmNlCndpbGwgcmVzdWx0IGluIG5vIGZ1cnRoZXIgY2FsbCBv
ZiBzY3NpYmFja19pcnFfZm4oKSwgc28gdGhlIHJpbmdfZXJyb3IKc3RydWN0
IG1lbWJlciBjYW4gYmUgZHJvcHBlZCBhbmQgc2NzaWJhY2tfZG9fY21kX2Zu
KCkgY2FuIHNpZ25hbCB0aGUKcHJvdG9jb2wgZXJyb3IgdmlhIGEgbmVnYXRp
dmUgcmV0dXJuIHZhbHVlLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMzIuCgpD
Yzogc3RhYmxlQHZnZXIua2VybmVsLm9yZwpSZXBvcnRlZC1ieTogSnVsaWVu
IEdyYWxsIDxqdWxpZW5AeGVuLm9yZz4KU2lnbmVkLW9mZi1ieTogSnVlcmdl
biBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSmFuIEJl
dWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogV2VpIExp
dSA8d2xAeGVuLm9yZz4KLS0tCiBkcml2ZXJzL3hlbi94ZW4tc2NzaWJhY2su
YyB8IDIzICsrKysrKysrKysrKystLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdl
ZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTAgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy94ZW4veGVuLXNjc2liYWNrLmMgYi9kcml2ZXJzL3hl
bi94ZW4tc2NzaWJhY2suYwppbmRleCAxZThjZmQ4MGE0ZTYuLjRhY2M0ZTg5
OTYwMCAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4veGVuLXNjc2liYWNrLmMK
KysrIGIvZHJpdmVycy94ZW4veGVuLXNjc2liYWNrLmMKQEAgLTkxLDcgKzkx
LDYgQEAgc3RydWN0IHZzY3NpYmtfaW5mbyB7CiAJdW5zaWduZWQgaW50IGly
cTsKIAogCXN0cnVjdCB2c2NzaWlmX2JhY2tfcmluZyByaW5nOwotCWludCBy
aW5nX2Vycm9yOwogCiAJc3BpbmxvY2tfdCByaW5nX2xvY2s7CiAJYXRvbWlj
X3QgbnJfdW5yZXBsaWVkX3JlcXM7CkBAIC03MjIsNyArNzIxLDggQEAgc3Rh
dGljIHN0cnVjdCB2c2NzaWJrX3BlbmQgKnByZXBhcmVfcGVuZGluZ19yZXFz
KHN0cnVjdCB2c2NzaWJrX2luZm8gKmluZm8sCiAJcmV0dXJuIHBlbmRpbmdf
cmVxOwogfQogCi1zdGF0aWMgaW50IHNjc2liYWNrX2RvX2NtZF9mbihzdHJ1
Y3QgdnNjc2lia19pbmZvICppbmZvKQorc3RhdGljIGludCBzY3NpYmFja19k
b19jbWRfZm4oc3RydWN0IHZzY3NpYmtfaW5mbyAqaW5mbywKKwkJCSAgICAg
IHVuc2lnbmVkIGludCAqZW9pX2ZsYWdzKQogewogCXN0cnVjdCB2c2NzaWlm
X2JhY2tfcmluZyAqcmluZyA9ICZpbmZvLT5yaW5nOwogCXN0cnVjdCB2c2Nz
aWlmX3JlcXVlc3QgcmluZ19yZXE7CkBAIC03MzksMTEgKzczOSwxMiBAQCBz
dGF0aWMgaW50IHNjc2liYWNrX2RvX2NtZF9mbihzdHJ1Y3QgdnNjc2lia19p
bmZvICppbmZvKQogCQlyYyA9IHJpbmctPnJzcF9wcm9kX3B2dDsKIAkJcHJf
d2FybigiRG9tJWQgcHJvdmlkZWQgYm9ndXMgcmluZyByZXF1ZXN0cyAoJSN4
IC0gJSN4ID0gJXUpLiBIYWx0aW5nIHJpbmcgcHJvY2Vzc2luZ1xuIiwKIAkJ
CSAgIGluZm8tPmRvbWlkLCBycCwgcmMsIHJwIC0gcmMpOwotCQlpbmZvLT5y
aW5nX2Vycm9yID0gMTsKLQkJcmV0dXJuIDA7CisJCXJldHVybiAtRUlOVkFM
OwogCX0KIAogCXdoaWxlICgocmMgIT0gcnApKSB7CisJCSplb2lfZmxhZ3Mg
Jj0gflhFTl9FT0lfRkxBR19TUFVSSU9VUzsKKwogCQlpZiAoUklOR19SRVFV
RVNUX0NPTlNfT1ZFUkZMT1cocmluZywgcmMpKQogCQkJYnJlYWs7CiAKQEAg
LTgwMiwxMyArODAzLDE2IEBAIHN0YXRpYyBpbnQgc2NzaWJhY2tfZG9fY21k
X2ZuKHN0cnVjdCB2c2NzaWJrX2luZm8gKmluZm8pCiBzdGF0aWMgaXJxcmV0
dXJuX3Qgc2NzaWJhY2tfaXJxX2ZuKGludCBpcnEsIHZvaWQgKmRldl9pZCkK
IHsKIAlzdHJ1Y3QgdnNjc2lia19pbmZvICppbmZvID0gZGV2X2lkOworCWlu
dCByYzsKKwl1bnNpZ25lZCBpbnQgZW9pX2ZsYWdzID0gWEVOX0VPSV9GTEFH
X1NQVVJJT1VTOwogCi0JaWYgKGluZm8tPnJpbmdfZXJyb3IpCi0JCXJldHVy
biBJUlFfSEFORExFRDsKLQotCXdoaWxlIChzY3NpYmFja19kb19jbWRfZm4o
aW5mbykpCisJd2hpbGUgKChyYyA9IHNjc2liYWNrX2RvX2NtZF9mbihpbmZv
LCAmZW9pX2ZsYWdzKSkgPiAwKQogCQljb25kX3Jlc2NoZWQoKTsKIAorCS8q
IEluIGNhc2Ugb2YgYSByaW5nIGVycm9yIHdlIGtlZXAgdGhlIGV2ZW50IGNo
YW5uZWwgbWFza2VkLiAqLworCWlmICghcmMpCisJCXhlbl9pcnFfbGF0ZWVv
aShpcnEsIGVvaV9mbGFncyk7CisKIAlyZXR1cm4gSVJRX0hBTkRMRUQ7CiB9
CiAKQEAgLTgyOSw3ICs4MzMsNyBAQCBzdGF0aWMgaW50IHNjc2liYWNrX2lu
aXRfc3Jpbmcoc3RydWN0IHZzY3NpYmtfaW5mbyAqaW5mbywgZ3JhbnRfcmVm
X3QgcmluZ19yZWYsCiAJc3JpbmcgPSAoc3RydWN0IHZzY3NpaWZfc3Jpbmcg
KilhcmVhOwogCUJBQ0tfUklOR19JTklUKCZpbmZvLT5yaW5nLCBzcmluZywg
UEFHRV9TSVpFKTsKIAotCWVyciA9IGJpbmRfaW50ZXJkb21haW5fZXZ0Y2hu
X3RvX2lycShpbmZvLT5kb21pZCwgZXZ0Y2huKTsKKwllcnIgPSBiaW5kX2lu
dGVyZG9tYWluX2V2dGNobl90b19pcnFfbGF0ZWVvaShpbmZvLT5kb21pZCwg
ZXZ0Y2huKTsKIAlpZiAoZXJyIDwgMCkKIAkJZ290byB1bm1hcF9wYWdlOwog
CkBAIC0xMjUzLDcgKzEyNTcsNiBAQCBzdGF0aWMgaW50IHNjc2liYWNrX3By
b2JlKHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYsCiAKIAlpbmZvLT5kb21p
ZCA9IGRldi0+b3RoZXJlbmRfaWQ7CiAJc3Bpbl9sb2NrX2luaXQoJmluZm8t
PnJpbmdfbG9jayk7Ci0JaW5mby0+cmluZ19lcnJvciA9IDA7CiAJYXRvbWlj
X3NldCgmaW5mby0+bnJfdW5yZXBsaWVkX3JlcXMsIDApOwogCWluaXRfd2Fp
dHF1ZXVlX2hlYWQoJmluZm8tPndhaXRpbmdfdG9fZnJlZSk7CiAJaW5mby0+
ZGV2ID0gZGV2OwotLSAKMi4yNi4yCgo=

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-07.patch"
Content-Disposition: attachment; filename="xsa332-linux-07.patch"
Content-Transfer-Encoding: base64

RnJvbSAxNjUyOTQ3OTVmZGEzMWNmMjBhMjZjOGE3OWUxMjBkMzIwN2QxMzEx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyOCArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDcvMTJdIHhlbi9wdmNhbGxz
YmFjazogdXNlIGxhdGVlb2kgaXJxIGJpbmRpbmcKCkluIG9yZGVyIHRvIHJl
ZHVjZSB0aGUgY2hhbmNlIGZvciB0aGUgc3lzdGVtIGJlY29taW5nIHVucmVz
cG9uc2l2ZSBkdWUKdG8gZXZlbnQgc3Rvcm1zIHRyaWdnZXJlZCBieSBhIG1p
c2JlaGF2aW5nIHB2Y2FsbHNmcm9udCB1c2UgdGhlIGxhdGVlb2kKaXJxIGJp
bmRpbmcgZm9yIHB2Y2FsbHNiYWNrIGFuZCB1bm1hc2sgdGhlIGV2ZW50IGNo
YW5uZWwgb25seSBhZnRlcgpoYW5kbGluZyBhbGwgd3JpdGUgcmVxdWVzdHMs
IHdoaWNoIGFyZSB0aGUgb25lcyBjb21pbmcgaW4gdmlhIGFuIGlycS4KClRo
aXMgcmVxdWlyZXMgbW9kaWZ5aW5nIHRoZSBsb2dpYyBhIGxpdHRsZSBiaXQg
dG8gbm90IHJlcXVpcmUgYW4gZXZlbnQKZm9yIGVhY2ggd3JpdGUgcmVxdWVz
dCwgYnV0IHRvIGtlZXAgdGhlIGlvd29ya2VyIHJ1bm5pbmcgdW50aWwgbm8K
ZnVydGhlciBkYXRhIGlzIGZvdW5kIG9uIHRoZSByaW5nIHBhZ2UgdG8gYmUg
cHJvY2Vzc2VkLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0zMzIuCgpDYzogc3Rh
YmxlQHZnZXIua2VybmVsLm9yZwpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxs
IDxqdWxpZW5AeGVuLm9yZz4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9z
cyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogU3RlZmFubyBTdGFi
ZWxsaW5pIDxzc3RhYmVsbGluaUBrZXJuZWwub3JnPgpSZXZpZXdlZC1ieTog
V2VpIExpdSA8d2xAeGVuLm9yZz4KLS0tCiBkcml2ZXJzL3hlbi9wdmNhbGxz
LWJhY2suYyB8IDc2ICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0t
LS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgNDYgaW5zZXJ0aW9ucygrKSwgMzAg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vcHZjYWxs
cy1iYWNrLmMgYi9kcml2ZXJzL3hlbi9wdmNhbGxzLWJhY2suYwppbmRleCA5
ZWFlMWZjZWVjMWUuLmE3ZDI5M2ZhOGQxNCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy94ZW4vcHZjYWxscy1iYWNrLmMKKysrIGIvZHJpdmVycy94ZW4vcHZjYWxs
cy1iYWNrLmMKQEAgLTY2LDYgKzY2LDcgQEAgc3RydWN0IHNvY2tfbWFwcGlu
ZyB7CiAJYXRvbWljX3Qgd3JpdGU7CiAJYXRvbWljX3QgaW87CiAJYXRvbWlj
X3QgcmVsZWFzZTsKKwlhdG9taWNfdCBlb2k7CiAJdm9pZCAoKnNhdmVkX2Rh
dGFfcmVhZHkpKHN0cnVjdCBzb2NrICpzayk7CiAJc3RydWN0IHB2Y2FsbHNf
aW93b3JrZXIgaW93b3JrZXI7CiB9OwpAQCAtODcsNyArODgsNyBAQCBzdGF0
aWMgaW50IHB2Y2FsbHNfYmFja19yZWxlYXNlX2FjdGl2ZShzdHJ1Y3QgeGVu
YnVzX2RldmljZSAqZGV2LAogCQkJCSAgICAgICBzdHJ1Y3QgcHZjYWxsc19m
ZWRhdGEgKmZlZGF0YSwKIAkJCQkgICAgICAgc3RydWN0IHNvY2tfbWFwcGlu
ZyAqbWFwKTsKIAotc3RhdGljIHZvaWQgcHZjYWxsc19jb25uX2JhY2tfcmVh
ZCh2b2lkICpvcGFxdWUpCitzdGF0aWMgYm9vbCBwdmNhbGxzX2Nvbm5fYmFj
a19yZWFkKHZvaWQgKm9wYXF1ZSkKIHsKIAlzdHJ1Y3Qgc29ja19tYXBwaW5n
ICptYXAgPSAoc3RydWN0IHNvY2tfbWFwcGluZyAqKW9wYXF1ZTsKIAlzdHJ1
Y3QgbXNnaGRyIG1zZzsKQEAgLTEwNywxNyArMTA4LDE3IEBAIHN0YXRpYyB2
b2lkIHB2Y2FsbHNfY29ubl9iYWNrX3JlYWQodm9pZCAqb3BhcXVlKQogCXZp
cnRfbWIoKTsKIAogCWlmIChlcnJvcikKLQkJcmV0dXJuOworCQlyZXR1cm4g
ZmFsc2U7CiAKIAlzaXplID0gcHZjYWxsc19xdWV1ZWQocHJvZCwgY29ucywg
YXJyYXlfc2l6ZSk7CiAJaWYgKHNpemUgPj0gYXJyYXlfc2l6ZSkKLQkJcmV0
dXJuOworCQlyZXR1cm4gZmFsc2U7CiAJc3Bpbl9sb2NrX2lycXNhdmUoJm1h
cC0+c29jay0+c2stPnNrX3JlY2VpdmVfcXVldWUubG9jaywgZmxhZ3MpOwog
CWlmIChza2JfcXVldWVfZW1wdHkoJm1hcC0+c29jay0+c2stPnNrX3JlY2Vp
dmVfcXVldWUpKSB7CiAJCWF0b21pY19zZXQoJm1hcC0+cmVhZCwgMCk7CiAJ
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJm1hcC0+c29jay0+c2stPnNrX3Jl
Y2VpdmVfcXVldWUubG9jaywKIAkJCQlmbGFncyk7Ci0JCXJldHVybjsKKwkJ
cmV0dXJuIHRydWU7CiAJfQogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJm1h
cC0+c29jay0+c2stPnNrX3JlY2VpdmVfcXVldWUubG9jaywgZmxhZ3MpOwog
CXdhbnRlZCA9IGFycmF5X3NpemUgLSBzaXplOwpAQCAtMTQxLDcgKzE0Miw3
IEBAIHN0YXRpYyB2b2lkIHB2Y2FsbHNfY29ubl9iYWNrX3JlYWQodm9pZCAq
b3BhcXVlKQogCXJldCA9IGluZXRfcmVjdm1zZyhtYXAtPnNvY2ssICZtc2cs
IHdhbnRlZCwgTVNHX0RPTlRXQUlUKTsKIAlXQVJOX09OKHJldCA+IHdhbnRl
ZCk7CiAJaWYgKHJldCA9PSAtRUFHQUlOKSAvKiBzaG91bGRuJ3QgaGFwcGVu
ICovCi0JCXJldHVybjsKKwkJcmV0dXJuIHRydWU7CiAJaWYgKCFyZXQpCiAJ
CXJldCA9IC1FTk9UQ09OTjsKIAlzcGluX2xvY2tfaXJxc2F2ZSgmbWFwLT5z
b2NrLT5zay0+c2tfcmVjZWl2ZV9xdWV1ZS5sb2NrLCBmbGFncyk7CkBAIC0x
NjAsMTAgKzE2MSwxMCBAQCBzdGF0aWMgdm9pZCBwdmNhbGxzX2Nvbm5fYmFj
a19yZWFkKHZvaWQgKm9wYXF1ZSkKIAl2aXJ0X3dtYigpOwogCW5vdGlmeV9y
ZW1vdGVfdmlhX2lycShtYXAtPmlycSk7CiAKLQlyZXR1cm47CisJcmV0dXJu
IHRydWU7CiB9CiAKLXN0YXRpYyB2b2lkIHB2Y2FsbHNfY29ubl9iYWNrX3dy
aXRlKHN0cnVjdCBzb2NrX21hcHBpbmcgKm1hcCkKK3N0YXRpYyBib29sIHB2
Y2FsbHNfY29ubl9iYWNrX3dyaXRlKHN0cnVjdCBzb2NrX21hcHBpbmcgKm1h
cCkKIHsKIAlzdHJ1Y3QgcHZjYWxsc19kYXRhX2ludGYgKmludGYgPSBtYXAt
PnJpbmc7CiAJc3RydWN0IHB2Y2FsbHNfZGF0YSAqZGF0YSA9ICZtYXAtPmRh
dGE7CkBAIC0xODAsNyArMTgxLDcgQEAgc3RhdGljIHZvaWQgcHZjYWxsc19j
b25uX2JhY2tfd3JpdGUoc3RydWN0IHNvY2tfbWFwcGluZyAqbWFwKQogCWFy
cmF5X3NpemUgPSBYRU5fRkxFWF9SSU5HX1NJWkUobWFwLT5yaW5nX29yZGVy
KTsKIAlzaXplID0gcHZjYWxsc19xdWV1ZWQocHJvZCwgY29ucywgYXJyYXlf
c2l6ZSk7CiAJaWYgKHNpemUgPT0gMCkKLQkJcmV0dXJuOworCQlyZXR1cm4g
ZmFsc2U7CiAKIAltZW1zZXQoJm1zZywgMCwgc2l6ZW9mKG1zZykpOwogCW1z
Zy5tc2dfZmxhZ3MgfD0gTVNHX0RPTlRXQUlUOwpAQCAtMTk4LDEyICsxOTks
MTEgQEAgc3RhdGljIHZvaWQgcHZjYWxsc19jb25uX2JhY2tfd3JpdGUoc3Ry
dWN0IHNvY2tfbWFwcGluZyAqbWFwKQogCiAJYXRvbWljX3NldCgmbWFwLT53
cml0ZSwgMCk7CiAJcmV0ID0gaW5ldF9zZW5kbXNnKG1hcC0+c29jaywgJm1z
Zywgc2l6ZSk7Ci0JaWYgKHJldCA9PSAtRUFHQUlOIHx8IChyZXQgPj0gMCAm
JiByZXQgPCBzaXplKSkgeworCWlmIChyZXQgPT0gLUVBR0FJTikgewogCQlh
dG9taWNfaW5jKCZtYXAtPndyaXRlKTsKIAkJYXRvbWljX2luYygmbWFwLT5p
byk7CisJCXJldHVybiB0cnVlOwogCX0KLQlpZiAocmV0ID09IC1FQUdBSU4p
Ci0JCXJldHVybjsKIAogCS8qIHdyaXRlIHRoZSBkYXRhLCB0aGVuIHVwZGF0
ZSB0aGUgaW5kZXhlcyAqLwogCXZpcnRfd21iKCk7CkBAIC0yMTYsOSArMjE2
LDEzIEBAIHN0YXRpYyB2b2lkIHB2Y2FsbHNfY29ubl9iYWNrX3dyaXRlKHN0
cnVjdCBzb2NrX21hcHBpbmcgKm1hcCkKIAl9CiAJLyogdXBkYXRlIHRoZSBp
bmRleGVzLCB0aGVuIG5vdGlmeSB0aGUgb3RoZXIgZW5kICovCiAJdmlydF93
bWIoKTsKLQlpZiAocHJvZCAhPSBjb25zICsgcmV0KQorCWlmIChwcm9kICE9
IGNvbnMgKyByZXQpIHsKIAkJYXRvbWljX2luYygmbWFwLT53cml0ZSk7CisJ
CWF0b21pY19pbmMoJm1hcC0+aW8pOworCX0KIAlub3RpZnlfcmVtb3RlX3Zp
YV9pcnEobWFwLT5pcnEpOworCisJcmV0dXJuIHRydWU7CiB9CiAKIHN0YXRp
YyB2b2lkIHB2Y2FsbHNfYmFja19pb3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspCkBAIC0yMjcsNiArMjMxLDcgQEAgc3RhdGljIHZvaWQgcHZj
YWxsc19iYWNrX2lvd29ya2VyKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykK
IAkJc3RydWN0IHB2Y2FsbHNfaW93b3JrZXIsIHJlZ2lzdGVyX3dvcmspOwog
CXN0cnVjdCBzb2NrX21hcHBpbmcgKm1hcCA9IGNvbnRhaW5lcl9vZihpb3dv
cmtlciwgc3RydWN0IHNvY2tfbWFwcGluZywKIAkJaW93b3JrZXIpOworCXVu
c2lnbmVkIGludCBlb2lfZmxhZ3MgPSBYRU5fRU9JX0ZMQUdfU1BVUklPVVM7
CiAKIAl3aGlsZSAoYXRvbWljX3JlYWQoJm1hcC0+aW8pID4gMCkgewogCQlp
ZiAoYXRvbWljX3JlYWQoJm1hcC0+cmVsZWFzZSkgPiAwKSB7CkBAIC0yMzQs
MTAgKzIzOSwxOCBAQCBzdGF0aWMgdm9pZCBwdmNhbGxzX2JhY2tfaW93b3Jr
ZXIoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogCQkJcmV0dXJuOwogCQl9
CiAKLQkJaWYgKGF0b21pY19yZWFkKCZtYXAtPnJlYWQpID4gMCkKLQkJCXB2
Y2FsbHNfY29ubl9iYWNrX3JlYWQobWFwKTsKLQkJaWYgKGF0b21pY19yZWFk
KCZtYXAtPndyaXRlKSA+IDApCi0JCQlwdmNhbGxzX2Nvbm5fYmFja193cml0
ZShtYXApOworCQlpZiAoYXRvbWljX3JlYWQoJm1hcC0+cmVhZCkgPiAwICYm
CisJCSAgICBwdmNhbGxzX2Nvbm5fYmFja19yZWFkKG1hcCkpCisJCQllb2lf
ZmxhZ3MgPSAwOworCQlpZiAoYXRvbWljX3JlYWQoJm1hcC0+d3JpdGUpID4g
MCAmJgorCQkgICAgcHZjYWxsc19jb25uX2JhY2tfd3JpdGUobWFwKSkKKwkJ
CWVvaV9mbGFncyA9IDA7CisKKwkJaWYgKGF0b21pY19yZWFkKCZtYXAtPmVv
aSkgPiAwICYmICFhdG9taWNfcmVhZCgmbWFwLT53cml0ZSkpIHsKKwkJCWF0
b21pY19zZXQoJm1hcC0+ZW9pLCAwKTsKKwkJCXhlbl9pcnFfbGF0ZWVvaSht
YXAtPmlycSwgZW9pX2ZsYWdzKTsKKwkJCWVvaV9mbGFncyA9IFhFTl9FT0lf
RkxBR19TUFVSSU9VUzsKKwkJfQogCiAJCWF0b21pY19kZWMoJm1hcC0+aW8p
OwogCX0KQEAgLTMzNCwxMiArMzQ3LDkgQEAgc3RhdGljIHN0cnVjdCBzb2Nr
X21hcHBpbmcgKnB2Y2FsbHNfbmV3X2FjdGl2ZV9zb2NrZXQoCiAJCWdvdG8g
b3V0OwogCW1hcC0+Ynl0ZXMgPSBwYWdlOwogCi0JcmV0ID0gYmluZF9pbnRl
cmRvbWFpbl9ldnRjaG5fdG9faXJxaGFuZGxlcihmZWRhdGEtPmRldi0+b3Ro
ZXJlbmRfaWQsCi0JCQkJCQkgICAgZXZ0Y2huLAotCQkJCQkJICAgIHB2Y2Fs
bHNfYmFja19jb25uX2V2ZW50LAotCQkJCQkJICAgIDAsCi0JCQkJCQkgICAg
InB2Y2FsbHMtYmFja2VuZCIsCi0JCQkJCQkgICAgbWFwKTsKKwlyZXQgPSBi
aW5kX2ludGVyZG9tYWluX2V2dGNobl90b19pcnFoYW5kbGVyX2xhdGVlb2ko
CisJCQlmZWRhdGEtPmRldi0+b3RoZXJlbmRfaWQsIGV2dGNobiwKKwkJCXB2
Y2FsbHNfYmFja19jb25uX2V2ZW50LCAwLCAicHZjYWxscy1iYWNrZW5kIiwg
bWFwKTsKIAlpZiAocmV0IDwgMCkKIAkJZ290byBvdXQ7CiAJbWFwLT5pcnEg
PSByZXQ7CkBAIC04NzMsMTUgKzg4MywxOCBAQCBzdGF0aWMgaXJxcmV0dXJu
X3QgcHZjYWxsc19iYWNrX2V2ZW50KGludCBpcnEsIHZvaWQgKmRldl9pZCkK
IHsKIAlzdHJ1Y3QgeGVuYnVzX2RldmljZSAqZGV2ID0gZGV2X2lkOwogCXN0
cnVjdCBwdmNhbGxzX2ZlZGF0YSAqZmVkYXRhID0gTlVMTDsKKwl1bnNpZ25l
ZCBpbnQgZW9pX2ZsYWdzID0gWEVOX0VPSV9GTEFHX1NQVVJJT1VTOwogCi0J
aWYgKGRldiA9PSBOVUxMKQotCQlyZXR1cm4gSVJRX0hBTkRMRUQ7CisJaWYg
KGRldikgeworCQlmZWRhdGEgPSBkZXZfZ2V0X2RydmRhdGEoJmRldi0+ZGV2
KTsKKwkJaWYgKGZlZGF0YSkgeworCQkJcHZjYWxsc19iYWNrX3dvcmsoZmVk
YXRhKTsKKwkJCWVvaV9mbGFncyA9IDA7CisJCX0KKwl9CiAKLQlmZWRhdGEg
PSBkZXZfZ2V0X2RydmRhdGEoJmRldi0+ZGV2KTsKLQlpZiAoZmVkYXRhID09
IE5VTEwpCi0JCXJldHVybiBJUlFfSEFORExFRDsKKwl4ZW5faXJxX2xhdGVl
b2koaXJxLCBlb2lfZmxhZ3MpOwogCi0JcHZjYWxsc19iYWNrX3dvcmsoZmVk
YXRhKTsKIAlyZXR1cm4gSVJRX0hBTkRMRUQ7CiB9CiAKQEAgLTg5MSwxMiAr
OTA0LDE1IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBwdmNhbGxzX2JhY2tfY29u
bl9ldmVudChpbnQgaXJxLCB2b2lkICpzb2NrX21hcCkKIAlzdHJ1Y3QgcHZj
YWxsc19pb3dvcmtlciAqaW93OwogCiAJaWYgKG1hcCA9PSBOVUxMIHx8IG1h
cC0+c29jayA9PSBOVUxMIHx8IG1hcC0+c29jay0+c2sgPT0gTlVMTCB8fAot
CQltYXAtPnNvY2stPnNrLT5za191c2VyX2RhdGEgIT0gbWFwKQorCQltYXAt
PnNvY2stPnNrLT5za191c2VyX2RhdGEgIT0gbWFwKSB7CisJCXhlbl9pcnFf
bGF0ZWVvaShpcnEsIDApOwogCQlyZXR1cm4gSVJRX0hBTkRMRUQ7CisJfQog
CiAJaW93ID0gJm1hcC0+aW93b3JrZXI7CiAKIAlhdG9taWNfaW5jKCZtYXAt
PndyaXRlKTsKKwlhdG9taWNfaW5jKCZtYXAtPmVvaSk7CiAJYXRvbWljX2lu
YygmbWFwLT5pbyk7CiAJcXVldWVfd29yayhpb3ctPndxLCAmaW93LT5yZWdp
c3Rlcl93b3JrKTsKIApAQCAtOTMyLDcgKzk0OCw3IEBAIHN0YXRpYyBpbnQg
YmFja2VuZF9jb25uZWN0KHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYpCiAJ
CWdvdG8gZXJyb3I7CiAJfQogCi0JZXJyID0gYmluZF9pbnRlcmRvbWFpbl9l
dnRjaG5fdG9faXJxKGRldi0+b3RoZXJlbmRfaWQsIGV2dGNobik7CisJZXJy
ID0gYmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxX2xhdGVlb2koZGV2
LT5vdGhlcmVuZF9pZCwgZXZ0Y2huKTsKIAlpZiAoZXJyIDwgMCkKIAkJZ290
byBlcnJvcjsKIAlmZWRhdGEtPmlycSA9IGVycjsKLS0gCjIuMjYuMgoK

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-08.patch"
Content-Disposition: attachment; filename="xsa332-linux-08.patch"
Content-Transfer-Encoding: base64

RnJvbSAyNzFlNjZiYTRkYjFiNTZlYzM4NmNjNjNhOGNjMjk1N2JmMWJhOGE4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyOSArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDgvMTJdIHhlbi9wY2liYWNr
OiB1c2UgbGF0ZWVvaSBpcnEgYmluZGluZwoKSW4gb3JkZXIgdG8gcmVkdWNl
IHRoZSBjaGFuY2UgZm9yIHRoZSBzeXN0ZW0gYmVjb21pbmcgdW5yZXNwb25z
aXZlIGR1ZQp0byBldmVudCBzdG9ybXMgdHJpZ2dlcmVkIGJ5IGEgbWlzYmVo
YXZpbmcgcGNpZnJvbnQgdXNlIHRoZSBsYXRlZW9pIGlycQpiaW5kaW5nIGZv
ciBwY2liYWNrIGFuZCB1bm1hc2sgdGhlIGV2ZW50IGNoYW5uZWwgb25seSBq
dXN0IGJlZm9yZQpsZWF2aW5nIHRoZSBldmVudCBoYW5kbGluZyBmdW5jdGlv
bi4KClJlc3RydWN0dXJlIHRoZSBoYW5kbGluZyB0byBzdXBwb3J0IHRoYXQg
c2NoZW1lLiBCYXNpY2FsbHkgYW4gZXZlbnQgY2FuCmNvbWUgaW4gZm9yIHR3
byByZWFzb25zOiBlaXRoZXIgYSBub3JtYWwgcmVxdWVzdCBmb3IgYSBwY2li
YWNrIGFjdGlvbiwKd2hpY2ggaXMgaGFuZGxlZCBpbiBhIHdvcmtlciwgb3Ig
aW4gY2FzZSB0aGUgZ3Vlc3QgaGFzIGZpbmlzaGVkIGFuIEFFUgpyZXF1ZXN0
IHdoaWNoIHdhcyByZXF1ZXN0ZWQgYnkgcGNpYmFjay4KCldoZW4gYW4gQUVS
IHJlcXVlc3QgaXMgaXNzdWVkIHRvIHRoZSBndWVzdCBhbmQgYSBub3JtYWwg
cGNpYmFjayBhY3Rpb24KaXMgY3VycmVudGx5IGFjdGl2ZSBpc3N1ZSBhbiBF
T0kgZWFybHkgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byByZWNlaXZlCmFub3Ro
ZXIgZXZlbnQgd2hlbiB0aGUgQUVSIHJlcXVlc3QgaGFzIGJlZW4gZmluaXNo
ZWQgYnkgdGhlIGd1ZXN0LgoKTGV0IHRoZSB3b3JrZXIgcHJvY2Vzc2luZyB0
aGUgbm9ybWFsIHJlcXVlc3RzIHJ1biB1bnRpbCBubyBmdXJ0aGVyCnJlcXVl
c3QgaXMgcGVuZGluZywgaW5zdGVhZCBvZiBzdGFydGluZyBhIG5ldyB3b3Jr
ZXIgaW9uIHRoYXQgY2FzZS4KSXNzdWUgdGhlIEVPSSBvbmx5IGp1c3QgYmVm
b3JlIGxlYXZpbmcgdGhlIHdvcmtlci4KClRoaXMgc2NoZW1lIGFsbG93cyB0
byBkcm9wIGNhbGxpbmcgdGhlIGdlbmVyaWMgZnVuY3Rpb24KeGVuX3BjaWJr
X3Rlc3RfYW5kX3NjaGVkdWxlX29wKCkgYWZ0ZXIgcHJvY2Vzc2luZyBvZiBh
bnkgcmVxdWVzdCBhcwp0aGUgaGFuZGxpbmcgb2YgYm90aCByZXF1ZXN0IHR5
cGVzIGlzIG5vdyBzZXBhcmF0ZWQgbW9yZSBjbGVhbmx5LgoKVGhpcyBpcyBw
YXJ0IG9mIFhTQS0zMzIuCgpDYzogc3RhYmxlQHZnZXIua2VybmVsLm9yZwpS
ZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW5AeGVuLm9yZz4KU2ln
bmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpS
ZXZpZXdlZC1ieTogV2VpIExpdSA8d2xAeGVuLm9yZz4KLS0tCiBkcml2ZXJz
L3hlbi94ZW4tcGNpYmFjay9wY2lfc3R1Yi5jICAgIHwgMTMgKysrKy0tLS0K
IGRyaXZlcnMveGVuL3hlbi1wY2liYWNrL3BjaWJhY2suaCAgICAgfCAxMiAr
KysrKy0tCiBkcml2ZXJzL3hlbi94ZW4tcGNpYmFjay9wY2liYWNrX29wcy5j
IHwgNDggKysrKysrKysrKysrKysrKysrKysrLS0tLS0tCiBkcml2ZXJzL3hl
bi94ZW4tcGNpYmFjay94ZW5idXMuYyAgICAgIHwgIDIgKy0KIDQgZmlsZXMg
Y2hhbmdlZCwgNTYgaW5zZXJ0aW9ucygrKSwgMTkgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4veGVuLXBjaWJhY2svcGNpX3N0dWIu
YyBiL2RyaXZlcnMveGVuL3hlbi1wY2liYWNrL3BjaV9zdHViLmMKaW5kZXgg
ZTg3NmMzZDZkYWQxLi5jYjkwNGFjODMwMDYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMveGVuL3hlbi1wY2liYWNrL3BjaV9zdHViLmMKKysrIGIvZHJpdmVycy94
ZW4veGVuLXBjaWJhY2svcGNpX3N0dWIuYwpAQCAtNzM0LDEwICs3MzQsMTcg
QEAgc3RhdGljIHBjaV9lcnNfcmVzdWx0X3QgY29tbW9uX3Byb2Nlc3Moc3Ry
dWN0IHBjaXN0dWJfZGV2aWNlICpwc2RldiwKIAl3bWIoKTsKIAlub3RpZnlf
cmVtb3RlX3ZpYV9pcnEocGRldi0+ZXZ0Y2huX2lycSk7CiAKKwkvKiBFbmFi
bGUgSVJRIHRvIHNpZ25hbCAicmVxdWVzdCBkb25lIi4gKi8KKwl4ZW5fcGNp
YmtfbGF0ZWVvaShwZGV2LCAwKTsKKwogCXJldCA9IHdhaXRfZXZlbnRfdGlt
ZW91dCh4ZW5fcGNpYmtfYWVyX3dhaXRfcXVldWUsCiAJCQkJICEodGVzdF9i
aXQoX1hFTl9QQ0lCX2FjdGl2ZSwgKHVuc2lnbmVkIGxvbmcgKikKIAkJCQkg
JnNoX2luZm8tPmZsYWdzKSksIDMwMCpIWik7CiAKKwkvKiBFbmFibGUgSVJR
IGZvciBwY2lmcm9udCByZXF1ZXN0IGlmIG5vdCBhbHJlYWR5IGFjdGl2ZS4g
Ki8KKwlpZiAoIXRlc3RfYml0KF9QREVWRl9vcF9hY3RpdmUsICZwZGV2LT5m
bGFncykpCisJCXhlbl9wY2lia19sYXRlZW9pKHBkZXYsIDApOworCiAJaWYg
KCFyZXQpIHsKIAkJaWYgKHRlc3RfYml0KF9YRU5fUENJQl9hY3RpdmUsCiAJ
CQkodW5zaWduZWQgbG9uZyAqKSZzaF9pbmZvLT5mbGFncykpIHsKQEAgLTc1
MSwxMiArNzU4LDYgQEAgc3RhdGljIHBjaV9lcnNfcmVzdWx0X3QgY29tbW9u
X3Byb2Nlc3Moc3RydWN0IHBjaXN0dWJfZGV2aWNlICpwc2RldiwKIAl9CiAJ
Y2xlYXJfYml0KF9QQ0lCX29wX3BlbmRpbmcsICh1bnNpZ25lZCBsb25nICop
JnBkZXYtPmZsYWdzKTsKIAotCWlmICh0ZXN0X2JpdChfWEVOX1BDSUZfYWN0
aXZlLAotCQkodW5zaWduZWQgbG9uZyAqKSZzaF9pbmZvLT5mbGFncykpIHsK
LQkJZGV2X2RiZygmcHNkZXYtPmRldi0+ZGV2LCAic2NoZWR1bGUgcGNpX2Nv
bmYgc2VydmljZVxuIik7Ci0JCXhlbl9wY2lia190ZXN0X2FuZF9zY2hlZHVs
ZV9vcChwc2Rldi0+cGRldik7Ci0JfQotCiAJcmVzID0gKHBjaV9lcnNfcmVz
dWx0X3QpYWVyX29wLT5lcnI7CiAJcmV0dXJuIHJlczsKIH0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMveGVuL3hlbi1wY2liYWNrL3BjaWJhY2suaCBiL2RyaXZl
cnMveGVuL3hlbi1wY2liYWNrL3BjaWJhY2suaAppbmRleCBmMWVkMmRiZjY4
NWMuLjk1ZTI4ZWU0OGQ1MiAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4veGVu
LXBjaWJhY2svcGNpYmFjay5oCisrKyBiL2RyaXZlcnMveGVuL3hlbi1wY2li
YWNrL3BjaWJhY2suaApAQCAtMTQsNiArMTQsNyBAQAogI2luY2x1ZGUgPGxp
bnV4L3NwaW5sb2NrLmg+CiAjaW5jbHVkZSA8bGludXgvd29ya3F1ZXVlLmg+
CiAjaW5jbHVkZSA8bGludXgvYXRvbWljLmg+CisjaW5jbHVkZSA8eGVuL2V2
ZW50cy5oPgogI2luY2x1ZGUgPHhlbi9pbnRlcmZhY2UvaW8vcGNpaWYuaD4K
IAogI2RlZmluZSBEUlZfTkFNRQkieGVuLXBjaWJhY2siCkBAIC0yNyw2ICsy
OCw4IEBAIHN0cnVjdCBwY2lfZGV2X2VudHJ5IHsKICNkZWZpbmUgUERFVkZf
b3BfYWN0aXZlCQkoMTw8KF9QREVWRl9vcF9hY3RpdmUpKQogI2RlZmluZSBf
UENJQl9vcF9wZW5kaW5nCSgxKQogI2RlZmluZSBQQ0lCX29wX3BlbmRpbmcJ
CSgxPDwoX1BDSUJfb3BfcGVuZGluZykpCisjZGVmaW5lIF9FT0lfcGVuZGlu
ZwkJKDIpCisjZGVmaW5lIEVPSV9wZW5kaW5nCQkoMTw8KF9FT0lfcGVuZGlu
ZykpCiAKIHN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNlIHsKIAl2b2lkICpwY2lf
ZGV2X2RhdGE7CkBAIC0xODMsMTAgKzE4NiwxNSBAQCBzdGF0aWMgaW5saW5l
IHZvaWQgeGVuX3BjaWJrX3JlbGVhc2VfZGV2aWNlcyhzdHJ1Y3QgeGVuX3Bj
aWJrX2RldmljZSAqcGRldikKIGlycXJldHVybl90IHhlbl9wY2lia19oYW5k
bGVfZXZlbnQoaW50IGlycSwgdm9pZCAqZGV2X2lkKTsKIHZvaWQgeGVuX3Bj
aWJrX2RvX29wKHN0cnVjdCB3b3JrX3N0cnVjdCAqZGF0YSk7CiAKK3N0YXRp
YyBpbmxpbmUgdm9pZCB4ZW5fcGNpYmtfbGF0ZWVvaShzdHJ1Y3QgeGVuX3Bj
aWJrX2RldmljZSAqcGRldiwKKwkJCQkgICAgIHVuc2lnbmVkIGludCBlb2lf
ZmxhZykKK3sKKwlpZiAodGVzdF9hbmRfY2xlYXJfYml0KF9FT0lfcGVuZGlu
ZywgJnBkZXYtPmZsYWdzKSkKKwkJeGVuX2lycV9sYXRlZW9pKHBkZXYtPmV2
dGNobl9pcnEsIGVvaV9mbGFnKTsKK30KKwogaW50IHhlbl9wY2lia194ZW5i
dXNfcmVnaXN0ZXIodm9pZCk7CiB2b2lkIHhlbl9wY2lia194ZW5idXNfdW5y
ZWdpc3Rlcih2b2lkKTsKLQotdm9pZCB4ZW5fcGNpYmtfdGVzdF9hbmRfc2No
ZWR1bGVfb3Aoc3RydWN0IHhlbl9wY2lia19kZXZpY2UgKnBkZXYpOwogI2Vu
ZGlmCiAKIC8qIEhhbmRsZXMgc2hhcmVkIElSUXMgdGhhdCBjYW4gdG8gZGV2
aWNlIGRvbWFpbiBhbmQgY29udHJvbCBkb21haW4uICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL3hlbi94ZW4tcGNpYmFjay9wY2liYWNrX29wcy5jIGIvZHJp
dmVycy94ZW4veGVuLXBjaWJhY2svcGNpYmFja19vcHMuYwppbmRleCBlMTFh
NzQzOGUxYTIuLjNmYmMyMTQ2NmE5MyAxMDA2NDQKLS0tIGEvZHJpdmVycy94
ZW4veGVuLXBjaWJhY2svcGNpYmFja19vcHMuYworKysgYi9kcml2ZXJzL3hl
bi94ZW4tcGNpYmFjay9wY2liYWNrX29wcy5jCkBAIC0yNzYsMjYgKzI3Niw0
MSBAQCBpbnQgeGVuX3BjaWJrX2Rpc2FibGVfbXNpeChzdHJ1Y3QgeGVuX3Bj
aWJrX2RldmljZSAqcGRldiwKIAlyZXR1cm4gMDsKIH0KICNlbmRpZgorCitz
dGF0aWMgaW5saW5lIGJvb2wgeGVuX3BjaWJrX3Rlc3Rfb3BfcGVuZGluZyhz
dHJ1Y3QgeGVuX3BjaWJrX2RldmljZSAqcGRldikKK3sKKwlyZXR1cm4gdGVz
dF9iaXQoX1hFTl9QQ0lGX2FjdGl2ZSwKKwkJCSh1bnNpZ25lZCBsb25nICop
JnBkZXYtPnNoX2luZm8tPmZsYWdzKSAmJgorCSAgICAgICAhdGVzdF9hbmRf
c2V0X2JpdChfUERFVkZfb3BfYWN0aXZlLCAmcGRldi0+ZmxhZ3MpOworfQor
CiAvKgogKiBOb3cgdGhlIHNhbWUgZXZ0Y2huIGlzIHVzZWQgZm9yIGJvdGgg
cGNpZnJvbnQgY29uZl9yZWFkX3dyaXRlIHJlcXVlc3QKICogYXMgd2VsbCBh
cyBwY2llIGFlciBmcm9udCBlbmQgYWNrLiBXZSB1c2UgYSBuZXcgd29ya19x
dWV1ZSB0byBzY2hlZHVsZQogKiB4ZW5fcGNpYmsgY29uZl9yZWFkX3dyaXRl
IHNlcnZpY2UgZm9yIGF2b2lkaW5nIGNvbmZpY3Qgd2l0aCBhZXJfY29yZQog
KiBkb19yZWNvdmVyeSBqb2Igd2hpY2ggYWxzbyB1c2UgdGhlIHN5c3RlbSBk
ZWZhdWx0IHdvcmtfcXVldWUKICovCi12b2lkIHhlbl9wY2lia190ZXN0X2Fu
ZF9zY2hlZHVsZV9vcChzdHJ1Y3QgeGVuX3BjaWJrX2RldmljZSAqcGRldikK
K3N0YXRpYyB2b2lkIHhlbl9wY2lia190ZXN0X2FuZF9zY2hlZHVsZV9vcChz
dHJ1Y3QgeGVuX3BjaWJrX2RldmljZSAqcGRldikKIHsKKwlib29sIGVvaSA9
IHRydWU7CisKIAkvKiBDaGVjayB0aGF0IGZyb250ZW5kIGlzIHJlcXVlc3Rp
bmcgYW4gb3BlcmF0aW9uIGFuZCB0aGF0IHdlIGFyZSBub3QKIAkgKiBhbHJl
YWR5IHByb2Nlc3NpbmcgYSByZXF1ZXN0ICovCi0JaWYgKHRlc3RfYml0KF9Y
RU5fUENJRl9hY3RpdmUsICh1bnNpZ25lZCBsb25nICopJnBkZXYtPnNoX2lu
Zm8tPmZsYWdzKQotCSAgICAmJiAhdGVzdF9hbmRfc2V0X2JpdChfUERFVkZf
b3BfYWN0aXZlLCAmcGRldi0+ZmxhZ3MpKSB7CisJaWYgKHhlbl9wY2lia190
ZXN0X29wX3BlbmRpbmcocGRldikpIHsKIAkJc2NoZWR1bGVfd29yaygmcGRl
di0+b3Bfd29yayk7CisJCWVvaSA9IGZhbHNlOwogCX0KIAkvKl9YRU5fUENJ
Ql9hY3RpdmUgc2hvdWxkIGhhdmUgYmVlbiBjbGVhcmVkIGJ5IHBjaWZyb250
LiBBbmQgYWxzbyBtYWtlCiAJc3VyZSB4ZW5fcGNpYmsgaXMgd2FpdGluZyBm
b3IgYWNrIGJ5IGNoZWNraW5nIF9QQ0lCX29wX3BlbmRpbmcqLwogCWlmICgh
dGVzdF9iaXQoX1hFTl9QQ0lCX2FjdGl2ZSwgKHVuc2lnbmVkIGxvbmcgKikm
cGRldi0+c2hfaW5mby0+ZmxhZ3MpCiAJICAgICYmIHRlc3RfYml0KF9QQ0lC
X29wX3BlbmRpbmcsICZwZGV2LT5mbGFncykpIHsKIAkJd2FrZV91cCgmeGVu
X3BjaWJrX2Flcl93YWl0X3F1ZXVlKTsKKwkJZW9pID0gZmFsc2U7CiAJfQor
CisJLyogRU9JIGlmIHRoZXJlIHdhcyBub3RoaW5nIHRvIGRvLiAqLworCWlm
IChlb2kpCisJCXhlbl9wY2lia19sYXRlZW9pKHBkZXYsIFhFTl9FT0lfRkxB
R19TUFVSSU9VUyk7CiB9CiAKIC8qIFBlcmZvcm1pbmcgdGhlIGNvbmZpZ3Vy
YXRpb24gc3BhY2UgcmVhZHMvd3JpdGVzIG11c3Qgbm90IGJlIGRvbmUgaW4g
YXRvbWljCkBAIC0zMDMsMTAgKzMxOCw4IEBAIHZvaWQgeGVuX3BjaWJrX3Rl
c3RfYW5kX3NjaGVkdWxlX29wKHN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNlICpw
ZGV2KQogICogdXNlIG9mIHNlbWFwaG9yZXMpLiBUaGlzIGZ1bmN0aW9uIGlz
IGludGVuZGVkIHRvIGJlIGNhbGxlZCBmcm9tIGEgd29yawogICogcXVldWUg
aW4gcHJvY2VzcyBjb250ZXh0IHRha2luZyBhIHN0cnVjdCB4ZW5fcGNpYmtf
ZGV2aWNlIGFzIGEgcGFyYW1ldGVyICovCiAKLXZvaWQgeGVuX3BjaWJrX2Rv
X29wKHN0cnVjdCB3b3JrX3N0cnVjdCAqZGF0YSkKK3N0YXRpYyB2b2lkIHhl
bl9wY2lia19kb19vbmVfb3Aoc3RydWN0IHhlbl9wY2lia19kZXZpY2UgKnBk
ZXYpCiB7Ci0Jc3RydWN0IHhlbl9wY2lia19kZXZpY2UgKnBkZXYgPQotCQlj
b250YWluZXJfb2YoZGF0YSwgc3RydWN0IHhlbl9wY2lia19kZXZpY2UsIG9w
X3dvcmspOwogCXN0cnVjdCBwY2lfZGV2ICpkZXY7CiAJc3RydWN0IHhlbl9w
Y2lia19kZXZfZGF0YSAqZGV2X2RhdGEgPSBOVUxMOwogCXN0cnVjdCB4ZW5f
cGNpX29wICpvcCA9ICZwZGV2LT5vcDsKQEAgLTM3OSwxNiArMzkyLDMxIEBA
IHZvaWQgeGVuX3BjaWJrX2RvX29wKHN0cnVjdCB3b3JrX3N0cnVjdCAqZGF0
YSkKIAlzbXBfbWJfX2JlZm9yZV9hdG9taWMoKTsgLyogL2FmdGVyLyBjbGVh
cmluZyBQQ0lGX2FjdGl2ZSAqLwogCWNsZWFyX2JpdChfUERFVkZfb3BfYWN0
aXZlLCAmcGRldi0+ZmxhZ3MpOwogCXNtcF9tYl9fYWZ0ZXJfYXRvbWljKCk7
IC8qIC9iZWZvcmUvIGZpbmFsIGNoZWNrIGZvciB3b3JrICovCit9CiAKLQkv
KiBDaGVjayB0byBzZWUgaWYgdGhlIGRyaXZlciBkb21haW4gdHJpZWQgdG8g
c3RhcnQgYW5vdGhlciByZXF1ZXN0IGluCi0JICogYmV0d2VlbiBjbGVhcmlu
ZyBfWEVOX1BDSUZfYWN0aXZlIGFuZCBjbGVhcmluZyBfUERFVkZfb3BfYWN0
aXZlLgotCSovCi0JeGVuX3BjaWJrX3Rlc3RfYW5kX3NjaGVkdWxlX29wKHBk
ZXYpOwordm9pZCB4ZW5fcGNpYmtfZG9fb3Aoc3RydWN0IHdvcmtfc3RydWN0
ICpkYXRhKQoreworCXN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNlICpwZGV2ID0K
KwkJY29udGFpbmVyX29mKGRhdGEsIHN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNl
LCBvcF93b3JrKTsKKworCWRvIHsKKwkJeGVuX3BjaWJrX2RvX29uZV9vcChw
ZGV2KTsKKwl9IHdoaWxlICh4ZW5fcGNpYmtfdGVzdF9vcF9wZW5kaW5nKHBk
ZXYpKTsKKworCXhlbl9wY2lia19sYXRlZW9pKHBkZXYsIDApOwogfQogCiBp
cnFyZXR1cm5fdCB4ZW5fcGNpYmtfaGFuZGxlX2V2ZW50KGludCBpcnEsIHZv
aWQgKmRldl9pZCkKIHsKIAlzdHJ1Y3QgeGVuX3BjaWJrX2RldmljZSAqcGRl
diA9IGRldl9pZDsKKwlib29sIGVvaTsKKworCS8qIElSUXMgbWlnaHQgY29t
ZSBpbiBiZWZvcmUgcGRldi0+ZXZ0Y2huX2lycSBpcyB3cml0dGVuLiAqLwor
CWlmICh1bmxpa2VseShwZGV2LT5ldnRjaG5faXJxICE9IGlycSkpCisJCXBk
ZXYtPmV2dGNobl9pcnEgPSBpcnE7CisKKwllb2kgPSB0ZXN0X2FuZF9zZXRf
Yml0KF9FT0lfcGVuZGluZywgJnBkZXYtPmZsYWdzKTsKKwlXQVJOKGVvaSwg
IklSUSB3aGlsZSBFT0kgcGVuZGluZ1xuIik7CiAKIAl4ZW5fcGNpYmtfdGVz
dF9hbmRfc2NoZWR1bGVfb3AocGRldik7CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMveGVuL3hlbi1wY2liYWNrL3hlbmJ1cy5jIGIvZHJpdmVycy94ZW4veGVu
LXBjaWJhY2sveGVuYnVzLmMKaW5kZXggYjUwMDQ2NmE2YzM3Li40Yjk5ZWMz
ZGVjNTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMveGVuL3hlbi1wY2liYWNrL3hl
bmJ1cy5jCisrKyBiL2RyaXZlcnMveGVuL3hlbi1wY2liYWNrL3hlbmJ1cy5j
CkBAIC0xMjMsNyArMTIzLDcgQEAgc3RhdGljIGludCB4ZW5fcGNpYmtfZG9f
YXR0YWNoKHN0cnVjdCB4ZW5fcGNpYmtfZGV2aWNlICpwZGV2LCBpbnQgZ250
X3JlZiwKIAogCXBkZXYtPnNoX2luZm8gPSB2YWRkcjsKIAotCWVyciA9IGJp
bmRfaW50ZXJkb21haW5fZXZ0Y2huX3RvX2lycWhhbmRsZXIoCisJZXJyID0g
YmluZF9pbnRlcmRvbWFpbl9ldnRjaG5fdG9faXJxaGFuZGxlcl9sYXRlZW9p
KAogCQlwZGV2LT54ZGV2LT5vdGhlcmVuZF9pZCwgcmVtb3RlX2V2dGNobiwg
eGVuX3BjaWJrX2hhbmRsZV9ldmVudCwKIAkJMCwgRFJWX05BTUUsIHBkZXYp
OwogCWlmIChlcnIgPCAwKSB7Ci0tIAoyLjI2LjIKCg==

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-09.patch"
Content-Disposition: attachment; filename="xsa332-linux-09.patch"
Content-Transfer-Encoding: base64

RnJvbSA3ZDNjZmJlZWZlMTZmODkwOWMyOTI0ZTk4MDY2YmMzMTVhYWQ4NjU2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzoyOSArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDkvMTJdIHhlbi9ldmVudHM6
IHN3aXRjaCB1c2VyIGV2ZW50IGNoYW5uZWxzIHRvIGxhdGVlb2kKIG1vZGVs
CgpJbnN0ZWFkIG9mIGRpc2FibGluZyB0aGUgaXJxIHdoZW4gYW4gZXZlbnQg
aXMgcmVjZWl2ZWQgYW5kIGVuYWJsaW5nCml0IGFnYWluIHdoZW4gaGFuZGxl
ZCBieSB0aGUgdXNlciBwcm9jZXNzIHVzZSB0aGUgbGF0ZWVvaSBtb2RlbC4K
ClRoaXMgaXMgcGFydCBvZiBYU0EtMzMyLgoKQ2M6IHN0YWJsZUB2Z2VyLmtl
cm5lbC5vcmcKUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8anVsaWVuQHhl
bi5vcmc+ClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0Bz
dXNlLmNvbT4KVGVzdGVkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFi
ZWxsaW5pQGtlcm5lbC5vcmc+ClJldmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJl
bGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+ClJldmlld2VkLWJ5OiBK
YW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBX
ZWkgTGl1IDx3bEB4ZW4ub3JnPgotLS0KIGRyaXZlcnMveGVuL2V2dGNobi5j
IHwgNyArKystLS0tCiAxIGZpbGUgY2hhbmdlZCwgMyBpbnNlcnRpb25zKCsp
LCA0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMveGVuL2V2
dGNobi5jIGIvZHJpdmVycy94ZW4vZXZ0Y2huLmMKaW5kZXggNmUwYjFkZDU1
NzNjLi41ZGMwMTZkNjhmODMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMveGVuL2V2
dGNobi5jCisrKyBiL2RyaXZlcnMveGVuL2V2dGNobi5jCkBAIC0xNjcsNyAr
MTY3LDYgQEAgc3RhdGljIGlycXJldHVybl90IGV2dGNobl9pbnRlcnJ1cHQo
aW50IGlycSwgdm9pZCAqZGF0YSkKIAkgICAgICJJbnRlcnJ1cHQgZm9yIHBv
cnQgJXUsIGJ1dCBhcHBhcmVudGx5IG5vdCBlbmFibGVkOyBwZXItdXNlciAl
cFxuIiwKIAkgICAgIGV2dGNobi0+cG9ydCwgdSk7CiAKLQlkaXNhYmxlX2ly
cV9ub3N5bmMoaXJxKTsKIAlldnRjaG4tPmVuYWJsZWQgPSBmYWxzZTsKIAog
CXNwaW5fbG9jaygmdS0+cmluZ19wcm9kX2xvY2spOwpAQCAtMjkzLDcgKzI5
Miw3IEBAIHN0YXRpYyBzc2l6ZV90IGV2dGNobl93cml0ZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgY29uc3QgY2hhciBfX3VzZXIgKmJ1ZiwKIAkJZXZ0Y2huID0g
ZmluZF9ldnRjaG4odSwgcG9ydCk7CiAJCWlmIChldnRjaG4gJiYgIWV2dGNo
bi0+ZW5hYmxlZCkgewogCQkJZXZ0Y2huLT5lbmFibGVkID0gdHJ1ZTsKLQkJ
CWVuYWJsZV9pcnEoaXJxX2Zyb21fZXZ0Y2huKHBvcnQpKTsKKwkJCXhlbl9p
cnFfbGF0ZWVvaShpcnFfZnJvbV9ldnRjaG4ocG9ydCksIDApOwogCQl9CiAJ
fQogCkBAIC0zOTMsOCArMzkyLDggQEAgc3RhdGljIGludCBldnRjaG5fYmlu
ZF90b191c2VyKHN0cnVjdCBwZXJfdXNlcl9kYXRhICp1LCBldnRjaG5fcG9y
dF90IHBvcnQpCiAJaWYgKHJjIDwgMCkKIAkJZ290byBlcnI7CiAKLQlyYyA9
IGJpbmRfZXZ0Y2huX3RvX2lycWhhbmRsZXIocG9ydCwgZXZ0Y2huX2ludGVy
cnVwdCwgMCwKLQkJCQkgICAgICAgdS0+bmFtZSwgZXZ0Y2huKTsKKwlyYyA9
IGJpbmRfZXZ0Y2huX3RvX2lycWhhbmRsZXJfbGF0ZWVvaShwb3J0LCBldnRj
aG5faW50ZXJydXB0LCAwLAorCQkJCQkgICAgICAgdS0+bmFtZSwgZXZ0Y2hu
KTsKIAlpZiAocmMgPCAwKQogCQlnb3RvIGVycjsKIAotLSAKMi4yNi4yCgo=

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-10.patch"
Content-Disposition: attachment; filename="xsa332-linux-10.patch"
Content-Transfer-Encoding: base64

RnJvbSA3NmZmNGJjYzBlNzlhZDc1NDY5OTAwMDYyMTM0YTM1NGI2ZTYzNzA4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFN1biwgMTMgU2VwIDIwMjAgMTQ6
MjM6MDIgKzAyMDAKU3ViamVjdDogW1BBVENIIDEwLzEyXSB4ZW4vZXZlbnRz
OiB1c2UgYSBjb21tb24gY3B1IGhvdHBsdWcgaG9vayBmb3IgZXZlbnQKIGNo
YW5uZWxzCgpUb2RheSBvbmx5IGZpZm8gZXZlbnQgY2hhbm5lbHMgaGF2ZSBh
IGNwdSBob3RwbHVnIGNhbGxiYWNrLiBJbiBvcmRlcgp0byBwcmVwYXJlIGZv
ciBtb3JlIHBlcmNwdSAoZGUpaW5pdCB3b3JrIG1vdmUgdGhhdCBjYWxsYmFj
ayBpbnRvCmV2ZW50c19iYXNlLmMgYW5kIGFkZCBwZXJjcHVfaW5pdCgpIGFu
ZCBwZXJjcHVfZGVpbml0KCkgaG9va3MgdG8Kc3RydWN0IGV2dGNobl9vcHMu
CgpUaGlzIGlzIHBhcnQgb2YgWFNBLTMzMi4KCkNjOiBzdGFibGVAdmdlci5r
ZXJuZWwub3JnClJlcG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1bGllbkB4
ZW4ub3JnPgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgot
LS0KIGRyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfYmFzZS5jICAgICB8IDI1
ICsrKysrKysrKysrKysrKysrCiBkcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRz
X2ZpZm8uYyAgICAgfCA0MCArKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0t
CiBkcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ludGVybmFsLmggfCAgMyAr
KysKIDMgZmlsZXMgY2hhbmdlZCwgNDcgaW5zZXJ0aW9ucygrKSwgMjEgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2
ZW50c19iYXNlLmMgYi9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2Jhc2Uu
YwppbmRleCAxZWJhOGJjMjA5YWQuLjljYmZlYTVlOWEwOCAxMDA2NDQKLS0t
IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNlLmMKKysrIGIvZHJp
dmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNlLmMKQEAgLTM0LDYgKzM0LDcg
QEAKICNpbmNsdWRlIDxsaW51eC9pcnFuci5oPgogI2luY2x1ZGUgPGxpbnV4
L3BjaS5oPgogI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+CisjaW5jbHVk
ZSA8bGludXgvY3B1aG90cGx1Zy5oPgogCiAjaWZkZWYgQ09ORklHX1g4Ngog
I2luY2x1ZGUgPGFzbS9kZXNjLmg+CkBAIC0xODMwLDYgKzE4MzEsMjYgQEAg
c3RhdGljIGlubGluZSB2b2lkIHhlbl9hbGxvY19jYWxsYmFja192ZWN0b3Io
dm9pZCkge30KIHN0YXRpYyBib29sIGZpZm9fZXZlbnRzID0gdHJ1ZTsKIG1v
ZHVsZV9wYXJhbShmaWZvX2V2ZW50cywgYm9vbCwgMCk7CiAKK3N0YXRpYyBp
bnQgeGVuX2V2dGNobl9jcHVfcHJlcGFyZSh1bnNpZ25lZCBpbnQgY3B1KQor
eworCWludCByZXQgPSAwOworCisJaWYgKGV2dGNobl9vcHMtPnBlcmNwdV9p
bml0KQorCQlyZXQgPSBldnRjaG5fb3BzLT5wZXJjcHVfaW5pdChjcHUpOwor
CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCB4ZW5fZXZ0Y2huX2Nw
dV9kZWFkKHVuc2lnbmVkIGludCBjcHUpCit7CisJaW50IHJldCA9IDA7CisK
KwlpZiAoZXZ0Y2huX29wcy0+cGVyY3B1X2RlaW5pdCkKKwkJcmV0ID0gZXZ0
Y2huX29wcy0+cGVyY3B1X2RlaW5pdChjcHUpOworCisJcmV0dXJuIHJldDsK
K30KKwogdm9pZCBfX2luaXQgeGVuX2luaXRfSVJRKHZvaWQpCiB7CiAJaW50
IHJldCA9IC1FSU5WQUw7CkBAIC0xODQwLDYgKzE4NjEsMTAgQEAgdm9pZCBf
X2luaXQgeGVuX2luaXRfSVJRKHZvaWQpCiAJaWYgKHJldCA8IDApCiAJCXhl
bl9ldnRjaG5fMmxfaW5pdCgpOwogCisJY3B1aHBfc2V0dXBfc3RhdGVfbm9j
YWxscyhDUFVIUF9YRU5fRVZUQ0hOX1BSRVBBUkUsCisJCQkJICAieGVuL2V2
dGNobjpwcmVwYXJlIiwKKwkJCQkgIHhlbl9ldnRjaG5fY3B1X3ByZXBhcmUs
IHhlbl9ldnRjaG5fY3B1X2RlYWQpOworCiAJZXZ0Y2huX3RvX2lycSA9IGtj
YWxsb2MoRVZUQ0hOX1JPVyh4ZW5fZXZ0Y2huX21heF9jaGFubmVscygpKSwK
IAkJCQlzaXplb2YoKmV2dGNobl90b19pcnEpLCBHRlBfS0VSTkVMKTsKIAlC
VUdfT04oIWV2dGNobl90b19pcnEpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy94
ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMgYi9kcml2ZXJzL3hlbi9ldmVudHMv
ZXZlbnRzX2ZpZm8uYwppbmRleCA3ZmQzOWM2NGQ0YjUuLjQwZTRjYTE2ODVh
YSAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZv
LmMKKysrIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMKQEAg
LTM4NSwyMSArMzg1LDYgQEAgc3RhdGljIHZvaWQgZXZ0Y2huX2ZpZm9fcmVz
dW1lKHZvaWQpCiAJZXZlbnRfYXJyYXlfcGFnZXMgPSAwOwogfQogCi1zdGF0
aWMgY29uc3Qgc3RydWN0IGV2dGNobl9vcHMgZXZ0Y2huX29wc19maWZvID0g
ewotCS5tYXhfY2hhbm5lbHMgICAgICA9IGV2dGNobl9maWZvX21heF9jaGFu
bmVscywKLQkubnJfY2hhbm5lbHMgICAgICAgPSBldnRjaG5fZmlmb19ucl9j
aGFubmVscywKLQkuc2V0dXAgICAgICAgICAgICAgPSBldnRjaG5fZmlmb19z
ZXR1cCwKLQkuYmluZF90b19jcHUgICAgICAgPSBldnRjaG5fZmlmb19iaW5k
X3RvX2NwdSwKLQkuY2xlYXJfcGVuZGluZyAgICAgPSBldnRjaG5fZmlmb19j
bGVhcl9wZW5kaW5nLAotCS5zZXRfcGVuZGluZyAgICAgICA9IGV2dGNobl9m
aWZvX3NldF9wZW5kaW5nLAotCS5pc19wZW5kaW5nICAgICAgICA9IGV2dGNo
bl9maWZvX2lzX3BlbmRpbmcsCi0JLnRlc3RfYW5kX3NldF9tYXNrID0gZXZ0
Y2huX2ZpZm9fdGVzdF9hbmRfc2V0X21hc2ssCi0JLm1hc2sgICAgICAgICAg
ICAgID0gZXZ0Y2huX2ZpZm9fbWFzaywKLQkudW5tYXNrICAgICAgICAgICAg
PSBldnRjaG5fZmlmb191bm1hc2ssCi0JLmhhbmRsZV9ldmVudHMgICAgID0g
ZXZ0Y2huX2ZpZm9faGFuZGxlX2V2ZW50cywKLQkucmVzdW1lICAgICAgICAg
ICAgPSBldnRjaG5fZmlmb19yZXN1bWUsCi19OwotCiBzdGF0aWMgaW50IGV2
dGNobl9maWZvX2FsbG9jX2NvbnRyb2xfYmxvY2sodW5zaWduZWQgY3B1KQog
ewogCXZvaWQgKmNvbnRyb2xfYmxvY2sgPSBOVUxMOwpAQCAtNDIyLDE5ICs0
MDcsMzYgQEAgc3RhdGljIGludCBldnRjaG5fZmlmb19hbGxvY19jb250cm9s
X2Jsb2NrKHVuc2lnbmVkIGNwdSkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0
aWMgaW50IHhlbl9ldnRjaG5fY3B1X3ByZXBhcmUodW5zaWduZWQgaW50IGNw
dSkKK3N0YXRpYyBpbnQgZXZ0Y2huX2ZpZm9fcGVyY3B1X2luaXQodW5zaWdu
ZWQgaW50IGNwdSkKIHsKIAlpZiAoIXBlcl9jcHUoY3B1X2NvbnRyb2xfYmxv
Y2ssIGNwdSkpCiAJCXJldHVybiBldnRjaG5fZmlmb19hbGxvY19jb250cm9s
X2Jsb2NrKGNwdSk7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgeGVu
X2V2dGNobl9jcHVfZGVhZCh1bnNpZ25lZCBpbnQgY3B1KQorc3RhdGljIGlu
dCBldnRjaG5fZmlmb19wZXJjcHVfZGVpbml0KHVuc2lnbmVkIGludCBjcHUp
CiB7CiAJX19ldnRjaG5fZmlmb19oYW5kbGVfZXZlbnRzKGNwdSwgdHJ1ZSk7
CiAJcmV0dXJuIDA7CiB9CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZXZ0Y2hu
X29wcyBldnRjaG5fb3BzX2ZpZm8gPSB7CisJLm1heF9jaGFubmVscyAgICAg
ID0gZXZ0Y2huX2ZpZm9fbWF4X2NoYW5uZWxzLAorCS5ucl9jaGFubmVscyAg
ICAgICA9IGV2dGNobl9maWZvX25yX2NoYW5uZWxzLAorCS5zZXR1cCAgICAg
ICAgICAgICA9IGV2dGNobl9maWZvX3NldHVwLAorCS5iaW5kX3RvX2NwdSAg
ICAgICA9IGV2dGNobl9maWZvX2JpbmRfdG9fY3B1LAorCS5jbGVhcl9wZW5k
aW5nICAgICA9IGV2dGNobl9maWZvX2NsZWFyX3BlbmRpbmcsCisJLnNldF9w
ZW5kaW5nICAgICAgID0gZXZ0Y2huX2ZpZm9fc2V0X3BlbmRpbmcsCisJLmlz
X3BlbmRpbmcgICAgICAgID0gZXZ0Y2huX2ZpZm9faXNfcGVuZGluZywKKwku
dGVzdF9hbmRfc2V0X21hc2sgPSBldnRjaG5fZmlmb190ZXN0X2FuZF9zZXRf
bWFzaywKKwkubWFzayAgICAgICAgICAgICAgPSBldnRjaG5fZmlmb19tYXNr
LAorCS51bm1hc2sgICAgICAgICAgICA9IGV2dGNobl9maWZvX3VubWFzaywK
KwkuaGFuZGxlX2V2ZW50cyAgICAgPSBldnRjaG5fZmlmb19oYW5kbGVfZXZl
bnRzLAorCS5yZXN1bWUgICAgICAgICAgICA9IGV2dGNobl9maWZvX3Jlc3Vt
ZSwKKwkucGVyY3B1X2luaXQgICAgICAgPSBldnRjaG5fZmlmb19wZXJjcHVf
aW5pdCwKKwkucGVyY3B1X2RlaW5pdCAgICAgPSBldnRjaG5fZmlmb19wZXJj
cHVfZGVpbml0LAorfTsKKwogaW50IF9faW5pdCB4ZW5fZXZ0Y2huX2ZpZm9f
aW5pdCh2b2lkKQogewogCWludCBjcHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7
CkBAIC00NDgsOSArNDUwLDUgQEAgaW50IF9faW5pdCB4ZW5fZXZ0Y2huX2Zp
Zm9faW5pdCh2b2lkKQogCiAJZXZ0Y2huX29wcyA9ICZldnRjaG5fb3BzX2Zp
Zm87CiAKLQljcHVocF9zZXR1cF9zdGF0ZV9ub2NhbGxzKENQVUhQX1hFTl9F
VlRDSE5fUFJFUEFSRSwKLQkJCQkgICJ4ZW4vZXZ0Y2huOnByZXBhcmUiLAot
CQkJCSAgeGVuX2V2dGNobl9jcHVfcHJlcGFyZSwgeGVuX2V2dGNobl9jcHVf
ZGVhZCk7Ci0KIAlyZXR1cm4gcmV0OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy94ZW4vZXZlbnRzL2V2ZW50c19pbnRlcm5hbC5oIGIvZHJpdmVycy94ZW4v
ZXZlbnRzL2V2ZW50c19pbnRlcm5hbC5oCmluZGV4IDEwNjg0ZmViMDk0ZS4u
NTU4YWJlYTE5ZDBkIDEwMDY0NAotLS0gYS9kcml2ZXJzL3hlbi9ldmVudHMv
ZXZlbnRzX2ludGVybmFsLmgKKysrIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2
ZW50c19pbnRlcm5hbC5oCkBAIC02OSw2ICs2OSw5IEBAIHN0cnVjdCBldnRj
aG5fb3BzIHsKIAogCXZvaWQgKCpoYW5kbGVfZXZlbnRzKSh1bnNpZ25lZCBj
cHUpOwogCXZvaWQgKCpyZXN1bWUpKHZvaWQpOworCisJaW50ICgqcGVyY3B1
X2luaXQpKHVuc2lnbmVkIGludCBjcHUpOworCWludCAoKnBlcmNwdV9kZWlu
aXQpKHVuc2lnbmVkIGludCBjcHUpOwogfTsKIAogZXh0ZXJuIGNvbnN0IHN0
cnVjdCBldnRjaG5fb3BzICpldnRjaG5fb3BzOwotLSAKMi4yNi4yCgo=

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-11.patch"
Content-Disposition: attachment; filename="xsa332-linux-11.patch"
Content-Transfer-Encoding: base64

RnJvbSBhYjJkYjdjOGVhYWY3ZDFmYjU0NjYxNzUwM2YxN2I3OTQ5N2VkY2U3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgNyBTZXAgMjAyMCAxNTo0
NzozMCArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMTEvMTJdIHhlbi9ldmVudHM6
IGRlZmVyIGVvaSBpbiBjYXNlIG9mIGV4Y2Vzc2l2ZSBudW1iZXIKIG9mIGV2
ZW50cwoKSW4gY2FzZSByb2d1ZSBndWVzdHMgYXJlIHNlbmRpbmcgZXZlbnRz
IGF0IGhpZ2ggZnJlcXVlbmN5IGl0IG1pZ2h0CmhhcHBlbiB0aGF0IHhlbl9l
dnRjaG5fZG9fdXBjYWxsKCkgd29uJ3Qgc3RvcCBwcm9jZXNzaW5nIGV2ZW50
cyBpbgpkb20wLiBBcyB0aGlzIGlzIGRvbmUgaW4gaXJxIGhhbmRsaW5nIGEg
Y3Jhc2ggbWlnaHQgYmUgdGhlIHJlc3VsdC4KCkluIG9yZGVyIHRvIGF2b2lk
IHRoYXQsIGRlbGF5IGZ1cnRoZXIgaW50ZXItZG9tYWluIGV2ZW50cyBhZnRl
ciBzb21lCnRpbWUgaW4geGVuX2V2dGNobl9kb191cGNhbGwoKSBieSBmb3Jj
aW5nIGVvaSBwcm9jZXNzaW5nIGludG8gYQp3b3JrZXIgb24gdGhlIHNhbWUg
Y3B1LCB0aHVzIGluaGliaXRpbmcgbmV3IGV2ZW50cyBjb21pbmcgaW4uCgpU
aGUgdGltZSBhZnRlciB3aGljaCBlb2kgcHJvY2Vzc2luZyBpcyB0byBiZSBk
ZWxheWVkIGlzIGNvbmZpZ3VyYWJsZQp2aWEgYSBuZXcgbW9kdWxlIHBhcmFt
ZXRlciAiZXZlbnRfbG9vcF90aW1lb3V0IiB3aGljaCBzcGVjaWZpZXMgdGhl
Cm1heGltdW0gZXZlbnQgbG9vcCB0aW1lIGluIGppZmZpZXMgKGRlZmF1bHQ6
IDIsIHRoZSB2YWx1ZSB3YXMgY2hvc2VuCmFmdGVyIHNvbWUgdGVzdHMgc2hv
d2luZyB0aGF0IGEgdmFsdWUgb2YgMiB3YXMgdGhlIGxvd2VzdCB3aXRoIGFu
Cm9ubHkgc2xpZ2h0IGRyb3Agb2YgZG9tMCBuZXR3b3JrIHRocm91Z2hwdXQg
d2hpbGUgbXVsdGlwbGUgZ3Vlc3RzCnBlcmZvcm1lZCBhbiBldmVudCBzdG9y
bSkuCgpIb3cgbG9uZyBlb2kgcHJvY2Vzc2luZyB3aWxsIGJlIGRlbGF5ZWQg
Y2FuIGJlIHNwZWNpZmllZCB2aWEgYW5vdGhlcgpwYXJhbWV0ZXIgImV2ZW50
X2VvaV9kZWxheSIgKGFnYWluIGluIGppZmZpZXMsIGRlZmF1bHQgMTAsIGFn
YWluIHRoZQp2YWx1ZSB3YXMgY2hvc2VuIGFmdGVyIHRlc3Rpbmcgd2l0aCBk
aWZmZXJlbnQgZGVsYXkgdmFsdWVzKS4KClRoaXMgaXMgcGFydCBvZiBYU0Et
MzMyLgoKQ2M6IHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmcKUmVwb3J0ZWQtYnk6
IEp1bGllbiBHcmFsbCA8anVsaWVuQHhlbi5vcmc+ClNpZ25lZC1vZmYtYnk6
IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6
IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3N0YWJlbGxpbmlAa2VybmVsLm9yZz4K
UmV2aWV3ZWQtYnk6IFdlaSBMaXUgPHdsQHhlbi5vcmc+Ci0tLQogLi4uL2Fk
bWluLWd1aWRlL2tlcm5lbC1wYXJhbWV0ZXJzLnR4dCAgICAgICAgIHwgICA4
ICsKIGRyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfMmwuYyAgICAgICAgICAg
ICAgICB8ICAgNyArLQogZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNl
LmMgICAgICAgICAgICAgIHwgMTg5ICsrKysrKysrKysrKysrKysrLQogZHJp
dmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMgICAgICAgICAgICAgIHwg
IDMwICstLQogZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19pbnRlcm5hbC5o
ICAgICAgICAgIHwgIDE0ICstCiA1IGZpbGVzIGNoYW5nZWQsIDIxNiBpbnNl
cnRpb25zKCspLCAzMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9Eb2N1
bWVudGF0aW9uL2FkbWluLWd1aWRlL2tlcm5lbC1wYXJhbWV0ZXJzLnR4dCBi
L0RvY3VtZW50YXRpb24vYWRtaW4tZ3VpZGUva2VybmVsLXBhcmFtZXRlcnMu
dHh0CmluZGV4IGExMDY4NzQyYTZkZi4uODlkOTc3ZjBiNzg2IDEwMDY0NAot
LS0gYS9Eb2N1bWVudGF0aW9uL2FkbWluLWd1aWRlL2tlcm5lbC1wYXJhbWV0
ZXJzLnR4dAorKysgYi9Eb2N1bWVudGF0aW9uL2FkbWluLWd1aWRlL2tlcm5l
bC1wYXJhbWV0ZXJzLnR4dApAQCAtNTgyOCw2ICs1ODI4LDE0IEBACiAJCQlp
bXByb3ZlIHRpbWVyIHJlc29sdXRpb24gYXQgdGhlIGV4cGVuc2Ugb2YgcHJv
Y2Vzc2luZwogCQkJbW9yZSB0aW1lciBpbnRlcnJ1cHRzLgogCisJeGVuLmV2
ZW50X2VvaV9kZWxheT0JW1hFTl0KKwkJCUhvdyBsb25nIHRvIGRlbGF5IEVP
SSBoYW5kbGluZyBpbiBjYXNlIG9mIGV2ZW50CisJCQlzdG9ybXMgKGppZmZp
ZXMpLiBEZWZhdWx0IGlzIDEwLgorCisJeGVuLmV2ZW50X2xvb3BfdGltZW91
dD0JW1hFTl0KKwkJCUFmdGVyIHdoaWNoIHRpbWUgKGppZmZpZXMpIHRoZSBl
dmVudCBoYW5kbGluZyBsb29wCisJCQlzaG91bGQgc3RhcnQgdG8gZGVsYXkg
RU9JIGhhbmRsaW5nLiBEZWZhdWx0IGlzIDIuCisKIAlub3B2PQkJW1g4NixY
RU4sS1ZNLEhZUEVSX1YsVk1XQVJFXQogCQkJRGlzYWJsZXMgdGhlIFBWIG9w
dGltaXphdGlvbnMgZm9yY2luZyB0aGUgZ3Vlc3QgdG8gcnVuCiAJCQlhcyBn
ZW5lcmljIGd1ZXN0IHdpdGggbm8gUFYgZHJpdmVycy4gQ3VycmVudGx5IHN1
cHBvcnQKZGlmZiAtLWdpdCBhL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNf
MmwuYyBiL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfMmwuYwppbmRleCBl
MWFmNWUwOTNmZjQuLmZlNWFkMGU4OWNkOCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy94ZW4vZXZlbnRzL2V2ZW50c18ybC5jCisrKyBiL2RyaXZlcnMveGVuL2V2
ZW50cy9ldmVudHNfMmwuYwpAQCAtMTYxLDcgKzE2MSw3IEBAIHN0YXRpYyBp
bmxpbmUgeGVuX3Vsb25nX3QgYWN0aXZlX2V2dGNobnModW5zaWduZWQgaW50
IGNwdSwKICAqIGEgYml0c2V0IG9mIHdvcmRzIHdoaWNoIGNvbnRhaW4gcGVu
ZGluZyBldmVudCBiaXRzLiAgVGhlIHNlY29uZAogICogbGV2ZWwgaXMgYSBi
aXRzZXQgb2YgcGVuZGluZyBldmVudHMgdGhlbXNlbHZlcy4KICAqLwotc3Rh
dGljIHZvaWQgZXZ0Y2huXzJsX2hhbmRsZV9ldmVudHModW5zaWduZWQgY3B1
KQorc3RhdGljIHZvaWQgZXZ0Y2huXzJsX2hhbmRsZV9ldmVudHModW5zaWdu
ZWQgY3B1LCBzdHJ1Y3QgZXZ0Y2huX2xvb3BfY3RybCAqY3RybCkKIHsKIAlp
bnQgaXJxOwogCXhlbl91bG9uZ190IHBlbmRpbmdfd29yZHM7CkBAIC0yNDIs
MTAgKzI0Miw3IEBAIHN0YXRpYyB2b2lkIGV2dGNobl8ybF9oYW5kbGVfZXZl
bnRzKHVuc2lnbmVkIGNwdSkKIAogCQkJLyogUHJvY2VzcyBwb3J0LiAqLwog
CQkJcG9ydCA9ICh3b3JkX2lkeCAqIEJJVFNfUEVSX0VWVENITl9XT1JEKSAr
IGJpdF9pZHg7Ci0JCQlpcnEgPSBnZXRfZXZ0Y2huX3RvX2lycShwb3J0KTsK
LQotCQkJaWYgKGlycSAhPSAtMSkKLQkJCQlnZW5lcmljX2hhbmRsZV9pcnEo
aXJxKTsKKwkJCWhhbmRsZV9pcnFfZm9yX3BvcnQocG9ydCwgY3RybCk7CiAK
IAkJCWJpdF9pZHggPSAoYml0X2lkeCArIDEpICUgQklUU19QRVJfRVZUQ0hO
X1dPUkQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVu
dHNfYmFzZS5jIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNlLmMK
aW5kZXggOWNiZmVhNWU5YTA4Li5jZGUwOTZhNmYxMWQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfYmFzZS5jCisrKyBiL2RyaXZl
cnMveGVuL2V2ZW50cy9ldmVudHNfYmFzZS5jCkBAIC0zNSw2ICszNSw4IEBA
CiAjaW5jbHVkZSA8bGludXgvcGNpLmg+CiAjaW5jbHVkZSA8bGludXgvc3Bp
bmxvY2suaD4KICNpbmNsdWRlIDxsaW51eC9jcHVob3RwbHVnLmg+CisjaW5j
bHVkZSA8bGludXgvYXRvbWljLmg+CisjaW5jbHVkZSA8bGludXgva3RpbWUu
aD4KIAogI2lmZGVmIENPTkZJR19YODYKICNpbmNsdWRlIDxhc20vZGVzYy5o
PgpAQCAtNjUsNiArNjcsMTUgQEAKIAogI2luY2x1ZGUgImV2ZW50c19pbnRl
cm5hbC5oIgogCisjdW5kZWYgTU9EVUxFX1BBUkFNX1BSRUZJWAorI2RlZmlu
ZSBNT0RVTEVfUEFSQU1fUFJFRklYICJ4ZW4uIgorCitzdGF0aWMgdWludCBf
X3JlYWRfbW9zdGx5IGV2ZW50X2xvb3BfdGltZW91dCA9IDI7Cittb2R1bGVf
cGFyYW0oZXZlbnRfbG9vcF90aW1lb3V0LCB1aW50LCAwNjQ0KTsKKworc3Rh
dGljIHVpbnQgX19yZWFkX21vc3RseSBldmVudF9lb2lfZGVsYXkgPSAxMDsK
K21vZHVsZV9wYXJhbShldmVudF9lb2lfZGVsYXksIHVpbnQsIDA2NDQpOwor
CiBjb25zdCBzdHJ1Y3QgZXZ0Y2huX29wcyAqZXZ0Y2huX29wczsKIAogLyoK
QEAgLTg4LDYgKzk5LDcgQEAgc3RhdGljIERFRklORV9SV0xPQ0soZXZ0Y2hu
X3J3bG9jayk7CiAgKiBpcnFfbWFwcGluZ191cGRhdGVfbG9jawogICogICBl
dnRjaG5fcndsb2NrCiAgKiAgICAgSVJRLWRlc2MgbG9jaworICogICAgICAg
cGVyY3B1IGVvaV9saXN0X2xvY2sKICAqLwogCiBzdGF0aWMgTElTVF9IRUFE
KHhlbl9pcnFfbGlzdF9oZWFkKTsKQEAgLTEyMCw2ICsxMzIsOCBAQCBzdGF0
aWMgc3RydWN0IGlycV9jaGlwIHhlbl9waXJxX2NoaXA7CiBzdGF0aWMgdm9p
ZCBlbmFibGVfZHluaXJxKHN0cnVjdCBpcnFfZGF0YSAqZGF0YSk7CiBzdGF0
aWMgdm9pZCBkaXNhYmxlX2R5bmlycShzdHJ1Y3QgaXJxX2RhdGEgKmRhdGEp
OwogCitzdGF0aWMgREVGSU5FX1BFUl9DUFUodW5zaWduZWQgaW50LCBpcnFf
ZXBvY2gpOworCiBzdGF0aWMgdm9pZCBjbGVhcl9ldnRjaG5fdG9faXJxX3Jv
dyh1bnNpZ25lZCByb3cpCiB7CiAJdW5zaWduZWQgY29sOwpAQCAtMzk5LDE3
ICs0MTMsMTIwIEBAIHZvaWQgbm90aWZ5X3JlbW90ZV92aWFfaXJxKGludCBp
cnEpCiB9CiBFWFBPUlRfU1lNQk9MX0dQTChub3RpZnlfcmVtb3RlX3ZpYV9p
cnEpOwogCitzdHJ1Y3QgbGF0ZWVvaV93b3JrIHsKKwlzdHJ1Y3QgZGVsYXll
ZF93b3JrIGRlbGF5ZWQ7CisJc3BpbmxvY2tfdCBlb2lfbGlzdF9sb2NrOwor
CXN0cnVjdCBsaXN0X2hlYWQgZW9pX2xpc3Q7Cit9OworCitzdGF0aWMgREVG
SU5FX1BFUl9DUFUoc3RydWN0IGxhdGVlb2lfd29yaywgbGF0ZWVvaSk7CisK
K3N0YXRpYyB2b2lkIGxhdGVlb2lfbGlzdF9kZWwoc3RydWN0IGlycV9pbmZv
ICppbmZvKQoreworCXN0cnVjdCBsYXRlZW9pX3dvcmsgKmVvaSA9ICZwZXJf
Y3B1KGxhdGVlb2ksIGluZm8tPmVvaV9jcHUpOworCXVuc2lnbmVkIGxvbmcg
ZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmZW9pLT5lb2lfbGlzdF9s
b2NrLCBmbGFncyk7CisJbGlzdF9kZWxfaW5pdCgmaW5mby0+ZW9pX2xpc3Qp
OworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmVvaS0+ZW9pX2xpc3RfbG9j
aywgZmxhZ3MpOworfQorCitzdGF0aWMgdm9pZCBsYXRlZW9pX2xpc3RfYWRk
KHN0cnVjdCBpcnFfaW5mbyAqaW5mbykKK3sKKwlzdHJ1Y3QgbGF0ZWVvaV93
b3JrICplb2kgPSAmcGVyX2NwdShsYXRlZW9pLCBpbmZvLT5lb2lfY3B1KTsK
KwlzdHJ1Y3QgaXJxX2luZm8gKmVsZW07CisJdTY0IG5vdyA9IGdldF9qaWZm
aWVzXzY0KCk7CisJdW5zaWduZWQgbG9uZyBkZWxheTsKKwl1bnNpZ25lZCBs
b25nIGZsYWdzOworCisJaWYgKG5vdyA8IGluZm8tPmVvaV90aW1lKQorCQlk
ZWxheSA9IGluZm8tPmVvaV90aW1lIC0gbm93OworCWVsc2UKKwkJZGVsYXkg
PSAxOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJmVvaS0+ZW9pX2xpc3RfbG9j
aywgZmxhZ3MpOworCisJaWYgKGxpc3RfZW1wdHkoJmVvaS0+ZW9pX2xpc3Qp
KSB7CisJCWxpc3RfYWRkKCZpbmZvLT5lb2lfbGlzdCwgJmVvaS0+ZW9pX2xp
c3QpOworCQltb2RfZGVsYXllZF93b3JrX29uKGluZm8tPmVvaV9jcHUsIHN5
c3RlbV93cSwKKwkJCQkgICAgJmVvaS0+ZGVsYXllZCwgZGVsYXkpOworCX0g
ZWxzZSB7CisJCWxpc3RfZm9yX2VhY2hfZW50cnlfcmV2ZXJzZShlbGVtLCAm
ZW9pLT5lb2lfbGlzdCwgZW9pX2xpc3QpIHsKKwkJCWlmIChlbGVtLT5lb2lf
dGltZSA8PSBpbmZvLT5lb2lfdGltZSkKKwkJCQlicmVhazsKKwkJfQorCQls
aXN0X2FkZCgmaW5mby0+ZW9pX2xpc3QsICZlbGVtLT5lb2lfbGlzdCk7CisJ
fQorCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZW9pLT5lb2lfbGlzdF9s
b2NrLCBmbGFncyk7Cit9CisKIHN0YXRpYyB2b2lkIHhlbl9pcnFfbGF0ZWVv
aV9sb2NrZWQoc3RydWN0IGlycV9pbmZvICppbmZvKQogewogCWV2dGNobl9w
b3J0X3QgZXZ0Y2huOworCXVuc2lnbmVkIGludCBjcHU7CiAKIAlldnRjaG4g
PSBpbmZvLT5ldnRjaG47Ci0JaWYgKCFWQUxJRF9FVlRDSE4oZXZ0Y2huKSkK
KwlpZiAoIVZBTElEX0VWVENITihldnRjaG4pIHx8ICFsaXN0X2VtcHR5KCZp
bmZvLT5lb2lfbGlzdCkpCiAJCXJldHVybjsKIAorCWNwdSA9IGluZm8tPmVv
aV9jcHU7CisJaWYgKGluZm8tPmVvaV90aW1lICYmIGluZm8tPmlycV9lcG9j
aCA9PSBwZXJfY3B1KGlycV9lcG9jaCwgY3B1KSkgeworCQlsYXRlZW9pX2xp
c3RfYWRkKGluZm8pOworCQlyZXR1cm47CisJfQorCisJaW5mby0+ZW9pX3Rp
bWUgPSAwOwogCXVubWFza19ldnRjaG4oZXZ0Y2huKTsKIH0KIAorc3RhdGlj
IHZvaWQgeGVuX2lycV9sYXRlZW9pX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspCit7CisJc3RydWN0IGxhdGVlb2lfd29yayAqZW9pOworCXN0
cnVjdCBpcnFfaW5mbyAqaW5mbzsKKwl1NjQgbm93ID0gZ2V0X2ppZmZpZXNf
NjQoKTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJZW9pID0gY29udGFp
bmVyX29mKHRvX2RlbGF5ZWRfd29yayh3b3JrKSwgc3RydWN0IGxhdGVlb2lf
d29yaywgZGVsYXllZCk7CisKKwlyZWFkX2xvY2tfaXJxc2F2ZSgmZXZ0Y2hu
X3J3bG9jaywgZmxhZ3MpOworCisJd2hpbGUgKHRydWUpIHsKKwkJc3Bpbl9s
b2NrKCZlb2ktPmVvaV9saXN0X2xvY2spOworCisJCWluZm8gPSBsaXN0X2Zp
cnN0X2VudHJ5X29yX251bGwoJmVvaS0+ZW9pX2xpc3QsIHN0cnVjdCBpcnFf
aW5mbywKKwkJCQkJCWVvaV9saXN0KTsKKworCQlpZiAoaW5mbyA9PSBOVUxM
IHx8IG5vdyA8IGluZm8tPmVvaV90aW1lKSB7CisJCQlzcGluX3VubG9jaygm
ZW9pLT5lb2lfbGlzdF9sb2NrKTsKKwkJCWJyZWFrOworCQl9CisKKwkJbGlz
dF9kZWxfaW5pdCgmaW5mby0+ZW9pX2xpc3QpOworCisJCXNwaW5fdW5sb2Nr
KCZlb2ktPmVvaV9saXN0X2xvY2spOworCisJCWluZm8tPmVvaV90aW1lID0g
MDsKKworCQl4ZW5faXJxX2xhdGVlb2lfbG9ja2VkKGluZm8pOworCX0KKwor
CWlmIChpbmZvKQorCQltb2RfZGVsYXllZF93b3JrX29uKGluZm8tPmVvaV9j
cHUsIHN5c3RlbV93cSwKKwkJCQkgICAgJmVvaS0+ZGVsYXllZCwgaW5mby0+
ZW9pX3RpbWUgLSBub3cpOworCisJcmVhZF91bmxvY2tfaXJxcmVzdG9yZSgm
ZXZ0Y2huX3J3bG9jaywgZmxhZ3MpOworfQorCitzdGF0aWMgdm9pZCB4ZW5f
Y3B1X2luaXRfZW9pKHVuc2lnbmVkIGludCBjcHUpCit7CisJc3RydWN0IGxh
dGVlb2lfd29yayAqZW9pID0gJnBlcl9jcHUobGF0ZWVvaSwgY3B1KTsKKwor
CUlOSVRfREVMQVlFRF9XT1JLKCZlb2ktPmRlbGF5ZWQsIHhlbl9pcnFfbGF0
ZWVvaV93b3JrZXIpOworCXNwaW5fbG9ja19pbml0KCZlb2ktPmVvaV9saXN0
X2xvY2spOworCUlOSVRfTElTVF9IRUFEKCZlb2ktPmVvaV9saXN0KTsKK30K
Kwogdm9pZCB4ZW5faXJxX2xhdGVlb2kodW5zaWduZWQgaW50IGlycSwgdW5z
aWduZWQgaW50IGVvaV9mbGFncykKIHsKIAlzdHJ1Y3QgaXJxX2luZm8gKmlu
Zm87CkBAIC00MjksNiArNTQ2LDcgQEAgRVhQT1JUX1NZTUJPTF9HUEwoeGVu
X2lycV9sYXRlZW9pKTsKIHN0YXRpYyB2b2lkIHhlbl9pcnFfaW5pdCh1bnNp
Z25lZCBpcnEpCiB7CiAJc3RydWN0IGlycV9pbmZvICppbmZvOworCiAjaWZk
ZWYgQ09ORklHX1NNUAogCS8qIEJ5IGRlZmF1bHQgYWxsIGV2ZW50IGNoYW5u
ZWxzIG5vdGlmeSBDUFUjMC4gKi8KIAljcHVtYXNrX2NvcHkoaXJxX2dldF9h
ZmZpbml0eV9tYXNrKGlycSksIGNwdW1hc2tfb2YoMCkpOwpAQCAtNDQzLDYg
KzU2MSw3IEBAIHN0YXRpYyB2b2lkIHhlbl9pcnFfaW5pdCh1bnNpZ25lZCBp
cnEpCiAKIAlzZXRfaW5mb19mb3JfaXJxKGlycSwgaW5mbyk7CiAKKwlJTklU
X0xJU1RfSEVBRCgmaW5mby0+ZW9pX2xpc3QpOwogCWxpc3RfYWRkX3RhaWwo
JmluZm8tPmxpc3QsICZ4ZW5faXJxX2xpc3RfaGVhZCk7CiB9CiAKQEAgLTQ5
OCw2ICs2MTcsOSBAQCBzdGF0aWMgdm9pZCB4ZW5fZnJlZV9pcnEodW5zaWdu
ZWQgaXJxKQogCiAJd3JpdGVfbG9ja19pcnFzYXZlKCZldnRjaG5fcndsb2Nr
LCBmbGFncyk7CiAKKwlpZiAoIWxpc3RfZW1wdHkoJmluZm8tPmVvaV9saXN0
KSkKKwkJbGF0ZWVvaV9saXN0X2RlbChpbmZvKTsKKwogCWxpc3RfZGVsKCZp
bmZvLT5saXN0KTsKIAogCXNldF9pbmZvX2Zvcl9pcnEoaXJxLCBOVUxMKTsK
QEAgLTEzNTgsMTcgKzE0ODAsNjYgQEAgdm9pZCB4ZW5fc2VuZF9JUElfb25l
KHVuc2lnbmVkIGludCBjcHUsIGVudW0gaXBpX3ZlY3RvciB2ZWN0b3IpCiAJ
bm90aWZ5X3JlbW90ZV92aWFfaXJxKGlycSk7CiB9CiAKK3N0cnVjdCBldnRj
aG5fbG9vcF9jdHJsIHsKKwlrdGltZV90IHRpbWVvdXQ7CisJdW5zaWduZWQg
Y291bnQ7CisJYm9vbCBkZWZlcl9lb2k7Cit9OworCit2b2lkIGhhbmRsZV9p
cnFfZm9yX3BvcnQoZXZ0Y2huX3BvcnRfdCBwb3J0LCBzdHJ1Y3QgZXZ0Y2hu
X2xvb3BfY3RybCAqY3RybCkKK3sKKwlpbnQgaXJxOworCXN0cnVjdCBpcnFf
aW5mbyAqaW5mbzsKKworCWlycSA9IGdldF9ldnRjaG5fdG9faXJxKHBvcnQp
OworCWlmIChpcnEgPT0gLTEpCisJCXJldHVybjsKKworCS8qCisJICogQ2hl
Y2sgZm9yIHRpbWVvdXQgZXZlcnkgMjU2IGV2ZW50cy4KKwkgKiBXZSBhcmUg
c2V0dGluZyB0aGUgdGltZW91dCB2YWx1ZSBvbmx5IGFmdGVyIHRoZSBmaXJz
dCAyNTYKKwkgKiBldmVudHMgaW4gb3JkZXIgdG8gbm90IGh1cnQgdGhlIGNv
bW1vbiBjYXNlIG9mIGZldyBsb29wCisJICogaXRlcmF0aW9ucy4gVGhlIDI1
NiBpcyBiYXNpY2FsbHkgYW4gYXJiaXRyYXJ5IHZhbHVlLgorCSAqCisJICog
SW4gY2FzZSB3ZSBhcmUgaGl0dGluZyB0aGUgdGltZW91dCB3ZSBuZWVkIHRv
IGRlZmVyIGFsbCBmdXJ0aGVyCisJICogRU9JcyBpbiBvcmRlciB0byBlbnN1
cmUgdG8gbGVhdmUgdGhlIGV2ZW50IGhhbmRsaW5nIGxvb3AgcmF0aGVyCisJ
ICogc29vbmVyIHRoYW4gbGF0ZXIuCisJICovCisJaWYgKCFjdHJsLT5kZWZl
cl9lb2kgJiYgISgrK2N0cmwtPmNvdW50ICYgMHhmZikpIHsKKwkJa3RpbWVf
dCBrdCA9IGt0aW1lX2dldCgpOworCisJCWlmICghY3RybC0+dGltZW91dCkg
eworCQkJa3QgPSBrdGltZV9hZGRfbXMoa3QsCisJCQkJCSAgamlmZmllc190
b19tc2VjcyhldmVudF9sb29wX3RpbWVvdXQpKTsKKwkJCWN0cmwtPnRpbWVv
dXQgPSBrdDsKKwkJfSBlbHNlIGlmIChrdCA+IGN0cmwtPnRpbWVvdXQpIHsK
KwkJCWN0cmwtPmRlZmVyX2VvaSA9IHRydWU7CisJCX0KKwl9CisKKwlpbmZv
ID0gaW5mb19mb3JfaXJxKGlycSk7CisKKwlpZiAoY3RybC0+ZGVmZXJfZW9p
KSB7CisJCWluZm8tPmVvaV9jcHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7CisJ
CWluZm8tPmlycV9lcG9jaCA9IF9fdGhpc19jcHVfcmVhZChpcnFfZXBvY2gp
OworCQlpbmZvLT5lb2lfdGltZSA9IGdldF9qaWZmaWVzXzY0KCkgKyBldmVu
dF9lb2lfZGVsYXk7CisJfQorCisJZ2VuZXJpY19oYW5kbGVfaXJxKGlycSk7
Cit9CisKIHN0YXRpYyB2b2lkIF9feGVuX2V2dGNobl9kb191cGNhbGwodm9p
ZCkKIHsKIAlzdHJ1Y3QgdmNwdV9pbmZvICp2Y3B1X2luZm8gPSBfX3RoaXNf
Y3B1X3JlYWQoeGVuX3ZjcHUpOwogCWludCBjcHUgPSBzbXBfcHJvY2Vzc29y
X2lkKCk7CisJc3RydWN0IGV2dGNobl9sb29wX2N0cmwgY3RybCA9IHsgMCB9
OwogCiAJcmVhZF9sb2NrKCZldnRjaG5fcndsb2NrKTsKIAogCWRvIHsKIAkJ
dmNwdV9pbmZvLT5ldnRjaG5fdXBjYWxsX3BlbmRpbmcgPSAwOwogCi0JCXhl
bl9ldnRjaG5faGFuZGxlX2V2ZW50cyhjcHUpOworCQl4ZW5fZXZ0Y2huX2hh
bmRsZV9ldmVudHMoY3B1LCAmY3RybCk7CiAKIAkJQlVHX09OKCFpcnFzX2Rp
c2FibGVkKCkpOwogCkBAIC0xMzc3LDYgKzE1NDgsMTMgQEAgc3RhdGljIHZv
aWQgX194ZW5fZXZ0Y2huX2RvX3VwY2FsbCh2b2lkKQogCX0gd2hpbGUgKHZj
cHVfaW5mby0+ZXZ0Y2huX3VwY2FsbF9wZW5kaW5nKTsKIAogCXJlYWRfdW5s
b2NrKCZldnRjaG5fcndsb2NrKTsKKworCS8qCisJICogSW5jcmVtZW50IGly
cV9lcG9jaCBvbmx5IG5vdyB0byBkZWZlciBFT0lzIG9ubHkgZm9yCisJICog
eGVuX2lycV9sYXRlZW9pKCkgaW52b2NhdGlvbnMgb2NjdXJyaW5nIGZyb20g
aW5zaWRlIHRoZSBsb29wCisJICogYWJvdmUuCisJICovCisJX190aGlzX2Nw
dV9pbmMoaXJxX2Vwb2NoKTsKIH0KIAogdm9pZCB4ZW5fZXZ0Y2huX2RvX3Vw
Y2FsbChzdHJ1Y3QgcHRfcmVncyAqcmVncykKQEAgLTE4MjUsOSArMjAwMyw2
IEBAIHZvaWQgeGVuX3NldHVwX2NhbGxiYWNrX3ZlY3Rvcih2b2lkKSB7fQog
c3RhdGljIGlubGluZSB2b2lkIHhlbl9hbGxvY19jYWxsYmFja192ZWN0b3Io
dm9pZCkge30KICNlbmRpZgogCi0jdW5kZWYgTU9EVUxFX1BBUkFNX1BSRUZJ
WAotI2RlZmluZSBNT0RVTEVfUEFSQU1fUFJFRklYICJ4ZW4uIgotCiBzdGF0
aWMgYm9vbCBmaWZvX2V2ZW50cyA9IHRydWU7CiBtb2R1bGVfcGFyYW0oZmlm
b19ldmVudHMsIGJvb2wsIDApOwogCkBAIC0xODM1LDYgKzIwMTAsOCBAQCBz
dGF0aWMgaW50IHhlbl9ldnRjaG5fY3B1X3ByZXBhcmUodW5zaWduZWQgaW50
IGNwdSkKIHsKIAlpbnQgcmV0ID0gMDsKIAorCXhlbl9jcHVfaW5pdF9lb2ko
Y3B1KTsKKwogCWlmIChldnRjaG5fb3BzLT5wZXJjcHVfaW5pdCkKIAkJcmV0
ID0gZXZ0Y2huX29wcy0+cGVyY3B1X2luaXQoY3B1KTsKIApAQCAtMTg2MSw2
ICsyMDM4LDggQEAgdm9pZCBfX2luaXQgeGVuX2luaXRfSVJRKHZvaWQpCiAJ
aWYgKHJldCA8IDApCiAJCXhlbl9ldnRjaG5fMmxfaW5pdCgpOwogCisJeGVu
X2NwdV9pbml0X2VvaShzbXBfcHJvY2Vzc29yX2lkKCkpOworCiAJY3B1aHBf
c2V0dXBfc3RhdGVfbm9jYWxscyhDUFVIUF9YRU5fRVZUQ0hOX1BSRVBBUkUs
CiAJCQkJICAieGVuL2V2dGNobjpwcmVwYXJlIiwKIAkJCQkgIHhlbl9ldnRj
aG5fY3B1X3ByZXBhcmUsIHhlbl9ldnRjaG5fY3B1X2RlYWQpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19maWZvLmMgYi9kcml2
ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2ZpZm8uYwppbmRleCA0MGU0Y2ExNjg1
YWEuLjYwODVhODA4ZGE5NSAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4vZXZl
bnRzL2V2ZW50c19maWZvLmMKKysrIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2
ZW50c19maWZvLmMKQEAgLTI3NSwxOSArMjc1LDkgQEAgc3RhdGljIHVpbnQz
Ml90IGNsZWFyX2xpbmtlZCh2b2xhdGlsZSBldmVudF93b3JkX3QgKndvcmQp
CiAJcmV0dXJuIHcgJiBFVlRDSE5fRklGT19MSU5LX01BU0s7CiB9CiAKLXN0
YXRpYyB2b2lkIGhhbmRsZV9pcnFfZm9yX3BvcnQoZXZ0Y2huX3BvcnRfdCBw
b3J0KQotewotCWludCBpcnE7Ci0KLQlpcnEgPSBnZXRfZXZ0Y2huX3RvX2ly
cShwb3J0KTsKLQlpZiAoaXJxICE9IC0xKQotCQlnZW5lcmljX2hhbmRsZV9p
cnEoaXJxKTsKLX0KLQotc3RhdGljIHZvaWQgY29uc3VtZV9vbmVfZXZlbnQo
dW5zaWduZWQgY3B1LAorc3RhdGljIHZvaWQgY29uc3VtZV9vbmVfZXZlbnQo
dW5zaWduZWQgY3B1LCBzdHJ1Y3QgZXZ0Y2huX2xvb3BfY3RybCAqY3RybCwK
IAkJCSAgICAgIHN0cnVjdCBldnRjaG5fZmlmb19jb250cm9sX2Jsb2NrICpj
b250cm9sX2Jsb2NrLAotCQkJICAgICAgdW5zaWduZWQgcHJpb3JpdHksIHVu
c2lnbmVkIGxvbmcgKnJlYWR5LAotCQkJICAgICAgYm9vbCBkcm9wKQorCQkJ
ICAgICAgdW5zaWduZWQgcHJpb3JpdHksIHVuc2lnbmVkIGxvbmcgKnJlYWR5
KQogewogCXN0cnVjdCBldnRjaG5fZmlmb19xdWV1ZSAqcSA9ICZwZXJfY3B1
KGNwdV9xdWV1ZSwgY3B1KTsKIAl1aW50MzJfdCBoZWFkOwpAQCAtMzIwLDE2
ICszMTAsMTcgQEAgc3RhdGljIHZvaWQgY29uc3VtZV9vbmVfZXZlbnQodW5z
aWduZWQgY3B1LAogCQljbGVhcl9iaXQocHJpb3JpdHksIHJlYWR5KTsKIAog
CWlmIChldnRjaG5fZmlmb19pc19wZW5kaW5nKHBvcnQpICYmICFldnRjaG5f
Zmlmb19pc19tYXNrZWQocG9ydCkpIHsKLQkJaWYgKHVubGlrZWx5KGRyb3Ap
KQorCQlpZiAodW5saWtlbHkoIWN0cmwpKQogCQkJcHJfd2FybigiRHJvcHBp
bmcgcGVuZGluZyBldmVudCBmb3IgcG9ydCAldVxuIiwgcG9ydCk7CiAJCWVs
c2UKLQkJCWhhbmRsZV9pcnFfZm9yX3BvcnQocG9ydCk7CisJCQloYW5kbGVf
aXJxX2Zvcl9wb3J0KHBvcnQsIGN0cmwpOwogCX0KIAogCXEtPmhlYWRbcHJp
b3JpdHldID0gaGVhZDsKIH0KIAotc3RhdGljIHZvaWQgX19ldnRjaG5fZmlm
b19oYW5kbGVfZXZlbnRzKHVuc2lnbmVkIGNwdSwgYm9vbCBkcm9wKQorc3Rh
dGljIHZvaWQgX19ldnRjaG5fZmlmb19oYW5kbGVfZXZlbnRzKHVuc2lnbmVk
IGNwdSwKKwkJCQkJc3RydWN0IGV2dGNobl9sb29wX2N0cmwgKmN0cmwpCiB7
CiAJc3RydWN0IGV2dGNobl9maWZvX2NvbnRyb2xfYmxvY2sgKmNvbnRyb2xf
YmxvY2s7CiAJdW5zaWduZWQgbG9uZyByZWFkeTsKQEAgLTM0MSwxNCArMzMy
LDE1IEBAIHN0YXRpYyB2b2lkIF9fZXZ0Y2huX2ZpZm9faGFuZGxlX2V2ZW50
cyh1bnNpZ25lZCBjcHUsIGJvb2wgZHJvcCkKIAogCXdoaWxlIChyZWFkeSkg
ewogCQlxID0gZmluZF9maXJzdF9iaXQoJnJlYWR5LCBFVlRDSE5fRklGT19N
QVhfUVVFVUVTKTsKLQkJY29uc3VtZV9vbmVfZXZlbnQoY3B1LCBjb250cm9s
X2Jsb2NrLCBxLCAmcmVhZHksIGRyb3ApOworCQljb25zdW1lX29uZV9ldmVu
dChjcHUsIGN0cmwsIGNvbnRyb2xfYmxvY2ssIHEsICZyZWFkeSk7CiAJCXJl
YWR5IHw9IHhjaGcoJmNvbnRyb2xfYmxvY2stPnJlYWR5LCAwKTsKIAl9CiB9
CiAKLXN0YXRpYyB2b2lkIGV2dGNobl9maWZvX2hhbmRsZV9ldmVudHModW5z
aWduZWQgY3B1KQorc3RhdGljIHZvaWQgZXZ0Y2huX2ZpZm9faGFuZGxlX2V2
ZW50cyh1bnNpZ25lZCBjcHUsCisJCQkJICAgICAgc3RydWN0IGV2dGNobl9s
b29wX2N0cmwgKmN0cmwpCiB7Ci0JX19ldnRjaG5fZmlmb19oYW5kbGVfZXZl
bnRzKGNwdSwgZmFsc2UpOworCV9fZXZ0Y2huX2ZpZm9faGFuZGxlX2V2ZW50
cyhjcHUsIGN0cmwpOwogfQogCiBzdGF0aWMgdm9pZCBldnRjaG5fZmlmb19y
ZXN1bWUodm9pZCkKQEAgLTQxNiw3ICs0MDgsNyBAQCBzdGF0aWMgaW50IGV2
dGNobl9maWZvX3BlcmNwdV9pbml0KHVuc2lnbmVkIGludCBjcHUpCiAKIHN0
YXRpYyBpbnQgZXZ0Y2huX2ZpZm9fcGVyY3B1X2RlaW5pdCh1bnNpZ25lZCBp
bnQgY3B1KQogewotCV9fZXZ0Y2huX2ZpZm9faGFuZGxlX2V2ZW50cyhjcHUs
IHRydWUpOworCV9fZXZ0Y2huX2ZpZm9faGFuZGxlX2V2ZW50cyhjcHUsIE5V
TEwpOwogCXJldHVybiAwOwogfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL3hl
bi9ldmVudHMvZXZlbnRzX2ludGVybmFsLmggYi9kcml2ZXJzL3hlbi9ldmVu
dHMvZXZlbnRzX2ludGVybmFsLmgKaW5kZXggNTU4YWJlYTE5ZDBkLi5hYWMw
NWNmNTJjZWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVu
dHNfaW50ZXJuYWwuaAorKysgYi9kcml2ZXJzL3hlbi9ldmVudHMvZXZlbnRz
X2ludGVybmFsLmgKQEAgLTMwLDExICszMCwxNSBAQCBlbnVtIHhlbl9pcnFf
dHlwZSB7CiAgKi8KIHN0cnVjdCBpcnFfaW5mbyB7CiAJc3RydWN0IGxpc3Rf
aGVhZCBsaXN0OworCXN0cnVjdCBsaXN0X2hlYWQgZW9pX2xpc3Q7CiAJaW50
IHJlZmNudDsKIAllbnVtIHhlbl9pcnFfdHlwZSB0eXBlOwkvKiB0eXBlICov
CiAJdW5zaWduZWQgaXJxOwogCWV2dGNobl9wb3J0X3QgZXZ0Y2huOwkvKiBl
dmVudCBjaGFubmVsICovCiAJdW5zaWduZWQgc2hvcnQgY3B1OwkvKiBjcHUg
Ym91bmQgKi8KKwl1bnNpZ25lZCBzaG9ydCBlb2lfY3B1OwkvKiBFT0kgbXVz
dCBoYXBwZW4gb24gdGhpcyBjcHUgKi8KKwl1bnNpZ25lZCBpbnQgaXJxX2Vw
b2NoOwkvKiBJZiBlb2lfY3B1IHZhbGlkOiBpcnFfZXBvY2ggb2YgZXZlbnQg
Ki8KKwl1NjQgZW9pX3RpbWU7CQkvKiBUaW1lIGluIGppZmZpZXMgd2hlbiB0
byBFT0kuICovCiAKIAl1bmlvbiB7CiAJCXVuc2lnbmVkIHNob3J0IHZpcnE7
CkBAIC01Myw2ICs1Nyw4IEBAIHN0cnVjdCBpcnFfaW5mbyB7CiAjZGVmaW5l
IFBJUlFfU0hBUkVBQkxFCSgxIDw8IDEpCiAjZGVmaW5lIFBJUlFfTVNJX0dS
T1VQCSgxIDw8IDIpCiAKK3N0cnVjdCBldnRjaG5fbG9vcF9jdHJsOworCiBz
dHJ1Y3QgZXZ0Y2huX29wcyB7CiAJdW5zaWduZWQgKCptYXhfY2hhbm5lbHMp
KHZvaWQpOwogCXVuc2lnbmVkICgqbnJfY2hhbm5lbHMpKHZvaWQpOwpAQCAt
NjcsNyArNzMsNyBAQCBzdHJ1Y3QgZXZ0Y2huX29wcyB7CiAJdm9pZCAoKm1h
c2spKGV2dGNobl9wb3J0X3QgcG9ydCk7CiAJdm9pZCAoKnVubWFzaykoZXZ0
Y2huX3BvcnRfdCBwb3J0KTsKIAotCXZvaWQgKCpoYW5kbGVfZXZlbnRzKSh1
bnNpZ25lZCBjcHUpOworCXZvaWQgKCpoYW5kbGVfZXZlbnRzKSh1bnNpZ25l
ZCBjcHUsIHN0cnVjdCBldnRjaG5fbG9vcF9jdHJsICpjdHJsKTsKIAl2b2lk
ICgqcmVzdW1lKSh2b2lkKTsKIAogCWludCAoKnBlcmNwdV9pbml0KSh1bnNp
Z25lZCBpbnQgY3B1KTsKQEAgLTc4LDYgKzg0LDcgQEAgZXh0ZXJuIGNvbnN0
IHN0cnVjdCBldnRjaG5fb3BzICpldnRjaG5fb3BzOwogCiBleHRlcm4gaW50
ICoqZXZ0Y2huX3RvX2lycTsKIGludCBnZXRfZXZ0Y2huX3RvX2lycShldnRj
aG5fcG9ydF90IGV2dGNobik7Cit2b2lkIGhhbmRsZV9pcnFfZm9yX3BvcnQo
ZXZ0Y2huX3BvcnRfdCBwb3J0LCBzdHJ1Y3QgZXZ0Y2huX2xvb3BfY3RybCAq
Y3RybCk7CiAKIHN0cnVjdCBpcnFfaW5mbyAqaW5mb19mb3JfaXJxKHVuc2ln
bmVkIGlycSk7CiB1bnNpZ25lZCBjcHVfZnJvbV9pcnEodW5zaWduZWQgaXJx
KTsKQEAgLTEzNSw5ICsxNDIsMTAgQEAgc3RhdGljIGlubGluZSB2b2lkIHVu
bWFza19ldnRjaG4oZXZ0Y2huX3BvcnRfdCBwb3J0KQogCXJldHVybiBldnRj
aG5fb3BzLT51bm1hc2socG9ydCk7CiB9CiAKLXN0YXRpYyBpbmxpbmUgdm9p
ZCB4ZW5fZXZ0Y2huX2hhbmRsZV9ldmVudHModW5zaWduZWQgY3B1KQorc3Rh
dGljIGlubGluZSB2b2lkIHhlbl9ldnRjaG5faGFuZGxlX2V2ZW50cyh1bnNp
Z25lZCBjcHUsCisJCQkJCSAgICBzdHJ1Y3QgZXZ0Y2huX2xvb3BfY3RybCAq
Y3RybCkKIHsKLQlyZXR1cm4gZXZ0Y2huX29wcy0+aGFuZGxlX2V2ZW50cyhj
cHUpOworCXJldHVybiBldnRjaG5fb3BzLT5oYW5kbGVfZXZlbnRzKGNwdSwg
Y3RybCk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCB4ZW5fZXZ0Y2huX3Jl
c3VtZSh2b2lkKQotLSAKMi4yNi4yCgo=

--=separator
Content-Type: application/octet-stream; name="xsa332-linux-12.patch"
Content-Disposition: attachment; filename="xsa332-linux-12.patch"
Content-Transfer-Encoding: base64

RnJvbSAxNjVlZGNkZWYzYTdiYjE4ZjlmZmRlM2NkN2E2YTJiMjQ2NTYyYmQ2
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IE1vbiwgMTQgU2VwIDIwMjAgMTQ6
MDE6MDIgKzAyMDAKU3ViamVjdDogW1BBVENIIDEyLzEyXSB4ZW4vZXZlbnRz
OiBibG9jayByb2d1ZSBldmVudHMgZm9yIHNvbWUgdGltZQoKSW4gb3JkZXIg
dG8gYXZvaWQgaGlnaCBkb20wIGxvYWQgZHVlIHRvIHJvZ3VlIGd1ZXN0cyBz
ZW5kaW5nIGV2ZW50cyBhdApoaWdoIGZyZXF1ZW5jeSwgYmxvY2sgdGhvc2Ug
ZXZlbnRzIGluIGNhc2UgdGhlcmUgd2FzIG5vIGFjdGlvbiBuZWVkZWQKaW4g
ZG9tMCB0byBoYW5kbGUgdGhlIGV2ZW50cy4KClRoaXMgaXMgZG9uZSBieSBh
ZGRpbmcgYSBwZXItZXZlbnQgY291bnRlciwgd2hpY2ggc2V0IHRvIHplcm8g
aW4gY2FzZQphbiBFT0kgd2l0aG91dCB0aGUgWEVOX0VPSV9GTEFHX1NQVVJJ
T1VTIGlzIHJlY2VpdmVkIGZyb20gYSBiYWNrZW5kCmRyaXZlciwgYW5kIGlu
Y3JlbWVudGVkIHdoZW4gdGhpcyBmbGFnIGhhcyBiZWVuIHNldC4gSW4gY2Fz
ZSB0aGUKY291bnRlciBpcyAyIG9yIGhpZ2hlciBkZWxheSB0aGUgRU9JIGJ5
IDEgPDwgKGNudCAtIDIpIGppZmZpZXMsIGJ1dApub3QgbW9yZSB0aGFuIDEg
c2Vjb25kLgoKSW4gb3JkZXIgbm90IHRvIHdhc3RlIG1lbW9yeSBzaG9ydGVu
IHRoZSBwZXItZXZlbnQgcmVmY250IHRvIHR3byBieXRlcwooaXQgc2hvdWxk
IG5vcm1hbGx5IG5ldmVyIGV4Y2VlZCBhIHZhbHVlIG9mIDIpLiBBZGQgYW4g
b3ZlcmZsb3cgY2hlY2sKdG8gZXZ0Y2huX2dldCgpIHRvIG1ha2Ugc3VyZSB0
aGUgMiBieXRlcyByZWFsbHkgd29uJ3Qgb3ZlcmZsb3cuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMzMi4KCkNjOiBzdGFibGVAdmdlci5rZXJuZWwub3JnClJl
cG9ydGVkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1bGllbkB4ZW4ub3JnPgpTaWdu
ZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+ClJl
dmlld2VkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJl
dmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtl
cm5lbC5vcmc+ClJldmlld2VkLWJ5OiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgot
LS0KIGRyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfYmFzZS5jICAgICB8IDI3
ICsrKysrKysrKysrKysrKysrKysrKystLS0tLQogZHJpdmVycy94ZW4vZXZl
bnRzL2V2ZW50c19pbnRlcm5hbC5oIHwgIDMgKystCiAyIGZpbGVzIGNoYW5n
ZWQsIDI0IGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0pCgpkaWZmIC0t
Z2l0IGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19iYXNlLmMgYi9kcml2
ZXJzL3hlbi9ldmVudHMvZXZlbnRzX2Jhc2UuYwppbmRleCBjZGUwOTZhNmYx
MWQuLmNjMzE3NzM5ZTc4NiAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4vZXZl
bnRzL2V2ZW50c19iYXNlLmMKKysrIGIvZHJpdmVycy94ZW4vZXZlbnRzL2V2
ZW50c19iYXNlLmMKQEAgLTQ2MSwxNyArNDYxLDM0IEBAIHN0YXRpYyB2b2lk
IGxhdGVlb2lfbGlzdF9hZGQoc3RydWN0IGlycV9pbmZvICppbmZvKQogCXNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmVvaS0+ZW9pX2xpc3RfbG9jaywgZmxh
Z3MpOwogfQogCi1zdGF0aWMgdm9pZCB4ZW5faXJxX2xhdGVlb2lfbG9ja2Vk
KHN0cnVjdCBpcnFfaW5mbyAqaW5mbykKK3N0YXRpYyB2b2lkIHhlbl9pcnFf
bGF0ZWVvaV9sb2NrZWQoc3RydWN0IGlycV9pbmZvICppbmZvLCBib29sIHNw
dXJpb3VzKQogewogCWV2dGNobl9wb3J0X3QgZXZ0Y2huOwogCXVuc2lnbmVk
IGludCBjcHU7CisJdW5zaWduZWQgaW50IGRlbGF5ID0gMDsKIAogCWV2dGNo
biA9IGluZm8tPmV2dGNobjsKIAlpZiAoIVZBTElEX0VWVENITihldnRjaG4p
IHx8ICFsaXN0X2VtcHR5KCZpbmZvLT5lb2lfbGlzdCkpCiAJCXJldHVybjsK
IAorCWlmIChzcHVyaW91cykgeworCQlpZiAoKDEgPDwgaW5mby0+c3B1cmlv
dXNfY250KSA8IChIWiA8PCAyKSkKKwkJCWluZm8tPnNwdXJpb3VzX2NudCsr
OworCQlpZiAoaW5mby0+c3B1cmlvdXNfY250ID4gMSkgeworCQkJZGVsYXkg
PSAxIDw8IChpbmZvLT5zcHVyaW91c19jbnQgLSAyKTsKKwkJCWlmIChkZWxh
eSA+IEhaKQorCQkJCWRlbGF5ID0gSFo7CisJCQlpZiAoIWluZm8tPmVvaV90
aW1lKQorCQkJCWluZm8tPmVvaV9jcHUgPSBzbXBfcHJvY2Vzc29yX2lkKCk7
CisJCQlpbmZvLT5lb2lfdGltZSA9IGdldF9qaWZmaWVzXzY0KCkgKyBkZWxh
eTsKKwkJfQorCX0gZWxzZSB7CisJCWluZm8tPnNwdXJpb3VzX2NudCA9IDA7
CisJfQorCiAJY3B1ID0gaW5mby0+ZW9pX2NwdTsKLQlpZiAoaW5mby0+ZW9p
X3RpbWUgJiYgaW5mby0+aXJxX2Vwb2NoID09IHBlcl9jcHUoaXJxX2Vwb2No
LCBjcHUpKSB7CisJaWYgKGluZm8tPmVvaV90aW1lICYmCisJICAgIChpbmZv
LT5pcnFfZXBvY2ggPT0gcGVyX2NwdShpcnFfZXBvY2gsIGNwdSkgfHwgZGVs
YXkpKSB7CiAJCWxhdGVlb2lfbGlzdF9hZGQoaW5mbyk7CiAJCXJldHVybjsK
IAl9CkBAIC01MDgsNyArNTI1LDcgQEAgc3RhdGljIHZvaWQgeGVuX2lycV9s
YXRlZW9pX3dvcmtlcihzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAKIAkJ
aW5mby0+ZW9pX3RpbWUgPSAwOwogCi0JCXhlbl9pcnFfbGF0ZWVvaV9sb2Nr
ZWQoaW5mbyk7CisJCXhlbl9pcnFfbGF0ZWVvaV9sb2NrZWQoaW5mbywgZmFs
c2UpOwogCX0KIAogCWlmIChpbmZvKQpAQCAtNTM3LDcgKzU1NCw3IEBAIHZv
aWQgeGVuX2lycV9sYXRlZW9pKHVuc2lnbmVkIGludCBpcnEsIHVuc2lnbmVk
IGludCBlb2lfZmxhZ3MpCiAJaW5mbyA9IGluZm9fZm9yX2lycShpcnEpOwog
CiAJaWYgKGluZm8pCi0JCXhlbl9pcnFfbGF0ZWVvaV9sb2NrZWQoaW5mbyk7
CisJCXhlbl9pcnFfbGF0ZWVvaV9sb2NrZWQoaW5mbywgZW9pX2ZsYWdzICYg
WEVOX0VPSV9GTEFHX1NQVVJJT1VTKTsKIAogCXJlYWRfdW5sb2NrX2lycXJl
c3RvcmUoJmV2dGNobl9yd2xvY2ssIGZsYWdzKTsKIH0KQEAgLTE0NDEsNyAr
MTQ1OCw3IEBAIGludCBldnRjaG5fZ2V0KGV2dGNobl9wb3J0X3QgZXZ0Y2hu
KQogCQlnb3RvIGRvbmU7CiAKIAllcnIgPSAtRUlOVkFMOwotCWlmIChpbmZv
LT5yZWZjbnQgPD0gMCkKKwlpZiAoaW5mby0+cmVmY250IDw9IDAgfHwgaW5m
by0+cmVmY250ID09IFNIUlRfTUFYKQogCQlnb3RvIGRvbmU7CiAKIAlpbmZv
LT5yZWZjbnQrKzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMveGVuL2V2ZW50cy9l
dmVudHNfaW50ZXJuYWwuaCBiL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNf
aW50ZXJuYWwuaAppbmRleCBhYWMwNWNmNTJjZWQuLjgyOTM3ZDkwZDdkNyAx
MDA2NDQKLS0tIGEvZHJpdmVycy94ZW4vZXZlbnRzL2V2ZW50c19pbnRlcm5h
bC5oCisrKyBiL2RyaXZlcnMveGVuL2V2ZW50cy9ldmVudHNfaW50ZXJuYWwu
aApAQCAtMzEsNyArMzEsOCBAQCBlbnVtIHhlbl9pcnFfdHlwZSB7CiBzdHJ1
Y3QgaXJxX2luZm8gewogCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKIAlzdHJ1
Y3QgbGlzdF9oZWFkIGVvaV9saXN0OwotCWludCByZWZjbnQ7CisJc2hvcnQg
cmVmY250OworCXNob3J0IHNwdXJpb3VzX2NudDsKIAllbnVtIHhlbl9pcnFf
dHlwZSB0eXBlOwkvKiB0eXBlICovCiAJdW5zaWduZWQgaXJxOwogCWV2dGNo
bl9wb3J0X3QgZXZ0Y2huOwkvKiBldmVudCBjaGFubmVsICovCi0tIAoyLjI2
LjIKCg==

--=separator--


Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 742B19E318
	for <lists+xen-devel@lfdr.de>; Tue, 27 Aug 2019 10:49:24 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i2X8g-0003J1-Rn; Tue, 27 Aug 2019 08:47:42 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=tvsD=WX=amazon.de=prvs=1355b64ef=wipawel@srs-us1.protection.inumbo.net>)
 id 1i2X8e-0003GG-Mo
 for xen-devel@lists.xen.org; Tue, 27 Aug 2019 08:47:40 +0000
X-Inumbo-ID: 47424684-c8a7-11e9-ae2f-12813bfff9fa
Received: from smtp-fw-6001.amazon.com (unknown [52.95.48.154])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 47424684-c8a7-11e9-ae2f-12813bfff9fa;
 Tue, 27 Aug 2019 08:47:19 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1566895638; x=1598431638;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=aAPYumxmG4J6YGw7xA3Una0vefZLsU4Jd9GTY83ZKDI=;
 b=irWi7IYw+htNBT9LXUWwnk8FhVZc5Hh5EugTVsazWwfLSk+YOAjJOPq9
 BiiwmzLB3/B9IzhFu/LDvJMAl0Ma9EFkgSWKUudBOu0waCZaxltqDiovb
 DcXm1W/fdxabY/idaJVZXzXJtVB+CvQiE3zEAj4xthQylIG/GHD9IdJvd I=;
X-IronPort-AV: E=Sophos;i="5.64,436,1559520000"; d="scan'208";a="412028848"
Received: from iad6-co-svc-p1-lb1-vlan3.amazon.com (HELO
 email-inbound-relay-1a-807d4a99.us-east-1.amazon.com) ([10.124.125.6])
 by smtp-border-fw-out-6001.iad6.amazon.com with ESMTP;
 27 Aug 2019 08:47:18 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1a-807d4a99.us-east-1.amazon.com (Postfix) with ESMTPS
 id C9B01A1873; Tue, 27 Aug 2019 08:47:17 +0000 (UTC)
Received: from EX13D03EUC002.ant.amazon.com (10.43.164.60) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 27 Aug 2019 08:47:03 +0000
Received: from EX13MTAUEE001.ant.amazon.com (10.43.62.200) by
 EX13D03EUC002.ant.amazon.com (10.43.164.60) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 27 Aug 2019 08:47:02 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.62.226) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Tue, 27 Aug 2019 08:47:00 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>, <xen-devel@lists.xenproject.org>
Date: Tue, 27 Aug 2019 08:46:24 +0000
Message-ID: <20190827084624.116917-13-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190827084624.116917-1-wipawel@amazon.de>
References: <20190821081931.90887-1-wipawel@amazon.de>
 <20190827084624.116917-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v2 12/12] livepatch: Add python bindings for
 livepatch operations
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Wei Liu <wl@xen.org>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Pawel Wieczorkiewicz <wipawel@amazon.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RXh0ZW5kIHRoZSBYQyBweXRob24gYmluZGluZ3MgbGlicmFyeSB0byBzdXBwb3J0IGFsc28gYWxs
IGNvbW1vbgpsaXZlcGF0Y2ggb3BlcmF0aW9ucyBhbmQgYWN0aW9ucy4KCkFkZCB0aGUgcHl0aG9u
IGJpbmRpbmdzIGZvciB0aGUgZm9sbG93aW5nIG9wZXJhdGlvbnM6Ci0gc3RhdHVzIChweXhjX2xp
dmVwYXRjaF9zdGF0dXMpOgogIFJlcXVpcmVzIGEgcGF5bG9hZCBuYW1lIGFzIGFuIGlucHV0Lgog
IFJldHVybnMgYSBzdGF0dXMgZGljdCBjb250YWluaW5nIGEgc3RhdGUgc3RyaW5nIGFuZCBhIHJl
dHVybiBjb2RlCiAgaW50ZWdlci4KLSBhY3Rpb24gKHB5eGNfbGl2ZXBhdGNoX2FjdGlvbik6CiAg
UmVxdWlyZXMgYSBwYXlsb2FkIG5hbWUgYW5kIGFuIGFjdGlvbiBpZCBhcyBhbiBpbnB1dC4gVGlt
ZW91dCBhbmQKICBmbGFncyBhcmUgb3B0aW9uYWwgcGFyYW1ldGVycy4KICBSZXR1cm5zIGEgcmV0
dXJuIGNvZGUgaW50ZWdlci4KLSB1cGxvYWQgKHB5eGNfbGl2ZXBhdGNoX3VwbG9hZCk6CiAgUmVx
dWlyZXMgYSBwYXlsb2FkIG5hbWUgYW5kIGEgbW9kdWxlJ3MgZmlsZW5hbWUgYXMgYW4gaW5wdXQu
CiAgUmV0dXJucyBhIHJldHVybiBjb2RlIGludGVnZXIuCi0gbGlzdCAocHl4Y19saXZlcGF0Y2hf
bGlzdCk6CiAgVGFrZXMgbm8gcGFyYW1ldGVycy4KICBSZXR1cm5zIGEgbGlzdCBvZiBkaWN0cyBj
b250YWluaW5nIGVhY2ggcGF5bG9hZCdzOgogICogbmFtZSBhcyBhIHN0cmluZwogICogc3RhdGUg
YXMgYSBzdHJpbmcKICAqIHJldHVybiBjb2RlIGFzIGFuIGludGVnZXIKICAqIGxpc3Qgb2YgbWV0
YWRhdGEga2V5PXZhbHVlIHN0cmluZ3MKCkVhY2ggZnVuY3Rpb25zIHRocm93cyBhbiBleGNlcHRp
b24gZXJyb3IgYmFzZWQgb24gdGhlIGVycm5vIHZhbHVlCnJlY2VpdmVkIGZyb20gaXRzIGNvcnJl
c3BvbmRpbmcgbGlieGMgZnVuY3Rpb24gY2FsbC4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6
b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpvbi5kZT4KUmV2aWV3ZWQtYnk6IE1hcnRpbiBNYXplaW4g
PGFtYXplaW5AYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogQW5kcmEtSXJpbmEgUGFyYXNjaGl2IDxh
bmRyYXByc0BhbWF6b24uY29tPgpSZXZpZXdlZC1ieTogTGVvbmFyZCBGb2Vyc3RlciA8Zm9lcnNs
ZW9AYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTm9yYmVydCBNYW50aGV5IDxubWFudGhleUBhbWF6
b24uZGU+Ci0tLQpDaGFuZ2VkIHNpbmNlIHYxOgogICogY2hhbmdlZCBQeUxpc3RfQXBwZW5kKCkg
d2l0aCBQeUxpc3RfU2V0SXRlbSgpIGFzIHJlcXVlc3RlZCBieQogICAgTWFyZWsKCiB0b29scy9w
eXRob24veGVuL2xvd2xldmVsL3hjL3hjLmMgfCAyNzMgKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAyNzMgaW5zZXJ0aW9ucygrKQoKZGlmZiAt
LWdpdCBhL3Rvb2xzL3B5dGhvbi94ZW4vbG93bGV2ZWwveGMveGMuYyBiL3Rvb2xzL3B5dGhvbi94
ZW4vbG93bGV2ZWwveGMveGMuYwppbmRleCA3ZjAzNThiYTljLi5kNjRiOTM3MmI2IDEwMDY0NAot
LS0gYS90b29scy9weXRob24veGVuL2xvd2xldmVsL3hjL3hjLmMKKysrIGIvdG9vbHMvcHl0aG9u
L3hlbi9sb3dsZXZlbC94Yy94Yy5jCkBAIC0yMDExLDYgKzIwMTEsMjMwIEBAIHN0YXRpYyBQeU9i
amVjdCAqcHlmbGFza19hY2Nlc3MoUHlPYmplY3QgKnNlbGYsIFB5T2JqZWN0ICphcmdzLAogICAg
IHJldHVybiBQeV9CdWlsZFZhbHVlKCJpIixyZXQpOwogfQogCitzdGF0aWMgUHlPYmplY3QgKnB5
eGNfbGl2ZXBhdGNoX3N0YXR1cyhYY09iamVjdCAqc2VsZiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmt3ZHMpCit7CisgICAgeGVuX2xpdmVwYXRjaF9z
dGF0dXNfdCBzdGF0dXM7CisgICAgUHlPYmplY3QgKmluZm9fZGljdCA9IE5VTEw7CisgICAgY2hh
ciAqbmFtZTsKKyAgICBpbnQgcmM7CisKKyAgICBzdGF0aWMgY2hhciAqa3dkX2xpc3RbXSA9IHsg
Im5hbWUiLCBOVUxMIH07CisKKyAgICBpZiAoICFQeUFyZ19QYXJzZVR1cGxlQW5kS2V5d29yZHMo
YXJncywga3dkcywgInMiLCBrd2RfbGlzdCwgJm5hbWUpICkKKyAgICAgICAgZ290byBlcnJvcjsK
KworICAgIHJjID0geGNfbGl2ZXBhdGNoX2dldChzZWxmLT54Y19oYW5kbGUsIG5hbWUsICZzdGF0
dXMpOworICAgIGlmICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgaW5mb19kaWN0
ID0gUHlfQnVpbGRWYWx1ZSgKKyAgICAgICAgICAgICJ7czppLHM6aX0iLAorICAgICAgICAgICAg
InN0YXRlIiwgICAgc3RhdHVzLnN0YXRlLAorICAgICAgICAgICAgInJjIiwgICAgICAgc3RhdHVz
LnJjKTsKKworZXJyb3I6CisgICAgcmV0dXJuIGluZm9fZGljdCA/OiBweXhjX2Vycm9yX3RvX2V4
Y2VwdGlvbihzZWxmLT54Y19oYW5kbGUpOworfQorCitzdGF0aWMgUHlPYmplY3QgKnB5eGNfbGl2
ZXBhdGNoX2FjdGlvbihYY09iamVjdCAqc2VsZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgUHlPYmplY3QgKmt3ZHMpCit7CisgICAgaW50ICgqYWN0aW9uX2Z1bmMpKHhj
X2ludGVyZmFjZSAqeGNoLCBjaGFyICpuYW1lLCB1aW50MzJfdCB0aW1lb3V0LCB1aW50NjRfdCBm
bGFncyk7CisgICAgY2hhciAqbmFtZTsKKyAgICB1bnNpZ25lZCBpbnQgYWN0aW9uOworICAgIHVp
bnQzMl90IHRpbWVvdXQ7CisgICAgdWludDY0X3QgZmxhZ3M7CisgICAgaW50IHJjOworCisgICAg
c3RhdGljIGNoYXIgKmt3ZF9saXN0W10gPSB7ICJuYW1lIiwgImFjdGlvbiIsICJ0aW1lb3V0Iiwg
ImZsYWdzIiwgTlVMTCB9OworCisgICAgaWYgKCAhUHlBcmdfUGFyc2VUdXBsZUFuZEtleXdvcmRz
KGFyZ3MsIGt3ZHMsICJzSXxJayIsIGt3ZF9saXN0LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAmbmFtZSwgJmFjdGlvbiwgJnRpbWVvdXQsICZmbGFncykgKQorICAgICAg
ICBnb3RvIGVycm9yOworCisgICAgc3dpdGNoIChhY3Rpb24pCisgICAgeworICAgIGNhc2UgTElW
RVBBVENIX0FDVElPTl9VTkxPQUQ6CisgICAgICAgIGFjdGlvbl9mdW5jID0geGNfbGl2ZXBhdGNo
X3VubG9hZDsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBMSVZFUEFUQ0hfQUNUSU9OX1JFVkVS
VDoKKyAgICAgICAgYWN0aW9uX2Z1bmMgPSB4Y19saXZlcGF0Y2hfcmV2ZXJ0OworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIExJVkVQQVRDSF9BQ1RJT05fQVBQTFk6CisgICAgICAgIGFjdGlvbl9m
dW5jID0geGNfbGl2ZXBhdGNoX2FwcGx5OworICAgICAgICBicmVhazsKKyAgICBjYXNlIExJVkVQ
QVRDSF9BQ1RJT05fUkVQTEFDRToKKyAgICAgICAgYWN0aW9uX2Z1bmMgPSB4Y19saXZlcGF0Y2hf
cmVwbGFjZTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgZ290byBlcnJv
cjsKKyAgICB9CisKKyAgICByYyA9IGFjdGlvbl9mdW5jKHNlbGYtPnhjX2hhbmRsZSwgbmFtZSwg
dGltZW91dCwgZmxhZ3MpOworICAgIGlmICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOworCisg
ICAgcmV0dXJuIFB5X0J1aWxkVmFsdWUoImkiLCByYyk7CitlcnJvcjoKKyAgICByZXR1cm4gcHl4
Y19lcnJvcl90b19leGNlcHRpb24oc2VsZi0+eGNfaGFuZGxlKTsKK30KKworc3RhdGljIFB5T2Jq
ZWN0ICpweXhjX2xpdmVwYXRjaF91cGxvYWQoWGNPYmplY3QgKnNlbGYsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqYXJncywKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICprd2RzKQoreworICAgIHVuc2lnbmVk
IGNoYXIgKmZidWYgPSBNQVBfRkFJTEVEOworICAgIGNoYXIgKm5hbWUsICpmaWxlbmFtZTsKKyAg
ICBzdHJ1Y3Qgc3RhdCBidWY7CisgICAgaW50IGZkID0gMCwgcmM7CisgICAgc3NpemVfdCBsZW47
CisKKyAgICBzdGF0aWMgY2hhciAqa3dkX2xpc3RbXSA9IHsgIm5hbWUiLCAiZmlsZW5hbWUiLCBO
VUxMIH07CisKKyAgICBpZiAoICFQeUFyZ19QYXJzZVR1cGxlQW5kS2V5d29yZHMoYXJncywga3dk
cywgInNzIiwga3dkX2xpc3QsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZuYW1lLCAmZmlsZW5hbWUpKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgZmQgPSBvcGVu
KGZpbGVuYW1lLCBPX1JET05MWSk7CisgICAgaWYgKCBmZCA8IDAgKQorICAgICAgICBnb3RvIGVy
cm9yOworCisgICAgaWYgKCBzdGF0KGZpbGVuYW1lLCAmYnVmKSAhPSAwICkKKyAgICAgICAgZ290
byBlcnJvcjsKKworICAgIGxlbiA9IGJ1Zi5zdF9zaXplOworICAgIGZidWYgPSBtbWFwKDAsIGxl
biwgUFJPVF9SRUFELCBNQVBfUFJJVkFURSwgZmQsIDApOworICAgIGlmICggZmJ1ZiA9PSBNQVBf
RkFJTEVEICkKKyAgICAgICAgZ290byBlcnJvcjsKKworICAgIHJjID0geGNfbGl2ZXBhdGNoX3Vw
bG9hZChzZWxmLT54Y19oYW5kbGUsIG5hbWUsIGZidWYsIGxlbik7CisgICAgaWYgKCByYyApCisg
ICAgICAgIGdvdG8gZXJyb3I7CisKKyAgICBpZiAoIG11bm1hcChmYnVmLCBsZW4pICkKKyAgICB7
CisgICAgICAgIGZidWYgPSBNQVBfRkFJTEVEOworICAgICAgICBnb3RvIGVycm9yOworICAgIH0K
KyAgICBjbG9zZShmZCk7CisKKyAgICByZXR1cm4gUHlfQnVpbGRWYWx1ZSgiaSIsIHJjKTs7Citl
cnJvcjoKKyAgICBpZiAoIGZidWYgIT0gTUFQX0ZBSUxFRCApCisgICAgICAgIG11bm1hcChmYnVm
LCBsZW4pOworICAgIGlmICggZmQgPj0gMCApCisgICAgICAgIGNsb3NlKGZkKTsKKyAgICByZXR1
cm4gcHl4Y19lcnJvcl90b19leGNlcHRpb24oc2VsZi0+eGNfaGFuZGxlKTsKK30KKworc3RhdGlj
IFB5T2JqZWN0ICpweXhjX2xpdmVwYXRjaF9saXN0KFhjT2JqZWN0ICpzZWxmKQoreworICAgIFB5
T2JqZWN0ICpsaXN0OworICAgIHVuc2lnbmVkIGludCBuciwgZG9uZSwgbGVmdCwgaTsKKyAgICB4
ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICppbmZvID0gTlVMTDsKKyAgICBjaGFyICpuYW1lID0gTlVM
TDsKKyAgICBjaGFyICptZXRhZGF0YSA9IE5VTEw7CisgICAgdWludDMyX3QgKmxlbiA9IE5VTEw7
CisgICAgdWludDMyX3QgKm1ldGFkYXRhX2xlbiA9IE5VTEw7CisgICAgdWludDY0X3QgbmFtZV90
b3RhbF9zaXplLCBtZXRhZGF0YV90b3RhbF9zaXplOworICAgIG9mZl90IG5hbWVfb2ZmLCBtZXRh
ZGF0YV9vZmY7CisgICAgaW50IHJjOworCisgICAgcmMgPSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRf
c2l6ZXMoc2VsZi0+eGNfaGFuZGxlLCAmbnIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJm5hbWVfdG90YWxfc2l6ZSwgJm1ldGFkYXRhX3RvdGFsX3NpemUpOworICAgIGlm
ICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgaWYgKCBuciA9PSAwICkKKyAgICAg
ICAgcmV0dXJuIFB5TGlzdF9OZXcoMCk7CisKKyAgICByYyA9IEVOT01FTTsKKyAgICBpbmZvID0g
bWFsbG9jKG5yICogc2l6ZW9mKCppbmZvKSk7CisgICAgaWYgKCAhaW5mbyApCisgICAgICAgIGdv
dG8gZXJyb3I7CisKKyAgICBuYW1lID0gbWFsbG9jKG5hbWVfdG90YWxfc2l6ZSAqIHNpemVvZigq
bmFtZSkpOworICAgIGlmICggIW5hbWUgKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgbGVu
ID0gbWFsbG9jKG5yICogc2l6ZW9mKCpsZW4pKTsKKyAgICBpZiAoICFsZW4gKQorICAgICAgICBn
b3RvIGVycm9yOworCisgICAgbWV0YWRhdGEgPSBtYWxsb2MobWV0YWRhdGFfdG90YWxfc2l6ZSAq
IHNpemVvZigqbWV0YWRhdGEpKTsKKyAgICBpZiAoICFtZXRhZGF0YSApCisgICAgICAgIGdvdG8g
ZXJyb3I7CisKKyAgICBtZXRhZGF0YV9sZW4gPSBtYWxsb2MobnIgKiBzaXplb2YoKm1ldGFkYXRh
X2xlbikpOworICAgIGlmICggIW1ldGFkYXRhX2xlbiApCisgICAgICAgIGdvdG8gZXJyb3I7CisK
KyAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0KHNlbGYtPnhjX2hhbmRsZSwgbnIsIDAsIGluZm8s
CisgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lLCBsZW4sIG5hbWVfdG90YWxfc2l6ZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLCBtZXRhZGF0YV9sZW4sIG1ldGFk
YXRhX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAmZG9uZSwgJmxlZnQp
OworICAgIGlmICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgbGlzdCA9IFB5TGlz
dF9OZXcoZG9uZSk7CisgICAgbmFtZV9vZmYgPSBtZXRhZGF0YV9vZmYgPSAwOworICAgIGZvciAo
IGkgPSAwOyBpIDwgZG9uZTsgaSsrICkKKyAgICB7CisgICAgICAgIFB5T2JqZWN0ICppbmZvX2Rp
Y3QsICptZXRhZGF0YV9saXN0OworICAgICAgICBjaGFyICpuYW1lX3N0ciwgKm1ldGFkYXRhX3N0
cjsKKworICAgICAgICBuYW1lX3N0ciA9IG5hbWUgKyBuYW1lX29mZjsKKyAgICAgICAgbWV0YWRh
dGFfc3RyID0gbWV0YWRhdGEgKyBtZXRhZGF0YV9vZmY7CisKKyAgICAgICAgbWV0YWRhdGFfbGlz
dCA9IFB5TGlzdF9OZXcoMCk7CisgICAgICAgIGZvciAoIGNoYXIgKnMgPSBtZXRhZGF0YV9zdHI7
IHMgPCBtZXRhZGF0YV9zdHIgKyBtZXRhZGF0YV9sZW5baV07IHMgKz0gc3RybGVuKHMpICsgMSAp
CisgICAgICAgIHsKKyAgICAgICAgICAgIFB5T2JqZWN0ICpmaWVsZCA9IFB5X0J1aWxkVmFsdWUo
InMiLCBzKTsKKyAgICAgICAgICAgIGlmICggZmllbGQgPT0gTlVMTCApCisgICAgICAgICAgICB7
CisgICAgICAgICAgICAgICAgUHlfREVDUkVGKGxpc3QpOworICAgICAgICAgICAgICAgIFB5X0RF
Q1JFRihtZXRhZGF0YV9saXN0KTsKKyAgICAgICAgICAgICAgICByYyA9IEVGQVVMVDsKKyAgICAg
ICAgICAgICAgICBnb3RvIGVycm9yOworICAgICAgICAgICAgfQorCisgICAgICAgICAgICBQeUxp
c3RfQXBwZW5kKG1ldGFkYXRhX2xpc3QsIGZpZWxkKTsKKyAgICAgICAgICAgIFB5X0RFQ1JFRihm
aWVsZCk7CisgICAgICAgIH0KKworICAgICAgICBpbmZvX2RpY3QgPSBQeV9CdWlsZFZhbHVlKAor
ICAgICAgICAgICAgIntzOnMsczppLHM6aSxzOk59IiwKKyAgICAgICAgICAgICJuYW1lIiwgICAg
IG5hbWVfc3RyLAorICAgICAgICAgICAgInN0YXRlIiwgICAgaW5mb1tpXS5zdGF0ZSwKKyAgICAg
ICAgICAgICJyYyIsICAgICAgIGluZm9baV0ucmMsCisgICAgICAgICAgICAibWV0YWRhdGEiLCBt
ZXRhZGF0YV9saXN0KTsKKworICAgICAgICBpZiAoIGluZm9fZGljdCA9PSBOVUxMICkKKyAgICAg
ICAgeworICAgICAgICAgICAgUHlfREVDUkVGKGxpc3QpOworICAgICAgICAgICAgUHlfREVDUkVG
KG1ldGFkYXRhX2xpc3QpOworICAgICAgICAgICAgcmMgPSBFRkFVTFQ7CisgICAgICAgICAgICBn
b3RvIGVycm9yOworICAgICAgICB9CisgICAgICAgIFB5TGlzdF9TZXRJdGVtKGxpc3QsIGksIGlu
Zm9fZGljdCk7CisgICAgICAgIFB5X0RFQ1JFRihpbmZvX2RpY3QpOworCisgICAgICAgIG5hbWVf
b2ZmICs9IGxlbltpXTsKKyAgICAgICAgbWV0YWRhdGFfb2ZmICs9IG1ldGFkYXRhX2xlbltpXTsK
KyAgICB9CisKK2Vycm9yOgorICAgIGZyZWUoaW5mbyk7CisgICAgZnJlZShuYW1lKTsKKyAgICBm
cmVlKGxlbik7CisgICAgZnJlZShtZXRhZGF0YSk7CisgICAgZnJlZShtZXRhZGF0YV9sZW4pOwor
ICAgIHJldHVybiByYyA/IHB5eGNfZXJyb3JfdG9fZXhjZXB0aW9uKHNlbGYtPnhjX2hhbmRsZSkg
OiBsaXN0OworfQorCiBzdGF0aWMgUHlNZXRob2REZWYgcHl4Y19tZXRob2RzW10gPSB7CiAgICAg
eyAiZG9tYWluX2NyZWF0ZSIsIAogICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfZG9tYWluX2NyZWF0
ZSwgCkBAIC0yNTg3LDYgKzI4MTEsNDQgQEAgc3RhdGljIFB5TWV0aG9kRGVmIHB5eGNfbWV0aG9k
c1tdID0gewogICAgICAgIlJldHVybnM6IFtpbnRdOiAwIG9uIGFsbCBwZXJtaXNzaW9uIGdyYW50
ZWQ7IC0xIGlmIGFueSBwZXJtaXNzaW9ucyBhcmUgXAogICAgICAgIGRlbmllZFxuIiB9LCAKIAor
ICAgIHsgImxpdmVwYXRjaF9zdGF0dXMiLAorICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBh
dGNoX3N0YXR1cywKKyAgICAgIE1FVEhfS0VZV09SRFMsICJcbiIKKyAgICAgICJHZXRzIGN1cnJl
bnQgc3RhdGUgYW5kIHJldHVybiBjb2RlIGZvciBhIHNwZWNpZmllZCBtb2R1bGUuXG4iCisgICAg
ICAiIG5hbWUgICAgIFtzdHJdOiBNb2R1bGUgbmFtZSB0byBiZSB1c2VkXG4iCisgICAgICAiUmV0
dXJuczogW2RpY3RdIG9uIHN1Y2Nlc3M7IHRocm93aW5nIGFuIGV4Y2VwdGlvbiBvbiBlcnJvclxu
IgorICAgICAgIiBzdGF0ZSAgICBbaW50XTogTW9kdWxlIGN1cnJlbnQgc3RhdGU6IENIRUNLRUQg
b3IgQVBQTElFRFxuIgorICAgICAgIiByYyAgICAgICBbaW50XTogUmV0dXJuIGNvZGUgb2YgbGFz
dCBtb2R1bGUncyBvcGVyYXRpb25cbiIgfSwKKworICAgIHsgImxpdmVwYXRjaF91cGxvYWQiLAor
ICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBhdGNoX3VwbG9hZCwKKyAgICAgIE1FVEhfS0VZ
V09SRFMsICJcbiIKKyAgICAgICJVcGxvYWRzIGEgbW9kdWxlIHdpdGggc3BlY2lmaWVkIG5hbWUg
ZnJvbSBmaWxlbmFtZS5cbiIKKyAgICAgICIgbmFtZSAgICAgW3N0cl06IE1vZHVsZSBuYW1lIHRv
IGJlIHVzZWRcbiIKKyAgICAgICIgZmlsZW5hbWUgW3N0cl06IEZpbGVuYW1lIG9mIGEgbW9kdWxl
IHRvIGJlIHVwbG9hZGVkXG4iCisgICAgICAiUmV0dXJuczogW2ludF0gMCBvbiBzdWNjZXNzOyB0
aHJvd2luZyBhbiBleGNlcHRpb24gb24gZXJyb3JcbiIgfSwKKworICAgIHsgImxpdmVwYXRjaF9h
Y3Rpb24iLAorICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBhdGNoX2FjdGlvbiwKKyAgICAg
IE1FVEhfS0VZV09SRFMsICJcbiIKKyAgICAgICJQZXJmb3JtcyBhbiBhY3Rpb24gKHVubG9hZCwg
cmV2ZXJ0LCBhcHBseSBvciByZXBsYWNlKSBvbiBhIHNwZWNpZmllZCBcCisgICAgICAgbW9kdWxl
LlxuIgorICAgICAgIiBuYW1lICAgICAgW3N0cl06IE1vZHVsZSBuYW1lIHRvIGJlIHVzZWRcbiIK
KyAgICAgICIgYWN0aW9uICAgW3VpbnRdOiBBY3Rpb24gZW51bSBpZFxuIgorICAgICAgIiB0aW1l
b3V0ICBbdWludF06IEFjdGlvbiBzY2hlZHVsZWQgZXhlY3V0aW9uIHRpbWVvdXRcbiIKKyAgICAg
ICIgZmxhZ3MgICBbdWxvbmddOiBGbGFncyBzcGVjaWZ5aW5nIGFjdGlvbidzIGV4dHJhIHBhcmFt
ZXRlcnNcbiIKKyAgICAgICJSZXR1cm5zOiBbaW50XSAwIG9uIHN1Y2Nlc3M7IHRocm93aW5nIGFu
IGV4Y2VwdGlvbiBvbiBlcnJvclxuIiB9LAorCisgICAgeyAibGl2ZXBhdGNoX2xpc3QiLAorICAg
ICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBhdGNoX2xpc3QsCisgICAgICBNRVRIX05PQVJHUywg
IlxuIgorICAgICAgIkxpc3QgYWxsIHVwbG9hZGVkIGxpdmVwYXRjaCBtb2R1bGVzIHdpdGggdGhl
aXIgY3VycmVudCBzdGF0ZSBhbmQgbWV0YWRhdGEuXG4iCisgICAgICAiUmV0dXJuczogW2xpc3Qg
b2YgZGljdHNdIG9uIHN1Y2Nlc3M7IHRocm93aW5nIGFuIGV4Y2VwdGlvbiBvbiBlcnJvclxuIgor
ICAgICAgIiBuYW1lICAgICBbc3RyXTogTW9kdWxlIG5hbWVcbiIKKyAgICAgICIgc3RhdGUgICAg
W2ludF06IE1vZHVsZSBjdXJyZW50IHN0YXRlOiBDSEVDS0VEIG9yIEFQUExJRURcbiIKKyAgICAg
ICIgcmMgICAgICAgW2ludF06IFJldHVybiBjb2RlIG9mIGxhc3QgbW9kdWxlJ3Mgb3BlcmF0aW9u
XG4iCisgICAgICAiIG1ldGFkYXRhIFtsaXN0XTogTGlzdCBvZiBtb2R1bGUncyBtZXRhZGF0YSAn
a2V5PXZhbHVlJyBzdHJpbmdzXG4iIH0sCisKICAgICB7IE5VTEwsIE5VTEwsIDAsIE5VTEwgfQog
fTsKIApAQCAtMjY5OCw2ICsyOTYwLDE3IEBAIFB5TU9ESU5JVF9GVU5DIGluaXR4Yyh2b2lkKQog
ICAgIFB5TW9kdWxlX0FkZEludENvbnN0YW50KG0sICJYRU5fU0NIRURVTEVSX0NSRURJVCIsIFhF
Tl9TQ0hFRFVMRVJfQ1JFRElUKTsKICAgICBQeU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAiWEVO
X1NDSEVEVUxFUl9DUkVESVQyIiwgWEVOX1NDSEVEVUxFUl9DUkVESVQyKTsKIAorICAgIC8qIEV4
cG9zZSBsaXZlcGF0Y2ggY29uc3RhbnRzIHRvIFB5dGhvbiAqLworICAgIFB5TW9kdWxlX0FkZElu
dENvbnN0YW50KG0sICJMSVZFUEFUQ0hfQUNUSU9OX1VOTE9BRCIsIExJVkVQQVRDSF9BQ1RJT05f
VU5MT0FEKTsKKyAgICBQeU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAiTElWRVBBVENIX0FDVElP
Tl9SRVZFUlQiLCBMSVZFUEFUQ0hfQUNUSU9OX1JFVkVSVCk7CisgICAgUHlNb2R1bGVfQWRkSW50
Q29uc3RhbnQobSwgIkxJVkVQQVRDSF9BQ1RJT05fQVBQTFkiLCBMSVZFUEFUQ0hfQUNUSU9OX0FQ
UExZKTsKKyAgICBQeU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAiTElWRVBBVENIX0FDVElPTl9S
RVBMQUNFIiwgTElWRVBBVENIX0FDVElPTl9SRVBMQUNFKTsKKworICAgIFB5TW9kdWxlX0FkZElu
dENvbnN0YW50KG0sICJMSVZFUEFUQ0hfQUNUSU9OX0FQUExZX05PREVQUyIsIExJVkVQQVRDSF9B
Q1RJT05fQVBQTFlfTk9ERVBTKTsKKworICAgIFB5TW9kdWxlX0FkZEludENvbnN0YW50KG0sICJM
SVZFUEFUQ0hfU1RBVEVfQVBQTElFRCIsIExJVkVQQVRDSF9TVEFURV9BUFBMSUVEKTsKKyAgICBQ
eU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAiTElWRVBBVENIX1NUQVRFX0NIRUNLRUQiLCBMSVZF
UEFUQ0hfU1RBVEVfQ0hFQ0tFRCk7CisKICNpZiBQWV9NQUpPUl9WRVJTSU9OID49IDMKICAgICBy
ZXR1cm4gbTsKICNlbmRpZgotLSAKMi4xNi41CgoKCgpBbWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVy
IEdlcm1hbnkgR21iSApLcmF1c2Vuc3RyLiAzOAoxMDExNyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhy
dW5nOiBDaHJpc3RpYW4gU2NobGFlZ2VyLCBSYWxmIEhlcmJyaWNoCkVpbmdldHJhZ2VuIGFtIEFt
dHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4K
VXN0LUlEOiBERSAyODkgMjM3IDg3OQoKCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMu
eGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL3hlbi1kZXZlbA==

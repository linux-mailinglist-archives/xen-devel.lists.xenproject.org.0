Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 323CB926BE
	for <lists+xen-devel@lfdr.de>; Mon, 19 Aug 2019 16:30:56 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hzicj-0007Hy-7K; Mon, 19 Aug 2019 14:27:05 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=UkZp=WP=arm.com=julien.grall@srs-us1.protection.inumbo.net>)
 id 1hzich-0007Ho-L3
 for xen-devel@lists.xenproject.org; Mon, 19 Aug 2019 14:27:03 +0000
X-Inumbo-ID: 689d42cc-c28d-11e9-b90c-bc764e2007e4
Received: from foss.arm.com (unknown [217.140.110.172])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTP
 id 689d42cc-c28d-11e9-b90c-bc764e2007e4;
 Mon, 19 Aug 2019 14:27:01 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id E7FDF360;
 Mon, 19 Aug 2019 07:27:00 -0700 (PDT)
Received: from e108454-lin.cambridge.arm.com (e108454-lin.cambridge.arm.com
 [10.1.196.50])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 7A0673F718;
 Mon, 19 Aug 2019 07:26:58 -0700 (PDT)
From: Julien Grall <julien.grall@arm.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 19 Aug 2019 15:26:50 +0100
Message-Id: <20190819142651.11058-2-julien.grall@arm.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190819142651.11058-1-julien.grall@arm.com>
References: <20190819142651.11058-1-julien.grall@arm.com>
Subject: [Xen-devel] [PATCH v4 1/2] xen: Switch parameter in
 get_page_from_gfn to use typesafe gfn
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Jun Nakajima <jun.nakajima@intel.com>, Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Brian Woods <brian.woods@amd.com>,
 Tim Deegan <tim@xen.org>, Julien Grall <julien.grall@arm.com>,
 Paul Durrant <paul.durrant@citrix.com>, Jan Beulich <jbeulich@suse.com>,
 Boris Ostrovsky <boris.ostrovsky@oracle.com>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Tm8gZnVuY3Rpb25hbCBjaGFuZ2UgaW50ZW5kZWQuCgpPbmx5IHJlYXNvbmFibGUgY2xlYW4tdXBz
IGFyZSBkb25lIGluIHRoaXMgcGF0Y2guIFRoZSByZXN0IHdpbGwgdXNlIF9nZm4KZm9yIHRoZSB0
aW1lIGJlaW5nLgoKVGhlIGNvZGUgaW4gZ2V0X3BhZ2VfZnJvbV9nZm4gaXMgc2xpZ2h0bHkgcmV3
b3JrZWQgdG8gYWxzbyBoYW5kbGUgYSBiYWQKYmVoYXZpb3IgYmVjYXVzZSBpdCBpcyBub3Qgc2Fm
ZSB0byB1c2UgbWZuX3RvX3BhZ2UoLi4uKSBiZWNhdXNlCm1mbl92YWxpZCguLi4pIHN1Y2NlZWRz
LgoKU2lnbmVkLW9mZi1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KCi0t
LQogICAgQ2hhbmdlcyBpbiB2NDoKICAgICAgICAtIERyb3AgYWxsIHRoZSByZXZpZXdlZC1ieS9h
Y2tlZC1ieSBhcyB0aGUgbGFzdCB2ZXJzaW9uIHdhcwogICAgICAgIHNlbnQgbmVhcmx5IDkgbW9u
dGhzIGFnby4KICAgICAgICAtIFJld29yayB0aGUgY2hhbmdlIGluIHg4NiB2ZXJzaW9uIGdldF9w
YWdlX2Zyb21fZ2ZuCiAgICAgICAgLSBzLyUjUFJJXy8lUFJJXy8KCiAgICBDaGFuZ2VzIGluIHYz
OgogICAgICAgIC0gQWRkIEphbidzIGFja2VkLWJ5CgogICAgQ2hhbmdlcyBpbiB2MjoKICAgICAg
ICAtIFJlbW92ZSA+PiBQQUdFX1NISUZUIGluIHN2bSBjb2RlCiAgICAgICAgLSBGaXggdHlwbyBp
biB0aGUgZS1tYWlsIGFkZHJlc3MKICAgICAgICAtIFNtYWxsIE5JVHMKLS0tCiB4ZW4vYXJjaC9h
cm0vZ3Vlc3Rjb3B5LmMgICAgICAgICAgICAgfCAgMiArLQogeGVuL2FyY2gvYXJtL21tLmMgICAg
ICAgICAgICAgICAgICAgIHwgIDIgKy0KIHhlbi9hcmNoL3g4Ni9jcHUvdnBtdS5jICAgICAgICAg
ICAgICB8ICAyICstCiB4ZW4vYXJjaC94ODYvZG9tY3RsLmMgICAgICAgICAgICAgICAgfCAgNiAr
KystLS0KIHhlbi9hcmNoL3g4Ni9odm0vZG0uYyAgICAgICAgICAgICAgICB8ICAyICstCiB4ZW4v
YXJjaC94ODYvaHZtL2RvbWFpbi5jICAgICAgICAgICAgfCAgNiArKysrLS0KIHhlbi9hcmNoL3g4
Ni9odm0vaHZtLmMgICAgICAgICAgICAgICB8ICA5ICsrKysrLS0tLQogeGVuL2FyY2gveDg2L2h2
bS9zdm0vc3ZtLmMgICAgICAgICAgIHwgIDggKysrKy0tLS0KIHhlbi9hcmNoL3g4Ni9odm0vdmly
aWRpYW4vdmlyaWRpYW4uYyB8IDE2ICsrKysrKysrLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9odm0v
dm14L3ZteC5jICAgICAgICAgICB8ICA0ICsrLS0KIHhlbi9hcmNoL3g4Ni9odm0vdm14L3Z2bXgu
YyAgICAgICAgICB8IDEyICsrKysrKy0tLS0tLQogeGVuL2FyY2gveDg2L21tLmMgICAgICAgICAg
ICAgICAgICAgIHwgMjQgKysrKysrKysrKysrKystLS0tLS0tLS0tCiB4ZW4vYXJjaC94ODYvbW0v
cDJtLmMgICAgICAgICAgICAgICAgfCAgMiArLQogeGVuL2FyY2gveDg2L21tL3NoYWRvdy9odm0u
YyAgICAgICAgIHwgIDYgKysrLS0tCiB4ZW4vYXJjaC94ODYvcGh5c2Rldi5jICAgICAgICAgICAg
ICAgfCAgMyArKy0KIHhlbi9hcmNoL3g4Ni9wdi9kZXNjcmlwdG9yLXRhYmxlcy5jICB8ICA0ICsr
LS0KIHhlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYyAgICAgICB8ICA2ICsrKy0tLQogeGVu
L2FyY2gveDg2L3B2L21tLmMgICAgICAgICAgICAgICAgIHwgIDIgKy0KIHhlbi9hcmNoL3g4Ni90
cmFwcy5jICAgICAgICAgICAgICAgICB8IDExICsrKysrKy0tLS0tCiB4ZW4vY29tbW9uL2RvbWFp
bi5jICAgICAgICAgICAgICAgICAgfCAgMiArLQogeGVuL2NvbW1vbi9ldmVudF9maWZvLmMgICAg
ICAgICAgICAgIHwgMTIgKysrKysrLS0tLS0tCiB4ZW4vY29tbW9uL21lbW9yeS5jICAgICAgICAg
ICAgICAgICAgfCAgNCArKy0tCiB4ZW4vaW5jbHVkZS9hc20tYXJtL3AybS5oICAgICAgICAgICAg
fCAgNiArKystLS0KIHhlbi9pbmNsdWRlL2FzbS14ODYvcDJtLmggICAgICAgICAgICB8IDE2ICsr
KysrKysrKysrKy0tLS0KIDI0IGZpbGVzIGNoYW5nZWQsIDkyIGluc2VydGlvbnMoKyksIDc1IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9ndWVzdGNvcHkuYyBiL3hlbi9h
cmNoL2FybS9ndWVzdGNvcHkuYwppbmRleCA3YTBmM2U5ZDVmLi41NTg5MjA2MmJiIDEwMDY0NAot
LS0gYS94ZW4vYXJjaC9hcm0vZ3Vlc3Rjb3B5LmMKKysrIGIveGVuL2FyY2gvYXJtL2d1ZXN0Y29w
eS5jCkBAIC0zNyw3ICszNyw3IEBAIHN0YXRpYyBzdHJ1Y3QgcGFnZV9pbmZvICp0cmFuc2xhdGVf
Z2V0X3BhZ2UoY29weV9pbmZvX3QgaW5mbywgdWludDY0X3QgYWRkciwKICAgICAgICAgcmV0dXJu
IGdldF9wYWdlX2Zyb21fZ3ZhKGluZm8uZ3ZhLnYsIGFkZHIsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB3cml0ZSA/IEdWMk1fV1JJVEUgOiBHVjJNX1JFQUQpOwogCi0gICAgcGFn
ZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGluZm8uZ3BhLmQsIHBhZGRyX3RvX3BmbihhZGRyKSwgJnAy
bXQsIFAyTV9BTExPQyk7CisgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGluZm8uZ3BhLmQs
IGdhZGRyX3RvX2dmbihhZGRyKSwgJnAybXQsIFAyTV9BTExPQyk7CiAKICAgICBpZiAoICFwYWdl
ICkKICAgICAgICAgcmV0dXJuIE5VTEw7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0vbW0uYyBi
L3hlbi9hcmNoL2FybS9tbS5jCmluZGV4IGUxY2RlYWFmMmYuLmU5YWZkNTNlNjkgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL2FybS9tbS5jCisrKyBiL3hlbi9hcmNoL2FybS9tbS5jCkBAIC0xNDA1LDcg
KzE0MDUsNyBAQCBpbnQgeGVubWVtX2FkZF90b19waHlzbWFwX29uZSgKIAogICAgICAgICAvKiBU
YWtlIHJlZmVyZW5jZSB0byB0aGUgZm9yZWlnbiBkb21haW4gcGFnZS4KICAgICAgICAgICogUmVm
ZXJlbmNlIHdpbGwgYmUgcmVsZWFzZWQgaW4gWEVOTUVNX3JlbW92ZV9mcm9tX3BoeXNtYXAgKi8K
LSAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKG9kLCBpZHgsICZwMm10LCBQMk1fQUxM
T0MpOworICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4ob2QsIF9nZm4oaWR4KSwgJnAy
bXQsIFAyTV9BTExPQyk7CiAgICAgICAgIGlmICggIXBhZ2UgKQogICAgICAgICB7CiAgICAgICAg
ICAgICBwdXRfcGdfb3duZXIob2QpOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2NwdS92cG11
LmMgYi94ZW4vYXJjaC94ODYvY3B1L3ZwbXUuYwppbmRleCAzNzU1OTlhY2E1Li5jNWE0YzlhNjAz
IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvY3B1L3ZwbXUuYworKysgYi94ZW4vYXJjaC94ODYv
Y3B1L3ZwbXUuYwpAQCAtNTkwLDcgKzU5MCw3IEBAIHN0YXRpYyBpbnQgcHZwbXVfaW5pdChzdHJ1
Y3QgZG9tYWluICpkLCB4ZW5fcG11X3BhcmFtc190ICpwYXJhbXMpCiAgICAgc3RydWN0IHZjcHUg
KnY7CiAgICAgc3RydWN0IHZwbXVfc3RydWN0ICp2cG11OwogICAgIHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2U7Ci0gICAgdWludDY0X3QgZ2ZuID0gcGFyYW1zLT52YWw7CisgICAgZ2ZuX3QgZ2ZuID0g
X2dmbihwYXJhbXMtPnZhbCk7CiAKICAgICBpZiAoIChwYXJhbXMtPnZjcHUgPj0gZC0+bWF4X3Zj
cHVzKSB8fCAoZC0+dmNwdVtwYXJhbXMtPnZjcHVdID09IE5VTEwpICkKICAgICAgICAgcmV0dXJu
IC1FSU5WQUw7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tY3RsLmMgYi94ZW4vYXJjaC94
ODYvZG9tY3RsLmMKaW5kZXggMmQ0NWU1YjhhOC4uM2NlMmRkMTQ2MyAxMDA2NDQKLS0tIGEveGVu
L2FyY2gveDg2L2RvbWN0bC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21jdGwuYwpAQCAtNDUzLDcg
KzQ1Myw3IEBAIGxvbmcgYXJjaF9kb19kb21jdGwoCiAgICAgICAgICAgICAgICAgYnJlYWs7CiAg
ICAgICAgICAgICB9CiAKLSAgICAgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihkLCBn
Zm4sICZ0LCBQMk1fQUxMT0MpOworICAgICAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2Zu
KGQsIF9nZm4oZ2ZuKSwgJnQsIFAyTV9BTExPQyk7CiAKICAgICAgICAgICAgIGlmICggdW5saWtl
bHkoIXBhZ2UpIHx8CiAgICAgICAgICAgICAgICAgIHVubGlrZWx5KGlzX3hlbl9oZWFwX3BhZ2Uo
cGFnZSkpICkKQEAgLTUwMywxMSArNTAzLDExIEBAIGxvbmcgYXJjaF9kb19kb21jdGwoCiAKICAg
ICBjYXNlIFhFTl9ET01DVExfaHlwZXJjYWxsX2luaXQ6CiAgICAgewotICAgICAgICB1bnNpZ25l
ZCBsb25nIGdtZm4gPSBkb21jdGwtPnUuaHlwZXJjYWxsX2luaXQuZ21mbjsKKyAgICAgICAgZ2Zu
X3QgZ2ZuID0gX2dmbihkb21jdGwtPnUuaHlwZXJjYWxsX2luaXQuZ21mbik7CiAgICAgICAgIHN0
cnVjdCBwYWdlX2luZm8gKnBhZ2U7CiAgICAgICAgIHZvaWQgKmh5cGVyY2FsbF9wYWdlOwogCi0g
ICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihkLCBnbWZuLCBOVUxMLCBQMk1fQUxMT0Mp
OworICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4oZCwgZ2ZuLCBOVUxMLCBQMk1fQUxM
T0MpOwogCiAgICAgICAgIGlmICggIXBhZ2UgfHwgIWdldF9wYWdlX3R5cGUocGFnZSwgUEdUX3dy
aXRhYmxlX3BhZ2UpICkKICAgICAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS9k
bS5jIGIveGVuL2FyY2gveDg2L2h2bS9kbS5jCmluZGV4IGQ2ZDBlOGJlODkuLjNiM2FkMjc5Mzgg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vZG0uYworKysgYi94ZW4vYXJjaC94ODYvaHZt
L2RtLmMKQEAgLTE4Niw3ICsxODYsNyBAQCBzdGF0aWMgaW50IG1vZGlmaWVkX21lbW9yeShzdHJ1
Y3QgZG9tYWluICpkLAogICAgICAgICB7CiAgICAgICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpw
YWdlOwogCi0gICAgICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4oZCwgcGZuLCBOVUxM
LCBQMk1fVU5TSEFSRSk7CisgICAgICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4oZCwg
X2dmbihwZm4pLCBOVUxMLCBQMk1fVU5TSEFSRSk7CiAgICAgICAgICAgICBpZiAoIHBhZ2UgKQog
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHBhZ2luZ19tYXJrX3Bmbl9kaXJ0eShkLCBf
cGZuKHBmbikpOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS9kb21haW4uYyBiL3hlbi9h
cmNoL3g4Ni9odm0vZG9tYWluLmMKaW5kZXggNWQ1YTc0NmEyNS4uM2MyOWZmODZiZSAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2h2bS9kb21haW4uYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2Rv
bWFpbi5jCkBAIC0yOTYsOCArMjk2LDEwIEBAIGludCBhcmNoX3NldF9pbmZvX2h2bV9ndWVzdChz
dHJ1Y3QgdmNwdSAqdiwgY29uc3QgdmNwdV9odm1fY29udGV4dF90ICpjdHgpCiAgICAgaWYgKCBo
dm1fcGFnaW5nX2VuYWJsZWQodikgJiYgIXBhZ2luZ19tb2RlX2hhcCh2LT5kb21haW4pICkKICAg
ICB7CiAgICAgICAgIC8qIFNoYWRvdy1tb2RlIENSMyBjaGFuZ2UuIENoZWNrIFBEQlIgYW5kIHVw
ZGF0ZSByZWZjb3VudHMuICovCi0gICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UgPSBnZXRf
cGFnZV9mcm9tX2dmbih2LT5kb21haW4sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2LT5hcmNoLmh2bS5ndWVzdF9jclszXSA+PiBQQUdFX1NISUZULAorICAgICAgICBzdHJ1Y3Qg
cGFnZV9pbmZvICpwYWdlOworCisgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbih2LT5k
b21haW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYWRkcl90b19nZm4odi0+
YXJjaC5odm0uZ3Vlc3RfY3JbM10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
TlVMTCwgUDJNX0FMTE9DKTsKICAgICAgICAgaWYgKCAhcGFnZSApCiAgICAgICAgIHsKZGlmZiAt
LWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMgYi94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCmlu
ZGV4IDAyOWVlYTNiODUuLjIzNmJkNmVkMzggMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0v
aHZtLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9odm0uYwpAQCAtMjE2OCw3ICsyMTY4LDcgQEAg
aW50IGh2bV9zZXRfY3IwKHVuc2lnbmVkIGxvbmcgdmFsdWUsIGJvb2wgbWF5X2RlZmVyKQogewog
ICAgIHN0cnVjdCB2Y3B1ICp2ID0gY3VycmVudDsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+
ZG9tYWluOwotICAgIHVuc2lnbmVkIGxvbmcgZ2ZuLCBvbGRfdmFsdWUgPSB2LT5hcmNoLmh2bS5n
dWVzdF9jclswXTsKKyAgICB1bnNpZ25lZCBsb25nIG9sZF92YWx1ZSA9IHYtPmFyY2guaHZtLmd1
ZXN0X2NyWzBdOwogICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2U7CiAKICAgICBIVk1fREJHX0xP
RyhEQkdfTEVWRUxfVk1NVSwgIlVwZGF0ZSBDUjAgdmFsdWUgPSAlbHgiLCB2YWx1ZSk7CkBAIC0y
MjIzLDcgKzIyMjMsOCBAQCBpbnQgaHZtX3NldF9jcjAodW5zaWduZWQgbG9uZyB2YWx1ZSwgYm9v
bCBtYXlfZGVmZXIpCiAgICAgICAgIGlmICggIXBhZ2luZ19tb2RlX2hhcChkKSApCiAgICAgICAg
IHsKICAgICAgICAgICAgIC8qIFRoZSBndWVzdCBDUjMgbXVzdCBiZSBwb2ludGluZyB0byB0aGUg
Z3Vlc3QgcGh5c2ljYWwuICovCi0gICAgICAgICAgICBnZm4gPSB2LT5hcmNoLmh2bS5ndWVzdF9j
clszXSA+PiBQQUdFX1NISUZUOworICAgICAgICAgICAgZ2ZuX3QgZ2ZuID0gZ2FkZHJfdG9fZ2Zu
KHYtPmFyY2guaHZtLmd1ZXN0X2NyWzNdKTsKKwogICAgICAgICAgICAgcGFnZSA9IGdldF9wYWdl
X2Zyb21fZ2ZuKGQsIGdmbiwgTlVMTCwgUDJNX0FMTE9DKTsKICAgICAgICAgICAgIGlmICggIXBh
Z2UgKQogICAgICAgICAgICAgewpAQCAtMjMxNSw3ICsyMzE2LDcgQEAgaW50IGh2bV9zZXRfY3Iz
KHVuc2lnbmVkIGxvbmcgdmFsdWUsIGJvb2wgbWF5X2RlZmVyKQogICAgIHsKICAgICAgICAgLyog
U2hhZG93LW1vZGUgQ1IzIGNoYW5nZS4gQ2hlY2sgUERCUiBhbmQgdXBkYXRlIHJlZmNvdW50cy4g
Ki8KICAgICAgICAgSFZNX0RCR19MT0coREJHX0xFVkVMX1ZNTVUsICJDUjMgdmFsdWUgPSAlbHgi
LCB2YWx1ZSk7Ci0gICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbih2LT5kb21haW4sIHZh
bHVlID4+IFBBR0VfU0hJRlQsCisgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbih2LT5k
b21haW4sIGdhZGRyX3RvX2dmbih2YWx1ZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBOVUxMLCBQMk1fQUxMT0MpOwogICAgICAgICBpZiAoICFwYWdlICkKICAgICAgICAgICAg
IGdvdG8gYmFkX2NyMzsKQEAgLTMxNDMsNyArMzE0NCw3IEBAIGVudW0gaHZtX3RyYW5zbGF0aW9u
X3Jlc3VsdCBodm1fdHJhbnNsYXRlX2dldF9wYWdlKAogICAgICAgICAgJiYgaHZtX21taW9faW50
ZXJuYWwoZ2ZuX3RvX2dhZGRyKGdmbikpICkKICAgICAgICAgcmV0dXJuIEhWTVRSQU5TX2JhZF9n
Zm5fdG9fbWZuOwogCi0gICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKHYtPmRvbWFpbiwgZ2Zu
X3goZ2ZuKSwgJnAybXQsIFAyTV9VTlNIQVJFKTsKKyAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9n
Zm4odi0+ZG9tYWluLCBnZm4sICZwMm10LCBQMk1fVU5TSEFSRSk7CiAKICAgICBpZiAoICFwYWdl
ICkKICAgICAgICAgcmV0dXJuIEhWTVRSQU5TX2JhZF9nZm5fdG9fbWZuOwpkaWZmIC0tZ2l0IGEv
eGVuL2FyY2gveDg2L2h2bS9zdm0vc3ZtLmMgYi94ZW4vYXJjaC94ODYvaHZtL3N2bS9zdm0uYwpp
bmRleCBjZjgzY2U5YTE5Li42MjBlYjk1MWI2IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZt
L3N2bS9zdm0uYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3N2bS9zdm0uYwpAQCAtMzE3LDcgKzMx
Nyw3IEBAIHN0YXRpYyBpbnQgc3ZtX3ZtY2JfcmVzdG9yZShzdHJ1Y3QgdmNwdSAqdiwgc3RydWN0
IGh2bV9od19jcHUgKmMpCiAgICAgewogICAgICAgICBpZiAoIGMtPmNyMCAmIFg4Nl9DUjBfUEcg
KQogICAgICAgICB7Ci0gICAgICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+ZG9t
YWluLCBjLT5jcjMgPj4gUEFHRV9TSElGVCwKKyAgICAgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9m
cm9tX2dmbih2LT5kb21haW4sIGdhZGRyX3RvX2dmbihjLT5jcjMpLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIFAyTV9BTExPQyk7CiAgICAgICAgICAgICBpZiAo
ICFwYWdlICkKICAgICAgICAgICAgIHsKQEAgLTIyNzYsOSArMjI3Niw5IEBAIG5zdm1fZ2V0X252
bWNiX3BhZ2Uoc3RydWN0IHZjcHUgKnYsIHVpbnQ2NF90IHZtY2JhZGRyKQogICAgICAgICByZXR1
cm4gTlVMTDsKIAogICAgIC8qIE5lZWQgdG8gdHJhbnNsYXRlIEwxLUdQQSB0byBNUEEgKi8KLSAg
ICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+ZG9tYWluLCAKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBudi0+bnZfdnZtY3hhZGRyID4+IFBBR0VfU0hJRlQsIAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICZwMm10LCBQMk1fQUxMT0MgfCBQMk1fVU5TSEFSRSk7CisgICAgcGFn
ZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKHYtPmRvbWFpbiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ2FkZHJfdG9fZ2ZuKG52LT5udl92dm1jeGFkZHIpLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAmcDJtdCwgUDJNX0FMTE9DIHwgUDJNX1VOU0hBUkUpOwogICAgIGlmICggIXBh
Z2UgKQogICAgICAgICByZXR1cm4gTlVMTDsKIApkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2
bS92aXJpZGlhbi92aXJpZGlhbi5jIGIveGVuL2FyY2gveDg2L2h2bS92aXJpZGlhbi92aXJpZGlh
bi5jCmluZGV4IDRiMDZiNzhhMjcuLmIzOTNhMTQ1N2IgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4
Ni9odm0vdmlyaWRpYW4vdmlyaWRpYW4uYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3ZpcmlkaWFu
L3ZpcmlkaWFuLmMKQEAgLTI1NiwxNiArMjU2LDE2IEBAIHN0YXRpYyB2b2lkIGR1bXBfaHlwZXJj
YWxsKGNvbnN0IHN0cnVjdCBkb21haW4gKmQpCiAKIHN0YXRpYyB2b2lkIGVuYWJsZV9oeXBlcmNh
bGxfcGFnZShzdHJ1Y3QgZG9tYWluICpkKQogewotICAgIHVuc2lnbmVkIGxvbmcgZ21mbiA9IGQt
PmFyY2guaHZtLnZpcmlkaWFuLT5oeXBlcmNhbGxfZ3BhLnBmbjsKLSAgICBzdHJ1Y3QgcGFnZV9p
bmZvICpwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4oZCwgZ21mbiwgTlVMTCwgUDJNX0FMTE9DKTsK
KyAgICBnZm5fdCBnZm4gPSBfZ2ZuKGQtPmFyY2guaHZtLnZpcmlkaWFuLT5oeXBlcmNhbGxfZ3Bh
LnBmbik7CisgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGQs
IGdmbiwgTlVMTCwgUDJNX0FMTE9DKTsKICAgICB1aW50OF90ICpwOwogCiAgICAgaWYgKCAhcGFn
ZSB8fCAhZ2V0X3BhZ2VfdHlwZShwYWdlLCBQR1Rfd3JpdGFibGVfcGFnZSkgKQogICAgIHsKICAg
ICAgICAgaWYgKCBwYWdlICkKICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwotICAgICAgICBn
ZHByaW50ayhYRU5MT0dfV0FSTklORywgIkJhZCBHTUZOICUjIlBSSV9nZm4iIChNRk4gJSMiUFJJ
X21mbiIpXG4iLAotICAgICAgICAgICAgICAgICBnbWZuLCBtZm5feChwYWdlID8gcGFnZV90b19t
Zm4ocGFnZSkgOiBJTlZBTElEX01GTikpOworICAgICAgICBnZHByaW50ayhYRU5MT0dfV0FSTklO
RywgIkJhZCBHRk4gJSMiUFJJX2dmbiIgKE1GTiAlIyJQUklfbWZuIilcbiIsCisgICAgICAgICAg
ICAgICAgIGdmbl94KGdmbiksIG1mbl94KHBhZ2UgPyBwYWdlX3RvX21mbihwYWdlKSA6IElOVkFM
SURfTUZOKSk7CiAgICAgICAgIHJldHVybjsKICAgICB9CiAKQEAgLTczMywxMyArNzMzLDEzIEBA
IHZvaWQgdmlyaWRpYW5fZHVtcF9ndWVzdF9wYWdlKGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCBjb25z
dCBjaGFyICpuYW1lLAogCiB2b2lkIHZpcmlkaWFuX21hcF9ndWVzdF9wYWdlKHN0cnVjdCBkb21h
aW4gKmQsIHN0cnVjdCB2aXJpZGlhbl9wYWdlICp2cCkKIHsKLSAgICB1bnNpZ25lZCBsb25nIGdt
Zm4gPSB2cC0+bXNyLnBmbjsKKyAgICBnZm5fdCBnZm4gPSBfZ2ZuKHZwLT5tc3IucGZuKTsKICAg
ICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOwogCiAgICAgaWYgKCB2cC0+cHRyICkKICAgICAgICAg
cmV0dXJuOwogCi0gICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGQsIGdtZm4sIE5VTEwsIFAy
TV9BTExPQyk7CisgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGQsIGdmbiwgTlVMTCwgUDJN
X0FMTE9DKTsKICAgICBpZiAoICFwYWdlICkKICAgICAgICAgZ290byBmYWlsOwogCkBAIC03NjAs
OCArNzYwLDggQEAgdm9pZCB2aXJpZGlhbl9tYXBfZ3Vlc3RfcGFnZShzdHJ1Y3QgZG9tYWluICpk
LCBzdHJ1Y3QgdmlyaWRpYW5fcGFnZSAqdnApCiAgICAgcmV0dXJuOwogCiAgZmFpbDoKLSAgICBn
ZHByaW50ayhYRU5MT0dfV0FSTklORywgIkJhZCBHTUZOICUjIlBSSV9nZm4iIChNRk4gJSMiUFJJ
X21mbiIpXG4iLAotICAgICAgICAgICAgIGdtZm4sIG1mbl94KHBhZ2UgPyBwYWdlX3RvX21mbihw
YWdlKSA6IElOVkFMSURfTUZOKSk7CisgICAgZ2RwcmludGsoWEVOTE9HX1dBUk5JTkcsICJCYWQg
R0ZOICUjIlBSSV9nZm4iIChNRk4gJSMiUFJJX21mbiIpXG4iLAorICAgICAgICAgICAgIGdmbl94
KGdmbiksIG1mbl94KHBhZ2UgPyBwYWdlX3RvX21mbihwYWdlKSA6IElOVkFMSURfTUZOKSk7CiB9
CiAKIHZvaWQgdmlyaWRpYW5fdW5tYXBfZ3Vlc3RfcGFnZShzdHJ1Y3QgdmlyaWRpYW5fcGFnZSAq
dnApCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYyBiL3hlbi9hcmNoL3g4
Ni9odm0vdm14L3ZteC5jCmluZGV4IDAwNjAzMTBkNzQuLjM4YmRlZjA4NjIgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3Zt
eC5jCkBAIC02NzQsNyArNjc0LDcgQEAgc3RhdGljIGludCB2bXhfcmVzdG9yZV9jcjBfY3IzKAog
ICAgIHsKICAgICAgICAgaWYgKCBjcjAgJiBYODZfQ1IwX1BHICkKICAgICAgICAgewotICAgICAg
ICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKHYtPmRvbWFpbiwgY3IzID4+IFBBR0VfU0hJ
RlQsCisgICAgICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+ZG9tYWluLCBnYWRk
cl90b19nZm4oY3IzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxM
LCBQMk1fQUxMT0MpOwogICAgICAgICAgICAgaWYgKCAhcGFnZSApCiAgICAgICAgICAgICB7CkBA
IC0xMzE0LDcgKzEzMTQsNyBAQCBzdGF0aWMgdm9pZCB2bXhfbG9hZF9wZHB0cnMoc3RydWN0IHZj
cHUgKnYpCiAgICAgaWYgKCAoY3IzICYgMHgxZlVMKSAmJiAhaHZtX3BjaWRfZW5hYmxlZCh2KSAp
CiAgICAgICAgIGdvdG8gY3Jhc2g7CiAKLSAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+
ZG9tYWluLCBjcjMgPj4gUEFHRV9TSElGVCwgJnAybXQsIFAyTV9VTlNIQVJFKTsKKyAgICBwYWdl
ID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+ZG9tYWluLCBnYWRkcl90b19nZm4oY3IzKSwgJnAybXQs
IFAyTV9VTlNIQVJFKTsKICAgICBpZiAoICFwYWdlICkKICAgICB7CiAgICAgICAgIC8qIElkZWFs
bHkgeW91IGRvbid0IHdhbnQgdG8gY3Jhc2ggYnV0IHJhdGhlciBnbyBpbnRvIGEgd2FpdCAKZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3Z2bXguYyBiL3hlbi9hcmNoL3g4Ni9odm0v
dm14L3Z2bXguYwppbmRleCBmZGY0NDliZmQxLi5jOTNhZTU5OTIxIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvaHZtL3ZteC92dm14LmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdnZteC5j
CkBAIC02NDYsMTEgKzY0NiwxMSBAQCBzdGF0aWMgdm9pZCBudm14X3VwZGF0ZV9hcGljX2FjY2Vz
c19hZGRyZXNzKHN0cnVjdCB2Y3B1ICp2KQogICAgIGlmICggY3RybCAmIFNFQ09OREFSWV9FWEVD
X1ZJUlRVQUxJWkVfQVBJQ19BQ0NFU1NFUyApCiAgICAgewogICAgICAgICBwMm1fdHlwZV90IHAy
bXQ7Ci0gICAgICAgIHVuc2lnbmVkIGxvbmcgYXBpY19ncGZuOworICAgICAgICBnZm5fdCBhcGlj
X2dmbjsKICAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqYXBpY19wZzsKIAotICAgICAgICBhcGlj
X2dwZm4gPSBnZXRfdnZtY3ModiwgQVBJQ19BQ0NFU1NfQUREUikgPj4gUEFHRV9TSElGVDsKLSAg
ICAgICAgYXBpY19wZyA9IGdldF9wYWdlX2Zyb21fZ2ZuKHYtPmRvbWFpbiwgYXBpY19ncGZuLCAm
cDJtdCwgUDJNX0FMTE9DKTsKKyAgICAgICAgYXBpY19nZm4gPSBnYWRkcl90b19nZm4oZ2V0X3Z2
bWNzKHYsIEFQSUNfQUNDRVNTX0FERFIpKTsKKyAgICAgICAgYXBpY19wZyA9IGdldF9wYWdlX2Zy
b21fZ2ZuKHYtPmRvbWFpbiwgYXBpY19nZm4sICZwMm10LCBQMk1fQUxMT0MpOwogICAgICAgICBB
U1NFUlQoYXBpY19wZyAmJiAhcDJtX2lzX3BhZ2luZyhwMm10KSk7CiAgICAgICAgIF9fdm13cml0
ZShBUElDX0FDQ0VTU19BRERSLCBwYWdlX3RvX21hZGRyKGFwaWNfcGcpKTsKICAgICAgICAgcHV0
X3BhZ2UoYXBpY19wZyk7CkBAIC02NjcsMTEgKzY2NywxMSBAQCBzdGF0aWMgdm9pZCBudm14X3Vw
ZGF0ZV92aXJ0dWFsX2FwaWNfYWRkcmVzcyhzdHJ1Y3QgdmNwdSAqdikKICAgICBpZiAoIGN0cmwg
JiBDUFVfQkFTRURfVFBSX1NIQURPVyApCiAgICAgewogICAgICAgICBwMm1fdHlwZV90IHAybXQ7
Ci0gICAgICAgIHVuc2lnbmVkIGxvbmcgdmFwaWNfZ3BmbjsKKyAgICAgICAgZ2ZuX3QgdmFwaWNf
Z2ZuOwogICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICp2YXBpY19wZzsKIAotICAgICAgICB2YXBp
Y19ncGZuID0gZ2V0X3Z2bWNzKHYsIFZJUlRVQUxfQVBJQ19QQUdFX0FERFIpID4+IFBBR0VfU0hJ
RlQ7Ci0gICAgICAgIHZhcGljX3BnID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+ZG9tYWluLCB2YXBp
Y19ncGZuLCAmcDJtdCwgUDJNX0FMTE9DKTsKKyAgICAgICAgdmFwaWNfZ2ZuID0gZ2FkZHJfdG9f
Z2ZuKGdldF92dm1jcyh2LCBWSVJUVUFMX0FQSUNfUEFHRV9BRERSKSk7CisgICAgICAgIHZhcGlj
X3BnID0gZ2V0X3BhZ2VfZnJvbV9nZm4odi0+ZG9tYWluLCB2YXBpY19nZm4sICZwMm10LCBQMk1f
QUxMT0MpOwogICAgICAgICBBU1NFUlQodmFwaWNfcGcgJiYgIXAybV9pc19wYWdpbmcocDJtdCkp
OwogICAgICAgICBfX3Ztd3JpdGUoVklSVFVBTF9BUElDX1BBR0VfQUREUiwgcGFnZV90b19tYWRk
cih2YXBpY19wZykpOwogICAgICAgICBwdXRfcGFnZSh2YXBpY19wZyk7CmRpZmYgLS1naXQgYS94
ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IDc1MzE0MDY1NDMuLmY4
ZTJiNmY5MjEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS5jCkBAIC0yMDgzLDcgKzIwODMsNyBAQCBzdGF0aWMgaW50IG1vZF9sMV9lbnRyeShsMV9w
Z2VudHJ5X3QgKnBsMWUsIGwxX3BnZW50cnlfdCBubDFlLAogICAgICAgICAgICAgcDJtX3F1ZXJ5
X3QgcSA9IGwxZV9nZXRfZmxhZ3MobmwxZSkgJiBfUEFHRV9SVyA/CiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgUDJNX0FMTE9DIHwgUDJNX1VOU0hBUkUgOiBQMk1fQUxMT0M7CiAKLSAgICAg
ICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihwZ19kb20sIGwxZV9nZXRfcGZuKG5sMWUp
LCAmcDJtdCwgcSk7CisgICAgICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4ocGdfZG9t
LCBfZ2ZuKGwxZV9nZXRfcGZuKG5sMWUpKSwgJnAybXQsIHEpOwogCiAgICAgICAgICAgICBpZiAo
IHAybV9pc19wYWdlZChwMm10KSApCiAgICAgICAgICAgICB7CkBAIC0zMzA3LDcgKzMzMDcsOCBA
QCBsb25nIGRvX21tdWV4dF9vcCgKICAgICAgICAgICAgIGlmICggcGFnaW5nX21vZGVfcmVmY291
bnRzKHBnX293bmVyKSApCiAgICAgICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgICAgIHBh
Z2UgPSBnZXRfcGFnZV9mcm9tX2dmbihwZ19vd25lciwgb3AuYXJnMS5tZm4sIE5VTEwsIFAyTV9B
TExPQyk7CisgICAgICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4ocGdfb3duZXIsIF9n
Zm4ob3AuYXJnMS5tZm4pLCBOVUxMLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFAyTV9BTExPQyk7CiAgICAgICAgICAgICBpZiAoIHVubGlrZWx5KCFwYWdlKSApCiAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgcmMgPSAtRUlOVkFMOwpAQCAtMzM3Miw3ICszMzcz
LDggQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgICAgICBpZiAoIHBhZ2luZ19tb2RlX3Jl
ZmNvdW50cyhwZ19vd25lcikgKQogICAgICAgICAgICAgICAgIGJyZWFrOwogCi0gICAgICAgICAg
ICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4ocGdfb3duZXIsIG9wLmFyZzEubWZuLCBOVUxMLCBQ
Mk1fQUxMT0MpOworICAgICAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKHBnX293bmVy
LCBfZ2ZuKG9wLmFyZzEubWZuKSwgTlVMTCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBQMk1fQUxMT0MpOwogICAgICAgICAgICAgaWYgKCB1bmxpa2VseSghcGFnZSkgKQog
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19XQVJOSU5HLApA
QCAtMzU4OCw3ICszNTkwLDggQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgIH0KIAogICAg
ICAgICBjYXNlIE1NVUVYVF9DTEVBUl9QQUdFOgotICAgICAgICAgICAgcGFnZSA9IGdldF9wYWdl
X2Zyb21fZ2ZuKHBnX293bmVyLCBvcC5hcmcxLm1mbiwgJnAybXQsIFAyTV9BTExPQyk7CisgICAg
ICAgICAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4ocGdfb3duZXIsIF9nZm4ob3AuYXJnMS5t
Zm4pLCAmcDJtdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQMk1fQUxM
T0MpOwogICAgICAgICAgICAgaWYgKCB1bmxpa2VseShwMm10ICE9IHAybV9yYW1fcncpICYmIHBh
Z2UgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHB1dF9wYWdlKHBhZ2UpOwpAQCAt
MzYxNiw3ICszNjE5LDcgQEAgbG9uZyBkb19tbXVleHRfb3AoCiAgICAgICAgIHsKICAgICAgICAg
ICAgIHN0cnVjdCBwYWdlX2luZm8gKnNyY19wYWdlLCAqZHN0X3BhZ2U7CiAKLSAgICAgICAgICAg
IHNyY19wYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4ocGdfb3duZXIsIG9wLmFyZzIuc3JjX21mbiwg
JnAybXQsCisgICAgICAgICAgICBzcmNfcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKHBnX293bmVy
LCBfZ2ZuKG9wLmFyZzIuc3JjX21mbiksICZwMm10LAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBQMk1fQUxMT0MpOwogICAgICAgICAgICAgaWYgKCB1bmxpa2VseShw
Mm10ICE9IHAybV9yYW1fcncpICYmIHNyY19wYWdlICkKICAgICAgICAgICAgIHsKQEAgLTM2MzIs
NyArMzYzNSw3IEBAIGxvbmcgZG9fbW11ZXh0X29wKAogICAgICAgICAgICAgICAgIGJyZWFrOwog
ICAgICAgICAgICAgfQogCi0gICAgICAgICAgICBkc3RfcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2Zu
KHBnX293bmVyLCBvcC5hcmcxLm1mbiwgJnAybXQsCisgICAgICAgICAgICBkc3RfcGFnZSA9IGdl
dF9wYWdlX2Zyb21fZ2ZuKHBnX293bmVyLCBfZ2ZuKG9wLmFyZzEubWZuKSwgJnAybXQsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAyTV9BTExPQyk7CiAgICAgICAg
ICAgICBpZiAoIHVubGlrZWx5KHAybXQgIT0gcDJtX3JhbV9ydykgJiYgZHN0X3BhZ2UgKQogICAg
ICAgICAgICAgewpAQCAtMzcyMCw3ICszNzIzLDggQEAgbG9uZyBkb19tbXVfdXBkYXRlKAogewog
ICAgIHN0cnVjdCBtbXVfdXBkYXRlIHJlcTsKICAgICB2b2lkICp2YSA9IE5VTEw7Ci0gICAgdW5z
aWduZWQgbG9uZyBncGZuLCBnbWZuOworICAgIHVuc2lnbmVkIGxvbmcgZ3BmbjsKKyAgICBnZm5f
dCBnZm47CiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZTsKICAgICB1bnNpZ25lZCBpbnQgY21k
LCBpID0gMCwgZG9uZSA9IDAsIHB0X2RvbTsKICAgICBzdHJ1Y3QgdmNwdSAqY3VyciA9IGN1cnJl
bnQsICp2ID0gY3VycjsKQEAgLTM4MzMsOCArMzgzNyw4IEBAIGxvbmcgZG9fbW11X3VwZGF0ZSgK
ICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKIAogICAgICAgICAgICAgcmVxLnB0ciAtPSBjbWQ7
Ci0gICAgICAgICAgICBnbWZuID0gcmVxLnB0ciA+PiBQQUdFX1NISUZUOwotICAgICAgICAgICAg
cGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKHB0X293bmVyLCBnbWZuLCAmcDJtdCwgUDJNX0FMTE9D
KTsKKyAgICAgICAgICAgIGdmbiA9IGdhZGRyX3RvX2dmbihyZXEucHRyKTsKKyAgICAgICAgICAg
IHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihwdF9vd25lciwgZ2ZuLCAmcDJtdCwgUDJNX0FMTE9D
KTsKIAogICAgICAgICAgICAgaWYgKCB1bmxpa2VseSghcGFnZSkgfHwgcDJtdCAhPSBwMm1fcmFt
X3J3ICkKICAgICAgICAgICAgIHsKQEAgLTM4NDIsNyArMzg0Niw3IEBAIGxvbmcgZG9fbW11X3Vw
ZGF0ZSgKICAgICAgICAgICAgICAgICAgICAgcHV0X3BhZ2UocGFnZSk7CiAgICAgICAgICAgICAg
ICAgaWYgKCBwMm1faXNfcGFnZWQocDJtdCkgKQogICAgICAgICAgICAgICAgIHsKLSAgICAgICAg
ICAgICAgICAgICAgcDJtX21lbV9wYWdpbmdfcG9wdWxhdGUocHRfb3duZXIsIGdtZm4pOworICAg
ICAgICAgICAgICAgICAgICBwMm1fbWVtX3BhZ2luZ19wb3B1bGF0ZShwdF9vd25lciwgZ2ZuX3go
Z2ZuKSk7CiAgICAgICAgICAgICAgICAgICAgIHJjID0gLUVOT0VOVDsKICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICAgZWxzZQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tL3Ay
bS5jIGIveGVuL2FyY2gveDg2L21tL3AybS5jCmluZGV4IDRiMWUzOGIxMzEuLjRjYTM1YjU2ZDYg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYworKysgYi94ZW4vYXJjaC94ODYvbW0v
cDJtLmMKQEAgLTI5NTYsNyArMjk1Niw3IEBAIGludCBwMm1fYWRkX2ZvcmVpZ24oc3RydWN0IGRv
bWFpbiAqdGRvbSwgdW5zaWduZWQgbG9uZyBmZ2ZuLAogICAgICAqIFRha2UgYSByZWZjbnQgb24g
dGhlIG1mbi4gTkI6IGZvbGxvd2luZyBzdXBwb3J0ZWQgZm9yIGZvcmVpZ24gbWFwcGluZzoKICAg
ICAgKiAgICAgcmFtX3J3IHwgcmFtX2xvZ2RpcnR5IHwgcmFtX3JvIHwgcGFnaW5nX291dC4KICAg
ICAgKi8KLSAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4oZmRvbSwgZmdmbiwgJnAybXQsIFAy
TV9BTExPQyk7CisgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGZkb20sIF9nZm4oZmdmbiks
ICZwMm10LCBQMk1fQUxMT0MpOwogICAgIGlmICggIXBhZ2UgfHwKICAgICAgICAgICFwMm1faXNf
cmFtKHAybXQpIHx8IHAybV9pc19zaGFyZWQocDJtdCkgfHwgcDJtX2lzX2hvbGUocDJtdCkgKQog
ICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9zaGFkb3cvaHZtLmMgYi94ZW4vYXJj
aC94ODYvbW0vc2hhZG93L2h2bS5jCmluZGV4IDBhYTU2MGI3ZjUuLjEzMTU1OTc4NzggMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9zaGFkb3cvaHZtLmMKKysrIGIveGVuL2FyY2gveDg2L21t
L3NoYWRvdy9odm0uYwpAQCAtMzg4LDE1ICszODgsMTUgQEAgdm9pZCBzaGFkb3dfY29udGludWVf
ZW11bGF0aW9uKHN0cnVjdCBzaF9lbXVsYXRlX2N0eHQgKnNoX2N0eHQsCiBzdGF0aWMgbWZuX3Qg
ZW11bGF0ZV9ndmFfdG9fbWZuKHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBsb25nIHZhZGRyLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2hfZW11bGF0ZV9jdHh0ICpz
aF9jdHh0KQogewotICAgIHVuc2lnbmVkIGxvbmcgZ2ZuOworICAgIGdmbl90IGdmbjsKICAgICBz
dHJ1Y3QgcGFnZV9pbmZvICpwYWdlOwogICAgIG1mbl90IG1mbjsKICAgICBwMm1fdHlwZV90IHAy
bXQ7CiAgICAgdWludDMyX3QgcGZlYyA9IFBGRUNfcGFnZV9wcmVzZW50IHwgUEZFQ193cml0ZV9h
Y2Nlc3M7CiAKICAgICAvKiBUcmFuc2xhdGUgdGhlIFZBIHRvIGEgR0ZOLiAqLwotICAgIGdmbiA9
IHBhZ2luZ19nZXRfaG9zdG1vZGUodiktPmd2YV90b19nZm4odiwgTlVMTCwgdmFkZHIsICZwZmVj
KTsKLSAgICBpZiAoIGdmbiA9PSBnZm5feChJTlZBTElEX0dGTikgKQorICAgIGdmbiA9IF9nZm4o
cGFnaW5nX2dldF9ob3N0bW9kZSh2KS0+Z3ZhX3RvX2dmbih2LCBOVUxMLCB2YWRkciwgJnBmZWMp
KTsKKyAgICBpZiAoIGdmbl9lcShnZm4sIElOVkFMSURfR0ZOKSApCiAgICAgewogICAgICAgICB4
ODZfZW11bF9wYWdlZmF1bHQocGZlYywgdmFkZHIsICZzaF9jdHh0LT5jdHh0KTsKIApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L3BoeXNkZXYuYyBiL3hlbi9hcmNoL3g4Ni9waHlzZGV2LmMKaW5k
ZXggM2EzYzE1ODkwYi4uNGYzZjQzODYxNCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3BoeXNk
ZXYuYworKysgYi94ZW4vYXJjaC94ODYvcGh5c2Rldi5jCkBAIC0yMjksNyArMjI5LDggQEAgcmV0
X3QgZG9fcGh5c2Rldl9vcChpbnQgY21kLCBYRU5fR1VFU1RfSEFORExFX1BBUkFNKHZvaWQpIGFy
ZykKICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIHJldCA9IC1FSU5WQUw7Ci0gICAgICAg
IHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihjdXJyZW50LT5kb21haW4sIGluZm8uZ21mbiwgTlVM
TCwgUDJNX0FMTE9DKTsKKyAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGN1cnJlbnQt
PmRvbWFpbiwgX2dmbihpbmZvLmdtZm4pLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgTlVMTCwgUDJNX0FMTE9DKTsKICAgICAgICAgaWYgKCAhcGFnZSApCiAgICAgICAgICAgICBi
cmVhazsKICAgICAgICAgaWYgKCAhZ2V0X3BhZ2VfdHlwZShwYWdlLCBQR1Rfd3JpdGFibGVfcGFn
ZSkgKQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3B2L2Rlc2NyaXB0b3ItdGFibGVzLmMgYi94
ZW4vYXJjaC94ODYvcHYvZGVzY3JpcHRvci10YWJsZXMuYwppbmRleCA5NDA4MDRiMThhLi43YjNm
YjI4MDZhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvcHYvZGVzY3JpcHRvci10YWJsZXMuYwor
KysgYi94ZW4vYXJjaC94ODYvcHYvZGVzY3JpcHRvci10YWJsZXMuYwpAQCAtMTEyLDcgKzExMiw3
IEBAIGxvbmcgcHZfc2V0X2dkdChzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgbG9uZyAqZnJhbWVz
LCB1bnNpZ25lZCBpbnQgZW50cmllcykKICAgICB7CiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8g
KnBhZ2U7CiAKLSAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGQsIGZyYW1lc1tpXSwg
TlVMTCwgUDJNX0FMTE9DKTsKKyAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGQsIF9n
Zm4oZnJhbWVzW2ldKSwgTlVMTCwgUDJNX0FMTE9DKTsKICAgICAgICAgaWYgKCAhcGFnZSApCiAg
ICAgICAgICAgICBnb3RvIGZhaWw7CiAgICAgICAgIGlmICggIWdldF9wYWdlX3R5cGUocGFnZSwg
UEdUX3NlZ19kZXNjX3BhZ2UpICkKQEAgLTIxOSw3ICsyMTksNyBAQCBsb25nIGRvX3VwZGF0ZV9k
ZXNjcmlwdG9yKHVpbnQ2NF90IGdhZGRyLCBzZWdfZGVzY190IGQpCiAgICAgaWYgKCAhSVNfQUxJ
R05FRChnYWRkciwgc2l6ZW9mKGQpKSB8fCAhY2hlY2tfZGVzY3JpcHRvcihjdXJyZCwgJmQpICkK
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKLSAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9nZm4o
Y3VycmQsIGdmbl94KGdmbiksIE5VTEwsIFAyTV9BTExPQyk7CisgICAgcGFnZSA9IGdldF9wYWdl
X2Zyb21fZ2ZuKGN1cnJkLCBnZm4sIE5VTEwsIFAyTV9BTExPQyk7CiAgICAgaWYgKCAhcGFnZSAp
CiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvcHYv
ZW11bC1wcml2LW9wLmMgYi94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMKaW5kZXggOGE0
OTA5YmY0Yy4uNzdmZmE3ZmRjZiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3B2L2VtdWwtcHJp
di1vcC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYwpAQCAtNzU2LDEyICs3
NTYsMTIgQEAgc3RhdGljIGludCB3cml0ZV9jcih1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBs
b25nIHZhbCwKICAgICBjYXNlIDM6IC8qIFdyaXRlIENSMyAqLwogICAgIHsKICAgICAgICAgc3Ry
dWN0IGRvbWFpbiAqY3VycmQgPSBjdXJyLT5kb21haW47Ci0gICAgICAgIHVuc2lnbmVkIGxvbmcg
Z2ZuOworICAgICAgICBnZm5fdCBnZm47CiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2U7
CiAgICAgICAgIGludCByYzsKIAotICAgICAgICBnZm4gPSAhaXNfcHZfMzJiaXRfZG9tYWluKGN1
cnJkKQotICAgICAgICAgICAgICA/IHhlbl9jcjNfdG9fcGZuKHZhbCkgOiBjb21wYXRfY3IzX3Rv
X3Bmbih2YWwpOworICAgICAgICBnZm4gPSBfZ2ZuKCFpc19wdl8zMmJpdF9kb21haW4oY3VycmQp
CisgICAgICAgICAgICAgICAgICAgPyB4ZW5fY3IzX3RvX3Bmbih2YWwpIDogY29tcGF0X2NyM190
b19wZm4odmFsKSk7CiAgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihjdXJyZCwgZ2Zu
LCBOVUxMLCBQMk1fQUxMT0MpOwogICAgICAgICBpZiAoICFwYWdlICkKICAgICAgICAgICAgIGJy
ZWFrOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3B2L21tLmMgYi94ZW4vYXJjaC94ODYvcHYv
bW0uYwppbmRleCBmNWVhMDBjYTRlLi5jOWFkMTE1MmI0IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94
ODYvcHYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvcHYvbW0uYwpAQCAtMTA2LDcgKzEwNiw3IEBA
IGJvb2wgcHZfbWFwX2xkdF9zaGFkb3dfcGFnZSh1bnNpZ25lZCBpbnQgb2Zmc2V0KQogICAgIGlm
ICggdW5saWtlbHkoIShsMWVfZ2V0X2ZsYWdzKGdsMWUpICYgX1BBR0VfUFJFU0VOVCkpICkKICAg
ICAgICAgcmV0dXJuIGZhbHNlOwogCi0gICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGN1cnJk
LCBsMWVfZ2V0X3BmbihnbDFlKSwgTlVMTCwgUDJNX0FMTE9DKTsKKyAgICBwYWdlID0gZ2V0X3Bh
Z2VfZnJvbV9nZm4oY3VycmQsIF9nZm4obDFlX2dldF9wZm4oZ2wxZSkpLCBOVUxMLCBQMk1fQUxM
T0MpOwogICAgIGlmICggdW5saWtlbHkoIXBhZ2UpICkKICAgICAgICAgcmV0dXJuIGZhbHNlOwog
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvdHJhcHMuYyBiL3hlbi9hcmNoL3g4Ni90cmFwcy5j
CmluZGV4IDIzMDY5ZTI1ZWMuLmQ4ZjgwNzBhYzkgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni90
cmFwcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni90cmFwcy5jCkBAIC04MDMsNyArODAzLDcgQEAgaW50
IGd1ZXN0X3dybXNyX3hlbihzdHJ1Y3QgdmNwdSAqdiwgdWludDMyX3QgaWR4LCB1aW50NjRfdCB2
YWwpCiAgICAgY2FzZSAwOiAvKiBXcml0ZSBoeXBlcmNhbGwgcGFnZSAqLwogICAgIHsKICAgICAg
ICAgdm9pZCAqaHlwZXJjYWxsX3BhZ2U7Ci0gICAgICAgIHVuc2lnbmVkIGxvbmcgZ21mbiA9IHZh
bCA+PiBQQUdFX1NISUZUOworICAgICAgICBnZm5fdCBnZm4gPSBnYWRkcl90b19nZm4odmFsKTsK
ICAgICAgICAgdW5zaWduZWQgaW50IHBhZ2VfaW5kZXggPSB2YWwgJiAoUEFHRV9TSVpFIC0gMSk7
CiAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2U7CiAgICAgICAgIHAybV90eXBlX3QgdDsK
QEAgLTgxNiw3ICs4MTYsNyBAQCBpbnQgZ3Vlc3Rfd3Jtc3JfeGVuKHN0cnVjdCB2Y3B1ICp2LCB1
aW50MzJfdCBpZHgsIHVpbnQ2NF90IHZhbCkKICAgICAgICAgICAgIHJldHVybiBYODZFTVVMX0VY
Q0VQVElPTjsKICAgICAgICAgfQogCi0gICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihk
LCBnbWZuLCAmdCwgUDJNX0FMTE9DKTsKKyAgICAgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2Zu
KGQsIGdmbiwgJnQsIFAyTV9BTExPQyk7CiAKICAgICAgICAgaWYgKCAhcGFnZSB8fCAhZ2V0X3Bh
Z2VfdHlwZShwYWdlLCBQR1Rfd3JpdGFibGVfcGFnZSkgKQogICAgICAgICB7CkBAIC04MjUsMTMg
KzgyNSwxNCBAQCBpbnQgZ3Vlc3Rfd3Jtc3JfeGVuKHN0cnVjdCB2Y3B1ICp2LCB1aW50MzJfdCBp
ZHgsIHVpbnQ2NF90IHZhbCkKIAogICAgICAgICAgICAgaWYgKCBwMm1faXNfcGFnaW5nKHQpICkK
ICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICBwMm1fbWVtX3BhZ2luZ19wb3B1bGF0ZShk
LCBnbWZuKTsKKyAgICAgICAgICAgICAgICBwMm1fbWVtX3BhZ2luZ19wb3B1bGF0ZShkLCBnZm5f
eChnZm4pKTsKICAgICAgICAgICAgICAgICByZXR1cm4gWDg2RU1VTF9SRVRSWTsKICAgICAgICAg
ICAgIH0KIAogICAgICAgICAgICAgZ2RwcmludGsoWEVOTE9HX1dBUk5JTkcsCi0gICAgICAgICAg
ICAgICAgICAgICAiQmFkIEdNRk4gJWx4IChNRk4gJSMiUFJJX21mbiIpIHRvIE1TUiAlMDh4XG4i
LAotICAgICAgICAgICAgICAgICAgICAgZ21mbiwgbWZuX3gocGFnZSA/IHBhZ2VfdG9fbWZuKHBh
Z2UpIDogSU5WQUxJRF9NRk4pLCBiYXNlKTsKKyAgICAgICAgICAgICAgICAgICAgICJCYWQgR0ZO
ICUjIlBSSV9nZm4iIChNRk4gJSMiUFJJX21mbiIpIHRvIE1TUiAlMDh4XG4iLAorICAgICAgICAg
ICAgICAgICAgICAgZ2ZuX3goZ2ZuKSwgbWZuX3gocGFnZSA/IHBhZ2VfdG9fbWZuKHBhZ2UpIDog
SU5WQUxJRF9NRk4pLAorICAgICAgICAgICAgICAgICAgICAgYmFzZSk7CiAgICAgICAgICAgICBy
ZXR1cm4gWDg2RU1VTF9FWENFUFRJT047CiAgICAgICAgIH0KIApkaWZmIC0tZ2l0IGEveGVuL2Nv
bW1vbi9kb21haW4uYyBiL3hlbi9jb21tb24vZG9tYWluLmMKaW5kZXggNzQ0YjU3MjE5NS4uZThm
NmRmYmRmMSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9kb21haW4uYworKysgYi94ZW4vY29tbW9u
L2RvbWFpbi5jCkBAIC0xMjk5LDcgKzEyOTksNyBAQCBpbnQgbWFwX3ZjcHVfaW5mbyhzdHJ1Y3Qg
dmNwdSAqdiwgdW5zaWduZWQgbG9uZyBnZm4sIHVuc2lnbmVkIG9mZnNldCkKICAgICBpZiAoICh2
ICE9IGN1cnJlbnQpICYmICEodi0+cGF1c2VfZmxhZ3MgJiBWUEZfZG93bikgKQogICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsKIAotICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihkLCBnZm4sIE5V
TEwsIFAyTV9BTExPQyk7CisgICAgcGFnZSA9IGdldF9wYWdlX2Zyb21fZ2ZuKGQsIF9nZm4oZ2Zu
KSwgTlVMTCwgUDJNX0FMTE9DKTsKICAgICBpZiAoICFwYWdlICkKICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7CiAKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vZXZlbnRfZmlmby5jIGIveGVuL2NvbW1v
bi9ldmVudF9maWZvLmMKaW5kZXggMjMwZjQ0MGYxNC4uMDczOTgxYWI0MyAxMDA2NDQKLS0tIGEv
eGVuL2NvbW1vbi9ldmVudF9maWZvLmMKKysrIGIveGVuL2NvbW1vbi9ldmVudF9maWZvLmMKQEAg
LTM2MSw3ICszNjEsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGV2dGNobl9wb3J0X29wcyBldnRj
aG5fcG9ydF9vcHNfZmlmbyA9CiAgICAgLnByaW50X3N0YXRlICAgPSBldnRjaG5fZmlmb19wcmlu
dF9zdGF0ZSwKIH07CiAKLXN0YXRpYyBpbnQgbWFwX2d1ZXN0X3BhZ2Uoc3RydWN0IGRvbWFpbiAq
ZCwgdWludDY0X3QgZ2ZuLCB2b2lkICoqdmlydCkKK3N0YXRpYyBpbnQgbWFwX2d1ZXN0X3BhZ2Uo
c3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2ZuLCB2b2lkICoqdmlydCkKIHsKICAgICBzdHJ1Y3Qg
cGFnZV9pbmZvICpwOwogCkBAIC00MjIsNyArNDIyLDcgQEAgc3RhdGljIGludCBzZXR1cF9jb250
cm9sX2Jsb2NrKHN0cnVjdCB2Y3B1ICp2KQogICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IG1hcF9jb250cm9sX2Jsb2NrKHN0cnVjdCB2Y3B1ICp2LCB1aW50NjRfdCBnZm4sIHVpbnQzMl90
IG9mZnNldCkKK3N0YXRpYyBpbnQgbWFwX2NvbnRyb2xfYmxvY2soc3RydWN0IHZjcHUgKnYsIGdm
bl90IGdmbiwgdWludDMyX3Qgb2Zmc2V0KQogewogICAgIHZvaWQgKnZpcnQ7CiAgICAgdW5zaWdu
ZWQgaW50IGk7CkBAIC01MDgsNyArNTA4LDcgQEAgaW50IGV2dGNobl9maWZvX2luaXRfY29udHJv
bChzdHJ1Y3QgZXZ0Y2huX2luaXRfY29udHJvbCAqaW5pdF9jb250cm9sKQogewogICAgIHN0cnVj
dCBkb21haW4gKmQgPSBjdXJyZW50LT5kb21haW47CiAgICAgdWludDMyX3QgdmNwdV9pZDsKLSAg
ICB1aW50NjRfdCBnZm47CisgICAgZ2ZuX3QgZ2ZuOwogICAgIHVpbnQzMl90IG9mZnNldDsKICAg
ICBzdHJ1Y3QgdmNwdSAqdjsKICAgICBpbnQgcmM7CkBAIC01MTYsNyArNTE2LDcgQEAgaW50IGV2
dGNobl9maWZvX2luaXRfY29udHJvbChzdHJ1Y3QgZXZ0Y2huX2luaXRfY29udHJvbCAqaW5pdF9j
b250cm9sKQogICAgIGluaXRfY29udHJvbC0+bGlua19iaXRzID0gRVZUQ0hOX0ZJRk9fTElOS19C
SVRTOwogCiAgICAgdmNwdV9pZCA9IGluaXRfY29udHJvbC0+dmNwdTsKLSAgICBnZm4gICAgID0g
aW5pdF9jb250cm9sLT5jb250cm9sX2dmbjsKKyAgICBnZm4gICAgID0gX2dmbihpbml0X2NvbnRy
b2wtPmNvbnRyb2xfZ2ZuKTsKICAgICBvZmZzZXQgID0gaW5pdF9jb250cm9sLT5vZmZzZXQ7CiAK
ICAgICBpZiAoICh2ID0gZG9tYWluX3ZjcHUoZCwgdmNwdV9pZCkpID09IE5VTEwgKQpAQCAtNTc4
LDcgKzU3OCw3IEBAIGludCBldnRjaG5fZmlmb19pbml0X2NvbnRyb2woc3RydWN0IGV2dGNobl9p
bml0X2NvbnRyb2wgKmluaXRfY29udHJvbCkKICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBp
bnQgYWRkX3BhZ2VfdG9fZXZlbnRfYXJyYXkoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9u
ZyBnZm4pCitzdGF0aWMgaW50IGFkZF9wYWdlX3RvX2V2ZW50X2FycmF5KHN0cnVjdCBkb21haW4g
KmQsIGdmbl90IGdmbikKIHsKICAgICB2b2lkICp2aXJ0OwogICAgIHVuc2lnbmVkIGludCBzbG90
OwpAQCAtNjI4LDcgKzYyOCw3IEBAIGludCBldnRjaG5fZmlmb19leHBhbmRfYXJyYXkoY29uc3Qg
c3RydWN0IGV2dGNobl9leHBhbmRfYXJyYXkgKmV4cGFuZF9hcnJheSkKICAgICAgICAgcmV0dXJu
IC1FT1BOT1RTVVBQOwogCiAgICAgc3Bpbl9sb2NrKCZkLT5ldmVudF9sb2NrKTsKLSAgICByYyA9
IGFkZF9wYWdlX3RvX2V2ZW50X2FycmF5KGQsIGV4cGFuZF9hcnJheS0+YXJyYXlfZ2ZuKTsKKyAg
ICByYyA9IGFkZF9wYWdlX3RvX2V2ZW50X2FycmF5KGQsIF9nZm4oZXhwYW5kX2FycmF5LT5hcnJh
eV9nZm4pKTsKICAgICBzcGluX3VubG9jaygmZC0+ZXZlbnRfbG9jayk7CiAKICAgICByZXR1cm4g
cmM7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL21lbW9yeS5jIGIveGVuL2NvbW1vbi9tZW1vcnku
YwppbmRleCBkOWIzNWE2MDhjLi4yNjM0YThiNzYyIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL21l
bW9yeS5jCisrKyBiL3hlbi9jb21tb24vbWVtb3J5LmMKQEAgLTEzOTMsNyArMTM5Myw3IEBAIGxv
bmcgZG9fbWVtb3J5X29wKHVuc2lnbmVkIGxvbmcgY21kLCBYRU5fR1VFU1RfSEFORExFX1BBUkFN
KHZvaWQpIGFyZykKICAgICAgICAgICAgIHJldHVybiByYzsKICAgICAgICAgfQogCi0gICAgICAg
IHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihkLCB4cmZwLmdwZm4sIE5VTEwsIFAyTV9BTExPQyk7
CisgICAgICAgIHBhZ2UgPSBnZXRfcGFnZV9mcm9tX2dmbihkLCBfZ2ZuKHhyZnAuZ3BmbiksIE5V
TEwsIFAyTV9BTExPQyk7CiAgICAgICAgIGlmICggcGFnZSApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIHJjID0gZ3Vlc3RfcGh5c21hcF9yZW1vdmVfcGFnZShkLCBfZ2ZuKHhyZnAuZ3BmbiksCkBA
IC0xNjY0LDcgKzE2NjQsNyBAQCBpbnQgY2hlY2tfZ2V0X3BhZ2VfZnJvbV9nZm4oc3RydWN0IGRv
bWFpbiAqZCwgZ2ZuX3QgZ2ZuLCBib29sIHJlYWRvbmx5LAogICAgIHAybV90eXBlX3QgcDJtdDsK
ICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOwogCi0gICAgcGFnZSA9IGdldF9wYWdlX2Zyb21f
Z2ZuKGQsIGdmbl94KGdmbiksICZwMm10LCBxKTsKKyAgICBwYWdlID0gZ2V0X3BhZ2VfZnJvbV9n
Zm4oZCwgZ2ZuLCAmcDJtdCwgcSk7CiAKICNpZmRlZiBDT05GSUdfSEFTX01FTV9QQUdJTkcKICAg
ICBpZiAoIHAybV9pc19wYWdpbmcocDJtdCkgKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNt
LWFybS9wMm0uaCBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vcDJtLmgKaW5kZXggMDNmMmVlNzVjMS4u
NWU1MDU5NmZjYiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLWFybS9wMm0uaAorKysgYi94
ZW4vaW5jbHVkZS9hc20tYXJtL3AybS5oCkBAIC0yOTgsNyArMjk4LDcgQEAgc3RydWN0IHBhZ2Vf
aW5mbyAqcDJtX2dldF9wYWdlX2Zyb21fZ2ZuKHN0cnVjdCBkb21haW4gKmQsIGdmbl90IGdmbiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1fdHlwZV90ICp0KTsK
IAogc3RhdGljIGlubGluZSBzdHJ1Y3QgcGFnZV9pbmZvICpnZXRfcGFnZV9mcm9tX2dmbigKLSAg
ICBzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbiwgcDJtX3R5cGVfdCAqdCwgcDJt
X3F1ZXJ5X3QgcSkKKyAgICBzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIHAybV90eXBlX3Qg
KnQsIHAybV9xdWVyeV90IHEpCiB7CiAgICAgbWZuX3QgbWZuOwogICAgIHAybV90eXBlX3QgX3Q7
CkBAIC0zMDksNyArMzA5LDcgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgcGFnZV9pbmZvICpnZXRf
cGFnZV9mcm9tX2dmbigKICAgICAgKiBub3QgYXV0by10cmFuc2xhdGVkLgogICAgICAqLwogICAg
IGlmICggbGlrZWx5KGQgIT0gZG9tX3hlbikgKQotICAgICAgICByZXR1cm4gcDJtX2dldF9wYWdl
X2Zyb21fZ2ZuKGQsIF9nZm4oZ2ZuKSwgdCk7CisgICAgICAgIHJldHVybiBwMm1fZ2V0X3BhZ2Vf
ZnJvbV9nZm4oZCwgZ2ZuLCB0KTsKIAogICAgIGlmICggIXQgKQogICAgICAgICB0ID0gJl90OwpA
QCAtMzIwLDcgKzMyMCw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHBhZ2VfaW5mbyAqZ2V0X3Bh
Z2VfZnJvbV9nZm4oCiAgICAgICogRE9NSURfWEVOIHNlZXMgMS0xIFJBTS4gVGhlIHAybV90eXBl
IGlzIGJhc2VkIG9uIHRoZSB0eXBlIG9mIHRoZQogICAgICAqIHBhZ2UuCiAgICAgICovCi0gICAg
bWZuID0gX21mbihnZm4pOworICAgIG1mbiA9IF9tZm4oZ2ZuX3goZ2ZuKSk7CiAgICAgcGFnZSA9
IG1mbl90b19wYWdlKG1mbik7CiAKICAgICBpZiAoICFtZm5fdmFsaWQobWZuKSB8fCAhZ2V0X3Bh
Z2UocGFnZSwgZCkgKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wMm0uaCBiL3hl
bi9pbmNsdWRlL2FzbS14ODYvcDJtLmgKaW5kZXggOTQyODVkYjFiNC4uZmY0NTI4YmFmOSAxMDA2
NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9wMm0uaAorKysgYi94ZW4vaW5jbHVkZS9hc20t
eDg2L3AybS5oCkBAIC00OTEsMTggKzQ5MSwyNiBAQCBzdHJ1Y3QgcGFnZV9pbmZvICpwMm1fZ2V0
X3BhZ2VfZnJvbV9nZm4oc3RydWN0IHAybV9kb21haW4gKnAybSwgZ2ZuX3QgZ2ZuLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9xdWVyeV90IHEpOwogCiBzdGF0
aWMgaW5saW5lIHN0cnVjdCBwYWdlX2luZm8gKmdldF9wYWdlX2Zyb21fZ2ZuKAotICAgIHN0cnVj
dCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLCBwMm1fdHlwZV90ICp0LCBwMm1fcXVlcnlf
dCBxKQorICAgIHN0cnVjdCBkb21haW4gKmQsIGdmbl90IGdmbiwgcDJtX3R5cGVfdCAqdCwgcDJt
X3F1ZXJ5X3QgcSkKIHsKICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOworICAgIG1mbl90IG1m
bjsKIAogICAgIGlmICggcGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkKLSAgICAgICAgcmV0dXJu
IHAybV9nZXRfcGFnZV9mcm9tX2dmbihwMm1fZ2V0X2hvc3RwMm0oZCksIF9nZm4oZ2ZuKSwgdCwg
TlVMTCwgcSk7CisgICAgICAgIHJldHVybiBwMm1fZ2V0X3BhZ2VfZnJvbV9nZm4ocDJtX2dldF9o
b3N0cDJtKGQpLCBnZm4sIHQsIE5VTEwsIHEpOwogCiAgICAgLyogTm9uLXRyYW5zbGF0ZWQgZ3Vl
c3RzIHNlZSAxLTEgUkFNIC8gTU1JTyBtYXBwaW5ncyBldmVyeXdoZXJlICovCiAgICAgaWYgKCB0
ICkKICAgICAgICAgKnQgPSBsaWtlbHkoZCAhPSBkb21faW8pID8gcDJtX3JhbV9ydyA6IHAybV9t
bWlvX2RpcmVjdDsKLSAgICBwYWdlID0gbWZuX3RvX3BhZ2UoX21mbihnZm4pKTsKLSAgICByZXR1
cm4gbWZuX3ZhbGlkKF9tZm4oZ2ZuKSkgJiYgZ2V0X3BhZ2UocGFnZSwgZCkgPyBwYWdlIDogTlVM
TDsKKworICAgIG1mbiA9IF9tZm4oZ2ZuX3goZ2ZuKSk7CisKKyAgICBpZiAoICFtZm5fdmFsaWQo
bWZuKSApCisgICAgICAgIHJldHVybiBOVUxMOworCisgICAgcGFnZSA9IG1mbl90b19wYWdlKG1m
bik7CisKKyAgICByZXR1cm4gZ2V0X3BhZ2UocGFnZSwgZCkgPyBwYWdlIDogTlVMTDsKIH0KIAog
LyogR2VuZXJhbCBjb252ZXJzaW9uIGZ1bmN0aW9uIGZyb20gbWZuIHRvIGdmbiAqLwotLSAKMi4x
MS4wCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVu
LWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6
Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

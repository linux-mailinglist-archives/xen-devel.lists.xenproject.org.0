Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D85B3BC4D4
	for <lists+xen-devel@lfdr.de>; Tue, 24 Sep 2019 11:29:06 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iCh5d-0003iy-7j; Tue, 24 Sep 2019 09:26:33 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=kqGS=XT=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1iCh5b-0003it-Ko
 for xen-devel@lists.xenproject.org; Tue, 24 Sep 2019 09:26:31 +0000
X-Inumbo-ID: 63cc5788-dead-11e9-9611-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 63cc5788-dead-11e9-9611-12813bfff9fa;
 Tue, 24 Sep 2019 09:26:30 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 39B5FB9D1;
 Tue, 24 Sep 2019 09:26:29 +0000 (UTC)
To: =?UTF-8?B?SsO8cmdlbiBHcm/Dnw==?= <jgross@suse.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>
References: <20190924074202.4064-1-jgross@suse.com>
 <79c54053-c17b-597a-34bd-3a0e5ac349bb@suse.com>
 <5dd8df47-2fc7-6a44-a688-e39a6f135a28@suse.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <e39d0748-e231-7896-f2a1-a6bf13d14538@suse.com>
Date: Tue, 24 Sep 2019 11:26:28 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <5dd8df47-2fc7-6a44-a688-e39a6f135a28@suse.com>
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH] xen/sched: don't let XEN_RUNSTATE_UPDATE
 leak into vcpu_runstate_get()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: xen-devel@lists.xenproject.org, Wei Liu <wl@xen.org>,
 =?UTF-8?Q?Roger_Pau_Monn=c3=a9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

T24gMjQuMDkuMjAxOSAxMTowMywgSsO8cmdlbiBHcm/DnyB3cm90ZToKPiBPbiAyNC4wOS4xOSAx
MDozOSwgSmFuIEJldWxpY2ggd3JvdGU6Cj4+IE9uIDI0LjA5LjIwMTkgMDk6NDIsIEp1ZXJnZW4g
R3Jvc3Mgd3JvdGU6Cj4+PiB2Y3B1X3J1bnN0YXRlX2dldCgpIHNob3VsZCBuZXZlciByZXR1cm4g
YSBzdGF0ZSBlbnRyeSB0aW1lIHdpdGgKPj4+IFhFTl9SVU5TVEFURV9VUERBVEUgc2V0LiBUbyBh
dm9pZCB0aGlzIGxldCB1cGRhdGVfcnVuc3RhdGVfYXJlYSgpCj4+PiBvcGVyYXRlIG9uIGEgbG9j
YWwgcnVuc3RhdGUgY29weS4KPj4+Cj4+PiBUaGlzIHByb2JsZW0gd2FzIGludHJvZHVjZWQgd2l0
aCBjb21taXQgMjUyOWM4NTBlYTQ4ZjAzNiAoImFkZCB1cGRhdGUKPj4+IGluZGljYXRvciB0byB2
Y3B1X3J1bnN0YXRlX2luZm8iKS4KPj4+Cj4+PiBTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+Cj4+Cj4+IFBlcmhhcHMgdGhpcyBhbHNvIHdhbnRzIGEgUmVwb3J0
ZWQtYnkgdGFnPwo+IAo+IFllcy4gVGhhdCB3YXMgQW5kcmV3LCByaWdodD8KCk9oLCBzb3JyeSwg
SSBoYWQgYWN0dWFsbHkgbWVhbnQgdG8gYXNrIGF0IHRoZSBzYW1lIHRpbWU6IFRoZSBtYWlsCmRl
c2NyaWJpbmcgdGhlIGlzc3VlIGNhbWUgZnJvbSBoaW0sIGJ1dCBpdCBzYXlpbmcgIkFmdGVyIGEK
Y29tcGxpY2F0ZWQgaW52ZXN0aWdhdGlvbiIsIGFuZCBiYXNlZCBvbiBwcmlvciBpbnN0YW5jZXMg
SSB3b3VsZG4ndApiZSBjZXJ0YWluIGl0IHdhc24ndCBvbmUgb2YgaGlzIGNvbGxlYWd1ZXMgQ2Mt
ZWQgdGhlcmUgd2hvIGFjdHVhbGx5Cmlzb2xhdGVkIGl0LiBBbmRyZXcsIGNvdWxkIHlvdSBjbGFy
aWZ5PwoKPj4gSW4gcHJpbmNpcGxlIHRoZSBjaGFuZ2UgaXMgZmluZSwgYnV0IEkgd29uZGVyIHdo
ZXRoZXIgeW91J3JlIChhKQo+PiBnb2luZyBhIGxpdHRsZSB0b28gZmFyIGFuZCB0aHVzIHlvdSBh
cmUgKGIpIG1pc3Npbmcgc29tZSBjbGVhbnVwCj4+IHBvdGVudGlhbDoKPj4KPj4+IC0tLSBhL3hl
bi9hcmNoL3g4Ni9kb21haW4uYwo+Pj4gKysrIGIveGVuL2FyY2gveDg2L2RvbWFpbi5jCj4+PiBA
QCAtMTYwMCwyMSArMTYwMCwyNCBAQCBib29sIHVwZGF0ZV9ydW5zdGF0ZV9hcmVhKHN0cnVjdCB2
Y3B1ICp2KQo+Pj4gICAgICAgYm9vbCByYzsKPj4+ICAgICAgIHN0cnVjdCBndWVzdF9tZW1vcnlf
cG9saWN5IHBvbGljeSA9IHsgLm5lc3RlZF9ndWVzdF9tb2RlID0gZmFsc2UgfTsKPj4+ICAgICAg
IHZvaWQgX191c2VyICpndWVzdF9oYW5kbGUgPSBOVUxMOwo+Pj4gKyAgICBzdHJ1Y3QgdmNwdV9y
dW5zdGF0ZV9pbmZvIHJ1bnN0YXRlOwo+Pgo+PiBJIGRvbid0IHRoaW5rIHRoZSBmdWxsIHN0cnVj
dHVyZSBuZWVkcyBjb3B5aW5nLiBZb3UgYWxyZWFkeSB1c2UgLi4uCj4+Cj4+PiAgICAgICBpZiAo
IGd1ZXN0X2hhbmRsZV9pc19udWxsKHJ1bnN0YXRlX2d1ZXN0KHYpKSApCj4+PiAgICAgICAgICAg
cmV0dXJuIHRydWU7Cj4+PiAgIAo+Pj4gICAgICAgdXBkYXRlX2d1ZXN0X21lbW9yeV9wb2xpY3ko
diwgJnBvbGljeSk7Cj4+PiAgIAo+Pj4gKyAgICBtZW1jcHkoJnJ1bnN0YXRlLCAmdi0+cnVuc3Rh
dGUsIHNpemVvZihydW5zdGF0ZSkpOwo+Pj4gKwo+Pj4gICAgICAgaWYgKCBWTV9BU1NJU1Qodi0+
ZG9tYWluLCBydW5zdGF0ZV91cGRhdGVfZmxhZykgKQo+Pj4gICAgICAgewo+Pj4gICAgICAgICAg
IGd1ZXN0X2hhbmRsZSA9IGhhc18zMmJpdF9zaGluZm8odi0+ZG9tYWluKQo+Pj4gICAgICAgICAg
ICAgICA/ICZ2LT5ydW5zdGF0ZV9ndWVzdC5jb21wYXQucC0+c3RhdGVfZW50cnlfdGltZSArIDEK
Pj4+ICAgICAgICAgICAgICAgOiAmdi0+cnVuc3RhdGVfZ3Vlc3QubmF0aXZlLnAtPnN0YXRlX2Vu
dHJ5X3RpbWUgKyAxOwo+Pj4gICAgICAgICAgIGd1ZXN0X2hhbmRsZS0tOwo+Pgo+PiAuLi4gdHJp
Y2tlcnkgdG8gZ2V0IGF0IGp1c3QgdGhlIHN0YXRlX2VudHJ5X3RpbWUgZmllbGQuIEkgdGhpbmsK
Pj4geW91IHdvdWxkIGdldCBhd2F5IHdpdGggbWFraW5nIGEgbG9jYWwgY29weSBvZiBqdXN0IHRo
YXQgb25lLAo+PiB0aHVzIC4uLgo+Pgo+Pj4gLSAgICAgICAgdi0+cnVuc3RhdGUuc3RhdGVfZW50
cnlfdGltZSB8PSBYRU5fUlVOU1RBVEVfVVBEQVRFOwo+Pj4gKyAgICAgICAgcnVuc3RhdGUuc3Rh
dGVfZW50cnlfdGltZSB8PSBYRU5fUlVOU1RBVEVfVVBEQVRFOwo+Pj4gICAgICAgICAgIF9fcmF3
X2NvcHlfdG9fZ3Vlc3QoZ3Vlc3RfaGFuZGxlLAo+Pj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAodm9pZCAqKSgmdi0+cnVuc3RhdGUuc3RhdGVfZW50cnlfdGltZSArIDEpIC0gMSwgMSk7
Cj4+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkICopKCZydW5zdGF0ZS5zdGF0
ZV9lbnRyeV90aW1lICsgMSkgLSAxLCAxKTsKPj4KPj4gLi4uIHJlZHVjaW5nIHRoZSBjb21wbGV4
aXR5IG9mIHRoaXMgYXQgbGVhc3QgYSBsaXR0bGUsIHdoaWxlIC4uLgo+Pgo+Pj4gQEAgLTE2MjIs
MjAgKzE2MjUsMjAgQEAgYm9vbCB1cGRhdGVfcnVuc3RhdGVfYXJlYShzdHJ1Y3QgdmNwdSAqdikK
Pj4+ICAgICAgIHsKPj4+ICAgICAgICAgICBzdHJ1Y3QgY29tcGF0X3ZjcHVfcnVuc3RhdGVfaW5m
byBpbmZvOwo+Pj4gICAKPj4+IC0gICAgICAgIFhMQVRfdmNwdV9ydW5zdGF0ZV9pbmZvKCZpbmZv
LCAmdi0+cnVuc3RhdGUpOwo+Pj4gKyAgICAgICAgWExBVF92Y3B1X3J1bnN0YXRlX2luZm8oJmlu
Zm8sICZydW5zdGF0ZSk7Cj4+PiAgICAgICAgICAgX19jb3B5X3RvX2d1ZXN0KHYtPnJ1bnN0YXRl
X2d1ZXN0LmNvbXBhdCwgJmluZm8sIDEpOwo+Pj4gICAgICAgICAgIHJjID0gdHJ1ZTsKPj4+ICAg
ICAgIH0KPj4+ICAgICAgIGVsc2UKPj4+IC0gICAgICAgIHJjID0gX19jb3B5X3RvX2d1ZXN0KHJ1
bnN0YXRlX2d1ZXN0KHYpLCAmdi0+cnVuc3RhdGUsIDEpICE9Cj4+PiAtICAgICAgICAgICAgIHNp
emVvZih2LT5ydW5zdGF0ZSk7Cj4+PiArICAgICAgICByYyA9IF9fY29weV90b19ndWVzdChydW5z
dGF0ZV9ndWVzdCh2KSwgJnJ1bnN0YXRlLCAxKSAhPQo+Pj4gKyAgICAgICAgICAgICBzaXplb2Yo
cnVuc3RhdGUpOwo+Pgo+PiAuLi4gdGFraW5nIHRoZSBvcHBvcnR1bml0eSB0byBtYWtlIHRoaXMg
dXNlIF9fY29weV90b19ndWVzdF9maWVsZCgpCj4+IChzdG9yaW5nIHN0YXRlX2VudHJ5X3RpbWUg
bGFzdCksIGluIHR1cm4gYWxsb3dpbmcgLi4uCj4+Cj4+PiAgICAgICBpZiAoIGd1ZXN0X2hhbmRs
ZSApCj4+PiAgICAgICB7Cj4+PiAtICAgICAgICB2LT5ydW5zdGF0ZS5zdGF0ZV9lbnRyeV90aW1l
ICY9IH5YRU5fUlVOU1RBVEVfVVBEQVRFOwo+Pj4gKyAgICAgICAgcnVuc3RhdGUuc3RhdGVfZW50
cnlfdGltZSAmPSB+WEVOX1JVTlNUQVRFX1VQREFURTsKPj4+ICAgICAgICAgICBzbXBfd21iKCk7
Cj4+PiAgICAgICAgICAgX19yYXdfY29weV90b19ndWVzdChndWVzdF9oYW5kbGUsCj4+PiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkICopKCZ2LT5ydW5zdGF0ZS5zdGF0ZV9lbnRy
eV90aW1lICsgMSkgLSAxLCAxKTsKPj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZv
aWQgKikoJnJ1bnN0YXRlLnN0YXRlX2VudHJ5X3RpbWUgKyAxKSAtIDEsIDEpOwo+Pj4gICAgICAg
fQo+Pgo+PiAuLi4gdG8gZHJvcCB0aGlzIGFsdG9nZXRoZXIuCj4+Cj4+IFRob3VnaHRzPwo+IAo+
IEhtbSwgSSdtIG5vdCBzdXJlIHRoaXMgd2lsbCBtYWtlIHRoaW5ncyBlYXNpZXIuCj4gCj4gVGhl
IHJlcXVlc3RlZCBzZXF1ZW5jZSBpczoKPiAKPiAtIGNvcHkgdGhlIGJ5dGUgd2l0aCB0aGUgWEVO
X1JVTlNUQVRFX1VQREFURSBiaXQgc2V0IGZpcnN0Cj4gLSBjb3B5IGFsbCBvdGhlciBieXRlcyAo
bm90IGNsZWFyaW5nIHRoZSBYRU5fUlVOU1RBVEVfVVBEQVRFIGJpdCkKPiAtIGNvcHkgdGhlIGJ5
dGUgd2l0aCB0aGUgbm93IGNsZWFyZWQgWEVOX1JVTlNUQVRFX1VQREFURSBiaXQgbGFzdAo+IAo+
IEFuZCB0aGlzIGhhcyB0byB3b3JrIGZvciA2NC0gYW5kIDMyLWJpdCB2YXJpYW50cyBvZiB0aGUg
c3RydWN0dXJlLgo+IAo+IFNvIGRyb3BwaW5nIHRoZSBsYXN0IGh1bmsgaXMgd3JvbmcgYWxyZWFk
eSwKCkZvciBiaWctZW5kaWFuIC0geWVzLiBGb3IgbGl0dGxlIGVuZGlhbiwgaWYgdGhlcmUncyBu
byA2NC1iaXQKc3RvcmUgYXZhaWxhYmxlLCBJIGFncmVlIGFzIHdlbGwuIEJ1dCBBcm0zMiBlLmcu
IGRvZXMgaGF2ZSBhCnN1aXRhYmxlIHN0b3JlIGluc24sIHdoaWNoIGlpcmMgaXMgZXZlbiBhdG9t
aWMgd2hlbiB1c2VkIHdpdGgKYSBzdWZmaWNpZW50bHkgYWxpZ25lZCBtZW1vcnkgYWRkcmVzcy4K
Cj4gYW5kIEkgZG9uJ3QgdGhpbmsgaGF2aW5nCj4gYSBsb2NhbCBjb3B5IG9mIHN0YXRlX2VudHJ5
X3RpbWUgb25seSB3aWxsIG1ha2UgdGhpbmdzIGVhc2llciwgYXMKPiB5b3UnZCBuZWVkIHRvOgo+
IAo+IC0gY29weSB0aGUgYnl0ZSB3aXRoIHRoZSBYRU5fUlVOU1RBVEVfVVBEQVRFIGJpdCBzZXQg
Zmlyc3QKPiAtIGNvcHkgdi0+cnVuc3RhdGUuc3RhdGUKPiAtIGNvcHkgbG9jYWwgcnVuc3RhdGUu
c3RhdGVfZW50cnlfdGltZQo+IC0gY29weSB2LT5ydW5zdGF0ZS50aW1lW10KPiAtIGNvcHkgdGhl
IGJ5dGUgd2l0aCB0aGUgbm93IGNsZWFyZWQgWEVOX1JVTlNUQVRFX1VQREFURSBiaXQgbGFzdAoK
VGhlIHBsYW4gd2FzIHRvIHNpbXBseSBjb3B5IHRoZSBlbnRpcmUgc3RhdGVfZW50cnlfdGltZSBs
YXN0LgpCdXQgeWVzLCBJIGNhbiBzZWUgaG93IHdlIG1pZ2h0IG1ha2UgdG9vIG1hbnkgYXNzdW1w
dGlvbnMgb24KaG93IHRoZSBndWVzdC1jb3B5aW5nIGZ1bmN0aW9ucyB3b3JrLCBvciBkZW1hbmQg
dG9vIG11Y2ggb2YKZXh0cmEgc3BlY2lhbCBjYXNpbmcgdGhlcmUgYnkgYW4gYXJjaGl0ZWN0dXJl
LgoKSSdtIG5vdCBvdmVybHkgaGFwcHkgd2l0aCB0aGUgY3VycmVudCBtb2RlbCwgYnV0IGJhc2Vk
IG9uIHRoZQphYm92ZQpSZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29t
PgoKPiBBbmQgeW91J2QgbmVlZCB0byBzcGVjaWFsIGNhc2UgdGhlIGNvbXBhdCBjYXNlLgoKVGhl
cmUncyBhbHJlYWR5IGEgc3VpdGFibGUgaWYoKSAvIGVsc2UgY292ZXJpbmcgdGhpcy4KCkphbgoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

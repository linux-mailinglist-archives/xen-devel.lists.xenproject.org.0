Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D803B96228
	for <lists+xen-devel@lfdr.de>; Tue, 20 Aug 2019 16:15:10 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i04sk-0000Tf-TH; Tue, 20 Aug 2019 14:13:06 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Xv/m=WQ=amazon.de=prvs=128763efb=wipawel@srs-us1.protection.inumbo.net>)
 id 1i04sj-0000Ta-Qv
 for xen-devel@lists.xen.org; Tue, 20 Aug 2019 14:13:05 +0000
X-Inumbo-ID: a02a6086-c354-11e9-8bf9-12813bfff9fa
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id a02a6086-c354-11e9-8bf9-12813bfff9fa;
 Tue, 20 Aug 2019 14:13:04 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1566310385; x=1597846385;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=bMJ/b0iBWCIKBsty/SNLaDlddrOWfcIq0NopnU6NEZE=;
 b=s15Cqj8N7SS0DJCo4TiuloLJDb7v+iM0O/bsdKzTvYLqBz8M1Jrvu+ju
 4nznswwNIm4aeeSYWT6RG0VI90ucM74OYqxB8Rb2CFwfoWGClcMBoYP9n
 DJCUPyEvr/XcwLrAzkSQRsoYaPtd+SGki3txpHjwzcIM6YqqQj7bPdloj Q=;
X-IronPort-AV: E=Sophos;i="5.64,408,1559520000"; d="scan'208";a="695541694"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-2a-22cc717f.us-west-2.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 20 Aug 2019 14:13:02 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (pdx4-ws-svc-p6-lb7-vlan3.pdx.amazon.com [10.170.41.166])
 by email-inbound-relay-2a-22cc717f.us-west-2.amazon.com (Postfix) with ESMTPS
 id F3E3EA1BB2; Tue, 20 Aug 2019 14:13:01 +0000 (UTC)
Received: from EX13D03EUC003.ant.amazon.com (10.43.164.192) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 20 Aug 2019 14:13:01 +0000
Received: from EX13MTAUWC001.ant.amazon.com (10.43.162.135) by
 EX13D03EUC003.ant.amazon.com (10.43.164.192) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Tue, 20 Aug 2019 14:13:00 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.162.232) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Tue, 20 Aug 2019 14:12:58 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>
Date: Tue, 20 Aug 2019 14:12:40 +0000
Message-ID: <20190820141240.118321-1-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190808125132.10484-1-wipawel@amazon.de>
References: <20190808125132.10484-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [livepatch-build-tools part3 v3 3/3]
 create-diff-object: Strip all undefined entires of known size
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: mpohlack@amazon.de, ross.lagerwall@citrix.com, wipawel@amazon.de,
 konrad.wilk@oracle.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHBhdGNoZWQgRUxGIG9iamVjdCBmaWxlIGNvbnRhaW5zIGFsbCBzZWN0aW9ucyBhbmQgc3lt
Ym9scyBhcwpyZXN1bHRlZCBmcm9tIHRoZSBjb21waWxhdGlvbi4gSG93ZXZlciwgY2VydGFpbiBz
eW1ib2xzIG1heSBub3QgYmUKY29waWVkIG92ZXIgdG8gdGhlIHJlc3VsdGluZyBvYmplY3QgZmls
ZSwgZHVlIHRvIGJlaW5nIHVuY2hhbmdlZCBvcgpub3QgaW5jbHVkZWQgZm9yIG90aGVyIHJlYXNv
bnMuCkluIHN1Y2ggc2l0dWF0aW9uIHRoZSByZXN1bHRpbmcgb2JqZWN0IGZpbGUgaGFzIHRoZSBl
bnRpcmUgc2VjdGlvbnMKY29waWVkIGFsb25nICh3aXRoIGFsbCB0aGVpciBlbnRyaWVzIHVuY2hh
bmdlZCksIHdoaWxlIHNvbWUgb2YgdGhlCmNvcnJlc3BvbmRpbmcgc3ltYm9scyBhcmUgbm90IGNv
cGllZCBhbG9uZyBhdCBhbGwuClRoaXMgbGVhZHMgdG8gaGF2aW5nIGluY29ycmVjdCB1bmRlZmlu
ZWQgKFNUTl9VTkRFRikgZW50cmllcyBpbiB0aGUKZmluYWwgaG90cGF0Y2ggRUxGIGZpbGUuCgpU
aGUgbmV3bHkgYWRkZWQgZnVuY3Rpb24gbGl2ZXBhdGNoX3N0cmlwX3VuZGVmaW5lZF9lbGVtZW50
cygpIGRldGVjdHMKYW5kIHJlbW92ZXMgYWxsIHVuZGVmaW5lZCBSRUxBIGVudHJpZXMgYXMgd2Vs
bCBhcyB0aGVpciBjb3JyZXNwb25kaW5nClBST0dCSVRTIHNlY3Rpb24gZW50cmllcy4KU2luY2Ug
dGhlIHNlY3Rpb25zIG1heSBjb250YWluIGVsZW1lbnRzIG9mIHVua25vd24gc2l6ZSAoc2guc2hf
ZW50c2l6ZQo9PSAwKSwgcGVyZm9ybSB0aGUgc3RyaXAgb25seSBvbiBzZWN0aW9ucyB3aXRoIHdl
bGwgZGVmaW5lZCBlbnRyeQpzaXplcy4KCkFmdGVyIHJlcGxhY2luZyB0aGUgc3RyaXBwZWQgcmVs
YSBsaXN0LCBpdCBpcyBhc3N1bWVkIHRoYXQgdGhlIG5leHQKaW52b2NhdGlvbiBvZiB0aGUga3Bh
dGNoX3JlYnVpbGRfcmVsYV9zZWN0aW9uX2RhdGEoKSB3aWxsIGFkanVzdCBhbGwKc2VjdGlvbiBo
ZWFkZXIgcGFyYW1ldGVycyBhY2NvcmRpbmcgdG8gdGhlIGN1cnJlbnQgc3RhdGUuCgpUaGUgbGl2
ZXBhdGNoX3N0cmlwX3VuZGVmaW5lZF9lbGVtZW50cygpIGlzIGEgc3VwZXJzZXQgb2YgdGhlCmtw
YXRjaF9yZWdlbmVyYXRlX3NwZWNpYWxfc2VjdGlvbigpIGluIGJvdGggc2NvcGUgKGNvdmVycyBh
bGwgUkVMQQpzZWN0aW9ucyBpbnN0ZWFkIG9mIGp1c3Qgc3BlY2lhbCBzZWN0aW9ucykgYW5kIGdy
YW51bGFyaXR5IChjaGVja3MKYWxsIGVudHJpZXMgaW5zdGVhZCBvZiB3aG9sZSBncm91cHMpIG1v
ZHVsbyB0aGUgZW50cmllcyB2YWxpZGl0eQpwcmVkaWNhdGUuClVuaWZ5aW5nIHRoZSBmdW5jdGlv
bnMgcmVzdWx0cyBpbiBhIGNvbXBsaWNhdGVkIGNvZGUsIHdoaWNoIGlzIGhhcmQKdG8gcmVhc29u
IGFib3V0LiBUaHVzLCB0aGUga3BhdGNoX3JlZ2VuZXJhdGVfc3BlY2lhbF9zZWN0aW9uKCkgaXMK
a2VwdCBzZXBhcmF0ZSB3aXRoIGl0cyBvd24gcHJlZGljYXRlIGZvciBzcGVjaWFsIHNlY3Rpb25z
IG9ubHksIGFuZApsaXZlcGF0Y2hfc3RyaXBfdW5kZWZpbmVkX2VsZW1lbnRzKCkgZm9sbG93cyBm
b3IgYWxsIHNlY3Rpb25zIHdpdGgKdGhlIHVuZGVmaW5lZCBzeW1ib2wgZGV0ZWN0aW5nIHByZWRp
Y2F0ZS4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpv
bi5kZT4KUmV2aWV3ZWQtYnk6IE1hcnRpbiBQb2hsYWNrIDxtcG9obGFja0BhbWF6b24uZGU+ClJl
dmlld2VkLWJ5OiBCam9lcm4gRG9lYmVsIDxkb2ViZWxAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTog
Tm9yYmVydCBNYW50aGV5IDxubWFudGhleUBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBBbmRyYS1J
cmluYSBQYXJhc2NoaXYgPGFuZHJhcHJzQGFtYXpvbi5jb20+Ci0tLQp2MzoKKiBBZGRlZCB0byB0
aGUgY29tbWl0IG1lc3NhZ2UgYSByZWFzb24gZm9yIG5lZWRpbmcgdGhlCiAgbGl2ZXBhdGNoX3N0
cmlwX3VuZGVmaW5lZF9lbGVtZW50cygpIGluIGFkZGl0aW9uIHRvCiAga3BhdGNoX3JlZ2VuZXJh
dGVfc3BlY2lhbF9zZWN0aW9uKCkKdjI6CiogS2VwdCBsaW5lcyBsaW1pdHMgdG8gODAgY2hhcnMg
KHdoZXJlZXZlciBwb3NzaWJsZSkKKiBGaXhlZCBjb21taXQgbWVzc2FnZQotLS0KIGNyZWF0ZS1k
aWZmLW9iamVjdC5jIHwgMTMxICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrLQogMSBmaWxlIGNoYW5nZWQsIDEyOSBpbnNlcnRpb25zKCspLCAyIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2NyZWF0ZS1kaWZmLW9iamVjdC5jIGIvY3JlYXRlLWRpZmYt
b2JqZWN0LmMKaW5kZXggMWM4NGY4MS4uZjAxZjFkYSAxMDA2NDQKLS0tIGEvY3JlYXRlLWRpZmYt
b2JqZWN0LmMKKysrIGIvY3JlYXRlLWRpZmYtb2JqZWN0LmMKQEAgLTE1NjAsNiArMTU2MCwxMyBA
QCBzdGF0aWMgaW5saW5lIGludCBnZXRfc2VjdGlvbl9lbnRyeV9zaXplKGNvbnN0IHN0cnVjdCBz
ZWN0aW9uICpzZWMsCiAJcmV0dXJuIGVudHJ5X3NpemU7CiB9CiAKKy8qIENoZWNrIGlmIFJFTEEg
ZW50cnkgaGFzIHVuZGVmaW5lZCBvciB1bmNoYW5nZWQvbm90LWluY2x1ZGVkIHN5bWJvbHMuICov
CitzdGF0aWMgaW5saW5lIGJvb2wgaGFzX3JlbGFfdW5kZWZpbmVkX3N5bWJvbChjb25zdCBzdHJ1
Y3QgcmVsYSAqcmVsYSkKK3sKKwlyZXR1cm4gKEdFTEZfUl9TWU0ocmVsYS0+cmVsYS5yX2luZm8p
ID09IFNUTl9VTkRFRikgfHwKKwkgICAgICAgKCFyZWxhLT5zeW0tPmluY2x1ZGUgJiYgKHJlbGEt
PnN5bS0+c3RhdHVzID09IFNBTUUpKTsKK30KKwogc3RhdGljIGludCBrcGF0Y2hfc2VjdGlvbl9o
YXNfdW5kZWZfc3ltYm9scyhzdHJ1Y3Qga3BhdGNoX2VsZiAqa2VsZiwKIAkJCQkJICAgIGNvbnN0
IHN0cnVjdCBzZWN0aW9uICpzZWMpCiB7CkBAIC0xNTc5LDggKzE1ODYsNyBAQCBzdGF0aWMgaW50
IGtwYXRjaF9zZWN0aW9uX2hhc191bmRlZl9zeW1ib2xzKHN0cnVjdCBrcGF0Y2hfZWxmICprZWxm
LAogCQkJCWNvbnRpbnVlOwogCQkJfQogCi0JCQlpZiAoKEdFTEZfUl9TWU0ocmVsYS0+cmVsYS5y
X2luZm8pID09IFNUTl9VTkRFRikgfHwKLQkJCSAgICAoIXJlbGEtPnN5bS0+aW5jbHVkZSAmJiBy
ZWxhLT5zeW0tPnN0YXR1cyA9PSBTQU1FKSkgeworCQkJaWYgKGhhc19yZWxhX3VuZGVmaW5lZF9z
eW1ib2wocmVsYSkpIHsKIAkJCQlsb2dfbm9ybWFsKCJzZWN0aW9uICVzIGhhcyBhbiBlbnRyeSB3
aXRoIGFuIHVuZGVmaW5lZCBzeW1ib2w6ICVzXG4iLAogCQkJCQkgICBzZWMtPm5hbWUsIHJlbGEt
PnN5bS0+bmFtZSA/OiAibm9uZSIpOwogCQkJCXJldHVybiB0cnVlOwpAQCAtMTk5NCw2ICsyMDAw
LDEyNSBAQCBzdGF0aWMgdm9pZCBsaXZlcGF0Y2hfY3JlYXRlX3BhdGNoZXNfc2VjdGlvbnMoc3Ry
dWN0IGtwYXRjaF9lbGYgKmtlbGYsCiAKIH0KIAorLyoKKyAqIFRoZSBwYXRjaGVkIEVMRiBvYmpl
Y3QgZmlsZSBjb250YWlucyBhbGwgc2VjdGlvbnMgYW5kIHN5bWJvbHMgYXMgcmVzdWx0ZWQKKyAq
IGZyb20gdGhlIGNvbXBpbGF0aW9uLiBIb3dldmVyLCBjZXJ0YWluIHN5bWJvbHMgbWF5IG5vdCBi
ZSBjb3BpZWQgb3ZlciB0bworICogdGhlIHJlc3VsdGluZyBvYmplY3QgZmlsZSwgZHVlIHRvIGJl
aW5nIHVuY2hhbmdlZCBvciBub3QgaW5jbHVkZWQgZm9yIG90aGVyCisgKiByZWFzb25zLgorICog
SW4gc3VjaCBzaXR1YXRpb24gdGhlIHJlc3VsdGluZyBvYmplY3QgZmlsZSBoYXMgdGhlIGVudGly
ZSBzZWN0aW9ucyBjb3BpZWQKKyAqIGFsb25nICh3aXRoIGFsbCB0aGVpciBlbnRyaWVzIHVuY2hh
bmdlZCksIHdoaWxlIHNvbWUgb2YgdGhlIGNvcnJlc3BvbmRpbmcKKyAqIHN5bWJvbHMgYXJlIG5v
dCBjb3BpZWQgYWxvbmcgYXQgYWxsLgorICogVGhpcyBsZWFkcyB0byBoYXZpbmcgaW5jb3JyZWN0
IGR1bW15IChTVE5fVU5ERUYpIGVudHJpZXMgaW4gdGhlIGZpbmFsCisgKiBob3RwYXRjaCBFTEYg
ZmlsZS4KKyAqIFRoaXMgZnVuY3Rpb25zIHJlbW92ZXMgYWxsIHVuZGVmaW5lZCBlbnRyaWVzIG9m
IGtub3duIHNpemUgZnJvbSBib3RoCisgKiBSRUxBIGFuZCBQUk9HQklUUyBzZWN0aW9ucyBvZiB0
aGUgcGF0Y2hlZCBlbGYgb2JqZWN0LgorICovCitzdGF0aWMgdm9pZCBsaXZlcGF0Y2hfc3RyaXBf
dW5kZWZpbmVkX2VsZW1lbnRzKHN0cnVjdCBrcGF0Y2hfZWxmICprZWxmKQoreworCXN0cnVjdCBz
ZWN0aW9uICpzZWM7CisKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHNlYywgJmtlbGYtPnNlY3Rpb25z
LCBsaXN0KSB7CisJCXN0cnVjdCByZWxhICpyZWxhLCAqc2FmZTsKKwkJaW50IHNyY19vZmZzZXQg
PSAwLCBkc3Rfb2Zmc2V0ID0gMDsKKwkJaW50IGVudHJ5X3NpemUsIGFsaWduLCBhbGlnbmVkX3Np
emU7CisJCWNoYXIgKnNyYywgKmRzdDsKKwkJTElTVF9IRUFEKG5ld3JlbGFzKTsKKworCQkvKiB1
c2UgUkVMQSBzZWN0aW9uIHRvIGZpbmQgYWxsIGl0cyB1bmRlZmluZWQgZW50cmllcyAqLworCQlp
ZiAoIWlzX3JlbGFfc2VjdGlvbihzZWMpKQorCQkJY29udGludWU7CisKKwkJLyogb25seSBrbm93
biwgZml4ZWQtc2l6ZSBlbnRyaWVzIGNhbiBiZSBzdHJpcHBlZCAqLworCQllbnRyeV9zaXplID0g
Z2V0X3NlY3Rpb25fZW50cnlfc2l6ZShzZWMtPmJhc2UsIGtlbGYpOworCQlpZiAoZW50cnlfc2l6
ZSA9PSAwKQorCQkJY29udGludWU7CisKKwkJLyogYWxsb2MgYnVmZmVyIGZvciBuZXcgYmFzZSBz
ZWN0aW9uICovCisJCWRzdCA9IG1hbGxvYyhzZWMtPmJhc2UtPnNoLnNoX3NpemUpOworCQlpZiAo
IWRzdCkKKwkJCUVSUk9SKCJtYWxsb2MiKTsKKworCQkvKgorCQkgKiBJdGVyYXRlIHRocm91Z2gg
YWxsIGVudHJpZXMgb2YgYSBjb3JyZXNwb25kaW5nIGJhc2Ugc2VjdGlvbgorCQkgKiBmb3IgdGhp
cyBSRUxBIHNlY3Rpb24uCisJCSAqLworCQlmb3IgKCBzcmMgPSBzZWMtPmJhc2UtPmRhdGEtPmRf
YnVmOworCQkgICAgICBzcmNfb2Zmc2V0IDwgc2VjLT5iYXNlLT5zaC5zaF9zaXplOworCQkgICAg
ICBzcmNfb2Zmc2V0ICs9IGVudHJ5X3NpemUgKSB7CisJCQlib29sIGZvdW5kX3ZhbGlkID0gZmFs
c2U7CisKKwkJCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShyZWxhLCBzYWZlLCAmc2VjLT5yZWxh
cywgbGlzdCkgeworCQkJCS8qCisJCQkJICogQ2hlY2sgYWxsIFJFTEEgZWxlbWVudHMgbG9va2lu
ZyBmb3IKKwkJCQkgKiBjb3JyZXNwb25kaW5nIGVudHJ5IHJlZmVyZW5jZXMuCisJCQkJICovCisJ
CQkJaWYgKHJlbGEtPm9mZnNldCA8IHNyY19vZmZzZXQgfHwKKwkJCQkgICAgcmVsYS0+b2Zmc2V0
ID49IHNyY19vZmZzZXQgKyBlbnRyeV9zaXplKSB7CisJCQkJCWNvbnRpbnVlOworCQkJCX0KKwor
CQkJCS8qCisJCQkJICogSWdub3JlIGFsbCB1bmRlZmluZWQgKFNUTl9VTkRFRikgb3IKKwkJCQkg
KiB1bmNoYW5nZWQvbm90LWluY2x1ZGVkIGVsZW1lbnRzLgorCQkJCSAqLworCQkJCWlmIChoYXNf
cmVsYV91bmRlZmluZWRfc3ltYm9sKHJlbGEpKSB7CisJCQkJCWxvZ19ub3JtYWwoIkZvdW5kIGEg
U1ROX1VOREVGIHN5bWJvbCAlcyBpbiBzZWN0aW9uICVzXG4iLAorCQkJCQkJICAgcmVsYS0+c3lt
LT5uYW1lLCBzZWMtPm5hbWUpOworCQkJCQljb250aW51ZTsKKwkJCQl9CisKKwkJCQkvKgorCQkJ
CSAqIEEgY29ycmVjdCBtYXRjaCBoYXMgYmVlbiBmb3VuZCwgc28gbW92ZSBpdAorCQkJCSAqIHRv
IGEgbmV3IGxpc3QuIE9yaWdpbmFsIGxpc3Qgd2lsbCBiZSBkZXN0cm95ZWQKKwkJCQkgKiBhbG9u
ZyB3aXRoIHRoZSBlbnRpcmUga2VsZiBvYmplY3QsIHNvIHRoZQorCQkJCSAqIHJlZmVyZW5jZSBt
dXN0IGJlIHByZXNlcnZlZC4KKwkJCQkgKi8KKwkJCQlmb3VuZF92YWxpZCA9IHRydWU7CisJCQkJ
bGlzdF9kZWwoJnJlbGEtPmxpc3QpOworCQkJCWxpc3RfYWRkX3RhaWwoJnJlbGEtPmxpc3QsICZu
ZXdyZWxhcyk7CisKKwkJCQlyZWxhLT5vZmZzZXQgLT0gc3JjX29mZnNldCAtIGRzdF9vZmZzZXQ7
CisJCQkJcmVsYS0+cmVsYS5yX29mZnNldCA9IHJlbGEtPm9mZnNldDsKKwkJCX0KKworCQkJLyog
dGhlcmUgaXMgYSB2YWxpZCBSRUxBIGVudHJ5LCBzbyBjb3B5IGN1cnJlbnQgZW50cnkgKi8KKwkJ
CWlmIChmb3VuZF92YWxpZCkgeworCQkJCS8qIGNvcHkgYmFzZSBzZWN0aW9uIGdyb3VwICovCisJ
CQkJbWVtY3B5KGRzdCArIGRzdF9vZmZzZXQsIHNyYyArIHNyY19vZmZzZXQsIGVudHJ5X3NpemUp
OworCQkJCWRzdF9vZmZzZXQgKz0gZW50cnlfc2l6ZTsKKwkJCX0KKwkJfQorCisJCS8qIHZlcmlm
eSB0aGF0IGVudHJ5X3NpemUgaXMgYSBkaXZpc29yIG9mIGFsaWduZWQgc2VjdGlvbiBzaXplICov
CisJCWFsaWduID0gc2VjLT5iYXNlLT5zaC5zaF9hZGRyYWxpZ247CisJCWFsaWduZWRfc2l6ZSA9
ICgoc2VjLT5iYXNlLT5zaC5zaF9zaXplICsgYWxpZ24gLSAxKSAvIGFsaWduKSAqIGFsaWduOwor
CQlpZiAoc3JjX29mZnNldCAhPSBhbGlnbmVkX3NpemUpIHsKKwkJCUVSUk9SKCJncm91cCBzaXpl
IG1pc21hdGNoIGZvciBzZWN0aW9uICVzXG4iLAorCQkJICAgICAgc2VjLT5iYXNlLT5uYW1lKTsK
KwkJfQorCisJCWlmICghZHN0X29mZnNldCkgeworCQkJLyogbm8gY2hhbmdlZCBvciBnbG9iYWwg
ZnVuY3Rpb25zIHJlZmVyZW5jZWQgKi8KKwkJCXNlYy0+c3RhdHVzID0gc2VjLT5iYXNlLT5zdGF0
dXMgPSBTQU1FOworCQkJc2VjLT5pbmNsdWRlID0gc2VjLT5iYXNlLT5pbmNsdWRlID0gMDsKKwkJ
CWZyZWUoZHN0KTsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJLyogb3ZlcndyaXRlIHdpdGggbmV3
IHJlbGFzIGxpc3QgKi8KKwkJbGlzdF9yZXBsYWNlKCZuZXdyZWxhcywgJnNlYy0+cmVsYXMpOwor
CisJCS8qCisJCSAqIFVwZGF0ZSB0ZXh0IHNlY3Rpb24gZGF0YSBidWYgYW5kIHNpemUuCisJCSAq
CisJCSAqIFRoZSByZWxhIHNlY3Rpb24ncyBkYXRhIGJ1ZiBhbmQgc2l6ZSB3aWxsIGJlCisJCSAq
IHJlZ2VuZXJhdGVkIGluIGtwYXRjaF9yZWJ1aWxkX3JlbGFfc2VjdGlvbl9kYXRhKCkuCisJCSAq
LworCQlzZWMtPmJhc2UtPmRhdGEtPmRfYnVmID0gZHN0OworCQlzZWMtPmJhc2UtPmRhdGEtPmRf
c2l6ZSA9IGRzdF9vZmZzZXQ7CisJfQorfQorCiBzdGF0aWMgaW50IGlzX251bGxfc3ltKHN0cnVj
dCBzeW1ib2wgKnN5bSkKIHsKIAlyZXR1cm4gIXN0cmxlbihzeW0tPm5hbWUpOwpAQCAtMjE5MCw2
ICsyMzE1LDggQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAogCWxvZ19kZWJ1
ZygiUHJvY2VzcyBzcGVjaWFsIHNlY3Rpb25zXG4iKTsKIAlrcGF0Y2hfcHJvY2Vzc19zcGVjaWFs
X3NlY3Rpb25zKGtlbGZfcGF0Y2hlZCk7CisJbG9nX2RlYnVnKCJTdHJpcCB1bmRlZmluZWQgZWxl
bWVudHMgb2Yga25vd24gc2l6ZVxuIik7CisJbGl2ZXBhdGNoX3N0cmlwX3VuZGVmaW5lZF9lbGVt
ZW50cyhrZWxmX3BhdGNoZWQpOwogCWxvZ19kZWJ1ZygiVmVyaWZ5IHBhdGNoYWJpbGl0eVxuIik7
CiAJa3BhdGNoX3ZlcmlmeV9wYXRjaGFiaWxpdHkoa2VsZl9wYXRjaGVkKTsKIAotLSAKMi4xNi41
CgoKCgpBbWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkgR21iSApLcmF1c2Vuc3RyLiAz
OAoxMDExNyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJpc3RpYW4gU2NobGFlZ2VyLCBS
YWxmIEhlcmJyaWNoCkVpbmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVu
dGVyIEhSQiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3IDg3OQoKCgoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

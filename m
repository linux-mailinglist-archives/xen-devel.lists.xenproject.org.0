Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D0D25B372B
	for <lists+xen-devel@lfdr.de>; Mon, 16 Sep 2019 11:31:25 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9nI2-0002n4-Il; Mon, 16 Sep 2019 09:27:22 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=aiU4=XL=citrix.com=paul.durrant@srs-us1.protection.inumbo.net>)
 id 1i9nI0-0002mz-Og
 for xen-devel@lists.xenproject.org; Mon, 16 Sep 2019 09:27:20 +0000
X-Inumbo-ID: 2d89d992-d864-11e9-b76c-bc764e2007e4
Received: from esa3.hc3370-68.iphmx.com (unknown [216.71.145.155])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 2d89d992-d864-11e9-b76c-bc764e2007e4;
 Mon, 16 Sep 2019 09:27:18 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1568626039;
 h=from:to:cc:subject:date:message-id:mime-version:
 content-transfer-encoding;
 bh=d/jnG3SrPD+z5+KwQ7z+nA5c1/FTXUEVf8OlgBjlKxI=;
 b=acyZLZ5a0oEkBPQXqOehfeJ+rI3iI1VnG12/xkqro9oFmh3W2mivXB20
 uDBRSwhi3rJutycOlq92dWH4TOuxoXpFP7VPDpD5qpVUCSGkz/mgMm9X9
 8jf0/zSu4HAxtVc2psHxKcIZPQbaVfGWpOK5cyRmdCuEoGRdXNsWDs25r g=;
Authentication-Results: esa3.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=paul.durrant@citrix.com;
 spf=Pass smtp.mailfrom=Paul.Durrant@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 paul.durrant@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="paul.durrant@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa3.hc3370-68.iphmx.com: domain of
 Paul.Durrant@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="Paul.Durrant@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="Paul.Durrant@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: ggpI9fG8Guk7bZDChxFApGu80nhJ2CeSPCkB7mVh5sLnc7LXmgm13HGjIk5yka6uSsue4bPnsj
 lzqJmQAluiYei6l1OiPFbLMW/gfv6u++S8qXcWQCtnxXGP9KzdUB5Aofkt2Jh5PshsZivsUWbb
 V8QdZlb2n2BtTUttOMl3X/u7WnIOX1LPttSWNzZZBTNgttYF0twKcPfbMQxGfKzfE7MRIbQSnS
 y1tV+hhE0Z5cwbusHzfkXyR6YIH/SKFrray76TkgZk3M3+7bOMPn0WhuvDAjexu6o1j0RbrIsr
 wKw=
X-SBRS: 2.7
X-MesageID: 5603033
X-Ironport-Server: esa3.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,512,1559534400"; 
   d="scan'208";a="5603033"
From: Paul Durrant <paul.durrant@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Mon, 16 Sep 2019 10:27:08 +0100
Message-ID: <20190916092708.2624-1-paul.durrant@citrix.com>
X-Mailer: git-send-email 2.20.1.2.gb21ebb671
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v12 6/6] introduce a 'passthrough' configuration
 option to xl.cfg...
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim
 Deegan <tim@xen.org>, Julien Grall <julien.grall@arm.com>,
 Paul Durrant <paul.durrant@citrix.com>,
 Christian Lindig <christian.lindig@citrix.com>,
 Jan Beulich <jbeulich@suse.com>, David Scott <dave@recoil.org>,
 Anthony PERARD <anthony.perard@citrix.com>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Li4uYW5kIGhlbmNlIHRoZSBhYmlsaXR5IHRvIGRpc2FibGUgSU9NTVUgbWFwcGluZ3MsIGFuZCBj
b250cm9sIEVQVApzaGFyaW5nLgoKVGhpcyBwYXRjaCBpbnRyb2R1Y2VzIGEgbmV3ICdsaWJ4bF9w
YXNzdGhyb3VnaCcgZW51bWVyYXRpb24gaW50bwpsaWJ4bF9kb21haW5fY3JlYXRlX2luZm8uIFRo
ZSB2YWx1ZSB3aWxsIGJlIHNldCBieSB4bCBlaXRoZXIgd2hlbiBpdCBwYXJzZXMKYSBuZXcgJ3Bh
c3N0aHJvdWdoJyBvcHRpb24gaW4geGwuY2ZnLCBvciBpbXBsaWNpdGx5IGlmIHRoZXJlIGlzIHBh
c3N0aHJvdWdoCmhhcmR3YXJlIHNwZWNpZmllZCBmb3IgdGhlIGRvbWFpbi4KCklmIHRoZSB2YWx1
ZSBvZiB0aGUgcGFzc3Rocm91Z2ggY29uZmlndXJhdGlvbiBvcHRpb24gaXMgJ2Rpc2FibGVkJyB0
aGVuCnRoZSBYRU5fRE9NQ1RMX0NERl9pb21tdSBmbGFnIHdpbGwgYmUgY2xlYXIgaW4gdGhlIHhl
bl9kb21jdGxfY3JlYXRlZG9tYWluCmZsYWdzLCB0aHVzIGFsbG93aW5nIHRoZSB0b29sc3RhY2sg
dG8gY29udHJvbCB3aGV0aGVyIHRoZSBkb21haW4gZ2V0cwpJT01NVSBtYXBwaW5ncyBvciBub3Qg
KHdoZXJlIHByZXZpb3VzbHkgdGhleSB3ZXJlIGdsb2JhbGx5IHNldCkuCgpJZiB0aGUgdmFsdWUg
b2YgdGhlIHBhc3N0aHJvdWdoIGNvbmZpZ3VyYXRpb24gb3B0aW9uIGlzICdzeW5jX3B0JyB0aGVu
CmEgbmV3ICdpb21tdV9vcHRzJyBmaWVsZCBpbiB4ZW5fZG9tY3RsX2NyZWF0ZWRvbWFpbiB3aWxs
IGJlIHNldCB3aXRoIHRoZQp2YWx1ZSBYRU5fRE9NQ1RMX0lPTU1VX25vX3NoYXJlcHQuIFRoaXMg
d2lsbCBvdmVycmlkZSB0aGUgZ2xvYmFsIGRlZmF1bHQKc2V0IGluIGlvbW11X2hhcF9wdF9zaGFy
ZSwgdGh1cyBhbGxvd2luZyB0aGUgdG9vbHN0YWNrIHRvIGNvbnRyb2wgd2hldGhlcgpFUFQgc2hh
cmluZyBpcyB1c2VkIGZvciB0aGUgZG9tYWluLgoKSWYgdGhlIHZhbHVlIG9mIHBhc3N0aHJvdWdo
IGlzICdlbmFibGVkJyB0aGVuIHhsIHdpbGwgY2hvb3NlIGFuIGFwcHJvcHJpYXRlCmRlZmF1bHQg
YWNjb3JkaW5nIHRvIHRoZSB0eXBlIG9mIGRvbWFpbiBhbmQgaGFyZHdhcmUgc3VwcG9ydC4KCk5P
VEU6IFRoZSAnaW9tbXVfbWVta2InIG92ZXJoZWFkIGluIGxpYnhsX2RvbWFpbl9idWlsZF9pbmZv
IHdpbGwgbm93IG9ubHkKICAgICAgYmUgc2V0IGlmIHBhc3N0aHJvdWdoIGlzICdzeW5jX3B0JyAo
b3IgeGwgaGFzIGNob3NlbiB0aGlzIG1vZGUgYXMKICAgICAgYSBkZWZhdWx0KS4KClNpZ25lZC1v
ZmYtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJyYW50QGNpdHJpeC5jb20+ClJldmlld2VkLWJ5
OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkFja2VkLWJ5OiBDaHJpc3RpYW4gTGlu
ZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+Ci0tLQpDYzogSWFuIEphY2tzb24gPGlh
bi5qYWNrc29uQGV1LmNpdHJpeC5jb20+CkNjOiBXZWkgTGl1IDx3bEB4ZW4ub3JnPgpDYzogQW5k
cmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQ2M6IEdlb3JnZSBEdW5sYXAg
PEdlb3JnZS5EdW5sYXBAZXUuY2l0cml4LmNvbT4KQ2M6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdy
YWxsQGFybS5jb20+CkNjOiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNs
ZS5jb20+CkNjOiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CkNj
OiBUaW0gRGVlZ2FuIDx0aW1AeGVuLm9yZz4KQ2M6IEFudGhvbnkgUEVSQVJEIDxhbnRob255LnBl
cmFyZEBjaXRyaXguY29tPgpDYzogRGF2aWQgU2NvdHQgPGRhdmVAcmVjb2lsLm9yZz4KQ2M6IFZv
bG9keW15ciBCYWJjaHVrIDxWb2xvZHlteXJfQmFiY2h1a0BlcGFtLmNvbT4KQ2M6ICJSb2dlciBQ
YXUgTW9ubsOpIiA8cm9nZXIucGF1QGNpdHJpeC5jb20+CgpTZW5kaW5nIGp1c3QgdGhpcyBwYXRj
aCBzaW5jZSB0aGUgcmVzdCBvZiB0aGUgc2VyaWVzIGlzIHVuY2hhbmdlZCBmcm9tCnYxMSguMSku
CgpQcmV2aW91c2x5IHBhcnQgb2Ygc2VyaWVzIGh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcv
YXJjaGl2ZXMvaHRtbC94ZW4tZGV2ZWwvMjAxOS0wNy9tc2cwMjI2Ny5odG1sCgp2MTI6CiAtIFNl
dCBwYXNzdGhyb3VnaCBkZWZhdWx0IGluIGxpYnhsCgp2MTE6CiAtIEZpeGVkIGFiaS1jaGVjayBy
dW5lcwoKdjEwOgogLSBBZGRlZCBhYmktY2hlY2sgcnVuZXMKCnY5OgogLSBBZGRlZCB0aGUgcGFz
c3Rocm91Z2g9J2VuYWJsZWQnIG9wdGlvbiB0byB4bAogLSBPbmUgY29zbWV0aWMgY2hhbmdlIGlu
IHhlbgogLSBBc3N1bWUgSmFuJ3MgUi1iIHN0YW5kcyBzaW5jZSBub24tY29zbWV0aWMgY2hhbmdl
cyBhcmUgb25seSBpbiB0aGUKICAgdG9vbHN0YWNrCgp2NzoKIC0gQWRkZWQgbWlzc2luZyBicmVh
a3MKIC0gQWRkZWQgbWlzc2luZyBvY2FtbCBiaW5kaW5nIGNoYW5nZXMKCnY2OgogLSBSZW1vdmUg
dGhlIGxpYnhsX3BoeXNpbmZvKCkgY2FsbCBzaW5jZSBpdCdzIHVzZWZ1bG5lc3MgaXMgbGltaXRl
ZCB0byB4ODYKCnY1OgogLSBFeHBhbmQgeGVuX2RvbWN0bF9jcmVhdGVkb21haW4gZmxhZ3MgZmll
bGQgYW5kIGhlbmNlIGJ1bXAgaW50ZXJmYWNlCiAgIHZlcnNpb24KIC0gRml4IHNwZWxsaW5nIG1p
c3Rha2VzIGluIGNvbnRleHQgbGluZQotLS0KIGRvY3MvbWFuL3hsLmNmZy41LnBvZC5pbiAgICAg
ICAgICAgIHwgIDU2ICsrKysrKysrKysKIHRvb2xzL2xpYnhsL2xpYnhsLmggICAgICAgICAgICAg
ICAgIHwgICA5ICsrCiB0b29scy9saWJ4bC9saWJ4bF9jcmVhdGUuYyAgICAgICAgICB8ICAyNyAr
KystLQogdG9vbHMvbGlieGwvbGlieGxfdHlwZXMuaWRsICAgICAgICAgfCAgIDcgKysKIHRvb2xz
L29jYW1sL2xpYnMveGMveGVuY3RybC5tbCAgICAgIHwgICA0ICsKIHRvb2xzL29jYW1sL2xpYnMv
eGMveGVuY3RybC5tbGkgICAgIHwgICA1ICsKIHRvb2xzL29jYW1sL2xpYnMveGMveGVuY3RybF9z
dHVicy5jIHwgIDE3ICsrLQogdG9vbHMveGwveGxfcGFyc2UuYyAgICAgICAgICAgICAgICAgfCAx
NTggKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLQogeGVuL2FyY2gvYXJtL2RvbWFpbi5jICAg
ICAgICAgICAgICAgfCAgMTAgKy0KIHhlbi9hcmNoL3g4Ni9kb21haW4uYyAgICAgICAgICAgICAg
IHwgICAyICstCiB4ZW4vY29tbW9uL2RvbWFpbi5jICAgICAgICAgICAgICAgICB8ICAgNyArKwog
eGVuL2NvbW1vbi9kb21jdGwuYyAgICAgICAgICAgICAgICAgfCAgMTMgLS0tCiB4ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9pb21tdS5jICAgICB8ICAxMyArKy0KIHhlbi9pbmNsdWRlL3B1YmxpYy9k
b21jdGwuaCAgICAgICAgIHwgIDEwICstCiB4ZW4vaW5jbHVkZS94ZW4vaW9tbXUuaCAgICAgICAg
ICAgICB8ICAxNSArLS0KIDE1IGZpbGVzIGNoYW5nZWQsIDI2NiBpbnNlcnRpb25zKCspLCA4NyBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kb2NzL21hbi94bC5jZmcuNS5wb2QuaW4gYi9kb2Nz
L21hbi94bC5jZmcuNS5wb2QuaW4KaW5kZXggYzk5ZDQwMzA3ZS4uMTU0ZDg0N2ZiOSAxMDA2NDQK
LS0tIGEvZG9jcy9tYW4veGwuY2ZnLjUucG9kLmluCisrKyBiL2RvY3MvbWFuL3hsLmNmZy41LnBv
ZC5pbgpAQCAtNjA1LDYgKzYwNSw2MiBAQCBvcHRpb24gc2hvdWxkIG9ubHkgYmUgdXNlZCB3aXRo
IGEgdHJ1c3RlZCBkZXZpY2UgdHJlZS4KIE5vdGUgdGhhdCB0aGUgcGFydGlhbCBkZXZpY2UgdHJl
ZSBzaG91bGQgYXZvaWQgdXNpbmcgdGhlIHBoYW5kbGUgNjUwMDAKIHdoaWNoIGlzIHJlc2VydmVk
IGJ5IHRoZSB0b29sc3RhY2suCiAKKz1pdGVtIEI8cGFzc3Rocm91Z2g9IlNUUklORyI+CisKK1Nw
ZWNpZnkgd2hldGhlciBJT01NVSBtYXBwaW5ncyBhcmUgZW5hYmxlZCBmb3IgdGhlIGRvbWFpbiBh
bmQgaGVuY2Ugd2hldGhlcgoraXQgd2lsbCBiZSBlbmFibGVkIGZvciBwYXNzdGhyb3VnaCBoYXJk
d2FyZS4gVmFsaWQgdmFsdWVzIGZvciB0aGlzIG9wdGlvbgorYXJlOgorCis9b3ZlciA0CisKKz1p
dGVtIEI8ZGlzYWJsZWQ+CisKK0lPTU1VIG1hcHBpbmdzIGFyZSBkaXNhYmxlZCBmb3IgdGhlIGRv
bWFpbiBhbmQgc28gaGFyZHdhcmUgbWF5IG5vdCBiZQorcGFzc2VkIHRocm91Z2guCisKK1RoaXMg
b3B0aW9uIGlzIHRoZSBkZWZhdWx0IGlmIG5vIHBhc3N0aHJvdWdoIGhhcmR3YXJlIGlzIHNwZWNp
ZmllZCBpbiB0aGUKK2RvbWFpbidzIGNvbmZpZ3VyYXRpb24uCisKKz1pdGVtIEI8c3luY19wdD4K
KworVGhpcyBvcHRpb24gbWVhbnMgdGhhdCBJT01NVSBtYXBwaW5ncyB3aWxsIGJlIHN5bmNocm9u
aXplZCB3aXRoIHRoZQorZG9tYWluJ3MgUDJNIHRhYmxlIGFzIGZvbGxvd3M6CisKK0ZvciBhIFBW
IGRvbWFpbiwgYWxsIHdyaXRhYmxlIHBhZ2VzIGFzc2lnbmVkIHRvIHRoZSBkb21haW4gYXJlIGlk
ZW50aXR5CittYXBwZWQgYnkgTUZOIGluIHRoZSBJT01NVSBwYWdlIHRhYmxlLiBUaHVzIGEgZGV2
aWNlIGRyaXZlciBydW5uaW5nIGluIHRoZQorZG9tYWluIG1heSBwcm9ncmFtIHBhc3N0aHJvdWdo
IGhhcmR3YXJlIGZvciBETUEgdXNpbmcgTUZOIHZhbHVlcworKGkuZS4gaG9zdC9tYWNoaW5lIGZy
YW1lIG51bWJlcnMpIGxvb2tlZCB1cCBpbiBpdHMgUDJNLgorCitGb3IgYW4gSFZNIGRvbWFpbiwg
YWxsIG5vbi1mb3JlaWduIFJBTSBwYWdlcyBwcmVzZW50IGluIGl0cyBQMk0gd2lsbCBiZQorbWFw
cGVkIGJ5IEdGTiBpbiB0aGUgSU9NTVUgcGFnZSB0YWJsZS4gVGh1cyBhIGRldmljZSBkcml2ZXIg
cnVubmluZyBpbiB0aGUKK2RvbWFpbiBtYXkgcHJvZ3JhbSBwYXNzdGhyb3VnaCBoYXJkd2FyZSB1
c2luZyBHRk4gdmFsdWVzIChpLmUuIGd1ZXN0CitwaHlzaWNhbCBmcmFtZSBudW1iZXJzKSB3aXRo
b3V0IGFueSBmdXJ0aGVyIHRyYW5zbGF0aW9uLgorCitUaGlzIG9wdGlvbiBpcyBub3QgY3VycmVu
dGx5IGF2YWlsYWJsZSBvbiBBcm0uCisKKz1pdGVtIEI8c2hhcmVfcHQ+CisKK1RoaXMgb3B0aW9u
IGlzIHVuYXZhaWxhYmxlIGZvciBhIFBWIGRvbWFpbi4gRm9yIGFuIEhWTSBkb21haW4sIHRoaXMg
b3B0aW9uCittZWFucyB0aGF0IHRoZSBJT01NVSB3aWxsIGJlIHByb2dyYW1tZWQgdG8gZGlyZWN0
bHkgcmVmZXJlbmNlIHRoZSBkb21haW4ncworUDJNIHRhYmxlIGFzIGl0cyBwYWdlIHRhYmxlLiBG
cm9tIHRoZSBwb2ludCBvZiB2aWV3IG9mIGEgZGV2aWNlIGRyaXZlcgorcnVubmluZyBpbiB0aGUg
ZG9tYWluIHRoaXMgaXMgZnVuY3Rpb25hbGx5IGVxdWl2YWxlbnQgdG8gQjxzeW5jX3B0PiBidXQK
K3BsYWNlcyBsZXNzIGxvYWQgb24gdGhlIGh5cGVydmlzb3IgYW5kIHNvIHNob3VsZCBnZW5lcmFs
bHkgYmUgc2VsZWN0ZWQgaW4KK3ByZWZlcmVuY2UuIEhvd2V2ZXIsIHRoZSBhdmFpbGFiaWxpdHkg
b2YgdGhpcyBvcHRpb24gaXMgaGFyZHdhcmUgc3BlY2lmaWMuCitJZiBCPHhsIGluZm8+IHJlcG9y
dHMgQjx2aXJ0X2NhcHM+IGNvbnRhaW5pbmcgQjxpb21tdV9oYXBfcHRfc2hhcmU+IHRoZW4KK3Ro
aXMgb3B0aW9uIG1heSBiZSB1c2VkLgorCis9aXRlbSBCPGVuYWJsZWQ+CisKK1RoaXMgb3B0aW9u
IGVuYWJsZXMgSU9NTVUgbWFwcGluZ3MgYW5kIHNlbGVjdHMgYW4gYXBwcm9wcmlhdGUgZGVmYXVs
dAorb3BlcmF0aW5nIG1vZGUuIEZvciBIVk0gZG9tYWlucyBydW5uaW5nIG9uIHBsYXRmb3JtcyB3
aGVyZSB0aGUgb3B0aW9uIGlzCithdmFpbGFibGUsIHRoaXMgaXMgZXF1aXZhbGVudCB0byBCPHNo
YXJlX3B0Pi4gT3RoZXJ3aXNlLCBhbmQgYWxzbyBmb3IgUFYKK2RvbWFpbnMsIHRoaXMgb3B0aW9u
cyBpcyBlcXVpdmFsZW50IHRvIEI8c3luY19wdD4uCisKK1RoaXMgb3B0aW9uIGlzIHRoZSBkZWZh
dWx0IGlmIHBhc3N0aHJvdWdoIGhhcmR3YXJlIGlzIHNwZWNpZmllZCBpbiB0aGUKK2RvbWFpbidz
IGNvbmZpZ3VyYXRpb24uCisKKz1iYWNrCisKID1iYWNrCiAKID1oZWFkMiBEZXZpY2VzCmRpZmYg
LS1naXQgYS90b29scy9saWJ4bC9saWJ4bC5oIGIvdG9vbHMvbGlieGwvbGlieGwuaAppbmRleCAx
MjU0NTEzMGRmLi5lNGI5YzUzOWI2IDEwMDY0NAotLS0gYS90b29scy9saWJ4bC9saWJ4bC5oCisr
KyBiL3Rvb2xzL2xpYnhsL2xpYnhsLmgKQEAgLTQxNSw2ICs0MTUsMTUgQEAKICAqLwogI2RlZmlu
ZSBMSUJYTF9IQVZFX0JVSUxESU5GT19JT01NVV9NRU1LQiAxCiAKKy8qCisgKiBMSUJYTF9IQVZF
X0NSRUFURUlORk9fUEFTU1RIUk9VR0ggaW5kaWNhdGVzIHRoYXQKKyAqIGxpYnhsX2RvbWFpbl9j
cmVhdGVfaW5mbyBoYXMgYSBwYXNzdGhyb3VnaCBmaWVsZCAod2hpY2ggaXMgYQorICogbGlieGxf
cGFzc3Rocm91Z2ggZW51bWVyYXRpb24pIHRoYXQgaW5kaWNhdGVzIHdoZXRoZXIgZGV2aWNlIHBh
c3MtCisgKiB0aHJvdWdoIGlzIGVuYWJsZWQgZm9yIHRoZSBkb21haW4gYW5kLCBpZiBzbywgd2hl
dGhlciB0aGUgSU9NTVUgYW5kCisgKiBIQVAgcGFnZSB0YWJsZXMgbWF5IGJlIHNoYXJlZCBvciBu
b3QuCisgKi8KKyNkZWZpbmUgTElCWExfSEFWRV9DUkVBVEVJTkZPX1BBU1NUSFJPVUdIIDEKKwog
LyoKICAqIGxpYnhsIEFCSSBjb21wYXRpYmlsaXR5CiAgKgpkaWZmIC0tZ2l0IGEvdG9vbHMvbGli
eGwvbGlieGxfY3JlYXRlLmMgYi90b29scy9saWJ4bC9saWJ4bF9jcmVhdGUuYwppbmRleCA1OWRi
Y2I1MGEwLi43YWZhZTgxNDMyIDEwMDY0NAotLS0gYS90b29scy9saWJ4bC9saWJ4bF9jcmVhdGUu
YworKysgYi90b29scy9saWJ4bC9saWJ4bF9jcmVhdGUuYwpAQCAtMzAsNiArMzAsMTIgQEAKIGlu
dCBsaWJ4bF9fZG9tYWluX2NyZWF0ZV9pbmZvX3NldGRlZmF1bHQobGlieGxfX2djICpnYywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfZG9tYWluX2NyZWF0
ZV9pbmZvICpjX2luZm8pCiB7CisgICAgbGlieGxfcGh5c2luZm8gaW5mbzsKKyAgICBpbnQgcmMg
PSBsaWJ4bF9nZXRfcGh5c2luZm8oQ1RYLCAmaW5mbyk7CisKKyAgICBpZiAocmMpCisgICAgICAg
ICAgICByZXR1cm4gcmM7CisKICAgICBpZiAoIWNfaW5mby0+dHlwZSkgewogICAgICAgICBMT0co
RVJST1IsICJkb21haW4gdHlwZSB1bnNwZWNpZmllZCIpOwogICAgICAgICByZXR1cm4gRVJST1Jf
SU5WQUw7CkBAIC0zOCwxMiArNDQsNiBAQCBpbnQgbGlieGxfX2RvbWFpbl9jcmVhdGVfaW5mb19z
ZXRkZWZhdWx0KGxpYnhsX19nYyAqZ2MsCiAgICAgbGlieGxfX2FyY2hfZG9tYWluX2NyZWF0ZV9p
bmZvX3NldGRlZmF1bHQoZ2MsIGNfaW5mbyk7CiAKICAgICBpZiAoY19pbmZvLT50eXBlICE9IExJ
QlhMX0RPTUFJTl9UWVBFX1BWKSB7Ci0gICAgICAgIGxpYnhsX3BoeXNpbmZvIGluZm87Ci0gICAg
ICAgIGludCByYyA9IGxpYnhsX2dldF9waHlzaW5mbyhDVFgsICZpbmZvKTsKLQotICAgICAgICBp
ZiAocmMpCi0gICAgICAgICAgICByZXR1cm4gcmM7Ci0KICAgICAgICAgaWYgKGluZm8uY2FwX2hh
cCkKICAgICAgICAgICAgIGxpYnhsX2RlZmJvb2xfc2V0ZGVmYXVsdCgmY19pbmZvLT5oYXAsIHRy
dWUpOwogICAgICAgICBlbHNlIGlmIChpbmZvLmNhcF9zaGFkb3cpCkBAIC02Miw2ICs2MiwxMiBA
QCBpbnQgbGlieGxfX2RvbWFpbl9jcmVhdGVfaW5mb19zZXRkZWZhdWx0KGxpYnhsX19nYyAqZ2Ms
CiAgICAgaWYgKCFjX2luZm8tPnNzaWRyZWYpCiAgICAgICAgIGNfaW5mby0+c3NpZHJlZiA9IFNF
Q0lOSVRTSURfRE9NVTsKIAorICAgIGlmIChpbmZvLmNhcF9odm1fZGlyZWN0aW8pIHsKKyAgICAg
ICAgY19pbmZvLT5wYXNzdGhyb3VnaCA9ICgoY19pbmZvLT50eXBlID09IExJQlhMX0RPTUFJTl9U
WVBFX1BWKSB8fAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFpbmZvLmNhcF9pb21t
dV9oYXBfcHRfc2hhcmUpID8KKyAgICAgICAgICAgIExJQlhMX1BBU1NUSFJPVUdIX1NZTkNfUFQg
OiBMSUJYTF9QQVNTVEhST1VHSF9TSEFSRV9QVDsKKyAgICB9CisKICAgICByZXR1cm4gMDsKIH0K
IApAQCAtNTc4LDYgKzU4NCwxNSBAQCBpbnQgbGlieGxfX2RvbWFpbl9tYWtlKGxpYnhsX19nYyAq
Z2MsIGxpYnhsX2RvbWFpbl9jb25maWcgKmRfY29uZmlnLAogICAgICAgICAgICAgICAgIGxpYnhs
X2RlZmJvb2xfdmFsKGluZm8tPm9vcykgPyAwIDogWEVOX0RPTUNUTF9DREZfb29zX29mZjsKICAg
ICAgICAgfQogCisgICAgICAgIExPRyhERVRBSUwsICJwYXNzdGhyb3VnaDogJXMiLAorICAgICAg
ICAgICAgbGlieGxfcGFzc3Rocm91Z2hfdG9fc3RyaW5nKGluZm8tPnBhc3N0aHJvdWdoKSk7CisK
KyAgICAgICAgaWYgKGluZm8tPnBhc3N0aHJvdWdoICE9IExJQlhMX1BBU1NUSFJPVUdIX0RJU0FC
TEVEKQorICAgICAgICAgICAgY3JlYXRlLmZsYWdzIHw9IFhFTl9ET01DVExfQ0RGX2lvbW11Owor
CisgICAgICAgIGlmIChpbmZvLT5wYXNzdGhyb3VnaCA9PSBMSUJYTF9QQVNTVEhST1VHSF9TWU5D
X1BUKQorICAgICAgICAgICAgY3JlYXRlLmlvbW11X29wdHMgfD0gWEVOX0RPTUNUTF9JT01NVV9u
b19zaGFyZXB0OworCiAgICAgICAgIC8qIFVsdGltYXRlbHksIGhhbmRsZSBpcyBhbiBhcnJheSBv
ZiAxNiB1aW50OF90LCBzYW1lIGFzIHV1aWQgKi8KICAgICAgICAgbGlieGxfdXVpZF9jb3B5KGN0
eCwgKGxpYnhsX3V1aWQgKikmY3JlYXRlLmhhbmRsZSwgJmluZm8tPnV1aWQpOwogCmRpZmYgLS1n
aXQgYS90b29scy9saWJ4bC9saWJ4bF90eXBlcy5pZGwgYi90b29scy9saWJ4bC9saWJ4bF90eXBl
cy5pZGwKaW5kZXggZDUyYzYzYjZiMC4uMjJmMDU3MTFlMyAxMDA2NDQKLS0tIGEvdG9vbHMvbGli
eGwvbGlieGxfdHlwZXMuaWRsCisrKyBiL3Rvb2xzL2xpYnhsL2xpYnhsX3R5cGVzLmlkbApAQCAt
MjYzLDYgKzI2MywxMiBAQCBsaWJ4bF92a2JfYmFja2VuZCA9IEVudW1lcmF0aW9uKCJ2a2JfYmFj
a2VuZCIsIFsKICAgICAoMiwgIkxJTlVYIikKICAgICBdKQogCitsaWJ4bF9wYXNzdGhyb3VnaCA9
IEVudW1lcmF0aW9uKCJwYXNzdGhyb3VnaCIsIFsKKyAgICAoMCwgImRpc2FibGVkIiksCisgICAg
KDEsICJzeW5jX3B0IiksCisgICAgKDIsICJzaGFyZV9wdCIpLAorICAgIF0pCisKICMKICMgQ29t
cGxleCBsaWJ4bCB0eXBlcwogIwpAQCAtNDA4LDYgKzQxNCw3IEBAIGxpYnhsX2RvbWFpbl9jcmVh
dGVfaW5mbyA9IFN0cnVjdCgiZG9tYWluX2NyZWF0ZV9pbmZvIixbCiAgICAgKCJwb29sX25hbWUi
LCAgICBzdHJpbmcpLAogICAgICgicnVuX2hvdHBsdWdfc2NyaXB0cyIsbGlieGxfZGVmYm9vbCks
CiAgICAgKCJkcml2ZXJfZG9tYWluIixsaWJ4bF9kZWZib29sKSwKKyAgICAoInBhc3N0aHJvdWdo
IiwgIGxpYnhsX3Bhc3N0aHJvdWdoKSwKICAgICBdLCBkaXI9RElSX0lOKQogCiBsaWJ4bF9kb21h
aW5fcmVzdG9yZV9wYXJhbXMgPSBTdHJ1Y3QoImRvbWFpbl9yZXN0b3JlX3BhcmFtcyIsIFsKZGlm
ZiAtLWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveGMveGVuY3RybC5tbCBiL3Rvb2xzL29jYW1sL2xp
YnMveGMveGVuY3RybC5tbAppbmRleCBkZTRiYWU2MDEyLi5lMDBhNzRkNDhkIDEwMDY0NAotLS0g
YS90b29scy9vY2FtbC9saWJzL3hjL3hlbmN0cmwubWwKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94
Yy94ZW5jdHJsLm1sCkBAIC02NSwxMSArNjUsMTUgQEAgdHlwZSBkb21haW5fY3JlYXRlX2ZsYWcg
PQogCXwgQ0RGX1hTX0RPTUFJTgogCXwgQ0RGX0lPTU1VCiAKK3R5cGUgZG9tYWluX2NyZWF0ZV9p
b21tdV9vcHRzID0KKwl8IElPTU1VX05PX1NIQVJFUFQKKwogdHlwZSBkb21jdGxfY3JlYXRlX2Nv
bmZpZyA9CiB7CiAJc3NpZHJlZjogaW50MzI7CiAJaGFuZGxlOiBzdHJpbmc7CiAJZmxhZ3M6IGRv
bWFpbl9jcmVhdGVfZmxhZyBsaXN0OworCWlvbW11X29wdHM6IGRvbWFpbl9jcmVhdGVfaW9tbXVf
b3B0cyBsaXN0OwogCW1heF92Y3B1czogaW50OwogCW1heF9ldnRjaG5fcG9ydDogaW50OwogCW1h
eF9ncmFudF9mcmFtZXM6IGludDsKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveGMveGVu
Y3RybC5tbGkgYi90b29scy9vY2FtbC9saWJzL3hjL3hlbmN0cmwubWxpCmluZGV4IGM4ODVlNzU4
OTUuLjBlNzA0OWQ3MDggMTAwNjQ0Ci0tLSBhL3Rvb2xzL29jYW1sL2xpYnMveGMveGVuY3RybC5t
bGkKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yy94ZW5jdHJsLm1saQpAQCAtNTcsMTAgKzU3LDE1
IEBAIHR5cGUgZG9tYWluX2NyZWF0ZV9mbGFnID0KICAgfCBDREZfT09TX09GRgogICB8IENERl9Y
U19ET01BSU4KICAgfCBDREZfSU9NTVUKKwordHlwZSBkb21haW5fY3JlYXRlX2lvbW11X29wdHMg
PQorICB8IElPTU1VX05PX1NIQVJFUFQKKwogdHlwZSBkb21jdGxfY3JlYXRlX2NvbmZpZyA9IHsK
ICAgc3NpZHJlZjogaW50MzI7CiAgIGhhbmRsZTogc3RyaW5nOwogICBmbGFnczogZG9tYWluX2Ny
ZWF0ZV9mbGFnIGxpc3Q7CisgIGlvbW11X29wdHM6IGRvbWFpbl9jcmVhdGVfaW9tbXVfb3B0cyBs
aXN0OwogICBtYXhfdmNwdXM6IGludDsKICAgbWF4X2V2dGNobl9wb3J0OiBpbnQ7CiAgIG1heF9n
cmFudF9mcmFtZXM6IGludDsKZGlmZiAtLWdpdCBhL3Rvb2xzL29jYW1sL2xpYnMveGMveGVuY3Ry
bF9zdHVicy5jIGIvdG9vbHMvb2NhbWwvbGlicy94Yy94ZW5jdHJsX3N0dWJzLmMKaW5kZXggMGNk
ZDg3MzU5OS4uNDhmMzlmODFkNSAxMDA2NDQKLS0tIGEvdG9vbHMvb2NhbWwvbGlicy94Yy94ZW5j
dHJsX3N0dWJzLmMKKysrIGIvdG9vbHMvb2NhbWwvbGlicy94Yy94ZW5jdHJsX3N0dWJzLmMKQEAg
LTE5MCwxMSArMTkwLDEyIEBAIENBTUxwcmltIHZhbHVlIHN0dWJfeGNfZG9tYWluX2NyZWF0ZSh2
YWx1ZSB4Y2gsIHZhbHVlIGNvbmZpZykKICNkZWZpbmUgVkFMX1NTSURSRUYgICAgICAgICAgICAg
RmllbGQoY29uZmlnLCAwKQogI2RlZmluZSBWQUxfSEFORExFICAgICAgICAgICAgICBGaWVsZChj
b25maWcsIDEpCiAjZGVmaW5lIFZBTF9GTEFHUyAgICAgICAgICAgICAgIEZpZWxkKGNvbmZpZywg
MikKLSNkZWZpbmUgVkFMX01BWF9WQ1BVUyAgICAgICAgICAgRmllbGQoY29uZmlnLCAzKQotI2Rl
ZmluZSBWQUxfTUFYX0VWVENITl9QT1JUICAgICBGaWVsZChjb25maWcsIDQpCi0jZGVmaW5lIFZB
TF9NQVhfR1JBTlRfRlJBTUVTICAgIEZpZWxkKGNvbmZpZywgNSkKLSNkZWZpbmUgVkFMX01BWF9N
QVBUUkFDS19GUkFNRVMgRmllbGQoY29uZmlnLCA2KQotI2RlZmluZSBWQUxfQVJDSCAgICAgICAg
ICAgICAgICBGaWVsZChjb25maWcsIDcpCisjZGVmaW5lIFZBTF9JT01NVV9PUFRTICAgICAgICAg
IEZpZWxkKGNvbmZpZywgMykKKyNkZWZpbmUgVkFMX01BWF9WQ1BVUyAgICAgICAgICAgRmllbGQo
Y29uZmlnLCA0KQorI2RlZmluZSBWQUxfTUFYX0VWVENITl9QT1JUICAgICBGaWVsZChjb25maWcs
IDUpCisjZGVmaW5lIFZBTF9NQVhfR1JBTlRfRlJBTUVTICAgIEZpZWxkKGNvbmZpZywgNikKKyNk
ZWZpbmUgVkFMX01BWF9NQVBUUkFDS19GUkFNRVMgRmllbGQoY29uZmlnLCA3KQorI2RlZmluZSBW
QUxfQVJDSCAgICAgICAgICAgICAgICBGaWVsZChjb25maWcsIDgpCiAKIAl1aW50MzJfdCBkb21p
ZCA9IDA7CiAJaW50IHJlc3VsdDsKQEAgLTIxMyw2ICsyMTQsMTEgQEAgQ0FNTHByaW0gdmFsdWUg
c3R1Yl94Y19kb21haW5fY3JlYXRlKHZhbHVlIHhjaCwgdmFsdWUgY29uZmlnKQogCQkvKiAhIFhF
Tl9ET01DVExfQ0RGXyBYRU5fRE9NQ1RMX0NERl9NQVggbWF4ICovCiAJCShWQUxfRkxBR1MpOwog
CisJY2ZnLmlvbW11X29wdHMgPSBvY2FtbF9saXN0X3RvX2NfYml0bWFwCisJCS8qICEgZG9tYWlu
X2NyZWF0ZV9pb21tdV9vcHRzIElPTU1VXyBsYyAqLworCQkvKiAhIFhFTl9ET01DVExfSU9NTVVf
IFhFTl9ET01DVExfSU9NTVVfTUFYIG1heCAqLworCQkoVkFMX0lPTU1VX09QVFMpOworCiAJYXJj
aF9kb21jb25maWcgPSBGaWVsZChWQUxfQVJDSCwgMCk7CiAJc3dpdGNoICggVGFnX3ZhbChWQUxf
QVJDSCkgKQogCXsKQEAgLTI0Nyw2ICsyNTMsNyBAQCBDQU1McHJpbSB2YWx1ZSBzdHViX3hjX2Rv
bWFpbl9jcmVhdGUodmFsdWUgeGNoLCB2YWx1ZSBjb25maWcpCiAjdW5kZWYgVkFMX01BWF9HUkFO
VF9GUkFNRVMKICN1bmRlZiBWQUxfTUFYX0VWVENITl9QT1JUCiAjdW5kZWYgVkFMX01BWF9WQ1BV
UworI3VuZGVmIFZBTF9JT01NVV9PUFRTCiAjdW5kZWYgVkFMX0ZMQUdTCiAjdW5kZWYgVkFMX0hB
TkRMRQogI3VuZGVmIFZBTF9TU0lEUkVGCmRpZmYgLS1naXQgYS90b29scy94bC94bF9wYXJzZS5j
IGIvdG9vbHMveGwveGxfcGFyc2UuYwppbmRleCAyOTNmNWY3MzBlLi40YjJiYWEwNDAzIDEwMDY0
NAotLS0gYS90b29scy94bC94bF9wYXJzZS5jCisrKyBiL3Rvb2xzL3hsL3hsX3BhcnNlLmMKQEAg
LTE0NjEsNiArMTQ2MSwxMDcgQEAgdm9pZCBwYXJzZV9jb25maWdfZGF0YShjb25zdCBjaGFyICpj
b25maWdfc291cmNlLAogICAgICAgICBleGl0KDEpOwogICAgIH0KIAorICAgIGlmICgheGx1X2Nm
Z19nZXRfbGlzdCAoY29uZmlnLCAicGNpIiwgJnBjaXMsIDAsIDApKSB7CisgICAgICAgIGRfY29u
ZmlnLT5udW1fcGNpZGV2cyA9IDA7CisgICAgICAgIGRfY29uZmlnLT5wY2lkZXZzID0gTlVMTDsK
KyAgICAgICAgZm9yKGkgPSAwOyAoYnVmID0geGx1X2NmZ19nZXRfbGlzdGl0ZW0gKHBjaXMsIGkp
KSAhPSBOVUxMOyBpKyspIHsKKyAgICAgICAgICAgIGxpYnhsX2RldmljZV9wY2kgKnBjaWRldjsK
KworICAgICAgICAgICAgcGNpZGV2ID0gQVJSQVlfRVhURU5EX0lOSVRfTk9ERVZJRChkX2NvbmZp
Zy0+cGNpZGV2cywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZF9jb25maWctPm51bV9wY2lkZXZzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBsaWJ4bF9kZXZpY2VfcGNpX2luaXQpOworICAgICAgICAgICAgcGNp
ZGV2LT5tc2l0cmFuc2xhdGUgPSBwY2lfbXNpdHJhbnNsYXRlOworICAgICAgICAgICAgcGNpZGV2
LT5wb3dlcl9tZ210ID0gcGNpX3Bvd2VyX21nbXQ7CisgICAgICAgICAgICBwY2lkZXYtPnBlcm1p
c3NpdmUgPSBwY2lfcGVybWlzc2l2ZTsKKyAgICAgICAgICAgIHBjaWRldi0+c2VpemUgPSBwY2lf
c2VpemU7CisgICAgICAgICAgICAvKgorICAgICAgICAgICAgICogTGlrZSBvdGhlciBwY2kgb3B0
aW9uLCB0aGUgcGVyLWRldmljZSBwb2xpY3kgYWx3YXlzIGZvbGxvd3MKKyAgICAgICAgICAgICAq
IHRoZSBnbG9iYWwgcG9saWN5IGJ5IGRlZmF1bHQuCisgICAgICAgICAgICAgKi8KKyAgICAgICAg
ICAgIHBjaWRldi0+cmRtX3BvbGljeSA9IGJfaW5mby0+dS5odm0ucmRtLnBvbGljeTsKKyAgICAg
ICAgICAgIGUgPSB4bHVfcGNpX3BhcnNlX2JkZihjb25maWcsIHBjaWRldiwgYnVmKTsKKyAgICAg
ICAgICAgIGlmIChlKSB7CisgICAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsCisgICAgICAg
ICAgICAgICAgICAgICAgICAidW5hYmxlIHRvIHBhcnNlIFBDSSBCREYgYCVzJyBmb3IgcGFzc3Ro
cm91Z2hcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICBidWYpOworICAgICAgICAgICAgICAg
IGV4aXQoLWUpOworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgICAgIGlmIChkX2NvbmZp
Zy0+bnVtX3BjaWRldnMgJiYgY19pbmZvLT50eXBlID09IExJQlhMX0RPTUFJTl9UWVBFX1BWKQor
ICAgICAgICAgICAgbGlieGxfZGVmYm9vbF9zZXQoJmJfaW5mby0+dS5wdi5lODIwX2hvc3QsIHRy
dWUpOworICAgIH0KKworICAgIGlmICgheGx1X2NmZ19nZXRfbGlzdCAoY29uZmlnLCAiZHRkZXYi
LCAmZHRkZXZzLCAwLCAwKSkgeworICAgICAgICBkX2NvbmZpZy0+bnVtX2R0ZGV2cyA9IDA7Cisg
ICAgICAgIGRfY29uZmlnLT5kdGRldnMgPSBOVUxMOworICAgICAgICBmb3IgKGkgPSAwOyAoYnVm
ID0geGx1X2NmZ19nZXRfbGlzdGl0ZW0oZHRkZXZzLCBpKSkgIT0gTlVMTDsgaSsrKSB7CisgICAg
ICAgICAgICBsaWJ4bF9kZXZpY2VfZHRkZXYgKmR0ZGV2OworCisgICAgICAgICAgICBkdGRldiA9
IEFSUkFZX0VYVEVORF9JTklUX05PREVWSUQoZF9jb25maWctPmR0ZGV2cywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkX2NvbmZpZy0+bnVtX2R0ZGV2cywK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ4bF9kZXZp
Y2VfZHRkZXZfaW5pdCk7CisKKyAgICAgICAgICAgIGR0ZGV2LT5wYXRoID0gc3RyZHVwKGJ1Zik7
CisgICAgICAgICAgICBpZiAoZHRkZXYtPnBhdGggPT0gTlVMTCkgeworICAgICAgICAgICAgICAg
IGZwcmludGYoc3RkZXJyLCAidW5hYmxlIHRvIGR1cGxpY2F0ZSBzdHJpbmcgZm9yIGR0ZGV2c1xu
Iik7CisgICAgICAgICAgICAgICAgZXhpdCgtMSk7CisgICAgICAgICAgICB9CisgICAgICAgIH0K
KyAgICB9CisKKyAgICBpZiAoeGx1X2NmZ19nZXRfc3RyaW5nKGNvbmZpZywgInBhc3N0aHJvdWdo
IiwgJmJ1ZiwgMCkpIHsKKyAgICAgICAgYnVmID0gKGRfY29uZmlnLT5udW1fcGNpZGV2cyB8fCBk
X2NvbmZpZy0+bnVtX2R0ZGV2cykKKyAgICAgICAgICAgID8gImVuYWJsZWQiIDogImRpc2FibGVk
IjsKKyAgICB9CisKKyAgICBpZiAoIXN0cm5jbXAoYnVmLCAiZW5hYmxlZCIsIHN0cmxlbihidWYp
KSkgeworICAgICAgICAvKiBDaG9vc2UgYSBzdWl0YWJsZSBkZWZhdWx0ICovCisgICAgICAgIGNf
aW5mby0+cGFzc3Rocm91Z2ggPQorICAgICAgICAgICAgKGNfaW5mby0+dHlwZSA9PSBMSUJYTF9E
T01BSU5fVFlQRV9QVikgfHwgIWlvbW11X2hhcF9wdF9zaGFyZQorICAgICAgICAgICAgPyBMSUJY
TF9QQVNTVEhST1VHSF9TWU5DX1BUIDogTElCWExfUEFTU1RIUk9VR0hfU0hBUkVfUFQ7CisgICAg
fSBlbHNlIHsKKyAgICAgICAgbGlieGxfcGFzc3Rocm91Z2ggbzsKKworICAgICAgICBlID0gbGli
eGxfcGFzc3Rocm91Z2hfZnJvbV9zdHJpbmcoYnVmLCAmbyk7CisgICAgICAgIGlmIChlKSB7Cisg
ICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwKKyAgICAgICAgICAgICAgICAgICAgIkVSUk9SOiB1
bmtub3duIHBhc3N0aHJvdWdoIG9wdGlvbiAnJXMnXG4iLAorICAgICAgICAgICAgICAgICAgICBi
dWYpOworICAgICAgICAgICAgZXhpdCgtRVJST1JfRkFJTCk7CisgICAgICAgIH0KKworICAgICAg
ICBzd2l0Y2ggKG8pIHsKKyAgICAgICAgY2FzZSBMSUJYTF9QQVNTVEhST1VHSF9ESVNBQkxFRDoK
KyAgICAgICAgICAgIGlmIChkX2NvbmZpZy0+bnVtX3BjaWRldnMgfHwgZF9jb25maWctPm51bV9k
dGRldnMpIHsKKyAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICJFUlJPUjogcGFzc3Rocm91Z2ggZGlzYWJsZWQgYnV0IGRldmljZXMgYXJlIHNw
ZWNpZmllZFxuIik7CisgICAgICAgICAgICAgICAgZXhpdCgtRVJST1JfRkFJTCk7CisgICAgICAg
ICAgICB9CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBMSUJYTF9QQVNTVEhST1VH
SF9TSEFSRV9QVDoKKyAgICAgICAgICAgIGlmIChjX2luZm8tPnR5cGUgPT0gTElCWExfRE9NQUlO
X1RZUEVfUFYpIHsKKyAgICAgICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICJFUlJPUjogcGFzc3Rocm91Z2g9XCJzaGFyZV9wdFwiIG5vdCB2YWxpZCBm
b3IgUFYgZG9tYWluXG4iKTsKKyAgICAgICAgICAgICAgICBleGl0KC1FUlJPUl9GQUlMKTsKKyAg
ICAgICAgICAgIH0gZWxzZSBpZiAoIWlvbW11X2hhcF9wdF9zaGFyZSkgeworICAgICAgICAgICAg
ICAgIGZwcmludGYoc3RkZXJyLAorICAgICAgICAgICAgICAgICAgICAgICAgIkVSUk9SOiBwYXNz
dGhyb3VnaD1cInNoYXJlX3B0XCIgbm90IHN1cHBvcnRlZCBvbiB0aGlzIHBsYXRmb3JtXG4iKTsK
KyAgICAgICAgICAgICAgICBleGl0KC1FUlJPUl9GQUlMKTsKKyAgICAgICAgICAgIH0KKyAgICAg
ICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIExJQlhMX1BBU1NUSFJPVUdIX1NZTkNfUFQ6Cisg
ICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorCisgICAgICAgIGNfaW5mby0+cGFzc3Rocm91
Z2ggPSBvOworICAgIH0KKworICAgIGlmICgoY19pbmZvLT5wYXNzdGhyb3VnaCAhPSBMSUJYTF9Q
QVNTVEhST1VHSF9ESVNBQkxFRCkgJiYgIWlvbW11X2VuYWJsZWQpIHsKKyAgICAgICAgZnByaW50
ZihzdGRlcnIsCisgICAgICAgICAgICAgICAgIkVSUk9SOiBwYXNzdGhyb3VnaCBub3Qgc3VwcG9y
dGVkIG9uIHRoaXMgcGxhdGZvcm1cbiIpOworICAgICAgICBleGl0KC1FUlJPUl9GQUlMKTsKKyAg
ICB9CisKICAgICAvKiBsaWJ4bF9nZXRfcmVxdWlyZWRfc2hhZG93X21lbW9yeSgpIGFuZAogICAg
ICAqIGxpYnhsX2dldF9yZXF1aXJlZF9pb21tdV9tZW1vcnkoKSBtdXN0IGJlIGNhbGxlZCBhZnRl
ciBmaW5hbCB2YWx1ZXMKICAgICAgKiAoZGVmYXVsdCBvciBzcGVjaWZpZWQpIGZvciB2Y3B1cyBh
bmQgbWVtb3J5IGFyZSBzZXQsIGJlY2F1c2UgdGhlCkBAIC0xNDcwLDExICsxNTcxLDEwIEBAIHZv
aWQgcGFyc2VfY29uZmlnX2RhdGEoY29uc3QgY2hhciAqY29uZmlnX3NvdXJjZSwKICAgICAgICAg
OiBsaWJ4bF9nZXRfcmVxdWlyZWRfc2hhZG93X21lbW9yeShiX2luZm8tPm1heF9tZW1rYiwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiX2luZm8tPm1heF92Y3B1
cyk7CiAKLSAgICAvKiBObyBJT01NVSByZXNlcnZhdGlvbiBpcyBuZWVkZWQgaWYgZWl0aGVyIHRo
ZSBJT01NVSBpcyBkaXNhYmxlZCBvciBpdAotICAgICAqIGNhbiBzaGFyZSB0aGUgUDJNLiAqLwot
ICAgIGJfaW5mby0+aW9tbXVfbWVta2IgPSAoIWlvbW11X2VuYWJsZWQgfHwgaW9tbXVfaGFwX3B0
X3NoYXJlKQotICAgICAgICA/IDAKLSAgICAgICAgOiBsaWJ4bF9nZXRfcmVxdWlyZWRfaW9tbXVf
bWVtb3J5KGJfaW5mby0+bWF4X21lbWtiKTsKKyAgICAvKiBObyBJT01NVSByZXNlcnZhdGlvbiBp
cyBuZWVkZWQgaWYgcGFzc3Rocm91Z2ggbW9kZSBpcyBub3QgJ3N5bmNfcHQnICovCisgICAgYl9p
bmZvLT5pb21tdV9tZW1rYiA9IChjX2luZm8tPnBhc3N0aHJvdWdoID09IExJQlhMX1BBU1NUSFJP
VUdIX1NZTkNfUFQpCisgICAgICAgID8gbGlieGxfZ2V0X3JlcXVpcmVkX2lvbW11X21lbW9yeShi
X2luZm8tPm1heF9tZW1rYikKKyAgICAgICAgOiAwOwogCiAgICAgeGx1X2NmZ19nZXRfZGVmYm9v
bChjb25maWcsICJub21pZ3JhdGUiLCAmYl9pbmZvLT5kaXNhYmxlX21pZ3JhdGUsIDApOwogCkBA
IC0yMjk4LDU0ICsyMzk4LDYgQEAgc2tpcF92ZmI6CiAgICAgICAgIH0KICAgICB9CiAKLSAgICBp
ZiAoIXhsdV9jZmdfZ2V0X2xpc3QgKGNvbmZpZywgInBjaSIsICZwY2lzLCAwLCAwKSkgewotICAg
ICAgICBkX2NvbmZpZy0+bnVtX3BjaWRldnMgPSAwOwotICAgICAgICBkX2NvbmZpZy0+cGNpZGV2
cyA9IE5VTEw7Ci0gICAgICAgIGZvcihpID0gMDsgKGJ1ZiA9IHhsdV9jZmdfZ2V0X2xpc3RpdGVt
IChwY2lzLCBpKSkgIT0gTlVMTDsgaSsrKSB7Ci0gICAgICAgICAgICBsaWJ4bF9kZXZpY2VfcGNp
ICpwY2lkZXY7Ci0KLSAgICAgICAgICAgIHBjaWRldiA9IEFSUkFZX0VYVEVORF9JTklUX05PREVW
SUQoZF9jb25maWctPnBjaWRldnMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGRfY29uZmlnLT5udW1fcGNpZGV2cywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfZGV2aWNlX3BjaV9pbml0KTsKLSAgICAg
ICAgICAgIHBjaWRldi0+bXNpdHJhbnNsYXRlID0gcGNpX21zaXRyYW5zbGF0ZTsKLSAgICAgICAg
ICAgIHBjaWRldi0+cG93ZXJfbWdtdCA9IHBjaV9wb3dlcl9tZ210OwotICAgICAgICAgICAgcGNp
ZGV2LT5wZXJtaXNzaXZlID0gcGNpX3Blcm1pc3NpdmU7Ci0gICAgICAgICAgICBwY2lkZXYtPnNl
aXplID0gcGNpX3NlaXplOwotICAgICAgICAgICAgLyoKLSAgICAgICAgICAgICAqIExpa2Ugb3Ro
ZXIgcGNpIG9wdGlvbiwgdGhlIHBlci1kZXZpY2UgcG9saWN5IGFsd2F5cyBmb2xsb3dzCi0gICAg
ICAgICAgICAgKiB0aGUgZ2xvYmFsIHBvbGljeSBieSBkZWZhdWx0LgotICAgICAgICAgICAgICov
Ci0gICAgICAgICAgICBwY2lkZXYtPnJkbV9wb2xpY3kgPSBiX2luZm8tPnUuaHZtLnJkbS5wb2xp
Y3k7Ci0gICAgICAgICAgICBlID0geGx1X3BjaV9wYXJzZV9iZGYoY29uZmlnLCBwY2lkZXYsIGJ1
Zik7Ci0gICAgICAgICAgICBpZiAoZSkgewotICAgICAgICAgICAgICAgIGZwcmludGYoc3RkZXJy
LAotICAgICAgICAgICAgICAgICAgICAgICAgInVuYWJsZSB0byBwYXJzZSBQQ0kgQkRGIGAlcycg
Zm9yIHBhc3N0aHJvdWdoXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgYnVmKTsKLSAgICAg
ICAgICAgICAgICBleGl0KC1lKTsKLSAgICAgICAgICAgIH0KLSAgICAgICAgfQotICAgICAgICBp
ZiAoZF9jb25maWctPm51bV9wY2lkZXZzICYmIGNfaW5mby0+dHlwZSA9PSBMSUJYTF9ET01BSU5f
VFlQRV9QVikKLSAgICAgICAgICAgIGxpYnhsX2RlZmJvb2xfc2V0KCZiX2luZm8tPnUucHYuZTgy
MF9ob3N0LCB0cnVlKTsKLSAgICB9Ci0KLSAgICBpZiAoIXhsdV9jZmdfZ2V0X2xpc3QgKGNvbmZp
ZywgImR0ZGV2IiwgJmR0ZGV2cywgMCwgMCkpIHsKLSAgICAgICAgZF9jb25maWctPm51bV9kdGRl
dnMgPSAwOwotICAgICAgICBkX2NvbmZpZy0+ZHRkZXZzID0gTlVMTDsKLSAgICAgICAgZm9yIChp
ID0gMDsgKGJ1ZiA9IHhsdV9jZmdfZ2V0X2xpc3RpdGVtKGR0ZGV2cywgaSkpICE9IE5VTEw7IGkr
KykgewotICAgICAgICAgICAgbGlieGxfZGV2aWNlX2R0ZGV2ICpkdGRldjsKLQotICAgICAgICAg
ICAgZHRkZXYgPSBBUlJBWV9FWFRFTkRfSU5JVF9OT0RFVklEKGRfY29uZmlnLT5kdGRldnMsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZF9jb25maWctPm51
bV9kdGRldnMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bGlieGxfZGV2aWNlX2R0ZGV2X2luaXQpOwotCi0gICAgICAgICAgICBkdGRldi0+cGF0aCA9IHN0
cmR1cChidWYpOwotICAgICAgICAgICAgaWYgKGR0ZGV2LT5wYXRoID09IE5VTEwpIHsKLSAgICAg
ICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgInVuYWJsZSB0byBkdXBsaWNhdGUgc3RyaW5nIGZv
ciBkdGRldnNcbiIpOwotICAgICAgICAgICAgICAgIGV4aXQoLTEpOwotICAgICAgICAgICAgfQot
ICAgICAgICB9Ci0gICAgfQotCiAgICAgaWYgKCF4bHVfY2ZnX2dldF9saXN0KGNvbmZpZywgInVz
YmN0cmwiLCAmdXNiY3RybHMsIDAsIDApKSB7CiAgICAgICAgIGRfY29uZmlnLT5udW1fdXNiY3Ry
bHMgPSAwOwogICAgICAgICBkX2NvbmZpZy0+dXNiY3RybHMgPSBOVUxMOwpkaWZmIC0tZ2l0IGEv
eGVuL2FyY2gvYXJtL2RvbWFpbi5jIGIveGVuL2FyY2gvYXJtL2RvbWFpbi5jCmluZGV4IGFlMTNl
NDdlODYuLjYxZDM1Y2QxMjAgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL2FybS9kb21haW4uYworKysg
Yi94ZW4vYXJjaC9hcm0vZG9tYWluLmMKQEAgLTYxNyw2ICs2MTcsMTQgQEAgaW50IGFyY2hfc2Fu
aXRpc2VfZG9tYWluX2NvbmZpZyhzdHJ1Y3QgeGVuX2RvbWN0bF9jcmVhdGVkb21haW4gKmNvbmZp
ZykKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgfQogCisgICAgLyogVGhlIFAyTSB0YWJs
ZSBtdXN0IGFsd2F5cyBiZSBzaGFyZWQgYmV0d2VlbiB0aGUgQ1BVIGFuZCB0aGUgSU9NTVUgKi8K
KyAgICBpZiAoIGNvbmZpZy0+aW9tbXVfb3B0cyAmIFhFTl9ET01DVExfSU9NTVVfbm9fc2hhcmVw
dCApCisgICAgeworICAgICAgICBkcHJpbnRrKFhFTkxPR19JTkZPLAorICAgICAgICAgICAgICAg
ICJVbnN1cHBvcnRlZCBpb21tdSBvcHRpb246IFhFTl9ET01DVExfSU9NTVVfbm9fc2hhcmVwdFxu
Iik7CisgICAgICAgIHJldHVybiAtRUlOVkFMOworICAgIH0KKwogICAgIC8qIEZpbGwgaW4gdGhl
IG5hdGl2ZSBHSUMgdmVyc2lvbiwgcGFzc2VkIGJhY2sgdG8gdGhlIHRvb2xzdGFjay4gKi8KICAg
ICBpZiAoIGNvbmZpZy0+YXJjaC5naWNfdmVyc2lvbiA9PSBYRU5fRE9NQ1RMX0NPTkZJR19HSUNf
TkFUSVZFICkKICAgICB7CkBAIC02NzcsNyArNjg1LDcgQEAgaW50IGFyY2hfZG9tYWluX2NyZWF0
ZShzdHJ1Y3QgZG9tYWluICpkLAogICAgIEFTU0VSVChjb25maWcgIT0gTlVMTCk7CiAKICAgICAv
KiBwMm1faW5pdCByZWxpZXMgb24gc29tZSB2YWx1ZSBpbml0aWFsaXplZCBieSB0aGUgSU9NTVUg
c3Vic3lzdGVtICovCi0gICAgaWYgKCAocmMgPSBpb21tdV9kb21haW5faW5pdChkKSkgIT0gMCAp
CisgICAgaWYgKCAocmMgPSBpb21tdV9kb21haW5faW5pdChkLCBjb25maWctPmlvbW11X29wdHMp
KSAhPSAwICkKICAgICAgICAgZ290byBmYWlsOwogCiAgICAgaWYgKCAocmMgPSBwMm1faW5pdChk
KSkgIT0gMCApCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94
ODYvZG9tYWluLmMKaW5kZXggNGIwYWQ1ZTE1ZC4uZmI4YjM5N2JlMiAxMDA2NDQKLS0tIGEveGVu
L2FyY2gveDg2L2RvbWFpbi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYwpAQCAtNjExLDcg
KzYxMSw3IEBAIGludCBhcmNoX2RvbWFpbl9jcmVhdGUoc3RydWN0IGRvbWFpbiAqZCwKICAgICBp
ZiAoIChyYyA9IGluaXRfZG9tYWluX2lycV9tYXBwaW5nKGQpKSAhPSAwICkKICAgICAgICAgZ290
byBmYWlsOwogCi0gICAgaWYgKCAocmMgPSBpb21tdV9kb21haW5faW5pdChkKSkgIT0gMCApCisg
ICAgaWYgKCAocmMgPSBpb21tdV9kb21haW5faW5pdChkLCBjb25maWctPmlvbW11X29wdHMpKSAh
PSAwICkKICAgICAgICAgZ290byBmYWlsOwogCiAgICAgcHNyX2RvbWFpbl9pbml0KGQpOwpkaWZm
IC0tZ2l0IGEveGVuL2NvbW1vbi9kb21haW4uYyBiL3hlbi9jb21tb24vZG9tYWluLmMKaW5kZXgg
NDY4MWYyOWM4Yi4uMDczM2VlOGIwYSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9kb21haW4uYwor
KysgYi94ZW4vY29tbW9uL2RvbWFpbi5jCkBAIC0zMDgsNiArMzA4LDEzIEBAIHN0YXRpYyBpbnQg
c2FuaXRpc2VfZG9tYWluX2NvbmZpZyhzdHJ1Y3QgeGVuX2RvbWN0bF9jcmVhdGVkb21haW4gKmNv
bmZpZykKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgfQogCisgICAgaWYgKCAhKGNvbmZp
Zy0+ZmxhZ3MgJiBYRU5fRE9NQ1RMX0NERl9pb21tdSkgJiYgY29uZmlnLT5pb21tdV9vcHRzICkK
KyAgICB7CisgICAgICAgIGRwcmludGsoWEVOTE9HX0lORk8sCisgICAgICAgICAgICAgICAgIklP
TU1VIG9wdGlvbnMgc3BlY2lmaWVkIGJ1dCBJT01NVSBub3QgZW5hYmxlZFxuIik7CisgICAgICAg
IHJldHVybiAtRUlOVkFMOworICAgIH0KKwogICAgIGlmICggY29uZmlnLT5tYXhfdmNwdXMgPCAx
ICkKICAgICB7CiAgICAgICAgIGRwcmludGsoWEVOTE9HX0lORk8sICJObyB2Q1BVU1xuIik7CmRp
ZmYgLS1naXQgYS94ZW4vY29tbW9uL2RvbWN0bC5jIGIveGVuL2NvbW1vbi9kb21jdGwuYwppbmRl
eCA1ZGNmZTNjOGY2Li42ZTZlOWI5ODY2IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL2RvbWN0bC5j
CisrKyBiL3hlbi9jb21tb24vZG9tY3RsLmMKQEAgLTUxNSwxOSArNTE1LDYgQEAgbG9uZyBkb19k
b21jdGwoWEVOX0dVRVNUX0hBTkRMRV9QQVJBTSh4ZW5fZG9tY3RsX3QpIHVfZG9tY3RsKQogICAg
ICAgICAgICAgcm92ZXIgPSBkb207CiAgICAgICAgIH0KIAotICAgICAgICAvKgotICAgICAgICAg
KiBGb3Igbm93LCBtYWtlIHN1cmUgdGhlIGNyZWF0ZWRvbWFpbiBJT01NVSBmbGFnIGlzIHNldCBp
ZiB0aGUKLSAgICAgICAgICogSU9NTVUgaXMgZW5hYmxlZC4gV2hlbiB0aGUgZmxhZyBjb21lcyB1
bmRlciB0b29sc3RhY2sgY29udHJvbAotICAgICAgICAgKiB0aGlzIGNhbiBnbyBhd2F5LgotICAg
ICAgICAgKi8KLSAgICAgICAgaWYgKCBvcC0+dS5jcmVhdGVkb21haW4uZmxhZ3MgJiBYRU5fRE9N
Q1RMX0NERl9pb21tdSApCi0gICAgICAgIHsKLSAgICAgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJM
RSgpOwotICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Ci0gICAgICAgIH0KLSAgICAgICAgaWYg
KCBpb21tdV9lbmFibGVkICkKLSAgICAgICAgICAgIG9wLT51LmNyZWF0ZWRvbWFpbi5mbGFncyB8
PSBYRU5fRE9NQ1RMX0NERl9pb21tdTsKLQogICAgICAgICBkID0gZG9tYWluX2NyZWF0ZShkb20s
ICZvcC0+dS5jcmVhdGVkb21haW4sIGZhbHNlKTsKICAgICAgICAgaWYgKCBJU19FUlIoZCkgKQog
ICAgICAgICB7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pb21tdS5jIGIv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW9tbXUuYwppbmRleCBhNDkzNDYzOTRkLi40MTcxYzNj
ZjZmIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pb21tdS5jCisrKyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2lvbW11LmMKQEAgLTE2OCw3ICsxNjgsNyBAQCBzdGF0aWMg
dm9pZCBfX2h3ZG9tX2luaXQgY2hlY2tfaHdkb21fcmVxcyhzdHJ1Y3QgZG9tYWluICpkKQogICAg
IGlvbW11X2h3ZG9tX3N0cmljdCA9IHRydWU7CiB9CiAKLWludCBpb21tdV9kb21haW5faW5pdChz
dHJ1Y3QgZG9tYWluICpkKQoraW50IGlvbW11X2RvbWFpbl9pbml0KHN0cnVjdCBkb21haW4gKmQs
IHVuc2lnbmVkIGludCBvcHRzKQogewogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOwogICAgIGludCByZXQgPSAwOwpAQCAtMTkyLDYgKzE5MiwxNSBAQCBpbnQgaW9t
bXVfZG9tYWluX2luaXQoc3RydWN0IGRvbWFpbiAqZCkKICAgICBpZiAoIGlzX2hhcmR3YXJlX2Rv
bWFpbihkKSApCiAgICAgICAgIGNoZWNrX2h3ZG9tX3JlcXMoZCk7IC8qIG1heSBtb2RpZnkgaW9t
bXVfaHdkb21fc3RyaWN0ICovCiAKKyAgICAvKgorICAgICAqIFVzZSBzaGFyZWQgcGFnZSB0YWJs
ZXMgZm9yIEhBUCBhbmQgSU9NTVUgaWYgdGhlIGdsb2JhbCBvcHRpb24KKyAgICAgKiBpcyBlbmFi
bGVkIChmcm9tIHdoaWNoIHdlIGNhbiBpbmZlciB0aGUgaC93IGlzIGNhcGFibGUpIGFuZAorICAg
ICAqIHRoZSBkb21haW4gb3B0aW9ucyBkbyBub3QgZGlzYWxsb3cgaXQuIEhBUCBtdXN0LCBvZiBj
b3Vyc2UsIGFsc28KKyAgICAgKiBiZSBlbmFibGVkLgorICAgICAqLworICAgIGhkLT5oYXBfcHRf
c2hhcmUgPSBoYXBfZW5hYmxlZChkKSAmJiBpb21tdV9oYXBfcHRfc2hhcmUgJiYKKyAgICAgICAg
IShvcHRzICYgWEVOX0RPTUNUTF9JT01NVV9ub19zaGFyZXB0KTsKKwogICAgIC8qCiAgICAgICog
TkI6ICdyZWxheGVkJyBoL3cgZG9tYWlucyBkb24ndCBuZWVkIHRoZSBJT01NVSBtYXBwaW5ncyB0
byBiZSBrZXB0CiAgICAgICogICAgIGluLXN5bmMgd2l0aCB0aGVpciBhc3NpZ25lZCBwYWdlcyBi
ZWNhdXNlIGFsbCBob3N0IFJBTSB3aWxsIGJlCkBAIC0yMDAsNiArMjA5LDggQEAgaW50IGlvbW11
X2RvbWFpbl9pbml0KHN0cnVjdCBkb21haW4gKmQpCiAgICAgaWYgKCAhaXNfaGFyZHdhcmVfZG9t
YWluKGQpIHx8IGlvbW11X2h3ZG9tX3N0cmljdCApCiAgICAgICAgIGhkLT5uZWVkX3N5bmMgPSAh
aW9tbXVfdXNlX2hhcF9wdChkKTsKIAorICAgIEFTU0VSVCghKGhkLT5uZWVkX3N5bmMgJiYgaGQt
PmhhcF9wdF9zaGFyZSkpOworCiAgICAgcmV0dXJuIDA7CiB9CiAKZGlmZiAtLWdpdCBhL3hlbi9p
bmNsdWRlL3B1YmxpYy9kb21jdGwuaCBiL3hlbi9pbmNsdWRlL3B1YmxpYy9kb21jdGwuaAppbmRl
eCAxYjMxNzZhZGI1Li5iYTg0YWVhNmFiIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMv
ZG9tY3RsLmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL2RvbWN0bC5oCkBAIC0zOCw3ICszOCw3
IEBACiAjaW5jbHVkZSAiaHZtL3NhdmUuaCIKICNpbmNsdWRlICJtZW1vcnkuaCIKIAotI2RlZmlu
ZSBYRU5fRE9NQ1RMX0lOVEVSRkFDRV9WRVJTSU9OIDB4MDAwMDAwMTEKKyNkZWZpbmUgWEVOX0RP
TUNUTF9JTlRFUkZBQ0VfVkVSU0lPTiAweDAwMDAwMDEyCiAKIC8qCiAgKiBOQi4geGVuX2RvbWN0
bC5kb21haW4gaXMgYW4gSU4vT1VUIHBhcmFtZXRlciBmb3IgdGhpcyBvcGVyYXRpb24uCkBAIC03
Myw2ICs3MywxNCBAQCBzdHJ1Y3QgeGVuX2RvbWN0bF9jcmVhdGVkb21haW4gewogCiAgICAgdWlu
dDMyX3QgZmxhZ3M7CiAKKyNkZWZpbmUgX1hFTl9ET01DVExfSU9NTVVfbm9fc2hhcmVwdCAgMAor
I2RlZmluZSBYRU5fRE9NQ1RMX0lPTU1VX25vX3NoYXJlcHQgICAoMVUgPDwgX1hFTl9ET01DVExf
SU9NTVVfbm9fc2hhcmVwdCkKKworLyogTWF4IFhFTl9ET01DVExfSU9NTVVfKiBjb25zdGFudC4g
IFVzZWQgZm9yIEFCSSBjaGVja2luZy4gKi8KKyNkZWZpbmUgWEVOX0RPTUNUTF9JT01NVV9NQVgg
WEVOX0RPTUNUTF9JT01NVV9ub19zaGFyZXB0CisKKyAgICB1aW50MzJfdCBpb21tdV9vcHRzOwor
CiAgICAgLyoKICAgICAgKiBWYXJpb3VzIGRvbWFpbiBsaW1pdHMsIHdoaWNoIGltcGFjdCB0aGUg
cXVhbnRpdHkgb2YgcmVzb3VyY2VzIChnbG9iYWwKICAgICAgKiBtYXBwaW5nIHNwYWNlLCB4ZW5o
ZWFwLCBldGMpIGEgZ3Vlc3QgbWF5IGNvbnN1bWUuCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94
ZW4vaW9tbXUuaCBiL3hlbi9pbmNsdWRlL3hlbi9pb21tdS5oCmluZGV4IDhiOTg1ZjkyYjAuLmFk
NTU2ZjdkNTQgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9pb21tdS5oCisrKyBiL3hlbi9p
bmNsdWRlL3hlbi9pb21tdS5oCkBAIC03NSw3ICs3NSw3IEBAIGV4dGVybiB1bnNpZ25lZCBpbnQg
aW9tbXVfZGV2X2lvdGxiX3RpbWVvdXQ7CiBpbnQgaW9tbXVfc2V0dXAodm9pZCk7CiBpbnQgaW9t
bXVfaGFyZHdhcmVfc2V0dXAodm9pZCk7CiAKLWludCBpb21tdV9kb21haW5faW5pdChzdHJ1Y3Qg
ZG9tYWluICpkKTsKK2ludCBpb21tdV9kb21haW5faW5pdChzdHJ1Y3QgZG9tYWluICpkLCB1bnNp
Z25lZCBpbnQgb3B0cyk7CiB2b2lkIGlvbW11X2h3ZG9tX2luaXQoc3RydWN0IGRvbWFpbiAqZCk7
CiB2b2lkIGlvbW11X2RvbWFpbl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQpOwogCkBAIC0yNjks
MTAgKzI2OSwxNCBAQCBzdHJ1Y3QgZG9tYWluX2lvbW11IHsKICAgICAvKiBGZWF0dXJlcyBzdXBw
b3J0ZWQgYnkgdGhlIElPTU1VICovCiAgICAgREVDTEFSRV9CSVRNQVAoZmVhdHVyZXMsIElPTU1V
X0ZFQVRfY291bnQpOwogCisgICAgLyogRG9lcyB0aGUgZ3Vlc3Qgc2hhcmUgSEFQIG1hcHBpbmcg
d2l0aCB0aGUgSU9NTVU/ICovCisgICAgYm9vbCBoYXBfcHRfc2hhcmU7CisKICAgICAvKgotICAg
ICAqIERvZXMgdGhlIGd1ZXN0IHJlcWlyZSBtYXBwaW5ncyB0byBiZSBzeW5jaG9uaXplZCwgdG8g
bWFpbnRhaW4KLSAgICAgKiB0aGUgZGVmYXVsdCBkZm4gPT0gcGZuIG1hcC4gKFNlZSBjb21tZW50
IG9uIGRmbiBhdCB0aGUgdG9wIG9mCi0gICAgICogaW5jbHVkZS94ZW4vbW0uaCkuCisgICAgICog
RG9lcyB0aGUgZ3Vlc3QgcmVxdWlyZSBtYXBwaW5ncyB0byBiZSBzeW5jaHJvbml6ZWQsIHRvIG1h
aW50YWluCisgICAgICogdGhlIGRlZmF1bHQgZGZuID09IHBmbiBtYXA/IChTZWUgY29tbWVudCBv
biBkZm4gYXQgdGhlIHRvcCBvZgorICAgICAqIGluY2x1ZGUveGVuL21tLmgpLiBOb3RlIHRoYXQg
aGFwX3B0X3NoYXJlID09IGZhbHNlIGRvZXMgbm90CisgICAgICogbmVjZXNzYXJpbHkgaW1wbHkg
dGhpcyBpcyB0cnVlLgogICAgICAqLwogICAgIGJvb2wgbmVlZF9zeW5jOwogfTsKQEAgLTI4Miw4
ICsyODYsNyBAQCBzdHJ1Y3QgZG9tYWluX2lvbW11IHsKICNkZWZpbmUgaW9tbXVfY2xlYXJfZmVh
dHVyZShkLCBmKSBjbGVhcl9iaXQoZiwgZG9tX2lvbW11KGQpLT5mZWF0dXJlcykKIAogLyogQXJl
IHdlIHVzaW5nIHRoZSBkb21haW4gUDJNIHRhYmxlIGFzIGl0cyBJT01NVSBwYWdldGFibGU/ICov
Ci0jZGVmaW5lIGlvbW11X3VzZV9oYXBfcHQoZCkgXAotICAgIChoYXBfZW5hYmxlZChkKSAmJiBp
c19pb21tdV9lbmFibGVkKGQpICYmIGlvbW11X2hhcF9wdF9zaGFyZSkKKyNkZWZpbmUgaW9tbXVf
dXNlX2hhcF9wdChkKSAgICAgICAoZG9tX2lvbW11KGQpLT5oYXBfcHRfc2hhcmUpCiAKIC8qIERv
ZXMgdGhlIElPTU1VIHBhZ2V0YWJsZSBuZWVkIHRvIGJlIGtlcHQgc3luY2hyb25pemVkIHdpdGgg
dGhlIFAyTSAqLwogI2lmZGVmIENPTkZJR19IQVNfUEFTU1RIUk9VR0gKLS0gCjIuMjAuMS4yLmdi
MjFlYmI2NzEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpo
dHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E951F17DDDB
	for <lists+xen-devel@lfdr.de>; Mon,  9 Mar 2020 11:45:44 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1jBFsF-0002hW-8r; Mon, 09 Mar 2020 10:43:03 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=k1Ob=42=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1jBFsE-0002hP-0L
 for xen-devel@lists.xenproject.org; Mon, 09 Mar 2020 10:43:02 +0000
X-Inumbo-ID: bf025652-61f2-11ea-ac02-12813bfff9fa
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id bf025652-61f2-11ea-ac02-12813bfff9fa;
 Mon, 09 Mar 2020 10:43:00 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id F3B1AB3CE;
 Mon,  9 Mar 2020 10:42:59 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
References: <a8fc7299-4632-b32a-939d-b2e8354cf296@suse.com>
Message-ID: <d1c4f00d-3bcd-b6f1-cd4e-24870ad248cc@suse.com>
Date: Mon, 9 Mar 2020 11:43:04 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko/20100101
 Thunderbird/68.5.0
MIME-Version: 1.0
In-Reply-To: <a8fc7299-4632-b32a-939d-b2e8354cf296@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH v2 2/5] IOMMU: iommu_intpost is x86/HVM-only
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Paul Durrant <paul@xen.org>,
 Ian Jackson <ian.jackson@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UHJvdmlkZSBhICNkZWZpbmUgZm9yIGFsbCBvdGhlciBjYXNlcy4KClNpZ25lZC1vZmYtYnk6IEph
biBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCnYyOiBSZWZpbmUgZG9jIGFkanVzdG1l
bnQuCgotLS0gYS9kb2NzL21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2MKKysrIGIvZG9jcy9t
aXNjL3hlbi1jb21tYW5kLWxpbmUucGFuZG9jCkBAIC0xMzA5LDYgKzEzMDksOCBAQCBib29sZWFu
IChlLmcuIGBpb21tdT1ub2ApIGNhbiBvdmVycmlkZSB0CiAgICAgVGhpcyBvcHRpb24gZGVwZW5k
cyBvbiBgaW50cmVtYXBgLCBhbmQgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdCBkdWUgdG8gc29tZQog
ICAgIGNvcm5lciBjYXNlcyBpbiB0aGUgaW1wbGVtZW50YXRpb24gd2hpY2ggaGF2ZSB5ZXQgdG8g
YmUgcmVzb2x2ZWQuCiAKKyAgICBUaGlzIG9wdGlvbiBpcyBvbmx5IHZhbGlkIG9uIHg4NiwgYW5k
IG9ubHkgYnVpbGRzIG9mIFhlbiB3aXRoIEhWTSBzdXBwb3J0LgorCiAqICAgVGhlIGBjcmFzaC1k
aXNhYmxlYCBib29sZWFuIGNvbnRyb2xzIGRpc2FibGluZyBJT01NVSBmdW5jdGlvbmFsaXR5IChE
TUFSL0lSL1FJKQogICAgIGJlZm9yZSBzd2l0Y2hpbmcgdG8gYSBjcmFzaCBrZXJuZWwuIFRoaXMg
b3B0aW9uIGlzIGluYWN0aXZlIGJ5IGRlZmF1bHQgYW5kCiAgICAgaXMgZm9yIGNvbXBhdGliaWxp
dHkgd2l0aCBvbGRlciBrZHVtcCBrZXJuZWxzIG9ubHkuIE1vZGVybiBrZXJuZWxzIGNvcHkKLS0t
IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9pb21tdS5jCkBAIC00MywxNCArNDMsNiBAQCBib29sIF9fcmVhZF9tb3N0bHkgaW9t
bXVfaHdkb21fcGFzc3Rocm91CiBib29sIF9faHdkb21faW5pdGRhdGEgaW9tbXVfaHdkb21faW5j
bHVzaXZlOwogaW50OF90IF9faHdkb21faW5pdGRhdGEgaW9tbXVfaHdkb21fcmVzZXJ2ZWQgPSAt
MTsKIAotLyoKLSAqIEluIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIFZULWQgcG9zdGVk
IGludGVycnVwdHMsIGluIHNvbWUgZXh0cmVtZQotICogY2FzZXMsIHRoZSBwZXIgY3B1IGxpc3Qg
d2hpY2ggc2F2ZXMgdGhlIGJsb2NrZWQgdkNQVSB3aWxsIGJlIHZlcnkgbG9uZywKLSAqIGFuZCB0
aGlzIHdpbGwgYWZmZWN0IHRoZSBpbnRlcnJ1cHQgbGF0ZW5jeSwgc28gbGV0IHRoaXMgZmVhdHVy
ZSBvZmYgYnkKLSAqIGRlZmF1bHQgdW50aWwgd2UgZmluZCBhIGdvb2Qgc29sdXRpb24gdG8gcmVz
b2x2ZSBpdC4KLSAqLwotYm9vbF90IF9fcmVhZF9tb3N0bHkgaW9tbXVfaW50cG9zdDsKLQogI2lm
bmRlZiBpb21tdV9oYXBfcHRfc2hhcmUKIGJvb2wgX19yZWFkX21vc3RseSBpb21tdV9oYXBfcHRf
c2hhcmUgPSB0cnVlOwogI2VuZGlmCkBAIC05Myw4ICs4NSwxMCBAQCBzdGF0aWMgaW50IF9faW5p
dCBwYXJzZV9pb21tdV9wYXJhbShjb25zCiAgICAgICAgIGVsc2UgaWYgKCAodmFsID0gcGFyc2Vf
Ym9vbGVhbigiaW50cmVtYXAiLCBzLCBzcykpID49IDAgKQogICAgICAgICAgICAgaW9tbXVfaW50
cmVtYXAgPSB2YWwgPyBpb21tdV9pbnRyZW1hcF9mdWxsIDogaW9tbXVfaW50cmVtYXBfb2ZmOwog
I2VuZGlmCisjaWZuZGVmIGlvbW11X2ludHBvc3QKICAgICAgICAgZWxzZSBpZiAoICh2YWwgPSBw
YXJzZV9ib29sZWFuKCJpbnRwb3N0Iiwgcywgc3MpKSA+PSAwICkKICAgICAgICAgICAgIGlvbW11
X2ludHBvc3QgPSB2YWw7CisjZW5kaWYKICNpZmRlZiBDT05GSUdfS0VYRUMKICAgICAgICAgZWxz
ZSBpZiAoICh2YWwgPSBwYXJzZV9ib29sZWFuKCJjcmFzaC1kaXNhYmxlIiwgcywgc3MpKSA+PSAw
ICkKICAgICAgICAgICAgIGlvbW11X2NyYXNoX2Rpc2FibGUgPSB2YWw7CkBAIC00ODYsOCArNDgw
LDEwIEBAIGludCBfX2luaXQgaW9tbXVfc2V0dXAodm9pZCkKICAgICAgICAgcGFuaWMoIkNvdWxk
bid0IGVuYWJsZSAlcyBhbmQgaW9tbXU9cmVxdWlyZWQvZm9yY2VcbiIsCiAgICAgICAgICAgICAg
ICFpb21tdV9lbmFibGVkID8gIklPTU1VIiA6ICJJbnRlcnJ1cHQgUmVtYXBwaW5nIik7CiAKKyNp
Zm5kZWYgaW9tbXVfaW50cG9zdAogICAgIGlmICggIWlvbW11X2ludHJlbWFwICkKICAgICAgICAg
aW9tbXVfaW50cG9zdCA9IDA7CisjZW5kaWYKIAogICAgIHByaW50aygiSS9PIHZpcnR1YWxpc2F0
aW9uICVzYWJsZWRcbiIsIGlvbW11X2VuYWJsZWQgPyAiZW4iIDogImRpcyIpOwogICAgIGlmICgg
IWlvbW11X2VuYWJsZWQgKQpAQCAtNTYzLDEwICs1NTksMTMgQEAgdm9pZCBpb21tdV9jcmFzaF9z
aHV0ZG93bih2b2lkKQogCiAgICAgaWYgKCBpb21tdV9lbmFibGVkICkKICAgICAgICAgaW9tbXVf
Z2V0X29wcygpLT5jcmFzaF9zaHV0ZG93bigpOwotICAgIGlvbW11X2VuYWJsZWQgPSBpb21tdV9p
bnRwb3N0ID0gMDsKKyAgICBpb21tdV9lbmFibGVkID0gZmFsc2U7CiAjaWZuZGVmIGlvbW11X2lu
dHJlbWFwCiAgICAgaW9tbXVfaW50cmVtYXAgPSBpb21tdV9pbnRyZW1hcF9vZmY7CiAjZW5kaWYK
KyNpZm5kZWYgaW9tbXVfaW50cG9zdAorICAgIGlvbW11X2ludHBvc3QgPSBmYWxzZTsKKyNlbmRp
ZgogfQogCiBpbnQgaW9tbXVfZ2V0X3Jlc2VydmVkX2RldmljZV9tZW1vcnkoaW9tbXVfZ3JkbV90
ICpmdW5jLCB2b2lkICpjdHh0KQotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYwpAQCAtMjI5Nywx
MyArMjI5NywxNSBAQCBzdGF0aWMgaW50IF9faW5pdCB2dGRfc2V0dXAodm9pZCkKICAgICAgICAg
aWYgKCBpb21tdV9pbnRyZW1hcCAmJiAhZWNhcF9pbnRyX3JlbWFwKGlvbW11LT5lY2FwKSApCiAg
ICAgICAgICAgICBpb21tdV9pbnRyZW1hcCA9IGlvbW11X2ludHJlbWFwX29mZjsKIAorI2lmbmRl
ZiBpb21tdV9pbnRwb3N0CiAgICAgICAgIC8qCiAgICAgICAgICAqIFdlIGNhbm5vdCB1c2UgcG9z
dGVkIGludGVycnVwdCBpZiBYODZfRkVBVFVSRV9DWDE2IGlzCiAgICAgICAgICAqIG5vdCBzdXBw
b3J0ZWQsIHNpbmNlIHdlIGNvdW50IG9uIHRoaXMgZmVhdHVyZSB0bwogICAgICAgICAgKiBhdG9t
aWNhbGx5IHVwZGF0ZSAxNi1ieXRlIElSVEUgaW4gcG9zdGVkIGZvcm1hdC4KICAgICAgICAgICov
CiAgICAgICAgIGlmICggIWNhcF9pbnRyX3Bvc3QoaW9tbXUtPmNhcCkgfHwgIWlvbW11X2ludHJl
bWFwIHx8ICFjcHVfaGFzX2N4MTYgKQotICAgICAgICAgICAgaW9tbXVfaW50cG9zdCA9IDA7Cisg
ICAgICAgICAgICBpb21tdV9pbnRwb3N0ID0gZmFsc2U7CisjZW5kaWYKIAogICAgICAgICBpZiAo
ICF2dGRfZXB0X3BhZ2VfY29tcGF0aWJsZShpb21tdSkgKQogICAgICAgICAgICAgY2xlYXJfaW9t
bXVfaGFwX3B0X3NoYXJlKCk7CkBAIC0yMzMwLDcgKzIzMzIsOSBAQCBzdGF0aWMgaW50IF9faW5p
dCB2dGRfc2V0dXAodm9pZCkKICAgICBQKGlvbW11X2h3ZG9tX3Bhc3N0aHJvdWdoLCAiRG9tMCBE
TUEgUGFzc3Rocm91Z2giKTsKICAgICBQKGlvbW11X3FpbnZhbCwgIlF1ZXVlZCBJbnZhbGlkYXRp
b24iKTsKICAgICBQKGlvbW11X2ludHJlbWFwLCAiSW50ZXJydXB0IFJlbWFwcGluZyIpOworI2lm
bmRlZiBpb21tdV9pbnRwb3N0CiAgICAgUChpb21tdV9pbnRwb3N0LCAiUG9zdGVkIEludGVycnVw
dCIpOworI2VuZGlmCiAgICAgUChpb21tdV9oYXBfcHRfc2hhcmUsICJTaGFyZWQgRVBUIHRhYmxl
cyIpOwogI3VuZGVmIFAKIApAQCAtMjM0OCw3ICsyMzUyLDkgQEAgc3RhdGljIGludCBfX2luaXQg
dnRkX3NldHVwKHZvaWQpCiAgICAgaW9tbXVfaHdkb21fcGFzc3Rocm91Z2ggPSBmYWxzZTsKICAg
ICBpb21tdV9xaW52YWwgPSAwOwogICAgIGlvbW11X2ludHJlbWFwID0gaW9tbXVfaW50cmVtYXBf
b2ZmOwotICAgIGlvbW11X2ludHBvc3QgPSAwOworI2lmbmRlZiBpb21tdV9pbnRwb3N0CisgICAg
aW9tbXVfaW50cG9zdCA9IGZhbHNlOworI2VuZGlmCiAgICAgcmV0dXJuIHJldDsKIH0KIAotLS0g
YS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC94ODYvaW9tbXUuYwpAQCAtMjksNiArMjksMTYgQEAgc3RydWN0IGlvbW11X29w
cyBfX3JlYWRfbW9zdGx5IGlvbW11X29wcwogCiBlbnVtIGlvbW11X2ludHJlbWFwIF9fcmVhZF9t
b3N0bHkgaW9tbXVfaW50cmVtYXAgPSBpb21tdV9pbnRyZW1hcF9mdWxsOwogCisjaWZuZGVmIGlv
bW11X2ludHBvc3QKKy8qCisgKiBJbiB0aGUgY3VycmVudCBpbXBsZW1lbnRhdGlvbiBvZiBWVC1k
IHBvc3RlZCBpbnRlcnJ1cHRzLCBpbiBzb21lIGV4dHJlbWUKKyAqIGNhc2VzLCB0aGUgcGVyIGNw
dSBsaXN0IHdoaWNoIHNhdmVzIHRoZSBibG9ja2VkIHZDUFUgd2lsbCBiZSB2ZXJ5IGxvbmcsCisg
KiBhbmQgdGhpcyB3aWxsIGFmZmVjdCB0aGUgaW50ZXJydXB0IGxhdGVuY3ksIHNvIGxldCB0aGlz
IGZlYXR1cmUgb2ZmIGJ5CisgKiBkZWZhdWx0IHVudGlsIHdlIGZpbmQgYSBnb29kIHNvbHV0aW9u
IHRvIHJlc29sdmUgaXQuCisgKi8KK2Jvb2wgX19yZWFkX21vc3RseSBpb21tdV9pbnRwb3N0Owor
I2VuZGlmCisKIGludCBfX2luaXQgaW9tbXVfaGFyZHdhcmVfc2V0dXAodm9pZCkKIHsKICAgICBz
dHJ1Y3QgSU9fQVBJQ19yb3V0ZV9lbnRyeSAqKmlvYXBpY19lbnRyaWVzID0gTlVMTDsKLS0tIGEv
eGVuL2luY2x1ZGUveGVuL2lvbW11LmgKKysrIGIveGVuL2luY2x1ZGUveGVuL2lvbW11LmgKQEAg
LTU0LDcgKzU0LDcgQEAgc3RhdGljIGlubGluZSBib29sX3QgZGZuX2VxKGRmbl90IHgsIGRmbgog
CiBleHRlcm4gYm9vbF90IGlvbW11X2VuYWJsZSwgaW9tbXVfZW5hYmxlZDsKIGV4dGVybiBib29s
IGZvcmNlX2lvbW11LCBpb21tdV9xdWFyYW50aW5lLCBpb21tdV92ZXJib3NlLCBpb21tdV9pZ2Z4
OwotZXh0ZXJuIGJvb2xfdCBpb21tdV9zbm9vcCwgaW9tbXVfcWludmFsLCBpb21tdV9pbnRwb3N0
OworZXh0ZXJuIGJvb2xfdCBpb21tdV9zbm9vcCwgaW9tbXVfcWludmFsOwogCiAjaWZkZWYgQ09O
RklHX1g4NgogZXh0ZXJuIGVudW0gX19wYWNrZWQgaW9tbXVfaW50cmVtYXAgewpAQCAtNzQsNiAr
NzQsMTIgQEAgZXh0ZXJuIGVudW0gX19wYWNrZWQgaW9tbXVfaW50cmVtYXAgewogIyBkZWZpbmUg
aW9tbXVfaW50cmVtYXAgZmFsc2UKICNlbmRpZgogCisjaWYgZGVmaW5lZChDT05GSUdfWDg2KSAm
JiBkZWZpbmVkKENPTkZJR19IVk0pCitleHRlcm4gYm9vbCBpb21tdV9pbnRwb3N0OworI2Vsc2UK
KyMgZGVmaW5lIGlvbW11X2ludHBvc3QgZmFsc2UKKyNlbmRpZgorCiAjaWYgZGVmaW5lZChDT05G
SUdfSU9NTVVfRk9SQ0VfUFRfU0hBUkUpCiAjZGVmaW5lIGlvbW11X2hhcF9wdF9zaGFyZSB0cnVl
CiAjZWxpZiBkZWZpbmVkKENPTkZJR19IVk0pCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlz
dHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3hlbi1kZXZlbA==

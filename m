Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 3B09013047B
	for <lists+xen-devel@lfdr.de>; Sat,  4 Jan 2020 22:04:15 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1inqY2-0003F4-Lu; Sat, 04 Jan 2020 21:01:26 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=vM5p=2Z=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1inqY1-0003Ey-G2
 for xen-devel@lists.xenproject.org; Sat, 04 Jan 2020 21:01:25 +0000
X-Inumbo-ID: 5bb30b72-2f35-11ea-a914-bc764e2007e4
Received: from mail-yb1-xb31.google.com (unknown [2607:f8b0:4864:20::b31])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 5bb30b72-2f35-11ea-a914-bc764e2007e4;
 Sat, 04 Jan 2020 21:01:20 +0000 (UTC)
Received: by mail-yb1-xb31.google.com with SMTP id l7so12425796ybp.1
 for <xen-devel@lists.xenproject.org>; Sat, 04 Jan 2020 13:01:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :in-reply-to:references;
 bh=CZfl/dl9ScYmQdwwhWaZQUW3IxIbwMKFNGj7gBDf/k0=;
 b=qjApG186HqrCzSJMFkTaUaSZXClronMbCiuRo6t+S08acncmHiu/+W8IFa+sMgasJ7
 KsyL4E7fN1Kh048d/HFiMdK4nJ5SczUMuaqcoiOi5xR2TFYvIWwN4hfE9f237pD6f6Rf
 CvGy1LVZuIr9/8I9xyvtN3IX/HMlKDwKlvkq9NeGQnvxNiMMP6vKWAPUumWwKOKazsiS
 +qtQN97VGFCH7cUNObA53wYBGavoYvuDUjxw0QFbpTtL52LkHqp9nQkfST+Ymca1gXj+
 bgOZGoV/OohL8rBebgEw3wEGMLczGxzwensvR+fdAVp9WetvLdyg8/AJ+nlNSdkBzoDg
 P5sw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:in-reply-to:references;
 bh=CZfl/dl9ScYmQdwwhWaZQUW3IxIbwMKFNGj7gBDf/k0=;
 b=PspsDvGLzQHMw1Eb31Yf4bRvAL+sSURnSnZTAT7Kdy6QB/HtifZOfSlgg1rVRj1+6L
 c/WQvityWTcaZDEOeBY9ho9M4U01Bc44I7uuWCZFd4PKvcp77mJhcYY5ySJ+aGk64zXH
 C3GdmzJ8aETukNuGmPBeFzryWoIDJ1oIgG13aq2o2Espkj04LUWt8HZxok1rsV1GOjFY
 VbJNmSB2p7yNjmMTPx/ObwOdcuHGUPSXlMHEwtOOgSZTVfS9YCFddBL3vLG1ct2ZzqYX
 gVTqkuZiIffwY7rGl29HTgZg4hGmSV+vPNAzFPb9EomiWoUS/RqEj2qkdQGAdlwzrdUq
 i5ow==
X-Gm-Message-State: APjAAAX/+H4MVYayIVnGzSckPJRVoSqlLOnYVuKIvY0m2L55fan4s2UO
 iRa6pF+N7QkYE1Db5nKjslDYaYl7
X-Google-Smtp-Source: APXvYqw3pa4Wf4hoaKb/ZTXnm0EcQQHQqTul/7ruoKrfyloW4+0l3QcOel1MiD0gTuFrp3pR36R/fg==
X-Received: by 2002:a25:d2d3:: with SMTP id
 j202mr67110040ybg.278.1578171678767; 
 Sat, 04 Jan 2020 13:01:18 -0800 (PST)
Received: from four.lan (cpe-67-241-56-252.twcny.res.rr.com. [67.241.56.252])
 by smtp.gmail.com with ESMTPSA id
 r10sm26366714ywr.97.2020.01.04.13.01.17
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sat, 04 Jan 2020 13:01:18 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
X-Google-Original-From: Nick Rosbrook <rosbrookn@ainfosec.com>
To: xen-devel@lists.xenproject.org
Date: Sat,  4 Jan 2020 16:00:51 -0500
Message-Id: <3a36857aeebe9a8ec3c4bc64f8ee77cdab035d6e.1578170151.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <cover.1578170151.git.rosbrookn@ainfosec.com>
References: <cover.1578170151.git.rosbrookn@ainfosec.com>
In-Reply-To: <cover.1578170151.git.rosbrookn@ainfosec.com>
References: <cover.1578170151.git.rosbrookn@ainfosec.com>
Subject: [Xen-devel] [PATCH v5 1/3] golang/xenlight: begin Go to C type
 marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW1wbGVtZW50IGNvbnZlcnNpb25zIGZvciBiYXNpYyB0eXBlcyBzdWNoIGFzIHN0cmluZ3MgYW5k
IGludGVnZXIKdHlwZXMgaW4gdG9DIGZ1bmN0aW9ucy4KCk1vZGlmeSBmdW5jdGlvbiBzaWduYXR1
cmVzIG9mIHRvQyBpbXBsZW1lbnRhdGlvbnMgZm9yIGJ1aWx0aW4KdHlwZXMgdG8gYmUgY29uc2lz
dGVudCB3aXRoIHRoZSBzaWduYXR1cmUgb2YgdGhlIGdlbmVyYXRlZCB0b0MKZnVuY3Rpb25zLgoK
U2lnbmVkLW9mZi1ieTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KLS0t
CkNoYW5nZXMgaW4gdjU6Ci0gRGVmaW5lIHhlbmxpZ2h0X2dvbGFuZ19jb252ZXJ0X3RvX0Mgc28g
dGhhdCBmaWVsZCBjb252ZXJzaW9uIGNvZGUKICBjYW4gYmUgZWFzaWx5IHJlLXVzZWQuCi0gQ2hl
Y2sgZm9yIGVyciBpbiBkZWZlcidkIGZ1bmMgd2l0aGluIHRvQyB0byBkZXRlcm1pbmUgaWYgdGhl
IGRpc3Bvc2UKICBmdW5jdGlvbiBuZWVkcyB0byBiZSBjYWxsZWQuCi0gUGFzcyBhIHJlZmVyZW5j
ZSB0byB0aGUgQyB0eXBlIGluIHRvQywgcmF0aGVyIHRoYW4gcmV0dXJuaW5nIGEgY29weQogIG9m
IHRoZSBDIHZhcmlhYmxlLgotIFVwZGF0ZSB0aGUgZXhpc3RpbmcgdG9DIGZ1bmN0aW9ucyBmb3Ig
YnVpbHRpbiB0eXBlcyB0byBiZSBjb25zaXN0ZW50CiAgd2l0aCB0aGUgZ2VuZXJhdGVkIGZ1bmN0
aW9ucy4KLSBPbmx5IGNhbGwgQ1N0cmluZyBpZiB0aGUgR28gc3RyaW5nIGlzIG5vbi1lbXB0eS4K
LS0tCiB0b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSAgfCAgIDgxICsrCiB0b29s
cy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28gfCAxNTA2ICsrKysrKysrKysrKysrKysr
KysrKysrKysrCiB0b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28gICAgfCAgIDgyICst
CiAzIGZpbGVzIGNoYW5nZWQsIDE2MjEgaW5zZXJ0aW9ucygrKSwgNDggZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkgYi90b29scy9n
b2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQppbmRleCA4ODU3ZTJlOGZkLi4xNWFhNGJlMjIw
IDEwMDY0NAotLS0gYS90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQorKysgYi90
b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQpAQCAtMjM0LDYgKzIzNCw5IEBAIGRl
ZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJhdGVfaGVscGVycyhwYXRoID0gTm9uZSwgdHlwZXMgPSBO
b25lLCBjb21tZW50ID0gTm9uZSk6CiAgICAgICAgICAgICAgICAgZi53cml0ZShleHRyYSkKICAg
ICAgICAgICAgICAgICBmLndyaXRlKCdcbicpCiAKKyAgICAgICAgICAgIGYud3JpdGUoeGVubGln
aHRfZ29sYW5nX2RlZmluZV90b19DKHR5KSkKKyAgICAgICAgICAgIGYud3JpdGUoJ1xuJykKKwog
ICAgIGdvX2ZtdChwYXRoKQogCiBkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmluZV9mcm9tX0ModHkg
PSBOb25lKToKQEAgLTQzNCw2ICs0MzcsODQgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19hcnJheV9m
cm9tX0ModHkgPSBOb25lKToKIAogICAgIHJldHVybiBzCiAKK2RlZiB4ZW5saWdodF9nb2xhbmdf
ZGVmaW5lX3RvX0ModHkgPSBOb25lLCB0eXBlbmFtZSA9IE5vbmUsIG5lc3RlZCA9IEZhbHNlKToK
KyAgICAiIiIKKyAgICBEZWZpbmUgdGhlIHRvQyBtYXJzaGFsaW5nIGZ1bmN0aW9uIGZvciB0aGUg
dHlwZQorICAgIHJlcHJlc2VudGVkIGJ5IHR5LgorICAgICIiIgorICAgIGZ1bmMgPSAnZnVuYyAo
eCAqe30pIHRvQyh4YyAqQy57fSkgKGVyciBlcnJvcil7e3t9XG4gcmV0dXJuIG5pbCBcbiB9fVxu
JworICAgIGJvZHkgPSAnJworCisgICAgaWYgdHkuZGlzcG9zZV9mbiBpcyBub3QgTm9uZToKKyAg
ICAgICAgYm9keSArPSAnZGVmZXIgZnVuYygpe3tcbmlmIGVyciAhPSBuaWx7e1xuQy57fSh4Yyl9
fVxufX0oKVxuXG4nLmZvcm1hdCh0eS5kaXNwb3NlX2ZuKQorCisgICAgZ29uYW1lID0geGVubGln
aHRfZ29sYW5nX2ZtdF9uYW1lKHR5LnR5cGVuYW1lKQorICAgIGNuYW1lICA9IHR5LnR5cGVuYW1l
CisKKyAgICBmb3IgZiBpbiB0eS5maWVsZHM6CisgICAgICAgIGlmIGYudHlwZS50eXBlbmFtZSBp
cyBub3QgTm9uZToKKyAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuQXJyYXkp
OgorICAgICAgICAgICAgICAgICMgVE9ETworICAgICAgICAgICAgICAgIGNvbnRpbnVlCisKKyAg
ICAgICAgICAgIGJvZHkgKz0geGVubGlnaHRfZ29sYW5nX2NvbnZlcnRfdG9fQyhmKQorCisgICAg
ICAgIGVsaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5TdHJ1Y3QpOgorICAgICAgICAgICAgZm9y
IG5mIGluIGYudHlwZS5maWVsZHM6CisgICAgICAgICAgICAgICAgYm9keSArPSB4ZW5saWdodF9n
b2xhbmdfY29udmVydF90b19DKG5mLCBvdXRlcl9uYW1lPWYubmFtZSkKKworICAgICAgICBlbGlm
IGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuS2V5ZWRVbmlvbik6CisgICAgICAgICAgICAjIFRPRE8K
KyAgICAgICAgICAgIHBhc3MKKworICAgICAgICBlbHNlOgorICAgICAgICAgICAgcmFpc2UgRXhj
ZXB0aW9uKCd0eXBlIHt9IG5vdCBzdXBwb3J0ZWQnLmZvcm1hdChmLnR5cGUpKQorCisgICAgcmV0
dXJuIGZ1bmMuZm9ybWF0KGdvbmFtZSwgY25hbWUsIGJvZHkpCisKK2RlZiB4ZW5saWdodF9nb2xh
bmdfY29udmVydF90b19DKHR5ID0gTm9uZSwgb3V0ZXJfbmFtZSA9IE5vbmUpOgorICAgICIiIgor
ICAgIFJldHVybnMgYSBsaW5lIG9mIEdvIGNvZGUgdGhhdCBjb252ZXJ0cyB0aGUgR28gdHlwZSBy
ZXByZXNlbnRlZAorICAgIGJ5IHR5IHRvIGl0cyBjb3JyZXNwb25kaW5nIEdvIHR5cGUuCisKKyAg
ICBJZiBvdXRlcl9uYW1lIGlzIHNldCwgdGhlIHR5cGUgaXMgdHJlYXRlZCBhcyBuZXN0ZWQgd2l0
aGluIGFub3RoZXIgZmllbGQKKyAgICBuYW1lZCBvdXRlcl9uYW1lLgorICAgICIiIgorICAgIHMg
PSAnJworCisgICAgZ290eXBlbmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eS50eXBl
LnR5cGVuYW1lKQorICAgIGN0eXBlbmFtZSAgPSB0eS50eXBlLnR5cGVuYW1lCisgICAgZ29uYW1l
ICAgICA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eS5uYW1lKQorICAgIGNuYW1lICAgICAg
PSB0eS5uYW1lCisKKyAgICAjIEluIGNnbywgQyBuYW1lcyB0aGF0IGNvbmZsaWN0IHdpdGggR28g
a2V5d29yZHMgY2FuIGJlCisgICAgIyBhY2Nlc3NlZCBieSBwcmVwZW5kaW5nIGFuIHVuZGVyc2Nv
cmUgdG8gdGhlIG5hbWUuCisgICAgaWYgY25hbWUgaW4gZ29fa2V5d29yZHM6CisgICAgICAgIGNu
YW1lID0gJ18nICsgY25hbWUKKworICAgICMgSWYgb3V0ZXJfbmFtZSBpcyBzZXQsIHRyZWF0IHRo
aXMgYXMgbmVzdGVkLgorICAgIGlmIG91dGVyX25hbWUgaXMgbm90IE5vbmU6CisgICAgICAgIGdv
bmFtZSA9ICd7fS57fScuZm9ybWF0KHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShvdXRlcl9uYW1l
KSwgZ29uYW1lKQorICAgICAgICBjbmFtZSAgPSAne30ue30nLmZvcm1hdChvdXRlcl9uYW1lLCBj
bmFtZSkKKworICAgIGlzX2Nhc3RhYmxlID0gKHR5LnR5cGUuanNvbl9wYXJzZV90eXBlID09ICdK
U09OX0lOVEVHRVInIG9yCisgICAgICAgICAgICAgICAgICAgaXNpbnN0YW5jZSh0eS50eXBlLCBp
ZGwuRW51bWVyYXRpb24pIG9yCisgICAgICAgICAgICAgICAgICAgZ290eXBlbmFtZSBpbiBnb19i
dWlsdGluX3R5cGVzKQorCisgICAgaWYgbm90IGlzX2Nhc3RhYmxlOgorICAgICAgICBzICs9ICdp
ZiBlcnIgOj0geC57fS50b0MoJnhjLnt9KTsgZXJyICE9IG5pbCB7e1xuJy5mb3JtYXQoZ29uYW1l
LGNuYW1lKQorICAgICAgICBzICs9ICdyZXR1cm4gZXJyXG59XG4nCisKKyAgICBlbGlmIGdvdHlw
ZW5hbWUgPT0gJ3N0cmluZyc6CisgICAgICAgICMgVXNlIHRoZSBjZ28gaGVscGVyIGZvciBjb252
ZXJ0aW5nIEMgc3RyaW5ncy4KKyAgICAgICAgcyArPSAnaWYgeC57fSAhPSAiIiB7e1xuJy5mb3Jt
YXQoZ29uYW1lKQorICAgICAgICBzICs9ICd4Yy57fSA9IEMuQ1N0cmluZyh4Lnt9KX19XG4nLmZv
cm1hdChjbmFtZSxnb25hbWUpCisKKyAgICBlbHNlOgorICAgICAgICBzICs9ICd4Yy57fSA9IEMu
e30oeC57fSlcbicuZm9ybWF0KGNuYW1lLGN0eXBlbmFtZSxnb25hbWUpCisKKyAgICByZXR1cm4g
cworCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG5hbWUsIGV4cG9ydGVkID0gVHJ1ZSk6
CiAgICAgIiIiCiAgICAgVGFrZSBhIGdpdmVuIHR5cGUgbmFtZSBhbmQgcmV0dXJuIGFuCmRpZmYg
LS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28gYi90b29scy9nb2xh
bmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5kZXggMjUyOTRiYTI5Mi4uMzBjZDFhOWIzZiAx
MDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvCisrKyBiL3Rv
b2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwpAQCAtMzcsNiArMzcsMTkgQEAgZnVu
YyAoeCAqSW9wb3J0UmFuZ2UpIGZyb21DKHhjICpDLmxpYnhsX2lvcG9ydF9yYW5nZSkgZXJyb3Ig
ewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqSW9wb3J0UmFuZ2UpIHRvQyh4YyAqQy5saWJ4
bF9pb3BvcnRfcmFuZ2UpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIg
IT0gbmlsIHsKKwkJCUMubGlieGxfaW9wb3J0X3JhbmdlX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkK
KworCXhjLmZpcnN0ID0gQy51aW50MzJfdCh4LkZpcnN0KQorCXhjLm51bWJlciA9IEMudWludDMy
X3QoeC5OdW1iZXIpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKklvbWVtUmFuZ2UpIGZy
b21DKHhjICpDLmxpYnhsX2lvbWVtX3JhbmdlKSBlcnJvciB7CiAJeC5TdGFydCA9IHVpbnQ2NCh4
Yy5zdGFydCkKIAl4Lk51bWJlciA9IHVpbnQ2NCh4Yy5udW1iZXIpCkBAIC00NSwxMiArNTgsMzgg
QEAgZnVuYyAoeCAqSW9tZW1SYW5nZSkgZnJvbUMoeGMgKkMubGlieGxfaW9tZW1fcmFuZ2UpIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKklvbWVtUmFuZ2UpIHRvQyh4YyAqQy5s
aWJ4bF9pb21lbV9yYW5nZSkgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVy
ciAhPSBuaWwgeworCQkJQy5saWJ4bF9pb21lbV9yYW5nZV9kaXNwb3NlKHhjKQorCQl9CisJfSgp
CisKKwl4Yy5zdGFydCA9IEMudWludDY0X3QoeC5TdGFydCkKKwl4Yy5udW1iZXIgPSBDLnVpbnQ2
NF90KHguTnVtYmVyKQorCXhjLmdmbiA9IEMudWludDY0X3QoeC5HZm4pCisKKwlyZXR1cm4gbmls
Cit9CisKIGZ1bmMgKHggKlZnYUludGVyZmFjZUluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZnYV9p
bnRlcmZhY2VfaW5mbykgZXJyb3IgewogCXguS2luZCA9IFZnYUludGVyZmFjZVR5cGUoeGMua2lu
ZCkKIAogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVmdhSW50ZXJmYWNlSW5mbykgdG9DKHhj
ICpDLmxpYnhsX3ZnYV9pbnRlcmZhY2VfaW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMo
KSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF92Z2FfaW50ZXJmYWNlX2luZm9fZGlz
cG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMua2luZCA9IEMubGlieGxfdmdhX2ludGVyZmFjZV90
eXBlKHguS2luZCkKKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqVm5jSW5mbykgZnJvbUMo
eGMgKkMubGlieGxfdm5jX2luZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJvbUMo
JnhjLmVuYWJsZSk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZXJyCkBAIC02NSw2ICsxMDQsMzAg
QEAgZnVuYyAoeCAqVm5jSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm5jX2luZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZuY0luZm8pIHRvQyh4YyAqQy5saWJ4bF92bmNf
aW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgewor
CQkJQy5saWJ4bF92bmNfaW5mb19kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwlpZiBlcnIgOj0g
eC5FbmFibGUudG9DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
KwlpZiB4Lkxpc3RlbiAhPSAiIiB7CisJCXhjLmxpc3RlbiA9IEMuQ1N0cmluZyh4Lkxpc3RlbikK
Kwl9CisJaWYgeC5QYXNzd2QgIT0gIiIgeworCQl4Yy5wYXNzd2QgPSBDLkNTdHJpbmcoeC5QYXNz
d2QpCisJfQorCXhjLmRpc3BsYXkgPSBDLmludCh4LkRpc3BsYXkpCisJaWYgZXJyIDo9IHguRmlu
ZHVudXNlZC50b0MoJnhjLmZpbmR1bnVzZWQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgor
CX0KKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqU3BpY2VJbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF9zcGljZV9pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9IHguRW5hYmxlLmZyb21DKCZ4Yy5l
bmFibGUpOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGVycgpAQCAtOTIsNiArMTU1LDQ3IEBAIGZ1
bmMgKHggKlNwaWNlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfc3BpY2VfaW5mbykgZXJyb3Igewog
CXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqU3BpY2VJbmZvKSB0b0MoeGMgKkMubGlieGxfc3Bp
Y2VfaW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwg
eworCQkJQy5saWJ4bF9zcGljZV9pbmZvX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCWlmIGVy
ciA6PSB4LkVuYWJsZS50b0MoJnhjLmVuYWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJy
CisJfQorCXhjLnBvcnQgPSBDLmludCh4LlBvcnQpCisJeGMudGxzX3BvcnQgPSBDLmludCh4LlRs
c1BvcnQpCisJaWYgeC5Ib3N0ICE9ICIiIHsKKwkJeGMuaG9zdCA9IEMuQ1N0cmluZyh4Lkhvc3Qp
CisJfQorCWlmIGVyciA6PSB4LkRpc2FibGVUaWNrZXRpbmcudG9DKCZ4Yy5kaXNhYmxlX3RpY2tl
dGluZyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIHguUGFzc3dkICE9ICIi
IHsKKwkJeGMucGFzc3dkID0gQy5DU3RyaW5nKHguUGFzc3dkKQorCX0KKwlpZiBlcnIgOj0geC5B
Z2VudE1vdXNlLnRvQygmeGMuYWdlbnRfbW91c2UpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwlpZiBlcnIgOj0geC5WZGFnZW50LnRvQygmeGMudmRhZ2VudCk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkNsaXBib2FyZFNoYXJpbmcudG9DKCZ4
Yy5jbGlwYm9hcmRfc2hhcmluZyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXhj
LnVzYnJlZGlyZWN0aW9uID0gQy5pbnQoeC5Vc2JyZWRpcmVjdGlvbikKKwlpZiB4LkltYWdlQ29t
cHJlc3Npb24gIT0gIiIgeworCQl4Yy5pbWFnZV9jb21wcmVzc2lvbiA9IEMuQ1N0cmluZyh4Lklt
YWdlQ29tcHJlc3Npb24pCisJfQorCWlmIHguU3RyZWFtaW5nVmlkZW8gIT0gIiIgeworCQl4Yy5z
dHJlYW1pbmdfdmlkZW8gPSBDLkNTdHJpbmcoeC5TdHJlYW1pbmdWaWRlbykKKwl9CisKKwlyZXR1
cm4gbmlsCit9CisKIGZ1bmMgKHggKlNkbEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3NkbF9pbmZv
KSBlcnJvciB7CiAJaWYgZXJyIDo9IHguRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0g
bmlsIHsKIAkJcmV0dXJuIGVycgpAQCAtMTA1LDYgKzIwOSwyOSBAQCBmdW5jICh4ICpTZGxJbmZv
KSBmcm9tQyh4YyAqQy5saWJ4bF9zZGxfaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAor
ZnVuYyAoeCAqU2RsSW5mbykgdG9DKHhjICpDLmxpYnhsX3NkbF9pbmZvKSAoZXJyIGVycm9yKSB7
CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX3NkbF9pbmZv
X2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCWlmIGVyciA6PSB4LkVuYWJsZS50b0MoJnhjLmVu
YWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4Lk9wZW5n
bC50b0MoJnhjLm9wZW5nbCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIHgu
RGlzcGxheSAhPSAiIiB7CisJCXhjLmRpc3BsYXkgPSBDLkNTdHJpbmcoeC5EaXNwbGF5KQorCX0K
KwlpZiB4LlhhdXRob3JpdHkgIT0gIiIgeworCQl4Yy54YXV0aG9yaXR5ID0gQy5DU3RyaW5nKHgu
WGF1dGhvcml0eSkKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkRvbWluZm8pIGZy
b21DKHhjICpDLmxpYnhsX2RvbWluZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5VdWlkLmZyb21D
KCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBlcnIKQEAgLTEzMyw2ICsyNjAsNDIg
QEAgZnVuYyAoeCAqRG9taW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9taW5mbykgZXJyb3Igewog
CXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRG9taW5mbykgdG9DKHhjICpDLmxpYnhsX2RvbWlu
Zm8pIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJ
CUMubGlieGxfZG9taW5mb19kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwlpZiBlcnIgOj0geC5V
dWlkLnRvQygmeGMudXVpZCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXhjLmRv
bWlkID0gQy5saWJ4bF9kb21pZCh4LkRvbWlkKQorCXhjLnNzaWRyZWYgPSBDLnVpbnQzMl90KHgu
U3NpZHJlZikKKwlpZiB4LlNzaWRMYWJlbCAhPSAiIiB7CisJCXhjLnNzaWRfbGFiZWwgPSBDLkNT
dHJpbmcoeC5Tc2lkTGFiZWwpCisJfQorCXhjLnJ1bm5pbmcgPSBDLmJvb2woeC5SdW5uaW5nKQor
CXhjLmJsb2NrZWQgPSBDLmJvb2woeC5CbG9ja2VkKQorCXhjLnBhdXNlZCA9IEMuYm9vbCh4LlBh
dXNlZCkKKwl4Yy5zaHV0ZG93biA9IEMuYm9vbCh4LlNodXRkb3duKQorCXhjLmR5aW5nID0gQy5i
b29sKHguRHlpbmcpCisJeGMubmV2ZXJfc3RvcCA9IEMuYm9vbCh4Lk5ldmVyU3RvcCkKKwl4Yy5z
aHV0ZG93bl9yZWFzb24gPSBDLmxpYnhsX3NodXRkb3duX3JlYXNvbih4LlNodXRkb3duUmVhc29u
KQorCXhjLm91dHN0YW5kaW5nX21lbWtiID0gQy51aW50NjRfdCh4Lk91dHN0YW5kaW5nTWVta2Ip
CisJeGMuY3VycmVudF9tZW1rYiA9IEMudWludDY0X3QoeC5DdXJyZW50TWVta2IpCisJeGMuc2hh
cmVkX21lbWtiID0gQy51aW50NjRfdCh4LlNoYXJlZE1lbWtiKQorCXhjLnBhZ2VkX21lbWtiID0g
Qy51aW50NjRfdCh4LlBhZ2VkTWVta2IpCisJeGMubWF4X21lbWtiID0gQy51aW50NjRfdCh4Lk1h
eE1lbWtiKQorCXhjLmNwdV90aW1lID0gQy51aW50NjRfdCh4LkNwdVRpbWUpCisJeGMudmNwdV9t
YXhfaWQgPSBDLnVpbnQzMl90KHguVmNwdU1heElkKQorCXhjLnZjcHVfb25saW5lID0gQy51aW50
MzJfdCh4LlZjcHVPbmxpbmUpCisJeGMuY3B1cG9vbCA9IEMudWludDMyX3QoeC5DcHVwb29sKQor
CXhjLmRvbWFpbl90eXBlID0gQy5saWJ4bF9kb21haW5fdHlwZSh4LkRvbWFpblR5cGUpCisKKwly
ZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkNwdXBvb2xpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9j
cHVwb29saW5mbykgZXJyb3IgewogCXguUG9vbGlkID0gdWludDMyKHhjLnBvb2xpZCkKIAl4LlBv
b2xOYW1lID0gQy5Hb1N0cmluZyh4Yy5wb29sX25hbWUpCkBAIC0xNDUsNiArMzA4LDI2IEBAIGZ1
bmMgKHggKkNwdXBvb2xpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jcHVwb29saW5mbykgZXJyb3Ig
ewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqQ3B1cG9vbGluZm8pIHRvQyh4YyAqQy5saWJ4
bF9jcHVwb29saW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAh
PSBuaWwgeworCQkJQy5saWJ4bF9jcHVwb29saW5mb19kaXNwb3NlKHhjKQorCQl9CisJfSgpCisK
Kwl4Yy5wb29saWQgPSBDLnVpbnQzMl90KHguUG9vbGlkKQorCWlmIHguUG9vbE5hbWUgIT0gIiIg
eworCQl4Yy5wb29sX25hbWUgPSBDLkNTdHJpbmcoeC5Qb29sTmFtZSkKKwl9CisJeGMuc2NoZWQg
PSBDLmxpYnhsX3NjaGVkdWxlcih4LlNjaGVkKQorCXhjLm5fZG9tID0gQy51aW50MzJfdCh4Lk5E
b20pCisJaWYgZXJyIDo9IHguQ3B1bWFwLnRvQygmeGMuY3B1bWFwKTsgZXJyICE9IG5pbCB7CisJ
CXJldHVybiBlcnIKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkNoYW5uZWxpbmZv
KSBmcm9tQyh4YyAqQy5saWJ4bF9jaGFubmVsaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMu
R29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lk
KQpAQCAtMTc5LDYgKzM2MiwyOSBAQCBmdW5jICh4ICpDaGFubmVsaW5mb0Nvbm5lY3Rpb25Vbmlv
blB0eSkgZnJvbUMoeGMgKkMubGlieGxfY2hhbm5lbGluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmls
CiB9CiAKK2Z1bmMgKHggKkNoYW5uZWxpbmZvKSB0b0MoeGMgKkMubGlieGxfY2hhbm5lbGluZm8p
IChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMu
bGlieGxfY2hhbm5lbGluZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJaWYgeC5CYWNrZW5k
ICE9ICIiIHsKKwkJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQpCisJfQorCXhjLmJh
Y2tlbmRfaWQgPSBDLnVpbnQzMl90KHguQmFja2VuZElkKQorCWlmIHguRnJvbnRlbmQgIT0gIiIg
eworCQl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCX0KKwl4Yy5mcm9udGVu
ZF9pZCA9IEMudWludDMyX3QoeC5Gcm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZp
ZCh4LkRldmlkKQorCXhjLnN0YXRlID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50
KHguRXZ0Y2gpCisJeGMucnJlZiA9IEMuaW50KHguUnJlZikKKworCXJldHVybiBuaWwKK30KKwog
ZnVuYyAoeCAqVm1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bWluZm8pIGVycm9yIHsKIAlpZiBl
cnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBlcnIK
QEAgLTE4OCw2ICszOTQsMjEgQEAgZnVuYyAoeCAqVm1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92
bWluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZtaW5mbykgdG9DKHhj
ICpDLmxpYnhsX3ZtaW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVy
ciAhPSBuaWwgeworCQkJQy5saWJ4bF92bWluZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJ
aWYgZXJyIDo9IHguVXVpZC50b0MoJnhjLnV1aWQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwl4Yy5kb21pZCA9IEMubGlieGxfZG9taWQoeC5Eb21pZCkKKworCXJldHVybiBuaWwK
K30KKwogZnVuYyAoeCAqVmVyc2lvbkluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZlcnNpb25faW5m
bykgZXJyb3IgewogCXguWGVuVmVyc2lvbk1ham9yID0gaW50KHhjLnhlbl92ZXJzaW9uX21ham9y
KQogCXguWGVuVmVyc2lvbk1pbm9yID0gaW50KHhjLnhlbl92ZXJzaW9uX21pbm9yKQpAQCAtMjA2
LDYgKzQyNyw0OCBAQCBmdW5jICh4ICpWZXJzaW9uSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmVy
c2lvbl9pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWZXJzaW9uSW5m
bykgdG9DKHhjICpDLmxpYnhsX3ZlcnNpb25faW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1
bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF92ZXJzaW9uX2luZm9fZGlzcG9z
ZSh4YykKKwkJfQorCX0oKQorCisJeGMueGVuX3ZlcnNpb25fbWFqb3IgPSBDLmludCh4LlhlblZl
cnNpb25NYWpvcikKKwl4Yy54ZW5fdmVyc2lvbl9taW5vciA9IEMuaW50KHguWGVuVmVyc2lvbk1p
bm9yKQorCWlmIHguWGVuVmVyc2lvbkV4dHJhICE9ICIiIHsKKwkJeGMueGVuX3ZlcnNpb25fZXh0
cmEgPSBDLkNTdHJpbmcoeC5YZW5WZXJzaW9uRXh0cmEpCisJfQorCWlmIHguQ29tcGlsZXIgIT0g
IiIgeworCQl4Yy5jb21waWxlciA9IEMuQ1N0cmluZyh4LkNvbXBpbGVyKQorCX0KKwlpZiB4LkNv
bXBpbGVCeSAhPSAiIiB7CisJCXhjLmNvbXBpbGVfYnkgPSBDLkNTdHJpbmcoeC5Db21waWxlQnkp
CisJfQorCWlmIHguQ29tcGlsZURvbWFpbiAhPSAiIiB7CisJCXhjLmNvbXBpbGVfZG9tYWluID0g
Qy5DU3RyaW5nKHguQ29tcGlsZURvbWFpbikKKwl9CisJaWYgeC5Db21waWxlRGF0ZSAhPSAiIiB7
CisJCXhjLmNvbXBpbGVfZGF0ZSA9IEMuQ1N0cmluZyh4LkNvbXBpbGVEYXRlKQorCX0KKwlpZiB4
LkNhcGFiaWxpdGllcyAhPSAiIiB7CisJCXhjLmNhcGFiaWxpdGllcyA9IEMuQ1N0cmluZyh4LkNh
cGFiaWxpdGllcykKKwl9CisJaWYgeC5DaGFuZ2VzZXQgIT0gIiIgeworCQl4Yy5jaGFuZ2VzZXQg
PSBDLkNTdHJpbmcoeC5DaGFuZ2VzZXQpCisJfQorCXhjLnZpcnRfc3RhcnQgPSBDLnVpbnQ2NF90
KHguVmlydFN0YXJ0KQorCXhjLnBhZ2VzaXplID0gQy5pbnQoeC5QYWdlc2l6ZSkKKwlpZiB4LkNv
bW1hbmRsaW5lICE9ICIiIHsKKwkJeGMuY29tbWFuZGxpbmUgPSBDLkNTdHJpbmcoeC5Db21tYW5k
bGluZSkKKwl9CisJaWYgeC5CdWlsZElkICE9ICIiIHsKKwkJeGMuYnVpbGRfaWQgPSBDLkNTdHJp
bmcoeC5CdWlsZElkKQorCX0KKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWluQ3Jl
YXRlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvKSBlcnJvciB7CiAJ
eC5UeXBlID0gRG9tYWluVHlwZSh4Yy5fdHlwZSkKIAlpZiBlcnIgOj0geC5IYXAuZnJvbUMoJnhj
LmhhcCk7IGVyciAhPSBuaWwgewpAQCAtMjM5LDYgKzUwMiw1MSBAQCBmdW5jICh4ICpEb21haW5D
cmVhdGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIHRvQyh4YyAqQy5s
aWJ4bF9kb21haW5fY3JlYXRlX2luZm8pIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgewor
CQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2Uo
eGMpCisJCX0KKwl9KCkKKworCXhjLl90eXBlID0gQy5saWJ4bF9kb21haW5fdHlwZSh4LlR5cGUp
CisJaWYgZXJyIDo9IHguSGFwLnRvQygmeGMuaGFwKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJaWYgZXJyIDo9IHguT29zLnRvQygmeGMub29zKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBlcnIKKwl9CisJeGMuc3NpZHJlZiA9IEMudWludDMyX3QoeC5Tc2lkcmVmKQorCWlmIHgu
U3NpZExhYmVsICE9ICIiIHsKKwkJeGMuc3NpZF9sYWJlbCA9IEMuQ1N0cmluZyh4LlNzaWRMYWJl
bCkKKwl9CisJaWYgeC5OYW1lICE9ICIiIHsKKwkJeGMubmFtZSA9IEMuQ1N0cmluZyh4Lk5hbWUp
CisJfQorCWlmIGVyciA6PSB4LlV1aWQudG9DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguWHNkYXRhLnRvQygmeGMueHNkYXRhKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguUGxhdGZvcm1kYXRhLnRvQygm
eGMucGxhdGZvcm1kYXRhKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeGMucG9v
bGlkID0gQy51aW50MzJfdCh4LlBvb2xpZCkKKwlpZiB4LlBvb2xOYW1lICE9ICIiIHsKKwkJeGMu
cG9vbF9uYW1lID0gQy5DU3RyaW5nKHguUG9vbE5hbWUpCisJfQorCWlmIGVyciA6PSB4LlJ1bkhv
dHBsdWdTY3JpcHRzLnRvQygmeGMucnVuX2hvdHBsdWdfc2NyaXB0cyk7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkRyaXZlckRvbWFpbi50b0MoJnhjLmRyaXZl
cl9kb21haW4pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4Yy5wYXNzdGhyb3Vn
aCA9IEMubGlieGxfcGFzc3Rocm91Z2goeC5QYXNzdGhyb3VnaCkKKworCXJldHVybiBuaWwKK30K
KwogZnVuYyAoeCAqRG9tYWluUmVzdG9yZVBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWlu
X3Jlc3RvcmVfcGFyYW1zKSBlcnJvciB7CiAJeC5DaGVja3BvaW50ZWRTdHJlYW0gPSBpbnQoeGMu
Y2hlY2twb2ludGVkX3N0cmVhbSkKIAl4LlN0cmVhbVZlcnNpb24gPSB1aW50MzIoeGMuc3RyZWFt
X3ZlcnNpb24pCkBAIC0yNTAsNiArNTU4LDI1IEBAIGZ1bmMgKHggKkRvbWFpblJlc3RvcmVQYXJh
bXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgZXJyb3IgewogCXJl
dHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRG9tYWluUmVzdG9yZVBhcmFtcykgdG9DKHhjICpDLmxp
YnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7
CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXNfZGlz
cG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuY2hlY2twb2ludGVkX3N0cmVhbSA9IEMuaW50KHgu
Q2hlY2twb2ludGVkU3RyZWFtKQorCXhjLnN0cmVhbV92ZXJzaW9uID0gQy51aW50MzJfdCh4LlN0
cmVhbVZlcnNpb24pCisJaWYgeC5Db2xvUHJveHlTY3JpcHQgIT0gIiIgeworCQl4Yy5jb2xvX3By
b3h5X3NjcmlwdCA9IEMuQ1N0cmluZyh4LkNvbG9Qcm94eVNjcmlwdCkKKwl9CisJaWYgZXJyIDo9
IHguVXNlcnNwYWNlQ29sb1Byb3h5LnRvQygmeGMudXNlcnNwYWNlX2NvbG9fcHJveHkpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAq
U2NoZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXgu
VmNwdWlkID0gaW50KHhjLnZjcHVpZCkKIAl4LldlaWdodCA9IGludCh4Yy53ZWlnaHQpCkBAIC0y
NjEsNiArNTg4LDIzIEBAIGZ1bmMgKHggKlNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9z
Y2hlZF9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlNjaGVkUGFy
YW1zKSB0b0MoeGMgKkMubGlieGxfc2NoZWRfcGFyYW1zKSAoZXJyIGVycm9yKSB7CisJZGVmZXIg
ZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX3NjaGVkX3BhcmFtc19kaXNw
b3NlKHhjKQorCQl9CisJfSgpCisKKwl4Yy52Y3B1aWQgPSBDLmludCh4LlZjcHVpZCkKKwl4Yy53
ZWlnaHQgPSBDLmludCh4LldlaWdodCkKKwl4Yy5jYXAgPSBDLmludCh4LkNhcCkKKwl4Yy5wZXJp
b2QgPSBDLmludCh4LlBlcmlvZCkKKwl4Yy5leHRyYXRpbWUgPSBDLmludCh4LkV4dHJhdGltZSkK
Kwl4Yy5idWRnZXQgPSBDLmludCh4LkJ1ZGdldCkKKworCXJldHVybiBuaWwKK30KKwogZnVuYyAo
eCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFtcykg
ZXJyb3IgewogCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2NoZWQpCiAJbnVtVmNwdXMgOj0gaW50
KHhjLm51bV92Y3B1cykKQEAgLTI3NSw2ICs2MTksMTggQEAgZnVuYyAoeCAqVmNwdVNjaGVkUGFy
YW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXJldHVy
biBuaWwKIH0KIAorZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSB0b0MoeGMgKkMubGlieGxfdmNw
dV9zY2hlZF9wYXJhbXMpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIg
IT0gbmlsIHsKKwkJCUMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXNfZGlzcG9zZSh4YykKKwkJfQor
CX0oKQorCisJeGMuc2NoZWQgPSBDLmxpYnhsX3NjaGVkdWxlcih4LlNjaGVkKQorCisJcmV0dXJu
IG5pbAorfQorCiBmdW5jICh4ICpEb21haW5TY2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxf
ZG9tYWluX3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2No
ZWQpCiAJeC5XZWlnaHQgPSBpbnQoeGMud2VpZ2h0KQpAQCAtMjg4LDYgKzY0NCwyNSBAQCBmdW5j
ICh4ICpEb21haW5TY2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3NjaGVkX3Bh
cmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRG9tYWluU2NoZWRQYXJh
bXMpIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zKSAoZXJyIGVycm9yKSB7CisJ
ZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX2RvbWFpbl9zY2hl
ZF9wYXJhbXNfZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuc2NoZWQgPSBDLmxpYnhsX3Nj
aGVkdWxlcih4LlNjaGVkKQorCXhjLndlaWdodCA9IEMuaW50KHguV2VpZ2h0KQorCXhjLmNhcCA9
IEMuaW50KHguQ2FwKQorCXhjLnBlcmlvZCA9IEMuaW50KHguUGVyaW9kKQorCXhjLmJ1ZGdldCA9
IEMuaW50KHguQnVkZ2V0KQorCXhjLmV4dHJhdGltZSA9IEMuaW50KHguRXh0cmF0aW1lKQorCXhj
LnNsaWNlID0gQy5pbnQoeC5TbGljZSkKKwl4Yy5sYXRlbmN5ID0gQy5pbnQoeC5MYXRlbmN5KQor
CisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4ICpWbm9kZUluZm8pIGZyb21DKHhjICpDLmxpYnhs
X3Zub2RlX2luZm8pIGVycm9yIHsKIAl4Lk1lbWtiID0gdWludDY0KHhjLm1lbWtiKQogCW51bURp
c3RhbmNlcyA6PSBpbnQoeGMubnVtX2Rpc3RhbmNlcykKQEAgLTMwNCw2ICs2NzksMjIgQEAgZnVu
YyAoeCAqVm5vZGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSBlcnJvciB7CiAJ
cmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWbm9kZUluZm8pIHRvQyh4YyAqQy5saWJ4bF92bm9k
ZV9pbmZvKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7
CisJCQlDLmxpYnhsX3Zub2RlX2luZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMubWVt
a2IgPSBDLnVpbnQ2NF90KHguTWVta2IpCisJeGMucG5vZGUgPSBDLnVpbnQzMl90KHguUG5vZGUp
CisJaWYgZXJyIDo9IHguVmNwdXMudG9DKCZ4Yy52Y3B1cyk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gZXJyCisJfQorCisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4ICpSZG1SZXNlcnZlKSBmcm9t
Qyh4YyAqQy5saWJ4bF9yZG1fcmVzZXJ2ZSkgZXJyb3IgewogCXguU3RyYXRlZ3kgPSBSZG1SZXNl
cnZlU3RyYXRlZ3koeGMuc3RyYXRlZ3kpCiAJeC5Qb2xpY3kgPSBSZG1SZXNlcnZlUG9saWN5KHhj
LnBvbGljeSkKQEAgLTMxMSw2ICs3MDIsMTkgQEAgZnVuYyAoeCAqUmRtUmVzZXJ2ZSkgZnJvbUMo
eGMgKkMubGlieGxfcmRtX3Jlc2VydmUpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMg
KHggKlJkbVJlc2VydmUpIHRvQyh4YyAqQy5saWJ4bF9yZG1fcmVzZXJ2ZSkgKGVyciBlcnJvcikg
eworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9yZG1fcmVz
ZXJ2ZV9kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwl4Yy5zdHJhdGVneSA9IEMubGlieGxfcmRt
X3Jlc2VydmVfc3RyYXRlZ3koeC5TdHJhdGVneSkKKwl4Yy5wb2xpY3kgPSBDLmxpYnhsX3JkbV9y
ZXNlcnZlX3BvbGljeSh4LlBvbGljeSkKKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRG9t
YWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3Ig
ewogCXguTWF4VmNwdXMgPSBpbnQoeGMubWF4X3ZjcHVzKQogCWlmIGVyciA6PSB4LkF2YWlsVmNw
dXMuZnJvbUMoJnhjLmF2YWlsX3ZjcHVzKTsgZXJyICE9IG5pbCB7CkBAIC02MTMsNiArMTAxNywx
MjAgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uUHZoKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHgg
KkRvbWFpbkJ1aWxkSW5mbykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSAoZXJy
IGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhs
X2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCXhjLm1heF92Y3B1
cyA9IEMuaW50KHguTWF4VmNwdXMpCisJaWYgZXJyIDo9IHguQXZhaWxWY3B1cy50b0MoJnhjLmF2
YWlsX3ZjcHVzKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHgu
Q3B1bWFwLnRvQygmeGMuY3B1bWFwKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJ
aWYgZXJyIDo9IHguTm9kZW1hcC50b0MoJnhjLm5vZGVtYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5OdW1hUGxhY2VtZW50LnRvQygmeGMubnVtYV9wbGFj
ZW1lbnQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4Yy50c2NfbW9kZSA9IEMu
bGlieGxfdHNjX21vZGUoeC5Uc2NNb2RlKQorCXhjLm1heF9tZW1rYiA9IEMudWludDY0X3QoeC5N
YXhNZW1rYikKKwl4Yy50YXJnZXRfbWVta2IgPSBDLnVpbnQ2NF90KHguVGFyZ2V0TWVta2IpCisJ
eGMudmlkZW9fbWVta2IgPSBDLnVpbnQ2NF90KHguVmlkZW9NZW1rYikKKwl4Yy5zaGFkb3dfbWVt
a2IgPSBDLnVpbnQ2NF90KHguU2hhZG93TWVta2IpCisJeGMuaW9tbXVfbWVta2IgPSBDLnVpbnQ2
NF90KHguSW9tbXVNZW1rYikKKwl4Yy5ydGNfdGltZW9mZnNldCA9IEMudWludDMyX3QoeC5SdGNU
aW1lb2Zmc2V0KQorCXhjLmV4ZWNfc3NpZHJlZiA9IEMudWludDMyX3QoeC5FeGVjU3NpZHJlZikK
KwlpZiB4LkV4ZWNTc2lkTGFiZWwgIT0gIiIgeworCQl4Yy5leGVjX3NzaWRfbGFiZWwgPSBDLkNT
dHJpbmcoeC5FeGVjU3NpZExhYmVsKQorCX0KKwlpZiBlcnIgOj0geC5Mb2NhbHRpbWUudG9DKCZ4
Yy5sb2NhbHRpbWUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0g
eC5EaXNhYmxlTWlncmF0ZS50b0MoJnhjLmRpc2FibGVfbWlncmF0ZSk7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkNwdWlkLnRvQygmeGMuY3B1aWQpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiB4LkJsa2RldlN0YXJ0ICE9ICIiIHsKKwkJ
eGMuYmxrZGV2X3N0YXJ0ID0gQy5DU3RyaW5nKHguQmxrZGV2U3RhcnQpCisJfQorCXhjLm1heF9n
cmFudF9mcmFtZXMgPSBDLnVpbnQzMl90KHguTWF4R3JhbnRGcmFtZXMpCisJeGMubWF4X21hcHRy
YWNrX2ZyYW1lcyA9IEMudWludDMyX3QoeC5NYXhNYXB0cmFja0ZyYW1lcykKKwl4Yy5kZXZpY2Vf
bW9kZWxfdmVyc2lvbiA9IEMubGlieGxfZGV2aWNlX21vZGVsX3ZlcnNpb24oeC5EZXZpY2VNb2Rl
bFZlcnNpb24pCisJaWYgZXJyIDo9IHguRGV2aWNlTW9kZWxTdHViZG9tYWluLnRvQygmeGMuZGV2
aWNlX21vZGVsX3N0dWJkb21haW4pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlp
ZiB4LkRldmljZU1vZGVsICE9ICIiIHsKKwkJeGMuZGV2aWNlX21vZGVsID0gQy5DU3RyaW5nKHgu
RGV2aWNlTW9kZWwpCisJfQorCXhjLmRldmljZV9tb2RlbF9zc2lkcmVmID0gQy51aW50MzJfdCh4
LkRldmljZU1vZGVsU3NpZHJlZikKKwlpZiB4LkRldmljZU1vZGVsU3NpZExhYmVsICE9ICIiIHsK
KwkJeGMuZGV2aWNlX21vZGVsX3NzaWRfbGFiZWwgPSBDLkNTdHJpbmcoeC5EZXZpY2VNb2RlbFNz
aWRMYWJlbCkKKwl9CisJaWYgeC5EZXZpY2VNb2RlbFVzZXIgIT0gIiIgeworCQl4Yy5kZXZpY2Vf
bW9kZWxfdXNlciA9IEMuQ1N0cmluZyh4LkRldmljZU1vZGVsVXNlcikKKwl9CisJaWYgZXJyIDo9
IHguRXh0cmEudG9DKCZ4Yy5leHRyYSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQor
CWlmIGVyciA6PSB4LkV4dHJhUHYudG9DKCZ4Yy5leHRyYV9wdik7IGVyciAhPSBuaWwgeworCQly
ZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkV4dHJhSHZtLnRvQygmeGMuZXh0cmFfaHZtKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguU2NoZWRQYXJhbXMu
dG9DKCZ4Yy5zY2hlZF9wYXJhbXMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlp
ZiBlcnIgOj0geC5DbGFpbU1vZGUudG9DKCZ4Yy5jbGFpbV9tb2RlKTsgZXJyICE9IG5pbCB7CisJ
CXJldHVybiBlcnIKKwl9CisJeGMuZXZlbnRfY2hhbm5lbHMgPSBDLnVpbnQzMl90KHguRXZlbnRD
aGFubmVscykKKwlpZiB4Lktlcm5lbCAhPSAiIiB7CisJCXhjLmtlcm5lbCA9IEMuQ1N0cmluZyh4
Lktlcm5lbCkKKwl9CisJaWYgeC5DbWRsaW5lICE9ICIiIHsKKwkJeGMuY21kbGluZSA9IEMuQ1N0
cmluZyh4LkNtZGxpbmUpCisJfQorCWlmIHguUmFtZGlzayAhPSAiIiB7CisJCXhjLnJhbWRpc2sg
PSBDLkNTdHJpbmcoeC5SYW1kaXNrKQorCX0KKwlpZiB4LkRldmljZVRyZWUgIT0gIiIgeworCQl4
Yy5kZXZpY2VfdHJlZSA9IEMuQ1N0cmluZyh4LkRldmljZVRyZWUpCisJfQorCWlmIGVyciA6PSB4
LkFjcGkudG9DKCZ4Yy5hY3BpKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYg
eC5Cb290bG9hZGVyICE9ICIiIHsKKwkJeGMuYm9vdGxvYWRlciA9IEMuQ1N0cmluZyh4LkJvb3Rs
b2FkZXIpCisJfQorCWlmIGVyciA6PSB4LkJvb3Rsb2FkZXJBcmdzLnRvQygmeGMuYm9vdGxvYWRl
cl9hcmdzKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeGMudGltZXJfbW9kZSA9
IEMubGlieGxfdGltZXJfbW9kZSh4LlRpbWVyTW9kZSkKKwlpZiBlcnIgOj0geC5OZXN0ZWRIdm0u
dG9DKCZ4Yy5uZXN0ZWRfaHZtKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYg
ZXJyIDo9IHguQXBpYy50b0MoJnhjLmFwaWMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgor
CX0KKwlpZiBlcnIgOj0geC5EbVJlc3RyaWN0LnRvQygmeGMuZG1fcmVzdHJpY3QpOyBlcnIgIT0g
bmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4Yy50ZWUgPSBDLmxpYnhsX3RlZV90eXBlKHguVGVl
KQorCXhjLmFyY2hfYXJtLmdpY192ZXJzaW9uID0gQy5saWJ4bF9naWNfdmVyc2lvbih4LkFyY2hB
cm0uR2ljVmVyc2lvbikKKwl4Yy5hcmNoX2FybS52dWFydCA9IEMubGlieGxfdnVhcnRfdHlwZSh4
LkFyY2hBcm0uVnVhcnQpCisJeGMuYWx0cDJtID0gQy5saWJ4bF9hbHRwMm1fbW9kZSh4LkFsdHAy
TSkKKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlVmZiKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfdmZiKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNr
ZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9t
bmFtZSkKQEAgLTYyOCw2ICsxMTQ2LDMxIEBAIGZ1bmMgKHggKkRldmljZVZmYikgZnJvbUMoeGMg
KkMubGlieGxfZGV2aWNlX3ZmYikgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAq
RGV2aWNlVmZiKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgKGVyciBlcnJvcikgeworCWRl
ZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kZXZpY2VfdmZiX2Rp
c3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlk
KHguQmFja2VuZERvbWlkKQorCWlmIHguQmFja2VuZERvbW5hbWUgIT0gIiIgeworCQl4Yy5iYWNr
ZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl9CisJeGMuZGV2aWQg
PSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJaWYgZXJyIDo9IHguVm5jLnRvQygmeGMudm5jKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguU2RsLnRvQygmeGMu
c2RsKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgeC5LZXltYXAgIT0gIiIg
eworCQl4Yy5rZXltYXAgPSBDLkNTdHJpbmcoeC5LZXltYXApCisJfQorCisJcmV0dXJuIG5pbAor
fQorCiBmdW5jICh4ICpEZXZpY2VWa2IpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92a2IpIGVy
cm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNr
ZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtNjQ4LDYgKzEx
OTEsMzYgQEAgZnVuYyAoeCAqRGV2aWNlVmtiKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vfdmti
KSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VWa2IpIHRvQyh4YyAq
Qy5saWJ4bF9kZXZpY2VfdmtiKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYg
ZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX2RldmljZV92a2JfZGlzcG9zZSh4YykKKwkJfQorCX0o
KQorCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJ
aWYgeC5CYWNrZW5kRG9tbmFtZSAhPSAiIiB7CisJCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0
cmluZyh4LkJhY2tlbmREb21uYW1lKQorCX0KKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5E
ZXZpZCkKKwl4Yy5iYWNrZW5kX3R5cGUgPSBDLmxpYnhsX3ZrYl9iYWNrZW5kKHguQmFja2VuZFR5
cGUpCisJaWYgeC5VbmlxdWVJZCAhPSAiIiB7CisJCXhjLnVuaXF1ZV9pZCA9IEMuQ1N0cmluZyh4
LlVuaXF1ZUlkKQorCX0KKwl4Yy5mZWF0dXJlX2Rpc2FibGVfa2V5Ym9hcmQgPSBDLmJvb2woeC5G
ZWF0dXJlRGlzYWJsZUtleWJvYXJkKQorCXhjLmZlYXR1cmVfZGlzYWJsZV9wb2ludGVyID0gQy5i
b29sKHguRmVhdHVyZURpc2FibGVQb2ludGVyKQorCXhjLmZlYXR1cmVfYWJzX3BvaW50ZXIgPSBD
LmJvb2woeC5GZWF0dXJlQWJzUG9pbnRlcikKKwl4Yy5mZWF0dXJlX3Jhd19wb2ludGVyID0gQy5i
b29sKHguRmVhdHVyZVJhd1BvaW50ZXIpCisJeGMuZmVhdHVyZV9tdWx0aV90b3VjaCA9IEMuYm9v
bCh4LkZlYXR1cmVNdWx0aVRvdWNoKQorCXhjLndpZHRoID0gQy51aW50MzJfdCh4LldpZHRoKQor
CXhjLmhlaWdodCA9IEMudWludDMyX3QoeC5IZWlnaHQpCisJeGMubXVsdGlfdG91Y2hfd2lkdGgg
PSBDLnVpbnQzMl90KHguTXVsdGlUb3VjaFdpZHRoKQorCXhjLm11bHRpX3RvdWNoX2hlaWdodCA9
IEMudWludDMyX3QoeC5NdWx0aVRvdWNoSGVpZ2h0KQorCXhjLm11bHRpX3RvdWNoX251bV9jb250
YWN0cyA9IEMudWludDMyX3QoeC5NdWx0aVRvdWNoTnVtQ29udGFjdHMpCisKKwlyZXR1cm4gbmls
Cit9CisKIGZ1bmMgKHggKkRldmljZURpc2spIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9kaXNr
KSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXgu
QmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTY3OCw2
ICsxMjUxLDU4IEBAIGZ1bmMgKHggKkRldmljZURpc2spIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV9kaXNrKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VEaXNrKSB0
b0MoeGMgKkMubGlieGxfZGV2aWNlX2Rpc2spIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkg
eworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZGV2aWNlX2Rpc2tfZGlzcG9zZSh4YykK
KwkJfQorCX0oKQorCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5k
RG9taWQpCisJaWYgeC5CYWNrZW5kRG9tbmFtZSAhPSAiIiB7CisJCXhjLmJhY2tlbmRfZG9tbmFt
ZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCX0KKwlpZiB4LlBkZXZQYXRoICE9ICIi
IHsKKwkJeGMucGRldl9wYXRoID0gQy5DU3RyaW5nKHguUGRldlBhdGgpCisJfQorCWlmIHguVmRl
diAhPSAiIiB7CisJCXhjLnZkZXYgPSBDLkNTdHJpbmcoeC5WZGV2KQorCX0KKwl4Yy5iYWNrZW5k
ID0gQy5saWJ4bF9kaXNrX2JhY2tlbmQoeC5CYWNrZW5kKQorCXhjLmZvcm1hdCA9IEMubGlieGxf
ZGlza19mb3JtYXQoeC5Gb3JtYXQpCisJaWYgeC5TY3JpcHQgIT0gIiIgeworCQl4Yy5zY3JpcHQg
PSBDLkNTdHJpbmcoeC5TY3JpcHQpCisJfQorCXhjLnJlbW92YWJsZSA9IEMuaW50KHguUmVtb3Zh
YmxlKQorCXhjLnJlYWR3cml0ZSA9IEMuaW50KHguUmVhZHdyaXRlKQorCXhjLmlzX2Nkcm9tID0g
Qy5pbnQoeC5Jc0Nkcm9tKQorCXhjLmRpcmVjdF9pb19zYWZlID0gQy5ib29sKHguRGlyZWN0SW9T
YWZlKQorCWlmIGVyciA6PSB4LkRpc2NhcmRFbmFibGUudG9DKCZ4Yy5kaXNjYXJkX2VuYWJsZSk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkNvbG9FbmFibGUu
dG9DKCZ4Yy5jb2xvX2VuYWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlm
IGVyciA6PSB4LkNvbG9SZXN0b3JlRW5hYmxlLnRvQygmeGMuY29sb19yZXN0b3JlX2VuYWJsZSk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIHguQ29sb0hvc3QgIT0gIiIgewor
CQl4Yy5jb2xvX2hvc3QgPSBDLkNTdHJpbmcoeC5Db2xvSG9zdCkKKwl9CisJeGMuY29sb19wb3J0
ID0gQy5pbnQoeC5Db2xvUG9ydCkKKwlpZiB4LkNvbG9FeHBvcnQgIT0gIiIgeworCQl4Yy5jb2xv
X2V4cG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9FeHBvcnQpCisJfQorCWlmIHguQWN0aXZlRGlzayAh
PSAiIiB7CisJCXhjLmFjdGl2ZV9kaXNrID0gQy5DU3RyaW5nKHguQWN0aXZlRGlzaykKKwl9CisJ
aWYgeC5IaWRkZW5EaXNrICE9ICIiIHsKKwkJeGMuaGlkZGVuX2Rpc2sgPSBDLkNTdHJpbmcoeC5I
aWRkZW5EaXNrKQorCX0KKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlTmljKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfbmljKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBE
b21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhj
LmJhY2tlbmRfZG9tbmFtZSkKQEAgLTc0OCw2ICsxMzczLDE5NCBAQCBmdW5jICh4ICpEZXZpY2VO
aWMpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9uaWMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKkRldmljZU5pYykgdG9DKHhjICpDLmxpYnhsX2RldmljZV9uaWMpIChlcnIg
ZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxf
ZGV2aWNlX25pY19kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwl4Yy5iYWNrZW5kX2RvbWlkID0g
Qy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwlpZiB4LkJhY2tlbmREb21uYW1lICE9ICIi
IHsKKwkJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUpCisJ
fQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLm10dSA9IEMuaW50KHgu
TXR1KQorCWlmIHguTW9kZWwgIT0gIiIgeworCQl4Yy5tb2RlbCA9IEMuQ1N0cmluZyh4Lk1vZGVs
KQorCX0KKwlpZiBlcnIgOj0geC5NYWMudG9DKCZ4Yy5tYWMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIGVycgorCX0KKwlpZiB4LklwICE9ICIiIHsKKwkJeGMuaXAgPSBDLkNTdHJpbmcoeC5JcCkK
Kwl9CisJaWYgeC5CcmlkZ2UgIT0gIiIgeworCQl4Yy5icmlkZ2UgPSBDLkNTdHJpbmcoeC5Ccmlk
Z2UpCisJfQorCWlmIHguSWZuYW1lICE9ICIiIHsKKwkJeGMuaWZuYW1lID0gQy5DU3RyaW5nKHgu
SWZuYW1lKQorCX0KKwlpZiB4LlNjcmlwdCAhPSAiIiB7CisJCXhjLnNjcmlwdCA9IEMuQ1N0cmlu
Zyh4LlNjcmlwdCkKKwl9CisJeGMubmljdHlwZSA9IEMubGlieGxfbmljX3R5cGUoeC5OaWN0eXBl
KQorCXhjLnJhdGVfYnl0ZXNfcGVyX2ludGVydmFsID0gQy51aW50NjRfdCh4LlJhdGVCeXRlc1Bl
ckludGVydmFsKQorCXhjLnJhdGVfaW50ZXJ2YWxfdXNlY3MgPSBDLnVpbnQzMl90KHguUmF0ZUlu
dGVydmFsVXNlY3MpCisJaWYgeC5HYXRld2F5ZGV2ICE9ICIiIHsKKwkJeGMuZ2F0ZXdheWRldiA9
IEMuQ1N0cmluZyh4LkdhdGV3YXlkZXYpCisJfQorCWlmIHguQ29sb2Z0Rm9yd2FyZGRldiAhPSAi
IiB7CisJCXhjLmNvbG9mdF9mb3J3YXJkZGV2ID0gQy5DU3RyaW5nKHguQ29sb2Z0Rm9yd2FyZGRl
dikKKwl9CisJaWYgeC5Db2xvU29ja01pcnJvcklkICE9ICIiIHsKKwkJeGMuY29sb19zb2NrX21p
cnJvcl9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrTWlycm9ySWQpCisJfQorCWlmIHguQ29sb1Nv
Y2tNaXJyb3JJcCAhPSAiIiB7CisJCXhjLmNvbG9fc29ja19taXJyb3JfaXAgPSBDLkNTdHJpbmco
eC5Db2xvU29ja01pcnJvcklwKQorCX0KKwlpZiB4LkNvbG9Tb2NrTWlycm9yUG9ydCAhPSAiIiB7
CisJCXhjLmNvbG9fc29ja19taXJyb3JfcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrTWlycm9y
UG9ydCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVQcmlJbklkICE9ICIiIHsKKwkJeGMuY29s
b19zb2NrX2NvbXBhcmVfcHJpX2luX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlUHJp
SW5JZCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVQcmlJbklwICE9ICIiIHsKKwkJeGMuY29s
b19zb2NrX2NvbXBhcmVfcHJpX2luX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlUHJp
SW5JcCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVQcmlJblBvcnQgIT0gIiIgeworCQl4Yy5j
b2xvX3NvY2tfY29tcGFyZV9wcmlfaW5fcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrQ29tcGFy
ZVByaUluUG9ydCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVTZWNJbklkICE9ICIiIHsKKwkJ
eGMuY29sb19zb2NrX2NvbXBhcmVfc2VjX2luX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21w
YXJlU2VjSW5JZCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVTZWNJbklwICE9ICIiIHsKKwkJ
eGMuY29sb19zb2NrX2NvbXBhcmVfc2VjX2luX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21w
YXJlU2VjSW5JcCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVTZWNJblBvcnQgIT0gIiIgewor
CQl4Yy5jb2xvX3NvY2tfY29tcGFyZV9zZWNfaW5fcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2Nr
Q29tcGFyZVNlY0luUG9ydCkKKwl9CisJaWYgeC5Db2xvU29ja0NvbXBhcmVOb3RpZnlJZCAhPSAi
IiB7CisJCXhjLmNvbG9fc29ja19jb21wYXJlX25vdGlmeV9pZCA9IEMuQ1N0cmluZyh4LkNvbG9T
b2NrQ29tcGFyZU5vdGlmeUlkKQorCX0KKwlpZiB4LkNvbG9Tb2NrQ29tcGFyZU5vdGlmeUlwICE9
ICIiIHsKKwkJeGMuY29sb19zb2NrX2NvbXBhcmVfbm90aWZ5X2lwID0gQy5DU3RyaW5nKHguQ29s
b1NvY2tDb21wYXJlTm90aWZ5SXApCisJfQorCWlmIHguQ29sb1NvY2tDb21wYXJlTm90aWZ5UG9y
dCAhPSAiIiB7CisJCXhjLmNvbG9fc29ja19jb21wYXJlX25vdGlmeV9wb3J0ID0gQy5DU3RyaW5n
KHguQ29sb1NvY2tDb21wYXJlTm90aWZ5UG9ydCkKKwl9CisJaWYgeC5Db2xvU29ja1JlZGlyZWN0
b3IwSWQgIT0gIiIgeworCQl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjBfaWQgPSBDLkNTdHJpbmco
eC5Db2xvU29ja1JlZGlyZWN0b3IwSWQpCisJfQorCWlmIHguQ29sb1NvY2tSZWRpcmVjdG9yMElw
ICE9ICIiIHsKKwkJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IwX2lwID0gQy5DU3RyaW5nKHguQ29s
b1NvY2tSZWRpcmVjdG9yMElwKQorCX0KKwlpZiB4LkNvbG9Tb2NrUmVkaXJlY3RvcjBQb3J0ICE9
ICIiIHsKKwkJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IwX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xv
U29ja1JlZGlyZWN0b3IwUG9ydCkKKwl9CisJaWYgeC5Db2xvU29ja1JlZGlyZWN0b3IxSWQgIT0g
IiIgeworCQl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjFfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29j
a1JlZGlyZWN0b3IxSWQpCisJfQorCWlmIHguQ29sb1NvY2tSZWRpcmVjdG9yMUlwICE9ICIiIHsK
KwkJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IxX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRp
cmVjdG9yMUlwKQorCX0KKwlpZiB4LkNvbG9Tb2NrUmVkaXJlY3RvcjFQb3J0ICE9ICIiIHsKKwkJ
eGMuY29sb19zb2NrX3JlZGlyZWN0b3IxX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGly
ZWN0b3IxUG9ydCkKKwl9CisJaWYgeC5Db2xvU29ja1JlZGlyZWN0b3IySWQgIT0gIiIgeworCQl4
Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjJfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0
b3IySWQpCisJfQorCWlmIHguQ29sb1NvY2tSZWRpcmVjdG9yMklwICE9ICIiIHsKKwkJeGMuY29s
b19zb2NrX3JlZGlyZWN0b3IyX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRpcmVjdG9yMklw
KQorCX0KKwlpZiB4LkNvbG9Tb2NrUmVkaXJlY3RvcjJQb3J0ICE9ICIiIHsKKwkJeGMuY29sb19z
b2NrX3JlZGlyZWN0b3IyX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0b3IyUG9y
dCkKKwl9CisJaWYgeC5Db2xvRmlsdGVyTWlycm9yUXVldWUgIT0gIiIgeworCQl4Yy5jb2xvX2Zp
bHRlcl9taXJyb3JfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyTWlycm9yUXVldWUpCisJ
fQorCWlmIHguQ29sb0ZpbHRlck1pcnJvck91dGRldiAhPSAiIiB7CisJCXhjLmNvbG9fZmlsdGVy
X21pcnJvcl9vdXRkZXYgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyTWlycm9yT3V0ZGV2KQorCX0K
KwlpZiB4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMFF1ZXVlICE9ICIiIHsKKwkJeGMuY29sb19maWx0
ZXJfcmVkaXJlY3RvcjBfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyUmVkaXJlY3RvcjBR
dWV1ZSkKKwl9CisJaWYgeC5Db2xvRmlsdGVyUmVkaXJlY3RvcjBJbmRldiAhPSAiIiB7CisJCXhj
LmNvbG9fZmlsdGVyX3JlZGlyZWN0b3IwX2luZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJl
ZGlyZWN0b3IwSW5kZXYpCisJfQorCWlmIHguQ29sb0ZpbHRlclJlZGlyZWN0b3IwT3V0ZGV2ICE9
ICIiIHsKKwkJeGMuY29sb19maWx0ZXJfcmVkaXJlY3RvcjBfb3V0ZGV2ID0gQy5DU3RyaW5nKHgu
Q29sb0ZpbHRlclJlZGlyZWN0b3IwT3V0ZGV2KQorCX0KKwlpZiB4LkNvbG9GaWx0ZXJSZWRpcmVj
dG9yMVF1ZXVlICE9ICIiIHsKKwkJeGMuY29sb19maWx0ZXJfcmVkaXJlY3RvcjFfcXVldWUgPSBD
LkNTdHJpbmcoeC5Db2xvRmlsdGVyUmVkaXJlY3RvcjFRdWV1ZSkKKwl9CisJaWYgeC5Db2xvRmls
dGVyUmVkaXJlY3RvcjFJbmRldiAhPSAiIiB7CisJCXhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3Ix
X2luZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJlZGlyZWN0b3IxSW5kZXYpCisJfQorCWlm
IHguQ29sb0ZpbHRlclJlZGlyZWN0b3IxT3V0ZGV2ICE9ICIiIHsKKwkJeGMuY29sb19maWx0ZXJf
cmVkaXJlY3RvcjFfb3V0ZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJlZGlyZWN0b3IxT3V0
ZGV2KQorCX0KKwlpZiB4LkNvbG9Db21wYXJlUHJpSW4gIT0gIiIgeworCQl4Yy5jb2xvX2NvbXBh
cmVfcHJpX2luID0gQy5DU3RyaW5nKHguQ29sb0NvbXBhcmVQcmlJbikKKwl9CisJaWYgeC5Db2xv
Q29tcGFyZVNlY0luICE9ICIiIHsKKwkJeGMuY29sb19jb21wYXJlX3NlY19pbiA9IEMuQ1N0cmlu
Zyh4LkNvbG9Db21wYXJlU2VjSW4pCisJfQorCWlmIHguQ29sb0NvbXBhcmVPdXQgIT0gIiIgewor
CQl4Yy5jb2xvX2NvbXBhcmVfb3V0ID0gQy5DU3RyaW5nKHguQ29sb0NvbXBhcmVPdXQpCisJfQor
CWlmIHguQ29sb0NvbXBhcmVOb3RpZnlEZXYgIT0gIiIgeworCQl4Yy5jb2xvX2NvbXBhcmVfbm90
aWZ5X2RldiA9IEMuQ1N0cmluZyh4LkNvbG9Db21wYXJlTm90aWZ5RGV2KQorCX0KKwlpZiB4LkNv
bG9Tb2NrU2VjUmVkaXJlY3RvcjBJZCAhPSAiIiB7CisJCXhjLmNvbG9fc29ja19zZWNfcmVkaXJl
Y3RvcjBfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IwSWQpCisJfQorCWlm
IHguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMElwICE9ICIiIHsKKwkJeGMuY29sb19zb2NrX3NlY19y
ZWRpcmVjdG9yMF9pcCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjBJcCkKKwl9
CisJaWYgeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IwUG9ydCAhPSAiIiB7CisJCXhjLmNvbG9fc29j
a19zZWNfcmVkaXJlY3RvcjBfcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrU2VjUmVkaXJlY3Rv
cjBQb3J0KQorCX0KKwlpZiB4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjFJZCAhPSAiIiB7CisJCXhj
LmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjFfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1NlY1Jl
ZGlyZWN0b3IxSWQpCisJfQorCWlmIHguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMUlwICE9ICIiIHsK
KwkJeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMV9pcCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2Nr
U2VjUmVkaXJlY3RvcjFJcCkKKwl9CisJaWYgeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IxUG9ydCAh
PSAiIiB7CisJCXhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjFfcG9ydCA9IEMuQ1N0cmluZyh4
LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjFQb3J0KQorCX0KKwlpZiB4LkNvbG9GaWx0ZXJTZWNSZWRp
cmVjdG9yMFF1ZXVlICE9ICIiIHsKKwkJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IwX3F1
ZXVlID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IwUXVldWUpCisJfQorCWlm
IHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IwSW5kZXYgIT0gIiIgeworCQl4Yy5jb2xvX2ZpbHRl
cl9zZWNfcmVkaXJlY3RvcjBfaW5kZXYgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmVkaXJl
Y3RvcjBJbmRldikKKwl9CisJaWYgeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3RvcjBPdXRkZXYgIT0g
IiIgeworCQl4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjBfb3V0ZGV2ID0gQy5DU3RyaW5n
KHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IwT3V0ZGV2KQorCX0KKwlpZiB4LkNvbG9GaWx0ZXJT
ZWNSZWRpcmVjdG9yMVF1ZXVlICE9ICIiIHsKKwkJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0
b3IxX3F1ZXVlID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxUXVldWUpCisJ
fQorCWlmIHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxSW5kZXYgIT0gIiIgeworCQl4Yy5jb2xv
X2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfaW5kZXYgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2Vj
UmVkaXJlY3RvcjFJbmRldikKKwl9CisJaWYgeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3RvcjFPdXRk
ZXYgIT0gIiIgeworCQl4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfb3V0ZGV2ID0gQy5D
U3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxT3V0ZGV2KQorCX0KKwlpZiB4LkNvbG9G
aWx0ZXJTZWNSZXdyaXRlcjBRdWV1ZSAhPSAiIiB7CisJCXhjLmNvbG9fZmlsdGVyX3NlY19yZXdy
aXRlcjBfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmV3cml0ZXIwUXVldWUpCisJ
fQorCWlmIHguQ29sb0NoZWNrcG9pbnRIb3N0ICE9ICIiIHsKKwkJeGMuY29sb19jaGVja3BvaW50
X2hvc3QgPSBDLkNTdHJpbmcoeC5Db2xvQ2hlY2twb2ludEhvc3QpCisJfQorCWlmIHguQ29sb0No
ZWNrcG9pbnRQb3J0ICE9ICIiIHsKKwkJeGMuY29sb19jaGVja3BvaW50X3BvcnQgPSBDLkNTdHJp
bmcoeC5Db2xvQ2hlY2twb2ludFBvcnQpCisJfQorCisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4
ICpEZXZpY2VQY2kpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9wY2kpIGVycm9yIHsKIAl4LkZ1
bmMgPSBieXRlKHhjLl9mdW5jKQogCXguRGV2ID0gYnl0ZSh4Yy5kZXYpCkBAIC03NjQsNiArMTU3
NywyOCBAQCBmdW5jICh4ICpEZXZpY2VQY2kpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9wY2kp
IGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVBjaSkgdG9DKHhjICpD
LmxpYnhsX2RldmljZV9wY2kpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBl
cnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZGV2aWNlX3BjaV9kaXNwb3NlKHhjKQorCQl9CisJfSgp
CisKKwl4Yy5fZnVuYyA9IEMudWludDhfdCh4LkZ1bmMpCisJeGMuZGV2ID0gQy51aW50OF90KHgu
RGV2KQorCXhjLmJ1cyA9IEMudWludDhfdCh4LkJ1cykKKwl4Yy5kb21haW4gPSBDLmludCh4LkRv
bWFpbikKKwl4Yy52ZGV2Zm4gPSBDLnVpbnQzMl90KHguVmRldmZuKQorCXhjLnZmdW5jX21hc2sg
PSBDLnVpbnQzMl90KHguVmZ1bmNNYXNrKQorCXhjLm1zaXRyYW5zbGF0ZSA9IEMuYm9vbCh4Lk1z
aXRyYW5zbGF0ZSkKKwl4Yy5wb3dlcl9tZ210ID0gQy5ib29sKHguUG93ZXJNZ210KQorCXhjLnBl
cm1pc3NpdmUgPSBDLmJvb2woeC5QZXJtaXNzaXZlKQorCXhjLnNlaXplID0gQy5ib29sKHguU2Vp
emUpCisJeGMucmRtX3BvbGljeSA9IEMubGlieGxfcmRtX3Jlc2VydmVfcG9saWN5KHguUmRtUG9s
aWN5KQorCisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VSZG0pIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV9yZG0pIGVycm9yIHsKIAl4LlN0YXJ0ID0gdWludDY0KHhjLnN0YXJ0KQog
CXguU2l6ZSA9IHVpbnQ2NCh4Yy5zaXplKQpAQCAtNzcyLDYgKzE2MDcsMjAgQEAgZnVuYyAoeCAq
RGV2aWNlUmRtKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcmRtKSBlcnJvciB7CiAJcmV0dXJu
IG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VSZG0pIHRvQyh4YyAqQy5saWJ4bF9kZXZpY2VfcmRt
KSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlD
LmxpYnhsX2RldmljZV9yZG1fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuc3RhcnQgPSBD
LnVpbnQ2NF90KHguU3RhcnQpCisJeGMuc2l6ZSA9IEMudWludDY0X3QoeC5TaXplKQorCXhjLnBv
bGljeSA9IEMubGlieGxfcmRtX3Jlc2VydmVfcG9saWN5KHguUG9saWN5KQorCisJcmV0dXJuIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
dXNiY3RybCkgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90eXBlKQogCXguRGV2
aWQgPSBEZXZpZCh4Yy5kZXZpZCkKQEAgLTc4Myw2ICsxNjMyLDI1IEBAIGZ1bmMgKHggKkRldmlj
ZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JjdHJsKSBlcnJvciB7CiAJcmV0
dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSB0b0MoeGMgKkMubGlieGxfZGV2
aWNlX3VzYmN0cmwpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0g
bmlsIHsKKwkJCUMubGlieGxfZGV2aWNlX3VzYmN0cmxfZGlzcG9zZSh4YykKKwkJfQorCX0oKQor
CisJeGMuX3R5cGUgPSBDLmxpYnhsX3VzYmN0cmxfdHlwZSh4LlR5cGUpCisJeGMuZGV2aWQgPSBD
LmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMudmVyc2lvbiA9IEMuaW50KHguVmVyc2lvbikKKwl4
Yy5wb3J0cyA9IEMuaW50KHguUG9ydHMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9t
aWQoeC5CYWNrZW5kRG9taWQpCisJaWYgeC5CYWNrZW5kRG9tbmFtZSAhPSAiIiB7CisJCXhjLmJh
Y2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCX0KKworCXJldHVy
biBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlVXNiZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZp
Y2VfdXNiZGV2KSBlcnJvciB7CiAJeC5DdHJsID0gRGV2aWQoeGMuY3RybCkKIAl4LlBvcnQgPSBp
bnQoeGMucG9ydCkKQEAgLTgxMiwxMiArMTY4MCwzOSBAQCBmdW5jICh4ICpEZXZpY2VVc2JkZXZU
eXBlVW5pb25Ib3N0ZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSBlcnJvciB7
CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VVc2JkZXYpIHRvQyh4YyAqQy5saWJ4
bF9kZXZpY2VfdXNiZGV2KSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJy
ICE9IG5pbCB7CisJCQlDLmxpYnhsX2RldmljZV91c2JkZXZfZGlzcG9zZSh4YykKKwkJfQorCX0o
KQorCisJeGMuY3RybCA9IEMubGlieGxfZGV2aWQoeC5DdHJsKQorCXhjLnBvcnQgPSBDLmludCh4
LlBvcnQpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkRldmljZUR0ZGV2KSBmcm9tQyh4
YyAqQy5saWJ4bF9kZXZpY2VfZHRkZXYpIGVycm9yIHsKIAl4LlBhdGggPSBDLkdvU3RyaW5nKHhj
LnBhdGgpCiAKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZUR0ZGV2KSB0b0MoeGMg
KkMubGlieGxfZGV2aWNlX2R0ZGV2KSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJ
aWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX2RldmljZV9kdGRldl9kaXNwb3NlKHhjKQorCQl9
CisJfSgpCisKKwlpZiB4LlBhdGggIT0gIiIgeworCQl4Yy5wYXRoID0gQy5DU3RyaW5nKHguUGF0
aCkKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZ0cG0pIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4
Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tl
bmRfZG9tbmFtZSkKQEAgLTgyOSw2ICsxNzI0LDI1IEBAIGZ1bmMgKHggKkRldmljZVZ0cG0pIGZy
b21DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpEZXZpY2VWdHBtKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3Z0cG0pIChlcnIgZXJy
b3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZGV2
aWNlX3Z0cG1fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuYmFja2VuZF9kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJaWYgeC5CYWNrZW5kRG9tbmFtZSAhPSAiIiB7
CisJCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCX0K
Kwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwlpZiBlcnIgOj0geC5VdWlkLnRv
QygmeGMudXVpZCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCisJcmV0dXJuIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VQOSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3A5KSBl
cnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFj
a2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTg0MCw2ICsx
NzU0LDMxIEBAIGZ1bmMgKHggKkRldmljZVA5KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcDkp
IGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVA5KSB0b0MoeGMgKkMu
bGlieGxfZGV2aWNlX3A5KSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJy
ICE9IG5pbCB7CisJCQlDLmxpYnhsX2RldmljZV9wOV9kaXNwb3NlKHhjKQorCQl9CisJfSgpCisK
Kwl4Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwlpZiB4
LkJhY2tlbmREb21uYW1lICE9ICIiIHsKKwkJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5n
KHguQmFja2VuZERvbW5hbWUpCisJfQorCWlmIHguVGFnICE9ICIiIHsKKwkJeGMudGFnID0gQy5D
U3RyaW5nKHguVGFnKQorCX0KKwlpZiB4LlBhdGggIT0gIiIgeworCQl4Yy5wYXRoID0gQy5DU3Ry
aW5nKHguUGF0aCkKKwl9CisJaWYgeC5TZWN1cml0eU1vZGVsICE9ICIiIHsKKwkJeGMuc2VjdXJp
dHlfbW9kZWwgPSBDLkNTdHJpbmcoeC5TZWN1cml0eU1vZGVsKQorCX0KKwl4Yy5kZXZpZCA9IEMu
bGlieGxfZGV2aWQoeC5EZXZpZCkKKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNl
UHZjYWxsc2lmKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmKSBlcnJvciB7CiAJ
eC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5h
bWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTg0OCw2ICsxNzg3LDIyIEBA
IGZ1bmMgKHggKkRldmljZVB2Y2FsbHNpZikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3B2Y2Fs
bHNpZikgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlUHZjYWxsc2lm
KSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZikgKGVyciBlcnJvcikgeworCWRlZmVy
IGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lm
X2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2Rv
bWlkKHguQmFja2VuZERvbWlkKQorCWlmIHguQmFja2VuZERvbW5hbWUgIT0gIiIgeworCQl4Yy5i
YWNrZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl9CisJeGMuZGV2
aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHgg
KkRldmljZUNoYW5uZWwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9jaGFubmVsKSBlcnJvciB7
CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERv
bW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTg3OCw2ICsxODMzLDI1
IEBAIGZ1bmMgKHggKkRldmljZUNoYW5uZWxDb25uZWN0aW9uVW5pb25Tb2NrZXQpIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV9jaGFubmVsKSBlCiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpE
ZXZpY2VDaGFubmVsKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX2NoYW5uZWwpIChlcnIgZXJyb3Ip
IHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZGV2aWNl
X2NoYW5uZWxfZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuYmFja2VuZF9kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJaWYgeC5CYWNrZW5kRG9tbmFtZSAhPSAiIiB7
CisJCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCX0K
Kwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwlpZiB4Lk5hbWUgIT0gIiIgewor
CQl4Yy5uYW1lID0gQy5DU3RyaW5nKHguTmFtZSkKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKIGZ1
bmMgKHggKkNvbm5lY3RvclBhcmFtKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JfcGFyYW0p
IGVycm9yIHsKIAl4LlVuaXF1ZUlkID0gQy5Hb1N0cmluZyh4Yy51bmlxdWVfaWQpCiAJeC5XaWR0
aCA9IHVpbnQzMih4Yy53aWR0aCkKQEAgLTg4Niw2ICsxODYwLDIyIEBAIGZ1bmMgKHggKkNvbm5l
Y3RvclBhcmFtKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JfcGFyYW0pIGVycm9yIHsKIAly
ZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkNvbm5lY3RvclBhcmFtKSB0b0MoeGMgKkMubGlieGxf
Y29ubmVjdG9yX3BhcmFtKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJy
ICE9IG5pbCB7CisJCQlDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbV9kaXNwb3NlKHhjKQorCQl9CisJ
fSgpCisKKwlpZiB4LlVuaXF1ZUlkICE9ICIiIHsKKwkJeGMudW5pcXVlX2lkID0gQy5DU3RyaW5n
KHguVW5pcXVlSWQpCisJfQorCXhjLndpZHRoID0gQy51aW50MzJfdCh4LldpZHRoKQorCXhjLmhl
aWdodCA9IEMudWludDMyX3QoeC5IZWlnaHQpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHgg
KkRldmljZVZkaXNwbCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZkaXNwbCkgZXJyb3Igewog
CXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21u
YW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC05MDMsNiArMTg5MywyMyBA
QCBmdW5jICh4ICpEZXZpY2VWZGlzcGwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92ZGlzcGwp
IGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVZkaXNwbCkgdG9DKHhj
ICpDLmxpYnhsX2RldmljZV92ZGlzcGwpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgewor
CQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZGV2aWNlX3ZkaXNwbF9kaXNwb3NlKHhjKQor
CQl9CisJfSgpCisKKwl4Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmRE
b21pZCkKKwlpZiB4LkJhY2tlbmREb21uYW1lICE9ICIiIHsKKwkJeGMuYmFja2VuZF9kb21uYW1l
ID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUpCisJfQorCXhjLmRldmlkID0gQy5saWJ4bF9k
ZXZpZCh4LkRldmlkKQorCXhjLmJlX2FsbG9jID0gQy5ib29sKHguQmVBbGxvYykKKworCXJldHVy
biBuaWwKK30KKwogZnVuYyAoeCAqVnNuZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9w
YXJhbXMpIGVycm9yIHsKIAludW1TYW1wbGVSYXRlcyA6PSBpbnQoeGMubnVtX3NhbXBsZV9yYXRl
cykKIAljU2FtcGxlUmF0ZXMgOj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUuUG9pbnRl
cih4Yy5zYW1wbGVfcmF0ZXMpKVs6bnVtU2FtcGxlUmF0ZXM6bnVtU2FtcGxlUmF0ZXNdCkBAIC05
MjMsNiArMTkzMCwyMCBAQCBmdW5jICh4ICpWc25kUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92
c25kX3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnNuZFBhcmFt
cykgdG9DKHhjICpDLmxpYnhsX3ZzbmRfcGFyYW1zKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVu
YygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX3ZzbmRfcGFyYW1zX2Rpc3Bvc2Uo
eGMpCisJCX0KKwl9KCkKKworCXhjLmNoYW5uZWxzX21pbiA9IEMudWludDMyX3QoeC5DaGFubmVs
c01pbikKKwl4Yy5jaGFubmVsc19tYXggPSBDLnVpbnQzMl90KHguQ2hhbm5lbHNNYXgpCisJeGMu
YnVmZmVyX3NpemUgPSBDLnVpbnQzMl90KHguQnVmZmVyU2l6ZSkKKworCXJldHVybiBuaWwKK30K
KwogZnVuYyAoeCAqVnNuZFN0cmVhbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9zdHJlYW0pIGVy
cm9yIHsKIAl4LlVuaXF1ZUlkID0gQy5Hb1N0cmluZyh4Yy51bmlxdWVfaWQpCiAJeC5UeXBlID0g
VnNuZFN0cmVhbVR5cGUoeGMuX3R5cGUpCkBAIC05MzMsNiArMTk1NCwyNCBAQCBmdW5jICh4ICpW
c25kU3RyZWFtKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kX3N0cmVhbSkgZXJyb3IgewogCXJldHVy
biBuaWwKIH0KIAorZnVuYyAoeCAqVnNuZFN0cmVhbSkgdG9DKHhjICpDLmxpYnhsX3ZzbmRfc3Ry
ZWFtKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJ
CQlDLmxpYnhsX3ZzbmRfc3RyZWFtX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCWlmIHguVW5p
cXVlSWQgIT0gIiIgeworCQl4Yy51bmlxdWVfaWQgPSBDLkNTdHJpbmcoeC5VbmlxdWVJZCkKKwl9
CisJeGMuX3R5cGUgPSBDLmxpYnhsX3ZzbmRfc3RyZWFtX3R5cGUoeC5UeXBlKQorCWlmIGVyciA6
PSB4LlBhcmFtcy50b0MoJnhjLnBhcmFtcyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4ICpWc25kUGNtKSBmcm9tQyh4YyAqQy5saWJ4
bF92c25kX3BjbSkgZXJyb3IgewogCXguTmFtZSA9IEMuR29TdHJpbmcoeGMubmFtZSkKIAlpZiBl
cnIgOj0geC5QYXJhbXMuZnJvbUMoJnhjLnBhcmFtcyk7IGVyciAhPSBuaWwgewpAQCAtOTUwLDYg
KzE5ODksMjMgQEAgZnVuYyAoeCAqVnNuZFBjbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wY20p
IGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZzbmRQY20pIHRvQyh4YyAqQy5s
aWJ4bF92c25kX3BjbSkgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAh
PSBuaWwgeworCQkJQy5saWJ4bF92c25kX3BjbV9kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwlp
ZiB4Lk5hbWUgIT0gIiIgeworCQl4Yy5uYW1lID0gQy5DU3RyaW5nKHguTmFtZSkKKwl9CisJaWYg
ZXJyIDo9IHguUGFyYW1zLnRvQygmeGMucGFyYW1zKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVZzbmQpIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV92c25kKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4
Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tl
bmRfZG9tbmFtZSkKQEAgLTk3MSw2ICsyMDI3LDMxIEBAIGZ1bmMgKHggKkRldmljZVZzbmQpIGZy
b21DKHhjICpDLmxpYnhsX2RldmljZV92c25kKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpEZXZpY2VWc25kKSB0b0MoeGMgKkMubGlieGxfZGV2aWNlX3ZzbmQpIChlcnIgZXJy
b3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZGV2
aWNlX3ZzbmRfZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuYmFja2VuZF9kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJaWYgeC5CYWNrZW5kRG9tbmFtZSAhPSAiIiB7
CisJCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCX0K
Kwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwlpZiB4LlNob3J0TmFtZSAhPSAi
IiB7CisJCXhjLnNob3J0X25hbWUgPSBDLkNTdHJpbmcoeC5TaG9ydE5hbWUpCisJfQorCWlmIHgu
TG9uZ05hbWUgIT0gIiIgeworCQl4Yy5sb25nX25hbWUgPSBDLkNTdHJpbmcoeC5Mb25nTmFtZSkK
Kwl9CisJaWYgZXJyIDo9IHguUGFyYW1zLnRvQygmeGMucGFyYW1zKTsgZXJyICE9IG5pbCB7CisJ
CXJldHVybiBlcnIKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpbkNvbmZp
ZykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCWlmIGVyciA6PSB4
LkNJbmZvLmZyb21DKCZ4Yy5jX2luZm8pOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGVycgpAQCAt
MTEwNyw2ICsyMTg4LDI4IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJvbUMoeGMgKkMubGli
eGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRG9t
YWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgKGVyciBlcnJvcikgewor
CWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5fY29u
ZmlnX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCWlmIGVyciA6PSB4LkNJbmZvLnRvQygmeGMu
Y19pbmZvKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguQklu
Zm8udG9DKCZ4Yy5iX2luZm8pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4Yy5v
bl9wb3dlcm9mZiA9IEMubGlieGxfYWN0aW9uX29uX3NodXRkb3duKHguT25Qb3dlcm9mZikKKwl4
Yy5vbl9yZWJvb3QgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uUmVib290KQorCXhj
Lm9uX3dhdGNoZG9nID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PbldhdGNoZG9nKQor
CXhjLm9uX2NyYXNoID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PbkNyYXNoKQorCXhj
Lm9uX3NvZnRfcmVzZXQgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uU29mdFJlc2V0
KQorCisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4ICpEaXNraW5mbykgZnJvbUMoeGMgKkMubGli
eGxfZGlza2luZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQp
CiAJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTExMjAsNiArMjIyMywy
OSBAQCBmdW5jICh4ICpEaXNraW5mbykgZnJvbUMoeGMgKkMubGlieGxfZGlza2luZm8pIGVycm9y
IHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRpc2tpbmZvKSB0b0MoeGMgKkMubGlieGxf
ZGlza2luZm8pIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmls
IHsKKwkJCUMubGlieGxfZGlza2luZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJaWYgeC5C
YWNrZW5kICE9ICIiIHsKKwkJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQpCisJfQor
CXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90KHguQmFja2VuZElkKQorCWlmIHguRnJvbnRlbmQg
IT0gIiIgeworCQl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCX0KKwl4Yy5m
cm9udGVuZF9pZCA9IEMudWludDMyX3QoeC5Gcm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4
bF9kZXZpZCh4LkRldmlkKQorCXhjLnN0YXRlID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9
IEMuaW50KHguRXZ0Y2gpCisJeGMucnJlZiA9IEMuaW50KHguUnJlZikKKworCXJldHVybiBuaWwK
K30KKwogZnVuYyAoeCAqTmljaW5mbykgZnJvbUMoeGMgKkMubGlieGxfbmljaW5mbykgZXJyb3Ig
ewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVp
bnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTEzNCw2ICsyMjYwLDMwIEBAIGZ1bmMgKHggKk5pY2lu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAK
K2Z1bmMgKHggKk5pY2luZm8pIHRvQyh4YyAqQy5saWJ4bF9uaWNpbmZvKSAoZXJyIGVycm9yKSB7
CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX25pY2luZm9f
ZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJaWYgeC5CYWNrZW5kICE9ICIiIHsKKwkJeGMuYmFj
a2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQpCisJfQorCXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQz
Ml90KHguQmFja2VuZElkKQorCWlmIHguRnJvbnRlbmQgIT0gIiIgeworCQl4Yy5mcm9udGVuZCA9
IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCX0KKwl4Yy5mcm9udGVuZF9pZCA9IEMudWludDMyX3Qo
eC5Gcm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLnN0
YXRlID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0Y2gpCisJeGMucnJl
Zl90eCA9IEMuaW50KHguUnJlZlR4KQorCXhjLnJyZWZfcnggPSBDLmludCh4LlJyZWZSeCkKKwor
CXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqVnRwbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Z0
cG1pbmZvKSBlcnJvciB7CiAJeC5CYWNrZW5kID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQogCXgu
QmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQpCkBAIC0xMTUwLDYgKzIzMDAsMzIgQEAg
ZnVuYyAoeCAqVnRwbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Z0cG1pbmZvKSBlcnJvciB7CiAJ
cmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWdHBtaW5mbykgdG9DKHhjICpDLmxpYnhsX3Z0cG1p
bmZvKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJ
CQlDLmxpYnhsX3Z0cG1pbmZvX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCWlmIHguQmFja2Vu
ZCAhPSAiIiB7CisJCXhjLmJhY2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCX0KKwl4Yy5i
YWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkKKwlpZiB4LkZyb250ZW5kICE9ICIi
IHsKKwkJeGMuZnJvbnRlbmQgPSBDLkNTdHJpbmcoeC5Gcm9udGVuZCkKKwl9CisJeGMuZnJvbnRl
bmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2
aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJeGMuZXZ0Y2ggPSBDLmlu
dCh4LkV2dGNoKQorCXhjLnJyZWYgPSBDLmludCh4LlJyZWYpCisJaWYgZXJyIDo9IHguVXVpZC50
b0MoJnhjLnV1aWQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBu
aWwKK30KKwogZnVuYyAoeCAqVXNiY3RybGluZm8pIGZyb21DKHhjICpDLmxpYnhsX3VzYmN0cmxp
bmZvKSBlcnJvciB7CiAJeC5UeXBlID0gVXNiY3RybFR5cGUoeGMuX3R5cGUpCiAJeC5EZXZpZCA9
IERldmlkKHhjLmRldmlkKQpAQCAtMTE2Nyw2ICsyMzQzLDMzIEBAIGZ1bmMgKHggKlVzYmN0cmxp
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF91c2JjdHJsaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwK
IH0KIAorZnVuYyAoeCAqVXNiY3RybGluZm8pIHRvQyh4YyAqQy5saWJ4bF91c2JjdHJsaW5mbykg
KGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5s
aWJ4bF91c2JjdHJsaW5mb19kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwl4Yy5fdHlwZSA9IEMu
bGlieGxfdXNiY3RybF90eXBlKHguVHlwZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5E
ZXZpZCkKKwl4Yy52ZXJzaW9uID0gQy5pbnQoeC5WZXJzaW9uKQorCXhjLnBvcnRzID0gQy5pbnQo
eC5Qb3J0cykKKwlpZiB4LkJhY2tlbmQgIT0gIiIgeworCQl4Yy5iYWNrZW5kID0gQy5DU3RyaW5n
KHguQmFja2VuZCkKKwl9CisJeGMuYmFja2VuZF9pZCA9IEMudWludDMyX3QoeC5CYWNrZW5kSWQp
CisJaWYgeC5Gcm9udGVuZCAhPSAiIiB7CisJCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJv
bnRlbmQpCisJfQorCXhjLmZyb250ZW5kX2lkID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQpCisJ
eGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRjaCkKKwl4
Yy5yZWZfdXJiID0gQy5pbnQoeC5SZWZVcmIpCisJeGMucmVmX2Nvbm4gPSBDLmludCh4LlJlZkNv
bm4pCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKlZjcHVpbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF92Y3B1aW5mbykgZXJyb3IgewogCXguVmNwdWlkID0gdWludDMyKHhjLnZjcHVpZCkKIAl4
LkNwdSA9IHVpbnQzMih4Yy5jcHUpCkBAIC0xMTg0LDYgKzIzODcsMjkgQEAgZnVuYyAoeCAqVmNw
dWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZjcHVpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAog
fQogCitmdW5jICh4ICpWY3B1aW5mbykgdG9DKHhjICpDLmxpYnhsX3ZjcHVpbmZvKSAoZXJyIGVy
cm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX3Zj
cHVpbmZvX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCXhjLnZjcHVpZCA9IEMudWludDMyX3Qo
eC5WY3B1aWQpCisJeGMuY3B1ID0gQy51aW50MzJfdCh4LkNwdSkKKwl4Yy5vbmxpbmUgPSBDLmJv
b2woeC5PbmxpbmUpCisJeGMuYmxvY2tlZCA9IEMuYm9vbCh4LkJsb2NrZWQpCisJeGMucnVubmlu
ZyA9IEMuYm9vbCh4LlJ1bm5pbmcpCisJeGMudmNwdV90aW1lID0gQy51aW50NjRfdCh4LlZjcHVU
aW1lKQorCWlmIGVyciA6PSB4LkNwdW1hcC50b0MoJnhjLmNwdW1hcCk7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkNwdW1hcFNvZnQudG9DKCZ4Yy5jcHVtYXBf
c29mdCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCisJcmV0dXJuIG5pbAorfQor
CiBmdW5jICh4ICpQaHlzaW5mbykgZnJvbUMoeGMgKkMubGlieGxfcGh5c2luZm8pIGVycm9yIHsK
IAl4LlRocmVhZHNQZXJDb3JlID0gdWludDMyKHhjLnRocmVhZHNfcGVyX2NvcmUpCiAJeC5Db3Jl
c1BlclNvY2tldCA9IHVpbnQzMih4Yy5jb3Jlc19wZXJfc29ja2V0KQpAQCAtMTIxMSw2ICsyNDM3
LDM5IEBAIGZ1bmMgKHggKlBoeXNpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9waHlzaW5mbykgZXJy
b3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqUGh5c2luZm8pIHRvQyh4YyAqQy5saWJ4
bF9waHlzaW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMoKSB7CisJCWlmIGVyciAhPSBu
aWwgeworCQkJQy5saWJ4bF9waHlzaW5mb19kaXNwb3NlKHhjKQorCQl9CisJfSgpCisKKwl4Yy50
aHJlYWRzX3Blcl9jb3JlID0gQy51aW50MzJfdCh4LlRocmVhZHNQZXJDb3JlKQorCXhjLmNvcmVz
X3Blcl9zb2NrZXQgPSBDLnVpbnQzMl90KHguQ29yZXNQZXJTb2NrZXQpCisJeGMubWF4X2NwdV9p
ZCA9IEMudWludDMyX3QoeC5NYXhDcHVJZCkKKwl4Yy5ucl9jcHVzID0gQy51aW50MzJfdCh4Lk5y
Q3B1cykKKwl4Yy5jcHVfa2h6ID0gQy51aW50MzJfdCh4LkNwdUtoeikKKwl4Yy50b3RhbF9wYWdl
cyA9IEMudWludDY0X3QoeC5Ub3RhbFBhZ2VzKQorCXhjLmZyZWVfcGFnZXMgPSBDLnVpbnQ2NF90
KHguRnJlZVBhZ2VzKQorCXhjLnNjcnViX3BhZ2VzID0gQy51aW50NjRfdCh4LlNjcnViUGFnZXMp
CisJeGMub3V0c3RhbmRpbmdfcGFnZXMgPSBDLnVpbnQ2NF90KHguT3V0c3RhbmRpbmdQYWdlcykK
Kwl4Yy5zaGFyaW5nX2ZyZWVkX3BhZ2VzID0gQy51aW50NjRfdCh4LlNoYXJpbmdGcmVlZFBhZ2Vz
KQorCXhjLnNoYXJpbmdfdXNlZF9mcmFtZXMgPSBDLnVpbnQ2NF90KHguU2hhcmluZ1VzZWRGcmFt
ZXMpCisJeGMubWF4X3Bvc3NpYmxlX21mbiA9IEMudWludDY0X3QoeC5NYXhQb3NzaWJsZU1mbikK
Kwl4Yy5ucl9ub2RlcyA9IEMudWludDMyX3QoeC5Ock5vZGVzKQorCWlmIGVyciA6PSB4Lkh3Q2Fw
LnRvQygmeGMuaHdfY2FwKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeGMuY2Fw
X2h2bSA9IEMuYm9vbCh4LkNhcEh2bSkKKwl4Yy5jYXBfcHYgPSBDLmJvb2woeC5DYXBQdikKKwl4
Yy5jYXBfaHZtX2RpcmVjdGlvID0gQy5ib29sKHguQ2FwSHZtRGlyZWN0aW8pCisJeGMuY2FwX2hh
cCA9IEMuYm9vbCh4LkNhcEhhcCkKKwl4Yy5jYXBfc2hhZG93ID0gQy5ib29sKHguQ2FwU2hhZG93
KQorCXhjLmNhcF9pb21tdV9oYXBfcHRfc2hhcmUgPSBDLmJvb2woeC5DYXBJb21tdUhhcFB0U2hh
cmUpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKkNvbm5lY3RvcmluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX2Nvbm5lY3RvcmluZm8pIGVycm9yIHsKIAl4LlVuaXF1ZUlkID0gQy5Hb1N0cmlu
Zyh4Yy51bmlxdWVfaWQpCiAJeC5XaWR0aCA9IHVpbnQzMih4Yy53aWR0aCkKQEAgLTEyMjMsNiAr
MjQ4MiwyNiBAQCBmdW5jICh4ICpDb25uZWN0b3JpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25u
ZWN0b3JpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpDb25uZWN0b3Jp
bmZvKSB0b0MoeGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgKGVyciBlcnJvcikgeworCWRlZmVy
IGZ1bmMoKSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9jb25uZWN0b3JpbmZvX2Rp
c3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCWlmIHguVW5pcXVlSWQgIT0gIiIgeworCQl4Yy51bmlx
dWVfaWQgPSBDLkNTdHJpbmcoeC5VbmlxdWVJZCkKKwl9CisJeGMud2lkdGggPSBDLnVpbnQzMl90
KHguV2lkdGgpCisJeGMuaGVpZ2h0ID0gQy51aW50MzJfdCh4LkhlaWdodCkKKwl4Yy5yZXFfZXZ0
Y2ggPSBDLmludCh4LlJlcUV2dGNoKQorCXhjLnJlcV9ycmVmID0gQy5pbnQoeC5SZXFScmVmKQor
CXhjLmV2dF9ldnRjaCA9IEMuaW50KHguRXZ0RXZ0Y2gpCisJeGMuZXZ0X3JyZWYgPSBDLmludCh4
LkV2dFJyZWYpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKlZkaXNwbGluZm8pIGZyb21D
KHhjICpDLmxpYnhsX3ZkaXNwbGluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5n
KHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTEy
NDMsNiArMjUyMiwyOCBAQCBmdW5jICh4ICpWZGlzcGxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92
ZGlzcGxpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWZGlzcGxpbmZv
KSB0b0MoeGMgKkMubGlieGxfdmRpc3BsaW5mbykgKGVyciBlcnJvcikgeworCWRlZmVyIGZ1bmMo
KSB7CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF92ZGlzcGxpbmZvX2Rpc3Bvc2UoeGMp
CisJCX0KKwl9KCkKKworCWlmIHguQmFja2VuZCAhPSAiIiB7CisJCXhjLmJhY2tlbmQgPSBDLkNT
dHJpbmcoeC5CYWNrZW5kKQorCX0KKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tl
bmRJZCkKKwlpZiB4LkZyb250ZW5kICE9ICIiIHsKKwkJeGMuZnJvbnRlbmQgPSBDLkNTdHJpbmco
eC5Gcm9udGVuZCkKKwl9CisJeGMuZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJ
ZCkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50
KHguU3RhdGUpCisJeGMuYmVfYWxsb2MgPSBDLmJvb2woeC5CZUFsbG9jKQorCisJcmV0dXJuIG5p
bAorfQorCiBmdW5jICh4ICpTdHJlYW1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zdHJlYW1pbmZv
KSBlcnJvciB7CiAJeC5SZXFFdnRjaCA9IGludCh4Yy5yZXFfZXZ0Y2gpCiAJeC5SZXFScmVmID0g
aW50KHhjLnJlcV9ycmVmKQpAQCAtMTI1MCw2ICsyNTUxLDE5IEBAIGZ1bmMgKHggKlN0cmVhbWlu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX3N0cmVhbWluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKlN0cmVhbWluZm8pIHRvQyh4YyAqQy5saWJ4bF9zdHJlYW1pbmZvKSAoZXJy
IGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhs
X3N0cmVhbWluZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMucmVxX2V2dGNoID0gQy5p
bnQoeC5SZXFFdnRjaCkKKwl4Yy5yZXFfcnJlZiA9IEMuaW50KHguUmVxUnJlZikKKworCXJldHVy
biBuaWwKK30KKwogZnVuYyAoeCAqUGNtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfcGNtaW5mbykg
ZXJyb3IgewogCW51bVZzbmRTdHJlYW1zIDo9IGludCh4Yy5udW1fdnNuZF9zdHJlYW1zKQogCWNT
dHJlYW1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9zdHJlYW1pbmZvKSh1bnNhZmUuUG9pbnRlcih4
Yy5zdHJlYW1zKSlbOm51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJlYW1zXQpAQCAtMTI2Myw2ICsy
NTc3LDE2IEBAIGZ1bmMgKHggKlBjbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3BjbWluZm8pIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlBjbWluZm8pIHRvQyh4YyAqQy5saWJ4
bF9wY21pbmZvKSAoZXJyIGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5p
bCB7CisJCQlDLmxpYnhsX3BjbWluZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJcmV0dXJu
IG5pbAorfQorCiBmdW5jICh4ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8p
IGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5k
SWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTEyODIsNiArMjYwNiwyNyBAQCBmdW5jICh4
ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8pIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKK2Z1bmMgKHggKlZzbmRpbmZvKSB0b0MoeGMgKkMubGlieGxfdnNuZGluZm8pIChl
cnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGli
eGxfdnNuZGluZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJaWYgeC5CYWNrZW5kICE9ICIi
IHsKKwkJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQpCisJfQorCXhjLmJhY2tlbmRf
aWQgPSBDLnVpbnQzMl90KHguQmFja2VuZElkKQorCWlmIHguRnJvbnRlbmQgIT0gIiIgeworCQl4
Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCX0KKwl4Yy5mcm9udGVuZF9pZCA9
IEMudWludDMyX3QoeC5Gcm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRl
dmlkKQorCXhjLnN0YXRlID0gQy5pbnQoeC5TdGF0ZSkKKworCXJldHVybiBuaWwKK30KKwogZnVu
YyAoeCAqVmtiaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmtiaW5mbykgZXJyb3IgewogCXguQmFj
a2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5i
YWNrZW5kX2lkKQpAQCAtMTI5NSw2ICsyNjQwLDI5IEBAIGZ1bmMgKHggKlZrYmluZm8pIGZyb21D
KHhjICpDLmxpYnhsX3ZrYmluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHgg
KlZrYmluZm8pIHRvQyh4YyAqQy5saWJ4bF92a2JpbmZvKSAoZXJyIGVycm9yKSB7CisJZGVmZXIg
ZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX3ZrYmluZm9fZGlzcG9zZSh4
YykKKwkJfQorCX0oKQorCisJaWYgeC5CYWNrZW5kICE9ICIiIHsKKwkJeGMuYmFja2VuZCA9IEMu
Q1N0cmluZyh4LkJhY2tlbmQpCisJfQorCXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90KHguQmFj
a2VuZElkKQorCWlmIHguRnJvbnRlbmQgIT0gIiIgeworCQl4Yy5mcm9udGVuZCA9IEMuQ1N0cmlu
Zyh4LkZyb250ZW5kKQorCX0KKwl4Yy5mcm9udGVuZF9pZCA9IEMudWludDMyX3QoeC5Gcm9udGVu
ZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLnN0YXRlID0gQy5p
bnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0Y2gpCisJeGMucnJlZiA9IEMuaW50
KHguUnJlZikKKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqTnVtYWluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX251bWFpbmZvKSBlcnJvciB7CiAJeC5TaXplID0gdWludDY0KHhjLnNpemUpCiAJ
eC5GcmVlID0gdWludDY0KHhjLmZyZWUpCkBAIC0xMzA4LDYgKzI2NzYsMTkgQEAgZnVuYyAoeCAq
TnVtYWluZm8pIGZyb21DKHhjICpDLmxpYnhsX251bWFpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpOdW1haW5mbykgdG9DKHhjICpDLmxpYnhsX251bWFpbmZvKSAoZXJy
IGVycm9yKSB7CisJZGVmZXIgZnVuYygpIHsKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhs
X251bWFpbmZvX2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCXhjLnNpemUgPSBDLnVpbnQ2NF90
KHguU2l6ZSkKKwl4Yy5mcmVlID0gQy51aW50NjRfdCh4LkZyZWUpCisKKwlyZXR1cm4gbmlsCit9
CisKIGZ1bmMgKHggKkNwdXRvcG9sb2d5KSBmcm9tQyh4YyAqQy5saWJ4bF9jcHV0b3BvbG9neSkg
ZXJyb3IgewogCXguQ29yZSA9IHVpbnQzMih4Yy5jb3JlKQogCXguU29ja2V0ID0gdWludDMyKHhj
LnNvY2tldCkKQEAgLTEzMTYsNiArMjY5NywyMCBAQCBmdW5jICh4ICpDcHV0b3BvbG9neSkgZnJv
bUMoeGMgKkMubGlieGxfY3B1dG9wb2xvZ3kpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1
bmMgKHggKkNwdXRvcG9sb2d5KSB0b0MoeGMgKkMubGlieGxfY3B1dG9wb2xvZ3kpIChlcnIgZXJy
b3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfY3B1
dG9wb2xvZ3lfZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuY29yZSA9IEMudWludDMyX3Qo
eC5Db3JlKQorCXhjLnNvY2tldCA9IEMudWludDMyX3QoeC5Tb2NrZXQpCisJeGMubm9kZSA9IEMu
dWludDMyX3QoeC5Ob2RlKQorCisJcmV0dXJuIG5pbAorfQorCiBmdW5jICh4ICpQY2l0b3BvbG9n
eSkgZnJvbUMoeGMgKkMubGlieGxfcGNpdG9wb2xvZ3kpIGVycm9yIHsKIAl4LlNlZyA9IHVpbnQx
Nih4Yy5zZWcpCiAJeC5CdXMgPSBieXRlKHhjLmJ1cykKQEAgLTEzMjUsNiArMjcyMCwyMSBAQCBm
dW5jICh4ICpQY2l0b3BvbG9neSkgZnJvbUMoeGMgKkMubGlieGxfcGNpdG9wb2xvZ3kpIGVycm9y
IHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlBjaXRvcG9sb2d5KSB0b0MoeGMgKkMubGli
eGxfcGNpdG9wb2xvZ3kpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIg
IT0gbmlsIHsKKwkJCUMubGlieGxfcGNpdG9wb2xvZ3lfZGlzcG9zZSh4YykKKwkJfQorCX0oKQor
CisJeGMuc2VnID0gQy51aW50MTZfdCh4LlNlZykKKwl4Yy5idXMgPSBDLnVpbnQ4X3QoeC5CdXMp
CisJeGMuZGV2Zm4gPSBDLnVpbnQ4X3QoeC5EZXZmbikKKwl4Yy5ub2RlID0gQy51aW50MzJfdCh4
Lk5vZGUpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1bmMgKHggKlNjaGVkQ3JlZGl0UGFyYW1zKSBm
cm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXRfcGFyYW1zKSBlcnJvciB7CiAJeC5Uc2xpY2VN
cyA9IGludCh4Yy50c2xpY2VfbXMpCiAJeC5SYXRlbGltaXRVcyA9IGludCh4Yy5yYXRlbGltaXRf
dXMpCkBAIC0xMzMzLDEyICsyNzQzLDI2IEBAIGZ1bmMgKHggKlNjaGVkQ3JlZGl0UGFyYW1zKSBm
cm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXRfcGFyYW1zKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykgdG9DKHhjICpDLmxpYnhsX3NjaGVk
X2NyZWRpdF9wYXJhbXMpIChlcnIgZXJyb3IpIHsKKwl4Yy50c2xpY2VfbXMgPSBDLmludCh4LlRz
bGljZU1zKQorCXhjLnJhdGVsaW1pdF91cyA9IEMuaW50KHguUmF0ZWxpbWl0VXMpCisJeGMudmNw
dV9taWdyX2RlbGF5X3VzID0gQy5pbnQoeC5WY3B1TWlnckRlbGF5VXMpCisKKwlyZXR1cm4gbmls
Cit9CisKIGZ1bmMgKHggKlNjaGVkQ3JlZGl0MlBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2No
ZWRfY3JlZGl0Ml9wYXJhbXMpIGVycm9yIHsKIAl4LlJhdGVsaW1pdFVzID0gaW50KHhjLnJhdGVs
aW1pdF91cykKIAogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqU2NoZWRDcmVkaXQyUGFyYW1z
KSB0b0MoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0Ml9wYXJhbXMpIChlcnIgZXJyb3IpIHsKKwl4
Yy5yYXRlbGltaXRfdXMgPSBDLmludCh4LlJhdGVsaW1pdFVzKQorCisJcmV0dXJuIG5pbAorfQor
CiBmdW5jICh4ICpEb21haW5SZW11c0luZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZW11
c19pbmZvKSBlcnJvciB7CiAJeC5JbnRlcnZhbCA9IGludCh4Yy5pbnRlcnZhbCkKIAlpZiBlcnIg
Oj0geC5BbGxvd1Vuc2FmZS5mcm9tQygmeGMuYWxsb3dfdW5zYWZlKTsgZXJyICE9IG5pbCB7CkBA
IC0xMzY3LDYgKzI3OTEsNDIgQEAgZnVuYyAoeCAqRG9tYWluUmVtdXNJbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF9kb21haW5fcmVtdXNfaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVu
YyAoeCAqRG9tYWluUmVtdXNJbmZvKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8p
IChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMu
bGlieGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuaW50
ZXJ2YWwgPSBDLmludCh4LkludGVydmFsKQorCWlmIGVyciA6PSB4LkFsbG93VW5zYWZlLnRvQygm
eGMuYWxsb3dfdW5zYWZlKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJy
IDo9IHguQmxhY2tob2xlLnRvQygmeGMuYmxhY2tob2xlKTsgZXJyICE9IG5pbCB7CisJCXJldHVy
biBlcnIKKwl9CisJaWYgZXJyIDo9IHguQ29tcHJlc3Npb24udG9DKCZ4Yy5jb21wcmVzc2lvbik7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4Lk5ldGJ1Zi50b0Mo
JnhjLm5ldGJ1Zik7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIHguTmV0YnVm
c2NyaXB0ICE9ICIiIHsKKwkJeGMubmV0YnVmc2NyaXB0ID0gQy5DU3RyaW5nKHguTmV0YnVmc2Ny
aXB0KQorCX0KKwlpZiBlcnIgOj0geC5EaXNrYnVmLnRvQygmeGMuZGlza2J1Zik7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkNvbG8udG9DKCZ4Yy5jb2xvKTsg
ZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguVXNlcnNwYWNlQ29s
b1Byb3h5LnRvQygmeGMudXNlcnNwYWNlX2NvbG9fcHJveHkpOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRXZlbnQpIGZyb21DKHhj
ICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CiAJaWYgZXJyIDo9IHguTGluay5mcm9tQygmeGMubGlu
ayk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZXJyCkBAIC0xNDM2LDYgKzI4OTYsMjUgQEAgZnVu
YyAoeCAqRXZlbnRUeXBlVW5pb25PcGVyYXRpb25Db21wbGV0ZSkgZnJvbUMoeGMgKkMubGlieGxf
ZXZlbnQpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkV2ZW50KSB0b0MoeGMg
KkMubGlieGxfZXZlbnQpIChlcnIgZXJyb3IpIHsKKwlkZWZlciBmdW5jKCkgeworCQlpZiBlcnIg
IT0gbmlsIHsKKwkJCUMubGlieGxfZXZlbnRfZGlzcG9zZSh4YykKKwkJfQorCX0oKQorCisJaWYg
ZXJyIDo9IHguTGluay50b0MoJnhjLmxpbmspOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgor
CX0KKwl4Yy5kb21pZCA9IEMubGlieGxfZG9taWQoeC5Eb21pZCkKKwlpZiBlcnIgOj0geC5Eb211
dWlkLnRvQygmeGMuZG9tdXVpZCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXhj
LmZvcl91c2VyID0gQy51aW50NjRfdCh4LkZvclVzZXIpCisKKwlyZXR1cm4gbmlsCit9CisKIGZ1
bmMgKHggKlBzckNhdEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9jYXRfaW5mbykgZXJyb3Ig
ewogCXguSWQgPSB1aW50MzIoeGMuaWQpCiAJeC5Db3NNYXggPSB1aW50MzIoeGMuY29zX21heCkK
QEAgLTE0NDUsNiArMjkyNCwyMSBAQCBmdW5jICh4ICpQc3JDYXRJbmZvKSBmcm9tQyh4YyAqQy5s
aWJ4bF9wc3JfY2F0X2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlBz
ckNhdEluZm8pIHRvQyh4YyAqQy5saWJ4bF9wc3JfY2F0X2luZm8pIChlcnIgZXJyb3IpIHsKKwlk
ZWZlciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfcHNyX2NhdF9pbmZv
X2Rpc3Bvc2UoeGMpCisJCX0KKwl9KCkKKworCXhjLmlkID0gQy51aW50MzJfdCh4LklkKQorCXhj
LmNvc19tYXggPSBDLnVpbnQzMl90KHguQ29zTWF4KQorCXhjLmNibV9sZW4gPSBDLnVpbnQzMl90
KHguQ2JtTGVuKQorCXhjLmNkcF9lbmFibGVkID0gQy5ib29sKHguQ2RwRW5hYmxlZCkKKworCXJl
dHVybiBuaWwKK30KKwogZnVuYyAoeCAqUHNySHdJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3Jf
aHdfaW5mbykgZXJyb3IgewogCXguSWQgPSB1aW50MzIoeGMuaWQpCiAJeC5UeXBlID0gUHNyRmVh
dFR5cGUoeGMuX3R5cGUpCkBAIC0xNDkxLDMgKzI5ODUsMTUgQEAgZnVuYyAoeCAqUHNySHdJbmZv
VHlwZVVuaW9uTWJhKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfaHdfaW5mbykgZXJyb3IgewogCXgu
TGluZWFyID0gYm9vbCh0bXAubGluZWFyKQogCXJldHVybiBuaWwKIH0KKworZnVuYyAoeCAqUHNy
SHdJbmZvKSB0b0MoeGMgKkMubGlieGxfcHNyX2h3X2luZm8pIChlcnIgZXJyb3IpIHsKKwlkZWZl
ciBmdW5jKCkgeworCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfcHNyX2h3X2luZm9fZGlz
cG9zZSh4YykKKwkJfQorCX0oKQorCisJeGMuaWQgPSBDLnVpbnQzMl90KHguSWQpCisKKwlyZXR1
cm4gbmlsCit9CmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28g
Yi90b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28KaW5kZXggMjM3ZjI2YmNlOS4uMjRi
MWUwMjJmZiAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hlbmxpZ2h0LmdvCisr
KyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC94ZW5saWdodC5nbwpAQCAtMTQwLDE0ICsxNDAsMTIg
QEAgZnVuYyAodSAqVXVpZCkgZnJvbUMoYyAqQy5saWJ4bF91dWlkKSBlcnJvciB7CiAJcmV0dXJu
IG5pbAogfQogCi1mdW5jICh1ICpVdWlkKSB0b0MoKSAoQy5saWJ4bF91dWlkLCBlcnJvcikgewot
CXZhciBjIEMubGlieGxfdXVpZAotCitmdW5jICh1ICpVdWlkKSB0b0MoY3UgKkMubGlieGxfdXVp
ZCkgZXJyb3IgewogCWZvciBpLCB2IDo9IHJhbmdlIHUgewotCQljLnV1aWRbaV0gPSBDLnVpbnQ4
X3QodikKKwkJY3UudXVpZFtpXSA9IEMudWludDhfdCh2KQogCX0KIAotCXJldHVybiBjLCBuaWwK
KwlyZXR1cm4gbmlsCiB9CiAKIC8vIGRlZmJvb2xWYWwgcmVwcmVzZW50cyBhIGRlZmJvb2wgdmFs
dWUuCkBAIC0yMzIsMTUgKzIzMCwxMyBAQCBmdW5jIChkICpEZWZib29sKSBmcm9tQyhjICpDLmxp
YnhsX2RlZmJvb2wpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKLWZ1bmMgKGQgKkRlZmJvb2wp
IHRvQygpIChDLmxpYnhsX2RlZmJvb2wsIGVycm9yKSB7Ci0JdmFyIGMgQy5saWJ4bF9kZWZib29s
Ci0KK2Z1bmMgKGQgKkRlZmJvb2wpIHRvQyhjZCAqQy5saWJ4bF9kZWZib29sKSBlcnJvciB7CiAJ
aWYgIWQuSXNEZWZhdWx0KCkgewogCQl2YWwsIF8gOj0gZC5WYWwoKQotCQlDLmxpYnhsX2RlZmJv
b2xfc2V0KCZjLCBDLmJvb2wodmFsKSkKKwkJQy5saWJ4bF9kZWZib29sX3NldChjZCwgQy5ib29s
KHZhbCkpCiAJfQogCi0JcmV0dXJuIGMsIG5pbAorCXJldHVybiBuaWwKIH0KIAogLy8gTWFjIHJl
cHJlc2VudHMgYSBsaWJ4bF9tYWMsIG9yIHNpbXBseSBhIE1BQyBhZGRyZXNzLgpAQCAtMjY2LDE0
ICsyNjIsMTIgQEAgZnVuYyAobWFjICpNYWMpIGZyb21DKGNtYWMgKkMubGlieGxfbWFjKSBlcnJv
ciB7CiAJcmV0dXJuIG5pbAogfQogCi1mdW5jIChtYWMgTWFjKSB0b0MoKSAoQy5saWJ4bF9tYWMs
IGVycm9yKSB7Ci0JdmFyIGNtYWMgQy5saWJ4bF9tYWMKLQorZnVuYyAobWFjIE1hYykgdG9DKGNt
ICpDLmxpYnhsX21hYykgZXJyb3IgewogCWZvciBpLCB2IDo9IHJhbmdlIG1hYyB7Ci0JCWNtYWNb
aV0gPSBDLnVpbnQ4X3QodikKKwkJKCpjbSlbaV0gPSBDLnVpbnQ4X3QodikKIAl9CiAKLQlyZXR1
cm4gY21hYywgbmlsCisJcmV0dXJuIG5pbAogfQogCiAvLyBNc1ZtR2VuaWQgcmVwcmVzZW50cyBh
IGxpYnhsX21zX3ZtX2dlbmlkLgpAQCAtMjg3LDE0ICsyODEsMTIgQEAgZnVuYyAobXZnICpNc1Zt
R2VuaWQpIGZyb21DKGNtdmcgKkMubGlieGxfbXNfdm1fZ2VuaWQpIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKLWZ1bmMgKG12ZyAqTXNWbUdlbmlkKSB0b0MoKSAoQy5saWJ4bF9tc192bV9nZW5p
ZCwgZXJyb3IpIHsKLQl2YXIgY212ZyBDLmxpYnhsX21zX3ZtX2dlbmlkCi0KK2Z1bmMgKG12ZyAq
TXNWbUdlbmlkKSB0b0MoY212ZyAqQy5saWJ4bF9tc192bV9nZW5pZCkgZXJyb3IgewogCWZvciBp
LCB2IDo9IHJhbmdlIG12ZyB7CiAJCWNtdmcuYnl0ZXNbaV0gPSBDLnVpbnQ4X3QodikKIAl9CiAK
LQlyZXR1cm4gY212ZywgbmlsCisJcmV0dXJuIG5pbAogfQogCiAvLyBFdkxpbmsgcmVwcmVzZW50
cyBhIGxpYnhsX2V2X2xpbmsuCkBAIC0zMDQsOCArMjk2LDggQEAgZnVuYyAobXZnICpNc1ZtR2Vu
aWQpIHRvQygpIChDLmxpYnhsX21zX3ZtX2dlbmlkLCBlcnJvcikgewogLy8gdGhyb3VnaCB0aGUg
R28gcGFja2FnZS4KIHR5cGUgRXZMaW5rIHN0cnVjdHt9CiAKLWZ1bmMgKGVsICpFdkxpbmspIGZy
b21DKGNlbCAqQy5saWJ4bF9ldl9saW5rKSBlcnJvciAgICAgIHsgcmV0dXJuIG5pbCB9Ci1mdW5j
IChlbCAqRXZMaW5rKSB0b0MoKSAoY2VsIEMubGlieGxfZXZfbGluaywgZXJyIGVycm9yKSB7IHJl
dHVybiB9CitmdW5jIChlbCAqRXZMaW5rKSBmcm9tQyhjZWwgKkMubGlieGxfZXZfbGluaykgZXJy
b3IgICAgIHsgcmV0dXJuIG5pbCB9CitmdW5jIChlbCAqRXZMaW5rKSB0b0MoY2VsICpDLmxpYnhs
X2V2X2xpbmspIChlcnIgZXJyb3IpIHsgcmV0dXJuIH0KIAogLy8gQ3B1aWRQb2xpY3lMaXN0IHJl
cHJlc2VudHMgYSBsaWJ4bF9jcHVpZF9wb2xpY3lfbGlzdC4KIC8vCkBAIC0zMTYsMjAgKzMwOCwx
OCBAQCB0eXBlIENwdWlkUG9saWN5TGlzdCBzdHJpbmcKIAogZnVuYyAoY3BsIENwdWlkUG9saWN5
TGlzdCkgZnJvbUMoY2NwbCAqQy5saWJ4bF9jcHVpZF9wb2xpY3lfbGlzdCkgZXJyb3IgeyByZXR1
cm4gbmlsIH0KIAotZnVuYyAoY3BsIENwdWlkUG9saWN5TGlzdCkgdG9DKCkgKEMubGlieGxfY3B1
aWRfcG9saWN5X2xpc3QsIGVycm9yKSB7Ci0JdmFyIGNjcGwgQy5saWJ4bF9jcHVpZF9wb2xpY3lf
bGlzdAotCitmdW5jIChjcGwgQ3B1aWRQb2xpY3lMaXN0KSB0b0MoY2NwbCAqQy5saWJ4bF9jcHVp
ZF9wb2xpY3lfbGlzdCkgZXJyb3IgewogCXMgOj0gQy5DU3RyaW5nKHN0cmluZyhjcGwpKQogCWRl
ZmVyIEMuZnJlZSh1bnNhZmUuUG9pbnRlcihzKSkKIAotCXJldCA6PSBDLmxpYnhsX2NwdWlkX3Bh
cnNlX2NvbmZpZygmY2NwbCwgcykKKwlyZXQgOj0gQy5saWJ4bF9jcHVpZF9wYXJzZV9jb25maWco
Y2NwbCwgcykKIAlpZiByZXQgIT0gMCB7Ci0JCUMubGlieGxfY3B1aWRfZGlzcG9zZSgmY2NwbCkK
KwkJQy5saWJ4bF9jcHVpZF9kaXNwb3NlKGNjcGwpCiAKLQkJcmV0dXJuIGNjcGwsIEVycm9yKC1y
ZXQpCisJCXJldHVybiBFcnJvcigtcmV0KQogCX0KIAotCXJldHVybiBjY3BsLCBuaWwKKwlyZXR1
cm4gbmlsCiB9CiAKIC8vIEh3Y2FwIHJlcHJlc2VudHMgYSBsaWJ4bF9od2NhcC4KQEAgLTM0Mywx
NCArMzMzLDEyIEBAIGZ1bmMgKGh3Y2FwICpId2NhcCkgZnJvbUMoY2h3Y2FwICpDLmxpYnhsX2h3
Y2FwKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCi1mdW5jIChod2NhcCAqSHdjYXApIHRvQygp
IChDLmxpYnhsX2h3Y2FwLCBlcnJvcikgewotCXZhciBjaHdjYXAgQy5saWJ4bF9od2NhcAotCitm
dW5jIChod2NhcCAqSHdjYXApIHRvQyhjaHdjYXAgKkMubGlieGxfaHdjYXApIGVycm9yIHsKIAlm
b3IgaSwgdiA6PSByYW5nZSBod2NhcCB7Ci0JCWNod2NhcFtpXSA9IEMudWludDMyX3QodikKKwkJ
KCpjaHdjYXApW2ldID0gQy51aW50MzJfdCh2KQogCX0KIAotCXJldHVybiBjaHdjYXAsIG5pbAor
CXJldHVybiBuaWwKIH0KIAogLy8gS2V5VmFsdWVMaXN0IHJlcHJlc2VudHMgYSBsaWJ4bF9rZXlf
dmFsdWVfbGlzdC4KQEAgLTM2MCw4ICszNDgsOCBAQCBmdW5jIChod2NhcCAqSHdjYXApIHRvQygp
IChDLmxpYnhsX2h3Y2FwLCBlcnJvcikgewogLy8gR28gcGFja2FnZS4KIHR5cGUgS2V5VmFsdWVM
aXN0IHN0cnVjdHt9CiAKLWZ1bmMgKGt2bCBLZXlWYWx1ZUxpc3QpIGZyb21DKGNrdmwgKkMubGli
eGxfa2V5X3ZhbHVlX2xpc3QpIGVycm9yICAgICAgeyByZXR1cm4gbmlsIH0KLWZ1bmMgKGt2bCBL
ZXlWYWx1ZUxpc3QpIHRvQygpIChja3ZsIEMubGlieGxfa2V5X3ZhbHVlX2xpc3QsIGVyciBlcnJv
cikgeyByZXR1cm4gfQorZnVuYyAoa3ZsIEtleVZhbHVlTGlzdCkgZnJvbUMoY2t2bCAqQy5saWJ4
bF9rZXlfdmFsdWVfbGlzdCkgZXJyb3IgICAgIHsgcmV0dXJuIG5pbCB9CitmdW5jIChrdmwgS2V5
VmFsdWVMaXN0KSB0b0MoY2t2bCAqQy5saWJ4bF9rZXlfdmFsdWVfbGlzdCkgKGVyciBlcnJvcikg
eyByZXR1cm4gfQogCiAvLyBTdHJpbmdMaXN0IHJlcHJlc2VudHMgYSBsaWJ4bF9zdHJpbmdfbGlz
dC4KIHR5cGUgU3RyaW5nTGlzdCBbXXN0cmluZwpAQCAtMzc5LDE3ICszNjcsMTcgQEAgZnVuYyAo
c2wgKlN0cmluZ0xpc3QpIGZyb21DKGNzbCAqQy5saWJ4bF9zdHJpbmdfbGlzdCkgZXJyb3Igewog
CXJldHVybiBuaWwKIH0KIAotZnVuYyAoc2wgU3RyaW5nTGlzdCkgdG9DKCkgKEMubGlieGxfc3Ry
aW5nX2xpc3QsIGVycm9yKSB7CitmdW5jIChzbCBTdHJpbmdMaXN0KSB0b0MoY3NsICpDLmxpYnhs
X3N0cmluZ19saXN0KSBlcnJvciB7CiAJdmFyIGNoYXIgKkMuY2hhcgogCXNpemUgOj0gbGVuKHNs
KQotCWNzbCA6PSAoQy5saWJ4bF9zdHJpbmdfbGlzdCkoQy5tYWxsb2MoQy51bG9uZyhzaXplKSAq
IEMudWxvbmcodW5zYWZlLlNpemVvZihjaGFyKSkpKQorCSpjc2wgPSAoQy5saWJ4bF9zdHJpbmdf
bGlzdCkoQy5tYWxsb2MoQy51bG9uZyhzaXplKSAqIEMudWxvbmcodW5zYWZlLlNpemVvZihjaGFy
KSkpKQogCWNsaXN0IDo9ICgqWzEgPDwgMzBdKkMuY2hhcikodW5zYWZlLlBvaW50ZXIoY3NsKSlb
OnNpemU6c2l6ZV0KIAogCWZvciBpLCB2IDo9IHJhbmdlIHNsIHsKIAkJY2xpc3RbaV0gPSBDLkNT
dHJpbmcodikKIAl9CiAKLQlyZXR1cm4gY3NsLCBuaWwKKwlyZXR1cm4gbmlsCiB9CiAKIC8vIEJp
dG1hcCByZXByZXNlbnRzIGEgbGlieGxfYml0bWFwLgpAQCAtNDIxLDkgKzQwOSw3IEBAIGZ1bmMg
KGJtICpCaXRtYXApIGZyb21DKGNibSAqQy5saWJ4bF9iaXRtYXApIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKLWZ1bmMgKGJtICpCaXRtYXApIHRvQygpIChDLmxpYnhsX2JpdG1hcCwgZXJyb3Ip
IHsKLQl2YXIgY2JtIEMubGlieGxfYml0bWFwCi0KK2Z1bmMgKGJtICpCaXRtYXApIHRvQyhjYm0g
KkMubGlieGxfYml0bWFwKSBlcnJvciB7CiAJc2l6ZSA6PSBsZW4oYm0uYml0bWFwKQogCWNibS5z
aXplID0gQy51aW50MzJfdChzaXplKQogCWNibS5fbWFwID0gKCpDLnVpbnQ4X3QpKEMubWFsbG9j
KEMudWxvbmcoY2JtLnNpemUpICogQy5zaXplb2ZfdWludDhfdCkpCkBAIC00MzEsNyArNDE3LDcg
QEAgZnVuYyAoYm0gKkJpdG1hcCkgdG9DKCkgKEMubGlieGxfYml0bWFwLCBlcnJvcikgewogCiAJ
Y29weShjcywgYm0uYml0bWFwKQogCi0JcmV0dXJuIGNibSwgbmlsCisJcmV0dXJuIG5pbAogfQog
CiBmdW5jIChzciBTaHV0ZG93blJlYXNvbikgU3RyaW5nKCkgKHN0ciBzdHJpbmcpIHsKQEAgLTUz
NCw4ICs1MjAsOCBAQCBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcmVhdGUoTmFtZSBzdHJp
bmcsIFNjaGVkdWxlciBTY2hlZHVsZXIsIENwdW1hcCBCaXRtYQogCXZhciB1dWlkIEMubGlieGxf
dXVpZAogCUMubGlieGxfdXVpZF9nZW5lcmF0ZSgmdXVpZCkKIAotCWNibSwgZXJyIDo9IENwdW1h
cC50b0MoKQotCWlmIGVyciAhPSBuaWwgeworCXZhciBjYm0gQy5saWJ4bF9iaXRtYXAKKwlpZiBl
cnIgPSBDcHVtYXAudG9DKCZjYm0pOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuCiAJfQogCWRlZmVy
IEMubGlieGxfYml0bWFwX2Rpc3Bvc2UoJmNibSkKQEAgLTU3Nyw4ICs1NjMsOCBAQCBmdW5jIChD
dHggKkNvbnRleHQpIENwdXBvb2xDcHVhZGQoUG9vbGlkIHVpbnQzMiwgQ3B1IGludCkgKGVyciBl
cnJvcikgewogLy8gaW50IGxpYnhsX2NwdXBvb2xfY3B1YWRkX2NwdW1hcChsaWJ4bF9jdHggKmN0
eCwgdWludDMyX3QgcG9vbGlkLAogLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBsaWJ4bF9iaXRtYXAgKmNwdW1hcCk7CiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xD
cHVhZGRDcHVtYXAoUG9vbGlkIHVpbnQzMiwgQ3B1bWFwIEJpdG1hcCkgKGVyciBlcnJvcikgewot
CWNibSwgZXJyIDo9IENwdW1hcC50b0MoKQotCWlmIGVyciAhPSBuaWwgeworCXZhciBjYm0gQy5s
aWJ4bF9iaXRtYXAKKwlpZiBlcnIgPSBDcHVtYXAudG9DKCZjYm0pOyBlcnIgIT0gbmlsIHsKIAkJ
cmV0dXJuCiAJfQogCWRlZmVyIEMubGlieGxfYml0bWFwX2Rpc3Bvc2UoJmNibSkKQEAgLTYwNiw4
ICs1OTIsOCBAQCBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcHVyZW1vdmUoUG9vbGlkIHVp
bnQzMiwgQ3B1IGludCkgKGVyciBlcnJvcikgewogLy8gaW50IGxpYnhsX2NwdXBvb2xfY3B1cmVt
b3ZlX2NwdW1hcChsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgcG9vbGlkLAogLy8gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9iaXRtYXAgKmNwdW1hcCk7CiBm
dW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcHVyZW1vdmVDcHVtYXAoUG9vbGlkIHVpbnQzMiwg
Q3B1bWFwIEJpdG1hcCkgKGVyciBlcnJvcikgewotCWNibSwgZXJyIDo9IENwdW1hcC50b0MoKQot
CWlmIGVyciAhPSBuaWwgeworCXZhciBjYm0gQy5saWJ4bF9iaXRtYXAKKwlpZiBlcnIgPSBDcHVt
YXAudG9DKCZjYm0pOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuCiAJfQogCWRlZmVyIEMubGlieGxf
Yml0bWFwX2Rpc3Bvc2UoJmNibSkKLS0gCjIuMTcuMQoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=

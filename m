Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id A19B7179198
	for <lists+xen-devel@lfdr.de>; Wed,  4 Mar 2020 14:42:12 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j9UFI-0006WV-7a; Wed, 04 Mar 2020 13:39:32 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=FNX+=4V=yandex-team.ru=lekiravi@srs-us1.protection.inumbo.net>)
 id 1j9TkI-0003sd-FJ
 for xen-devel@lists.xenproject.org; Wed, 04 Mar 2020 13:07:30 +0000
X-Inumbo-ID: 194157ae-5e19-11ea-a3ce-12813bfff9fa
Received: from forwardcorp1p.mail.yandex.net (unknown [77.88.29.217])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 194157ae-5e19-11ea-a3ce-12813bfff9fa;
 Wed, 04 Mar 2020 13:07:28 +0000 (UTC)
Received: from mxbackcorp1g.mail.yandex.net (mxbackcorp1g.mail.yandex.net
 [IPv6:2a02:6b8:0:1402::301])
 by forwardcorp1p.mail.yandex.net (Yandex) with ESMTP id 13D102E1649;
 Wed,  4 Mar 2020 16:07:27 +0300 (MSK)
Received: from sas1-9998cec34266.qloud-c.yandex.net
 (sas1-9998cec34266.qloud-c.yandex.net [2a02:6b8:c14:3a0e:0:640:9998:cec3])
 by mxbackcorp1g.mail.yandex.net (mxbackcorp/Yandex) with ESMTP id
 9Imv48VQsj-7NESTh5B; Wed, 04 Mar 2020 16:07:26 +0300
Precedence: bulk
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yandex-team.ru;
 s=default; 
 t=1583327247; bh=tTDvuiSO8FFJBQlIbfJ4TO8Uc4zxjf0cSMuuGhZLZT0=;
 h=In-Reply-To:Message-Id:References:Date:Subject:To:From:Cc;
 b=AIsqSV/iOe/tcW44q8wqeElZn3bbSNMmxNGBUhstrIG49W+B1NH78k/azN61vuBAr
 9AX76wjxsiE0L/T7u7G4hh3bLZDdlCmMnw2SE8W4lf0VaM+aa+G9Ylpm70Nz1X/O9a
 sJwkvMkF9rCSCoGcm1q7v+acvjiUecXTeOnsU4EA=
Authentication-Results: mxbackcorp1g.mail.yandex.net;
 dkim=pass header.i=@yandex-team.ru
Received: from dynamic-red.dhcp.yndx.net (dynamic-red.dhcp.yndx.net
 [2a02:6b8:0:40c:b4f7:3f29:4fea:8822])
 by sas1-9998cec34266.qloud-c.yandex.net (smtpcorp/Yandex) with ESMTPSA id
 ujb0Gsh6CR-7NWOtUTS; Wed, 04 Mar 2020 16:07:23 +0300
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (Client certificate not present)
From: Alexey Kirillov <lekiravi@yandex-team.ru>
To: Eric Blake <eblake@redhat.com>, Thomas Huth <huth@tuxfamily.org>,
 Markus Armbruster <armbru@redhat.com>
Date: Wed,  4 Mar 2020 16:06:55 +0300
Message-Id: <20200304130656.16859-4-lekiravi@yandex-team.ru>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200304130656.16859-1-lekiravi@yandex-team.ru>
References: <20200304130656.16859-1-lekiravi@yandex-team.ru>
X-Mailman-Approved-At: Wed, 04 Mar 2020 13:39:29 +0000
Subject: [Xen-devel] [PATCH v2 3/4] hmp: Use QMP query-netdevs in
 hmp_info_network
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Peter Maydell <peter.maydell@linaro.org>,
 Dmitry Fleytman <dmitry.fleytman@gmail.com>,
 "Michael S. Tsirkin" <mst@redhat.com>, Jason Wang <jasowang@redhat.com>,
 qemu-devel@nongnu.org, Vincenzo Maffione <v.maffione@gmail.com>,
 Gerd Hoffmann <kraxel@redhat.com>,
 "Edgar E. Iglesias" <edgar.iglesias@gmail.com>,
 Sven Schnelle <svens@stackframe.org>, Rob Herring <robh@kernel.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Paul Durrant <paul@xen.org>,
 Joel Stanley <joel@jms.id.au>, Anthony Perard <anthony.perard@citrix.com>,
 Samuel Thibault <samuel.thibault@ens-lyon.org>,
 Aleksandar Rikalo <aleksandar.rikalo@rt-rk.com>,
 David Gibson <david@gibson.dropbear.id.au>,
 Laurent Vivier <lvivier@redhat.com>, Jiri Pirko <jiri@resnulli.us>,
 yc-core@yandex-team.ru, Stefan Weil <sw@weilnetz.de>,
 Alistair Francis <alistair@alistair23.me>,
 Beniamino Galvani <b.galvani@gmail.com>, qemu-arm@nongnu.org,
 Peter Chubb <peter.chubb@nicta.com.au>,
 =?UTF-8?q?C=C3=A9dric=20Le=20Goater?= <clg@kaod.org>,
 xen-devel@lists.xenproject.org, Giuseppe Lettieri <g.lettieri@iet.unipi.it>,
 Luigi Rizzo <rizzo@iet.unipi.it>, Richard Henderson <rth@twiddle.net>,
 Andrew Jeffery <andrew@aj.id.au>, Michael Walle <michael@walle.cc>,
 qemu-ppc@nongnu.org, Aleksandar Markovic <amarkovic@wavecomp.com>,
 Alexey Kirillov <lekiravi@yandex-team.ru>, Paolo Bonzini <pbonzini@redhat.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UmVwbGFjZSBsZWdhY3kgZmllbGQgaW5mb19zdHIgb2YgTmV0Q2xpZW50U3RhdGUgd2l0aApyZXN1
bHQgb2YgUU1QIGNvbW1hbmQgcXVlcnktbmV0ZGV2cy4KClNpZ25lZC1vZmYtYnk6IEFsZXhleSBL
aXJpbGxvdiA8bGVraXJhdmlAeWFuZGV4LXRlYW0ucnU+Ci0tLQogaW5jbHVkZS9uZXQvbmV0Lmgg
fCAgIDMgKy0KIG5ldC9jbGllbnRzLmggICAgIHwgICAxICsKIG5ldC9odWIuYyAgICAgICAgIHwg
ICA0ICstCiBuZXQvaHViLmggICAgICAgICB8ICAgMiArLQogbmV0L25ldC5jICAgICAgICAgfCAx
NzUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLQogbmV0L3Zk
ZS5jICAgICAgICAgfCAgMTAgKysrCiA2IGZpbGVzIGNoYW5nZWQsIDE4NiBpbnNlcnRpb25zKCsp
LCA5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbmV0L25ldC5oIGIvaW5jbHVk
ZS9uZXQvbmV0LmgKaW5kZXggMmM4OTU2YzBiMy4uOWRmNDY4MDkzNyAxMDA2NDQKLS0tIGEvaW5j
bHVkZS9uZXQvbmV0LmgKKysrIGIvaW5jbHVkZS9uZXQvbmV0LmgKQEAgLTE3MSw3ICsxNzEsOCBA
QCB2b2lkIHFlbXVfY2hlY2tfbmljX21vZGVsKE5JQ0luZm8gKm5kLCBjb25zdCBjaGFyICptb2Rl
bCk7CiBpbnQgcWVtdV9maW5kX25pY19tb2RlbChOSUNJbmZvICpuZCwgY29uc3QgY2hhciAqIGNv
bnN0ICptb2RlbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkZWZhdWx0
X21vZGVsKTsKIAotdm9pZCBwcmludF9uZXRfY2xpZW50KE1vbml0b3IgKm1vbiwgTmV0Q2xpZW50
U3RhdGUgKm5jKTsKK3ZvaWQgcHJpbnRfbmV0X2NsaWVudChNb25pdG9yICptb24sIE5ldENsaWVu
dFN0YXRlICpuYywKKyAgICAgICAgICAgICAgICAgICAgICBOZXRkZXZJbmZvTGlzdCAqbmlfbGlz
dCk7CiB2b2lkIGhtcF9pbmZvX25ldHdvcmsoTW9uaXRvciAqbW9uLCBjb25zdCBRRGljdCAqcWRp
Y3QpOwogdm9pZCBuZXRfc29ja2V0X3JzX2luaXQoU29ja2V0UmVhZFN0YXRlICpycywKICAgICAg
ICAgICAgICAgICAgICAgICAgIFNvY2tldFJlYWRTdGF0ZUZpbmFsaXplICpmaW5hbGl6ZSwKZGlm
ZiAtLWdpdCBhL25ldC9jbGllbnRzLmggYi9uZXQvY2xpZW50cy5oCmluZGV4IGE2ZWYyNjdlMTku
LmY0Mzk5MzM1MjIgMTAwNjQ0Ci0tLSBhL25ldC9jbGllbnRzLmgKKysrIGIvbmV0L2NsaWVudHMu
aApAQCAtNTEsNiArNTEsNyBAQCBpbnQgbmV0X2luaXRfbDJ0cHYzKGNvbnN0IE5ldGRldiAqbmV0
ZGV2LCBjb25zdCBjaGFyICpuYW1lLAogI2lmZGVmIENPTkZJR19WREUKIGludCBuZXRfaW5pdF92
ZGUoY29uc3QgTmV0ZGV2ICpuZXRkZXYsIGNvbnN0IGNoYXIgKm5hbWUsCiAgICAgICAgICAgICAg
ICAgIE5ldENsaWVudFN0YXRlICpwZWVyLCBFcnJvciAqKmVycnApOworaW50IG5ldF92ZGVfZ2V0
X2ZkKGNvbnN0IE5ldENsaWVudFN0YXRlICpuYyk7CiAjZW5kaWYKIAogI2lmZGVmIENPTkZJR19O
RVRNQVAKZGlmZiAtLWdpdCBhL25ldC9odWIuYyBiL25ldC9odWIuYwppbmRleCAzNzk5NWI1NTE3
Li5jY2U5NzBiNTlkIDEwMDY0NAotLS0gYS9uZXQvaHViLmMKKysrIGIvbmV0L2h1Yi5jCkBAIC0y
NTIsNyArMjUyLDcgQEAgTmV0Q2xpZW50U3RhdGUgKm5ldF9odWJfcG9ydF9maW5kKGludCBodWJf
aWQpCiAvKioKICAqIFByaW50IGh1YiBjb25maWd1cmF0aW9uCiAgKi8KLXZvaWQgbmV0X2h1Yl9p
bmZvKE1vbml0b3IgKm1vbikKK3ZvaWQgbmV0X2h1Yl9pbmZvKE1vbml0b3IgKm1vbiwgTmV0ZGV2
SW5mb0xpc3QgKm5pX2xpc3QpCiB7CiAgICAgTmV0SHViICpodWI7CiAgICAgTmV0SHViUG9ydCAq
cG9ydDsKQEAgLTI2Myw3ICsyNjMsNyBAQCB2b2lkIG5ldF9odWJfaW5mbyhNb25pdG9yICptb24p
CiAgICAgICAgICAgICBtb25pdG9yX3ByaW50Zihtb24sICIgXFwgJXMiLCBwb3J0LT5uYy5uYW1l
KTsKICAgICAgICAgICAgIGlmIChwb3J0LT5uYy5wZWVyKSB7CiAgICAgICAgICAgICAgICAgbW9u
aXRvcl9wcmludGYobW9uLCAiOiAiKTsKLSAgICAgICAgICAgICAgICBwcmludF9uZXRfY2xpZW50
KG1vbiwgcG9ydC0+bmMucGVlcik7CisgICAgICAgICAgICAgICAgcHJpbnRfbmV0X2NsaWVudCht
b24sIHBvcnQtPm5jLnBlZXIsIG5pX2xpc3QpOwogICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg
ICAgICAgICAgICBtb25pdG9yX3ByaW50Zihtb24sICJcbiIpOwogICAgICAgICAgICAgfQpkaWZm
IC0tZ2l0IGEvbmV0L2h1Yi5oIGIvbmV0L2h1Yi5oCmluZGV4IDY2ZDMzMjJmYWMuLjQyNDY1OGE0
YTIgMTAwNjQ0Ci0tLSBhL25ldC9odWIuaAorKysgYi9uZXQvaHViLmgKQEAgLTE5LDcgKzE5LDcg
QEAKIE5ldENsaWVudFN0YXRlICpuZXRfaHViX2FkZF9wb3J0KGludCBodWJfaWQsIGNvbnN0IGNo
YXIgKm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOZXRDbGllbnRTdGF0
ZSAqaHVicGVlcik7CiBOZXRDbGllbnRTdGF0ZSAqbmV0X2h1Yl9maW5kX2NsaWVudF9ieV9uYW1l
KGludCBodWJfaWQsIGNvbnN0IGNoYXIgKm5hbWUpOwotdm9pZCBuZXRfaHViX2luZm8oTW9uaXRv
ciAqbW9uKTsKK3ZvaWQgbmV0X2h1Yl9pbmZvKE1vbml0b3IgKm1vbiwgTmV0ZGV2SW5mb0xpc3Qg
Km5pbmZvKTsKIHZvaWQgbmV0X2h1Yl9jaGVja19jbGllbnRzKHZvaWQpOwogYm9vbCBuZXRfaHVi
X2ZsdXNoKE5ldENsaWVudFN0YXRlICpuYyk7CiAKZGlmZiAtLWdpdCBhL25ldC9uZXQuYyBiL25l
dC9uZXQuYwppbmRleCAwMWUwNTQ4Mjk1Li4xYTgxNTNkYmY3IDEwMDY0NAotLS0gYS9uZXQvbmV0
LmMKKysrIGIvbmV0L25ldC5jCkBAIC0xMjcxLDE0ICsxMjcxLDE3NiBAQCBzdGF0aWMgdm9pZCBu
ZXRmaWx0ZXJfcHJpbnRfaW5mbyhNb25pdG9yICptb24sIE5ldEZpbHRlclN0YXRlICpuZikKICAg
ICBtb25pdG9yX3ByaW50Zihtb24sICJcbiIpOwogfQogCi12b2lkIHByaW50X25ldF9jbGllbnQo
TW9uaXRvciAqbW9uLCBOZXRDbGllbnRTdGF0ZSAqbmMpCitzdGF0aWMgTmV0ZGV2SW5mbyAqZ2V0
X25ldGRldl9pbmZvKE5ldGRldkluZm9MaXN0ICpuaV9saXN0LCBjaGFyICpuYW1lKQoreworICAg
IE5ldGRldkluZm8gKm5pOworCisgICAgd2hpbGUgKG5pX2xpc3QpIHsKKyAgICAgICAgbmkgPSBu
aV9saXN0LT52YWx1ZTsKKyAgICAgICAgaWYgKGdfc3RyX2VxdWFsKG5pLT5pZCwgbmFtZSkpIHsK
KyAgICAgICAgICAgIHJldHVybiBuaTsKKyAgICAgICAgfQorICAgICAgICBuaV9saXN0ID0gbmlf
bGlzdC0+bmV4dDsKKyAgICB9CisKKyAgICByZXR1cm4gTlVMTDsKK30KKworc3RhdGljIGNoYXIg
KmdlbmVyYXRlX2luZm9fc3RyKE5ldGRldkluZm8gKm5pLCBOZXRDbGllbnRTdGF0ZSAqbmMpCit7
CisgICAgY2hhciAqaW5mb19zdHI7CisKKyAgICBpZiAoIW5pKSB7CisgICAgICAgIHJldHVybiBn
X21hbGxvYzAoMSk7CisgICAgfQorCisgICAgc3dpdGNoIChuaS0+dHlwZSkgeworICAgICAgICBj
YXNlIE5FVF9DTElFTlRfRFJJVkVSX05JQzogeworICAgICAgICAgICAgaW5mb19zdHIgPSBnX3N0
cmR1cF9wcmludGYoIm1vZGVsPSVzLG1hY2FkZHI9JXMiLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbmktPnUubmljLm1vZGVsLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbmktPnUubmljLm1hY2FkZHIpOworICAgICAgICAgICAgYnJlYWs7
CisgICAgICAgIH0KKyNpZmRlZiBDT05GSUdfU0xJUlAKKyAgICAgICAgY2FzZSBORVRfQ0xJRU5U
X0RSSVZFUl9VU0VSOiB7CisgICAgICAgICAgICBzaXplX3QgbGVuID0gc3RyY2hyKG5pLT51LnVz
ZXIubmV0LCAnLycpIC0gbmktPnUudXNlci5uZXQ7CisgICAgICAgICAgICBjaGFyICpuZXQgPSBn
X3N0cm5kdXAobmktPnUudXNlci5uZXQsIGxlbik7CisKKyAgICAgICAgICAgIGluZm9fc3RyID0g
Z19zdHJkdXBfcHJpbnRmKCJuZXQ9JXMscmVzdHJpY3Q9JXMiLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbmV0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbmktPnUudXNlci5xX3Jlc3RyaWN0ID8gIm9uIiA6ICJvZmYiKTsKKyAgICAgICAg
ICAgIGdfZnJlZShuZXQpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyNlbmRpZiAv
KiBDT05GSUdfU0xJUlAgKi8KKyAgICAgICAgY2FzZSBORVRfQ0xJRU5UX0RSSVZFUl9UQVA6IHsK
KyNpZm5kZWYgX1dJTjMyCisgICAgICAgICAgICBpZiAobmktPnUudGFwLmhhc19mZHMpIHsKKyAg
ICAgICAgICAgICAgICBjaGFyICoqZmRzID0gZ19zdHJzcGxpdChuaS0+dS50YXAuZmRzLCAiOiIs
IC0xKTsKKworICAgICAgICAgICAgICAgIGluZm9fc3RyID0gZ19zdHJkdXBfcHJpbnRmKCJmZD0l
cyIsIGZkc1tuYy0+cXVldWVfaW5kZXhdKTsKKyAgICAgICAgICAgICAgICBnX3N0cmZyZWV2KGZk
cyk7CisgICAgICAgICAgICB9IGVsc2UgaWYgKG5pLT51LnRhcC5oYXNfaGVscGVyKSB7CisgICAg
ICAgICAgICAgICAgaW5mb19zdHIgPSBnX3N0cmR1cF9wcmludGYoImhlbHBlcj0lcyIsIG5pLT51
LnRhcC5oZWxwZXIpOworICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICBpbmZv
X3N0ciA9IGdfc3RyZHVwX3ByaW50ZigiaWZuYW1lPSVzLHNjcmlwdD0lcyxkb3duc2NyaXB0PSVz
IiwKKyAgICAgICAgICAgICAgICAgICAgbmktPnUudGFwLmlmbmFtZSwKKyAgICAgICAgICAgICAg
ICAgICAgbmMtPnF1ZXVlX2luZGV4ID09IDAgPyBuaS0+dS50YXAuc2NyaXB0IDogIm5vIiwKKyAg
ICAgICAgICAgICAgICAgICAgbmMtPnF1ZXVlX2luZGV4ID09IDAgPyBuaS0+dS50YXAuZG93bnNj
cmlwdCA6ICJubyIpOworICAgICAgICAgICAgfQorI2Vsc2UKKyAgICAgICAgICAgIGluZm9fc3Ry
ID0gZ19zdHJkdXBfcHJpbnRmKCJ0YXA6IGlmbmFtZT0lcyIsIG5pLT51LnRhcC5pZm5hbWUpOwor
I2VuZGlmIC8qIF9XSU4zMiAqLworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyNpZmRl
ZiBDT05GSUdfTDJUUFYzCisgICAgICAgIGNhc2UgTkVUX0NMSUVOVF9EUklWRVJfTDJUUFYzOiB7
CisgICAgICAgICAgICBpbmZvX3N0ciA9IGdfc3RyZHVwX3ByaW50ZigibDJ0cHYzOiBjb25uZWN0
ZWQiKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICB9CisjZW5kaWYgLyogQ09ORklHX0wy
VFBWMyAqLworICAgICAgICBjYXNlIE5FVF9DTElFTlRfRFJJVkVSX1NPQ0tFVDogeworICAgICAg
ICAgICAgaWYgKG5pLT51LnNvY2tldC5oYXNfbGlzdGVuKSB7CisgICAgICAgICAgICAgICAgaWYg
KG5pLT51LnNvY2tldC5oYXNfZmQpIHsKKyAgICAgICAgICAgICAgICAgICAgaW5mb19zdHIgPSBn
X3N0cmR1cF9wcmludGYoInNvY2tldDogY29ubmVjdGlvbiBmcm9tICVzIiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmktPnUuc29ja2V0Lmxpc3Rlbik7
CisgICAgICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICAgICAgaW5mb19zdHIg
PSBnX3N0cmR1cF9wcmludGYoInNvY2tldDogd2FpdCBmcm9tICVzIiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmktPnUuc29ja2V0Lmxpc3Rlbik7Cisg
ICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgfSBlbHNlIGlmIChuaS0+dS5zb2NrZXQuaGFz
X2Nvbm5lY3QgJiYgbmktPnUuc29ja2V0Lmhhc19mZCkgeworICAgICAgICAgICAgICAgIGluZm9f
c3RyID0gZ19zdHJkdXBfcHJpbnRmKCJzb2NrZXQ6IGNvbm5lY3QgdG8gJXMiLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pLT51LnNvY2tldC5jb25uZWN0KTsK
KyAgICAgICAgICAgIH0gZWxzZSBpZiAobmktPnUuc29ja2V0Lmhhc19tY2FzdCAmJiBuaS0+dS5z
b2NrZXQuaGFzX2ZkKSB7CisgICAgICAgICAgICAgICAgaW5mb19zdHIgPSBnX3N0cmR1cF9wcmlu
dGYoInNvY2tldDogbWNhc3Q9JXMiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG5pLT51LnNvY2tldC5tY2FzdCk7CisgICAgICAgICAgICB9IGVsc2UgaWYgKG5p
LT51LnNvY2tldC5oYXNfdWRwICYmIG5pLT51LnNvY2tldC5oYXNfZmQpIHsKKyAgICAgICAgICAg
ICAgICBpbmZvX3N0ciA9IGdfc3RyZHVwX3ByaW50Zigic29ja2V0OiB1ZHA9JXMiLCBuaS0+dS5z
b2NrZXQudWRwKTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgZ19hc3Nl
cnQobmktPnUuc29ja2V0Lmhhc19mZCk7CisgICAgICAgICAgICAgICAgaW50IHNvX3R5cGUgPSAt
MTsKKyAgICAgICAgICAgICAgICBpbnQgb3B0bGVuID0gc2l6ZW9mKHNvX3R5cGUpOworICAgICAg
ICAgICAgICAgIGludCBmZCA9IGF0b2kobmktPnUuc29ja2V0LmZkKTsKKworICAgICAgICAgICAg
ICAgIGdldHNvY2tvcHQoZmQsIFNPTF9TT0NLRVQsIFNPX1RZUEUsIChjaGFyICopJnNvX3R5cGUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAoc29ja2xlbl90ICopJm9wdGxlbik7CisgICAg
ICAgICAgICAgICAgaWYgKHNvX3R5cGUgPT0gU09DS19TVFJFQU0pIHsKKyAgICAgICAgICAgICAg
ICAgICAgaW5mb19zdHIgPSBnX3N0cmR1cF9wcmludGYoInNvY2tldDogZmQ9JXMiLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaS0+dS5zb2NrZXQuZmQp
OworICAgICAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgICAgIGlmIChuaS0+
dS5zb2NrZXQuaGFzX21jYXN0KSB7CisgICAgICAgICAgICAgICAgICAgICAgICAvKgorICAgICAg
ICAgICAgICAgICAgICAgICAgICogVGhpcyBicmFuY2ggaXMgdW5yZWFjaGFibGUsIGFjY29yZGlu
ZyB0byBob3cgaXQgaXMgaW4KKyAgICAgICAgICAgICAgICAgICAgICAgICAqIG5ldC9zb2NrZXQu
YyBhdCB0aGlzIG1vbWVudAorICAgICAgICAgICAgICAgICAgICAgICAgICovCisgICAgICAgICAg
ICAgICAgICAgICAgICBpbmZvX3N0ciA9IGdfc3RyZHVwX3ByaW50Zigic29ja2V0OiBmZD0lcyAi
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiKGNs
b25lZCBtY2FzdD0lcykiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbmktPnUuc29ja2V0LmZkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbmktPnUuc29ja2V0Lm1jYXN0KTsKKyAgICAgICAgICAg
ICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICAgICAgICAgIFNvY2tldEFkZHJlc3Mg
KnNhID0gc29ja2V0X2xvY2FsX2FkZHJlc3MoZmQsIE5VTEwpOworCisgICAgICAgICAgICAgICAg
ICAgICAgICBpbmZvX3N0ciA9IGdfc3RyZHVwX3ByaW50Zigic29ja2V0OiBmZD0lcyAlcyIsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbmktPnUuc29ja2V0LmZkLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFNvY2tldEFkZHJlc3NUeXBlX3N0cihzYS0+dHlwZSkpOworICAgICAg
ICAgICAgICAgICAgICAgICAgcWFwaV9mcmVlX1NvY2tldEFkZHJlc3Moc2EpOworICAgICAgICAg
ICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgfQorICAgICAgICAg
ICAgYnJlYWs7CisgICAgICAgIH0KKyNpZmRlZiBDT05GSUdfVkRFCisgICAgICAgIGNhc2UgTkVU
X0NMSUVOVF9EUklWRVJfVkRFOiB7CisgICAgICAgICAgICBpbmZvX3N0ciA9IGdfc3RyZHVwX3By
aW50Zigic29jaz0lcyxmZD0lZCIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBuaS0+dS52ZGUuc29jaywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG5ldF92ZGVfZ2V0X2ZkKG5jKSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQor
I2VuZGlmIC8qIENPTkZJR19WREUgKi8KKyNpZmRlZiBDT05GSUdfTkVUX0JSSURHRQorICAgICAg
ICBjYXNlIE5FVF9DTElFTlRfRFJJVkVSX0JSSURHRTogeworICAgICAgICAgICAgaW5mb19zdHIg
PSBnX3N0cmR1cF9wcmludGYoImhlbHBlcj0lcyxicj0lcyIsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBuaS0+dS5icmlkZ2UuaGVscGVyLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbmktPnUuYnJpZGdlLmJyKTsKKyAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICB9CisjZW5kaWYgLyogQ09ORklHX05FVF9CUklER0UgKi8KKyNpZmRlZiBD
T05GSUdfTkVUTUFQCisgICAgICAgIGNhc2UgTkVUX0NMSUVOVF9EUklWRVJfTkVUTUFQOiB7Cisg
ICAgICAgICAgICBpbmZvX3N0ciA9IGdfc3RyZHVwX3ByaW50ZigibmV0bWFwOiBpZm5hbWU9JXMi
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmktPnUubmV0bWFwLmlm
bmFtZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorI2VuZGlmIC8qIENPTkZJR19O
RVRNQVAgKi8KKyNpZmRlZiBDT05GSUdfVkhPU1RfTkVUX1VTRVIKKyAgICAgICAgY2FzZSBORVRf
Q0xJRU5UX0RSSVZFUl9WSE9TVF9VU0VSOiB7CisgICAgICAgICAgICBpbmZvX3N0ciA9IGdfc3Ry
ZHVwX3ByaW50Zigidmhvc3QtdXNlciVkIHRvICVzIiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG5jLT5xdWV1ZV9pbmRleCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG5pLT51LnZob3N0X3VzZXIuY2hhcmRldik7CisgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgfQorI2VuZGlmIC8qIENPTkZJR19WSE9TVF9ORVRfVVNFUiAqLworICAg
ICAgICBkZWZhdWx0OiB7CisgICAgICAgICAgICBpbmZvX3N0ciA9IGdfbWFsbG9jMCgxKTsKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICB9CisgICAgfQorCisgICAgcmV0dXJuIGluZm9fc3Ry
OworfQorCit2b2lkIHByaW50X25ldF9jbGllbnQoTW9uaXRvciAqbW9uLCBOZXRDbGllbnRTdGF0
ZSAqbmMsIE5ldGRldkluZm9MaXN0ICpuaV9saXN0KQogewogICAgIE5ldEZpbHRlclN0YXRlICpu
ZjsKKyAgICBOZXRkZXZJbmZvICpuaSA9IGdldF9uZXRkZXZfaW5mbyhuaV9saXN0LCBuYy0+bmFt
ZSk7CisgICAgY2hhciAqaW5mb19zdHIgPSBnZW5lcmF0ZV9pbmZvX3N0cihuaSwgbmMpOwogCiAg
ICAgbW9uaXRvcl9wcmludGYobW9uLCAiJXM6IGluZGV4PSVkLHR5cGU9JXMsJXNcbiIsIG5jLT5u
YW1lLAogICAgICAgICAgICAgICAgICAgIG5jLT5xdWV1ZV9pbmRleCwKICAgICAgICAgICAgICAg
ICAgICBOZXRDbGllbnREcml2ZXJfc3RyKG5jLT5pbmZvLT50eXBlKSwKLSAgICAgICAgICAgICAg
ICAgICBuYy0+aW5mb19zdHIpOworICAgICAgICAgICAgICAgICAgIGluZm9fc3RyKTsKKyAgICBn
X2ZyZWUoaW5mb19zdHIpOworCiAgICAgaWYgKCFRVEFJTFFfRU1QVFkoJm5jLT5maWx0ZXJzKSkg
ewogICAgICAgICBtb25pdG9yX3ByaW50Zihtb24sICJmaWx0ZXJzOlxuIik7CiAgICAgfQpAQCAt
MTQxNSw4ICsxNTc3LDkgQEAgdm9pZCBobXBfaW5mb19uZXR3b3JrKE1vbml0b3IgKm1vbiwgY29u
c3QgUURpY3QgKnFkaWN0KQogewogICAgIE5ldENsaWVudFN0YXRlICpuYywgKnBlZXI7CiAgICAg
TmV0Q2xpZW50RHJpdmVyIHR5cGU7CisgICAgTmV0ZGV2SW5mb0xpc3QgKm5pX2xpc3QgPSBxbXBf
cXVlcnlfbmV0ZGV2cyhOVUxMKTsKIAotICAgIG5ldF9odWJfaW5mbyhtb24pOworICAgIG5ldF9o
dWJfaW5mbyhtb24sIG5pX2xpc3QpOwogCiAgICAgUVRBSUxRX0ZPUkVBQ0gobmMsICZuZXRfY2xp
ZW50cywgbmV4dCkgewogICAgICAgICBwZWVyID0gbmMtPnBlZXI7CkBAIC0xNDI4LDEzICsxNTkx
LDE1IEBAIHZvaWQgaG1wX2luZm9fbmV0d29yayhNb25pdG9yICptb24sIGNvbnN0IFFEaWN0ICpx
ZGljdCkKICAgICAgICAgfQogCiAgICAgICAgIGlmICghcGVlciB8fCB0eXBlID09IE5FVF9DTElF
TlRfRFJJVkVSX05JQykgewotICAgICAgICAgICAgcHJpbnRfbmV0X2NsaWVudChtb24sIG5jKTsK
KyAgICAgICAgICAgIHByaW50X25ldF9jbGllbnQobW9uLCBuYywgbmlfbGlzdCk7CiAgICAgICAg
IH0gLyogZWxzZSBpdCdzIGEgbmV0ZGV2IGNvbm5lY3RlZCB0byBhIE5JQywgcHJpbnRlZCB3aXRo
IHRoZSBOSUMgKi8KICAgICAgICAgaWYgKHBlZXIgJiYgdHlwZSA9PSBORVRfQ0xJRU5UX0RSSVZF
Ul9OSUMpIHsKICAgICAgICAgICAgIG1vbml0b3JfcHJpbnRmKG1vbiwgIiBcXCAiKTsKLSAgICAg
ICAgICAgIHByaW50X25ldF9jbGllbnQobW9uLCBwZWVyKTsKKyAgICAgICAgICAgIHByaW50X25l
dF9jbGllbnQobW9uLCBwZWVyLCBuaV9saXN0KTsKICAgICAgICAgfQogICAgIH0KKworICAgIHFh
cGlfZnJlZV9OZXRkZXZJbmZvTGlzdChuaV9saXN0KTsKIH0KIAogdm9pZCBjb2xvX25vdGlmeV9m
aWx0ZXJzX2V2ZW50KGludCBldmVudCwgRXJyb3IgKiplcnJwKQpkaWZmIC0tZ2l0IGEvbmV0L3Zk
ZS5jIGIvbmV0L3ZkZS5jCmluZGV4IGMwYWIyYmI2NWMuLmM0ZWRmNWNiYTEgMTAwNjQ0Ci0tLSBh
L25ldC92ZGUuYworKysgYi9uZXQvdmRlLmMKQEAgLTE1MywzICsxNTMsMTMgQEAgaW50IG5ldF9p
bml0X3ZkZShjb25zdCBOZXRkZXYgKm5ldGRldiwgY29uc3QgY2hhciAqbmFtZSwKIAogICAgIHJl
dHVybiAwOwogfQorCitpbnQgbmV0X3ZkZV9nZXRfZmQoY29uc3QgTmV0Q2xpZW50U3RhdGUgKm5j
KQoreworICAgIFZERVN0YXRlICpzOworICAgIGFzc2VydChuYy0+aW5mby0+dHlwZSA9PSBORVRf
Q0xJRU5UX0RSSVZFUl9WREUpOworCisgICAgcyA9IERPX1VQQ0FTVChWREVTdGF0ZSwgbmMsIG5j
KTsKKworICAgIHJldHVybiB2ZGVfZGF0YWZkKHMtPnZkZSk7Cit9Ci0tIAoyLjE3LjEKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

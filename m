Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E1000B3915
	for <lists+xen-devel@lfdr.de>; Mon, 16 Sep 2019 13:07:54 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9ool-0006xK-77; Mon, 16 Sep 2019 11:05:15 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GGTU=XL=amazon.de=prvs=1553567f6=wipawel@srs-us1.protection.inumbo.net>)
 id 1i9ook-0006wW-6S
 for xen-devel@lists.xen.org; Mon, 16 Sep 2019 11:05:14 +0000
X-Inumbo-ID: da748f0b-d871-11e9-95df-12813bfff9fa
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id da748f0b-d871-11e9-95df-12813bfff9fa;
 Mon, 16 Sep 2019 11:05:13 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1568631913; x=1600167913;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=SMofy9JWypsM4GiXxih+8JYD6SF5NfEhLTKAI9ovN5E=;
 b=quugxIYEBoTHnl7uAO6xJVD1pdo/Dum8qGGNYIT/zweVAmgbmLLTIsSl
 Nyyq5UX9P4IfOiIXpV1egKeysqaftFUkRwiqrEIKP/ktVjaB9gHW38I1Y
 2HIabEulgEvRhS0aTnJpgSAkDLvQa9Pk+NAQv1Bd6zUN/ZVggvklAJcxv o=;
X-IronPort-AV: E=Sophos;i="5.64,512,1559520000"; d="scan'208";a="702597616"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-1e-303d0b0e.us-east-1.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 16 Sep 2019 11:04:14 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1e-303d0b0e.us-east-1.amazon.com (Postfix) with ESMTPS
 id CA4F5A2618; Mon, 16 Sep 2019 11:04:06 +0000 (UTC)
Received: from EX13D03EUA004.ant.amazon.com (10.43.165.93) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:03:53 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D03EUA004.ant.amazon.com (10.43.165.93) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:03:52 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Mon, 16 Sep 2019 11:03:50 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>, <xen-devel@lists.xenproject.org>
Date: Mon, 16 Sep 2019 10:59:43 +0000
Message-ID: <20190916105945.93632-11-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190916105945.93632-1-wipawel@amazon.de>
References: <20190916105945.93632-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v3 10/12] livepatch: Handle arbitrary size names
 with the list operation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHBheWxvYWRzJyBuYW1lIHN0cmluZ3MgY2FuIGJlIG9mIGFyYml0cmFyeSBzaXplICh0eXBp
Y2FsbHkgc21hbGwKd2l0aCBhbiB1cHBlciBib3VuZCBvZiBYRU5fTElWRVBBVENIX05BTUVfU0la
RSkuCkN1cnJlbnQgaW1wbGVtZW50YXRpb24gb2YgdGhlIGxpc3Qgb3BlcmF0aW9uIGludGVyZmFj
ZSBhbGxvd3MgdG8gY29weQpuYW1lcyBpbiB0aGUgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUgY2h1
bmtzIHJlZ2FyZGxlc3Mgb2YgaXRzIGFjdHVhbApzaXplIGFuZCBlbmZvcmNlcyBzcGFjZSBhbGxv
Y2F0aW9uIHJlcXVpcmVtZW50cyBvbiB1c2VybGFuZCB0b29scy4KClRvIHVuaWZ5IGFuZCBzaW1w
bGlmeSB0aGUgaW50ZXJmYWNlLCBoYW5kbGUgdGhlIG5hbWUgc3RyaW5ncyBvZgphcmJpdHJhcnkg
c2l6ZSBieSBjb3B5aW5nIHRoZW0gaW4gYWRoZXJpbmcgY2h1bmtzIHRvIHRoZSB1c2VybGFuZC4K
SW4gb3JkZXIgdG8gbGV0IHRoZSB1c2VybGFuZCBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgZm9yIHRo
ZSBpbmNvbWluZwpkYXRhIGFkZCBhbiBhdXhpbGlhcnkgaW50ZXJmYWNlIHhjX2xpdmVwYXRjaF9s
aXN0X2dldF9zaXplcygpIHRoYXQKcHJvdmlkZXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxv
YWQgZW50cmllcyBhbmQgdGhlIHRvdGFsIHNpemUgb2YKYWxsIG5hbWUgc3RyaW5ncy4gVGhpcyBp
cyBhY2hpZXZlZCBieSBleHRlbmRpbmcgdGhlIHN5c2N0bCBsaXN0CmludGVyZmFjZSB3aXRoIGFu
IGV4dHJhIGZpZWxkczogbmFtZV90b3RhbF9zaXplLgoKVGhlIHhjX2xpdmVwYXRjaF9saXN0X2dl
dF9zaXplcygpIGlzc3VlcyB0aGUgbGl2ZXBhdGNoIHN5c2N0bCBsaXN0Cm9wZXJhdGlvbiB3aXRo
IHRoZSBuciBmaWVsZCBzZXQgdG8gMC4gSW4gdGhpcyBtb2RlIHRoZSBvcGVyYXRpb24KcmV0dXJu
cyB0aGUgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcyBhbmQgY2FsY3VsYXRlcyB0aGUgdG90YWwg
c2l6ZXMKZm9yIGFsbCBwYXlsb2FkcycgbmFtZXMuCldoZW4gdGhlIHN5c2N0bCBvcGVyYXRpb24g
aXMgaXNzdWVkIHdpdGggYSBub24temVybyBuciBmaWVsZCAoZm9yCmluc3RhbmNlIHdpdGggYSB2
YWx1ZSBvYnRhaW5lZCBlYXJsaWVyIHdpdGggdGhlIHByaW9yIGNhbGwgdG8gdGhlCnhjX2xpdmVw
YXRjaF9saXN0X2dldF9zaXplcygpKSB0aGUgbmV3IGZpZWxkIG5hbWVfdG90YWxfc2l6ZSBwcm92
aWRlcwp0aGUgdG90YWwgc2l6ZSBvZiBhY3R1YWxseSBjb3BpZWQgZGF0YS4KCkV4dGVuZCB0aGUg
bGlieGMgdG8gaGFuZGxlIHRoZSBuYW1lIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycy4KClRo
ZSB4ZW4tbGl2ZXBhdGNoIHRvb2wgaXMgbW9kaWZpZWQgdG8gc3RhcnQgdGhlIGxpc3Qgb3BlcmF0
aW9uIHdpdGggYQpjYWxsIHRvIHRoZSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSB0byBv
YnRhaW4gdGhlIGFjdHVhbCBudW1iZXIKb2YgcGF5bG9hZHMgYXMgd2VsbCBhcyB0aGUgbmVjZXNz
YXJ5IHNwYWNlIGZvciBuYW1lcy4KVGhlIHRvb2wgbm93IGFsd2F5cyByZXF1ZXN0cyB0aGUgYWN0
dWFsIG51bWJlciBvZiBlbnRyaWVzIGFuZCBsZWF2ZXMKdGhlIHByZWVtcHRpb24gaGFuZGxpbmcg
dG8gdGhlIGxpYnhjIHJvdXRpbmUuIFRoZSBsaWJ4YyBzdGlsbCByZXR1cm5zCidkb25lJyBhbmQg
J2xlZnQnIHBhcmFtZXRlcnMgd2l0aCB0aGUgc2FtZSBzZW1hbnRpYyBhbGxvd2luZyB0aGUgdG9v
bAp0byBkZXRlY3QgYW5vbWFsaWVzIGFuZCByZWFjdCB0byB0aGVtLiBBdCB0aGUgbW9tZW50IGl0
IGlzIGV4cGVjdGVkCnRoYXQgdGhlIHRvb2wgcmVjZWl2ZXMgdGhlIGV4YWN0IG51bWJlciBvZiBl
bnRpcmVzIGFzIHJlcXVlc3RlZC4KVGhlIHhlbi1saXZlcGF0Y2ggdG9vbCBoYXMgYmVlbiBhbHNv
IG1vZGlmaWVkIHRvIGhhbmRsZSB0aGUgbmFtZQpiYWNrLXRvLWJhY2sgdHJhbnNmZXJzIGNvcnJl
Y3RseS4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpv
bi5kZT4KUmV2aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9u
LmNvbT4KUmV2aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmll
d2VkLWJ5OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5
OiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+Ci0tLQpDaGFu
Z2VkIHNpbmNlIHYxOgogICogYWRkZWQgY29ycmVzcG9uZGluZyBkb2N1bWVudGF0aW9uCgogZG9j
cy9taXNjL2xpdmVwYXRjaC5wYW5kb2MgICAgfCAgMjQgKysrKystLS0tCiB0b29scy9saWJ4Yy9p
bmNsdWRlL3hlbmN0cmwuaCB8ICA0OSArKysrKysrKysrKystLS0tLS0KIHRvb2xzL2xpYnhjL3hj
X21pc2MuYyAgICAgICAgIHwgMTAwICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0t
LS0KIHRvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jICAgIHwgMTEyICsrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0tLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9saXZlcGF0Y2guYyAgICAgICAg
fCAgMzEgKysrKysrKysrLS0tCiB4ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmggICB8ICAxNSAr
KystLS0KIDYgZmlsZXMgY2hhbmdlZCwgMjE5IGluc2VydGlvbnMoKyksIDExMiBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYyBiL2RvY3MvbWlzYy9s
aXZlcGF0Y2gucGFuZG9jCmluZGV4IDQwNmZiNzlkZjguLmU3YmNjNzBmNWEgMTAwNjQ0Ci0tLSBh
L2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jCisrKyBiL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFu
ZG9jCkBAIC03MTcsMTcgKzcxNywyMCBAQCBUaGUgY2FsbGVyIHByb3ZpZGVzOgogICogYGlkeGAg
SW5kZXggaXRlcmF0b3IuIFRoZSBpbmRleCBpbnRvIHRoZSBoeXBlcnZpc29yJ3MgcGF5bG9hZCBj
b3VudC4gSXQgaXMKICAgICByZWNvbW1lbmRlZCB0aGF0IG9uIGZpcnN0IGludm9jYXRpb24gemVy
byBiZSB1c2VkIHNvIHRoYXQgYG5yYCAod2hpY2ggdGhlCiAgICAgaHlwZXJ2aXNvciB3aWxsIHVw
ZGF0ZSB3aXRoIHRoZSByZW1haW5pbmcgcGF5bG9hZCBjb3VudCkgYmUgcHJvdmlkZWQuCi0gICAg
QWxzbyB0aGUgaHlwZXJ2aXNvciB3aWxsIHByb3ZpZGUgYHZlcnNpb25gIHdpdGggdGhlIG1vc3Qg
Y3VycmVudCB2YWx1ZS4KKyAgICBBbHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVy
c2lvbmAgd2l0aCB0aGUgbW9zdCBjdXJyZW50IHZhbHVlIGFuZAorICAgIGNhbGN1bGF0ZWQgdG90
YWwgc2l6ZSBmb3IgYWxsIHBheWxvYWRzJyBuYW1lcy4KICAqIGBucmAgVGhlIG1heCBudW1iZXIg
b2YgZW50cmllcyB0byBwb3B1bGF0ZS4gQ2FuIGJlIHplcm8gd2hpY2ggd2lsbCByZXN1bHQKICAg
ICBpbiB0aGUgaHlwZXJjYWxsIGJlaW5nIGEgcHJvYmluZyBvbmUgYW5kIHJldHVybiB0aGUgbnVt
YmVyIG9mIHBheWxvYWRzCiAgICAgKGFuZCB1cGRhdGUgdGhlIGB2ZXJzaW9uYCkuCiAgKiBgcGFk
YCAtICpNVVNUKiBiZSB6ZXJvLgogICogYHN0YXR1c2AgVmlydHVhbCBhZGRyZXNzIG9mIHdoZXJl
IHRvIHdyaXRlIGBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXNgCiAgICBzdHJ1Y3R1cmVzLiBD
YWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4KLSAqIGBuYW1lYCAtIFZp
cnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgdW5pcXVlIG5hbWUgb2YgdGhlIHBh
eWxvYWQuCi0gICBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4gRWFj
aCAqTVVTVCogYmUgb2YKLSAgICoqWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUqKiBzaXplLiBOb3Rl
IHRoYXQgKipYRU5fTElWRVBBVENIX05BTUVfU0laRSoqIGluY2x1ZGVzCi0gICB0aGUgTlVMIHRl
cm1pbmF0b3IuCisgKiBgbmFtZWAgLSBWaXJ0dWFsIGFkZHJlc3Mgb2Ygd2hlcmUgdG8gd3JpdGUg
dGhlIHVuaXF1ZSBuYW1lIG9mIHRoZSBwYXlsb2Fkcy4KKyAgIENhbGxlciAqTVVTVCogYWxsb2Nh
dGUgZW5vdWdoIHNwYWNlIHRvIGJlIGFibGUgdG8gc3RvcmUgYWxsIHJlY2VpdmVkIGRhdGEKKyAg
IChpLmUuIHRvdGFsIGFsbG9jYXRlZCBzcGFjZSAqTVVTVCogbWF0Y2ggdGhlIGBuYW1lX3RvdGFs
X3NpemVgIHZhbHVlCisgICBwcm92aWRlZCBieSB0aGUgaHlwZXJ2aXNvcikuIEluZGl2aWR1YWwg
cGF5bG9hZCBuYW1lIGNhbm5vdCBiZSBsb25nZXIgdGhhbgorICAgKipYRU5fTElWRVBBVENIX05B
TUVfU0laRSoqIGJ5dGVzLiBOb3RlIHRoYXQgKipYRU5fTElWRVBBVENIX05BTUVfU0laRSoqCisg
ICBpbmNsdWRlcyB0aGUgTlVMIHRlcm1pbmF0b3IuCiAgKiBgbGVuYCAtIFZpcnR1YWwgYWRkcmVz
cyBvZiB3aGVyZSB0byB3cml0ZSB0aGUgbGVuZ3RoIG9mIGVhY2ggdW5pcXVlIG5hbWUKICAgIG9m
IHRoZSBwYXlsb2FkLiBDYWxsZXIgKk1VU1QqIGFsbG9jYXRlIHVwIHRvIGBucmAgb2YgdGhlbS4g
RWFjaCAqTVVTVCogYmUKICAgIG9mIHNpemVvZih1aW50MzJfdCkgKDQgYnl0ZXMpLgpAQCAtNzM2
LDcgKzczOSw4IEBAIElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBhbiBwb3NpdGl2ZSBudW1iZXIs
IGl0IGlzIHRoZSBudW1iZXIgKHVwdG8gYG5yYAogcHJvdmlkZWQgdG8gdGhlIGh5cGVyY2FsbCkg
b2YgdGhlIHBheWxvYWRzIHJldHVybmVkLCBhbG9uZyB3aXRoIGBucmAgdXBkYXRlZAogd2l0aCB0
aGUgbnVtYmVyIG9mIHJlbWFpbmluZyBwYXlsb2FkcywgYHZlcnNpb25gIHVwZGF0ZWQgKGl0IG1h
eSBiZSB0aGUgc2FtZQogYWNyb3NzIGh5cGVyY2FsbHMgLSBpZiBpdCB2YXJpZXMgdGhlIGRhdGEg
aXMgc3RhbGUgYW5kIGZ1cnRoZXIgY2FsbHMgY291bGQKLWZhaWwpLiBUaGUgYHN0YXR1c2AsIGBu
YW1lYCwgYW5kIGBsZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGluZGV4CitmYWls
KSBhbmQgdGhlIGBuYW1lX3RvdGFsX3NpemVgIGNvbnRhaW5pbmcgdG90YWwgc2l6ZSBvZiB0cmFu
c2ZlcmVkIGRhdGEgZm9yCit0aGUgYXJyYXkuIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBhbmQgYGxl
bmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgKIHZhbHVlIChgaWR4YCkgd2l0
aCB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4KIAogSWYgdGhlIGh5cGVyY2FsbCByZXR1cm5z
IC1YRU5fRTJCSUcgdGhlIGBucmAgaXMgdG9vIGJpZyBhbmQgc2hvdWxkIGJlCkBAIC03NzUsMTEg
Kzc3OSwxMyBAQCBUaGUgc3RydWN0dXJlIGlzIGFzIGZvbGxvdzoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudCBvZiBwYXlsb2FkcyBhbmQg
dmVyc2lvbi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIE9VVDogSG93IG1hbnkgcGF5bG9hZHMgbGVmdC4gKi8KICAgICAgICAgdWludDMyX3QgcGFk
OyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIElOOiBNdXN0IGJlIHplcm8uICovCisgICAg
ICAgIHVpbnQ2NF90IG5hbWVfdG90YWxfc2l6ZTsgICAgICAgICAgICAgICAvKiBPVVQ6IFRvdGFs
IHNpemUgb2YgYWxsIHRyYW5zZmVyIG5hbWVzICovCiAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVf
NjQoeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBNdXN0IGhhdmUgZW5v
dWdoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
cGFjZSBhbGxvY2F0ZSBmb3IgbnIgb2YgdGhlbS4gKi8KLSAgICAgICAgWEVOX0dVRVNUX0hBTkRM
RV82NChjaGFyKSBpZDsgICAgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVt
YmVyCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBN
VVNUIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFIGluIHNpemUuCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8K
KyAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBuYW1lOyAgICAgICAgIC8qIE9VVDog
QXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVtYmVyCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBtYXkgaGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoIHVwIHRv
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5f
TElWRVBBVENIX05BTUVfU0laRSBieXRlcy4gTXVzdCBoYXZlCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuciBvZiB0aGVtLiAqLwogICAgICAgICBY
RU5fR1VFU1RfSEFORExFXzY0KHVpbnQzMikgbGVuOyAgICAgICAgLyogT1VUOiBBcnJheSBvZiBs
ZW5ndGhzIG9mIG5hbWUncy4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLwogICAgIH07CmRpZmYgLS1naXQg
YS90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaCBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVu
Y3RybC5oCmluZGV4IDJmYzYyNDIyZjUuLjI1MjY3NWYxMTcgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xp
YnhjL2luY2x1ZGUveGVuY3RybC5oCisrKyBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5o
CkBAIC0yNTUxLDcgKzI1NTEsMjUgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNl
ICp4Y2gsCiAgICAgICAgICAgICAgICAgICAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICpzdGF0
dXMpOwogCiAvKgotICogVGhlIGhlYXJ0IG9mIHRoaXMgZnVuY3Rpb24gaXMgdG8gZ2V0IGFuIGFy
cmF5IG9mIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QuCisgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxh
YmxlIHBheWxvYWRzIGFuZCBnZXQgYWN0dWFsIHRvdGFsIHNpemUgb2YKKyAqIHRoZSBwYXlsb2Fk
cycgbmFtZSBhcnJheS4KKyAqCisgKiBUaGlzIGZ1bmN0aW9ucyBpcyB0eXBpY2FsbHkgZXhlY3V0
ZWQgZmlyc3QgYmVmb3JlIHRoZSB4Y19saXZlcGF0Y2hfbGlzdCgpCisgKiB0byBvYnRhaW4gdGhl
IHNpemVzIGFuZCBjb3JyZWN0bHkgYWxsb2NhdGUgYWxsIG5lY2Vzc2FyeSBkYXRhIHJlc291cmNl
cy4KKyAqCisgKiBUaGUgcmV0dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVyY2FsbCBjb21w
bGV0ZWQgc3VjY2Vzc2Z1bGx5LgorICoKKyAqIElmIHRoZXJlIHdhcyBhbiBlcnJvciBwZXJmb3Jt
aW5nIHRoZSBzeXNjdGwgb3BlcmF0aW9uLCB0aGUgcmV0dXJuIHZhbHVlCisgKiB3aWxsIGNvbnRh
aW4gdGhlIGh5cGVyY2FsbCBlcnJvciBjb2RlIHZhbHVlLgorICovCitpbnQgeGNfbGl2ZXBhdGNo
X2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRfdCAqbmFtZV90b3RhbF9zaXplKTsK
KworLyoKKyAqIFRoZSBoZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIGdldCBhbiBhcnJheSBv
ZiB0aGUgZm9sbG93aW5nIG9iamVjdHM6CisgKiAgIC0geGVuX2xpdmVwYXRjaF9zdGF0dXNfdDog
c3RhdGVzIGFuZCByZXR1cm4gY29kZXMgb2YgcGF5bG9hZHMKKyAqICAgLSBuYW1lOiBuYW1lcyBv
ZiBwYXlsb2FkcworICogICAtIGxlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxvYWRz
JyBuYW1lcwogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNlIGl0IGhhcyB0byBk
ZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBzb21lIG9mIHRoZSByZXF1ZXN0
ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC0yNTYyLDIxICsyNTgwLDIwIEBAIGludCB4
Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFjZSAqeGNoLAogICogJ2xlZnQnIGFyZSBhbHNvIHVw
ZGF0ZWQgd2l0aCB0aGUgbnVtYmVyIG9mIGVudHJpZXMgZmlsbGVkIG91dAogICogYW5kIHJlc3Bl
Y3RpdmVseSB0aGUgbnVtYmVyIG9mIGVudHJpZXMgbGVmdCB0byBnZXQgZnJvbSBoeXBlcnZpc29y
LgogICoKLSAqIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9u
IHdpbGwgdGFrZSB0aGUKLSAqICdsZWZ0JyBhbmQgdXNlIHRoZSB2YWx1ZSBmb3IgJ3N0YXJ0Jy4g
VGhpcyB3YXkgd2UgaGF2ZSBhbgotICogY3Vyc29yIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHRo
ZSAnaW5mbycsJ25hbWUnLCBhbmQgJ2xlbicgd2lsbAotICogYmUgdXBkYXRlZCBhdCB0aGUgc3Vi
c2VxdWVudCBjYWxscy4KKyAqIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlz
IGZ1bmN0aW9uIHdpbGwgZmlyc3QgaXNzdWUgdGhlCisgKiB4Y19saXZlcGF0Y2hfbGlzdF9nZXRf
c2l6ZXMoKSBpbiBvcmRlciB0byBvYnRhaW4gdG90YWwgc2l6ZXMgb2YgbmFtZXMKKyAqIGFzIHdl
bGwgYXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcy4KKyAqIFRoZSB0b3Rh
bCBzaXplcyBhcmUgcmVxdWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6
ZScKKyAqIHBhcmFtZXRlci4KICAqCi0gKiBUaGUgJ21heCcgaXMgdG8gYmUgcHJvdmlkZWQgYnkg
dGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtCi0gKiBudW1iZXIgb2YgZW50cmllcyB0aGF0ICdp
bmZvJywgJ25hbWUnLCBhbmQgJ2xlbicgYXJyYXlzIGNhbgotICogYmUgZmlsbGVkIHVwIHdpdGgu
Ci0gKgotICogRWFjaCBlbnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJl
IG9mIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFCi0gKiBsZW5ndGguCisgKiBUaGUgJ21heCcgaXMg
dG8gYmUgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtIG51bWJlciBvZgor
ICogZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAnbGVuJyBhcnJheXMgY2FuIGJlIGZpbGxl
ZCB1cCB3aXRoLgogICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdpbmZvJyBhcnJheSBpcyBleHBl
Y3RlZCB0byBiZSBvZiB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190CiAgKiBzdHJ1Y3R1cmUgc2l6ZS4K
ICAqCisgKiBFYWNoIGVudHJ5IGluIHRoZSAnbmFtZScgYXJyYXkgbWF5IGhhdmUgYW4gYXJiaXRy
YXJ5IHNpemUuCisgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicgYXJyYXkgaXMgZXhwZWN0
ZWQgdG8gYmUgb2YgdWludDMyX3Qgc2l6ZS4KICAqCiAgKiBUaGUgcmV0dXJuIHZhbHVlIGlzIHpl
cm8gaWYgdGhlIGh5cGVyY2FsbCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LgpAQCAtMjU4OCwxMCAr
MjYwNSwxMiBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdp
bGwgY29udGFpbiB0aGUgbnVtYmVyIG9mIGVudHJpZXMgdGhhdCBoYWQgYmVlbiBzdWNjZXNmdWxs
eQogICogcmV0cmlldmVkIChpZiBhbnkpLgogICovCi1pbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKLSAg
ICAgICAgICAgICAgICAgICAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICppbmZvLCBjaGFyICpu
YW1lLAotICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpsZW4sIHVuc2lnbmVkIGludCAq
ZG9uZSwKLSAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmxlZnQpOworaW50IHhj
X2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4
LAorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBzdGFydCwKKyAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmluZm8sCisgICAg
ICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3QgKmxlbiwKKyAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCB1aW50NjRfdCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50ICpkb25lLCB1bnNpZ25lZCBpbnQgKmxlZnQpOwogCiAvKgog
ICogVGhlIG9wZXJhdGlvbnMgYXJlIGFzeW5jaHJvbm91cyBhbmQgdGhlIGh5cGVydmlzb3IgbWF5
IHRha2UgYSB3aGlsZQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfbWlzYy5jIGIvdG9vbHMv
bGlieGMveGNfbWlzYy5jCmluZGV4IGE4ZTllN2QxZTIuLmQ3ODdmM2YyOWYgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL2xpYnhjL3hjX21pc2MuYworKysgYi90b29scy9saWJ4Yy94Y19taXNjLmMKQEAgLTY2
Miw3ICs2NjIsNDggQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiB9
CiAKIC8qCi0gKiBUaGUgaGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBnZXQgYW4gYXJyYXkg
b2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdC4KKyAqIEdldCBhIG51bWJlciBvZiBhdmFpbGFibGUg
cGF5bG9hZHMgYW5kIGdldCBhY3R1YWwgdG90YWwgc2l6ZSBvZgorICogdGhlIHBheWxvYWRzJyBu
YW1lIGFycmF5LgorICoKKyAqIFRoaXMgZnVuY3Rpb25zIGlzIHR5cGljYWxseSBleGVjdXRlZCBm
aXJzdCBiZWZvcmUgdGhlIHhjX2xpdmVwYXRjaF9saXN0KCkKKyAqIHRvIG9idGFpbiB0aGUgc2l6
ZXMgYW5kIGNvcnJlY3RseSBhbGxvY2F0ZSBhbGwgbmVjZXNzYXJ5IGRhdGEgcmVzb3VyY2VzLgor
ICoKKyAqIFRoZSByZXR1cm4gdmFsdWUgaXMgemVybyBpZiB0aGUgaHlwZXJjYWxsIGNvbXBsZXRl
ZCBzdWNjZXNzZnVsbHkuCisgKgorICogSWYgdGhlcmUgd2FzIGFuIGVycm9yIHBlcmZvcm1pbmcg
dGhlIHN5c2N0bCBvcGVyYXRpb24sIHRoZSByZXR1cm4gdmFsdWUKKyAqIHdpbGwgY29udGFpbiB0
aGUgaHlwZXJjYWxsIGVycm9yIGNvZGUgdmFsdWUuCisgKi8KK2ludCB4Y19saXZlcGF0Y2hfbGlz
dF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90ICpuYW1lX3RvdGFsX3NpemUpCit7Cisg
ICAgREVDTEFSRV9TWVNDVEw7CisgICAgaW50IHJjOworCisgICAgaWYgKCAhbnIgfHwgIW5hbWVf
dG90YWxfc2l6ZSApCisgICAgeworICAgICAgICBlcnJubyA9IEVJTlZBTDsKKyAgICAgICAgcmV0
dXJuIC0xOworICAgIH0KKworICAgIG1lbXNldCgmc3lzY3RsLCAwLCBzaXplb2Yoc3lzY3RsKSk7
CisgICAgc3lzY3RsLmNtZCA9IFhFTl9TWVNDVExfbGl2ZXBhdGNoX29wOworICAgIHN5c2N0bC51
LmxpdmVwYXRjaC5jbWQgPSBYRU5fU1lTQ1RMX0xJVkVQQVRDSF9MSVNUOworCisgICAgcmMgPSBk
b19zeXNjdGwoeGNoLCAmc3lzY3RsKTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgcmV0dXJuIHJj
OworCisgICAgKm5yID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5ucjsKKyAgICAqbmFtZV90
b3RhbF9zaXplID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uYW1lX3RvdGFsX3NpemU7CisK
KyAgICByZXR1cm4gMDsKK30KKworLyoKKyAqIFRoZSBoZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlz
IHRvIGdldCBhbiBhcnJheSBvZiB0aGUgZm9sbG93aW5nIG9iamVjdHM6CisgKiAgIC0geGVuX2xp
dmVwYXRjaF9zdGF0dXNfdDogc3RhdGVzIGFuZCByZXR1cm4gY29kZXMgb2YgcGF5bG9hZHMKKyAq
ICAgLSBuYW1lOiBuYW1lcyBvZiBwYXlsb2FkcworICogICAtIGxlbjogbGVuZ3RocyBvZiBjb3Jy
ZXNwb25kaW5nIHBheWxvYWRzJyBuYW1lcwogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBi
ZWNhdXNlIGl0IGhhcyB0byBkZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBz
b21lIG9mIHRoZSByZXF1ZXN0ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC02NzMsMjEg
KzcxNCwyMCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqICds
ZWZ0JyBhcmUgYWxzbyB1cGRhdGVkIHdpdGggdGhlIG51bWJlciBvZiBlbnRyaWVzIGZpbGxlZCBv
dXQKICAqIGFuZCByZXNwZWN0aXZlbHkgdGhlIG51bWJlciBvZiBlbnRyaWVzIGxlZnQgdG8gZ2V0
IGZyb20gaHlwZXJ2aXNvci4KICAqCi0gKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIg
b2YgdGhpcyBmdW5jdGlvbiB3aWxsIHRha2UgdGhlCi0gKiAnbGVmdCcgYW5kIHVzZSB0aGUgdmFs
dWUgZm9yICdzdGFydCcuIFRoaXMgd2F5IHdlIGhhdmUgYW4KLSAqIGN1cnNvciBpbiB0aGUgYXJy
YXkuIE5vdGUgdGhhdCB0aGUgJ2luZm8nLCduYW1lJywgYW5kICdsZW4nIHdpbGwKLSAqIGJlIHVw
ZGF0ZWQgYXQgdGhlIHN1YnNlcXVlbnQgY2FsbHMuCisgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRo
ZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlvbiB3aWxsIGZpcnN0IGlzc3VlIHRoZQorICogeGNfbGl2
ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKCkgaW4gb3JkZXIgdG8gb2J0YWluIHRvdGFsIHNpemVzIG9m
IG5hbWVzCisgKiBhcyB3ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJp
ZXMuCisgKiBUaGUgdG90YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhl
ICduYW1lX3RvdGFsX3NpemUnCisgKiBwYXJhbWV0ZXIuCiAgKgotICogVGhlICdtYXgnIGlzIHRv
IGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4aW11bQotICogbnVtYmVyIG9m
IGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgYW5kICdsZW4nIGFycmF5cyBjYW4KLSAqIGJl
IGZpbGxlZCB1cCB3aXRoLgotICoKLSAqIEVhY2ggZW50cnkgaW4gdGhlICduYW1lJyBhcnJheSBp
cyBleHBlY3RlZCB0byBiZSBvZiBYRU5fTElWRVBBVENIX05BTUVfU0laRQotICogbGVuZ3RoLgor
ICogVGhlICdtYXgnIGlzIHRvIGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4
aW11bSBudW1iZXIgb2YKKyAqIGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgJ2xlbicgYXJy
YXlzIGNhbiBiZSBmaWxsZWQgdXAgd2l0aC4KICAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnaW5m
bycgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdAogICog
c3RydWN0dXJlIHNpemUuCiAgKgorICogRWFjaCBlbnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IG1h
eSBoYXZlIGFuIGFyYml0cmFyeSBzaXplLgorICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdsZW4n
IGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCiAgKgogICogVGhlIHJl
dHVybiB2YWx1ZSBpcyB6ZXJvIGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nlc3NmdWxs
eS4KQEAgLTY5OSwxMSArNzM5LDEyIEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFj
ZSAqeGNoLAogICogd2lsbCBjb250YWluIHRoZSBudW1iZXIgb2YgZW50cmllcyB0aGF0IGhhZCBi
ZWVuIHN1Y2Nlc2Z1bGx5CiAgKiByZXRyaWV2ZWQgKGlmIGFueSkuCiAgKi8KLWludCB4Y19saXZl
cGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50IG1heCwgdW5zaWduZWQg
aW50IHN0YXJ0LAoraW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25z
dCB1bnNpZ25lZCBpbnQgbWF4LAorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuc2lnbmVk
IGludCBzdGFydCwKICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9z
dGF0dXMgKmluZm8sCiAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3Qg
KmxlbiwKLSAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmRvbmUsCi0gICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpsZWZ0KQorICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IHVpbnQ2NF90IG5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgKmRvbmUsIHVuc2lnbmVkIGludCAqbGVmdCkKIHsKICAgICBpbnQgcmM7CiAg
ICAgREVDTEFSRV9TWVNDVEw7CkBAIC03MTQsMjcgKzc1NSwzMyBAQCBpbnQgeGNfbGl2ZXBhdGNo
X2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBz
dGFydCwKICAgICB1aW50MzJfdCBtYXhfYmF0Y2hfc3osIG5yOwogICAgIHVpbnQzMl90IHZlcnNp
b24gPSAwLCByZXRyaWVzID0gMDsKICAgICB1aW50MzJfdCBhZGp1c3QgPSAwOwotICAgIHNzaXpl
X3Qgc3o7CisgICAgb2ZmX3QgbmFtZV9vZmYgPSAwOworICAgIHVpbnQ2NF90IG5hbWVfc3o7CiAK
LSAgICBpZiAoICFtYXggfHwgIWluZm8gfHwgIW5hbWUgfHwgIWxlbiApCisgICAgaWYgKCAhbWF4
IHx8ICFpbmZvIHx8ICFuYW1lIHx8ICFsZW4gfHwgIWRvbmUgfHwgIWxlZnQgKQogICAgIHsKICAg
ICAgICAgZXJybm8gPSBFSU5WQUw7CiAgICAgICAgIHJldHVybiAtMTsKICAgICB9CiAKKyAgICBp
ZiAoIG5hbWVfdG90YWxfc2l6ZSA9PSAwICkKKyAgICB7CisgICAgICAgIGVycm5vID0gRU5PRU5U
OworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgbWVtc2V0KCZzeXNjdGwsIDAsIHNp
emVvZihzeXNjdGwpKTsKICAgICBzeXNjdGwuY21kID0gWEVOX1NZU0NUTF9saXZlcGF0Y2hfb3A7
CiAgICAgc3lzY3RsLnUubGl2ZXBhdGNoLmNtZCA9IFhFTl9TWVNDVExfTElWRVBBVENIX0xJU1Q7
Ci0gICAgc3lzY3RsLnUubGl2ZXBhdGNoLnBhZCA9IDA7Ci0gICAgc3lzY3RsLnUubGl2ZXBhdGNo
LnUubGlzdC52ZXJzaW9uID0gMDsKICAgICBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0LmlkeCA9
IHN0YXJ0OwotICAgIHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QucGFkID0gMDsKIAogICAgIG1h
eF9iYXRjaF9zeiA9IG1heDsKLSAgICAvKiBDb252aWVuY2UgdmFsdWUuICovCi0gICAgc3ogPSBz
aXplb2YoKm5hbWUpICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkU7CisgICAgbmFtZV9zeiA9IG5h
bWVfdG90YWxfc2l6ZTsKICAgICAqZG9uZSA9IDA7CiAgICAgKmxlZnQgPSAwOwogICAgIGRvIHsK
KyAgICAgICAgdWludDY0X3QgX25hbWVfc3o7CisKICAgICAgICAgLyoKICAgICAgICAgICogVGhl
IGZpcnN0IHRpbWUgd2UgZ28gaW4gdGhpcyBsb29wIG91ciAnbWF4JyBtYXkgYmUgYmlnZ2VyCiAg
ICAgICAgICAqIHRoYW4gd2hhdCB0aGUgaHlwZXJ2aXNvciBpcyBjb21mb3J0YWJsZSB3aXRoIC0g
aGVuY2UgdGhlIGZpcnN0CkBAIC03NTQsMTEgKzgwMSwxMSBAQCBpbnQgeGNfbGl2ZXBhdGNoX2xp
c3QoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFy
dCwKICAgICAgICAgc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uciA9IG5yOwogICAgICAgICAv
KiBGaXggdGhlIHNpemUgKG1heSB2YXJ5IGJldHdlZW4gaHlwZXJjYWxscykuICovCiAgICAgICAg
IEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUoaW5mbywgbnIgKiBzaXplb2YoKmluZm8pKTsKLSAg
ICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBuciAqIG5yKTsKKyAgICAgICAg
SFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBuYW1lX3N6KTsKICAgICAgICAgSFlQRVJD
QUxMX0JPVU5DRV9TRVRfU0laRShsZW4sIG5yICogc2l6ZW9mKCpsZW4pKTsKICAgICAgICAgLyog
TW92ZSB0aGUgcG9pbnRlciB0byBwcm9wZXIgb2Zmc2V0IGludG8gJ2luZm8nLiAqLwogICAgICAg
ICAoSFlQRVJDQUxMX0JVRkZFUihpbmZvKSktPnVidWYgPSBpbmZvICsgKmRvbmU7Ci0gICAgICAg
IChIWVBFUkNBTExfQlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyAoc3ogKiAqZG9uZSk7Cisg
ICAgICAgIChIWVBFUkNBTExfQlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyBuYW1lX29mZjsK
ICAgICAgICAgKEhZUEVSQ0FMTF9CVUZGRVIobGVuKSktPnVidWYgPSBsZW4gKyAqZG9uZTsKICAg
ICAgICAgLyogQWxsb2NhdGUgbWVtb3J5LiAqLwogICAgICAgICByYyA9IHhjX2h5cGVyY2FsbF9i
b3VuY2VfcHJlKHhjaCwgaW5mbyk7CkBAIC04MjcsMTQgKzg3NCwxOSBAQCBpbnQgeGNfbGl2ZXBh
dGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGlu
dCBzdGFydCwKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAgICAgICAgICpsZWZ0ID0g
c3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5ucjsgLyogVG90YWwgcmVtYWluaW5nIGNvdW50LiAq
LworICAgICAgICBfbmFtZV9zeiA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90b3Rh
bF9zaXplOyAvKiBUb3RhbCByZWNlaXZlZCBuYW1lIHNpemUuICovCiAgICAgICAgIC8qIENvcHkg
b25seSB1cCAncmMnIG9mIGRhdGEnIC0gd2UgY291bGQgYWRkICdtaW4ocmMsbnIpIGlmIGRlc2ly
ZWQuICovCiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUoaW5mbywgKHJjICogc2l6
ZW9mKCppbmZvKSkpOwotICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG5hbWUsIChy
YyAqIHN6KSk7CisgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobmFtZSwgX25hbWVf
c3opOwogICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGxlbiwgKHJjICogc2l6ZW9m
KCpsZW4pKSk7CiAgICAgICAgIC8qIEJvdW5jZSB0aGUgZGF0YSBhbmQgZnJlZSB0aGUgYm91bmNl
IGJ1ZmZlci4gKi8KICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgaW5mbyk7
CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAgICB4
Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBsZW4pOworCisgICAgICAgIG5hbWVfc3ogLT0g
X25hbWVfc3o7CisgICAgICAgIG5hbWVfb2ZmICs9IF9uYW1lX3N6OworCiAgICAgICAgIC8qIEFu
ZCB1cGRhdGUgaG93IG1hbnkgZWxlbWVudHMgb2YgaW5mbyB3ZSBoYXZlIGNvcGllZCBpbnRvLiAq
LwogICAgICAgICAqZG9uZSArPSByYzsKICAgICAgICAgLyogVXBkYXRlIGlkeC4gKi8KZGlmZiAt
LWdpdCBhL3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBh
dGNoLmMKaW5kZXggYTM3YjI0NTdmZi4uOGFjM2Q1NjdmYyAxMDA2NDQKLS0tIGEvdG9vbHMvbWlz
Yy94ZW4tbGl2ZXBhdGNoLmMKKysrIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKQEAgLTY0
LDE0ICs2NCwxNCBAQCBzdGF0aWMgY29uc3QgY2hhciAqc3RhdGUyc3RyKHVuc2lnbmVkIGludCBz
dGF0ZSkKICAgICByZXR1cm4gbmFtZXNbc3RhdGVdOwogfQogCi0vKiBUaGlzIHZhbHVlIHdhcyBj
aG9vc2VuIGFkaG9jLiBJdCBjb3VsZCBiZSA0MiB0b28uICovCi0jZGVmaW5lIE1BWF9MRU4gMTEK
IHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiB7Ci0gICAgdW5z
aWduZWQgaW50IGlkeCwgZG9uZSwgbGVmdCwgaTsKKyAgICB1bnNpZ25lZCBpbnQgbnIsIGRvbmUs
IGxlZnQsIGk7CiAgICAgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCAqaW5mbyA9IE5VTEw7CiAgICAg
Y2hhciAqbmFtZSA9IE5VTEw7CiAgICAgdWludDMyX3QgKmxlbiA9IE5VTEw7CisgICAgdWludDY0
X3QgbmFtZV90b3RhbF9zaXplOworICAgIG9mZl90IG5hbWVfb2ZmOwogICAgIGludCByYyA9IEVO
T01FTTsKIAogICAgIGlmICggYXJnYyApCkBAIC03OSw2NSArNzksNzMgQEAgc3RhdGljIGludCBs
aXN0X2Z1bmMoaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKICAgICAgICAgc2hvd19oZWxwKCk7CiAg
ICAgICAgIHJldHVybiAtMTsKICAgICB9Ci0gICAgaWR4ID0gbGVmdCA9IDA7Ci0gICAgaW5mbyA9
IG1hbGxvYyhzaXplb2YoKmluZm8pICogTUFYX0xFTik7Ci0gICAgaWYgKCAhaW5mbyApCi0gICAg
ICAgIHJldHVybiByYzsKLSAgICBuYW1lID0gbWFsbG9jKHNpemVvZigqbmFtZSkgKiBYRU5fTElW
RVBBVENIX05BTUVfU0laRSAqIE1BWF9MRU4pOwotICAgIGlmICggIW5hbWUgKQorICAgIGRvbmUg
PSBsZWZ0ID0gMDsKKworICAgIHJjID0geGNfbGl2ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKHhjaCwg
Jm5yLCAmbmFtZV90b3RhbF9zaXplKTsKKyAgICBpZiAoIHJjICkKICAgICB7Ci0gICAgICAgIGZy
ZWUoaW5mbyk7CisgICAgICAgIHJjID0gZXJybm87CisgICAgICAgIGZwcmludGYoc3RkZXJyLCAi
RmFpbGVkIHRvIGdldCBsaXN0IHNpemVzLlxuIgorICAgICAgICAgICAgICAgICJFcnJvciAlZDog
JXNcbiIsCisgICAgICAgICAgICAgICAgcmMsIHN0cmVycm9yKHJjKSk7CiAgICAgICAgIHJldHVy
biByYzsKICAgICB9Ci0gICAgbGVuID0gbWFsbG9jKHNpemVvZigqbGVuKSAqIE1BWF9MRU4pOwot
ICAgIGlmICggIWxlbiApIHsKLSAgICAgICAgZnJlZShuYW1lKTsKLSAgICAgICAgZnJlZShpbmZv
KTsKKworICAgIGlmICggbnIgPT0gMCApCisgICAgeworICAgICAgICBmcHJpbnRmKHN0ZG91dCwg
Ik5vdGhpbmcgdG8gbGlzdFxuIik7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKworICAgIGlu
Zm8gPSBtYWxsb2MobnIgKiBzaXplb2YoKmluZm8pKTsKKyAgICBpZiAoICFpbmZvICkKICAgICAg
ICAgcmV0dXJuIHJjOworCisgICAgbmFtZSA9IG1hbGxvYyhuYW1lX3RvdGFsX3NpemUgKiBzaXpl
b2YoKm5hbWUpKTsKKyAgICBpZiAoICFuYW1lICkKKyAgICAgICAgZ290byBlcnJvcl9uYW1lOwor
CisgICAgbGVuID0gbWFsbG9jKG5yICogc2l6ZW9mKCpsZW4pKTsKKyAgICBpZiAoICFsZW4gKQor
ICAgICAgICBnb3RvIGVycm9yX2xlbjsKKworICAgIG1lbXNldChpbmZvLCAnQScsIG5yICogc2l6
ZW9mKCppbmZvKSk7CisgICAgbWVtc2V0KG5hbWUsICdCJywgbmFtZV90b3RhbF9zaXplICogc2l6
ZW9mKCpuYW1lKSk7CisgICAgbWVtc2V0KGxlbiwgJ0MnLCBuciAqIHNpemVvZigqbGVuKSk7Cisg
ICAgbmFtZV9vZmYgPSAwOworCisgICAgcmMgPSB4Y19saXZlcGF0Y2hfbGlzdCh4Y2gsIG5yLCAw
LCBpbmZvLCBuYW1lLCBsZW4sIG5hbWVfdG90YWxfc2l6ZSwgJmRvbmUsICZsZWZ0KTsKKyAgICBp
ZiAoIHJjIHx8IGRvbmUgIT0gbnIgfHwgbGVmdCA+IDApCisgICAgeworICAgICAgICByYyA9IGVy
cm5vOworICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkZhaWxlZCB0byBsaXN0ICVkLyVkLlxuIgor
ICAgICAgICAgICAgICAgICJFcnJvciAlZDogJXNcbiIsCisgICAgICAgICAgICAgICAgbGVmdCwg
bnIsIHJjLCBzdHJlcnJvcihyYykpOworICAgICAgICBnb3RvIGVycm9yOwogICAgIH0KIAotICAg
IGRvIHsKLSAgICAgICAgZG9uZSA9IDA7Ci0gICAgICAgIC8qIFRoZSBtZW1zZXQgaXMgZG9uZSB0
byBjYXRjaCBlcnJvcnMuICovCi0gICAgICAgIG1lbXNldChpbmZvLCAnQScsIHNpemVvZigqaW5m
bykgKiBNQVhfTEVOKTsKLSAgICAgICAgbWVtc2V0KG5hbWUsICdCJywgc2l6ZW9mKCpuYW1lKSAq
IE1BWF9MRU4gKiBYRU5fTElWRVBBVENIX05BTUVfU0laRSk7Ci0gICAgICAgIG1lbXNldChsZW4s
ICdDJywgc2l6ZW9mKCpsZW4pICogTUFYX0xFTik7Ci0gICAgICAgIHJjID0geGNfbGl2ZXBhdGNo
X2xpc3QoeGNoLCBNQVhfTEVOLCBpZHgsIGluZm8sIG5hbWUsIGxlbiwgJmRvbmUsICZsZWZ0KTsK
LSAgICAgICAgaWYgKCByYyApCi0gICAgICAgIHsKLSAgICAgICAgICAgIHJjID0gZXJybm87Ci0g
ICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkZhaWxlZCB0byBsaXN0ICVkLyVkLlxuIgotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICJFcnJvciAlZDogJXNcbiIsCi0gICAgICAgICAgICAg
ICAgICAgIGlkeCwgbGVmdCwgcmMsIHN0cmVycm9yKHJjKSk7Ci0gICAgICAgICAgICBicmVhazsK
LSAgICAgICAgfQotICAgICAgICBpZiAoICFpZHggKQotICAgICAgICAgICAgZnByaW50ZihzdGRv
dXQsIiBJRCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IHN0YXR1c1xuIgot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tXG4iKTsKKyAgICBmcHJpbnRmKHN0ZG91dCwiIElEICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgc3RhdHVzXG4iCisgICAgICAgICAg
ICAgICAgICAgIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0t
LS0tLS0tXG4iKTsKIAotICAgICAgICBmb3IgKCBpID0gMDsgaSA8IGRvbmU7IGkrKyApCi0gICAg
ICAgIHsKLSAgICAgICAgICAgIHVuc2lnbmVkIGludCBqOwotICAgICAgICAgICAgdWludDMyX3Qg
c3o7Ci0gICAgICAgICAgICBjaGFyICpzdHI7Ci0KLSAgICAgICAgICAgIHN6ID0gbGVuW2ldOwot
ICAgICAgICAgICAgc3RyID0gbmFtZSArIChpICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUpOwot
ICAgICAgICAgICAgZm9yICggaiA9IHN6OyBqIDwgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkU7IGor
KyApCi0gICAgICAgICAgICAgICAgc3RyW2pdID0gJ1wwJzsKLQotICAgICAgICAgICAgcHJpbnRm
KCIlLTQwc3wgJXMiLCBzdHIsIHN0YXRlMnN0cihpbmZvW2ldLnN0YXRlKSk7Ci0gICAgICAgICAg
ICBpZiAoIGluZm9baV0ucmMgKQotICAgICAgICAgICAgICAgIHByaW50ZigiICglZCwgJXMpXG4i
LCAtaW5mb1tpXS5yYywgc3RyZXJyb3IoLWluZm9baV0ucmMpKTsKLSAgICAgICAgICAgIGVsc2UK
LSAgICAgICAgICAgICAgICBwdXRzKCIiKTsKLSAgICAgICAgfQotICAgICAgICBpZHggKz0gZG9u
ZTsKLSAgICB9IHdoaWxlICggbGVmdCApOworICAgIGZvciAoIGkgPSAwOyBpIDwgZG9uZTsgaSsr
ICkKKyAgICB7CisgICAgICAgIGNoYXIgKm5hbWVfc3RyID0gbmFtZSArIG5hbWVfb2ZmOworCisg
ICAgICAgIHByaW50ZigiJS00MC4qc3wgJXMiLCBsZW5baV0sIG5hbWVfc3RyLCBzdGF0ZTJzdHIo
aW5mb1tpXS5zdGF0ZSkpOworICAgICAgICBpZiAoIGluZm9baV0ucmMgKQorICAgICAgICAgICAg
cHJpbnRmKCIgKCVkLCAlcylcbiIsIC1pbmZvW2ldLnJjLCBzdHJlcnJvcigtaW5mb1tpXS5yYykp
OworICAgICAgICBlbHNlCisgICAgICAgICAgICBwdXRzKCIiKTsKKworICAgICAgICBuYW1lX29m
ZiArPSBsZW5baV07CisgICAgfQogCitlcnJvcjoKKyAgICBmcmVlKGxlbik7CitlcnJvcl9sZW46
CiAgICAgZnJlZShuYW1lKTsKK2Vycm9yX25hbWU6CiAgICAgZnJlZShpbmZvKTsKLSAgICBmcmVl
KGxlbik7CiAgICAgcmV0dXJuIHJjOwogfQogI3VuZGVmIE1BWF9MRU4KZGlmZiAtLWdpdCBhL3hl
bi9jb21tb24vbGl2ZXBhdGNoLmMgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCmluZGV4IDE4OTM1
ZjYwOGMuLmU4MDAzODI0NzkgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKKysr
IGIveGVuL2NvbW1vbi9saXZlcGF0Y2guYwpAQCAtMTE2NCw3ICsxMTY0LDYgQEAgc3RhdGljIGlu
dCBsaXZlcGF0Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlzdCkK
IAogICAgIGlmICggbGlzdC0+bnIgJiYKICAgICAgICAgICghZ3Vlc3RfaGFuZGxlX29rYXkobGlz
dC0+c3RhdHVzLCBsaXN0LT5ucikgfHwKLSAgICAgICAgICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlz
dC0+bmFtZSwgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUgKiBsaXN0LT5ucikgfHwKICAgICAgICAg
ICAhZ3Vlc3RfaGFuZGxlX29rYXkobGlzdC0+bGVuLCBsaXN0LT5ucikpICkKICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7CiAKQEAgLTExNzUsMjMgKzExNzQsMzUgQEAgc3RhdGljIGludCBsaXZlcGF0
Y2hfbGlzdChzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfbGlzdCAqbGlzdCkKICAgICAgICAg
cmV0dXJuIC1FSU5WQUw7CiAgICAgfQogCisgICAgbGlzdC0+bmFtZV90b3RhbF9zaXplID0gMDsK
ICAgICBpZiAoIGxpc3QtPm5yICkKICAgICB7CisgICAgICAgIHVpbnQ2NF90IG5hbWVfb2Zmc2V0
ID0gMDsKKwogICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KCBkYXRhLCAmcGF5bG9hZF9saXN0
LCBsaXN0ICkKICAgICAgICAgewotICAgICAgICAgICAgdWludDMyX3QgbGVuOworICAgICAgICAg
ICAgdWludDMyX3QgbmFtZV9sZW47CiAKICAgICAgICAgICAgIGlmICggbGlzdC0+aWR4ID4gaSsr
ICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKIAogICAgICAgICAgICAgc3RhdHVzLnN0YXRl
ID0gZGF0YS0+c3RhdGU7CiAgICAgICAgICAgICBzdGF0dXMucmMgPSBkYXRhLT5yYzsKLSAgICAg
ICAgICAgIGxlbiA9IHN0cmxlbihkYXRhLT5uYW1lKSArIDE7CisKKyAgICAgICAgICAgIG5hbWVf
bGVuID0gc3RybGVuKGRhdGEtPm5hbWUpICsgMTsKKyAgICAgICAgICAgIGxpc3QtPm5hbWVfdG90
YWxfc2l6ZSArPSBuYW1lX2xlbjsKKworICAgICAgICAgICAgaWYgKCAhZ3Vlc3RfaGFuZGxlX3N1
YnJhbmdlX29rYXkobGlzdC0+bmFtZSwgbmFtZV9vZmZzZXQsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lX29mZnNldCArIG5hbWVfbGVuIC0gMSkgKQor
ICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKKyAgICAgICAgICAg
ICAgICBicmVhazsKKyAgICAgICAgICAgIH0KIAogICAgICAgICAgICAgLyogTi5CLiAnaWR4JyAh
PSAnaScuICovCi0gICAgICAgICAgICBpZiAoIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+
bmFtZSwgaWR4ICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZGF0YS0+bmFtZSwgbGVuKSB8fAotICAgICAgICAgICAgICAg
IF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bGVuLCBpZHgsICZsZW4sIDEpIHx8CisgICAg
ICAgICAgICBpZiAoIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bmFtZSwgbmFtZV9vZmZz
ZXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS0+bmFtZSwg
bmFtZV9sZW4pIHx8CisgICAgICAgICAgICAgICAgX19jb3B5X3RvX2d1ZXN0X29mZnNldChsaXN0
LT5sZW4sIGlkeCwgJm5hbWVfbGVuLCAxKSB8fAogICAgICAgICAgICAgICAgIF9fY29weV90b19n
dWVzdF9vZmZzZXQobGlzdC0+c3RhdHVzLCBpZHgsICZzdGF0dXMsIDEpICkKICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICByYyA9IC1FRkFVTFQ7CkBAIC0xMTk5LDExICsxMjEwLDE5IEBA
IHN0YXRpYyBpbnQgbGl2ZXBhdGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xp
c3QgKmxpc3QpCiAgICAgICAgICAgICB9CiAKICAgICAgICAgICAgIGlkeCsrOworICAgICAgICAg
ICAgbmFtZV9vZmZzZXQgKz0gbmFtZV9sZW47CiAKICAgICAgICAgICAgIGlmICggKGlkeCA+PSBs
aXN0LT5ucikgfHwgaHlwZXJjYWxsX3ByZWVtcHRfY2hlY2soKSApCiAgICAgICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgIH0KICAgICB9CisgICAgZWxzZQorICAgIHsKKyAgICAgICAgbGlzdF9m
b3JfZWFjaF9lbnRyeSggZGF0YSwgJnBheWxvYWRfbGlzdCwgbGlzdCApCisgICAgICAgIHsKKyAg
ICAgICAgICAgIGxpc3QtPm5hbWVfdG90YWxfc2l6ZSArPSBzdHJsZW4oZGF0YS0+bmFtZSkgKyAx
OworICAgICAgICB9CisgICAgfQogICAgIGxpc3QtPm5yID0gcGF5bG9hZF9jbnQgLSBpOyAvKiBS
ZW1haW5pbmcgYW1vdW50LiAqLwogICAgIGxpc3QtPnZlcnNpb24gPSBwYXlsb2FkX3ZlcnNpb247
CiAgICAgc3Bpbl91bmxvY2soJnBheWxvYWRfbG9jayk7CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9wdWJsaWMvc3lzY3RsLmggYi94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmgKaW5kZXggYmNk
ZmMxZmFmZS4uNTAzYmU2ODA1OSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0
bC5oCisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaApAQCAtOTI1LDEwICs5MjUsMTEg
QEAgc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2dldCB7CiAgKgogICogSWYgdGhlIGh5cGVy
Y2FsbCByZXR1cm5zIGFuIHBvc2l0aXZlIG51bWJlciwgaXQgaXMgdGhlIG51bWJlciAodXAgdG8g
YG5yYCkKICAqIG9mIHRoZSBwYXlsb2FkcyByZXR1cm5lZCwgYWxvbmcgd2l0aCBgbnJgIHVwZGF0
ZWQgd2l0aCB0aGUgbnVtYmVyIG9mIHJlbWFpbmluZwotICogcGF5bG9hZHMsIGB2ZXJzaW9uYCB1
cGRhdGVkIChpdCBtYXkgYmUgdGhlIHNhbWUgYWNyb3NzIGh5cGVyY2FsbHMuIElmIGl0Ci0gKiB2
YXJpZXMgdGhlIGRhdGEgaXMgc3RhbGUgYW5kIGZ1cnRoZXIgY2FsbHMgY291bGQgZmFpbCkuIFRo
ZSBgc3RhdHVzYCwKLSAqIGBuYW1lYCwgYW5kIGBsZW5gJyBhcmUgdXBkYXRlZCBhdCB0aGVpciBk
ZXNpZ25lZCBpbmRleCB2YWx1ZSAoYGlkeGApIHdpdGgKLSAqIHRoZSByZXR1cm5lZCB2YWx1ZSBv
ZiBkYXRhLgorICogcGF5bG9hZHMsIGB2ZXJzaW9uYCB1cGRhdGVkIChpdCBtYXkgYmUgdGhlIHNh
bWUgYWNyb3NzIGh5cGVyY2FsbHMuIElmIGl0IHZhcmllcworICogdGhlIGRhdGEgaXMgc3RhbGUg
YW5kIGZ1cnRoZXIgY2FsbHMgY291bGQgZmFpbCkgYW5kIHRoZSBuYW1lX3RvdGFsX3NpemUKKyAq
IGNvbnRhaW5pbmcgdG90YWwgc2l6ZSBvZiB0cmFuc2ZlcmVkIGRhdGEgZm9yIHRoZSBhcnJheS4K
KyAqIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBgbGVuYCBhcmUgdXBkYXRlZCBhdCB0aGVpciBkZXNp
Z25lZCBpbmRleCB2YWx1ZSAoYGlkeGApCisgKiB3aXRoIHRoZSByZXR1cm5lZCB2YWx1ZSBvZiBk
YXRhLgogICoKICAqIElmIHRoZSBoeXBlcmNhbGwgcmV0dXJucyBFMkJJRyB0aGUgYG5yYCBpcyB0
b28gYmlnIGFuZCBzaG91bGQgYmUKICAqIGxvd2VyZWQuIFRoZSB1cHBlciBsaW1pdCBvZiBgbnJg
IGlzIGxlZnQgdG8gdGhlIGltcGxlbWVudGlvbi4KQEAgLTk1MSwxMSArOTUyLDEzIEBAIHN0cnVj
dCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYW1vdW50IG9mIHBheWxvYWRzIGFuZCB2ZXJzaW9uLgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPVVQ6IEhvdyBtYW55
IHBheWxvYWRzIGxlZnQuICovCiAgICAgdWludDMyX3QgcGFkOyAgICAgICAgICAgICAgICAgICAg
ICAgICAgIC8qIElOOiBNdXN0IGJlIHplcm8uICovCisgICAgdWludDY0X3QgbmFtZV90b3RhbF9z
aXplOyAgICAgICAgICAgICAgIC8qIE9VVDogVG90YWwgc2l6ZSBvZiBhbGwgdHJhbnNmZXIgbmFt
ZXMgKi8KICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QpIHN0
YXR1czsgIC8qIE9VVC4gTXVzdCBoYXZlIGVub3VnaAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzcGFjZSBhbGxvY2F0ZSBmb3IgbnIgb2YgdGhlbS4gKi8K
ICAgICBYRU5fR1VFU1RfSEFORExFXzY0KGNoYXIpIG5hbWU7ICAgICAgICAgLyogT1VUOiBBcnJh
eSBvZiBuYW1lcy4gRWFjaCBtZW1iZXIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgTVVTVCBYRU5fTElWRVBBVENIX05BTUVfU0laRSBpbiBzaXplLgotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIg
b2YgdGhlbS4gKi8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWF5IGhhdmUgYW4gYXJiaXRyYXJ5IGxlbmd0aCB1cCB0bworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5fTElWRVBBVENIX05BTUVfU0laRSBieXRl
cy4gTXVzdCBoYXZlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG5yIG9mIHRoZW0uICovCiAgICAgWEVOX0dVRVNUX0hBTkRMRV82NCh1aW50MzIpIGxlbjsg
ICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbGVuZ3RocyBvZiBuYW1lJ3MuCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAq
LwogfTsKLS0gCjIuMTYuNQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdt
YkgKS3JhdXNlbnN0ci4gMzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0
aWFuIFNjaGxhZWdlciwgUmFsZiBIZXJicmljaApFaW5nZXRyYWdlbiBhbSBBbXRzZ2VyaWNodCBD
aGFybG90dGVuYnVyZyB1bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVzdC1JRDogREUg
Mjg5IDIzNyA4NzkKCgoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=

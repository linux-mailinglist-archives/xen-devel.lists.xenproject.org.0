Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 32E15F9834
	for <lists+xen-devel@lfdr.de>; Tue, 12 Nov 2019 19:04:28 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iUaTq-00058Y-31; Tue, 12 Nov 2019 18:01:30 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=8rEL=ZE=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iUaTo-00058O-Uz
 for xen-devel@lists.xen.org; Tue, 12 Nov 2019 18:01:29 +0000
X-Inumbo-ID: 6ec02081-0576-11ea-a21f-12813bfff9fa
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 6ec02081-0576-11ea-a21f-12813bfff9fa;
 Tue, 12 Nov 2019 18:01:21 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iUaTW-00011p-5D; Tue, 12 Nov 2019 18:01:10 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iUaTW-0001wf-3B; Tue, 12 Nov 2019 18:01:10 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iUaTW-0001wf-3B@xenbits.xenproject.org>
Date: Tue, 12 Nov 2019 18:01:10 +0000
Subject: [Xen-devel] Xen Security Advisory 304 v1 (CVE-2018-12207) - x86:
 Machine Check Error on Page Size Change DoS
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2018-12207 / XSA-304

            x86: Machine Check Error on Page Size Change DoS

ISSUE DESCRIPTION
=================

An erratum exists across some CPUs whereby an instruction fetch may
cause a machine check error if the pagetables have been updated in a
specific manner without invalidating the TLB.

The x86 architecture explicitly permits modification of the pagetables
without TLB invalidation, but in this corner case, the impacted core
ceases operating and an unexpected machine check or system reset occurs.

This corner case can be triggered by guest kernels.

For more details, see:
  https://software.intel.com/security-software-guidance/insights/deep-dive-machine-check-error-avoidance-page-size-change

IMPACT
======

A malicious guest kernel can crash the host, resulting in a Denial of
Service (DoS).  (This CPU bug may also be triggered accidentally.)

VULNERABLE SYSTEMS
==================

Systems running all versions of Xen are affected.

Only x86 processors are vulnerable.  ARM processors are not believed to
be vulnerable.

Only Intel Core based processors (from Nehalem onwards) are affected.
Other processors designs (Intel Atom/Knights range), and other
manufacturers (AMD) are not known to be affected.

Only x86 HVM/PVH guests can exploit the vulnerability.  x86 PV guests
cannot exploit the vulnerability.

Please consult the Intel Security Advisory for details on the affected
processors.

MITIGATION
==========

Running only PV guests avoids the vulnerability.

Booting Xen with `hap_2mb=0 hap_1gb=0` on the command line, to disable
the use of HAP superpages, works around the vulnerability.

Booting Xen with `hap=0` to disable HAP entirely, or configuring HVM/PVH
guests to use shadow paging (hap=0 in xl.cfg) works around the
vulnerability, but the performance impact of shadow paging in
combination with in-guest Meltdown mitigations (KPTI, KVAS, etc) will
most likely make this option prohibitive to use.

RESOLUTION
==========

Applying the appropriate attached patches resolves this issue.

By default, Xen will disable executable superpages on
believed-vulnerable hardware, and report so at boot:

  (XEN) VMX: Disabling executable EPT superpages due to CVE-2018-12207

See the performance and safety consideration section below.

xsa304/xsa304-*.patch           xen-unstable
xsa304/xsa304-4.12-*.patch      Xen 4.12.x
xsa304/xsa304-4.11-*.patch      Xen 4.11.x
xsa304/xsa304-4.10-*.patch      Xen 4.10.x
xsa304/xsa304-4.9-*.patch       Xen 4.9.x
xsa304/xsa304-4.8-*.patch       Xen 4.8.x

The patches are comprised of:
 *-1.patch: Fix on SandyBridge hardware discovered during testing
 *-2.patch: Main security fix
 *-3.patch: (4.10 and later) Runtime control of fast vs secure

$ sha256sum xsa304*/*
3365e0351b3ccb39e3be53bcbfd8219d8282f6f3d97d6c4519a3e860b27f6844  xsa304/xsa304-1.patch
1a85753717312f2b20f291c9e79271c63be2a9542fbec651d0a8fc4d8aca0408  xsa304/xsa304-2.patch
0c770aa15f2aef2bb3253194243968181a4bb1710d09d6f785ed7f5dae03b93b  xsa304/xsa304-3.patch
2d2eb25b842578bd45480c8ff6f2266617dd0db5e6e552d5ae481eb764c8aea0  xsa304/xsa304-4.8-1.patch
72d91f67af06f89d01f7dc1e6ff87f50cad28bbb0475eb5cfbb986ee51775bc2  xsa304/xsa304-4.8-2.patch
d8d18e7dd9b59f01454352a46d38699b21c5f1f7ff6bd2aa8e63fbd7a98cfca4  xsa304/xsa304-4.9-1.patch
244df964d70eab300c77210456439dfb1c46f2ddd9f1b851e1110be7573948ba  xsa304/xsa304-4.9-2.patch
2d80f2603412abb4e644b8e868f4218e90db3f59b25f833ff7342d347af6c5a8  xsa304/xsa304-4.10-1.patch
94a87371ddeccf5705ed71a961135393fa9046e4235cc90402f9292dcfffa43c  xsa304/xsa304-4.10-2.patch
9862e46c2bcbbeaba32d06d7af33b8b97fd8be5a4a35bcd70264e9913031f512  xsa304/xsa304-4.10-3.patch
b927c5b7a5dbf6260fd37ec2a594d5a0ff40b2fa78c9caaaaa59fa184c87d8d1  xsa304/xsa304-4.11-1.patch
478d7b7b27bb0a4ed874a4d6fe73282d785feed8c35f3278a07a1228d5dfad77  xsa304/xsa304-4.11-2.patch
d0e079a0af7045711a21ac52674e5821e69c370f7ef64c9ebdfc0990950f7a54  xsa304/xsa304-4.11-3.patch
4025732fd83a94c09b023f079e9b3c8399649f31e406f5f0c736a522f75fdd53  xsa304/xsa304-4.12-1.patch
2653c57fc79b98ca5cc30ceb2299d11c2ba96f4becdfb93a1cc14ca943e18420  xsa304/xsa304-4.12-2.patch
ec670ca4e3782043824e1f475ba187d89a53836d4e2ad8399daf0a91fcc747dc  xsa304/xsa304-4.12-3.patch
$

PERFORMANCE AND SAFETY CONSIDERATIONS
=====================================

Disabling executable EPT superpages does come with a performance impact,
caused by increased iTLB pressure.  The overhead will be workload and
CPU dependant.

In configurations where guest kernels are trusted not to mount a DoS
attempt, the mitigation can be turned off by booting with `ept=exec-sp`.

In configurations where the guest kernels are not trusted, users are
recommended to measure the impact to their workloads as part of deciding
between fast and secure.

On Xen 4.10 and later, a runtime decision can be made between fast and
secure by using `xl set-parameters ept=[no-]exec-sp`.

NOTE REGARDING LACK OF EMBARGO
==============================

Despite an attempt to organise predisclosure, the discoverers ultimately
did not authorise a predisclosure.
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl3K8agMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZd3sH/jRb9M9+OyI6dsFkqCwgnbL3poPgVwC6umC0he6k
nomcLvY5Tc1ClhvyXTLDOzdo20zMQo6mtLs5RFGC78CjWKM7P3aSFGay+yRHXt4q
QzoTgTPaSR+MtkahgmS+GEY5IuYSXFWZLRNmx8YXmG2GVDFU9CkfbCCo9hGknY4r
t5cMS+I7cjAuGhvf9uBxFcSr6FiARcqzk7B7qSEPOJbfEAq1XXYh4Q81Zx2iHClW
xzyGsWk5UeP+NjRFGpJZpsz9a8yx/zaYWFsjxzG3xYutjkypSoRmNCG2sMPq54Nk
yuEYHV6/r4ymgexIe+INdHfmkJRpoYadmLdV0vRfXp0vlO8=
=LdOL
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-1.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0ZDogSGlkZSBzdXBlcnBhZ2Ugc3VwcG9ydCBm
b3IgU2FuZHlCcmlkZ2UgSU9NTVVzCgpTb21ldGhpbmcgY2F1c2VzIFNhbmR5
QnJpZGdlIElPTU1VcyB0byBjaG9rZSB3aGVuIHNoYXJpbmcgRVBUIHBhZ2V0
YWJsZXMsIGFuZAphbiBFUFQgc3VwZXJwYWdlIGdldHMgc2hhdHRlcmVkLiAg
VGhlIHJvb3QgY2F1c2UgaXMgc3RpbGwgdW5kZXIgaW52ZXN0aWdhdGlvbiwK
YnV0IHRoZSBlbmQgcmVzdWx0IGlzIHVudXNhYmxlIGluIGNvbWJpbmF0aW9u
IHdpdGggQ1ZFLTIwMTgtMTIyMDcgcHJvdGVjdGlvbnMuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMwNCAvIENWRS0yMDE4LTEyMjA3CgpTaWduZWQtb2ZmLWJ5
OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRl
cm4uaCBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApp
bmRleCA2YjBiN2FmOWUyLi45OTRkMzYwZTkwIDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZXh0ZXJuLmgKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCkBAIC0xMDEsNiArMTAx
LDggQEAgdm9pZCB2dGRfb3BzX3Bvc3RhbWJsZV9xdWlyayhzdHJ1Y3QgdnRk
X2lvbW11ICppb21tdSk7CiBpbnQgX19tdXN0X2NoZWNrIG1lX3dpZmlfcXVp
cmsoc3RydWN0IGRvbWFpbiAqZG9tYWluLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHU4IGJ1cywgdTggZGV2Zm4sIGludCBtYXApOwogdm9p
ZCBwY2lfdnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICopOwordm9p
ZCBxdWlya19pb21tdV9jYXBzKHN0cnVjdCB2dGRfaW9tbXUgKmlvbW11KTsK
KwogYm9vbF90IHBsYXRmb3JtX3N1cHBvcnRzX2ludHJlbWFwKHZvaWQpOwog
Ym9vbF90IHBsYXRmb3JtX3N1cHBvcnRzX3gyYXBpYyh2b2lkKTsKIApkaWZm
IC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYwppbmRleCA2
OGU3ZjVmYjU4Li4yNWFkNjQ5YzM0IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC92dGQvaW9tbXUuYwpAQCAtMTE3MCw2ICsxMTcwLDggQEAg
aW50IF9faW5pdCBpb21tdV9hbGxvYyhzdHJ1Y3QgYWNwaV9kcmhkX3VuaXQg
KmRyaGQpCiAgICAgaWYgKCAhKGlvbW11LT5jYXAgKyAxKSB8fCAhKGlvbW11
LT5lY2FwICsgMSkgKQogICAgICAgICByZXR1cm4gLUVOT0RFVjsKIAorICAg
IHF1aXJrX2lvbW11X2NhcHMoaW9tbXUpOworCiAgICAgaWYgKCBjYXBfZmF1
bHRfcmVnX29mZnNldChpb21tdS0+Y2FwKSArCiAgICAgICAgICBjYXBfbnVt
X2ZhdWx0X3JlZ3MoaW9tbXUtPmNhcCkgKiBQUklNQVJZX0ZBVUxUX1JFR19M
RU4gPj0gUEFHRV9TSVpFIHx8CiAgICAgICAgICBlY2FwX2lvdGxiX29mZnNl
dChpb21tdS0+ZWNhcCkgPj0gUEFHRV9TSVpFICkKZGlmZiAtLWdpdCBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xdWlya3MuYyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xdWlya3MuYwppbmRleCBlN2UzMjZmZThj
Li40ZGFkZDk1MjNmIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC92dGQvcXVpcmtzLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvdnRkL3F1aXJrcy5jCkBAIC01MzYsMyArNTM2LDI4IEBAIHZvaWQgcGNp
X3Z0ZF9xdWlyayhjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAg
ICAgYnJlYWs7CiAgICAgfQogfQorCit2b2lkIF9faW5pdCBxdWlya19pb21t
dV9jYXBzKHN0cnVjdCB2dGRfaW9tbXUgKmlvbW11KQoreworICAgIC8qCisg
ICAgICogSU9NTVUgUXVpcmtzOgorICAgICAqCisgICAgICogU2FuZHlCcmlk
Z2UgSU9NTVVzIGNsYWltIHN1cHBvcnQgZm9yIDJNIGFuZCAxRyBzdXBlcnBh
Z2VzLCBidXQgZG9uJ3QKKyAgICAgKiBpbXBsZW1lbnQgc3VwZXJwYWdlcyBp
bnRlcm5hbGx5LgorICAgICAqCisgICAgICogVGhlcmUgYXJlIGlzc3VlcyBj
aGFuZ2luZyB0aGUgd2FsayBsZW5ndGggdW5kZXIgaW4tZmxpZ2h0IERNQSwg
d2hpY2gKKyAgICAgKiBoYXMgbWFuaWZlc3RlZCBhcyBpbmNvbXBhdGliaWxp
dHkgYmV0d2VlbiBFUFQvSU9NTVUgc2hhcmluZyBhbmQgdGhlCisgICAgICog
d29ya2Fyb3VuZCBmb3IgQ1ZFLTIwMTgtMTIyMDcgLyBYU0EtMzA0LiAgSGlk
ZSB0aGUgc3VwZXJwYWdlcworICAgICAqIGNhcGFiaWxpdGllcyBpbiB0aGUg
SU9NTVUsIHdoaWNoIHdpbGwgcHJldmVudCBYZW4gZnJvbSBzaGFyaW5nIHRo
ZSBFUFQKKyAgICAgKiBhbmQgSU9NTVUgcGFnZXRhYmxlcy4KKyAgICAgKgor
ICAgICAqIERldGVjdGlvbiBvZiBTYW5keUJyaWRnZSB1bmZvcnR1bmF0ZWx5
IGhhcyB0byBiZSBkb25lIGJ5IHByb2Nlc3NvcgorICAgICAqIG1vZGVsIGJl
Y2F1c2UgdGhlIGNsaWVudCBwYXJ0cyBkb24ndCBleHBvc2UgdGhlaXIgSU9N
TVVzIGFzIFBDSSBkZXZpY2VzCisgICAgICogd2UgY291bGQgbWF0Y2ggd2l0
aCBhIERldmljZSBJRC4KKyAgICAgKi8KKyAgICBpZiAoIGJvb3RfY3B1X2Rh
dGEueDg2X3ZlbmRvciA9PSBYODZfVkVORE9SX0lOVEVMICYmCisgICAgICAg
ICBib290X2NwdV9kYXRhLng4NiA9PSA2ICYmCisgICAgICAgICAoYm9vdF9j
cHVfZGF0YS54ODZfbW9kZWwgPT0gMHgyYSB8fAorICAgICAgICAgIGJvb3Rf
Y3B1X2RhdGEueDg2X21vZGVsID09IDB4MmQpICkKKyAgICAgICAgaW9tbXUt
PmNhcCAmPSB+KDB4ZnVsIDw8IDM0KTsKK30K

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-2.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogRGlzYWJsZSBleGVjdXRhYmxlIEVQVCBz
dXBlcnBhZ2VzIHRvIHdvcmsgYXJvdW5kCiBDVkUtMjAxOC0xMjIwNwoKQ1ZF
LTIwMTgtMTIyMDcgY292ZXJzIGEgc2V0IG9mIGVycmF0YSBvbiB2YXJpb3Vz
IEludGVsIHByb2Nlc3NvcnMsIHdoZXJlYnkgYQptYWNoaW5lIGNoZWNrIGV4
Y2VwdGlvbiBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgY29ybmVyIGNhc2Ugd2hl
biBhbiBleGVjdXRhYmxlCm1hcHBpbmcgY2hhbmdlcyBzaXplIG9yIGNhY2hl
YWJpbGl0eSB3aXRob3V0IFRMQiBpbnZhbGlkYXRpb24uICBIVk0gZ3Vlc3QK
a2VybmVscyBjYW4gdHJpZ2dlciB0aGlzIHRvIERvUyB0aGUgaG9zdC4KClRv
IG1pdGlnYXRlLCBpbiBhZmZlY3RlZCBoYXJkd2FyZSwgYWxsIEVQVCBzdXBl
cnBhZ2VzIGFyZSBtYXJrZWQgTlguICBXaGVuIGFuCmluc3RydWN0aW9uIGZl
dGNoIHZpb2xhdGlvbiBpcyBvYnNlcnZlZCBhZ2FpbnN0IHRoZSBzdXBlcnBh
Z2UsIHRoZSBzdXBlcnBhZ2UKaXMgc2hhdHRlcmVkIHRvIDRrIGFuZCBoYXMg
ZXhlY3V0ZSBwZXJtaXNzaW9ucyByZXN0b3JlZC4gIFRoaXMgcHJldmVudHMg
dGhlCmd1ZXN0IGtlcm5lbCBmcm9tIGJlaW5nIGFibGUgdG8gY3JlYXRlIHRo
ZSBuZWNlc3NhcnkgcHJlY29uZGl0aW9ucyBpbiB0aGUgaVRMQgp0byBleHBs
b2l0IHRoZSB2dWxuZXJhYmlsaXR5LgoKVGhpcyBkb2VzIGNvbWUgd2l0aCBh
IHdvcmtsb2FkLWRlcGVuZGVudCBwZXJmb3JtYW5jZSBvdmVyaGVhZCwgY2F1
c2VkIGJ5CmluY3JlYXNlZCBUTEIgcHJlc3N1cmUuICBQZXJmb3JtYW5jZSBj
YW4gYmUgcmVzdG9yZWQsIGlmIGd1ZXN0IGtlcm5lbHMgYXJlCnRydXN0ZWQg
bm90IHRvIG1vdW50IGFuIGF0dGFjaywgYnkgc3BlY2lmeWluZyBlcHQ9ZXhl
Yy1zcCBvbiB0aGUgY29tbWFuZCBsaW5lLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3
IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2
aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRp
ZmYgLS1naXQgYS9kb2NzL21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2Mg
Yi9kb2NzL21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2MKaW5kZXggNDUx
ZDIxM2M4Yy4uZDJiMDAyMGI1NSAxMDA2NDQKLS0tIGEvZG9jcy9taXNjL3hl
bi1jb21tYW5kLWxpbmUucGFuZG9jCisrKyBiL2RvY3MvbWlzYy94ZW4tY29t
bWFuZC1saW5lLnBhbmRvYwpAQCAtOTE4LDcgKzkxOCw3IEBAIENvbnRyb2xz
IGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSBzeXN0ZW0gRXh0ZW5kZWQgRmly
bXdhcmUgSW50ZXJmYWNlLgogICAgIHVuY2FjaGVhYmxlLgogCiAjIyMgZXB0
Ci0+IGA9IExpc3Qgb2YgWyBhZD08Ym9vbD4sIHBtbD08Ym9vbD4gXWAKKz4g
YD0gTGlzdCBvZiBbIGFkPTxib29sPiwgcG1sPTxib29sPiwgZXhlYy1zcD08
Ym9vbD4gXWAKIAogPiBBcHBsaWNhYmlsaXR5OiBJbnRlbAogCkBAIC05NDks
NiArOTQ5LDE2IEBAIGludHJvZHVjZWQgd2l0aCB0aGUgTmVoYWxlbSBhcmNo
aXRlY3R1cmUuCiAgICAgZGlzYWJsZSBQTUwuICBgcG1sPTBgIGNhbiBiZSB1
c2VkIHRvIHByZXZlbnQgdGhlIHVzZSBvZiBQTUwgb24gb3RoZXJ3aXNlCiAg
ICAgY2FwYWJsZSBoYXJkd2FyZS4KIAorKiAgIFRoZSBgZXhlYy1zcGAgYm9v
bGVhbiBjb250cm9scyB3aGV0aGVyIEVQVCBzdXBlcnBhZ2VzIHdpdGggZXhl
Y3V0ZQorICAgIHBlcm1pc3Npb25zIGFyZSBwZXJtaXR0ZWQuICBJbiBnZW5l
cmFsIHRoaXMgaXMgZ29vZCBmb3IgcGVyZm9ybWFuY2UuCisKKyAgICBIb3dl
dmVyLCBvbiBwcm9jZXNzb3JzIHZ1bG5lcmFibGUgQ1ZFLTIwMTgtMTIyMDcs
IEhWTSBndWVzdCBrZXJuZWxzIGNhbgorICAgIHVzZSBleGVjdXRhYmxlIHN1
cGVycGFnZXMgdG8gY3Jhc2ggdGhlIGhvc3QuICBCeSBkZWZhdWx0LCBleGVj
dXRhYmxlCisgICAgc3VwZXJwYWdlcyBhcmUgZGlzYWJsZWQgb24gYWZmZWN0
ZWQgaGFyZHdhcmUuCisKKyAgICBJZiBIVk0gZ3Vlc3Qga2VybmVscyBhcmUg
dHJ1c3RlZCBub3QgdG8gbW91bnQgYSBEb1MgYWdhaW5zdCB0aGUgc3lzdGVt
LAorICAgIHRoaXMgb3B0aW9uIGNhbiBlbmFibGVkIHRvIHJlZ2FpbiBwZXJm
b3JtYW5jZS4KKwogIyMjIGV4dHJhX2d1ZXN0X2lycXMKID4gYD0gWzxkb21V
IG51bWJlcj5dWyw8ZG9tMCBudW1iZXI+XWAKIApkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L2h2bS9odm0uYyBiL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMK
aW5kZXggMDZhN2I0MDEwNy4uODE4ZTcwNWZkMSAxMDA2NDQKLS0tIGEveGVu
L2FyY2gveDg2L2h2bS9odm0uYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2h2
bS5jCkBAIC0xODMzLDYgKzE4MzMsMjQgQEAgaW50IGh2bV9oYXBfbmVzdGVk
X3BhZ2VfZmF1bHQocGFkZHJfdCBncGEsIHVuc2lnbmVkIGxvbmcgZ2xhLAog
ICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KIAorICAgICAgICAvKgor
ICAgICAgICAgKiBXb3JrYXJvdW5kIGZvciBYU0EtMzA0IC8gQ1ZFLTIwMTgt
MTIyMDcuICBJZiB3ZSB0YWtlIGFuIGV4ZWN1dGlvbgorICAgICAgICAgKiBm
YXVsdCBhZ2FpbnN0IGEgbm9uLWV4ZWN1dGFibGUgc3VwZXJwYWdlLCBzaGF0
dGVyIGl0IHRvIHJlZ2FpbgorICAgICAgICAgKiBleGVjdXRlIHBlcm1pc3Np
b25zLgorICAgICAgICAgKi8KKyAgICAgICAgaWYgKCBwYWdlX29yZGVyID4g
MCAmJiBucGZlYy5pbnNuX2ZldGNoICYmIG5wZmVjLnByZXNlbnQgJiYgIXZp
b2xhdGlvbiApCisgICAgICAgIHsKKyAgICAgICAgICAgIGludCByZXMgPSBw
Mm1fc2V0X2VudHJ5KHAybSwgX2dmbihnZm4pLCBtZm4sIFBBR0VfT1JERVJf
NEssCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm10
LCBwMm1hKTsKKworICAgICAgICAgICAgaWYgKCByZXMgKQorICAgICAgICAg
ICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQgdG8gc2hhdHRlciBn
Zm4gJSJQUklfZ2ZuIjogJWRcbiIsCisgICAgICAgICAgICAgICAgICAgICAg
IGdmbiwgcmVzKTsKKworICAgICAgICAgICAgcmMgPSAhcmVzOworICAgICAg
ICAgICAgZ290byBvdXRfcHV0X2dmbjsKKyAgICAgICAgfQorCiAgICAgICAg
IGlmICggdmlvbGF0aW9uICkKICAgICAgICAgewogICAgICAgICAgICAgLyog
U2hvdWxkICNWRSBiZSBlbXVsYXRlZCBmb3IgdGhpcyBmYXVsdD8gKi8KZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3MuYyBiL3hlbi9h
cmNoL3g4Ni9odm0vdm14L3ZtY3MuYwppbmRleCBlZDI3ZThkZWY3Li5kMjYy
NGVhOWQ3IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNz
LmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5jCkBAIC02Nyw2
ICs2Nyw3IEBAIGludGVnZXJfcGFyYW0oInBsZV93aW5kb3ciLCBwbGVfd2lu
ZG93KTsKIAogc3RhdGljIGJvb2wgX19yZWFkX21vc3RseSBvcHRfZXB0X3Bt
bCA9IHRydWU7CiBzdGF0aWMgczggX19yZWFkX21vc3RseSBvcHRfZXB0X2Fk
ID0gLTE7CitpbnQ4X3QgX19yZWFkX21vc3RseSBvcHRfZXB0X2V4ZWNfc3Ag
PSAtMTsKIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfZXB0X3BhcmFtKGNv
bnN0IGNoYXIgKnMpCiB7CkBAIC04Miw2ICs4Myw4IEBAIHN0YXRpYyBpbnQg
X19pbml0IHBhcnNlX2VwdF9wYXJhbShjb25zdCBjaGFyICpzKQogICAgICAg
ICAgICAgb3B0X2VwdF9hZCA9IHZhbDsKICAgICAgICAgZWxzZSBpZiAoICh2
YWwgPSBwYXJzZV9ib29sZWFuKCJwbWwiLCBzLCBzcykpID49IDAgKQogICAg
ICAgICAgICAgb3B0X2VwdF9wbWwgPSB2YWw7CisgICAgICAgIGVsc2UgaWYg
KCAodmFsID0gcGFyc2VfYm9vbGVhbigiZXhlYy1zcCIsIHMsIHNzKSkgPj0g
MCApCisgICAgICAgICAgICBvcHRfZXB0X2V4ZWNfc3AgPSB2YWw7CiAgICAg
ICAgIGVsc2UKICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKIApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMgYi94ZW4vYXJjaC94
ODYvaHZtL3ZteC92bXguYwppbmRleCBhNTVmZjM3NzMzLi42YTVlZWI1YzEz
IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYworKysg
Yi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYwpAQCAtMjM3MSw2ICsyMzcx
LDEwMiBAQCBzdGF0aWMgdm9pZCBwaV9ub3RpZmljYXRpb25faW50ZXJydXB0
KHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQogc3RhdGljIHZvaWQgX19p
bml0IGxicl90c3hfZml4dXBfY2hlY2sodm9pZCk7CiBzdGF0aWMgdm9pZCBf
X2luaXQgYmRmOTNfZml4dXBfY2hlY2sodm9pZCk7CiAKKy8qCisgKiBDYWxj
dWxhdGUgd2hldGhlciB0aGUgQ1BVIGlzIHZ1bG5lcmFibGUgdG8gSW5zdHJ1
Y3Rpb24gRmV0Y2ggcGFnZQorICogc2l6ZS1jaGFuZ2UgTUNFcy4KKyAqLwor
c3RhdGljIGJvb2wgX19pbml0IGhhc19pZl9wc2NoYW5nZV9tYyh2b2lkKQor
eworICAgIHVpbnQ2NF90IGNhcHMgPSAwOworCisgICAgLyoKKyAgICAgKiBJ
ZiB3ZSBhcmUgdmlydHVhbGlzZWQsIHRoZXJlIGlzIG5vdGhpbmcgd2UgY2Fu
IGRvLiAgT3VyIEVQVCB0YWJsZXMgYXJlCisgICAgICogc2hhZG93ZWQgYnkg
b3VyIGh5cGVydmlzb3IsIGFuZCBub3Qgd2Fsa2VkIGJ5IGhhcmR3YXJlLgor
ICAgICAqLworICAgIGlmICggY3B1X2hhc19oeXBlcnZpc29yICkKKyAgICAg
ICAgcmV0dXJuIGZhbHNlOworCisgICAgaWYgKCBib290X2NwdV9oYXMoWDg2
X0ZFQVRVUkVfQVJDSF9DQVBTKSApCisgICAgICAgIHJkbXNybChNU1JfQVJD
SF9DQVBBQklMSVRJRVMsIGNhcHMpOworCisgICAgaWYgKCBjYXBzICYgQVJD
SF9DQVBTX0lGX1BTQ0hBTkdFX01DX05PICkKKyAgICAgICAgcmV0dXJuIGZh
bHNlOworCisgICAgLyoKKyAgICAgKiBJRl9QU0NIQU5HRV9NQyBpcyBvbmx5
IGtub3duIHRvIGFmZmVjdCBJbnRlbCBGYW1pbHkgNiBwcm9jZXNzb3JzIGF0
CisgICAgICogdGhpcyB0aW1lLgorICAgICAqLworICAgIGlmICggYm9vdF9j
cHVfZGF0YS54ODZfdmVuZG9yICE9IFg4Nl9WRU5ET1JfSU5URUwgfHwKKyAg
ICAgICAgIGJvb3RfY3B1X2RhdGEueDg2ICE9IDYgKQorICAgICAgICByZXR1
cm4gZmFsc2U7CisKKyAgICBzd2l0Y2ggKCBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCApCisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBDb3JlIHBy
b2Nlc3NvcnMgc2luY2UgYXQgbGVhc3QgTmVoYWxlbSBhcmUgdnVsbmVyYWJs
ZS4KKyAgICAgICAgICovCisgICAgY2FzZSAweDFmOiAvKiBBdWJ1cm5kYWxl
IC8gSGF2ZW5kYWxlICovCisgICAgY2FzZSAweDFlOiAvKiBOZWhhbGVtICov
CisgICAgY2FzZSAweDFhOiAvKiBOZWhhbGVtIEVQICovCisgICAgY2FzZSAw
eDJlOiAvKiBOZWhhbGVtIEVYICovCisgICAgY2FzZSAweDI1OiAvKiBXZXN0
bWVyZSAqLworICAgIGNhc2UgMHgyYzogLyogV2VzdG1lcmUgRVAgKi8KKyAg
ICBjYXNlIDB4MmY6IC8qIFdlc3RtZXJlIEVYICovCisgICAgY2FzZSAweDJh
OiAvKiBTYW5keUJyaWRnZSAqLworICAgIGNhc2UgMHgyZDogLyogU2FuZHlC
cmlkZ2UgRVAvRVggKi8KKyAgICBjYXNlIDB4M2E6IC8qIEl2eUJyaWRnZSAq
LworICAgIGNhc2UgMHgzZTogLyogSXZ5QnJpZGdlIEVQL0VYICovCisgICAg
Y2FzZSAweDNjOiAvKiBIYXN3ZWxsICovCisgICAgY2FzZSAweDNmOiAvKiBI
YXN3ZWxsIEVYL0VQICovCisgICAgY2FzZSAweDQ1OiAvKiBIYXN3ZWxsIEQg
Ki8KKyAgICBjYXNlIDB4NDY6IC8qIEhhc3dlbGwgSCAqLworICAgIGNhc2Ug
MHgzZDogLyogQnJvYWR3ZWxsICovCisgICAgY2FzZSAweDQ3OiAvKiBCcm9h
ZHdlbGwgSCAqLworICAgIGNhc2UgMHg0ZjogLyogQnJvYWR3ZWxsIEVQL0VY
ICovCisgICAgY2FzZSAweDU2OiAvKiBCcm9hZHdlbGwgRCAqLworICAgIGNh
c2UgMHg0ZTogLyogU2t5bGFrZSBNICovCisgICAgY2FzZSAweDVlOiAvKiBT
a3lsYWtlIEQgKi8KKyAgICBjYXNlIDB4NTU6IC8qIFNreWxha2UtWCAvIENh
c2NhZGUgTGFrZSAqLworICAgIGNhc2UgMHg4ZTogLyogS2FieSAvIENvZmZl
ZSAvIFdoaXNrZXkgTGFrZSBNICovCisgICAgY2FzZSAweDllOiAvKiBLYWJ5
IC8gQ29mZmVlIC8gV2hpc2tleSBMYWtlIEQgKi8KKyAgICAgICAgcmV0dXJu
IHRydWU7CisKKyAgICAgICAgLyoKKyAgICAgICAgICogQXRvbSBwcm9jZXNz
b3JzIGFyZSBub3QgdnVsbmVyYWJsZS4KKyAgICAgICAgICovCisgICAgY2Fz
ZSAweDFjOiAvKiBQaW5ldmlldyAqLworICAgIGNhc2UgMHgyNjogLyogTGlu
Y3JvZnQgKi8KKyAgICBjYXNlIDB4Mjc6IC8qIFBlbndlbGwgKi8KKyAgICBj
YXNlIDB4MzU6IC8qIENsb3ZlcnZpZXcgKi8KKyAgICBjYXNlIDB4MzY6IC8q
IENlZGFydmlldyAqLworICAgIGNhc2UgMHgzNzogLyogQmF5dHJhaWwgLyBW
YWxsZXl2aWV3IChTaWx2ZXJtb250KSAqLworICAgIGNhc2UgMHg0ZDogLyog
QXZhdG9uIC8gUmFuZ2VseSAoU2lsdmVybW9udCkgKi8KKyAgICBjYXNlIDB4
NGM6IC8qIENoZXJyeXRyYWlsIC8gQnJhc3N3ZWxsICovCisgICAgY2FzZSAw
eDRhOiAvKiBNZXJyaWZpZWxkICovCisgICAgY2FzZSAweDVhOiAvKiBNb29y
ZWZpZWxkICovCisgICAgY2FzZSAweDVjOiAvKiBHb2xkbW9udCAqLworICAg
IGNhc2UgMHg1ZDogLyogU29GSUEgM0cgR3Jhbml0ZS9FUzIuMSAqLworICAg
IGNhc2UgMHg2NTogLyogU29GSUEgTFRFIEFPU1AgKi8KKyAgICBjYXNlIDB4
NWY6IC8qIERlbnZlcnRvbiAqLworICAgIGNhc2UgMHg2ZTogLyogQ291Z2Fy
IE1vdW50YWluICovCisgICAgY2FzZSAweDc1OiAvKiBMaWdodG5pbmcgTW91
bnRhaW4gKi8KKyAgICBjYXNlIDB4N2E6IC8qIEdlbWluaSBMYWtlICovCisg
ICAgY2FzZSAweDg2OiAvKiBKYWNvYnN2aWxsZSAqLworCisgICAgICAgIC8q
CisgICAgICAgICAqIEtuaWdodHMgcHJvY2Vzc29ycyBhcmUgbm90IHZ1bG5l
cmFibGUuCisgICAgICAgICAqLworICAgIGNhc2UgMHg1NzogLyogS25pZ2h0
cyBMYW5kaW5nICovCisgICAgY2FzZSAweDg1OiAvKiBLbmlnaHRzIE1pbGwg
Ki8KKyAgICAgICAgcmV0dXJuIGZhbHNlOworCisgICAgZGVmYXVsdDoKKyAg
ICAgICAgcHJpbnRrKCJVbnJlY29nbmlzZWQgQ1BVIG1vZGVsICUjeCAtIGFz
c3VtaW5nIHZ1bG5lcmFibGUgdG8gSUZfUFNDSEFOR0VfTUNcbiIsCisgICAg
ICAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9tb2RlbCk7CisgICAgICAg
IHJldHVybiB0cnVlOworICAgIH0KK30KKwogY29uc3Qgc3RydWN0IGh2bV9m
dW5jdGlvbl90YWJsZSAqIF9faW5pdCBzdGFydF92bXgodm9pZCkKIHsKICAg
ICBzZXRfaW5fY3I0KFg4Nl9DUjRfVk1YRSk7CkBAIC0yMzkxLDYgKzI0ODcs
MTcgQEAgY29uc3Qgc3RydWN0IGh2bV9mdW5jdGlvbl90YWJsZSAqIF9faW5p
dCBzdGFydF92bXgodm9pZCkKICAgICAgKi8KICAgICBpZiAoIGNwdV9oYXNf
dm14X2VwdCAmJiAoY3B1X2hhc192bXhfcGF0IHx8IG9wdF9mb3JjZV9lcHQp
ICkKICAgICB7CisgICAgICAgIGJvb2wgY3B1X2hhc19idWdfcHNjaGFuZ2Vf
bWMgPSBoYXNfaWZfcHNjaGFuZ2VfbWMoKTsKKworICAgICAgICBpZiAoIG9w
dF9lcHRfZXhlY19zcCA9PSAtMSApCisgICAgICAgIHsKKyAgICAgICAgICAg
IC8qIERlZmF1bHQgdG8gbm9uLWV4ZWN1dGFibGUgc3VwZXJwYWdlcyBvbiB2
dWxuZXJhYmxlIGhhcmR3YXJlLiAqLworICAgICAgICAgICAgb3B0X2VwdF9l
eGVjX3NwID0gIWNwdV9oYXNfYnVnX3BzY2hhbmdlX21jOworCisgICAgICAg
ICAgICBpZiAoIGNwdV9oYXNfYnVnX3BzY2hhbmdlX21jICkKKyAgICAgICAg
ICAgICAgICBwcmludGsoIlZNWDogRGlzYWJsaW5nIGV4ZWN1dGFibGUgRVBU
IHN1cGVycGFnZXMgZHVlIHRvIENWRS0yMDE4LTEyMjA3XG4iKTsKKyAgICAg
ICAgfQorCiAgICAgICAgIHZteF9mdW5jdGlvbl90YWJsZS5oYXBfc3VwcG9y
dGVkID0gMTsKICAgICAgICAgdm14X2Z1bmN0aW9uX3RhYmxlLmFsdHAybV9z
dXBwb3J0ZWQgPSAxOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0v
cDJtLWVwdC5jIGIveGVuL2FyY2gveDg2L21tL3AybS1lcHQuYwppbmRleCAy
MjA5OTBmMDE3Li5mMDZlNTE5MDRhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTE3NCw2ICsxNzQsMTIgQEAgc3RhdGljIHZvaWQgZXB0X3AybV90
eXBlX3RvX2ZsYWdzKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIGVwdF9lbnRy
eV90ICplbnRyeSwKICAgICAgICAgICAgIGJyZWFrOwogICAgIH0KICAgICAK
KyAgICAvKgorICAgICAqIERvbid0IGNyZWF0ZSBleGVjdXRhYmxlIHN1cGVy
cGFnZXMgaWYgd2UgbmVlZCB0byBzaGF0dGVyIHRoZW0gdG8KKyAgICAgKiBw
cm90ZWN0IGFnYWluc3QgQ1ZFLTIwMTgtMTIyMDcuCisgICAgICovCisgICAg
aWYgKCAhb3B0X2VwdF9leGVjX3NwICYmIGlzX2VwdGVfc3VwZXJwYWdlKGVu
dHJ5KSApCisgICAgICAgIGVudHJ5LT54ID0gMDsKIH0KIAogI2RlZmluZSBH
VUVTVF9UQUJMRV9NQVBfRkFJTEVEICAwCmRpZmYgLS1naXQgYS94ZW4vaW5j
bHVkZS9hc20teDg2L2h2bS92bXgvdm14LmggYi94ZW4vaW5jbHVkZS9hc20t
eDg2L2h2bS92bXgvdm14LmgKaW5kZXggZWJhYTc0NDQ5Yi4uMzcxYjkxMjg4
NyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vdm14L3Zt
eC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZteC92bXguaApA
QCAtMjgsNiArMjgsOCBAQAogI2luY2x1ZGUgPGFzbS9odm0vdHJhY2UuaD4K
ICNpbmNsdWRlIDxhc20vaHZtL3ZteC92bWNzLmg+CiAKK2V4dGVybiBpbnQ4
X3Qgb3B0X2VwdF9leGVjX3NwOworCiB0eXBlZGVmIHVuaW9uIHsKICAgICBz
dHJ1Y3QgewogICAgICAgICB1NjQgciAgICAgICA6ICAgMSwgIC8qIGJpdCAw
IC0gUmVhZCBwZXJtaXNzaW9uICovCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9hc20teDg2L21zci1pbmRleC5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9t
c3ItaW5kZXguaAppbmRleCA2MzcyNTliZDFmLi4zMjc0NmFhOGFlIDEwMDY0
NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21zci1pbmRleC5oCisrKyBi
L3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLWluZGV4LmgKQEAgLTUyLDYgKzUy
LDcgQEAKICNkZWZpbmUgQVJDSF9DQVBTX1NLSVBfTDFERkwJCShfQUMoMSwg
VUxMKSA8PCAzKQogI2RlZmluZSBBUkNIX0NBUFNfU1NCX05PCQkoX0FDKDEs
IFVMTCkgPDwgNCkKICNkZWZpbmUgQVJDSF9DQVBTX01EU19OTwkJKF9BQygx
LCBVTEwpIDw8IDUpCisjZGVmaW5lIEFSQ0hfQ0FQU19JRl9QU0NIQU5HRV9N
Q19OTwkoX0FDKDEsIFVMTCkgPDwgNikKIAogI2RlZmluZSBNU1JfRkxVU0hf
Q01ECQkJMHgwMDAwMDEwYgogI2RlZmluZSBGTFVTSF9DTURfTDFECQkJKF9B
QygxLCBVTEwpIDw8IDApCg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-3.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogQWxsb3cgcnVudGltZSBtb2RpZmljYXRp
b24gb2YgdGhlIGV4ZWMtc3Agc2V0dGluZwoKU2VlIHBhdGNoIGZvciBkZXRh
aWxzLgoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS9kb2Nz
L21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2MgYi9kb2NzL21pc2MveGVu
LWNvbW1hbmQtbGluZS5wYW5kb2MKaW5kZXggZDJiMDAyMGI1NS4uNWU0Mjdh
MWNmOCAxMDA2NDQKLS0tIGEvZG9jcy9taXNjL3hlbi1jb21tYW5kLWxpbmUu
cGFuZG9jCisrKyBiL2RvY3MvbWlzYy94ZW4tY29tbWFuZC1saW5lLnBhbmRv
YwpAQCAtOTU5LDYgKzk1OSwyMSBAQCBpbnRyb2R1Y2VkIHdpdGggdGhlIE5l
aGFsZW0gYXJjaGl0ZWN0dXJlLgogICAgIElmIEhWTSBndWVzdCBrZXJuZWxz
IGFyZSB0cnVzdGVkIG5vdCB0byBtb3VudCBhIERvUyBhZ2FpbnN0IHRoZSBz
eXN0ZW0sCiAgICAgdGhpcyBvcHRpb24gY2FuIGVuYWJsZWQgdG8gcmVnYWlu
IHBlcmZvcm1hbmNlLgogCisgICAgVGhpcyBib29sZWFuIG1heSBiZSBtb2Rp
ZmllZCBhdCBydW50aW1lIHVzaW5nIGB4bCBzZXQtcGFyYW1ldGVycworICAg
IGVwdD1bbm8tXWV4ZWMtc3BgIHRvIHN3aXRjaCBiZXR3ZWVuIGZhc3QgYW5k
IHNlY3VyZS4KKworICAgICogICBXaGVuIHN3aXRjaGluZyBmcm9tIHNlY3Vy
ZSB0byBmYXN0LCBwcmVleGlzdGluZyBIVk0gZG9tYWlucyB3aWxsIHJ1bgor
ICAgICAgICBhdCB0aGVpciBjdXJyZW50IHBlcmZvcm1hbmNlIHVudGlsIHRo
ZXkgYXJlIHJlYm9vdGVkOyBuZXcgZG9tYWlucyB3aWxsCisgICAgICAgIHJ1
biB3aXRob3V0IGFueSBvdmVyaGVhZC4KKworICAgICogICBXaGVuIHN3aXRj
aGluZyBmcm9tIGZhc3QgdG8gc2VjdXJlLCBhbGwgSFZNIGRvbWFpbnMgd2ls
bCBpbW1lZGlhdGVseQorICAgICAgICBzdWZmZXIgYSBwZXJmb3JtYW5jZSBw
ZW5hbHR5LgorCisgICAgKipXYXJuaW5nOiBObyBndWFyYW50ZWUgaXMgbWFk
ZSB0aGF0IHRoaXMgcnVudGltZSBvcHRpb24gd2lsbCBiZSByZXRhaW5lZAor
ICAgICAgaW5kZWZpbml0ZWx5LCBvciB0aGF0IGl0IHdpbGwgcmV0YWluIHRo
aXMgZXhhY3QgYmVoYXZpb3VyLiAgSXQgaXMKKyAgICAgIGludGVuZGVkIGFz
IGFuIGVtZXJnZW5jeSBvcHRpb24gZm9yIHBlb3BsZSB3aG8gZmlyc3QgY2hv
c2UgZmFzdCwgdGhlbgorICAgICAgY2hhbmdlIHRoZWlyIG1pbmRzIHRvIHNl
Y3VyZSwgYW5kIHdpc2ggbm90IHRvIHJlYm9vdC4qKgorCiAjIyMgZXh0cmFf
Z3Vlc3RfaXJxcwogPiBgPSBbPGRvbVUgbnVtYmVyPl1bLDxkb20wIG51bWJl
cj5dYAogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNz
LmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNzLmMKaW5kZXggZDI2MjRl
YTlkNy4uNDc3Yzk2ODQwOSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2
bS92bXgvdm1jcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3Mu
YwpAQCAtOTUsNiArOTUsNDEgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2Vf
ZXB0X3BhcmFtKGNvbnN0IGNoYXIgKnMpCiB9CiBjdXN0b21fcGFyYW0oImVw
dCIsIHBhcnNlX2VwdF9wYXJhbSk7CiAKK3N0YXRpYyBpbnQgcGFyc2VfZXB0
X3BhcmFtX3J1bnRpbWUoY29uc3QgY2hhciAqcykKK3sKKyAgICBpbnQgdmFs
OworCisgICAgaWYgKCAhY3B1X2hhc192bXhfZXB0IHx8ICFodm1fZnVuY3Mu
aGFwX3N1cHBvcnRlZCB8fAorICAgICAgICAgIShodm1fZnVuY3MuaGFwX2Nh
cGFiaWxpdGllcyAmCisgICAgICAgICAgIChIVk1fSEFQX1NVUEVSUEFHRV8y
TUIgfCBIVk1fSEFQX1NVUEVSUEFHRV8xR0IpKSApCisgICAgeworICAgICAg
ICBwcmludGsoIlZNWDogRVBUIG5vdCBhdmFpbGFibGUsIG9yIG5vdCBpbiB1
c2UgLSBpZ25vcmluZ1xuIik7CisgICAgICAgIHJldHVybiAwOworICAgIH0K
KworICAgIGlmICggKHZhbCA9IHBhcnNlX2Jvb2xlYW4oImV4ZWMtc3AiLCBz
LCBOVUxMKSkgPCAwICkKKyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisKKyAg
ICBpZiAoIHZhbCAhPSBvcHRfZXB0X2V4ZWNfc3AgKQorICAgIHsKKyAgICAg
ICAgc3RydWN0IGRvbWFpbiAqZDsKKworICAgICAgICBvcHRfZXB0X2V4ZWNf
c3AgPSB2YWw7CisKKyAgICAgICAgcmN1X3JlYWRfbG9jaygmZG9tbGlzdF9y
ZWFkX2xvY2spOworICAgICAgICBmb3JfZWFjaF9kb21haW4gKCBkICkKKyAg
ICAgICAgICAgIGlmICggcGFnaW5nX21vZGVfaGFwKGQpICkKKyAgICAgICAg
ICAgICAgICBwMm1fY2hhbmdlX2VudHJ5X3R5cGVfZ2xvYmFsKGQsIHAybV9y
YW1fcncsIHAybV9yYW1fcncpOworICAgICAgICByY3VfcmVhZF91bmxvY2so
JmRvbWxpc3RfcmVhZF9sb2NrKTsKKyAgICB9CisKKyAgICBwcmludGsoIlZN
WDogRVBUIGV4ZWN1dGFibGUgc3VwZXJwYWdlcyAlc2FibGVkXG4iLAorICAg
ICAgICAgICB2YWwgPyAiZW4iIDogImRpcyIpOworCisgICAgcmV0dXJuIDA7
Cit9CitjdXN0b21fcnVudGltZV9vbmx5X3BhcmFtKCJlcHQiLCBwYXJzZV9l
cHRfcGFyYW1fcnVudGltZSk7CisKIC8qIER5bmFtaWMgKHJ1bi10aW1lIGFk
anVzdGVkKSBleGVjdXRpb24gY29udHJvbCBmbGFncy4gKi8KIHUzMiB2bXhf
cGluX2Jhc2VkX2V4ZWNfY29udHJvbCBfX3JlYWRfbW9zdGx5OwogdTMyIHZt
eF9jcHVfYmFzZWRfZXhlY19jb250cm9sIF9fcmVhZF9tb3N0bHk7CmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMgYi94ZW4vYXJjaC94ODYv
bW0vcDJtLmMKaW5kZXggZTVlNDM0OWRlYS4uYmExMjZmNzkwYSAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS9wMm0uYwpAQCAtMjg5LDE1ICsyODksMjAgQEAgc3RhdGljIHZvaWQg
Y2hhbmdlX2VudHJ5X3R5cGVfZ2xvYmFsKHN0cnVjdCBwMm1fZG9tYWluICpw
Mm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJt
X3R5cGVfdCBvdCwgcDJtX3R5cGVfdCBudCkKIHsKICAgICBwMm0tPmNoYW5n
ZV9lbnRyeV90eXBlX2dsb2JhbChwMm0sIG90LCBudCk7Ci0gICAgcDJtLT5n
bG9iYWxfbG9nZGlydHkgPSAobnQgPT0gcDJtX3JhbV9sb2dkaXJ0eSk7Cisg
ICAgLyogRG9uJ3QgYWxsb3cgJ3JlY2FsY3VsYXRlJyBvcGVyYXRpb25zIHRv
IGNoYW5nZSB0aGUgbG9nZGlydHkgc3RhdGUuICovCisgICAgaWYgKCBvdCAh
PSBudCApCisgICAgICAgIHAybS0+Z2xvYmFsX2xvZ2RpcnR5ID0gKG50ID09
IHAybV9yYW1fbG9nZGlydHkpOwogfQogCisvKgorICogTWF5IGJlIGNhbGxl
ZCB3aXRoIG90ID0gbnQgPSBwMm1fcmFtX3J3IGZvciBpdHMgc2lkZSBlZmZl
Y3Qgb2YKKyAqIHJlY2FsY3VsYXRpbmcgYWxsIFBURXMgaW4gdGhlIHAybS4K
KyAqLwogdm9pZCBwMm1fY2hhbmdlX2VudHJ5X3R5cGVfZ2xvYmFsKHN0cnVj
dCBkb21haW4gKmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcDJtX3R5cGVfdCBvdCwgcDJtX3R5cGVfdCBudCkKIHsKICAgICBzdHJ1
Y3QgcDJtX2RvbWFpbiAqaG9zdHAybSA9IHAybV9nZXRfaG9zdHAybShkKTsK
IAotICAgIEFTU0VSVChvdCAhPSBudCk7CiAgICAgQVNTRVJUKHAybV9pc19j
aGFuZ2VhYmxlKG90KSAmJiBwMm1faXNfY2hhbmdlYWJsZShudCkpOwogCiAg
ICAgcDJtX2xvY2soaG9zdHAybSk7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.8-1.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.8-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0ZDogSGlkZSBzdXBlcnBhZ2Ugc3VwcG9ydCBm
b3IgU2FuZHlCcmlkZ2UgSU9NTVVzCgpTb21ldGhpbmcgY2F1c2VzIFNhbmR5
QnJpZGdlIElPTU1VcyB0byBjaG9rZSB3aGVuIHNoYXJpbmcgRVBUIHBhZ2V0
YWJsZXMsIGFuZAphbiBFUFQgc3VwZXJwYWdlIGdldHMgc2hhdHRlcmVkLiAg
VGhlIHJvb3QgY2F1c2UgaXMgc3RpbGwgdW5kZXIgaW52ZXN0aWdhdGlvbiwK
YnV0IHRoZSBlbmQgcmVzdWx0IGlzIHVudXNhYmxlIGluIGNvbWJpbmF0aW9u
IHdpdGggQ1ZFLTIwMTgtMTIyMDcgcHJvdGVjdGlvbnMuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMwNCAvIENWRS0yMDE4LTEyMjA3CgpTaWduZWQtb2ZmLWJ5
OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRl
cm4uaCBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApp
bmRleCBmYjdlZGZhZWY5Li5kNjk4YjFkNTBhIDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZXh0ZXJuLmgKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCkBAIC05Niw2ICs5Niw4
IEBAIHZvaWQgdnRkX29wc19wb3N0YW1ibGVfcXVpcmsoc3RydWN0IGlvbW11
KiBpb21tdSk7CiBpbnQgX19tdXN0X2NoZWNrIG1lX3dpZmlfcXVpcmsoc3Ry
dWN0IGRvbWFpbiAqZG9tYWluLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU4IGJ1cywgdTggZGV2Zm4sIGludCBtYXApOwogdm9pZCBwY2lf
dnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICopOwordm9pZCBxdWly
a19pb21tdV9jYXBzKHN0cnVjdCBpb21tdSAqaW9tbXUpOworCiBib29sX3Qg
cGxhdGZvcm1fc3VwcG9ydHNfaW50cmVtYXAodm9pZCk7CiBib29sX3QgcGxh
dGZvcm1fc3VwcG9ydHNfeDJhcGljKHZvaWQpOwogCmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCmluZGV4IDU0Y2I3OThjMmUu
LmQxOTc4MTMzYTAgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC9pb21tdS5jCkBAIC0xMjA1LDYgKzEyMDUsOCBAQCBpbnQgX19pbml0
IGlvbW11X2FsbG9jKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCkKICAg
ICBpZiAoICEoaW9tbXUtPmNhcCArIDEpIHx8ICEoaW9tbXUtPmVjYXAgKyAx
KSApCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogCisgICAgcXVpcmtfaW9t
bXVfY2Fwcyhpb21tdSk7CisKICAgICBpZiAoIGNhcF9mYXVsdF9yZWdfb2Zm
c2V0KGlvbW11LT5jYXApICsKICAgICAgICAgIGNhcF9udW1fZmF1bHRfcmVn
cyhpb21tdS0+Y2FwKSAqIFBSSU1BUllfRkFVTFRfUkVHX0xFTiA+PSBQQUdF
X1NJWkUgfHwKICAgICAgICAgIGVjYXBfaW90bGJfb2Zmc2V0KGlvbW11LT5l
Y2FwKSA+PSBQQUdFX1NJWkUgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL3F1aXJrcy5jCmluZGV4IDViYmJkOTZkNTEuLjdmY2E5NWZh
ODcgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9x
dWlya3MuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVp
cmtzLmMKQEAgLTUzOSwzICs1MzksMjggQEAgdm9pZCBwY2lfdnRkX3F1aXJr
KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBicmVhazsK
ICAgICB9CiB9CisKK3ZvaWQgX19pbml0IHF1aXJrX2lvbW11X2NhcHMoc3Ry
dWN0IGlvbW11ICppb21tdSkKK3sKKyAgICAvKgorICAgICAqIElPTU1VIFF1
aXJrczoKKyAgICAgKgorICAgICAqIFNhbmR5QnJpZGdlIElPTU1VcyBjbGFp
bSBzdXBwb3J0IGZvciAyTSBhbmQgMUcgc3VwZXJwYWdlcywgYnV0IGRvbid0
CisgICAgICogaW1wbGVtZW50IHN1cGVycGFnZXMgaW50ZXJuYWxseS4KKyAg
ICAgKgorICAgICAqIFRoZXJlIGFyZSBpc3N1ZXMgY2hhbmdpbmcgdGhlIHdh
bGsgbGVuZ3RoIHVuZGVyIGluLWZsaWdodCBETUEsIHdoaWNoCisgICAgICog
aGFzIG1hbmlmZXN0ZWQgYXMgaW5jb21wYXRpYmlsaXR5IGJldHdlZW4gRVBU
L0lPTU1VIHNoYXJpbmcgYW5kIHRoZQorICAgICAqIHdvcmthcm91bmQgZm9y
IENWRS0yMDE4LTEyMjA3IC8gWFNBLTMwNC4gIEhpZGUgdGhlIHN1cGVycGFn
ZXMKKyAgICAgKiBjYXBhYmlsaXRpZXMgaW4gdGhlIElPTU1VLCB3aGljaCB3
aWxsIHByZXZlbnQgWGVuIGZyb20gc2hhcmluZyB0aGUgRVBUCisgICAgICog
YW5kIElPTU1VIHBhZ2V0YWJsZXMuCisgICAgICoKKyAgICAgKiBEZXRlY3Rp
b24gb2YgU2FuZHlCcmlkZ2UgdW5mb3J0dW5hdGVseSBoYXMgdG8gYmUgZG9u
ZSBieSBwcm9jZXNzb3IKKyAgICAgKiBtb2RlbCBiZWNhdXNlIHRoZSBjbGll
bnQgcGFydHMgZG9uJ3QgZXhwb3NlIHRoZWlyIElPTU1VcyBhcyBQQ0kgZGV2
aWNlcworICAgICAqIHdlIGNvdWxkIG1hdGNoIHdpdGggYSBEZXZpY2UgSUQu
CisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92ZW5kb3Ig
PT0gWDg2X1ZFTkRPUl9JTlRFTCAmJgorICAgICAgICAgYm9vdF9jcHVfZGF0
YS54ODYgPT0gNiAmJgorICAgICAgICAgKGJvb3RfY3B1X2RhdGEueDg2X21v
ZGVsID09IDB4MmEgfHwKKyAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCA9PSAweDJkKSApCisgICAgICAgIGlvbW11LT5jYXAgJj0gfigweGZ1
bCA8PCAzNCk7Cit9Cg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.8-2.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.8-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogRGlzYWJsZSBleGVjdXRhYmxlIEVQVCBz
dXBlcnBhZ2VzIHRvIHdvcmsgYXJvdW5kCiBDVkUtMjAxOC0xMjIwNwoKQ1ZF
LTIwMTgtMTIyMDcgY292ZXJzIGEgc2V0IG9mIGVycmF0YSBvbiB2YXJpb3Vz
IEludGVsIHByb2Nlc3NvcnMsIHdoZXJlYnkgYQptYWNoaW5lIGNoZWNrIGV4
Y2VwdGlvbiBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgY29ybmVyIGNhc2Ugd2hl
biBhbiBleGVjdXRhYmxlCm1hcHBpbmcgY2hhbmdlcyBzaXplIG9yIGNhY2hl
YWJpbGl0eSB3aXRob3V0IFRMQiBpbnZhbGlkYXRpb24uICBIVk0gZ3Vlc3QK
a2VybmVscyBjYW4gdHJpZ2dlciB0aGlzIHRvIERvUyB0aGUgaG9zdC4KClRv
IG1pdGlnYXRlLCBpbiBhZmZlY3RlZCBoYXJkd2FyZSwgYWxsIEVQVCBzdXBl
cnBhZ2VzIGFyZSBtYXJrZWQgTlguICBXaGVuIGFuCmluc3RydWN0aW9uIGZl
dGNoIHZpb2xhdGlvbiBpcyBvYnNlcnZlZCBhZ2FpbnN0IHRoZSBzdXBlcnBh
Z2UsIHRoZSBzdXBlcnBhZ2UKaXMgc2hhdHRlcmVkIHRvIDRrIGFuZCBoYXMg
ZXhlY3V0ZSBwZXJtaXNzaW9ucyByZXN0b3JlZC4gIFRoaXMgcHJldmVudHMg
dGhlCmd1ZXN0IGtlcm5lbCBmcm9tIGJlaW5nIGFibGUgdG8gY3JlYXRlIHRo
ZSBuZWNlc3NhcnkgcHJlY29uZGl0aW9ucyBpbiB0aGUgaVRMQgp0byBleHBs
b2l0IHRoZSB2dWxuZXJhYmlsaXR5LgoKVGhpcyBkb2VzIGNvbWUgd2l0aCBh
IHdvcmtsb2FkLWRlcGVuZGVudCBwZXJmb3JtYW5jZSBvdmVyaGVhZCwgY2F1
c2VkIGJ5CmluY3JlYXNlZCBUTEIgcHJlc3N1cmUuICBQZXJmb3JtYW5jZSBj
YW4gYmUgcmVzdG9yZWQsIGlmIGd1ZXN0IGtlcm5lbHMgYXJlCnRydXN0ZWQg
bm90IHRvIG1vdW50IGFuIGF0dGFjaywgYnkgc3BlY2lmeWluZyBlcHQ9ZXhl
Yy1zcCBvbiB0aGUgY29tbWFuZCBsaW5lLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3
IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2
aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jIGIveGVuL2FyY2gv
eDg2L2h2bS9odm0uYwppbmRleCAyM2Q2ZjA5ZDhhLi41MzM4ZDIwYzQxIDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9odm0vaHZtLmMKQEAgLTE3ODEsNiArMTc4MSw3IEBAIGludCBo
dm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25l
ZCBsb25nIGdsYSwKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCAqaG9z
dHAybTsKICAgICBpbnQgcmMsIGZhbGxfdGhyb3VnaCA9IDAsIHBhZ2VkID0g
MDsKICAgICBpbnQgc2hhcmluZ19lbm9tZW0gPSAwOworICAgIHVuc2lnbmVk
IGludCBwYWdlX29yZGVyID0gMDsKICAgICB2bV9ldmVudF9yZXF1ZXN0X3Qg
KnJlcV9wdHIgPSBOVUxMOwogICAgIGJvb2xfdCBhcDJtX2FjdGl2ZSwgc3lu
YyA9IDA7CiAKQEAgLTE4NTEsNyArMTg1Miw3IEBAIGludCBodm1faGFwX25l
c3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBsb25nIGds
YSwKICAgICBob3N0cDJtID0gcDJtX2dldF9ob3N0cDJtKGN1cnJkKTsKICAg
ICBtZm4gPSBnZXRfZ2ZuX3R5cGVfYWNjZXNzKGhvc3RwMm0sIGdmbiwgJnAy
bXQsICZwMm1hLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUDJN
X0FMTE9DIHwgKG5wZmVjLndyaXRlX2FjY2VzcyA/IFAyTV9VTlNIQVJFIDog
MCksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZwYWdlX29yZGVyKTsKIAog
ICAgIGlmICggYXAybV9hY3RpdmUgKQogICAgIHsKQEAgLTE4NjMsNyArMTg2
NCw3IEBAIGludCBodm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3Qg
Z3BhLCB1bnNpZ25lZCBsb25nIGdsYSwKICAgICAgICAgICAgIGdvdG8gb3V0
OwogICAgICAgICB9CiAKLSAgICAgICAgbWZuID0gZ2V0X2dmbl90eXBlX2Fj
Y2VzcyhwMm0sIGdmbiwgJnAybXQsICZwMm1hLCAwLCBOVUxMKTsKKyAgICAg
ICAgbWZuID0gZ2V0X2dmbl90eXBlX2FjY2VzcyhwMm0sIGdmbiwgJnAybXQs
ICZwMm1hLCAwLCAmcGFnZV9vcmRlcik7CiAgICAgfQogICAgIGVsc2UKICAg
ICAgICAgcDJtID0gaG9zdHAybTsKQEAgLTE5MDUsNiArMTkwNiwyMyBAQCBp
bnQgaHZtX2hhcF9uZXN0ZWRfcGFnZV9mYXVsdChwYWRkcl90IGdwYSwgdW5z
aWduZWQgbG9uZyBnbGEsCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
fQogCisgICAgICAgIC8qCisgICAgICAgICAqIFdvcmthcm91bmQgZm9yIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNy4gIElmIHdlIHRha2UgYW4gZXhlY3V0
aW9uCisgICAgICAgICAqIGZhdWx0IGFnYWluc3QgYSBub24tZXhlY3V0YWJs
ZSBzdXBlcnBhZ2UsIHNoYXR0ZXIgaXQgdG8gcmVnYWluCisgICAgICAgICAq
IGV4ZWN1dGUgcGVybWlzc2lvbnMuCisgICAgICAgICAqLworICAgICAgICBp
ZiAoIHBhZ2Vfb3JkZXIgPiAwICYmIG5wZmVjLmluc25fZmV0Y2ggJiYgbnBm
ZWMucHJlc2VudCAmJiAhdmlvbGF0aW9uICkKKyAgICAgICAgeworICAgICAg
ICAgICAgaW50IHJlcyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwg
UEFHRV9PUkRFUl80SywgcDJtdCwgcDJtYSk7CisKKyAgICAgICAgICAgIGlm
ICggcmVzICkKKyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAi
RmFpbGVkIHRvIHNoYXR0ZXIgZ2ZuICUiUFJJX2dmbiI6ICVkXG4iLAorICAg
ICAgICAgICAgICAgICAgICAgICBnZm4sIHJlcyk7CisKKyAgICAgICAgICAg
IHJjID0gIXJlczsKKyAgICAgICAgICAgIGdvdG8gb3V0X3B1dF9nZm47Cisg
ICAgICAgIH0KKwogICAgICAgICBpZiAoIHZpb2xhdGlvbiApCiAgICAgICAg
IHsKICAgICAgICAgICAgIC8qIFNob3VsZCAjVkUgYmUgZW11bGF0ZWQgZm9y
IHRoaXMgZmF1bHQ/ICovCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZt
L3ZteC92bWNzLmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNzLmMKaW5k
ZXggYWYxYTlkNDQ0Zi4uYjRiNTM5YWMzZiAxMDA2NDQKLS0tIGEveGVuL2Fy
Y2gveDg2L2h2bS92bXgvdm1jcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0v
dm14L3ZtY3MuYwpAQCAtNjgsNiArNjgsNyBAQCBpbnRlZ2VyX3BhcmFtKCJw
bGVfd2luZG93IiwgcGxlX3dpbmRvdyk7CiAKIHN0YXRpYyBib29sX3QgX19y
ZWFkX21vc3RseSBvcHRfcG1sX2VuYWJsZWQgPSAxOwogc3RhdGljIHM4IF9f
cmVhZF9tb3N0bHkgb3B0X2VwdF9hZCA9IC0xOworaW50OF90IF9fcmVhZF9t
b3N0bHkgb3B0X2VwdF9leGVjX3NwID0gLTE7CiAKIC8qCiAgKiBUaGUgJ2Vw
dCcgcGFyYW1ldGVyIGNvbnRyb2xzIGZ1bmN0aW9uYWxpdGllcyB0aGF0IGRl
cGVuZCBvbiwgb3IgaW1wYWN0IHRoZQpAQCAtOTQsNiArOTUsOCBAQCBzdGF0
aWMgdm9pZCBfX2luaXQgcGFyc2VfZXB0X3BhcmFtKGNoYXIgKnMpCiAgICAg
ICAgICAgICBvcHRfcG1sX2VuYWJsZWQgPSB2YWw7CiAgICAgICAgIGVsc2Ug
aWYgKCAhc3RyY21wKHMsICJhZCIpICkKICAgICAgICAgICAgIG9wdF9lcHRf
YWQgPSB2YWw7CisgICAgICAgIGVsc2UgaWYgKCAhc3RyY21wKHMsICJleGVj
LXNwIikgKQorICAgICAgICAgICAgb3B0X2VwdF9leGVjX3NwID0gdmFsOwog
CiAgICAgICAgIHMgPSBzcyArIDE7CiAgICAgfSB3aGlsZSAoIHNzICk7CmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYyBiL3hlbi9h
cmNoL3g4Ni9odm0vdm14L3ZteC5jCmluZGV4IDAwNTNhYzAxMjIuLjhkNGQ5
NzNmZjAgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5j
CisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jCkBAIC0yNDAxLDYg
KzI0MDEsMTAyIEBAIHN0YXRpYyB2b2lkIHBpX25vdGlmaWNhdGlvbl9pbnRl
cnJ1cHQoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiAgICAgcmFpc2Vf
c29mdGlycShWQ1BVX0tJQ0tfU09GVElSUSk7CiB9CiAKKy8qCisgKiBDYWxj
dWxhdGUgd2hldGhlciB0aGUgQ1BVIGlzIHZ1bG5lcmFibGUgdG8gSW5zdHJ1
Y3Rpb24gRmV0Y2ggcGFnZQorICogc2l6ZS1jaGFuZ2UgTUNFcy4KKyAqLwor
c3RhdGljIGJvb2wgX19pbml0IGhhc19pZl9wc2NoYW5nZV9tYyh2b2lkKQor
eworICAgIHVpbnQ2NF90IGNhcHMgPSAwOworCisgICAgLyoKKyAgICAgKiBJ
ZiB3ZSBhcmUgdmlydHVhbGlzZWQsIHRoZXJlIGlzIG5vdGhpbmcgd2UgY2Fu
IGRvLiAgT3VyIEVQVCB0YWJsZXMgYXJlCisgICAgICogc2hhZG93ZWQgYnkg
b3VyIGh5cGVydmlzb3IsIGFuZCBub3Qgd2Fsa2VkIGJ5IGhhcmR3YXJlLgor
ICAgICAqLworICAgIGlmICggY3B1X2hhc19oeXBlcnZpc29yICkKKyAgICAg
ICAgcmV0dXJuIGZhbHNlOworCisgICAgaWYgKCBib290X2NwdV9oYXMoWDg2
X0ZFQVRVUkVfQVJDSF9DQVBTKSApCisgICAgICAgIHJkbXNybChNU1JfQVJD
SF9DQVBBQklMSVRJRVMsIGNhcHMpOworCisgICAgaWYgKCBjYXBzICYgQVJD
SF9DQVBTX0lGX1BTQ0hBTkdFX01DX05PICkKKyAgICAgICAgcmV0dXJuIGZh
bHNlOworCisgICAgLyoKKyAgICAgKiBJRl9QU0NIQU5HRV9NQyBpcyBvbmx5
IGtub3duIHRvIGFmZmVjdCBJbnRlbCBGYW1pbHkgNiBwcm9jZXNzb3JzIGF0
CisgICAgICogdGhpcyB0aW1lLgorICAgICAqLworICAgIGlmICggYm9vdF9j
cHVfZGF0YS54ODZfdmVuZG9yICE9IFg4Nl9WRU5ET1JfSU5URUwgfHwKKyAg
ICAgICAgIGJvb3RfY3B1X2RhdGEueDg2ICE9IDYgKQorICAgICAgICByZXR1
cm4gZmFsc2U7CisKKyAgICBzd2l0Y2ggKCBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCApCisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBDb3JlIHBy
b2Nlc3NvcnMgc2luY2UgYXQgbGVhc3QgTmVoYWxlbSBhcmUgdnVsbmVyYWJs
ZS4KKyAgICAgICAgICovCisgICAgY2FzZSAweDFmOiAvKiBBdWJ1cm5kYWxl
IC8gSGF2ZW5kYWxlICovCisgICAgY2FzZSAweDFlOiAvKiBOZWhhbGVtICov
CisgICAgY2FzZSAweDFhOiAvKiBOZWhhbGVtIEVQICovCisgICAgY2FzZSAw
eDJlOiAvKiBOZWhhbGVtIEVYICovCisgICAgY2FzZSAweDI1OiAvKiBXZXN0
bWVyZSAqLworICAgIGNhc2UgMHgyYzogLyogV2VzdG1lcmUgRVAgKi8KKyAg
ICBjYXNlIDB4MmY6IC8qIFdlc3RtZXJlIEVYICovCisgICAgY2FzZSAweDJh
OiAvKiBTYW5keUJyaWRnZSAqLworICAgIGNhc2UgMHgyZDogLyogU2FuZHlC
cmlkZ2UgRVAvRVggKi8KKyAgICBjYXNlIDB4M2E6IC8qIEl2eUJyaWRnZSAq
LworICAgIGNhc2UgMHgzZTogLyogSXZ5QnJpZGdlIEVQL0VYICovCisgICAg
Y2FzZSAweDNjOiAvKiBIYXN3ZWxsICovCisgICAgY2FzZSAweDNmOiAvKiBI
YXN3ZWxsIEVYL0VQICovCisgICAgY2FzZSAweDQ1OiAvKiBIYXN3ZWxsIEQg
Ki8KKyAgICBjYXNlIDB4NDY6IC8qIEhhc3dlbGwgSCAqLworICAgIGNhc2Ug
MHgzZDogLyogQnJvYWR3ZWxsICovCisgICAgY2FzZSAweDQ3OiAvKiBCcm9h
ZHdlbGwgSCAqLworICAgIGNhc2UgMHg0ZjogLyogQnJvYWR3ZWxsIEVQL0VY
ICovCisgICAgY2FzZSAweDU2OiAvKiBCcm9hZHdlbGwgRCAqLworICAgIGNh
c2UgMHg0ZTogLyogU2t5bGFrZSBNICovCisgICAgY2FzZSAweDVlOiAvKiBT
a3lsYWtlIEQgKi8KKyAgICBjYXNlIDB4NTU6IC8qIFNreWxha2UtWCAvIENh
c2NhZGUgTGFrZSAqLworICAgIGNhc2UgMHg4ZTogLyogS2FieSAvIENvZmZl
ZSAvIFdoaXNrZXkgTGFrZSBNICovCisgICAgY2FzZSAweDllOiAvKiBLYWJ5
IC8gQ29mZmVlIC8gV2hpc2tleSBMYWtlIEQgKi8KKyAgICAgICAgcmV0dXJu
IHRydWU7CisKKyAgICAgICAgLyoKKyAgICAgICAgICogQXRvbSBwcm9jZXNz
b3JzIGFyZSBub3QgdnVsbmVyYWJsZS4KKyAgICAgICAgICovCisgICAgY2Fz
ZSAweDFjOiAvKiBQaW5ldmlldyAqLworICAgIGNhc2UgMHgyNjogLyogTGlu
Y3JvZnQgKi8KKyAgICBjYXNlIDB4Mjc6IC8qIFBlbndlbGwgKi8KKyAgICBj
YXNlIDB4MzU6IC8qIENsb3ZlcnZpZXcgKi8KKyAgICBjYXNlIDB4MzY6IC8q
IENlZGFydmlldyAqLworICAgIGNhc2UgMHgzNzogLyogQmF5dHJhaWwgLyBW
YWxsZXl2aWV3IChTaWx2ZXJtb250KSAqLworICAgIGNhc2UgMHg0ZDogLyog
QXZhdG9uIC8gUmFuZ2VseSAoU2lsdmVybW9udCkgKi8KKyAgICBjYXNlIDB4
NGM6IC8qIENoZXJyeXRyYWlsIC8gQnJhc3N3ZWxsICovCisgICAgY2FzZSAw
eDRhOiAvKiBNZXJyaWZpZWxkICovCisgICAgY2FzZSAweDVhOiAvKiBNb29y
ZWZpZWxkICovCisgICAgY2FzZSAweDVjOiAvKiBHb2xkbW9udCAqLworICAg
IGNhc2UgMHg1ZDogLyogU29GSUEgM0cgR3Jhbml0ZS9FUzIuMSAqLworICAg
IGNhc2UgMHg2NTogLyogU29GSUEgTFRFIEFPU1AgKi8KKyAgICBjYXNlIDB4
NWY6IC8qIERlbnZlcnRvbiAqLworICAgIGNhc2UgMHg2ZTogLyogQ291Z2Fy
IE1vdW50YWluICovCisgICAgY2FzZSAweDc1OiAvKiBMaWdodG5pbmcgTW91
bnRhaW4gKi8KKyAgICBjYXNlIDB4N2E6IC8qIEdlbWluaSBMYWtlICovCisg
ICAgY2FzZSAweDg2OiAvKiBKYWNvYnN2aWxsZSAqLworCisgICAgICAgIC8q
CisgICAgICAgICAqIEtuaWdodHMgcHJvY2Vzc29ycyBhcmUgbm90IHZ1bG5l
cmFibGUuCisgICAgICAgICAqLworICAgIGNhc2UgMHg1NzogLyogS25pZ2h0
cyBMYW5kaW5nICovCisgICAgY2FzZSAweDg1OiAvKiBLbmlnaHRzIE1pbGwg
Ki8KKyAgICAgICAgcmV0dXJuIGZhbHNlOworCisgICAgZGVmYXVsdDoKKyAg
ICAgICAgcHJpbnRrKCJVbnJlY29nbmlzZWQgQ1BVIG1vZGVsICUjeCAtIGFz
c3VtaW5nIHZ1bG5lcmFibGUgdG8gSUZfUFNDSEFOR0VfTUNcbiIsCisgICAg
ICAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9tb2RlbCk7CisgICAgICAg
IHJldHVybiB0cnVlOworICAgIH0KK30KKwogY29uc3Qgc3RydWN0IGh2bV9m
dW5jdGlvbl90YWJsZSAqIF9faW5pdCBzdGFydF92bXgodm9pZCkKIHsKICAg
ICBzZXRfaW5fY3I0KFg4Nl9DUjRfVk1YRSk7CkBAIC0yNDE3LDYgKzI1MTMs
MTcgQEAgY29uc3Qgc3RydWN0IGh2bV9mdW5jdGlvbl90YWJsZSAqIF9faW5p
dCBzdGFydF92bXgodm9pZCkKICAgICAgKi8KICAgICBpZiAoIGNwdV9oYXNf
dm14X2VwdCAmJiAoY3B1X2hhc192bXhfcGF0IHx8IG9wdF9mb3JjZV9lcHQp
ICkKICAgICB7CisgICAgICAgIGJvb2wgY3B1X2hhc19idWdfcHNjaGFuZ2Vf
bWMgPSBoYXNfaWZfcHNjaGFuZ2VfbWMoKTsKKworICAgICAgICBpZiAoIG9w
dF9lcHRfZXhlY19zcCA9PSAtMSApCisgICAgICAgIHsKKyAgICAgICAgICAg
IC8qIERlZmF1bHQgdG8gbm9uLWV4ZWN1dGFibGUgc3VwZXJwYWdlcyBvbiB2
dWxuZXJhYmxlIGhhcmR3YXJlLiAqLworICAgICAgICAgICAgb3B0X2VwdF9l
eGVjX3NwID0gIWNwdV9oYXNfYnVnX3BzY2hhbmdlX21jOworCisgICAgICAg
ICAgICBpZiAoIGNwdV9oYXNfYnVnX3BzY2hhbmdlX21jICkKKyAgICAgICAg
ICAgICAgICBwcmludGsoIlZNWDogRGlzYWJsaW5nIGV4ZWN1dGFibGUgRVBU
IHN1cGVycGFnZXMgZHVlIHRvIENWRS0yMDE4LTEyMjA3XG4iKTsKKyAgICAg
ICAgfQorCiAgICAgICAgIHZteF9mdW5jdGlvbl90YWJsZS5oYXBfc3VwcG9y
dGVkID0gMTsKICAgICAgICAgdm14X2Z1bmN0aW9uX3RhYmxlLmFsdHAybV9z
dXBwb3J0ZWQgPSAxOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0v
cDJtLWVwdC5jIGIveGVuL2FyY2gveDg2L21tL3AybS1lcHQuYwppbmRleCAy
NmFhM2NkZGI3Li5kMDYzN2VlYjE1IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94
ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKQEAgLTIxMCw2ICsyMTAsMTIgQEAgc3RhdGljIHZvaWQgZXB0X3AybV90
eXBlX3RvX2ZsYWdzKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIGVwdF9lbnRy
eV90ICplbnRyeSwKICAgICAgICAgICAgIGJyZWFrOwogICAgIH0KICAgICAK
KyAgICAvKgorICAgICAqIERvbid0IGNyZWF0ZSBleGVjdXRhYmxlIHN1cGVy
cGFnZXMgaWYgd2UgbmVlZCB0byBzaGF0dGVyIHRoZW0gdG8KKyAgICAgKiBw
cm90ZWN0IGFnYWluc3QgQ1ZFLTIwMTgtMTIyMDcuCisgICAgICovCisgICAg
aWYgKCAhb3B0X2VwdF9leGVjX3NwICYmIGlzX2VwdGVfc3VwZXJwYWdlKGVu
dHJ5KSApCisgICAgICAgIGVudHJ5LT54ID0gMDsKIH0KIAogI2RlZmluZSBH
VUVTVF9UQUJMRV9NQVBfRkFJTEVEICAwCmRpZmYgLS1naXQgYS94ZW4vaW5j
bHVkZS9hc20teDg2L2h2bS92bXgvdm14LmggYi94ZW4vaW5jbHVkZS9hc20t
eDg2L2h2bS92bXgvdm14LmgKaW5kZXggNGNkZDliMWQ5Zi4uYmQ3MTU0NTE4
OCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vdm14L3Zt
eC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZteC92bXguaApA
QCAtMjgsNiArMjgsOCBAQAogI2luY2x1ZGUgPGFzbS9odm0vdHJhY2UuaD4K
ICNpbmNsdWRlIDxhc20vaHZtL3ZteC92bWNzLmg+CiAKK2V4dGVybiBpbnQ4
X3Qgb3B0X2VwdF9leGVjX3NwOworCiB0eXBlZGVmIHVuaW9uIHsKICAgICBz
dHJ1Y3QgewogICAgICAgICB1NjQgciAgICAgICA6ICAgMSwgIC8qIGJpdCAw
IC0gUmVhZCBwZXJtaXNzaW9uICovCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVk
ZS9hc20teDg2L21zci1pbmRleC5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9t
c3ItaW5kZXguaAppbmRleCA5MmQxMGUyMTkxLi4wYTU5NmY3NDg5IDEwMDY0
NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21zci1pbmRleC5oCisrKyBi
L3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLWluZGV4LmgKQEAgLTU0LDYgKzU0
LDcgQEAKICNkZWZpbmUgQVJDSF9DQVBTX1NLSVBfTDFERkwJCShfQUMoMSwg
VUxMKSA8PCAzKQogI2RlZmluZSBBUkNIX0NBUFNfU1NCX05PCQkoX0FDKDEs
IFVMTCkgPDwgNCkKICNkZWZpbmUgQVJDSF9DQVBTX01EU19OTwkJKF9BQygx
LCBVTEwpIDw8IDUpCisjZGVmaW5lIEFSQ0hfQ0FQU19JRl9QU0NIQU5HRV9N
Q19OTwkoX0FDKDEsIFVMTCkgPDwgNikKIAogI2RlZmluZSBNU1JfRkxVU0hf
Q01ECQkJMHgwMDAwMDEwYgogI2RlZmluZSBGTFVTSF9DTURfTDFECQkJKF9B
QygxLCBVTEwpIDw8IDApCg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.9-1.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.9-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0ZDogSGlkZSBzdXBlcnBhZ2Ugc3VwcG9ydCBm
b3IgU2FuZHlCcmlkZ2UgSU9NTVVzCgpTb21ldGhpbmcgY2F1c2VzIFNhbmR5
QnJpZGdlIElPTU1VcyB0byBjaG9rZSB3aGVuIHNoYXJpbmcgRVBUIHBhZ2V0
YWJsZXMsIGFuZAphbiBFUFQgc3VwZXJwYWdlIGdldHMgc2hhdHRlcmVkLiAg
VGhlIHJvb3QgY2F1c2UgaXMgc3RpbGwgdW5kZXIgaW52ZXN0aWdhdGlvbiwK
YnV0IHRoZSBlbmQgcmVzdWx0IGlzIHVudXNhYmxlIGluIGNvbWJpbmF0aW9u
IHdpdGggQ1ZFLTIwMTgtMTIyMDcgcHJvdGVjdGlvbnMuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMwNCAvIENWRS0yMDE4LTEyMjA3CgpTaWduZWQtb2ZmLWJ5
OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRl
cm4uaCBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApp
bmRleCBmYjdlZGZhZWY5Li5kNjk4YjFkNTBhIDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZXh0ZXJuLmgKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCkBAIC05Niw2ICs5Niw4
IEBAIHZvaWQgdnRkX29wc19wb3N0YW1ibGVfcXVpcmsoc3RydWN0IGlvbW11
KiBpb21tdSk7CiBpbnQgX19tdXN0X2NoZWNrIG1lX3dpZmlfcXVpcmsoc3Ry
dWN0IGRvbWFpbiAqZG9tYWluLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU4IGJ1cywgdTggZGV2Zm4sIGludCBtYXApOwogdm9pZCBwY2lf
dnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICopOwordm9pZCBxdWly
a19pb21tdV9jYXBzKHN0cnVjdCBpb21tdSAqaW9tbXUpOworCiBib29sX3Qg
cGxhdGZvcm1fc3VwcG9ydHNfaW50cmVtYXAodm9pZCk7CiBib29sX3QgcGxh
dGZvcm1fc3VwcG9ydHNfeDJhcGljKHZvaWQpOwogCmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCmluZGV4IGJiYzdlNDA5MDUu
LjMzNmI3NzhjODEgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC9pb21tdS5jCkBAIC0xMjA1LDYgKzEyMDUsOCBAQCBpbnQgX19pbml0
IGlvbW11X2FsbG9jKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCkKICAg
ICBpZiAoICEoaW9tbXUtPmNhcCArIDEpIHx8ICEoaW9tbXUtPmVjYXAgKyAx
KSApCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogCisgICAgcXVpcmtfaW9t
bXVfY2Fwcyhpb21tdSk7CisKICAgICBpZiAoIGNhcF9mYXVsdF9yZWdfb2Zm
c2V0KGlvbW11LT5jYXApICsKICAgICAgICAgIGNhcF9udW1fZmF1bHRfcmVn
cyhpb21tdS0+Y2FwKSAqIFBSSU1BUllfRkFVTFRfUkVHX0xFTiA+PSBQQUdF
X1NJWkUgfHwKICAgICAgICAgIGVjYXBfaW90bGJfb2Zmc2V0KGlvbW11LT5l
Y2FwKSA+PSBQQUdFX1NJWkUgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL3F1aXJrcy5jCmluZGV4IDViYmJkOTZkNTEuLjdmY2E5NWZh
ODcgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9x
dWlya3MuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVp
cmtzLmMKQEAgLTUzOSwzICs1MzksMjggQEAgdm9pZCBwY2lfdnRkX3F1aXJr
KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBicmVhazsK
ICAgICB9CiB9CisKK3ZvaWQgX19pbml0IHF1aXJrX2lvbW11X2NhcHMoc3Ry
dWN0IGlvbW11ICppb21tdSkKK3sKKyAgICAvKgorICAgICAqIElPTU1VIFF1
aXJrczoKKyAgICAgKgorICAgICAqIFNhbmR5QnJpZGdlIElPTU1VcyBjbGFp
bSBzdXBwb3J0IGZvciAyTSBhbmQgMUcgc3VwZXJwYWdlcywgYnV0IGRvbid0
CisgICAgICogaW1wbGVtZW50IHN1cGVycGFnZXMgaW50ZXJuYWxseS4KKyAg
ICAgKgorICAgICAqIFRoZXJlIGFyZSBpc3N1ZXMgY2hhbmdpbmcgdGhlIHdh
bGsgbGVuZ3RoIHVuZGVyIGluLWZsaWdodCBETUEsIHdoaWNoCisgICAgICog
aGFzIG1hbmlmZXN0ZWQgYXMgaW5jb21wYXRpYmlsaXR5IGJldHdlZW4gRVBU
L0lPTU1VIHNoYXJpbmcgYW5kIHRoZQorICAgICAqIHdvcmthcm91bmQgZm9y
IENWRS0yMDE4LTEyMjA3IC8gWFNBLTMwNC4gIEhpZGUgdGhlIHN1cGVycGFn
ZXMKKyAgICAgKiBjYXBhYmlsaXRpZXMgaW4gdGhlIElPTU1VLCB3aGljaCB3
aWxsIHByZXZlbnQgWGVuIGZyb20gc2hhcmluZyB0aGUgRVBUCisgICAgICog
YW5kIElPTU1VIHBhZ2V0YWJsZXMuCisgICAgICoKKyAgICAgKiBEZXRlY3Rp
b24gb2YgU2FuZHlCcmlkZ2UgdW5mb3J0dW5hdGVseSBoYXMgdG8gYmUgZG9u
ZSBieSBwcm9jZXNzb3IKKyAgICAgKiBtb2RlbCBiZWNhdXNlIHRoZSBjbGll
bnQgcGFydHMgZG9uJ3QgZXhwb3NlIHRoZWlyIElPTU1VcyBhcyBQQ0kgZGV2
aWNlcworICAgICAqIHdlIGNvdWxkIG1hdGNoIHdpdGggYSBEZXZpY2UgSUQu
CisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92ZW5kb3Ig
PT0gWDg2X1ZFTkRPUl9JTlRFTCAmJgorICAgICAgICAgYm9vdF9jcHVfZGF0
YS54ODYgPT0gNiAmJgorICAgICAgICAgKGJvb3RfY3B1X2RhdGEueDg2X21v
ZGVsID09IDB4MmEgfHwKKyAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCA9PSAweDJkKSApCisgICAgICAgIGlvbW11LT5jYXAgJj0gfigweGZ1
bCA8PCAzNCk7Cit9Cg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.9-2.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.9-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogRGlzYWJsZSBleGVjdXRhYmxlIEVQVCBz
dXBlcnBhZ2VzIHRvIHdvcmsgYXJvdW5kCiBDVkUtMjAxOC0xMjIwNwoKQ1ZF
LTIwMTgtMTIyMDcgY292ZXJzIGEgc2V0IG9mIGVycmF0YSBvbiB2YXJpb3Vz
IEludGVsIHByb2Nlc3NvcnMsIHdoZXJlYnkgYQptYWNoaW5lIGNoZWNrIGV4
Y2VwdGlvbiBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgY29ybmVyIGNhc2Ugd2hl
biBhbiBleGVjdXRhYmxlCm1hcHBpbmcgY2hhbmdlcyBzaXplIG9yIGNhY2hl
YWJpbGl0eSB3aXRob3V0IFRMQiBpbnZhbGlkYXRpb24uICBIVk0gZ3Vlc3QK
a2VybmVscyBjYW4gdHJpZ2dlciB0aGlzIHRvIERvUyB0aGUgaG9zdC4KClRv
IG1pdGlnYXRlLCBpbiBhZmZlY3RlZCBoYXJkd2FyZSwgYWxsIEVQVCBzdXBl
cnBhZ2VzIGFyZSBtYXJrZWQgTlguICBXaGVuIGFuCmluc3RydWN0aW9uIGZl
dGNoIHZpb2xhdGlvbiBpcyBvYnNlcnZlZCBhZ2FpbnN0IHRoZSBzdXBlcnBh
Z2UsIHRoZSBzdXBlcnBhZ2UKaXMgc2hhdHRlcmVkIHRvIDRrIGFuZCBoYXMg
ZXhlY3V0ZSBwZXJtaXNzaW9ucyByZXN0b3JlZC4gIFRoaXMgcHJldmVudHMg
dGhlCmd1ZXN0IGtlcm5lbCBmcm9tIGJlaW5nIGFibGUgdG8gY3JlYXRlIHRo
ZSBuZWNlc3NhcnkgcHJlY29uZGl0aW9ucyBpbiB0aGUgaVRMQgp0byBleHBs
b2l0IHRoZSB2dWxuZXJhYmlsaXR5LgoKVGhpcyBkb2VzIGNvbWUgd2l0aCBh
IHdvcmtsb2FkLWRlcGVuZGVudCBwZXJmb3JtYW5jZSBvdmVyaGVhZCwgY2F1
c2VkIGJ5CmluY3JlYXNlZCBUTEIgcHJlc3N1cmUuICBQZXJmb3JtYW5jZSBj
YW4gYmUgcmVzdG9yZWQsIGlmIGd1ZXN0IGtlcm5lbHMgYXJlCnRydXN0ZWQg
bm90IHRvIG1vdW50IGFuIGF0dGFjaywgYnkgc3BlY2lmeWluZyBlcHQ9ZXhl
Yy1zcCBvbiB0aGUgY29tbWFuZCBsaW5lLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3
IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2
aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jIGIveGVuL2FyY2gv
eDg2L2h2bS9odm0uYwppbmRleCAwMTY0YWU1YTk2Li4wYjA1YjAzODhjIDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9odm0vaHZtLmMKQEAgLTE2NDgsNiArMTY0OCw3IEBAIGludCBo
dm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25l
ZCBsb25nIGdsYSwKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCAqaG9z
dHAybTsKICAgICBpbnQgcmMsIGZhbGxfdGhyb3VnaCA9IDAsIHBhZ2VkID0g
MDsKICAgICBpbnQgc2hhcmluZ19lbm9tZW0gPSAwOworICAgIHVuc2lnbmVk
IGludCBwYWdlX29yZGVyID0gMDsKICAgICB2bV9ldmVudF9yZXF1ZXN0X3Qg
KnJlcV9wdHIgPSBOVUxMOwogICAgIGJvb2xfdCBhcDJtX2FjdGl2ZSwgc3lu
YyA9IDA7CiAKQEAgLTE3MTgsNyArMTcxOSw3IEBAIGludCBodm1faGFwX25l
c3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBsb25nIGds
YSwKICAgICBob3N0cDJtID0gcDJtX2dldF9ob3N0cDJtKGN1cnJkKTsKICAg
ICBtZm4gPSBnZXRfZ2ZuX3R5cGVfYWNjZXNzKGhvc3RwMm0sIGdmbiwgJnAy
bXQsICZwMm1hLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUDJN
X0FMTE9DIHwgKG5wZmVjLndyaXRlX2FjY2VzcyA/IFAyTV9VTlNIQVJFIDog
MCksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZwYWdlX29yZGVyKTsKIAog
ICAgIGlmICggYXAybV9hY3RpdmUgKQogICAgIHsKQEAgLTE3MzAsNyArMTcz
MSw3IEBAIGludCBodm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3Qg
Z3BhLCB1bnNpZ25lZCBsb25nIGdsYSwKICAgICAgICAgICAgIGdvdG8gb3V0
OwogICAgICAgICB9CiAKLSAgICAgICAgbWZuID0gZ2V0X2dmbl90eXBlX2Fj
Y2VzcyhwMm0sIGdmbiwgJnAybXQsICZwMm1hLCAwLCBOVUxMKTsKKyAgICAg
ICAgbWZuID0gZ2V0X2dmbl90eXBlX2FjY2VzcyhwMm0sIGdmbiwgJnAybXQs
ICZwMm1hLCAwLCAmcGFnZV9vcmRlcik7CiAgICAgfQogICAgIGVsc2UKICAg
ICAgICAgcDJtID0gaG9zdHAybTsKQEAgLTE3NzIsNiArMTc3MywyMyBAQCBp
bnQgaHZtX2hhcF9uZXN0ZWRfcGFnZV9mYXVsdChwYWRkcl90IGdwYSwgdW5z
aWduZWQgbG9uZyBnbGEsCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
fQogCisgICAgICAgIC8qCisgICAgICAgICAqIFdvcmthcm91bmQgZm9yIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNy4gIElmIHdlIHRha2UgYW4gZXhlY3V0
aW9uCisgICAgICAgICAqIGZhdWx0IGFnYWluc3QgYSBub24tZXhlY3V0YWJs
ZSBzdXBlcnBhZ2UsIHNoYXR0ZXIgaXQgdG8gcmVnYWluCisgICAgICAgICAq
IGV4ZWN1dGUgcGVybWlzc2lvbnMuCisgICAgICAgICAqLworICAgICAgICBp
ZiAoIHBhZ2Vfb3JkZXIgPiAwICYmIG5wZmVjLmluc25fZmV0Y2ggJiYgbnBm
ZWMucHJlc2VudCAmJiAhdmlvbGF0aW9uICkKKyAgICAgICAgeworICAgICAg
ICAgICAgaW50IHJlcyA9IHAybV9zZXRfZW50cnkocDJtLCBnZm4sIG1mbiwg
UEFHRV9PUkRFUl80SywgcDJtdCwgcDJtYSk7CisKKyAgICAgICAgICAgIGlm
ICggcmVzICkKKyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAi
RmFpbGVkIHRvIHNoYXR0ZXIgZ2ZuICUiUFJJX2dmbiI6ICVkXG4iLAorICAg
ICAgICAgICAgICAgICAgICAgICBnZm4sIHJlcyk7CisKKyAgICAgICAgICAg
IHJjID0gIXJlczsKKyAgICAgICAgICAgIGdvdG8gb3V0X3B1dF9nZm47Cisg
ICAgICAgIH0KKwogICAgICAgICBpZiAoIHZpb2xhdGlvbiApCiAgICAgICAg
IHsKICAgICAgICAgICAgIC8qIFNob3VsZCAjVkUgYmUgZW11bGF0ZWQgZm9y
IHRoaXMgZmF1bHQ/ICovCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZt
L3ZteC92bWNzLmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNzLmMKaW5k
ZXggMzQ1YmZiZjZmYy4uMTc4ZGRiMDkyNSAxMDA2NDQKLS0tIGEveGVuL2Fy
Y2gveDg2L2h2bS92bXgvdm1jcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0v
dm14L3ZtY3MuYwpAQCAtNjcsNiArNjcsNyBAQCBpbnRlZ2VyX3BhcmFtKCJw
bGVfd2luZG93IiwgcGxlX3dpbmRvdyk7CiAKIHN0YXRpYyBib29sX3QgX19y
ZWFkX21vc3RseSBvcHRfcG1sX2VuYWJsZWQgPSAxOwogc3RhdGljIHM4IF9f
cmVhZF9tb3N0bHkgb3B0X2VwdF9hZCA9IC0xOworaW50OF90IF9fcmVhZF9t
b3N0bHkgb3B0X2VwdF9leGVjX3NwID0gLTE7CiAKIC8qCiAgKiBUaGUgJ2Vw
dCcgcGFyYW1ldGVyIGNvbnRyb2xzIGZ1bmN0aW9uYWxpdGllcyB0aGF0IGRl
cGVuZCBvbiwgb3IgaW1wYWN0IHRoZQpAQCAtOTMsNiArOTQsOCBAQCBzdGF0
aWMgdm9pZCBfX2luaXQgcGFyc2VfZXB0X3BhcmFtKGNoYXIgKnMpCiAgICAg
ICAgICAgICBvcHRfcG1sX2VuYWJsZWQgPSB2YWw7CiAgICAgICAgIGVsc2Ug
aWYgKCAhc3RyY21wKHMsICJhZCIpICkKICAgICAgICAgICAgIG9wdF9lcHRf
YWQgPSB2YWw7CisgICAgICAgIGVsc2UgaWYgKCAhc3RyY21wKHMsICJleGVj
LXNwIikgKQorICAgICAgICAgICAgb3B0X2VwdF9leGVjX3NwID0gdmFsOwog
CiAgICAgICAgIHMgPSBzcyArIDE7CiAgICAgfSB3aGlsZSAoIHNzICk7CmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYyBiL3hlbi9h
cmNoL3g4Ni9odm0vdm14L3ZteC5jCmluZGV4IDUwNDJhODY1MTUuLmNiM2Jl
NDgyODMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5j
CisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jCkBAIC0yNDk2LDYg
KzI0OTYsMTAyIEBAIHN0YXRpYyB2b2lkIHBpX25vdGlmaWNhdGlvbl9pbnRl
cnJ1cHQoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpCiBzdGF0aWMgdm9p
ZCBfX2luaXQgbGJyX3RzeF9maXh1cF9jaGVjayh2b2lkKTsKIHN0YXRpYyB2
b2lkIF9faW5pdCBiZHdfZXJyYXR1bV9iZGYxNF9maXh1cF9jaGVjayh2b2lk
KTsKIAorLyoKKyAqIENhbGN1bGF0ZSB3aGV0aGVyIHRoZSBDUFUgaXMgdnVs
bmVyYWJsZSB0byBJbnN0cnVjdGlvbiBGZXRjaCBwYWdlCisgKiBzaXplLWNo
YW5nZSBNQ0VzLgorICovCitzdGF0aWMgYm9vbCBfX2luaXQgaGFzX2lmX3Bz
Y2hhbmdlX21jKHZvaWQpCit7CisgICAgdWludDY0X3QgY2FwcyA9IDA7CisK
KyAgICAvKgorICAgICAqIElmIHdlIGFyZSB2aXJ0dWFsaXNlZCwgdGhlcmUg
aXMgbm90aGluZyB3ZSBjYW4gZG8uICBPdXIgRVBUIHRhYmxlcyBhcmUKKyAg
ICAgKiBzaGFkb3dlZCBieSBvdXIgaHlwZXJ2aXNvciwgYW5kIG5vdCB3YWxr
ZWQgYnkgaGFyZHdhcmUuCisgICAgICovCisgICAgaWYgKCBjcHVfaGFzX2h5
cGVydmlzb3IgKQorICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICBpZiAo
IGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9BUkNIX0NBUFMpICkKKyAgICAg
ICAgcmRtc3JsKE1TUl9BUkNIX0NBUEFCSUxJVElFUywgY2Fwcyk7CisKKyAg
ICBpZiAoIGNhcHMgJiBBUkNIX0NBUFNfSUZfUFNDSEFOR0VfTUNfTk8gKQor
ICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICAvKgorICAgICAqIElGX1BT
Q0hBTkdFX01DIGlzIG9ubHkga25vd24gdG8gYWZmZWN0IEludGVsIEZhbWls
eSA2IHByb2Nlc3NvcnMgYXQKKyAgICAgKiB0aGlzIHRpbWUuCisgICAgICov
CisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92ZW5kb3IgIT0gWDg2X1ZF
TkRPUl9JTlRFTCB8fAorICAgICAgICAgYm9vdF9jcHVfZGF0YS54ODYgIT0g
NiApCisgICAgICAgIHJldHVybiBmYWxzZTsKKworICAgIHN3aXRjaCAoIGJv
b3RfY3B1X2RhdGEueDg2X21vZGVsICkKKyAgICB7CisgICAgICAgIC8qCisg
ICAgICAgICAqIENvcmUgcHJvY2Vzc29ycyBzaW5jZSBhdCBsZWFzdCBOZWhh
bGVtIGFyZSB2dWxuZXJhYmxlLgorICAgICAgICAgKi8KKyAgICBjYXNlIDB4
MWY6IC8qIEF1YnVybmRhbGUgLyBIYXZlbmRhbGUgKi8KKyAgICBjYXNlIDB4
MWU6IC8qIE5laGFsZW0gKi8KKyAgICBjYXNlIDB4MWE6IC8qIE5laGFsZW0g
RVAgKi8KKyAgICBjYXNlIDB4MmU6IC8qIE5laGFsZW0gRVggKi8KKyAgICBj
YXNlIDB4MjU6IC8qIFdlc3RtZXJlICovCisgICAgY2FzZSAweDJjOiAvKiBX
ZXN0bWVyZSBFUCAqLworICAgIGNhc2UgMHgyZjogLyogV2VzdG1lcmUgRVgg
Ki8KKyAgICBjYXNlIDB4MmE6IC8qIFNhbmR5QnJpZGdlICovCisgICAgY2Fz
ZSAweDJkOiAvKiBTYW5keUJyaWRnZSBFUC9FWCAqLworICAgIGNhc2UgMHgz
YTogLyogSXZ5QnJpZGdlICovCisgICAgY2FzZSAweDNlOiAvKiBJdnlCcmlk
Z2UgRVAvRVggKi8KKyAgICBjYXNlIDB4M2M6IC8qIEhhc3dlbGwgKi8KKyAg
ICBjYXNlIDB4M2Y6IC8qIEhhc3dlbGwgRVgvRVAgKi8KKyAgICBjYXNlIDB4
NDU6IC8qIEhhc3dlbGwgRCAqLworICAgIGNhc2UgMHg0NjogLyogSGFzd2Vs
bCBIICovCisgICAgY2FzZSAweDNkOiAvKiBCcm9hZHdlbGwgKi8KKyAgICBj
YXNlIDB4NDc6IC8qIEJyb2Fkd2VsbCBIICovCisgICAgY2FzZSAweDRmOiAv
KiBCcm9hZHdlbGwgRVAvRVggKi8KKyAgICBjYXNlIDB4NTY6IC8qIEJyb2Fk
d2VsbCBEICovCisgICAgY2FzZSAweDRlOiAvKiBTa3lsYWtlIE0gKi8KKyAg
ICBjYXNlIDB4NWU6IC8qIFNreWxha2UgRCAqLworICAgIGNhc2UgMHg1NTog
LyogU2t5bGFrZS1YIC8gQ2FzY2FkZSBMYWtlICovCisgICAgY2FzZSAweDhl
OiAvKiBLYWJ5IC8gQ29mZmVlIC8gV2hpc2tleSBMYWtlIE0gKi8KKyAgICBj
YXNlIDB4OWU6IC8qIEthYnkgLyBDb2ZmZWUgLyBXaGlza2V5IExha2UgRCAq
LworICAgICAgICByZXR1cm4gdHJ1ZTsKKworICAgICAgICAvKgorICAgICAg
ICAgKiBBdG9tIHByb2Nlc3NvcnMgYXJlIG5vdCB2dWxuZXJhYmxlLgorICAg
ICAgICAgKi8KKyAgICBjYXNlIDB4MWM6IC8qIFBpbmV2aWV3ICovCisgICAg
Y2FzZSAweDI2OiAvKiBMaW5jcm9mdCAqLworICAgIGNhc2UgMHgyNzogLyog
UGVud2VsbCAqLworICAgIGNhc2UgMHgzNTogLyogQ2xvdmVydmlldyAqLwor
ICAgIGNhc2UgMHgzNjogLyogQ2VkYXJ2aWV3ICovCisgICAgY2FzZSAweDM3
OiAvKiBCYXl0cmFpbCAvIFZhbGxleXZpZXcgKFNpbHZlcm1vbnQpICovCisg
ICAgY2FzZSAweDRkOiAvKiBBdmF0b24gLyBSYW5nZWx5IChTaWx2ZXJtb250
KSAqLworICAgIGNhc2UgMHg0YzogLyogQ2hlcnJ5dHJhaWwgLyBCcmFzc3dl
bGwgKi8KKyAgICBjYXNlIDB4NGE6IC8qIE1lcnJpZmllbGQgKi8KKyAgICBj
YXNlIDB4NWE6IC8qIE1vb3JlZmllbGQgKi8KKyAgICBjYXNlIDB4NWM6IC8q
IEdvbGRtb250ICovCisgICAgY2FzZSAweDVkOiAvKiBTb0ZJQSAzRyBHcmFu
aXRlL0VTMi4xICovCisgICAgY2FzZSAweDY1OiAvKiBTb0ZJQSBMVEUgQU9T
UCAqLworICAgIGNhc2UgMHg1ZjogLyogRGVudmVydG9uICovCisgICAgY2Fz
ZSAweDZlOiAvKiBDb3VnYXIgTW91bnRhaW4gKi8KKyAgICBjYXNlIDB4NzU6
IC8qIExpZ2h0bmluZyBNb3VudGFpbiAqLworICAgIGNhc2UgMHg3YTogLyog
R2VtaW5pIExha2UgKi8KKyAgICBjYXNlIDB4ODY6IC8qIEphY29ic3ZpbGxl
ICovCisKKyAgICAgICAgLyoKKyAgICAgICAgICogS25pZ2h0cyBwcm9jZXNz
b3JzIGFyZSBub3QgdnVsbmVyYWJsZS4KKyAgICAgICAgICovCisgICAgY2Fz
ZSAweDU3OiAvKiBLbmlnaHRzIExhbmRpbmcgKi8KKyAgICBjYXNlIDB4ODU6
IC8qIEtuaWdodHMgTWlsbCAqLworICAgICAgICByZXR1cm4gZmFsc2U7CisK
KyAgICBkZWZhdWx0OgorICAgICAgICBwcmludGsoIlVucmVjb2duaXNlZCBD
UFUgbW9kZWwgJSN4IC0gYXNzdW1pbmcgdnVsbmVyYWJsZSB0byBJRl9QU0NI
QU5HRV9NQ1xuIiwKKyAgICAgICAgICAgICAgIGJvb3RfY3B1X2RhdGEueDg2
X21vZGVsKTsKKyAgICAgICAgcmV0dXJuIHRydWU7CisgICAgfQorfQorCiBj
b25zdCBzdHJ1Y3QgaHZtX2Z1bmN0aW9uX3RhYmxlICogX19pbml0IHN0YXJ0
X3ZteCh2b2lkKQogewogICAgIHNldF9pbl9jcjQoWDg2X0NSNF9WTVhFKTsK
QEAgLTI1MTYsNiArMjYxMiwxNyBAQCBjb25zdCBzdHJ1Y3QgaHZtX2Z1bmN0
aW9uX3RhYmxlICogX19pbml0IHN0YXJ0X3ZteCh2b2lkKQogICAgICAqLwog
ICAgIGlmICggY3B1X2hhc192bXhfZXB0ICYmIChjcHVfaGFzX3ZteF9wYXQg
fHwgb3B0X2ZvcmNlX2VwdCkgKQogICAgIHsKKyAgICAgICAgYm9vbCBjcHVf
aGFzX2J1Z19wc2NoYW5nZV9tYyA9IGhhc19pZl9wc2NoYW5nZV9tYygpOwor
CisgICAgICAgIGlmICggb3B0X2VwdF9leGVjX3NwID09IC0xICkKKyAgICAg
ICAgeworICAgICAgICAgICAgLyogRGVmYXVsdCB0byBub24tZXhlY3V0YWJs
ZSBzdXBlcnBhZ2VzIG9uIHZ1bG5lcmFibGUgaGFyZHdhcmUuICovCisgICAg
ICAgICAgICBvcHRfZXB0X2V4ZWNfc3AgPSAhY3B1X2hhc19idWdfcHNjaGFu
Z2VfbWM7CisKKyAgICAgICAgICAgIGlmICggY3B1X2hhc19idWdfcHNjaGFu
Z2VfbWMgKQorICAgICAgICAgICAgICAgIHByaW50aygiVk1YOiBEaXNhYmxp
bmcgZXhlY3V0YWJsZSBFUFQgc3VwZXJwYWdlcyBkdWUgdG8gQ1ZFLTIwMTgt
MTIyMDdcbiIpOworICAgICAgICB9CisKICAgICAgICAgdm14X2Z1bmN0aW9u
X3RhYmxlLmhhcF9zdXBwb3J0ZWQgPSAxOwogICAgICAgICB2bXhfZnVuY3Rp
b25fdGFibGUuYWx0cDJtX3N1cHBvcnRlZCA9IDE7CiAKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0LmMgYi94ZW4vYXJjaC94ODYvbW0v
cDJtLWVwdC5jCmluZGV4IGVjYWI1NmZiZWMuLjM4MzcwNjJiMmMgMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0LmMKKysrIGIveGVuL2Fy
Y2gveDg2L21tL3AybS1lcHQuYwpAQCAtMjE1LDYgKzIxNSwxMiBAQCBzdGF0
aWMgdm9pZCBlcHRfcDJtX3R5cGVfdG9fZmxhZ3Moc3RydWN0IHAybV9kb21h
aW4gKnAybSwgZXB0X2VudHJ5X3QgKmVudHJ5LAogICAgICAgICAgICAgYnJl
YWs7CiAgICAgfQogICAgIAorICAgIC8qCisgICAgICogRG9uJ3QgY3JlYXRl
IGV4ZWN1dGFibGUgc3VwZXJwYWdlcyBpZiB3ZSBuZWVkIHRvIHNoYXR0ZXIg
dGhlbSB0bworICAgICAqIHByb3RlY3QgYWdhaW5zdCBDVkUtMjAxOC0xMjIw
Ny4KKyAgICAgKi8KKyAgICBpZiAoICFvcHRfZXB0X2V4ZWNfc3AgJiYgaXNf
ZXB0ZV9zdXBlcnBhZ2UoZW50cnkpICkKKyAgICAgICAgZW50cnktPnggPSAw
OwogfQogCiAjZGVmaW5lIEdVRVNUX1RBQkxFX01BUF9GQUlMRUQgIDAKZGlm
ZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZteC92bXguaCBi
L3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZteC92bXguaAppbmRleCA0ODg5
YTY0MjU1Li44ODQ1YzQ2NTBiIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9h
c20teDg2L2h2bS92bXgvdm14LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4
Ni9odm0vdm14L3ZteC5oCkBAIC0yOCw2ICsyOCw4IEBACiAjaW5jbHVkZSA8
YXNtL2h2bS90cmFjZS5oPgogI2luY2x1ZGUgPGFzbS9odm0vdm14L3ZtY3Mu
aD4KIAorZXh0ZXJuIGludDhfdCBvcHRfZXB0X2V4ZWNfc3A7CisKIHR5cGVk
ZWYgdW5pb24gewogICAgIHN0cnVjdCB7CiAgICAgICAgIHU2NCByICAgICAg
IDogICAxLCAgLyogYml0IDAgLSBSZWFkIHBlcm1pc3Npb24gKi8KZGlmZiAt
LWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLWluZGV4LmggYi94ZW4v
aW5jbHVkZS9hc20teDg2L21zci1pbmRleC5oCmluZGV4IDkyZDllZTc2YzIu
LjVlZjg5NGZmMjkgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYv
bXNyLWluZGV4LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3ItaW5k
ZXguaApAQCAtNTQsNiArNTQsNyBAQAogI2RlZmluZSBBUkNIX0NBUFNfU0tJ
UF9MMURGTAkJKF9BQygxLCBVTEwpIDw8IDMpCiAjZGVmaW5lIEFSQ0hfQ0FQ
U19TU0JfTk8JCShfQUMoMSwgVUxMKSA8PCA0KQogI2RlZmluZSBBUkNIX0NB
UFNfTURTX05PCQkoX0FDKDEsIFVMTCkgPDwgNSkKKyNkZWZpbmUgQVJDSF9D
QVBTX0lGX1BTQ0hBTkdFX01DX05PCShfQUMoMSwgVUxMKSA8PCA2KQogCiAj
ZGVmaW5lIE1TUl9GTFVTSF9DTUQJCQkweDAwMDAwMTBiCiAjZGVmaW5lIEZM
VVNIX0NNRF9MMUQJCQkoX0FDKDEsIFVMTCkgPDwgMCkK

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.10-1.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.10-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0ZDogSGlkZSBzdXBlcnBhZ2Ugc3VwcG9ydCBm
b3IgU2FuZHlCcmlkZ2UgSU9NTVVzCgpTb21ldGhpbmcgY2F1c2VzIFNhbmR5
QnJpZGdlIElPTU1VcyB0byBjaG9rZSB3aGVuIHNoYXJpbmcgRVBUIHBhZ2V0
YWJsZXMsIGFuZAphbiBFUFQgc3VwZXJwYWdlIGdldHMgc2hhdHRlcmVkLiAg
VGhlIHJvb3QgY2F1c2UgaXMgc3RpbGwgdW5kZXIgaW52ZXN0aWdhdGlvbiwK
YnV0IHRoZSBlbmQgcmVzdWx0IGlzIHVudXNhYmxlIGluIGNvbWJpbmF0aW9u
IHdpdGggQ1ZFLTIwMTgtMTIyMDcgcHJvdGVjdGlvbnMuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMwNCAvIENWRS0yMDE4LTEyMjA3CgpTaWduZWQtb2ZmLWJ5
OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRl
cm4uaCBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApp
bmRleCBmYjdlZGZhZWY5Li5kNjk4YjFkNTBhIDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZXh0ZXJuLmgKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCkBAIC05Niw2ICs5Niw4
IEBAIHZvaWQgdnRkX29wc19wb3N0YW1ibGVfcXVpcmsoc3RydWN0IGlvbW11
KiBpb21tdSk7CiBpbnQgX19tdXN0X2NoZWNrIG1lX3dpZmlfcXVpcmsoc3Ry
dWN0IGRvbWFpbiAqZG9tYWluLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU4IGJ1cywgdTggZGV2Zm4sIGludCBtYXApOwogdm9pZCBwY2lf
dnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICopOwordm9pZCBxdWly
a19pb21tdV9jYXBzKHN0cnVjdCBpb21tdSAqaW9tbXUpOworCiBib29sX3Qg
cGxhdGZvcm1fc3VwcG9ydHNfaW50cmVtYXAodm9pZCk7CiBib29sX3QgcGxh
dGZvcm1fc3VwcG9ydHNfeDJhcGljKHZvaWQpOwogCmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCmluZGV4IDI3OThhNDk5MDcu
LjE3Y2Y4N2NjZjEgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC9pb21tdS5jCkBAIC0xMjA1LDYgKzEyMDUsOCBAQCBpbnQgX19pbml0
IGlvbW11X2FsbG9jKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCkKICAg
ICBpZiAoICEoaW9tbXUtPmNhcCArIDEpIHx8ICEoaW9tbXUtPmVjYXAgKyAx
KSApCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogCisgICAgcXVpcmtfaW9t
bXVfY2Fwcyhpb21tdSk7CisKICAgICBpZiAoIGNhcF9mYXVsdF9yZWdfb2Zm
c2V0KGlvbW11LT5jYXApICsKICAgICAgICAgIGNhcF9udW1fZmF1bHRfcmVn
cyhpb21tdS0+Y2FwKSAqIFBSSU1BUllfRkFVTFRfUkVHX0xFTiA+PSBQQUdF
X1NJWkUgfHwKICAgICAgICAgIGVjYXBfaW90bGJfb2Zmc2V0KGlvbW11LT5l
Y2FwKSA+PSBQQUdFX1NJWkUgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL3F1aXJrcy5jCmluZGV4IGQ2ZGI4NjI2NzguLmIwMjY4OGUz
MTYgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9x
dWlya3MuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVp
cmtzLmMKQEAgLTU0MCwzICs1NDAsMjggQEAgdm9pZCBwY2lfdnRkX3F1aXJr
KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBicmVhazsK
ICAgICB9CiB9CisKK3ZvaWQgX19pbml0IHF1aXJrX2lvbW11X2NhcHMoc3Ry
dWN0IGlvbW11ICppb21tdSkKK3sKKyAgICAvKgorICAgICAqIElPTU1VIFF1
aXJrczoKKyAgICAgKgorICAgICAqIFNhbmR5QnJpZGdlIElPTU1VcyBjbGFp
bSBzdXBwb3J0IGZvciAyTSBhbmQgMUcgc3VwZXJwYWdlcywgYnV0IGRvbid0
CisgICAgICogaW1wbGVtZW50IHN1cGVycGFnZXMgaW50ZXJuYWxseS4KKyAg
ICAgKgorICAgICAqIFRoZXJlIGFyZSBpc3N1ZXMgY2hhbmdpbmcgdGhlIHdh
bGsgbGVuZ3RoIHVuZGVyIGluLWZsaWdodCBETUEsIHdoaWNoCisgICAgICog
aGFzIG1hbmlmZXN0ZWQgYXMgaW5jb21wYXRpYmlsaXR5IGJldHdlZW4gRVBU
L0lPTU1VIHNoYXJpbmcgYW5kIHRoZQorICAgICAqIHdvcmthcm91bmQgZm9y
IENWRS0yMDE4LTEyMjA3IC8gWFNBLTMwNC4gIEhpZGUgdGhlIHN1cGVycGFn
ZXMKKyAgICAgKiBjYXBhYmlsaXRpZXMgaW4gdGhlIElPTU1VLCB3aGljaCB3
aWxsIHByZXZlbnQgWGVuIGZyb20gc2hhcmluZyB0aGUgRVBUCisgICAgICog
YW5kIElPTU1VIHBhZ2V0YWJsZXMuCisgICAgICoKKyAgICAgKiBEZXRlY3Rp
b24gb2YgU2FuZHlCcmlkZ2UgdW5mb3J0dW5hdGVseSBoYXMgdG8gYmUgZG9u
ZSBieSBwcm9jZXNzb3IKKyAgICAgKiBtb2RlbCBiZWNhdXNlIHRoZSBjbGll
bnQgcGFydHMgZG9uJ3QgZXhwb3NlIHRoZWlyIElPTU1VcyBhcyBQQ0kgZGV2
aWNlcworICAgICAqIHdlIGNvdWxkIG1hdGNoIHdpdGggYSBEZXZpY2UgSUQu
CisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92ZW5kb3Ig
PT0gWDg2X1ZFTkRPUl9JTlRFTCAmJgorICAgICAgICAgYm9vdF9jcHVfZGF0
YS54ODYgPT0gNiAmJgorICAgICAgICAgKGJvb3RfY3B1X2RhdGEueDg2X21v
ZGVsID09IDB4MmEgfHwKKyAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCA9PSAweDJkKSApCisgICAgICAgIGlvbW11LT5jYXAgJj0gfigweGZ1
bCA8PCAzNCk7Cit9Cg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.10-2.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.10-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogRGlzYWJsZSBleGVjdXRhYmxlIEVQVCBz
dXBlcnBhZ2VzIHRvIHdvcmsgYXJvdW5kCiBDVkUtMjAxOC0xMjIwNwoKQ1ZF
LTIwMTgtMTIyMDcgY292ZXJzIGEgc2V0IG9mIGVycmF0YSBvbiB2YXJpb3Vz
IEludGVsIHByb2Nlc3NvcnMsIHdoZXJlYnkgYQptYWNoaW5lIGNoZWNrIGV4
Y2VwdGlvbiBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgY29ybmVyIGNhc2Ugd2hl
biBhbiBleGVjdXRhYmxlCm1hcHBpbmcgY2hhbmdlcyBzaXplIG9yIGNhY2hl
YWJpbGl0eSB3aXRob3V0IFRMQiBpbnZhbGlkYXRpb24uICBIVk0gZ3Vlc3QK
a2VybmVscyBjYW4gdHJpZ2dlciB0aGlzIHRvIERvUyB0aGUgaG9zdC4KClRv
IG1pdGlnYXRlLCBpbiBhZmZlY3RlZCBoYXJkd2FyZSwgYWxsIEVQVCBzdXBl
cnBhZ2VzIGFyZSBtYXJrZWQgTlguICBXaGVuIGFuCmluc3RydWN0aW9uIGZl
dGNoIHZpb2xhdGlvbiBpcyBvYnNlcnZlZCBhZ2FpbnN0IHRoZSBzdXBlcnBh
Z2UsIHRoZSBzdXBlcnBhZ2UKaXMgc2hhdHRlcmVkIHRvIDRrIGFuZCBoYXMg
ZXhlY3V0ZSBwZXJtaXNzaW9ucyByZXN0b3JlZC4gIFRoaXMgcHJldmVudHMg
dGhlCmd1ZXN0IGtlcm5lbCBmcm9tIGJlaW5nIGFibGUgdG8gY3JlYXRlIHRo
ZSBuZWNlc3NhcnkgcHJlY29uZGl0aW9ucyBpbiB0aGUgaVRMQgp0byBleHBs
b2l0IHRoZSB2dWxuZXJhYmlsaXR5LgoKVGhpcyBkb2VzIGNvbWUgd2l0aCBh
IHdvcmtsb2FkLWRlcGVuZGVudCBwZXJmb3JtYW5jZSBvdmVyaGVhZCwgY2F1
c2VkIGJ5CmluY3JlYXNlZCBUTEIgcHJlc3N1cmUuICBQZXJmb3JtYW5jZSBj
YW4gYmUgcmVzdG9yZWQsIGlmIGd1ZXN0IGtlcm5lbHMgYXJlCnRydXN0ZWQg
bm90IHRvIG1vdW50IGFuIGF0dGFjaywgYnkgc3BlY2lmeWluZyBlcHQ9ZXhl
Yy1zcCBvbiB0aGUgY29tbWFuZCBsaW5lLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3
IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2
aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jIGIveGVuL2FyY2gv
eDg2L2h2bS9odm0uYwppbmRleCBjMDcwMGRmYmZlLi42OThhYjYzMzQwIDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9odm0vaHZtLmMKQEAgLTE2OTUsNiArMTY5NSw3IEBAIGludCBo
dm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25l
ZCBsb25nIGdsYSwKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCAqaG9z
dHAybTsKICAgICBpbnQgcmMsIGZhbGxfdGhyb3VnaCA9IDAsIHBhZ2VkID0g
MDsKICAgICBpbnQgc2hhcmluZ19lbm9tZW0gPSAwOworICAgIHVuc2lnbmVk
IGludCBwYWdlX29yZGVyID0gMDsKICAgICB2bV9ldmVudF9yZXF1ZXN0X3Qg
KnJlcV9wdHIgPSBOVUxMOwogICAgIGJvb2xfdCBhcDJtX2FjdGl2ZSwgc3lu
YyA9IDA7CiAKQEAgLTE3NjMsNyArMTc2NCw3IEBAIGludCBodm1faGFwX25l
c3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBsb25nIGds
YSwKICAgICBob3N0cDJtID0gcDJtX2dldF9ob3N0cDJtKGN1cnJkKTsKICAg
ICBtZm4gPSBnZXRfZ2ZuX3R5cGVfYWNjZXNzKGhvc3RwMm0sIGdmbiwgJnAy
bXQsICZwMm1hLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUDJN
X0FMTE9DIHwgKG5wZmVjLndyaXRlX2FjY2VzcyA/IFAyTV9VTlNIQVJFIDog
MCksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZwYWdlX29yZGVyKTsKIAog
ICAgIGlmICggYXAybV9hY3RpdmUgKQogICAgIHsKQEAgLTE3NzUsNyArMTc3
Niw3IEBAIGludCBodm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3Qg
Z3BhLCB1bnNpZ25lZCBsb25nIGdsYSwKICAgICAgICAgICAgIGdvdG8gb3V0
OwogICAgICAgICB9CiAKLSAgICAgICAgbWZuID0gZ2V0X2dmbl90eXBlX2Fj
Y2VzcyhwMm0sIGdmbiwgJnAybXQsICZwMm1hLCAwLCBOVUxMKTsKKyAgICAg
ICAgbWZuID0gZ2V0X2dmbl90eXBlX2FjY2VzcyhwMm0sIGdmbiwgJnAybXQs
ICZwMm1hLCAwLCAmcGFnZV9vcmRlcik7CiAgICAgfQogICAgIGVsc2UKICAg
ICAgICAgcDJtID0gaG9zdHAybTsKQEAgLTE4MTcsNiArMTgxOCwyNCBAQCBp
bnQgaHZtX2hhcF9uZXN0ZWRfcGFnZV9mYXVsdChwYWRkcl90IGdwYSwgdW5z
aWduZWQgbG9uZyBnbGEsCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
fQogCisgICAgICAgIC8qCisgICAgICAgICAqIFdvcmthcm91bmQgZm9yIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNy4gIElmIHdlIHRha2UgYW4gZXhlY3V0
aW9uCisgICAgICAgICAqIGZhdWx0IGFnYWluc3QgYSBub24tZXhlY3V0YWJs
ZSBzdXBlcnBhZ2UsIHNoYXR0ZXIgaXQgdG8gcmVnYWluCisgICAgICAgICAq
IGV4ZWN1dGUgcGVybWlzc2lvbnMuCisgICAgICAgICAqLworICAgICAgICBp
ZiAoIHBhZ2Vfb3JkZXIgPiAwICYmIG5wZmVjLmluc25fZmV0Y2ggJiYgbnBm
ZWMucHJlc2VudCAmJiAhdmlvbGF0aW9uICkKKyAgICAgICAgeworICAgICAg
ICAgICAgaW50IHJlcyA9IHAybV9zZXRfZW50cnkocDJtLCBfZ2ZuKGdmbiks
IG1mbiwgUEFHRV9PUkRFUl80SywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAybXQsIHAybWEpOworCisgICAgICAgICAgICBpZiAo
IHJlcyApCisgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIkZh
aWxlZCB0byBzaGF0dGVyIGdmbiAlIlBSSV9nZm4iOiAlZFxuIiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgZ2ZuLCByZXMpOworCisgICAgICAgICAgICBy
YyA9ICFyZXM7CisgICAgICAgICAgICBnb3RvIG91dF9wdXRfZ2ZuOworICAg
ICAgICB9CisKICAgICAgICAgaWYgKCB2aW9sYXRpb24gKQogICAgICAgICB7
CiAgICAgICAgICAgICAvKiBTaG91bGQgI1ZFIGJlIGVtdWxhdGVkIGZvciB0
aGlzIGZhdWx0PyAqLwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS92
bXgvdm1jcy5jIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5jCmluZGV4
IDIwNWYyMzA3YzIuLjI3MDUwYzA4NzcgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9odm0vdm14L3ZtY3MuYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3Zt
eC92bWNzLmMKQEAgLTY3LDYgKzY3LDcgQEAgaW50ZWdlcl9wYXJhbSgicGxl
X3dpbmRvdyIsIHBsZV93aW5kb3cpOwogCiBzdGF0aWMgYm9vbF90IF9fcmVh
ZF9tb3N0bHkgb3B0X3BtbF9lbmFibGVkID0gMTsKIHN0YXRpYyBzOCBfX3Jl
YWRfbW9zdGx5IG9wdF9lcHRfYWQgPSAtMTsKK2ludDhfdCBfX3JlYWRfbW9z
dGx5IG9wdF9lcHRfZXhlY19zcCA9IC0xOwogCiAvKgogICogVGhlICdlcHQn
IHBhcmFtZXRlciBjb250cm9scyBmdW5jdGlvbmFsaXRpZXMgdGhhdCBkZXBl
bmQgb24sIG9yIGltcGFjdCB0aGUKQEAgLTk0LDYgKzk1LDggQEAgc3RhdGlj
IGludCBfX2luaXQgcGFyc2VfZXB0X3BhcmFtKGNvbnN0IGNoYXIgKnMpCiAg
ICAgICAgICAgICBvcHRfcG1sX2VuYWJsZWQgPSB2YWw7CiAgICAgICAgIGVs
c2UgaWYgKCAhY21kbGluZV9zdHJjbXAocywgImFkIikgKQogICAgICAgICAg
ICAgb3B0X2VwdF9hZCA9IHZhbDsKKyAgICAgICAgZWxzZSBpZiAoICFjbWRs
aW5lX3N0cmNtcChzLCAiZXhlYy1zcCIpICkKKyAgICAgICAgICAgIG9wdF9l
cHRfZXhlY19zcCA9IHZhbDsKICAgICAgICAgZWxzZQogICAgICAgICAgICAg
cmMgPSAtRUlOVkFMOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZt
L3ZteC92bXguYyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jCmluZGV4
IGZhMWUwMzA5YzcuLjkyODVjMmIyZmEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNo
L3g4Ni9odm0vdm14L3ZteC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14
L3ZteC5jCkBAIC0yNDkwLDYgKzI0OTAsMTAyIEBAIHN0YXRpYyB2b2lkIHBp
X25vdGlmaWNhdGlvbl9pbnRlcnJ1cHQoc3RydWN0IGNwdV91c2VyX3JlZ3Mg
KnJlZ3MpCiBzdGF0aWMgdm9pZCBfX2luaXQgbGJyX3RzeF9maXh1cF9jaGVj
ayh2b2lkKTsKIHN0YXRpYyB2b2lkIF9faW5pdCBiZHdfZXJyYXR1bV9iZGYx
NF9maXh1cF9jaGVjayh2b2lkKTsKIAorLyoKKyAqIENhbGN1bGF0ZSB3aGV0
aGVyIHRoZSBDUFUgaXMgdnVsbmVyYWJsZSB0byBJbnN0cnVjdGlvbiBGZXRj
aCBwYWdlCisgKiBzaXplLWNoYW5nZSBNQ0VzLgorICovCitzdGF0aWMgYm9v
bCBfX2luaXQgaGFzX2lmX3BzY2hhbmdlX21jKHZvaWQpCit7CisgICAgdWlu
dDY0X3QgY2FwcyA9IDA7CisKKyAgICAvKgorICAgICAqIElmIHdlIGFyZSB2
aXJ0dWFsaXNlZCwgdGhlcmUgaXMgbm90aGluZyB3ZSBjYW4gZG8uICBPdXIg
RVBUIHRhYmxlcyBhcmUKKyAgICAgKiBzaGFkb3dlZCBieSBvdXIgaHlwZXJ2
aXNvciwgYW5kIG5vdCB3YWxrZWQgYnkgaGFyZHdhcmUuCisgICAgICovCisg
ICAgaWYgKCBjcHVfaGFzX2h5cGVydmlzb3IgKQorICAgICAgICByZXR1cm4g
ZmFsc2U7CisKKyAgICBpZiAoIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9B
UkNIX0NBUFMpICkKKyAgICAgICAgcmRtc3JsKE1TUl9BUkNIX0NBUEFCSUxJ
VElFUywgY2Fwcyk7CisKKyAgICBpZiAoIGNhcHMgJiBBUkNIX0NBUFNfSUZf
UFNDSEFOR0VfTUNfTk8gKQorICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAg
ICAvKgorICAgICAqIElGX1BTQ0hBTkdFX01DIGlzIG9ubHkga25vd24gdG8g
YWZmZWN0IEludGVsIEZhbWlseSA2IHByb2Nlc3NvcnMgYXQKKyAgICAgKiB0
aGlzIHRpbWUuCisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4
Nl92ZW5kb3IgIT0gWDg2X1ZFTkRPUl9JTlRFTCB8fAorICAgICAgICAgYm9v
dF9jcHVfZGF0YS54ODYgIT0gNiApCisgICAgICAgIHJldHVybiBmYWxzZTsK
KworICAgIHN3aXRjaCAoIGJvb3RfY3B1X2RhdGEueDg2X21vZGVsICkKKyAg
ICB7CisgICAgICAgIC8qCisgICAgICAgICAqIENvcmUgcHJvY2Vzc29ycyBz
aW5jZSBhdCBsZWFzdCBOZWhhbGVtIGFyZSB2dWxuZXJhYmxlLgorICAgICAg
ICAgKi8KKyAgICBjYXNlIDB4MWY6IC8qIEF1YnVybmRhbGUgLyBIYXZlbmRh
bGUgKi8KKyAgICBjYXNlIDB4MWU6IC8qIE5laGFsZW0gKi8KKyAgICBjYXNl
IDB4MWE6IC8qIE5laGFsZW0gRVAgKi8KKyAgICBjYXNlIDB4MmU6IC8qIE5l
aGFsZW0gRVggKi8KKyAgICBjYXNlIDB4MjU6IC8qIFdlc3RtZXJlICovCisg
ICAgY2FzZSAweDJjOiAvKiBXZXN0bWVyZSBFUCAqLworICAgIGNhc2UgMHgy
ZjogLyogV2VzdG1lcmUgRVggKi8KKyAgICBjYXNlIDB4MmE6IC8qIFNhbmR5
QnJpZGdlICovCisgICAgY2FzZSAweDJkOiAvKiBTYW5keUJyaWRnZSBFUC9F
WCAqLworICAgIGNhc2UgMHgzYTogLyogSXZ5QnJpZGdlICovCisgICAgY2Fz
ZSAweDNlOiAvKiBJdnlCcmlkZ2UgRVAvRVggKi8KKyAgICBjYXNlIDB4M2M6
IC8qIEhhc3dlbGwgKi8KKyAgICBjYXNlIDB4M2Y6IC8qIEhhc3dlbGwgRVgv
RVAgKi8KKyAgICBjYXNlIDB4NDU6IC8qIEhhc3dlbGwgRCAqLworICAgIGNh
c2UgMHg0NjogLyogSGFzd2VsbCBIICovCisgICAgY2FzZSAweDNkOiAvKiBC
cm9hZHdlbGwgKi8KKyAgICBjYXNlIDB4NDc6IC8qIEJyb2Fkd2VsbCBIICov
CisgICAgY2FzZSAweDRmOiAvKiBCcm9hZHdlbGwgRVAvRVggKi8KKyAgICBj
YXNlIDB4NTY6IC8qIEJyb2Fkd2VsbCBEICovCisgICAgY2FzZSAweDRlOiAv
KiBTa3lsYWtlIE0gKi8KKyAgICBjYXNlIDB4NWU6IC8qIFNreWxha2UgRCAq
LworICAgIGNhc2UgMHg1NTogLyogU2t5bGFrZS1YIC8gQ2FzY2FkZSBMYWtl
ICovCisgICAgY2FzZSAweDhlOiAvKiBLYWJ5IC8gQ29mZmVlIC8gV2hpc2tl
eSBMYWtlIE0gKi8KKyAgICBjYXNlIDB4OWU6IC8qIEthYnkgLyBDb2ZmZWUg
LyBXaGlza2V5IExha2UgRCAqLworICAgICAgICByZXR1cm4gdHJ1ZTsKKwor
ICAgICAgICAvKgorICAgICAgICAgKiBBdG9tIHByb2Nlc3NvcnMgYXJlIG5v
dCB2dWxuZXJhYmxlLgorICAgICAgICAgKi8KKyAgICBjYXNlIDB4MWM6IC8q
IFBpbmV2aWV3ICovCisgICAgY2FzZSAweDI2OiAvKiBMaW5jcm9mdCAqLwor
ICAgIGNhc2UgMHgyNzogLyogUGVud2VsbCAqLworICAgIGNhc2UgMHgzNTog
LyogQ2xvdmVydmlldyAqLworICAgIGNhc2UgMHgzNjogLyogQ2VkYXJ2aWV3
ICovCisgICAgY2FzZSAweDM3OiAvKiBCYXl0cmFpbCAvIFZhbGxleXZpZXcg
KFNpbHZlcm1vbnQpICovCisgICAgY2FzZSAweDRkOiAvKiBBdmF0b24gLyBS
YW5nZWx5IChTaWx2ZXJtb250KSAqLworICAgIGNhc2UgMHg0YzogLyogQ2hl
cnJ5dHJhaWwgLyBCcmFzc3dlbGwgKi8KKyAgICBjYXNlIDB4NGE6IC8qIE1l
cnJpZmllbGQgKi8KKyAgICBjYXNlIDB4NWE6IC8qIE1vb3JlZmllbGQgKi8K
KyAgICBjYXNlIDB4NWM6IC8qIEdvbGRtb250ICovCisgICAgY2FzZSAweDVk
OiAvKiBTb0ZJQSAzRyBHcmFuaXRlL0VTMi4xICovCisgICAgY2FzZSAweDY1
OiAvKiBTb0ZJQSBMVEUgQU9TUCAqLworICAgIGNhc2UgMHg1ZjogLyogRGVu
dmVydG9uICovCisgICAgY2FzZSAweDZlOiAvKiBDb3VnYXIgTW91bnRhaW4g
Ki8KKyAgICBjYXNlIDB4NzU6IC8qIExpZ2h0bmluZyBNb3VudGFpbiAqLwor
ICAgIGNhc2UgMHg3YTogLyogR2VtaW5pIExha2UgKi8KKyAgICBjYXNlIDB4
ODY6IC8qIEphY29ic3ZpbGxlICovCisKKyAgICAgICAgLyoKKyAgICAgICAg
ICogS25pZ2h0cyBwcm9jZXNzb3JzIGFyZSBub3QgdnVsbmVyYWJsZS4KKyAg
ICAgICAgICovCisgICAgY2FzZSAweDU3OiAvKiBLbmlnaHRzIExhbmRpbmcg
Ki8KKyAgICBjYXNlIDB4ODU6IC8qIEtuaWdodHMgTWlsbCAqLworICAgICAg
ICByZXR1cm4gZmFsc2U7CisKKyAgICBkZWZhdWx0OgorICAgICAgICBwcmlu
dGsoIlVucmVjb2duaXNlZCBDUFUgbW9kZWwgJSN4IC0gYXNzdW1pbmcgdnVs
bmVyYWJsZSB0byBJRl9QU0NIQU5HRV9NQ1xuIiwKKyAgICAgICAgICAgICAg
IGJvb3RfY3B1X2RhdGEueDg2X21vZGVsKTsKKyAgICAgICAgcmV0dXJuIHRy
dWU7CisgICAgfQorfQorCiBjb25zdCBzdHJ1Y3QgaHZtX2Z1bmN0aW9uX3Rh
YmxlICogX19pbml0IHN0YXJ0X3ZteCh2b2lkKQogewogICAgIHNldF9pbl9j
cjQoWDg2X0NSNF9WTVhFKTsKQEAgLTI1MTAsNiArMjYwNiwxNyBAQCBjb25z
dCBzdHJ1Y3QgaHZtX2Z1bmN0aW9uX3RhYmxlICogX19pbml0IHN0YXJ0X3Zt
eCh2b2lkKQogICAgICAqLwogICAgIGlmICggY3B1X2hhc192bXhfZXB0ICYm
IChjcHVfaGFzX3ZteF9wYXQgfHwgb3B0X2ZvcmNlX2VwdCkgKQogICAgIHsK
KyAgICAgICAgYm9vbCBjcHVfaGFzX2J1Z19wc2NoYW5nZV9tYyA9IGhhc19p
Zl9wc2NoYW5nZV9tYygpOworCisgICAgICAgIGlmICggb3B0X2VwdF9leGVj
X3NwID09IC0xICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogRGVmYXVs
dCB0byBub24tZXhlY3V0YWJsZSBzdXBlcnBhZ2VzIG9uIHZ1bG5lcmFibGUg
aGFyZHdhcmUuICovCisgICAgICAgICAgICBvcHRfZXB0X2V4ZWNfc3AgPSAh
Y3B1X2hhc19idWdfcHNjaGFuZ2VfbWM7CisKKyAgICAgICAgICAgIGlmICgg
Y3B1X2hhc19idWdfcHNjaGFuZ2VfbWMgKQorICAgICAgICAgICAgICAgIHBy
aW50aygiVk1YOiBEaXNhYmxpbmcgZXhlY3V0YWJsZSBFUFQgc3VwZXJwYWdl
cyBkdWUgdG8gQ1ZFLTIwMTgtMTIyMDdcbiIpOworICAgICAgICB9CisKICAg
ICAgICAgdm14X2Z1bmN0aW9uX3RhYmxlLmhhcF9zdXBwb3J0ZWQgPSAxOwog
ICAgICAgICB2bXhfZnVuY3Rpb25fdGFibGUuYWx0cDJtX3N1cHBvcnRlZCA9
IDE7CiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0LmMg
Yi94ZW4vYXJjaC94ODYvbW0vcDJtLWVwdC5jCmluZGV4IGI0OTk2Y2U2NTgu
LjQyNGQ0MmM5M2QgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0t
ZXB0LmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1lcHQuYwpAQCAtMjE1
LDYgKzIxNSwxMiBAQCBzdGF0aWMgdm9pZCBlcHRfcDJtX3R5cGVfdG9fZmxh
Z3Moc3RydWN0IHAybV9kb21haW4gKnAybSwgZXB0X2VudHJ5X3QgKmVudHJ5
LAogICAgICAgICAgICAgYnJlYWs7CiAgICAgfQogICAgIAorICAgIC8qCisg
ICAgICogRG9uJ3QgY3JlYXRlIGV4ZWN1dGFibGUgc3VwZXJwYWdlcyBpZiB3
ZSBuZWVkIHRvIHNoYXR0ZXIgdGhlbSB0bworICAgICAqIHByb3RlY3QgYWdh
aW5zdCBDVkUtMjAxOC0xMjIwNy4KKyAgICAgKi8KKyAgICBpZiAoICFvcHRf
ZXB0X2V4ZWNfc3AgJiYgaXNfZXB0ZV9zdXBlcnBhZ2UoZW50cnkpICkKKyAg
ICAgICAgZW50cnktPnggPSAwOwogfQogCiAjZGVmaW5lIEdVRVNUX1RBQkxF
X01BUF9GQUlMRUQgIDAKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14
ODYvaHZtL3ZteC92bXguaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3Zt
eC92bXguaAppbmRleCA3MzQxY2IxOTFlLi5hYWQyNTMzNWViIDEwMDY0NAot
LS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS92bXgvdm14LmgKKysrIGIv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vdm14L3ZteC5oCkBAIC0yOCw2ICsy
OCw4IEBACiAjaW5jbHVkZSA8YXNtL2h2bS90cmFjZS5oPgogI2luY2x1ZGUg
PGFzbS9odm0vdm14L3ZtY3MuaD4KIAorZXh0ZXJuIGludDhfdCBvcHRfZXB0
X2V4ZWNfc3A7CisKIHR5cGVkZWYgdW5pb24gewogICAgIHN0cnVjdCB7CiAg
ICAgICAgIHU2NCByICAgICAgIDogICAxLCAgLyogYml0IDAgLSBSZWFkIHBl
cm1pc3Npb24gKi8KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYv
bXNyLWluZGV4LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21zci1pbmRleC5o
CmluZGV4IGU2MWFhYzJmNTEuLjQ3ZTdjNDEyZjIgMTAwNjQ0Ci0tLSBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbXNyLWluZGV4LmgKKysrIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9tc3ItaW5kZXguaApAQCAtNTQsNiArNTQsNyBAQAogI2Rl
ZmluZSBBUkNIX0NBUFNfU0tJUF9MMURGTAkJKF9BQygxLCBVTEwpIDw8IDMp
CiAjZGVmaW5lIEFSQ0hfQ0FQU19TU0JfTk8JCShfQUMoMSwgVUxMKSA8PCA0
KQogI2RlZmluZSBBUkNIX0NBUFNfTURTX05PCQkoX0FDKDEsIFVMTCkgPDwg
NSkKKyNkZWZpbmUgQVJDSF9DQVBTX0lGX1BTQ0hBTkdFX01DX05PCShfQUMo
MSwgVUxMKSA8PCA2KQogCiAjZGVmaW5lIE1TUl9GTFVTSF9DTUQJCQkweDAw
MDAwMTBiCiAjZGVmaW5lIEZMVVNIX0NNRF9MMUQJCQkoX0FDKDEsIFVMTCkg
PDwgMCkK

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.10-3.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.10-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogQWxsb3cgcnVudGltZSBtb2RpZmljYXRp
b24gb2YgdGhlIGV4ZWMtc3Agc2V0dGluZwoKU2VlIHBhdGNoIGZvciBkZXRh
aWxzLgoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvaHZtL3ZteC92bWNzLmMgYi94ZW4vYXJjaC94ODYvaHZtL3Zt
eC92bWNzLmMKaW5kZXggMjcwNTBjMDg3Ny4uM2MyOWI3YzQ2ZiAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5jCisrKyBiL3hlbi9h
cmNoL3g4Ni9odm0vdm14L3ZtY3MuYwpAQCAtMTA3LDYgKzEwNyw0MSBAQCBz
dGF0aWMgaW50IF9faW5pdCBwYXJzZV9lcHRfcGFyYW0oY29uc3QgY2hhciAq
cykKIH0KIGN1c3RvbV9wYXJhbSgiZXB0IiwgcGFyc2VfZXB0X3BhcmFtKTsK
IAorc3RhdGljIGludCBwYXJzZV9lcHRfcGFyYW1fcnVudGltZShjb25zdCBj
aGFyICpzKQoreworICAgIGludCB2YWw7CisKKyAgICBpZiAoICFjcHVfaGFz
X3ZteF9lcHQgfHwgIWh2bV9mdW5jcy5oYXBfc3VwcG9ydGVkIHx8CisgICAg
ICAgICAhKGh2bV9mdW5jcy5oYXBfY2FwYWJpbGl0aWVzICYKKyAgICAgICAg
ICAgKEhWTV9IQVBfU1VQRVJQQUdFXzJNQiB8IEhWTV9IQVBfU1VQRVJQQUdF
XzFHQikpICkKKyAgICB7CisgICAgICAgIHByaW50aygiVk1YOiBFUFQgbm90
IGF2YWlsYWJsZSwgb3Igbm90IGluIHVzZSAtIGlnbm9yaW5nXG4iKTsKKyAg
ICAgICAgcmV0dXJuIDA7CisgICAgfQorCisgICAgaWYgKCAodmFsID0gcGFy
c2VfYm9vbGVhbigiZXhlYy1zcCIsIHMsIE5VTEwpKSA8IDAgKQorICAgICAg
ICByZXR1cm4gLUVJTlZBTDsKKworICAgIGlmICggdmFsICE9IG9wdF9lcHRf
ZXhlY19zcCApCisgICAgeworICAgICAgICBzdHJ1Y3QgZG9tYWluICpkOwor
CisgICAgICAgIG9wdF9lcHRfZXhlY19zcCA9IHZhbDsKKworICAgICAgICBy
Y3VfcmVhZF9sb2NrKCZkb21saXN0X3JlYWRfbG9jayk7CisgICAgICAgIGZv
cl9lYWNoX2RvbWFpbiAoIGQgKQorICAgICAgICAgICAgaWYgKCBwYWdpbmdf
bW9kZV9oYXAoZCkgKQorICAgICAgICAgICAgICAgIHAybV9jaGFuZ2VfZW50
cnlfdHlwZV9nbG9iYWwoZCwgcDJtX3JhbV9ydywgcDJtX3JhbV9ydyk7Cisg
ICAgICAgIHJjdV9yZWFkX3VubG9jaygmZG9tbGlzdF9yZWFkX2xvY2spOwor
ICAgIH0KKworICAgIHByaW50aygiVk1YOiBFUFQgZXhlY3V0YWJsZSBzdXBl
cnBhZ2VzICVzYWJsZWRcbiIsCisgICAgICAgICAgIHZhbCA/ICJlbiIgOiAi
ZGlzIik7CisKKyAgICByZXR1cm4gMDsKK30KK2N1c3RvbV9ydW50aW1lX29u
bHlfcGFyYW0oImVwdCIsIHBhcnNlX2VwdF9wYXJhbV9ydW50aW1lKTsKKwog
LyogRHluYW1pYyAocnVuLXRpbWUgYWRqdXN0ZWQpIGV4ZWN1dGlvbiBjb250
cm9sIGZsYWdzLiAqLwogdTMyIHZteF9waW5fYmFzZWRfZXhlY19jb250cm9s
IF9fcmVhZF9tb3N0bHk7CiB1MzIgdm14X2NwdV9iYXNlZF9leGVjX2NvbnRy
b2wgX19yZWFkX21vc3RseTsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9t
bS9wMm0uYyBiL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwppbmRleCA3YTUyYmE5
OTNlLi40MTZlNzdiMDNjIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0v
cDJtLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS5jCkBAIC0yNjMsMTcg
KzI2MywyMiBAQCBpbnQgcDJtX2lzX2xvZ2RpcnR5X3JhbmdlKHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcgc3RhcnQsCiAgICAgcmV0
dXJuIDA7CiB9CiAKKy8qCisgKiBNYXkgYmUgY2FsbGVkIHdpdGggb3QgPSBu
dCA9IHAybV9yYW1fcncgZm9yIGl0cyBzaWRlIGVmZmVjdCBvZgorICogcmVj
YWxjdWxhdGluZyBhbGwgUFRFcyBpbiB0aGUgcDJtLgorICovCiB2b2lkIHAy
bV9jaGFuZ2VfZW50cnlfdHlwZV9nbG9iYWwoc3RydWN0IGRvbWFpbiAqZCwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm1fdHlwZV90
IG90LCBwMm1fdHlwZV90IG50KQogewogICAgIHN0cnVjdCBwMm1fZG9tYWlu
ICpwMm0gPSBwMm1fZ2V0X2hvc3RwMm0oZCk7CiAKLSAgICBBU1NFUlQob3Qg
IT0gbnQpOwogICAgIEFTU0VSVChwMm1faXNfY2hhbmdlYWJsZShvdCkgJiYg
cDJtX2lzX2NoYW5nZWFibGUobnQpKTsKIAogICAgIHAybV9sb2NrKHAybSk7
CiAgICAgcDJtLT5jaGFuZ2VfZW50cnlfdHlwZV9nbG9iYWwocDJtLCBvdCwg
bnQpOwotICAgIHAybS0+Z2xvYmFsX2xvZ2RpcnR5ID0gKG50ID09IHAybV9y
YW1fbG9nZGlydHkpOworICAgIC8qIERvbid0IGFsbG93ICdyZWNhbGN1bGF0
ZScgb3BlcmF0aW9ucyB0byBjaGFuZ2UgdGhlIGxvZ2RpcnR5IHN0YXRlLiAq
LworICAgIGlmICggb3QgIT0gbnQgKQorICAgICAgICBwMm0tPmdsb2JhbF9s
b2dkaXJ0eSA9IChudCA9PSBwMm1fcmFtX2xvZ2RpcnR5KTsKICAgICBwMm1f
dW5sb2NrKHAybSk7CiB9CiAK

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.11-1.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0ZDogSGlkZSBzdXBlcnBhZ2Ugc3VwcG9ydCBm
b3IgU2FuZHlCcmlkZ2UgSU9NTVVzCgpTb21ldGhpbmcgY2F1c2VzIFNhbmR5
QnJpZGdlIElPTU1VcyB0byBjaG9rZSB3aGVuIHNoYXJpbmcgRVBUIHBhZ2V0
YWJsZXMsIGFuZAphbiBFUFQgc3VwZXJwYWdlIGdldHMgc2hhdHRlcmVkLiAg
VGhlIHJvb3QgY2F1c2UgaXMgc3RpbGwgdW5kZXIgaW52ZXN0aWdhdGlvbiwK
YnV0IHRoZSBlbmQgcmVzdWx0IGlzIHVudXNhYmxlIGluIGNvbWJpbmF0aW9u
IHdpdGggQ1ZFLTIwMTgtMTIyMDcgcHJvdGVjdGlvbnMuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMwNCAvIENWRS0yMDE4LTEyMjA3CgpTaWduZWQtb2ZmLWJ5
OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRl
cm4uaCBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApp
bmRleCBmYjdlZGZhZWY5Li5kNjk4YjFkNTBhIDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZXh0ZXJuLmgKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCkBAIC05Niw2ICs5Niw4
IEBAIHZvaWQgdnRkX29wc19wb3N0YW1ibGVfcXVpcmsoc3RydWN0IGlvbW11
KiBpb21tdSk7CiBpbnQgX19tdXN0X2NoZWNrIG1lX3dpZmlfcXVpcmsoc3Ry
dWN0IGRvbWFpbiAqZG9tYWluLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU4IGJ1cywgdTggZGV2Zm4sIGludCBtYXApOwogdm9pZCBwY2lf
dnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICopOwordm9pZCBxdWly
a19pb21tdV9jYXBzKHN0cnVjdCBpb21tdSAqaW9tbXUpOworCiBib29sX3Qg
cGxhdGZvcm1fc3VwcG9ydHNfaW50cmVtYXAodm9pZCk7CiBib29sX3QgcGxh
dGZvcm1fc3VwcG9ydHNfeDJhcGljKHZvaWQpOwogCmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCmluZGV4IGYyNDJlMzBjYWYu
Ljg3MTJkM2I0ZGMgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC9pb21tdS5jCkBAIC0xMjExLDYgKzEyMTEsOCBAQCBpbnQgX19pbml0
IGlvbW11X2FsbG9jKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCkKICAg
ICBpZiAoICEoaW9tbXUtPmNhcCArIDEpIHx8ICEoaW9tbXUtPmVjYXAgKyAx
KSApCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogCisgICAgcXVpcmtfaW9t
bXVfY2Fwcyhpb21tdSk7CisKICAgICBpZiAoIGNhcF9mYXVsdF9yZWdfb2Zm
c2V0KGlvbW11LT5jYXApICsKICAgICAgICAgIGNhcF9udW1fZmF1bHRfcmVn
cyhpb21tdS0+Y2FwKSAqIFBSSU1BUllfRkFVTFRfUkVHX0xFTiA+PSBQQUdF
X1NJWkUgfHwKICAgICAgICAgIGVjYXBfaW90bGJfb2Zmc2V0KGlvbW11LT5l
Y2FwKSA+PSBQQUdFX1NJWkUgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL3F1aXJrcy5jCmluZGV4IGQ2ZGI4NjI2NzguLmIwMjY4OGUz
MTYgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9x
dWlya3MuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVp
cmtzLmMKQEAgLTU0MCwzICs1NDAsMjggQEAgdm9pZCBwY2lfdnRkX3F1aXJr
KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBicmVhazsK
ICAgICB9CiB9CisKK3ZvaWQgX19pbml0IHF1aXJrX2lvbW11X2NhcHMoc3Ry
dWN0IGlvbW11ICppb21tdSkKK3sKKyAgICAvKgorICAgICAqIElPTU1VIFF1
aXJrczoKKyAgICAgKgorICAgICAqIFNhbmR5QnJpZGdlIElPTU1VcyBjbGFp
bSBzdXBwb3J0IGZvciAyTSBhbmQgMUcgc3VwZXJwYWdlcywgYnV0IGRvbid0
CisgICAgICogaW1wbGVtZW50IHN1cGVycGFnZXMgaW50ZXJuYWxseS4KKyAg
ICAgKgorICAgICAqIFRoZXJlIGFyZSBpc3N1ZXMgY2hhbmdpbmcgdGhlIHdh
bGsgbGVuZ3RoIHVuZGVyIGluLWZsaWdodCBETUEsIHdoaWNoCisgICAgICog
aGFzIG1hbmlmZXN0ZWQgYXMgaW5jb21wYXRpYmlsaXR5IGJldHdlZW4gRVBU
L0lPTU1VIHNoYXJpbmcgYW5kIHRoZQorICAgICAqIHdvcmthcm91bmQgZm9y
IENWRS0yMDE4LTEyMjA3IC8gWFNBLTMwNC4gIEhpZGUgdGhlIHN1cGVycGFn
ZXMKKyAgICAgKiBjYXBhYmlsaXRpZXMgaW4gdGhlIElPTU1VLCB3aGljaCB3
aWxsIHByZXZlbnQgWGVuIGZyb20gc2hhcmluZyB0aGUgRVBUCisgICAgICog
YW5kIElPTU1VIHBhZ2V0YWJsZXMuCisgICAgICoKKyAgICAgKiBEZXRlY3Rp
b24gb2YgU2FuZHlCcmlkZ2UgdW5mb3J0dW5hdGVseSBoYXMgdG8gYmUgZG9u
ZSBieSBwcm9jZXNzb3IKKyAgICAgKiBtb2RlbCBiZWNhdXNlIHRoZSBjbGll
bnQgcGFydHMgZG9uJ3QgZXhwb3NlIHRoZWlyIElPTU1VcyBhcyBQQ0kgZGV2
aWNlcworICAgICAqIHdlIGNvdWxkIG1hdGNoIHdpdGggYSBEZXZpY2UgSUQu
CisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92ZW5kb3Ig
PT0gWDg2X1ZFTkRPUl9JTlRFTCAmJgorICAgICAgICAgYm9vdF9jcHVfZGF0
YS54ODYgPT0gNiAmJgorICAgICAgICAgKGJvb3RfY3B1X2RhdGEueDg2X21v
ZGVsID09IDB4MmEgfHwKKyAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCA9PSAweDJkKSApCisgICAgICAgIGlvbW11LT5jYXAgJj0gfigweGZ1
bCA8PCAzNCk7Cit9Cg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.11-2.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogRGlzYWJsZSBleGVjdXRhYmxlIEVQVCBz
dXBlcnBhZ2VzIHRvIHdvcmsgYXJvdW5kCiBDVkUtMjAxOC0xMjIwNwoKQ1ZF
LTIwMTgtMTIyMDcgY292ZXJzIGEgc2V0IG9mIGVycmF0YSBvbiB2YXJpb3Vz
IEludGVsIHByb2Nlc3NvcnMsIHdoZXJlYnkgYQptYWNoaW5lIGNoZWNrIGV4
Y2VwdGlvbiBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgY29ybmVyIGNhc2Ugd2hl
biBhbiBleGVjdXRhYmxlCm1hcHBpbmcgY2hhbmdlcyBzaXplIG9yIGNhY2hl
YWJpbGl0eSB3aXRob3V0IFRMQiBpbnZhbGlkYXRpb24uICBIVk0gZ3Vlc3QK
a2VybmVscyBjYW4gdHJpZ2dlciB0aGlzIHRvIERvUyB0aGUgaG9zdC4KClRv
IG1pdGlnYXRlLCBpbiBhZmZlY3RlZCBoYXJkd2FyZSwgYWxsIEVQVCBzdXBl
cnBhZ2VzIGFyZSBtYXJrZWQgTlguICBXaGVuIGFuCmluc3RydWN0aW9uIGZl
dGNoIHZpb2xhdGlvbiBpcyBvYnNlcnZlZCBhZ2FpbnN0IHRoZSBzdXBlcnBh
Z2UsIHRoZSBzdXBlcnBhZ2UKaXMgc2hhdHRlcmVkIHRvIDRrIGFuZCBoYXMg
ZXhlY3V0ZSBwZXJtaXNzaW9ucyByZXN0b3JlZC4gIFRoaXMgcHJldmVudHMg
dGhlCmd1ZXN0IGtlcm5lbCBmcm9tIGJlaW5nIGFibGUgdG8gY3JlYXRlIHRo
ZSBuZWNlc3NhcnkgcHJlY29uZGl0aW9ucyBpbiB0aGUgaVRMQgp0byBleHBs
b2l0IHRoZSB2dWxuZXJhYmlsaXR5LgoKVGhpcyBkb2VzIGNvbWUgd2l0aCBh
IHdvcmtsb2FkLWRlcGVuZGVudCBwZXJmb3JtYW5jZSBvdmVyaGVhZCwgY2F1
c2VkIGJ5CmluY3JlYXNlZCBUTEIgcHJlc3N1cmUuICBQZXJmb3JtYW5jZSBj
YW4gYmUgcmVzdG9yZWQsIGlmIGd1ZXN0IGtlcm5lbHMgYXJlCnRydXN0ZWQg
bm90IHRvIG1vdW50IGFuIGF0dGFjaywgYnkgc3BlY2lmeWluZyBlcHQ9ZXhl
Yy1zcCBvbiB0aGUgY29tbWFuZCBsaW5lLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3
IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2
aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRp
ZmYgLS1naXQgYS9kb2NzL21pc2MveGVuLWNvbW1hbmQtbGluZS5tYXJrZG93
biBiL2RvY3MvbWlzYy94ZW4tY29tbWFuZC1saW5lLm1hcmtkb3duCmluZGV4
IGM2M2EwN2QyOWIuLjY4NDY3MWNiN2IgMTAwNjQ0Ci0tLSBhL2RvY3MvbWlz
Yy94ZW4tY29tbWFuZC1saW5lLm1hcmtkb3duCisrKyBiL2RvY3MvbWlzYy94
ZW4tY29tbWFuZC1saW5lLm1hcmtkb3duCkBAIC04MjgsNyArODI4LDcgQEAg
ZWZmZWN0IHRoZSBpbnZlcnNlIG1lYW5pbmcuCiA+PiBzZXQgYXMgVUMuCiAK
ICMjIyBlcHQgKEludGVsKQotPiBgPSBMaXN0IG9mICgge25vLX1wbWwgfCB7
bm8tfWFkIClgCis+IGA9IExpc3Qgb2YgWyB7bm8tfXBtbCwgIHtuby19YWQs
IHtuby19ZXhlYy1zcCBdYAogCiBDb250cm9scyBFUFQgcmVsYXRlZCBmZWF0
dXJlcy4KIApAQCAtODUxLDYgKzg1MSwxNiBAQCBDb250cm9scyBFUFQgcmVs
YXRlZCBmZWF0dXJlcy4KIAogPj4gSGF2ZSBoYXJkd2FyZSBrZWVwIGFjY2Vz
c2VkL2RpcnR5IChBL0QpIGJpdHMgdXBkYXRlZC4KIAorKiAgIFRoZSBgZXhl
Yy1zcGAgYm9vbGVhbiBjb250cm9scyB3aGV0aGVyIEVQVCBzdXBlcnBhZ2Vz
IHdpdGggZXhlY3V0ZQorICAgIHBlcm1pc3Npb25zIGFyZSBwZXJtaXR0ZWQu
ICBJbiBnZW5lcmFsIHRoaXMgaXMgZ29vZCBmb3IgcGVyZm9ybWFuY2UuCisK
KyAgICBIb3dldmVyLCBvbiBwcm9jZXNzb3JzIHZ1bG5lcmFibGUgQ1ZFLTIw
MTgtMTIyMDcsIEhWTSBndWVzdCBrZXJuZWxzIGNhbgorICAgIHVzZSBleGVj
dXRhYmxlIHN1cGVycGFnZXMgdG8gY3Jhc2ggdGhlIGhvc3QuICBCeSBkZWZh
dWx0LCBleGVjdXRhYmxlCisgICAgc3VwZXJwYWdlcyBhcmUgZGlzYWJsZWQg
b24gYWZmZWN0ZWQgaGFyZHdhcmUuCisKKyAgICBJZiBIVk0gZ3Vlc3Qga2Vy
bmVscyBhcmUgdHJ1c3RlZCBub3QgdG8gbW91bnQgYSBEb1MgYWdhaW5zdCB0
aGUgc3lzdGVtLAorICAgIHRoaXMgb3B0aW9uIGNhbiBlbmFibGVkIHRvIHJl
Z2FpbiBwZXJmb3JtYW5jZS4KKwogIyMjIGV4dHJhXF9ndWVzdFxfaXJxcwog
PiBgPSBbPGRvbVUgbnVtYmVyPl1bLDxkb20wIG51bWJlcj5dYAogCmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jIGIveGVuL2FyY2gveDg2
L2h2bS9odm0uYwppbmRleCBmNGE2YTM3MTQ5Li4xOTI0NDM0OTYwIDEwMDY0
NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9odm0vaHZtLmMKQEAgLTE3MDYsNiArMTcwNiw3IEBAIGludCBodm1f
aGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBs
b25nIGdsYSwKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtLCAqaG9zdHAy
bTsKICAgICBpbnQgcmMsIGZhbGxfdGhyb3VnaCA9IDAsIHBhZ2VkID0gMDsK
ICAgICBpbnQgc2hhcmluZ19lbm9tZW0gPSAwOworICAgIHVuc2lnbmVkIGlu
dCBwYWdlX29yZGVyID0gMDsKICAgICB2bV9ldmVudF9yZXF1ZXN0X3QgKnJl
cV9wdHIgPSBOVUxMOwogICAgIGJvb2xfdCBhcDJtX2FjdGl2ZSwgc3luYyA9
IDA7CiAKQEAgLTE3NzQsNyArMTc3NSw3IEBAIGludCBodm1faGFwX25lc3Rl
ZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBsb25nIGdsYSwK
ICAgICBob3N0cDJtID0gcDJtX2dldF9ob3N0cDJtKGN1cnJkKTsKICAgICBt
Zm4gPSBnZXRfZ2ZuX3R5cGVfYWNjZXNzKGhvc3RwMm0sIGdmbiwgJnAybXQs
ICZwMm1hLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUDJNX0FM
TE9DIHwgKG5wZmVjLndyaXRlX2FjY2VzcyA/IFAyTV9VTlNIQVJFIDogMCks
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZwYWdlX29yZGVyKTsKIAogICAg
IGlmICggYXAybV9hY3RpdmUgKQogICAgIHsKQEAgLTE3ODYsNyArMTc4Nyw3
IEBAIGludCBodm1faGFwX25lc3RlZF9wYWdlX2ZhdWx0KHBhZGRyX3QgZ3Bh
LCB1bnNpZ25lZCBsb25nIGdsYSwKICAgICAgICAgICAgIGdvdG8gb3V0Owog
ICAgICAgICB9CiAKLSAgICAgICAgbWZuID0gZ2V0X2dmbl90eXBlX2FjY2Vz
cyhwMm0sIGdmbiwgJnAybXQsICZwMm1hLCAwLCBOVUxMKTsKKyAgICAgICAg
bWZuID0gZ2V0X2dmbl90eXBlX2FjY2VzcyhwMm0sIGdmbiwgJnAybXQsICZw
Mm1hLCAwLCAmcGFnZV9vcmRlcik7CiAgICAgfQogICAgIGVsc2UKICAgICAg
ICAgcDJtID0gaG9zdHAybTsKQEAgLTE4MjgsNiArMTgyOSwyNCBAQCBpbnQg
aHZtX2hhcF9uZXN0ZWRfcGFnZV9mYXVsdChwYWRkcl90IGdwYSwgdW5zaWdu
ZWQgbG9uZyBnbGEsCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgfQog
CisgICAgICAgIC8qCisgICAgICAgICAqIFdvcmthcm91bmQgZm9yIFhTQS0z
MDQgLyBDVkUtMjAxOC0xMjIwNy4gIElmIHdlIHRha2UgYW4gZXhlY3V0aW9u
CisgICAgICAgICAqIGZhdWx0IGFnYWluc3QgYSBub24tZXhlY3V0YWJsZSBz
dXBlcnBhZ2UsIHNoYXR0ZXIgaXQgdG8gcmVnYWluCisgICAgICAgICAqIGV4
ZWN1dGUgcGVybWlzc2lvbnMuCisgICAgICAgICAqLworICAgICAgICBpZiAo
IHBhZ2Vfb3JkZXIgPiAwICYmIG5wZmVjLmluc25fZmV0Y2ggJiYgbnBmZWMu
cHJlc2VudCAmJiAhdmlvbGF0aW9uICkKKyAgICAgICAgeworICAgICAgICAg
ICAgaW50IHJlcyA9IHAybV9zZXRfZW50cnkocDJtLCBfZ2ZuKGdmbiksIG1m
biwgUEFHRV9PUkRFUl80SywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHAybXQsIHAybWEpOworCisgICAgICAgICAgICBpZiAoIHJl
cyApCisgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIkZhaWxl
ZCB0byBzaGF0dGVyIGdmbiAlIlBSSV9nZm4iOiAlZFxuIiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgZ2ZuLCByZXMpOworCisgICAgICAgICAgICByYyA9
ICFyZXM7CisgICAgICAgICAgICBnb3RvIG91dF9wdXRfZ2ZuOworICAgICAg
ICB9CisKICAgICAgICAgaWYgKCB2aW9sYXRpb24gKQogICAgICAgICB7CiAg
ICAgICAgICAgICAvKiBTaG91bGQgI1ZFIGJlIGVtdWxhdGVkIGZvciB0aGlz
IGZhdWx0PyAqLwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS92bXgv
dm1jcy5jIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5jCmluZGV4IDQ5
Mzk4NmU4NGEuLjg4MjFhM2I1MzYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4
Ni9odm0vdm14L3ZtY3MuYworKysgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92
bWNzLmMKQEAgLTY3LDYgKzY3LDcgQEAgaW50ZWdlcl9wYXJhbSgicGxlX3dp
bmRvdyIsIHBsZV93aW5kb3cpOwogCiBzdGF0aWMgYm9vbF90IF9fcmVhZF9t
b3N0bHkgb3B0X3BtbF9lbmFibGVkID0gMTsKIHN0YXRpYyBzOCBfX3JlYWRf
bW9zdGx5IG9wdF9lcHRfYWQgPSAtMTsKK2ludDhfdCBfX3JlYWRfbW9zdGx5
IG9wdF9lcHRfZXhlY19zcCA9IC0xOwogCiAvKgogICogVGhlICdlcHQnIHBh
cmFtZXRlciBjb250cm9scyBmdW5jdGlvbmFsaXRpZXMgdGhhdCBkZXBlbmQg
b24sIG9yIGltcGFjdCB0aGUKQEAgLTk0LDYgKzk1LDggQEAgc3RhdGljIGlu
dCBfX2luaXQgcGFyc2VfZXB0X3BhcmFtKGNvbnN0IGNoYXIgKnMpCiAgICAg
ICAgICAgICBvcHRfcG1sX2VuYWJsZWQgPSB2YWw7CiAgICAgICAgIGVsc2Ug
aWYgKCAhY21kbGluZV9zdHJjbXAocywgImFkIikgKQogICAgICAgICAgICAg
b3B0X2VwdF9hZCA9IHZhbDsKKyAgICAgICAgZWxzZSBpZiAoICFjbWRsaW5l
X3N0cmNtcChzLCAiZXhlYy1zcCIpICkKKyAgICAgICAgICAgIG9wdF9lcHRf
ZXhlY19zcCA9IHZhbDsKICAgICAgICAgZWxzZQogICAgICAgICAgICAgcmMg
PSAtRUlOVkFMOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3Zt
eC92bXguYyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jCmluZGV4IDg0
MGRjMmI0NGQuLmE1NjhkNjI2NDMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4
Ni9odm0vdm14L3ZteC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3Zt
eC5jCkBAIC0yNDE1LDYgKzI0MTUsMTAyIEBAIHN0YXRpYyB2b2lkIHBpX25v
dGlmaWNhdGlvbl9pbnRlcnJ1cHQoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJl
Z3MpCiBzdGF0aWMgdm9pZCBfX2luaXQgbGJyX3RzeF9maXh1cF9jaGVjayh2
b2lkKTsKIHN0YXRpYyB2b2lkIF9faW5pdCBiZHdfZXJyYXR1bV9iZGYxNF9m
aXh1cF9jaGVjayh2b2lkKTsKIAorLyoKKyAqIENhbGN1bGF0ZSB3aGV0aGVy
IHRoZSBDUFUgaXMgdnVsbmVyYWJsZSB0byBJbnN0cnVjdGlvbiBGZXRjaCBw
YWdlCisgKiBzaXplLWNoYW5nZSBNQ0VzLgorICovCitzdGF0aWMgYm9vbCBf
X2luaXQgaGFzX2lmX3BzY2hhbmdlX21jKHZvaWQpCit7CisgICAgdWludDY0
X3QgY2FwcyA9IDA7CisKKyAgICAvKgorICAgICAqIElmIHdlIGFyZSB2aXJ0
dWFsaXNlZCwgdGhlcmUgaXMgbm90aGluZyB3ZSBjYW4gZG8uICBPdXIgRVBU
IHRhYmxlcyBhcmUKKyAgICAgKiBzaGFkb3dlZCBieSBvdXIgaHlwZXJ2aXNv
ciwgYW5kIG5vdCB3YWxrZWQgYnkgaGFyZHdhcmUuCisgICAgICovCisgICAg
aWYgKCBjcHVfaGFzX2h5cGVydmlzb3IgKQorICAgICAgICByZXR1cm4gZmFs
c2U7CisKKyAgICBpZiAoIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9BUkNI
X0NBUFMpICkKKyAgICAgICAgcmRtc3JsKE1TUl9BUkNIX0NBUEFCSUxJVElF
UywgY2Fwcyk7CisKKyAgICBpZiAoIGNhcHMgJiBBUkNIX0NBUFNfSUZfUFND
SEFOR0VfTUNfTk8gKQorICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICAv
KgorICAgICAqIElGX1BTQ0hBTkdFX01DIGlzIG9ubHkga25vd24gdG8gYWZm
ZWN0IEludGVsIEZhbWlseSA2IHByb2Nlc3NvcnMgYXQKKyAgICAgKiB0aGlz
IHRpbWUuCisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92
ZW5kb3IgIT0gWDg2X1ZFTkRPUl9JTlRFTCB8fAorICAgICAgICAgYm9vdF9j
cHVfZGF0YS54ODYgIT0gNiApCisgICAgICAgIHJldHVybiBmYWxzZTsKKwor
ICAgIHN3aXRjaCAoIGJvb3RfY3B1X2RhdGEueDg2X21vZGVsICkKKyAgICB7
CisgICAgICAgIC8qCisgICAgICAgICAqIENvcmUgcHJvY2Vzc29ycyBzaW5j
ZSBhdCBsZWFzdCBOZWhhbGVtIGFyZSB2dWxuZXJhYmxlLgorICAgICAgICAg
Ki8KKyAgICBjYXNlIDB4MWY6IC8qIEF1YnVybmRhbGUgLyBIYXZlbmRhbGUg
Ki8KKyAgICBjYXNlIDB4MWU6IC8qIE5laGFsZW0gKi8KKyAgICBjYXNlIDB4
MWE6IC8qIE5laGFsZW0gRVAgKi8KKyAgICBjYXNlIDB4MmU6IC8qIE5laGFs
ZW0gRVggKi8KKyAgICBjYXNlIDB4MjU6IC8qIFdlc3RtZXJlICovCisgICAg
Y2FzZSAweDJjOiAvKiBXZXN0bWVyZSBFUCAqLworICAgIGNhc2UgMHgyZjog
LyogV2VzdG1lcmUgRVggKi8KKyAgICBjYXNlIDB4MmE6IC8qIFNhbmR5QnJp
ZGdlICovCisgICAgY2FzZSAweDJkOiAvKiBTYW5keUJyaWRnZSBFUC9FWCAq
LworICAgIGNhc2UgMHgzYTogLyogSXZ5QnJpZGdlICovCisgICAgY2FzZSAw
eDNlOiAvKiBJdnlCcmlkZ2UgRVAvRVggKi8KKyAgICBjYXNlIDB4M2M6IC8q
IEhhc3dlbGwgKi8KKyAgICBjYXNlIDB4M2Y6IC8qIEhhc3dlbGwgRVgvRVAg
Ki8KKyAgICBjYXNlIDB4NDU6IC8qIEhhc3dlbGwgRCAqLworICAgIGNhc2Ug
MHg0NjogLyogSGFzd2VsbCBIICovCisgICAgY2FzZSAweDNkOiAvKiBCcm9h
ZHdlbGwgKi8KKyAgICBjYXNlIDB4NDc6IC8qIEJyb2Fkd2VsbCBIICovCisg
ICAgY2FzZSAweDRmOiAvKiBCcm9hZHdlbGwgRVAvRVggKi8KKyAgICBjYXNl
IDB4NTY6IC8qIEJyb2Fkd2VsbCBEICovCisgICAgY2FzZSAweDRlOiAvKiBT
a3lsYWtlIE0gKi8KKyAgICBjYXNlIDB4NWU6IC8qIFNreWxha2UgRCAqLwor
ICAgIGNhc2UgMHg1NTogLyogU2t5bGFrZS1YIC8gQ2FzY2FkZSBMYWtlICov
CisgICAgY2FzZSAweDhlOiAvKiBLYWJ5IC8gQ29mZmVlIC8gV2hpc2tleSBM
YWtlIE0gKi8KKyAgICBjYXNlIDB4OWU6IC8qIEthYnkgLyBDb2ZmZWUgLyBX
aGlza2V5IExha2UgRCAqLworICAgICAgICByZXR1cm4gdHJ1ZTsKKworICAg
ICAgICAvKgorICAgICAgICAgKiBBdG9tIHByb2Nlc3NvcnMgYXJlIG5vdCB2
dWxuZXJhYmxlLgorICAgICAgICAgKi8KKyAgICBjYXNlIDB4MWM6IC8qIFBp
bmV2aWV3ICovCisgICAgY2FzZSAweDI2OiAvKiBMaW5jcm9mdCAqLworICAg
IGNhc2UgMHgyNzogLyogUGVud2VsbCAqLworICAgIGNhc2UgMHgzNTogLyog
Q2xvdmVydmlldyAqLworICAgIGNhc2UgMHgzNjogLyogQ2VkYXJ2aWV3ICov
CisgICAgY2FzZSAweDM3OiAvKiBCYXl0cmFpbCAvIFZhbGxleXZpZXcgKFNp
bHZlcm1vbnQpICovCisgICAgY2FzZSAweDRkOiAvKiBBdmF0b24gLyBSYW5n
ZWx5IChTaWx2ZXJtb250KSAqLworICAgIGNhc2UgMHg0YzogLyogQ2hlcnJ5
dHJhaWwgLyBCcmFzc3dlbGwgKi8KKyAgICBjYXNlIDB4NGE6IC8qIE1lcnJp
ZmllbGQgKi8KKyAgICBjYXNlIDB4NWE6IC8qIE1vb3JlZmllbGQgKi8KKyAg
ICBjYXNlIDB4NWM6IC8qIEdvbGRtb250ICovCisgICAgY2FzZSAweDVkOiAv
KiBTb0ZJQSAzRyBHcmFuaXRlL0VTMi4xICovCisgICAgY2FzZSAweDY1OiAv
KiBTb0ZJQSBMVEUgQU9TUCAqLworICAgIGNhc2UgMHg1ZjogLyogRGVudmVy
dG9uICovCisgICAgY2FzZSAweDZlOiAvKiBDb3VnYXIgTW91bnRhaW4gKi8K
KyAgICBjYXNlIDB4NzU6IC8qIExpZ2h0bmluZyBNb3VudGFpbiAqLworICAg
IGNhc2UgMHg3YTogLyogR2VtaW5pIExha2UgKi8KKyAgICBjYXNlIDB4ODY6
IC8qIEphY29ic3ZpbGxlICovCisKKyAgICAgICAgLyoKKyAgICAgICAgICog
S25pZ2h0cyBwcm9jZXNzb3JzIGFyZSBub3QgdnVsbmVyYWJsZS4KKyAgICAg
ICAgICovCisgICAgY2FzZSAweDU3OiAvKiBLbmlnaHRzIExhbmRpbmcgKi8K
KyAgICBjYXNlIDB4ODU6IC8qIEtuaWdodHMgTWlsbCAqLworICAgICAgICBy
ZXR1cm4gZmFsc2U7CisKKyAgICBkZWZhdWx0OgorICAgICAgICBwcmludGso
IlVucmVjb2duaXNlZCBDUFUgbW9kZWwgJSN4IC0gYXNzdW1pbmcgdnVsbmVy
YWJsZSB0byBJRl9QU0NIQU5HRV9NQ1xuIiwKKyAgICAgICAgICAgICAgIGJv
b3RfY3B1X2RhdGEueDg2X21vZGVsKTsKKyAgICAgICAgcmV0dXJuIHRydWU7
CisgICAgfQorfQorCiBjb25zdCBzdHJ1Y3QgaHZtX2Z1bmN0aW9uX3RhYmxl
ICogX19pbml0IHN0YXJ0X3ZteCh2b2lkKQogewogICAgIHNldF9pbl9jcjQo
WDg2X0NSNF9WTVhFKTsKQEAgLTI0MzUsNiArMjUzMSwxNyBAQCBjb25zdCBz
dHJ1Y3QgaHZtX2Z1bmN0aW9uX3RhYmxlICogX19pbml0IHN0YXJ0X3ZteCh2
b2lkKQogICAgICAqLwogICAgIGlmICggY3B1X2hhc192bXhfZXB0ICYmIChj
cHVfaGFzX3ZteF9wYXQgfHwgb3B0X2ZvcmNlX2VwdCkgKQogICAgIHsKKyAg
ICAgICAgYm9vbCBjcHVfaGFzX2J1Z19wc2NoYW5nZV9tYyA9IGhhc19pZl9w
c2NoYW5nZV9tYygpOworCisgICAgICAgIGlmICggb3B0X2VwdF9leGVjX3Nw
ID09IC0xICkKKyAgICAgICAgeworICAgICAgICAgICAgLyogRGVmYXVsdCB0
byBub24tZXhlY3V0YWJsZSBzdXBlcnBhZ2VzIG9uIHZ1bG5lcmFibGUgaGFy
ZHdhcmUuICovCisgICAgICAgICAgICBvcHRfZXB0X2V4ZWNfc3AgPSAhY3B1
X2hhc19idWdfcHNjaGFuZ2VfbWM7CisKKyAgICAgICAgICAgIGlmICggY3B1
X2hhc19idWdfcHNjaGFuZ2VfbWMgKQorICAgICAgICAgICAgICAgIHByaW50
aygiVk1YOiBEaXNhYmxpbmcgZXhlY3V0YWJsZSBFUFQgc3VwZXJwYWdlcyBk
dWUgdG8gQ1ZFLTIwMTgtMTIyMDdcbiIpOworICAgICAgICB9CisKICAgICAg
ICAgdm14X2Z1bmN0aW9uX3RhYmxlLmhhcF9zdXBwb3J0ZWQgPSAxOwogICAg
ICAgICB2bXhfZnVuY3Rpb25fdGFibGUuYWx0cDJtX3N1cHBvcnRlZCA9IDE7
CiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0LmMgYi94
ZW4vYXJjaC94ODYvbW0vcDJtLWVwdC5jCmluZGV4IGNlNDYyMDFkNDUuLjkz
ZTA4Zjg5YTIgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tZXB0
LmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1lcHQuYwpAQCAtMjE1LDYg
KzIxNSwxMiBAQCBzdGF0aWMgdm9pZCBlcHRfcDJtX3R5cGVfdG9fZmxhZ3Mo
c3RydWN0IHAybV9kb21haW4gKnAybSwgZXB0X2VudHJ5X3QgKmVudHJ5LAog
ICAgICAgICAgICAgYnJlYWs7CiAgICAgfQogICAgIAorICAgIC8qCisgICAg
ICogRG9uJ3QgY3JlYXRlIGV4ZWN1dGFibGUgc3VwZXJwYWdlcyBpZiB3ZSBu
ZWVkIHRvIHNoYXR0ZXIgdGhlbSB0bworICAgICAqIHByb3RlY3QgYWdhaW5z
dCBDVkUtMjAxOC0xMjIwNy4KKyAgICAgKi8KKyAgICBpZiAoICFvcHRfZXB0
X2V4ZWNfc3AgJiYgaXNfZXB0ZV9zdXBlcnBhZ2UoZW50cnkpICkKKyAgICAg
ICAgZW50cnktPnggPSAwOwogfQogCiAjZGVmaW5lIEdVRVNUX1RBQkxFX01B
UF9GQUlMRUQgIDAKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYv
aHZtL3ZteC92bXguaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3ZteC92
bXguaAppbmRleCA4OTYxOWU0YWZkLi4yMGViN2Y2MDgyIDEwMDY0NAotLS0g
YS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS92bXgvdm14LmgKKysrIGIveGVu
L2luY2x1ZGUvYXNtLXg4Ni9odm0vdm14L3ZteC5oCkBAIC0yOCw2ICsyOCw4
IEBACiAjaW5jbHVkZSA8YXNtL2h2bS90cmFjZS5oPgogI2luY2x1ZGUgPGFz
bS9odm0vdm14L3ZtY3MuaD4KIAorZXh0ZXJuIGludDhfdCBvcHRfZXB0X2V4
ZWNfc3A7CisKIHR5cGVkZWYgdW5pb24gewogICAgIHN0cnVjdCB7CiAgICAg
ICAgIHU2NCByICAgICAgIDogICAxLCAgLyogYml0IDAgLSBSZWFkIHBlcm1p
c3Npb24gKi8KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNy
LWluZGV4LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21zci1pbmRleC5oCmlu
ZGV4IGI4MTUxZDJkOWYuLjg5YWUzZTAzZjEgMTAwNjQ0Ci0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvbXNyLWluZGV4LmgKKysrIGIveGVuL2luY2x1ZGUv
YXNtLXg4Ni9tc3ItaW5kZXguaApAQCAtNTQsNiArNTQsNyBAQAogI2RlZmlu
ZSBBUkNIX0NBUFNfU0tJUF9MMURGTAkJKF9BQygxLCBVTEwpIDw8IDMpCiAj
ZGVmaW5lIEFSQ0hfQ0FQU19TU0JfTk8JCShfQUMoMSwgVUxMKSA8PCA0KQog
I2RlZmluZSBBUkNIX0NBUFNfTURTX05PCQkoX0FDKDEsIFVMTCkgPDwgNSkK
KyNkZWZpbmUgQVJDSF9DQVBTX0lGX1BTQ0hBTkdFX01DX05PCShfQUMoMSwg
VUxMKSA8PCA2KQogCiAjZGVmaW5lIE1TUl9GTFVTSF9DTUQJCQkweDAwMDAw
MTBiCiAjZGVmaW5lIEZMVVNIX0NNRF9MMUQJCQkoX0FDKDEsIFVMTCkgPDwg
MCkK

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.11-3.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.11-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogQWxsb3cgcnVudGltZSBtb2RpZmljYXRp
b24gb2YgdGhlIGV4ZWMtc3Agc2V0dGluZwoKU2VlIHBhdGNoIGZvciBkZXRh
aWxzLgoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS9kb2Nz
L21pc2MveGVuLWNvbW1hbmQtbGluZS5tYXJrZG93biBiL2RvY3MvbWlzYy94
ZW4tY29tbWFuZC1saW5lLm1hcmtkb3duCmluZGV4IDY4NDY3MWNiN2IuLjMz
ZWQxZmZjNDAgMTAwNjQ0Ci0tLSBhL2RvY3MvbWlzYy94ZW4tY29tbWFuZC1s
aW5lLm1hcmtkb3duCisrKyBiL2RvY3MvbWlzYy94ZW4tY29tbWFuZC1saW5l
Lm1hcmtkb3duCkBAIC04NjEsNiArODYxLDIxIEBAIENvbnRyb2xzIEVQVCBy
ZWxhdGVkIGZlYXR1cmVzLgogICAgIElmIEhWTSBndWVzdCBrZXJuZWxzIGFy
ZSB0cnVzdGVkIG5vdCB0byBtb3VudCBhIERvUyBhZ2FpbnN0IHRoZSBzeXN0
ZW0sCiAgICAgdGhpcyBvcHRpb24gY2FuIGVuYWJsZWQgdG8gcmVnYWluIHBl
cmZvcm1hbmNlLgogCisgICAgVGhpcyBib29sZWFuIG1heSBiZSBtb2RpZmll
ZCBhdCBydW50aW1lIHVzaW5nIGB4bCBzZXQtcGFyYW1ldGVycworICAgIGVw
dD1bbm8tXWV4ZWMtc3BgIHRvIHN3aXRjaCBiZXR3ZWVuIGZhc3QgYW5kIHNl
Y3VyZS4KKworICAgICogICBXaGVuIHN3aXRjaGluZyBmcm9tIHNlY3VyZSB0
byBmYXN0LCBwcmVleGlzdGluZyBIVk0gZG9tYWlucyB3aWxsIHJ1bgorICAg
ICAgICBhdCB0aGVpciBjdXJyZW50IHBlcmZvcm1hbmNlIHVudGlsIHRoZXkg
YXJlIHJlYm9vdGVkOyBuZXcgZG9tYWlucyB3aWxsCisgICAgICAgIHJ1biB3
aXRob3V0IGFueSBvdmVyaGVhZC4KKworICAgICogICBXaGVuIHN3aXRjaGlu
ZyBmcm9tIGZhc3QgdG8gc2VjdXJlLCBhbGwgSFZNIGRvbWFpbnMgd2lsbCBp
bW1lZGlhdGVseQorICAgICAgICBzdWZmZXIgYSBwZXJmb3JtYW5jZSBwZW5h
bHR5LgorCisgICAgKipXYXJuaW5nOiBObyBndWFyYW50ZWUgaXMgbWFkZSB0
aGF0IHRoaXMgcnVudGltZSBvcHRpb24gd2lsbCBiZSByZXRhaW5lZAorICAg
ICAgaW5kZWZpbml0ZWx5LCBvciB0aGF0IGl0IHdpbGwgcmV0YWluIHRoaXMg
ZXhhY3QgYmVoYXZpb3VyLiAgSXQgaXMKKyAgICAgIGludGVuZGVkIGFzIGFu
IGVtZXJnZW5jeSBvcHRpb24gZm9yIHBlb3BsZSB3aG8gZmlyc3QgY2hvc2Ug
ZmFzdCwgdGhlbgorICAgICAgY2hhbmdlIHRoZWlyIG1pbmRzIHRvIHNlY3Vy
ZSwgYW5kIHdpc2ggbm90IHRvIHJlYm9vdC4qKgorCiAjIyMgZXh0cmFcX2d1
ZXN0XF9pcnFzCiA+IGA9IFs8ZG9tVSBudW1iZXI+XVssPGRvbTAgbnVtYmVy
Pl1gCiAKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3Mu
YyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3MuYwppbmRleCA4ODIxYTNi
NTM2Li4xNTM3NmUyNWJhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZt
L3ZteC92bWNzLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5j
CkBAIC0xMDcsNiArMTA3LDQxIEBAIHN0YXRpYyBpbnQgX19pbml0IHBhcnNl
X2VwdF9wYXJhbShjb25zdCBjaGFyICpzKQogfQogY3VzdG9tX3BhcmFtKCJl
cHQiLCBwYXJzZV9lcHRfcGFyYW0pOwogCitzdGF0aWMgaW50IHBhcnNlX2Vw
dF9wYXJhbV9ydW50aW1lKGNvbnN0IGNoYXIgKnMpCit7CisgICAgaW50IHZh
bDsKKworICAgIGlmICggIWNwdV9oYXNfdm14X2VwdCB8fCAhaHZtX2Z1bmNz
LmhhcF9zdXBwb3J0ZWQgfHwKKyAgICAgICAgICEoaHZtX2Z1bmNzLmhhcF9j
YXBhYmlsaXRpZXMgJgorICAgICAgICAgICAoSFZNX0hBUF9TVVBFUlBBR0Vf
Mk1CIHwgSFZNX0hBUF9TVVBFUlBBR0VfMUdCKSkgKQorICAgIHsKKyAgICAg
ICAgcHJpbnRrKCJWTVg6IEVQVCBub3QgYXZhaWxhYmxlLCBvciBub3QgaW4g
dXNlIC0gaWdub3JpbmdcbiIpOworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisKKyAgICBpZiAoICh2YWwgPSBwYXJzZV9ib29sZWFuKCJleGVjLXNwIiwg
cywgTlVMTCkpIDwgMCApCisgICAgICAgIHJldHVybiAtRUlOVkFMOworCisg
ICAgaWYgKCB2YWwgIT0gb3B0X2VwdF9leGVjX3NwICkKKyAgICB7CisgICAg
ICAgIHN0cnVjdCBkb21haW4gKmQ7CisKKyAgICAgICAgb3B0X2VwdF9leGVj
X3NwID0gdmFsOworCisgICAgICAgIHJjdV9yZWFkX2xvY2soJmRvbWxpc3Rf
cmVhZF9sb2NrKTsKKyAgICAgICAgZm9yX2VhY2hfZG9tYWluICggZCApCisg
ICAgICAgICAgICBpZiAoIHBhZ2luZ19tb2RlX2hhcChkKSApCisgICAgICAg
ICAgICAgICAgcDJtX2NoYW5nZV9lbnRyeV90eXBlX2dsb2JhbChkLCBwMm1f
cmFtX3J3LCBwMm1fcmFtX3J3KTsKKyAgICAgICAgcmN1X3JlYWRfdW5sb2Nr
KCZkb21saXN0X3JlYWRfbG9jayk7CisgICAgfQorCisgICAgcHJpbnRrKCJW
TVg6IEVQVCBleGVjdXRhYmxlIHN1cGVycGFnZXMgJXNhYmxlZFxuIiwKKyAg
ICAgICAgICAgdmFsID8gImVuIiA6ICJkaXMiKTsKKworICAgIHJldHVybiAw
OworfQorY3VzdG9tX3J1bnRpbWVfb25seV9wYXJhbSgiZXB0IiwgcGFyc2Vf
ZXB0X3BhcmFtX3J1bnRpbWUpOworCiAvKiBEeW5hbWljIChydW4tdGltZSBh
ZGp1c3RlZCkgZXhlY3V0aW9uIGNvbnRyb2wgZmxhZ3MuICovCiB1MzIgdm14
X3Bpbl9iYXNlZF9leGVjX2NvbnRyb2wgX19yZWFkX21vc3RseTsKIHUzMiB2
bXhfY3B1X2Jhc2VkX2V4ZWNfY29udHJvbCBfX3JlYWRfbW9zdGx5OwpkaWZm
IC0tZ2l0IGEveGVuL2FyY2gveDg2L21tL3AybS5jIGIveGVuL2FyY2gveDg2
L21tL3AybS5jCmluZGV4IDJiNjJiYzYxZGQuLjk3YzQxN2ZjM2UgMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYworKysgYi94ZW4vYXJjaC94
ODYvbW0vcDJtLmMKQEAgLTI1NywxNyArMjU3LDIyIEBAIGludCBwMm1faXNf
bG9nZGlydHlfcmFuZ2Uoc3RydWN0IHAybV9kb21haW4gKnAybSwgdW5zaWdu
ZWQgbG9uZyBzdGFydCwKICAgICByZXR1cm4gMDsKIH0KIAorLyoKKyAqIE1h
eSBiZSBjYWxsZWQgd2l0aCBvdCA9IG50ID0gcDJtX3JhbV9ydyBmb3IgaXRz
IHNpZGUgZWZmZWN0IG9mCisgKiByZWNhbGN1bGF0aW5nIGFsbCBQVEVzIGlu
IHRoZSBwMm0uCisgKi8KIHZvaWQgcDJtX2NoYW5nZV9lbnRyeV90eXBlX2ds
b2JhbChzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAybV90eXBlX3Qgb3QsIHAybV90eXBlX3QgbnQpCiB7
CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybSA9IHAybV9nZXRfaG9zdHAy
bShkKTsKIAotICAgIEFTU0VSVChvdCAhPSBudCk7CiAgICAgQVNTRVJUKHAy
bV9pc19jaGFuZ2VhYmxlKG90KSAmJiBwMm1faXNfY2hhbmdlYWJsZShudCkp
OwogCiAgICAgcDJtX2xvY2socDJtKTsKICAgICBwMm0tPmNoYW5nZV9lbnRy
eV90eXBlX2dsb2JhbChwMm0sIG90LCBudCk7Ci0gICAgcDJtLT5nbG9iYWxf
bG9nZGlydHkgPSAobnQgPT0gcDJtX3JhbV9sb2dkaXJ0eSk7CisgICAgLyog
RG9uJ3QgYWxsb3cgJ3JlY2FsY3VsYXRlJyBvcGVyYXRpb25zIHRvIGNoYW5n
ZSB0aGUgbG9nZGlydHkgc3RhdGUuICovCisgICAgaWYgKCBvdCAhPSBudCAp
CisgICAgICAgIHAybS0+Z2xvYmFsX2xvZ2RpcnR5ID0gKG50ID09IHAybV9y
YW1fbG9nZGlydHkpOwogICAgIHAybV91bmxvY2socDJtKTsKIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.12-1.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.12-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0ZDogSGlkZSBzdXBlcnBhZ2Ugc3VwcG9ydCBm
b3IgU2FuZHlCcmlkZ2UgSU9NTVVzCgpTb21ldGhpbmcgY2F1c2VzIFNhbmR5
QnJpZGdlIElPTU1VcyB0byBjaG9rZSB3aGVuIHNoYXJpbmcgRVBUIHBhZ2V0
YWJsZXMsIGFuZAphbiBFUFQgc3VwZXJwYWdlIGdldHMgc2hhdHRlcmVkLiAg
VGhlIHJvb3QgY2F1c2UgaXMgc3RpbGwgdW5kZXIgaW52ZXN0aWdhdGlvbiwK
YnV0IHRoZSBlbmQgcmVzdWx0IGlzIHVudXNhYmxlIGluIGNvbWJpbmF0aW9u
IHdpdGggQ1ZFLTIwMTgtMTIyMDcgcHJvdGVjdGlvbnMuCgpUaGlzIGlzIHBh
cnQgb2YgWFNBLTMwNCAvIENWRS0yMDE4LTEyMjA3CgpTaWduZWQtb2ZmLWJ5
OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpS
ZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoK
ZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRl
cm4uaCBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApp
bmRleCAxNmVhZGE5ZmEyLi5hNzFjOGIwZjg0IDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZXh0ZXJuLmgKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCkBAIC05Nyw2ICs5Nyw4
IEBAIHZvaWQgdnRkX29wc19wb3N0YW1ibGVfcXVpcmsoc3RydWN0IGlvbW11
KiBpb21tdSk7CiBpbnQgX19tdXN0X2NoZWNrIG1lX3dpZmlfcXVpcmsoc3Ry
dWN0IGRvbWFpbiAqZG9tYWluLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU4IGJ1cywgdTggZGV2Zm4sIGludCBtYXApOwogdm9pZCBwY2lf
dnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICopOwordm9pZCBxdWly
a19pb21tdV9jYXBzKHN0cnVjdCBpb21tdSAqaW9tbXUpOworCiBib29sX3Qg
cGxhdGZvcm1fc3VwcG9ydHNfaW50cmVtYXAodm9pZCk7CiBib29sX3QgcGxh
dGZvcm1fc3VwcG9ydHNfeDJhcGljKHZvaWQpOwogCmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9tbXUuYyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCmluZGV4IGIzNjY0ZWNiZTAu
LjVkMzRmNzUzMDYgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3Z0ZC9pb21tdS5jCkBAIC0xMjE1LDYgKzEyMTUsOCBAQCBpbnQgX19pbml0
IGlvbW11X2FsbG9jKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCkKICAg
ICBpZiAoICEoaW9tbXUtPmNhcCArIDEpIHx8ICEoaW9tbXUtPmVjYXAgKyAx
KSApCiAgICAgICAgIHJldHVybiAtRU5PREVWOwogCisgICAgcXVpcmtfaW9t
bXVfY2Fwcyhpb21tdSk7CisKICAgICBpZiAoIGNhcF9mYXVsdF9yZWdfb2Zm
c2V0KGlvbW11LT5jYXApICsKICAgICAgICAgIGNhcF9udW1fZmF1bHRfcmVn
cyhpb21tdS0+Y2FwKSAqIFBSSU1BUllfRkFVTFRfUkVHX0xFTiA+PSBQQUdF
X1NJWkUgfHwKICAgICAgICAgIGVjYXBfaW90bGJfb2Zmc2V0KGlvbW11LT5l
Y2FwKSA+PSBQQUdFX1NJWkUgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvdnRkL3F1aXJrcy5jCmluZGV4IGQ2ZGI4NjI2NzguLmIwMjY4OGUz
MTYgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9x
dWlya3MuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVp
cmtzLmMKQEAgLTU0MCwzICs1NDAsMjggQEAgdm9pZCBwY2lfdnRkX3F1aXJr
KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBicmVhazsK
ICAgICB9CiB9CisKK3ZvaWQgX19pbml0IHF1aXJrX2lvbW11X2NhcHMoc3Ry
dWN0IGlvbW11ICppb21tdSkKK3sKKyAgICAvKgorICAgICAqIElPTU1VIFF1
aXJrczoKKyAgICAgKgorICAgICAqIFNhbmR5QnJpZGdlIElPTU1VcyBjbGFp
bSBzdXBwb3J0IGZvciAyTSBhbmQgMUcgc3VwZXJwYWdlcywgYnV0IGRvbid0
CisgICAgICogaW1wbGVtZW50IHN1cGVycGFnZXMgaW50ZXJuYWxseS4KKyAg
ICAgKgorICAgICAqIFRoZXJlIGFyZSBpc3N1ZXMgY2hhbmdpbmcgdGhlIHdh
bGsgbGVuZ3RoIHVuZGVyIGluLWZsaWdodCBETUEsIHdoaWNoCisgICAgICog
aGFzIG1hbmlmZXN0ZWQgYXMgaW5jb21wYXRpYmlsaXR5IGJldHdlZW4gRVBU
L0lPTU1VIHNoYXJpbmcgYW5kIHRoZQorICAgICAqIHdvcmthcm91bmQgZm9y
IENWRS0yMDE4LTEyMjA3IC8gWFNBLTMwNC4gIEhpZGUgdGhlIHN1cGVycGFn
ZXMKKyAgICAgKiBjYXBhYmlsaXRpZXMgaW4gdGhlIElPTU1VLCB3aGljaCB3
aWxsIHByZXZlbnQgWGVuIGZyb20gc2hhcmluZyB0aGUgRVBUCisgICAgICog
YW5kIElPTU1VIHBhZ2V0YWJsZXMuCisgICAgICoKKyAgICAgKiBEZXRlY3Rp
b24gb2YgU2FuZHlCcmlkZ2UgdW5mb3J0dW5hdGVseSBoYXMgdG8gYmUgZG9u
ZSBieSBwcm9jZXNzb3IKKyAgICAgKiBtb2RlbCBiZWNhdXNlIHRoZSBjbGll
bnQgcGFydHMgZG9uJ3QgZXhwb3NlIHRoZWlyIElPTU1VcyBhcyBQQ0kgZGV2
aWNlcworICAgICAqIHdlIGNvdWxkIG1hdGNoIHdpdGggYSBEZXZpY2UgSUQu
CisgICAgICovCisgICAgaWYgKCBib290X2NwdV9kYXRhLng4Nl92ZW5kb3Ig
PT0gWDg2X1ZFTkRPUl9JTlRFTCAmJgorICAgICAgICAgYm9vdF9jcHVfZGF0
YS54ODYgPT0gNiAmJgorICAgICAgICAgKGJvb3RfY3B1X2RhdGEueDg2X21v
ZGVsID09IDB4MmEgfHwKKyAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9t
b2RlbCA9PSAweDJkKSApCisgICAgICAgIGlvbW11LT5jYXAgJj0gfigweGZ1
bCA8PCAzNCk7Cit9Cg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.12-2.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.12-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogRGlzYWJsZSBleGVjdXRhYmxlIEVQVCBz
dXBlcnBhZ2VzIHRvIHdvcmsgYXJvdW5kCiBDVkUtMjAxOC0xMjIwNwoKQ1ZF
LTIwMTgtMTIyMDcgY292ZXJzIGEgc2V0IG9mIGVycmF0YSBvbiB2YXJpb3Vz
IEludGVsIHByb2Nlc3NvcnMsIHdoZXJlYnkgYQptYWNoaW5lIGNoZWNrIGV4
Y2VwdGlvbiBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgY29ybmVyIGNhc2Ugd2hl
biBhbiBleGVjdXRhYmxlCm1hcHBpbmcgY2hhbmdlcyBzaXplIG9yIGNhY2hl
YWJpbGl0eSB3aXRob3V0IFRMQiBpbnZhbGlkYXRpb24uICBIVk0gZ3Vlc3QK
a2VybmVscyBjYW4gdHJpZ2dlciB0aGlzIHRvIERvUyB0aGUgaG9zdC4KClRv
IG1pdGlnYXRlLCBpbiBhZmZlY3RlZCBoYXJkd2FyZSwgYWxsIEVQVCBzdXBl
cnBhZ2VzIGFyZSBtYXJrZWQgTlguICBXaGVuIGFuCmluc3RydWN0aW9uIGZl
dGNoIHZpb2xhdGlvbiBpcyBvYnNlcnZlZCBhZ2FpbnN0IHRoZSBzdXBlcnBh
Z2UsIHRoZSBzdXBlcnBhZ2UKaXMgc2hhdHRlcmVkIHRvIDRrIGFuZCBoYXMg
ZXhlY3V0ZSBwZXJtaXNzaW9ucyByZXN0b3JlZC4gIFRoaXMgcHJldmVudHMg
dGhlCmd1ZXN0IGtlcm5lbCBmcm9tIGJlaW5nIGFibGUgdG8gY3JlYXRlIHRo
ZSBuZWNlc3NhcnkgcHJlY29uZGl0aW9ucyBpbiB0aGUgaVRMQgp0byBleHBs
b2l0IHRoZSB2dWxuZXJhYmlsaXR5LgoKVGhpcyBkb2VzIGNvbWUgd2l0aCBh
IHdvcmtsb2FkLWRlcGVuZGVudCBwZXJmb3JtYW5jZSBvdmVyaGVhZCwgY2F1
c2VkIGJ5CmluY3JlYXNlZCBUTEIgcHJlc3N1cmUuICBQZXJmb3JtYW5jZSBj
YW4gYmUgcmVzdG9yZWQsIGlmIGd1ZXN0IGtlcm5lbHMgYXJlCnRydXN0ZWQg
bm90IHRvIG1vdW50IGFuIGF0dGFjaywgYnkgc3BlY2lmeWluZyBlcHQ9ZXhl
Yy1zcCBvbiB0aGUgY29tbWFuZCBsaW5lLgoKVGhpcyBpcyBwYXJ0IG9mIFhT
QS0zMDQgLyBDVkUtMjAxOC0xMjIwNwoKU2lnbmVkLW9mZi1ieTogQW5kcmV3
IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6
IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KUmV2
aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRp
ZmYgLS1naXQgYS9kb2NzL21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2Mg
Yi9kb2NzL21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2MKaW5kZXggODUw
ODFmZGM5NC4uZTI4MzAxNzAxNSAxMDA2NDQKLS0tIGEvZG9jcy9taXNjL3hl
bi1jb21tYW5kLWxpbmUucGFuZG9jCisrKyBiL2RvY3MvbWlzYy94ZW4tY29t
bWFuZC1saW5lLnBhbmRvYwpAQCAtODk1LDcgKzg5NSw3IEBAIENvbnRyb2xz
IGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSBzeXN0ZW0gRXh0ZW5kZWQgRmly
bXdhcmUgSW50ZXJmYWNlLgogICAgIHVuY2FjaGVhYmxlLgogCiAjIyMgZXB0
Ci0+IGA9IExpc3Qgb2YgWyBhZD08Ym9vbD4sIHBtbD08Ym9vbD4gXWAKKz4g
YD0gTGlzdCBvZiBbIGFkPTxib29sPiwgcG1sPTxib29sPiwgZXhlYy1zcD08
Ym9vbD4gXWAKIAogPiBBcHBsaWNhYmlsaXR5OiBJbnRlbAogCkBAIC05MjYs
NiArOTI2LDE2IEBAIGludHJvZHVjZWQgd2l0aCB0aGUgTmVoYWxlbSBhcmNo
aXRlY3R1cmUuCiAgICAgZGlzYWJsZSBQTUwuICBgcG1sPTBgIGNhbiBiZSB1
c2VkIHRvIHByZXZlbnQgdGhlIHVzZSBvZiBQTUwgb24gb3RoZXJ3aXNlCiAg
ICAgY2FwYWJsZSBoYXJkd2FyZS4KIAorKiAgIFRoZSBgZXhlYy1zcGAgYm9v
bGVhbiBjb250cm9scyB3aGV0aGVyIEVQVCBzdXBlcnBhZ2VzIHdpdGggZXhl
Y3V0ZQorICAgIHBlcm1pc3Npb25zIGFyZSBwZXJtaXR0ZWQuICBJbiBnZW5l
cmFsIHRoaXMgaXMgZ29vZCBmb3IgcGVyZm9ybWFuY2UuCisKKyAgICBIb3dl
dmVyLCBvbiBwcm9jZXNzb3JzIHZ1bG5lcmFibGUgQ1ZFLTIwMTgtMTIyMDcs
IEhWTSBndWVzdCBrZXJuZWxzIGNhbgorICAgIHVzZSBleGVjdXRhYmxlIHN1
cGVycGFnZXMgdG8gY3Jhc2ggdGhlIGhvc3QuICBCeSBkZWZhdWx0LCBleGVj
dXRhYmxlCisgICAgc3VwZXJwYWdlcyBhcmUgZGlzYWJsZWQgb24gYWZmZWN0
ZWQgaGFyZHdhcmUuCisKKyAgICBJZiBIVk0gZ3Vlc3Qga2VybmVscyBhcmUg
dHJ1c3RlZCBub3QgdG8gbW91bnQgYSBEb1MgYWdhaW5zdCB0aGUgc3lzdGVt
LAorICAgIHRoaXMgb3B0aW9uIGNhbiBlbmFibGVkIHRvIHJlZ2FpbiBwZXJm
b3JtYW5jZS4KKwogIyMjIGV4dHJhX2d1ZXN0X2lycXMKID4gYD0gWzxkb21V
IG51bWJlcj5dWyw8ZG9tMCBudW1iZXI+XWAKIApkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L2h2bS9odm0uYyBiL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMK
aW5kZXggMjA4OWE3NzI3MC4uODQxOTFkNGU0YiAxMDA2NDQKLS0tIGEveGVu
L2FyY2gveDg2L2h2bS9odm0uYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2h2
bS5jCkBAIC0xODE0LDYgKzE4MTQsMjQgQEAgaW50IGh2bV9oYXBfbmVzdGVk
X3BhZ2VfZmF1bHQocGFkZHJfdCBncGEsIHVuc2lnbmVkIGxvbmcgZ2xhLAog
ICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KIAorICAgICAgICAvKgor
ICAgICAgICAgKiBXb3JrYXJvdW5kIGZvciBYU0EtMzA0IC8gQ1ZFLTIwMTgt
MTIyMDcuICBJZiB3ZSB0YWtlIGFuIGV4ZWN1dGlvbgorICAgICAgICAgKiBm
YXVsdCBhZ2FpbnN0IGEgbm9uLWV4ZWN1dGFibGUgc3VwZXJwYWdlLCBzaGF0
dGVyIGl0IHRvIHJlZ2FpbgorICAgICAgICAgKiBleGVjdXRlIHBlcm1pc3Np
b25zLgorICAgICAgICAgKi8KKyAgICAgICAgaWYgKCBwYWdlX29yZGVyID4g
MCAmJiBucGZlYy5pbnNuX2ZldGNoICYmIG5wZmVjLnByZXNlbnQgJiYgIXZp
b2xhdGlvbiApCisgICAgICAgIHsKKyAgICAgICAgICAgIGludCByZXMgPSBw
Mm1fc2V0X2VudHJ5KHAybSwgX2dmbihnZm4pLCBtZm4sIFBBR0VfT1JERVJf
NEssCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMm10
LCBwMm1hKTsKKworICAgICAgICAgICAgaWYgKCByZXMgKQorICAgICAgICAg
ICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQgdG8gc2hhdHRlciBn
Zm4gJSJQUklfZ2ZuIjogJWRcbiIsCisgICAgICAgICAgICAgICAgICAgICAg
IGdmbiwgcmVzKTsKKworICAgICAgICAgICAgcmMgPSAhcmVzOworICAgICAg
ICAgICAgZ290byBvdXRfcHV0X2dmbjsKKyAgICAgICAgfQorCiAgICAgICAg
IGlmICggdmlvbGF0aW9uICkKICAgICAgICAgewogICAgICAgICAgICAgLyog
U2hvdWxkICNWRSBiZSBlbXVsYXRlZCBmb3IgdGhpcyBmYXVsdD8gKi8KZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3MuYyBiL3hlbi9h
cmNoL3g4Ni9odm0vdm14L3ZtY3MuYwppbmRleCA1NjUxOWZlZTg0Li5lYzVh
Yjg2MGFkIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNz
LmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm1jcy5jCkBAIC02Nyw2
ICs2Nyw3IEBAIGludGVnZXJfcGFyYW0oInBsZV93aW5kb3ciLCBwbGVfd2lu
ZG93KTsKIAogc3RhdGljIGJvb2wgX19yZWFkX21vc3RseSBvcHRfZXB0X3Bt
bCA9IHRydWU7CiBzdGF0aWMgczggX19yZWFkX21vc3RseSBvcHRfZXB0X2Fk
ID0gLTE7CitpbnQ4X3QgX19yZWFkX21vc3RseSBvcHRfZXB0X2V4ZWNfc3Ag
PSAtMTsKIAogc3RhdGljIGludCBfX2luaXQgcGFyc2VfZXB0X3BhcmFtKGNv
bnN0IGNoYXIgKnMpCiB7CkBAIC04Miw2ICs4Myw4IEBAIHN0YXRpYyBpbnQg
X19pbml0IHBhcnNlX2VwdF9wYXJhbShjb25zdCBjaGFyICpzKQogICAgICAg
ICAgICAgb3B0X2VwdF9hZCA9IHZhbDsKICAgICAgICAgZWxzZSBpZiAoICh2
YWwgPSBwYXJzZV9ib29sZWFuKCJwbWwiLCBzLCBzcykpID49IDAgKQogICAg
ICAgICAgICAgb3B0X2VwdF9wbWwgPSB2YWw7CisgICAgICAgIGVsc2UgaWYg
KCAodmFsID0gcGFyc2VfYm9vbGVhbigiZXhlYy1zcCIsIHMsIHNzKSkgPj0g
MCApCisgICAgICAgICAgICBvcHRfZXB0X2V4ZWNfc3AgPSB2YWw7CiAgICAg
ICAgIGVsc2UKICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKIApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMgYi94ZW4vYXJjaC94
ODYvaHZtL3ZteC92bXguYwppbmRleCAyNmI3ZGRiNWZlLi4yOGNiYThlYzI4
IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYworKysg
Yi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYwpAQCAtMjQ0NSw2ICsyNDQ1
LDEwMiBAQCBzdGF0aWMgdm9pZCBwaV9ub3RpZmljYXRpb25faW50ZXJydXB0
KHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQogc3RhdGljIHZvaWQgX19p
bml0IGxicl90c3hfZml4dXBfY2hlY2sodm9pZCk7CiBzdGF0aWMgdm9pZCBf
X2luaXQgYmR3X2VycmF0dW1fYmRmMTRfZml4dXBfY2hlY2sodm9pZCk7CiAK
Ky8qCisgKiBDYWxjdWxhdGUgd2hldGhlciB0aGUgQ1BVIGlzIHZ1bG5lcmFi
bGUgdG8gSW5zdHJ1Y3Rpb24gRmV0Y2ggcGFnZQorICogc2l6ZS1jaGFuZ2Ug
TUNFcy4KKyAqLworc3RhdGljIGJvb2wgX19pbml0IGhhc19pZl9wc2NoYW5n
ZV9tYyh2b2lkKQoreworICAgIHVpbnQ2NF90IGNhcHMgPSAwOworCisgICAg
LyoKKyAgICAgKiBJZiB3ZSBhcmUgdmlydHVhbGlzZWQsIHRoZXJlIGlzIG5v
dGhpbmcgd2UgY2FuIGRvLiAgT3VyIEVQVCB0YWJsZXMgYXJlCisgICAgICog
c2hhZG93ZWQgYnkgb3VyIGh5cGVydmlzb3IsIGFuZCBub3Qgd2Fsa2VkIGJ5
IGhhcmR3YXJlLgorICAgICAqLworICAgIGlmICggY3B1X2hhc19oeXBlcnZp
c29yICkKKyAgICAgICAgcmV0dXJuIGZhbHNlOworCisgICAgaWYgKCBib290
X2NwdV9oYXMoWDg2X0ZFQVRVUkVfQVJDSF9DQVBTKSApCisgICAgICAgIHJk
bXNybChNU1JfQVJDSF9DQVBBQklMSVRJRVMsIGNhcHMpOworCisgICAgaWYg
KCBjYXBzICYgQVJDSF9DQVBTX0lGX1BTQ0hBTkdFX01DX05PICkKKyAgICAg
ICAgcmV0dXJuIGZhbHNlOworCisgICAgLyoKKyAgICAgKiBJRl9QU0NIQU5H
RV9NQyBpcyBvbmx5IGtub3duIHRvIGFmZmVjdCBJbnRlbCBGYW1pbHkgNiBw
cm9jZXNzb3JzIGF0CisgICAgICogdGhpcyB0aW1lLgorICAgICAqLworICAg
IGlmICggYm9vdF9jcHVfZGF0YS54ODZfdmVuZG9yICE9IFg4Nl9WRU5ET1Jf
SU5URUwgfHwKKyAgICAgICAgIGJvb3RfY3B1X2RhdGEueDg2ICE9IDYgKQor
ICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICBzd2l0Y2ggKCBib290X2Nw
dV9kYXRhLng4Nl9tb2RlbCApCisgICAgeworICAgICAgICAvKgorICAgICAg
ICAgKiBDb3JlIHByb2Nlc3NvcnMgc2luY2UgYXQgbGVhc3QgTmVoYWxlbSBh
cmUgdnVsbmVyYWJsZS4KKyAgICAgICAgICovCisgICAgY2FzZSAweDFmOiAv
KiBBdWJ1cm5kYWxlIC8gSGF2ZW5kYWxlICovCisgICAgY2FzZSAweDFlOiAv
KiBOZWhhbGVtICovCisgICAgY2FzZSAweDFhOiAvKiBOZWhhbGVtIEVQICov
CisgICAgY2FzZSAweDJlOiAvKiBOZWhhbGVtIEVYICovCisgICAgY2FzZSAw
eDI1OiAvKiBXZXN0bWVyZSAqLworICAgIGNhc2UgMHgyYzogLyogV2VzdG1l
cmUgRVAgKi8KKyAgICBjYXNlIDB4MmY6IC8qIFdlc3RtZXJlIEVYICovCisg
ICAgY2FzZSAweDJhOiAvKiBTYW5keUJyaWRnZSAqLworICAgIGNhc2UgMHgy
ZDogLyogU2FuZHlCcmlkZ2UgRVAvRVggKi8KKyAgICBjYXNlIDB4M2E6IC8q
IEl2eUJyaWRnZSAqLworICAgIGNhc2UgMHgzZTogLyogSXZ5QnJpZGdlIEVQ
L0VYICovCisgICAgY2FzZSAweDNjOiAvKiBIYXN3ZWxsICovCisgICAgY2Fz
ZSAweDNmOiAvKiBIYXN3ZWxsIEVYL0VQICovCisgICAgY2FzZSAweDQ1OiAv
KiBIYXN3ZWxsIEQgKi8KKyAgICBjYXNlIDB4NDY6IC8qIEhhc3dlbGwgSCAq
LworICAgIGNhc2UgMHgzZDogLyogQnJvYWR3ZWxsICovCisgICAgY2FzZSAw
eDQ3OiAvKiBCcm9hZHdlbGwgSCAqLworICAgIGNhc2UgMHg0ZjogLyogQnJv
YWR3ZWxsIEVQL0VYICovCisgICAgY2FzZSAweDU2OiAvKiBCcm9hZHdlbGwg
RCAqLworICAgIGNhc2UgMHg0ZTogLyogU2t5bGFrZSBNICovCisgICAgY2Fz
ZSAweDVlOiAvKiBTa3lsYWtlIEQgKi8KKyAgICBjYXNlIDB4NTU6IC8qIFNr
eWxha2UtWCAvIENhc2NhZGUgTGFrZSAqLworICAgIGNhc2UgMHg4ZTogLyog
S2FieSAvIENvZmZlZSAvIFdoaXNrZXkgTGFrZSBNICovCisgICAgY2FzZSAw
eDllOiAvKiBLYWJ5IC8gQ29mZmVlIC8gV2hpc2tleSBMYWtlIEQgKi8KKyAg
ICAgICAgcmV0dXJuIHRydWU7CisKKyAgICAgICAgLyoKKyAgICAgICAgICog
QXRvbSBwcm9jZXNzb3JzIGFyZSBub3QgdnVsbmVyYWJsZS4KKyAgICAgICAg
ICovCisgICAgY2FzZSAweDFjOiAvKiBQaW5ldmlldyAqLworICAgIGNhc2Ug
MHgyNjogLyogTGluY3JvZnQgKi8KKyAgICBjYXNlIDB4Mjc6IC8qIFBlbndl
bGwgKi8KKyAgICBjYXNlIDB4MzU6IC8qIENsb3ZlcnZpZXcgKi8KKyAgICBj
YXNlIDB4MzY6IC8qIENlZGFydmlldyAqLworICAgIGNhc2UgMHgzNzogLyog
QmF5dHJhaWwgLyBWYWxsZXl2aWV3IChTaWx2ZXJtb250KSAqLworICAgIGNh
c2UgMHg0ZDogLyogQXZhdG9uIC8gUmFuZ2VseSAoU2lsdmVybW9udCkgKi8K
KyAgICBjYXNlIDB4NGM6IC8qIENoZXJyeXRyYWlsIC8gQnJhc3N3ZWxsICov
CisgICAgY2FzZSAweDRhOiAvKiBNZXJyaWZpZWxkICovCisgICAgY2FzZSAw
eDVhOiAvKiBNb29yZWZpZWxkICovCisgICAgY2FzZSAweDVjOiAvKiBHb2xk
bW9udCAqLworICAgIGNhc2UgMHg1ZDogLyogU29GSUEgM0cgR3Jhbml0ZS9F
UzIuMSAqLworICAgIGNhc2UgMHg2NTogLyogU29GSUEgTFRFIEFPU1AgKi8K
KyAgICBjYXNlIDB4NWY6IC8qIERlbnZlcnRvbiAqLworICAgIGNhc2UgMHg2
ZTogLyogQ291Z2FyIE1vdW50YWluICovCisgICAgY2FzZSAweDc1OiAvKiBM
aWdodG5pbmcgTW91bnRhaW4gKi8KKyAgICBjYXNlIDB4N2E6IC8qIEdlbWlu
aSBMYWtlICovCisgICAgY2FzZSAweDg2OiAvKiBKYWNvYnN2aWxsZSAqLwor
CisgICAgICAgIC8qCisgICAgICAgICAqIEtuaWdodHMgcHJvY2Vzc29ycyBh
cmUgbm90IHZ1bG5lcmFibGUuCisgICAgICAgICAqLworICAgIGNhc2UgMHg1
NzogLyogS25pZ2h0cyBMYW5kaW5nICovCisgICAgY2FzZSAweDg1OiAvKiBL
bmlnaHRzIE1pbGwgKi8KKyAgICAgICAgcmV0dXJuIGZhbHNlOworCisgICAg
ZGVmYXVsdDoKKyAgICAgICAgcHJpbnRrKCJVbnJlY29nbmlzZWQgQ1BVIG1v
ZGVsICUjeCAtIGFzc3VtaW5nIHZ1bG5lcmFibGUgdG8gSUZfUFNDSEFOR0Vf
TUNcbiIsCisgICAgICAgICAgICAgICBib290X2NwdV9kYXRhLng4Nl9tb2Rl
bCk7CisgICAgICAgIHJldHVybiB0cnVlOworICAgIH0KK30KKwogY29uc3Qg
c3RydWN0IGh2bV9mdW5jdGlvbl90YWJsZSAqIF9faW5pdCBzdGFydF92bXgo
dm9pZCkKIHsKICAgICBzZXRfaW5fY3I0KFg4Nl9DUjRfVk1YRSk7CkBAIC0y
NDY1LDYgKzI1NjEsMTcgQEAgY29uc3Qgc3RydWN0IGh2bV9mdW5jdGlvbl90
YWJsZSAqIF9faW5pdCBzdGFydF92bXgodm9pZCkKICAgICAgKi8KICAgICBp
ZiAoIGNwdV9oYXNfdm14X2VwdCAmJiAoY3B1X2hhc192bXhfcGF0IHx8IG9w
dF9mb3JjZV9lcHQpICkKICAgICB7CisgICAgICAgIGJvb2wgY3B1X2hhc19i
dWdfcHNjaGFuZ2VfbWMgPSBoYXNfaWZfcHNjaGFuZ2VfbWMoKTsKKworICAg
ICAgICBpZiAoIG9wdF9lcHRfZXhlY19zcCA9PSAtMSApCisgICAgICAgIHsK
KyAgICAgICAgICAgIC8qIERlZmF1bHQgdG8gbm9uLWV4ZWN1dGFibGUgc3Vw
ZXJwYWdlcyBvbiB2dWxuZXJhYmxlIGhhcmR3YXJlLiAqLworICAgICAgICAg
ICAgb3B0X2VwdF9leGVjX3NwID0gIWNwdV9oYXNfYnVnX3BzY2hhbmdlX21j
OworCisgICAgICAgICAgICBpZiAoIGNwdV9oYXNfYnVnX3BzY2hhbmdlX21j
ICkKKyAgICAgICAgICAgICAgICBwcmludGsoIlZNWDogRGlzYWJsaW5nIGV4
ZWN1dGFibGUgRVBUIHN1cGVycGFnZXMgZHVlIHRvIENWRS0yMDE4LTEyMjA3
XG4iKTsKKyAgICAgICAgfQorCiAgICAgICAgIHZteF9mdW5jdGlvbl90YWJs
ZS5oYXBfc3VwcG9ydGVkID0gMTsKICAgICAgICAgdm14X2Z1bmN0aW9uX3Rh
YmxlLmFsdHAybV9zdXBwb3J0ZWQgPSAxOwogCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvbW0vcDJtLWVwdC5jIGIveGVuL2FyY2gveDg2L21tL3AybS1l
cHQuYwppbmRleCA5NTJlYmFkODJmLi44MzRkNDc5OGM4IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbW0vcDJtLWVwdC5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS9wMm0tZXB0LmMKQEAgLTE3NCw2ICsxNzQsMTIgQEAgc3RhdGljIHZv
aWQgZXB0X3AybV90eXBlX3RvX2ZsYWdzKHN0cnVjdCBwMm1fZG9tYWluICpw
Mm0sIGVwdF9lbnRyeV90ICplbnRyeSwKICAgICAgICAgICAgIGJyZWFrOwog
ICAgIH0KICAgICAKKyAgICAvKgorICAgICAqIERvbid0IGNyZWF0ZSBleGVj
dXRhYmxlIHN1cGVycGFnZXMgaWYgd2UgbmVlZCB0byBzaGF0dGVyIHRoZW0g
dG8KKyAgICAgKiBwcm90ZWN0IGFnYWluc3QgQ1ZFLTIwMTgtMTIyMDcuCisg
ICAgICovCisgICAgaWYgKCAhb3B0X2VwdF9leGVjX3NwICYmIGlzX2VwdGVf
c3VwZXJwYWdlKGVudHJ5KSApCisgICAgICAgIGVudHJ5LT54ID0gMDsKIH0K
IAogI2RlZmluZSBHVUVTVF9UQUJMRV9NQVBfRkFJTEVEICAwCmRpZmYgLS1n
aXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS92bXgvdm14LmggYi94ZW4v
aW5jbHVkZS9hc20teDg2L2h2bS92bXgvdm14LmgKaW5kZXggZWJhYTc0NDQ5
Yi4uMzcxYjkxMjg4NyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4
Ni9odm0vdm14L3ZteC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZt
L3ZteC92bXguaApAQCAtMjgsNiArMjgsOCBAQAogI2luY2x1ZGUgPGFzbS9o
dm0vdHJhY2UuaD4KICNpbmNsdWRlIDxhc20vaHZtL3ZteC92bWNzLmg+CiAK
K2V4dGVybiBpbnQ4X3Qgb3B0X2VwdF9leGVjX3NwOworCiB0eXBlZGVmIHVu
aW9uIHsKICAgICBzdHJ1Y3QgewogICAgICAgICB1NjQgciAgICAgICA6ICAg
MSwgIC8qIGJpdCAwIC0gUmVhZCBwZXJtaXNzaW9uICovCmRpZmYgLS1naXQg
YS94ZW4vaW5jbHVkZS9hc20teDg2L21zci1pbmRleC5oIGIveGVuL2luY2x1
ZGUvYXNtLXg4Ni9tc3ItaW5kZXguaAppbmRleCA2MzcyNTliZDFmLi4zMjc0
NmFhOGFlIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21zci1p
bmRleC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbXNyLWluZGV4LmgK
QEAgLTUyLDYgKzUyLDcgQEAKICNkZWZpbmUgQVJDSF9DQVBTX1NLSVBfTDFE
RkwJCShfQUMoMSwgVUxMKSA8PCAzKQogI2RlZmluZSBBUkNIX0NBUFNfU1NC
X05PCQkoX0FDKDEsIFVMTCkgPDwgNCkKICNkZWZpbmUgQVJDSF9DQVBTX01E
U19OTwkJKF9BQygxLCBVTEwpIDw8IDUpCisjZGVmaW5lIEFSQ0hfQ0FQU19J
Rl9QU0NIQU5HRV9NQ19OTwkoX0FDKDEsIFVMTCkgPDwgNikKIAogI2RlZmlu
ZSBNU1JfRkxVU0hfQ01ECQkJMHgwMDAwMDEwYgogI2RlZmluZSBGTFVTSF9D
TURfTDFECQkJKF9BQygxLCBVTEwpIDw8IDApCg==

--=separator
Content-Type: application/octet-stream; name="xsa304/xsa304-4.12-3.patch"
Content-Disposition: attachment; filename="xsa304/xsa304-4.12-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogeDg2L3Z0eDogQWxsb3cgcnVudGltZSBtb2RpZmljYXRp
b24gb2YgdGhlIGV4ZWMtc3Agc2V0dGluZwoKU2VlIHBhdGNoIGZvciBkZXRh
aWxzLgoKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEdlb3JnZSBEdW5sYXAg
PGdlb3JnZS5kdW5sYXBAY2l0cml4LmNvbT4KCmRpZmYgLS1naXQgYS9kb2Nz
L21pc2MveGVuLWNvbW1hbmQtbGluZS5wYW5kb2MgYi9kb2NzL21pc2MveGVu
LWNvbW1hbmQtbGluZS5wYW5kb2MKaW5kZXggZTI4MzAxNzAxNS4uODQyMjFm
ZTYwYSAxMDA2NDQKLS0tIGEvZG9jcy9taXNjL3hlbi1jb21tYW5kLWxpbmUu
cGFuZG9jCisrKyBiL2RvY3MvbWlzYy94ZW4tY29tbWFuZC1saW5lLnBhbmRv
YwpAQCAtOTM2LDYgKzkzNiwyMSBAQCBpbnRyb2R1Y2VkIHdpdGggdGhlIE5l
aGFsZW0gYXJjaGl0ZWN0dXJlLgogICAgIElmIEhWTSBndWVzdCBrZXJuZWxz
IGFyZSB0cnVzdGVkIG5vdCB0byBtb3VudCBhIERvUyBhZ2FpbnN0IHRoZSBz
eXN0ZW0sCiAgICAgdGhpcyBvcHRpb24gY2FuIGVuYWJsZWQgdG8gcmVnYWlu
IHBlcmZvcm1hbmNlLgogCisgICAgVGhpcyBib29sZWFuIG1heSBiZSBtb2Rp
ZmllZCBhdCBydW50aW1lIHVzaW5nIGB4bCBzZXQtcGFyYW1ldGVycworICAg
IGVwdD1bbm8tXWV4ZWMtc3BgIHRvIHN3aXRjaCBiZXR3ZWVuIGZhc3QgYW5k
IHNlY3VyZS4KKworICAgICogICBXaGVuIHN3aXRjaGluZyBmcm9tIHNlY3Vy
ZSB0byBmYXN0LCBwcmVleGlzdGluZyBIVk0gZG9tYWlucyB3aWxsIHJ1bgor
ICAgICAgICBhdCB0aGVpciBjdXJyZW50IHBlcmZvcm1hbmNlIHVudGlsIHRo
ZXkgYXJlIHJlYm9vdGVkOyBuZXcgZG9tYWlucyB3aWxsCisgICAgICAgIHJ1
biB3aXRob3V0IGFueSBvdmVyaGVhZC4KKworICAgICogICBXaGVuIHN3aXRj
aGluZyBmcm9tIGZhc3QgdG8gc2VjdXJlLCBhbGwgSFZNIGRvbWFpbnMgd2ls
bCBpbW1lZGlhdGVseQorICAgICAgICBzdWZmZXIgYSBwZXJmb3JtYW5jZSBw
ZW5hbHR5LgorCisgICAgKipXYXJuaW5nOiBObyBndWFyYW50ZWUgaXMgbWFk
ZSB0aGF0IHRoaXMgcnVudGltZSBvcHRpb24gd2lsbCBiZSByZXRhaW5lZAor
ICAgICAgaW5kZWZpbml0ZWx5LCBvciB0aGF0IGl0IHdpbGwgcmV0YWluIHRo
aXMgZXhhY3QgYmVoYXZpb3VyLiAgSXQgaXMKKyAgICAgIGludGVuZGVkIGFz
IGFuIGVtZXJnZW5jeSBvcHRpb24gZm9yIHBlb3BsZSB3aG8gZmlyc3QgY2hv
c2UgZmFzdCwgdGhlbgorICAgICAgY2hhbmdlIHRoZWlyIG1pbmRzIHRvIHNl
Y3VyZSwgYW5kIHdpc2ggbm90IHRvIHJlYm9vdC4qKgorCiAjIyMgZXh0cmFf
Z3Vlc3RfaXJxcwogPiBgPSBbPGRvbVUgbnVtYmVyPl1bLDxkb20wIG51bWJl
cj5dYAogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNz
LmMgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92bWNzLmMKaW5kZXggZWM1YWI4
NjBhZC4uYzRkOGE1YmE3OCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2
bS92bXgvdm1jcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZtY3Mu
YwpAQCAtOTUsNiArOTUsNDEgQEAgc3RhdGljIGludCBfX2luaXQgcGFyc2Vf
ZXB0X3BhcmFtKGNvbnN0IGNoYXIgKnMpCiB9CiBjdXN0b21fcGFyYW0oImVw
dCIsIHBhcnNlX2VwdF9wYXJhbSk7CiAKK3N0YXRpYyBpbnQgcGFyc2VfZXB0
X3BhcmFtX3J1bnRpbWUoY29uc3QgY2hhciAqcykKK3sKKyAgICBpbnQgdmFs
OworCisgICAgaWYgKCAhY3B1X2hhc192bXhfZXB0IHx8ICFodm1fZnVuY3Mu
aGFwX3N1cHBvcnRlZCB8fAorICAgICAgICAgIShodm1fZnVuY3MuaGFwX2Nh
cGFiaWxpdGllcyAmCisgICAgICAgICAgIChIVk1fSEFQX1NVUEVSUEFHRV8y
TUIgfCBIVk1fSEFQX1NVUEVSUEFHRV8xR0IpKSApCisgICAgeworICAgICAg
ICBwcmludGsoIlZNWDogRVBUIG5vdCBhdmFpbGFibGUsIG9yIG5vdCBpbiB1
c2UgLSBpZ25vcmluZ1xuIik7CisgICAgICAgIHJldHVybiAwOworICAgIH0K
KworICAgIGlmICggKHZhbCA9IHBhcnNlX2Jvb2xlYW4oImV4ZWMtc3AiLCBz
LCBOVUxMKSkgPCAwICkKKyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisKKyAg
ICBpZiAoIHZhbCAhPSBvcHRfZXB0X2V4ZWNfc3AgKQorICAgIHsKKyAgICAg
ICAgc3RydWN0IGRvbWFpbiAqZDsKKworICAgICAgICBvcHRfZXB0X2V4ZWNf
c3AgPSB2YWw7CisKKyAgICAgICAgcmN1X3JlYWRfbG9jaygmZG9tbGlzdF9y
ZWFkX2xvY2spOworICAgICAgICBmb3JfZWFjaF9kb21haW4gKCBkICkKKyAg
ICAgICAgICAgIGlmICggcGFnaW5nX21vZGVfaGFwKGQpICkKKyAgICAgICAg
ICAgICAgICBwMm1fY2hhbmdlX2VudHJ5X3R5cGVfZ2xvYmFsKGQsIHAybV9y
YW1fcncsIHAybV9yYW1fcncpOworICAgICAgICByY3VfcmVhZF91bmxvY2so
JmRvbWxpc3RfcmVhZF9sb2NrKTsKKyAgICB9CisKKyAgICBwcmludGsoIlZN
WDogRVBUIGV4ZWN1dGFibGUgc3VwZXJwYWdlcyAlc2FibGVkXG4iLAorICAg
ICAgICAgICB2YWwgPyAiZW4iIDogImRpcyIpOworCisgICAgcmV0dXJuIDA7
Cit9CitjdXN0b21fcnVudGltZV9vbmx5X3BhcmFtKCJlcHQiLCBwYXJzZV9l
cHRfcGFyYW1fcnVudGltZSk7CisKIC8qIER5bmFtaWMgKHJ1bi10aW1lIGFk
anVzdGVkKSBleGVjdXRpb24gY29udHJvbCBmbGFncy4gKi8KIHUzMiB2bXhf
cGluX2Jhc2VkX2V4ZWNfY29udHJvbCBfX3JlYWRfbW9zdGx5OwogdTMyIHZt
eF9jcHVfYmFzZWRfZXhlY19jb250cm9sIF9fcmVhZF9tb3N0bHk7CmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvbW0vcDJtLmMgYi94ZW4vYXJjaC94ODYv
bW0vcDJtLmMKaW5kZXggZjUxOGY4NjQ5My4uMTY2MDgwOThiMSAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L21tL3AybS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9tbS9wMm0uYwpAQCAtMjg5LDE1ICsyODksMjAgQEAgc3RhdGljIHZvaWQg
Y2hhbmdlX2VudHJ5X3R5cGVfZ2xvYmFsKHN0cnVjdCBwMm1fZG9tYWluICpw
Mm0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJt
X3R5cGVfdCBvdCwgcDJtX3R5cGVfdCBudCkKIHsKICAgICBwMm0tPmNoYW5n
ZV9lbnRyeV90eXBlX2dsb2JhbChwMm0sIG90LCBudCk7Ci0gICAgcDJtLT5n
bG9iYWxfbG9nZGlydHkgPSAobnQgPT0gcDJtX3JhbV9sb2dkaXJ0eSk7Cisg
ICAgLyogRG9uJ3QgYWxsb3cgJ3JlY2FsY3VsYXRlJyBvcGVyYXRpb25zIHRv
IGNoYW5nZSB0aGUgbG9nZGlydHkgc3RhdGUuICovCisgICAgaWYgKCBvdCAh
PSBudCApCisgICAgICAgIHAybS0+Z2xvYmFsX2xvZ2RpcnR5ID0gKG50ID09
IHAybV9yYW1fbG9nZGlydHkpOwogfQogCisvKgorICogTWF5IGJlIGNhbGxl
ZCB3aXRoIG90ID0gbnQgPSBwMm1fcmFtX3J3IGZvciBpdHMgc2lkZSBlZmZl
Y3Qgb2YKKyAqIHJlY2FsY3VsYXRpbmcgYWxsIFBURXMgaW4gdGhlIHAybS4K
KyAqLwogdm9pZCBwMm1fY2hhbmdlX2VudHJ5X3R5cGVfZ2xvYmFsKHN0cnVj
dCBkb21haW4gKmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcDJtX3R5cGVfdCBvdCwgcDJtX3R5cGVfdCBudCkKIHsKICAgICBzdHJ1
Y3QgcDJtX2RvbWFpbiAqaG9zdHAybSA9IHAybV9nZXRfaG9zdHAybShkKTsK
IAotICAgIEFTU0VSVChvdCAhPSBudCk7CiAgICAgQVNTRVJUKHAybV9pc19j
aGFuZ2VhYmxlKG90KSAmJiBwMm1faXNfY2hhbmdlYWJsZShudCkpOwogCiAg
ICAgcDJtX2xvY2soaG9zdHAybSk7Cg==

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


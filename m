Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id EB2092C464
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:36:02 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZQ4-0004Zs-Mn; Tue, 28 May 2019 10:33:24 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZQ2-0004Xi-7R
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:33:22 +0000
X-Inumbo-ID: 030aa49b-8134-11e9-8980-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 030aa49b-8134-11e9-8980-bc764e045a96;
 Tue, 28 May 2019 10:33:20 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 35921B028;
 Tue, 28 May 2019 10:33:18 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:32:21 +0200
Message-Id: <20190528103313.1343-9-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 08/60] xen/sched: introduce struct sched_resource
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Meng Xu <mengxu@cis.upenn.edu>,
 Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIGEgc2NoZWR1bGluZyBhYnN0cmFjdGlvbiBsYXllciBiZXR3ZWVuIHBoeXNpY2FsIHByb2Nl
c3NvcnMgYW5kIHRoZQpzY2hlZHVsZXJzIGJ5IGludHJvZHVjaW5nIGEgc3RydWN0IHNjaGVkX3Jl
c291cmNlLiBFYWNoIHNjaGVkdWxlciB1bml0CnJ1bm5pbmcgaXMgYWN0aXZlIG9uIHN1Y2ggYSBz
Y2hlZHVsZXIgcmVzb3VyY2UuIEZvciB0aGUgdGltZSBiZWluZwp0aGVyZSBpcyBvbmUgc3RydWN0
IHNjaGVkX3Jlc291cmNlIHBlciBjcHUsIGJ1dCBpbiBmdXR1cmUgdGhlcmUgbWlnaHQKYmUgb25l
IGZvciBlYWNoIGNvcmUgb3Igc29ja2V0IG9ubHkuCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdy
b3NzIDxqZ3Jvc3NAc3VzZS5jb20+Ci0tLQpWMTogYWRkIGFjY2Vzc29yIGZ1bmN0aW9ucwotLS0K
IHhlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMgIHwgIDIgKysKIHhlbi9jb21tb24vc2NoZWRfY3Jl
ZGl0Mi5jIHwgIDcgKysrKysrKwogeGVuL2NvbW1vbi9zY2hlZF9udWxsLmMgICAgfCAgMyArKysK
IHhlbi9jb21tb24vc2NoZWRfcnQuYyAgICAgIHwgIDIgKysKIHhlbi9jb21tb24vc2NoZWR1bGUu
YyAgICAgIHwgMTUgKysrKysrKysrKysrKysrCiB4ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaCB8
IDE4ICsrKysrKysrKysrKysrKysrKwogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggICAgfCAgMyAr
KysKIDcgZmlsZXMgY2hhbmdlZCwgNTAgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vc2NoZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4IDRj
ZmVmMTg5YWEuLjBjZDEzOWVjMjkgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtMTAzMSw2ICsxMDMxLDcgQEAg
Y3NjaGVkX3VuaXRfaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNj
aGVkX3VuaXQgKnVuaXQpCiAgICAgbG9jayA9IHZjcHVfc2NoZWR1bGVfbG9ja19pcnEodmMpOwog
CiAgICAgdmMtPnByb2Nlc3NvciA9IGNzY2hlZF9jcHVfcGljayhvcHMsIHVuaXQpOworICAgIHVu
aXQtPnJlcyA9IGdldF9zY2hlZF9yZXModmMtPnByb2Nlc3Nvcik7CiAKICAgICBzcGluX3VubG9j
a19pcnEobG9jayk7CiAKQEAgLTE2NjcsNiArMTY2OCw3IEBAIGNzY2hlZF9ydW5xX3N0ZWFsKGlu
dCBwZWVyX2NwdSwgaW50IGNwdSwgaW50IHByaSwgaW50IGJhbGFuY2Vfc3RlcCkKICAgICAgICAg
ICAgIFdBUk5fT04odmMtPmlzX3VyZ2VudCk7CiAgICAgICAgICAgICBydW5xX3JlbW92ZShzcGVl
cik7CiAgICAgICAgICAgICB2Yy0+cHJvY2Vzc29yID0gY3B1OworICAgICAgICAgICAgdmMtPnNj
aGVkX3VuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXMoY3B1KTsKICAgICAgICAgICAgIC8qCiAgICAg
ICAgICAgICAgKiBzcGVlciB3aWxsIHN0YXJ0IGV4ZWN1dGluZyBkaXJlY3RseSBvbiBjcHUsIHdp
dGhvdXQgaGF2aW5nIHRvCiAgICAgICAgICAgICAgKiBnbyB0aHJvdWdoIHJ1bnFfaW5zZXJ0KCku
IFNvIHdlIG11c3QgdXBkYXRlIHRoZSBydW5uYWJsZSBjb3VudApkaWZmIC0tZ2l0IGEveGVuL2Nv
bW1vbi9zY2hlZF9jcmVkaXQyLmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwppbmRleCA4
NmI0NGRjNmNmLi5jOTJhMDkwOTA1IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRp
dDIuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwpAQCAtMjUxOSw2ICsyNTE5LDcg
QEAgc3RhdGljIHZvaWQgbWlncmF0ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsCiAgICAg
ICAgICAgICAgICAgICAgICZ0cnFkLT5hY3RpdmUpOwogICAgICAgICBzdmMtPnZjcHUtPnByb2Nl
c3NvciA9IGNwdW1hc2tfY3ljbGUodHJxZC0+cGlja19iaWFzLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY3B1bWFza19zY3JhdGNoX2NwdShjcHUpKTsKKyAg
ICAgICAgc3ZjLT52Y3B1LT5zY2hlZF91bml0LT5yZXMgPSBnZXRfc2NoZWRfcmVzKHN2Yy0+dmNw
dS0+cHJvY2Vzc29yKTsKICAgICAgICAgdHJxZC0+cGlja19iaWFzID0gc3ZjLT52Y3B1LT5wcm9j
ZXNzb3I7CiAgICAgICAgIEFTU0VSVChzdmMtPnZjcHUtPnByb2Nlc3NvciA8IG5yX2NwdV9pZHMp
OwogCkBAIC0yNzc0LDYgKzI3NzUsNyBAQCBjc2NoZWQyX3VuaXRfbWlncmF0ZSgKICAgICAgICAg
fQogICAgICAgICBfcnVucV9kZWFzc2lnbihzdmMpOwogICAgICAgICB2Yy0+cHJvY2Vzc29yID0g
bmV3X2NwdTsKKyAgICAgICAgdW5pdC0+cmVzID0gZ2V0X3NjaGVkX3JlcyhuZXdfY3B1KTsKICAg
ICAgICAgcmV0dXJuOwogICAgIH0KIApAQCAtMjc5NCw3ICsyNzk2LDEwIEBAIGNzY2hlZDJfdW5p
dF9taWdyYXRlKAogICAgIGlmICggdHJxZCAhPSBzdmMtPnJxZCApCiAgICAgICAgIG1pZ3JhdGUo
b3BzLCBzdmMsIHRycWQsIG5vdyk7CiAgICAgZWxzZQorICAgIHsKICAgICAgICAgdmMtPnByb2Nl
c3NvciA9IG5ld19jcHU7CisgICAgICAgIHVuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXMobmV3X2Nw
dSk7CisgICAgfQogfQogCiBzdGF0aWMgaW50CkBAIC0zMTE5LDYgKzMxMjQsNyBAQCBjc2NoZWQy
X3VuaXRfaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3Vu
aXQgKnVuaXQpCiAgICAgbG9jayA9IHZjcHVfc2NoZWR1bGVfbG9ja19pcnEodmMpOwogCiAgICAg
dmMtPnByb2Nlc3NvciA9IGNzY2hlZDJfY3B1X3BpY2sob3BzLCB1bml0KTsKKyAgICB1bml0LT5y
ZXMgPSBnZXRfc2NoZWRfcmVzKHZjLT5wcm9jZXNzb3IpOwogCiAgICAgc3Bpbl91bmxvY2tfaXJx
KGxvY2spOwogCkBAIC0zNTk2LDYgKzM2MDIsNyBAQCBjc2NoZWQyX3NjaGVkdWxlKAogICAgICAg
ICB7CiAgICAgICAgICAgICBzbmV4dC0+Y3JlZGl0ICs9IENTQ0hFRDJfTUlHUkFURV9DT01QRU5T
QVRJT047CiAgICAgICAgICAgICBzbmV4dC0+dmNwdS0+cHJvY2Vzc29yID0gY3B1OworICAgICAg
ICAgICAgc25leHQtPnZjcHUtPnNjaGVkX3VuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXMoY3B1KTsK
ICAgICAgICAgICAgIFNDSEVEX1NUQVRfQ1JBTksobWlncmF0ZWQpOwogICAgICAgICAgICAgcmV0
Lm1pZ3JhdGVkID0gMTsKICAgICAgICAgfQpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9u
dWxsLmMgYi94ZW4vY29tbW9uL3NjaGVkX251bGwuYwppbmRleCBiNjIyYzRkN2RjLi43YzAxZDAy
NzJkIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX251bGwuYworKysgYi94ZW4vY29tbW9u
L3NjaGVkX251bGwuYwpAQCAtMzQzLDYgKzM0Myw3IEBAIHN0YXRpYyB2b2lkIHZjcHVfYXNzaWdu
KHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiwgc3RydWN0IHZjcHUgKnYsCiB7CiAgICAgcGVyX2Nw
dShucGMsIGNwdSkudmNwdSA9IHY7CiAgICAgdi0+cHJvY2Vzc29yID0gY3B1OworICAgIHYtPnNj
aGVkX3VuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXMoY3B1KTsKICAgICBjcHVtYXNrX2NsZWFyX2Nw
dShjcHUsICZwcnYtPmNwdXNfZnJlZSk7CiAKICAgICBkcHJpbnRrKFhFTkxPR19HX0lORk8sICIl
ZCA8LS0gJXB2XG4iLCBjcHUsIHYpOwpAQCAtNDIxLDYgKzQyMiw3IEBAIHN0YXRpYyB2b2lkIG51
bGxfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAogIHJldHJ5OgogCiAg
ICAgY3B1ID0gdi0+cHJvY2Vzc29yID0gcGlja19jcHUocHJ2LCB2KTsKKyAgICB1bml0LT5yZXMg
PSBnZXRfc2NoZWRfcmVzKGNwdSk7CiAKICAgICBzcGluX3VubG9jayhsb2NrKTsKIApAQCAtNjY3
LDYgKzY2OSw3IEBAIHN0YXRpYyB2b2lkIG51bGxfdW5pdF9taWdyYXRlKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKm9wcywKICAgICAgKiBieSB0aGlzLCB3aWxsIGJlIGZpeGVkLXVwIGR1cmluZyBy
ZXN1bWUuCiAgICAgICovCiAgICAgdi0+cHJvY2Vzc29yID0gbmV3X2NwdTsKKyAgICB1bml0LT5y
ZXMgPSBnZXRfc2NoZWRfcmVzKG5ld19jcHUpOwogfQogCiAjaWZuZGVmIE5ERUJVRwpkaWZmIC0t
Z2l0IGEveGVuL2NvbW1vbi9zY2hlZF9ydC5jIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCmluZGV4
IDcwMGVlOTM1M2UuLjcxNWE3Y2QyMTggMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfcnQu
YworKysgYi94ZW4vY29tbW9uL3NjaGVkX3J0LmMKQEAgLTg5NCw2ICs4OTQsNyBAQCBydF91bml0
X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1
bml0KQogCiAgICAgLyogVGhpcyBpcyBzYWZlIGJlY2F1c2UgdmMgaXNuJ3QgeWV0IGJlaW5nIHNj
aGVkdWxlZCAqLwogICAgIHZjLT5wcm9jZXNzb3IgPSBydF9jcHVfcGljayhvcHMsIHVuaXQpOwor
ICAgIHVuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXModmMtPnByb2Nlc3Nvcik7CiAKICAgICBsb2Nr
ID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2Yyk7CiAKQEAgLTExMjQsNiArMTEyNSw3IEBAIHJ0
X3NjaGVkdWxlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc190aW1lX3Qgbm93LCBib29s
X3QgdGFza2xldF93b3JrX3NjaGVkCiAgICAgICAgIGlmICggc25leHQtPnZjcHUtPnByb2Nlc3Nv
ciAhPSBjcHUgKQogICAgICAgICB7CiAgICAgICAgICAgICBzbmV4dC0+dmNwdS0+cHJvY2Vzc29y
ID0gY3B1OworICAgICAgICAgICAgc25leHQtPnZjcHUtPnNjaGVkX3VuaXQtPnJlcyA9IGdldF9z
Y2hlZF9yZXMoY3B1KTsKICAgICAgICAgICAgIHJldC5taWdyYXRlZCA9IDE7CiAgICAgICAgIH0K
ICAgICAgICAgcmV0LnRpbWUgPSBzbmV4dC0+Y3VyX2J1ZGdldDsgLyogaW52b2tlIHRoZSBzY2hl
ZHVsZXIgbmV4dCB0aW1lICovCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMgYi94
ZW4vY29tbW9uL3NjaGVkdWxlLmMKaW5kZXggNDlkMjU0ODllZi4uMzJjZTI0OGYyNCAxMDA2NDQK
LS0tIGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jCisrKyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwpA
QCAtNjMsNiArNjMsNyBAQCBzdGF0aWMgdm9pZCBwb2xsX3RpbWVyX2ZuKHZvaWQgKmRhdGEpOwog
LyogVGhpcyBpcyBnbG9iYWwgZm9yIG5vdyBzbyB0aGF0IHByaXZhdGUgaW1wbGVtZW50YXRpb25z
IGNhbiByZWFjaCBpdCAqLwogREVGSU5FX1BFUl9DUFUoc3RydWN0IHNjaGVkdWxlX2RhdGEsIHNj
aGVkdWxlX2RhdGEpOwogREVGSU5FX1BFUl9DUFUoc3RydWN0IHNjaGVkdWxlciAqLCBzY2hlZHVs
ZXIpOworREVGSU5FX1BFUl9DUFUoc3RydWN0IHNjaGVkX3Jlc291cmNlICosIHNjaGVkX3Jlcyk7
CiAKIC8qIFNjcmF0Y2ggc3BhY2UgZm9yIGNwdW1hc2tzLiAqLwogREVGSU5FX1BFUl9DUFUoY3B1
bWFza190LCBjcHVtYXNrX3NjcmF0Y2gpOwpAQCAtMzA1LDYgKzMwNiw3IEBAIGludCBzY2hlZF9p
bml0X3ZjcHUoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwcm9jZXNzb3IpCiAgICAgaWYg
KCAodW5pdCA9IHNjaGVkX2FsbG9jX3VuaXQodikpID09IE5VTEwgKQogICAgICAgICByZXR1cm4g
MTsKIAorICAgIHVuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXMocHJvY2Vzc29yKTsKICAgICAvKiBJ
bml0aWFsaXNlIHRoZSBwZXItdmNwdSB0aW1lcnMuICovCiAgICAgaW5pdF90aW1lcigmdi0+cGVy
aW9kaWNfdGltZXIsIHZjcHVfcGVyaW9kaWNfdGltZXJfZm4sCiAgICAgICAgICAgICAgICB2LCB2
LT5wcm9jZXNzb3IpOwpAQCAtNDE5LDYgKzQyMSw3IEBAIGludCBzY2hlZF9tb3ZlX2RvbWFpbihz
dHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICAgICAgc2NoZWRfc2V0X2Fm
ZmluaXR5KHYsICZjcHVtYXNrX2FsbCwgJmNwdW1hc2tfYWxsKTsKIAogICAgICAgICB2LT5wcm9j
ZXNzb3IgPSBuZXdfcDsKKyAgICAgICAgdi0+c2NoZWRfdW5pdC0+cmVzID0gZ2V0X3NjaGVkX3Jl
cyhuZXdfcCk7CiAgICAgICAgIC8qCiAgICAgICAgICAqIFdpdGggdi0+cHJvY2Vzc29yIG1vZGlm
aWVkIHdlIG11c3Qgbm90CiAgICAgICAgICAqIC0gbWFrZSBhbnkgZnVydGhlciBjaGFuZ2VzIGFz
c3VtaW5nIHdlIGhvbGQgdGhlIHNjaGVkdWxlciBsb2NrLApAQCAtNzg3LDkgKzc5MCwxMSBAQCB2
b2lkIHJlc3RvcmVfdmNwdV9hZmZpbml0eShzdHJ1Y3QgZG9tYWluICpkKQogICAgICAgICB9CiAK
ICAgICAgICAgdi0+cHJvY2Vzc29yID0gY3B1bWFza19hbnkoY3B1bWFza19zY3JhdGNoX2NwdShj
cHUpKTsKKyAgICAgICAgdi0+c2NoZWRfdW5pdC0+cmVzID0gZ2V0X3NjaGVkX3Jlcyh2LT5wcm9j
ZXNzb3IpOwogCiAgICAgICAgIGxvY2sgPSB2Y3B1X3NjaGVkdWxlX2xvY2tfaXJxKHYpOwogICAg
ICAgICB2LT5wcm9jZXNzb3IgPSBzY2hlZF9waWNrX2NwdSh2Y3B1X3NjaGVkdWxlcih2KSwgdi0+
c2NoZWRfdW5pdCk7CisgICAgICAgIHYtPnNjaGVkX3VuaXQtPnJlcyA9IGdldF9zY2hlZF9yZXMo
di0+cHJvY2Vzc29yKTsKICAgICAgICAgc3Bpbl91bmxvY2tfaXJxKGxvY2spOwogCiAgICAgICAg
IGlmICggb2xkX2NwdSAhPSB2LT5wcm9jZXNzb3IgKQpAQCAtMTYxOCw2ICsxNjIzLDEzIEBAIHN0
YXRpYyBpbnQgY3B1X3NjaGVkdWxlX3VwKHVuc2lnbmVkIGludCBjcHUpCiB7CiAgICAgc3RydWN0
IHNjaGVkdWxlX2RhdGEgKnNkID0gJnBlcl9jcHUoc2NoZWR1bGVfZGF0YSwgY3B1KTsKICAgICB2
b2lkICpzY2hlZF9wcml2OworICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqcmVzOworCisgICAg
cmVzID0geHphbGxvYyhzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UpOworICAgIGlmICggcmVzID09IE5V
TEwgKQorICAgICAgICByZXR1cm4gLUVOT01FTTsKKyAgICByZXMtPnByb2Nlc3NvciA9IGNwdTsK
KyAgICBzZXRfc2NoZWRfcmVzKGNwdSwgcmVzKTsKIAogICAgIHBlcl9jcHUoc2NoZWR1bGVyLCBj
cHUpID0gJm9wczsKICAgICBzcGluX2xvY2tfaW5pdCgmc2QtPl9sb2NrKTsKQEAgLTE2ODIsNiAr
MTY5NCw5IEBAIHN0YXRpYyB2b2lkIGNwdV9zY2hlZHVsZV9kb3duKHVuc2lnbmVkIGludCBjcHUp
CiAgICAgc2QtPnNjaGVkX3ByaXYgPSBOVUxMOwogCiAgICAga2lsbF90aW1lcigmc2QtPnNfdGlt
ZXIpOworCisgICAgc2V0X3NjaGVkX3JlcyhjcHUsIE5VTEwpOworICAgIHhmcmVlKHNkKTsKIH0K
IAogc3RhdGljIGludCBjcHVfc2NoZWR1bGVfY2FsbGJhY2soCmRpZmYgLS1naXQgYS94ZW4vaW5j
bHVkZS94ZW4vc2NoZWQtaWYuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCmluZGV4IDhk
ZGJlYjRmZmQuLmJjN2YyMjNhYWQgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1p
Zi5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCkBAIC00NCw5ICs0NCwyNCBAQCBz
dHJ1Y3Qgc2NoZWR1bGVfZGF0YSB7CiAKICNkZWZpbmUgY3Vycl9vbl9jcHUoYykgICAgKHBlcl9j
cHUoc2NoZWR1bGVfZGF0YSwgYykuY3VycikKIAorc3RydWN0IHNjaGVkX3Jlc291cmNlIHsKKyAg
ICB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yOworfTsKKwogREVDTEFSRV9QRVJfQ1BVKHN0cnVjdCBz
Y2hlZHVsZV9kYXRhLCBzY2hlZHVsZV9kYXRhKTsKIERFQ0xBUkVfUEVSX0NQVShzdHJ1Y3Qgc2No
ZWR1bGVyICosIHNjaGVkdWxlcik7CiBERUNMQVJFX1BFUl9DUFUoc3RydWN0IGNwdXBvb2wgKiwg
Y3B1cG9vbCk7CitERUNMQVJFX1BFUl9DUFUoc3RydWN0IHNjaGVkX3Jlc291cmNlICosIHNjaGVk
X3Jlcyk7CisKK3N0YXRpYyBpbmxpbmUgc3RydWN0IHNjaGVkX3Jlc291cmNlICpnZXRfc2NoZWRf
cmVzKHVuc2lnbmVkIGludCBjcHUpCit7CisgICAgcmV0dXJuIHBlcl9jcHUoc2NoZWRfcmVzLCBj
cHUpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgc2V0X3NjaGVkX3Jlcyh1bnNpZ25lZCBpbnQg
Y3B1LCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnJlcykKK3sKKyAgICBwZXJfY3B1KHNjaGVkX3Jl
cywgY3B1KSA9IHJlczsKK30KIAogLyoKICAqIFNjcmF0Y2ggc3BhY2UsIGZvciBhdm9pZGluZyBo
YXZpbmcgdG9vIG1hbnkgY3B1bWFza190IG9uIHRoZSBzdGFjay4KQEAgLTMzNCw3ICszNDksMTAg
QEAgc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX21pZ3JhdGUoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqcywKICAgICBpZiAoIHMtPm1pZ3JhdGUgKQogICAgICAgICBzLT5taWdyYXRlKHMsIHVuaXQs
IGNwdSk7CiAgICAgZWxzZQorICAgIHsKICAgICAgICAgdW5pdC0+dmNwdS0+cHJvY2Vzc29yID0g
Y3B1OworICAgICAgICB1bml0LT5yZXMgPSBwZXJfY3B1KHNjaGVkX3JlcywgY3B1KTsKKyAgICB9
CiB9CiAKIHN0YXRpYyBpbmxpbmUgaW50IHNjaGVkX3BpY2tfY3B1KGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKnMsCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCBiL3hlbi9pbmNs
dWRlL3hlbi9zY2hlZC5oCmluZGV4IDRkYTFhYjIwMWQuLmQzYTFhMzFjODYgMTAwNjQ0Ci0tLSBh
L3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCkBA
IC0yNzYsMTAgKzI3NiwxMyBAQCBzdHJ1Y3QgdmNwdQogICAgIHN0cnVjdCBhcmNoX3ZjcHUgYXJj
aDsKIH07CiAKK3N0cnVjdCBzY2hlZF9yZXNvdXJjZTsKKwogc3RydWN0IHNjaGVkX3VuaXQgewog
ICAgIHN0cnVjdCB2Y3B1ICAgICAgICAgICAqdmNwdTsKICAgICB2b2lkICAgICAgICAgICAgICAg
ICAgKnByaXY7ICAgICAgLyogc2NoZWR1bGVyIHByaXZhdGUgZGF0YSAqLwogICAgIHN0cnVjdCBz
Y2hlZF91bml0ICAgICAqbmV4dF9pbl9saXN0OworICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAq
cmVzOwogfTsKIAogI2RlZmluZSBmb3JfZWFjaF9zY2hlZF91bml0KGQsIGUpICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0tIAoyLjE2LjQKCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0
Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qu
b3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

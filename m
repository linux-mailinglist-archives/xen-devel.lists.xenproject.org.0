Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C0A468D309
	for <lists+xen-devel@lfdr.de>; Wed, 14 Aug 2019 14:26:19 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hxsJv-0000kl-RB; Wed, 14 Aug 2019 12:24:03 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=+akc=WK=amazon.de=prvs=1223f87df=wipawel@srs-us1.protection.inumbo.net>)
 id 1hxsJu-0000kg-Kb
 for xen-devel@lists.xen.org; Wed, 14 Aug 2019 12:24:02 +0000
X-Inumbo-ID: 655e408c-be8e-11e9-b3d1-8fafeb276210
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 655e408c-be8e-11e9-b3d1-8fafeb276210;
 Wed, 14 Aug 2019 12:24:01 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1565785441; x=1597321441;
 h=from:to:cc:subject:date:message-id:mime-version;
 bh=yrNAXe+dEC2ynEbvBzxwuCNCTg6a1vFfXbhsgkevspw=;
 b=D/ClcnA0SlctsXxuQBwIuTwpkkV8HSQbUonVdnyedC3EV1tnS0dtbq2A
 AXyb67gjPbZl64oKDX2ozuSekRO6eIS92qZKjepFbzsOj6eYW1Kzj5kAL
 0nNgQwh+W1GMwhDqLlS0VcfzZHAKJWGKOM6jyQ+J40li2uEU69503716q g=;
X-IronPort-AV: E=Sophos;i="5.64,385,1559520000"; d="scan'208";a="693782319"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-1a-807d4a99.us-east-1.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 14 Aug 2019 12:23:56 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1a-807d4a99.us-east-1.amazon.com (Postfix) with ESMTPS
 id B13EFA1F3E; Wed, 14 Aug 2019 12:23:55 +0000 (UTC)
Received: from EX13D03EUC001.ant.amazon.com (10.43.164.245) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Wed, 14 Aug 2019 12:23:45 +0000
Received: from EX13MTAUWC001.ant.amazon.com (10.43.162.135) by
 EX13D03EUC001.ant.amazon.com (10.43.164.245) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Wed, 14 Aug 2019 05:23:13 -0700
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.162.232) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Wed, 14 Aug 2019 12:23:11 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>
Date: Wed, 14 Aug 2019 12:23:05 +0000
Message-ID: <20190814122305.20176-1-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH livepatch-hooks-4 1/1] livepatch: always print
 XENLOG_ERR information
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: mpohlack@amazon.de, ross.lagerwall@citrix.com, wipawel@amazon.de,
 konrad.wilk@oracle.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QSBsb3Qgb2YgbGVnaXRpbWF0ZSBlcnJvciBtZXNzYWdlcyB3ZXJlIGhpZGRlbiBiZWhpbmQgZGVi
dWcgcHJpbnRrCm9ubHkuIE1vc3Qgb2YgdGhlc2UgbWVzc2FnZXMgY2FuIGJlIHRyaWdnZXJlZCBi
eSBsb2FkaW5nIGEgbWFsZm9ybWVkCmhvdHBhdGNoIHBheWxvYWQgYW5kIGFyZSBwcmljZWxlc3Mg
Zm9yIHVuZGVyc3RhbmRpbmcgaXNzdWVzIHdpdGggc3VjaApwYXlsb2Fkcy4KVGh1cywgYWx3YXlz
IGRpc3BsYXkgYWxsIHJlbGV2YW50IFhFTkxPR19FUlIgbWVzc2FnZXMuCgpTaWduZWQtb2ZmLWJ5
OiBQYXdlbCBXaWVjem9ya2lld2ljeiA8d2lwYXdlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBB
bWl0IFNoYWggPGFhbXNAYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTWFydGluIE1hemVpbiA8YW1h
emVpbkBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBCam9lcm4gRG9lYmVsIDxkb2ViZWxAYW1hem9u
LmRlPgotLS0KIHhlbi9hcmNoL3g4Ni9saXZlcGF0Y2guYyB8IDE2ICsrKysrKysrLS0tLS0tLS0K
IHhlbi9jb21tb24vbGl2ZXBhdGNoLmMgICB8IDM4ICsrKysrKysrKysrKysrKysrKystLS0tLS0t
LS0tLS0tLS0tLS0tCiAyIGZpbGVzIGNoYW5nZWQsIDI3IGluc2VydGlvbnMoKyksIDI3IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9saXZlcGF0Y2guYyBiL3hlbi9hcmNo
L3g4Ni9saXZlcGF0Y2guYwppbmRleCA0MDZlYjkxMGNjLi40MzZlZTQwZmUxIDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYvbGl2ZXBhdGNoLmMKKysrIGIveGVuL2FyY2gveDg2L2xpdmVwYXRjaC5j
CkBAIC0xMjYsNyArMTI2LDcgQEAgaW50IGFyY2hfbGl2ZXBhdGNoX3ZlcmlmeV9lbGYoY29uc3Qg
c3RydWN0IGxpdmVwYXRjaF9lbGYgKmVsZikKICAgICAgICAgIGhkci0+ZV9pZGVudFtFSV9DTEFT
U10gIT0gRUxGQ0xBU1M2NCB8fAogICAgICAgICAgaGRyLT5lX2lkZW50W0VJX0RBVEFdICE9IEVM
RkRBVEEyTFNCICkKICAgICB7Ci0gICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiwgTElWRVBBVENI
ICIlczogVW5zdXBwb3J0ZWQgRUxGIE1hY2hpbmUgdHlwZSFcbiIsCisgICAgICAgIHByaW50ayhY
RU5MT0dfRVJSIExJVkVQQVRDSCAiJXM6IFVuc3VwcG9ydGVkIEVMRiBNYWNoaW5lIHR5cGUhXG4i
LAogICAgICAgICAgICAgICAgIGVsZi0+bmFtZSk7CiAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQ
UDsKICAgICB9CkBAIC0xNTIsNyArMTUyLDcgQEAgaW50IGFyY2hfbGl2ZXBhdGNoX3BlcmZvcm1f
cmVsKHN0cnVjdCBsaXZlcGF0Y2hfZWxmICplbGYsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3Qgc3RydWN0IGxpdmVwYXRjaF9lbGZfc2VjICpiYXNlLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBsaXZlcGF0Y2hfZWxmX3NlYyAqcmVsYSkK
IHsKLSAgICBkcHJpbnRrKFhFTkxPR19FUlIsIExJVkVQQVRDSCAiJXM6IFNIVF9SRUwgcmVsb2Nh
dGlvbiB1bnN1cHBvcnRlZFxuIiwKKyAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVz
OiBTSFRfUkVMIHJlbG9jYXRpb24gdW5zdXBwb3J0ZWRcbiIsCiAgICAgICAgICAgICBlbGYtPm5h
bWUpOwogICAgIHJldHVybiAtRU9QTk9UU1VQUDsKIH0KQEAgLTE3MiwxOSArMTcyLDE5IEBAIGlu
dCBhcmNoX2xpdmVwYXRjaF9wZXJmb3JtX3JlbGEoc3RydWN0IGxpdmVwYXRjaF9lbGYgKmVsZiwK
IAogICAgICAgICBpZiAoIHN5bW5keCA9PSBTVE5fVU5ERUYgKQogICAgICAgICB7Ci0gICAgICAg
ICAgICBkcHJpbnRrKFhFTkxPR19FUlIsIExJVkVQQVRDSCAiJXM6IEVuY291bnRlcmVkIFNUTl9V
TkRFRlxuIiwKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSIExJVkVQQVRDSCAiJXM6IEVu
Y291bnRlcmVkIFNUTl9VTkRFRlxuIiwKICAgICAgICAgICAgICAgICAgICAgZWxmLT5uYW1lKTsK
ICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsKICAgICAgICAgfQogICAgICAgICBlbHNl
IGlmICggc3ltbmR4ID49IGVsZi0+bnN5bSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIGRwcmlu
dGsoWEVOTE9HX0VSUiwgTElWRVBBVENIICIlczogUmVsYXRpdmUgcmVsb2NhdGlvbiB3YW50cyBz
eW1ib2xAJXUgd2hpY2ggaXMgcGFzdCBlbmQhXG4iLAorICAgICAgICAgICAgcHJpbnRrKFhFTkxP
R19FUlIgTElWRVBBVENIICIlczogUmVsYXRpdmUgcmVsb2NhdGlvbiB3YW50cyBzeW1ib2xAJXUg
d2hpY2ggaXMgcGFzdCBlbmQhXG4iLAogICAgICAgICAgICAgICAgICAgICBlbGYtPm5hbWUsIHN5
bW5keCk7CiAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKICAgICAgICAgfQogICAgICAgICBl
bHNlIGlmICggIWVsZi0+c3ltW3N5bW5keF0uc3ltICkKICAgICAgICAgewotICAgICAgICAgICAg
ZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0ggIiVzOiBObyBzeW1ib2xAJXVcbiIsCisgICAg
ICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVzOiBObyBzeW1ib2xAJXVcbiIs
CiAgICAgICAgICAgICAgICAgICAgIGVsZi0+bmFtZSwgc3ltbmR4KTsKICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOwogICAgICAgICB9CkBAIC0yMjIsMTQgKzIyMiwxNCBAQCBpbnQgYXJjaF9s
aXZlcGF0Y2hfcGVyZm9ybV9yZWxhKHN0cnVjdCBsaXZlcGF0Y2hfZWxmICplbGYsCiAgICAgICAg
ICAgICAqKGludDMyX3QgKilkZXN0ID0gdmFsOwogICAgICAgICAgICAgaWYgKCAoaW50NjRfdCl2
YWwgIT0gKihpbnQzMl90ICopZGVzdCApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAg
ZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0ggIiVzOiBPdmVyZmxvdyBpbiByZWxvY2F0aW9u
ICV1IGluICVzIGZvciAlcyFcbiIsCisgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIg
TElWRVBBVENIICIlczogT3ZlcmZsb3cgaW4gcmVsb2NhdGlvbiAldSBpbiAlcyBmb3IgJXMhXG4i
LAogICAgICAgICAgICAgICAgICAgICAgICAgZWxmLT5uYW1lLCBpLCByZWxhLT5uYW1lLCBiYXNl
LT5uYW1lKTsKICAgICAgICAgICAgICAgICByZXR1cm4gLUVPVkVSRkxPVzsKICAgICAgICAgICAg
IH0KICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgIGRlZmF1bHQ6Ci0gICAgICAgICAgICBk
cHJpbnRrKFhFTkxPR19FUlIsIExJVkVQQVRDSCAiJXM6IFVuaGFuZGxlZCByZWxvY2F0aW9uICVs
dVxuIiwKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSIExJVkVQQVRDSCAiJXM6IFVuaGFu
ZGxlZCByZWxvY2F0aW9uICVsdVxuIiwKICAgICAgICAgICAgICAgICAgICAgZWxmLT5uYW1lLCBF
TEY2NF9SX1RZUEUoci0+cl9pbmZvKSk7CiAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7
CiAgICAgICAgIH0KQEAgLTIzOCw3ICsyMzgsNyBAQCBpbnQgYXJjaF9saXZlcGF0Y2hfcGVyZm9y
bV9yZWxhKHN0cnVjdCBsaXZlcGF0Y2hfZWxmICplbGYsCiAgICAgcmV0dXJuIDA7CiAKICBiYWRf
b2Zmc2V0OgotICAgIGRwcmludGsoWEVOTE9HX0VSUiwgTElWRVBBVENIICIlczogUmVsYXRpdmUg
cmVsb2NhdGlvbiBvZmZzZXQgaXMgcGFzdCAlcyBzZWN0aW9uIVxuIiwKKyAgICBwcmludGsoWEVO
TE9HX0VSUiBMSVZFUEFUQ0ggIiVzOiBSZWxhdGl2ZSByZWxvY2F0aW9uIG9mZnNldCBpcyBwYXN0
ICVzIHNlY3Rpb24hXG4iLAogICAgICAgICAgICAgZWxmLT5uYW1lLCBiYXNlLT5uYW1lKTsKICAg
ICByZXR1cm4gLUVJTlZBTDsKIH0KZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMg
Yi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCmluZGV4IGM0YTEwN2Q5MWMuLjU4NWVjOTgxOWEgMTAw
NjQ0Ci0tLSBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKKysrIGIveGVuL2NvbW1vbi9saXZlcGF0
Y2guYwpAQCAtMjE3LDcgKzIxNyw3IEBAIHN0YXRpYyBpbnQgcmVzb2x2ZV9vbGRfYWRkcmVzcyhz
dHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmYsCiAgICAgICAgIGYtPm9sZF9hZGRyID0gKHZvaWQgKils
aXZlcGF0Y2hfc3ltYm9sc19sb29rdXBfYnlfbmFtZShmLT5uYW1lKTsKICAgICAgICAgaWYgKCAh
Zi0+b2xkX2FkZHIgKQogICAgICAgICB7Ci0gICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIs
IExJVkVQQVRDSCAiJXM6IENvdWxkIG5vdCByZXNvbHZlIG9sZCBhZGRyZXNzIG9mICVzXG4iLAor
ICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENIICIlczogQ291bGQgbm90IHJl
c29sdmUgb2xkIGFkZHJlc3Mgb2YgJXNcbiIsCiAgICAgICAgICAgICAgICAgICAgIGVsZi0+bmFt
ZSwgZi0+bmFtZSk7CiAgICAgICAgICAgICByZXR1cm4gLUVOT0VOVDsKICAgICAgICAgfQpAQCAt
MzM2LDcgKzMzNiw3IEBAIHN0YXRpYyBpbnQgbW92ZV9wYXlsb2FkKHN0cnVjdCBwYXlsb2FkICpw
YXlsb2FkLCBzdHJ1Y3QgbGl2ZXBhdGNoX2VsZiAqZWxmKQogICAgIHRleHRfYnVmID0gdm1hbGxv
Y194ZW4oc2l6ZSAqIFBBR0VfU0laRSk7CiAgICAgaWYgKCAhdGV4dF9idWYgKQogICAgIHsKLSAg
ICAgICAgZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0ggIiVzOiBDb3VsZCBub3QgYWxsb2Nh
dGUgbWVtb3J5IGZvciBwYXlsb2FkIVxuIiwKKyAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElW
RVBBVENIICIlczogQ291bGQgbm90IGFsbG9jYXRlIG1lbW9yeSBmb3IgcGF5bG9hZCFcbiIsCiAg
ICAgICAgICAgICAgICAgZWxmLT5uYW1lKTsKICAgICAgICAgcmMgPSAtRU5PTUVNOwogICAgICAg
ICBnb3RvIG91dDsKQEAgLTQzNCw3ICs0MzQsNyBAQCBzdGF0aWMgYm9vbCBzZWN0aW9uX29rKGNv
bnN0IHN0cnVjdCBsaXZlcGF0Y2hfZWxmICplbGYsCiAKICAgICBpZiAoIHNlYy0+c2VjLT5zaF9z
aXplICUgc3ogKQogICAgIHsKLSAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0gg
IiVzOiBXcm9uZyBzaXplICUiUFJJdUVsZldvcmQiIG9mICVzIChtdXN0IGJlIG11bHRpcGxlIG9m
ICV6dSlcbiIsCisgICAgICAgIHByaW50ayhYRU5MT0dfRVJSIExJVkVQQVRDSCAiJXM6IFdyb25n
IHNpemUgJSJQUkl1RWxmV29yZCIgb2YgJXMgKG11c3QgYmUgbXVsdGlwbGUgb2YgJXp1KVxuIiwK
ICAgICAgICAgICAgICAgICBlbGYtPm5hbWUsIHNlYy0+c2VjLT5zaF9zaXplLCBzZWMtPm5hbWUs
IHN6KTsKICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0KQEAgLTQ1Niw3ICs0NTYsNyBAQCBz
dGF0aWMgaW50IGNoZWNrX3hlbl9idWlsZF9pZChjb25zdCBzdHJ1Y3QgcGF5bG9hZCAqcGF5bG9h
ZCkKICAgICAgICAgcmV0dXJuIHJjOwogCiAgICAgaWYgKCBwYXlsb2FkLT54ZW5fZGVwLmxlbiAh
PSBsZW4gfHwgbWVtY21wKGlkLCBwYXlsb2FkLT54ZW5fZGVwLnAsIGxlbikgKSB7Ci0gICAgICAg
IGRwcmludGsoWEVOTE9HX0VSUiwgIiVzJXM6IGNoZWNrIGFnYWluc3QgaHlwZXJ2aXNvciBidWls
ZC1pZCBmYWlsZWQhXG4iLAorICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVz
JXM6IGNoZWNrIGFnYWluc3QgaHlwZXJ2aXNvciBidWlsZC1pZCBmYWlsZWQhXG4iLAogICAgICAg
ICAgICAgICAgIExJVkVQQVRDSCwgcGF5bG9hZC0+bmFtZSk7CiAgICAgICAgIHJldHVybiAtRUlO
VkFMOwogICAgIH0KQEAgLTQ3OSwyMSArNDc5LDIxIEBAIHN0YXRpYyBpbnQgY2hlY2tfc3BlY2lh
bF9zZWN0aW9ucyhjb25zdCBzdHJ1Y3QgbGl2ZXBhdGNoX2VsZiAqZWxmKQogICAgICAgICBzZWMg
PSBsaXZlcGF0Y2hfZWxmX3NlY19ieV9uYW1lKGVsZiwgbmFtZXNbaV0pOwogICAgICAgICBpZiAo
ICFzZWMgKQogICAgICAgICB7Ci0gICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIsIExJVkVQ
QVRDSCAiJXM6ICVzIGlzIG1pc3NpbmchXG4iLAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19F
UlIgTElWRVBBVENIICIlczogJXMgaXMgbWlzc2luZyFcbiIsCiAgICAgICAgICAgICAgICAgICAg
IGVsZi0+bmFtZSwgbmFtZXNbaV0pOwogICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAg
ICAgIH0KIAogICAgICAgICBpZiAoICFzZWMtPnNlYy0+c2hfc2l6ZSApCiAgICAgICAgIHsKLSAg
ICAgICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiwgTElWRVBBVENIICIlczogJXMgaXMgZW1wdHkh
XG4iLAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENIICIlczogJXMgaXMg
ZW1wdHkhXG4iLAogICAgICAgICAgICAgICAgICAgICBlbGYtPm5hbWUsIG5hbWVzW2ldKTsKICAg
ICAgICAgICAgIHJldHVybiAtRUlOVkFMOwogICAgICAgICB9CiAKICAgICAgICAgaWYgKCB0ZXN0
X2FuZF9zZXRfYml0KGksIGZvdW5kKSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIGRwcmludGso
WEVOTE9HX0VSUiwgTElWRVBBVENIICIlczogJXMgd2FzIHNlZW4gbW9yZSB0aGFuIG9uY2UhXG4i
LAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENIICIlczogJXMgd2FzIHNl
ZW4gbW9yZSB0aGFuIG9uY2UhXG4iLAogICAgICAgICAgICAgICAgICAgICBlbGYtPm5hbWUsIG5h
bWVzW2ldKTsKICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwogICAgICAgICB9CkBAIC01Mjks
MjEgKzUyOSwyMSBAQCBzdGF0aWMgaW50IGNoZWNrX3BhdGNoaW5nX3NlY3Rpb25zKGNvbnN0IHN0
cnVjdCBsaXZlcGF0Y2hfZWxmICplbGYpCiAgICAgICAgIHNlYyA9IGxpdmVwYXRjaF9lbGZfc2Vj
X2J5X25hbWUoZWxmLCBuYW1lc1tpXSk7CiAgICAgICAgIGlmICggIXNlYyApCiAgICAgICAgIHsK
LSAgICAgICAgICAgIGRwcmludGsoWEVOTE9HX0lORk8sIExJVkVQQVRDSCAiJXM6ICVzIGlzIG1p
c3NpbmchXG4iLAorICAgICAgICAgICAgZHByaW50ayhYRU5MT0dfREVCVUcsIExJVkVQQVRDSCAi
JXM6ICVzIGlzIG1pc3NpbmchXG4iLAogICAgICAgICAgICAgICAgICAgICBlbGYtPm5hbWUsIG5h
bWVzW2ldKTsKICAgICAgICAgICAgIGNvbnRpbnVlOyAvKiBUaGlzIHNlY3Rpb24gaXMgb3B0aW9u
YWwgKi8KICAgICAgICAgfQogCiAgICAgICAgIGlmICggIXNlYy0+c2VjLT5zaF9zaXplICkKICAg
ICAgICAgewotICAgICAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0ggIiVzOiAl
cyBpcyBlbXB0eSFcbiIsCisgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0gg
IiVzOiAlcyBpcyBlbXB0eSFcbiIsCiAgICAgICAgICAgICAgICAgICAgIGVsZi0+bmFtZSwgbmFt
ZXNbaV0pOwogICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgICAgIH0KIAogICAgICAg
ICBpZiAoIHRlc3RfYW5kX3NldF9iaXQoaSwgZm91bmQpICkKICAgICAgICAgewotICAgICAgICAg
ICAgZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0ggIiVzOiAlcyB3YXMgc2VlbiBtb3JlIHRo
YW4gb25jZSFcbiIsCisgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVz
OiAlcyB3YXMgc2VlbiBtb3JlIHRoYW4gb25jZSFcbiIsCiAgICAgICAgICAgICAgICAgICAgIGVs
Zi0+bmFtZSwgbmFtZXNbaV0pOwogICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgICAg
IH0KQEAgLTYxNSw3ICs2MTUsNyBAQCBzdGF0aWMgaW50IHByZXBhcmVfcGF5bG9hZChzdHJ1Y3Qg
cGF5bG9hZCAqcGF5bG9hZCwKIAogICAgICAgICAgICAgaWYgKCBmLT52ZXJzaW9uICE9IExJVkVQ
QVRDSF9QQVlMT0FEX1ZFUlNJT04gKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIGRw
cmludGsoWEVOTE9HX0VSUiwgTElWRVBBVENIICIlczogV3JvbmcgdmVyc2lvbiAoJXUpLiBFeHBl
Y3RlZCAlZCFcbiIsCisgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENI
ICIlczogV3JvbmcgdmVyc2lvbiAoJXUpLiBFeHBlY3RlZCAlZCFcbiIsCiAgICAgICAgICAgICAg
ICAgICAgICAgICBlbGYtPm5hbWUsIGYtPnZlcnNpb24sIExJVkVQQVRDSF9QQVlMT0FEX1ZFUlNJ
T04pOwogICAgICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsKICAgICAgICAgICAgIH0K
QEAgLTYyMyw3ICs2MjMsNyBAQCBzdGF0aWMgaW50IHByZXBhcmVfcGF5bG9hZChzdHJ1Y3QgcGF5
bG9hZCAqcGF5bG9hZCwKICAgICAgICAgICAgIC8qICdvbGRfYWRkcicsICduZXdfYWRkcicsICdu
ZXdfc2l6ZScgY2FuIGFsbCBiZSB6ZXJvLiAqLwogICAgICAgICAgICAgaWYgKCAhZi0+b2xkX3Np
emUgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiwg
TElWRVBBVENIICIlczogQWRkcmVzcyBvciBzaXplIGZpZWxkcyBhcmUgemVybyFcbiIsCisgICAg
ICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENIICIlczogQWRkcmVzcyBvciBz
aXplIGZpZWxkcyBhcmUgemVybyFcbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICBlbGYtPm5h
bWUpOwogICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwogICAgICAgICAgICAgfQpAQCAt
NzYyLDE0ICs3NjIsMTQgQEAgc3RhdGljIGludCBwcmVwYXJlX3BheWxvYWQoc3RydWN0IHBheWxv
YWQgKnBheWxvYWQsCiAgICAgICAgICAgICBpZiAoIChpbnN0ciA8IHJlZ2lvbi0+c3RhcnQgJiYg
aW5zdHIgPj0gcmVnaW9uLT5lbmQpIHx8CiAgICAgICAgICAgICAgICAgIChyZXBsYWNlbWVudCA8
IHJlZ2lvbi0+c3RhcnQgJiYgcmVwbGFjZW1lbnQgPj0gcmVnaW9uLT5lbmQpICkKICAgICAgICAg
ICAgIHsKLSAgICAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIsIExJVkVQQVRDSCAiJXMg
QWx0IHBhdGNoaW5nIG91dHNpZGUgcGF5bG9hZDogJXAhXG4iLAorICAgICAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfRVJSIExJVkVQQVRDSCAiJXMgQWx0IHBhdGNoaW5nIG91dHNpZGUgcGF5bG9h
ZDogJXAhXG4iLAogICAgICAgICAgICAgICAgICAgICAgICAgZWxmLT5uYW1lLCBpbnN0cik7CiAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0K
ICAgICAgICAgYXBwbHlfYWx0ZXJuYXRpdmVzKHN0YXJ0LCBlbmQpOwogI2Vsc2UKLSAgICAgICAg
ZHByaW50ayhYRU5MT0dfRVJSLCBMSVZFUEFUQ0ggIiVzOiBXZSBkb24ndCBzdXBwb3J0IGFsdGVy
bmF0aXZlIHBhdGNoaW5nIVxuIiwKKyAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgTElWRVBBVENI
ICIlczogV2UgZG9uJ3Qgc3VwcG9ydCBhbHRlcm5hdGl2ZSBwYXRjaGluZyFcbiIsCiAgICAgICAg
ICAgICAgICAgZWxmLT5uYW1lKTsKICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOwogI2VuZGlm
CkBAIC03OTIsNyArNzkyLDcgQEAgc3RhdGljIGludCBwcmVwYXJlX3BheWxvYWQoc3RydWN0IHBh
eWxvYWQgKnBheWxvYWQsCiAgICAgICAgIHJlZ2lvbi0+ZXggPSBzOwogICAgICAgICByZWdpb24t
PmV4X2VuZCA9IGU7CiAjZWxzZQotICAgICAgICBkcHJpbnRrKFhFTkxPR19FUlIsIExJVkVQQVRD
SCAiJXM6IFdlIGRvbid0IHN1cHBvcnQgLmV4X3RhYmxlIVxuIiwKKyAgICAgICAgcHJpbnRrKFhF
TkxPR19FUlIgTElWRVBBVENIICIlczogV2UgZG9uJ3Qgc3VwcG9ydCAuZXhfdGFibGUhXG4iLAog
ICAgICAgICAgICAgICAgIGVsZi0+bmFtZSk7CiAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsK
ICNlbmRpZgpAQCAtOTAxLDcgKzkwMSw3IEBAIHN0YXRpYyBpbnQgYnVpbGRfc3ltYm9sX3RhYmxl
KHN0cnVjdCBwYXlsb2FkICpwYXlsb2FkLAogICAgICAgICAgICAgaWYgKCBzeW1ib2xzX2xvb2t1
cF9ieV9uYW1lKHN5bXRhYltpXS5uYW1lKSB8fAogICAgICAgICAgICAgICAgICBsaXZlcGF0Y2hf
c3ltYm9sc19sb29rdXBfYnlfbmFtZShzeW10YWJbaV0ubmFtZSkgKQogICAgICAgICAgICAgewot
ICAgICAgICAgICAgICAgIGRwcmludGsoWEVOTE9HX0VSUiwgTElWRVBBVENIICIlczogZHVwbGlj
YXRlIG5ldyBzeW1ib2w6ICVzXG4iLAorICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJS
IExJVkVQQVRDSCAiJXM6IGR1cGxpY2F0ZSBuZXcgc3ltYm9sOiAlc1xuIiwKICAgICAgICAgICAg
ICAgICAgICAgICAgIGVsZi0+bmFtZSwgc3ltdGFiW2ldLm5hbWUpOwogICAgICAgICAgICAgICAg
IHhmcmVlKHN5bXRhYik7CiAgICAgICAgICAgICAgICAgeGZyZWUoc3RydGFiKTsKQEAgLTE2NTIs
NyArMTY1Miw3IEBAIHN0YXRpYyBpbnQgYnVpbGRfaWRfZGVwKHN0cnVjdCBwYXlsb2FkICpwYXls
b2FkLCBib29sX3QgaW50ZXJuYWwpCiAgICAgaWYgKCBwYXlsb2FkLT5kZXAubGVuICE9IGxlbiB8
fAogICAgICAgICAgbWVtY21wKGlkLCBwYXlsb2FkLT5kZXAucCwgbGVuKSApCiAgICAgewotICAg
ICAgICBkcHJpbnRrKFhFTkxPR19FUlIsICIlcyVzOiBjaGVjayBhZ2FpbnN0ICVzIGJ1aWxkLWlk
IGZhaWxlZCFcbiIsCisgICAgICAgIHByaW50ayhYRU5MT0dfRVJSIExJVkVQQVRDSCAiJXMlczog
Y2hlY2sgYWdhaW5zdCAlcyBidWlsZC1pZCBmYWlsZWQhXG4iLAogICAgICAgICAgICAgICAgIExJ
VkVQQVRDSCwgcGF5bG9hZC0+bmFtZSwgbmFtZSk7CiAgICAgICAgIHJldHVybiAtRUlOVkFMOwog
ICAgIH0KQEAgLTE3MTIsNyArMTcxMiw3IEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNoX2FjdGlvbihz
dHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfYWN0aW9uICphY3Rpb24pCiAgICAgICAgICAgICAv
KiBXZSBzaG91bGQgYmUgdGhlIGxhc3QgYXBwbGllZCBvbmUuICovCiAgICAgICAgICAgICBpZiAo
IHAgIT0gZGF0YSApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgZHByaW50ayhYRU5M
T0dfRVJSLCAiJXMlczogY2FuJ3QgdW5sb2FkLiBUb3AgaXMgJXMhXG4iLAorICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfRVJSIExJVkVQQVRDSCAiJXMlczogY2FuJ3QgdW5sb2FkLiBUb3Ag
aXMgJXMhXG4iLAogICAgICAgICAgICAgICAgICAgICAgICAgTElWRVBBVENILCBkYXRhLT5uYW1l
LCBwLT5uYW1lKTsKICAgICAgICAgICAgICAgICByYyA9IC1FQlVTWTsKICAgICAgICAgICAgICAg
ICBicmVhazsKQEAgLTE3NDgsNyArMTc0OCw3IEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNoX2FjdGlv
bihzdHJ1Y3QgeGVuX3N5c2N0bF9saXZlcGF0Y2hfYWN0aW9uICphY3Rpb24pCiAgICAgICAgICAg
ICAgKi8KICAgICAgICAgICAgIGlmICggZGF0YS0+cmV2ZXJ0ZWQgJiYgIWRhdGEtPnNhZmVfdG9f
cmVhcHBseSApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgZHByaW50ayhYRU5MT0df
RVJSLCAiJXMlczogY2FuJ3QgcmV2ZXJ0IGFzIHBheWxvYWQgaGFzIC5kYXRhLiBQbGVhc2UgdW5s
b2FkIVxuIiwKKyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFUQ0ggIiVz
JXM6IGNhbid0IHJldmVydCBhcyBwYXlsb2FkIGhhcyAuZGF0YS4gUGxlYXNlIHVubG9hZCFcbiIs
CiAgICAgICAgICAgICAgICAgICAgICAgICBMSVZFUEFUQ0gsIGRhdGEtPm5hbWUpOwogICAgICAg
ICAgICAgICAgIGRhdGEtPnJjID0gLUVJTlZBTDsKICAgICAgICAgICAgICAgICBicmVhazsKLS0g
CjIuMTYuNQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdtYkgKS3JhdXNl
bnN0ci4gMzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0aWFuIFNjaGxh
ZWdlciwgUmFsZiBIZXJicmljaApFaW5nZXRyYWdlbiBhbSBBbXRzZ2VyaWNodCBDaGFybG90dGVu
YnVyZyB1bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVzdC1JRDogREUgMjg5IDIzNyA4
NzkKCgoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhl
bi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBz
Oi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6A052BF13E
	for <lists+xen-devel@lfdr.de>; Thu, 26 Sep 2019 13:24:35 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDRq5-00007M-1x; Thu, 26 Sep 2019 11:21:37 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=KCTf=XV=gmail.com=olekstysh@srs-us1.protection.inumbo.net>)
 id 1iDRq2-00006N-Vi
 for xen-devel@lists.xenproject.org; Thu, 26 Sep 2019 11:21:35 +0000
X-Inumbo-ID: b8712180-e04f-11e9-97fb-bc764e2007e4
Received: from mail-lj1-x241.google.com (unknown [2a00:1450:4864:20::241])
 by localhost (Halon) with ESMTPS
 id b8712180-e04f-11e9-97fb-bc764e2007e4;
 Thu, 26 Sep 2019 11:21:01 +0000 (UTC)
Received: by mail-lj1-x241.google.com with SMTP id y3so1758234ljj.6
 for <xen-devel@lists.xenproject.org>; Thu, 26 Sep 2019 04:21:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=PAgFrd7DRogKgdXlH5r3pNcIc0Ff4MXaChYlPlJIims=;
 b=Wto/WeuIgHa0wM7vk1TiJlLH72WqP4Uq4jAMe4hJzUBsVlT/kykO9tdgMmF54CDOTi
 fSFHUrDc1EUG/3w9kMohQ/dhQ7+LkFvl1/Oqn5NVCb0pC1yOzrfcZaJ7hLcb1eL3fLrH
 BU73cJrEONiwzLvAPI9an3LJ4e3U1DFu4lSiVehxFz5j4SWYCDg7yGggF+X/uK7n37Ph
 pEJmdCc00FMK4f9QbKcr8SrSQXK0MJahb3IBlqFJEa4oXo4tjpjgx8G3kBibOiyRx0H9
 t2cp9slCt039xTrAexK1JweLxImeVA19exEG+RVz2XJIw7nUIIabXqjPbevm3DfRzdNV
 +SjQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=PAgFrd7DRogKgdXlH5r3pNcIc0Ff4MXaChYlPlJIims=;
 b=lf8Bopsp5wHalVg2bC/ivauUuf18G/bM6xDKZt+/HpBEIeTlec439Fzw2MH89toxqt
 5+u+OFWtPVn7ifjO7vc8y6Fg+bz4OzbOKl89uaPyTbPqLQuAnRLA7ROEuYQPkMAD4VlL
 QAtegnNOuUMN8d/ro28X3kDGtt5ob8JxvdG3unG4MtyjpCulr8Ks12dsdcsmSyaD2/ZT
 pZskrhutjWY0vVpB/LmnMgZuLU7s+OLPEjav3J2b+jTEW6HkBs6OalOT7xmO6TFOCMqN
 PWsBPPcnKhJ5qr1t9mcbpzrmawuvyNFGSZtbUMEHsfwyctlOdo0go8/tS5+As8uXIVvk
 IAqg==
X-Gm-Message-State: APjAAAUBg+iSntq5hrkpIoaZOkHgqdpvY1usYg9zoV3fAO8KxhrzzEkP
 VLQ2ZRNuoJ2fjkj6gH2FHvc3ya6ov7s=
X-Google-Smtp-Source: APXvYqwke5/HRjiOv/DUYQWbi/+11g6Hd9TLOkdo22jGTnrtQ43uR/vvcVFPXcGQX8D1E1OJ/ZmBPQ==
X-Received: by 2002:a2e:9f52:: with SMTP id v18mr2313022ljk.166.1569496860741; 
 Thu, 26 Sep 2019 04:21:00 -0700 (PDT)
Received: from otyshchenko.kyiv.epam.com (ll-22.209.223.85.sovam.net.ua.
 [85.223.209.22])
 by smtp.gmail.com with ESMTPSA id n4sm526810lfi.63.2019.09.26.04.20.59
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
 Thu, 26 Sep 2019 04:21:00 -0700 (PDT)
From: Oleksandr Tyshchenko <olekstysh@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Thu, 26 Sep 2019 14:20:33 +0300
Message-Id: <1569496834-7796-8-git-send-email-olekstysh@gmail.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1569496834-7796-1-git-send-email-olekstysh@gmail.com>
References: <1569496834-7796-1-git-send-email-olekstysh@gmail.com>
Subject: [Xen-devel] [PATCH V6 7/8] iommu/arm: Introduce iommu_add_dt_device
 API
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Oleksandr Tyshchenko <oleksandr_tyshchenko@epam.com>, julien.grall@arm.com,
 sstabellini@kernel.org, volodymyr_babchuk@epam.com,
 Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogT2xla3NhbmRyIFR5c2hjaGVua28gPG9sZWtzYW5kcl90eXNoY2hlbmtvQGVwYW0uY29t
PgoKVGhlIG1haW4gcHVwcm9zZSBvZiB0aGlzIHBhdGNoIGlzIHRvIGFkZCBhIHdheSB0byByZWdp
c3RlciBEVCBkZXZpY2UKKHdoaWNoIGlzIGJlaGluZCB0aGUgSU9NTVUpIHVzaW5nIHRoZSBnZW5l
cmljIElPTU1VIERUIGJpbmRpbmdzIFsxXQpiZWZvcmUgYXNzaWduaW5nIHRoYXQgZGV2aWNlIHRv
IGEgZG9tYWluLgoKU28sIHRoaXMgcGF0Y2ggYWRkcyBuZXcgImlvbW11X2FkZF9kdF9kZXZpY2Ui
IEFQSSBmb3IgYWRkaW5nIERUIGRldmljZQp0byB0aGUgSU9NTVUgdXNpbmcgZ2VuZXJpYyBJT01N
VSBEVCBiaW5kaW5ncyBhbmQgcHJldmlvdXNseSBhZGRlZAoiaW9tbXVfZndzcGVjIiBzdXBwb3J0
LiBBcyBkZXZpY2VzIGNhbiBiZSBhc3NpZ25lZCB0byB0aGUgaGFyZHdhcmUgZG9tYWluCmFuZCBv
dGhlciBkb21haW5zIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdHdvIHBsYWNlczogaGFu
ZGxlX2RldmljZSgpCmFuZCBpb21tdV9kb19kdF9kb21jdGwoKS4KCkJlc2lkZXMgdGhhdCwgdGhp
cyBwYXRjaCBhZGRzIG5ldyAiZHRfeGxhdGUiIGNhbGxiYWNrIChib3Jyb3dlZCBmcm9tCkxpbnV4
ICJvZl94bGF0ZSIpIGZvciBwcm92aWRpbmcgdGhlIGRyaXZlciB3aXRoIERUIElPTU1VIHNwZWNp
Zmllcgp3aGljaCBkZXNjcmliZXMgdGhlIElPTU1VIG1hc3RlciBpbnRlcmZhY2VzIG9mIHRoYXQg
ZGV2aWNlIChkZXZpY2UgSURzLCBldGMpLgpBY2NvcmRpbmcgdG8gdGhlIGdlbmVyaWMgSU9NTVUg
RFQgYmluZGluZ3MgdGhlIGNvbnRleHQgb2YgcmVxdWlyZWQKcHJvcGVydGllcyBmb3IgSU9NTVUg
ZGV2aWNlL21hc3RlciBub2RlICgjaW9tbXUtY2VsbHMsIGlvbW11cykgZGVwZW5kcwpvbiBtYW55
IGZhY3RvcnMgYW5kIGlzIHJlYWxseSBkcml2ZXIgZGVwZW5kZWQgdGhpbmcuCgpQbGVhc2Ugbm90
ZSwgYWxsIElPTU1VIGRyaXZlcnMgd2hpY2ggc3VwcG9ydCBnZW5lcmljIElPTU1VIERUIGJpbmRp
bmdzCnNob3VsZCB1c2UgImR0X3hsYXRlIiBhbmQgImFkZF9kZXZpY2UiIGNhbGxiYWNrcy4KClsx
XSBodHRwczovL3d3dy5rZXJuZWwub3JnL2RvYy9Eb2N1bWVudGF0aW9uL2RldmljZXRyZWUvYmlu
ZGluZ3MvaW9tbXUvaW9tbXUudHh0CgpTaWduZWQtb2ZmLWJ5OiBPbGVrc2FuZHIgVHlzaGNoZW5r
byA8b2xla3NhbmRyX3R5c2hjaGVua29AZXBhbS5jb20+CkNDOiBKdWxpZW4gR3JhbGwgPGp1bGll
bi5ncmFsbEBhcm0uY29tPgpDQzogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgoKLS0t
CkNoYW5nZXMgVjUgLT4gVjY6CiAgICAgLSBhZGRlZCBjaGVjayBmb3IgdGhlIGZ1bmN0aW9uJ3Mg
cmV0dXJuIHZhbHVlIGluIGJvdGggY2FzZXMKICAgICAtIHJlbW92ZWQgZXh0cmEgY2hlY2sgZm9y
IGR0X2RldmljZV9pc19wcm90ZWN0ZWQoKSBmcm9tCiAgICAgICBpb21tdV9kb19kdF9kb21jdGwo
KQoKQ2hhbmdlcyBWNCAtPiBWNToKICAgICAtIGFkZGVkICJjb25zdCIgdG8gc3RydWN0IGR0X3Bo
YW5kbGVfYXJncyAqYXJncyBpbiBkdF94bGF0ZQogICAgIC0gbW92ZWQgaW9tbXVfYWRkX2R0X2Rl
dmljZSgpIHRvIHhlbi9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jCiAgICAgLSBtb2RpZmllZCBs
b2dpYywgZG9uJ3QgdHJ5IHRvIGFkZCAiYWxsIiBkZXZpY2VzIHRvIHRoZSBJT01NVQogICAgICAg
d2hlbiBjb25zdHJ1Y3RpbmcgRG9tMCwgYnV0IG9ubHkgZGV2aWNlcyB3aGljaCBhcmUgZ29pbmcg
dG8gYmUKICAgICAgIGFzc2lnbmVkIHRvIGh3ZG9tCiAgICAgLSB1cGRhdGVkIGlvbW11X2RvX2R0
X2RvbWN0bCgpIHRvIGNhbGwgaW9tbXVfYWRkX2R0X2RldmljZSgpCiAgICAgLSBjbGFyaWZpZWQg
cGF0Y2ggZGVzY3JpcHRpb24KICAgICAtIHJlbW92ZWQgIl9faW5pdCIgZnJvbSBpb21tdV9hZGRf
ZHRfZGV2aWNlKCkKCkNoYW5nZXMgVjMgLT4gVjQ6CiAgICAgLSBzcXVhc2hlZCB3aXRoICJpb21t
dTogQWRkIG9mX3hsYXRlIGNhbGxiYWNrIiBwYXRjaAogICAgIC0gcmVuYW1lZCAib2ZfeGxhdGUi
IHRvICJkdF94bGF0ZSIKICAgICAtIHJld29ya2VkIHBhdGNoIGRlc2NyaXB0aW9uCiAgICAgLSBj
bGFyaWZpZWQgY29tbWVudHMgaW4gY29kZSwgcmVtb3ZlZCBjb25mdXNpbmcgd29yZAogICAgICAg
ImluaXRpYWxpemUgZGV2aWNlIiwgZXRjCiAgICAgLSB1cGRhdGVkIGRlYnVnIG1lc3NhZ2UgaW4g
aGFuZGxlX2RldmljZSgpCiAgICAgLSBtb2RpZmllZCB0byBjaGVjayBvcHMtPm9mX3hsYXRlIGFu
ZCBvcHMtPmFkZF9kZXZpY2UKICAgICAgIG9ubHkgaWYgImlvbW11cyIgcHJvcGVydHkgaXMgZXhp
c3RzCgpDaGFuZ2VzIFYyIC0+IFYzOgogICAgLSBjbGFyaWZpZWQgcGF0Y2ggZGVzY3JpcHRpb24K
ICAgIC0gY2xhcmlmaWVkIGNvbW1lbnRzIGluIGNvZGUKICAgIC0gbW9kaWZpZWQgdG8gcHJvdmlk
ZSBEVCBJT01NVSBzcGVjaWZpZXIgdG8gdGhlIGRyaXZlcgogICAgICB1c2luZyAib2ZfeGxhdGUi
IGNhbGxiYWNrCiAgICAtIGRvY3VtZW50ZWQgZnVuY3Rpb24gdXNhZ2UKICAgIC0gbW9kaWZpZWQg
dG8gcmV0dXJuIGFuIGVycm9yIGlmIG9wcyBpcyBub3QgcHJlc2VudC9pbXBsZW1lbnRlZCwKICAg
IC0gYWRkZWQgYWJpbGl0eSB0byByZXR1cm4gYSBwb3NzaXRpdmUgdmFsdWUgdG8gaW5kaWNhdGUK
ICAgICAgdGhhdCBkZXZpY2UgZG9lc24ndCBuZWVkIHRvIGJlIHByb3RlY3RlZAogICAgLSByZW1v
dmVkIGNoZWNrIGZvciB0aGUgImlvbW11IiBwcm9wZXJ0eSBwcmVzZW5jZQogICAgICBpbiB0aGUg
Y29tbW9uIGNvZGUKICAgIC0gaW5jbHVkZWQgPGFzbS9pb21tdV9md3NwZWMuaD4gZGlyZWN0bHkK
LS0tCiB4ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMgICAgICAgICAgIHwgMjUgKysrKysrKysr
LS0tCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9kZXZpY2VfdHJlZS5jIHwgNzcgKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysKIHhlbi9pbmNsdWRlL3hlbi9pb21tdS5oICAgICAg
ICAgICAgICAgfCAyMSArKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDExOCBpbnNlcnRpb25z
KCspLCA1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9kb21haW5fYnVp
bGQuYyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYwppbmRleCBhMGZlZTFlLi5iODRhNDQ4
IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKKysrIGIveGVuL2FyY2gv
YXJtL2RvbWFpbl9idWlsZC5jCkBAIC0xMjQzLDYgKzEyNDMsNyBAQCBzdGF0aWMgaW50IF9faW5p
dCBtYXBfZGV2aWNlX2NoaWxkcmVuKHN0cnVjdCBkb21haW4gKmQsCiAgKiAgLSBHaXZlIHBlcm1p
c3Npb24gdG8gdGhlIGd1ZXN0IHRvIG1hbmFnZSBJUlEgYW5kIE1NSU8gcmFuZ2UKICAqICAtIFJl
dHJpZXZlIHRoZSBJUlEgY29uZmlndXJhdGlvbiAoaS5lIGVkZ2UvbGV2ZWwpIGZyb20gZGV2aWNl
IHRyZWUKICAqIFdoZW4gdGhlIGRldmljZSBpcyBub3QgbWFya2VkIGZvciBndWVzdCBwYXNzdGhy
b3VnaDoKKyAqICAtIFRyeSB0byBjYWxsIGlvbW11X2FkZF9kdF9kZXZpY2UgdG8gcHJvdGVjdCB0
aGUgZGV2aWNlIGJ5IGFuIElPTU1VCiAgKiAgLSBBc3NpZ24gdGhlIGRldmljZSB0byB0aGUgZ3Vl
c3QgaWYgaXQncyBwcm90ZWN0ZWQgYnkgYW4gSU9NTVUKICAqICAtIE1hcCB0aGUgSVJRcyBhbmQg
aW9tZW0gcmVnaW9ucyB0byBET00wCiAgKi8KQEAgLTEyNjMsMTYgKzEyNjQsMzAgQEAgc3RhdGlj
IGludCBfX2luaXQgaGFuZGxlX2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2
aWNlX25vZGUgKmRldiwKICAgICBkdF9kcHJpbnRrKCIlcyBwYXNzdGhyb3VnaCA9ICVkIG5pcnEg
PSAlZCBuYWRkciA9ICV1XG4iLAogICAgICAgICAgICAgICAgZHRfbm9kZV9mdWxsX25hbWUoZGV2
KSwgbmVlZF9tYXBwaW5nLCBuaXJxLCBuYWRkcik7CiAKLSAgICBpZiAoIGR0X2RldmljZV9pc19w
cm90ZWN0ZWQoZGV2KSAmJiBuZWVkX21hcHBpbmcgKQorICAgIGlmICggbmVlZF9tYXBwaW5nICkK
ICAgICB7Ci0gICAgICAgIGR0X2RwcmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1
bGxfbmFtZShkZXYpKTsKLSAgICAgICAgcmVzID0gaW9tbXVfYXNzaWduX2R0X2RldmljZShkLCBk
ZXYpOwotICAgICAgICBpZiAoIHJlcyApCisgICAgICAgIGR0X2RwcmludGsoIkNoZWNrIGlmICVz
IGlzIGJlaGluZCB0aGUgSU9NTVUgYW5kIGFkZCBpdFxuIiwKKyAgICAgICAgICAgICAgICAgICBk
dF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKKworICAgICAgICByZXMgPSBpb21tdV9hZGRfZHRfZGV2
aWNlKGRldik7CisgICAgICAgIGlmICggcmVzIDwgMCApCiAgICAgICAgIHsKLSAgICAgICAgICAg
IHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQgdG8gc2V0dXAgdGhlIElPTU1VIGZvciAlc1xuIiwK
KyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQgdG8gYWRkICVzIHRvIHRoZSBJ
T01NVVxuIiwKICAgICAgICAgICAgICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKICAg
ICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgIH0KKworICAgICAgICBpZiAoIGR0X2Rldmlj
ZV9pc19wcm90ZWN0ZWQoZGV2KSApCisgICAgICAgIHsKKyAgICAgICAgICAgIGR0X2RwcmludGso
IiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKKyAgICAgICAgICAg
IHJlcyA9IGlvbW11X2Fzc2lnbl9kdF9kZXZpY2UoZCwgZGV2KTsKKyAgICAgICAgICAgIGlmICgg
cmVzICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAi
RmFpbGVkIHRvIHNldHVwIHRoZSBJT01NVSBmb3IgJXNcbiIsCisgICAgICAgICAgICAgICAgICAg
ICAgIGR0X25vZGVfZnVsbF9uYW1lKGRldikpOworICAgICAgICAgICAgICAgIHJldHVybiByZXM7
CisgICAgICAgICAgICB9CisgICAgICAgIH0KICAgICB9CiAKICAgICAvKiBHaXZlIHBlcm1pc3Np
b24gYW5kIG1hcCBJUlFzICovCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9k
ZXZpY2VfdHJlZS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvZGV2aWNlX3RyZWUuYwppbmRl
eCA5MjFhNmU1Li5jYzkwMGJhIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9k
ZXZpY2VfdHJlZS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2RldmljZV90cmVlLmMK
QEAgLTIyLDYgKzIyLDggQEAKICNpbmNsdWRlIDx4ZW4vc2NoZWQuaD4KICNpbmNsdWRlIDx4c20v
eHNtLmg+CiAKKyNpbmNsdWRlIDxhc20vaW9tbXVfZndzcGVjLmg+CisKIHN0YXRpYyBzcGlubG9j
a190IGR0ZGV2c19sb2NrID0gU1BJTl9MT0NLX1VOTE9DS0VEOwogCiBpbnQgaW9tbXVfYXNzaWdu
X2R0X2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKmRldikK
QEAgLTEyNSw2ICsxMjcsNjggQEAgaW50IGlvbW11X3JlbGVhc2VfZHRfZGV2aWNlcyhzdHJ1Y3Qg
ZG9tYWluICpkKQogICAgIHJldHVybiAwOwogfQogCitpbnQgaW9tbXVfYWRkX2R0X2RldmljZShz
dHJ1Y3QgZHRfZGV2aWNlX25vZGUgKm5wKQoreworICAgIGNvbnN0IHN0cnVjdCBpb21tdV9vcHMg
Km9wcyA9IGlvbW11X2dldF9vcHMoKTsKKyAgICBzdHJ1Y3QgZHRfcGhhbmRsZV9hcmdzIGlvbW11
X3NwZWM7CisgICAgc3RydWN0IGRldmljZSAqZGV2ID0gZHRfdG9fZGV2KG5wKTsKKyAgICBpbnQg
cmMgPSAxLCBpbmRleCA9IDA7CisKKyAgICBpZiAoICFpb21tdV9lbmFibGVkICkKKyAgICAgICAg
cmV0dXJuIDE7CisKKyAgICBpZiAoICFvcHMgKQorICAgICAgICByZXR1cm4gLUVJTlZBTDsKKwor
ICAgIGlmICggZGV2X2lvbW11X2Z3c3BlY19nZXQoZGV2KSApCisgICAgICAgIHJldHVybiAtRUVY
SVNUOworCisgICAgLyoKKyAgICAgKiBBY2NvcmRpbmcgdG8gdGhlIERvY3VtZW50YXRpb24vZGV2
aWNldHJlZS9iaW5kaW5ncy9pb21tdS9pb21tdS50eHQKKyAgICAgKiBmcm9tIExpbnV4LgorICAg
ICAqLworICAgIHdoaWxlICggIWR0X3BhcnNlX3BoYW5kbGVfd2l0aF9hcmdzKG5wLCAiaW9tbXVz
IiwgIiNpb21tdS1jZWxscyIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW5kZXgsICZpb21tdV9zcGVjKSApCisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBU
aGUgZHJpdmVyIHdoaWNoIHN1cHBvcnRzIGdlbmVyaWMgSU9NTVUgRFQgYmluZGluZ3MgbXVzdCBo
YXZlCisgICAgICAgICAqIHRoZXNlIGNhbGxiYWNrIGltcGxlbWVudGVkLgorICAgICAgICAgKi8K
KyAgICAgICAgaWYgKCAhb3BzLT5hZGRfZGV2aWNlIHx8ICFvcHMtPmR0X3hsYXRlICkKKyAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOworCisgICAgICAgIGlmICggIWR0X2RldmljZV9pc19hdmFp
bGFibGUoaW9tbXVfc3BlYy5ucCkgKQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAgcmMg
PSBpb21tdV9md3NwZWNfaW5pdChkZXYsICZpb21tdV9zcGVjLm5wLT5kZXYpOworICAgICAgICBp
ZiAoIHJjICkKKyAgICAgICAgICAgIGJyZWFrOworCisgICAgICAgIC8qCisgICAgICAgICAqIFBy
b3ZpZGUgRFQgSU9NTVUgc3BlY2lmaWVyIHdoaWNoIGRlc2NyaWJlcyB0aGUgSU9NTVUgbWFzdGVy
CisgICAgICAgICAqIGludGVyZmFjZXMgb2YgdGhhdCBkZXZpY2UgKGRldmljZSBJRHMsIGV0Yykg
dG8gdGhlIGRyaXZlci4KKyAgICAgICAgICogVGhlIGRyaXZlciBpcyByZXNwb25zaWJsZSB0byBk
ZWNpZGUgaG93IHRvIGludGVycHJldCB0aGVtLgorICAgICAgICAgKi8KKyAgICAgICAgcmMgPSBv
cHMtPmR0X3hsYXRlKGRldiwgJmlvbW11X3NwZWMpOworICAgICAgICBpZiAoIHJjICkKKyAgICAg
ICAgICAgIGJyZWFrOworCisgICAgICAgIGluZGV4Kys7CisgICAgfQorCisgICAgLyoKKyAgICAg
KiBBZGQgbWFzdGVyIGRldmljZSB0byB0aGUgSU9NTVUgaWYgbGF0dGVyIGlzIHByZXNlbnQgYW5k
IGF2YWlsYWJsZS4KKyAgICAgKiBUaGUgZHJpdmVyIGlzIHJlc3BvbnNpYmxlIHRvIG1hcmsgdGhh
dCBkZXZpY2UgYXMgcHJvdGVjdGVkLgorICAgICAqLworICAgIGlmICggIXJjICkKKyAgICAgICAg
cmMgPSBvcHMtPmFkZF9kZXZpY2UoMCwgZGV2KTsKKworICAgIGlmICggcmMgPCAwICkKKyAgICAg
ICAgaW9tbXVfZndzcGVjX2ZyZWUoZGV2KTsKKworICAgIHJldHVybiByYzsKK30KKwogaW50IGlv
bW11X2RvX2R0X2RvbWN0bChzdHJ1Y3QgeGVuX2RvbWN0bCAqZG9tY3RsLCBzdHJ1Y3QgZG9tYWlu
ICpkLAogICAgICAgICAgICAgICAgICAgICAgICBYRU5fR1VFU1RfSEFORExFX1BBUkFNKHhlbl9k
b21jdGxfdCkgdV9kb21jdGwpCiB7CkBAIC0xNjYsNiArMjMwLDE5IEBAIGludCBpb21tdV9kb19k
dF9kb21jdGwoc3RydWN0IHhlbl9kb21jdGwgKmRvbWN0bCwgc3RydWN0IGRvbWFpbiAqZCwKICAg
ICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAKKyAgICAgICAgcmV0ID0gaW9tbXVfYWRkX2R0
X2RldmljZShkZXYpOworICAgICAgICAvKgorICAgICAgICAgKiBJZ25vcmUgIi1FRVhJU1QiIGVy
cm9yIGNvZGUgYXMgaXQgd291bGQgbWVhbiB0aGF0IHRoZSBkZXZpY2UgaXMKKyAgICAgICAgICog
YWxyZWFkeSBhZGRlZCB0byB0aGUgSU9NTVUgKHBvc2l0aXZlIHJlc3VsdCkuIFN1Y2ggaGFwcGVu
cyBhZnRlcgorICAgICAgICAgKiByZS1jcmVhdGluZyBndWVzdCBkb21haW4uCisgICAgICAgICAq
LworICAgICAgICBpZiAoIHJldCA8IDAgJiYgcmV0ICE9IC1FRVhJU1QgKQorICAgICAgICB7Cisg
ICAgICAgICAgICBwcmludGsoWEVOTE9HX0dfRVJSICJGYWlsZWQgdG8gYWRkICVzIHRvIHRoZSBJ
T01NVVxuIiwKKyAgICAgICAgICAgICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICB9CisKICAgICAgICAgcmV0ID0gaW9tbXVfYXNzaWdu
X2R0X2RldmljZShkLCBkZXYpOwogCiAgICAgICAgIGlmICggcmV0ICkKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL3hlbi9pb21tdS5oIGIveGVuL2luY2x1ZGUveGVuL2lvbW11LmgKaW5kZXggN2Mz
MDAzZi4uOTc0YmQzZiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL2lvbW11LmgKKysrIGIv
eGVuL2luY2x1ZGUveGVuL2lvbW11LmgKQEAgLTE4Miw2ICsxODIsMTcgQEAgaW50IGlvbW11X2Rl
YXNzaWduX2R0X2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUg
KmRldik7CiBpbnQgaW9tbXVfZHRfZG9tYWluX2luaXQoc3RydWN0IGRvbWFpbiAqZCk7CiBpbnQg
aW9tbXVfcmVsZWFzZV9kdF9kZXZpY2VzKHN0cnVjdCBkb21haW4gKmQpOwogCisvKgorICogSGVs
cGVyIHRvIGFkZCBtYXN0ZXIgZGV2aWNlIHRvIHRoZSBJT01NVSB1c2luZyBnZW5lcmljIElPTU1V
IERUIGJpbmRpbmdzLgorICoKKyAqIFJldHVybiB2YWx1ZXM6CisgKiAgMCA6IGRldmljZSBpcyBw
cm90ZWN0ZWQgYnkgYW4gSU9NTVUKKyAqIDwwIDogZGV2aWNlIGlzIG5vdCBwcm90ZWN0ZWQgYnkg
YW4gSU9NTVUsIGJ1dCBtdXN0IGJlIChlcnJvciBjb25kaXRpb24pCisgKiA+MCA6IGRldmljZSBk
b2Vzbid0IG5lZWQgdG8gYmUgcHJvdGVjdGVkIGJ5IGFuIElPTU1VCisgKiAgICAgIChJT01NVSBp
cyBub3QgZW5hYmxlZC9wcmVzZW50IG9yIGRldmljZSBpcyBub3QgY29ubmVjdGVkIHRvIGl0KS4K
KyAqLworaW50IGlvbW11X2FkZF9kdF9kZXZpY2Uoc3RydWN0IGR0X2RldmljZV9ub2RlICpucCk7
CisKIGludCBpb21tdV9kb19kdF9kb21jdGwoc3RydWN0IHhlbl9kb21jdGwgKiwgc3RydWN0IGRv
bWFpbiAqLAogICAgICAgICAgICAgICAgICAgICAgICBYRU5fR1VFU1RfSEFORExFX1BBUkFNKHhl
bl9kb21jdGxfdCkpOwogCkBAIC0yNTAsNiArMjYxLDE2IEBAIHN0cnVjdCBpb21tdV9vcHMgewog
ICAgIGludCBfX211c3RfY2hlY2sgKCppb3RsYl9mbHVzaF9hbGwpKHN0cnVjdCBkb21haW4gKmQp
OwogICAgIGludCAoKmdldF9yZXNlcnZlZF9kZXZpY2VfbWVtb3J5KShpb21tdV9ncmRtX3QgKiwg
dm9pZCAqKTsKICAgICB2b2lkICgqZHVtcF9wMm1fdGFibGUpKHN0cnVjdCBkb21haW4gKmQpOwor
CisjaWZkZWYgQ09ORklHX0hBU19ERVZJQ0VfVFJFRQorICAgIC8qCisgICAgICogQWxsIElPTU1V
IGRyaXZlcnMgd2hpY2ggc3VwcG9ydCBnZW5lcmljIElPTU1VIERUIGJpbmRpbmdzIHNob3VsZCB1
c2UKKyAgICAgKiB0aGlzIGNhbGxiYWNrLiBUaGlzIGlzIGEgd2F5IGZvciB0aGUgZnJhbWV3b3Jr
IHRvIHByb3ZpZGUgdGhlIGRyaXZlcgorICAgICAqIHdpdGggRFQgSU9NTVUgc3BlY2lmaWVyIHdo
aWNoIGRlc2NyaWJlcyB0aGUgSU9NTVUgbWFzdGVyIGludGVyZmFjZXMgb2YKKyAgICAgKiB0aGF0
IGRldmljZSAoZGV2aWNlIElEcywgZXRjKS4KKyAgICAgKi8KKyAgICBpbnQgKCpkdF94bGF0ZSko
ZGV2aWNlX3QgKmRldiwgY29uc3Qgc3RydWN0IGR0X3BoYW5kbGVfYXJncyAqYXJncyk7CisjZW5k
aWYKIH07CiAKICNpbmNsdWRlIDxhc20vaW9tbXUuaD4KLS0gCjIuNy40CgoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlz
dApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

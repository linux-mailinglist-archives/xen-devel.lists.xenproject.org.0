Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id F1A061A115
	for <lists+xen-devel@lfdr.de>; Fri, 10 May 2019 18:15:07 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hP87u-0004bu-UV; Fri, 10 May 2019 16:12:02 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=35pT=TK=citrix.com=prvs=026e1af23=roger.pau@srs-us1.protection.inumbo.net>)
 id 1hP87t-0004bZ-W6
 for xen-devel@lists.xenproject.org; Fri, 10 May 2019 16:12:02 +0000
X-Inumbo-ID: 55bcd062-733e-11e9-8b48-dfb1199aaba5
Received: from SMTP03.CITRIX.COM (unknown [162.221.156.55])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 55bcd062-733e-11e9-8b48-dfb1199aaba5;
 Fri, 10 May 2019 16:11:58 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.60,453,1549929600"; d="scan'208";a="85330719"
From: Roger Pau Monne <roger.pau@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Fri, 10 May 2019 18:10:55 +0200
Message-ID: <20190510161056.48648-5-roger.pau@citrix.com>
X-Mailer: git-send-email 2.17.2 (Apple Git-113)
In-Reply-To: <20190510161056.48648-1-roger.pau@citrix.com>
References: <20190510161056.48648-1-roger.pau@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 4/5] print: introduce a format specifier for
 pci_sbdf_t
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wei.liu2@citrix.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Brian Woods <brian.woods@amd.com>, Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIG5ldyBmb3JtYXQgc3BlY2lmaWVyIGlzICclcHAnLCBhbmQgcHJpbnRzIGEgcGNpX3NiZGZf
dCB1c2luZyB0aGUKc2VnOmJ1czpkZXYuZnVuYyBmb3JtYXQuIFJlcGxhY2UgYWxsIFNCREZzIHBy
aW50ZWQgdXNpbmcKJyUwNHg6JTAyeDolMDJ4LiV1JyB0byB1c2UgdGhlIG5ldyBmb3JtYXQgc3Bl
Y2lmaWVyLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2UgZXhwZWN0ZWQuCgpTaWduZWQtb2ZmLWJ5OiBS
b2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4KLS0tCkNjOiBBbmRyZXcgQ29v
cGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpDYzogR2VvcmdlIER1bmxhcCA8R2Vvcmdl
LkR1bmxhcEBldS5jaXRyaXguY29tPgpDYzogSWFuIEphY2tzb24gPGlhbi5qYWNrc29uQGV1LmNp
dHJpeC5jb20+CkNjOiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkNjOiBKdWxpZW4g
R3JhbGwgPGp1bGllbi5ncmFsbEBhcm0uY29tPgpDYzogS29ucmFkIFJ6ZXN6dXRlayBXaWxrIDxr
b25yYWQud2lsa0BvcmFjbGUuY29tPgpDYzogU3RlZmFubyBTdGFiZWxsaW5pIDxzc3RhYmVsbGlu
aUBrZXJuZWwub3JnPgpDYzogVGltIERlZWdhbiA8dGltQHhlbi5vcmc+CkNjOiBXZWkgTGl1IDx3
ZWkubGl1MkBjaXRyaXguY29tPgpDYzogU3VyYXZlZSBTdXRoaWt1bHBhbml0IDxzdXJhdmVlLnN1
dGhpa3VscGFuaXRAYW1kLmNvbT4KQ2M6IEJyaWFuIFdvb2RzIDxicmlhbi53b29kc0BhbWQuY29t
PgpDYzogS2V2aW4gVGlhbiA8a2V2aW4udGlhbkBpbnRlbC5jb20+Ci0tLQogZG9jcy9taXNjL3By
aW50ay1mb3JtYXRzLnR4dCAgICAgICAgICAgICAgICB8ICAgNSArCiB4ZW4vYXJjaC94ODYvaHZt
L3Ztc2kuYyAgICAgICAgICAgICAgICAgICAgIHwgIDEwICstCiB4ZW4vYXJjaC94ODYvbXNpLmMg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDM1ICsrKy0tLQogeGVuL2NvbW1vbi92c3ByaW50
Zi5jICAgICAgICAgICAgICAgICAgICAgICB8ICAxOCArKysKIHhlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdV9hY3BpLmMgICAgfCAgMTcgKystCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfY21kLmMgICAgIHwgICA1ICstCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9h
bWQvaW9tbXVfZGV0ZWN0LmMgIHwgICA1ICstCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfaW5pdC5jICAgIHwgIDExICstCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfaW50ci5jICAgIHwgICA4ICstCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2Ft
ZF9pb21tdS5jIHwgIDMxICsrKy0tCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYyAgICAg
ICAgICAgICAgIHwgMTIxICsrKysrKysrLS0tLS0tLS0tLS0tCiB4ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC92dGQvZG1hci5jICAgICAgICAgIHwgIDI2ICsrLS0tCiB4ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC92dGQvaW50cmVtYXAuYyAgICAgIHwgIDExICstCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC92dGQvaW9tbXUuYyAgICAgICAgIHwgIDc0ICsrKysrLS0tLS0tLQogeGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvdnRkL3F1aXJrcy5jICAgICAgICB8ICAyMyArKy0tCiB4ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC92dGQvdXRpbHMuYyAgICAgICAgIHwgICA2ICstCiB4ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC94ODYvYXRzLmMgICAgICAgICAgIHwgIDEzICstLQogeGVuL2RyaXZlcnMvdnBjaS9oZWFk
ZXIuYyAgICAgICAgICAgICAgICAgICB8ICAxMCArLQogeGVuL2RyaXZlcnMvdnBjaS9tc2kuYyAg
ICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQogeGVuL2RyaXZlcnMvdnBjaS9tc2l4LmMgICAg
ICAgICAgICAgICAgICAgICB8ICAyNSArKy0tCiB4ZW4vaW5jbHVkZS94ZW4vcGNpLmggICAgICAg
ICAgICAgICAgICAgICAgIHwgICAyICsKIDIxIGZpbGVzIGNoYW5nZWQsIDE5NyBpbnNlcnRpb25z
KCspLCAyNjUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNjL3ByaW50ay1mb3Jt
YXRzLnR4dCBiL2RvY3MvbWlzYy9wcmludGstZm9ybWF0cy50eHQKaW5kZXggMDgwZjQ5OGY2NS4u
OGY2NjZmNjk2YSAxMDA2NDQKLS0tIGEvZG9jcy9taXNjL3ByaW50ay1mb3JtYXRzLnR4dAorKysg
Yi9kb2NzL21pc2MvcHJpbnRrLWZvcm1hdHMudHh0CkBAIC00OCwzICs0OCw4IEBAIERvbWFpbiBh
bmQgdkNQVSBpbmZvcm1hdGlvbjoKICAgICAgICAgICAgICAgIFRoZSBkb21haW4gcGFydCBhcyBh
Ym92ZSwgd2l0aCB0aGUgdmNwdV9pZCBwcmludGVkIGluIGRlY2ltYWwuCiAgICAgICAgICAgICAg
ICAgIGUuZy4gIGQwdjEKICAgICAgICAgICAgICAgICAgICAgICAgZFtJRExFXXYwCisKK1BDSToK
KworICAgICAgICVwcCAgICAgUENJIGRldmljZSBhZGRyZXNzIGluIFM6QjpELkYgZm9ybWF0IGZy
b20gYSBwY2lfc2JkZl90LgorICAgICAgICAgICAgICAgICBlLmcuICAwMDA0OjAyOjAwLjAKZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm1zaS5jIGIveGVuL2FyY2gveDg2L2h2bS92bXNp
LmMKaW5kZXggMTVjZmU4ZDA1Ny4uNmY0NjQxYWZiYyAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2
L2h2bS92bXNpLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS92bXNpLmMKQEAgLTY4NiwxMCArNjg2
LDggQEAgc3RhdGljIGludCB2cGNpX21zaV91cGRhdGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBk
ZXYsIHVpbnQzMl90IGRhdGEsCiAKICAgICAgICAgaWYgKCByYyApCiAgICAgICAgIHsKLSAgICAg
ICAgICAgIGdkcHJpbnRrKFhFTkxPR19FUlIsCi0gICAgICAgICAgICAgICAgICAgICAiJTA0eDol
MDJ4OiUwMnguJXU6IGZhaWxlZCB0byBiaW5kIFBJUlEgJXU6ICVkXG4iLAotICAgICAgICAgICAg
ICAgICAgICAgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRldiwK
LSAgICAgICAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuZnVuYywgcGlycSArIGksIHJjKTsKKyAg
ICAgICAgICAgIGdkcHJpbnRrKFhFTkxPR19FUlIsICIlcHA6IGZhaWxlZCB0byBiaW5kIFBJUlEg
JXU6ICVkXG4iLAorICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHBpcnEgKyBpLCBy
Yyk7CiAgICAgICAgICAgICB3aGlsZSAoIGJpbmQubWFjaGluZV9pcnEtLSA+IHBpcnEgKQogICAg
ICAgICAgICAgICAgIHB0X2lycV9kZXN0cm95X2JpbmQocGRldi0+ZG9tYWluLCAmYmluZCk7CiAg
ICAgICAgICAgICByZXR1cm4gcmM7CkBAIC03NDMsOSArNzQxLDcgQEAgc3RhdGljIGludCB2cGNp
X21zaV9lbmFibGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVpbnQzMl90IGRhdGEsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZtc2lfaW5mbyk7CiAgICAgaWYgKCBy
YyApCiAgICAgewotICAgICAgICBnZHByaW50ayhYRU5MT0dfRVJSLCAiJTA0eDolMDJ4OiUwMngu
JXU6IGZhaWxlZCB0byBtYXAgUElSUTogJWRcbiIsCi0gICAgICAgICAgICAgICAgIHBkZXYtPnNi
ZGYuc2VnLCBwZGV2LT5zYmRmLmJ1cywgcGRldi0+c2JkZi5kZXYsCi0gICAgICAgICAgICAgICAg
IHBkZXYtPnNiZGYuZnVuYywgcmMpOworICAgICAgICBnZHByaW50ayhYRU5MT0dfRVJSLCAiJXBw
OiBmYWlsZWQgdG8gbWFwIFBJUlE6ICVkXG4iLCAmcGRldi0+c2JkZiwgcmMpOwogICAgICAgICBy
ZXR1cm4gcmM7CiAgICAgfQogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbXNpLmMgYi94ZW4v
YXJjaC94ODYvbXNpLmMKaW5kZXggYWQ0YTcyZDU2Yi4uNjgzMjIxMTc3MiAxMDA2NDQKLS0tIGEv
eGVuL2FyY2gveDg2L21zaS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tc2kuYwpAQCAtNDMyLDggKzQz
Miw4IEBAIHN0YXRpYyBib29sIG1zaV9zZXRfbWFza19iaXQoc3RydWN0IGlycV9kZXNjICpkZXNj
LCBib29sIGhvc3QsIGJvb2wgZ3Vlc3QpCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAg
cGRldi0+bXNpeC0+d2FybmVkID0gZG9taWQ7CiAgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxP
R19HX1dBUk5JTkcKLSAgICAgICAgICAgICAgICAgICAgICAgImNhbm5vdCBtYXNrIElSUSAlZDog
bWFza2luZyBNU0ktWCBvbiBEb20lZCdzICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAg
ICAgICAgICAgICAgICBkZXNjLT5pcnEsIGRvbWlkLCBzZWcsIGJ1cywgc2xvdCwgZnVuYyk7Cisg
ICAgICAgICAgICAgICAgICAgICAgICJjYW5ub3QgbWFzayBJUlEgJWQ6IG1hc2tpbmcgTVNJLVgg
b24gRG9tJWQncyAlcHBcbiIsCisgICAgICAgICAgICAgICAgICAgICAgIGRlc2MtPmlycSwgZG9t
aWQsICZwZGV2LT5zYmRmKTsKICAgICAgICAgICAgIH0KICAgICAgICAgfQogICAgICAgICBwZGV2
LT5tc2l4LT5ob3N0X21hc2thbGwgPSBtYXNrYWxsOwpAQCAtOTkxLDExICs5OTEsMTAgQEAgc3Rh
dGljIGludCBtc2l4X2NhcGFiaWxpdHlfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LAogICAgICAg
ICAgICAgc3RydWN0IGRvbWFpbiAqZCA9IGRldi0+ZG9tYWluID86IGN1cnJkOwogCiAgICAgICAg
ICAgICBpZiAoICFpc19oYXJkd2FyZV9kb21haW4oY3VycmQpIHx8IGQgIT0gY3VycmQgKQotICAg
ICAgICAgICAgICAgIHByaW50aygiJXMgdXNlIG9mIE1TSS1YIG9uICUwNHg6JTAyeDolMDJ4LiV1
IGJ5IERvbSVkXG4iLAorICAgICAgICAgICAgICAgIHByaW50aygiJXMgdXNlIG9mIE1TSS1YIG9u
ICVwcCBieSBEb20lZFxuIiwKICAgICAgICAgICAgICAgICAgICAgICAgaXNfaGFyZHdhcmVfZG9t
YWluKGN1cnJkKQogICAgICAgICAgICAgICAgICAgICAgICA/IFhFTkxPR19XQVJOSU5HICJQb3Rl
bnRpYWxseSBpbnNlY3VyZSIKLSAgICAgICAgICAgICAgICAgICAgICAgOiBYRU5MT0dfRVJSICJJ
bnNlY3VyZSIsCi0gICAgICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBzbG90LCBmdW5jLCBk
LT5kb21haW5faWQpOworICAgICAgICAgICAgICAgICAgICAgICA6IFhFTkxPR19FUlIgIkluc2Vj
dXJlIiwgJmRldi0+c2JkZiwgZC0+ZG9tYWluX2lkKTsKICAgICAgICAgICAgIGlmICggIWlzX2hh
cmR3YXJlX2RvbWFpbihkKSAmJgogICAgICAgICAgICAgICAgICAvKiBBc3N1bWUgYSBkb21haW4g
d2l0aG91dCBtZW1vcnkgaGFzIG5vIG1hcHBpbmdzIHlldC4gKi8KICAgICAgICAgICAgICAgICAg
KCFpc19oYXJkd2FyZV9kb21haW4oY3VycmQpIHx8IGQtPnRvdF9wYWdlcykgKQpAQCAtMTA1MCwx
OCArMTA0OSwxNSBAQCBzdGF0aWMgaW50IF9fcGNpX2VuYWJsZV9tc2koc3RydWN0IG1zaV9pbmZv
ICptc2ksIHN0cnVjdCBtc2lfZGVzYyAqKmRlc2MpCiAgICAgb2xkX2Rlc2MgPSBmaW5kX21zaV9l
bnRyeShwZGV2LCBtc2ktPmlycSwgUENJX0NBUF9JRF9NU0kpOwogICAgIGlmICggb2xkX2Rlc2Mg
KQogICAgIHsKLSAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgImlycSAlZCBhbHJlYWR5IG1hcHBl
ZCB0byBNU0kgb24gJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICBtc2ktPmly
cSwgbXNpLT5zZWcsIG1zaS0+YnVzLAotICAgICAgICAgICAgICAgUENJX1NMT1QobXNpLT5kZXZm
biksIFBDSV9GVU5DKG1zaS0+ZGV2Zm4pKTsKKyAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgImly
cSAlZCBhbHJlYWR5IG1hcHBlZCB0byBNU0kgb24gJXBwXG4iLAorICAgICAgICAgICAgICAgbXNp
LT5pcnEsICZwZGV2LT5zYmRmKTsKICAgICAgICAgcmV0dXJuIC1FRVhJU1Q7CiAgICAgfQogCiAg
ICAgb2xkX2Rlc2MgPSBmaW5kX21zaV9lbnRyeShwZGV2LCAtMSwgUENJX0NBUF9JRF9NU0lYKTsK
ICAgICBpZiAoIG9sZF9kZXNjICkKICAgICB7Ci0gICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklO
RyAiTVNJLVggYWxyZWFkeSBpbiB1c2Ugb24gJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAg
ICAgICAgICBtc2ktPnNlZywgbXNpLT5idXMsCi0gICAgICAgICAgICAgICBQQ0lfU0xPVChtc2kt
PmRldmZuKSwgUENJX0ZVTkMobXNpLT5kZXZmbikpOworICAgICAgICBwcmludGsoWEVOTE9HX1dB
Uk5JTkcgIk1TSS1YIGFscmVhZHkgaW4gdXNlIG9uICVwcFxuIiwgJnBkZXYtPnNiZGYpOwogICAg
ICAgICBfX3BjaV9kaXNhYmxlX21zaXgob2xkX2Rlc2MpOwogICAgIH0KIApAQCAtMTExOCwxNiAr
MTExNCwxNSBAQCBzdGF0aWMgaW50IF9fcGNpX2VuYWJsZV9tc2l4KHN0cnVjdCBtc2lfaW5mbyAq
bXNpLCBzdHJ1Y3QgbXNpX2Rlc2MgKipkZXNjKQogICAgIG9sZF9kZXNjID0gZmluZF9tc2lfZW50
cnkocGRldiwgbXNpLT5pcnEsIFBDSV9DQVBfSURfTVNJWCk7CiAgICAgaWYgKCBvbGRfZGVzYyAp
CiAgICAgewotICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiaXJxICVkIGFscmVhZHkgbWFwcGVk
IHRvIE1TSS1YIG9uICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgbXNpLT5p
cnEsIG1zaS0+c2VnLCBtc2ktPmJ1cywgc2xvdCwgZnVuYyk7CisgICAgICAgIHByaW50ayhYRU5M
T0dfRVJSICJpcnEgJWQgYWxyZWFkeSBtYXBwZWQgdG8gTVNJLVggb24gJXBwXG4iLAorICAgICAg
ICAgICAgICAgbXNpLT5pcnEsICZwZGV2LT5zYmRmKTsKICAgICAgICAgcmV0dXJuIC1FRVhJU1Q7
CiAgICAgfQogCiAgICAgb2xkX2Rlc2MgPSBmaW5kX21zaV9lbnRyeShwZGV2LCAtMSwgUENJX0NB
UF9JRF9NU0kpOwogICAgIGlmICggb2xkX2Rlc2MgKQogICAgIHsKLSAgICAgICAgcHJpbnRrKFhF
TkxPR19XQVJOSU5HICJNU0kgYWxyZWFkeSBpbiB1c2Ugb24gJTA0eDolMDJ4OiUwMnguJXVcbiIs
Ci0gICAgICAgICAgICAgICBtc2ktPnNlZywgbXNpLT5idXMsIHNsb3QsIGZ1bmMpOworICAgICAg
ICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIk1TSSBhbHJlYWR5IGluIHVzZSBvbiAlcHBcbiIsICZw
ZGV2LT5zYmRmKTsKICAgICAgICAgX19wY2lfZGlzYWJsZV9tc2kob2xkX2Rlc2MpOwogICAgIH0K
IApAQCAtMTE3NSw4ICsxMTcwLDggQEAgc3RhdGljIHZvaWQgX19wY2lfZGlzYWJsZV9tc2l4KHN0
cnVjdCBtc2lfZGVzYyAqZW50cnkpCiAgICAgZWxzZSBpZiAoICEoY29udHJvbCAmIFBDSV9NU0lY
X0ZMQUdTX01BU0tBTEwpICkKICAgICB7CiAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORwot
ICAgICAgICAgICAgICAgImNhbm5vdCBkaXNhYmxlIElSUSAlZDogbWFza2luZyBNU0ktWCBvbiAl
MDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgIGVudHJ5LT5pcnEsIHNlZywgYnVz
LCBzbG90LCBmdW5jKTsKKyAgICAgICAgICAgICAgICJjYW5ub3QgZGlzYWJsZSBJUlEgJWQ6IG1h
c2tpbmcgTVNJLVggb24gJXBwXG4iLAorICAgICAgICAgICAgICAgZW50cnktPmlycSwgJmRldi0+
c2JkZik7CiAgICAgICAgIG1hc2thbGwgPSB0cnVlOwogICAgIH0KICAgICBkZXYtPm1zaXgtPmhv
c3RfbWFza2FsbCA9IG1hc2thbGw7CkBAIC0xMzQyLDcgKzEzMzcsNiBAQCBpbnQgcGNpX3Jlc3Rv
cmVfbXNpX3N0YXRlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgIHN0cnVjdCBtc2lfZGVzYyAq
ZW50cnksICp0bXA7CiAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjOwogICAgIHN0cnVjdCBtc2lf
bXNnIG1zZzsKLSAgICB1aW50OF90IHNsb3QgPSBwZGV2LT5zYmRmLmRldiwgZnVuYyA9IHBkZXYt
PnNiZGYuZnVuYzsKICAgICB1bnNpZ25lZCBpbnQgdHlwZSA9IDAsIHBvcyA9IDA7CiAgICAgdTE2
IGNvbnRyb2wgPSAwOwogCkBAIC0xMzY5LDkgKzEzNjMsOCBAQCBpbnQgcGNpX3Jlc3RvcmVfbXNp
X3N0YXRlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICBpZiAoZGVzYy0+bXNpX2Rlc2Mg
IT0gZW50cnkpCiAgICAgICAgIHsKICAgICBib2d1czoKLSAgICAgICAgICAgIGRwcmludGsoWEVO
TE9HX0VSUiwKLSAgICAgICAgICAgICAgICAgICAgIlJlc3RvcmUgTVNJIGZvciAlMDR4OiUwMng6
JTAyeDoldSBlbnRyeSAldSBub3Qgc2V0P1xuIiwKLSAgICAgICAgICAgICAgICAgICAgcGRldi0+
c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBzbG90LCBmdW5jLCBpKTsKKyAgICAgICAgICAgIGRw
cmludGsoWEVOTE9HX0VSUiwgIlJlc3RvcmUgTVNJIGZvciAlcHAgZW50cnkgJXUgbm90IHNldD9c
biIsCisgICAgICAgICAgICAgICAgICAgICZwZGV2LT5zYmRmLCBpKTsKICAgICAgICAgICAgIHNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmRlc2MtPmxvY2ssIGZsYWdzKTsKICAgICAgICAgICAgIGlm
ICggdHlwZSA9PSBQQ0lfQ0FQX0lEX01TSVggKQogICAgICAgICAgICAgICAgIHBjaV9jb25mX3dy
aXRlMTYocGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLApkaWZmIC0tZ2l0IGEveGVu
L2NvbW1vbi92c3ByaW50Zi5jIGIveGVuL2NvbW1vbi92c3ByaW50Zi5jCmluZGV4IDM1MmQ0M2I0
MjUuLmIzMGVkMDg2ODcgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vdnNwcmludGYuYworKysgYi94
ZW4vY29tbW9uL3ZzcHJpbnRmLmMKQEAgLTM5Miw2ICszOTIsMjAgQEAgc3RhdGljIGNoYXIgKnBy
aW50X3ZjcHUoY2hhciAqc3RyLCBjaGFyICplbmQsIGNvbnN0IHN0cnVjdCB2Y3B1ICp2KQogICAg
IHJldHVybiBudW1iZXIoc3RyICsgMSwgZW5kLCB2LT52Y3B1X2lkLCAxMCwgLTEsIC0xLCAwKTsK
IH0KIAorc3RhdGljIGNoYXIgKnByaW50X3BjaV9hZGRyKGNoYXIgKnN0ciwgY2hhciAqZW5kLCBj
b25zdCBwY2lfc2JkZl90ICpzYmRmKQoreworICAgIHN0ciA9IG51bWJlcihzdHIsIGVuZCwgc2Jk
Zi0+c2VnLCAxNiwgNCwgLTEsIFpFUk9QQUQpOworICAgIGlmICggc3RyIDwgZW5kICkKKyAgICAg
ICAgKnN0ciA9ICc6JzsKKyAgICBzdHIgPSBudW1iZXIoc3RyICsgMSwgZW5kLCBzYmRmLT5idXMs
IDE2LCAyLCAtMSwgWkVST1BBRCk7CisgICAgaWYgKCBzdHIgPCBlbmQgKQorICAgICAgICAqc3Ry
ID0gJzonOworICAgIHN0ciA9IG51bWJlcihzdHIgKyAxLCBlbmQsIHNiZGYtPmRldiwgMTYsIDIs
IC0xLCBaRVJPUEFEKTsKKyAgICBpZiAoIHN0ciA8IGVuZCApCisgICAgICAgICpzdHIgPSAnLic7
CisgICAgcmV0dXJuIG51bWJlcihzdHIgKyAxLCBlbmQsIHNiZGYtPmZ1bmMsIDEwLCAtMSwgLTEs
IDApOworfQorCiBzdGF0aWMgY2hhciAqcG9pbnRlcihjaGFyICpzdHIsIGNoYXIgKmVuZCwgY29u
c3QgY2hhciAqKmZtdF9wdHIsCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2b2lkICphcmcs
IGludCBmaWVsZF93aWR0aCwgaW50IHByZWNpc2lvbiwKICAgICAgICAgICAgICAgICAgICAgIGlu
dCBmbGFncykKQEAgLTUxOSw2ICs1MzMsMTAgQEAgc3RhdGljIGNoYXIgKnBvaW50ZXIoY2hhciAq
c3RyLCBjaGFyICplbmQsIGNvbnN0IGNoYXIgKipmbXRfcHRyLAogICAgIGNhc2UgJ3YnOiAvKiBk
PGRvbWFpbi1pZD52PHZjcHUtaWQ+IGZyb20gYSBzdHJ1Y3QgdmNwdSAqLwogICAgICAgICArKypm
bXRfcHRyOwogICAgICAgICByZXR1cm4gcHJpbnRfdmNwdShzdHIsIGVuZCwgYXJnKTsKKworICAg
IGNhc2UgJ3AnOiAvKiBQQ0kgU0JERi4gKi8KKyAgICAgICAgKysqZm10X3B0cjsKKyAgICAgICAg
cmV0dXJuIHByaW50X3BjaV9hZGRyKHN0ciwgZW5kLCBhcmcpOwogICAgIH0KIAogICAgIGlmICgg
ZmllbGRfd2lkdGggPT0gLTEgKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2FjcGkuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3Bp
LmMKaW5kZXggNjRkMTA0ODFkNy4uZDkwMGZlZWYwOSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfYWNwaS5jCkBAIC03MTcsOSArNzE3LDggQEAgc3RhdGljIHUxNiBfX2luaXQg
cGFyc2VfaXZoZF9kZXZpY2Vfc3BlY2lhbCgKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCi0g
ICAgQU1EX0lPTU1VX0RFQlVHKCJJVkhEIFNwZWNpYWw6ICUwNHg6JTAyeDolMDJ4LiV1IHZhcmll
dHkgJSN4IGhhbmRsZSAlI3hcbiIsCi0gICAgICAgICAgICAgICAgICAgIHNlZywgUENJX0JVUyhi
ZGYpLCBQQ0lfU0xPVChiZGYpLCBQQ0lfRlVOQyhiZGYpLAotICAgICAgICAgICAgICAgICAgICBz
cGVjaWFsLT52YXJpZXR5LCBzcGVjaWFsLT5oYW5kbGUpOworICAgIEFNRF9JT01NVV9ERUJVRygi
SVZIRCBTcGVjaWFsOiAlcHAgdmFyaWV0eSAlI3ggaGFuZGxlICUjeFxuIiwKKyAgICAgICAgICAg
ICAgICAgICAgJlBDSV9TQkRGMl9UKHNlZywgYmRmKSwgc3BlY2lhbC0+dmFyaWV0eSwgc3BlY2lh
bC0+aGFuZGxlKTsKICAgICBhZGRfaXZyc19tYXBwaW5nX2VudHJ5KGJkZiwgYmRmLCBzcGVjaWFs
LT5oZWFkZXIuZGF0YV9zZXR0aW5nLCBpb21tdSk7CiAKICAgICBzd2l0Y2ggKCBzcGVjaWFsLT52
YXJpZXR5ICkKQEAgLTc0Miw5ICs3NDEsOSBAQCBzdGF0aWMgdTE2IF9faW5pdCBwYXJzZV9pdmhk
X2RldmljZV9zcGVjaWFsKAogICAgICAgICBpZiAoIGlkeCA8IG5yX2lvYXBpY19zYmRmICkKICAg
ICAgICAgewogICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJJVkhEOiBDb21tYW5kIGxpbmUg
b3ZlcnJpZGUgcHJlc2VudCBmb3IgSU8tQVBJQyAlI3giCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIihJVlJTOiAlI3ggZGV2SUQgJTA0eDolMDJ4OiUwMnguJXUpXG4iLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGlvYXBpY19zYmRmW2lkeF0uaWQsIHNwZWNpYWwtPmhhbmRsZSwg
c2VnLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CVVMoYmRmKSwgUENJX1NMT1Qo
YmRmKSwgUENJX0ZVTkMoYmRmKSk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIihJVlJT
OiAlI3ggZGV2SUQgJXBwKVxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb2FwaWNf
c2JkZltpZHhdLmlkLCBzcGVjaWFsLT5oYW5kbGUsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJlBDSV9TQkRGMl9UKHNlZywgYmRmKSk7CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
fQogCkBAIC04MTQsOSArODEzLDkgQEAgc3RhdGljIHUxNiBfX2luaXQgcGFyc2VfaXZoZF9kZXZp
Y2Vfc3BlY2lhbCgKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIEhQRVRfQ01ETDoK
ICAgICAgICAgICAgIEFNRF9JT01NVV9ERUJVRygiSVZIRDogQ29tbWFuZCBsaW5lIG92ZXJyaWRl
IHByZXNlbnQgZm9yIEhQRVQgJSN4ICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAiKElW
UlM6ICUjeCBkZXZJRCAlMDR4OiUwMng6JTAyeC4ldSlcbiIsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaHBldF9zYmRmLmlkLCBzcGVjaWFsLT5oYW5kbGUsIHNlZywgUENJX0JVUyhiZGYp
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGJkZiksIFBDSV9GVU5DKGJk
ZikpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICIoSVZSUzogJSN4IGRldklEICVwcClc
biIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHBldF9zYmRmLmlkLCBzcGVjaWFsLT5o
YW5kbGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGMl9UKHNlZywgYmRm
KSk7CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSBIUEVUX05PTkU6CiAgICAgICAg
ICAgICAvKiBzZXQgZGV2aWNlIGlkIG9mIGhwZXQgKi8KZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9jbWQuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdV9jbWQuYwppbmRleCA4MjMzMGMyNGJhLi45YmJjNWE1NTQ1IDEwMDY0NAotLS0gYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yOTYsOSArMjk2LDggQEAgdm9pZCBhbWRf
aW9tbXVfZmx1c2hfaW90bGIodTggZGV2Zm4sIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LAog
CiAgICAgaWYgKCAhaW9tbXUgKQogICAgIHsKLSAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCIlczog
Q2FuJ3QgZmluZCBpb21tdSBmb3IgJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAg
ICAgICAgICAgICBfX2Z1bmNfXywgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLAotICAg
ICAgICAgICAgICAgICAgICAgICAgcGRldi0+c2JkZi5kZXYsIHBkZXYtPnNiZGYuZnVuYyk7Cisg
ICAgICAgIEFNRF9JT01NVV9ERUJVRygiJXM6IENhbid0IGZpbmQgaW9tbXUgZm9yICVwcFxuIiwK
KyAgICAgICAgICAgICAgICAgICAgICAgIF9fZnVuY19fLCAmcGRldi0+c2JkZik7CiAgICAgICAg
IHJldHVybjsKICAgICB9CiAKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdV9kZXRlY3QuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9kZXRl
Y3QuYwppbmRleCBlOGQ4ZWM1OWJkLi45MWY1ZWE2YmZmIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfZGV0ZWN0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvYW1kL2lvbW11X2RldGVjdC5jCkBAIC0xNTMsOSArMTUzLDggQEAgaW50IF9faW5pdCBh
bWRfaW9tbXVfZGV0ZWN0X29uZV9hY3BpKAogCiAgICAgcnQgPSBwY2lfcm9fZGV2aWNlKGlvbW11
LT5zZWcsIGJ1cywgUENJX0RFVkZOKGRldiwgZnVuYykpOwogICAgIGlmICggcnQgKQotICAgICAg
ICBwcmludGsoWEVOTE9HX0VSUgotICAgICAgICAgICAgICAgIkNvdWxkIG5vdCBtYXJrIGNvbmZp
ZyBzcGFjZSBvZiAlMDR4OiUwMng6JTAyeC4ldSByZWFkLW9ubHkgKCVkKVxuIiwKLSAgICAgICAg
ICAgICAgIGlvbW11LT5zZWcsIGJ1cywgZGV2LCBmdW5jLCBydCk7CisgICAgICAgIHByaW50ayhY
RU5MT0dfRVJSICJDb3VsZCBub3QgbWFyayBjb25maWcgc3BhY2Ugb2YgJXBwIHJlYWQtb25seSAo
JWQpXG4iLAorICAgICAgICAgICAgICAgJlBDSV9TQkRGMl9UKGlvbW11LT5zZWcsIGlvbW11LT5i
ZGYpLCBydCk7CiAKICAgICBsaXN0X2FkZF90YWlsKCZpb21tdS0+bGlzdCwgJmFtZF9pb21tdV9o
ZWFkKTsKICAgICBydCA9IDA7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9h
bWQvaW9tbXVfaW5pdC5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQu
YwppbmRleCBmZTA1MTZmNzg4Li5mMzljNjc5NDlmIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9pb21tdV9pbml0LmMKQEAgLTc5Myw5ICs3OTMsOCBAQCBzdGF0aWMgYm9vbF90IF9faW5p
dCBzZXRfaW9tbXVfaW50ZXJydXB0X2hhbmRsZXIoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCiAg
ICAgcGNpZGV2c191bmxvY2soKTsKICAgICBpZiAoICFpb21tdS0+bXNpLmRldiApCiAgICAgewot
ICAgICAgICBBTURfSU9NTVVfREVCVUcoIklPTU1VOiBubyBwZGV2IGZvciAlMDR4OiUwMng6JTAy
eC4ldVxuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgIGlvbW11LT5zZWcsIFBDSV9CVVMoaW9t
bXUtPmJkZiksCi0gICAgICAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChpb21tdS0+YmRmKSwg
UENJX0ZVTkMoaW9tbXUtPmJkZikpOworICAgICAgICBBTURfSU9NTVVfREVCVUcoIklPTU1VOiBu
byBwZGV2IGZvciAlcHBcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICAmUENJX1NCREYyX1Qo
aW9tbXUtPnNlZywgaW9tbXUtPmJkZikpOwogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAgICAg
Y29udHJvbCA9IHBjaV9jb25mX3JlYWQxNihpb21tdS0+bXNpLmRldi0+c2JkZiwKQEAgLTgzOCw5
ICs4MzcsNiBAQCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfZXJyYXR1bV83NDZfd29ya2Fyb3VuZChz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKICAgICAgICAgLnNlZyA9IGlvbW11LT5zZWcsCiAgICAg
ICAgIC5iZGYgPSBpb21tdS0+YmRmLAogICAgIH07Ci0gICAgdTggYnVzID0gUENJX0JVUyhpb21t
dS0+YmRmKTsKLSAgICB1OCBkZXYgPSBQQ0lfU0xPVChpb21tdS0+YmRmKTsKLSAgICB1OCBmdW5j
ID0gUENJX0ZVTkMoaW9tbXUtPmJkZik7CiAKICAgICBpZiAoIChib290X2NwdV9kYXRhLng4NiAh
PSAweDE1KSB8fAogICAgICAgICAgKGJvb3RfY3B1X2RhdGEueDg2X21vZGVsIDwgMHgxMCkgfHwK
QEAgLTg1OCw4ICs4NTQsNyBAQCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfZXJyYXR1bV83NDZfd29y
a2Fyb3VuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKIAogICAgIHBjaV9jb25mX3dyaXRlMzIo
c2JkZiwgMHhmNCwgdmFsdWUgfCAoMSA8PCAyKSk7CiAgICAgcHJpbnRrKFhFTkxPR19JTkZPCi0g
ICAgICAgICAgICJBTUQtVmk6IEFwcGx5aW5nIGVycmF0dW0gNzQ2IHdvcmthcm91bmQgZm9yIElP
TU1VIGF0ICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICBpb21tdS0+c2VnLCBidXMs
IGRldiwgZnVuYyk7CisgICAgICAgICAgICJBTUQtVmk6IEFwcGx5aW5nIGVycmF0dW0gNzQ2IHdv
cmthcm91bmQgZm9yIElPTU1VIGF0ICVwcFxuIiwgJnNiZGYpOwogCiAgICAgLyogQ2xlYXIgdGhl
IGVuYWJsZSB3cml0aW5nIGJpdCAqLwogICAgIHBjaV9jb25mX3dyaXRlMzIoc2JkZiwgMHhmMCwg
MHg5MCk7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50
ci5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2ludHIuYwppbmRleCA3MTU5
NGNjMjdkLi5lY2E4ZGVjYzA1IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9h
bWQvaW9tbXVfaW50ci5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9p
bnRyLmMKQEAgLTUxMSw4ICs1MTEsNyBAQCBzdGF0aWMgc3RydWN0IGFtZF9pb21tdSAqX2ZpbmRf
aW9tbXVfZm9yX2RldmljZShpbnQgc2VnLCBpbnQgYmRmKQogICAgIGlmICggaW9tbXUgKQogICAg
ICAgICByZXR1cm4gaW9tbXU7CiAKLSAgICBBTURfSU9NTVVfREVCVUcoIk5vIElPTU1VIGZvciBN
U0kgZGV2ID0gJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgIHNlZywg
UENJX0JVUyhiZGYpLCBQQ0lfU0xPVChiZGYpLCBQQ0lfRlVOQyhiZGYpKTsKKyAgICBBTURfSU9N
TVVfREVCVUcoIk5vIElPTU1VIGZvciBNU0kgZGV2ID0gJXBwXG4iLCAmUENJX1NCREYyX1Qoc2Vn
LCBiZGYpKTsKICAgICByZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsKIH0KIApAQCAtNjg3LDEwICs2
ODYsNyBAQCBzdGF0aWMgaW50IGR1bXBfaW50cmVtYXBfbWFwcGluZyh1MTYgc2VnLCBzdHJ1Y3Qg
aXZyc19tYXBwaW5ncyAqaXZyc19tYXBwaW5nKQogICAgIGlmICggIWl2cnNfbWFwcGluZyApCiAg
ICAgICAgIHJldHVybiAwOwogCi0gICAgcHJpbnRrKCIgICUwNHg6JTAyeDolMDJ4OiV1OlxuIiwg
c2VnLAotICAgICAgICAgICBQQ0lfQlVTKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCks
Ci0gICAgICAgICAgIFBDSV9TTE9UKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCksCi0g
ICAgICAgICAgIFBDSV9GVU5DKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCkpOworICAg
IHByaW50aygiICAlcHA6XG4iLCAmUENJX1NCREYyX1Qoc2VnLGl2cnNfbWFwcGluZy0+ZHRlX3Jl
cXVlc3Rvcl9pZCkpOwogCiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJihpdnJzX21hcHBpbmctPmlu
dHJlbWFwX2xvY2spLCBmbGFncyk7CiAgICAgZHVtcF9pbnRyZW1hcF90YWJsZShpdnJzX21hcHBp
bmctPmludHJlbWFwX3RhYmxlKTsKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L2FtZC9wY2lfYW1kX2lvbW11LmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2Ft
ZF9pb21tdS5jCmluZGV4IDBlNGM1YjQ5OTQuLjU3ODdkZmY5MTQgMTAwNjQ0Ci0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwpAQCAtNTIsOSArNTIsOCBAQCBzdHJ1Y3Qg
YW1kX2lvbW11ICpmaW5kX2lvbW11X2Zvcl9kZXZpY2UoaW50IHNlZywgaW50IGJkZikKICAgICAg
ICAgICAgICAgICB0bXAuZHRlX3JlcXVlc3Rvcl9pZCA9IGJkZjsKICAgICAgICAgICAgIGl2cnNf
bWFwcGluZ3NbYmRmXSA9IHRtcDsKIAotICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5H
ICIlMDR4OiUwMng6JTAyeC4ldSBub3QgZm91bmQgaW4gQUNQSSB0YWJsZXM7IgotICAgICAgICAg
ICAgICAgICAgICIgdXNpbmcgc2FtZSBJT01NVSBhcyBmdW5jdGlvbiAwXG4iLAotICAgICAgICAg
ICAgICAgICAgIHNlZywgUENJX0JVUyhiZGYpLCBQQ0lfU0xPVChiZGYpLCBQQ0lfRlVOQyhiZGYp
KTsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyAiJXBwIG5vdCBmb3VuZCBpbiBB
Q1BJIHRhYmxlczsiCisgICAgICAgICAgICAgICAgICAgIiB1c2luZyBzYW1lIElPTU1VIGFzIGZ1
bmN0aW9uIDBcbiIsICZQQ0lfU0JERjJfVChzZWcsIGJkZikpOwogCiAgICAgICAgICAgICAvKiB3
cml0ZSBpb21tdSBmaWVsZCBsYXN0ICovCiAgICAgICAgICAgICBpdnJzX21hcHBpbmdzW2JkZl0u
aW9tbXUgPSBpdnJzX21hcHBpbmdzW2JkMF0uaW9tbXU7CkBAIC0zMDYsOSArMzA1LDkgQEAgc3Rh
dGljIGludCByZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqc291cmNlLCBzdHJ1Y3QgZG9t
YWluICp0YXJnZXQsCiAgICAgaWYgKCAhaW9tbXUgKQogICAgIHsKICAgICAgICAgQU1EX0lPTU1V
X0RFQlVHKCJGYWlsIHRvIGZpbmQgaW9tbXUuIgotICAgICAgICAgICAgICAgICAgICAgICAgIiAl
MDR4OiUwMng6JXgwMi4leCBjYW5ub3QgYmUgYXNzaWduZWQgdG8gZG9tJWRcbiIsCi0gICAgICAg
ICAgICAgICAgICAgICAgICBwZGV2LT5zYmRmLnNlZywgcGRldi0+c2JkZi5idXMsIFBDSV9TTE9U
KGRldmZuKSwKLSAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9GVU5DKGRldmZuKSwgdGFyZ2V0
LT5kb21haW5faWQpOworICAgICAgICAgICAgICAgICAgICAgICAgIiAlcHAgY2Fubm90IGJlIGFz
c2lnbmVkIHRvIGRvbSVkXG4iLAorICAgICAgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGM19U
KHBkZXYtPnNiZGYuc2VnLCBwZGV2LT5zYmRmLmJ1cywgZGV2Zm4pLAorICAgICAgICAgICAgICAg
ICAgICAgICAgdGFyZ2V0LT5kb21haW5faWQpOwogICAgICAgICByZXR1cm4gLUVOT0RFVjsKICAg
ICB9CiAKQEAgLTMyNSw5ICszMjQsOSBAQCBzdGF0aWMgaW50IHJlYXNzaWduX2RldmljZShzdHJ1
Y3QgZG9tYWluICpzb3VyY2UsIHN0cnVjdCBkb21haW4gKnRhcmdldCwKICAgICAgICAgcmV0dXJu
IHJjOwogCiAgICAgYW1kX2lvbW11X3NldHVwX2RvbWFpbl9kZXZpY2UodGFyZ2V0LCBpb21tdSwg
ZGV2Zm4sIHBkZXYpOwotICAgIEFNRF9JT01NVV9ERUJVRygiUmUtYXNzaWduICUwNHg6JTAyeDol
MDJ4LiV1IGZyb20gZG9tJWQgdG8gZG9tJWRcbiIsCi0gICAgICAgICAgICAgICAgICAgIHBkZXYt
PnNiZGYuc2VnLCBwZGV2LT5zYmRmLmJ1cywgUENJX1NMT1QoZGV2Zm4pLAotICAgICAgICAgICAg
ICAgICAgICBQQ0lfRlVOQyhkZXZmbiksIHNvdXJjZS0+ZG9tYWluX2lkLCB0YXJnZXQtPmRvbWFp
bl9pZCk7CisgICAgQU1EX0lPTU1VX0RFQlVHKCJSZS1hc3NpZ24gJXBwIGZyb20gZG9tJWQgdG8g
ZG9tJWRcbiIsCisgICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERjNfVChwZGV2LT5zYmRmLnNl
ZywgcGRldi0+c2JkZi5idXMsIGRldmZuKSwKKyAgICAgICAgICAgICAgICAgICAgc291cmNlLT5k
b21haW5faWQsIHRhcmdldC0+ZG9tYWluX2lkKTsKIAogICAgIHJldHVybiAwOwogfQpAQCAtNDMw
LDE1ICs0MjksMTIgQEAgc3RhdGljIGludCBhbWRfaW9tbXVfYWRkX2RldmljZSh1OCBkZXZmbiwg
c3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgIGlmICggcGRldi0+dHlwZSA9PSBERVZfVFlQ
RV9QQ0lfSE9TVF9CUklER0UgJiYKICAgICAgICAgICAgICBpc19oYXJkd2FyZV9kb21haW4ocGRl
di0+ZG9tYWluKSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIEFNRF9JT01NVV9ERUJVRygiU2tp
cHBpbmcgaG9zdCBicmlkZ2UgJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRl
diwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5zYmRmLmZ1bmMpOworICAgICAg
ICAgICAgQU1EX0lPTU1VX0RFQlVHKCJTa2lwcGluZyBob3N0IGJyaWRnZSAlcHBcbiIsICZwZGV2
LT5zYmRmKTsKICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICB9CiAKLSAgICAgICAgQU1E
X0lPTU1VX0RFQlVHKCJObyBpb21tdSBmb3IgJTA0eDolMDJ4OiUwMnguJXU7IGNhbm5vdCBiZSBo
YW5kZWQgdG8gZCVkXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+c2JkZi5zZWcs
IHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRldiwKLSAgICAgICAgICAgICAgICAgICAgICAg
IHBkZXYtPnNiZGYuZnVuYywgcGRldi0+ZG9tYWluLT5kb21haW5faWQpOworICAgICAgICBBTURf
SU9NTVVfREVCVUcoIk5vIGlvbW11IGZvciAlcHA7IGNhbm5vdCBiZSBoYW5kZWQgdG8gZCVkXG4i
LAorICAgICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHBkZXYtPmRvbWFpbi0+ZG9t
YWluX2lkKTsKICAgICAgICAgcmV0dXJuIC1FTk9ERVY7CiAgICAgfQogCkBAIC00NTcsOSArNDUz
LDggQEAgc3RhdGljIGludCBhbWRfaW9tbXVfcmVtb3ZlX2RldmljZSh1OCBkZXZmbiwgc3RydWN0
IHBjaV9kZXYgKnBkZXYpCiAgICAgaWYgKCAhaW9tbXUgKQogICAgIHsKICAgICAgICAgQU1EX0lP
TU1VX0RFQlVHKCJGYWlsIHRvIGZpbmQgaW9tbXUuIgotICAgICAgICAgICAgICAgICAgICAgICAg
IiAlMDR4OiUwMng6JTAyeC4ldSBjYW5ub3QgYmUgcmVtb3ZlZCBmcm9tIGRvbSVkXG4iLAotICAg
ICAgICAgICAgICAgICAgICAgICAgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2
LT5zYmRmLmRldiwKLSAgICAgICAgICAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuZnVuYywgcGRl
di0+ZG9tYWluLT5kb21haW5faWQpOworICAgICAgICAgICAgICAgICAgICAgICAgIiAlcHAgY2Fu
bm90IGJlIHJlbW92ZWQgZnJvbSBkb20lZFxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICZw
ZGV2LT5zYmRmLCBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCk7CiAgICAgICAgIHJldHVybiAtRU5P
REVWOwogICAgIH0KIApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwppbmRleCA5NGZiM2ExODNkLi5hOTY2N2Nh
MjFjIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYworKysgYi94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwpAQCAtMjM4LDEwICsyMzgsNiBAQCBzdGF0aWMgdm9p
ZCBjaGVja19wZGV2KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgIChQQ0lfU1RBVFVT
X1BBUklUWSB8IFBDSV9TVEFUVVNfU0lHX1RBUkdFVF9BQk9SVCB8IFwKICAgICAgUENJX1NUQVRV
U19SRUNfVEFSR0VUX0FCT1JUIHwgUENJX1NUQVRVU19SRUNfTUFTVEVSX0FCT1JUIHwgXAogICAg
ICBQQ0lfU1RBVFVTX1NJR19TWVNURU1fRVJST1IgfCBQQ0lfU1RBVFVTX0RFVEVDVEVEX1BBUklU
WSkKLSAgICB1aW50MTZfdCBzZWcgPSBwZGV2LT5zYmRmLnNlZzsKLSAgICB1aW50OF90IGJ1cyA9
IHBkZXYtPnNiZGYuYnVzOwotICAgIHVpbnQ4X3QgZGV2ID0gcGRldi0+c2JkZi5kZXY7Ci0gICAg
dWludDhfdCBmdW5jID0gcGRldi0+c2JkZi5mdW5jOwogICAgIHUxNiB2YWw7CiAKICAgICBpZiAo
IGNvbW1hbmRfbWFzayApCkBAIC0yNTIsOCArMjQ4LDggQEAgc3RhdGljIHZvaWQgY2hlY2tfcGRl
dihjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAgICAgdmFsID0gcGNpX2NvbmZfcmVh
ZDE2KHBkZXYtPnNiZGYsIFBDSV9TVEFUVVMpOwogICAgICAgICBpZiAoIHZhbCAmIFBDSV9TVEFU
VVNfQ0hFQ0sgKQogICAgICAgICB7Ci0gICAgICAgICAgICBwcmludGsoWEVOTE9HX0lORk8gIiUw
NHg6JTAyeDolMDJ4LiV1IHN0YXR1cyAlMDR4IC0+ICUwNHhcbiIsCi0gICAgICAgICAgICAgICAg
ICAgc2VnLCBidXMsIGRldiwgZnVuYywgdmFsLCB2YWwgJiB+UENJX1NUQVRVU19DSEVDSyk7Cisg
ICAgICAgICAgICBwcmludGsoWEVOTE9HX0lORk8gIiVwcCBzdGF0dXMgJTA0eCAtPiAlMDR4XG4i
LAorICAgICAgICAgICAgICAgICAgICZwZGV2LT5zYmRmLCB2YWwsIHZhbCAmIH5QQ0lfU1RBVFVT
X0NIRUNLKTsKICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgUENJX1NU
QVRVUywgdmFsICYgUENJX1NUQVRVU19DSEVDSyk7CiAgICAgICAgIH0KICAgICB9CkBAIC0yNzAs
OSArMjY2LDggQEAgc3RhdGljIHZvaWQgY2hlY2tfcGRldihjb25zdCBzdHJ1Y3QgcGNpX2RldiAq
cGRldikKICAgICAgICAgdmFsID0gcGNpX2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9TRUNf
U1RBVFVTKTsKICAgICAgICAgaWYgKCB2YWwgJiBQQ0lfU1RBVFVTX0NIRUNLICkKICAgICAgICAg
ewotICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19JTkZPCi0gICAgICAgICAgICAgICAgICAgIiUw
NHg6JTAyeDolMDJ4LiV1IHNlY29uZGFyeSBzdGF0dXMgJTA0eCAtPiAlMDR4XG4iLAotICAgICAg
ICAgICAgICAgICAgIHNlZywgYnVzLCBkZXYsIGZ1bmMsIHZhbCwgdmFsICYgflBDSV9TVEFUVVNf
Q0hFQ0spOworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19JTkZPICIlcHAgc2Vjb25kYXJ5IHN0
YXR1cyAlMDR4IC0+ICUwNHhcbiIsCisgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHZh
bCwgdmFsICYgflBDSV9TVEFUVVNfQ0hFQ0spOwogICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUx
NihwZGV2LT5zYmRmLCBQQ0lfU0VDX1NUQVRVUywKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdmFsICYgUENJX1NUQVRVU19DSEVDSyk7CiAgICAgICAgIH0KQEAgLTQwOSw4ICs0MDQsOCBA
QCBzdGF0aWMgc3RydWN0IHBjaV9kZXYgKmFsbG9jX3BkZXYoc3RydWN0IHBjaV9zZWcgKnBzZWcs
IHU4IGJ1cywgdTggZGV2Zm4pCiAgICAgICAgICAgICBicmVhazsKIAogICAgICAgICBkZWZhdWx0
OgotICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HICIlMDR4OiUwMng6JTAyeC4ldTog
dW5rbm93biB0eXBlICVkXG4iLAotICAgICAgICAgICAgICAgICAgIHBzZWctPm5yLCBidXMsIFBD
SV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLCBwZGV2LT50eXBlKTsKKyAgICAgICAgICAg
IHByaW50ayhYRU5MT0dfV0FSTklORyAiJXBwOiB1bmtub3duIHR5cGUgJWRcbiIsCisgICAgICAg
ICAgICAgICAgICAgJnBkZXYtPnNiZGYsIHBkZXYtPnR5cGUpOwogICAgICAgICAgICAgYnJlYWs7
CiAgICAgfQogCkBAIC02NDIsOSArNjM3LDkgQEAgdW5zaWduZWQgaW50IHBjaV9zaXplX21lbV9i
YXIocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcG9zLAogICAgICAgICBpZiAoIGZsYWdz
ICYgUENJX0JBUl9MQVNUICkKICAgICAgICAgewogICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19X
QVJOSU5HCi0gICAgICAgICAgICAgICAgICAgIiVzZGV2aWNlICUwNHg6JTAyeDolMDJ4LiV1IHdp
dGggNjQtYml0ICVzQkFSIGluIGxhc3Qgc2xvdFxuIiwKLSAgICAgICAgICAgICAgICAgICAoZmxh
Z3MgJiBQQ0lfQkFSX1ZGKSA/ICJTUi1JT1YgIiA6ICIiLCBzYmRmLnNlZywgc2JkZi5idXMsCi0g
ICAgICAgICAgICAgICAgICAgc2JkZi5kZXYsIHNiZGYuZnVuYywgKGZsYWdzICYgUENJX0JBUl9W
RikgPyAidmYgIiA6ICIiKTsKKyAgICAgICAgICAgICAgICAgICAiJXNkZXZpY2UgJXBwIHdpdGgg
NjQtYml0ICVzQkFSIGluIGxhc3Qgc2xvdFxuIiwKKyAgICAgICAgICAgICAgICAgICAoZmxhZ3Mg
JiBQQ0lfQkFSX1ZGKSA/ICJTUi1JT1YgIiA6ICIiLCAmc2JkZiwKKyAgICAgICAgICAgICAgICAg
ICAoZmxhZ3MgJiBQQ0lfQkFSX1ZGKSA/ICJ2ZiAiIDogIiIpOwogICAgICAgICAgICAgKnBzaXpl
ID0gMDsKICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICB9CkBAIC02NzQsNyArNjY5LDcg
QEAgaW50IHBjaV9hZGRfZGV2aWNlKHUxNiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4sCiB7CiAgICAg
c3RydWN0IHBjaV9zZWcgKnBzZWc7CiAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXY7Ci0gICAgdW5z
aWduZWQgaW50IHNsb3QgPSBQQ0lfU0xPVChkZXZmbiksIGZ1bmMgPSBQQ0lfRlVOQyhkZXZmbik7
CisgICAgdW5zaWduZWQgaW50IGZ1bmMgPSBQQ0lfRlVOQyhkZXZmbik7CiAgICAgY29uc3QgY2hh
ciAqcGRldl90eXBlOwogICAgIGludCByZXQ7CiAgICAgYm9vbCBwZl9pc19leHRmbiA9IGZhbHNl
OwpAQCAtNzQ3LDkgKzc0Miw4IEBAIGludCBwY2lfYWRkX2RldmljZSh1MTYgc2VnLCB1OCBidXMs
IHU4IGRldmZuLAogICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU19TUEFDRV9J
TyApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9H
X1dBUk5JTkcKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICJTUi1JT1YgZGV2aWNlICUwNHg6
JTAyeDolMDJ4LiV1IHdpdGggdmYgQkFSJXUiCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAi
IGluIElPIHNwYWNlXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIHNs
b3QsIGZ1bmMsIGkpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNSLUlPViBkZXZpY2Ug
JXBwIHdpdGggdmYgQkFSJXUgaW4gSU8gc3BhY2VcbiIsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAmcGRldi0+c2JkZiwgaSk7CiAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICByZXQgPSBwY2lfc2l6ZV9tZW1fYmFyKHBk
ZXYtPnNiZGYsIGlkeCwgTlVMTCwgJnBkZXYtPnZmX3JsZW5baV0sCkBAIC03NjIsOSArNzU2LDkg
QEAgaW50IHBjaV9hZGRfZGV2aWNlKHUxNiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4sCiAgICAgICAg
IH0KICAgICAgICAgZWxzZQogICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HCi0gICAg
ICAgICAgICAgICAgICAgIlNSLUlPViBkZXZpY2UgJTA0eDolMDJ4OiUwMnguJXUgaGFzIGl0cyB2
aXJ0dWFsIgorICAgICAgICAgICAgICAgICAgICJTUi1JT1YgZGV2aWNlICVwcCBoYXMgaXRzIHZp
cnR1YWwiCiAgICAgICAgICAgICAgICAgICAgIiBmdW5jdGlvbnMgYWxyZWFkeSBlbmFibGVkICgl
MDR4KVxuIiwKLSAgICAgICAgICAgICAgICAgICBzZWcsIGJ1cywgc2xvdCwgZnVuYywgY3RybCk7
CisgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIGN0cmwpOwogICAgIH0KIAogICAgIGNo
ZWNrX3BkZXYocGRldik7CkBAIC03OTEsMTUgKzc4NSwxMyBAQCBvdXQ6CiAgICAgcGNpZGV2c191
bmxvY2soKTsKICAgICBpZiAoICFyZXQgKQogICAgIHsKLSAgICAgICAgcHJpbnRrKFhFTkxPR19E
RUJVRyAiUENJIGFkZCAlcyAlMDR4OiUwMng6JTAyeC4ldVxuIiwgcGRldl90eXBlLAotICAgICAg
ICAgICAgICAgc2VnLCBidXMsIHNsb3QsIGZ1bmMpOworICAgICAgICBwcmludGsoWEVOTE9HX0RF
QlVHICJQQ0kgYWRkICVzICVwcFxuIiwgcGRldl90eXBlLCAmcGRldi0+c2JkZik7CiAgICAgICAg
IHdoaWxlICggcGRldi0+cGhhbnRvbV9zdHJpZGUgKQogICAgICAgICB7CiAgICAgICAgICAgICBm
dW5jICs9IHBkZXYtPnBoYW50b21fc3RyaWRlOwogICAgICAgICAgICAgaWYgKCBQQ0lfU0xPVChm
dW5jKSApCiAgICAgICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgICAgICBwcmludGsoWEVOTE9H
X0RFQlVHICJQQ0kgcGhhbnRvbSAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAg
ICAgICBzZWcsIGJ1cywgc2xvdCwgZnVuYyk7CisgICAgICAgICAgICBwcmludGsoWEVOTE9HX0RF
QlVHICJQQ0kgcGhhbnRvbSAlcHBcbiIsICZwZGV2LT5zYmRmKTsKICAgICAgICAgfQogICAgIH0K
ICAgICByZXR1cm4gcmV0OwpAQCAtODI5LDggKzgyMSw4IEBAIGludCBwY2lfcmVtb3ZlX2Rldmlj
ZSh1MTYgc2VnLCB1OCBidXMsIHU4IGRldmZuKQogICAgICAgICAgICAgICAgIGxpc3RfZGVsKCZw
ZGV2LT5kb21haW5fbGlzdCk7CiAgICAgICAgICAgICBwY2lfY2xlYW51cF9tc2kocGRldik7CiAg
ICAgICAgICAgICBmcmVlX3BkZXYocHNlZywgcGRldik7Ci0gICAgICAgICAgICBwcmludGsoWEVO
TE9HX0RFQlVHICJQQ0kgcmVtb3ZlIGRldmljZSAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAg
ICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbikp
OworICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19ERUJVRyAiUENJIHJlbW92ZSBkZXZpY2UgJXBw
XG4iLAorICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERjNfVChzZWcsIGJ1cywgZGV2Zm4pKTsK
ICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAKQEAgLTg4OSw3ICs4ODEsNiBAQCBzdGF0
aWMgaW50IHBjaV9jbGVhbl9kcGNpX2lycXMoc3RydWN0IGRvbWFpbiAqZCkKIGludCBwY2lfcmVs
ZWFzZV9kZXZpY2VzKHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAgc3RydWN0IHBjaV9kZXYgKnBk
ZXY7Ci0gICAgdTggYnVzLCBkZXZmbjsKICAgICBpbnQgcmV0OwogCiAgICAgcGNpZGV2c19sb2Nr
KCk7CkBAIC05MDAsMTQgKzg5MSwxMCBAQCBpbnQgcGNpX3JlbGVhc2VfZGV2aWNlcyhzdHJ1Y3Qg
ZG9tYWluICpkKQogICAgICAgICByZXR1cm4gcmV0OwogICAgIH0KICAgICB3aGlsZSAoIChwZGV2
ID0gcGNpX2dldF9wZGV2X2J5X2RvbWFpbihkLCAtMSwgLTEsIC0xKSkgKQotICAgIHsKLSAgICAg
ICAgYnVzID0gcGRldi0+c2JkZi5idXM7Ci0gICAgICAgIGRldmZuID0gcGRldi0+c2JkZi5leHRm
dW5jOwotICAgICAgICBpZiAoIGRlYXNzaWduX2RldmljZShkLCBwZGV2LT5zYmRmLnNlZywgYnVz
LCBkZXZmbikgKQotICAgICAgICAgICAgcHJpbnRrKCJkb21haW4gJWQ6IGRlYXNzaWduIGRldmlj
ZSAoJTA0eDolMDJ4OiUwMnguJXUpIGZhaWxlZCFcbiIsCi0gICAgICAgICAgICAgICAgICAgZC0+
ZG9tYWluX2lkLCBwZGV2LT5zYmRmLnNlZywgYnVzLAotICAgICAgICAgICAgICAgICAgIFBDSV9T
TE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKLSAgICB9CisgICAgICAgIGlmICggZGVhc3Np
Z25fZGV2aWNlKGQsIHBkZXYtPnNiZGYuc2VnLCBwZGV2LT5zYmRmLmJ1cywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcGRldi0+c2JkZi5leHRmdW5jKSApCisgICAgICAgICAgICBwcmlu
dGsoImRvbWFpbiAlZDogZGVhc3NpZ24gZGV2aWNlICglcHApIGZhaWxlZCFcbiIsCisgICAgICAg
ICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCAmcGRldi0+c2JkZik7CiAgICAgcGNpZGV2c191bmxv
Y2soKTsKIAogICAgIHJldHVybiAwOwpAQCAtMTA1OSw4ICsxMDQ2LDggQEAgc3RhdGljIGludCBf
X2luaXQgX3NjYW5fcGNpX2RldmljZXMoc3RydWN0IHBjaV9zZWcgKnBzZWcsIHZvaWQgKmFyZykK
ICAgICAgICAgICAgICAgICBwZGV2ID0gYWxsb2NfcGRldihwc2VnLCBidXMsIFBDSV9ERVZGTihk
ZXYsIGZ1bmMpKTsKICAgICAgICAgICAgICAgICBpZiAoICFwZGV2ICkKICAgICAgICAgICAgICAg
ICB7Ci0gICAgICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyAiJTA0eDolMDJ4
OiUwMnguJXU6IGFsbG9jX3BkZXYgZmFpbGVkXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcHNlZy0+bnIsIGJ1cywgZGV2LCBmdW5jKTsKKyAgICAgICAgICAgICAgICAgICAgcHJpbnRr
KFhFTkxPR19XQVJOSU5HICIlcHA6IGFsbG9jX3BkZXYgZmFpbGVkXG4iLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJlBDSV9TQkRGX1QocHNlZy0+bnIsIGJ1cywgZGV2LCBmdW5jKSk7CiAg
ICAgICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwogICAgICAgICAgICAgICAgIH0KIApA
QCAtMTEwMCw5ICsxMDg3LDggQEAgc3RhdGljIHZvaWQgX19od2RvbV9pbml0IHNldHVwX29uZV9o
d2RvbV9kZXZpY2UoY29uc3Qgc3RydWN0IHNldHVwX2h3ZG9tICpjdHh0LAogICAgICAgICBlcnIg
PSBjdHh0LT5oYW5kbGVyKGRldmZuLCBwZGV2KTsKICAgICAgICAgaWYgKCBlcnIgKQogICAgICAg
ICB7Ci0gICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAic2V0dXAgJTA0eDolMDJ4OiUwMngu
JXUgZm9yIGQlZCBmYWlsZWQgKCVkKVxuIiwKLSAgICAgICAgICAgICAgICAgICBwZGV2LT5zYmRm
LnNlZywgcGRldi0+c2JkZi5idXMsIHBkZXYtPnNiZGYuZGV2LAotICAgICAgICAgICAgICAgICAg
IHBkZXYtPnNiZGYuZnVuYywgY3R4dC0+ZC0+ZG9tYWluX2lkLCBlcnIpOworICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19FUlIgInNldHVwICVwcCBmb3IgZCVkIGZhaWxlZCAoJWQpXG4iLAorICAg
ICAgICAgICAgICAgICAgICZwZGV2LT5zYmRmLCBjdHh0LT5kLT5kb21haW5faWQsIGVycik7CiAg
ICAgICAgICAgICBpZiAoIGRldmZuID09IHBkZXYtPnNiZGYuZXh0ZnVuYyApCiAgICAgICAgICAg
ICAgICAgcmV0dXJuOwogICAgICAgICB9CkBAIC0xMTQzLDkgKzExMjksOCBAQCBzdGF0aWMgaW50
IF9faHdkb21faW5pdCBfc2V0dXBfaHdkb21fcGNpX2RldmljZXMoc3RydWN0IHBjaV9zZWcgKnBz
ZWcsIHZvaWQgKmFyZwogICAgICAgICAgICAgICAgIHBkZXYtPmRvbWFpbiA9IGRvbV94ZW47CiAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggcGRldi0+ZG9tYWluICE9IGN0eHQt
PmQgKQotICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyAiRG9tJWQgb3duaW5n
ICUwNHg6JTAyeDolMDJ4LiV1P1xuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+ZG9t
YWluLT5kb21haW5faWQsIHBzZWctPm5yLCBidXMsCi0gICAgICAgICAgICAgICAgICAgICAgIFBD
SV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgICAgICAgICBwcmludGso
WEVOTE9HX1dBUk5JTkcgIkRvbSVkIG93bmluZyAlcHA/XG4iLAorICAgICAgICAgICAgICAgICAg
ICAgICBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCwgJnBkZXYtPnNiZGYpOwogCiAgICAgICAgICAg
ICBpZiAoIGlvbW11X3ZlcmJvc2UgKQogICAgICAgICAgICAgewpAQCAtMTI4MCw4ICsxMjY1LDgg
QEAgc3RhdGljIGludCBfZHVtcF9wY2lfZGV2aWNlcyhzdHJ1Y3QgcGNpX3NlZyAqcHNlZywgdm9p
ZCAqYXJnKQogCiAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeSAoIHBkZXYsICZwc2VnLT5hbGxkZXZz
X2xpc3QsIGFsbGRldnNfbGlzdCApCiAgICAgewotICAgICAgICBwcmludGsoIiUwNHg6JTAyeDol
MDJ4LiV1IC0gZG9tICUtM2QgLSBub2RlICUtM2QgLSBNU0lzIDwgIiwKLSAgICAgICAgICAgICAg
IHBzZWctPm5yLCBwZGV2LT5zYmRmLmJ1cywgcGRldi0+c2JkZi5kZXYsIHBkZXYtPnNiZGYuZnVu
YywKKyAgICAgICAgcHJpbnRrKCIlcHAgLSBkb20gJS0zZCAtIG5vZGUgJS0zZCAtIE1TSXMgPCAi
LAorICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsCiAgICAgICAgICAgICAgICBwZGV2LT5kb21h
aW4gPyBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCA6IC0xLAogICAgICAgICAgICAgICAgKHBkZXYt
Pm5vZGUgIT0gTlVNQV9OT19OT0RFKSA/IHBkZXYtPm5vZGUgOiAtMSk7CiAgICAgICAgIGxpc3Rf
Zm9yX2VhY2hfZW50cnkgKCBtc2ksICZwZGV2LT5tc2lfbGlzdCwgbGlzdCApCkBAIC0xMzQ3LDkg
KzEzMzIsOCBAQCBzdGF0aWMgaW50IGlvbW11X2FkZF9kZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBk
ZXYpCiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgcmMgPSBoZC0+cGxhdGZvcm1fb3Bz
LT5hZGRfZGV2aWNlKGRldmZuLCBwY2lfdG9fZGV2KHBkZXYpKTsKICAgICAgICAgaWYgKCByYyAp
Ci0gICAgICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgIklPTU1VOiBhZGQgJTA0eDolMDJ4
OiUwMnguJXUgZmFpbGVkICglZClcbiIsCi0gICAgICAgICAgICAgICAgICAgcGRldi0+c2JkZi5z
ZWcsIHBkZXYtPnNiZGYuYnVzLCBQQ0lfU0xPVChkZXZmbiksCi0gICAgICAgICAgICAgICAgICAg
UENJX0ZVTkMoZGV2Zm4pLCByYyk7CisgICAgICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcg
IklPTU1VOiBhZGQgJXBwIGZhaWxlZCAoJWQpXG4iLAorICAgICAgICAgICAgICAgICAgICZwZGV2
LT5zYmRmLCByYyk7CiAgICAgfQogfQogCkBAIC0xMzkzLDkgKzEzNzcsOCBAQCBzdGF0aWMgaW50
IGlvbW11X3JlbW92ZV9kZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgIGlmICgg
IXJjICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgIHByaW50ayhYRU5MT0dfRVJS
ICJJT01NVTogcmVtb3ZlICUwNHg6JTAyeDolMDJ4LiV1IGZhaWxlZCAoJWQpXG4iLAotICAgICAg
ICAgICAgICAgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBQQ0lfU0xPVChkZXZmbiks
IFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAgICAgICAgIHJjKTsKKyAgICAgICAgcHJpbnRrKFhF
TkxPR19FUlIgIklPTU1VOiByZW1vdmUgJXBwIGZhaWxlZCAoJWQpXG4iLAorICAgICAgICAgICAg
ICAgJnBkZXYtPnNiZGYsIHJjKTsKICAgICAgICAgcmV0dXJuIHJjOwogICAgIH0KIApAQCAtMTQ2
NSw5ICsxNDQ4LDggQEAgc3RhdGljIGludCBhc3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4gKmQs
IHUxNiBzZWcsIHU4IGJ1cywgdTggZGV2Zm4sIHUzMiBmbGFnKQogICAgICAgICAgICAgYnJlYWs7
CiAgICAgICAgIHJjID0gaGQtPnBsYXRmb3JtX29wcy0+YXNzaWduX2RldmljZShkLCBkZXZmbiwg
cGNpX3RvX2RldihwZGV2KSwgZmxhZyk7CiAgICAgICAgIGlmICggcmMgKQotICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19HX1dBUk5JTkcgImQlZDogYXNzaWduICUwNHg6JTAyeDolMDJ4LiV1IGZh
aWxlZCAoJWQpXG4iLAotICAgICAgICAgICAgICAgICAgIGQtPmRvbWFpbl9pZCwgc2VnLCBidXMs
IFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLAotICAgICAgICAgICAgICAgICAgIHJj
KTsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfR19XQVJOSU5HICJkJWQ6IGFzc2lnbiAlcHAg
ZmFpbGVkICglZClcbiIsCisgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCAmUENJX1NC
REYzX1Qoc2VnLCBidXMsIGRldmZuKSwgcmMpOwogICAgIH0KIAogIGRvbmU6CkBAIC0xNTAzLDgg
KzE0ODUsOCBAQCBpbnQgZGVhc3NpZ25fZGV2aWNlKHN0cnVjdCBkb21haW4gKmQsIHUxNiBzZWcs
IHU4IGJ1cywgdTggZGV2Zm4pCiAgICAgICAgIGlmICggIXJldCApCiAgICAgICAgICAgICBjb250
aW51ZTsKIAotICAgICAgICBwcmludGsoWEVOTE9HX0dfRVJSICJkJWQ6IGRlYXNzaWduICUwNHg6
JTAyeDolMDJ4LiV1IGZhaWxlZCAoJWQpXG4iLAotICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lk
LCBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbiksIHJldCk7CisgICAg
ICAgIHByaW50ayhYRU5MT0dfR19FUlIgImQlZDogZGVhc3NpZ24gJXBwIGZhaWxlZCAoJWQpXG4i
LAorICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCAmUENJX1NCREYzX1Qoc2VnLCBidXMsIGRl
dmZuKSwgcmV0KTsKICAgICAgICAgcmV0dXJuIHJldDsKICAgICB9CiAKQEAgLTE1MTMsOSArMTQ5
NSw4IEBAIGludCBkZWFzc2lnbl9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgdTE2IHNlZywgdTgg
YnVzLCB1OCBkZXZmbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGNpX3RvX2RldihwZGV2KSk7CiAgICAgaWYgKCByZXQgKQogICAgIHsKLSAgICAgICAgZHBy
aW50ayhYRU5MT0dfR19FUlIsCi0gICAgICAgICAgICAgICAgImQlZDogZGVhc3NpZ24gZGV2aWNl
ICglMDR4OiUwMng6JTAyeC4ldSkgZmFpbGVkXG4iLAotICAgICAgICAgICAgICAgIGQtPmRvbWFp
bl9pZCwgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAg
ICAgZHByaW50ayhYRU5MT0dfR19FUlIsICJkJWQ6IGRlYXNzaWduIGRldmljZSAoJXBwKSBmYWls
ZWRcbiIsCisgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLCAmUENJX1NCREYzX1Qoc2VnLCBi
dXMsIGRldmZuKSk7CiAgICAgICAgIHJldHVybiByZXQ7CiAgICAgfQogCkBAIC0xNTkwLDEwICsx
NTcxLDggQEAgdm9pZCBpb21tdV9kZXZfaW90bGJfZmx1c2hfdGltZW91dChzdHJ1Y3QgZG9tYWlu
ICpkLCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICBfcGNpX2hpZGVfZGV2aWNlKHBkZXYpOwog
CiAgICAgaWYgKCAhZC0+aXNfc2h1dHRpbmdfZG93biAmJiBwcmludGtfcmF0ZWxpbWl0KCkgKQot
ICAgICAgICBwcmludGsoWEVOTE9HX0VSUgotICAgICAgICAgICAgICAgImRvbSVkOiBBVFMgZGV2
aWNlICUwNHg6JTAyeDolMDJ4LiV1IGZsdXNoIGZhaWxlZFxuIiwKLSAgICAgICAgICAgICAgIGQt
PmRvbWFpbl9pZCwgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRl
diwKLSAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuZnVuYyk7CisgICAgICAgIHByaW50ayhYRU5M
T0dfRVJSICJkb20lZDogQVRTIGRldmljZSAlcHAgZmx1c2ggZmFpbGVkXG4iLAorICAgICAgICAg
ICAgICAgZC0+ZG9tYWluX2lkLCAmcGRldi0+c2JkZik7CiAgICAgaWYgKCAhaXNfaGFyZHdhcmVf
ZG9tYWluKGQpICkKICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwogCkBAIC0xNjgyLDkgKzE2NjEs
OCBAQCBpbnQgaW9tbXVfZG9fcGNpX2RvbWN0bCgKICAgICAgICAgewogICAgICAgICAgICAgaWYg
KCByZXQgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfR19J
TkZPCi0gICAgICAgICAgICAgICAgICAgICAgICIlMDR4OiUwMng6JTAyeC4ldSBhbHJlYWR5IGFz
c2lnbmVkLCBvciBub24tZXhpc3RlbnRcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgIHNlZywg
YnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19HX0lORk8gIiVwcCBhbHJlYWR5IGFzc2lnbmVkLCBvciBub24tZXhpc3Rl
bnRcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERjNfVChzZWcsIGJ1cywgZGV2
Zm4pKTsKICAgICAgICAgICAgICAgICByZXQgPSAtRUlOVkFMOwogICAgICAgICAgICAgfQogICAg
ICAgICAgICAgYnJlYWs7CkBAIC0xNjk2LDkgKzE2NzQsOCBAQCBpbnQgaW9tbXVfZG9fcGNpX2Rv
bWN0bCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJo
IiwgdV9kb21jdGwpOwogICAgICAgICBlbHNlIGlmICggcmV0ICkKICAgICAgICAgICAgIHByaW50
ayhYRU5MT0dfR19FUlIgIlhFTl9ET01DVExfYXNzaWduX2RldmljZTogIgotICAgICAgICAgICAg
ICAgICAgICJhc3NpZ24gJTA0eDolMDJ4OiUwMnguJXUgdG8gZG9tJWQgZmFpbGVkICglZClcbiIs
Ci0gICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMo
ZGV2Zm4pLAotICAgICAgICAgICAgICAgICAgIGQtPmRvbWFpbl9pZCwgcmV0KTsKKyAgICAgICAg
ICAgICAgICAgICAiYXNzaWduICVwcCB0byBkb20lZCBmYWlsZWQgKCVkKVxuIiwKKyAgICAgICAg
ICAgICAgICAgICAmUENJX1NCREYzX1Qoc2VnLCBidXMsIGRldmZuKSwgZC0+ZG9tYWluX2lkLCBy
ZXQpOwogCiAgICAgICAgIGJyZWFrOwogCkBAIC0xNzMyLDEwICsxNzA5LDggQEAgaW50IGlvbW11
X2RvX3BjaV9kb21jdGwoCiAgICAgICAgIHJldCA9IGRlYXNzaWduX2RldmljZShkLCBzZWcsIGJ1
cywgZGV2Zm4pOwogICAgICAgICBwY2lkZXZzX3VubG9jaygpOwogICAgICAgICBpZiAoIHJldCAp
Ci0gICAgICAgICAgICBwcmludGsoWEVOTE9HX0dfRVJSCi0gICAgICAgICAgICAgICAgICAgImRl
YXNzaWduICUwNHg6JTAyeDolMDJ4LiV1IGZyb20gZG9tJWQgZmFpbGVkICglZClcbiIsCi0gICAg
ICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4p
LAotICAgICAgICAgICAgICAgICAgIGQtPmRvbWFpbl9pZCwgcmV0KTsKKyAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfR19FUlIgImRlYXNzaWduICVwcCBmcm9tIGRvbSVkIGZhaWxlZCAoJWQpXG4i
LAorICAgICAgICAgICAgICAgICAgICZQQ0lfU0JERjNfVChzZWcsIGJ1cywgZGV2Zm4pLCBkLT5k
b21haW5faWQsIHJldCk7CiAKICAgICAgICAgYnJlYWs7CiAKZGlmZiAtLWdpdCBhL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
ZG1hci5jCmluZGV4IDlkMzAxODhhYjkuLjkxMTQ5NDc1MmYgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
dnRkL2RtYXIuYwpAQCAtMzY3LDE4ICszNjcsMTYgQEAgc3RhdGljIGludCBfX2luaXQgYWNwaV9w
YXJzZV9kZXZfc2NvcGUoCiAgICAgICAgICAgICBzZWNfYnVzID0gcGNpX2NvbmZfcmVhZDgoc2Jk
ZiwgUENJX1NFQ09OREFSWV9CVVMpOwogICAgICAgICAgICAgc3ViX2J1cyA9IHBjaV9jb25mX3Jl
YWQ4KHNiZGYsIFBDSV9TVUJPUkRJTkFURV9CVVMpOwogICAgICAgICAgICAgaWYgKCBpb21tdV92
ZXJib3NlICkKLSAgICAgICAgICAgICAgICBwcmludGsoVlREUFJFRklYCi0gICAgICAgICAgICAg
ICAgICAgICAgICIgYnJpZGdlOiAlMDR4OiUwMng6JTAyeC4ldSBzdGFydD0leCBzZWM9JXggc3Vi
PSV4XG4iLAotICAgICAgICAgICAgICAgICAgICAgICBzZWcsIGJ1cywgcGF0aC0+ZGV2LCBwYXRo
LT5mbiwKLSAgICAgICAgICAgICAgICAgICAgICAgYWNwaV9zY29wZS0+YnVzLCBzZWNfYnVzLCBz
dWJfYnVzKTsKKyAgICAgICAgICAgICAgICBwcmludGsoVlREUFJFRklYICIgYnJpZGdlOiAlcHAg
c3RhcnQ9JXggc2VjPSV4IHN1Yj0leFxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgJnNiZGYs
IGFjcGlfc2NvcGUtPmJ1cywgc2VjX2J1cywgc3ViX2J1cyk7CiAKICAgICAgICAgICAgIGRtYXJf
c2NvcGVfYWRkX2J1c2VzKHNjb3BlLCBzZWNfYnVzLCBzdWJfYnVzKTsKICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICB9CiAgICAgICAgIGNhc2UgQUNQSV9ETUFSX1NDT1BFX1RZUEVfSFBFVDoK
ICAgICAgICAgICAgIGlmICggaW9tbXVfdmVyYm9zZSApCi0gICAgICAgICAgICAgICAgcHJpbnRr
KFZURFBSRUZJWCAiIE1TSSBIUEVUOiAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAg
ICAgICAgICAgICAgc2VnLCBidXMsIHBhdGgtPmRldiwgcGF0aC0+Zm4pOworICAgICAgICAgICAg
ICAgIHByaW50ayhWVERQUkVGSVggIiBNU0kgSFBFVDogJXBwXG4iLAorICAgICAgICAgICAgICAg
ICAgICAgICAmUENJX1NCREZfVChzZWcsIGJ1cywgcGF0aC0+ZGV2LCBwYXRoLT5mbikpOwogCiAg
ICAgICAgICAgICBpZiAoIGRyaGQgKQogICAgICAgICAgICAgewpAQCAtMzk5LDggKzM5Nyw4IEBA
IHN0YXRpYyBpbnQgX19pbml0IGFjcGlfcGFyc2VfZGV2X3Njb3BlKAogCiAgICAgICAgIGNhc2Ug
QUNQSV9ETUFSX1NDT1BFX1RZUEVfRU5EUE9JTlQ6CiAgICAgICAgICAgICBpZiAoIGlvbW11X3Zl
cmJvc2UgKQotICAgICAgICAgICAgICAgIHByaW50ayhWVERQUkVGSVggIiBlbmRwb2ludDogJTA0
eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBwYXRo
LT5kZXYsIHBhdGgtPmZuKTsKKyAgICAgICAgICAgICAgICBwcmludGsoVlREUFJFRklYICIgZW5k
cG9pbnQ6ICVwcFxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGX1Qoc2VnLCBi
dXMsIHBhdGgtPmRldiwgcGF0aC0+Zm4pKTsKIAogICAgICAgICAgICAgaWYgKCBkcmhkICkKICAg
ICAgICAgICAgIHsKQEAgLTQxMyw4ICs0MTEsOCBAQCBzdGF0aWMgaW50IF9faW5pdCBhY3BpX3Bh
cnNlX2Rldl9zY29wZSgKIAogICAgICAgICBjYXNlIEFDUElfRE1BUl9TQ09QRV9UWVBFX0lPQVBJ
QzoKICAgICAgICAgICAgIGlmICggaW9tbXVfdmVyYm9zZSApCi0gICAgICAgICAgICAgICAgcHJp
bnRrKFZURFBSRUZJWCAiIElPQVBJQzogJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAg
ICAgICAgICAgICAgIHNlZywgYnVzLCBwYXRoLT5kZXYsIHBhdGgtPmZuKTsKKyAgICAgICAgICAg
ICAgICBwcmludGsoVlREUFJFRklYICIgSU9BUElDOiAlcHBcbiIsCisgICAgICAgICAgICAgICAg
ICAgICAgICZQQ0lfU0JERl9UKHNlZywgYnVzLCBwYXRoLT5kZXYsIHBhdGgtPmZuKSk7CiAKICAg
ICAgICAgICAgIGlmICggZHJoZCApCiAgICAgICAgICAgICB7CkBAIC01NDMsOCArNTQxLDggQEAg
YWNwaV9wYXJzZV9vbmVfZHJoZChzdHJ1Y3QgYWNwaV9kbWFyX2hlYWRlciAqaGVhZGVyKQogCiAg
ICAgICAgICAgICBpZiAoICFwY2lfZGV2aWNlX2RldGVjdChkcmhkLT5zZWdtZW50LCBiLCBkLCBm
KSApCiAgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWAotICAg
ICAgICAgICAgICAgICAgICAgICAiIE5vbi1leGlzdGVudCBkZXZpY2UgKCUwNHg6JTAyeDolMDJ4
LiV1KSBpbiB0aGlzIERSSEQncyBzY29wZSFcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgIGRy
aGQtPnNlZ21lbnQsIGIsIGQsIGYpOworICAgICAgICAgICAgICAgICAgICAgICAiIE5vbi1leGlz
dGVudCBkZXZpY2UgKCVwcCkgaW4gdGhpcyBEUkhEJ3Mgc2NvcGUhXG4iLAorICAgICAgICAgICAg
ICAgICAgICAgICAmUENJX1NCREZfVChkcmhkLT5zZWdtZW50LCBiLCBkLCBmKSk7CiAgICAgICAg
IH0KIAogICAgICAgICBhY3BpX3JlZ2lzdGVyX2RyaGRfdW5pdChkbWFydSk7CkBAIC01ODAsOSAr
NTc4LDkgQEAgc3RhdGljIGludCByZWdpc3Rlcl9vbmVfcm1ycihzdHJ1Y3QgYWNwaV9ybXJyX3Vu
aXQgKnJtcnJ1KQogICAgICAgICBpZiAoIHBjaV9kZXZpY2VfZGV0ZWN0KHJtcnJ1LT5zZWdtZW50
LCBiLCBkLCBmKSA9PSAwICkKICAgICAgICAgewogICAgICAgICAgICAgZHByaW50ayhYRU5MT0df
V0FSTklORyBWVERQUkVGSVgsCi0gICAgICAgICAgICAgICAgICAgICIgTm9uLWV4aXN0ZW50IGRl
dmljZSAoJTA0eDolMDJ4OiUwMnguJXUpIGlzIHJlcG9ydGVkIgorICAgICAgICAgICAgICAgICAg
ICAiIE5vbi1leGlzdGVudCBkZXZpY2UgKCVwcCkgaXMgcmVwb3J0ZWQiCiAgICAgICAgICAgICAg
ICAgICAgICIgaW4gUk1SUiAoJSJQUkl4NjQiLCAlIlBSSXg2NCIpJ3Mgc2NvcGUhXG4iLAotICAg
ICAgICAgICAgICAgICAgICBybXJydS0+c2VnbWVudCwgYiwgZCwgZiwKKyAgICAgICAgICAgICAg
ICAgICAgJlBDSV9TQkRGX1Qocm1ycnUtPnNlZ21lbnQsIGIsIGQsIGYpLAogICAgICAgICAgICAg
ICAgICAgICBybXJydS0+YmFzZV9hZGRyZXNzLCBybXJydS0+ZW5kX2FkZHJlc3MpOwogICAgICAg
ICAgICAgaWdub3JlID0gdHJ1ZTsKICAgICAgICAgfQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL2ludHJlbWFwLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW50cmVtYXAuYwppbmRleCAwZGJmOTk1NTFlLi5iZGYzNzU4NTQ5IDEwMDY0NAotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW50cmVtYXAuYworKysgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC92dGQvaW50cmVtYXAuYwpAQCAtNTI0LDE2ICs1MjQsMTMgQEAgc3RhdGljIHZvaWQg
c2V0X21zaV9zb3VyY2VfaWQoc3RydWN0IHBjaV9kZXYgKnBkZXYsIHN0cnVjdCBpcmVtYXBfZW50
cnkgKmlyZSkKICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAgICAgICBkcHJpbnRrKFhF
TkxPR19XQVJOSU5HIFZURFBSRUZJWCwKLSAgICAgICAgICAgICAgICAgICAgImQlZDogbm8gdXBz
dHJlYW0gYnJpZGdlIGZvciAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgICAg
ICAgcGRldi0+ZG9tYWluLT5kb21haW5faWQsCi0gICAgICAgICAgICAgICAgICAgIHNlZywgYnVz
LCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSk7CisgICAgICAgICAgICAgICAgICAg
ICJkJWQ6IG5vIHVwc3RyZWFtIGJyaWRnZSBmb3IgJXBwXG4iLAorICAgICAgICAgICAgICAgICAg
ICBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCwgJnBkZXYtPnNiZGYpOwogICAgICAgICBicmVhazsK
IAogICAgIGRlZmF1bHQ6Ci0gICAgICAgIGRwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklY
LAotICAgICAgICAgICAgICAgICJkJWQ6IHVua25vd24oJXUpOiAlMDR4OiUwMng6JTAyeC4ldVxu
IiwKLSAgICAgICAgICAgICAgICBwZGV2LT5kb21haW4tPmRvbWFpbl9pZCwgcGRldi0+dHlwZSwK
LSAgICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZm
bikpOworICAgICAgICBkcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWCwgImQlZDogdW5r
bm93bigldSk6ICVwcFxuIiwKKyAgICAgICAgICAgICAgICBwZGV2LT5kb21haW4tPmRvbWFpbl9p
ZCwgcGRldi0+dHlwZSwgJnBkZXYtPnNiZGYpOwogICAgICAgICBicmVhazsKICAgIH0KIH0KZGlm
ZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jIGIveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKaW5kZXggN2I3MDczMjg2My4uMzk0MmRmMDRiNSAx
MDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKQEAgLTg4MiwyNyArODgyLDI0IEBAIHN0
YXRpYyBpbnQgaW9tbXVfcGFnZV9mYXVsdF9kb19vbmUoc3RydWN0IGlvbW11ICppb21tdSwgaW50
IHR5cGUsCiAgICAgewogICAgIGNhc2UgRE1BX1JFTUFQOgogICAgICAgICBwcmludGsoWEVOTE9H
X0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAgICAgICAgICJETUFSOlslc10gUmVxdWVzdCBk
ZXZpY2UgWyUwNHg6JTAyeDolMDJ4LiV1XSAiCisgICAgICAgICAgICAgICAiRE1BUjpbJXNdIFJl
cXVlc3QgZGV2aWNlIFslcHBdICIKICAgICAgICAgICAgICAgICJmYXVsdCBhZGRyICUiUFJJeDY0
IiwgaW9tbXUgcmVnID0gJXBcbiIsCiAgICAgICAgICAgICAgICAodHlwZSA/ICJETUEgUmVhZCIg
OiAiRE1BIFdyaXRlIiksCi0gICAgICAgICAgICAgICBzZWcsIFBDSV9CVVMoc291cmNlX2lkKSwg
UENJX1NMT1Qoc291cmNlX2lkKSwKLSAgICAgICAgICAgICAgIFBDSV9GVU5DKHNvdXJjZV9pZCks
IGFkZHIsIGlvbW11LT5yZWcpOworICAgICAgICAgICAgICAgJlBDSV9TQkRGMl9UKHNlZywgc291
cmNlX2lkKSwgYWRkciwgaW9tbXUtPnJlZyk7CiAgICAgICAgIGtpbmQgPSAiRE1BUiI7CiAgICAg
ICAgIGJyZWFrOwogICAgIGNhc2UgSU5UUl9SRU1BUDoKICAgICAgICAgcHJpbnRrKFhFTkxPR19H
X1dBUk5JTkcgVlREUFJFRklYCi0gICAgICAgICAgICAgICAiSU5UUi1SRU1BUDogUmVxdWVzdCBk
ZXZpY2UgWyUwNHg6JTAyeDolMDJ4LiV1XSAiCisgICAgICAgICAgICAgICAiSU5UUi1SRU1BUDog
UmVxdWVzdCBkZXZpY2UgWyVwcF0gIgogICAgICAgICAgICAgICAgImZhdWx0IGluZGV4ICUiUFJJ
eDY0IiwgaW9tbXUgcmVnID0gJXBcbiIsCi0gICAgICAgICAgICAgICBzZWcsIFBDSV9CVVMoc291
cmNlX2lkKSwgUENJX1NMT1Qoc291cmNlX2lkKSwKLSAgICAgICAgICAgICAgIFBDSV9GVU5DKHNv
dXJjZV9pZCksIGFkZHIgPj4gNDgsIGlvbW11LT5yZWcpOworICAgICAgICAgICAgICAgJlBDSV9T
QkRGMl9UKHNlZywgc291cmNlX2lkKSwgYWRkciA+PiA0OCwgaW9tbXUtPnJlZyk7CiAgICAgICAg
IGtpbmQgPSAiSU5UUi1SRU1BUCI7CiAgICAgICAgIGJyZWFrOwogICAgIGRlZmF1bHQ6CiAgICAg
ICAgIHByaW50ayhYRU5MT0dfR19XQVJOSU5HIFZURFBSRUZJWAotICAgICAgICAgICAgICAgIlVO
S05PV046IFJlcXVlc3QgZGV2aWNlIFslMDR4OiUwMng6JTAyeC4ldV0gIgorICAgICAgICAgICAg
ICAgIlVOS05PV046IFJlcXVlc3QgZGV2aWNlIFslcHBdICIKICAgICAgICAgICAgICAgICJmYXVs
dCBhZGRyICUiUFJJeDY0IiwgaW9tbXUgcmVnID0gJXBcbiIsCi0gICAgICAgICAgICAgICBzZWcs
IFBDSV9CVVMoc291cmNlX2lkKSwgUENJX1NMT1Qoc291cmNlX2lkKSwKLSAgICAgICAgICAgICAg
IFBDSV9GVU5DKHNvdXJjZV9pZCksIGFkZHIsIGlvbW11LT5yZWcpOworICAgICAgICAgICAgICAg
JlBDSV9TQkRGMl9UKHNlZywgc291cmNlX2lkKSwgYWRkciwgaW9tbXUtPnJlZyk7CiAgICAgICAg
IGtpbmQgPSAiVU5LTk9XTiI7CiAgICAgICAgIGJyZWFrOwogICAgIH0KQEAgLTEzNTQsMTAgKzEz
NTEsOCBAQCBpbnQgZG9tYWluX2NvbnRleHRfbWFwcGluZ19vbmUoCiAgICAgICAgIHsKICAgICAg
ICAgICAgIGlmICggcGRldi0+ZG9tYWluICE9IGRvbWFpbiApCiAgICAgICAgICAgICB7Ci0gICAg
ICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19HX0lORk8gVlREUFJFRklYCi0gICAgICAgICAgICAg
ICAgICAgICAgICJkJWQ6ICUwNHg6JTAyeDolMDJ4LiV1IG93bmVkIGJ5IGQlZCEiLAotICAgICAg
ICAgICAgICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwKLSAgICAgICAgICAgICAgICAgICAg
ICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLAorICAgICAgICAg
ICAgICAgIHByaW50ayhYRU5MT0dfR19JTkZPIFZURFBSRUZJWCAiZCVkOiAlcHAgb3duZWQgYnkg
ZCVkISIsCisgICAgICAgICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLCAmUENJX1NC
REYzX1Qoc2VnLCBidXMsIGRldmZuKSwKICAgICAgICAgICAgICAgICAgICAgICAgcGRldi0+ZG9t
YWluID8gcGRldi0+ZG9tYWluLT5kb21haW5faWQgOiAtMSk7CiAgICAgICAgICAgICAgICAgcmVz
ID0gLUVJTlZBTDsKICAgICAgICAgICAgIH0KQEAgLTEzNzAsMTcgKzEzNjUsMTUgQEAgaW50IGRv
bWFpbl9jb250ZXh0X21hcHBpbmdfb25lKAogICAgICAgICAgICAgaWYgKCBjZG9tYWluIDwgMCAp
CiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19HX1dBUk5JTkcg
VlREUFJFRklYCi0gICAgICAgICAgICAgICAgICAgICAgICJkJWQ6ICUwNHg6JTAyeDolMDJ4LiV1
IG1hcHBlZCwgYnV0IGNhbid0IGZpbmQgb3duZXIhXG4iLAotICAgICAgICAgICAgICAgICAgICAg
ICBkb21haW4tPmRvbWFpbl9pZCwKLSAgICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIFBD
SV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgICAgICAgICAgICAgICAg
ImQlZDogJXBwIG1hcHBlZCwgYnV0IGNhbid0IGZpbmQgb3duZXIhXG4iLAorICAgICAgICAgICAg
ICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwgJlBDSV9TQkRGM19UKHNlZywgYnVzLCBkZXZm
bikpOwogICAgICAgICAgICAgICAgIHJlcyA9IC1FSU5WQUw7CiAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICBlbHNlIGlmICggY2RvbWFpbiAhPSBkb21haW4tPmRvbWFpbl9pZCApCiAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19HX0lORk8gVlREUFJFRklYCi0g
ICAgICAgICAgICAgICAgICAgICAgICJkJWQ6ICUwNHg6JTAyeDolMDJ4LiV1IGFscmVhZHkgbWFw
cGVkIHRvIGQlZCEiLAotICAgICAgICAgICAgICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwK
LSAgICAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZV
TkMoZGV2Zm4pLAorICAgICAgICAgICAgICAgICAgICAgICAiZCVkOiAlcHAgYWxyZWFkeSBtYXBw
ZWQgdG8gZCVkISIsCisgICAgICAgICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLCAm
UENJX1NCREYzX1Qoc2VnLCBidXMsIGRldmZuKSwKICAgICAgICAgICAgICAgICAgICAgICAgY2Rv
bWFpbik7CiAgICAgICAgICAgICAgICAgcmVzID0gLUVJTlZBTDsKICAgICAgICAgICAgIH0KQEAg
LTE0OTYsOSArMTQ4OSw4IEBAIHN0YXRpYyBpbnQgZG9tYWluX2NvbnRleHRfbWFwcGluZyhzdHJ1
Y3QgZG9tYWluICpkb21haW4sIHU4IGRldmZuLAogICAgIHsKICAgICBjYXNlIERFVl9UWVBFX1BD
SV9IT1NUX0JSSURHRToKICAgICAgICAgaWYgKCBpb21tdV9kZWJ1ZyApCi0gICAgICAgICAgICBw
cmludGsoVlREUFJFRklYICJkJWQ6SG9zdGJyaWRnZTogc2tpcCAlMDR4OiUwMng6JTAyeC4ldSBt
YXBcbiIsCi0gICAgICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsIHNlZywgYnVzLAot
ICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAg
ICAgICAgICAgIHByaW50ayhWVERQUkVGSVggImQlZDpIb3N0YnJpZGdlOiBza2lwICVwcCBtYXBc
biIsCisgICAgICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsICZwZGV2LT5zYmRmKTsK
ICAgICAgICAgaWYgKCAhaXNfaGFyZHdhcmVfZG9tYWluKGRvbWFpbikgKQogICAgICAgICAgICAg
cmV0dXJuIC1FUEVSTTsKICAgICAgICAgYnJlYWs7CkBAIC0xNTEwLDkgKzE1MDIsOCBAQCBzdGF0
aWMgaW50IGRvbWFpbl9jb250ZXh0X21hcHBpbmcoc3RydWN0IGRvbWFpbiAqZG9tYWluLCB1OCBk
ZXZmbiwKIAogICAgIGNhc2UgREVWX1RZUEVfUENJZV9FTkRQT0lOVDoKICAgICAgICAgaWYgKCBp
b21tdV9kZWJ1ZyApCi0gICAgICAgICAgICBwcmludGsoVlREUFJFRklYICJkJWQ6UENJZTogbWFw
ICUwNHg6JTAyeDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWlu
X2lkLCBzZWcsIGJ1cywKLSAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChkZXZmbiksIFBDSV9G
VU5DKGRldmZuKSk7CisgICAgICAgICAgICBwcmludGsoVlREUFJFRklYICJkJWQ6UENJZTogbWFw
ICVwcFxuIiwKKyAgICAgICAgICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwgJlBDSV9TQkRG
M19UKHNlZywgYnVzLCBkZXZmbikpOwogICAgICAgICByZXQgPSBkb21haW5fY29udGV4dF9tYXBw
aW5nX29uZShkb21haW4sIGRyaGQtPmlvbW11LCBidXMsIGRldmZuLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwZGV2KTsKICAgICAgICAgaWYgKCAhcmV0ICYmIGRl
dmZuID09IHBkZXYtPnNiZGYuZXh0ZnVuYyAmJiBhdHNfZGV2aWNlKHBkZXYsIGRyaGQpID4gMCAp
CkBAIC0xNTIyLDkgKzE1MTMsOCBAQCBzdGF0aWMgaW50IGRvbWFpbl9jb250ZXh0X21hcHBpbmco
c3RydWN0IGRvbWFpbiAqZG9tYWluLCB1OCBkZXZmbiwKIAogICAgIGNhc2UgREVWX1RZUEVfUENJ
OgogICAgICAgICBpZiAoIGlvbW11X2RlYnVnICkKLSAgICAgICAgICAgIHByaW50ayhWVERQUkVG
SVggImQlZDpQQ0k6IG1hcCAlMDR4OiUwMng6JTAyeC4ldVxuIiwKLSAgICAgICAgICAgICAgICAg
ICBkb21haW4tPmRvbWFpbl9pZCwgc2VnLCBidXMsCi0gICAgICAgICAgICAgICAgICAgUENJX1NM
T1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbikpOworICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJ
WCAiZCVkOlBDSTogbWFwICVwcFxuIiwKKyAgICAgICAgICAgICAgICAgICBkb21haW4tPmRvbWFp
bl9pZCwgJlBDSV9TQkRGM19UKHNlZywgYnVzLCBkZXZmbikpOwogCiAgICAgICAgIHJldCA9IGRv
bWFpbl9jb250ZXh0X21hcHBpbmdfb25lKGRvbWFpbiwgZHJoZC0+aW9tbXUsIGJ1cywgZGV2Zm4s
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZXYpOwpAQCAtMTU1
MCw5ICsxNTQwLDggQEAgc3RhdGljIGludCBkb21haW5fY29udGV4dF9tYXBwaW5nKHN0cnVjdCBk
b21haW4gKmRvbWFpbiwgdTggZGV2Zm4sCiAgICAgICAgIGJyZWFrOwogCiAgICAgZGVmYXVsdDoK
LSAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJWCwgImQlZDp1bmtub3duKCV1KTog
JTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQs
IHBkZXYtPnR5cGUsCi0gICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwg
UENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJWCwg
ImQlZDp1bmtub3duKCV1KTogJXBwXG4iLAorICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWlu
X2lkLCBwZGV2LT50eXBlLCAmUENJX1NCREYzX1Qoc2VnLCBidXMsIGRldmZuKSk7CiAgICAgICAg
IHJldCA9IC1FSU5WQUw7CiAgICAgICAgIGJyZWFrOwogICAgIH0KQEAgLTE2NDgsOSArMTYzNyw4
IEBAIHN0YXRpYyBpbnQgZG9tYWluX2NvbnRleHRfdW5tYXAoc3RydWN0IGRvbWFpbiAqZG9tYWlu
LCB1OCBkZXZmbiwKICAgICB7CiAgICAgY2FzZSBERVZfVFlQRV9QQ0lfSE9TVF9CUklER0U6CiAg
ICAgICAgIGlmICggaW9tbXVfZGVidWcgKQotICAgICAgICAgICAgcHJpbnRrKFZURFBSRUZJWCAi
ZCVkOkhvc3RicmlkZ2U6IHNraXAgJTA0eDolMDJ4OiUwMnguJXUgdW5tYXBcbiIsCi0gICAgICAg
ICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsIHNlZywgYnVzLAotICAgICAgICAgICAgICAg
ICAgIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgICAgIHByaW50
ayhWVERQUkVGSVggImQlZDpIb3N0YnJpZGdlOiBza2lwICVwcCB1bm1hcFxuIiwKKyAgICAgICAg
ICAgICAgICAgICBkb21haW4tPmRvbWFpbl9pZCwgJnBkZXYtPnNiZGYpOwogICAgICAgICBpZiAo
ICFpc19oYXJkd2FyZV9kb21haW4oZG9tYWluKSApCiAgICAgICAgICAgICByZXR1cm4gLUVQRVJN
OwogICAgICAgICBnb3RvIG91dDsKQEAgLTE2NjIsOSArMTY1MCw4IEBAIHN0YXRpYyBpbnQgZG9t
YWluX2NvbnRleHRfdW5tYXAoc3RydWN0IGRvbWFpbiAqZG9tYWluLCB1OCBkZXZmbiwKIAogICAg
IGNhc2UgREVWX1RZUEVfUENJZV9FTkRQT0lOVDoKICAgICAgICAgaWYgKCBpb21tdV9kZWJ1ZyAp
Ci0gICAgICAgICAgICBwcmludGsoVlREUFJFRklYICJkJWQ6UENJZTogdW5tYXAgJTA0eDolMDJ4
OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsIHNlZywg
YnVzLAotICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4p
KTsKKyAgICAgICAgICAgIHByaW50ayhWVERQUkVGSVggImQlZDpQQ0llOiB1bm1hcCAlcHBcbiIs
CisgICAgICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsICZQQ0lfU0JERjNfVChzZWcs
IGJ1cywgZGV2Zm4pKTsKICAgICAgICAgcmV0ID0gZG9tYWluX2NvbnRleHRfdW5tYXBfb25lKGRv
bWFpbiwgaW9tbXUsIGJ1cywgZGV2Zm4pOwogICAgICAgICBpZiAoICFyZXQgJiYgZGV2Zm4gPT0g
cGRldi0+c2JkZi5leHRmdW5jICYmIGF0c19kZXZpY2UocGRldiwgZHJoZCkgPiAwICkKICAgICAg
ICAgICAgIGRpc2FibGVfYXRzX2RldmljZShwZGV2KTsKQEAgLTE2NzMsOCArMTY2MCw4IEBAIHN0
YXRpYyBpbnQgZG9tYWluX2NvbnRleHRfdW5tYXAoc3RydWN0IGRvbWFpbiAqZG9tYWluLCB1OCBk
ZXZmbiwKIAogICAgIGNhc2UgREVWX1RZUEVfUENJOgogICAgICAgICBpZiAoIGlvbW11X2RlYnVn
ICkKLSAgICAgICAgICAgIHByaW50ayhWVERQUkVGSVggImQlZDpQQ0k6IHVubWFwICUwNHg6JTAy
eDolMDJ4LiV1XG4iLAotICAgICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLCBzZWcs
IGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbikpOworICAgICAgICAgICAgcHJp
bnRrKFZURFBSRUZJWCAiZCVkOlBDSTogdW5tYXAgJXBwXG4iLAorICAgICAgICAgICAgICAgICAg
IGRvbWFpbi0+ZG9tYWluX2lkLCAmUENJX1NCREYzX1Qoc2VnLCBidXMsIGRldmZuKSk7CiAgICAg
ICAgIHJldCA9IGRvbWFpbl9jb250ZXh0X3VubWFwX29uZShkb21haW4sIGlvbW11LCBidXMsIGRl
dmZuKTsKICAgICAgICAgaWYgKCByZXQgKQogICAgICAgICAgICAgYnJlYWs7CkBAIC0xNjk5LDkg
KzE2ODYsOCBAQCBzdGF0aWMgaW50IGRvbWFpbl9jb250ZXh0X3VubWFwKHN0cnVjdCBkb21haW4g
KmRvbWFpbiwgdTggZGV2Zm4sCiAgICAgICAgIGJyZWFrOwogCiAgICAgZGVmYXVsdDoKLSAgICAg
ICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJWCwgImQlZDp1bmtub3duKCV1KTogJTA0eDol
MDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgZG9tYWluLT5kb21haW5faWQsIHBkZXYt
PnR5cGUsCi0gICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZV
TkMoZGV2Zm4pKTsKKyAgICAgICAgZHByaW50ayhYRU5MT0dfRVJSIFZURFBSRUZJWCwgImQlZDp1
bmtub3duKCV1KTogJXBwXG4iLAorICAgICAgICAgICAgICAgIGRvbWFpbi0+ZG9tYWluX2lkLCBw
ZGV2LT50eXBlLCAmUENJX1NCREYzX1Qoc2VnLCBidXMsIGRldmZuKSk7CiAgICAgICAgIHJldCA9
IC1FSU5WQUw7CiAgICAgICAgIGdvdG8gb3V0OwogICAgIH0KQEAgLTI0OTksMTEgKzI0ODUsMTEg
QEAgc3RhdGljIGludCBpbnRlbF9pb21tdV9hc3NpZ25fZGV2aWNlKAogICAgICAgICAgICAgYm9v
bF90IHJlbGF4ZWQgPSAhIShmbGFnICYgWEVOX0RPTUNUTF9ERVZfUkRNX1JFTEFYRUQpOwogCiAg
ICAgICAgICAgICBwcmludGsoWEVOTE9HX0dVRVNUICIlcyIgVlREUFJFRklYCi0gICAgICAgICAg
ICAgICAgICAgIiBJdCdzICVzIHRvIGFzc2lnbiAlMDR4OiUwMng6JTAyeC4ldSIKKyAgICAgICAg
ICAgICAgICAgICAiIEl0J3MgJXMgdG8gYXNzaWduICVwcCIKICAgICAgICAgICAgICAgICAgICAi
IHdpdGggc2hhcmVkIFJNUlIgYXQgJSJQUkl4NjQiIGZvciBEb20lZC5cbiIsCiAgICAgICAgICAg
ICAgICAgICAgcmVsYXhlZCA/IFhFTkxPR19XQVJOSU5HIDogWEVOTE9HX0VSUiwKICAgICAgICAg
ICAgICAgICAgICByZWxheGVkID8gInJpc2t5IiA6ICJkaXNhbGxvd2VkIiwKLSAgICAgICAgICAg
ICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbiksCisgICAg
ICAgICAgICAgICAgICAgJlBDSV9TQkRGM19UKHNlZywgYnVzLCBkZXZmbiksCiAgICAgICAgICAg
ICAgICAgICAgcm1yci0+YmFzZV9hZGRyZXNzLCBkLT5kb21haW5faWQpOwogICAgICAgICAgICAg
aWYgKCAhcmVsYXhlZCApCiAgICAgICAgICAgICAgICAgcmV0dXJuIC1FUEVSTTsKZGlmZiAtLWdp
dCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xdWlya3MuYyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3Z0ZC9xdWlya3MuYwppbmRleCA0OGM3Mzg0YjgyLi4wMzAyYzUwM2ZiIDEwMDY0
NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVpcmtzLmMKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jCkBAIC00MjgsOCArNDI4LDYgQEAgdm9pZCBw
Y2lfdnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogewogICAgIGludCBzZWcg
PSBwZGV2LT5zYmRmLnNlZzsKICAgICBpbnQgYnVzID0gcGRldi0+c2JkZi5idXM7Ci0gICAgaW50
IGRldiA9IHBkZXYtPnNiZGYuZGV2OwotICAgIGludCBmdW5jID0gcGRldi0+c2JkZi5mdW5jOwog
ICAgIGludCBwb3M7CiAgICAgYm9vbF90IGZmOwogICAgIHUzMiB2YWwsIHZhbDI7CkBAIC00NTQs
OCArNDUyLDcgQEAgdm9pZCBwY2lfdnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2
KQogICAgIGNhc2UgMHgzYzI4OiAvKiBTYW5keWJyaWRnZSAqLwogICAgICAgICB2YWwgPSBwY2lf
Y29uZl9yZWFkMzIocGRldi0+c2JkZiwgMHgxQUMpOwogICAgICAgICBwY2lfY29uZl93cml0ZTMy
KHBkZXYtPnNiZGYsIDB4MUFDLCB2YWwgfCAoMSA8PCAzMSkpOwotICAgICAgICBwcmludGsoWEVO
TE9HX0lORk8gIk1hc2tlZCBWVC1kIGVycm9yIHNpZ25hbGluZyBvbiAlMDR4OiUwMng6JTAyeC4l
dVxuIiwKLSAgICAgICAgICAgICAgIHNlZywgYnVzLCBkZXYsIGZ1bmMpOworICAgICAgICBwcmlu
dGsoWEVOTE9HX0lORk8gIk1hc2tlZCBWVC1kIGVycm9yIHNpZ25hbGluZyBvbiAlcHBcbiIsICZw
ZGV2LT5zYmRmKTsKICAgICAgICAgYnJlYWs7CiAKICAgICAvKiBUeWxlcnNidXJnIChFUCkvQm94
Ym9ybyAoTVApIGNoaXBzZXRzIChOSE0tRVAvRVgsIFdTTS1FUC9FWCkgKi8KQEAgLTQ5MCw4ICs0
ODcsNyBAQCB2b2lkIHBjaV92dGRfcXVpcmsoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAg
ICAgICAgICAgICBmZiA9IHBjaWVfYWVyX2dldF9maXJtd2FyZV9maXJzdChwZGV2KTsKICAgICAg
ICAgaWYgKCAhcG9zICkKICAgICAgICAgewotICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJO
SU5HICIlMDR4OiUwMng6JTAyeC4ldSB3aXRob3V0IEFFUiBjYXBhYmlsaXR5P1xuIiwKLSAgICAg
ICAgICAgICAgICAgICBzZWcsIGJ1cywgZGV2LCBmdW5jKTsKKyAgICAgICAgICAgIHByaW50ayhY
RU5MT0dfV0FSTklORyAiJXBwIHdpdGhvdXQgQUVSIGNhcGFiaWxpdHk/XG4iLCAmcGRldi0+c2Jk
Zik7CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgfQogCkBAIC01MTQsOCArNTEwLDcgQEAg
dm9pZCBwY2lfdnRkX3F1aXJrKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICB2
YWwgPSBwY2lfY29uZl9yZWFkMzIocGRldi0+c2JkZiwgMHgyMGMpOwogICAgICAgICBwY2lfY29u
Zl93cml0ZTMyKHBkZXYtPnNiZGYsIDB4MjBjLCB2YWwgfCAoMSA8PCA0KSk7CiAKLSAgICAgICAg
cHJpbnRrKFhFTkxPR19JTkZPICIlcyBVUiBzaWduYWxpbmcgb24gJTA0eDolMDJ4OiUwMnguJXVc
biIsCi0gICAgICAgICAgICAgICBhY3Rpb24sIHNlZywgYnVzLCBkZXYsIGZ1bmMpOworICAgICAg
ICBwcmludGsoWEVOTE9HX0lORk8gIiVzIFVSIHNpZ25hbGluZyBvbiAlcHBcbiIsIGFjdGlvbiwg
JnBkZXYtPnNiZGYpOwogICAgICAgICBicmVhazsKIAogICAgIGNhc2UgMHgwMDQwOiBjYXNlIDB4
MDA0NDogY2FzZSAweDAwNDg6IC8qIE5laGFsZW0vV2VzdG1lcmUgKi8KQEAgLTU0MCwxNiArNTM1
LDE2IEBAIHZvaWQgcGNpX3Z0ZF9xdWlyayhjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAg
ICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBfX3NldF9iaXQoMHgxYzggKiA4ICsgMjAsIHZh
KTsKICAgICAgICAgICAgICAgICBpb3VubWFwKHZhKTsKLSAgICAgICAgICAgICAgICBwcmludGso
WEVOTE9HX0lORk8gIk1hc2tlZCBVUiBzaWduYWxpbmcgb24gJTA0eDolMDJ4OiUwMnguJXVcbiIs
Ci0gICAgICAgICAgICAgICAgICAgICAgIHNlZywgYnVzLCBkZXYsIGZ1bmMpOworICAgICAgICAg
ICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiTWFza2VkIFVSIHNpZ25hbGluZyBvbiAlcHBcbiIs
CisgICAgICAgICAgICAgICAgICAgICAgICZwZGV2LT5zYmRmKTsKICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgIGVsc2UKLSAgICAgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiAiQ291bGQg
bm90IG1hcCAlIlBSSXBhZGRyIiBmb3IgJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAg
ICAgICAgICAgICAgIHBhLCBzZWcsIGJ1cywgZGV2LCBmdW5jKTsKKyAgICAgICAgICAgICAgICBw
cmludGsoWEVOTE9HX0VSUiAiQ291bGQgbm90IG1hcCAlIlBSSXBhZGRyIiBmb3IgJXBwXG4iLAor
ICAgICAgICAgICAgICAgICAgICAgICBwYSwgJnBkZXYtPnNiZGYpOwogICAgICAgICB9CiAgICAg
ICAgIGVsc2UKLSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORyAiQm9ndXMgRE1JQkFS
ICUjIlBSSXg2NCIgb24gJTA0eDolMDJ4OiUwMnguJXVcbiIsCi0gICAgICAgICAgICAgICAgICAg
YmFyLCBzZWcsIGJ1cywgZGV2LCBmdW5jKTsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FS
TklORyAiQm9ndXMgRE1JQkFSICUjIlBSSXg2NCIgb24gJXBwXG4iLAorICAgICAgICAgICAgICAg
ICAgIGJhciwgJnBkZXYtPnNiZGYpOwogICAgICAgICBicmVhazsKICAgICB9CiB9CmRpZmYgLS1n
aXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvdXRpbHMuYyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3Z0ZC91dGlscy5jCmluZGV4IDk0YTZlNGVlYzkuLjU2NjViZjc2OTcgMTAwNjQ0
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC91dGlscy5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC91dGlscy5jCkBAIC05NSw5ICs5NSw5IEBAIHZvaWQgcHJpbnRf
dnRkX2VudHJpZXMoc3RydWN0IGlvbW11ICppb21tdSwgaW50IGJ1cywgaW50IGRldmZuLCB1NjQg
Z21mbikKICAgICB1NjQgKmwsIHZhbDsKICAgICB1MzIgbF9pbmRleCwgbGV2ZWw7CiAKLSAgICBw
cmludGsoInByaW50X3Z0ZF9lbnRyaWVzOiBpb21tdSAjJXUgZGV2ICUwNHg6JTAyeDolMDJ4LiV1
IGdtZm4gJSJQUklfZ2ZuIlxuIiwKLSAgICAgICAgICAgaW9tbXUtPmluZGV4LCBpb21tdS0+aW50
ZWwtPmRyaGQtPnNlZ21lbnQsIGJ1cywKLSAgICAgICAgICAgUENJX1NMT1QoZGV2Zm4pLCBQQ0lf
RlVOQyhkZXZmbiksIGdtZm4pOworICAgIHByaW50aygicHJpbnRfdnRkX2VudHJpZXM6IGlvbW11
ICMldSBkZXYgJXBwIGdtZm4gJSJQUklfZ2ZuIlxuIiwKKyAgICAgICAgICAgaW9tbXUtPmluZGV4
LCAmUENJX1NCREYzX1QoaW9tbXUtPmludGVsLT5kcmhkLT5zZWdtZW50LCBidXMsIGRldmZuKSwK
KyAgICAgICAgICAgZ21mbik7CiAKICAgICBpZiAoIGlvbW11LT5yb290X21hZGRyID09IDAgKQog
ICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9hdHMuYyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9hdHMuYwppbmRleCBjMzIwMzc5M2E2Li5jZmQ2MTAy
MjlkIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvYXRzLmMKKysrIGIv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0cy5jCkBAIC0zMSw4ICszMSw3IEBAIGludCBl
bmFibGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgc3RydWN0IGxpc3RfaGVhZCAq
YXRzX2xpc3QpCiAgICAgQlVHX09OKCFwb3MpOwogCiAgICAgaWYgKCBpb21tdV92ZXJib3NlICkK
LSAgICAgICAgZHByaW50ayhYRU5MT0dfSU5GTywgIiUwNHg6JTAyeDolMDJ4LiV1OiBBVFMgY2Fw
YWJpbGl0eSBmb3VuZFxuIiwKLSAgICAgICAgICAgICAgICBzZWcsIGJ1cywgUENJX1NMT1QoZGV2
Zm4pLCBQQ0lfRlVOQyhkZXZmbikpOworICAgICAgICBkcHJpbnRrKFhFTkxPR19JTkZPLCAiJXBw
OiBBVFMgY2FwYWJpbGl0eSBmb3VuZFxuIiwgJnBkZXYtPnNiZGYpOwogCiAgICAgdmFsdWUgPSBw
Y2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgcG9zICsgQVRTX1JFR19DVEwpOwogICAgIGlmICgg
dmFsdWUgJiBBVFNfRU5BQkxFICkKQEAgLTYzLDkgKzYyLDggQEAgaW50IGVuYWJsZV9hdHNfZGV2
aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBzdHJ1Y3QgbGlzdF9oZWFkICphdHNfbGlzdCkKICAg
ICB9CiAKICAgICBpZiAoIGlvbW11X3ZlcmJvc2UgKQotICAgICAgICBkcHJpbnRrKFhFTkxPR19J
TkZPLCAiJTA0eDolMDJ4OiUwMnguJXU6IEFUUyAlcyBlbmFibGVkXG4iLAotICAgICAgICAgICAg
ICAgIHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAg
ICAgICAgICBwb3MgPyAiaXMiIDogIndhcyIpOworICAgICAgICBkcHJpbnRrKFhFTkxPR19JTkZP
LCAiJXBwOiBBVFMgJXMgZW5hYmxlZFxuIiwKKyAgICAgICAgICAgICAgICAmcGRldi0+c2JkZiwg
cG9zID8gImlzIiA6ICJ3YXMiKTsKIAogICAgIHJldHVybiBwb3M7CiB9CkBAIC03Myw4ICs3MSw2
IEBAIGludCBlbmFibGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgc3RydWN0IGxp
c3RfaGVhZCAqYXRzX2xpc3QpCiB2b2lkIGRpc2FibGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2Rl
diAqcGRldikKIHsKICAgICB1MzIgdmFsdWU7Ci0gICAgdWludDE2X3Qgc2VnID0gcGRldi0+c2Jk
Zi5zZWc7Ci0gICAgdWludDhfdCBidXMgPSBwZGV2LT5zYmRmLmJ1cywgZGV2Zm4gPSBwZGV2LT5z
YmRmLmV4dGZ1bmM7CiAKICAgICBCVUdfT04oIXBkZXYtPmF0cy5jYXBfcG9zKTsKIApAQCAtODUs
NiArODEsNSBAQCB2b2lkIGRpc2FibGVfYXRzX2RldmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldikK
ICAgICBsaXN0X2RlbCgmcGRldi0+YXRzLmxpc3QpOwogCiAgICAgaWYgKCBpb21tdV92ZXJib3Nl
ICkKLSAgICAgICAgZHByaW50ayhYRU5MT0dfSU5GTywgIiUwNHg6JTAyeDolMDJ4LiV1OiBBVFMg
aXMgZGlzYWJsZWRcbiIsCi0gICAgICAgICAgICAgICAgc2VnLCBidXMsIFBDSV9TTE9UKGRldmZu
KSwgUENJX0ZVTkMoZGV2Zm4pKTsKKyAgICAgICAgZHByaW50ayhYRU5MT0dfSU5GTywgIiVwcDog
QVRTIGlzIGRpc2FibGVkXG4iLCAmcGRldi0+c2JkZik7CiB9CmRpZmYgLS1naXQgYS94ZW4vZHJp
dmVycy92cGNpL2hlYWRlci5jIGIveGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYwppbmRleCBkNjkz
YjEzNzZjLi5kZGRhODgxMzY2IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5j
CisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMKQEAgLTM3MSw5ICszNzEsOCBAQCBzdGF0
aWMgdm9pZCBiYXJfd3JpdGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGlu
dCByZWcsCiAgICAgICAgIC8qIElmIHRoZSB2YWx1ZSB3cml0dGVuIGlzIHRoZSBjdXJyZW50IG9u
ZSBhdm9pZCBwcmludGluZyBhIHdhcm5pbmcuICovCiAgICAgICAgIGlmICggdmFsICE9ICh1aW50
MzJfdCkoYmFyLT5hZGRyID4+IChoaSA/IDMyIDogMCkpICkKICAgICAgICAgICAgIGdwcmludGso
WEVOTE9HX1dBUk5JTkcsCi0gICAgICAgICAgICAgICAgICAgICIlMDR4OiUwMng6JTAyeC4ldTog
aWdub3JlZCBCQVIgJWx1IHdyaXRlIHdpdGggbWVtb3J5IGRlY29kaW5nIGVuYWJsZWRcbiIsCi0g
ICAgICAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuc2VnLCBwZGV2LT5zYmRmLmJ1cywgcGRldi0+
c2JkZi5kZXYsCi0gICAgICAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuZnVuYywgYmFyIC0gcGRl
di0+dnBjaS0+aGVhZGVyLmJhcnMgKyBoaSk7CisgICAgICAgICAgICAgICAgICAgICIlcHA6IGln
bm9yZWQgQkFSICVsdSB3cml0ZSB3aXRoIG1lbW9yeSBkZWNvZGluZyBlbmFibGVkXG4iLAorICAg
ICAgICAgICAgICAgICAgICAmcGRldi0+c2JkZiwgYmFyIC0gcGRldi0+dnBjaS0+aGVhZGVyLmJh
cnMgKyBoaSk7CiAgICAgICAgIHJldHVybjsKICAgICB9CiAKQEAgLTQwNyw5ICs0MDYsOCBAQCBz
dGF0aWMgdm9pZCByb21fd3JpdGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVk
IGludCByZWcsCiAgICAgaWYgKCAoY21kICYgUENJX0NPTU1BTkRfTUVNT1JZKSAmJiBoZWFkZXIt
PnJvbV9lbmFibGVkICYmIG5ld19lbmFibGVkICkKICAgICB7CiAgICAgICAgIGdwcmludGsoWEVO
TE9HX1dBUk5JTkcsCi0gICAgICAgICAgICAgICAgIiUwNHg6JTAyeDolMDJ4LiV1OiBpZ25vcmVk
IFJPTSBCQVIgd3JpdGUgd2l0aCBtZW1vcnkgZGVjb2RpbmcgZW5hYmxlZFxuIiwKLSAgICAgICAg
ICAgICAgICBwZGV2LT5zYmRmLnNlZywgcGRldi0+c2JkZi5idXMsIHBkZXYtPnNiZGYuZGV2LAot
ICAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuZnVuYyk7CisgICAgICAgICAgICAgICAgIiVwcDog
aWdub3JlZCBST00gQkFSIHdyaXRlIHdpdGggbWVtb3J5IGRlY29kaW5nIGVuYWJsZWRcbiIsCisg
ICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYpOwogICAgICAgICByZXR1cm47CiAgICAgfQogCmRp
ZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL21zaS5jIGIveGVuL2RyaXZlcnMvdnBjaS9tc2ku
YwppbmRleCA0ZjJlNTVmM2ZkLi4yYmRhZTQ4ZWRmIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy92
cGNpL21zaS5jCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpLmMKQEAgLTI5MCw4ICsyOTAsNyBA
QCB2b2lkIHZwY2lfZHVtcF9tc2kodm9pZCkKICAgICAgICAgICAgIG1zaSA9IHBkZXYtPnZwY2kt
Pm1zaTsKICAgICAgICAgICAgIGlmICggbXNpICYmIG1zaS0+ZW5hYmxlZCApCiAgICAgICAgICAg
ICB7Ci0gICAgICAgICAgICAgICAgcHJpbnRrKCIlMDR4OiUwMng6JTAyeC4ldSBNU0lcbiIsIHBk
ZXYtPnNiZGYuc2VnLAotICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5zYmRmLmJ1cywgcGRl
di0+c2JkZi5kZXYsIHBkZXYtPnNiZGYuZnVuYyk7CisgICAgICAgICAgICAgICAgcHJpbnRrKCIl
cHAgTVNJXG4iLCAmcGRldi0+c2JkZik7CiAKICAgICAgICAgICAgICAgICBwcmludGsoIiAgZW5h
YmxlZDogJWQgNjQtYml0OiAlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIG1zaS0+ZW5hYmxl
ZCwgbXNpLT5hZGRyZXNzNjQpOwpAQCAtMzA4LDggKzMwNyw3IEBAIHZvaWQgdnBjaV9kdW1wX21z
aSh2b2lkKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIGludCByYzsKIAotICAgICAg
ICAgICAgICAgIHByaW50aygiJTA0eDolMDJ4OiUwMnguJXUgTVNJLVhcbiIsIHBkZXYtPnNiZGYu
c2VnLAotICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5zYmRmLmJ1cywgcGRldi0+c2JkZi5k
ZXYsIHBkZXYtPnNiZGYuZnVuYyk7CisgICAgICAgICAgICAgICAgcHJpbnRrKCIlcHAgTVNJLVhc
biIsICZwZGV2LT5zYmRmKTsKIAogICAgICAgICAgICAgICAgIHByaW50aygiICBlbnRyaWVzOiAl
dSBtYXNrYWxsOiAlZCBlbmFibGVkOiAlZFxuIiwKICAgICAgICAgICAgICAgICAgICAgICAgbXNp
eC0+bWF4X2VudHJpZXMsIG1zaXgtPm1hc2tlZCwgbXNpeC0+ZW5hYmxlZCk7CmRpZmYgLS1naXQg
YS94ZW4vZHJpdmVycy92cGNpL21zaXguYyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jCmluZGV4
IDQ3ZDU2OTEyMWYuLjEwMDZiMDFmNGIgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvbXNp
eC5jCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jCkBAIC00OCw5ICs0OCw4IEBAIHN0YXRp
YyBpbnQgdXBkYXRlX2VudHJ5KHN0cnVjdCB2cGNpX21zaXhfZW50cnkgKmVudHJ5LAogICAgIGlm
ICggcmMgJiYgcmMgIT0gLUVOT0VOVCApCiAgICAgewogICAgICAgICBncHJpbnRrKFhFTkxPR19X
QVJOSU5HLAotICAgICAgICAgICAgICAgICIlMDR4OiUwMng6JTAyeC4ldTogdW5hYmxlIHRvIGRp
c2FibGUgZW50cnkgJXUgZm9yIHVwZGF0ZTogJWRcbiIsCi0gICAgICAgICAgICAgICAgcGRldi0+
c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRldiwgcGRldi0+c2JkZi5mdW5j
LAotICAgICAgICAgICAgICAgIG5yLCByYyk7CisgICAgICAgICAgICAgICAgIiVwcDogdW5hYmxl
IHRvIGRpc2FibGUgZW50cnkgJXUgZm9yIHVwZGF0ZTogJWRcbiIsCisgICAgICAgICAgICAgICAg
JnBkZXYtPnNiZGYsIG5yLCByYyk7CiAgICAgICAgIHJldHVybiByYzsKICAgICB9CiAKQEAgLTU5
LDEwICs1OCw4IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2VudHJ5KHN0cnVjdCB2cGNpX21zaXhfZW50
cnkgKmVudHJ5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgVlBDSV9NU0lYX1RBQkxFKSk7CiAgICAgaWYgKCByYyApCiAgICAgewotICAgICAg
ICBncHJpbnRrKFhFTkxPR19XQVJOSU5HLAotICAgICAgICAgICAgICAgICIlMDR4OiUwMng6JTAy
eC4ldTogdW5hYmxlIHRvIGVuYWJsZSBlbnRyeSAldTogJWRcbiIsCi0gICAgICAgICAgICAgICAg
cGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRldiwgcGRldi0+c2Jk
Zi5mdW5jLAotICAgICAgICAgICAgICAgIG5yLCByYyk7CisgICAgICAgIGdwcmludGsoWEVOTE9H
X1dBUk5JTkcsICIlcHA6IHVuYWJsZSB0byBlbmFibGUgZW50cnkgJXU6ICVkXG4iLAorICAgICAg
ICAgICAgICAgICZwZGV2LT5zYmRmLCBuciwgcmMpOwogICAgICAgICAvKiBFbnRyeSBpcyBsaWtl
bHkgbm90IHByb3Blcmx5IGNvbmZpZ3VyZWQuICovCiAgICAgICAgIHJldHVybiByYzsKICAgICB9
CkBAIC0xMzMsMTAgKzEzMCw4IEBAIHN0YXRpYyB2b2lkIGNvbnRyb2xfd3JpdGUoY29uc3Qgc3Ry
dWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgICAgICAgICAgICAgLyog
SWdub3JlIG5vbi1wcmVzZW50IGVudHJ5LiAqLwogICAgICAgICAgICAgICAgIGJyZWFrOwogICAg
ICAgICAgICAgZGVmYXVsdDoKLSAgICAgICAgICAgICAgICBncHJpbnRrKFhFTkxPR19XQVJOSU5H
LAotICAgICAgICAgICAgICAgICAgICAgICAgIiUwNHg6JTAyeDolMDJ4LiV1OiB1bmFibGUgdG8g
ZGlzYWJsZSBlbnRyeSAldTogJWRcbiIsCi0gICAgICAgICAgICAgICAgICAgICAgICBwZGV2LT5z
YmRmLnNlZywgcGRldi0+c2JkZi5idXMsIHBkZXYtPnNiZGYuZGV2LAotICAgICAgICAgICAgICAg
ICAgICAgICAgcGRldi0+c2JkZi5mdW5jLCBpLCByYyk7CisgICAgICAgICAgICAgICAgZ3ByaW50
ayhYRU5MT0dfV0FSTklORywgIiVwcDogdW5hYmxlIHRvIGRpc2FibGUgZW50cnkgJXU6ICVkXG4i
LAorICAgICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIGksIHJjKTsKICAgICAgICAg
ICAgICAgICByZXR1cm47CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KQEAgLTE4MSw4ICsxNzYs
NyBAQCBzdGF0aWMgYm9vbCBhY2Nlc3NfYWxsb3dlZChjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRl
diwgdW5zaWduZWQgbG9uZyBhZGRyLAogICAgICAgICByZXR1cm4gdHJ1ZTsKIAogICAgIGdwcmlu
dGsoWEVOTE9HX1dBUk5JTkcsCi0gICAgICAgICAgICAiJTA0eDolMDJ4OiUwMnguJXU6IHVuYWxp
Z25lZCBvciBpbnZhbGlkIHNpemUgTVNJLVggdGFibGUgYWNjZXNzXG4iLAotICAgICAgICAgICAg
cGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRmLmRldiwgcGRldi0+c2Jk
Zi5mdW5jKTsKKyAgICAgICAgICAgICIlcHA6IHVuYWxpZ25lZCBvciBpbnZhbGlkIHNpemUgTVNJ
LVggdGFibGUgYWNjZXNzXG4iLCAmcGRldi0+c2JkZik7CiAKICAgICByZXR1cm4gZmFsc2U7CiB9
CkBAIC00MzIsMTAgKzQyNiw5IEBAIGludCB2cGNpX21ha2VfbXNpeF9ob2xlKGNvbnN0IHN0cnVj
dCBwY2lfZGV2ICpwZGV2KQogICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICBw
dXRfZ2ZuKGQsIHN0YXJ0KTsKICAgICAgICAgICAgICAgICBncHJpbnRrKFhFTkxPR19XQVJOSU5H
LAotICAgICAgICAgICAgICAgICAgICAgICAgIiUwNHg6JTAyeDolMDJ4LiV1OiBleGlzdGluZyBt
YXBwaW5nIChtZm46ICUiIFBSSV9tZm4KKyAgICAgICAgICAgICAgICAgICAgICAgICIlcHA6IGV4
aXN0aW5nIG1hcHBpbmcgKG1mbjogJSIgUFJJX21mbgogICAgICAgICAgICAgICAgICAgICAgICAg
InR5cGU6ICVkKSBhdCAlI2x4IGNsb2JiZXJzIE1TSVggTU1JTyBhcmVhXG4iLAotICAgICAgICAg
ICAgICAgICAgICAgICAgcGRldi0+c2JkZi5zZWcsIHBkZXYtPnNiZGYuYnVzLCBwZGV2LT5zYmRm
LmRldiwKLSAgICAgICAgICAgICAgICAgICAgICAgIHBkZXYtPnNiZGYuZnVuYywgbWZuX3gobWZu
KSwgdCwgc3RhcnQpOworICAgICAgICAgICAgICAgICAgICAgICAgJnBkZXYtPnNiZGYsIG1mbl94
KG1mbiksIHQsIHN0YXJ0KTsKICAgICAgICAgICAgICAgICByZXR1cm4gLUVFWElTVDsKICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgIHB1dF9nZm4oZCwgc3RhcnQpOwpkaWZmIC0tZ2l0IGEveGVu
L2luY2x1ZGUveGVuL3BjaS5oIGIveGVuL2luY2x1ZGUveGVuL3BjaS5oCmluZGV4IDk5MDhkMGZl
NWQuLjVlMzQ1YzQxN2YgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9wY2kuaAorKysgYi94
ZW4vaW5jbHVkZS94ZW4vcGNpLmgKQEAgLTYwLDYgKzYwLDggQEAgdHlwZWRlZiB1bmlvbiB7CiAK
ICNkZWZpbmUgUENJX1NCREZfVChzLCBiLCBkLCBmKSBcCiAgICAgKChwY2lfc2JkZl90KSB7IC5z
ZWcgPSAocyksIC5idXMgPSAoYiksIC5kZXYgPSAoZCksIC5mdW5jID0gKGYpIH0pCisjZGVmaW5l
IFBDSV9TQkRGMl9UKHMsIGIpIFwKKyAgICAoKHBjaV9zYmRmX3QpIHsgLnNlZyA9IChzKSwgLmJk
ZiA9IChiKSB9KQogI2RlZmluZSBQQ0lfU0JERjNfVChzLCBiLCBlKSBcCiAgICAgKChwY2lfc2Jk
Zl90KSB7IC5zZWcgPSAocyksIC5idXMgPSAoYiksIC5leHRmdW5jID0gKGUpIH0pCiAKLS0gCjIu
MTcuMiAoQXBwbGUgR2l0LTExMykKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5w
cm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8v
eGVuLWRldmVs

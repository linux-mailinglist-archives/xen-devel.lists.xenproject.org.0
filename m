Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id EBC79A83C4
	for <lists+xen-devel@lfdr.de>; Wed,  4 Sep 2019 15:30:44 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i5VK8-0001VN-Kx; Wed, 04 Sep 2019 13:27:48 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=Tt/v=W7=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1i5VK6-0001VA-Oj
 for xen-devel@lists.xenproject.org; Wed, 04 Sep 2019 13:27:46 +0000
X-Inumbo-ID: c7784148-cf17-11e9-978d-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id c7784148-cf17-11e9-978d-bc764e2007e4;
 Wed, 04 Sep 2019 13:27:45 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 44A63B776;
 Wed,  4 Sep 2019 13:27:44 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
References: <050de29e-5a10-8b4a-44f1-0241f4b33ee2@suse.com>
Message-ID: <53d3e1ed-93c4-56de-dbb8-2517feaa93bb@suse.com>
Date: Wed, 4 Sep 2019 15:27:50 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <050de29e-5a10-8b4a-44f1-0241f4b33ee2@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH 2/3] VT-d: avoid PCI device lookup
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHR3byB1c2VzIG9mIHBjaV9nZXRfcGRldl9ieV9kb21haW4oKSBsYWNrIHByb3BlciBsb2Nr
aW5nLCBidXQgYXJlCmFsc28gb25seSB1c2VkIHRvIGdldCBob2xkIG9mIGEgTlVNQSBub2RlIElE
LiBDYWxjdWxhdGUgYW5kIHN0b3JlIHRoZQpub2RlIElEIGVhcmxpZXIgb24gYW5kIHJlbW92ZSB0
aGUgbG9va3VwcyAoaW4gbGlldSBvZiBmaXhpbmcgdGhlCmxvY2tpbmcpLgoKV2hpbGUgZG9pbmcg
dGhpcyBpdCBiZWNhbWUgYXBwYXJlbnQgdGhhdCBpb21tdV9hbGxvYygpJ3MgdXNlIG9mCmFsbG9j
X3BndGFibGVfbWFkZHIoKSB3b3VsZCBvY2N1ciBiZWZvcmUgUkhTQXMgd291bGQgaGF2ZSBiZWVu
IHBhcnNlZDoKaW9tbXVfYWxsb2MoKSBnZXRzIGNhbGxlZCBmcm9tIHRoZSBEUkhEIHBhcnNpbmcg
cm91dGluZSwgd2hpY2ggLSBvbgpzcGVjIGNvbmZvcm1pbmcgcGxhdGZvcm1zIC0gaGFwcGVucyBz
dHJpY3RseSBiZWZvcmUgUkhTQSBwYXJzaW5nLiBEZWZlcgp0aGUgYWxsb2NhdGlvbiB1bnRpbCBh
ZnRlciBhbGwgQUNQSSB0YWJsZSBwYXJzaW5nIGhhcyBmaW5pc2hlZCwKZXN0YWJsaXNoZWQgdGhl
IG5vZGUgSUQgdGhlcmUgZmlyc3QuCgpTdWdnZXN0ZWQtYnk6IEtldmluIFRpYW4gPGtldmluLnRp
YW5AaW50ZWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5j
b20+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9pb21tdS5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2lvbW11LmMKQEAgLTE1MSw2ICsxNTEsMTAgQEAgaW50IGlvbW11X2Rv
bWFpbl9pbml0KHN0cnVjdCBkb21haW4gKmQpCiAgICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQg
PSBkb21faW9tbXUoZCk7CiAgICAgaW50IHJldCA9IDA7CiAKKyNpZmRlZiBDT05GSUdfTlVNQQor
ICAgIGhkLT5ub2RlID0gTlVNQV9OT19OT0RFOworI2VuZGlmCisKICAgICByZXQgPSBhcmNoX2lv
bW11X2RvbWFpbl9pbml0KGQpOwogICAgIGlmICggcmV0ICkKICAgICAgICAgcmV0dXJuIHJldDsK
LS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2RtYXIuYworKysgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC92dGQvZG1hci5jCkBAIC05NjUsNiArOTY1LDcgQEAgaW50IF9faW5pdCBh
Y3BpX2RtYXJfaW5pdCh2b2lkKQogewogICAgIGFjcGlfcGh5c2ljYWxfYWRkcmVzcyBkbWFyX2Fk
ZHI7CiAgICAgYWNwaV9uYXRpdmVfdWludCBkbWFyX2xlbjsKKyAgICBjb25zdCBzdHJ1Y3QgYWNw
aV9kcmhkX3VuaXQgKmRyaGQ7CiAgICAgaW50IHJldDsKIAogICAgIGlmICggQUNQSV9TVUNDRVNT
KGFjcGlfZ2V0X3RhYmxlX3BoeXMoQUNQSV9TSUdfRE1BUiwgMCwKQEAgLTk3OCw2ICs5NzksMjEg
QEAgaW50IF9faW5pdCBhY3BpX2RtYXJfaW5pdCh2b2lkKQogCiAgICAgcmV0ID0gcGFyc2VfZG1h
cl90YWJsZShhY3BpX3BhcnNlX2RtYXIpOwogCisgICAgZm9yX2VhY2hfZHJoZF91bml0ICggZHJo
ZCApCisgICAgeworICAgICAgICBjb25zdCBzdHJ1Y3QgYWNwaV9yaHNhX3VuaXQgKnJoc2EgPSBk
cmhkX3RvX3Joc2EoZHJoZCk7CisgICAgICAgIHN0cnVjdCBpb21tdSAqaW9tbXUgPSBkcmhkLT5p
b21tdTsKKworICAgICAgICBpZiAoIHJldCApCisgICAgICAgICAgICBicmVhazsKKworICAgICAg
ICBpZiAoIHJoc2EgKQorICAgICAgICAgICAgaW9tbXUtPmludGVsLT5ub2RlID0gcHhtX3RvX25v
ZGUocmhzYS0+cHJveGltaXR5X2RvbWFpbik7CisKKyAgICAgICAgaWYgKCAhKGlvbW11LT5yb290
X21hZGRyID0gYWxsb2NfcGd0YWJsZV9tYWRkcigxLCBpb21tdS0+aW50ZWwtPm5vZGUpKSApCisg
ICAgICAgICAgICByZXQgPSAtRU5PTUVNOworICAgIH0KKwogICAgIGlmICggIXJldCApCiAgICAg
ewogICAgICAgICBpb21tdV9pbml0X29wcyA9ICZpbnRlbF9pb21tdV9pbml0X29wczsKLS0tIGEv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2V4dGVybi5oCisrKyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL3Z0ZC9leHRlcm4uaApAQCAtNzMsNyArNzMsNyBAQCB1bnNpZ25lZCBpbnQgZ2V0
X2NhY2hlX2xpbmVfc2l6ZSh2b2lkKTsKIHZvaWQgY2FjaGVsaW5lX2ZsdXNoKGNoYXIgKik7CiB2
b2lkIGZsdXNoX2FsbF9jYWNoZSh2b2lkKTsKIAotdTY0IGFsbG9jX3BndGFibGVfbWFkZHIoc3Ry
dWN0IGFjcGlfZHJoZF91bml0ICpkcmhkLCB1bnNpZ25lZCBsb25nIG5wYWdlcyk7Cit1aW50NjRf
dCBhbGxvY19wZ3RhYmxlX21hZGRyKHVuc2lnbmVkIGxvbmcgbnBhZ2VzLCBub2RlaWRfdCBub2Rl
KTsKIHZvaWQgZnJlZV9wZ3RhYmxlX21hZGRyKHU2NCBtYWRkcik7CiB2b2lkICptYXBfdnRkX2Rv
bWFpbl9wYWdlKHU2NCBtYWRkcik7CiB2b2lkIHVubWFwX3Z0ZF9kb21haW5fcGFnZSh2b2lkICp2
YSk7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pbnRyZW1hcC5jCisrKyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pbnRyZW1hcC5jCkBAIC03OTUsOCArNzk1LDggQEAg
aW50IGVuYWJsZV9pbnRyZW1hcChzdHJ1Y3QgaW9tbXUgKmlvbW11LAogCiAgICAgaWYgKCBpcl9j
dHJsLT5pcmVtYXBfbWFkZHIgPT0gMCApCiAgICAgewotICAgICAgICBpcl9jdHJsLT5pcmVtYXBf
bWFkZHIgPSBhbGxvY19wZ3RhYmxlX21hZGRyKGlvbW11LT5pbnRlbC0+ZHJoZCwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJUkVNQVBfQVJDSF9Q
QUdFX05SKTsKKyAgICAgICAgaXJfY3RybC0+aXJlbWFwX21hZGRyID0gYWxsb2NfcGd0YWJsZV9t
YWRkcihJUkVNQVBfQVJDSF9QQUdFX05SLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbnRlbC0+bm9kZSk7CiAgICAgICAgIGlmICgg
aXJfY3RybC0+aXJlbWFwX21hZGRyID09IDAgKQogICAgICAgICB7CiAgICAgICAgICAgICBkcHJp
bnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWCwKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMK
QEAgLTE4NCwxOCArMTg0LDEyIEBAIHZvaWQgaW9tbXVfZmx1c2hfY2FjaGVfcGFnZSh2b2lkICph
ZGRyLAogfQogCiAvKiBBbGxvY2F0ZSBwYWdlIHRhYmxlLCByZXR1cm4gaXRzIG1hY2hpbmUgYWRk
cmVzcyAqLwotdTY0IGFsbG9jX3BndGFibGVfbWFkZHIoc3RydWN0IGFjcGlfZHJoZF91bml0ICpk
cmhkLCB1bnNpZ25lZCBsb25nIG5wYWdlcykKK3VpbnQ2NF90IGFsbG9jX3BndGFibGVfbWFkZHIo
dW5zaWduZWQgbG9uZyBucGFnZXMsIG5vZGVpZF90IG5vZGUpCiB7Ci0gICAgc3RydWN0IGFjcGlf
cmhzYV91bml0ICpyaHNhOwogICAgIHN0cnVjdCBwYWdlX2luZm8gKnBnLCAqY3VyX3BnOwogICAg
IHU2NCAqdmFkZHI7Ci0gICAgbm9kZWlkX3Qgbm9kZSA9IE5VTUFfTk9fTk9ERTsKICAgICB1bnNp
Z25lZCBpbnQgaTsKIAotICAgIHJoc2EgPSBkcmhkX3RvX3Joc2EoZHJoZCk7Ci0gICAgaWYgKCBy
aHNhICkKLSAgICAgICAgbm9kZSA9ICBweG1fdG9fbm9kZShyaHNhLT5wcm94aW1pdHlfZG9tYWlu
KTsKLQogICAgIHBnID0gYWxsb2NfZG9taGVhcF9wYWdlcyhOVUxMLCBnZXRfb3JkZXJfZnJvbV9w
YWdlcyhucGFnZXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAobm9kZSA9PSBOVU1B
X05PX05PREUpID8gMCA6IE1FTUZfbm9kZShub2RlKSk7CiAgICAgaWYgKCAhcGcgKQpAQCAtMjMy
LDcgKzIyNiw3IEBAIHN0YXRpYyB1NjQgYnVzX3RvX2NvbnRleHRfbWFkZHIoc3RydWN0IGkKICAg
ICByb290ID0gJnJvb3RfZW50cmllc1tidXNdOwogICAgIGlmICggIXJvb3RfcHJlc2VudCgqcm9v
dCkgKQogICAgIHsKLSAgICAgICAgbWFkZHIgPSBhbGxvY19wZ3RhYmxlX21hZGRyKGlvbW11LT5p
bnRlbC0+ZHJoZCwgMSk7CisgICAgICAgIG1hZGRyID0gYWxsb2NfcGd0YWJsZV9tYWRkcigxLCBp
b21tdS0+aW50ZWwtPm5vZGUpOwogICAgICAgICBpZiAoIG1hZGRyID09IDAgKQogICAgICAgICB7
CiAgICAgICAgICAgICB1bm1hcF92dGRfZG9tYWluX3BhZ2Uocm9vdF9lbnRyaWVzKTsKQEAgLTI0
OSw4ICsyNDMsNiBAQCBzdGF0aWMgdTY0IGJ1c190b19jb250ZXh0X21hZGRyKHN0cnVjdCBpCiAK
IHN0YXRpYyB1NjQgYWRkcl90b19kbWFfcGFnZV9tYWRkcihzdHJ1Y3QgZG9tYWluICpkb21haW4s
IHU2NCBhZGRyLCBpbnQgYWxsb2MpCiB7Ci0gICAgc3RydWN0IGFjcGlfZHJoZF91bml0ICpkcmhk
OwotICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2OwogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhk
ID0gZG9tX2lvbW11KGRvbWFpbik7CiAgICAgaW50IGFkZHJfd2lkdGggPSBhZ2F3X3RvX3dpZHRo
KGhkLT5hcmNoLmFnYXcpOwogICAgIHN0cnVjdCBkbWFfcHRlICpwYXJlbnQsICpwdGUgPSBOVUxM
OwpAQCAtMjYwLDE3ICsyNTIsMTAgQEAgc3RhdGljIHU2NCBhZGRyX3RvX2RtYV9wYWdlX21hZGRy
KHN0cnVjdAogCiAgICAgYWRkciAmPSAoKCh1NjQpMSkgPDwgYWRkcl93aWR0aCkgLSAxOwogICAg
IEFTU0VSVChzcGluX2lzX2xvY2tlZCgmaGQtPmFyY2gubWFwcGluZ19sb2NrKSk7Ci0gICAgaWYg
KCBoZC0+YXJjaC5wZ2RfbWFkZHIgPT0gMCApCi0gICAgewotICAgICAgICAvKgotICAgICAgICAg
KiBqdXN0IGdldCBhbnkgcGFzc3Rocm91Z2ggZGV2aWNlIGluIHRoZSBkb21haW5yIC0gYXNzdW1l
IHVzZXIKLSAgICAgICAgICogYXNzaWducyBvbmx5IGRldmljZXMgZnJvbSBzYW1lIG5vZGUgdG8g
YSBnaXZlbiBndWVzdC4KLSAgICAgICAgICovCi0gICAgICAgIHBkZXYgPSBwY2lfZ2V0X3BkZXZf
YnlfZG9tYWluKGRvbWFpbiwgLTEsIC0xLCAtMSk7Ci0gICAgICAgIGRyaGQgPSBhY3BpX2ZpbmRf
bWF0Y2hlZF9kcmhkX3VuaXQocGRldik7Ci0gICAgICAgIGlmICggIWFsbG9jIHx8ICgoaGQtPmFy
Y2gucGdkX21hZGRyID0gYWxsb2NfcGd0YWJsZV9tYWRkcihkcmhkLCAxKSkgPT0gMCkgKQotICAg
ICAgICAgICAgZ290byBvdXQ7Ci0gICAgfQorICAgIGlmICggIWhkLT5hcmNoLnBnZF9tYWRkciAm
JgorICAgICAgICAgKCFhbGxvYyB8fAorICAgICAgICAgICgoaGQtPmFyY2gucGdkX21hZGRyID0g
YWxsb2NfcGd0YWJsZV9tYWRkcigxLCBoZC0+bm9kZSkpID09IDApKSApCisgICAgICAgIGdvdG8g
b3V0OwogCiAgICAgcGFyZW50ID0gKHN0cnVjdCBkbWFfcHRlICopbWFwX3Z0ZF9kb21haW5fcGFn
ZShoZC0+YXJjaC5wZ2RfbWFkZHIpOwogICAgIHdoaWxlICggbGV2ZWwgPiAxICkKQEAgLTI4NCw5
ICsyNjksNyBAQCBzdGF0aWMgdTY0IGFkZHJfdG9fZG1hX3BhZ2VfbWFkZHIoc3RydWN0CiAgICAg
ICAgICAgICBpZiAoICFhbGxvYyApCiAgICAgICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAg
ICAgIHBkZXYgPSBwY2lfZ2V0X3BkZXZfYnlfZG9tYWluKGRvbWFpbiwgLTEsIC0xLCAtMSk7Ci0g
ICAgICAgICAgICBkcmhkID0gYWNwaV9maW5kX21hdGNoZWRfZHJoZF91bml0KHBkZXYpOwotICAg
ICAgICAgICAgcHRlX21hZGRyID0gYWxsb2NfcGd0YWJsZV9tYWRkcihkcmhkLCAxKTsKKyAgICAg
ICAgICAgIHB0ZV9tYWRkciA9IGFsbG9jX3BndGFibGVfbWFkZHIoMSwgaGQtPm5vZGUpOwogICAg
ICAgICAgICAgaWYgKCAhcHRlX21hZGRyICkKICAgICAgICAgICAgICAgICBicmVhazsKIApAQCAt
MTE5MCwxMSArMTE3Myw5IEBAIGludCBfX2luaXQgaW9tbXVfYWxsb2Moc3RydWN0IGFjcGlfZHJo
ZF8KICAgICAgICAgcmV0dXJuIC1FTk9NRU07CiAgICAgfQogICAgIGlvbW11LT5pbnRlbC0+ZHJo
ZCA9IGRyaGQ7CisgICAgaW9tbXUtPmludGVsLT5ub2RlID0gTlVNQV9OT19OT0RFOwogICAgIGRy
aGQtPmlvbW11ID0gaW9tbXU7CiAKLSAgICBpZiAoICEoaW9tbXUtPnJvb3RfbWFkZHIgPSBhbGxv
Y19wZ3RhYmxlX21hZGRyKGRyaGQsIDEpKSApCi0gICAgICAgIHJldHVybiAtRU5PTUVNOwotCiAg
ICAgaW9tbXUtPnJlZyA9IGlvcmVtYXAoZHJoZC0+YWRkcmVzcywgUEFHRV9TSVpFKTsKICAgICBp
ZiAoICFpb21tdS0+cmVnICkKICAgICAgICAgcmV0dXJuIC1FTk9NRU07CkBAIC0xNDg4LDYgKzE0
NjksMTcgQEAgc3RhdGljIGludCBkb21haW5fY29udGV4dF9tYXBwaW5nKHN0cnVjdAogICAgIGlm
ICggIWRyaGQgKQogICAgICAgICByZXR1cm4gLUVOT0RFVjsKIAorICAgIC8qCisgICAgICogR2Vu
ZXJhbGx5IHdlIGFzc3VtZSBvbmx5IGRldmljZXMgZnJvbSBvbmUgbm9kZSB0byBnZXQgYXNzaWdu
ZWQgdG8gYQorICAgICAqIGdpdmVuIGd1ZXN0LiAgQnV0IGV2ZW4gaWYgbm90LCBieSByZXBsYWNp
bmcgdGhlIHByaW9yIHZhbHVlIGhlcmUgd2UKKyAgICAgKiBndWFyYW50ZWUgdGhhdCBhdCBsZWFz
dCBzb21lIGJhc2ljIGFsbG9jYXRpb25zIGZvciB0aGUgZGV2aWNlIGJlaW5nCisgICAgICogYWRk
ZWQgd2lsbCBnZXQgZG9uZSBhZ2FpbnN0IGl0cyBub2RlLiAgQW55IGZ1cnRoZXIgYWxsb2NhdGlv
bnMgZm9yCisgICAgICogdGhpcyBvciBvdGhlciBkZXZpY2VzIG1heSBiZSBwZW5hbGl6ZWQgdGhl
biwgYnV0IHNvbWUgd291bGQgYWxzbyBiZQorICAgICAqIGlmIHdlIGxlZnQgb3RoZXIgdGhhbiBO
VU1BX05PX05PREUgdW50b3VjaGVkIGhlcmUuCisgICAgICovCisgICAgaWYgKCBkcmhkLT5pb21t
dS0+aW50ZWwtPm5vZGUgIT0gTlVNQV9OT19OT0RFICkKKyAgICAgICAgZG9tX2lvbW11KGRvbWFp
biktPm5vZGUgPSBkcmhkLT5pb21tdS0+aW50ZWwtPm5vZGU7CisKICAgICBBU1NFUlQocGNpZGV2
c19sb2NrZWQoKSk7CiAKICAgICBzd2l0Y2ggKCBwZGV2LT50eXBlICkKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmgKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
dnRkL2lvbW11LmgKQEAgLTUzMCw2ICs1MzAsNyBAQCBzdHJ1Y3QgaW50ZWxfaW9tbXUgewogICAg
IHN0cnVjdCBpcl9jdHJsIGlyX2N0cmw7CiAgICAgc3RydWN0IGlvbW11X2ZsdXNoIGZsdXNoOwog
ICAgIHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZDsKKyAgICBub2RlaWRfdCBub2RlOwogfTsK
IAogc3RydWN0IGlvbW11IHsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZh
bC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtNDE1LDgg
KzQxNSw4IEBAIGludCBlbmFibGVfcWludmFsKHN0cnVjdCBpb21tdSAqaW9tbXUpCiAKICAgICBp
ZiAoIHFpX2N0cmwtPnFpbnZhbF9tYWRkciA9PSAwICkKICAgICB7Ci0gICAgICAgIHFpX2N0cmwt
PnFpbnZhbF9tYWRkciA9IGFsbG9jX3BndGFibGVfbWFkZHIoaW9tbXUtPmludGVsLT5kcmhkLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFFJTlZB
TF9BUkNIX1BBR0VfTlIpOworICAgICAgICBxaV9jdHJsLT5xaW52YWxfbWFkZHIgPSBhbGxvY19w
Z3RhYmxlX21hZGRyKFFJTlZBTF9BUkNIX1BBR0VfTlIsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9tbXUtPmludGVsLT5ub2RlKTsKICAgICAg
ICAgaWYgKCBxaV9jdHJsLT5xaW52YWxfbWFkZHIgPT0gMCApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIGRwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklYLAotLS0gYS94ZW4vaW5jbHVkZS94
ZW4vaW9tbXUuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vaW9tbXUuaApAQCAtMjY2LDYgKzI2Niwx
MSBAQCBzdHJ1Y3QgZG9tYWluX2lvbW11IHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGR0X2Rldmlj
ZXM7CiAjZW5kaWYKIAorI2lmZGVmIENPTkZJR19OVU1BCisgICAgLyogTlVNQSBub2RlIHRvIGRv
IElPTU1VIHJlbGF0ZWQgYWxsb2NhdGlvbnMgYWdhaW5zdC4gKi8KKyAgICBub2RlaWRfdCBub2Rl
OworI2VuZGlmCisKICAgICAvKiBGZWF0dXJlcyBzdXBwb3J0ZWQgYnkgdGhlIElPTU1VICovCiAg
ICAgREVDTEFSRV9CSVRNQVAoZmVhdHVyZXMsIElPTU1VX0ZFQVRfY291bnQpOwogCgoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxp
bmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5w
cm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

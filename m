Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 45FDDFE603
	for <lists+xen-devel@lfdr.de>; Fri, 15 Nov 2019 20:49:09 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVhYM-0002WS-2Q; Fri, 15 Nov 2019 19:46:46 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=1SQg=ZH=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iVhYK-0002VC-Ir
 for xen-devel@lists.xenproject.org; Fri, 15 Nov 2019 19:46:44 +0000
X-Inumbo-ID: 782813be-07e0-11ea-9631-bc764e2007e4
Received: from mail-qv1-xf42.google.com (unknown [2607:f8b0:4864:20::f42])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 782813be-07e0-11ea-9631-bc764e2007e4;
 Fri, 15 Nov 2019 19:45:25 +0000 (UTC)
Received: by mail-qv1-xf42.google.com with SMTP id cv8so4073028qvb.3
 for <xen-devel@lists.xenproject.org>; Fri, 15 Nov 2019 11:45:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=4CdgW+17WzqpQebBvw4AhmE1ljHoYYYW3hRrcGWwnfs=;
 b=ZIxmCdVxOchoQ9RMYE/HhoEwVGqeMO8UnT3bTMnhzgXMEo/eCrlqp14cdB/s0EWvdk
 eEq0cHiP5nKsktbhKQlDX3JwB7mbgXdd7G90eLB7E2FhXOJSUOzLyMJaa9SXNIX6ccdZ
 rKou8lAnxo9FcoTov8nXH/9Jl6Biyg3rUGdL73KO/N1l+nuRSTtcZU0vK+ISRLAZuNaO
 SXmGSsdufnAi0GLzp2ljY04br99Vvvv7gHvgt0NVnenFvTEDRvWrM9h5Z2rm4Z7tNh1R
 mMhq8930idl1OrD+x7vurrH6g+wvWw+uO0o4Ne8QXk/9W+4o/UxbAVVvaQOzXXxwAdGQ
 szFg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=4CdgW+17WzqpQebBvw4AhmE1ljHoYYYW3hRrcGWwnfs=;
 b=YRES5Eo6puheO0mJ/5/wr4vTDyNfWWu8yZKiYReS0RwhtZUUI5Po+hM29bi/VP525O
 0srYAWoY6vAm1jPcmJVhzAZCUEMDa86jAF7kP7fBOD8tT3+znVyeI6069/m4UyGez8DD
 Ui/+1QFURj/i9EAW7w5m5d8mzVMxjIU3Z0GSaVKu4nFQP8YR/hdYLE17sRGOE1JfGFAT
 YN/oacWExIh22NtWETgp03AgEgr32tOjtoTQggIVdTEEFORcBimELS/aPsgd7lzXwbhQ
 vXaytUB7ILNs9MSopESYOKy2TiA6P5zWPuJzc/2U9AkekmSNjlIs1Tvi79ODIk3SBEKA
 yNzQ==
X-Gm-Message-State: APjAAAVnp9IKwh7NoO7E954v4ZF4rJQfGwGELHmgHPlERiMxJmviSn+N
 zTC694hK4/s6DgonGYaTdhFpgxmr
X-Google-Smtp-Source: APXvYqxWOlN2p7/kn+7ISk7bptjCSTzbtdQ0UOr1jnLa83QJL5fHNEH/j9HBvsQydtfjw3G7QEP4Tw==
X-Received: by 2002:a0c:fa87:: with SMTP id o7mr14796111qvn.209.1573847124986; 
 Fri, 15 Nov 2019 11:45:24 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id y10sm4649679qkb.55.2019.11.15.11.45.23
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 15 Nov 2019 11:45:23 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 15 Nov 2019 14:44:28 -0500
Message-Id: <dcbde6401c5efae96722a67bd254ece104a336e0.1573840474.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1573840473.git.rosbrookn@ainfosec.com>
References: <cover.1573840473.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 21/22] golang/xenlight: revise use of Context
 type
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClJlbW92ZSB0aGUg
ZXhwb3J0ZWQgZ2xvYmFsIGNvbnRleHQgdmFyaWFibGUsICdDdHguJyBHZW5lcmFsbHksIGl0IGlz
CmJldHRlciB0byBub3QgZXhwb3J0IGdsb2JhbCB2YXJpYWJsZXMgZm9yIHVzZSB0aHJvdWdoIGEg
R28gcGFja2FnZS4KSG93ZXZlciwgdGhlcmUgYXJlIHNvbWUgZXhjZXB0aW9ucyB0aGF0IGNhbiBi
ZSBmb3VuZCBpbiB0aGUgc3RhbmRhcmQKbGlicmFyeS4KCkFkZCBhIE5ld0NvbnRleHQgZnVuY3Rp
b24gaW5zdGVhZCwgYW5kIHJlbW92ZSB0aGUgT3BlbiwgSXNPcGVuLCBhbmQKQ2hlY2tPcGVuIGZ1
bmN0aW9ucyBhcyBhIHJlc3VsdC4KCkFsc28sIGNvbW1lbnQtb3V0IGFuIGluZWZmZWN0dWFsIGFz
c2lnbm1lbnQgdG8gJ2VycicgaW5zaWRlIHRoZSBmdW5jdGlvbgpDb250ZXh0LkNwdXBvb2xJbmZv
IHNvIHRoYXQgY29tcGlsYXRpb24gZG9lcyBub3QgZmFpbC4KClNpZ25lZC1vZmYtYnk6IE5pY2sg
Um9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L3hlbmxpZ2h0LmdvIHwgMjE5ICsrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDM0IGluc2VydGlvbnMoKyksIDE4NSBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS90b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28gYi90b29scy9nb2xhbmcveGVu
bGlnaHQveGVubGlnaHQuZ28KaW5kZXggMjEwYTQxOGMwMi4uNGUxMmNlYmFjMSAxMDA2NDQKLS0t
IGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hlbmxpZ2h0LmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94
ZW5saWdodC94ZW5saWdodC5nbwpAQCAtNzQsNiArNzQsMzkgQEAgZnVuYyAoZSBFcnJvcikgRXJy
b3IoKSBzdHJpbmcgewogCXJldHVybiBmbXQuU3ByaW50ZigibGlieGwgZXJyb3I6ICVkIiwgLWUp
CiB9CiAKKy8vIENvbnRleHQgcmVwcmVzZW50cyBhIGxpYnhsX2N0eC4KK3R5cGUgQ29udGV4dCBz
dHJ1Y3QgeworCWN0eCAgICAqQy5saWJ4bF9jdHgKKwlsb2dnZXIgKkMueGVudG9vbGxvZ19sb2dn
ZXJfc3RkaW9zdHJlYW0KK30KKworLy8gTmV3Q29udGV4dCByZXR1cm5zIGEgbmV3IENvbnRleHQu
CitmdW5jIE5ld0NvbnRleHQoKSAoKkNvbnRleHQsIGVycm9yKSB7CisJdmFyIGN0eCBDb250ZXh0
CisKKwljdHgubG9nZ2VyID0gQy54dGxfY3JlYXRlbG9nZ2VyX3N0ZGlvc3RyZWFtKEMuc3RkZXJy
LCBDLlhUTF9FUlJPUiwgMCkKKworCXJldCA6PSBDLmxpYnhsX2N0eF9hbGxvYygmY3R4LmN0eCwg
Qy5MSUJYTF9WRVJTSU9OLCAwLCAoKkMueGVudG9vbGxvZ19sb2dnZXIpKHVuc2FmZS5Qb2ludGVy
KGN0eC5sb2dnZXIpKSkKKwlpZiByZXQgIT0gMCB7CisJCXJldHVybiBuaWwsIEVycm9yKHJldCkK
Kwl9CisKKwlyZXR1cm4gJmN0eCwgbmlsCit9CisKKy8vIENsb3NlIGNsb3NlcyB0aGUgQ29udGV4
dC4KK2Z1bmMgKGN0eCAqQ29udGV4dCkgQ2xvc2UoKSBlcnJvciB7CisJcmV0IDo9IEMubGlieGxf
Y3R4X2ZyZWUoY3R4LmN0eCkKKwljdHguY3R4ID0gbmlsCisJQy54dGxfbG9nZ2VyX2Rlc3Ryb3ko
KCpDLnhlbnRvb2xsb2dfbG9nZ2VyKSh1bnNhZmUuUG9pbnRlcihjdHgubG9nZ2VyKSkpCisKKwlp
ZiByZXQgIT0gMCB7CisJCXJldHVybiBFcnJvcihyZXQpCisJfQorCisJcmV0dXJuIG5pbAorfQor
CiAvKgogICogVHlwZXM6IEJ1aWx0aW5zCiAgKi8KQEAgLTMwNCwxMSArMzM3LDYgQEAgZnVuYyAo
Y3BsIENwdWlkUG9saWN5TGlzdCkgdG9DKCkgKEMubGlieGxfY3B1aWRfcG9saWN5X2xpc3QsIGVy
cm9yKSB7CiAJcmV0dXJuIGNjcGwsIG5pbAogfQogCi10eXBlIENvbnRleHQgc3RydWN0IHsKLQlj
dHggICAgKkMubGlieGxfY3R4Ci0JbG9nZ2VyICpDLnhlbnRvb2xsb2dfbG9nZ2VyX3N0ZGlvc3Ry
ZWFtCi19Ci0KIC8vIEh3Y2FwIHJlcHJlc2VudHMgYSBsaWJ4bF9od2NhcC4KIHR5cGUgSHdjYXAg
WzhddWludDMyCiAKQEAgLTQ2MywxMSArNDkxLDYgQEAgZnVuYyBTY2hlZHVsZXJGcm9tU3RyaW5n
KG5hbWUgc3RyaW5nKSAocyBTY2hlZHVsZXIsIGVyciBlcnJvcikgewogLy8gbGlieGxfY3B1cG9v
bGluZm8gKiBsaWJ4bF9saXN0X2NwdXBvb2wobGlieGxfY3R4KiwgaW50ICpuYl9wb29sX291dCk7
CiAvLyB2b2lkIGxpYnhsX2NwdXBvb2xpbmZvX2xpc3RfZnJlZShsaWJ4bF9jcHVwb29saW5mbyAq
bGlzdCwgaW50IG5iX3Bvb2wpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBMaXN0Q3B1cG9vbCgpIChs
aXN0IFtdQ3B1cG9vbGluZm8pIHsKLQllcnIgOj0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9
IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCXZhciBuYlBvb2wgQy5pbnQKIAogCWNfY3B1cG9vbF9s
aXN0IDo9IEMubGlieGxfbGlzdF9jcHVwb29sKEN0eC5jdHgsICZuYlBvb2wpCkBAIC00OTEsMTYg
KzUxNCwxMSBAQCBmdW5jIChDdHggKkNvbnRleHQpIExpc3RDcHVwb29sKCkgKGxpc3QgW11DcHVw
b29saW5mbykgewogCiAvLyBpbnQgbGlieGxfY3B1cG9vbF9pbmZvKGxpYnhsX2N0eCAqY3R4LCBs
aWJ4bF9jcHVwb29saW5mbyAqaW5mbywgdWludDMyX3QgcG9vbGlkKTsKIGZ1bmMgKEN0eCAqQ29u
dGV4dCkgQ3B1cG9vbEluZm8oUG9vbGlkIHVpbnQzMikgKHBvb2wgQ3B1cG9vbGluZm8pIHsKLQll
cnIgOj0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQog
CXZhciBjX2NwdXBvb2wgQy5saWJ4bF9jcHVwb29saW5mbwogCiAJcmV0IDo9IEMubGlieGxfY3B1
cG9vbF9pbmZvKEN0eC5jdHgsICZjX2NwdXBvb2wsIEMudWludDMyX3QoUG9vbGlkKSkKIAlpZiBy
ZXQgIT0gMCB7Ci0JCWVyciA9IEVycm9yKC1yZXQpCisJCS8vZXJyID0gRXJyb3IoLXJldCkKIAkJ
cmV0dXJuCiAJfQogCWRlZmVyIEMubGlieGxfY3B1cG9vbGluZm9fZGlzcG9zZSgmY19jcHVwb29s
KQpAQCAtNTE3LDExICs1MzUsNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xJbmZvKFBv
b2xpZCB1aW50MzIpIChwb29sIENwdXBvb2xpbmZvKSB7CiAvLyBGSVhNRTogdXVpZAogLy8gRklY
TUU6IFNldHRpbmcgcG9vbGlkCiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcmVhdGUoTmFt
ZSBzdHJpbmcsIFNjaGVkdWxlciBTY2hlZHVsZXIsIENwdW1hcCBCaXRtYXApIChlcnIgZXJyb3Is
IFBvb2xpZCB1aW50MzIpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuCi0JfQotCiAJcG9vbGlkIDo9IEMudWludDMyX3QoQy5MSUJYTF9DUFVQT09M
X1BPT0xJRF9BTlkpCiAJbmFtZSA6PSBDLkNTdHJpbmcoTmFtZSkKIAlkZWZlciBDLmZyZWUodW5z
YWZlLlBvaW50ZXIobmFtZSkpCkBAIC01NTAsMTEgKzU2Myw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4
dCkgQ3B1cG9vbENyZWF0ZShOYW1lIHN0cmluZywgU2NoZWR1bGVyIFNjaGVkdWxlciwgQ3B1bWFw
IEJpdG1hCiAKIC8vIGludCBsaWJ4bF9jcHVwb29sX2Rlc3Ryb3kobGlieGxfY3R4ICpjdHgsIHVp
bnQzMl90IHBvb2xpZCk7CiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xEZXN0cm95KFBvb2xp
ZCB1aW50MzIpIChlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIg
IT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfY3B1cG9vbF9kZXN0cm95
KEN0eC5jdHgsIEMudWludDMyX3QoUG9vbGlkKSkKIAlpZiByZXQgIT0gMCB7CiAJCWVyciA9IEVy
cm9yKC1yZXQpCkBAIC01NjYsMTEgKzU3NCw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9v
bERlc3Ryb3koUG9vbGlkIHVpbnQzMikgKGVyciBlcnJvcikgewogCiAvLyBpbnQgbGlieGxfY3B1
cG9vbF9jcHVhZGQobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IHBvb2xpZCwgaW50IGNwdSk7CiBm
dW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcHVhZGQoUG9vbGlkIHVpbnQzMiwgQ3B1IGludCkg
KGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBuaWwgewot
CQlyZXR1cm4KLQl9Ci0KIAlyZXQgOj0gQy5saWJ4bF9jcHVwb29sX2NwdWFkZChDdHguY3R4LCBD
LnVpbnQzMl90KFBvb2xpZCksIEMuaW50KENwdSkpCiAJaWYgcmV0ICE9IDAgewogCQllcnIgPSBF
cnJvcigtcmV0KQpAQCAtNTgzLDExICs1ODYsNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIENwdXBv
b2xDcHVhZGQoUG9vbGlkIHVpbnQzMiwgQ3B1IGludCkgKGVyciBlcnJvcikgewogLy8gaW50IGxp
YnhsX2NwdXBvb2xfY3B1YWRkX2NwdW1hcChsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgcG9vbGlk
LAogLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9iaXRtYXAg
KmNwdW1hcCk7CiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcHVhZGRDcHVtYXAoUG9vbGlk
IHVpbnQzMiwgQ3B1bWFwIEJpdG1hcCkgKGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09w
ZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAljYm0sIGVyciA6PSBDcHVt
YXAudG9DKCkKIAlpZiBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuCkBAIC02MDUsMTEgKzYwMyw2IEBA
IGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbENwdWFkZENwdW1hcChQb29saWQgdWludDMyLCBD
cHVtYXAgQml0bWFwKSAoZXJyIGVycm9yCiAKIC8vIGludCBsaWJ4bF9jcHVwb29sX2NwdXJlbW92
ZShsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgcG9vbGlkLCBpbnQgY3B1KTsKIGZ1bmMgKEN0eCAq
Q29udGV4dCkgQ3B1cG9vbENwdXJlbW92ZShQb29saWQgdWludDMyLCBDcHUgaW50KSAoZXJyIGVy
cm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVy
bgotCX0KLQogCXJldCA6PSBDLmxpYnhsX2NwdXBvb2xfY3B1cmVtb3ZlKEN0eC5jdHgsIEMudWlu
dDMyX3QoUG9vbGlkKSwgQy5pbnQoQ3B1KSkKIAlpZiByZXQgIT0gMCB7CiAJCWVyciA9IEVycm9y
KC1yZXQpCkBAIC02MjIsMTEgKzYxNSw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbENw
dXJlbW92ZShQb29saWQgdWludDMyLCBDcHUgaW50KSAoZXJyIGVycm9yKSB7CiAvLyBpbnQgbGli
eGxfY3B1cG9vbF9jcHVyZW1vdmVfY3B1bWFwKGxpYnhsX2N0eCAqY3R4LCB1aW50MzJfdCBwb29s
aWQsCiAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpYnhsX2Jp
dG1hcCAqY3B1bWFwKTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbENwdXJlbW92ZUNwdW1h
cChQb29saWQgdWludDMyLCBDcHVtYXAgQml0bWFwKSAoZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4
LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCWNibSwgZXJy
IDo9IENwdW1hcC50b0MoKQogCWlmIGVyciAhPSBuaWwgewogCQlyZXR1cm4KQEAgLTY0NCwxMSAr
NjMyLDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBDcHVwb29sQ3B1cmVtb3ZlQ3B1bWFwKFBvb2xp
ZCB1aW50MzIsIENwdW1hcCBCaXRtYXApIChlcnIgZXIKIAogLy8gaW50IGxpYnhsX2NwdXBvb2xf
cmVuYW1lKGxpYnhsX2N0eCAqY3R4LCBjb25zdCBjaGFyICpuYW1lLCB1aW50MzJfdCBwb29saWQp
OwogZnVuYyAoQ3R4ICpDb250ZXh0KSBDcHVwb29sUmVuYW1lKE5hbWUgc3RyaW5nLCBQb29saWQg
dWludDMyKSAoZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9
IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCW5hbWUgOj0gQy5DU3RyaW5nKE5hbWUpCiAJZGVmZXIg
Qy5mcmVlKHVuc2FmZS5Qb2ludGVyKG5hbWUpKQogCkBAIC02NjMsMTEgKzY0Niw2IEBAIGZ1bmMg
KEN0eCAqQ29udGV4dCkgQ3B1cG9vbFJlbmFtZShOYW1lIHN0cmluZywgUG9vbGlkIHVpbnQzMikg
KGVyciBlcnJvcikgewogCiAvLyBpbnQgbGlieGxfY3B1cG9vbF9jcHVhZGRfbm9kZShsaWJ4bF9j
dHggKmN0eCwgdWludDMyX3QgcG9vbGlkLCBpbnQgbm9kZSwgaW50ICpjcHVzKTsKIGZ1bmMgKEN0
eCAqQ29udGV4dCkgQ3B1cG9vbENwdWFkZE5vZGUoUG9vbGlkIHVpbnQzMiwgTm9kZSBpbnQpIChD
cHVzIGludCwgZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9
IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCWNjcHVzIDo9IEMuaW50KDApCiAKIAlyZXQgOj0gQy5s
aWJ4bF9jcHVwb29sX2NwdWFkZF9ub2RlKEN0eC5jdHgsIEMudWludDMyX3QoUG9vbGlkKSwgQy5p
bnQoTm9kZSksICZjY3B1cykKQEAgLTY4MywxMSArNjYxLDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0
KSBDcHVwb29sQ3B1YWRkTm9kZShQb29saWQgdWludDMyLCBOb2RlIGludCkgKENwdXMgaW50LCBl
cnIgZXIKIAogLy8gaW50IGxpYnhsX2NwdXBvb2xfY3B1cmVtb3ZlX25vZGUobGlieGxfY3R4ICpj
dHgsIHVpbnQzMl90IHBvb2xpZCwgaW50IG5vZGUsIGludCAqY3B1cyk7CiBmdW5jIChDdHggKkNv
bnRleHQpIENwdXBvb2xDcHVyZW1vdmVOb2RlKFBvb2xpZCB1aW50MzIsIE5vZGUgaW50KSAoQ3B1
cyBpbnQsIGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBu
aWwgewotCQlyZXR1cm4KLQl9Ci0KIAljY3B1cyA6PSBDLmludCgwKQogCiAJcmV0IDo9IEMubGli
eGxfY3B1cG9vbF9jcHVyZW1vdmVfbm9kZShDdHguY3R4LCBDLnVpbnQzMl90KFBvb2xpZCksIEMu
aW50KE5vZGUpLCAmY2NwdXMpCkBAIC03MDMsMTEgKzY3Niw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4
dCkgQ3B1cG9vbENwdXJlbW92ZU5vZGUoUG9vbGlkIHVpbnQzMiwgTm9kZSBpbnQpIChDcHVzIGlu
dCwgZXJyCiAKIC8vIGludCBsaWJ4bF9jcHVwb29sX21vdmVkb21haW4obGlieGxfY3R4ICpjdHgs
IHVpbnQzMl90IHBvb2xpZCwgdWludDMyX3QgZG9taWQpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBD
cHVwb29sTW92ZWRvbWFpbihQb29saWQgdWludDMyLCBJZCBEb21pZCkgKGVyciBlcnJvcikgewot
CWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0K
IAlyZXQgOj0gQy5saWJ4bF9jcHVwb29sX21vdmVkb21haW4oQ3R4LmN0eCwgQy51aW50MzJfdChQ
b29saWQpLCBDLnVpbnQzMl90KElkKSkKIAlpZiByZXQgIT0gMCB7CiAJCWVyciA9IEVycm9yKC1y
ZXQpCkBAIC04NjcsNjAgKzgzNSw4IEBAIGZ1bmMgKGJtIEJpdG1hcCkgU3RyaW5nKCkgKHMgc3Ry
aW5nKSB7CiAJcmV0dXJuCiB9CiAKLS8qCi0gKiBDb250ZXh0Ci0gKi8KLXZhciBDdHggQ29udGV4
dAotCi1mdW5jIChDdHggKkNvbnRleHQpIElzT3BlbigpIGJvb2wgewotCXJldHVybiBDdHguY3R4
ICE9IG5pbAotfQotCi1mdW5jIChDdHggKkNvbnRleHQpIE9wZW4oKSAoZXJyIGVycm9yKSB7Ci0J
aWYgQ3R4LmN0eCAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KLQlDdHgubG9nZ2VyID0gQy54dGxf
Y3JlYXRlbG9nZ2VyX3N0ZGlvc3RyZWFtKEMuc3RkZXJyLCBDLlhUTF9FUlJPUiwgMCkKLQlpZiBD
dHgubG9nZ2VyID09IG5pbCB7Ci0JCWVyciA9IGZtdC5FcnJvcmYoIkNhbm5vdCBvcGVuIHN0ZGlv
c3RyZWFtIikKLQkJcmV0dXJuCi0JfQotCi0JcmV0IDo9IEMubGlieGxfY3R4X2FsbG9jKCZDdHgu
Y3R4LCBDLkxJQlhMX1ZFUlNJT04sCi0JCTAsICgqQy54ZW50b29sbG9nX2xvZ2dlcikodW5zYWZl
LlBvaW50ZXIoQ3R4LmxvZ2dlcikpKQotCi0JaWYgcmV0ICE9IDAgewotCQllcnIgPSBFcnJvcigt
cmV0KQotCX0KLQlyZXR1cm4KLX0KLQotZnVuYyAoQ3R4ICpDb250ZXh0KSBDbG9zZSgpIChlcnIg
ZXJyb3IpIHsKLQlyZXQgOj0gQy5saWJ4bF9jdHhfZnJlZShDdHguY3R4KQotCUN0eC5jdHggPSBu
aWwKLQotCWlmIHJldCAhPSAwIHsKLQkJZXJyID0gRXJyb3IoLXJldCkKLQl9Ci0JQy54dGxfbG9n
Z2VyX2Rlc3Ryb3koKCpDLnhlbnRvb2xsb2dfbG9nZ2VyKSh1bnNhZmUuUG9pbnRlcihDdHgubG9n
Z2VyKSkpCi0JcmV0dXJuCi19Ci0KLWZ1bmMgKEN0eCAqQ29udGV4dCkgQ2hlY2tPcGVuKCkgKGVy
ciBlcnJvcikgewotCWlmIEN0eC5jdHggPT0gbmlsIHsKLQkJZXJyID0gZm10LkVycm9yZigiQ29u
dGV4dCBub3Qgb3BlbmVkIikKLQl9Ci0JcmV0dXJuCi19Ci0KIC8vaW50IGxpYnhsX2dldF9tYXhf
Y3B1cyhsaWJ4bF9jdHggKmN0eCk7CiBmdW5jIChDdHggKkNvbnRleHQpIEdldE1heENwdXMoKSAo
bWF4Q3B1cyBpbnQsIGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVy
ciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAlyZXQgOj0gQy5saWJ4bF9nZXRfbWF4X2NwdXMo
Q3R4LmN0eCkKIAlpZiByZXQgPCAwIHsKIAkJZXJyID0gRXJyb3IoLXJldCkKQEAgLTkzMiwxMSAr
ODQ4LDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBHZXRNYXhDcHVzKCkgKG1heENwdXMgaW50LCBl
cnIgZXJyb3IpIHsKIAogLy9pbnQgbGlieGxfZ2V0X29ubGluZV9jcHVzKGxpYnhsX2N0eCAqY3R4
KTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgR2V0T25saW5lQ3B1cygpIChvbkNwdXMgaW50LCBlcnIg
ZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0
dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfZ2V0X29ubGluZV9jcHVzKEN0eC5jdHgpCiAJaWYg
cmV0IDwgMCB7CiAJCWVyciA9IEVycm9yKC1yZXQpCkBAIC05NDgsMTAgKzg1OSw2IEBAIGZ1bmMg
KEN0eCAqQ29udGV4dCkgR2V0T25saW5lQ3B1cygpIChvbkNwdXMgaW50LCBlcnIgZXJyb3IpIHsK
IAogLy9pbnQgbGlieGxfZ2V0X21heF9ub2RlcyhsaWJ4bF9jdHggKmN0eCk7CiBmdW5jIChDdHgg
KkNvbnRleHQpIEdldE1heE5vZGVzKCkgKG1heE5vZGVzIGludCwgZXJyIGVycm9yKSB7Ci0JZXJy
ID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KIAlyZXQg
Oj0gQy5saWJ4bF9nZXRfbWF4X25vZGVzKEN0eC5jdHgpCiAJaWYgcmV0IDwgMCB7CiAJCWVyciA9
IEVycm9yKC1yZXQpCkBAIC05NjMsMTAgKzg3MCw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgR2V0
TWF4Tm9kZXMoKSAobWF4Tm9kZXMgaW50LCBlcnIgZXJyb3IpIHsKIAogLy9pbnQgbGlieGxfZ2V0
X2ZyZWVfbWVtb3J5KGxpYnhsX2N0eCAqY3R4LCB1aW50NjRfdCAqbWVta2IpOwogZnVuYyAoQ3R4
ICpDb250ZXh0KSBHZXRGcmVlTWVtb3J5KCkgKG1lbWtiIHVpbnQ2NCwgZXJyIGVycm9yKSB7Ci0J
ZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KIAl2
YXIgY21lbSBDLnVpbnQ2NF90CiAJcmV0IDo9IEMubGlieGxfZ2V0X2ZyZWVfbWVtb3J5KEN0eC5j
dHgsICZjbWVtKQogCkBAIC05ODIsMTAgKzg4NSw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgR2V0
RnJlZU1lbW9yeSgpIChtZW1rYiB1aW50NjQsIGVyciBlcnJvcikgewogCiAvL2ludCBsaWJ4bF9n
ZXRfcGh5c2luZm8obGlieGxfY3R4ICpjdHgsIGxpYnhsX3BoeXNpbmZvICpwaHlzaW5mbykKIGZ1
bmMgKEN0eCAqQ29udGV4dCkgR2V0UGh5c2luZm8oKSAocGh5c2luZm8gKlBoeXNpbmZvLCBlcnIg
ZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0
dXJuCi0JfQogCXZhciBjcGh5cyBDLmxpYnhsX3BoeXNpbmZvCiAJQy5saWJ4bF9waHlzaW5mb19p
bml0KCZjcGh5cykKIAlkZWZlciBDLmxpYnhsX3BoeXNpbmZvX2Rpc3Bvc2UoJmNwaHlzKQpAQCAt
MTAwMywxMSArOTAyLDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBHZXRQaHlzaW5mbygpIChwaHlz
aW5mbyAqUGh5c2luZm8sIGVyciBlcnJvcikgewogCiAvL2NvbnN0IGxpYnhsX3ZlcnNpb25faW5m
byogbGlieGxfZ2V0X3ZlcnNpb25faW5mbyhsaWJ4bF9jdHggKmN0eCk7CiBmdW5jIChDdHggKkNv
bnRleHQpIEdldFZlcnNpb25JbmZvKCkgKGluZm8gKlZlcnNpb25JbmZvLCBlcnIgZXJyb3IpIHsK
LQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQot
CiAJdmFyIGNpbmZvICpDLmxpYnhsX3ZlcnNpb25faW5mbwogCiAJY2luZm8gPSBDLmxpYnhsX2dl
dF92ZXJzaW9uX2luZm8oQ3R4LmN0eCkKQEAgLTEwMTgsMTEgKzkxMiw2IEBAIGZ1bmMgKEN0eCAq
Q29udGV4dCkgR2V0VmVyc2lvbkluZm8oKSAoaW5mbyAqVmVyc2lvbkluZm8sIGVyciBlcnJvcikg
ewogfQogCiBmdW5jIChDdHggKkNvbnRleHQpIERvbWFpbkluZm8oSWQgRG9taWQpIChkaSAqRG9t
aW5mbywgZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5p
bCB7Ci0JCXJldHVybgotCX0KLQogCXZhciBjZGkgQy5saWJ4bF9kb21pbmZvCiAJQy5saWJ4bF9k
b21pbmZvX2luaXQoJmNkaSkKIAlkZWZlciBDLmxpYnhsX2RvbWluZm9fZGlzcG9zZSgmY2RpKQpA
QCAtMTA0MCwxMSArOTI5LDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBEb21haW5JbmZvKElkIERv
bWlkKSAoZGkgKkRvbWluZm8sIGVyciBlcnJvcikgewogfQogCiBmdW5jIChDdHggKkNvbnRleHQp
IERvbWFpblVucGF1c2UoSWQgRG9taWQpIChlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tP
cGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxf
ZG9tYWluX3VucGF1c2UoQ3R4LmN0eCwgQy51aW50MzJfdChJZCksIG5pbCkKIAogCWlmIHJldCAh
PSAwIHsKQEAgLTEwNTUsMTEgKzkzOSw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluVW5w
YXVzZShJZCBEb21pZCkgKGVyciBlcnJvcikgewogCiAvL2ludCBsaWJ4bF9kb21haW5fcGF1c2Uo
bGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IGRvbWFpbik7CiBmdW5jIChDdHggKkNvbnRleHQpIERv
bWFpblBhdXNlKGlkIERvbWlkKSAoZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3Blbigp
Ci0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCXJldCA6PSBDLmxpYnhsX2RvbWFp
bl9wYXVzZShDdHguY3R4LCBDLnVpbnQzMl90KGlkKSwgbmlsKQogCiAJaWYgcmV0ICE9IDAgewpA
QCAtMTA3MCwxMSArOTQ5LDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBEb21haW5QYXVzZShpZCBE
b21pZCkgKGVyciBlcnJvcikgewogCiAvL2ludCBsaWJ4bF9kb21haW5fc2h1dGRvd24obGlieGxf
Y3R4ICpjdHgsIHVpbnQzMl90IGRvbWlkKTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluU2h1
dGRvd24oaWQgRG9taWQpIChlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlp
ZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfZG9tYWluX3No
dXRkb3duKEN0eC5jdHgsIEMudWludDMyX3QoaWQpLCBuaWwpCiAKIAlpZiByZXQgIT0gMCB7CkBA
IC0xMDg1LDExICs5NTksNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIERvbWFpblNodXRkb3duKGlk
IERvbWlkKSAoZXJyIGVycm9yKSB7CiAKIC8vaW50IGxpYnhsX2RvbWFpbl9yZWJvb3QobGlieGxf
Y3R4ICpjdHgsIHVpbnQzMl90IGRvbWlkKTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluUmVi
b290KGlkIERvbWlkKSAoZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCXJldCA6PSBDLmxpYnhsX2RvbWFpbl9yZWJv
b3QoQ3R4LmN0eCwgQy51aW50MzJfdChpZCksIG5pbCkKIAogCWlmIHJldCAhPSAwIHsKQEAgLTEx
MDEsMTEgKzk3MCw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluUmVib290KGlkIERvbWlk
KSAoZXJyIGVycm9yKSB7CiAvL2xpYnhsX2RvbWluZm8gKiBsaWJ4bF9saXN0X2RvbWFpbihsaWJ4
bF9jdHgqLCBpbnQgKm5iX2RvbWFpbl9vdXQpOwogLy92b2lkIGxpYnhsX2RvbWluZm9fbGlzdF9m
cmVlKGxpYnhsX2RvbWluZm8gKmxpc3QsIGludCBuYl9kb21haW4pOwogZnVuYyAoQ3R4ICpDb250
ZXh0KSBMaXN0RG9tYWluKCkgKGdsaXN0IFtdRG9taW5mbykgewotCWVyciA6PSBDdHguQ2hlY2tP
cGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJdmFyIG5iRG9tYWluIEMu
aW50CiAJY2xpc3QgOj0gQy5saWJ4bF9saXN0X2RvbWFpbihDdHguY3R4LCAmbmJEb21haW4pCiAJ
ZGVmZXIgQy5saWJ4bF9kb21pbmZvX2xpc3RfZnJlZShjbGlzdCwgbmJEb21haW4pCkBAIC0xMTI4
LDExICs5OTIsNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIExpc3REb21haW4oKSAoZ2xpc3QgW11E
b21pbmZvKSB7CiAvLwkJCQlpbnQgKm5iX3ZjcHUsIGludCAqbnJfY3B1c19vdXQpOwogLy92b2lk
IGxpYnhsX3ZjcHVpbmZvX2xpc3RfZnJlZShsaWJ4bF92Y3B1aW5mbyAqLCBpbnQgbnJfdmNwdXMp
OwogZnVuYyAoQ3R4ICpDb250ZXh0KSBMaXN0VmNwdShpZCBEb21pZCkgKGdsaXN0IFtdVmNwdWlu
Zm8pIHsKLQllcnIgOj0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVy
bgotCX0KLQogCXZhciBuYlZjcHUgQy5pbnQKIAl2YXIgbnJDcHUgQy5pbnQKIApAQCAtMTE2Mywx
MSArMTAyMiw2IEBAIGZ1bmMgKGN0IENvbnNvbGVUeXBlKSBTdHJpbmcoKSAoc3RyIHN0cmluZykg
ewogLy9pbnQgbGlieGxfY29uc29sZV9nZXRfdHR5KGxpYnhsX2N0eCAqY3R4LCB1aW50MzJfdCBk
b21pZCwgaW50IGNvbnNfbnVtLAogLy9saWJ4bF9jb25zb2xlX3R5cGUgdHlwZSwgY2hhciAqKnBh
dGgpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBDb25zb2xlR2V0VHR5KGlkIERvbWlkLCBjb25zTnVt
IGludCwgY29uVHlwZSBDb25zb2xlVHlwZSkgKHBhdGggc3RyaW5nLCBlcnIgZXJyb3IpIHsKLQll
cnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJ
dmFyIGNwYXRoICpDLmNoYXIKIAlyZXQgOj0gQy5saWJ4bF9jb25zb2xlX2dldF90dHkoQ3R4LmN0
eCwgQy51aW50MzJfdChpZCksIEMuaW50KGNvbnNOdW0pLCBDLmxpYnhsX2NvbnNvbGVfdHlwZShj
b25UeXBlKSwgJmNwYXRoKQogCWlmIHJldCAhPSAwIHsKQEAgLTExODMsMTEgKzEwMzcsNiBAQCBm
dW5jIChDdHggKkNvbnRleHQpIENvbnNvbGVHZXRUdHkoaWQgRG9taWQsIGNvbnNOdW0gaW50LCBj
b25UeXBlIENvbnNvbGVUeXBlKSAocAogLy9pbnQgbGlieGxfcHJpbWFyeV9jb25zb2xlX2dldF90
dHkobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IGRvbWlkX3ZtLAogLy8JCQkJCWNoYXIgKipwYXRo
KTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgUHJpbWFyeUNvbnNvbGVHZXRUdHkoZG9taWQgdWludDMy
KSAocGF0aCBzdHJpbmcsIGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlm
IGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAl2YXIgY3BhdGggKkMuY2hhcgogCXJldCA6
PSBDLmxpYnhsX3ByaW1hcnlfY29uc29sZV9nZXRfdHR5KEN0eC5jdHgsIEMudWludDMyX3QoZG9t
aWQpLCAmY3BhdGgpCiAJaWYgcmV0ICE9IDAgewotLSAKMi4xOS4xCgoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApY
ZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

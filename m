Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id F1834158383
	for <lists+xen-devel@lfdr.de>; Mon, 10 Feb 2020 20:24:26 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j1EdL-0000xS-8V; Mon, 10 Feb 2020 19:22:15 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=EP43=36=intel.com=tamas.lengyel@srs-us1.protection.inumbo.net>)
 id 1j1EdJ-0000wh-GV
 for xen-devel@lists.xenproject.org; Mon, 10 Feb 2020 19:22:13 +0000
X-Inumbo-ID: 9ceaf894-4c3a-11ea-b4f5-12813bfff9fa
Received: from mga06.intel.com (unknown [134.134.136.31])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 9ceaf894-4c3a-11ea-b4f5-12813bfff9fa;
 Mon, 10 Feb 2020 19:22:01 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga004.jf.intel.com ([10.7.209.38])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 10 Feb 2020 11:22:00 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,426,1574150400"; d="scan'208";a="380199857"
Received: from jcguru1x-mobl.amr.corp.intel.com (HELO localhost.localdomain)
 ([10.254.67.221])
 by orsmga004.jf.intel.com with ESMTP; 10 Feb 2020 11:22:00 -0800
From: Tamas K Lengyel <tamas.lengyel@intel.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 10 Feb 2020 11:21:29 -0800
Message-Id: <9d0df182d6140f64928cff859184c02bd55c377e.1581362050.git.tamas.lengyel@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1581362050.git.tamas.lengyel@intel.com>
References: <cover.1581362050.git.tamas.lengyel@intel.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v8 5/5] xen/tools: VM forking toolstack side
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Tamas K Lengyel <tamas.lengyel@intel.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIG5lY2Vzc2FyeSBiaXRzIHRvIGltcGxlbWVudCAieGwgZm9yay12bSIgY29tbWFuZHMuIFRo
ZSBjb21tYW5kIGFsbG93cyB0aGUKdXNlciB0byBzcGVjaWZ5IGhvdyB0byBsYXVuY2ggdGhlIGRl
dmljZSBtb2RlbCBhbGxvd2luZyBmb3IgYSBsYXRlLWxhdW5jaCBtb2RlbAppbiB3aGljaCB0aGUg
dXNlciBjYW4gZXhlY3V0ZSB0aGUgZm9yayB3aXRob3V0IHRoZSBkZXZpY2UgbW9kZWwgYW5kIGRl
Y2lkZSB0bwpvbmx5IGxhdGVyIGxhdW5jaCBpdC4KClNpZ25lZC1vZmYtYnk6IFRhbWFzIEsgTGVu
Z3llbCA8dGFtYXMubGVuZ3llbEBpbnRlbC5jb20+Ci0tLQp2ODogZG9uJ3QgdHJ5IHRvIHVucGF1
c2UgdHdpY2Ugd2hlbiBsYXVuY2hpbmcgZG0KLS0tCiBkb2NzL21hbi94bC4xLnBvZC5pbiAgICAg
ICAgICB8ICAzNiArKysrKwogdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmggfCAgMTMgKysK
IHRvb2xzL2xpYnhjL3hjX21lbXNoci5jICAgICAgIHwgIDIyICsrKwogdG9vbHMvbGlieGwvbGli
eGwuaCAgICAgICAgICAgfCAgIDcgKwogdG9vbHMvbGlieGwvbGlieGxfY3JlYXRlLmMgICAgfCAy
NTYgKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogdG9vbHMvbGlieGwvbGlieGxf
ZG0uYyAgICAgICAgfCAgIDIgKy0KIHRvb2xzL2xpYnhsL2xpYnhsX2RvbS5jICAgICAgIHwgIDQz
ICsrKysrLQogdG9vbHMvbGlieGwvbGlieGxfaW50ZXJuYWwuaCAgfCAgIDEgKwogdG9vbHMvbGli
eGwvbGlieGxfdHlwZXMuaWRsICAgfCAgIDEgKwogdG9vbHMveGwveGwuaCAgICAgICAgICAgICAg
ICAgfCAgIDUgKwogdG9vbHMveGwveGxfY21kdGFibGUuYyAgICAgICAgfCAgMTIgKysKIHRvb2xz
L3hsL3hsX3NhdmVyZXN0b3JlLmMgICAgIHwgIDk3ICsrKysrKysrKysrKysKIHRvb2xzL3hsL3hs
X3ZtY29udHJvbC5jICAgICAgIHwgICA4ICsrCiAxMyBmaWxlcyBjaGFuZ2VkLCA0MDkgaW5zZXJ0
aW9ucygrKSwgOTQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZG9jcy9tYW4veGwuMS5wb2Qu
aW4gYi9kb2NzL21hbi94bC4xLnBvZC5pbgppbmRleCAzM2FkMmViZDcxLi5jNDAxMjkzOWY1IDEw
MDY0NAotLS0gYS9kb2NzL21hbi94bC4xLnBvZC5pbgorKysgYi9kb2NzL21hbi94bC4xLnBvZC5p
bgpAQCAtNjk0LDYgKzY5NCw0MiBAQCBMZWF2ZSB0aGUgZG9tYWluIHBhdXNlZCBhZnRlciBjcmVh
dGluZyB0aGUgc25hcHNob3QuCiAKID1iYWNrCiAKKz1pdGVtIEI8Zm9yay12bT4gW0k8T1BUSU9O
Uz5dIEk8ZG9tYWluLWlkPgorCitDcmVhdGUgYSBmb3JrIG9mIGEgcnVubmluZyBWTS4gVGhlIGRv
bWFpbiB3aWxsIGJlIHBhdXNlZCBhZnRlciB0aGUgb3BlcmF0aW9uCithbmQgbmVlZHMgdG8gcmVt
YWluIHBhdXNlZCB3aGlsZSBmb3JrcyBvZiBpdCBleGlzdC4KKworQjxPUFRJT05TPgorCis9b3Zl
ciA0CisKKz1pdGVtIEI8LXA+CisKK0xlYXZlIHRoZSBmb3JrIHBhdXNlZCBhZnRlciBjcmVhdGlu
ZyBpdC4KKworPWl0ZW0gQjwtLWxhdW5jaC1kbT4KKworU3BlY2lmeSB3aGV0aGVyIHRoZSBkZXZp
Y2UgbW9kZWwgKFFFTVUpIHNob3VsZCBiZSBsYXVuY2hlZCBmb3IgdGhlIGZvcmsuIExhdGUKK2xh
dW5jaCBhbGxvd3MgdG8gc3RhcnQgdGhlIGRldmljZSBtb2RlbCBmb3IgYW4gYWxyZWFkeSBydW5u
aW5nIGZvcmsuCisKKz1pdGVtIEI8LUM+CisKK1RoZSBjb25maWcgZmlsZSB0byB1c2Ugd2hlbiBs
YXVuY2hpbmcgdGhlIGRldmljZSBtb2RlbC4gQ3VycmVudGx5IHJlcXVpcmVkIHdoZW4KK2xhdW5j
aGluZyB0aGUgZGV2aWNlIG1vZGVsLgorCis9aXRlbSBCPC1RPgorCitUaGUgcWVtdSBzYXZlIGZp
bGUgdG8gdXNlIHdoZW4gbGF1bmNoaW5nIHRoZSBkZXZpY2UgbW9kZWwuICBDdXJyZW50bHkgcmVx
dWlyZWQKK3doZW4gbGF1bmNoaW5nIHRoZSBkZXZpY2UgbW9kZWwuCisKKz1pdGVtIEI8LS1mb3Jr
LXJlc2V0PgorCitQZXJmb3JtIGEgcmVzZXQgb3BlcmF0aW9uIG9mIGFuIGFscmVhZHkgcnVubmlu
ZyBmb3JrLiBOb3RlIHRoYXQgcmVzZXR0aW5nIG1heQorYmUgbGVzcyBwZXJmb3JtYW50IHRoZW4g
Y3JlYXRpbmcgYSBuZXcgZm9yayBkZXBlbmRpbmcgb24gaG93IG11Y2ggbWVtb3J5IHRoZQorZm9y
ayBoYXMgZGVkdXBsaWNhdGVkIGR1cmluZyBpdHMgcnVudGltZS4KKworPWJhY2sKKwogPWl0ZW0g
QjxzaGFyaW5nPiBbSTxkb21haW4taWQ+XQogCiBEaXNwbGF5IHRoZSBudW1iZXIgb2Ygc2hhcmVk
IHBhZ2VzIGZvciBhIHNwZWNpZmllZCBkb21haW4uIElmIG5vIGRvbWFpbiBpcwpkaWZmIC0tZ2l0
IGEvdG9vbHMvbGlieGMvaW5jbHVkZS94ZW5jdHJsLmggYi90b29scy9saWJ4Yy9pbmNsdWRlL3hl
bmN0cmwuaAppbmRleCBjYzRlYjFlM2QzLi42ZjY1ODg4ZGQwIDEwMDY0NAotLS0gYS90b29scy9s
aWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaAorKysgYi90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwu
aApAQCAtMjIyNSw2ICsyMjI1LDE5IEBAIGludCB4Y19tZW1zaHJfcmFuZ2Vfc2hhcmUoeGNfaW50
ZXJmYWNlICp4Y2gsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IGZpcnN0X2dm
biwKICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3QgbGFzdF9nZm4pOwogCitpbnQg
eGNfbWVtc2hyX2ZvcmsoeGNfaW50ZXJmYWNlICp4Y2gsCisgICAgICAgICAgICAgICAgICAgdWlu
dDMyX3Qgc291cmNlX2RvbWFpbiwKKyAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBjbGllbnRf
ZG9tYWluKTsKKworLyoKKyAqIE5vdGU6IHRoaXMgZnVuY3Rpb24gaXMgb25seSBpbnRlbmRlZCB0
byBiZSB1c2VkIG9uIHNob3J0LWxpdmVkIGZvcmtzIHRoYXQKKyAqIGhhdmVuJ3QgeWV0IGFxdWly
ZWQgYSBsb3Qgb2YgbWVtb3J5LiBJbiBjYXNlIHRoZSBmb3JrIGhhcyBhIGxvdCBvZiBtZW1vcnkK
KyAqIGl0IGlzIGxpa2VseSBtb3JlIHBlcmZvcm1hbnQgdG8gY3JlYXRlIGEgbmV3IGZvcmsgd2l0
aCB4Y19tZW1zaHJfZm9yay4KKyAqCisgKiBXaXRoIFZNcyB0aGF0IGhhdmUgYSBsb3Qgb2YgbWVt
b3J5IHRoaXMgY2FsbCBtYXkgYmxvY2sgZm9yIGEgbG9uZyB0aW1lLgorICovCitpbnQgeGNfbWVt
c2hyX2ZvcmtfcmVzZXQoeGNfaW50ZXJmYWNlICp4Y2gsIHVpbnQzMl90IGZvcmtlZF9kb21haW4p
OworCiAvKiBEZWJ1ZyBjYWxsczogcmV0dXJuIHRoZSBudW1iZXIgb2YgcGFnZXMgcmVmZXJlbmNp
bmcgdGhlIHNoYXJlZCBmcmFtZSBiYWNraW5nCiAgKiB0aGUgaW5wdXQgYXJndW1lbnQuIFNob3Vs
ZCBiZSBvbmUgb3IgZ3JlYXRlci4KICAqCmRpZmYgLS1naXQgYS90b29scy9saWJ4Yy94Y19tZW1z
aHIuYyBiL3Rvb2xzL2xpYnhjL3hjX21lbXNoci5jCmluZGV4IDk3ZTJlNmE4ZDkuLmQwZTRlZTIy
NWIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhjL3hjX21lbXNoci5jCisrKyBiL3Rvb2xzL2xpYnhj
L3hjX21lbXNoci5jCkBAIC0yMzksNiArMjM5LDI4IEBAIGludCB4Y19tZW1zaHJfZGVidWdfZ3Jl
Zih4Y19pbnRlcmZhY2UgKnhjaCwKICAgICByZXR1cm4geGNfbWVtc2hyX21lbW9wKHhjaCwgZG9t
aWQsICZtc28pOwogfQogCitpbnQgeGNfbWVtc2hyX2ZvcmsoeGNfaW50ZXJmYWNlICp4Y2gsIHVp
bnQzMl90IHBkb21pZCwgdWludDMyX3QgZG9taWQpCit7CisgICAgeGVuX21lbV9zaGFyaW5nX29w
X3QgbXNvOworCisgICAgbWVtc2V0KCZtc28sIDAsIHNpemVvZihtc28pKTsKKworICAgIG1zby5v
cCA9IFhFTk1FTV9zaGFyaW5nX29wX2Zvcms7CisgICAgbXNvLnUuZm9yay5wYXJlbnRfZG9tYWlu
ID0gcGRvbWlkOworCisgICAgcmV0dXJuIHhjX21lbXNocl9tZW1vcCh4Y2gsIGRvbWlkLCAmbXNv
KTsKK30KKworaW50IHhjX21lbXNocl9mb3JrX3Jlc2V0KHhjX2ludGVyZmFjZSAqeGNoLCB1aW50
MzJfdCBkb21pZCkKK3sKKyAgICB4ZW5fbWVtX3NoYXJpbmdfb3BfdCBtc287CisKKyAgICBtZW1z
ZXQoJm1zbywgMCwgc2l6ZW9mKG1zbykpOworICAgIG1zby5vcCA9IFhFTk1FTV9zaGFyaW5nX29w
X2ZvcmtfcmVzZXQ7CisKKyAgICByZXR1cm4geGNfbWVtc2hyX21lbW9wKHhjaCwgZG9taWQsICZt
c28pOworfQorCiBpbnQgeGNfbWVtc2hyX2F1ZGl0KHhjX2ludGVyZmFjZSAqeGNoKQogewogICAg
IHhlbl9tZW1fc2hhcmluZ19vcF90IG1zbzsKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xpYnhs
LmggYi90b29scy9saWJ4bC9saWJ4bC5oCmluZGV4IDE4YzFhMmQ2YmYuLjA5NGFiMGQyMDUgMTAw
NjQ0Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhsLmgKKysrIGIvdG9vbHMvbGlieGwvbGlieGwuaApA
QCAtMTUzOCw2ICsxNTM4LDEzIEBAIGludCBsaWJ4bF9kb21haW5fY3JlYXRlX25ldyhsaWJ4bF9j
dHggKmN0eCwgbGlieGxfZG9tYWluX2NvbmZpZyAqZF9jb25maWcsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgbGlieGxfYXN5bmNvcF9ob3cgKmFvX2hvdywKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9hc3luY3Byb2dyZXNzX2hvdyAqYW9wX2NvbnNv
bGVfaG93KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIExJQlhMX0VYVEVSTkFMX0NBTExF
UlNfT05MWTsKK2ludCBsaWJ4bF9kb21haW5fZm9ya192bShsaWJ4bF9jdHggKmN0eCwgdWludDMy
X3QgcGRvbWlkLCB1aW50MzJfdCAqZG9taWQpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IExJQlhMX0VYVEVSTkFMX0NBTExFUlNfT05MWTsKK2ludCBsaWJ4bF9kb21haW5fZm9ya19sYXVu
Y2hfZG0obGlieGxfY3R4ICpjdHgsIGxpYnhsX2RvbWFpbl9jb25maWcgKmRfY29uZmlnLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBkb21pZCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlieGxfYXN5bmNwcm9ncmVzc19ob3cgKmFvcF9j
b25zb2xlX2hvdykKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTElCWExfRVhURVJO
QUxfQ0FMTEVSU19PTkxZOworaW50IGxpYnhsX2RvbWFpbl9mb3JrX3Jlc2V0KGxpYnhsX2N0eCAq
Y3R4LCB1aW50MzJfdCBkb21pZCk7CiBpbnQgbGlieGxfZG9tYWluX2NyZWF0ZV9yZXN0b3JlKGxp
YnhsX2N0eCAqY3R4LCBsaWJ4bF9kb21haW5fY29uZmlnICpkX2NvbmZpZywKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgKmRvbWlkLCBpbnQgcmVzdG9yZV9mZCwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHNlbmRfYmFja19mZCwKZGlmZiAtLWdp
dCBhL3Rvb2xzL2xpYnhsL2xpYnhsX2NyZWF0ZS5jIGIvdG9vbHMvbGlieGwvbGlieGxfY3JlYXRl
LmMKaW5kZXggM2E3MzY0ZTJhYy4uOWRkOTgwMmZjNyAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGwv
bGlieGxfY3JlYXRlLmMKKysrIGIvdG9vbHMvbGlieGwvbGlieGxfY3JlYXRlLmMKQEAgLTUzNiwx
MiArNTM2LDEyIEBAIG91dDoKICAgICByZXR1cm4gcmV0OwogfQogCi1pbnQgbGlieGxfX2RvbWFp
bl9tYWtlKGxpYnhsX19nYyAqZ2MsIGxpYnhsX2RvbWFpbl9jb25maWcgKmRfY29uZmlnLAotICAg
ICAgICAgICAgICAgICAgICAgICBsaWJ4bF9fZG9tYWluX2J1aWxkX3N0YXRlICpzdGF0ZSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgKmRvbWlkLCBib29sIHNvZnRfcmVzZXQpCitz
dGF0aWMgaW50IGxpYnhsX19kb21haW5fbWFrZV94c19lbnRyaWVzKGxpYnhsX19nYyAqZ2MsIGxp
YnhsX2RvbWFpbl9jb25maWcgKmRfY29uZmlnLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBsaWJ4bF9fZG9tYWluX2J1aWxkX3N0YXRlICpzdGF0ZSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgZG9taWQpCiB7CiAgICAg
bGlieGxfY3R4ICpjdHggPSBsaWJ4bF9fZ2Nfb3duZXIoZ2MpOwotICAgIGludCByZXQsIHJjLCBu
Yl92bTsKKyAgICBpbnQgcmMsIG5iX3ZtOwogICAgIGNvbnN0IGNoYXIgKmRvbV90eXBlOwogICAg
IGNoYXIgKnV1aWRfc3RyaW5nOwogICAgIGNoYXIgKmRvbV9wYXRoLCAqdm1fcGF0aCwgKmxpYnhs
X3BhdGg7CkBAIC01NTMsOSArNTUzLDYgQEAgaW50IGxpYnhsX19kb21haW5fbWFrZShsaWJ4bF9f
Z2MgKmdjLCBsaWJ4bF9kb21haW5fY29uZmlnICpkX2NvbmZpZywKIAogICAgIC8qIGNvbnZlbmll
bmNlIGFsaWFzZXMgKi8KICAgICBsaWJ4bF9kb21haW5fY3JlYXRlX2luZm8gKmluZm8gPSAmZF9j
b25maWctPmNfaW5mbzsKLSAgICBsaWJ4bF9kb21haW5fYnVpbGRfaW5mbyAqYl9pbmZvID0gJmRf
Y29uZmlnLT5iX2luZm87Ci0KLSAgICBhc3NlcnQoc29mdF9yZXNldCB8fCAqZG9taWQgPT0gSU5W
QUxJRF9ET01JRCk7CiAKICAgICB1dWlkX3N0cmluZyA9IGxpYnhsX191dWlkMnN0cmluZyhnYywg
aW5mby0+dXVpZCk7CiAgICAgaWYgKCF1dWlkX3N0cmluZykgewpAQCAtNTYzLDcxICs1NjAsNyBA
QCBpbnQgbGlieGxfX2RvbWFpbl9tYWtlKGxpYnhsX19nYyAqZ2MsIGxpYnhsX2RvbWFpbl9jb25m
aWcgKmRfY29uZmlnLAogICAgICAgICBnb3RvIG91dDsKICAgICB9CiAKLSAgICBpZiAoIXNvZnRf
cmVzZXQpIHsKLSAgICAgICAgc3RydWN0IHhlbl9kb21jdGxfY3JlYXRlZG9tYWluIGNyZWF0ZSA9
IHsKLSAgICAgICAgICAgIC5zc2lkcmVmID0gaW5mby0+c3NpZHJlZiwKLSAgICAgICAgICAgIC5t
YXhfdmNwdXMgPSBiX2luZm8tPm1heF92Y3B1cywKLSAgICAgICAgICAgIC5tYXhfZXZ0Y2huX3Bv
cnQgPSBiX2luZm8tPmV2ZW50X2NoYW5uZWxzLAotICAgICAgICAgICAgLm1heF9ncmFudF9mcmFt
ZXMgPSBiX2luZm8tPm1heF9ncmFudF9mcmFtZXMsCi0gICAgICAgICAgICAubWF4X21hcHRyYWNr
X2ZyYW1lcyA9IGJfaW5mby0+bWF4X21hcHRyYWNrX2ZyYW1lcywKLSAgICAgICAgfTsKLQotICAg
ICAgICBpZiAoaW5mby0+dHlwZSAhPSBMSUJYTF9ET01BSU5fVFlQRV9QVikgewotICAgICAgICAg
ICAgY3JlYXRlLmZsYWdzIHw9IFhFTl9ET01DVExfQ0RGX2h2bTsKLSAgICAgICAgICAgIGNyZWF0
ZS5mbGFncyB8PQotICAgICAgICAgICAgICAgIGxpYnhsX2RlZmJvb2xfdmFsKGluZm8tPmhhcCkg
PyBYRU5fRE9NQ1RMX0NERl9oYXAgOiAwOwotICAgICAgICAgICAgY3JlYXRlLmZsYWdzIHw9Ci0g
ICAgICAgICAgICAgICAgbGlieGxfZGVmYm9vbF92YWwoaW5mby0+b29zKSA/IDAgOiBYRU5fRE9N
Q1RMX0NERl9vb3Nfb2ZmOwotICAgICAgICB9Ci0KLSAgICAgICAgYXNzZXJ0KGluZm8tPnBhc3N0
aHJvdWdoICE9IExJQlhMX1BBU1NUSFJPVUdIX0RFRkFVTFQpOwotICAgICAgICBMT0coREVUQUlM
LCAicGFzc3Rocm91Z2g6ICVzIiwKLSAgICAgICAgICAgIGxpYnhsX3Bhc3N0aHJvdWdoX3RvX3N0
cmluZyhpbmZvLT5wYXNzdGhyb3VnaCkpOwotCi0gICAgICAgIGlmIChpbmZvLT5wYXNzdGhyb3Vn
aCAhPSBMSUJYTF9QQVNTVEhST1VHSF9ESVNBQkxFRCkKLSAgICAgICAgICAgIGNyZWF0ZS5mbGFn
cyB8PSBYRU5fRE9NQ1RMX0NERl9pb21tdTsKLQotICAgICAgICBpZiAoaW5mby0+cGFzc3Rocm91
Z2ggPT0gTElCWExfUEFTU1RIUk9VR0hfU1lOQ19QVCkKLSAgICAgICAgICAgIGNyZWF0ZS5pb21t
dV9vcHRzIHw9IFhFTl9ET01DVExfSU9NTVVfbm9fc2hhcmVwdDsKLQotICAgICAgICAvKiBVbHRp
bWF0ZWx5LCBoYW5kbGUgaXMgYW4gYXJyYXkgb2YgMTYgdWludDhfdCwgc2FtZSBhcyB1dWlkICov
Ci0gICAgICAgIGxpYnhsX3V1aWRfY29weShjdHgsIChsaWJ4bF91dWlkICopJmNyZWF0ZS5oYW5k
bGUsICZpbmZvLT51dWlkKTsKLQotICAgICAgICByZXQgPSBsaWJ4bF9fYXJjaF9kb21haW5fcHJl
cGFyZV9jb25maWcoZ2MsIGRfY29uZmlnLCAmY3JlYXRlKTsKLSAgICAgICAgaWYgKHJldCA8IDAp
IHsKLSAgICAgICAgICAgIExPR0VEKEVSUk9SLCAqZG9taWQsICJmYWlsIHRvIGdldCBkb21haW4g
Y29uZmlnIik7Ci0gICAgICAgICAgICByYyA9IEVSUk9SX0ZBSUw7Ci0gICAgICAgICAgICBnb3Rv
IG91dDsKLSAgICAgICAgfQotCi0gICAgICAgIHJldCA9IHhjX2RvbWFpbl9jcmVhdGUoY3R4LT54
Y2gsIGRvbWlkLCAmY3JlYXRlKTsKLSAgICAgICAgaWYgKHJldCA8IDApIHsKLSAgICAgICAgICAg
IExPR0VEKEVSUk9SLCAqZG9taWQsICJkb21haW4gY3JlYXRpb24gZmFpbCIpOwotICAgICAgICAg
ICAgcmMgPSBFUlJPUl9GQUlMOwotICAgICAgICAgICAgZ290byBvdXQ7Ci0gICAgICAgIH0KLQot
ICAgICAgICByYyA9IGxpYnhsX19hcmNoX2RvbWFpbl9zYXZlX2NvbmZpZyhnYywgZF9jb25maWcs
IHN0YXRlLCAmY3JlYXRlKTsKLSAgICAgICAgaWYgKHJjIDwgMCkKLSAgICAgICAgICAgIGdvdG8g
b3V0OwotICAgIH0KLQotICAgIC8qCi0gICAgICogSWYgc29mdF9yZXNldCBpcyBzZXQgdGhlIHRo
ZSBkb21pZCB3aWxsIGhhdmUgYmVlbiB2YWxpZCBvbiBlbnRyeS4KLSAgICAgKiBJZiBpdCB3YXMg
bm90IHNldCB0aGVuIHhjX2RvbWFpbl9jcmVhdGUoKSBzaG91bGQgaGF2ZSBhc3NpZ25lZCBhCi0g
ICAgICogdmFsaWQgdmFsdWUuIEVpdGhlciB3YXksIGlmIHdlIHJlYWNoIHRoaXMgcG9pbnQsIGRv
bWlkIHNob3VsZCBiZQotICAgICAqIHZhbGlkLgotICAgICAqLwotICAgIGFzc2VydChsaWJ4bF9k
b21pZF92YWxpZF9ndWVzdCgqZG9taWQpKTsKLQotICAgIHJldCA9IHhjX2NwdXBvb2xfbW92ZWRv
bWFpbihjdHgtPnhjaCwgaW5mby0+cG9vbGlkLCAqZG9taWQpOwotICAgIGlmIChyZXQgPCAwKSB7
Ci0gICAgICAgIExPR0VEKEVSUk9SLCAqZG9taWQsICJkb21haW4gbW92ZSBmYWlsIik7Ci0gICAg
ICAgIHJjID0gRVJST1JfRkFJTDsKLSAgICAgICAgZ290byBvdXQ7Ci0gICAgfQotCi0gICAgZG9t
X3BhdGggPSBsaWJ4bF9feHNfZ2V0X2RvbXBhdGgoZ2MsICpkb21pZCk7CisgICAgZG9tX3BhdGgg
PSBsaWJ4bF9feHNfZ2V0X2RvbXBhdGgoZ2MsIGRvbWlkKTsKICAgICBpZiAoIWRvbV9wYXRoKSB7
CiAgICAgICAgIHJjID0gRVJST1JfRkFJTDsKICAgICAgICAgZ290byBvdXQ7CkBAIC02MzUsMTIg
KzU2OCwxMiBAQCBpbnQgbGlieGxfX2RvbWFpbl9tYWtlKGxpYnhsX19nYyAqZ2MsIGxpYnhsX2Rv
bWFpbl9jb25maWcgKmRfY29uZmlnLAogCiAgICAgdm1fcGF0aCA9IEdDU1BSSU5URigiL3ZtLyVz
IiwgdXVpZF9zdHJpbmcpOwogICAgIGlmICghdm1fcGF0aCkgewotICAgICAgICBMT0dEKEVSUk9S
LCAqZG9taWQsICJjYW5ub3QgYWxsb2NhdGUgY3JlYXRlIHBhdGhzIik7CisgICAgICAgIExPR0Qo
RVJST1IsIGRvbWlkLCAiY2Fubm90IGFsbG9jYXRlIGNyZWF0ZSBwYXRocyIpOwogICAgICAgICBy
YyA9IEVSUk9SX0ZBSUw7CiAgICAgICAgIGdvdG8gb3V0OwogICAgIH0KIAotICAgIGxpYnhsX3Bh
dGggPSBsaWJ4bF9feHNfbGlieGxfcGF0aChnYywgKmRvbWlkKTsKKyAgICBsaWJ4bF9wYXRoID0g
bGlieGxfX3hzX2xpYnhsX3BhdGgoZ2MsIGRvbWlkKTsKICAgICBpZiAoIWxpYnhsX3BhdGgpIHsK
ICAgICAgICAgcmMgPSBFUlJPUl9GQUlMOwogICAgICAgICBnb3RvIG91dDsKQEAgLTY1MSwxMCAr
NTg0LDEwIEBAIGludCBsaWJ4bF9fZG9tYWluX21ha2UobGlieGxfX2djICpnYywgbGlieGxfZG9t
YWluX2NvbmZpZyAqZF9jb25maWcsCiAKICAgICByb3Blcm1bMF0uaWQgPSAwOwogICAgIHJvcGVy
bVswXS5wZXJtcyA9IFhTX1BFUk1fTk9ORTsKLSAgICByb3Blcm1bMV0uaWQgPSAqZG9taWQ7Cisg
ICAgcm9wZXJtWzFdLmlkID0gZG9taWQ7CiAgICAgcm9wZXJtWzFdLnBlcm1zID0gWFNfUEVSTV9S
RUFEOwogCi0gICAgcndwZXJtWzBdLmlkID0gKmRvbWlkOworICAgIHJ3cGVybVswXS5pZCA9IGRv
bWlkOwogICAgIHJ3cGVybVswXS5wZXJtcyA9IFhTX1BFUk1fTk9ORTsKIAogcmV0cnlfdHJhbnNh
Y3Rpb246CkBAIC02NzIsNyArNjA1LDcgQEAgcmV0cnlfdHJhbnNhY3Rpb246CiAgICAgICAgICAg
ICAgICAgICAgIG5vcGVybSwgQVJSQVlfU0laRShub3Blcm0pKTsKIAogICAgIHhzX3dyaXRlKGN0
eC0+eHNoLCB0LCBHQ1NQUklOVEYoIiVzL3ZtIiwgZG9tX3BhdGgpLCB2bV9wYXRoLCBzdHJsZW4o
dm1fcGF0aCkpOwotICAgIHJjID0gbGlieGxfX2RvbWFpbl9yZW5hbWUoZ2MsICpkb21pZCwgMCwg
aW5mby0+bmFtZSwgdCk7CisgICAgcmMgPSBsaWJ4bF9fZG9tYWluX3JlbmFtZShnYywgZG9taWQs
IDAsIGluZm8tPm5hbWUsIHQpOwogICAgIGlmIChyYykKICAgICAgICAgZ290byBvdXQ7CiAKQEAg
LTc0OSw3ICs2ODIsNyBAQCByZXRyeV90cmFuc2FjdGlvbjoKIAogICAgIHZtX2xpc3QgPSBsaWJ4
bF9saXN0X3ZtKGN0eCwgJm5iX3ZtKTsKICAgICBpZiAoIXZtX2xpc3QpIHsKLSAgICAgICAgTE9H
RChFUlJPUiwgKmRvbWlkLCAiY2Fubm90IGdldCBudW1iZXIgb2YgcnVubmluZyBndWVzdHMiKTsK
KyAgICAgICAgTE9HRChFUlJPUiwgZG9taWQsICJjYW5ub3QgZ2V0IG51bWJlciBvZiBydW5uaW5n
IGd1ZXN0cyIpOwogICAgICAgICByYyA9IEVSUk9SX0ZBSUw7CiAgICAgICAgIGdvdG8gb3V0Owog
ICAgIH0KQEAgLTc3Myw3ICs3MDYsNyBAQCByZXRyeV90cmFuc2FjdGlvbjoKICAgICAgICAgICAg
IHQgPSAwOwogICAgICAgICAgICAgZ290byByZXRyeV90cmFuc2FjdGlvbjsKICAgICAgICAgfQot
ICAgICAgICBMT0dFRChFUlJPUiwgKmRvbWlkLCAiZG9tYWluIGNyZWF0aW9uICIieGVuc3RvcmUg
dHJhbnNhY3Rpb24gY29tbWl0IGZhaWxlZCIpOworICAgICAgICBMT0dFRChFUlJPUiwgZG9taWQs
ICJkb21haW4gY3JlYXRpb24gIiJ4ZW5zdG9yZSB0cmFuc2FjdGlvbiBjb21taXQgZmFpbGVkIik7
CiAgICAgICAgIHJjID0gRVJST1JfRkFJTDsKICAgICAgICAgZ290byBvdXQ7CiAgICAgfQpAQCAt
Nzg1LDYgKzcxOCw4OSBAQCByZXRyeV90cmFuc2FjdGlvbjoKICAgICByZXR1cm4gcmM7CiB9CiAK
K2ludCBsaWJ4bF9fZG9tYWluX21ha2UobGlieGxfX2djICpnYywgbGlieGxfZG9tYWluX2NvbmZp
ZyAqZF9jb25maWcsCisgICAgICAgICAgICAgICAgICAgICAgIGxpYnhsX19kb21haW5fYnVpbGRf
c3RhdGUgKnN0YXRlLAorICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqZG9taWQsIGJv
b2wgc29mdF9yZXNldCkKK3sKKyAgICBsaWJ4bF9jdHggKmN0eCA9IGxpYnhsX19nY19vd25lcihn
Yyk7CisgICAgaW50IHJldCwgcmM7CisKKyAgICAvKiBjb252ZW5pZW5jZSBhbGlhc2VzICovCisg
ICAgbGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvICppbmZvID0gJmRfY29uZmlnLT5jX2luZm87Cisg
ICAgbGlieGxfZG9tYWluX2J1aWxkX2luZm8gKmJfaW5mbyA9ICZkX2NvbmZpZy0+Yl9pbmZvOwor
CisgICAgYXNzZXJ0KHNvZnRfcmVzZXQgfHwgKmRvbWlkID09IElOVkFMSURfRE9NSUQpOworCisg
ICAgaWYgKCFzb2Z0X3Jlc2V0KSB7CisgICAgICAgIHN0cnVjdCB4ZW5fZG9tY3RsX2NyZWF0ZWRv
bWFpbiBjcmVhdGUgPSB7CisgICAgICAgICAgICAuc3NpZHJlZiA9IGluZm8tPnNzaWRyZWYsCisg
ICAgICAgICAgICAubWF4X3ZjcHVzID0gYl9pbmZvLT5tYXhfdmNwdXMsCisgICAgICAgICAgICAu
bWF4X2V2dGNobl9wb3J0ID0gYl9pbmZvLT5ldmVudF9jaGFubmVscywKKyAgICAgICAgICAgIC5t
YXhfZ3JhbnRfZnJhbWVzID0gYl9pbmZvLT5tYXhfZ3JhbnRfZnJhbWVzLAorICAgICAgICAgICAg
Lm1heF9tYXB0cmFja19mcmFtZXMgPSBiX2luZm8tPm1heF9tYXB0cmFja19mcmFtZXMsCisgICAg
ICAgIH07CisKKyAgICAgICAgaWYgKGluZm8tPnR5cGUgIT0gTElCWExfRE9NQUlOX1RZUEVfUFYp
IHsKKyAgICAgICAgICAgIGNyZWF0ZS5mbGFncyB8PSBYRU5fRE9NQ1RMX0NERl9odm07CisgICAg
ICAgICAgICBjcmVhdGUuZmxhZ3MgfD0KKyAgICAgICAgICAgICAgICBsaWJ4bF9kZWZib29sX3Zh
bChpbmZvLT5oYXApID8gWEVOX0RPTUNUTF9DREZfaGFwIDogMDsKKyAgICAgICAgICAgIGNyZWF0
ZS5mbGFncyB8PQorICAgICAgICAgICAgICAgIGxpYnhsX2RlZmJvb2xfdmFsKGluZm8tPm9vcykg
PyAwIDogWEVOX0RPTUNUTF9DREZfb29zX29mZjsKKyAgICAgICAgfQorCisgICAgICAgIGFzc2Vy
dChpbmZvLT5wYXNzdGhyb3VnaCAhPSBMSUJYTF9QQVNTVEhST1VHSF9ERUZBVUxUKTsKKyAgICAg
ICAgTE9HKERFVEFJTCwgInBhc3N0aHJvdWdoOiAlcyIsCisgICAgICAgICAgICBsaWJ4bF9wYXNz
dGhyb3VnaF90b19zdHJpbmcoaW5mby0+cGFzc3Rocm91Z2gpKTsKKworICAgICAgICBpZiAoaW5m
by0+cGFzc3Rocm91Z2ggIT0gTElCWExfUEFTU1RIUk9VR0hfRElTQUJMRUQpCisgICAgICAgICAg
ICBjcmVhdGUuZmxhZ3MgfD0gWEVOX0RPTUNUTF9DREZfaW9tbXU7CisKKyAgICAgICAgaWYgKGlu
Zm8tPnBhc3N0aHJvdWdoID09IExJQlhMX1BBU1NUSFJPVUdIX1NZTkNfUFQpCisgICAgICAgICAg
ICBjcmVhdGUuaW9tbXVfb3B0cyB8PSBYRU5fRE9NQ1RMX0lPTU1VX25vX3NoYXJlcHQ7CisKKyAg
ICAgICAgLyogVWx0aW1hdGVseSwgaGFuZGxlIGlzIGFuIGFycmF5IG9mIDE2IHVpbnQ4X3QsIHNh
bWUgYXMgdXVpZCAqLworICAgICAgICBsaWJ4bF91dWlkX2NvcHkoY3R4LCAobGlieGxfdXVpZCAq
KSZjcmVhdGUuaGFuZGxlLCAmaW5mby0+dXVpZCk7CisKKyAgICAgICAgcmV0ID0gbGlieGxfX2Fy
Y2hfZG9tYWluX3ByZXBhcmVfY29uZmlnKGdjLCBkX2NvbmZpZywgJmNyZWF0ZSk7CisgICAgICAg
IGlmIChyZXQgPCAwKSB7CisgICAgICAgICAgICBMT0dFRChFUlJPUiwgKmRvbWlkLCAiZmFpbCB0
byBnZXQgZG9tYWluIGNvbmZpZyIpOworICAgICAgICAgICAgcmMgPSBFUlJPUl9GQUlMOworICAg
ICAgICAgICAgZ290byBvdXQ7CisgICAgICAgIH0KKworICAgICAgICByZXQgPSB4Y19kb21haW5f
Y3JlYXRlKGN0eC0+eGNoLCBkb21pZCwgJmNyZWF0ZSk7CisgICAgICAgIGlmIChyZXQgPCAwKSB7
CisgICAgICAgICAgICBMT0dFRChFUlJPUiwgKmRvbWlkLCAiZG9tYWluIGNyZWF0aW9uIGZhaWwi
KTsKKyAgICAgICAgICAgIHJjID0gRVJST1JfRkFJTDsKKyAgICAgICAgICAgIGdvdG8gb3V0Owor
ICAgICAgICB9CisKKyAgICAgICAgcmMgPSBsaWJ4bF9fYXJjaF9kb21haW5fc2F2ZV9jb25maWco
Z2MsIGRfY29uZmlnLCBzdGF0ZSwgJmNyZWF0ZSk7CisgICAgICAgIGlmIChyYyA8IDApCisgICAg
ICAgICAgICBnb3RvIG91dDsKKyAgICB9CisKKyAgICAvKgorICAgICAqIElmIHNvZnRfcmVzZXQg
aXMgc2V0IHRoZSB0aGUgZG9taWQgd2lsbCBoYXZlIGJlZW4gdmFsaWQgb24gZW50cnkuCisgICAg
ICogSWYgaXQgd2FzIG5vdCBzZXQgdGhlbiB4Y19kb21haW5fY3JlYXRlKCkgc2hvdWxkIGhhdmUg
YXNzaWduZWQgYQorICAgICAqIHZhbGlkIHZhbHVlLiBFaXRoZXIgd2F5LCBpZiB3ZSByZWFjaCB0
aGlzIHBvaW50LCBkb21pZCBzaG91bGQgYmUKKyAgICAgKiB2YWxpZC4KKyAgICAgKi8KKyAgICBh
c3NlcnQobGlieGxfZG9taWRfdmFsaWRfZ3Vlc3QoKmRvbWlkKSk7CisKKyAgICByZXQgPSB4Y19j
cHVwb29sX21vdmVkb21haW4oY3R4LT54Y2gsIGluZm8tPnBvb2xpZCwgKmRvbWlkKTsKKyAgICBp
ZiAocmV0IDwgMCkgeworICAgICAgICBMT0dFRChFUlJPUiwgKmRvbWlkLCAiZG9tYWluIG1vdmUg
ZmFpbCIpOworICAgICAgICByYyA9IEVSUk9SX0ZBSUw7CisgICAgICAgIGdvdG8gb3V0OworICAg
IH0KKworICAgIHJjID0gbGlieGxfX2RvbWFpbl9tYWtlX3hzX2VudHJpZXMoZ2MsIGRfY29uZmln
LCBzdGF0ZSwgKmRvbWlkKTsKKworb3V0OgorICAgIHJldHVybiByYzsKK30KKwogc3RhdGljIGlu
dCBzdG9yZV9saWJ4bF9lbnRyeShsaWJ4bF9fZ2MgKmdjLCB1aW50MzJfdCBkb21pZCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfZG9tYWluX2J1aWxkX2luZm8gKmJfaW5mbykK
IHsKQEAgLTExMDYsMTYgKzExMjIsMzIgQEAgc3RhdGljIHZvaWQgaW5pdGlhdGVfZG9tYWluX2Ny
ZWF0ZShsaWJ4bF9fZWdjICplZ2MsCiAgICAgcmV0ID0gbGlieGxfX2RvbWFpbl9jb25maWdfc2V0
ZGVmYXVsdChnYyxkX2NvbmZpZyxkb21pZCk7CiAgICAgaWYgKHJldCkgZ290byBlcnJvcl9vdXQ7
CiAKLSAgICByZXQgPSBsaWJ4bF9fZG9tYWluX21ha2UoZ2MsIGRfY29uZmlnLCAmZGNzLT5idWls
ZF9zdGF0ZSwgJmRvbWlkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkY3MtPnNvZnRf
cmVzZXQpOwotICAgIGlmIChyZXQpIHsKLSAgICAgICAgTE9HRChFUlJPUiwgZG9taWQsICJjYW5u
b3QgbWFrZSBkb21haW46ICVkIiwgcmV0KTsKKyAgICBpZiAoICFkX2NvbmZpZy0+ZG1fcmVzdG9y
ZV9maWxlICkKKyAgICB7CisgICAgICAgIHJldCA9IGxpYnhsX19kb21haW5fbWFrZShnYywgZF9j
b25maWcsICZkY3MtPmJ1aWxkX3N0YXRlLCAmZG9taWQsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkY3MtPnNvZnRfcmVzZXQpOwogICAgICAgICBkY3MtPmd1ZXN0X2RvbWlkID0g
ZG9taWQ7CisKKyAgICAgICAgaWYgKHJldCkgeworICAgICAgICAgICAgTE9HRChFUlJPUiwgZG9t
aWQsICJjYW5ub3QgbWFrZSBkb21haW46ICVkIiwgcmV0KTsKKyAgICAgICAgICAgIHJldCA9IEVS
Uk9SX0ZBSUw7CisgICAgICAgICAgICBnb3RvIGVycm9yX291dDsKKyAgICAgICAgfQorICAgIH0g
ZWxzZSBpZiAoIGRjcy0+Z3Vlc3RfZG9taWQgIT0gSU5WQUxJRF9ET01JRCApIHsKKyAgICAgICAg
ZG9taWQgPSBkY3MtPmd1ZXN0X2RvbWlkOworCisgICAgICAgIHJldCA9IGxpYnhsX19kb21haW5f
bWFrZV94c19lbnRyaWVzKGdjLCBkX2NvbmZpZywgJmRjcy0+YnVpbGRfc3RhdGUsIGRvbWlkKTsK
KyAgICAgICAgaWYgKHJldCkgeworICAgICAgICAgICAgTE9HRChFUlJPUiwgZG9taWQsICJjYW5u
b3QgbWFrZSBkb21haW46ICVkIiwgcmV0KTsKKyAgICAgICAgICAgIHJldCA9IEVSUk9SX0ZBSUw7
CisgICAgICAgICAgICBnb3RvIGVycm9yX291dDsKKyAgICAgICAgfQorICAgIH0gZWxzZSB7Cisg
ICAgICAgIExPR0QoRVJST1IsIGRvbWlkLCAiY2Fubm90IG1ha2UgZG9tYWluIik7CiAgICAgICAg
IHJldCA9IEVSUk9SX0ZBSUw7CiAgICAgICAgIGdvdG8gZXJyb3Jfb3V0OwogICAgIH0KIAotICAg
IGRjcy0+Z3Vlc3RfZG9taWQgPSBkb21pZDsKICAgICBkY3MtPnNkc3MuZG0uZ3Vlc3RfZG9taWQg
PSAwOyAvKiBtZWFucyB3ZSBoYXZlbid0IHNwYXduZWQgKi8KIAogICAgIC8qIHBvc3QtNC4xMyB0
b2RvOiBtb3ZlIHRoZXNlIG5leHQgYml0cyBvZiBkZWZhdWx0aW5nIHRvCkBAIC0xMTUxLDcgKzEx
ODMsNyBAQCBzdGF0aWMgdm9pZCBpbml0aWF0ZV9kb21haW5fY3JlYXRlKGxpYnhsX19lZ2MgKmVn
YywKICAgICBpZiAocmV0KQogICAgICAgICBnb3RvIGVycm9yX291dDsKIAotICAgIGlmIChyZXN0
b3JlX2ZkID49IDAgfHwgZGNzLT5zb2Z0X3Jlc2V0KSB7CisgICAgaWYgKHJlc3RvcmVfZmQgPj0g
MCB8fCBkY3MtPnNvZnRfcmVzZXQgfHwgZF9jb25maWctPmRtX3Jlc3RvcmVfZmlsZSkgewogICAg
ICAgICBMT0dEKERFQlVHLCBkb21pZCwgInJlc3RvcmluZywgbm90IHJ1bm5pbmcgYm9vdGxvYWRl
ciIpOwogICAgICAgICBkb21jcmVhdGVfYm9vdGxvYWRlcl9kb25lKGVnYywgJmRjcy0+YmwsIDAp
OwogICAgIH0gZWxzZSAgewpAQCAtMTIyNyw3ICsxMjU5LDE2IEBAIHN0YXRpYyB2b2lkIGRvbWNy
ZWF0ZV9ib290bG9hZGVyX2RvbmUobGlieGxfX2VnYyAqZWdjLAogICAgIGRjcy0+c2Rzcy5kbS5j
YWxsYmFjayA9IGRvbWNyZWF0ZV9kZXZtb2RlbF9zdGFydGVkOwogICAgIGRjcy0+c2Rzcy5jYWxs
YmFjayA9IGRvbWNyZWF0ZV9kZXZtb2RlbF9zdGFydGVkOwogCi0gICAgaWYgKHJlc3RvcmVfZmQg
PCAwICYmICFkY3MtPnNvZnRfcmVzZXQpIHsKKyAgICBpZiAocmVzdG9yZV9mZCA8IDAgJiYgIWRj
cy0+c29mdF9yZXNldCAmJiAhZF9jb25maWctPmRtX3Jlc3RvcmVfZmlsZSkgeworICAgICAgICBy
YyA9IGxpYnhsX19kb21haW5fYnVpbGQoZ2MsIGRfY29uZmlnLCBkb21pZCwgc3RhdGUpOworICAg
ICAgICBkb21jcmVhdGVfcmVidWlsZF9kb25lKGVnYywgZGNzLCByYyk7CisgICAgICAgIHJldHVy
bjsKKyAgICB9CisKKyAgICBpZiAoIGRfY29uZmlnLT5kbV9yZXN0b3JlX2ZpbGUgKSB7CisgICAg
ICAgIGRjcy0+c3JzLmRjcyA9IGRjczsKKyAgICAgICAgZGNzLT5zcnMuYW8gPSBhbzsKKyAgICAg
ICAgc3RhdGUtPmZvcmtlZF92bSA9IHRydWU7CiAgICAgICAgIHJjID0gbGlieGxfX2RvbWFpbl9i
dWlsZChnYywgZF9jb25maWcsIGRvbWlkLCBzdGF0ZSk7CiAgICAgICAgIGRvbWNyZWF0ZV9yZWJ1
aWxkX2RvbmUoZWdjLCBkY3MsIHJjKTsKICAgICAgICAgcmV0dXJuOwpAQCAtMTQyNSw2ICsxNDY2
LDcgQEAgc3RhdGljIHZvaWQgZG9tY3JlYXRlX3JlYnVpbGRfZG9uZShsaWJ4bF9fZWdjICplZ2Ms
CiAgICAgLyogY29udmVuaWVuY2UgYWxpYXNlcyAqLwogICAgIGNvbnN0IHVpbnQzMl90IGRvbWlk
ID0gZGNzLT5ndWVzdF9kb21pZDsKICAgICBsaWJ4bF9kb21haW5fY29uZmlnICpjb25zdCBkX2Nv
bmZpZyA9IGRjcy0+Z3Vlc3RfY29uZmlnOworICAgIGxpYnhsX19kb21haW5fYnVpbGRfc3RhdGUg
KmNvbnN0IHN0YXRlID0gJmRjcy0+YnVpbGRfc3RhdGU7CiAKICAgICBpZiAocmV0KSB7CiAgICAg
ICAgIExPR0QoRVJST1IsIGRvbWlkLCAiY2Fubm90IChyZS0pYnVpbGQgZG9tYWluOiAlZCIsIHJl
dCk7CkBAIC0xNDMyLDYgKzE0NzQsOSBAQCBzdGF0aWMgdm9pZCBkb21jcmVhdGVfcmVidWlsZF9k
b25lKGxpYnhsX19lZ2MgKmVnYywKICAgICAgICAgZ290byBlcnJvcl9vdXQ7CiAgICAgfQogCisg
ICAgaWYgKCBkX2NvbmZpZy0+ZG1fcmVzdG9yZV9maWxlICkKKyAgICAgICAgc3RhdGUtPnNhdmVk
X3N0YXRlID0gR0NTUFJJTlRGKCIlcyIsIGRfY29uZmlnLT5kbV9yZXN0b3JlX2ZpbGUpOworCiAg
ICAgc3RvcmVfbGlieGxfZW50cnkoZ2MsIGRvbWlkLCAmZF9jb25maWctPmJfaW5mbyk7CiAKICAg
ICBsaWJ4bF9fbXVsdGlkZXZfYmVnaW4oYW8sICZkY3MtPm11bHRpZGV2KTsKQEAgLTE4MzMsNiAr
MTg3OCw4IEBAIHN0YXRpYyBpbnQgZG9fZG9tYWluX2NyZWF0ZShsaWJ4bF9jdHggKmN0eCwgbGli
eGxfZG9tYWluX2NvbmZpZyAqZF9jb25maWcsCiAgICAgR0NORVcoY2Rjcyk7CiAgICAgY2Rjcy0+
ZGNzLmFvID0gYW87CiAgICAgY2Rjcy0+ZGNzLmd1ZXN0X2NvbmZpZyA9IGRfY29uZmlnOworICAg
IGNkY3MtPmRjcy5ndWVzdF9kb21pZCA9ICpkb21pZDsKKwogICAgIGxpYnhsX2RvbWFpbl9jb25m
aWdfaW5pdCgmY2Rjcy0+ZGNzLmd1ZXN0X2NvbmZpZ19zYXZlZCk7CiAgICAgbGlieGxfZG9tYWlu
X2NvbmZpZ19jb3B5KGN0eCwgJmNkY3MtPmRjcy5ndWVzdF9jb25maWdfc2F2ZWQsIGRfY29uZmln
KTsKICAgICBjZGNzLT5kY3MucmVzdG9yZV9mZCA9IGNkY3MtPmRjcy5saWJ4Y19mZCA9IHJlc3Rv
cmVfZmQ7CkBAIC0yMDgxLDYgKzIxMjgsNDMgQEAgaW50IGxpYnhsX2RvbWFpbl9jcmVhdGVfbmV3
KGxpYnhsX2N0eCAqY3R4LCBsaWJ4bF9kb21haW5fY29uZmlnICpkX2NvbmZpZywKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBhb19ob3csIGFvcF9jb25zb2xlX2hvdyk7CiB9CiAKK2ludCBs
aWJ4bF9kb21haW5fZm9ya192bShsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgcGRvbWlkLCB1aW50
MzJfdCAqZG9taWQpCit7CisgICAgaW50IHJjOworICAgIHN0cnVjdCB4ZW5fZG9tY3RsX2NyZWF0
ZWRvbWFpbiBjcmVhdGUgPSB7MH07CisgICAgY3JlYXRlLmZsYWdzIHw9IFhFTl9ET01DVExfQ0RG
X2h2bTsKKyAgICBjcmVhdGUuZmxhZ3MgfD0gWEVOX0RPTUNUTF9DREZfaGFwOworICAgIGNyZWF0
ZS5mbGFncyB8PSBYRU5fRE9NQ1RMX0NERl9vb3Nfb2ZmOworICAgIGNyZWF0ZS5hcmNoLmVtdWxh
dGlvbl9mbGFncyA9IChYRU5fWDg2X0VNVV9BTEwgJiB+WEVOX1g4Nl9FTVVfVlBDSSk7CisKKyAg
ICBjcmVhdGUuc3NpZHJlZiA9IFNFQ0lOSVRTSURfRE9NVTsKKyAgICBjcmVhdGUubWF4X3ZjcHVz
ID0gMTsgLy8gcGxhY2Vob2xkZXIsIHdpbGwgYmUgY2xvbmVkIGZyb20gcGRvbWlkCisgICAgY3Jl
YXRlLm1heF9ldnRjaG5fcG9ydCA9IDEwMjM7CisgICAgY3JlYXRlLm1heF9ncmFudF9mcmFtZXMg
PSBMSUJYTF9NQVhfR1JBTlRfRlJBTUVTX0RFRkFVTFQ7CisgICAgY3JlYXRlLm1heF9tYXB0cmFj
a19mcmFtZXMgPSBMSUJYTF9NQVhfTUFQVFJBQ0tfRlJBTUVTX0RFRkFVTFQ7CisKKyAgICBpZiAo
IChyYyA9IHhjX2RvbWFpbl9jcmVhdGUoY3R4LT54Y2gsIGRvbWlkLCAmY3JlYXRlKSkgKQorICAg
ICAgICByZXR1cm4gcmM7CisKKyAgICBpZiAoIChyYyA9IHhjX21lbXNocl9mb3JrKGN0eC0+eGNo
LCBwZG9taWQsICpkb21pZCkpICkKKyAgICAgICAgeGNfZG9tYWluX2Rlc3Ryb3koY3R4LT54Y2gs
ICpkb21pZCk7CisKKyAgICByZXR1cm4gcmM7Cit9CisKK2ludCBsaWJ4bF9kb21haW5fZm9ya19s
YXVuY2hfZG0obGlieGxfY3R4ICpjdHgsIGxpYnhsX2RvbWFpbl9jb25maWcgKmRfY29uZmlnLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBkb21pZCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlieGxfYXN5bmNwcm9ncmVzc19ob3cgKmFv
cF9jb25zb2xlX2hvdykKK3sKKyAgICB1bnNldF9kaXNrX2NvbG9fcmVzdG9yZShkX2NvbmZpZyk7
CisgICAgcmV0dXJuIGRvX2RvbWFpbl9jcmVhdGUoY3R4LCBkX2NvbmZpZywgJmRvbWlkLCAtMSwg
LTEsIDAsIDAsIGFvcF9jb25zb2xlX2hvdyk7Cit9CisKK2ludCBsaWJ4bF9kb21haW5fZm9ya19y
ZXNldChsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgZG9taWQpCit7CisgICAgcmV0dXJuIHhjX21l
bXNocl9mb3JrX3Jlc2V0KGN0eC0+eGNoLCBkb21pZCk7Cit9CisKIGludCBsaWJ4bF9kb21haW5f
Y3JlYXRlX3Jlc3RvcmUobGlieGxfY3R4ICpjdHgsIGxpYnhsX2RvbWFpbl9jb25maWcgKmRfY29u
ZmlnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqZG9taWQsIGlu
dCByZXN0b3JlX2ZkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgc2VuZF9i
YWNrX2ZkLApkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGxfZG0uYyBiL3Rvb2xzL2xpYnhs
L2xpYnhsX2RtLmMKaW5kZXggM2IxZGE5MDE2Ny4uODdhZTE0NzhjZiAxMDA2NDQKLS0tIGEvdG9v
bHMvbGlieGwvbGlieGxfZG0uYworKysgYi90b29scy9saWJ4bC9saWJ4bF9kbS5jCkBAIC0yNzg3
LDcgKzI3ODcsNyBAQCBzdGF0aWMgdm9pZCBkZXZpY2VfbW9kZWxfc3Bhd25fb3V0Y29tZShsaWJ4
bF9fZWdjICplZ2MsCiAKICAgICBsaWJ4bF9fZG9tYWluX2J1aWxkX3N0YXRlICpzdGF0ZSA9IGRt
c3MtPmJ1aWxkX3N0YXRlOwogCi0gICAgaWYgKHN0YXRlLT5zYXZlZF9zdGF0ZSkgeworICAgIGlm
IChzdGF0ZS0+c2F2ZWRfc3RhdGUgJiYgIXN0YXRlLT5mb3JrZWRfdm0pIHsKICAgICAgICAgcmV0
MiA9IHVubGluayhzdGF0ZS0+c2F2ZWRfc3RhdGUpOwogICAgICAgICBpZiAocmV0MikgewogICAg
ICAgICAgICAgTE9HRUQoRVJST1IsIGRtc3MtPmd1ZXN0X2RvbWlkLCAiJXM6IGZhaWxlZCB0byBy
ZW1vdmUgZGV2aWNlLW1vZGVsIHN0YXRlICVzIiwKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xp
YnhsX2RvbS5jIGIvdG9vbHMvbGlieGwvbGlieGxfZG9tLmMKaW5kZXggZDlhZGE4YTQyMi4uZTdj
NTRkZGY2MyAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGwvbGlieGxfZG9tLmMKKysrIGIvdG9vbHMv
bGlieGwvbGlieGxfZG9tLmMKQEAgLTI0OSw5ICsyNDksMTIgQEAgaW50IGxpYnhsX19idWlsZF9w
cmUobGlieGxfX2djICpnYywgdWludDMyX3QgZG9taWQsCiAgICAgbGlieGxfZG9tYWluX2J1aWxk
X2luZm8gKmNvbnN0IGluZm8gPSAmZF9jb25maWctPmJfaW5mbzsKICAgICBsaWJ4bF9jdHggKmN0
eCA9IGxpYnhsX19nY19vd25lcihnYyk7CiAgICAgY2hhciAqeHNfZG9taWQsICpjb25fZG9taWQ7
Ci0gICAgaW50IHJjOworICAgIGludCByYyA9IDA7CiAgICAgdWludDY0X3Qgc2l6ZTsKIAorICAg
IGlmICggc3RhdGUtPmZvcmtlZF92bSApCisgICAgICAgIGdvdG8gc2tpcF9mb3JrOworCiAgICAg
aWYgKHhjX2RvbWFpbl9tYXhfdmNwdXMoY3R4LT54Y2gsIGRvbWlkLCBpbmZvLT5tYXhfdmNwdXMp
ICE9IDApIHsKICAgICAgICAgTE9HKEVSUk9SLCAiQ291bGRuJ3Qgc2V0IG1heCB2Y3B1IGNvdW50
Iik7CiAgICAgICAgIHJldHVybiBFUlJPUl9GQUlMOwpAQCAtMzYyLDcgKzM2NSw2IEBAIGludCBs
aWJ4bF9fYnVpbGRfcHJlKGxpYnhsX19nYyAqZ2MsIHVpbnQzMl90IGRvbWlkLAogICAgICAgICB9
CiAgICAgfQogCi0KICAgICByYyA9IGxpYnhsX19hcmNoX2V4dHJhX21lbW9yeShnYywgaW5mbywg
JnNpemUpOwogICAgIGlmIChyYyA8IDApIHsKICAgICAgICAgTE9HRShFUlJPUiwgIkNvdWxkbid0
IGdldCBhcmNoIGV4dHJhIGNvbnN0YW50IG1lbW9yeSBzaXplIik7CkBAIC0zNzQsNiArMzc2LDEx
IEBAIGludCBsaWJ4bF9fYnVpbGRfcHJlKGxpYnhsX19nYyAqZ2MsIHVpbnQzMl90IGRvbWlkLAog
ICAgICAgICByZXR1cm4gRVJST1JfRkFJTDsKICAgICB9CiAKKyAgICByYyA9IGxpYnhsX19hcmNo
X2RvbWFpbl9jcmVhdGUoZ2MsIGRfY29uZmlnLCBkb21pZCk7CisgICAgaWYgKCByYyApCisgICAg
ICAgIGdvdG8gb3V0OworCitza2lwX2Zvcms6CiAgICAgeHNfZG9taWQgPSB4c19yZWFkKGN0eC0+
eHNoLCBYQlRfTlVMTCwgIi90b29sL3hlbnN0b3JlZC9kb21pZCIsIE5VTEwpOwogICAgIHN0YXRl
LT5zdG9yZV9kb21pZCA9IHhzX2RvbWlkID8gYXRvaSh4c19kb21pZCkgOiAwOwogICAgIGZyZWUo
eHNfZG9taWQpOwpAQCAtMzg1LDggKzM5Miw3IEBAIGludCBsaWJ4bF9fYnVpbGRfcHJlKGxpYnhs
X19nYyAqZ2MsIHVpbnQzMl90IGRvbWlkLAogICAgIHN0YXRlLT5zdG9yZV9wb3J0ID0geGNfZXZ0
Y2huX2FsbG9jX3VuYm91bmQoY3R4LT54Y2gsIGRvbWlkLCBzdGF0ZS0+c3RvcmVfZG9taWQpOwog
ICAgIHN0YXRlLT5jb25zb2xlX3BvcnQgPSB4Y19ldnRjaG5fYWxsb2NfdW5ib3VuZChjdHgtPnhj
aCwgZG9taWQsIHN0YXRlLT5jb25zb2xlX2RvbWlkKTsKIAotICAgIHJjID0gbGlieGxfX2FyY2hf
ZG9tYWluX2NyZWF0ZShnYywgZF9jb25maWcsIGRvbWlkKTsKLQorb3V0OgogICAgIHJldHVybiBy
YzsKIH0KIApAQCAtNDQ0LDYgKzQ1MCw5IEBAIGludCBsaWJ4bF9fYnVpbGRfcG9zdChsaWJ4bF9f
Z2MgKmdjLCB1aW50MzJfdCBkb21pZCwKICAgICBjaGFyICoqZW50czsKICAgICBpbnQgaSwgcmM7
CiAKKyAgICBpZiAoIHN0YXRlLT5mb3JrZWRfdm0gKQorICAgICAgICBnb3RvIHNraXBfZm9yazsK
KwogICAgIGlmIChpbmZvLT5udW1fdm51bWFfbm9kZXMgJiYgIWluZm8tPm51bV92Y3B1X3NvZnRf
YWZmaW5pdHkpIHsKICAgICAgICAgcmMgPSBzZXRfdm51bWFfYWZmaW5pdHkoZ2MsIGRvbWlkLCBp
bmZvKTsKICAgICAgICAgaWYgKHJjKQpAQCAtNDY4LDYgKzQ3Nyw3IEBAIGludCBsaWJ4bF9fYnVp
bGRfcG9zdChsaWJ4bF9fZ2MgKmdjLCB1aW50MzJfdCBkb21pZCwKICAgICAgICAgfQogICAgIH0K
IAorc2tpcF9mb3JrOgogICAgIGVudHMgPSBsaWJ4bF9fY2FsbG9jKGdjLCAxMiArIChpbmZvLT5t
YXhfdmNwdXMgKiAyKSArIDIsIHNpemVvZihjaGFyICopKTsKICAgICBlbnRzWzBdID0gIm1lbW9y
eS9zdGF0aWMtbWF4IjsKICAgICBlbnRzWzFdID0gR0NTUFJJTlRGKCIlIlBSSWQ2NCwgaW5mby0+
bWF4X21lbWtiKTsKQEAgLTczMCwxNCArNzQwLDE2IEBAIHN0YXRpYyBpbnQgaHZtX2J1aWxkX3Nl
dF9wYXJhbXMoeGNfaW50ZXJmYWNlICpoYW5kbGUsIHVpbnQzMl90IGRvbWlkLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsaWJ4bF9kb21haW5fYnVpbGRfaW5mbyAqaW5mbywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHN0b3JlX2V2dGNobiwgdW5zaWduZWQg
bG9uZyAqc3RvcmVfbWZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgY29u
c29sZV9ldnRjaG4sIHVuc2lnbmVkIGxvbmcgKmNvbnNvbGVfbWZuLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkb21pZF90IHN0b3JlX2RvbWlkLCBkb21pZF90IGNvbnNvbGVfZG9t
aWQpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbWlkX3Qgc3RvcmVfZG9taWQs
IGRvbWlkX3QgY29uc29sZV9kb21pZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Ym9vbCBmb3JrZWRfdm0pCiB7CiAgICAgc3RydWN0IGh2bV9pbmZvX3RhYmxlICp2YV9odm07CiAg
ICAgdWludDhfdCAqdmFfbWFwLCBzdW07CiAgICAgdWludDY0X3Qgc3RyX21mbiwgY29uc19tZm47
CiAgICAgaW50IGk7CiAKLSAgICBpZiAoaW5mby0+dHlwZSA9PSBMSUJYTF9ET01BSU5fVFlQRV9I
Vk0pIHsKKyAgICBpZiAoIGluZm8tPnR5cGUgPT0gTElCWExfRE9NQUlOX1RZUEVfSFZNICYmICFm
b3JrZWRfdm0gKQorICAgIHsKICAgICAgICAgdmFfbWFwID0geGNfbWFwX2ZvcmVpZ25fcmFuZ2Uo
aGFuZGxlLCBkb21pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWENf
UEFHRV9TSVpFLCBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBIVk1fSU5GT19QRk4pOwpAQCAtMTA1Myw2ICsxMDY1LDIzIEBAIGlu
dCBsaWJ4bF9fYnVpbGRfaHZtKGxpYnhsX19nYyAqZ2MsIHVpbnQzMl90IGRvbWlkLAogICAgIHN0
cnVjdCB4Y19kb21faW1hZ2UgKmRvbSA9IE5VTEw7CiAgICAgYm9vbCBkZXZpY2VfbW9kZWwgPSBp
bmZvLT50eXBlID09IExJQlhMX0RPTUFJTl9UWVBFX0hWTSA/IHRydWUgOiBmYWxzZTsKIAorICAg
IGlmICggc3RhdGUtPmZvcmtlZF92bSApCisgICAgeworICAgICAgICByYyA9IGh2bV9idWlsZF9z
ZXRfcGFyYW1zKGN0eC0+eGNoLCBkb21pZCwgaW5mbywgc3RhdGUtPnN0b3JlX3BvcnQsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnN0YXRlLT5zdG9yZV9tZm4sIHN0YXRlLT5j
b25zb2xlX3BvcnQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnN0YXRlLT5j
b25zb2xlX21mbiwgc3RhdGUtPnN0b3JlX2RvbWlkLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0YXRlLT5jb25zb2xlX2RvbWlkLCBzdGF0ZS0+Zm9ya2VkX3ZtKTsKKworICAg
ICAgICBpZiAoIHJjICkKKyAgICAgICAgICAgIHJldHVybiByYzsKKworICAgICAgICByZXR1cm4g
eGNfZG9tX2dudHRhYl9zZWVkKGN0eC0+eGNoLCBkb21pZCwgdHJ1ZSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdGF0ZS0+Y29uc29sZV9tZm4sCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RhdGUtPnN0b3JlX21mbiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdGF0ZS0+Y29uc29sZV9kb21pZCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdGF0ZS0+c3RvcmVfZG9taWQpOworICAgIH0KKwogICAgIHhjX2RvbV9s
b2dpbml0KGN0eC0+eGNoKTsKIAogICAgIC8qCkBAIC0xMTc3LDcgKzEyMDYsNyBAQCBpbnQgbGli
eGxfX2J1aWxkX2h2bShsaWJ4bF9fZ2MgKmdjLCB1aW50MzJfdCBkb21pZCwKICAgICByYyA9IGh2
bV9idWlsZF9zZXRfcGFyYW1zKGN0eC0+eGNoLCBkb21pZCwgaW5mbywgc3RhdGUtPnN0b3JlX3Bv
cnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnN0YXRlLT5zdG9yZV9tZm4sIHN0
YXRlLT5jb25zb2xlX3BvcnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnN0YXRl
LT5jb25zb2xlX21mbiwgc3RhdGUtPnN0b3JlX2RvbWlkLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0YXRlLT5jb25zb2xlX2RvbWlkKTsKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdGF0ZS0+Y29uc29sZV9kb21pZCwgZmFsc2UpOwogICAgIGlmIChyYyAhPSAwKSB7
CiAgICAgICAgIExPRyhFUlJPUiwgImh2bSBidWlsZCBzZXQgcGFyYW1zIGZhaWxlZCIpOwogICAg
ICAgICBnb3RvIG91dDsKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhsL2xpYnhsX2ludGVybmFsLmgg
Yi90b29scy9saWJ4bC9saWJ4bF9pbnRlcm5hbC5oCmluZGV4IGRkM2MwOGJjMTQuLmY2OWE4Mzg3
ZWQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhsX2ludGVybmFsLmgKKysrIGIvdG9vbHMv
bGlieGwvbGlieGxfaW50ZXJuYWwuaApAQCAtMTM3NCw2ICsxMzc0LDcgQEAgdHlwZWRlZiBzdHJ1
Y3QgewogCiAgICAgY2hhciAqc2F2ZWRfc3RhdGU7CiAgICAgaW50IGRtX21vbml0b3JfZmQ7Cisg
ICAgYm9vbCBmb3JrZWRfdm07CiAKICAgICBsaWJ4bF9fZmlsZV9yZWZlcmVuY2UgcHZfa2VybmVs
OwogICAgIGxpYnhsX19maWxlX3JlZmVyZW5jZSBwdl9yYW1kaXNrOwpkaWZmIC0tZ2l0IGEvdG9v
bHMvbGlieGwvbGlieGxfdHlwZXMuaWRsIGIvdG9vbHMvbGlieGwvbGlieGxfdHlwZXMuaWRsCmlu
ZGV4IDc5MjE5NTBmNmEuLjdjNGM0MDU3YTkgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhs
X3R5cGVzLmlkbAorKysgYi90b29scy9saWJ4bC9saWJ4bF90eXBlcy5pZGwKQEAgLTk1Niw2ICs5
NTYsNyBAQCBsaWJ4bF9kb21haW5fY29uZmlnID0gU3RydWN0KCJkb21haW5fY29uZmlnIiwgWwog
ICAgICgib25fd2F0Y2hkb2ciLCBsaWJ4bF9hY3Rpb25fb25fc2h1dGRvd24pLAogICAgICgib25f
Y3Jhc2giLCBsaWJ4bF9hY3Rpb25fb25fc2h1dGRvd24pLAogICAgICgib25fc29mdF9yZXNldCIs
IGxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93biksCisgICAgKCJkbV9yZXN0b3JlX2ZpbGUiLCBzdHJp
bmcsIHsnY29uc3QnOiBUcnVlfSksCiAgICAgXSwgZGlyPURJUl9JTikKIAogbGlieGxfZGlza2lu
Zm8gPSBTdHJ1Y3QoImRpc2tpbmZvIiwgWwpkaWZmIC0tZ2l0IGEvdG9vbHMveGwveGwuaCBiL3Rv
b2xzL3hsL3hsLmgKaW5kZXggNjBiZGFkOGZmYi4uOWJkYWQ2NTI2ZSAxMDA2NDQKLS0tIGEvdG9v
bHMveGwveGwuaAorKysgYi90b29scy94bC94bC5oCkBAIC0zMSw2ICszMSw3IEBAIHN0cnVjdCBj
bWRfc3BlYyB7CiB9OwogCiBzdHJ1Y3QgZG9tYWluX2NyZWF0ZSB7CisgICAgdWludDMyX3QgZGRv
bWlkOyAvKiBmb3JrIGxhdW5jaCBkbSBmb3IgdGhpcyBkb21pZCAqLwogICAgIGludCBkZWJ1ZzsK
ICAgICBpbnQgZGFlbW9uaXplOwogICAgIGludCBtb25pdG9yOyAvKiBoYW5kbGUgZ3Vlc3QgcmVi
b290cyBldGMgKi8KQEAgLTQ1LDYgKzQ2LDcgQEAgc3RydWN0IGRvbWFpbl9jcmVhdGUgewogICAg
IGNvbnN0IGNoYXIgKmNvbmZpZ19maWxlOwogICAgIGNoYXIgKmV4dHJhX2NvbmZpZzsgLyogZXh0
cmEgY29uZmlnIHN0cmluZyAqLwogICAgIGNvbnN0IGNoYXIgKnJlc3RvcmVfZmlsZTsKKyAgICBj
b25zdCBjaGFyICpkbV9yZXN0b3JlX2ZpbGU7CiAgICAgY2hhciAqY29sb19wcm94eV9zY3JpcHQ7
CiAgICAgYm9vbCB1c2Vyc3BhY2VfY29sb19wcm94eTsKICAgICBpbnQgbWlncmF0ZV9mZDsgLyog
LTEgbWVhbnMgbm9uZSAqLwpAQCAtMTI3LDYgKzEyOSw5IEBAIGludCBtYWluX3BjaWFzc2lnbmFi
bGVfcmVtb3ZlKGludCBhcmdjLCBjaGFyICoqYXJndik7CiBpbnQgbWFpbl9wY2lhc3NpZ25hYmxl
X2xpc3QoaW50IGFyZ2MsIGNoYXIgKiphcmd2KTsKICNpZm5kZWYgTElCWExfSEFWRV9OT19TVVNQ
RU5EX1JFU1VNRQogaW50IG1haW5fcmVzdG9yZShpbnQgYXJnYywgY2hhciAqKmFyZ3YpOworaW50
IG1haW5fZm9ya192bShpbnQgYXJnYywgY2hhciAqKmFyZ3YpOworaW50IG1haW5fZm9ya19sYXVu
Y2hfZG0oaW50IGFyZ2MsIGNoYXIgKiphcmd2KTsKK2ludCBtYWluX2ZvcmtfcmVzZXQoaW50IGFy
Z2MsIGNoYXIgKiphcmd2KTsKIGludCBtYWluX21pZ3JhdGVfcmVjZWl2ZShpbnQgYXJnYywgY2hh
ciAqKmFyZ3YpOwogaW50IG1haW5fc2F2ZShpbnQgYXJnYywgY2hhciAqKmFyZ3YpOwogaW50IG1h
aW5fbWlncmF0ZShpbnQgYXJnYywgY2hhciAqKmFyZ3YpOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGwv
eGxfY21kdGFibGUuYyBiL3Rvb2xzL3hsL3hsX2NtZHRhYmxlLmMKaW5kZXggM2IzMDJiMmYyMC4u
M2E1ZDM3MTA1NyAxMDA2NDQKLS0tIGEvdG9vbHMveGwveGxfY21kdGFibGUuYworKysgYi90b29s
cy94bC94bF9jbWR0YWJsZS5jCkBAIC0xODUsNiArMTg1LDE4IEBAIHN0cnVjdCBjbWRfc3BlYyBj
bWRfdGFibGVbXSA9IHsKICAgICAgICJSZXN0b3JlIGEgZG9tYWluIGZyb20gYSBzYXZlZCBzdGF0
ZSIsCiAgICAgICAiLSBmb3IgaW50ZXJuYWwgdXNlIG9ubHkiLAogICAgIH0sCisgICAgeyAiZm9y
ay12bSIsCisgICAgICAmbWFpbl9mb3JrX3ZtLCAwLCAxLAorICAgICAgIkZvcmsgYSBkb21haW4g
ZnJvbSB0aGUgcnVubmluZyBwYXJlbnQgZG9taWQiLAorICAgICAgIltvcHRpb25zXSA8RG9taWQ+
IiwKKyAgICAgICItaCAgICAgICAgICAgICAgICAgICAgICAgICAgIFByaW50IHRoaXMgaGVscC5c
biIKKyAgICAgICItQyA8Y29uZmlnPiAgICAgICAgICAgICAgICAgIFVzZSBjb25maWcgZmlsZSBm
b3IgVk0gZm9yay5cbiIKKyAgICAgICItUSA8cWVtdS1zYXZlLWZpbGU+ICAgICAgICAgIFVzZSBx
ZW11IHNhdmUgZmlsZSBmb3IgVk0gZm9yay5cbiIKKyAgICAgICItLWxhdW5jaC1kbSA8eWVzfG5v
fGxhdGU+ICAgIExhdW5jaCBkZXZpY2UgbW9kZWwgKFFFTVUpIGZvciBWTSBmb3JrLlxuIgorICAg
ICAgIi0tZm9yay1yZXNldCAgICAgICAgICAgICAgICAgUmVzZXQgVk0gZm9yay5cbiIKKyAgICAg
ICItcCAgICAgICAgICAgICAgICAgICAgICAgICAgIERvIG5vdCB1bnBhdXNlIGZvcmsgVk0gYWZ0
ZXIgb3BlcmF0aW9uLlxuIgorICAgICAgIi1kICAgICAgICAgICAgICAgICAgICAgICAgICAgRW5h
YmxlIGRlYnVnIG1lc3NhZ2VzLlxuIgorICAgIH0sCiAjZW5kaWYKICAgICB7ICJkdW1wLWNvcmUi
LAogICAgICAgJm1haW5fZHVtcF9jb3JlLCAwLCAxLApkaWZmIC0tZ2l0IGEvdG9vbHMveGwveGxf
c2F2ZXJlc3RvcmUuYyBiL3Rvb2xzL3hsL3hsX3NhdmVyZXN0b3JlLmMKaW5kZXggOWJlMDMzZmU2
NS4uZDk5ZDNlY2ViMiAxMDA2NDQKLS0tIGEvdG9vbHMveGwveGxfc2F2ZXJlc3RvcmUuYworKysg
Yi90b29scy94bC94bF9zYXZlcmVzdG9yZS5jCkBAIC0yMjksNiArMjI5LDEwMyBAQCBpbnQgbWFp
bl9yZXN0b3JlKGludCBhcmdjLCBjaGFyICoqYXJndikKICAgICByZXR1cm4gRVhJVF9TVUNDRVNT
OwogfQogCitpbnQgbWFpbl9mb3JrX3ZtKGludCBhcmdjLCBjaGFyICoqYXJndikKK3sKKyAgICBp
bnQgcmMsIGRlYnVnID0gMDsKKyAgICB1aW50MzJfdCBkb21pZF9pbiA9IElOVkFMSURfRE9NSUQs
IGRvbWlkX291dCA9IElOVkFMSURfRE9NSUQ7CisgICAgaW50IGxhdW5jaF9kbSA9IDE7CisgICAg
Ym9vbCByZXNldCA9IDA7CisgICAgYm9vbCBwYXVzZSA9IDA7CisgICAgY29uc3QgY2hhciAqY29u
ZmlnX2ZpbGUgPSBOVUxMOworICAgIGNvbnN0IGNoYXIgKmRtX3Jlc3RvcmVfZmlsZSA9IE5VTEw7
CisKKyAgICBpbnQgb3B0OworICAgIHN0YXRpYyBzdHJ1Y3Qgb3B0aW9uIG9wdHNbXSA9IHsKKyAg
ICAgICAgeyJsYXVuY2gtZG0iLCAxLCAwLCAnbCd9LAorICAgICAgICB7ImZvcmstcmVzZXQiLCAw
LCAwLCAncid9LAorICAgICAgICBDT01NT05fTE9OR19PUFRTCisgICAgfTsKKworICAgIFNXSVRD
SF9GT1JFQUNIX09QVChvcHQsICJwaGRDOlE6bDpyTjpEOkI6VjoiLCBvcHRzLCAiZm9yay12bSIs
IDEpIHsKKyAgICBjYXNlICdkJzoKKyAgICAgICAgZGVidWcgPSAxOworICAgICAgICBicmVhazsK
KyAgICBjYXNlICdwJzoKKyAgICAgICAgcGF1c2UgPSAxOworICAgICAgICBicmVhazsKKyAgICBj
YXNlICdDJzoKKyAgICAgICAgY29uZmlnX2ZpbGUgPSBvcHRhcmc7CisgICAgICAgIGJyZWFrOwor
ICAgIGNhc2UgJ1EnOgorICAgICAgICBkbV9yZXN0b3JlX2ZpbGUgPSBvcHRhcmc7CisgICAgICAg
IGJyZWFrOworICAgIGNhc2UgJ2wnOgorICAgICAgICBpZiAoICFzdHJjbXAob3B0YXJnLCAibm8i
KSApCisgICAgICAgICAgICBsYXVuY2hfZG0gPSAwOworICAgICAgICBpZiAoICFzdHJjbXAob3B0
YXJnLCAieWVzIikgKQorICAgICAgICAgICAgbGF1bmNoX2RtID0gMTsKKyAgICAgICAgaWYgKCAh
c3RyY21wKG9wdGFyZywgImxhdGUiKSApCisgICAgICAgICAgICBsYXVuY2hfZG0gPSAyOworICAg
ICAgICBicmVhazsKKyAgICBjYXNlICdyJzoKKyAgICAgICAgcmVzZXQgPSAxOworICAgICAgICBi
cmVhazsKKyAgICBjYXNlICdOJzogLyogZmFsbC10aHJvdWdoICovCisgICAgY2FzZSAnRCc6IC8q
IGZhbGwtdGhyb3VnaCAqLworICAgIGNhc2UgJ0InOiAvKiBmYWxsLXRocm91Z2ggKi8KKyAgICBj
YXNlICdWJzoKKyAgICAgICAgZnByaW50ZihzdGRlcnIsICJVbmltcGxlbWVudGVkIG9wdGlvbihz
KVxuIik7CisgICAgICAgIHJldHVybiBFWElUX0ZBSUxVUkU7CisgICAgfQorCisgICAgaWYgKGFy
Z2Mtb3B0aW5kID09IDEpIHsKKyAgICAgICAgZG9taWRfaW4gPSBhdG9pKGFyZ3Zbb3B0aW5kXSk7
CisgICAgfSBlbHNlIHsKKyAgICAgICAgaGVscCgiZm9yay12bSIpOworICAgICAgICByZXR1cm4g
RVhJVF9GQUlMVVJFOworICAgIH0KKworICAgIGlmIChsYXVuY2hfZG0gJiYgKCFjb25maWdfZmls
ZSB8fCAhZG1fcmVzdG9yZV9maWxlKSkgeworICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkN1cnJl
bnRseSB5b3UgbXVzdCBwcm92aWRlIGJvdGggLUMgYW5kIC1RIG9wdGlvbnNcbiIpOworICAgICAg
ICByZXR1cm4gRVhJVF9GQUlMVVJFOworICAgIH0KKworICAgIGlmIChyZXNldCkgeworICAgICAg
ICBkb21pZF9vdXQgPSBkb21pZF9pbjsKKyAgICAgICAgaWYgKGxpYnhsX2RvbWFpbl9mb3JrX3Jl
c2V0KGN0eCwgZG9taWRfaW4pID09IEVYSVRfRkFJTFVSRSkKKyAgICAgICAgICAgIHJldHVybiBF
WElUX0ZBSUxVUkU7CisgICAgfQorCisgICAgaWYgKGxhdW5jaF9kbSA9PSAyIHx8IHJlc2V0KSB7
CisgICAgICAgIGRvbWlkX291dCA9IGRvbWlkX2luOworICAgICAgICByYyA9IEVYSVRfU1VDQ0VT
UzsKKyAgICB9IGVsc2UKKyAgICAgICAgcmMgPSBsaWJ4bF9kb21haW5fZm9ya192bShjdHgsIGRv
bWlkX2luLCAmZG9taWRfb3V0KTsKKworICAgIGlmIChyYyA9PSBFWElUX1NVQ0NFU1MpIHsKKyAg
ICAgICAgaWYgKCBsYXVuY2hfZG0gKSB7CisgICAgICAgICAgICBzdHJ1Y3QgZG9tYWluX2NyZWF0
ZSBkb21faW5mbzsKKyAgICAgICAgICAgIG1lbXNldCgmZG9tX2luZm8sIDAsIHNpemVvZihkb21f
aW5mbykpOworICAgICAgICAgICAgZG9tX2luZm8uZGRvbWlkID0gZG9taWRfb3V0OworICAgICAg
ICAgICAgZG9tX2luZm8uZG1fcmVzdG9yZV9maWxlID0gZG1fcmVzdG9yZV9maWxlOworICAgICAg
ICAgICAgZG9tX2luZm8uZGVidWcgPSBkZWJ1ZzsKKyAgICAgICAgICAgIGRvbV9pbmZvLnBhdXNl
ZCA9IHBhdXNlOworICAgICAgICAgICAgZG9tX2luZm8uY29uZmlnX2ZpbGUgPSBjb25maWdfZmls
ZTsKKyAgICAgICAgICAgIGRvbV9pbmZvLm1pZ3JhdGVfZmQgPSAtMTsKKyAgICAgICAgICAgIGRv
bV9pbmZvLnNlbmRfYmFja19mZCA9IC0xOworICAgICAgICAgICAgcmMgPSBjcmVhdGVfZG9tYWlu
KCZkb21faW5mbykgPCAwID8gRVhJVF9GQUlMVVJFIDogRVhJVF9TVUNDRVNTOworICAgICAgICB9
IGVsc2UgaWYgKCAhcGF1c2UgKQorICAgICAgICAgICAgcmMgPSBsaWJ4bF9kb21haW5fdW5wYXVz
ZShjdHgsIGRvbWlkX291dCwgTlVMTCk7CisgICAgfQorCisgICAgaWYgKHJjID09IEVYSVRfU1VD
Q0VTUykKKyAgICAgICAgZnByaW50ZihzdGRlcnIsICJmb3JrLXZtIGNvbW1hbmQgc3VjY2Vzc2Z1
bGx5IHJldHVybmVkIGRvbWlkOiAldVxuIiwgZG9taWRfb3V0KTsKKyAgICBlbHNlIGlmICggZG9t
aWRfb3V0ICE9IElOVkFMSURfRE9NSUQgKQorICAgICAgICBsaWJ4bF9kb21haW5fZGVzdHJveShj
dHgsIGRvbWlkX291dCwgMCk7CisKKyAgICByZXR1cm4gcmM7Cit9CisKIGludCBtYWluX3NhdmUo
aW50IGFyZ2MsIGNoYXIgKiphcmd2KQogewogICAgIHVpbnQzMl90IGRvbWlkOwpkaWZmIC0tZ2l0
IGEvdG9vbHMveGwveGxfdm1jb250cm9sLmMgYi90b29scy94bC94bF92bWNvbnRyb2wuYwppbmRl
eCBlNTIwYjFkYTc5Li5kOWNiMTljNTk5IDEwMDY0NAotLS0gYS90b29scy94bC94bF92bWNvbnRy
b2wuYworKysgYi90b29scy94bC94bF92bWNvbnRyb2wuYwpAQCAtNjQ1LDYgKzY0NSw3IEBAIGlu
dCBjcmVhdGVfZG9tYWluKHN0cnVjdCBkb21haW5fY3JlYXRlICpkb21faW5mbykKIAogICAgIGxp
YnhsX2RvbWFpbl9jb25maWcgZF9jb25maWc7CiAKKyAgICB1aW50MzJfdCBkZG9taWQgPSBkb21f
aW5mby0+ZGRvbWlkOyAvLyBsYXVuY2ggZG0gZm9yIHRoaXMgZG9tYWluIGlmZiBzZXQKICAgICBp
bnQgZGVidWcgPSBkb21faW5mby0+ZGVidWc7CiAgICAgaW50IGRhZW1vbml6ZSA9IGRvbV9pbmZv
LT5kYWVtb25pemU7CiAgICAgaW50IG1vbml0b3IgPSBkb21faW5mby0+bW9uaXRvcjsKQEAgLTY1
NSw2ICs2NTYsNyBAQCBpbnQgY3JlYXRlX2RvbWFpbihzdHJ1Y3QgZG9tYWluX2NyZWF0ZSAqZG9t
X2luZm8pCiAgICAgY29uc3QgY2hhciAqcmVzdG9yZV9maWxlID0gZG9tX2luZm8tPnJlc3RvcmVf
ZmlsZTsKICAgICBjb25zdCBjaGFyICpjb25maWdfc291cmNlID0gTlVMTDsKICAgICBjb25zdCBj
aGFyICpyZXN0b3JlX3NvdXJjZSA9IE5VTEw7CisgICAgY29uc3QgY2hhciAqZG1fcmVzdG9yZV9m
aWxlID0gZG9tX2luZm8tPmRtX3Jlc3RvcmVfZmlsZTsKICAgICBpbnQgbWlncmF0ZV9mZCA9IGRv
bV9pbmZvLT5taWdyYXRlX2ZkOwogICAgIGJvb2wgY29uZmlnX2luX2pzb247CiAKQEAgLTkyMyw2
ICs5MjUsMTIgQEAgc3RhcnQ6CiAgICAgICAgICAqIHJlc3RvcmUvbWlncmF0ZS1yZWNlaXZlIGl0
IGFnYWluLgogICAgICAgICAgKi8KICAgICAgICAgcmVzdG9yaW5nID0gMDsKKyAgICB9IGVsc2Ug
aWYgKCBkZG9taWQgKSB7CisgICAgICAgIGRfY29uZmlnLmRtX3Jlc3RvcmVfZmlsZSA9IGRtX3Jl
c3RvcmVfZmlsZTsKKyAgICAgICAgcmV0ID0gbGlieGxfZG9tYWluX2ZvcmtfbGF1bmNoX2RtKGN0
eCwgJmRfY29uZmlnLCBkZG9taWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBhdXRvY29ubmVjdF9jb25zb2xlX2hvdyk7CisgICAgICAgIGRvbWlkID0gZGRvbWlk
OworICAgICAgICBkZG9taWQgPSBJTlZBTElEX0RPTUlEOwogICAgIH0gZWxzZSBpZiAoZG9taWRf
c29mdF9yZXNldCAhPSBJTlZBTElEX0RPTUlEKSB7CiAgICAgICAgIC8qIERvIHNvZnQgcmVzZXQu
ICovCiAgICAgICAgIHJldCA9IGxpYnhsX2RvbWFpbl9zb2Z0X3Jlc2V0KGN0eCwgJmRfY29uZmln
LCBkb21pZF9zb2Z0X3Jlc2V0LAotLSAKMi4yMC4xCgoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxA
bGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFu
L2xpc3RpbmZvL3hlbi1kZXZlbA==

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C0D45C1AF2
	for <lists+xen-devel@lfdr.de>; Mon, 30 Sep 2019 07:24:52 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEo8b-0002Pk-0b; Mon, 30 Sep 2019 05:22:21 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=hbFO=XZ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iEo8Z-0002Nr-BV
 for xen-devel@lists.xenproject.org; Mon, 30 Sep 2019 05:22:19 +0000
X-Inumbo-ID: 30c694f4-e342-11e9-8628-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 30c694f4-e342-11e9-8628-bc764e2007e4;
 Mon, 30 Sep 2019 05:21:44 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 5D44BB090;
 Mon, 30 Sep 2019 05:21:41 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 30 Sep 2019 07:21:25 +0200
Message-Id: <20190930052135.11257-10-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190930052135.11257-1-jgross@suse.com>
References: <20190930052135.11257-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v5 09/19] xen/sched: move per-cpu variable
 scheduler to struct sched_resource
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SGF2aW5nIGEgcG9pbnRlciB0byBzdHJ1Y3Qgc2NoZWR1bGVyIGluIHN0cnVjdCBzY2hlZF9yZXNv
dXJjZSBpbnN0ZWFkCm9mIHBlciBjcHUgaXMgZW5vdWdoLgoKU2lnbmVkLW9mZi1ieTogSnVlcmdl
biBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogRGFyaW8gRmFnZ2lvbGkgPGRmYWdnaW9saUBzdXNl
LmNvbT4KLS0tClYxOiBuZXcgcGF0Y2gKVjQ6Ci0gc2V2ZXJhbCByZW5hbWVzIHNkIC0+IHNyIChK
YW4gQmV1bGljaCkKLSB1c2Ugb3BzIGluc3RlYWQgb3Igc3ItPnNjaGVkdWxlciAoSmFuIEJldWxp
Y2gpCi0tLQogeGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYyAgfCAxOCArKysrKysrKysrKy0tLS0t
LS0KIHhlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jIHwgIDMgKystCiB4ZW4vY29tbW9uL3NjaGVk
dWxlLmMgICAgICB8IDE1ICsrKysrKystLS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLWlm
LmggfCAgMiArLQogNCBmaWxlcyBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspLCAxNyBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jIGIveGVuL2NvbW1v
bi9zY2hlZF9jcmVkaXQuYwppbmRleCBhNmRmZjhlYzYyLi44NjYwM2FkY2I2IDEwMDY0NAotLS0g
YS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
LmMKQEAgLTM1Miw5ICszNTIsMTAgQEAgREVGSU5FX1BFUl9DUFUodW5zaWduZWQgaW50LCBsYXN0
X3RpY2tsZV9jcHUpOwogc3RhdGljIGlubGluZSB2b2lkIF9fcnVucV90aWNrbGUoc3RydWN0IGNz
Y2hlZF91bml0ICpuZXcpCiB7CiAgICAgdW5zaWduZWQgaW50IGNwdSA9IHNjaGVkX3VuaXRfbWFz
dGVyKG5ldy0+dW5pdCk7CisgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hl
ZF9yZXMoY3B1KTsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCA9IG5ldy0+dW5pdDsKICAg
ICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKiBjb25zdCBjdXIgPSBDU0NIRURfVU5JVChjdXJyX29uX2Nw
dShjcHUpKTsKLSAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKHBl
cl9jcHUoc2NoZWR1bGVyLCBjcHUpKTsKKyAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9
IENTQ0hFRF9QUklWKHNyLT5zY2hlZHVsZXIpOwogICAgIGNwdW1hc2tfdCBtYXNrLCBpZGxlX21h
c2ssICpvbmxpbmU7CiAgICAgaW50IGJhbGFuY2Vfc3RlcCwgaWRsZXJzX2VtcHR5OwogCkBAIC05
MzEsNyArOTMyLDggQEAgY3NjaGVkX3VuaXRfYWNjdChzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBy
diwgdW5zaWduZWQgaW50IGNwdSkKIHsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqY3VycnVuaXQg
PSBjdXJyZW50LT5zY2hlZF91bml0OwogICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqIGNvbnN0IHN2
YyA9IENTQ0hFRF9VTklUKGN1cnJ1bml0KTsKLSAgICBjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpv
cHMgPSBwZXJfY3B1KHNjaGVkdWxlciwgY3B1KTsKKyAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2Ug
KnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUpOworICAgIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cyA9IHNyLT5zY2hlZHVsZXI7CiAKICAgICBBU1NFUlQoIHNjaGVkX3VuaXRfbWFzdGVyKGN1cnJ1
bml0KSA9PSBjcHUgKTsKICAgICBBU1NFUlQoIHN2Yy0+c2RvbSAhPSBOVUxMICk7CkBAIC05ODcs
OCArOTg5LDcgQEAgY3NjaGVkX3VuaXRfYWNjdChzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwg
dW5zaWduZWQgaW50IGNwdSkKICAgICAgICAgICAgICAqIGlkbGVycy4gQnV0LCBpZiB3ZSBhcmUg
aGVyZSwgaXQgbWVhbnMgdGhlcmUgaXMgc29tZW9uZSBydW5uaW5nCiAgICAgICAgICAgICAgKiBv
biBpdCwgYW5kIGhlbmNlIHRoZSBiaXQgbXVzdCBiZSB6ZXJvIGFscmVhZHkuCiAgICAgICAgICAg
ICAgKi8KLSAgICAgICAgICAgIEFTU0VSVCghY3B1bWFza190ZXN0X2NwdShjcHUsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ1NDSEVEX1BSSVYocGVyX2NwdShzY2hlZHVs
ZXIsIGNwdSkpLT5pZGxlcnMpKTsKKyAgICAgICAgICAgIEFTU0VSVCghY3B1bWFza190ZXN0X2Nw
dShjcHUsIENTQ0hFRF9QUklWKG9wcyktPmlkbGVycykpOwogICAgICAgICAgICAgY3B1X3JhaXNl
X3NvZnRpcnEoY3B1LCBTQ0hFRFVMRV9TT0ZUSVJRKTsKICAgICAgICAgfQogICAgIH0KQEAgLTEw
ODMsNiArMTA4NCw3IEBAIGNzY2hlZF91bml0X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
Km9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAgc3RydWN0IGNzY2hlZF91bml0
ICogY29uc3Qgc3ZjID0gQ1NDSEVEX1VOSVQodW5pdCk7CiAgICAgdW5zaWduZWQgaW50IGNwdSA9
IHNjaGVkX3VuaXRfbWFzdGVyKHVuaXQpOworICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3Ig
PSBnZXRfc2NoZWRfcmVzKGNwdSk7CiAKICAgICBTQ0hFRF9TVEFUX0NSQU5LKHVuaXRfc2xlZXAp
OwogCkBAIC0xMDk1LDcgKzEwOTcsNyBAQCBjc2NoZWRfdW5pdF9zbGVlcChjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogICAgICAgICAgKiBCdXQs
IHdlIGFyZSBoZXJlIGJlY2F1c2UgdW5pdCBpcyBnb2luZyB0byBzbGVlcCB3aGlsZSBydW5uaW5n
IG9uIGNwdSwKICAgICAgICAgICogc28gdGhlIGJpdCBtdXN0IGJlIHplcm8gYWxyZWFkeS4KICAg
ICAgICAgICovCi0gICAgICAgIEFTU0VSVCghY3B1bWFza190ZXN0X2NwdShjcHUsIENTQ0hFRF9Q
UklWKHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpKS0+aWRsZXJzKSk7CisgICAgICAgIEFTU0VSVCgh
Y3B1bWFza190ZXN0X2NwdShjcHUsIENTQ0hFRF9QUklWKHNyLT5zY2hlZHVsZXIpLT5pZGxlcnMp
KTsKICAgICAgICAgY3B1X3JhaXNlX3NvZnRpcnEoY3B1LCBTQ0hFRFVMRV9TT0ZUSVJRKTsKICAg
ICB9CiAgICAgZWxzZSBpZiAoIF9fdW5pdF9vbl9ydW5xKHN2YykgKQpAQCAtMTU3NSw4ICsxNTc3
LDkgQEAgc3RhdGljIHZvaWQKIGNzY2hlZF90aWNrKHZvaWQgKl9jcHUpCiB7CiAgICAgdW5zaWdu
ZWQgaW50IGNwdSA9ICh1bnNpZ25lZCBsb25nKV9jcHU7CisgICAgc3RydWN0IHNjaGVkX3Jlc291
cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkX3BjcHUgKnNw
YyA9IENTQ0hFRF9QQ1BVKGNwdSk7Ci0gICAgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYgPSBD
U0NIRURfUFJJVihwZXJfY3B1KHNjaGVkdWxlciwgY3B1KSk7CisgICAgc3RydWN0IGNzY2hlZF9w
cml2YXRlICpwcnYgPSBDU0NIRURfUFJJVihzci0+c2NoZWR1bGVyKTsKIAogICAgIHNwYy0+dGlj
aysrOwogCkBAIC0xNjAxLDcgKzE2MDQsOCBAQCBjc2NoZWRfdGljayh2b2lkICpfY3B1KQogc3Rh
dGljIHN0cnVjdCBjc2NoZWRfdW5pdCAqCiBjc2NoZWRfcnVucV9zdGVhbChpbnQgcGVlcl9jcHUs
IGludCBjcHUsIGludCBwcmksIGludCBiYWxhbmNlX3N0ZXApCiB7Ci0gICAgY29uc3Qgc3RydWN0
IGNzY2hlZF9wcml2YXRlICogY29uc3QgcHJ2ID0gQ1NDSEVEX1BSSVYocGVyX2NwdShzY2hlZHVs
ZXIsIGNwdSkpOworICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBnZXRfc2NoZWRfcmVz
KGNwdSk7CisgICAgY29uc3Qgc3RydWN0IGNzY2hlZF9wcml2YXRlICogY29uc3QgcHJ2ID0gQ1ND
SEVEX1BSSVYoc3ItPnNjaGVkdWxlcik7CiAgICAgY29uc3Qgc3RydWN0IGNzY2hlZF9wY3B1ICog
Y29uc3QgcGVlcl9wY3B1ID0gQ1NDSEVEX1BDUFUocGVlcl9jcHUpOwogICAgIHN0cnVjdCBjc2No
ZWRfdW5pdCAqc3BlZXI7CiAgICAgc3RydWN0IGxpc3RfaGVhZCAqaXRlcjsKZGlmZiAtLWdpdCBh
L3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMK
aW5kZXggZDUxZGYwNTg4Ny4uYWY1OGVlMTYxZCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hl
ZF9jcmVkaXQyLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMKQEAgLTMyNjgsOCAr
MzI2OCw5IEBAIHJ1bnFfY2FuZGlkYXRlKHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJx
ZCwKICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqc2tpcHBlZCkKIHsKICAgICBzdHJ1Y3Qg
bGlzdF9oZWFkICppdGVyLCAqdGVtcDsKKyAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0g
Z2V0X3NjaGVkX3JlcyhjcHUpOwogICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKnNuZXh0ID0gTlVM
TDsKLSAgICBzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpwcnYgPSBjc2NoZWQyX3ByaXYocGVyX2Nw
dShzY2hlZHVsZXIsIGNwdSkpOworICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNz
Y2hlZDJfcHJpdihzci0+c2NoZWR1bGVyKTsKICAgICBib29sIHlpZWxkID0gZmFsc2UsIHNvZnRf
YWZmX3ByZWVtcHQgPSBmYWxzZTsKIAogICAgICpza2lwcGVkID0gMDsKZGlmZiAtLWdpdCBhL3hl
bi9jb21tb24vc2NoZWR1bGUuYyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwppbmRleCA5NDQyYmUx
YzgzLi41ZTljZWUxZjgyIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMKKysrIGIv
eGVuL2NvbW1vbi9zY2hlZHVsZS5jCkBAIC03NSw3ICs3NSw2IEBAIHN0YXRpYyB2b2lkIHZjcHVf
c2luZ2xlc2hvdF90aW1lcl9mbih2b2lkICpkYXRhKTsKIHN0YXRpYyB2b2lkIHBvbGxfdGltZXJf
Zm4odm9pZCAqZGF0YSk7CiAKIC8qIFRoaXMgaXMgZ2xvYmFsIGZvciBub3cgc28gdGhhdCBwcml2
YXRlIGltcGxlbWVudGF0aW9ucyBjYW4gcmVhY2ggaXQgKi8KLURFRklORV9QRVJfQ1BVKHN0cnVj
dCBzY2hlZHVsZXIgKiwgc2NoZWR1bGVyKTsKIERFRklORV9QRVJfQ1BVX1JFQURfTU9TVExZKHN0
cnVjdCBzY2hlZF9yZXNvdXJjZSAqLCBzY2hlZF9yZXMpOwogc3RhdGljIERFRklORV9QRVJfQ1BV
X1JFQURfTU9TVExZKHVuc2lnbmVkIGludCwgc2NoZWRfcmVzX2lkeCk7CiAKQEAgLTIwMCw3ICsx
OTksNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBzY2hlZHVsZXIgKnVuaXRfc2NoZWR1bGVyKGNv
bnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogICAgICAqLwogCiAgICAgQVNTRVJUKGlzX2lk
bGVfZG9tYWluKGQpKTsKLSAgICByZXR1cm4gcGVyX2NwdShzY2hlZHVsZXIsIHVuaXQtPnJlcy0+
bWFzdGVyX2NwdSk7CisgICAgcmV0dXJuIHVuaXQtPnJlcy0+c2NoZWR1bGVyOwogfQogCiBzdGF0
aWMgaW5saW5lIHN0cnVjdCBzY2hlZHVsZXIgKnZjcHVfc2NoZWR1bGVyKGNvbnN0IHN0cnVjdCB2
Y3B1ICp2KQpAQCAtMTkyMSw4ICsxOTIwLDggQEAgc3RhdGljIGJvb2wgc2NoZWRfdGFza2xldF9j
aGVjayh1bnNpZ25lZCBpbnQgY3B1KQogc3RhdGljIHN0cnVjdCBzY2hlZF91bml0ICpkb19zY2hl
ZHVsZShzdHJ1Y3Qgc2NoZWRfdW5pdCAqcHJldiwgc190aW1lX3Qgbm93LAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgY3B1KQogewotICAgIHN0cnVj
dCBzY2hlZHVsZXIgKnNjaGVkID0gcGVyX2NwdShzY2hlZHVsZXIsIGNwdSk7CiAgICAgc3RydWN0
IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBzdHJ1Y3Qgc2No
ZWR1bGVyICpzY2hlZCA9IHNyLT5zY2hlZHVsZXI7CiAgICAgc3RydWN0IHNjaGVkX3VuaXQgKm5l
eHQ7CiAKICAgICAvKiBnZXQgcG9saWN5LXNwZWNpZmljIGRlY2lzaW9uIG9uIHNjaGVkdWxpbmcu
Li4gKi8KQEAgLTIzNDIsNyArMjM0MSw3IEBAIHN0YXRpYyBpbnQgY3B1X3NjaGVkdWxlX3VwKHVu
c2lnbmVkIGludCBjcHUpCiAgICAgc3ItPmNwdXMgPSBjcHVtYXNrX29mKGNwdSk7CiAgICAgc2V0
X3NjaGVkX3JlcyhjcHUsIHNyKTsKIAotICAgIHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpID0gJnNj
aGVkX2lkbGVfb3BzOworICAgIHNyLT5zY2hlZHVsZXIgPSAmc2NoZWRfaWRsZV9vcHM7CiAgICAg
c3Bpbl9sb2NrX2luaXQoJnNyLT5fbG9jayk7CiAgICAgc3ItPnNjaGVkdWxlX2xvY2sgPSAmc2No
ZWRfZnJlZV9jcHVfbG9jazsKICAgICBpbml0X3RpbWVyKCZzci0+c190aW1lciwgc190aW1lcl9m
biwgTlVMTCwgY3B1KTsKQEAgLTI1NTMsNyArMjU1Miw3IEBAIGludCBzY2hlZHVsZV9jcHVfc3dp
dGNoKHVuc2lnbmVkIGludCBjcHUsIHN0cnVjdCBjcHVwb29sICpjKQogewogICAgIHN0cnVjdCB2
Y3B1ICppZGxlOwogICAgIHZvaWQgKnBwcml2LCAqcHByaXZfb2xkLCAqdnByaXYsICp2cHJpdl9v
bGQ7Ci0gICAgc3RydWN0IHNjaGVkdWxlciAqb2xkX29wcyA9IHBlcl9jcHUoc2NoZWR1bGVyLCBj
cHUpOworICAgIHN0cnVjdCBzY2hlZHVsZXIgKm9sZF9vcHMgPSBnZXRfc2NoZWRfcmVzKGNwdSkt
PnNjaGVkdWxlcjsKICAgICBzdHJ1Y3Qgc2NoZWR1bGVyICpuZXdfb3BzID0gKGMgPT0gTlVMTCkg
PyAmc2NoZWRfaWRsZV9vcHMgOiBjLT5zY2hlZDsKICAgICBzdHJ1Y3QgY3B1cG9vbCAqb2xkX3Bv
b2wgPSBwZXJfY3B1KGNwdXBvb2wsIGNwdSk7CiAgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpz
ZCA9IGdldF9zY2hlZF9yZXMoY3B1KTsKQEAgLTI2MTcsNyArMjYxNiw3IEBAIGludCBzY2hlZHVs
ZV9jcHVfc3dpdGNoKHVuc2lnbmVkIGludCBjcHUsIHN0cnVjdCBjcHVwb29sICpjKQogICAgIHBw
cml2X29sZCA9IHNkLT5zY2hlZF9wcml2OwogICAgIG5ld19sb2NrID0gc2NoZWRfc3dpdGNoX3Nj
aGVkKG5ld19vcHMsIGNwdSwgcHByaXYsIHZwcml2KTsKIAotICAgIHBlcl9jcHUoc2NoZWR1bGVy
LCBjcHUpID0gbmV3X29wczsKKyAgICBzZC0+c2NoZWR1bGVyID0gbmV3X29wczsKICAgICBzZC0+
c2NoZWRfcHJpdiA9IHBwcml2OwogCiAgICAgLyoKQEAgLTI3MTcsNyArMjcxNiw3IEBAIHZvaWQg
c2NoZWRfdGlja19zdXNwZW5kKHZvaWQpCiAgICAgc3RydWN0IHNjaGVkdWxlciAqc2NoZWQ7CiAg
ICAgdW5zaWduZWQgaW50IGNwdSA9IHNtcF9wcm9jZXNzb3JfaWQoKTsKIAotICAgIHNjaGVkID0g
cGVyX2NwdShzY2hlZHVsZXIsIGNwdSk7CisgICAgc2NoZWQgPSBnZXRfc2NoZWRfcmVzKGNwdSkt
PnNjaGVkdWxlcjsKICAgICBzY2hlZF9kb190aWNrX3N1c3BlbmQoc2NoZWQsIGNwdSk7CiAgICAg
cmN1X2lkbGVfZW50ZXIoY3B1KTsKICAgICByY3VfaWRsZV90aW1lcl9zdGFydCgpOwpAQCAtMjcz
MCw3ICsyNzI5LDcgQEAgdm9pZCBzY2hlZF90aWNrX3Jlc3VtZSh2b2lkKQogCiAgICAgcmN1X2lk
bGVfdGltZXJfc3RvcCgpOwogICAgIHJjdV9pZGxlX2V4aXQoY3B1KTsKLSAgICBzY2hlZCA9IHBl
cl9jcHUoc2NoZWR1bGVyLCBjcHUpOworICAgIHNjaGVkID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5z
Y2hlZHVsZXI7CiAgICAgc2NoZWRfZG9fdGlja19yZXN1bWUoc2NoZWQsIGNwdSk7CiB9CiAKZGlm
ZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIGIveGVuL2luY2x1ZGUveGVuL3Nj
aGVkLWlmLmgKaW5kZXggMDIxYzFkN2MyYy4uMDE4MjFiM2U1YiAxMDA2NDQKLS0tIGEveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLWlmLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKQEAg
LTM2LDYgKzM2LDcgQEAgZXh0ZXJuIGNvbnN0IGNwdW1hc2tfdCAqc2NoZWRfcmVzX21hc2s7CiAg
KiBhcyB0aGUgcmVzdCBvZiB0aGUgc3RydWN0LiAgSnVzdCBoYXZlIHRoZSBzY2hlZHVsZXIgcG9p
bnQgdG8gdGhlCiAgKiBvbmUgaXQgd2FudHMgKFRoaXMgbWF5IGJlIHRoZSBvbmUgcmlnaHQgaW4g
ZnJvbnQgb2YgaXQpLiovCiBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgeworICAgIHN0cnVjdCBzY2hl
ZHVsZXIgICAqc2NoZWR1bGVyOwogICAgIHNwaW5sb2NrX3QgICAgICAgICAqc2NoZWR1bGVfbG9j
aywKICAgICAgICAgICAgICAgICAgICAgICAgX2xvY2s7CiAgICAgc3RydWN0IHNjaGVkX3VuaXQg
ICpjdXJyOwpAQCAtNDksNyArNTAsNiBAQCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgewogICAgIGNv
bnN0IGNwdW1hc2tfdCAgICAqY3B1czsgICAgICAgICAgIC8qIGNwdXMgY292ZXJlZCBieSB0aGlz
IHN0cnVjdCAgICAgKi8KIH07CiAKLURFQ0xBUkVfUEVSX0NQVShzdHJ1Y3Qgc2NoZWR1bGVyICos
IHNjaGVkdWxlcik7CiBERUNMQVJFX1BFUl9DUFUoc3RydWN0IGNwdXBvb2wgKiwgY3B1cG9vbCk7
CiBERUNMQVJFX1BFUl9DUFUoc3RydWN0IHNjaGVkX3Jlc291cmNlICosIHNjaGVkX3Jlcyk7CiAK
LS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3Jn
Cmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id BFE41C1108
	for <lists+xen-devel@lfdr.de>; Sat, 28 Sep 2019 16:23:30 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEDbA-0003mr-KE; Sat, 28 Sep 2019 14:21:24 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=9Ov/=XX=invisiblethingslab.com=marmarek@srs-us1.protection.inumbo.net>)
 id 1iEDb8-0003m4-DH
 for xen-devel@lists.xenproject.org; Sat, 28 Sep 2019 14:21:22 +0000
X-Inumbo-ID: 3a77441e-e1fb-11e9-b588-bc764e2007e4
Received: from out5-smtp.messagingengine.com (unknown [66.111.4.29])
 by localhost (Halon) with ESMTPS
 id 3a77441e-e1fb-11e9-b588-bc764e2007e4;
 Sat, 28 Sep 2019 14:21:14 +0000 (UTC)
Received: from compute7.internal (compute7.nyi.internal [10.202.2.47])
 by mailout.nyi.internal (Postfix) with ESMTP id 7362921CDD;
 Sat, 28 Sep 2019 10:21:14 -0400 (EDT)
Received: from mailfrontend2 ([10.202.2.163])
 by compute7.internal (MEProxy); Sat, 28 Sep 2019 10:21:14 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
 messagingengine.com; h=cc:content-transfer-encoding:content-type
 :date:from:in-reply-to:message-id:mime-version:references
 :subject:to:x-me-proxy:x-me-proxy:x-me-sender:x-me-sender
 :x-sasl-enc; s=fm3; bh=HAmib2qqZ5oj8XczRtcegzLko/r9WTZq+MH/BELfW
 UI=; b=syT9x8jTXgX573Yq9m3LHwPScUstkraRJ7rielm3gGFbdJ+UhEwz9oWyO
 UM5MEmayaJoUmxrEricMjiqQsnQz/BgxXljxgdxRYsc+wGcQj31xQVhSd+/vc3AC
 ieKQUpukLsfgvI1P/1X33k9R4L9c0nv5dF79EbiQ2Lm4gYZK0M3vIn74hEeoPovE
 iZXIs+et4pKEsBJn4PI7VzPFbbIORw3g+3ZeP7eDOZls2T6ZfzHZYh0UUBPSlQ3l
 Ix+chP5vCf+DdqE42ii5Pkpd7mh3EO6WMdB9zqnumfpHum4fk9XaNsL/HvzEw6Sa
 xWwPpqenAqXNz5HhxvBMfaBgzRtAw==
X-ME-Sender: <xms:WmyPXaQYveb_mozV9gx34HngtCmljgaynwMX0FFtmY59yBXla3ASZw>
X-ME-Proxy-Cause: gggruggvucftvghtrhhoucdtuddrgedufedrfeekgdejgecutefuodetggdotefrodftvf
 curfhrohhfihhlvgemucfhrghsthforghilhdpqfgfvfdpuffrtefokffrpgfnqfghnecu
 uegrihhlohhuthemuceftddtnecusecvtfgvtghiphhivghnthhsucdlqddutddtmdenuc
 fjughrpefhvffufffkofgjfhggtgfgsehtkeertdertdejnecuhfhrohhmpeforghrvghk
 ucforghrtgiihihkohifshhkihdqifpkrhgvtghkihcuoehmrghrmhgrrhgvkhesihhnvh
 hishhisghlvghthhhinhhgshhlrggsrdgtohhmqeenucfkphepledurdeihedrfeegrdef
 feenucfrrghrrghmpehmrghilhhfrhhomhepmhgrrhhmrghrvghksehinhhvihhsihgslh
 gvthhhihhnghhslhgrsgdrtghomhenucevlhhushhtvghrufhiiigvpedv
X-ME-Proxy: <xmx:WmyPXSW2ikSwb1TXZyn6bhKehX_HTQKYHk8dKachIWYWU0b8S-qpEw>
 <xmx:WmyPXbeg7lVu-QftO_d9qkcgSW00D1-yy0-L7lkb7XRkuXgLlRyqCA>
 <xmx:WmyPXWKNP-PipKCH8kwBuA1Z_YFGnOZ3a0UYCl83-3xkB-a94E0Blg>
 <xmx:WmyPXRPDN0OMYbuZ4tx-d5IGifCKEi8kRth1L_mZpjRORLDw6Nh_NA>
Received: from localhost.localdomain (ip5b412221.dynamic.kabel-deutschland.de
 [91.65.34.33])
 by mail.messagingengine.com (Postfix) with ESMTPA id 90488D6005E;
 Sat, 28 Sep 2019 10:21:13 -0400 (EDT)
From: =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 28 Sep 2019 16:20:36 +0200
Message-Id: <66a544b7e292dfe227349ffcc75a0136ca27afb1.1569680095.git-series.marmarek@invisiblethingslab.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.ab9be47e05c2dc2aa047d0a810c29ecd14bfe463.1569680095.git-series.marmarek@invisiblethingslab.com>
References: <cover.ab9be47e05c2dc2aa047d0a810c29ecd14bfe463.1569680095.git-series.marmarek@invisiblethingslab.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v8 3/4] libxl: attach PCI device to qemu only
 after setting pciback/pcifront
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

V2hlbiBxZW11IGlzIHJ1bm5pbmcgaW4gc3R1YmRvbWFpbiwgaGFuZGxpbmcgInBjaS1pbnMiIGNv
bW1hbmQgd2lsbCBmYWlsCmlmIHBjaWZyb250IGlzIG5vdCBpbml0aWFsaXplZCBhbHJlYWR5LiBG
aXggdGhpcyBieSBzZW5kaW5nIHN1Y2ggY29tbWFuZApvbmx5IGFmdGVyIGNvbmZpcm1pbmcgdGhh
dCBwY2liYWNrL2Zyb250IGlzIHJ1bm5pbmcuCgpTaWduZWQtb2ZmLWJ5OiBNYXJlayBNYXJjenlr
b3dza2ktR8OzcmVja2kgPG1hcm1hcmVrQGludmlzaWJsZXRoaW5nc2xhYi5jb20+Ci0tLQpDaGFu
Z2VzIGluIHYyOgotIEZpeGVkIGNvZGUgc3R5bGUgc2luY2UgcHJldmlvdXMgdmVyc2lvbi4KQ2hh
bmdlcyBpbiB2ODoKLSByZWJhc2Ugb24gc3RhZ2luZwotIHJld29yayBmb3IgYXN5bmMgYXBpCi0t
LQogdG9vbHMvbGlieGwvbGlieGxfcGNpLmMgfCA0NSArKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKy0KIDEgZmlsZSBjaGFuZ2VkLCA0NCBpbnNlcnRpb25zKCspLCAxIGRl
bGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGxfcGNpLmMgYi90b29scy9s
aWJ4bC9saWJ4bF9wY2kuYwppbmRleCBhYzU5N2E1Li5iYTAyODdkIDEwMDY0NAotLS0gYS90b29s
cy9saWJ4bC9saWJ4bF9wY2kuYworKysgYi90b29scy9saWJ4bC9saWJ4bF9wY2kuYwpAQCAtMTAx
Miw2ICsxMDEyLDkgQEAgdHlwZWRlZiBzdHJ1Y3QgcGNpX2FkZF9zdGF0ZSB7CiAgICAgYm9vbCBz
dGFydGluZzsKICAgICB2b2lkICgqY2FsbGJhY2spKGxpYnhsX19lZ2MgKiwgc3RydWN0IHBjaV9h
ZGRfc3RhdGUgKiwgaW50IHJjKTsKIAorICAgIC8qIHByaXZhdGUgdG8gZGV2aWNlX3BjaV9hZGRf
c3R1YmRvbV93YWl0ICovCisgICAgbGlieGxfX2V2X2RldnN0YXRlIHBjaWJhY2tfZHM7CisKICAg
ICAvKiBwcml2YXRlIHRvIGRvX3BjaV9hZGQgKi8KICAgICBsaWJ4bF9feHN3YWl0X3N0YXRlIHhz
d2FpdDsKICAgICBsaWJ4bF9fZXZfcW1wIHFtcDsKQEAgLTE0ODcsNiArMTQ5MCwxMCBAQCBzdGF0
aWMgaW50IGxpYnhsX3BjaWRldl9hc3NpZ25hYmxlKGxpYnhsX2N0eCAqY3R4LCBsaWJ4bF9kZXZp
Y2VfcGNpICpwY2lkZXYpCiAgICAgcmV0dXJuIGkgIT0gbnVtOwogfQogCitzdGF0aWMgdm9pZCBk
ZXZpY2VfcGNpX2FkZF9zdHViZG9tX3dhaXQobGlieGxfX2VnYyAqZWdjLAorICAgIHBjaV9hZGRf
c3RhdGUgKnBhcywgaW50IHJjKTsKK3N0YXRpYyB2b2lkIGRldmljZV9wY2lfYWRkX3N0dWJkb21f
cmVhZHkobGlieGxfX2VnYyAqZWdjLAorICAgIGxpYnhsX19ldl9kZXZzdGF0ZSogZHMsIGludCBy
Yyk7CiBzdGF0aWMgdm9pZCBkZXZpY2VfcGNpX2FkZF9zdHViZG9tX2RvbmUobGlieGxfX2VnYyAq
ZWdjLAogICAgIHBjaV9hZGRfc3RhdGUgKiwgaW50IHJjKTsKIHN0YXRpYyB2b2lkIGRldmljZV9w
Y2lfYWRkX2RvbmUobGlieGxfX2VnYyAqZWdjLApAQCAtMTU2Myw3ICsxNTcwLDggQEAgdm9pZCBs
aWJ4bF9fZGV2aWNlX3BjaV9hZGQobGlieGxfX2VnYyAqZWdjLCB1aW50MzJfdCBkb21pZCwKICAg
ICAgICAgR0NORVcocGNpZGV2X3MpOwogICAgICAgICBsaWJ4bF9kZXZpY2VfcGNpX2luaXQocGNp
ZGV2X3MpOwogICAgICAgICBsaWJ4bF9kZXZpY2VfcGNpX2NvcHkoQ1RYLCBwY2lkZXZfcywgcGNp
ZGV2KTsKLSAgICAgICAgcGFzLT5jYWxsYmFjayA9IGRldmljZV9wY2lfYWRkX3N0dWJkb21fZG9u
ZTsKKyAgICAgICAgcGFzLT5jYWxsYmFjayA9IGRldmljZV9wY2lfYWRkX3N0dWJkb21fd2FpdDsK
KwogICAgICAgICBkb19wY2lfYWRkKGVnYywgc3R1YmRvbWlkLCBwY2lkZXZfcywgcGFzKTsgLyog
bXVzdCBiZSBsYXN0ICovCiAgICAgICAgIHJldHVybjsKICAgICB9CkBAIC0xNTc1LDYgKzE1ODMs
NDEgQEAgb3V0OgogICAgIGRldmljZV9wY2lfYWRkX2RvbmUoZWdjLCBwYXMsIHJjKTsgLyogbXVz
dCBiZSBsYXN0ICovCiB9CiAKK3N0YXRpYyB2b2lkIGRldmljZV9wY2lfYWRkX3N0dWJkb21fd2Fp
dChsaWJ4bF9fZWdjICplZ2MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGNpX2FkZF9zdGF0ZSAqcGFzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGludCByYykKK3sKKyAgICBsaWJ4bF9fYW9fZGV2aWNlICphb2RldiA9IHBhcy0+YW9k
ZXY7CisgICAgU1RBVEVfQU9fR0MoYW9kZXYtPmFvKTsKKyAgICBsaWJ4bF9jdHggKmN0eCA9IGxp
YnhsX19nY19vd25lcihnYyk7CisgICAgaW50IHN0dWJkb21pZCA9IGxpYnhsX2dldF9zdHViZG9t
X2lkKGN0eCwgcGFzLT5kb21pZCk7CisgICAgY2hhciAqc3RhdGVfcGF0aDsKKworICAgIGlmIChy
YykgZ290byBvdXQ7CisKKyAgICAvKiBXYWl0IGZvciB0aGUgZGV2aWNlIGFjdHVhbGx5IGJlaW5n
IGNvbm5lY3RlZCwgb3RoZXJ3aXNlIGRldmljZSBtb2RlbAorICAgICAqIHJ1bm5pbmcgdGhlcmUg
d2lsbCBmYWlsIHRvIGZpbmQgdGhlIGRldmljZS4gKi8KKyAgICBzdGF0ZV9wYXRoID0gbGlieGxf
X3NwcmludGYoZ2MsICIlcy9iYWNrZW5kL3BjaS8lZC8wL3N0YXRlIiwKKyAgICAgICAgICAgIGxp
YnhsX194c19nZXRfZG9tcGF0aChnYywgMCksIHN0dWJkb21pZCk7CisgICAgcmMgPSBsaWJ4bF9f
ZXZfZGV2c3RhdGVfd2FpdChhb2Rldi0+YW8sICZwYXMtPnBjaWJhY2tfZHMsCisgICAgICAgICAg
ICBkZXZpY2VfcGNpX2FkZF9zdHViZG9tX3JlYWR5LAorICAgICAgICAgICAgc3RhdGVfcGF0aCwg
WGVuYnVzU3RhdGVDb25uZWN0ZWQsCisgICAgICAgICAgICBMSUJYTF9ERVZJQ0VfTU9ERUxfU1RB
UlRfVElNRU9VVCAqIDEwMDApOworICAgIGlmIChyYykgZ290byBvdXQ7CisgICAgcmV0dXJuOwor
b3V0OgorICAgIGRldmljZV9wY2lfYWRkX2RvbmUoZWdjLCBwYXMsIHJjKTsgLyogbXVzdCBiZSBs
YXN0ICovCit9CisKK3N0YXRpYyB2b2lkIGRldmljZV9wY2lfYWRkX3N0dWJkb21fcmVhZHkobGli
eGxfX2VnYyAqZWdjLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs
aWJ4bF9fZXZfZGV2c3RhdGUqIGRzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbnQgcmMpCit7CisgICAgcGNpX2FkZF9zdGF0ZSAqcGFzID0gQ09OVEFJTkVSX09G
KGRzLCAqcGFzLCBwY2liYWNrX2RzKTsKKworICAgIGRldmljZV9wY2lfYWRkX3N0dWJkb21fZG9u
ZShlZ2MsIHBhcywgcmMpOyAvKiBtdXN0IGJlIGxhc3QgKi8KK30KKwogc3RhdGljIHZvaWQgZGV2
aWNlX3BjaV9hZGRfc3R1YmRvbV9kb25lKGxpYnhsX19lZ2MgKmVnYywKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwY2lfYWRkX3N0YXRlICpwYXMsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHJjKQotLSAKZ2l0LXNlcmllcyAwLjku
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRl
dmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9s
aXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

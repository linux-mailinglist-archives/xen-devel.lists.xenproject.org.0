Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 2CE169B670
	for <lists+xen-devel@lfdr.de>; Fri, 23 Aug 2019 20:52:01 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i1EcQ-0001kH-Sy; Fri, 23 Aug 2019 18:49:02 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=gZL1=WT=epam.com=volodymyr_babchuk@srs-us1.protection.inumbo.net>)
 id 1i1EcP-0001jN-9O
 for xen-devel@lists.xenproject.org; Fri, 23 Aug 2019 18:49:01 +0000
X-Inumbo-ID: a56b2062-c5d6-11e9-adef-12813bfff9fa
Received: from EUR01-VE1-obe.outbound.protection.outlook.com (unknown
 [40.107.14.44]) by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id a56b2062-c5d6-11e9-adef-12813bfff9fa;
 Fri, 23 Aug 2019 18:48:51 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=lRy3785bRM2bWA5cVdX0qbEDU5mnYJ2YFMFt3wXpHiIqyw11qpBnZHj8JIqfqVEL3eP/7BAyQTzs3quzTtvVsbac3lIwKhagdvxv4aNFuDjyGz5NzBHxNHjH60H/q+x71Pq2xt02onkIMcBWN+Z1BwCYinUW+sZGzHvzhtxh7Xb0LSUwVVLjCSObS/UZ1FDc0HtCOFUeSmeNeZiE8CeUnEX8jkcUZiWWISUkTW+OC0KztEG6WIaxD9Be7jNpncUhJ/XTxPjNgk87VTbQKwVo1VwmCh54MAq0mYZdDrABDSqWAu5Jjh+NRDdtJzez75YXHhbHP38RVeVPTHOHRKAnuw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=J3vzKqChQlQMrBBa5Lj78mD3Xi0BfXeQy6cOitat1zA=;
 b=B0edAL9Q7dY2yUGSaWpUz6TvDdoWCB6Ir9A5OOOYNuFf0bzfy3N+1bJ40HZRFZK3X7ElFJrvmk1vIp8ilu4hUzwkGXkt0Kmi39vzJ62U8X+SAsqXxVw/vYM7t2HW/6oJlJtt7helAvCrsFxy2uUN/Pey2Or2zDt+EOOJnJNit8de6uPJBcWrRRe6ZFgybEjBYVSMYN84MdCEE7JrXQ+AQHJNdyVmc+wfZRv+aHAqwYlMCssAwxzkmEKA6YxvCRdCece1sjeVXX8oxmHJMX1K1gW9vo8Q4OyFMLFkyKmDRhveeaIWOrsGGBeW/L4cMCxqhaoZPQZioT2C/S4SsFBGTQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=epam.com; dmarc=pass action=none header.from=epam.com;
 dkim=pass header.d=epam.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=epam.com; s=selector1; 
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=J3vzKqChQlQMrBBa5Lj78mD3Xi0BfXeQy6cOitat1zA=;
 b=ZHTk2KO7pxQ87rKXm6qrKXDpFuCNUCmlOqr7PM8QVq2cHMuM+mY0ZDOfdsh8YFo3rTJ1HDKf/iSbBstijGaU5Y/GDnch2I2wZlvCI7fS6Sf6Hw4Di49qIhid8WljW2hkzVzKBg1F4n3XKJlzXLXeclp/DXNoVOL4oiED6PvmgGhbKYye8NGXpwMD1dnQsMstDAi/BeVUmukqlYoqIbfpfxMvoDK8MMUjDyJqINymjEa9AU9kBMZbjwuOiwY+J5lkpwp/kAhJOCwgpQbSe87IKPeNPplY+xYn2GfAn8TKEZ1fU8aO7/AqU0wO7e6nenzywgIZ6Wx4FzBzFFKe/Nzx+Q==
Received: from AM0PR03MB4148.eurprd03.prod.outlook.com (20.177.40.10) by
 AM0PR03MB4690.eurprd03.prod.outlook.com (20.177.41.22) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2178.18; Fri, 23 Aug 2019 18:48:50 +0000
Received: from AM0PR03MB4148.eurprd03.prod.outlook.com
 ([fe80::71e3:834d:5708:5a0a]) by AM0PR03MB4148.eurprd03.prod.outlook.com
 ([fe80::71e3:834d:5708:5a0a%5]) with mapi id 15.20.2199.015; Fri, 23 Aug 2019
 18:48:50 +0000
From: Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH 4/5] xen/arm: optee: handle share buffer translation error
Thread-Index: AQHVWeNnnvmrLONixEqfoDDhmmN88g==
Date: Fri, 23 Aug 2019 18:48:50 +0000
Message-ID: <20190823184826.14525-5-volodymyr_babchuk@epam.com>
References: <20190823184826.14525-1-volodymyr_babchuk@epam.com>
In-Reply-To: <20190823184826.14525-1-volodymyr_babchuk@epam.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=Volodymyr_Babchuk@epam.com; 
x-originating-ip: [85.223.209.22]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: a8a5d122-502e-4422-d6ea-08d727fa8a09
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(7168020)(4627221)(201703031133081)(201702281549075)(8990200)(5600166)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:AM0PR03MB4690; 
x-ms-traffictypediagnostic: AM0PR03MB4690:|AM0PR03MB4690:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <AM0PR03MB4690CBA8A3DB1DDA5ECE4E6BE6A40@AM0PR03MB4690.eurprd03.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:7691;
x-forefront-prvs: 0138CD935C
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10009020)(4636009)(346002)(136003)(376002)(39860400002)(366004)(396003)(51234002)(189003)(199004)(6436002)(305945005)(25786009)(76176011)(81166006)(71190400001)(478600001)(7736002)(81156014)(5660300002)(8676002)(71200400001)(4326008)(186003)(6506007)(99286004)(2351001)(6486002)(1076003)(2501003)(26005)(2906002)(6916009)(66446008)(55236004)(66946007)(91956017)(14454004)(76116006)(66476007)(66556008)(36756003)(64756008)(6116002)(6512007)(446003)(11346002)(3846002)(476003)(2616005)(316002)(54906003)(86362001)(80792005)(102836004)(5640700003)(8936002)(66066001)(14444005)(486006)(256004)(53936002);
 DIR:OUT; SFP:1101; SCL:1; SRVR:AM0PR03MB4690;
 H:AM0PR03MB4148.eurprd03.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: epam.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: v8vTlLgDbU//E7+sVlRuwITeOezCVya1fhZVM3P6jT7YDTVeVzOk6cWKuE12ebrrvWEP+4SExke6+LusTPnhCMZxARVmI9aI9ojsCtJXwIR0SUG74UoaaIaZXS21UOtqpkEwZg7AYPGyc/mBwH+uEwlpJfhSJcTAicb5vXP8q6ORmzYD1dj4koq23i50iOhb6S0n9lC40lxaVSFO+6/fkV0Szqa6k9XSWiuAYOahGjko4vpJ/v3YPlYIxYkwYwSA/3MDTywgkZ8ZnrWldcwwqctBwz0km1oNhY/GqYTNQDkwhw/PlOnO4f9xnyTZu4IS2KD+vbwhaei5nCy4cBVZF4F7IrQVnu4l/7LodBJ1c5mlD7c4vkLot6W5TTghNXqFJ90U0GKNx6ewXjwQyRtp3xPqdkSQ+Fs7h2kRHbjD2Zg=
MIME-Version: 1.0
X-OriginatorOrg: epam.com
X-MS-Exchange-CrossTenant-Network-Message-Id: a8a5d122-502e-4422-d6ea-08d727fa8a09
X-MS-Exchange-CrossTenant-originalarrivaltime: 23 Aug 2019 18:48:50.5793 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b41b72d0-4e9f-4c26-8a69-f949f367c91d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 6umkZ6YVKoBMGgF+5PHm80yTq2IfSXLqWefHgnHnem3+w4NMvn6tzZbIGBZZuzxhB+bRu4jou87B4O0Qtaqmo54nev4zP/S3g3r3dTM9zT4=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM0PR03MB4690
Subject: [Xen-devel] [PATCH 4/5] xen/arm: optee: handle share buffer
 translation error
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "tee-dev@lists.linaro.org" <tee-dev@lists.linaro.org>,
 Julien Grall <julien.grall@arm.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlcmUgaXMgYSBjYXNlIHBvc3NpYmxlLCB3aGVuIE9QLVRFRSBhc2tzIGd1ZXN0IHRvIGFsbG9j
YXRlIHNoYXJlZApidWZmZXIsIGJ1dCBYZW4gZm9yIHNvbWUgcmVhc29uIGNhbid0IHRyYW5zbGF0
ZSBidWZmZXIncyBhZGRyZXNzZXMuIEluCnRoaXMgc2l0dWF0aW9uIHdlIHNob3VsZCBkbyB0d28g
dGhpbmdzOgoKMS4gVGVsbCBndWVzdCB0byBmcmVlIGFsbG9jYXRlZCBidWZmZXIsIHNvIHRoZXJl
IHdpbGwgYmUgbm8gbWVtb3J5CmxlYWsgZm9yIGd1ZXN0LgoKMi4gVGVsbCBPUC1URUUgdGhhdCBi
dWZmZXIgYWxsb2NhdGlvbiBmYWlsZWQuCgpUbyBhc2sgZ3Vlc3QgdG8gZnJlZSBhbGxvY2F0ZWQg
YnVmZmVyIHdlIHNob3VsZCBwZXJmb3JtIHRoZSBzYW1lCnRoaW5nLCBhcyBPUC1URUUgZG9lcyAt
IGlzc3VlIFJQQyByZXF1ZXN0LiBUaGlzIGlzIGRvbmUgYnkgZmlsbGluZwpyZXF1ZXN0IGJ1ZmZl
ciAobHVja2lseSB3ZSBjYW4gcmV1c2UgdGhlIHNhbWUgYnVmZmVyLCB0aGF0IE9QLVRFRSB1c2Vk
CnRvIGlzc3VlIG9yaWdpbmFsIHJlcXVlc3QpIGFuZCB0aGVuIHJldHVybiB0byBndWVzdCB3aXRo
IHNwZWNpYWwKcmV0dXJuIGNvZGUuCgpUaGVuIHdlIG5lZWQgdG8gaGFuZGxlIG5leHQgY2FsbCBm
cm9tIGd1ZXN0IGluIGEgc3BlY2lhbCB3YXk6IGFzIFJQQwp3YXMgaXNzdWVkIGJ5IFhlbiwgbm90
IGJ5IE9QLVRFRSwgaXQgc2hvdWxkIGJlIGhhbmRsZWQgYnkgWGVuLgpCYXNpY2FsbHksIHRoaXMg
aXMgdGhlIG1lY2hhbmlzbSB0byBwcmVlbXB0IE9QLVRFRSBtZWRpYXRvci4KClRoZSBzYW1lIG1l
Y2hhbmlzbSBjYW4gYmUgdXNlZCBpbiB0aGUgZnV0dXJlIHRvIHByZWVtcHQgbWVkaWF0b3IKZHVy
aW5nIHRyYW5zbGF0aW9uIGxhcmdlICg+NTEyIHBhZ2VzKSBzaGFyZWQgYnVmZmVycy4KClNpZ25l
ZC1vZmYtYnk6IFZvbG9keW15ciBCYWJjaHVrIDx2b2xvZHlteXJfYmFiY2h1a0BlcGFtLmNvbT4K
LS0tCiB4ZW4vYXJjaC9hcm0vdGVlL29wdGVlLmMgfCAxNjcgKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKy0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMTM2IGluc2VydGlvbnMoKyksIDMx
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS90ZWUvb3B0ZWUuYyBiL3hl
bi9hcmNoL2FybS90ZWUvb3B0ZWUuYwppbmRleCAzY2U2ZTdmYTU1Li40ZWViYzYwYjYyIDEwMDY0
NAotLS0gYS94ZW4vYXJjaC9hcm0vdGVlL29wdGVlLmMKKysrIGIveGVuL2FyY2gvYXJtL3RlZS9v
cHRlZS5jCkBAIC05Niw2ICs5NiwxMSBAQAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
T1BURUVfU01DX1NFQ19DQVBfVU5SRUdJU1RFUkVEX1NITSB8IFwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE9QVEVFX1NNQ19TRUNfQ0FQX0RZTkFNSUNfU0hNKQogCitlbnVtIG9wdGVl
X2NhbGxfc3RhdGUgeworICAgIE9QVEVFTV9DQUxMX05PUk1BTCA9IDAsCisgICAgT1BURUVNX0NB
TExfWEVOX1JQQywKK307CisKIHN0YXRpYyB1bnNpZ25lZCBpbnQgX19yZWFkX21vc3RseSBtYXhf
b3B0ZWVfdGhyZWFkczsKIAogLyoKQEAgLTExMiw2ICsxMTcsOSBAQCBzdHJ1Y3Qgb3B0ZWVfc3Rk
X2NhbGwgewogICAgIHBhZGRyX3QgZ3Vlc3RfYXJnX2lwYTsKICAgICBpbnQgb3B0ZWVfdGhyZWFk
X2lkOwogICAgIGludCBycGNfb3A7CisgICAgLyogU2F2ZWQgYnVmZmVyIHR5cGUgZm9yIHRoZSBs
YXN0IGJ1ZmZlciBhbGxvY2F0ZSByZXF1ZXN0ICovCisgICAgdW5zaWduZWQgaW50IHJwY19idWZm
ZXJfdHlwZTsKKyAgICBlbnVtIG9wdGVlX2NhbGxfc3RhdGUgc3RhdGU7CiAgICAgdWludDY0X3Qg
cnBjX2RhdGFfY29va2llOwogICAgIGJvb2wgaW5fZmxpZ2h0OwogICAgIHJlZ2lzdGVyX3QgcnBj
X3BhcmFtc1syXTsKQEAgLTI5OSw2ICszMDcsNyBAQCBzdGF0aWMgc3RydWN0IG9wdGVlX3N0ZF9j
YWxsICphbGxvY2F0ZV9zdGRfY2FsbChzdHJ1Y3Qgb3B0ZWVfZG9tYWluICpjdHgpCiAKICAgICBj
YWxsLT5vcHRlZV90aHJlYWRfaWQgPSAtMTsKICAgICBjYWxsLT5pbl9mbGlnaHQgPSB0cnVlOwor
ICAgIGNhbGwtPnN0YXRlID0gT1BURUVNX0NBTExfTk9STUFMOwogCiAgICAgc3Bpbl9sb2NrKCZj
dHgtPmxvY2spOwogICAgIGxpc3RfYWRkX3RhaWwoJmNhbGwtPmxpc3QsICZjdHgtPmNhbGxfbGlz
dCk7CkBAIC0xMDc1LDYgKzEwODQsMTAgQEAgc3RhdGljIGludCBoYW5kbGVfcnBjX3JldHVybihz
dHJ1Y3Qgb3B0ZWVfZG9tYWluICpjdHgsCiAgICAgICAgICAgICByZXQgPSAtRVJFU1RBUlQ7CiAg
ICAgICAgIH0KIAorICAgICAgICAvKiBTYXZlIHRoZSBidWZmZXIgdHlwZSBpbiBjYXNlIHdlIHdp
bGwgd2FudCB0byBmcmVlIGl0ICovCisgICAgICAgIGlmICggc2htX3JwYy0+eGVuX2FyZy0+Y21k
ID09IE9QVEVFX1JQQ19DTURfU0hNX0FMTE9DICkKKyAgICAgICAgICAgIGNhbGwtPnJwY19idWZm
ZXJfdHlwZSA9IHNobV9ycGMtPnhlbl9hcmctPnBhcmFtc1swXS51LnZhbHVlLmE7CisKICAgICAg
ICAgdW5tYXBfZG9tYWluX3BhZ2Uoc2htX3JwYy0+eGVuX2FyZyk7CiAgICAgfQogCkBAIC0xMjM5
LDE4ICsxMjUyLDEwMiBAQCBlcnI6CiAgICAgcmV0dXJuOwogfQogCisvKgorICogUHJlcGFyZSBS
UEMgcmVxdWVzdCB0byBmcmVlIHNoYXJlZCBidWZmZXIgaW4gdGhlIHNhbWUgd2F5LCBhcworICog
T1AtVEVFIGRvZXMgdGhpcy4KKyAqCisgKiBSZXR1cm4gdmFsdWVzOgorICogIHRydWUgIC0gc3Vj
Y2Vzc2Z1bGx5IHByZXBhcmVkIFJQQyByZXF1ZXN0CisgKiAgZmFsc2UgLSB0aGVyZSB3YXMgYW4g
ZXJyb3IKKyAqLworc3RhdGljIGJvb2wgaXNzdWVfcnBjX2NtZF9mcmVlKHN0cnVjdCBvcHRlZV9k
b21haW4gKmN0eCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY3B1X3Vz
ZXJfcmVncyAqcmVncywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0
ZWVfc3RkX2NhbGwgKmNhbGwsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHNobV9ycGMgKnNobV9ycGMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0
X3QgY29va2llKQoreworICAgIHJlZ2lzdGVyX3QgcjEsIHIyOworCisgICAgLyogSW4gY2FzZSBp
ZiBndWVzdCB3aWxsIGZvcmdldCB0byB1cGRhdGUgaXQgd2l0aCBtZWFuaW5nZnVsIHZhbHVlICov
CisgICAgc2htX3JwYy0+eGVuX2FyZy0+cmV0ID0gVEVFQ19FUlJPUl9HRU5FUklDOworICAgIHNo
bV9ycGMtPnhlbl9hcmctPmNtZCA9IE9QVEVFX1JQQ19DTURfU0hNX0ZSRUU7CisgICAgc2htX3Jw
Yy0+eGVuX2FyZy0+bnVtX3BhcmFtcyA9IDE7CisgICAgc2htX3JwYy0+eGVuX2FyZy0+cGFyYW1z
WzBdLmF0dHIgPSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX0lOUFVUOworICAgIHNobV9ycGMt
Pnhlbl9hcmctPnBhcmFtc1swXS51LnZhbHVlLmEgPSBjYWxsLT5ycGNfYnVmZmVyX3R5cGU7Cisg
ICAgc2htX3JwYy0+eGVuX2FyZy0+cGFyYW1zWzBdLnUudmFsdWUuYiA9IGNvb2tpZTsKKworICAg
IGlmICggYWNjZXNzX2d1ZXN0X21lbW9yeV9ieV9pcGEoY3VycmVudC0+ZG9tYWluLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZuX3RvX2dhZGRyKHNobV9ycGMtPmdmbiks
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG1fcnBjLT54ZW5fYXJnLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT1BURUVfTVNHX0dFVF9BUkdfU0la
RSgxKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUpICkKKyAgICB7
CisgICAgICAgIC8qCisgICAgICAgICAqIFdlbGwsIHRoaXMgaXMgcXVpdGUgYmFkLiBXZSBoYXZl
IGVycm9yIGluIGVycm9yIHBhdGguCisgICAgICAgICAqIFRoaXMgY2FuIGhhcHBlbiBvbmx5IGlm
IGd1ZXN0IGJlaGF2ZXMgYmFkbHksIHNvIGFsbAorICAgICAgICAgKiB3ZSBjYW4gZG8gaXMgdG8g
cmV0dXJuIGVycm9yIHRvIE9QLVRFRSBhbmQgbGVhdmUKKyAgICAgICAgICogZ3Vlc3QncyBtZW1v
cnkgbGVha2VkLgorICAgICAgICAgKi8KKyAgICAgICAgc2htX3JwYy0+eGVuX2FyZy0+cmV0ID0g
VEVFQ19FUlJPUl9HRU5FUklDOworICAgICAgICBzaG1fcnBjLT54ZW5fYXJnLT5udW1fcGFyYW1z
ID0gMDsKKworICAgICAgICByZXR1cm4gZmFsc2U7CisgICAgfQorCisgICAgdWludDY0X3RvX3Jl
Z3BhaXIoJnIxLCAmcjIsIHNobV9ycGMtPmNvb2tpZSk7CisKKyAgICBjYWxsLT5zdGF0ZSA9IE9Q
VEVFTV9DQUxMX1hFTl9SUEM7CisgICAgY2FsbC0+cnBjX29wID0gT1BURUVfU01DX1JQQ19GVU5D
X0NNRDsKKyAgICBjYWxsLT5ycGNfcGFyYW1zWzBdID0gcjE7CisgICAgY2FsbC0+cnBjX3BhcmFt
c1sxXSA9IHIyOworICAgIGNhbGwtPm9wdGVlX3RocmVhZF9pZCA9IGdldF91c2VyX3JlZyhyZWdz
LCAzKTsKKworICAgIHNldF91c2VyX3JlZyhyZWdzLCAwLCBPUFRFRV9TTUNfUkVUVVJOX1JQQ19D
TUQpOworICAgIHNldF91c2VyX3JlZyhyZWdzLCAxLCByMSk7CisgICAgc2V0X3VzZXJfcmVnKHJl
Z3MsIDIsIHIyKTsKKworICAgIHJldHVybiB0cnVlOworfQorCisvKiBIYW5kbGVzIHJldHVybiBm
cm9tIFhlbi1pc3N1ZWQgUlBDICovCitzdGF0aWMgdm9pZCBoYW5kbGVfeGVuX3JwY19yZXR1cm4o
c3RydWN0IG9wdGVlX2RvbWFpbiAqY3R4LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBvcHRlZV9zdGRfY2FsbCAqY2FsbCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2htX3JwYyAqc2htX3JwYykKK3sKKyAgICBjYWxsLT5z
dGF0ZSA9IE9QVEVFTV9DQUxMX05PUk1BTDsKKworICAgIC8qCisgICAgICogUmlnaHQgbm93IHdl
IGhhdmUgb25seSBvbmUgcmVhc29uIHRvIGJlIHRoZXJlIC0gd2UgYXNrZWQgZ3Vlc3QKKyAgICAg
KiB0byBmcmVlIHNoYXJlZCBidWZmZXIgYW5kIGl0IGRpZCBpdC4gTm93IHdlIGNhbiB0ZWxsIE9Q
LVRFRSB0aGF0CisgICAgICogYnVmZmVyIGFsbG9jYXRpb24gZmFpbGVkLgorICAgICAqLworCisg
ICAgLyoKKyAgICAgKiBXZSBhcmUgbm90IGNoZWNraW5nIHJldHVybiB2YWx1ZSBmcm9tIGEgZ3Vl
c3QgYmVjYXVzZSB3ZSBhc3N1bWUKKyAgICAgKiB0aGF0IE9QVEVFX1JQQ19DTURfU0hNX0ZSRUUg
bmV3ZXIgZmFpbHMuCisgICAgICovCisKKyAgICBzaG1fcnBjLT54ZW5fYXJnLT5yZXQgPSBURUVD
X0VSUk9SX0dFTkVSSUM7CisgICAgc2htX3JwYy0+eGVuX2FyZy0+bnVtX3BhcmFtcyA9IDA7Cit9
CisKIC8qCiAgKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIGd1ZXN0IGlzIGZpbmlzaGVk
IHByb2Nlc3NpbmcgUlBDCiAgKiByZXF1ZXN0IGZyb20gT1AtVEVFIGFuZCB3aXNoZWQgdG8gcmVz
dW1lIHRoZSBpbnRlcnJ1cHRlZCBzdGFuZGFyZAogICogY2FsbC4KKyAqCisgKiBSZXR1cm4gdmFs
dWVzOgorICogIGZhbHNlIC0gdGhlcmUgd2FzIGFuIGVycm9yLCBkbyBub3QgY2FsbCBPUC1URUUK
KyAqICB0cnVlICAtIHN1Y2Nlc3MsIHByb2NlZWQgYXMgbm9ybWFsCiAgKi8KLXN0YXRpYyB2b2lk
IGhhbmRsZV9ycGNfY21kX2FsbG9jKHN0cnVjdCBvcHRlZV9kb21haW4gKmN0eCwKK3N0YXRpYyBi
b29sIGhhbmRsZV9ycGNfY21kX2FsbG9jKHN0cnVjdCBvcHRlZV9kb21haW4gKmN0eCwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG9wdGVlX3N0ZF9jYWxsICpj
YWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNobV9ycGMgKnNo
bV9ycGMpCiB7CiAgICAgaWYgKCBzaG1fcnBjLT54ZW5fYXJnLT5yZXQgfHwgc2htX3JwYy0+eGVu
X2FyZy0+bnVtX3BhcmFtcyAhPSAxICkKLSAgICAgICAgcmV0dXJuOworICAgICAgICByZXR1cm4g
dHJ1ZTsKIAogICAgIGlmICggc2htX3JwYy0+eGVuX2FyZy0+cGFyYW1zWzBdLmF0dHIgIT0gKE9Q
VEVFX01TR19BVFRSX1RZUEVfVE1FTV9PVVRQVVQgfAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE9QVEVFX01TR19BVFRSX05PTkNPTlRJRykgKQpAQCAtMTI1
OCw3ICsxMzU1LDcgQEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19jbWRfYWxsb2Moc3RydWN0IG9w
dGVlX2RvbWFpbiAqY3R4LAogICAgICAgICBnZHByaW50ayhYRU5MT0dfV0FSTklORywKICAgICAg
ICAgICAgICAgICAgIkludmFsaWQgYXR0cnMgZm9yIHNoYXJlZCBtZW0gYnVmZmVyOiAlIlBSSXg2
NCJcbiIsCiAgICAgICAgICAgICAgICAgIHNobV9ycGMtPnhlbl9hcmctPnBhcmFtc1swXS5hdHRy
KTsKLSAgICAgICAgcmV0dXJuOworICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CiAKICAgICAv
KiBGcmVlIHBnIGxpc3QgZm9yIGJ1ZmZlciAqLwpAQCAtMTI3NCwyMSArMTM3MSwxNCBAQCBzdGF0
aWMgdm9pZCBoYW5kbGVfcnBjX2NtZF9hbGxvYyhzdHJ1Y3Qgb3B0ZWVfZG9tYWluICpjdHgsCiAg
ICAgewogICAgICAgICBjYWxsLT5ycGNfZGF0YV9jb29raWUgPSAwOwogICAgICAgICAvKgotICAg
ICAgICAgKiBPa2F5LCBzbyB0aGVyZSB3YXMgcHJvYmxlbSB3aXRoIGd1ZXN0J3MgYnVmZmVyIGFu
ZCB3ZSBuZWVkCi0gICAgICAgICAqIHRvIHRlbGwgYWJvdXQgdGhpcyB0byBPUC1URUUuCi0gICAg
ICAgICAqLwotICAgICAgICBzaG1fcnBjLT54ZW5fYXJnLT5yZXQgPSBURUVDX0VSUk9SX0dFTkVS
SUM7Ci0gICAgICAgIHNobV9ycGMtPnhlbl9hcmctPm51bV9wYXJhbXMgPSAwOwotICAgICAgICAv
KgotICAgICAgICAgKiBUT0RPOiBXaXRoIGN1cnJlbnQgaW1wbGVtZW50YXRpb24sIE9QLVRFRSB3
aWxsIG5vdCBpc3N1ZQotICAgICAgICAgKiBSUEMgdG8gZnJlZSB0aGlzIGJ1ZmZlci4gR3Vlc3Qg
YW5kIE9QLVRFRSB3aWxsIGJlIG91dCBvZgotICAgICAgICAgKiBzeW5jOiBndWVzdCBiZWxpZXZl
cyB0aGF0IGl0IHByb3ZpZGVkIGJ1ZmZlciB0byBPUC1URUUsCi0gICAgICAgICAqIHdoaWxlIE9Q
LVRFRSB0aGlua3Mgb2Ygb3Bwb3NpdGUuIElkZWFsbHksIHdlIG5lZWQgdG8KLSAgICAgICAgICog
ZW11bGF0ZSBSUEMgd2l0aCBPUFRFRV9NU0dfUlBDX0NNRF9TSE1fRlJFRSBjb21tYW5kLgorICAg
ICAgICAgKiBXZSBhcmUgdW5hYmxlIHRvIHRyYW5zbGF0ZSBndWVzdCdzIGJ1ZmZlciwgc28gd2Ug
bmVlZCB0ZWxsIGd1ZXN0CisgICAgICAgICAqIHRvIGZyZWUgaXQsIGJlZm9yZSByZXR1cm5pbmcg
ZXJyb3IgdG8gT1AtVEVFLgogICAgICAgICAgKi8KLSAgICAgICAgZ3ByaW50ayhYRU5MT0dfV0FS
TklORywKLSAgICAgICAgICAgICAgICAidHJhbnNsYXRlX25vbmNvbnRpZygpIGZhaWxlZCwgT1At
VEVFL2d1ZXN0IHN0YXRlIGlzIG91dCBvZiBzeW5jLlxuIik7CisgICAgICAgIHJldHVybiAhaXNz
dWVfcnBjX2NtZF9mcmVlKGN0eCwgcmVncywgY2FsbCwgc2htX3JwYywKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2htX3JwYy0+eGVuX2FyZy0+cGFyYW1zWzBdLnUudG1lbS5z
aG1fcmVmKTsKICAgICB9CisKKyAgICByZXR1cm4gdHJ1ZTsKIH0KIAogc3RhdGljIHZvaWQgaGFu
ZGxlX3JwY19jbWQoc3RydWN0IG9wdGVlX2RvbWFpbiAqY3R4LCBzdHJ1Y3QgY3B1X3VzZXJfcmVn
cyAqcmVncywKQEAgLTEzMzgsMjIgKzE0MjgsMzcgQEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19j
bWQoc3RydWN0IG9wdGVlX2RvbWFpbiAqY3R4LCBzdHJ1Y3QgY3B1X3VzZXJfcmVncyAqcmVncywK
ICAgICAgICAgZ290byBvdXQ7CiAgICAgfQogCi0gICAgc3dpdGNoIChzaG1fcnBjLT54ZW5fYXJn
LT5jbWQpCisgICAgaWYgKCBjYWxsLT5zdGF0ZSA9PSBPUFRFRU1fQ0FMTF9OT1JNQUwgKQogICAg
IHsKLSAgICBjYXNlIE9QVEVFX1JQQ19DTURfR0VUX1RJTUU6Ci0gICAgY2FzZSBPUFRFRV9SUENf
Q01EX1dBSVRfUVVFVUU6Ci0gICAgY2FzZSBPUFRFRV9SUENfQ01EX1NVU1BFTkQ6Ci0gICAgICAg
IGJyZWFrOwotICAgIGNhc2UgT1BURUVfUlBDX0NNRF9TSE1fQUxMT0M6Ci0gICAgICAgIGhhbmRs
ZV9ycGNfY21kX2FsbG9jKGN0eCwgcmVncywgY2FsbCwgc2htX3JwYyk7Ci0gICAgICAgIGJyZWFr
OwotICAgIGNhc2UgT1BURUVfUlBDX0NNRF9TSE1fRlJFRToKLSAgICAgICAgZnJlZV9vcHRlZV9z
aG1fYnVmKGN0eCwgc2htX3JwYy0+eGVuX2FyZy0+cGFyYW1zWzBdLnUudmFsdWUuYik7Ci0gICAg
ICAgIGlmICggY2FsbC0+cnBjX2RhdGFfY29va2llID09IHNobV9ycGMtPnhlbl9hcmctPnBhcmFt
c1swXS51LnZhbHVlLmIgKQotICAgICAgICAgICAgY2FsbC0+cnBjX2RhdGFfY29va2llID0gMDsK
LSAgICAgICAgYnJlYWs7Ci0gICAgZGVmYXVsdDoKLSAgICAgICAgYnJlYWs7CisgICAgICAgIHN3
aXRjaCAoc2htX3JwYy0+eGVuX2FyZy0+Y21kKQorICAgICAgICB7CisgICAgICAgIGNhc2UgT1BU
RUVfUlBDX0NNRF9HRVRfVElNRToKKyAgICAgICAgY2FzZSBPUFRFRV9SUENfQ01EX1dBSVRfUVVF
VUU6CisgICAgICAgIGNhc2UgT1BURUVfUlBDX0NNRF9TVVNQRU5EOgorICAgICAgICAgICAgYnJl
YWs7CisgICAgICAgIGNhc2UgT1BURUVfUlBDX0NNRF9TSE1fQUxMT0M6CisgICAgICAgICAgICBp
ZiAoICFoYW5kbGVfcnBjX2NtZF9hbGxvYyhjdHgsIHJlZ3MsIGNhbGwsIHNobV9ycGMpICkKKyAg
ICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICAvKiBXZSBmYWlsZWQgdG8gdHJhbnNsYXRlIGJ1
ZmZlciwgcmVwb3J0IGJhY2sgdG8gZ3Vlc3QgKi8KKyAgICAgICAgICAgICAgICB1bm1hcF9kb21h
aW5fcGFnZShzaG1fcnBjLT54ZW5fYXJnKTsKKyAgICAgICAgICAgICAgICBwdXRfc3RkX2NhbGwo
Y3R4LCBjYWxsKTsKKworICAgICAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgICAgIH0KKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIE9QVEVFX1JQQ19DTURfU0hNX0ZSRUU6Cisg
ICAgICAgICAgICBmcmVlX29wdGVlX3NobV9idWYoY3R4LCBzaG1fcnBjLT54ZW5fYXJnLT5wYXJh
bXNbMF0udS52YWx1ZS5iKTsKKyAgICAgICAgICAgIGlmICggY2FsbC0+cnBjX2RhdGFfY29va2ll
ID09CisgICAgICAgICAgICAgICAgIHNobV9ycGMtPnhlbl9hcmctPnBhcmFtc1swXS51LnZhbHVl
LmIgKQorICAgICAgICAgICAgICAgIGNhbGwtPnJwY19kYXRhX2Nvb2tpZSA9IDA7CisgICAgICAg
ICAgICBicmVhazsKKyAgICAgICAgZGVmYXVsdDoKKyAgICAgICAgICAgIGJyZWFrOworICAgICAg
ICB9CisgICAgfQorICAgIGVsc2UKKyAgICB7CisgICAgICAgIGhhbmRsZV94ZW5fcnBjX3JldHVy
bihjdHgsIHJlZ3MsIGNhbGwsIHNobV9ycGMpOwogICAgIH0KIAogb3V0OgotLSAKMi4yMi4wCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwg
bWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3Rz
LnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

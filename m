Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4C6D0614A3C
	for <lists+xen-devel@lfdr.de>; Tue,  1 Nov 2022 13:01:43 +0100 (CET)
Received: from list by lists.xenproject.org with outflank-mailman.433506.686656 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1oppxL-0002TT-VM; Tue, 01 Nov 2022 12:01:23 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 433506.686656; Tue, 01 Nov 2022 12:01:23 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1oppxK-0002AE-PJ; Tue, 01 Nov 2022 12:01:22 +0000
Received: by outflank-mailman (input) for mailman id 433506;
 Tue, 01 Nov 2022 12:01:18 +0000
Received: from se1-gles-sth1-in.inumbo.com ([159.253.27.254]
 helo=se1-gles-sth1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=Lfjo=3B=xenbits.xen.org=jgross@srs-se1.protection.inumbo.net>)
 id 1oppxF-0000IJ-VE
 for xen-devel@lists.xen.org; Tue, 01 Nov 2022 12:01:18 +0000
Received: from mail.xenproject.org (mail.xenproject.org [104.130.215.37])
 by se1-gles-sth1.inumbo.com (Halon) with ESMTPS
 id d875f2c6-59dc-11ed-91b5-6bf2151ebd3b;
 Tue, 01 Nov 2022 13:00:58 +0100 (CET)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <jgross@xenbits.xen.org>)
 id 1oppwl-0005Z9-C4; Tue, 01 Nov 2022 12:00:47 +0000
Received: from jgross by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <jgross@xenbits.xen.org>)
 id 1oppwl-0005X2-BC; Tue, 01 Nov 2022 12:00:47 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: d875f2c6-59dc-11ed-91b5-6bf2151ebd3b
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=vcKamV/Zln9VvC5u2VXjgagwehiHOwuSW7zKIZUmA6A=; b=rRWlynkr1La4Ti+YL2mPRhsceZ
	akeJnhgQantDXDGpjZEcb6Ezn0nvQWCizu+4U6SVCd0+UnlLjLpELvbQDflesPOqmo7Vvqp90P0F8
	LJF6w2d8YfvQ3cyt2c+rOQyROgpUM57vxb6WWC6nk3DseJoo061ajz4RWpTU1lWnVMjA=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 419 v2 (CVE-2022-42322,CVE-2022-42323) -
 Xenstore: Cooperating guests can create arbitrary numbers of nodes
Message-Id: <E1oppwl-0005X2-BC@xenbits.xenproject.org>
Date: Tue, 01 Nov 2022 12:00:47 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

     Xen Security Advisory CVE-2022-42322,CVE-2022-42323 / XSA-419
                               version 2

   Xenstore: Cooperating guests can create arbitrary numbers of nodes

UPDATES IN VERSION 2
====================

Public release.

ISSUE DESCRIPTION
=================

Since the fix of XSA-322 any Xenstore node owned by a removed domain
will be modified to be owned by Dom0.  This will allow two malicious
guests working together to create an arbitrary number of Xenstore
nodes.

This is possible by domain A letting domain B write into domain A's
local Xenstore tree.  Domain B can then create many nodes and reboot.
The nodes created by domain B will now be owned by Dom0.  By repeating
this process over and over again an arbitrary number of nodes can be
created, as Dom0's number of nodes isn't limited by Xenstore quota.

IMPACT
======

Two malicious guests working together can drive xenstored into an
out of memory situation, resulting in a Denial of Service (DoS) of
xenstored.

This inhibits creation of new guests and changing the configuration of
already running guests.

VULNERABLE SYSTEMS
==================

All versions of Xen with the fix for XSA-322 are in principle vulnerable.

Both Xenstore implementations (C and Ocaml) are vulnerable.

MITIGATION
==========

There is no mitigation available.

CREDITS
=======

This issue was discovered by Jürgen Groß of SUSE.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa419/xsa419-oxenstored.patch             xen-unstable
xsa419/xsa419-xenstored-??.patch           xen-unstable, Xen 4.16.x
xsa419/xsa419-4.15-oxenstored.patch        Xen 4.15.x
xsa419/xsa419-4.15-xenstored-??.patch      Xen 4.15.x
xsa419/xsa419-4.14-oxenstored.patch        Xen 4.14.x
xsa419/xsa419-4.14-xenstored-??.patch      Xen 4.14.x
xsa419/xsa419-4.13-oxenstored.patch        Xen 4.13.x
xsa419/xsa419-4.13-xenstored-??.patch      Xen 4.13.x

$ sha256sum xsa419* xsa419*/*
eaeb2a67accac70743cd9bed055b31bee2402600b7452f79da4bb969d7b5607f  xsa419.meta
34abd947ceaf1251afc81356a3ff374bc06c046651f5f9d0894d90c93295d1ca  xsa419/xsa419-4.13-oxenstored.patch
713eea1d9be7a5bef7a681a10648d2ea7db36c961cc8a9c55e147db14f59fbc2  xsa419/xsa419-4.13-xenstored-01.patch
d7b0369ee1c87a08783c0484ae5f62f1c61be9c405e6568085052867bb520b2a  xsa419/xsa419-4.13-xenstored-02.patch
f6e0cd7491d602db3a7ac9b9e94afb59c30bf8690cd116850d8eafc481f022a9  xsa419/xsa419-4.13-xenstored-03.patch
18daa2d6b9d243bfd81e221af9ae1d74cbc621614b78dc751bb6ccdba3d66451  xsa419/xsa419-4.14-oxenstored.patch
d631f12da2a8fcf674aeed33d0037bfff4b11587d6d52e4709739a8d1e90f33a  xsa419/xsa419-4.14-xenstored-01.patch
dc3834b30ac15d31ad1a13a8b4925229f13ce7955f2cc2223651764c55d41e64  xsa419/xsa419-4.14-xenstored-02.patch
f15d02bfc9ee5119347708fd2e4d26c6b4aa18827afab1a10b9139344ca88861  xsa419/xsa419-4.14-xenstored-03.patch
95c35f32cf64229df2768109acc360a6f6ec4ddfdcbde4f0d8165f67432d3eef  xsa419/xsa419-4.15-oxenstored.patch
773e98ee9ddb37e4a743d4435340066aabdc5fb41b6ff12e6b91c709484204ab  xsa419/xsa419-4.15-xenstored-01.patch
4d1f9135be43e121576909787a6403aa1c1e5fa72ead8764326e21beb48d83d4  xsa419/xsa419-4.15-xenstored-02.patch
484bdddae7a750cbddeddb93be5840e3cfdda5799f667c6b5d66c3c9b7217d55  xsa419/xsa419-4.15-xenstored-03.patch
1c790ddc8cbabb32012c7636c46e017b0cbdd1cc23c56baabda4d5dca9531454  xsa419/xsa419-oxenstored.patch
3c53e103f7927ae28ab5c7a3954c7d0a6fbbdce0340816936adb5938cd48c776  xsa419/xsa419-xenstored-01.patch
978e3100b20e0126ee238d3e1c2036b25582b1c3333a028e120d700bac8d2a13  xsa419/xsa419-xenstored-02.patch
57f7015289a940e7f2dc66aedb1c04d37d0aef687a7b91453582e960b7f93076  xsa419/xsa419-xenstored-03.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of patches or mitigations is NOT permitted (except where
all the affected systems and VMs are administered and used only by
organisations which are members of the Xen Project Security Issues
Predisclosure List).  Specifically, deployment on public cloud systems
is NOT permitted.

This is because the patches will result in a guest visible change of
behavior of Xenstore.

Deployment is permitted only AFTER the embargo ends.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmNg+64MHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZR4gIAI+TcWgMKtaJ6G6MeakBbgxliMCO7+C01+94H6ZH
7dC57n3Qm12t3q6WGnPG1YYzKGWT2hsSU8/JtIkuZFe2qyvuG5cVhVcrdOGGkhsZ
4ui517R76Ldb/cBtraX6QRJni+T58ZdQGAChr6KuD8cyMgXAl1gtto9+/rQtsDzr
7XxKcR/+CcNWAOpZTNJ6DtS8V1RuRNtMSuoTCpC3Ph+Edir05bPlz6BF8EnV0cqU
+Jk9nYHGg5H11L0K+yx4cIAWfaP/n/Z2AoND23tV3T4o3U3zQR9xNBvcY1zuvioG
rEfzGNQx9ECQLHYPTzHNNWs+9Fb8eHyiRvkS6SKGolxpj9A=
=nNvr
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa419.meta"
Content-Disposition: attachment; filename="xsa419.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiA0MTksCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xNiIsCiAgICAiNC4xNSIsCiAgICAiNC4xNCIs
CiAgICAiNC4xMyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4ZW4iCiAgXSwK
ICAiUmVjaXBlcyI6IHsKICAgICI0LjEzIjogewogICAgICAiUmVjaXBlcyI6
IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICIw
YmU2M2MyNjE1YjI2ODAwMWY3Y2M5YjcyY2UyNWVlZDk1MjczN2RjIiwKICAg
ICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICA0MTQsCiAgICAgICAg
ICAgIDQxNSwKICAgICAgICAgICAgMzI2LAogICAgICAgICAgICA0MTYsCiAg
ICAgICAgICAgIDQxNywKICAgICAgICAgICAgNDE4CiAgICAgICAgICBdLAog
ICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2E0MTkveHNh
NDE5LTQuMTMteGVuc3RvcmVkLT8/LnBhdGNoIiwKICAgICAgICAgICAgInhz
YTQxOS94c2E0MTktNC4xMy1veGVuc3RvcmVkLnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjE0IjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICIwMTZkZTYyNzQ3YjI2ZWFkNWE1Yzc2M2I2NDBmZThlMjA1
Y2QxODJiIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICA0
MTQsCiAgICAgICAgICAgIDQxNSwKICAgICAgICAgICAgMzI2LAogICAgICAg
ICAgICA0MTYsCiAgICAgICAgICAgIDQxNywKICAgICAgICAgICAgNDE4CiAg
ICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAg
ICJ4c2E0MTkveHNhNDE5LTQuMTQteGVuc3RvcmVkLT8/LnBhdGNoIiwKICAg
ICAgICAgICAgInhzYTQxOS94c2E0MTktNC4xNC1veGVuc3RvcmVkLnBhdGNo
IgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0
LjE1IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewog
ICAgICAgICAgIlN0YWJsZVJlZiI6ICI4MTY1ODBhZmRkMTczMGQ0Zjg1ZjY0
NDc3YTI0MmE0MzlhZjFjZGY4IiwKICAgICAgICAgICJQcmVyZXFzIjogWwog
ICAgICAgICAgICA0MTQsCiAgICAgICAgICAgIDQxNSwKICAgICAgICAgICAg
MzI2LAogICAgICAgICAgICA0MTYsCiAgICAgICAgICAgIDQxNywKICAgICAg
ICAgICAgNDE4CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBb
CiAgICAgICAgICAgICJ4c2E0MTkveHNhNDE5LTQuMTUteGVuc3RvcmVkLT8/
LnBhdGNoIiwKICAgICAgICAgICAgInhzYTQxOS94c2E0MTktNC4xNS1veGVu
c3RvcmVkLnBhdGNoIgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQog
ICAgfSwKICAgICI0LjE2IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAg
ICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICIxYmNlN2ZiMWY3
MDJkYTRmN2E3NDljNmYxNDU3ZWNiMjBiZjc0ZmNhIiwKICAgICAgICAgICJQ
cmVyZXFzIjogWwogICAgICAgICAgICA0MTIsCiAgICAgICAgICAgIDQxNCwK
ICAgICAgICAgICAgNDE1LAogICAgICAgICAgICAzMjYsCiAgICAgICAgICAg
IDQxNiwKICAgICAgICAgICAgNDE3LAogICAgICAgICAgICA0MTgKICAgICAg
ICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhz
YTQxOS94c2E0MTkteGVuc3RvcmVkLT8/LnBhdGNoIiwKICAgICAgICAgICAg
InhzYTQxOS94c2E0MTktb3hlbnN0b3JlZC5wYXRjaCIKICAgICAgICAgIF0K
ICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAibWFzdGVyIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICJjYzQ3NDdiZThiYTE1N2EzYjMxMDkyMWU5ZWUwN2ZiODU0
NWFhMjA2IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICA0
MTIsCiAgICAgICAgICAgIDQxNCwKICAgICAgICAgICAgNDE1LAogICAgICAg
ICAgICAzMjYsCiAgICAgICAgICAgIDQxNiwKICAgICAgICAgICAgNDE3LAog
ICAgICAgICAgICA0MTgKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hl
cyI6IFsKICAgICAgICAgICAgInhzYTQxOS94c2E0MTkteGVuc3RvcmVkLT8/
LnBhdGNoIiwKICAgICAgICAgICAgInhzYTQxOS94c2E0MTktb3hlbnN0b3Jl
ZC5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0K
ICB9Cn0=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.13-oxenstored.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.13-oxenstored.patch"
Content-Transfer-Encoding: base64

RnJvbSBhMjFkY2Q1ZGVkYzdhZjBlNzMzOTVlOGJkNmFmM2RjZGVmMWRjOWU1
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IEZpeCBxdW90YSBieXBhc3Mg
b24gZG9tYWluIHNodXRkb3duCk1JTUUtVmVyc2lvbjogMS4wCkNvbnRlbnQt
VHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250ZW50LVRyYW5z
ZmVyLUVuY29kaW5nOiA4Yml0CgpYU0EtMzIyIGZpeGVkIGEgZG9taWQgcmV1
c2UgdnVsbmVyYWJpbGl0eSBieSBhc3NpZ25pbmcgRG9tMCBhcyB0aGUgb3du
ZXIgb2YKYW55IG5vZGVzIGxlZnQgYWZ0ZXIgYSBkb21haW4gaXMgc2h1dGRv
d24gKGUuZy4gb3V0c2lkZSBpdHMgL2xvY2FsL2RvbWFpbi9OCnRyZWUpLgoK
SG93ZXZlciBEb20wIGhhcyBubyBxdW90YSBvbiBwdXJwb3NlLCBzbyB0aGlz
IG9wZW5lZCB1cCBhbm90aGVyIHBvdGVudGlhbAphdHRhY2sgdmVjdG9yLiBB
dm9pZCBpdCBieSBkZWxldGluZyB0aGVzZSBub2RlcyBpbnN0ZWFkIG9mIGFz
c2lnbmluZyB0aGVtIHRvCkRvbTAuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIzLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IGM0NmVmZjkyMTIwOSAoInRv
b2xzL29jYW1sL3hlbnN0b3JlZDogY2xlYW4gdXAgcGVybWlzc2lvbnMgZm9y
IGRlYWQgZG9tYWlucyIpClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLDtmsg
PGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3RpYW4g
TGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZmIC0t
Z2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sIGIvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sCmluZGV4IGU4YTE2MjIxZjhmYS4u
ODRmMjUwM2U4ZTI5IDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9y
ZWQvcGVybXMubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1z
Lm1sCkBAIC02NCw4ICs2NCw3IEBAIGxldCBnZXRfb3duZXIgcGVybSA9IHBl
cm0ub3duZXIKICogKikKIGxldCByZW1vdmVfZG9taWQgfmRvbWlkIHBlcm0g
PQogCWxldCBhY2wgPSBMaXN0LmZpbHRlciAoZnVuIChhY2xfZG9taWQsIF8p
IC0+IGFjbF9kb21pZCA8PiBkb21pZCkgcGVybS5hY2wgaW4KLQlsZXQgb3du
ZXIgPSBpZiBwZXJtLm93bmVyID0gZG9taWQgdGhlbiAwIGVsc2UgcGVybS5v
d25lciBpbgotCXsgcGVybSB3aXRoIGFjbDsgb3duZXIgfQorCWlmIHBlcm0u
b3duZXIgPSBkb21pZCB0aGVuIE5vbmUgZWxzZSBTb21lIHsgcGVybSB3aXRo
IGFjbDsgb3duZXIgPSBwZXJtLm93bmVyIH0KIAogbGV0IGRlZmF1bHQwID0g
Y3JlYXRlIDAgTk9ORSBbXQogCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94
ZW5zdG9yZWQvc3RvcmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvc3Rv
cmUubWwKaW5kZXggMzI4ZDNhNTE5ODRmLi5kODI3NjRmNjBmYjQgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9zdG9yZS5tbAorKysgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQvc3RvcmUubWwKQEAgLTg5LDEwICs4OSwy
MSBAQCBsZXQgY2hlY2tfb3duZXIgbm9kZSBjb25uZWN0aW9uID0KIAogbGV0
IHJlYyByZWN1cnNlIGZjdCBub2RlID0gZmN0IG5vZGU7IExpc3QuaXRlciAo
cmVjdXJzZSBmY3QpIG5vZGUuY2hpbGRyZW4KIAotKCoqIFtyZWN1cnNlX21h
cCBmIHRyZWVdIGFwcGxpZXMgW2ZdIG9uIGVhY2ggbm9kZSBpbiB0aGUgdHJl
ZSByZWN1cnNpdmVseSAqKQotbGV0IHJlY3Vyc2VfbWFwIGYgPQorKCoqIFty
ZWN1cnNlX2ZpbHRlcl9tYXAgZiB0cmVlXSBhcHBsaWVzIFtmXSBvbiBlYWNo
IG5vZGUgaW4gdGhlIHRyZWUgcmVjdXJzaXZlbHksCisgICAgcG9zc2libHkg
cmVtb3Zpbmcgc29tZSBub2Rlcy4KKyAgICBOb3RlIHRoYXQgdGhlIG5vZGVz
IHJlbW92ZWQgdGhpcyB3YXkgd29uJ3QgZ2VuZXJhdGUgd2F0Y2ggZXZlbnRz
LgorKikKK2xldCByZWN1cnNlX2ZpbHRlcl9tYXAgZiA9CisJbGV0IGludmFs
aWQgPSAtMSBpbgorCWxldCBpc192YWxpZCBub2RlID0gbm9kZS5wZXJtcy5v
d25lciA8PiBpbnZhbGlkIGluCiAJbGV0IHJlYyB3YWxrIG5vZGUgPQotCQlm
IHsgbm9kZSB3aXRoIGNoaWxkcmVuID0gTGlzdC5yZXZfbWFwIHdhbGsgbm9k
ZS5jaGlsZHJlbiB8PiBMaXN0LnJldiB9CisJCSgqIE1hcC5maWx0ZXJfbWFw
IGlzIE9jYW1sIDQuMTErIG9ubHkgKikKKwkJbGV0IG5vZGUgPQorCQl7IG5v
ZGUgd2l0aCBjaGlsZHJlbiA9CisJCQlMaXN0LnJldl9tYXAgd2FsayBub2Rl
LmNoaWxkcmVuIHw+IExpc3QuZmlsdGVyIGlzX3ZhbGlkIHw+IExpc3QucmV2
IH0gaW4KKwkJbWF0Y2ggZiBub2RlIHdpdGgKKwkJfCBTb21lIGtlZXAgLT4g
a2VlcAorCQl8IE5vbmUgLT4geyBub2RlIHdpdGggcGVybXMgPSB7bm9kZS5w
ZXJtcyB3aXRoIG93bmVyID0gaW52YWxpZCB9IH0KIAlpbgogCXdhbGsKIApA
QCAtNDQ2LDExICs0NTcsMTMgQEAgbGV0IHNldHBlcm1zIHN0b3JlIHBlcm0g
cGF0aCBucGVybXMgPQogCiBsZXQgcmVzZXRfcGVybWlzc2lvbnMgc3RvcmUg
ZG9taWQgPQogCUxvZ2dpbmcuaW5mbyAic3RvcmV8bm9kZSIgIkNsZWFuaW5n
IHVwIHhlbnN0b3JlIEFDTHMgZm9yIGRvbWlkICVkIiBkb21pZDsKLQlzdG9y
ZS5yb290IDwtIE5vZGUucmVjdXJzZV9tYXAgKGZ1biBub2RlIC0+Ci0JCWxl
dCBwZXJtcyA9IFBlcm1zLk5vZGUucmVtb3ZlX2RvbWlkIH5kb21pZCBub2Rl
LnBlcm1zIGluCi0JCWlmIHBlcm1zIDw+IG5vZGUucGVybXMgdGhlbgotCQkJ
TG9nZ2luZy5kZWJ1ZyAic3RvcmV8bm9kZSIgIkNoYW5nZWQgcGVybWlzc2lv
bnMgZm9yIG5vZGUgJXMiIChOb2RlLmdldF9uYW1lIG5vZGUpOwotCQl7IG5v
ZGUgd2l0aCBwZXJtcyB9CisJc3RvcmUucm9vdCA8LSBOb2RlLnJlY3Vyc2Vf
ZmlsdGVyX21hcCAoZnVuIG5vZGUgLT4KKwkJbWF0Y2ggUGVybXMuTm9kZS5y
ZW1vdmVfZG9taWQgfmRvbWlkIG5vZGUucGVybXMgd2l0aAorCQl8IE5vbmUg
LT4gTm9uZQorCQl8IFNvbWUgcGVybXMgLT4KKwkJCWlmIHBlcm1zIDw+IG5v
ZGUucGVybXMgdGhlbgorCQkJCUxvZ2dpbmcuZGVidWcgInN0b3JlfG5vZGUi
ICJDaGFuZ2VkIHBlcm1pc3Npb25zIGZvciBub2RlICVzIiAoTm9kZS5nZXRf
bmFtZSBub2RlKTsKKwkJCVNvbWUgeyBub2RlIHdpdGggcGVybXMgfQogCSkg
c3RvcmUucm9vdAogCiB0eXBlIG9wcyA9IHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.13-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.13-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSAxMDRhZmI4ODZmMWQ5MjQzZjk5ZTBmZDk5OGQ3Yzg5OGJjODM0ODMx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTIgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlbW92ZSBu
b2RlcyBvd25lZCBieSBkZXN0cm95ZWQgZG9tYWluCgpJbiBjYXNlIGEgZG9t
YWluIGlzIHJlbW92ZWQgZnJvbSBYZW5zdG9yZSwgcmVtb3ZlIGFsbCBub2Rl
cyBvd25lZCBieQppdCBwZXIgZGVmYXVsdC4KClRoaXMgdGFja2xlcyB0aGUg
cHJvYmxlbSB0aGF0IG5vZGVzIG1pZ2h0IGJlIGNyZWF0ZWQgYnkgYSBkb21h
aW4Kb3V0c2lkZSBpdHMgaG9tZSBwYXRoIGluIFhlbnN0b3JlLCBsZWFkaW5n
IHRvIFhlbnN0b3JlIGhvZ2dpbmcgbW9yZQphbmQgbW9yZSBtZW1vcnkuIERv
bWFpbiBxdW90YSBkb24ndCB3b3JrIGluIHRoaXMgY2FzZSBpZiB0aGUgZ3Vl
c3QgaXMKcmVib290aW5nIGluIGJldHdlZW4uCgpTaW5jZSBYU0EtMzIyIG93
bmVyc2hpcCBvZiBzdWNoIHN0YWxlIG5vZGVzIGlzIHRyYW5zZmVycmVkIHRv
IGRvbTAsCndoaWNoIGlzIGhlbHBpbmcgYWdhaW5zdCB1bmludGVuZGVkIGFj
Y2VzcywgYnV0IG5vdCBhZ2FpbnN0IE9PTSBvZgpYZW5zdG9yZS4KCkFzIGEg
ZmFsbGJhY2sgZm9yIHdlaXJkIGNhc2VzIGFkZCBhIFhlbnN0b3JlIHN0YXJ0
IHBhcmFtZXRlciBmb3IKa2VlcGluZyB0b2RheSdzIHdheSB0byBoYW5kbGUg
c3RhbGUgbm9kZXMsIGFkZGluZyB0aGUgcmlzayBvZiBYZW5zdG9yZQpoaXR0
aW5nIGFuIE9PTSBzaXR1YXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIyLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IDQ5NjMwNjMyNGQ4ZCAoInRv
b2xzL3hlbnN0b3JlOiByZXZva2UgYWNjZXNzIHJpZ2h0cyBmb3IgcmVtb3Zl
ZCBkb21haW5zIikKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdy
b3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3Jh
bGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwppbmRleCA5NjU1YWY0YzAxZmEuLjdlYjY5OGUxZmMyMiAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC03Niw2ICs3Niw3
IEBAIHN0YXRpYyBib29sIHZlcmJvc2UgPSBmYWxzZTsKIExJU1RfSEVBRChj
b25uZWN0aW9ucyk7CiBpbnQgdHJhY2VmZCA9IC0xOwogc3RhdGljIGJvb2wg
cmVjb3ZlcnkgPSB0cnVlOworYm9vbCBrZWVwX29ycGhhbnMgPSBmYWxzZTsK
IHN0YXRpYyBpbnQgcmVvcGVuX2xvZ19waXBlWzJdOwogc3RhdGljIGludCBy
ZW9wZW5fbG9nX3BpcGUwX3BvbGxmZF9pZHggPSAtMTsKIGNoYXIgKnRyYWNl
ZmlsZSA9IE5VTEw7CkBAIC02NjIsNyArNjYzLDcgQEAgc3RydWN0IG5vZGUg
KnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LAogCW5vZGUtPnBlcm1zLnAgPSBoZHItPnBlcm1zOwogCW5vZGUt
PmFjYy5kb21pZCA9IG5vZGUtPnBlcm1zLnBbMF0uaWQ7CiAJbm9kZS0+YWNj
Lm1lbW9yeSA9IGRhdGEuZHNpemU7Ci0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhjb25uLCBub2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKG5vZGUpKQogCQlnb3RvIGVycm9yOwogCiAJLyogSWYgb3duZXIg
aXMgZ29uZSByZXNldCBjdXJyZW50bHkgYWNjb3VudGVkIG1lbW9yeSBzaXpl
LiAqLwpAQCAtNzA1LDcgKzcwNiw3IEBAIGludCB3cml0ZV9ub2RlX3Jhdyhz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwgc3RydWN0
IG5vZGUgKm5vZGUsCiAJdm9pZCAqcDsKIAlzdHJ1Y3QgeHNfdGRiX3JlY29y
ZF9oZHIgKmhkcjsKIAotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMo
Y29ubiwgbm9kZSkpCisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKIAkJcmV0dXJuIGVycm5vOwogCiAJZGF0YS5kc2l6ZSA9IHNpemVv
ZigqaGRyKQpAQCAtMTU0Niw3ICsxNTQ3LDcgQEAgc3RhdGljIGludCBkZWxu
b2RlX3N1Yihjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLAogCXJldHVybiBXQUxLX1RSRUVfUk1fQ0hJTERFTlRSWTsKIH0KIAot
c3RhdGljIGludCBfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0
IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSkKK2ludCBybV9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0
IGNoYXIgKm5hbWUpCiB7CiAJc3RydWN0IG5vZGUgKnBhcmVudDsKIAljaGFy
ICpwYXJlbnRuYW1lID0gZ2V0X3BhcmVudChjdHgsIG5hbWUpOwpAQCAtMTYw
OCw3ICsxNjA5LDcgQEAgc3RhdGljIGludCBkb19ybShjb25zdCB2b2lkICpj
dHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCWlmIChzdHJlcShuYW1l
LCAiLyIpKQogCQlyZXR1cm4gRUlOVkFMOwogCi0JcmV0ID0gX3JtKGNvbm4s
IGN0eCwgbmFtZSk7CisJcmV0ID0gcm1fbm9kZShjb25uLCBjdHgsIG5hbWUp
OwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTI0NjEsNiArMjQ2
Miw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtUiwgLS1uby1y
ZWNvdmVyeSAgICAgICB0byByZXF1ZXN0IHRoYXQgbm8gcmVjb3Zlcnkgc2hv
dWxkIGJlIGF0dGVtcHRlZCB3aGVuXG4iCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGUgc3RvcmUgaXMgY29ycnVwdGVkIChkZWJ1ZyBvbmx5KSxc
biIKICIgIC1JLCAtLWludGVybmFsLWRiICAgICAgIHN0b3JlIGRhdGFiYXNl
IGluIG1lbW9yeSwgbm90IG9uIGRpc2tcbiIKKyIgIC1LLCAtLWtlZXAtb3Jw
aGFucyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFp
biB3aGVuIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9t
YWluIGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIK
ICIgIC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9z
ZSBleGVjdXRpb24uXG4iKTsKIH0KIApAQCAtMjQ4NCw2ICsyNDg3LDcgQEAg
c3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRpbWVv
dXQiLCAxLCBOVUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5V
TEwsICdSJyB9LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0s
CisJeyAia2VlcC1vcnBoYW5zIiwgMCwgTlVMTCwgJ0snIH0sCiAJeyAidmVy
Ym9zZSIsIDAsIE5VTEwsICdWJyB9LAogCXsgIndhdGNoLW5iIiwgMSwgTlVM
TCwgJ1cnIH0sCiAJeyBOVUxMLCAwLCBOVUxMLCAwIH0gfTsKQEAgLTI1NTgs
NyArMjU2Miw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10p
CiAJaW50IHRpbWVvdXQ7CiAKIAotCXdoaWxlICgob3B0ID0gZ2V0b3B0X2xv
bmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6UTpxOlQ6UlZXOnc6Iiwg
b3B0aW9ucywKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFy
Z3YsICJERTpGOkhLTlBTOnQ6QTpROnE6VDpSVlc6dzoiLCBvcHRpb25zLAog
CQkJCSAgTlVMTCkpICE9IC0xKSB7CiAJCXN3aXRjaCAob3B0KSB7CiAJCWNh
c2UgJ0QnOgpAQCAtMjU5NCw2ICsyNTk4LDkgQEAgaW50IG1haW4oaW50IGFy
Z2MsIGNoYXIgKmFyZ3ZbXSkKIAkJY2FzZSAnSSc6CiAJCQl0ZGJfZmxhZ3Mg
PSBUREJfSU5URVJOQUx8VERCX05PTE9DSzsKIAkJCWJyZWFrOworCQljYXNl
ICdLJzoKKwkJCWtlZXBfb3JwaGFucyA9IHRydWU7CisJCQlicmVhazsKIAkJ
Y2FzZSAnVic6CiAJCQl2ZXJib3NlID0gdHJ1ZTsKIAkJCWJyZWFrOwpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggZmM5ODgyYWMz
N2Q1Li5lYzI0YzI3YWMyNDAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuaApAQCAtMjA0LDYgKzIwNCw5IEBAIGludCB3cml0ZV9ub2Rl
X3JhdyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwg
c3RydWN0IG5vZGUgKm5vZGUsCiBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAJCSAg
ICAgICBjb25zdCBjaGFyICpuYW1lKTsKIAorLyogUmVtb3ZlIGEgbm9kZSBh
bmQgaXRzIGNoaWxkcmVuLiAqLworaW50IHJtX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFt
ZSk7CisKIHZvaWQgc2V0dXBfc3RydWN0dXJlKHZvaWQpOwogc3RydWN0IGNv
bm5lY3Rpb24gKm5ld19jb25uZWN0aW9uKGNvbm53cml0ZWZuX3QgKndyaXRl
LCBjb25ucmVhZGZuX3QgKnJlYWQpOwogdm9pZCBjaGVja19zdG9yZSh2b2lk
KTsKQEAgLTI0Miw2ICsyNDUsNyBAQCBleHRlcm4gaW50IHF1b3RhX3JlcV9v
dXRzdGFuZGluZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CiBl
eHRlcm4gaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX3NvZnQ7CiBleHRl
cm4gaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX2hhcmQ7CitleHRlcm4g
Ym9vbCBrZWVwX29ycGhhbnM7CiAKIGV4dGVybiB1bnNpZ25lZCBpbnQgdGlt
ZW91dF93YXRjaF9ldmVudF9tc2VjOwogCmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmMKaW5kZXggNGEwZTZhMDViOGNiLi5jYTYzOWNm
NDMzY2YgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9k
b21haW4uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWlu
LmMKQEAgLTIwNCwxMCArMjA0LDY1IEBAIHN0YXRpYyB2b2lkIHVubWFwX2lu
dGVyZmFjZSh2b2lkICppbnRlcmZhY2UpCiAJeGVuZ250dGFiX3VubWFwKCp4
Z3RfaGFuZGxlLCBpbnRlcmZhY2UsIDEpOwogfQogCitzdGF0aWMgaW50IGRv
bWFpbl90cmVlX3JlbW92ZV9zdWIoY29uc3Qgdm9pZCAqY3R4LCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKKwkJCQkgIHN0cnVjdCBub2RlICpub2RlLCB2
b2lkICphcmcpCit7CisJc3RydWN0IGRvbWFpbiAqZG9tYWluID0gYXJnOwor
CVREQl9EQVRBIGtleTsKKwlpbnQgcmV0ID0gV0FMS19UUkVFX09LOworCisJ
aWYgKG5vZGUtPnBlcm1zLnBbMF0uaWQgIT0gZG9tYWluLT5kb21pZCkKKwkJ
cmV0dXJuIFdBTEtfVFJFRV9PSzsKKworCWlmIChrZWVwX29ycGhhbnMpIHsK
KwkJa2V5LmRwdHIgPSAoY2hhciAqKW5vZGUtPm5hbWU7CisJCWtleS5kc2l6
ZSA9IHN0cmxlbihub2RlLT5uYW1lKTsKKwkJZG9tYWluLT5uYmVudHJ5LS07
CisJCW5vZGUtPnBlcm1zLnBbMF0uaWQgPSBwcml2X2RvbWlkOworCQlub2Rl
LT5hY2MubWVtb3J5ID0gMDsKKwkJZG9tYWluX2VudHJ5X2luYyhOVUxMLCBu
b2RlKTsKKwkJaWYgKHdyaXRlX25vZGVfcmF3KE5VTEwsICZrZXksIG5vZGUs
IHRydWUpKSB7CisJCQkvKiBUaGF0J3MgdW5mb3J0dW5hdGUuIFdlIG9ubHkg
Y2FuIHRyeSB0byBjb250aW51ZS4gKi8KKwkJCXN5c2xvZyhMT0dfRVJSLAor
CQkJICAgICAgICJlcnJvciB3aGVuIG1vdmluZyBvcnBoYW5lZCBub2RlICVz
IHRvIGRvbTBcbiIsCisJCQkgICAgICAgbm9kZS0+bmFtZSk7CisJCX0gZWxz
ZQorCQkJdHJhY2UoIm9ycGhhbmVkIG5vZGUgJXMgbW92ZWQgdG8gZG9tMFxu
Iiwgbm9kZS0+bmFtZSk7CisJfSBlbHNlIHsKKwkJaWYgKHJtX25vZGUoTlVM
TCwgY3R4LCBub2RlLT5uYW1lKSkgeworCQkJLyogVGhhdCdzIHVuZm9ydHVu
YXRlLiBXZSBvbmx5IGNhbiB0cnkgdG8gY29udGludWUuICovCisJCQlzeXNs
b2coTE9HX0VSUiwKKwkJCSAgICAgICAiZXJyb3Igd2hlbiBkZWxldGluZyBv
cnBoYW5lZCBub2RlICVzXG4iLAorCQkJICAgICAgIG5vZGUtPm5hbWUpOwor
CQl9IGVsc2UKKwkJCXRyYWNlKCJvcnBoYW5lZCBub2RlICVzIGRlbGV0ZWRc
biIsIG5vZGUtPm5hbWUpOworCisJCS8qIFNraXAgY2hpbGRyZW4gaW4gYWxs
IGNhc2VzIGluIG9yZGVyIHRvIGF2b2lkIG1vcmUgZXJyb3JzLiAqLworCQly
ZXQgPSBXQUxLX1RSRUVfU0tJUF9DSElMRFJFTjsKKwl9CisKKwlyZXR1cm4g
ZG9tYWluLT5uYmVudHJ5ID4gMCA/IHJldCA6IFdBTEtfVFJFRV9TVUNDRVNT
X1NUT1A7Cit9CisKK3N0YXRpYyB2b2lkIGRvbWFpbl90cmVlX3JlbW92ZShz
dHJ1Y3QgZG9tYWluICpkb21haW4pCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qg
d2Fsa19mdW5jcyB3YWxrZnVuY3MgPSB7IC5lbnRlciA9IGRvbWFpbl90cmVl
X3JlbW92ZV9zdWIgfTsKKworCWlmIChkb21haW4tPm5iZW50cnkgPiAwKSB7
CisJCXJldCA9IHdhbGtfbm9kZV90cmVlKGRvbWFpbiwgTlVMTCwgIi8iLCAm
d2Fsa2Z1bmNzLCBkb21haW4pOworCQlpZiAocmV0ID09IFdBTEtfVFJFRV9F
UlJPUl9TVE9QKQorCQkJc3lzbG9nKExPR19FUlIsCisJCQkgICAgICAgImVy
cm9yIHdoZW4gbG9va2luZyBmb3Igb3JwaGFuZWQgbm9kZXNcbiIpOworCX0K
K30KKwogc3RhdGljIGludCBkZXN0cm95X2RvbWFpbih2b2lkICpfZG9tYWlu
KQogewogCXN0cnVjdCBkb21haW4gKmRvbWFpbiA9IF9kb21haW47CiAKKwlk
b21haW5fdHJlZV9yZW1vdmUoZG9tYWluKTsKKwogCWxpc3RfZGVsKCZkb21h
aW4tPmxpc3QpOwogCiAJaWYgKCFkb21haW4tPmludHJvZHVjZWQpCkBAIC04
NDUsMTUgKzkwMCwxNSBAQCBpbnQgZG9tYWluX2VudHJ5X2luYyhzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiAJc3RydWN0
IGRvbWFpbiAqZDsKIAl1bnNpZ25lZCBpbnQgZG9taWQ7CiAKLQlpZiAoIWNv
bm4pCisJaWYgKCFub2RlLT5wZXJtcy5wKQogCQlyZXR1cm4gMDsKIAotCWRv
bWlkID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBlcm1zLnBbMF0uaWQgOiBj
b25uLT5pZDsKKwlkb21pZCA9IG5vZGUtPnBlcm1zLnBbMF0uaWQ7CiAKLQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKKwlpZiAoY29ubiAmJiBjb25uLT50
cmFuc2FjdGlvbikgewogCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29ubi0+
dHJhbnNhY3Rpb24sIGRvbWlkKTsKIAl9IGVsc2UgewotCQlkID0gKGRvbWlk
ID09IGNvbm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4K
KwkJZCA9IChjb25uICYmIGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KIAkJICAgIDogZmluZF9vcl9hbGxvY19l
eGlzdGluZ19kb21haW4oZG9taWQpOwogCQlpZiAoZCkKIAkJCWQtPm5iZW50
cnkrKzsKQEAgLTkxNCwyMyArOTY5LDExIEBAIGludCBkb21haW5fYWxsb2Nf
cGVybXJlZnMoc3RydWN0IG5vZGVfcGVybXMgKnBlcm1zKQogICogUmVtb3Zl
IHBlcm1pc3Npb25zIGZvciBubyBsb25nZXIgZXhpc3RpbmcgZG9tYWlucyBp
biBvcmRlciB0byBhdm9pZCBhIG5ldwogICogZG9tYWluIHdpdGggdGhlIHNh
bWUgZG9taWQgaW5oZXJpdGluZyB0aGUgcGVybWlzc2lvbnMuCiAgKi8KLWlu
dCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoraW50IGRvbWFpbl9hZGp1c3Rf
bm9kZV9wZXJtcyhzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKIAl1bnNpZ25lZCBp
bnQgaTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gY2hrX2RvbWFpbl9nZW5lcmF0
aW9uKG5vZGUtPnBlcm1zLnBbMF0uaWQsIG5vZGUtPmdlbmVyYXRpb24pOwot
Ci0JLyogSWYgdGhlIG93bmVyIGRvZXNuJ3QgZXhpc3QgYW55IGxvbmdlciBn
aXZlIGl0IHRvIHByaXYgZG9tYWluLiAqLwotCWlmICghcmV0KSB7Ci0JCS8q
Ci0JCSAqIEluIHRoZW9yeSB3ZSdkIG5lZWQgdG8gdXBkYXRlIHRoZSBudW1i
ZXIgb2YgZG9tMCBub2RlcyBoZXJlLAotCQkgKiBidXQgd2UgY291bGQgYmUg
Y2FsbGVkIGZvciBhIHJlYWQgb2YgdGhlIG5vZGUuIFNvIGJldHRlcgotCQkg
KiBhdm9pZCB0aGUgcmlzayB0byBvdmVyZmxvdyB0aGUgbm9kZSBjb3VudCBv
ZiBkb20wLgotCQkgKi8KLQkJbm9kZS0+cGVybXMucFswXS5pZCA9IHByaXZf
ZG9taWQ7Ci0JfQotCiAJZm9yIChpID0gMTsgaSA8IG5vZGUtPnBlcm1zLm51
bTsgaSsrKSB7CiAJCWlmIChub2RlLT5wZXJtcy5wW2ldLnBlcm1zICYgWFNf
UEVSTV9JR05PUkUpCiAJCQljb250aW51ZTsKQEAgLTk0OCwxNSArOTkxLDE1
IEBAIHZvaWQgZG9tYWluX2VudHJ5X2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiAJc3RydWN0IGRvbWFpbiAqZDsK
IAl1bnNpZ25lZCBpbnQgZG9taWQ7CiAKLQlpZiAoIWNvbm4pCisJaWYgKCFu
b2RlLT5wZXJtcy5wKQogCQlyZXR1cm47CiAKIAlkb21pZCA9IG5vZGUtPnBl
cm1zLnAgPyBub2RlLT5wZXJtcy5wWzBdLmlkIDogY29ubi0+aWQ7CiAKLQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKKwlpZiAoY29ubiAmJiBjb25uLT50
cmFuc2FjdGlvbikgewogCQl0cmFuc2FjdGlvbl9lbnRyeV9kZWMoY29ubi0+
dHJhbnNhY3Rpb24sIGRvbWlkKTsKIAl9IGVsc2UgewotCQlkID0gKGRvbWlk
ID09IGNvbm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4K
KwkJZCA9IChjb25uICYmIGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KIAkJICAgIDogZmluZF9kb21haW5fc3Ry
dWN0KGRvbWlkKTsKIAkJaWYgKGQpIHsKIAkJCWQtPm5iZW50cnktLTsKQEAg
LTEwNzUsNyArMTExOCw3IEBAIGludCBkb21haW5fbWVtb3J5X2FkZCh1bnNp
Z25lZCBpbnQgZG9taWQsIGludCBtZW0sIGJvb2wgbm9fcXVvdGFfY2hlY2sp
CiAJCSAqIGV4aXN0LCBhcyBhY2NvdW50aW5nIGlzIGRvbmUgZWl0aGVyIGZv
ciBhIGRvbWFpbiByZWxhdGVkIHRvCiAJCSAqIHRoZSBjdXJyZW50IGNvbm5l
Y3Rpb24sIG9yIGZvciB0aGUgZG9tYWluIG93bmluZyBhIG5vZGUKIAkJICog
KHdoaWNoIGlzIGFsd2F5cyBleGlzdGluZywgYXMgdGhlIG93bmVyIG9mIHRo
ZSBub2RlIGlzCi0JCSAqIHRlc3RlZCB0byBleGlzdCBhbmQgcmVwbGFjZWQg
YnkgZG9taWQgMCBpZiBub3QpLgorCQkgKiB0ZXN0ZWQgdG8gZXhpc3QgYW5k
IGRlbGV0ZWQgb3IgcmVwbGFjZWQgYnkgZG9taWQgMCBpZiBub3QpLgogCQkg
KiBTbyBub3QgZmluZGluZyB0aGUgcmVsYXRlZCBkb21haW4gTVVTVCBiZSBh
biBlcnJvciBpbiB0aGUKIAkJICogZGF0YSBiYXNlLgogCQkgKi8KZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaCBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAppbmRleCBiYWI0MDUy
MDllMmEuLjViZDI1MzM5NWQ3NyAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5oCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9kb21haW4uaApAQCAtNjQsNyArNjQsNyBAQCBib29sIGRvbWFp
bl9jYW5fd3JpdGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogYm9vbCBk
b21haW5faXNfdW5wcml2aWxlZ2VkKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
KTsKIAogLyogUmVtb3ZlIG5vZGUgcGVybWlzc2lvbnMgZm9yIG5vIGxvbmdl
ciBleGlzdGluZyBkb21haW5zLiAqLwotaW50IGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUg
Km5vZGUpOworaW50IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qg
bm9kZSAqbm9kZSk7CiBpbnQgZG9tYWluX2FsbG9jX3Blcm1yZWZzKHN0cnVj
dCBub2RlX3Blcm1zICpwZXJtcyk7CiAKIC8qIFF1b3RhIG1hbmlwdWxhdGlv
biAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.13-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.13-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA2NTY4NDhhNWRjMzE0ZDgzMDAzOGRmMmFjNmM4NmU0MmE2YTg5NTU3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1ha2UgdGhl
IGludGVybmFsIG1lbW9yeSBkYXRhIGJhc2UgdGhlIGRlZmF1bHQKCkhhdmlu
ZyBhIGZpbGUgYmFja2VkIGRhdGEgYmFzZSBoYXMgdGhlIG9ubHkgYWR2YW50
YWdlIG9mIGJlaW5nIGNhcGFibGUKdG8gZHVtcCB0aGUgY29udGVudHMgb2Yg
aXQgd2hpbGUgWGVuc3RvcmUgaXMgcnVubmluZywgYW5kIHBvdGVudGlhbGx5
CnVzaW5nIGxlc3Mgc3dhcCBzcGFjZSBpbiBjYXNlIHRoZSBkYXRhIGJhc2Ug
Y2FuJ3QgYmUga2VwdCBpbiBtZW1vcnkuCgpJdCBoYXMgdGhlIG1ham9yIGRp
c2FkdmFudGFnZSBvZiBhIGh1Z2UgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQ6IHN3
aXRjaGluZwp0byBrZWVwIHRoZSBkYXRhIGJhc2UgaW4gbWVtb3J5IG9ubHkg
c3BlZWRzIHVwIGxpdmUgdXBkYXRlIG9mIHhlbnN0b3JlZAp3aXRoIDEyMDAw
MCBub2RlcyBmcm9tIDIwIG1pbnV0ZXMgdG8gMTEgc2Vjb25kcy4gQSBjb21w
bGV0ZSB0cmVlIHdhbGsKb2YgdGhpcyBjb25maWd1cmF0aW9uIHdpbGwgYmUg
cmVkdWNlZCBmcm9tIDcgc2Vjb25kcyB0byAyODAgbXNlY3MKKG1lYXN1cmVk
IGJ5ICJ4ZW5zdG9yZS1jb250cm9sIGNoZWNrIikuCgpTbyBtYWtlIHRoZSBp
bnRlcm5hbCBtZW1vcnkgZGF0YSBiYXNlIHRoZSBkZWZhdWx0IGFuZCBlbmhh
bmNlIHRoZQoiLS1pbnRlcm5hbC1kYiIgY29tbWFuZCBsaW5lIHBhcmFtZXRl
ciB0byB0YWtlIGFuIG9wdGlvbmFsIHBhcmFtZXRlcgphbGxvd2luZyB0byBz
d2l0Y2ggdGhlIGludGVybmFsIGRhdGEgYmFzZSBiYWNrIHRvIHRoZSBmaWxl
IGJhc2VkIG9uZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtNDE5LgoKUmVwb3J0
ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KU2lnbmVk
LW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZp
ZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRp
ZmYgLS1naXQgYS90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWlu
LmMgYi90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKaW5k
ZXggYWRiODQwOGI2M2MyLi5iNGQ3ZWQ1NzNlY2MgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL2hlbHBlcnMvaW5pdC14ZW5zdG9yZS1kb21haW4uYworKysgYi90b29s
cy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKQEAgLTEyOCw5ICsx
MjgsOSBAQCBzdGF0aWMgaW50IGJ1aWxkKHhjX2ludGVyZmFjZSAqeGNoKQog
ICAgIH0KIAogICAgIGlmICggcGFyYW0gKQotICAgICAgICBzbnByaW50Zihj
bWRsaW5lLCA1MTIsICItLWV2ZW50ICVkIC0taW50ZXJuYWwtZGIgJXMiLCBy
diwgcGFyYW0pOworICAgICAgICBzbnByaW50ZihjbWRsaW5lLCA1MTIsICIt
LWV2ZW50ICVkICVzIiwgcnYsIHBhcmFtKTsKICAgICBlbHNlCi0gICAgICAg
IHNucHJpbnRmKGNtZGxpbmUsIDUxMiwgIi0tZXZlbnQgJWQgLS1pbnRlcm5h
bC1kYiIsIHJ2KTsKKyAgICAgICAgc25wcmludGYoY21kbGluZSwgNTEyLCAi
LS1ldmVudCAlZCIsIHJ2KTsKIAogICAgIGRvbSA9IHhjX2RvbV9hbGxvY2F0
ZSh4Y2gsIGNtZGxpbmUsIE5VTEwpOwogICAgIHJ2ID0geGNfZG9tX2tlcm5l
bF9maWxlKGRvbSwga2VybmVsKTsKZGlmZiAtLWdpdCBhL3Rvb2xzL3hlbnN0
b3JlL3hlbnN0b3JlZF9jb3JlLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5jCmluZGV4IDdlYjY5OGUxZmMyMi4uNjgzNTU0ZmYyY2RlIDEw
MDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCisr
KyBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmMKQEAgLTIxMzIs
NyArMjEzMiw3IEBAIHN0YXRpYyB2b2lkIGFjY2VwdF9jb25uZWN0aW9uKGlu
dCBzb2NrLCBib29sIGNhbndyaXRlKQogfQogI2VuZGlmCiAKLXN0YXRpYyBp
bnQgdGRiX2ZsYWdzOworc3RhdGljIGludCB0ZGJfZmxhZ3MgPSBUREJfSU5U
RVJOQUwgfCBUREJfTk9MT0NLOwogCiAvKiBXZSBjcmVhdGUgaW5pdGlhbCBu
b2RlcyBtYW51YWxseS4gKi8KIHN0YXRpYyB2b2lkIG1hbnVhbF9ub2RlKGNv
bnN0IGNoYXIgKm5hbWUsIGNvbnN0IGNoYXIgKmNoaWxkKQpAQCAtMjQ2MSw3
ICsyNDYxLDggQEAgc3RhdGljIHZvaWQgdXNhZ2Uodm9pZCkKICIgICAgICAg
ICAgICAgICAgICAgICAgICAgIHdhdGNoLWV2ZW50OiB0aW1lIGEgd2F0Y2gt
ZXZlbnQgaXMga2VwdCBwZW5kaW5nXG4iCiAiICAtUiwgLS1uby1yZWNvdmVy
eSAgICAgICB0byByZXF1ZXN0IHRoYXQgbm8gcmVjb3Zlcnkgc2hvdWxkIGJl
IGF0dGVtcHRlZCB3aGVuXG4iCiAiICAgICAgICAgICAgICAgICAgICAgICAg
ICB0aGUgc3RvcmUgaXMgY29ycnVwdGVkIChkZWJ1ZyBvbmx5KSxcbiIKLSIg
IC1JLCAtLWludGVybmFsLWRiICAgICAgIHN0b3JlIGRhdGFiYXNlIGluIG1l
bW9yeSwgbm90IG9uIGRpc2tcbiIKKyIgIC1JLCAtLWludGVybmFsLWRiIFtv
bnxvZmZdIHN0b3JlIGRhdGFiYXNlIGluIG1lbW9yeSwgbm90IG9uIGRpc2ss
IGRlZmF1bHQgaXNcbiIKKyIgICAgICAgICAgICAgICAgICAgICAgICAgIG1l
bW9yeSwgd2l0aCBcIi0taW50ZXJuYWwtZGIgb2ZmXCIgaXQgaXMgb24gZGlz
a1xuIgogIiAgLUssIC0ta2VlcC1vcnBoYW5zICAgICAgZG9uJ3QgZGVsZXRl
IG5vZGVzIG93bmVkIGJ5IGEgZG9tYWluIHdoZW4gdGhlXG4iCiAiICAgICAg
ICAgICAgICAgICAgICAgICAgICBkb21haW4gaXMgZGVsZXRlZCAodGhpcyBp
cyBhIHNlY3VyaXR5IHJpc2shKVxuIgogIiAgLVYsIC0tdmVyYm9zZSAgICAg
ICAgICAgdG8gcmVxdWVzdCB2ZXJib3NlIGV4ZWN1dGlvbi5cbiIpOwpAQCAt
MjQ4Niw3ICsyNDg3LDcgQEAgc3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9u
c1tdID0gewogCXsgInF1b3RhLXNvZnQiLCAxLCBOVUxMLCAncScgfSwKIAl7
ICJ0aW1lb3V0IiwgMSwgTlVMTCwgJ3cnIH0sCiAJeyAibm8tcmVjb3Zlcnki
LCAwLCBOVUxMLCAnUicgfSwKLQl7ICJpbnRlcm5hbC1kYiIsIDAsIE5VTEws
ICdJJyB9LAorCXsgImludGVybmFsLWRiIiwgMiwgTlVMTCwgJ0knIH0sCiAJ
eyAia2VlcC1vcnBoYW5zIiwgMCwgTlVMTCwgJ0snIH0sCiAJeyAidmVyYm9z
ZSIsIDAsIE5VTEwsICdWJyB9LAogCXsgIndhdGNoLW5iIiwgMSwgTlVMTCwg
J1cnIH0sCkBAIC0yNTYyLDcgKzI1NjMsOCBAQCBpbnQgbWFpbihpbnQgYXJn
YywgY2hhciAqYXJndltdKQogCWludCB0aW1lb3V0OwogCiAKLQl3aGlsZSAo
KG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhLTlBTOnQ6
QTpROnE6VDpSVlc6dzoiLCBvcHRpb25zLAorCXdoaWxlICgob3B0ID0gZ2V0
b3B0X2xvbmcoYXJnYywgYXJndiwKKwkJCQkgICJERTpGOkhJOjpLTlBTOnQ6
QTpROnE6VDpSVlc6dzoiLCBvcHRpb25zLAogCQkJCSAgTlVMTCkpICE9IC0x
KSB7CiAJCXN3aXRjaCAob3B0KSB7CiAJCWNhc2UgJ0QnOgpAQCAtMjU5Niw3
ICsyNTk4LDggQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkK
IAkJCXRyYWNlZmlsZSA9IG9wdGFyZzsKIAkJCWJyZWFrOwogCQljYXNlICdJ
JzoKLQkJCXRkYl9mbGFncyA9IFREQl9JTlRFUk5BTHxUREJfTk9MT0NLOwor
CQkJaWYgKG9wdGFyZyAmJiAhc3RyY21wKG9wdGFyZywgIm9mZiIpKQorCQkJ
CXRkYl9mbGFncyA9IDA7CiAJCQlicmVhazsKIAkJY2FzZSAnSyc6CiAJCQlr
ZWVwX29ycGhhbnMgPSB0cnVlOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.13-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.13-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBkYTRlMzM5MjFjNDhiYTVmN2IyMDZlMzAzNGIyMWRiNTU4NmE2OTAw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogZG9jczogZW5oYW5jZSB4ZW5zdG9yZS50
eHQgd2l0aCBwZXJtaXNzaW9ucyBkZXNjcmlwdGlvbgpNSU1FLVZlcnNpb246
IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRGLTgK
Q29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKVGhlIHBlcm1pc3Np
b24gc2NoZW1lIG9mIFhlbnN0b3JlIG5vZGVzIGlzIG5vdCByZWFsbHkgY292
ZXJlZCBieQpkb2NzL21pc2MveGVuc3RvcmUudHh0LCBvdGhlciB0aGFuIHJl
ZmVycmluZyB0byB0aGUgWGVuIHdpa2kuCgpBZGQgYSBwYXJhZ3JhcGggZXhw
bGFpbmluZyB0aGUgcGVybWlzc2lvbnMgb2Ygbm9kZXMsIGFuZCBlc3BlY2lh
bGx5Cm1lbnRpb25pbmcgcmVtb3ZhbCBvZiBub2RlcyB3aGVuIGEgZG9tYWlu
IGhhcyBiZWVuIHJlbW92ZWQgZnJvbQpYZW5zdG9yZS4KClRoaXMgaXMgcGFy
dCBvZiBYU0EtNDE5LgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8
amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogRWR3aW4gVMO2csO2ayA8
ZWR2aW4udG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNj
L3hlbnN0b3JlLnR4dCBiL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQKaW5kZXgg
MGRiYWM0NDJkNzlkLi5kNTA4NGJjYmFhMDEgMTAwNjQ0Ci0tLSBhL2RvY3Mv
bWlzYy94ZW5zdG9yZS50eHQKKysrIGIvZG9jcy9taXNjL3hlbnN0b3JlLnR4
dApAQCAtNDMsNiArNDMsMTcgQEAgYnl0ZXMgYXJlIGZvcmJpZGRlbjsgY2xp
ZW50cyBzcGVjaWZ5aW5nIHJlbGF0aXZlIHBhdGhzIHNob3VsZCBrZWVwCiB0
aGVtIHRvIHdpdGhpbiAyMDQ4IGJ5dGVzLiAgKFNlZSBYRU5TVE9SRV8qX1BB
VEhfTUFYIGluIHhzX3dpcmUuaC4pCiAKIAorRWFjaCBub2RlIGhhcyBvbmUg
b3IgbXVsdGlwbGUgcGVybWlzc2lvbiBlbnRyaWVzLiAgUGVybWlzc2lvbnMg
YXJlCitncmFudGVkIGJ5IGRvbWFpbi1pZCwgdGhlIGZpcnN0IHBlcm1pc3Np
b24gZW50cnkgb2YgZWFjaCBub2RlIHNwZWNpZmllcwordGhlIG93bmVyIG9m
IHRoZSBub2RlLiAgUGVybWlzc2lvbnMgb2YgYSBub2RlIGNhbiBiZSBjaGFu
Z2VkIGJ5IHRoZQorb3duZXIgb2YgdGhlIG5vZGUsIHRoZSBvd25lciBjYW4g
b25seSBiZSBtb2RpZmllZCBieSB0aGUgY29udHJvbAorZG9tYWluICh1c3Vh
bGx5IGRvbWFpbiBpZCAwKS4gIFRoZSBvd25lciBhbHdheXMgaGFzIHRoZSBy
aWdodCB0byByZWFkCithbmQgd3JpdGUgdGhlIG5vZGUsIHdoaWxlIG90aGVy
IHBlcm1pc3Npb25zIGNhbiBiZSBzZXR1cCB0byBhbGxvdworcmVhZCBhbmQv
b3Igd3JpdGUgYWNjZXNzLiAgV2hlbiBhIGRvbWFpbiBpcyBiZWluZyByZW1v
dmVkIGZyb20gWGVuc3RvcmUKK25vZGVzIG93bmVkIGJ5IHRoYXQgZG9tYWlu
IHdpbGwgYmUgcmVtb3ZlZCB0b2dldGhlciB3aXRoIGFsbCBvZiB0aG9zZQor
bm9kZXMnIGNoaWxkcmVuLgorCisKIENvbW11bmljYXRpb24gd2l0aCB4ZW5z
dG9yZSBpcyB2aWEgZWl0aGVyIHNvY2tldHMsIG9yIGV2ZW50IGNoYW5uZWwK
IGFuZCBzaGFyZWQgbWVtb3J5LCBhcyBzcGVjaWZpZWQgaW4gaW8veHNfd2ly
ZS5oOiBlYWNoIG1lc3NhZ2UgaW4KIGVpdGhlciBkaXJlY3Rpb24gaXMgYSBo
ZWFkZXIgZm9ybWF0dGVkIGFzIGEgc3RydWN0IHhzZF9zb2NrbXNnCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.14-oxenstored.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.14-oxenstored.patch"
Content-Transfer-Encoding: base64

RnJvbSAyZDZmZTQzOTM2YWIwMGJlZjlhODRiMGE2MGIxNTQ2NzMxNDMzOTIw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IEZpeCBxdW90YSBieXBhc3Mg
b24gZG9tYWluIHNodXRkb3duCk1JTUUtVmVyc2lvbjogMS4wCkNvbnRlbnQt
VHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250ZW50LVRyYW5z
ZmVyLUVuY29kaW5nOiA4Yml0CgpYU0EtMzIyIGZpeGVkIGEgZG9taWQgcmV1
c2UgdnVsbmVyYWJpbGl0eSBieSBhc3NpZ25pbmcgRG9tMCBhcyB0aGUgb3du
ZXIgb2YKYW55IG5vZGVzIGxlZnQgYWZ0ZXIgYSBkb21haW4gaXMgc2h1dGRv
d24gKGUuZy4gb3V0c2lkZSBpdHMgL2xvY2FsL2RvbWFpbi9OCnRyZWUpLgoK
SG93ZXZlciBEb20wIGhhcyBubyBxdW90YSBvbiBwdXJwb3NlLCBzbyB0aGlz
IG9wZW5lZCB1cCBhbm90aGVyIHBvdGVudGlhbAphdHRhY2sgdmVjdG9yLiBB
dm9pZCBpdCBieSBkZWxldGluZyB0aGVzZSBub2RlcyBpbnN0ZWFkIG9mIGFz
c2lnbmluZyB0aGVtIHRvCkRvbTAuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIzLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IGM0NmVmZjkyMTIwOSAoInRv
b2xzL29jYW1sL3hlbnN0b3JlZDogY2xlYW4gdXAgcGVybWlzc2lvbnMgZm9y
IGRlYWQgZG9tYWlucyIpClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLDtmsg
PGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3RpYW4g
TGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZmIC0t
Z2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sIGIvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sCmluZGV4IGU4YTE2MjIxZjhmYS4u
ODRmMjUwM2U4ZTI5IDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9y
ZWQvcGVybXMubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1z
Lm1sCkBAIC02NCw4ICs2NCw3IEBAIGxldCBnZXRfb3duZXIgcGVybSA9IHBl
cm0ub3duZXIKICogKikKIGxldCByZW1vdmVfZG9taWQgfmRvbWlkIHBlcm0g
PQogCWxldCBhY2wgPSBMaXN0LmZpbHRlciAoZnVuIChhY2xfZG9taWQsIF8p
IC0+IGFjbF9kb21pZCA8PiBkb21pZCkgcGVybS5hY2wgaW4KLQlsZXQgb3du
ZXIgPSBpZiBwZXJtLm93bmVyID0gZG9taWQgdGhlbiAwIGVsc2UgcGVybS5v
d25lciBpbgotCXsgcGVybSB3aXRoIGFjbDsgb3duZXIgfQorCWlmIHBlcm0u
b3duZXIgPSBkb21pZCB0aGVuIE5vbmUgZWxzZSBTb21lIHsgcGVybSB3aXRo
IGFjbDsgb3duZXIgPSBwZXJtLm93bmVyIH0KIAogbGV0IGRlZmF1bHQwID0g
Y3JlYXRlIDAgTk9ORSBbXQogCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94
ZW5zdG9yZWQvc3RvcmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvc3Rv
cmUubWwKaW5kZXggMzI4ZDNhNTE5ODRmLi5kODI3NjRmNjBmYjQgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9zdG9yZS5tbAorKysgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQvc3RvcmUubWwKQEAgLTg5LDEwICs4OSwy
MSBAQCBsZXQgY2hlY2tfb3duZXIgbm9kZSBjb25uZWN0aW9uID0KIAogbGV0
IHJlYyByZWN1cnNlIGZjdCBub2RlID0gZmN0IG5vZGU7IExpc3QuaXRlciAo
cmVjdXJzZSBmY3QpIG5vZGUuY2hpbGRyZW4KIAotKCoqIFtyZWN1cnNlX21h
cCBmIHRyZWVdIGFwcGxpZXMgW2ZdIG9uIGVhY2ggbm9kZSBpbiB0aGUgdHJl
ZSByZWN1cnNpdmVseSAqKQotbGV0IHJlY3Vyc2VfbWFwIGYgPQorKCoqIFty
ZWN1cnNlX2ZpbHRlcl9tYXAgZiB0cmVlXSBhcHBsaWVzIFtmXSBvbiBlYWNo
IG5vZGUgaW4gdGhlIHRyZWUgcmVjdXJzaXZlbHksCisgICAgcG9zc2libHkg
cmVtb3Zpbmcgc29tZSBub2Rlcy4KKyAgICBOb3RlIHRoYXQgdGhlIG5vZGVz
IHJlbW92ZWQgdGhpcyB3YXkgd29uJ3QgZ2VuZXJhdGUgd2F0Y2ggZXZlbnRz
LgorKikKK2xldCByZWN1cnNlX2ZpbHRlcl9tYXAgZiA9CisJbGV0IGludmFs
aWQgPSAtMSBpbgorCWxldCBpc192YWxpZCBub2RlID0gbm9kZS5wZXJtcy5v
d25lciA8PiBpbnZhbGlkIGluCiAJbGV0IHJlYyB3YWxrIG5vZGUgPQotCQlm
IHsgbm9kZSB3aXRoIGNoaWxkcmVuID0gTGlzdC5yZXZfbWFwIHdhbGsgbm9k
ZS5jaGlsZHJlbiB8PiBMaXN0LnJldiB9CisJCSgqIE1hcC5maWx0ZXJfbWFw
IGlzIE9jYW1sIDQuMTErIG9ubHkgKikKKwkJbGV0IG5vZGUgPQorCQl7IG5v
ZGUgd2l0aCBjaGlsZHJlbiA9CisJCQlMaXN0LnJldl9tYXAgd2FsayBub2Rl
LmNoaWxkcmVuIHw+IExpc3QuZmlsdGVyIGlzX3ZhbGlkIHw+IExpc3QucmV2
IH0gaW4KKwkJbWF0Y2ggZiBub2RlIHdpdGgKKwkJfCBTb21lIGtlZXAgLT4g
a2VlcAorCQl8IE5vbmUgLT4geyBub2RlIHdpdGggcGVybXMgPSB7bm9kZS5w
ZXJtcyB3aXRoIG93bmVyID0gaW52YWxpZCB9IH0KIAlpbgogCXdhbGsKIApA
QCAtNDQ2LDExICs0NTcsMTMgQEAgbGV0IHNldHBlcm1zIHN0b3JlIHBlcm0g
cGF0aCBucGVybXMgPQogCiBsZXQgcmVzZXRfcGVybWlzc2lvbnMgc3RvcmUg
ZG9taWQgPQogCUxvZ2dpbmcuaW5mbyAic3RvcmV8bm9kZSIgIkNsZWFuaW5n
IHVwIHhlbnN0b3JlIEFDTHMgZm9yIGRvbWlkICVkIiBkb21pZDsKLQlzdG9y
ZS5yb290IDwtIE5vZGUucmVjdXJzZV9tYXAgKGZ1biBub2RlIC0+Ci0JCWxl
dCBwZXJtcyA9IFBlcm1zLk5vZGUucmVtb3ZlX2RvbWlkIH5kb21pZCBub2Rl
LnBlcm1zIGluCi0JCWlmIHBlcm1zIDw+IG5vZGUucGVybXMgdGhlbgotCQkJ
TG9nZ2luZy5kZWJ1ZyAic3RvcmV8bm9kZSIgIkNoYW5nZWQgcGVybWlzc2lv
bnMgZm9yIG5vZGUgJXMiIChOb2RlLmdldF9uYW1lIG5vZGUpOwotCQl7IG5v
ZGUgd2l0aCBwZXJtcyB9CisJc3RvcmUucm9vdCA8LSBOb2RlLnJlY3Vyc2Vf
ZmlsdGVyX21hcCAoZnVuIG5vZGUgLT4KKwkJbWF0Y2ggUGVybXMuTm9kZS5y
ZW1vdmVfZG9taWQgfmRvbWlkIG5vZGUucGVybXMgd2l0aAorCQl8IE5vbmUg
LT4gTm9uZQorCQl8IFNvbWUgcGVybXMgLT4KKwkJCWlmIHBlcm1zIDw+IG5v
ZGUucGVybXMgdGhlbgorCQkJCUxvZ2dpbmcuZGVidWcgInN0b3JlfG5vZGUi
ICJDaGFuZ2VkIHBlcm1pc3Npb25zIGZvciBub2RlICVzIiAoTm9kZS5nZXRf
bmFtZSBub2RlKTsKKwkJCVNvbWUgeyBub2RlIHdpdGggcGVybXMgfQogCSkg
c3RvcmUucm9vdAogCiB0eXBlIG9wcyA9IHsK

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.14-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.14-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSA1NGY3Nzc3MmU4YWZjYzE1ZTNhMzg0MjE2NjQxZWFiYmU5YTA4ZGE4
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTIgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlbW92ZSBu
b2RlcyBvd25lZCBieSBkZXN0cm95ZWQgZG9tYWluCgpJbiBjYXNlIGEgZG9t
YWluIGlzIHJlbW92ZWQgZnJvbSBYZW5zdG9yZSwgcmVtb3ZlIGFsbCBub2Rl
cyBvd25lZCBieQppdCBwZXIgZGVmYXVsdC4KClRoaXMgdGFja2xlcyB0aGUg
cHJvYmxlbSB0aGF0IG5vZGVzIG1pZ2h0IGJlIGNyZWF0ZWQgYnkgYSBkb21h
aW4Kb3V0c2lkZSBpdHMgaG9tZSBwYXRoIGluIFhlbnN0b3JlLCBsZWFkaW5n
IHRvIFhlbnN0b3JlIGhvZ2dpbmcgbW9yZQphbmQgbW9yZSBtZW1vcnkuIERv
bWFpbiBxdW90YSBkb24ndCB3b3JrIGluIHRoaXMgY2FzZSBpZiB0aGUgZ3Vl
c3QgaXMKcmVib290aW5nIGluIGJldHdlZW4uCgpTaW5jZSBYU0EtMzIyIG93
bmVyc2hpcCBvZiBzdWNoIHN0YWxlIG5vZGVzIGlzIHRyYW5zZmVycmVkIHRv
IGRvbTAsCndoaWNoIGlzIGhlbHBpbmcgYWdhaW5zdCB1bmludGVuZGVkIGFj
Y2VzcywgYnV0IG5vdCBhZ2FpbnN0IE9PTSBvZgpYZW5zdG9yZS4KCkFzIGEg
ZmFsbGJhY2sgZm9yIHdlaXJkIGNhc2VzIGFkZCBhIFhlbnN0b3JlIHN0YXJ0
IHBhcmFtZXRlciBmb3IKa2VlcGluZyB0b2RheSdzIHdheSB0byBoYW5kbGUg
c3RhbGUgbm9kZXMsIGFkZGluZyB0aGUgcmlzayBvZiBYZW5zdG9yZQpoaXR0
aW5nIGFuIE9PTSBzaXR1YXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIyLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IDQ5NjMwNjMyNGQ4ZCAoInRv
b2xzL3hlbnN0b3JlOiByZXZva2UgYWNjZXNzIHJpZ2h0cyBmb3IgcmVtb3Zl
ZCBkb21haW5zIikKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdy
b3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3Jh
bGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwppbmRleCA1YmI3Yjg1MjEzMjQuLmViMWQ3YzJiM2I5YiAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC03OSw2ICs3OSw3
IEBAIHN0YXRpYyBib29sIHZlcmJvc2UgPSBmYWxzZTsKIExJU1RfSEVBRChj
b25uZWN0aW9ucyk7CiBpbnQgdHJhY2VmZCA9IC0xOwogc3RhdGljIGJvb2wg
cmVjb3ZlcnkgPSB0cnVlOworYm9vbCBrZWVwX29ycGhhbnMgPSBmYWxzZTsK
IHN0YXRpYyBpbnQgcmVvcGVuX2xvZ19waXBlWzJdOwogc3RhdGljIGludCBy
ZW9wZW5fbG9nX3BpcGUwX3BvbGxmZF9pZHggPSAtMTsKIGNoYXIgKnRyYWNl
ZmlsZSA9IE5VTEw7CkBAIC02NjQsNyArNjY1LDcgQEAgc3RydWN0IG5vZGUg
KnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LAogCW5vZGUtPnBlcm1zLnAgPSBoZHItPnBlcm1zOwogCW5vZGUt
PmFjYy5kb21pZCA9IG5vZGUtPnBlcm1zLnBbMF0uaWQ7CiAJbm9kZS0+YWNj
Lm1lbW9yeSA9IGRhdGEuZHNpemU7Ci0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhjb25uLCBub2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKG5vZGUpKQogCQlnb3RvIGVycm9yOwogCiAJLyogSWYgb3duZXIg
aXMgZ29uZSByZXNldCBjdXJyZW50bHkgYWNjb3VudGVkIG1lbW9yeSBzaXpl
LiAqLwpAQCAtNzA3LDcgKzcwOCw3IEBAIGludCB3cml0ZV9ub2RlX3Jhdyhz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwgc3RydWN0
IG5vZGUgKm5vZGUsCiAJdm9pZCAqcDsKIAlzdHJ1Y3QgeHNfdGRiX3JlY29y
ZF9oZHIgKmhkcjsKIAotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMo
Y29ubiwgbm9kZSkpCisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKIAkJcmV0dXJuIGVycm5vOwogCiAJZGF0YS5kc2l6ZSA9IHNpemVv
ZigqaGRyKQpAQCAtMTU0OCw3ICsxNTQ5LDcgQEAgc3RhdGljIGludCBkZWxu
b2RlX3N1Yihjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLAogCXJldHVybiBXQUxLX1RSRUVfUk1fQ0hJTERFTlRSWTsKIH0KIAot
c3RhdGljIGludCBfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0
IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSkKK2ludCBybV9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0
IGNoYXIgKm5hbWUpCiB7CiAJc3RydWN0IG5vZGUgKnBhcmVudDsKIAljaGFy
ICpwYXJlbnRuYW1lID0gZ2V0X3BhcmVudChjdHgsIG5hbWUpOwpAQCAtMTYx
MCw3ICsxNjExLDcgQEAgc3RhdGljIGludCBkb19ybShjb25zdCB2b2lkICpj
dHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCWlmIChzdHJlcShuYW1l
LCAiLyIpKQogCQlyZXR1cm4gRUlOVkFMOwogCi0JcmV0ID0gX3JtKGNvbm4s
IGN0eCwgbmFtZSk7CisJcmV0ID0gcm1fbm9kZShjb25uLCBjdHgsIG5hbWUp
OwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTI0NDYsNiArMjQ0
Nyw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtUiwgLS1uby1y
ZWNvdmVyeSAgICAgICB0byByZXF1ZXN0IHRoYXQgbm8gcmVjb3Zlcnkgc2hv
dWxkIGJlIGF0dGVtcHRlZCB3aGVuXG4iCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGUgc3RvcmUgaXMgY29ycnVwdGVkIChkZWJ1ZyBvbmx5KSxc
biIKICIgIC1JLCAtLWludGVybmFsLWRiICAgICAgIHN0b3JlIGRhdGFiYXNl
IGluIG1lbW9yeSwgbm90IG9uIGRpc2tcbiIKKyIgIC1LLCAtLWtlZXAtb3Jw
aGFucyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFp
biB3aGVuIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9t
YWluIGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIK
ICIgIC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9z
ZSBleGVjdXRpb24uXG4iKTsKIH0KIApAQCAtMjQ2OSw2ICsyNDcyLDcgQEAg
c3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRpbWVv
dXQiLCAxLCBOVUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5V
TEwsICdSJyB9LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0s
CisJeyAia2VlcC1vcnBoYW5zIiwgMCwgTlVMTCwgJ0snIH0sCiAJeyAidmVy
Ym9zZSIsIDAsIE5VTEwsICdWJyB9LAogCXsgIndhdGNoLW5iIiwgMSwgTlVM
TCwgJ1cnIH0sCiAJeyBOVUxMLCAwLCBOVUxMLCAwIH0gfTsKQEAgLTI1NDMs
NyArMjU0Nyw3IEBAIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10p
CiAJaW50IHRpbWVvdXQ7CiAKIAotCXdoaWxlICgob3B0ID0gZ2V0b3B0X2xv
bmcoYXJnYywgYXJndiwgIkRFOkY6SE5QUzp0OkE6UTpxOlQ6UlZXOnc6Iiwg
b3B0aW9ucywKKwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFy
Z3YsICJERTpGOkhLTlBTOnQ6QTpROnE6VDpSVlc6dzoiLCBvcHRpb25zLAog
CQkJCSAgTlVMTCkpICE9IC0xKSB7CiAJCXN3aXRjaCAob3B0KSB7CiAJCWNh
c2UgJ0QnOgpAQCAtMjU3OSw2ICsyNTgzLDkgQEAgaW50IG1haW4oaW50IGFy
Z2MsIGNoYXIgKmFyZ3ZbXSkKIAkJY2FzZSAnSSc6CiAJCQl0ZGJfZmxhZ3Mg
PSBUREJfSU5URVJOQUx8VERCX05PTE9DSzsKIAkJCWJyZWFrOworCQljYXNl
ICdLJzoKKwkJCWtlZXBfb3JwaGFucyA9IHRydWU7CisJCQlicmVhazsKIAkJ
Y2FzZSAnVic6CiAJCQl2ZXJib3NlID0gdHJ1ZTsKIAkJCWJyZWFrOwpkaWZm
IC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaCBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKaW5kZXggZmM5ODgyYWMz
N2Q1Li5lYzI0YzI3YWMyNDAgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3Jl
L3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3Rv
cmVkX2NvcmUuaApAQCAtMjA0LDYgKzIwNCw5IEBAIGludCB3cml0ZV9ub2Rl
X3JhdyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwg
c3RydWN0IG5vZGUgKm5vZGUsCiBzdHJ1Y3Qgbm9kZSAqcmVhZF9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsCiAJCSAg
ICAgICBjb25zdCBjaGFyICpuYW1lKTsKIAorLyogUmVtb3ZlIGEgbm9kZSBh
bmQgaXRzIGNoaWxkcmVuLiAqLworaW50IHJtX25vZGUoc3RydWN0IGNvbm5l
Y3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFt
ZSk7CisKIHZvaWQgc2V0dXBfc3RydWN0dXJlKHZvaWQpOwogc3RydWN0IGNv
bm5lY3Rpb24gKm5ld19jb25uZWN0aW9uKGNvbm53cml0ZWZuX3QgKndyaXRl
LCBjb25ucmVhZGZuX3QgKnJlYWQpOwogdm9pZCBjaGVja19zdG9yZSh2b2lk
KTsKQEAgLTI0Miw2ICsyNDUsNyBAQCBleHRlcm4gaW50IHF1b3RhX3JlcV9v
dXRzdGFuZGluZzsKIGV4dGVybiBpbnQgcXVvdGFfdHJhbnNfbm9kZXM7CiBl
eHRlcm4gaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX3NvZnQ7CiBleHRl
cm4gaW50IHF1b3RhX21lbW9yeV9wZXJfZG9tYWluX2hhcmQ7CitleHRlcm4g
Ym9vbCBrZWVwX29ycGhhbnM7CiAKIGV4dGVybiB1bnNpZ25lZCBpbnQgdGlt
ZW91dF93YXRjaF9ldmVudF9tc2VjOwogCmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMgYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmMKaW5kZXggMWMyOWY2ODU0MTE5Li45ZTYzZWMy
M2E5MjIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9k
b21haW4uYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWlu
LmMKQEAgLTIwMCwxMCArMjAwLDY1IEBAIHN0YXRpYyB2b2lkIHVubWFwX2lu
dGVyZmFjZSh2b2lkICppbnRlcmZhY2UpCiAJeGVuZ250dGFiX3VubWFwKCp4
Z3RfaGFuZGxlLCBpbnRlcmZhY2UsIDEpOwogfQogCitzdGF0aWMgaW50IGRv
bWFpbl90cmVlX3JlbW92ZV9zdWIoY29uc3Qgdm9pZCAqY3R4LCBzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwKKwkJCQkgIHN0cnVjdCBub2RlICpub2RlLCB2
b2lkICphcmcpCit7CisJc3RydWN0IGRvbWFpbiAqZG9tYWluID0gYXJnOwor
CVREQl9EQVRBIGtleTsKKwlpbnQgcmV0ID0gV0FMS19UUkVFX09LOworCisJ
aWYgKG5vZGUtPnBlcm1zLnBbMF0uaWQgIT0gZG9tYWluLT5kb21pZCkKKwkJ
cmV0dXJuIFdBTEtfVFJFRV9PSzsKKworCWlmIChrZWVwX29ycGhhbnMpIHsK
KwkJa2V5LmRwdHIgPSAoY2hhciAqKW5vZGUtPm5hbWU7CisJCWtleS5kc2l6
ZSA9IHN0cmxlbihub2RlLT5uYW1lKTsKKwkJZG9tYWluLT5uYmVudHJ5LS07
CisJCW5vZGUtPnBlcm1zLnBbMF0uaWQgPSBwcml2X2RvbWlkOworCQlub2Rl
LT5hY2MubWVtb3J5ID0gMDsKKwkJZG9tYWluX2VudHJ5X2luYyhOVUxMLCBu
b2RlKTsKKwkJaWYgKHdyaXRlX25vZGVfcmF3KE5VTEwsICZrZXksIG5vZGUs
IHRydWUpKSB7CisJCQkvKiBUaGF0J3MgdW5mb3J0dW5hdGUuIFdlIG9ubHkg
Y2FuIHRyeSB0byBjb250aW51ZS4gKi8KKwkJCXN5c2xvZyhMT0dfRVJSLAor
CQkJICAgICAgICJlcnJvciB3aGVuIG1vdmluZyBvcnBoYW5lZCBub2RlICVz
IHRvIGRvbTBcbiIsCisJCQkgICAgICAgbm9kZS0+bmFtZSk7CisJCX0gZWxz
ZQorCQkJdHJhY2UoIm9ycGhhbmVkIG5vZGUgJXMgbW92ZWQgdG8gZG9tMFxu
Iiwgbm9kZS0+bmFtZSk7CisJfSBlbHNlIHsKKwkJaWYgKHJtX25vZGUoTlVM
TCwgY3R4LCBub2RlLT5uYW1lKSkgeworCQkJLyogVGhhdCdzIHVuZm9ydHVu
YXRlLiBXZSBvbmx5IGNhbiB0cnkgdG8gY29udGludWUuICovCisJCQlzeXNs
b2coTE9HX0VSUiwKKwkJCSAgICAgICAiZXJyb3Igd2hlbiBkZWxldGluZyBv
cnBoYW5lZCBub2RlICVzXG4iLAorCQkJICAgICAgIG5vZGUtPm5hbWUpOwor
CQl9IGVsc2UKKwkJCXRyYWNlKCJvcnBoYW5lZCBub2RlICVzIGRlbGV0ZWRc
biIsIG5vZGUtPm5hbWUpOworCisJCS8qIFNraXAgY2hpbGRyZW4gaW4gYWxs
IGNhc2VzIGluIG9yZGVyIHRvIGF2b2lkIG1vcmUgZXJyb3JzLiAqLworCQly
ZXQgPSBXQUxLX1RSRUVfU0tJUF9DSElMRFJFTjsKKwl9CisKKwlyZXR1cm4g
ZG9tYWluLT5uYmVudHJ5ID4gMCA/IHJldCA6IFdBTEtfVFJFRV9TVUNDRVNT
X1NUT1A7Cit9CisKK3N0YXRpYyB2b2lkIGRvbWFpbl90cmVlX3JlbW92ZShz
dHJ1Y3QgZG9tYWluICpkb21haW4pCit7CisJaW50IHJldDsKKwlzdHJ1Y3Qg
d2Fsa19mdW5jcyB3YWxrZnVuY3MgPSB7IC5lbnRlciA9IGRvbWFpbl90cmVl
X3JlbW92ZV9zdWIgfTsKKworCWlmIChkb21haW4tPm5iZW50cnkgPiAwKSB7
CisJCXJldCA9IHdhbGtfbm9kZV90cmVlKGRvbWFpbiwgTlVMTCwgIi8iLCAm
d2Fsa2Z1bmNzLCBkb21haW4pOworCQlpZiAocmV0ID09IFdBTEtfVFJFRV9F
UlJPUl9TVE9QKQorCQkJc3lzbG9nKExPR19FUlIsCisJCQkgICAgICAgImVy
cm9yIHdoZW4gbG9va2luZyBmb3Igb3JwaGFuZWQgbm9kZXNcbiIpOworCX0K
K30KKwogc3RhdGljIGludCBkZXN0cm95X2RvbWFpbih2b2lkICpfZG9tYWlu
KQogewogCXN0cnVjdCBkb21haW4gKmRvbWFpbiA9IF9kb21haW47CiAKKwlk
b21haW5fdHJlZV9yZW1vdmUoZG9tYWluKTsKKwogCWxpc3RfZGVsKCZkb21h
aW4tPmxpc3QpOwogCiAJaWYgKCFkb21haW4tPmludHJvZHVjZWQpCkBAIC04
MzgsMTUgKzg5MywxNSBAQCBpbnQgZG9tYWluX2VudHJ5X2luYyhzdHJ1Y3Qg
Y29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiAJc3RydWN0
IGRvbWFpbiAqZDsKIAl1bnNpZ25lZCBpbnQgZG9taWQ7CiAKLQlpZiAoIWNv
bm4pCisJaWYgKCFub2RlLT5wZXJtcy5wKQogCQlyZXR1cm4gMDsKIAotCWRv
bWlkID0gbm9kZS0+cGVybXMucCA/IG5vZGUtPnBlcm1zLnBbMF0uaWQgOiBj
b25uLT5pZDsKKwlkb21pZCA9IG5vZGUtPnBlcm1zLnBbMF0uaWQ7CiAKLQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKKwlpZiAoY29ubiAmJiBjb25uLT50
cmFuc2FjdGlvbikgewogCQl0cmFuc2FjdGlvbl9lbnRyeV9pbmMoY29ubi0+
dHJhbnNhY3Rpb24sIGRvbWlkKTsKIAl9IGVsc2UgewotCQlkID0gKGRvbWlk
ID09IGNvbm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4K
KwkJZCA9IChjb25uICYmIGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KIAkJICAgIDogZmluZF9vcl9hbGxvY19l
eGlzdGluZ19kb21haW4oZG9taWQpOwogCQlpZiAoZCkKIAkJCWQtPm5iZW50
cnkrKzsKQEAgLTkwNywyMyArOTYyLDExIEBAIGludCBkb21haW5fYWxsb2Nf
cGVybXJlZnMoc3RydWN0IG5vZGVfcGVybXMgKnBlcm1zKQogICogUmVtb3Zl
IHBlcm1pc3Npb25zIGZvciBubyBsb25nZXIgZXhpc3RpbmcgZG9tYWlucyBp
biBvcmRlciB0byBhdm9pZCBhIG5ldwogICogZG9tYWluIHdpdGggdGhlIHNh
bWUgZG9taWQgaW5oZXJpdGluZyB0aGUgcGVybWlzc2lvbnMuCiAgKi8KLWlu
dCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQoraW50IGRvbWFpbl9hZGp1c3Rf
bm9kZV9wZXJtcyhzdHJ1Y3Qgbm9kZSAqbm9kZSkKIHsKIAl1bnNpZ25lZCBp
bnQgaTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gY2hrX2RvbWFpbl9nZW5lcmF0
aW9uKG5vZGUtPnBlcm1zLnBbMF0uaWQsIG5vZGUtPmdlbmVyYXRpb24pOwot
Ci0JLyogSWYgdGhlIG93bmVyIGRvZXNuJ3QgZXhpc3QgYW55IGxvbmdlciBn
aXZlIGl0IHRvIHByaXYgZG9tYWluLiAqLwotCWlmICghcmV0KSB7Ci0JCS8q
Ci0JCSAqIEluIHRoZW9yeSB3ZSdkIG5lZWQgdG8gdXBkYXRlIHRoZSBudW1i
ZXIgb2YgZG9tMCBub2RlcyBoZXJlLAotCQkgKiBidXQgd2UgY291bGQgYmUg
Y2FsbGVkIGZvciBhIHJlYWQgb2YgdGhlIG5vZGUuIFNvIGJldHRlcgotCQkg
KiBhdm9pZCB0aGUgcmlzayB0byBvdmVyZmxvdyB0aGUgbm9kZSBjb3VudCBv
ZiBkb20wLgotCQkgKi8KLQkJbm9kZS0+cGVybXMucFswXS5pZCA9IHByaXZf
ZG9taWQ7Ci0JfQotCiAJZm9yIChpID0gMTsgaSA8IG5vZGUtPnBlcm1zLm51
bTsgaSsrKSB7CiAJCWlmIChub2RlLT5wZXJtcy5wW2ldLnBlcm1zICYgWFNf
UEVSTV9JR05PUkUpCiAJCQljb250aW51ZTsKQEAgLTk0MSwxNSArOTg0LDE1
IEBAIHZvaWQgZG9tYWluX2VudHJ5X2RlYyhzdHJ1Y3QgY29ubmVjdGlvbiAq
Y29ubiwgc3RydWN0IG5vZGUgKm5vZGUpCiAJc3RydWN0IGRvbWFpbiAqZDsK
IAl1bnNpZ25lZCBpbnQgZG9taWQ7CiAKLQlpZiAoIWNvbm4pCisJaWYgKCFu
b2RlLT5wZXJtcy5wKQogCQlyZXR1cm47CiAKIAlkb21pZCA9IG5vZGUtPnBl
cm1zLnAgPyBub2RlLT5wZXJtcy5wWzBdLmlkIDogY29ubi0+aWQ7CiAKLQlp
ZiAoY29ubi0+dHJhbnNhY3Rpb24pIHsKKwlpZiAoY29ubiAmJiBjb25uLT50
cmFuc2FjdGlvbikgewogCQl0cmFuc2FjdGlvbl9lbnRyeV9kZWMoY29ubi0+
dHJhbnNhY3Rpb24sIGRvbWlkKTsKIAl9IGVsc2UgewotCQlkID0gKGRvbWlk
ID09IGNvbm4tPmlkICYmIGNvbm4tPmRvbWFpbikgPyBjb25uLT5kb21haW4K
KwkJZCA9IChjb25uICYmIGRvbWlkID09IGNvbm4tPmlkICYmIGNvbm4tPmRv
bWFpbikgPyBjb25uLT5kb21haW4KIAkJICAgIDogZmluZF9kb21haW5fc3Ry
dWN0KGRvbWlkKTsKIAkJaWYgKGQpIHsKIAkJCWQtPm5iZW50cnktLTsKQEAg
LTEwNjgsNyArMTExMSw3IEBAIGludCBkb21haW5fbWVtb3J5X2FkZCh1bnNp
Z25lZCBpbnQgZG9taWQsIGludCBtZW0sIGJvb2wgbm9fcXVvdGFfY2hlY2sp
CiAJCSAqIGV4aXN0LCBhcyBhY2NvdW50aW5nIGlzIGRvbmUgZWl0aGVyIGZv
ciBhIGRvbWFpbiByZWxhdGVkIHRvCiAJCSAqIHRoZSBjdXJyZW50IGNvbm5l
Y3Rpb24sIG9yIGZvciB0aGUgZG9tYWluIG93bmluZyBhIG5vZGUKIAkJICog
KHdoaWNoIGlzIGFsd2F5cyBleGlzdGluZywgYXMgdGhlIG93bmVyIG9mIHRo
ZSBub2RlIGlzCi0JCSAqIHRlc3RlZCB0byBleGlzdCBhbmQgcmVwbGFjZWQg
YnkgZG9taWQgMCBpZiBub3QpLgorCQkgKiB0ZXN0ZWQgdG8gZXhpc3QgYW5k
IGRlbGV0ZWQgb3IgcmVwbGFjZWQgYnkgZG9taWQgMCBpZiBub3QpLgogCQkg
KiBTbyBub3QgZmluZGluZyB0aGUgcmVsYXRlZCBkb21haW4gTVVTVCBiZSBh
biBlcnJvciBpbiB0aGUKIAkJICogZGF0YSBiYXNlLgogCQkgKi8KZGlmZiAt
LWdpdCBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaCBiL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uaAppbmRleCBiYWI0MDUy
MDllMmEuLjViZDI1MzM5NWQ3NyAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5oCisrKyBiL3Rvb2xzL3hlbnN0b3JlL3hl
bnN0b3JlZF9kb21haW4uaApAQCAtNjQsNyArNjQsNyBAQCBib29sIGRvbWFp
bl9jYW5fd3JpdGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogYm9vbCBk
b21haW5faXNfdW5wcml2aWxlZ2VkKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
KTsKIAogLyogUmVtb3ZlIG5vZGUgcGVybWlzc2lvbnMgZm9yIG5vIGxvbmdl
ciBleGlzdGluZyBkb21haW5zLiAqLwotaW50IGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUg
Km5vZGUpOworaW50IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qg
bm9kZSAqbm9kZSk7CiBpbnQgZG9tYWluX2FsbG9jX3Blcm1yZWZzKHN0cnVj
dCBub2RlX3Blcm1zICpwZXJtcyk7CiAKIC8qIFF1b3RhIG1hbmlwdWxhdGlv
biAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.14-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.14-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA0NmFlOTNmZGZkYWM3ZGMwODhhNWY3YjExYjdjYjI1YzQ4NzE3NzI3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1ha2UgdGhl
IGludGVybmFsIG1lbW9yeSBkYXRhIGJhc2UgdGhlIGRlZmF1bHQKCkhhdmlu
ZyBhIGZpbGUgYmFja2VkIGRhdGEgYmFzZSBoYXMgdGhlIG9ubHkgYWR2YW50
YWdlIG9mIGJlaW5nIGNhcGFibGUKdG8gZHVtcCB0aGUgY29udGVudHMgb2Yg
aXQgd2hpbGUgWGVuc3RvcmUgaXMgcnVubmluZywgYW5kIHBvdGVudGlhbGx5
CnVzaW5nIGxlc3Mgc3dhcCBzcGFjZSBpbiBjYXNlIHRoZSBkYXRhIGJhc2Ug
Y2FuJ3QgYmUga2VwdCBpbiBtZW1vcnkuCgpJdCBoYXMgdGhlIG1ham9yIGRp
c2FkdmFudGFnZSBvZiBhIGh1Z2UgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQ6IHN3
aXRjaGluZwp0byBrZWVwIHRoZSBkYXRhIGJhc2UgaW4gbWVtb3J5IG9ubHkg
c3BlZWRzIHVwIGxpdmUgdXBkYXRlIG9mIHhlbnN0b3JlZAp3aXRoIDEyMDAw
MCBub2RlcyBmcm9tIDIwIG1pbnV0ZXMgdG8gMTEgc2Vjb25kcy4gQSBjb21w
bGV0ZSB0cmVlIHdhbGsKb2YgdGhpcyBjb25maWd1cmF0aW9uIHdpbGwgYmUg
cmVkdWNlZCBmcm9tIDcgc2Vjb25kcyB0byAyODAgbXNlY3MKKG1lYXN1cmVk
IGJ5ICJ4ZW5zdG9yZS1jb250cm9sIGNoZWNrIikuCgpTbyBtYWtlIHRoZSBp
bnRlcm5hbCBtZW1vcnkgZGF0YSBiYXNlIHRoZSBkZWZhdWx0IGFuZCBlbmhh
bmNlIHRoZQoiLS1pbnRlcm5hbC1kYiIgY29tbWFuZCBsaW5lIHBhcmFtZXRl
ciB0byB0YWtlIGFuIG9wdGlvbmFsIHBhcmFtZXRlcgphbGxvd2luZyB0byBz
d2l0Y2ggdGhlIGludGVybmFsIGRhdGEgYmFzZSBiYWNrIHRvIHRoZSBmaWxl
IGJhc2VkIG9uZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtNDE5LgoKUmVwb3J0
ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KU2lnbmVk
LW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZp
ZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRp
ZmYgLS1naXQgYS90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWlu
LmMgYi90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKaW5k
ZXggNGNlODI5OWMzYzM2Li4yZGZjNzhkNGRlNTYgMTAwNjQ0Ci0tLSBhL3Rv
b2xzL2hlbHBlcnMvaW5pdC14ZW5zdG9yZS1kb21haW4uYworKysgYi90b29s
cy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKQEAgLTEzNyw5ICsx
MzcsOSBAQCBzdGF0aWMgaW50IGJ1aWxkKHhjX2ludGVyZmFjZSAqeGNoKQog
ICAgIH0KIAogICAgIGlmICggcGFyYW0gKQotICAgICAgICBzbnByaW50Zihj
bWRsaW5lLCA1MTIsICItLWV2ZW50ICVkIC0taW50ZXJuYWwtZGIgJXMiLCBy
diwgcGFyYW0pOworICAgICAgICBzbnByaW50ZihjbWRsaW5lLCA1MTIsICIt
LWV2ZW50ICVkICVzIiwgcnYsIHBhcmFtKTsKICAgICBlbHNlCi0gICAgICAg
IHNucHJpbnRmKGNtZGxpbmUsIDUxMiwgIi0tZXZlbnQgJWQgLS1pbnRlcm5h
bC1kYiIsIHJ2KTsKKyAgICAgICAgc25wcmludGYoY21kbGluZSwgNTEyLCAi
LS1ldmVudCAlZCIsIHJ2KTsKIAogICAgIGRvbSA9IHhjX2RvbV9hbGxvY2F0
ZSh4Y2gsIGNtZGxpbmUsIE5VTEwpOwogICAgIGlmICggIWRvbSApCmRpZmYg
LS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwppbmRleCBlYjFkN2MyYjNi
OWIuLjdlZDg1MmZkNzk1OCAxMDA2NDQKLS0tIGEvdG9vbHMveGVuc3RvcmUv
eGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5jCkBAIC0yMTM0LDcgKzIxMzQsNyBAQCBzdGF0aWMgdm9pZCBh
Y2NlcHRfY29ubmVjdGlvbihpbnQgc29jaywgYm9vbCBjYW53cml0ZSkKIH0K
ICNlbmRpZgogCi1zdGF0aWMgaW50IHRkYl9mbGFnczsKK3N0YXRpYyBpbnQg
dGRiX2ZsYWdzID0gVERCX0lOVEVSTkFMIHwgVERCX05PTE9DSzsKIAogLyog
V2UgY3JlYXRlIGluaXRpYWwgbm9kZXMgbWFudWFsbHkuICovCiBzdGF0aWMg
dm9pZCBtYW51YWxfbm9kZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFy
ICpjaGlsZCkKQEAgLTI0NDYsNyArMjQ0Niw4IEBAIHN0YXRpYyB2b2lkIHVz
YWdlKHZvaWQpCiAiICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaC1l
dmVudDogdGltZSBhIHdhdGNoLWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xuIgog
IiAgLVIsIC0tbm8tcmVjb3ZlcnkgICAgICAgdG8gcmVxdWVzdCB0aGF0IG5v
IHJlY292ZXJ5IHNob3VsZCBiZSBhdHRlbXB0ZWQgd2hlblxuIgogIiAgICAg
ICAgICAgICAgICAgICAgICAgICAgdGhlIHN0b3JlIGlzIGNvcnJ1cHRlZCAo
ZGVidWcgb25seSksXG4iCi0iICAtSSwgLS1pbnRlcm5hbC1kYiAgICAgICBz
dG9yZSBkYXRhYmFzZSBpbiBtZW1vcnksIG5vdCBvbiBkaXNrXG4iCisiICAt
SSwgLS1pbnRlcm5hbC1kYiBbb258b2ZmXSBzdG9yZSBkYXRhYmFzZSBpbiBt
ZW1vcnksIG5vdCBvbiBkaXNrLCBkZWZhdWx0IGlzXG4iCisiICAgICAgICAg
ICAgICAgICAgICAgICAgICBtZW1vcnksIHdpdGggXCItLWludGVybmFsLWRi
IG9mZlwiIGl0IGlzIG9uIGRpc2tcbiIKICIgIC1LLCAtLWtlZXAtb3JwaGFu
cyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFpbiB3
aGVuIHRoZVxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWlu
IGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIKICIg
IC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9zZSBl
eGVjdXRpb24uXG4iKTsKQEAgLTI0NzEsNyArMjQ3Miw3IEBAIHN0YXRpYyBz
dHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsKIAl7ICJxdW90YS1zb2Z0Iiwg
MSwgTlVMTCwgJ3EnIH0sCiAJeyAidGltZW91dCIsIDEsIE5VTEwsICd3JyB9
LAogCXsgIm5vLXJlY292ZXJ5IiwgMCwgTlVMTCwgJ1InIH0sCi0JeyAiaW50
ZXJuYWwtZGIiLCAwLCBOVUxMLCAnSScgfSwKKwl7ICJpbnRlcm5hbC1kYiIs
IDIsIE5VTEwsICdJJyB9LAogCXsgImtlZXAtb3JwaGFucyIsIDAsIE5VTEws
ICdLJyB9LAogCXsgInZlcmJvc2UiLCAwLCBOVUxMLCAnVicgfSwKIAl7ICJ3
YXRjaC1uYiIsIDEsIE5VTEwsICdXJyB9LApAQCAtMjU0Nyw3ICsyNTQ4LDgg
QEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlpbnQgdGlt
ZW91dDsKIAogCi0Jd2hpbGUgKChvcHQgPSBnZXRvcHRfbG9uZyhhcmdjLCBh
cmd2LCAiREU6RjpIS05QUzp0OkE6UTpxOlQ6UlZXOnc6Iiwgb3B0aW9ucywK
Kwl3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsCisJCQkJ
ICAiREU6RjpISTo6S05QUzp0OkE6UTpxOlQ6UlZXOnc6Iiwgb3B0aW9ucywK
IAkJCQkgIE5VTEwpKSAhPSAtMSkgewogCQlzd2l0Y2ggKG9wdCkgewogCQlj
YXNlICdEJzoKQEAgLTI1ODEsNyArMjU4Myw4IEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAJCQl0cmFjZWZpbGUgPSBvcHRhcmc7CiAJ
CQlicmVhazsKIAkJY2FzZSAnSSc6Ci0JCQl0ZGJfZmxhZ3MgPSBUREJfSU5U
RVJOQUx8VERCX05PTE9DSzsKKwkJCWlmIChvcHRhcmcgJiYgIXN0cmNtcChv
cHRhcmcsICJvZmYiKSkKKwkJCQl0ZGJfZmxhZ3MgPSAwOwogCQkJYnJlYWs7
CiAJCWNhc2UgJ0snOgogCQkJa2VlcF9vcnBoYW5zID0gdHJ1ZTsK

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.14-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.14-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBiZThhY2E0YjQ2YmRkYzY2ZTg1OTZiNmRkOTIwYzIzZDUzMzllMmYw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogZG9jczogZW5oYW5jZSB4ZW5zdG9yZS50
eHQgd2l0aCBwZXJtaXNzaW9ucyBkZXNjcmlwdGlvbgpNSU1FLVZlcnNpb246
IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRGLTgK
Q29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKVGhlIHBlcm1pc3Np
b24gc2NoZW1lIG9mIFhlbnN0b3JlIG5vZGVzIGlzIG5vdCByZWFsbHkgY292
ZXJlZCBieQpkb2NzL21pc2MveGVuc3RvcmUudHh0LCBvdGhlciB0aGFuIHJl
ZmVycmluZyB0byB0aGUgWGVuIHdpa2kuCgpBZGQgYSBwYXJhZ3JhcGggZXhw
bGFpbmluZyB0aGUgcGVybWlzc2lvbnMgb2Ygbm9kZXMsIGFuZCBlc3BlY2lh
bGx5Cm1lbnRpb25pbmcgcmVtb3ZhbCBvZiBub2RlcyB3aGVuIGEgZG9tYWlu
IGhhcyBiZWVuIHJlbW92ZWQgZnJvbQpYZW5zdG9yZS4KClRoaXMgaXMgcGFy
dCBvZiBYU0EtNDE5LgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8
amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogRWR3aW4gVMO2csO2ayA8
ZWR2aW4udG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNj
L3hlbnN0b3JlLnR4dCBiL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQKaW5kZXgg
MWY0MmEzNzdjMTBmLi42YWEwN2M1ZWQ4MGIgMTAwNjQ0Ci0tLSBhL2RvY3Mv
bWlzYy94ZW5zdG9yZS50eHQKKysrIGIvZG9jcy9taXNjL3hlbnN0b3JlLnR4
dApAQCAtNDMsNiArNDMsMTcgQEAgYnl0ZXMgYXJlIGZvcmJpZGRlbjsgY2xp
ZW50cyBzcGVjaWZ5aW5nIHJlbGF0aXZlIHBhdGhzIHNob3VsZCBrZWVwCiB0
aGVtIHRvIHdpdGhpbiAyMDQ4IGJ5dGVzLiAgKFNlZSBYRU5TVE9SRV8qX1BB
VEhfTUFYIGluIHhzX3dpcmUuaC4pCiAKIAorRWFjaCBub2RlIGhhcyBvbmUg
b3IgbXVsdGlwbGUgcGVybWlzc2lvbiBlbnRyaWVzLiAgUGVybWlzc2lvbnMg
YXJlCitncmFudGVkIGJ5IGRvbWFpbi1pZCwgdGhlIGZpcnN0IHBlcm1pc3Np
b24gZW50cnkgb2YgZWFjaCBub2RlIHNwZWNpZmllcwordGhlIG93bmVyIG9m
IHRoZSBub2RlLiAgUGVybWlzc2lvbnMgb2YgYSBub2RlIGNhbiBiZSBjaGFu
Z2VkIGJ5IHRoZQorb3duZXIgb2YgdGhlIG5vZGUsIHRoZSBvd25lciBjYW4g
b25seSBiZSBtb2RpZmllZCBieSB0aGUgY29udHJvbAorZG9tYWluICh1c3Vh
bGx5IGRvbWFpbiBpZCAwKS4gIFRoZSBvd25lciBhbHdheXMgaGFzIHRoZSBy
aWdodCB0byByZWFkCithbmQgd3JpdGUgdGhlIG5vZGUsIHdoaWxlIG90aGVy
IHBlcm1pc3Npb25zIGNhbiBiZSBzZXR1cCB0byBhbGxvdworcmVhZCBhbmQv
b3Igd3JpdGUgYWNjZXNzLiAgV2hlbiBhIGRvbWFpbiBpcyBiZWluZyByZW1v
dmVkIGZyb20gWGVuc3RvcmUKK25vZGVzIG93bmVkIGJ5IHRoYXQgZG9tYWlu
IHdpbGwgYmUgcmVtb3ZlZCB0b2dldGhlciB3aXRoIGFsbCBvZiB0aG9zZQor
bm9kZXMnIGNoaWxkcmVuLgorCisKIENvbW11bmljYXRpb24gd2l0aCB4ZW5z
dG9yZSBpcyB2aWEgZWl0aGVyIHNvY2tldHMsIG9yIGV2ZW50IGNoYW5uZWwK
IGFuZCBzaGFyZWQgbWVtb3J5LCBhcyBzcGVjaWZpZWQgaW4gaW8veHNfd2ly
ZS5oOiBlYWNoIG1lc3NhZ2UgaW4KIGVpdGhlciBkaXJlY3Rpb24gaXMgYSBo
ZWFkZXIgZm9ybWF0dGVkIGFzIGEgc3RydWN0IHhzZF9zb2NrbXNnCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.15-oxenstored.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.15-oxenstored.patch"
Content-Transfer-Encoding: base64

RnJvbSAwNGQwNDU0NWNhMWIyODE1OTZlMWUxM2IzOTExM2Y2YTM3MjU5YWIx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IEZpeCBxdW90YSBieXBhc3Mg
b24gZG9tYWluIHNodXRkb3duCk1JTUUtVmVyc2lvbjogMS4wCkNvbnRlbnQt
VHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250ZW50LVRyYW5z
ZmVyLUVuY29kaW5nOiA4Yml0CgpYU0EtMzIyIGZpeGVkIGEgZG9taWQgcmV1
c2UgdnVsbmVyYWJpbGl0eSBieSBhc3NpZ25pbmcgRG9tMCBhcyB0aGUgb3du
ZXIgb2YKYW55IG5vZGVzIGxlZnQgYWZ0ZXIgYSBkb21haW4gaXMgc2h1dGRv
d24gKGUuZy4gb3V0c2lkZSBpdHMgL2xvY2FsL2RvbWFpbi9OCnRyZWUpLgoK
SG93ZXZlciBEb20wIGhhcyBubyBxdW90YSBvbiBwdXJwb3NlLCBzbyB0aGlz
IG9wZW5lZCB1cCBhbm90aGVyIHBvdGVudGlhbAphdHRhY2sgdmVjdG9yLiBB
dm9pZCBpdCBieSBkZWxldGluZyB0aGVzZSBub2RlcyBpbnN0ZWFkIG9mIGFz
c2lnbmluZyB0aGVtIHRvCkRvbTAuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIzLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IGM0NmVmZjkyMTIwOSAoInRv
b2xzL29jYW1sL3hlbnN0b3JlZDogY2xlYW4gdXAgcGVybWlzc2lvbnMgZm9y
IGRlYWQgZG9tYWlucyIpClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLDtmsg
PGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3RpYW4g
TGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZmIC0t
Z2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sIGIvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sCmluZGV4IGU4YTE2MjIxZjhmYS4u
ODRmMjUwM2U4ZTI5IDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9y
ZWQvcGVybXMubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1z
Lm1sCkBAIC02NCw4ICs2NCw3IEBAIGxldCBnZXRfb3duZXIgcGVybSA9IHBl
cm0ub3duZXIKICogKikKIGxldCByZW1vdmVfZG9taWQgfmRvbWlkIHBlcm0g
PQogCWxldCBhY2wgPSBMaXN0LmZpbHRlciAoZnVuIChhY2xfZG9taWQsIF8p
IC0+IGFjbF9kb21pZCA8PiBkb21pZCkgcGVybS5hY2wgaW4KLQlsZXQgb3du
ZXIgPSBpZiBwZXJtLm93bmVyID0gZG9taWQgdGhlbiAwIGVsc2UgcGVybS5v
d25lciBpbgotCXsgcGVybSB3aXRoIGFjbDsgb3duZXIgfQorCWlmIHBlcm0u
b3duZXIgPSBkb21pZCB0aGVuIE5vbmUgZWxzZSBTb21lIHsgcGVybSB3aXRo
IGFjbDsgb3duZXIgPSBwZXJtLm93bmVyIH0KIAogbGV0IGRlZmF1bHQwID0g
Y3JlYXRlIDAgTk9ORSBbXQogCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94
ZW5zdG9yZWQvc3RvcmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvc3Rv
cmUubWwKaW5kZXggMjBlNjdiMTQyNzQ2Li43MGYwYzgzZGU0MDQgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9zdG9yZS5tbAorKysgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQvc3RvcmUubWwKQEAgLTg3LDEwICs4Nywy
MSBAQCBsZXQgY2hlY2tfb3duZXIgbm9kZSBjb25uZWN0aW9uID0KIAogbGV0
IHJlYyByZWN1cnNlIGZjdCBub2RlID0gZmN0IG5vZGU7IFN5bWJvbE1hcC5p
dGVyIChmdW4gXyAtPiByZWN1cnNlIGZjdCkgbm9kZS5jaGlsZHJlbgogCi0o
KiogW3JlY3Vyc2VfbWFwIGYgdHJlZV0gYXBwbGllcyBbZl0gb24gZWFjaCBu
b2RlIGluIHRoZSB0cmVlIHJlY3Vyc2l2ZWx5ICopCi1sZXQgcmVjdXJzZV9t
YXAgZiA9CisoKiogW3JlY3Vyc2VfZmlsdGVyX21hcCBmIHRyZWVdIGFwcGxp
ZXMgW2ZdIG9uIGVhY2ggbm9kZSBpbiB0aGUgdHJlZSByZWN1cnNpdmVseSwK
KyAgICBwb3NzaWJseSByZW1vdmluZyBzb21lIG5vZGVzLgorICAgIE5vdGUg
dGhhdCB0aGUgbm9kZXMgcmVtb3ZlZCB0aGlzIHdheSB3b24ndCBnZW5lcmF0
ZSB3YXRjaCBldmVudHMuCisqKQorbGV0IHJlY3Vyc2VfZmlsdGVyX21hcCBm
ID0KKwlsZXQgaW52YWxpZCA9IC0xIGluCisJbGV0IGlzX3ZhbGlkIF8gbm9k
ZSA9IG5vZGUucGVybXMub3duZXIgPD4gaW52YWxpZCBpbgogCWxldCByZWMg
d2FsayBub2RlID0KLQkJZiB7IG5vZGUgd2l0aCBjaGlsZHJlbiA9IFN5bWJv
bE1hcC5tYXAgd2FsayBub2RlLmNoaWxkcmVuIH0KKwkJKCogTWFwLmZpbHRl
cl9tYXAgaXMgT2NhbWwgNC4xMSsgb25seSAqKQorCQlsZXQgbm9kZSA9CisJ
CXsgbm9kZSB3aXRoIGNoaWxkcmVuID0KKwkJCVN5bWJvbE1hcC5tYXAgd2Fs
ayBub2RlLmNoaWxkcmVuIHw+IFN5bWJvbE1hcC5maWx0ZXIgaXNfdmFsaWQg
fSBpbgorCQltYXRjaCBmIG5vZGUgd2l0aAorCQl8IFNvbWUga2VlcCAtPiBr
ZWVwCisJCXwgTm9uZSAtPiB7IG5vZGUgd2l0aCBwZXJtcyA9IHtub2RlLnBl
cm1zIHdpdGggb3duZXIgPSBpbnZhbGlkIH0gfQogCWluCiAJd2FsawogCkBA
IC00NDQsMTEgKzQ1NSwxMyBAQCBsZXQgc2V0cGVybXMgc3RvcmUgcGVybSBw
YXRoIG5wZXJtcyA9CiAKIGxldCByZXNldF9wZXJtaXNzaW9ucyBzdG9yZSBk
b21pZCA9CiAJTG9nZ2luZy5pbmZvICJzdG9yZXxub2RlIiAiQ2xlYW5pbmcg
dXAgeGVuc3RvcmUgQUNMcyBmb3IgZG9taWQgJWQiIGRvbWlkOwotCXN0b3Jl
LnJvb3QgPC0gTm9kZS5yZWN1cnNlX21hcCAoZnVuIG5vZGUgLT4KLQkJbGV0
IHBlcm1zID0gUGVybXMuTm9kZS5yZW1vdmVfZG9taWQgfmRvbWlkIG5vZGUu
cGVybXMgaW4KLQkJaWYgcGVybXMgPD4gbm9kZS5wZXJtcyB0aGVuCi0JCQlM
b2dnaW5nLmRlYnVnICJzdG9yZXxub2RlIiAiQ2hhbmdlZCBwZXJtaXNzaW9u
cyBmb3Igbm9kZSAlcyIgKE5vZGUuZ2V0X25hbWUgbm9kZSk7Ci0JCXsgbm9k
ZSB3aXRoIHBlcm1zIH0KKwlzdG9yZS5yb290IDwtIE5vZGUucmVjdXJzZV9m
aWx0ZXJfbWFwIChmdW4gbm9kZSAtPgorCQltYXRjaCBQZXJtcy5Ob2RlLnJl
bW92ZV9kb21pZCB+ZG9taWQgbm9kZS5wZXJtcyB3aXRoCisJCXwgTm9uZSAt
PiBOb25lCisJCXwgU29tZSBwZXJtcyAtPgorCQkJaWYgcGVybXMgPD4gbm9k
ZS5wZXJtcyB0aGVuCisJCQkJTG9nZ2luZy5kZWJ1ZyAic3RvcmV8bm9kZSIg
IkNoYW5nZWQgcGVybWlzc2lvbnMgZm9yIG5vZGUgJXMiIChOb2RlLmdldF9u
YW1lIG5vZGUpOworCQkJU29tZSB7IG5vZGUgd2l0aCBwZXJtcyB9CiAJKSBz
dG9yZS5yb290CiAKIHR5cGUgb3BzID0gewo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.15-xenstored-01.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.15-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSA0OTYzN2YyMTFhODg2NzI3MDZjMWM5ODBmMDM0OGJmODM2ZDUxNmJk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTIgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlbW92ZSBu
b2RlcyBvd25lZCBieSBkZXN0cm95ZWQgZG9tYWluCgpJbiBjYXNlIGEgZG9t
YWluIGlzIHJlbW92ZWQgZnJvbSBYZW5zdG9yZSwgcmVtb3ZlIGFsbCBub2Rl
cyBvd25lZCBieQppdCBwZXIgZGVmYXVsdC4KClRoaXMgdGFja2xlcyB0aGUg
cHJvYmxlbSB0aGF0IG5vZGVzIG1pZ2h0IGJlIGNyZWF0ZWQgYnkgYSBkb21h
aW4Kb3V0c2lkZSBpdHMgaG9tZSBwYXRoIGluIFhlbnN0b3JlLCBsZWFkaW5n
IHRvIFhlbnN0b3JlIGhvZ2dpbmcgbW9yZQphbmQgbW9yZSBtZW1vcnkuIERv
bWFpbiBxdW90YSBkb24ndCB3b3JrIGluIHRoaXMgY2FzZSBpZiB0aGUgZ3Vl
c3QgaXMKcmVib290aW5nIGluIGJldHdlZW4uCgpTaW5jZSBYU0EtMzIyIG93
bmVyc2hpcCBvZiBzdWNoIHN0YWxlIG5vZGVzIGlzIHRyYW5zZmVycmVkIHRv
IGRvbTAsCndoaWNoIGlzIGhlbHBpbmcgYWdhaW5zdCB1bmludGVuZGVkIGFj
Y2VzcywgYnV0IG5vdCBhZ2FpbnN0IE9PTSBvZgpYZW5zdG9yZS4KCkFzIGEg
ZmFsbGJhY2sgZm9yIHdlaXJkIGNhc2VzIGFkZCBhIFhlbnN0b3JlIHN0YXJ0
IHBhcmFtZXRlciBmb3IKa2VlcGluZyB0b2RheSdzIHdheSB0byBoYW5kbGUg
c3RhbGUgbm9kZXMsIGFkZGluZyB0aGUgcmlzayBvZiBYZW5zdG9yZQpoaXR0
aW5nIGFuIE9PTSBzaXR1YXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIyLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IDQ5NjMwNjMyNGQ4ZCAoInRv
b2xzL3hlbnN0b3JlOiByZXZva2UgYWNjZXNzIHJpZ2h0cyBmb3IgcmVtb3Zl
ZCBkb21haW5zIikKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdy
b3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3Jh
bGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwppbmRleCBlOGNkZmVlZjUwYzcuLmQ1YjJlNTliMGRiNiAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC04MCw2ICs4MCw3
IEBAIHN0YXRpYyBib29sIHZlcmJvc2UgPSBmYWxzZTsKIExJU1RfSEVBRChj
b25uZWN0aW9ucyk7CiBpbnQgdHJhY2VmZCA9IC0xOwogc3RhdGljIGJvb2wg
cmVjb3ZlcnkgPSB0cnVlOworYm9vbCBrZWVwX29ycGhhbnMgPSBmYWxzZTsK
IHN0YXRpYyBpbnQgcmVvcGVuX2xvZ19waXBlWzJdOwogc3RhdGljIGludCBy
ZW9wZW5fbG9nX3BpcGUwX3BvbGxmZF9pZHggPSAtMTsKIGNoYXIgKnRyYWNl
ZmlsZSA9IE5VTEw7CkBAIC03MjIsNyArNzIzLDcgQEAgc3RydWN0IG5vZGUg
KnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LAogCW5vZGUtPnBlcm1zLnAgPSBoZHItPnBlcm1zOwogCW5vZGUt
PmFjYy5kb21pZCA9IG5vZGUtPnBlcm1zLnBbMF0uaWQ7CiAJbm9kZS0+YWNj
Lm1lbW9yeSA9IGRhdGEuZHNpemU7Ci0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhjb25uLCBub2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKG5vZGUpKQogCQlnb3RvIGVycm9yOwogCiAJLyogSWYgb3duZXIg
aXMgZ29uZSByZXNldCBjdXJyZW50bHkgYWNjb3VudGVkIG1lbW9yeSBzaXpl
LiAqLwpAQCAtNzY1LDcgKzc2Niw3IEBAIGludCB3cml0ZV9ub2RlX3Jhdyhz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwgc3RydWN0
IG5vZGUgKm5vZGUsCiAJdm9pZCAqcDsKIAlzdHJ1Y3QgeHNfdGRiX3JlY29y
ZF9oZHIgKmhkcjsKIAotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMo
Y29ubiwgbm9kZSkpCisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKIAkJcmV0dXJuIGVycm5vOwogCiAJZGF0YS5kc2l6ZSA9IHNpemVv
ZigqaGRyKQpAQCAtMTYxNyw3ICsxNjE4LDcgQEAgc3RhdGljIGludCBkZWxu
b2RlX3N1Yihjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLAogCXJldHVybiBXQUxLX1RSRUVfUk1fQ0hJTERFTlRSWTsKIH0KIAot
c3RhdGljIGludCBfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0
IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSkKK2ludCBybV9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0
IGNoYXIgKm5hbWUpCiB7CiAJc3RydWN0IG5vZGUgKnBhcmVudDsKIAljaGFy
ICpwYXJlbnRuYW1lID0gZ2V0X3BhcmVudChjdHgsIG5hbWUpOwpAQCAtMTY4
MSw3ICsxNjgyLDcgQEAgc3RhdGljIGludCBkb19ybShjb25zdCB2b2lkICpj
dHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCWlmIChzdHJlcShuYW1l
LCAiLyIpKQogCQlyZXR1cm4gRUlOVkFMOwogCi0JcmV0ID0gX3JtKGNvbm4s
IGN0eCwgbmFtZSk7CisJcmV0ID0gcm1fbm9kZShjb25uLCBjdHgsIG5hbWUp
OwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTI1MzcsNiArMjUz
OCw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtUiwgLS1uby1y
ZWNvdmVyeSAgICAgICB0byByZXF1ZXN0IHRoYXQgbm8gcmVjb3Zlcnkgc2hv
dWxkIGJlIGF0dGVtcHRlZCB3aGVuXG4iCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGUgc3RvcmUgaXMgY29ycnVwdGVkIChkZWJ1ZyBvbmx5KSxc
biIKICIgIC1JLCAtLWludGVybmFsLWRiICAgICAgIHN0b3JlIGRhdGFiYXNl
IGluIG1lbW9yeSwgbm90IG9uIGRpc2tcbiIKKyIgIC1LLCAtLWtlZXAtb3Jw
aGFucyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFp
biB3aGVuIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9t
YWluIGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIK
ICIgIC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9z
ZSBleGVjdXRpb24uXG4iKTsKIH0KIApAQCAtMjU2MSw2ICsyNTY0LDcgQEAg
c3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRpbWVv
dXQiLCAxLCBOVUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5V
TEwsICdSJyB9LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0s
CisJeyAia2VlcC1vcnBoYW5zIiwgMCwgTlVMTCwgJ0snIH0sCiAJeyAidmVy
Ym9zZSIsIDAsIE5VTEwsICdWJyB9LAogCXsgIndhdGNoLW5iIiwgMSwgTlVM
TCwgJ1cnIH0sCiAjaWZuZGVmIE5PX0xJVkVfVVBEQVRFCkBAIC0yNjQxLDcg
KzI2NDUsNyBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQog
CW9yaWdfYXJnYyA9IGFyZ2M7CiAJb3JpZ19hcmd2ID0gYXJndjsKIAotCXdo
aWxlICgob3B0ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5Q
Uzp0OkE6TTpROnE6VDpSVlc6dzpVIiwKKwl3aGlsZSAoKG9wdCA9IGdldG9w
dF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhLTlBTOnQ6QTpNOlE6cTpUOlJW
Vzp3OlUiLAogCQkJCSAgb3B0aW9ucywgTlVMTCkpICE9IC0xKSB7CiAJCXN3
aXRjaCAob3B0KSB7CiAJCWNhc2UgJ0QnOgpAQCAtMjY3Nyw2ICsyNjgxLDkg
QEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJY2FzZSAn
SSc6CiAJCQl0ZGJfZmxhZ3MgPSBUREJfSU5URVJOQUx8VERCX05PTE9DSzsK
IAkJCWJyZWFrOworCQljYXNlICdLJzoKKwkJCWtlZXBfb3JwaGFucyA9IHRy
dWU7CisJCQlicmVhazsKIAkJY2FzZSAnVic6CiAJCQl2ZXJib3NlID0gdHJ1
ZTsKIAkJCWJyZWFrOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmgKaW5kZXggMzE5MDQ5NGJiZWI1Li45YTlkYmIyYzNjODYgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjMzLDYgKzIzMyw5
IEBAIGludCB3cml0ZV9ub2RlX3JhdyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgVERCX0RBVEEgKmtleSwgc3RydWN0IG5vZGUgKm5vZGUsCiBzdHJ1Y3Qg
bm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJCSAgICAgICBjb25zdCBjaGFyICpuYW1lKTsKIAor
LyogUmVtb3ZlIGEgbm9kZSBhbmQgaXRzIGNoaWxkcmVuLiAqLworaW50IHJt
X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0
eCwgY29uc3QgY2hhciAqbmFtZSk7CisKIHZvaWQgc2V0dXBfc3RydWN0dXJl
KGJvb2wgbGl2ZV91cGRhdGUpOwogc3RydWN0IGNvbm5lY3Rpb24gKm5ld19j
b25uZWN0aW9uKGNvbm53cml0ZWZuX3QgKndyaXRlLCBjb25ucmVhZGZuX3Qg
KnJlYWQpOwogc3RydWN0IGNvbm5lY3Rpb24gKmdldF9jb25uZWN0aW9uX2J5
X2lkKHVuc2lnbmVkIGludCBjb25uX2lkKTsKQEAgLTI3OSw2ICsyODIsNyBA
QCBleHRlcm4gaW50IHF1b3RhX3JlcV9vdXRzdGFuZGluZzsKIGV4dGVybiBp
bnQgcXVvdGFfdHJhbnNfbm9kZXM7CiBleHRlcm4gaW50IHF1b3RhX21lbW9y
eV9wZXJfZG9tYWluX3NvZnQ7CiBleHRlcm4gaW50IHF1b3RhX21lbW9yeV9w
ZXJfZG9tYWluX2hhcmQ7CitleHRlcm4gYm9vbCBrZWVwX29ycGhhbnM7CiAK
IGV4dGVybiB1bnNpZ25lZCBpbnQgdGltZW91dF93YXRjaF9ldmVudF9tc2Vj
OwogCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9t
YWluLmMgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKaW5k
ZXggYTkxY2M3NWFiNTliLi5lZTRiMTkzODdkYjggMTAwNjQ0Ci0tLSBhL3Rv
b2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9kb21haW4uYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKQEAgLTE5NiwxMCArMTk2LDY0
IEBAIHN0YXRpYyB2b2lkIHVubWFwX2ludGVyZmFjZSh2b2lkICppbnRlcmZh
Y2UpCiAJeGVuZ250dGFiX3VubWFwKCp4Z3RfaGFuZGxlLCBpbnRlcmZhY2Us
IDEpOwogfQogCitzdGF0aWMgaW50IGRvbWFpbl90cmVlX3JlbW92ZV9zdWIo
Y29uc3Qgdm9pZCAqY3R4LCBzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwKKwkJ
CQkgIHN0cnVjdCBub2RlICpub2RlLCB2b2lkICphcmcpCit7CisJc3RydWN0
IGRvbWFpbiAqZG9tYWluID0gYXJnOworCVREQl9EQVRBIGtleTsKKwlpbnQg
cmV0ID0gV0FMS19UUkVFX09LOworCisJaWYgKG5vZGUtPnBlcm1zLnBbMF0u
aWQgIT0gZG9tYWluLT5kb21pZCkKKwkJcmV0dXJuIFdBTEtfVFJFRV9PSzsK
KworCWlmIChrZWVwX29ycGhhbnMpIHsKKwkJc2V0X3RkYl9rZXkobm9kZS0+
bmFtZSwgJmtleSk7CisJCWRvbWFpbi0+bmJlbnRyeS0tOworCQlub2RlLT5w
ZXJtcy5wWzBdLmlkID0gcHJpdl9kb21pZDsKKwkJbm9kZS0+YWNjLm1lbW9y
eSA9IDA7CisJCWRvbWFpbl9lbnRyeV9pbmMoTlVMTCwgbm9kZSk7CisJCWlm
ICh3cml0ZV9ub2RlX3JhdyhOVUxMLCAma2V5LCBub2RlLCB0cnVlKSkgewor
CQkJLyogVGhhdCdzIHVuZm9ydHVuYXRlLiBXZSBvbmx5IGNhbiB0cnkgdG8g
Y29udGludWUuICovCisJCQlzeXNsb2coTE9HX0VSUiwKKwkJCSAgICAgICAi
ZXJyb3Igd2hlbiBtb3Zpbmcgb3JwaGFuZWQgbm9kZSAlcyB0byBkb20wXG4i
LAorCQkJICAgICAgIG5vZGUtPm5hbWUpOworCQl9IGVsc2UKKwkJCXRyYWNl
KCJvcnBoYW5lZCBub2RlICVzIG1vdmVkIHRvIGRvbTBcbiIsIG5vZGUtPm5h
bWUpOworCX0gZWxzZSB7CisJCWlmIChybV9ub2RlKE5VTEwsIGN0eCwgbm9k
ZS0+bmFtZSkpIHsKKwkJCS8qIFRoYXQncyB1bmZvcnR1bmF0ZS4gV2Ugb25s
eSBjYW4gdHJ5IHRvIGNvbnRpbnVlLiAqLworCQkJc3lzbG9nKExPR19FUlIs
CisJCQkgICAgICAgImVycm9yIHdoZW4gZGVsZXRpbmcgb3JwaGFuZWQgbm9k
ZSAlc1xuIiwKKwkJCSAgICAgICBub2RlLT5uYW1lKTsKKwkJfSBlbHNlCisJ
CQl0cmFjZSgib3JwaGFuZWQgbm9kZSAlcyBkZWxldGVkXG4iLCBub2RlLT5u
YW1lKTsKKworCQkvKiBTa2lwIGNoaWxkcmVuIGluIGFsbCBjYXNlcyBpbiBv
cmRlciB0byBhdm9pZCBtb3JlIGVycm9ycy4gKi8KKwkJcmV0ID0gV0FMS19U
UkVFX1NLSVBfQ0hJTERSRU47CisJfQorCisJcmV0dXJuIGRvbWFpbi0+bmJl
bnRyeSA+IDAgPyByZXQgOiBXQUxLX1RSRUVfU1VDQ0VTU19TVE9QOworfQor
CitzdGF0aWMgdm9pZCBkb21haW5fdHJlZV9yZW1vdmUoc3RydWN0IGRvbWFp
biAqZG9tYWluKQoreworCWludCByZXQ7CisJc3RydWN0IHdhbGtfZnVuY3Mg
d2Fsa2Z1bmNzID0geyAuZW50ZXIgPSBkb21haW5fdHJlZV9yZW1vdmVfc3Vi
IH07CisKKwlpZiAoZG9tYWluLT5uYmVudHJ5ID4gMCkgeworCQlyZXQgPSB3
YWxrX25vZGVfdHJlZShkb21haW4sIE5VTEwsICIvIiwgJndhbGtmdW5jcywg
ZG9tYWluKTsKKwkJaWYgKHJldCA9PSBXQUxLX1RSRUVfRVJST1JfU1RPUCkK
KwkJCXN5c2xvZyhMT0dfRVJSLAorCQkJICAgICAgICJlcnJvciB3aGVuIGxv
b2tpbmcgZm9yIG9ycGhhbmVkIG5vZGVzXG4iKTsKKwl9Cit9CisKIHN0YXRp
YyBpbnQgZGVzdHJveV9kb21haW4odm9pZCAqX2RvbWFpbikKIHsKIAlzdHJ1
Y3QgZG9tYWluICpkb21haW4gPSBfZG9tYWluOwogCisJZG9tYWluX3RyZWVf
cmVtb3ZlKGRvbWFpbik7CisKIAlsaXN0X2RlbCgmZG9tYWluLT5saXN0KTsK
IAogCWlmICghZG9tYWluLT5pbnRyb2R1Y2VkKQpAQCAtODU3LDE1ICs5MTEs
MTUgQEAgaW50IGRvbWFpbl9lbnRyeV9pbmMoc3RydWN0IGNvbm5lY3Rpb24g
KmNvbm4sIHN0cnVjdCBub2RlICpub2RlKQogCXN0cnVjdCBkb21haW4gKmQ7
CiAJdW5zaWduZWQgaW50IGRvbWlkOwogCi0JaWYgKCFjb25uKQorCWlmICgh
bm9kZS0+cGVybXMucCkKIAkJcmV0dXJuIDA7CiAKLQlkb21pZCA9IG5vZGUt
PnBlcm1zLnAgPyBub2RlLT5wZXJtcy5wWzBdLmlkIDogY29ubi0+aWQ7CisJ
ZG9taWQgPSBub2RlLT5wZXJtcy5wWzBdLmlkOwogCi0JaWYgKGNvbm4tPnRy
YW5zYWN0aW9uKSB7CisJaWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24p
IHsKIAkJdHJhbnNhY3Rpb25fZW50cnlfaW5jKGNvbm4tPnRyYW5zYWN0aW9u
LCBkb21pZCk7CiAJfSBlbHNlIHsKLQkJZCA9IChkb21pZCA9PSBjb25uLT5p
ZCAmJiBjb25uLT5kb21haW4pID8gY29ubi0+ZG9tYWluCisJCWQgPSAoY29u
biAmJiBkb21pZCA9PSBjb25uLT5pZCAmJiBjb25uLT5kb21haW4pID8gY29u
bi0+ZG9tYWluCiAJCSAgICA6IGZpbmRfb3JfYWxsb2NfZXhpc3RpbmdfZG9t
YWluKGRvbWlkKTsKIAkJaWYgKGQpCiAJCQlkLT5uYmVudHJ5Kys7CkBAIC05
MjYsMjMgKzk4MCwxMSBAQCBpbnQgZG9tYWluX2FsbG9jX3Blcm1yZWZzKHN0
cnVjdCBub2RlX3Blcm1zICpwZXJtcykKICAqIFJlbW92ZSBwZXJtaXNzaW9u
cyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5nIGRvbWFpbnMgaW4gb3JkZXIgdG8g
YXZvaWQgYSBuZXcKICAqIGRvbWFpbiB3aXRoIHRoZSBzYW1lIGRvbWlkIGlu
aGVyaXRpbmcgdGhlIHBlcm1pc3Npb25zLgogICovCi1pbnQgZG9tYWluX2Fk
anVzdF9ub2RlX3Blcm1zKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1
Y3Qgbm9kZSAqbm9kZSkKK2ludCBkb21haW5fYWRqdXN0X25vZGVfcGVybXMo
c3RydWN0IG5vZGUgKm5vZGUpCiB7CiAJdW5zaWduZWQgaW50IGk7CiAJaW50
IHJldDsKIAotCXJldCA9IGNoa19kb21haW5fZ2VuZXJhdGlvbihub2RlLT5w
ZXJtcy5wWzBdLmlkLCBub2RlLT5nZW5lcmF0aW9uKTsKLQotCS8qIElmIHRo
ZSBvd25lciBkb2Vzbid0IGV4aXN0IGFueSBsb25nZXIgZ2l2ZSBpdCB0byBw
cml2IGRvbWFpbi4gKi8KLQlpZiAoIXJldCkgewotCQkvKgotCQkgKiBJbiB0
aGVvcnkgd2UnZCBuZWVkIHRvIHVwZGF0ZSB0aGUgbnVtYmVyIG9mIGRvbTAg
bm9kZXMgaGVyZSwKLQkJICogYnV0IHdlIGNvdWxkIGJlIGNhbGxlZCBmb3Ig
YSByZWFkIG9mIHRoZSBub2RlLiBTbyBiZXR0ZXIKLQkJICogYXZvaWQgdGhl
IHJpc2sgdG8gb3ZlcmZsb3cgdGhlIG5vZGUgY291bnQgb2YgZG9tMC4KLQkJ
ICovCi0JCW5vZGUtPnBlcm1zLnBbMF0uaWQgPSBwcml2X2RvbWlkOwotCX0K
LQogCWZvciAoaSA9IDE7IGkgPCBub2RlLT5wZXJtcy5udW07IGkrKykgewog
CQlpZiAobm9kZS0+cGVybXMucFtpXS5wZXJtcyAmIFhTX1BFUk1fSUdOT1JF
KQogCQkJY29udGludWU7CkBAIC05NjAsMTUgKzEwMDIsMTUgQEAgdm9pZCBk
b21haW5fZW50cnlfZGVjKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1
Y3Qgbm9kZSAqbm9kZSkKIAlzdHJ1Y3QgZG9tYWluICpkOwogCXVuc2lnbmVk
IGludCBkb21pZDsKIAotCWlmICghY29ubikKKwlpZiAoIW5vZGUtPnBlcm1z
LnApCiAJCXJldHVybjsKIAogCWRvbWlkID0gbm9kZS0+cGVybXMucCA/IG5v
ZGUtPnBlcm1zLnBbMF0uaWQgOiBjb25uLT5pZDsKIAotCWlmIChjb25uLT50
cmFuc2FjdGlvbikgeworCWlmIChjb25uICYmIGNvbm4tPnRyYW5zYWN0aW9u
KSB7CiAJCXRyYW5zYWN0aW9uX2VudHJ5X2RlYyhjb25uLT50cmFuc2FjdGlv
biwgZG9taWQpOwogCX0gZWxzZSB7Ci0JCWQgPSAoZG9taWQgPT0gY29ubi0+
aWQgJiYgY29ubi0+ZG9tYWluKSA/IGNvbm4tPmRvbWFpbgorCQlkID0gKGNv
bm4gJiYgZG9taWQgPT0gY29ubi0+aWQgJiYgY29ubi0+ZG9tYWluKSA/IGNv
bm4tPmRvbWFpbgogCQkgICAgOiBmaW5kX2RvbWFpbl9zdHJ1Y3QoZG9taWQp
OwogCQlpZiAoZCkgewogCQkJZC0+bmJlbnRyeS0tOwpAQCAtMTA4Nyw3ICsx
MTI5LDcgQEAgaW50IGRvbWFpbl9tZW1vcnlfYWRkKHVuc2lnbmVkIGludCBk
b21pZCwgaW50IG1lbSwgYm9vbCBub19xdW90YV9jaGVjaykKIAkJICogZXhp
c3QsIGFzIGFjY291bnRpbmcgaXMgZG9uZSBlaXRoZXIgZm9yIGEgZG9tYWlu
IHJlbGF0ZWQgdG8KIAkJICogdGhlIGN1cnJlbnQgY29ubmVjdGlvbiwgb3Ig
Zm9yIHRoZSBkb21haW4gb3duaW5nIGEgbm9kZQogCQkgKiAod2hpY2ggaXMg
YWx3YXlzIGV4aXN0aW5nLCBhcyB0aGUgb3duZXIgb2YgdGhlIG5vZGUgaXMK
LQkJICogdGVzdGVkIHRvIGV4aXN0IGFuZCByZXBsYWNlZCBieSBkb21pZCAw
IGlmIG5vdCkuCisJCSAqIHRlc3RlZCB0byBleGlzdCBhbmQgZGVsZXRlZCBv
ciByZXBsYWNlZCBieSBkb21pZCAwIGlmIG5vdCkuCiAJCSAqIFNvIG5vdCBm
aW5kaW5nIHRoZSByZWxhdGVkIGRvbWFpbiBNVVNUIGJlIGFuIGVycm9yIGlu
IHRoZQogCQkgKiBkYXRhIGJhc2UuCiAJCSAqLwpkaWZmIC0tZ2l0IGEvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5oIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5oCmluZGV4IDBiNGY1NmI4MTQ2Yy4uNDkx
ZDdhMzI1YmQzIDEwMDY0NAotLS0gYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfZG9tYWluLmgKKysrIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Rv
bWFpbi5oCkBAIC02NSw3ICs2NSw3IEBAIGJvb2wgZG9tYWluX2Nhbl93cml0
ZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubik7CiBib29sIGRvbWFpbl9pc191
bnByaXZpbGVnZWQoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogCiAvKiBS
ZW1vdmUgbm9kZSBwZXJtaXNzaW9ucyBmb3Igbm8gbG9uZ2VyIGV4aXN0aW5n
IGRvbWFpbnMuICovCi1pbnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBzdHJ1Y3Qgbm9kZSAqbm9kZSk7Citp
bnQgZG9tYWluX2FkanVzdF9ub2RlX3Blcm1zKHN0cnVjdCBub2RlICpub2Rl
KTsKIGludCBkb21haW5fYWxsb2NfcGVybXJlZnMoc3RydWN0IG5vZGVfcGVy
bXMgKnBlcm1zKTsKIAogLyogUXVvdGEgbWFuaXB1bGF0aW9uICovCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.15-xenstored-02.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.15-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA5NWE2Yzg1YjBhNGJkNzgyOGNmOTg2MDc3MDI1NGNlZTc4MTBlOGIw
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1ha2UgdGhl
IGludGVybmFsIG1lbW9yeSBkYXRhIGJhc2UgdGhlIGRlZmF1bHQKCkhhdmlu
ZyBhIGZpbGUgYmFja2VkIGRhdGEgYmFzZSBoYXMgdGhlIG9ubHkgYWR2YW50
YWdlIG9mIGJlaW5nIGNhcGFibGUKdG8gZHVtcCB0aGUgY29udGVudHMgb2Yg
aXQgd2hpbGUgWGVuc3RvcmUgaXMgcnVubmluZywgYW5kIHBvdGVudGlhbGx5
CnVzaW5nIGxlc3Mgc3dhcCBzcGFjZSBpbiBjYXNlIHRoZSBkYXRhIGJhc2Ug
Y2FuJ3QgYmUga2VwdCBpbiBtZW1vcnkuCgpJdCBoYXMgdGhlIG1ham9yIGRp
c2FkdmFudGFnZSBvZiBhIGh1Z2UgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQ6IHN3
aXRjaGluZwp0byBrZWVwIHRoZSBkYXRhIGJhc2UgaW4gbWVtb3J5IG9ubHkg
c3BlZWRzIHVwIGxpdmUgdXBkYXRlIG9mIHhlbnN0b3JlZAp3aXRoIDEyMDAw
MCBub2RlcyBmcm9tIDIwIG1pbnV0ZXMgdG8gMTEgc2Vjb25kcy4gQSBjb21w
bGV0ZSB0cmVlIHdhbGsKb2YgdGhpcyBjb25maWd1cmF0aW9uIHdpbGwgYmUg
cmVkdWNlZCBmcm9tIDcgc2Vjb25kcyB0byAyODAgbXNlY3MKKG1lYXN1cmVk
IGJ5ICJ4ZW5zdG9yZS1jb250cm9sIGNoZWNrIikuCgpTbyBtYWtlIHRoZSBp
bnRlcm5hbCBtZW1vcnkgZGF0YSBiYXNlIHRoZSBkZWZhdWx0IGFuZCBlbmhh
bmNlIHRoZQoiLS1pbnRlcm5hbC1kYiIgY29tbWFuZCBsaW5lIHBhcmFtZXRl
ciB0byB0YWtlIGFuIG9wdGlvbmFsIHBhcmFtZXRlcgphbGxvd2luZyB0byBz
d2l0Y2ggdGhlIGludGVybmFsIGRhdGEgYmFzZSBiYWNrIHRvIHRoZSBmaWxl
IGJhc2VkIG9uZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtNDE5LgoKUmVwb3J0
ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KU2lnbmVk
LW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZp
ZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRp
ZmYgLS1naXQgYS90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWlu
LmMgYi90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKaW5k
ZXggMzI2ODlhYmQ3NDc5Li5kMDgwZGFlNWQzYjggMTAwNjQ0Ci0tLSBhL3Rv
b2xzL2hlbHBlcnMvaW5pdC14ZW5zdG9yZS1kb21haW4uYworKysgYi90b29s
cy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKQEAgLTIxNCw5ICsy
MTQsOSBAQCBzdGF0aWMgaW50IGJ1aWxkKHhjX2ludGVyZmFjZSAqeGNoKQog
ICAgIH0KIAogICAgIGlmICggcGFyYW0gKQotICAgICAgICBzbnByaW50Zihj
bWRsaW5lLCA1MTIsICItLWV2ZW50ICVkIC0taW50ZXJuYWwtZGIgJXMiLCBy
diwgcGFyYW0pOworICAgICAgICBzbnByaW50ZihjbWRsaW5lLCA1MTIsICIt
LWV2ZW50ICVkICVzIiwgcnYsIHBhcmFtKTsKICAgICBlbHNlCi0gICAgICAg
IHNucHJpbnRmKGNtZGxpbmUsIDUxMiwgIi0tZXZlbnQgJWQgLS1pbnRlcm5h
bC1kYiIsIHJ2KTsKKyAgICAgICAgc25wcmludGYoY21kbGluZSwgNTEyLCAi
LS1ldmVudCAlZCIsIHJ2KTsKIAogICAgIGRvbS0+Y21kbGluZSA9IHhjX2Rv
bV9zdHJkdXAoZG9tLCBjbWRsaW5lKTsKICAgICBkb20tPnhlbnN0b3JlX2Rv
bWlkID0gZG9taWQ7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5z
dG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUu
YwppbmRleCBkNWIyZTU5YjBkYjYuLjlkZGJkOTM0Zjc5NCAxMDA2NDQKLS0t
IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29s
cy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0yMjMwLDcgKzIyMzAs
NyBAQCBzdGF0aWMgdm9pZCBhY2NlcHRfY29ubmVjdGlvbihpbnQgc29jaykK
IH0KICNlbmRpZgogCi1zdGF0aWMgaW50IHRkYl9mbGFnczsKK3N0YXRpYyBp
bnQgdGRiX2ZsYWdzID0gVERCX0lOVEVSTkFMIHwgVERCX05PTE9DSzsKIAog
LyogV2UgY3JlYXRlIGluaXRpYWwgbm9kZXMgbWFudWFsbHkuICovCiBzdGF0
aWMgdm9pZCBtYW51YWxfbm9kZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBj
aGFyICpjaGlsZCkKQEAgLTI1MzcsNyArMjUzNyw4IEBAIHN0YXRpYyB2b2lk
IHVzYWdlKHZvaWQpCiAiICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRj
aC1ldmVudDogdGltZSBhIHdhdGNoLWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xu
IgogIiAgLVIsIC0tbm8tcmVjb3ZlcnkgICAgICAgdG8gcmVxdWVzdCB0aGF0
IG5vIHJlY292ZXJ5IHNob3VsZCBiZSBhdHRlbXB0ZWQgd2hlblxuIgogIiAg
ICAgICAgICAgICAgICAgICAgICAgICAgdGhlIHN0b3JlIGlzIGNvcnJ1cHRl
ZCAoZGVidWcgb25seSksXG4iCi0iICAtSSwgLS1pbnRlcm5hbC1kYiAgICAg
ICBzdG9yZSBkYXRhYmFzZSBpbiBtZW1vcnksIG5vdCBvbiBkaXNrXG4iCisi
ICAtSSwgLS1pbnRlcm5hbC1kYiBbb258b2ZmXSBzdG9yZSBkYXRhYmFzZSBp
biBtZW1vcnksIG5vdCBvbiBkaXNrLCBkZWZhdWx0IGlzXG4iCisiICAgICAg
ICAgICAgICAgICAgICAgICAgICBtZW1vcnksIHdpdGggXCItLWludGVybmFs
LWRiIG9mZlwiIGl0IGlzIG9uIGRpc2tcbiIKICIgIC1LLCAtLWtlZXAtb3Jw
aGFucyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFp
biB3aGVuIHRoZVxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9t
YWluIGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIK
ICIgIC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9z
ZSBleGVjdXRpb24uXG4iKTsKQEAgLTI1NjMsNyArMjU2NCw3IEBAIHN0YXRp
YyBzdHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsKIAl7ICJxdW90YS1zb2Z0
IiwgMSwgTlVMTCwgJ3EnIH0sCiAJeyAidGltZW91dCIsIDEsIE5VTEwsICd3
JyB9LAogCXsgIm5vLXJlY292ZXJ5IiwgMCwgTlVMTCwgJ1InIH0sCi0JeyAi
aW50ZXJuYWwtZGIiLCAwLCBOVUxMLCAnSScgfSwKKwl7ICJpbnRlcm5hbC1k
YiIsIDIsIE5VTEwsICdJJyB9LAogCXsgImtlZXAtb3JwaGFucyIsIDAsIE5V
TEwsICdLJyB9LAogCXsgInZlcmJvc2UiLCAwLCBOVUxMLCAnVicgfSwKIAl7
ICJ3YXRjaC1uYiIsIDEsIE5VTEwsICdXJyB9LApAQCAtMjY0NSw3ICsyNjQ2
LDggQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlvcmln
X2FyZ2MgPSBhcmdjOwogCW9yaWdfYXJndiA9IGFyZ3Y7CiAKLQl3aGlsZSAo
KG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhLTlBTOnQ6
QTpNOlE6cTpUOlJWVzp3OlUiLAorCXdoaWxlICgob3B0ID0gZ2V0b3B0X2xv
bmcoYXJnYywgYXJndiwKKwkJCQkgICJERTpGOkhJOjpLTlBTOnQ6QTpNOlE6
cTpUOlJWVzp3OlUiLAogCQkJCSAgb3B0aW9ucywgTlVMTCkpICE9IC0xKSB7
CiAJCXN3aXRjaCAob3B0KSB7CiAJCWNhc2UgJ0QnOgpAQCAtMjY3OSw3ICsy
NjgxLDggQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJ
CXRyYWNlZmlsZSA9IG9wdGFyZzsKIAkJCWJyZWFrOwogCQljYXNlICdJJzoK
LQkJCXRkYl9mbGFncyA9IFREQl9JTlRFUk5BTHxUREJfTk9MT0NLOworCQkJ
aWYgKG9wdGFyZyAmJiAhc3RyY21wKG9wdGFyZywgIm9mZiIpKQorCQkJCXRk
Yl9mbGFncyA9IDA7CiAJCQlicmVhazsKIAkJY2FzZSAnSyc6CiAJCQlrZWVw
X29ycGhhbnMgPSB0cnVlOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-4.15-xenstored-03.patch"
Content-Disposition: attachment;
 filename="xsa419/xsa419-4.15-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSBkNGY3YjE1MGQzOGM2NDRhNmVmYjRhMTkzODVmOWJiOTJjNzY4NDJk
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogZG9jczogZW5oYW5jZSB4ZW5zdG9yZS50
eHQgd2l0aCBwZXJtaXNzaW9ucyBkZXNjcmlwdGlvbgpNSU1FLVZlcnNpb246
IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRGLTgK
Q29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKVGhlIHBlcm1pc3Np
b24gc2NoZW1lIG9mIFhlbnN0b3JlIG5vZGVzIGlzIG5vdCByZWFsbHkgY292
ZXJlZCBieQpkb2NzL21pc2MveGVuc3RvcmUudHh0LCBvdGhlciB0aGFuIHJl
ZmVycmluZyB0byB0aGUgWGVuIHdpa2kuCgpBZGQgYSBwYXJhZ3JhcGggZXhw
bGFpbmluZyB0aGUgcGVybWlzc2lvbnMgb2Ygbm9kZXMsIGFuZCBlc3BlY2lh
bGx5Cm1lbnRpb25pbmcgcmVtb3ZhbCBvZiBub2RlcyB3aGVuIGEgZG9tYWlu
IGhhcyBiZWVuIHJlbW92ZWQgZnJvbQpYZW5zdG9yZS4KClRoaXMgaXMgcGFy
dCBvZiBYU0EtNDE5LgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8
amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogRWR3aW4gVMO2csO2ayA8
ZWR2aW4udG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNj
L3hlbnN0b3JlLnR4dCBiL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQKaW5kZXgg
YTdkMDA2NTE5YWU4Li5lY2NkNTk2ZWUzOGMgMTAwNjQ0Ci0tLSBhL2RvY3Mv
bWlzYy94ZW5zdG9yZS50eHQKKysrIGIvZG9jcy9taXNjL3hlbnN0b3JlLnR4
dApAQCAtNDMsNiArNDMsMTcgQEAgYnl0ZXMgYXJlIGZvcmJpZGRlbjsgY2xp
ZW50cyBzcGVjaWZ5aW5nIHJlbGF0aXZlIHBhdGhzIHNob3VsZCBrZWVwCiB0
aGVtIHRvIHdpdGhpbiAyMDQ4IGJ5dGVzLiAgKFNlZSBYRU5TVE9SRV8qX1BB
VEhfTUFYIGluIHhzX3dpcmUuaC4pCiAKIAorRWFjaCBub2RlIGhhcyBvbmUg
b3IgbXVsdGlwbGUgcGVybWlzc2lvbiBlbnRyaWVzLiAgUGVybWlzc2lvbnMg
YXJlCitncmFudGVkIGJ5IGRvbWFpbi1pZCwgdGhlIGZpcnN0IHBlcm1pc3Np
b24gZW50cnkgb2YgZWFjaCBub2RlIHNwZWNpZmllcwordGhlIG93bmVyIG9m
IHRoZSBub2RlLiAgUGVybWlzc2lvbnMgb2YgYSBub2RlIGNhbiBiZSBjaGFu
Z2VkIGJ5IHRoZQorb3duZXIgb2YgdGhlIG5vZGUsIHRoZSBvd25lciBjYW4g
b25seSBiZSBtb2RpZmllZCBieSB0aGUgY29udHJvbAorZG9tYWluICh1c3Vh
bGx5IGRvbWFpbiBpZCAwKS4gIFRoZSBvd25lciBhbHdheXMgaGFzIHRoZSBy
aWdodCB0byByZWFkCithbmQgd3JpdGUgdGhlIG5vZGUsIHdoaWxlIG90aGVy
IHBlcm1pc3Npb25zIGNhbiBiZSBzZXR1cCB0byBhbGxvdworcmVhZCBhbmQv
b3Igd3JpdGUgYWNjZXNzLiAgV2hlbiBhIGRvbWFpbiBpcyBiZWluZyByZW1v
dmVkIGZyb20gWGVuc3RvcmUKK25vZGVzIG93bmVkIGJ5IHRoYXQgZG9tYWlu
IHdpbGwgYmUgcmVtb3ZlZCB0b2dldGhlciB3aXRoIGFsbCBvZiB0aG9zZQor
bm9kZXMnIGNoaWxkcmVuLgorCisKIENvbW11bmljYXRpb24gd2l0aCB4ZW5z
dG9yZSBpcyB2aWEgZWl0aGVyIHNvY2tldHMsIG9yIGV2ZW50IGNoYW5uZWwK
IGFuZCBzaGFyZWQgbWVtb3J5LCBhcyBzcGVjaWZpZWQgaW4gaW8veHNfd2ly
ZS5oOiBlYWNoIG1lc3NhZ2UgaW4KIGVpdGhlciBkaXJlY3Rpb24gaXMgYSBo
ZWFkZXIgZm9ybWF0dGVkIGFzIGEgc3RydWN0IHhzZF9zb2NrbXNnCg==

--=separator
Content-Type: application/octet-stream; name="xsa419/xsa419-oxenstored.patch"
Content-Disposition: attachment; filename="xsa419/xsa419-oxenstored.patch"
Content-Transfer-Encoding: base64

RnJvbSAwOTIyODM2OWE1NDk0MjcyOTRmZWJlMzUxMzcyZDcyMjdlNjI0ZGEx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiA9P1VURi04P3E/RWR3
aW49MjBUPUMzPUI2cj1DMz1CNms/PSA8ZWR2aW4udG9yb2tAY2l0cml4LmNv
bT4KRGF0ZTogV2VkLCAxMiBPY3QgMjAyMiAxOToxMzowNiArMDEwMApTdWJq
ZWN0OiB0b29scy9vY2FtbC94ZW5zdG9yZWQ6IEZpeCBxdW90YSBieXBhc3Mg
b24gZG9tYWluIHNodXRkb3duCk1JTUUtVmVyc2lvbjogMS4wCkNvbnRlbnQt
VHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOApDb250ZW50LVRyYW5z
ZmVyLUVuY29kaW5nOiA4Yml0CgpYU0EtMzIyIGZpeGVkIGEgZG9taWQgcmV1
c2UgdnVsbmVyYWJpbGl0eSBieSBhc3NpZ25pbmcgRG9tMCBhcyB0aGUgb3du
ZXIgb2YKYW55IG5vZGVzIGxlZnQgYWZ0ZXIgYSBkb21haW4gaXMgc2h1dGRv
d24gKGUuZy4gb3V0c2lkZSBpdHMgL2xvY2FsL2RvbWFpbi9OCnRyZWUpLgoK
SG93ZXZlciBEb20wIGhhcyBubyBxdW90YSBvbiBwdXJwb3NlLCBzbyB0aGlz
IG9wZW5lZCB1cCBhbm90aGVyIHBvdGVudGlhbAphdHRhY2sgdmVjdG9yLiBB
dm9pZCBpdCBieSBkZWxldGluZyB0aGVzZSBub2RlcyBpbnN0ZWFkIG9mIGFz
c2lnbmluZyB0aGVtIHRvCkRvbTAuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIzLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IGM0NmVmZjkyMTIwOSAoInRv
b2xzL29jYW1sL3hlbnN0b3JlZDogY2xlYW4gdXAgcGVybWlzc2lvbnMgZm9y
IGRlYWQgZG9tYWlucyIpClNpZ25lZC1vZmYtYnk6IEVkd2luIFTDtnLDtmsg
PGVkdmluLnRvcm9rQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBDaHJpc3RpYW4g
TGluZGlnIDxjaHJpc3RpYW4ubGluZGlnQGNpdHJpeC5jb20+CgpkaWZmIC0t
Z2l0IGEvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sIGIvdG9vbHMv
b2NhbWwveGVuc3RvcmVkL3Blcm1zLm1sCmluZGV4IGU4YTE2MjIxZjhmYS4u
ODRmMjUwM2U4ZTI5IDEwMDY0NAotLS0gYS90b29scy9vY2FtbC94ZW5zdG9y
ZWQvcGVybXMubWwKKysrIGIvdG9vbHMvb2NhbWwveGVuc3RvcmVkL3Blcm1z
Lm1sCkBAIC02NCw4ICs2NCw3IEBAIGxldCBnZXRfb3duZXIgcGVybSA9IHBl
cm0ub3duZXIKICogKikKIGxldCByZW1vdmVfZG9taWQgfmRvbWlkIHBlcm0g
PQogCWxldCBhY2wgPSBMaXN0LmZpbHRlciAoZnVuIChhY2xfZG9taWQsIF8p
IC0+IGFjbF9kb21pZCA8PiBkb21pZCkgcGVybS5hY2wgaW4KLQlsZXQgb3du
ZXIgPSBpZiBwZXJtLm93bmVyID0gZG9taWQgdGhlbiAwIGVsc2UgcGVybS5v
d25lciBpbgotCXsgcGVybSB3aXRoIGFjbDsgb3duZXIgfQorCWlmIHBlcm0u
b3duZXIgPSBkb21pZCB0aGVuIE5vbmUgZWxzZSBTb21lIHsgcGVybSB3aXRo
IGFjbDsgb3duZXIgPSBwZXJtLm93bmVyIH0KIAogbGV0IGRlZmF1bHQwID0g
Y3JlYXRlIDAgTk9ORSBbXQogCmRpZmYgLS1naXQgYS90b29scy9vY2FtbC94
ZW5zdG9yZWQvc3RvcmUubWwgYi90b29scy9vY2FtbC94ZW5zdG9yZWQvc3Rv
cmUubWwKaW5kZXggMjBlNjdiMTQyNzQ2Li43MGYwYzgzZGU0MDQgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL29jYW1sL3hlbnN0b3JlZC9zdG9yZS5tbAorKysgYi90
b29scy9vY2FtbC94ZW5zdG9yZWQvc3RvcmUubWwKQEAgLTg3LDEwICs4Nywy
MSBAQCBsZXQgY2hlY2tfb3duZXIgbm9kZSBjb25uZWN0aW9uID0KIAogbGV0
IHJlYyByZWN1cnNlIGZjdCBub2RlID0gZmN0IG5vZGU7IFN5bWJvbE1hcC5p
dGVyIChmdW4gXyAtPiByZWN1cnNlIGZjdCkgbm9kZS5jaGlsZHJlbgogCi0o
KiogW3JlY3Vyc2VfbWFwIGYgdHJlZV0gYXBwbGllcyBbZl0gb24gZWFjaCBu
b2RlIGluIHRoZSB0cmVlIHJlY3Vyc2l2ZWx5ICopCi1sZXQgcmVjdXJzZV9t
YXAgZiA9CisoKiogW3JlY3Vyc2VfZmlsdGVyX21hcCBmIHRyZWVdIGFwcGxp
ZXMgW2ZdIG9uIGVhY2ggbm9kZSBpbiB0aGUgdHJlZSByZWN1cnNpdmVseSwK
KyAgICBwb3NzaWJseSByZW1vdmluZyBzb21lIG5vZGVzLgorICAgIE5vdGUg
dGhhdCB0aGUgbm9kZXMgcmVtb3ZlZCB0aGlzIHdheSB3b24ndCBnZW5lcmF0
ZSB3YXRjaCBldmVudHMuCisqKQorbGV0IHJlY3Vyc2VfZmlsdGVyX21hcCBm
ID0KKwlsZXQgaW52YWxpZCA9IC0xIGluCisJbGV0IGlzX3ZhbGlkIF8gbm9k
ZSA9IG5vZGUucGVybXMub3duZXIgPD4gaW52YWxpZCBpbgogCWxldCByZWMg
d2FsayBub2RlID0KLQkJZiB7IG5vZGUgd2l0aCBjaGlsZHJlbiA9IFN5bWJv
bE1hcC5tYXAgd2FsayBub2RlLmNoaWxkcmVuIH0KKwkJKCogTWFwLmZpbHRl
cl9tYXAgaXMgT2NhbWwgNC4xMSsgb25seSAqKQorCQlsZXQgbm9kZSA9CisJ
CXsgbm9kZSB3aXRoIGNoaWxkcmVuID0KKwkJCVN5bWJvbE1hcC5tYXAgd2Fs
ayBub2RlLmNoaWxkcmVuIHw+IFN5bWJvbE1hcC5maWx0ZXIgaXNfdmFsaWQg
fSBpbgorCQltYXRjaCBmIG5vZGUgd2l0aAorCQl8IFNvbWUga2VlcCAtPiBr
ZWVwCisJCXwgTm9uZSAtPiB7IG5vZGUgd2l0aCBwZXJtcyA9IHtub2RlLnBl
cm1zIHdpdGggb3duZXIgPSBpbnZhbGlkIH0gfQogCWluCiAJd2FsawogCkBA
IC00NDQsMTEgKzQ1NSwxMyBAQCBsZXQgc2V0cGVybXMgc3RvcmUgcGVybSBw
YXRoIG5wZXJtcyA9CiAKIGxldCByZXNldF9wZXJtaXNzaW9ucyBzdG9yZSBk
b21pZCA9CiAJTG9nZ2luZy5pbmZvICJzdG9yZXxub2RlIiAiQ2xlYW5pbmcg
dXAgeGVuc3RvcmUgQUNMcyBmb3IgZG9taWQgJWQiIGRvbWlkOwotCXN0b3Jl
LnJvb3QgPC0gTm9kZS5yZWN1cnNlX21hcCAoZnVuIG5vZGUgLT4KLQkJbGV0
IHBlcm1zID0gUGVybXMuTm9kZS5yZW1vdmVfZG9taWQgfmRvbWlkIG5vZGUu
cGVybXMgaW4KLQkJaWYgcGVybXMgPD4gbm9kZS5wZXJtcyB0aGVuCi0JCQlM
b2dnaW5nLmRlYnVnICJzdG9yZXxub2RlIiAiQ2hhbmdlZCBwZXJtaXNzaW9u
cyBmb3Igbm9kZSAlcyIgKE5vZGUuZ2V0X25hbWUgbm9kZSk7Ci0JCXsgbm9k
ZSB3aXRoIHBlcm1zIH0KKwlzdG9yZS5yb290IDwtIE5vZGUucmVjdXJzZV9m
aWx0ZXJfbWFwIChmdW4gbm9kZSAtPgorCQltYXRjaCBQZXJtcy5Ob2RlLnJl
bW92ZV9kb21pZCB+ZG9taWQgbm9kZS5wZXJtcyB3aXRoCisJCXwgTm9uZSAt
PiBOb25lCisJCXwgU29tZSBwZXJtcyAtPgorCQkJaWYgcGVybXMgPD4gbm9k
ZS5wZXJtcyB0aGVuCisJCQkJTG9nZ2luZy5kZWJ1ZyAic3RvcmV8bm9kZSIg
IkNoYW5nZWQgcGVybWlzc2lvbnMgZm9yIG5vZGUgJXMiIChOb2RlLmdldF9u
YW1lIG5vZGUpOworCQkJU29tZSB7IG5vZGUgd2l0aCBwZXJtcyB9CiAJKSBz
dG9yZS5yb290CiAKIHR5cGUgb3BzID0gewo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-xenstored-01.patch"
Content-Disposition: attachment; filename="xsa419/xsa419-xenstored-01.patch"
Content-Transfer-Encoding: base64

RnJvbSBlNDI1MGJmOGIzOWVkNzM2MjNjNzViMGYxNDM2YWM3YzFkNDVhYmE3
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTIgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IHJlbW92ZSBu
b2RlcyBvd25lZCBieSBkZXN0cm95ZWQgZG9tYWluCgpJbiBjYXNlIGEgZG9t
YWluIGlzIHJlbW92ZWQgZnJvbSBYZW5zdG9yZSwgcmVtb3ZlIGFsbCBub2Rl
cyBvd25lZCBieQppdCBwZXIgZGVmYXVsdC4KClRoaXMgdGFja2xlcyB0aGUg
cHJvYmxlbSB0aGF0IG5vZGVzIG1pZ2h0IGJlIGNyZWF0ZWQgYnkgYSBkb21h
aW4Kb3V0c2lkZSBpdHMgaG9tZSBwYXRoIGluIFhlbnN0b3JlLCBsZWFkaW5n
IHRvIFhlbnN0b3JlIGhvZ2dpbmcgbW9yZQphbmQgbW9yZSBtZW1vcnkuIERv
bWFpbiBxdW90YSBkb24ndCB3b3JrIGluIHRoaXMgY2FzZSBpZiB0aGUgZ3Vl
c3QgaXMKcmVib290aW5nIGluIGJldHdlZW4uCgpTaW5jZSBYU0EtMzIyIG93
bmVyc2hpcCBvZiBzdWNoIHN0YWxlIG5vZGVzIGlzIHRyYW5zZmVycmVkIHRv
IGRvbTAsCndoaWNoIGlzIGhlbHBpbmcgYWdhaW5zdCB1bmludGVuZGVkIGFj
Y2VzcywgYnV0IG5vdCBhZ2FpbnN0IE9PTSBvZgpYZW5zdG9yZS4KCkFzIGEg
ZmFsbGJhY2sgZm9yIHdlaXJkIGNhc2VzIGFkZCBhIFhlbnN0b3JlIHN0YXJ0
IHBhcmFtZXRlciBmb3IKa2VlcGluZyB0b2RheSdzIHdheSB0byBoYW5kbGUg
c3RhbGUgbm9kZXMsIGFkZGluZyB0aGUgcmlzayBvZiBYZW5zdG9yZQpoaXR0
aW5nIGFuIE9PTSBzaXR1YXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTQx
OSAvIENWRS0yMDIyLTQyMzIyLgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jv
c3MgPGpncm9zc0BzdXNlLmNvbT4KRml4ZXM6IDQ5NjMwNjMyNGQ4ZCAoInRv
b2xzL3hlbnN0b3JlOiByZXZva2UgYWNjZXNzIHJpZ2h0cyBmb3IgcmVtb3Zl
ZCBkb21haW5zIikKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdy
b3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3Jh
bGxAYW1hem9uLmNvbT4KCmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfY29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2Nv
cmUuYwppbmRleCBiZGMxNDY3OWFkZjUuLjEzZTQ4YWFhNzMxYyAxMDA2NDQK
LS0tIGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90
b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC04MCw2ICs4MCw3
IEBAIHN0YXRpYyBib29sIHZlcmJvc2UgPSBmYWxzZTsKIExJU1RfSEVBRChj
b25uZWN0aW9ucyk7CiBpbnQgdHJhY2VmZCA9IC0xOwogc3RhdGljIGJvb2wg
cmVjb3ZlcnkgPSB0cnVlOworYm9vbCBrZWVwX29ycGhhbnMgPSBmYWxzZTsK
IHN0YXRpYyBpbnQgcmVvcGVuX2xvZ19waXBlWzJdOwogc3RhdGljIGludCBy
ZW9wZW5fbG9nX3BpcGUwX3BvbGxmZF9pZHggPSAtMTsKIGNoYXIgKnRyYWNl
ZmlsZSA9IE5VTEw7CkBAIC03NTMsNyArNzU0LDcgQEAgc3RydWN0IG5vZGUg
KnJlYWRfbm9kZShzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgY29uc3Qgdm9p
ZCAqY3R4LAogCW5vZGUtPnBlcm1zLnAgPSBoZHItPnBlcm1zOwogCW5vZGUt
PmFjYy5kb21pZCA9IG5vZGUtPnBlcm1zLnBbMF0uaWQ7CiAJbm9kZS0+YWNj
Lm1lbW9yeSA9IGRhdGEuZHNpemU7Ci0JaWYgKGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhjb25uLCBub2RlKSkKKwlpZiAoZG9tYWluX2FkanVzdF9ub2Rl
X3Blcm1zKG5vZGUpKQogCQlnb3RvIGVycm9yOwogCiAJLyogSWYgb3duZXIg
aXMgZ29uZSByZXNldCBjdXJyZW50bHkgYWNjb3VudGVkIG1lbW9yeSBzaXpl
LiAqLwpAQCAtNzk2LDcgKzc5Nyw3IEBAIGludCB3cml0ZV9ub2RlX3Jhdyhz
dHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgVERCX0RBVEEgKmtleSwgc3RydWN0
IG5vZGUgKm5vZGUsCiAJdm9pZCAqcDsKIAlzdHJ1Y3QgeHNfdGRiX3JlY29y
ZF9oZHIgKmhkcjsKIAotCWlmIChkb21haW5fYWRqdXN0X25vZGVfcGVybXMo
Y29ubiwgbm9kZSkpCisJaWYgKGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhu
b2RlKSkKIAkJcmV0dXJuIGVycm5vOwogCiAJZGF0YS5kc2l6ZSA9IHNpemVv
ZigqaGRyKQpAQCAtMTY0Nyw3ICsxNjQ4LDcgQEAgc3RhdGljIGludCBkZWxu
b2RlX3N1Yihjb25zdCB2b2lkICpjdHgsIHN0cnVjdCBjb25uZWN0aW9uICpj
b25uLAogCXJldHVybiBXQUxLX1RSRUVfUk1fQ0hJTERFTlRSWTsKIH0KIAot
c3RhdGljIGludCBfcm0oc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0
IHZvaWQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSkKK2ludCBybV9ub2RlKHN0
cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25zdCB2b2lkICpjdHgsIGNvbnN0
IGNoYXIgKm5hbWUpCiB7CiAJc3RydWN0IG5vZGUgKnBhcmVudDsKIAljaGFy
ICpwYXJlbnRuYW1lID0gZ2V0X3BhcmVudChjdHgsIG5hbWUpOwpAQCAtMTcx
MSw3ICsxNzEyLDcgQEAgc3RhdGljIGludCBkb19ybShjb25zdCB2b2lkICpj
dHgsIHN0cnVjdCBjb25uZWN0aW9uICpjb25uLAogCWlmIChzdHJlcShuYW1l
LCAiLyIpKQogCQlyZXR1cm4gRUlOVkFMOwogCi0JcmV0ID0gX3JtKGNvbm4s
IGN0eCwgbmFtZSk7CisJcmV0ID0gcm1fbm9kZShjb25uLCBjdHgsIG5hbWUp
OwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTI2MTgsNiArMjYx
OSw4IEBAIHN0YXRpYyB2b2lkIHVzYWdlKHZvaWQpCiAiICAtUiwgLS1uby1y
ZWNvdmVyeSAgICAgICB0byByZXF1ZXN0IHRoYXQgbm8gcmVjb3Zlcnkgc2hv
dWxkIGJlIGF0dGVtcHRlZCB3aGVuXG4iCiAiICAgICAgICAgICAgICAgICAg
ICAgICAgICB0aGUgc3RvcmUgaXMgY29ycnVwdGVkIChkZWJ1ZyBvbmx5KSxc
biIKICIgIC1JLCAtLWludGVybmFsLWRiICAgICAgIHN0b3JlIGRhdGFiYXNl
IGluIG1lbW9yeSwgbm90IG9uIGRpc2tcbiIKKyIgIC1LLCAtLWtlZXAtb3Jw
aGFucyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFp
biB3aGVuIHRoZVxuIgorIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9t
YWluIGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIK
ICIgIC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9z
ZSBleGVjdXRpb24uXG4iKTsKIH0KIApAQCAtMjY0Miw2ICsyNjQ1LDcgQEAg
c3RhdGljIHN0cnVjdCBvcHRpb24gb3B0aW9uc1tdID0gewogCXsgInRpbWVv
dXQiLCAxLCBOVUxMLCAndycgfSwKIAl7ICJuby1yZWNvdmVyeSIsIDAsIE5V
TEwsICdSJyB9LAogCXsgImludGVybmFsLWRiIiwgMCwgTlVMTCwgJ0knIH0s
CisJeyAia2VlcC1vcnBoYW5zIiwgMCwgTlVMTCwgJ0snIH0sCiAJeyAidmVy
Ym9zZSIsIDAsIE5VTEwsICdWJyB9LAogCXsgIndhdGNoLW5iIiwgMSwgTlVM
TCwgJ1cnIH0sCiAjaWZuZGVmIE5PX0xJVkVfVVBEQVRFCkBAIC0yNzIxLDcg
KzI3MjUsNyBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQog
CW9yaWdfYXJnYyA9IGFyZ2M7CiAJb3JpZ19hcmd2ID0gYXJndjsKIAotCXdo
aWxlICgob3B0ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJndiwgIkRFOkY6SE5Q
Uzp0OkE6TTpROnE6VDpSVlc6dzpVIiwKKwl3aGlsZSAoKG9wdCA9IGdldG9w
dF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhLTlBTOnQ6QTpNOlE6cTpUOlJW
Vzp3OlUiLAogCQkJCSAgb3B0aW9ucywgTlVMTCkpICE9IC0xKSB7CiAJCXN3
aXRjaCAob3B0KSB7CiAJCWNhc2UgJ0QnOgpAQCAtMjc1Nyw2ICsyNzYxLDkg
QEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJY2FzZSAn
SSc6CiAJCQl0ZGJfZmxhZ3MgPSBUREJfSU5URVJOQUx8VERCX05PTE9DSzsK
IAkJCWJyZWFrOworCQljYXNlICdLJzoKKwkJCWtlZXBfb3JwaGFucyA9IHRy
dWU7CisJCQlicmVhazsKIAkJY2FzZSAnVic6CiAJCQl2ZXJib3NlID0gdHJ1
ZTsKIAkJCWJyZWFrOwpkaWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVu
c3RvcmVkX2NvcmUuaCBiL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3Jl
LmgKaW5kZXggYWNiMDBhZDk2OTE0Li4zNzAwNmQ1MDhkYmYgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9jb3JlLmgKKysrIGIvdG9v
bHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuaApAQCAtMjQwLDYgKzI0MCw5
IEBAIGludCB3cml0ZV9ub2RlX3JhdyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29u
biwgVERCX0RBVEEgKmtleSwgc3RydWN0IG5vZGUgKm5vZGUsCiBzdHJ1Y3Qg
bm9kZSAqcmVhZF9ub2RlKHN0cnVjdCBjb25uZWN0aW9uICpjb25uLCBjb25z
dCB2b2lkICpjdHgsCiAJCSAgICAgICBjb25zdCBjaGFyICpuYW1lKTsKIAor
LyogUmVtb3ZlIGEgbm9kZSBhbmQgaXRzIGNoaWxkcmVuLiAqLworaW50IHJt
X25vZGUoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIGNvbnN0IHZvaWQgKmN0
eCwgY29uc3QgY2hhciAqbmFtZSk7CisKIHZvaWQgc2V0dXBfc3RydWN0dXJl
KGJvb2wgbGl2ZV91cGRhdGUpOwogc3RydWN0IGNvbm5lY3Rpb24gKm5ld19j
b25uZWN0aW9uKGNvbnN0IHN0cnVjdCBpbnRlcmZhY2VfZnVuY3MgKmZ1bmNz
KTsKIHN0cnVjdCBjb25uZWN0aW9uICpnZXRfY29ubmVjdGlvbl9ieV9pZCh1
bnNpZ25lZCBpbnQgY29ubl9pZCk7CkBAIC0yODQsNiArMjg3LDcgQEAgZXh0
ZXJuIGludCBxdW90YV9yZXFfb3V0c3RhbmRpbmc7CiBleHRlcm4gaW50IHF1
b3RhX3RyYW5zX25vZGVzOwogZXh0ZXJuIGludCBxdW90YV9tZW1vcnlfcGVy
X2RvbWFpbl9zb2Z0OwogZXh0ZXJuIGludCBxdW90YV9tZW1vcnlfcGVyX2Rv
bWFpbl9oYXJkOworZXh0ZXJuIGJvb2wga2VlcF9vcnBoYW5zOwogCiBleHRl
cm4gdW5zaWduZWQgaW50IHRpbWVvdXRfd2F0Y2hfZXZlbnRfbXNlYzsKIApk
aWZmIC0tZ2l0IGEvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5j
IGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2RvbWFpbi5jCmluZGV4IDk4
YjQwMWZkZWMzMC4uODRiNzgxN2NkNWU2IDEwMDY0NAotLS0gYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmMKKysrIGIvdG9vbHMveGVuc3Rv
cmUveGVuc3RvcmVkX2RvbWFpbi5jCkBAIC0yMjcsMTAgKzIyNyw2NCBAQCBz
dGF0aWMgdm9pZCB1bm1hcF9pbnRlcmZhY2Uodm9pZCAqaW50ZXJmYWNlKQog
CXhlbmdudHRhYl91bm1hcCgqeGd0X2hhbmRsZSwgaW50ZXJmYWNlLCAxKTsK
IH0KIAorc3RhdGljIGludCBkb21haW5fdHJlZV9yZW1vdmVfc3ViKGNvbnN0
IHZvaWQgKmN0eCwgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sCisJCQkJICBz
dHJ1Y3Qgbm9kZSAqbm9kZSwgdm9pZCAqYXJnKQoreworCXN0cnVjdCBkb21h
aW4gKmRvbWFpbiA9IGFyZzsKKwlUREJfREFUQSBrZXk7CisJaW50IHJldCA9
IFdBTEtfVFJFRV9PSzsKKworCWlmIChub2RlLT5wZXJtcy5wWzBdLmlkICE9
IGRvbWFpbi0+ZG9taWQpCisJCXJldHVybiBXQUxLX1RSRUVfT0s7CisKKwlp
ZiAoa2VlcF9vcnBoYW5zKSB7CisJCXNldF90ZGJfa2V5KG5vZGUtPm5hbWUs
ICZrZXkpOworCQlkb21haW4tPm5iZW50cnktLTsKKwkJbm9kZS0+cGVybXMu
cFswXS5pZCA9IHByaXZfZG9taWQ7CisJCW5vZGUtPmFjYy5tZW1vcnkgPSAw
OworCQlkb21haW5fZW50cnlfaW5jKE5VTEwsIG5vZGUpOworCQlpZiAod3Jp
dGVfbm9kZV9yYXcoTlVMTCwgJmtleSwgbm9kZSwgdHJ1ZSkpIHsKKwkJCS8q
IFRoYXQncyB1bmZvcnR1bmF0ZS4gV2Ugb25seSBjYW4gdHJ5IHRvIGNvbnRp
bnVlLiAqLworCQkJc3lzbG9nKExPR19FUlIsCisJCQkgICAgICAgImVycm9y
IHdoZW4gbW92aW5nIG9ycGhhbmVkIG5vZGUgJXMgdG8gZG9tMFxuIiwKKwkJ
CSAgICAgICBub2RlLT5uYW1lKTsKKwkJfSBlbHNlCisJCQl0cmFjZSgib3Jw
aGFuZWQgbm9kZSAlcyBtb3ZlZCB0byBkb20wXG4iLCBub2RlLT5uYW1lKTsK
Kwl9IGVsc2UgeworCQlpZiAocm1fbm9kZShOVUxMLCBjdHgsIG5vZGUtPm5h
bWUpKSB7CisJCQkvKiBUaGF0J3MgdW5mb3J0dW5hdGUuIFdlIG9ubHkgY2Fu
IHRyeSB0byBjb250aW51ZS4gKi8KKwkJCXN5c2xvZyhMT0dfRVJSLAorCQkJ
ICAgICAgICJlcnJvciB3aGVuIGRlbGV0aW5nIG9ycGhhbmVkIG5vZGUgJXNc
biIsCisJCQkgICAgICAgbm9kZS0+bmFtZSk7CisJCX0gZWxzZQorCQkJdHJh
Y2UoIm9ycGhhbmVkIG5vZGUgJXMgZGVsZXRlZFxuIiwgbm9kZS0+bmFtZSk7
CisKKwkJLyogU2tpcCBjaGlsZHJlbiBpbiBhbGwgY2FzZXMgaW4gb3JkZXIg
dG8gYXZvaWQgbW9yZSBlcnJvcnMuICovCisJCXJldCA9IFdBTEtfVFJFRV9T
S0lQX0NISUxEUkVOOworCX0KKworCXJldHVybiBkb21haW4tPm5iZW50cnkg
PiAwID8gcmV0IDogV0FMS19UUkVFX1NVQ0NFU1NfU1RPUDsKK30KKworc3Rh
dGljIHZvaWQgZG9tYWluX3RyZWVfcmVtb3ZlKHN0cnVjdCBkb21haW4gKmRv
bWFpbikKK3sKKwlpbnQgcmV0OworCXN0cnVjdCB3YWxrX2Z1bmNzIHdhbGtm
dW5jcyA9IHsgLmVudGVyID0gZG9tYWluX3RyZWVfcmVtb3ZlX3N1YiB9Owor
CisJaWYgKGRvbWFpbi0+bmJlbnRyeSA+IDApIHsKKwkJcmV0ID0gd2Fsa19u
b2RlX3RyZWUoZG9tYWluLCBOVUxMLCAiLyIsICZ3YWxrZnVuY3MsIGRvbWFp
bik7CisJCWlmIChyZXQgPT0gV0FMS19UUkVFX0VSUk9SX1NUT1ApCisJCQlz
eXNsb2coTE9HX0VSUiwKKwkJCSAgICAgICAiZXJyb3Igd2hlbiBsb29raW5n
IGZvciBvcnBoYW5lZCBub2Rlc1xuIik7CisJfQorfQorCiBzdGF0aWMgaW50
IGRlc3Ryb3lfZG9tYWluKHZvaWQgKl9kb21haW4pCiB7CiAJc3RydWN0IGRv
bWFpbiAqZG9tYWluID0gX2RvbWFpbjsKIAorCWRvbWFpbl90cmVlX3JlbW92
ZShkb21haW4pOworCiAJbGlzdF9kZWwoJmRvbWFpbi0+bGlzdCk7CiAKIAlp
ZiAoIWRvbWFpbi0+aW50cm9kdWNlZCkKQEAgLTg4MywxNSArOTM3LDE1IEBA
IGludCBkb21haW5fZW50cnlfaW5jKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
LCBzdHJ1Y3Qgbm9kZSAqbm9kZSkKIAlzdHJ1Y3QgZG9tYWluICpkOwogCXVu
c2lnbmVkIGludCBkb21pZDsKIAotCWlmICghY29ubikKKwlpZiAoIW5vZGUt
PnBlcm1zLnApCiAJCXJldHVybiAwOwogCi0JZG9taWQgPSBub2RlLT5wZXJt
cy5wID8gbm9kZS0+cGVybXMucFswXS5pZCA6IGNvbm4tPmlkOworCWRvbWlk
ID0gbm9kZS0+cGVybXMucFswXS5pZDsKIAotCWlmIChjb25uLT50cmFuc2Fj
dGlvbikgeworCWlmIChjb25uICYmIGNvbm4tPnRyYW5zYWN0aW9uKSB7CiAJ
CXRyYW5zYWN0aW9uX2VudHJ5X2luYyhjb25uLT50cmFuc2FjdGlvbiwgZG9t
aWQpOwogCX0gZWxzZSB7Ci0JCWQgPSAoZG9taWQgPT0gY29ubi0+aWQgJiYg
Y29ubi0+ZG9tYWluKSA/IGNvbm4tPmRvbWFpbgorCQlkID0gKGNvbm4gJiYg
ZG9taWQgPT0gY29ubi0+aWQgJiYgY29ubi0+ZG9tYWluKSA/IGNvbm4tPmRv
bWFpbgogCQkgICAgOiBmaW5kX29yX2FsbG9jX2V4aXN0aW5nX2RvbWFpbihk
b21pZCk7CiAJCWlmIChkKQogCQkJZC0+bmJlbnRyeSsrOwpAQCAtOTUyLDIz
ICsxMDA2LDExIEBAIGludCBkb21haW5fYWxsb2NfcGVybXJlZnMoc3RydWN0
IG5vZGVfcGVybXMgKnBlcm1zKQogICogUmVtb3ZlIHBlcm1pc3Npb25zIGZv
ciBubyBsb25nZXIgZXhpc3RpbmcgZG9tYWlucyBpbiBvcmRlciB0byBhdm9p
ZCBhIG5ldwogICogZG9tYWluIHdpdGggdGhlIHNhbWUgZG9taWQgaW5oZXJp
dGluZyB0aGUgcGVybWlzc2lvbnMuCiAgKi8KLWludCBkb21haW5fYWRqdXN0
X25vZGVfcGVybXMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKQoraW50IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1
Y3Qgbm9kZSAqbm9kZSkKIHsKIAl1bnNpZ25lZCBpbnQgaTsKIAlpbnQgcmV0
OwogCi0JcmV0ID0gY2hrX2RvbWFpbl9nZW5lcmF0aW9uKG5vZGUtPnBlcm1z
LnBbMF0uaWQsIG5vZGUtPmdlbmVyYXRpb24pOwotCi0JLyogSWYgdGhlIG93
bmVyIGRvZXNuJ3QgZXhpc3QgYW55IGxvbmdlciBnaXZlIGl0IHRvIHByaXYg
ZG9tYWluLiAqLwotCWlmICghcmV0KSB7Ci0JCS8qCi0JCSAqIEluIHRoZW9y
eSB3ZSdkIG5lZWQgdG8gdXBkYXRlIHRoZSBudW1iZXIgb2YgZG9tMCBub2Rl
cyBoZXJlLAotCQkgKiBidXQgd2UgY291bGQgYmUgY2FsbGVkIGZvciBhIHJl
YWQgb2YgdGhlIG5vZGUuIFNvIGJldHRlcgotCQkgKiBhdm9pZCB0aGUgcmlz
ayB0byBvdmVyZmxvdyB0aGUgbm9kZSBjb3VudCBvZiBkb20wLgotCQkgKi8K
LQkJbm9kZS0+cGVybXMucFswXS5pZCA9IHByaXZfZG9taWQ7Ci0JfQotCiAJ
Zm9yIChpID0gMTsgaSA8IG5vZGUtPnBlcm1zLm51bTsgaSsrKSB7CiAJCWlm
IChub2RlLT5wZXJtcy5wW2ldLnBlcm1zICYgWFNfUEVSTV9JR05PUkUpCiAJ
CQljb250aW51ZTsKQEAgLTk4NiwxNSArMTAyOCwxNSBAQCB2b2lkIGRvbWFp
bl9lbnRyeV9kZWMoc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4sIHN0cnVjdCBu
b2RlICpub2RlKQogCXN0cnVjdCBkb21haW4gKmQ7CiAJdW5zaWduZWQgaW50
IGRvbWlkOwogCi0JaWYgKCFjb25uKQorCWlmICghbm9kZS0+cGVybXMucCkK
IAkJcmV0dXJuOwogCiAJZG9taWQgPSBub2RlLT5wZXJtcy5wID8gbm9kZS0+
cGVybXMucFswXS5pZCA6IGNvbm4tPmlkOwogCi0JaWYgKGNvbm4tPnRyYW5z
YWN0aW9uKSB7CisJaWYgKGNvbm4gJiYgY29ubi0+dHJhbnNhY3Rpb24pIHsK
IAkJdHJhbnNhY3Rpb25fZW50cnlfZGVjKGNvbm4tPnRyYW5zYWN0aW9uLCBk
b21pZCk7CiAJfSBlbHNlIHsKLQkJZCA9IChkb21pZCA9PSBjb25uLT5pZCAm
JiBjb25uLT5kb21haW4pID8gY29ubi0+ZG9tYWluCisJCWQgPSAoY29ubiAm
JiBkb21pZCA9PSBjb25uLT5pZCAmJiBjb25uLT5kb21haW4pID8gY29ubi0+
ZG9tYWluCiAJCSAgICA6IGZpbmRfZG9tYWluX3N0cnVjdChkb21pZCk7CiAJ
CWlmIChkKSB7CiAJCQlkLT5uYmVudHJ5LS07CkBAIC0xMTEzLDcgKzExNTUs
NyBAQCBpbnQgZG9tYWluX21lbW9yeV9hZGQodW5zaWduZWQgaW50IGRvbWlk
LCBpbnQgbWVtLCBib29sIG5vX3F1b3RhX2NoZWNrKQogCQkgKiBleGlzdCwg
YXMgYWNjb3VudGluZyBpcyBkb25lIGVpdGhlciBmb3IgYSBkb21haW4gcmVs
YXRlZCB0bwogCQkgKiB0aGUgY3VycmVudCBjb25uZWN0aW9uLCBvciBmb3Ig
dGhlIGRvbWFpbiBvd25pbmcgYSBub2RlCiAJCSAqICh3aGljaCBpcyBhbHdh
eXMgZXhpc3RpbmcsIGFzIHRoZSBvd25lciBvZiB0aGUgbm9kZSBpcwotCQkg
KiB0ZXN0ZWQgdG8gZXhpc3QgYW5kIHJlcGxhY2VkIGJ5IGRvbWlkIDAgaWYg
bm90KS4KKwkJICogdGVzdGVkIHRvIGV4aXN0IGFuZCBkZWxldGVkIG9yIHJl
cGxhY2VkIGJ5IGRvbWlkIDAgaWYgbm90KS4KIAkJICogU28gbm90IGZpbmRp
bmcgdGhlIHJlbGF0ZWQgZG9tYWluIE1VU1QgYmUgYW4gZXJyb3IgaW4gdGhl
CiAJCSAqIGRhdGEgYmFzZS4KIAkJICovCmRpZmYgLS1naXQgYS90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWluLmggYi90b29scy94ZW5zdG9yZS94
ZW5zdG9yZWRfZG9tYWluLmgKaW5kZXggN2ZlMGEyMWQ5ZTQ1Li5iMzhjODI5
OTFkYzYgMTAwNjQ0Ci0tLSBhL3Rvb2xzL3hlbnN0b3JlL3hlbnN0b3JlZF9k
b21haW4uaAorKysgYi90b29scy94ZW5zdG9yZS94ZW5zdG9yZWRfZG9tYWlu
LmgKQEAgLTYyLDcgKzYyLDcgQEAgY29uc3QgY2hhciAqZ2V0X2ltcGxpY2l0
X3BhdGgoY29uc3Qgc3RydWN0IGNvbm5lY3Rpb24gKmNvbm4pOwogYm9vbCBk
b21haW5faXNfdW5wcml2aWxlZ2VkKHN0cnVjdCBjb25uZWN0aW9uICpjb25u
KTsKIAogLyogUmVtb3ZlIG5vZGUgcGVybWlzc2lvbnMgZm9yIG5vIGxvbmdl
ciBleGlzdGluZyBkb21haW5zLiAqLwotaW50IGRvbWFpbl9hZGp1c3Rfbm9k
ZV9wZXJtcyhzdHJ1Y3QgY29ubmVjdGlvbiAqY29ubiwgc3RydWN0IG5vZGUg
Km5vZGUpOworaW50IGRvbWFpbl9hZGp1c3Rfbm9kZV9wZXJtcyhzdHJ1Y3Qg
bm9kZSAqbm9kZSk7CiBpbnQgZG9tYWluX2FsbG9jX3Blcm1yZWZzKHN0cnVj
dCBub2RlX3Blcm1zICpwZXJtcyk7CiAKIC8qIFF1b3RhIG1hbmlwdWxhdGlv
biAqLwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-xenstored-02.patch"
Content-Disposition: attachment; filename="xsa419/xsa419-xenstored-02.patch"
Content-Transfer-Encoding: base64

RnJvbSA5MjlkYTU1N2VmZWE2YzdkMjM0MDQ2N2Q5YTdmZGFlN2ZkYTZkMmIx
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogdG9vbHMveGVuc3RvcmU6IG1ha2UgdGhl
IGludGVybmFsIG1lbW9yeSBkYXRhIGJhc2UgdGhlIGRlZmF1bHQKCkhhdmlu
ZyBhIGZpbGUgYmFja2VkIGRhdGEgYmFzZSBoYXMgdGhlIG9ubHkgYWR2YW50
YWdlIG9mIGJlaW5nIGNhcGFibGUKdG8gZHVtcCB0aGUgY29udGVudHMgb2Yg
aXQgd2hpbGUgWGVuc3RvcmUgaXMgcnVubmluZywgYW5kIHBvdGVudGlhbGx5
CnVzaW5nIGxlc3Mgc3dhcCBzcGFjZSBpbiBjYXNlIHRoZSBkYXRhIGJhc2Ug
Y2FuJ3QgYmUga2VwdCBpbiBtZW1vcnkuCgpJdCBoYXMgdGhlIG1ham9yIGRp
c2FkdmFudGFnZSBvZiBhIGh1Z2UgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQ6IHN3
aXRjaGluZwp0byBrZWVwIHRoZSBkYXRhIGJhc2UgaW4gbWVtb3J5IG9ubHkg
c3BlZWRzIHVwIGxpdmUgdXBkYXRlIG9mIHhlbnN0b3JlZAp3aXRoIDEyMDAw
MCBub2RlcyBmcm9tIDIwIG1pbnV0ZXMgdG8gMTEgc2Vjb25kcy4gQSBjb21w
bGV0ZSB0cmVlIHdhbGsKb2YgdGhpcyBjb25maWd1cmF0aW9uIHdpbGwgYmUg
cmVkdWNlZCBmcm9tIDcgc2Vjb25kcyB0byAyODAgbXNlY3MKKG1lYXN1cmVk
IGJ5ICJ4ZW5zdG9yZS1jb250cm9sIGNoZWNrIikuCgpTbyBtYWtlIHRoZSBp
bnRlcm5hbCBtZW1vcnkgZGF0YSBiYXNlIHRoZSBkZWZhdWx0IGFuZCBlbmhh
bmNlIHRoZQoiLS1pbnRlcm5hbC1kYiIgY29tbWFuZCBsaW5lIHBhcmFtZXRl
ciB0byB0YWtlIGFuIG9wdGlvbmFsIHBhcmFtZXRlcgphbGxvd2luZyB0byBz
d2l0Y2ggdGhlIGludGVybmFsIGRhdGEgYmFzZSBiYWNrIHRvIHRoZSBmaWxl
IGJhc2VkIG9uZS4KClRoaXMgaXMgcGFydCBvZiBYU0EtNDE5LgoKUmVwb3J0
ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KU2lnbmVk
LW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgpSZXZp
ZXdlZC1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCmRp
ZmYgLS1naXQgYS90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWlu
LmMgYi90b29scy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKaW5k
ZXggMmQ5YWI2ZjFjNTgzLi4wNGUzNTFjYTI5YTggMTAwNjQ0Ci0tLSBhL3Rv
b2xzL2hlbHBlcnMvaW5pdC14ZW5zdG9yZS1kb21haW4uYworKysgYi90b29s
cy9oZWxwZXJzL2luaXQteGVuc3RvcmUtZG9tYWluLmMKQEAgLTIyMiw5ICsy
MjIsOSBAQCBzdGF0aWMgaW50IGJ1aWxkKHhjX2ludGVyZmFjZSAqeGNoKQog
ICAgIH0KIAogICAgIGlmICggcGFyYW0gKQotICAgICAgICBzbnByaW50Zihj
bWRsaW5lLCA1MTIsICItLWV2ZW50ICVkIC0taW50ZXJuYWwtZGIgJXMiLCBy
diwgcGFyYW0pOworICAgICAgICBzbnByaW50ZihjbWRsaW5lLCA1MTIsICIt
LWV2ZW50ICVkICVzIiwgcnYsIHBhcmFtKTsKICAgICBlbHNlCi0gICAgICAg
IHNucHJpbnRmKGNtZGxpbmUsIDUxMiwgIi0tZXZlbnQgJWQgLS1pbnRlcm5h
bC1kYiIsIHJ2KTsKKyAgICAgICAgc25wcmludGYoY21kbGluZSwgNTEyLCAi
LS1ldmVudCAlZCIsIHJ2KTsKIAogICAgIGRvbS0+Z3Vlc3RfZG9taWQgPSBk
b21pZDsKICAgICBkb20tPmNtZGxpbmUgPSB4Y19kb21fc3RyZHVwKGRvbSwg
Y21kbGluZSk7CmRpZmYgLS1naXQgYS90b29scy94ZW5zdG9yZS94ZW5zdG9y
ZWRfY29yZS5jIGIvdG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYwpp
bmRleCAxM2U0OGFhYTczMWMuLjM2ZmI0YTgzMjgzNCAxMDA2NDQKLS0tIGEv
dG9vbHMveGVuc3RvcmUveGVuc3RvcmVkX2NvcmUuYworKysgYi90b29scy94
ZW5zdG9yZS94ZW5zdG9yZWRfY29yZS5jCkBAIC0yMzA4LDcgKzIzMDgsNyBA
QCBzdGF0aWMgdm9pZCBhY2NlcHRfY29ubmVjdGlvbihpbnQgc29jaykKIH0K
ICNlbmRpZgogCi1zdGF0aWMgaW50IHRkYl9mbGFnczsKK3N0YXRpYyBpbnQg
dGRiX2ZsYWdzID0gVERCX0lOVEVSTkFMIHwgVERCX05PTE9DSzsKIAogLyog
V2UgY3JlYXRlIGluaXRpYWwgbm9kZXMgbWFudWFsbHkuICovCiBzdGF0aWMg
dm9pZCBtYW51YWxfbm9kZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFy
ICpjaGlsZCkKQEAgLTI2MTgsNyArMjYxOCw4IEBAIHN0YXRpYyB2b2lkIHVz
YWdlKHZvaWQpCiAiICAgICAgICAgICAgICAgICAgICAgICAgICB3YXRjaC1l
dmVudDogdGltZSBhIHdhdGNoLWV2ZW50IGlzIGtlcHQgcGVuZGluZ1xuIgog
IiAgLVIsIC0tbm8tcmVjb3ZlcnkgICAgICAgdG8gcmVxdWVzdCB0aGF0IG5v
IHJlY292ZXJ5IHNob3VsZCBiZSBhdHRlbXB0ZWQgd2hlblxuIgogIiAgICAg
ICAgICAgICAgICAgICAgICAgICAgdGhlIHN0b3JlIGlzIGNvcnJ1cHRlZCAo
ZGVidWcgb25seSksXG4iCi0iICAtSSwgLS1pbnRlcm5hbC1kYiAgICAgICBz
dG9yZSBkYXRhYmFzZSBpbiBtZW1vcnksIG5vdCBvbiBkaXNrXG4iCisiICAt
SSwgLS1pbnRlcm5hbC1kYiBbb258b2ZmXSBzdG9yZSBkYXRhYmFzZSBpbiBt
ZW1vcnksIG5vdCBvbiBkaXNrLCBkZWZhdWx0IGlzXG4iCisiICAgICAgICAg
ICAgICAgICAgICAgICAgICBtZW1vcnksIHdpdGggXCItLWludGVybmFsLWRi
IG9mZlwiIGl0IGlzIG9uIGRpc2tcbiIKICIgIC1LLCAtLWtlZXAtb3JwaGFu
cyAgICAgIGRvbid0IGRlbGV0ZSBub2RlcyBvd25lZCBieSBhIGRvbWFpbiB3
aGVuIHRoZVxuIgogIiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWlu
IGlzIGRlbGV0ZWQgKHRoaXMgaXMgYSBzZWN1cml0eSByaXNrISlcbiIKICIg
IC1WLCAtLXZlcmJvc2UgICAgICAgICAgIHRvIHJlcXVlc3QgdmVyYm9zZSBl
eGVjdXRpb24uXG4iKTsKQEAgLTI2NDQsNyArMjY0NSw3IEBAIHN0YXRpYyBz
dHJ1Y3Qgb3B0aW9uIG9wdGlvbnNbXSA9IHsKIAl7ICJxdW90YS1zb2Z0Iiwg
MSwgTlVMTCwgJ3EnIH0sCiAJeyAidGltZW91dCIsIDEsIE5VTEwsICd3JyB9
LAogCXsgIm5vLXJlY292ZXJ5IiwgMCwgTlVMTCwgJ1InIH0sCi0JeyAiaW50
ZXJuYWwtZGIiLCAwLCBOVUxMLCAnSScgfSwKKwl7ICJpbnRlcm5hbC1kYiIs
IDIsIE5VTEwsICdJJyB9LAogCXsgImtlZXAtb3JwaGFucyIsIDAsIE5VTEws
ICdLJyB9LAogCXsgInZlcmJvc2UiLCAwLCBOVUxMLCAnVicgfSwKIAl7ICJ3
YXRjaC1uYiIsIDEsIE5VTEwsICdXJyB9LApAQCAtMjcyNSw3ICsyNzI2LDgg
QEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAlvcmlnX2Fy
Z2MgPSBhcmdjOwogCW9yaWdfYXJndiA9IGFyZ3Y7CiAKLQl3aGlsZSAoKG9w
dCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJERTpGOkhLTlBTOnQ6QTpN
OlE6cTpUOlJWVzp3OlUiLAorCXdoaWxlICgob3B0ID0gZ2V0b3B0X2xvbmco
YXJnYywgYXJndiwKKwkJCQkgICJERTpGOkhJOjpLTlBTOnQ6QTpNOlE6cTpU
OlJWVzp3OlUiLAogCQkJCSAgb3B0aW9ucywgTlVMTCkpICE9IC0xKSB7CiAJ
CXN3aXRjaCAob3B0KSB7CiAJCWNhc2UgJ0QnOgpAQCAtMjc1OSw3ICsyNzYx
LDggQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIAkJCXRy
YWNlZmlsZSA9IG9wdGFyZzsKIAkJCWJyZWFrOwogCQljYXNlICdJJzoKLQkJ
CXRkYl9mbGFncyA9IFREQl9JTlRFUk5BTHxUREJfTk9MT0NLOworCQkJaWYg
KG9wdGFyZyAmJiAhc3RyY21wKG9wdGFyZywgIm9mZiIpKQorCQkJCXRkYl9m
bGFncyA9IDA7CiAJCQlicmVhazsKIAkJY2FzZSAnSyc6CiAJCQlrZWVwX29y
cGhhbnMgPSB0cnVlOwo=

--=separator
Content-Type: application/octet-stream;
 name="xsa419/xsa419-xenstored-03.patch"
Content-Disposition: attachment; filename="xsa419/xsa419-xenstored-03.patch"
Content-Transfer-Encoding: base64

RnJvbSA1NGU2M2I3ZTdjNDJlNGY5NzUxNjM4MDlhMDE1NzRlNzg1NTJhNmFi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKdWVyZ2VuIEdyb3Nz
IDxqZ3Jvc3NAc3VzZS5jb20+CkRhdGU6IFR1ZSwgMTMgU2VwIDIwMjIgMDc6
MzU6MTMgKzAyMDAKU3ViamVjdDogZG9jczogZW5oYW5jZSB4ZW5zdG9yZS50
eHQgd2l0aCBwZXJtaXNzaW9ucyBkZXNjcmlwdGlvbgpNSU1FLVZlcnNpb246
IDEuMApDb250ZW50LVR5cGU6IHRleHQvcGxhaW47IGNoYXJzZXQ9VVRGLTgK
Q29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogOGJpdAoKVGhlIHBlcm1pc3Np
b24gc2NoZW1lIG9mIFhlbnN0b3JlIG5vZGVzIGlzIG5vdCByZWFsbHkgY292
ZXJlZCBieQpkb2NzL21pc2MveGVuc3RvcmUudHh0LCBvdGhlciB0aGFuIHJl
ZmVycmluZyB0byB0aGUgWGVuIHdpa2kuCgpBZGQgYSBwYXJhZ3JhcGggZXhw
bGFpbmluZyB0aGUgcGVybWlzc2lvbnMgb2Ygbm9kZXMsIGFuZCBlc3BlY2lh
bGx5Cm1lbnRpb25pbmcgcmVtb3ZhbCBvZiBub2RlcyB3aGVuIGEgZG9tYWlu
IGhhcyBiZWVuIHJlbW92ZWQgZnJvbQpYZW5zdG9yZS4KClRoaXMgaXMgcGFy
dCBvZiBYU0EtNDE5LgoKUmVwb3J0ZWQtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpn
cm9zc0BzdXNlLmNvbT4KU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8
amdyb3NzQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogRWR3aW4gVMO2csO2ayA8
ZWR2aW4udG9yb2tAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFs
bCA8amdyYWxsQGFtYXpvbi5jb20+CgpkaWZmIC0tZ2l0IGEvZG9jcy9taXNj
L3hlbnN0b3JlLnR4dCBiL2RvY3MvbWlzYy94ZW5zdG9yZS50eHQKaW5kZXgg
OTg4ZWY4OWNiYTJkLi40NDQyOGFlM2E3NTUgMTAwNjQ0Ci0tLSBhL2RvY3Mv
bWlzYy94ZW5zdG9yZS50eHQKKysrIGIvZG9jcy9taXNjL3hlbnN0b3JlLnR4
dApAQCAtNDMsNiArNDMsMTcgQEAgYnl0ZXMgYXJlIGZvcmJpZGRlbjsgY2xp
ZW50cyBzcGVjaWZ5aW5nIHJlbGF0aXZlIHBhdGhzIHNob3VsZCBrZWVwCiB0
aGVtIHRvIHdpdGhpbiAyMDQ4IGJ5dGVzLiAgKFNlZSBYRU5TVE9SRV8qX1BB
VEhfTUFYIGluIHhzX3dpcmUuaC4pCiAKIAorRWFjaCBub2RlIGhhcyBvbmUg
b3IgbXVsdGlwbGUgcGVybWlzc2lvbiBlbnRyaWVzLiAgUGVybWlzc2lvbnMg
YXJlCitncmFudGVkIGJ5IGRvbWFpbi1pZCwgdGhlIGZpcnN0IHBlcm1pc3Np
b24gZW50cnkgb2YgZWFjaCBub2RlIHNwZWNpZmllcwordGhlIG93bmVyIG9m
IHRoZSBub2RlLiAgUGVybWlzc2lvbnMgb2YgYSBub2RlIGNhbiBiZSBjaGFu
Z2VkIGJ5IHRoZQorb3duZXIgb2YgdGhlIG5vZGUsIHRoZSBvd25lciBjYW4g
b25seSBiZSBtb2RpZmllZCBieSB0aGUgY29udHJvbAorZG9tYWluICh1c3Vh
bGx5IGRvbWFpbiBpZCAwKS4gIFRoZSBvd25lciBhbHdheXMgaGFzIHRoZSBy
aWdodCB0byByZWFkCithbmQgd3JpdGUgdGhlIG5vZGUsIHdoaWxlIG90aGVy
IHBlcm1pc3Npb25zIGNhbiBiZSBzZXR1cCB0byBhbGxvdworcmVhZCBhbmQv
b3Igd3JpdGUgYWNjZXNzLiAgV2hlbiBhIGRvbWFpbiBpcyBiZWluZyByZW1v
dmVkIGZyb20gWGVuc3RvcmUKK25vZGVzIG93bmVkIGJ5IHRoYXQgZG9tYWlu
IHdpbGwgYmUgcmVtb3ZlZCB0b2dldGhlciB3aXRoIGFsbCBvZiB0aG9zZQor
bm9kZXMnIGNoaWxkcmVuLgorCisKIENvbW11bmljYXRpb24gd2l0aCB4ZW5z
dG9yZSBpcyB2aWEgZWl0aGVyIHNvY2tldHMsIG9yIGV2ZW50IGNoYW5uZWwK
IGFuZCBzaGFyZWQgbWVtb3J5LCBhcyBzcGVjaWZpZWQgaW4gaW8veHNfd2ly
ZS5oOiBlYWNoIG1lc3NhZ2UgaW4KIGVpdGhlciBkaXJlY3Rpb24gaXMgYSBo
ZWFkZXIgZm9ybWF0dGVkIGFzIGEgc3RydWN0IHhzZF9zb2NrbXNnCg==

--=separator--


Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 51ACD18EA2A
	for <lists+xen-devel@lfdr.de>; Sun, 22 Mar 2020 17:17:13 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1jG3FL-0004dF-PJ; Sun, 22 Mar 2020 16:14:43 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=0EiK=5H=gmail.com=julien.grall.oss@srs-us1.protection.inumbo.net>)
 id 1jG3FK-0004cM-7b
 for xen-devel@lists.xenproject.org; Sun, 22 Mar 2020 16:14:42 +0000
X-Inumbo-ID: 3563f981-6c58-11ea-8134-12813bfff9fa
Received: from mail-ed1-f68.google.com (unknown [209.85.208.68])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 3563f981-6c58-11ea-8134-12813bfff9fa;
 Sun, 22 Mar 2020 16:14:30 +0000 (UTC)
Received: by mail-ed1-f68.google.com with SMTP id a20so13525357edj.2
 for <xen-devel@lists.xenproject.org>; Sun, 22 Mar 2020 09:14:30 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=lot+uUhxxAln3AbFbT8y1IzSnOaGANX3BPF4a2iVCls=;
 b=tL2Ziksg0sQkKEenvEjzJm03cYtJMBQD/7Ifc/yopggLoguAyqPNH2liv49/KyVz2m
 kyglCJJA0EJSnCebX2k6NWkM0RPBOfSSWmFLDH7rEsfNFh+W9cDoWgDKuQar6+vk58u+
 u8zDbhGH2qy0lorECuPltu5LrFytfsx7nVVntjqX843kqwRKeim9JyUqnyY4I+E/T7F8
 O72gUoU/S13Mp98Nc1Ty9xp+RWyCd4yxNjY2tGSWddTPkAyhqW/18qYzJheIrRnCBe5n
 FJQFS5+ZjQA8nZb71/6j2NyRSGcfGTi2Ym8o4IBTgGRcuxz5w+IO3LAp2suhnUx/5Iek
 N9Hw==
X-Gm-Message-State: ANhLgQ1tN/R9gRJCw93U+0/QlxezrvseT6jrc5NTEoEX7DC8NWL7rmQE
 UbvuB+Dn7Lgbzqe2JwQGIjF19/fkVuVgtQ==
X-Google-Smtp-Source: ADFU+vuTFpDHwvEr80tHYWVVAL4QQrOZ+xQMsWhzGRDu1nPGhxzfPx62CGMl/Orzm4/sHcjx5vpmkQ==
X-Received: by 2002:a17:906:b24d:: with SMTP id
 ce13mr2391697ejb.13.1584893667791; 
 Sun, 22 Mar 2020 09:14:27 -0700 (PDT)
Received: from ufe34d9ed68d054.ant.amazon.com (54-240-197-235.amazon.com.
 [54.240.197.235])
 by smtp.gmail.com with ESMTPSA id v13sm106693edj.62.2020.03.22.09.14.26
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sun, 22 Mar 2020 09:14:27 -0700 (PDT)
From: julien@xen.org
To: xen-devel@lists.xenproject.org
Date: Sun, 22 Mar 2020 16:14:05 +0000
Message-Id: <20200322161418.31606-5-julien@xen.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200322161418.31606-1-julien@xen.org>
References: <20200322161418.31606-1-julien@xen.org>
Subject: [Xen-devel] [PATCH 04/17] xen: Convert virt_to_mfn() and
 mfn_to_virt() to use typesafe MFN
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, julien@xen.org,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Julien Grall <jgrall@amazon.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Lukasz Hawrylko <lukasz.hawrylko@linux.intel.com>,
 Jan Beulich <jbeulich@suse.com>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KCk1vc3Qgb2YgWGVuIGlzIG5v
dyBlaXRoZXIgb3ZlcnJpZGUgdGhlIGhlbHBlcnMgdmlydF90b19tZm4oKSBhbmQKbWZuX3RvX3Zp
cnQoKSB0byB1c2UgdHlwZXNhZmUgTUZOIG9yIHVzZSBtZm5feCgpIHRvIHJlbW92ZSB0aGUKdHlw
ZXNhZmV0eSB3aGVuIGNhbGxpbmcgdGhlIGhlbHBlcnMuCgpUaGVyZWZvcmUgaXQgaXMgdGltZSB0
byBzd2l0Y2ggdGhlIHR3byBoZWxwZXJzIHRvIHVzZSB0eXBlc2FmZSBNRk4gYW5kCnJlbW92ZSBj
b21wbGV0ZWx5IHRoZSBwb3NzaWJseSB0byBtYWtlIHRoZW0gdW5zYWZlIGJ5IGRyb3BwaW5nIHRo
ZQpkb3VibGUtdW5kZXJzY29yZSB2ZXJzaW9uLgoKUGxhY2VzIHRoYXQgd2VyZSBzdGlsbCB1c2lu
ZyBub24tdHlwZXNhZmUgTUZOIGhhdmUgYmVlbiBlaXRoZXIKY29udmVydGVkIHRvIHVzZSB0eXBl
c2FmZSAoaWYgdGhlIGNoYW5nZXMgYXJlIHNpbXBsZSkgb3IgdXNlCl9tZm4oKS9tZm5feCgpIHVu
dGlsIHRoZSByZXN0IG9mIHRoZSBjb2RlIGlzIGNoYW5nZWQuCgpUaGVyZSBhcmUgYSBjb3VwbGUg
b2Ygbm90aWNlYWJsZSBjaGFuZ2VzIGluIHRoZSBjb2RlOgogICAgLSBwdmhfcG9wdWxhdGVfcDJt
KCkgd2VyZSBzdG9yaW5nIHRoZSBtZm4gaW4gYSB2YXJpYWJsZSBjYWxsZWQKICAgICAgJ2FkZHIn
LiBUaGlzIGhhcyBub3cgYmVlbiByZW5hbWVkIHRvICdtZm4nLgogICAgLSBhbGxvY2F0ZV9jYWNo
ZV9hbGlnbmVkX21lbW5vZGVtYXAoKSB3ZXJlIHN0b3JpbmcgYW4gYWRkcmVzcyBpbiBhCiAgICAg
IHZhcmlhYmxlIGNhbGxlZCAnbWZuJy4gVGhlIGNvZGUgaGFzIGJlZW4gcmV3b3JrZWQgdG8gYXZv
aWQKICAgICAgcmVwdXJwb3NpbmcgdGhlIHZhcmlhYmxlLgoKTm8gZnVuY3Rpb25hbCBjaGFuZ2Vz
IGludGVuZGVkLgoKU2lnbmVkLW9mZi1ieTogSnVsaWVuIEdyYWxsIDxqZ3JhbGxAYW1hem9uLmNv
bT4KLS0tCiB4ZW4vYXJjaC9hcm0vYWNwaS9kb21haW5fYnVpbGQuYyAgICB8ICA0IC0tLS0KIHhl
bi9hcmNoL2FybS9hbHRlcm5hdGl2ZS5jICAgICAgICAgIHwgIDQgLS0tLQogeGVuL2FyY2gvYXJt
L2NwdWVycmF0YS5jICAgICAgICAgICAgfCAgNCAtLS0tCiB4ZW4vYXJjaC9hcm0vZG9tYWluX2J1
aWxkLmMgICAgICAgICB8ICA0IC0tLS0KIHhlbi9hcmNoL2FybS9saXZlcGF0Y2guYyAgICAgICAg
ICAgIHwgIDQgLS0tLQogeGVuL2FyY2gvYXJtL21tLmMgICAgICAgICAgICAgICAgICAgfCAgOCAr
LS0tLS0tLQogeGVuL2FyY2gveDg2L2RvbWFpbl9wYWdlLmMgICAgICAgICAgfCAxMCArKysrKy0t
LS0tCiB4ZW4vYXJjaC94ODYvaHZtL2RvbTBfYnVpbGQuYyAgICAgICB8IDIwICsrKysrKysrKyst
LS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9tbS5jICAgICAgICAgICAgICAgICAgIHwgMzAgKysrKysr
KysrKysrKy0tLS0tLS0tLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9udW1hLmMgICAgICAgICAgICAg
ICAgIHwgIDggKysrLS0tLS0KIHhlbi9hcmNoL3g4Ni9wdi9kZXNjcmlwdG9yLXRhYmxlcy5jIHwg
IDIgKy0KIHhlbi9hcmNoL3g4Ni9wdi9kb20wX2J1aWxkLmMgICAgICAgIHwgIDQgKystLQogeGVu
L2FyY2gveDg2L3B2L3NoaW0uYyAgICAgICAgICAgICAgfCAgMyAtLS0KIHhlbi9hcmNoL3g4Ni9z
ZXR1cC5jICAgICAgICAgICAgICAgIHwgMTAgKysrKystLS0tLQogeGVuL2FyY2gveDg2L3NtcGJv
b3QuYyAgICAgICAgICAgICAgfCAgNCArKy0tCiB4ZW4vYXJjaC94ODYvc3JhdC5jICAgICAgICAg
ICAgICAgICB8ICAyICstCiB4ZW4vYXJjaC94ODYvdGJvb3QuYyAgICAgICAgICAgICAgICB8ICA0
ICsrLS0KIHhlbi9hcmNoL3g4Ni90cmFwcy5jICAgICAgICAgICAgICAgIHwgIDQgKystLQogeGVu
L2FyY2gveDg2L3g4Nl82NC9tbS5jICAgICAgICAgICAgfCAxMyArKysrKysrLS0tLS0tCiB4ZW4v
Y29tbW9uL2RvbWN0bC5jICAgICAgICAgICAgICAgICB8ICAzICsrLQogeGVuL2NvbW1vbi9lZmkv
Ym9vdC5jICAgICAgICAgICAgICAgfCAgNyArKysrLS0tCiB4ZW4vY29tbW9uL2dyYW50X3RhYmxl
LmMgICAgICAgICAgICB8ICA4ICsrKystLS0tCiB4ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYyAgICAg
ICAgICAgICB8IDE4ICsrKysrKysrLS0tLS0tLS0tCiB4ZW4vY29tbW9uL3RyYWNlLmMgICAgICAg
ICAgICAgICAgICB8IDE5ICsrKysrKysrKy0tLS0tLS0tLQogeGVuL2NvbW1vbi94ZW5vcHJvZi5j
ICAgICAgICAgICAgICAgfCAgNCAtLS0tCiB4ZW4vZHJpdmVycy9hY3BpL29zbC5jICAgICAgICAg
ICAgICB8ICAyICstCiB4ZW4vaW5jbHVkZS9hc20tYXJtL21tLmggICAgICAgICAgICB8IDE0ICsr
Ky0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L2dyYW50X3RhYmxlLmggICB8ICA0ICsr
LS0KIHhlbi9pbmNsdWRlL2FzbS14ODYvbW0uaCAgICAgICAgICAgIHwgIDIgKy0KIHhlbi9pbmNs
dWRlL2FzbS14ODYvcGFnZS5oICAgICAgICAgIHwgIDYgKystLS0tCiB4ZW4vaW5jbHVkZS94ZW4v
ZG9tYWluX3BhZ2UuaCAgICAgICB8ICA2ICsrKy0tLQogMzEgZmlsZXMgY2hhbmdlZCwgOTYgaW5z
ZXJ0aW9ucygrKSwgMTM5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9h
Y3BpL2RvbWFpbl9idWlsZC5jIGIveGVuL2FyY2gvYXJtL2FjcGkvZG9tYWluX2J1aWxkLmMKaW5k
ZXggMWIxY2ZhYmIwMC4uYjNhYzMyZjYwMSAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL2FjcGkv
ZG9tYWluX2J1aWxkLmMKKysrIGIveGVuL2FyY2gvYXJtL2FjcGkvZG9tYWluX2J1aWxkLmMKQEAg
LTIwLDEwICsyMCw2IEBACiAjaW5jbHVkZSA8YXNtL2tlcm5lbC5oPgogI2luY2x1ZGUgPGFzbS9k
b21haW5fYnVpbGQuaD4KIAotLyogT3ZlcnJpZGUgbWFjcm9zIGZyb20gYXNtL3BhZ2UuaCB0byBt
YWtlIHRoZW0gd29yayB3aXRoIG1mbl90ICovCi0jdW5kZWYgdmlydF90b19tZm4KLSNkZWZpbmUg
dmlydF90b19tZm4odmEpIF9tZm4oX192aXJ0X3RvX21mbih2YSkpCi0KICNkZWZpbmUgQUNQSV9E
T00wX0ZEVF9NSU5fU0laRSA0MDk2CiAKIHN0YXRpYyBpbnQgX19pbml0IGFjcGlfaW9tZW1fZGVu
eV9hY2Nlc3Moc3RydWN0IGRvbWFpbiAqZCkKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9hbHRl
cm5hdGl2ZS5jIGIveGVuL2FyY2gvYXJtL2FsdGVybmF0aXZlLmMKaW5kZXggMjM3YzRlNTY0Mi4u
NzI0YjBiMTg3ZSAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL2FsdGVybmF0aXZlLmMKKysrIGIv
eGVuL2FyY2gvYXJtL2FsdGVybmF0aXZlLmMKQEAgLTMyLDEwICszMiw2IEBACiAjaW5jbHVkZSA8
YXNtL2luc24uaD4KICNpbmNsdWRlIDxhc20vcGFnZS5oPgogCi0vKiBPdmVycmlkZSBtYWNyb3Mg
ZnJvbSBhc20vcGFnZS5oIHRvIG1ha2UgdGhlbSB3b3JrIHdpdGggbWZuX3QgKi8KLSN1bmRlZiB2
aXJ0X3RvX21mbgotI2RlZmluZSB2aXJ0X3RvX21mbih2YSkgX21mbihfX3ZpcnRfdG9fbWZuKHZh
KSkKLQogZXh0ZXJuIGNvbnN0IHN0cnVjdCBhbHRfaW5zdHIgX19hbHRfaW5zdHJ1Y3Rpb25zW10s
IF9fYWx0X2luc3RydWN0aW9uc19lbmRbXTsKIAogc3RydWN0IGFsdF9yZWdpb24gewpkaWZmIC0t
Z2l0IGEveGVuL2FyY2gvYXJtL2NwdWVycmF0YS5jIGIveGVuL2FyY2gvYXJtL2NwdWVycmF0YS5j
CmluZGV4IDAyNDg4OTNkZTAuLjY4MTA1ZmU5MWYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL2FybS9j
cHVlcnJhdGEuYworKysgYi94ZW4vYXJjaC9hcm0vY3B1ZXJyYXRhLmMKQEAgLTE0LDEwICsxNCw2
IEBACiAjaW5jbHVkZSA8YXNtL2luc24uaD4KICNpbmNsdWRlIDxhc20vcHNjaS5oPgogCi0vKiBP
dmVycmlkZSBtYWNyb3MgZnJvbSBhc20vcGFnZS5oIHRvIG1ha2UgdGhlbSB3b3JrIHdpdGggbWZu
X3QgKi8KLSN1bmRlZiB2aXJ0X3RvX21mbgotI2RlZmluZSB2aXJ0X3RvX21mbih2YSkgX21mbihf
X3ZpcnRfdG9fbWZuKHZhKSkKLQogLyogSGFyZGVuaW5nIEJyYW5jaCBwcmVkaWN0b3IgY29kZSBm
b3IgQXJtNjQgKi8KICNpZmRlZiBDT05GSUdfQVJNNjRfSEFSREVOX0JSQU5DSF9QUkVESUNUT1IK
IApkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jIGIveGVuL2FyY2gvYXJt
L2RvbWFpbl9idWlsZC5jCmluZGV4IDQzMDcwODc1MzYuLjVjOWE1NWYwODQgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYworKysgYi94ZW4vYXJjaC9hcm0vZG9tYWluX2J1
aWxkLmMKQEAgLTUyLDEwICs1Miw2IEBAIHN0cnVjdCBtYXBfcmFuZ2VfZGF0YQogICAgIHAybV90
eXBlX3QgcDJtdDsKIH07CiAKLS8qIE92ZXJyaWRlIG1hY3JvcyBmcm9tIGFzbS9wYWdlLmggdG8g
bWFrZSB0aGVtIHdvcmsgd2l0aCBtZm5fdCAqLwotI3VuZGVmIHZpcnRfdG9fbWZuCi0jZGVmaW5l
IHZpcnRfdG9fbWZuKHZhKSBfbWZuKF9fdmlydF90b19tZm4odmEpKQotCiAvLyNkZWZpbmUgREVC
VUdfMTFfQUxMT0NBVElPTgogI2lmZGVmIERFQlVHXzExX0FMTE9DQVRJT04KICMgZGVmaW5lIEQx
MVBSSU5UKGZtdCwgYXJncy4uLikgcHJpbnRrKFhFTkxPR19ERUJVRyBmbXQsICMjYXJncykKZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9saXZlcGF0Y2guYyBiL3hlbi9hcmNoL2FybS9saXZlcGF0
Y2guYwppbmRleCA5MTVlOWQ5MjZhLi4wZmZkZGE2MDA1IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9h
cm0vbGl2ZXBhdGNoLmMKKysrIGIveGVuL2FyY2gvYXJtL2xpdmVwYXRjaC5jCkBAIC0xMiwxMCAr
MTIsNiBAQAogI2luY2x1ZGUgPGFzbS9saXZlcGF0Y2guaD4KICNpbmNsdWRlIDxhc20vbW0uaD4K
IAotLyogT3ZlcnJpZGUgbWFjcm9zIGZyb20gYXNtL3BhZ2UuaCB0byBtYWtlIHRoZW0gd29yayB3
aXRoIG1mbl90ICovCi0jdW5kZWYgdmlydF90b19tZm4KLSNkZWZpbmUgdmlydF90b19tZm4odmEp
IF9tZm4oX192aXJ0X3RvX21mbih2YSkpCi0KIHZvaWQgKnZtYXBfb2ZfeGVuX3RleHQ7CiAKIGlu
dCBhcmNoX2xpdmVwYXRjaF9zYWZldHlfY2hlY2sodm9pZCkKZGlmZiAtLWdpdCBhL3hlbi9hcmNo
L2FybS9tbS5jIGIveGVuL2FyY2gvYXJtL21tLmMKaW5kZXggNzI3MTA3ZWVmYS4uMTA3NWU1ZmNh
ZiAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL21tLmMKKysrIGIveGVuL2FyY2gvYXJtL21tLmMK
QEAgLTQzLDEyICs0Myw2IEBACiAKICNpbmNsdWRlIDxhc20vc2V0dXAuaD4KIAotLyogT3ZlcnJp
ZGUgbWFjcm9zIGZyb20gYXNtL3BhZ2UuaCB0byBtYWtlIHRoZW0gd29yayB3aXRoIG1mbl90ICov
Ci0jdW5kZWYgdmlydF90b19tZm4KLSNkZWZpbmUgdmlydF90b19tZm4odmEpIF9tZm4oX192aXJ0
X3RvX21mbih2YSkpCi0jdW5kZWYgbWZuX3RvX3ZpcnQKLSNkZWZpbmUgbWZuX3RvX3ZpcnQobWZu
KSBfX21mbl90b192aXJ0KG1mbl94KG1mbikpCi0KICNpZmRlZiBOREVCVUcKIHN0YXRpYyBpbmxp
bmUgdm9pZAogX19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRmX18sIDEsIDIpKSkK
QEAgLTgzNSw3ICs4MjksNyBAQCB2b2lkIF9faW5pdCBzZXR1cF94ZW5oZWFwX21hcHBpbmdzKHVu
c2lnbmVkIGxvbmcgYmFzZV9tZm4sCiAgICAgICogVmlydHVhbCBhZGRyZXNzIGFsaWduZWQgdG8g
cHJldmlvdXMgMUdCIHRvIG1hdGNoIHBoeXNpY2FsCiAgICAgICogYWRkcmVzcyBhbGlnbm1lbnQg
ZG9uZSBhYm92ZS4KICAgICAgKi8KLSAgICB2YWRkciA9ICh2YWRkcl90KV9fbWZuX3RvX3ZpcnQo
YmFzZV9tZm4pICYgRklSU1RfTUFTSzsKKyAgICB2YWRkciA9ICh2YWRkcl90KW1mbl90b192aXJ0
KF9tZm4oYmFzZV9tZm4pKSAmIEZJUlNUX01BU0s7CiAKICAgICB3aGlsZSAoIG1mbiA8IGVuZF9t
Zm4gKQogICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9kb21haW5fcGFnZS5jIGIveGVu
L2FyY2gveDg2L2RvbWFpbl9wYWdlLmMKaW5kZXggZGQzMjcxMmQyZi4uOGI4YmY0Y2JlOCAxMDA2
NDQKLS0tIGEveGVuL2FyY2gveDg2L2RvbWFpbl9wYWdlLmMKKysrIGIveGVuL2FyY2gveDg2L2Rv
bWFpbl9wYWdlLmMKQEAgLTc4LDE3ICs3OCwxNyBAQCB2b2lkICptYXBfZG9tYWluX3BhZ2UobWZu
X3QgbWZuKQogCiAjaWZkZWYgTkRFQlVHCiAgICAgaWYgKCBtZm5feChtZm4pIDw9IFBGTl9ET1dO
KF9fcGEoSFlQRVJWSVNPUl9WSVJUX0VORCAtIDEpKSApCi0gICAgICAgIHJldHVybiBtZm5fdG9f
dmlydChtZm5feChtZm4pKTsKKyAgICAgICAgcmV0dXJuIG1mbl90b192aXJ0KG1mbik7CiAjZW5k
aWYKIAogICAgIHYgPSBtYXBjYWNoZV9jdXJyZW50X3ZjcHUoKTsKICAgICBpZiAoICF2IHx8ICFp
c19wdl92Y3B1KHYpICkKLSAgICAgICAgcmV0dXJuIG1mbl90b192aXJ0KG1mbl94KG1mbikpOwor
ICAgICAgICByZXR1cm4gbWZuX3RvX3ZpcnQobWZuKTsKIAogICAgIGRjYWNoZSA9ICZ2LT5kb21h
aW4tPmFyY2gucHYubWFwY2FjaGU7CiAgICAgdmNhY2hlID0gJnYtPmFyY2gucHYubWFwY2FjaGU7
CiAgICAgaWYgKCAhZGNhY2hlLT5pbnVzZSApCi0gICAgICAgIHJldHVybiBtZm5fdG9fdmlydCht
Zm5feChtZm4pKTsKKyAgICAgICAgcmV0dXJuIG1mbl90b192aXJ0KG1mbik7CiAKICAgICBwZXJm
Y19pbmNyKG1hcF9kb21haW5fcGFnZV9jb3VudCk7CiAKQEAgLTMxMSw3ICszMTEsNyBAQCB2b2lk
ICptYXBfZG9tYWluX3BhZ2VfZ2xvYmFsKG1mbl90IG1mbikKIAogI2lmZGVmIE5ERUJVRwogICAg
IGlmICggbWZuX3gobWZuKSA8PSBQRk5fRE9XTihfX3BhKEhZUEVSVklTT1JfVklSVF9FTkQgLSAx
KSkgKQotICAgICAgICByZXR1cm4gbWZuX3RvX3ZpcnQobWZuX3gobWZuKSk7CisgICAgICAgIHJl
dHVybiBtZm5fdG9fdmlydChtZm4pOwogI2VuZGlmCiAKICAgICByZXR1cm4gdm1hcCgmbWZuLCAx
KTsKQEAgLTMzNiw3ICszMzYsNyBAQCBtZm5fdCBkb21haW5fcGFnZV9tYXBfdG9fbWZuKGNvbnN0
IHZvaWQgKnB0cikKICAgICBjb25zdCBsMV9wZ2VudHJ5X3QgKnBsMWU7CiAKICAgICBpZiAoIHZh
ID49IERJUkVDVE1BUF9WSVJUX1NUQVJUICkKLSAgICAgICAgcmV0dXJuIF9tZm4odmlydF90b19t
Zm4ocHRyKSk7CisgICAgICAgIHJldHVybiB2aXJ0X3RvX21mbihwdHIpOwogCiAgICAgaWYgKCB2
YSA+PSBWTUFQX1ZJUlRfU1RBUlQgJiYgdmEgPCBWTUFQX1ZJUlRfRU5EICkKICAgICB7CmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL2RvbTBfYnVpbGQuYyBiL3hlbi9hcmNoL3g4Ni9odm0v
ZG9tMF9idWlsZC5jCmluZGV4IDJhZmQ0NGM4YTQuLjE0M2I3ZTBhM2MgMTAwNjQ0Ci0tLSBhL3hl
bi9hcmNoL3g4Ni9odm0vZG9tMF9idWlsZC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vZG9tMF9i
dWlsZC5jCkBAIC00NDQsMzEgKzQ0NCwzMiBAQCBzdGF0aWMgaW50IF9faW5pdCBwdmhfcG9wdWxh
dGVfcDJtKHN0cnVjdCBkb21haW4gKmQpCiAgICAgLyogUG9wdWxhdGUgbWVtb3J5IG1hcC4gKi8K
ICAgICBmb3IgKCBpID0gMDsgaSA8IGQtPmFyY2gubnJfZTgyMDsgaSsrICkKICAgICB7Ci0gICAg
ICAgIHVuc2lnbmVkIGxvbmcgYWRkciwgc2l6ZTsKKyAgICAgICAgbWZuX3QgbWZuOworICAgICAg
ICB1bnNpZ25lZCBsb25nIHNpemU7CiAKICAgICAgICAgaWYgKCBkLT5hcmNoLmU4MjBbaV0udHlw
ZSAhPSBFODIwX1JBTSApCiAgICAgICAgICAgICBjb250aW51ZTsKIAotICAgICAgICBhZGRyID0g
UEZOX0RPV04oZC0+YXJjaC5lODIwW2ldLmFkZHIpOworICAgICAgICBtZm4gPSBtYWRkcl90b19t
Zm4oZC0+YXJjaC5lODIwW2ldLmFkZHIpOwogICAgICAgICBzaXplID0gUEZOX0RPV04oZC0+YXJj
aC5lODIwW2ldLnNpemUpOwogCi0gICAgICAgIHJjID0gcHZoX3BvcHVsYXRlX21lbW9yeV9yYW5n
ZShkLCBhZGRyLCBzaXplKTsKKyAgICAgICAgcmMgPSBwdmhfcG9wdWxhdGVfbWVtb3J5X3Jhbmdl
KGQsIG1mbl94KG1mbiksIHNpemUpOwogICAgICAgICBpZiAoIHJjICkKICAgICAgICAgICAgIHJl
dHVybiByYzsKIAotICAgICAgICBpZiAoIGFkZHIgPCBNQjFfUEFHRVMgKQorICAgICAgICBpZiAo
IG1mbl94KG1mbikgPCBNQjFfUEFHRVMgKQogICAgICAgICB7CiAgICAgICAgICAgICB1aW50NjRf
dCBlbmQgPSBtaW5fdCh1aW50NjRfdCwgTUIoMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBkLT5hcmNoLmU4MjBbaV0uYWRkciArIGQtPmFyY2guZTgyMFtpXS5zaXplKTsKICAg
ICAgICAgICAgIGVudW0gaHZtX3RyYW5zbGF0aW9uX3Jlc3VsdCByZXMgPQotICAgICAgICAgICAg
ICAgICBodm1fY29weV90b19ndWVzdF9waHlzKG1mbl90b19tYWRkcihfbWZuKGFkZHIpKSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5fdG9fdmlydChhZGRyKSwK
KyAgICAgICAgICAgICAgICAgaHZtX2NvcHlfdG9fZ3Vlc3RfcGh5cyhtZm5fdG9fbWFkZHIobWZu
KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZm5fdG9fdmlydCht
Zm4pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQtPmFyY2guZTgy
MFtpXS5hZGRyIC0gZW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHYpOwogCiAgICAgICAgICAgICBpZiAoIHJlcyAhPSBIVk1UUkFOU19va2F5ICkKLSAgICAgICAg
ICAgICAgICBwcmludGsoIkZhaWxlZCB0byBjb3B5IFslI2x4LCAlI2x4KTogJWRcbiIsCi0gICAg
ICAgICAgICAgICAgICAgICAgIGFkZHIsIGFkZHIgKyBzaXplLCByZXMpOworICAgICAgICAgICAg
ICAgIHByaW50aygiRmFpbGVkIHRvIGNvcHkgWyUiUFJJX21mbiIsICUiUFJJX21mbiIpOiAlZFxu
IiwKKyAgICAgICAgICAgICAgICAgICAgICAgbWZuX3gobWZuKSwgbWZuX3gobWZuX2FkZChtZm4s
IHNpemUpKSwgcmVzKTsKICAgICAgICAgfQogICAgIH0KIApAQCAtNjA3LDcgKzYwOCw4IEBAIHN0
YXRpYyBpbnQgX19pbml0IHB2aF9sb2FkX2tlcm5lbChzdHJ1Y3QgZG9tYWluICpkLCBjb25zdCBt
b2R1bGVfdCAqaW1hZ2UsCiAKICAgICBpZiAoIGluaXRyZCAhPSBOVUxMICkKICAgICB7Ci0gICAg
ICAgIHJjID0gaHZtX2NvcHlfdG9fZ3Vlc3RfcGh5cyhsYXN0X2FkZHIsIG1mbl90b192aXJ0KGlu
aXRyZC0+bW9kX3N0YXJ0KSwKKyAgICAgICAgcmMgPSBodm1fY29weV90b19ndWVzdF9waHlzKGxh
c3RfYWRkciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90b192aXJ0
KF9tZm4oaW5pdHJkLT5tb2Rfc3RhcnQpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGluaXRyZC0+bW9kX2VuZCwgdik7CiAgICAgICAgIGlmICggcmMgKQogICAgICAgICB7
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4
IDA2OWE2MWRlYjguLjdjMGY4MTc1OWEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisr
KyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC0xNTIsMTAgKzE1Miw2IEBACiAjaW5jbHVkZSAicHYv
bW0uaCIKICNlbmRpZgogCi0vKiBPdmVycmlkZSBtYWNyb3MgZnJvbSBhc20vcGFnZS5oIHRvIG1h
a2UgdGhlbSB3b3JrIHdpdGggbWZuX3QgKi8KLSN1bmRlZiB2aXJ0X3RvX21mbgotI2RlZmluZSB2
aXJ0X3RvX21mbih2KSBfbWZuKF9fdmlydF90b19tZm4odikpCi0KIC8qIE1hcHBpbmcgb2YgdGhl
IGZpeG1hcCBzcGFjZSBuZWVkZWQgZWFybHkuICovCiBsMV9wZ2VudHJ5X3QgX19zZWN0aW9uKCIu
YnNzLnBhZ2VfYWxpZ25lZCIpIF9fYWxpZ25lZChQQUdFX1NJWkUpCiAgICAgbDFfZml4bWFwW0wx
X1BBR0VUQUJMRV9FTlRSSUVTXTsKQEAgLTMyMyw4ICszMTksOCBAQCB2b2lkIF9faW5pdCBhcmNo
X2luaXRfbWVtb3J5KHZvaWQpCiAgICAgICAgIGlvc3RhcnRfcGZuID0gbWF4X3QodW5zaWduZWQg
bG9uZywgcGZuLCAxVUwgPDwgKDIwIC0gUEFHRV9TSElGVCkpOwogICAgICAgICBpb2VuZF9wZm4g
PSBtaW4ocnN0YXJ0X3BmbiwgMTZVTCA8PCAoMjAgLSBQQUdFX1NISUZUKSk7CiAgICAgICAgIGlm
ICggaW9zdGFydF9wZm4gPCBpb2VuZF9wZm4gKQotICAgICAgICAgICAgZGVzdHJveV94ZW5fbWFw
cGluZ3MoKHVuc2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaW9zdGFydF9wZm4pLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKHVuc2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaW9lbmRf
cGZuKSk7CisgICAgICAgICAgICBkZXN0cm95X3hlbl9tYXBwaW5ncygodW5zaWduZWQgbG9uZylt
Zm5fdG9fdmlydChfbWZuKGlvc3RhcnRfcGZuKSksCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAodW5zaWduZWQgbG9uZyltZm5fdG9fdmlydChfbWZuKGlvZW5kX3BmbikpKTsKIAog
ICAgICAgICAvKiBNYXJrIGFzIEkvTyB1cCB0byBuZXh0IFJBTSByZWdpb24uICovCiAgICAgICAg
IGZvciAoIDsgcGZuIDwgcnN0YXJ0X3BmbjsgcGZuKysgKQpAQCAtNzg1LDIxICs3ODEsMjEgQEAg
Ym9vbCBpc19pb21lbV9wYWdlKG1mbl90IG1mbikKICAgICByZXR1cm4gKHBhZ2VfZ2V0X293bmVy
KHBhZ2UpID09IGRvbV9pbyk7CiB9CiAKLXN0YXRpYyBpbnQgdXBkYXRlX3hlbl9tYXBwaW5ncyh1
bnNpZ25lZCBsb25nIG1mbiwgdW5zaWduZWQgaW50IGNhY2hlYXR0cikKK3N0YXRpYyBpbnQgdXBk
YXRlX3hlbl9tYXBwaW5ncyhtZm5fdCBtZm4sIHVuc2lnbmVkIGludCBjYWNoZWF0dHIpCiB7CiAg
ICAgaW50IGVyciA9IDA7Ci0gICAgYm9vbCBhbGlhcyA9IG1mbiA+PSBQRk5fRE9XTih4ZW5fcGh5
c19zdGFydCkgJiYKLSAgICAgICAgIG1mbiA8IFBGTl9VUCh4ZW5fcGh5c19zdGFydCArIHhlbl92
aXJ0X2VuZCAtIFhFTl9WSVJUX1NUQVJUKTsKKyAgICBib29sIGFsaWFzID0gbWZuX3gobWZuKSA+
PSBQRk5fRE9XTih4ZW5fcGh5c19zdGFydCkgJiYKKyAgICAgICAgIG1mbl94KG1mbikgPCBQRk5f
VVAoeGVuX3BoeXNfc3RhcnQgKyB4ZW5fdmlydF9lbmQgLSBYRU5fVklSVF9TVEFSVCk7CiAgICAg
dW5zaWduZWQgbG9uZyB4ZW5fdmEgPQotICAgICAgICBYRU5fVklSVF9TVEFSVCArICgobWZuIC0g
UEZOX0RPV04oeGVuX3BoeXNfc3RhcnQpKSA8PCBQQUdFX1NISUZUKTsKKyAgICAgICAgWEVOX1ZJ
UlRfU1RBUlQgKyBtZm5fdG9fbWFkZHIobWZuX2FkZChtZm4sIC1QRk5fRE9XTih4ZW5fcGh5c19z
dGFydCkpKTsKIAogICAgIGlmICggdW5saWtlbHkoYWxpYXMpICYmIGNhY2hlYXR0ciApCi0gICAg
ICAgIGVyciA9IG1hcF9wYWdlc190b194ZW4oeGVuX3ZhLCBfbWZuKG1mbiksIDEsIDApOworICAg
ICAgICBlcnIgPSBtYXBfcGFnZXNfdG9feGVuKHhlbl92YSwgbWZuLCAxLCAwKTsKICAgICBpZiAo
ICFlcnIgKQotICAgICAgICBlcnIgPSBtYXBfcGFnZXNfdG9feGVuKCh1bnNpZ25lZCBsb25nKW1m
bl90b192aXJ0KG1mbiksIF9tZm4obWZuKSwgMSwKKyAgICAgICAgZXJyID0gbWFwX3BhZ2VzX3Rv
X3hlbigodW5zaWduZWQgbG9uZyltZm5fdG9fdmlydChtZm4pLCBtZm4sIDEsCiAgICAgICAgICAg
ICAgICAgICAgICBQQUdFX0hZUEVSVklTT1IgfCBjYWNoZWF0dHJfdG9fcHRlX2ZsYWdzKGNhY2hl
YXR0cikpOwogICAgIGlmICggdW5saWtlbHkoYWxpYXMpICYmICFjYWNoZWF0dHIgJiYgIWVyciAp
Ci0gICAgICAgIGVyciA9IG1hcF9wYWdlc190b194ZW4oeGVuX3ZhLCBfbWZuKG1mbiksIDEsIFBB
R0VfSFlQRVJWSVNPUik7CisgICAgICAgIGVyciA9IG1hcF9wYWdlc190b194ZW4oeGVuX3ZhLCBt
Zm4sIDEsIFBBR0VfSFlQRVJWSVNPUik7CiAgICAgcmV0dXJuIGVycjsKIH0KIApAQCAtMTAyOSw3
ICsxMDI1LDcgQEAgZ2V0X3BhZ2VfZnJvbV9sMWUoCiAgICAgICAgICAgICBueCA9ICh4ICYgflBH
Q19jYWNoZWF0dHJfbWFzaykgfCAoY2FjaGVhdHRyIDw8IFBHQ19jYWNoZWF0dHJfYmFzZSk7CiAg
ICAgICAgIH0gd2hpbGUgKCAoeSA9IGNtcHhjaGcoJnBhZ2UtPmNvdW50X2luZm8sIHgsIG54KSkg
IT0geCApOwogCi0gICAgICAgIGVyciA9IHVwZGF0ZV94ZW5fbWFwcGluZ3MobWZuLCBjYWNoZWF0
dHIpOworICAgICAgICBlcnIgPSB1cGRhdGVfeGVuX21hcHBpbmdzKF9tZm4obWZuKSwgY2FjaGVh
dHRyKTsKICAgICAgICAgaWYgKCB1bmxpa2VseShlcnIpICkKICAgICAgICAgewogICAgICAgICAg
ICAgY2FjaGVhdHRyID0geSAmIFBHQ19jYWNoZWF0dHJfbWFzazsKQEAgLTI0NDksNyArMjQ0NSw3
IEBAIHN0YXRpYyBpbnQgY2xlYW51cF9wYWdlX21hcHBpbmdzKHN0cnVjdCBwYWdlX2luZm8gKnBh
Z2UpCiAKICAgICAgICAgQlVHX09OKGlzX3hlbl9oZWFwX3BhZ2UocGFnZSkpOwogCi0gICAgICAg
IHJjID0gdXBkYXRlX3hlbl9tYXBwaW5ncyhtZm4sIDApOworICAgICAgICByYyA9IHVwZGF0ZV94
ZW5fbWFwcGluZ3MoX21mbihtZm4pLCAwKTsKICAgICB9CiAKICAgICAvKgpAQCAtNDk1MCw3ICs0
OTQ2LDcgQEAgdm9pZCAqYWxsb2NfeGVuX3BhZ2V0YWJsZSh2b2lkKQogewogICAgIG1mbl90IG1m
biA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CiAKLSAgICByZXR1cm4gbWZuX2VxKG1mbiwg
SU5WQUxJRF9NRk4pID8gTlVMTCA6IG1mbl90b192aXJ0KG1mbl94KG1mbikpOworICAgIHJldHVy
biBtZm5fZXEobWZuLCBJTlZBTElEX01GTikgPyBOVUxMIDogbWZuX3RvX3ZpcnQobWZuKTsKIH0K
IAogdm9pZCBmcmVlX3hlbl9wYWdldGFibGUodm9pZCAqdikKQEAgLTQ5ODMsNyArNDk3OSw3IEBA
IG1mbl90IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KHZvaWQpCiB2b2lkIGZyZWVfeGVuX3BhZ2V0
YWJsZV9uZXcobWZuX3QgbWZuKQogewogICAgIGlmICggc3lzdGVtX3N0YXRlICE9IFNZU19TVEFU
RV9lYXJseV9ib290ICYmICFtZm5fZXEobWZuLCBJTlZBTElEX01GTikgKQotICAgICAgICBmcmVl
X3hlbmhlYXBfcGFnZShtZm5fdG9fdmlydChtZm5feChtZm4pKSk7CisgICAgICAgIGZyZWVfeGVu
aGVhcF9wYWdlKG1mbl90b192aXJ0KG1mbikpOwogfQogCiBzdGF0aWMgREVGSU5FX1NQSU5MT0NL
KG1hcF9wZ2Rpcl9sb2NrKTsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9udW1hLmMgYi94ZW4v
YXJjaC94ODYvbnVtYS5jCmluZGV4IGYxMDY2YzU5YzcuLjg3ZjczNjUzMDQgMTAwNjQ0Ci0tLSBh
L3hlbi9hcmNoL3g4Ni9udW1hLmMKKysrIGIveGVuL2FyY2gveDg2L251bWEuYwpAQCAtMTAwLDE0
ICsxMDAsMTIgQEAgc3RhdGljIGludCBfX2luaXQgcG9wdWxhdGVfbWVtbm9kZW1hcChjb25zdCBz
dHJ1Y3Qgbm9kZSAqbm9kZXMsCiBzdGF0aWMgaW50IF9faW5pdCBhbGxvY2F0ZV9jYWNoZWFsaWdu
ZWRfbWVtbm9kZW1hcCh2b2lkKQogewogICAgIHVuc2lnbmVkIGxvbmcgc2l6ZSA9IFBGTl9VUCht
ZW1ub2RlbWFwc2l6ZSAqIHNpemVvZigqbWVtbm9kZW1hcCkpOwotICAgIHVuc2lnbmVkIGxvbmcg
bWZuID0gbWZuX3goYWxsb2NfYm9vdF9wYWdlcyhzaXplLCAxKSk7CisgICAgbWZuX3QgbWZuID0g
YWxsb2NfYm9vdF9wYWdlcyhzaXplLCAxKTsKIAogICAgIG1lbW5vZGVtYXAgPSBtZm5fdG9fdmly
dChtZm4pOwotICAgIG1mbiA8PD0gUEFHRV9TSElGVDsKLSAgICBzaXplIDw8PSBQQUdFX1NISUZU
OwogICAgIHByaW50ayhLRVJOX0RFQlVHICJOVU1BOiBBbGxvY2F0ZWQgbWVtbm9kZW1hcCBmcm9t
ICVseCAtICVseFxuIiwKLSAgICAgICAgICAgbWZuLCBtZm4gKyBzaXplKTsKLSAgICBtZW1ub2Rl
bWFwc2l6ZSA9IHNpemUgLyBzaXplb2YoKm1lbW5vZGVtYXApOworICAgICAgICAgICBtZm5fdG9f
bWFkZHIobWZuKSwgbWZuX3RvX21hZGRyKG1mbl9hZGQobWZuLCBzaXplKSkpOworICAgIG1lbW5v
ZGVtYXBzaXplID0gKHNpemUgPDwgUEFHRV9TSElGVCkgLyBzaXplb2YoKm1lbW5vZGVtYXApOwog
CiAgICAgcmV0dXJuIDA7CiB9CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvcHYvZGVzY3JpcHRv
ci10YWJsZXMuYyBiL3hlbi9hcmNoL3g4Ni9wdi9kZXNjcmlwdG9yLXRhYmxlcy5jCmluZGV4IDk0
MDgwNGIxOGEuLmYyMmJlYjFmM2MgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9kZXNjcmlw
dG9yLXRhYmxlcy5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9kZXNjcmlwdG9yLXRhYmxlcy5jCkBA
IC03Niw3ICs3Niw3IEBAIGJvb2wgcHZfZGVzdHJveV9sZHQoc3RydWN0IHZjcHUgKnYpCiB2b2lk
IHB2X2Rlc3Ryb3lfZ2R0KHN0cnVjdCB2Y3B1ICp2KQogewogICAgIGwxX3BnZW50cnlfdCAqcGwx
ZSA9IHB2X2dkdF9wdGVzKHYpOwotICAgIG1mbl90IHplcm9fbWZuID0gX21mbih2aXJ0X3RvX21m
bih6ZXJvX3BhZ2UpKTsKKyAgICBtZm5fdCB6ZXJvX21mbiA9IHZpcnRfdG9fbWZuKHplcm9fcGFn
ZSk7CiAgICAgbDFfcGdlbnRyeV90IHplcm9fbDFlID0gbDFlX2Zyb21fbWZuKHplcm9fbWZuLCBf
X1BBR0VfSFlQRVJWSVNPUl9STyk7CiAgICAgdW5zaWduZWQgaW50IGk7CiAKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL3g4Ni9wdi9kb20wX2J1aWxkLmMgYi94ZW4vYXJjaC94ODYvcHYvZG9tMF9idWls
ZC5jCmluZGV4IDU2NzhkYTc4MmQuLjMwODQ2YjVmOTcgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4
Ni9wdi9kb20wX2J1aWxkLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2RvbTBfYnVpbGQuYwpAQCAt
NTIzLDcgKzUyMyw3IEBAIGludCBfX2luaXQgZG9tMF9jb25zdHJ1Y3RfcHYoc3RydWN0IGRvbWFp
biAqZCwKICAgICAgICAgICAgICAgICAgICAgZnJlZV9kb21oZWFwX3BhZ2VzKHBhZ2UsIG9yZGVy
KTsKICAgICAgICAgICAgICAgICAgICAgcGFnZSArPSAxVUwgPDwgb3JkZXI7CiAgICAgICAgICAg
ICAgICAgfQotICAgICAgICAgICAgbWVtY3B5KHBhZ2VfdG9fdmlydChwYWdlKSwgbWZuX3RvX3Zp
cnQoaW5pdHJkLT5tb2Rfc3RhcnQpLAorICAgICAgICAgICAgbWVtY3B5KHBhZ2VfdG9fdmlydChw
YWdlKSwgbWZuX3RvX3ZpcnQoX21mbihpbml0cmQtPm1vZF9zdGFydCkpLAogICAgICAgICAgICAg
ICAgICAgIGluaXRyZF9sZW4pOwogICAgICAgICAgICAgbXB0X2FsbG9jID0gKHBhZGRyX3QpaW5p
dHJkLT5tb2Rfc3RhcnQgPDwgUEFHRV9TSElGVDsKICAgICAgICAgICAgIGluaXRfZG9taGVhcF9w
YWdlcyhtcHRfYWxsb2MsCkBAIC02MDEsNyArNjAxLDcgQEAgaW50IF9faW5pdCBkb20wX2NvbnN0
cnVjdF9wdihzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICBtYWRkcl90b19wYWdlKG1wdF9hbGxv
YyktPnUuaW51c2UudHlwZV9pbmZvID0gUEdUX2w0X3BhZ2VfdGFibGU7CiAgICAgICAgIGw0c3Rh
cnQgPSBsNHRhYiA9IF9fdmEobXB0X2FsbG9jKTsgbXB0X2FsbG9jICs9IFBBR0VfU0laRTsKICAg
ICAgICAgY2xlYXJfcGFnZShsNHRhYik7Ci0gICAgICAgIGluaXRfeGVuX2w0X3Nsb3RzKGw0dGFi
LCBfbWZuKHZpcnRfdG9fbWZuKGw0c3RhcnQpKSwKKyAgICAgICAgaW5pdF94ZW5fbDRfc2xvdHMo
bDR0YWIsIHZpcnRfdG9fbWZuKGw0c3RhcnQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICBk
LCBJTlZBTElEX01GTiwgdHJ1ZSk7CiAgICAgICAgIHYtPmFyY2guZ3Vlc3RfdGFibGUgPSBwYWdl
dGFibGVfZnJvbV9wYWRkcihfX3BhKGw0c3RhcnQpKTsKICAgICB9CmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvcHYvc2hpbS5jIGIveGVuL2FyY2gveDg2L3B2L3NoaW0uYwppbmRleCBlZDJlY2U4
YThhLi5iODQ5YzYwNjk5IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvcHYvc2hpbS5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9wdi9zaGltLmMKQEAgLTM5LDkgKzM5LDYgQEAKIAogI2luY2x1ZGUgPGNv
bXBhdC9ncmFudF90YWJsZS5oPgogCi0jdW5kZWYgdmlydF90b19tZm4KLSNkZWZpbmUgdmlydF90
b19tZm4odmEpIF9tZm4oX192aXJ0X3RvX21mbih2YSkpCi0KICNpZmRlZiBDT05GSUdfUFZfU0hJ
TV9FWENMVVNJVkUKIC8qIFRvbGVyYXRlICJwdi1zaGltIiBiZWluZyBwYXNzZWQgdG8gYSBDT05G
SUdfUFZfU0hJTV9FWENMVVNJVkUgaHlwZXJ2aXNvci4gKi8KIGlnbm9yZV9wYXJhbSgicHYtc2hp
bSIpOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L3NldHVwLmMgYi94ZW4vYXJjaC94ODYvc2V0
dXAuYwppbmRleCA4ODU5MTlkNWMzLi5jZmU5NWM1ZGFjIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94
ODYvc2V0dXAuYworKysgYi94ZW4vYXJjaC94ODYvc2V0dXAuYwpAQCAtMzQwLDcgKzM0MCw3IEBA
IHZvaWQgKl9faW5pdCBib290c3RyYXBfbWFwKGNvbnN0IG1vZHVsZV90ICptb2QpCiAgICAgdm9p
ZCAqcmV0OwogCiAgICAgaWYgKCBzeXN0ZW1fc3RhdGUgIT0gU1lTX1NUQVRFX2Vhcmx5X2Jvb3Qg
KQotICAgICAgICByZXR1cm4gbW9kID8gbWZuX3RvX3ZpcnQobW9kLT5tb2Rfc3RhcnQpIDogTlVM
TDsKKyAgICAgICAgcmV0dXJuIG1vZCA/IG1mbl90b192aXJ0KF9tZm4obW9kLT5tb2Rfc3RhcnQp
KSA6IE5VTEw7CiAKICAgICBpZiAoICFtb2QgKQogICAgIHsKQEAgLTEwMDUsNyArMTAwNSw3IEBA
IHZvaWQgX19pbml0IG5vcmV0dXJuIF9fc3RhcnRfeGVuKHVuc2lnbmVkIGxvbmcgbWJpX3ApCiAg
ICAgICAgICAqIFRoaXMgbmVlZHMgdG8gcmVtYWluIGluIHN5bmMgd2l0aCB4ZW5faW5fcmFuZ2Uo
KSBhbmQgdGhlCiAgICAgICAgICAqIHJlc3BlY3RpdmUgcmVzZXJ2ZV9lODIwX3JhbSgpIGludm9j
YXRpb24gYmVsb3cuCiAgICAgICAgICAqLwotICAgICAgICBtb2RbbWJpLT5tb2RzX2NvdW50XS5t
b2Rfc3RhcnQgPSB2aXJ0X3RvX21mbihfc3RleHQpOworICAgICAgICBtb2RbbWJpLT5tb2RzX2Nv
dW50XS5tb2Rfc3RhcnQgPSBtZm5feCh2aXJ0X3RvX21mbihfc3RleHQpKTsKICAgICAgICAgbW9k
W21iaS0+bW9kc19jb3VudF0ubW9kX2VuZCA9IF9fMk1fcndkYXRhX2VuZCAtIF9zdGV4dDsKICAg
ICB9CiAKQEAgLTE0MDQsNyArMTQwNCw3IEBAIHZvaWQgX19pbml0IG5vcmV0dXJuIF9fc3RhcnRf
eGVuKHVuc2lnbmVkIGxvbmcgbWJpX3ApCiAgICAgewogICAgICAgICBzZXRfcGR4X3JhbmdlKG1v
ZFtpXS5tb2Rfc3RhcnQsCiAgICAgICAgICAgICAgICAgICAgICAgbW9kW2ldLm1vZF9zdGFydCAr
IFBGTl9VUChtb2RbaV0ubW9kX2VuZCkpOwotICAgICAgICBtYXBfcGFnZXNfdG9feGVuKCh1bnNp
Z25lZCBsb25nKW1mbl90b192aXJ0KG1vZFtpXS5tb2Rfc3RhcnQpLAorICAgICAgICBtYXBfcGFn
ZXNfdG9feGVuKCh1bnNpZ25lZCBsb25nKW1mbl90b192aXJ0KF9tZm4obW9kW2ldLm1vZF9zdGFy
dCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgIF9tZm4obW9kW2ldLm1vZF9zdGFydCksCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgUEZOX1VQKG1vZFtpXS5tb2RfZW5kKSwgUEFHRV9IWVBF
UlZJU09SKTsKICAgICB9CkBAIC0xNDk0LDkgKzE0OTQsOSBAQCB2b2lkIF9faW5pdCBub3JldHVy
biBfX3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9wKQogCiAgICAgbnVtYV9pbml0bWVtX2lu
aXQoMCwgcmF3X21heF9wYWdlKTsKIAotICAgIGlmICggbWF4X3BhZ2UgLSAxID4gdmlydF90b19t
Zm4oSFlQRVJWSVNPUl9WSVJUX0VORCAtIDEpICkKKyAgICBpZiAoIG1heF9wYWdlIC0gMSA+IG1m
bl94KHZpcnRfdG9fbWZuKEhZUEVSVklTT1JfVklSVF9FTkQgLSAxKSkgKQogICAgIHsKLSAgICAg
ICAgdW5zaWduZWQgbG9uZyBsaW1pdCA9IHZpcnRfdG9fbWZuKEhZUEVSVklTT1JfVklSVF9FTkQg
LSAxKTsKKyAgICAgICAgdW5zaWduZWQgbG9uZyBsaW1pdCA9IG1mbl94KHZpcnRfdG9fbWZuKEhZ
UEVSVklTT1JfVklSVF9FTkQgLSAxKSk7CiAgICAgICAgIHVpbnQ2NF90IG1hc2sgPSBQQUdFX1NJ
WkUgLSAxOwogCiAgICAgICAgIGlmICggIWhpZ2htZW1fc3RhcnQgKQpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L3NtcGJvb3QuYyBiL3hlbi9hcmNoL3g4Ni9zbXBib290LmMKaW5kZXggMDkyNjRi
MDJkMS4uMzFiNDM2NmFiMiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3NtcGJvb3QuYworKysg
Yi94ZW4vYXJjaC94ODYvc21wYm9vdC5jCkBAIC05OTYsNyArOTk2LDcgQEAgc3RhdGljIGludCBj
cHVfc21wYm9vdF9hbGxvYyh1bnNpZ25lZCBpbnQgY3B1KQogICAgICAgICBnb3RvIG91dDsKICAg
ICBwZXJfY3B1KGdkdCwgY3B1KSA9IGdkdDsKICAgICBwZXJfY3B1KGdkdF9sMWUsIGNwdSkgPQot
ICAgICAgICBsMWVfZnJvbV9wZm4odmlydF90b19tZm4oZ2R0KSwgX19QQUdFX0hZUEVSVklTT1Jf
UlcpOworICAgICAgICBsMWVfZnJvbV9tZm4odmlydF90b19tZm4oZ2R0KSwgX19QQUdFX0hZUEVS
VklTT1JfUlcpOwogICAgIG1lbWNweShnZHQsIGJvb3RfZ2R0LCBOUl9SRVNFUlZFRF9HRFRfUEFH
RVMgKiBQQUdFX1NJWkUpOwogICAgIEJVSUxEX0JVR19PTihOUl9DUFVTID4gMHgxMDAwMCk7CiAg
ICAgZ2R0W1BFUl9DUFVfR0RUX0VOVFJZIC0gRklSU1RfUkVTRVJWRURfR0RUX0VOVFJZXS5hID0g
Y3B1OwpAQCAtMTAwNSw3ICsxMDA1LDcgQEAgc3RhdGljIGludCBjcHVfc21wYm9vdF9hbGxvYyh1
bnNpZ25lZCBpbnQgY3B1KQogICAgIGlmICggZ2R0ID09IE5VTEwgKQogICAgICAgICBnb3RvIG91
dDsKICAgICBwZXJfY3B1KGNvbXBhdF9nZHRfbDFlLCBjcHUpID0KLSAgICAgICAgbDFlX2Zyb21f
cGZuKHZpcnRfdG9fbWZuKGdkdCksIF9fUEFHRV9IWVBFUlZJU09SX1JXKTsKKyAgICAgICAgbDFl
X2Zyb21fbWZuKHZpcnRfdG9fbWZuKGdkdCksIF9fUEFHRV9IWVBFUlZJU09SX1JXKTsKICAgICBt
ZW1jcHkoZ2R0LCBib290X2NvbXBhdF9nZHQsIE5SX1JFU0VSVkVEX0dEVF9QQUdFUyAqIFBBR0Vf
U0laRSk7CiAgICAgZ2R0W1BFUl9DUFVfR0RUX0VOVFJZIC0gRklSU1RfUkVTRVJWRURfR0RUX0VO
VFJZXS5hID0gY3B1OwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvc3JhdC5jIGIveGVuL2Fy
Y2gveDg2L3NyYXQuYwppbmRleCA1MDZhNTZkNjZiLi4wYmFmOGI5N2NlIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvc3JhdC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9zcmF0LmMKQEAgLTE5Niw3ICsx
OTYsNyBAQCB2b2lkIF9faW5pdCBhY3BpX251bWFfc2xpdF9pbml0KHN0cnVjdCBhY3BpX3RhYmxl
X3NsaXQgKnNsaXQpCiAJCXJldHVybjsKIAl9CiAJbWZuID0gYWxsb2NfYm9vdF9wYWdlcyhQRk5f
VVAoc2xpdC0+aGVhZGVyLmxlbmd0aCksIDEpOwotCWFjcGlfc2xpdCA9IG1mbl90b192aXJ0KG1m
bl94KG1mbikpOworCWFjcGlfc2xpdCA9IG1mbl90b192aXJ0KG1mbik7CiAJbWVtY3B5KGFjcGlf
c2xpdCwgc2xpdCwgc2xpdC0+aGVhZGVyLmxlbmd0aCk7CiB9CiAKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni90Ym9vdC5jIGIveGVuL2FyY2gveDg2L3Rib290LmMKaW5kZXggOGMyMzIyNzBiNC4u
MTllYTY5ZjdjMSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3Rib290LmMKKysrIGIveGVuL2Fy
Y2gveDg2L3Rib290LmMKQEAgLTI2MCw3ICsyNjAsNyBAQCBzdGF0aWMgaW50IG1mbl9pbl9ndWFy
ZGVkX3N0YWNrKHVuc2lnbmVkIGxvbmcgbWZuKQogICAgICAgICAgICAgY29udGludWU7CiAgICAg
ICAgIHAgPSAodm9pZCAqKSgodW5zaWduZWQgbG9uZylzdGFja19iYXNlW2ldICsgU1RBQ0tfU0la
RSAtCiAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZX1NUQUNLX1NJWkUgLSBQQUdFX1NJWkUp
OwotICAgICAgICBpZiAoIG1mbiA9PSB2aXJ0X3RvX21mbihwKSApCisgICAgICAgIGlmICggbWZu
X2VxKF9tZm4obWZuKSwgdmlydF90b19tZm4ocCkpICkKICAgICAgICAgICAgIHJldHVybiAtMTsK
ICAgICB9CiAKQEAgLTI5Niw3ICsyOTYsNyBAQCBzdGF0aWMgdm9pZCB0Ym9vdF9nZW5feGVuaGVh
cF9pbnRlZ3JpdHkoY29uc3QgdWludDhfdCBrZXlbVEJfS0VZX1NJWkVdLAogICAgICAgICAgICAg
aWYgKCBtZm5faW5fZ3VhcmRlZF9zdGFjayhtZm4pICkKICAgICAgICAgICAgICAgICBjb250aW51
ZTsgLyogc2tpcCBndWFyZCBzdGFjaywgc2VlIG1lbWd1YXJkX2d1YXJkX3N0YWNrKCkgaW4gbW0u
YyAqLwogCi0gICAgICAgICAgICBwZyA9IG1mbl90b192aXJ0KG1mbik7CisgICAgICAgICAgICBw
ZyA9IG1mbl90b192aXJ0KF9tZm4obWZuKSk7CiAgICAgICAgICAgICB2bWFjX3VwZGF0ZSgodWlu
dDhfdCAqKXBnLCBQQUdFX1NJWkUsICZjdHgpOwogICAgICAgICB9CiAgICAgfQpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L3RyYXBzLmMgYi94ZW4vYXJjaC94ODYvdHJhcHMuYwppbmRleCBlODM4
ODQ2YzZiLi40YWE3YzM1YmU0IDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvdHJhcHMuYworKysg
Yi94ZW4vYXJjaC94ODYvdHJhcHMuYwpAQCAtMjAyOSw5ICsyMDI5LDkgQEAgdm9pZCBfX2luaXQg
dHJhcF9pbml0KHZvaWQpCiAKICAgICAvKiBDYWNoZSB7LGNvbXBhdF99Z2R0X2wxZSBub3cgdGhh
dCBwaHlzaWNhbGx5IHJlbG9jYXRpb24gaXMgZG9uZS4gKi8KICAgICB0aGlzX2NwdShnZHRfbDFl
KSA9Ci0gICAgICAgIGwxZV9mcm9tX3Bmbih2aXJ0X3RvX21mbihib290X2dkdCksIF9fUEFHRV9I
WVBFUlZJU09SX1JXKTsKKyAgICAgICAgbDFlX2Zyb21fbWZuKHZpcnRfdG9fbWZuKGJvb3RfZ2R0
KSwgX19QQUdFX0hZUEVSVklTT1JfUlcpOwogICAgIHRoaXNfY3B1KGNvbXBhdF9nZHRfbDFlKSA9
Ci0gICAgICAgIGwxZV9mcm9tX3Bmbih2aXJ0X3RvX21mbihib290X2NvbXBhdF9nZHQpLCBfX1BB
R0VfSFlQRVJWSVNPUl9SVyk7CisgICAgICAgIGwxZV9mcm9tX21mbih2aXJ0X3RvX21mbihib290
X2NvbXBhdF9nZHQpLCBfX1BBR0VfSFlQRVJWSVNPUl9SVyk7CiAKICAgICBwZXJjcHVfdHJhcHNf
aW5pdCgpOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYveDg2XzY0L21tLmMgYi94ZW4vYXJj
aC94ODYveDg2XzY0L21tLmMKaW5kZXggMzUxNjQyM2JiMC4uZGRkNWYxZGRjNCAxMDA2NDQKLS0t
IGEveGVuL2FyY2gveDg2L3g4Nl82NC9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni94ODZfNjQvbW0u
YwpAQCAtMTM2OSwxMSArMTM2OSwxMiBAQCBpbnQgbWVtb3J5X2FkZCh1bnNpZ25lZCBsb25nIHNw
Zm4sIHVuc2lnbmVkIGxvbmcgZXBmbiwgdW5zaWduZWQgaW50IHB4bSkKICAgICAgICAgcmV0dXJu
IC1FSU5WQUw7CiAgICAgfQogCi0gICAgaSA9IHZpcnRfdG9fbWZuKEhZUEVSVklTT1JfVklSVF9F
TkQgLSAxKSArIDE7CisgICAgaSA9IG1mbl94KHZpcnRfdG9fbWZuKEhZUEVSVklTT1JfVklSVF9F
TkQgLSAxKSkgKyAxOwogICAgIGlmICggc3BmbiA8IGkgKQogICAgIHsKLSAgICAgICAgcmV0ID0g
bWFwX3BhZ2VzX3RvX3hlbigodW5zaWduZWQgbG9uZyltZm5fdG9fdmlydChzcGZuKSwgX21mbihz
cGZuKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW4oZXBmbiwgaSkgLSBzcGZu
LCBQQUdFX0hZUEVSVklTT1IpOworICAgICAgICByZXQgPSBtYXBfcGFnZXNfdG9feGVuKCh1bnNp
Z25lZCBsb25nKW1mbl90b192aXJ0KF9tZm4oc3BmbikpLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIF9tZm4oc3BmbiksIG1pbihlcGZuLCBpKSAtIHNwZm4sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgUEFHRV9IWVBFUlZJU09SKTsKICAgICAgICAgaWYgKCByZXQgKQog
ICAgICAgICAgICAgZ290byBkZXN0cm95X2RpcmVjdG1hcDsKICAgICB9CkBAIC0xMzgxLDcgKzEz
ODIsNyBAQCBpbnQgbWVtb3J5X2FkZCh1bnNpZ25lZCBsb25nIHNwZm4sIHVuc2lnbmVkIGxvbmcg
ZXBmbiwgdW5zaWduZWQgaW50IHB4bSkKICAgICB7CiAgICAgICAgIGlmICggaSA8IHNwZm4gKQog
ICAgICAgICAgICAgaSA9IHNwZm47Ci0gICAgICAgIHJldCA9IG1hcF9wYWdlc190b194ZW4oKHVu
c2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoaSksIF9tZm4oaSksCisgICAgICAgIHJldCA9IG1hcF9w
YWdlc190b194ZW4oKHVuc2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoX21mbihpKSksIF9tZm4oaSks
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXBmbiAtIGksIF9fUEFHRV9IWVBFUlZJ
U09SX1JXKTsKICAgICAgICAgaWYgKCByZXQgKQogICAgICAgICAgICAgZ290byBkZXN0cm95X2Rp
cmVjdG1hcDsKQEAgLTE0NzMsOCArMTQ3NCw4IEBAIGRlc3Ryb3lfZnJhbWV0YWJsZToKICAgICBO
T0RFX0RBVEEobm9kZSktPm5vZGVfc3RhcnRfcGZuID0gb2xkX25vZGVfc3RhcnQ7CiAgICAgTk9E
RV9EQVRBKG5vZGUpLT5ub2RlX3NwYW5uZWRfcGFnZXMgPSBvbGRfbm9kZV9zcGFuOwogIGRlc3Ry
b3lfZGlyZWN0bWFwOgotICAgIGRlc3Ryb3lfeGVuX21hcHBpbmdzKCh1bnNpZ25lZCBsb25nKW1m
bl90b192aXJ0KHNwZm4pLAotICAgICAgICAgICAgICAgICAgICAgICAgICh1bnNpZ25lZCBsb25n
KW1mbl90b192aXJ0KGVwZm4pKTsKKyAgICBkZXN0cm95X3hlbl9tYXBwaW5ncygodW5zaWduZWQg
bG9uZyltZm5fdG9fdmlydChfbWZuKHNwZm4pKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAo
dW5zaWduZWQgbG9uZyltZm5fdG9fdmlydChfbWZuKGVwZm4pKSk7CiAKICAgICByZXR1cm4gcmV0
OwogfQpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9kb21jdGwuYyBiL3hlbi9jb21tb24vZG9tY3Rs
LmMKaW5kZXggYTY5YjNiNTlhOC4uZTRhMDU1ZGM2NyAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9k
b21jdGwuYworKysgYi94ZW4vY29tbW9uL2RvbWN0bC5jCkBAIC0xOTYsNyArMTk2LDggQEAgdm9p
ZCBnZXRkb21haW5pbmZvKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCB4ZW5fZG9tY3RsX2dldGRv
bWFpbmluZm8gKmluZm8pCiAgICAgaW5mby0+b3V0c3RhbmRpbmdfcGFnZXMgPSBkLT5vdXRzdGFu
ZGluZ19wYWdlczsKICAgICBpbmZvLT5zaHJfcGFnZXMgICAgICAgICA9IGF0b21pY19yZWFkKCZk
LT5zaHJfcGFnZXMpOwogICAgIGluZm8tPnBhZ2VkX3BhZ2VzICAgICAgID0gYXRvbWljX3JlYWQo
JmQtPnBhZ2VkX3BhZ2VzKTsKLSAgICBpbmZvLT5zaGFyZWRfaW5mb19mcmFtZSA9IG1mbl90b19n
bWZuKGQsIHZpcnRfdG9fbWZuKGQtPnNoYXJlZF9pbmZvKSk7CisgICAgaW5mby0+c2hhcmVkX2lu
Zm9fZnJhbWUgPSBtZm5fdG9fZ21mbihkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbWZuX3godmlydF90b19tZm4oZC0+c2hhcmVkX2luZm8pKSk7CiAgICAgQlVH
X09OKFNIQVJFRF9NMlAoaW5mby0+c2hhcmVkX2luZm9fZnJhbWUpKTsKIAogICAgIGluZm8tPmNw
dXBvb2wgPSBjcHVwb29sX2dldF9pZChkKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vZWZpL2Jv
b3QuYyBiL3hlbi9jb21tb24vZWZpL2Jvb3QuYwppbmRleCBhNmY4NGM5NDVhLi40Zjk0NGZiM2U4
IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL2VmaS9ib290LmMKKysrIGIveGVuL2NvbW1vbi9lZmkv
Ym9vdC5jCkBAIC0xNDQ3LDcgKzE0NDcsNyBAQCBzdGF0aWMgX19pbml0IHZvaWQgY29weV9tYXBw
aW5nKHVuc2lnbmVkIGxvbmcgbWZuLCB1bnNpZ25lZCBsb25nIGVuZCwKICAgICB7CiAgICAgICAg
IGw0X3BnZW50cnlfdCBsNGUgPSBlZmlfbDRfcGd0YWJsZVtsNF90YWJsZV9vZmZzZXQobWZuIDw8
IFBBR0VfU0hJRlQpXTsKICAgICAgICAgbDNfcGdlbnRyeV90ICpsM3NyYywgKmwzZHN0OwotICAg
ICAgICB1bnNpZ25lZCBsb25nIHZhID0gKHVuc2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQobWZuKTsK
KyAgICAgICAgdW5zaWduZWQgbG9uZyB2YSA9ICh1bnNpZ25lZCBsb25nKW1mbl90b192aXJ0KF9t
Zm4obWZuKSk7CiAKICAgICAgICAgbmV4dCA9IG1mbiArICgxVUwgPDwgKEwzX1BBR0VUQUJMRV9T
SElGVCAtIFBBR0VfU0hJRlQpKTsKICAgICAgICAgaWYgKCAhaXNfdmFsaWQobWZuLCBtaW4obmV4
dCwgZW5kKSkgKQpAQCAtMTU2Miw5ICsxNTYyLDEwIEBAIHZvaWQgX19pbml0IGVmaV9pbml0X21l
bW9yeSh2b2lkKQogICAgICAgICAgICAgICEoc21mbiAmIHBmbl9ob2xlX21hc2spICYmCiAgICAg
ICAgICAgICAgISgoc21mbiBeIChlbWZuIC0gMSkpICYgfnBmbl9wZHhfYm90dG9tX21hc2spICkK
ICAgICAgICAgewotICAgICAgICAgICAgaWYgKCAodW5zaWduZWQgbG9uZyltZm5fdG9fdmlydChl
bWZuIC0gMSkgPj0gSFlQRVJWSVNPUl9WSVJUX0VORCApCisgICAgICAgICAgICBpZiAoICh1bnNp
Z25lZCBsb25nKW1mbl90b192aXJ0KF9tZm4oZW1mbiAtIDEpKSA+PQorICAgICAgICAgICAgICAg
ICBIWVBFUlZJU09SX1ZJUlRfRU5EICkKICAgICAgICAgICAgICAgICBwcm90ICY9IH5fUEFHRV9H
TE9CQUw7Ci0gICAgICAgICAgICBpZiAoIG1hcF9wYWdlc190b194ZW4oKHVuc2lnbmVkIGxvbmcp
bWZuX3RvX3ZpcnQoc21mbiksCisgICAgICAgICAgICBpZiAoIG1hcF9wYWdlc190b194ZW4oKHVu
c2lnbmVkIGxvbmcpbWZuX3RvX3ZpcnQoX21mbihzbWZuKSksCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgX21mbihzbWZuKSwgZW1mbiAtIHNtZm4sIHByb3QpID09IDAgKQogICAg
ICAgICAgICAgICAgIGRlc2MtPlZpcnR1YWxTdGFydCA9CiAgICAgICAgICAgICAgICAgICAgICh1
bnNpZ25lZCBsb25nKW1hZGRyX3RvX3ZpcnQoZGVzYy0+UGh5c2ljYWxTdGFydCk7CmRpZmYgLS1n
aXQgYS94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMgYi94ZW4vY29tbW9uL2dyYW50X3RhYmxlLmMK
aW5kZXggOWZkNmU2MDQxNi4uNDA3ZmRmMDhmZiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9ncmFu
dF90YWJsZS5jCisrKyBiL3hlbi9jb21tb24vZ3JhbnRfdGFibGUuYwpAQCAtMzkzNSw4ICszOTM1
LDggQEAgc3RhdGljIGludCBnbnR0YWJfZ2V0X3N0YXR1c19mcmFtZV9tZm4oc3RydWN0IGRvbWFp
biAqZCwKICAgICB9CiAKICAgICAvKiBNYWtlIHN1cmUgaWR4IGlzIGJvdW5kZWQgd3J0IG5yX3N0
YXR1c19mcmFtZXMgKi8KLSAgICAqbWZuID0gX21mbih2aXJ0X3RvX21mbigKLSAgICAgICAgICAg
ICAgICBndC0+c3RhdHVzW2FycmF5X2luZGV4X25vc3BlYyhpZHgsIG5yX3N0YXR1c19mcmFtZXMo
Z3QpKV0pKTsKKyAgICAqbWZuID0gdmlydF90b19tZm4oCisgICAgICAgICAgICAgICAgZ3QtPnN0
YXR1c1thcnJheV9pbmRleF9ub3NwZWMoaWR4LCBucl9zdGF0dXNfZnJhbWVzKGd0KSldKTsKICAg
ICByZXR1cm4gMDsKIH0KIApAQCAtMzk2Niw4ICszOTY2LDggQEAgc3RhdGljIGludCBnbnR0YWJf
Z2V0X3NoYXJlZF9mcmFtZV9tZm4oc3RydWN0IGRvbWFpbiAqZCwKICAgICB9CiAKICAgICAvKiBN
YWtlIHN1cmUgaWR4IGlzIGJvdW5kZWQgd3J0IG5yX3N0YXR1c19mcmFtZXMgKi8KLSAgICAqbWZu
ID0gX21mbih2aXJ0X3RvX21mbigKLSAgICAgICAgICAgICAgICBndC0+c2hhcmVkX3Jhd1thcnJh
eV9pbmRleF9ub3NwZWMoaWR4LCBucl9ncmFudF9mcmFtZXMoZ3QpKV0pKTsKKyAgICAqbWZuID0g
dmlydF90b19tZm4oCisgICAgICAgICAgICAgICAgZ3QtPnNoYXJlZF9yYXdbYXJyYXlfaW5kZXhf
bm9zcGVjKGlkeCwgbnJfZ3JhbnRfZnJhbWVzKGd0KSldKTsKICAgICByZXR1cm4gMDsKIH0KIApk
aWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9wYWdlX2FsbG9jLmMgYi94ZW4vY29tbW9uL3BhZ2VfYWxs
b2MuYwppbmRleCA3NmQzNzIyNmRmLi40MWU0ZmE4OTlkIDEwMDY0NAotLS0gYS94ZW4vY29tbW9u
L3BhZ2VfYWxsb2MuYworKysgYi94ZW4vY29tbW9uL3BhZ2VfYWxsb2MuYwpAQCAtNTY1LDcgKzU2
NSw3IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgX19yZWFkX21vc3RseSB4ZW5oZWFwX2JpdHM7CiAj
ZGVmaW5lIHhlbmhlYXBfYml0cyAwCiAjZW5kaWYKIAotc3RhdGljIHVuc2lnbmVkIGxvbmcgaW5p
dF9ub2RlX2hlYXAoaW50IG5vZGUsIHVuc2lnbmVkIGxvbmcgbWZuLAorc3RhdGljIHVuc2lnbmVk
IGxvbmcgaW5pdF9ub2RlX2hlYXAoaW50IG5vZGUsIG1mbl90IG1mbiwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgbnIsIGJvb2wgKnVzZV90YWlsKQog
ewogICAgIC8qIEZpcnN0IG5vZGUgdG8gYmUgZGlzY292ZXJlZCBoYXMgaXRzIGhlYXAgbWV0YWRh
dGEgc3RhdGljYWxseSBhbGxvY2VkLiAqLwpAQCAtNTg0LDIxICs1ODQsMjEgQEAgc3RhdGljIHVu
c2lnbmVkIGxvbmcgaW5pdF9ub2RlX2hlYXAoaW50IG5vZGUsIHVuc2lnbmVkIGxvbmcgbWZuLAog
ICAgICAgICBuZWVkZWQgPSAwOwogICAgIH0KICAgICBlbHNlIGlmICggKnVzZV90YWlsICYmIG5y
ID49IG5lZWRlZCAmJgotICAgICAgICAgICAgICBhcmNoX21mbl9pbl9kaXJlY3RtYXAobWZuICsg
bnIpICYmCisgICAgICAgICAgICAgIGFyY2hfbWZuX2luX2RpcmVjdG1hcChtZm5feChtZm5fYWRk
KG1mbiwgbnIpKSkgJiYKICAgICAgICAgICAgICAgKCF4ZW5oZWFwX2JpdHMgfHwKLSAgICAgICAg
ICAgICAgICEoKG1mbiArIG5yIC0gMSkgPj4gKHhlbmhlYXBfYml0cyAtIFBBR0VfU0hJRlQpKSkg
KQorICAgICAgICAgICAgICAgISgobWZuX3gobWZuKSArIG5yIC0gMSkgPj4gKHhlbmhlYXBfYml0
cyAtIFBBR0VfU0hJRlQpKSkgKQogICAgIHsKLSAgICAgICAgX2hlYXBbbm9kZV0gPSBtZm5fdG9f
dmlydChtZm4gKyBuciAtIG5lZWRlZCk7Ci0gICAgICAgIGF2YWlsW25vZGVdID0gbWZuX3RvX3Zp
cnQobWZuICsgbnIgLSAxKSArCisgICAgICAgIF9oZWFwW25vZGVdID0gbWZuX3RvX3ZpcnQobWZu
X2FkZChtZm4sIG5yIC0gbmVlZGVkKSk7CisgICAgICAgIGF2YWlsW25vZGVdID0gbWZuX3RvX3Zp
cnQobWZuX2FkZChtZm4sIG5yIC0gMSkpICsKICAgICAgICAgICAgICAgICAgICAgICBQQUdFX1NJ
WkUgLSBzaXplb2YoKiphdmFpbCkgKiBOUl9aT05FUzsKICAgICB9CiAgICAgZWxzZSBpZiAoIG5y
ID49IG5lZWRlZCAmJgotICAgICAgICAgICAgICBhcmNoX21mbl9pbl9kaXJlY3RtYXAobWZuICsg
bmVlZGVkKSAmJgorICAgICAgICAgICAgICBhcmNoX21mbl9pbl9kaXJlY3RtYXAobWZuX3gobWZu
X2FkZChtZm4sIG5lZWRlZCkpKSAmJgogICAgICAgICAgICAgICAoIXhlbmhlYXBfYml0cyB8fAot
ICAgICAgICAgICAgICAgISgobWZuICsgbmVlZGVkIC0gMSkgPj4gKHhlbmhlYXBfYml0cyAtIFBB
R0VfU0hJRlQpKSkgKQorICAgICAgICAgICAgICAgISgobWZuX3gobWZuKSArIG5lZWRlZCAtIDEp
ID4+ICh4ZW5oZWFwX2JpdHMgLSBQQUdFX1NISUZUKSkpICkKICAgICB7CiAgICAgICAgIF9oZWFw
W25vZGVdID0gbWZuX3RvX3ZpcnQobWZuKTsKLSAgICAgICAgYXZhaWxbbm9kZV0gPSBtZm5fdG9f
dmlydChtZm4gKyBuZWVkZWQgLSAxKSArCisgICAgICAgIGF2YWlsW25vZGVdID0gbWZuX3RvX3Zp
cnQobWZuX2FkZChtZm4sIG5lZWRlZCAtIDEpKSArCiAgICAgICAgICAgICAgICAgICAgICAgUEFH
RV9TSVpFIC0gc2l6ZW9mKCoqYXZhaWwpICogTlJfWk9ORVM7CiAgICAgICAgICp1c2VfdGFpbCA9
IGZhbHNlOwogICAgIH0KQEAgLTE4MDksNyArMTgwOSw3IEBAIHN0YXRpYyB2b2lkIGluaXRfaGVh
cF9wYWdlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZmluZF9maXJzdF9zZXRfYml0
KGUpIDw9IGZpbmRfZmlyc3Rfc2V0X2JpdChzKSk7CiAgICAgICAgICAgICB1bnNpZ25lZCBsb25n
IG47CiAKLSAgICAgICAgICAgIG4gPSBpbml0X25vZGVfaGVhcChuaWQsIG1mbl94KHBhZ2VfdG9f
bWZuKHBnICsgaSkpLCBucl9wYWdlcyAtIGksCisgICAgICAgICAgICBuID0gaW5pdF9ub2RlX2hl
YXAobmlkLCBwYWdlX3RvX21mbihwZyArIGkpLCBucl9wYWdlcyAtIGksCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgJnVzZV90YWlsKTsKICAgICAgICAgICAgIEJVR19PTihpICsgbiA+
IG5yX3BhZ2VzKTsKICAgICAgICAgICAgIGlmICggbiAmJiAhdXNlX3RhaWwgKQpkaWZmIC0tZ2l0
IGEveGVuL2NvbW1vbi90cmFjZS5jIGIveGVuL2NvbW1vbi90cmFjZS5jCmluZGV4IGEyYTM4OWEx
YzcuLjhkYmJjZDMxZGUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vdHJhY2UuYworKysgYi94ZW4v
Y29tbW9uL3RyYWNlLmMKQEAgLTIxOCw3ICsyMTgsNyBAQCBzdGF0aWMgaW50IGFsbG9jX3RyYWNl
X2J1ZnModW5zaWduZWQgaW50IHBhZ2VzKQogICAgICAgICAgICAgICAgIHRfaW5mb19tZm5fbGlz
dFtvZmZzZXQgKyBpXSA9IDA7CiAgICAgICAgICAgICAgICAgZ290byBvdXRfZGVhbGxvYzsKICAg
ICAgICAgICAgIH0KLSAgICAgICAgICAgIHRfaW5mb19tZm5fbGlzdFtvZmZzZXQgKyBpXSA9IHZp
cnRfdG9fbWZuKHApOworICAgICAgICAgICAgdF9pbmZvX21mbl9saXN0W29mZnNldCArIGldID0g
bWZuX3godmlydF90b19tZm4ocCkpOwogICAgICAgICB9CiAgICAgfQogCkBAIC0yMzQsNyArMjM0
LDggQEAgc3RhdGljIGludCBhbGxvY190cmFjZV9idWZzKHVuc2lnbmVkIGludCBwYWdlcykKICAg
ICAgICAgb2Zmc2V0ID0gdF9pbmZvLT5tZm5fb2Zmc2V0W2NwdV07CiAKICAgICAgICAgLyogSW5p
dGlhbGl6ZSB0aGUgYnVmZmVyIG1ldGFkYXRhICovCi0gICAgICAgIHBlcl9jcHUodF9idWZzLCBj
cHUpID0gYnVmID0gbWZuX3RvX3ZpcnQodF9pbmZvX21mbl9saXN0W29mZnNldF0pOworICAgICAg
ICBidWYgPSBtZm5fdG9fdmlydChfbWZuKHRfaW5mb19tZm5fbGlzdFtvZmZzZXRdKSk7CisgICAg
ICAgIHBlcl9jcHUodF9idWZzLCBjcHUpID0gYnVmOwogICAgICAgICBidWYtPmNvbnMgPSBidWYt
PnByb2QgPSAwOwogCiAgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAieGVudHJhY2U6IHAlZCBt
Zm4gJXggb2Zmc2V0ICV1XG4iLApAQCAtMjY5LDEwICsyNzAsMTAgQEAgb3V0X2RlYWxsb2M6CiAg
ICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBwYWdlczsgaSsr
ICkKICAgICAgICAgewotICAgICAgICAgICAgdWludDMyX3QgbWZuID0gdF9pbmZvX21mbl9saXN0
W29mZnNldCArIGldOwotICAgICAgICAgICAgaWYgKCAhbWZuICkKKyAgICAgICAgICAgIG1mbl90
IG1mbiA9IF9tZm4odF9pbmZvX21mbl9saXN0W29mZnNldCArIGldKTsKKyAgICAgICAgICAgIGlm
ICggbWZuX2VxKG1mbiwgX21mbigwKSkgKQogICAgICAgICAgICAgICAgIGJyZWFrOwotICAgICAg
ICAgICAgQVNTRVJUKCEobWZuX3RvX3BhZ2UoX21mbihtZm4pKS0+Y291bnRfaW5mbyAmIFBHQ19h
bGxvY2F0ZWQpKTsKKyAgICAgICAgICAgIEFTU0VSVCghKG1mbl90b19wYWdlKG1mbiktPmNvdW50
X2luZm8gJiBQR0NfYWxsb2NhdGVkKSk7CiAgICAgICAgICAgICBmcmVlX3hlbmhlYXBfcGFnZXMo
bWZuX3RvX3ZpcnQobWZuKSwgMCk7CiAgICAgICAgIH0KICAgICB9CkBAIC0zNzgsNyArMzc5LDcg
QEAgaW50IHRiX2NvbnRyb2woc3RydWN0IHhlbl9zeXNjdGxfdGJ1Zl9vcCAqdGJjKQogICAgIHsK
ICAgICBjYXNlIFhFTl9TWVNDVExfVEJVRk9QX2dldF9pbmZvOgogICAgICAgICB0YmMtPmV2dF9t
YXNrICAgPSB0Yl9ldmVudF9tYXNrOwotICAgICAgICB0YmMtPmJ1ZmZlcl9tZm4gPSB0X2luZm8g
PyB2aXJ0X3RvX21mbih0X2luZm8pIDogMDsKKyAgICAgICAgdGJjLT5idWZmZXJfbWZuID0gdF9p
bmZvID8gbWZuX3godmlydF90b19tZm4odF9pbmZvKSkgOiAwOwogICAgICAgICB0YmMtPnNpemUg
PSB0X2luZm9fcGFnZXMgKiBQQUdFX1NJWkU7CiAgICAgICAgIGJyZWFrOwogICAgIGNhc2UgWEVO
X1NZU0NUTF9UQlVGT1Bfc2V0X2NwdV9tYXNrOgpAQCAtNTEyLDcgKzUxMyw3IEBAIHN0YXRpYyB1
bnNpZ25lZCBjaGFyICpuZXh0X3JlY29yZChjb25zdCBzdHJ1Y3QgdF9idWYgKmJ1ZiwgdWludDMy
X3QgKm5leHQsCiAgICAgdWludDE2X3QgcGVyX2NwdV9tZm5fb2Zmc2V0OwogICAgIHVpbnQzMl90
IHBlcl9jcHVfbWZuX25yOwogICAgIHVpbnQzMl90ICptZm5fbGlzdDsKLSAgICB1aW50MzJfdCBt
Zm47CisgICAgbWZuX3QgbWZuOwogICAgIHVuc2lnbmVkIGNoYXIgKnRoaXNfcGFnZTsKIAogICAg
IGJhcnJpZXIoKTsgLyogbXVzdCByZWFkIGJ1Zi0+cHJvZCBhbmQgYnVmLT5jb25zIG9ubHkgb25j
ZSAqLwpAQCAtNTMzLDcgKzUzNCw3IEBAIHN0YXRpYyB1bnNpZ25lZCBjaGFyICpuZXh0X3JlY29y
ZChjb25zdCBzdHJ1Y3QgdF9idWYgKmJ1ZiwgdWludDMyX3QgKm5leHQsCiAgICAgcGVyX2NwdV9t
Zm5fbnIgPSB4ID4+IFBBR0VfU0hJRlQ7CiAgICAgcGVyX2NwdV9tZm5fb2Zmc2V0ID0gdF9pbmZv
LT5tZm5fb2Zmc2V0W3NtcF9wcm9jZXNzb3JfaWQoKV07CiAgICAgbWZuX2xpc3QgPSAodWludDMy
X3QgKil0X2luZm87Ci0gICAgbWZuID0gbWZuX2xpc3RbcGVyX2NwdV9tZm5fb2Zmc2V0ICsgcGVy
X2NwdV9tZm5fbnJdOworICAgIG1mbiA9IF9tZm4obWZuX2xpc3RbcGVyX2NwdV9tZm5fb2Zmc2V0
ICsgcGVyX2NwdV9tZm5fbnJdKTsKICAgICB0aGlzX3BhZ2UgPSBtZm5fdG9fdmlydChtZm4pOwog
ICAgIGlmIChwZXJfY3B1X21mbl9uciArIDEgPj0gb3B0X3RidWZfc2l6ZSkKICAgICB7CkBAIC01
NDIsNyArNTQzLDcgQEAgc3RhdGljIHVuc2lnbmVkIGNoYXIgKm5leHRfcmVjb3JkKGNvbnN0IHN0
cnVjdCB0X2J1ZiAqYnVmLCB1aW50MzJfdCAqbmV4dCwKICAgICB9CiAgICAgZWxzZQogICAgIHsK
LSAgICAgICAgbWZuID0gbWZuX2xpc3RbcGVyX2NwdV9tZm5fb2Zmc2V0ICsgcGVyX2NwdV9tZm5f
bnIgKyAxXTsKKyAgICAgICAgbWZuID0gX21mbihtZm5fbGlzdFtwZXJfY3B1X21mbl9vZmZzZXQg
KyBwZXJfY3B1X21mbl9uciArIDFdKTsKICAgICAgICAgKm5leHRfcGFnZSA9IG1mbl90b192aXJ0
KG1mbik7CiAgICAgfQogICAgIHJldHVybiB0aGlzX3BhZ2U7CmRpZmYgLS1naXQgYS94ZW4vY29t
bW9uL3hlbm9wcm9mLmMgYi94ZW4vY29tbW9uL3hlbm9wcm9mLmMKaW5kZXggNGYzZTc5OWViYi4u
MjcyMWU5OWRhNyAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi94ZW5vcHJvZi5jCisrKyBiL3hlbi9j
b21tb24veGVub3Byb2YuYwpAQCAtMTksMTAgKzE5LDYgQEAKICNpbmNsdWRlIDx4c20veHNtLmg+
CiAjaW5jbHVkZSA8eGVuL2h5cGVyY2FsbC5oPgogCi0vKiBPdmVycmlkZSBtYWNyb3MgZnJvbSBh
c20vcGFnZS5oIHRvIG1ha2UgdGhlbSB3b3JrIHdpdGggbWZuX3QgKi8KLSN1bmRlZiB2aXJ0X3Rv
X21mbgotI2RlZmluZSB2aXJ0X3RvX21mbih2YSkgX21mbihfX3ZpcnRfdG9fbWZuKHZhKSkKLQog
LyogTGltaXQgYW1vdW50IG9mIHBhZ2VzIHVzZWQgZm9yIHNoYXJlZCBidWZmZXIgKHBlciBkb21h
aW4pICovCiAjZGVmaW5lIE1BWF9PUFJPRl9TSEFSRURfUEFHRVMgMzIKIApkaWZmIC0tZ2l0IGEv
eGVuL2RyaXZlcnMvYWNwaS9vc2wuYyBiL3hlbi9kcml2ZXJzL2FjcGkvb3NsLmMKaW5kZXggNGM4
YmI3ODM5ZS4uY2EzODU2NTUwNyAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvYWNwaS9vc2wuYwor
KysgYi94ZW4vZHJpdmVycy9hY3BpL29zbC5jCkBAIC0yMTksNyArMjE5LDcgQEAgdm9pZCAqX19p
bml0IGFjcGlfb3NfYWxsb2NfbWVtb3J5KHNpemVfdCBzeikKIAl2b2lkICpwdHI7CiAKIAlpZiAo
c3lzdGVtX3N0YXRlID09IFNZU19TVEFURV9lYXJseV9ib290KQotCQlyZXR1cm4gbWZuX3RvX3Zp
cnQobWZuX3goYWxsb2NfYm9vdF9wYWdlcyhQRk5fVVAoc3opLCAxKSkpOworCQlyZXR1cm4gbWZu
X3RvX3ZpcnQoYWxsb2NfYm9vdF9wYWdlcyhQRk5fVVAoc3opLCAxKSk7CiAKIAlwdHIgPSB4bWFs
bG9jX2J5dGVzKHN6KTsKIAlBU1NFUlQoIXB0ciB8fCBpc194bWFsbG9jX21lbW9yeShwdHIpKTsK
ZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS1hcm0vbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS1h
cm0vbW0uaAppbmRleCA3ZGY5MTI4MGJjLi5hYmY0Y2MyM2U0IDEwMDY0NAotLS0gYS94ZW4vaW5j
bHVkZS9hc20tYXJtL21tLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLWFybS9tbS5oCkBAIC0yODUs
MTYgKzI4NSw4IEBAIHN0YXRpYyBpbmxpbmUgdWludDY0X3QgZ3ZpcnRfdG9fbWFkZHIodmFkZHJf
dCB2YSwgcGFkZHJfdCAqcGEsCiAjZGVmaW5lIF9fdmEoeCkgICAgICAgICAgICAgKG1hZGRyX3Rv
X3ZpcnQoeCkpCiAKIC8qIENvbnZlcnQgYmV0d2VlbiBYZW4taGVhcCB2aXJ0dWFsIGFkZHJlc3Nl
cyBhbmQgbWFjaGluZSBmcmFtZSBudW1iZXJzLiAqLwotI2RlZmluZSBfX3ZpcnRfdG9fbWZuKHZh
KSAodmlydF90b19tYWRkcih2YSkgPj4gUEFHRV9TSElGVCkKLSNkZWZpbmUgX19tZm5fdG9fdmly
dChtZm4pIChtYWRkcl90b192aXJ0KChwYWRkcl90KShtZm4pIDw8IFBBR0VfU0hJRlQpKQotCi0v
KgotICogV2UgZGVmaW5lIG5vbi11bmRlcnNjb3JlZCB3cmFwcGVycyBmb3IgYWJvdmUgY29udmVy
c2lvbiBmdW5jdGlvbnMuCi0gKiBUaGVzZSBhcmUgb3ZlcnJpZGVuIGluIHZhcmlvdXMgc291cmNl
IGZpbGVzIHdoaWxlIHVuZGVyc2NvcmVkIHZlcnNpb24KLSAqIHJlbWFpbiBpbnRhY3QuCi0gKi8K
LSNkZWZpbmUgdmlydF90b19tZm4odmEpICAgICBfX3ZpcnRfdG9fbWZuKHZhKQotI2RlZmluZSBt
Zm5fdG9fdmlydChtZm4pICAgIF9fbWZuX3RvX3ZpcnQobWZuKQorI2RlZmluZSB2aXJ0X3RvX21m
bih2YSkgICAgIG1hZGRyX3RvX21mbih2aXJ0X3RvX21hZGRyKHZhKSkKKyNkZWZpbmUgbWZuX3Rv
X3ZpcnQobWZuKSAgICBtYWRkcl90b192aXJ0KG1mbl90b19tYWRkcihtZm4pKQogCiAvKiBDb252
ZXJ0IGJldHdlZW4gWGVuLWhlYXAgdmlydHVhbCBhZGRyZXNzZXMgYW5kIHBhZ2UtaW5mbyBzdHJ1
Y3R1cmVzLiAqLwogc3RhdGljIGlubGluZSBzdHJ1Y3QgcGFnZV9pbmZvICp2aXJ0X3RvX3BhZ2Uo
Y29uc3Qgdm9pZCAqdikKQEAgLTMxMiw3ICszMDQsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBw
YWdlX2luZm8gKnZpcnRfdG9fcGFnZShjb25zdCB2b2lkICp2KQogCiBzdGF0aWMgaW5saW5lIHZv
aWQgKnBhZ2VfdG9fdmlydChjb25zdCBzdHJ1Y3QgcGFnZV9pbmZvICpwZykKIHsKLSAgICByZXR1
cm4gbWZuX3RvX3ZpcnQobWZuX3gocGFnZV90b19tZm4ocGcpKSk7CisgICAgcmV0dXJuIG1mbl90
b192aXJ0KHBhZ2VfdG9fbWZuKHBnKSk7CiB9CiAKIHN0cnVjdCBwYWdlX2luZm8gKmdldF9wYWdl
X2Zyb21fZ3ZhKHN0cnVjdCB2Y3B1ICp2LCB2YWRkcl90IHZhLApkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLXg4Ni9ncmFudF90YWJsZS5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9ncmFudF90
YWJsZS5oCmluZGV4IDg0ZTMyOTYwYzAuLjU4NzEyMzhmNmQgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNs
dWRlL2FzbS14ODYvZ3JhbnRfdGFibGUuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2dyYW50
X3RhYmxlLmgKQEAgLTQ1LDExICs0NSwxMSBAQCBzdGF0aWMgaW5saW5lIGludCByZXBsYWNlX2dy
YW50X2hvc3RfbWFwcGluZyh1aW50NjRfdCBhZGRyLCBtZm5fdCBmcmFtZSwKICAgICBWQUxJRF9N
MlAoZ3Bmbl8pID8gX2dmbihncGZuXykgOiBJTlZBTElEX0dGTjsgICAgICAgICAgICAgICAgICAg
ICAgICBcCiB9KQogCi0jZGVmaW5lIGdudHRhYl9zaGFyZWRfbWZuKHQsIGkpIF9tZm4oX192aXJ0
X3RvX21mbigodCktPnNoYXJlZF9yYXdbaV0pKQorI2RlZmluZSBnbnR0YWJfc2hhcmVkX21mbih0
LCBpKSB2aXJ0X3RvX21mbigodCktPnNoYXJlZF9yYXdbaV0pCiAKICNkZWZpbmUgZ250dGFiX3No
YXJlZF9nZm4oZCwgdCwgaSkgbWZuX3RvX2dmbihkLCBnbnR0YWJfc2hhcmVkX21mbih0LCBpKSkK
IAotI2RlZmluZSBnbnR0YWJfc3RhdHVzX21mbih0LCBpKSBfbWZuKF9fdmlydF90b19tZm4oKHQp
LT5zdGF0dXNbaV0pKQorI2RlZmluZSBnbnR0YWJfc3RhdHVzX21mbih0LCBpKSB2aXJ0X3RvX21m
bigodCktPnN0YXR1c1tpXSkKIAogI2RlZmluZSBnbnR0YWJfc3RhdHVzX2dmbihkLCB0LCBpKSBt
Zm5fdG9fZ2ZuKGQsIGdudHRhYl9zdGF0dXNfbWZuKHQsIGkpKQogCmRpZmYgLS1naXQgYS94ZW4v
aW5jbHVkZS9hc20teDg2L21tLmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21tLmgKaW5kZXggOTc2
NDM2MmEzOC4uODMwNThmYjhkMSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5o
CisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaApAQCAtNjY3LDcgKzY2Nyw3IEBAIHN0YXRp
YyBpbmxpbmUgYm9vbCBhcmNoX21mbl9pbl9kaXJlY3RtYXAodW5zaWduZWQgbG9uZyBtZm4pCiB7
CiAgICAgdW5zaWduZWQgbG9uZyBldmEgPSBtaW4oRElSRUNUTUFQX1ZJUlRfRU5ELCBIWVBFUlZJ
U09SX1ZJUlRfRU5EKTsKIAotICAgIHJldHVybiBtZm4gPD0gKHZpcnRfdG9fbWZuKGV2YSAtIDEp
ICsgMSk7CisgICAgcmV0dXJuIG1mbiA8PSBtZm5feChtZm5fYWRkKHZpcnRfdG9fbWZuKGV2YSAt
IDEpLCAgMSkpOwogfQogCiBpbnQgYXJjaF9hY3F1aXJlX3Jlc291cmNlKHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbmVkIGludCB0eXBlLApkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9w
YWdlLmggYi94ZW4vaW5jbHVkZS9hc20teDg2L3BhZ2UuaAppbmRleCBjOThkOGY1ZWRlLi42MjRk
YmJiOTQ5IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3BhZ2UuaAorKysgYi94ZW4v
aW5jbHVkZS9hc20teDg2L3BhZ2UuaApAQCAtMjM2LDggKzIzNiw4IEBAIHZvaWQgY29weV9wYWdl
X3NzZTIodm9pZCAqLCBjb25zdCB2b2lkICopOwogI2RlZmluZSBfX3ZhKHgpICAgICAgICAgICAg
IChtYWRkcl90b192aXJ0KHgpKQogCiAvKiBDb252ZXJ0IGJldHdlZW4gWGVuLWhlYXAgdmlydHVh
bCBhZGRyZXNzZXMgYW5kIG1hY2hpbmUgZnJhbWUgbnVtYmVycy4gKi8KLSNkZWZpbmUgX192aXJ0
X3RvX21mbih2YSkgICAodmlydF90b19tYWRkcih2YSkgPj4gUEFHRV9TSElGVCkKLSNkZWZpbmUg
X19tZm5fdG9fdmlydChtZm4pICAobWFkZHJfdG9fdmlydCgocGFkZHJfdCkobWZuKSA8PCBQQUdF
X1NISUZUKSkKKyNkZWZpbmUgdmlydF90b19tZm4odmEpICAgICBtYWRkcl90b19tZm4odmlydF90
b19tYWRkcih2YSkpCisjZGVmaW5lIG1mbl90b192aXJ0KG1mbikgICAgbWFkZHJfdG9fdmlydCht
Zm5fdG9fbWFkZHIobWZuKSkKIAogLyogQ29udmVydCBiZXR3ZWVuIG1hY2hpbmUgZnJhbWUgbnVt
YmVycyBhbmQgcGFnZS1pbmZvIHN0cnVjdHVyZXMuICovCiAjZGVmaW5lIG1mbl90b19wYWdlKG1m
bikgICAgKGZyYW1lX3RhYmxlICsgbWZuX3RvX3BkeChtZm4pKQpAQCAtMjYwLDggKzI2MCw2IEBA
IHZvaWQgY29weV9wYWdlX3NzZTIodm9pZCAqLCBjb25zdCB2b2lkICopOwogICogb3ZlcnJpZGRl
biBpbiB2YXJpb3VzIHNvdXJjZSBmaWxlcyB3aGlsZSB1bmRlcnNjb3JlZCB2ZXJzaW9ucyByZW1h
aW4gaW50YWN0LgogICovCiAjZGVmaW5lIG1mbl92YWxpZChtZm4pICAgICAgX19tZm5fdmFsaWQo
bWZuX3gobWZuKSkKLSNkZWZpbmUgdmlydF90b19tZm4odmEpICAgICBfX3ZpcnRfdG9fbWZuKHZh
KQotI2RlZmluZSBtZm5fdG9fdmlydChtZm4pICAgIF9fbWZuX3RvX3ZpcnQobWZuKQogI2RlZmlu
ZSB2aXJ0X3RvX21hZGRyKHZhKSAgIF9fdmlydF90b19tYWRkcigodW5zaWduZWQgbG9uZykodmEp
KQogI2RlZmluZSBtYWRkcl90b192aXJ0KG1hKSAgIF9fbWFkZHJfdG9fdmlydCgodW5zaWduZWQg
bG9uZykobWEpKQogI2RlZmluZSBtYWRkcl90b19wYWdlKG1hKSAgIF9fbWFkZHJfdG9fcGFnZSht
YSkKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9kb21haW5fcGFnZS5oIGIveGVuL2luY2x1
ZGUveGVuL2RvbWFpbl9wYWdlLmgKaW5kZXggYWIyYmU3YjcxOS4uMDMxNDg0NTkyMSAxMDA2NDQK
LS0tIGEveGVuL2luY2x1ZGUveGVuL2RvbWFpbl9wYWdlLmgKKysrIGIveGVuL2luY2x1ZGUveGVu
L2RvbWFpbl9wYWdlLmgKQEAgLTUzLDE0ICs1MywxNCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgKl9f
bWFwX2RvbWFpbl9wYWdlX2dsb2JhbChjb25zdCBzdHJ1Y3QgcGFnZV9pbmZvICpwZykKIAogI2Vs
c2UgLyogIUNPTkZJR19ET01BSU5fUEFHRSAqLwogCi0jZGVmaW5lIG1hcF9kb21haW5fcGFnZSht
Zm4pICAgICAgICAgICAgICAgIF9fbWZuX3RvX3ZpcnQobWZuX3gobWZuKSkKKyNkZWZpbmUgbWFw
X2RvbWFpbl9wYWdlKG1mbikgICAgICAgICAgICAgICAgbWZuX3RvX3ZpcnQobWZuKQogI2RlZmlu
ZSBfX21hcF9kb21haW5fcGFnZShwZykgICAgICAgICAgICAgICBwYWdlX3RvX3ZpcnQocGcpCiAj
ZGVmaW5lIHVubWFwX2RvbWFpbl9wYWdlKHZhKSAgICAgICAgICAgICAgICgodm9pZCkodmEpKQot
I2RlZmluZSBkb21haW5fcGFnZV9tYXBfdG9fbWZuKHZhKSAgICAgICAgICBfbWZuKHZpcnRfdG9f
bWZuKCh1bnNpZ25lZCBsb25nKSh2YSkpKQorI2RlZmluZSBkb21haW5fcGFnZV9tYXBfdG9fbWZu
KHZhKSAgICAgICAgICB2aXJ0X3RvX21mbigodW5zaWduZWQgbG9uZykodmEpKQogCiBzdGF0aWMg
aW5saW5lIHZvaWQgKm1hcF9kb21haW5fcGFnZV9nbG9iYWwobWZuX3QgbWZuKQogewotICAgIHJl
dHVybiBtZm5fdG9fdmlydChtZm5feChtZm4pKTsKKyAgICByZXR1cm4gbWZuX3RvX3ZpcnQobWZu
KTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkICpfX21hcF9kb21haW5fcGFnZV9nbG9iYWwoY29u
c3Qgc3RydWN0IHBhZ2VfaW5mbyAqcGcpCi0tIAoyLjE3LjEKCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1k
ZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21h
aWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id F2E7511AA83
	for <lists+xen-devel@lfdr.de>; Wed, 11 Dec 2019 13:13:15 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1if0oP-0005Yi-V5; Wed, 11 Dec 2019 12:09:49 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=+9Em=2B=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1if0oO-0005Xx-7m
 for xen-devel@lists.xen.org; Wed, 11 Dec 2019 12:09:48 +0000
X-Inumbo-ID: 157e0a8c-1c0f-11ea-8b1b-12813bfff9fa
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 157e0a8c-1c0f-11ea-8b1b-12813bfff9fa;
 Wed, 11 Dec 2019 12:09:30 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1if0o0-0008RV-W3; Wed, 11 Dec 2019 12:09:24 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1if0o0-0001cS-Uo; Wed, 11 Dec 2019 12:09:24 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1if0o0-0001cS-Uo@xenbits.xenproject.org>
Date: Wed, 11 Dec 2019 12:09:24 +0000
Subject: [Xen-devel] Xen Security Advisory 311 v4 (CVE-2019-19577) - Bugs in
 dynamic height handling for AMD IOMMU pagetables
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-19577 / XSA-311
                               version 4

         Bugs in dynamic height handling for AMD IOMMU pagetables

UPDATES IN VERSION 4
====================

Public release.

Re-base 4.12 patch onto latest stable tree commits.

Updated metadata to add 4.13, update StableRef's

ISSUE DESCRIPTION
=================

When running on AMD systems with an IOMMU, Xen attempted to
dynamically adapt the number of levels of pagetables (the pagetable
height) in the IOMMU according to the guest's address space size.  The
code to select and update the height had several bugs.

Notably, the update was done without taking a lock which is necessary
for safe operation.

IMPACT
======

A malicious guest administrator can cause Xen to access data
structures while they are being modified, causing Xen to crash.
Privilege escalation is thought to be very difficult but cannot be
ruled out.

Additionally, there is a potential memory leak of 4kb per guest boot,
under memory pressure.

VULNERABLE SYSTEMS
==================

Only Xen on AMD CPUs is vulnerable.  Xen running on Intel CPUs is not
vulnerable.  ARM systems are not vulnerable.

Only systems where guests are given direct access to physical devices
are vulnerable.  Systems which do not use PCI pass-through are not
vulnerable.

Only HVM guests can exploit the vulnerability.  PV and PVH guests
cannot.

All versions of Xen with IOMMU support are vulnerable.

MITIGATION
==========

In some configurations, use of passthrough can be replaced with a
higher-level protocol such as Xen PV block or network devices.
There is no other mitigation.

CREDITS
=======

This issue was discovered by Sander Eikelenboom, along with Andrew Cooper of
Citrix.

RESOLUTION
==========

Applying the appropriate (set of) attached patch(es) resolves this issue.

xsa311.patch           xen-unstable, Xen 4.13.x
xsa311-4.12.patch      Xen 4.12.x
xsa311-4.11.patch      Xen 4.11.x
xsa311-4.10-*.patch    Xen 4.10.x
xsa311-4.9-*.patch     Xen 4.9.x
xsa311-4.8-*.patch     Xen 4.8.x

$ sha256sum xsa311*
ea929752043b5d4659cb605314887441daa33ee6450e755d6f077e57fc7abf9e  xsa311.meta
732975f33b6d893b984540c4c748eb5cdf1cf81bd565e41b57795458cae3ccad  xsa311.patch
27e30da9360eec850f6e7d8f2ea465d2f00a5a5a45c43042e4c18786c6c9338f  xsa311-4.8-1.patch
6e2372eb18f3ca25093445a93bcdf674ed2d7d3012e8611911ea2b9ca8d58bd4  xsa311-4.8-2.patch
c73bee7aa8fac02d0982b4fb21de053918f80cc0158bd5bfca68e3dc994759be  xsa311-4.9-1.patch
e89f5c381bd6a8fa8c5f63a829b586fdbefefe311c0f1084d2baeea3e933da66  xsa311-4.9-2.patch
c73bee7aa8fac02d0982b4fb21de053918f80cc0158bd5bfca68e3dc994759be  xsa311-4.10-1.patch
189a51048ad88efd855e6e78a307fff68e0c139225ce528c253558d266fffe02  xsa311-4.10-2.patch
1aaf26d1c231c8b5dd00900c00c18bf884d23b9568c9746866d92f39daf1c02f  xsa311-4.11.patch
5f43fa4628f6d1a8f6f903e662226a09524b8c354e06e1a6039837db656c0218  xsa311-4.12.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.


(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl3w3F8MHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZgF0IAIOtY9LMbRkBWgc16lOs+MTDOC7h4fYqofjQetFN
wAJ2Q3w2QXN+Zt54L8dmc6+Zzvn9Do4AJeMvfCzFxuw2OaMBwcwI9DcEbZ+CvYsa
hiXf9xKBBEfCu8PjisRnBqKuyqrLQdBSad9vXcGOVloXiFzJ1wbKnSMBNig9ZTi2
us3c9MeUTnf95W/KTQNe2Gu8KQiogzzBUUifdB6YU0MNNhL60OzfSwgautD9XHfA
+NcRogDnf6KgAs6VKgHSDxyVWbvnaWvKWGF2M2QXwXHjqCH/ox87OIIgZ/HSodXB
e07vCaweCG4GgWDGQN5K3+9Cu1B6+t0RYzPYmuhPDy/kWF0=
=RJ0B
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa311.meta"
Content-Disposition: attachment; filename="xsa311.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAzMTEsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMyIsCiAgICAiNC4xMiIsCiAgICAiNC4xMSIs
CiAgICAiNC4xMCIsCiAgICAiNC45IiwKICAgICI0LjgiCiAgXSwKICAiVHJl
ZXMiOiBbCiAgICAieGVuIgogIF0sCiAgIlJlY2lwZXMiOiB7CiAgICAiNC4x
MCI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAg
ICAgICAgICJTdGFibGVSZWYiOiAiZTQ4OTk1NTBmZjc4MzRlMWVhNWRmYmJm
YjFjNjE4ZjY0ZTI0Nzc2MSIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAg
ICAgICAgICAgMzA3LAogICAgICAgICAgICAzMDgsCiAgICAgICAgICAgIDMw
OSwKICAgICAgICAgICAgMzEwCiAgICAgICAgICBdLAogICAgICAgICAgIlBh
dGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EzMTEtNC4xMC0qLnBhdGNoIgog
ICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjEx
IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAg
ICAgICAgIlN0YWJsZVJlZiI6ICIyMzlkMzdlNTE0YzkzZTI5ZDUwZDcxZjcz
NGIxZGM0NTNiMjIzNmE2IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAg
ICAgICAgICAzMDcsCiAgICAgICAgICAgIDMwOCwKICAgICAgICAgICAgMzA5
LAogICAgICAgICAgICAzMTAKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0
Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTMxMS00LjExLnBhdGNoIgogICAg
ICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjEyIjog
ewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAg
ICAgIlN0YWJsZVJlZiI6ICIyMTJiODUwMGNiMzk0YjNhNjY0NjU1Zjc5Y2Ew
YmRjYjMxMjQ2ZmY3IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAg
ICAgICAzMDcsCiAgICAgICAgICAgIDMwOCwKICAgICAgICAgICAgMzA5LAog
ICAgICAgICAgICAzMTAKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hl
cyI6IFsKICAgICAgICAgICAgInhzYTMxMS00LjEyLnBhdGNoIgogICAgICAg
ICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjEzIjogewog
ICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAg
IlN0YWJsZVJlZiI6ICJmZDliZmFiZjY5ZWE1OWYyMjgwYzE3MDM1MDA3OTNm
YTE1ZTgxOTU2IiwKICAgICAgICAgICJQcmVyZXFzIjogW10sCiAgICAgICAg
ICAiUGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTMxMS5wYXRjaCIKICAg
ICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC44Ijog
ewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAg
ICAgIlN0YWJsZVJlZiI6ICJhMjYwZTkzZGI3OTRmNTYwNTAyZTg5ODU5YWFm
MTExZDE3OGU4MGU0IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAg
ICAgICAzMDcsCiAgICAgICAgICAgIDMwOCwKICAgICAgICAgICAgMzA5LAog
ICAgICAgICAgICAzMTAKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hl
cyI6IFsKICAgICAgICAgICAgInhzYTMxMS00LjgtKi5wYXRjaCIKICAgICAg
ICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC45Ijogewog
ICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAg
IlN0YWJsZVJlZiI6ICI4ZDFlZTlmMmM0NzNmZWM1NGI1MDE4YzAxYWQ1NTZk
N2FmZDYyYzE3IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAg
ICAzMDcsCiAgICAgICAgICAgIDMwOCwKICAgICAgICAgICAgMzA5LAogICAg
ICAgICAgICAzMTAKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6
IFsKICAgICAgICAgICAgInhzYTMxMS00LjktKi5wYXRjaCIKICAgICAgICAg
IF0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAibWFzdGVyIjogewog
ICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAg
IlN0YWJsZVJlZiI6ICJiNzNhYWQ0YzhiNmE3NjdjZTE1Y2M4Y2I2NWY5ZWVh
YjdiZmNjZGFlIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAg
ICAzMDcsCiAgICAgICAgICAgIDMwOCwKICAgICAgICAgICAgMzA5LAogICAg
ICAgICAgICAzMTAKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6
IFsKICAgICAgICAgICAgInhzYTMxMS5wYXRjaCIKICAgICAgICAgIF0KICAg
ICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0=

--=separator
Content-Type: application/octet-stream; name="xsa311.patch"
Content-Disposition: attachment; filename="xsa311.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogQU1EL0lPTU1VOiBDZWFzZSB1c2luZyBhIGR5bmFtaWMg
aGVpZ2h0IGZvciB0aGUgSU9NTVUgcGFnZXRhYmxlcwoKdXBkYXRlX3BhZ2lu
Z19tb2RlKCkgaGFzIG11bHRpcGxlIGJ1Z3M6CgogMSkgQm9vdGluZyB3aXRo
IGlvbW11PWRlYnVnIHdpbGwgY2F1c2UgaXQgdG8gaW5mb3JtIHlvdSB0aGF0
IHRoYXQgaXQgY2FsbGVkCiAgICB3aXRob3V0IHRoZSBwZGV2X2xpc3QgbG9j
ayBoZWxkLgogMikgV2hlbiBncm93aW5nIGJ5IG1vcmUgdGhhbiBhIHNpbmds
ZSBsZXZlbCwgaXQgbGVha3MgdGhlIG5ld2x5IGFsbG9jYXRlZAogICAgdGFi
bGUocykgaW4gdGhlIGNhc2Ugb2YgYSBmdXJ0aGVyIGVycm9yLgoKRnVydGhl
cm1vcmUsIHRoZSBjaG9pY2Ugb2YgZGVmYXVsdCBsZXZlbCBmb3IgYSBkb21h
aW4gaGFzIGlzc3VlczoKCiAxKSBBbGwgSFZNIGd1ZXN0cyBncm93IGZyb20g
MiB0byAzIGxldmVscyBkdXJpbmcgY29uc3RydWN0aW9uIGJlY2F1c2Ugb2Yg
dGhlCiAgICBwb3NpdGlvbiBvZiB0aGUgVlJBTSBqdXN0IGJlbG93IHRoZSA0
RyBib3VuZGFyeSwgc28gZGVmYXVsdGluZyB0byAyIGlzIGEKICAgIHdhc3Rl
IG9mIGVmZm9ydC4KIDIpIFRoZSBsaW1pdCBmb3IgUFYgZ3Vlc3RzIGRvZXNu
J3QgdGFrZSBtZW1vcnkgaG90cGx1ZyBpbnRvIGFjY291bnQsIGFuZAogICAg
aXNuJ3QgZHluYW1pYyBhdCBydW50aW1lIGxpa2UgSFZNIGd1ZXN0cy4gIFRo
aXMgbWVhbnMgdGhhdCBhIFBWIGd1ZXN0IG1heQogICAgZ2V0IFJBTSB3aGlj
aCBpdCBjYW4ndCBtYXAgaW4gdGhlIElPTU1VLgoKVGhlIGR5bmFtaWMgaGVp
Z2h0IGlzIGEgcHJvcGVydHkgdW5pcXVlIHRvIEFNRCwgYW5kIGFkZHMgYSBz
dWJzdGFudGlhbApxdWFudGl0eSBvZiBjb21wbGV4aXR5IGZvciB3aGF0IGlz
IGEgbWFyZ2luYWwgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQuICBSZW1vdmUK
dGhlIGNvbXBsZXhpdHkgYnkgcmVtb3ZpbmcgdGhlIGR5bmFtaWMgaGVpZ2h0
LgoKUFYgZ3Vlc3RzIG5vdyBnZXQgMyBvciA0IGxldmVscyBiYXNlZCBvbiBh
bnkgaG90cGx1ZyByZWdpb25zIGluIHRoZSBob3N0LgpUaGlzIG9ubHkgbWFr
ZXMgYSBkaWZmZXJlbmNlIGZvciBoYXJkd2FyZSB3aGljaCBwcmV2aW91c2x5
IGhhZCBhbGwgUkFNIGJlbG93CnRoZSA1MTJHIGJvdW5kYXJ5LCBhbmQgYSBo
b3RwbHVnIHJlZ2lvbiBhYm92ZS4KCkhWTSBndWVzdHMgbm93IGdldCA0IGxl
dmVscyAod2hpY2ggd2lsbCBiZSBzdWZmaWNpZW50IHVudGlsIDI1NlRCIGd1
ZXN0cwpiZWNvbWUgYSB0aGluZyksIGJlY2F1c2Ugd2UgZG9uJ3QgY3VycmVu
dGx5IGhhdmUgdGhlIGluZm9ybWF0aW9uIHRvIGtub3cgd2hlbgozIHdvdWxk
IGJlIHNhZmUgdG8gdXNlLgoKVGhlIG92ZXJoZWFkIG9mIHRoaXMgZXh0cmEg
bGV2ZWwgaXMgbm90IGV4cGVjdGVkIHRvIGJlIG5vdGljZWFibGUuICBJdCBj
b3N0cwpvbmUgcGFnZSAoNGspIHBlciBkb21haW4sIGFuZCBvbmUgZXh0cmEg
SU8tVExCIHBhZ2luZyBzdHJ1Y3R1cmUgY2FjaGUgZW50cnkKd2hpY2ggaXMg
dmVyeSBob3QgYW5kIGxlc3MgbGlrZWx5IHRvIGJlIGV2aWN0ZWQuCgpUaGlz
IGlzIFhTQS0zMTEuCgpSZXBvcnRlZC1ieTogWFhYIFBFUlNPTiA8WFhYIEVN
QUlMPjMKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRpZmYgLS1naXQgYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMgYi94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKaW5kZXggNTRlMWQx
MzJkOS4uNGUwNDFiOTYwZiAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYwpAQCAtMjg1LDEwMCArMjg1LDYg
QEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9kZm4oc3RydWN0IGRvbWFp
biAqZCwgdW5zaWduZWQgbG9uZyBkZm4sCiAgICAgcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdXBkYXRlX3BhZ2luZ19tb2RlKHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbmVkIGxvbmcgZGZuKQotewotICAgIHVpbnQxNl90IGJkZjsK
LSAgICBzdHJ1Y3QgYW1kX2lvbW11X2R0ZSAqdGFibGUsICpkdGU7Ci0gICAg
dW5zaWduZWQgaW50IHJlcV9pZCwgbGV2ZWwsIG9mZnNldDsKLSAgICB1bnNp
Z25lZCBsb25nIGZsYWdzOwotICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2Owot
ICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11ID0gTlVMTDsKLSAgICBzdHJ1
Y3QgcGFnZV9pbmZvICpuZXdfcm9vdCA9IE5VTEw7Ci0gICAgc3RydWN0IHBh
Z2VfaW5mbyAqb2xkX3Jvb3QgPSBOVUxMOwotICAgIHN0cnVjdCBhbWRfaW9t
bXVfcHRlICpuZXdfcm9vdF92YWRkcjsKLSAgICB1bnNpZ25lZCBsb25nIG9s
ZF9yb290X21mbjsKLSAgICBzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCA9IGRv
bV9pb21tdShkKTsKLQotICAgIGlmICggZGZuID09IGRmbl94KElOVkFMSURf
REZOKSApCi0gICAgICAgIHJldHVybiAtRUFERFJOT1RBVkFJTDsKLSAgICBB
U1NFUlQoIShkZm4gPj4gREVGQVVMVF9ET01BSU5fQUREUkVTU19XSURUSCkp
OwotCi0gICAgbGV2ZWwgPSBoZC0+YXJjaC5wYWdpbmdfbW9kZTsKLSAgICBv
bGRfcm9vdCA9IGhkLT5hcmNoLnJvb3RfdGFibGU7Ci0gICAgb2Zmc2V0ID0g
ZGZuID4+IChQVEVfUEVSX1RBQkxFX1NISUZUICogKGxldmVsIC0gMSkpOwot
Ci0gICAgQVNTRVJUKHNwaW5faXNfbG9ja2VkKCZoZC0+YXJjaC5tYXBwaW5n
X2xvY2spICYmIGlzX2h2bV9kb21haW4oZCkpOwotCi0gICAgd2hpbGUgKCBv
ZmZzZXQgPj0gUFRFX1BFUl9UQUJMRV9TSVpFICkKLSAgICB7Ci0gICAgICAg
IC8qIEFsbG9jYXRlIGFuZCBpbnN0YWxsIGEgbmV3IHJvb3QgdGFibGUuCi0g
ICAgICAgICAqIE9ubHkgdXBwZXIgSS9PIHBhZ2UgdGFibGUgZ3Jvd3MsIG5v
IG5lZWQgdG8gZml4IG5leHQgbGV2ZWwgYml0cyAqLwotICAgICAgICBuZXdf
cm9vdCA9IGFsbG9jX2FtZF9pb21tdV9wZ3RhYmxlKCk7Ci0gICAgICAgIGlm
ICggbmV3X3Jvb3QgPT0gTlVMTCApCi0gICAgICAgIHsKLSAgICAgICAgICAg
IEFNRF9JT01NVV9ERUJVRygiJXMgQ2Fubm90IGFsbG9jYXRlIEkvTyBwYWdl
IHRhYmxlXG4iLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fZnVu
Y19fKTsKLSAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwotICAgICAgICB9
Ci0KLSAgICAgICAgbmV3X3Jvb3RfdmFkZHIgPSBfX21hcF9kb21haW5fcGFn
ZShuZXdfcm9vdCk7Ci0gICAgICAgIG9sZF9yb290X21mbiA9IG1mbl94KHBh
Z2VfdG9fbWZuKG9sZF9yb290KSk7Ci0gICAgICAgIHNldF9pb21tdV9wZGVf
cHJlc2VudChuZXdfcm9vdF92YWRkciwgb2xkX3Jvb3RfbWZuLCBsZXZlbCwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsIHRydWUpOwot
ICAgICAgICBsZXZlbCsrOwotICAgICAgICBvbGRfcm9vdCA9IG5ld19yb290
OwotICAgICAgICBvZmZzZXQgPj49IFBURV9QRVJfVEFCTEVfU0hJRlQ7Ci0g
ICAgICAgIHVubWFwX2RvbWFpbl9wYWdlKG5ld19yb290X3ZhZGRyKTsKLSAg
ICB9Ci0KLSAgICBpZiAoIG5ld19yb290ICE9IE5VTEwgKQotICAgIHsKLSAg
ICAgICAgaGQtPmFyY2gucGFnaW5nX21vZGUgPSBsZXZlbDsKLSAgICAgICAg
aGQtPmFyY2gucm9vdF90YWJsZSA9IG5ld19yb290OwotCi0gICAgICAgIGlm
ICggIXBjaWRldnNfbG9ja2VkKCkgKQotICAgICAgICAgICAgQU1EX0lPTU1V
X0RFQlVHKCIlcyBUcnkgdG8gYWNjZXNzIHBkZXZfbGlzdCAiCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIndpdGhvdXQgYXF1aXJpbmcgcGNpZGV2
c19sb2NrLlxuIiwgX19mdW5jX18pOwotCi0gICAgICAgIC8qIFVwZGF0ZSBk
ZXZpY2UgdGFibGUgZW50cmllcyB1c2luZyBuZXcgcm9vdCB0YWJsZSBhbmQg
cGFnaW5nIG1vZGUgKi8KLSAgICAgICAgZm9yX2VhY2hfcGRldiggZCwgcGRl
diApCi0gICAgICAgIHsKLSAgICAgICAgICAgIGlmICggcGRldi0+dHlwZSA9
PSBERVZfVFlQRV9QQ0lfSE9TVF9CUklER0UgKQotICAgICAgICAgICAgICAg
IGNvbnRpbnVlOwotCi0gICAgICAgICAgICBiZGYgPSBQQ0lfQkRGMihwZGV2
LT5idXMsIHBkZXYtPmRldmZuKTsKLSAgICAgICAgICAgIGlvbW11ID0gZmlu
ZF9pb21tdV9mb3JfZGV2aWNlKHBkZXYtPnNlZywgYmRmKTsKLSAgICAgICAg
ICAgIGlmICggIWlvbW11ICkKLSAgICAgICAgICAgIHsKLSAgICAgICAgICAg
ICAgICBBTURfSU9NTVVfREVCVUcoIiVzIEZhaWwgdG8gZmluZCBpb21tdS5c
biIsIF9fZnVuY19fKTsKLSAgICAgICAgICAgICAgICByZXR1cm4gLUVOT0RF
VjsKLSAgICAgICAgICAgIH0KLQotICAgICAgICAgICAgc3Bpbl9sb2NrX2ly
cXNhdmUoJmlvbW11LT5sb2NrLCBmbGFncyk7Ci0gICAgICAgICAgICBkbyB7
Ci0gICAgICAgICAgICAgICAgcmVxX2lkID0gZ2V0X2RtYV9yZXF1ZXN0b3Jf
aWQocGRldi0+c2VnLCBiZGYpOwotICAgICAgICAgICAgICAgIHRhYmxlID0g
aW9tbXUtPmRldl90YWJsZS5idWZmZXI7Ci0gICAgICAgICAgICAgICAgZHRl
ID0gJnRhYmxlW3JlcV9pZF07Ci0KLSAgICAgICAgICAgICAgICAvKiB2YWxp
ZCA9IDAgb25seSB3b3JrcyBmb3IgZG9tMCBwYXNzdGhyb3VnaCBtb2RlICov
Ci0gICAgICAgICAgICAgICAgYW1kX2lvbW11X3NldF9yb290X3BhZ2VfdGFi
bGUoZHRlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBhZ2VfdG9fbWFkZHIoaGQtPmFyY2gucm9vdF90YWJsZSks
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZC0+ZG9tYWluX2lkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGhkLT5hcmNoLnBhZ2luZ19tb2RlLCAxKTsK
LQotICAgICAgICAgICAgICAgIGFtZF9pb21tdV9mbHVzaF9kZXZpY2UoaW9t
bXUsIHJlcV9pZCk7Ci0gICAgICAgICAgICAgICAgYmRmICs9IHBkZXYtPnBo
YW50b21fc3RyaWRlOwotICAgICAgICAgICAgfSB3aGlsZSAoIFBDSV9ERVZG
TjIoYmRmKSAhPSBwZGV2LT5kZXZmbiAmJgotICAgICAgICAgICAgICAgICAg
ICAgIFBDSV9TTE9UKGJkZikgPT0gUENJX1NMT1QocGRldi0+ZGV2Zm4pICk7
Ci0gICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21tdS0+
bG9jaywgZmxhZ3MpOwotICAgICAgICB9Ci0KLSAgICAgICAgLyogRm9yIHNh
ZmV0eSwgaW52YWxpZGF0ZSBhbGwgZW50cmllcyAqLwotICAgICAgICBhbWRf
aW9tbXVfZmx1c2hfYWxsX3BhZ2VzKGQpOwotICAgIH0KLSAgICByZXR1cm4g
MDsKLX0KLQogaW50IGFtZF9pb21tdV9tYXBfcGFnZShzdHJ1Y3QgZG9tYWlu
ICpkLCBkZm5fdCBkZm4sIG1mbl90IG1mbiwKICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgaW50IGZsYWdzLCB1bnNpZ25lZCBpbnQgKmZsdXNo
X2ZsYWdzKQogewpAQCAtNDAwLDIwICszMDYsNiBAQCBpbnQgYW1kX2lvbW11
X21hcF9wYWdlKHN0cnVjdCBkb21haW4gKmQsIGRmbl90IGRmbiwgbWZuX3Qg
bWZuLAogICAgICAgICByZXR1cm4gcmM7CiAgICAgfQogCi0gICAgLyogU2lu
Y2UgSFZNIGRvbWFpbiBpcyBpbml0aWFsaXplZCB3aXRoIDIgbGV2ZWwgSU8g
cGFnZSB0YWJsZSwKLSAgICAgKiB3ZSBtaWdodCBuZWVkIGEgZGVlcGVyIHBh
Z2UgdGFibGUgZm9yIHdpZGVyIGRmbiBub3cgKi8KLSAgICBpZiAoIGlzX2h2
bV9kb21haW4oZCkgKQotICAgIHsKLSAgICAgICAgaWYgKCB1cGRhdGVfcGFn
aW5nX21vZGUoZCwgZGZuX3goZGZuKSkgKQotICAgICAgICB7Ci0gICAgICAg
ICAgICBzcGluX3VubG9jaygmaGQtPmFyY2gubWFwcGluZ19sb2NrKTsKLSAg
ICAgICAgICAgIEFNRF9JT01NVV9ERUJVRygiVXBkYXRlIHBhZ2UgbW9kZSBm
YWlsZWQgZGZuID0gJSJQUklfZGZuIlxuIiwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkZm5feChkZm4pKTsKLSAgICAgICAgICAgIGRvbWFpbl9j
cmFzaChkKTsKLSAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOwotICAgICAg
ICB9Ci0gICAgfQotCiAgICAgaWYgKCBpb21tdV9wZGVfZnJvbV9kZm4oZCwg
ZGZuX3goZGZuKSwgcHRfbWZuLCB0cnVlKSB8fCAocHRfbWZuWzFdID09IDAp
ICkKICAgICB7CiAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJjaC5tYXBw
aW5nX2xvY2spOwpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKaW5kZXggNGRhNjUxODc3My4uZGQz
NDAxZjBkYyAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCkBAIC0yNTEsMTAgKzI1MSwxNyBA
QCBzdGF0aWMgaW50IGFtZF9pb21tdV9kb21haW5faW5pdChzdHJ1Y3QgZG9t
YWluICpkKQogewogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOwogCi0gICAgLyogRm9yIHB2IGFuZCBkb20wLCBzdGljayB3
aXRoIGdldF9wYWdpbmdfbW9kZShtYXhfcGFnZSkKLSAgICAgKiBGb3IgSFZN
IGRvbTAsIHVzZSAyIGxldmVsIHBhZ2UgdGFibGUgYXQgZmlyc3QgKi8KLSAg
ICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IGlzX2h2bV9kb21haW4oZCkgPwot
ICAgICAgICAyIDogYW1kX2lvbW11X2dldF9wYWdpbmdfbW9kZShtYXhfcGFn
ZSk7CisgICAgLyoKKyAgICAgKiBDaG9vc2UgdGhlIG51bWJlciBvZiBsZXZl
bHMgZm9yIHRoZSBJT01NVSBwYWdlIHRhYmxlcy4KKyAgICAgKiAtIFBWIG5l
ZWRzIDMgb3IgNCwgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlcmUgaXMgUkFN
IChpbmNsdWRpbmcgaG90cGx1ZworICAgICAqICAgUkFNKSBhYm92ZSB0aGUg
NTEyRyBib3VuZGFyeS4KKyAgICAgKiAtIEhWTSBjb3VsZCBpbiBwcmluY2lw
bGUgdXNlIDMgb3IgNCBkZXBlbmRpbmcgb24gaG93IG11Y2ggZ3Vlc3QKKyAg
ICAgKiAgIHBoeXNpY2FsIGFkZHJlc3Mgc3BhY2Ugd2UgZ2l2ZSBpdCwgYnV0
IHRoaXMgaXNuJ3Qga25vd24geWV0IHNvIHVzZSA0CisgICAgICogICB1bmls
YXRlcmFsbHkuCisgICAgICovCisgICAgaGQtPmFyY2gucGFnaW5nX21vZGUg
PSBpc19odm1fZG9tYWluKGQpCisgICAgICAgID8gNCA6IGFtZF9pb21tdV9n
ZXRfcGFnaW5nX21vZGUoZ2V0X3VwcGVyX21mbl9ib3VuZCgpKTsKKwogICAg
IHJldHVybiAwOwogfQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa311-4.8-1.patch"
Content-Disposition: attachment; filename="xsa311-4.8-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRvbid0IG5lZWRsZXNzbHkgdHJpZ2dlciBlcnJvcnMv
Y3Jhc2hlcyB3aGVuIHVubWFwcGluZyBhIHBhZ2UKClVubWFwcGluZyBhIHBh
Z2Ugd2hpY2ggaGFzIG5ldmVyIGJlZW4gbWFwcGVkIHNob3VsZCBiZSBhIG5v
LW9wIChub3RlIGhvdwppdCBhbHJlYWR5IGlzIGluIGNhc2UgdGhlcmUgd2Fz
IG5vIHJvb3QgcGFnZSB0YWJsZSBhbGxvY2F0ZWQpLiBUaGVyZSdzCmluIHBh
cnRpY3VsYXIgbm8gbmVlZCB0byBncm93IHRoZSBudW1iZXIgb2YgcGFnZSB0
YWJsZSBsZXZlbHMgaW4gdXNlLAphbmQgdGhlcmUncyBhbHNvIG5vIG5lZWQg
dG8gYWxsb2NhdGUgaW50ZXJtZWRpYXRlIHBhZ2UgdGFibGVzIGV4Y2VwdAp3
aGVuIG5lZWRpbmcgdG8gc3BsaXQgYSBsYXJnZSBwYWdlLgoKUmVwb3J0ZWQt
Ynk6IFhYWCBQRVJTT04gPFhYWCBFTUFJTD4zClNpZ25lZC1vZmYtYnk6IEFu
ZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+ClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2
aWV3ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bEB4ZW4ub3JnPgpBY2tlZC1i
eTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4K
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFw
LmMKQEAgLTQ1Nyw3ICs0NTcsNyBAQCBzdGF0aWMgaW50IGlvbW11X21lcmdl
X3BhZ2VzKHN0cnVjdCBkb21hCiAgKiBwYWdlIHRhYmxlcy4KICAqLwogc3Rh
dGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgbG9uZyBwZm4sIAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyBwdF9tZm5bXSkKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcHRfbWZuW10sIGJvb2wg
bWFwKQogewogICAgIHU2NCAqcGRlLCAqbmV4dF90YWJsZV92YWRkcjsKICAg
ICB1bnNpZ25lZCBsb25nICBuZXh0X3RhYmxlX21mbjsKQEAgLTQ3MSw2ICs0
NzEsMTMgQEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0
IGRvbQogICAgIEJVR19PTiggdGFibGUgPT0gTlVMTCB8fCBsZXZlbCA8IElP
TU1VX1BBR0lOR19NT0RFX0xFVkVMXzEgfHwgCiAgICAgICAgICAgICBsZXZl
bCA+IElPTU1VX1BBR0lOR19NT0RFX0xFVkVMXzYgKTsKIAorICAgIC8qCisg
ICAgICogQSBmcmFtZSBudW1iZXIgcGFzdCB3aGF0IHRoZSBjdXJyZW50IHBh
Z2UgdGFibGVzIGNhbiByZXByZXNlbnQgY2FuJ3QKKyAgICAgKiBwb3NzaWJs
eSBoYXZlIGEgbWFwcGluZy4KKyAgICAgKi8KKyAgICBpZiAoIHBmbiA+PiAo
UFRFX1BFUl9UQUJMRV9TSElGVCAqIGxldmVsKSApCisgICAgICAgIHJldHVy
biAwOworCiAgICAgbmV4dF90YWJsZV9tZm4gPSBwYWdlX3RvX21mbih0YWJs
ZSk7CiAKICAgICBpZiAoIGxldmVsID09IElPTU1VX1BBR0lOR19NT0RFX0xF
VkVMXzEgKQpAQCAtNTMxLDYgKzUzOCw5IEBAIHN0YXRpYyBpbnQgaW9tbXVf
cGRlX2Zyb21fZ2ZuKHN0cnVjdCBkb20KICAgICAgICAgLyogSW5zdGFsbCBs
b3dlciBsZXZlbCBwYWdlIHRhYmxlIGZvciBub24tcHJlc2VudCBlbnRyaWVz
ICovCiAgICAgICAgIGVsc2UgaWYgKCAhaW9tbXVfaXNfcHRlX3ByZXNlbnQo
KHUzMiopcGRlKSApCiAgICAgICAgIHsKKyAgICAgICAgICAgIGlmICggIW1h
cCApCisgICAgICAgICAgICAgICAgcmV0dXJuIDA7CisKICAgICAgICAgICAg
IGlmICggbmV4dF90YWJsZV9tZm4gPT0gMCApCiAgICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgICAgdGFibGUgPSBhbGxvY19hbWRfaW9tbXVfcGd0YWJs
ZSgpOwpAQCAtNjgxLDcgKzY5MSw3IEBAIGludCBhbWRfaW9tbXVfbWFwX3Bh
Z2Uoc3RydWN0IGRvbWFpbiAqZCwKICAgICAgICAgfQogICAgIH0KIAotICAg
IGlmICggaW9tbXVfcGRlX2Zyb21fZ2ZuKGQsIGdmbiwgcHRfbWZuKSB8fCAo
cHRfbWZuWzFdID09IDApICkKKyAgICBpZiAoIGlvbW11X3BkZV9mcm9tX2dm
bihkLCBnZm4sIHB0X21mbiwgdHJ1ZSkgfHwgKHB0X21mblsxXSA9PSAwKSAp
CiAgICAgewogICAgICAgICBzcGluX3VubG9jaygmaGQtPmFyY2gubWFwcGlu
Z19sb2NrKTsKICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJJbnZhbGlkIElP
IHBhZ2V0YWJsZSBlbnRyeSBnZm4gPSAlbHhcbiIsIGdmbik7CkBAIC03NTYs
MjMgKzc2Niw3IEBAIGludCBhbWRfaW9tbXVfdW5tYXBfcGFnZShzdHJ1Y3Qg
ZG9tYWluICoKIAogICAgIHNwaW5fbG9jaygmaGQtPmFyY2gubWFwcGluZ19s
b2NrKTsKIAotICAgIC8qIFNpbmNlIEhWTSBkb21haW4gaXMgaW5pdGlhbGl6
ZWQgd2l0aCAyIGxldmVsIElPIHBhZ2UgdGFibGUsCi0gICAgICogd2UgbWln
aHQgbmVlZCBhIGRlZXBlciBwYWdlIHRhYmxlIGZvciBsYWdlciBnZm4gbm93
ICovCi0gICAgaWYgKCBpc19odm1fZG9tYWluKGQpICkKLSAgICB7Ci0gICAg
ICAgIGludCByYyA9IHVwZGF0ZV9wYWdpbmdfbW9kZShkLCBnZm4pOwotCi0g
ICAgICAgIGlmICggcmMgKQotICAgICAgICB7Ci0gICAgICAgICAgICBzcGlu
X3VubG9jaygmaGQtPmFyY2gubWFwcGluZ19sb2NrKTsKLSAgICAgICAgICAg
IEFNRF9JT01NVV9ERUJVRygiVXBkYXRlIHBhZ2UgbW9kZSBmYWlsZWQgZ2Zu
ID0gJWx4XG4iLCBnZm4pOwotICAgICAgICAgICAgaWYgKCByYyAhPSAtRUFE
RFJOT1RBVkFJTCApCi0gICAgICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQp
OwotICAgICAgICAgICAgcmV0dXJuIHJjOwotICAgICAgICB9Ci0gICAgfQot
Ci0gICAgaWYgKCBpb21tdV9wZGVfZnJvbV9nZm4oZCwgZ2ZuLCBwdF9tZm4p
IHx8IChwdF9tZm5bMV0gPT0gMCkgKQorICAgIGlmICggaW9tbXVfcGRlX2Zy
b21fZ2ZuKGQsIGdmbiwgcHRfbWZuLCBmYWxzZSkgKQogICAgIHsKICAgICAg
ICAgc3Bpbl91bmxvY2soJmhkLT5hcmNoLm1hcHBpbmdfbG9jayk7CiAgICAg
ICAgIEFNRF9JT01NVV9ERUJVRygiSW52YWxpZCBJTyBwYWdldGFibGUgZW50
cnkgZ2ZuID0gJWx4XG4iLCBnZm4pOwpAQCAtNzgwLDggKzc3NCwxMSBAQCBp
bnQgYW1kX2lvbW11X3VubWFwX3BhZ2Uoc3RydWN0IGRvbWFpbiAqCiAgICAg
ICAgIHJldHVybiAtRUZBVUxUOwogICAgIH0KIAotICAgIC8qIG1hcmsgUFRF
IGFzICdwYWdlIG5vdCBwcmVzZW50JyAqLwotICAgIGNsZWFyX2lvbW11X3B0
ZV9wcmVzZW50KHB0X21mblsxXSwgZ2ZuKTsKKyAgICBpZiAoIHB0X21mblsx
XSApCisgICAgeworICAgICAgICAvKiBNYXJrIFBURSBhcyAncGFnZSBub3Qg
cHJlc2VudCcuICovCisgICAgICAgIGNsZWFyX2lvbW11X3B0ZV9wcmVzZW50
KHB0X21mblsxXSwgZ2ZuKTsKKyAgICB9CiAKICAgICAvKiBObyBmdXJ0aGVy
IG1lcmdpbmcgaW4gYW1kX2lvbW11X21hcF9wYWdlKCksIGFzIHRoZSBsb2dp
YyBkb2Vzbid0IGNvcGUuICovCiAgICAgaGQtPmFyY2gubm9fbWVyZ2UgPSB0
cnVlOwo=

--=separator
Content-Type: application/octet-stream; name="xsa311-4.8-2.patch"
Content-Disposition: attachment; filename="xsa311-4.8-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogQU1EL0lPTU1VOiBDZWFzZSB1c2luZyBhIGR5bmFtaWMg
aGVpZ2h0IGZvciB0aGUgSU9NTVUgcGFnZXRhYmxlcwoKdXBkYXRlX3BhZ2lu
Z19tb2RlKCkgaGFzIG11bHRpcGxlIGJ1Z3M6CgogMSkgQm9vdGluZyB3aXRo
IGlvbW11PWRlYnVnIHdpbGwgY2F1c2UgaXQgdG8gaW5mb3JtIHlvdSB0aGF0
IHRoYXQgaXQgY2FsbGVkCiAgICB3aXRob3V0IHRoZSBwZGV2X2xpc3QgbG9j
ayBoZWxkLgogMikgV2hlbiBncm93aW5nIGJ5IG1vcmUgdGhhbiBhIHNpbmds
ZSBsZXZlbCwgaXQgbGVha3MgdGhlIG5ld2x5IGFsbG9jYXRlZAogICAgdGFi
bGUocykgaW4gdGhlIGNhc2Ugb2YgYSBmdXJ0aGVyIGVycm9yLgoKRnVydGhl
cm1vcmUsIHRoZSBjaG9pY2Ugb2YgZGVmYXVsdCBsZXZlbCBmb3IgYSBkb21h
aW4gaGFzIGlzc3VlczoKCiAxKSBBbGwgSFZNIGd1ZXN0cyBncm93IGZyb20g
MiB0byAzIGxldmVscyBkdXJpbmcgY29uc3RydWN0aW9uIGJlY2F1c2Ugb2Yg
dGhlCiAgICBwb3NpdGlvbiBvZiB0aGUgVlJBTSBqdXN0IGJlbG93IHRoZSA0
RyBib3VuZGFyeSwgc28gZGVmYXVsdGluZyB0byAyIGlzIGEKICAgIHdhc3Rl
IG9mIGVmZm9ydC4KIDIpIFRoZSBsaW1pdCBmb3IgUFYgZ3Vlc3RzIGRvZXNu
J3QgdGFrZSBtZW1vcnkgaG90cGx1ZyBpbnRvIGFjY291bnQsIGFuZAogICAg
aXNuJ3QgZHluYW1pYyBhdCBydW50aW1lIGxpa2UgSFZNIGd1ZXN0cy4gIFRo
aXMgbWVhbnMgdGhhdCBhIFBWIGd1ZXN0IG1heQogICAgZ2V0IFJBTSB3aGlj
aCBpdCBjYW4ndCBtYXAgaW4gdGhlIElPTU1VLgoKVGhlIGR5bmFtaWMgaGVp
Z2h0IGlzIGEgcHJvcGVydHkgdW5pcXVlIHRvIEFNRCwgYW5kIGFkZHMgYSBz
dWJzdGFudGlhbApxdWFudGl0eSBvZiBjb21wbGV4aXR5IGZvciB3aGF0IGlz
IGEgbWFyZ2luYWwgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQuICBSZW1vdmUK
dGhlIGNvbXBsZXhpdHkgYnkgcmVtb3ZpbmcgdGhlIGR5bmFtaWMgaGVpZ2h0
LgoKUFYgZ3Vlc3RzIG5vdyBnZXQgMyBvciA0IGxldmVscyBiYXNlZCBvbiBh
bnkgaG90cGx1ZyByZWdpb25zIGluIHRoZSBob3N0LgpUaGlzIG9ubHkgbWFr
ZXMgYSBkaWZmZXJlbmNlIGZvciBoYXJkd2FyZSB3aGljaCBwcmV2aW91c2x5
IGhhZCBhbGwgUkFNIGJlbG93CnRoZSA1MTJHIGJvdW5kYXJ5LCBhbmQgYSBo
b3RwbHVnIHJlZ2lvbiBhYm92ZS4KCkhWTSBndWVzdHMgbm93IGdldCA0IGxl
dmVscyAod2hpY2ggd2lsbCBiZSBzdWZmaWNpZW50IHVudGlsIDI1NlRCIGd1
ZXN0cwpiZWNvbWUgYSB0aGluZyksIGJlY2F1c2Ugd2UgZG9uJ3QgY3VycmVu
dGx5IGhhdmUgdGhlIGluZm9ybWF0aW9uIHRvIGtub3cgd2hlbgozIHdvdWxk
IGJlIHNhZmUgdG8gdXNlLgoKVGhlIG92ZXJoZWFkIG9mIHRoaXMgZXh0cmEg
bGV2ZWwgaXMgbm90IGV4cGVjdGVkIHRvIGJlIG5vdGljZWFibGUuICBJdCBj
b3N0cwpvbmUgcGFnZSAoNGspIHBlciBkb21haW4sIGFuZCBvbmUgZXh0cmEg
SU8tVExCIHBhZ2luZyBzdHJ1Y3R1cmUgY2FjaGUgZW50cnkKd2hpY2ggaXMg
dmVyeSBob3QgYW5kIGxlc3MgbGlrZWx5IHRvIGJlIGV2aWN0ZWQuCgpUaGlz
IGlzIFhTQS0zMTEuCgpSZXBvcnRlZC1ieTogWFhYIFBFUlNPTiA8WFhYIEVN
QUlMPjMKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4
Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC03NDAzLDYgKzc0
MDMsMTcgQEAgdm9pZCBwYWdpbmdfaW52bHBnKHN0cnVjdCB2Y3B1ICp2LCB1
bnNpZwogICAgICAgICBodm1fZnVuY3MuaW52bHBnKHYsIHZhKTsKIH0KIAor
dW5zaWduZWQgbG9uZyBnZXRfdXBwZXJfbWZuX2JvdW5kKHZvaWQpCit7Cisg
ICAgdW5zaWduZWQgbG9uZyBtYXhfbWZuOworCisgICAgbWF4X21mbiA9IG1l
bV9ob3RwbHVnID8gUEZOX0RPV04obWVtX2hvdHBsdWcpIDogbWF4X3BhZ2U7
CisjaWZuZGVmIENPTkZJR19CSUdNRU0KKyAgICBtYXhfbWZuID0gbWluKG1h
eF9tZm4sIDFVTCA8PCAzMik7CisjZW5kaWYKKyAgICByZXR1cm4gbWluKG1h
eF9tZm4sIDFVTCA8PCAocGFkZHJfYml0cyAtIFBBR0VfU0hJRlQpKSAtIDE7
Cit9CisKIC8qCiAgKiBMb2NhbCB2YXJpYWJsZXM6CiAgKiBtb2RlOiBDCi0t
LSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYwor
KysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMK
QEAgLTU3MCw5NyArNTcwLDYgQEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJv
bV9nZm4oc3RydWN0IGRvbQogICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHVwZGF0ZV9wYWdpbmdfbW9kZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNp
Z25lZCBsb25nIGdmbikKLXsKLSAgICB1MTYgYmRmOwotICAgIHZvaWQgKmRl
dmljZV9lbnRyeTsKLSAgICB1bnNpZ25lZCBpbnQgcmVxX2lkLCBsZXZlbCwg
b2Zmc2V0OwotICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0gICAgc3RydWN0
IHBjaV9kZXYgKnBkZXY7Ci0gICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUg
PSBOVUxMOwotICAgIHN0cnVjdCBwYWdlX2luZm8gKm5ld19yb290ID0gTlVM
TDsKLSAgICBzdHJ1Y3QgcGFnZV9pbmZvICpvbGRfcm9vdCA9IE5VTEw7Ci0g
ICAgdm9pZCAqbmV3X3Jvb3RfdmFkZHI7Ci0gICAgdW5zaWduZWQgbG9uZyBv
bGRfcm9vdF9tZm47Ci0gICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBk
b21faW9tbXUoZCk7Ci0KLSAgICBpZiAoIGdmbiA9PSBnZm5feChJTlZBTElE
X0dGTikgKQotICAgICAgICByZXR1cm4gLUVBRERSTk9UQVZBSUw7Ci0gICAg
QVNTRVJUKCEoZ2ZuID4+IERFRkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEgp
KTsKLQotICAgIGxldmVsID0gaGQtPmFyY2gucGFnaW5nX21vZGU7Ci0gICAg
b2xkX3Jvb3QgPSBoZC0+YXJjaC5yb290X3RhYmxlOwotICAgIG9mZnNldCA9
IGdmbiA+PiAoUFRFX1BFUl9UQUJMRV9TSElGVCAqIChsZXZlbCAtIDEpKTsK
LQotICAgIEFTU0VSVChzcGluX2lzX2xvY2tlZCgmaGQtPmFyY2gubWFwcGlu
Z19sb2NrKSAmJiBpc19odm1fZG9tYWluKGQpKTsKLQotICAgIHdoaWxlICgg
b2Zmc2V0ID49IFBURV9QRVJfVEFCTEVfU0laRSApCi0gICAgewotICAgICAg
ICAvKiBBbGxvY2F0ZSBhbmQgaW5zdGFsbCBhIG5ldyByb290IHRhYmxlLgot
ICAgICAgICAgKiBPbmx5IHVwcGVyIEkvTyBwYWdlIHRhYmxlIGdyb3dzLCBu
byBuZWVkIHRvIGZpeCBuZXh0IGxldmVsIGJpdHMgKi8KLSAgICAgICAgbmV3
X3Jvb3QgPSBhbGxvY19hbWRfaW9tbXVfcGd0YWJsZSgpOwotICAgICAgICBp
ZiAoIG5ld19yb290ID09IE5VTEwgKQotICAgICAgICB7Ci0gICAgICAgICAg
ICBBTURfSU9NTVVfREVCVUcoIiVzIENhbm5vdCBhbGxvY2F0ZSBJL08gcGFn
ZSB0YWJsZVxuIiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Z1
bmNfXyk7Ci0gICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKLSAgICAgICAg
fQotCi0gICAgICAgIG5ld19yb290X3ZhZGRyID0gX19tYXBfZG9tYWluX3Bh
Z2UobmV3X3Jvb3QpOwotICAgICAgICBvbGRfcm9vdF9tZm4gPSBwYWdlX3Rv
X21mbihvbGRfcm9vdCk7Ci0gICAgICAgIHNldF9pb21tdV9wZGVfcHJlc2Vu
dChuZXdfcm9vdF92YWRkciwgb2xkX3Jvb3RfbWZuLCBsZXZlbCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICEhSU9NTVVGX3dyaXRhYmxlLCAh
IUlPTU1VRl9yZWFkYWJsZSk7Ci0gICAgICAgIGxldmVsKys7Ci0gICAgICAg
IG9sZF9yb290ID0gbmV3X3Jvb3Q7Ci0gICAgICAgIG9mZnNldCA+Pj0gUFRF
X1BFUl9UQUJMRV9TSElGVDsKLSAgICAgICAgdW5tYXBfZG9tYWluX3BhZ2Uo
bmV3X3Jvb3RfdmFkZHIpOwotICAgIH0KLQotICAgIGlmICggbmV3X3Jvb3Qg
IT0gTlVMTCApCi0gICAgewotICAgICAgICBoZC0+YXJjaC5wYWdpbmdfbW9k
ZSA9IGxldmVsOwotICAgICAgICBoZC0+YXJjaC5yb290X3RhYmxlID0gbmV3
X3Jvb3Q7Ci0KLSAgICAgICAgaWYgKCAhcGNpZGV2c19sb2NrZWQoKSApCi0g
ICAgICAgICAgICBBTURfSU9NTVVfREVCVUcoIiVzIFRyeSB0byBhY2Nlc3Mg
cGRldl9saXN0ICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2l0
aG91dCBhcXVpcmluZyBwY2lkZXZzX2xvY2suXG4iLCBfX2Z1bmNfXyk7Ci0K
LSAgICAgICAgLyogVXBkYXRlIGRldmljZSB0YWJsZSBlbnRyaWVzIHVzaW5n
IG5ldyByb290IHRhYmxlIGFuZCBwYWdpbmcgbW9kZSAqLwotICAgICAgICBm
b3JfZWFjaF9wZGV2KCBkLCBwZGV2ICkKLSAgICAgICAgewotICAgICAgICAg
ICAgYmRmID0gUENJX0JERjIocGRldi0+YnVzLCBwZGV2LT5kZXZmbik7Ci0g
ICAgICAgICAgICBpb21tdSA9IGZpbmRfaW9tbXVfZm9yX2RldmljZShwZGV2
LT5zZWcsIGJkZik7Ci0gICAgICAgICAgICBpZiAoICFpb21tdSApCi0gICAg
ICAgICAgICB7Ci0gICAgICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCIl
cyBGYWlsIHRvIGZpbmQgaW9tbXUuXG4iLCBfX2Z1bmNfXyk7Ci0gICAgICAg
ICAgICAgICAgcmV0dXJuIC1FTk9ERVY7Ci0gICAgICAgICAgICB9Ci0KLSAg
ICAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxh
Z3MpOwotICAgICAgICAgICAgZG8gewotICAgICAgICAgICAgICAgIHJlcV9p
ZCA9IGdldF9kbWFfcmVxdWVzdG9yX2lkKHBkZXYtPnNlZywgYmRmKTsKLSAg
ICAgICAgICAgICAgICBkZXZpY2VfZW50cnkgPSBpb21tdS0+ZGV2X3RhYmxl
LmJ1ZmZlciArCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJl
cV9pZCAqIElPTU1VX0RFVl9UQUJMRV9FTlRSWV9TSVpFKTsKLQotICAgICAg
ICAgICAgICAgIC8qIHZhbGlkID0gMCBvbmx5IHdvcmtzIGZvciBkb20wIHBh
c3N0aHJvdWdoIG1vZGUgKi8KLSAgICAgICAgICAgICAgICBhbWRfaW9tbXVf
c2V0X3Jvb3RfcGFnZV90YWJsZSgodTMyICopZGV2aWNlX2VudHJ5LAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBh
Z2VfdG9fbWFkZHIoaGQtPmFyY2gucm9vdF90YWJsZSksCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWlu
X2lkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGhkLT5hcmNoLnBhZ2luZ19tb2RlLCAxKTsKLQotICAgICAgICAg
ICAgICAgIGFtZF9pb21tdV9mbHVzaF9kZXZpY2UoaW9tbXUsIHJlcV9pZCk7
Ci0gICAgICAgICAgICAgICAgYmRmICs9IHBkZXYtPnBoYW50b21fc3RyaWRl
OwotICAgICAgICAgICAgfSB3aGlsZSAoIFBDSV9ERVZGTjIoYmRmKSAhPSBw
ZGV2LT5kZXZmbiAmJgotICAgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9U
KGJkZikgPT0gUENJX1NMT1QocGRldi0+ZGV2Zm4pICk7Ci0gICAgICAgICAg
ICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3Mp
OwotICAgICAgICB9Ci0KLSAgICAgICAgLyogRm9yIHNhZmV0eSwgaW52YWxp
ZGF0ZSBhbGwgZW50cmllcyAqLwotICAgICAgICBhbWRfaW9tbXVfZmx1c2hf
YWxsX3BhZ2VzKGQpOwotICAgIH0KLSAgICByZXR1cm4gMDsKLX0KLQogaW50
IGFtZF9pb21tdV9tYXBfcGFnZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25l
ZCBsb25nIGdmbiwgdW5zaWduZWQgbG9uZyBtZm4sCiAgICAgICAgICAgICAg
ICAgICAgICAgIHVuc2lnbmVkIGludCBmbGFncykKIHsKQEAgLTY3OCwxOSAr
NTg3LDYgQEAgaW50IGFtZF9pb21tdV9tYXBfcGFnZShzdHJ1Y3QgZG9tYWlu
ICpkLAogCiAgICAgc3Bpbl9sb2NrKCZoZC0+YXJjaC5tYXBwaW5nX2xvY2sp
OwogCi0gICAgLyogU2luY2UgSFZNIGRvbWFpbiBpcyBpbml0aWFsaXplZCB3
aXRoIDIgbGV2ZWwgSU8gcGFnZSB0YWJsZSwKLSAgICAgKiB3ZSBtaWdodCBu
ZWVkIGEgZGVlcGVyIHBhZ2UgdGFibGUgZm9yIGxhZ2VyIGdmbiBub3cgKi8K
LSAgICBpZiAoIGlzX2h2bV9kb21haW4oZCkgKQotICAgIHsKLSAgICAgICAg
aWYgKCB1cGRhdGVfcGFnaW5nX21vZGUoZCwgZ2ZuKSApCi0gICAgICAgIHsK
LSAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJjaC5tYXBwaW5nX2xv
Y2spOwotICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJVcGRhdGUgcGFn
ZSBtb2RlIGZhaWxlZCBnZm4gPSAlbHhcbiIsIGdmbik7Ci0gICAgICAgICAg
ICBkb21haW5fY3Jhc2goZCk7Ci0gICAgICAgICAgICByZXR1cm4gLUVGQVVM
VDsKLSAgICAgICAgfQotICAgIH0KLQogICAgIGlmICggaW9tbXVfcGRlX2Zy
b21fZ2ZuKGQsIGdmbiwgcHRfbWZuLCB0cnVlKSB8fCAocHRfbWZuWzFdID09
IDApICkKICAgICB7CiAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJjaC5t
YXBwaW5nX2xvY2spOwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9h
bWQvcGNpX2FtZF9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKQEAgLTI3MSwxMSArMjcxLDE3IEBA
IHN0YXRpYyBpbnQgYW1kX2lvbW11X2RvbWFpbl9pbml0KHN0cnVjdAogICAg
ICAgICByZXR1cm4gLUVOT01FTTsKICAgICB9CiAKLSAgICAvKiBGb3IgcHYg
YW5kIGRvbTAsIHN0aWNrIHdpdGggZ2V0X3BhZ2luZ19tb2RlKG1heF9wYWdl
KQotICAgICAqIEZvciBIVk0gZG9tMCwgdXNlIDIgbGV2ZWwgcGFnZSB0YWJs
ZSBhdCBmaXJzdCAqLwotICAgIGhkLT5hcmNoLnBhZ2luZ19tb2RlID0gaXNf
aHZtX2RvbWFpbihkKSA/Ci0gICAgICAgICAgICAgICAgICAgICAgSU9NTVVf
UEFHSU5HX01PREVfTEVWRUxfMiA6Ci0gICAgICAgICAgICAgICAgICAgICAg
Z2V0X3BhZ2luZ19tb2RlKG1heF9wYWdlKTsKKyAgICAvKgorICAgICAqIENo
b29zZSB0aGUgbnVtYmVyIG9mIGxldmVscyBmb3IgdGhlIElPTU1VIHBhZ2Ug
dGFibGVzLgorICAgICAqIC0gUFYgbmVlZHMgMyBvciA0LCBkZXBlbmRpbmcg
b24gd2hldGhlciB0aGVyZSBpcyBSQU0gKGluY2x1ZGluZyBob3RwbHVnCisg
ICAgICogICBSQU0pIGFib3ZlIHRoZSA1MTJHIGJvdW5kYXJ5LgorICAgICAq
IC0gSFZNIGNvdWxkIGluIHByaW5jaXBsZSB1c2UgMyBvciA0IGRlcGVuZGlu
ZyBvbiBob3cgbXVjaCBndWVzdAorICAgICAqICAgcGh5c2ljYWwgYWRkcmVz
cyBzcGFjZSB3ZSBnaXZlIGl0LCBidXQgdGhpcyBpc24ndCBrbm93biB5ZXQg
c28gdXNlIDQKKyAgICAgKiAgIHVuaWxhdGVyYWxseS4KKyAgICAgKi8KKyAg
ICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IGlzX2h2bV9kb21haW4oZCkKKyAg
ICAgICAgPyBJT01NVV9QQUdJTkdfTU9ERV9MRVZFTF80IDogZ2V0X3BhZ2lu
Z19tb2RlKGdldF91cHBlcl9tZm5fYm91bmQoKSk7CisKICAgICByZXR1cm4g
MDsKIH0KIAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vbW0uaAorKysgYi94ZW4v
aW5jbHVkZS94ZW4vbW0uaApAQCAtNTc3LDYgKzU3Nyw5IEBAIGludCBwcmVw
YXJlX3JpbmdfZm9yX2hlbHBlcihzdHJ1Y3QgZG9tYWkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgcGFnZV9pbmZvICoqX3BhZ2UsIHZv
aWQgKipfdmEpOwogdm9pZCBkZXN0cm95X3JpbmdfZm9yX2hlbHBlcih2b2lk
ICoqX3ZhLCBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlKTsKIAorLyogUmV0dXJu
IHRoZSB1cHBlciBib3VuZCBvZiBNRk5zLCBpbmNsdWRpbmcgaG90cGx1ZyBt
ZW1vcnkuICovCit1bnNpZ25lZCBsb25nIGdldF91cHBlcl9tZm5fYm91bmQo
dm9pZCk7CisKICNpbmNsdWRlIDxhc20vZmx1c2h0bGIuaD4KIAogc3RhdGlj
IGlubGluZSB2b2lkIGFjY3VtdWxhdGVfdGxiZmx1c2goYm9vbCAqbmVlZF90
bGJmbHVzaCwK

--=separator
Content-Type: application/octet-stream; name="xsa311-4.9-1.patch"
Content-Disposition: attachment; filename="xsa311-4.9-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRvbid0IG5lZWRsZXNzbHkgdHJpZ2dlciBlcnJvcnMv
Y3Jhc2hlcyB3aGVuIHVubWFwcGluZyBhIHBhZ2UKClVubWFwcGluZyBhIHBh
Z2Ugd2hpY2ggaGFzIG5ldmVyIGJlZW4gbWFwcGVkIHNob3VsZCBiZSBhIG5v
LW9wIChub3RlIGhvdwppdCBhbHJlYWR5IGlzIGluIGNhc2UgdGhlcmUgd2Fz
IG5vIHJvb3QgcGFnZSB0YWJsZSBhbGxvY2F0ZWQpLiBUaGVyZSdzCmluIHBh
cnRpY3VsYXIgbm8gbmVlZCB0byBncm93IHRoZSBudW1iZXIgb2YgcGFnZSB0
YWJsZSBsZXZlbHMgaW4gdXNlLAphbmQgdGhlcmUncyBhbHNvIG5vIG5lZWQg
dG8gYWxsb2NhdGUgaW50ZXJtZWRpYXRlIHBhZ2UgdGFibGVzIGV4Y2VwdAp3
aGVuIG5lZWRpbmcgdG8gc3BsaXQgYSBsYXJnZSBwYWdlLgoKUmVwb3J0ZWQt
Ynk6IFhYWCBQRVJTT04gPFhYWCBFTUFJTD4zClNpZ25lZC1vZmYtYnk6IEFu
ZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+ClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2
aWV3ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bEB4ZW4ub3JnPgpBY2tlZC1i
eTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4K
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFw
LmMKQEAgLTQ1Niw3ICs0NTYsNyBAQCBzdGF0aWMgaW50IGlvbW11X21lcmdl
X3BhZ2VzKHN0cnVjdCBkb21hCiAgKiBwYWdlIHRhYmxlcy4KICAqLwogc3Rh
dGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgbG9uZyBwZm4sIAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyBwdF9tZm5bXSkKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcHRfbWZuW10sIGJvb2wg
bWFwKQogewogICAgIHU2NCAqcGRlLCAqbmV4dF90YWJsZV92YWRkcjsKICAg
ICB1bnNpZ25lZCBsb25nICBuZXh0X3RhYmxlX21mbjsKQEAgLTQ3MCw2ICs0
NzAsMTMgQEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0
IGRvbQogICAgIEJVR19PTiggdGFibGUgPT0gTlVMTCB8fCBsZXZlbCA8IElP
TU1VX1BBR0lOR19NT0RFX0xFVkVMXzEgfHwgCiAgICAgICAgICAgICBsZXZl
bCA+IElPTU1VX1BBR0lOR19NT0RFX0xFVkVMXzYgKTsKIAorICAgIC8qCisg
ICAgICogQSBmcmFtZSBudW1iZXIgcGFzdCB3aGF0IHRoZSBjdXJyZW50IHBh
Z2UgdGFibGVzIGNhbiByZXByZXNlbnQgY2FuJ3QKKyAgICAgKiBwb3NzaWJs
eSBoYXZlIGEgbWFwcGluZy4KKyAgICAgKi8KKyAgICBpZiAoIHBmbiA+PiAo
UFRFX1BFUl9UQUJMRV9TSElGVCAqIGxldmVsKSApCisgICAgICAgIHJldHVy
biAwOworCiAgICAgbmV4dF90YWJsZV9tZm4gPSBwYWdlX3RvX21mbih0YWJs
ZSk7CiAKICAgICBpZiAoIGxldmVsID09IElPTU1VX1BBR0lOR19NT0RFX0xF
VkVMXzEgKQpAQCAtNTMwLDYgKzUzNyw5IEBAIHN0YXRpYyBpbnQgaW9tbXVf
cGRlX2Zyb21fZ2ZuKHN0cnVjdCBkb20KICAgICAgICAgLyogSW5zdGFsbCBs
b3dlciBsZXZlbCBwYWdlIHRhYmxlIGZvciBub24tcHJlc2VudCBlbnRyaWVz
ICovCiAgICAgICAgIGVsc2UgaWYgKCAhaW9tbXVfaXNfcHRlX3ByZXNlbnQo
KHUzMiopcGRlKSApCiAgICAgICAgIHsKKyAgICAgICAgICAgIGlmICggIW1h
cCApCisgICAgICAgICAgICAgICAgcmV0dXJuIDA7CisKICAgICAgICAgICAg
IGlmICggbmV4dF90YWJsZV9tZm4gPT0gMCApCiAgICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgICAgdGFibGUgPSBhbGxvY19hbWRfaW9tbXVfcGd0YWJs
ZSgpOwpAQCAtNjg4LDcgKzY5OCw3IEBAIGludCBhbWRfaW9tbXVfbWFwX3Bh
Z2Uoc3RydWN0IGRvbWFpbiAqZCwKICAgICAgICAgfQogICAgIH0KIAotICAg
IGlmICggaW9tbXVfcGRlX2Zyb21fZ2ZuKGQsIGdmbiwgcHRfbWZuKSB8fCAo
cHRfbWZuWzFdID09IDApICkKKyAgICBpZiAoIGlvbW11X3BkZV9mcm9tX2dm
bihkLCBnZm4sIHB0X21mbiwgdHJ1ZSkgfHwgKHB0X21mblsxXSA9PSAwKSAp
CiAgICAgewogICAgICAgICBzcGluX3VubG9jaygmaGQtPmFyY2gubWFwcGlu
Z19sb2NrKTsKICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJJbnZhbGlkIElP
IHBhZ2V0YWJsZSBlbnRyeSBnZm4gPSAlbHhcbiIsIGdmbik7CkBAIC03Njcs
MjMgKzc3Nyw3IEBAIGludCBhbWRfaW9tbXVfdW5tYXBfcGFnZShzdHJ1Y3Qg
ZG9tYWluICoKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCi0gICAgLyog
U2luY2UgSFZNIGRvbWFpbiBpcyBpbml0aWFsaXplZCB3aXRoIDIgbGV2ZWwg
SU8gcGFnZSB0YWJsZSwKLSAgICAgKiB3ZSBtaWdodCBuZWVkIGEgZGVlcGVy
IHBhZ2UgdGFibGUgZm9yIGxhZ2VyIGdmbiBub3cgKi8KLSAgICBpZiAoIGlz
X2h2bV9kb21haW4oZCkgKQotICAgIHsKLSAgICAgICAgaW50IHJjID0gdXBk
YXRlX3BhZ2luZ19tb2RlKGQsIGdmbik7Ci0KLSAgICAgICAgaWYgKCByYyAp
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJj
aC5tYXBwaW5nX2xvY2spOwotICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVH
KCJVcGRhdGUgcGFnZSBtb2RlIGZhaWxlZCBnZm4gPSAlbHhcbiIsIGdmbik7
Ci0gICAgICAgICAgICBpZiAoIHJjICE9IC1FQUREUk5PVEFWQUlMICkKLSAg
ICAgICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7Ci0gICAgICAgICAgICBy
ZXR1cm4gcmM7Ci0gICAgICAgIH0KLSAgICB9Ci0KLSAgICBpZiAoIGlvbW11
X3BkZV9mcm9tX2dmbihkLCBnZm4sIHB0X21mbikgfHwgKHB0X21mblsxXSA9
PSAwKSApCisgICAgaWYgKCBpb21tdV9wZGVfZnJvbV9nZm4oZCwgZ2ZuLCBw
dF9tZm4sIGZhbHNlKSApCiAgICAgewogICAgICAgICBzcGluX3VubG9jaygm
aGQtPmFyY2gubWFwcGluZ19sb2NrKTsKICAgICAgICAgQU1EX0lPTU1VX0RF
QlVHKCJJbnZhbGlkIElPIHBhZ2V0YWJsZSBlbnRyeSBnZm4gPSAlbHhcbiIs
IGdmbik7CkBAIC03OTEsOCArNzg1LDExIEBAIGludCBhbWRfaW9tbXVfdW5t
YXBfcGFnZShzdHJ1Y3QgZG9tYWluICoKICAgICAgICAgcmV0dXJuIC1FRkFV
TFQ7CiAgICAgfQogCi0gICAgLyogbWFyayBQVEUgYXMgJ3BhZ2Ugbm90IHBy
ZXNlbnQnICovCi0gICAgY2xlYXJfaW9tbXVfcHRlX3ByZXNlbnQocHRfbWZu
WzFdLCBnZm4pOworICAgIGlmICggcHRfbWZuWzFdICkKKyAgICB7CisgICAg
ICAgIC8qIE1hcmsgUFRFIGFzICdwYWdlIG5vdCBwcmVzZW50Jy4gKi8KKyAg
ICAgICAgY2xlYXJfaW9tbXVfcHRlX3ByZXNlbnQocHRfbWZuWzFdLCBnZm4p
OworICAgIH0KIAogICAgIC8qIE5vIGZ1cnRoZXIgbWVyZ2luZyBpbiBhbWRf
aW9tbXVfbWFwX3BhZ2UoKSwgYXMgdGhlIGxvZ2ljIGRvZXNuJ3QgY29wZS4g
Ki8KICAgICBoZC0+YXJjaC5ub19tZXJnZSA9IHRydWU7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa311-4.9-2.patch"
Content-Disposition: attachment; filename="xsa311-4.9-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogQU1EL0lPTU1VOiBDZWFzZSB1c2luZyBhIGR5bmFtaWMg
aGVpZ2h0IGZvciB0aGUgSU9NTVUgcGFnZXRhYmxlcwoKdXBkYXRlX3BhZ2lu
Z19tb2RlKCkgaGFzIG11bHRpcGxlIGJ1Z3M6CgogMSkgQm9vdGluZyB3aXRo
IGlvbW11PWRlYnVnIHdpbGwgY2F1c2UgaXQgdG8gaW5mb3JtIHlvdSB0aGF0
IHRoYXQgaXQgY2FsbGVkCiAgICB3aXRob3V0IHRoZSBwZGV2X2xpc3QgbG9j
ayBoZWxkLgogMikgV2hlbiBncm93aW5nIGJ5IG1vcmUgdGhhbiBhIHNpbmds
ZSBsZXZlbCwgaXQgbGVha3MgdGhlIG5ld2x5IGFsbG9jYXRlZAogICAgdGFi
bGUocykgaW4gdGhlIGNhc2Ugb2YgYSBmdXJ0aGVyIGVycm9yLgoKRnVydGhl
cm1vcmUsIHRoZSBjaG9pY2Ugb2YgZGVmYXVsdCBsZXZlbCBmb3IgYSBkb21h
aW4gaGFzIGlzc3VlczoKCiAxKSBBbGwgSFZNIGd1ZXN0cyBncm93IGZyb20g
MiB0byAzIGxldmVscyBkdXJpbmcgY29uc3RydWN0aW9uIGJlY2F1c2Ugb2Yg
dGhlCiAgICBwb3NpdGlvbiBvZiB0aGUgVlJBTSBqdXN0IGJlbG93IHRoZSA0
RyBib3VuZGFyeSwgc28gZGVmYXVsdGluZyB0byAyIGlzIGEKICAgIHdhc3Rl
IG9mIGVmZm9ydC4KIDIpIFRoZSBsaW1pdCBmb3IgUFYgZ3Vlc3RzIGRvZXNu
J3QgdGFrZSBtZW1vcnkgaG90cGx1ZyBpbnRvIGFjY291bnQsIGFuZAogICAg
aXNuJ3QgZHluYW1pYyBhdCBydW50aW1lIGxpa2UgSFZNIGd1ZXN0cy4gIFRo
aXMgbWVhbnMgdGhhdCBhIFBWIGd1ZXN0IG1heQogICAgZ2V0IFJBTSB3aGlj
aCBpdCBjYW4ndCBtYXAgaW4gdGhlIElPTU1VLgoKVGhlIGR5bmFtaWMgaGVp
Z2h0IGlzIGEgcHJvcGVydHkgdW5pcXVlIHRvIEFNRCwgYW5kIGFkZHMgYSBz
dWJzdGFudGlhbApxdWFudGl0eSBvZiBjb21wbGV4aXR5IGZvciB3aGF0IGlz
IGEgbWFyZ2luYWwgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQuICBSZW1vdmUK
dGhlIGNvbXBsZXhpdHkgYnkgcmVtb3ZpbmcgdGhlIGR5bmFtaWMgaGVpZ2h0
LgoKUFYgZ3Vlc3RzIG5vdyBnZXQgMyBvciA0IGxldmVscyBiYXNlZCBvbiBh
bnkgaG90cGx1ZyByZWdpb25zIGluIHRoZSBob3N0LgpUaGlzIG9ubHkgbWFr
ZXMgYSBkaWZmZXJlbmNlIGZvciBoYXJkd2FyZSB3aGljaCBwcmV2aW91c2x5
IGhhZCBhbGwgUkFNIGJlbG93CnRoZSA1MTJHIGJvdW5kYXJ5LCBhbmQgYSBo
b3RwbHVnIHJlZ2lvbiBhYm92ZS4KCkhWTSBndWVzdHMgbm93IGdldCA0IGxl
dmVscyAod2hpY2ggd2lsbCBiZSBzdWZmaWNpZW50IHVudGlsIDI1NlRCIGd1
ZXN0cwpiZWNvbWUgYSB0aGluZyksIGJlY2F1c2Ugd2UgZG9uJ3QgY3VycmVu
dGx5IGhhdmUgdGhlIGluZm9ybWF0aW9uIHRvIGtub3cgd2hlbgozIHdvdWxk
IGJlIHNhZmUgdG8gdXNlLgoKVGhlIG92ZXJoZWFkIG9mIHRoaXMgZXh0cmEg
bGV2ZWwgaXMgbm90IGV4cGVjdGVkIHRvIGJlIG5vdGljZWFibGUuICBJdCBj
b3N0cwpvbmUgcGFnZSAoNGspIHBlciBkb21haW4sIGFuZCBvbmUgZXh0cmEg
SU8tVExCIHBhZ2luZyBzdHJ1Y3R1cmUgY2FjaGUgZW50cnkKd2hpY2ggaXMg
dmVyeSBob3QgYW5kIGxlc3MgbGlrZWx5IHRvIGJlIGV2aWN0ZWQuCgpUaGlz
IGlzIFhTQS0zMTEuCgpSZXBvcnRlZC1ieTogWFhYIFBFUlNPTiA8WFhYIEVN
QUlMPjMKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4
Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9tbS5jCkBAIC03NTc0LDYgKzc1
NzQsMTcgQEAgdm9pZCB3cml0ZV8zMmJpdF9wc2VfaWRlbnRtYXAodWludDMy
X3QgKgogICAgICAgICAgICAgICAgICBfUEFHRV9BQ0NFU1NFRCB8IF9QQUdF
X0RJUlRZIHwgX1BBR0VfUFNFKTsKIH0KIAordW5zaWduZWQgbG9uZyBnZXRf
dXBwZXJfbWZuX2JvdW5kKHZvaWQpCit7CisgICAgdW5zaWduZWQgbG9uZyBt
YXhfbWZuOworCisgICAgbWF4X21mbiA9IG1lbV9ob3RwbHVnID8gUEZOX0RP
V04obWVtX2hvdHBsdWcpIDogbWF4X3BhZ2U7CisjaWZuZGVmIENPTkZJR19C
SUdNRU0KKyAgICBtYXhfbWZuID0gbWluKG1heF9tZm4sIDFVTCA8PCAzMik7
CisjZW5kaWYKKyAgICByZXR1cm4gbWluKG1heF9tZm4sIDFVTCA8PCAocGFk
ZHJfYml0cyAtIFBBR0VfU0hJRlQpKSAtIDE7Cit9CisKIC8qCiAgKiBMb2Nh
bCB2YXJpYWJsZXM6CiAgKiBtb2RlOiBDCi0tLSBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYworKysgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKQEAgLTU2OSw5NyArNTY5LDYg
QEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0IGRvbQog
ICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHVwZGF0ZV9wYWdpbmdf
bW9kZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbikKLXsK
LSAgICB1MTYgYmRmOwotICAgIHZvaWQgKmRldmljZV9lbnRyeTsKLSAgICB1
bnNpZ25lZCBpbnQgcmVxX2lkLCBsZXZlbCwgb2Zmc2V0OwotICAgIHVuc2ln
bmVkIGxvbmcgZmxhZ3M7Ci0gICAgc3RydWN0IHBjaV9kZXYgKnBkZXY7Ci0g
ICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUgPSBOVUxMOwotICAgIHN0cnVj
dCBwYWdlX2luZm8gKm5ld19yb290ID0gTlVMTDsKLSAgICBzdHJ1Y3QgcGFn
ZV9pbmZvICpvbGRfcm9vdCA9IE5VTEw7Ci0gICAgdm9pZCAqbmV3X3Jvb3Rf
dmFkZHI7Ci0gICAgdW5zaWduZWQgbG9uZyBvbGRfcm9vdF9tZm47Ci0gICAg
c3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0KLSAg
ICBpZiAoIGdmbiA9PSBnZm5feChJTlZBTElEX0dGTikgKQotICAgICAgICBy
ZXR1cm4gLUVBRERSTk9UQVZBSUw7Ci0gICAgQVNTRVJUKCEoZ2ZuID4+IERF
RkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEgpKTsKLQotICAgIGxldmVsID0g
aGQtPmFyY2gucGFnaW5nX21vZGU7Ci0gICAgb2xkX3Jvb3QgPSBoZC0+YXJj
aC5yb290X3RhYmxlOwotICAgIG9mZnNldCA9IGdmbiA+PiAoUFRFX1BFUl9U
QUJMRV9TSElGVCAqIChsZXZlbCAtIDEpKTsKLQotICAgIEFTU0VSVChzcGlu
X2lzX2xvY2tlZCgmaGQtPmFyY2gubWFwcGluZ19sb2NrKSAmJiBpc19odm1f
ZG9tYWluKGQpKTsKLQotICAgIHdoaWxlICggb2Zmc2V0ID49IFBURV9QRVJf
VEFCTEVfU0laRSApCi0gICAgewotICAgICAgICAvKiBBbGxvY2F0ZSBhbmQg
aW5zdGFsbCBhIG5ldyByb290IHRhYmxlLgotICAgICAgICAgKiBPbmx5IHVw
cGVyIEkvTyBwYWdlIHRhYmxlIGdyb3dzLCBubyBuZWVkIHRvIGZpeCBuZXh0
IGxldmVsIGJpdHMgKi8KLSAgICAgICAgbmV3X3Jvb3QgPSBhbGxvY19hbWRf
aW9tbXVfcGd0YWJsZSgpOwotICAgICAgICBpZiAoIG5ld19yb290ID09IE5V
TEwgKQotICAgICAgICB7Ci0gICAgICAgICAgICBBTURfSU9NTVVfREVCVUco
IiVzIENhbm5vdCBhbGxvY2F0ZSBJL08gcGFnZSB0YWJsZVxuIiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBfX2Z1bmNfXyk7Ci0gICAgICAgICAg
ICByZXR1cm4gLUVOT01FTTsKLSAgICAgICAgfQotCi0gICAgICAgIG5ld19y
b290X3ZhZGRyID0gX19tYXBfZG9tYWluX3BhZ2UobmV3X3Jvb3QpOwotICAg
ICAgICBvbGRfcm9vdF9tZm4gPSBwYWdlX3RvX21mbihvbGRfcm9vdCk7Ci0g
ICAgICAgIHNldF9pb21tdV9wZGVfcHJlc2VudChuZXdfcm9vdF92YWRkciwg
b2xkX3Jvb3RfbWZuLCBsZXZlbCwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICEhSU9NTVVGX3dyaXRhYmxlLCAhIUlPTU1VRl9yZWFkYWJsZSk7
Ci0gICAgICAgIGxldmVsKys7Ci0gICAgICAgIG9sZF9yb290ID0gbmV3X3Jv
b3Q7Ci0gICAgICAgIG9mZnNldCA+Pj0gUFRFX1BFUl9UQUJMRV9TSElGVDsK
LSAgICAgICAgdW5tYXBfZG9tYWluX3BhZ2UobmV3X3Jvb3RfdmFkZHIpOwot
ICAgIH0KLQotICAgIGlmICggbmV3X3Jvb3QgIT0gTlVMTCApCi0gICAgewot
ICAgICAgICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IGxldmVsOwotICAgICAg
ICBoZC0+YXJjaC5yb290X3RhYmxlID0gbmV3X3Jvb3Q7Ci0KLSAgICAgICAg
aWYgKCAhcGNpZGV2c19sb2NrZWQoKSApCi0gICAgICAgICAgICBBTURfSU9N
TVVfREVCVUcoIiVzIFRyeSB0byBhY2Nlc3MgcGRldl9saXN0ICIKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAid2l0aG91dCBhcXVpcmluZyBwY2lk
ZXZzX2xvY2suXG4iLCBfX2Z1bmNfXyk7Ci0KLSAgICAgICAgLyogVXBkYXRl
IGRldmljZSB0YWJsZSBlbnRyaWVzIHVzaW5nIG5ldyByb290IHRhYmxlIGFu
ZCBwYWdpbmcgbW9kZSAqLwotICAgICAgICBmb3JfZWFjaF9wZGV2KCBkLCBw
ZGV2ICkKLSAgICAgICAgewotICAgICAgICAgICAgYmRmID0gUENJX0JERjIo
cGRldi0+YnVzLCBwZGV2LT5kZXZmbik7Ci0gICAgICAgICAgICBpb21tdSA9
IGZpbmRfaW9tbXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7Ci0gICAg
ICAgICAgICBpZiAoICFpb21tdSApCi0gICAgICAgICAgICB7Ci0gICAgICAg
ICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCIlcyBGYWlsIHRvIGZpbmQgaW9t
bXUuXG4iLCBfX2Z1bmNfXyk7Ci0gICAgICAgICAgICAgICAgcmV0dXJuIC1F
Tk9ERVY7Ci0gICAgICAgICAgICB9Ci0KLSAgICAgICAgICAgIHNwaW5fbG9j
a19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwotICAgICAgICAgICAg
ZG8gewotICAgICAgICAgICAgICAgIHJlcV9pZCA9IGdldF9kbWFfcmVxdWVz
dG9yX2lkKHBkZXYtPnNlZywgYmRmKTsKLSAgICAgICAgICAgICAgICBkZXZp
Y2VfZW50cnkgPSBpb21tdS0+ZGV2X3RhYmxlLmJ1ZmZlciArCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKHJlcV9pZCAqIElPTU1VX0RFVl9U
QUJMRV9FTlRSWV9TSVpFKTsKLQotICAgICAgICAgICAgICAgIC8qIHZhbGlk
ID0gMCBvbmx5IHdvcmtzIGZvciBkb20wIHBhc3N0aHJvdWdoIG1vZGUgKi8K
LSAgICAgICAgICAgICAgICBhbWRfaW9tbXVfc2V0X3Jvb3RfcGFnZV90YWJs
ZSgodTMyICopZGV2aWNlX2VudHJ5LAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VfdG9fbWFkZHIoaGQtPmFy
Y2gucm9vdF90YWJsZSksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLT5hcmNoLnBh
Z2luZ19tb2RlLCAxKTsKLQotICAgICAgICAgICAgICAgIGFtZF9pb21tdV9m
bHVzaF9kZXZpY2UoaW9tbXUsIHJlcV9pZCk7Ci0gICAgICAgICAgICAgICAg
YmRmICs9IHBkZXYtPnBoYW50b21fc3RyaWRlOwotICAgICAgICAgICAgfSB3
aGlsZSAoIFBDSV9ERVZGTjIoYmRmKSAhPSBwZGV2LT5kZXZmbiAmJgotICAg
ICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGJkZikgPT0gUENJX1NMT1Qo
cGRldi0+ZGV2Zm4pICk7Ci0gICAgICAgICAgICBzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwotICAgICAgICB9Ci0KLSAg
ICAgICAgLyogRm9yIHNhZmV0eSwgaW52YWxpZGF0ZSBhbGwgZW50cmllcyAq
LwotICAgICAgICBhbWRfaW9tbXVfZmx1c2hfYWxsX3BhZ2VzKGQpOwotICAg
IH0KLSAgICByZXR1cm4gMDsKLX0KLQogaW50IGFtZF9pb21tdV9tYXBfcGFn
ZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbiwgdW5zaWdu
ZWQgbG9uZyBtZm4sCiAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVk
IGludCBmbGFncykKIHsKQEAgLTY4NSwxOSArNTk0LDYgQEAgaW50IGFtZF9p
b21tdV9tYXBfcGFnZShzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICByZXR1
cm4gcmM7CiAgICAgfQogCi0gICAgLyogU2luY2UgSFZNIGRvbWFpbiBpcyBp
bml0aWFsaXplZCB3aXRoIDIgbGV2ZWwgSU8gcGFnZSB0YWJsZSwKLSAgICAg
KiB3ZSBtaWdodCBuZWVkIGEgZGVlcGVyIHBhZ2UgdGFibGUgZm9yIGxhZ2Vy
IGdmbiBub3cgKi8KLSAgICBpZiAoIGlzX2h2bV9kb21haW4oZCkgKQotICAg
IHsKLSAgICAgICAgaWYgKCB1cGRhdGVfcGFnaW5nX21vZGUoZCwgZ2ZuKSAp
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJj
aC5tYXBwaW5nX2xvY2spOwotICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVH
KCJVcGRhdGUgcGFnZSBtb2RlIGZhaWxlZCBnZm4gPSAlbHhcbiIsIGdmbik7
Ci0gICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7Ci0gICAgICAgICAgICBy
ZXR1cm4gLUVGQVVMVDsKLSAgICAgICAgfQotICAgIH0KLQogICAgIGlmICgg
aW9tbXVfcGRlX2Zyb21fZ2ZuKGQsIGdmbiwgcHRfbWZuLCB0cnVlKSB8fCAo
cHRfbWZuWzFdID09IDApICkKICAgICB7CiAgICAgICAgIHNwaW5fdW5sb2Nr
KCZoZC0+YXJjaC5tYXBwaW5nX2xvY2spOwotLS0gYS94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKQEAgLTI2OSwx
MSArMjY5LDE3IEBAIHN0YXRpYyBpbnQgYW1kX2lvbW11X2RvbWFpbl9pbml0
KHN0cnVjdAogewogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0gZG9t
X2lvbW11KGQpOwogCi0gICAgLyogRm9yIHB2IGFuZCBkb20wLCBzdGljayB3
aXRoIGdldF9wYWdpbmdfbW9kZShtYXhfcGFnZSkKLSAgICAgKiBGb3IgSFZN
IGRvbTAsIHVzZSAyIGxldmVsIHBhZ2UgdGFibGUgYXQgZmlyc3QgKi8KLSAg
ICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IGlzX2h2bV9kb21haW4oZCkgPwot
ICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1BBR0lOR19NT0RFX0xFVkVM
XzIgOgotICAgICAgICAgICAgICAgICAgICAgIGdldF9wYWdpbmdfbW9kZSht
YXhfcGFnZSk7CisgICAgLyoKKyAgICAgKiBDaG9vc2UgdGhlIG51bWJlciBv
ZiBsZXZlbHMgZm9yIHRoZSBJT01NVSBwYWdlIHRhYmxlcy4KKyAgICAgKiAt
IFBWIG5lZWRzIDMgb3IgNCwgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlcmUg
aXMgUkFNIChpbmNsdWRpbmcgaG90cGx1ZworICAgICAqICAgUkFNKSBhYm92
ZSB0aGUgNTEyRyBib3VuZGFyeS4KKyAgICAgKiAtIEhWTSBjb3VsZCBpbiBw
cmluY2lwbGUgdXNlIDMgb3IgNCBkZXBlbmRpbmcgb24gaG93IG11Y2ggZ3Vl
c3QKKyAgICAgKiAgIHBoeXNpY2FsIGFkZHJlc3Mgc3BhY2Ugd2UgZ2l2ZSBp
dCwgYnV0IHRoaXMgaXNuJ3Qga25vd24geWV0IHNvIHVzZSA0CisgICAgICog
ICB1bmlsYXRlcmFsbHkuCisgICAgICovCisgICAgaGQtPmFyY2gucGFnaW5n
X21vZGUgPSBpc19odm1fZG9tYWluKGQpCisgICAgICAgID8gSU9NTVVfUEFH
SU5HX01PREVfTEVWRUxfNCA6IGdldF9wYWdpbmdfbW9kZShnZXRfdXBwZXJf
bWZuX2JvdW5kKCkpOworCiAgICAgcmV0dXJuIDA7CiB9CiAKLS0tIGEveGVu
L2luY2x1ZGUveGVuL21tLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL21tLmgK
QEAgLTU3Nyw2ICs1NzcsOSBAQCBpbnQgcHJlcGFyZV9yaW5nX2Zvcl9oZWxw
ZXIoc3RydWN0IGRvbWFpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IHBhZ2VfaW5mbyAqKl9wYWdlLCB2b2lkICoqX3ZhKTsKIHZvaWQg
ZGVzdHJveV9yaW5nX2Zvcl9oZWxwZXIodm9pZCAqKl92YSwgc3RydWN0IHBh
Z2VfaW5mbyAqcGFnZSk7CiAKKy8qIFJldHVybiB0aGUgdXBwZXIgYm91bmQg
b2YgTUZOcywgaW5jbHVkaW5nIGhvdHBsdWcgbWVtb3J5LiAqLwordW5zaWdu
ZWQgbG9uZyBnZXRfdXBwZXJfbWZuX2JvdW5kKHZvaWQpOworCiAjaW5jbHVk
ZSA8YXNtL2ZsdXNodGxiLmg+CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBhY2N1
bXVsYXRlX3RsYmZsdXNoKGJvb2wgKm5lZWRfdGxiZmx1c2gsCg==

--=separator
Content-Type: application/octet-stream; name="xsa311-4.10-1.patch"
Content-Disposition: attachment; filename="xsa311-4.10-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRvbid0IG5lZWRsZXNzbHkgdHJpZ2dlciBlcnJvcnMv
Y3Jhc2hlcyB3aGVuIHVubWFwcGluZyBhIHBhZ2UKClVubWFwcGluZyBhIHBh
Z2Ugd2hpY2ggaGFzIG5ldmVyIGJlZW4gbWFwcGVkIHNob3VsZCBiZSBhIG5v
LW9wIChub3RlIGhvdwppdCBhbHJlYWR5IGlzIGluIGNhc2UgdGhlcmUgd2Fz
IG5vIHJvb3QgcGFnZSB0YWJsZSBhbGxvY2F0ZWQpLiBUaGVyZSdzCmluIHBh
cnRpY3VsYXIgbm8gbmVlZCB0byBncm93IHRoZSBudW1iZXIgb2YgcGFnZSB0
YWJsZSBsZXZlbHMgaW4gdXNlLAphbmQgdGhlcmUncyBhbHNvIG5vIG5lZWQg
dG8gYWxsb2NhdGUgaW50ZXJtZWRpYXRlIHBhZ2UgdGFibGVzIGV4Y2VwdAp3
aGVuIG5lZWRpbmcgdG8gc3BsaXQgYSBsYXJnZSBwYWdlLgoKUmVwb3J0ZWQt
Ynk6IFhYWCBQRVJTT04gPFhYWCBFTUFJTD4zClNpZ25lZC1vZmYtYnk6IEFu
ZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+ClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2
aWV3ZWQtYnk6IFBhdWwgRHVycmFudCA8cGF1bEB4ZW4ub3JnPgpBY2tlZC1i
eTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4K
Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFw
LmMKQEAgLTQ1Niw3ICs0NTYsNyBAQCBzdGF0aWMgaW50IGlvbW11X21lcmdl
X3BhZ2VzKHN0cnVjdCBkb21hCiAgKiBwYWdlIHRhYmxlcy4KICAqLwogc3Rh
dGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgbG9uZyBwZm4sIAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgbG9uZyBwdF9tZm5bXSkKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgcHRfbWZuW10sIGJvb2wg
bWFwKQogewogICAgIHU2NCAqcGRlLCAqbmV4dF90YWJsZV92YWRkcjsKICAg
ICB1bnNpZ25lZCBsb25nICBuZXh0X3RhYmxlX21mbjsKQEAgLTQ3MCw2ICs0
NzAsMTMgQEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0
IGRvbQogICAgIEJVR19PTiggdGFibGUgPT0gTlVMTCB8fCBsZXZlbCA8IElP
TU1VX1BBR0lOR19NT0RFX0xFVkVMXzEgfHwgCiAgICAgICAgICAgICBsZXZl
bCA+IElPTU1VX1BBR0lOR19NT0RFX0xFVkVMXzYgKTsKIAorICAgIC8qCisg
ICAgICogQSBmcmFtZSBudW1iZXIgcGFzdCB3aGF0IHRoZSBjdXJyZW50IHBh
Z2UgdGFibGVzIGNhbiByZXByZXNlbnQgY2FuJ3QKKyAgICAgKiBwb3NzaWJs
eSBoYXZlIGEgbWFwcGluZy4KKyAgICAgKi8KKyAgICBpZiAoIHBmbiA+PiAo
UFRFX1BFUl9UQUJMRV9TSElGVCAqIGxldmVsKSApCisgICAgICAgIHJldHVy
biAwOworCiAgICAgbmV4dF90YWJsZV9tZm4gPSBwYWdlX3RvX21mbih0YWJs
ZSk7CiAKICAgICBpZiAoIGxldmVsID09IElPTU1VX1BBR0lOR19NT0RFX0xF
VkVMXzEgKQpAQCAtNTMwLDYgKzUzNyw5IEBAIHN0YXRpYyBpbnQgaW9tbXVf
cGRlX2Zyb21fZ2ZuKHN0cnVjdCBkb20KICAgICAgICAgLyogSW5zdGFsbCBs
b3dlciBsZXZlbCBwYWdlIHRhYmxlIGZvciBub24tcHJlc2VudCBlbnRyaWVz
ICovCiAgICAgICAgIGVsc2UgaWYgKCAhaW9tbXVfaXNfcHRlX3ByZXNlbnQo
KHUzMiopcGRlKSApCiAgICAgICAgIHsKKyAgICAgICAgICAgIGlmICggIW1h
cCApCisgICAgICAgICAgICAgICAgcmV0dXJuIDA7CisKICAgICAgICAgICAg
IGlmICggbmV4dF90YWJsZV9tZm4gPT0gMCApCiAgICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgICAgdGFibGUgPSBhbGxvY19hbWRfaW9tbXVfcGd0YWJs
ZSgpOwpAQCAtNjg4LDcgKzY5OCw3IEBAIGludCBhbWRfaW9tbXVfbWFwX3Bh
Z2Uoc3RydWN0IGRvbWFpbiAqZCwKICAgICAgICAgfQogICAgIH0KIAotICAg
IGlmICggaW9tbXVfcGRlX2Zyb21fZ2ZuKGQsIGdmbiwgcHRfbWZuKSB8fCAo
cHRfbWZuWzFdID09IDApICkKKyAgICBpZiAoIGlvbW11X3BkZV9mcm9tX2dm
bihkLCBnZm4sIHB0X21mbiwgdHJ1ZSkgfHwgKHB0X21mblsxXSA9PSAwKSAp
CiAgICAgewogICAgICAgICBzcGluX3VubG9jaygmaGQtPmFyY2gubWFwcGlu
Z19sb2NrKTsKICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJJbnZhbGlkIElP
IHBhZ2V0YWJsZSBlbnRyeSBnZm4gPSAlbHhcbiIsIGdmbik7CkBAIC03Njcs
MjMgKzc3Nyw3IEBAIGludCBhbWRfaW9tbXVfdW5tYXBfcGFnZShzdHJ1Y3Qg
ZG9tYWluICoKICAgICAgICAgcmV0dXJuIDA7CiAgICAgfQogCi0gICAgLyog
U2luY2UgSFZNIGRvbWFpbiBpcyBpbml0aWFsaXplZCB3aXRoIDIgbGV2ZWwg
SU8gcGFnZSB0YWJsZSwKLSAgICAgKiB3ZSBtaWdodCBuZWVkIGEgZGVlcGVy
IHBhZ2UgdGFibGUgZm9yIGxhZ2VyIGdmbiBub3cgKi8KLSAgICBpZiAoIGlz
X2h2bV9kb21haW4oZCkgKQotICAgIHsKLSAgICAgICAgaW50IHJjID0gdXBk
YXRlX3BhZ2luZ19tb2RlKGQsIGdmbik7Ci0KLSAgICAgICAgaWYgKCByYyAp
Ci0gICAgICAgIHsKLSAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJj
aC5tYXBwaW5nX2xvY2spOwotICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVH
KCJVcGRhdGUgcGFnZSBtb2RlIGZhaWxlZCBnZm4gPSAlbHhcbiIsIGdmbik7
Ci0gICAgICAgICAgICBpZiAoIHJjICE9IC1FQUREUk5PVEFWQUlMICkKLSAg
ICAgICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7Ci0gICAgICAgICAgICBy
ZXR1cm4gcmM7Ci0gICAgICAgIH0KLSAgICB9Ci0KLSAgICBpZiAoIGlvbW11
X3BkZV9mcm9tX2dmbihkLCBnZm4sIHB0X21mbikgfHwgKHB0X21mblsxXSA9
PSAwKSApCisgICAgaWYgKCBpb21tdV9wZGVfZnJvbV9nZm4oZCwgZ2ZuLCBw
dF9tZm4sIGZhbHNlKSApCiAgICAgewogICAgICAgICBzcGluX3VubG9jaygm
aGQtPmFyY2gubWFwcGluZ19sb2NrKTsKICAgICAgICAgQU1EX0lPTU1VX0RF
QlVHKCJJbnZhbGlkIElPIHBhZ2V0YWJsZSBlbnRyeSBnZm4gPSAlbHhcbiIs
IGdmbik7CkBAIC03OTEsOCArNzg1LDExIEBAIGludCBhbWRfaW9tbXVfdW5t
YXBfcGFnZShzdHJ1Y3QgZG9tYWluICoKICAgICAgICAgcmV0dXJuIC1FRkFV
TFQ7CiAgICAgfQogCi0gICAgLyogbWFyayBQVEUgYXMgJ3BhZ2Ugbm90IHBy
ZXNlbnQnICovCi0gICAgY2xlYXJfaW9tbXVfcHRlX3ByZXNlbnQocHRfbWZu
WzFdLCBnZm4pOworICAgIGlmICggcHRfbWZuWzFdICkKKyAgICB7CisgICAg
ICAgIC8qIE1hcmsgUFRFIGFzICdwYWdlIG5vdCBwcmVzZW50Jy4gKi8KKyAg
ICAgICAgY2xlYXJfaW9tbXVfcHRlX3ByZXNlbnQocHRfbWZuWzFdLCBnZm4p
OworICAgIH0KIAogICAgIC8qIE5vIGZ1cnRoZXIgbWVyZ2luZyBpbiBhbWRf
aW9tbXVfbWFwX3BhZ2UoKSwgYXMgdGhlIGxvZ2ljIGRvZXNuJ3QgY29wZS4g
Ki8KICAgICBoZC0+YXJjaC5ub19tZXJnZSA9IHRydWU7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa311-4.10-2.patch"
Content-Disposition: attachment; filename="xsa311-4.10-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogQU1EL0lPTU1VOiBDZWFzZSB1c2luZyBhIGR5bmFtaWMg
aGVpZ2h0IGZvciB0aGUgSU9NTVUgcGFnZXRhYmxlcwoKdXBkYXRlX3BhZ2lu
Z19tb2RlKCkgaGFzIG11bHRpcGxlIGJ1Z3M6CgogMSkgQm9vdGluZyB3aXRo
IGlvbW11PWRlYnVnIHdpbGwgY2F1c2UgaXQgdG8gaW5mb3JtIHlvdSB0aGF0
IHRoYXQgaXQgY2FsbGVkCiAgICB3aXRob3V0IHRoZSBwZGV2X2xpc3QgbG9j
ayBoZWxkLgogMikgV2hlbiBncm93aW5nIGJ5IG1vcmUgdGhhbiBhIHNpbmds
ZSBsZXZlbCwgaXQgbGVha3MgdGhlIG5ld2x5IGFsbG9jYXRlZAogICAgdGFi
bGUocykgaW4gdGhlIGNhc2Ugb2YgYSBmdXJ0aGVyIGVycm9yLgoKRnVydGhl
cm1vcmUsIHRoZSBjaG9pY2Ugb2YgZGVmYXVsdCBsZXZlbCBmb3IgYSBkb21h
aW4gaGFzIGlzc3VlczoKCiAxKSBBbGwgSFZNIGd1ZXN0cyBncm93IGZyb20g
MiB0byAzIGxldmVscyBkdXJpbmcgY29uc3RydWN0aW9uIGJlY2F1c2Ugb2Yg
dGhlCiAgICBwb3NpdGlvbiBvZiB0aGUgVlJBTSBqdXN0IGJlbG93IHRoZSA0
RyBib3VuZGFyeSwgc28gZGVmYXVsdGluZyB0byAyIGlzIGEKICAgIHdhc3Rl
IG9mIGVmZm9ydC4KIDIpIFRoZSBsaW1pdCBmb3IgUFYgZ3Vlc3RzIGRvZXNu
J3QgdGFrZSBtZW1vcnkgaG90cGx1ZyBpbnRvIGFjY291bnQsIGFuZAogICAg
aXNuJ3QgZHluYW1pYyBhdCBydW50aW1lIGxpa2UgSFZNIGd1ZXN0cy4gIFRo
aXMgbWVhbnMgdGhhdCBhIFBWIGd1ZXN0IG1heQogICAgZ2V0IFJBTSB3aGlj
aCBpdCBjYW4ndCBtYXAgaW4gdGhlIElPTU1VLgoKVGhlIGR5bmFtaWMgaGVp
Z2h0IGlzIGEgcHJvcGVydHkgdW5pcXVlIHRvIEFNRCwgYW5kIGFkZHMgYSBz
dWJzdGFudGlhbApxdWFudGl0eSBvZiBjb21wbGV4aXR5IGZvciB3aGF0IGlz
IGEgbWFyZ2luYWwgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQuICBSZW1vdmUK
dGhlIGNvbXBsZXhpdHkgYnkgcmVtb3ZpbmcgdGhlIGR5bmFtaWMgaGVpZ2h0
LgoKUFYgZ3Vlc3RzIG5vdyBnZXQgMyBvciA0IGxldmVscyBiYXNlZCBvbiBh
bnkgaG90cGx1ZyByZWdpb25zIGluIHRoZSBob3N0LgpUaGlzIG9ubHkgbWFr
ZXMgYSBkaWZmZXJlbmNlIGZvciBoYXJkd2FyZSB3aGljaCBwcmV2aW91c2x5
IGhhZCBhbGwgUkFNIGJlbG93CnRoZSA1MTJHIGJvdW5kYXJ5LCBhbmQgYSBo
b3RwbHVnIHJlZ2lvbiBhYm92ZS4KCkhWTSBndWVzdHMgbm93IGdldCA0IGxl
dmVscyAod2hpY2ggd2lsbCBiZSBzdWZmaWNpZW50IHVudGlsIDI1NlRCIGd1
ZXN0cwpiZWNvbWUgYSB0aGluZyksIGJlY2F1c2Ugd2UgZG9uJ3QgY3VycmVu
dGx5IGhhdmUgdGhlIGluZm9ybWF0aW9uIHRvIGtub3cgd2hlbgozIHdvdWxk
IGJlIHNhZmUgdG8gdXNlLgoKVGhlIG92ZXJoZWFkIG9mIHRoaXMgZXh0cmEg
bGV2ZWwgaXMgbm90IGV4cGVjdGVkIHRvIGJlIG5vdGljZWFibGUuICBJdCBj
b3N0cwpvbmUgcGFnZSAoNGspIHBlciBkb21haW4sIGFuZCBvbmUgZXh0cmEg
SU8tVExCIHBhZ2luZyBzdHJ1Y3R1cmUgY2FjaGUgZW50cnkKd2hpY2ggaXMg
dmVyeSBob3QgYW5kIGxlc3MgbGlrZWx5IHRvIGJlIGV2aWN0ZWQuCgpUaGlz
IGlzIFhTQS0zMTEuCgpSZXBvcnRlZC1ieTogWFhYIFBFUlNPTiA8WFhYIEVN
QUlMPjMKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCi0tLSBhL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYworKysgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKQEAgLTU2OSw5NyArNTY5
LDYgQEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0IGRv
bQogICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHVwZGF0ZV9wYWdp
bmdfbW9kZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbikK
LXsKLSAgICB1MTYgYmRmOwotICAgIHZvaWQgKmRldmljZV9lbnRyeTsKLSAg
ICB1bnNpZ25lZCBpbnQgcmVxX2lkLCBsZXZlbCwgb2Zmc2V0OwotICAgIHVu
c2lnbmVkIGxvbmcgZmxhZ3M7Ci0gICAgc3RydWN0IHBjaV9kZXYgKnBkZXY7
Ci0gICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUgPSBOVUxMOwotICAgIHN0
cnVjdCBwYWdlX2luZm8gKm5ld19yb290ID0gTlVMTDsKLSAgICBzdHJ1Y3Qg
cGFnZV9pbmZvICpvbGRfcm9vdCA9IE5VTEw7Ci0gICAgdm9pZCAqbmV3X3Jv
b3RfdmFkZHI7Ci0gICAgdW5zaWduZWQgbG9uZyBvbGRfcm9vdF9tZm47Ci0g
ICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0K
LSAgICBpZiAoIGdmbiA9PSBnZm5feChJTlZBTElEX0dGTikgKQotICAgICAg
ICByZXR1cm4gLUVBRERSTk9UQVZBSUw7Ci0gICAgQVNTRVJUKCEoZ2ZuID4+
IERFRkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEgpKTsKLQotICAgIGxldmVs
ID0gaGQtPmFyY2gucGFnaW5nX21vZGU7Ci0gICAgb2xkX3Jvb3QgPSBoZC0+
YXJjaC5yb290X3RhYmxlOwotICAgIG9mZnNldCA9IGdmbiA+PiAoUFRFX1BF
Ul9UQUJMRV9TSElGVCAqIChsZXZlbCAtIDEpKTsKLQotICAgIEFTU0VSVChz
cGluX2lzX2xvY2tlZCgmaGQtPmFyY2gubWFwcGluZ19sb2NrKSAmJiBpc19o
dm1fZG9tYWluKGQpKTsKLQotICAgIHdoaWxlICggb2Zmc2V0ID49IFBURV9Q
RVJfVEFCTEVfU0laRSApCi0gICAgewotICAgICAgICAvKiBBbGxvY2F0ZSBh
bmQgaW5zdGFsbCBhIG5ldyByb290IHRhYmxlLgotICAgICAgICAgKiBPbmx5
IHVwcGVyIEkvTyBwYWdlIHRhYmxlIGdyb3dzLCBubyBuZWVkIHRvIGZpeCBu
ZXh0IGxldmVsIGJpdHMgKi8KLSAgICAgICAgbmV3X3Jvb3QgPSBhbGxvY19h
bWRfaW9tbXVfcGd0YWJsZSgpOwotICAgICAgICBpZiAoIG5ld19yb290ID09
IE5VTEwgKQotICAgICAgICB7Ci0gICAgICAgICAgICBBTURfSU9NTVVfREVC
VUcoIiVzIENhbm5vdCBhbGxvY2F0ZSBJL08gcGFnZSB0YWJsZVxuIiwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Z1bmNfXyk7Ci0gICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsKLSAgICAgICAgfQotCi0gICAgICAgIG5l
d19yb290X3ZhZGRyID0gX19tYXBfZG9tYWluX3BhZ2UobmV3X3Jvb3QpOwot
ICAgICAgICBvbGRfcm9vdF9tZm4gPSBwYWdlX3RvX21mbihvbGRfcm9vdCk7
Ci0gICAgICAgIHNldF9pb21tdV9wZGVfcHJlc2VudChuZXdfcm9vdF92YWRk
ciwgb2xkX3Jvb3RfbWZuLCBsZXZlbCwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICEhSU9NTVVGX3dyaXRhYmxlLCAhIUlPTU1VRl9yZWFkYWJs
ZSk7Ci0gICAgICAgIGxldmVsKys7Ci0gICAgICAgIG9sZF9yb290ID0gbmV3
X3Jvb3Q7Ci0gICAgICAgIG9mZnNldCA+Pj0gUFRFX1BFUl9UQUJMRV9TSElG
VDsKLSAgICAgICAgdW5tYXBfZG9tYWluX3BhZ2UobmV3X3Jvb3RfdmFkZHIp
OwotICAgIH0KLQotICAgIGlmICggbmV3X3Jvb3QgIT0gTlVMTCApCi0gICAg
ewotICAgICAgICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IGxldmVsOwotICAg
ICAgICBoZC0+YXJjaC5yb290X3RhYmxlID0gbmV3X3Jvb3Q7Ci0KLSAgICAg
ICAgaWYgKCAhcGNpZGV2c19sb2NrZWQoKSApCi0gICAgICAgICAgICBBTURf
SU9NTVVfREVCVUcoIiVzIFRyeSB0byBhY2Nlc3MgcGRldl9saXN0ICIKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAid2l0aG91dCBhcXVpcmluZyBw
Y2lkZXZzX2xvY2suXG4iLCBfX2Z1bmNfXyk7Ci0KLSAgICAgICAgLyogVXBk
YXRlIGRldmljZSB0YWJsZSBlbnRyaWVzIHVzaW5nIG5ldyByb290IHRhYmxl
IGFuZCBwYWdpbmcgbW9kZSAqLwotICAgICAgICBmb3JfZWFjaF9wZGV2KCBk
LCBwZGV2ICkKLSAgICAgICAgewotICAgICAgICAgICAgYmRmID0gUENJX0JE
RjIocGRldi0+YnVzLCBwZGV2LT5kZXZmbik7Ci0gICAgICAgICAgICBpb21t
dSA9IGZpbmRfaW9tbXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7Ci0g
ICAgICAgICAgICBpZiAoICFpb21tdSApCi0gICAgICAgICAgICB7Ci0gICAg
ICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCIlcyBGYWlsIHRvIGZpbmQg
aW9tbXUuXG4iLCBfX2Z1bmNfXyk7Ci0gICAgICAgICAgICAgICAgcmV0dXJu
IC1FTk9ERVY7Ci0gICAgICAgICAgICB9Ci0KLSAgICAgICAgICAgIHNwaW5f
bG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwotICAgICAgICAg
ICAgZG8gewotICAgICAgICAgICAgICAgIHJlcV9pZCA9IGdldF9kbWFfcmVx
dWVzdG9yX2lkKHBkZXYtPnNlZywgYmRmKTsKLSAgICAgICAgICAgICAgICBk
ZXZpY2VfZW50cnkgPSBpb21tdS0+ZGV2X3RhYmxlLmJ1ZmZlciArCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlcV9pZCAqIElPTU1VX0RF
Vl9UQUJMRV9FTlRSWV9TSVpFKTsKLQotICAgICAgICAgICAgICAgIC8qIHZh
bGlkID0gMCBvbmx5IHdvcmtzIGZvciBkb20wIHBhc3N0aHJvdWdoIG1vZGUg
Ki8KLSAgICAgICAgICAgICAgICBhbWRfaW9tbXVfc2V0X3Jvb3RfcGFnZV90
YWJsZSgodTMyICopZGV2aWNlX2VudHJ5LAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VfdG9fbWFkZHIoaGQt
PmFyY2gucm9vdF90YWJsZSksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZC0+ZG9tYWluX2lkLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLT5hcmNo
LnBhZ2luZ19tb2RlLCAxKTsKLQotICAgICAgICAgICAgICAgIGFtZF9pb21t
dV9mbHVzaF9kZXZpY2UoaW9tbXUsIHJlcV9pZCk7Ci0gICAgICAgICAgICAg
ICAgYmRmICs9IHBkZXYtPnBoYW50b21fc3RyaWRlOwotICAgICAgICAgICAg
fSB3aGlsZSAoIFBDSV9ERVZGTjIoYmRmKSAhPSBwZGV2LT5kZXZmbiAmJgot
ICAgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGJkZikgPT0gUENJX1NM
T1QocGRldi0+ZGV2Zm4pICk7Ci0gICAgICAgICAgICBzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwotICAgICAgICB9Ci0K
LSAgICAgICAgLyogRm9yIHNhZmV0eSwgaW52YWxpZGF0ZSBhbGwgZW50cmll
cyAqLwotICAgICAgICBhbWRfaW9tbXVfZmx1c2hfYWxsX3BhZ2VzKGQpOwot
ICAgIH0KLSAgICByZXR1cm4gMDsKLX0KLQogaW50IGFtZF9pb21tdV9tYXBf
cGFnZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbiwgdW5z
aWduZWQgbG9uZyBtZm4sCiAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBmbGFncykKIHsKQEAgLTY4NSwxOSArNTk0LDYgQEAgaW50IGFt
ZF9pb21tdV9tYXBfcGFnZShzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICBy
ZXR1cm4gcmM7CiAgICAgfQogCi0gICAgLyogU2luY2UgSFZNIGRvbWFpbiBp
cyBpbml0aWFsaXplZCB3aXRoIDIgbGV2ZWwgSU8gcGFnZSB0YWJsZSwKLSAg
ICAgKiB3ZSBtaWdodCBuZWVkIGEgZGVlcGVyIHBhZ2UgdGFibGUgZm9yIGxh
Z2VyIGdmbiBub3cgKi8KLSAgICBpZiAoIGlzX2h2bV9kb21haW4oZCkgKQot
ICAgIHsKLSAgICAgICAgaWYgKCB1cGRhdGVfcGFnaW5nX21vZGUoZCwgZ2Zu
KSApCi0gICAgICAgIHsKLSAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+
YXJjaC5tYXBwaW5nX2xvY2spOwotICAgICAgICAgICAgQU1EX0lPTU1VX0RF
QlVHKCJVcGRhdGUgcGFnZSBtb2RlIGZhaWxlZCBnZm4gPSAlbHhcbiIsIGdm
bik7Ci0gICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7Ci0gICAgICAgICAg
ICByZXR1cm4gLUVGQVVMVDsKLSAgICAgICAgfQotICAgIH0KLQogICAgIGlm
ICggaW9tbXVfcGRlX2Zyb21fZ2ZuKGQsIGdmbiwgcHRfbWZuLCB0cnVlKSB8
fCAocHRfbWZuWzFdID09IDApICkKICAgICB7CiAgICAgICAgIHNwaW5fdW5s
b2NrKCZoZC0+YXJjaC5tYXBwaW5nX2xvY2spOwotLS0gYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKQEAgLTI0
MiwxMSArMjQyLDE3IEBAIHN0YXRpYyBpbnQgYW1kX2lvbW11X2RvbWFpbl9p
bml0KHN0cnVjdAogewogICAgIHN0cnVjdCBkb21haW5faW9tbXUgKmhkID0g
ZG9tX2lvbW11KGQpOwogCi0gICAgLyogRm9yIHB2IGFuZCBkb20wLCBzdGlj
ayB3aXRoIGdldF9wYWdpbmdfbW9kZShtYXhfcGFnZSkKLSAgICAgKiBGb3Ig
SFZNIGRvbTAsIHVzZSAyIGxldmVsIHBhZ2UgdGFibGUgYXQgZmlyc3QgKi8K
LSAgICBoZC0+YXJjaC5wYWdpbmdfbW9kZSA9IGlzX2h2bV9kb21haW4oZCkg
PwotICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1BBR0lOR19NT0RFX0xF
VkVMXzIgOgotICAgICAgICAgICAgICAgICAgICAgIGdldF9wYWdpbmdfbW9k
ZShtYXhfcGFnZSk7CisgICAgLyoKKyAgICAgKiBDaG9vc2UgdGhlIG51bWJl
ciBvZiBsZXZlbHMgZm9yIHRoZSBJT01NVSBwYWdlIHRhYmxlcy4KKyAgICAg
KiAtIFBWIG5lZWRzIDMgb3IgNCwgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhl
cmUgaXMgUkFNIChpbmNsdWRpbmcgaG90cGx1ZworICAgICAqICAgUkFNKSBh
Ym92ZSB0aGUgNTEyRyBib3VuZGFyeS4KKyAgICAgKiAtIEhWTSBjb3VsZCBp
biBwcmluY2lwbGUgdXNlIDMgb3IgNCBkZXBlbmRpbmcgb24gaG93IG11Y2gg
Z3Vlc3QKKyAgICAgKiAgIHBoeXNpY2FsIGFkZHJlc3Mgc3BhY2Ugd2UgZ2l2
ZSBpdCwgYnV0IHRoaXMgaXNuJ3Qga25vd24geWV0IHNvIHVzZSA0CisgICAg
ICogICB1bmlsYXRlcmFsbHkuCisgICAgICovCisgICAgaGQtPmFyY2gucGFn
aW5nX21vZGUgPSBpc19odm1fZG9tYWluKGQpCisgICAgICAgID8gSU9NTVVf
UEFHSU5HX01PREVfTEVWRUxfNCA6IGdldF9wYWdpbmdfbW9kZShnZXRfdXBw
ZXJfbWZuX2JvdW5kKCkpOworCiAgICAgcmV0dXJuIDA7CiB9CiAK

--=separator
Content-Type: application/octet-stream; name="xsa311-4.11.patch"
Content-Disposition: attachment; filename="xsa311-4.11.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogQU1EL0lPTU1VOiBDZWFzZSB1c2luZyBhIGR5bmFtaWMg
aGVpZ2h0IGZvciB0aGUgSU9NTVUgcGFnZXRhYmxlcwoKdXBkYXRlX3BhZ2lu
Z19tb2RlKCkgaGFzIG11bHRpcGxlIGJ1Z3M6CgogMSkgQm9vdGluZyB3aXRo
IGlvbW11PWRlYnVnIHdpbGwgY2F1c2UgaXQgdG8gaW5mb3JtIHlvdSB0aGF0
IHRoYXQgaXQgY2FsbGVkCiAgICB3aXRob3V0IHRoZSBwZGV2X2xpc3QgbG9j
ayBoZWxkLgogMikgV2hlbiBncm93aW5nIGJ5IG1vcmUgdGhhbiBhIHNpbmds
ZSBsZXZlbCwgaXQgbGVha3MgdGhlIG5ld2x5IGFsbG9jYXRlZAogICAgdGFi
bGUocykgaW4gdGhlIGNhc2Ugb2YgYSBmdXJ0aGVyIGVycm9yLgoKRnVydGhl
cm1vcmUsIHRoZSBjaG9pY2Ugb2YgZGVmYXVsdCBsZXZlbCBmb3IgYSBkb21h
aW4gaGFzIGlzc3VlczoKCiAxKSBBbGwgSFZNIGd1ZXN0cyBncm93IGZyb20g
MiB0byAzIGxldmVscyBkdXJpbmcgY29uc3RydWN0aW9uIGJlY2F1c2Ugb2Yg
dGhlCiAgICBwb3NpdGlvbiBvZiB0aGUgVlJBTSBqdXN0IGJlbG93IHRoZSA0
RyBib3VuZGFyeSwgc28gZGVmYXVsdGluZyB0byAyIGlzIGEKICAgIHdhc3Rl
IG9mIGVmZm9ydC4KIDIpIFRoZSBsaW1pdCBmb3IgUFYgZ3Vlc3RzIGRvZXNu
J3QgdGFrZSBtZW1vcnkgaG90cGx1ZyBpbnRvIGFjY291bnQsIGFuZAogICAg
aXNuJ3QgZHluYW1pYyBhdCBydW50aW1lIGxpa2UgSFZNIGd1ZXN0cy4gIFRo
aXMgbWVhbnMgdGhhdCBhIFBWIGd1ZXN0IG1heQogICAgZ2V0IFJBTSB3aGlj
aCBpdCBjYW4ndCBtYXAgaW4gdGhlIElPTU1VLgoKVGhlIGR5bmFtaWMgaGVp
Z2h0IGlzIGEgcHJvcGVydHkgdW5pcXVlIHRvIEFNRCwgYW5kIGFkZHMgYSBz
dWJzdGFudGlhbApxdWFudGl0eSBvZiBjb21wbGV4aXR5IGZvciB3aGF0IGlz
IGEgbWFyZ2luYWwgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQuICBSZW1vdmUK
dGhlIGNvbXBsZXhpdHkgYnkgcmVtb3ZpbmcgdGhlIGR5bmFtaWMgaGVpZ2h0
LgoKUFYgZ3Vlc3RzIG5vdyBnZXQgMyBvciA0IGxldmVscyBiYXNlZCBvbiBh
bnkgaG90cGx1ZyByZWdpb25zIGluIHRoZSBob3N0LgpUaGlzIG9ubHkgbWFr
ZXMgYSBkaWZmZXJlbmNlIGZvciBoYXJkd2FyZSB3aGljaCBwcmV2aW91c2x5
IGhhZCBhbGwgUkFNIGJlbG93CnRoZSA1MTJHIGJvdW5kYXJ5LCBhbmQgYSBo
b3RwbHVnIHJlZ2lvbiBhYm92ZS4KCkhWTSBndWVzdHMgbm93IGdldCA0IGxl
dmVscyAod2hpY2ggd2lsbCBiZSBzdWZmaWNpZW50IHVudGlsIDI1NlRCIGd1
ZXN0cwpiZWNvbWUgYSB0aGluZyksIGJlY2F1c2Ugd2UgZG9uJ3QgY3VycmVu
dGx5IGhhdmUgdGhlIGluZm9ybWF0aW9uIHRvIGtub3cgd2hlbgozIHdvdWxk
IGJlIHNhZmUgdG8gdXNlLgoKVGhlIG92ZXJoZWFkIG9mIHRoaXMgZXh0cmEg
bGV2ZWwgaXMgbm90IGV4cGVjdGVkIHRvIGJlIG5vdGljZWFibGUuICBJdCBj
b3N0cwpvbmUgcGFnZSAoNGspIHBlciBkb21haW4sIGFuZCBvbmUgZXh0cmEg
SU8tVExCIHBhZ2luZyBzdHJ1Y3R1cmUgY2FjaGUgZW50cnkKd2hpY2ggaXMg
dmVyeSBob3QgYW5kIGxlc3MgbGlrZWx5IHRvIGJlIGV2aWN0ZWQuCgpUaGlz
IGlzIFhTQS0zMTEuCgpSZXBvcnRlZC1ieTogWFhYIFBFUlNPTiA8WFhYIEVN
QUlMPjMKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCi0tLSBhL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYworKysgYi94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKQEAgLTU2OSw5NyArNTY5
LDYgQEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9nZm4oc3RydWN0IGRv
bQogICAgIHJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHVwZGF0ZV9wYWdp
bmdfbW9kZShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbikK
LXsKLSAgICB1MTYgYmRmOwotICAgIHZvaWQgKmRldmljZV9lbnRyeTsKLSAg
ICB1bnNpZ25lZCBpbnQgcmVxX2lkLCBsZXZlbCwgb2Zmc2V0OwotICAgIHVu
c2lnbmVkIGxvbmcgZmxhZ3M7Ci0gICAgc3RydWN0IHBjaV9kZXYgKnBkZXY7
Ci0gICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUgPSBOVUxMOwotICAgIHN0
cnVjdCBwYWdlX2luZm8gKm5ld19yb290ID0gTlVMTDsKLSAgICBzdHJ1Y3Qg
cGFnZV9pbmZvICpvbGRfcm9vdCA9IE5VTEw7Ci0gICAgdm9pZCAqbmV3X3Jv
b3RfdmFkZHI7Ci0gICAgdW5zaWduZWQgbG9uZyBvbGRfcm9vdF9tZm47Ci0g
ICAgc3RydWN0IGRvbWFpbl9pb21tdSAqaGQgPSBkb21faW9tbXUoZCk7Ci0K
LSAgICBpZiAoIGdmbiA9PSBnZm5feChJTlZBTElEX0dGTikgKQotICAgICAg
ICByZXR1cm4gLUVBRERSTk9UQVZBSUw7Ci0gICAgQVNTRVJUKCEoZ2ZuID4+
IERFRkFVTFRfRE9NQUlOX0FERFJFU1NfV0lEVEgpKTsKLQotICAgIGxldmVs
ID0gaGQtPmFyY2gucGFnaW5nX21vZGU7Ci0gICAgb2xkX3Jvb3QgPSBoZC0+
YXJjaC5yb290X3RhYmxlOwotICAgIG9mZnNldCA9IGdmbiA+PiAoUFRFX1BF
Ul9UQUJMRV9TSElGVCAqIChsZXZlbCAtIDEpKTsKLQotICAgIEFTU0VSVChz
cGluX2lzX2xvY2tlZCgmaGQtPmFyY2gubWFwcGluZ19sb2NrKSAmJiBpc19o
dm1fZG9tYWluKGQpKTsKLQotICAgIHdoaWxlICggb2Zmc2V0ID49IFBURV9Q
RVJfVEFCTEVfU0laRSApCi0gICAgewotICAgICAgICAvKiBBbGxvY2F0ZSBh
bmQgaW5zdGFsbCBhIG5ldyByb290IHRhYmxlLgotICAgICAgICAgKiBPbmx5
IHVwcGVyIEkvTyBwYWdlIHRhYmxlIGdyb3dzLCBubyBuZWVkIHRvIGZpeCBu
ZXh0IGxldmVsIGJpdHMgKi8KLSAgICAgICAgbmV3X3Jvb3QgPSBhbGxvY19h
bWRfaW9tbXVfcGd0YWJsZSgpOwotICAgICAgICBpZiAoIG5ld19yb290ID09
IE5VTEwgKQotICAgICAgICB7Ci0gICAgICAgICAgICBBTURfSU9NTVVfREVC
VUcoIiVzIENhbm5vdCBhbGxvY2F0ZSBJL08gcGFnZSB0YWJsZVxuIiwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBfX2Z1bmNfXyk7Ci0gICAgICAg
ICAgICByZXR1cm4gLUVOT01FTTsKLSAgICAgICAgfQotCi0gICAgICAgIG5l
d19yb290X3ZhZGRyID0gX19tYXBfZG9tYWluX3BhZ2UobmV3X3Jvb3QpOwot
ICAgICAgICBvbGRfcm9vdF9tZm4gPSBtZm5feChwYWdlX3RvX21mbihvbGRf
cm9vdCkpOwotICAgICAgICBzZXRfaW9tbXVfcGRlX3ByZXNlbnQobmV3X3Jv
b3RfdmFkZHIsIG9sZF9yb290X21mbiwgbGV2ZWwsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAhIUlPTU1VRl93cml0YWJsZSwgISFJT01NVUZf
cmVhZGFibGUpOwotICAgICAgICBsZXZlbCsrOwotICAgICAgICBvbGRfcm9v
dCA9IG5ld19yb290OwotICAgICAgICBvZmZzZXQgPj49IFBURV9QRVJfVEFC
TEVfU0hJRlQ7Ci0gICAgICAgIHVubWFwX2RvbWFpbl9wYWdlKG5ld19yb290
X3ZhZGRyKTsKLSAgICB9Ci0KLSAgICBpZiAoIG5ld19yb290ICE9IE5VTEwg
KQotICAgIHsKLSAgICAgICAgaGQtPmFyY2gucGFnaW5nX21vZGUgPSBsZXZl
bDsKLSAgICAgICAgaGQtPmFyY2gucm9vdF90YWJsZSA9IG5ld19yb290Owot
Ci0gICAgICAgIGlmICggIXBjaWRldnNfbG9ja2VkKCkgKQotICAgICAgICAg
ICAgQU1EX0lPTU1VX0RFQlVHKCIlcyBUcnkgdG8gYWNjZXNzIHBkZXZfbGlz
dCAiCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpdGhvdXQgYXF1
aXJpbmcgcGNpZGV2c19sb2NrLlxuIiwgX19mdW5jX18pOwotCi0gICAgICAg
IC8qIFVwZGF0ZSBkZXZpY2UgdGFibGUgZW50cmllcyB1c2luZyBuZXcgcm9v
dCB0YWJsZSBhbmQgcGFnaW5nIG1vZGUgKi8KLSAgICAgICAgZm9yX2VhY2hf
cGRldiggZCwgcGRldiApCi0gICAgICAgIHsKLSAgICAgICAgICAgIGJkZiA9
IFBDSV9CREYyKHBkZXYtPmJ1cywgcGRldi0+ZGV2Zm4pOwotICAgICAgICAg
ICAgaW9tbXUgPSBmaW5kX2lvbW11X2Zvcl9kZXZpY2UocGRldi0+c2VnLCBi
ZGYpOwotICAgICAgICAgICAgaWYgKCAhaW9tbXUgKQotICAgICAgICAgICAg
ewotICAgICAgICAgICAgICAgIEFNRF9JT01NVV9ERUJVRygiJXMgRmFpbCB0
byBmaW5kIGlvbW11LlxuIiwgX19mdW5jX18pOwotICAgICAgICAgICAgICAg
IHJldHVybiAtRU5PREVWOwotICAgICAgICAgICAgfQotCi0gICAgICAgICAg
ICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKLSAg
ICAgICAgICAgIGRvIHsKLSAgICAgICAgICAgICAgICByZXFfaWQgPSBnZXRf
ZG1hX3JlcXVlc3Rvcl9pZChwZGV2LT5zZWcsIGJkZik7Ci0gICAgICAgICAg
ICAgICAgZGV2aWNlX2VudHJ5ID0gaW9tbXUtPmRldl90YWJsZS5idWZmZXIg
KwotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXFfaWQgKiBJ
T01NVV9ERVZfVEFCTEVfRU5UUllfU0laRSk7Ci0KLSAgICAgICAgICAgICAg
ICAvKiB2YWxpZCA9IDAgb25seSB3b3JrcyBmb3IgZG9tMCBwYXNzdGhyb3Vn
aCBtb2RlICovCi0gICAgICAgICAgICAgICAgYW1kX2lvbW11X3NldF9yb290
X3BhZ2VfdGFibGUoKHUzMiAqKWRldmljZV9lbnRyeSwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlX3RvX21h
ZGRyKGhkLT5hcmNoLnJvb3RfdGFibGUpLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQtPmRvbWFpbl9pZCwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBo
ZC0+YXJjaC5wYWdpbmdfbW9kZSwgMSk7Ci0KLSAgICAgICAgICAgICAgICBh
bWRfaW9tbXVfZmx1c2hfZGV2aWNlKGlvbW11LCByZXFfaWQpOwotICAgICAg
ICAgICAgICAgIGJkZiArPSBwZGV2LT5waGFudG9tX3N0cmlkZTsKLSAgICAg
ICAgICAgIH0gd2hpbGUgKCBQQ0lfREVWRk4yKGJkZikgIT0gcGRldi0+ZGV2
Zm4gJiYKLSAgICAgICAgICAgICAgICAgICAgICBQQ0lfU0xPVChiZGYpID09
IFBDSV9TTE9UKHBkZXYtPmRldmZuKSApOwotICAgICAgICAgICAgc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKLSAgICAg
ICAgfQotCi0gICAgICAgIC8qIEZvciBzYWZldHksIGludmFsaWRhdGUgYWxs
IGVudHJpZXMgKi8KLSAgICAgICAgYW1kX2lvbW11X2ZsdXNoX2FsbF9wYWdl
cyhkKTsKLSAgICB9Ci0gICAgcmV0dXJuIDA7Ci19Ci0KIGludCBhbWRfaW9t
bXVfbWFwX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgbG9uZyBn
Zm4sIHVuc2lnbmVkIGxvbmcgbWZuLAogICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgZmxhZ3MpCiB7CkBAIC02ODUsMTkgKzU5NCw2IEBA
IGludCBhbWRfaW9tbXVfbWFwX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwKICAg
ICAgICAgcmV0dXJuIHJjOwogICAgIH0KIAotICAgIC8qIFNpbmNlIEhWTSBk
b21haW4gaXMgaW5pdGlhbGl6ZWQgd2l0aCAyIGxldmVsIElPIHBhZ2UgdGFi
bGUsCi0gICAgICogd2UgbWlnaHQgbmVlZCBhIGRlZXBlciBwYWdlIHRhYmxl
IGZvciBsYWdlciBnZm4gbm93ICovCi0gICAgaWYgKCBpc19odm1fZG9tYWlu
KGQpICkKLSAgICB7Ci0gICAgICAgIGlmICggdXBkYXRlX3BhZ2luZ19tb2Rl
KGQsIGdmbikgKQotICAgICAgICB7Ci0gICAgICAgICAgICBzcGluX3VubG9j
aygmaGQtPmFyY2gubWFwcGluZ19sb2NrKTsKLSAgICAgICAgICAgIEFNRF9J
T01NVV9ERUJVRygiVXBkYXRlIHBhZ2UgbW9kZSBmYWlsZWQgZ2ZuID0gJWx4
XG4iLCBnZm4pOwotICAgICAgICAgICAgZG9tYWluX2NyYXNoKGQpOwotICAg
ICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7Ci0gICAgICAgIH0KLSAgICB9Ci0K
ICAgICBpZiAoIGlvbW11X3BkZV9mcm9tX2dmbihkLCBnZm4sIHB0X21mbiwg
dHJ1ZSkgfHwgKHB0X21mblsxXSA9PSAwKSApCiAgICAgewogICAgICAgICBz
cGluX3VubG9jaygmaGQtPmFyY2gubWFwcGluZ19sb2NrKTsKLS0tIGEveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5j
CkBAIC0yNDIsMTEgKzI0MiwxNyBAQCBzdGF0aWMgaW50IGFtZF9pb21tdV9k
b21haW5faW5pdChzdHJ1Y3QKIHsKICAgICBzdHJ1Y3QgZG9tYWluX2lvbW11
ICpoZCA9IGRvbV9pb21tdShkKTsKIAotICAgIC8qIEZvciBwdiBhbmQgZG9t
MCwgc3RpY2sgd2l0aCBnZXRfcGFnaW5nX21vZGUobWF4X3BhZ2UpCi0gICAg
ICogRm9yIEhWTSBkb20wLCB1c2UgMiBsZXZlbCBwYWdlIHRhYmxlIGF0IGZp
cnN0ICovCi0gICAgaGQtPmFyY2gucGFnaW5nX21vZGUgPSBpc19odm1fZG9t
YWluKGQpID8KLSAgICAgICAgICAgICAgICAgICAgICBJT01NVV9QQUdJTkdf
TU9ERV9MRVZFTF8yIDoKLSAgICAgICAgICAgICAgICAgICAgICBnZXRfcGFn
aW5nX21vZGUobWF4X3BhZ2UpOworICAgIC8qCisgICAgICogQ2hvb3NlIHRo
ZSBudW1iZXIgb2YgbGV2ZWxzIGZvciB0aGUgSU9NTVUgcGFnZSB0YWJsZXMu
CisgICAgICogLSBQViBuZWVkcyAzIG9yIDQsIGRlcGVuZGluZyBvbiB3aGV0
aGVyIHRoZXJlIGlzIFJBTSAoaW5jbHVkaW5nIGhvdHBsdWcKKyAgICAgKiAg
IFJBTSkgYWJvdmUgdGhlIDUxMkcgYm91bmRhcnkuCisgICAgICogLSBIVk0g
Y291bGQgaW4gcHJpbmNpcGxlIHVzZSAzIG9yIDQgZGVwZW5kaW5nIG9uIGhv
dyBtdWNoIGd1ZXN0CisgICAgICogICBwaHlzaWNhbCBhZGRyZXNzIHNwYWNl
IHdlIGdpdmUgaXQsIGJ1dCB0aGlzIGlzbid0IGtub3duIHlldCBzbyB1c2Ug
NAorICAgICAqICAgdW5pbGF0ZXJhbGx5LgorICAgICAqLworICAgIGhkLT5h
cmNoLnBhZ2luZ19tb2RlID0gaXNfaHZtX2RvbWFpbihkKQorICAgICAgICA/
IElPTU1VX1BBR0lOR19NT0RFX0xFVkVMXzQgOiBnZXRfcGFnaW5nX21vZGUo
Z2V0X3VwcGVyX21mbl9ib3VuZCgpKTsKKwogICAgIHJldHVybiAwOwogfQog
Cg==

--=separator
Content-Type: application/octet-stream; name="xsa311-4.12.patch"
Content-Disposition: attachment; filename="xsa311-4.12.patch"
Content-Transfer-Encoding: base64

RnJvbTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4KU3ViamVjdDogQU1EL0lPTU1VOiBDZWFzZSB1c2luZyBhIGR5bmFtaWMg
aGVpZ2h0IGZvciB0aGUgSU9NTVUgcGFnZXRhYmxlcwoKdXBkYXRlX3BhZ2lu
Z19tb2RlKCkgaGFzIG11bHRpcGxlIGJ1Z3M6CgogMSkgQm9vdGluZyB3aXRo
IGlvbW11PWRlYnVnIHdpbGwgY2F1c2UgaXQgdG8gaW5mb3JtIHlvdSB0aGF0
IHRoYXQgaXQgY2FsbGVkCiAgICB3aXRob3V0IHRoZSBwZGV2X2xpc3QgbG9j
ayBoZWxkLgogMikgV2hlbiBncm93aW5nIGJ5IG1vcmUgdGhhbiBhIHNpbmds
ZSBsZXZlbCwgaXQgbGVha3MgdGhlIG5ld2x5IGFsbG9jYXRlZAogICAgdGFi
bGUocykgaW4gdGhlIGNhc2Ugb2YgYSBmdXJ0aGVyIGVycm9yLgoKRnVydGhl
cm1vcmUsIHRoZSBjaG9pY2Ugb2YgZGVmYXVsdCBsZXZlbCBmb3IgYSBkb21h
aW4gaGFzIGlzc3VlczoKCiAxKSBBbGwgSFZNIGd1ZXN0cyBncm93IGZyb20g
MiB0byAzIGxldmVscyBkdXJpbmcgY29uc3RydWN0aW9uIGJlY2F1c2Ugb2Yg
dGhlCiAgICBwb3NpdGlvbiBvZiB0aGUgVlJBTSBqdXN0IGJlbG93IHRoZSA0
RyBib3VuZGFyeSwgc28gZGVmYXVsdGluZyB0byAyIGlzIGEKICAgIHdhc3Rl
IG9mIGVmZm9ydC4KIDIpIFRoZSBsaW1pdCBmb3IgUFYgZ3Vlc3RzIGRvZXNu
J3QgdGFrZSBtZW1vcnkgaG90cGx1ZyBpbnRvIGFjY291bnQsIGFuZAogICAg
aXNuJ3QgZHluYW1pYyBhdCBydW50aW1lIGxpa2UgSFZNIGd1ZXN0cy4gIFRo
aXMgbWVhbnMgdGhhdCBhIFBWIGd1ZXN0IG1heQogICAgZ2V0IFJBTSB3aGlj
aCBpdCBjYW4ndCBtYXAgaW4gdGhlIElPTU1VLgoKVGhlIGR5bmFtaWMgaGVp
Z2h0IGlzIGEgcHJvcGVydHkgdW5pcXVlIHRvIEFNRCwgYW5kIGFkZHMgYSBz
dWJzdGFudGlhbApxdWFudGl0eSBvZiBjb21wbGV4aXR5IGZvciB3aGF0IGlz
IGEgbWFyZ2luYWwgcGVyZm9ybWFuY2UgaW1wcm92ZW1lbnQuICBSZW1vdmUK
dGhlIGNvbXBsZXhpdHkgYnkgcmVtb3ZpbmcgdGhlIGR5bmFtaWMgaGVpZ2h0
LgoKUFYgZ3Vlc3RzIG5vdyBnZXQgMyBvciA0IGxldmVscyBiYXNlZCBvbiBh
bnkgaG90cGx1ZyByZWdpb25zIGluIHRoZSBob3N0LgpUaGlzIG9ubHkgbWFr
ZXMgYSBkaWZmZXJlbmNlIGZvciBoYXJkd2FyZSB3aGljaCBwcmV2aW91c2x5
IGhhZCBhbGwgUkFNIGJlbG93CnRoZSA1MTJHIGJvdW5kYXJ5LCBhbmQgYSBo
b3RwbHVnIHJlZ2lvbiBhYm92ZS4KCkhWTSBndWVzdHMgbm93IGdldCA0IGxl
dmVscyAod2hpY2ggd2lsbCBiZSBzdWZmaWNpZW50IHVudGlsIDI1NlRCIGd1
ZXN0cwpiZWNvbWUgYSB0aGluZyksIGJlY2F1c2Ugd2UgZG9uJ3QgY3VycmVu
dGx5IGhhdmUgdGhlIGluZm9ybWF0aW9uIHRvIGtub3cgd2hlbgozIHdvdWxk
IGJlIHNhZmUgdG8gdXNlLgoKVGhlIG92ZXJoZWFkIG9mIHRoaXMgZXh0cmEg
bGV2ZWwgaXMgbm90IGV4cGVjdGVkIHRvIGJlIG5vdGljZWFibGUuICBJdCBj
b3N0cwpvbmUgcGFnZSAoNGspIHBlciBkb21haW4sIGFuZCBvbmUgZXh0cmEg
SU8tVExCIHBhZ2luZyBzdHJ1Y3R1cmUgY2FjaGUgZW50cnkKd2hpY2ggaXMg
dmVyeSBob3QgYW5kIGxlc3MgbGlrZWx5IHRvIGJlIGV2aWN0ZWQuCgpUaGlz
IGlzIFhTQS0zMTEuCgpSZXBvcnRlZC1ieTogWFhYIFBFUlNPTiA8WFhYIEVN
QUlMPjMKU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KU2lnbmVkLW9mZi1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEphbiBC
ZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCmRpZmYgLS1naXQgYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMgYi94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKaW5kZXggNjI4YWE2
MDIzMC4uOWEyMjJjOTVlMSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYwpAQCAtNDU1LDEwMCArNDU1LDYg
QEAgc3RhdGljIGludCBpb21tdV9wZGVfZnJvbV9kZm4oc3RydWN0IGRvbWFp
biAqZCwgdW5zaWduZWQgbG9uZyBkZm4sCiAgICAgcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdXBkYXRlX3BhZ2luZ19tb2RlKHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbmVkIGxvbmcgZGZuKQotewotICAgIHVpbnQxNl90IGJkZjsK
LSAgICB2b2lkICpkZXZpY2VfZW50cnk7Ci0gICAgdW5zaWduZWQgaW50IHJl
cV9pZCwgbGV2ZWwsIG9mZnNldDsKLSAgICB1bnNpZ25lZCBsb25nIGZsYWdz
OwotICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2OwotICAgIHN0cnVjdCBhbWRf
aW9tbXUgKmlvbW11ID0gTlVMTDsKLSAgICBzdHJ1Y3QgcGFnZV9pbmZvICpu
ZXdfcm9vdCA9IE5VTEw7Ci0gICAgc3RydWN0IHBhZ2VfaW5mbyAqb2xkX3Jv
b3QgPSBOVUxMOwotICAgIHZvaWQgKm5ld19yb290X3ZhZGRyOwotICAgIHVu
c2lnbmVkIGxvbmcgb2xkX3Jvb3RfbWZuOwotICAgIHN0cnVjdCBkb21haW5f
aW9tbXUgKmhkID0gZG9tX2lvbW11KGQpOwotCi0gICAgaWYgKCBkZm4gPT0g
ZGZuX3goSU5WQUxJRF9ERk4pICkKLSAgICAgICAgcmV0dXJuIC1FQUREUk5P
VEFWQUlMOwotICAgIEFTU0VSVCghKGRmbiA+PiBERUZBVUxUX0RPTUFJTl9B
RERSRVNTX1dJRFRIKSk7Ci0KLSAgICBsZXZlbCA9IGhkLT5hcmNoLnBhZ2lu
Z19tb2RlOwotICAgIG9sZF9yb290ID0gaGQtPmFyY2gucm9vdF90YWJsZTsK
LSAgICBvZmZzZXQgPSBkZm4gPj4gKFBURV9QRVJfVEFCTEVfU0hJRlQgKiAo
bGV2ZWwgLSAxKSk7Ci0KLSAgICBBU1NFUlQoc3Bpbl9pc19sb2NrZWQoJmhk
LT5hcmNoLm1hcHBpbmdfbG9jaykgJiYgaXNfaHZtX2RvbWFpbihkKSk7Ci0K
LSAgICB3aGlsZSAoIG9mZnNldCA+PSBQVEVfUEVSX1RBQkxFX1NJWkUgKQot
ICAgIHsKLSAgICAgICAgLyogQWxsb2NhdGUgYW5kIGluc3RhbGwgYSBuZXcg
cm9vdCB0YWJsZS4KLSAgICAgICAgICogT25seSB1cHBlciBJL08gcGFnZSB0
YWJsZSBncm93cywgbm8gbmVlZCB0byBmaXggbmV4dCBsZXZlbCBiaXRzICov
Ci0gICAgICAgIG5ld19yb290ID0gYWxsb2NfYW1kX2lvbW11X3BndGFibGUo
KTsKLSAgICAgICAgaWYgKCBuZXdfcm9vdCA9PSBOVUxMICkKLSAgICAgICAg
ewotICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCIlcyBDYW5ub3QgYWxs
b2NhdGUgSS9PIHBhZ2UgdGFibGVcbiIsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgX19mdW5jX18pOwotICAgICAgICAgICAgcmV0dXJuIC1FTk9N
RU07Ci0gICAgICAgIH0KLQotICAgICAgICBuZXdfcm9vdF92YWRkciA9IF9f
bWFwX2RvbWFpbl9wYWdlKG5ld19yb290KTsKLSAgICAgICAgb2xkX3Jvb3Rf
bWZuID0gbWZuX3gocGFnZV90b19tZm4ob2xkX3Jvb3QpKTsKLSAgICAgICAg
c2V0X2lvbW11X3BkZV9wcmVzZW50KG5ld19yb290X3ZhZGRyLCBvbGRfcm9v
dF9tZm4sIGxldmVsLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ISFJT01NVUZfd3JpdGFibGUsICEhSU9NTVVGX3JlYWRhYmxlKTsKLSAgICAg
ICAgbGV2ZWwrKzsKLSAgICAgICAgb2xkX3Jvb3QgPSBuZXdfcm9vdDsKLSAg
ICAgICAgb2Zmc2V0ID4+PSBQVEVfUEVSX1RBQkxFX1NISUZUOwotICAgICAg
ICB1bm1hcF9kb21haW5fcGFnZShuZXdfcm9vdF92YWRkcik7Ci0gICAgfQot
Ci0gICAgaWYgKCBuZXdfcm9vdCAhPSBOVUxMICkKLSAgICB7Ci0gICAgICAg
IGhkLT5hcmNoLnBhZ2luZ19tb2RlID0gbGV2ZWw7Ci0gICAgICAgIGhkLT5h
cmNoLnJvb3RfdGFibGUgPSBuZXdfcm9vdDsKLQotICAgICAgICBpZiAoICFw
Y2lkZXZzX2xvY2tlZCgpICkKLSAgICAgICAgICAgIEFNRF9JT01NVV9ERUJV
RygiJXMgVHJ5IHRvIGFjY2VzcyBwZGV2X2xpc3QgIgotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICJ3aXRob3V0IGFxdWlyaW5nIHBjaWRldnNfbG9j
ay5cbiIsIF9fZnVuY19fKTsKLQotICAgICAgICAvKiBVcGRhdGUgZGV2aWNl
IHRhYmxlIGVudHJpZXMgdXNpbmcgbmV3IHJvb3QgdGFibGUgYW5kIHBhZ2lu
ZyBtb2RlICovCi0gICAgICAgIGZvcl9lYWNoX3BkZXYoIGQsIHBkZXYgKQot
ICAgICAgICB7Ci0gICAgICAgICAgICBpZiAoIHBkZXYtPnR5cGUgPT0gREVW
X1RZUEVfUENJX0hPU1RfQlJJREdFICkKLSAgICAgICAgICAgICAgICBjb250
aW51ZTsKLQotICAgICAgICAgICAgYmRmID0gUENJX0JERjIocGRldi0+YnVz
LCBwZGV2LT5kZXZmbik7Ci0gICAgICAgICAgICBpb21tdSA9IGZpbmRfaW9t
bXVfZm9yX2RldmljZShwZGV2LT5zZWcsIGJkZik7Ci0gICAgICAgICAgICBp
ZiAoICFpb21tdSApCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAg
QU1EX0lPTU1VX0RFQlVHKCIlcyBGYWlsIHRvIGZpbmQgaW9tbXUuXG4iLCBf
X2Z1bmNfXyk7Ci0gICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9ERVY7Ci0g
ICAgICAgICAgICB9Ci0KLSAgICAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZl
KCZpb21tdS0+bG9jaywgZmxhZ3MpOwotICAgICAgICAgICAgZG8gewotICAg
ICAgICAgICAgICAgIHJlcV9pZCA9IGdldF9kbWFfcmVxdWVzdG9yX2lkKHBk
ZXYtPnNlZywgYmRmKTsKLSAgICAgICAgICAgICAgICBkZXZpY2VfZW50cnkg
PSBpb21tdS0+ZGV2X3RhYmxlLmJ1ZmZlciArCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKHJlcV9pZCAqIElPTU1VX0RFVl9UQUJMRV9FTlRS
WV9TSVpFKTsKLQotICAgICAgICAgICAgICAgIC8qIHZhbGlkID0gMCBvbmx5
IHdvcmtzIGZvciBkb20wIHBhc3N0aHJvdWdoIG1vZGUgKi8KLSAgICAgICAg
ICAgICAgICBhbWRfaW9tbXVfc2V0X3Jvb3RfcGFnZV90YWJsZSgodWludDMy
X3QgKilkZXZpY2VfZW50cnksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcGFnZV90b19tYWRkcihoZC0+YXJjaC5y
b290X3RhYmxlKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBkLT5kb21haW5faWQsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQtPmFyY2gucGFnaW5n
X21vZGUsIDEpOwotCi0gICAgICAgICAgICAgICAgYW1kX2lvbW11X2ZsdXNo
X2RldmljZShpb21tdSwgcmVxX2lkKTsKLSAgICAgICAgICAgICAgICBiZGYg
Kz0gcGRldi0+cGhhbnRvbV9zdHJpZGU7Ci0gICAgICAgICAgICB9IHdoaWxl
ICggUENJX0RFVkZOMihiZGYpICE9IHBkZXYtPmRldmZuICYmCi0gICAgICAg
ICAgICAgICAgICAgICAgUENJX1NMT1QoYmRmKSA9PSBQQ0lfU0xPVChwZGV2
LT5kZXZmbikgKTsKLSAgICAgICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3Rv
cmUoJmlvbW11LT5sb2NrLCBmbGFncyk7Ci0gICAgICAgIH0KLQotICAgICAg
ICAvKiBGb3Igc2FmZXR5LCBpbnZhbGlkYXRlIGFsbCBlbnRyaWVzICovCi0g
ICAgICAgIGFtZF9pb21tdV9mbHVzaF9hbGxfcGFnZXMoZCk7Ci0gICAgfQot
ICAgIHJldHVybiAwOwotfQotCiBpbnQgYW1kX2lvbW11X21hcF9wYWdlKHN0
cnVjdCBkb21haW4gKmQsIGRmbl90IGRmbiwgbWZuX3QgbWZuLAogICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3MsIHVuc2lnbmVk
IGludCAqZmx1c2hfZmxhZ3MpCiB7CkBAIC01NzMsMjAgKzQ3OSw2IEBAIGlu
dCBhbWRfaW9tbXVfbWFwX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwgZGZuX3Qg
ZGZuLCBtZm5fdCBtZm4sCiAgICAgICAgIHJldHVybiByYzsKICAgICB9CiAK
LSAgICAvKiBTaW5jZSBIVk0gZG9tYWluIGlzIGluaXRpYWxpemVkIHdpdGgg
MiBsZXZlbCBJTyBwYWdlIHRhYmxlLAotICAgICAqIHdlIG1pZ2h0IG5lZWQg
YSBkZWVwZXIgcGFnZSB0YWJsZSBmb3Igd2lkZXIgZGZuIG5vdyAqLwotICAg
IGlmICggaXNfaHZtX2RvbWFpbihkKSApCi0gICAgewotICAgICAgICBpZiAo
IHVwZGF0ZV9wYWdpbmdfbW9kZShkLCBkZm5feChkZm4pKSApCi0gICAgICAg
IHsKLSAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJjaC5tYXBwaW5n
X2xvY2spOwotICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJVcGRhdGUg
cGFnZSBtb2RlIGZhaWxlZCBkZm4gPSAlIlBSSV9kZm4iXG4iLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGRmbl94KGRmbikpOwotICAgICAgICAg
ICAgZG9tYWluX2NyYXNoKGQpOwotICAgICAgICAgICAgcmV0dXJuIC1FRkFV
TFQ7Ci0gICAgICAgIH0KLSAgICB9Ci0KICAgICBpZiAoIGlvbW11X3BkZV9m
cm9tX2RmbihkLCBkZm5feChkZm4pLCBwdF9tZm4sIHRydWUpIHx8IChwdF9t
Zm5bMV0gPT0gMCkgKQogICAgIHsKICAgICAgICAgc3Bpbl91bmxvY2soJmhk
LT5hcmNoLm1hcHBpbmdfbG9jayk7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVy
cy9wYXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jIGIveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYwppbmRleCAxNWMx
M2UxMTYzLi41N2RjMmM1ZjIwIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9hbWQvcGNpX2FtZF9pb21tdS5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1kX2lvbW11LmMKQEAgLTI0Miwx
MCArMjQyLDE3IEBAIHN0YXRpYyBpbnQgYW1kX2lvbW11X2RvbWFpbl9pbml0
KHN0cnVjdCBkb21haW4gKmQpCiB7CiAgICAgc3RydWN0IGRvbWFpbl9pb21t
dSAqaGQgPSBkb21faW9tbXUoZCk7CiAKLSAgICAvKiBGb3IgcHYgYW5kIGRv
bTAsIHN0aWNrIHdpdGggZ2V0X3BhZ2luZ19tb2RlKG1heF9wYWdlKQotICAg
ICAqIEZvciBIVk0gZG9tMCwgdXNlIDIgbGV2ZWwgcGFnZSB0YWJsZSBhdCBm
aXJzdCAqLwotICAgIGhkLT5hcmNoLnBhZ2luZ19tb2RlID0gaXNfaHZtX2Rv
bWFpbihkKSA/Ci0gICAgICAgIDIgOiBhbWRfaW9tbXVfZ2V0X3BhZ2luZ19t
b2RlKG1heF9wYWdlKTsKKyAgICAvKgorICAgICAqIENob29zZSB0aGUgbnVt
YmVyIG9mIGxldmVscyBmb3IgdGhlIElPTU1VIHBhZ2UgdGFibGVzLgorICAg
ICAqIC0gUFYgbmVlZHMgMyBvciA0LCBkZXBlbmRpbmcgb24gd2hldGhlciB0
aGVyZSBpcyBSQU0gKGluY2x1ZGluZyBob3RwbHVnCisgICAgICogICBSQU0p
IGFib3ZlIHRoZSA1MTJHIGJvdW5kYXJ5LgorICAgICAqIC0gSFZNIGNvdWxk
IGluIHByaW5jaXBsZSB1c2UgMyBvciA0IGRlcGVuZGluZyBvbiBob3cgbXVj
aCBndWVzdAorICAgICAqICAgcGh5c2ljYWwgYWRkcmVzcyBzcGFjZSB3ZSBn
aXZlIGl0LCBidXQgdGhpcyBpc24ndCBrbm93biB5ZXQgc28gdXNlIDQKKyAg
ICAgKiAgIHVuaWxhdGVyYWxseS4KKyAgICAgKi8KKyAgICBoZC0+YXJjaC5w
YWdpbmdfbW9kZSA9IGlzX2h2bV9kb21haW4oZCkKKyAgICAgICAgPyA0IDog
YW1kX2lvbW11X2dldF9wYWdpbmdfbW9kZShnZXRfdXBwZXJfbWZuX2JvdW5k
KCkpOworCiAgICAgcmV0dXJuIDA7CiB9CiAK

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


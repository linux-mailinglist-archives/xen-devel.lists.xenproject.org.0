Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9581EC2ED5
	for <lists+xen-devel@lfdr.de>; Tue,  1 Oct 2019 10:29:32 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iFDTY-0007Fh-QJ; Tue, 01 Oct 2019 08:25:40 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=hN/W=X2=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iFDTX-0007FR-Bc
 for xen-devel@lists.xenproject.org; Tue, 01 Oct 2019 08:25:39 +0000
X-Inumbo-ID: 0bb576ba-e425-11e9-96f4-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 0bb576ba-e425-11e9-96f4-12813bfff9fa;
 Tue, 01 Oct 2019 08:25:37 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id D0FC3AF9F;
 Tue,  1 Oct 2019 08:25:36 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org, x86@kernel.org,
 linux-arm-kernel@lists.infradead.org, linux-kernel@vger.kernel.org
Date: Tue,  1 Oct 2019 10:25:34 +0200
Message-Id: <20191001082534.12067-1-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
Subject: [Xen-devel] [PATCH] xen/efi: have a common runtime setup function
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Catalin Marinas <catalin.marinas@arm.com>,
 Russell King <linux@armlinux.org.uk>, Ingo Molnar <mingo@redhat.com>,
 Borislav Petkov <bp@alien8.de>, "H. Peter Anvin" <hpa@zytor.com>,
 Boris Ostrovsky <boris.ostrovsky@oracle.com>, Will Deacon <will@kernel.org>,
 Thomas Gleixner <tglx@linutronix.de>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VG9kYXkgdGhlIEVGSSBydW50aW1lIGZ1bmN0aW9ucyBhcmUgc2V0dXAgaW4gYXJjaGl0ZWN0dXJl
IHNwZWNpZmljCmNvZGUgKHg4NiBhbmQgYXJtKSwgd2l0aCB0aGUgZnVuY3Rpb25zIHRoZW1zZWx2
ZXMgbGl2aW5nIGluIGRyaXZlcnMveGVuCmFzIHRoZXkgYXJlIG5vdCBhcmNoaXRlY3R1cmUgZGVw
ZW5kZW50LgoKQXMgdGhlIHNldHVwIGlzIGV4YWN0bHkgdGhlIHNhbWUgZm9yIGFybSBhbmQgeDg2
IG1vdmUgdGhlIHNldHVwIHRvCmRyaXZlcnMveGVuLCB0b28uIFRoaXMgYXQgb25jZSByZW1vdmVz
IHRoZSBuZWVkIHRvIG1ha2UgdGhlIHNpbmdsZQpmdW5jdGlvbnMgZ2xvYmFsIHZpc2libGUuCgpT
aWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3VzZS5jb20+Ci0tLQogYXJjaC9h
cm0vaW5jbHVkZS9hc20veGVuL3hlbi1vcHMuaCAgIHwgIDYgLS0tCiBhcmNoL2FybS94ZW4vTWFr
ZWZpbGUgICAgICAgICAgICAgICAgfCAgMSAtCiBhcmNoL2FybS94ZW4vZWZpLmMgICAgICAgICAg
ICAgICAgICAgfCAzMCAtLS0tLS0tLS0tLS0tCiBhcmNoL2FybS94ZW4vZW5saWdodGVuLmMgICAg
ICAgICAgICAgfCAgMSAtCiBhcmNoL2FybTY0L2luY2x1ZGUvYXNtL3hlbi94ZW4tb3BzLmggfCAg
NyAtLS0KIGFyY2gvYXJtNjQveGVuL01ha2VmaWxlICAgICAgICAgICAgICB8ICAxIC0KIGFyY2gv
eDg2L3hlbi9lZmkuYyAgICAgICAgICAgICAgICAgICB8IDE2ICstLS0tLS0KIGRyaXZlcnMveGVu
L2VmaS5jICAgICAgICAgICAgICAgICAgICB8IDg1ICsrKysrKysrKysrKysrKysrKysrLS0tLS0t
LS0tLS0tLS0tLQogaW5jbHVkZS94ZW4veGVuLW9wcy5oICAgICAgICAgICAgICAgIHwgMjUgKy0t
LS0tLS0tLS0KIDkgZmlsZXMgY2hhbmdlZCwgNTAgaW5zZXJ0aW9ucygrKSwgMTIyIGRlbGV0aW9u
cygtKQogZGVsZXRlIG1vZGUgMTAwNjQ0IGFyY2gvYXJtL2luY2x1ZGUvYXNtL3hlbi94ZW4tb3Bz
LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBhcmNoL2FybS94ZW4vZWZpLmMKIGRlbGV0ZSBtb2RlIDEw
MDY0NCBhcmNoL2FybTY0L2luY2x1ZGUvYXNtL3hlbi94ZW4tb3BzLmgKCmRpZmYgLS1naXQgYS9h
cmNoL2FybS9pbmNsdWRlL2FzbS94ZW4veGVuLW9wcy5oIGIvYXJjaC9hcm0vaW5jbHVkZS9hc20v
eGVuL3hlbi1vcHMuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggZWMxNTRlNzE5YjEx
Li4wMDAwMDAwMDAwMDAKLS0tIGEvYXJjaC9hcm0vaW5jbHVkZS9hc20veGVuL3hlbi1vcHMuaAor
KysgL2Rldi9udWxsCkBAIC0xLDYgKzAsMCBAQAotI2lmbmRlZiBfQVNNX1hFTl9PUFNfSAotI2Rl
ZmluZSBfQVNNX1hFTl9PUFNfSAotCi12b2lkIHhlbl9lZmlfcnVudGltZV9zZXR1cCh2b2lkKTsK
LQotI2VuZGlmIC8qIF9BU01fWEVOX09QU19IICovCmRpZmYgLS1naXQgYS9hcmNoL2FybS94ZW4v
TWFrZWZpbGUgYi9hcmNoL2FybS94ZW4vTWFrZWZpbGUKaW5kZXggN2VkMjg5ODJjNGMzLi5jMzJk
MDQ3MTNiYTAgMTAwNjQ0Ci0tLSBhL2FyY2gvYXJtL3hlbi9NYWtlZmlsZQorKysgYi9hcmNoL2Fy
bS94ZW4vTWFrZWZpbGUKQEAgLTEsMyArMSwyIEBACiAjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wLW9ubHkKIG9iai15CQk6PSBlbmxpZ2h0ZW4ubyBoeXBlcmNhbGwubyBncmFudC10
YWJsZS5vIHAybS5vIG1tLm8KLW9iai0kKENPTkZJR19YRU5fRUZJKSArPSBlZmkubwpkaWZmIC0t
Z2l0IGEvYXJjaC9hcm0veGVuL2VmaS5jIGIvYXJjaC9hcm0veGVuL2VmaS5jCmRlbGV0ZWQgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCBjYjJhYWY5OGUyNDMuLjAwMDAwMDAwMDAwMAotLS0gYS9hcmNo
L2FybS94ZW4vZWZpLmMKKysrIC9kZXYvbnVsbApAQCAtMSwzMCArMCwwIEBACi0vLyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRlcgotLyoKLSAqIENvcHlyaWdodCAoYykg
MjAxNSwgTGluYXJvIExpbWl0ZWQsIFNoYW5ub24gWmhhbwotICovCi0KLSNpbmNsdWRlIDxsaW51
eC9lZmkuaD4KLSNpbmNsdWRlIDx4ZW4veGVuLW9wcy5oPgotI2luY2x1ZGUgPGFzbS94ZW4veGVu
LW9wcy5oPgotCi0vKiBTZXQgWEVOIEVGSSBydW50aW1lIHNlcnZpY2VzIGZ1bmN0aW9uIHBvaW50
ZXJzLiBPdGhlciBmaWVsZHMgb2Ygc3RydWN0IGVmaSwKLSAqIGUuZy4gZWZpLnN5c3RhYiwgd2ls
bCBiZSBzZXQgbGlrZSBub3JtYWwgRUZJLgotICovCi12b2lkIF9faW5pdCB4ZW5fZWZpX3J1bnRp
bWVfc2V0dXAodm9pZCkKLXsKLQllZmkuZ2V0X3RpbWUgICAgICAgICAgICAgICAgID0geGVuX2Vm
aV9nZXRfdGltZTsKLQllZmkuc2V0X3RpbWUgICAgICAgICAgICAgICAgID0geGVuX2VmaV9zZXRf
dGltZTsKLQllZmkuZ2V0X3dha2V1cF90aW1lICAgICAgICAgID0geGVuX2VmaV9nZXRfd2FrZXVw
X3RpbWU7Ci0JZWZpLnNldF93YWtldXBfdGltZSAgICAgICAgICA9IHhlbl9lZmlfc2V0X3dha2V1
cF90aW1lOwotCWVmaS5nZXRfdmFyaWFibGUgICAgICAgICAgICAgPSB4ZW5fZWZpX2dldF92YXJp
YWJsZTsKLQllZmkuZ2V0X25leHRfdmFyaWFibGUgICAgICAgID0geGVuX2VmaV9nZXRfbmV4dF92
YXJpYWJsZTsKLQllZmkuc2V0X3ZhcmlhYmxlICAgICAgICAgICAgID0geGVuX2VmaV9zZXRfdmFy
aWFibGU7Ci0JZWZpLnNldF92YXJpYWJsZV9ub25ibG9ja2luZyA9IHhlbl9lZmlfc2V0X3Zhcmlh
YmxlOwotCWVmaS5xdWVyeV92YXJpYWJsZV9pbmZvICAgICAgPSB4ZW5fZWZpX3F1ZXJ5X3Zhcmlh
YmxlX2luZm87Ci0JZWZpLnF1ZXJ5X3ZhcmlhYmxlX2luZm9fbm9uYmxvY2tpbmcgPSB4ZW5fZWZp
X3F1ZXJ5X3ZhcmlhYmxlX2luZm87Ci0JZWZpLnVwZGF0ZV9jYXBzdWxlICAgICAgICAgICA9IHhl
bl9lZmlfdXBkYXRlX2NhcHN1bGU7Ci0JZWZpLnF1ZXJ5X2NhcHN1bGVfY2FwcyAgICAgICA9IHhl
bl9lZmlfcXVlcnlfY2Fwc3VsZV9jYXBzOwotCWVmaS5nZXRfbmV4dF9oaWdoX21vbm9fY291bnQg
PSB4ZW5fZWZpX2dldF9uZXh0X2hpZ2hfbW9ub19jb3VudDsKLQllZmkucmVzZXRfc3lzdGVtICAg
ICAgICAgICAgID0geGVuX2VmaV9yZXNldF9zeXN0ZW07Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTCh4
ZW5fZWZpX3J1bnRpbWVfc2V0dXApOwpkaWZmIC0tZ2l0IGEvYXJjaC9hcm0veGVuL2VubGlnaHRl
bi5jIGIvYXJjaC9hcm0veGVuL2VubGlnaHRlbi5jCmluZGV4IDFlNTc2OTI1NTJkOS4uOTlmOTU1
YTViNjk0IDEwMDY0NAotLS0gYS9hcmNoL2FybS94ZW4vZW5saWdodGVuLmMKKysrIGIvYXJjaC9h
cm0veGVuL2VubGlnaHRlbi5jCkBAIC0xNSw3ICsxNSw2IEBACiAjaW5jbHVkZSA8eGVuL3hlbi1v
cHMuaD4KICNpbmNsdWRlIDxhc20veGVuL2h5cGVydmlzb3IuaD4KICNpbmNsdWRlIDxhc20veGVu
L2h5cGVyY2FsbC5oPgotI2luY2x1ZGUgPGFzbS94ZW4veGVuLW9wcy5oPgogI2luY2x1ZGUgPGFz
bS9zeXN0ZW1fbWlzYy5oPgogI2luY2x1ZGUgPGFzbS9lZmkuaD4KICNpbmNsdWRlIDxsaW51eC9p
bnRlcnJ1cHQuaD4KZGlmZiAtLWdpdCBhL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20veGVuL3hlbi1v
cHMuaCBiL2FyY2gvYXJtNjQvaW5jbHVkZS9hc20veGVuL3hlbi1vcHMuaApkZWxldGVkIGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggZTZlNzg0MDUxOTMyLi4wMDAwMDAwMDAwMDAKLS0tIGEvYXJjaC9h
cm02NC9pbmNsdWRlL2FzbS94ZW4veGVuLW9wcy5oCisrKyAvZGV2L251bGwKQEAgLTEsNyArMCww
IEBACi0vKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwotI2lmbmRlZiBfQVNN
X1hFTl9PUFNfSAotI2RlZmluZSBfQVNNX1hFTl9PUFNfSAotCi12b2lkIHhlbl9lZmlfcnVudGlt
ZV9zZXR1cCh2b2lkKTsKLQotI2VuZGlmIC8qIF9BU01fWEVOX09QU19IICovCmRpZmYgLS1naXQg
YS9hcmNoL2FybTY0L3hlbi9NYWtlZmlsZSBiL2FyY2gvYXJtNjQveGVuL01ha2VmaWxlCmluZGV4
IGE0ZmM2NWYzOTI4ZC4uYjY2MjE1ZTg2NThlIDEwMDY0NAotLS0gYS9hcmNoL2FybTY0L3hlbi9N
YWtlZmlsZQorKysgYi9hcmNoL2FybTY0L3hlbi9NYWtlZmlsZQpAQCAtMSw0ICsxLDMgQEAKICMg
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQogeGVuLWFybS15CSs9ICQoYWRk
cHJlZml4IC4uLy4uL2FybS94ZW4vLCBlbmxpZ2h0ZW4ubyBncmFudC10YWJsZS5vIHAybS5vIG1t
Lm8pCiBvYmoteQkJOj0geGVuLWFybS5vIGh5cGVyY2FsbC5vCi1vYmotJChDT05GSUdfWEVOX0VG
SSkgKz0gJChhZGRwcmVmaXggLi4vLi4vYXJtL3hlbi8sIGVmaS5vKQpkaWZmIC0tZ2l0IGEvYXJj
aC94ODYveGVuL2VmaS5jIGIvYXJjaC94ODYveGVuL2VmaS5jCmluZGV4IDdlM2ViNzBmNDExYS4u
YTA0NTUxZWU1NTY4IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni94ZW4vZWZpLmMKKysrIGIvYXJjaC94
ODYveGVuL2VmaS5jCkBAIC01NywyMSArNTcsNyBAQCBzdGF0aWMgZWZpX3N5c3RlbV90YWJsZV90
IF9faW5pdCAqeGVuX2VmaV9wcm9iZSh2b2lkKQogCQlyZXR1cm4gTlVMTDsKIAogCS8qIEhlcmUg
d2Uga25vdyB0aGF0IFhlbiBydW5zIG9uIEVGSSBwbGF0Zm9ybS4gKi8KLQotCWVmaS5nZXRfdGlt
ZSAgICAgICAgICAgICAgICAgPSB4ZW5fZWZpX2dldF90aW1lOwotCWVmaS5zZXRfdGltZSAgICAg
ICAgICAgICAgICAgPSB4ZW5fZWZpX3NldF90aW1lOwotCWVmaS5nZXRfd2FrZXVwX3RpbWUgICAg
ICAgICAgPSB4ZW5fZWZpX2dldF93YWtldXBfdGltZTsKLQllZmkuc2V0X3dha2V1cF90aW1lICAg
ICAgICAgID0geGVuX2VmaV9zZXRfd2FrZXVwX3RpbWU7Ci0JZWZpLmdldF92YXJpYWJsZSAgICAg
ICAgICAgICA9IHhlbl9lZmlfZ2V0X3ZhcmlhYmxlOwotCWVmaS5nZXRfbmV4dF92YXJpYWJsZSAg
ICAgICAgPSB4ZW5fZWZpX2dldF9uZXh0X3ZhcmlhYmxlOwotCWVmaS5zZXRfdmFyaWFibGUgICAg
ICAgICAgICAgPSB4ZW5fZWZpX3NldF92YXJpYWJsZTsKLQllZmkuc2V0X3ZhcmlhYmxlX25vbmJs
b2NraW5nID0geGVuX2VmaV9zZXRfdmFyaWFibGU7Ci0JZWZpLnF1ZXJ5X3ZhcmlhYmxlX2luZm8g
ICAgICA9IHhlbl9lZmlfcXVlcnlfdmFyaWFibGVfaW5mbzsKLQllZmkucXVlcnlfdmFyaWFibGVf
aW5mb19ub25ibG9ja2luZyA9IHhlbl9lZmlfcXVlcnlfdmFyaWFibGVfaW5mbzsKLQllZmkudXBk
YXRlX2NhcHN1bGUgICAgICAgICAgID0geGVuX2VmaV91cGRhdGVfY2Fwc3VsZTsKLQllZmkucXVl
cnlfY2Fwc3VsZV9jYXBzICAgICAgID0geGVuX2VmaV9xdWVyeV9jYXBzdWxlX2NhcHM7Ci0JZWZp
LmdldF9uZXh0X2hpZ2hfbW9ub19jb3VudCA9IHhlbl9lZmlfZ2V0X25leHRfaGlnaF9tb25vX2Nv
dW50OwotCWVmaS5yZXNldF9zeXN0ZW0gICAgICAgICAgICAgPSB4ZW5fZWZpX3Jlc2V0X3N5c3Rl
bTsKKwl4ZW5fZWZpX3J1bnRpbWVfc2V0dXAoKTsKIAogCWVmaV9zeXN0YWJfeGVuLnRhYmxlcyA9
IGluZm8tPmNmZy5hZGRyOwogCWVmaV9zeXN0YWJfeGVuLm5yX3RhYmxlcyA9IGluZm8tPmNmZy5u
ZW50OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy94ZW4vZWZpLmMgYi9kcml2ZXJzL3hlbi9lZmkuYwpp
bmRleCA4OWQ2MGY4ZTNjMTguLmZmYmRhYTlmNGE0NSAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4v
ZWZpLmMKKysrIGIvZHJpdmVycy94ZW4vZWZpLmMKQEAgLTQwLDcgKzQwLDcgQEAKIAogI2RlZmlu
ZSBlZmlfZGF0YShvcCkJKG9wLnUuZWZpX3J1bnRpbWVfY2FsbCkKIAotZWZpX3N0YXR1c190IHhl
bl9lZmlfZ2V0X3RpbWUoZWZpX3RpbWVfdCAqdG0sIGVmaV90aW1lX2NhcF90ICp0YykKK3N0YXRp
YyBlZmlfc3RhdHVzX3QgeGVuX2VmaV9nZXRfdGltZShlZmlfdGltZV90ICp0bSwgZWZpX3RpbWVf
Y2FwX3QgKnRjKQogewogCXN0cnVjdCB4ZW5fcGxhdGZvcm1fb3Agb3AgPSBJTklUX0VGSV9PUChn
ZXRfdGltZSk7CiAKQEAgLTYxLDkgKzYxLDggQEAgZWZpX3N0YXR1c190IHhlbl9lZmlfZ2V0X3Rp
bWUoZWZpX3RpbWVfdCAqdG0sIGVmaV90aW1lX2NhcF90ICp0YykKIAogCXJldHVybiBlZmlfZGF0
YShvcCkuc3RhdHVzOwogfQotRVhQT1JUX1NZTUJPTF9HUEwoeGVuX2VmaV9nZXRfdGltZSk7CiAK
LWVmaV9zdGF0dXNfdCB4ZW5fZWZpX3NldF90aW1lKGVmaV90aW1lX3QgKnRtKQorc3RhdGljIGVm
aV9zdGF0dXNfdCB4ZW5fZWZpX3NldF90aW1lKGVmaV90aW1lX3QgKnRtKQogewogCXN0cnVjdCB4
ZW5fcGxhdGZvcm1fb3Agb3AgPSBJTklUX0VGSV9PUChzZXRfdGltZSk7CiAKQEAgLTc1LDEwICs3
NCwxMCBAQCBlZmlfc3RhdHVzX3QgeGVuX2VmaV9zZXRfdGltZShlZmlfdGltZV90ICp0bSkKIAog
CXJldHVybiBlZmlfZGF0YShvcCkuc3RhdHVzOwogfQotRVhQT1JUX1NZTUJPTF9HUEwoeGVuX2Vm
aV9zZXRfdGltZSk7CiAKLWVmaV9zdGF0dXNfdCB4ZW5fZWZpX2dldF93YWtldXBfdGltZShlZmlf
Ym9vbF90ICplbmFibGVkLCBlZmlfYm9vbF90ICpwZW5kaW5nLAotCQkJCSAgICAgZWZpX3RpbWVf
dCAqdG0pCitzdGF0aWMgZWZpX3N0YXR1c190IHhlbl9lZmlfZ2V0X3dha2V1cF90aW1lKGVmaV9i
b29sX3QgKmVuYWJsZWQsCisJCQkJCSAgICBlZmlfYm9vbF90ICpwZW5kaW5nLAorCQkJCQkgICAg
ZWZpX3RpbWVfdCAqdG0pCiB7CiAJc3RydWN0IHhlbl9wbGF0Zm9ybV9vcCBvcCA9IElOSVRfRUZJ
X09QKGdldF93YWtldXBfdGltZSk7CiAKQEAgLTk4LDkgKzk3LDggQEAgZWZpX3N0YXR1c190IHhl
bl9lZmlfZ2V0X3dha2V1cF90aW1lKGVmaV9ib29sX3QgKmVuYWJsZWQsIGVmaV9ib29sX3QgKnBl
bmRpbmcsCiAKIAlyZXR1cm4gZWZpX2RhdGEob3ApLnN0YXR1czsKIH0KLUVYUE9SVF9TWU1CT0xf
R1BMKHhlbl9lZmlfZ2V0X3dha2V1cF90aW1lKTsKIAotZWZpX3N0YXR1c190IHhlbl9lZmlfc2V0
X3dha2V1cF90aW1lKGVmaV9ib29sX3QgZW5hYmxlZCwgZWZpX3RpbWVfdCAqdG0pCitzdGF0aWMg
ZWZpX3N0YXR1c190IHhlbl9lZmlfc2V0X3dha2V1cF90aW1lKGVmaV9ib29sX3QgZW5hYmxlZCwg
ZWZpX3RpbWVfdCAqdG0pCiB7CiAJc3RydWN0IHhlbl9wbGF0Zm9ybV9vcCBvcCA9IElOSVRfRUZJ
X09QKHNldF93YWtldXBfdGltZSk7CiAKQEAgLTExNywxMSArMTE1LDEwIEBAIGVmaV9zdGF0dXNf
dCB4ZW5fZWZpX3NldF93YWtldXBfdGltZShlZmlfYm9vbF90IGVuYWJsZWQsIGVmaV90aW1lX3Qg
KnRtKQogCiAJcmV0dXJuIGVmaV9kYXRhKG9wKS5zdGF0dXM7CiB9Ci1FWFBPUlRfU1lNQk9MX0dQ
TCh4ZW5fZWZpX3NldF93YWtldXBfdGltZSk7CiAKLWVmaV9zdGF0dXNfdCB4ZW5fZWZpX2dldF92
YXJpYWJsZShlZmlfY2hhcjE2X3QgKm5hbWUsIGVmaV9ndWlkX3QgKnZlbmRvciwKLQkJCQkgIHUz
MiAqYXR0ciwgdW5zaWduZWQgbG9uZyAqZGF0YV9zaXplLAotCQkJCSAgdm9pZCAqZGF0YSkKK3N0
YXRpYyBlZmlfc3RhdHVzX3QgeGVuX2VmaV9nZXRfdmFyaWFibGUoZWZpX2NoYXIxNl90ICpuYW1l
LCBlZmlfZ3VpZF90ICp2ZW5kb3IsCisJCQkJCSB1MzIgKmF0dHIsIHVuc2lnbmVkIGxvbmcgKmRh
dGFfc2l6ZSwKKwkJCQkJIHZvaWQgKmRhdGEpCiB7CiAJc3RydWN0IHhlbl9wbGF0Zm9ybV9vcCBv
cCA9IElOSVRfRUZJX09QKGdldF92YXJpYWJsZSk7CiAKQEAgLTE0MSwxMSArMTM4LDEwIEBAIGVm
aV9zdGF0dXNfdCB4ZW5fZWZpX2dldF92YXJpYWJsZShlZmlfY2hhcjE2X3QgKm5hbWUsIGVmaV9n
dWlkX3QgKnZlbmRvciwKIAogCXJldHVybiBlZmlfZGF0YShvcCkuc3RhdHVzOwogfQotRVhQT1JU
X1NZTUJPTF9HUEwoeGVuX2VmaV9nZXRfdmFyaWFibGUpOwogCi1lZmlfc3RhdHVzX3QgeGVuX2Vm
aV9nZXRfbmV4dF92YXJpYWJsZSh1bnNpZ25lZCBsb25nICpuYW1lX3NpemUsCi0JCQkJICAgICAg
IGVmaV9jaGFyMTZfdCAqbmFtZSwKLQkJCQkgICAgICAgZWZpX2d1aWRfdCAqdmVuZG9yKQorc3Rh
dGljIGVmaV9zdGF0dXNfdCB4ZW5fZWZpX2dldF9uZXh0X3ZhcmlhYmxlKHVuc2lnbmVkIGxvbmcg
Km5hbWVfc2l6ZSwKKwkJCQkJICAgICAgZWZpX2NoYXIxNl90ICpuYW1lLAorCQkJCQkgICAgICBl
ZmlfZ3VpZF90ICp2ZW5kb3IpCiB7CiAJc3RydWN0IHhlbl9wbGF0Zm9ybV9vcCBvcCA9IElOSVRf
RUZJX09QKGdldF9uZXh0X3ZhcmlhYmxlX25hbWUpOwogCkBAIC0xNjUsMTEgKzE2MSwxMCBAQCBl
Zmlfc3RhdHVzX3QgeGVuX2VmaV9nZXRfbmV4dF92YXJpYWJsZSh1bnNpZ25lZCBsb25nICpuYW1l
X3NpemUsCiAKIAlyZXR1cm4gZWZpX2RhdGEob3ApLnN0YXR1czsKIH0KLUVYUE9SVF9TWU1CT0xf
R1BMKHhlbl9lZmlfZ2V0X25leHRfdmFyaWFibGUpOwogCi1lZmlfc3RhdHVzX3QgeGVuX2VmaV9z
ZXRfdmFyaWFibGUoZWZpX2NoYXIxNl90ICpuYW1lLCBlZmlfZ3VpZF90ICp2ZW5kb3IsCi0JCQkJ
IHUzMiBhdHRyLCB1bnNpZ25lZCBsb25nIGRhdGFfc2l6ZSwKLQkJCQkgdm9pZCAqZGF0YSkKK3N0
YXRpYyBlZmlfc3RhdHVzX3QgeGVuX2VmaV9zZXRfdmFyaWFibGUoZWZpX2NoYXIxNl90ICpuYW1l
LCBlZmlfZ3VpZF90ICp2ZW5kb3IsCisJCQkJCSB1MzIgYXR0ciwgdW5zaWduZWQgbG9uZyBkYXRh
X3NpemUsCisJCQkJCSB2b2lkICpkYXRhKQogewogCXN0cnVjdCB4ZW5fcGxhdGZvcm1fb3Agb3Ag
PSBJTklUX0VGSV9PUChzZXRfdmFyaWFibGUpOwogCkBAIC0xODYsMTEgKzE4MSwxMCBAQCBlZmlf
c3RhdHVzX3QgeGVuX2VmaV9zZXRfdmFyaWFibGUoZWZpX2NoYXIxNl90ICpuYW1lLCBlZmlfZ3Vp
ZF90ICp2ZW5kb3IsCiAKIAlyZXR1cm4gZWZpX2RhdGEob3ApLnN0YXR1czsKIH0KLUVYUE9SVF9T
WU1CT0xfR1BMKHhlbl9lZmlfc2V0X3ZhcmlhYmxlKTsKIAotZWZpX3N0YXR1c190IHhlbl9lZmlf
cXVlcnlfdmFyaWFibGVfaW5mbyh1MzIgYXR0ciwgdTY0ICpzdG9yYWdlX3NwYWNlLAotCQkJCQkg
dTY0ICpyZW1haW5pbmdfc3BhY2UsCi0JCQkJCSB1NjQgKm1heF92YXJpYWJsZV9zaXplKQorc3Rh
dGljIGVmaV9zdGF0dXNfdCB4ZW5fZWZpX3F1ZXJ5X3ZhcmlhYmxlX2luZm8odTMyIGF0dHIsIHU2
NCAqc3RvcmFnZV9zcGFjZSwKKwkJCQkJCXU2NCAqcmVtYWluaW5nX3NwYWNlLAorCQkJCQkJdTY0
ICptYXhfdmFyaWFibGVfc2l6ZSkKIHsKIAlzdHJ1Y3QgeGVuX3BsYXRmb3JtX29wIG9wID0gSU5J
VF9FRklfT1AocXVlcnlfdmFyaWFibGVfaW5mbyk7CiAKQEAgLTIwOCw5ICsyMDIsOCBAQCBlZmlf
c3RhdHVzX3QgeGVuX2VmaV9xdWVyeV92YXJpYWJsZV9pbmZvKHUzMiBhdHRyLCB1NjQgKnN0b3Jh
Z2Vfc3BhY2UsCiAKIAlyZXR1cm4gZWZpX2RhdGEob3ApLnN0YXR1czsKIH0KLUVYUE9SVF9TWU1C
T0xfR1BMKHhlbl9lZmlfcXVlcnlfdmFyaWFibGVfaW5mbyk7CiAKLWVmaV9zdGF0dXNfdCB4ZW5f
ZWZpX2dldF9uZXh0X2hpZ2hfbW9ub19jb3VudCh1MzIgKmNvdW50KQorc3RhdGljIGVmaV9zdGF0
dXNfdCB4ZW5fZWZpX2dldF9uZXh0X2hpZ2hfbW9ub19jb3VudCh1MzIgKmNvdW50KQogewogCXN0
cnVjdCB4ZW5fcGxhdGZvcm1fb3Agb3AgPSBJTklUX0VGSV9PUChnZXRfbmV4dF9oaWdoX21vbm90
b25pY19jb3VudCk7CiAKQEAgLTIyMSwxMCArMjE0LDkgQEAgZWZpX3N0YXR1c190IHhlbl9lZmlf
Z2V0X25leHRfaGlnaF9tb25vX2NvdW50KHUzMiAqY291bnQpCiAKIAlyZXR1cm4gZWZpX2RhdGEo
b3ApLnN0YXR1czsKIH0KLUVYUE9SVF9TWU1CT0xfR1BMKHhlbl9lZmlfZ2V0X25leHRfaGlnaF9t
b25vX2NvdW50KTsKIAotZWZpX3N0YXR1c190IHhlbl9lZmlfdXBkYXRlX2NhcHN1bGUoZWZpX2Nh
cHN1bGVfaGVhZGVyX3QgKipjYXBzdWxlcywKLQkJCQkgICAgdW5zaWduZWQgbG9uZyBjb3VudCwg
dW5zaWduZWQgbG9uZyBzZ19saXN0KQorc3RhdGljIGVmaV9zdGF0dXNfdCB4ZW5fZWZpX3VwZGF0
ZV9jYXBzdWxlKGVmaV9jYXBzdWxlX2hlYWRlcl90ICoqY2Fwc3VsZXMsCisJCQkJdW5zaWduZWQg
bG9uZyBjb3VudCwgdW5zaWduZWQgbG9uZyBzZ19saXN0KQogewogCXN0cnVjdCB4ZW5fcGxhdGZv
cm1fb3Agb3AgPSBJTklUX0VGSV9PUCh1cGRhdGVfY2Fwc3VsZSk7CiAKQEAgLTI0MSwxMSArMjMz
LDkgQEAgZWZpX3N0YXR1c190IHhlbl9lZmlfdXBkYXRlX2NhcHN1bGUoZWZpX2NhcHN1bGVfaGVh
ZGVyX3QgKipjYXBzdWxlcywKIAogCXJldHVybiBlZmlfZGF0YShvcCkuc3RhdHVzOwogfQotRVhQ
T1JUX1NZTUJPTF9HUEwoeGVuX2VmaV91cGRhdGVfY2Fwc3VsZSk7CiAKLWVmaV9zdGF0dXNfdCB4
ZW5fZWZpX3F1ZXJ5X2NhcHN1bGVfY2FwcyhlZmlfY2Fwc3VsZV9oZWFkZXJfdCAqKmNhcHN1bGVz
LAotCQkJCQl1bnNpZ25lZCBsb25nIGNvdW50LCB1NjQgKm1heF9zaXplLAotCQkJCQlpbnQgKnJl
c2V0X3R5cGUpCitzdGF0aWMgZWZpX3N0YXR1c190IHhlbl9lZmlfcXVlcnlfY2Fwc3VsZV9jYXBz
KGVmaV9jYXBzdWxlX2hlYWRlcl90ICoqY2Fwc3VsZXMsCisJCQl1bnNpZ25lZCBsb25nIGNvdW50
LCB1NjQgKm1heF9zaXplLCBpbnQgKnJlc2V0X3R5cGUpCiB7CiAJc3RydWN0IHhlbl9wbGF0Zm9y
bV9vcCBvcCA9IElOSVRfRUZJX09QKHF1ZXJ5X2NhcHN1bGVfY2FwYWJpbGl0aWVzKTsKIApAQCAt
MjY0LDEwICsyNTQsOSBAQCBlZmlfc3RhdHVzX3QgeGVuX2VmaV9xdWVyeV9jYXBzdWxlX2NhcHMo
ZWZpX2NhcHN1bGVfaGVhZGVyX3QgKipjYXBzdWxlcywKIAogCXJldHVybiBlZmlfZGF0YShvcCku
c3RhdHVzOwogfQotRVhQT1JUX1NZTUJPTF9HUEwoeGVuX2VmaV9xdWVyeV9jYXBzdWxlX2NhcHMp
OwogCi12b2lkIHhlbl9lZmlfcmVzZXRfc3lzdGVtKGludCByZXNldF90eXBlLCBlZmlfc3RhdHVz
X3Qgc3RhdHVzLAotCQkJICB1bnNpZ25lZCBsb25nIGRhdGFfc2l6ZSwgZWZpX2NoYXIxNl90ICpk
YXRhKQorc3RhdGljIHZvaWQgeGVuX2VmaV9yZXNldF9zeXN0ZW0oaW50IHJlc2V0X3R5cGUsIGVm
aV9zdGF0dXNfdCBzdGF0dXMsCisJCQkJIHVuc2lnbmVkIGxvbmcgZGF0YV9zaXplLCBlZmlfY2hh
cjE2X3QgKmRhdGEpCiB7CiAJc3dpdGNoIChyZXNldF90eXBlKSB7CiAJY2FzZSBFRklfUkVTRVRf
Q09MRDoKQEAgLTI4MSw0ICsyNzAsMjYgQEAgdm9pZCB4ZW5fZWZpX3Jlc2V0X3N5c3RlbShpbnQg
cmVzZXRfdHlwZSwgZWZpX3N0YXR1c190IHN0YXR1cywKIAkJQlVHKCk7CiAJfQogfQotRVhQT1JU
X1NZTUJPTF9HUEwoeGVuX2VmaV9yZXNldF9zeXN0ZW0pOworCisvKgorICogU2V0IFhFTiBFRkkg
cnVudGltZSBzZXJ2aWNlcyBmdW5jdGlvbiBwb2ludGVycy4gT3RoZXIgZmllbGRzIG9mIHN0cnVj
dCBlZmksCisgKiBlLmcuIGVmaS5zeXN0YWIsIHdpbGwgYmUgc2V0IGxpa2Ugbm9ybWFsIEVGSS4K
KyAqLwordm9pZCBfX2luaXQgeGVuX2VmaV9ydW50aW1lX3NldHVwKHZvaWQpCit7CisJZWZpLmdl
dF90aW1lCQkJPSB4ZW5fZWZpX2dldF90aW1lOworCWVmaS5zZXRfdGltZQkJCT0geGVuX2VmaV9z
ZXRfdGltZTsKKwllZmkuZ2V0X3dha2V1cF90aW1lCQk9IHhlbl9lZmlfZ2V0X3dha2V1cF90aW1l
OworCWVmaS5zZXRfd2FrZXVwX3RpbWUJCT0geGVuX2VmaV9zZXRfd2FrZXVwX3RpbWU7CisJZWZp
LmdldF92YXJpYWJsZQkJPSB4ZW5fZWZpX2dldF92YXJpYWJsZTsKKwllZmkuZ2V0X25leHRfdmFy
aWFibGUJCT0geGVuX2VmaV9nZXRfbmV4dF92YXJpYWJsZTsKKwllZmkuc2V0X3ZhcmlhYmxlCQk9
IHhlbl9lZmlfc2V0X3ZhcmlhYmxlOworCWVmaS5zZXRfdmFyaWFibGVfbm9uYmxvY2tpbmcJPSB4
ZW5fZWZpX3NldF92YXJpYWJsZTsKKwllZmkucXVlcnlfdmFyaWFibGVfaW5mbwkJPSB4ZW5fZWZp
X3F1ZXJ5X3ZhcmlhYmxlX2luZm87CisJZWZpLnF1ZXJ5X3ZhcmlhYmxlX2luZm9fbm9uYmxvY2tp
bmcgPSB4ZW5fZWZpX3F1ZXJ5X3ZhcmlhYmxlX2luZm87CisJZWZpLnVwZGF0ZV9jYXBzdWxlCQk9
IHhlbl9lZmlfdXBkYXRlX2NhcHN1bGU7CisJZWZpLnF1ZXJ5X2NhcHN1bGVfY2FwcwkJPSB4ZW5f
ZWZpX3F1ZXJ5X2NhcHN1bGVfY2FwczsKKwllZmkuZ2V0X25leHRfaGlnaF9tb25vX2NvdW50CT0g
eGVuX2VmaV9nZXRfbmV4dF9oaWdoX21vbm9fY291bnQ7CisJZWZpLnJlc2V0X3N5c3RlbQkJPSB4
ZW5fZWZpX3Jlc2V0X3N5c3RlbTsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKHhlbl9lZmlfcnVudGlt
ZV9zZXR1cCk7CmRpZmYgLS1naXQgYS9pbmNsdWRlL3hlbi94ZW4tb3BzLmggYi9pbmNsdWRlL3hl
bi94ZW4tb3BzLmgKaW5kZXggOThiMzBjMTYxM2IyLi5kODk5NjlhYTk5NDIgMTAwNjQ0Ci0tLSBh
L2luY2x1ZGUveGVuL3hlbi1vcHMuaAorKysgYi9pbmNsdWRlL3hlbi94ZW4tb3BzLmgKQEAgLTIx
MiwzMCArMjEyLDcgQEAgaW50IHhlbl94bGF0ZV9tYXBfYmFsbG9vbmVkX3BhZ2VzKHhlbl9wZm5f
dCAqKnBmbnMsIHZvaWQgKip2YWRkciwKIAogYm9vbCB4ZW5fcnVubmluZ19vbl92ZXJzaW9uX29y
X2xhdGVyKHVuc2lnbmVkIGludCBtYWpvciwgdW5zaWduZWQgaW50IG1pbm9yKTsKIAotZWZpX3N0
YXR1c190IHhlbl9lZmlfZ2V0X3RpbWUoZWZpX3RpbWVfdCAqdG0sIGVmaV90aW1lX2NhcF90ICp0
Yyk7Ci1lZmlfc3RhdHVzX3QgeGVuX2VmaV9zZXRfdGltZShlZmlfdGltZV90ICp0bSk7Ci1lZmlf
c3RhdHVzX3QgeGVuX2VmaV9nZXRfd2FrZXVwX3RpbWUoZWZpX2Jvb2xfdCAqZW5hYmxlZCwgZWZp
X2Jvb2xfdCAqcGVuZGluZywKLQkJCQkgICAgIGVmaV90aW1lX3QgKnRtKTsKLWVmaV9zdGF0dXNf
dCB4ZW5fZWZpX3NldF93YWtldXBfdGltZShlZmlfYm9vbF90IGVuYWJsZWQsIGVmaV90aW1lX3Qg
KnRtKTsKLWVmaV9zdGF0dXNfdCB4ZW5fZWZpX2dldF92YXJpYWJsZShlZmlfY2hhcjE2X3QgKm5h
bWUsIGVmaV9ndWlkX3QgKnZlbmRvciwKLQkJCQkgIHUzMiAqYXR0ciwgdW5zaWduZWQgbG9uZyAq
ZGF0YV9zaXplLAotCQkJCSAgdm9pZCAqZGF0YSk7Ci1lZmlfc3RhdHVzX3QgeGVuX2VmaV9nZXRf
bmV4dF92YXJpYWJsZSh1bnNpZ25lZCBsb25nICpuYW1lX3NpemUsCi0JCQkJICAgICAgIGVmaV9j
aGFyMTZfdCAqbmFtZSwgZWZpX2d1aWRfdCAqdmVuZG9yKTsKLWVmaV9zdGF0dXNfdCB4ZW5fZWZp
X3NldF92YXJpYWJsZShlZmlfY2hhcjE2X3QgKm5hbWUsIGVmaV9ndWlkX3QgKnZlbmRvciwKLQkJ
CQkgIHUzMiBhdHRyLCB1bnNpZ25lZCBsb25nIGRhdGFfc2l6ZSwKLQkJCQkgIHZvaWQgKmRhdGEp
OwotZWZpX3N0YXR1c190IHhlbl9lZmlfcXVlcnlfdmFyaWFibGVfaW5mbyh1MzIgYXR0ciwgdTY0
ICpzdG9yYWdlX3NwYWNlLAotCQkJCQkgdTY0ICpyZW1haW5pbmdfc3BhY2UsCi0JCQkJCSB1NjQg
Km1heF92YXJpYWJsZV9zaXplKTsKLWVmaV9zdGF0dXNfdCB4ZW5fZWZpX2dldF9uZXh0X2hpZ2hf
bW9ub19jb3VudCh1MzIgKmNvdW50KTsKLWVmaV9zdGF0dXNfdCB4ZW5fZWZpX3VwZGF0ZV9jYXBz
dWxlKGVmaV9jYXBzdWxlX2hlYWRlcl90ICoqY2Fwc3VsZXMsCi0JCQkJICAgIHVuc2lnbmVkIGxv
bmcgY291bnQsIHVuc2lnbmVkIGxvbmcgc2dfbGlzdCk7Ci1lZmlfc3RhdHVzX3QgeGVuX2VmaV9x
dWVyeV9jYXBzdWxlX2NhcHMoZWZpX2NhcHN1bGVfaGVhZGVyX3QgKipjYXBzdWxlcywKLQkJCQkJ
dW5zaWduZWQgbG9uZyBjb3VudCwgdTY0ICptYXhfc2l6ZSwKLQkJCQkJaW50ICpyZXNldF90eXBl
KTsKLXZvaWQgeGVuX2VmaV9yZXNldF9zeXN0ZW0oaW50IHJlc2V0X3R5cGUsIGVmaV9zdGF0dXNf
dCBzdGF0dXMsCi0JCQkgIHVuc2lnbmVkIGxvbmcgZGF0YV9zaXplLCBlZmlfY2hhcjE2X3QgKmRh
dGEpOwordm9pZCB4ZW5fZWZpX3J1bnRpbWVfc2V0dXAodm9pZCk7CiAKIAogI2lmZGVmIENPTkZJ
R19QUkVFTVBUCi0tIAoyLjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5w
cm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8v
eGVuLWRldmVs

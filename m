Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 320F8C1132
	for <lists+xen-devel@lfdr.de>; Sat, 28 Sep 2019 17:19:49 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEETe-0001iF-3Z; Sat, 28 Sep 2019 15:17:42 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=eHhM=XX=amazon.de=prvs=1678a297b=wipawel@srs-us1.protection.inumbo.net>)
 id 1iEETc-0001hp-Jx
 for xen-devel@lists.xenproject.org; Sat, 28 Sep 2019 15:17:40 +0000
X-Inumbo-ID: 1be3c902-e203-11e9-b588-bc764e2007e4
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by localhost (Halon) with ESMTPS
 id 1be3c902-e203-11e9-b588-bc764e2007e4;
 Sat, 28 Sep 2019 15:17:39 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1569683859; x=1601219859;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=R5gp4iVx1dXhVLAyXsVDTvfIDemy7Jey4wJW9TgEpYY=;
 b=KzhG+hMrA/pLPffZFRyZTUUhTRRNuY1dKWWaQ4B6Tgv7q0RNN3m0AnAV
 OpepnJdjHtK8+FVJKiM/x10Hptv8jUZPujGI4/nBkBcRyQkKQbDv+NhgF
 87aVEVxwoxJvYbxufyEahFjCfqco/uNNnVG8UwaSp8dN6YEZFthkRCKQE g=;
X-IronPort-AV: E=Sophos;i="5.64,559,1559520000"; d="scan'208";a="705176544"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 28 Sep 2019 15:14:29 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-74cf8b49.us-east-1.amazon.com (Postfix) with ESMTPS
 id B4512C0B7F; Sat, 28 Sep 2019 15:14:09 +0000 (UTC)
Received: from EX13D03EUC002.ant.amazon.com (10.43.164.60) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:14:00 +0000
Received: from EX13MTAUWB001.ant.amazon.com (10.43.161.207) by
 EX13D03EUC002.ant.amazon.com (10.43.164.60) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Sat, 28 Sep 2019 15:13:59 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.161.249) with Microsoft SMTP Server
 id
 15.0.1367.3 via Frontend Transport; Sat, 28 Sep 2019 15:13:56 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xenproject.org>
Date: Sat, 28 Sep 2019 15:13:03 +0000
Message-ID: <20190928151305.127380-11-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190928151305.127380-1-wipawel@amazon.de>
References: <20190928151305.127380-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v4 10/12] livepatch: Handle arbitrary size names
 with the list operation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHBheWxvYWRzJyBuYW1lIHN0cmluZ3MgY2FuIGJlIG9mIGFyYml0cmFyeSBzaXplICh0eXBp
Y2FsbHkgc21hbGwKd2l0aCBhbiB1cHBlciBib3VuZCBvZiBYRU5fTElWRVBBVENIX05BTUVfU0la
RSkuCkN1cnJlbnQgaW1wbGVtZW50YXRpb24gb2YgdGhlIGxpc3Qgb3BlcmF0aW9uIGludGVyZmFj
ZSBhbGxvd3MgdG8gY29weQpuYW1lcyBpbiB0aGUgWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUgY2h1
bmtzIHJlZ2FyZGxlc3Mgb2YgaXRzIGFjdHVhbApzaXplIGFuZCBlbmZvcmNlcyBzcGFjZSBhbGxv
Y2F0aW9uIHJlcXVpcmVtZW50cyBvbiB1c2VybGFuZCB0b29scy4KClRvIHVuaWZ5IGFuZCBzaW1w
bGlmeSB0aGUgaW50ZXJmYWNlLCBoYW5kbGUgdGhlIG5hbWUgc3RyaW5ncyBvZgphcmJpdHJhcnkg
c2l6ZSBieSBjb3B5aW5nIHRoZW0gaW4gYWRoZXJpbmcgY2h1bmtzIHRvIHRoZSB1c2VybGFuZC4K
SW4gb3JkZXIgdG8gbGV0IHRoZSB1c2VybGFuZCBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgZm9yIHRo
ZSBpbmNvbWluZwpkYXRhIGFkZCBhbiBhdXhpbGlhcnkgaW50ZXJmYWNlIHhjX2xpdmVwYXRjaF9s
aXN0X2dldF9zaXplcygpIHRoYXQKcHJvdmlkZXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxv
YWQgZW50cmllcyBhbmQgdGhlIHRvdGFsIHNpemUgb2YKYWxsIG5hbWUgc3RyaW5ncy4gVGhpcyBp
cyBhY2hpZXZlZCBieSBleHRlbmRpbmcgdGhlIHN5c2N0bCBsaXN0CmludGVyZmFjZSB3aXRoIGFu
IGV4dHJhIGZpZWxkczogbmFtZV90b3RhbF9zaXplLgoKVGhlIHhjX2xpdmVwYXRjaF9saXN0X2dl
dF9zaXplcygpIGlzc3VlcyB0aGUgbGl2ZXBhdGNoIHN5c2N0bCBsaXN0Cm9wZXJhdGlvbiB3aXRo
IHRoZSBuciBmaWVsZCBzZXQgdG8gMC4gSW4gdGhpcyBtb2RlIHRoZSBvcGVyYXRpb24KcmV0dXJu
cyB0aGUgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcyBhbmQgY2FsY3VsYXRlcyB0aGUgdG90YWwg
c2l6ZXMKZm9yIGFsbCBwYXlsb2FkcycgbmFtZXMuCldoZW4gdGhlIHN5c2N0bCBvcGVyYXRpb24g
aXMgaXNzdWVkIHdpdGggYSBub24temVybyBuciBmaWVsZCAoZm9yCmluc3RhbmNlIHdpdGggYSB2
YWx1ZSBvYnRhaW5lZCBlYXJsaWVyIHdpdGggdGhlIHByaW9yIGNhbGwgdG8gdGhlCnhjX2xpdmVw
YXRjaF9saXN0X2dldF9zaXplcygpKSB0aGUgbmV3IGZpZWxkIG5hbWVfdG90YWxfc2l6ZSBwcm92
aWRlcwp0aGUgdG90YWwgc2l6ZSBvZiBhY3R1YWxseSBjb3BpZWQgZGF0YS4KCkV4dGVuZCB0aGUg
bGlieGMgdG8gaGFuZGxlIHRoZSBuYW1lIGJhY2stdG8tYmFjayBkYXRhIHRyYW5zZmVycy4KClRo
ZSB4ZW4tbGl2ZXBhdGNoIHRvb2wgaXMgbW9kaWZpZWQgdG8gc3RhcnQgdGhlIGxpc3Qgb3BlcmF0
aW9uIHdpdGggYQpjYWxsIHRvIHRoZSB4Y19saXZlcGF0Y2hfbGlzdF9nZXRfc2l6ZXMoKSB0byBv
YnRhaW4gdGhlIGFjdHVhbCBudW1iZXIKb2YgcGF5bG9hZHMgYXMgd2VsbCBhcyB0aGUgbmVjZXNz
YXJ5IHNwYWNlIGZvciBuYW1lcy4KVGhlIHRvb2wgbm93IGFsd2F5cyByZXF1ZXN0cyB0aGUgYWN0
dWFsIG51bWJlciBvZiBlbnRyaWVzIGFuZCBsZWF2ZXMKdGhlIHByZWVtcHRpb24gaGFuZGxpbmcg
dG8gdGhlIGxpYnhjIHJvdXRpbmUuIFRoZSBsaWJ4YyBzdGlsbCByZXR1cm5zCidkb25lJyBhbmQg
J2xlZnQnIHBhcmFtZXRlcnMgd2l0aCB0aGUgc2FtZSBzZW1hbnRpYyBhbGxvd2luZyB0aGUgdG9v
bAp0byBkZXRlY3QgYW5vbWFsaWVzIGFuZCByZWFjdCB0byB0aGVtLiBBdCB0aGUgbW9tZW50IGl0
IGlzIGV4cGVjdGVkCnRoYXQgdGhlIHRvb2wgcmVjZWl2ZXMgdGhlIGV4YWN0IG51bWJlciBvZiBl
bnRyaWVzIGFzIHJlcXVlc3RlZC4KVGhlIHhlbi1saXZlcGF0Y2ggdG9vbCBoYXMgYmVlbiBhbHNv
IG1vZGlmaWVkIHRvIGhhbmRsZSB0aGUgbmFtZQpiYWNrLXRvLWJhY2sgdHJhbnNmZXJzIGNvcnJl
Y3RseS4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpv
bi5kZT4KUmV2aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9u
LmNvbT4KUmV2aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmll
d2VkLWJ5OiBNYXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5
OiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+Ci0tLQpDaGFu
Z2VkIHNpbmNlIHYzOgogICogdXNlIHVpbnQzMl90IGluc3RlYWQgb2YgdWludDY0X3QgYW5kIG9m
Zl90IGZvciBuYW1lX3RvdGFsX3NpemUKICAgIGFuZCByZWxhdGVkIHZhcmlhYmxlcwoKQ2hhbmdl
ZCBzaW5jZSB2MToKICAqIGFkZGVkIGNvcnJlc3BvbmRpbmcgZG9jdW1lbnRhdGlvbgoKIGRvY3Mv
bWlzYy9saXZlcGF0Y2gucGFuZG9jICAgIHwgIDI0ICsrKysrLS0tLQogdG9vbHMvbGlieGMvaW5j
bHVkZS94ZW5jdHJsLmggfCAgNDkgKysrKysrKysrKysrKy0tLS0tLQogdG9vbHMvbGlieGMveGNf
bWlzYy5jICAgICAgICAgfCAxMDAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0t
LQogdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMgICAgfCAxMTEgKysrKysrKysrKysrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tCiB4ZW4vY29tbW9uL2xpdmVwYXRjaC5jICAgICAgICB8
ICAzMSArKysrKysrKystLS0KIHhlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCAgIHwgIDE1ICsr
Ky0tLQogNiBmaWxlcyBjaGFuZ2VkLCAyMTggaW5zZXJ0aW9ucygrKSwgMTEyIGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL2RvY3MvbWlzYy9saXZlcGF0Y2gucGFuZG9jIGIvZG9jcy9taXNjL2xp
dmVwYXRjaC5wYW5kb2MKaW5kZXggMzcxM2MwNTMwZi4uZWViZDA0ZThkZiAxMDA2NDQKLS0tIGEv
ZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MKKysrIGIvZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5k
b2MKQEAgLTcxNywxNyArNzE3LDIwIEBAIFRoZSBjYWxsZXIgcHJvdmlkZXM6CiAgKiBgaWR4YCBJ
bmRleCBpdGVyYXRvci4gVGhlIGluZGV4IGludG8gdGhlIGh5cGVydmlzb3IncyBwYXlsb2FkIGNv
dW50LiBJdCBpcwogICAgIHJlY29tbWVuZGVkIHRoYXQgb24gZmlyc3QgaW52b2NhdGlvbiB6ZXJv
IGJlIHVzZWQgc28gdGhhdCBgbnJgICh3aGljaCB0aGUKICAgICBoeXBlcnZpc29yIHdpbGwgdXBk
YXRlIHdpdGggdGhlIHJlbWFpbmluZyBwYXlsb2FkIGNvdW50KSBiZSBwcm92aWRlZC4KLSAgICBB
bHNvIHRoZSBoeXBlcnZpc29yIHdpbGwgcHJvdmlkZSBgdmVyc2lvbmAgd2l0aCB0aGUgbW9zdCBj
dXJyZW50IHZhbHVlLgorICAgIEFsc28gdGhlIGh5cGVydmlzb3Igd2lsbCBwcm92aWRlIGB2ZXJz
aW9uYCB3aXRoIHRoZSBtb3N0IGN1cnJlbnQgdmFsdWUgYW5kCisgICAgY2FsY3VsYXRlZCB0b3Rh
bCBzaXplIGZvciBhbGwgcGF5bG9hZHMnIG5hbWVzLgogICogYG5yYCBUaGUgbWF4IG51bWJlciBv
ZiBlbnRyaWVzIHRvIHBvcHVsYXRlLiBDYW4gYmUgemVybyB3aGljaCB3aWxsIHJlc3VsdAogICAg
IGluIHRoZSBoeXBlcmNhbGwgYmVpbmcgYSBwcm9iaW5nIG9uZSBhbmQgcmV0dXJuIHRoZSBudW1i
ZXIgb2YgcGF5bG9hZHMKICAgICAoYW5kIHVwZGF0ZSB0aGUgYHZlcnNpb25gKS4KICAqIGBwYWRg
IC0gKk1VU1QqIGJlIHplcm8uCiAgKiBgc3RhdHVzYCBWaXJ0dWFsIGFkZHJlc3Mgb2Ygd2hlcmUg
dG8gd3JpdGUgYHN0cnVjdCB4ZW5fbGl2ZXBhdGNoX3N0YXR1c2AKICAgIHN0cnVjdHVyZXMuIENh
bGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0aGVtLgotICogYG5hbWVgIC0gVmly
dHVhbCBhZGRyZXNzIG9mIHdoZXJlIHRvIHdyaXRlIHRoZSB1bmlxdWUgbmFtZSBvZiB0aGUgcGF5
bG9hZC4KLSAgIENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0aGVtLiBFYWNo
ICpNVVNUKiBiZSBvZgotICAgKipYRU5fTElWRVBBVENIX05BTUVfU0laRSoqIHNpemUuIE5vdGUg
dGhhdCAqKlhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFKiogaW5jbHVkZXMKLSAgIHRoZSBOVUwgdGVy
bWluYXRvci4KKyAqIGBuYW1lYCAtIFZpcnR1YWwgYWRkcmVzcyBvZiB3aGVyZSB0byB3cml0ZSB0
aGUgdW5pcXVlIG5hbWUgb2YgdGhlIHBheWxvYWRzLgorICAgQ2FsbGVyICpNVVNUKiBhbGxvY2F0
ZSBlbm91Z2ggc3BhY2UgdG8gYmUgYWJsZSB0byBzdG9yZSBhbGwgcmVjZWl2ZWQgZGF0YQorICAg
KGkuZS4gdG90YWwgYWxsb2NhdGVkIHNwYWNlICpNVVNUKiBtYXRjaCB0aGUgYG5hbWVfdG90YWxf
c2l6ZWAgdmFsdWUKKyAgIHByb3ZpZGVkIGJ5IHRoZSBoeXBlcnZpc29yKS4gSW5kaXZpZHVhbCBw
YXlsb2FkIG5hbWUgY2Fubm90IGJlIGxvbmdlciB0aGFuCisgICAqKlhFTl9MSVZFUEFUQ0hfTkFN
RV9TSVpFKiogYnl0ZXMuIE5vdGUgdGhhdCAqKlhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFKioKKyAg
IGluY2x1ZGVzIHRoZSBOVUwgdGVybWluYXRvci4KICAqIGBsZW5gIC0gVmlydHVhbCBhZGRyZXNz
IG9mIHdoZXJlIHRvIHdyaXRlIHRoZSBsZW5ndGggb2YgZWFjaCB1bmlxdWUgbmFtZQogICAgb2Yg
dGhlIHBheWxvYWQuIENhbGxlciAqTVVTVCogYWxsb2NhdGUgdXAgdG8gYG5yYCBvZiB0aGVtLiBF
YWNoICpNVVNUKiBiZQogICAgb2Ygc2l6ZW9mKHVpbnQzMl90KSAoNCBieXRlcykuCkBAIC03MzYs
NyArNzM5LDggQEAgSWYgdGhlIGh5cGVyY2FsbCByZXR1cm5zIGFuIHBvc2l0aXZlIG51bWJlciwg
aXQgaXMgdGhlIG51bWJlciAodXB0byBgbnJgCiBwcm92aWRlZCB0byB0aGUgaHlwZXJjYWxsKSBv
ZiB0aGUgcGF5bG9hZHMgcmV0dXJuZWQsIGFsb25nIHdpdGggYG5yYCB1cGRhdGVkCiB3aXRoIHRo
ZSBudW1iZXIgb2YgcmVtYWluaW5nIHBheWxvYWRzLCBgdmVyc2lvbmAgdXBkYXRlZCAoaXQgbWF5
IGJlIHRoZSBzYW1lCiBhY3Jvc3MgaHlwZXJjYWxscyAtIGlmIGl0IHZhcmllcyB0aGUgZGF0YSBp
cyBzdGFsZSBhbmQgZnVydGhlciBjYWxscyBjb3VsZAotZmFpbCkuIFRoZSBgc3RhdHVzYCwgYG5h
bWVgLCBhbmQgYGxlbmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgKK2ZhaWwp
IGFuZCB0aGUgYG5hbWVfdG90YWxfc2l6ZWAgY29udGFpbmluZyB0b3RhbCBzaXplIG9mIHRyYW5z
ZmVycmVkIGRhdGEgZm9yCit0aGUgYXJyYXkuIFRoZSBgc3RhdHVzYCwgYG5hbWVgLCBhbmQgYGxl
bmAgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQgaW5kZXgKIHZhbHVlIChgaWR4YCkgd2l0
aCB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4KIAogSWYgdGhlIGh5cGVyY2FsbCByZXR1cm5z
IC1YRU5fRTJCSUcgdGhlIGBucmAgaXMgdG9vIGJpZyBhbmQgc2hvdWxkIGJlCkBAIC03NzUsMTEg
Kzc3OSwxMyBAQCBUaGUgc3RydWN0dXJlIGlzIGFzIGZvbGxvdzoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudCBvZiBwYXlsb2FkcyBhbmQg
dmVyc2lvbi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIE9VVDogSG93IG1hbnkgcGF5bG9hZHMgbGVmdC4gKi8KICAgICAgICAgdWludDMyX3QgcGFk
OyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIElOOiBNdXN0IGJlIHplcm8uICovCisgICAg
ICAgIHVpbnQzMl90IG5hbWVfdG90YWxfc2l6ZTsgICAgICAgICAgICAgICAvKiBPVVQ6IFRvdGFs
IHNpemUgb2YgYWxsIHRyYW5zZmVyIG5hbWVzICovCiAgICAgICAgIFhFTl9HVUVTVF9IQU5ETEVf
NjQoeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCkgc3RhdHVzOyAgLyogT1VULiBNdXN0IGhhdmUgZW5v
dWdoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
cGFjZSBhbGxvY2F0ZSBmb3IgbnIgb2YgdGhlbS4gKi8KLSAgICAgICAgWEVOX0dVRVNUX0hBTkRM
RV82NChjaGFyKSBpZDsgICAgICAgICAgIC8qIE9VVDogQXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVt
YmVyCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBN
VVNUIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFIGluIHNpemUuCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNdXN0IGhhdmUgbnIgb2YgdGhlbS4gKi8K
KyAgICAgICAgWEVOX0dVRVNUX0hBTkRMRV82NChjaGFyKSBuYW1lOyAgICAgICAgIC8qIE9VVDog
QXJyYXkgb2YgbmFtZXMuIEVhY2ggbWVtYmVyCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBtYXkgaGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoIHVwIHRv
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYRU5f
TElWRVBBVENIX05BTUVfU0laRSBieXRlcy4gTXVzdCBoYXZlCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuciBvZiB0aGVtLiAqLwogICAgICAgICBY
RU5fR1VFU1RfSEFORExFXzY0KHVpbnQzMikgbGVuOyAgICAgICAgLyogT1VUOiBBcnJheSBvZiBs
ZW5ndGhzIG9mIG5hbWUncy4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVtLiAqLwogICAgIH07CmRpZmYgLS1naXQg
YS90b29scy9saWJ4Yy9pbmNsdWRlL3hlbmN0cmwuaCBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVu
Y3RybC5oCmluZGV4IDJmYzYyNDIyZjUuLjkzN2NiNDdjOGIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xp
YnhjL2luY2x1ZGUveGVuY3RybC5oCisrKyBiL3Rvb2xzL2xpYnhjL2luY2x1ZGUveGVuY3RybC5o
CkBAIC0yNTUxLDcgKzI1NTEsMjUgQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNl
ICp4Y2gsCiAgICAgICAgICAgICAgICAgICAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICpzdGF0
dXMpOwogCiAvKgotICogVGhlIGhlYXJ0IG9mIHRoaXMgZnVuY3Rpb24gaXMgdG8gZ2V0IGFuIGFy
cmF5IG9mIHhlbl9saXZlcGF0Y2hfc3RhdHVzX3QuCisgKiBHZXQgYSBudW1iZXIgb2YgYXZhaWxh
YmxlIHBheWxvYWRzIGFuZCBnZXQgYWN0dWFsIHRvdGFsIHNpemUgb2YKKyAqIHRoZSBwYXlsb2Fk
cycgbmFtZSBhcnJheS4KKyAqCisgKiBUaGlzIGZ1bmN0aW9ucyBpcyB0eXBpY2FsbHkgZXhlY3V0
ZWQgZmlyc3QgYmVmb3JlIHRoZSB4Y19saXZlcGF0Y2hfbGlzdCgpCisgKiB0byBvYnRhaW4gdGhl
IHNpemVzIGFuZCBjb3JyZWN0bHkgYWxsb2NhdGUgYWxsIG5lY2Vzc2FyeSBkYXRhIHJlc291cmNl
cy4KKyAqCisgKiBUaGUgcmV0dXJuIHZhbHVlIGlzIHplcm8gaWYgdGhlIGh5cGVyY2FsbCBjb21w
bGV0ZWQgc3VjY2Vzc2Z1bGx5LgorICoKKyAqIElmIHRoZXJlIHdhcyBhbiBlcnJvciBwZXJmb3Jt
aW5nIHRoZSBzeXNjdGwgb3BlcmF0aW9uLCB0aGUgcmV0dXJuIHZhbHVlCisgKiB3aWxsIGNvbnRh
aW4gdGhlIGh5cGVyY2FsbCBlcnJvciBjb2RlIHZhbHVlLgorICovCitpbnQgeGNfbGl2ZXBhdGNo
X2xpc3RfZ2V0X3NpemVzKHhjX2ludGVyZmFjZSAqeGNoLCB1bnNpZ25lZCBpbnQgKm5yLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCAqbmFtZV90b3RhbF9zaXplKTsK
KworLyoKKyAqIFRoZSBoZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIGdldCBhbiBhcnJheSBv
ZiB0aGUgZm9sbG93aW5nIG9iamVjdHM6CisgKiAgIC0geGVuX2xpdmVwYXRjaF9zdGF0dXNfdDog
c3RhdGVzIGFuZCByZXR1cm4gY29kZXMgb2YgcGF5bG9hZHMKKyAqICAgLSBuYW1lOiBuYW1lcyBv
ZiBwYXlsb2FkcworICogICAtIGxlbjogbGVuZ3RocyBvZiBjb3JyZXNwb25kaW5nIHBheWxvYWRz
JyBuYW1lcwogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBiZWNhdXNlIGl0IGhhcyB0byBk
ZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBzb21lIG9mIHRoZSByZXF1ZXN0
ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC0yNTYyLDIxICsyNTgwLDIwIEBAIGludCB4
Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFjZSAqeGNoLAogICogJ2xlZnQnIGFyZSBhbHNvIHVw
ZGF0ZWQgd2l0aCB0aGUgbnVtYmVyIG9mIGVudHJpZXMgZmlsbGVkIG91dAogICogYW5kIHJlc3Bl
Y3RpdmVseSB0aGUgbnVtYmVyIG9mIGVudHJpZXMgbGVmdCB0byBnZXQgZnJvbSBoeXBlcnZpc29y
LgogICoKLSAqIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlzIGZ1bmN0aW9u
IHdpbGwgdGFrZSB0aGUKLSAqICdsZWZ0JyBhbmQgdXNlIHRoZSB2YWx1ZSBmb3IgJ3N0YXJ0Jy4g
VGhpcyB3YXkgd2UgaGF2ZSBhbgotICogY3Vyc29yIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHRo
ZSAnaW5mbycsJ25hbWUnLCBhbmQgJ2xlbicgd2lsbAotICogYmUgdXBkYXRlZCBhdCB0aGUgc3Vi
c2VxdWVudCBjYWxscy4KKyAqIEl0IGlzIGV4cGVjdGVkIHRoYXQgdGhlIGNhbGxlciBvZiB0aGlz
IGZ1bmN0aW9uIHdpbGwgZmlyc3QgaXNzdWUgdGhlCisgKiB4Y19saXZlcGF0Y2hfbGlzdF9nZXRf
c2l6ZXMoKSBpbiBvcmRlciB0byBvYnRhaW4gdG90YWwgc2l6ZXMgb2YgbmFtZXMKKyAqIGFzIHdl
bGwgYXMgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHBheWxvYWQgZW50cmllcy4KKyAqIFRoZSB0b3Rh
bCBzaXplcyBhcmUgcmVxdWlyZWQgYW5kIHN1cHBsaWVkIHZpYSB0aGUgJ25hbWVfdG90YWxfc2l6
ZScKKyAqIHBhcmFtZXRlci4KICAqCi0gKiBUaGUgJ21heCcgaXMgdG8gYmUgcHJvdmlkZWQgYnkg
dGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtCi0gKiBudW1iZXIgb2YgZW50cmllcyB0aGF0ICdp
bmZvJywgJ25hbWUnLCBhbmQgJ2xlbicgYXJyYXlzIGNhbgotICogYmUgZmlsbGVkIHVwIHdpdGgu
Ci0gKgotICogRWFjaCBlbnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IGlzIGV4cGVjdGVkIHRvIGJl
IG9mIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFCi0gKiBsZW5ndGguCisgKiBUaGUgJ21heCcgaXMg
dG8gYmUgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciB3aXRoIHRoZSBtYXhpbXVtIG51bWJlciBvZgor
ICogZW50cmllcyB0aGF0ICdpbmZvJywgJ25hbWUnLCAnbGVuJyBhcnJheXMgY2FuIGJlIGZpbGxl
ZCB1cCB3aXRoLgogICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdpbmZvJyBhcnJheSBpcyBleHBl
Y3RlZCB0byBiZSBvZiB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190CiAgKiBzdHJ1Y3R1cmUgc2l6ZS4K
ICAqCisgKiBFYWNoIGVudHJ5IGluIHRoZSAnbmFtZScgYXJyYXkgbWF5IGhhdmUgYW4gYXJiaXRy
YXJ5IHNpemUuCisgKgogICogRWFjaCBlbnRyeSBpbiB0aGUgJ2xlbicgYXJyYXkgaXMgZXhwZWN0
ZWQgdG8gYmUgb2YgdWludDMyX3Qgc2l6ZS4KICAqCiAgKiBUaGUgcmV0dXJuIHZhbHVlIGlzIHpl
cm8gaWYgdGhlIGh5cGVyY2FsbCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LgpAQCAtMjU4OCwxMCAr
MjYwNSwxMiBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqIHdp
bGwgY29udGFpbiB0aGUgbnVtYmVyIG9mIGVudHJpZXMgdGhhdCBoYWQgYmVlbiBzdWNjZXNmdWxs
eQogICogcmV0cmlldmVkIChpZiBhbnkpLgogICovCi1pbnQgeGNfbGl2ZXBhdGNoX2xpc3QoeGNf
aW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBzdGFydCwKLSAg
ICAgICAgICAgICAgICAgICAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICppbmZvLCBjaGFyICpu
YW1lLAotICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpsZW4sIHVuc2lnbmVkIGludCAq
ZG9uZSwKLSAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmxlZnQpOworaW50IHhj
X2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25zdCB1bnNpZ25lZCBpbnQgbWF4
LAorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBzdGFydCwKKyAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9zdGF0dXMgKmluZm8sCisgICAg
ICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3QgKmxlbiwKKyAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemUsCisgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50ICpkb25lLCB1bnNpZ25lZCBpbnQgKmxlZnQpOwogCiAvKgog
ICogVGhlIG9wZXJhdGlvbnMgYXJlIGFzeW5jaHJvbm91cyBhbmQgdGhlIGh5cGVydmlzb3IgbWF5
IHRha2UgYSB3aGlsZQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGMveGNfbWlzYy5jIGIvdG9vbHMv
bGlieGMveGNfbWlzYy5jCmluZGV4IGE4ZTllN2QxZTIuLjIwZTBlNjY3M2IgMTAwNjQ0Ci0tLSBh
L3Rvb2xzL2xpYnhjL3hjX21pc2MuYworKysgYi90b29scy9saWJ4Yy94Y19taXNjLmMKQEAgLTY2
Miw3ICs2NjIsNDggQEAgaW50IHhjX2xpdmVwYXRjaF9nZXQoeGNfaW50ZXJmYWNlICp4Y2gsCiB9
CiAKIC8qCi0gKiBUaGUgaGVhcnQgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBnZXQgYW4gYXJyYXkg
b2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdC4KKyAqIEdldCBhIG51bWJlciBvZiBhdmFpbGFibGUg
cGF5bG9hZHMgYW5kIGdldCBhY3R1YWwgdG90YWwgc2l6ZSBvZgorICogdGhlIHBheWxvYWRzJyBu
YW1lIGFycmF5LgorICoKKyAqIFRoaXMgZnVuY3Rpb25zIGlzIHR5cGljYWxseSBleGVjdXRlZCBm
aXJzdCBiZWZvcmUgdGhlIHhjX2xpdmVwYXRjaF9saXN0KCkKKyAqIHRvIG9idGFpbiB0aGUgc2l6
ZXMgYW5kIGNvcnJlY3RseSBhbGxvY2F0ZSBhbGwgbmVjZXNzYXJ5IGRhdGEgcmVzb3VyY2VzLgor
ICoKKyAqIFRoZSByZXR1cm4gdmFsdWUgaXMgemVybyBpZiB0aGUgaHlwZXJjYWxsIGNvbXBsZXRl
ZCBzdWNjZXNzZnVsbHkuCisgKgorICogSWYgdGhlcmUgd2FzIGFuIGVycm9yIHBlcmZvcm1pbmcg
dGhlIHN5c2N0bCBvcGVyYXRpb24sIHRoZSByZXR1cm4gdmFsdWUKKyAqIHdpbGwgY29udGFpbiB0
aGUgaHlwZXJjYWxsIGVycm9yIGNvZGUgdmFsdWUuCisgKi8KK2ludCB4Y19saXZlcGF0Y2hfbGlz
dF9nZXRfc2l6ZXMoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCAqbnIsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90ICpuYW1lX3RvdGFsX3NpemUpCit7Cisg
ICAgREVDTEFSRV9TWVNDVEw7CisgICAgaW50IHJjOworCisgICAgaWYgKCAhbnIgfHwgIW5hbWVf
dG90YWxfc2l6ZSApCisgICAgeworICAgICAgICBlcnJubyA9IEVJTlZBTDsKKyAgICAgICAgcmV0
dXJuIC0xOworICAgIH0KKworICAgIG1lbXNldCgmc3lzY3RsLCAwLCBzaXplb2Yoc3lzY3RsKSk7
CisgICAgc3lzY3RsLmNtZCA9IFhFTl9TWVNDVExfbGl2ZXBhdGNoX29wOworICAgIHN5c2N0bC51
LmxpdmVwYXRjaC5jbWQgPSBYRU5fU1lTQ1RMX0xJVkVQQVRDSF9MSVNUOworCisgICAgcmMgPSBk
b19zeXNjdGwoeGNoLCAmc3lzY3RsKTsKKyAgICBpZiAoIHJjICkKKyAgICAgICAgcmV0dXJuIHJj
OworCisgICAgKm5yID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5ucjsKKyAgICAqbmFtZV90
b3RhbF9zaXplID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uYW1lX3RvdGFsX3NpemU7CisK
KyAgICByZXR1cm4gMDsKK30KKworLyoKKyAqIFRoZSBoZWFydCBvZiB0aGlzIGZ1bmN0aW9uIGlz
IHRvIGdldCBhbiBhcnJheSBvZiB0aGUgZm9sbG93aW5nIG9iamVjdHM6CisgKiAgIC0geGVuX2xp
dmVwYXRjaF9zdGF0dXNfdDogc3RhdGVzIGFuZCByZXR1cm4gY29kZXMgb2YgcGF5bG9hZHMKKyAq
ICAgLSBuYW1lOiBuYW1lcyBvZiBwYXlsb2FkcworICogICAtIGxlbjogbGVuZ3RocyBvZiBjb3Jy
ZXNwb25kaW5nIHBheWxvYWRzJyBuYW1lcwogICoKICAqIEhvd2V2ZXIgaXQgaXMgY29tcGxleCBi
ZWNhdXNlIGl0IGhhcyB0byBkZWFsIHdpdGggdGhlIGh5cGVydmlzb3IKICAqIHJldHVybmluZyBz
b21lIG9mIHRoZSByZXF1ZXN0ZWQgZGF0YSBvciBkYXRhIGJlaW5nIHN0YWxlCkBAIC02NzMsMjEg
KzcxNCwyMCBAQCBpbnQgeGNfbGl2ZXBhdGNoX2dldCh4Y19pbnRlcmZhY2UgKnhjaCwKICAqICds
ZWZ0JyBhcmUgYWxzbyB1cGRhdGVkIHdpdGggdGhlIG51bWJlciBvZiBlbnRyaWVzIGZpbGxlZCBv
dXQKICAqIGFuZCByZXNwZWN0aXZlbHkgdGhlIG51bWJlciBvZiBlbnRyaWVzIGxlZnQgdG8gZ2V0
IGZyb20gaHlwZXJ2aXNvci4KICAqCi0gKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZSBjYWxsZXIg
b2YgdGhpcyBmdW5jdGlvbiB3aWxsIHRha2UgdGhlCi0gKiAnbGVmdCcgYW5kIHVzZSB0aGUgdmFs
dWUgZm9yICdzdGFydCcuIFRoaXMgd2F5IHdlIGhhdmUgYW4KLSAqIGN1cnNvciBpbiB0aGUgYXJy
YXkuIE5vdGUgdGhhdCB0aGUgJ2luZm8nLCduYW1lJywgYW5kICdsZW4nIHdpbGwKLSAqIGJlIHVw
ZGF0ZWQgYXQgdGhlIHN1YnNlcXVlbnQgY2FsbHMuCisgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRo
ZSBjYWxsZXIgb2YgdGhpcyBmdW5jdGlvbiB3aWxsIGZpcnN0IGlzc3VlIHRoZQorICogeGNfbGl2
ZXBhdGNoX2xpc3RfZ2V0X3NpemVzKCkgaW4gb3JkZXIgdG8gb2J0YWluIHRvdGFsIHNpemVzIG9m
IG5hbWVzCisgKiBhcyB3ZWxsIGFzIHRoZSBjdXJyZW50IG51bWJlciBvZiBwYXlsb2FkIGVudHJp
ZXMuCisgKiBUaGUgdG90YWwgc2l6ZXMgYXJlIHJlcXVpcmVkIGFuZCBzdXBwbGllZCB2aWEgdGhl
ICduYW1lX3RvdGFsX3NpemUnCisgKiBwYXJhbWV0ZXIuCiAgKgotICogVGhlICdtYXgnIGlzIHRv
IGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4aW11bQotICogbnVtYmVyIG9m
IGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgYW5kICdsZW4nIGFycmF5cyBjYW4KLSAqIGJl
IGZpbGxlZCB1cCB3aXRoLgotICoKLSAqIEVhY2ggZW50cnkgaW4gdGhlICduYW1lJyBhcnJheSBp
cyBleHBlY3RlZCB0byBiZSBvZiBYRU5fTElWRVBBVENIX05BTUVfU0laRQotICogbGVuZ3RoLgor
ICogVGhlICdtYXgnIGlzIHRvIGJlIHByb3ZpZGVkIGJ5IHRoZSBjYWxsZXIgd2l0aCB0aGUgbWF4
aW11bSBudW1iZXIgb2YKKyAqIGVudHJpZXMgdGhhdCAnaW5mbycsICduYW1lJywgJ2xlbicgYXJy
YXlzIGNhbiBiZSBmaWxsZWQgdXAgd2l0aC4KICAqCiAgKiBFYWNoIGVudHJ5IGluIHRoZSAnaW5m
bycgYXJyYXkgaXMgZXhwZWN0ZWQgdG8gYmUgb2YgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdAogICog
c3RydWN0dXJlIHNpemUuCiAgKgorICogRWFjaCBlbnRyeSBpbiB0aGUgJ25hbWUnIGFycmF5IG1h
eSBoYXZlIGFuIGFyYml0cmFyeSBzaXplLgorICoKICAqIEVhY2ggZW50cnkgaW4gdGhlICdsZW4n
IGFycmF5IGlzIGV4cGVjdGVkIHRvIGJlIG9mIHVpbnQzMl90IHNpemUuCiAgKgogICogVGhlIHJl
dHVybiB2YWx1ZSBpcyB6ZXJvIGlmIHRoZSBoeXBlcmNhbGwgY29tcGxldGVkIHN1Y2Nlc3NmdWxs
eS4KQEAgLTY5OSwxMSArNzM5LDEyIEBAIGludCB4Y19saXZlcGF0Y2hfZ2V0KHhjX2ludGVyZmFj
ZSAqeGNoLAogICogd2lsbCBjb250YWluIHRoZSBudW1iZXIgb2YgZW50cmllcyB0aGF0IGhhZCBi
ZWVuIHN1Y2Nlc2Z1bGx5CiAgKiByZXRyaWV2ZWQgKGlmIGFueSkuCiAgKi8KLWludCB4Y19saXZl
cGF0Y2hfbGlzdCh4Y19pbnRlcmZhY2UgKnhjaCwgdW5zaWduZWQgaW50IG1heCwgdW5zaWduZWQg
aW50IHN0YXJ0LAoraW50IHhjX2xpdmVwYXRjaF9saXN0KHhjX2ludGVyZmFjZSAqeGNoLCBjb25z
dCB1bnNpZ25lZCBpbnQgbWF4LAorICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuc2lnbmVk
IGludCBzdGFydCwKICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgeGVuX2xpdmVwYXRjaF9z
dGF0dXMgKmluZm8sCiAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbmFtZSwgdWludDMyX3Qg
KmxlbiwKLSAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgKmRvbmUsCi0gICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpsZWZ0KQorICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IHVpbnQzMl90IG5hbWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICB1
bnNpZ25lZCBpbnQgKmRvbmUsIHVuc2lnbmVkIGludCAqbGVmdCkKIHsKICAgICBpbnQgcmM7CiAg
ICAgREVDTEFSRV9TWVNDVEw7CkBAIC03MTQsMjcgKzc1NSwzMyBAQCBpbnQgeGNfbGl2ZXBhdGNo
X2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBz
dGFydCwKICAgICB1aW50MzJfdCBtYXhfYmF0Y2hfc3osIG5yOwogICAgIHVpbnQzMl90IHZlcnNp
b24gPSAwLCByZXRyaWVzID0gMDsKICAgICB1aW50MzJfdCBhZGp1c3QgPSAwOwotICAgIHNzaXpl
X3Qgc3o7CisgICAgdWludDMyX3QgbmFtZV9vZmYgPSAwOworICAgIHVpbnQzMl90IG5hbWVfc3o7
CiAKLSAgICBpZiAoICFtYXggfHwgIWluZm8gfHwgIW5hbWUgfHwgIWxlbiApCisgICAgaWYgKCAh
bWF4IHx8ICFpbmZvIHx8ICFuYW1lIHx8ICFsZW4gfHwgIWRvbmUgfHwgIWxlZnQgKQogICAgIHsK
ICAgICAgICAgZXJybm8gPSBFSU5WQUw7CiAgICAgICAgIHJldHVybiAtMTsKICAgICB9CiAKKyAg
ICBpZiAoIG5hbWVfdG90YWxfc2l6ZSA9PSAwICkKKyAgICB7CisgICAgICAgIGVycm5vID0gRU5P
RU5UOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgbWVtc2V0KCZzeXNjdGwsIDAs
IHNpemVvZihzeXNjdGwpKTsKICAgICBzeXNjdGwuY21kID0gWEVOX1NZU0NUTF9saXZlcGF0Y2hf
b3A7CiAgICAgc3lzY3RsLnUubGl2ZXBhdGNoLmNtZCA9IFhFTl9TWVNDVExfTElWRVBBVENIX0xJ
U1Q7Ci0gICAgc3lzY3RsLnUubGl2ZXBhdGNoLnBhZCA9IDA7Ci0gICAgc3lzY3RsLnUubGl2ZXBh
dGNoLnUubGlzdC52ZXJzaW9uID0gMDsKICAgICBzeXNjdGwudS5saXZlcGF0Y2gudS5saXN0Lmlk
eCA9IHN0YXJ0OwotICAgIHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QucGFkID0gMDsKIAogICAg
IG1heF9iYXRjaF9zeiA9IG1heDsKLSAgICAvKiBDb252aWVuY2UgdmFsdWUuICovCi0gICAgc3og
PSBzaXplb2YoKm5hbWUpICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkU7CisgICAgbmFtZV9zeiA9
IG5hbWVfdG90YWxfc2l6ZTsKICAgICAqZG9uZSA9IDA7CiAgICAgKmxlZnQgPSAwOwogICAgIGRv
IHsKKyAgICAgICAgdWludDMyX3QgX25hbWVfc3o7CisKICAgICAgICAgLyoKICAgICAgICAgICog
VGhlIGZpcnN0IHRpbWUgd2UgZ28gaW4gdGhpcyBsb29wIG91ciAnbWF4JyBtYXkgYmUgYmlnZ2Vy
CiAgICAgICAgICAqIHRoYW4gd2hhdCB0aGUgaHlwZXJ2aXNvciBpcyBjb21mb3J0YWJsZSB3aXRo
IC0gaGVuY2UgdGhlIGZpcnN0CkBAIC03NTQsMTEgKzgwMSwxMSBAQCBpbnQgeGNfbGl2ZXBhdGNo
X2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVkIGludCBz
dGFydCwKICAgICAgICAgc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5uciA9IG5yOwogICAgICAg
ICAvKiBGaXggdGhlIHNpemUgKG1heSB2YXJ5IGJldHdlZW4gaHlwZXJjYWxscykuICovCiAgICAg
ICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUoaW5mbywgbnIgKiBzaXplb2YoKmluZm8pKTsK
LSAgICAgICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBuciAqIG5yKTsKKyAgICAg
ICAgSFlQRVJDQUxMX0JPVU5DRV9TRVRfU0laRShuYW1lLCBuYW1lX3N6KTsKICAgICAgICAgSFlQ
RVJDQUxMX0JPVU5DRV9TRVRfU0laRShsZW4sIG5yICogc2l6ZW9mKCpsZW4pKTsKICAgICAgICAg
LyogTW92ZSB0aGUgcG9pbnRlciB0byBwcm9wZXIgb2Zmc2V0IGludG8gJ2luZm8nLiAqLwogICAg
ICAgICAoSFlQRVJDQUxMX0JVRkZFUihpbmZvKSktPnVidWYgPSBpbmZvICsgKmRvbmU7Ci0gICAg
ICAgIChIWVBFUkNBTExfQlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyAoc3ogKiAqZG9uZSk7
CisgICAgICAgIChIWVBFUkNBTExfQlVGRkVSKG5hbWUpKS0+dWJ1ZiA9IG5hbWUgKyBuYW1lX29m
ZjsKICAgICAgICAgKEhZUEVSQ0FMTF9CVUZGRVIobGVuKSktPnVidWYgPSBsZW4gKyAqZG9uZTsK
ICAgICAgICAgLyogQWxsb2NhdGUgbWVtb3J5LiAqLwogICAgICAgICByYyA9IHhjX2h5cGVyY2Fs
bF9ib3VuY2VfcHJlKHhjaCwgaW5mbyk7CkBAIC04MjcsMTQgKzg3NCwxOSBAQCBpbnQgeGNfbGl2
ZXBhdGNoX2xpc3QoeGNfaW50ZXJmYWNlICp4Y2gsIHVuc2lnbmVkIGludCBtYXgsIHVuc2lnbmVk
IGludCBzdGFydCwKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAgICAgICAgICpsZWZ0
ID0gc3lzY3RsLnUubGl2ZXBhdGNoLnUubGlzdC5ucjsgLyogVG90YWwgcmVtYWluaW5nIGNvdW50
LiAqLworICAgICAgICBfbmFtZV9zeiA9IHN5c2N0bC51LmxpdmVwYXRjaC51Lmxpc3QubmFtZV90
b3RhbF9zaXplOyAvKiBUb3RhbCByZWNlaXZlZCBuYW1lIHNpemUuICovCiAgICAgICAgIC8qIENv
cHkgb25seSB1cCAncmMnIG9mIGRhdGEnIC0gd2UgY291bGQgYWRkICdtaW4ocmMsbnIpIGlmIGRl
c2lyZWQuICovCiAgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUoaW5mbywgKHJjICog
c2l6ZW9mKCppbmZvKSkpOwotICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKG5hbWUs
IChyYyAqIHN6KSk7CisgICAgICAgIEhZUEVSQ0FMTF9CT1VOQ0VfU0VUX1NJWkUobmFtZSwgX25h
bWVfc3opOwogICAgICAgICBIWVBFUkNBTExfQk9VTkNFX1NFVF9TSVpFKGxlbiwgKHJjICogc2l6
ZW9mKCpsZW4pKSk7CiAgICAgICAgIC8qIEJvdW5jZSB0aGUgZGF0YSBhbmQgZnJlZSB0aGUgYm91
bmNlIGJ1ZmZlci4gKi8KICAgICAgICAgeGNfaHlwZXJjYWxsX2JvdW5jZV9wb3N0KHhjaCwgaW5m
byk7CiAgICAgICAgIHhjX2h5cGVyY2FsbF9ib3VuY2VfcG9zdCh4Y2gsIG5hbWUpOwogICAgICAg
ICB4Y19oeXBlcmNhbGxfYm91bmNlX3Bvc3QoeGNoLCBsZW4pOworCisgICAgICAgIG5hbWVfc3og
LT0gX25hbWVfc3o7CisgICAgICAgIG5hbWVfb2ZmICs9IF9uYW1lX3N6OworCiAgICAgICAgIC8q
IEFuZCB1cGRhdGUgaG93IG1hbnkgZWxlbWVudHMgb2YgaW5mbyB3ZSBoYXZlIGNvcGllZCBpbnRv
LiAqLwogICAgICAgICAqZG9uZSArPSByYzsKICAgICAgICAgLyogVXBkYXRlIGlkeC4gKi8KZGlm
ZiAtLWdpdCBhL3Rvb2xzL21pc2MveGVuLWxpdmVwYXRjaC5jIGIvdG9vbHMvbWlzYy94ZW4tbGl2
ZXBhdGNoLmMKaW5kZXggMGVlZTk0ZmQ5MS4uNzdjMDRkMjNjMSAxMDA2NDQKLS0tIGEvdG9vbHMv
bWlzYy94ZW4tbGl2ZXBhdGNoLmMKKysrIGIvdG9vbHMvbWlzYy94ZW4tbGl2ZXBhdGNoLmMKQEAg
LTY0LDE0ICs2NCwxMyBAQCBzdGF0aWMgY29uc3QgY2hhciAqc3RhdGUyc3RyKHVuc2lnbmVkIGlu
dCBzdGF0ZSkKICAgICByZXR1cm4gbmFtZXNbc3RhdGVdOwogfQogCi0vKiBUaGlzIHZhbHVlIHdh
cyBjaG9vc2VuIGFkaG9jLiBJdCBjb3VsZCBiZSA0MiB0b28uICovCi0jZGVmaW5lIE1BWF9MRU4g
MTEKIHN0YXRpYyBpbnQgbGlzdF9mdW5jKGludCBhcmdjLCBjaGFyICphcmd2W10pCiB7Ci0gICAg
dW5zaWduZWQgaW50IGlkeCwgZG9uZSwgbGVmdCwgaTsKKyAgICB1bnNpZ25lZCBpbnQgbnIsIGRv
bmUsIGxlZnQsIGk7CiAgICAgeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCAqaW5mbyA9IE5VTEw7CiAg
ICAgY2hhciAqbmFtZSA9IE5VTEw7CiAgICAgdWludDMyX3QgKmxlbiA9IE5VTEw7CisgICAgdWlu
dDMyX3QgbmFtZV90b3RhbF9zaXplLCBuYW1lX29mZjsKICAgICBpbnQgcmMgPSBFTk9NRU07CiAK
ICAgICBpZiAoIGFyZ2MgKQpAQCAtNzksNjUgKzc4LDczIEBAIHN0YXRpYyBpbnQgbGlzdF9mdW5j
KGludCBhcmdjLCBjaGFyICphcmd2W10pCiAgICAgICAgIHNob3dfaGVscCgpOwogICAgICAgICBy
ZXR1cm4gLTE7CiAgICAgfQotICAgIGlkeCA9IGxlZnQgPSAwOwotICAgIGluZm8gPSBtYWxsb2Mo
c2l6ZW9mKCppbmZvKSAqIE1BWF9MRU4pOwotICAgIGlmICggIWluZm8gKQotICAgICAgICByZXR1
cm4gcmM7Ci0gICAgbmFtZSA9IG1hbGxvYyhzaXplb2YoKm5hbWUpICogWEVOX0xJVkVQQVRDSF9O
QU1FX1NJWkUgKiBNQVhfTEVOKTsKLSAgICBpZiAoICFuYW1lICkKKyAgICBkb25lID0gbGVmdCA9
IDA7CisKKyAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0X2dldF9zaXplcyh4Y2gsICZuciwgJm5h
bWVfdG90YWxfc2l6ZSk7CisgICAgaWYgKCByYyApCiAgICAgewotICAgICAgICBmcmVlKGluZm8p
OworICAgICAgICByYyA9IGVycm5vOworICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIkZhaWxlZCB0
byBnZXQgbGlzdCBzaXplcy5cbiIKKyAgICAgICAgICAgICAgICAiRXJyb3IgJWQ6ICVzXG4iLAor
ICAgICAgICAgICAgICAgIHJjLCBzdHJlcnJvcihyYykpOwogICAgICAgICByZXR1cm4gcmM7CiAg
ICAgfQotICAgIGxlbiA9IG1hbGxvYyhzaXplb2YoKmxlbikgKiBNQVhfTEVOKTsKLSAgICBpZiAo
ICFsZW4gKSB7Ci0gICAgICAgIGZyZWUobmFtZSk7Ci0gICAgICAgIGZyZWUoaW5mbyk7CisKKyAg
ICBpZiAoIG5yID09IDAgKQorICAgIHsKKyAgICAgICAgZnByaW50ZihzdGRvdXQsICJOb3RoaW5n
IHRvIGxpc3RcbiIpOworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisKKyAgICBpbmZvID0gbWFs
bG9jKG5yICogc2l6ZW9mKCppbmZvKSk7CisgICAgaWYgKCAhaW5mbyApCiAgICAgICAgIHJldHVy
biByYzsKKworICAgIG5hbWUgPSBtYWxsb2MobmFtZV90b3RhbF9zaXplICogc2l6ZW9mKCpuYW1l
KSk7CisgICAgaWYgKCAhbmFtZSApCisgICAgICAgIGdvdG8gZXJyb3JfbmFtZTsKKworICAgIGxl
biA9IG1hbGxvYyhuciAqIHNpemVvZigqbGVuKSk7CisgICAgaWYgKCAhbGVuICkKKyAgICAgICAg
Z290byBlcnJvcl9sZW47CisKKyAgICBtZW1zZXQoaW5mbywgJ0EnLCBuciAqIHNpemVvZigqaW5m
bykpOworICAgIG1lbXNldChuYW1lLCAnQicsIG5hbWVfdG90YWxfc2l6ZSAqIHNpemVvZigqbmFt
ZSkpOworICAgIG1lbXNldChsZW4sICdDJywgbnIgKiBzaXplb2YoKmxlbikpOworICAgIG5hbWVf
b2ZmID0gMDsKKworICAgIHJjID0geGNfbGl2ZXBhdGNoX2xpc3QoeGNoLCBuciwgMCwgaW5mbywg
bmFtZSwgbGVuLCBuYW1lX3RvdGFsX3NpemUsICZkb25lLCAmbGVmdCk7CisgICAgaWYgKCByYyB8
fCBkb25lICE9IG5yIHx8IGxlZnQgPiAwKQorICAgIHsKKyAgICAgICAgcmMgPSBlcnJubzsKKyAg
ICAgICAgZnByaW50ZihzdGRlcnIsICJGYWlsZWQgdG8gbGlzdCAlZC8lZC5cbiIKKyAgICAgICAg
ICAgICAgICAiRXJyb3IgJWQ6ICVzXG4iLAorICAgICAgICAgICAgICAgIGxlZnQsIG5yLCByYywg
c3RyZXJyb3IocmMpKTsKKyAgICAgICAgZ290byBlcnJvcjsKICAgICB9CiAKLSAgICBkbyB7Ci0g
ICAgICAgIGRvbmUgPSAwOwotICAgICAgICAvKiBUaGUgbWVtc2V0IGlzIGRvbmUgdG8gY2F0Y2gg
ZXJyb3JzLiAqLwotICAgICAgICBtZW1zZXQoaW5mbywgJ0EnLCBzaXplb2YoKmluZm8pICogTUFY
X0xFTik7Ci0gICAgICAgIG1lbXNldChuYW1lLCAnQicsIHNpemVvZigqbmFtZSkgKiBNQVhfTEVO
ICogWEVOX0xJVkVQQVRDSF9OQU1FX1NJWkUpOwotICAgICAgICBtZW1zZXQobGVuLCAnQycsIHNp
emVvZigqbGVuKSAqIE1BWF9MRU4pOwotICAgICAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0KHhj
aCwgTUFYX0xFTiwgaWR4LCBpbmZvLCBuYW1lLCBsZW4sICZkb25lLCAmbGVmdCk7Ci0gICAgICAg
IGlmICggcmMgKQotICAgICAgICB7Ci0gICAgICAgICAgICByYyA9IGVycm5vOwotICAgICAgICAg
ICAgZnByaW50ZihzdGRlcnIsICJGYWlsZWQgdG8gbGlzdCAlZC8lZC5cbiIKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAiRXJyb3IgJWQ6ICVzXG4iLAotICAgICAgICAgICAgICAgICAgICBp
ZHgsIGxlZnQsIHJjLCBzdHJlcnJvcihyYykpOwotICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAg
IH0KLSAgICAgICAgaWYgKCAhaWR4ICkKLSAgICAgICAgICAgIGZwcmludGYoc3Rkb3V0LCIgSUQg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBzdGF0dXNcbiIKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tKy0tLS0tLS0tLS0tLVxuIik7CisgICAgZnByaW50ZihzdGRvdXQsIiBJRCAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB8IHN0YXR1c1xuIgorICAgICAgICAgICAgICAgICAg
ICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLVxu
Iik7CiAKLSAgICAgICAgZm9yICggaSA9IDA7IGkgPCBkb25lOyBpKysgKQotICAgICAgICB7Ci0g
ICAgICAgICAgICB1bnNpZ25lZCBpbnQgajsKLSAgICAgICAgICAgIHVpbnQzMl90IHN6OwotICAg
ICAgICAgICAgY2hhciAqc3RyOwotCi0gICAgICAgICAgICBzeiA9IGxlbltpXTsKLSAgICAgICAg
ICAgIHN0ciA9IG5hbWUgKyAoaSAqIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFKTsKLSAgICAgICAg
ICAgIGZvciAoIGogPSBzejsgaiA8IFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFOyBqKysgKQotICAg
ICAgICAgICAgICAgIHN0cltqXSA9ICdcMCc7Ci0KLSAgICAgICAgICAgIHByaW50ZigiJS00MHN8
ICVzIiwgc3RyLCBzdGF0ZTJzdHIoaW5mb1tpXS5zdGF0ZSkpOwotICAgICAgICAgICAgaWYgKCBp
bmZvW2ldLnJjICkKLSAgICAgICAgICAgICAgICBwcmludGYoIiAoJWQsICVzKVxuIiwgLWluZm9b
aV0ucmMsIHN0cmVycm9yKC1pbmZvW2ldLnJjKSk7Ci0gICAgICAgICAgICBlbHNlCi0gICAgICAg
ICAgICAgICAgcHV0cygiIik7Ci0gICAgICAgIH0KLSAgICAgICAgaWR4ICs9IGRvbmU7Ci0gICAg
fSB3aGlsZSAoIGxlZnQgKTsKKyAgICBmb3IgKCBpID0gMDsgaSA8IGRvbmU7IGkrKyApCisgICAg
eworICAgICAgICBjaGFyICpuYW1lX3N0ciA9IG5hbWUgKyBuYW1lX29mZjsKKworICAgICAgICBw
cmludGYoIiUtNDAuKnN8ICVzIiwgbGVuW2ldLCBuYW1lX3N0ciwgc3RhdGUyc3RyKGluZm9baV0u
c3RhdGUpKTsKKyAgICAgICAgaWYgKCBpbmZvW2ldLnJjICkKKyAgICAgICAgICAgIHByaW50Zigi
ICglZCwgJXMpXG4iLCAtaW5mb1tpXS5yYywgc3RyZXJyb3IoLWluZm9baV0ucmMpKTsKKyAgICAg
ICAgZWxzZQorICAgICAgICAgICAgcHV0cygiIik7CisKKyAgICAgICAgbmFtZV9vZmYgKz0gbGVu
W2ldOworICAgIH0KIAorZXJyb3I6CisgICAgZnJlZShsZW4pOworZXJyb3JfbGVuOgogICAgIGZy
ZWUobmFtZSk7CitlcnJvcl9uYW1lOgogICAgIGZyZWUoaW5mbyk7Ci0gICAgZnJlZShsZW4pOwog
ICAgIHJldHVybiByYzsKIH0KICN1bmRlZiBNQVhfTEVOCmRpZmYgLS1naXQgYS94ZW4vY29tbW9u
L2xpdmVwYXRjaC5jIGIveGVuL2NvbW1vbi9saXZlcGF0Y2guYwppbmRleCA0NjY4NWYzYWE4Li4z
YzE5MWViODg5IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCisrKyBiL3hlbi9j
b21tb24vbGl2ZXBhdGNoLmMKQEAgLTExNjQsNyArMTE2NCw2IEBAIHN0YXRpYyBpbnQgbGl2ZXBh
dGNoX2xpc3Qoc3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAKICAgICBp
ZiAoIGxpc3QtPm5yICYmCiAgICAgICAgICAoIWd1ZXN0X2hhbmRsZV9va2F5KGxpc3QtPnN0YXR1
cywgbGlzdC0+bnIpIHx8Ci0gICAgICAgICAgIWd1ZXN0X2hhbmRsZV9va2F5KGxpc3QtPm5hbWUs
IFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFICogbGlzdC0+bnIpIHx8CiAgICAgICAgICAgIWd1ZXN0
X2hhbmRsZV9va2F5KGxpc3QtPmxlbiwgbGlzdC0+bnIpKSApCiAgICAgICAgIHJldHVybiAtRUlO
VkFMOwogCkBAIC0xMTc1LDIzICsxMTc0LDM1IEBAIHN0YXRpYyBpbnQgbGl2ZXBhdGNoX2xpc3Qo
c3RydWN0IHhlbl9zeXNjdGxfbGl2ZXBhdGNoX2xpc3QgKmxpc3QpCiAgICAgICAgIHJldHVybiAt
RUlOVkFMOwogICAgIH0KIAorICAgIGxpc3QtPm5hbWVfdG90YWxfc2l6ZSA9IDA7CiAgICAgaWYg
KCBsaXN0LT5uciApCiAgICAgeworICAgICAgICB1aW50NjRfdCBuYW1lX29mZnNldCA9IDA7CisK
ICAgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeSggZGF0YSwgJnBheWxvYWRfbGlzdCwgbGlzdCAp
CiAgICAgICAgIHsKLSAgICAgICAgICAgIHVpbnQzMl90IGxlbjsKKyAgICAgICAgICAgIHVpbnQz
Ml90IG5hbWVfbGVuOwogCiAgICAgICAgICAgICBpZiAoIGxpc3QtPmlkeCA+IGkrKyApCiAgICAg
ICAgICAgICAgICAgY29udGludWU7CiAKICAgICAgICAgICAgIHN0YXR1cy5zdGF0ZSA9IGRhdGEt
PnN0YXRlOwogICAgICAgICAgICAgc3RhdHVzLnJjID0gZGF0YS0+cmM7Ci0gICAgICAgICAgICBs
ZW4gPSBzdHJsZW4oZGF0YS0+bmFtZSkgKyAxOworCisgICAgICAgICAgICBuYW1lX2xlbiA9IHN0
cmxlbihkYXRhLT5uYW1lKSArIDE7CisgICAgICAgICAgICBsaXN0LT5uYW1lX3RvdGFsX3NpemUg
Kz0gbmFtZV9sZW47CisKKyAgICAgICAgICAgIGlmICggIWd1ZXN0X2hhbmRsZV9zdWJyYW5nZV9v
a2F5KGxpc3QtPm5hbWUsIG5hbWVfb2Zmc2V0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbmFtZV9vZmZzZXQgKyBuYW1lX2xlbiAtIDEpICkKKyAgICAgICAg
ICAgIHsKKyAgICAgICAgICAgICAgICByYyA9IC1FSU5WQUw7CisgICAgICAgICAgICAgICAgYnJl
YWs7CisgICAgICAgICAgICB9CiAKICAgICAgICAgICAgIC8qIE4uQi4gJ2lkeCcgIT0gJ2knLiAq
LwotICAgICAgICAgICAgaWYgKCBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm5hbWUsIGlk
eCAqIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGRhdGEtPm5hbWUsIGxlbikgfHwKLSAgICAgICAgICAgICAgICBfX2NvcHlf
dG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPmxlbiwgaWR4LCAmbGVuLCAxKSB8fAorICAgICAgICAgICAg
aWYgKCBfX2NvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KGxpc3QtPm5hbWUsIG5hbWVfb2Zmc2V0LAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtPm5hbWUsIG5hbWVfbGVu
KSB8fAorICAgICAgICAgICAgICAgIF9fY29weV90b19ndWVzdF9vZmZzZXQobGlzdC0+bGVuLCBp
ZHgsICZuYW1lX2xlbiwgMSkgfHwKICAgICAgICAgICAgICAgICBfX2NvcHlfdG9fZ3Vlc3Rfb2Zm
c2V0KGxpc3QtPnN0YXR1cywgaWR4LCAmc3RhdHVzLCAxKSApCiAgICAgICAgICAgICB7CiAgICAg
ICAgICAgICAgICAgcmMgPSAtRUZBVUxUOwpAQCAtMTE5OSwxMSArMTIxMCwxOSBAQCBzdGF0aWMg
aW50IGxpdmVwYXRjaF9saXN0KHN0cnVjdCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9saXN0ICpsaXN0
KQogICAgICAgICAgICAgfQogCiAgICAgICAgICAgICBpZHgrKzsKKyAgICAgICAgICAgIG5hbWVf
b2Zmc2V0ICs9IG5hbWVfbGVuOwogCiAgICAgICAgICAgICBpZiAoIChpZHggPj0gbGlzdC0+bnIp
IHx8IGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQogICAgICAgICAgICAgICAgIGJyZWFrOwog
ICAgICAgICB9CiAgICAgfQorICAgIGVsc2UKKyAgICB7CisgICAgICAgIGxpc3RfZm9yX2VhY2hf
ZW50cnkoIGRhdGEsICZwYXlsb2FkX2xpc3QsIGxpc3QgKQorICAgICAgICB7CisgICAgICAgICAg
ICBsaXN0LT5uYW1lX3RvdGFsX3NpemUgKz0gc3RybGVuKGRhdGEtPm5hbWUpICsgMTsKKyAgICAg
ICAgfQorICAgIH0KICAgICBsaXN0LT5uciA9IHBheWxvYWRfY250IC0gaTsgLyogUmVtYWluaW5n
IGFtb3VudC4gKi8KICAgICBsaXN0LT52ZXJzaW9uID0gcGF5bG9hZF92ZXJzaW9uOwogICAgIHNw
aW5fdW5sb2NrKCZwYXlsb2FkX2xvY2spOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvcHVibGlj
L3N5c2N0bC5oIGIveGVuL2luY2x1ZGUvcHVibGljL3N5c2N0bC5oCmluZGV4IGJjZGZjMWZhZmUu
LjA4ODA3YzkyYTUgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaAorKysg
Yi94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmgKQEAgLTkyNSwxMCArOTI1LDExIEBAIHN0cnVj
dCB4ZW5fc3lzY3RsX2xpdmVwYXRjaF9nZXQgewogICoKICAqIElmIHRoZSBoeXBlcmNhbGwgcmV0
dXJucyBhbiBwb3NpdGl2ZSBudW1iZXIsIGl0IGlzIHRoZSBudW1iZXIgKHVwIHRvIGBucmApCiAg
KiBvZiB0aGUgcGF5bG9hZHMgcmV0dXJuZWQsIGFsb25nIHdpdGggYG5yYCB1cGRhdGVkIHdpdGgg
dGhlIG51bWJlciBvZiByZW1haW5pbmcKLSAqIHBheWxvYWRzLCBgdmVyc2lvbmAgdXBkYXRlZCAo
aXQgbWF5IGJlIHRoZSBzYW1lIGFjcm9zcyBoeXBlcmNhbGxzLiBJZiBpdAotICogdmFyaWVzIHRo
ZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0aGVyIGNhbGxzIGNvdWxkIGZhaWwpLiBUaGUgYHN0YXR1
c2AsCi0gKiBgbmFtZWAsIGFuZCBgbGVuYCcgYXJlIHVwZGF0ZWQgYXQgdGhlaXIgZGVzaWduZWQg
aW5kZXggdmFsdWUgKGBpZHhgKSB3aXRoCi0gKiB0aGUgcmV0dXJuZWQgdmFsdWUgb2YgZGF0YS4K
KyAqIHBheWxvYWRzLCBgdmVyc2lvbmAgdXBkYXRlZCAoaXQgbWF5IGJlIHRoZSBzYW1lIGFjcm9z
cyBoeXBlcmNhbGxzLiBJZiBpdCB2YXJpZXMKKyAqIHRoZSBkYXRhIGlzIHN0YWxlIGFuZCBmdXJ0
aGVyIGNhbGxzIGNvdWxkIGZhaWwpIGFuZCB0aGUgbmFtZV90b3RhbF9zaXplCisgKiBjb250YWlu
aW5nIHRvdGFsIHNpemUgb2YgdHJhbnNmZXJyZWQgZGF0YSBmb3IgdGhlIGFycmF5LgorICogVGhl
IGBzdGF0dXNgLCBgbmFtZWAsIGBsZW5gIGFyZSB1cGRhdGVkIGF0IHRoZWlyIGRlc2lnbmVkIGlu
ZGV4IHZhbHVlIChgaWR4YCkKKyAqIHdpdGggdGhlIHJldHVybmVkIHZhbHVlIG9mIGRhdGEuCiAg
KgogICogSWYgdGhlIGh5cGVyY2FsbCByZXR1cm5zIEUyQklHIHRoZSBgbnJgIGlzIHRvbyBiaWcg
YW5kIHNob3VsZCBiZQogICogbG93ZXJlZC4gVGhlIHVwcGVyIGxpbWl0IG9mIGBucmAgaXMgbGVm
dCB0byB0aGUgaW1wbGVtZW50aW9uLgpAQCAtOTUxLDExICs5NTIsMTMgQEAgc3RydWN0IHhlbl9z
eXNjdGxfbGl2ZXBhdGNoX2xpc3QgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBhbW91bnQgb2YgcGF5bG9hZHMgYW5kIHZlcnNpb24uCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9VVDogSG93IG1hbnkgcGF5bG9h
ZHMgbGVmdC4gKi8KICAgICB1aW50MzJfdCBwYWQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
LyogSU46IE11c3QgYmUgemVyby4gKi8KKyAgICB1aW50MzJfdCBuYW1lX3RvdGFsX3NpemU7ICAg
ICAgICAgICAgICAgLyogT1VUOiBUb3RhbCBzaXplIG9mIGFsbCB0cmFuc2ZlciBuYW1lcyAqLwog
ICAgIFhFTl9HVUVTVF9IQU5ETEVfNjQoeGVuX2xpdmVwYXRjaF9zdGF0dXNfdCkgc3RhdHVzOyAg
LyogT1VULiBNdXN0IGhhdmUgZW5vdWdoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHNwYWNlIGFsbG9jYXRlIGZvciBuciBvZiB0aGVtLiAqLwogICAgIFhF
Tl9HVUVTVF9IQU5ETEVfNjQoY2hhcikgbmFtZTsgICAgICAgICAvKiBPVVQ6IEFycmF5IG9mIG5h
bWVzLiBFYWNoIG1lbWJlcgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBNVVNUIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFIGluIHNpemUuCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE11c3QgaGF2ZSBuciBvZiB0aGVt
LiAqLworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXkg
aGF2ZSBhbiBhcmJpdHJhcnkgbGVuZ3RoIHVwIHRvCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFhFTl9MSVZFUEFUQ0hfTkFNRV9TSVpFIGJ5dGVzLiBNdXN0
IGhhdmUKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnIg
b2YgdGhlbS4gKi8KICAgICBYRU5fR1VFU1RfSEFORExFXzY0KHVpbnQzMikgbGVuOyAgICAgICAg
LyogT1VUOiBBcnJheSBvZiBsZW5ndGhzIG9mIG5hbWUncy4KICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgTXVzdCBoYXZlIG5yIG9mIHRoZW0uICovCiB9Owot
LSAKMi4xNi41CgoKCgpBbWF6b24gRGV2ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkgR21iSApLcmF1
c2Vuc3RyLiAzOAoxMDExNyBCZXJsaW4KR2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJpc3RpYW4gU2No
bGFlZ2VyLCBSYWxmIEhlcmJyaWNoCkVpbmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0
ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMgQgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3
IDg3OQoKCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
WGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0
cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

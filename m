Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 0A20616EEE2
	for <lists+xen-devel@lfdr.de>; Tue, 25 Feb 2020 20:21:45 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j6fim-00078Q-Bz; Tue, 25 Feb 2020 19:18:20 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=nw84=4N=intel.com=tamas.lengyel@srs-us1.protection.inumbo.net>)
 id 1j6fik-000785-Eo
 for xen-devel@lists.xenproject.org; Tue, 25 Feb 2020 19:18:18 +0000
X-Inumbo-ID: 90725402-5803-11ea-a490-bc764e2007e4
Received: from mga06.intel.com (unknown [134.134.136.31])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 90725402-5803-11ea-a490-bc764e2007e4;
 Tue, 25 Feb 2020 19:18:12 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by orsmga104.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 25 Feb 2020 11:18:11 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,485,1574150400"; d="scan'208";a="237776382"
Received: from tlengyel-mobl2.amr.corp.intel.com (HELO localhost.localdomain)
 ([10.254.187.145])
 by orsmga003.jf.intel.com with ESMTP; 25 Feb 2020 11:18:08 -0800
From: Tamas K Lengyel <tamas.lengyel@intel.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 25 Feb 2020 11:17:55 -0800
Message-Id: <8df741964b56c10ed912f9187dcb31aae7251085.1582658216.git.tamas.lengyel@intel.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <cover.1582658216.git.tamas.lengyel@intel.com>
References: <cover.1582658216.git.tamas.lengyel@intel.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v10 1/3] xen/mem_sharing: VM forking
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>,
 Tamas K Lengyel <tamas.lengyel@intel.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>,
 Tamas K Lengyel <tamas@tklengyel.com>, Jan Beulich <jbeulich@suse.com>,
 Julien Grall <julien@xen.org>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Vk0gZm9ya2luZyBpcyB0aGUgcHJvY2VzcyBvZiBjcmVhdGluZyBhIGRvbWFpbiB3aXRoIGFuIGVt
cHR5IG1lbW9yeSBzcGFjZSBhbmQgYQpwYXJlbnQgZG9tYWluIHNwZWNpZmllZCBmcm9tIHdoaWNo
IHRvIHBvcHVsYXRlIHRoZSBtZW1vcnkgd2hlbiBuZWNlc3NhcnkuIEZvcgp0aGUgbmV3IGRvbWFp
biB0byBiZSBmdW5jdGlvbmFsIHRoZSBWTSBzdGF0ZSBpcyBjb3BpZWQgb3ZlciBhcyBwYXJ0IG9m
IHRoZSBmb3JrCm9wZXJhdGlvbiAoSFZNIHBhcmFtcywgaGFwIGFsbG9jYXRpb24sIGV0YykuCgpT
aWduZWQtb2ZmLWJ5OiBUYW1hcyBLIExlbmd5ZWwgPHRhbWFzLmxlbmd5ZWxAaW50ZWwuY29tPgot
LS0KdjEwOiBzZXR1cCB2Y3B1X2luZm8gcGFnZXMgZm9yIHZDUFVzIGluIHRoZSBmb3JrIGlmIHRo
ZSBwYXJlbnQgaGFzIHRoZW0KICAgICBzZXR1cCBwYWdlcyBmb3Igc3BlY2lhbCBIVk0gUEZOcyBp
ZiB0aGUgcGFyZW50IGhhcyB0aGVtCiAgICAgbWlub3IgYWRqdXN0bWVudHMgYmFzZWQgb24gUm9n
ZXIncyBjb21tZW50cwotLS0KIHhlbi9hcmNoL3g4Ni9kb21haW4uYyAgICAgICAgICAgICB8ICAx
MSArKwogeGVuL2FyY2gveDg2L2h2bS9odm0uYyAgICAgICAgICAgIHwgICA0ICstCiB4ZW4vYXJj
aC94ODYvbW0vaGFwL2hhcC5jICAgICAgICAgfCAgIDMgKy0KIHhlbi9hcmNoL3g4Ni9tbS9tZW1f
c2hhcmluZy5jICAgICB8IDI4NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHhlbi9h
cmNoL3g4Ni9tbS9wMm0uYyAgICAgICAgICAgICB8ICAgOSArLQogeGVuL2NvbW1vbi9kb21haW4u
YyAgICAgICAgICAgICAgIHwgICAzICsKIHhlbi9pbmNsdWRlL2FzbS14ODYvaGFwLmggICAgICAg
ICB8ICAgMSArCiB4ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9odm0uaCAgICAgfCAgIDIgKwogeGVu
L2luY2x1ZGUvYXNtLXg4Ni9tZW1fc2hhcmluZy5oIHwgIDE3ICsrCiB4ZW4vaW5jbHVkZS9wdWJs
aWMvbWVtb3J5LmggICAgICAgfCAgIDUgKwogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggICAgICAg
ICAgIHwgICA1ICsKIDExIGZpbGVzIGNoYW5nZWQsIDM0MiBpbnNlcnRpb25zKCspLCA1IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYyBiL3hlbi9hcmNoL3g4
Ni9kb21haW4uYwppbmRleCBmZTYzYzIzNjc2Li4xYWIwY2EwOTQyIDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvZG9tYWluLmMKKysrIGIveGVuL2FyY2gveDg2L2RvbWFpbi5jCkBAIC0yMjAzLDYg
KzIyMDMsMTcgQEAgaW50IGRvbWFpbl9yZWxpbnF1aXNoX3Jlc291cmNlcyhzdHJ1Y3QgZG9tYWlu
ICpkKQogICAgICAgICAgICAgcmV0ID0gcmVsaW5xdWlzaF9zaGFyZWRfcGFnZXMoZCk7CiAgICAg
ICAgICAgICBpZiAoIHJldCApCiAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKKworICAgICAg
ICAgICAgLyoKKyAgICAgICAgICAgICAqIElmIHRoZSBkb21haW4gaXMgZm9ya2VkLCBkZWNyZW1l
bnQgdGhlIHBhcmVudCdzIHBhdXNlIGNvdW50CisgICAgICAgICAgICAgKiBhbmQgcmVsZWFzZSB0
aGUgZG9tYWluLgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBpZiAoIGQtPnBhcmVudCAp
CisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgZG9tYWluX3VucGF1c2UoZC0+cGFyZW50
KTsKKyAgICAgICAgICAgICAgICBwdXRfZG9tYWluKGQtPnBhcmVudCk7CisgICAgICAgICAgICAg
ICAgZC0+cGFyZW50ID0gTlVMTDsKKyAgICAgICAgICAgIH0KICAgICAgICAgfQogI2VuZGlmCiAK
ZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMgYi94ZW4vYXJjaC94ODYvaHZtL2h2
bS5jCmluZGV4IGEzMzliMzZhMGQuLmMyODRmM2NmNWYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4
Ni9odm0vaHZtLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9odm0uYwpAQCAtMTkxNSw3ICsxOTE1
LDcgQEAgaW50IGh2bV9oYXBfbmVzdGVkX3BhZ2VfZmF1bHQocGFkZHJfdCBncGEsIHVuc2lnbmVk
IGxvbmcgZ2xhLAogICAgIH0KICNlbmRpZgogCi0gICAgLyogU3B1cmlvdXMgZmF1bHQ/IFBvRCBh
bmQgbG9nLWRpcnR5IGFsc28gdGFrZSB0aGlzIHBhdGguICovCisgICAgLyogU3B1cmlvdXMgZmF1
bHQ/IFBvRCwgbG9nLWRpcnR5IGFuZCBWTSBmb3JraW5nIGFsc28gdGFrZSB0aGlzIHBhdGguICov
CiAgICAgaWYgKCBwMm1faXNfcmFtKHAybXQpICkKICAgICB7CiAgICAgICAgIHJjID0gMTsKQEAg
LTQ0MjksNyArNDQyOSw3IEBAIHN0YXRpYyBpbnQgaHZtX2FsbG93X2dldF9wYXJhbShzdHJ1Y3Qg
ZG9tYWluICpkLAogICAgIHJldHVybiByYzsKIH0KIAotc3RhdGljIGludCBodm1fZ2V0X3BhcmFt
KHN0cnVjdCBkb21haW4gKmQsIHVpbnQzMl90IGluZGV4LCB1aW50NjRfdCAqdmFsdWUpCitpbnQg
aHZtX2dldF9wYXJhbShzdHJ1Y3QgZG9tYWluICpkLCB1aW50MzJfdCBpbmRleCwgdWludDY0X3Qg
KnZhbHVlKQogewogICAgIGludCByYzsKIApkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tL2hh
cC9oYXAuYyBiL3hlbi9hcmNoL3g4Ni9tbS9oYXAvaGFwLmMKaW5kZXggM2Q5M2YzNDUxYy4uYzdj
N2ZmNmU5OSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21tL2hhcC9oYXAuYworKysgYi94ZW4v
YXJjaC94ODYvbW0vaGFwL2hhcC5jCkBAIC0zMjEsOCArMzIxLDcgQEAgc3RhdGljIHZvaWQgaGFw
X2ZyZWVfcDJtX3BhZ2Uoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHBhZ2VfaW5mbyAqcGcpCiB9
CiAKIC8qIFJldHVybiB0aGUgc2l6ZSBvZiB0aGUgcG9vbCwgcm91bmRlZCB1cCB0byB0aGUgbmVh
cmVzdCBNQiAqLwotc3RhdGljIHVuc2lnbmVkIGludAotaGFwX2dldF9hbGxvY2F0aW9uKHN0cnVj
dCBkb21haW4gKmQpCit1bnNpZ25lZCBpbnQgaGFwX2dldF9hbGxvY2F0aW9uKHN0cnVjdCBkb21h
aW4gKmQpCiB7CiAgICAgdW5zaWduZWQgaW50IHBnID0gZC0+YXJjaC5wYWdpbmcuaGFwLnRvdGFs
X3BhZ2VzCiAgICAgICAgICsgZC0+YXJjaC5wYWdpbmcuaGFwLnAybV9wYWdlczsKZGlmZiAtLWdp
dCBhL3hlbi9hcmNoL3g4Ni9tbS9tZW1fc2hhcmluZy5jIGIveGVuL2FyY2gveDg2L21tL21lbV9z
aGFyaW5nLmMKaW5kZXggMzgzNWJjOTI4Zi4uOGVlMzdlNjk0MyAxMDA2NDQKLS0tIGEveGVuL2Fy
Y2gveDg2L21tL21lbV9zaGFyaW5nLmMKKysrIGIveGVuL2FyY2gveDg2L21tL21lbV9zaGFyaW5n
LmMKQEAgLTIyLDYgKzIyLDcgQEAKIAogI2luY2x1ZGUgPHhlbi90eXBlcy5oPgogI2luY2x1ZGUg
PHhlbi9kb21haW5fcGFnZS5oPgorI2luY2x1ZGUgPHhlbi9ldmVudC5oPgogI2luY2x1ZGUgPHhl
bi9zcGlubG9jay5oPgogI2luY2x1ZGUgPHhlbi9yd2xvY2suaD4KICNpbmNsdWRlIDx4ZW4vbW0u
aD4KQEAgLTM2LDYgKzM3LDggQEAKICNpbmNsdWRlIDxhc20vYWx0cDJtLmg+CiAjaW5jbHVkZSA8
YXNtL2F0b21pYy5oPgogI2luY2x1ZGUgPGFzbS9ldmVudC5oPgorI2luY2x1ZGUgPGFzbS9oYXAu
aD4KKyNpbmNsdWRlIDxhc20vaHZtL2h2bS5oPgogI2luY2x1ZGUgPHhzbS94c20uaD4KIAogI2lu
Y2x1ZGUgIm1tLWxvY2tzLmgiCkBAIC0xNDQ0LDYgKzE0NDcsMjYzIEBAIHN0YXRpYyBpbmxpbmUg
aW50IG1lbV9zaGFyaW5nX2NvbnRyb2woc3RydWN0IGRvbWFpbiAqZCwgYm9vbCBlbmFibGUpCiAg
ICAgcmV0dXJuIDA7CiB9CiAKKy8qCisgKiBGb3JraW5nIGEgcGFnZSBvbmx5IGdldHMgY2FsbGVk
IHdoZW4gdGhlIFZNIGZhdWx0cyBkdWUgdG8gbm8gZW50cnkgYmVpbmcKKyAqIGluIHRoZSBFUFQg
Zm9yIHRoZSBhY2Nlc3MuIERlcGVuZGluZyBvbiB0aGUgdHlwZSBvZiBhY2Nlc3Mgd2UgZWl0aGVy
CisgKiBwb3B1bGF0ZSB0aGUgcGh5c21hcCB3aXRoIGEgc2hhcmVkIGVudHJ5IGZvciByZWFkLW9u
bHkgYWNjZXNzIG9yCisgKiBmb3JrIHRoZSBwYWdlIGlmIGl0cyBhIHdyaXRlIGFjY2Vzcy4KKyAq
CisgKiBUaGUgY2xpZW50IHAybSBpcyBhbHJlYWR5IGxvY2tlZCBzbyB3ZSBvbmx5IG5lZWQgdG8g
bG9jaworICogdGhlIHBhcmVudCdzIGhlcmUuCisgKi8KK2ludCBtZW1fc2hhcmluZ19mb3JrX3Bh
Z2Uoc3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2ZuLCBib29sIHVuc2hhcmluZykKK3sKKyAgICBp
bnQgcmMgPSAtRU5PRU5UOworICAgIHNocl9oYW5kbGVfdCBoYW5kbGU7CisgICAgc3RydWN0IGRv
bWFpbiAqcGFyZW50ID0gZC0+cGFyZW50OworICAgIHN0cnVjdCBwMm1fZG9tYWluICpwMm07Cisg
ICAgdW5zaWduZWQgbG9uZyBnZm5fbCA9IGdmbl94KGdmbik7CisgICAgbWZuX3QgbWZuLCBuZXdf
bWZuOworICAgIHAybV90eXBlX3QgcDJtdDsKKyAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOwor
CisgICAgaWYgKCAhbWVtX3NoYXJpbmdfaXNfZm9yayhkKSApCisgICAgICAgIHJldHVybiAtRU5P
RU5UOworCisgICAgaWYgKCAhdW5zaGFyaW5nICkKKyAgICB7CisgICAgICAgIC8qIEZvciByZWFk
LW9ubHkgYWNjZXNzZXMgd2UganVzdCBhZGQgYSBzaGFyZWQgZW50cnkgdG8gdGhlIHBoeXNtYXAg
Ki8KKyAgICAgICAgd2hpbGUgKCBwYXJlbnQgKQorICAgICAgICB7CisgICAgICAgICAgICBpZiAo
ICEocmMgPSBub21pbmF0ZV9wYWdlKHBhcmVudCwgZ2ZuLCAwLCAmaGFuZGxlKSkgKQorICAgICAg
ICAgICAgICAgIGJyZWFrOworCisgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQtPnBhcmVudDsK
KyAgICAgICAgfQorCisgICAgICAgIGlmICggIXJjICkKKyAgICAgICAgeworICAgICAgICAgICAg
LyogVGhlIGNsaWVudCdzIHAybSBpcyBhbHJlYWR5IGxvY2tlZCAqLworICAgICAgICAgICAgc3Ry
dWN0IHAybV9kb21haW4gKnBwMm0gPSBwMm1fZ2V0X2hvc3RwMm0ocGFyZW50KTsKKworICAgICAg
ICAgICAgcDJtX2xvY2socHAybSk7CisgICAgICAgICAgICByYyA9IGFkZF90b19waHlzbWFwKHBh
cmVudCwgZ2ZuX2wsIGhhbmRsZSwgZCwgZ2ZuX2wsIGZhbHNlKTsKKyAgICAgICAgICAgIHAybV91
bmxvY2socHAybSk7CisKKyAgICAgICAgICAgIGlmICggIXJjICkKKyAgICAgICAgICAgICAgICBy
ZXR1cm4gMDsKKyAgICAgICAgfQorICAgIH0KKworICAgIC8qCisgICAgICogSWYgaXQncyBhIHdy
aXRlIGFjY2VzcyAoaWUuIHVuc2hhcmluZykgb3IgaWYgYWRkaW5nIGEgc2hhcmVkIGVudHJ5IHRv
CisgICAgICogdGhlIHBoeXNtYXAgZmFpbGVkIHdlJ2xsIGZvcmsgdGhlIHBhZ2UgZGlyZWN0bHku
CisgICAgICovCisgICAgcDJtID0gcDJtX2dldF9ob3N0cDJtKGQpOworICAgIHBhcmVudCA9IGQt
PnBhcmVudDsKKworICAgIHdoaWxlICggcGFyZW50ICkKKyAgICB7CisgICAgICAgIG1mbiA9IGdl
dF9nZm5fcXVlcnkocGFyZW50LCBnZm5fbCwgJnAybXQpOworCisgICAgICAgIC8qCisgICAgICAg
ICAqIFdlIGNhbid0IGZvcmsgZ3JhbnQgbWVtb3J5IGZyb20gdGhlIHBhcmVudCwgb25seSByZWd1
bGFyIHJhbS4KKyAgICAgICAgICovCisgICAgICAgIGlmICggbWZuX3ZhbGlkKG1mbikgJiYgcDJt
X2lzX3JhbShwMm10KSApCisgICAgICAgICAgICBicmVhazsKKworICAgICAgICBwdXRfZ2ZuKHBh
cmVudCwgZ2ZuX2wpOworICAgICAgICBwYXJlbnQgPSBwYXJlbnQtPnBhcmVudDsKKyAgICB9CisK
KyAgICBpZiAoICFwYXJlbnQgKQorICAgICAgICByZXR1cm4gLUVOT0VOVDsKKworICAgIGlmICgg
IShwYWdlID0gYWxsb2NfZG9taGVhcF9wYWdlKGQsIDApKSApCisgICAgeworICAgICAgICBwdXRf
Z2ZuKHBhcmVudCwgZ2ZuX2wpOworICAgICAgICByZXR1cm4gLUVOT01FTTsKKyAgICB9CisKKyAg
ICBuZXdfbWZuID0gcGFnZV90b19tZm4ocGFnZSk7CisgICAgY29weV9kb21haW5fcGFnZShuZXdf
bWZuLCBtZm4pOworICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94KG5ld19tZm4pLCBnZm5fbCk7
CisKKyAgICBwdXRfZ2ZuKHBhcmVudCwgZ2ZuX2wpOworCisgICAgcmV0dXJuIHAybS0+c2V0X2Vu
dHJ5KHAybSwgZ2ZuLCBuZXdfbWZuLCBQQUdFX09SREVSXzRLLCBwMm1fcmFtX3J3LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICBwMm0tPmRlZmF1bHRfYWNjZXNzLCAtMSk7Cit9CisKK3N0YXRp
YyBpbnQgYnJpbmdfdXBfdmNwdXMoc3RydWN0IGRvbWFpbiAqY2QsIHN0cnVjdCBkb21haW4gKmQp
Cit7CisgICAgdW5zaWduZWQgaW50IGk7CisgICAgc3RydWN0IHAybV9kb21haW4gKnAybSA9IHAy
bV9nZXRfaG9zdHAybShjZCk7CisgICAgaW50IHJldCA9IC1FSU5WQUw7CisKKyAgICBpZiAoIGQt
Pm1heF92Y3B1cyAhPSBjZC0+bWF4X3ZjcHVzICkKKyAgICAgICAgcmV0dXJuIHJldDsKKworICAg
IGlmICggKHJldCA9IGNwdXBvb2xfbW92ZV9kb21haW4oY2QsIGQtPmNwdXBvb2wpKSApCisgICAg
ICAgIHJldHVybiByZXQ7CisKKyAgICBmb3IgKCBpID0gMDsgaSA8IGNkLT5tYXhfdmNwdXM7IGkr
KyApCisgICAgeworICAgICAgICBtZm5fdCB2Y3B1X2luZm9fbWZuOworCisgICAgICAgIGlmICgg
IWQtPnZjcHVbaV0gfHwgY2QtPnZjcHVbaV0gKQorICAgICAgICAgICAgY29udGludWU7CisKKyAg
ICAgICAgaWYgKCAhdmNwdV9jcmVhdGUoY2QsIGkpICkKKyAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOworCisgICAgICAgIC8qCisgICAgICAgICAqIE1hcCBpbiBhIHBhZ2UgZm9yIHRoZSB2Y3B1
X2luZm8gaWYgdGhlIGd1ZXN0IHVzZXMgb25lIHRvIHRoZSBleGFjdAorICAgICAgICAgKiBzYW1l
IHNwb3QuCisgICAgICAgICAqLworICAgICAgICB2Y3B1X2luZm9fbWZuID0gZC0+dmNwdVtpXS0+
dmNwdV9pbmZvX21mbjsKKyAgICAgICAgaWYgKCAhbWZuX2VxKHZjcHVfaW5mb19tZm4sIElOVkFM
SURfTUZOKSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2U7
CisgICAgICAgICAgICBtZm5fdCBuZXdfbWZuOworICAgICAgICAgICAgZ2ZuX3QgZ2ZuID0gbWZu
X3RvX2dmbihkLCB2Y3B1X2luZm9fbWZuKTsKKyAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgZ2Zu
X2wgPSBnZm5feChnZm4pOworCisgICAgICAgICAgICBpZiAoICEocGFnZSA9IGFsbG9jX2RvbWhl
YXBfcGFnZShjZCwgMCkpICkKKyAgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKKworICAg
ICAgICAgICAgbmV3X21mbiA9IHBhZ2VfdG9fbWZuKHBhZ2UpOworICAgICAgICAgICAgc2V0X2dw
Zm5fZnJvbV9tZm4obWZuX3gobmV3X21mbiksIGdmbl9sKTsKKworICAgICAgICAgICAgaWYgKCAh
KHJldCA9IHAybS0+c2V0X2VudHJ5KHAybSwgZ2ZuLCBuZXdfbWZuLCBQQUdFX09SREVSXzRLLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAybV9yYW1fcncsIHAybS0+
ZGVmYXVsdF9hY2Nlc3MsIC0xKSkgKQorICAgICAgICAgICAgICAgIHJldHVybiByZXQ7CisKKyAg
ICAgICAgICAgIGlmICggIShyZXQgPSBtYXBfdmNwdV9pbmZvKGNkLT52Y3B1W2ldLCBnZm5fbCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQtPnZjcHVbaV0tPnZjcHVf
aW5mb19vZmZzZXQpKSApCisgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKKyAgICAgICAgfQor
ICAgIH0KKworICAgIGRvbWFpbl91cGRhdGVfbm9kZV9hZmZpbml0eShjZCk7CisgICAgcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBpbnQgZm9ya19oYXBfYWxsb2NhdGlvbihzdHJ1Y3QgZG9tYWluICpj
ZCwgc3RydWN0IGRvbWFpbiAqZCkKK3sKKyAgICBpbnQgcmM7CisgICAgYm9vbCBwcmVlbXB0ZWQ7
CisgICAgdW5zaWduZWQgbG9uZyBtYiA9IGhhcF9nZXRfYWxsb2NhdGlvbihkKTsKKworICAgIGlm
ICggbWIgPT0gaGFwX2dldF9hbGxvY2F0aW9uKGNkKSApCisgICAgICAgIHJldHVybiAwOworCisg
ICAgcGFnaW5nX2xvY2soY2QpOworICAgIHJjID0gaGFwX3NldF9hbGxvY2F0aW9uKGNkLCBtYiA8
PCAoMjAgLSBQQUdFX1NISUZUKSwgJnByZWVtcHRlZCk7CisgICAgcGFnaW5nX3VubG9jayhjZCk7
CisKKyAgICByZXR1cm4gcHJlZW1wdGVkID8gLUVSRVNUQVJUIDogcmM7Cit9CisKK3N0YXRpYyB2
b2lkIGZvcmtfdHNjKHN0cnVjdCBkb21haW4gKmNkLCBzdHJ1Y3QgZG9tYWluICpkKQoreworICAg
IHVpbnQzMl90IHRzY19tb2RlOworICAgIHVpbnQzMl90IGd0c2Nfa2h6OworICAgIHVpbnQzMl90
IGluY2FybmF0aW9uOworICAgIHVpbnQ2NF90IGVsYXBzZWRfbnNlYzsKKworICAgIHRzY19nZXRf
aW5mbyhkLCAmdHNjX21vZGUsICZlbGFwc2VkX25zZWMsICZndHNjX2toeiwgJmluY2FybmF0aW9u
KTsKKyAgICAvKiBEb24ndCBidW1wIGluY2FybmF0aW9uIG9uIHNldCAqLworICAgIHRzY19zZXRf
aW5mbyhjZCwgdHNjX21vZGUsIGVsYXBzZWRfbnNlYywgZ3RzY19raHosIGluY2FybmF0aW9uIC0g
MSk7Cit9CisKK3N0YXRpYyBpbnQgcG9wdWxhdGVfc3BlY2lhbF9wYWdlcyhzdHJ1Y3QgZG9tYWlu
ICpjZCkKK3sKKyAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtID0gcDJtX2dldF9ob3N0cDJtKGNk
KTsKKyAgICBzdGF0aWMgY29uc3QgdW5zaWduZWQgaW50IHBhcmFtc1tdID0KKyAgICB7CisgICAg
ICAgIEhWTV9QQVJBTV9TVE9SRV9QRk4sCisgICAgICAgIEhWTV9QQVJBTV9JT1JFUV9QRk4sCisg
ICAgICAgIEhWTV9QQVJBTV9CVUZJT1JFUV9QRk4sCisgICAgICAgIEhWTV9QQVJBTV9DT05TT0xF
X1BGTgorICAgIH07CisgICAgdW5zaWduZWQgaW50IGk7CisKKyAgICBmb3IgKCBpPTA7IGk8NDsg
aSsrICkKKyAgICB7CisgICAgICAgIHVpbnQ2NF90IHZhbHVlID0gMDsKKyAgICAgICAgbWZuX3Qg
bmV3X21mbjsKKyAgICAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZTsKKworICAgICAgICBpZiAo
IGh2bV9nZXRfcGFyYW0oY2QsIHBhcmFtc1tpXSwgJnZhbHVlKSB8fCAhdmFsdWUgKQorICAgICAg
ICAgICAgY29udGludWU7CisKKyAgICAgICAgaWYgKCAhKHBhZ2UgPSBhbGxvY19kb21oZWFwX3Bh
Z2UoY2QsIDApKSApCisgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKKworICAgICAgICBuZXdf
bWZuID0gcGFnZV90b19tZm4ocGFnZSk7CisgICAgICAgIHNldF9ncGZuX2Zyb21fbWZuKG1mbl94
KG5ld19tZm4pLCB2YWx1ZSk7CisKKyAgICAgICAgcmV0dXJuIHAybS0+c2V0X2VudHJ5KHAybSwg
X2dmbih2YWx1ZSksIG5ld19tZm4sIFBBR0VfT1JERVJfNEssCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBwMm1fcmFtX3J3LCBwMm0tPmRlZmF1bHRfYWNjZXNzLCAtMSk7CisgICAgfQor
CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZm9yayhzdHJ1Y3QgZG9tYWluICpkLCBz
dHJ1Y3QgZG9tYWluICpjZCkKK3sKKyAgICBpbnQgcmMgPSAtRUJVU1k7CisKKyAgICBpZiAoICFj
ZC0+Y29udHJvbGxlcl9wYXVzZV9jb3VudCApCisgICAgICAgIHJldHVybiByYzsKKworICAgIC8q
CisgICAgICogV2Ugb25seSB3YW50IHRvIGdldCBhbmQgcGF1c2UgdGhlIHBhcmVudCBvbmNlLCBu
b3QgZWFjaCB0aW1lIHRoaXMKKyAgICAgKiBvcGVyYXRpb24gaXMgcmVzdGFydGVkIGR1ZSB0byBw
cmVlbXB0aW9uLgorICAgICAqLworICAgIGlmICggIWNkLT5wYXJlbnRfcGF1c2VkICkKKyAgICB7
CisgICAgICAgIGlmICggIWdldF9kb21haW4oZCkgKQorICAgICAgICB7CisgICAgICAgICAgICBB
U1NFUlRfVU5SRUFDSEFCTEUoKTsKKyAgICAgICAgICAgIHJldHVybiAtRUJVU1k7CisgICAgICAg
IH0KKworICAgICAgICBkb21haW5fcGF1c2UoZCk7CisgICAgICAgIGNkLT5wYXJlbnRfcGF1c2Vk
ID0gdHJ1ZTsKKyAgICAgICAgY2QtPm1heF9wYWdlcyA9IGQtPm1heF9wYWdlczsKKyAgICAgICAg
Y2QtPm1heF92Y3B1cyA9IGQtPm1heF92Y3B1czsKKyAgICB9CisKKyAgICAvKiB0aGlzIGlzIHBy
ZWVtcHRpYmxlIHNvIGl0J3MgdGhlIGZpcnN0IHRvIGdldCBkb25lICovCisgICAgaWYgKCAocmMg
PSBmb3JrX2hhcF9hbGxvY2F0aW9uKGNkLCBkKSkgKQorICAgICAgICBnb3RvIGRvbmU7CisKKyAg
ICBpZiAoIChyYyA9IGJyaW5nX3VwX3ZjcHVzKGNkLCBkKSkgKQorICAgICAgICBnb3RvIGRvbmU7
CisKKyAgICBpZiAoIChyYyA9IGh2bV9jb3B5X2NvbnRleHRfYW5kX3BhcmFtcyhjZCwgZCkpICkK
KyAgICAgICAgZ290byBkb25lOworCisgICAgaWYgKCAocmMgPSBwb3B1bGF0ZV9zcGVjaWFsX3Bh
Z2VzKGNkKSkgKQorICAgICAgICBnb3RvIGRvbmU7CisKKyAgICBmb3JrX3RzYyhjZCwgZCk7CisK
KyAgICBjZC0+cGFyZW50ID0gZDsKKworIGRvbmU6CisgICAgaWYgKCByYyAmJiByYyAhPSAtRVJF
U1RBUlQgKQorICAgIHsKKyAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7CisgICAgICAgIHB1dF9k
b21haW4oZCk7CisgICAgICAgIGNkLT5wYXJlbnRfcGF1c2VkID0gZmFsc2U7CisgICAgfQorCisg
ICAgcmV0dXJuIHJjOworfQorCiBpbnQgbWVtX3NoYXJpbmdfbWVtb3AoWEVOX0dVRVNUX0hBTkRM
RV9QQVJBTSh4ZW5fbWVtX3NoYXJpbmdfb3BfdCkgYXJnKQogewogICAgIGludCByYzsKQEAgLTE2
OTgsNiArMTk1OCwzMyBAQCBpbnQgbWVtX3NoYXJpbmdfbWVtb3AoWEVOX0dVRVNUX0hBTkRMRV9Q
QVJBTSh4ZW5fbWVtX3NoYXJpbmdfb3BfdCkgYXJnKQogICAgICAgICByYyA9IGRlYnVnX2dyZWYo
ZCwgbXNvLnUuZGVidWcudS5ncmVmKTsKICAgICAgICAgYnJlYWs7CiAKKyAgICBjYXNlIFhFTk1F
TV9zaGFyaW5nX29wX2Zvcms6CisgICAgeworICAgICAgICBzdHJ1Y3QgZG9tYWluICpwZDsKKwor
ICAgICAgICByYyA9IC1FSU5WQUw7CisgICAgICAgIGlmICggbXNvLnUuZm9yay5fcGFkWzBdIHx8
IG1zby51LmZvcmsuX3BhZFsxXSB8fAorICAgICAgICAgICAgIG1zby51LmZvcmsuX3BhZFsyXSAp
CisgICAgICAgICAgICBnb3RvIG91dDsKKworICAgICAgICByYyA9IHJjdV9sb2NrX2xpdmVfcmVt
b3RlX2RvbWFpbl9ieV9pZChtc28udS5mb3JrLnBhcmVudF9kb21haW4sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZwZCk7CisgICAgICAgIGlmICggcmMg
KQorICAgICAgICAgICAgZ290byBvdXQ7CisKKyAgICAgICAgaWYgKCAhbWVtX3NoYXJpbmdfZW5h
YmxlZChwZCkgJiYgKHJjID0gbWVtX3NoYXJpbmdfY29udHJvbChwZCwgdHJ1ZSkpICkKKyAgICAg
ICAgICAgIGdvdG8gb3V0OworCisgICAgICAgIHJjID0gZm9yayhwZCwgZCk7CisKKyAgICAgICAg
aWYgKCByYyA9PSAtRVJFU1RBUlQgKQorICAgICAgICAgICAgcmMgPSBoeXBlcmNhbGxfY3JlYXRl
X2NvbnRpbnVhdGlvbihfX0hZUEVSVklTT1JfbWVtb3J5X29wLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGgiLCBYRU5NRU1fc2hhcmluZ19vcCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnKTsKKyAgICAg
ICAgcmN1X3VubG9ja19kb21haW4ocGQpOworICAgICAgICBicmVhazsKKyAgICB9CisKICAgICBk
ZWZhdWx0OgogICAgICAgICByYyA9IC1FTk9TWVM7CiAgICAgICAgIGJyZWFrOwpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gveDg2L21tL3AybS5jIGIveGVuL2FyY2gveDg2L21tL3AybS5jCmluZGV4IGM1
ZjQyOGQ2N2MuLjIzNTg4MDgyMjcgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0uYwor
KysgYi94ZW4vYXJjaC94ODYvbW0vcDJtLmMKQEAgLTUwOSw2ICs1MDksMTIgQEAgbWZuX3QgX19n
ZXRfZ2ZuX3R5cGVfYWNjZXNzKHN0cnVjdCBwMm1fZG9tYWluICpwMm0sIHVuc2lnbmVkIGxvbmcg
Z2ZuX2wsCiAKICAgICBtZm4gPSBwMm0tPmdldF9lbnRyeShwMm0sIGdmbiwgdCwgYSwgcSwgcGFn
ZV9vcmRlciwgTlVMTCk7CiAKKyAgICAvKiBDaGVjayBpZiB3ZSBuZWVkIHRvIGZvcmsgdGhlIHBh
Z2UgKi8KKyAgICBpZiAoIChxICYgUDJNX0FMTE9DKSAmJiBwMm1faXNfaG9sZSgqdCkgJiYKKyAg
ICAgICAgICFtZW1fc2hhcmluZ19mb3JrX3BhZ2UocDJtLT5kb21haW4sIGdmbiwgISEocSAmIFAy
TV9VTlNIQVJFKSkgKQorICAgICAgICBtZm4gPSBwMm0tPmdldF9lbnRyeShwMm0sIGdmbiwgdCwg
YSwgcSwgcGFnZV9vcmRlciwgTlVMTCk7CisKKyAgICAvKiBDaGVjayBpZiB3ZSBuZWVkIHRvIHVu
c2hhcmUgdGhlIHBhZ2UgKi8KICAgICBpZiAoIChxICYgUDJNX1VOU0hBUkUpICYmIHAybV9pc19z
aGFyZWQoKnQpICkKICAgICB7CiAgICAgICAgIEFTU0VSVChwMm1faXNfaG9zdHAybShwMm0pKTsK
QEAgLTU4OCw3ICs1OTQsOCBAQCBzdHJ1Y3QgcGFnZV9pbmZvICpwMm1fZ2V0X3BhZ2VfZnJvbV9n
Zm4oCiAgICAgICAgICAgICByZXR1cm4gcGFnZTsKIAogICAgICAgICAvKiBFcnJvciBwYXRoOiBu
b3QgYSBzdWl0YWJsZSBHRk4gYXQgYWxsICovCi0gICAgICAgIGlmICggIXAybV9pc19yYW0oKnQp
ICYmICFwMm1faXNfcGFnaW5nKCp0KSAmJiAhcDJtX2lzX3BvZCgqdCkgKQorICAgICAgICBpZiAo
ICFwMm1faXNfcmFtKCp0KSAmJiAhcDJtX2lzX3BhZ2luZygqdCkgJiYgIXAybV9pc19wb2QoKnQp
ICYmCisgICAgICAgICAgICAgIW1lbV9zaGFyaW5nX2lzX2ZvcmsocDJtLT5kb21haW4pICkKICAg
ICAgICAgICAgIHJldHVybiBOVUxMOwogICAgIH0KIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9k
b21haW4uYyBiL3hlbi9jb21tb24vZG9tYWluLmMKaW5kZXggNmFkNDU4ZmE2Yi4uMDI5OTgyMzVk
ZCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9kb21haW4uYworKysgYi94ZW4vY29tbW9uL2RvbWFp
bi5jCkBAIC0xMjY5LDYgKzEyNjksOSBAQCBpbnQgbWFwX3ZjcHVfaW5mbyhzdHJ1Y3QgdmNwdSAq
diwgdW5zaWduZWQgbG9uZyBnZm4sIHVuc2lnbmVkIG9mZnNldCkKIAogICAgIHYtPnZjcHVfaW5m
byA9IG5ld19pbmZvOwogICAgIHYtPnZjcHVfaW5mb19tZm4gPSBwYWdlX3RvX21mbihwYWdlKTsK
KyNpZmRlZiBDT05GSUdfTUVNX1NIQVJJTkcKKyAgICB2LT52Y3B1X2luZm9fb2Zmc2V0ID0gb2Zm
c2V0OworI2VuZGlmCiAKICAgICAvKiBTZXQgbmV3IHZjcHVfaW5mbyBwb2ludGVyIC9iZWZvcmUv
IHNldHRpbmcgcGVuZGluZyBmbGFncy4gKi8KICAgICBzbXBfd21iKCk7CmRpZmYgLS1naXQgYS94
ZW4vaW5jbHVkZS9hc20teDg2L2hhcC5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9oYXAuaAppbmRl
eCBiOTRiZmI0ZWQwLi4xYmYwN2U0OWZlIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2
L2hhcC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaGFwLmgKQEAgLTQ1LDYgKzQ1LDcgQEAg
aW50ICAgaGFwX3RyYWNrX2RpcnR5X3ZyYW0oc3RydWN0IGRvbWFpbiAqZCwKIAogZXh0ZXJuIGNv
bnN0IHN0cnVjdCBwYWdpbmdfbW9kZSAqaGFwX3BhZ2luZ19nZXRfbW9kZShzdHJ1Y3QgdmNwdSAq
KTsKIGludCBoYXBfc2V0X2FsbG9jYXRpb24oc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50
IHBhZ2VzLCBib29sICpwcmVlbXB0ZWQpOwordW5zaWduZWQgaW50IGhhcF9nZXRfYWxsb2NhdGlv
bihzdHJ1Y3QgZG9tYWluICpkKTsKIAogI2VuZGlmIC8qIFhFTl9IQVBfSCAqLwogCmRpZmYgLS1n
aXQgYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9odm0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYv
aHZtL2h2bS5oCmluZGV4IDI0ZGE4MjRjYmYuLjM1ZTk3MGIwMzAgMTAwNjQ0Ci0tLSBhL3hlbi9p
bmNsdWRlL2FzbS14ODYvaHZtL2h2bS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL2h2
bS5oCkBAIC0zMzksNiArMzM5LDggQEAgYm9vbCBodm1fZmx1c2hfdmNwdV90bGIoYm9vbCAoKmZs
dXNoX3ZjcHUpKHZvaWQgKmN0eHQsIHN0cnVjdCB2Y3B1ICp2KSwKIAogaW50IGh2bV9jb3B5X2Nv
bnRleHRfYW5kX3BhcmFtcyhzdHJ1Y3QgZG9tYWluICpzcmMsIHN0cnVjdCBkb21haW4gKmRzdCk7
CiAKK2ludCBodm1fZ2V0X3BhcmFtKHN0cnVjdCBkb21haW4gKmQsIHVpbnQzMl90IGluZGV4LCB1
aW50NjRfdCAqdmFsdWUpOworCiAjaWZkZWYgQ09ORklHX0hWTQogCiAjZGVmaW5lIGh2bV9nZXRf
Z3Vlc3RfdHNjKHYpIGh2bV9nZXRfZ3Vlc3RfdHNjX2ZpeGVkKHYsIDApCmRpZmYgLS1naXQgYS94
ZW4vaW5jbHVkZS9hc20teDg2L21lbV9zaGFyaW5nLmggYi94ZW4vaW5jbHVkZS9hc20teDg2L21l
bV9zaGFyaW5nLmgKaW5kZXggNTM3NjBhMjg5Ni4uYWM5NjhmYWUzZiAxMDA2NDQKLS0tIGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9tZW1fc2hhcmluZy5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYv
bWVtX3NoYXJpbmcuaApAQCAtMzksNiArMzksOSBAQCBzdHJ1Y3QgbWVtX3NoYXJpbmdfZG9tYWlu
CiAKICNkZWZpbmUgbWVtX3NoYXJpbmdfZW5hYmxlZChkKSAoKGQpLT5hcmNoLmh2bS5tZW1fc2hh
cmluZy5lbmFibGVkKQogCisjZGVmaW5lIG1lbV9zaGFyaW5nX2lzX2ZvcmsoZCkgXAorICAgICht
ZW1fc2hhcmluZ19lbmFibGVkKGQpICYmICEhKChkKS0+cGFyZW50KSkKKwogLyogQXVkaXRpbmcg
b2YgbWVtb3J5IHNoYXJpbmcgY29kZT8gKi8KICNpZm5kZWYgTkRFQlVHCiAjZGVmaW5lIE1FTV9T
SEFSSU5HX0FVRElUIDEKQEAgLTg4LDYgKzkxLDkgQEAgc3RhdGljIGlubGluZSBpbnQgbWVtX3No
YXJpbmdfdW5zaGFyZV9wYWdlKHN0cnVjdCBkb21haW4gKmQsCiAgICAgcmV0dXJuIHJjOwogfQog
CitpbnQgbWVtX3NoYXJpbmdfZm9ya19wYWdlKHN0cnVjdCBkb21haW4gKmQsIGdmbl90IGdmbiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1bnNoYXJpbmcpOworCiAvKgogICogSWYg
Y2FsbGVkIGJ5IGEgZm9yZWlnbiBkb21haW4sIHBvc3NpYmxlIGVycm9ycyBhcmUKICAqICAgLUVC
VVNZIC0+IHJpbmcgZnVsbApAQCAtMTE3LDYgKzEyMyw3IEBAIGludCByZWxpbnF1aXNoX3NoYXJl
ZF9wYWdlcyhzdHJ1Y3QgZG9tYWluICpkKTsKICNlbHNlCiAKICNkZWZpbmUgbWVtX3NoYXJpbmdf
ZW5hYmxlZChkKSBmYWxzZQorI2RlZmluZSBtZW1fc2hhcmluZ19pc19mb3JrKHAybSkgZmFsc2UK
IAogc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgbWVtX3NoYXJpbmdfZ2V0X25yX3NhdmVkX21m
bnModm9pZCkKIHsKQEAgLTE0MSw2ICsxNDgsMTYgQEAgc3RhdGljIGlubGluZSBpbnQgbWVtX3No
YXJpbmdfbm90aWZ5X2Vub21lbShzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIGdmbiwK
ICAgICByZXR1cm4gLUVPUE5PVFNVUFA7CiB9CiAKK3N0YXRpYyBpbmxpbmUgaW50IG1lbV9zaGFy
aW5nX2Zvcmsoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGRvbWFpbiAqY2QsIGJvb2wgdmNwdSkK
K3sKKyAgICByZXR1cm4gLUVPUE5PVFNVUFA7Cit9CisKK3N0YXRpYyBpbmxpbmUgaW50IG1lbV9z
aGFyaW5nX2ZvcmtfcGFnZShzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIGJvb2wgbG9jaykK
K3sKKyAgICByZXR1cm4gLUVPUE5PVFNVUFA7Cit9CisKICNlbmRpZgogCiAjZW5kaWYgLyogX19N
RU1fU0hBUklOR19IX18gKi8KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3B1YmxpYy9tZW1vcnku
aCBiL3hlbi9pbmNsdWRlL3B1YmxpYy9tZW1vcnkuaAppbmRleCAxMjZkMGZmMDZlLi5jMWRiYWQw
NjBlIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvbWVtb3J5LmgKKysrIGIveGVuL2lu
Y2x1ZGUvcHVibGljL21lbW9yeS5oCkBAIC00ODIsNiArNDgyLDcgQEAgREVGSU5FX1hFTl9HVUVT
VF9IQU5ETEUoeGVuX21lbV9hY2Nlc3Nfb3BfdCk7CiAjZGVmaW5lIFhFTk1FTV9zaGFyaW5nX29w
X2FkZF9waHlzbWFwICAgICAgIDYKICNkZWZpbmUgWEVOTUVNX3NoYXJpbmdfb3BfYXVkaXQgICAg
ICAgICAgICAgNwogI2RlZmluZSBYRU5NRU1fc2hhcmluZ19vcF9yYW5nZV9zaGFyZSAgICAgICA4
CisjZGVmaW5lIFhFTk1FTV9zaGFyaW5nX29wX2ZvcmsgICAgICAgICAgICAgIDkKIAogI2RlZmlu
ZSBYRU5NRU1fU0hBUklOR19PUF9TX0hBTkRMRV9JTlZBTElEICAoLTEwKQogI2RlZmluZSBYRU5N
RU1fU0hBUklOR19PUF9DX0hBTkRMRV9JTlZBTElEICAoLTkpCkBAIC01MzIsNiArNTMzLDEwIEBA
IHN0cnVjdCB4ZW5fbWVtX3NoYXJpbmdfb3AgewogICAgICAgICAgICAgICAgIHVpbnQzMl90IGdy
ZWY7ICAgICAvKiBJTjogZ3JlZiB0byBkZWJ1ZyAgICAgICAgICovCiAgICAgICAgICAgICB9IHU7
CiAgICAgICAgIH0gZGVidWc7CisgICAgICAgIHN0cnVjdCBtZW1fc2hhcmluZ19vcF9mb3JrIHsg
ICAgICAvKiBPUF9GT1JLICovCisgICAgICAgICAgICBkb21pZF90IHBhcmVudF9kb21haW47ICAg
ICAgICAvKiBJTjogcGFyZW50J3MgZG9tYWluIGlkICovCisgICAgICAgICAgICB1aW50MTZfdCBf
cGFkWzNdOyAgICAgICAgICAgICAvKiBNdXN0IGJlIHNldCB0byAwICovCisgICAgICAgIH0gZm9y
azsKICAgICB9IHU7CiB9OwogdHlwZWRlZiBzdHJ1Y3QgeGVuX21lbV9zaGFyaW5nX29wIHhlbl9t
ZW1fc2hhcmluZ19vcF90OwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmggYi94
ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAppbmRleCAzYTRmNDMwOThjLi5jNmJhNWE1MmE0IDEwMDY0
NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2No
ZWQuaApAQCAtMjQ4LDYgKzI0OCw5IEBAIHN0cnVjdCB2Y3B1CiAKICAgICAvKiBHdWVzdC1zcGVj
aWZpZWQgcmVsb2NhdGlvbiBvZiB2Y3B1X2luZm8uICovCiAgICAgbWZuX3QgICAgICAgICAgICB2
Y3B1X2luZm9fbWZuOworI2lmZGVmIENPTkZJR19NRU1fU0hBUklORworICAgIHVpbnQzMl90ICAg
ICAgICAgdmNwdV9pbmZvX29mZnNldDsKKyNlbmRpZgogCiAgICAgc3RydWN0IGV2dGNobl9maWZv
X3ZjcHUgKmV2dGNobl9maWZvOwogCkBAIC01MDMsNiArNTA2LDggQEAgc3RydWN0IGRvbWFpbgog
ICAgIC8qIE1lbW9yeSBzaGFyaW5nIHN1cHBvcnQgKi8KICNpZmRlZiBDT05GSUdfTUVNX1NIQVJJ
TkcKICAgICBzdHJ1Y3Qgdm1fZXZlbnRfZG9tYWluICp2bV9ldmVudF9zaGFyZTsKKyAgICBzdHJ1
Y3QgZG9tYWluICpwYXJlbnQ7IC8qIFZNIGZvcmsgcGFyZW50ICovCisgICAgYm9vbCBwYXJlbnRf
cGF1c2VkOwogI2VuZGlmCiAgICAgLyogTWVtb3J5IHBhZ2luZyBzdXBwb3J0ICovCiAjaWZkZWYg
Q09ORklHX0hBU19NRU1fUEFHSU5HCi0tIAoyLjIwLjEKCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZl
bEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxt
YW4vbGlzdGluZm8veGVuLWRldmVs

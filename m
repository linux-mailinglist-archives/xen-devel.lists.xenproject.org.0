Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 12DA8B7A61
	for <lists+xen-devel@lfdr.de>; Thu, 19 Sep 2019 15:24:41 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iAwNb-0007bP-9W; Thu, 19 Sep 2019 13:21:51 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=5hYN=XO=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1iAwNZ-0007bE-S7
 for xen-devel@lists.xenproject.org; Thu, 19 Sep 2019 13:21:49 +0000
X-Inumbo-ID: 6f04f05e-dae0-11e9-965d-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 6f04f05e-dae0-11e9-965d-12813bfff9fa;
 Thu, 19 Sep 2019 13:21:48 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id A4F09AFCE;
 Thu, 19 Sep 2019 13:21:47 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
References: <aa62726c-5aa4-8bcd-dc35-61eb8dfeaee3@suse.com>
Message-ID: <f64deee2-7b5a-3330-997c-87bfc05b0807@suse.com>
Date: Thu, 19 Sep 2019 15:21:55 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.9.0
MIME-Version: 1.0
In-Reply-To: <aa62726c-5aa4-8bcd-dc35-61eb8dfeaee3@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH v6 1/8] AMD/IOMMU: don't blindly allocate
 interrupt remapping tables
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QUNQSSB0YWJsZXMgYXJlIGZyZWUgdG8gbGlzdCBmYXIgbW9yZSBkZXZpY2UgY29vcmRpbmF0ZXMg
dGhhbiB0aGVyZSBhcmUKYWN0dWFsIGRldmljZXMuIEJ5IGRlbGF5aW5nIHRoZSB0YWJsZSBhbGxv
Y2F0aW9ucyBmb3IgbW9zdCBjYXNlcywgYW5kCmRvaW5nIHRoZW0gb25seSB3aGVuIGFuIGFjdHVh
bCBkZXZpY2UgaXMga25vd24gdG8gYmUgcHJlc2VudCBhdCBhIGdpdmVuCnBvc2l0aW9uLCBvdmVy
YWxsIG1lbW9yeSB1c2VkIGZvciB0aGUgdGFibGVzIGdvZXMgZG93biBmcm9tIG92ZXIgNTAwawpw
YWdlcyB0byBqdXN0IG92ZXIgMWsgKG9uIG15IHN5c3RlbSBoYXZpbmcgc3VjaCBBQ1BJIHRhYmxl
IGNvbnRlbnRzKS4KClRhYmxlcyBjb250aW51ZSB0byBnZXQgYWxsb2NhdGVkIHJpZ2h0IGF3YXkg
Zm9yIHNwZWNpYWwgZW50cmllcwooSU8tQVBJQywgSFBFVCkgYXMgd2VsbCBhcyBmb3IgYWxpYXMg
SURzLiBXaGlsZSBpbiB0aGUgZm9ybWVyIGNhc2UKdGhhdCdzIHNpbXBseSBiZWNhdXNlIHRoZXJl
IG1heSBub3QgYmUgYW55IGRldmljZSBhdCBhIGdpdmVuIHBvc2l0aW9uLAppbiB0aGUgbGF0dGVy
IGNhc2UgdGhpcyBpcyB0byBhdm9pZCBoYXZpbmcgdG8gaW50cm9kdWNlIHJlZi1jb3VudGluZyBv
Zgp0YWJsZSB1c2FnZS4KClRoZSBjaGFuZ2UgaW52b2x2ZXMgaW52b2tpbmcKaXRlcmF0ZV9pdnJz
X21hcHBpbmdzKGFtZF9pb21tdV9zZXR1cF9kZXZpY2VfdGFibGUpIGEgc2Vjb25kIHRpbWUsCmJl
Y2F1c2UgdGhlIGZ1bmN0aW9uIG5vdyB3YW50cyB0byBiZSBhYmxlIHRvIGZpbmQgUENJIGRldmlj
ZXMsIHdoaWNoCmlzbid0IHBvc3NpYmxlIHlldCB3aGVuIElPTU1VIHNldHVwIGhhcHBlbnMgdmVy
eSBlYXJseSBkdXJpbmcgeDJBUElDCm1vZGUgc2V0dXAuIEluIHRoaXMgY29udGV4dCBhbWRfaW9t
bXVfaW5pdF9pbnRlcnJ1cHQoKSBnZXRzIHJlbmFtZWQgYXMKd2VsbC4KClRoZSBsb2dpYyBhZGp1
c3RpbmcgYSBEVEUncyBpbnRlcnJ1cHQgcmVtYXBwaW5nIGF0dHJpYnV0ZXMgYWxzbyBnZXRzCmNo
YW5nZWQsIHN1Y2ggdGhhdCB0aGUgbGFjayBvZiBhbiBJUlQgd291bGQgcmVzdWx0IGluIHRhcmdl
dCBhYm9ydGVkCnJhdGhlciB0aGFuIG5vdCByZW1hcHBlZCBpbnRlcnJ1cHRzIChzaG91bGQgYW55
IG9jY3VyKS4KCk5vdGUgdGhhdCBmb3Igbm93IHBoYW50b20gZnVuY3Rpb25zIGdldCBzZXBhcmF0
ZSBJUlRzIGFsbG9jYXRlZCwgYXMgd2FzCnRoZSBjYXNlIGJlZm9yZS4KClNpZ25lZC1vZmYtYnk6
IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCnY2OiBBY3F1aXJlIElPTU1VIGxv
Y2sgaW4gY29kZSBhZGRlZCB0byBhbWRfaW9tbXVfYWRkX2RldmljZSgpLiBEcm9wIGEKICAgIHBv
aW50bGVzcyB1c2Ugb2YgdGhlIGNvbmRpdGlvbmFsIG9wZXJhdG9yLgp2NTogTmV3LgotLS0KVEJE
OiBUaGlzIHJldGFpbnMgcHJpb3IgKGJ1dCBzdXNwaWNpb3VzKSBiZWhhdmlvciBvZiBub3QgY2Fs
bGluZwogICAgIGFtZF9pb21tdV9zZXRfaW50cmVtYXBfdGFibGUoKSBmb3IgImludmFsaWQiIElW
UlMgbWFwcGluZyBlbnRyaWVzLgogICAgIFNpbmNlIERURS5JVj0wIG1lYW5zIHVuLXJlbWFwcGVk
IGludGVycnVwdHMsIEkgd29uZGVyIGlmIHRoaXMgbmVlZHMKICAgICBjaGFuZ2luZy4KCkJhY2tw
b3J0aW5nIG5vdGU6IFRoaXMgZGVwZW5kcyBvbiBiNWZiZTgxMTk2ICJpb21tdSAvIHg4NjogbW92
ZSBjYWxsIHRvCnNjYW5fcGNpX2RldmljZXMoKSBvdXQgb2YgdmVuZG9yIGNvZGUiIQoKLS0tCiB4
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfYWNwaS5jICAgICAgfCAgIDY1ICsrKysr
KysrKysrKystLS0tLS0tLS0tCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5p
dC5jICAgICAgfCAgIDczICsrKysrKysrKysrKysrKysrKysrLS0tLS0tCiB4ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50ci5jICAgICAgfCAgICA0IC0KIHhlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYyAgICAgICB8ICAgIDUgKwogeGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYyAgIHwgICA0MyArKysrKysrKysrKysrKy0KIHhl
bi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtcHJvdG8uaCB8ICAgIDIgCiA2IGZp
bGVzIGNoYW5nZWQsIDE0MyBpbnNlcnRpb25zKCspLCA0OSBkZWxldGlvbnMoLSkKCi0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9hY3BpLmMKKysrIGIveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL2lvbW11X2FjcGkuYwpAQCAtNTMsNyArNTMsOCBAQCB1bmlvbiBhY3Bp
X2l2aGRfZGV2aWNlIHsKIH07CiAKIHN0YXRpYyB2b2lkIF9faW5pdCBhZGRfaXZyc19tYXBwaW5n
X2VudHJ5KAotICAgIHUxNiBiZGYsIHUxNiBhbGlhc19pZCwgdTggZmxhZ3MsIHN0cnVjdCBhbWRf
aW9tbXUgKmlvbW11KQorICAgIHVpbnQxNl90IGJkZiwgdWludDE2X3QgYWxpYXNfaWQsIHVpbnQ4
X3QgZmxhZ3MsIGJvb2wgYWxsb2NfaXJ0LAorICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQog
ewogICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX21hcHBpbmdzID0gZ2V0X2l2cnNfbWFw
cGluZ3MoaW9tbXUtPnNlZyk7CiAKQEAgLTY5LDI3ICs3MCwzMiBAQCBzdGF0aWMgdm9pZCBfX2lu
aXQgYWRkX2l2cnNfbWFwcGluZ19lbnRyCiAgICAgaWYgKCBpb21tdS0+YmRmID09IGJkZiApCiAg
ICAgICAgIHJldHVybjsKIAotICAgIGlmICggIWl2cnNfbWFwcGluZ3NbYWxpYXNfaWRdLmludHJl
bWFwX3RhYmxlICkKKyAgICAvKiBBbGxvY2F0ZSBpbnRlcnJ1cHQgcmVtYXBwaW5nIHRhYmxlIGlm
IG5lZWRlZC4gKi8KKyAgICBpZiAoIGlvbW11X2ludHJlbWFwICYmICFpdnJzX21hcHBpbmdzW2Fs
aWFzX2lkXS5pbnRyZW1hcF90YWJsZSApCiAgICAgewotICAgICAgICAgLyogYWxsb2NhdGUgcGVy
LWRldmljZSBpbnRlcnJ1cHQgcmVtYXBwaW5nIHRhYmxlICovCi0gICAgICAgICBpZiAoIGFtZF9p
b21tdV9wZXJkZXZfaW50cmVtYXAgKQotICAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbYWxpYXNf
aWRdLmludHJlbWFwX3RhYmxlID0KLSAgICAgICAgICAgICAgICAgYW1kX2lvbW11X2FsbG9jX2lu
dHJlbWFwX3RhYmxlKAotICAgICAgICAgICAgICAgICAgICAgaW9tbXUsCi0gICAgICAgICAgICAg
ICAgICAgICAmaXZyc19tYXBwaW5nc1thbGlhc19pZF0uaW50cmVtYXBfaW51c2UpOwotICAgICAg
ICAgZWxzZQotICAgICAgICAgewotICAgICAgICAgICAgIGlmICggc2hhcmVkX2ludHJlbWFwX3Rh
YmxlID09IE5VTEwgICkKLSAgICAgICAgICAgICAgICAgc2hhcmVkX2ludHJlbWFwX3RhYmxlID0g
YW1kX2lvbW11X2FsbG9jX2ludHJlbWFwX3RhYmxlKAotICAgICAgICAgICAgICAgICAgICAgaW9t
bXUsCi0gICAgICAgICAgICAgICAgICAgICAmc2hhcmVkX2ludHJlbWFwX2ludXNlKTsKLSAgICAg
ICAgICAgICBpdnJzX21hcHBpbmdzW2FsaWFzX2lkXS5pbnRyZW1hcF90YWJsZSA9IHNoYXJlZF9p
bnRyZW1hcF90YWJsZTsKLSAgICAgICAgICAgICBpdnJzX21hcHBpbmdzW2FsaWFzX2lkXS5pbnRy
ZW1hcF9pbnVzZSA9IHNoYXJlZF9pbnRyZW1hcF9pbnVzZTsKLSAgICAgICAgIH0KLQotICAgICAg
ICAgaWYgKCAhaXZyc19tYXBwaW5nc1thbGlhc19pZF0uaW50cmVtYXBfdGFibGUgKQotICAgICAg
ICAgICAgIHBhbmljKCJObyBtZW1vcnkgZm9yICUwNHg6JTAyeDolMDJ4LiV1J3MgSVJUXG4iLCBp
b21tdS0+c2VnLAotICAgICAgICAgICAgICAgICAgIFBDSV9CVVMoYWxpYXNfaWQpLCBQQ0lfU0xP
VChhbGlhc19pZCksIFBDSV9GVU5DKGFsaWFzX2lkKSk7CisgICAgICAgIGlmICggIWFtZF9pb21t
dV9wZXJkZXZfaW50cmVtYXAgKQorICAgICAgICB7CisgICAgICAgICAgICBpZiAoICFzaGFyZWRf
aW50cmVtYXBfdGFibGUgKQorICAgICAgICAgICAgICAgIHNoYXJlZF9pbnRyZW1hcF90YWJsZSA9
IGFtZF9pb21tdV9hbGxvY19pbnRyZW1hcF90YWJsZSgKKyAgICAgICAgICAgICAgICAgICAgaW9t
bXUsICZzaGFyZWRfaW50cmVtYXBfaW51c2UpOworCisgICAgICAgICAgICBpZiAoICFzaGFyZWRf
aW50cmVtYXBfdGFibGUgKQorICAgICAgICAgICAgICAgIHBhbmljKCJObyBtZW1vcnkgZm9yIHNo
YXJlZCBJUlRcbiIpOworCisgICAgICAgICAgICBpdnJzX21hcHBpbmdzW2FsaWFzX2lkXS5pbnRy
ZW1hcF90YWJsZSA9IHNoYXJlZF9pbnRyZW1hcF90YWJsZTsKKyAgICAgICAgICAgIGl2cnNfbWFw
cGluZ3NbYWxpYXNfaWRdLmludHJlbWFwX2ludXNlID0gc2hhcmVkX2ludHJlbWFwX2ludXNlOwor
ICAgICAgICB9CisgICAgICAgIGVsc2UgaWYgKCBhbGxvY19pcnQgKQorICAgICAgICB7CisgICAg
ICAgICAgICBpdnJzX21hcHBpbmdzW2FsaWFzX2lkXS5pbnRyZW1hcF90YWJsZSA9CisgICAgICAg
ICAgICAgICAgYW1kX2lvbW11X2FsbG9jX2ludHJlbWFwX3RhYmxlKAorICAgICAgICAgICAgICAg
ICAgICBpb21tdSwgJml2cnNfbWFwcGluZ3NbYWxpYXNfaWRdLmludHJlbWFwX2ludXNlKTsKKwor
ICAgICAgICAgICAgaWYgKCAhaXZyc19tYXBwaW5nc1thbGlhc19pZF0uaW50cmVtYXBfdGFibGUg
KQorICAgICAgICAgICAgICAgIHBhbmljKCJObyBtZW1vcnkgZm9yICUwNHg6JTAyeDolMDJ4LiV1
J3MgSVJUXG4iLAorICAgICAgICAgICAgICAgICAgICAgIGlvbW11LT5zZWcsIFBDSV9CVVMoYWxp
YXNfaWQpLCBQQ0lfU0xPVChhbGlhc19pZCksCisgICAgICAgICAgICAgICAgICAgICAgUENJX0ZV
TkMoYWxpYXNfaWQpKTsKKyAgICAgICAgfQogICAgIH0KIAogICAgIGl2cnNfbWFwcGluZ3NbYWxp
YXNfaWRdLnZhbGlkID0gdHJ1ZTsKQEAgLTQzMyw3ICs0MzksOCBAQCBzdGF0aWMgdTE2IF9faW5p
dCBwYXJzZV9pdmhkX2RldmljZV9zZWxlCiAgICAgICAgIHJldHVybiAwOwogICAgIH0KIAotICAg
IGFkZF9pdnJzX21hcHBpbmdfZW50cnkoYmRmLCBiZGYsIHNlbGVjdC0+aGVhZGVyLmRhdGFfc2V0
dGluZywgaW9tbXUpOworICAgIGFkZF9pdnJzX21hcHBpbmdfZW50cnkoYmRmLCBiZGYsIHNlbGVj
dC0+aGVhZGVyLmRhdGFfc2V0dGluZywgZmFsc2UsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpb21tdSk7CiAKICAgICByZXR1cm4gc2l6ZW9mKCpzZWxlY3QpOwogfQpAQCAtNDc5LDcgKzQ4
Niw3IEBAIHN0YXRpYyB1MTYgX19pbml0IHBhcnNlX2l2aGRfZGV2aWNlX3JhbmcKIAogICAgIGZv
ciAoIGJkZiA9IGZpcnN0X2JkZjsgYmRmIDw9IGxhc3RfYmRmOyBiZGYrKyApCiAgICAgICAgIGFk
ZF9pdnJzX21hcHBpbmdfZW50cnkoYmRmLCBiZGYsIHJhbmdlLT5zdGFydC5oZWFkZXIuZGF0YV9z
ZXR0aW5nLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlvbW11KTsKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSwgaW9tbXUpOwogCiAgICAgcmV0dXJuIGRldl9s
ZW5ndGg7CiB9CkBAIC01MTMsNyArNTIwLDggQEAgc3RhdGljIHUxNiBfX2luaXQgcGFyc2VfaXZo
ZF9kZXZpY2VfYWxpYQogCiAgICAgQU1EX0lPTU1VX0RFQlVHKCIgRGV2X0lkIEFsaWFzOiAlI3hc
biIsIGFsaWFzX2lkKTsKIAotICAgIGFkZF9pdnJzX21hcHBpbmdfZW50cnkoYmRmLCBhbGlhc19p
ZCwgYWxpYXMtPmhlYWRlci5kYXRhX3NldHRpbmcsIGlvbW11KTsKKyAgICBhZGRfaXZyc19tYXBw
aW5nX2VudHJ5KGJkZiwgYWxpYXNfaWQsIGFsaWFzLT5oZWFkZXIuZGF0YV9zZXR0aW5nLCB0cnVl
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9tbXUpOwogCiAgICAgcmV0dXJuIGRldl9s
ZW5ndGg7CiB9CkBAIC01NjgsNyArNTc2LDcgQEAgc3RhdGljIHUxNiBfX2luaXQgcGFyc2VfaXZo
ZF9kZXZpY2VfYWxpYQogCiAgICAgZm9yICggYmRmID0gZmlyc3RfYmRmOyBiZGYgPD0gbGFzdF9i
ZGY7IGJkZisrICkKICAgICAgICAgYWRkX2l2cnNfbWFwcGluZ19lbnRyeShiZGYsIGFsaWFzX2lk
LCByYW5nZS0+YWxpYXMuaGVhZGVyLmRhdGFfc2V0dGluZywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpb21tdSk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwg
aW9tbXUpOwogCiAgICAgcmV0dXJuIGRldl9sZW5ndGg7CiB9CkBAIC01OTMsNyArNjAxLDcgQEAg
c3RhdGljIHUxNiBfX2luaXQgcGFyc2VfaXZoZF9kZXZpY2VfZXh0ZQogICAgICAgICByZXR1cm4g
MDsKICAgICB9CiAKLSAgICBhZGRfaXZyc19tYXBwaW5nX2VudHJ5KGJkZiwgYmRmLCBleHQtPmhl
YWRlci5kYXRhX3NldHRpbmcsIGlvbW11KTsKKyAgICBhZGRfaXZyc19tYXBwaW5nX2VudHJ5KGJk
ZiwgYmRmLCBleHQtPmhlYWRlci5kYXRhX3NldHRpbmcsIGZhbHNlLCBpb21tdSk7CiAKICAgICBy
ZXR1cm4gZGV2X2xlbmd0aDsKIH0KQEAgLTY0MCw3ICs2NDgsNyBAQCBzdGF0aWMgdTE2IF9faW5p
dCBwYXJzZV9pdmhkX2RldmljZV9leHRlCiAKICAgICBmb3IgKCBiZGYgPSBmaXJzdF9iZGY7IGJk
ZiA8PSBsYXN0X2JkZjsgYmRmKysgKQogICAgICAgICBhZGRfaXZyc19tYXBwaW5nX2VudHJ5KGJk
ZiwgYmRmLCByYW5nZS0+ZXh0ZW5kZWQuaGVhZGVyLmRhdGFfc2V0dGluZywKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpb21tdSk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZmFsc2UsIGlvbW11KTsKIAogICAgIHJldHVybiBkZXZfbGVuZ3RoOwogfQpAQCAtNzMzLDcg
Kzc0MSw4IEBAIHN0YXRpYyB1MTYgX19pbml0IHBhcnNlX2l2aGRfZGV2aWNlX3NwZWMKICAgICBB
TURfSU9NTVVfREVCVUcoIklWSEQgU3BlY2lhbDogJTA0eDolMDJ4OiUwMnguJXUgdmFyaWV0eSAl
I3ggaGFuZGxlICUjeFxuIiwKICAgICAgICAgICAgICAgICAgICAgc2VnLCBQQ0lfQlVTKGJkZiks
IFBDSV9TTE9UKGJkZiksIFBDSV9GVU5DKGJkZiksCiAgICAgICAgICAgICAgICAgICAgIHNwZWNp
YWwtPnZhcmlldHksIHNwZWNpYWwtPmhhbmRsZSk7Ci0gICAgYWRkX2l2cnNfbWFwcGluZ19lbnRy
eShiZGYsIGJkZiwgc3BlY2lhbC0+aGVhZGVyLmRhdGFfc2V0dGluZywgaW9tbXUpOworICAgIGFk
ZF9pdnJzX21hcHBpbmdfZW50cnkoYmRmLCBiZGYsIHNwZWNpYWwtPmhlYWRlci5kYXRhX3NldHRp
bmcsIHRydWUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBpb21tdSk7CiAKICAgICBzd2l0
Y2ggKCBzcGVjaWFsLT52YXJpZXR5ICkKICAgICB7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdV9pbml0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X2luaXQuYwpAQCAtMzAsNiArMzAsNyBAQAogI2luY2x1ZGUgPHhlbi9kZWxheS5oPgogCiBz
dGF0aWMgaW50IF9faW5pdGRhdGEgbnJfYW1kX2lvbW11czsKK3N0YXRpYyBib29sIF9faW5pdGRh
dGEgcGNpX2luaXQ7CiAKIHN0YXRpYyB2b2lkIGRvX2FtZF9pb21tdV9pcnEodW5zaWduZWQgbG9u
ZyBkYXRhKTsKIHN0YXRpYyBERUNMQVJFX1NPRlRJUlFfVEFTS0xFVChhbWRfaW9tbXVfaXJxX3Rh
c2tsZXQsIGRvX2FtZF9pb21tdV9pcnEsIDApOwpAQCAtMTI0NCwxNyArMTI0NSwyMCBAQCBzdGF0
aWMgaW50IF9faW5pdCBhbWRfaW9tbXVfc2V0dXBfZGV2aWNlCiAKICAgICBCVUdfT04oIChpdnJz
X2JkZl9lbnRyaWVzID09IDApICk7CiAKLSAgICAvKiBhbGxvY2F0ZSAnZGV2aWNlIHRhYmxlJyBv
biBhIDRLIGJvdW5kYXJ5ICovCi0gICAgZGV2aWNlX3RhYmxlLmFsbG9jX3NpemUgPSBQQUdFX1NJ
WkUgPDwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldF9vcmRlcl9mcm9tX2J5dGVz
KAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUEFHRV9BTElHTihpdnJzX2JkZl9lbnRy
aWVzICoKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0RFVl9UQUJMRV9FTlRS
WV9TSVpFKSk7Ci0gICAgZGV2aWNlX3RhYmxlLmVudHJpZXMgPSBkZXZpY2VfdGFibGUuYWxsb2Nf
c2l6ZSAvCi0gICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9ERVZfVEFCTEVfRU5UUllf
U0laRTsKLQotICAgIGRldmljZV90YWJsZS5idWZmZXIgPSBhbGxvY2F0ZV9idWZmZXIoZGV2aWNl
X3RhYmxlLmFsbG9jX3NpemUsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAiRGV2aWNlIFRhYmxlIik7Ci0gICAgaWYgICggZGV2aWNlX3RhYmxlLmJ1ZmZlciA9PSBO
VUxMICkKKyAgICBpZiAoICFkZXZpY2VfdGFibGUuYnVmZmVyICkKKyAgICB7CisgICAgICAgIC8q
IGFsbG9jYXRlICdkZXZpY2UgdGFibGUnIG9uIGEgNEsgYm91bmRhcnkgKi8KKyAgICAgICAgZGV2
aWNlX3RhYmxlLmFsbG9jX3NpemUgPSBQQUdFX1NJWkUgPDwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBnZXRfb3JkZXJfZnJvbV9ieXRlcygKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBQQUdFX0FMSUdOKGl2cnNfYmRmX2VudHJpZXMgKgorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0RFVl9UQUJMRV9FTlRSWV9TSVpFKSk7CisgICAg
ICAgIGRldmljZV90YWJsZS5lbnRyaWVzID0gZGV2aWNlX3RhYmxlLmFsbG9jX3NpemUgLworICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0RFVl9UQUJMRV9FTlRSWV9TSVpFOwor
CisgICAgICAgIGRldmljZV90YWJsZS5idWZmZXIgPSBhbGxvY2F0ZV9idWZmZXIoZGV2aWNlX3Rh
YmxlLmFsbG9jX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIkRldmljZSBUYWJsZSIpOworICAgIH0KKyAgICBpZiAoICFkZXZpY2VfdGFibGUuYnVm
ZmVyICkKICAgICAgICAgcmV0dXJuIC1FTk9NRU07CiAKICAgICAvKiBBZGQgZGV2aWNlIHRhYmxl
IGVudHJpZXMgKi8KQEAgLTEyNjMsMTMgKzEyNjcsNDYgQEAgc3RhdGljIGludCBfX2luaXQgYW1k
X2lvbW11X3NldHVwX2RldmljZQogICAgICAgICBpZiAoIGl2cnNfbWFwcGluZ3NbYmRmXS52YWxp
ZCApCiAgICAgICAgIHsKICAgICAgICAgICAgIHZvaWQgKmR0ZTsKKyAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gTlVMTDsKIAogICAgICAgICAgICAgLyogYWRkIGRldmlj
ZSB0YWJsZSBlbnRyeSAqLwogICAgICAgICAgICAgZHRlID0gZGV2aWNlX3RhYmxlLmJ1ZmZlciAr
IChiZGYgKiBJT01NVV9ERVZfVEFCTEVfRU5UUllfU0laRSk7CiAgICAgICAgICAgICBpb21tdV9k
dGVfYWRkX2RldmljZV9lbnRyeShkdGUsICZpdnJzX21hcHBpbmdzW2JkZl0pOwogCisgICAgICAg
ICAgICBpZiAoIGlvbW11X2ludHJlbWFwICYmCisgICAgICAgICAgICAgICAgIGl2cnNfbWFwcGlu
Z3NbYmRmXS5kdGVfcmVxdWVzdG9yX2lkID09IGJkZiAmJgorICAgICAgICAgICAgICAgICAhaXZy
c19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlICkKKyAgICAgICAgICAgIHsKKyAgICAgICAg
ICAgICAgICBpZiAoICFwY2lfaW5pdCApCisgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwor
ICAgICAgICAgICAgICAgIHBjaWRldnNfbG9jaygpOworICAgICAgICAgICAgICAgIHBkZXYgPSBw
Y2lfZ2V0X3BkZXYoc2VnLCBQQ0lfQlVTKGJkZiksIFBDSV9ERVZGTjIoYmRmKSk7CisgICAgICAg
ICAgICAgICAgcGNpZGV2c191bmxvY2soKTsKKyAgICAgICAgICAgIH0KKworICAgICAgICAgICAg
aWYgKCBwZGV2ICkKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQg
cmVxX2lkID0gYmRmOworCisgICAgICAgICAgICAgICAgZG8geworICAgICAgICAgICAgICAgICAg
ICBpdnJzX21hcHBpbmdzW3JlcV9pZF0uaW50cmVtYXBfdGFibGUgPQorICAgICAgICAgICAgICAg
ICAgICAgICAgYW1kX2lvbW11X2FsbG9jX2ludHJlbWFwX3RhYmxlKAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRmXS5pb21tdSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAmaXZyc19tYXBwaW5nc1tyZXFfaWRdLmludHJlbWFwX2ludXNlKTsKKyAgICAg
ICAgICAgICAgICAgICAgaWYgKCAhaXZyc19tYXBwaW5nc1tyZXFfaWRdLmludHJlbWFwX3RhYmxl
ICkKKyAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOworCisgICAgICAgICAg
ICAgICAgICAgIGlmICggIXBkZXYtPnBoYW50b21fc3RyaWRlICkKKyAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOworICAgICAgICAgICAgICAgICAgICByZXFfaWQgKz0gcGRldi0+cGhhbnRv
bV9zdHJpZGU7CisgICAgICAgICAgICAgICAgfSB3aGlsZSAoIFBDSV9TTE9UKHJlcV9pZCkgPT0g
cGRldi0+c2JkZi5kZXYgKTsKKyAgICAgICAgICAgIH0KKwogICAgICAgICAgICAgYW1kX2lvbW11
X3NldF9pbnRyZW1hcF90YWJsZSgKLSAgICAgICAgICAgICAgICBkdGUsIHZpcnRfdG9fbWFkZHIo
aXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlKSwKKyAgICAgICAgICAgICAgICBkdGUs
CisgICAgICAgICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlCisgICAg
ICAgICAgICAgICAgPyB2aXJ0X3RvX21hZGRyKGl2cnNfbWFwcGluZ3NbYmRmXS5pbnRyZW1hcF90
YWJsZSkKKyAgICAgICAgICAgICAgICA6IDAsCiAgICAgICAgICAgICAgICAgaW9tbXVfaW50cmVt
YXApOwogICAgICAgICB9CiAgICAgfQpAQCAtMTQwMiw3ICsxNDM5LDggQEAgaW50IF9faW5pdCBh
bWRfaW9tbXVfaW5pdChib29sIHh0KQogICAgIGlmICggcmMgKQogICAgICAgICBnb3RvIGVycm9y
X291dDsKIAotICAgIC8qIGFsbG9jYXRlIGFuZCBpbml0aWFsaXplIGEgZ2xvYmFsIGRldmljZSB0
YWJsZSBzaGFyZWQgYnkgYWxsIGlvbW11cyAqLworICAgIC8qIEFsbG9jYXRlIGFuZCBpbml0aWFs
aXplIGRldmljZSB0YWJsZShzKS4gKi8KKyAgICBwY2lfaW5pdCA9ICF4dDsKICAgICByYyA9IGl0
ZXJhdGVfaXZyc19tYXBwaW5ncyhhbWRfaW9tbXVfc2V0dXBfZGV2aWNlX3RhYmxlKTsKICAgICBp
ZiAoIHJjICkKICAgICAgICAgZ290byBlcnJvcl9vdXQ7CkBAIC0xNDIyLDcgKzE0NjAsNyBAQCBp
bnQgX19pbml0IGFtZF9pb21tdV9pbml0KGJvb2wgeHQpCiAgICAgICAgIC8qCiAgICAgICAgICAq
IFNldHRpbmcgdXAgb2YgdGhlIElPTU1VIGludGVycnVwdHMgY2Fubm90IG9jY3VyIHlldCBhdCB0
aGUgKHZlcnkKICAgICAgICAgICogZWFybHkpIHRpbWUgd2UgZ2V0IGhlcmUgd2hlbiBlbmFibGlu
ZyB4MkFQSUMgbW9kZS4gU3VwcHJlc3MgaXQKLSAgICAgICAgICogaGVyZSwgYW5kIGRvIGl0IGV4
cGxpY2l0bHkgaW4gYW1kX2lvbW11X2luaXRfaW50ZXJydXB0KCkuCisgICAgICAgICAqIGhlcmUs
IGFuZCBkbyBpdCBleHBsaWNpdGx5IGluIGFtZF9pb21tdV9pbml0X2xhdGUoKS4KICAgICAgICAg
ICovCiAgICAgICAgIHJjID0gYW1kX2lvbW11X2luaXRfb25lKGlvbW11LCAheHQpOwogICAgICAg
ICBpZiAoIHJjICkKQEAgLTE0MzYsMTEgKzE0NzQsMTYgQEAgZXJyb3Jfb3V0OgogICAgIHJldHVy
biByYzsKIH0KIAotaW50IF9faW5pdCBhbWRfaW9tbXVfaW5pdF9pbnRlcnJ1cHQodm9pZCkKK2lu
dCBfX2luaXQgYW1kX2lvbW11X2luaXRfbGF0ZSh2b2lkKQogewogICAgIHN0cnVjdCBhbWRfaW9t
bXUgKmlvbW11OwogICAgIGludCByYyA9IDA7CiAKKyAgICAvKiBGdXJ0aGVyIGluaXRpYWxpemUg
dGhlIGRldmljZSB0YWJsZShzKS4gKi8KKyAgICBwY2lfaW5pdCA9IHRydWU7CisgICAgaWYgKCBp
b21tdV9pbnRyZW1hcCApCisgICAgICAgIHJjID0gaXRlcmF0ZV9pdnJzX21hcHBpbmdzKGFtZF9p
b21tdV9zZXR1cF9kZXZpY2VfdGFibGUpOworCiAgICAgZm9yX2VhY2hfYW1kX2lvbW11ICggaW9t
bXUgKQogICAgIHsKICAgICAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjOwotLS0gYS94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50ci5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMKQEAgLTc4OSw3ICs3ODksNyBAQCB2b2lkIGFtZF9pb21t
dV9yZWFkX21zaV9mcm9tX2lyZSgKICAgICB9CiB9CiAKLWludCBfX2luaXQgYW1kX2lvbW11X2Zy
ZWVfaW50cmVtYXBfdGFibGUoCitpbnQgYW1kX2lvbW11X2ZyZWVfaW50cmVtYXBfdGFibGUoCiAg
ICAgY29uc3Qgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsIHN0cnVjdCBpdnJzX21hcHBpbmdzICpp
dnJzX21hcHBpbmcpCiB7CiAgICAgdm9pZCAqKnRibHA7CkBAIC04MTQsNyArODE0LDcgQEAgaW50
IF9faW5pdCBhbWRfaW9tbXVfZnJlZV9pbnRyZW1hcF90YWJsZQogICAgIHJldHVybiAwOwogfQog
Ci12b2lkICpfX2luaXQgYW1kX2lvbW11X2FsbG9jX2ludHJlbWFwX3RhYmxlKAordm9pZCAqYW1k
X2lvbW11X2FsbG9jX2ludHJlbWFwX3RhYmxlKAogICAgIGNvbnN0IHN0cnVjdCBhbWRfaW9tbXUg
KmlvbW11LCB1bnNpZ25lZCBsb25nICoqaW51c2VfbWFwKQogewogICAgIHVuc2lnbmVkIGludCBv
cmRlciA9IGludHJlbWFwX3RhYmxlX29yZGVyKGlvbW11KTsKLS0tIGEveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdV9tYXAuYwpAQCAtMTE2LDggKzExNiw5IEBAIHZvaWQgX19pbml0IGFtZF9pb21tdV9z
ZXRfaW50cmVtYXBfdGFibGUKICAgICBzdHJ1Y3QgYW1kX2lvbW11X2R0ZSAqZHRlLCB1aW50NjRf
dCBpbnRyZW1hcF9wdHIsIGJvb2wgdmFsaWQpCiB7CiAgICAgZHRlLT5pdF9yb290ID0gaW50cmVt
YXBfcHRyID4+IDY7Ci0gICAgZHRlLT5pbnRfdGFiX2xlbiA9IElPTU1VX0lOVFJFTUFQX09SREVS
OwotICAgIGR0ZS0+aW50X2N0bCA9IElPTU1VX0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9UUkFOU0xB
VEVEOworICAgIGR0ZS0+aW50X3RhYl9sZW4gPSBpbnRyZW1hcF9wdHIgPyBJT01NVV9JTlRSRU1B
UF9PUkRFUiA6IDA7CisgICAgZHRlLT5pbnRfY3RsID0gaW50cmVtYXBfcHRyID8gSU9NTVVfREVW
X1RBQkxFX0lOVF9DT05UUk9MX1RSQU5TTEFURUQKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOiBJT01NVV9ERVZfVEFCTEVfSU5UX0NPTlRST0xfQUJPUlRFRDsKICAgICBkdGUtPmln
ID0gZmFsc2U7IC8qIHVubWFwcGVkIGludGVycnVwdHMgcmVzdWx0IGluIGkvbyBwYWdlIGZhdWx0
cyAqLwogICAgIGR0ZS0+aXYgPSB2YWxpZDsKIH0KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL3BjaV9hbWRfaW9tbXUuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
cGNpX2FtZF9pb21tdS5jCkBAIC0xNjQsNyArMTY0LDcgQEAgc3RhdGljIGludCBfX2luaXQgaW92
X2RldGVjdCh2b2lkKQogICAgIGlmICggIWlvbW11X2VuYWJsZSAmJiAhaW9tbXVfaW50cmVtYXAg
KQogICAgICAgICByZXR1cm4gMDsKIAotICAgIGlmICggKGluaXRfZG9uZSA/IGFtZF9pb21tdV9p
bml0X2ludGVycnVwdCgpCisgICAgaWYgKCAoaW5pdF9kb25lID8gYW1kX2lvbW11X2luaXRfbGF0
ZSgpCiAgICAgICAgICAgICAgICAgICAgIDogYW1kX2lvbW11X2luaXQoZmFsc2UpKSAhPSAwICkK
ICAgICB7CiAgICAgICAgIHByaW50aygiQU1ELVZpOiBFcnJvciBpbml0aWFsaXphdGlvblxuIik7
CkBAIC00MjgsNiArNDI4LDcgQEAgc3RhdGljIGludCBhbWRfaW9tbXVfYWRkX2RldmljZSh1OCBk
ZXZmbgogewogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAgIHUxNiBiZGY7CisgICAg
c3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3M7CiAKICAgICBpZiAoICFwZGV2LT5k
b21haW4gKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKQEAgLTQ1Nyw2ICs0NTgsMzYgQEAgc3Rh
dGljIGludCBhbWRfaW9tbXVfYWRkX2RldmljZSh1OCBkZXZmbgogICAgICAgICByZXR1cm4gLUVO
T0RFVjsKICAgICB9CiAKKyAgICBpdnJzX21hcHBpbmdzID0gZ2V0X2l2cnNfbWFwcGluZ3MocGRl
di0+c2VnKTsKKyAgICBiZGYgPSBQQ0lfQkRGMihwZGV2LT5idXMsIGRldmZuKTsKKyAgICBpZiAo
ICFpdnJzX21hcHBpbmdzIHx8CisgICAgICAgICAhaXZyc19tYXBwaW5nc1tpdnJzX21hcHBpbmdz
W2JkZl0uZHRlX3JlcXVlc3Rvcl9pZF0udmFsaWQgKQorICAgICAgICByZXR1cm4gLUVQRVJNOwor
CisgICAgaWYgKCBpb21tdV9pbnRyZW1hcCAmJgorICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZd
LmR0ZV9yZXF1ZXN0b3JfaWQgPT0gYmRmICYmCisgICAgICAgICAhaXZyc19tYXBwaW5nc1tiZGZd
LmludHJlbWFwX3RhYmxlICkKKyAgICB7CisgICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CisK
KyAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZdLmludHJlbWFwX3RhYmxlID0KKyAgICAgICAgICAg
IGFtZF9pb21tdV9hbGxvY19pbnRyZW1hcF90YWJsZSgKKyAgICAgICAgICAgICAgICBpb21tdSwg
Jml2cnNfbWFwcGluZ3NbYmRmXS5pbnRyZW1hcF9pbnVzZSk7CisgICAgICAgIGlmICggIWl2cnNf
bWFwcGluZ3NbYmRmXS5pbnRyZW1hcF90YWJsZSApCisgICAgICAgICAgICByZXR1cm4gLUVOT01F
TTsKKworICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKKwor
ICAgICAgICBhbWRfaW9tbXVfc2V0X2ludHJlbWFwX3RhYmxlKAorICAgICAgICAgICAgaW9tbXUt
PmRldl90YWJsZS5idWZmZXIgKyAoYmRmICogSU9NTVVfREVWX1RBQkxFX0VOVFJZX1NJWkUpLAor
ICAgICAgICAgICAgdmlydF90b19tYWRkcihpdnJzX21hcHBpbmdzW2JkZl0uaW50cmVtYXBfdGFi
bGUpLAorICAgICAgICAgICAgaW9tbXVfaW50cmVtYXApOworCisgICAgICAgIGFtZF9pb21tdV9m
bHVzaF9kZXZpY2UoaW9tbXUsIGJkZik7CisKKyAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKKyAgICB9CisKICAgICBhbWRfaW9tbXVfc2V0dXBfZG9t
YWluX2RldmljZShwZGV2LT5kb21haW4sIGlvbW11LCBkZXZmbiwgcGRldik7CiAgICAgcmV0dXJu
IDA7CiB9CkBAIC00NjUsNiArNDk2LDggQEAgc3RhdGljIGludCBhbWRfaW9tbXVfcmVtb3ZlX2Rl
dmljZSh1OCBkZQogewogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAgIHUxNiBiZGY7
CisgICAgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZ3M7CisKICAgICBpZiAoICFw
ZGV2LT5kb21haW4gKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIApAQCAtNDgwLDYgKzUxMywx
NCBAQCBzdGF0aWMgaW50IGFtZF9pb21tdV9yZW1vdmVfZGV2aWNlKHU4IGRlCiAgICAgfQogCiAg
ICAgYW1kX2lvbW11X2Rpc2FibGVfZG9tYWluX2RldmljZShwZGV2LT5kb21haW4sIGlvbW11LCBk
ZXZmbiwgcGRldik7CisKKyAgICBpdnJzX21hcHBpbmdzID0gZ2V0X2l2cnNfbWFwcGluZ3MocGRl
di0+c2VnKTsKKyAgICBiZGYgPSBQQ0lfQkRGMihwZGV2LT5idXMsIGRldmZuKTsKKyAgICBpZiAo
IGFtZF9pb21tdV9wZXJkZXZfaW50cmVtYXAgJiYKKyAgICAgICAgIGl2cnNfbWFwcGluZ3NbYmRm
XS5kdGVfcmVxdWVzdG9yX2lkID09IGJkZiAmJgorICAgICAgICAgaXZyc19tYXBwaW5nc1tiZGZd
LmludHJlbWFwX3RhYmxlICkKKyAgICAgICAgYW1kX2lvbW11X2ZyZWVfaW50cmVtYXBfdGFibGUo
aW9tbXUsICZpdnJzX21hcHBpbmdzW2JkZl0pOworCiAgICAgcmV0dXJuIDA7CiB9CiAKLS0tIGEv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21tdS1wcm90by5oCisrKyBiL3hlbi9p
bmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtcHJvdG8uaApAQCAtNTAsNyArNTAsNyBA
QCB2b2lkIGdldF9pb21tdV9mZWF0dXJlcyhzdHJ1Y3QgYW1kX2lvbW11CiAvKiBhbWQtaW9tbXUt
aW5pdCBmdW5jdGlvbnMgKi8KIGludCBhbWRfaW9tbXVfcHJlcGFyZShib29sIHh0KTsKIGludCBh
bWRfaW9tbXVfaW5pdChib29sIHh0KTsKLWludCBhbWRfaW9tbXVfaW5pdF9pbnRlcnJ1cHQodm9p
ZCk7CitpbnQgYW1kX2lvbW11X2luaXRfbGF0ZSh2b2lkKTsKIGludCBhbWRfaW9tbXVfdXBkYXRl
X2l2cnNfbWFwcGluZ19hY3BpKHZvaWQpOwogaW50IGlvdl9hZGp1c3RfaXJxX2FmZmluaXRpZXMo
dm9pZCk7CiAKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpo
dHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

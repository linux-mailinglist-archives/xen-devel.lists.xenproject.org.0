Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B99DA1240A8
	for <lists+xen-devel@lfdr.de>; Wed, 18 Dec 2019 08:52:55 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ihU5U-0003sQ-A2; Wed, 18 Dec 2019 07:49:40 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=NgR6=2I=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1ihU5T-0003rv-60
 for xen-devel@lists.xenproject.org; Wed, 18 Dec 2019 07:49:39 +0000
X-Inumbo-ID: df03c954-216a-11ea-b6f1-bc764e2007e4
Received: from mx2.suse.de (unknown [195.135.220.15])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id df03c954-216a-11ea-b6f1-bc764e2007e4;
 Wed, 18 Dec 2019 07:49:08 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx2.suse.de (Postfix) with ESMTP id 195D5AF27;
 Wed, 18 Dec 2019 07:49:05 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Wed, 18 Dec 2019 08:48:59 +0100
Message-Id: <20191218074859.21665-10-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20191218074859.21665-1-jgross@suse.com>
References: <20191218074859.21665-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 9/9] xen/sched: add const qualifier where
 appropriate
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>,
 Stewart Hildebrand <stewart.hildebrand@dornerworks.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TWFrZSB1c2Ugb2YgdGhlIGNvbnN0IHF1YWxpZmllciBtb3JlIG9mdGVuIGluIHNjaGVkdWxpbmcg
Y29kZS4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KLS0t
CiB4ZW4vY29tbW9uL3NjaGVkL2NwdXBvb2wuYyAgICAgICAgfCAgMiArLQogeGVuL2NvbW1vbi9z
Y2hlZC9zY2hlZF9hcmluYzY1My5jIHwgIDQgKy0tCiB4ZW4vY29tbW9uL3NjaGVkL3NjaGVkX2Ny
ZWRpdC5jICAgfCA0NCArKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0KIHhlbi9jb21t
b24vc2NoZWQvc2NoZWRfY3JlZGl0Mi5jICB8IDUyICsrKysrKysrKysrKysrKysrKysrLS0tLS0t
LS0tLS0tLS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9udWxsLmMgICAgIHwgMTcgKysr
KysrKy0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9ydC5jICAgICAgIHwgMzIgKysrKysr
KysrKysrLS0tLS0tLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkL3NjaGVkdWxlLmMgICAgICAgfCAy
NSArKysrKysrKysrLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCAgICAgICAgICAg
fCAgOSArKysrLS0tCiA4IGZpbGVzIGNoYW5nZWQsIDk2IGluc2VydGlvbnMoKyksIDg5IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWQvY3B1cG9vbC5jIGIveGVuL2Nv
bW1vbi9zY2hlZC9jcHVwb29sLmMKaW5kZXggMTQyMTJiYjRhZS4uYTZjMDRjNDZjYiAxMDA2NDQK
LS0tIGEveGVuL2NvbW1vbi9zY2hlZC9jcHVwb29sLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZC9j
cHVwb29sLmMKQEAgLTg4Miw3ICs4ODIsNyBAQCBpbnQgY3B1cG9vbF9nZXRfaWQoY29uc3Qgc3Ry
dWN0IGRvbWFpbiAqZCkKICAgICByZXR1cm4gZC0+Y3B1cG9vbCA/IGQtPmNwdXBvb2wtPmNwdXBv
b2xfaWQgOiBDUFVQT09MSURfTk9ORTsKIH0KIAotY3B1bWFza190ICpjcHVwb29sX3ZhbGlkX2Nw
dXMoc3RydWN0IGNwdXBvb2wgKnBvb2wpCitjb25zdCBjcHVtYXNrX3QgKmNwdXBvb2xfdmFsaWRf
Y3B1cyhjb25zdCBzdHJ1Y3QgY3B1cG9vbCAqcG9vbCkKIHsKICAgICByZXR1cm4gcG9vbC0+Y3B1
X3ZhbGlkOwogfQpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9hcmluYzY1My5j
IGIveGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9hcmluYzY1My5jCmluZGV4IGRjNDUzNzg5NTIuLjBk
ZTRiYTZiMmMgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWQvc2NoZWRfYXJpbmM2NTMuYwor
KysgYi94ZW4vY29tbW9uL3NjaGVkL3NjaGVkX2FyaW5jNjUzLmMKQEAgLTYwOCw3ICs2MDgsNyBA
QCBzdGF0aWMgc3RydWN0IHNjaGVkX3Jlc291cmNlICoKIGE2NTNzY2hlZF9waWNrX3Jlc291cmNl
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewotICAgIGNwdW1hc2tfdCAqb25saW5lOwor
ICAgIGNvbnN0IGNwdW1hc2tfdCAqb25saW5lOwogICAgIHVuc2lnbmVkIGludCBjcHU7CiAKICAg
ICAvKgpAQCAtNjM5LDcgKzYzOSw3IEBAIGE2NTNfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVs
ZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAgICAgICAgICAgICAgICAgICB2b2lkICpw
ZGF0YSwgdm9pZCAqdmRhdGEpCiB7CiAgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdl
dF9zY2hlZF9yZXMoY3B1KTsKLSAgICBhcmluYzY1M191bml0X3QgKnN2YyA9IHZkYXRhOworICAg
IGNvbnN0IGFyaW5jNjUzX3VuaXRfdCAqc3ZjID0gdmRhdGE7CiAKICAgICBBU1NFUlQoIXBkYXRh
ICYmIHN2YyAmJiBpc19pZGxlX3VuaXQoc3ZjLT51bml0KSk7CiAKZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vc2NoZWQvc2NoZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkL3NjaGVkX2NyZWRp
dC5jCmluZGV4IDA1OTMwMjYxZDkuLmYyZmMxY2NhNWEgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
c2NoZWQvc2NoZWRfY3JlZGl0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9jcmVkaXQu
YwpAQCAtMjMzLDcgKzIzMyw3IEBAIHN0YXRpYyB2b2lkIGNzY2hlZF90aWNrKHZvaWQgKl9jcHUp
Owogc3RhdGljIHZvaWQgY3NjaGVkX2FjY3Qodm9pZCAqZHVtbXkpOwogCiBzdGF0aWMgaW5saW5l
IGludAotX191bml0X29uX3J1bnEoc3RydWN0IGNzY2hlZF91bml0ICpzdmMpCitfX3VuaXRfb25f
cnVucShjb25zdCBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnN2YykKIHsKICAgICByZXR1cm4gIWxpc3Rf
ZW1wdHkoJnN2Yy0+cnVucV9lbGVtKTsKIH0KQEAgLTM0OSwxMSArMzQ5LDExIEBAIGJvb2xlYW5f
cGFyYW0oInRpY2tsZV9vbmVfaWRsZV9jcHUiLCBvcHRfdGlja2xlX29uZV9pZGxlKTsKIAogREVG
SU5FX1BFUl9DUFUodW5zaWduZWQgaW50LCBsYXN0X3RpY2tsZV9jcHUpOwogCi1zdGF0aWMgaW5s
aW5lIHZvaWQgX19ydW5xX3RpY2tsZShzdHJ1Y3QgY3NjaGVkX3VuaXQgKm5ldykKK3N0YXRpYyBp
bmxpbmUgdm9pZCBfX3J1bnFfdGlja2xlKGNvbnN0IHN0cnVjdCBjc2NoZWRfdW5pdCAqbmV3KQog
ewogICAgIHVuc2lnbmVkIGludCBjcHUgPSBzY2hlZF91bml0X21hc3RlcihuZXctPnVuaXQpOwot
ICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBnZXRfc2NoZWRfcmVzKGNwdSk7Ci0gICAg
c3RydWN0IHNjaGVkX3VuaXQgKnVuaXQgPSBuZXctPnVuaXQ7CisgICAgY29uc3Qgc3RydWN0IHNj
aGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBjb25zdCBzdHJ1Y3Qg
c2NoZWRfdW5pdCAqdW5pdCA9IG5ldy0+dW5pdDsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKiBj
b25zdCBjdXIgPSBDU0NIRURfVU5JVChjdXJyX29uX2NwdShjcHUpKTsKICAgICBzdHJ1Y3QgY3Nj
aGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKHNyLT5zY2hlZHVsZXIpOwogICAgIGNwdW1h
c2tfdCBtYXNrLCBpZGxlX21hc2ssICpvbmxpbmU7CkBAIC01MDksNyArNTA5LDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIF9fcnVucV90aWNrbGUoc3RydWN0IGNzY2hlZF91bml0ICpuZXcpCiBzdGF0
aWMgdm9pZAogY3NjaGVkX2ZyZWVfcGRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2
b2lkICpwY3B1LCBpbnQgY3B1KQogewotICAgIHN0cnVjdCBjc2NoZWRfcHJpdmF0ZSAqcHJ2ID0g
Q1NDSEVEX1BSSVYob3BzKTsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9
IENTQ0hFRF9QUklWKG9wcyk7CiAKICAgICAvKgogICAgICAqIHBjcHUgZWl0aGVyIHBvaW50cyB0
byBhIHZhbGlkIHN0cnVjdCBjc2NoZWRfcGNwdSwgb3IgaXMgTlVMTCwgaWYgd2UncmUKQEAgLTY1
Miw3ICs2NTIsNyBAQCBjc2NoZWRfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19v
cHMsIHVuc2lnbmVkIGludCBjcHUsCiAKICNpZm5kZWYgTkRFQlVHCiBzdGF0aWMgaW5saW5lIHZv
aWQKLV9fY3NjaGVkX3VuaXRfY2hlY2soc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCitfX2NzY2hl
ZF91bml0X2NoZWNrKGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAgIHN0cnVj
dCBjc2NoZWRfdW5pdCAqIGNvbnN0IHN2YyA9IENTQ0hFRF9VTklUKHVuaXQpOwogICAgIHN0cnVj
dCBjc2NoZWRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKQEAgLTcwMCw4ICs3MDAsOCBA
QCBfX2NzY2hlZF92Y3B1X2lzX2NhY2hlX2hvdChjb25zdCBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUg
KnBydiwKIAogc3RhdGljIGlubGluZSBpbnQKIF9fY3NjaGVkX3VuaXRfaXNfbWlncmF0ZWFibGUo
Y29uc3Qgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpbnQgZGVzdF9jcHUsIGNwdW1hc2tfdCAqbWFzaykKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBkZXN0X2NwdSwgY29uc3QgY3B1bWFza190ICptYXNrKQogewogICAg
IGNvbnN0IHN0cnVjdCBjc2NoZWRfdW5pdCAqc3ZjID0gQ1NDSEVEX1VOSVQodW5pdCk7CiAgICAg
LyoKQEAgLTcyNSw3ICs3MjUsNyBAQCBfY3NjaGVkX2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsCiAgICAgLyogV2UgbXVz
dCBhbHdheXMgdXNlIGNwdSdzIHNjcmF0Y2ggc3BhY2UgKi8KICAgICBjcHVtYXNrX3QgKmNwdXMg
PSBjcHVtYXNrX3NjcmF0Y2hfY3B1KGNwdSk7CiAgICAgY3B1bWFza190IGlkbGVyczsKLSAgICBj
cHVtYXNrX3QgKm9ubGluZSA9IGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVtYXNrKHVuaXQtPmRv
bWFpbik7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmUgPSBjcHVwb29sX2RvbWFpbl9tYXN0
ZXJfY3B1bWFzayh1bml0LT5kb21haW4pOwogICAgIHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjID0g
TlVMTDsKICAgICBpbnQgYmFsYW5jZV9zdGVwOwogCkBAIC05MzIsNyArOTMyLDcgQEAgY3NjaGVk
X3VuaXRfYWNjdChzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwgdW5zaWduZWQgaW50IGNwdSkK
IHsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqY3VycnVuaXQgPSBjdXJyZW50LT5zY2hlZF91bml0
OwogICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqIGNvbnN0IHN2YyA9IENTQ0hFRF9VTklUKGN1cnJ1
bml0KTsKLSAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUp
OworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBnZXRfc2NoZWRfcmVzKGNw
dSk7CiAgICAgY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzID0gc3ItPnNjaGVkdWxlcjsKIAog
ICAgIEFTU0VSVCggc2NoZWRfdW5pdF9tYXN0ZXIoY3VycnVuaXQpID09IGNwdSApOwpAQCAtMTA4
NCw3ICsxMDg0LDcgQEAgY3NjaGVkX3VuaXRfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQg
KiBjb25zdCBzdmMgPSBDU0NIRURfVU5JVCh1bml0KTsKICAgICB1bnNpZ25lZCBpbnQgY3B1ID0g
c2NoZWRfdW5pdF9tYXN0ZXIodW5pdCk7Ci0gICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9
IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBjb25zdCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNy
ID0gZ2V0X3NjaGVkX3JlcyhjcHUpOwogCiAgICAgU0NIRURfU1RBVF9DUkFOSyh1bml0X3NsZWVw
KTsKIApAQCAtMTU3Nyw3ICsxNTc3LDcgQEAgc3RhdGljIHZvaWQKIGNzY2hlZF90aWNrKHZvaWQg
Kl9jcHUpCiB7CiAgICAgdW5zaWduZWQgaW50IGNwdSA9ICh1bnNpZ25lZCBsb25nKV9jcHU7Ci0g
ICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBj
b25zdCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUpOwogICAg
IHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjID0gQ1NDSEVEX1BDUFUoY3B1KTsKICAgICBzdHJ1Y3Qg
Y3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklWKHNyLT5zY2hlZHVsZXIpOwogCkBAIC0x
NjA0LDcgKzE2MDQsNyBAQCBjc2NoZWRfdGljayh2b2lkICpfY3B1KQogc3RhdGljIHN0cnVjdCBj
c2NoZWRfdW5pdCAqCiBjc2NoZWRfcnVucV9zdGVhbChpbnQgcGVlcl9jcHUsIGludCBjcHUsIGlu
dCBwcmksIGludCBiYWxhbmNlX3N0ZXApCiB7Ci0gICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpz
ciA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAgICBjb25zdCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2Ug
KnNyID0gZ2V0X3NjaGVkX3JlcyhjcHUpOwogICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfcHJpdmF0
ZSAqIGNvbnN0IHBydiA9IENTQ0hFRF9QUklWKHNyLT5zY2hlZHVsZXIpOwogICAgIGNvbnN0IHN0
cnVjdCBjc2NoZWRfcGNwdSAqIGNvbnN0IHBlZXJfcGNwdSA9IENTQ0hFRF9QQ1BVKHBlZXJfY3B1
KTsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnNwZWVyOwpAQCAtMTY4MSwxMCArMTY4MSwxMCBA
QCBzdGF0aWMgc3RydWN0IGNzY2hlZF91bml0ICoKIGNzY2hlZF9sb2FkX2JhbGFuY2Uoc3RydWN0
IGNzY2hlZF9wcml2YXRlICpwcnYsIGludCBjcHUsCiAgICAgc3RydWN0IGNzY2hlZF91bml0ICpz
bmV4dCwgYm9vbCAqc3RvbGVuKQogewotICAgIHN0cnVjdCBjcHVwb29sICpjID0gZ2V0X3NjaGVk
X3JlcyhjcHUpLT5jcHVwb29sOworICAgIGNvbnN0IHN0cnVjdCBjcHVwb29sICpjID0gZ2V0X3Nj
aGVkX3JlcyhjcHUpLT5jcHVwb29sOwogICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqc3BlZXI7CiAg
ICAgY3B1bWFza190IHdvcmtlcnM7Ci0gICAgY3B1bWFza190ICpvbmxpbmUgPSBjLT5yZXNfdmFs
aWQ7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmUgPSBjLT5yZXNfdmFsaWQ7CiAgICAgaW50
IHBlZXJfY3B1LCBmaXJzdF9jcHUsIHBlZXJfbm9kZSwgYnN0ZXA7CiAgICAgaW50IG5vZGUgPSBj
cHVfdG9fbm9kZShjcHUpOwogCkBAIC0yMDA4LDcgKzIwMDgsNyBAQCBvdXQ6CiB9CiAKIHN0YXRp
YyB2b2lkCi1jc2NoZWRfZHVtcF91bml0KHN0cnVjdCBjc2NoZWRfdW5pdCAqc3ZjKQorY3NjaGVk
X2R1bXBfdW5pdChjb25zdCBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnN2YykKIHsKICAgICBzdHJ1Y3Qg
Y3NjaGVkX2RvbSAqIGNvbnN0IHNkb20gPSBzdmMtPnNkb207CiAKQEAgLTIwNDEsMTAgKzIwNDEs
MTEgQEAgY3NjaGVkX2R1bXBfdW5pdChzdHJ1Y3QgY3NjaGVkX3VuaXQgKnN2YykKIHN0YXRpYyB2
b2lkCiBjc2NoZWRfZHVtcF9wY3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgaW50IGNw
dSkKIHsKLSAgICBzdHJ1Y3QgbGlzdF9oZWFkICpydW5xLCAqaXRlcjsKKyAgICBjb25zdCBzdHJ1
Y3QgbGlzdF9oZWFkICpydW5xOworICAgIHN0cnVjdCBsaXN0X2hlYWQgKml0ZXI7CiAgICAgc3Ry
dWN0IGNzY2hlZF9wcml2YXRlICpwcnYgPSBDU0NIRURfUFJJVihvcHMpOwotICAgIHN0cnVjdCBj
c2NoZWRfcGNwdSAqc3BjOwotICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqc3ZjOworICAgIGNvbnN0
IHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfdW5pdCAq
c3ZjOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKICAg
ICBpbnQgbG9vcDsKQEAgLTIxMzIsMTIgKzIxMzMsMTMgQEAgY3NjaGVkX2R1bXAoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzKQogICAgIGxvb3AgPSAwOwogICAgIGxpc3RfZm9yX2VhY2goIGl0
ZXJfc2RvbSwgJnBydi0+YWN0aXZlX3Nkb20gKQogICAgIHsKLSAgICAgICAgc3RydWN0IGNzY2hl
ZF9kb20gKnNkb207CisgICAgICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfZG9tICpzZG9tOworCiAg
ICAgICAgIHNkb20gPSBsaXN0X2VudHJ5KGl0ZXJfc2RvbSwgc3RydWN0IGNzY2hlZF9kb20sIGFj
dGl2ZV9zZG9tX2VsZW0pOwogCiAgICAgICAgIGxpc3RfZm9yX2VhY2goIGl0ZXJfc3ZjLCAmc2Rv
bS0+YWN0aXZlX3VuaXQgKQogICAgICAgICB7Ci0gICAgICAgICAgICBzdHJ1Y3QgY3NjaGVkX3Vu
aXQgKnN2YzsKKyAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBjc2NoZWRfdW5pdCAqc3ZjOwogICAg
ICAgICAgICAgc3BpbmxvY2tfdCAqbG9jazsKIAogICAgICAgICAgICAgc3ZjID0gbGlzdF9lbnRy
eShpdGVyX3N2Yywgc3RydWN0IGNzY2hlZF91bml0LCBhY3RpdmVfdW5pdF9lbGVtKTsKZGlmZiAt
LWdpdCBhL3hlbi9jb21tb24vc2NoZWQvc2NoZWRfY3JlZGl0Mi5jIGIveGVuL2NvbW1vbi9zY2hl
ZC9zY2hlZF9jcmVkaXQyLmMKaW5kZXggZjllNTIxYTNhOC4uMWVkN2JiZGUyZiAxMDA2NDQKLS0t
IGEveGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9jcmVkaXQyLmMKKysrIGIveGVuL2NvbW1vbi9zY2hl
ZC9zY2hlZF9jcmVkaXQyLmMKQEAgLTY5Miw3ICs2OTIsNyBAQCB2b2lkIHNtdF9pZGxlX21hc2tf
Y2xlYXIodW5zaWduZWQgaW50IGNwdSwgY3B1bWFza190ICptYXNrKQogICovCiBzdGF0aWMgaW50
IGdldF9mYWxsYmFja19jcHUoc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjKQogewotICAgIHN0cnVj
dCBzY2hlZF91bml0ICp1bml0ID0gc3ZjLT51bml0OworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF91
bml0ICp1bml0ID0gc3ZjLT51bml0OwogICAgIHVuc2lnbmVkIGludCBiczsKIAogICAgIFNDSEVE
X1NUQVRfQ1JBTksobmVlZF9mYWxsYmFja19jcHUpOwpAQCAtNzc0LDcgKzc3NCw3IEBAIHN0YXRp
YyBpbnQgZ2V0X2ZhbGxiYWNrX2NwdShzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMpCiAgKgogICog
RklYTUU6IERvIHByZS1jYWxjdWxhdGVkIGRpdmlzaW9uPwogICovCi1zdGF0aWMgdm9pZCB0MmNf
dXBkYXRlKHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwgc190aW1lX3QgdGltZSwK
K3N0YXRpYyB2b2lkIHQyY191cGRhdGUoY29uc3Qgc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0
YSAqcnFkLCBzX3RpbWVfdCB0aW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
Y3NjaGVkMl91bml0ICpzdmMpCiB7CiAgICAgdWludDY0X3QgdmFsID0gdGltZSAqIHJxZC0+bWF4
X3dlaWdodCArIHN2Yy0+cmVzaWR1YWw7CkBAIC03ODMsNyArNzgzLDggQEAgc3RhdGljIHZvaWQg
dDJjX3VwZGF0ZShzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQsIHNfdGltZV90IHRp
bWUsCiAgICAgc3ZjLT5jcmVkaXQgLT0gdmFsOwogfQogCi1zdGF0aWMgc190aW1lX3QgYzJ0KHN0
cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwgc190aW1lX3QgY3JlZGl0LCBzdHJ1Y3Qg
Y3NjaGVkMl91bml0ICpzdmMpCitzdGF0aWMgc190aW1lX3QgYzJ0KGNvbnN0IHN0cnVjdCBjc2No
ZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwgc190aW1lX3QgY3JlZGl0LAorICAgICAgICAgICAgICAg
ICAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMpCiB7CiAgICAgcmV0dXJuIGNyZWRp
dCAqIHN2Yy0+d2VpZ2h0IC8gcnFkLT5tYXhfd2VpZ2h0OwogfQpAQCAtNzkyLDcgKzc5Myw3IEBA
IHN0YXRpYyBzX3RpbWVfdCBjMnQoc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFkLCBz
X3RpbWVfdCBjcmVkaXQsIHN0cnVjdCBjCiAgKiBSdW5xdWV1ZSByZWxhdGVkIGNvZGUuCiAgKi8K
IAotc3RhdGljIGlubGluZSBpbnQgdW5pdF9vbl9ydW5xKHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2
YykKK3N0YXRpYyBpbmxpbmUgaW50IHVuaXRfb25fcnVucShjb25zdCBzdHJ1Y3QgY3NjaGVkMl91
bml0ICpzdmMpCiB7CiAgICAgcmV0dXJuICFsaXN0X2VtcHR5KCZzdmMtPnJ1bnFfZWxlbSk7CiB9
CkBAIC04NDksOSArODUwLDkgQEAgc3RhdGljIGlubGluZSBib29sIHNhbWVfY29yZSh1bnNpZ25l
ZCBpbnQgY3B1YSwgdW5zaWduZWQgaW50IGNwdWIpCiB9CiAKIHN0YXRpYyB1bnNpZ25lZCBpbnQK
LWNwdV90b19ydW5xdWV1ZShzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpwcnYsIHVuc2lnbmVkIGlu
dCBjcHUpCitjcHVfdG9fcnVucXVldWUoY29uc3Qgc3RydWN0IGNzY2hlZDJfcHJpdmF0ZSAqcHJ2
LCB1bnNpZ25lZCBpbnQgY3B1KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEg
KnJxZDsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQ7CiAgICAg
dW5zaWduZWQgaW50IHJxaTsKIAogICAgIGZvciAoIHJxaSA9IDA7IHJxaSA8IG5yX2NwdV9pZHM7
IHJxaSsrICkKQEAgLTkxNyw3ICs5MTgsNyBAQCBzdGF0aWMgdm9pZCB1cGRhdGVfbWF4X3dlaWdo
dChzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQsIGludCBuZXdfd2VpZ2h0LAogCiAg
ICAgICAgIGxpc3RfZm9yX2VhY2goIGl0ZXIsICZycWQtPnN2YyApCiAgICAgICAgIHsKLSAgICAg
ICAgICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKiBzdmMgPSBsaXN0X2VudHJ5KGl0ZXIsIHN0cnVj
dCBjc2NoZWQyX3VuaXQsIHJxZF9lbGVtKTsKKyAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBjc2No
ZWQyX3VuaXQgKiBzdmMgPSBsaXN0X2VudHJ5KGl0ZXIsIHN0cnVjdCBjc2NoZWQyX3VuaXQsIHJx
ZF9lbGVtKTsKIAogICAgICAgICAgICAgaWYgKCBzdmMtPndlaWdodCA+IG1heF93ZWlnaHQgKQog
ICAgICAgICAgICAgICAgIG1heF93ZWlnaHQgPSBzdmMtPndlaWdodDsKQEAgLTk3MCw3ICs5NzEs
NyBAQCBfcnVucV9hc3NpZ24oc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjLCBzdHJ1Y3QgY3NjaGVk
Ml9ydW5xdWV1ZV9kYXRhICpycWQpCiB9CiAKIHN0YXRpYyB2b2lkCi1ydW5xX2Fzc2lnbihjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorcnVucV9h
c3NpZ24oY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5p
dCAqdW5pdCkKIHsKICAgICBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMgPSB1bml0LT5wcml2Owog
CkBAIC05OTcsNyArOTk4LDcgQEAgX3J1bnFfZGVhc3NpZ24oc3RydWN0IGNzY2hlZDJfdW5pdCAq
c3ZjKQogfQogCiBzdGF0aWMgdm9pZAotcnVucV9kZWFzc2lnbihjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorcnVucV9kZWFzc2lnbihjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewog
ICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YyA9IHVuaXQtPnByaXY7CiAKQEAgLTEyMDMsNyAr
MTIwNCw3IEBAIHN0YXRpYyB2b2lkCiB1cGRhdGVfc3ZjX2xvYWQoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLAogICAgICAgICAgICAgICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YywgaW50
IGNoYW5nZSwgc190aW1lX3Qgbm93KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBy
diA9IGNzY2hlZDJfcHJpdihvcHMpOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUg
KnBydiA9IGNzY2hlZDJfcHJpdihvcHMpOwogICAgIHNfdGltZV90IGRlbHRhLCB1bml0X2xvYWQ7
CiAgICAgdW5zaWduZWQgaW50IFAsIFc7CiAKQEAgLTEzNjIsMTEgKzEzNjMsMTEgQEAgc3RhdGlj
IGlubGluZSBib29sIGlzX3ByZWVtcHRhYmxlKGNvbnN0IHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2
YywKICAqIFdpdGhpbiB0aGUgc2FtZSBjbGFzcywgdGhlIGhpZ2hlc3QgZGlmZmVyZW5jZSBvZiBj
cmVkaXQuCiAgKi8KIHN0YXRpYyBzX3RpbWVfdCB0aWNrbGVfc2NvcmUoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzX3RpbWVfdCBub3csCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBjc2NoZWQyX3VuaXQgKm5ldywgdW5zaWduZWQgaW50IGNwdSkKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNzY2hlZDJfdW5pdCAqbmV3LCB1bnNpZ25l
ZCBpbnQgY3B1KQogewogICAgIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCA9IGMy
cnFkKG9wcywgY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkMl91bml0ICogY3VyID0gY3NjaGVkMl91
bml0KGN1cnJfb25fY3B1KGNwdSkpOwotICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9
IGNzY2hlZDJfcHJpdihvcHMpOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBy
diA9IGNzY2hlZDJfcHJpdihvcHMpOwogICAgIHNfdGltZV90IHNjb3JlOwogCiAgICAgLyoKQEAg
LTE0NDEsNyArMTQ0Miw3IEBAIHJ1bnFfdGlja2xlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IGNzY2hlZDJfdW5pdCAqbmV3LCBzX3RpbWVfdCBub3cpCiAgICAgc3RydWN0IHNj
aGVkX3VuaXQgKnVuaXQgPSBuZXctPnVuaXQ7CiAgICAgdW5zaWduZWQgaW50IGJzLCBjcHUgPSBz
Y2hlZF91bml0X21hc3Rlcih1bml0KTsKICAgICBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRh
ICpycWQgPSBjMnJxZChvcHMsIGNwdSk7Ci0gICAgY3B1bWFza190ICpvbmxpbmUgPSBjcHVwb29s
X2RvbWFpbl9tYXN0ZXJfY3B1bWFzayh1bml0LT5kb21haW4pOworICAgIGNvbnN0IGNwdW1hc2tf
dCAqb25saW5lID0gY3B1cG9vbF9kb21haW5fbWFzdGVyX2NwdW1hc2sodW5pdC0+ZG9tYWluKTsK
ICAgICBjcHVtYXNrX3QgbWFzazsKIAogICAgIEFTU0VSVChuZXctPnJxZCA9PSBycWQpOwpAQCAt
MjAwNSw3ICsyMDA2LDcgQEAgc3RhdGljIHZvaWQgcmVwbGVuaXNoX2RvbWFpbl9idWRnZXQodm9p
ZCogZGF0YSkKIAogI2lmbmRlZiBOREVCVUcKIHN0YXRpYyBpbmxpbmUgdm9pZAotY3NjaGVkMl91
bml0X2NoZWNrKHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQorY3NjaGVkMl91bml0X2NoZWNrKGNv
bnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQg
KiBjb25zdCBzdmMgPSBjc2NoZWQyX3VuaXQodW5pdCk7CiAgICAgc3RydWN0IGNzY2hlZDJfZG9t
ICogY29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKQEAgLTI1NDEsOCArMjU0Miw4IEBAIHN0YXRpYyB2
b2lkIG1pZ3JhdGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLAogICogIC0gc3ZjIGlzIG5v
dCBhbHJlYWR5IGZsYWdnZWQgdG8gbWlncmF0ZSwKICAqICAtIGlmIHN2YyBpcyBhbGxvd2VkIHRv
IHJ1biBvbiBhdCBsZWFzdCBvbmUgb2YgdGhlIHBjcHVzIG9mIHJxZC4KICAqLwotc3RhdGljIGJv
b2wgdW5pdF9pc19taWdyYXRlYWJsZShzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAq
cnFkKQorc3RhdGljIGJvb2wgdW5pdF9pc19taWdyYXRlYWJsZShjb25zdCBzdHJ1Y3QgY3NjaGVk
Ml91bml0ICpzdmMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVj
dCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCkKIHsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAq
dW5pdCA9IHN2Yy0+dW5pdDsKICAgICBpbnQgY3B1ID0gc2NoZWRfdW5pdF9tYXN0ZXIodW5pdCk7
CkBAIC0zMDc2LDcgKzMwNzcsNyBAQCBjc2NoZWQyX2ZyZWVfZG9tZGF0YShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHZvaWQgKmRhdGEpCiBzdGF0aWMgdm9pZAogY3NjaGVkMl91bml0X2lu
c2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0
KQogewotICAgIHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YyA9IHVuaXQtPnByaXY7CisgICAgY29u
c3Qgc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjID0gdW5pdC0+cHJpdjsKICAgICBzdHJ1Y3QgY3Nj
aGVkMl9kb20gKiBjb25zdCBzZG9tID0gc3ZjLT5zZG9tOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7
CiAKQEAgLTMxNDIsNyArMzE0Myw3IEBAIGNzY2hlZDJfcnVudGltZShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIGludCBjcHUsCiAgICAgaW50IHJ0X2NyZWRpdDsgLyogUHJvcG9zZWQgcnVu
dGltZSBtZWFzdXJlZCBpbiBjcmVkaXRzICovCiAgICAgc3RydWN0IGNzY2hlZDJfcnVucXVldWVf
ZGF0YSAqcnFkID0gYzJycWQob3BzLCBjcHUpOwogICAgIHN0cnVjdCBsaXN0X2hlYWQgKnJ1bnEg
PSAmcnFkLT5ydW5xOwotICAgIHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNzY2hlZDJf
cHJpdihvcHMpOworICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNzY2hl
ZDJfcHJpdihvcHMpOwogCiAgICAgLyoKICAgICAgKiBJZiB3ZSdyZSBpZGxlLCBqdXN0IHN0YXkg
c28uIE90aGVycyAob3IgZXh0ZXJuYWwgZXZlbnRzKQpAQCAtMzIzOSw3ICszMjQwLDcgQEAgcnVu
cV9jYW5kaWRhdGUoc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFkLAogICAgICAgICAg
ICAgICAgdW5zaWduZWQgaW50ICpza2lwcGVkKQogewogICAgIHN0cnVjdCBsaXN0X2hlYWQgKml0
ZXIsICp0ZW1wOwotICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBnZXRfc2NoZWRfcmVz
KGNwdSk7CisgICAgY29uc3Qgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzciA9IGdldF9zY2hlZF9y
ZXMoY3B1KTsKICAgICBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzbmV4dCA9IE5VTEw7CiAgICAgc3Ry
dWN0IGNzY2hlZDJfcHJpdmF0ZSAqcHJ2ID0gY3NjaGVkMl9wcml2KHNyLT5zY2hlZHVsZXIpOwog
ICAgIGJvb2wgeWllbGQgPSBmYWxzZSwgc29mdF9hZmZfcHJlZW1wdCA9IGZhbHNlOwpAQCAtMzYw
Myw3ICszNjA0LDggQEAgc3RhdGljIHZvaWQgY3NjaGVkMl9zY2hlZHVsZSgKIH0KIAogc3RhdGlj
IHZvaWQKLWNzY2hlZDJfZHVtcF91bml0KHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiwgc3Ry
dWN0IGNzY2hlZDJfdW5pdCAqc3ZjKQorY3NjaGVkMl9kdW1wX3VuaXQoY29uc3Qgc3RydWN0IGNz
Y2hlZDJfcHJpdmF0ZSAqcHJ2LAorICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNzY2hl
ZDJfdW5pdCAqc3ZjKQogewogICAgIHByaW50aygiWyVpLiVpXSBmbGFncz0leCBjcHU9JWkiLAog
ICAgICAgICAgICAgc3ZjLT51bml0LT5kb21haW4tPmRvbWFpbl9pZCwKQEAgLTM2MjYsOCArMzYy
OCw4IEBAIGNzY2hlZDJfZHVtcF91bml0KHN0cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiwgc3Ry
dWN0IGNzY2hlZDJfdW5pdCAqc3ZjKQogc3RhdGljIGlubGluZSB2b2lkCiBkdW1wX3BjcHUoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBpbnQgY3B1KQogewotICAgIHN0cnVjdCBjc2NoZWQy
X3ByaXZhdGUgKnBydiA9IGNzY2hlZDJfcHJpdihvcHMpOwotICAgIHN0cnVjdCBjc2NoZWQyX3Vu
aXQgKnN2YzsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpwcnYgPSBjc2NoZWQy
X3ByaXYob3BzKTsKKyAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmM7CiAKICAgICBw
cmludGsoIkNQVVslMDJkXSBydW5xPSVkLCBzaWJsaW5nPXslKnBibH0sIGNvcmU9eyUqcGJsfVxu
IiwKICAgICAgICAgICAgY3B1LCBjMnIoY3B1KSwKQEAgLTM2OTUsOCArMzY5Nyw4IEBAIGNzY2hl
ZDJfZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgbG9vcCA9IDA7CiAgICAg
bGlzdF9mb3JfZWFjaCggaXRlcl9zZG9tLCAmcHJ2LT5zZG9tICkKICAgICB7Ci0gICAgICAgIHN0
cnVjdCBjc2NoZWQyX2RvbSAqc2RvbTsKLSAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQ7
CisgICAgICAgIGNvbnN0IHN0cnVjdCBjc2NoZWQyX2RvbSAqc2RvbTsKKyAgICAgICAgY29uc3Qg
c3RydWN0IHNjaGVkX3VuaXQgKnVuaXQ7CiAKICAgICAgICAgc2RvbSA9IGxpc3RfZW50cnkoaXRl
cl9zZG9tLCBzdHJ1Y3QgY3NjaGVkMl9kb20sIHNkb21fZWxlbSk7CiAKQEAgLTM3MzcsNyArMzcz
OSw3IEBAIGNzY2hlZDJfZHVtcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCiAgICAgICAg
IHByaW50aygiUlVOUTpcbiIpOwogICAgICAgICBsaXN0X2Zvcl9lYWNoKCBpdGVyLCBydW5xICkK
ICAgICAgICAgewotICAgICAgICAgICAgc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjID0gcnVucV9l
bGVtKGl0ZXIpOworICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNzY2hlZDJfdW5pdCAqc3ZjID0g
cnVucV9lbGVtKGl0ZXIpOwogCiAgICAgICAgICAgICBpZiAoIHN2YyApCiAgICAgICAgICAgICB7
CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkL3NjaGVkX251bGwuYyBiL3hlbi9jb21tb24v
c2NoZWQvc2NoZWRfbnVsbC5jCmluZGV4IDExYWFiMjU3NDMuLjQ5MDZlMDJjNjIgMTAwNjQ0Ci0t
LSBhL3hlbi9jb21tb24vc2NoZWQvc2NoZWRfbnVsbC5jCisrKyBiL3hlbi9jb21tb24vc2NoZWQv
c2NoZWRfbnVsbC5jCkBAIC0yNzgsMTIgKzI3OCwxMiBAQCBzdGF0aWMgdm9pZCBudWxsX2ZyZWVf
ZG9tZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHZvaWQgKmRhdGEpCiAgKiBTbyB0
aGlzIGlzIG5vdCBwYXJ0IG9mIGFueSBob3QgcGF0aC4KICAqLwogc3RhdGljIHN0cnVjdCBzY2hl
ZF9yZXNvdXJjZSAqCi1waWNrX3JlcyhzdHJ1Y3QgbnVsbF9wcml2YXRlICpwcnYsIGNvbnN0IHN0
cnVjdCBzY2hlZF91bml0ICp1bml0KQorcGlja19yZXMoY29uc3Qgc3RydWN0IG51bGxfcHJpdmF0
ZSAqcHJ2LCBjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICB1bnNpZ25lZCBp
bnQgYnM7CiAgICAgdW5zaWduZWQgaW50IGNwdSA9IHNjaGVkX3VuaXRfbWFzdGVyKHVuaXQpLCBu
ZXdfY3B1OwotICAgIGNwdW1hc2tfdCAqY3B1cyA9IGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVt
YXNrKHVuaXQtPmRvbWFpbik7Ci0gICAgc3RydWN0IG51bGxfcGNwdSAqbnBjID0gZ2V0X3NjaGVk
X3JlcyhjcHUpLT5zY2hlZF9wcml2OworICAgIGNvbnN0IGNwdW1hc2tfdCAqY3B1cyA9IGNwdXBv
b2xfZG9tYWluX21hc3Rlcl9jcHVtYXNrKHVuaXQtPmRvbWFpbik7CisgICAgY29uc3Qgc3RydWN0
IG51bGxfcGNwdSAqbnBjID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5zY2hlZF9wcml2OwogCiAgICAg
QVNTRVJUKHNwaW5faXNfbG9ja2VkKGdldF9zY2hlZF9yZXMoY3B1KS0+c2NoZWR1bGVfbG9jaykp
OwogCkBAIC0zNzUsNyArMzc1LDcgQEAgc3RhdGljIHZvaWQgdW5pdF9hc3NpZ24oc3RydWN0IG51
bGxfcHJpdmF0ZSAqcHJ2LCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwKIH0KIAogLyogUmV0dXJu
cyB0cnVlIGlmIGEgY3B1IHdhcyB0aWNrbGVkICovCi1zdGF0aWMgYm9vbCB1bml0X2RlYXNzaWdu
KHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiwgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCitzdGF0
aWMgYm9vbCB1bml0X2RlYXNzaWduKHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiwgY29uc3Qgc3Ry
dWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAgdW5zaWduZWQgaW50IGJzOwogICAgIHVuc2ln
bmVkIGludCBjcHUgPSBzY2hlZF91bml0X21hc3Rlcih1bml0KTsKQEAgLTQ0MSw3ICs0NDEsNyBA
QCBzdGF0aWMgc3BpbmxvY2tfdCAqbnVsbF9zd2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxlciAq
bmV3X29wcywKIHsKICAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNyID0gZ2V0X3NjaGVkX3Jl
cyhjcHUpOwogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiA9IG51bGxfcHJpdihuZXdfb3Bz
KTsKLSAgICBzdHJ1Y3QgbnVsbF91bml0ICpudmMgPSB2ZGF0YTsKKyAgICBjb25zdCBzdHJ1Y3Qg
bnVsbF91bml0ICpudmMgPSB2ZGF0YTsKIAogICAgIEFTU0VSVChudmMgJiYgaXNfaWRsZV91bml0
KG52Yy0+dW5pdCkpOwogCkBAIC05NDAsNyArOTQwLDggQEAgc3RhdGljIHZvaWQgbnVsbF9zY2hl
ZHVsZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICpwcmV2
LAogICAgIHByZXYtPm5leHRfdGFzay0+bWlncmF0ZWQgPSBmYWxzZTsKIH0KIAotc3RhdGljIGlu
bGluZSB2b2lkIGR1bXBfdW5pdChzdHJ1Y3QgbnVsbF9wcml2YXRlICpwcnYsIHN0cnVjdCBudWxs
X3VuaXQgKm52YykKK3N0YXRpYyBpbmxpbmUgdm9pZCBkdW1wX3VuaXQoY29uc3Qgc3RydWN0IG51
bGxfcHJpdmF0ZSAqcHJ2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1
Y3QgbnVsbF91bml0ICpudmMpCiB7CiAgICAgcHJpbnRrKCJbJWkuJWldIHBjcHU9JWQiLCBudmMt
PnVuaXQtPmRvbWFpbi0+ZG9tYWluX2lkLAogICAgICAgICAgICAgbnZjLT51bml0LT51bml0X2lk
LCBsaXN0X2VtcHR5KCZudmMtPndhaXRxX2VsZW0pID8KQEAgLTk1MCw4ICs5NTEsOCBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgZHVtcF91bml0KHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiwgc3RydWN0
IG51bGxfdW5pdCAqbnZjKQogc3RhdGljIHZvaWQgbnVsbF9kdW1wX3BjcHUoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzLCBpbnQgY3B1KQogewogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBy
diA9IG51bGxfcHJpdihvcHMpOwotICAgIHN0cnVjdCBudWxsX3BjcHUgKm5wYyA9IGdldF9zY2hl
ZF9yZXMoY3B1KS0+c2NoZWRfcHJpdjsKLSAgICBzdHJ1Y3QgbnVsbF91bml0ICpudmM7CisgICAg
Y29uc3Qgc3RydWN0IG51bGxfcGNwdSAqbnBjID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5zY2hlZF9w
cml2OworICAgIGNvbnN0IHN0cnVjdCBudWxsX3VuaXQgKm52YzsKICAgICBzcGlubG9ja190ICps
b2NrOwogICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24v
c2NoZWQvc2NoZWRfcnQuYyBiL3hlbi9jb21tb24vc2NoZWQvc2NoZWRfcnQuYwppbmRleCA4NjQ2
ZDc3MzQzLi41NjA2MTRlZDlkIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkL3NjaGVkX3J0
LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZC9zY2hlZF9ydC5jCkBAIC0zNTIsNyArMzUyLDcgQEAg
c3RhdGljIHZvaWQKIHJ0X2R1bXBfcGNwdShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIGlu
dCBjcHUpCiB7CiAgICAgc3RydWN0IHJ0X3ByaXZhdGUgKnBydiA9IHJ0X3ByaXYob3BzKTsKLSAg
ICBzdHJ1Y3QgcnRfdW5pdCAqc3ZjOworICAgIGNvbnN0IHN0cnVjdCBydF91bml0ICpzdmM7CiAg
ICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZwcnYtPmxv
Y2ssIGZsYWdzKTsKQEAgLTM3MSw4ICszNzEsOCBAQCBydF9kdW1wKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcykKIHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpydW5xLCAqZGVwbGV0ZWRxLCAq
cmVwbHEsICppdGVyOwogICAgIHN0cnVjdCBydF9wcml2YXRlICpwcnYgPSBydF9wcml2KG9wcyk7
Ci0gICAgc3RydWN0IHJ0X3VuaXQgKnN2YzsKLSAgICBzdHJ1Y3QgcnRfZG9tICpzZG9tOworICAg
IGNvbnN0IHN0cnVjdCBydF91bml0ICpzdmM7CisgICAgY29uc3Qgc3RydWN0IHJ0X2RvbSAqc2Rv
bTsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwogCiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJnBy
di0+bG9jaywgZmxhZ3MpOwpAQCAtNDA4LDcgKzQwOCw3IEBAIHJ0X2R1bXAoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzKQogICAgIHByaW50aygiRG9tYWluIGluZm86XG4iKTsKICAgICBsaXN0
X2Zvcl9lYWNoICggaXRlciwgJnBydi0+c2RvbSApCiAgICAgewotICAgICAgICBzdHJ1Y3Qgc2No
ZWRfdW5pdCAqdW5pdDsKKyAgICAgICAgY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQ7CiAK
ICAgICAgICAgc2RvbSA9IGxpc3RfZW50cnkoaXRlciwgc3RydWN0IHJ0X2RvbSwgc2RvbV9lbGVt
KTsKICAgICAgICAgcHJpbnRrKCJcdGRvbWFpbjogJWRcbiIsIHNkb20tPmRvbS0+ZG9tYWluX2lk
KTsKQEAgLTUwOSw3ICs1MDksNyBAQCBkZWFkbGluZV9xdWV1ZV9pbnNlcnQoc3RydWN0IHJ0X3Vu
aXQgKiAoKnFlbGVtKShzdHJ1Y3QgbGlzdF9oZWFkICopLAogCiAgICAgbGlzdF9mb3JfZWFjaCAo
IGl0ZXIsIHF1ZXVlICkKICAgICB7Ci0gICAgICAgIHN0cnVjdCBydF91bml0ICogaXRlcl9zdmMg
PSAoKnFlbGVtKShpdGVyKTsKKyAgICAgICAgY29uc3Qgc3RydWN0IHJ0X3VuaXQgKiBpdGVyX3N2
YyA9ICgqcWVsZW0pKGl0ZXIpOwogICAgICAgICBpZiAoIGNvbXBhcmVfdW5pdF9wcmlvcml0eShz
dmMsIGl0ZXJfc3ZjKSA+IDAgKQogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIHBvcyA9IHRy
dWU7CkBAIC01NDcsNyArNTQ3LDcgQEAgcmVwbHFfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywgc3RydWN0IHJ0X3VuaXQgKnN2YykKICAgICAgICAgICovCiAgICAgICAgIGlmICgg
IWxpc3RfZW1wdHkocmVwbHEpICkKICAgICAgICAgewotICAgICAgICAgICAgc3RydWN0IHJ0X3Vu
aXQgKnN2Y19uZXh0ID0gcmVwbHFfZWxlbShyZXBscS0+bmV4dCk7CisgICAgICAgICAgICBjb25z
dCBzdHJ1Y3QgcnRfdW5pdCAqc3ZjX25leHQgPSByZXBscV9lbGVtKHJlcGxxLT5uZXh0KTsKICAg
ICAgICAgICAgIHNldF90aW1lcigmcHJ2LT5yZXBsX3RpbWVyLCBzdmNfbmV4dC0+Y3VyX2RlYWRs
aW5lKTsKICAgICAgICAgfQogICAgICAgICBlbHNlCkBAIC02MDQsNyArNjA0LDcgQEAgc3RhdGlj
IHZvaWQKIHJlcGxxX3JlaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0
IHJ0X3VuaXQgKnN2YykKIHsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkICpyZXBscSA9IHJ0X3JlcGxx
KG9wcyk7Ci0gICAgc3RydWN0IHJ0X3VuaXQgKnJlYXJtX3N2YyA9IHN2YzsKKyAgICBjb25zdCBz
dHJ1Y3QgcnRfdW5pdCAqcmVhcm1fc3ZjID0gc3ZjOwogICAgIGJvb2wgcmVhcm0gPSBmYWxzZTsK
IAogICAgIEFTU0VSVCggdW5pdF9vbl9yZXBscShzdmMpICk7CkBAIC02NDAsNyArNjQwLDcgQEAg
c3RhdGljIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqCiBydF9yZXNfcGlja19sb2NrZWQoY29uc3Qg
c3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsIHVuc2lnbmVkIGludCBsb2NrZWRfY3B1KQogewogICAg
IGNwdW1hc2tfdCAqY3B1cyA9IGNwdW1hc2tfc2NyYXRjaF9jcHUobG9ja2VkX2NwdSk7Ci0gICAg
Y3B1bWFza190ICpvbmxpbmU7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmU7CiAgICAgaW50
IGNwdTsKIAogICAgIG9ubGluZSA9IGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVtYXNrKHVuaXQt
PmRvbWFpbik7CkBAIC0xMDI4LDcgKzEwMjgsNyBAQCBydW5xX3BpY2soY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBjb25zdCBjcHVtYXNrX3QgKm1hc2ssIHVuc2lnbmVkIGludCBjcHUpCiAg
ICAgc3RydWN0IHJ0X3VuaXQgKnN2YyA9IE5VTEw7CiAgICAgc3RydWN0IHJ0X3VuaXQgKml0ZXJf
c3ZjID0gTlVMTDsKICAgICBjcHVtYXNrX3QgKmNwdV9jb21tb24gPSBjcHVtYXNrX3NjcmF0Y2hf
Y3B1KGNwdSk7Ci0gICAgY3B1bWFza190ICpvbmxpbmU7CisgICAgY29uc3QgY3B1bWFza190ICpv
bmxpbmU7CiAKICAgICBsaXN0X2Zvcl9lYWNoICggaXRlciwgcnVucSApCiAgICAgewpAQCAtMTE5
NywxNSArMTE5NywxNSBAQCBydF91bml0X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiAgKiBsb2NrIGlzIGdyYWJiZWQgYmVmb3JlIGNh
bGxpbmcgdGhpcyBmdW5jdGlvbgogICovCiBzdGF0aWMgdm9pZAotcnVucV90aWNrbGUoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgcnRfdW5pdCAqbmV3KQorcnVucV90aWNrbGUo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBjb25zdCBzdHJ1Y3QgcnRfdW5pdCAqbmV3KQog
ewogICAgIHN0cnVjdCBydF9wcml2YXRlICpwcnYgPSBydF9wcml2KG9wcyk7Ci0gICAgc3RydWN0
IHJ0X3VuaXQgKmxhdGVzdF9kZWFkbGluZV91bml0ID0gTlVMTDsgLyogbG93ZXN0IHByaW9yaXR5
ICovCi0gICAgc3RydWN0IHJ0X3VuaXQgKml0ZXJfc3ZjOwotICAgIHN0cnVjdCBzY2hlZF91bml0
ICppdGVyX3VuaXQ7CisgICAgY29uc3Qgc3RydWN0IHJ0X3VuaXQgKmxhdGVzdF9kZWFkbGluZV91
bml0ID0gTlVMTDsgLyogbG93ZXN0IHByaW9yaXR5ICovCisgICAgY29uc3Qgc3RydWN0IHJ0X3Vu
aXQgKml0ZXJfc3ZjOworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICppdGVyX3VuaXQ7CiAg
ICAgaW50IGNwdSA9IDAsIGNwdV90b190aWNrbGUgPSAwOwogICAgIGNwdW1hc2tfdCAqbm90X3Rp
Y2tsZWQgPSBjcHVtYXNrX3NjcmF0Y2hfY3B1KHNtcF9wcm9jZXNzb3JfaWQoKSk7Ci0gICAgY3B1
bWFza190ICpvbmxpbmU7CisgICAgY29uc3QgY3B1bWFza190ICpvbmxpbmU7CiAKICAgICBpZiAo
IG5ldyA9PSBOVUxMIHx8IGlzX2lkbGVfdW5pdChuZXctPnVuaXQpICkKICAgICAgICAgcmV0dXJu
OwpAQCAtMTM3OSw3ICsxMzc5LDcgQEAgcnRfZG9tX2NudGwoCiB7CiAgICAgc3RydWN0IHJ0X3By
aXZhdGUgKnBydiA9IHJ0X3ByaXYob3BzKTsKICAgICBzdHJ1Y3QgcnRfdW5pdCAqc3ZjOwotICAg
IHN0cnVjdCBzY2hlZF91bml0ICp1bml0OworICAgIGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1
bml0OwogICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgaW50IHJjID0gMDsKICAgICBzdHJ1
Y3QgeGVuX2RvbWN0bF9zY2hlZHBhcmFtX3ZjcHUgbG9jYWxfc2NoZWQ7CkBAIC0xNDg0LDcgKzE0
ODQsNyBAQCBydF9kb21fY250bCgKICAqLwogc3RhdGljIHZvaWQgcmVwbF90aW1lcl9oYW5kbGVy
KHZvaWQgKmRhdGEpewogICAgIHNfdGltZV90IG5vdzsKLSAgICBzdHJ1Y3Qgc2NoZWR1bGVyICpv
cHMgPSBkYXRhOworICAgIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcyA9IGRhdGE7CiAgICAg
c3RydWN0IHJ0X3ByaXZhdGUgKnBydiA9IHJ0X3ByaXYob3BzKTsKICAgICBzdHJ1Y3QgbGlzdF9o
ZWFkICpyZXBscSA9IHJ0X3JlcGxxKG9wcyk7CiAgICAgc3RydWN0IGxpc3RfaGVhZCAqcnVucSA9
IHJ0X3J1bnEob3BzKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWQvc2NoZWR1bGUuYyBi
L3hlbi9jb21tb24vc2NoZWQvc2NoZWR1bGUuYwppbmRleCBkZGJmYWNlOTY5Li4xZDk4ZTFmYThk
IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkL3NjaGVkdWxlLmMKKysrIGIveGVuL2NvbW1v
bi9zY2hlZC9zY2hlZHVsZS5jCkBAIC0xNzUsNyArMTc1LDcgQEAgc3RhdGljIGlubGluZSBzdHJ1
Y3Qgc2NoZWR1bGVyICpkb21fc2NoZWR1bGVyKGNvbnN0IHN0cnVjdCBkb21haW4gKmQpCiAKIHN0
YXRpYyBpbmxpbmUgc3RydWN0IHNjaGVkdWxlciAqdW5pdF9zY2hlZHVsZXIoY29uc3Qgc3RydWN0
IHNjaGVkX3VuaXQgKnVuaXQpCiB7Ci0gICAgc3RydWN0IGRvbWFpbiAqZCA9IHVuaXQtPmRvbWFp
bjsKKyAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpkID0gdW5pdC0+ZG9tYWluOwogCiAgICAgaWYg
KCBsaWtlbHkoZC0+Y3B1cG9vbCAhPSBOVUxMKSApCiAgICAgICAgIHJldHVybiBkLT5jcHVwb29s
LT5zY2hlZDsKQEAgLTIwMiw3ICsyMDIsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBzY2hlZHVs
ZXIgKnZjcHVfc2NoZWR1bGVyKGNvbnN0IHN0cnVjdCB2Y3B1ICp2KQogfQogI2RlZmluZSBWQ1BV
Mk9OTElORShfdikgY3B1cG9vbF9kb21haW5fbWFzdGVyX2NwdW1hc2soKF92KS0+ZG9tYWluKQog
Ci1zdGF0aWMgaW5saW5lIHZvaWQgdHJhY2VfcnVuc3RhdGVfY2hhbmdlKHN0cnVjdCB2Y3B1ICp2
LCBpbnQgbmV3X3N0YXRlKQorc3RhdGljIGlubGluZSB2b2lkIHRyYWNlX3J1bnN0YXRlX2NoYW5n
ZShjb25zdCBzdHJ1Y3QgdmNwdSAqdiwgaW50IG5ld19zdGF0ZSkKIHsKICAgICBzdHJ1Y3QgeyB1
aW50MzJfdCB2Y3B1OjE2LCBkb21haW46MTY7IH0gZDsKICAgICB1aW50MzJfdCBldmVudDsKQEAg
LTIyMCw3ICsyMjAsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdHJhY2VfcnVuc3RhdGVfY2hhbmdl
KHN0cnVjdCB2Y3B1ICp2LCBpbnQgbmV3X3N0YXRlKQogICAgIF9fdHJhY2VfdmFyKGV2ZW50LCAx
Lyp0c2MqLywgc2l6ZW9mKGQpLCAmZCk7CiB9CiAKLXN0YXRpYyBpbmxpbmUgdm9pZCB0cmFjZV9j
b250aW51ZV9ydW5uaW5nKHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lkIHRyYWNl
X2NvbnRpbnVlX3J1bm5pbmcoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiB7CiAgICAgc3RydWN0IHsg
dWludDMyX3QgdmNwdToxNiwgZG9tYWluOjE2OyB9IGQ7CiAKQEAgLTMwMiw3ICszMDIsOCBAQCB2
b2lkIHNjaGVkX2d1ZXN0X2lkbGUodm9pZCAoKmlkbGUpICh2b2lkKSwgdW5zaWduZWQgaW50IGNw
dSkKICAgICBhdG9taWNfZGVjKCZwZXJfY3B1KHNjaGVkX3VyZ2VudF9jb3VudCwgY3B1KSk7CiB9
CiAKLXZvaWQgdmNwdV9ydW5zdGF0ZV9nZXQoc3RydWN0IHZjcHUgKnYsIHN0cnVjdCB2Y3B1X3J1
bnN0YXRlX2luZm8gKnJ1bnN0YXRlKQordm9pZCB2Y3B1X3J1bnN0YXRlX2dldChjb25zdCBzdHJ1
Y3QgdmNwdSAqdiwKKyAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZjcHVfcnVuc3RhdGVf
aW5mbyAqcnVuc3RhdGUpCiB7CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKICAgICBzX3RpbWVfdCBk
ZWx0YTsKQEAgLTMyNCw3ICszMjUsNyBAQCB2b2lkIHZjcHVfcnVuc3RhdGVfZ2V0KHN0cnVjdCB2
Y3B1ICp2LCBzdHJ1Y3QgdmNwdV9ydW5zdGF0ZV9pbmZvICpydW5zdGF0ZSkKIHVpbnQ2NF90IGdl
dF9jcHVfaWRsZV90aW1lKHVuc2lnbmVkIGludCBjcHUpCiB7CiAgICAgc3RydWN0IHZjcHVfcnVu
c3RhdGVfaW5mbyBzdGF0ZSA9IHsgMCB9OwotICAgIHN0cnVjdCB2Y3B1ICp2ID0gaWRsZV92Y3B1
W2NwdV07CisgICAgY29uc3Qgc3RydWN0IHZjcHUgKnYgPSBpZGxlX3ZjcHVbY3B1XTsKIAogICAg
IGlmICggY3B1X29ubGluZShjcHUpICYmIHYgKQogICAgICAgICB2Y3B1X3J1bnN0YXRlX2dldCh2
LCAmc3RhdGUpOwpAQCAtMzkyLDcgKzM5Myw3IEBAIHN0YXRpYyB2b2lkIHNjaGVkX2ZyZWVfdW5p
dF9tZW0oc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiAKIHN0YXRpYyB2b2lkIHNjaGVkX2ZyZWVf
dW5pdChzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwgc3RydWN0IHZjcHUgKnYpCiB7Ci0gICAgc3Ry
dWN0IHZjcHUgKnZ1bml0OworICAgIGNvbnN0IHN0cnVjdCB2Y3B1ICp2dW5pdDsKICAgICB1bnNp
Z25lZCBpbnQgY250ID0gMDsKIAogICAgIC8qIERvbid0IGNvdW50IHRvIGJlIHJlbGVhc2VkIHZj
cHUsIG1pZ2h0IGJlIG5vdCBpbiB2Y3B1IGxpc3QgeWV0LiAqLwpAQCAtNTIyLDcgKzUyMyw3IEBA
IHN0YXRpYyB1bnNpZ25lZCBpbnQgc2NoZWRfc2VsZWN0X2luaXRpYWxfY3B1KGNvbnN0IHN0cnVj
dCB2Y3B1ICp2KQogCiBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2KQogewotICAg
IHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21haW47CisgICAgY29uc3Qgc3RydWN0IGRvbWFpbiAq
ZCA9IHYtPmRvbWFpbjsKICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdDsKICAgICB1bnNpZ25l
ZCBpbnQgcHJvY2Vzc29yOwogCkBAIC05MTMsNyArOTE0LDcgQEAgc3RhdGljIHZvaWQgc2NoZWRf
dW5pdF9tb3ZlX2xvY2tlZChzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG5ld19jcHUpCiB7CiAgICAgdW5zaWdu
ZWQgaW50IG9sZF9jcHUgPSB1bml0LT5yZXMtPm1hc3Rlcl9jcHU7Ci0gICAgc3RydWN0IHZjcHUg
KnY7CisgICAgY29uc3Qgc3RydWN0IHZjcHUgKnY7CiAKICAgICByY3VfcmVhZF9sb2NrKCZzY2hl
ZF9yZXNfcmN1bG9jayk7CiAKQEAgLTEwOTAsNyArMTA5MSw3IEBAIHN0YXRpYyBib29sIHNjaGVk
X2NoZWNrX2FmZmluaXR5X2Jyb2tlbihjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKICAg
ICByZXR1cm4gZmFsc2U7CiB9CiAKLXN0YXRpYyB2b2lkIHNjaGVkX3Jlc2V0X2FmZmluaXR5X2Jy
b2tlbihzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKK3N0YXRpYyB2b2lkIHNjaGVkX3Jlc2V0X2Fm
ZmluaXR5X2Jyb2tlbihjb25zdCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1
Y3QgdmNwdSAqdjsKIApAQCAtMTE3Niw3ICsxMTc3LDcgQEAgdm9pZCByZXN0b3JlX3ZjcHVfYWZm
aW5pdHkoc3RydWN0IGRvbWFpbiAqZCkKIGludCBjcHVfZGlzYWJsZV9zY2hlZHVsZXIodW5zaWdu
ZWQgaW50IGNwdSkKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkOwotICAgIHN0cnVjdCBjcHVwb29s
ICpjOworICAgIGNvbnN0IHN0cnVjdCBjcHVwb29sICpjOwogICAgIGNwdW1hc2tfdCBvbmxpbmVf
YWZmaW5pdHk7CiAgICAgaW50IHJldCA9IDA7CiAKQEAgLTEyNTEsOCArMTI1Miw4IEBAIG91dDoK
IHN0YXRpYyBpbnQgY3B1X2Rpc2FibGVfc2NoZWR1bGVyX2NoZWNrKHVuc2lnbmVkIGludCBjcHUp
CiB7CiAgICAgc3RydWN0IGRvbWFpbiAqZDsKLSAgICBzdHJ1Y3QgdmNwdSAqdjsKLSAgICBzdHJ1
Y3QgY3B1cG9vbCAqYzsKKyAgICBjb25zdCBzdHJ1Y3QgdmNwdSAqdjsKKyAgICBjb25zdCBzdHJ1
Y3QgY3B1cG9vbCAqYzsKIAogICAgIGMgPSBnZXRfc2NoZWRfcmVzKGNwdSktPmNwdXBvb2w7CiAg
ICAgaWYgKCBjID09IE5VTEwgKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgg
Yi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAppbmRleCBlNDI2M2RlMmQ1Li5mY2Y4ZTUwMzdiIDEw
MDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4v
c2NoZWQuaApAQCAtNzcxLDcgKzc3MSw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBoeXBlcmNhbGxf
Y2FuY2VsX2NvbnRpbnVhdGlvbihzdHJ1Y3QgdmNwdSAqdikKIGV4dGVybiBzdHJ1Y3QgZG9tYWlu
ICpkb21haW5fbGlzdDsKIAogLyogQ2FsbGVyIG11c3QgaG9sZCB0aGUgZG9tbGlzdF9yZWFkX2xv
Y2sgb3IgZG9tbGlzdF91cGRhdGVfbG9jay4gKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IGRvbWFp
biAqZmlyc3RfZG9tYWluX2luX2NwdXBvb2woIHN0cnVjdCBjcHVwb29sICpjKQorc3RhdGljIGlu
bGluZSBzdHJ1Y3QgZG9tYWluICpmaXJzdF9kb21haW5faW5fY3B1cG9vbChjb25zdCBzdHJ1Y3Qg
Y3B1cG9vbCAqYykKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkOwogICAgIGZvciAoZCA9IHJjdV9k
ZXJlZmVyZW5jZShkb21haW5fbGlzdCk7IGQgJiYgZC0+Y3B1cG9vbCAhPSBjOwpAQCAtNzc5LDcg
Kzc3OSw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IGRvbWFpbiAqZmlyc3RfZG9tYWluX2luX2Nw
dXBvb2woIHN0cnVjdCBjcHVwb29sICpjKQogICAgIHJldHVybiBkOwogfQogc3RhdGljIGlubGlu
ZSBzdHJ1Y3QgZG9tYWluICpuZXh0X2RvbWFpbl9pbl9jcHVwb29sKAotICAgIHN0cnVjdCBkb21h
aW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQorICAgIHN0cnVjdCBkb21haW4gKmQsIGNvbnN0IHN0
cnVjdCBjcHVwb29sICpjKQogewogICAgIGZvciAoZCA9IHJjdV9kZXJlZmVyZW5jZShkLT5uZXh0
X2luX2xpc3QpOyBkICYmIGQtPmNwdXBvb2wgIT0gYzsKICAgICAgICAgIGQgPSByY3VfZGVyZWZl
cmVuY2UoZC0+bmV4dF9pbl9saXN0KSk7CkBAIC05MjMsNyArOTIzLDggQEAgdm9pZCByZXN0b3Jl
X3ZjcHVfYWZmaW5pdHkoc3RydWN0IGRvbWFpbiAqZCk7CiBpbnQgdmNwdV9hZmZpbml0eV9kb21j
dGwoc3RydWN0IGRvbWFpbiAqZCwgdWludDMyX3QgY21kLAogICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCB4ZW5fZG9tY3RsX3ZjcHVhZmZpbml0eSAqdmNwdWFmZik7CiAKLXZvaWQgdmNw
dV9ydW5zdGF0ZV9nZXQoc3RydWN0IHZjcHUgKnYsIHN0cnVjdCB2Y3B1X3J1bnN0YXRlX2luZm8g
KnJ1bnN0YXRlKTsKK3ZvaWQgdmNwdV9ydW5zdGF0ZV9nZXQoY29uc3Qgc3RydWN0IHZjcHUgKnYs
CisgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1X3J1bnN0YXRlX2luZm8gKnJ1bnN0
YXRlKTsKIHVpbnQ2NF90IGdldF9jcHVfaWRsZV90aW1lKHVuc2lnbmVkIGludCBjcHUpOwogdm9p
ZCBzY2hlZF9ndWVzdF9pZGxlKHZvaWQgKCppZGxlKSAodm9pZCksIHVuc2lnbmVkIGludCBjcHUp
Owogdm9pZCBzY2hlZHVsZXJfZW5hYmxlKHZvaWQpOwpAQCAtMTA0Miw3ICsxMDQzLDcgQEAgZXh0
ZXJuIGVudW0gY3B1ZnJlcV9jb250cm9sbGVyIHsKIGludCBjcHVwb29sX21vdmVfZG9tYWluKHN0
cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKTsKIGludCBjcHVwb29sX2RvX3N5c2N0
bChzdHJ1Y3QgeGVuX3N5c2N0bF9jcHVwb29sX29wICpvcCk7CiBpbnQgY3B1cG9vbF9nZXRfaWQo
Y29uc3Qgc3RydWN0IGRvbWFpbiAqZCk7Ci1jcHVtYXNrX3QgKmNwdXBvb2xfdmFsaWRfY3B1cyhz
dHJ1Y3QgY3B1cG9vbCAqcG9vbCk7Citjb25zdCBjcHVtYXNrX3QgKmNwdXBvb2xfdmFsaWRfY3B1
cyhjb25zdCBzdHJ1Y3QgY3B1cG9vbCAqcG9vbCk7CiBleHRlcm4gdm9pZCBkdW1wX3J1bnEodW5z
aWduZWQgY2hhciBrZXkpOwogCiB2b2lkIGFyY2hfZG9fcGh5c2luZm8oc3RydWN0IHhlbl9zeXNj
dGxfcGh5c2luZm8gKnBpKTsKLS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxp
c3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9s
aXN0aW5mby94ZW4tZGV2ZWw=

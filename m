Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 819CD118D0E
	for <lists+xen-devel@lfdr.de>; Tue, 10 Dec 2019 16:52:26 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iehle-0004An-Sk; Tue, 10 Dec 2019 15:49:42 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=A1/D=2A=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iehlc-00048y-UF
 for xen-devel@lists.xenproject.org; Tue, 10 Dec 2019 15:49:40 +0000
X-Inumbo-ID: 7b7cb316-1b64-11ea-a1e1-bc764e2007e4
Received: from mail-qk1-x742.google.com (unknown [2607:f8b0:4864:20::742])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 7b7cb316-1b64-11ea-a1e1-bc764e2007e4;
 Tue, 10 Dec 2019 15:48:17 +0000 (UTC)
Received: by mail-qk1-x742.google.com with SMTP id x1so16723327qkl.12
 for <xen-devel@lists.xenproject.org>; Tue, 10 Dec 2019 07:48:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=ZYBDDhJmHxFl3+b3ETqJi4fQLL+Cu5wc6CLfgXz+gzQ=;
 b=rBXQP+IeZmvQPeDFSZ24ccWxgEio8WzSmIkULW7oUIOlsaQ0uWlKnZUyYABjNBvrHd
 VuLewnrvZeNJt7RGEHYOtfpWmg9Sc3VUOAvHC5jaAV4v5a+qAlUO0ayCy4aDyROUDjLt
 eeDZgbpfFbU6ifcmzZxxV1BoiyNZlXc5YEfzGRMccDux7Qi6tZ8FeyuJQlht8geFx+bB
 BaAXG2gscdpwv6nXDrNQaTfiTlzeEUcQsyZO5lDQNPEuvYvlucjZpmZNfRPTnGmI9LRq
 RlP9gRjQlCNo/Np0PrXFvumtI85yPl2xFp+70DApQpgQQVDjPXnppwUvppZ0yQHlvQ9t
 t2GA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=ZYBDDhJmHxFl3+b3ETqJi4fQLL+Cu5wc6CLfgXz+gzQ=;
 b=qiNHlqZentxm9Z8lnc5LXWguMUAOEeWhbFHs844LHYv0xgOXVXBjNZkVc564SI87y2
 5kmQ8E2wcFFYuZzR2way1GNPaj2wkE1w6wcJAuHLt+lW98sRWaW9/iehsqUvTldqEkmm
 JHWs2ja/Onp2YaHCSBagfffgctqbAs0ykYPH3YOC+irNjnhgQXzIih7vcsOnDfq/HE0I
 LNqnkmllxNlbKd6HzLsDKUSYwdqbIk6L4GjBe30OCUm8IOXDUgn3vCbHls+2XpVbfnBY
 EeW7h6kbYwJkK3AHyj3Sb+ovq+lgSew4Hlf3a60NmzY5jVq0LtOgdbgOmI4HWFrDpAx9
 g7Xg==
X-Gm-Message-State: APjAAAVXhGw8LPzAXO+98kHQPMl/m3QjY7imYK/KMW+VnijM9RdONKld
 lRXRRZ/DK2NqxY3qnOmLOeJ8h0mh
X-Google-Smtp-Source: APXvYqz0wqDEKvj2n2wa4BIWopkQDSpbnPGl6dCOteKUElO2N4R90mX8eztKTR5aYvIlTfSz2B/Ppw==
X-Received: by 2002:ae9:efc5:: with SMTP id
 d188mr33291864qkg.178.1575992896160; 
 Tue, 10 Dec 2019 07:48:16 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id m29sm1247848qtf.1.2019.12.10.07.48.14
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 10 Dec 2019 07:48:15 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 10 Dec 2019 10:47:36 -0500
Message-Id: <8330ea427861ef6c5d3b20d381bf40e87937d448.1575990937.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1575990937.git.rosbrookn@ainfosec.com>
References: <cover.1575990937.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 21/22] golang/xenlight: revise use of Context
 type
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClJlbW92ZSB0aGUg
ZXhwb3J0ZWQgZ2xvYmFsIGNvbnRleHQgdmFyaWFibGUsICdDdHguJyBHZW5lcmFsbHksIGl0IGlz
CmJldHRlciB0byBub3QgZXhwb3J0IGdsb2JhbCB2YXJpYWJsZXMgZm9yIHVzZSB0aHJvdWdoIGEg
R28gcGFja2FnZS4KSG93ZXZlciwgdGhlcmUgYXJlIHNvbWUgZXhjZXB0aW9ucyB0aGF0IGNhbiBi
ZSBmb3VuZCBpbiB0aGUgc3RhbmRhcmQKbGlicmFyeS4KCkFkZCBhIE5ld0NvbnRleHQgZnVuY3Rp
b24gaW5zdGVhZCwgYW5kIHJlbW92ZSB0aGUgT3BlbiwgSXNPcGVuLCBhbmQKQ2hlY2tPcGVuIGZ1
bmN0aW9ucyBhcyBhIHJlc3VsdC4KCkFsc28sIGNvbW1lbnQtb3V0IGFuIGluZWZmZWN0dWFsIGFz
c2lnbm1lbnQgdG8gJ2VycicgaW5zaWRlIHRoZSBmdW5jdGlvbgpDb250ZXh0LkNwdXBvb2xJbmZv
IHNvIHRoYXQgY29tcGlsYXRpb24gZG9lcyBub3QgZmFpbC4KClNpZ25lZC1vZmYtYnk6IE5pY2sg
Um9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L3hlbmxpZ2h0LmdvIHwgMjE5ICsrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogMSBm
aWxlIGNoYW5nZWQsIDM0IGluc2VydGlvbnMoKyksIDE4NSBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS90b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28gYi90b29scy9nb2xhbmcveGVu
bGlnaHQveGVubGlnaHQuZ28KaW5kZXggZjMyZWIxMTM4NC4uMWM0MzFmYTRlNSAxMDA2NDQKLS0t
IGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hlbmxpZ2h0LmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94
ZW5saWdodC94ZW5saWdodC5nbwpAQCAtNzQsNiArNzQsMzkgQEAgZnVuYyAoZSBFcnJvcikgRXJy
b3IoKSBzdHJpbmcgewogCXJldHVybiBmbXQuU3ByaW50ZigibGlieGwgZXJyb3I6ICVkIiwgLWUp
CiB9CiAKKy8vIENvbnRleHQgcmVwcmVzZW50cyBhIGxpYnhsX2N0eC4KK3R5cGUgQ29udGV4dCBz
dHJ1Y3QgeworCWN0eCAgICAqQy5saWJ4bF9jdHgKKwlsb2dnZXIgKkMueGVudG9vbGxvZ19sb2dn
ZXJfc3RkaW9zdHJlYW0KK30KKworLy8gTmV3Q29udGV4dCByZXR1cm5zIGEgbmV3IENvbnRleHQu
CitmdW5jIE5ld0NvbnRleHQoKSAoKkNvbnRleHQsIGVycm9yKSB7CisJdmFyIGN0eCBDb250ZXh0
CisKKwljdHgubG9nZ2VyID0gQy54dGxfY3JlYXRlbG9nZ2VyX3N0ZGlvc3RyZWFtKEMuc3RkZXJy
LCBDLlhUTF9FUlJPUiwgMCkKKworCXJldCA6PSBDLmxpYnhsX2N0eF9hbGxvYygmY3R4LmN0eCwg
Qy5MSUJYTF9WRVJTSU9OLCAwLCAoKkMueGVudG9vbGxvZ19sb2dnZXIpKHVuc2FmZS5Qb2ludGVy
KGN0eC5sb2dnZXIpKSkKKwlpZiByZXQgIT0gMCB7CisJCXJldHVybiBuaWwsIEVycm9yKHJldCkK
Kwl9CisKKwlyZXR1cm4gJmN0eCwgbmlsCit9CisKKy8vIENsb3NlIGNsb3NlcyB0aGUgQ29udGV4
dC4KK2Z1bmMgKGN0eCAqQ29udGV4dCkgQ2xvc2UoKSBlcnJvciB7CisJcmV0IDo9IEMubGlieGxf
Y3R4X2ZyZWUoY3R4LmN0eCkKKwljdHguY3R4ID0gbmlsCisJQy54dGxfbG9nZ2VyX2Rlc3Ryb3ko
KCpDLnhlbnRvb2xsb2dfbG9nZ2VyKSh1bnNhZmUuUG9pbnRlcihjdHgubG9nZ2VyKSkpCisKKwlp
ZiByZXQgIT0gMCB7CisJCXJldHVybiBFcnJvcihyZXQpCisJfQorCisJcmV0dXJuIG5pbAorfQor
CiAvKgogICogVHlwZXM6IEJ1aWx0aW5zCiAgKi8KQEAgLTI5OCwxMSArMzMxLDYgQEAgZnVuYyAo
Y3BsIENwdWlkUG9saWN5TGlzdCkgdG9DKCkgKEMubGlieGxfY3B1aWRfcG9saWN5X2xpc3QsIGVy
cm9yKSB7CiAJcmV0dXJuIGNjcGwsIG5pbAogfQogCi10eXBlIENvbnRleHQgc3RydWN0IHsKLQlj
dHggICAgKkMubGlieGxfY3R4Ci0JbG9nZ2VyICpDLnhlbnRvb2xsb2dfbG9nZ2VyX3N0ZGlvc3Ry
ZWFtCi19Ci0KIC8vIEh3Y2FwIHJlcHJlc2VudHMgYSBsaWJ4bF9od2NhcC4KIHR5cGUgSHdjYXAg
WzhddWludDMyCiAKQEAgLTQ1MywxMSArNDgxLDYgQEAgZnVuYyBTY2hlZHVsZXJGcm9tU3RyaW5n
KG5hbWUgc3RyaW5nKSAocyBTY2hlZHVsZXIsIGVyciBlcnJvcikgewogLy8gbGlieGxfY3B1cG9v
bGluZm8gKiBsaWJ4bF9saXN0X2NwdXBvb2wobGlieGxfY3R4KiwgaW50ICpuYl9wb29sX291dCk7
CiAvLyB2b2lkIGxpYnhsX2NwdXBvb2xpbmZvX2xpc3RfZnJlZShsaWJ4bF9jcHVwb29saW5mbyAq
bGlzdCwgaW50IG5iX3Bvb2wpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBMaXN0Q3B1cG9vbCgpIChs
aXN0IFtdQ3B1cG9vbGluZm8pIHsKLQllcnIgOj0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9
IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCXZhciBuYlBvb2wgQy5pbnQKIAogCWNfY3B1cG9vbF9s
aXN0IDo9IEMubGlieGxfbGlzdF9jcHVwb29sKEN0eC5jdHgsICZuYlBvb2wpCkBAIC00ODEsMTYg
KzUwNCwxMSBAQCBmdW5jIChDdHggKkNvbnRleHQpIExpc3RDcHVwb29sKCkgKGxpc3QgW11DcHVw
b29saW5mbykgewogCiAvLyBpbnQgbGlieGxfY3B1cG9vbF9pbmZvKGxpYnhsX2N0eCAqY3R4LCBs
aWJ4bF9jcHVwb29saW5mbyAqaW5mbywgdWludDMyX3QgcG9vbGlkKTsKIGZ1bmMgKEN0eCAqQ29u
dGV4dCkgQ3B1cG9vbEluZm8oUG9vbGlkIHVpbnQzMikgKHBvb2wgQ3B1cG9vbGluZm8pIHsKLQll
cnIgOj0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQog
CXZhciBjX2NwdXBvb2wgQy5saWJ4bF9jcHVwb29saW5mbwogCiAJcmV0IDo9IEMubGlieGxfY3B1
cG9vbF9pbmZvKEN0eC5jdHgsICZjX2NwdXBvb2wsIEMudWludDMyX3QoUG9vbGlkKSkKIAlpZiBy
ZXQgIT0gMCB7Ci0JCWVyciA9IEVycm9yKC1yZXQpCisJCS8vZXJyID0gRXJyb3IoLXJldCkKIAkJ
cmV0dXJuCiAJfQogCWRlZmVyIEMubGlieGxfY3B1cG9vbGluZm9fZGlzcG9zZSgmY19jcHVwb29s
KQpAQCAtNTA3LDExICs1MjUsNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xJbmZvKFBv
b2xpZCB1aW50MzIpIChwb29sIENwdXBvb2xpbmZvKSB7CiAvLyBGSVhNRTogdXVpZAogLy8gRklY
TUU6IFNldHRpbmcgcG9vbGlkCiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcmVhdGUoTmFt
ZSBzdHJpbmcsIFNjaGVkdWxlciBTY2hlZHVsZXIsIENwdW1hcCBCaXRtYXApIChlcnIgZXJyb3Is
IFBvb2xpZCB1aW50MzIpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuCi0JfQotCiAJcG9vbGlkIDo9IEMudWludDMyX3QoQy5MSUJYTF9DUFVQT09M
X1BPT0xJRF9BTlkpCiAJbmFtZSA6PSBDLkNTdHJpbmcoTmFtZSkKIAlkZWZlciBDLmZyZWUodW5z
YWZlLlBvaW50ZXIobmFtZSkpCkBAIC01NDAsMTEgKzU1Myw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4
dCkgQ3B1cG9vbENyZWF0ZShOYW1lIHN0cmluZywgU2NoZWR1bGVyIFNjaGVkdWxlciwgQ3B1bWFw
IEJpdG1hCiAKIC8vIGludCBsaWJ4bF9jcHVwb29sX2Rlc3Ryb3kobGlieGxfY3R4ICpjdHgsIHVp
bnQzMl90IHBvb2xpZCk7CiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xEZXN0cm95KFBvb2xp
ZCB1aW50MzIpIChlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIg
IT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfY3B1cG9vbF9kZXN0cm95
KEN0eC5jdHgsIEMudWludDMyX3QoUG9vbGlkKSkKIAlpZiByZXQgIT0gMCB7CiAJCWVyciA9IEVy
cm9yKC1yZXQpCkBAIC01NTYsMTEgKzU2NCw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9v
bERlc3Ryb3koUG9vbGlkIHVpbnQzMikgKGVyciBlcnJvcikgewogCiAvLyBpbnQgbGlieGxfY3B1
cG9vbF9jcHVhZGQobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IHBvb2xpZCwgaW50IGNwdSk7CiBm
dW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcHVhZGQoUG9vbGlkIHVpbnQzMiwgQ3B1IGludCkg
KGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBuaWwgewot
CQlyZXR1cm4KLQl9Ci0KIAlyZXQgOj0gQy5saWJ4bF9jcHVwb29sX2NwdWFkZChDdHguY3R4LCBD
LnVpbnQzMl90KFBvb2xpZCksIEMuaW50KENwdSkpCiAJaWYgcmV0ICE9IDAgewogCQllcnIgPSBF
cnJvcigtcmV0KQpAQCAtNTczLDExICs1NzYsNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIENwdXBv
b2xDcHVhZGQoUG9vbGlkIHVpbnQzMiwgQ3B1IGludCkgKGVyciBlcnJvcikgewogLy8gaW50IGxp
YnhsX2NwdXBvb2xfY3B1YWRkX2NwdW1hcChsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgcG9vbGlk
LAogLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9iaXRtYXAg
KmNwdW1hcCk7CiBmdW5jIChDdHggKkNvbnRleHQpIENwdXBvb2xDcHVhZGRDcHVtYXAoUG9vbGlk
IHVpbnQzMiwgQ3B1bWFwIEJpdG1hcCkgKGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09w
ZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAljYm0sIGVyciA6PSBDcHVt
YXAudG9DKCkKIAlpZiBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuCkBAIC01OTUsMTEgKzU5Myw2IEBA
IGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbENwdWFkZENwdW1hcChQb29saWQgdWludDMyLCBD
cHVtYXAgQml0bWFwKSAoZXJyIGVycm9yCiAKIC8vIGludCBsaWJ4bF9jcHVwb29sX2NwdXJlbW92
ZShsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgcG9vbGlkLCBpbnQgY3B1KTsKIGZ1bmMgKEN0eCAq
Q29udGV4dCkgQ3B1cG9vbENwdXJlbW92ZShQb29saWQgdWludDMyLCBDcHUgaW50KSAoZXJyIGVy
cm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVy
bgotCX0KLQogCXJldCA6PSBDLmxpYnhsX2NwdXBvb2xfY3B1cmVtb3ZlKEN0eC5jdHgsIEMudWlu
dDMyX3QoUG9vbGlkKSwgQy5pbnQoQ3B1KSkKIAlpZiByZXQgIT0gMCB7CiAJCWVyciA9IEVycm9y
KC1yZXQpCkBAIC02MTIsMTEgKzYwNSw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbENw
dXJlbW92ZShQb29saWQgdWludDMyLCBDcHUgaW50KSAoZXJyIGVycm9yKSB7CiAvLyBpbnQgbGli
eGxfY3B1cG9vbF9jcHVyZW1vdmVfY3B1bWFwKGxpYnhsX2N0eCAqY3R4LCB1aW50MzJfdCBwb29s
aWQsCiAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpYnhsX2Jp
dG1hcCAqY3B1bWFwKTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgQ3B1cG9vbENwdXJlbW92ZUNwdW1h
cChQb29saWQgdWludDMyLCBDcHVtYXAgQml0bWFwKSAoZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4
LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCWNibSwgZXJy
IDo9IENwdW1hcC50b0MoKQogCWlmIGVyciAhPSBuaWwgewogCQlyZXR1cm4KQEAgLTYzNCwxMSAr
NjIyLDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBDcHVwb29sQ3B1cmVtb3ZlQ3B1bWFwKFBvb2xp
ZCB1aW50MzIsIENwdW1hcCBCaXRtYXApIChlcnIgZXIKIAogLy8gaW50IGxpYnhsX2NwdXBvb2xf
cmVuYW1lKGxpYnhsX2N0eCAqY3R4LCBjb25zdCBjaGFyICpuYW1lLCB1aW50MzJfdCBwb29saWQp
OwogZnVuYyAoQ3R4ICpDb250ZXh0KSBDcHVwb29sUmVuYW1lKE5hbWUgc3RyaW5nLCBQb29saWQg
dWludDMyKSAoZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9
IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCW5hbWUgOj0gQy5DU3RyaW5nKE5hbWUpCiAJZGVmZXIg
Qy5mcmVlKHVuc2FmZS5Qb2ludGVyKG5hbWUpKQogCkBAIC02NTMsMTEgKzYzNiw2IEBAIGZ1bmMg
KEN0eCAqQ29udGV4dCkgQ3B1cG9vbFJlbmFtZShOYW1lIHN0cmluZywgUG9vbGlkIHVpbnQzMikg
KGVyciBlcnJvcikgewogCiAvLyBpbnQgbGlieGxfY3B1cG9vbF9jcHVhZGRfbm9kZShsaWJ4bF9j
dHggKmN0eCwgdWludDMyX3QgcG9vbGlkLCBpbnQgbm9kZSwgaW50ICpjcHVzKTsKIGZ1bmMgKEN0
eCAqQ29udGV4dCkgQ3B1cG9vbENwdWFkZE5vZGUoUG9vbGlkIHVpbnQzMiwgTm9kZSBpbnQpIChD
cHVzIGludCwgZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9
IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCWNjcHVzIDo9IEMuaW50KDApCiAKIAlyZXQgOj0gQy5s
aWJ4bF9jcHVwb29sX2NwdWFkZF9ub2RlKEN0eC5jdHgsIEMudWludDMyX3QoUG9vbGlkKSwgQy5p
bnQoTm9kZSksICZjY3B1cykKQEAgLTY3MywxMSArNjUxLDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0
KSBDcHVwb29sQ3B1YWRkTm9kZShQb29saWQgdWludDMyLCBOb2RlIGludCkgKENwdXMgaW50LCBl
cnIgZXIKIAogLy8gaW50IGxpYnhsX2NwdXBvb2xfY3B1cmVtb3ZlX25vZGUobGlieGxfY3R4ICpj
dHgsIHVpbnQzMl90IHBvb2xpZCwgaW50IG5vZGUsIGludCAqY3B1cyk7CiBmdW5jIChDdHggKkNv
bnRleHQpIENwdXBvb2xDcHVyZW1vdmVOb2RlKFBvb2xpZCB1aW50MzIsIE5vZGUgaW50KSAoQ3B1
cyBpbnQsIGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBu
aWwgewotCQlyZXR1cm4KLQl9Ci0KIAljY3B1cyA6PSBDLmludCgwKQogCiAJcmV0IDo9IEMubGli
eGxfY3B1cG9vbF9jcHVyZW1vdmVfbm9kZShDdHguY3R4LCBDLnVpbnQzMl90KFBvb2xpZCksIEMu
aW50KE5vZGUpLCAmY2NwdXMpCkBAIC02OTMsMTEgKzY2Niw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4
dCkgQ3B1cG9vbENwdXJlbW92ZU5vZGUoUG9vbGlkIHVpbnQzMiwgTm9kZSBpbnQpIChDcHVzIGlu
dCwgZXJyCiAKIC8vIGludCBsaWJ4bF9jcHVwb29sX21vdmVkb21haW4obGlieGxfY3R4ICpjdHgs
IHVpbnQzMl90IHBvb2xpZCwgdWludDMyX3QgZG9taWQpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBD
cHVwb29sTW92ZWRvbWFpbihQb29saWQgdWludDMyLCBJZCBEb21pZCkgKGVyciBlcnJvcikgewot
CWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0K
IAlyZXQgOj0gQy5saWJ4bF9jcHVwb29sX21vdmVkb21haW4oQ3R4LmN0eCwgQy51aW50MzJfdChQ
b29saWQpLCBDLnVpbnQzMl90KElkKSkKIAlpZiByZXQgIT0gMCB7CiAJCWVyciA9IEVycm9yKC1y
ZXQpCkBAIC04NTcsNjAgKzgyNSw4IEBAIGZ1bmMgKGJtIEJpdG1hcCkgU3RyaW5nKCkgKHMgc3Ry
aW5nKSB7CiAJcmV0dXJuCiB9CiAKLS8qCi0gKiBDb250ZXh0Ci0gKi8KLXZhciBDdHggQ29udGV4
dAotCi1mdW5jIChDdHggKkNvbnRleHQpIElzT3BlbigpIGJvb2wgewotCXJldHVybiBDdHguY3R4
ICE9IG5pbAotfQotCi1mdW5jIChDdHggKkNvbnRleHQpIE9wZW4oKSAoZXJyIGVycm9yKSB7Ci0J
aWYgQ3R4LmN0eCAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KLQlDdHgubG9nZ2VyID0gQy54dGxf
Y3JlYXRlbG9nZ2VyX3N0ZGlvc3RyZWFtKEMuc3RkZXJyLCBDLlhUTF9FUlJPUiwgMCkKLQlpZiBD
dHgubG9nZ2VyID09IG5pbCB7Ci0JCWVyciA9IGZtdC5FcnJvcmYoIkNhbm5vdCBvcGVuIHN0ZGlv
c3RyZWFtIikKLQkJcmV0dXJuCi0JfQotCi0JcmV0IDo9IEMubGlieGxfY3R4X2FsbG9jKCZDdHgu
Y3R4LCBDLkxJQlhMX1ZFUlNJT04sCi0JCTAsICgqQy54ZW50b29sbG9nX2xvZ2dlcikodW5zYWZl
LlBvaW50ZXIoQ3R4LmxvZ2dlcikpKQotCi0JaWYgcmV0ICE9IDAgewotCQllcnIgPSBFcnJvcigt
cmV0KQotCX0KLQlyZXR1cm4KLX0KLQotZnVuYyAoQ3R4ICpDb250ZXh0KSBDbG9zZSgpIChlcnIg
ZXJyb3IpIHsKLQlyZXQgOj0gQy5saWJ4bF9jdHhfZnJlZShDdHguY3R4KQotCUN0eC5jdHggPSBu
aWwKLQotCWlmIHJldCAhPSAwIHsKLQkJZXJyID0gRXJyb3IoLXJldCkKLQl9Ci0JQy54dGxfbG9n
Z2VyX2Rlc3Ryb3koKCpDLnhlbnRvb2xsb2dfbG9nZ2VyKSh1bnNhZmUuUG9pbnRlcihDdHgubG9n
Z2VyKSkpCi0JcmV0dXJuCi19Ci0KLWZ1bmMgKEN0eCAqQ29udGV4dCkgQ2hlY2tPcGVuKCkgKGVy
ciBlcnJvcikgewotCWlmIEN0eC5jdHggPT0gbmlsIHsKLQkJZXJyID0gZm10LkVycm9yZigiQ29u
dGV4dCBub3Qgb3BlbmVkIikKLQl9Ci0JcmV0dXJuCi19Ci0KIC8vaW50IGxpYnhsX2dldF9tYXhf
Y3B1cyhsaWJ4bF9jdHggKmN0eCk7CiBmdW5jIChDdHggKkNvbnRleHQpIEdldE1heENwdXMoKSAo
bWF4Q3B1cyBpbnQsIGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVy
ciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAlyZXQgOj0gQy5saWJ4bF9nZXRfbWF4X2NwdXMo
Q3R4LmN0eCkKIAlpZiByZXQgPCAwIHsKIAkJZXJyID0gRXJyb3IoLXJldCkKQEAgLTkyMiwxMSAr
ODM4LDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBHZXRNYXhDcHVzKCkgKG1heENwdXMgaW50LCBl
cnIgZXJyb3IpIHsKIAogLy9pbnQgbGlieGxfZ2V0X29ubGluZV9jcHVzKGxpYnhsX2N0eCAqY3R4
KTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgR2V0T25saW5lQ3B1cygpIChvbkNwdXMgaW50LCBlcnIg
ZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0
dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfZ2V0X29ubGluZV9jcHVzKEN0eC5jdHgpCiAJaWYg
cmV0IDwgMCB7CiAJCWVyciA9IEVycm9yKC1yZXQpCkBAIC05MzgsMTAgKzg0OSw2IEBAIGZ1bmMg
KEN0eCAqQ29udGV4dCkgR2V0T25saW5lQ3B1cygpIChvbkNwdXMgaW50LCBlcnIgZXJyb3IpIHsK
IAogLy9pbnQgbGlieGxfZ2V0X21heF9ub2RlcyhsaWJ4bF9jdHggKmN0eCk7CiBmdW5jIChDdHgg
KkNvbnRleHQpIEdldE1heE5vZGVzKCkgKG1heE5vZGVzIGludCwgZXJyIGVycm9yKSB7Ci0JZXJy
ID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KIAlyZXQg
Oj0gQy5saWJ4bF9nZXRfbWF4X25vZGVzKEN0eC5jdHgpCiAJaWYgcmV0IDwgMCB7CiAJCWVyciA9
IEVycm9yKC1yZXQpCkBAIC05NTMsMTAgKzg2MCw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgR2V0
TWF4Tm9kZXMoKSAobWF4Tm9kZXMgaW50LCBlcnIgZXJyb3IpIHsKIAogLy9pbnQgbGlieGxfZ2V0
X2ZyZWVfbWVtb3J5KGxpYnhsX2N0eCAqY3R4LCB1aW50NjRfdCAqbWVta2IpOwogZnVuYyAoQ3R4
ICpDb250ZXh0KSBHZXRGcmVlTWVtb3J5KCkgKG1lbWtiIHVpbnQ2NCwgZXJyIGVycm9yKSB7Ci0J
ZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYgZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KIAl2
YXIgY21lbSBDLnVpbnQ2NF90CiAJcmV0IDo9IEMubGlieGxfZ2V0X2ZyZWVfbWVtb3J5KEN0eC5j
dHgsICZjbWVtKQogCkBAIC05NzIsMTAgKzg3NSw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgR2V0
RnJlZU1lbW9yeSgpIChtZW1rYiB1aW50NjQsIGVyciBlcnJvcikgewogCiAvL2ludCBsaWJ4bF9n
ZXRfcGh5c2luZm8obGlieGxfY3R4ICpjdHgsIGxpYnhsX3BoeXNpbmZvICpwaHlzaW5mbykKIGZ1
bmMgKEN0eCAqQ29udGV4dCkgR2V0UGh5c2luZm8oKSAocGh5c2luZm8gKlBoeXNpbmZvLCBlcnIg
ZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0
dXJuCi0JfQogCXZhciBjcGh5cyBDLmxpYnhsX3BoeXNpbmZvCiAJQy5saWJ4bF9waHlzaW5mb19p
bml0KCZjcGh5cykKIAlkZWZlciBDLmxpYnhsX3BoeXNpbmZvX2Rpc3Bvc2UoJmNwaHlzKQpAQCAt
OTkzLDExICs4OTIsNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIEdldFBoeXNpbmZvKCkgKHBoeXNp
bmZvICpQaHlzaW5mbywgZXJyIGVycm9yKSB7CiAKIC8vY29uc3QgbGlieGxfdmVyc2lvbl9pbmZv
KiBsaWJ4bF9nZXRfdmVyc2lvbl9pbmZvKGxpYnhsX2N0eCAqY3R4KTsKIGZ1bmMgKEN0eCAqQ29u
dGV4dCkgR2V0VmVyc2lvbkluZm8oKSAoaW5mbyAqVmVyc2lvbkluZm8sIGVyciBlcnJvcikgewot
CWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0K
IAl2YXIgY2luZm8gKkMubGlieGxfdmVyc2lvbl9pbmZvCiAKIAljaW5mbyA9IEMubGlieGxfZ2V0
X3ZlcnNpb25faW5mbyhDdHguY3R4KQpAQCAtMTAwOCwxMSArOTAyLDYgQEAgZnVuYyAoQ3R4ICpD
b250ZXh0KSBHZXRWZXJzaW9uSW5mbygpIChpbmZvICpWZXJzaW9uSW5mbywgZXJyIGVycm9yKSB7
CiB9CiAKIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluSW5mbyhJZCBEb21pZCkgKGRpICpEb21p
bmZvLCBlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuCi0JfQotCiAJdmFyIGNkaSBDLmxpYnhsX2RvbWluZm8KIAlDLmxpYnhsX2Rv
bWluZm9faW5pdCgmY2RpKQogCWRlZmVyIEMubGlieGxfZG9taW5mb19kaXNwb3NlKCZjZGkpCkBA
IC0xMDMwLDExICs5MTksNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIERvbWFpbkluZm8oSWQgRG9t
aWQpIChkaSAqRG9taW5mbywgZXJyIGVycm9yKSB7CiB9CiAKIGZ1bmMgKEN0eCAqQ29udGV4dCkg
RG9tYWluVW5wYXVzZShJZCBEb21pZCkgKGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09w
ZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAlyZXQgOj0gQy5saWJ4bF9k
b21haW5fdW5wYXVzZShDdHguY3R4LCBDLnVpbnQzMl90KElkKSwgbmlsKQogCiAJaWYgcmV0ICE9
IDAgewpAQCAtMTA0NSwxMSArOTI5LDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBEb21haW5VbnBh
dXNlKElkIERvbWlkKSAoZXJyIGVycm9yKSB7CiAKIC8vaW50IGxpYnhsX2RvbWFpbl9wYXVzZShs
aWJ4bF9jdHggKmN0eCwgdWludDMyX3QgZG9tYWluKTsKIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9t
YWluUGF1c2UoaWQgRG9taWQpIChlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkK
LQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfZG9tYWlu
X3BhdXNlKEN0eC5jdHgsIEMudWludDMyX3QoaWQpLCBuaWwpCiAKIAlpZiByZXQgIT0gMCB7CkBA
IC0xMDYwLDExICs5MzksNiBAQCBmdW5jIChDdHggKkNvbnRleHQpIERvbWFpblBhdXNlKGlkIERv
bWlkKSAoZXJyIGVycm9yKSB7CiAKIC8vaW50IGxpYnhsX2RvbWFpbl9zaHV0ZG93bihsaWJ4bF9j
dHggKmN0eCwgdWludDMyX3QgZG9taWQpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBEb21haW5TaHV0
ZG93bihpZCBEb21pZCkgKGVyciBlcnJvcikgewotCWVyciA9IEN0eC5DaGVja09wZW4oKQotCWlm
IGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAlyZXQgOj0gQy5saWJ4bF9kb21haW5fc2h1
dGRvd24oQ3R4LmN0eCwgQy51aW50MzJfdChpZCksIG5pbCkKIAogCWlmIHJldCAhPSAwIHsKQEAg
LTEwNzUsMTEgKzk0OSw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluU2h1dGRvd24oaWQg
RG9taWQpIChlcnIgZXJyb3IpIHsKIAogLy9pbnQgbGlieGxfZG9tYWluX3JlYm9vdChsaWJ4bF9j
dHggKmN0eCwgdWludDMyX3QgZG9taWQpOwogZnVuYyAoQ3R4ICpDb250ZXh0KSBEb21haW5SZWJv
b3QoaWQgRG9taWQpIChlcnIgZXJyb3IpIHsKLQllcnIgPSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBl
cnIgIT0gbmlsIHsKLQkJcmV0dXJuCi0JfQotCiAJcmV0IDo9IEMubGlieGxfZG9tYWluX3JlYm9v
dChDdHguY3R4LCBDLnVpbnQzMl90KGlkKSwgbmlsKQogCiAJaWYgcmV0ICE9IDAgewpAQCAtMTA5
MSwxMSArOTYwLDYgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBEb21haW5SZWJvb3QoaWQgRG9taWQp
IChlcnIgZXJyb3IpIHsKIC8vbGlieGxfZG9taW5mbyAqIGxpYnhsX2xpc3RfZG9tYWluKGxpYnhs
X2N0eCosIGludCAqbmJfZG9tYWluX291dCk7CiAvL3ZvaWQgbGlieGxfZG9taW5mb19saXN0X2Zy
ZWUobGlieGxfZG9taW5mbyAqbGlzdCwgaW50IG5iX2RvbWFpbik7CiBmdW5jIChDdHggKkNvbnRl
eHQpIExpc3REb21haW4oKSAoZ2xpc3QgW11Eb21pbmZvKSB7Ci0JZXJyIDo9IEN0eC5DaGVja09w
ZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAl2YXIgbmJEb21haW4gQy5p
bnQKIAljbGlzdCA6PSBDLmxpYnhsX2xpc3RfZG9tYWluKEN0eC5jdHgsICZuYkRvbWFpbikKIAlk
ZWZlciBDLmxpYnhsX2RvbWluZm9fbGlzdF9mcmVlKGNsaXN0LCBuYkRvbWFpbikKQEAgLTExMTgs
MTEgKzk4Miw2IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgTGlzdERvbWFpbigpIChnbGlzdCBbXURv
bWluZm8pIHsKIC8vCQkJCWludCAqbmJfdmNwdSwgaW50ICpucl9jcHVzX291dCk7CiAvL3ZvaWQg
bGlieGxfdmNwdWluZm9fbGlzdF9mcmVlKGxpYnhsX3ZjcHVpbmZvICosIGludCBucl92Y3B1cyk7
CiBmdW5jIChDdHggKkNvbnRleHQpIExpc3RWY3B1KGlkIERvbWlkKSAoZ2xpc3QgW11WY3B1aW5m
bykgewotCWVyciA6PSBDdHguQ2hlY2tPcGVuKCkKLQlpZiBlcnIgIT0gbmlsIHsKLQkJcmV0dXJu
Ci0JfQotCiAJdmFyIG5iVmNwdSBDLmludAogCXZhciBuckNwdSBDLmludAogCkBAIC0xMTUzLDEx
ICsxMDEyLDYgQEAgZnVuYyAoY3QgQ29uc29sZVR5cGUpIFN0cmluZygpIChzdHIgc3RyaW5nKSB7
CiAvL2ludCBsaWJ4bF9jb25zb2xlX2dldF90dHkobGlieGxfY3R4ICpjdHgsIHVpbnQzMl90IGRv
bWlkLCBpbnQgY29uc19udW0sCiAvL2xpYnhsX2NvbnNvbGVfdHlwZSB0eXBlLCBjaGFyICoqcGF0
aCk7CiBmdW5jIChDdHggKkNvbnRleHQpIENvbnNvbGVHZXRUdHkoaWQgRG9taWQsIGNvbnNOdW0g
aW50LCBjb25UeXBlIENvbnNvbGVUeXBlKSAocGF0aCBzdHJpbmcsIGVyciBlcnJvcikgewotCWVy
ciA9IEN0eC5DaGVja09wZW4oKQotCWlmIGVyciAhPSBuaWwgewotCQlyZXR1cm4KLQl9Ci0KIAl2
YXIgY3BhdGggKkMuY2hhcgogCXJldCA6PSBDLmxpYnhsX2NvbnNvbGVfZ2V0X3R0eShDdHguY3R4
LCBDLnVpbnQzMl90KGlkKSwgQy5pbnQoY29uc051bSksIEMubGlieGxfY29uc29sZV90eXBlKGNv
blR5cGUpLCAmY3BhdGgpCiAJaWYgcmV0ICE9IDAgewpAQCAtMTE3MywxMSArMTAyNyw2IEBAIGZ1
bmMgKEN0eCAqQ29udGV4dCkgQ29uc29sZUdldFR0eShpZCBEb21pZCwgY29uc051bSBpbnQsIGNv
blR5cGUgQ29uc29sZVR5cGUpIChwCiAvL2ludCBsaWJ4bF9wcmltYXJ5X2NvbnNvbGVfZ2V0X3R0
eShsaWJ4bF9jdHggKmN0eCwgdWludDMyX3QgZG9taWRfdm0sCiAvLwkJCQkJY2hhciAqKnBhdGgp
OwogZnVuYyAoQ3R4ICpDb250ZXh0KSBQcmltYXJ5Q29uc29sZUdldFR0eShkb21pZCB1aW50MzIp
IChwYXRoIHN0cmluZywgZXJyIGVycm9yKSB7Ci0JZXJyID0gQ3R4LkNoZWNrT3BlbigpCi0JaWYg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybgotCX0KLQogCXZhciBjcGF0aCAqQy5jaGFyCiAJcmV0IDo9
IEMubGlieGxfcHJpbWFyeV9jb25zb2xlX2dldF90dHkoQ3R4LmN0eCwgQy51aW50MzJfdChkb21p
ZCksICZjcGF0aCkKIAlpZiByZXQgIT0gMCB7Ci0tIAoyLjE5LjEKCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhl
bi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3Jn
L21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

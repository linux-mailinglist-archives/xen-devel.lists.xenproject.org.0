Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 05E04C01A6
	for <lists+xen-devel@lfdr.de>; Fri, 27 Sep 2019 11:03:16 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDm7T-0005Lh-Cm; Fri, 27 Sep 2019 09:00:55 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=Rbpq=XW=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iDm7R-0005Kw-VX
 for xen-devel@lists.xenproject.org; Fri, 27 Sep 2019 09:00:54 +0000
X-Inumbo-ID: 4e3d9c75-e105-11e9-9671-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 4e3d9c75-e105-11e9-9671-12813bfff9fa;
 Fri, 27 Sep 2019 09:00:52 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 3CDF5AFE3;
 Fri, 27 Sep 2019 09:00:51 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 27 Sep 2019 11:00:45 +0200
Message-Id: <20190927090048.28872-4-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190927090048.28872-1-jgross@suse.com>
References: <20190927090048.28872-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v1 3/6] libs: add libxenhypfs
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Ian Jackson <ian.jackson@eu.citrix.com>,
 Wei Liu <wl@xen.org>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIHRoZSBuZXcgbGlicmFyeSBsaWJ4ZW5oeXBmcyBmb3IgYWNjZXNzIHRvIHRoZSBoeXBlcnZp
c29yIGZpbGVzeXN0ZW0uCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3Vz
ZS5jb20+Ci0tLQpWMToKLSByZW5hbWUgdG8gbGlieGVuaHlwZnMKLSBhZGQgeGVuaHlwZnNfd3Jp
dGUoKQotLS0KIHRvb2xzL1J1bGVzLm1rICAgICAgICAgICAgICAgICAgICAgIHwgICA2ICsKIHRv
b2xzL2xpYnMvTWFrZWZpbGUgICAgICAgICAgICAgICAgIHwgICAxICsKIHRvb2xzL2xpYnMvaHlw
ZnMvTWFrZWZpbGUgICAgICAgICAgIHwgIDE0ICsrCiB0b29scy9saWJzL2h5cGZzL2NvcmUuYyAg
ICAgICAgICAgICB8IDI1MiArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHRv
b2xzL2xpYnMvaHlwZnMvaW5jbHVkZS94ZW5oeXBmcy5oIHwgIDYwICsrKysrKysrKwogdG9vbHMv
bGlicy9oeXBmcy9saWJ4ZW5oeXBmcy5tYXAgICAgfCAgIDkgKysKIHRvb2xzL2xpYnMvaHlwZnMv
eGVuaHlwZnMucGMuaW4gICAgIHwgIDEwICsrCiA3IGZpbGVzIGNoYW5nZWQsIDM1MiBpbnNlcnRp
b25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgdG9vbHMvbGlicy9oeXBmcy9NYWtlZmlsZQogY3Jl
YXRlIG1vZGUgMTAwNjQ0IHRvb2xzL2xpYnMvaHlwZnMvY29yZS5jCiBjcmVhdGUgbW9kZSAxMDA2
NDQgdG9vbHMvbGlicy9oeXBmcy9pbmNsdWRlL3hlbmh5cGZzLmgKIGNyZWF0ZSBtb2RlIDEwMDY0
NCB0b29scy9saWJzL2h5cGZzL2xpYnhlbmh5cGZzLm1hcAogY3JlYXRlIG1vZGUgMTAwNjQ0IHRv
b2xzL2xpYnMvaHlwZnMveGVuaHlwZnMucGMuaW4KCmRpZmYgLS1naXQgYS90b29scy9SdWxlcy5t
ayBiL3Rvb2xzL1J1bGVzLm1rCmluZGV4IGNmODkzNWQ2YTMuLmIxZWJiNGM5NmMgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL1J1bGVzLm1rCisrKyBiL3Rvb2xzL1J1bGVzLm1rCkBAIC0xOSw2ICsxOSw3IEBA
IFhFTl9MSUJYRU5HTlRUQUIgICA9ICQoWEVOX1JPT1QpL3Rvb2xzL2xpYnMvZ250dGFiCiBYRU5f
TElCWEVOQ0FMTCAgICAgPSAkKFhFTl9ST09UKS90b29scy9saWJzL2NhbGwKIFhFTl9MSUJYRU5G
T1JFSUdOTUVNT1JZID0gJChYRU5fUk9PVCkvdG9vbHMvbGlicy9mb3JlaWdubWVtb3J5CiBYRU5f
TElCWEVOREVWSUNFTU9ERUwgPSAkKFhFTl9ST09UKS90b29scy9saWJzL2RldmljZW1vZGVsCitY
RU5fTElCWEVOSFlQRlMgICAgPSAkKFhFTl9ST09UKS90b29scy9saWJzL2h5cGZzCiBYRU5fTElC
WEMgICAgICAgICAgPSAkKFhFTl9ST09UKS90b29scy9saWJ4YwogWEVOX1hFTkxJR0hUICAgICAg
ID0gJChYRU5fUk9PVCkvdG9vbHMvbGlieGwKICMgQ3VycmVudGx5IGxpYnhsdXRpbCBsaXZlcyBp
biB0aGUgc2FtZSBkaXJlY3RvcnkgYXMgbGlieGVubGlnaHQKQEAgLTEzNCw2ICsxMzUsMTEgQEAg
U0hERVBTX2xpYnhlbmRldmljZW1vZGVsID0gJChTSExJQl9saWJ4ZW50b29sbG9nKSAkKFNITElC
X2xpYnhlbnRvb2xjb3JlKSAkKFNITEkKIExETElCU19saWJ4ZW5kZXZpY2Vtb2RlbCA9ICQoU0hE
RVBTX2xpYnhlbmRldmljZW1vZGVsKSAkKFhFTl9MSUJYRU5ERVZJQ0VNT0RFTCkvbGlieGVuZGV2
aWNlbW9kZWwkKGxpYmV4dGVuc2lvbikKIFNITElCX2xpYnhlbmRldmljZW1vZGVsICA9ICQoU0hE
RVBTX2xpYnhlbmRldmljZW1vZGVsKSAtV2wsLXJwYXRoLWxpbms9JChYRU5fTElCWEVOREVWSUNF
TU9ERUwpCiAKK0NGTEFHU19saWJ4ZW5oeXBmcyA9IC1JJChYRU5fTElCWEVOSFlQRlMpL2luY2x1
ZGUgJChDRkxBR1NfeGVuaW5jbHVkZSkKK1NIREVQU19saWJ4ZW5oeXBmcyA9ICQoU0hMSUJfbGli
eGVudG9vbGxvZykgJChTSExJQl9saWJ4ZW50b29sY29yZSkgJChTSExJQl94ZW5jYWxsKQorTERM
SUJTX2xpYnhlbmh5cGZzID0gJChTSERFUFNfbGlieGVuaHlwZnMpICQoWEVOX0xJQlhFTkhZUEZT
KS9saWJ4ZW5oeXBmcyQobGliZXh0ZW5zaW9uKQorU0hMSUJfbGlieGVuaHlwZnMgID0gJChTSERF
UFNfbGlieGVuaHlwZnMpIC1XbCwtcnBhdGgtbGluaz0kKFhFTl9MSUJYRU5IWVBGUykKKwogIyBj
b2RlIHdoaWNoIGNvbXBpbGVzIGFnYWluc3QgbGlieGVuY3RybCBnZXQgX19YRU5fVE9PTFNfXyBh
bmQKICMgdGhlcmVmb3JlIHNlZXMgdGhlIHVuc3RhYmxlIGh5cGVyY2FsbCBpbnRlcmZhY2VzLgog
Q0ZMQUdTX2xpYnhlbmN0cmwgPSAtSSQoWEVOX0xJQlhDKS9pbmNsdWRlICQoQ0ZMQUdTX2xpYnhl
bnRvb2xsb2cpICQoQ0ZMQUdTX2xpYnhlbmZvcmVpZ25tZW1vcnkpICQoQ0ZMQUdTX2xpYnhlbmRl
dmljZW1vZGVsKSAkKENGTEFHU194ZW5pbmNsdWRlKSAtRF9fWEVOX1RPT0xTX18KZGlmZiAtLWdp
dCBhL3Rvb2xzL2xpYnMvTWFrZWZpbGUgYi90b29scy9saWJzL01ha2VmaWxlCmluZGV4IDg4OTAx
ZTczNDEuLjY5Y2RmYjU5NzUgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnMvTWFrZWZpbGUKKysrIGIv
dG9vbHMvbGlicy9NYWtlZmlsZQpAQCAtOSw2ICs5LDcgQEAgU1VCRElSUy15ICs9IGdudHRhYgog
U1VCRElSUy15ICs9IGNhbGwKIFNVQkRJUlMteSArPSBmb3JlaWdubWVtb3J5CiBTVUJESVJTLXkg
Kz0gZGV2aWNlbW9kZWwKK1NVQkRJUlMteSArPSBoeXBmcwogCiBpZmVxICgkKENPTkZJR19SVU1Q
KSx5KQogU1VCRElSUy15IDo9IHRvb2xjb3JlCmRpZmYgLS1naXQgYS90b29scy9saWJzL2h5cGZz
L01ha2VmaWxlIGIvdG9vbHMvbGlicy9oeXBmcy9NYWtlZmlsZQpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwLi5jNTcxNTk3Njg2Ci0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMv
bGlicy9oeXBmcy9NYWtlZmlsZQpAQCAtMCwwICsxLDE0IEBACitYRU5fUk9PVCA9ICQoQ1VSRElS
KS8uLi8uLi8uLgoraW5jbHVkZSAkKFhFTl9ST09UKS90b29scy9SdWxlcy5taworCitNQUpPUiAg
ICA9IDEKK01JTk9SICAgID0gMAorTElCTkFNRSAgOj0gaHlwZnMKK1VTRUxJQlMgIDo9IHRvb2xs
b2cgdG9vbGNvcmUgY2FsbAorCitTUkNTLXkgICAgICAgICAgICAgICAgICs9IGNvcmUuYworCitp
bmNsdWRlIC4uL2xpYnMubWsKKworJChQS0dfQ09ORklHX0xPQ0FMKTogUEtHX0NPTkZJR19JTkNE
SVIgPSAkKFhFTl9MSUJYRU5IWVBGUykvaW5jbHVkZQorJChQS0dfQ09ORklHX0xPQ0FMKTogUEtH
X0NPTkZJR19DRkxBR1NfTE9DQUwgPSAkKENGTEFHU194ZW5pbmNsdWRlKQpkaWZmIC0tZ2l0IGEv
dG9vbHMvbGlicy9oeXBmcy9jb3JlLmMgYi90b29scy9saWJzL2h5cGZzL2NvcmUuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi5lZGJmMzdmMmMxCi0tLSAvZGV2L251bGwK
KysrIGIvdG9vbHMvbGlicy9oeXBmcy9jb3JlLmMKQEAgLTAsMCArMSwyNTIgQEAKKy8qCisgKiBD
b3B5cmlnaHQgKGMpIDIwMTkgU1VTRSBTb2Z0d2FyZSBTb2x1dGlvbnMgR2VybWFueSBHbWJICisg
KgorICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRl
IGl0IGFuZC9vcgorICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYworICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29m
dHdhcmUgRm91bmRhdGlvbjsKKyAqIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLgorICoKKyAq
IFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUg
dXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGlt
cGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZl
ZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2UgYWxv
bmcgd2l0aCB0aGlzIGxpYnJhcnk7IElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGlj
ZW5zZXMvPi4KKyAqLworCisjZGVmaW5lIF9fWEVOX1RPT0xTX18gMQorCisjaW5jbHVkZSA8ZXJy
bm8uaD4KKyNpbmNsdWRlIDxzdGRsaWIuaD4KKyNpbmNsdWRlIDxzdHJpbmcuaD4KKworI2luY2x1
ZGUgPHhlbnRvb2xsb2cuaD4KKyNpbmNsdWRlIDx4ZW5oeXBmcy5oPgorI2luY2x1ZGUgPHhlbmNh
bGwuaD4KKworI2luY2x1ZGUgPHhlbnRvb2xjb3JlX2ludGVybmFsLmg+CisKK3N0cnVjdCB4ZW5o
eXBmc19oYW5kbGUgeworICAgIHhlbnRvb2xsb2dfbG9nZ2VyICpsb2dnZXIsICpsb2dnZXJfdG9m
cmVlOworICAgIHVuc2lnbmVkIGludCBmbGFnczsKKyAgICB4ZW5jYWxsX2hhbmRsZSAqeGNhbGw7
Cit9OworCit4ZW5oeXBmc19oYW5kbGUgKnhlbmh5cGZzX29wZW4oeGVudG9vbGxvZ19sb2dnZXIg
KmxvZ2dlciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBvcGVuX2Zs
YWdzKQoreworICAgIHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwgPSBjYWxsb2MoMSwgc2l6ZW9mKCpm
c2hkbCkpOworCisgICAgaWYgKCFmc2hkbCkKKyAgICAgICAgcmV0dXJuIE5VTEw7CisKKyAgICBm
c2hkbC0+ZmxhZ3MgPSBvcGVuX2ZsYWdzOworICAgIGZzaGRsLT5sb2dnZXIgPSBsb2dnZXI7Cisg
ICAgZnNoZGwtPmxvZ2dlcl90b2ZyZWUgPSBOVUxMOworCisgICAgaWYgKCFmc2hkbC0+bG9nZ2Vy
KSB7CisgICAgICAgIGZzaGRsLT5sb2dnZXIgPSBmc2hkbC0+bG9nZ2VyX3RvZnJlZSA9CisgICAg
ICAgICAgICAoeGVudG9vbGxvZ19sb2dnZXIqKQorICAgICAgICAgICAgeHRsX2NyZWF0ZWxvZ2dl
cl9zdGRpb3N0cmVhbShzdGRlcnIsIFhUTF9QUk9HUkVTUywgMCk7CisgICAgICAgIGlmICghZnNo
ZGwtPmxvZ2dlcikKKyAgICAgICAgICAgIGdvdG8gZXJyOworICAgIH0KKworICAgIGZzaGRsLT54
Y2FsbCA9IHhlbmNhbGxfb3Blbihmc2hkbC0+bG9nZ2VyLCAwKTsKKyAgICBpZiAoIWZzaGRsLT54
Y2FsbCkKKyAgICAgICAgZ290byBlcnI7CisKKworICAgIHJldHVybiBmc2hkbDsKKworZXJyOgor
ICAgIHh0bF9sb2dnZXJfZGVzdHJveShmc2hkbC0+bG9nZ2VyX3RvZnJlZSk7CisgICAgeGVuY2Fs
bF9jbG9zZShmc2hkbC0+eGNhbGwpOworICAgIGZyZWUoZnNoZGwpOworICAgIHJldHVybiBOVUxM
OworfQorCitpbnQgeGVuaHlwZnNfY2xvc2UoeGVuaHlwZnNfaGFuZGxlICpmc2hkbCkKK3sKKyAg
ICBpZiAoIWZzaGRsKQorICAgICAgICByZXR1cm4gMDsKKworICAgIHhlbmNhbGxfY2xvc2UoZnNo
ZGwtPnhjYWxsKTsKKyAgICB4dGxfbG9nZ2VyX2Rlc3Ryb3koZnNoZGwtPmxvZ2dlcl90b2ZyZWUp
OworICAgIGZyZWUoZnNoZGwpOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgaW50IHhlbmh5
cGZzX2dldF9wYXRoYnVmKHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBhdGgs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKipwYXRoX2J1ZikKK3sKKyAg
ICBpbnQgcmV0ID0gLTE7CisgICAgaW50IHBhdGhfc3o7CisKKyAgICBpZiAoIWZzaGRsKSB7Cisg
ICAgICAgIGVycm5vID0gRUJBREY7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAgIHBh
dGhfc3ogPSBzdHJsZW4ocGF0aCkgKyAxOworICAgIGlmIChwYXRoX3N6ID4gWEVOX0hZUEZTX01B
WF9QQVRITEVOKQorICAgIHsKKyAgICAgICAgZXJybm8gPSBFTkFNRVRPT0xPTkc7CisgICAgICAg
IGdvdG8gb3V0OworICAgIH0KKworICAgICpwYXRoX2J1ZiA9IHhlbmNhbGxfYWxsb2NfYnVmZmVy
KGZzaGRsLT54Y2FsbCwgcGF0aF9zeik7CisgICAgaWYgKCEqcGF0aF9idWYpIHsKKyAgICAgICAg
ZXJybm8gPSBFTk9NRU07CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKyAgICBzdHJjcHkoKnBh
dGhfYnVmLCBwYXRoKTsKKworICAgIHJldCA9IHBhdGhfc3o7CisKKyBvdXQ6CisgICAgcmV0dXJu
IHJldDsKK30KKworc3RhdGljIHZvaWQgKnhlbmh5cGZzX3JlYWRfYW55KHhlbmh5cGZzX2hhbmRs
ZSAqZnNoZGwsIGNvbnN0IGNoYXIgKnBhdGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IGNtZCkKK3sKKyAgICBjaGFyICpidWYgPSBOVUxMLCAqcGF0aF9idWYg
PSBOVUxMOworICAgIGludCByZXQ7CisgICAgaW50IHN6LCBwYXRoX3N6OworCisgICAgcmV0ID0g
eGVuaHlwZnNfZ2V0X3BhdGhidWYoZnNoZGwsIHBhdGgsICZwYXRoX2J1Zik7CisgICAgaWYgKHJl
dCA8IDApCisgICAgICAgIGdvdG8gb3V0OworCisgICAgcGF0aF9zeiA9IHJldDsKKworICAgIGZv
ciAoc3ogPSA0MDk2OyBzeiA+IDA7IHN6ID0gcmV0KSB7CisgICAgICAgIGlmIChidWYpCisgICAg
ICAgICAgICB4ZW5jYWxsX2ZyZWVfYnVmZmVyKGZzaGRsLT54Y2FsbCwgYnVmKTsKKworICAgICAg
ICBidWYgPSB4ZW5jYWxsX2FsbG9jX2J1ZmZlcihmc2hkbC0+eGNhbGwsIHN6KTsKKyAgICAgICAg
aWYgKCFidWYpIHsKKyAgICAgICAgICAgIGVycm5vID0gRU5PTUVNOworICAgICAgICAgICAgZ290
byBvdXQ7CisgICAgICAgIH0KKworICAgICAgICByZXQgPSB4ZW5jYWxsNShmc2hkbC0+eGNhbGws
IF9fSFlQRVJWSVNPUl9oeXBmc19vcCwgY21kLAorICAgICAgICAgICAgICAgICAgICAgICAodW5z
aWduZWQgbG9uZylwYXRoX2J1ZiwgcGF0aF9zeiwKKyAgICAgICAgICAgICAgICAgICAgICAgKHVu
c2lnbmVkIGxvbmcpYnVmLCBzeik7CisgICAgfQorCisgICAgaWYgKHJldCA8IDApIHsKKyAgICAg
ICAgZXJybm8gPSAtcmV0OworICAgICAgICB4ZW5jYWxsX2ZyZWVfYnVmZmVyKGZzaGRsLT54Y2Fs
bCwgYnVmKTsKKyAgICAgICAgYnVmID0gTlVMTDsKKyAgICAgICAgZ290byBvdXQ7CisgICAgfQor
Cisgb3V0OgorICAgIHJldCA9IGVycm5vOworICAgIHhlbmNhbGxfZnJlZV9idWZmZXIoZnNoZGwt
PnhjYWxsLCBwYXRoX2J1Zik7CisgICAgZXJybm8gPSByZXQ7CisKKyAgICByZXR1cm4gYnVmOwor
fQorCitjaGFyICp4ZW5oeXBmc19yZWFkKHhlbmh5cGZzX2hhbmRsZSAqZnNoZGwsIGNvbnN0IGNo
YXIgKnBhdGgpCit7CisgICAgY2hhciAqYnVmLCAqcmV0X2J1ZiA9IE5VTEw7CisgICAgaW50IHJl
dDsKKworICAgIGJ1ZiA9IHhlbmh5cGZzX3JlYWRfYW55KGZzaGRsLCBwYXRoLCBYRU5fSFlQRlNf
T1BfcmVhZF9jb250ZW50cyk7CisgICAgaWYgKGJ1ZikKKyAgICAgICAgcmV0X2J1ZiA9IHN0cmR1
cChidWYpOworCisgICAgcmV0ID0gZXJybm87CisgICAgeGVuY2FsbF9mcmVlX2J1ZmZlcihmc2hk
bC0+eGNhbGwsIGJ1Zik7CisgICAgZXJybm8gPSByZXQ7CisKKyAgICByZXR1cm4gcmV0X2J1ZjsK
K30KKworc3RydWN0IHhlbmh5cGZzX2RpcmVudCAqeGVuaHlwZnNfcmVhZGRpcih4ZW5oeXBmc19o
YW5kbGUgKmZzaGRsLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBjaGFyICpwYXRoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgKm51bV9lbnRyaWVzKQoreworICAgIHZvaWQgKmJ1ZiwgKmN1cnI7Cisg
ICAgaW50IHJldDsKKyAgICBjaGFyICpuYW1lczsKKyAgICBzdHJ1Y3QgeGVuaHlwZnNfZGlyZW50
ICpyZXRfYnVmID0gTlVMTDsKKyAgICB1bnNpZ25lZCBpbnQgbiwgbmFtZV9zeiA9IDA7CisgICAg
c3RydWN0IHhlbl9oeXBmc19kaXJlbnRyeSAqZW50cnk7CisKKyAgICBidWYgPSB4ZW5oeXBmc19y
ZWFkX2FueShmc2hkbCwgcGF0aCwgWEVOX0hZUEZTX09QX3JlYWRfZGlyKTsKKyAgICBpZiAoIWJ1
ZikKKyAgICAgICAgZ290byBvdXQ7CisKKyAgICBjdXJyID0gYnVmOworICAgIGZvciAobiA9IDE7
OyBuKyspIHsKKyAgICAgICAgZW50cnkgPSBjdXJyOworICAgICAgICBuYW1lX3N6ICs9IHN0cmxl
bihlbnRyeS0+bmFtZSkgKyAxOworICAgICAgICBpZiAoIWVudHJ5LT5vZmZfbmV4dCkKKyAgICAg
ICAgICAgIGJyZWFrOworCisgICAgICAgIGN1cnIgKz0gZW50cnktPm9mZl9uZXh0OworICAgIH0K
KworICAgIHJldF9idWYgPSBtYWxsb2MobiAqIHNpemVvZigqcmV0X2J1ZikgKyBuYW1lX3N6KTsK
KyAgICBpZiAoIXJldF9idWYpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgKm51bV9lbnRyaWVz
ID0gbjsKKyAgICBuYW1lcyA9IChjaGFyICopKHJldF9idWYgICsgbik7CisgICAgY3VyciA9IGJ1
ZjsKKyAgICBmb3IgKG4gPSAwOyBuIDwgKm51bV9lbnRyaWVzOyBuKyspIHsKKyAgICAgICAgZW50
cnkgPSBjdXJyOworICAgICAgICByZXRfYnVmW25dLm5hbWUgPSBuYW1lczsKKyAgICAgICAgcmV0
X2J1ZltuXS5pc19kaXIgPSBlbnRyeS0+ZmxhZ3MgJiBYRU5fSFlQRlNfSVNESVI7CisgICAgICAg
IHN0cmNweShuYW1lcywgZW50cnktPm5hbWUpOworICAgICAgICBuYW1lcyArPSBzdHJsZW4oZW50
cnktPm5hbWUpICsgMTsKKyAgICAgICAgY3VyciArPSBlbnRyeS0+b2ZmX25leHQ7CisgICAgfQor
Cisgb3V0OgorICAgIHJldCA9IGVycm5vOworICAgIHhlbmNhbGxfZnJlZV9idWZmZXIoZnNoZGwt
PnhjYWxsLCBidWYpOworICAgIGVycm5vID0gcmV0OworCisgICAgcmV0dXJuIHJldF9idWY7Cit9
CisKK2ludCB4ZW5oeXBmc193cml0ZSh4ZW5oeXBmc19oYW5kbGUgKmZzaGRsLCBjb25zdCBjaGFy
ICpwYXRoLCBjb25zdCBjaGFyICp2YWwpCit7CisgICAgY2hhciAqYnVmID0gTlVMTCwgKnBhdGhf
YnVmID0gTlVMTDsKKyAgICBpbnQgcmV0LCBzYXZlZF9lcnJubzsKKyAgICBpbnQgc3osIHBhdGhf
c3o7CisKKyAgICByZXQgPSB4ZW5oeXBmc19nZXRfcGF0aGJ1Zihmc2hkbCwgcGF0aCwgJnBhdGhf
YnVmKTsKKyAgICBpZiAocmV0IDwgMCkKKyAgICAgICAgZ290byBvdXQ7CisKKyAgICBwYXRoX3N6
ID0gcmV0OworCisgICAgc3ogPSBzdHJsZW4odmFsKSArIDE7CisgICAgYnVmID0geGVuY2FsbF9h
bGxvY19idWZmZXIoZnNoZGwtPnhjYWxsLCBzeik7CisgICAgaWYgKCFidWYpIHsKKyAgICAgICAg
cmV0ID0gLTE7CisgICAgICAgIGVycm5vID0gRU5PTUVNOworICAgICAgICBnb3RvIG91dDsKKyAg
ICB9CisgICAgc3RyY3B5KGJ1ZiwgdmFsKTsKKworICAgIHJldCA9IHhlbmNhbGw1KGZzaGRsLT54
Y2FsbCwgX19IWVBFUlZJU09SX2h5cGZzX29wLAorICAgICAgICAgICAgICAgICAgIFhFTl9IWVBG
U19PUF93cml0ZV9jb250ZW50cywKKyAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZylw
YXRoX2J1ZiwgcGF0aF9zeiwKKyAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZylidWYs
IHN6KTsKKworIG91dDoKKyAgICBzYXZlZF9lcnJubyA9IGVycm5vOworICAgIHhlbmNhbGxfZnJl
ZV9idWZmZXIoZnNoZGwtPnhjYWxsLCBwYXRoX2J1Zik7CisgICAgeGVuY2FsbF9mcmVlX2J1ZmZl
cihmc2hkbC0+eGNhbGwsIGJ1Zik7CisgICAgZXJybm8gPSBzYXZlZF9lcnJubzsKKyAgICByZXR1
cm4gcmV0OworfQpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlicy9oeXBmcy9pbmNsdWRlL3hlbmh5cGZz
LmggYi90b29scy9saWJzL2h5cGZzL2luY2x1ZGUveGVuaHlwZnMuaApuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwLi40NDMyMjE1MTBhCi0tLSAvZGV2L251bGwKKysrIGIvdG9v
bHMvbGlicy9oeXBmcy9pbmNsdWRlL3hlbmh5cGZzLmgKQEAgLTAsMCArMSw2MCBAQAorLyoKKyAq
IENvcHlyaWdodCAoYykgMjAxOSBTVVNFIFNvZnR3YXJlIFNvbHV0aW9ucyBHZXJtYW55IEdtYkgK
KyAqCisgKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yCisgKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVz
c2VyIEdlbmVyYWwgUHVibGljCisgKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBT
b2Z0d2FyZSBGb3VuZGF0aW9uOworICogdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UuCisgKgor
ICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBi
ZSB1c2VmdWwsCisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUg
aW1wbGllZCB3YXJyYW50eSBvZgorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEg
UEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAqIExlc3NlciBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogWW91IHNob3VsZCBoYXZlIHJlY2Vp
dmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICogTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorICovCisjaWZuZGVmIFhFTkhZUEZTX0gKKyNkZWZpbmUgWEVOSFlQRlNfSAor
CisjaW5jbHVkZSA8c3RkYm9vbC5oPgorI2luY2x1ZGUgPHN0ZGludC5oPgorCisjaW5jbHVkZSA8
eGVuL3hlbi5oPgorI2luY2x1ZGUgPHhlbi9oeXBmcy5oPgorCisvKiBDYWxsZXJzIHdobyBkb24n
dCBjYXJlIGRvbid0IG5lZWQgdG8gI2luY2x1ZGUgPHhlbnRvb2xsb2cuaD4gKi8KK3N0cnVjdCB4
ZW50b29sbG9nX2xvZ2dlcjsKKwordHlwZWRlZiBzdHJ1Y3QgeGVuaHlwZnNfaGFuZGxlIHhlbmh5
cGZzX2hhbmRsZTsKKworc3RydWN0IHhlbmh5cGZzX2RpcmVudCB7CisgICAgY2hhciAqbmFtZTsK
KyAgICBib29sIGlzX2RpcjsKK307CisKK3hlbmh5cGZzX2hhbmRsZSAqeGVuaHlwZnNfb3Blbihz
dHJ1Y3QgeGVudG9vbGxvZ19sb2dnZXIgKmxvZ2dlciwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBpbnQgb3Blbl9mbGFncyk7CitpbnQgeGVuaHlwZnNfY2xvc2UoeGVu
aHlwZnNfaGFuZGxlICpmc2hkbCk7CisKKy8qIFJldHVybmVkIGJ1ZmZlciBzaG91bGQgYmUgZnJl
ZWQgdmlhIGZyZWUoKS4gKi8KK2NoYXIgKnhlbmh5cGZzX3JlYWQoeGVuaHlwZnNfaGFuZGxlICpm
c2hkbCwgY29uc3QgY2hhciAqcGF0aCk7CisKKy8qIFJldHVybmVkIGJ1ZmZlciBzaG91bGQgYmUg
ZnJlZWQgdmlhIGZyZWUoKS4gKi8KK3N0cnVjdCB4ZW5oeXBmc19kaXJlbnQgKnhlbmh5cGZzX3Jl
YWRkaXIoeGVuaHlwZnNfaGFuZGxlICpmc2hkbCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgY2hhciAqcGF0aCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50ICpudW1fZW50cmllcyk7CisKK2ludCB4ZW5o
eXBmc193cml0ZSh4ZW5oeXBmc19oYW5kbGUgKmZzaGRsLCBjb25zdCBjaGFyICpwYXRoLCBjb25z
dCBjaGFyICp2YWwpOworCisjZW5kaWYgLyogWEVOSFlQRlNfSCAqLworCisvKgorICogTG9jYWwg
dmFyaWFibGVzOgorICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAiQlNEIgorICogYy1iYXNp
Yy1vZmZzZXQ6IDQKKyAqIHRhYi13aWR0aDogNAorICogaW5kZW50LXRhYnMtbW9kZTogbmlsCisg
KiBFbmQ6CisgKi8KZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnMvaHlwZnMvbGlieGVuaHlwZnMubWFw
IGIvdG9vbHMvbGlicy9oeXBmcy9saWJ4ZW5oeXBmcy5tYXAKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMDAwMC4uMzljNjNmNDM2NwotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL2xp
YnMvaHlwZnMvbGlieGVuaHlwZnMubWFwCkBAIC0wLDAgKzEsOSBAQAorVkVSU18xLjAgeworCWds
b2JhbDoKKwkJeGVuaHlwZnNfb3BlbjsKKwkJeGVuaHlwZnNfY2xvc2U7CisJCXhlbmh5cGZzX3Jl
YWQ7CisJCXhlbmh5cGZzX3JlYWRkaXI7CisJCXhlbmh5cGZzX3dyaXRlOworCWxvY2FsOiAqOyAv
KiBEbyBub3QgZXhwb3NlIGFueXRoaW5nIGJ5IGRlZmF1bHQgKi8KK307CmRpZmYgLS1naXQgYS90
b29scy9saWJzL2h5cGZzL3hlbmh5cGZzLnBjLmluIGIvdG9vbHMvbGlicy9oeXBmcy94ZW5oeXBm
cy5wYy5pbgpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi45Y2I5NjhmMGRi
Ci0tLSAvZGV2L251bGwKKysrIGIvdG9vbHMvbGlicy9oeXBmcy94ZW5oeXBmcy5wYy5pbgpAQCAt
MCwwICsxLDEwIEBACitwcmVmaXg9QEBwcmVmaXhAQAoraW5jbHVkZWRpcj1AQGluY2RpckBACits
aWJkaXI9QEBsaWJkaXJAQAorCitOYW1lOiBYZW5oeXBmcworRGVzY3JpcHRpb246IFRoZSBYZW5o
eXBmcyBsaWJyYXJ5IGZvciBYZW4gaHlwZXJ2aXNvcgorVmVyc2lvbjogQEB2ZXJzaW9uQEAKK0Nm
bGFnczogLUkke2luY2x1ZGVkaXJ9IEBAY2ZsYWdzbG9jYWxAQAorTGliczogQEBsaWJzZmxhZ0BA
JHtsaWJkaXJ9IC1seGVuaHlwZnMKK1JlcXVpcmVzLnByaXZhdGU6IHhlbnRvb2xjb3JlLHhlbnRv
b2xsb2cseGVuY2FsbAotLSAKMi4xNi40CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMu
eGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL3hlbi1kZXZlbA==

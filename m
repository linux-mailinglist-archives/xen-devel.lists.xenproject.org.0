Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B2A637C7954
	for <lists+xen-devel@lfdr.de>; Fri, 13 Oct 2023 00:10:24 +0200 (CEST)
Received: from list by lists.xenproject.org with outflank-mailman.616068.957804 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1qr3s3-0001gK-LO; Thu, 12 Oct 2023 22:09:31 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 616068.957804; Thu, 12 Oct 2023 22:09:31 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1qr3s3-0001Wm-Dc; Thu, 12 Oct 2023 22:09:31 +0000
Received: by outflank-mailman (input) for mailman id 616068;
 Thu, 12 Oct 2023 22:09:29 +0000
Received: from se1-gles-flk1-in.inumbo.com ([94.247.172.50]
 helo=se1-gles-flk1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=Hhgq=F2=epam.com=prvs=4649fa389a=volodymyr_babchuk@srs-se1.protection.inumbo.net>)
 id 1qr3s1-00016s-2F
 for xen-devel@lists.xenproject.org; Thu, 12 Oct 2023 22:09:29 +0000
Received: from mx0b-0039f301.pphosted.com (mx0b-0039f301.pphosted.com
 [148.163.137.242]) by se1-gles-flk1.inumbo.com (Halon) with ESMTPS
 id 00417a42-694c-11ee-9b0e-b553b5be7939;
 Fri, 13 Oct 2023 00:09:24 +0200 (CEST)
Received: from pps.filterd (m0174682.ppops.net [127.0.0.1])
 by mx0b-0039f301.pphosted.com (8.17.1.19/8.17.1.19) with ESMTP id
 39CKqml7008371; Thu, 12 Oct 2023 22:09:21 GMT
Received: from eur01-db5-obe.outbound.protection.outlook.com
 (mail-db5eur01lp2050.outbound.protection.outlook.com [104.47.2.50])
 by mx0b-0039f301.pphosted.com (PPS) with ESMTPS id 3tpr7cr8dp-5
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Thu, 12 Oct 2023 22:09:20 +0000
Received: from VI1PR03MB3710.eurprd03.prod.outlook.com (2603:10a6:803:31::18)
 by DBAPR03MB6376.eurprd03.prod.outlook.com (2603:10a6:10:193::6) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6863.45; Thu, 12 Oct
 2023 22:09:15 +0000
Received: from VI1PR03MB3710.eurprd03.prod.outlook.com
 ([fe80::f606:63f7:5875:6076]) by VI1PR03MB3710.eurprd03.prod.outlook.com
 ([fe80::f606:63f7:5875:6076%4]) with mapi id 15.20.6863.043; Thu, 12 Oct 2023
 22:09:15 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: 00417a42-694c-11ee-9b0e-b553b5be7939
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=TGW4xvV/izEZ5YfWl/iobS/kYRHZwM8WgHgRExmyMYF8kzodlECRQ7tmDXQwPTktvCjW18EsKR8B3LxUQQ1gOSLwnLZ2xhcxKXi4v4G7BWDmfsy0yxy/ovniyz/ksdSocx5FI3aGyo8yPDlLXXrhleB/AfFhC4JMlSYqdFsY7tHb9YZUg/Okk0tNE2p8RXiTkIf5+luvAkkS6AGmGzMorDJ3+c5A9p1JW/a4FI8sgNOJ6taA6gkV9njqpjK8xexgkp2LGQ2EbFbyI0xkh60yLTtFDKtBbpLi0oTiHOrdqKRFYhD28eOm7lU4FFeUAIa0o7Vo3C4+QyF6vP/BHY9hag==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=j3YYW5qeUu5BWrrKwAUFAd6TaoNJsexdP9B8tOFJn3M=;
 b=lWBdiwpt/ewIDlE6qmbwE+2oTi1nRNBtRYEZKfivP9FRKI7K/nWnBqtB+ue9YOb1N4wrQ9LSKDq7SVFkWDMkb+9qDlyHnsq1e260HPB4g1MFVxA3TpZt3u3C0koCalPeqXzVCLQBA6hn6lWqbGlqDs8yafOmxaF/jBON6hTI8hJmeegJIoOJ02hiHVpW7qLPf4IgkuSL7Bowxajw949a+MZ1BRG3pZNCZPNZimUlqHjhNShEQAbC/IUUgJWXvtpjEIbCG9F1+PvwH/eROagcZ17kQfWZlYzQBjUaXzpUxbFXz2NOKVcFzkYYDv3dHESvjN9ePc4JmIaebzNuML+WBg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=epam.com; dmarc=pass action=none header.from=epam.com;
 dkim=pass header.d=epam.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=epam.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=j3YYW5qeUu5BWrrKwAUFAd6TaoNJsexdP9B8tOFJn3M=;
 b=VY+XMmk1osqYFpb9q8zZnjbQwhovWQMSB7jBNP7K+z3jYYeR9tw+3llwjxEmLDwpYaup4F4KWBatOLckZixYdFe+vL5+r5L2ODSTDemSxvpxUvtmkgGHdWPQlHhpYYIgQo8baqM2SLAnMdnr8vjy+C+Qlpu7qfD2ARhzo/jCVZt+n7N4PU5UzsJNi3uS3DCjq2ZP4HCvwZUix9tlEGmcI5S3Byk4NCqXN2T1gUUWFXD/KYvFgflKwPaidN3ayY5B1YwgsY0haTsvzvvy1EtQ/m7q64xxO/hV+eMYq7hVxJJ+m3x9kMwfW1xATLyqGxxzp4ldRJpJFFkaAsaWDLow1w==
From: Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
CC: Stewart Hildebrand <stewart.hildebrand@amd.com>,
        Oleksandr Andrushchenko
	<Oleksandr_Andrushchenko@epam.com>,
        Jan Beulich <jbeulich@suse.com>,
        Andrew
 Cooper <andrew.cooper3@citrix.com>,
        =?utf-8?B?Um9nZXIgUGF1IE1vbm7DqQ==?=
	<roger.pau@citrix.com>,
        Wei Liu <wl@xen.org>, Jun Nakajima
	<jun.nakajima@intel.com>,
        Kevin Tian <kevin.tian@intel.com>, Paul Durrant
	<paul@xen.org>,
        Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>
Subject: [PATCH v10 03/17] vpci: use per-domain PCI lock to protect vpci
 structure
Thread-Topic: [PATCH v10 03/17] vpci: use per-domain PCI lock to protect vpci
 structure
Thread-Index: AQHZ/Vi9bRc3EUPSDEy0THfJgPlJLA==
Date: Thu, 12 Oct 2023 22:09:15 +0000
Message-ID: <20231012220854.2736994-4-volodymyr_babchuk@epam.com>
References: <20231012220854.2736994-1-volodymyr_babchuk@epam.com>
In-Reply-To: <20231012220854.2736994-1-volodymyr_babchuk@epam.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: git-send-email 2.42.0
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: VI1PR03MB3710:EE_|DBAPR03MB6376:EE_
x-ms-office365-filtering-correlation-id: 3947b02b-484e-427c-f1ee-08dbcb6fdfb8
x-ld-processed: b41b72d0-4e9f-4c26-8a69-f949f367c91d,ExtAddr
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: 
 7L1lYIiSqChxt0uxM1bq5tJ3gvwVw318n5K2Y0AMCB/PWDVmRcjmVTsG9VTbuhs4gKftZc3YBkHbpcnv3IGhDQCdiXpSs/6ZSoOaNqVoVKw49SqEXzjLCp1ajkswwUudMFTk8wgSiifbWh4VCOaEK9lIHkhBVKHqTC6SZkrekrMEZcY5fQ24ovlEJJXEHiebbELDjkS4HxA9U4hOxdQBd0FChmZZ6Z75+tzjKHea71AQt6YmP1K4DOzQeht4DhBKJDG4BDV0pBLfoYd0fJyZ73Fm3Dq1K265+xMaLLwk9yhh+x8nRzTqv/zpxGfMxz5BMiHJ6YAiRaJlk/7Mqh8UgilSX4A0PR4V6wr/1p5qWPWToliZubBRM9IYUIjPKFLc0xG0ddqjCxGDGOGJGtBCYdEc9ueiSFQM7p2bTcyLHrHZCDWjsp34DwTvDA0eUYGl+YtWsucaX6bGYfzQ4Q+kRm2wv3Uouxq/arkv7WD2/71kBX1uuIT9j10oUNNykLMo9HUHN9kSJ4RoKms7/ebyPmuSK6ZS+70HDPSmjn9YRK7+/UGLChZEwNMdCix+faDcd9MY7SsK96gu7cscZiU4IFVxD9XhCuei8KYj6xBiUzP4EtZEYAogFY2vnVqL41S6eZLKmLH8r1GjSzQRDRyqHg==
x-forefront-antispam-report: 
 CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:VI1PR03MB3710.eurprd03.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230031)(376002)(39860400002)(396003)(346002)(366004)(136003)(230922051799003)(451199024)(64100799003)(186009)(1800799009)(107886003)(2616005)(71200400001)(26005)(6512007)(6506007)(55236004)(36756003)(86362001)(38100700002)(38070700005)(122000001)(1076003)(83380400001)(91956017)(41300700001)(64756008)(316002)(76116006)(54906003)(66946007)(66446008)(6916009)(66556008)(66476007)(2906002)(8936002)(30864003)(5660300002)(8676002)(4326008)(6486002)(478600001)(579004)(559001)(309714004);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: 
 =?utf-8?B?MlZqdk15QnFNcDJiRkE0Y0w5K1Y0N1N0VXNkUFRQWHhLTnkzRnRSNVZleG5v?=
 =?utf-8?B?NjVXWno0SFV6aDN2VmNkY2F3M0xzWjViWWVqUnZqYjRHOVdqZFU0L2JSbktu?=
 =?utf-8?B?VmdBdE96RkpxWjBNSDZlWHZiVkpXeDBBQW13QmJ3VmhBbHFudHpyL2tDOGQ4?=
 =?utf-8?B?QTZiM0dTOVBOcFk5UmpFUlFjcGFQVko4WTRGSS9uY2tRL2JkaFJJbW9IcGlR?=
 =?utf-8?B?T0dPZk14QVBTRVpEanpNZUNzdzF5MSs2TzhVblg2WDJwbzRCUEUwQ05laDls?=
 =?utf-8?B?cGZpR1FRWS9hMmR6WGN0aU1nd1pHUjFTS2lrMlhaT1N1emEwT214WGpHUmRi?=
 =?utf-8?B?bnFSQWNISndCVlA0YlhPNFkzUWd4VFVLaWJqdHZadHF4L2xjYWEzM0duUGJs?=
 =?utf-8?B?TzBWeXh6SGtKOE1BYjU5K3lTQ3psQnkrY2o3YU5FM0NjeGZScUpSMFFjUFV2?=
 =?utf-8?B?bUl2NThnUml6YmdoZmljS1RweS9iUDVKem9WV1p4a3FBTDlmaWVkWGtmT0pS?=
 =?utf-8?B?NEFiMHE5MVN4UldCa1lieUFRL1VhTk9LcWxwR1ZVZmREeDZrOGNGN3hYT3Az?=
 =?utf-8?B?SHdtSlhvT2dscG9GUmo4U2VNSHpzYXBOZnpLa01zUmVVOVh1bWdnR3B6RUZ2?=
 =?utf-8?B?VERrTnVVa1JMNFc3NWxRc2hIbUV4NnlyRVFnVkVnWFprUm5EM0grY1BtWGl4?=
 =?utf-8?B?NnVXYk15dEF4NGdROWdKNTdROFZMSUk3djZiZkFYQXdhN3FyVlpjcTRpUU9V?=
 =?utf-8?B?cmFjS0xCTWd2azBrWXo1d3ovNnVqb3U1b0tXMUFvN21xZkhPUkMvbjdBTkZt?=
 =?utf-8?B?Rmt6M2pER0FBK2l1ekRXN0VNUHBmVVp5bHZ4T3gwTjhRei9uK3oxeUYwdG9w?=
 =?utf-8?B?OUZ6RlAvY1lhMitOVkhTZTRHRGt6QmcrdWZ4UUk3bVdnUzdVWkNRTTlGM0tX?=
 =?utf-8?B?MVBzT0FiMldiS25yZys4S3FCeDZnZVUrdFd5ZmxsZ292OXp5TFE1czExLzJJ?=
 =?utf-8?B?N09EY0wyejNwbzVLNEtSMXQwa2ZHQ1g3MFkxRXlPOGRXMmg5VGgxd01Xckpj?=
 =?utf-8?B?WWtIVm1qZWM0MHdNVWpzRlVlQS9kM2ZhcXE0bk1ValdieDNPcGNTQ2pCNWNj?=
 =?utf-8?B?eUx3T1hRTGoxU0s4ajJPcmhJRWVQclQ2MW8yMCtkRDN4R293b1B1RDRmdDJj?=
 =?utf-8?B?OVdwNy9lM1hVZTI2dHdkWkp5am5sbUpiZXRCTEgrUC9BQi90eUhIMFhxU3VZ?=
 =?utf-8?B?bWxCVEVmUENqVjhpUVdPblZmb2FGWDBkVmI1K3VROFNOR2R3dnZmQjBCZVRp?=
 =?utf-8?B?RjRBYlFiZktjbEIvWmpoSC8vRUZiVUcrYlNiM3ZNUWF1NkJnbGdNVUVKOHRR?=
 =?utf-8?B?SjlSeE5rSWpqTGx5aHFVVkVDakpGQnIrcmtOSERjeVZFZ0VPQkhjS25vSHBC?=
 =?utf-8?B?M0hDZHZkRkNWQUdtY1JXbG9KOGtNZWZTWldScnVrdkhVcE9wL0lxZ2JrcllU?=
 =?utf-8?B?S3JMMnZ0b1ZWeVZSMjFYd0lNU2ZMYjRzbEpiQzkvWEorT1VVb0hmR2ppTHRC?=
 =?utf-8?B?RDl1ZVRtZFVZMGluZ0ZmWmo4UG5kazZjdDFEcmVjbUJpSkNxaXpka045NFM5?=
 =?utf-8?B?LzV6dnFDbTZqa09ZUjU3SHNDUy9OdEIyM1pnWW9DQkhsQkxvc0Z1c04zenhZ?=
 =?utf-8?B?a05QWGROY2xzQUdUVUN0cnA0Zi9BRFlndnJTL2c2YTZPWUFnZGVIWVFzMzVp?=
 =?utf-8?B?M3dTSmdoRFg4eG5XdVBGUHcxY2pwcjMzLzJEMUNlblZlWGNWMGw0V2ZURXJN?=
 =?utf-8?B?WjByUXEzUlFLb0JoeDJMYWtQUmU0aTlSWDlEQnNsUDl1WTNUQUxBT3REVm9L?=
 =?utf-8?B?UmpiN1oya2FpYzBUMFo2MUtsbGhmeC9uc3hkTkhoakRuT1FpQ2lxR0dIVXQw?=
 =?utf-8?B?amZUWTA5NFI2d1daVWE2N3Jsd2hEa3grZmozSkYzbzlYbXI0OXBGVGllVjYy?=
 =?utf-8?B?clFESG5ZTVRwM0txekR1Z0E3Z2tPQmVrWG15T1RBakp0ZXo2WDg1U29TNllG?=
 =?utf-8?B?SWRmazMyZ3NoaDgzeVNvNXM3WUVDNzZWUzNKQ0pXc0ZkYzBwMUdQeE9zODBX?=
 =?utf-8?B?RlN1SUdOblJtbmVVMTk0bTc2R1NtVUtxVlVaWDEyeXdMRkRBcXAyVDlvRHIr?=
 =?utf-8?B?a0E9PQ==?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <57387D3FB082414E919B9386B171DFEE@eurprd03.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: epam.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: VI1PR03MB3710.eurprd03.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 3947b02b-484e-427c-f1ee-08dbcb6fdfb8
X-MS-Exchange-CrossTenant-originalarrivaltime: 12 Oct 2023 22:09:15.4954
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: b41b72d0-4e9f-4c26-8a69-f949f367c91d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: Db/z4yYebUNvQxz2QyWNDZ1SIeEdMrh3rd9UWdl5TsDiRVI76yCscIrKBtHsFnwWEzUo8G/cr7kiyL/QmNhpD6+aNCgkRRjIiZn04ebQT4o=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DBAPR03MB6376
X-Proofpoint-GUID: ESMUjASsK3lvBmr-MMh_uOmwLmWuAyEM
X-Proofpoint-ORIG-GUID: ESMUjASsK3lvBmr-MMh_uOmwLmWuAyEM
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.267,Aquarius:18.0.980,Hydra:6.0.619,FMLib:17.11.176.26
 definitions=2023-10-12_14,2023-10-12_01,2023-05-22_02
X-Proofpoint-Spam-Details: rule=outbound_notspam policy=outbound score=0 adultscore=0 spamscore=0
 mlxscore=0 lowpriorityscore=0 suspectscore=0 priorityscore=1501
 impostorscore=0 clxscore=1015 malwarescore=0 bulkscore=0 mlxlogscore=999
 phishscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.12.0-2309180000 definitions=main-2310120186

RnJvbTogT2xla3NhbmRyIEFuZHJ1c2hjaGVua28gPG9sZWtzYW5kcl9hbmRydXNoY2hlbmtvQGVw
YW0uY29tPg0KDQpVc2UgYSBwcmV2aW91c2x5IGludHJvZHVjZWQgcGVyLWRvbWFpbiByZWFkL3dy
aXRlIGxvY2sgdG8gY2hlY2sNCndoZXRoZXIgdnBjaSBpcyBwcmVzZW50LCBzbyB3ZSBhcmUgc3Vy
ZSB0aGVyZSBhcmUgbm8gYWNjZXNzZXMgdG8gdGhlDQpjb250ZW50cyBvZiB0aGUgdnBjaSBzdHJ1
Y3QgaWYgbm90LiBUaGlzIGxvY2sgY2FuIGJlIHVzZWQgKGFuZCBpbiBhDQpmZXcgY2FzZXMgaXMg
dXNlZCByaWdodCBhd2F5KSBzbyB0aGF0IHZwY2kgcmVtb3ZhbCBjYW4gYmUgcGVyZm9ybWVkDQp3
aGlsZSBob2xkaW5nIHRoZSBsb2NrIGluIHdyaXRlIG1vZGUuIFByZXZpb3VzbHkgc3VjaCByZW1v
dmFsIGNvdWxkDQpyYWNlIHdpdGggdnBjaV9yZWFkIGZvciBleGFtcGxlLg0KDQpXaGVuIHRha2lu
ZyBib3RoIGQtPnBjaV9sb2NrIGFuZCBwZGV2LT52cGNpLT5sb2NrLCB0aGV5IHNob3VsZCBiZQ0K
dGFrZW4gaW4gdGhpcyBleGFjdCBvcmRlcjogZC0+cGNpX2xvY2sgdGhlbiBwZGV2LT52cGNpLT5s
b2NrIHRvIGF2b2lkDQpwb3NzaWJsZSBkZWFkbG9jayBzaXR1YXRpb25zLg0KDQoxLiBQZXItZG9t
YWluJ3MgcGNpX3J3bG9jayBpcyB1c2VkIHRvIHByb3RlY3QgcGRldi0+dnBjaSBzdHJ1Y3R1cmUN
CmZyb20gYmVpbmcgcmVtb3ZlZC4NCg0KMi4gV3JpdGluZyB0aGUgY29tbWFuZCByZWdpc3RlciBh
bmQgUk9NIEJBUiByZWdpc3RlciBtYXkgdHJpZ2dlcg0KbW9kaWZ5X2JhcnMgdG8gcnVuLCB3aGlj
aCBpbiB0dXJuIG1heSBhY2Nlc3MgbXVsdGlwbGUgcGRldnMgd2hpbGUNCmNoZWNraW5nIGZvciB0
aGUgZXhpc3RpbmcgQkFSJ3Mgb3ZlcmxhcC4gVGhlIG92ZXJsYXBwaW5nIGNoZWNrLCBpZg0KZG9u
ZSB1bmRlciB0aGUgcmVhZCBsb2NrLCByZXF1aXJlcyB2cGNpLT5sb2NrIHRvIGJlIGFjcXVpcmVk
IG9uIGJvdGgNCmRldmljZXMgYmVpbmcgY29tcGFyZWQsIHdoaWNoIG1heSBwcm9kdWNlIGEgZGVh
ZGxvY2suIEl0IGlzIG5vdA0KcG9zc2libGUgdG8gdXBncmFkZSByZWFkIGxvY2sgdG8gd3JpdGUg
bG9jayBpbiBzdWNoIGEgY2FzZS4gU28sIGluDQpvcmRlciB0byBwcmV2ZW50IHRoZSBkZWFkbG9j
aywgdXNlIGQtPnBjaV9sb2NrIGluc3RlYWQuIFRvIHByZXZlbnQNCmRlYWRsb2NrIHdoaWxlIGxv
Y2tpbmcgYm90aCBod2RvbS0+cGNpX2xvY2sgYW5kIGRvbV94ZW4tPnBjaV9sb2NrLA0KYWx3YXlz
IGxvY2sgaHdkb20gZmlyc3QuDQoNCkFsbCBvdGhlciBjb2RlLCB3aGljaCBkb2Vzbid0IGxlYWQg
dG8gcGRldi0+dnBjaSBkZXN0cnVjdGlvbiBhbmQgZG9lcw0Kbm90IGFjY2VzcyBtdWx0aXBsZSBw
ZGV2cyBhdCB0aGUgc2FtZSB0aW1lLCBjYW4gc3RpbGwgdXNlIGENCmNvbWJpbmF0aW9uIG9mIHRo
ZSByZWFkIGxvY2sgYW5kIHBkZXYtPnZwY2ktPmxvY2suDQoNCjMuIERyb3AgY29uc3QgcXVhbGlm
aWVyIHdoZXJlIHRoZSBuZXcgcndsb2NrIGlzIHVzZWQgYW5kIHRoaXMgaXMNCmFwcHJvcHJpYXRl
Lg0KDQo0LiBEbyBub3QgY2FsbCBwcm9jZXNzX3BlbmRpbmdfc29mdGlycXMgd2l0aCBhbnkgbG9j
a3MgaGVsZC4gRm9yIHRoYXQNCnVubG9jayBwcmlvciB0aGUgY2FsbCBhbmQgcmUtYWNxdWlyZSB0
aGUgbG9ja3MgYWZ0ZXIuIEFmdGVyDQpyZS1hY3F1aXJpbmcgdGhlIGxvY2sgdGhlcmUgaXMgbm8g
bmVlZCB0byBjaGVjayBpZiBwZGV2LT52cGNpIGV4aXN0czoNCiAtIGluIGFwcGx5X21hcCBiZWNh
dXNlIG9mIHRoZSBjb250ZXh0IGl0IGlzIGNhbGxlZCAobm8gcmFjZSBjb25kaXRpb24NCiAgIHBv
c3NpYmxlKQ0KIC0gZm9yIE1TSS9NU0ktWCBkZWJ1ZyBjb2RlIGJlY2F1c2UgaXQgaXMgY2FsbGVk
IGF0IHRoZSBlbmQgb2YNCiAgIHBkZXYtPnZwY2kgYWNjZXNzIGFuZCBubyBmdXJ0aGVyIGFjY2Vz
cyB0byBwZGV2LT52cGNpIGlzIG1hZGUNCg0KNS4gVXNlIGQtPnBjaV9sb2NrIGFyb3VuZCBmb3Jf
ZWFjaF9wZGV2IGFuZCBwY2lfZ2V0X3BkZXZfYnlfZG9tYWluDQp3aGlsZSBhY2Nlc3NpbmcgcGRl
dnMgaW4gdnBjaSBjb2RlLg0KDQo2LiBXZSBhcmUgcmVtb3ZpbmcgbXVsdGlwbGUgQVNTRVJUKHBj
aWRldnNfbG9ja2VkKCkpIGluc3RhbmNlcyBiZWNhdXNlDQp0aGV5IGFyZSB0b28gc3RyaWN0IG5v
dzogdGhleSBzaG91bGQgYmUgY29ycmVjdGVkIHRvDQpBU1NFUlQocGNpZGV2c19sb2NrZWQoKSB8
fCByd19pc19sb2NrZWQoJmQtPnBjaV9sb2NrKSksIGJ1dCBwcm9ibGVtIGlzDQp0aGF0IG1lbnRp
b25lZCBpbnN0YW5jZXMgZG9lcyBub3QgaGF2ZSBhY2Nlc3MgdG8gdGhlIGRvbWFpbg0KcG9pbnRl
ciBhbmQgaXQgaXMgbm90IGZlYXNpYmxlIHRvIHBhc3MgYSBkb21haW4gcG9pbnRlciB0byBhIGZ1
bmN0aW9uDQpqdXN0IGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMuDQoNClRoZXJlIGlzIGEgcG9zc2li
bGUgbG9jayBpbnZlcnNpb24gaW4gTVNJIGNvZGUsIGFzIHNvbWUgcGFydHMgb2YgaXQNCmFjcXVp
cmUgcGNpZGV2c19sb2NrKCkgd2hpbGUgYWxyZWFkeSBob2xkaW5nIGQtPnBjaV9sb2NrLg0KDQpT
dWdnZXN0ZWQtYnk6IFJvZ2VyIFBhdSBNb25uw6kgPHJvZ2VyLnBhdUBjaXRyaXguY29tPg0KU3Vn
Z2VzdGVkLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+DQpTaWduZWQtb2ZmLWJ5
OiBPbGVrc2FuZHIgQW5kcnVzaGNoZW5rbyA8b2xla3NhbmRyX2FuZHJ1c2hjaGVua29AZXBhbS5j
b20+DQpTaWduZWQtb2ZmLWJ5OiBWb2xvZHlteXIgQmFiY2h1ayA8dm9sb2R5bXlyX2JhYmNodWtA
ZXBhbS5jb20+DQoNCi0tLQ0KQ2hhbmdlcyBpbiB2MTA6DQogLSBNb3ZlZCBwcmludGsgcGFzIGxv
Y2tlZCBhcmVhDQogLSBSZXR1cm5lZCBiYWNrIEFTU0VSVHMNCiAtIEFkZGVkIG5ldyBwYXJhbWV0
ZXIgdG8gYWxsb2NhdGVfYW5kX21hcF9tc2lfcGlycSgpIHNvIGl0IGtub3dzIGlmDQogaXQgc2hv
dWxkIHRha2UgdGhlIGdsb2JhbCBwY2kgbG9jaw0KIC0gQWRkZWQgY29tbWVudCBhYm91dCBwb3Nz
aWJsZSBpbXByb3ZlbWVudCBpbiB2cGNpX3dyaXRlDQogLSBDaGFuZ2VkIEFTU0VSVChyd19pc19s
b2NrZWQoKSkgdG8gcndfaXNfd3JpdGVfbG9ja2VkKCkgaW4NCiAgIGFwcHJvcHJpYXRlIHBsYWNl
cw0KIC0gUmVuYW1lZCByZWxlYXNlX2RvbWFpbl9sb2NrcygpIHRvIHJlbGVhc2VfZG9tYWluX3dy
aXRlX2xvY2tzKCkNCiAtIG1vdmVkIGRvbWFpbl9kb25lIGxhYmVsIGluIHZwY2lfZHVtcF9tc2ko
KSB0byBjb3JyZWN0IHBsYWNlDQpDaGFuZ2VzIGluIHY5Og0KIC0gZXh0ZW5kZWQgbG9ja2VkIHJl
Z2lvbiB0byBwcm90ZWN0IHZwY2lfcmVtb3ZlX2RldmljZSBhbmQNCiAgIHZwY2lfYWRkX2hhbmRs
ZXJzKCkgY2FsbHMNCiAtIHZwY2lfd3JpdGUoKSB0YWtlcyBsb2NrIGluIHRoZSB3cml0ZSBtb2Rl
IHRvIHByb3RlY3QNCiAgIHBvdGVudGlhbCBjYWxsIHRvIG1vZGlmeV9iYXJzKCkNCiAtIHJlbmFt
ZWQgbG9jayByZWxlYXNpbmcgZnVuY3Rpb24NCiAtIHJlbW92ZWQgQVNTRVJUKClzIGZyb20gbXNp
IGNvZGUNCiAtIGFkZGVkIHRyeWxvY2sgaW4gdnBjaV9kdW1wX21zaQ0KDQpDaGFuZ2VzIGluIHY4
Og0KIC0gY2hhbmdlZCBkLT52cGNpX2xvY2sgdG8gZC0+cGNpX2xvY2sNCiAtIGludHJvZHVjaW5n
IGQtPnBjaV9sb2NrIGluIGEgc2VwYXJhdGUgcGF0Y2gNCiAtIGV4dGVuZGVkIGxvY2tlZCByZWdp
b24gaW4gdnBjaV9wcm9jZXNzX3BlbmRpbmcNCiAtIHJlbW92ZWQgcGNpZGV2c19sb2NraXMgdnBj
aV9kdW1wX21zaSgpDQogLSByZW1vdmVkIHNvbWUgY2hhbmdlcyBhcyB0aGV5IGFyZSBub3QgbmVl
ZGVkIHdpdGgNCiAgIHRoZSBuZXcgbG9ja2luZyBzY2hlbWUNCiAtIGFkZGVkIGhhbmRsaW5nIGZv
ciBod2RvbSAmJiBkb21feGVuIGNhc2UNCi0tLQ0KIHhlbi9hcmNoL3g4Ni9odm0vdm1zaS5jICAg
ICAgICB8IDI2ICsrKysrKysrLS0tLS0tLS0tDQogeGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMg
ICAgIHwgIDIgLS0NCiB4ZW4vYXJjaC94ODYvaW5jbHVkZS9hc20vaXJxLmggfCAgMyArLQ0KIHhl
bi9hcmNoL3g4Ni9pcnEuYyAgICAgICAgICAgICB8IDEyICsrKystLS0tDQogeGVuL2FyY2gveDg2
L21zaS5jICAgICAgICAgICAgIHwgMTAgKystLS0tLQ0KIHhlbi9hcmNoL3g4Ni9waHlzZGV2LmMg
ICAgICAgICB8ICAyICstDQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMgIHwgIDkgKysr
LS0tDQogeGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYyAgICAgIHwgMTggKysrKysrKysrKysrDQog
eGVuL2RyaXZlcnMvdnBjaS9tc2kuYyAgICAgICAgIHwgMjggKysrKysrKysrKysrKysrKy0tDQog
eGVuL2RyaXZlcnMvdnBjaS9tc2l4LmMgICAgICAgIHwgNTIgKysrKysrKysrKysrKysrKysrKysr
KysrKysrKystLS0tLQ0KIHhlbi9kcml2ZXJzL3ZwY2kvdnBjaS5jICAgICAgICB8IDUxICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKystLQ0KIDExIGZpbGVzIGNoYW5nZWQsIDE2NiBpbnNl
cnRpb25zKCspLCA0NyBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9o
dm0vdm1zaS5jIGIveGVuL2FyY2gveDg2L2h2bS92bXNpLmMNCmluZGV4IDEyOGYyMzYzNjIuLjZi
MzNhODAxMjAgMTAwNjQ0DQotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3Ztc2kuYw0KKysrIGIveGVu
L2FyY2gveDg2L2h2bS92bXNpLmMNCkBAIC00NjgsNyArNDY4LDcgQEAgaW50IG1zaXh0YmxfcHRf
cmVnaXN0ZXIoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHBpcnEgKnBpcnEsIHVpbnQ2NF90IGd0
YWJsZSkNCiAgICAgc3RydWN0IG1zaXh0YmxfZW50cnkgKmVudHJ5LCAqbmV3X2VudHJ5Ow0KICAg
ICBpbnQgciA9IC1FSU5WQUw7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xvY2tlZCgpKTsNCisg
ICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkgfHwgcndfaXNfbG9ja2VkKCZkLT5wY2lfbG9jaykp
Ow0KICAgICBBU1NFUlQocndfaXNfd3JpdGVfbG9ja2VkKCZkLT5ldmVudF9sb2NrKSk7DQogDQog
ICAgIGlmICggIW1zaXh0YmxfaW5pdGlhbGlzZWQoZCkgKQ0KQEAgLTUzOCw3ICs1MzgsNyBAQCB2
b2lkIG1zaXh0YmxfcHRfdW5yZWdpc3RlcihzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgcGlycSAq
cGlycSkNCiAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXY7DQogICAgIHN0cnVjdCBtc2l4dGJsX2Vu
dHJ5ICplbnRyeTsNCiANCi0gICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOw0KKyAgICBBU1NF
UlQocGNpZGV2c19sb2NrZWQoKSB8fCByd19pc19sb2NrZWQoJmQtPnBjaV9sb2NrKSk7DQogICAg
IEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJmQtPmV2ZW50X2xvY2spKTsNCiANCiAgICAgaWYg
KCAhbXNpeHRibF9pbml0aWFsaXNlZChkKSApDQpAQCAtNjg0LDcgKzY4NCw3IEBAIHN0YXRpYyBp
bnQgdnBjaV9tc2lfdXBkYXRlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1aW50MzJfdCBk
YXRhLA0KIHsNCiAgICAgdW5zaWduZWQgaW50IGk7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xv
Y2tlZCgpKTsNCisgICAgQVNTRVJUKHJ3X2lzX2xvY2tlZCgmcGRldi0+ZG9tYWluLT5wY2lfbG9j
aykpOw0KIA0KICAgICBpZiAoIChhZGRyZXNzICYgTVNJX0FERFJfQkFTRV9NQVNLKSAhPSBNU0lf
QUREUl9IRUFERVIgKQ0KICAgICB7DQpAQCAtNzI1LDggKzcyNSw4IEBAIHZvaWQgdnBjaV9tc2lf
YXJjaF91cGRhdGUoc3RydWN0IHZwY2lfbXNpICptc2ksIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpw
ZGV2KQ0KICAgICBpbnQgcmM7DQogDQogICAgIEFTU0VSVChtc2ktPmFyY2gucGlycSAhPSBJTlZB
TElEX1BJUlEpOw0KKyAgICBBU1NFUlQocndfaXNfbG9ja2VkKCZwZGV2LT5kb21haW4tPnBjaV9s
b2NrKSk7DQogDQotICAgIHBjaWRldnNfbG9jaygpOw0KICAgICBmb3IgKCBpID0gMDsgaSA8IG1z
aS0+dmVjdG9ycyAmJiBtc2ktPmFyY2guYm91bmQ7IGkrKyApDQogICAgIHsNCiAgICAgICAgIHN0
cnVjdCB4ZW5fZG9tY3RsX2JpbmRfcHRfaXJxIHVuYmluZCA9IHsNCkBAIC03NDUsNyArNzQ1LDYg
QEAgdm9pZCB2cGNpX21zaV9hcmNoX3VwZGF0ZShzdHJ1Y3QgdnBjaV9tc2kgKm1zaSwgY29uc3Qg
c3RydWN0IHBjaV9kZXYgKnBkZXYpDQogDQogICAgIG1zaS0+YXJjaC5ib3VuZCA9ICF2cGNpX21z
aV91cGRhdGUocGRldiwgbXNpLT5kYXRhLCBtc2ktPmFkZHJlc3MsDQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbXNpLT52ZWN0b3JzLCBtc2ktPmFyY2gucGlycSwgbXNp
LT5tYXNrKTsNCi0gICAgcGNpZGV2c191bmxvY2soKTsNCiB9DQogDQogc3RhdGljIGludCB2cGNp
X21zaV9lbmFibGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCBuciwN
CkBAIC03NjIsNyArNzYxLDcgQEAgc3RhdGljIGludCB2cGNpX21zaV9lbmFibGUoY29uc3Qgc3Ry
dWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCBuciwNCiAgICAgcmMgPSBhbGxvY2F0ZV9h
bmRfbWFwX21zaV9waXJxKHBkZXYtPmRvbWFpbiwgLTEsICZwaXJxLA0KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdGFibGVfYmFzZSA/IE1BUF9QSVJRX1RZUEVfTVNJDQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogTUFQX1BJUlFfVFlQ
RV9NVUxUSV9NU0ksDQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbXNpX2lu
Zm8pOw0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm1zaV9pbmZvLCBmYWxz
ZSk7DQogICAgIGlmICggcmMgKQ0KICAgICB7DQogICAgICAgICBnZHByaW50ayhYRU5MT0dfRVJS
LCAiJXBwOiBmYWlsZWQgdG8gbWFwIFBJUlE6ICVkXG4iLCAmcGRldi0+c2JkZiwgcmMpOw0KQEAg
LTc3OCwxNSArNzc3LDEzIEBAIGludCB2cGNpX21zaV9hcmNoX2VuYWJsZShzdHJ1Y3QgdnBjaV9t
c2kgKm1zaSwgY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsDQogICAgIGludCByYzsNCiANCiAg
ICAgQVNTRVJUKG1zaS0+YXJjaC5waXJxID09IElOVkFMSURfUElSUSk7DQorICAgIEFTU0VSVChy
d19pc19sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xvY2spKTsNCiAgICAgcmMgPSB2cGNpX21z
aV9lbmFibGUocGRldiwgdmVjdG9ycywgMCk7DQogICAgIGlmICggcmMgPCAwICkNCiAgICAgICAg
IHJldHVybiByYzsNCiAgICAgbXNpLT5hcmNoLnBpcnEgPSByYzsNCi0NCi0gICAgcGNpZGV2c19s
b2NrKCk7DQogICAgIG1zaS0+YXJjaC5ib3VuZCA9ICF2cGNpX21zaV91cGRhdGUocGRldiwgbXNp
LT5kYXRhLCBtc2ktPmFkZHJlc3MsIHZlY3RvcnMsDQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbXNpLT5hcmNoLnBpcnEsIG1zaS0+bWFzayk7DQotICAgIHBjaWRldnNf
dW5sb2NrKCk7DQogDQogICAgIHJldHVybiAwOw0KIH0NCkBAIC03OTcsOCArNzk0LDggQEAgc3Rh
dGljIHZvaWQgdnBjaV9tc2lfZGlzYWJsZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgaW50
IHBpcnEsDQogICAgIHVuc2lnbmVkIGludCBpOw0KIA0KICAgICBBU1NFUlQocGlycSAhPSBJTlZB
TElEX1BJUlEpOw0KKyAgICBBU1NFUlQocndfaXNfbG9ja2VkKCZwZGV2LT5kb21haW4tPnBjaV9s
b2NrKSk7DQogDQotICAgIHBjaWRldnNfbG9jaygpOw0KICAgICBmb3IgKCBpID0gMDsgaSA8IG5y
ICYmIGJvdW5kOyBpKysgKQ0KICAgICB7DQogICAgICAgICBzdHJ1Y3QgeGVuX2RvbWN0bF9iaW5k
X3B0X2lycSBiaW5kID0gew0KQEAgLTgxNCw3ICs4MTEsNiBAQCBzdGF0aWMgdm9pZCB2cGNpX21z
aV9kaXNhYmxlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBpbnQgcGlycSwNCiAgICAgd3Jp
dGVfbG9jaygmcGRldi0+ZG9tYWluLT5ldmVudF9sb2NrKTsNCiAgICAgdW5tYXBfZG9tYWluX3Bp
cnEocGRldi0+ZG9tYWluLCBwaXJxKTsNCiAgICAgd3JpdGVfdW5sb2NrKCZwZGV2LT5kb21haW4t
PmV2ZW50X2xvY2spOw0KLSAgICBwY2lkZXZzX3VubG9jaygpOw0KIH0NCiANCiB2b2lkIHZwY2lf
bXNpX2FyY2hfZGlzYWJsZShzdHJ1Y3QgdnBjaV9tc2kgKm1zaSwgY29uc3Qgc3RydWN0IHBjaV9k
ZXYgKnBkZXYpDQpAQCAtODU0LDYgKzg1MCw4IEBAIGludCB2cGNpX21zaXhfYXJjaF9lbmFibGVf
ZW50cnkoc3RydWN0IHZwY2lfbXNpeF9lbnRyeSAqZW50cnksDQogICAgIGludCByYzsNCiANCiAg
ICAgQVNTRVJUKGVudHJ5LT5hcmNoLnBpcnEgPT0gSU5WQUxJRF9QSVJRKTsNCisgICAgQVNTRVJU
KHJ3X2lzX2xvY2tlZCgmcGRldi0+ZG9tYWluLT5wY2lfbG9jaykpOw0KKw0KICAgICByYyA9IHZw
Y2lfbXNpX2VuYWJsZShwZGV2LCB2bXNpeF9lbnRyeV9ucihwZGV2LT52cGNpLT5tc2l4LCBlbnRy
eSksDQogICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlX2Jhc2UpOw0KICAgICBpZiAoIHJj
IDwgMCApDQpAQCAtODYxLDcgKzg1OSw2IEBAIGludCB2cGNpX21zaXhfYXJjaF9lbmFibGVfZW50
cnkoc3RydWN0IHZwY2lfbXNpeF9lbnRyeSAqZW50cnksDQogDQogICAgIGVudHJ5LT5hcmNoLnBp
cnEgPSByYzsNCiANCi0gICAgcGNpZGV2c19sb2NrKCk7DQogICAgIHJjID0gdnBjaV9tc2lfdXBk
YXRlKHBkZXYsIGVudHJ5LT5kYXRhLCBlbnRyeS0+YWRkciwgMSwgZW50cnktPmFyY2gucGlycSwN
CiAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnktPm1hc2tlZCk7DQogICAgIGlmICggcmMg
KQ0KQEAgLTg2OSw3ICs4NjYsNiBAQCBpbnQgdnBjaV9tc2l4X2FyY2hfZW5hYmxlX2VudHJ5KHN0
cnVjdCB2cGNpX21zaXhfZW50cnkgKmVudHJ5LA0KICAgICAgICAgdnBjaV9tc2lfZGlzYWJsZShw
ZGV2LCBlbnRyeS0+YXJjaC5waXJxLCAxLCBmYWxzZSk7DQogICAgICAgICBlbnRyeS0+YXJjaC5w
aXJxID0gSU5WQUxJRF9QSVJROw0KICAgICB9DQotICAgIHBjaWRldnNfdW5sb2NrKCk7DQogDQog
ICAgIHJldHVybiByYzsNCiB9DQpAQCAtODk1LDYgKzg5MSw4IEBAIGludCB2cGNpX21zaXhfYXJj
aF9wcmludChjb25zdCBzdHJ1Y3QgdnBjaV9tc2l4ICptc2l4KQ0KIHsNCiAgICAgdW5zaWduZWQg
aW50IGk7DQogDQorICAgIEFTU0VSVChyd19pc19sb2NrZWQoJm1zaXgtPnBkZXYtPmRvbWFpbi0+
cGNpX2xvY2spKTsNCisNCiAgICAgZm9yICggaSA9IDA7IGkgPCBtc2l4LT5tYXhfZW50cmllczsg
aSsrICkNCiAgICAgew0KICAgICAgICAgY29uc3Qgc3RydWN0IHZwY2lfbXNpeF9lbnRyeSAqZW50
cnkgPSAmbXNpeC0+ZW50cmllc1tpXTsNCkBAIC05MTMsNyArOTExLDkgQEAgaW50IHZwY2lfbXNp
eF9hcmNoX3ByaW50KGNvbnN0IHN0cnVjdCB2cGNpX21zaXggKm1zaXgpDQogICAgICAgICAgICAg
c3RydWN0IHBjaV9kZXYgKnBkZXYgPSBtc2l4LT5wZGV2Ow0KIA0KICAgICAgICAgICAgIHNwaW5f
dW5sb2NrKCZtc2l4LT5wZGV2LT52cGNpLT5sb2NrKTsNCisgICAgICAgICAgICByZWFkX3VubG9j
aygmcGRldi0+ZG9tYWluLT5wY2lfbG9jayk7DQogICAgICAgICAgICAgcHJvY2Vzc19wZW5kaW5n
X3NvZnRpcnFzKCk7DQorICAgICAgICAgICAgcmVhZF9sb2NrKCZwZGV2LT5kb21haW4tPnBjaV9s
b2NrKTsNCiAgICAgICAgICAgICAvKiBOQjogd2UgYXNzdW1lIHRoYXQgcGRldiBjYW5ub3QgZ28g
YXdheSBmb3IgYW4gYWxpdmUgZG9tYWluLiAqLw0KICAgICAgICAgICAgIGlmICggIXBkZXYtPnZw
Y2kgfHwgIXNwaW5fdHJ5bG9jaygmcGRldi0+dnBjaS0+bG9jaykgKQ0KICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVCVVNZOw0KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5j
IGIveGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMNCmluZGV4IDFlZGM3ZjFlOTEuLjU0NWEyNzc5
NmUgMTAwNjQ0DQotLS0gYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYw0KKysrIGIveGVuL2Fy
Y2gveDg2L2h2bS92bXgvdm14LmMNCkBAIC00MTMsOCArNDEzLDYgQEAgc3RhdGljIGludCBjZl9j
aGVjayB2bXhfcGlfdXBkYXRlX2lydGUoY29uc3Qgc3RydWN0IHZjcHUgKnYsDQogDQogICAgIHNw
aW5fdW5sb2NrX2lycSgmZGVzYy0+bG9jayk7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xvY2tl
ZCgpKTsNCi0NCiAgICAgcmV0dXJuIGlvbW11X3VwZGF0ZV9pcmVfZnJvbV9tc2kobXNpX2Rlc2Ms
ICZtc2lfZGVzYy0+bXNnKTsNCiANCiAgdW5sb2NrX291dDoNCmRpZmYgLS1naXQgYS94ZW4vYXJj
aC94ODYvaW5jbHVkZS9hc20vaXJxLmggYi94ZW4vYXJjaC94ODYvaW5jbHVkZS9hc20vaXJxLmgN
CmluZGV4IGFkOTA3ZmM5N2YuLjNkMjRmMzljYTYgMTAwNjQ0DQotLS0gYS94ZW4vYXJjaC94ODYv
aW5jbHVkZS9hc20vaXJxLmgNCisrKyBiL3hlbi9hcmNoL3g4Ni9pbmNsdWRlL2FzbS9pcnEuaA0K
QEAgLTIxMyw2ICsyMTMsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgYXJjaF9tb3ZlX2lycXMoc3Ry
dWN0IHZjcHUgKnYpIHsgfQ0KIHN0cnVjdCBtc2lfaW5mbzsNCiBpbnQgYWxsb2NhdGVfYW5kX21h
cF9nc2lfcGlycShzdHJ1Y3QgZG9tYWluICpkLCBpbnQgaW5kZXgsIGludCAqcGlycV9wKTsNCiBp
bnQgYWxsb2NhdGVfYW5kX21hcF9tc2lfcGlycShzdHJ1Y3QgZG9tYWluICpkLCBpbnQgaW5kZXgs
IGludCAqcGlycV9wLA0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCB0eXBlLCBz
dHJ1Y3QgbXNpX2luZm8gKm1zaSk7DQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
IHR5cGUsIHN0cnVjdCBtc2lfaW5mbyAqbXNpLA0KKwkJCSAgICAgIGJvb2wgdXNlX3BjaV9sb2Nr
KTsNCiANCiAjZW5kaWYgLyogX0FTTV9IV19JUlFfSCAqLw0KZGlmZiAtLWdpdCBhL3hlbi9hcmNo
L3g4Ni9pcnEuYyBiL3hlbi9hcmNoL3g4Ni9pcnEuYw0KaW5kZXggNjhiNzg4YzQyZS4uOTcwYmEw
NGFhMCAxMDA2NDQNCi0tLSBhL3hlbi9hcmNoL3g4Ni9pcnEuYw0KKysrIGIveGVuL2FyY2gveDg2
L2lycS5jDQpAQCAtMjE1Nyw3ICsyMTU3LDcgQEAgaW50IG1hcF9kb21haW5fcGlycSgNCiAgICAg
ICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0KICAgICAgICAgdW5zaWduZWQgaW50IG5yID0gMDsN
CiANCi0gICAgICAgIEFTU0VSVChwY2lkZXZzX2xvY2tlZCgpKTsNCisgICAgICAgIEFTU0VSVChw
Y2lkZXZzX2xvY2tlZCgpIHx8IHJ3X2lzX2xvY2tlZCgmZC0+cGNpX2xvY2spKTsNCiANCiAgICAg
ICAgIHJldCA9IC1FTk9ERVY7DQogICAgICAgICBpZiAoICFjcHVfaGFzX2FwaWMgKQ0KQEAgLTIz
MTQsNyArMjMxNCw3IEBAIGludCB1bm1hcF9kb21haW5fcGlycShzdHJ1Y3QgZG9tYWluICpkLCBp
bnQgcGlycSkNCiAgICAgaWYgKCAocGlycSA8IDApIHx8IChwaXJxID49IGQtPm5yX3BpcnFzKSAp
DQogICAgICAgICByZXR1cm4gLUVJTlZBTDsNCiANCi0gICAgQVNTRVJUKHBjaWRldnNfbG9ja2Vk
KCkpOw0KKyAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQoKSB8fCByd19pc19sb2NrZWQoJmQtPnBj
aV9sb2NrKSk7DQogICAgIEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJmQtPmV2ZW50X2xvY2sp
KTsNCiANCiAgICAgaW5mbyA9IHBpcnFfaW5mbyhkLCBwaXJxKTsNCkBAIC0yODc1LDcgKzI4NzUs
NyBAQCBpbnQgYWxsb2NhdGVfYW5kX21hcF9nc2lfcGlycShzdHJ1Y3QgZG9tYWluICpkLCBpbnQg
aW5kZXgsIGludCAqcGlycV9wKQ0KIH0NCiANCiBpbnQgYWxsb2NhdGVfYW5kX21hcF9tc2lfcGly
cShzdHJ1Y3QgZG9tYWluICpkLCBpbnQgaW5kZXgsIGludCAqcGlycV9wLA0KLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCB0eXBlLCBzdHJ1Y3QgbXNpX2luZm8gKm1zaSkNCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgdHlwZSwgc3RydWN0IG1zaV9pbmZvICptc2ks
IGJvb2wgdXNlX3BjaV9sb2NrKQ0KIHsNCiAgICAgaW50IGlycSwgcGlycSwgcmV0Ow0KIA0KQEAg
LTI5MDgsNyArMjkwOCw4IEBAIGludCBhbGxvY2F0ZV9hbmRfbWFwX21zaV9waXJxKHN0cnVjdCBk
b21haW4gKmQsIGludCBpbmRleCwgaW50ICpwaXJxX3AsDQogDQogICAgIG1zaS0+aXJxID0gaXJx
Ow0KIA0KLSAgICBwY2lkZXZzX2xvY2soKTsNCisgICAgaWYgKCB1c2VfcGNpX2xvY2sgKQ0KKyAg
ICAgICAgcGNpZGV2c19sb2NrKCk7DQogICAgIC8qIFZlcmlmeSBvciBnZXQgcGlycS4gKi8NCiAg
ICAgd3JpdGVfbG9jaygmZC0+ZXZlbnRfbG9jayk7DQogICAgIHBpcnEgPSBhbGxvY2F0ZV9waXJx
KGQsIGluZGV4LCAqcGlycV9wLCBpcnEsIHR5cGUsICZtc2ktPmVudHJ5X25yKTsNCkBAIC0yOTI0
LDcgKzI5MjUsOCBAQCBpbnQgYWxsb2NhdGVfYW5kX21hcF9tc2lfcGlycShzdHJ1Y3QgZG9tYWlu
ICpkLCBpbnQgaW5kZXgsIGludCAqcGlycV9wLA0KIA0KICBkb25lOg0KICAgICB3cml0ZV91bmxv
Y2soJmQtPmV2ZW50X2xvY2spOw0KLSAgICBwY2lkZXZzX3VubG9jaygpOw0KKyAgICBpZiAoIHVz
ZV9wY2lfbG9jayApDQorICAgICAgICBwY2lkZXZzX3VubG9jaygpOw0KICAgICBpZiAoIHJldCAp
DQogICAgIHsNCiAgICAgICAgIHN3aXRjaCAoIHR5cGUgKQ0KZGlmZiAtLWdpdCBhL3hlbi9hcmNo
L3g4Ni9tc2kuYyBiL3hlbi9hcmNoL3g4Ni9tc2kuYw0KaW5kZXggMjAyNzUyNjBiMy4uNDY2NzI1
ZDhjYSAxMDA2NDQNCi0tLSBhL3hlbi9hcmNoL3g4Ni9tc2kuYw0KKysrIGIveGVuL2FyY2gveDg2
L21zaS5jDQpAQCAtNjAyLDcgKzYwMiw3IEBAIHN0YXRpYyBpbnQgbXNpX2NhcGFiaWxpdHlfaW5p
dChzdHJ1Y3QgcGNpX2RldiAqZGV2LA0KICAgICB1bnNpZ25lZCBpbnQgaSwgbXBvczsNCiAgICAg
dWludDE2X3QgY29udHJvbDsNCiANCi0gICAgQVNTRVJUKHBjaWRldnNfbG9ja2VkKCkpOw0KKyAg
ICBBU1NFUlQocGNpZGV2c19sb2NrZWQoKSB8fCByd19pc19sb2NrZWQoJmRldi0+ZG9tYWluLT5w
Y2lfbG9jaykpOw0KICAgICBwb3MgPSBwY2lfZmluZF9jYXBfb2Zmc2V0KGRldi0+c2JkZiwgUENJ
X0NBUF9JRF9NU0kpOw0KICAgICBpZiAoICFwb3MgKQ0KICAgICAgICAgcmV0dXJuIC1FTk9ERVY7
DQpAQCAtNzcxLDcgKzc3MSw3IEBAIHN0YXRpYyBpbnQgbXNpeF9jYXBhYmlsaXR5X2luaXQoc3Ry
dWN0IHBjaV9kZXYgKmRldiwNCiAgICAgaWYgKCAhcG9zICkNCiAgICAgICAgIHJldHVybiAtRU5P
REVWOw0KIA0KLSAgICBBU1NFUlQocGNpZGV2c19sb2NrZWQoKSk7DQorICAgIEFTU0VSVChwY2lk
ZXZzX2xvY2tlZCgpIHx8IHJ3X2lzX2xvY2tlZCgmZGV2LT5kb21haW4tPnBjaV9sb2NrKSk7DQog
DQogICAgIGNvbnRyb2wgPSBwY2lfY29uZl9yZWFkMTYoZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xf
cmVnKHBvcykpOw0KICAgICAvKg0KQEAgLTk4OCw4ICs5ODgsNiBAQCBzdGF0aWMgaW50IF9fcGNp
X2VuYWJsZV9tc2koc3RydWN0IG1zaV9pbmZvICptc2ksIHN0cnVjdCBtc2lfZGVzYyAqKmRlc2Ms
DQogew0KICAgICBzdHJ1Y3QgbXNpX2Rlc2MgKm9sZF9kZXNjOw0KIA0KLSAgICBBU1NFUlQocGNp
ZGV2c19sb2NrZWQoKSk7DQotDQogICAgIGlmICggIXBkZXYgKQ0KICAgICAgICAgcmV0dXJuIC1F
Tk9ERVY7DQogDQpAQCAtMTA0Myw4ICsxMDQxLDYgQEAgc3RhdGljIGludCBfX3BjaV9lbmFibGVf
bXNpeChzdHJ1Y3QgbXNpX2luZm8gKm1zaSwgc3RydWN0IG1zaV9kZXNjICoqZGVzYywNCiB7DQog
ICAgIHN0cnVjdCBtc2lfZGVzYyAqb2xkX2Rlc2M7DQogDQotICAgIEFTU0VSVChwY2lkZXZzX2xv
Y2tlZCgpKTsNCi0NCiAgICAgaWYgKCAhcGRldiB8fCAhcGRldi0+bXNpeCApDQogICAgICAgICBy
ZXR1cm4gLUVOT0RFVjsNCiANCkBAIC0xMTU0LDggKzExNTAsNiBAQCBpbnQgcGNpX3ByZXBhcmVf
bXNpeCh1MTYgc2VnLCB1OCBidXMsIHU4IGRldmZuLCBib29sIG9mZikNCiBpbnQgcGNpX2VuYWJs
ZV9tc2koc3RydWN0IG1zaV9pbmZvICptc2ksIHN0cnVjdCBtc2lfZGVzYyAqKmRlc2MsDQogCQkg
ICBzdHJ1Y3QgcGNpX2RldiAqcGRldikNCiB7DQotICAgIEFTU0VSVChwY2lkZXZzX2xvY2tlZCgp
KTsNCi0NCiAgICAgaWYgKCAhdXNlX21zaSApDQogICAgICAgICByZXR1cm4gLUVQRVJNOw0KIA0K
ZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9waHlzZGV2LmMgYi94ZW4vYXJjaC94ODYvcGh5c2Rl
di5jDQppbmRleCAyZjFkOTU1YTk2Li43Y2JiNWJjMmM4IDEwMDY0NA0KLS0tIGEveGVuL2FyY2gv
eDg2L3BoeXNkZXYuYw0KKysrIGIveGVuL2FyY2gveDg2L3BoeXNkZXYuYw0KQEAgLTEyMyw3ICsx
MjMsNyBAQCBpbnQgcGh5c2Rldl9tYXBfcGlycShkb21pZF90IGRvbWlkLCBpbnQgdHlwZSwgaW50
ICppbmRleCwgaW50ICpwaXJxX3AsDQogDQogICAgIGNhc2UgTUFQX1BJUlFfVFlQRV9NU0k6DQog
ICAgIGNhc2UgTUFQX1BJUlFfVFlQRV9NVUxUSV9NU0k6DQotICAgICAgICByZXQgPSBhbGxvY2F0
ZV9hbmRfbWFwX21zaV9waXJxKGQsICppbmRleCwgcGlycV9wLCB0eXBlLCBtc2kpOw0KKyAgICAg
ICAgcmV0ID0gYWxsb2NhdGVfYW5kX21hcF9tc2lfcGlycShkLCAqaW5kZXgsIHBpcnFfcCwgdHlw
ZSwgbXNpLCB0cnVlKTsNCiAgICAgICAgIGJyZWFrOw0KIA0KICAgICBkZWZhdWx0Og0KZGlmZiAt
LWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvcGNpLmMNCmluZGV4IGI4YWQ0ZmEwN2MuLjE4MmRhNDVhY2IgMTAwNjQ0DQotLS0gYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYw0KKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvcGNpLmMNCkBAIC03NTAsNyArNzUwLDYgQEAgaW50IHBjaV9hZGRfZGV2aWNlKHUxNiBzZWcs
IHU4IGJ1cywgdTggZGV2Zm4sDQogICAgICAgICBwZGV2LT5kb21haW4gPSBoYXJkd2FyZV9kb21h
aW47DQogICAgICAgICB3cml0ZV9sb2NrKCZoYXJkd2FyZV9kb21haW4tPnBjaV9sb2NrKTsNCiAg
ICAgICAgIGxpc3RfYWRkKCZwZGV2LT5kb21haW5fbGlzdCwgJmhhcmR3YXJlX2RvbWFpbi0+cGRl
dl9saXN0KTsNCi0gICAgICAgIHdyaXRlX3VubG9jaygmaGFyZHdhcmVfZG9tYWluLT5wY2lfbG9j
ayk7DQogDQogICAgICAgICAvKg0KICAgICAgICAgICogRm9yIGRldmljZXMgbm90IGRpc2NvdmVy
ZWQgYnkgWGVuIGR1cmluZyBib290LCBhZGQgdlBDSSBoYW5kbGVycw0KQEAgLTc1OSwxOCArNzU4
LDE4IEBAIGludCBwY2lfYWRkX2RldmljZSh1MTYgc2VnLCB1OCBidXMsIHU4IGRldmZuLA0KICAg
ICAgICAgcmV0ID0gdnBjaV9hZGRfaGFuZGxlcnMocGRldik7DQogICAgICAgICBpZiAoIHJldCAp
DQogICAgICAgICB7DQotICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIlNldHVwIG9mIHZQ
Q0kgZmFpbGVkOiAlZFxuIiwgcmV0KTsNCi0gICAgICAgICAgICB3cml0ZV9sb2NrKCZoYXJkd2Fy
ZV9kb21haW4tPnBjaV9sb2NrKTsNCiAgICAgICAgICAgICBsaXN0X2RlbCgmcGRldi0+ZG9tYWlu
X2xpc3QpOw0KICAgICAgICAgICAgIHdyaXRlX3VubG9jaygmaGFyZHdhcmVfZG9tYWluLT5wY2lf
bG9jayk7DQogICAgICAgICAgICAgcGRldi0+ZG9tYWluID0gTlVMTDsNCisgICAgICAgICAgICBw
cmludGsoWEVOTE9HX0VSUiAiU2V0dXAgb2YgdlBDSSBmYWlsZWQ6ICVkXG4iLCByZXQpOw0KICAg
ICAgICAgICAgIGdvdG8gb3V0Ow0KICAgICAgICAgfQ0KKyAgICAgICAgd3JpdGVfdW5sb2NrKCZo
YXJkd2FyZV9kb21haW4tPnBjaV9sb2NrKTsNCiAgICAgICAgIHJldCA9IGlvbW11X2FkZF9kZXZp
Y2UocGRldik7DQogICAgICAgICBpZiAoIHJldCApDQogICAgICAgICB7DQotICAgICAgICAgICAg
dnBjaV9yZW1vdmVfZGV2aWNlKHBkZXYpOw0KICAgICAgICAgICAgIHdyaXRlX2xvY2soJmhhcmR3
YXJlX2RvbWFpbi0+cGNpX2xvY2spOw0KKyAgICAgICAgICAgIHZwY2lfcmVtb3ZlX2RldmljZShw
ZGV2KTsNCiAgICAgICAgICAgICBsaXN0X2RlbCgmcGRldi0+ZG9tYWluX2xpc3QpOw0KICAgICAg
ICAgICAgIHdyaXRlX3VubG9jaygmaGFyZHdhcmVfZG9tYWluLT5wY2lfbG9jayk7DQogICAgICAg
ICAgICAgcGRldi0+ZG9tYWluID0gTlVMTDsNCkBAIC0xMTQ2LDcgKzExNDUsOSBAQCBzdGF0aWMg
dm9pZCBfX2h3ZG9tX2luaXQgc2V0dXBfb25lX2h3ZG9tX2RldmljZShjb25zdCBzdHJ1Y3Qgc2V0
dXBfaHdkb20gKmN0eHQsDQogICAgIH0gd2hpbGUgKCBkZXZmbiAhPSBwZGV2LT5kZXZmbiAmJg0K
ICAgICAgICAgICAgICAgUENJX1NMT1QoZGV2Zm4pID09IFBDSV9TTE9UKHBkZXYtPmRldmZuKSAp
Ow0KIA0KKyAgICB3cml0ZV9sb2NrKCZjdHh0LT5kLT5wY2lfbG9jayk7DQogICAgIGVyciA9IHZw
Y2lfYWRkX2hhbmRsZXJzKHBkZXYpOw0KKyAgICB3cml0ZV91bmxvY2soJmN0eHQtPmQtPnBjaV9s
b2NrKTsNCiAgICAgaWYgKCBlcnIgKQ0KICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgInNldHVw
IG9mIHZQQ0kgZm9yIGQlZCBmYWlsZWQ6ICVkXG4iLA0KICAgICAgICAgICAgICAgIGN0eHQtPmQt
PmRvbWFpbl9pZCwgZXJyKTsNCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5j
IGIveGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYw0KaW5kZXggNzY3YzFiYTcxOC4uYTUyZTUyZGI5
NiAxMDA2NDQNCi0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMNCisrKyBiL3hlbi9kcml2
ZXJzL3ZwY2kvaGVhZGVyLmMNCkBAIC0xNzIsNiArMTcyLDcgQEAgYm9vbCB2cGNpX3Byb2Nlc3Nf
cGVuZGluZyhzdHJ1Y3QgdmNwdSAqdikNCiAgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkN
CiAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiANCisgICAgICAgIHdyaXRlX2xvY2soJnYtPmRv
bWFpbi0+cGNpX2xvY2spOw0KICAgICAgICAgc3Bpbl9sb2NrKCZ2LT52cGNpLnBkZXYtPnZwY2kt
PmxvY2spOw0KICAgICAgICAgLyogRGlzYWJsZSBtZW1vcnkgZGVjb2RpbmcgdW5jb25kaXRpb25h
bGx5IG9uIGZhaWx1cmUuICovDQogICAgICAgICBtb2RpZnlfZGVjb2Rpbmcodi0+dnBjaS5wZGV2
LA0KQEAgLTE5MCw2ICsxOTEsNyBAQCBib29sIHZwY2lfcHJvY2Vzc19wZW5kaW5nKHN0cnVjdCB2
Y3B1ICp2KQ0KICAgICAgICAgICAgICAqIGZhaWx1cmUuDQogICAgICAgICAgICAgICovDQogICAg
ICAgICAgICAgdnBjaV9yZW1vdmVfZGV2aWNlKHYtPnZwY2kucGRldik7DQorICAgICAgICB3cml0
ZV91bmxvY2soJnYtPmRvbWFpbi0+cGNpX2xvY2spOw0KICAgICB9DQogDQogICAgIHJldHVybiBm
YWxzZTsNCkBAIC0yMDEsOCArMjAzLDIwIEBAIHN0YXRpYyBpbnQgX19pbml0IGFwcGx5X21hcChz
dHJ1Y3QgZG9tYWluICpkLCBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwNCiAgICAgc3RydWN0
IG1hcF9kYXRhIGRhdGEgPSB7IC5kID0gZCwgLm1hcCA9IHRydWUgfTsNCiAgICAgaW50IHJjOw0K
IA0KKyAgICBBU1NFUlQocndfaXNfd3JpdGVfbG9ja2VkKCZkLT5wY2lfbG9jaykpOw0KKw0KICAg
ICB3aGlsZSAoIChyYyA9IHJhbmdlc2V0X2NvbnN1bWVfcmFuZ2VzKG1lbSwgbWFwX3JhbmdlLCAm
ZGF0YSkpID09IC1FUkVTVEFSVCApDQorICAgIHsNCisgICAgICAgIC8qDQorICAgICAgICAgKiBJ
dCdzIHNhZmUgdG8gZHJvcCBhbmQgcmVhY3F1aXJlIHRoZSBsb2NrIGluIHRoaXMgY29udGV4dA0K
KyAgICAgICAgICogd2l0aG91dCByaXNraW5nIHBkZXYgZGlzYXBwZWFyaW5nIGJlY2F1c2UgZGV2
aWNlcyBjYW5ub3QgYmUNCisgICAgICAgICAqIHJlbW92ZWQgdW50aWwgdGhlIGluaXRpYWwgZG9t
YWluIGhhcyBiZWVuIHN0YXJ0ZWQuDQorICAgICAgICAgKi8NCisgICAgICAgIHJlYWRfdW5sb2Nr
KCZkLT5wY2lfbG9jayk7DQogICAgICAgICBwcm9jZXNzX3BlbmRpbmdfc29mdGlycXMoKTsNCisg
ICAgICAgIHJlYWRfbG9jaygmZC0+cGNpX2xvY2spOw0KKyAgICB9DQorDQogICAgIHJhbmdlc2V0
X2Rlc3Ryb3kobWVtKTsNCiAgICAgaWYgKCAhcmMgKQ0KICAgICAgICAgbW9kaWZ5X2RlY29kaW5n
KHBkZXYsIGNtZCwgZmFsc2UpOw0KQEAgLTI0Myw2ICsyNTcsOCBAQCBzdGF0aWMgaW50IG1vZGlm
eV9iYXJzKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1aW50MTZfdCBjbWQsIGJvb2wgcm9t
X29ubHkpDQogICAgIHVuc2lnbmVkIGludCBpOw0KICAgICBpbnQgcmM7DQogDQorICAgIEFTU0VS
VChyd19pc193cml0ZV9sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xvY2spKTsNCisNCiAgICAg
aWYgKCAhbWVtICkNCiAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KIA0KQEAgLTUyMiw2ICs1Mzgs
OCBAQCBzdGF0aWMgaW50IGNmX2NoZWNrIGluaXRfYmFycyhzdHJ1Y3QgcGNpX2RldiAqcGRldikN
CiAgICAgc3RydWN0IHZwY2lfYmFyICpiYXJzID0gaGVhZGVyLT5iYXJzOw0KICAgICBpbnQgcmM7
DQogDQorICAgIEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xv
Y2spKTsNCisNCiAgICAgc3dpdGNoICggcGNpX2NvbmZfcmVhZDgocGRldi0+c2JkZiwgUENJX0hF
QURFUl9UWVBFKSAmIDB4N2YgKQ0KICAgICB7DQogICAgIGNhc2UgUENJX0hFQURFUl9UWVBFX05P
Uk1BTDoNCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL21zaS5jIGIveGVuL2RyaXZlcnMv
dnBjaS9tc2kuYw0KaW5kZXggYTI1M2NjYmQ3ZC4uMmZhYTU0YjdjZSAxMDA2NDQNCi0tLSBhL3hl
bi9kcml2ZXJzL3ZwY2kvbXNpLmMNCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpLmMNCkBAIC0y
NjMsNyArMjYzLDcgQEAgUkVHSVNURVJfVlBDSV9JTklUKGluaXRfbXNpLCBWUENJX1BSSU9SSVRZ
X0xPVyk7DQogDQogdm9pZCB2cGNpX2R1bXBfbXNpKHZvaWQpDQogew0KLSAgICBjb25zdCBzdHJ1
Y3QgZG9tYWluICpkOw0KKyAgICBzdHJ1Y3QgZG9tYWluICpkOw0KIA0KICAgICByY3VfcmVhZF9s
b2NrKCZkb21saXN0X3JlYWRfbG9jayk7DQogICAgIGZvcl9lYWNoX2RvbWFpbiAoIGQgKQ0KQEAg
LTI3NSw2ICsyNzUsOSBAQCB2b2lkIHZwY2lfZHVtcF9tc2kodm9pZCkNCiANCiAgICAgICAgIHBy
aW50aygidlBDSSBNU0kvTVNJLVggZCVkXG4iLCBkLT5kb21haW5faWQpOw0KIA0KKyAgICAgICAg
aWYgKCAhcmVhZF90cnlsb2NrKCZkLT5wY2lfbG9jaykgKQ0KKyAgICAgICAgICAgIGNvbnRpbnVl
Ow0KKw0KICAgICAgICAgZm9yX2VhY2hfcGRldiAoIGQsIHBkZXYgKQ0KICAgICAgICAgew0KICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCB2cGNpX21zaSAqbXNpOw0KQEAgLTMxNiwxNCArMzE5LDMz
IEBAIHZvaWQgdnBjaV9kdW1wX21zaSh2b2lkKQ0KICAgICAgICAgICAgICAgICAgICAgICogaG9s
ZGluZyB0aGUgbG9jay4NCiAgICAgICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAg
ICAgICAgcHJpbnRrKCJ1bmFibGUgdG8gcHJpbnQgYWxsIE1TSS1YIGVudHJpZXM6ICVkXG4iLCBy
Yyk7DQotICAgICAgICAgICAgICAgICAgICBwcm9jZXNzX3BlbmRpbmdfc29mdGlycXMoKTsNCi0g
ICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KKyAgICAgICAgICAgICAgICAgICAgZ290byBw
ZGV2X2RvbmU7DQogICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICB9DQogDQogICAgICAg
ICAgICAgc3Bpbl91bmxvY2soJnBkZXYtPnZwY2ktPmxvY2spOw0KKyBwZGV2X2RvbmU6DQorICAg
ICAgICAgICAgLyoNCisgICAgICAgICAgICAgKiBVbmxvY2sgbG9jayB0byBwcm9jZXNzIHBlbmRp
bmcgc29mdGlycXMuIFRoaXMgaXMNCisgICAgICAgICAgICAgKiBwb3RlbnRpYWxseSB1bnNhZmUs
IGFzIGQtPnBkZXZfbGlzdCBjYW4gYmUgY2hhbmdlZCBpbg0KKyAgICAgICAgICAgICAqIG1lYW50
aW1lLg0KKyAgICAgICAgICAgICAqLw0KKyAgICAgICAgICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lf
bG9jayk7DQogICAgICAgICAgICAgcHJvY2Vzc19wZW5kaW5nX3NvZnRpcnFzKCk7DQorICAgICAg
ICAgICAgaWYgKCAhcmVhZF90cnlsb2NrKCZkLT5wY2lfbG9jaykgKQ0KKyAgICAgICAgICAgIHsN
CisgICAgICAgICAgICAgICAgcHJpbnRrKCJ1bmFibGUgdG8gYWNjZXNzIG90aGVyIGRldmljZXMg
Zm9yIHRoZSBkb21haW5cbiIpOw0KKyAgICAgICAgICAgICAgICBnb3RvIGRvbWFpbl9kb25lOw0K
KyAgICAgICAgICAgIH0NCiAgICAgICAgIH0NCisgICAgICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lf
bG9jayk7DQorICAgIGRvbWFpbl9kb25lOg0KKyAgICAgICAgLyoNCisgICAgICAgICAqIFdlIG5l
ZWQgdGhpcyBsYWJlbCBhdCB0aGUgZW5kIG9mIHRoZSBsb29wLCBidXQgc29tZQ0KKyAgICAgICAg
ICogY29tcGlsZXJzIG1pZ2h0IG5vdCBiZSBoYXBweSBhYm91dCBsYWJlbCBhdCB0aGUgZW5kIG9m
IHRoZQ0KKyAgICAgICAgICogY29tcG91bmQgc3RhdGVtZW50IHNvIHdlIGFkZGluZyBhbiBlbXB0
eSBzdGF0ZW1lbnQgaGVyZS4NCisgICAgICAgICAqLw0KKyAgICAgICAgOw0KICAgICB9DQogICAg
IHJjdV9yZWFkX3VubG9jaygmZG9tbGlzdF9yZWFkX2xvY2spOw0KIH0NCmRpZmYgLS1naXQgYS94
ZW4vZHJpdmVycy92cGNpL21zaXguYyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jDQppbmRleCBk
MTEyNmE0MTdkLi5iNmFiYWI0N2VmIDEwMDY0NA0KLS0tIGEveGVuL2RyaXZlcnMvdnBjaS9tc2l4
LmMNCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jDQpAQCAtMTQ3LDYgKzE0Nyw4IEBAIHN0
YXRpYyBzdHJ1Y3QgdnBjaV9tc2l4ICptc2l4X2ZpbmQoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgbG9uZyBhZGRyKQ0KIHsNCiAgICAgc3RydWN0IHZwY2lfbXNpeCAqbXNpeDsNCiAN
CisgICAgQVNTRVJUKHJ3X2lzX2xvY2tlZCgmZC0+cGNpX2xvY2spKTsNCisNCiAgICAgbGlzdF9m
b3JfZWFjaF9lbnRyeSAoIG1zaXgsICZkLT5hcmNoLmh2bS5tc2l4X3RhYmxlcywgbmV4dCApDQog
ICAgIHsNCiAgICAgICAgIGNvbnN0IHN0cnVjdCB2cGNpX2JhciAqYmFycyA9IG1zaXgtPnBkZXYt
PnZwY2ktPmhlYWRlci5iYXJzOw0KQEAgLTE2Myw3ICsxNjUsMTMgQEAgc3RhdGljIHN0cnVjdCB2
cGNpX21zaXggKm1zaXhfZmluZChjb25zdCBzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25n
IGFkZHIpDQogDQogc3RhdGljIGludCBjZl9jaGVjayBtc2l4X2FjY2VwdChzdHJ1Y3QgdmNwdSAq
diwgdW5zaWduZWQgbG9uZyBhZGRyKQ0KIHsNCi0gICAgcmV0dXJuICEhbXNpeF9maW5kKHYtPmRv
bWFpbiwgYWRkcik7DQorICAgIGludCByYzsNCisNCisgICAgcmVhZF9sb2NrKCZ2LT5kb21haW4t
PnBjaV9sb2NrKTsNCisgICAgcmMgPSAhIW1zaXhfZmluZCh2LT5kb21haW4sIGFkZHIpOw0KKyAg
ICByZWFkX3VubG9jaygmdi0+ZG9tYWluLT5wY2lfbG9jayk7DQorDQorICAgIHJldHVybiByYzsN
CiB9DQogDQogc3RhdGljIGJvb2wgYWNjZXNzX2FsbG93ZWQoY29uc3Qgc3RydWN0IHBjaV9kZXYg
KnBkZXYsIHVuc2lnbmVkIGxvbmcgYWRkciwNCkBAIC0zNTgsMjEgKzM2NiwzNSBAQCBzdGF0aWMg
aW50IGFkamFjZW50X3JlYWQoY29uc3Qgc3RydWN0IGRvbWFpbiAqZCwgY29uc3Qgc3RydWN0IHZw
Y2lfbXNpeCAqbXNpeCwNCiBzdGF0aWMgaW50IGNmX2NoZWNrIG1zaXhfcmVhZCgNCiAgICAgc3Ry
dWN0IHZjcHUgKnYsIHVuc2lnbmVkIGxvbmcgYWRkciwgdW5zaWduZWQgaW50IGxlbiwgdW5zaWdu
ZWQgbG9uZyAqZGF0YSkNCiB7DQotICAgIGNvbnN0IHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21h
aW47DQotICAgIHN0cnVjdCB2cGNpX21zaXggKm1zaXggPSBtc2l4X2ZpbmQoZCwgYWRkcik7DQor
ICAgIHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21haW47DQorICAgIHN0cnVjdCB2cGNpX21zaXgg
Km1zaXg7DQogICAgIGNvbnN0IHN0cnVjdCB2cGNpX21zaXhfZW50cnkgKmVudHJ5Ow0KICAgICB1
bnNpZ25lZCBpbnQgb2Zmc2V0Ow0KIA0KICAgICAqZGF0YSA9IH4wVUw7DQogDQorICAgIHJlYWRf
bG9jaygmZC0+cGNpX2xvY2spOw0KKw0KKyAgICBtc2l4ID0gbXNpeF9maW5kKGQsIGFkZHIpOw0K
ICAgICBpZiAoICFtc2l4ICkNCisgICAgew0KKyAgICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9s
b2NrKTsNCiAgICAgICAgIHJldHVybiBYODZFTVVMX1JFVFJZOw0KKyAgICB9DQogDQogICAgIGlm
ICggYWRqYWNlbnRfaGFuZGxlKG1zaXgsIGFkZHIpICkNCi0gICAgICAgIHJldHVybiBhZGphY2Vu
dF9yZWFkKGQsIG1zaXgsIGFkZHIsIGxlbiwgZGF0YSk7DQorICAgIHsNCisgICAgICAgIGludCBy
YyA9IGFkamFjZW50X3JlYWQoZCwgbXNpeCwgYWRkciwgbGVuLCBkYXRhKTsNCisNCisgICAgICAg
IHJlYWRfdW5sb2NrKCZkLT5wY2lfbG9jayk7DQorICAgICAgICByZXR1cm4gcmM7DQorICAgIH0N
CiANCiAgICAgaWYgKCAhYWNjZXNzX2FsbG93ZWQobXNpeC0+cGRldiwgYWRkciwgbGVuKSApDQor
ICAgIHsNCisgICAgICAgIHJlYWRfdW5sb2NrKCZkLT5wY2lfbG9jayk7DQogICAgICAgICByZXR1
cm4gWDg2RU1VTF9PS0FZOw0KKyAgICB9DQogDQogICAgIHNwaW5fbG9jaygmbXNpeC0+cGRldi0+
dnBjaS0+bG9jayk7DQogICAgIGVudHJ5ID0gZ2V0X2VudHJ5KG1zaXgsIGFkZHIpOw0KQEAgLTQw
NCw2ICs0MjYsNyBAQCBzdGF0aWMgaW50IGNmX2NoZWNrIG1zaXhfcmVhZCgNCiAgICAgICAgIGJy
ZWFrOw0KICAgICB9DQogICAgIHNwaW5fdW5sb2NrKCZtc2l4LT5wZGV2LT52cGNpLT5sb2NrKTsN
CisgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiANCiAgICAgcmV0dXJuIFg4NkVNVUxf
T0tBWTsNCiB9DQpAQCAtNDkxLDE5ICs1MTQsMzMgQEAgc3RhdGljIGludCBhZGphY2VudF93cml0
ZShjb25zdCBzdHJ1Y3QgZG9tYWluICpkLCBjb25zdCBzdHJ1Y3QgdnBjaV9tc2l4ICptc2l4LA0K
IHN0YXRpYyBpbnQgY2ZfY2hlY2sgbXNpeF93cml0ZSgNCiAgICAgc3RydWN0IHZjcHUgKnYsIHVu
c2lnbmVkIGxvbmcgYWRkciwgdW5zaWduZWQgaW50IGxlbiwgdW5zaWduZWQgbG9uZyBkYXRhKQ0K
IHsNCi0gICAgY29uc3Qgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsNCi0gICAgc3RydWN0
IHZwY2lfbXNpeCAqbXNpeCA9IG1zaXhfZmluZChkLCBhZGRyKTsNCisgICAgc3RydWN0IGRvbWFp
biAqZCA9IHYtPmRvbWFpbjsNCisgICAgc3RydWN0IHZwY2lfbXNpeCAqbXNpeDsNCiAgICAgc3Ry
dWN0IHZwY2lfbXNpeF9lbnRyeSAqZW50cnk7DQogICAgIHVuc2lnbmVkIGludCBvZmZzZXQ7DQog
DQorICAgIHJlYWRfbG9jaygmZC0+cGNpX2xvY2spOw0KKw0KKyAgICBtc2l4ID0gbXNpeF9maW5k
KGQsIGFkZHIpOw0KICAgICBpZiAoICFtc2l4ICkNCisgICAgew0KKyAgICAgICAgcmVhZF91bmxv
Y2soJmQtPnBjaV9sb2NrKTsNCiAgICAgICAgIHJldHVybiBYODZFTVVMX1JFVFJZOw0KKyAgICB9
DQogDQogICAgIGlmICggYWRqYWNlbnRfaGFuZGxlKG1zaXgsIGFkZHIpICkNCi0gICAgICAgIHJl
dHVybiBhZGphY2VudF93cml0ZShkLCBtc2l4LCBhZGRyLCBsZW4sIGRhdGEpOw0KKyAgICB7DQor
ICAgICAgICBpbnQgcmMgPSBhZGphY2VudF93cml0ZShkLCBtc2l4LCBhZGRyLCBsZW4sIGRhdGEp
Ow0KKw0KKyAgICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCisgICAgICAgIHJldHVy
biByYzsNCisgICAgfQ0KIA0KICAgICBpZiAoICFhY2Nlc3NfYWxsb3dlZChtc2l4LT5wZGV2LCBh
ZGRyLCBsZW4pICkNCisgICAgew0KKyAgICAgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsN
CiAgICAgICAgIHJldHVybiBYODZFTVVMX09LQVk7DQorICAgIH0NCiANCiAgICAgc3Bpbl9sb2Nr
KCZtc2l4LT5wZGV2LT52cGNpLT5sb2NrKTsNCiAgICAgZW50cnkgPSBnZXRfZW50cnkobXNpeCwg
YWRkcik7DQpAQCAtNTc5LDYgKzYxNiw3IEBAIHN0YXRpYyBpbnQgY2ZfY2hlY2sgbXNpeF93cml0
ZSgNCiAgICAgICAgIGJyZWFrOw0KICAgICB9DQogICAgIHNwaW5fdW5sb2NrKCZtc2l4LT5wZGV2
LT52cGNpLT5sb2NrKTsNCisgICAgcmVhZF91bmxvY2soJmQtPnBjaV9sb2NrKTsNCiANCiAgICAg
cmV0dXJuIFg4NkVNVUxfT0tBWTsNCiB9DQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBjaS92
cGNpLmMgYi94ZW4vZHJpdmVycy92cGNpL3ZwY2kuYw0KaW5kZXggM2JlYzlhNDE1My4uMTEyZGU1
NmZiMyAxMDA2NDQNCi0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvdnBjaS5jDQorKysgYi94ZW4vZHJp
dmVycy92cGNpL3ZwY2kuYw0KQEAgLTM4LDYgKzM4LDggQEAgZXh0ZXJuIHZwY2lfcmVnaXN0ZXJf
aW5pdF90ICpjb25zdCBfX2VuZF92cGNpX2FycmF5W107DQogDQogdm9pZCB2cGNpX3JlbW92ZV9k
ZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBkZXYpDQogew0KKyAgICBBU1NFUlQocndfaXNfd3JpdGVf
bG9ja2VkKCZwZGV2LT5kb21haW4tPnBjaV9sb2NrKSk7DQorDQogICAgIGlmICggIWhhc192cGNp
KHBkZXYtPmRvbWFpbikgfHwgIXBkZXYtPnZwY2kgKQ0KICAgICAgICAgcmV0dXJuOw0KIA0KQEAg
LTczLDYgKzc1LDggQEAgaW50IHZwY2lfYWRkX2hhbmRsZXJzKHN0cnVjdCBwY2lfZGV2ICpwZGV2
KQ0KICAgICBjb25zdCB1bnNpZ25lZCBsb25nICpyb19tYXA7DQogICAgIGludCByYyA9IDA7DQog
DQorICAgIEFTU0VSVChyd19pc193cml0ZV9sb2NrZWQoJnBkZXYtPmRvbWFpbi0+cGNpX2xvY2sp
KTsNCisNCiAgICAgaWYgKCAhaGFzX3ZwY2kocGRldi0+ZG9tYWluKSApDQogICAgICAgICByZXR1
cm4gMDsNCiANCkBAIC0zMjYsMTEgKzMzMCwxMiBAQCBzdGF0aWMgdWludDMyX3QgbWVyZ2VfcmVz
dWx0KHVpbnQzMl90IGRhdGEsIHVpbnQzMl90IG5ldywgdW5zaWduZWQgaW50IHNpemUsDQogDQog
dWludDMyX3QgdnBjaV9yZWFkKHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdW5z
aWduZWQgaW50IHNpemUpDQogew0KLSAgICBjb25zdCBzdHJ1Y3QgZG9tYWluICpkID0gY3VycmVu
dC0+ZG9tYWluOw0KKyAgICBzdHJ1Y3QgZG9tYWluICpkID0gY3VycmVudC0+ZG9tYWluOw0KICAg
ICBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldjsNCiAgICAgY29uc3Qgc3RydWN0IHZwY2lfcmVn
aXN0ZXIgKnI7DQogICAgIHVuc2lnbmVkIGludCBkYXRhX29mZnNldCA9IDA7DQogICAgIHVpbnQz
Ml90IGRhdGEgPSB+KHVpbnQzMl90KTA7DQorICAgIHJ3bG9ja190ICpsb2NrOw0KIA0KICAgICBp
ZiAoICFzaXplICkNCiAgICAgew0KQEAgLTM0MiwxMSArMzQ3LDIxIEBAIHVpbnQzMl90IHZwY2lf
cmVhZChwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVuc2lnbmVkIGludCBzaXpl
KQ0KICAgICAgKiBGaW5kIHRoZSBQQ0kgZGV2IG1hdGNoaW5nIHRoZSBhZGRyZXNzLCB3aGljaCBm
b3IgaHdkb20gYWxzbyByZXF1aXJlcw0KICAgICAgKiBjb25zdWx0aW5nIERvbVhFTi4gIFBhc3N0
aHJvdWdoIGV2ZXJ5dGhpbmcgdGhhdCdzIG5vdCB0cmFwcGVkLg0KICAgICAgKi8NCisgICAgbG9j
ayA9ICZkLT5wY2lfbG9jazsNCisgICAgcmVhZF9sb2NrKGxvY2spOw0KICAgICBwZGV2ID0gcGNp
X2dldF9wZGV2KGQsIHNiZGYpOw0KICAgICBpZiAoICFwZGV2ICYmIGlzX2hhcmR3YXJlX2RvbWFp
bihkKSApDQorICAgIHsNCisgICAgICAgIHJlYWRfdW5sb2NrKGxvY2spOw0KKyAgICAgICAgbG9j
ayA9ICZkb21feGVuLT5wY2lfbG9jazsNCisgICAgICAgIHJlYWRfbG9jayhsb2NrKTsNCiAgICAg
ICAgIHBkZXYgPSBwY2lfZ2V0X3BkZXYoZG9tX3hlbiwgc2JkZik7DQorICAgIH0NCiAgICAgaWYg
KCAhcGRldiB8fCAhcGRldi0+dnBjaSApDQorICAgIHsNCisgICAgICAgIHJlYWRfdW5sb2NrKGxv
Y2spOw0KICAgICAgICAgcmV0dXJuIHZwY2lfcmVhZF9odyhzYmRmLCByZWcsIHNpemUpOw0KKyAg
ICB9DQogDQogICAgIHNwaW5fbG9jaygmcGRldi0+dnBjaS0+bG9jayk7DQogDQpAQCAtMzkyLDYg
KzQwNyw3IEBAIHVpbnQzMl90IHZwY2lfcmVhZChwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGlu
dCByZWcsIHVuc2lnbmVkIGludCBzaXplKQ0KICAgICAgICAgQVNTRVJUKGRhdGFfb2Zmc2V0IDwg
c2l6ZSk7DQogICAgIH0NCiAgICAgc3Bpbl91bmxvY2soJnBkZXYtPnZwY2ktPmxvY2spOw0KKyAg
ICByZWFkX3VubG9jayhsb2NrKTsNCiANCiAgICAgaWYgKCBkYXRhX29mZnNldCA8IHNpemUgKQ0K
ICAgICB7DQpAQCAtNDMxLDEwICs0NDcsMjMgQEAgc3RhdGljIHZvaWQgdnBjaV93cml0ZV9oZWxw
ZXIoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsDQogICAgICAgICAgICAgIHItPnByaXZhdGUp
Ow0KIH0NCiANCisvKiBIZWxwZXIgZnVuY3Rpb24gdG8gdW5sb2NrIGxvY2tzIHRha2VuIGJ5IHZw
Y2lfd3JpdGUgaW4gcHJvcGVyIG9yZGVyICovDQorc3RhdGljIHZvaWQgcmVsZWFzZV9kb21haW5f
d3JpdGVfbG9ja3Moc3RydWN0IGRvbWFpbiAqZCkNCit7DQorICAgIEFTU0VSVChyd19pc193cml0
ZV9sb2NrZWQoJmQtPnBjaV9sb2NrKSk7DQorDQorICAgIGlmICggaXNfaGFyZHdhcmVfZG9tYWlu
KGQpICkNCisgICAgew0KKyAgICAgICAgQVNTRVJUKHJ3X2lzX3dyaXRlX2xvY2tlZCgmZG9tX3hl
bi0+cGNpX2xvY2spKTsNCisgICAgICAgIHdyaXRlX3VubG9jaygmZG9tX3hlbi0+cGNpX2xvY2sp
Ow0KKyAgICB9DQorICAgIHdyaXRlX3VubG9jaygmZC0+cGNpX2xvY2spOw0KK30NCisNCiB2b2lk
IHZwY2lfd3JpdGUocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBp
bnQgc2l6ZSwNCiAgICAgICAgICAgICAgICAgdWludDMyX3QgZGF0YSkNCiB7DQotICAgIGNvbnN0
IHN0cnVjdCBkb21haW4gKmQgPSBjdXJyZW50LT5kb21haW47DQorICAgIHN0cnVjdCBkb21haW4g
KmQgPSBjdXJyZW50LT5kb21haW47DQogICAgIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2Ow0K
ICAgICBjb25zdCBzdHJ1Y3QgdnBjaV9yZWdpc3RlciAqcjsNCiAgICAgdW5zaWduZWQgaW50IGRh
dGFfb2Zmc2V0ID0gMDsNCkBAIC00NDcsOCArNDc2LDIwIEBAIHZvaWQgdnBjaV93cml0ZShwY2lf
c2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVuc2lnbmVkIGludCBzaXplLA0KIA0KICAg
ICAvKg0KICAgICAgKiBGaW5kIHRoZSBQQ0kgZGV2IG1hdGNoaW5nIHRoZSBhZGRyZXNzLCB3aGlj
aCBmb3IgaHdkb20gYWxzbyByZXF1aXJlcw0KLSAgICAgKiBjb25zdWx0aW5nIERvbVhFTi4gIFBh
c3N0aHJvdWdoIGV2ZXJ5dGhpbmcgdGhhdCdzIG5vdCB0cmFwcGVkLg0KKyAgICAgKiBjb25zdWx0
aW5nIERvbVhFTi4gUGFzc3Rocm91Z2ggZXZlcnl0aGluZyB0aGF0J3Mgbm90IHRyYXBwZWQuDQor
ICAgICAqIElmIHRoaXMgaXMgaHdkb20sIHdlIG5lZWQgdG8gaG9sZCBsb2NrcyBmb3IgYm90aCBk
b21haW4gaW4gY2FzZSBpZg0KKyAgICAgKiBtb2RpZnlfYmFycygpIGlzIGNhbGxlZA0KKyAgICAg
Ki8NCisgICAgLyoNCisgICAgICogVE9ETzogV2UgbmVlZCB0byB0YWtlIHBjaV9sb2NrcyBpbiBl
eGNsdXNpdmUgbW9kZSBvbmx5IGlmIHdlDQorICAgICAqIGFyZSBtb2RpZnlpbmcgQkFScywgc28g
dGhlcmUgaXMgYSByb29tIGZvciBpbXByb3ZlbWVudC4NCiAgICAgICovDQorICAgIHdyaXRlX2xv
Y2soJmQtPnBjaV9sb2NrKTsNCisNCisgICAgLyogZG9tX3hlbi0+cGNpX2xvY2sgYWx3YXlzIHNo
b3VsZCBiZSB0YWtlbiBzZWNvbmQgdG8gcHJldmVudCBkZWFkbG9jayAqLw0KKyAgICBpZiAoIGlz
X2hhcmR3YXJlX2RvbWFpbihkKSApDQorICAgICAgICB3cml0ZV9sb2NrKCZkb21feGVuLT5wY2lf
bG9jayk7DQorDQogICAgIHBkZXYgPSBwY2lfZ2V0X3BkZXYoZCwgc2JkZik7DQogICAgIGlmICgg
IXBkZXYgJiYgaXNfaGFyZHdhcmVfZG9tYWluKGQpICkNCiAgICAgICAgIHBkZXYgPSBwY2lfZ2V0
X3BkZXYoZG9tX3hlbiwgc2JkZik7DQpAQCAtNDU3LDggKzQ5OCwxMSBAQCB2b2lkIHZwY2lfd3Jp
dGUocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25lZCBpbnQgc2l6ZSwN
CiAgICAgICAgIC8qIElnbm9yZSB3cml0ZXMgdG8gcmVhZC1vbmx5IGRldmljZXMsIHdoaWNoIGhh
dmUgbm8gLT52cGNpLiAqLw0KICAgICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyAqcm9fbWFwID0g
cGNpX2dldF9yb19tYXAoc2JkZi5zZWcpOw0KIA0KKyAgICAgICAgcmVsZWFzZV9kb21haW5fd3Jp
dGVfbG9ja3MoZCk7DQorDQogICAgICAgICBpZiAoICFyb19tYXAgfHwgIXRlc3RfYml0KHNiZGYu
YmRmLCByb19tYXApICkNCiAgICAgICAgICAgICB2cGNpX3dyaXRlX2h3KHNiZGYsIHJlZywgc2l6
ZSwgZGF0YSk7DQorDQogICAgICAgICByZXR1cm47DQogICAgIH0NCiANCkBAIC00OTgsNiArNTQy
LDcgQEAgdm9pZCB2cGNpX3dyaXRlKHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywg
dW5zaWduZWQgaW50IHNpemUsDQogICAgICAgICBBU1NFUlQoZGF0YV9vZmZzZXQgPCBzaXplKTsN
CiAgICAgfQ0KICAgICBzcGluX3VubG9jaygmcGRldi0+dnBjaS0+bG9jayk7DQorICAgIHJlbGVh
c2VfZG9tYWluX3dyaXRlX2xvY2tzKGQpOw0KIA0KICAgICBpZiAoIGRhdGFfb2Zmc2V0IDwgc2l6
ZSApDQogICAgICAgICAvKiBUYWlsaW5nIGdhcCwgd3JpdGUgdGhlIHJlbWFpbmluZy4gKi8NCi0t
IA0KMi40Mi4wDQo=


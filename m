Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C7CBB144DC
	for <lists+xen-devel@lfdr.de>; Mon,  6 May 2019 09:00:48 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hNXZB-0003Hl-7N; Mon, 06 May 2019 06:57:37 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=XZcu=TG=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hNXYo-0002LP-4T
 for xen-devel@lists.xenproject.org; Mon, 06 May 2019 06:57:14 +0000
X-Inumbo-ID: 28128da0-6fcc-11e9-843c-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 28128da0-6fcc-11e9-843c-bc764e045a96;
 Mon, 06 May 2019 06:57:05 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id CF998AE3F;
 Mon,  6 May 2019 06:57:00 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  6 May 2019 08:56:44 +0200
Message-Id: <20190506065644.7415-46-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190506065644.7415-1-jgross@suse.com>
References: <20190506065644.7415-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH RFC V2 45/45] xen/sched: add scheduling
 granularity enum
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wei.liu2@citrix.com>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Dario Faggioli <dfaggioli@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIGEgc2NoZWR1bGluZyBncmFudWxhcml0eSBlbnVtICgidGhyZWFkIiwgImNvcmUiLCAic29j
a2V0IikgZm9yCnNwZWNpZmljYXRpb24gb2YgdGhlIHNjaGVkdWxpbmcgZ3JhbnVsYXJpdHkuIElu
aXRpYWxseSBpdCBpcyBzZXQgdG8KInRocmVhZCIsIHRoaXMgY2FuIGJlIG1vZGlmaWVkIGJ5IHRo
ZSBuZXcgYm9vdCBwYXJhbWV0ZXIgKHg4NiBvbmx5KQoic2NoZWRfZ3JhbnVsYXJpdHkiLgoKQWNj
b3JkaW5nIHRvIHRoZSBzZWxlY3RlZCBncmFudWxhcml0eSBzY2hlZF9ncmFudWxhcml0eSBpcyBz
ZXQgYWZ0ZXIKYWxsIGNwdXMgYXJlIG9ubGluZS4gVGhlIHNjaGVkIGl0ZW1zIG9mIHRoZSBpZGxl
IHZjcHVzIGFuZCB0aGUgc2NoZWQKcmVzb3VyY2VzIG9mIHRoZSBwaHlzaWNhbCBjcHVzIG5lZWQg
dG8gYmUgY29tYmluZWQgaW4gY2FzZQpzY2hlZF9ncmFudWxhcml0eSA+IDEsIHRoaXMgaGFwcGVu
cyBiZWZvcmUgdGhlIGluaXRfcGRhdGEgaG9vayBvZgp0aGUgYWN0aXZlIHNjaGVkdWxlciBpcyBi
ZWluZyBjYWxsZWQuCgpBIHRlc3QgaXMgYWRkZWQgZm9yIGFsbCBzY2hlZCByZXNvdXJjZXMgaG9s
ZGluZyB0aGUgc2FtZSBudW1iZXIgb2YKY3B1cy4gRm9yIG5vdyBwYW5pYyBpZiB0aGlzIGlzIG5v
dCB0aGUgY2FzZS4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNv
bT4KLS0tClJGQyBWMjoKLSBmaXhlZCBmcmVlaW5nIG9mIHNjaGVkX3JlcyB3aGVuIG1lcmdpbmcg
Y3B1cwotIHJlbmFtZSBwYXJhbWV0ZXIgdG8gInNjaGVkLWdyYW4iIChKYW4gQmV1bGljaCkKLSBy
ZW5hbWUgcGFyYW1ldGVyIG9wdGlvbiBmcm9tICJ0aHJlYWQiIHRvICJjcHUiIChKYW4gQmV1bGlj
aCkKLS0tCiB4ZW4vYXJjaC94ODYvc2V0dXAuYyAgICAgICB8ICAgMiArCiB4ZW4vY29tbW9uL3Nj
aGVkdWxlLmMgICAgICB8IDE1NSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrLS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIHwgICA0ICstCiB4ZW4vaW5jbHVk
ZS94ZW4vc2NoZWQuaCAgICB8ICAgMSArCiA0IGZpbGVzIGNoYW5nZWQsIDE1MyBpbnNlcnRpb25z
KCspLCA5IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9zZXR1cC5jIGIv
eGVuL2FyY2gveDg2L3NldHVwLmMKaW5kZXggMzQ0MDc5NDI3NS4uODM4NTRlZWVmOCAxMDA2NDQK
LS0tIGEveGVuL2FyY2gveDg2L3NldHVwLmMKKysrIGIveGVuL2FyY2gveDg2L3NldHVwLmMKQEAg
LTE3MDEsNiArMTcwMSw4IEBAIHZvaWQgX19pbml0IG5vcmV0dXJuIF9fc3RhcnRfeGVuKHVuc2ln
bmVkIGxvbmcgbWJpX3ApCiAgICAgICAgIHByaW50ayhYRU5MT0dfSU5GTyAiUGFya2VkICV1IENQ
VXNcbiIsIG51bV9wYXJrZWQpOwogICAgIHNtcF9jcHVzX2RvbmUoKTsKIAorICAgIHNjaGVkdWxl
cl9zbXBfaW5pdCgpOworCiAgICAgZG9faW5pdGNhbGxzKCk7CiAKICAgICBpZiAoIG9wdF93YXRj
aGRvZyApIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jIGIveGVuL2NvbW1vbi9z
Y2hlZHVsZS5jCmluZGV4IDQzMzZmMmJkZjguLjNlNjgyNTk0MTEgMTAwNjQ0Ci0tLSBhL3hlbi9j
b21tb24vc2NoZWR1bGUuYworKysgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKQEAgLTU1LDkgKzU1
LDMyIEBAIGJvb2xlYW5fcGFyYW0oInNjaGVkX3NtdF9wb3dlcl9zYXZpbmdzIiwgc2NoZWRfc210
X3Bvd2VyX3NhdmluZ3MpOwogaW50IHNjaGVkX3JhdGVsaW1pdF91cyA9IFNDSEVEX0RFRkFVTFRf
UkFURUxJTUlUX1VTOwogaW50ZWdlcl9wYXJhbSgic2NoZWRfcmF0ZWxpbWl0X3VzIiwgc2NoZWRf
cmF0ZWxpbWl0X3VzKTsKIAorc3RhdGljIGVudW0geworICAgIFNDSEVEX0dSQU5fY3B1LAorICAg
IFNDSEVEX0dSQU5fY29yZSwKKyAgICBTQ0hFRF9HUkFOX3NvY2tldAorfSBvcHRfc2NoZWRfZ3Jh
bnVsYXJpdHkgPSBTQ0hFRF9HUkFOX2NwdTsKKworI2lmZGVmIENPTkZJR19YODYKK3N0YXRpYyBp
bnQgX19pbml0IHNjaGVkX3NlbGVjdF9ncmFudWxhcml0eShjb25zdCBjaGFyICpzdHIpCit7Cisg
ICAgaWYgKHN0cmNtcCgiY3B1Iiwgc3RyKSA9PSAwKQorICAgICAgICBvcHRfc2NoZWRfZ3JhbnVs
YXJpdHkgPSBTQ0hFRF9HUkFOX2NwdTsKKyAgICBlbHNlIGlmIChzdHJjbXAoImNvcmUiLCBzdHIp
ID09IDApCisgICAgICAgIG9wdF9zY2hlZF9ncmFudWxhcml0eSA9IFNDSEVEX0dSQU5fY29yZTsK
KyAgICBlbHNlIGlmIChzdHJjbXAoInNvY2tldCIsIHN0cikgPT0gMCkKKyAgICAgICAgb3B0X3Nj
aGVkX2dyYW51bGFyaXR5ID0gU0NIRURfR1JBTl9zb2NrZXQ7CisgICAgZWxzZQorICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsKKworICAgIHJldHVybiAwOworfQorY3VzdG9tX3BhcmFtKCJzY2hlZC1n
cmFuIiwgc2NoZWRfc2VsZWN0X2dyYW51bGFyaXR5KTsKKyNlbmRpZgorCiAvKiBOdW1iZXIgb2Yg
dmNwdXMgcGVyIHN0cnVjdCBzY2hlZF9pdGVtLiAqLwogc3RhdGljIHVuc2lnbmVkIGludCBzY2hl
ZF9ncmFudWxhcml0eSA9IDE7Ci1jb25zdCBjcHVtYXNrX3QgKnNjaGVkX3Jlc19tYXNrID0gJmNw
dW1hc2tfYWxsOworY3B1bWFza192YXJfdCBzY2hlZF9yZXNfbWFzazsKIAogLyogVmFyaW91cyB0
aW1lciBoYW5kbGVycy4gKi8KIHN0YXRpYyB2b2lkIHNfdGltZXJfZm4odm9pZCAqdW51c2VkKTsK
QEAgLTMyMyw2ICszNDYsOCBAQCBzdGF0aWMgdm9pZCBzY2hlZF9mcmVlX2l0ZW0oc3RydWN0IHNj
aGVkX2l0ZW0gKml0ZW0sIHN0cnVjdCB2Y3B1ICp2KQogICAgIGlmICggaXRlbS0+dmNwdSA9PSB2
ICkKICAgICAgICAgaXRlbS0+dmNwdSA9IHYtPm5leHRfaW5fbGlzdDsKIAorICAgIGl0ZW0tPnJ1
bnN0YXRlX2NudFt2LT5ydW5zdGF0ZS5zdGF0ZV0tLTsKKwogICAgIGlmICggIWNudCApCiAgICAg
ICAgIHNjaGVkX2ZyZWVfaXRlbV9tZW0oaXRlbSk7CiB9CkBAIC0yMTEzLDggKzIxMzgsMTQgQEAg
c3RhdGljIGludCBjcHVfc2NoZWR1bGVfdXAodW5zaWduZWQgaW50IGNwdSkKICAgICBzZCA9IHh6
YWxsb2Moc3RydWN0IHNjaGVkX3Jlc291cmNlKTsKICAgICBpZiAoIHNkID09IE5VTEwgKQogICAg
ICAgICByZXR1cm4gLUVOT01FTTsKKyAgICBpZiAoICF6YWxsb2NfY3B1bWFza192YXIoJnNkLT5j
cHVzKSApCisgICAgeworICAgICAgICB4ZnJlZShzZCk7CisgICAgICAgIHJldHVybiAtRU5PTUVN
OworICAgIH0KKwogICAgIHNkLT5wcm9jZXNzb3IgPSBjcHU7Ci0gICAgc2QtPmNwdXMgPSBjcHVt
YXNrX29mKGNwdSk7CisgICAgY3B1bWFza19jb3B5KHNkLT5jcHVzLCBjcHVtYXNrX29mKGNwdSkp
OwogICAgIHBlcl9jcHUoc2NoZWRfcmVzLCBjcHUpID0gc2Q7CiAKICAgICBwZXJfY3B1KHNjaGVk
dWxlciwgY3B1KSA9ICZvcHM7CkBAIC0yMTcwLDMwICsyMjAxLDkyIEBAIHN0YXRpYyBpbnQgY3B1
X3NjaGVkdWxlX3VwKHVuc2lnbmVkIGludCBjcHUpCiAgICAgcmV0dXJuIDA7CiB9CiAKK3N0YXRp
YyB2b2lkIHNjaGVkX2ZyZWVfc2NoZWRfcmVzKHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc2QpCit7
CisgICAga2lsbF90aW1lcigmc2QtPnNfdGltZXIpOworICAgIGZyZWVfY3B1bWFza192YXIoc2Qt
PmNwdXMpOworCisgICAgeGZyZWUoc2QpOworfQorCiBzdGF0aWMgdm9pZCBjcHVfc2NoZWR1bGVf
ZG93bih1bnNpZ25lZCBpbnQgY3B1KQogewogICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc2Qg
PSBwZXJfY3B1KHNjaGVkX3JlcywgY3B1KTsKICAgICBzdHJ1Y3Qgc2NoZWR1bGVyICpzY2hlZCA9
IHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpOwogCisgICAgY3B1bWFza19jbGVhcl9jcHUoY3B1LCBz
ZC0+Y3B1cyk7CisgICAgcGVyX2NwdShzY2hlZF9yZXMsIGNwdSkgPSBOVUxMOworCisgICAgaWYg
KCBjcHVtYXNrX3dlaWdodChzZC0+Y3B1cykgKQorICAgICAgICByZXR1cm47CisKICAgICBzY2hl
ZF9mcmVlX3BkYXRhKHNjaGVkLCBzZC0+c2NoZWRfcHJpdiwgY3B1KTsKICAgICBzY2hlZF9mcmVl
X3ZkYXRhKHNjaGVkLCBpZGxlX3ZjcHVbY3B1XS0+c2NoZWRfaXRlbS0+cHJpdik7CiAKICAgICBp
ZGxlX3ZjcHVbY3B1XS0+c2NoZWRfaXRlbS0+cHJpdiA9IE5VTEw7CiAgICAgc2QtPnNjaGVkX3By
aXYgPSBOVUxMOworICAgIGNwdW1hc2tfY2xlYXJfY3B1KGNwdSwgc2NoZWRfcmVzX21hc2spOwog
Ci0gICAga2lsbF90aW1lcigmc2QtPnNfdGltZXIpOwotCi0gICAgeGZyZWUocGVyX2NwdShzY2hl
ZF9yZXMsIGNwdSkpOwotICAgIHBlcl9jcHUoc2NoZWRfcmVzLCBjcHUpID0gTlVMTDsKKyAgICBz
Y2hlZF9mcmVlX3NjaGVkX3JlcyhzZCk7CiB9CiAKIHZvaWQgc2NoZWR1bGVyX3BlcmNwdV9pbml0
KHVuc2lnbmVkIGludCBjcHUpCiB7CiAgICAgc3RydWN0IHNjaGVkdWxlciAqc2NoZWQgPSBwZXJf
Y3B1KHNjaGVkdWxlciwgY3B1KTsKICAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNkID0gcGVy
X2NwdShzY2hlZF9yZXMsIGNwdSk7CisgICAgY29uc3QgY3B1bWFza190ICptYXNrOworICAgIHVu
c2lnbmVkIGludCBtYXN0ZXJfY3B1OworICAgIHNwaW5sb2NrX3QgKmxvY2s7CisgICAgc3RydWN0
IHNjaGVkX2l0ZW0gKm9sZF9pdGVtLCAqbWFzdGVyX2l0ZW07CisKKyAgICBpZiAoIHN5c3RlbV9z
dGF0ZSA9PSBTWVNfU1RBVEVfcmVzdW1lICkKKyAgICAgICAgcmV0dXJuOworCisgICAgc3dpdGNo
ICggb3B0X3NjaGVkX2dyYW51bGFyaXR5ICkKKyAgICB7CisgICAgY2FzZSBTQ0hFRF9HUkFOX2Nw
dToKKyAgICAgICAgbWFzayA9IGNwdW1hc2tfb2YoY3B1KTsKKyAgICAgICAgYnJlYWs7CisgICAg
Y2FzZSBTQ0hFRF9HUkFOX2NvcmU6CisgICAgICAgIG1hc2sgPSBwZXJfY3B1KGNwdV9zaWJsaW5n
X21hc2ssIGNwdSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgU0NIRURfR1JBTl9zb2NrZXQ6
CisgICAgICAgIG1hc2sgPSBwZXJfY3B1KGNwdV9jb3JlX21hc2ssIGNwdSk7CisgICAgICAgIGJy
ZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOworICAgICAg
ICByZXR1cm47CisgICAgfQogCi0gICAgaWYgKCBzeXN0ZW1fc3RhdGUgIT0gU1lTX1NUQVRFX3Jl
c3VtZSApCisgICAgaWYgKCBjcHUgPT0gMCB8fCBjcHVtYXNrX3dlaWdodChtYXNrKSA9PSAxICkK
KyAgICB7CisgICAgICAgIGNwdW1hc2tfc2V0X2NwdShjcHUsIHNjaGVkX3Jlc19tYXNrKTsKICAg
ICAgICAgc2NoZWRfaW5pdF9wZGF0YShzY2hlZCwgc2QtPnNjaGVkX3ByaXYsIGNwdSk7CisgICAg
ICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtYXN0ZXJfY3B1ID0gY3B1bWFza19maXJzdChtYXNr
KTsKKyAgICBtYXN0ZXJfaXRlbSA9IGlkbGVfdmNwdVttYXN0ZXJfY3B1XS0+c2NoZWRfaXRlbTsK
KyAgICBsb2NrID0gcGNwdV9zY2hlZHVsZV9sb2NrKG1hc3Rlcl9jcHUpOworCisgICAgLyogTWVy
Z2UgaWRsZV92Y3B1IGl0ZW0gYW5kIHNjaGVkX3Jlc291cmNlIGludG8gbWFzdGVyIGNwdS4gKi8K
KyAgICBvbGRfaXRlbSA9IGlkbGVfdmNwdVtjcHVdLT5zY2hlZF9pdGVtOworICAgIGlkbGVfdmNw
dVtjcHVdLT5zY2hlZF9pdGVtID0gbWFzdGVyX2l0ZW07CisgICAgcGVyX2NwdShzY2hlZF9yZXMs
IGNwdSkgPSBwZXJfY3B1KHNjaGVkX3JlcywgbWFzdGVyX2NwdSk7CisgICAgcGVyX2NwdShzY2hl
ZF9yZXNfaWR4LCBjcHUpID0gY3B1bWFza193ZWlnaHQocGVyX2NwdShzY2hlZF9yZXMsIGNwdSkt
PmNwdXMpOworICAgIGNwdW1hc2tfc2V0X2NwdShjcHUsIHBlcl9jcHUoc2NoZWRfcmVzLCBjcHUp
LT5jcHVzKTsKKyAgICBtYXN0ZXJfaXRlbS0+cnVuc3RhdGVfY250W1JVTlNUQVRFX3J1bm5pbmdd
ICs9CisgICAgICAgICAgICBvbGRfaXRlbS0+cnVuc3RhdGVfY250W1JVTlNUQVRFX3J1bm5pbmdd
OworICAgIG1hc3Rlcl9pdGVtLT5ydW5zdGF0ZV9jbnRbUlVOU1RBVEVfcnVubmFibGVdICs9Cisg
ICAgICAgICAgICBvbGRfaXRlbS0+cnVuc3RhdGVfY250W1JVTlNUQVRFX3J1bm5hYmxlXTsKKwor
ICAgIHBjcHVfc2NoZWR1bGVfdW5sb2NrKGxvY2ssIG1hc3Rlcl9jcHUpOworCisgICAgc2NoZWRf
ZnJlZV9wZGF0YShzY2hlZCwgc2QtPnNjaGVkX3ByaXYsIGNwdSk7CisgICAgc2NoZWRfZnJlZV92
ZGF0YShzY2hlZCwgb2xkX2l0ZW0tPnByaXYpOworCisgICAgc2NoZWRfZnJlZV9zY2hlZF9yZXMo
c2QpOworICAgIHNjaGVkX2ZyZWVfaXRlbV9tZW0ob2xkX2l0ZW0pOwogfQogCiBzdGF0aWMgaW50
IGNwdV9zY2hlZHVsZV9jYWxsYmFjaygKQEAgLTIyNzMsNiArMjM2Niw1MSBAQCBzdGF0aWMgc3Ry
dWN0IG5vdGlmaWVyX2Jsb2NrIGNwdV9zY2hlZHVsZV9uZmIgPSB7CiAgICAgLm5vdGlmaWVyX2Nh
bGwgPSBjcHVfc2NoZWR1bGVfY2FsbGJhY2sKIH07CiAKK3N0YXRpYyB1bnNpZ25lZCBpbnQgX19p
bml0IHNjaGVkX2NoZWNrX2dyYW51bGFyaXR5KHZvaWQpCit7CisgICAgdW5zaWduZWQgaW50IGNw
dTsKKyAgICB1bnNpZ25lZCBpbnQgc2libGluZ3MsIGdyYW4gPSAwOworCisgICAgZm9yX2VhY2hf
b25saW5lX2NwdSggY3B1ICkKKyAgICB7CisgICAgICAgIHN3aXRjaCAoIG9wdF9zY2hlZF9ncmFu
dWxhcml0eSApCisgICAgICAgIHsKKyAgICAgICAgY2FzZSBTQ0hFRF9HUkFOX2NwdToKKyAgICAg
ICAgICAgIC8qIElmIGdyYW51bGFyaXR5IGlzICJ0aHJlYWQiIHdlIGFyZSBmaW5lIGFscmVhZHku
ICovCisgICAgICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgY2FzZSBTQ0hFRF9HUkFOX2NvcmU6
CisgICAgICAgICAgICBzaWJsaW5ncyA9IGNwdW1hc2tfd2VpZ2h0KHBlcl9jcHUoY3B1X3NpYmxp
bmdfbWFzaywgY3B1KSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBTQ0hFRF9H
UkFOX3NvY2tldDoKKyAgICAgICAgICAgIHNpYmxpbmdzID0gY3B1bWFza193ZWlnaHQocGVyX2Nw
dShjcHVfY29yZV9tYXNrLCBjcHUpKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBkZWZh
dWx0OgorICAgICAgICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CisgICAgICAgICAgICByZXR1
cm4gMDsKKyAgICAgICAgfQorCisgICAgICAgIGlmICggZ3JhbiA9PSAwICkKKyAgICAgICAgICAg
IGdyYW4gPSBzaWJsaW5nczsKKyAgICAgICAgZWxzZSBpZiAoIGdyYW4gIT0gc2libGluZ3MgKQor
ICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgfQorCisgICAgcmV0dXJuIGdyYW47Cit9CisKKy8q
IFNldHVwIGRhdGEgZm9yIHNlbGVjdGVkIHNjaGVkdWxlciBncmFudWxhcml0eS4gKi8KK3ZvaWQg
X19pbml0IHNjaGVkdWxlcl9zbXBfaW5pdCh2b2lkKQoreworICAgIHVuc2lnbmVkIGludCBncmFu
OworCisgICAgZ3JhbiA9IHNjaGVkX2NoZWNrX2dyYW51bGFyaXR5KCk7CisgICAgaWYgKCBncmFu
ID09IDAgKQorICAgICAgICBwYW5pYygiSWxsZWdhbCBjcHUgY29uZmlndXJhdGlvbiBmb3Igc2No
ZWR1bGluZyBncmFudWxhcml0eSFcbiIKKyAgICAgICAgICAgICAgIlBsZWFzZSB1c2UgdGhyZWFk
IHNjaGVkdWxpbmcuXG4iKTsKKworICAgIHNjaGVkX2dyYW51bGFyaXR5ID0gZ3JhbjsKK30KKwog
LyogSW5pdGlhbGlzZSB0aGUgZGF0YSBzdHJ1Y3R1cmVzLiAqLwogdm9pZCBfX2luaXQgc2NoZWR1
bGVyX2luaXQodm9pZCkKIHsKQEAgLTIzMDQsNiArMjQ0Miw5IEBAIHZvaWQgX19pbml0IHNjaGVk
dWxlcl9pbml0KHZvaWQpCiAgICAgICAgIHByaW50aygiVXNpbmcgJyVzJyAoJXMpXG4iLCBvcHMu
bmFtZSwgb3BzLm9wdF9uYW1lKTsKICAgICB9CiAKKyAgICBpZiAoICF6YWxsb2NfY3B1bWFza192
YXIoJnNjaGVkX3Jlc19tYXNrKSApCisgICAgICAgIEJVRygpOworCiAgICAgaWYgKCBjcHVfc2No
ZWR1bGVfdXAoMCkgKQogICAgICAgICBCVUcoKTsKICAgICByZWdpc3Rlcl9jcHVfbm90aWZpZXIo
JmNwdV9zY2hlZHVsZV9uZmIpOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlm
LmggYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaAppbmRleCBmMTZkODFhYjRhLi44NjUyNWRh
NzdiIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaAorKysgYi94ZW4vaW5j
bHVkZS94ZW4vc2NoZWQtaWYuaApAQCAtMjMsNyArMjMsNyBAQCBleHRlcm4gY3B1bWFza190IGNw
dXBvb2xfZnJlZV9jcHVzOwogZXh0ZXJuIGludCBzY2hlZF9yYXRlbGltaXRfdXM7CiAKIC8qIFNj
aGVkdWxpbmcgcmVzb3VyY2UgbWFzay4gKi8KLWV4dGVybiBjb25zdCBjcHVtYXNrX3QgKnNjaGVk
X3Jlc19tYXNrOworZXh0ZXJuIGNwdW1hc2tfdmFyX3Qgc2NoZWRfcmVzX21hc2s7CiAKIC8qCiAg
KiBJbiBvcmRlciB0byBhbGxvdyBhIHNjaGVkdWxlciB0byByZW1hcCB0aGUgbG9jay0+Y3B1IG1h
cHBpbmcsCkBAIC00NSw3ICs0NSw3IEBAIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSB7CiAgICAgc3Ry
dWN0IHRpbWVyICAgICAgICBzX3RpbWVyOyAgICAgICAgLyogc2NoZWR1bGluZyB0aW1lciAgICAg
ICAgICAgICAgICAqLwogICAgIGF0b21pY190ICAgICAgICAgICAgdXJnZW50X2NvdW50OyAgIC8q
IGhvdyBtYW55IHVyZ2VudCB2Y3B1cyAgICAgICAgICAgKi8KICAgICB1bnNpZ25lZCAgICAgICAg
ICAgIHByb2Nlc3NvcjsKLSAgICBjb25zdCBjcHVtYXNrX3QgICAgKmNwdXM7ICAgICAgICAgICAv
KiBjcHVzIGNvdmVyZWQgYnkgdGhpcyBzdHJ1Y3QgICAgICovCisgICAgY3B1bWFza192YXJfdCAg
ICAgICBjcHVzOyAgICAgICAgICAgLyogY3B1cyBjb3ZlcmVkIGJ5IHRoaXMgc3RydWN0ICAgICAq
LwogfTsKIAogI2RlZmluZSBjdXJyX29uX2NwdShjKSAgICAocGVyX2NwdShzY2hlZF9yZXMsIGMp
LT5jdXJyKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmggYi94ZW4vaW5jbHVk
ZS94ZW4vc2NoZWQuaAppbmRleCA1NjI5NjAyZGU1Li4wYzM3YzJiNTVlIDEwMDY0NAotLS0gYS94
ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaApAQCAt
NjgxLDYgKzY4MSw3IEBAIHZvaWQgbm9yZXR1cm4gYXNtX2RvbWFpbl9jcmFzaF9zeW5jaHJvbm91
cyh1bnNpZ25lZCBsb25nIGFkZHIpOwogCiB2b2lkIHNjaGVkdWxlcl9pbml0KHZvaWQpOwogdm9p
ZCBzY2hlZHVsZXJfcGVyY3B1X2luaXQodW5zaWduZWQgaW50IGNwdSk7Cit2b2lkIHNjaGVkdWxl
cl9zbXBfaW5pdCh2b2lkKTsKIGludCAgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2KTsK
IHZvaWQgc2NoZWRfZGVzdHJveV92Y3B1KHN0cnVjdCB2Y3B1ICp2KTsKIGludCAgc2NoZWRfaW5p
dF9kb21haW4oc3RydWN0IGRvbWFpbiAqZCwgaW50IHBvb2xpZCk7Ci0tIAoyLjE2LjQKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

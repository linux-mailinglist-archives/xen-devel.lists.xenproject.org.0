Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B5178ADC3B
	for <lists+xen-devel@lfdr.de>; Mon,  9 Sep 2019 17:38:50 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i7LhU-0007us-Iy; Mon, 09 Sep 2019 15:35:32 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=cFqR=XE=bitdefender.com=aisaila@srs-us1.protection.inumbo.net>)
 id 1i7LhS-0007un-Gg
 for xen-devel@lists.xenproject.org; Mon, 09 Sep 2019 15:35:30 +0000
X-Inumbo-ID: 735ab362-d317-11e9-a337-bc764e2007e4
Received: from EUR04-DB3-obe.outbound.protection.outlook.com (unknown
 [2a01:111:f400:fe0c::722])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 735ab362-d317-11e9-a337-bc764e2007e4;
 Mon, 09 Sep 2019 15:35:29 +0000 (UTC)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=L3CxQkXLEr9vt8Goll/haAs75ChTmlli7x6iWV9qcfidMNnBAw3Ck/G0fJQc7rmQhPDp5S14HYsJVVKRdjxE4o14c765ABol8Gzc3uvyH+asWuNhV6+4RKnepzdVmathsgzfj4D2/5HWi8PBTCCFPiXZqlGNxy+Npy7mKjfY31VXngTh4oc3smPbKSesGO46H2p4r9QUwgQJRoTVH9c41Hthfmd/dQqThFr1+yePS3w2FviqyLraTMoLa6pyM2ctJRfTJkRdcAuVjC+VxDJeSEotxepHflE+Vl65Rjm8SvNLEC+8oYZpQZ2xpaLHhgJ6vcxTJfEIpcHtsyXPzklb+w==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=s4q+STrRu2/wwQ2V0d6JAEdjb/YpEIkiLTyFg4xs81g=;
 b=gdVNuZuTxwIZLBxuw4WACDsYrAop8kbPOSJq5IfgcFR2oO1C7trsuUJ8I7Jzq4ZjlxYury7X6K7YkmUMJAKNY4jC9BwofwC4ANYeQrWEVq1pnRfz8o/gAT/hXX6IC+cje7oAVnS2sXO6GzJ3jTOhoXVnytoK7aedi6o2vfX9t9xilhuHmiwA9UO54teofKO5zDoZp3UVTWe27qAwOZI9ScdDfkrpqwR+lZYVY/NQAxS/md0sz2ROmNZmP97sBDstVYAophyqH0sb7XLo+RVfATXpQLIV3FN/Hy+0oaiVgC2AGnca462p5rt5kzaj3ThCI9ZOkPFgEcd5lSznBFO7gA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=bitdefender.com; dmarc=pass action=none
 header.from=bitdefender.com; dkim=pass header.d=bitdefender.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=bitdefender.onmicrosoft.com; s=selector2-bitdefender-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=s4q+STrRu2/wwQ2V0d6JAEdjb/YpEIkiLTyFg4xs81g=;
 b=XkgUn5uNg4vPpjJofvDncTs9ltKU/i2oM7OFylElBI6IhpgX/y850xdQ7R6RzaD1xAZnh1xwji/+jaW6uJZ9yj7yjB0jQwRNOVky8RlFpPb3R89HieQJ4j2ihPXbzoaHSDd6VXBu+RcXbBD/BSH1n/2DdPDhR9h9cMl83WDqXkI=
Received: from AM7PR02MB5750.eurprd02.prod.outlook.com (10.141.171.8) by
 AM7PR02MB5957.eurprd02.prod.outlook.com (10.141.175.72) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2241.18; Mon, 9 Sep 2019 15:35:26 +0000
Received: from AM7PR02MB5750.eurprd02.prod.outlook.com
 ([fe80::2d9b:67b0:d407:67b8]) by AM7PR02MB5750.eurprd02.prod.outlook.com
 ([fe80::2d9b:67b0:d407:67b8%2]) with mapi id 15.20.2241.018; Mon, 9 Sep 2019
 15:35:26 +0000
From: Alexandru Stefan ISAILA <aisaila@bitdefender.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v9] x86/emulate: Send vm_event from emulate
Thread-Index: AQHVZyQz09ftstBAgkqLCbI9BLbekw==
Date: Mon, 9 Sep 2019 15:35:26 +0000
Message-ID: <20190909153508.10847-1-aisaila@bitdefender.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: PR0P264CA0230.FRAP264.PROD.OUTLOOK.COM
 (2603:10a6:100:1e::26) To AM7PR02MB5750.eurprd02.prod.outlook.com
 (2603:10a6:20b:102::8)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=aisaila@bitdefender.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-mailer: git-send-email 2.17.1
x-originating-ip: [91.199.104.6]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 92be630e-1b44-4d9e-b1e6-08d7353b5649
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600166)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:AM7PR02MB5957; 
x-ms-traffictypediagnostic: AM7PR02MB5957:|AM7PR02MB5957:|AM7PR02MB5957:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <AM7PR02MB5957EC39E1960D72A9A019D9ABB70@AM7PR02MB5957.eurprd02.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:9508;
x-forefront-prvs: 01559F388D
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(136003)(39860400002)(376002)(346002)(396003)(366004)(199004)(189003)(316002)(7736002)(8676002)(50226002)(6116002)(305945005)(81156014)(81166006)(5640700003)(26005)(66946007)(2616005)(476003)(52116002)(54906003)(66446008)(6506007)(256004)(5660300002)(2351001)(386003)(486006)(186003)(8936002)(66476007)(102836004)(2906002)(64756008)(66556008)(478600001)(1076003)(6436002)(6486002)(2501003)(14454004)(25786009)(86362001)(36756003)(3846002)(14444005)(71200400001)(71190400001)(4326008)(53936002)(6512007)(6916009)(99286004)(66066001)(309714004);
 DIR:OUT; SFP:1102; SCL:1; SRVR:AM7PR02MB5957;
 H:AM7PR02MB5750.eurprd02.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: bitdefender.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: Ih1hp5G2JlOhRHidzRmw0GcmlNdIXU0Y7gR1PJldZ6kLngNQAp0Ph4j0V1bfvyjvUcAN9Tch+ic8CmM/sw4ZvblrOjDqZsugz9Yx8+B+i5qmlM3thS96YTVm8Ac15s7rkdonpXXYzs5JGdheDHsANuy0EXo3Ojf6BlBaY0TO55dTX6Z92yAyhcNNz9/At4uFQhGQuMHDx0V5Nntmik0obeZ0SDwIdMmTgJbWcCum0zomv9xqNLxo5+YVpKIIYiqy1mHIoeSTjIB/tzy5IYAoWECeVWLc8ctR4kuKKLc3xqw7EqaDnmmCppaTmbkR7BkcV4QnInx6kUovHLKVaOxFBPjoZPpKtwBU6mKb2TkPX9RNjGzjCt0yMfXxT2FAAhrCAXmxQGl5/CEbPkktkI3L2b8WJNi00/GoxmwsRi04ch4=
MIME-Version: 1.0
X-OriginatorOrg: bitdefender.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 92be630e-1b44-4d9e-b1e6-08d7353b5649
X-MS-Exchange-CrossTenant-originalarrivaltime: 09 Sep 2019 15:35:26.5328 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 487baf29-f1da-469a-9221-243f830c36f3
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: VW5e+TOZozAeF/Zpi2LVYp/+FW4t6FeSZLWGZHy5QbB7+O9/MfGH8+FMNwW7jcrV29F+/QIKbBLcxr6ydfJXOreyWtCDmTqnGwSq4px70/Q=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM7PR02MB5957
Subject: [Xen-devel] [PATCH v9] x86/emulate: Send vm_event from emulate
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Petre Ovidiu PIRCALABU <ppircalabu@bitdefender.com>,
 "tamas@tklengyel.com" <tamas@tklengyel.com>, "wl@xen.org" <wl@xen.org>,
 Razvan COJOCARU <rcojocaru@bitdefender.com>,
 "george.dunlap@eu.citrix.com" <george.dunlap@eu.citrix.com>,
 "andrew.cooper3@citrix.com" <andrew.cooper3@citrix.com>,
 "paul.durrant@citrix.com" <paul.durrant@citrix.com>,
 "jbeulich@suse.com" <jbeulich@suse.com>,
 Alexandru Stefan ISAILA <aisaila@bitdefender.com>,
 "roger.pau@citrix.com" <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QS9EIGJpdCB3cml0ZXMgKG9uIHBhZ2Ugd2Fsa3MpIGNhbiBiZSBjb25zaWRlcmVkIGJlbmlnbiBi
eSBhbiBpbnRyb3NwZWN0aW9uCmFnZW50LCBzbyByZWNlaXZpbmcgdm1fZXZlbnRzIGZvciB0aGVt
IGlzIGEgcGVzc2ltaXphdGlvbi4gV2UgdHJ5IGhlcmUgdG8Kb3B0aW1pemUgYnkgZmlsdGVyaW5n
IHRoZXNlIGV2ZW50cyBvdXQuCkN1cnJlbnRseSwgd2UgYXJlIGZ1bGx5IGVtdWxhdGluZyB0aGUg
aW5zdHJ1Y3Rpb24gYXQgUklQIHdoZW4gdGhlIGhhcmR3YXJlIHNlZXMKYW4gRVBUIGZhdWx0IHdp
dGggbnBmZWMua2luZCAhPSBucGZlY19raW5kX3dpdGhfZ2xhLiBUaGlzIGlzLCBob3dldmVyLApp
bmNvcnJlY3QsIGJlY2F1c2UgdGhlIGluc3RydWN0aW9uIGF0IFJJUCBtaWdodCBsZWdpdGltYXRl
bHkgY2F1c2UgYW4KRVBUIGZhdWx0IG9mIGl0cyBvd24gd2hpbGUgYWNjZXNzaW5nIGEgX2RpZmZl
cmVudF8gcGFnZSBmcm9tIHRoZSBvcmlnaW5hbCBvbmUsCndoZXJlIEEvRCB3ZXJlIHNldC4KVGhl
IHNvbHV0aW9uIGlzIHRvIHBlcmZvcm0gdGhlIHdob2xlIGVtdWxhdGlvbiwgd2hpbGUgaWdub3Jp
bmcgRVBUIHJlc3RyaWN0aW9ucwpmb3IgdGhlIHdhbGsgcGFydCwgYW5kIHRha2luZyB0aGVtIGlu
dG8gYWNjb3VudCBmb3IgdGhlICJhY3R1YWwiIGVtdWxhdGluZyBvZgp0aGUgaW5zdHJ1Y3Rpb24g
YXQgUklQLiBXaGVuIHdlIHNlbmQgb3V0IGEgdm1fZXZlbnQsIHdlIGRvbid0IHdhbnQgdGhlIGVt
dWxhdGlvbgp0byBjb21wbGV0ZSwgc2luY2UgaW4gdGhhdCBjYXNlIHdlIHdvbid0IGJlIGFibGUg
dG8gdmV0byB3aGF0ZXZlciBpdCBpcyBkb2luZy4KVGhhdCB3b3VsZCBtZWFuIHRoYXQgd2UgY2Fu
J3QgYWN0dWFsbHkgcHJldmVudCBhbnkgbWFsaWNpb3VzIGFjdGl2aXR5LCBpbnN0ZWFkCndlJ2Qg
b25seSBiZSBhYmxlIHRvIHJlcG9ydCBvbiBpdC4KV2hlbiB3ZSBzZWUgYSAic2VuZC12bV9ldmVu
dCIgY2FzZSB3aGlsZSBlbXVsYXRpbmcsIHdlIG5lZWQgdG8gZmlyc3Qgc2VuZCB0aGUKZXZlbnQg
b3V0IGFuZCB0aGVuIHN1c3BlbmQgdGhlIGVtdWxhdGlvbiAocmV0dXJuIFg4NkVNVUxfUkVUUlkp
LgpBZnRlciB0aGUgZW11bGF0aW9uIHN0b3BzIHdlJ2xsIGNhbGwgaHZtX3ZtX2V2ZW50X2RvX3Jl
c3VtZSgpIGFnYWluIGFmdGVyIHRoZQppbnRyb3NwZWN0aW9uIGFnZW50IHRyZWF0cyB0aGUgZXZl
bnQgYW5kIHJlc3VtZXMgdGhlIGd1ZXN0LiBUaGVyZSwgdGhlCmluc3RydWN0aW9uIGF0IFJJUCB3
aWxsIGJlIGZ1bGx5IGVtdWxhdGVkICh3aXRoIHRoZSBFUFQgaWdub3JlZCkgaWYgdGhlCmludHJv
c3BlY3Rpb24gYXBwbGljYXRpb24gYWxsb3dzIGl0LCBhbmQgdGhlIGd1ZXN0IHdpbGwgY29udGlu
dWUgdG8gcnVuIHBhc3QKdGhlIGluc3RydWN0aW9uLgoKQSBjb21tb24gZXhhbXBsZSBpcyBpZiB0
aGUgaGFyZHdhcmUgZXhpdHMgYmVjYXVzZSBvZiBhbiBFUFQgZmF1bHQgY2F1c2VkIGJ5IGEKcGFn
ZSB3YWxrLCBwMm1fbWVtX2FjY2Vzc19jaGVjaygpIGRlY2lkZXMgaWYgaXQgaXMgZ29pbmcgdG8g
c2VuZCBhIHZtX2V2ZW50LgpJZiB0aGUgdm1fZXZlbnQgd2FzIHNlbnQgYW5kIGl0IHdvdWxkIGJl
IHRyZWF0ZWQgc28gaXQgcnVucyB0aGUgaW5zdHJ1Y3Rpb24KYXQgUklQLCB0aGF0IGluc3RydWN0
aW9uIG1pZ2h0IGFsc28gaGl0IGEgcHJvdGVjdGVkIHBhZ2UgYW5kIHByb3Zva2UgYSB2bV9ldmVu
dC4KCk5vdyBpZiBucGZlYy5raW5kID09IG5wZmVjX2tpbmRfaW5fZ3B0IGFuZCBkLT5hcmNoLm1v
bml0b3IuaW5ndWVzdF9wYWdlZmF1bHRfZGlzYWJsZWQKaXMgdHJ1ZSB0aGVuIHdlIGFyZSBpbiB0
aGUgcGFnZSB3YWxrIGNhc2UgYW5kIHdlIGNhbiBkbyB0aGlzIGVtdWxhdGlvbiBvcHRpbWl6YXRp
b24KYW5kIGVtdWxhdGUgdGhlIHBhZ2Ugd2FsayB3aGlsZSBpZ25vcmluZyB0aGUgRVBULCBidXQg
ZG9uJ3QgaWdub3JlIHRoZSBFUFQgZm9yIHRoZQplbXVsYXRpb24gb2YgdGhlIGFjdHVhbCBpbnN0
cnVjdGlvbi4KCkluIHRoZSBmaXJzdCBjYXNlIHdlIHdvdWxkIGhhdmUgMiBFUFQgZXZlbnRzLCBp
biB0aGUgc2Vjb25kIGNhc2Ugd2Ugd291bGQgaGF2ZQoxIEVQVCBldmVudCBpZiB0aGUgaW5zdHJ1
Y3Rpb24gYXQgdGhlIFJJUCB0cmlnZ2VycyBhbiBFUFQgZXZlbnQuCgpXZSB1c2UgaHZtZW11bF9t
YXBfbGluZWFyX2FkZHIoKSB0byBpbnRlcmNlcHQgci93IGFjY2VzcyBhbmQKX19odm1fY29weSgp
IHRvIGludGVyY2VwdCBleGVjIGFjY2Vzcy4KCmh2bV9lbXVsYXRlX3NlbmRfdm1fZXZlbnQoKSBj
YW4gcmV0dXJuIGZhbHNlIGlmIHRoZXJlIHdhcyBubyB2aW9sYXRpb24sCmlmIHRoZXJlIHdhcyBh
biBlcnJvciBmcm9tIG1vbml0b3JfdHJhcHMoKSBvciBwMm1fZ2V0X21lbV9hY2Nlc3MoKS4KUmV0
dXJuaW5nIGZhbHNlIGlmIHAybV9nZXRfbWVtX2FjY2VzcygpIGZhaWxzIGlzIG5lZWRlZCBiZWNh
dXNlIHRoZSBFUFQKZW50cnkgd2lsbCBoYXZlIHJ3eCBtZW1vcnkgYWNjZXNzIHJpZ2h0cy4KCk5P
VEU6IGh2bV9lbXVsYXRlX3NlbmRfdm1fZXZlbnQoKSBhc3N1bWVzIHRoZSBjYWxsZXIgd2lsbCBj
aGVjawphcmNoLnZtX2V2ZW50LT5zZW5kX2V2ZW50CgpTaWduZWQtb2ZmLWJ5OiBBbGV4YW5kcnUg
SXNhaWxhIDxhaXNhaWxhQGJpdGRlZmVuZGVyLmNvbT4KCi0tLQpDaGFuZ2VzIHNpbmNlIFY4OgoJ
LSBSZXBsYWNlIG5wZmVjLmtpbmQgIT0gbnBmZWNfa2luZF93aXRoX2dsYSB3aXRoCm5wZmVjLmtp
bmQgPT0gbnBmZWNfa2luZF9pbl9ncHQKCS0gVXBkYXRlIGNvbW1pdCBtZXNzYWdlCgktIEFkZCB1
bmxpa2VseShjdXJyLT5hcmNoLnZtX2V2ZW50KQoJLSBNb3ZlIGdvdG8gb3V0IGluIHRoZSBsb29w
IGluIGh2bWVtdWxfbWFwX2xpbmVhcl9hZGRyKCkKCS0gUmVuYW1lIGh2bV9lbXVsYXRlX3NlbmRf
dm1fZXZlbnQoKSB0byBodm1fbW9uaXRvcl9jaGVja19lcHQoKQphbmQgbW92ZSBpdCB0byBodm0v
bW9uaXRvci5jCi0tLQogeGVuL2FyY2gveDg2L2h2bS9lbXVsYXRlLmMgICAgICAgIHwgMTcgKysr
Ky0tLQogeGVuL2FyY2gveDg2L2h2bS9odm0uYyAgICAgICAgICAgIHwgIDggKysrKwogeGVuL2Fy
Y2gveDg2L2h2bS9tb25pdG9yLmMgICAgICAgIHwgNzUgKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKwogeGVuL2FyY2gveDg2L21tL21lbV9hY2Nlc3MuYyAgICAgIHwgIDMgKy0KIHhlbi9p
bmNsdWRlL2FzbS14ODYvaHZtL21vbml0b3IuaCB8ICAzICsrCiB4ZW4vaW5jbHVkZS9hc20teDg2
L3ZtX2V2ZW50LmggICAgfCAgMiArCiA2IGZpbGVzIGNoYW5nZWQsIDEwMSBpbnNlcnRpb25zKCsp
LCA3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vZW11bGF0ZS5j
IGIveGVuL2FyY2gveDg2L2h2bS9lbXVsYXRlLmMKaW5kZXggZTRiM2YzMzBhOC4uZGNiZGRiOTI1
ZiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2bS9lbXVsYXRlLmMKKysrIGIveGVuL2FyY2gv
eDg2L2h2bS9lbXVsYXRlLmMKQEAgLTU0NCwxMCArNTQ0LDExIEBAIHN0YXRpYyB2b2lkICpodm1l
bXVsX21hcF9saW5lYXJfYWRkcigKICAgICBzdHJ1Y3QgaHZtX2VtdWxhdGVfY3R4dCAqaHZtZW11
bF9jdHh0KQogewogICAgIHN0cnVjdCB2Y3B1ICpjdXJyID0gY3VycmVudDsKLSAgICB2b2lkICpl
cnIsICptYXBwaW5nOworICAgIHZvaWQgKmVyciA9IE5VTEwsICptYXBwaW5nOwogICAgIHVuc2ln
bmVkIGludCBucl9mcmFtZXMgPSAoKGxpbmVhciArIGJ5dGVzIC0gISFieXRlcykgPj4gUEFHRV9T
SElGVCkgLQogICAgICAgICAobGluZWFyID4+IFBBR0VfU0hJRlQpICsgMTsKICAgICB1bnNpZ25l
ZCBpbnQgaTsKKyAgICBnZm5fdCBnZm47CiAKICAgICAvKgogICAgICAqIG1mbiBwb2ludHMgdG8g
dGhlIG5leHQgZnJlZSBzbG90LiAgQWxsIHVzZWQgc2xvdHMgaGF2ZSBhIHBhZ2UgcmVmZXJlbmNl
CkBAIC01ODIsNyArNTgzLDcgQEAgc3RhdGljIHZvaWQgKmh2bWVtdWxfbWFwX2xpbmVhcl9hZGRy
KAogICAgICAgICBBU1NFUlQobWZuX3goKm1mbikgPT0gMCk7CiAKICAgICAgICAgcmVzID0gaHZt
X3RyYW5zbGF0ZV9nZXRfcGFnZShjdXJyLCBhZGRyLCB0cnVlLCBwZmVjLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZwZmluZm8sICZwYWdlLCBOVUxMLCAmcDJtdCk7Cisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnBmaW5mbywgJnBhZ2UsICZnZm4s
ICZwMm10KTsKIAogICAgICAgICBzd2l0Y2ggKCByZXMgKQogICAgICAgICB7CkBAIC01OTYsNyAr
NTk3LDYgQEAgc3RhdGljIHZvaWQgKmh2bWVtdWxfbWFwX2xpbmVhcl9hZGRyKAogICAgICAgICAg
ICAgZ290byBvdXQ7CiAKICAgICAgICAgY2FzZSBIVk1UUkFOU19iYWRfZ2ZuX3RvX21mbjoKLSAg
ICAgICAgICAgIGVyciA9IE5VTEw7CiAgICAgICAgICAgICBnb3RvIG91dDsKIAogICAgICAgICBj
YXNlIEhWTVRSQU5TX2dmbl9wYWdlZF9vdXQ6CkBAIC02MTksMTMgKzYxOSwxOCBAQCBzdGF0aWMg
dm9pZCAqaHZtZW11bF9tYXBfbGluZWFyX2FkZHIoCiAgICAgICAgICAgICB9CiAKICAgICAgICAg
ICAgIGlmICggcDJtdCA9PSBwMm1faW9yZXFfc2VydmVyICkKLSAgICAgICAgICAgIHsKLSAgICAg
ICAgICAgICAgICBlcnIgPSBOVUxMOwogICAgICAgICAgICAgICAgIGdvdG8gb3V0OwotICAgICAg
ICAgICAgfQogCiAgICAgICAgICAgICBBU1NFUlQocDJtdCA9PSBwMm1fcmFtX2xvZ2RpcnR5IHx8
ICFwMm1faXNfcmVhZG9ubHkocDJtdCkpOwogICAgICAgICB9CisKKyAgICAgICAgaWYgKCB1bmxp
a2VseShjdXJyLT5hcmNoLnZtX2V2ZW50KSAmJgorICAgICAgICAgICAgIGN1cnItPmFyY2gudm1f
ZXZlbnQtPnNlbmRfZXZlbnQgJiYKKyAgICAgICAgICAgICBodm1fbW9uaXRvcl9jaGVja19lcHQo
YWRkciwgZ2ZuLCBwZmVjLCBucGZlY19raW5kX3dpdGhfZ2xhKSApCisgICAgICAgIHsKKyAgICAg
ICAgICAgIGVyciA9IEVSUl9QVFIoflg4NkVNVUxfUkVUUlkpOworICAgICAgICAgICAgZ290byBv
dXQ7CisgICAgICAgIH0KICAgICB9CiAKICAgICAvKiBFbnRpcmUgYWNjZXNzIHdpdGhpbiBhIHNp
bmdsZSBmcmFtZT8gKi8KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMgYi94ZW4v
YXJjaC94ODYvaHZtL2h2bS5jCmluZGV4IDJiODE4OTk0NmIuLmM4NTliYmU5Y2YgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9odm0uYwpA
QCAtMzIyNCw2ICszMjI0LDE0IEBAIHN0YXRpYyBlbnVtIGh2bV90cmFuc2xhdGlvbl9yZXN1bHQg
X19odm1fY29weSgKICAgICAgICAgICAgIHJldHVybiBIVk1UUkFOU19iYWRfZ2ZuX3RvX21mbjsK
ICAgICAgICAgfQogCisgICAgICAgIGlmICggdW5saWtlbHkodi0+YXJjaC52bV9ldmVudCkgJiYK
KyAgICAgICAgICAgICB2LT5hcmNoLnZtX2V2ZW50LT5zZW5kX2V2ZW50ICYmCisgICAgICAgICAg
ICAgaHZtX21vbml0b3JfY2hlY2tfZXB0KGFkZHIsIGdmbiwgcGZlYywgbnBmZWNfa2luZF93aXRo
X2dsYSkgKQorICAgICAgICB7CisgICAgICAgICAgICBwdXRfcGFnZShwYWdlKTsKKyAgICAgICAg
ICAgIHJldHVybiBIVk1UUkFOU19nZm5fcGFnZWRfb3V0OworICAgICAgICB9CisKICAgICAgICAg
cCA9IChjaGFyICopX19tYXBfZG9tYWluX3BhZ2UocGFnZSkgKyAoYWRkciAmIH5QQUdFX01BU0sp
OwogCiAgICAgICAgIGlmICggZmxhZ3MgJiBIVk1DT1BZX3RvX2d1ZXN0ICkKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL3g4Ni9odm0vbW9uaXRvci5jIGIveGVuL2FyY2gveDg2L2h2bS9tb25pdG9yLmMK
aW5kZXggMmE0MWNjYzkzMC4uMTA3MWYxYzdhOSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2h2
bS9tb25pdG9yLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9tb25pdG9yLmMKQEAgLTIzLDggKzIz
LDEwIEBACiAgKi8KIAogI2luY2x1ZGUgPHhlbi92bV9ldmVudC5oPgorI2luY2x1ZGUgPHhlbi9t
ZW1fYWNjZXNzLmg+CiAjaW5jbHVkZSA8eGVuL21vbml0b3IuaD4KICNpbmNsdWRlIDxhc20vaHZt
L21vbml0b3IuaD4KKyNpbmNsdWRlIDxhc20vYWx0cDJtLmg+CiAjaW5jbHVkZSA8YXNtL21vbml0
b3IuaD4KICNpbmNsdWRlIDxhc20vcGFnaW5nLmg+CiAjaW5jbHVkZSA8YXNtL3ZtX2V2ZW50Lmg+
CkBAIC0yMTUsNiArMjE3LDc5IEBAIHZvaWQgaHZtX21vbml0b3JfaW50ZXJydXB0KHVuc2lnbmVk
IGludCB2ZWN0b3IsIHVuc2lnbmVkIGludCB0eXBlLAogICAgIG1vbml0b3JfdHJhcHMoY3VycmVu
dCwgMSwgJnJlcSk7CiB9CiAKKy8qCisgKiBTZW5kIG1lbW9yeSBhY2Nlc3Mgdm1fZXZlbnRzIGJh
c2VkIG9uIHBmZWMuIFJldHVybnMgdHJ1ZSBpZiB0aGUgZXZlbnQgd2FzCisgKiBzZW50IGFuZCBm
YWxzZSBmb3IgcDJtX2dldF9tZW1fYWNjZXNzKCkgZXJyb3IsIG5vIHZpb2xhdGlvbiBhbmQgZXZl
bnQgc2VuZAorICogZXJyb3IuIEFzc3VtZXMgdGhlIGNhbGxlciB3aWxsIGNoZWNrIGFyY2gudm1f
ZXZlbnQtPnNlbmRfZXZlbnQuCisgKgorICogTk9URTogcDJtX2dldF9tZW1fYWNjZXNzKCkgY2Fu
IGZhaWwgaWYgdGhlIGVudHJ5IHdhcyBub3QgZm91bmQgaW4gdGhlIEVQVAorICogKGluIHdoaWNo
IGNhc2UgYWNjZXNzIHRvIGl0IGlzIHVucmVzdHJpY3RlZCwgc28gbm8gdmlvbGF0aW9ucyBjYW4g
b2NjdXIpLgorICogSW4gdGhpcyBjYXNlcyBpdCBpcyBmaW5lIHRvIGNvbnRpbnVlIHRoZSBlbXVs
YXRpb24uCisgKi8KK2Jvb2wgaHZtX21vbml0b3JfY2hlY2tfZXB0KHVuc2lnbmVkIGxvbmcgZ2xh
LCBnZm5fdCBnZm4sIHVpbnQzMl90IHBmZWMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICB1
aW50MTZfdCBraW5kKQoreworICAgIHhlbm1lbV9hY2Nlc3NfdCBhY2Nlc3M7CisgICAgdm1fZXZl
bnRfcmVxdWVzdF90IHJlcSA9IHt9OworICAgIHBhZGRyX3QgZ3BhID0gKGdmbl90b19nYWRkcihn
Zm4pIHwgKGdsYSAmIH5QQUdFX01BU0spKTsKKworICAgIEFTU0VSVChjdXJyZW50LT5hcmNoLnZt
X2V2ZW50LT5zZW5kX2V2ZW50KTsKKworICAgIGN1cnJlbnQtPmFyY2gudm1fZXZlbnQtPnNlbmRf
ZXZlbnQgPSBmYWxzZTsKKworICAgIGlmICggcDJtX2dldF9tZW1fYWNjZXNzKGN1cnJlbnQtPmRv
bWFpbiwgZ2ZuLCAmYWNjZXNzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsdHAybV92
Y3B1X2lkeChjdXJyZW50KSkgIT0gMCApCisgICAgICAgIHJldHVybiBmYWxzZTsKKworICAgIHN3
aXRjaCAoIGFjY2VzcyApCisgICAgeworICAgIGNhc2UgWEVOTUVNX2FjY2Vzc194OgorICAgIGNh
c2UgWEVOTUVNX2FjY2Vzc19yeDoKKyAgICAgICAgaWYgKCBwZmVjICYgUEZFQ193cml0ZV9hY2Nl
c3MgKQorICAgICAgICAgICAgcmVxLnUubWVtX2FjY2Vzcy5mbGFncyA9IE1FTV9BQ0NFU1NfUiB8
IE1FTV9BQ0NFU1NfVzsKKyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNlIFhFTk1FTV9hY2Nlc3Nf
dzoKKyAgICBjYXNlIFhFTk1FTV9hY2Nlc3Nfcnc6CisgICAgICAgIGlmICggcGZlYyAmIFBGRUNf
aW5zbl9mZXRjaCApCisgICAgICAgICAgICByZXEudS5tZW1fYWNjZXNzLmZsYWdzID0gTUVNX0FD
Q0VTU19YOworICAgICAgICBicmVhazsKKworICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19yOgorICAg
IGNhc2UgWEVOTUVNX2FjY2Vzc19uOgorICAgICAgICBpZiAoIHBmZWMgJiBQRkVDX3dyaXRlX2Fj
Y2VzcyApCisgICAgICAgICAgICByZXEudS5tZW1fYWNjZXNzLmZsYWdzIHw9IE1FTV9BQ0NFU1Nf
UiB8IE1FTV9BQ0NFU1NfVzsKKyAgICAgICAgaWYgKCBwZmVjICYgUEZFQ19pbnNuX2ZldGNoICkK
KyAgICAgICAgICAgIHJlcS51Lm1lbV9hY2Nlc3MuZmxhZ3MgfD0gTUVNX0FDQ0VTU19YOworICAg
ICAgICBicmVhazsKKworICAgIGNhc2UgWEVOTUVNX2FjY2Vzc193eDoKKyAgICBjYXNlIFhFTk1F
TV9hY2Nlc3Nfcnd4OgorICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19yeDJydzoKKyAgICBjYXNlIFhF
Tk1FTV9hY2Nlc3NfbjJyd3g6CisgICAgY2FzZSBYRU5NRU1fYWNjZXNzX2RlZmF1bHQ6CisgICAg
ICAgIGJyZWFrOworICAgIH0KKworICAgIGlmICggIXJlcS51Lm1lbV9hY2Nlc3MuZmxhZ3MgKQor
ICAgICAgICByZXR1cm4gZmFsc2U7IC8qIG5vIHZpb2xhdGlvbiAqLworCisgICAgaWYgKCBraW5k
ID09IG5wZmVjX2tpbmRfd2l0aF9nbGEgKQorICAgICAgICByZXEudS5tZW1fYWNjZXNzLmZsYWdz
IHw9IE1FTV9BQ0NFU1NfRkFVTFRfV0lUSF9HTEEgfAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE1FTV9BQ0NFU1NfR0xBX1ZBTElEOworICAgIGVsc2UgaWYgKCBraW5kID09IG5w
ZmVjX2tpbmRfaW5fZ3B0ICkKKyAgICAgICAgcmVxLnUubWVtX2FjY2Vzcy5mbGFncyB8PSBNRU1f
QUNDRVNTX0ZBVUxUX0lOX0dQVCB8CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
TUVNX0FDQ0VTU19HTEFfVkFMSUQ7CisKKworICAgIHJlcS5yZWFzb24gPSBWTV9FVkVOVF9SRUFT
T05fTUVNX0FDQ0VTUzsKKyAgICByZXEudS5tZW1fYWNjZXNzLmdmbiA9IGdmbl94KGdmbik7Cisg
ICAgcmVxLnUubWVtX2FjY2Vzcy5nbGEgPSBnbGE7CisgICAgcmVxLnUubWVtX2FjY2Vzcy5vZmZz
ZXQgPSBncGEgJiB+UEFHRV9NQVNLOworCisgICAgcmV0dXJuIG1vbml0b3JfdHJhcHMoY3VycmVu
dCwgdHJ1ZSwgJnJlcSkgPj0gMDsKK30KKwogLyoKICAqIExvY2FsIHZhcmlhYmxlczoKICAqIG1v
ZGU6IEMKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9tbS9tZW1fYWNjZXNzLmMgYi94ZW4vYXJj
aC94ODYvbW0vbWVtX2FjY2Vzcy5jCmluZGV4IDAxNDRmOTJiOTguLmMxZTIxNDAyYTYgMTAwNjQ0
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9tZW1fYWNjZXNzLmMKKysrIGIveGVuL2FyY2gveDg2L21t
L21lbV9hY2Nlc3MuYwpAQCAtMjEyLDggKzIxMiw5IEBAIGJvb2wgcDJtX21lbV9hY2Nlc3NfY2hl
Y2socGFkZHJfdCBncGEsIHVuc2lnbmVkIGxvbmcgZ2xhLAogICAgIH0KICAgICBpZiAoIHZtX2V2
ZW50X2NoZWNrX3JpbmcoZC0+dm1fZXZlbnRfbW9uaXRvcikgJiYKICAgICAgICAgIGQtPmFyY2gu
bW9uaXRvci5pbmd1ZXN0X3BhZ2VmYXVsdF9kaXNhYmxlZCAmJgotICAgICAgICAgbnBmZWMua2lu
ZCAhPSBucGZlY19raW5kX3dpdGhfZ2xhICkgLyogZG9uJ3Qgc2VuZCBhIG1lbV9ldmVudCAqLwor
ICAgICAgICAgbnBmZWMua2luZCA9PSBucGZlY19raW5kX2luX2dwdCApIC8qIGRvbid0IHNlbmQg
YSBtZW1fZXZlbnQgKi8KICAgICB7CisgICAgICAgIHYtPmFyY2gudm1fZXZlbnQtPnNlbmRfZXZl
bnQgPSB0cnVlOwogICAgICAgICBodm1fZW11bGF0ZV9vbmVfdm1fZXZlbnQoRU1VTF9LSU5EX05P
Uk1BTCwgVFJBUF9pbnZhbGlkX29wLCBYODZfRVZFTlRfTk9fRUMpOwogCiAgICAgICAgIHJldHVy
biB0cnVlOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vbW9uaXRvci5oIGIv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vbW9uaXRvci5oCmluZGV4IGYxYWY0ZjgxMmEuLjNkZDQ5
MDZmNjcgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL21vbml0b3IuaAorKysg
Yi94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9tb25pdG9yLmgKQEAgLTQ5LDYgKzQ5LDkgQEAgdm9p
ZCBodm1fbW9uaXRvcl9pbnRlcnJ1cHQodW5zaWduZWQgaW50IHZlY3RvciwgdW5zaWduZWQgaW50
IHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZXJyLCB1aW50
NjRfdCBjcjIpOwogYm9vbCBodm1fbW9uaXRvcl9lbXVsX3VuaW1wbGVtZW50ZWQodm9pZCk7CiAK
K2Jvb2wgaHZtX21vbml0b3JfY2hlY2tfZXB0KHVuc2lnbmVkIGxvbmcgZ2xhLCBnZm5fdCBnZm4s
IHVpbnQzMl90IHBmZWMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MTZfdCBraW5k
KTsKKwogI2VuZGlmIC8qIF9fQVNNX1g4Nl9IVk1fTU9OSVRPUl9IX18gKi8KIAogLyoKZGlmZiAt
LWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvdm1fZXZlbnQuaCBiL3hlbi9pbmNsdWRlL2FzbS14
ODYvdm1fZXZlbnQuaAppbmRleCAyM2U2NTU3MTBiLi42NmRiOWUxZTI1IDEwMDY0NAotLS0gYS94
ZW4vaW5jbHVkZS9hc20teDg2L3ZtX2V2ZW50LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni92
bV9ldmVudC5oCkBAIC0zNiw2ICszNiw4IEBAIHN0cnVjdCBhcmNoX3ZtX2V2ZW50IHsKICAgICBi
b29sIHNldF9ncHJzOwogICAgIC8qIEEgc3luYyB2bV9ldmVudCBoYXMgYmVlbiBzZW50IGFuZCB3
ZSdyZSBub3QgZG9uZSBoYW5kbGluZyBpdC4gKi8KICAgICBib29sIHN5bmNfZXZlbnQ7CisgICAg
LyogU2VuZCBtZW0gYWNjZXNzIGV2ZW50cyBmcm9tIGVtdWxhdG9yICovCisgICAgYm9vbCBzZW5k
X2V2ZW50OwogfTsKIAogaW50IHZtX2V2ZW50X2luaXRfZG9tYWluKHN0cnVjdCBkb21haW4gKmQp
OwotLSAKMi4xNy4xCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5v
cmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZl
bA==

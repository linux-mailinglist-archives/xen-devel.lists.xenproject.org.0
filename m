Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id DFA8245A247
	for <lists+xen-devel@lfdr.de>; Tue, 23 Nov 2021 13:12:56 +0100 (CET)
Received: from list by lists.xenproject.org with outflank-mailman.229255.396866 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1mpUf9-0003nk-U3; Tue, 23 Nov 2021 12:12:39 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 229255.396866; Tue, 23 Nov 2021 12:12:39 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1mpUf8-0003U6-Vv; Tue, 23 Nov 2021 12:12:38 +0000
Received: by outflank-mailman (input) for mailman id 229255;
 Tue, 23 Nov 2021 12:12:32 +0000
Received: from se1-gles-sth1-in.inumbo.com ([159.253.27.254]
 helo=se1-gles-sth1.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=ayLh=QK=xenbits.xen.org=iwj@srs-se1.protection.inumbo.net>)
 id 1mpUf2-0008EP-1k
 for xen-devel@lists.xen.org; Tue, 23 Nov 2021 12:12:32 +0000
Received: from mail.xenproject.org (mail.xenproject.org [104.130.215.37])
 by se1-gles-sth1.inumbo.com (Halon) with ESMTPS
 id 7a09bd5b-4c56-11ec-9787-a32c541c8605;
 Tue, 23 Nov 2021 13:12:16 +0100 (CET)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1mpUdl-0002Sy-C8; Tue, 23 Nov 2021 12:11:13 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1mpUdl-0004Ug-Aw; Tue, 23 Nov 2021 12:11:13 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: 7a09bd5b-4c56-11ec-9787-a32c541c8605
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=+XbWv5c1idsAXWtJad7tat3++/kYkbLaYNOJLiB0hIw=; b=42DXLkRR/6tow4p9o2YbQ1xF1j
	QmO9D4p5qRQltZDmt3TIXnkviLI1qCkRoYvPLWVdvy9kQ1j+N6pSuYk6BiStISiBhV6oJVXxN4RNq
	ecA4qLm5WthT+LRtZSOq9rOHlcs+LntXiFLxodjnaqkw4SEe5xCv/I3iMa2iqMB3zVog=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 388 v3 (CVE-2021-28704,CVE-2021-28707,CVE-2021-28708)
 - PoD operations on misaligned GFNs
Message-Id: <E1mpUdl-0004Ug-Aw@xenbits.xenproject.org>
Date: Tue, 23 Nov 2021 12:11:13 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

 Xen Security Advisory CVE-2021-28704,CVE-2021-28707,CVE-2021-28708 / XSA-388
                                   version 3

                   PoD operations on misaligned GFNs

UPDATES IN VERSION 3
====================

Correct affected versions range.

Add CVE numbers to patches.

Public release.

ISSUE DESCRIPTION
=================

x86 HVM and PVH guests may be started in populate-on-demand (PoD) mode,
to provide a way for them to later easily have more memory assigned.

Guests are permitted to control certain P2M aspects of individual
pages via hypercalls.  These hypercalls may act on ranges of pages
specified via page orders (resulting in a power-of-2 number of pages).
The implementation of some of these hypercalls for PoD does not
enforce the base page frame number to be suitably aligned for the
specified order, yet some code involved in PoD handling actually makes
such an assumption.

These operations are XENMEM_decrease_reservation (CVE-2021-28704) and
XENMEM_populate_physmap (CVE-2021-28707), the latter usable only by
domains controlling the guest, i.e. a de-privileged qemu or a stub
domain.  (Patch 1, combining the fix to both these two issues.)

In addition handling of XENMEM_decrease_reservation can also trigger a
host crash when the specified page order is neither 4k nor 2M nor 1G
(CVE-2021-28708, patch 2).

IMPACT
======

Malicious or buggy guest kernels may be able to mount a Denial of
Service (DoS) attack affecting the entire system.  Privilege escalation
and information leaks cannot be ruled out.

VULNERABLE SYSTEMS
==================

All Xen versions from 4.7 onwards are affected.  Xen versions 4.6 and
older are not affected.

Only x86 HVM and PVH guests started in populate-on-demand mode can
leverage the vulnerability.  Populate-on-demand mode is activated
when the guest's xl configuration file specifies a "maxmem" value which
is larger than the "memory" value.

MITIGATION
==========

Not starting x86 HVM or PVH guests in populate-on-demand mode will avoid
the vulnerability.

CREDITS
=======

This issue was discovered by Jan Beulich of SUSE.

RESOLUTION
==========

Applying the appropriate pair if attached patches resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa388-?.patch           xen-unstable
xsa388-4.15-?.patch      Xen 4.15.x
xsa388-4.14-?.patch      Xen 4.14.x - 4.12.x

$ sha256sum xsa388*
43f6647e9f7d28d22eeb98680e116b301b0e29ef63ea65c9839a5aaebd449bc4  xsa388-1.patch
64b27a8c7c02036528e00a3070e27e873762d68f4ea1504e906aaf2ddc1c06be  xsa388-2.patch
6917267482101a3f8f1d13905e14994344a0af81370c7a2b92275fb176b321a0  xsa388-4.14-1.patch
d5886e046c69f34f98f7e1fc6ffcc36d92f8fc79242b9dc88412c39aa79b4ac3  xsa388-4.14-2.patch
fbe6af409447edc2318940d7c4bc0861a236d40db037166608fc09fa57ef54b1  xsa388-4.15-1.patch
c828d735aaa3f430ccef314bf27519cd6a5f4daaa79e1c493dc47e42ab09ec9f  xsa388-4.15-2.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches described above (or others which are
substantially similar) is permitted during the embargo, even on public-
facing systems with untrusted guest users and administrators.

HOWEVER, deployment of the mitigation described above is NOT permitted
during the embargo on public-facing systems with untrusted guest users
and administrators.  This is because such a configuration change is
recognizable by the affected guests.

AND: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmGc2jkMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZROMIALJsptV0nV8H5/nCLUWld3mKjAeb/+N20ul9NEwn
rUwIGGGzyrKZQdAljno+9y9o5pM8+BC+aTBwYhmxEWsHm1kodTD+YnJYf8uNW/CW
uhTJp/ZB5EsWhTFHF7YoKbPG0on4KIsy0TgoUug7bv+l2zEny9gfknsj8jdp3qCy
aFv1Bb2PzRh462qVHI3f27Ee8bn7GfErouuLppmDpCva19D3bhUXQ5PhxFB+oqsI
bww4VKUo0nxZftYhpbInWm34dajEIXK7jy5Z/CUPgCj2sTOHHBv7+5JJdw0umn/A
lJ2Ta1u03sdC9JWbat4qjvdVgK9L9vT+jWsfcwk02qq+XSU=
=uSRt
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa388-1.patch"
Content-Disposition: attachment; filename="xsa388-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUG9EOiBkZWFsIHdpdGggbWlzYWxpZ25lZCBHRk5zCgpVc2VycyBv
ZiBYRU5NRU1fZGVjcmVhc2VfcmVzZXJ2YXRpb24gYW5kIFhFTk1FTV9wb3B1
bGF0ZV9waHlzbWFwIGFyZW4ndApyZXF1aXJlZCB0byBwYXNzIGluIG9yZGVy
LWFsaWduZWQgR0ZOIHZhbHVlcy4gKFdoaWxlIEkgY29uc2lkZXIgdGhpcwpi
b2d1cywgSSBkb24ndCB0aGluayB3ZSBjYW4gZml4IHRoaXMgdGhlcmUsIGFz
IHRoYXQgbWlnaHQgYnJlYWsgZXhpc3RpbmcKY29kZSwgZS5nIExpbnV4J2Vz
IHN3aW90bGIsIHdoaWNoIC0gd2hpbGUgYWZmZWN0aW5nIFBWIG9ubHkgLSB1
bnRpbApyZWNlbnRseSBoYWQgYmVlbiBlbmZvcmNpbmcgb25seSBwYWdlIGFs
aWdubWVudCBvbiB0aGUgb3JpZ2luYWwKYWxsb2NhdGlvbi4pIE9ubHkgbm9u
LVBvRCBjb2RlIHBhdGhzIChndWVzdF9waHlzbWFwX3thZGQscmVtb3ZlfV9w
YWdlKCksCnAybV9zZXRfZW50cnkoKSkgbG9vayB0byBiZSBkZWFsaW5nIHdp
dGggdGhpcyBwcm9wZXJseSAoaW4gcGFydCBieSBiZWluZwppbXBsZW1lbnRl
ZCBpbmVmZmljaWVudGx5LCBoYW5kbGluZyBldmVyeSA0ayBwYWdlIHNlcGFy
YXRlbHkpLgoKSW50cm9kdWNlIHdyYXBwZXJzIHRha2luZyBjYXJlIG9mIHNw
bGl0dGluZyB0aGUgaW5jb21pbmcgcmVxdWVzdCBpbnRvCmFsaWduZWQgY2h1
bmtzLCB3aXRob3V0IHB1dHRpbmcgbXVjaCBlZmZvcnQgaW4gdHJ5aW5nIHRv
IGRldGVybWluZSB0aGUKbGFyZ2VzdCBwb3NzaWJsZSBjaHVuayBhdCBldmVy
eSBpdGVyYXRpb24uCgpBbHNvICJoYW5kbGUiIHAybV9zZXRfZW50cnkoKSBm
YWlsdXJlIGZvciBub24tb3JkZXItMCByZXF1ZXN0cyBieQpjcmFzaGluZyB0
aGUgZG9tYWluIGluIG9uZSBtb3JlIHBsYWNlLiBBbG9uZ3NpZGUgcHV0dGlu
ZyBhIGxvZyBtZXNzYWdlCnRoZXJlLCBhbHNvIGFkZCBvbmUgdG8gdGhlIG90
aGVyIHNpbWlsYXIgcGF0aC4KCk5vdGUgcmVnYXJkaW5nIGxvY2tpbmc6IFRo
aXMgaXMgbGVmdCBpbiB0aGUgYWN0dWFsIHdvcmtlciBmdW5jdGlvbnMgb24K
dGhlIGFzc3VtcHRpb24gdGhhdCBjYWxsZXJzIGFyZW4ndCBndWFyYW50ZWVk
IGF0b21pY2l0eSB3cnQgYWN0aW5nIG9uCm11bHRpcGxlIHBhZ2VzIGF0IGEg
dGltZS4gRm9yIG1pcy1hbGlnbmVkIEdGTnMgZ2ZuX2xvY2soKSB3b3VsZG4n
dCBoYXZlCmxvY2tlZCB0aGUgY29ycmVjdCBHRk4gcmFuZ2UgYW55d2F5LCBp
ZiBpdCBkaWRuJ3Qgc2ltcGx5IHJlc29sdmUgdG8KcDJtX2xvY2soKSwgYW5k
IGZvciB3ZWxsLWJlaGF2ZWQgY2FsbGVycyB0aGVyZSBjb250aW51ZXMgdG8g
YmUgb25seSBhCnNpbmdsZSBpdGVyYXRpb24sIGkuZS4gYmVoYXZpb3IgaXMg
dW5jaGFuZ2VkIGZvciB0aGVtLiAoRlRBT0QgcHVsbGluZwpvdXQganVzdCBw
b2RfbG9jaygpIGludG8gcDJtX3BvZF9kZWNyZWFzZV9yZXNlcnZhdGlvbigp
IHdvdWxkIHJlc3VsdCBpbgphIGxvY2sgb3JkZXIgdmlvbGF0aW9uLikKClRo
aXMgaXMgQ1ZFLTIwMjEtMjg3MDQgYW5kIENWRS0yMDIxLTI4NzA3IC8gcGFy
dCBvZiBYU0EtMzg4LgoKRml4ZXM6IDNjMzUyMDExYzBkMyAoIng4Ni9Qb0Q6
IHNob3J0ZW4gY2VydGFpbiBvcGVyYXRpb25zIG9uIGhpZ2hlciBvcmRlciBy
YW5nZXMiKQpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dl
ci5wYXVAY2l0cml4LmNvbT4KLS0tClRoZSBzZWN1cml0eSBhc3BlY3QgaGVy
ZSBzdGVtcyBmcm9tIHRoZSB2YXJpb3VzIEJVR19PTigpcyB3ZSBoYXZlCmNo
ZWNraW5nCi0gcDJtLT5wb2QuZW50cnlfY291bnQsCi0gdGhlIGFsaWdubWVu
dCBvZiB0aGUgTUZOIHAybV9wb2RfY2FjaGVfZ2V0KCkgcmV0dXJucy4KLS0t
CnYzOiBSZS1kbyB1c2luZyB3cmFwcGVycy4KdjI6IFByZWZpeCBkb21haW5f
Y3Jhc2goKSBieSBwcmludGsoWEVOTE9HX0dfRVJSIC4uLikgKGluY2x1ZGlu
ZyB0aGUKICAgIHByZS1leGlzdGluZyBzaW1pbGFyIG9uZSkuCgotLS0gYS94
ZW4vYXJjaC94ODYvbW0vcDJtLXBvZC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9t
bS9wMm0tcG9kLmMKQEAgLTUwNCw3ICs1MDQsNyBAQCBzdGF0aWMgdm9pZCBw
b2RfdW5sb2NrX2FuZF9mbHVzaChzdHJ1Y3QKIH0KIAogLyoKLSAqIFRoaXMg
ZnVuY3Rpb24gaXMgbmVlZGVkIGZvciB0d28gcmVhc29uczoKKyAqIFRoaXMg
cGFpciBvZiBmdW5jdGlvbnMgaXMgbmVlZGVkIGZvciB0d28gcmVhc29uczoK
ICAqICsgVG8gcHJvcGVybHkgaGFuZGxlIGNsZWFyaW5nIG9mIFBvRCBlbnRy
aWVzCiAgKiArIFRvICJzdGVhbCBiYWNrIiBtZW1vcnkgYmVpbmcgZnJlZWQg
Zm9yIHRoZSBQb0QgY2FjaGUsIHJhdGhlciB0aGFuCiAgKiAgIHJlbGVhc2lu
ZyBpdC4KQEAgLTUxMiw4ICs1MTIsOCBAQCBzdGF0aWMgdm9pZCBwb2RfdW5s
b2NrX2FuZF9mbHVzaChzdHJ1Y3QKICAqIE9uY2UgYm90aCBvZiB0aGVzZSBm
dW5jdGlvbnMgaGF2ZSBiZWVuIGNvbXBsZXRlZCwgd2UgY2FuIHJldHVybiBh
bmQKICAqIGFsbG93IGRlY3JlYXNlX3Jlc2VydmF0aW9uKCkgdG8gaGFuZGxl
IGV2ZXJ5dGhpbmcgZWxzZS4KICAqLwotdW5zaWduZWQgbG9uZwotcDJtX3Bv
ZF9kZWNyZWFzZV9yZXNlcnZhdGlvbihzdHJ1Y3QgZG9tYWluICpkLCBnZm5f
dCBnZm4sIHVuc2lnbmVkIGludCBvcmRlcikKK3N0YXRpYyB1bnNpZ25lZCBs
b25nCitkZWNyZWFzZV9yZXNlcnZhdGlvbihzdHJ1Y3QgZG9tYWluICpkLCBn
Zm5fdCBnZm4sIHVuc2lnbmVkIGludCBvcmRlcikKIHsKICAgICB1bnNpZ25l
ZCBsb25nIHJldCA9IDAsIGksIG47CiAgICAgc3RydWN0IHAybV9kb21haW4g
KnAybSA9IHAybV9nZXRfaG9zdHAybShkKTsKQEAgLTU2MSw4ICs1NjEsMTAg
QEAgcDJtX3BvZF9kZWNyZWFzZV9yZXNlcnZhdGlvbihzdHJ1Y3QgZG9tYQog
ICAgICAgICAgKiBBbGwgUG9EOiBNYXJrIHRoZSB3aG9sZSByZWdpb24gaW52
YWxpZCBhbmQgdGVsbCBjYWxsZXIKICAgICAgICAgICogd2UncmUgZG9uZS4K
ICAgICAgICAgICovCi0gICAgICAgIGlmICggcDJtX3NldF9lbnRyeShwMm0s
IGdmbiwgSU5WQUxJRF9NRk4sIG9yZGVyLCBwMm1faW52YWxpZCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHAybS0+ZGVmYXVsdF9hY2Nlc3MpICkK
KyAgICAgICAgaW50IHJjID0gcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5W
QUxJRF9NRk4sIG9yZGVyLCBwMm1faW52YWxpZCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwMm0tPmRlZmF1bHRfYWNjZXNzKTsKKworICAg
ICAgICBpZiAoIHJjICkKICAgICAgICAgewogICAgICAgICAgICAgLyoKICAg
ICAgICAgICAgICAqIElmIHRoaXMgZmFpbHMsIHdlIGNhbid0IHRlbGwgaG93
IG11Y2ggb2YgdGhlIHJhbmdlIHdhcyBjaGFuZ2VkLgpAQCAtNTcwLDcgKzU3
MiwxMiBAQCBwMm1fcG9kX2RlY3JlYXNlX3Jlc2VydmF0aW9uKHN0cnVjdCBk
b21hCiAgICAgICAgICAgICAgKiBpbXBvc3NpYmxlLgogICAgICAgICAgICAg
ICovCiAgICAgICAgICAgICBpZiAoIG9yZGVyICE9IDAgKQorICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIHByaW50ayhYRU5MT0dfR19FUlIKKyAg
ICAgICAgICAgICAgICAgICAgICAgIiVwZDogbWFya2luZyBHRk4gJSNseCAo
b3JkZXIgJXUpIGFzIG5vbi1Qb0QgZmFpbGVkOiAlZFxuIiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgZCwgZ2ZuX3goZ2ZuKSwgb3JkZXIsIHJjKTsKICAg
ICAgICAgICAgICAgICBkb21haW5fY3Jhc2goZCk7CisgICAgICAgICAgICB9
CiAgICAgICAgICAgICBnb3RvIG91dF91bmxvY2s7CiAgICAgICAgIH0KICAg
ICAgICAgcmV0ID0gMVVMIDw8IG9yZGVyOwpAQCAtNjc5LDYgKzY4NiwyMiBA
QCBvdXRfdW5sb2NrOgogICAgIHJldHVybiByZXQ7CiB9CiAKK3Vuc2lnbmVk
IGxvbmcKK3AybV9wb2RfZGVjcmVhc2VfcmVzZXJ2YXRpb24oc3RydWN0IGRv
bWFpbiAqZCwgZ2ZuX3QgZ2ZuLCB1bnNpZ25lZCBpbnQgb3JkZXIpCit7Cisg
ICAgdW5zaWduZWQgbG9uZyBsZWZ0ID0gMVVMIDw8IG9yZGVyLCByZXQgPSAw
OworICAgIHVuc2lnbmVkIGludCBjaHVua19vcmRlciA9IGZpbmRfZmlyc3Rf
c2V0X2JpdChnZm5feChnZm4pIHwgbGVmdCk7CisKKyAgICBkbyB7CisgICAg
ICAgIHJldCArPSBkZWNyZWFzZV9yZXNlcnZhdGlvbihkLCBnZm4sIGNodW5r
X29yZGVyKTsKKworICAgICAgICBsZWZ0IC09IDFVTCA8PCBjaHVua19vcmRl
cjsKKyAgICAgICAgZ2ZuID0gZ2ZuX2FkZChnZm4sIDFVTCA8PCBjaHVua19v
cmRlcik7CisgICAgfSB3aGlsZSAoIGxlZnQgKTsKKworICAgIHJldHVybiBy
ZXQ7Cit9CisKIHZvaWQgcDJtX3BvZF9kdW1wX2RhdGEoc3RydWN0IGRvbWFp
biAqZCkKIHsKICAgICBzdHJ1Y3QgcDJtX2RvbWFpbiAqcDJtID0gcDJtX2dl
dF9ob3N0cDJtKGQpOwpAQCAtMTI4OSwxOSArMTMxMiwxNSBAQCByZW1hcF9h
bmRfcmV0cnk6CiAgICAgcmV0dXJuIHRydWU7CiB9CiAKLQotaW50Ci1ndWVz
dF9waHlzbWFwX21hcmtfcG9wdWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21h
aW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuX2wsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBvcmRlcikKK3N0
YXRpYyBpbnQKK21hcmtfcG9wdWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21h
aW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuX2wsCisgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXIpCiB7CiAgICAgc3RydWN0IHAy
bV9kb21haW4gKnAybSA9IHAybV9nZXRfaG9zdHAybShkKTsKICAgICBnZm5f
dCBnZm4gPSBfZ2ZuKGdmbl9sKTsKICAgICB1bnNpZ25lZCBsb25nIGksIG4s
IHBvZF9jb3VudCA9IDA7CiAgICAgaW50IHJjID0gMDsKIAotICAgIGlmICgg
IXBhZ2luZ19tb2RlX3RyYW5zbGF0ZShkKSApCi0gICAgICAgIHJldHVybiAt
RUlOVkFMOwotCiAgICAgZ2ZuX2xvY2socDJtLCBnZm4sIG9yZGVyKTsKIAog
ICAgIFAyTV9ERUJVRygibWFyayBwb2QgZ2ZuPSUjbHhcbiIsIGdmbl9sKTsK
QEAgLTEzNDEsMTIgKzEzNjAsNDQgQEAgZ3Vlc3RfcGh5c21hcF9tYXJrX3Bv
cHVsYXRlX29uX2RlbWFuZChzdAogCiAgICAgICAgIGlvcmVxX3JlcXVlc3Rf
bWFwY2FjaGVfaW52YWxpZGF0ZShkKTsKICAgICB9CisgICAgZWxzZSBpZiAo
IG9yZGVyICkKKyAgICB7CisgICAgICAgIC8qCisgICAgICAgICAqIElmIHRo
aXMgZmFpbGVkLCB3ZSBjYW4ndCB0ZWxsIGhvdyBtdWNoIG9mIHRoZSByYW5n
ZSB3YXMgY2hhbmdlZC4KKyAgICAgICAgICogQmVzdCB0byBjcmFzaCB0aGUg
ZG9tYWluLgorICAgICAgICAgKi8KKyAgICAgICAgcHJpbnRrKFhFTkxPR19H
X0VSUgorICAgICAgICAgICAgICAgIiVwZDogbWFya2luZyBHRk4gJSNseCAo
b3JkZXIgJXUpIGFzIFBvRCBmYWlsZWQ6ICVkXG4iLAorICAgICAgICAgICAg
ICAgZCwgZ2ZuX2wsIG9yZGVyLCByYyk7CisgICAgICAgIGRvbWFpbl9jcmFz
aChkKTsKKyAgICB9CiAKIG91dDoKICAgICBnZm5fdW5sb2NrKHAybSwgZ2Zu
LCBvcmRlcik7CiAKICAgICByZXR1cm4gcmM7CiB9CisKK2ludAorZ3Vlc3Rf
cGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZChzdHJ1Y3QgZG9tYWlu
ICpkLCB1bnNpZ25lZCBsb25nIGdmbiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG9yZGVyKQoreworICAg
IHVuc2lnbmVkIGxvbmcgbGVmdCA9IDFVTCA8PCBvcmRlcjsKKyAgICB1bnNp
Z25lZCBpbnQgY2h1bmtfb3JkZXIgPSBmaW5kX2ZpcnN0X3NldF9iaXQoZ2Zu
IHwgbGVmdCk7CisgICAgaW50IHJjOworCisgICAgaWYgKCAhcGFnaW5nX21v
ZGVfdHJhbnNsYXRlKGQpICkKKyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisK
KyAgICBkbyB7CisgICAgICAgIHJjID0gbWFya19wb3B1bGF0ZV9vbl9kZW1h
bmQoZCwgZ2ZuLCBjaHVua19vcmRlcik7CisKKyAgICAgICAgbGVmdCAtPSAx
VUwgPDwgY2h1bmtfb3JkZXI7CisgICAgICAgIGdmbiArPSAxVUwgPDwgY2h1
bmtfb3JkZXI7CisgICAgfSB3aGlsZSAoICFyYyAmJiBsZWZ0ICk7CisKKyAg
ICByZXR1cm4gcmM7Cit9CiAKIHZvaWQgcDJtX3BvZF9pbml0KHN0cnVjdCBw
Mm1fZG9tYWluICpwMm0pCiB7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa388-2.patch"
Content-Disposition: attachment; filename="xsa388-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUG9EOiBoYW5kbGUgaW50ZXJtZWRpYXRlIHBhZ2Ugb3JkZXJzIGlu
IHAybV9wb2RfY2FjaGVfYWRkKCkKCnAybV9wb2RfZGVjcmVhc2VfcmVzZXJ2
YXRpb24oKSBtYXkgcGFzcyBwYWdlcyB0byB0aGUgZnVuY3Rpb24gd2hpY2gK
YXJlbid0IDRrLCAyTSwgb3IgMUcuIEhhbmRsZSBhbGwgaW50ZXJtZWRpYXRl
IG9yZGVycyBhcyB3ZWxsLCB0byBhdm9pZApoaXR0aW5nIHRoZSBCVUcoKSBh
dCB0aGUgc3dpdGNoKCkgc3RhdGVtZW50J3MgImRlZmF1bHQiIGNhc2UuCgpU
aGlzIGlzIENWRS0yMDIxLTI4NzA4IC8gcGFydCBvZiBYU0EtMzg4LgoKRml4
ZXM6IDNjMzUyMDExYzBkMyAoIng4Ni9Qb0Q6IHNob3J0ZW4gY2VydGFpbiBv
cGVyYXRpb25zIG9uIGhpZ2hlciBvcmRlciByYW5nZXMiKQpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4K
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMKKysrIGIveGVuL2Fy
Y2gveDg2L21tL3AybS1wb2QuYwpAQCAtMTE0LDE1ICsxMTQsMTMgQEAgcDJt
X3BvZF9jYWNoZV9hZGQoc3RydWN0IHAybV9kb21haW4gKnAybQogICAgIC8q
IFRoZW4gYWRkIHRvIHRoZSBhcHByb3ByaWF0ZSBwb3B1bGF0ZS1vbi1kZW1h
bmQgbGlzdC4gKi8KICAgICBzd2l0Y2ggKCBvcmRlciApCiAgICAgewotICAg
IGNhc2UgUEFHRV9PUkRFUl8xRzoKLSAgICAgICAgZm9yICggaSA9IDA7IGkg
PCAoMVVMIDw8IFBBR0VfT1JERVJfMUcpOyBpICs9IDFVTCA8PCBQQUdFX09S
REVSXzJNICkKKyAgICBjYXNlIFBBR0VfT1JERVJfMk0gLi4uIFBBR0VfT1JE
RVJfMUc6CisgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBvcmRl
cik7IGkgKz0gMVVMIDw8IFBBR0VfT1JERVJfMk0gKQogICAgICAgICAgICAg
cGFnZV9saXN0X2FkZF90YWlsKHBhZ2UgKyBpLCAmcDJtLT5wb2Quc3VwZXIp
OwogICAgICAgICBicmVhazsKLSAgICBjYXNlIFBBR0VfT1JERVJfMk06Ci0g
ICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmcDJtLT5wb2Quc3Vw
ZXIpOwotICAgICAgICBicmVhazsKLSAgICBjYXNlIFBBR0VfT1JERVJfNEs6
Ci0gICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmcDJtLT5wb2Qu
c2luZ2xlKTsKKyAgICBjYXNlIFBBR0VfT1JERVJfNEsgLi4uIFBBR0VfT1JE
RVJfMk0gLSAxOgorICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwg
b3JkZXIpOyBpICs9IDFVTCA8PCBQQUdFX09SREVSXzRLICkKKyAgICAgICAg
ICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlICsgaSwgJnAybS0+cG9kLnNp
bmdsZSk7CiAgICAgICAgIGJyZWFrOwogICAgIGRlZmF1bHQ6CiAgICAgICAg
IEJVRygpOwo=

--=separator
Content-Type: application/octet-stream; name="xsa388-4.14-1.patch"
Content-Disposition: attachment; filename="xsa388-4.14-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUG9EOiBkZWFsIHdpdGggbWlzYWxpZ25lZCBHRk5zCgpVc2VycyBv
ZiBYRU5NRU1fZGVjcmVhc2VfcmVzZXJ2YXRpb24gYW5kIFhFTk1FTV9wb3B1
bGF0ZV9waHlzbWFwIGFyZW4ndApyZXF1aXJlZCB0byBwYXNzIGluIG9yZGVy
LWFsaWduZWQgR0ZOIHZhbHVlcy4gKFdoaWxlIEkgY29uc2lkZXIgdGhpcwpi
b2d1cywgSSBkb24ndCB0aGluayB3ZSBjYW4gZml4IHRoaXMgdGhlcmUsIGFz
IHRoYXQgbWlnaHQgYnJlYWsgZXhpc3RpbmcKY29kZSwgZS5nIExpbnV4J2Vz
IHN3aW90bGIsIHdoaWNoIC0gd2hpbGUgYWZmZWN0aW5nIFBWIG9ubHkgLSB1
bnRpbApyZWNlbnRseSBoYWQgYmVlbiBlbmZvcmNpbmcgb25seSBwYWdlIGFs
aWdubWVudCBvbiB0aGUgb3JpZ2luYWwKYWxsb2NhdGlvbi4pIE9ubHkgbm9u
LVBvRCBjb2RlIHBhdGhzIChndWVzdF9waHlzbWFwX3thZGQscmVtb3ZlfV9w
YWdlKCksCnAybV9zZXRfZW50cnkoKSkgbG9vayB0byBiZSBkZWFsaW5nIHdp
dGggdGhpcyBwcm9wZXJseSAoaW4gcGFydCBieSBiZWluZwppbXBsZW1lbnRl
ZCBpbmVmZmljaWVudGx5LCBoYW5kbGluZyBldmVyeSA0ayBwYWdlIHNlcGFy
YXRlbHkpLgoKSW50cm9kdWNlIHdyYXBwZXJzIHRha2luZyBjYXJlIG9mIHNw
bGl0dGluZyB0aGUgaW5jb21pbmcgcmVxdWVzdCBpbnRvCmFsaWduZWQgY2h1
bmtzLCB3aXRob3V0IHB1dHRpbmcgbXVjaCBlZmZvcnQgaW4gdHJ5aW5nIHRv
IGRldGVybWluZSB0aGUKbGFyZ2VzdCBwb3NzaWJsZSBjaHVuayBhdCBldmVy
eSBpdGVyYXRpb24uCgpBbHNvICJoYW5kbGUiIHAybV9zZXRfZW50cnkoKSBm
YWlsdXJlIGZvciBub24tb3JkZXItMCByZXF1ZXN0cyBieQpjcmFzaGluZyB0
aGUgZG9tYWluIGluIG9uZSBtb3JlIHBsYWNlLiBBbG9uZ3NpZGUgcHV0dGlu
ZyBhIGxvZyBtZXNzYWdlCnRoZXJlLCBhbHNvIGFkZCBvbmUgdG8gdGhlIG90
aGVyIHNpbWlsYXIgcGF0aC4KCk5vdGUgcmVnYXJkaW5nIGxvY2tpbmc6IFRo
aXMgaXMgbGVmdCBpbiB0aGUgYWN0dWFsIHdvcmtlciBmdW5jdGlvbnMgb24K
dGhlIGFzc3VtcHRpb24gdGhhdCBjYWxsZXJzIGFyZW4ndCBndWFyYW50ZWVk
IGF0b21pY2l0eSB3cnQgYWN0aW5nIG9uCm11bHRpcGxlIHBhZ2VzIGF0IGEg
dGltZS4gRm9yIG1pcy1hbGlnbmVkIEdGTnMgZ2ZuX2xvY2soKSB3b3VsZG4n
dCBoYXZlCmxvY2tlZCB0aGUgY29ycmVjdCBHRk4gcmFuZ2UgYW55d2F5LCBp
ZiBpdCBkaWRuJ3Qgc2ltcGx5IHJlc29sdmUgdG8KcDJtX2xvY2soKSwgYW5k
IGZvciB3ZWxsLWJlaGF2ZWQgY2FsbGVycyB0aGVyZSBjb250aW51ZXMgdG8g
YmUgb25seSBhCnNpbmdsZSBpdGVyYXRpb24sIGkuZS4gYmVoYXZpb3IgaXMg
dW5jaGFuZ2VkIGZvciB0aGVtLiAoRlRBT0QgcHVsbGluZwpvdXQganVzdCBw
b2RfbG9jaygpIGludG8gcDJtX3BvZF9kZWNyZWFzZV9yZXNlcnZhdGlvbigp
IHdvdWxkIHJlc3VsdCBpbgphIGxvY2sgb3JkZXIgdmlvbGF0aW9uLikKClRo
aXMgaXMgQ1ZFLTIwMjEtMjg3MDQgYW5kIENWRS0yMDIxLTI4NzA3IC8gcGFy
dCBvZiBYU0EtMzg4LgoKRml4ZXM6IDNjMzUyMDExYzBkMyAoIng4Ni9Qb0Q6
IHNob3J0ZW4gY2VydGFpbiBvcGVyYXRpb25zIG9uIGhpZ2hlciBvcmRlciBy
YW5nZXMiKQpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dl
ci5wYXVAY2l0cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0t
cG9kLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1wb2QuYwpAQCAtNDk1
LDcgKzQ5NSw3IEBAIHAybV9wb2RfemVyb19jaGVja19zdXBlcnBhZ2Uoc3Ry
dWN0IHAybV8KIAogCiAvKgotICogVGhpcyBmdW5jdGlvbiBpcyBuZWVkZWQg
Zm9yIHR3byByZWFzb25zOgorICogVGhpcyBwYWlyIG9mIGZ1bmN0aW9ucyBp
cyBuZWVkZWQgZm9yIHR3byByZWFzb25zOgogICogKyBUbyBwcm9wZXJseSBo
YW5kbGUgY2xlYXJpbmcgb2YgUG9EIGVudHJpZXMKICAqICsgVG8gInN0ZWFs
IGJhY2siIG1lbW9yeSBiZWluZyBmcmVlZCBmb3IgdGhlIFBvRCBjYWNoZSwg
cmF0aGVyIHRoYW4KICAqICAgcmVsZWFzaW5nIGl0LgpAQCAtNTAzLDggKzUw
Myw4IEBAIHAybV9wb2RfemVyb19jaGVja19zdXBlcnBhZ2Uoc3RydWN0IHAy
bV8KICAqIE9uY2UgYm90aCBvZiB0aGVzZSBmdW5jdGlvbnMgaGF2ZSBiZWVu
IGNvbXBsZXRlZCwgd2UgY2FuIHJldHVybiBhbmQKICAqIGFsbG93IGRlY3Jl
YXNlX3Jlc2VydmF0aW9uKCkgdG8gaGFuZGxlIGV2ZXJ5dGhpbmcgZWxzZS4K
ICAqLwotdW5zaWduZWQgbG9uZwotcDJtX3BvZF9kZWNyZWFzZV9yZXNlcnZh
dGlvbihzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIHVuc2lnbmVkIGlu
dCBvcmRlcikKK3N0YXRpYyB1bnNpZ25lZCBsb25nCitkZWNyZWFzZV9yZXNl
cnZhdGlvbihzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIHVuc2lnbmVk
IGludCBvcmRlcikKIHsKICAgICB1bnNpZ25lZCBsb25nIHJldCA9IDAsIGks
IG47CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybSA9IHAybV9nZXRfaG9z
dHAybShkKTsKQEAgLTU1MSw4ICs1NTEsMTAgQEAgcDJtX3BvZF9kZWNyZWFz
ZV9yZXNlcnZhdGlvbihzdHJ1Y3QgZG9tYQogICAgICAgICAgKiBBbGwgUG9E
OiBNYXJrIHRoZSB3aG9sZSByZWdpb24gaW52YWxpZCBhbmQgdGVsbCBjYWxs
ZXIKICAgICAgICAgICogd2UncmUgZG9uZS4KICAgICAgICAgICovCi0gICAg
ICAgIGlmICggcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4s
IG9yZGVyLCBwMm1faW52YWxpZCwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHAybS0+ZGVmYXVsdF9hY2Nlc3MpICkKKyAgICAgICAgaW50IHJjID0g
cDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4sIG9yZGVyLCBw
Mm1faW52YWxpZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBw
Mm0tPmRlZmF1bHRfYWNjZXNzKTsKKworICAgICAgICBpZiAoIHJjICkKICAg
ICAgICAgewogICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAqIElmIHRo
aXMgZmFpbHMsIHdlIGNhbid0IHRlbGwgaG93IG11Y2ggb2YgdGhlIHJhbmdl
IHdhcyBjaGFuZ2VkLgpAQCAtNTYwLDcgKzU2MiwxMiBAQCBwMm1fcG9kX2Rl
Y3JlYXNlX3Jlc2VydmF0aW9uKHN0cnVjdCBkb21hCiAgICAgICAgICAgICAg
KiBpbXBvc3NpYmxlLgogICAgICAgICAgICAgICovCiAgICAgICAgICAgICBp
ZiAoIG9yZGVyICE9IDAgKQorICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfR19FUlIKKyAgICAgICAgICAgICAgICAgICAg
ICAgIiVwZDogbWFya2luZyBHRk4gJSNseCAob3JkZXIgJXUpIGFzIG5vbi1Q
b0QgZmFpbGVkOiAlZFxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgZCwg
Z2ZuX3goZ2ZuKSwgb3JkZXIsIHJjKTsKICAgICAgICAgICAgICAgICBkb21h
aW5fY3Jhc2goZCk7CisgICAgICAgICAgICB9CiAgICAgICAgICAgICBnb3Rv
IG91dF91bmxvY2s7CiAgICAgICAgIH0KICAgICAgICAgcmV0ID0gMVVMIDw8
IG9yZGVyOwpAQCAtNjY3LDYgKzY3NCwyMiBAQCBvdXRfdW5sb2NrOgogICAg
IHJldHVybiByZXQ7CiB9CiAKK3Vuc2lnbmVkIGxvbmcKK3AybV9wb2RfZGVj
cmVhc2VfcmVzZXJ2YXRpb24oc3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2Zu
LCB1bnNpZ25lZCBpbnQgb3JkZXIpCit7CisgICAgdW5zaWduZWQgbG9uZyBs
ZWZ0ID0gMVVMIDw8IG9yZGVyLCByZXQgPSAwOworICAgIHVuc2lnbmVkIGlu
dCBjaHVua19vcmRlciA9IGZpbmRfZmlyc3Rfc2V0X2JpdChnZm5feChnZm4p
IHwgbGVmdCk7CisKKyAgICBkbyB7CisgICAgICAgIHJldCArPSBkZWNyZWFz
ZV9yZXNlcnZhdGlvbihkLCBnZm4sIGNodW5rX29yZGVyKTsKKworICAgICAg
ICBsZWZ0IC09IDFVTCA8PCBjaHVua19vcmRlcjsKKyAgICAgICAgZ2ZuID0g
Z2ZuX2FkZChnZm4sIDFVTCA8PCBjaHVua19vcmRlcik7CisgICAgfSB3aGls
ZSAoIGxlZnQgKTsKKworICAgIHJldHVybiByZXQ7Cit9CisKIHZvaWQgcDJt
X3BvZF9kdW1wX2RhdGEoc3RydWN0IGRvbWFpbiAqZCkKIHsKICAgICBzdHJ1
Y3QgcDJtX2RvbWFpbiAqcDJtID0gcDJtX2dldF9ob3N0cDJtKGQpOwpAQCAt
MTI2NiwxOSArMTI4OSwxNSBAQCByZW1hcF9hbmRfcmV0cnk6CiAgICAgcmV0
dXJuIHRydWU7CiB9CiAKLQotaW50Ci1ndWVzdF9waHlzbWFwX21hcmtfcG9w
dWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxv
bmcgZ2ZuX2wsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBvcmRlcikKK3N0YXRpYyBpbnQKK21hcmtfcG9w
dWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxv
bmcgZ2ZuX2wsCisgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgb3JkZXIpCiB7CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybSA9IHAy
bV9nZXRfaG9zdHAybShkKTsKICAgICBnZm5fdCBnZm4gPSBfZ2ZuKGdmbl9s
KTsKICAgICB1bnNpZ25lZCBsb25nIGksIG4sIHBvZF9jb3VudCA9IDA7CiAg
ICAgaW50IHJjID0gMDsKIAotICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5z
bGF0ZShkKSApCi0gICAgICAgIHJldHVybiAtRUlOVkFMOwotCiAgICAgZ2Zu
X2xvY2socDJtLCBnZm4sIG9yZGVyKTsKIAogICAgIFAyTV9ERUJVRygibWFy
ayBwb2QgZ2ZuPSUjbHhcbiIsIGdmbl9sKTsKQEAgLTEzMTYsMTIgKzEzMzUs
NDQgQEAgZ3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZChz
dAogICAgICAgICBCVUdfT04ocDJtLT5wb2QuZW50cnlfY291bnQgPCAwKTsK
ICAgICAgICAgcG9kX3VubG9jayhwMm0pOwogICAgIH0KKyAgICBlbHNlIGlm
ICggb3JkZXIgKQorICAgIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogSWYg
dGhpcyBmYWlsZWQsIHdlIGNhbid0IHRlbGwgaG93IG11Y2ggb2YgdGhlIHJh
bmdlIHdhcyBjaGFuZ2VkLgorICAgICAgICAgKiBCZXN0IHRvIGNyYXNoIHRo
ZSBkb21haW4uCisgICAgICAgICAqLworICAgICAgICBwcmludGsoWEVOTE9H
X0dfRVJSCisgICAgICAgICAgICAgICAiJXBkOiBtYXJraW5nIEdGTiAlI2x4
IChvcmRlciAldSkgYXMgUG9EIGZhaWxlZDogJWRcbiIsCisgICAgICAgICAg
ICAgICBkLCBnZm5fbCwgb3JkZXIsIHJjKTsKKyAgICAgICAgZG9tYWluX2Ny
YXNoKGQpOworICAgIH0KIAogb3V0OgogICAgIGdmbl91bmxvY2socDJtLCBn
Zm4sIG9yZGVyKTsKIAogICAgIHJldHVybiByYzsKIH0KKworaW50CitndWVz
dF9waHlzbWFwX21hcmtfcG9wdWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21h
aW4gKmQsIHVuc2lnbmVkIGxvbmcgZ2ZuLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXIpCit7Cisg
ICAgdW5zaWduZWQgbG9uZyBsZWZ0ID0gMVVMIDw8IG9yZGVyOworICAgIHVu
c2lnbmVkIGludCBjaHVua19vcmRlciA9IGZpbmRfZmlyc3Rfc2V0X2JpdChn
Zm4gfCBsZWZ0KTsKKyAgICBpbnQgcmM7CisKKyAgICBpZiAoICFwYWdpbmdf
bW9kZV90cmFuc2xhdGUoZCkgKQorICAgICAgICByZXR1cm4gLUVJTlZBTDsK
KworICAgIGRvIHsKKyAgICAgICAgcmMgPSBtYXJrX3BvcHVsYXRlX29uX2Rl
bWFuZChkLCBnZm4sIGNodW5rX29yZGVyKTsKKworICAgICAgICBsZWZ0IC09
IDFVTCA8PCBjaHVua19vcmRlcjsKKyAgICAgICAgZ2ZuICs9IDFVTCA8PCBj
aHVua19vcmRlcjsKKyAgICB9IHdoaWxlICggIXJjICYmIGxlZnQgKTsKKwor
ICAgIHJldHVybiByYzsKK30KIAogdm9pZCBwMm1fcG9kX2luaXQoc3RydWN0
IHAybV9kb21haW4gKnAybSkKIHsK

--=separator
Content-Type: application/octet-stream; name="xsa388-4.14-2.patch"
Content-Disposition: attachment; filename="xsa388-4.14-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUG9EOiBoYW5kbGUgaW50ZXJtZWRpYXRlIHBhZ2Ugb3JkZXJzIGlu
IHAybV9wb2RfY2FjaGVfYWRkKCkKCnAybV9wb2RfZGVjcmVhc2VfcmVzZXJ2
YXRpb24oKSBtYXkgcGFzcyBwYWdlcyB0byB0aGUgZnVuY3Rpb24gd2hpY2gK
YXJlbid0IDRrLCAyTSwgb3IgMUcuIEhhbmRsZSBhbGwgaW50ZXJtZWRpYXRl
IG9yZGVycyBhcyB3ZWxsLCB0byBhdm9pZApoaXR0aW5nIHRoZSBCVUcoKSBh
dCB0aGUgc3dpdGNoKCkgc3RhdGVtZW50J3MgImRlZmF1bHQiIGNhc2UuCgpU
aGlzIGlzIENWRS0yMDIxLTI4NzA4IC8gcGFydCBvZiBYU0EtMzg4LgoKRml4
ZXM6IDNjMzUyMDExYzBkMyAoIng4Ni9Qb0Q6IHNob3J0ZW4gY2VydGFpbiBv
cGVyYXRpb25zIG9uIGhpZ2hlciBvcmRlciByYW5nZXMiKQpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4K
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMKKysrIGIveGVuL2Fy
Y2gveDg2L21tL3AybS1wb2QuYwpAQCAtMTExLDE1ICsxMTEsMTMgQEAgcDJt
X3BvZF9jYWNoZV9hZGQoc3RydWN0IHAybV9kb21haW4gKnAybQogICAgIC8q
IFRoZW4gYWRkIHRvIHRoZSBhcHByb3ByaWF0ZSBwb3B1bGF0ZS1vbi1kZW1h
bmQgbGlzdC4gKi8KICAgICBzd2l0Y2ggKCBvcmRlciApCiAgICAgewotICAg
IGNhc2UgUEFHRV9PUkRFUl8xRzoKLSAgICAgICAgZm9yICggaSA9IDA7IGkg
PCAoMVVMIDw8IFBBR0VfT1JERVJfMUcpOyBpICs9IDFVTCA8PCBQQUdFX09S
REVSXzJNICkKKyAgICBjYXNlIFBBR0VfT1JERVJfMk0gLi4uIFBBR0VfT1JE
RVJfMUc6CisgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBvcmRl
cik7IGkgKz0gMVVMIDw8IFBBR0VfT1JERVJfMk0gKQogICAgICAgICAgICAg
cGFnZV9saXN0X2FkZF90YWlsKHBhZ2UgKyBpLCAmcDJtLT5wb2Quc3VwZXIp
OwogICAgICAgICBicmVhazsKLSAgICBjYXNlIFBBR0VfT1JERVJfMk06Ci0g
ICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmcDJtLT5wb2Quc3Vw
ZXIpOwotICAgICAgICBicmVhazsKLSAgICBjYXNlIFBBR0VfT1JERVJfNEs6
Ci0gICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmcDJtLT5wb2Qu
c2luZ2xlKTsKKyAgICBjYXNlIFBBR0VfT1JERVJfNEsgLi4uIFBBR0VfT1JE
RVJfMk0gLSAxOgorICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwg
b3JkZXIpOyBpICs9IDFVTCA8PCBQQUdFX09SREVSXzRLICkKKyAgICAgICAg
ICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlICsgaSwgJnAybS0+cG9kLnNp
bmdsZSk7CiAgICAgICAgIGJyZWFrOwogICAgIGRlZmF1bHQ6CiAgICAgICAg
IEJVRygpOwo=

--=separator
Content-Type: application/octet-stream; name="xsa388-4.15-1.patch"
Content-Disposition: attachment; filename="xsa388-4.15-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUG9EOiBkZWFsIHdpdGggbWlzYWxpZ25lZCBHRk5zCgpVc2VycyBv
ZiBYRU5NRU1fZGVjcmVhc2VfcmVzZXJ2YXRpb24gYW5kIFhFTk1FTV9wb3B1
bGF0ZV9waHlzbWFwIGFyZW4ndApyZXF1aXJlZCB0byBwYXNzIGluIG9yZGVy
LWFsaWduZWQgR0ZOIHZhbHVlcy4gKFdoaWxlIEkgY29uc2lkZXIgdGhpcwpi
b2d1cywgSSBkb24ndCB0aGluayB3ZSBjYW4gZml4IHRoaXMgdGhlcmUsIGFz
IHRoYXQgbWlnaHQgYnJlYWsgZXhpc3RpbmcKY29kZSwgZS5nIExpbnV4J2Vz
IHN3aW90bGIsIHdoaWNoIC0gd2hpbGUgYWZmZWN0aW5nIFBWIG9ubHkgLSB1
bnRpbApyZWNlbnRseSBoYWQgYmVlbiBlbmZvcmNpbmcgb25seSBwYWdlIGFs
aWdubWVudCBvbiB0aGUgb3JpZ2luYWwKYWxsb2NhdGlvbi4pIE9ubHkgbm9u
LVBvRCBjb2RlIHBhdGhzIChndWVzdF9waHlzbWFwX3thZGQscmVtb3ZlfV9w
YWdlKCksCnAybV9zZXRfZW50cnkoKSkgbG9vayB0byBiZSBkZWFsaW5nIHdp
dGggdGhpcyBwcm9wZXJseSAoaW4gcGFydCBieSBiZWluZwppbXBsZW1lbnRl
ZCBpbmVmZmljaWVudGx5LCBoYW5kbGluZyBldmVyeSA0ayBwYWdlIHNlcGFy
YXRlbHkpLgoKSW50cm9kdWNlIHdyYXBwZXJzIHRha2luZyBjYXJlIG9mIHNw
bGl0dGluZyB0aGUgaW5jb21pbmcgcmVxdWVzdCBpbnRvCmFsaWduZWQgY2h1
bmtzLCB3aXRob3V0IHB1dHRpbmcgbXVjaCBlZmZvcnQgaW4gdHJ5aW5nIHRv
IGRldGVybWluZSB0aGUKbGFyZ2VzdCBwb3NzaWJsZSBjaHVuayBhdCBldmVy
eSBpdGVyYXRpb24uCgpBbHNvICJoYW5kbGUiIHAybV9zZXRfZW50cnkoKSBm
YWlsdXJlIGZvciBub24tb3JkZXItMCByZXF1ZXN0cyBieQpjcmFzaGluZyB0
aGUgZG9tYWluIGluIG9uZSBtb3JlIHBsYWNlLiBBbG9uZ3NpZGUgcHV0dGlu
ZyBhIGxvZyBtZXNzYWdlCnRoZXJlLCBhbHNvIGFkZCBvbmUgdG8gdGhlIG90
aGVyIHNpbWlsYXIgcGF0aC4KCk5vdGUgcmVnYXJkaW5nIGxvY2tpbmc6IFRo
aXMgaXMgbGVmdCBpbiB0aGUgYWN0dWFsIHdvcmtlciBmdW5jdGlvbnMgb24K
dGhlIGFzc3VtcHRpb24gdGhhdCBjYWxsZXJzIGFyZW4ndCBndWFyYW50ZWVk
IGF0b21pY2l0eSB3cnQgYWN0aW5nIG9uCm11bHRpcGxlIHBhZ2VzIGF0IGEg
dGltZS4gRm9yIG1pcy1hbGlnbmVkIEdGTnMgZ2ZuX2xvY2soKSB3b3VsZG4n
dCBoYXZlCmxvY2tlZCB0aGUgY29ycmVjdCBHRk4gcmFuZ2UgYW55d2F5LCBp
ZiBpdCBkaWRuJ3Qgc2ltcGx5IHJlc29sdmUgdG8KcDJtX2xvY2soKSwgYW5k
IGZvciB3ZWxsLWJlaGF2ZWQgY2FsbGVycyB0aGVyZSBjb250aW51ZXMgdG8g
YmUgb25seSBhCnNpbmdsZSBpdGVyYXRpb24sIGkuZS4gYmVoYXZpb3IgaXMg
dW5jaGFuZ2VkIGZvciB0aGVtLiAoRlRBT0QgcHVsbGluZwpvdXQganVzdCBw
b2RfbG9jaygpIGludG8gcDJtX3BvZF9kZWNyZWFzZV9yZXNlcnZhdGlvbigp
IHdvdWxkIHJlc3VsdCBpbgphIGxvY2sgb3JkZXIgdmlvbGF0aW9uLikKClRo
aXMgaXMgQ1ZFLTIwMjEtMjg3MDQgYW5kIENWRS0yMDIxLTI4NzA3IC8gcGFy
dCBvZiBYU0EtMzg4LgoKRml4ZXM6IDNjMzUyMDExYzBkMyAoIng4Ni9Qb0Q6
IHNob3J0ZW4gY2VydGFpbiBvcGVyYXRpb25zIG9uIGhpZ2hlciBvcmRlciBy
YW5nZXMiKQpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hA
c3VzZS5jb20+ClJldmlld2VkLWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dl
ci5wYXVAY2l0cml4LmNvbT4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0t
cG9kLmMKKysrIGIveGVuL2FyY2gveDg2L21tL3AybS1wb2QuYwpAQCAtNDk2
LDcgKzQ5Niw3IEBAIHAybV9wb2RfemVyb19jaGVja19zdXBlcnBhZ2Uoc3Ry
dWN0IHAybV8KIAogCiAvKgotICogVGhpcyBmdW5jdGlvbiBpcyBuZWVkZWQg
Zm9yIHR3byByZWFzb25zOgorICogVGhpcyBwYWlyIG9mIGZ1bmN0aW9ucyBp
cyBuZWVkZWQgZm9yIHR3byByZWFzb25zOgogICogKyBUbyBwcm9wZXJseSBo
YW5kbGUgY2xlYXJpbmcgb2YgUG9EIGVudHJpZXMKICAqICsgVG8gInN0ZWFs
IGJhY2siIG1lbW9yeSBiZWluZyBmcmVlZCBmb3IgdGhlIFBvRCBjYWNoZSwg
cmF0aGVyIHRoYW4KICAqICAgcmVsZWFzaW5nIGl0LgpAQCAtNTA0LDggKzUw
NCw4IEBAIHAybV9wb2RfemVyb19jaGVja19zdXBlcnBhZ2Uoc3RydWN0IHAy
bV8KICAqIE9uY2UgYm90aCBvZiB0aGVzZSBmdW5jdGlvbnMgaGF2ZSBiZWVu
IGNvbXBsZXRlZCwgd2UgY2FuIHJldHVybiBhbmQKICAqIGFsbG93IGRlY3Jl
YXNlX3Jlc2VydmF0aW9uKCkgdG8gaGFuZGxlIGV2ZXJ5dGhpbmcgZWxzZS4K
ICAqLwotdW5zaWduZWQgbG9uZwotcDJtX3BvZF9kZWNyZWFzZV9yZXNlcnZh
dGlvbihzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIHVuc2lnbmVkIGlu
dCBvcmRlcikKK3N0YXRpYyB1bnNpZ25lZCBsb25nCitkZWNyZWFzZV9yZXNl
cnZhdGlvbihzdHJ1Y3QgZG9tYWluICpkLCBnZm5fdCBnZm4sIHVuc2lnbmVk
IGludCBvcmRlcikKIHsKICAgICB1bnNpZ25lZCBsb25nIHJldCA9IDAsIGks
IG47CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybSA9IHAybV9nZXRfaG9z
dHAybShkKTsKQEAgLTU1Miw4ICs1NTIsMTAgQEAgcDJtX3BvZF9kZWNyZWFz
ZV9yZXNlcnZhdGlvbihzdHJ1Y3QgZG9tYQogICAgICAgICAgKiBBbGwgUG9E
OiBNYXJrIHRoZSB3aG9sZSByZWdpb24gaW52YWxpZCBhbmQgdGVsbCBjYWxs
ZXIKICAgICAgICAgICogd2UncmUgZG9uZS4KICAgICAgICAgICovCi0gICAg
ICAgIGlmICggcDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4s
IG9yZGVyLCBwMm1faW52YWxpZCwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHAybS0+ZGVmYXVsdF9hY2Nlc3MpICkKKyAgICAgICAgaW50IHJjID0g
cDJtX3NldF9lbnRyeShwMm0sIGdmbiwgSU5WQUxJRF9NRk4sIG9yZGVyLCBw
Mm1faW52YWxpZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBw
Mm0tPmRlZmF1bHRfYWNjZXNzKTsKKworICAgICAgICBpZiAoIHJjICkKICAg
ICAgICAgewogICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAqIElmIHRo
aXMgZmFpbHMsIHdlIGNhbid0IHRlbGwgaG93IG11Y2ggb2YgdGhlIHJhbmdl
IHdhcyBjaGFuZ2VkLgpAQCAtNTYxLDcgKzU2MywxMiBAQCBwMm1fcG9kX2Rl
Y3JlYXNlX3Jlc2VydmF0aW9uKHN0cnVjdCBkb21hCiAgICAgICAgICAgICAg
KiBpbXBvc3NpYmxlLgogICAgICAgICAgICAgICovCiAgICAgICAgICAgICBp
ZiAoIG9yZGVyICE9IDAgKQorICAgICAgICAgICAgeworICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfR19FUlIKKyAgICAgICAgICAgICAgICAgICAg
ICAgIiVwZDogbWFya2luZyBHRk4gJSNseCAob3JkZXIgJXUpIGFzIG5vbi1Q
b0QgZmFpbGVkOiAlZFxuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgZCwg
Z2ZuX3goZ2ZuKSwgb3JkZXIsIHJjKTsKICAgICAgICAgICAgICAgICBkb21h
aW5fY3Jhc2goZCk7CisgICAgICAgICAgICB9CiAgICAgICAgICAgICBnb3Rv
IG91dF91bmxvY2s7CiAgICAgICAgIH0KICAgICAgICAgcmV0ID0gMVVMIDw8
IG9yZGVyOwpAQCAtNjcwLDYgKzY3NywyMiBAQCBvdXRfdW5sb2NrOgogICAg
IHJldHVybiByZXQ7CiB9CiAKK3Vuc2lnbmVkIGxvbmcKK3AybV9wb2RfZGVj
cmVhc2VfcmVzZXJ2YXRpb24oc3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2Zu
LCB1bnNpZ25lZCBpbnQgb3JkZXIpCit7CisgICAgdW5zaWduZWQgbG9uZyBs
ZWZ0ID0gMVVMIDw8IG9yZGVyLCByZXQgPSAwOworICAgIHVuc2lnbmVkIGlu
dCBjaHVua19vcmRlciA9IGZpbmRfZmlyc3Rfc2V0X2JpdChnZm5feChnZm4p
IHwgbGVmdCk7CisKKyAgICBkbyB7CisgICAgICAgIHJldCArPSBkZWNyZWFz
ZV9yZXNlcnZhdGlvbihkLCBnZm4sIGNodW5rX29yZGVyKTsKKworICAgICAg
ICBsZWZ0IC09IDFVTCA8PCBjaHVua19vcmRlcjsKKyAgICAgICAgZ2ZuID0g
Z2ZuX2FkZChnZm4sIDFVTCA8PCBjaHVua19vcmRlcik7CisgICAgfSB3aGls
ZSAoIGxlZnQgKTsKKworICAgIHJldHVybiByZXQ7Cit9CisKIHZvaWQgcDJt
X3BvZF9kdW1wX2RhdGEoc3RydWN0IGRvbWFpbiAqZCkKIHsKICAgICBzdHJ1
Y3QgcDJtX2RvbWFpbiAqcDJtID0gcDJtX2dldF9ob3N0cDJtKGQpOwpAQCAt
MTI3MywxOSArMTI5NiwxNSBAQCByZW1hcF9hbmRfcmV0cnk6CiAgICAgcmV0
dXJuIHRydWU7CiB9CiAKLQotaW50Ci1ndWVzdF9waHlzbWFwX21hcmtfcG9w
dWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxv
bmcgZ2ZuX2wsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBvcmRlcikKK3N0YXRpYyBpbnQKK21hcmtfcG9w
dWxhdGVfb25fZGVtYW5kKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxv
bmcgZ2ZuX2wsCisgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBp
bnQgb3JkZXIpCiB7CiAgICAgc3RydWN0IHAybV9kb21haW4gKnAybSA9IHAy
bV9nZXRfaG9zdHAybShkKTsKICAgICBnZm5fdCBnZm4gPSBfZ2ZuKGdmbl9s
KTsKICAgICB1bnNpZ25lZCBsb25nIGksIG4sIHBvZF9jb3VudCA9IDA7CiAg
ICAgaW50IHJjID0gMDsKIAotICAgIGlmICggIXBhZ2luZ19tb2RlX3RyYW5z
bGF0ZShkKSApCi0gICAgICAgIHJldHVybiAtRUlOVkFMOwotCiAgICAgZ2Zu
X2xvY2socDJtLCBnZm4sIG9yZGVyKTsKIAogICAgIFAyTV9ERUJVRygibWFy
ayBwb2QgZ2ZuPSUjbHhcbiIsIGdmbl9sKTsKQEAgLTEzMjUsMTIgKzEzNDQs
NDQgQEAgZ3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVsYXRlX29uX2RlbWFuZChz
dAogCiAgICAgICAgIGlvcmVxX3JlcXVlc3RfbWFwY2FjaGVfaW52YWxpZGF0
ZShkKTsKICAgICB9CisgICAgZWxzZSBpZiAoIG9yZGVyICkKKyAgICB7Cisg
ICAgICAgIC8qCisgICAgICAgICAqIElmIHRoaXMgZmFpbGVkLCB3ZSBjYW4n
dCB0ZWxsIGhvdyBtdWNoIG9mIHRoZSByYW5nZSB3YXMgY2hhbmdlZC4KKyAg
ICAgICAgICogQmVzdCB0byBjcmFzaCB0aGUgZG9tYWluLgorICAgICAgICAg
Ki8KKyAgICAgICAgcHJpbnRrKFhFTkxPR19HX0VSUgorICAgICAgICAgICAg
ICAgIiVwZDogbWFya2luZyBHRk4gJSNseCAob3JkZXIgJXUpIGFzIFBvRCBm
YWlsZWQ6ICVkXG4iLAorICAgICAgICAgICAgICAgZCwgZ2ZuX2wsIG9yZGVy
LCByYyk7CisgICAgICAgIGRvbWFpbl9jcmFzaChkKTsKKyAgICB9CiAKIG91
dDoKICAgICBnZm5fdW5sb2NrKHAybSwgZ2ZuLCBvcmRlcik7CiAKICAgICBy
ZXR1cm4gcmM7CiB9CisKK2ludAorZ3Vlc3RfcGh5c21hcF9tYXJrX3BvcHVs
YXRlX29uX2RlbWFuZChzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25n
IGdmbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dW5zaWduZWQgaW50IG9yZGVyKQoreworICAgIHVuc2lnbmVkIGxvbmcgbGVm
dCA9IDFVTCA8PCBvcmRlcjsKKyAgICB1bnNpZ25lZCBpbnQgY2h1bmtfb3Jk
ZXIgPSBmaW5kX2ZpcnN0X3NldF9iaXQoZ2ZuIHwgbGVmdCk7CisgICAgaW50
IHJjOworCisgICAgaWYgKCAhcGFnaW5nX21vZGVfdHJhbnNsYXRlKGQpICkK
KyAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisKKyAgICBkbyB7CisgICAgICAg
IHJjID0gbWFya19wb3B1bGF0ZV9vbl9kZW1hbmQoZCwgZ2ZuLCBjaHVua19v
cmRlcik7CisKKyAgICAgICAgbGVmdCAtPSAxVUwgPDwgY2h1bmtfb3JkZXI7
CisgICAgICAgIGdmbiArPSAxVUwgPDwgY2h1bmtfb3JkZXI7CisgICAgfSB3
aGlsZSAoICFyYyAmJiBsZWZ0ICk7CisKKyAgICByZXR1cm4gcmM7Cit9CiAK
IHZvaWQgcDJtX3BvZF9pbml0KHN0cnVjdCBwMm1fZG9tYWluICpwMm0pCiB7
Cg==

--=separator
Content-Type: application/octet-stream; name="xsa388-4.15-2.patch"
Content-Disposition: attachment; filename="xsa388-4.15-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUG9EOiBoYW5kbGUgaW50ZXJtZWRpYXRlIHBhZ2Ugb3JkZXJzIGlu
IHAybV9wb2RfY2FjaGVfYWRkKCkKCnAybV9wb2RfZGVjcmVhc2VfcmVzZXJ2
YXRpb24oKSBtYXkgcGFzcyBwYWdlcyB0byB0aGUgZnVuY3Rpb24gd2hpY2gK
YXJlbid0IDRrLCAyTSwgb3IgMUcuIEhhbmRsZSBhbGwgaW50ZXJtZWRpYXRl
IG9yZGVycyBhcyB3ZWxsLCB0byBhdm9pZApoaXR0aW5nIHRoZSBCVUcoKSBh
dCB0aGUgc3dpdGNoKCkgc3RhdGVtZW50J3MgImRlZmF1bHQiIGNhc2UuCgpU
aGlzIGlzIENWRS0yMDIxLTI4NzA4IC8gcGFydCBvZiBYU0EtMzg4LgoKRml4
ZXM6IDNjMzUyMDExYzBkMyAoIng4Ni9Qb0Q6IHNob3J0ZW4gY2VydGFpbiBv
cGVyYXRpb25zIG9uIGhpZ2hlciBvcmRlciByYW5nZXMiKQpTaWduZWQtb2Zm
LWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2Vk
LWJ5OiBSb2dlciBQYXUgTW9ubsOpIDxyb2dlci5wYXVAY2l0cml4LmNvbT4K
Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS9wMm0tcG9kLmMKKysrIGIveGVuL2Fy
Y2gveDg2L21tL3AybS1wb2QuYwpAQCAtMTEyLDE1ICsxMTIsMTMgQEAgcDJt
X3BvZF9jYWNoZV9hZGQoc3RydWN0IHAybV9kb21haW4gKnAybQogICAgIC8q
IFRoZW4gYWRkIHRvIHRoZSBhcHByb3ByaWF0ZSBwb3B1bGF0ZS1vbi1kZW1h
bmQgbGlzdC4gKi8KICAgICBzd2l0Y2ggKCBvcmRlciApCiAgICAgewotICAg
IGNhc2UgUEFHRV9PUkRFUl8xRzoKLSAgICAgICAgZm9yICggaSA9IDA7IGkg
PCAoMVVMIDw8IFBBR0VfT1JERVJfMUcpOyBpICs9IDFVTCA8PCBQQUdFX09S
REVSXzJNICkKKyAgICBjYXNlIFBBR0VfT1JERVJfMk0gLi4uIFBBR0VfT1JE
RVJfMUc6CisgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgKDFVTCA8PCBvcmRl
cik7IGkgKz0gMVVMIDw8IFBBR0VfT1JERVJfMk0gKQogICAgICAgICAgICAg
cGFnZV9saXN0X2FkZF90YWlsKHBhZ2UgKyBpLCAmcDJtLT5wb2Quc3VwZXIp
OwogICAgICAgICBicmVhazsKLSAgICBjYXNlIFBBR0VfT1JERVJfMk06Ci0g
ICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmcDJtLT5wb2Quc3Vw
ZXIpOwotICAgICAgICBicmVhazsKLSAgICBjYXNlIFBBR0VfT1JERVJfNEs6
Ci0gICAgICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlLCAmcDJtLT5wb2Qu
c2luZ2xlKTsKKyAgICBjYXNlIFBBR0VfT1JERVJfNEsgLi4uIFBBR0VfT1JE
RVJfMk0gLSAxOgorICAgICAgICBmb3IgKCBpID0gMDsgaSA8ICgxVUwgPDwg
b3JkZXIpOyBpICs9IDFVTCA8PCBQQUdFX09SREVSXzRLICkKKyAgICAgICAg
ICAgIHBhZ2VfbGlzdF9hZGRfdGFpbChwYWdlICsgaSwgJnAybS0+cG9kLnNp
bmdsZSk7CiAgICAgICAgIGJyZWFrOwogICAgIGRlZmF1bHQ6CiAgICAgICAg
IEJVRygpOwo=

--=separator--


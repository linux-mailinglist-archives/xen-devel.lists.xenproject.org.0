Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 4B674FE604
	for <lists+xen-devel@lfdr.de>; Fri, 15 Nov 2019 20:49:18 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iVhYC-0002LF-3C; Fri, 15 Nov 2019 19:46:36 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=1SQg=ZH=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iVhYA-0002Jy-QQ
 for xen-devel@lists.xenproject.org; Fri, 15 Nov 2019 19:46:35 +0000
X-Inumbo-ID: 761407f4-07e0-11ea-984a-bc764e2007e4
Received: from mail-qk1-x733.google.com (unknown [2607:f8b0:4864:20::733])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 761407f4-07e0-11ea-984a-bc764e2007e4;
 Fri, 15 Nov 2019 19:45:22 +0000 (UTC)
Received: by mail-qk1-x733.google.com with SMTP id i19so9061956qki.2
 for <xen-devel@lists.xenproject.org>; Fri, 15 Nov 2019 11:45:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=ChCdLalS+VOn9D0Tkq8ZoGYVxfZI4uz2HF7GuR2aDfk=;
 b=ebKf5rVvymD0OJGEGGui5NaDkxiDkXZXRdsnu27EOFx8q+X+Ia85fmQ7p5iKMjtFUC
 VnBqMflSiJzmAZADPmHeMis/NWtQQv0NlEx7B4jted2LifayQOEXrsTWmhiGu03g4WK4
 AD8TyJqQJL/rY0W1i8djzbpmgYYfYdAVo1EY6wSFEGvkFTxjx3YZEwobIr06eWkX7ZRY
 RfzJQDmsba1YYLlSuob1AThfT8dkVKwxWvbqsbR/N7aeTthz14Q5uNG3FcziiAJZQvmC
 rGybq5bDmz4NgXNRo8xmHF3DzJZpBGxZsCoOoR+A3hUwVFsdbJXyqbjEPk1iXVN91D6F
 5TJQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=ChCdLalS+VOn9D0Tkq8ZoGYVxfZI4uz2HF7GuR2aDfk=;
 b=N9SyVC+/8NIb/hdfuIwtWbnOoowzAZqA2zE/ibsHh2lP8twxdS82LzOmvjuZr+bTI8
 Kcid9dbsibvhwOJZPbRTrOfbBQMlfGk7KoxPrIug0w2tDQRQluHGoRaHQR7HdHKn1/eH
 shdrhV7V+yi8JGHwZXwRpYy1h+KBgvIx/uASU/ER5LPBgHWTl2IJVCFEW+nmvrtuzv2F
 rmzq1r6ePLfsbX7WUc8aZrEd+xB24HR+oeSZ9M01Lc/yooUF/gKc1rIjb8AoDWPq0paB
 jaZIqDLPM+nXiIgJuGqrupkybIiS9oHT+KoZZMI3GsEzERSGr2EIS/hcFQhBnX4utTvV
 s5qw==
X-Gm-Message-State: APjAAAUKqvMbIC3Vg/29cYr7nVyY8UAVtaJL2A8tFWr/MAW0ddiaJuAA
 VhwD4jsYBdB6p9vrfJY/oYHnDoHv
X-Google-Smtp-Source: APXvYqytTgWi+X0gShJl1C3A68G5QyVV3o0H8ufGw4joP48AgSNMRnSKI+04jHW8gNRprDnjfSik1A==
X-Received: by 2002:a37:4bc2:: with SMTP id y185mr14081651qka.10.1573847120719; 
 Fri, 15 Nov 2019 11:45:20 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id y10sm4649679qkb.55.2019.11.15.11.45.19
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 15 Nov 2019 11:45:19 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 15 Nov 2019 14:44:25 -0500
Message-Id: <326606957641c2e0f9fe2f15553b08cf7ddaedec.1573840474.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1573840473.git.rosbrookn@ainfosec.com>
References: <cover.1573840473.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 18/22] golang/xenlight: begin Go to C type
 marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KCkltcGxlbWVudCBj
b252ZXJzaW9uIG9mIGJhc2ljIHR5cGUgY29udmVyc2lvbnMgc3VjaCBhcyBzdHJpbmdzCmFuZCBp
bnRlZ2VyIHR5cGVzIGluIHRvQyBmdW5jdGlvbnMuCgpTaWduZWQtb2ZmLWJ5OiBOaWNrIFJvc2Jy
b29rIDxyb3Nicm9va25AYWluZm9zZWMuY29tPgotLS0KIHRvb2xzL2dvbGFuZy94ZW5saWdodC9n
ZW5nb3R5cGVzLnB5ICB8ICAgODAgKysKIHRvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdl
bi5nbyB8IDEwMTUgKysrKysrKysrKysrKysrKysrKysrKysrKysKIDIgZmlsZXMgY2hhbmdlZCwg
MTA5NSBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dl
bmdvdHlwZXMucHkgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQppbmRleCA3
MDgzY2NjODcxLi4xNTIyNjMzZjgzIDEwMDY0NAotLS0gYS90b29scy9nb2xhbmcveGVubGlnaHQv
Z2VuZ290eXBlcy5weQorKysgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQpA
QCAtMjQxLDYgKzI0MSw5IEBAIGRlZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJhdGVfaGVscGVycyhw
YXRoID0gTm9uZSwgdHlwZXMgPSBOb25lLCBjb21tZW50ID0gTm9uZSk6CiAgICAgICAgICAgICAg
ICAgZi53cml0ZShleHRyYSkKICAgICAgICAgICAgICAgICBmLndyaXRlKCdcbicpCiAKKyAgICAg
ICAgICAgIGYud3JpdGUoeGVubGlnaHRfZ29sYW5nX2RlZmluZV90b19DKHR5KSkKKyAgICAgICAg
ICAgIGYud3JpdGUoJ1xuJykKKwogICAgIGdvX2ZtdChwYXRoKQogCiBkZWYgeGVubGlnaHRfZ29s
YW5nX2RlZmluZV9mcm9tX0ModHkgPSBOb25lLCB0eXBlbmFtZSA9IE5vbmUsIG5lc3RlZCA9IEZh
bHNlKToKQEAgLTQ3OCw2ICs0ODEsODMgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19hcnJheV9mcm9t
X0ModHkgPSBOb25lKToKIAogICAgIHJldHVybiBzCiAKK2RlZiB4ZW5saWdodF9nb2xhbmdfZGVm
aW5lX3RvX0ModHkgPSBOb25lLCB0eXBlbmFtZSA9IE5vbmUsIG5lc3RlZCA9IEZhbHNlKToKKyAg
ICBzID0gJycKKworICAgIGdvdHlwZW5hbWUgPSBjdHlwZW5hbWUgPSAnJworCisgICAgaWYgdHlw
ZW5hbWUgaXMgbm90IE5vbmU6CisgICAgICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdf
Zm10X25hbWUodHlwZW5hbWUpCisgICAgICAgIGN0eXBlbmFtZSAgPSB0eXBlbmFtZQorICAgIGVs
c2U6CisgICAgICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUodHkudHlw
ZW5hbWUpCisgICAgICAgIGN0eXBlbmFtZSAgPSB0eS50eXBlbmFtZQorCisgICAgaWYgbm90IG5l
c3RlZDoKKyAgICAgICAgcyArPSAnZnVuYyAoeCAqe30pIHRvQygpICh4YyBDLnt9LGVyciBlcnJv
cikge3tcbicuZm9ybWF0KGdvdHlwZW5hbWUsY3R5cGVuYW1lKQorICAgICAgICBzICs9ICdDLnt9
KCZ4YylcbicuZm9ybWF0KHR5LmluaXRfZm4pCisKKyAgICBmb3IgZiBpbiB0eS5maWVsZHM6Cisg
ICAgICAgIGlmIGYudHlwZS50eXBlbmFtZSBpcyBub3QgTm9uZToKKyAgICAgICAgICAgIGlmIGlz
aW5zdGFuY2UoZi50eXBlLCBpZGwuQXJyYXkpOgorICAgICAgICAgICAgICAgICMgVE9ETworICAg
ICAgICAgICAgICAgIGNvbnRpbnVlCisKKyAgICAgICAgICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdo
dF9nb2xhbmdfZm10X25hbWUoZi50eXBlLnR5cGVuYW1lKQorICAgICAgICAgICAgY3R5cGVuYW1l
ICA9IGYudHlwZS50eXBlbmFtZQorICAgICAgICAgICAgZ29mbmFtZSAgICA9IHhlbmxpZ2h0X2dv
bGFuZ19mbXRfbmFtZShmLm5hbWUpCisgICAgICAgICAgICBjZm5hbWUgICAgID0gZi5uYW1lCisK
KyAgICAgICAgICAgICMgSW4gY2dvLCBDIG5hbWVzIHRoYXQgY29uZmxpY3Qgd2l0aCBHbyBrZXl3
b3JkcyBjYW4gYmUKKyAgICAgICAgICAgICMgYWNjZXNzZWQgYnkgcHJlcGVuZGluZyBhbiB1bmRl
cnNjb3JlIHRvIHRoZSBuYW1lLgorICAgICAgICAgICAgaWYgY2ZuYW1lIGluIGdvX2tleXdvcmRz
OgorICAgICAgICAgICAgICAgIGNmbmFtZSA9ICdfJyArIGNmbmFtZQorCisgICAgICAgICAgICAj
IElmIHRoaXMgaXMgbmVzdGVkLCB3ZSBuZWVkIHRoZSBvdXRlciBuYW1lIHRvby4KKyAgICAgICAg
ICAgIGlmIG5lc3RlZCBhbmQgdHlwZW5hbWUgaXMgbm90IE5vbmU6CisgICAgICAgICAgICAgICAg
Z29uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKHR5cGVuYW1lKQorICAgICAgICAgICAg
ICAgIGdvbmFtZSA9ICd7fS57fScuZm9ybWF0KGdvbmFtZSwgZ29mbmFtZSkKKyAgICAgICAgICAg
ICAgICBjbmFtZSAgPSAne30ue30nLmZvcm1hdCh0eXBlbmFtZSwgY2ZuYW1lKQorCisgICAgICAg
ICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdvbmFtZSA9IGdvZm5hbWUKKyAgICAgICAgICAg
ICAgICBjbmFtZSAgPSBjZm5hbWUKKworICAgICAgICAgICAgaXNfY2FzdGFibGUgPSAoZi50eXBl
Lmpzb25fcGFyc2VfdHlwZSA9PSAnSlNPTl9JTlRFR0VSJyBvcgorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5FbnVtZXJhdGlvbikgb3IKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGdvdHlwZW5hbWUgaW4gZ29fYnVpbHRpbl90eXBlcykKKworICAg
ICAgICAgICAgaWYgaXNfY2FzdGFibGU6CisgICAgICAgICAgICAgICAgIyBVc2UgdGhlIGNnbyBo
ZWxwZXIgZm9yIGNvbnZlcnRpbmcgQyBzdHJpbmdzLgorICAgICAgICAgICAgICAgIGlmIGdvdHlw
ZW5hbWUgPT0gJ3N0cmluZyc6CisgICAgICAgICAgICAgICAgICAgIHMgKz0gJ3hjLnt9ID0gQy5D
U3RyaW5nKHgue30pXG4nLmZvcm1hdChjbmFtZSxnb25hbWUpCisgICAgICAgICAgICAgICAgICAg
IGNvbnRpbnVlCisKKyAgICAgICAgICAgICAgICBzICs9ICd4Yy57fSA9IEMue30oeC57fSlcbicu
Zm9ybWF0KGNuYW1lLGN0eXBlbmFtZSxnb25hbWUpCisKKyAgICAgICAgICAgIGVsc2U6CisgICAg
ICAgICAgICAgICAgcyArPSAneGMue30sIGVyciA9IHgue30udG9DKClcbicuZm9ybWF0KGNuYW1l
LGdvbmFtZSkKKyAgICAgICAgICAgICAgICBzICs9ICdpZiBlcnIgIT0gbmlsIHtcbicKKyAgICAg
ICAgICAgICAgICBzICs9ICdDLnt9KCZ4YylcbicuZm9ybWF0KHR5LmRpc3Bvc2VfZm4pCisgICAg
ICAgICAgICAgICAgcyArPSAncmV0dXJuIHhjLCBlcnJcbicKKyAgICAgICAgICAgICAgICBzICs9
ICd9XG4nCisKKyAgICAgICAgZWxpZiBpc2luc3RhbmNlKGYudHlwZSwgaWRsLlN0cnVjdCk6Cisg
ICAgICAgICAgICBzICs9IHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfdG9fQyhmLnR5cGUsIHR5cGVu
YW1lPWYubmFtZSwgbmVzdGVkPVRydWUpCisKKyAgICAgICAgZWxpZiBpc2luc3RhbmNlKGYudHlw
ZSwgaWRsLktleWVkVW5pb24pOgorICAgICAgICAgICAgIyBUT0RPCisgICAgICAgICAgICBwYXNz
CisKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigndHlwZSB7fSBu
b3Qgc3VwcG9ydGVkJy5mb3JtYXQoZi50eXBlKSkKKworICAgIGlmIG5vdCBuZXN0ZWQ6CisgICAg
ICAgIHMgKz0gJ3JldHVybiB4YywgbmlsJworICAgICAgICBzICs9ICd9XG4nCisKKyAgICByZXR1
cm4gcworCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG5hbWUsIGV4cG9ydGVkID0gVHJ1
ZSk6CiAgICAgIiIiCiAgICAgVGFrZSBhIGdpdmVuIHR5cGUgbmFtZSBhbmQgcmV0dXJuIGFuCmRp
ZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28gYi90b29scy9n
b2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5kZXggYWJkYmFlMWRjNy4uNDk1NjAxZjcz
OCAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvCisrKyBi
L3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwpAQCAtMTMwLDYgKzEzMCwxMyBA
QCBmdW5jICh4ICpJb3BvcnRSYW5nZSkgZnJvbUMoeGMgKkMubGlieGxfaW9wb3J0X3JhbmdlKSBl
cnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpJb3BvcnRSYW5nZSkgdG9DKCkgKHhj
IEMubGlieGxfaW9wb3J0X3JhbmdlLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2lvcG9ydF9yYW5n
ZV9pbml0KCZ4YykKKwl4Yy5maXJzdCA9IEMudWludDMyX3QoeC5GaXJzdCkKKwl4Yy5udW1iZXIg
PSBDLnVpbnQzMl90KHguTnVtYmVyKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKklv
bWVtUmFuZ2UpIGZyb21DKHhjICpDLmxpYnhsX2lvbWVtX3JhbmdlKSBlcnJvciB7CiAJeC5TdGFy
dCA9IHVpbnQ2NCh4Yy5zdGFydCkKIAl4Lk51bWJlciA9IHVpbnQ2NCh4Yy5udW1iZXIpCkBAIC0x
MzcsMTEgKzE0NCwyNSBAQCBmdW5jICh4ICpJb21lbVJhbmdlKSBmcm9tQyh4YyAqQy5saWJ4bF9p
b21lbV9yYW5nZSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqSW9tZW1SYW5n
ZSkgdG9DKCkgKHhjIEMubGlieGxfaW9tZW1fcmFuZ2UsIGVyciBlcnJvcikgeworCUMubGlieGxf
aW9tZW1fcmFuZ2VfaW5pdCgmeGMpCisJeGMuc3RhcnQgPSBDLnVpbnQ2NF90KHguU3RhcnQpCisJ
eGMubnVtYmVyID0gQy51aW50NjRfdCh4Lk51bWJlcikKKwl4Yy5nZm4gPSBDLnVpbnQ2NF90KHgu
R2ZuKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZnYUludGVyZmFjZUluZm8pIGZy
b21DKHhjICpDLmxpYnhsX3ZnYV9pbnRlcmZhY2VfaW5mbykgZXJyb3IgewogCXguS2luZCA9IFZn
YUludGVyZmFjZVR5cGUoeGMua2luZCkKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZnYUlu
dGVyZmFjZUluZm8pIHRvQygpICh4YyBDLmxpYnhsX3ZnYV9pbnRlcmZhY2VfaW5mbywgZXJyIGVy
cm9yKSB7CisJQy5saWJ4bF92Z2FfaW50ZXJmYWNlX2luZm9faW5pdCgmeGMpCisJeGMua2luZCA9
IEMubGlieGxfdmdhX2ludGVyZmFjZV90eXBlKHguS2luZCkKKwlyZXR1cm4geGMsIG5pbAorfQor
CiBmdW5jICh4ICpWbmNJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bmNfaW5mbykgZXJyb3Igewog
CXZhciBkZWZib29sRW5hYmxlIERlZmJvb2wKIAlpZiBlcnIgOj0gZGVmYm9vbEVuYWJsZS5mcm9t
QygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7CkBAIC0xNTksNiArMTgwLDI0IEBAIGZ1bmMgKHgg
KlZuY0luZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpWbmNJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92bmNfaW5mbywgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF92bmNfaW5mb19pbml0KCZ4YykKKwl4Yy5lbmFibGUsIGVyciA9
IHguRW5hYmxlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdm5jX2luZm9fZGlz
cG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmxpc3RlbiA9IEMuQ1N0cmluZyh4
Lkxpc3RlbikKKwl4Yy5wYXNzd2QgPSBDLkNTdHJpbmcoeC5QYXNzd2QpCisJeGMuZGlzcGxheSA9
IEMuaW50KHguRGlzcGxheSkKKwl4Yy5maW5kdW51c2VkLCBlcnIgPSB4LkZpbmR1bnVzZWQudG9D
KCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF92bmNfaW5mb19kaXNwb3NlKCZ4YykKKwkJ
cmV0dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqU3BpY2VJ
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zcGljZV9pbmZvKSBlcnJvciB7CiAJdmFyIGRlZmJvb2xF
bmFibGUgRGVmYm9vbAogCWlmIGVyciA6PSBkZWZib29sRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUp
OyBlcnIgIT0gbmlsIHsKQEAgLTE5NSw2ICsyMzQsNDMgQEAgZnVuYyAoeCAqU3BpY2VJbmZvKSBm
cm9tQyh4YyAqQy5saWJ4bF9zcGljZV9pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpTcGljZUluZm8pIHRvQygpICh4YyBDLmxpYnhsX3NwaWNlX2luZm8sIGVyciBlcnJv
cikgeworCUMubGlieGxfc3BpY2VfaW5mb19pbml0KCZ4YykKKwl4Yy5lbmFibGUsIGVyciA9IHgu
RW5hYmxlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfc3BpY2VfaW5mb19kaXNw
b3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMucG9ydCA9IEMuaW50KHguUG9ydCkK
Kwl4Yy50bHNfcG9ydCA9IEMuaW50KHguVGxzUG9ydCkKKwl4Yy5ob3N0ID0gQy5DU3RyaW5nKHgu
SG9zdCkKKwl4Yy5kaXNhYmxlX3RpY2tldGluZywgZXJyID0geC5EaXNhYmxlVGlja2V0aW5nLnRv
QygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfc3BpY2VfaW5mb19kaXNwb3NlKCZ4YykK
KwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMucGFzc3dkID0gQy5DU3RyaW5nKHguUGFzc3dkKQor
CXhjLmFnZW50X21vdXNlLCBlcnIgPSB4LkFnZW50TW91c2UudG9DKCkKKwlpZiBlcnIgIT0gbmls
IHsKKwkJQy5saWJ4bF9zcGljZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy52ZGFnZW50LCBlcnIgPSB4LlZkYWdlbnQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsK
KwkJQy5saWJ4bF9zcGljZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0K
Kwl4Yy5jbGlwYm9hcmRfc2hhcmluZywgZXJyID0geC5DbGlwYm9hcmRTaGFyaW5nLnRvQygpCisJ
aWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfc3BpY2VfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0
dXJuIHhjLCBlcnIKKwl9CisJeGMudXNicmVkaXJlY3Rpb24gPSBDLmludCh4LlVzYnJlZGlyZWN0
aW9uKQorCXhjLmltYWdlX2NvbXByZXNzaW9uID0gQy5DU3RyaW5nKHguSW1hZ2VDb21wcmVzc2lv
bikKKwl4Yy5zdHJlYW1pbmdfdmlkZW8gPSBDLkNTdHJpbmcoeC5TdHJlYW1pbmdWaWRlbykKKwly
ZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpTZGxJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9z
ZGxfaW5mbykgZXJyb3IgewogCXZhciBkZWZib29sRW5hYmxlIERlZmJvb2wKIAlpZiBlcnIgOj0g
ZGVmYm9vbEVuYWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7CkBAIC0yMTEsNiAr
Mjg3LDIzIEBAIGZ1bmMgKHggKlNkbEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3NkbF9pbmZvKSBl
cnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpTZGxJbmZvKSB0b0MoKSAoeGMgQy5s
aWJ4bF9zZGxfaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9zZGxfaW5mb19pbml0KCZ4YykK
Kwl4Yy5lbmFibGUsIGVyciA9IHguRW5hYmxlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMu
bGlieGxfc2RsX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLm9w
ZW5nbCwgZXJyID0geC5PcGVuZ2wudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9z
ZGxfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZGlzcGxheSA9
IEMuQ1N0cmluZyh4LkRpc3BsYXkpCisJeGMueGF1dGhvcml0eSA9IEMuQ1N0cmluZyh4LlhhdXRo
b3JpdHkpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRG9taW5mbykgZnJvbUMoeGMg
KkMubGlieGxfZG9taW5mbykgZXJyb3IgewogCXZhciB1dWlkVXVpZCBVdWlkCiAJaWYgZXJyIDo9
IHV1aWRVdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CkBAIC0yNDAsNiArMzMzLDM2
IEBAIGZ1bmMgKHggKkRvbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWluZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWluZm8pIHRvQygpICh4YyBDLmxpYnhsX2Rv
bWluZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfZG9taW5mb19pbml0KCZ4YykKKwl4Yy51dWlk
LCBlcnIgPSB4LlV1aWQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21pbmZv
X2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5kb21pZCA9IEMubGlieGxf
ZG9taWQoeC5Eb21pZCkKKwl4Yy5zc2lkcmVmID0gQy51aW50MzJfdCh4LlNzaWRyZWYpCisJeGMu
c3NpZF9sYWJlbCA9IEMuQ1N0cmluZyh4LlNzaWRMYWJlbCkKKwl4Yy5ydW5uaW5nID0gQy5ib29s
KHguUnVubmluZykKKwl4Yy5ibG9ja2VkID0gQy5ib29sKHguQmxvY2tlZCkKKwl4Yy5wYXVzZWQg
PSBDLmJvb2woeC5QYXVzZWQpCisJeGMuc2h1dGRvd24gPSBDLmJvb2woeC5TaHV0ZG93bikKKwl4
Yy5keWluZyA9IEMuYm9vbCh4LkR5aW5nKQorCXhjLm5ldmVyX3N0b3AgPSBDLmJvb2woeC5OZXZl
clN0b3ApCisJeGMuc2h1dGRvd25fcmVhc29uID0gQy5saWJ4bF9zaHV0ZG93bl9yZWFzb24oeC5T
aHV0ZG93blJlYXNvbikKKwl4Yy5vdXRzdGFuZGluZ19tZW1rYiA9IEMudWludDY0X3QoeC5PdXRz
dGFuZGluZ01lbWtiKQorCXhjLmN1cnJlbnRfbWVta2IgPSBDLnVpbnQ2NF90KHguQ3VycmVudE1l
bWtiKQorCXhjLnNoYXJlZF9tZW1rYiA9IEMudWludDY0X3QoeC5TaGFyZWRNZW1rYikKKwl4Yy5w
YWdlZF9tZW1rYiA9IEMudWludDY0X3QoeC5QYWdlZE1lbWtiKQorCXhjLm1heF9tZW1rYiA9IEMu
dWludDY0X3QoeC5NYXhNZW1rYikKKwl4Yy5jcHVfdGltZSA9IEMudWludDY0X3QoeC5DcHVUaW1l
KQorCXhjLnZjcHVfbWF4X2lkID0gQy51aW50MzJfdCh4LlZjcHVNYXhJZCkKKwl4Yy52Y3B1X29u
bGluZSA9IEMudWludDMyX3QoeC5WY3B1T25saW5lKQorCXhjLmNwdXBvb2wgPSBDLnVpbnQzMl90
KHguQ3B1cG9vbCkKKwl4Yy5kb21haW5fdHlwZSA9IEMubGlieGxfZG9tYWluX3R5cGUoeC5Eb21h
aW5UeXBlKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkNwdXBvb2xpbmZvKSBmcm9t
Qyh4YyAqQy5saWJ4bF9jcHVwb29saW5mbykgZXJyb3IgewogCXguUG9vbGlkID0gdWludDMyKHhj
LnBvb2xpZCkKIAl4LlBvb2xOYW1lID0gQy5Hb1N0cmluZyh4Yy5wb29sX25hbWUpCkBAIC0yNTMs
NiArMzc2LDIwIEBAIGZ1bmMgKHggKkNwdXBvb2xpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jcHVw
b29saW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqQ3B1cG9vbGluZm8p
IHRvQygpICh4YyBDLmxpYnhsX2NwdXBvb2xpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2Nw
dXBvb2xpbmZvX2luaXQoJnhjKQorCXhjLnBvb2xpZCA9IEMudWludDMyX3QoeC5Qb29saWQpCisJ
eGMucG9vbF9uYW1lID0gQy5DU3RyaW5nKHguUG9vbE5hbWUpCisJeGMuc2NoZWQgPSBDLmxpYnhs
X3NjaGVkdWxlcih4LlNjaGVkKQorCXhjLm5fZG9tID0gQy51aW50MzJfdCh4Lk5Eb20pCisJeGMu
Y3B1bWFwLCBlcnIgPSB4LkNwdW1hcC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhs
X2NwdXBvb2xpbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwlyZXR1cm4g
eGMsIG5pbAorfQorCiBmdW5jICh4ICpDaGFubmVsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfY2hh
bm5lbGluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJ
eC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTI4Niw2ICs0MjMsMTkgQEAg
ZnVuYyAoeCAqQ2hhbm5lbGluZm9Db25uZWN0aW9uVW5pb25QdHkpIGZyb21DKHhjICpDLmxpYnhs
X2NoYW5uZWxpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpDaGFubmVs
aW5mbykgdG9DKCkgKHhjIEMubGlieGxfY2hhbm5lbGluZm8sIGVyciBlcnJvcikgeworCUMubGli
eGxfY2hhbm5lbGluZm9faW5pdCgmeGMpCisJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tl
bmQpCisJeGMuYmFja2VuZF9pZCA9IEMudWludDMyX3QoeC5CYWNrZW5kSWQpCisJeGMuZnJvbnRl
bmQgPSBDLkNTdHJpbmcoeC5Gcm9udGVuZCkKKwl4Yy5mcm9udGVuZF9pZCA9IEMudWludDMyX3Qo
eC5Gcm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLnN0
YXRlID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0Y2gpCisJeGMucnJl
ZiA9IEMuaW50KHguUnJlZikKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWbWluZm8p
IGZyb21DKHhjICpDLmxpYnhsX3ZtaW5mbykgZXJyb3IgewogCXZhciB1dWlkVXVpZCBVdWlkCiAJ
aWYgZXJyIDo9IHV1aWRVdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CkBAIC0yOTYs
NiArNDQ2LDE3IEBAIGZ1bmMgKHggKlZtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm1pbmZvKSBl
cnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWbWluZm8pIHRvQygpICh4YyBDLmxp
YnhsX3ZtaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92bWluZm9faW5pdCgmeGMpCisJeGMu
dXVpZCwgZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdm1p
bmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5kb21pZCA9IEMubGli
eGxfZG9taWQoeC5Eb21pZCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWZXJzaW9u
SW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmVyc2lvbl9pbmZvKSBlcnJvciB7CiAJeC5YZW5WZXJz
aW9uTWFqb3IgPSBpbnQoeGMueGVuX3ZlcnNpb25fbWFqb3IpCiAJeC5YZW5WZXJzaW9uTWlub3Ig
PSBpbnQoeGMueGVuX3ZlcnNpb25fbWlub3IpCkBAIC0zMTMsNiArNDc0LDI0IEBAIGZ1bmMgKHgg
KlZlcnNpb25JbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92ZXJzaW9uX2luZm8pIGVycm9yIHsKIAly
ZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZlcnNpb25JbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92
ZXJzaW9uX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfdmVyc2lvbl9pbmZvX2luaXQoJnhj
KQorCXhjLnhlbl92ZXJzaW9uX21ham9yID0gQy5pbnQoeC5YZW5WZXJzaW9uTWFqb3IpCisJeGMu
eGVuX3ZlcnNpb25fbWlub3IgPSBDLmludCh4LlhlblZlcnNpb25NaW5vcikKKwl4Yy54ZW5fdmVy
c2lvbl9leHRyYSA9IEMuQ1N0cmluZyh4LlhlblZlcnNpb25FeHRyYSkKKwl4Yy5jb21waWxlciA9
IEMuQ1N0cmluZyh4LkNvbXBpbGVyKQorCXhjLmNvbXBpbGVfYnkgPSBDLkNTdHJpbmcoeC5Db21w
aWxlQnkpCisJeGMuY29tcGlsZV9kb21haW4gPSBDLkNTdHJpbmcoeC5Db21waWxlRG9tYWluKQor
CXhjLmNvbXBpbGVfZGF0ZSA9IEMuQ1N0cmluZyh4LkNvbXBpbGVEYXRlKQorCXhjLmNhcGFiaWxp
dGllcyA9IEMuQ1N0cmluZyh4LkNhcGFiaWxpdGllcykKKwl4Yy5jaGFuZ2VzZXQgPSBDLkNTdHJp
bmcoeC5DaGFuZ2VzZXQpCisJeGMudmlydF9zdGFydCA9IEMudWludDY0X3QoeC5WaXJ0U3RhcnQp
CisJeGMucGFnZXNpemUgPSBDLmludCh4LlBhZ2VzaXplKQorCXhjLmNvbW1hbmRsaW5lID0gQy5D
U3RyaW5nKHguQ29tbWFuZGxpbmUpCisJeGMuYnVpbGRfaWQgPSBDLkNTdHJpbmcoeC5CdWlsZElk
KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIGZyb21D
KHhjICpDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbykgZXJyb3IgewogCXguVHlwZSA9IERvbWFp
blR5cGUoeGMuX3R5cGUpCiAJdmFyIGRlZmJvb2xIYXAgRGVmYm9vbApAQCAtMzU5LDYgKzUzOCw1
MyBAQCBmdW5jICh4ICpEb21haW5DcmVhdGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5f
Y3JlYXRlX2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFpbkNy
ZWF0ZUluZm8pIHRvQygpICh4YyBDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbywgZXJyIGVycm9y
KSB7CisJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9faW5pdCgmeGMpCisJeGMuX3R5cGUgPSBD
LmxpYnhsX2RvbWFpbl90eXBlKHguVHlwZSkKKwl4Yy5oYXAsIGVyciA9IHguSGFwLnRvQygpCisJ
aWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2UoJnhj
KQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5vb3MsIGVyciA9IHguT29zLnRvQygpCisJaWYg
ZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2UoJnhjKQor
CQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5zc2lkcmVmID0gQy51aW50MzJfdCh4LlNzaWRyZWYp
CisJeGMuc3NpZF9sYWJlbCA9IEMuQ1N0cmluZyh4LlNzaWRMYWJlbCkKKwl4Yy5uYW1lID0gQy5D
U3RyaW5nKHguTmFtZSkKKwl4Yy51dWlkLCBlcnIgPSB4LlV1aWQudG9DKCkKKwlpZiBlcnIgIT0g
bmlsIHsKKwkJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVy
biB4YywgZXJyCisJfQorCXhjLnhzZGF0YSwgZXJyID0geC5Yc2RhdGEudG9DKCkKKwlpZiBlcnIg
IT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJl
dHVybiB4YywgZXJyCisJfQorCXhjLnBsYXRmb3JtZGF0YSwgZXJyID0geC5QbGF0Zm9ybWRhdGEu
dG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9fZGlz
cG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnBvb2xpZCA9IEMudWludDMyX3Qo
eC5Qb29saWQpCisJeGMucG9vbF9uYW1lID0gQy5DU3RyaW5nKHguUG9vbE5hbWUpCisJeGMucnVu
X2hvdHBsdWdfc2NyaXB0cywgZXJyID0geC5SdW5Ib3RwbHVnU2NyaXB0cy50b0MoKQorCWlmIGVy
ciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mb19kaXNwb3NlKCZ4YykKKwkJ
cmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZHJpdmVyX2RvbWFpbiwgZXJyID0geC5Ecml2ZXJEb21h
aW4udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fY3JlYXRlX2luZm9f
ZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnBhc3N0aHJvdWdoID0gQy5s
aWJ4bF9wYXNzdGhyb3VnaCh4LlBhc3N0aHJvdWdoKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1
bmMgKHggKkRvbWFpblJlc3RvcmVQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZXN0
b3JlX3BhcmFtcykgZXJyb3IgewogCXguQ2hlY2twb2ludGVkU3RyZWFtID0gaW50KHhjLmNoZWNr
cG9pbnRlZF9zdHJlYW0pCiAJeC5TdHJlYW1WZXJzaW9uID0gdWludDMyKHhjLnN0cmVhbV92ZXJz
aW9uKQpAQCAtMzcxLDYgKzU5NywxOSBAQCBmdW5jICh4ICpEb21haW5SZXN0b3JlUGFyYW1zKSBm
cm9tQyh4YyAqQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFpblJlc3RvcmVQYXJhbXMpIHRvQygpICh4YyBDLmxpYnhs
X2RvbWFpbl9yZXN0b3JlX3BhcmFtcywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kb21haW5fcmVz
dG9yZV9wYXJhbXNfaW5pdCgmeGMpCisJeGMuY2hlY2twb2ludGVkX3N0cmVhbSA9IEMuaW50KHgu
Q2hlY2twb2ludGVkU3RyZWFtKQorCXhjLnN0cmVhbV92ZXJzaW9uID0gQy51aW50MzJfdCh4LlN0
cmVhbVZlcnNpb24pCisJeGMuY29sb19wcm94eV9zY3JpcHQgPSBDLkNTdHJpbmcoeC5Db2xvUHJv
eHlTY3JpcHQpCisJeGMudXNlcnNwYWNlX2NvbG9fcHJveHksIGVyciA9IHguVXNlcnNwYWNlQ29s
b1Byb3h5LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3Jlc3RvcmVf
cGFyYW1zX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpTY2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfcGFy
YW1zKSBlcnJvciB7CiAJeC5WY3B1aWQgPSBpbnQoeGMudmNwdWlkKQogCXguV2VpZ2h0ID0gaW50
KHhjLndlaWdodCkKQEAgLTM4MSw2ICs2MjAsMTcgQEAgZnVuYyAoeCAqU2NoZWRQYXJhbXMpIGZy
b21DKHhjICpDLmxpYnhsX3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAor
ZnVuYyAoeCAqU2NoZWRQYXJhbXMpIHRvQygpICh4YyBDLmxpYnhsX3NjaGVkX3BhcmFtcywgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9zY2hlZF9wYXJhbXNfaW5pdCgmeGMpCisJeGMudmNwdWlkID0g
Qy5pbnQoeC5WY3B1aWQpCisJeGMud2VpZ2h0ID0gQy5pbnQoeC5XZWlnaHQpCisJeGMuY2FwID0g
Qy5pbnQoeC5DYXApCisJeGMucGVyaW9kID0gQy5pbnQoeC5QZXJpb2QpCisJeGMuZXh0cmF0aW1l
ID0gQy5pbnQoeC5FeHRyYXRpbWUpCisJeGMuYnVkZ2V0ID0gQy5pbnQoeC5CdWRnZXQpCisJcmV0
dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5s
aWJ4bF92Y3B1X3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMu
c2NoZWQpCiAJbnVtVmNwdXMgOj0gaW50KHhjLm51bV92Y3B1cykKQEAgLTM5Niw2ICs2NDYsMTIg
QEAgZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92Y3B1X3NjaGVk
X3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVmNwdVNjaGVkUGFy
YW1zKSB0b0MoKSAoeGMgQy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFtcywgZXJyIGVycm9yKSB7CisJ
Qy5saWJ4bF92Y3B1X3NjaGVkX3BhcmFtc19pbml0KCZ4YykKKwl4Yy5zY2hlZCA9IEMubGlieGxf
c2NoZWR1bGVyKHguU2NoZWQpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRG9tYWlu
U2NoZWRQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXMpIGVycm9y
IHsKIAl4LlNjaGVkID0gU2NoZWR1bGVyKHhjLnNjaGVkKQogCXguV2VpZ2h0ID0gaW50KHhjLndl
aWdodCkKQEAgLTQwOCw2ICs2NjQsMTkgQEAgZnVuYyAoeCAqRG9tYWluU2NoZWRQYXJhbXMpIGZy
b21DKHhjICpDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4gbmls
CiB9CiAKK2Z1bmMgKHggKkRvbWFpblNjaGVkUGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21h
aW5fc2NoZWRfcGFyYW1zLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RvbWFpbl9zY2hlZF9wYXJh
bXNfaW5pdCgmeGMpCisJeGMuc2NoZWQgPSBDLmxpYnhsX3NjaGVkdWxlcih4LlNjaGVkKQorCXhj
LndlaWdodCA9IEMuaW50KHguV2VpZ2h0KQorCXhjLmNhcCA9IEMuaW50KHguQ2FwKQorCXhjLnBl
cmlvZCA9IEMuaW50KHguUGVyaW9kKQorCXhjLmJ1ZGdldCA9IEMuaW50KHguQnVkZ2V0KQorCXhj
LmV4dHJhdGltZSA9IEMuaW50KHguRXh0cmF0aW1lKQorCXhjLnNsaWNlID0gQy5pbnQoeC5TbGlj
ZSkKKwl4Yy5sYXRlbmN5ID0gQy5pbnQoeC5MYXRlbmN5KQorCXJldHVybiB4YywgbmlsCit9CisK
IGZ1bmMgKHggKlZub2RlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm5vZGVfaW5mbykgZXJyb3Ig
ewogCXguTWVta2IgPSB1aW50NjQoeGMubWVta2IpCiAJbnVtRGlzdGFuY2VzIDo9IGludCh4Yy5u
dW1fZGlzdGFuY2VzKQpAQCAtNDI1LDEyICs2OTQsMzEgQEAgZnVuYyAoeCAqVm5vZGVJbmZvKSBm
cm9tQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpWbm9kZUluZm8pIHRvQygpICh4YyBDLmxpYnhsX3Zub2RlX2luZm8sIGVyciBlcnJv
cikgeworCUMubGlieGxfdm5vZGVfaW5mb19pbml0KCZ4YykKKwl4Yy5tZW1rYiA9IEMudWludDY0
X3QoeC5NZW1rYikKKwl4Yy5wbm9kZSA9IEMudWludDMyX3QoeC5Qbm9kZSkKKwl4Yy52Y3B1cywg
ZXJyID0geC5WY3B1cy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3Zub2RlX2lu
Zm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4YywgbmlsCit9
CisKIGZ1bmMgKHggKlJkbVJlc2VydmUpIGZyb21DKHhjICpDLmxpYnhsX3JkbV9yZXNlcnZlKSBl
cnJvciB7CiAJeC5TdHJhdGVneSA9IFJkbVJlc2VydmVTdHJhdGVneSh4Yy5zdHJhdGVneSkKIAl4
LlBvbGljeSA9IFJkbVJlc2VydmVQb2xpY3koeGMucG9saWN5KQogCXJldHVybiBuaWwKIH0KIAor
ZnVuYyAoeCAqUmRtUmVzZXJ2ZSkgdG9DKCkgKHhjIEMubGlieGxfcmRtX3Jlc2VydmUsIGVyciBl
cnJvcikgeworCUMubGlieGxfcmRtX3Jlc2VydmVfaW5pdCgmeGMpCisJeGMuc3RyYXRlZ3kgPSBD
LmxpYnhsX3JkbV9yZXNlcnZlX3N0cmF0ZWd5KHguU3RyYXRlZ3kpCisJeGMucG9saWN5ID0gQy5s
aWJ4bF9yZG1fcmVzZXJ2ZV9wb2xpY3koeC5Qb2xpY3kpCisJcmV0dXJuIHhjLCBuaWwKK30KKwog
ZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mbykgZXJyb3IgewogCXguTWF4VmNwdXMgPSBpbnQoeGMubWF4X3ZjcHVzKQogCXZhciBiaXRt
YXBBdmFpbFZjcHVzIEJpdG1hcApAQCAtNzc4LDYgKzEwNjYsMTMwIEBAIGZ1bmMgKHggKkRvbWFp
bkJ1aWxkSW5mb1R5cGVVbmlvblB2aCkgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2lu
Zm8pIGVycm9yCiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRv
QygpICh4YyBDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhs
X2RvbWFpbl9idWlsZF9pbmZvX2luaXQoJnhjKQorCXhjLm1heF92Y3B1cyA9IEMuaW50KHguTWF4
VmNwdXMpCisJeGMuYXZhaWxfdmNwdXMsIGVyciA9IHguQXZhaWxWY3B1cy50b0MoKQorCWlmIGVy
ciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQly
ZXR1cm4geGMsIGVycgorCX0KKwl4Yy5jcHVtYXAsIGVyciA9IHguQ3B1bWFwLnRvQygpCisJaWYg
ZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJ
CXJldHVybiB4YywgZXJyCisJfQorCXhjLm5vZGVtYXAsIGVyciA9IHguTm9kZW1hcC50b0MoKQor
CWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhj
KQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5udW1hX3BsYWNlbWVudCwgZXJyID0geC5OdW1h
UGxhY2VtZW50LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxk
X2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnRzY19tb2RlID0g
Qy5saWJ4bF90c2NfbW9kZSh4LlRzY01vZGUpCisJeGMubWF4X21lbWtiID0gQy51aW50NjRfdCh4
Lk1heE1lbWtiKQorCXhjLnRhcmdldF9tZW1rYiA9IEMudWludDY0X3QoeC5UYXJnZXRNZW1rYikK
Kwl4Yy52aWRlb19tZW1rYiA9IEMudWludDY0X3QoeC5WaWRlb01lbWtiKQorCXhjLnNoYWRvd19t
ZW1rYiA9IEMudWludDY0X3QoeC5TaGFkb3dNZW1rYikKKwl4Yy5pb21tdV9tZW1rYiA9IEMudWlu
dDY0X3QoeC5Jb21tdU1lbWtiKQorCXhjLnJ0Y190aW1lb2Zmc2V0ID0gQy51aW50MzJfdCh4LlJ0
Y1RpbWVvZmZzZXQpCisJeGMuZXhlY19zc2lkcmVmID0gQy51aW50MzJfdCh4LkV4ZWNTc2lkcmVm
KQorCXhjLmV4ZWNfc3NpZF9sYWJlbCA9IEMuQ1N0cmluZyh4LkV4ZWNTc2lkTGFiZWwpCisJeGMu
bG9jYWx0aW1lLCBlcnIgPSB4LkxvY2FsdGltZS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlD
LmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy5kaXNhYmxlX21pZ3JhdGUsIGVyciA9IHguRGlzYWJsZU1pZ3JhdGUudG9DKCkKKwlp
ZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykK
KwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY3B1aWQsIGVyciA9IHguQ3B1aWQudG9DKCkKKwlp
ZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykK
KwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuYmxrZGV2X3N0YXJ0ID0gQy5DU3RyaW5nKHguQmxr
ZGV2U3RhcnQpCisJeGMubWF4X2dyYW50X2ZyYW1lcyA9IEMudWludDMyX3QoeC5NYXhHcmFudEZy
YW1lcykKKwl4Yy5tYXhfbWFwdHJhY2tfZnJhbWVzID0gQy51aW50MzJfdCh4Lk1heE1hcHRyYWNr
RnJhbWVzKQorCXhjLmRldmljZV9tb2RlbF92ZXJzaW9uID0gQy5saWJ4bF9kZXZpY2VfbW9kZWxf
dmVyc2lvbih4LkRldmljZU1vZGVsVmVyc2lvbikKKwl4Yy5kZXZpY2VfbW9kZWxfc3R1YmRvbWFp
biwgZXJyID0geC5EZXZpY2VNb2RlbFN0dWJkb21haW4udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsK
KwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBl
cnIKKwl9CisJeGMuZGV2aWNlX21vZGVsID0gQy5DU3RyaW5nKHguRGV2aWNlTW9kZWwpCisJeGMu
ZGV2aWNlX21vZGVsX3NzaWRyZWYgPSBDLnVpbnQzMl90KHguRGV2aWNlTW9kZWxTc2lkcmVmKQor
CXhjLmRldmljZV9tb2RlbF9zc2lkX2xhYmVsID0gQy5DU3RyaW5nKHguRGV2aWNlTW9kZWxTc2lk
TGFiZWwpCisJeGMuZGV2aWNlX21vZGVsX3VzZXIgPSBDLkNTdHJpbmcoeC5EZXZpY2VNb2RlbFVz
ZXIpCisJeGMuZXh0cmEsIGVyciA9IHguRXh0cmEudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJ
Qy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIK
Kwl9CisJeGMuZXh0cmFfcHYsIGVyciA9IHguRXh0cmFQdi50b0MoKQorCWlmIGVyciAhPSBuaWwg
eworCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMs
IGVycgorCX0KKwl4Yy5leHRyYV9odm0sIGVyciA9IHguRXh0cmFIdm0udG9DKCkKKwlpZiBlcnIg
IT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0
dXJuIHhjLCBlcnIKKwl9CisJeGMuc2NoZWRfcGFyYW1zLCBlcnIgPSB4LlNjaGVkUGFyYW1zLnRv
QygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9z
ZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmNsYWltX21vZGUsIGVyciA9IHguQ2xh
aW1Nb2RlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2lu
Zm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmV2ZW50X2NoYW5uZWxz
ID0gQy51aW50MzJfdCh4LkV2ZW50Q2hhbm5lbHMpCisJeGMua2VybmVsID0gQy5DU3RyaW5nKHgu
S2VybmVsKQorCXhjLmNtZGxpbmUgPSBDLkNTdHJpbmcoeC5DbWRsaW5lKQorCXhjLnJhbWRpc2sg
PSBDLkNTdHJpbmcoeC5SYW1kaXNrKQorCXhjLmRldmljZV90cmVlID0gQy5DU3RyaW5nKHguRGV2
aWNlVHJlZSkKKwl4Yy5hY3BpLCBlcnIgPSB4LkFjcGkudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsK
KwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBl
cnIKKwl9CisJeGMuYm9vdGxvYWRlciA9IEMuQ1N0cmluZyh4LkJvb3Rsb2FkZXIpCisJeGMuYm9v
dGxvYWRlcl9hcmdzLCBlcnIgPSB4LkJvb3Rsb2FkZXJBcmdzLnRvQygpCisJaWYgZXJyICE9IG5p
bCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4
YywgZXJyCisJfQorCXhjLnRpbWVyX21vZGUgPSBDLmxpYnhsX3RpbWVyX21vZGUoeC5UaW1lck1v
ZGUpCisJeGMubmVzdGVkX2h2bSwgZXJyID0geC5OZXN0ZWRIdm0udG9DKCkKKwlpZiBlcnIgIT0g
bmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJu
IHhjLCBlcnIKKwl9CisJeGMuYXBpYywgZXJyID0geC5BcGljLnRvQygpCisJaWYgZXJyICE9IG5p
bCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4
YywgZXJyCisJfQorCXhjLmRtX3Jlc3RyaWN0LCBlcnIgPSB4LkRtUmVzdHJpY3QudG9DKCkKKwlp
ZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykK
KwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMudGVlID0gQy5saWJ4bF90ZWVfdHlwZSh4LlRlZSkK
Kwl4Yy5hcmNoX2FybS5naWNfdmVyc2lvbiA9IEMubGlieGxfZ2ljX3ZlcnNpb24oeC5BcmNoQXJt
LkdpY1ZlcnNpb24pCisJeGMuYXJjaF9hcm0udnVhcnQgPSBDLmxpYnhsX3Z1YXJ0X3R5cGUoeC5B
cmNoQXJtLlZ1YXJ0KQorCXhjLmFsdHAybSA9IEMubGlieGxfYWx0cDJtX21vZGUoeC5BbHRwMk0p
CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlVmZiKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfdmZiKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNr
ZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9t
bmFtZSkKQEAgLTc5Niw2ICsxMjA4LDI1IEBAIGZ1bmMgKHggKkRldmljZVZmYikgZnJvbUMoeGMg
KkMubGlieGxfZGV2aWNlX3ZmYikgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAq
RGV2aWNlVmZiKSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfdmZiLCBlcnIgZXJyb3IpIHsKKwlD
LmxpYnhsX2RldmljZV92ZmJfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxf
ZG9taWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHgu
QmFja2VuZERvbW5hbWUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMu
dm5jLCBlcnIgPSB4LlZuYy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2Rldmlj
ZV92ZmJfZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnNkbCwgZXJyID0g
eC5TZGwudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfdmZiX2Rpc3Bv
c2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5rZXltYXAgPSBDLkNTdHJpbmcoeC5L
ZXltYXApCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlVmtiKSBmcm9tQyh4
YyAqQy5saWJ4bF9kZXZpY2VfdmtiKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4
Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tl
bmRfZG9tbmFtZSkKQEAgLTgxNSw2ICsxMjQ2LDI2IEBAIGZ1bmMgKHggKkRldmljZVZrYikgZnJv
bUMoeGMgKkMubGlieGxfZGV2aWNlX3ZrYikgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVu
YyAoeCAqRGV2aWNlVmtiKSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfdmtiLCBlcnIgZXJyb3Ip
IHsKKwlDLmxpYnhsX2RldmljZV92a2JfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3Ry
aW5nKHguQmFja2VuZERvbW5hbWUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQp
CisJeGMuYmFja2VuZF90eXBlID0gQy5saWJ4bF92a2JfYmFja2VuZCh4LkJhY2tlbmRUeXBlKQor
CXhjLnVuaXF1ZV9pZCA9IEMuQ1N0cmluZyh4LlVuaXF1ZUlkKQorCXhjLmZlYXR1cmVfZGlzYWJs
ZV9rZXlib2FyZCA9IEMuYm9vbCh4LkZlYXR1cmVEaXNhYmxlS2V5Ym9hcmQpCisJeGMuZmVhdHVy
ZV9kaXNhYmxlX3BvaW50ZXIgPSBDLmJvb2woeC5GZWF0dXJlRGlzYWJsZVBvaW50ZXIpCisJeGMu
ZmVhdHVyZV9hYnNfcG9pbnRlciA9IEMuYm9vbCh4LkZlYXR1cmVBYnNQb2ludGVyKQorCXhjLmZl
YXR1cmVfcmF3X3BvaW50ZXIgPSBDLmJvb2woeC5GZWF0dXJlUmF3UG9pbnRlcikKKwl4Yy5mZWF0
dXJlX211bHRpX3RvdWNoID0gQy5ib29sKHguRmVhdHVyZU11bHRpVG91Y2gpCisJeGMud2lkdGgg
PSBDLnVpbnQzMl90KHguV2lkdGgpCisJeGMuaGVpZ2h0ID0gQy51aW50MzJfdCh4LkhlaWdodCkK
Kwl4Yy5tdWx0aV90b3VjaF93aWR0aCA9IEMudWludDMyX3QoeC5NdWx0aVRvdWNoV2lkdGgpCisJ
eGMubXVsdGlfdG91Y2hfaGVpZ2h0ID0gQy51aW50MzJfdCh4Lk11bHRpVG91Y2hIZWlnaHQpCisJ
eGMubXVsdGlfdG91Y2hfbnVtX2NvbnRhY3RzID0gQy51aW50MzJfdCh4Lk11bHRpVG91Y2hOdW1D
b250YWN0cykKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VEaXNrKSBmcm9t
Qyh4YyAqQy5saWJ4bF9kZXZpY2VfZGlzaykgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9t
aWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5i
YWNrZW5kX2RvbW5hbWUpCkBAIC04NTAsNiArMTMwMSw0MiBAQCBmdW5jICh4ICpEZXZpY2VEaXNr
KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfZGlzaykgZXJyb3IgewogCXJldHVybiBuaWwKIH0K
IAorZnVuYyAoeCAqRGV2aWNlRGlzaykgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX2Rpc2ssIGVy
ciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX2Rpc2tfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9k
b21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1l
ID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUpCisJeGMucGRldl9wYXRoID0gQy5DU3RyaW5n
KHguUGRldlBhdGgpCisJeGMudmRldiA9IEMuQ1N0cmluZyh4LlZkZXYpCisJeGMuYmFja2VuZCA9
IEMubGlieGxfZGlza19iYWNrZW5kKHguQmFja2VuZCkKKwl4Yy5mb3JtYXQgPSBDLmxpYnhsX2Rp
c2tfZm9ybWF0KHguRm9ybWF0KQorCXhjLnNjcmlwdCA9IEMuQ1N0cmluZyh4LlNjcmlwdCkKKwl4
Yy5yZW1vdmFibGUgPSBDLmludCh4LlJlbW92YWJsZSkKKwl4Yy5yZWFkd3JpdGUgPSBDLmludCh4
LlJlYWR3cml0ZSkKKwl4Yy5pc19jZHJvbSA9IEMuaW50KHguSXNDZHJvbSkKKwl4Yy5kaXJlY3Rf
aW9fc2FmZSA9IEMuYm9vbCh4LkRpcmVjdElvU2FmZSkKKwl4Yy5kaXNjYXJkX2VuYWJsZSwgZXJy
ID0geC5EaXNjYXJkRW5hYmxlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZGV2
aWNlX2Rpc2tfZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmNvbG9fZW5h
YmxlLCBlcnIgPSB4LkNvbG9FbmFibGUudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4
bF9kZXZpY2VfZGlza19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY29s
b19yZXN0b3JlX2VuYWJsZSwgZXJyID0geC5Db2xvUmVzdG9yZUVuYWJsZS50b0MoKQorCWlmIGVy
ciAhPSBuaWwgeworCQlDLmxpYnhsX2RldmljZV9kaXNrX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4g
eGMsIGVycgorCX0KKwl4Yy5jb2xvX2hvc3QgPSBDLkNTdHJpbmcoeC5Db2xvSG9zdCkKKwl4Yy5j
b2xvX3BvcnQgPSBDLmludCh4LkNvbG9Qb3J0KQorCXhjLmNvbG9fZXhwb3J0ID0gQy5DU3RyaW5n
KHguQ29sb0V4cG9ydCkKKwl4Yy5hY3RpdmVfZGlzayA9IEMuQ1N0cmluZyh4LkFjdGl2ZURpc2sp
CisJeGMuaGlkZGVuX2Rpc2sgPSBDLkNTdHJpbmcoeC5IaWRkZW5EaXNrKQorCXJldHVybiB4Yywg
bmlsCit9CisKIGZ1bmMgKHggKkRldmljZU5pYykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX25p
YykgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4
LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC05MjEs
NiArMTQwOCw3OCBAQCBmdW5jICh4ICpEZXZpY2VOaWMpIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV9uaWMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZU5pYykgdG9D
KCkgKHhjIEMubGlieGxfZGV2aWNlX25pYywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2Vf
bmljX2luaXQoJnhjKQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2Vu
ZERvbWlkKQorCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1l
KQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLm10dSA9IEMuaW50KHgu
TXR1KQorCXhjLm1vZGVsID0gQy5DU3RyaW5nKHguTW9kZWwpCisJeGMubWFjLCBlcnIgPSB4Lk1h
Yy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RldmljZV9uaWNfZGlzcG9zZSgm
eGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmlwID0gQy5DU3RyaW5nKHguSXApCisJeGMu
YnJpZGdlID0gQy5DU3RyaW5nKHguQnJpZGdlKQorCXhjLmlmbmFtZSA9IEMuQ1N0cmluZyh4Lklm
bmFtZSkKKwl4Yy5zY3JpcHQgPSBDLkNTdHJpbmcoeC5TY3JpcHQpCisJeGMubmljdHlwZSA9IEMu
bGlieGxfbmljX3R5cGUoeC5OaWN0eXBlKQorCXhjLnJhdGVfYnl0ZXNfcGVyX2ludGVydmFsID0g
Qy51aW50NjRfdCh4LlJhdGVCeXRlc1BlckludGVydmFsKQorCXhjLnJhdGVfaW50ZXJ2YWxfdXNl
Y3MgPSBDLnVpbnQzMl90KHguUmF0ZUludGVydmFsVXNlY3MpCisJeGMuZ2F0ZXdheWRldiA9IEMu
Q1N0cmluZyh4LkdhdGV3YXlkZXYpCisJeGMuY29sb2Z0X2ZvcndhcmRkZXYgPSBDLkNTdHJpbmco
eC5Db2xvZnRGb3J3YXJkZGV2KQorCXhjLmNvbG9fc29ja19taXJyb3JfaWQgPSBDLkNTdHJpbmco
eC5Db2xvU29ja01pcnJvcklkKQorCXhjLmNvbG9fc29ja19taXJyb3JfaXAgPSBDLkNTdHJpbmco
eC5Db2xvU29ja01pcnJvcklwKQorCXhjLmNvbG9fc29ja19taXJyb3JfcG9ydCA9IEMuQ1N0cmlu
Zyh4LkNvbG9Tb2NrTWlycm9yUG9ydCkKKwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9wcmlfaW5faWQg
PSBDLkNTdHJpbmcoeC5Db2xvU29ja0NvbXBhcmVQcmlJbklkKQorCXhjLmNvbG9fc29ja19jb21w
YXJlX3ByaV9pbl9pcCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrQ29tcGFyZVByaUluSXApCisJeGMu
Y29sb19zb2NrX2NvbXBhcmVfcHJpX2luX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja0NvbXBh
cmVQcmlJblBvcnQpCisJeGMuY29sb19zb2NrX2NvbXBhcmVfc2VjX2luX2lkID0gQy5DU3RyaW5n
KHguQ29sb1NvY2tDb21wYXJlU2VjSW5JZCkKKwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9zZWNfaW5f
aXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja0NvbXBhcmVTZWNJbklwKQorCXhjLmNvbG9fc29ja19j
b21wYXJlX3NlY19pbl9wb3J0ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlU2VjSW5Qb3J0
KQorCXhjLmNvbG9fc29ja19jb21wYXJlX25vdGlmeV9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2Nr
Q29tcGFyZU5vdGlmeUlkKQorCXhjLmNvbG9fc29ja19jb21wYXJlX25vdGlmeV9pcCA9IEMuQ1N0
cmluZyh4LkNvbG9Tb2NrQ29tcGFyZU5vdGlmeUlwKQorCXhjLmNvbG9fc29ja19jb21wYXJlX25v
dGlmeV9wb3J0ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlTm90aWZ5UG9ydCkKKwl4Yy5j
b2xvX3NvY2tfcmVkaXJlY3RvcjBfaWQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0b3Iw
SWQpCisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IwX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tS
ZWRpcmVjdG9yMElwKQorCXhjLmNvbG9fc29ja19yZWRpcmVjdG9yMF9wb3J0ID0gQy5DU3RyaW5n
KHguQ29sb1NvY2tSZWRpcmVjdG9yMFBvcnQpCisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IxX2lk
ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRpcmVjdG9yMUlkKQorCXhjLmNvbG9fc29ja19yZWRp
cmVjdG9yMV9pcCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjFJcCkKKwl4Yy5jb2xv
X3NvY2tfcmVkaXJlY3RvcjFfcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjFQ
b3J0KQorCXhjLmNvbG9fc29ja19yZWRpcmVjdG9yMl9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2Nr
UmVkaXJlY3RvcjJJZCkKKwl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjJfaXAgPSBDLkNTdHJpbmco
eC5Db2xvU29ja1JlZGlyZWN0b3IySXApCisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IyX3BvcnQg
PSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0b3IyUG9ydCkKKwl4Yy5jb2xvX2ZpbHRlcl9t
aXJyb3JfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyTWlycm9yUXVldWUpCisJeGMuY29s
b19maWx0ZXJfbWlycm9yX291dGRldiA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJNaXJyb3JPdXRk
ZXYpCisJeGMuY29sb19maWx0ZXJfcmVkaXJlY3RvcjBfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xv
RmlsdGVyUmVkaXJlY3RvcjBRdWV1ZSkKKwl4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMF9pbmRl
diA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMEluZGV2KQorCXhjLmNvbG9fZmls
dGVyX3JlZGlyZWN0b3IwX291dGRldiA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJSZWRpcmVjdG9y
ME91dGRldikKKwl4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMV9xdWV1ZSA9IEMuQ1N0cmluZyh4
LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMVF1ZXVlKQorCXhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3Ix
X2luZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJlZGlyZWN0b3IxSW5kZXYpCisJeGMuY29s
b19maWx0ZXJfcmVkaXJlY3RvcjFfb3V0ZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJlZGly
ZWN0b3IxT3V0ZGV2KQorCXhjLmNvbG9fY29tcGFyZV9wcmlfaW4gPSBDLkNTdHJpbmcoeC5Db2xv
Q29tcGFyZVByaUluKQorCXhjLmNvbG9fY29tcGFyZV9zZWNfaW4gPSBDLkNTdHJpbmcoeC5Db2xv
Q29tcGFyZVNlY0luKQorCXhjLmNvbG9fY29tcGFyZV9vdXQgPSBDLkNTdHJpbmcoeC5Db2xvQ29t
cGFyZU91dCkKKwl4Yy5jb2xvX2NvbXBhcmVfbm90aWZ5X2RldiA9IEMuQ1N0cmluZyh4LkNvbG9D
b21wYXJlTm90aWZ5RGV2KQorCXhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjBfaWQgPSBDLkNT
dHJpbmcoeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IwSWQpCisJeGMuY29sb19zb2NrX3NlY19yZWRp
cmVjdG9yMF9pcCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjBJcCkKKwl4Yy5j
b2xvX3NvY2tfc2VjX3JlZGlyZWN0b3IwX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1NlY1Jl
ZGlyZWN0b3IwUG9ydCkKKwl4Yy5jb2xvX3NvY2tfc2VjX3JlZGlyZWN0b3IxX2lkID0gQy5DU3Ry
aW5nKHguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMUlkKQorCXhjLmNvbG9fc29ja19zZWNfcmVkaXJl
Y3RvcjFfaXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1NlY1JlZGlyZWN0b3IxSXApCisJeGMuY29s
b19zb2NrX3NlY19yZWRpcmVjdG9yMV9wb3J0ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tTZWNSZWRp
cmVjdG9yMVBvcnQpCisJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IwX3F1ZXVlID0gQy5D
U3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IwUXVldWUpCisJeGMuY29sb19maWx0ZXJf
c2VjX3JlZGlyZWN0b3IwX2luZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0
b3IwSW5kZXYpCisJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IwX291dGRldiA9IEMuQ1N0
cmluZyh4LkNvbG9GaWx0ZXJTZWNSZWRpcmVjdG9yME91dGRldikKKwl4Yy5jb2xvX2ZpbHRlcl9z
ZWNfcmVkaXJlY3RvcjFfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3Rv
cjFRdWV1ZSkKKwl4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfaW5kZXYgPSBDLkNTdHJp
bmcoeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3RvcjFJbmRldikKKwl4Yy5jb2xvX2ZpbHRlcl9zZWNf
cmVkaXJlY3RvcjFfb3V0ZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3Ix
T3V0ZGV2KQorCXhjLmNvbG9fZmlsdGVyX3NlY19yZXdyaXRlcjBfcXVldWUgPSBDLkNTdHJpbmco
eC5Db2xvRmlsdGVyU2VjUmV3cml0ZXIwUXVldWUpCisJeGMuY29sb19jaGVja3BvaW50X2hvc3Qg
PSBDLkNTdHJpbmcoeC5Db2xvQ2hlY2twb2ludEhvc3QpCisJeGMuY29sb19jaGVja3BvaW50X3Bv
cnQgPSBDLkNTdHJpbmcoeC5Db2xvQ2hlY2twb2ludFBvcnQpCisJcmV0dXJuIHhjLCBuaWwKK30K
KwogZnVuYyAoeCAqRGV2aWNlUGNpKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcGNpKSBlcnJv
ciB7CiAJeC5GdW5jID0gYnl0ZSh4Yy5fZnVuYykKIAl4LkRldiA9IGJ5dGUoeGMuZGV2KQpAQCAt
OTM2LDYgKzE0OTUsMjIgQEAgZnVuYyAoeCAqRGV2aWNlUGNpKSBmcm9tQyh4YyAqQy5saWJ4bF9k
ZXZpY2VfcGNpKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VQY2kp
IHRvQygpICh4YyBDLmxpYnhsX2RldmljZV9wY2ksIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2
aWNlX3BjaV9pbml0KCZ4YykKKwl4Yy5fZnVuYyA9IEMudWludDhfdCh4LkZ1bmMpCisJeGMuZGV2
ID0gQy51aW50OF90KHguRGV2KQorCXhjLmJ1cyA9IEMudWludDhfdCh4LkJ1cykKKwl4Yy5kb21h
aW4gPSBDLmludCh4LkRvbWFpbikKKwl4Yy52ZGV2Zm4gPSBDLnVpbnQzMl90KHguVmRldmZuKQor
CXhjLnZmdW5jX21hc2sgPSBDLnVpbnQzMl90KHguVmZ1bmNNYXNrKQorCXhjLm1zaXRyYW5zbGF0
ZSA9IEMuYm9vbCh4Lk1zaXRyYW5zbGF0ZSkKKwl4Yy5wb3dlcl9tZ210ID0gQy5ib29sKHguUG93
ZXJNZ210KQorCXhjLnBlcm1pc3NpdmUgPSBDLmJvb2woeC5QZXJtaXNzaXZlKQorCXhjLnNlaXpl
ID0gQy5ib29sKHguU2VpemUpCisJeGMucmRtX3BvbGljeSA9IEMubGlieGxfcmRtX3Jlc2VydmVf
cG9saWN5KHguUmRtUG9saWN5KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmlj
ZVJkbSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3JkbSkgZXJyb3IgewogCXguU3RhcnQgPSB1
aW50NjQoeGMuc3RhcnQpCiAJeC5TaXplID0gdWludDY0KHhjLnNpemUpCkBAIC05NDMsNiArMTUx
OCwxNCBAQCBmdW5jICh4ICpEZXZpY2VSZG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9yZG0p
IGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVJkbSkgdG9DKCkgKHhj
IEMubGlieGxfZGV2aWNlX3JkbSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfcmRtX2lu
aXQoJnhjKQorCXhjLnN0YXJ0ID0gQy51aW50NjRfdCh4LlN0YXJ0KQorCXhjLnNpemUgPSBDLnVp
bnQ2NF90KHguU2l6ZSkKKwl4Yy5wb2xpY3kgPSBDLmxpYnhsX3JkbV9yZXNlcnZlX3BvbGljeSh4
LlBvbGljeSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiY3RybCkgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0
cmxUeXBlKHhjLl90eXBlKQogCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKQEAgLTk1Myw2ICsx
NTM2LDE3IEBAIGZ1bmMgKHggKkRldmljZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV91c2JjdHJsKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VVc2Jj
dHJsKSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfdXNiY3RybCwgZXJyIGVycm9yKSB7CisJQy5s
aWJ4bF9kZXZpY2VfdXNiY3RybF9pbml0KCZ4YykKKwl4Yy5fdHlwZSA9IEMubGlieGxfdXNiY3Ry
bF90eXBlKHguVHlwZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy52
ZXJzaW9uID0gQy5pbnQoeC5WZXJzaW9uKQorCXhjLnBvcnRzID0gQy5pbnQoeC5Qb3J0cykKKwl4
Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNr
ZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VVc2JkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91
c2JkZXYpIGVycm9yIHsKIAl4LkN0cmwgPSBEZXZpZCh4Yy5jdHJsKQogCXguUG9ydCA9IGludCh4
Yy5wb3J0KQpAQCAtOTgxLDExICsxNTc1LDI0IEBAIGZ1bmMgKHggKkRldmljZVVzYmRldlR5cGVV
bmlvbkhvc3RkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JkZXYpIGVycm9yIHsKIAly
ZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVVzYmRldikgdG9DKCkgKHhjIEMubGlieGxf
ZGV2aWNlX3VzYmRldiwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdXNiZGV2X2luaXQo
JnhjKQorCXhjLmN0cmwgPSBDLmxpYnhsX2RldmlkKHguQ3RybCkKKwl4Yy5wb3J0ID0gQy5pbnQo
eC5Qb3J0KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZUR0ZGV2KSBmcm9t
Qyh4YyAqQy5saWJ4bF9kZXZpY2VfZHRkZXYpIGVycm9yIHsKIAl4LlBhdGggPSBDLkdvU3RyaW5n
KHhjLnBhdGgpCiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VEdGRldikgdG9DKCkg
KHhjIEMubGlieGxfZGV2aWNlX2R0ZGV2LCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RldmljZV9k
dGRldl9pbml0KCZ4YykKKwl4Yy5wYXRoID0gQy5DU3RyaW5nKHguUGF0aCkKKwlyZXR1cm4geGMs
IG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VWdHBtKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vf
dnRwbSkgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkK
IAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC05
OTgsNiArMTYwNSwxOSBAQCBmdW5jICh4ICpEZXZpY2VWdHBtKSBmcm9tQyh4YyAqQy5saWJ4bF9k
ZXZpY2VfdnRwbSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlVnRw
bSkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3Z0cG0sIGVyciBlcnJvcikgeworCUMubGlieGxf
ZGV2aWNlX3Z0cG1faW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQo
eC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2Vu
ZERvbW5hbWUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMudXVpZCwg
ZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZGV2aWNlX3Z0
cG1fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4YywgbmlsCit9
CisKIGZ1bmMgKHggKkRldmljZVA5KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcDkpIGVycm9y
IHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5k
RG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtMTAwOCw2ICsxNjI4
LDE3IEBAIGZ1bmMgKHggKkRldmljZVA5KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcDkpIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVA5KSB0b0MoKSAoeGMgQy5s
aWJ4bF9kZXZpY2VfcDksIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX3A5X2luaXQoJnhj
KQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQorCXhj
LmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhjLnRhZyA9
IEMuQ1N0cmluZyh4LlRhZykKKwl4Yy5wYXRoID0gQy5DU3RyaW5nKHguUGF0aCkKKwl4Yy5zZWN1
cml0eV9tb2RlbCA9IEMuQ1N0cmluZyh4LlNlY3VyaXR5TW9kZWwpCisJeGMuZGV2aWQgPSBDLmxp
YnhsX2RldmlkKHguRGV2aWQpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNl
UHZjYWxsc2lmKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmKSBlcnJvciB7CiAJ
eC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5h
bWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTEwMTUsNiArMTY0NiwxNCBA
QCBmdW5jICh4ICpEZXZpY2VQdmNhbGxzaWYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9wdmNh
bGxzaWYpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVB2Y2FsbHNp
ZikgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZiwgZXJyIGVycm9yKSB7CisJQy5s
aWJ4bF9kZXZpY2VfcHZjYWxsc2lmX2luaXQoJnhjKQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxp
YnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQorCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmlu
Zyh4LkJhY2tlbmREb21uYW1lKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQor
CXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZUNoYW5uZWwpIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV9jaGFubmVsKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4
Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tl
bmRfZG9tbmFtZSkKQEAgLTEwNDQsNiArMTY4MywxNSBAQCBmdW5jICh4ICpEZXZpY2VDaGFubmVs
Q29ubmVjdGlvblVuaW9uU29ja2V0KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCkg
ZQogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlQ2hhbm5lbCkgdG9DKCkgKHhjIEMu
bGlieGxfZGV2aWNlX2NoYW5uZWwsIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX2NoYW5u
ZWxfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5k
RG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUp
CisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMubmFtZSA9IEMuQ1N0cmlu
Zyh4Lk5hbWUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqQ29ubmVjdG9yUGFyYW0p
IGZyb21DKHhjICpDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbSkgZXJyb3IgewogCXguVW5pcXVlSWQg
PSBDLkdvU3RyaW5nKHhjLnVuaXF1ZV9pZCkKIAl4LldpZHRoID0gdWludDMyKHhjLndpZHRoKQpA
QCAtMTA1MSw2ICsxNjk5LDE0IEBAIGZ1bmMgKHggKkNvbm5lY3RvclBhcmFtKSBmcm9tQyh4YyAq
Qy5saWJ4bF9jb25uZWN0b3JfcGFyYW0pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMg
KHggKkNvbm5lY3RvclBhcmFtKSB0b0MoKSAoeGMgQy5saWJ4bF9jb25uZWN0b3JfcGFyYW0sIGVy
ciBlcnJvcikgeworCUMubGlieGxfY29ubmVjdG9yX3BhcmFtX2luaXQoJnhjKQorCXhjLnVuaXF1
ZV9pZCA9IEMuQ1N0cmluZyh4LlVuaXF1ZUlkKQorCXhjLndpZHRoID0gQy51aW50MzJfdCh4Lldp
ZHRoKQorCXhjLmhlaWdodCA9IEMudWludDMyX3QoeC5IZWlnaHQpCisJcmV0dXJuIHhjLCBuaWwK
K30KKwogZnVuYyAoeCAqRGV2aWNlVmRpc3BsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmRp
c3BsKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQog
CXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTEw
NjksNiArMTcyNSwxNSBAQCBmdW5jICh4ICpEZXZpY2VWZGlzcGwpIGZyb21DKHhjICpDLmxpYnhs
X2RldmljZV92ZGlzcGwpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmlj
ZVZkaXNwbCkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3ZkaXNwbCwgZXJyIGVycm9yKSB7CisJ
Qy5saWJ4bF9kZXZpY2VfdmRpc3BsX2luaXQoJnhjKQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxp
YnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQorCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmlu
Zyh4LkJhY2tlbmREb21uYW1lKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQor
CXhjLmJlX2FsbG9jID0gQy5ib29sKHguQmVBbGxvYykKKwlyZXR1cm4geGMsIG5pbAorfQorCiBm
dW5jICh4ICpWc25kUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kX3BhcmFtcykgZXJyb3Ig
ewogCW51bVNhbXBsZVJhdGVzIDo9IGludCh4Yy5udW1fc2FtcGxlX3JhdGVzKQogCWNTYW1wbGVS
YXRlcyA6PSAoKlsxIDw8IDI4XUMudWludDMyX3QpKHVuc2FmZS5Qb2ludGVyKHhjLnNhbXBsZV9y
YXRlcykpWzpudW1TYW1wbGVSYXRlczpudW1TYW1wbGVSYXRlc10KQEAgLTEwODgsNiArMTc1Mywx
NCBAQCBmdW5jICh4ICpWc25kUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kX3BhcmFtcykg
ZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnNuZFBhcmFtcykgdG9DKCkgKHhj
IEMubGlieGxfdnNuZF9wYXJhbXMsIGVyciBlcnJvcikgeworCUMubGlieGxfdnNuZF9wYXJhbXNf
aW5pdCgmeGMpCisJeGMuY2hhbm5lbHNfbWluID0gQy51aW50MzJfdCh4LkNoYW5uZWxzTWluKQor
CXhjLmNoYW5uZWxzX21heCA9IEMudWludDMyX3QoeC5DaGFubmVsc01heCkKKwl4Yy5idWZmZXJf
c2l6ZSA9IEMudWludDMyX3QoeC5CdWZmZXJTaXplKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1
bmMgKHggKlZzbmRTdHJlYW0pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfc3RyZWFtKSBlcnJvciB7
CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQogCXguVHlwZSA9IFZzbmRT
dHJlYW1UeXBlKHhjLl90eXBlKQpAQCAtMTA5OSw2ICsxNzcyLDE4IEBAIGZ1bmMgKHggKlZzbmRT
dHJlYW0pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfc3RyZWFtKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpWc25kU3RyZWFtKSB0b0MoKSAoeGMgQy5saWJ4bF92c25kX3N0cmVh
bSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92c25kX3N0cmVhbV9pbml0KCZ4YykKKwl4Yy51bmlx
dWVfaWQgPSBDLkNTdHJpbmcoeC5VbmlxdWVJZCkKKwl4Yy5fdHlwZSA9IEMubGlieGxfdnNuZF9z
dHJlYW1fdHlwZSh4LlR5cGUpCisJeGMucGFyYW1zLCBlcnIgPSB4LlBhcmFtcy50b0MoKQorCWlm
IGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3ZzbmRfc3RyZWFtX2Rpc3Bvc2UoJnhjKQorCQlyZXR1
cm4geGMsIGVycgorCX0KKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWc25kUGNtKSBm
cm9tQyh4YyAqQy5saWJ4bF92c25kX3BjbSkgZXJyb3IgewogCXguTmFtZSA9IEMuR29TdHJpbmco
eGMubmFtZSkKIAl2YXIgdnNuZFBhcmFtc1BhcmFtcyBWc25kUGFyYW1zCkBAIC0xMTE5LDYgKzE4
MDQsMTcgQEAgZnVuYyAoeCAqVnNuZFBjbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9wY20pIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZzbmRQY20pIHRvQygpICh4YyBDLmxp
YnhsX3ZzbmRfcGNtLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3ZzbmRfcGNtX2luaXQoJnhjKQor
CXhjLm5hbWUgPSBDLkNTdHJpbmcoeC5OYW1lKQorCXhjLnBhcmFtcywgZXJyID0geC5QYXJhbXMu
dG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF92c25kX3BjbV9kaXNwb3NlKCZ4YykK
KwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2
aWNlVnNuZCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZzbmQpIGVycm9yIHsKIAl4LkJhY2tl
bmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMu
R29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtMTE0Myw2ICsxODM5LDIxIEBAIGZ1bmMg
KHggKkRldmljZVZzbmQpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92c25kKSBlcnJvciB7CiAJ
cmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VWc25kKSB0b0MoKSAoeGMgQy5saWJ4bF9k
ZXZpY2VfdnNuZCwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdnNuZF9pbml0KCZ4YykK
Kwl4Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5i
YWNrZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9
IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zaG9ydF9uYW1lID0gQy5DU3RyaW5nKHguU2hv
cnROYW1lKQorCXhjLmxvbmdfbmFtZSA9IEMuQ1N0cmluZyh4LkxvbmdOYW1lKQorCXhjLnBhcmFt
cywgZXJyID0geC5QYXJhbXMudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kZXZp
Y2VfdnNuZF9kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJcmV0dXJuIHhjLCBu
aWwKK30KKwogZnVuYyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5f
Y29uZmlnKSBlcnJvciB7CiAJdmFyIGRvbWFpbkNyZWF0ZUluZm9DSW5mbyBEb21haW5DcmVhdGVJ
bmZvCiAJaWYgZXJyIDo9IGRvbWFpbkNyZWF0ZUluZm9DSW5mby5mcm9tQygmeGMuY19pbmZvKTsg
ZXJyICE9IG5pbCB7CkBAIC0xMzEyLDYgKzIwMjMsMjYgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmln
KSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJvciB7CiAJcmV0dXJuIG5pbAog
fQogCitmdW5jICh4ICpEb21haW5Db25maWcpIHRvQygpICh4YyBDLmxpYnhsX2RvbWFpbl9jb25m
aWcsIGVyciBlcnJvcikgeworCUMubGlieGxfZG9tYWluX2NvbmZpZ19pbml0KCZ4YykKKwl4Yy5j
X2luZm8sIGVyciA9IHguQ0luZm8udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9k
b21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5iX2lu
Zm8sIGVyciA9IHguQkluZm8udG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21h
aW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5vbl9wb3dl
cm9mZiA9IEMubGlieGxfYWN0aW9uX29uX3NodXRkb3duKHguT25Qb3dlcm9mZikKKwl4Yy5vbl9y
ZWJvb3QgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uUmVib290KQorCXhjLm9uX3dh
dGNoZG9nID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PbldhdGNoZG9nKQorCXhjLm9u
X2NyYXNoID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PbkNyYXNoKQorCXhjLm9uX3Nv
ZnRfcmVzZXQgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uU29mdFJlc2V0KQorCXJl
dHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRpc2tpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9k
aXNraW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4
LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTMyNCw2ICsyMDU1LDE5IEBA
IGZ1bmMgKHggKkRpc2tpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kaXNraW5mbykgZXJyb3Igewog
CXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGlza2luZm8pIHRvQygpICh4YyBDLmxpYnhsX2Rp
c2tpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2Rpc2tpbmZvX2luaXQoJnhjKQorCXhjLmJh
Y2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90
KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJvbnRlbmQpCisJeGMu
ZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZpZCA9IEMubGli
eGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJeGMuZXZ0Y2gg
PSBDLmludCh4LkV2dGNoKQorCXhjLnJyZWYgPSBDLmludCh4LlJyZWYpCisJcmV0dXJuIHhjLCBu
aWwKK30KKwogZnVuYyAoeCAqTmljaW5mbykgZnJvbUMoeGMgKkMubGlieGxfbmljaW5mbykgZXJy
b3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9
IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTMzNyw2ICsyMDgxLDIwIEBAIGZ1bmMgKHggKk5p
Y2luZm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKk5pY2luZm8pIHRvQygpICh4YyBDLmxpYnhsX25pY2luZm8sIGVyciBlcnJv
cikgeworCUMubGlieGxfbmljaW5mb19pbml0KCZ4YykKKwl4Yy5iYWNrZW5kID0gQy5DU3RyaW5n
KHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkKKwl4
Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lkID0gQy51
aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQp
CisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRjaCkK
Kwl4Yy5ycmVmX3R4ID0gQy5pbnQoeC5ScmVmVHgpCisJeGMucnJlZl9yeCA9IEMuaW50KHguUnJl
ZlJ4KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZ0cG1pbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF92dHBtaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTM1NCw2ICsy
MTEyLDI0IEBAIGZ1bmMgKHggKlZ0cG1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92dHBtaW5mbykg
ZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnRwbWluZm8pIHRvQygpICh4YyBD
LmxpYnhsX3Z0cG1pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3Z0cG1pbmZvX2luaXQoJnhj
KQorCXhjLmJhY2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQgPSBD
LnVpbnQzMl90KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJvbnRl
bmQpCisJeGMuZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZp
ZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJ
eGMuZXZ0Y2ggPSBDLmludCh4LkV2dGNoKQorCXhjLnJyZWYgPSBDLmludCh4LlJyZWYpCisJeGMu
dXVpZCwgZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdnRw
bWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4Yywgbmls
Cit9CisKIGZ1bmMgKHggKlVzYmN0cmxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF91c2JjdHJsaW5m
bykgZXJyb3IgewogCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhjLl90eXBlKQogCXguRGV2aWQgPSBE
ZXZpZCh4Yy5kZXZpZCkKQEAgLTEzNzAsNiArMjE0NiwyMyBAQCBmdW5jICh4ICpVc2JjdHJsaW5m
bykgZnJvbUMoeGMgKkMubGlieGxfdXNiY3RybGluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKlVzYmN0cmxpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF91c2JjdHJsaW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF91c2JjdHJsaW5mb19pbml0KCZ4YykKKwl4Yy5fdHlwZSA9
IEMubGlieGxfdXNiY3RybF90eXBlKHguVHlwZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQo
eC5EZXZpZCkKKwl4Yy52ZXJzaW9uID0gQy5pbnQoeC5WZXJzaW9uKQorCXhjLnBvcnRzID0gQy5p
bnQoeC5Qb3J0cykKKwl4Yy5iYWNrZW5kID0gQy5DU3RyaW5nKHguQmFja2VuZCkKKwl4Yy5iYWNr
ZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkKKwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmlu
Zyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lkID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQp
CisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRjaCkK
Kwl4Yy5yZWZfdXJiID0gQy5pbnQoeC5SZWZVcmIpCisJeGMucmVmX2Nvbm4gPSBDLmludCh4LlJl
ZkNvbm4pCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVmNwdWluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3ZjcHVpbmZvKSBlcnJvciB7CiAJeC5WY3B1aWQgPSB1aW50MzIoeGMudmNwdWlk
KQogCXguQ3B1ID0gdWludDMyKHhjLmNwdSkKQEAgLTEzOTAsNiArMjE4MywyNyBAQCBmdW5jICh4
ICpWY3B1aW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmNwdWluZm8pIGVycm9yIHsKIAlyZXR1cm4g
bmlsCiB9CiAKK2Z1bmMgKHggKlZjcHVpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92Y3B1aW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF92Y3B1aW5mb19pbml0KCZ4YykKKwl4Yy52Y3B1aWQgPSBD
LnVpbnQzMl90KHguVmNwdWlkKQorCXhjLmNwdSA9IEMudWludDMyX3QoeC5DcHUpCisJeGMub25s
aW5lID0gQy5ib29sKHguT25saW5lKQorCXhjLmJsb2NrZWQgPSBDLmJvb2woeC5CbG9ja2VkKQor
CXhjLnJ1bm5pbmcgPSBDLmJvb2woeC5SdW5uaW5nKQorCXhjLnZjcHVfdGltZSA9IEMudWludDY0
X3QoeC5WY3B1VGltZSkKKwl4Yy5jcHVtYXAsIGVyciA9IHguQ3B1bWFwLnRvQygpCisJaWYgZXJy
ICE9IG5pbCB7CisJCUMubGlieGxfdmNwdWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4Yywg
ZXJyCisJfQorCXhjLmNwdW1hcF9zb2Z0LCBlcnIgPSB4LkNwdW1hcFNvZnQudG9DKCkKKwlpZiBl
cnIgIT0gbmlsIHsKKwkJQy5saWJ4bF92Y3B1aW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhj
LCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqUGh5c2luZm8pIGZyb21D
KHhjICpDLmxpYnhsX3BoeXNpbmZvKSBlcnJvciB7CiAJeC5UaHJlYWRzUGVyQ29yZSA9IHVpbnQz
Mih4Yy50aHJlYWRzX3Blcl9jb3JlKQogCXguQ29yZXNQZXJTb2NrZXQgPSB1aW50MzIoeGMuY29y
ZXNfcGVyX3NvY2tldCkKQEAgLTE0MTgsNiArMjIzMiwzNSBAQCBmdW5jICh4ICpQaHlzaW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfcGh5c2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1
bmMgKHggKlBoeXNpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9waHlzaW5mbywgZXJyIGVycm9yKSB7
CisJQy5saWJ4bF9waHlzaW5mb19pbml0KCZ4YykKKwl4Yy50aHJlYWRzX3Blcl9jb3JlID0gQy51
aW50MzJfdCh4LlRocmVhZHNQZXJDb3JlKQorCXhjLmNvcmVzX3Blcl9zb2NrZXQgPSBDLnVpbnQz
Ml90KHguQ29yZXNQZXJTb2NrZXQpCisJeGMubWF4X2NwdV9pZCA9IEMudWludDMyX3QoeC5NYXhD
cHVJZCkKKwl4Yy5ucl9jcHVzID0gQy51aW50MzJfdCh4Lk5yQ3B1cykKKwl4Yy5jcHVfa2h6ID0g
Qy51aW50MzJfdCh4LkNwdUtoeikKKwl4Yy50b3RhbF9wYWdlcyA9IEMudWludDY0X3QoeC5Ub3Rh
bFBhZ2VzKQorCXhjLmZyZWVfcGFnZXMgPSBDLnVpbnQ2NF90KHguRnJlZVBhZ2VzKQorCXhjLnNj
cnViX3BhZ2VzID0gQy51aW50NjRfdCh4LlNjcnViUGFnZXMpCisJeGMub3V0c3RhbmRpbmdfcGFn
ZXMgPSBDLnVpbnQ2NF90KHguT3V0c3RhbmRpbmdQYWdlcykKKwl4Yy5zaGFyaW5nX2ZyZWVkX3Bh
Z2VzID0gQy51aW50NjRfdCh4LlNoYXJpbmdGcmVlZFBhZ2VzKQorCXhjLnNoYXJpbmdfdXNlZF9m
cmFtZXMgPSBDLnVpbnQ2NF90KHguU2hhcmluZ1VzZWRGcmFtZXMpCisJeGMubWF4X3Bvc3NpYmxl
X21mbiA9IEMudWludDY0X3QoeC5NYXhQb3NzaWJsZU1mbikKKwl4Yy5ucl9ub2RlcyA9IEMudWlu
dDMyX3QoeC5Ock5vZGVzKQorCXhjLmh3X2NhcCwgZXJyID0geC5Id0NhcC50b0MoKQorCWlmIGVy
ciAhPSBuaWwgeworCQlDLmxpYnhsX3BoeXNpbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMs
IGVycgorCX0KKwl4Yy5jYXBfaHZtID0gQy5ib29sKHguQ2FwSHZtKQorCXhjLmNhcF9wdiA9IEMu
Ym9vbCh4LkNhcFB2KQorCXhjLmNhcF9odm1fZGlyZWN0aW8gPSBDLmJvb2woeC5DYXBIdm1EaXJl
Y3RpbykKKwl4Yy5jYXBfaGFwID0gQy5ib29sKHguQ2FwSGFwKQorCXhjLmNhcF9zaGFkb3cgPSBD
LmJvb2woeC5DYXBTaGFkb3cpCisJeGMuY2FwX2lvbW11X2hhcF9wdF9zaGFyZSA9IEMuYm9vbCh4
LkNhcElvbW11SGFwUHRTaGFyZSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpDb25u
ZWN0b3JpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JpbmZvKSBlcnJvciB7CiAJeC5V
bmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQogCXguV2lkdGggPSB1aW50MzIoeGMu
d2lkdGgpCkBAIC0xNDI5LDYgKzIyNzIsMTggQEAgZnVuYyAoeCAqQ29ubmVjdG9yaW5mbykgZnJv
bUMoeGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAor
ZnVuYyAoeCAqQ29ubmVjdG9yaW5mbykgdG9DKCkgKHhjIEMubGlieGxfY29ubmVjdG9yaW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF9jb25uZWN0b3JpbmZvX2luaXQoJnhjKQorCXhjLnVuaXF1
ZV9pZCA9IEMuQ1N0cmluZyh4LlVuaXF1ZUlkKQorCXhjLndpZHRoID0gQy51aW50MzJfdCh4Lldp
ZHRoKQorCXhjLmhlaWdodCA9IEMudWludDMyX3QoeC5IZWlnaHQpCisJeGMucmVxX2V2dGNoID0g
Qy5pbnQoeC5SZXFFdnRjaCkKKwl4Yy5yZXFfcnJlZiA9IEMuaW50KHguUmVxUnJlZikKKwl4Yy5l
dnRfZXZ0Y2ggPSBDLmludCh4LkV2dEV2dGNoKQorCXhjLmV2dF9ycmVmID0gQy5pbnQoeC5FdnRS
cmVmKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZkaXNwbGluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3ZkaXNwbGluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhj
LmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTE0NTAs
MTIgKzIzMDUsMzEgQEAgZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmRp
c3BsaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVmRpc3BsaW5mbykg
dG9DKCkgKHhjIEMubGlieGxfdmRpc3BsaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92ZGlz
cGxpbmZvX2luaXQoJnhjKQorCXhjLmJhY2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhj
LmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5D
U3RyaW5nKHguRnJvbnRlbmQpCisJeGMuZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRl
bmRJZCkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMu
aW50KHguU3RhdGUpCisJeGMuYmVfYWxsb2MgPSBDLmJvb2woeC5CZUFsbG9jKQorCXJldHVybiB4
YywgbmlsCit9CisKIGZ1bmMgKHggKlN0cmVhbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3N0cmVh
bWluZm8pIGVycm9yIHsKIAl4LlJlcUV2dGNoID0gaW50KHhjLnJlcV9ldnRjaCkKIAl4LlJlcVJy
ZWYgPSBpbnQoeGMucmVxX3JyZWYpCiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpTdHJlYW1p
bmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9zdHJlYW1pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhs
X3N0cmVhbWluZm9faW5pdCgmeGMpCisJeGMucmVxX2V2dGNoID0gQy5pbnQoeC5SZXFFdnRjaCkK
Kwl4Yy5yZXFfcnJlZiA9IEMuaW50KHguUmVxUnJlZikKKwlyZXR1cm4geGMsIG5pbAorfQorCiBm
dW5jICh4ICpQY21pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wY21pbmZvKSBlcnJvciB7CiAJbnVt
VnNuZFN0cmVhbXMgOj0gaW50KHhjLm51bV92c25kX3N0cmVhbXMpCiAJY1N0cmVhbXMgOj0gKCpb
MSA8PCAyOF1DLmxpYnhsX3N0cmVhbWluZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnN0cmVhbXMpKVs6
bnVtVnNuZFN0cmVhbXM6bnVtVnNuZFN0cmVhbXNdCkBAIC0xNDcwLDYgKzIzNDQsMTEgQEAgZnVu
YyAoeCAqUGNtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfcGNtaW5mbykgZXJyb3IgewogCXJldHVy
biBuaWwKIH0KIAorZnVuYyAoeCAqUGNtaW5mbykgdG9DKCkgKHhjIEMubGlieGxfcGNtaW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF9wY21pbmZvX2luaXQoJnhjKQorCXJldHVybiB4Yywgbmls
Cit9CisKIGZ1bmMgKHggKlZzbmRpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kaW5mbykgZXJy
b3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9
IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTQ5MCw2ICsyMzY5LDE3IEBAIGZ1bmMgKHggKlZz
bmRpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwK
IH0KIAorZnVuYyAoeCAqVnNuZGluZm8pIHRvQygpICh4YyBDLmxpYnhsX3ZzbmRpbmZvLCBlcnIg
ZXJyb3IpIHsKKwlDLmxpYnhsX3ZzbmRpbmZvX2luaXQoJnhjKQorCXhjLmJhY2tlbmQgPSBDLkNT
dHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQgPSBDLnVpbnQzMl90KHguQmFja2VuZElk
KQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJvbnRlbmQpCisJeGMuZnJvbnRlbmRfaWQg
PSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5E
ZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwog
ZnVuYyAoeCAqVmtiaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmtiaW5mbykgZXJyb3IgewogCXgu
QmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4
Yy5iYWNrZW5kX2lkKQpAQCAtMTUwMiw2ICsyMzkyLDE5IEBAIGZ1bmMgKHggKlZrYmluZm8pIGZy
b21DKHhjICpDLmxpYnhsX3ZrYmluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMg
KHggKlZrYmluZm8pIHRvQygpICh4YyBDLmxpYnhsX3ZrYmluZm8sIGVyciBlcnJvcikgeworCUMu
bGlieGxfdmtiaW5mb19pbml0KCZ4YykKKwl4Yy5iYWNrZW5kID0gQy5DU3RyaW5nKHguQmFja2Vu
ZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkKKwl4Yy5mcm9udGVu
ZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lkID0gQy51aW50MzJfdCh4
LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJeGMuc3Rh
dGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRjaCkKKwl4Yy5ycmVm
ID0gQy5pbnQoeC5ScmVmKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKk51bWFpbmZv
KSBmcm9tQyh4YyAqQy5saWJ4bF9udW1haW5mbykgZXJyb3IgewogCXguU2l6ZSA9IHVpbnQ2NCh4
Yy5zaXplKQogCXguRnJlZSA9IHVpbnQ2NCh4Yy5mcmVlKQpAQCAtMTUxNCw2ICsyNDE3LDEzIEBA
IGZ1bmMgKHggKk51bWFpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9udW1haW5mbykgZXJyb3Igewog
CXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqTnVtYWluZm8pIHRvQygpICh4YyBDLmxpYnhsX251
bWFpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX251bWFpbmZvX2luaXQoJnhjKQorCXhjLnNp
emUgPSBDLnVpbnQ2NF90KHguU2l6ZSkKKwl4Yy5mcmVlID0gQy51aW50NjRfdCh4LkZyZWUpCisJ
cmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqQ3B1dG9wb2xvZ3kpIGZyb21DKHhjICpDLmxp
YnhsX2NwdXRvcG9sb2d5KSBlcnJvciB7CiAJeC5Db3JlID0gdWludDMyKHhjLmNvcmUpCiAJeC5T
b2NrZXQgPSB1aW50MzIoeGMuc29ja2V0KQpAQCAtMTUyMSw2ICsyNDMxLDE0IEBAIGZ1bmMgKHgg
KkNwdXRvcG9sb2d5KSBmcm9tQyh4YyAqQy5saWJ4bF9jcHV0b3BvbG9neSkgZXJyb3IgewogCXJl
dHVybiBuaWwKIH0KIAorZnVuYyAoeCAqQ3B1dG9wb2xvZ3kpIHRvQygpICh4YyBDLmxpYnhsX2Nw
dXRvcG9sb2d5LCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2NwdXRvcG9sb2d5X2luaXQoJnhjKQor
CXhjLmNvcmUgPSBDLnVpbnQzMl90KHguQ29yZSkKKwl4Yy5zb2NrZXQgPSBDLnVpbnQzMl90KHgu
U29ja2V0KQorCXhjLm5vZGUgPSBDLnVpbnQzMl90KHguTm9kZSkKKwlyZXR1cm4geGMsIG5pbAor
fQorCiBmdW5jICh4ICpQY2l0b3BvbG9neSkgZnJvbUMoeGMgKkMubGlieGxfcGNpdG9wb2xvZ3kp
IGVycm9yIHsKIAl4LlNlZyA9IHVpbnQxNih4Yy5zZWcpCiAJeC5CdXMgPSBieXRlKHhjLmJ1cykK
QEAgLTE1MjksNiArMjQ0NywxNSBAQCBmdW5jICh4ICpQY2l0b3BvbG9neSkgZnJvbUMoeGMgKkMu
bGlieGxfcGNpdG9wb2xvZ3kpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlBj
aXRvcG9sb2d5KSB0b0MoKSAoeGMgQy5saWJ4bF9wY2l0b3BvbG9neSwgZXJyIGVycm9yKSB7CisJ
Qy5saWJ4bF9wY2l0b3BvbG9neV9pbml0KCZ4YykKKwl4Yy5zZWcgPSBDLnVpbnQxNl90KHguU2Vn
KQorCXhjLmJ1cyA9IEMudWludDhfdCh4LkJ1cykKKwl4Yy5kZXZmbiA9IEMudWludDhfdCh4LkRl
dmZuKQorCXhjLm5vZGUgPSBDLnVpbnQzMl90KHguTm9kZSkKKwlyZXR1cm4geGMsIG5pbAorfQor
CiBmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfY3Jl
ZGl0X3BhcmFtcykgZXJyb3IgewogCXguVHNsaWNlTXMgPSBpbnQoeGMudHNsaWNlX21zKQogCXgu
UmF0ZWxpbWl0VXMgPSBpbnQoeGMucmF0ZWxpbWl0X3VzKQpAQCAtMTUzNiwxMSArMjQ2MywyNSBA
QCBmdW5jICh4ICpTY2hlZENyZWRpdFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfY3Jl
ZGl0X3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqU2NoZWRDcmVk
aXRQYXJhbXMpIHRvQygpICh4YyBDLmxpYnhsX3NjaGVkX2NyZWRpdF9wYXJhbXMsIGVyciBlcnJv
cikgeworCUMubGlieGxfc2NoZWRfY3JlZGl0X3BhcmFtc19pbml0KCZ4YykKKwl4Yy50c2xpY2Vf
bXMgPSBDLmludCh4LlRzbGljZU1zKQorCXhjLnJhdGVsaW1pdF91cyA9IEMuaW50KHguUmF0ZWxp
bWl0VXMpCisJeGMudmNwdV9taWdyX2RlbGF5X3VzID0gQy5pbnQoeC5WY3B1TWlnckRlbGF5VXMp
CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqU2NoZWRDcmVkaXQyUGFyYW1zKSBmcm9t
Qyh4YyAqQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFtcykgZXJyb3IgewogCXguUmF0ZWxpbWl0
VXMgPSBpbnQoeGMucmF0ZWxpbWl0X3VzKQogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqU2No
ZWRDcmVkaXQyUGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFtcywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFtc19pbml0KCZ4YykKKwl4
Yy5yYXRlbGltaXRfdXMgPSBDLmludCh4LlJhdGVsaW1pdFVzKQorCXJldHVybiB4YywgbmlsCit9
CisKIGZ1bmMgKHggKkRvbWFpblJlbXVzSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3Jl
bXVzX2luZm8pIGVycm9yIHsKIAl4LkludGVydmFsID0gaW50KHhjLmludGVydmFsKQogCXZhciBk
ZWZib29sQWxsb3dVbnNhZmUgRGVmYm9vbApAQCAtMTU4Miw2ICsyNTIzLDQ4IEBAIGZ1bmMgKHgg
KkRvbWFpblJlbXVzSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRvbWFpblJlbXVzSW5mbykgdG9DKCkg
KHhjIEMubGlieGxfZG9tYWluX3JlbXVzX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfZG9t
YWluX3JlbXVzX2luZm9faW5pdCgmeGMpCisJeGMuaW50ZXJ2YWwgPSBDLmludCh4LkludGVydmFs
KQorCXhjLmFsbG93X3Vuc2FmZSwgZXJyID0geC5BbGxvd1Vuc2FmZS50b0MoKQorCWlmIGVyciAh
PSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1
cm4geGMsIGVycgorCX0KKwl4Yy5ibGFja2hvbGUsIGVyciA9IHguQmxhY2tob2xlLnRvQygpCisJ
aWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgmeGMp
CisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmNvbXByZXNzaW9uLCBlcnIgPSB4LkNvbXByZXNz
aW9uLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3JlbXVzX2luZm9f
ZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLm5ldGJ1ZiwgZXJyID0geC5O
ZXRidWYudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fcmVtdXNfaW5m
b19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMubmV0YnVmc2NyaXB0ID0g
Qy5DU3RyaW5nKHguTmV0YnVmc2NyaXB0KQorCXhjLmRpc2tidWYsIGVyciA9IHguRGlza2J1Zi50
b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2Rpc3Bv
c2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5jb2xvLCBlcnIgPSB4LkNvbG8udG9D
KCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fcmVtdXNfaW5mb19kaXNwb3Nl
KCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMudXNlcnNwYWNlX2NvbG9fcHJveHksIGVy
ciA9IHguVXNlcnNwYWNlQ29sb1Byb3h5LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGli
eGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQor
CXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9l
dmVudCkgZXJyb3IgewogCXZhciBldkxpbmtMaW5rIEV2TGluawogCWlmIGVyciA6PSBldkxpbmtM
aW5rLmZyb21DKCZ4Yy5saW5rKTsgZXJyICE9IG5pbCB7CkBAIC0xNjU0LDYgKzI2MzcsMjMgQEAg
ZnVuYyAoeCAqRXZlbnRUeXBlVW5pb25PcGVyYXRpb25Db21wbGV0ZSkgZnJvbUMoeGMgKkMubGli
eGxfZXZlbnQpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkV2ZW50KSB0b0Mo
KSAoeGMgQy5saWJ4bF9ldmVudCwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9ldmVudF9pbml0KCZ4
YykKKwl4Yy5saW5rLCBlcnIgPSB4LkxpbmsudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5s
aWJ4bF9ldmVudF9kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZG9taWQg
PSBDLmxpYnhsX2RvbWlkKHguRG9taWQpCisJeGMuZG9tdXVpZCwgZXJyID0geC5Eb211dWlkLnRv
QygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZXZlbnRfZGlzcG9zZSgmeGMpCisJCXJl
dHVybiB4YywgZXJyCisJfQorCXhjLmZvcl91c2VyID0gQy51aW50NjRfdCh4LkZvclVzZXIpCisJ
cmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqUHNyQ2F0SW5mbykgZnJvbUMoeGMgKkMubGli
eGxfcHNyX2NhdF9pbmZvKSBlcnJvciB7CiAJeC5JZCA9IHVpbnQzMih4Yy5pZCkKIAl4LkNvc01h
eCA9IHVpbnQzMih4Yy5jb3NfbWF4KQpAQCAtMTY2Miw2ICsyNjYyLDE1IEBAIGZ1bmMgKHggKlBz
ckNhdEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9jYXRfaW5mbykgZXJyb3IgewogCXJldHVy
biBuaWwKIH0KIAorZnVuYyAoeCAqUHNyQ2F0SW5mbykgdG9DKCkgKHhjIEMubGlieGxfcHNyX2Nh
dF9pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3Bzcl9jYXRfaW5mb19pbml0KCZ4YykKKwl4
Yy5pZCA9IEMudWludDMyX3QoeC5JZCkKKwl4Yy5jb3NfbWF4ID0gQy51aW50MzJfdCh4LkNvc01h
eCkKKwl4Yy5jYm1fbGVuID0gQy51aW50MzJfdCh4LkNibUxlbikKKwl4Yy5jZHBfZW5hYmxlZCA9
IEMuYm9vbCh4LkNkcEVuYWJsZWQpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqUHNy
SHdJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfaHdfaW5mbykgZXJyb3IgewogCXguSWQgPSB1
aW50MzIoeGMuaWQpCiAJeC5UeXBlID0gUHNyRmVhdFR5cGUoeGMuX3R5cGUpCkBAIC0xNzA3LDMg
KzI3MTYsOSBAQCBmdW5jICh4ICpQc3JId0luZm9UeXBlVW5pb25NYmEpIGZyb21DKHhjICpDLmxp
YnhsX3Bzcl9od19pbmZvKSBlcnJvciB7CiAJeC5MaW5lYXIgPSBib29sKHRtcC5saW5lYXIpCiAJ
cmV0dXJuIG5pbAogfQorCitmdW5jICh4ICpQc3JId0luZm8pIHRvQygpICh4YyBDLmxpYnhsX3Bz
cl9od19pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3Bzcl9od19pbmZvX2luaXQoJnhjKQor
CXhjLmlkID0gQy51aW50MzJfdCh4LklkKQorCXJldHVybiB4YywgbmlsCit9Ci0tIAoyLjE5LjEK
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2
ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xp
c3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

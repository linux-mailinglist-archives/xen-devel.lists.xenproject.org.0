Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 1DBB92C490
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:38:40 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZSi-00019h-0h; Tue, 28 May 2019 10:36:08 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZSg-000185-E0
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:36:06 +0000
X-Inumbo-ID: 08541656-8134-11e9-8980-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 08541656-8134-11e9-8980-bc764e045a96;
 Tue, 28 May 2019 10:33:29 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id A170FB071;
 Tue, 28 May 2019 10:33:28 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:33:00 +0200
Message-Id: <20190528103313.1343-48-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 47/60] xen/sched: move per-cpu variable
 scheduler to struct sched_resource
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SGF2aW5nIGEgcG9pbnRlciB0byBzdHJ1Y3Qgc2NoZWR1bGVyIGluIHN0cnVjdCBzY2hlZF9yZXNv
dXJjZSBpbnN0ZWFkCm9mIHBlciBjcHUgaXMgZW5vdWdoLgoKU2lnbmVkLW9mZi1ieTogSnVlcmdl
biBHcm9zcyA8amdyb3NzQHN1c2UuY29tPgotLS0KVjE6IG5ldyBwYXRjaAotLS0KIHhlbi9jb21t
b24vc2NoZWRfY3JlZGl0LmMgIHwgMTggKysrKysrKysrKystLS0tLS0tCiB4ZW4vY29tbW9uL3Nj
aGVkX2NyZWRpdDIuYyB8ICAzICsrLQogeGVuL2NvbW1vbi9zY2hlZHVsZS5jICAgICAgfCAyMSAr
KysrKysrKysrLS0tLS0tLS0tLS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIHwgIDIgKy0K
IDQgZmlsZXMgY2hhbmdlZCwgMjQgaW5zZXJ0aW9ucygrKSwgMjAgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYyBiL3hlbi9jb21tb24vc2NoZWRfY3Jl
ZGl0LmMKaW5kZXggMTUzMzllNmZhZS4uNWU2MDc4ODExMiAxMDA2NDQKLS0tIGEveGVuL2NvbW1v
bi9zY2hlZF9jcmVkaXQuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCkBAIC0zNTAs
OSArMzUwLDEwIEBAIERFRklORV9QRVJfQ1BVKHVuc2lnbmVkIGludCwgbGFzdF90aWNrbGVfY3B1
KTsKIHN0YXRpYyBpbmxpbmUgdm9pZCBfX3J1bnFfdGlja2xlKHN0cnVjdCBjc2NoZWRfdW5pdCAq
bmV3KQogewogICAgIHVuc2lnbmVkIGludCBjcHUgPSBzY2hlZF91bml0X2NwdShuZXctPnVuaXQp
OworICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc2QgPSBnZXRfc2NoZWRfcmVzKGNwdSk7CiAg
ICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQgPSBuZXctPnVuaXQ7CiAgICAgc3RydWN0IGNzY2hl
ZF91bml0ICogY29uc3QgY3VyID0gQ1NDSEVEX1VOSVQoY3Vycl9vbl9jcHUoY3B1KSk7Ci0gICAg
c3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYgPSBDU0NIRURfUFJJVihwZXJfY3B1KHNjaGVkdWxl
ciwgY3B1KSk7CisgICAgc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYgPSBDU0NIRURfUFJJVihz
ZC0+c2NoZWR1bGVyKTsKICAgICBjcHVtYXNrX3QgbWFzaywgaWRsZV9tYXNrLCAqb25saW5lOwog
ICAgIGludCBiYWxhbmNlX3N0ZXAsIGlkbGVyc19lbXB0eTsKIApAQCAtOTM3LDcgKzkzOCw4IEBA
IGNzY2hlZF91bml0X2FjY3Qoc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIHVuc2lnbmVkIGlu
dCBjcHUpCiB7CiAgICAgc3RydWN0IHNjaGVkX3VuaXQgKmN1cnJ1bml0ID0gY3VycmVudC0+c2No
ZWRfdW5pdDsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKiBjb25zdCBzdmMgPSBDU0NIRURfVU5J
VChjdXJydW5pdCk7Ci0gICAgY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzID0gcGVyX2NwdShz
Y2hlZHVsZXIsIGNwdSk7CisgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzZCA9IGdldF9zY2hl
ZF9yZXMoY3B1KTsKKyAgICBjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMgPSBzZC0+c2NoZWR1
bGVyOwogCiAgICAgQVNTRVJUKCBzY2hlZF91bml0X2NwdShjdXJydW5pdCkgPT0gY3B1ICk7CiAg
ICAgQVNTRVJUKCBzdmMtPnNkb20gIT0gTlVMTCApOwpAQCAtOTkzLDggKzk5NSw3IEBAIGNzY2hl
ZF91bml0X2FjY3Qoc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIHVuc2lnbmVkIGludCBjcHUp
CiAgICAgICAgICAgICAgKiBpZGxlcnMuIEJ1dCwgaWYgd2UgYXJlIGhlcmUsIGl0IG1lYW5zIHRo
ZXJlIGlzIHNvbWVvbmUgcnVubmluZwogICAgICAgICAgICAgICogb24gaXQsIGFuZCBoZW5jZSB0
aGUgYml0IG11c3QgYmUgemVybyBhbHJlYWR5LgogICAgICAgICAgICAgICovCi0gICAgICAgICAg
ICBBU1NFUlQoIWNwdW1hc2tfdGVzdF9jcHUoY3B1LAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIENTQ0hFRF9QUklWKHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpKS0+aWRsZXJz
KSk7CisgICAgICAgICAgICBBU1NFUlQoIWNwdW1hc2tfdGVzdF9jcHUoY3B1LCBDU0NIRURfUFJJ
VihzZC0+c2NoZWR1bGVyKS0+aWRsZXJzKSk7CiAgICAgICAgICAgICBjcHVfcmFpc2Vfc29mdGly
cShjcHUsIFNDSEVEVUxFX1NPRlRJUlEpOwogICAgICAgICB9CiAgICAgfQpAQCAtMTA4OSw2ICsx
MDkwLDcgQEAgY3NjaGVkX3VuaXRfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBz
dHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKiBjb25z
dCBzdmMgPSBDU0NIRURfVU5JVCh1bml0KTsKICAgICB1bnNpZ25lZCBpbnQgY3B1ID0gc2NoZWRf
dW5pdF9jcHUodW5pdCk7CisgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzZCA9IGdldF9zY2hl
ZF9yZXMoY3B1KTsKIAogICAgIFNDSEVEX1NUQVRfQ1JBTksodW5pdF9zbGVlcCk7CiAKQEAgLTEx
MDEsNyArMTEwMyw3IEBAIGNzY2hlZF91bml0X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
Km9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiAgICAgICAgICAqIEJ1dCwgd2UgYXJlIGhl
cmUgYmVjYXVzZSB1bml0IGlzIGdvaW5nIHRvIHNsZWVwIHdoaWxlIHJ1bm5pbmcgb24gY3B1LAog
ICAgICAgICAgKiBzbyB0aGUgYml0IG11c3QgYmUgemVybyBhbHJlYWR5LgogICAgICAgICAgKi8K
LSAgICAgICAgQVNTRVJUKCFjcHVtYXNrX3Rlc3RfY3B1KGNwdSwgQ1NDSEVEX1BSSVYocGVyX2Nw
dShzY2hlZHVsZXIsIGNwdSkpLT5pZGxlcnMpKTsKKyAgICAgICAgQVNTRVJUKCFjcHVtYXNrX3Rl
c3RfY3B1KGNwdSwgQ1NDSEVEX1BSSVYoc2QtPnNjaGVkdWxlciktPmlkbGVycykpOwogICAgICAg
ICBjcHVfcmFpc2Vfc29mdGlycShjcHUsIFNDSEVEVUxFX1NPRlRJUlEpOwogICAgIH0KICAgICBl
bHNlIGlmICggX191bml0X29uX3J1bnEoc3ZjKSApCkBAIC0xNTgxLDggKzE1ODMsOSBAQCBzdGF0
aWMgdm9pZAogY3NjaGVkX3RpY2sodm9pZCAqX2NwdSkKIHsKICAgICB1bnNpZ25lZCBpbnQgY3B1
ID0gKHVuc2lnbmVkIGxvbmcpX2NwdTsKKyAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNkID0g
Z2V0X3NjaGVkX3JlcyhjcHUpOwogICAgIHN0cnVjdCBjc2NoZWRfcGNwdSAqc3BjID0gQ1NDSEVE
X1BDUFUoY3B1KTsKLSAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiA9IENTQ0hFRF9QUklW
KHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpKTsKKyAgICBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBy
diA9IENTQ0hFRF9QUklWKHNkLT5zY2hlZHVsZXIpOwogCiAgICAgc3BjLT50aWNrKys7CiAKQEAg
LTE2MDcsNyArMTYxMCw4IEBAIGNzY2hlZF90aWNrKHZvaWQgKl9jcHUpCiBzdGF0aWMgc3RydWN0
IGNzY2hlZF91bml0ICoKIGNzY2hlZF9ydW5xX3N0ZWFsKGludCBwZWVyX2NwdSwgaW50IGNwdSwg
aW50IHByaSwgaW50IGJhbGFuY2Vfc3RlcCkKIHsKLSAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkX3By
aXZhdGUgKiBjb25zdCBwcnYgPSBDU0NIRURfUFJJVihwZXJfY3B1KHNjaGVkdWxlciwgY3B1KSk7
CisgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzZCA9IGdldF9zY2hlZF9yZXMoY3B1KTsKKyAg
ICBjb25zdCBzdHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKiBjb25zdCBwcnYgPSBDU0NIRURfUFJJVihz
ZC0+c2NoZWR1bGVyKTsKICAgICBjb25zdCBzdHJ1Y3QgY3NjaGVkX3BjcHUgKiBjb25zdCBwZWVy
X3BjcHUgPSBDU0NIRURfUENQVShwZWVyX2NwdSk7CiAgICAgc3RydWN0IGNzY2hlZF91bml0ICpz
cGVlcjsKICAgICBzdHJ1Y3QgbGlzdF9oZWFkICppdGVyOwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1v
bi9zY2hlZF9jcmVkaXQyLmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwppbmRleCAzYmZj
ZWVmYTQ2Li4xNzY0YWE3MDRlIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIu
YworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwpAQCAtMzI2NSw4ICszMjY1LDkgQEAg
cnVucV9jYW5kaWRhdGUoc3RydWN0IGNzY2hlZDJfcnVucXVldWVfZGF0YSAqcnFkLAogICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50ICpza2lwcGVkKQogewogICAgIHN0cnVjdCBsaXN0X2hlYWQg
Kml0ZXIsICp0ZW1wOworICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc2QgPSBnZXRfc2NoZWRf
cmVzKGNwdSk7CiAgICAgc3RydWN0IGNzY2hlZDJfdW5pdCAqc25leHQgPSBOVUxMOwotICAgIHN0
cnVjdCBjc2NoZWQyX3ByaXZhdGUgKnBydiA9IGNzY2hlZDJfcHJpdihwZXJfY3B1KHNjaGVkdWxl
ciwgY3B1KSk7CisgICAgc3RydWN0IGNzY2hlZDJfcHJpdmF0ZSAqcHJ2ID0gY3NjaGVkMl9wcml2
KHNkLT5zY2hlZHVsZXIpOwogICAgIGJvb2wgeWllbGQgPSBmYWxzZSwgc29mdF9hZmZfcHJlZW1w
dCA9IGZhbHNlOwogCiAgICAgKnNraXBwZWQgPSAwOwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9z
Y2hlZHVsZS5jIGIveGVuL2NvbW1vbi9zY2hlZHVsZS5jCmluZGV4IDliZmY0ZGMxODMuLjM0Yzk1
ZDFkYzYgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWR1bGUuYworKysgYi94ZW4vY29tbW9u
L3NjaGVkdWxlLmMKQEAgLTY2LDcgKzY2LDYgQEAgc3RhdGljIHZvaWQgdmNwdV9zaW5nbGVzaG90
X3RpbWVyX2ZuKHZvaWQgKmRhdGEpOwogc3RhdGljIHZvaWQgcG9sbF90aW1lcl9mbih2b2lkICpk
YXRhKTsKIAogLyogVGhpcyBpcyBnbG9iYWwgZm9yIG5vdyBzbyB0aGF0IHByaXZhdGUgaW1wbGVt
ZW50YXRpb25zIGNhbiByZWFjaCBpdCAqLwotREVGSU5FX1BFUl9DUFUoc3RydWN0IHNjaGVkdWxl
ciAqLCBzY2hlZHVsZXIpOwogREVGSU5FX1BFUl9DUFUoc3RydWN0IHNjaGVkX3Jlc291cmNlICos
IHNjaGVkX3Jlcyk7CiBzdGF0aWMgREVGSU5FX1BFUl9DUFUodW5zaWduZWQgaW50LCBzY2hlZF9y
ZXNfaWR4KTsKIApAQCAtMTMzLDcgKzEzMiw3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHNjaGVk
dWxlciAqdmNwdV9zY2hlZHVsZXIoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiAgICAgICogZm9yIGlk
bGUgdkNQVXMsIGl0IGlzIHNhZmUgdG8gdXNlIGl0LCB3aXRoIG5vIGxvY2tzLCB0byBmaWd1cmUg
dGhhdCBvdXQuCiAgICAgICovCiAgICAgQVNTRVJUKGlzX2lkbGVfZG9tYWluKGQpKTsKLSAgICBy
ZXR1cm4gcGVyX2NwdShzY2hlZHVsZXIsIHYtPnByb2Nlc3Nvcik7CisgICAgcmV0dXJuIGdldF9z
Y2hlZF9yZXModi0+cHJvY2Vzc29yKS0+c2NoZWR1bGVyOwogfQogI2RlZmluZSBWQ1BVMk9OTElO
RShfdikgY3B1cG9vbF9kb21haW5fY3B1bWFzaygoX3YpLT5kb21haW4pCiAKQEAgLTE3NjcsOCAr
MTc2Niw4IEBAIHN0YXRpYyBib29sIHNjaGVkX3Rhc2tsZXRfY2hlY2sodW5zaWduZWQgaW50IGNw
dSkKIHN0YXRpYyBzdHJ1Y3Qgc2NoZWRfdW5pdCAqZG9fc2NoZWR1bGUoc3RydWN0IHNjaGVkX3Vu
aXQgKnByZXYsIHNfdGltZV90IG5vdywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5zaWduZWQgaW50IGNwdSkKIHsKLSAgICBzdHJ1Y3Qgc2NoZWR1bGVyICpzY2hlZCA9
IHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpOwogICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc2Qg
PSBnZXRfc2NoZWRfcmVzKGNwdSk7CisgICAgc3RydWN0IHNjaGVkdWxlciAqc2NoZWQgPSBzZC0+
c2NoZWR1bGVyOwogICAgIHN0cnVjdCBzY2hlZF91bml0ICpuZXh0OwogCiAgICAgLyogZ2V0IHBv
bGljeS1zcGVjaWZpYyBkZWNpc2lvbiBvbiBzY2hlZHVsaW5nLi4uICovCkBAIC0yMTQ0LDcgKzIx
NDMsNyBAQCBzdGF0aWMgaW50IGNwdV9zY2hlZHVsZV91cCh1bnNpZ25lZCBpbnQgY3B1KQogICAg
IHNkLT5jcHVzID0gY3B1bWFza19vZihjcHUpOwogICAgIHNldF9zY2hlZF9yZXMoY3B1LCBzZCk7
CiAKLSAgICBwZXJfY3B1KHNjaGVkdWxlciwgY3B1KSA9ICZvcHM7CisgICAgc2QtPnNjaGVkdWxl
ciA9ICZvcHM7CiAgICAgc3Bpbl9sb2NrX2luaXQoJnNkLT5fbG9jayk7CiAgICAgc2QtPnNjaGVk
dWxlX2xvY2sgPSAmc2QtPl9sb2NrOwogICAgIGluaXRfdGltZXIoJnNkLT5zX3RpbWVyLCBzX3Rp
bWVyX2ZuLCBOVUxMLCBjcHUpOwpAQCAtMjIwMyw3ICsyMjAyLDcgQEAgc3RhdGljIGludCBjcHVf
c2NoZWR1bGVfdXAodW5zaWduZWQgaW50IGNwdSkKIHN0YXRpYyB2b2lkIGNwdV9zY2hlZHVsZV9k
b3duKHVuc2lnbmVkIGludCBjcHUpCiB7CiAgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzZCA9
IGdldF9zY2hlZF9yZXMoY3B1KTsKLSAgICBzdHJ1Y3Qgc2NoZWR1bGVyICpzY2hlZCA9IHBlcl9j
cHUoc2NoZWR1bGVyLCBjcHUpOworICAgIHN0cnVjdCBzY2hlZHVsZXIgKnNjaGVkID0gc2QtPnNj
aGVkdWxlcjsKIAogICAgIHNjaGVkX2ZyZWVfcGRhdGEoc2NoZWQsIHNkLT5zY2hlZF9wcml2LCBj
cHUpOwogICAgIHNjaGVkX2ZyZWVfdmRhdGEoc2NoZWQsIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91
bml0LT5wcml2KTsKQEAgLTIyMTksOCArMjIxOCw4IEBAIHN0YXRpYyB2b2lkIGNwdV9zY2hlZHVs
ZV9kb3duKHVuc2lnbmVkIGludCBjcHUpCiAKIHZvaWQgc2NoZWR1bGVyX3BlcmNwdV9pbml0KHVu
c2lnbmVkIGludCBjcHUpCiB7Ci0gICAgc3RydWN0IHNjaGVkdWxlciAqc2NoZWQgPSBwZXJfY3B1
KHNjaGVkdWxlciwgY3B1KTsKICAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKnNkID0gZ2V0X3Nj
aGVkX3JlcyhjcHUpOworICAgIHN0cnVjdCBzY2hlZHVsZXIgKnNjaGVkID0gc2QtPnNjaGVkdWxl
cjsKIAogICAgIGlmICggc3lzdGVtX3N0YXRlICE9IFNZU19TVEFURV9yZXN1bWUgKQogICAgICAg
ICBzY2hlZF9pbml0X3BkYXRhKHNjaGVkLCBzZC0+c2NoZWRfcHJpdiwgY3B1KTsKQEAgLTIyMzAs
OCArMjIyOSw4IEBAIHN0YXRpYyBpbnQgY3B1X3NjaGVkdWxlX2NhbGxiYWNrKAogICAgIHN0cnVj
dCBub3RpZmllcl9ibG9jayAqbmZiLCB1bnNpZ25lZCBsb25nIGFjdGlvbiwgdm9pZCAqaGNwdSkK
IHsKICAgICB1bnNpZ25lZCBpbnQgY3B1ID0gKHVuc2lnbmVkIGxvbmcpaGNwdTsKLSAgICBzdHJ1
Y3Qgc2NoZWR1bGVyICpzY2hlZCA9IHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpOwogICAgIHN0cnVj
dCBzY2hlZF9yZXNvdXJjZSAqc2QgPSBnZXRfc2NoZWRfcmVzKGNwdSk7CisgICAgc3RydWN0IHNj
aGVkdWxlciAqc2NoZWQgPSBzZC0+c2NoZWR1bGVyOwogICAgIGludCByYyA9IDA7CiAKICAgICAv
KgpAQCAtMjQwNyw3ICsyNDA2LDcgQEAgaW50IHNjaGVkdWxlX2NwdV9zd2l0Y2godW5zaWduZWQg
aW50IGNwdSwgc3RydWN0IGNwdXBvb2wgKmMpCiB7CiAgICAgc3RydWN0IHZjcHUgKmlkbGU7CiAg
ICAgdm9pZCAqcHByaXYsICpwcHJpdl9vbGQsICp2cHJpdiwgKnZwcml2X29sZDsKLSAgICBzdHJ1
Y3Qgc2NoZWR1bGVyICpvbGRfb3BzID0gcGVyX2NwdShzY2hlZHVsZXIsIGNwdSk7CisgICAgc3Ry
dWN0IHNjaGVkdWxlciAqb2xkX29wcyA9IGdldF9zY2hlZF9yZXMoY3B1KS0+c2NoZWR1bGVyOwog
ICAgIHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMgPSAoYyA9PSBOVUxMKSA/ICZvcHMgOiBjLT5z
Y2hlZDsKICAgICBzdHJ1Y3QgY3B1cG9vbCAqb2xkX3Bvb2wgPSBwZXJfY3B1KGNwdXBvb2wsIGNw
dSk7CiAgICAgc3RydWN0IHNjaGVkX3Jlc291cmNlICpzZCA9IGdldF9zY2hlZF9yZXMoY3B1KTsK
QEAgLTI0NzMsNyArMjQ3Miw3IEBAIGludCBzY2hlZHVsZV9jcHVfc3dpdGNoKHVuc2lnbmVkIGlu
dCBjcHUsIHN0cnVjdCBjcHVwb29sICpjKQogICAgIHBwcml2X29sZCA9IHNkLT5zY2hlZF9wcml2
OwogICAgIG5ld19sb2NrID0gc2NoZWRfc3dpdGNoX3NjaGVkKG5ld19vcHMsIGNwdSwgcHByaXYs
IHZwcml2KTsKIAotICAgIHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpID0gbmV3X29wczsKKyAgICBz
ZC0+c2NoZWR1bGVyID0gbmV3X29wczsKICAgICBzZC0+c2NoZWRfcHJpdiA9IHBwcml2OwogCiAg
ICAgLyoKQEAgLTI1NzQsNyArMjU3Myw3IEBAIHZvaWQgc2NoZWRfdGlja19zdXNwZW5kKHZvaWQp
CiAgICAgc3RydWN0IHNjaGVkdWxlciAqc2NoZWQ7CiAgICAgdW5zaWduZWQgaW50IGNwdSA9IHNt
cF9wcm9jZXNzb3JfaWQoKTsKIAotICAgIHNjaGVkID0gcGVyX2NwdShzY2hlZHVsZXIsIGNwdSk7
CisgICAgc2NoZWQgPSBnZXRfc2NoZWRfcmVzKGNwdSktPnNjaGVkdWxlcjsKICAgICBzY2hlZF9k
b190aWNrX3N1c3BlbmQoc2NoZWQsIGNwdSk7CiAgICAgcmN1X2lkbGVfZW50ZXIoY3B1KTsKICAg
ICByY3VfaWRsZV90aW1lcl9zdGFydCgpOwpAQCAtMjU4Nyw3ICsyNTg2LDcgQEAgdm9pZCBzY2hl
ZF90aWNrX3Jlc3VtZSh2b2lkKQogCiAgICAgcmN1X2lkbGVfdGltZXJfc3RvcCgpOwogICAgIHJj
dV9pZGxlX2V4aXQoY3B1KTsKLSAgICBzY2hlZCA9IHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpOwor
ICAgIHNjaGVkID0gZ2V0X3NjaGVkX3JlcyhjcHUpLT5zY2hlZHVsZXI7CiAgICAgc2NoZWRfZG9f
dGlja19yZXN1bWUoc2NoZWQsIGNwdSk7CiB9CiAKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hl
bi9zY2hlZC1pZi5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKaW5kZXggZjU5NjJjYmNm
Yi4uYWQ2Y2Y0MzQyNSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKKysr
IGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKQEAgLTM2LDYgKzM2LDcgQEAgZXh0ZXJuIGNv
bnN0IGNwdW1hc2tfdCAqc2NoZWRfcmVzX21hc2s7CiAgKiBhcyB0aGUgcmVzdCBvZiB0aGUgc3Ry
dWN0LiAgSnVzdCBoYXZlIHRoZSBzY2hlZHVsZXIgcG9pbnQgdG8gdGhlCiAgKiBvbmUgaXQgd2Fu
dHMgKFRoaXMgbWF5IGJlIHRoZSBvbmUgcmlnaHQgaW4gZnJvbnQgb2YgaXQpLiovCiBzdHJ1Y3Qg
c2NoZWRfcmVzb3VyY2UgeworICAgIHN0cnVjdCBzY2hlZHVsZXIgICAqc2NoZWR1bGVyOwogICAg
IHNwaW5sb2NrX3QgICAgICAgICAqc2NoZWR1bGVfbG9jaywKICAgICAgICAgICAgICAgICAgICAg
ICAgX2xvY2s7CiAgICAgc3RydWN0IHNjaGVkX3VuaXQgICpjdXJyOyAgICAgICAgICAgLyogY3Vy
cmVudCB0YXNrICAgICAgICAgICAgICAgICAgICAqLwpAQCAtNTAsNyArNTEsNiBAQCBzdHJ1Y3Qg
c2NoZWRfcmVzb3VyY2UgewogCiAjZGVmaW5lIGN1cnJfb25fY3B1KGMpICAgIChnZXRfc2NoZWRf
cmVzKGMpLT5jdXJyKQogCi1ERUNMQVJFX1BFUl9DUFUoc3RydWN0IHNjaGVkdWxlciAqLCBzY2hl
ZHVsZXIpOwogREVDTEFSRV9QRVJfQ1BVKHN0cnVjdCBjcHVwb29sICosIGNwdXBvb2wpOwogREVD
TEFSRV9QRVJfQ1BVKHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqLCBzY2hlZF9yZXMpOwogCi0tIAoy
LjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpY
ZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRw
czovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

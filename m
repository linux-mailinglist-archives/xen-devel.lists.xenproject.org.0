Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 0F953165E55
	for <lists+xen-devel@lfdr.de>; Thu, 20 Feb 2020 14:09:32 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j4lY2-00024J-EN; Thu, 20 Feb 2020 13:07:22 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=OTtJ=4I=redhat.com=philmd@srs-us1.protection.inumbo.net>)
 id 1j4lY1-000234-65
 for xen-devel@lists.xenproject.org; Thu, 20 Feb 2020 13:07:21 +0000
X-Inumbo-ID: e3be4bab-53e1-11ea-8526-12813bfff9fa
Received: from us-smtp-delivery-1.mimecast.com (unknown [207.211.31.81])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTP
 id e3be4bab-53e1-11ea-8526-12813bfff9fa;
 Thu, 20 Feb 2020 13:07:04 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1582204024;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=GO1E6oO0Gq5uJhHshZ+fhmzu63XBDTLn+7+XeANLTdA=;
 b=EEEqU3emgD8VyzcA/q8eUtPmBdtKuPAwF1dsy7L3ljWyvZFSwThIqtezzstyxDgaF84IlO
 y+eax+6B2v0rdwZ0+NSKl0G0+G7M6A632bTHLNfazmDmxbgaRTtp/kyco5njqW1EXcC2AC
 4pHtcHOpjaMDVVgF3fctltiCrS2J7FQ=
Received: from mail-wr1-f71.google.com (mail-wr1-f71.google.com
 [209.85.221.71]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-165-6TIHJ6M3MTe0xrQHV-9Svw-1; Thu, 20 Feb 2020 08:07:02 -0500
Received: by mail-wr1-f71.google.com with SMTP id t6so1724270wru.3
 for <xen-devel@lists.xenproject.org>; Thu, 20 Feb 2020 05:07:01 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Kw0XUCUaDNbVcDxMhM9BERQo40GlLRJY6LdRY3T5Lms=;
 b=AmOfndRKOJFw7NrK3eRxHEkdL7Y3SNkyuBUt1ERpVtpfDgVuu82C4Mae3YfK0P36Q4
 /i4PZIIgzyGwRDB+NEdVpJ8qfnmny0nsTAnAvvr0a9b7zUCQbXcHDdcUObrFGkGZGvwp
 qKjYD5sHhA41P1irPwWZOVR2RJSAVnHp4eP3p7XkFwhkpsMyZ3n2EXrpIY2ukow22iBC
 h5ww3Pqw5ShQkRCXVFyFFpD3y0VXxpUp75cNkGJdqHfhFQTiEKOM4ZYasyOXwbmiZgXK
 BkbVAxP0veqAYGGzPON75/pPuUy4gDhCQf9+5aJq861OYZQTcpdyvnP5N/9QEmq3DA7J
 UF6Q==
X-Gm-Message-State: APjAAAXoLA5CkCywIst90ZCHl6WSr+AN3hivbxJeymOarVWPc2O2RDVI
 3kkf6zDB9jsl6pH2X+3xbI251tp/nsyq/uHqE1TsnCrmGNwQXkTy5IKYjFpYCpAlSEM2WQfu1fI
 R4Y2Lkb3136rTYQwTzzWL8qbevCQ=
X-Received: by 2002:a1c:41c4:: with SMTP id o187mr4444391wma.24.1582204018549; 
 Thu, 20 Feb 2020 05:06:58 -0800 (PST)
X-Google-Smtp-Source: APXvYqzfY34Ge3A5OmYaegi2SKsDA4DO74+UedMLsATm1YBGQ+eulvbZaY+6nTExEQIMcugpq5jYpw==
X-Received: by 2002:a1c:41c4:: with SMTP id o187mr4444308wma.24.1582204018007; 
 Thu, 20 Feb 2020 05:06:58 -0800 (PST)
Received: from localhost.localdomain (78.red-88-21-202.staticip.rima-tde.net.
 [88.21.202.78])
 by smtp.gmail.com with ESMTPSA id b67sm4594690wmc.38.2020.02.20.05.06.54
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 20 Feb 2020 05:06:57 -0800 (PST)
From: =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>
To: Peter Maydell <peter.maydell@linaro.org>,
	qemu-devel@nongnu.org
Date: Thu, 20 Feb 2020 14:05:45 +0100
Message-Id: <20200220130548.29974-18-philmd@redhat.com>
X-Mailer: git-send-email 2.21.1
In-Reply-To: <20200220130548.29974-1-philmd@redhat.com>
References: <20200220130548.29974-1-philmd@redhat.com>
MIME-Version: 1.0
X-MC-Unique: 6TIHJ6M3MTe0xrQHV-9Svw-1
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Subject: [Xen-devel] [PATCH v3 17/20] Avoid address_space_rw() with a
 constant is_write argument
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Fam Zheng <fam@euphon.net>, Dmitry Fleytman <dmitry.fleytman@gmail.com>,
 kvm@vger.kernel.org, "Michael S. Tsirkin" <mst@redhat.com>,
 Jason Wang <jasowang@redhat.com>, Alistair Francis <alistair.francis@wdc.com>,
 Gerd Hoffmann <kraxel@redhat.com>,
 "Edgar E. Iglesias" <edgar.iglesias@gmail.com>,
 "Edgar E . Iglesias" <edgar.iglesias@xilinx.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Matthew Rosato <mjrosato@linux.ibm.com>, qemu-block@nongnu.org,
 David Hildenbrand <david@redhat.com>, Halil Pasic <pasic@linux.ibm.com>,
 Christian Borntraeger <borntraeger@de.ibm.com>,
 =?UTF-8?q?Herv=C3=A9=20Poussineau?= <hpoussin@reactos.org>,
 Marcel Apfelbaum <marcel.apfelbaum@gmail.com>,
 Anthony Perard <anthony.perard@citrix.com>, xen-devel@lists.xenproject.org,
 Aleksandar Rikalo <aleksandar.rikalo@rt-rk.com>,
 Richard Henderson <rth@twiddle.net>,
 =?UTF-8?q?Philippe=20Mathieu-Daud=C3=A9?= <philmd@redhat.com>,
 Laurent Vivier <lvivier@redhat.com>, Thomas Huth <thuth@redhat.com>,
 Eduardo Habkost <ehabkost@redhat.com>, Stefan Weil <sw@weilnetz.de>,
 Alistair Francis <alistair@alistair23.me>,
 Richard Henderson <richard.henderson@linaro.org>, Paul Durrant <paul@xen.org>,
 Eric Auger <eric.auger@redhat.com>, qemu-s390x@nongnu.org, qemu-arm@nongnu.org,
 =?UTF-8?q?C=C3=A9dric=20Le=20Goater?= <clg@kaod.org>,
 John Snow <jsnow@redhat.com>, David Gibson <david@gibson.dropbear.id.au>,
 Igor Mitsyanko <i.mitsyanko@gmail.com>, Cornelia Huck <cohuck@redhat.com>,
 Michael Walle <michael@walle.cc>, qemu-ppc@nongnu.org,
 Paolo Bonzini <pbonzini@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogUGV0ZXIgTWF5ZGVsbCA8cGV0ZXIubWF5ZGVsbEBsaW5hcm8ub3JnPgoKVGhlIGFkZHJl
c3Nfc3BhY2VfcncoKSBmdW5jdGlvbiBhbGxvd3MgZWl0aGVyIHJlYWRzIG9yIHdyaXRlcwpkZXBl
bmRpbmcgb24gdGhlIGlzX3dyaXRlIGFyZ3VtZW50IHBhc3NlZCB0byBpdDsgdGhpcyBpcyB1c2Vm
dWwKd2hlbiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBhY2Nlc3MgaXMgZGV0ZXJtaW5lZCBwcm9ncmFt
bWF0aWNhbGx5CihhcyBmb3IgaW5zdGFuY2Ugd2hlbiBoYW5kbGluZyB0aGUgS1ZNX0VYSVRfTU1J
TyBleGl0IHJlYXNvbikuClVuZGVyIHRoZSBob29kIGl0IGp1c3QgY2FsbHMgZWl0aGVyIGFkZHJl
c3Nfc3BhY2Vfd3JpdGUoKSBvcgphZGRyZXNzX3NwYWNlX3JlYWRfZnVsbCgpLgoKV2UgYWxzbyB1
c2UgaXQgYSBsb3Qgd2l0aCBhIGNvbnN0YW50IGlzX3dyaXRlIGFyZ3VtZW50LCB0aG91Z2gsCndo
aWNoIGhhcyB0d28gaXNzdWVzOgogKiB3aGVuIHJlYWRpbmcgImFkZHJlc3Nfc3BhY2VfcncoLi4u
LCAxKSIgdGhpcyBpcyBsZXNzCiAgIGltbWVkaWF0ZWx5IGNsZWFyIHRvIHRoZSByZWFkZXIgYXMg
YmVpbmcgYSB3cml0ZSB0aGFuCiAgICJhZGRyZXNzX3NwYWNlX3dyaXRlKC4uLikiCiAqIGNhbGxp
bmcgYWRkcmVzc19zcGFjZV9ydygpIGJ5cGFzc2VzIHRoZSBvcHRpbWl6YXRpb24KICAgaW4gYWRk
cmVzc19zcGFjZV9yZWFkKCkgdGhhdCBmYXN0LXBhdGhzIHJlYWRzIG9mIGEKICAgZml4ZWQgbGVu
Z3RoCgpUaGlzIGNvbW1pdCB3YXMgcHJvZHVjZWQgd2l0aCB0aGUgaW5jbHVkZWQgQ29jY2luZWxs
ZSBzY3JpcHQKc2NyaXB0cy9jb2NjaW5lbGxlL2V4ZWNfcndfY29uc3QuY29jY2kuCgpTaWduZWQt
b2ZmLWJ5OiBQZXRlciBNYXlkZWxsIDxwZXRlci5tYXlkZWxsQGxpbmFyby5vcmc+ClJldmlld2Vk
LWJ5OiBQaGlsaXBwZSBNYXRoaWV1LURhdWTDqSA8cGhpbG1kQHJlZGhhdC5jb20+ClJldmlld2Vk
LWJ5OiBFZGdhciBFLiBJZ2xlc2lhcyA8ZWRnYXIuaWdsZXNpYXNAeGlsaW54LmNvbT4KUmV2aWV3
ZWQtYnk6IExhdXJlbnQgVml2aWVyIDxsdml2aWVyQHJlZGhhdC5jb20+ClJldmlld2VkLWJ5OiBD
w6lkcmljIExlIEdvYXRlciA8Y2xnQGthb2Qub3JnPgpBY2tlZC1ieTogQ2hyaXN0aWFuIEJvcm50
cmFlZ2VyIDxib3JudHJhZWdlckBkZS5pYm0uY29tPgpSZXZpZXdlZC1ieTogQ29ybmVsaWEgSHVj
ayA8Y29odWNrQHJlZGhhdC5jb20+ClJldmlld2VkLWJ5OiBBbGlzdGFpciBGcmFuY2lzIDxhbGlz
dGFpci5mcmFuY2lzQHdkYy5jb20+CkFja2VkLWJ5OiBEYXZpZCBHaWJzb24gPGRhdmlkQGdpYnNv
bi5kcm9wYmVhci5pZC5hdT4KTWVzc2FnZS1JZDogPDIwMjAwMjE4MTEyNDU3LjIyNzEyLTEtcGV0
ZXIubWF5ZGVsbEBsaW5hcm8ub3JnPgpbUE1EOiBVcGRhdGUgbWFjdm1fc2V0X2NyMCgpIHJlcG9y
dGVkIGJ5IExhdXJlbnQgVml2aWVyXQpTaWduZWQtb2ZmLWJ5OiBQaGlsaXBwZSBNYXRoaWV1LURh
dWTDqSA8cGhpbG1kQHJlZGhhdC5jb20+Ci0tLQogc2NyaXB0cy9jb2NjaW5lbGxlL2V4ZWNfcndf
Y29uc3QuY29jY2kgfCAxMyArKysrKwogdGFyZ2V0L2kzODYvaHZmL3ZteC5oICAgICAgICAgICAg
ICAgICAgfCAgNyArKy0KIGFjY2VsL2t2bS9rdm0tYWxsLmMgICAgICAgICAgICAgICAgICAgIHwg
IDYgKy0tCiBkbWEtaGVscGVycy5jICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA0ICstCiBl
eGVjLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA0ICstCiBody9kbWEveGxu
eC16ZG1hLmMgICAgICAgICAgICAgICAgICAgICB8IDExICsrLS0KIGh3L25ldC9kcDgzOTN4LmMg
ICAgICAgICAgICAgICAgICAgICAgIHwgNzAgKysrKysrKysrKysrKystLS0tLS0tLS0tLS0KIGh3
L25ldC9pODI1OTYuYyAgICAgICAgICAgICAgICAgICAgICAgIHwgMjIgKysrKy0tLS0KIGh3L25l
dC9sYXNpX2k4MjU5Ni5jICAgICAgICAgICAgICAgICAgIHwgIDUgKy0KIGh3L3BwYy9wbnZfbHBj
LmMgICAgICAgICAgICAgICAgICAgICAgIHwgIDggKy0tCiBody9zMzkweC9jc3MuYyAgICAgICAg
ICAgICAgICAgICAgICAgICB8IDEyICsrLS0tCiBxdGVzdC5jICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB8IDUyICsrKysrKysrKy0tLS0tLS0tLS0KIHRhcmdldC9pMzg2L2h2Zi94ODZf
bW11LmMgICAgICAgICAgICAgIHwgMTIgKystLS0KIDEzIGZpbGVzIGNoYW5nZWQsIDExOSBpbnNl
cnRpb25zKCspLCAxMDcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvc2NyaXB0cy9jb2NjaW5l
bGxlL2V4ZWNfcndfY29uc3QuY29jY2kgYi9zY3JpcHRzL2NvY2NpbmVsbGUvZXhlY19yd19jb25z
dC5jb2NjaQppbmRleCA5OGNiMDZmMDlmLi5lZTk4Y2U5ODhlIDEwMDY0NAotLS0gYS9zY3JpcHRz
L2NvY2NpbmVsbGUvZXhlY19yd19jb25zdC5jb2NjaQorKysgYi9zY3JpcHRzL2NvY2NpbmVsbGUv
ZXhlY19yd19jb25zdC5jb2NjaQpAQCAtMjcsNiArMjcsMTkgQEAgZXhwcmVzc2lvbiBFMSwgRTIs
IEUzLCBFNDsKICsgYWRkcmVzc19zcGFjZV93cml0ZShFMSwgRTIsIEUzLCBWLCBFNCkKICkKIAor
Ly8gQXZvaWQgdXNlcyBvZiBhZGRyZXNzX3NwYWNlX3J3KCkgd2l0aCBhIGNvbnN0YW50IGlzX3dy
aXRlIGFyZ3VtZW50LgorQEAKK2V4cHJlc3Npb24gRTEsIEUyLCBFMywgRTQsIEU1Oworc3ltYm9s
IHRydWUsIGZhbHNlOworQEAKKygKKy0gYWRkcmVzc19zcGFjZV9ydyhFMSwgRTIsIEUzLCBFNCwg
RTUsIGZhbHNlKQorKyBhZGRyZXNzX3NwYWNlX3JlYWQoRTEsIEUyLCBFMywgRTQsIEU1KQorfAor
LSBhZGRyZXNzX3NwYWNlX3J3KEUxLCBFMiwgRTMsIEU0LCBFNSwgdHJ1ZSkKKysgYWRkcmVzc19z
cGFjZV93cml0ZShFMSwgRTIsIEUzLCBFNCwgRTUpCispCisKIC8vIFJlbW92ZSB1c2VsZXNzIGNh
c3QKIEBACiBleHByZXNzaW9uIEUxLCBFMiwgRTMsIEU0LCBFNSwgRTY7CmRpZmYgLS1naXQgYS90
YXJnZXQvaTM4Ni9odmYvdm14LmggYi90YXJnZXQvaTM4Ni9odmYvdm14LmgKaW5kZXggMTlhZjAy
OTEzMy4uMDNkMmM3OWI5YyAxMDA2NDQKLS0tIGEvdGFyZ2V0L2kzODYvaHZmL3ZteC5oCisrKyBi
L3RhcmdldC9pMzg2L2h2Zi92bXguaApAQCAtMTI1LDEwICsxMjUsOSBAQCBzdGF0aWMgaW5saW5l
IHZvaWQgbWFjdm1fc2V0X2NyMChodl92Y3B1aWRfdCB2Y3B1LCB1aW50NjRfdCBjcjApCiAKICAg
ICBpZiAoKGNyMCAmIENSMF9QRykgJiYgKHJ2bWNzKHZjcHUsIFZNQ1NfR1VFU1RfQ1I0KSAmIENS
NF9QQUUpICYmCiAgICAgICAgICEoZWZlciAmIE1TUl9FRkVSX0xNRSkpIHsKLSAgICAgICAgYWRk
cmVzc19zcGFjZV9ydygmYWRkcmVzc19zcGFjZV9tZW1vcnksCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgcnZtY3ModmNwdSwgVk1DU19HVUVTVF9DUjMpICYgfjB4MWYsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKLSAgICAgICAgICAgICAgICAgICAg
ICAgICBwZHB0ZSwgMzIsIGZhbHNlKTsKKyAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKCZhZGRy
ZXNzX3NwYWNlX21lbW9yeSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ2bWNzKHZjcHUs
IFZNQ1NfR1VFU1RfQ1IzKSAmIH4weDFmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVN
VFhBVFRSU19VTlNQRUNJRklFRCwgcGRwdGUsIDMyKTsKICAgICAgICAgLyogT25seSBzZXQgUERQ
VEUgd2hlbiBhcHByb3ByaWF0ZS4gKi8KICAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7IGkrKykg
ewogICAgICAgICAgICAgd3ZtY3ModmNwdSwgVk1DU19HVUVTVF9QRFBURTAgKyBpICogMiwgcGRw
dGVbaV0pOwpkaWZmIC0tZ2l0IGEvYWNjZWwva3ZtL2t2bS1hbGwuYyBiL2FjY2VsL2t2bS9rdm0t
YWxsLmMKaW5kZXggYzExMTMxMmRmZC4uMGNmZTZmZDhkZSAxMDA2NDQKLS0tIGEvYWNjZWwva3Zt
L2t2bS1hbGwuYworKysgYi9hY2NlbC9rdm0va3ZtLWFsbC5jCkBAIC0yMTc4LDkgKzIxNzgsOSBA
QCB2b2lkIGt2bV9mbHVzaF9jb2FsZXNjZWRfbW1pb19idWZmZXIodm9pZCkKICAgICAgICAgICAg
IGVudCA9ICZyaW5nLT5jb2FsZXNjZWRfbW1pb1tyaW5nLT5maXJzdF07CiAKICAgICAgICAgICAg
IGlmIChlbnQtPnBpbyA9PSAxKSB7Ci0gICAgICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9ydygm
YWRkcmVzc19zcGFjZV9pbywgZW50LT5waHlzX2FkZHIsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBlbnQtPmRhdGEsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBlbnQtPmxlbiwgdHJ1ZSk7CisgICAgICAgICAgICAgICAg
YWRkcmVzc19zcGFjZV93cml0ZSgmYWRkcmVzc19zcGFjZV9pbywgZW50LT5waHlzX2FkZHIsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVE
LCBlbnQtPmRhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnQtPmxl
bik7CiAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgIGNwdV9waHlzaWNhbF9t
ZW1vcnlfd3JpdGUoZW50LT5waHlzX2FkZHIsIGVudC0+ZGF0YSwgZW50LT5sZW4pOwogICAgICAg
ICAgICAgfQpkaWZmIC0tZ2l0IGEvZG1hLWhlbHBlcnMuYyBiL2RtYS1oZWxwZXJzLmMKaW5kZXgg
ZDM4NzFkYzYxZS4uZThhMjZlODFlMSAxMDA2NDQKLS0tIGEvZG1hLWhlbHBlcnMuYworKysgYi9k
bWEtaGVscGVycy5jCkBAIC0yOCw4ICsyOCw4IEBAIGludCBkbWFfbWVtb3J5X3NldChBZGRyZXNz
U3BhY2UgKmFzLCBkbWFfYWRkcl90IGFkZHIsIHVpbnQ4X3QgYywgZG1hX2FkZHJfdCBsZW4pCiAg
ICAgbWVtc2V0KGZpbGxidWYsIGMsIEZJTExCVUZfU0laRSk7CiAgICAgd2hpbGUgKGxlbiA+IDAp
IHsKICAgICAgICAgbCA9IGxlbiA8IEZJTExCVUZfU0laRSA/IGxlbiA6IEZJTExCVUZfU0laRTsK
LSAgICAgICAgZXJyb3IgfD0gYWRkcmVzc19zcGFjZV9ydyhhcywgYWRkciwgTUVNVFhBVFRSU19V
TlNQRUNJRklFRCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsYnVmLCBs
LCB0cnVlKTsKKyAgICAgICAgZXJyb3IgfD0gYWRkcmVzc19zcGFjZV93cml0ZShhcywgYWRkciwg
TUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBmaWxsYnVmLCBsKTsKICAgICAgICAgbGVuIC09IGw7CiAgICAgICAgIGFkZHIgKz0gbDsK
ICAgICB9CmRpZmYgLS1naXQgYS9leGVjLmMgYi9leGVjLmMKaW5kZXggNzNjM2JjZmE0MC4uYjc5
OTE5YTRmNyAxMDA2NDQKLS0tIGEvZXhlYy5jCisrKyBiL2V4ZWMuYwpAQCAtMzgxNSw4ICszODE1
LDggQEAgaW50IGNwdV9tZW1vcnlfcndfZGVidWcoQ1BVU3RhdGUgKmNwdSwgdGFyZ2V0X3Vsb25n
IGFkZHIsCiAgICAgICAgICAgICBhZGRyZXNzX3NwYWNlX3dyaXRlX3JvbShjcHUtPmNwdV9hc2Vz
W2FzaWR4XS5hcywgcGh5c19hZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYXR0cnMsIGJ1ZiwgbCk7CiAgICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICBhZGRyZXNz
X3NwYWNlX3J3KGNwdS0+Y3B1X2FzZXNbYXNpZHhdLmFzLCBwaHlzX2FkZHIsIGF0dHJzLCBidWYs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwsIGZhbHNlKTsKKyAgICAgICAgICAgIGFk
ZHJlc3Nfc3BhY2VfcmVhZChjcHUtPmNwdV9hc2VzW2FzaWR4XS5hcywgcGh5c19hZGRyLCBhdHRy
cywgYnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwpOwogICAgICAgICB9CiAg
ICAgICAgIGxlbiAtPSBsOwogICAgICAgICBidWYgKz0gbDsKZGlmZiAtLWdpdCBhL2h3L2RtYS94
bG54LXpkbWEuYyBiL2h3L2RtYS94bG54LXpkbWEuYwppbmRleCA2ODNhYmJlNTNmLi4xYzFiMTQy
MjkzIDEwMDY0NAotLS0gYS9ody9kbWEveGxueC16ZG1hLmMKKysrIGIvaHcvZG1hL3hsbngtemRt
YS5jCkBAIC0zMTEsOCArMzExLDcgQEAgc3RhdGljIGJvb2wgemRtYV9sb2FkX2Rlc2NyaXB0b3Io
WGxueFpETUEgKnMsIHVpbnQ2NF90IGFkZHIsIHZvaWQgKmJ1ZikKICAgICAgICAgcmV0dXJuIGZh
bHNlOwogICAgIH0KIAotICAgIGFkZHJlc3Nfc3BhY2Vfcncocy0+ZG1hX2FzLCBhZGRyLCBzLT5h
dHRyLAotICAgICAgICAgICAgICAgICAgICAgYnVmLCBzaXplb2YoWGxueFpETUFEZXNjciksIGZh
bHNlKTsKKyAgICBhZGRyZXNzX3NwYWNlX3JlYWQocy0+ZG1hX2FzLCBhZGRyLCBzLT5hdHRyLCBi
dWYsIHNpemVvZihYbG54WkRNQURlc2NyKSk7CiAgICAgcmV0dXJuIHRydWU7CiB9CiAKQEAgLTM2
NCw3ICszNjMsNyBAQCBzdGF0aWMgdWludDY0X3QgemRtYV91cGRhdGVfZGVzY3JfYWRkcihYbG54
WkRNQSAqcywgYm9vbCB0eXBlLAogICAgIH0gZWxzZSB7CiAgICAgICAgIGFkZHIgPSB6ZG1hX2dl
dF9yZWdhZGRyNjQocywgYmFzZXJlZyk7CiAgICAgICAgIGFkZHIgKz0gc2l6ZW9mKHMtPmRzY19k
c3QpOwotICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KHMtPmRtYV9hcywgYWRkciwgcy0+YXR0ciwg
Jm5leHQsIDgsIGZhbHNlKTsKKyAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKHMtPmRtYV9hcywg
YWRkciwgcy0+YXR0ciwgJm5leHQsIDgpOwogICAgICAgICB6ZG1hX3B1dF9yZWdhZGRyNjQocywg
YmFzZXJlZywgbmV4dCk7CiAgICAgfQogICAgIHJldHVybiBuZXh0OwpAQCAtNDE2LDggKzQxNSw3
IEBAIHN0YXRpYyB2b2lkIHpkbWFfd3JpdGVfZHN0KFhsbnhaRE1BICpzLCB1aW50OF90ICpidWYs
IHVpbnQzMl90IGxlbikKICAgICAgICAgICAgIH0KICAgICAgICAgfQogCi0gICAgICAgIGFkZHJl
c3Nfc3BhY2Vfcncocy0+ZG1hX2FzLCBzLT5kc2NfZHN0LmFkZHIsIHMtPmF0dHIsIGJ1ZiwgZGxl
biwKLSAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlKTsKKyAgICAgICAgYWRkcmVzc19zcGFj
ZV93cml0ZShzLT5kbWFfYXMsIHMtPmRzY19kc3QuYWRkciwgcy0+YXR0ciwgYnVmLCBkbGVuKTsK
ICAgICAgICAgaWYgKGJ1cnN0X3R5cGUgPT0gQVhJX0JVUlNUX0lOQ1IpIHsKICAgICAgICAgICAg
IHMtPmRzY19kc3QuYWRkciArPSBkbGVuOwogICAgICAgICB9CkBAIC00OTMsOCArNDkxLDcgQEAg
c3RhdGljIHZvaWQgemRtYV9wcm9jZXNzX2Rlc2NyKFhsbnhaRE1BICpzKQogICAgICAgICAgICAg
ICAgIGxlbiA9IHMtPmNmZy5idXNfd2lkdGggLyA4OwogICAgICAgICAgICAgfQogICAgICAgICB9
IGVsc2UgewotICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9ydyhzLT5kbWFfYXMsIHNyY19hZGRy
LCBzLT5hdHRyLCBzLT5idWYsIGxlbiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFs
c2UpOworICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKHMtPmRtYV9hcywgc3JjX2FkZHIs
IHMtPmF0dHIsIHMtPmJ1ZiwgbGVuKTsKICAgICAgICAgICAgIGlmIChidXJzdF90eXBlID09IEFY
SV9CVVJTVF9JTkNSKSB7CiAgICAgICAgICAgICAgICAgc3JjX2FkZHIgKz0gbGVuOwogICAgICAg
ICAgICAgfQpkaWZmIC0tZ2l0IGEvaHcvbmV0L2RwODM5M3guYyBiL2h3L25ldC9kcDgzOTN4LmMK
aW5kZXggYjQzNjNlMzE4Ni4uNzA0NTE5MzRhZSAxMDA2NDQKLS0tIGEvaHcvbmV0L2RwODM5M3gu
YworKysgYi9ody9uZXQvZHA4MzkzeC5jCkBAIC0yNzUsOCArMjc1LDggQEAgc3RhdGljIHZvaWQg
ZHA4MzkzeF9kb19sb2FkX2NhbShkcDgzOTN4U3RhdGUgKnMpCiAKICAgICB3aGlsZSAocy0+cmVn
c1tTT05JQ19DRENdICYgMHgxZikgewogICAgICAgICAvKiBGaWxsIGN1cnJlbnQgZW50cnkgKi8K
LSAgICAgICAgYWRkcmVzc19zcGFjZV9ydygmcy0+YXMsIGRwODM5M3hfY2RwKHMpLAotICAgICAg
ICAgICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIHMtPmRhdGEsIHNpemUs
IGZhbHNlKTsKKyAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKCZzLT5hcywgZHA4MzkzeF9jZHAo
cyksCisgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBz
LT5kYXRhLCBzaXplKTsKICAgICAgICAgcy0+Y2FtW2luZGV4XVswXSA9IGRwODM5M3hfZ2V0KHMs
IHdpZHRoLCAxKSAmIDB4ZmY7CiAgICAgICAgIHMtPmNhbVtpbmRleF1bMV0gPSBkcDgzOTN4X2dl
dChzLCB3aWR0aCwgMSkgPj4gODsKICAgICAgICAgcy0+Y2FtW2luZGV4XVsyXSA9IGRwODM5M3hf
Z2V0KHMsIHdpZHRoLCAyKSAmIDB4ZmY7CkBAIC0yOTMsOCArMjkzLDggQEAgc3RhdGljIHZvaWQg
ZHA4MzkzeF9kb19sb2FkX2NhbShkcDgzOTN4U3RhdGUgKnMpCiAgICAgfQogCiAgICAgLyogUmVh
ZCBDQU0gZW5hYmxlICovCi0gICAgYWRkcmVzc19zcGFjZV9ydygmcy0+YXMsIGRwODM5M3hfY2Rw
KHMpLAotICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgcy0+ZGF0
YSwgc2l6ZSwgZmFsc2UpOworICAgIGFkZHJlc3Nfc3BhY2VfcmVhZCgmcy0+YXMsIGRwODM5M3hf
Y2RwKHMpLAorICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBz
LT5kYXRhLCBzaXplKTsKICAgICBzLT5yZWdzW1NPTklDX0NFXSA9IGRwODM5M3hfZ2V0KHMsIHdp
ZHRoLCAwKTsKICAgICBEUFJJTlRGKCJsb2FkIGNhbSBkb25lLiBjYW0gZW5hYmxlIG1hc2sgMHgl
MDR4XG4iLCBzLT5yZWdzW1NPTklDX0NFXSk7CiAKQEAgLTMxMSw4ICszMTEsOCBAQCBzdGF0aWMg
dm9pZCBkcDgzOTN4X2RvX3JlYWRfcnJhKGRwODM5M3hTdGF0ZSAqcykKICAgICAvKiBSZWFkIG1l
bW9yeSAqLwogICAgIHdpZHRoID0gKHMtPnJlZ3NbU09OSUNfRENSXSAmIFNPTklDX0RDUl9EVykg
PyAyIDogMTsKICAgICBzaXplID0gc2l6ZW9mKHVpbnQxNl90KSAqIDQgKiB3aWR0aDsKLSAgICBh
ZGRyZXNzX3NwYWNlX3J3KCZzLT5hcywgZHA4MzkzeF9ycnAocyksCi0gICAgICAgICAgICAgICAg
ICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBzLT5kYXRhLCBzaXplLCBmYWxzZSk7CisgICAg
YWRkcmVzc19zcGFjZV9yZWFkKCZzLT5hcywgZHA4MzkzeF9ycnAocyksCisgICAgICAgICAgICAg
ICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIHMtPmRhdGEsIHNpemUpOwogCiAgICAg
LyogVXBkYXRlIFNPTklDIHJlZ2lzdGVycyAqLwogICAgIHMtPnJlZ3NbU09OSUNfQ1JCQTBdID0g
ZHA4MzkzeF9nZXQocywgd2lkdGgsIDApOwpAQCAtNDI2LDggKzQyNiw4IEBAIHN0YXRpYyB2b2lk
IGRwODM5M3hfZG9fdHJhbnNtaXRfcGFja2V0cyhkcDgzOTN4U3RhdGUgKnMpCiAgICAgICAgIHNp
emUgPSBzaXplb2YodWludDE2X3QpICogNiAqIHdpZHRoOwogICAgICAgICBzLT5yZWdzW1NPTklD
X1RUREFdID0gcy0+cmVnc1tTT05JQ19DVERBXTsKICAgICAgICAgRFBSSU5URigiVHJhbnNtaXQg
cGFja2V0IGF0ICUwOHhcbiIsIGRwODM5M3hfdHRkYShzKSk7Ci0gICAgICAgIGFkZHJlc3Nfc3Bh
Y2VfcncoJnMtPmFzLCBkcDgzOTN4X3R0ZGEocykgKyBzaXplb2YodWludDE2X3QpICogd2lkdGgs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgcy0+ZGF0
YSwgc2l6ZSwgZmFsc2UpOworICAgICAgICBhZGRyZXNzX3NwYWNlX3JlYWQoJnMtPmFzLCBkcDgz
OTN4X3R0ZGEocykgKyBzaXplb2YodWludDE2X3QpICogd2lkdGgsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBzLT5kYXRhLCBzaXplKTsKICAgICAg
ICAgdHhfbGVuID0gMDsKIAogICAgICAgICAvKiBVcGRhdGUgcmVnaXN0ZXJzICovCkBAIC00NTEs
MTggKzQ1MSwxOSBAQCBzdGF0aWMgdm9pZCBkcDgzOTN4X2RvX3RyYW5zbWl0X3BhY2tldHMoZHA4
MzkzeFN0YXRlICpzKQogICAgICAgICAgICAgaWYgKHR4X2xlbiArIGxlbiA+IHNpemVvZihzLT50
eF9idWZmZXIpKSB7CiAgICAgICAgICAgICAgICAgbGVuID0gc2l6ZW9mKHMtPnR4X2J1ZmZlcikg
LSB0eF9sZW47CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KCZz
LT5hcywgZHA4MzkzeF90c2EocyksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1FTVRY
QVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICZzLT50eF9i
dWZmZXJbdHhfbGVuXSwgbGVuLCBmYWxzZSk7CisgICAgICAgICAgICBhZGRyZXNzX3NwYWNlX3Jl
YWQoJnMtPmFzLCBkcDgzOTN4X3RzYShzKSwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAmcy0+dHhfYnVmZmVyW3R4X2xlbl0sIGxlbik7CiAg
ICAgICAgICAgICB0eF9sZW4gKz0gbGVuOwogCiAgICAgICAgICAgICBpKys7CiAgICAgICAgICAg
ICBpZiAoaSAhPSBzLT5yZWdzW1NPTklDX1RGQ10pIHsKICAgICAgICAgICAgICAgICAvKiBSZWFk
IG5leHQgZnJhZ21lbnQgZGV0YWlscyAqLwogICAgICAgICAgICAgICAgIHNpemUgPSBzaXplb2Yo
dWludDE2X3QpICogMyAqIHdpZHRoOwotICAgICAgICAgICAgICAgIGFkZHJlc3Nfc3BhY2Vfcnco
JnMtPmFzLAotICAgICAgICAgICAgICAgICAgICBkcDgzOTN4X3R0ZGEocykgKyBzaXplb2YodWlu
dDE2X3QpICogKDQgKyAzICogaSkgKiB3aWR0aCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIHMtPmRhdGEsIHNpemUsIGZhbHNlKTsKKyAg
ICAgICAgICAgICAgICBhZGRyZXNzX3NwYWNlX3JlYWQoJnMtPmFzLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBkcDgzOTN4X3R0ZGEocykKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKyBzaXplb2YodWludDE2X3QpICogd2lkdGggKiAoNCArIDMgKiBpKSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklF
RCwgcy0+ZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSk7CiAg
ICAgICAgICAgICAgICAgcy0+cmVnc1tTT05JQ19UU0EwXSA9IGRwODM5M3hfZ2V0KHMsIHdpZHRo
LCAwKTsKICAgICAgICAgICAgICAgICBzLT5yZWdzW1NPTklDX1RTQTFdID0gZHA4MzkzeF9nZXQo
cywgd2lkdGgsIDEpOwogICAgICAgICAgICAgICAgIHMtPnJlZ3NbU09OSUNfVEZTXSA9IGRwODM5
M3hfZ2V0KHMsIHdpZHRoLCAyKTsKQEAgLTQ5NSwxOCArNDk2LDE4IEBAIHN0YXRpYyB2b2lkIGRw
ODM5M3hfZG9fdHJhbnNtaXRfcGFja2V0cyhkcDgzOTN4U3RhdGUgKnMpCiAgICAgICAgIGRwODM5
M3hfcHV0KHMsIHdpZHRoLCAwLAogICAgICAgICAgICAgICAgICAgICBzLT5yZWdzW1NPTklDX1RD
Ul0gJiAweDBmZmYpOyAvKiBzdGF0dXMgKi8KICAgICAgICAgc2l6ZSA9IHNpemVvZih1aW50MTZf
dCkgKiB3aWR0aDsKLSAgICAgICAgYWRkcmVzc19zcGFjZV9ydygmcy0+YXMsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgZHA4MzkzeF90dGRhKHMpLAotICAgICAgICAgICAgICAgICAgICAgICAg
IE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIHMtPmRhdGEsIHNpemUsIHRydWUpOworICAgICAgICBh
ZGRyZXNzX3NwYWNlX3dyaXRlKCZzLT5hcywgZHA4MzkzeF90dGRhKHMpLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIHMtPmRhdGEsIHNpemUpOwog
CiAgICAgICAgIGlmICghKHMtPnJlZ3NbU09OSUNfQ1JdICYgU09OSUNfQ1JfSFRYKSkgewogICAg
ICAgICAgICAgLyogUmVhZCBmb290ZXIgb2YgcGFja2V0ICovCiAgICAgICAgICAgICBzaXplID0g
c2l6ZW9mKHVpbnQxNl90KSAqIHdpZHRoOwotICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9ydygm
cy0+YXMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRwODM5M3hfdHRkYShzKSArCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZih1aW50MTZfdCkgKgotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAoNCArIDMgKiBzLT5yZWdzW1NPTklDX1RGQ10pICogd2lkdGgs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIHMt
PmRhdGEsIHNpemUsIGZhbHNlKTsKKyAgICAgICAgICAgIGFkZHJlc3Nfc3BhY2VfcmVhZCgmcy0+
YXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHA4MzkzeF90dGRhKHMpCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBzaXplb2YodWludDE2X3QpICogd2lkdGgKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogKDQgKyAzICogcy0+cmVnc1tTT05JQ19U
RkNdKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lG
SUVELCBzLT5kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemUpOwogICAg
ICAgICAgICAgcy0+cmVnc1tTT05JQ19DVERBXSA9IGRwODM5M3hfZ2V0KHMsIHdpZHRoLCAwKSAm
IH4weDE7CiAgICAgICAgICAgICBpZiAoZHA4MzkzeF9nZXQocywgd2lkdGgsIDApICYgMHgxKSB7
CiAgICAgICAgICAgICAgICAgLyogRU9MIGRldGVjdGVkICovCkBAIC03NjgsOCArNzY5LDggQEAg
c3RhdGljIHNzaXplX3QgZHA4MzkzeF9yZWNlaXZlKE5ldENsaWVudFN0YXRlICpuYywgY29uc3Qg
dWludDhfdCAqIGJ1ZiwKICAgICAgICAgLyogQXJlIHdlIHN0aWxsIGluIHJlc291cmNlIGV4aGF1
c3Rpb24/ICovCiAgICAgICAgIHNpemUgPSBzaXplb2YodWludDE2X3QpICogMSAqIHdpZHRoOwog
ICAgICAgICBhZGRyZXNzID0gZHA4MzkzeF9jcmRhKHMpICsgc2l6ZW9mKHVpbnQxNl90KSAqIDUg
KiB3aWR0aDsKLSAgICAgICAgYWRkcmVzc19zcGFjZV9ydygmcy0+YXMsIGFkZHJlc3MsIE1FTVRY
QVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgcy0+ZGF0YSwgc2l6
ZSwgZmFsc2UpOworICAgICAgICBhZGRyZXNzX3NwYWNlX3JlYWQoJnMtPmFzLCBhZGRyZXNzLCBN
RU1UWEFUVFJTX1VOU1BFQ0lGSUVELAorICAgICAgICAgICAgICAgICAgICAgICAgICAgcy0+ZGF0
YSwgc2l6ZSk7CiAgICAgICAgIGlmIChkcDgzOTN4X2dldChzLCB3aWR0aCwgMCkgJiAweDEpIHsK
ICAgICAgICAgICAgIC8qIFN0aWxsIEVPTCA7IHN0b3AgcmVjZXB0aW9uICovCiAgICAgICAgICAg
ICByZXR1cm4gLTE7CkBAIC03ODgsMTAgKzc4OSwxMSBAQCBzdGF0aWMgc3NpemVfdCBkcDgzOTN4
X3JlY2VpdmUoTmV0Q2xpZW50U3RhdGUgKm5jLCBjb25zdCB1aW50OF90ICogYnVmLAogICAgIC8q
IFB1dCBwYWNrZXQgaW50byBSQkEgKi8KICAgICBEUFJJTlRGKCJSZWNlaXZlIHBhY2tldCBhdCAl
MDh4XG4iLCBkcDgzOTN4X2NyYmEocykpOwogICAgIGFkZHJlc3MgPSBkcDgzOTN4X2NyYmEocyk7
Ci0gICAgYWRkcmVzc19zcGFjZV93cml0ZSgmcy0+YXMsIGFkZHJlc3MsIE1FTVRYQVRUUlNfVU5T
UEVDSUZJRUQsIGJ1ZiwgcnhfbGVuKTsKKyAgICBhZGRyZXNzX3NwYWNlX3dyaXRlKCZzLT5hcywg
YWRkcmVzcywgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAgICAgICAgICAgICAgICAgICAg
IGJ1ZiwgcnhfbGVuKTsKICAgICBhZGRyZXNzICs9IHJ4X2xlbjsKLSAgICBhZGRyZXNzX3NwYWNl
X3J3KCZzLT5hcywgYWRkcmVzcywKLSAgICAgICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5T
UEVDSUZJRUQsICZjaGVja3N1bSwgNCwgdHJ1ZSk7CisgICAgYWRkcmVzc19zcGFjZV93cml0ZSgm
cy0+YXMsIGFkZHJlc3MsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCisgICAgICAgICAgICAgICAg
ICAgICAgICAmY2hlY2tzdW0sIDQpOwogICAgIHJ4X2xlbiArPSA0OwogICAgIHMtPnJlZ3NbU09O
SUNfQ1JCQTFdID0gYWRkcmVzcyA+PiAxNjsKICAgICBzLT5yZWdzW1NPTklDX0NSQkEwXSA9IGFk
ZHJlc3MgJiAweGZmZmY7CkBAIC04MTksMTMgKzgyMSwxNSBAQCBzdGF0aWMgc3NpemVfdCBkcDgz
OTN4X3JlY2VpdmUoTmV0Q2xpZW50U3RhdGUgKm5jLCBjb25zdCB1aW50OF90ICogYnVmLAogICAg
IGRwODM5M3hfcHV0KHMsIHdpZHRoLCAzLCBzLT5yZWdzW1NPTklDX1RSQkExXSk7IC8qIHBrdF9w
dHIxICovCiAgICAgZHA4MzkzeF9wdXQocywgd2lkdGgsIDQsIHMtPnJlZ3NbU09OSUNfUlNDXSk7
IC8qIHNlcV9ubyAqLwogICAgIHNpemUgPSBzaXplb2YodWludDE2X3QpICogNSAqIHdpZHRoOwot
ICAgIGFkZHJlc3Nfc3BhY2VfcncoJnMtPmFzLCBkcDgzOTN4X2NyZGEocyksCi0gICAgICAgICAg
ICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBzLT5kYXRhLCBzaXplLCB0cnVlKTsK
KyAgICBhZGRyZXNzX3NwYWNlX3dyaXRlKCZzLT5hcywgZHA4MzkzeF9jcmRhKHMpLAorICAgICAg
ICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgIHMtPmRhdGEsIHNpemUpOwogCiAgICAgLyogTW92ZSB0byBuZXh0IGRlc2NyaXB0
b3IgKi8KICAgICBzaXplID0gc2l6ZW9mKHVpbnQxNl90KSAqIHdpZHRoOwotICAgIGFkZHJlc3Nf
c3BhY2VfcncoJnMtPmFzLCBkcDgzOTN4X2NyZGEocykgKyBzaXplb2YodWludDE2X3QpICogNSAq
IHdpZHRoLAotICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgcy0+
ZGF0YSwgc2l6ZSwgZmFsc2UpOworICAgIGFkZHJlc3Nfc3BhY2VfcmVhZCgmcy0+YXMsCisgICAg
ICAgICAgICAgICAgICAgICAgIGRwODM5M3hfY3JkYShzKSArIHNpemVvZih1aW50MTZfdCkgKiA1
ICogd2lkdGgsCisgICAgICAgICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQs
IHMtPmRhdGEsIHNpemUpOwogICAgIHMtPnJlZ3NbU09OSUNfTExGQV0gPSBkcDgzOTN4X2dldChz
LCB3aWR0aCwgMCk7CiAgICAgaWYgKHMtPnJlZ3NbU09OSUNfTExGQV0gJiAweDEpIHsKICAgICAg
ICAgLyogRU9MIGRldGVjdGVkICovCkBAIC04MzgsOCArODQyLDggQEAgc3RhdGljIHNzaXplX3Qg
ZHA4MzkzeF9yZWNlaXZlKE5ldENsaWVudFN0YXRlICpuYywgY29uc3QgdWludDhfdCAqIGJ1ZiwK
ICAgICAgICAgICAgIG9mZnNldCArPSBzaXplb2YodWludDE2X3QpOwogICAgICAgICB9CiAgICAg
ICAgIHMtPmRhdGFbMF0gPSAwOwotICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KCZzLT5hcywgb2Zm
c2V0LCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAgICAgICAgIHMt
PmRhdGEsIHNpemVvZih1aW50MTZfdCksIHRydWUpOworICAgICAgICBhZGRyZXNzX3NwYWNlX3dy
aXRlKCZzLT5hcywgb2Zmc2V0LCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHMtPmRhdGEsIHNpemVvZih1aW50MTZfdCkpOwogICAgICAgICBzLT5y
ZWdzW1NPTklDX0NSREFdID0gcy0+cmVnc1tTT05JQ19MTEZBXTsKICAgICAgICAgcy0+cmVnc1tT
T05JQ19JU1JdIHw9IFNPTklDX0lTUl9QS1RSWDsKICAgICAgICAgcy0+cmVnc1tTT05JQ19SU0Nd
ID0gKHMtPnJlZ3NbU09OSUNfUlNDXSAmIDB4ZmYwMCkgfCAoKChzLT5yZWdzW1NPTklDX1JTQ10g
JiAweDAwZmYpICsgMSkgJiAweDAwZmYpOwpkaWZmIC0tZ2l0IGEvaHcvbmV0L2k4MjU5Ni5jIGIv
aHcvbmV0L2k4MjU5Ni5jCmluZGV4IDExNTM3ZjcyZDEuLmZlOWYyMzkwYTkgMTAwNjQ0Ci0tLSBh
L2h3L25ldC9pODI1OTYuYworKysgYi9ody9uZXQvaTgyNTk2LmMKQEAgLTE0OCw4ICsxNDgsOCBA
QCBzdGF0aWMgdm9pZCBpODI1OTZfdHJhbnNtaXQoSTgyNTk2U3RhdGUgKnMsIHVpbnQzMl90IGFk
ZHIpCiAKICAgICAgICAgaWYgKHMtPm5pYyAmJiBsZW4pIHsKICAgICAgICAgICAgIGFzc2VydChs
ZW4gPD0gc2l6ZW9mKHMtPnR4X2J1ZmZlcikpOwotICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9y
dygmYWRkcmVzc19zcGFjZV9tZW1vcnksIHRiYSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgcy0+dHhfYnVmZmVyLCBsZW4sIGZhbHNlKTsKKyAg
ICAgICAgICAgIGFkZHJlc3Nfc3BhY2VfcmVhZCgmYWRkcmVzc19zcGFjZV9tZW1vcnksIHRiYSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBz
LT50eF9idWZmZXIsIGxlbik7CiAgICAgICAgICAgICBEQkcoUFJJTlRfUEtUSERSKCJTZW5kIiwg
JnMtPnR4X2J1ZmZlcikpOwogICAgICAgICAgICAgREJHKHByaW50ZigiU2VuZGluZyAlZCBieXRl
c1xuIiwgbGVuKSk7CiAgICAgICAgICAgICBxZW11X3NlbmRfcGFja2V0KHFlbXVfZ2V0X3F1ZXVl
KHMtPm5pYyksIHMtPnR4X2J1ZmZlciwgbGVuKTsKQEAgLTE3Miw4ICsxNzIsOCBAQCBzdGF0aWMg
dm9pZCBzZXRfaW5kaXZpZHVhbF9hZGRyZXNzKEk4MjU5NlN0YXRlICpzLCB1aW50MzJfdCBhZGRy
KQogCiAgICAgbmMgPSBxZW11X2dldF9xdWV1ZShzLT5uaWMpOwogICAgIG0gPSBzLT5jb25mLm1h
Y2FkZHIuYTsKLSAgICBhZGRyZXNzX3NwYWNlX3J3KCZhZGRyZXNzX3NwYWNlX21lbW9yeSwgYWRk
ciArIDgsCi0gICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBtLCBF
VEhfQUxFTiwgZmFsc2UpOworICAgIGFkZHJlc3Nfc3BhY2VfcmVhZCgmYWRkcmVzc19zcGFjZV9t
ZW1vcnksIGFkZHIgKyA4LAorICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BF
Q0lGSUVELCBtLCBFVEhfQUxFTik7CiAgICAgcWVtdV9mb3JtYXRfbmljX2luZm9fc3RyKG5jLCBt
KTsKICAgICB0cmFjZV9pODI1OTZfbmV3X21hYyhuYy0+aW5mb19zdHIpOwogfQpAQCAtMTkwLDkg
KzE5MCw4IEBAIHN0YXRpYyB2b2lkIHNldF9tdWx0aWNhc3RfbGlzdChJODI1OTZTdGF0ZSAqcywg
dWludDMyX3QgYWRkcikKICAgICB9CiAgICAgZm9yIChpID0gMDsgaSA8IG1jX2NvdW50OyBpKysp
IHsKICAgICAgICAgdWludDhfdCBtdWx0aWNhc3RfYWRkcltFVEhfQUxFTl07Ci0gICAgICAgIGFk
ZHJlc3Nfc3BhY2VfcncoJmFkZHJlc3Nfc3BhY2VfbWVtb3J5LAotICAgICAgICAgICAgYWRkciAr
IGkgKiBFVEhfQUxFTiwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICBtdWx0aWNhc3RfYWRkciwgRVRIX0FMRU4sIGZhbHNlKTsKKyAgICAgICAgYWRkcmVz
c19zcGFjZV9yZWFkKCZhZGRyZXNzX3NwYWNlX21lbW9yeSwgYWRkciArIGkgKiBFVEhfQUxFTiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIG11bHRp
Y2FzdF9hZGRyLCBFVEhfQUxFTik7CiAgICAgICAgIERCRyhwcmludGYoIkFkZCBtdWx0aWNhc3Qg
ZW50cnkgIiBNQUNfRk1UICJcbiIsCiAgICAgICAgICAgICAgICAgICAgIE1BQ19BUkcobXVsdGlj
YXN0X2FkZHIpKSk7CiAgICAgICAgIHVuc2lnbmVkIG1jYXN0X2lkeCA9IChuZXRfY3JjMzIobXVs
dGljYXN0X2FkZHIsIEVUSF9BTEVOKSAmCkBAIC0yNjAsOSArMjU5LDggQEAgc3RhdGljIHZvaWQg
Y29tbWFuZF9sb29wKEk4MjU5NlN0YXRlICpzKQogICAgICAgICAgICAgYnl0ZV9jbnQgPSBNQVgo
Ynl0ZV9jbnQsIDQpOwogICAgICAgICAgICAgYnl0ZV9jbnQgPSBNSU4oYnl0ZV9jbnQsIHNpemVv
ZihzLT5jb25maWcpKTsKICAgICAgICAgICAgIC8qIGNvcHkgYnl0ZV9jbnQgbWF4LiAqLwotICAg
ICAgICAgICAgYWRkcmVzc19zcGFjZV9ydygmYWRkcmVzc19zcGFjZV9tZW1vcnksIHMtPmNtZF9w
ICsgOCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklF
RCwgcy0+Y29uZmlnLCBieXRlX2NudCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFs
c2UpOworICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKCZhZGRyZXNzX3NwYWNlX21lbW9y
eSwgcy0+Y21kX3AgKyA4LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1FTVRYQVRU
UlNfVU5TUEVDSUZJRUQsIHMtPmNvbmZpZywgYnl0ZV9jbnQpOwogICAgICAgICAgICAgLyogY29u
ZmlnIGJ5dGUgYWNjb3JkaW5nIHRvIHBhZ2UgMzVmZiAqLwogICAgICAgICAgICAgcy0+Y29uZmln
WzJdICY9IDB4ODI7IC8qIG1hc2sgdmFsaWQgYml0cyAqLwogICAgICAgICAgICAgcy0+Y29uZmln
WzJdIHw9IDB4NDA7CkBAIC02NDcsOCArNjQ1LDggQEAgc3NpemVfdCBpODI1OTZfcmVjZWl2ZShO
ZXRDbGllbnRTdGF0ZSAqbmMsIGNvbnN0IHVpbnQ4X3QgKmJ1Ziwgc2l6ZV90IHN6KQogICAgICAg
ICAgICAgYnVmICs9IG51bTsKICAgICAgICAgICAgIGxlbiAtPSBudW07CiAgICAgICAgICAgICBp
ZiAobGVuID09IDApIHsgLyogY29weSBjcmMgKi8KLSAgICAgICAgICAgICAgICBhZGRyZXNzX3Nw
YWNlX3J3KCZhZGRyZXNzX3NwYWNlX21lbW9yeSwgcmJhIC0gNCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIGNyY19wdHIsIDQsIHRydWUp
OworICAgICAgICAgICAgICAgIGFkZHJlc3Nfc3BhY2Vfd3JpdGUoJmFkZHJlc3Nfc3BhY2VfbWVt
b3J5LCByYmEgLSA0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVNVFhB
VFRSU19VTlNQRUNJRklFRCwgY3JjX3B0ciwgNCk7CiAgICAgICAgICAgICB9CiAKICAgICAgICAg
ICAgIG51bSB8PSAweDQwMDA7IC8qIHNldCBGIEJJVCAqLwpkaWZmIC0tZ2l0IGEvaHcvbmV0L2xh
c2lfaTgyNTk2LmMgYi9ody9uZXQvbGFzaV9pODI1OTYuYwppbmRleCA4YmZmNDE5Mzc4Li41MjYz
N2E1NjJkIDEwMDY0NAotLS0gYS9ody9uZXQvbGFzaV9pODI1OTYuYworKysgYi9ody9uZXQvbGFz
aV9pODI1OTYuYwpAQCAtNTUsOCArNTUsOSBAQCBzdGF0aWMgdm9pZCBsYXNpXzgyNTk2X21lbV93
cml0ZSh2b2lkICpvcGFxdWUsIGh3YWRkciBhZGRyLAogICAgICAgICAgKiBQcm92aWRlZCBmb3Ig
U2VhQklPUyBvbmx5LiBXcml0ZSBNQUMgb2YgTmV0d29yayBjYXJkIHRvIGFkZHIgQHZhbC4KICAg
ICAgICAgICogTmVlZGVkIGZvciB0aGUgUERDX0xBTl9TVEFUSU9OX0lEX1JFQUQgUERDIGNhbGwu
CiAgICAgICAgICAqLwotICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KCZhZGRyZXNzX3NwYWNlX21l
bW9yeSwgdmFsLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAgICAg
ICAgIGQtPnN0YXRlLmNvbmYubWFjYWRkci5hLCBFVEhfQUxFTiwgdHJ1ZSk7CisgICAgICAgIGFk
ZHJlc3Nfc3BhY2Vfd3JpdGUoJmFkZHJlc3Nfc3BhY2VfbWVtb3J5LCB2YWwsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgZC0+c3RhdGUuY29uZi5t
YWNhZGRyLmEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgRVRIX0FMRU4pOwogICAgICAg
ICBicmVhazsKICAgICB9CiB9CmRpZmYgLS1naXQgYS9ody9wcGMvcG52X2xwYy5jIGIvaHcvcHBj
L3Budl9scGMuYwppbmRleCA1OTg5ZDcyM2M1Li5mMTUwZGVjYTM0IDEwMDY0NAotLS0gYS9ody9w
cGMvcG52X2xwYy5jCisrKyBiL2h3L3BwYy9wbnZfbHBjLmMKQEAgLTIzOCwxNiArMjM4LDE2IEBA
IHN0YXRpYyBib29sIG9wYl9yZWFkKFBudkxwY0NvbnRyb2xsZXIgKmxwYywgdWludDMyX3QgYWRk
ciwgdWludDhfdCAqZGF0YSwKICAgICAgICAgICAgICAgICAgICAgIGludCBzeikKIHsKICAgICAv
KiBYWFggSGFuZGxlIGFjY2VzcyBzaXplIGxpbWl0cyBhbmQgRlcgcmVhZCBjYWNoaW5nIGhlcmUg
Ki8KLSAgICByZXR1cm4gIWFkZHJlc3Nfc3BhY2VfcncoJmxwYy0+b3BiX2FzLCBhZGRyLCBNRU1U
WEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLCBz
eiwgZmFsc2UpOworICAgIHJldHVybiAhYWRkcmVzc19zcGFjZV9yZWFkKCZscGMtPm9wYl9hcywg
YWRkciwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBkYXRhLCBzeik7CiB9CiAKIHN0YXRpYyBib29sIG9wYl93cml0ZShQbnZMcGNDb250cm9s
bGVyICpscGMsIHVpbnQzMl90IGFkZHIsIHVpbnQ4X3QgKmRhdGEsCiAgICAgICAgICAgICAgICAg
ICAgICAgaW50IHN6KQogewogICAgIC8qIFhYWCBIYW5kbGUgYWNjZXNzIHNpemUgbGltaXRzIGhl
cmUgKi8KLSAgICByZXR1cm4gIWFkZHJlc3Nfc3BhY2VfcncoJmxwYy0+b3BiX2FzLCBhZGRyLCBN
RU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRh
LCBzeiwgdHJ1ZSk7CisgICAgcmV0dXJuICFhZGRyZXNzX3NwYWNlX3dyaXRlKCZscGMtPm9wYl9h
cywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZGF0YSwgc3opOwogfQogCiAjZGVmaW5lIEVDQ0JfQ1RMX1JFQUQgICAgICAgICAg
IFBQQ19CSVQoMTUpCmRpZmYgLS1naXQgYS9ody9zMzkweC9jc3MuYyBiL2h3L3MzOTB4L2Nzcy5j
CmluZGV4IGYyN2Y4YzQ1YTUuLjVkOGUwODY2N2UgMTAwNjQ0Ci0tLSBhL2h3L3MzOTB4L2Nzcy5j
CisrKyBiL2h3L3MzOTB4L2Nzcy5jCkBAIC04NzQsMTggKzg3NCwxOCBAQCBzdGF0aWMgaW5saW5l
IGludCBpZGFfcmVhZF9uZXh0X2lkYXcoQ2N3RGF0YVN0cmVhbSAqY2RzKQogICAgICAgICBpZiAo
aWRhd19hZGRyICYgMHgwNyB8fCAhY2RzX2Njd19hZGRyc19vayhpZGF3X2FkZHIsIDAsIGNjd19m
bXQxKSkgewogICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7IC8qIGNoYW5uZWwgcHJvZ3JhbSBj
aGVjayAqLwogICAgICAgICB9Ci0gICAgICAgIHJldCA9IGFkZHJlc3Nfc3BhY2VfcncoJmFkZHJl
c3Nfc3BhY2VfbWVtb3J5LCBpZGF3X2FkZHIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgJmlkYXcuZm10MiwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzaXplb2YoaWRhdy5mbXQyKSwgZmFsc2UpOworICAgICAgICByZXQgPSBh
ZGRyZXNzX3NwYWNlX3JlYWQoJmFkZHJlc3Nfc3BhY2VfbWVtb3J5LCBpZGF3X2FkZHIsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCAmaWRh
dy5mbXQyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKGlkYXcuZm10
MikpOwogICAgICAgICBjZHMtPmNkYSA9IGJlNjRfdG9fY3B1KGlkYXcuZm10Mik7CiAgICAgfSBl
bHNlIHsKICAgICAgICAgaWRhd19hZGRyID0gY2RzLT5jZGFfb3JpZyArIHNpemVvZihpZGF3LmZt
dDEpICogY2RzLT5hdF9pZGF3OwogICAgICAgICBpZiAoaWRhd19hZGRyICYgMHgwMyB8fCAhY2Rz
X2Njd19hZGRyc19vayhpZGF3X2FkZHIsIDAsIGNjd19mbXQxKSkgewogICAgICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7IC8qIGNoYW5uZWwgcHJvZ3JhbSBjaGVjayAqLwogICAgICAgICB9Ci0gICAg
ICAgIHJldCA9IGFkZHJlc3Nfc3BhY2VfcncoJmFkZHJlc3Nfc3BhY2VfbWVtb3J5LCBpZGF3X2Fk
ZHIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklF
RCwgJmlkYXcuZm10MSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplb2YoaWRh
dy5mbXQxKSwgZmFsc2UpOworICAgICAgICByZXQgPSBhZGRyZXNzX3NwYWNlX3JlYWQoJmFkZHJl
c3Nfc3BhY2VfbWVtb3J5LCBpZGF3X2FkZHIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCAmaWRhdy5mbXQxLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc2l6ZW9mKGlkYXcuZm10MSkpOwogICAgICAgICBjZHMtPmNkYSA9
IGJlNjRfdG9fY3B1KGlkYXcuZm10MSk7CiAgICAgICAgIGlmIChjZHMtPmNkYSAmIDB4ODAwMDAw
MDApIHsKICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOyAvKiBjaGFubmVsIHByb2dyYW0gY2hl
Y2sgKi8KZGlmZiAtLWdpdCBhL3F0ZXN0LmMgYi9xdGVzdC5jCmluZGV4IDY1ZTMzYjgwZTMuLmRj
YjU3NDk4YWQgMTAwNjQ0Ci0tLSBhL3F0ZXN0LmMKKysrIGIvcXRlc3QuYwpAQCAtNDI5LDIzICs0
MjksMjMgQEAgc3RhdGljIHZvaWQgcXRlc3RfcHJvY2Vzc19jb21tYW5kKENoYXJCYWNrZW5kICpj
aHIsIGdjaGFyICoqd29yZHMpCiAKICAgICAgICAgaWYgKHdvcmRzWzBdWzVdID09ICdiJykgewog
ICAgICAgICAgICAgdWludDhfdCBkYXRhID0gdmFsdWU7Ci0gICAgICAgICAgICBhZGRyZXNzX3Nw
YWNlX3J3KGZpcnN0X2NwdS0+YXMsIGFkZHIsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZkYXRhLCAxLCB0cnVlKTsKKyAgICAgICAgICAgIGFk
ZHJlc3Nfc3BhY2Vfd3JpdGUoZmlyc3RfY3B1LT5hcywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJ
RklFRCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmRhdGEsIDEpOwogICAgICAg
ICB9IGVsc2UgaWYgKHdvcmRzWzBdWzVdID09ICd3JykgewogICAgICAgICAgICAgdWludDE2X3Qg
ZGF0YSA9IHZhbHVlOwogICAgICAgICAgICAgdHN3YXAxNnMoJmRhdGEpOwotICAgICAgICAgICAg
YWRkcmVzc19zcGFjZV9ydyhmaXJzdF9jcHUtPmFzLCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lG
SUVELAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZGF0YSwgMiwgdHJ1ZSk7CisgICAg
ICAgICAgICBhZGRyZXNzX3NwYWNlX3dyaXRlKGZpcnN0X2NwdS0+YXMsIGFkZHIsIE1FTVRYQVRU
UlNfVU5TUEVDSUZJRUQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZkYXRhLCAy
KTsKICAgICAgICAgfSBlbHNlIGlmICh3b3Jkc1swXVs1XSA9PSAnbCcpIHsKICAgICAgICAgICAg
IHVpbnQzMl90IGRhdGEgPSB2YWx1ZTsKICAgICAgICAgICAgIHRzd2FwMzJzKCZkYXRhKTsKLSAg
ICAgICAgICAgIGFkZHJlc3Nfc3BhY2VfcncoZmlyc3RfY3B1LT5hcywgYWRkciwgTUVNVFhBVFRS
U19VTlNQRUNJRklFRCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmRhdGEsIDQsIHRy
dWUpOworICAgICAgICAgICAgYWRkcmVzc19zcGFjZV93cml0ZShmaXJzdF9jcHUtPmFzLCBhZGRy
LCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAmZGF0YSwgNCk7CiAgICAgICAgIH0gZWxzZSBpZiAod29yZHNbMF1bNV0gPT0gJ3EnKSB7CiAg
ICAgICAgICAgICB1aW50NjRfdCBkYXRhID0gdmFsdWU7CiAgICAgICAgICAgICB0c3dhcDY0cygm
ZGF0YSk7Ci0gICAgICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KGZpcnN0X2NwdS0+YXMsIGFkZHIs
IE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICZk
YXRhLCA4LCB0cnVlKTsKKyAgICAgICAgICAgIGFkZHJlc3Nfc3BhY2Vfd3JpdGUoZmlyc3RfY3B1
LT5hcywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJmRhdGEsIDgpOwogICAgICAgICB9CiAgICAgICAgIHF0ZXN0X3NlbmRfcHJl
Zml4KGNocik7CiAgICAgICAgIHF0ZXN0X3NlbmQoY2hyLCAiT0tcbiIpOwpAQCAtNDYzLDIyICs0
NjMsMjIgQEAgc3RhdGljIHZvaWQgcXRlc3RfcHJvY2Vzc19jb21tYW5kKENoYXJCYWNrZW5kICpj
aHIsIGdjaGFyICoqd29yZHMpCiAKICAgICAgICAgaWYgKHdvcmRzWzBdWzRdID09ICdiJykgewog
ICAgICAgICAgICAgdWludDhfdCBkYXRhOwotICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9ydyhm
aXJzdF9jcHUtPmFzLCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAmZGF0YSwgMSwgZmFsc2UpOworICAgICAgICAgICAgYWRkcmVzc19z
cGFjZV9yZWFkKGZpcnN0X2NwdS0+YXMsIGFkZHIsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmRhdGEsIDEpOwogICAgICAgICAgICAgdmFs
dWUgPSBkYXRhOwogICAgICAgICB9IGVsc2UgaWYgKHdvcmRzWzBdWzRdID09ICd3JykgewogICAg
ICAgICAgICAgdWludDE2X3QgZGF0YTsKLSAgICAgICAgICAgIGFkZHJlc3Nfc3BhY2VfcncoZmly
c3RfY3B1LT5hcywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJmRhdGEsIDIsIGZhbHNlKTsKKyAgICAgICAgICAgIGFkZHJlc3Nfc3Bh
Y2VfcmVhZChmaXJzdF9jcHUtPmFzLCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZkYXRhLCAyKTsKICAgICAgICAgICAgIHZhbHVl
ID0gdHN3YXAxNihkYXRhKTsKICAgICAgICAgfSBlbHNlIGlmICh3b3Jkc1swXVs0XSA9PSAnbCcp
IHsKICAgICAgICAgICAgIHVpbnQzMl90IGRhdGE7Ci0gICAgICAgICAgICBhZGRyZXNzX3NwYWNl
X3J3KGZpcnN0X2NwdS0+YXMsIGFkZHIsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICZkYXRhLCA0LCBmYWxzZSk7CisgICAgICAgICAgICBhZGRy
ZXNzX3NwYWNlX3JlYWQoZmlyc3RfY3B1LT5hcywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJRklF
RCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmZGF0YSwgNCk7CiAgICAgICAgICAg
ICB2YWx1ZSA9IHRzd2FwMzIoZGF0YSk7CiAgICAgICAgIH0gZWxzZSBpZiAod29yZHNbMF1bNF0g
PT0gJ3EnKSB7Ci0gICAgICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KGZpcnN0X2NwdS0+YXMsIGFk
ZHIsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICZ2YWx1ZSwgOCwgZmFsc2UpOworICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKGZpcnN0
X2NwdS0+YXMsIGFkZHIsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJnZhbHVlLCA4KTsKICAgICAgICAgICAgIHRzd2FwNjRzKCZ2YWx1ZSk7
CiAgICAgICAgIH0KICAgICAgICAgcXRlc3Rfc2VuZF9wcmVmaXgoY2hyKTsKQEAgLTQ5OCw4ICs0
OTgsOCBAQCBzdGF0aWMgdm9pZCBxdGVzdF9wcm9jZXNzX2NvbW1hbmQoQ2hhckJhY2tlbmQgKmNo
ciwgZ2NoYXIgKip3b3JkcykKICAgICAgICAgZ19hc3NlcnQobGVuKTsKIAogICAgICAgICBkYXRh
ID0gZ19tYWxsb2MobGVuKTsKLSAgICAgICAgYWRkcmVzc19zcGFjZV9ydyhmaXJzdF9jcHUtPmFz
LCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAgICAgICAg
IGRhdGEsIGxlbiwgZmFsc2UpOworICAgICAgICBhZGRyZXNzX3NwYWNlX3JlYWQoZmlyc3RfY3B1
LT5hcywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJRklFRCwgZGF0YSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGxlbik7CiAKICAgICAgICAgZW5jID0gZ19tYWxsb2MoMiAqIGxlbiArIDEp
OwogICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKQEAgLTUyNCw4ICs1MjQsOCBA
QCBzdGF0aWMgdm9pZCBxdGVzdF9wcm9jZXNzX2NvbW1hbmQoQ2hhckJhY2tlbmQgKmNociwgZ2No
YXIgKip3b3JkcykKICAgICAgICAgZ19hc3NlcnQocmV0ID09IDApOwogCiAgICAgICAgIGRhdGEg
PSBnX21hbGxvYyhsZW4pOwotICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KGZpcnN0X2NwdS0+YXMs
IGFkZHIsIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ZGF0YSwgbGVuLCBmYWxzZSk7CisgICAgICAgIGFkZHJlc3Nfc3BhY2VfcmVhZChmaXJzdF9jcHUt
PmFzLCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBkYXRhLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGVuKTsKICAgICAgICAgYjY0X2RhdGEgPSBnX2Jhc2U2NF9lbmNvZGUoZGF0
YSwgbGVuKTsKICAgICAgICAgcXRlc3Rfc2VuZF9wcmVmaXgoY2hyKTsKICAgICAgICAgcXRlc3Rf
c2VuZGYoY2hyLCAiT0sgJXNcbiIsIGI2NF9kYXRhKTsKQEAgLTU1OSw4ICs1NTksOCBAQCBzdGF0
aWMgdm9pZCBxdGVzdF9wcm9jZXNzX2NvbW1hbmQoQ2hhckJhY2tlbmQgKmNociwgZ2NoYXIgKip3
b3JkcykKICAgICAgICAgICAgICAgICBkYXRhW2ldID0gMDsKICAgICAgICAgICAgIH0KICAgICAg
ICAgfQotICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KGZpcnN0X2NwdS0+YXMsIGFkZHIsIE1FTVRY
QVRUUlNfVU5TUEVDSUZJRUQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSwgbGVuLCB0
cnVlKTsKKyAgICAgICAgYWRkcmVzc19zcGFjZV93cml0ZShmaXJzdF9jcHUtPmFzLCBhZGRyLCBN
RU1UWEFUVFJTX1VOU1BFQ0lGSUVELCBkYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxlbik7CiAgICAgICAgIGdfZnJlZShkYXRhKTsKIAogICAgICAgICBxdGVzdF9zZW5kX3ByZWZp
eChjaHIpOwpAQCAtNTgyLDggKzU4Miw4IEBAIHN0YXRpYyB2b2lkIHF0ZXN0X3Byb2Nlc3NfY29t
bWFuZChDaGFyQmFja2VuZCAqY2hyLCBnY2hhciAqKndvcmRzKQogICAgICAgICBpZiAobGVuKSB7
CiAgICAgICAgICAgICBkYXRhID0gZ19tYWxsb2MobGVuKTsKICAgICAgICAgICAgIG1lbXNldChk
YXRhLCBwYXR0ZXJuLCBsZW4pOwotICAgICAgICAgICAgYWRkcmVzc19zcGFjZV9ydyhmaXJzdF9j
cHUtPmFzLCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkYXRhLCBsZW4sIHRydWUpOworICAgICAgICAgICAgYWRkcmVzc19zcGFjZV93
cml0ZShmaXJzdF9jcHUtPmFzLCBhZGRyLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLCBsZW4pOwogICAgICAgICAgICAgZ19mcmVl
KGRhdGEpOwogICAgICAgICB9CiAKQEAgLTYxNiw4ICs2MTYsOCBAQCBzdGF0aWMgdm9pZCBxdGVz
dF9wcm9jZXNzX2NvbW1hbmQoQ2hhckJhY2tlbmQgKmNociwgZ2NoYXIgKip3b3JkcykKICAgICAg
ICAgICAgIG91dF9sZW4gPSBNSU4ob3V0X2xlbiwgbGVuKTsKICAgICAgICAgfQogCi0gICAgICAg
IGFkZHJlc3Nfc3BhY2VfcncoZmlyc3RfY3B1LT5hcywgYWRkciwgTUVNVFhBVFRSU19VTlNQRUNJ
RklFRCwKLSAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLCBsZW4sIHRydWUpOworICAgICAg
ICBhZGRyZXNzX3NwYWNlX3dyaXRlKGZpcnN0X2NwdS0+YXMsIGFkZHIsIE1FTVRYQVRUUlNfVU5T
UEVDSUZJRUQsIGRhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuKTsKIAogICAg
ICAgICBxdGVzdF9zZW5kX3ByZWZpeChjaHIpOwogICAgICAgICBxdGVzdF9zZW5kKGNociwgIk9L
XG4iKTsKZGlmZiAtLWdpdCBhL3RhcmdldC9pMzg2L2h2Zi94ODZfbW11LmMgYi90YXJnZXQvaTM4
Ni9odmYveDg2X21tdS5jCmluZGV4IDQ1MWRjYzk4M2EuLjY1ZDQ2MDNkYmYgMTAwNjQ0Ci0tLSBh
L3RhcmdldC9pMzg2L2h2Zi94ODZfbW11LmMKKysrIGIvdGFyZ2V0L2kzODYvaHZmL3g4Nl9tbXUu
YwpAQCAtODgsOCArODgsOCBAQCBzdGF0aWMgYm9vbCBnZXRfcHRfZW50cnkoc3RydWN0IENQVVN0
YXRlICpjcHUsIHN0cnVjdCBncHRfdHJhbnNsYXRpb24gKnB0LAogICAgIH0KIAogICAgIGluZGV4
ID0gZ3B0X2VudHJ5KHB0LT5ndmEsIGxldmVsLCBwYWUpOwotICAgIGFkZHJlc3Nfc3BhY2Vfcnco
JmFkZHJlc3Nfc3BhY2VfbWVtb3J5LCBncGEgKyBpbmRleCAqIHB0ZV9zaXplKHBhZSksCi0gICAg
ICAgICAgICAgICAgICAgICBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELCAmcHRlLCBwdGVfc2l6ZShw
YWUpLCBmYWxzZSk7CisgICAgYWRkcmVzc19zcGFjZV9yZWFkKCZhZGRyZXNzX3NwYWNlX21lbW9y
eSwgZ3BhICsgaW5kZXggKiBwdGVfc2l6ZShwYWUpLAorICAgICAgICAgICAgICAgICAgICAgICBN
RU1UWEFUVFJTX1VOU1BFQ0lGSUVELCAmcHRlLCBwdGVfc2l6ZShwYWUpKTsKIAogICAgIHB0LT5w
dGVbbGV2ZWwgLSAxXSA9IHB0ZTsKIApAQCAtMjM4LDggKzIzOCw4IEBAIHZvaWQgdm14X3dyaXRl
X21lbShzdHJ1Y3QgQ1BVU3RhdGUgKmNwdSwgdGFyZ2V0X3Vsb25nIGd2YSwgdm9pZCAqZGF0YSwg
aW50IGJ5dGVzCiAgICAgICAgIGlmICghbW11X2d2YV90b19ncGEoY3B1LCBndmEsICZncGEpKSB7
CiAgICAgICAgICAgICBWTV9QQU5JQ19FWCgiJXM6IG1tdV9ndmFfdG9fZ3BhICVsbHggZmFpbGVk
XG4iLCBfX2Z1bmNfXywgZ3ZhKTsKICAgICAgICAgfSBlbHNlIHsKLSAgICAgICAgICAgIGFkZHJl
c3Nfc3BhY2VfcncoJmFkZHJlc3Nfc3BhY2VfbWVtb3J5LCBncGEsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIE1FTVRYQVRUUlNfVU5TUEVDSUZJRUQsIGRhdGEsIGNvcHksIHRydWUpOwor
ICAgICAgICAgICAgYWRkcmVzc19zcGFjZV93cml0ZSgmYWRkcmVzc19zcGFjZV9tZW1vcnksIGdw
YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTUVNVFhBVFRSU19VTlNQRUNJRklF
RCwgZGF0YSwgY29weSk7CiAgICAgICAgIH0KIAogICAgICAgICBieXRlcyAtPSBjb3B5OwpAQCAt
MjU5LDggKzI1OSw4IEBAIHZvaWQgdm14X3JlYWRfbWVtKHN0cnVjdCBDUFVTdGF0ZSAqY3B1LCB2
b2lkICpkYXRhLCB0YXJnZXRfdWxvbmcgZ3ZhLCBpbnQgYnl0ZXMpCiAgICAgICAgIGlmICghbW11
X2d2YV90b19ncGEoY3B1LCBndmEsICZncGEpKSB7CiAgICAgICAgICAgICBWTV9QQU5JQ19FWCgi
JXM6IG1tdV9ndmFfdG9fZ3BhICVsbHggZmFpbGVkXG4iLCBfX2Z1bmNfXywgZ3ZhKTsKICAgICAg
ICAgfQotICAgICAgICBhZGRyZXNzX3NwYWNlX3J3KCZhZGRyZXNzX3NwYWNlX21lbW9yeSwgZ3Bh
LCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAotICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEs
IGNvcHksIGZhbHNlKTsKKyAgICAgICAgYWRkcmVzc19zcGFjZV9yZWFkKCZhZGRyZXNzX3NwYWNl
X21lbW9yeSwgZ3BhLCBNRU1UWEFUVFJTX1VOU1BFQ0lGSUVELAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZGF0YSwgY29weSk7CiAKICAgICAgICAgYnl0ZXMgLT0gY29weTsKICAgICAgICAg
Z3ZhICs9IGNvcHk7Ci0tIAoyLjIxLjEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54
ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGlu
Zm8veGVuLWRldmVs

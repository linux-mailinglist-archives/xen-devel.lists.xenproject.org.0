Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 89933C1AEC
	for <lists+xen-devel@lfdr.de>; Mon, 30 Sep 2019 07:24:13 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEo8k-0002cy-Hy; Mon, 30 Sep 2019 05:22:30 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=hbFO=XZ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iEo8j-0002bx-BD
 for xen-devel@lists.xenproject.org; Mon, 30 Sep 2019 05:22:29 +0000
X-Inumbo-ID: 31b6ca00-e342-11e9-bf31-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 31b6ca00-e342-11e9-bf31-bc764e2007e4;
 Mon, 30 Sep 2019 05:21:45 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 4D373B114;
 Mon, 30 Sep 2019 05:21:43 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 30 Sep 2019 07:21:31 +0200
Message-Id: <20190930052135.11257-16-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190930052135.11257-1-jgross@suse.com>
References: <20190930052135.11257-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v5 15/19] xen/sched: support multiple cpus per
 scheduling resource
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

UHJlcGFyZSBzdXBwb3J0aW5nIG11bHRpcGxlIGNwdXMgcGVyIHNjaGVkdWxpbmcgcmVzb3VyY2Ug
YnkgYWxsb2NhdGluZwp0aGUgY3B1bWFzayBwZXIgcmVzb3VyY2UgZHluYW1pY2FsbHkuCgpNb2Rp
Znkgc2NoZWRfcmVzX21hc2sgdG8gaGF2ZSBvbmx5IG9uZSBiaXQgcGVyIHNjaGVkdWxpbmcgcmVz
b3VyY2Ugc2V0LgoKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29t
PgpSZXZpZXdlZC1ieTogRGFyaW8gRmFnZ2lvbGkgPGRmYWdnaW9saUBzdXNlLmNvbT4KLS0tClYx
OiBuZXcgcGF0Y2ggKGNhcnZlZCBvdXQgZnJvbSBvdGhlciBwYXRjaCkKVjQ6Ci0gdXNlIGNwdW1h
c2tfdCBmb3Igc2NoZWRfcmVzX21hc2sgKEphbiBCZXVsaWNoKQotIGNsZWFyIGNwdSBpbiBzY2hl
ZF9yZXNfbWFzayB3aGVuIHRha2luZyBjcHUgYXdheSAoSmFuIEJldWxpY2gpCi0tLQogeGVuL2Nv
bW1vbi9jcHVwb29sLmMgICAgICAgfCAgNCArKy0tCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAg
ICB8IDE1ICsrKysrKysrKysrKystLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmggfCAgNCAr
Ky0tCiAzIGZpbGVzIGNoYW5nZWQsIDE3IGluc2VydGlvbnMoKyksIDYgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9jcHVwb29sLmMgYi94ZW4vY29tbW9uL2NwdXBvb2wuYwpp
bmRleCA3MjI4Y2E4NGI0Li4xM2RmZmFhZGNmIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL2NwdXBv
b2wuYworKysgYi94ZW4vY29tbW9uL2NwdXBvb2wuYwpAQCAtMjgzLDcgKzI4Myw3IEBAIHN0YXRp
YyBpbnQgY3B1cG9vbF9hc3NpZ25fY3B1X2xvY2tlZChzdHJ1Y3QgY3B1cG9vbCAqYywgdW5zaWdu
ZWQgaW50IGNwdSkKICAgICAgICAgY3B1cG9vbF9jcHVfbW92aW5nID0gTlVMTDsKICAgICB9CiAg
ICAgY3B1bWFza19zZXRfY3B1KGNwdSwgYy0+Y3B1X3ZhbGlkKTsKLSAgICBjcHVtYXNrX2FuZChj
LT5yZXNfdmFsaWQsIGMtPmNwdV92YWxpZCwgc2NoZWRfcmVzX21hc2spOworICAgIGNwdW1hc2tf
YW5kKGMtPnJlc192YWxpZCwgYy0+Y3B1X3ZhbGlkLCAmc2NoZWRfcmVzX21hc2spOwogCiAgICAg
cmN1X3JlYWRfbG9jaygmZG9tbGlzdF9yZWFkX2xvY2spOwogICAgIGZvcl9lYWNoX2RvbWFpbl9p
bl9jcHVwb29sKGQsIGMpCkBAIC0zNzYsNyArMzc2LDcgQEAgc3RhdGljIGludCBjcHVwb29sX3Vu
YXNzaWduX2NwdV9zdGFydChzdHJ1Y3QgY3B1cG9vbCAqYywgdW5zaWduZWQgaW50IGNwdSkKICAg
ICBhdG9taWNfaW5jKCZjLT5yZWZjbnQpOwogICAgIGNwdXBvb2xfY3B1X21vdmluZyA9IGM7CiAg
ICAgY3B1bWFza19jbGVhcl9jcHUoY3B1LCBjLT5jcHVfdmFsaWQpOwotICAgIGNwdW1hc2tfYW5k
KGMtPnJlc192YWxpZCwgYy0+Y3B1X3ZhbGlkLCBzY2hlZF9yZXNfbWFzayk7CisgICAgY3B1bWFz
a19hbmQoYy0+cmVzX3ZhbGlkLCBjLT5jcHVfdmFsaWQsICZzY2hlZF9yZXNfbWFzayk7CiAKIG91
dDoKICAgICBzcGluX3VubG9jaygmY3B1cG9vbF9sb2NrKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21t
b24vc2NoZWR1bGUuYyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwppbmRleCAxZjIzYmYwZTgzLi5l
ZmUwNzdiMDFmIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMKKysrIGIveGVuL2Nv
bW1vbi9zY2hlZHVsZS5jCkBAIC02Myw3ICs2Myw3IEBAIGludGVnZXJfcGFyYW0oInNjaGVkX3Jh
dGVsaW1pdF91cyIsIHNjaGVkX3JhdGVsaW1pdF91cyk7CiAKIC8qIE51bWJlciBvZiB2Y3B1cyBw
ZXIgc3RydWN0IHNjaGVkX3VuaXQuICovCiBib29sIF9fcmVhZF9tb3N0bHkgc2NoZWRfZGlzYWJs
ZV9zbXRfc3dpdGNoaW5nOwotY29uc3QgY3B1bWFza190ICpzY2hlZF9yZXNfbWFzayA9ICZjcHVt
YXNrX2FsbDsKK2NwdW1hc2tfdCBzY2hlZF9yZXNfbWFzazsKIAogLyogQ29tbW9uIGxvY2sgZm9y
IGZyZWUgY3B1cy4gKi8KIHN0YXRpYyBERUZJTkVfU1BJTkxPQ0soc2NoZWRfZnJlZV9jcHVfbG9j
ayk7CkBAIC0yNDI2LDggKzI0MjYsMTQgQEAgc3RhdGljIGludCBjcHVfc2NoZWR1bGVfdXAodW5z
aWduZWQgaW50IGNwdSkKICAgICBzciA9IHh6YWxsb2Moc3RydWN0IHNjaGVkX3Jlc291cmNlKTsK
ICAgICBpZiAoIHNyID09IE5VTEwgKQogICAgICAgICByZXR1cm4gLUVOT01FTTsKKyAgICBpZiAo
ICF6YWxsb2NfY3B1bWFza192YXIoJnNyLT5jcHVzKSApCisgICAgeworICAgICAgICB4ZnJlZShz
cik7CisgICAgICAgIHJldHVybiAtRU5PTUVNOworICAgIH0KKwogICAgIHNyLT5tYXN0ZXJfY3B1
ID0gY3B1OwotICAgIHNyLT5jcHVzID0gY3B1bWFza19vZihjcHUpOworICAgIGNwdW1hc2tfY29w
eShzci0+Y3B1cywgY3B1bWFza19vZihjcHUpKTsKICAgICBzZXRfc2NoZWRfcmVzKGNwdSwgc3Ip
OwogCiAgICAgc3ItPnNjaGVkdWxlciA9ICZzY2hlZF9pZGxlX29wczsKQEAgLTI0MzksNiArMjQ0
NSw4IEBAIHN0YXRpYyBpbnQgY3B1X3NjaGVkdWxlX3VwKHVuc2lnbmVkIGludCBjcHUpCiAgICAg
LyogV2Ugc3RhcnQgd2l0aCBjcHUgZ3JhbnVsYXJpdHkuICovCiAgICAgc3ItPmdyYW51bGFyaXR5
ID0gMTsKIAorICAgIGNwdW1hc2tfc2V0X2NwdShjcHUsICZzY2hlZF9yZXNfbWFzayk7CisKICAg
ICAvKiBCb290IENQVSBpcyBkZWFsdCB3aXRoIGxhdGVyIGluIHNjaGVkdWxlcl9pbml0KCkuICov
CiAgICAgaWYgKCBjcHUgPT0gMCApCiAgICAgICAgIHJldHVybiAwOwpAQCAtMjQ3MSw2ICsyNDc5
LDcgQEAgc3RhdGljIHZvaWQgc2NoZWRfcmVzX2ZyZWUoc3RydWN0IHJjdV9oZWFkICpoZWFkKQog
ewogICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqc3IgPSBjb250YWluZXJfb2YoaGVhZCwgc3Ry
dWN0IHNjaGVkX3Jlc291cmNlLCByY3UpOwogCisgICAgZnJlZV9jcHVtYXNrX3Zhcihzci0+Y3B1
cyk7CiAgICAgeGZyZWUoc3IpOwogfQogCkBAIC0yNDg0LDcgKzI0OTMsOSBAQCBzdGF0aWMgdm9p
ZCBjcHVfc2NoZWR1bGVfZG93bih1bnNpZ25lZCBpbnQgY3B1KQogCiAgICAga2lsbF90aW1lcigm
c3ItPnNfdGltZXIpOwogCisgICAgY3B1bWFza19jbGVhcl9jcHUoY3B1LCAmc2NoZWRfcmVzX21h
c2spOwogICAgIHNldF9zY2hlZF9yZXMoY3B1LCBOVUxMKTsKKwogICAgIGNhbGxfcmN1KCZzci0+
cmN1LCBzY2hlZF9yZXNfZnJlZSk7CiAKICAgICByY3VfcmVhZF91bmxvY2soJnNjaGVkX3Jlc19y
Y3Vsb2NrKTsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLWlmLmgKaW5kZXggMzk4ODk4NWVlNi4uNzgwNzM1ZGRhMyAxMDA2NDQK
LS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3Nj
aGVkLWlmLmgKQEAgLTI0LDcgKzI0LDcgQEAgZXh0ZXJuIGNwdW1hc2tfdCBjcHVwb29sX2ZyZWVf
Y3B1czsKIGV4dGVybiBpbnQgc2NoZWRfcmF0ZWxpbWl0X3VzOwogCiAvKiBTY2hlZHVsaW5nIHJl
c291cmNlIG1hc2suICovCi1leHRlcm4gY29uc3QgY3B1bWFza190ICpzY2hlZF9yZXNfbWFzazsK
K2V4dGVybiBjcHVtYXNrX3Qgc2NoZWRfcmVzX21hc2s7CiAKIC8qIE51bWJlciBvZiB2Y3B1cyBw
ZXIgc3RydWN0IHNjaGVkX3VuaXQuICovCiBlbnVtIHNjaGVkX2dyYW4gewpAQCAtNTcsNyArNTcs
NyBAQCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgewogICAgIC8qIENwdSB3aXRoIGxvd2VzdCBpZCBp
biBzY2hlZHVsaW5nIHJlc291cmNlLiAqLwogICAgIHVuc2lnbmVkIGludCAgICAgICAgbWFzdGVy
X2NwdTsKICAgICB1bnNpZ25lZCBpbnQgICAgICAgIGdyYW51bGFyaXR5OwotICAgIGNvbnN0IGNw
dW1hc2tfdCAgICAqY3B1czsgICAgICAgICAgIC8qIGNwdXMgY292ZXJlZCBieSB0aGlzIHN0cnVj
dCAgICAgKi8KKyAgICBjcHVtYXNrX3Zhcl90ICAgICAgIGNwdXM7ICAgICAgICAgICAvKiBjcHVz
IGNvdmVyZWQgYnkgdGhpcyBzdHJ1Y3QgICAgICovCiAgICAgc3RydWN0IHJjdV9oZWFkICAgICBy
Y3U7CiB9OwogCi0tIAoyLjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5w
cm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8v
eGVuLWRldmVs

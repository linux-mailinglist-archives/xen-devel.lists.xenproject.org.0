Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 5769DF1AB2
	for <lists+xen-devel@lfdr.de>; Wed,  6 Nov 2019 17:02:25 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iSNhw-0007Wa-3x; Wed, 06 Nov 2019 15:58:56 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=3BZZ=Y6=gmail.com=raistlin.df@srs-us1.protection.inumbo.net>)
 id 1iSNhu-0007WV-7y
 for xen-devel@lists.xenproject.org; Wed, 06 Nov 2019 15:58:54 +0000
X-Inumbo-ID: 54504f76-00ae-11ea-b678-bc764e2007e4
Received: from mail-wr1-f66.google.com (unknown [209.85.221.66])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 54504f76-00ae-11ea-b678-bc764e2007e4;
 Wed, 06 Nov 2019 15:58:53 +0000 (UTC)
Received: by mail-wr1-f66.google.com with SMTP id f2so17562037wrs.11
 for <xen-devel@lists.xenproject.org>; Wed, 06 Nov 2019 07:58:53 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:subject:from:to:cc:date:message-id:user-agent
 :mime-version:content-transfer-encoding;
 bh=PTrMImt4y3y/oG8P/8TUZHYOQbTAJi/JSedi2l4rzfU=;
 b=nDcYoJaCmLFJiiqq43yrYpzo1uUw/NIwgOD3N3CNC0XludD2GSBvG6ZxT5+TJ45Pb/
 ZuiRbrYDPrXxis3a8KNUur2TWKSCQleiorN7aCbOjrjMCqeOl8/GYOeRzGpnOIdE4IxP
 7AMIMjQbuEmtNtqIt6HBLa7EyTbw1JghT2a+k9Qoo7EYz72OOgczSfHA8ztLFCFihlYD
 mdsoc77wzguOhQI7vX2VsMn4b8ZNP6tCMDAL8rkUgLR8Pene0cFH5ZFZcNhHzgSlhcXY
 eV/BsVlXmmg87+q64ZPIqPPxD03a+yVm8MJcFDMGi1rIPMZWivl5sTbUpfRdPX2nTSFG
 U8kA==
X-Gm-Message-State: APjAAAX9/+2N9Drzv/dr3iK6XnGgT3oklD/DFccoYXFYXbpuirP4qSlR
 tsSnjbaAX3BRhMSvAnb9H9Q=
X-Google-Smtp-Source: APXvYqwFJIa88hVUuaCstXcW87Xzi0hMl8LNvzLNy+XiAJVQf7YR7rGMe6fCrJgOb3EyLSOVfLFI+g==
X-Received: by 2002:a5d:4585:: with SMTP id p5mr3468703wrq.134.1573055931891; 
 Wed, 06 Nov 2019 07:58:51 -0800 (PST)
Received: from [192.168.0.35] (87.78.186.89.cust.ip.kpnqwest.it.
 [89.186.78.87])
 by smtp.gmail.com with ESMTPSA id k125sm3667879wmf.2.2019.11.06.07.58.50
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 06 Nov 2019 07:58:50 -0800 (PST)
From: Dario Faggioli <dfaggioli@suse.com>
To: xen-devel@lists.xenproject.org
Date: Wed, 06 Nov 2019 16:58:49 +0100
Message-ID: <157305592941.20672.10855835711915878073.stgit@Palanthas>
User-Agent: StGit/0.19
MIME-Version: 1.0
Subject: [Xen-devel] [BUGFIX PATCH for-4.13] sched: fix dom0less boot with
 the null scheduler
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: George.Dunlap@eu.citrix.com, julien.grall@arm.com, sstabellini@kernel.org,
 jgross@suse.de
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gYSBkb20wbGVzcyBjb25maWd1cmF0aW9uLCBpZiB0aGUgbnVsbCBzY2hlZHVsZXIgaXMgdXNl
ZCwgdGhlIHN5c3RlbQptYXkgZmFpbCB0byBib290LCBiZWNhdXNlIHRoZSBsb29wIGluIG51bGxf
dW5pdF93YWtlKCkgbmV2ZXIgZXhpdHMuCgpCaXNlY3Rpb24gc2hvd2VkIHRoYXQgdGhpcyBiZWhh
dmlvciBvY2N1cnMgc2luY2UgY29tbWl0IGQ1NDVmMWQ2ICgieGVuOgpzY2hlZDogZGVhbCB3aXRo
IHZDUFVzIGJlaW5nIG9yIGJlY29taW5nIG9ubGluZSBvciBvZmZsaW5lIikgYnV0IHRoZQpyZWFs
IHByb2JsZW0gaXMgdGhhdCwgaW4gdGhpcyBjYXNlLCBwaWNrX3JlcygpIGFsd2F5cyByZXR1cm4g
dGhlIHNhbWUKQ1BVLgoKRml4IHRoaXMgYnkgb25seSBkZWFsIHdpdGggdGhlIHNpbXBsZSBjYXNl
LCBpLmUuLCB0aGUgdkNQVSB0aGF0IGlzCmNvbWluZyBvbmxpbmUgY2FuIGJlIGFzc2lnbmVkIHRv
IGEgc2NoZWQuIHJlc291cmNlIHJpZ2h0IGF3YXksIGluCm51bGxfdW5pdF93YWtlKCkuCgpJZiBp
dCBjYW4ndCwganVzdCBhZGQgaXQgdG8gdGhlIHdhaXRxdWV1ZSwgYW5kIHdlIHdpbGwgZGVhbCB3
aXRoIGl0IGluCm51bGxfc2NoZWR1bGUoKSwgYmVpbmcgY2FyZWZ1bCBhYm91dCBub3QgcmFjaW5n
IHdpdGggdmNwdV93YWtlKCkuCgpSZXBvcnRlZC1ieTogU3RlZmFubyBTdGFiZWxsaW5pIDxzc3Rh
YmVsbGluaUBrZXJuZWwub3JnPgpTaWduZWQtb2ZmLWJ5OiBEYXJpbyBGYWdnaW9saSA8ZGZhZ2dp
b2xpQHN1c2UuY29tPgpUZXN0ZWQtYnk6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3N0YWJlbGxpbmlA
a2VybmVsLm9yZz4KLS0tCiB4ZW4vY29tbW9uL3NjaGVkX251bGwuYyB8ICAxMTMgKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA3
NSBpbnNlcnRpb25zKCspLCAzOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vY29tbW9u
L3NjaGVkX251bGwuYyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCmluZGV4IDI1MjU0NjRhN2Mu
Ljg4YmQxMWExODcgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCisrKyBiL3hl
bi9jb21tb24vc2NoZWRfbnVsbC5jCkBAIC01NjgsNTAgKzU2OCw1MiBAQCBzdGF0aWMgdm9pZCBu
dWxsX3VuaXRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsCiAgICAgZWxzZQogICAg
ICAgICBTQ0hFRF9TVEFUX0NSQU5LKHVuaXRfd2FrZV9ub3RfcnVubmFibGUpOwogCisgICAgaWYg
KCBsaWtlbHkocGVyX2NwdShucGMsIGNwdSkudW5pdCA9PSB1bml0KSApCisgICAgeworICAgICAg
ICBjcHVfcmFpc2Vfc29mdGlycShjcHUsIFNDSEVEVUxFX1NPRlRJUlEpOworICAgICAgICByZXR1
cm47CisgICAgfQorCiAgICAgLyoKICAgICAgKiBJZiBhIHVuaXQgaXMgbmVpdGhlciBvbiBhIHBD
UFUgbm9yIGluIHRoZSB3YWl0cXVldWUsIGl0IG1lYW5zIGl0IHdhcwotICAgICAqIG9mZmxpbmUs
IGFuZCB0aGF0IGl0IGlzIG5vdyBjb21pbmcgYmFjayBiZWluZyBvbmxpbmUuCisgICAgICogb2Zm
bGluZSwgYW5kIHRoYXQgaXQgaXMgbm93IGNvbWluZyBiYWNrIGJlaW5nIG9ubGluZS4gSWYgd2Un
cmUgbHVja3ksCisgICAgICogYW5kIGl0J3MgcHJldmlvdXMgcmVzb3VyY2UgaXMgZnJlZSAoYW5k
IGFmZmluaXRpZXMgbWF0Y2gpLCB3ZSBjYW4ganVzdAorICAgICAqIGFzc2lnbiB0aGUgdW5pdCB0
byBpdCAod2Ugb3duIHRoZSBwcm9wZXIgbG9jayBhbHJlYWR5KSBhbmQgYmUgZG9uZS4KICAgICAg
Ki8KLSAgICBpZiAoIHVubGlrZWx5KHBlcl9jcHUobnBjLCBjcHUpLnVuaXQgIT0gdW5pdCAmJiBs
aXN0X2VtcHR5KCZudmMtPndhaXRxX2VsZW0pKSApCisgICAgaWYgKCBwZXJfY3B1KG5wYywgY3B1
KS51bml0ID09IE5VTEwgJiYKKyAgICAgICAgIHVuaXRfY2hlY2tfYWZmaW5pdHkodW5pdCwgY3B1
LCBCQUxBTkNFX0hBUkRfQUZGSU5JVFkpICkKICAgICB7Ci0gICAgICAgIHNwaW5fbG9jaygmcHJ2
LT53YWl0cV9sb2NrKTsKLSAgICAgICAgbGlzdF9hZGRfdGFpbCgmbnZjLT53YWl0cV9lbGVtLCAm
cHJ2LT53YWl0cSk7Ci0gICAgICAgIHNwaW5fdW5sb2NrKCZwcnYtPndhaXRxX2xvY2spOwotCi0g
ICAgICAgIGNwdW1hc2tfYW5kKGNwdW1hc2tfc2NyYXRjaF9jcHUoY3B1KSwgdW5pdC0+Y3B1X2hh
cmRfYWZmaW5pdHksCi0gICAgICAgICAgICAgICAgICAgIGNwdXBvb2xfZG9tYWluX21hc3Rlcl9j
cHVtYXNrKHVuaXQtPmRvbWFpbikpOwotCi0gICAgICAgIGlmICggIWNwdW1hc2tfaW50ZXJzZWN0
cygmcHJ2LT5jcHVzX2ZyZWUsIGNwdW1hc2tfc2NyYXRjaF9jcHUoY3B1KSkgKQorICAgICAgICBp
ZiAoICFoYXNfc29mdF9hZmZpbml0eSh1bml0KSB8fAorICAgICAgICAgICAgIHVuaXRfY2hlY2tf
YWZmaW5pdHkodW5pdCwgY3B1LCBCQUxBTkNFX1NPRlRfQUZGSU5JVFkpICkKICAgICAgICAgewot
ICAgICAgICAgICAgZHByaW50ayhYRU5MT0dfR19XQVJOSU5HLCAiV0FSTklORzogZCVkdiVkIG5v
dCBhc3NpZ25lZCB0byBhbnkgQ1BVIVxuIiwKLSAgICAgICAgICAgICAgICAgICAgdW5pdC0+ZG9t
YWluLT5kb21haW5faWQsIHVuaXQtPnVuaXRfaWQpOworICAgICAgICAgICAgdW5pdF9hc3NpZ24o
cHJ2LCB1bml0LCBjcHUpOworICAgICAgICAgICAgY3B1X3JhaXNlX3NvZnRpcnEoY3B1LCBTQ0hF
RFVMRV9TT0ZUSVJRKTsKICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgfQorICAgIH0KIAot
ICAgICAgICAvKgotICAgICAgICAgKiBOb3cgd2Ugd291bGQgd2FudCB0byBhc3NpZ24gdGhlIHVu
aXQgdG8gY3B1LCBidXQgd2UgY2FuJ3QsIGJlY2F1c2UKLSAgICAgICAgICogd2UgZG9uJ3QgaGF2
ZSB0aGUgbG9jay4gU28sIGxldCdzIGRvIHRoZSBmb2xsb3dpbmc6Ci0gICAgICAgICAqIC0gdHJ5
IHRvIHJlbW92ZSBjcHUgZnJvbSB0aGUgbGlzdCBvZiBmcmVlIGNwdXMsIHRvIGF2b2lkIHJhY2Vz
IHdpdGgKLSAgICAgICAgICogICBvdGhlciBvbmxpbmluZywgaW5zZXJ0aW5nIG9yIG1pZ3JhdGlu
ZyBvcGVyYXRpb25zOwotICAgICAgICAgKiAtIHRpY2tsZSB0aGUgY3B1LCB3aGljaCB3aWxsIHBp
Y2t1cCB3b3JrIGZyb20gdGhlIHdhaXRxdWV1ZSwgYW5kCi0gICAgICAgICAqICAgYXNzaWduIGl0
IHRvIGl0c2VsZjsKLSAgICAgICAgICogLSBpZiB3ZSdyZSByYWNpbmcgYWxyZWFkeSwgYW5kIGlm
IHRoZXJlIHN0aWxsIGFyZSBmcmVlIGNwdXMsIHRyeQotICAgICAgICAgKiAgIGFnYWluLgotICAg
ICAgICAgKi8KLSAgICAgICAgd2hpbGUgKCBjcHVtYXNrX2ludGVyc2VjdHMoJnBydi0+Y3B1c19m
cmVlLCBjcHVtYXNrX3NjcmF0Y2hfY3B1KGNwdSkpICkKLSAgICAgICAgewotICAgICAgICAgICAg
dW5zaWduZWQgaW50IG5ld19jcHUgPSBwaWNrX3JlcyhwcnYsIHVuaXQpLT5tYXN0ZXJfY3B1Owor
ICAgIC8qCisgICAgICogSWYgdGhlIHJlc291cmNlIGlzIG5vdCBmcmVlIChvciBhZmZpbml0aWVz
IGRvIG5vdCBtYXRjaCkgd2UgbmVlZAorICAgICAqIHRvIGFzc2lnbiB1bml0IHRvIHNvbWUgb3Ro
ZXIgb25lLCBidXQgd2UgY2FuJ3QgZG8gaXQgaGVyZSwgYXM6CisgICAgICogLSB3ZSBkb24ndCBv
d24gIHRoZSBwcm9wZXIgbG9jaywKKyAgICAgKiAtIHdlIGNhbid0IGNoYW5nZSB2LT5wcm9jZXNz
b3IgdW5kZXIgdmNwdV93YWtlKCkncyBmZWV0LgorICAgICAqIFNvIHdlIGFkZCBpdCB0byB0aGUg
d2FpdHF1ZXVlLCBhbmQgdGlja2xlIGFsbCB0aGUgZnJlZSBDUFVzIChpZiBhbnkpCisgICAgICog
b24gd2hpY2ggdW5pdCBjYW4gcnVuLiBUaGUgZmlyc3Qgb25lIHRoYXQgc2NoZWR1bGVzIHdpbGwg
cGljayBpdCB1cC4KKyAgICAgKi8KKyAgICBzcGluX2xvY2soJnBydi0+d2FpdHFfbG9jayk7Cisg
ICAgbGlzdF9hZGRfdGFpbCgmbnZjLT53YWl0cV9lbGVtLCAmcHJ2LT53YWl0cSk7CisgICAgc3Bp
bl91bmxvY2soJnBydi0+d2FpdHFfbG9jayk7CiAKLSAgICAgICAgICAgIGlmICggdGVzdF9hbmRf
Y2xlYXJfYml0KG5ld19jcHUsICZwcnYtPmNwdXNfZnJlZSkgKQotICAgICAgICAgICAgewotICAg
ICAgICAgICAgICAgIGNwdV9yYWlzZV9zb2Z0aXJxKG5ld19jcHUsIFNDSEVEVUxFX1NPRlRJUlEp
OwotICAgICAgICAgICAgICAgIHJldHVybjsKLSAgICAgICAgICAgIH0KLSAgICAgICAgfQotICAg
IH0KKyAgICBjcHVtYXNrX2FuZChjcHVtYXNrX3NjcmF0Y2hfY3B1KGNwdSksIHVuaXQtPmNwdV9o
YXJkX2FmZmluaXR5LAorICAgICAgICAgICAgICAgIGNwdXBvb2xfZG9tYWluX21hc3Rlcl9jcHVt
YXNrKHVuaXQtPmRvbWFpbikpOworICAgIGNwdW1hc2tfYW5kKGNwdW1hc2tfc2NyYXRjaF9jcHUo
Y3B1KSwgY3B1bWFza19zY3JhdGNoX2NwdShjcHUpLAorICAgICAgICAgICAgICAgICZwcnYtPmNw
dXNfZnJlZSk7CiAKLSAgICAvKiBOb3RlIHRoYXQgd2UgZ2V0IGhlcmUgb25seSBmb3IgdW5pdHMg
YXNzaWduZWQgdG8gYSBwQ1BVICovCi0gICAgY3B1X3JhaXNlX3NvZnRpcnEoc2NoZWRfdW5pdF9t
YXN0ZXIodW5pdCksIFNDSEVEVUxFX1NPRlRJUlEpOworICAgIGlmICggY3B1bWFza19lbXB0eShj
cHVtYXNrX3NjcmF0Y2hfY3B1KGNwdSkpICkKKyAgICAgICAgZHByaW50ayhYRU5MT0dfR19XQVJO
SU5HLCAiV0FSTklORzogZCVkdiVkIG5vdCBhc3NpZ25lZCB0byBhbnkgQ1BVIVxuIiwKKyAgICAg
ICAgICAgICAgICB1bml0LT5kb21haW4tPmRvbWFpbl9pZCwgdW5pdC0+dW5pdF9pZCk7CisgICAg
ZWxzZQorICAgICAgICBjcHVtYXNrX3JhaXNlX3NvZnRpcnEoY3B1bWFza19zY3JhdGNoX2NwdShj
cHUpLCBTQ0hFRFVMRV9TT0ZUSVJRKTsKIH0KIAogc3RhdGljIHZvaWQgbnVsbF91bml0X3NsZWVw
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKQEAgLTgyNyw2ICs4MjksOCBAQCBzdGF0aWMg
dm9pZCBudWxsX3NjaGVkdWxlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNj
aGVkX3VuaXQgKnByZXYsCiAgICAgICovCiAgICAgaWYgKCB1bmxpa2VseShwcmV2LT5uZXh0X3Rh
c2sgPT0gTlVMTCkgKQogICAgIHsKKyAgICAgICAgYm9vbCB1bml0X2ZvdW5kOworCiAgICAgICAg
IHNwaW5fbG9jaygmcHJ2LT53YWl0cV9sb2NrKTsKIAogICAgICAgICBpZiAoIGxpc3RfZW1wdHko
JnBydi0+d2FpdHEpICkKQEAgLTgzOSw2ICs4NDMsNyBAQCBzdGF0aWMgdm9pZCBudWxsX3NjaGVk
dWxlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnByZXYs
CiAgICAgICAgICAqIGl0IG9ubHkgaW4gY2FzZXMgd2hlcmUgYSBwY3B1IGhhcyBubyB1bml0IGFz
c29jaWF0ZWQgKGUuZy4sIGFzCiAgICAgICAgICAqIHNhaWQgYWJvdmUsIHRoZSBjcHUgaGFzIGp1
c3Qgam9pbmVkIGEgY3B1cG9vbCkuCiAgICAgICAgICAqLworICAgICAgICB1bml0X2ZvdW5kID0g
ZmFsc2U7CiAgICAgICAgIGZvcl9lYWNoX2FmZmluaXR5X2JhbGFuY2Vfc3RlcCggYnMgKQogICAg
ICAgICB7CiAgICAgICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KCB3dmMsICZwcnYtPndhaXRx
LCB3YWl0cV9lbGVtICkKQEAgLTg0OSwxMyArODU0LDQ1IEBAIHN0YXRpYyB2b2lkIG51bGxfc2No
ZWR1bGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqcHJl
diwKIAogICAgICAgICAgICAgICAgIGlmICggdW5pdF9jaGVja19hZmZpbml0eSh3dmMtPnVuaXQs
IHNjaGVkX2NwdSwgYnMpICkKICAgICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgICAg
IHVuaXRfYXNzaWduKHBydiwgd3ZjLT51bml0LCBzY2hlZF9jcHUpOwotICAgICAgICAgICAgICAg
ICAgICBsaXN0X2RlbF9pbml0KCZ3dmMtPndhaXRxX2VsZW0pOwotICAgICAgICAgICAgICAgICAg
ICBwcmV2LT5uZXh0X3Rhc2sgPSB3dmMtPnVuaXQ7Ci0gICAgICAgICAgICAgICAgICAgIGdvdG8g
dW5sb2NrOworICAgICAgICAgICAgICAgICAgICBzcGlubG9ja190ICpsb2NrOworCisgICAgICAg
ICAgICAgICAgICAgIHVuaXRfZm91bmQgPSB0cnVlOworCisgICAgICAgICAgICAgICAgICAgIC8q
CisgICAgICAgICAgICAgICAgICAgICAqIElmIHRoZSB1bml0IGluIHRoZSB3YWl0cXVldWUgaGFz
IGp1c3QgY29tZSB1cCBvbmxpbmUsCisgICAgICAgICAgICAgICAgICAgICAqIHdlIHJpc2sgcmFj
aW5nIHdpdGggdmNwdV93YWtlKCkuIFRvIGF2b2lkIHRoaXMsIHN5bmMKKyAgICAgICAgICAgICAg
ICAgICAgICogb24gdGhlIHNwaW5sb2NrIHRoYXQgdmNwdV93YWtlKCkgaG9sZHMsIGJ1dCBvbmx5
IHdpdGgKKyAgICAgICAgICAgICAgICAgICAgICogdHJ5bG9jaywgdG8gYXZvaWQgZGVhZGxvY2sp
LgorICAgICAgICAgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgICAgICAgICAgbG9jayA9IHBj
cHVfc2NoZWR1bGVfdHJ5bG9jayhzY2hlZF91bml0X21hc3Rlcih3dmMtPnVuaXQpKTsKKworICAg
ICAgICAgICAgICAgICAgICAvKgorICAgICAgICAgICAgICAgICAgICAgKiBXZSBrbm93IHRoZSB2
Y3B1J3MgbG9jayBpcyBub3QgdGhpcyByZXNvdXJjZSdzIGxvY2suIEluCisgICAgICAgICAgICAg
ICAgICAgICAqIGZhY3QsIGlmIGl0IHdlcmUsIHNpbmNlIHRoaXMgY3B1IGlzIGZyZWUsIHZjcHVf
d2FrZSgpCisgICAgICAgICAgICAgICAgICAgICAqIHdvdWxkIGhhdmUgYXNzaWduZWQgdGhlIHVu
aXQgdG8gaGVyZSBkaXJlY3RseS4KKyAgICAgICAgICAgICAgICAgICAgICovCisgICAgICAgICAg
ICAgICAgICAgIEFTU0VSVChsb2NrICE9IGdldF9zY2hlZF9yZXMoc2NoZWRfY3B1KS0+c2NoZWR1
bGVfbG9jayk7CisKKyAgICAgICAgICAgICAgICAgICAgaWYgKCBsb2NrICkgeworICAgICAgICAg
ICAgICAgICAgICAgICAgdW5pdF9hc3NpZ24ocHJ2LCB3dmMtPnVuaXQsIHNjaGVkX2NwdSk7Cisg
ICAgICAgICAgICAgICAgICAgICAgICBsaXN0X2RlbF9pbml0KCZ3dmMtPndhaXRxX2VsZW0pOwor
ICAgICAgICAgICAgICAgICAgICAgICAgcHJldi0+bmV4dF90YXNrID0gd3ZjLT51bml0OworICAg
ICAgICAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2sobG9jayk7CisgICAgICAgICAgICAgICAg
ICAgICAgICBnb3RvIHVubG9jazsKKyAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgIH0KICAgICAgICAgfQorICAgICAgICAvKgorICAgICAgICAgKiBJ
ZiB3ZSBkaWQgZmluZCBhIHVuaXQgd2l0aCBzdWl0YWJsZSBhZmZpbml0eSBpbiB0aGUgd2FpdHF1
ZXVlLCBidXQKKyAgICAgICAgICogd2UgY291bGQgbm90IHBpY2sgaXQgdXAgKGR1ZSB0byBsb2Nr
IGNvbnRlbnRpb24pLCBhbmQgaGVuY2Ugd2UgYXJlCisgICAgICAgICAqIHN0aWxsIGZyZWUsIHBs
YW4gZm9yIGFub3RoZXIgdHJ5LiBJbiBmYWN0LCB3ZSBkb24ndCB3YW50IHN1Y2ggdW5pdAorICAg
ICAgICAgKiB0byBiZSBzdHVjayBpbiB0aGUgd2FpdHF1ZXVlLCB3aGVuIHRoZXJlIGFyZSBmcmVl
IGNwdXMgd2hlcmUgaXQKKyAgICAgICAgICogY291bGQgcnVuLgorICAgICAgICAgKi8KKyAgICAg
ICAgaWYgKCB1bmxpa2VseSggdW5pdF9mb3VuZCAmJiBwcmV2LT5uZXh0X3Rhc2sgPT0gTlVMTCAm
JgorICAgICAgICAgICAgICAgICAgICAgICAhbGlzdF9lbXB0eSgmcHJ2LT53YWl0cSkpICkKKyAg
ICAgICAgICAgIGNwdV9yYWlzZV9zb2Z0aXJxKGN1cl9jcHUsIFNDSEVEVUxFX1NPRlRJUlEpOwog
IHVubG9jazoKICAgICAgICAgc3Bpbl91bmxvY2soJnBydi0+d2FpdHFfbG9jayk7CiAKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

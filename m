Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D73A2C1F4D
	for <lists+xen-devel@lfdr.de>; Mon, 30 Sep 2019 12:39:46 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEt2q-0002By-QV; Mon, 30 Sep 2019 10:36:44 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=Wfc7=XZ=amazon.com=prvs=169663feb=hongyax@srs-us1.protection.inumbo.net>)
 id 1iEt2o-00029B-Th
 for xen-devel@lists.xenproject.org; Mon, 30 Sep 2019 10:36:43 +0000
X-Inumbo-ID: 2d56d4e2-e36e-11e9-96cd-12813bfff9fa
Received: from smtp-fw-9102.amazon.com (unknown [207.171.184.29])
 by localhost (Halon) with ESMTPS
 id 2d56d4e2-e36e-11e9-96cd-12813bfff9fa;
 Mon, 30 Sep 2019 10:36:35 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
 t=1569839795; x=1601375795;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=nfGSWN5Y1rPyNG2ge/RB1cPsx0Tplxti2wvDbpJTwgA=;
 b=biixubPhygHN6RBVjOGGsJt63UKjF5OncVyfO8+f6KhTm1/jg8JIrDta
 ABTKVO6k4LdweLYol2iGTUcK3voJINkMNnG5YUfjpDK9YT1JTA2nGQz+T
 Wvoyqx4plSe4uiw4g+qOWVSjThPlNxGzU9bytOS+LvUKupEIXm9rGJvc3 g=;
X-IronPort-AV: E=Sophos;i="5.64,565,1559520000"; d="scan'208";a="705521405"
Received: from sea3-co-svc-lb6-vlan3.sea.amazon.com (HELO
 email-inbound-relay-1e-17c49630.us-east-1.amazon.com) ([10.47.22.38])
 by smtp-border-fw-out-9102.sea19.amazon.com with ESMTP;
 30 Sep 2019 10:35:18 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1e-17c49630.us-east-1.amazon.com (Postfix) with ESMTPS
 id E69C6A229F; Mon, 30 Sep 2019 10:35:01 +0000 (UTC)
Received: from EX13D28EUC004.ant.amazon.com (10.43.164.80) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.243) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 30 Sep 2019 10:34:43 +0000
Received: from EX13MTAUEE001.ant.amazon.com (10.43.62.200) by
 EX13D28EUC004.ant.amazon.com (10.43.164.80) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 30 Sep 2019 10:34:42 +0000
Received: from u9d785c4ba99158.ant.amazon.com (10.125.106.78) by
 mail-relay.amazon.com (10.43.62.226) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Mon, 30 Sep 2019 10:34:40 +0000
From: Hongyan Xia <hongyax@amazon.com>
To: <xen-devel@lists.xenproject.org>
Date: Mon, 30 Sep 2019 11:33:47 +0100
Message-ID: <206a716dacbbc96daca32e683ef11b6edc43725e.1569833766.git.hongyax@amazon.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <cover.1569833766.git.hongyax@amazon.com>
References: <cover.1569833766.git.hongyax@amazon.com>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v2 55/55] x86/mm: drop _new suffix for page
 table APIs
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Hongyan Xia <hongyax@amazon.com>,
 Wei Liu <wl@xen.org>, Jan Beulich <jbeulich@suse.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogV2VpIExpdSA8d2VpLmxpdTJAY2l0cml4LmNvbT4KClNpZ25lZC1vZmYtYnk6IFdlaSBM
aXUgPHdlaS5saXUyQGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEhvbmd5YW4gWGlhIDxob25n
eWF4QGFtYXpvbi5jb20+CgotLS0KQ2hhbmdlZCBzaW5jZSB2MToKLSBGaXggcmViYXNlIGNvbmZs
aWN0cyBhZ2FpbnN0IG5ldyBtYXN0ZXIgYW5kIG90aGVyIGNoYW5nZXMgc2luY2UgdjEuCi0tLQog
eGVuL2FyY2gveDg2L2RvbWFpbi5jICAgICAgICB8ICAgNCArLQogeGVuL2FyY2gveDg2L2RvbWFp
bl9wYWdlLmMgICB8ICAgMiArLQogeGVuL2FyY2gveDg2L2VmaS9ydW50aW1lLmggICB8ICAgNCAr
LQogeGVuL2FyY2gveDg2L21tLmMgICAgICAgICAgICB8IDE2NCArKysrKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLS0tLS0tLQogeGVuL2FyY2gveDg2L3B2L2RvbTBfYnVpbGQuYyB8ICAyOCArKyst
LS0KIHhlbi9hcmNoL3g4Ni9wdi9zaGltLmMgICAgICAgfCAgMTIgKy0tCiB4ZW4vYXJjaC94ODYv
c2V0dXAuYyAgICAgICAgIHwgICA4ICstCiB4ZW4vYXJjaC94ODYvc21wYm9vdC5jICAgICAgIHwg
IDc0ICsrKysrKysrLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni94ODZfNjQvbW0uYyAgICAgfCAxMzYg
KysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0KIHhlbi9jb21tb24vZWZpL2Jvb3QuYyAgICAg
ICAgfCAgNDIgKysrKy0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21tLmggICAgIHwgIDE4ICsr
LS0KIDExIGZpbGVzIGNoYW5nZWQsIDI0NiBpbnNlcnRpb25zKCspLCAyNDYgZGVsZXRpb25zKC0p
CgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2RvbWFpbi5jIGIveGVuL2FyY2gveDg2L2RvbWFp
bi5jCmluZGV4IGU5YmY0N2VmY2UuLmU0OWE1YWYzZjIgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4
Ni9kb21haW4uYworKysgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMKQEAgLTE1ODgsMTEgKzE1ODgs
MTEgQEAgdm9pZCBwYXJhdmlydF9jdHh0X3N3aXRjaF90byhzdHJ1Y3QgdmNwdSAqdikKICAgICAg
ICAgcm9vdF9wZ2VudHJ5X3QgKnJwdDsKIAogICAgICAgICBtYXBjYWNoZV9vdmVycmlkZV9jdXJy
ZW50KElOVkFMSURfVkNQVSk7Ci0gICAgICAgIHJwdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhy
cHRfbWZuKTsKKyAgICAgICAgcnB0ID0gbWFwX3hlbl9wYWdldGFibGUocnB0X21mbik7CiAgICAg
ICAgIHJwdFtyb290X3RhYmxlX29mZnNldChQRVJET01BSU5fVklSVF9TVEFSVCldID0KICAgICAg
ICAgICAgIGw0ZV9mcm9tX3BhZ2Uodi0+ZG9tYWluLT5hcmNoLnBlcmRvbWFpbl9sM19wZywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgX19QQUdFX0hZUEVSVklTT1JfUlcpOwotICAgICAgICBV
Tk1BUF9YRU5fUEFHRVRBQkxFX05FVyhycHQpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxF
KHJwdCk7CiAgICAgICAgIG1hcGNhY2hlX292ZXJyaWRlX2N1cnJlbnQoTlVMTCk7CiAgICAgfQog
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluX3BhZ2UuYyBiL3hlbi9hcmNoL3g4Ni9k
b21haW5fcGFnZS5jCmluZGV4IGNmY2ZmZDM1ZjMuLjllYTc0YjQ1NmMgMTAwNjQ0Ci0tLSBhL3hl
bi9hcmNoL3g4Ni9kb21haW5fcGFnZS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW5fcGFnZS5j
CkBAIC0zNDMsNyArMzQzLDcgQEAgbWZuX3QgZG9tYWluX3BhZ2VfbWFwX3RvX21mbihjb25zdCB2
b2lkICpwdHIpCiAgICAgICAgIGwxX3BnZW50cnlfdCAqcGwxZSA9IHZpcnRfdG9feGVuX2wxZSh2
YSk7CiAgICAgICAgIEJVR19PTighcGwxZSk7CiAgICAgICAgIGwxZSA9ICpwbDFlOwotICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDFlKTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRShwbDFlKTsKICAgICB9CiAgICAgZWxzZQogICAgIHsKZGlmZiAtLWdpdCBhL3hlbi9hcmNo
L3g4Ni9lZmkvcnVudGltZS5oIGIveGVuL2FyY2gveDg2L2VmaS9ydW50aW1lLmgKaW5kZXggMjc3
ZDIzNzk1My4uY2ExNWM1YWFiNyAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2VmaS9ydW50aW1l
LmgKKysrIGIveGVuL2FyY2gveDg2L2VmaS9ydW50aW1lLmgKQEAgLTEwLDkgKzEwLDkgQEAgdm9p
ZCBlZmlfdXBkYXRlX2w0X3BndGFibGUodW5zaWduZWQgaW50IGw0aWR4LCBsNF9wZ2VudHJ5X3Qg
bDRlKQogICAgIHsKICAgICAgICAgbDRfcGdlbnRyeV90ICpsNHQ7CiAKLSAgICAgICAgbDR0ID0g
bWFwX3hlbl9wYWdldGFibGVfbmV3KGVmaV9sNF9tZm4pOworICAgICAgICBsNHQgPSBtYXBfeGVu
X3BhZ2V0YWJsZShlZmlfbDRfbWZuKTsKICAgICAgICAgbDRlX3dyaXRlKGw0dCArIGw0aWR4LCBs
NGUpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsNHQpOworICAgICAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFKGw0dCk7CiAgICAgfQogfQogI2VuZGlmCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvbW0uYyBiL3hlbi9hcmNoL3g4Ni9tbS5jCmluZGV4IGEyZDJkMDE2NjAuLjYxNWQ1
NzM5NjEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9t
bS5jCkBAIC0zNTMsMjIgKzM1MywyMiBAQCB2b2lkIF9faW5pdCBhcmNoX2luaXRfbWVtb3J5KHZv
aWQpCiAgICAgICAgICAgICBBU1NFUlQocm9vdF9wZ3RfcHZfeGVuX3Nsb3RzIDwgUk9PVF9QQUdF
VEFCTEVfUFZfWEVOX1NMT1RTKTsKICAgICAgICAgICAgIGlmICggbDRfdGFibGVfb2Zmc2V0KHNw
bGl0X3ZhKSA9PSBsNF90YWJsZV9vZmZzZXQoc3BsaXRfdmEgLSAxKSApCiAgICAgICAgICAgICB7
Ci0gICAgICAgICAgICAgICAgbWZuX3QgbDN0YWJfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9u
ZXcoKTsKKyAgICAgICAgICAgICAgICBtZm5fdCBsM3RhYl9tZm4gPSBhbGxvY194ZW5fcGFnZXRh
YmxlKCk7CiAKICAgICAgICAgICAgICAgICBpZiAoICFtZm5fZXEobDN0YWJfbWZuLCBJTlZBTElE
X01GTikgKQogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgbDNfcGdlbnRy
eV90ICpsM2lkbGUgPQotICAgICAgICAgICAgICAgICAgICAgICAgbWFwX3hlbl9wYWdldGFibGVf
bmV3KAorICAgICAgICAgICAgICAgICAgICAgICAgbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbDRlX2dldF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9v
ZmZzZXQoc3BsaXRfdmEpXSkpOwotICAgICAgICAgICAgICAgICAgICBsM19wZ2VudHJ5X3QgKmwz
dGFiID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzdGFiX21mbik7CisgICAgICAgICAgICAgICAg
ICAgIGwzX3BnZW50cnlfdCAqbDN0YWIgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM3RhYl9tZm4pOwog
CiAgICAgICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgbDNfdGFibGVfb2Zmc2V0KHNw
bGl0X3ZhKTsgKytpICkKICAgICAgICAgICAgICAgICAgICAgICAgIGwzdGFiW2ldID0gbDNpZGxl
W2ldOwogICAgICAgICAgICAgICAgICAgICBmb3IgKCA7IGkgPCBMM19QQUdFVEFCTEVfRU5UUklF
UzsgKytpICkKICAgICAgICAgICAgICAgICAgICAgICAgIGwzdGFiW2ldID0gbDNlX2VtcHR5KCk7
CiAgICAgICAgICAgICAgICAgICAgIHNwbGl0X2w0ZSA9IGw0ZV9mcm9tX21mbihsM3RhYl9tZm4s
IF9fUEFHRV9IWVBFUlZJU09SX1JXKTsKLSAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRV9ORVcobDNpZGxlKTsKLSAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRV9ORVcobDN0YWIpOworICAgICAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxF
KGwzaWRsZSk7CisgICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0YWIp
OwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg
ICAgICAgICsrcm9vdF9wZ3RfcHZfeGVuX3Nsb3RzOwpAQCAtNDg1MCw3ICs0ODUwLDcgQEAgaW50
IG1tY2ZnX2ludGVyY2VwdF93cml0ZSgKICAgICByZXR1cm4gWDg2RU1VTF9PS0FZOwogfQogCi1t
Zm5fdCBhbGxvY194ZW5fcGFnZXRhYmxlX25ldyh2b2lkKQorbWZuX3QgYWxsb2NfeGVuX3BhZ2V0
YWJsZSh2b2lkKQogewogICAgIGlmICggc3lzdGVtX3N0YXRlICE9IFNZU19TVEFURV9lYXJseV9i
b290ICkKICAgICB7CkBAIC00ODYzLDIwICs0ODYzLDIwIEBAIG1mbl90IGFsbG9jX3hlbl9wYWdl
dGFibGVfbmV3KHZvaWQpCiAgICAgcmV0dXJuIGFsbG9jX2Jvb3RfcGFnZXMoMSwgMSk7CiB9CiAK
LXZvaWQgKm1hcF94ZW5fcGFnZXRhYmxlX25ldyhtZm5fdCBtZm4pCit2b2lkICptYXBfeGVuX3Bh
Z2V0YWJsZShtZm5fdCBtZm4pCiB7CiAgICAgcmV0dXJuIG1hcF9kb21haW5fcGFnZShtZm4pOwog
fQogCiAvKiB2IGNhbiBwb2ludCB0byBhbiBlbnRyeSB3aXRoaW4gYSB0YWJsZSBvciBiZSBOVUxM
ICovCi12b2lkIHVubWFwX3hlbl9wYWdldGFibGVfbmV3KHZvaWQgKnYpCit2b2lkIHVubWFwX3hl
bl9wYWdldGFibGUodm9pZCAqdikKIHsKICAgICBpZiAoIHYgKQogICAgICAgICB1bm1hcF9kb21h
aW5fcGFnZSgoY29uc3Qgdm9pZCAqKSgodW5zaWduZWQgbG9uZyl2ICYgUEFHRV9NQVNLKSk7CiB9
CiAKIC8qIG1mbiBjYW4gYmUgSU5WQUxJRF9NRk4gKi8KLXZvaWQgZnJlZV94ZW5fcGFnZXRhYmxl
X25ldyhtZm5fdCBtZm4pCit2b2lkIGZyZWVfeGVuX3BhZ2V0YWJsZShtZm5fdCBtZm4pCiB7CiAg
ICAgaWYgKCBzeXN0ZW1fc3RhdGUgIT0gU1lTX1NUQVRFX2Vhcmx5X2Jvb3QgJiYgIW1mbl9lcSht
Zm4sIElOVkFMSURfTUZOKSApCiAgICAgICAgIGZyZWVfZG9taGVhcF9wYWdlKG1mbl90b19wYWdl
KG1mbikpOwpAQCAtNDkwMCwxMSArNDkwMCwxMSBAQCBzdGF0aWMgbDNfcGdlbnRyeV90ICp2aXJ0
X3RvX3hlbl9sM2UodW5zaWduZWQgbG9uZyB2KQogICAgICAgICBsM19wZ2VudHJ5X3QgKmwzdDsK
ICAgICAgICAgbWZuX3QgbWZuOwogCi0gICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVf
bmV3KCk7CisgICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICAgICAgaWYg
KCBtZm5fZXEobWZuLCBJTlZBTElEX01GTikgKQogICAgICAgICAgICAgZ290byBvdXQ7CiAKLSAg
ICAgICAgbDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KG1mbik7CisgICAgICAgIGwzdCA9IG1h
cF94ZW5fcGFnZXRhYmxlKG1mbik7CiAKICAgICAgICAgaWYgKCBsb2NraW5nICkKICAgICAgICAg
ICAgIHNwaW5fbG9jaygmbWFwX3BnZGlyX2xvY2spOwpAQCAtNDkyNCwxNSArNDkyNCwxNSBAQCBz
dGF0aWMgbDNfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sM2UodW5zaWduZWQgbG9uZyB2KQogICAg
ICAgICB7CiAgICAgICAgICAgICBBU1NFUlQoIXBsM2UpOwogICAgICAgICAgICAgQVNTRVJUKCFt
Zm5fZXEobWZuLCBJTlZBTElEX01GTikpOwotICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJM
RV9ORVcobDN0KTsKLSAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobWZuKTsKKyAg
ICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDN0KTsKKyAgICAgICAgICAgIGZyZWVfeGVu
X3BhZ2V0YWJsZShtZm4pOwogICAgICAgICB9CiAgICAgfQogCiAgICAgaWYgKCAhcGwzZSApCiAg
ICAgewogICAgICAgICBBU1NFUlQobDRlX2dldF9mbGFncygqcGw0ZSkgJiBfUEFHRV9QUkVTRU5U
KTsKLSAgICAgICAgcGwzZSA9IChsM19wZ2VudHJ5X3QgKiltYXBfeGVuX3BhZ2V0YWJsZV9uZXco
bDRlX2dldF9tZm4oKnBsNGUpKQorICAgICAgICBwbDNlID0gKGwzX3BnZW50cnlfdCAqKW1hcF94
ZW5fcGFnZXRhYmxlKGw0ZV9nZXRfbWZuKCpwbDRlKSkKICAgICAgICAgICAgICsgbDNfdGFibGVf
b2Zmc2V0KHYpOwogICAgIH0KIApAQCAtNDk1OSwxMSArNDk1OSwxMSBAQCBzdGF0aWMgbDJfcGdl
bnRyeV90ICp2aXJ0X3RvX3hlbl9sMmUodW5zaWduZWQgbG9uZyB2KQogICAgICAgICBsMl9wZ2Vu
dHJ5X3QgKmwydDsKICAgICAgICAgbWZuX3QgbWZuOwogCi0gICAgICAgIG1mbiA9IGFsbG9jX3hl
bl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsK
ICAgICAgICAgaWYgKCBtZm5fZXEobWZuLCBJTlZBTElEX01GTikgKQogICAgICAgICAgICAgZ290
byBvdXQ7CiAKLSAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KG1mbik7CisgICAg
ICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKG1mbik7CiAKICAgICAgICAgaWYgKCBsb2NraW5n
ICkKICAgICAgICAgICAgIHNwaW5fbG9jaygmbWFwX3BnZGlyX2xvY2spOwpAQCAtNDk4MSw4ICs0
OTgxLDggQEAgc3RhdGljIGwyX3BnZW50cnlfdCAqdmlydF90b194ZW5fbDJlKHVuc2lnbmVkIGxv
bmcgdikKICAgICAgICAgewogICAgICAgICAgICAgQVNTRVJUKCFwbDJlKTsKICAgICAgICAgICAg
IEFTU0VSVCghbWZuX2VxKG1mbiwgSU5WQUxJRF9NRk4pKTsKLSAgICAgICAgICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEVfTkVXKGwydCk7Ci0gICAgICAgICAgICBmcmVlX3hlbl9wYWdldGFibGVfbmV3
KG1mbik7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CisgICAgICAgICAg
ICBmcmVlX3hlbl9wYWdldGFibGUobWZuKTsKICAgICAgICAgfQogICAgIH0KIApAQCAtNDk5MSwx
MiArNDk5MSwxMiBAQCBzdGF0aWMgbDJfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMmUodW5zaWdu
ZWQgbG9uZyB2KQogICAgIGlmICggIXBsMmUgKQogICAgIHsKICAgICAgICAgQVNTRVJUKGwzZV9n
ZXRfZmxhZ3MoKnBsM2UpICYgX1BBR0VfUFJFU0VOVCk7Ci0gICAgICAgIHBsMmUgPSAobDJfcGdl
bnRyeV90ICopbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKCpwbDNlKSkKKyAgICAg
ICAgcGwyZSA9IChsMl9wZ2VudHJ5X3QgKiltYXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0X21mbigq
cGwzZSkpCiAgICAgICAgICAgICArIGwyX3RhYmxlX29mZnNldCh2KTsKICAgICB9CiAKICBvdXQ6
Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwzZSk7CisgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRShwbDNlKTsKICAgICByZXR1cm4gcGwyZTsKIH0KIApAQCAtNTAxNSwxMSArNTAxNSwxMSBA
QCBsMV9wZ2VudHJ5X3QgKnZpcnRfdG9feGVuX2wxZSh1bnNpZ25lZCBsb25nIHYpCiAgICAgICAg
IGwxX3BnZW50cnlfdCAqbDF0OwogICAgICAgICBtZm5fdCBtZm47CiAKLSAgICAgICAgbWZuID0g
YWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgbWZuID0gYWxsb2NfeGVuX3BhZ2V0
YWJsZSgpOwogICAgICAgICBpZiAoIG1mbl9lcShtZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAg
ICAgICBnb3RvIG91dDsKIAotICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobWZu
KTsKKyAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGUobWZuKTsKIAogICAgICAgICBpZiAo
IGxvY2tpbmcgKQogICAgICAgICAgICAgc3Bpbl9sb2NrKCZtYXBfcGdkaXJfbG9jayk7CkBAIC01
MDM3LDggKzUwMzcsOCBAQCBsMV9wZ2VudHJ5X3QgKnZpcnRfdG9feGVuX2wxZSh1bnNpZ25lZCBs
b25nIHYpCiAgICAgICAgIHsKICAgICAgICAgICAgIEFTU0VSVCghcGwxZSk7CiAgICAgICAgICAg
ICBBU1NFUlQoIW1mbl9lcShtZm4sIElOVkFMSURfTUZOKSk7Ci0gICAgICAgICAgICBVTk1BUF9Y
RU5fUEFHRVRBQkxFX05FVyhsMXQpOwotICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25l
dyhtZm4pOworICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMXQpOworICAgICAgICAg
ICAgZnJlZV94ZW5fcGFnZXRhYmxlKG1mbik7CiAgICAgICAgIH0KICAgICB9CiAKQEAgLTUwNDcs
MTIgKzUwNDcsMTIgQEAgbDFfcGdlbnRyeV90ICp2aXJ0X3RvX3hlbl9sMWUodW5zaWduZWQgbG9u
ZyB2KQogICAgIGlmICggIXBsMWUgKQogICAgIHsKICAgICAgICAgQVNTRVJUKGwyZV9nZXRfZmxh
Z3MoKnBsMmUpICYgX1BBR0VfUFJFU0VOVCk7Ci0gICAgICAgIHBsMWUgPSAobDFfcGdlbnRyeV90
ICopbWFwX3hlbl9wYWdldGFibGVfbmV3KGwyZV9nZXRfbWZuKCpwbDJlKSkKKyAgICAgICAgcGwx
ZSA9IChsMV9wZ2VudHJ5X3QgKiltYXBfeGVuX3BhZ2V0YWJsZShsMmVfZ2V0X21mbigqcGwyZSkp
CiAgICAgICAgICAgICArIGwxX3RhYmxlX29mZnNldCh2KTsKICAgICB9CiAKICBvdXQ6Ci0gICAg
VU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwyZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShw
bDJlKTsKICAgICByZXR1cm4gcGwxZTsKIH0KIApAQCAtNTEzMSw3ICs1MTMxLDcgQEAgaW50IG1h
cF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAgICAgIGwyX3BnZW50cnlfdCAqbDJ0Owog
ICAgICAgICAgICAgICAgICAgICBtZm5fdCBsMnRfbWZuID0gbDNlX2dldF9tZm4ob2wzZSk7CiAK
LSAgICAgICAgICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4p
OworICAgICAgICAgICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMnRfbWZuKTsK
IAogICAgICAgICAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VUQUJMRV9FTlRS
SUVTOyBpKysgKQogICAgICAgICAgICAgICAgICAgICB7CkBAIC01MTQ2LDEwICs1MTQ2LDEwIEBA
IGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwxX3Bn
ZW50cnlfdCAqbDF0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mbl90IGwxdF9tZm4g
PSBsMmVfZ2V0X21mbihvbDJlKTsKIAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwxdCA9
IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZuKTsKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMXRfbWZuKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBmb3IgKCBqID0gMDsgaiA8IEwxX1BBR0VUQUJMRV9FTlRSSUVTOyBqKysgKQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbHVzaF9mbGFncyhsMWVfZ2V0X2ZsYWdz
KGwxdFtqXSkpOwotICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEVfTkVXKGwxdCk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRShsMXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICAgICAgIGZsdXNoX2FyZWEodmlydCwgZmx1c2hfZmxhZ3MpOwpA
QCAtNTE1OCw5ICs1MTU4LDkgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAg
ICAgICAgICAgICBvbDJlID0gbDJ0W2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAo
bDJlX2dldF9mbGFncyhvbDJlKSAmIF9QQUdFX1BSRVNFTlQpICYmCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICEobDJlX2dldF9mbGFncyhvbDJlKSAmIF9QQUdFX1BTRSkgKQotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDJlX2dldF9tZm4o
b2wyZSkpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShs
MmVfZ2V0X21mbihvbDJlKSk7CiAgICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAg
ICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhsMnRfbWZuKTsKKyAgICAgICAgICAgICAgICAg
ICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgIH0KIApAQCAtNTE5OSwxNCArNTE5OSwxNCBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigK
ICAgICAgICAgICAgICAgICBnb3RvIGVuZF9vZl9sb29wOwogICAgICAgICAgICAgfQogCi0gICAg
ICAgICAgICBsMnRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAg
IGwydF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAgICAgICBpZiAoIG1mbl9l
cShsMnRfbWZuLCBJTlZBTElEX01GTikgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAg
IEFTU0VSVChyYyA9PSAtRU5PTUVNKTsKICAgICAgICAgICAgICAgICBnb3RvIG91dDsKICAgICAg
ICAgICAgIH0KIAotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9t
Zm4pOworICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGUobDJ0X21mbik7CiAKICAg
ICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAg
ICAgICAgICAgICAgICAgbDJlX3dyaXRlKGwydCArIGksCkBAIC01MjI0LDE1ICs1MjI0LDE1IEBA
IGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIGwz
ZV93cml0ZV9hdG9taWMocGwzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwz
ZV9mcm9tX21mbihsMnRfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUikpOwotICAgICAgICAgICAgICAg
IFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7CisgICAgICAgICAgICAgICAgVU5NQVBfWEVO
X1BBR0VUQUJMRShsMnQpOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgaWYgKCBsb2NraW5n
ICkKICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmbWFwX3BnZGlyX2xvY2spOwogICAgICAg
ICAgICAgZmx1c2hfYXJlYSh2aXJ0LCBmbHVzaF9mbGFncyk7CiAgICAgICAgICAgICBpZiAoIGwy
dCApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9O
RVcobDJ0KTsKLSAgICAgICAgICAgICAgICBmcmVlX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4p
OworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJ0KTsKKyAgICAgICAgICAg
ICAgICBmcmVlX3hlbl9wYWdldGFibGUobDJ0X21mbik7CiAgICAgICAgICAgICB9CiAgICAgICAg
IH0KIApAQCAtNTI2NywxMiArNTI2NywxMiBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICAg
ICAgICAgICAgICAgICAgbDFfcGdlbnRyeV90ICpsMXQ7CiAgICAgICAgICAgICAgICAgICAgIG1m
bl90IGwxdF9tZm4gPSBsMmVfZ2V0X21mbihvbDJlKTsKIAotICAgICAgICAgICAgICAgICAgICBs
MXQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDF0X21mbik7CisgICAgICAgICAgICAgICAgICAg
IGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgICAgICAgICBm
b3IgKCBpID0gMDsgaSA8IEwxX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAg
ICAgICAgICAgICAgZmx1c2hfZmxhZ3MobDFlX2dldF9mbGFncyhsMXRbaV0pKTsKICAgICAgICAg
ICAgICAgICAgICAgZmx1c2hfYXJlYSh2aXJ0LCBmbHVzaF9mbGFncyk7Ci0gICAgICAgICAgICAg
ICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0gICAgICAgICAgICAgICAgICAg
IGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDF0X21mbik7CisgICAgICAgICAgICAgICAgICAgIFVO
TUFQX1hFTl9QQUdFVEFCTEUobDF0KTsKKyAgICAgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFn
ZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgIH0KIApAQCAt
NTI5Myw3ICs1MjkzLDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAg
ICAgIEFTU0VSVChyYyA9PSAtRU5PTUVNKTsKICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7
CiAgICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVf
TkVXKHBsMWUpOworICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwxZSk7CiAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICggbDJlX2dldF9mbGFncygqcGwyZSkg
JiBfUEFHRV9QU0UgKQogICAgICAgICAgICAgewpAQCAtNTMyMCwxNCArNTMyMCwxNCBAQCBpbnQg
bWFwX3BhZ2VzX3RvX3hlbigKICAgICAgICAgICAgICAgICAgICAgZ290byBjaGVja19sMzsKICAg
ICAgICAgICAgICAgICB9CiAKLSAgICAgICAgICAgICAgICBsMXRfbWZuID0gYWxsb2NfeGVuX3Bh
Z2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgICAgICBsMXRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0
YWJsZSgpOwogICAgICAgICAgICAgICAgIGlmICggbWZuX2VxKGwxdF9tZm4sIElOVkFMSURfTUZO
KSApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICBBU1NFUlQocmMgPT0g
LUVOT01FTSk7CiAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICAgICAgICAg
IH0KIAotICAgICAgICAgICAgICAgIGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZu
KTsKKyAgICAgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMXRfbWZuKTsKIAog
ICAgICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VOVFJJRVM7IGkr
KyApCiAgICAgICAgICAgICAgICAgICAgIGwxZV93cml0ZSgmbDF0W2ldLApAQCAtNTM0NCwyMyAr
NTM0NCwyMyBAQCBpbnQgbWFwX3BhZ2VzX3RvX3hlbigKICAgICAgICAgICAgICAgICB7CiAgICAg
ICAgICAgICAgICAgICAgIGwyZV93cml0ZV9hdG9taWMocGwyZSwgbDJlX2Zyb21fbWZuKGwxdF9t
Zm4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIF9fUEFHRV9IWVBFUlZJU09SKSk7Ci0gICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEVfTkVXKGwxdCk7CisgICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEUobDF0KTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgaWYgKCBsb2NraW5n
ICkKICAgICAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2soJm1hcF9wZ2Rpcl9sb2NrKTsKICAg
ICAgICAgICAgICAgICBmbHVzaF9hcmVhKHZpcnQsIGZsdXNoX2ZsYWdzKTsKICAgICAgICAgICAg
ICAgICBpZiAoIGwxdCApCiAgICAgICAgICAgICAgICAgewotICAgICAgICAgICAgICAgICAgICBV
Tk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOwotICAgICAgICAgICAgICAgICAgICBmcmVlX3hl
bl9wYWdldGFibGVfbmV3KGwxdF9tZm4pOworICAgICAgICAgICAgICAgICAgICBVTk1BUF9YRU5f
UEFHRVRBQkxFKGwxdCk7CisgICAgICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShs
MXRfbWZuKTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9CiAKLSAgICAgICAgICAg
IHBsMWUgID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwyZV9nZXRfbWZuKCgqcGwyZSkpKTsKKyAg
ICAgICAgICAgIHBsMWUgID0gbWFwX3hlbl9wYWdldGFibGUobDJlX2dldF9tZm4oKCpwbDJlKSkp
OwogICAgICAgICAgICAgcGwxZSArPSBsMV90YWJsZV9vZmZzZXQodmlydCk7CiAgICAgICAgICAg
ICBvbDFlICA9ICpwbDFlOwogICAgICAgICAgICAgbDFlX3dyaXRlX2F0b21pYyhwbDFlLCBsMWVf
ZnJvbV9tZm4obWZuLCBmbGFncykpOwotICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9O
RVcocGwxZSk7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMWUpOwogICAgICAg
ICAgICAgaWYgKCAobDFlX2dldF9mbGFncyhvbDFlKSAmIF9QQUdFX1BSRVNFTlQpICkKICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZmx1c2hfZmxhZ3MgPSBGTFVT
SF9UTEIgfCBGTFVTSF9PUkRFUigwKTsKQEAgLTU0MDYsMTQgKzU0MDYsMTQgQEAgaW50IG1hcF9w
YWdlc190b194ZW4oCiAgICAgICAgICAgICAgICAgfQogCiAgICAgICAgICAgICAgICAgbDF0X21m
biA9IGwyZV9nZXRfbWZuKG9sMmUpOwotICAgICAgICAgICAgICAgIGwxdCA9IG1hcF94ZW5fcGFn
ZXRhYmxlX25ldyhsMXRfbWZuKTsKKyAgICAgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0
YWJsZShsMXRfbWZuKTsKIAogICAgICAgICAgICAgICAgIGJhc2VfbWZuID0gbDFlX2dldF9wZm4o
bDF0WzBdKSAmIH4oTDFfUEFHRVRBQkxFX0VOVFJJRVMgLSAxKTsKICAgICAgICAgICAgICAgICBm
b3IgKCBpID0gMDsgaSA8IEwxX1BBR0VUQUJMRV9FTlRSSUVTOyBpKysgKQogICAgICAgICAgICAg
ICAgICAgICBpZiAoIChsMWVfZ2V0X3BmbihsMXRbaV0pICE9IChiYXNlX21mbiArIGkpKSB8fAog
ICAgICAgICAgICAgICAgICAgICAgICAgIChsMWVfZ2V0X2ZsYWdzKGwxdFtpXSkgIT0gZmxhZ3Mp
ICkKICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICAgICAgICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7CisgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRShsMXQpOwogICAgICAgICAgICAgICAgIGlmICggaSA9PSBMMV9QQUdFVEFCTEVfRU5UUklF
UyApCiAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICBsMmVfd3JpdGVfYXRv
bWljKHBsMmUsIGwyZV9mcm9tX3BmbihiYXNlX21mbiwKQEAgLTU0MjMsNyArNTQyMyw3IEBAIGlu
dCBtYXBfcGFnZXNfdG9feGVuKAogICAgICAgICAgICAgICAgICAgICBmbHVzaF9hcmVhKHZpcnQg
LSBQQUdFX1NJWkUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRkxVU0hfVExCX0dM
T0JBTCB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRkxVU0hfT1JERVIoUEFHRVRB
QkxFX09SREVSKSk7Ci0gICAgICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXco
bDF0X21mbik7CisgICAgICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShsMXRfbWZu
KTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIGxvY2tpbmcg
KQogICAgICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmbWFwX3BnZGlyX2xvY2spOwpAQCAt
NTQ1OCw3ICs1NDU4LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAgICB9CiAK
ICAgICAgICAgICAgIGwydF9tZm4gPSBsM2VfZ2V0X21mbihvbDNlKTsKLSAgICAgICAgICAgIGwy
dCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMnRfbWZuKTsKKyAgICAgICAgICAgIGwydCA9IG1h
cF94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogCiAgICAgICAgICAgICBiYXNlX21mbiA9IGwyZV9n
ZXRfcGZuKGwydFswXSkgJiB+KEwyX1BBR0VUQUJMRV9FTlRSSUVTICoKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMMV9QQUdFVEFCTEVfRU5UUklFUyAtIDEp
OwpAQCAtNTQ2Nyw3ICs1NDY3LDcgQEAgaW50IG1hcF9wYWdlc190b194ZW4oCiAgICAgICAgICAg
ICAgICAgICAgICAgKGJhc2VfbWZuICsgKGkgPDwgUEFHRVRBQkxFX09SREVSKSkpIHx8CiAgICAg
ICAgICAgICAgICAgICAgICAobDJlX2dldF9mbGFncyhsMnRbaV0pICE9IGwxZl90b19sTmYoZmxh
Z3MpKSApCiAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICAgICAgVU5NQVBfWEVO
X1BBR0VUQUJMRV9ORVcobDJ0KTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJ0
KTsKICAgICAgICAgICAgIGlmICggaSA9PSBMMl9QQUdFVEFCTEVfRU5UUklFUyApCiAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgbDNlX3dyaXRlX2F0b21pYyhwbDNlLCBsM2VfZnJvbV9w
Zm4oYmFzZV9tZm4sCkBAIC01NDc3LDE1ICs1NDc3LDE1IEBAIGludCBtYXBfcGFnZXNfdG9feGVu
KAogICAgICAgICAgICAgICAgIGZsdXNoX2FyZWEodmlydCAtIFBBR0VfU0laRSwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIEZMVVNIX1RMQl9HTE9CQUwgfAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgRkxVU0hfT1JERVIoMipQQUdFVEFCTEVfT1JERVIpKTsKLSAgICAgICAgICAgICAg
ICBmcmVlX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAgICAgICAgICAgICAgIGZyZWVf
eGVuX3BhZ2V0YWJsZShsMnRfbWZuKTsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGVsc2Ug
aWYgKCBsb2NraW5nICkKICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygmbWFwX3BnZGlyX2xv
Y2spOwogICAgICAgICB9CiAgICAgZW5kX29mX2xvb3A6Ci0gICAgICAgIFVOTUFQX1hFTl9QQUdF
VEFCTEVfTkVXKHBsMWUpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDJlKTsK
LSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwzZSk7CisgICAgICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEUocGwxZSk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwyZSk7Cisg
ICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwzZSk7CiAgICAgfQogCiAjdW5kZWYgZmx1c2hf
ZmxhZ3MKQEAgLTU0OTMsOSArNTQ5Myw5IEBAIGludCBtYXBfcGFnZXNfdG9feGVuKAogICAgIHJj
ID0gMDsKIAogIG91dDoKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDFlKTsKLSAgICBV
Tk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDJlKTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05F
VyhwbDNlKTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMWUpOworICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUocGwyZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDNlKTsKICAgICByZXR1
cm4gcmM7CiB9CiAKQEAgLTU1NjYsMTQgKzU1NjYsMTQgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGlu
Z3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAg
ICAgICAgICAgIH0KIAogICAgICAgICAgICAgLyogUEFHRTFHQjogc2hhdHRlciB0aGUgc3VwZXJw
YWdlIGFuZCBmYWxsIHRocm91Z2guICovCi0gICAgICAgICAgICBtZm4gPSBhbGxvY194ZW5fcGFn
ZXRhYmxlX25ldygpOworICAgICAgICAgICAgbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwog
ICAgICAgICAgICAgaWYgKCBtZm5fZXEobWZuLCBJTlZBTElEX01GTikgKQogICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgIEFTU0VSVChyYyA9PSAtRU5PTUVNKTsKICAgICAgICAgICAgICAg
ICBnb3RvIG91dDsKICAgICAgICAgICAgIH0KIAotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9w
YWdldGFibGVfbmV3KG1mbik7CisgICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZSht
Zm4pOwogCiAgICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IEwyX1BBR0VUQUJMRV9FTlRSSUVT
OyBpKysgKQogICAgICAgICAgICAgICAgIGwyZV93cml0ZShsMnQgKyBpLApAQCAtNTU4NiwxNCAr
NTU4NiwxNCBAQCBpbnQgbW9kaWZ5X3hlbl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2ln
bmVkIGxvbmcgZSwgdW5zaWduZWQgaW50IG5mKQogICAgICAgICAgICAgICAgICAobDNlX2dldF9m
bGFncygqcGwzZSkgJiBfUEFHRV9QU0UpICkKICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAg
ICBsM2Vfd3JpdGVfYXRvbWljKHBsM2UsIGwzZV9mcm9tX21mbihtZm4sIF9fUEFHRV9IWVBFUlZJ
U09SKSk7Ci0gICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJ0KTsKKyAg
ICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICBpZiAoIGxvY2tpbmcgKQogICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZt
YXBfcGdkaXJfbG9jayk7CiAgICAgICAgICAgICBpZiAoIGwydCApCiAgICAgICAgICAgICB7Ci0g
ICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJ0KTsKLSAgICAgICAgICAg
ICAgICBmcmVlX3hlbl9wYWdldGFibGVfbmV3KG1mbik7CisgICAgICAgICAgICAgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShsMnQpOworICAgICAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZSht
Zm4pOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAKQEAgLTU2MDEsNyArNTYwMSw3IEBAIGlu
dCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVkIGxvbmcgcywgdW5zaWduZWQgbG9uZyBlLCB1
bnNpZ25lZCBpbnQgbmYpCiAgICAgICAgICAqIFRoZSBMMyBlbnRyeSBoYXMgYmVlbiB2ZXJpZmll
ZCB0byBiZSBwcmVzZW50LCBhbmQgd2UndmUgZGVhbHQgd2l0aAogICAgICAgICAgKiAxRyBwYWdl
cyBhcyB3ZWxsLCBzbyB0aGUgTDIgdGFibGUgY2Fubm90IHJlcXVpcmUgYWxsb2NhdGlvbi4KICAg
ICAgICAgICovCi0gICAgICAgIHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDNlX2dldF9t
Zm4oKnBsM2UpKTsKKyAgICAgICAgcGwyZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZu
KCpwbDNlKSk7CiAgICAgICAgIHBsMmUgKz0gbDJfdGFibGVfb2Zmc2V0KHYpOwogCiAgICAgICAg
IGlmICggIShsMmVfZ2V0X2ZsYWdzKCpwbDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKQEAgLTU2MzMs
MTQgKzU2MzMsMTQgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1
bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAgICAgICBtZm5fdCBt
Zm47CiAKICAgICAgICAgICAgICAgICAvKiBQU0U6IHNoYXR0ZXIgdGhlIHN1cGVycGFnZSBhbmQg
dHJ5IGFnYWluLiAqLwotICAgICAgICAgICAgICAgIG1mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVf
bmV3KCk7CisgICAgICAgICAgICAgICAgbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAg
ICAgICAgICAgICAgIGlmICggbWZuX2VxKG1mbiwgSU5WQUxJRF9NRk4pICkKICAgICAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgICAgIEFTU0VSVChyYyA9PSAtRU5PTUVNKTsKICAgICAg
ICAgICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgICAgICAgICAgfQogCi0gICAgICAgICAg
ICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KG1mbik7CisgICAgICAgICAgICAgICAg
bDF0ID0gbWFwX3hlbl9wYWdldGFibGUobWZuKTsKIAogICAgICAgICAgICAgICAgIGZvciAoIGkg
PSAwOyBpIDwgTDFfUEFHRVRBQkxFX0VOVFJJRVM7IGkrKyApCiAgICAgICAgICAgICAgICAgICAg
IGwxZV93cml0ZSgmbDF0W2ldLApAQCAtNTY1MywxNCArNTY1MywxNCBAQCBpbnQgbW9kaWZ5X3hl
bl9tYXBwaW5ncyh1bnNpZ25lZCBsb25nIHMsIHVuc2lnbmVkIGxvbmcgZSwgdW5zaWduZWQgaW50
IG5mKQogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgbDJlX3dyaXRlX2F0
b21pYyhwbDJlLCBsMmVfZnJvbV9tZm4obWZuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1BBR0VfSFlQRVJWSVNPUikpOwotICAgICAg
ICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOworICAgICAgICAgICAg
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CiAgICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICAgICAgIGlmICggbG9ja2luZyApCiAgICAgICAgICAgICAgICAgICAgIHNwaW5fdW5s
b2NrKCZtYXBfcGdkaXJfbG9jayk7CiAgICAgICAgICAgICAgICAgaWYgKCBsMXQgKQogICAgICAg
ICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVco
bDF0KTsKLSAgICAgICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhtZm4pOwor
ICAgICAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwxdCk7CisgICAgICAgICAg
ICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShtZm4pOwogICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgIH0KICAgICAgICAgfQpAQCAtNTY3NCw3ICs1Njc0LDcgQEAgaW50IG1vZGlmeV94
ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGlu
dCBuZikKICAgICAgICAgICAgICAqIHByZXNlbnQsIGFuZCB3ZSd2ZSBkZWFsdCB3aXRoIDJNIHBh
Z2VzIGFzIHdlbGwsIHNvIHRoZSBMMSB0YWJsZQogICAgICAgICAgICAgICogY2Fubm90IHJlcXVp
cmUgYWxsb2NhdGlvbi4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgcGwxZSA9IG1hcF94
ZW5fcGFnZXRhYmxlX25ldyhsMmVfZ2V0X21mbigqcGwyZSkpOworICAgICAgICAgICAgcGwxZSA9
IG1hcF94ZW5fcGFnZXRhYmxlKGwyZV9nZXRfbWZuKCpwbDJlKSk7CiAgICAgICAgICAgICBwbDFl
ICs9IGwxX3RhYmxlX29mZnNldCh2KTsKIAogICAgICAgICAgICAgLyogQ29uZmlybSB0aGUgY2Fs
bGVyIGlzbid0IHRyeWluZyB0byBjcmVhdGUgbmV3IG1hcHBpbmdzLiAqLwpAQCAtNTY4Niw3ICs1
Njg2LDcgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25l
ZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAobDFlX2dldF9mbGFncygqcGwxZSkgJiB+RkxBR1NfTUFTSykgfCBuZik7CiAKICAgICAgICAg
ICAgIGwxZV93cml0ZV9hdG9taWMocGwxZSwgbmwxZSk7Ci0gICAgICAgICAgICBVTk1BUF9YRU5f
UEFHRVRBQkxFX05FVyhwbDFlKTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwx
ZSk7CiAgICAgICAgICAgICB2ICs9IFBBR0VfU0laRTsKIAogICAgICAgICAgICAgLyoKQEAgLTU3
MTcsMTEgKzU3MTcsMTEgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBz
LCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAgICAgIH0KIAogICAg
ICAgICAgICAgbDF0X21mbiA9IGwyZV9nZXRfbWZuKCpwbDJlKTsKLSAgICAgICAgICAgIGwxdCA9
IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZuKTsKKyAgICAgICAgICAgIGwxdCA9IG1hcF94
ZW5fcGFnZXRhYmxlKGwxdF9tZm4pOwogICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBMMV9Q
QUdFVEFCTEVfRU5UUklFUzsgaSsrICkKICAgICAgICAgICAgICAgICBpZiAoIGwxZV9nZXRfaW50
cHRlKGwxdFtpXSkgIT0gMCApCiAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICAg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDF0KTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUobDF0KTsKICAgICAgICAgICAgIGlmICggaSA9PSBMMV9QQUdFVEFCTEVfRU5UUklF
UyApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgLyogRW1wdHk6IHphcCB0aGUgTDJF
IGFuZCBmcmVlIHRoZSBMMSBwYWdlLiAqLwpAQCAtNTcyOSw3ICs1NzI5LDcgQEAgaW50IG1vZGlm
eV94ZW5fbWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVk
IGludCBuZikKICAgICAgICAgICAgICAgICBpZiAoIGxvY2tpbmcgKQogICAgICAgICAgICAgICAg
ICAgICBzcGluX3VubG9jaygmbWFwX3BnZGlyX2xvY2spOwogICAgICAgICAgICAgICAgIGZsdXNo
X2FyZWEoTlVMTCwgRkxVU0hfVExCX0dMT0JBTCk7IC8qIGZsdXNoIGJlZm9yZSBmcmVlICovCi0g
ICAgICAgICAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlX25ldyhsMXRfbWZuKTsKKyAgICAgICAg
ICAgICAgICBmcmVlX3hlbl9wYWdldGFibGUobDF0X21mbik7CiAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICBlbHNlIGlmICggbG9ja2luZyApCiAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2so
Jm1hcF9wZ2Rpcl9sb2NrKTsKQEAgLTU3NjMsMTEgKzU3NjMsMTEgQEAgaW50IG1vZGlmeV94ZW5f
bWFwcGluZ3ModW5zaWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBu
ZikKICAgICAgICAgICAgIG1mbl90IGwydF9tZm47CiAKICAgICAgICAgICAgIGwydF9tZm4gPSBs
M2VfZ2V0X21mbigqcGwzZSk7Ci0gICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9u
ZXcobDJ0X21mbik7CisgICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMnRfbWZu
KTsKICAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgTDJfUEFHRVRBQkxFX0VOVFJJRVM7IGkr
KyApCiAgICAgICAgICAgICAgICAgaWYgKCBsMmVfZ2V0X2ludHB0ZShsMnRbaV0pICE9IDAgKQog
ICAgICAgICAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEVfTkVXKGwydCk7CisgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAgICAg
ICAgICAgICBpZiAoIGkgPT0gTDJfUEFHRVRBQkxFX0VOVFJJRVMgKQogICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgIC8qIEVtcHR5OiB6YXAgdGhlIEwzRSBhbmQgZnJlZSB0aGUgTDIgcGFn
ZS4gKi8KQEAgLTU3NzUsMTQgKzU3NzUsMTQgQEAgaW50IG1vZGlmeV94ZW5fbWFwcGluZ3ModW5z
aWduZWQgbG9uZyBzLCB1bnNpZ25lZCBsb25nIGUsIHVuc2lnbmVkIGludCBuZikKICAgICAgICAg
ICAgICAgICBpZiAoIGxvY2tpbmcgKQogICAgICAgICAgICAgICAgICAgICBzcGluX3VubG9jaygm
bWFwX3BnZGlyX2xvY2spOwogICAgICAgICAgICAgICAgIGZsdXNoX2FyZWEoTlVMTCwgRkxVU0hf
VExCX0dMT0JBTCk7IC8qIGZsdXNoIGJlZm9yZSBmcmVlICovCi0gICAgICAgICAgICAgICAgZnJl
ZV94ZW5fcGFnZXRhYmxlX25ldyhsMnRfbWZuKTsKKyAgICAgICAgICAgICAgICBmcmVlX3hlbl9w
YWdldGFibGUobDJ0X21mbik7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBlbHNlIGlmICgg
bG9ja2luZyApCiAgICAgICAgICAgICAgICAgc3Bpbl91bmxvY2soJm1hcF9wZ2Rpcl9sb2NrKTsK
ICAgICAgICAgfQogICAgIGVuZF9vZl9sb29wOgotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxF
X05FVyhwbDJlKTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwzZSk7CisgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwyZSk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEUocGwzZSk7CiAgICAgfQogCiAgICAgZmx1c2hfYXJlYShOVUxMLCBGTFVTSF9UTEJfR0xPQkFM
KTsKQEAgLTU3OTEsOCArNTc5MSw4IEBAIGludCBtb2RpZnlfeGVuX21hcHBpbmdzKHVuc2lnbmVk
IGxvbmcgcywgdW5zaWduZWQgbG9uZyBlLCB1bnNpZ25lZCBpbnQgbmYpCiAgICAgcmMgPSAwOwog
CiAgb3V0OgotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKHBsMmUpOwotICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEVfTkVXKHBsM2UpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwyZSk7Cisg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDNlKTsKICAgICByZXR1cm4gcmM7CiB9CiAKZGlmZiAt
LWdpdCBhL3hlbi9hcmNoL3g4Ni9wdi9kb20wX2J1aWxkLmMgYi94ZW4vYXJjaC94ODYvcHYvZG9t
MF9idWlsZC5jCmluZGV4IDM5Y2I2OGY3ZGEuLjAyZDdmMWMyN2MgMTAwNjQ0Ci0tLSBhL3hlbi9h
cmNoL3g4Ni9wdi9kb20wX2J1aWxkLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2RvbTBfYnVpbGQu
YwpAQCAtNTUsMTEgKzU1LDExIEBAIHN0YXRpYyBfX2luaXQgdm9pZCBtYXJrX3B2X3B0X3BhZ2Vz
X3Jkb25seShzdHJ1Y3QgZG9tYWluICpkLAogICAgIGwxX3BnZW50cnlfdCAqcGwxZSwgKmwxdDsK
IAogICAgIHBsNGUgPSBsNHN0YXJ0ICsgbDRfdGFibGVfb2Zmc2V0KHZwdF9zdGFydCk7Ci0gICAg
bDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGw0ZV9nZXRfbWZuKCpwbDRlKSk7CisgICAgbDN0
ID0gbWFwX3hlbl9wYWdldGFibGUobDRlX2dldF9tZm4oKnBsNGUpKTsKICAgICBwbDNlID0gbDN0
ICsgbDNfdGFibGVfb2Zmc2V0KHZwdF9zdGFydCk7Ci0gICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzZV9nZXRfbWZuKCpwbDNlKSk7CisgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGUo
bDNlX2dldF9tZm4oKnBsM2UpKTsKICAgICBwbDJlID0gbDJ0ICsgbDJfdGFibGVfb2Zmc2V0KHZw
dF9zdGFydCk7Ci0gICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwyZV9nZXRfbWZuKCpw
bDJlKSk7CisgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGUobDJlX2dldF9tZm4oKnBsMmUpKTsK
ICAgICBwbDFlID0gbDF0ICsgbDFfdGFibGVfb2Zmc2V0KHZwdF9zdGFydCk7CiAgICAgZm9yICgg
Y291bnQgPSAwOyBjb3VudCA8IG5yX3B0X3BhZ2VzOyBjb3VudCsrICkKICAgICB7CkBAIC04Niwy
MiArODYsMjIgQEAgc3RhdGljIF9faW5pdCB2b2lkIG1hcmtfcHZfcHRfcGFnZXNfcmRvbmx5KHN0
cnVjdCBkb21haW4gKmQsCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaWYgKCAhKCh1
bnNpZ25lZCBsb25nKSsrcGwzZSAmIChQQUdFX1NJWkUgLSAxKSkgKQogICAgICAgICAgICAgICAg
IHsKLSAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0KTsKLSAg
ICAgICAgICAgICAgICAgICAgbDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGw0ZV9nZXRfbWZu
KCorK3BsNGUpKTsKKyAgICAgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM3Qp
OworICAgICAgICAgICAgICAgICAgICBsM3QgPSBtYXBfeGVuX3BhZ2V0YWJsZShsNGVfZ2V0X21m
bigqKytwbDRlKSk7CiAgICAgICAgICAgICAgICAgICAgIHBsM2UgPSBsM3Q7CiAgICAgICAgICAg
ICAgICAgfQotICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Ci0g
ICAgICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKCpw
bDNlKSk7CisgICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOworICAgICAg
ICAgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZuKCpwbDNlKSk7CiAg
ICAgICAgICAgICAgICAgcGwyZSA9IGwydDsKICAgICAgICAgICAgIH0KLSAgICAgICAgICAgIFVO
TUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0gICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3Bh
Z2V0YWJsZV9uZXcobDJlX2dldF9tZm4oKnBsMmUpKTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUobDF0KTsKKyAgICAgICAgICAgIGwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwyZV9n
ZXRfbWZuKCpwbDJlKSk7CiAgICAgICAgICAgICBwbDFlID0gbDF0OwogICAgICAgICB9CiAgICAg
fQotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0gICAgVU5NQVBfWEVOX1BBR0VU
QUJMRV9ORVcobDJ0KTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM3QpOworICAgIFVO
TUFQX1hFTl9QQUdFVEFCTEUobDF0KTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7Cisg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM3QpOwogfQogCiBzdGF0aWMgX19pbml0IHZvaWQgc2V0
dXBfcHZfcGh5c21hcChzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBsb25nIHBndGJsX3BmbiwK
QEAgLTY5NSw5ICs2OTUsOSBAQCBpbnQgX19pbml0IGRvbTBfY29uc3RydWN0X3B2KHN0cnVjdCBk
b21haW4gKmQsCiAgICAgICAgICAgICAgICAgbDNlX2dldF9wYWdlKCpsM3RhYiktPnUuaW51c2Uu
dHlwZV9pbmZvIHw9IFBHVF9wYWVfeGVuX2wyOwogICAgICAgICB9CiAKLSAgICAgICAgbDJ0ID0g
bWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKGwzc3RhcnRbM10pKTsKKyAgICAgICAg
bDJ0ID0gbWFwX3hlbl9wYWdldGFibGUobDNlX2dldF9tZm4obDNzdGFydFszXSkpOwogICAgICAg
ICBpbml0X3hlbl9wYWVfbDJfc2xvdHMobDJ0LCBkKTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRV9ORVcobDJ0KTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOwogICAgIH0K
IAogICAgIC8qIFBhZ2VzIHRoYXQgYXJlIHBhcnQgb2YgcGFnZSB0YWJsZXMgbXVzdCBiZSByZWFk
IG9ubHkuICovCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvcHYvc2hpbS5jIGIveGVuL2FyY2gv
eDg2L3B2L3NoaW0uYwppbmRleCBjZjYzOGZhOTY1Li4wOWM3NzY2ZWM1IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvcHYvc2hpbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9zaGltLmMKQEAgLTE3
MSwxMSArMTcxLDExIEBAIHN0YXRpYyB2b2lkIF9faW5pdCByZXBsYWNlX3ZhX21hcHBpbmcoc3Ry
dWN0IGRvbWFpbiAqZCwgbDRfcGdlbnRyeV90ICpsNHN0YXJ0LAogICAgIGwyX3BnZW50cnlfdCAq
cGwyZTsKICAgICBsMV9wZ2VudHJ5X3QgKnBsMWU7CiAKLSAgICBwbDNlID0gbWFwX3hlbl9wYWdl
dGFibGVfbmV3KGw0ZV9nZXRfbWZuKCpwbDRlKSk7CisgICAgcGwzZSA9IG1hcF94ZW5fcGFnZXRh
YmxlKGw0ZV9nZXRfbWZuKCpwbDRlKSk7CiAgICAgcGwzZSArPSBsM190YWJsZV9vZmZzZXQodmEp
OwotICAgIHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDNlX2dldF9tZm4oKnBsM2UpKTsK
KyAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGUobDNlX2dldF9tZm4oKnBsM2UpKTsKICAgICBw
bDJlICs9IGwyX3RhYmxlX29mZnNldCh2YSk7Ci0gICAgcGwxZSA9IG1hcF94ZW5fcGFnZXRhYmxl
X25ldyhsMmVfZ2V0X21mbigqcGwyZSkpOworICAgIHBsMWUgPSBtYXBfeGVuX3BhZ2V0YWJsZShs
MmVfZ2V0X21mbigqcGwyZSkpOwogICAgIHBsMWUgKz0gbDFfdGFibGVfb2Zmc2V0KHZhKTsKIAog
ICAgIHB1dF9wYWdlX2FuZF90eXBlKG1mbl90b19wYWdlKGwxZV9nZXRfbWZuKCpwbDFlKSkpOwpA
QCAtMTgzLDkgKzE4Myw5IEBAIHN0YXRpYyB2b2lkIF9faW5pdCByZXBsYWNlX3ZhX21hcHBpbmco
c3RydWN0IGRvbWFpbiAqZCwgbDRfcGdlbnRyeV90ICpsNHN0YXJ0LAogICAgICpwbDFlID0gbDFl
X2Zyb21fbWZuKG1mbiwgKCFpc19wdl8zMmJpdF9kb21haW4oZCkgPyBMMV9QUk9UCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IENPTVBBVF9M
MV9QUk9UKSk7CiAKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDFlKTsKLSAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFX05FVyhwbDJlKTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhw
bDNlKTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsMWUpOworICAgIFVOTUFQX1hFTl9QQUdF
VEFCTEUocGwyZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDNlKTsKIH0KIAogc3RhdGlj
IHZvaWQgZXZ0Y2huX3Jlc2VydmUoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IHBvcnQp
CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvc2V0dXAuYyBiL3hlbi9hcmNoL3g4Ni9zZXR1cC5j
CmluZGV4IGQyN2JjZjE3MjQuLmU2ZDhkZmIwYjMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9z
ZXR1cC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9zZXR1cC5jCkBAIC0xMTAxLDcgKzExMDEsNyBAQCB2
b2lkIF9faW5pdCBub3JldHVybiBfX3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9wKQogICAg
ICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAqcGw0ZSA9IGw0ZV9m
cm9tX2ludHB0ZShsNGVfZ2V0X2ludHB0ZSgqcGw0ZSkgKwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHhlbl9waHlzX3N0YXJ0KTsKLSAgICAgICAgICAgICAgICBwbDNl
ID0gbDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGw0ZV9nZXRfbWZuKCpwbDRlKSk7CisgICAg
ICAgICAgICAgICAgcGwzZSA9IGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGw0ZV9nZXRfbWZuKCpw
bDRlKSk7CiAgICAgICAgICAgICAgICAgZm9yICggaiA9IDA7IGogPCBMM19QQUdFVEFCTEVfRU5U
UklFUzsgaisrLCBwbDNlKysgKQogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAg
ICAgbDJfcGdlbnRyeV90ICpsMnQ7CkBAIC0xMTEzLDcgKzExMTMsNyBAQCB2b2lkIF9faW5pdCBu
b3JldHVybiBfX3N0YXJ0X3hlbih1bnNpZ25lZCBsb25nIG1iaV9wKQogICAgICAgICAgICAgICAg
ICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICpwbDNlID0gbDNlX2Zyb21f
aW50cHRlKGwzZV9nZXRfaW50cHRlKCpwbDNlKSArCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHhlbl9waHlzX3N0YXJ0KTsKLSAgICAgICAgICAgICAgICAgICAg
cGwyZSA9IGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM2VfZ2V0X21mbigqcGwzZSkpOwor
ICAgICAgICAgICAgICAgICAgICBwbDJlID0gbDJ0ID0gbWFwX3hlbl9wYWdldGFibGUobDNlX2dl
dF9tZm4oKnBsM2UpKTsKICAgICAgICAgICAgICAgICAgICAgZm9yICggayA9IDA7IGsgPCBMMl9Q
QUdFVEFCTEVfRU5UUklFUzsgaysrLCBwbDJlKysgKQogICAgICAgICAgICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgICAgICAgICAgICAvKiBOb3QgcHJlc2VudCwgUFNFLCBvciBhbHJlYWR5IHJl
bG9jYXRlZD8gKi8KQEAgLTExMjQsOSArMTEyNCw5IEBAIHZvaWQgX19pbml0IG5vcmV0dXJuIF9f
c3RhcnRfeGVuKHVuc2lnbmVkIGxvbmcgbWJpX3ApCiAgICAgICAgICAgICAgICAgICAgICAgICAq
cGwyZSA9IGwyZV9mcm9tX2ludHB0ZShsMmVfZ2V0X2ludHB0ZSgqcGwyZSkgKwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGVuX3BoeXNfc3RhcnQpOwog
ICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdF
VEFCTEVfTkVXKGwydCk7CisgICAgICAgICAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUo
bDJ0KTsKICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VU
QUJMRV9ORVcobDN0KTsKKyAgICAgICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzdCk7
CiAgICAgICAgICAgICB9CiAKICAgICAgICAgICAgIC8qIFRoZSBvbmx5IGRhdGEgbWFwcGluZ3Mg
dG8gYmUgcmVsb2NhdGVkIGFyZSBpbiB0aGUgWGVuIGFyZWEuICovCmRpZmYgLS1naXQgYS94ZW4v
YXJjaC94ODYvc21wYm9vdC5jIGIveGVuL2FyY2gveDg2L3NtcGJvb3QuYwppbmRleCA5ZmUwZWYx
OGExLi5jYmFmZjIzZjdlIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvc21wYm9vdC5jCisrKyBi
L3hlbi9hcmNoL3g4Ni9zbXBib290LmMKQEAgLTY4Nyw3ICs2ODcsNyBAQCBzdGF0aWMgaW50IGNs
b25lX21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0KQogICAgICAg
ICBnb3RvIG91dDsKICAgICB9CiAKLSAgICBwbDNlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KAor
ICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZSgKICAgICAgICAgbDRlX2dldF9tZm4oaWRsZV9w
Z190YWJsZVtyb290X3RhYmxlX29mZnNldChsaW5lYXIpXSkpOwogICAgIHBsM2UgKz0gbDNfdGFi
bGVfb2Zmc2V0KGxpbmVhcik7CiAKQEAgLTcwMSw3ICs3MDEsNyBAQCBzdGF0aWMgaW50IGNsb25l
X21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0KQogICAgIH0KICAg
ICBlbHNlCiAgICAgewotICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9n
ZXRfbWZuKCpwbDNlKSk7CisgICAgICAgIHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0
X21mbigqcGwzZSkpOwogICAgICAgICBwbDJlICs9IGwyX3RhYmxlX29mZnNldChsaW5lYXIpOwog
ICAgICAgICBmbGFncyA9IGwyZV9nZXRfZmxhZ3MoKnBsMmUpOwogICAgICAgICBBU1NFUlQoZmxh
Z3MgJiBfUEFHRV9QUkVTRU5UKTsKQEAgLTcxMyw3ICs3MTMsNyBAQCBzdGF0aWMgaW50IGNsb25l
X21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0KQogICAgICAgICB9
CiAgICAgICAgIGVsc2UKICAgICAgICAgewotICAgICAgICAgICAgcGwxZSA9IG1hcF94ZW5fcGFn
ZXRhYmxlX25ldyhsMmVfZ2V0X21mbigqcGwyZSkpOworICAgICAgICAgICAgcGwxZSA9IG1hcF94
ZW5fcGFnZXRhYmxlKGwyZV9nZXRfbWZuKCpwbDJlKSk7CiAgICAgICAgICAgICBwbDFlICs9IGwx
X3RhYmxlX29mZnNldChsaW5lYXIpOwogICAgICAgICAgICAgZmxhZ3MgPSBsMWVfZ2V0X2ZsYWdz
KCpwbDFlKTsKICAgICAgICAgICAgIGlmICggIShmbGFncyAmIF9QQUdFX1BSRVNFTlQpICkKQEAg
LTcyNSwxMyArNzI1LDEzIEBAIHN0YXRpYyBpbnQgY2xvbmVfbWFwcGluZyhjb25zdCB2b2lkICpw
dHIsIHJvb3RfcGdlbnRyeV90ICpycHQpCiAgICAgICAgIH0KICAgICB9CiAKLSAgICBVTk1BUF9Y
RU5fUEFHRVRBQkxFX05FVyhwbDFlKTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDJl
KTsKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDNlKTsKKyAgICBVTk1BUF9YRU5fUEFH
RVRBQkxFKHBsMWUpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocGwyZSk7CisgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShwbDNlKTsKIAogICAgIGlmICggIShyb290X2dldF9mbGFncyhycHRbcm9v
dF90YWJsZV9vZmZzZXQobGluZWFyKV0pICYgX1BBR0VfUFJFU0VOVCkgKQogICAgIHsKLSAgICAg
ICAgbWZuX3QgbDN0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgIG1m
bl90IGwzdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAKICAgICAgICAgaWYgKCBtZm5f
ZXEobDN0X21mbiwgSU5WQUxJRF9NRk4pICkKICAgICAgICAgewpAQCAtNzM5LDIwICs3MzksMjAg
QEAgc3RhdGljIGludCBjbG9uZV9tYXBwaW5nKGNvbnN0IHZvaWQgKnB0ciwgcm9vdF9wZ2VudHJ5
X3QgKnJwdCkKICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgICAgICB9CiAKLSAgICAgICAgcGwz
ZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM3RfbWZuKTsKKyAgICAgICAgcGwzZSA9IG1hcF94
ZW5fcGFnZXRhYmxlKGwzdF9tZm4pOwogICAgICAgICBjbGVhcl9wYWdlKHBsM2UpOwogICAgICAg
ICBsNGVfd3JpdGUoJnJwdFtyb290X3RhYmxlX29mZnNldChsaW5lYXIpXSwKICAgICAgICAgICAg
ICAgICAgIGw0ZV9mcm9tX21mbihsM3RfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUikpOwogICAgIH0K
ICAgICBlbHNlCi0gICAgICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgICAg
IHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZSgKICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKHJwdFty
b290X3RhYmxlX29mZnNldChsaW5lYXIpXSkpOwogCiAgICAgcGwzZSArPSBsM190YWJsZV9vZmZz
ZXQobGluZWFyKTsKIAogICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BS
RVNFTlQpICkKICAgICB7Ci0gICAgICAgIG1mbl90IGwydF9tZm4gPSBhbGxvY194ZW5fcGFnZXRh
YmxlX25ldygpOworICAgICAgICBtZm5fdCBsMnRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgp
OwogCiAgICAgICAgIGlmICggbWZuX2VxKGwydF9tZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAg
IHsKQEAgLTc2MCwyMSArNzYwLDIxIEBAIHN0YXRpYyBpbnQgY2xvbmVfbWFwcGluZyhjb25zdCB2
b2lkICpwdHIsIHJvb3RfcGdlbnRyeV90ICpycHQpCiAgICAgICAgICAgICBnb3RvIG91dDsKICAg
ICAgICAgfQogCi0gICAgICAgIHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDJ0X21mbik7
CisgICAgICAgIHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMnRfbWZuKTsKICAgICAgICAgY2xl
YXJfcGFnZShwbDJlKTsKICAgICAgICAgbDNlX3dyaXRlKHBsM2UsIGwzZV9mcm9tX21mbihsMnRf
bWZuLCBfX1BBR0VfSFlQRVJWSVNPUikpOwogICAgIH0KICAgICBlbHNlCiAgICAgewogICAgICAg
ICBBU1NFUlQoIShsM2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BTRSkpOwotICAgICAgICBw
bDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKCpwbDNlKSk7CisgICAgICAg
IHBsMmUgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0X21mbigqcGwzZSkpOwogICAgIH0KIAog
ICAgIHBsMmUgKz0gbDJfdGFibGVfb2Zmc2V0KGxpbmVhcik7CiAKICAgICBpZiAoICEobDJlX2dl
dF9mbGFncygqcGwyZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgewotICAgICAgICBtZm5fdCBs
MXRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgbWZuX3QgbDF0X21m
biA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKIAogICAgICAgICBpZiAoIG1mbl9lcShsMXRfbWZu
LCBJTlZBTElEX01GTikgKQogICAgICAgICB7CkBAIC03ODIsMTQgKzc4MiwxNCBAQCBzdGF0aWMg
aW50IGNsb25lX21hcHBpbmcoY29uc3Qgdm9pZCAqcHRyLCByb290X3BnZW50cnlfdCAqcnB0KQog
ICAgICAgICAgICAgZ290byBvdXQ7CiAgICAgICAgIH0KIAotICAgICAgICBwbDFlID0gbWFwX3hl
bl9wYWdldGFibGVfbmV3KGwxdF9tZm4pOworICAgICAgICBwbDFlID0gbWFwX3hlbl9wYWdldGFi
bGUobDF0X21mbik7CiAgICAgICAgIGNsZWFyX3BhZ2UocGwxZSk7CiAgICAgICAgIGwyZV93cml0
ZShwbDJlLCBsMmVfZnJvbV9tZm4obDF0X21mbiwgX19QQUdFX0hZUEVSVklTT1IpKTsKICAgICB9
CiAgICAgZWxzZQogICAgIHsKICAgICAgICAgQVNTRVJUKCEobDJlX2dldF9mbGFncygqcGwyZSkg
JiBfUEFHRV9QU0UpKTsKLSAgICAgICAgcGwxZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMmVf
Z2V0X21mbigqcGwyZSkpOworICAgICAgICBwbDFlID0gbWFwX3hlbl9wYWdldGFibGUobDJlX2dl
dF9tZm4oKnBsMmUpKTsKICAgICB9CiAKICAgICBwbDFlICs9IGwxX3RhYmxlX29mZnNldChsaW5l
YXIpOwpAQCAtODA1LDkgKzgwNSw5IEBAIHN0YXRpYyBpbnQgY2xvbmVfbWFwcGluZyhjb25zdCB2
b2lkICpwdHIsIHJvb3RfcGdlbnRyeV90ICpycHQpCiAKICAgICByYyA9IDA7CiAgb3V0OgotICAg
IFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKHBsMWUpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVf
TkVXKHBsMmUpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKHBsM2UpOworICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEUocGwxZSk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDJlKTsKKyAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsM2UpOwogICAgIHJldHVybiByYzsKIH0KIApAQCAtODMw
LDE0ICs4MzAsMTQgQEAgc3RhdGljIGludCBzZXR1cF9jcHVfcm9vdF9wZ3QodW5zaWduZWQgaW50
IGNwdSkKICAgICAgICAgZ290byBvdXQ7CiAgICAgfQogCi0gICAgcnB0X21mbiA9IGFsbG9jX3hl
bl9wYWdldGFibGVfbmV3KCk7CisgICAgcnB0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUoKTsK
ICAgICBpZiAoIG1mbl9lcShycHRfbWZuLCBJTlZBTElEX01GTikgKQogICAgIHsKICAgICAgICAg
cmMgPSAtRU5PTUVNOwogICAgICAgICBnb3RvIG91dDsKICAgICB9CiAKLSAgICBycHQgPSBtYXBf
eGVuX3BhZ2V0YWJsZV9uZXcocnB0X21mbik7CisgICAgcnB0ID0gbWFwX3hlbl9wYWdldGFibGUo
cnB0X21mbik7CiAgICAgY2xlYXJfcGFnZShycHQpOwogICAgIHBlcl9jcHUocm9vdF9wZ3RfbWZu
LCBjcHUpID0gcnB0X21mbjsKIApAQCAtODgyLDcgKzg4Miw3IEBAIHN0YXRpYyBpbnQgc2V0dXBf
Y3B1X3Jvb3RfcGd0KHVuc2lnbmVkIGludCBjcHUpCiAgICAgICAgIHJjID0gY2xvbmVfbWFwcGlu
Zygodm9pZCAqKXBlcl9jcHUoc3R1YnMuYWRkciwgY3B1KSwgcnB0KTsKIAogIG91dDoKLSAgICBV
Tk1BUF9YRU5fUEFHRVRBQkxFX05FVyhycHQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUocnB0
KTsKICAgICByZXR1cm4gcmM7CiB9CiAKQEAgLTg5OCw3ICs4OTgsNyBAQCBzdGF0aWMgdm9pZCBj
bGVhbnVwX2NwdV9yb290X3BndCh1bnNpZ25lZCBpbnQgY3B1KQogCiAgICAgcGVyX2NwdShyb290
X3BndF9tZm4sIGNwdSkgPSBJTlZBTElEX01GTjsKIAotICAgIHJwdCA9IG1hcF94ZW5fcGFnZXRh
YmxlX25ldyhycHRfbWZuKTsKKyAgICBycHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShycHRfbWZuKTsK
IAogICAgIGZvciAoIHIgPSByb290X3RhYmxlX29mZnNldChESVJFQ1RNQVBfVklSVF9TVEFSVCk7
CiAgICAgICAgICAgciA8IHJvb3RfdGFibGVfb2Zmc2V0KEhZUEVSVklTT1JfVklSVF9FTkQpOyAr
K3IgKQpAQCAtOTExLDcgKzkxMSw3IEBAIHN0YXRpYyB2b2lkIGNsZWFudXBfY3B1X3Jvb3RfcGd0
KHVuc2lnbmVkIGludCBjcHUpCiAgICAgICAgICAgICBjb250aW51ZTsKIAogICAgICAgICBsM3Rf
bWZuID0gbDRlX2dldF9tZm4ocnB0W3JdKTsKLSAgICAgICAgbDN0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzdF9tZm4pOworICAgICAgICBsM3QgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM3RfbWZu
KTsKIAogICAgICAgICBmb3IgKCBpMyA9IDA7IGkzIDwgTDNfUEFHRVRBQkxFX0VOVFJJRVM7ICsr
aTMgKQogICAgICAgICB7CkBAIC05MjQsNyArOTI0LDcgQEAgc3RhdGljIHZvaWQgY2xlYW51cF9j
cHVfcm9vdF9wZ3QodW5zaWduZWQgaW50IGNwdSkKIAogICAgICAgICAgICAgQVNTRVJUKCEobDNl
X2dldF9mbGFncyhsM3RbaTNdKSAmIF9QQUdFX1BTRSkpOwogICAgICAgICAgICAgbDJ0X21mbiA9
IGwzZV9nZXRfbWZuKGwzdFtpM10pOwotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwydF9tZm4pOworICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGUobDJ0
X21mbik7CiAKICAgICAgICAgICAgIGZvciAoIGkyID0gMDsgaTIgPCBMMl9QQUdFVEFCTEVfRU5U
UklFUzsgKytpMiApCiAgICAgICAgICAgICB7CkBAIC05MzIsMzQgKzkzMiwzNCBAQCBzdGF0aWMg
dm9pZCBjbGVhbnVwX2NwdV9yb290X3BndCh1bnNpZ25lZCBpbnQgY3B1KQogICAgICAgICAgICAg
ICAgICAgICBjb250aW51ZTsKIAogICAgICAgICAgICAgICAgIEFTU0VSVCghKGwyZV9nZXRfZmxh
Z3MobDJ0W2kyXSkgJiBfUEFHRV9QU0UpKTsKLSAgICAgICAgICAgICAgICBmcmVlX3hlbl9wYWdl
dGFibGVfbmV3KGwyZV9nZXRfbWZuKGwydFtpMl0pKTsKKyAgICAgICAgICAgICAgICBmcmVlX3hl
bl9wYWdldGFibGUobDJlX2dldF9tZm4obDJ0W2kyXSkpOwogICAgICAgICAgICAgfQogCi0gICAg
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOwotICAgICAgICAgICAgZnJlZV94
ZW5fcGFnZXRhYmxlX25ldyhsMnRfbWZuKTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEUobDJ0KTsKKyAgICAgICAgICAgIGZyZWVfeGVuX3BhZ2V0YWJsZShsMnRfbWZuKTsKICAgICAg
ICAgfQogCi0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwzdCk7Ci0gICAgICAgIGZy
ZWVfeGVuX3BhZ2V0YWJsZV9uZXcobDN0X21mbik7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEUobDN0KTsKKyAgICAgICAgZnJlZV94ZW5fcGFnZXRhYmxlKGwzdF9tZm4pOwogICAgIH0KIAot
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKHJwdCk7Ci0gICAgZnJlZV94ZW5fcGFnZXRhYmxl
X25ldyhycHRfbWZuKTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKHJwdCk7CisgICAgZnJlZV94
ZW5fcGFnZXRhYmxlKHJwdF9tZm4pOwogCiAgICAgLyogQWxzbyB6YXAgdGhlIHN0dWIgbWFwcGlu
ZyBmb3IgdGhpcyBDUFUuICovCiAgICAgaWYgKCBzdHViX2xpbmVhciApCiAgICAgewotICAgICAg
ICBsM19wZ2VudHJ5X3QgKmwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsNGVfZ2V0X21mbihj
b21tb25fcGd0KSk7Ci0gICAgICAgIGwyX3BnZW50cnlfdCAqbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KAorICAgICAgICBsM19wZ2VudHJ5X3QgKmwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGw0
ZV9nZXRfbWZuKGNvbW1vbl9wZ3QpKTsKKyAgICAgICAgbDJfcGdlbnRyeV90ICpsMnQgPSBtYXBf
eGVuX3BhZ2V0YWJsZSgKICAgICAgICAgICAgIGwzZV9nZXRfbWZuKGwzdFtsM190YWJsZV9vZmZz
ZXQoc3R1Yl9saW5lYXIpXSkpOwotICAgICAgICBsMV9wZ2VudHJ5X3QgKmwxdCA9IG1hcF94ZW5f
cGFnZXRhYmxlX25ldygKKyAgICAgICAgbDFfcGdlbnRyeV90ICpsMXQgPSBtYXBfeGVuX3BhZ2V0
YWJsZSgKICAgICAgICAgICAgIGwyZV9nZXRfbWZuKGwydFtsMl90YWJsZV9vZmZzZXQoc3R1Yl9s
aW5lYXIpXSkpOwogCiAgICAgICAgIGwxdFtsMV90YWJsZV9vZmZzZXQoc3R1Yl9saW5lYXIpXSA9
IGwxZV9lbXB0eSgpOwogCi0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwxdCk7Ci0g
ICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Ci0gICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEVfTkVXKGwzdCk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDF0KTsKKyAg
ICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFKGwzdCk7CiAgICAgfQogfQogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYveDg2XzY0L21t
LmMgYi94ZW4vYXJjaC94ODYveDg2XzY0L21tLmMKaW5kZXggYTFjNjlkN2YwZS4uODQyNTQ4Yjky
NSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3g4Nl82NC9tbS5jCisrKyBiL3hlbi9hcmNoL3g4
Ni94ODZfNjQvbW0uYwpAQCAtMTM0LDcgKzEzNCw3IEBAIHN0YXRpYyBpbnQgbTJwX21hcHBlZCh1
bnNpZ25lZCBsb25nIHNwZm4pCiAgICAgaW50IHJjID0gTTJQX05PX01BUFBFRDsKIAogICAgIHZh
ID0gUk9fTVBUX1ZJUlRfU1RBUlQgKyBzcGZuICogc2l6ZW9mKCptYWNoaW5lX3RvX3BoeXNfbWFw
cGluZyk7Ci0gICAgbDNfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgIGwzX3Jv
X21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3Rh
YmxlW2w0X3RhYmxlX29mZnNldCh2YSldKSk7CiAKICAgICBzd2l0Y2ggKCBsM2VfZ2V0X2ZsYWdz
KGwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSkgJgpAQCAtMTUwLDE1ICsxNTAsMTUgQEAg
c3RhdGljIGludCBtMnBfbWFwcGVkKHVuc2lnbmVkIGxvbmcgc3BmbikKICAgICAgICAgICAgIHJj
ID0gTTJQX05PX01BUFBFRDsKICAgICAgICAgICAgIGdvdG8gb3V0OwogICAgIH0KLSAgICBsMl9y
b19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9w
YWdldGFibGUoCiAgICAgICAgIGwzZV9nZXRfbWZuKGwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQo
dmEpXSkpOwogCiAgICAgaWYgKGwyZV9nZXRfZmxhZ3MobDJfcm9fbXB0W2wyX3RhYmxlX29mZnNl
dCh2YSldKSAmIF9QQUdFX1BSRVNFTlQpCiAgICAgICAgIHJjID0gTTJQXzJNX01BUFBFRDsKIAog
IG91dDoKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMl9yb19tcHQpOwotICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEVfTkVXKGwzX3JvX21wdCk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShs
Ml9yb19tcHQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDNfcm9fbXB0KTsKICAgICByZXR1
cm4gcmM7CiB9CiAKQEAgLTE3NiwxMCArMTc2LDEwIEBAIHN0YXRpYyBpbnQgc2hhcmVfaG90YWRk
X20ycF90YWJsZShzdHJ1Y3QgbWVtX2hvdGFkZF9pbmZvICppbmZvKQogICAgIHsKICAgICAgICAg
biA9IEwyX1BBR0VUQUJMRV9FTlRSSUVTICogTDFfUEFHRVRBQkxFX0VOVFJJRVM7CiAKLSAgICAg
ICAgbDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgICAgICBsM3QgPSBtYXBfeGVuX3Bh
Z2V0YWJsZSgKICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbbDRfdGFibGVf
b2Zmc2V0KHYpXSkpOwogICAgICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KHYpXTsKLSAg
ICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0KTsKKyAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShsM3QpOwogCiAgICAgICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFH
RV9QUkVTRU5UKSApCiAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTE4Nyw5ICsxODcsOSBAQCBz
dGF0aWMgaW50IHNoYXJlX2hvdGFkZF9tMnBfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAq
aW5mbykKICAgICAgICAgewogICAgICAgICAgICAgbiA9IEwxX1BBR0VUQUJMRV9FTlRSSUVTOwog
Ci0gICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobDNlX2dldF9tZm4obDNl
KSk7CisgICAgICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM2VfZ2V0X21mbihsM2Up
KTsKICAgICAgICAgICAgIGwyZSA9IGwydFtsMl90YWJsZV9vZmZzZXQodildOwotICAgICAgICAg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJ0KTsKKyAgICAgICAgICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEUobDJ0KTsKIAogICAgICAgICAgICAgaWYgKCAhKGwyZV9nZXRfZmxhZ3MobDJlKSAm
IF9QQUdFX1BSRVNFTlQpICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTIxMSwxNyAr
MjExLDE3IEBAIHN0YXRpYyBpbnQgc2hhcmVfaG90YWRkX20ycF90YWJsZShzdHJ1Y3QgbWVtX2hv
dGFkZF9pbmZvICppbmZvKQogICAgICAgICAgIHYgIT0gUkRXUl9DT01QQVRfTVBUX1ZJUlRfRU5E
OwogICAgICAgICAgIHYgKz0gMSA8PCBMMl9QQUdFVEFCTEVfU0hJRlQgKQogICAgIHsKLSAgICAg
ICAgbDN0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgICAgICBsM3QgPSBtYXBfeGVuX3Bh
Z2V0YWJsZSgKICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbbDRfdGFibGVf
b2Zmc2V0KHYpXSkpOwogICAgICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KHYpXTsKLSAg
ICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0KTsKKyAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShsM3QpOwogCiAgICAgICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFH
RV9QUkVTRU5UKSApCiAgICAgICAgICAgICBjb250aW51ZTsKIAotICAgICAgICBsMnQgPSBtYXBf
eGVuX3BhZ2V0YWJsZV9uZXcobDNlX2dldF9tZm4obDNlKSk7CisgICAgICAgIGwydCA9IG1hcF94
ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZuKGwzZSkpOwogICAgICAgICBsMmUgPSBsMnRbbDJfdGFi
bGVfb2Zmc2V0KHYpXTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJ0KTsKKyAg
ICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMnQpOwogCiAgICAgICAgIGlmICggIShsMmVfZ2V0
X2ZsYWdzKGwyZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAgICAgICBjb250aW51ZTsKQEAg
LTI1MiwxMiArMjUyLDEyIEBAIHN0YXRpYyB2b2lkIGRlc3Ryb3lfY29tcGF0X20ycF9tYXBwaW5n
KHN0cnVjdCBtZW1faG90YWRkX2luZm8gKmluZm8pCiAgICAgaWYgKCBlbWFwID4gKChSRFdSX0NP
TVBBVF9NUFRfVklSVF9FTkQgLSBSRFdSX0NPTVBBVF9NUFRfVklSVF9TVEFSVCkgPj4gMikgKQog
ICAgICAgICBlbWFwID0gKFJEV1JfQ09NUEFUX01QVF9WSVJUX0VORCAtIFJEV1JfQ09NUEFUX01Q
VF9WSVJUX1NUQVJUKSA+PiAyOwogCi0gICAgbDNfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVf
bmV3KAorICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICBsNGVfZ2V0
X21mbihpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldChISVJPX0NPTVBBVF9NUFRfVklSVF9T
VEFSVCldKSk7CiAKICAgICBBU1NFUlQobDNlX2dldF9mbGFncyhsM19yb19tcHRbbDNfdGFibGVf
b2Zmc2V0KEhJUk9fQ09NUEFUX01QVF9WSVJUX1NUQVJUKV0pICYgX1BBR0VfUFJFU0VOVCk7CiAK
LSAgICBsMl9yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgbDJfcm9fbXB0ID0g
bWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgIGwzZV9nZXRfbWZuKGwzX3JvX21wdFtsM190YWJs
ZV9vZmZzZXQoSElST19DT01QQVRfTVBUX1ZJUlRfU1RBUlQpXSkpOwogCiAgICAgZm9yICggaSA9
IHNtYXA7IGkgPCBlbWFwOyApCkBAIC0yODAsOCArMjgwLDggQEAgc3RhdGljIHZvaWQgZGVzdHJv
eV9jb21wYXRfbTJwX21hcHBpbmcoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICAg
ICAgaSArPSAxVUwgPDwgKEwyX1BBR0VUQUJMRV9TSElGVCAtIDIpOwogICAgIH0KIAotICAgIFVO
TUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwyX3JvX21wdCk7Ci0gICAgVU5NQVBfWEVOX1BBR0VUQUJM
RV9ORVcobDNfcm9fbXB0KTsKKyAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwyX3JvX21wdCk7Cisg
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM19yb19tcHQpOwogCiAgICAgcmV0dXJuOwogfQpAQCAt
MjkyLDcgKzI5Miw3IEBAIHN0YXRpYyB2b2lkIGRlc3Ryb3lfbTJwX21hcHBpbmcoc3RydWN0IG1l
bV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICB1bnNpZ25lZCBsb25nIGksIHZhLCByd3ZhOwogICAg
IHVuc2lnbmVkIGxvbmcgc21hcCA9IGluZm8tPnNwZm4sIGVtYXAgPSBpbmZvLT5lcGZuOwogCi0g
ICAgbDNfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgIGwzX3JvX21wdCA9IG1h
cF94ZW5fcGFnZXRhYmxlKAogICAgICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3RhYmxlW2w0X3Rh
YmxlX29mZnNldChST19NUFRfVklSVF9TVEFSVCldKSk7CiAKICAgICAvKgpAQCAtMzE1LDEzICsz
MTUsMTMgQEAgc3RhdGljIHZvaWQgZGVzdHJveV9tMnBfbWFwcGluZyhzdHJ1Y3QgbWVtX2hvdGFk
ZF9pbmZvICppbmZvKQogICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgIH0KIAotICAgICAg
ICBsMl9yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgICAgIGwyX3JvX21wdCA9
IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICAgICAgbDNlX2dldF9tZm4obDNfcm9fbXB0W2wz
X3RhYmxlX29mZnNldCh2YSldKSk7CiAgICAgICAgIGlmICghKGwyZV9nZXRfZmxhZ3MobDJfcm9f
bXB0W2wyX3RhYmxlX29mZnNldCh2YSldKSAmIF9QQUdFX1BSRVNFTlQpKQogICAgICAgICB7CiAg
ICAgICAgICAgICBpID0gKCBpICYgfigoMVVMIDw8IChMMl9QQUdFVEFCTEVfU0hJRlQgLSAzKSkg
LSAxKSkgKwogICAgICAgICAgICAgICAgICAgICAoMVVMIDw8IChMMl9QQUdFVEFCTEVfU0hJRlQg
LSAzKSkgOwotICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJfcm9fbXB0KTsK
KyAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDJfcm9fbXB0KTsKICAgICAgICAgICAg
IGNvbnRpbnVlOwogICAgICAgICB9CiAKQEAgLTMzMiwxNyArMzMyLDE3IEBAIHN0YXRpYyB2b2lk
IGRlc3Ryb3lfbTJwX21hcHBpbmcoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKIAogICAg
ICAgICAgICAgZGVzdHJveV94ZW5fbWFwcGluZ3Mocnd2YSwgcnd2YSArICgxVUwgPDwgTDJfUEFH
RVRBQkxFX1NISUZUKSk7CiAKLSAgICAgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlX25l
dygKKyAgICAgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICAgICAgICAg
IGwzZV9nZXRfbWZuKGwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSkpOwogICAgICAgICAg
ICAgbDJlX3dyaXRlKCZsMnRbbDJfdGFibGVfb2Zmc2V0KHZhKV0sIGwyZV9lbXB0eSgpKTsKLSAg
ICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7CisgICAgICAgICAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFKGwydCk7CiAgICAgICAgIH0KICAgICAgICAgaSA9ICggaSAmIH4oKDFV
TCA8PCAoTDJfUEFHRVRBQkxFX1NISUZUIC0gMykpIC0gMSkpICsKICAgICAgICAgICAgICAgKDFV
TCA8PCAoTDJfUEFHRVRBQkxFX1NISUZUIC0gMykpOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFX05FVyhsMl9yb19tcHQpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwyX3JvX21w
dCk7CiAgICAgfQogCi0gICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDNfcm9fbXB0KTsKKyAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzX3JvX21wdCk7CiAKICAgICBkZXN0cm95X2NvbXBhdF9t
MnBfbWFwcGluZyhpbmZvKTsKIApAQCAtMzgyLDEyICszODIsMTIgQEAgc3RhdGljIGludCBzZXR1
cF9jb21wYXRfbTJwX3RhYmxlKHN0cnVjdCBtZW1faG90YWRkX2luZm8gKmluZm8pCiAKICAgICB2
YSA9IEhJUk9fQ09NUEFUX01QVF9WSVJUX1NUQVJUICsKICAgICAgICAgIHNtYXAgKiBzaXplb2Yo
KmNvbXBhdF9tYWNoaW5lX3RvX3BoeXNfbWFwcGluZyk7Ci0gICAgbDNfcm9fbXB0ID0gbWFwX3hl
bl9wYWdldGFibGVfbmV3KAorICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAg
ICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldCh2YSldKSk7CiAK
ICAgICBBU1NFUlQobDNlX2dldF9mbGFncyhsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0KHZhKV0p
ICYgX1BBR0VfUFJFU0VOVCk7CiAKLSAgICBsMl9yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZV9u
ZXcoCisgICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGUoCiAgICAgICAgIGwzZV9nZXRf
bWZuKGwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSkpOwogCiAjZGVmaW5lIE1GTih4KSAo
KCh4KSA8PCBMMl9QQUdFVEFCTEVfU0hJRlQpIC8gc2l6ZW9mKHVuc2lnbmVkIGludCkpCkBAIC00
MjcsOCArNDI3LDggQEAgc3RhdGljIGludCBzZXR1cF9jb21wYXRfbTJwX3RhYmxlKHN0cnVjdCBt
ZW1faG90YWRkX2luZm8gKmluZm8pCiAjdW5kZWYgQ05UCiAjdW5kZWYgTUZOCiAKLSAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFX05FVyhsMl9yb19tcHQpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVf
TkVXKGwzX3JvX21wdCk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOworICAg
IFVOTUFQX1hFTl9QQUdFVEFCTEUobDNfcm9fbXB0KTsKICAgICByZXR1cm4gZXJyOwogfQogCkBA
IC00NDksNyArNDQ5LDcgQEAgc3RhdGljIGludCBzZXR1cF9tMnBfdGFibGUoc3RydWN0IG1lbV9o
b3RhZGRfaW5mbyAqaW5mbykKICAgICAgICAgICAgICYgX1BBR0VfUFJFU0VOVCk7CiAgICAgbDNf
cm9fbXB0X21mbiA9IGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbbDRfdGFibGVfb2Zmc2V0KAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJPX01QVF9WSVJUX1NUQVJU
KV0pOwotICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM19yb19tcHRfbWZu
KTsKKyAgICBsM19yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsM19yb19tcHRfbWZuKTsKIAog
ICAgIHNtYXAgPSAoaW5mby0+c3BmbiAmICh+KCgxVUwgPDwgKEwyX1BBR0VUQUJMRV9TSElGVCAt
IDMpKSAtMSkpKTsKICAgICBlbWFwID0gKChpbmZvLT5lcGZuICsgKCgxVUwgPDwgKEwyX1BBR0VU
QUJMRV9TSElGVCAtIDMpKSAtIDEgKSkgJgpAQCAtNTA1LDIzICs1MDUsMjMgQEAgc3RhdGljIGlu
dCBzZXR1cF9tMnBfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICAgICAg
ICAgIGlmICggbDNlX2dldF9mbGFncyhsM19yb19tcHRbbDNfdGFibGVfb2Zmc2V0KHZhKV0pICYK
ICAgICAgICAgICAgICAgX1BBR0VfUFJFU0VOVCApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAg
ICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJfcm9fbXB0KTsKKyAgICAgICAgICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwyX3JvX21wdCk7CiAgICAgICAgICAgICAgICAgbDJfcm9f
bXB0X21mbiA9IGwzZV9nZXRfbWZuKGwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSk7Ci0g
ICAgICAgICAgICAgICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwyX3JvX21w
dF9tZm4pOworICAgICAgICAgICAgICAgIGwyX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwy
X3JvX21wdF9tZm4pOwogICAgICAgICAgICAgICAgIEFTU0VSVChsMl9yb19tcHQpOwogICAgICAg
ICAgICAgICAgIHBsMmUgPSBsMl9yb19tcHQgKyBsMl90YWJsZV9vZmZzZXQodmEpOwogICAgICAg
ICAgICAgfQogICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAg
IFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwyX3JvX21wdCk7Ci0gICAgICAgICAgICAgICAgbDJf
cm9fbXB0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgICAgICAgICAg
VU5NQVBfWEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOworICAgICAgICAgICAgICAgIGwyX3JvX21w
dF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAgICAgICAgICAgaWYgKCBtZm5f
ZXEobDJfcm9fbXB0X21mbiwgSU5WQUxJRF9NRk4pICkKICAgICAgICAgICAgICAgICB7CiAgICAg
ICAgICAgICAgICAgICAgIHJldCA9IC1FTk9NRU07CiAgICAgICAgICAgICAgICAgICAgIGdvdG8g
ZXJyb3I7CiAgICAgICAgICAgICAgICAgfQogCi0gICAgICAgICAgICAgICAgbDJfcm9fbXB0ID0g
bWFwX3hlbl9wYWdldGFibGVfbmV3KGwyX3JvX21wdF9tZm4pOworICAgICAgICAgICAgICAgIGwy
X3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwyX3JvX21wdF9tZm4pOwogICAgICAgICAgICAg
ICAgIGNsZWFyX3BhZ2UobDJfcm9fbXB0KTsKICAgICAgICAgICAgICAgICBsM2Vfd3JpdGUoJmwz
X3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
bDNlX2Zyb21fbWZuKGwyX3JvX21wdF9tZm4sCkBAIC01NDEsOCArNTQxLDggQEAgc3RhdGljIGlu
dCBzZXR1cF9tMnBfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKIAogICAgIHJl
dCA9IHNldHVwX2NvbXBhdF9tMnBfdGFibGUoaW5mbyk7CiBlcnJvcjoKLSAgICBVTk1BUF9YRU5f
UEFHRVRBQkxFX05FVyhsMl9yb19tcHQpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwz
X3JvX21wdCk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOworICAgIFVOTUFQ
X1hFTl9QQUdFVEFCTEUobDNfcm9fbXB0KTsKICAgICByZXR1cm4gcmV0OwogfQogCkBAIC01Njks
MjMgKzU2OSwyMyBAQCB2b2lkIF9faW5pdCBwYWdpbmdfaW5pdCh2b2lkKQogICAgICAgICAgICAg
bDNfcGdlbnRyeV90ICpwbDN0OwogICAgICAgICAgICAgbWZuX3QgbWZuOwogCi0gICAgICAgICAg
ICBtZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlX25ldygpOworICAgICAgICAgICAgbWZuID0gYWxs
b2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAgaWYgKCBtZm5fZXEobWZuLCBJTlZBTElE
X01GTikgKQogICAgICAgICAgICAgICAgIGdvdG8gbm9tZW07CiAKLSAgICAgICAgICAgIHBsM3Qg
PSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcobWZuKTsKKyAgICAgICAgICAgIHBsM3QgPSBtYXBfeGVu
X3BhZ2V0YWJsZShtZm4pOwogICAgICAgICAgICAgY2xlYXJfcGFnZShwbDN0KTsKICAgICAgICAg
ICAgIGw0ZV93cml0ZSgmaWRsZV9wZ190YWJsZVtsNF90YWJsZV9vZmZzZXQodmEpXSwKICAgICAg
ICAgICAgICAgICAgICAgICBsNGVfZnJvbV9tZm4obWZuLCBfX1BBR0VfSFlQRVJWSVNPUl9SVykp
OwotICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcocGwzdCk7CisgICAgICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFKHBsM3QpOwogICAgICAgICB9CiAgICAgfQogCiAgICAgLyog
Q3JlYXRlIHVzZXItYWNjZXNzaWJsZSBMMiBkaXJlY3RvcnkgdG8gbWFwIHRoZSBNUFQgZm9yIGd1
ZXN0cy4gKi8KLSAgICBsM19yb19tcHRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsK
KyAgICBsM19yb19tcHRfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgIGlmICggbWZu
X2VxKGwzX3JvX21wdF9tZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAgIGdvdG8gbm9tZW07Ci0g
ICAgbDNfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzX3JvX21wdF9tZm4pOworICAg
IGwzX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzX3JvX21wdF9tZm4pOwogICAgIGNsZWFy
X3BhZ2UobDNfcm9fbXB0KTsKICAgICBsNGVfd3JpdGUoJmlkbGVfcGdfdGFibGVbbDRfdGFibGVf
b2Zmc2V0KFJPX01QVF9WSVJUX1NUQVJUKV0sCiAgICAgICAgICAgICAgIGw0ZV9mcm9tX21mbihs
M19yb19tcHRfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUl9STyB8IF9QQUdFX1VTRVIpKTsKQEAgLTY3
NSwxMyArNjc1LDEzIEBAIHZvaWQgX19pbml0IHBhZ2luZ19pbml0KHZvaWQpCiAgICAgICAgICAg
ICAgKiBVbm1hcCBsMl9yb19tcHQsIHdoaWNoIGNvdWxkJ3ZlIGJlZW4gbWFwcGVkIGluIHByZXZp
b3VzCiAgICAgICAgICAgICAgKiBpdGVyYXRpb24uCiAgICAgICAgICAgICAgKi8KLSAgICAgICAg
ICAgIHVubWFwX3hlbl9wYWdldGFibGVfbmV3KGwyX3JvX21wdCk7CisgICAgICAgICAgICB1bm1h
cF94ZW5fcGFnZXRhYmxlKGwyX3JvX21wdCk7CiAKLSAgICAgICAgICAgIGwyX3JvX21wdF9tZm4g
PSBhbGxvY194ZW5fcGFnZXRhYmxlX25ldygpOworICAgICAgICAgICAgbDJfcm9fbXB0X21mbiA9
IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICAgICAgICAgIGlmICggbWZuX2VxKGwyX3JvX21w
dF9tZm4sIElOVkFMSURfTUZOKSApCiAgICAgICAgICAgICAgICAgZ290byBub21lbTsKIAotICAg
ICAgICAgICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwyX3JvX21wdF9tZm4p
OworICAgICAgICAgICAgbDJfcm9fbXB0ID0gbWFwX3hlbl9wYWdldGFibGUobDJfcm9fbXB0X21m
bik7CiAgICAgICAgICAgICBjbGVhcl9wYWdlKGwyX3JvX21wdCk7CiAgICAgICAgICAgICBsM2Vf
d3JpdGUoJmwzX3JvX21wdFtsM190YWJsZV9vZmZzZXQodmEpXSwKICAgICAgICAgICAgICAgICAg
ICAgICBsM2VfZnJvbV9tZm4obDJfcm9fbXB0X21mbiwKQEAgLTY5Nyw4ICs2OTcsOCBAQCB2b2lk
IF9faW5pdCBwYWdpbmdfaW5pdCh2b2lkKQogICAgIH0KICN1bmRlZiBDTlQKICN1bmRlZiBNRk4K
LSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMl9yb19tcHQpOwotICAgIFVOTUFQX1hFTl9Q
QUdFVEFCTEVfTkVXKGwzX3JvX21wdCk7CisgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsMl9yb19t
cHQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDNfcm9fbXB0KTsKIAogICAgIC8qIENyZWF0
ZSB1c2VyLWFjY2Vzc2libGUgTDIgZGlyZWN0b3J5IHRvIG1hcCB0aGUgTVBUIGZvciBjb21wYXQg
Z3Vlc3RzLiAqLwogICAgIEJVSUxEX0JVR19PTihsNF90YWJsZV9vZmZzZXQoUkRXUl9NUFRfVklS
VF9TVEFSVCkgIT0KQEAgLTcwNiwxMiArNzA2LDEyIEBAIHZvaWQgX19pbml0IHBhZ2luZ19pbml0
KHZvaWQpCiAKICAgICBsM19yb19tcHRfbWZuID0gbDRlX2dldF9tZm4oaWRsZV9wZ190YWJsZVts
NF90YWJsZV9vZmZzZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SElST19DT01QQVRfTVBUX1ZJUlRfU1RBUlQpXSk7Ci0gICAgbDNfcm9fbXB0ID0gbWFwX3hlbl9w
YWdldGFibGVfbmV3KGwzX3JvX21wdF9tZm4pOworICAgIGwzX3JvX21wdCA9IG1hcF94ZW5fcGFn
ZXRhYmxlKGwzX3JvX21wdF9tZm4pOwogCi0gICAgbDJfcm9fbXB0X21mbiA9IGFsbG9jX3hlbl9w
YWdldGFibGVfbmV3KCk7CisgICAgbDJfcm9fbXB0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGUo
KTsKICAgICBpZiAoIG1mbl9lcShsMl9yb19tcHRfbWZuLCBJTlZBTElEX01GTikgKQogICAgICAg
ICBnb3RvIG5vbWVtOwotICAgIGwyX3JvX21wdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMl9y
b19tcHRfbWZuKTsKKyAgICBsMl9yb19tcHQgPSBtYXBfeGVuX3BhZ2V0YWJsZShsMl9yb19tcHRf
bWZuKTsKICAgICBjb21wYXRfaWRsZV9wZ190YWJsZV9sMiA9IG1hcF9kb21haW5fcGFnZV9nbG9i
YWwobDJfcm9fbXB0X21mbik7CiAgICAgY2xlYXJfcGFnZShsMl9yb19tcHQpOwogICAgIGwzZV93
cml0ZSgmbDNfcm9fbXB0W2wzX3RhYmxlX29mZnNldChISVJPX0NPTVBBVF9NUFRfVklSVF9TVEFS
VCldLApAQCAtNzU3LDggKzc1Nyw4IEBAIHZvaWQgX19pbml0IHBhZ2luZ19pbml0KHZvaWQpCiAj
dW5kZWYgQ05UCiAjdW5kZWYgTUZOCiAKLSAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMl9y
b19tcHQpOwotICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwzX3JvX21wdCk7CisgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRShsMl9yb19tcHQpOworICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDNf
cm9fbXB0KTsKIAogICAgIG1hY2hpbmVfdG9fcGh5c19tYXBwaW5nX3ZhbGlkID0gMTsKIApAQCAt
ODE2LDEwICs4MTYsMTAgQEAgc3RhdGljIHZvaWQgY2xlYW51cF9mcmFtZV90YWJsZShzdHJ1Y3Qg
bWVtX2hvdGFkZF9pbmZvICppbmZvKQogCiAgICAgd2hpbGUgKHN2YSA8IGV2YSkKICAgICB7Ci0g
ICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgbDN0ID0gbWFwX3hl
bl9wYWdldGFibGUoCiAgICAgICAgICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3RhYmxlW2w0X3Rh
YmxlX29mZnNldChzdmEpXSkpOwogICAgICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KHN2
YSldOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM3QpOworICAgICAgICBVTk1B
UF9YRU5fUEFHRVRBQkxFKGwzdCk7CiAgICAgICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkg
JiBfUEFHRV9QUkVTRU5UKSB8fAogICAgICAgICAgICAgIChsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBf
UEFHRV9QU0UpICkKICAgICAgICAgewpAQCAtODI4LDkgKzgyOCw5IEBAIHN0YXRpYyB2b2lkIGNs
ZWFudXBfZnJhbWVfdGFibGUoc3RydWN0IG1lbV9ob3RhZGRfaW5mbyAqaW5mbykKICAgICAgICAg
ICAgIGNvbnRpbnVlOwogICAgICAgICB9CiAKLSAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAgICBsMnQgPSBtYXBfeGVuX3BhZ2V0YWJs
ZShsM2VfZ2V0X21mbihsM2UpKTsKICAgICAgICAgbDJlID0gbDJ0W2wyX3RhYmxlX29mZnNldChz
dmEpXTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDJ0KTsKKyAgICAgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAgICBBU1NFUlQobDJlX2dldF9mbGFncyhsMmUp
ICYgX1BBR0VfUFJFU0VOVCk7CiAKICAgICAgICAgaWYgKCAobDJlX2dldF9mbGFncyhsMmUpICYg
KF9QQUdFX1BSRVNFTlQgfCBfUEFHRV9QU0UpKSA9PQpAQCAtODQ4LDEwICs4NDgsMTAgQEAgc3Rh
dGljIHZvaWQgY2xlYW51cF9mcmFtZV90YWJsZShzdHJ1Y3QgbWVtX2hvdGFkZF9pbmZvICppbmZv
KQogCiAjaWZuZGVmIE5ERUJVRwogICAgICAgICB7Ci0gICAgICAgICAgICBsMV9wZ2VudHJ5X3Qg
KmwxdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsMmVfZ2V0X21mbihsMmUpKTsKKyAgICAgICAg
ICAgIGwxX3BnZW50cnlfdCAqbDF0ID0gbWFwX3hlbl9wYWdldGFibGUobDJlX2dldF9tZm4obDJl
KSk7CiAgICAgICAgICAgICBBU1NFUlQobDFlX2dldF9mbGFncyhsMXRbbDFfdGFibGVfb2Zmc2V0
KHN2YSldKSAmCiAgICAgICAgICAgICAgICAgICAgX1BBR0VfUFJFU0VOVCk7Ci0gICAgICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOworICAgICAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShsMXQpOwogICAgICAgICB9CiAjZW5kaWYKICAgICAgICAgIHN2YSA9IChzdmEgJiB+
KCgxVUwgPDwgUEFHRV9TSElGVCkgLSAxKSkgKwpAQCAtOTQyLDEwICs5NDIsMTAgQEAgdm9pZCBf
X2luaXQgc3ViYXJjaF9pbml0X21lbW9yeSh2b2lkKQogICAgIHsKICAgICAgICAgbiA9IEwyX1BB
R0VUQUJMRV9FTlRSSUVTICogTDFfUEFHRVRBQkxFX0VOVFJJRVM7CiAKLSAgICAgICAgbDN0ID0g
bWFwX3hlbl9wYWdldGFibGVfbmV3KAorICAgICAgICBsM3QgPSBtYXBfeGVuX3BhZ2V0YWJsZSgK
ICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKGlkbGVfcGdfdGFibGVbbDRfdGFibGVfb2Zmc2V0KHYp
XSkpOwogICAgICAgICBsM2UgPSBsM3RbbDNfdGFibGVfb2Zmc2V0KHYpXTsKLSAgICAgICAgVU5N
QVBfWEVOX1BBR0VUQUJMRV9ORVcobDN0KTsKKyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShs
M3QpOwogCiAgICAgICAgIGlmICggIShsM2VfZ2V0X2ZsYWdzKGwzZSkgJiBfUEFHRV9QUkVTRU5U
KSApCiAgICAgICAgICAgICBjb250aW51ZTsKQEAgLTk1Myw5ICs5NTMsOSBAQCB2b2lkIF9faW5p
dCBzdWJhcmNoX2luaXRfbWVtb3J5KHZvaWQpCiAgICAgICAgIHsKICAgICAgICAgICAgIG4gPSBM
MV9QQUdFVEFCTEVfRU5UUklFUzsKIAotICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAgICAgICAgbDJ0ID0gbWFwX3hlbl9wYWdl
dGFibGUobDNlX2dldF9tZm4obDNlKSk7CiAgICAgICAgICAgICBsMmUgPSBsMnRbbDJfdGFibGVf
b2Zmc2V0KHYpXTsKLSAgICAgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7Cisg
ICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAKICAgICAgICAgICAgIGlmICgg
IShsMmVfZ2V0X2ZsYWdzKGwyZSkgJiBfUEFHRV9QUkVTRU5UKSApCiAgICAgICAgICAgICAgICAg
Y29udGludWU7CkBAIC05NzUsMTcgKzk3NSwxNyBAQCB2b2lkIF9faW5pdCBzdWJhcmNoX2luaXRf
bWVtb3J5KHZvaWQpCiAgICAgICAgICAgdiAhPSBSRFdSX0NPTVBBVF9NUFRfVklSVF9FTkQ7CiAg
ICAgICAgICAgdiArPSAxIDw8IEwyX1BBR0VUQUJMRV9TSElGVCApCiAgICAgewotICAgICAgICBs
M3QgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXcoCisgICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRh
YmxlKAogICAgICAgICAgICAgbDRlX2dldF9tZm4oaWRsZV9wZ190YWJsZVtsNF90YWJsZV9vZmZz
ZXQodildKSk7CiAgICAgICAgIGwzZSA9IGwzdFtsM190YWJsZV9vZmZzZXQodildOwotICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsM3QpOworICAgICAgICBVTk1BUF9YRU5fUEFHRVRB
QkxFKGwzdCk7CiAKICAgICAgICAgaWYgKCAhKGwzZV9nZXRfZmxhZ3MobDNlKSAmIF9QQUdFX1BS
RVNFTlQpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgIGwydCA9IG1hcF94ZW5f
cGFnZXRhYmxlX25ldyhsM2VfZ2V0X21mbihsM2UpKTsKKyAgICAgICAgbDJ0ID0gbWFwX3hlbl9w
YWdldGFibGUobDNlX2dldF9tZm4obDNlKSk7CiAgICAgICAgIGwyZSA9IGwydFtsMl90YWJsZV9v
ZmZzZXQodildOwotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMnQpOworICAgICAg
ICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwydCk7CiAKICAgICAgICAgaWYgKCAhKGwyZV9nZXRfZmxh
Z3MobDJlKSAmIF9QQUdFX1BSRVNFTlQpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwpAQCAtMTAz
NiwxOCArMTAzNiwxOCBAQCBsb25nIHN1YmFyY2hfbWVtb3J5X29wKHVuc2lnbmVkIGxvbmcgY21k
LCBYRU5fR1VFU1RfSEFORExFX1BBUkFNKHZvaWQpIGFyZykKICAgICAgICAgICAgICAgKHYgPCAo
dW5zaWduZWQgbG9uZykobWFjaGluZV90b19waHlzX21hcHBpbmcgKyBtYXhfcGFnZSkpOwogICAg
ICAgICAgICAgICBpKyssIHYgKz0gMVVMIDw8IEwyX1BBR0VUQUJMRV9TSElGVCApCiAgICAgICAg
IHsKLSAgICAgICAgICAgIGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgICAg
IGwzdCA9IG1hcF94ZW5fcGFnZXRhYmxlKAogICAgICAgICAgICAgICAgIGw0ZV9nZXRfbWZuKGlk
bGVfcGdfdGFibGVbbDRfdGFibGVfb2Zmc2V0KHYpXSkpOwogICAgICAgICAgICAgbDNlID0gbDN0
W2wzX3RhYmxlX29mZnNldCh2KV07Ci0gICAgICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05F
VyhsM3QpOworICAgICAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShsM3QpOwogCiAgICAgICAg
ICAgICBpZiAoICEobDNlX2dldF9mbGFncyhsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAg
ICAgICAgICAgIG1mbiA9IGxhc3RfbWZuOwogICAgICAgICAgICAgZWxzZSBpZiAoICEobDNlX2dl
dF9mbGFncyhsM2UpICYgX1BBR0VfUFNFKSApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAg
ICAgbDJ0ID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKGwzZSkpOworICAgICAg
ICAgICAgICAgIGwydCA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzZV9nZXRfbWZuKGwzZSkpOwogICAg
ICAgICAgICAgICAgIGwyZSA9IGwydFtsMl90YWJsZV9vZmZzZXQodildOwotICAgICAgICAgICAg
ICAgIFVOTUFQX1hFTl9QQUdFVEFCTEVfTkVXKGwydCk7CisgICAgICAgICAgICAgICAgVU5NQVBf
WEVOX1BBR0VUQUJMRShsMnQpOwogICAgICAgICAgICAgICAgIGlmICggbDJlX2dldF9mbGFncyhs
MmUpICYgX1BBR0VfUFJFU0VOVCApCiAgICAgICAgICAgICAgICAgICAgIG1mbiA9IGwyZV9nZXRf
cGZuKGwyZSk7CiAgICAgICAgICAgICAgICAgZWxzZQpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9l
ZmkvYm9vdC5jIGIveGVuL2NvbW1vbi9lZmkvYm9vdC5jCmluZGV4IGY1NWQ2YTZkNzYuLmQ0NzA2
N2M5OTggMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vZWZpL2Jvb3QuYworKysgYi94ZW4vY29tbW9u
L2VmaS9ib290LmMKQEAgLTE0NDMsMjAgKzE0NDMsMjAgQEAgc3RhdGljIF9faW5pdCB2b2lkIGNv
cHlfbWFwcGluZyhsNF9wZ2VudHJ5X3QgKmw0LAogICAgICAgICB7CiAgICAgICAgICAgICBtZm5f
dCBsM3RfbWZuOwogCi0gICAgICAgICAgICBsM3RfbWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9u
ZXcoKTsKKyAgICAgICAgICAgIGwzdF9tZm4gPSBhbGxvY194ZW5fcGFnZXRhYmxlKCk7CiAgICAg
ICAgICAgICBCVUdfT04obWZuX2VxKGwzdF9tZm4sIElOVkFMSURfTUZOKSk7Ci0gICAgICAgICAg
ICBsM2RzdCA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsM3RfbWZuKTsKKyAgICAgICAgICAgIGwz
ZHN0ID0gbWFwX3hlbl9wYWdldGFibGUobDN0X21mbik7CiAgICAgICAgICAgICBjbGVhcl9wYWdl
KGwzZHN0KTsKICAgICAgICAgICAgIGw0W2w0X3RhYmxlX29mZnNldChtZm4gPDwgUEFHRV9TSElG
VCldID0KICAgICAgICAgICAgICAgICBsNGVfZnJvbV9tZm4obDN0X21mbiwgX19QQUdFX0hZUEVS
VklTT1IpOwogICAgICAgICB9CiAgICAgICAgIGVsc2UKLSAgICAgICAgICAgIGwzZHN0ID0gbWFw
X3hlbl9wYWdldGFibGVfbmV3KGw0ZV9nZXRfbWZuKGw0ZSkpOwotICAgICAgICBsM3NyYyA9IG1h
cF94ZW5fcGFnZXRhYmxlX25ldygKKyAgICAgICAgICAgIGwzZHN0ID0gbWFwX3hlbl9wYWdldGFi
bGUobDRlX2dldF9tZm4obDRlKSk7CisgICAgICAgIGwzc3JjID0gbWFwX3hlbl9wYWdldGFibGUo
CiAgICAgICAgICAgICBsNGVfZ2V0X21mbihpZGxlX3BnX3RhYmxlW2w0X3RhYmxlX29mZnNldCh2
YSldKSk7CiAgICAgICAgIGwzZHN0W2wzX3RhYmxlX29mZnNldChtZm4gPDwgUEFHRV9TSElGVCld
ID0gbDNzcmNbbDNfdGFibGVfb2Zmc2V0KHZhKV07Ci0gICAgICAgIFVOTUFQX1hFTl9QQUdFVEFC
TEVfTkVXKGwzc3JjKTsKLSAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcobDNkc3QpOwor
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFKGwzc3JjKTsKKyAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShsM2RzdCk7CiAgICAgfQogfQogCkBAIC0xNjA0LDkgKzE2MDQsOSBAQCB2b2lkIF9f
aW5pdCBlZmlfaW5pdF9tZW1vcnkodm9pZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG1kZXNjX3ZlciwgZWZpX21lbW1hcCk7CiAjZWxzZQogICAgIC8qIFNldCB1cCAxOjEgcGFn
ZSB0YWJsZXMgdG8gZG8gcnVudGltZSBjYWxscyBpbiAicGh5c2ljYWwiIG1vZGUuICovCi0gICAg
ZWZpX2w0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgZWZpX2w0X21mbiA9
IGFsbG9jX3hlbl9wYWdldGFibGUoKTsKICAgICBCVUdfT04obWZuX2VxKGVmaV9sNF9tZm4sIElO
VkFMSURfTUZOKSk7Ci0gICAgZWZpX2w0X3BndGFibGUgPSBtYXBfeGVuX3BhZ2V0YWJsZV9uZXco
ZWZpX2w0X21mbik7CisgICAgZWZpX2w0X3BndGFibGUgPSBtYXBfeGVuX3BhZ2V0YWJsZShlZmlf
bDRfbWZuKTsKICAgICBjbGVhcl9wYWdlKGVmaV9sNF9wZ3RhYmxlKTsKIAogICAgIGNvcHlfbWFw
cGluZyhlZmlfbDRfcGd0YWJsZSwgMCwgbWF4X3BhZ2UsIHJhbV9yYW5nZV92YWxpZCk7CkBAIC0x
NjQxLDMxICsxNjQxLDMxIEBAIHZvaWQgX19pbml0IGVmaV9pbml0X21lbW9yeSh2b2lkKQogICAg
ICAgICB7CiAgICAgICAgICAgICBtZm5fdCBsM3RfbWZuOwogCi0gICAgICAgICAgICBsM3RfbWZu
ID0gYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgIGwzdF9tZm4gPSBhbGxv
Y194ZW5fcGFnZXRhYmxlKCk7CiAgICAgICAgICAgICBCVUdfT04obWZuX2VxKGwzdF9tZm4sIElO
VkFMSURfTUZOKSk7Ci0gICAgICAgICAgICBwbDNlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwz
dF9tZm4pOworICAgICAgICAgICAgcGwzZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwzdF9tZm4pOwog
ICAgICAgICAgICAgY2xlYXJfcGFnZShwbDNlKTsKICAgICAgICAgICAgIGVmaV9sNF9wZ3RhYmxl
W2w0X3RhYmxlX29mZnNldChhZGRyKV0gPQogICAgICAgICAgICAgICAgIGw0ZV9mcm9tX21mbihs
M3RfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUik7CiAgICAgICAgIH0KICAgICAgICAgZWxzZQotICAg
ICAgICAgICAgcGwzZSA9IG1hcF94ZW5fcGFnZXRhYmxlX25ldyhsNGVfZ2V0X21mbihsNGUpKTsK
KyAgICAgICAgICAgIHBsM2UgPSBtYXBfeGVuX3BhZ2V0YWJsZShsNGVfZ2V0X21mbihsNGUpKTsK
ICAgICAgICAgcGwzZSArPSBsM190YWJsZV9vZmZzZXQoYWRkcik7CiAKICAgICAgICAgaWYgKCAh
KGwzZV9nZXRfZmxhZ3MoKnBsM2UpICYgX1BBR0VfUFJFU0VOVCkgKQogICAgICAgICB7CiAgICAg
ICAgICAgICBtZm5fdCBsMnRfbWZuOwogCi0gICAgICAgICAgICBsMnRfbWZuID0gYWxsb2NfeGVu
X3BhZ2V0YWJsZV9uZXcoKTsKKyAgICAgICAgICAgIGwydF9tZm4gPSBhbGxvY194ZW5fcGFnZXRh
YmxlKCk7CiAgICAgICAgICAgICBCVUdfT04obWZuX2VxKGwydF9tZm4sIElOVkFMSURfTUZOKSk7
Ci0gICAgICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwydF9tZm4pOworICAg
ICAgICAgICAgcGwyZSA9IG1hcF94ZW5fcGFnZXRhYmxlKGwydF9tZm4pOwogICAgICAgICAgICAg
Y2xlYXJfcGFnZShwbDJlKTsKICAgICAgICAgICAgICpwbDNlID0gbDNlX2Zyb21fbWZuKGwydF9t
Zm4sIF9fUEFHRV9IWVBFUlZJU09SKTsKICAgICAgICAgfQogICAgICAgICBlbHNlCiAgICAgICAg
IHsKICAgICAgICAgICAgIEJVR19PTihsM2VfZ2V0X2ZsYWdzKCpwbDNlKSAmIF9QQUdFX1BTRSk7
Ci0gICAgICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGVfbmV3KGwzZV9nZXRfbWZuKCpw
bDNlKSk7CisgICAgICAgICAgICBwbDJlID0gbWFwX3hlbl9wYWdldGFibGUobDNlX2dldF9tZm4o
KnBsM2UpKTsKICAgICAgICAgfQogICAgICAgICBwbDJlICs9IGwyX3RhYmxlX29mZnNldChhZGRy
KTsKIApAQCAtMTY3MywxNiArMTY3MywxNiBAQCB2b2lkIF9faW5pdCBlZmlfaW5pdF9tZW1vcnko
dm9pZCkKICAgICAgICAgewogICAgICAgICAgICAgbWZuX3QgbDF0X21mbjsKIAotICAgICAgICAg
ICAgbDF0X21mbiA9IGFsbG9jX3hlbl9wYWdldGFibGVfbmV3KCk7CisgICAgICAgICAgICBsMXRf
bWZuID0gYWxsb2NfeGVuX3BhZ2V0YWJsZSgpOwogICAgICAgICAgICAgQlVHX09OKG1mbl9lcShs
MXRfbWZuLCBJTlZBTElEX01GTikpOwotICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFi
bGVfbmV3KGwxdF9tZm4pOworICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGUobDF0
X21mbik7CiAgICAgICAgICAgICBjbGVhcl9wYWdlKGwxdCk7CiAgICAgICAgICAgICAqcGwyZSA9
IGwyZV9mcm9tX21mbihsMXRfbWZuLCBfX1BBR0VfSFlQRVJWSVNPUik7CiAgICAgICAgIH0KICAg
ICAgICAgZWxzZQogICAgICAgICB7CiAgICAgICAgICAgICBCVUdfT04obDJlX2dldF9mbGFncygq
cGwyZSkgJiBfUEFHRV9QU0UpOwotICAgICAgICAgICAgbDF0ID0gbWFwX3hlbl9wYWdldGFibGVf
bmV3KGwyZV9nZXRfbWZuKCpwbDJlKSk7CisgICAgICAgICAgICBsMXQgPSBtYXBfeGVuX3BhZ2V0
YWJsZShsMmVfZ2V0X21mbigqcGwyZSkpOwogICAgICAgICB9CiAgICAgICAgIGZvciAoIGkgPSBs
MV90YWJsZV9vZmZzZXQoYWRkcik7CiAgICAgICAgICAgICAgIGkgPCBMMV9QQUdFVEFCTEVfRU5U
UklFUyAmJiBleHRyYS0+c21mbiA8IGV4dHJhLT5lbWZuOwpAQCAtMTY5NSw5ICsxNjk1LDkgQEAg
dm9pZCBfX2luaXQgZWZpX2luaXRfbWVtb3J5KHZvaWQpCiAgICAgICAgICAgICB4ZnJlZShleHRy
YSk7CiAgICAgICAgIH0KIAotICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhsMXQpOwot
ICAgICAgICBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwbDJlKTsKLSAgICAgICAgVU5NQVBfWEVO
X1BBR0VUQUJMRV9ORVcocGwzZSk7CisgICAgICAgIFVOTUFQX1hFTl9QQUdFVEFCTEUobDF0KTsK
KyAgICAgICAgVU5NQVBfWEVOX1BBR0VUQUJMRShwbDJlKTsKKyAgICAgICAgVU5NQVBfWEVOX1BB
R0VUQUJMRShwbDNlKTsKICAgICB9CiAKICAgICAvKiBJbnNlcnQgWGVuIG1hcHBpbmdzLiAqLwpA
QCAtMTcwNiw3ICsxNzA2LDcgQEAgdm9pZCBfX2luaXQgZWZpX2luaXRfbWVtb3J5KHZvaWQpCiAg
ICAgICAgIGVmaV9sNF9wZ3RhYmxlW2ldID0gaWRsZV9wZ190YWJsZVtpXTsKICNlbmRpZgogCi0g
ICAgVU5NQVBfWEVOX1BBR0VUQUJMRV9ORVcoZWZpX2w0X3BndGFibGUpOworICAgIFVOTUFQX1hF
Tl9QQUdFVEFCTEUoZWZpX2w0X3BndGFibGUpOwogfQogI2VuZGlmCiAKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvbW0uaCBiL3hlbi9pbmNsdWRlL2FzbS14ODYvbW0uaAppbmRleCA0
ZmI3OWFiOGYwLi5hNGIzYzliN2FmIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L21t
LmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9tbS5oCkBAIC02MzEsMTUgKzYzMSwxNSBAQCBp
bnQgYXJjaF9hY3F1aXJlX3Jlc291cmNlKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGludCB0
eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbnJfZnJhbWVzLCB4
ZW5fcGZuX3QgbWZuX2xpc3RbXSk7CiAKIC8qIEFsbG9jYXRvciBmdW5jdGlvbnMgZm9yIFhlbiBw
YWdldGFibGVzLiAqLwotbWZuX3QgYWxsb2NfeGVuX3BhZ2V0YWJsZV9uZXcodm9pZCk7Ci12b2lk
ICptYXBfeGVuX3BhZ2V0YWJsZV9uZXcobWZuX3QgbWZuKTsKLXZvaWQgdW5tYXBfeGVuX3BhZ2V0
YWJsZV9uZXcodm9pZCAqdik7Ci12b2lkIGZyZWVfeGVuX3BhZ2V0YWJsZV9uZXcobWZuX3QgbWZu
KTsKLQotI2RlZmluZSBVTk1BUF9YRU5fUEFHRVRBQkxFX05FVyhwdHIpICAgIFwKLSAgICBkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgIHVubWFwX3hlbl9wYWdl
dGFibGVfbmV3KChwdHIpKTsgXAotICAgICAgICAocHRyKSA9IE5VTEw7ICAgICAgICAgICAgICAg
ICAgIFwKK21mbl90IGFsbG9jX3hlbl9wYWdldGFibGUodm9pZCk7Cit2b2lkICptYXBfeGVuX3Bh
Z2V0YWJsZShtZm5fdCBtZm4pOwordm9pZCB1bm1hcF94ZW5fcGFnZXRhYmxlKHZvaWQgKnYpOwor
dm9pZCBmcmVlX3hlbl9wYWdldGFibGUobWZuX3QgbWZuKTsKKworI2RlZmluZSBVTk1BUF9YRU5f
UEFHRVRBQkxFKHB0cikgICAgXAorICAgIGRvIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAorICAgICAgICB1bm1hcF94ZW5fcGFnZXRhYmxlKChwdHIpKTsgXAorICAgICAgICAocHRyKSA9
IE5VTEw7ICAgICAgICAgICAgICAgXAogICAgIH0gd2hpbGUgKDApCiAKIGwxX3BnZW50cnlfdCAq
dmlydF90b194ZW5fbDFlKHVuc2lnbmVkIGxvbmcgdik7Ci0tIAoyLjE3LjEKCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBs
aXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2pl
Y3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id D078B140E84
	for <lists+xen-devel@lfdr.de>; Fri, 17 Jan 2020 17:01:45 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1isU0x-0002n0-79; Fri, 17 Jan 2020 15:58:27 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=V5CB=3G=citrix.com=george.dunlap@srs-us1.protection.inumbo.net>)
 id 1isU0v-0002m3-C0
 for xen-devel@lists.xenproject.org; Fri, 17 Jan 2020 15:58:25 +0000
X-Inumbo-ID: 21a6c75e-3942-11ea-9fd7-bc764e2007e4
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 21a6c75e-3942-11ea-9fd7-bc764e2007e4;
 Fri, 17 Jan 2020 15:57:58 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
 d=citrix.com; s=securemail; t=1579276678;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=DqzxPBGLXlAPOevm9+DmIQN1bfiqbkyVF8GZfq2FmZQ=;
 b=BbDMVbOLfomU11JNSTZSnyEYc4FqAb2RcRs/AqOlDNDNpj48q90oWcxH
 axDQKf1UzBsWAloiN8ANLYqbJsBp1UIUXoYFEhBSZ/cAuWz62l79+n8zh
 KHRrzqRbEURnGvNb61VHWerVkzyWX4XoyuXComkGKs5Y2nScdaoLm1OUC o=;
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=george.dunlap@citrix.com;
 spf=Pass smtp.mailfrom=George.Dunlap@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 george.dunlap@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="george.dunlap@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa4.hc3370-68.iphmx.com: domain of
 George.Dunlap@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="George.Dunlap@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83
 ip4:168.245.78.127 ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="George.Dunlap@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: zY3jDXenYhxcL+uo6U+PjfFxvRHKzf5eTKgBR+NV+EwPeEgudpsFz69YO0wuaaunEgFMPeVolB
 OOLPQTFF8JiHCUZKl9xkV41smQKOhu//IsGEItSRS++ALHwyIx0QNXjCim98qIcnKTN7uBRom5
 9Gupgjdodf8SMB6jG+UX388v1arz+b7ule+9y3aCxOo1aAVnSLAO48WcziHgMWE9x8FqTZtzv9
 uNS6ZJGDmOQJgepHqi/X7ushnv7V0h1ZPtgUAnbZewikI72LM/zyLzMQXq5eFegNv7SDqW0J2J
 u2c=
X-SBRS: 2.7
X-MesageID: 11674372
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.70,330,1574139600"; d="scan'208";a="11674372"
From: George Dunlap <george.dunlap@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Fri, 17 Jan 2020 15:57:29 +0000
Message-ID: <20200117155734.1067550-3-george.dunlap@citrix.com>
X-Mailer: git-send-email 2.24.1
In-Reply-To: <20200117155734.1067550-1-george.dunlap@citrix.com>
References: <20200117155734.1067550-1-george.dunlap@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 3/8] go/xenlight: More informative error
 messages
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 George Dunlap <george.dunlap@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SWYgYW4gZXJyb3IgaXMgZW5jb3VudGVyZWQgZGVlcCBpbiBhIGNvbXBsaWNhdGVkIGRhdGEgc3Ry
dWN0dXJlLCBpdCdzCm9mdGVuIGRpZmZpY3VsdCB0byB0ZWxsIHdoZXJlIHRoZSBlcnJvciBhY3R1
YWxseSBpcy4gIE1ha2UgdGhlIGVycm9yCm1lc3NhZ2UgZnJvbSB0aGUgZ2VuZXJhdGVkIHRvQygp
IGFuZCBmcm9tQygpIHN0cnVjdHVyZXMgbW9yZQppbmZvcm1hdGl2ZSBieSB0YWdnaW5nIHdoaWNo
IGZpZWxkIGJlaW5nIGNvbnZlcnRlZCBlbmNvdW50ZXJlZCB0aGUKZXJyb3IuICBUaGlzIHdpbGwg
aGF2ZSB0aGUgZWZmZWN0IG9mIGdpdmluZyBhICJzdGFjayB0cmFjZSIgb2YgdGhlCmZhaWx1cmUg
aW5zaWRlIGEgbmVzdGVkIGRhdGEgc3RydWN0dXJlLgoKTkIgdGhhdCBteSB2ZXJzaW9uIG9mIHB5
dGhvbiBpbnNpc3RzIG9uIHJlb3JkZXJpbmcgYSBjb3VwbGUgb2Ygc3dpdGNoCnN0YXRlbWVudHMg
Zm9yIHNvbWUgcmVhc29uOyBJbiBvdGhlciBwYXRjaGVzIEkndmUgcmV2ZXJ0ZWQgdGhvc2UKY2hh
bmdlcywgYnV0IGluIHRoaXMgY2FzZSBpdCdzIG1vcmUgZGlmZmljdWx0IGJlY2F1c2UgdGhleSBp
bnRlcmFjdAp3aXRoIGFjdHVhbCBjb2RlIGNoYW5nZXMuICBJJ2xsIGxlYXZlIHRoaXMgaGVyZSBm
b3Igbm93LCBhcyB3ZSdyZQpnb2luZyB0byByZW1vdmUgaGVscGVycy5nZW4uZ28gZnJvbSBiZWlu
ZyB0cmFja2VkIGJ5IGdpdCBhdCBzb21lIHBvaW50CmluIHRoZSBuZWFyIGZ1dHVyZSBhbnl3YXku
CgpTaWduZWQtb2ZmLWJ5OiBHZW9yZ2UgRHVubGFwIDxnZW9yZ2UuZHVubGFwQGNpdHJpeC5jb20+
Ci0tLQp2MjoKLSBLZWVwIGVycm9yIG1lc3NhZ2VzIGxvd2VyIGNhc2UKLSBBY3R1YWxseSBpbXBs
ZW1lbnQgLnRvQyBjaGFuZ2VzCgpDQzogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2Vj
LmNvbT4KLS0tCiB0b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSAgfCAgMTAgKy0K
IHRvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbyB8IDUzMCArKysrKysrKysrKysr
LS0tLS0tLS0tLS0tLS0KIDIgZmlsZXMgY2hhbmdlZCwgMjcwIGluc2VydGlvbnMoKyksIDI3MCBk
ZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBl
cy5weSBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CmluZGV4IGFkMmM1NzNk
YTkuLjE3YjBjYTAwYmQgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5
cGVzLnB5CisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CkBAIC0zMTQs
NyArMzE0LDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19jb252ZXJ0X2Zyb21fQyh0eSA9IE5vbmUs
IG91dGVyX25hbWUgPSBOb25lLCBjdmFybmFtZSA9IE5vbmUKICAgICAgICAgIyBJZiB0aGUgdHlw
ZSBpcyBub3QgY2FzdGFibGUsIHdlIG5lZWQgdG8gY2FsbCBpdHMgZnJvbUMKICAgICAgICAgIyBm
dW5jdGlvbi4KICAgICAgICAgcyArPSAnaWYgZXJyIDo9IHgue30uZnJvbUMoJnt9Lnt9KTsnLmZv
cm1hdChnb25hbWUsY3Zhcm5hbWUsY25hbWUpCi0gICAgICAgIHMgKz0gJ2VyciAhPSBuaWwge1xu
IHJldHVybiBlcnIgXG59XG4nCisgICAgICAgIHMgKz0gJ2VyciAhPSBuaWwge3tcbnJldHVybiBm
bXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHt9OiAldiIsIGVycikgXG59fVxuJy5mb3JtYXQo
Z29uYW1lKQogCiAgICAgZWxpZiBnb3R5cGVuYW1lID09ICdzdHJpbmcnOgogICAgICAgICAjIFVz
ZSB0aGUgY2dvIGhlbHBlciBmb3IgY29udmVydGluZyBDIHN0cmluZ3MuCkBAIC0zODksNyArMzg5
LDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ191bmlvbl9mcm9tX0ModHkgPSBOb25lLCB1bmlvbl9u
YW1lID0gJycsIHN0cnVjdF9uYW1lID0gJycpOgogCiAgICAgICAgIHMgKz0gJ3ZhciB7fSB7fVxu
Jy5mb3JtYXQoZ29uYW1lLCBnb3R5cGUpCiAgICAgICAgIHMgKz0gJ2lmIGVyciA6PSB7fS5mcm9t
Qyh4Yyk7Jy5mb3JtYXQoZ29uYW1lKQotICAgICAgICBzICs9ICdlcnIgIT0gbmlsIHtcbiByZXR1
cm4gZXJyIFxufVxuJworICAgICAgICBzICs9ICdlcnIgIT0gbmlsIHt7XG4gcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQge306ICV2IiwgZXJyKSBcbn19XG4nLmZvcm1hdChnb25h
bWUpCiAKICAgICAgICAgZmllbGRfbmFtZSA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSgne31f
dW5pb24nLmZvcm1hdChrZXluYW1lKSkKICAgICAgICAgcyArPSAneC57fSA9IHt9XG4nLmZvcm1h
dChmaWVsZF9uYW1lLCBnb25hbWUpCkBAIC00MzIsNyArNDMyLDcgQEAgZGVmIHhlbmxpZ2h0X2dv
bGFuZ19hcnJheV9mcm9tX0ModHkgPSBOb25lKToKICAgICAgICAgcyArPSAneC57fVtpXSA9IHt9
KHYpXG4nLmZvcm1hdChnb25hbWUsIGdvdHlwZW5hbWUpCiAgICAgZWxzZToKICAgICAgICAgcyAr
PSAnaWYgZXJyIDo9IHgue31baV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHt7XG4nLmZvcm1hdChn
b25hbWUpCi0gICAgICAgIHMgKz0gJ3JldHVybiBlcnIgfVxuJworICAgICAgICBzICs9ICdyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCB7fTogJXYiLCBlcnIpIH19XG4nLmZvcm1h
dChnb25hbWUpCiAKICAgICBzICs9ICd9XG59XG4nCiAKQEAgLTUxMyw3ICs1MTMsNyBAQCBkZWYg
eGVubGlnaHRfZ29sYW5nX2NvbnZlcnRfdG9fQyh0eSA9IE5vbmUsIG91dGVyX25hbWUgPSBOb25l
LAogICAgIGlmIG5vdCBpc19jYXN0YWJsZToKICAgICAgICAgcyArPSAnaWYgZXJyIDo9IHt9Lnt9
LnRvQygme30ue30pOyBlcnIgIT0gbmlsIHt7XG4nLmZvcm1hdChnb3Zhcm5hbWUsZ29uYW1lLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGN2YXJuYW1lLGNuYW1lKQotICAgICAgICBzICs9ICdyZXR1cm4gZXJyXG59XG4n
CisgICAgICAgIHMgKz0gJ3JldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHt9OiAl
diIsIGVycikgXG59fVxuJy5mb3JtYXQoZ29uYW1lKQogCiAgICAgZWxpZiBnb3R5cGVuYW1lID09
ICdzdHJpbmcnOgogICAgICAgICAjIFVzZSB0aGUgY2dvIGhlbHBlciBmb3IgY29udmVydGluZyBD
IHN0cmluZ3MuCkBAIC02MTUsNyArNjE1LDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19hcnJheV90
b19DKHR5ID0gTm9uZSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29sZW52YXIsZ29sZW52YXIpCiAgICAg
cyArPSAnZm9yIGksdiA6PSByYW5nZSB4Lnt9IHt7XG4nLmZvcm1hdChnb25hbWUpCiAgICAgcyAr
PSAnaWYgZXJyIDo9IHYudG9DKCZje31baV0pOyBlcnIgIT0gbmlsIHt7XG4nLmZvcm1hdChnb25h
bWUpCi0gICAgcyArPSAncmV0dXJuIGVyclxuJworICAgIHMgKz0gJ3JldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIHt9OiAldiIsIGVycikgXG4nLmZvcm1hdChnb25hbWUpCiAgICAg
cyArPSAnfVxufVxufVxuJwogCiAgICAgcmV0dXJuIHMKZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFu
Zy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJz
Lmdlbi5nbwppbmRleCA4ODk4MDdkOTI4Li4wNzhjMzdmMWM4IDEwMDY0NAotLS0gYS90b29scy9n
b2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0
L2hlbHBlcnMuZ2VuLmdvCkBAIC05MiwxMyArOTIsMTMgQEAgZnVuYyAoeCAqVmdhSW50ZXJmYWNl
SW5mbykgdG9DKHhjICpDLmxpYnhsX3ZnYV9pbnRlcmZhY2VfaW5mbykgKGVyciBlcnJvcikgewog
CiBmdW5jICh4ICpWbmNJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bmNfaW5mbykgZXJyb3Igewog
CWlmIGVyciA6PSB4LkVuYWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7Ci0JCXJl
dHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRW5hYmxlOiAl
diIsIGVycikKIAl9CiAJeC5MaXN0ZW4gPSBDLkdvU3RyaW5nKHhjLmxpc3RlbikKIAl4LlBhc3N3
ZCA9IEMuR29TdHJpbmcoeGMucGFzc3dkKQogCXguRGlzcGxheSA9IGludCh4Yy5kaXNwbGF5KQog
CWlmIGVyciA6PSB4LkZpbmR1bnVzZWQuZnJvbUMoJnhjLmZpbmR1bnVzZWQpOyBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBG
aW5kdW51c2VkOiAldiIsIGVycikKIAl9CiAKIAlyZXR1cm4gbmlsCkBAIC0xMTIsNyArMTEyLDcg
QEAgZnVuYyAoeCAqVm5jSW5mbykgdG9DKHhjICpDLmxpYnhsX3ZuY19pbmZvKSAoZXJyIGVycm9y
KSB7CiAJfSgpCiAKIAlpZiBlcnIgOj0geC5FbmFibGUudG9DKCZ4Yy5lbmFibGUpOyBlcnIgIT0g
bmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCBFbmFibGU6ICV2IiwgZXJyKQogCX0KIAlpZiB4Lkxpc3RlbiAhPSAiIiB7CiAJCXhjLmxpc3Rl
biA9IEMuQ1N0cmluZyh4Lkxpc3RlbikKQEAgLTEyMiw3ICsxMjIsNyBAQCBmdW5jICh4ICpWbmNJ
bmZvKSB0b0MoeGMgKkMubGlieGxfdm5jX2luZm8pIChlcnIgZXJyb3IpIHsKIAl9CiAJeGMuZGlz
cGxheSA9IEMuaW50KHguRGlzcGxheSkKIAlpZiBlcnIgOj0geC5GaW5kdW51c2VkLnRvQygmeGMu
ZmluZHVudXNlZCk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJy
b3JmKCJjb252ZXJ0aW5nIGZpZWxkIEZpbmR1bnVzZWQ6ICV2IiwgZXJyKQogCX0KIAogCXJldHVy
biBuaWwKQEAgLTEzMCwyMyArMTMwLDIzIEBAIGZ1bmMgKHggKlZuY0luZm8pIHRvQyh4YyAqQy5s
aWJ4bF92bmNfaW5mbykgKGVyciBlcnJvcikgewogCiBmdW5jICh4ICpTcGljZUluZm8pIGZyb21D
KHhjICpDLmxpYnhsX3NwaWNlX2luZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJv
bUMoJnhjLmVuYWJsZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEVuYWJsZTogJXYiLCBlcnIpCiAJfQogCXguUG9ydCA9
IGludCh4Yy5wb3J0KQogCXguVGxzUG9ydCA9IGludCh4Yy50bHNfcG9ydCkKIAl4Lkhvc3QgPSBD
LkdvU3RyaW5nKHhjLmhvc3QpCiAJaWYgZXJyIDo9IHguRGlzYWJsZVRpY2tldGluZy5mcm9tQygm
eGMuZGlzYWJsZV90aWNrZXRpbmcpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBEaXNhYmxlVGlja2V0aW5nOiAldiIsIGVy
cikKIAl9CiAJeC5QYXNzd2QgPSBDLkdvU3RyaW5nKHhjLnBhc3N3ZCkKIAlpZiBlcnIgOj0geC5B
Z2VudE1vdXNlLmZyb21DKCZ4Yy5hZ2VudF9tb3VzZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4g
ZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEFnZW50TW91c2U6ICV2
IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5WZGFnZW50LmZyb21DKCZ4Yy52ZGFnZW50KTsgZXJy
ICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgVmRhZ2VudDogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LkNsaXBib2FyZFNoYXJp
bmcuZnJvbUMoJnhjLmNsaXBib2FyZF9zaGFyaW5nKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBl
cnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ2xpcGJvYXJkU2hhcmlu
ZzogJXYiLCBlcnIpCiAJfQogCXguVXNicmVkaXJlY3Rpb24gPSBpbnQoeGMudXNicmVkaXJlY3Rp
b24pCiAJeC5JbWFnZUNvbXByZXNzaW9uID0gQy5Hb1N0cmluZyh4Yy5pbWFnZV9jb21wcmVzc2lv
bikKQEAgLTE2Myw3ICsxNjMsNyBAQCBmdW5jICh4ICpTcGljZUluZm8pIHRvQyh4YyAqQy5saWJ4
bF9zcGljZV9pbmZvKSAoZXJyIGVycm9yKSB7CiAJfSgpCiAKIAlpZiBlcnIgOj0geC5FbmFibGUu
dG9DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10
LkVycm9yZigiY29udmVydGluZyBmaWVsZCBFbmFibGU6ICV2IiwgZXJyKQogCX0KIAl4Yy5wb3J0
ID0gQy5pbnQoeC5Qb3J0KQogCXhjLnRsc19wb3J0ID0gQy5pbnQoeC5UbHNQb3J0KQpAQCAtMTcx
LDE5ICsxNzEsMTkgQEAgZnVuYyAoeCAqU3BpY2VJbmZvKSB0b0MoeGMgKkMubGlieGxfc3BpY2Vf
aW5mbykgKGVyciBlcnJvcikgewogCQl4Yy5ob3N0ID0gQy5DU3RyaW5nKHguSG9zdCkKIAl9CiAJ
aWYgZXJyIDo9IHguRGlzYWJsZVRpY2tldGluZy50b0MoJnhjLmRpc2FibGVfdGlja2V0aW5nKTsg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgRGlzYWJsZVRpY2tldGluZzogJXYiLCBlcnIpCiAJfQogCWlmIHguUGFzc3dkICE9
ICIiIHsKIAkJeGMucGFzc3dkID0gQy5DU3RyaW5nKHguUGFzc3dkKQogCX0KIAlpZiBlcnIgOj0g
eC5BZ2VudE1vdXNlLnRvQygmeGMuYWdlbnRfbW91c2UpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJu
IGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBBZ2VudE1vdXNlOiAl
diIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguVmRhZ2VudC50b0MoJnhjLnZkYWdlbnQpOyBlcnIg
IT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBm
aWVsZCBWZGFnZW50OiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQ2xpcGJvYXJkU2hhcmlu
Zy50b0MoJnhjLmNsaXBib2FyZF9zaGFyaW5nKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIK
KwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ2xpcGJvYXJkU2hhcmluZzog
JXYiLCBlcnIpCiAJfQogCXhjLnVzYnJlZGlyZWN0aW9uID0gQy5pbnQoeC5Vc2JyZWRpcmVjdGlv
bikKIAlpZiB4LkltYWdlQ29tcHJlc3Npb24gIT0gIiIgewpAQCAtMTk4LDEwICsxOTgsMTAgQEAg
ZnVuYyAoeCAqU3BpY2VJbmZvKSB0b0MoeGMgKkMubGlieGxfc3BpY2VfaW5mbykgKGVyciBlcnJv
cikgewogCiBmdW5jICh4ICpTZGxJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zZGxfaW5mbykgZXJy
b3IgewogCWlmIGVyciA6PSB4LkVuYWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7
Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRW5h
YmxlOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguT3BlbmdsLmZyb21DKCZ4Yy5vcGVuZ2wp
OyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVy
dGluZyBmaWVsZCBPcGVuZ2w6ICV2IiwgZXJyKQogCX0KIAl4LkRpc3BsYXkgPSBDLkdvU3RyaW5n
KHhjLmRpc3BsYXkpCiAJeC5YYXV0aG9yaXR5ID0gQy5Hb1N0cmluZyh4Yy54YXV0aG9yaXR5KQpA
QCAtMjE3LDEwICsyMTcsMTAgQEAgZnVuYyAoeCAqU2RsSW5mbykgdG9DKHhjICpDLmxpYnhsX3Nk
bF9pbmZvKSAoZXJyIGVycm9yKSB7CiAJfSgpCiAKIAlpZiBlcnIgOj0geC5FbmFibGUudG9DKCZ4
Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9y
ZigiY29udmVydGluZyBmaWVsZCBFbmFibGU6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5P
cGVuZ2wudG9DKCZ4Yy5vcGVuZ2wpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBPcGVuZ2w6ICV2IiwgZXJyKQogCX0KIAlp
ZiB4LkRpc3BsYXkgIT0gIiIgewogCQl4Yy5kaXNwbGF5ID0gQy5DU3RyaW5nKHguRGlzcGxheSkK
QEAgLTIzNCw3ICsyMzQsNyBAQCBmdW5jICh4ICpTZGxJbmZvKSB0b0MoeGMgKkMubGlieGxfc2Rs
X2luZm8pIChlcnIgZXJyb3IpIHsKIAogZnVuYyAoeCAqRG9taW5mbykgZnJvbUMoeGMgKkMubGli
eGxfZG9taW5mbykgZXJyb3IgewogCWlmIGVyciA6PSB4LlV1aWQuZnJvbUMoJnhjLnV1aWQpOyBl
cnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBVdWlkOiAldiIsIGVycikKIAl9CiAJeC5Eb21pZCA9IERvbWlkKHhjLmRvbWlkKQog
CXguU3NpZHJlZiA9IHVpbnQzMih4Yy5zc2lkcmVmKQpAQCAtMjY4LDcgKzI2OCw3IEBAIGZ1bmMg
KHggKkRvbWluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21pbmZvKSAoZXJyIGVycm9yKSB7CiAJfSgp
CiAKIAlpZiBlcnIgOj0geC5VdWlkLnRvQygmeGMudXVpZCk7IGVyciAhPSBuaWwgewotCQlyZXR1
cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFV1aWQ6ICV2Iiwg
ZXJyKQogCX0KIAl4Yy5kb21pZCA9IEMubGlieGxfZG9taWQoeC5Eb21pZCkKIAl4Yy5zc2lkcmVm
ID0gQy51aW50MzJfdCh4LlNzaWRyZWYpCkBAIC0zMDIsNyArMzAyLDcgQEAgZnVuYyAoeCAqQ3B1
cG9vbGluZm8pIGZyb21DKHhjICpDLmxpYnhsX2NwdXBvb2xpbmZvKSBlcnJvciB7CiAJeC5TY2hl
ZCA9IFNjaGVkdWxlcih4Yy5zY2hlZCkKIAl4Lk5Eb20gPSB1aW50MzIoeGMubl9kb20pCiAJaWYg
ZXJyIDo9IHguQ3B1bWFwLmZyb21DKCZ4Yy5jcHVtYXApOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJu
IGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDcHVtYXA6ICV2Iiwg
ZXJyKQogCX0KIAogCXJldHVybiBuaWwKQEAgLTMyMiw3ICszMjIsNyBAQCBmdW5jICh4ICpDcHVw
b29saW5mbykgdG9DKHhjICpDLmxpYnhsX2NwdXBvb2xpbmZvKSAoZXJyIGVycm9yKSB7CiAJeGMu
c2NoZWQgPSBDLmxpYnhsX3NjaGVkdWxlcih4LlNjaGVkKQogCXhjLm5fZG9tID0gQy51aW50MzJf
dCh4Lk5Eb20pCiAJaWYgZXJyIDo9IHguQ3B1bWFwLnRvQygmeGMuY3B1bWFwKTsgZXJyICE9IG5p
bCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQg
Q3B1bWFwOiAldiIsIGVycikKIAl9CiAKIAlyZXR1cm4gbmlsCkBAIC0zNDIsNyArMzQyLDcgQEAg
ZnVuYyAoeCAqQ2hhbm5lbGluZm8pIGZyb21DKHhjICpDLmxpYnhsX2NoYW5uZWxpbmZvKSBlcnJv
ciB7CiAJY2FzZSBDaGFubmVsQ29ubmVjdGlvblB0eToKIAkJdmFyIGNvbm5lY3Rpb25QdHkgQ2hh
bm5lbGluZm9Db25uZWN0aW9uVW5pb25QdHkKIAkJaWYgZXJyIDo9IGNvbm5lY3Rpb25QdHkuZnJv
bUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIGNvbm5lY3Rpb25QdHk6ICV2IiwgZXJyKQogCQl9CiAJCXguQ29u
bmVjdGlvblVuaW9uID0gY29ubmVjdGlvblB0eQogCWRlZmF1bHQ6CkBAIC00MDMsNyArNDAzLDcg
QEAgZnVuYyAoeCAqQ2hhbm5lbGluZm8pIHRvQyh4YyAqQy5saWJ4bF9jaGFubmVsaW5mbykgKGVy
ciBlcnJvcikgewogCiBmdW5jICh4ICpWbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZtaW5mbykg
ZXJyb3IgewogCWlmIGVyciA6PSB4LlV1aWQuZnJvbUMoJnhjLnV1aWQpOyBlcnIgIT0gbmlsIHsK
LQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBVdWlk
OiAldiIsIGVycikKIAl9CiAJeC5Eb21pZCA9IERvbWlkKHhjLmRvbWlkKQogCkBAIC00MTgsNyAr
NDE4LDcgQEAgZnVuYyAoeCAqVm1pbmZvKSB0b0MoeGMgKkMubGlieGxfdm1pbmZvKSAoZXJyIGVy
cm9yKSB7CiAJfSgpCiAKIAlpZiBlcnIgOj0geC5VdWlkLnRvQygmeGMudXVpZCk7IGVyciAhPSBu
aWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxk
IFV1aWQ6ICV2IiwgZXJyKQogCX0KIAl4Yy5kb21pZCA9IEMubGlieGxfZG9taWQoeC5Eb21pZCkK
IApAQCAtNDg4LDMwICs0ODgsMzAgQEAgZnVuYyAoeCAqVmVyc2lvbkluZm8pIHRvQyh4YyAqQy5s
aWJ4bF92ZXJzaW9uX2luZm8pIChlcnIgZXJyb3IpIHsKIGZ1bmMgKHggKkRvbWFpbkNyZWF0ZUlu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbykgZXJyb3IgewogCXguVHlw
ZSA9IERvbWFpblR5cGUoeGMuX3R5cGUpCiAJaWYgZXJyIDo9IHguSGFwLmZyb21DKCZ4Yy5oYXAp
OyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVy
dGluZyBmaWVsZCBIYXA6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5Pb3MuZnJvbUMoJnhj
Lm9vcyk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIE9vczogJXYiLCBlcnIpCiAJfQogCXguU3NpZHJlZiA9IHVpbnQzMih4
Yy5zc2lkcmVmKQogCXguU3NpZExhYmVsID0gQy5Hb1N0cmluZyh4Yy5zc2lkX2xhYmVsKQogCXgu
TmFtZSA9IEMuR29TdHJpbmcoeGMubmFtZSkKIAlpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51
dWlkKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgVXVpZDogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LlhzZGF0YS5m
cm9tQygmeGMueHNkYXRhKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZt
dC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgWHNkYXRhOiAldiIsIGVycikKIAl9CiAJaWYgZXJy
IDo9IHguUGxhdGZvcm1kYXRhLmZyb21DKCZ4Yy5wbGF0Zm9ybWRhdGEpOyBlcnIgIT0gbmlsIHsK
LQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQbGF0
Zm9ybWRhdGE6ICV2IiwgZXJyKQogCX0KIAl4LlBvb2xpZCA9IHVpbnQzMih4Yy5wb29saWQpCiAJ
eC5Qb29sTmFtZSA9IEMuR29TdHJpbmcoeGMucG9vbF9uYW1lKQogCWlmIGVyciA6PSB4LlJ1bkhv
dHBsdWdTY3JpcHRzLmZyb21DKCZ4Yy5ydW5faG90cGx1Z19zY3JpcHRzKTsgZXJyICE9IG5pbCB7
Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUnVu
SG90cGx1Z1NjcmlwdHM6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5Ecml2ZXJEb21haW4u
ZnJvbUMoJnhjLmRyaXZlcl9kb21haW4pOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBEcml2ZXJEb21haW46ICV2IiwgZXJy
KQogCX0KIAl4LlBhc3N0aHJvdWdoID0gUGFzc3Rocm91Z2goeGMucGFzc3Rocm91Z2gpCiAKQEAg
LTUyNywxMCArNTI3LDEwIEBAIGZ1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIHRvQyh4YyAqQy5s
aWJ4bF9kb21haW5fY3JlYXRlX2luZm8pIChlcnIgZXJyb3IpIHsKIAogCXhjLl90eXBlID0gQy5s
aWJ4bF9kb21haW5fdHlwZSh4LlR5cGUpCiAJaWYgZXJyIDo9IHguSGFwLnRvQygmeGMuaGFwKTsg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgSGFwOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguT29zLnRvQygmeGMub29z
KTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgT29zOiAldiIsIGVycikKIAl9CiAJeGMuc3NpZHJlZiA9IEMudWludDMyX3Qo
eC5Tc2lkcmVmKQogCWlmIHguU3NpZExhYmVsICE9ICIiIHsKQEAgLTU0MCwyMyArNTQwLDIzIEBA
IGZ1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fY3JlYXRl
X2luZm8pIChlcnIgZXJyb3IpIHsKIAkJeGMubmFtZSA9IEMuQ1N0cmluZyh4Lk5hbWUpCiAJfQog
CWlmIGVyciA6PSB4LlV1aWQudG9DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBl
cnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVXVpZDogJXYiLCBlcnIp
CiAJfQogCWlmIGVyciA6PSB4LlhzZGF0YS50b0MoJnhjLnhzZGF0YSk7IGVyciAhPSBuaWwgewot
CQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFhzZGF0
YTogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LlBsYXRmb3JtZGF0YS50b0MoJnhjLnBsYXRm
b3JtZGF0YSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIFBsYXRmb3JtZGF0YTogJXYiLCBlcnIpCiAJfQogCXhjLnBvb2xp
ZCA9IEMudWludDMyX3QoeC5Qb29saWQpCiAJaWYgeC5Qb29sTmFtZSAhPSAiIiB7CiAJCXhjLnBv
b2xfbmFtZSA9IEMuQ1N0cmluZyh4LlBvb2xOYW1lKQogCX0KIAlpZiBlcnIgOj0geC5SdW5Ib3Rw
bHVnU2NyaXB0cy50b0MoJnhjLnJ1bl9ob3RwbHVnX3NjcmlwdHMpOyBlcnIgIT0gbmlsIHsKLQkJ
cmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBSdW5Ib3Rw
bHVnU2NyaXB0czogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LkRyaXZlckRvbWFpbi50b0Mo
JnhjLmRyaXZlcl9kb21haW4pOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBEcml2ZXJEb21haW46ICV2IiwgZXJyKQogCX0K
IAl4Yy5wYXNzdGhyb3VnaCA9IEMubGlieGxfcGFzc3Rocm91Z2goeC5QYXNzdGhyb3VnaCkKIApA
QCAtNTY4LDcgKzU2OCw3IEBAIGZ1bmMgKHggKkRvbWFpblJlc3RvcmVQYXJhbXMpIGZyb21DKHhj
ICpDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgZXJyb3IgewogCXguU3RyZWFtVmVyc2lv
biA9IHVpbnQzMih4Yy5zdHJlYW1fdmVyc2lvbikKIAl4LkNvbG9Qcm94eVNjcmlwdCA9IEMuR29T
dHJpbmcoeGMuY29sb19wcm94eV9zY3JpcHQpCiAJaWYgZXJyIDo9IHguVXNlcnNwYWNlQ29sb1By
b3h5LmZyb21DKCZ4Yy51c2Vyc3BhY2VfY29sb19wcm94eSk7IGVyciAhPSBuaWwgewotCQlyZXR1
cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFVzZXJzcGFjZUNv
bG9Qcm94eTogJXYiLCBlcnIpCiAJfQogCiAJcmV0dXJuIG5pbApAQCAtNTg3LDcgKzU4Nyw3IEBA
IGZ1bmMgKHggKkRvbWFpblJlc3RvcmVQYXJhbXMpIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fcmVz
dG9yZV9wYXJhbXMpIChlcnIgZXJyb3IpCiAJCXhjLmNvbG9fcHJveHlfc2NyaXB0ID0gQy5DU3Ry
aW5nKHguQ29sb1Byb3h5U2NyaXB0KQogCX0KIAlpZiBlcnIgOj0geC5Vc2Vyc3BhY2VDb2xvUHJv
eHkudG9DKCZ4Yy51c2Vyc3BhY2VfY29sb19wcm94eSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4g
ZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFVzZXJzcGFjZUNvbG9Q
cm94eTogJXYiLCBlcnIpCiAJfQogCiAJcmV0dXJuIG5pbApAQCAtNjI5LDcgKzYyOSw3IEBAIGZ1
bmMgKHggKlZjcHVTY2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJh
bXMpIGVycm9yIHsKIAkJeC5WY3B1cyA9IG1ha2UoW11TY2hlZFBhcmFtcywgbnVtVmNwdXMpCiAJ
CWZvciBpLCB2IDo9IHJhbmdlIGNWY3B1cyB7CiAJCQlpZiBlcnIgOj0geC5WY3B1c1tpXS5mcm9t
Qygmdik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9y
ZigiY29udmVydGluZyBmaWVsZCBWY3B1czogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC02
NTEsNyArNjUxLDcgQEAgZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSB0b0MoeGMgKkMubGlieGxf
dmNwdV9zY2hlZF9wYXJhbXMpIChlcnIgZXJyb3IpIHsKIAkJY1ZjcHVzIDo9ICgqWzEgPDwgMjhd
Qy5saWJ4bF9zY2hlZF9wYXJhbXMpKHVuc2FmZS5Qb2ludGVyKHhjLnZjcHVzKSlbOm51bVZjcHVz
Om51bVZjcHVzXQogCQlmb3IgaSwgdiA6PSByYW5nZSB4LlZjcHVzIHsKIAkJCWlmIGVyciA6PSB2
LnRvQygmY1ZjcHVzW2ldKTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZjcHVzOiAldiIsIGVycikKIAkJCX0KIAkJ
fQogCX0KQEAgLTcwMyw3ICs3MDMsNyBAQCBmdW5jICh4ICpWbm9kZUluZm8pIGZyb21DKHhjICpD
LmxpYnhsX3Zub2RlX2luZm8pIGVycm9yIHsKIAl9CiAJeC5Qbm9kZSA9IHVpbnQzMih4Yy5wbm9k
ZSkKIAlpZiBlcnIgOj0geC5WY3B1cy5mcm9tQygmeGMudmNwdXMpOyBlcnIgIT0gbmlsIHsKLQkJ
cmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBWY3B1czog
JXYiLCBlcnIpCiAJfQogCiAJcmV0dXJuIG5pbApAQCAtNzI3LDcgKzcyNyw3IEBAIGZ1bmMgKHgg
KlZub2RlSW5mbykgdG9DKHhjICpDLmxpYnhsX3Zub2RlX2luZm8pIChlcnIgZXJyb3IpIHsKIAl9
CiAJeGMucG5vZGUgPSBDLnVpbnQzMl90KHguUG5vZGUpCiAJaWYgZXJyIDo9IHguVmNwdXMudG9D
KCZ4Yy52Y3B1cyk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJy
b3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZjcHVzOiAldiIsIGVycikKIAl9CiAKIAlyZXR1cm4gbmls
CkBAIC03NTYsMTMgKzc1NiwxMyBAQCBmdW5jICh4ICpSZG1SZXNlcnZlKSB0b0MoeGMgKkMubGli
eGxfcmRtX3Jlc2VydmUpIChlcnIgZXJyb3IpIHsKIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKIAl4Lk1heFZjcHVz
ID0gaW50KHhjLm1heF92Y3B1cykKIAlpZiBlcnIgOj0geC5BdmFpbFZjcHVzLmZyb21DKCZ4Yy5h
dmFpbF92Y3B1cyk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJy
b3JmKCJjb252ZXJ0aW5nIGZpZWxkIEF2YWlsVmNwdXM6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIg
Oj0geC5DcHVtYXAuZnJvbUMoJnhjLmNwdW1hcCk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJy
CisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENwdW1hcDogJXYiLCBlcnIp
CiAJfQogCWlmIGVyciA6PSB4Lk5vZGVtYXAuZnJvbUMoJnhjLm5vZGVtYXApOyBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBO
b2RlbWFwOiAldiIsIGVycikKIAl9CiAJeC5WY3B1SGFyZEFmZmluaXR5ID0gbmlsCiAJaWYgbnVt
VmNwdUhhcmRBZmZpbml0eSA6PSBpbnQoeGMubnVtX3ZjcHVfaGFyZF9hZmZpbml0eSk7IG51bVZj
cHVIYXJkQWZmaW5pdHkgPiAwIHsKQEAgLTc3MCw3ICs3NzAsNyBAQCBmdW5jICh4ICpEb21haW5C
dWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSBlcnJvciB7CiAJ
CXguVmNwdUhhcmRBZmZpbml0eSA9IG1ha2UoW11CaXRtYXAsIG51bVZjcHVIYXJkQWZmaW5pdHkp
CiAJCWZvciBpLCB2IDo9IHJhbmdlIGNWY3B1SGFyZEFmZmluaXR5IHsKIAkJCWlmIGVyciA6PSB4
LlZjcHVIYXJkQWZmaW5pdHlbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4g
ZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVmNwdUhhcmRBZmZp
bml0eTogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC03ODAsMTIgKzc4MCwxMiBAQCBmdW5j
ICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZv
KSBlcnJvciB7CiAJCXguVmNwdVNvZnRBZmZpbml0eSA9IG1ha2UoW11CaXRtYXAsIG51bVZjcHVT
b2Z0QWZmaW5pdHkpCiAJCWZvciBpLCB2IDo9IHJhbmdlIGNWY3B1U29mdEFmZmluaXR5IHsKIAkJ
CWlmIGVyciA6PSB4LlZjcHVTb2Z0QWZmaW5pdHlbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmlsIHsK
LQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQg
VmNwdVNvZnRBZmZpbml0eTogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CiAJaWYgZXJyIDo9IHgu
TnVtYVBsYWNlbWVudC5mcm9tQygmeGMubnVtYV9wbGFjZW1lbnQpOyBlcnIgIT0gbmlsIHsKLQkJ
cmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBOdW1hUGxh
Y2VtZW50OiAldiIsIGVycikKIAl9CiAJeC5Uc2NNb2RlID0gVHNjTW9kZSh4Yy50c2NfbW9kZSkK
IAl4Lk1heE1lbWtiID0gdWludDY0KHhjLm1heF9tZW1rYikKQEAgLTc5NywxMyArNzk3LDEzIEBA
IGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxk
X2luZm8pIGVycm9yIHsKIAl4LkV4ZWNTc2lkcmVmID0gdWludDMyKHhjLmV4ZWNfc3NpZHJlZikK
IAl4LkV4ZWNTc2lkTGFiZWwgPSBDLkdvU3RyaW5nKHhjLmV4ZWNfc3NpZF9sYWJlbCkKIAlpZiBl
cnIgOj0geC5Mb2NhbHRpbWUuZnJvbUMoJnhjLmxvY2FsdGltZSk7IGVyciAhPSBuaWwgewotCQly
ZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIExvY2FsdGlt
ZTogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LkRpc2FibGVNaWdyYXRlLmZyb21DKCZ4Yy5k
aXNhYmxlX21pZ3JhdGUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10
LkVycm9yZigiY29udmVydGluZyBmaWVsZCBEaXNhYmxlTWlncmF0ZTogJXYiLCBlcnIpCiAJfQog
CWlmIGVyciA6PSB4LkNwdWlkLmZyb21DKCZ4Yy5jcHVpZCk7IGVyciAhPSBuaWwgewotCQlyZXR1
cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENwdWlkOiAldiIs
IGVycikKIAl9CiAJeC5CbGtkZXZTdGFydCA9IEMuR29TdHJpbmcoeGMuYmxrZGV2X3N0YXJ0KQog
CXguVm51bWFOb2RlcyA9IG5pbApAQCAtODEyLDcgKzgxMiw3IEBAIGZ1bmMgKHggKkRvbWFpbkJ1
aWxkSW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKIAkJ
eC5WbnVtYU5vZGVzID0gbWFrZShbXVZub2RlSW5mbywgbnVtVm51bWFOb2RlcykKIAkJZm9yIGks
IHYgOj0gcmFuZ2UgY1ZudW1hTm9kZXMgewogCQkJaWYgZXJyIDo9IHguVm51bWFOb2Rlc1tpXS5m
cm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVy
cm9yZigiY29udmVydGluZyBmaWVsZCBWbnVtYU5vZGVzOiAldiIsIGVycikKIAkJCX0KIAkJfQog
CX0KQEAgLTgyMCwyMyArODIwLDIzIEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykgZnJvbUMo
eGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKIAl4Lk1heE1hcHRyYWNrRnJh
bWVzID0gdWludDMyKHhjLm1heF9tYXB0cmFja19mcmFtZXMpCiAJeC5EZXZpY2VNb2RlbFZlcnNp
b24gPSBEZXZpY2VNb2RlbFZlcnNpb24oeGMuZGV2aWNlX21vZGVsX3ZlcnNpb24pCiAJaWYgZXJy
IDo9IHguRGV2aWNlTW9kZWxTdHViZG9tYWluLmZyb21DKCZ4Yy5kZXZpY2VfbW9kZWxfc3R1YmRv
bWFpbik7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIERldmljZU1vZGVsU3R1YmRvbWFpbjogJXYiLCBlcnIpCiAJfQogCXgu
RGV2aWNlTW9kZWwgPSBDLkdvU3RyaW5nKHhjLmRldmljZV9tb2RlbCkKIAl4LkRldmljZU1vZGVs
U3NpZHJlZiA9IHVpbnQzMih4Yy5kZXZpY2VfbW9kZWxfc3NpZHJlZikKIAl4LkRldmljZU1vZGVs
U3NpZExhYmVsID0gQy5Hb1N0cmluZyh4Yy5kZXZpY2VfbW9kZWxfc3NpZF9sYWJlbCkKIAl4LkRl
dmljZU1vZGVsVXNlciA9IEMuR29TdHJpbmcoeGMuZGV2aWNlX21vZGVsX3VzZXIpCiAJaWYgZXJy
IDo9IHguRXh0cmEuZnJvbUMoJnhjLmV4dHJhKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIK
KwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRXh0cmE6ICV2IiwgZXJyKQog
CX0KIAlpZiBlcnIgOj0geC5FeHRyYVB2LmZyb21DKCZ4Yy5leHRyYV9wdik7IGVyciAhPSBuaWwg
ewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEV4
dHJhUHY6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5FeHRyYUh2bS5mcm9tQygmeGMuZXh0
cmFfaHZtKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgRXh0cmFIdm06ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5T
Y2hlZFBhcmFtcy5mcm9tQygmeGMuc2NoZWRfcGFyYW1zKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVy
biBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgU2NoZWRQYXJhbXM6
ICV2IiwgZXJyKQogCX0KIAl4LklvcG9ydHMgPSBuaWwKIAlpZiBudW1Jb3BvcnRzIDo9IGludCh4
Yy5udW1faW9wb3J0cyk7IG51bUlvcG9ydHMgPiAwIHsKQEAgLTg0NCw3ICs4NDQsNyBAQCBmdW5j
ICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZv
KSBlcnJvciB7CiAJCXguSW9wb3J0cyA9IG1ha2UoW11Jb3BvcnRSYW5nZSwgbnVtSW9wb3J0cykK
IAkJZm9yIGksIHYgOj0gcmFuZ2UgY0lvcG9ydHMgewogCQkJaWYgZXJyIDo9IHguSW9wb3J0c1tp
XS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10
LkVycm9yZigiY29udmVydGluZyBmaWVsZCBJb3BvcnRzOiAldiIsIGVycikKIAkJCX0KIAkJfQog
CX0KQEAgLTg2MiwxMiArODYyLDEyIEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykgZnJvbUMo
eGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKIAkJeC5Jb21lbSA9IG1ha2Uo
W11Jb21lbVJhbmdlLCBudW1Jb21lbSkKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY0lvbWVtIHsKIAkJ
CWlmIGVyciA6PSB4LklvbWVtW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJu
IGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIElvbWVtOiAldiIs
IGVycikKIAkJCX0KIAkJfQogCX0KIAlpZiBlcnIgOj0geC5DbGFpbU1vZGUuZnJvbUMoJnhjLmNs
YWltX21vZGUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9y
ZigiY29udmVydGluZyBmaWVsZCBDbGFpbU1vZGU6ICV2IiwgZXJyKQogCX0KIAl4LkV2ZW50Q2hh
bm5lbHMgPSB1aW50MzIoeGMuZXZlbnRfY2hhbm5lbHMpCiAJeC5LZXJuZWwgPSBDLkdvU3RyaW5n
KHhjLmtlcm5lbCkKQEAgLTg3NSwyMSArODc1LDIxIEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5m
bykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKIAl4LlJhbWRp
c2sgPSBDLkdvU3RyaW5nKHhjLnJhbWRpc2spCiAJeC5EZXZpY2VUcmVlID0gQy5Hb1N0cmluZyh4
Yy5kZXZpY2VfdHJlZSkKIAlpZiBlcnIgOj0geC5BY3BpLmZyb21DKCZ4Yy5hY3BpKTsgZXJyICE9
IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgQWNwaTogJXYiLCBlcnIpCiAJfQogCXguQm9vdGxvYWRlciA9IEMuR29TdHJpbmcoeGMuYm9v
dGxvYWRlcikKIAlpZiBlcnIgOj0geC5Cb290bG9hZGVyQXJncy5mcm9tQygmeGMuYm9vdGxvYWRl
cl9hcmdzKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgQm9vdGxvYWRlckFyZ3M6ICV2IiwgZXJyKQogCX0KIAl4LlRpbWVy
TW9kZSA9IFRpbWVyTW9kZSh4Yy50aW1lcl9tb2RlKQogCWlmIGVyciA6PSB4Lk5lc3RlZEh2bS5m
cm9tQygmeGMubmVzdGVkX2h2bSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIE5lc3RlZEh2bTogJXYiLCBlcnIpCiAJfQog
CWlmIGVyciA6PSB4LkFwaWMuZnJvbUMoJnhjLmFwaWMpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJu
IGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBBcGljOiAldiIsIGVy
cikKIAl9CiAJaWYgZXJyIDo9IHguRG1SZXN0cmljdC5mcm9tQygmeGMuZG1fcmVzdHJpY3QpOyBl
cnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBEbVJlc3RyaWN0OiAldiIsIGVycikKIAl9CiAJeC5UZWUgPSBUZWVUeXBlKHhjLnRl
ZSkKIAl4LlR5cGUgPSBEb21haW5UeXBlKHhjLl90eXBlKQpAQCAtODk3LDE5ICs4OTcsMTkgQEAg
ZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mbykgZXJyb3IgewogCWNhc2UgRG9tYWluVHlwZUh2bToKIAkJdmFyIHR5cGVIdm0gRG9tYWlu
QnVpbGRJbmZvVHlwZVVuaW9uSHZtCiAJCWlmIGVyciA6PSB0eXBlSHZtLmZyb21DKHhjKTsgZXJy
ICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCB0eXBlSHZtOiAldiIsIGVycikKIAkJfQogCQl4LlR5cGVVbmlvbiA9IHR5cGVIdm0K
IAljYXNlIERvbWFpblR5cGVQdjoKIAkJdmFyIHR5cGVQdiBEb21haW5CdWlsZEluZm9UeXBlVW5p
b25QdgogCQlpZiBlcnIgOj0gdHlwZVB2LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1
cm4gZXJyCisJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCB0eXBlUHY6ICV2
IiwgZXJyKQogCQl9CiAJCXguVHlwZVVuaW9uID0gdHlwZVB2CiAJY2FzZSBEb21haW5UeXBlUHZo
OgogCQl2YXIgdHlwZVB2aCBEb21haW5CdWlsZEluZm9UeXBlVW5pb25QdmgKIAkJaWYgZXJyIDo9
IHR5cGVQdmguZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVQdmg6ICV2IiwgZXJyKQogCQl9CiAJ
CXguVHlwZVVuaW9uID0gdHlwZVB2aAogCWRlZmF1bHQ6CkBAIC05MzEsMTAwICs5MzEsMTAwIEBA
IGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvbkh2bSkgZnJvbUMoeGMgKkMubGlieGxf
ZG9tYWluX2J1aWxkX2luZm8pIGVycm9yCiAJeC5GaXJtd2FyZSA9IEMuR29TdHJpbmcodG1wLmZp
cm13YXJlKQogCXguQmlvcyA9IEJpb3NUeXBlKHRtcC5iaW9zKQogCWlmIGVyciA6PSB4LlBhZS5m
cm9tQygmdG1wLnBhZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFBhZTogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4
LkFwaWMuZnJvbUMoJnRtcC5hcGljKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQXBpYzogJXYiLCBlcnIpCiAJfQogCWlm
IGVyciA6PSB4LkFjcGkuZnJvbUMoJnRtcC5hY3BpKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBl
cnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQWNwaTogJXYiLCBlcnIp
CiAJfQogCWlmIGVyciA6PSB4LkFjcGlTMy5mcm9tQygmdG1wLmFjcGlfczMpOyBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBB
Y3BpUzM6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5BY3BpUzQuZnJvbUMoJnRtcC5hY3Bp
X3M0KTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgQWNwaVM0OiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQWNwaUxh
cHRvcFNsYXRlLmZyb21DKCZ0bXAuYWNwaV9sYXB0b3Bfc2xhdGUpOyBlcnIgIT0gbmlsIHsKLQkJ
cmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBBY3BpTGFw
dG9wU2xhdGU6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5OeC5mcm9tQygmdG1wLm54KTsg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgTng6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5WaXJpZGlhbi5mcm9tQygm
dG1wLnZpcmlkaWFuKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVmlyaWRpYW46ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIg
Oj0geC5WaXJpZGlhbkVuYWJsZS5mcm9tQygmdG1wLnZpcmlkaWFuX2VuYWJsZSk7IGVyciAhPSBu
aWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxk
IFZpcmlkaWFuRW5hYmxlOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguVmlyaWRpYW5EaXNh
YmxlLmZyb21DKCZ0bXAudmlyaWRpYW5fZGlzYWJsZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4g
ZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZpcmlkaWFuRGlzYWJs
ZTogJXYiLCBlcnIpCiAJfQogCXguVGltZW9mZnNldCA9IEMuR29TdHJpbmcodG1wLnRpbWVvZmZz
ZXQpCiAJaWYgZXJyIDo9IHguSHBldC5mcm9tQygmdG1wLmhwZXQpOyBlcnIgIT0gbmlsIHsKLQkJ
cmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBIcGV0OiAl
diIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguVnB0QWxpZ24uZnJvbUMoJnRtcC52cHRfYWxpZ24p
OyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVy
dGluZyBmaWVsZCBWcHRBbGlnbjogJXYiLCBlcnIpCiAJfQogCXguTW1pb0hvbGVNZW1rYiA9IHVp
bnQ2NCh0bXAubW1pb19ob2xlX21lbWtiKQogCXguVGltZXJNb2RlID0gVGltZXJNb2RlKHRtcC50
aW1lcl9tb2RlKQogCWlmIGVyciA6PSB4Lk5lc3RlZEh2bS5mcm9tQygmdG1wLm5lc3RlZF9odm0p
OyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVy
dGluZyBmaWVsZCBOZXN0ZWRIdm06ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5BbHRwMk0u
ZnJvbUMoJnRtcC5hbHRwMm0pOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBBbHRwMk06ICV2IiwgZXJyKQogCX0KIAl4LlN5
c3RlbUZpcm13YXJlID0gQy5Hb1N0cmluZyh0bXAuc3lzdGVtX2Zpcm13YXJlKQogCXguU21iaW9z
RmlybXdhcmUgPSBDLkdvU3RyaW5nKHRtcC5zbWJpb3NfZmlybXdhcmUpCiAJeC5BY3BpRmlybXdh
cmUgPSBDLkdvU3RyaW5nKHRtcC5hY3BpX2Zpcm13YXJlKQogCXguSGR0eXBlID0gSGR0eXBlKHRt
cC5oZHR5cGUpCiAJaWYgZXJyIDo9IHguTm9ncmFwaGljLmZyb21DKCZ0bXAubm9ncmFwaGljKTsg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgTm9ncmFwaGljOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguVmdhLmZyb21D
KCZ0bXAudmdhKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJv
cmYoImNvbnZlcnRpbmcgZmllbGQgVmdhOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguVm5j
LmZyb21DKCZ0bXAudm5jKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZt
dC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVm5jOiAldiIsIGVycikKIAl9CiAJeC5LZXltYXAg
PSBDLkdvU3RyaW5nKHRtcC5rZXltYXApCiAJaWYgZXJyIDo9IHguU2RsLmZyb21DKCZ0bXAuc2Rs
KTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgU2RsOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguU3BpY2UuZnJvbUMo
JnRtcC5zcGljZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJy
b3JmKCJjb252ZXJ0aW5nIGZpZWxkIFNwaWNlOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHgu
R2Z4UGFzc3RocnUuZnJvbUMoJnRtcC5nZnhfcGFzc3RocnUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0
dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBHZnhQYXNzdGhy
dTogJXYiLCBlcnIpCiAJfQogCXguR2Z4UGFzc3RocnVLaW5kID0gR2Z4UGFzc3RocnVLaW5kKHRt
cC5nZnhfcGFzc3RocnVfa2luZCkKIAl4LlNlcmlhbCA9IEMuR29TdHJpbmcodG1wLnNlcmlhbCkK
IAl4LkJvb3QgPSBDLkdvU3RyaW5nKHRtcC5ib290KQogCWlmIGVyciA6PSB4LlVzYi5mcm9tQygm
dG1wLnVzYik7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3Jm
KCJjb252ZXJ0aW5nIGZpZWxkIFVzYjogJXYiLCBlcnIpCiAJfQogCXguVXNidmVyc2lvbiA9IGlu
dCh0bXAudXNidmVyc2lvbikKIAl4LlVzYmRldmljZSA9IEMuR29TdHJpbmcodG1wLnVzYmRldmlj
ZSkKIAlpZiBlcnIgOj0geC5Wa2JEZXZpY2UuZnJvbUMoJnRtcC52a2JfZGV2aWNlKTsgZXJyICE9
IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgVmtiRGV2aWNlOiAldiIsIGVycikKIAl9CiAJeC5Tb3VuZGh3ID0gQy5Hb1N0cmluZyh0bXAu
c291bmRodykKIAlpZiBlcnIgOj0geC5YZW5QbGF0Zm9ybVBjaS5mcm9tQygmdG1wLnhlbl9wbGF0
Zm9ybV9wY2kpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9y
ZigiY29udmVydGluZyBmaWVsZCBYZW5QbGF0Zm9ybVBjaTogJXYiLCBlcnIpCiAJfQogCWlmIGVy
ciA6PSB4LlVzYmRldmljZUxpc3QuZnJvbUMoJnRtcC51c2JkZXZpY2VfbGlzdCk7IGVyciAhPSBu
aWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxk
IFVzYmRldmljZUxpc3Q6ICV2IiwgZXJyKQogCX0KIAl4LlZlbmRvckRldmljZSA9IFZlbmRvckRl
dmljZSh0bXAudmVuZG9yX2RldmljZSkKIAlpZiBlcnIgOj0geC5Nc1ZtR2VuaWQuZnJvbUMoJnRt
cC5tc192bV9nZW5pZCk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIE1zVm1HZW5pZDogJXYiLCBlcnIpCiAJfQogCWlmIGVy
ciA6PSB4LlNlcmlhbExpc3QuZnJvbUMoJnRtcC5zZXJpYWxfbGlzdCk7IGVyciAhPSBuaWwgewot
CQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFNlcmlh
bExpc3Q6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5SZG0uZnJvbUMoJnRtcC5yZG0pOyBl
cnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBSZG06ICV2IiwgZXJyKQogCX0KIAl4LlJkbU1lbUJvdW5kYXJ5TWVta2IgPSB1aW50
NjQodG1wLnJkbV9tZW1fYm91bmRhcnlfbWVta2IpCiAJeC5NY2FDYXBzID0gdWludDY0KHRtcC5t
Y2FfY2FwcykKQEAgLTEwNDEsMTMgKzEwNDEsMTMgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZv
VHlwZVVuaW9uUHYpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSBlcnJvcgog
CXguU2xhY2tNZW1rYiA9IHVpbnQ2NCh0bXAuc2xhY2tfbWVta2IpCiAJeC5Cb290bG9hZGVyID0g
Qy5Hb1N0cmluZyh0bXAuYm9vdGxvYWRlcikKIAlpZiBlcnIgOj0geC5Cb290bG9hZGVyQXJncy5m
cm9tQygmdG1wLmJvb3Rsb2FkZXJfYXJncyk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEJvb3Rsb2FkZXJBcmdzOiAldiIs
IGVycikKIAl9CiAJeC5DbWRsaW5lID0gQy5Hb1N0cmluZyh0bXAuY21kbGluZSkKIAl4LlJhbWRp
c2sgPSBDLkdvU3RyaW5nKHRtcC5yYW1kaXNrKQogCXguRmVhdHVyZXMgPSBDLkdvU3RyaW5nKHRt
cC5mZWF0dXJlcykKIAlpZiBlcnIgOj0geC5FODIwSG9zdC5mcm9tQygmdG1wLmU4MjBfaG9zdCk7
IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0
aW5nIGZpZWxkIEU4MjBIb3N0OiAldiIsIGVycikKIAl9CiAJcmV0dXJuIG5pbAogfQpAQCAtMTA1
OSw3ICsxMDU5LDcgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uUHZoKSBmcm9t
Qyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJyb3IKIAogCXRtcCA6PSAoKkMubGli
eGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9wdmgpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51
WzBdKSkKIAlpZiBlcnIgOj0geC5QdnNoaW0uZnJvbUMoJnRtcC5wdnNoaW0pOyBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQ
dnNoaW06ICV2IiwgZXJyKQogCX0KIAl4LlB2c2hpbVBhdGggPSBDLkdvU3RyaW5nKHRtcC5wdnNo
aW1fcGF0aCkKIAl4LlB2c2hpbUNtZGxpbmUgPSBDLkdvU3RyaW5nKHRtcC5wdnNoaW1fY21kbGlu
ZSkKQEAgLTEwNzYsMTMgKzEwNzYsMTMgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSB0b0Mo
eGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIChlcnIgZXJyb3IpIHsKIAogCXhjLm1heF92
Y3B1cyA9IEMuaW50KHguTWF4VmNwdXMpCiAJaWYgZXJyIDo9IHguQXZhaWxWY3B1cy50b0MoJnhj
LmF2YWlsX3ZjcHVzKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQXZhaWxWY3B1czogJXYiLCBlcnIpCiAJfQogCWlmIGVy
ciA6PSB4LkNwdW1hcC50b0MoJnhjLmNwdW1hcCk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJy
CisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENwdW1hcDogJXYiLCBlcnIp
CiAJfQogCWlmIGVyciA6PSB4Lk5vZGVtYXAudG9DKCZ4Yy5ub2RlbWFwKTsgZXJyICE9IG5pbCB7
Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgTm9k
ZW1hcDogJXYiLCBlcnIpCiAJfQogCWlmIG51bVZjcHVIYXJkQWZmaW5pdHkgOj0gbGVuKHguVmNw
dUhhcmRBZmZpbml0eSk7IG51bVZjcHVIYXJkQWZmaW5pdHkgPiAwIHsKIAkJeGMudmNwdV9oYXJk
X2FmZmluaXR5ID0gKCpDLmxpYnhsX2JpdG1hcCkoQy5tYWxsb2MoQy51bG9uZyhudW1WY3B1SGFy
ZEFmZmluaXR5KSAqIEMuc2l6ZW9mX2xpYnhsX2JpdG1hcCkpCkBAIC0xMDkwLDcgKzEwOTAsNyBA
QCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mbykgKGVyciBlcnJvcikgewogCQljVmNwdUhhcmRBZmZpbml0eSA6PSAoKlsxIDw8IDI4XUMu
bGlieGxfYml0bWFwKSh1bnNhZmUuUG9pbnRlcih4Yy52Y3B1X2hhcmRfYWZmaW5pdHkpKVs6bnVt
VmNwdUhhcmRBZmZpbml0eTpudW1WY3B1SGFyZEFmZmluaXR5XQogCQlmb3IgaSwgdiA6PSByYW5n
ZSB4LlZjcHVIYXJkQWZmaW5pdHkgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjVmNwdUhhcmRBZmZp
bml0eVtpXSk7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVy
cm9yZigiY29udmVydGluZyBmaWVsZCBWY3B1SGFyZEFmZmluaXR5OiAldiIsIGVycikKIAkJCX0K
IAkJfQogCX0KQEAgLTExMDAsMTIgKzExMDAsMTIgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZv
KSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIChlcnIgZXJyb3IpIHsKIAkJY1Zj
cHVTb2Z0QWZmaW5pdHkgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2JpdG1hcCkodW5zYWZlLlBvaW50
ZXIoeGMudmNwdV9zb2Z0X2FmZmluaXR5KSlbOm51bVZjcHVTb2Z0QWZmaW5pdHk6bnVtVmNwdVNv
ZnRBZmZpbml0eV0KIAkJZm9yIGksIHYgOj0gcmFuZ2UgeC5WY3B1U29mdEFmZmluaXR5IHsKIAkJ
CWlmIGVyciA6PSB2LnRvQygmY1ZjcHVTb2Z0QWZmaW5pdHlbaV0pOyBlcnIgIT0gbmlsIHsKLQkJ
CQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVmNw
dVNvZnRBZmZpbml0eTogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CiAJaWYgZXJyIDo9IHguTnVt
YVBsYWNlbWVudC50b0MoJnhjLm51bWFfcGxhY2VtZW50KTsgZXJyICE9IG5pbCB7Ci0JCXJldHVy
biBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgTnVtYVBsYWNlbWVu
dDogJXYiLCBlcnIpCiAJfQogCXhjLnRzY19tb2RlID0gQy5saWJ4bF90c2NfbW9kZSh4LlRzY01v
ZGUpCiAJeGMubWF4X21lbWtiID0gQy51aW50NjRfdCh4Lk1heE1lbWtiKQpAQCAtMTExOSwxMyAr
MTExOSwxMyBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21h
aW5fYnVpbGRfaW5mbykgKGVyciBlcnJvcikgewogCQl4Yy5leGVjX3NzaWRfbGFiZWwgPSBDLkNT
dHJpbmcoeC5FeGVjU3NpZExhYmVsKQogCX0KIAlpZiBlcnIgOj0geC5Mb2NhbHRpbWUudG9DKCZ4
Yy5sb2NhbHRpbWUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVy
cm9yZigiY29udmVydGluZyBmaWVsZCBMb2NhbHRpbWU6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIg
Oj0geC5EaXNhYmxlTWlncmF0ZS50b0MoJnhjLmRpc2FibGVfbWlncmF0ZSk7IGVyciAhPSBuaWwg
ewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIERp
c2FibGVNaWdyYXRlOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQ3B1aWQudG9DKCZ4Yy5j
cHVpZCk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIENwdWlkOiAldiIsIGVycikKIAl9CiAJaWYgeC5CbGtkZXZTdGFydCAh
PSAiIiB7CiAJCXhjLmJsa2Rldl9zdGFydCA9IEMuQ1N0cmluZyh4LkJsa2RldlN0YXJ0KQpAQCAt
MTEzNiw3ICsxMTM2LDcgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSB0b0MoeGMgKkMubGli
eGxfZG9tYWluX2J1aWxkX2luZm8pIChlcnIgZXJyb3IpIHsKIAkJY1ZudW1hTm9kZXMgOj0gKCpb
MSA8PCAyOF1DLmxpYnhsX3Zub2RlX2luZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnZudW1hX25vZGVz
KSlbOm51bVZudW1hTm9kZXM6bnVtVm51bWFOb2Rlc10KIAkJZm9yIGksIHYgOj0gcmFuZ2UgeC5W
bnVtYU5vZGVzIHsKIAkJCWlmIGVyciA6PSB2LnRvQygmY1ZudW1hTm9kZXNbaV0pOyBlcnIgIT0g
bmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgVm51bWFOb2RlczogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC0xMTQ0LDcgKzEx
NDQsNyBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5f
YnVpbGRfaW5mbykgKGVyciBlcnJvcikgewogCXhjLm1heF9tYXB0cmFja19mcmFtZXMgPSBDLnVp
bnQzMl90KHguTWF4TWFwdHJhY2tGcmFtZXMpCiAJeGMuZGV2aWNlX21vZGVsX3ZlcnNpb24gPSBD
LmxpYnhsX2RldmljZV9tb2RlbF92ZXJzaW9uKHguRGV2aWNlTW9kZWxWZXJzaW9uKQogCWlmIGVy
ciA6PSB4LkRldmljZU1vZGVsU3R1YmRvbWFpbi50b0MoJnhjLmRldmljZV9tb2RlbF9zdHViZG9t
YWluKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgRGV2aWNlTW9kZWxTdHViZG9tYWluOiAldiIsIGVycikKIAl9CiAJaWYg
eC5EZXZpY2VNb2RlbCAhPSAiIiB7CiAJCXhjLmRldmljZV9tb2RlbCA9IEMuQ1N0cmluZyh4LkRl
dmljZU1vZGVsKQpAQCAtMTE1NywxNiArMTE1NywxNiBAQCBmdW5jICh4ICpEb21haW5CdWlsZElu
Zm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgKGVyciBlcnJvcikgewogCQl4
Yy5kZXZpY2VfbW9kZWxfdXNlciA9IEMuQ1N0cmluZyh4LkRldmljZU1vZGVsVXNlcikKIAl9CiAJ
aWYgZXJyIDo9IHguRXh0cmEudG9DKCZ4Yy5leHRyYSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4g
ZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEV4dHJhOiAldiIsIGVy
cikKIAl9CiAJaWYgZXJyIDo9IHguRXh0cmFQdi50b0MoJnhjLmV4dHJhX3B2KTsgZXJyICE9IG5p
bCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQg
RXh0cmFQdjogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LkV4dHJhSHZtLnRvQygmeGMuZXh0
cmFfaHZtKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgRXh0cmFIdm06ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5T
Y2hlZFBhcmFtcy50b0MoJnhjLnNjaGVkX3BhcmFtcyk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4g
ZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFNjaGVkUGFyYW1zOiAl
diIsIGVycikKIAl9CiAJaWYgbnVtSW9wb3J0cyA6PSBsZW4oeC5Jb3BvcnRzKTsgbnVtSW9wb3J0
cyA+IDAgewogCQl4Yy5pb3BvcnRzID0gKCpDLmxpYnhsX2lvcG9ydF9yYW5nZSkoQy5tYWxsb2Mo
Qy51bG9uZyhudW1Jb3BvcnRzKSAqIEMuc2l6ZW9mX2xpYnhsX2lvcG9ydF9yYW5nZSkpCkBAIC0x
MTc0LDcgKzExNzQsNyBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4
bF9kb21haW5fYnVpbGRfaW5mbykgKGVyciBlcnJvcikgewogCQljSW9wb3J0cyA6PSAoKlsxIDw8
IDI4XUMubGlieGxfaW9wb3J0X3JhbmdlKSh1bnNhZmUuUG9pbnRlcih4Yy5pb3BvcnRzKSlbOm51
bUlvcG9ydHM6bnVtSW9wb3J0c10KIAkJZm9yIGksIHYgOj0gcmFuZ2UgeC5Jb3BvcnRzIHsKIAkJ
CWlmIGVyciA6PSB2LnRvQygmY0lvcG9ydHNbaV0pOyBlcnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4g
ZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgSW9wb3J0czogJXYi
LCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC0xMTkyLDEyICsxMTkyLDEyIEBAIGZ1bmMgKHggKkRv
bWFpbkJ1aWxkSW5mbykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSAoZXJyIGVy
cm9yKSB7CiAJCWNJb21lbSA6PSAoKlsxIDw8IDI4XUMubGlieGxfaW9tZW1fcmFuZ2UpKHVuc2Fm
ZS5Qb2ludGVyKHhjLmlvbWVtKSlbOm51bUlvbWVtOm51bUlvbWVtXQogCQlmb3IgaSwgdiA6PSBy
YW5nZSB4LklvbWVtIHsKIAkJCWlmIGVyciA6PSB2LnRvQygmY0lvbWVtW2ldKTsgZXJyICE9IG5p
bCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZp
ZWxkIElvbWVtOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KIAlpZiBlcnIgOj0geC5DbGFpbU1v
ZGUudG9DKCZ4Yy5jbGFpbV9tb2RlKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ2xhaW1Nb2RlOiAldiIsIGVycikKIAl9
CiAJeGMuZXZlbnRfY2hhbm5lbHMgPSBDLnVpbnQzMl90KHguRXZlbnRDaGFubmVscykKIAlpZiB4
Lktlcm5lbCAhPSAiIiB7CkBAIC0xMjEzLDIzICsxMjEzLDIzIEBAIGZ1bmMgKHggKkRvbWFpbkJ1
aWxkSW5mbykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSAoZXJyIGVycm9yKSB7
CiAJCXhjLmRldmljZV90cmVlID0gQy5DU3RyaW5nKHguRGV2aWNlVHJlZSkKIAl9CiAJaWYgZXJy
IDo9IHguQWNwaS50b0MoJnhjLmFjcGkpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBBY3BpOiAldiIsIGVycikKIAl9CiAJ
aWYgeC5Cb290bG9hZGVyICE9ICIiIHsKIAkJeGMuYm9vdGxvYWRlciA9IEMuQ1N0cmluZyh4LkJv
b3Rsb2FkZXIpCiAJfQogCWlmIGVyciA6PSB4LkJvb3Rsb2FkZXJBcmdzLnRvQygmeGMuYm9vdGxv
YWRlcl9hcmdzKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJv
cmYoImNvbnZlcnRpbmcgZmllbGQgQm9vdGxvYWRlckFyZ3M6ICV2IiwgZXJyKQogCX0KIAl4Yy50
aW1lcl9tb2RlID0gQy5saWJ4bF90aW1lcl9tb2RlKHguVGltZXJNb2RlKQogCWlmIGVyciA6PSB4
Lk5lc3RlZEh2bS50b0MoJnhjLm5lc3RlZF9odm0pOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVy
cgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBOZXN0ZWRIdm06ICV2Iiwg
ZXJyKQogCX0KIAlpZiBlcnIgOj0geC5BcGljLnRvQygmeGMuYXBpYyk7IGVyciAhPSBuaWwgewot
CQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEFwaWM6
ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5EbVJlc3RyaWN0LnRvQygmeGMuZG1fcmVzdHJp
Y3QpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29u
dmVydGluZyBmaWVsZCBEbVJlc3RyaWN0OiAldiIsIGVycikKIAl9CiAJeGMudGVlID0gQy5saWJ4
bF90ZWVfdHlwZSh4LlRlZSkKIAl4Yy5fdHlwZSA9IEMubGlieGxfZG9tYWluX3R5cGUoeC5UeXBl
KQpAQCAtMTI0NSw1MSArMTI0NSw1MSBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4
YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgKGVyciBlcnJvcikgewogCQl9CiAJCWh2bS5i
aW9zID0gQy5saWJ4bF9iaW9zX3R5cGUodG1wLkJpb3MpCiAJCWlmIGVyciA6PSB0bXAuUGFlLnRv
QygmaHZtLnBhZSk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUGFlOiAldiIsIGVycikKIAkJfQogCQlpZiBlcnIgOj0g
dG1wLkFwaWMudG9DKCZodm0uYXBpYyk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQXBpYzogJXYiLCBlcnIpCiAJCX0K
IAkJaWYgZXJyIDo9IHRtcC5BY3BpLnRvQygmaHZtLmFjcGkpOyBlcnIgIT0gbmlsIHsKLQkJCXJl
dHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEFjcGk6ICV2
IiwgZXJyKQogCQl9CiAJCWlmIGVyciA6PSB0bXAuQWNwaVMzLnRvQygmaHZtLmFjcGlfczMpOyBl
cnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0
aW5nIGZpZWxkIEFjcGlTMzogJXYiLCBlcnIpCiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5BY3BpUzQu
dG9DKCZodm0uYWNwaV9zNCk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJu
IGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQWNwaVM0OiAldiIsIGVycikKIAkJfQogCQlp
ZiBlcnIgOj0gdG1wLkFjcGlMYXB0b3BTbGF0ZS50b0MoJmh2bS5hY3BpX2xhcHRvcF9zbGF0ZSk7
IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgQWNwaUxhcHRvcFNsYXRlOiAldiIsIGVycikKIAkJfQogCQlpZiBlcnIgOj0g
dG1wLk54LnRvQygmaHZtLm54KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBOeDogJXYiLCBlcnIpCiAJCX0KIAkJaWYg
ZXJyIDo9IHRtcC5WaXJpZGlhbi50b0MoJmh2bS52aXJpZGlhbik7IGVyciAhPSBuaWwgewotCQkJ
cmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVmlyaWRp
YW46ICV2IiwgZXJyKQogCQl9CiAJCWlmIGVyciA6PSB0bXAuVmlyaWRpYW5FbmFibGUudG9DKCZo
dm0udmlyaWRpYW5fZW5hYmxlKTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBWaXJpZGlhbkVuYWJsZTogJXYiLCBlcnIp
CiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5WaXJpZGlhbkRpc2FibGUudG9DKCZodm0udmlyaWRpYW5f
ZGlzYWJsZSk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJv
cmYoImNvbnZlcnRpbmcgZmllbGQgVmlyaWRpYW5EaXNhYmxlOiAldiIsIGVycikKIAkJfQogCQlp
ZiB0bXAuVGltZW9mZnNldCAhPSAiIiB7CiAJCQlodm0udGltZW9mZnNldCA9IEMuQ1N0cmluZyh0
bXAuVGltZW9mZnNldCkKIAkJfQogCQlpZiBlcnIgOj0gdG1wLkhwZXQudG9DKCZodm0uaHBldCk7
IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgSHBldDogJXYiLCBlcnIpCiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5WcHRBbGln
bi50b0MoJmh2bS52cHRfYWxpZ24pOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZwdEFsaWduOiAldiIsIGVycikKIAkJ
fQogCQlodm0ubW1pb19ob2xlX21lbWtiID0gQy51aW50NjRfdCh0bXAuTW1pb0hvbGVNZW1rYikK
IAkJaHZtLnRpbWVyX21vZGUgPSBDLmxpYnhsX3RpbWVyX21vZGUodG1wLlRpbWVyTW9kZSkKIAkJ
aWYgZXJyIDo9IHRtcC5OZXN0ZWRIdm0udG9DKCZodm0ubmVzdGVkX2h2bSk7IGVyciAhPSBuaWwg
ewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQg
TmVzdGVkSHZtOiAldiIsIGVycikKIAkJfQogCQlpZiBlcnIgOj0gdG1wLkFsdHAyTS50b0MoJmh2
bS5hbHRwMm0pOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJy
b3JmKCJjb252ZXJ0aW5nIGZpZWxkIEFsdHAyTTogJXYiLCBlcnIpCiAJCX0KIAkJaWYgdG1wLlN5
c3RlbUZpcm13YXJlICE9ICIiIHsKIAkJCWh2bS5zeXN0ZW1fZmlybXdhcmUgPSBDLkNTdHJpbmco
dG1wLlN5c3RlbUZpcm13YXJlKQpAQCAtMTMwMiwyNSArMTMwMiwyNSBAQCBmdW5jICh4ICpEb21h
aW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgKGVyciBlcnJv
cikgewogCQl9CiAJCWh2bS5oZHR5cGUgPSBDLmxpYnhsX2hkdHlwZSh0bXAuSGR0eXBlKQogCQlp
ZiBlcnIgOj0gdG1wLk5vZ3JhcGhpYy50b0MoJmh2bS5ub2dyYXBoaWMpOyBlcnIgIT0gbmlsIHsK
LQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIE5v
Z3JhcGhpYzogJXYiLCBlcnIpCiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5WZ2EudG9DKCZodm0udmdh
KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1cm4gZm10LkVycm9yZigiY29u
dmVydGluZyBmaWVsZCBWZ2E6ICV2IiwgZXJyKQogCQl9CiAJCWlmIGVyciA6PSB0bXAuVm5jLnRv
QygmaHZtLnZuYyk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVm5jOiAldiIsIGVycikKIAkJfQogCQlpZiB0bXAuS2V5
bWFwICE9ICIiIHsKIAkJCWh2bS5rZXltYXAgPSBDLkNTdHJpbmcodG1wLktleW1hcCkKIAkJfQog
CQlpZiBlcnIgOj0gdG1wLlNkbC50b0MoJmh2bS5zZGwpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVy
biBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFNkbDogJXYiLCBl
cnIpCiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5TcGljZS50b0MoJmh2bS5zcGljZSk7IGVyciAhPSBu
aWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgU3BpY2U6ICV2IiwgZXJyKQogCQl9CiAJCWlmIGVyciA6PSB0bXAuR2Z4UGFzc3RocnUudG9D
KCZodm0uZ2Z4X3Bhc3N0aHJ1KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBHZnhQYXNzdGhydTogJXYiLCBlcnIpCiAJ
CX0KIAkJaHZtLmdmeF9wYXNzdGhydV9raW5kID0gQy5saWJ4bF9nZnhfcGFzc3RocnVfa2luZCh0
bXAuR2Z4UGFzc3RocnVLaW5kKQogCQlpZiB0bXAuU2VyaWFsICE9ICIiIHsKQEAgLTEzMzAsMzMg
KzEzMzAsMzMgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSB0b0MoeGMgKkMubGlieGxfZG9t
YWluX2J1aWxkX2luZm8pIChlcnIgZXJyb3IpIHsKIAkJCWh2bS5ib290ID0gQy5DU3RyaW5nKHRt
cC5Cb290KQogCQl9CiAJCWlmIGVyciA6PSB0bXAuVXNiLnRvQygmaHZtLnVzYik7IGVyciAhPSBu
aWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgVXNiOiAldiIsIGVycikKIAkJfQogCQlodm0udXNidmVyc2lvbiA9IEMuaW50KHRtcC5Vc2J2
ZXJzaW9uKQogCQlpZiB0bXAuVXNiZGV2aWNlICE9ICIiIHsKIAkJCWh2bS51c2JkZXZpY2UgPSBD
LkNTdHJpbmcodG1wLlVzYmRldmljZSkKIAkJfQogCQlpZiBlcnIgOj0gdG1wLlZrYkRldmljZS50
b0MoJmh2bS52a2JfZGV2aWNlKTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBWa2JEZXZpY2U6ICV2IiwgZXJyKQogCQl9
CiAJCWlmIHRtcC5Tb3VuZGh3ICE9ICIiIHsKIAkJCWh2bS5zb3VuZGh3ID0gQy5DU3RyaW5nKHRt
cC5Tb3VuZGh3KQogCQl9CiAJCWlmIGVyciA6PSB0bXAuWGVuUGxhdGZvcm1QY2kudG9DKCZodm0u
eGVuX3BsYXRmb3JtX3BjaSk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJu
IGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgWGVuUGxhdGZvcm1QY2k6ICV2IiwgZXJyKQog
CQl9CiAJCWlmIGVyciA6PSB0bXAuVXNiZGV2aWNlTGlzdC50b0MoJmh2bS51c2JkZXZpY2VfbGlz
dCk7IGVyciAhPSBuaWwgewotCQkJcmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNv
bnZlcnRpbmcgZmllbGQgVXNiZGV2aWNlTGlzdDogJXYiLCBlcnIpCiAJCX0KIAkJaHZtLnZlbmRv
cl9kZXZpY2UgPSBDLmxpYnhsX3ZlbmRvcl9kZXZpY2UodG1wLlZlbmRvckRldmljZSkKIAkJaWYg
ZXJyIDo9IHRtcC5Nc1ZtR2VuaWQudG9DKCZodm0ubXNfdm1fZ2VuaWQpOyBlcnIgIT0gbmlsIHsK
LQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIE1z
Vm1HZW5pZDogJXYiLCBlcnIpCiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5TZXJpYWxMaXN0LnRvQygm
aHZtLnNlcmlhbF9saXN0KTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBTZXJpYWxMaXN0OiAldiIsIGVycikKIAkJfQog
CQlpZiBlcnIgOj0gdG1wLlJkbS50b0MoJmh2bS5yZG0pOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVy
biBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFJkbTogJXYiLCBl
cnIpCiAJCX0KIAkJaHZtLnJkbV9tZW1fYm91bmRhcnlfbWVta2IgPSBDLnVpbnQ2NF90KHRtcC5S
ZG1NZW1Cb3VuZGFyeU1lbWtiKQogCQlodm0ubWNhX2NhcHMgPSBDLnVpbnQ2NF90KHRtcC5NY2FD
YXBzKQpAQCAtMTM3Niw3ICsxMzc2LDcgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSB0b0Mo
eGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIChlcnIgZXJyb3IpIHsKIAkJCXB2LmJvb3Rs
b2FkZXIgPSBDLkNTdHJpbmcodG1wLkJvb3Rsb2FkZXIpCiAJCX0KIAkJaWYgZXJyIDo9IHRtcC5C
b290bG9hZGVyQXJncy50b0MoJnB2LmJvb3Rsb2FkZXJfYXJncyk7IGVyciAhPSBuaWwgewotCQkJ
cmV0dXJuIGVycgorCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQm9vdGxv
YWRlckFyZ3M6ICV2IiwgZXJyKQogCQl9CiAJCWlmIHRtcC5DbWRsaW5lICE9ICIiIHsKIAkJCXB2
LmNtZGxpbmUgPSBDLkNTdHJpbmcodG1wLkNtZGxpbmUpCkBAIC0xMzg4LDcgKzEzODgsNyBAQCBm
dW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5m
bykgKGVyciBlcnJvcikgewogCQkJcHYuZmVhdHVyZXMgPSBDLkNTdHJpbmcodG1wLkZlYXR1cmVz
KQogCQl9CiAJCWlmIGVyciA6PSB0bXAuRTgyMEhvc3QudG9DKCZwdi5lODIwX2hvc3QpOyBlcnIg
IT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5n
IGZpZWxkIEU4MjBIb3N0OiAldiIsIGVycikKIAkJfQogCQlwdkJ5dGVzIDo9IEMuR29CeXRlcyh1
bnNhZmUuUG9pbnRlcigmcHYpLCBDLnNpemVvZl9saWJ4bF9kb21haW5fYnVpbGRfaW5mb190eXBl
X3VuaW9uX3B2KQogCQljb3B5KHhjLnVbOl0sIHB2Qnl0ZXMpCkBAIC0xMzk5LDcgKzEzOTksNyBA
QCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mbykgKGVyciBlcnJvcikgewogCQl9CiAJCXZhciBwdmggQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mb190eXBlX3VuaW9uX3B2aAogCQlpZiBlcnIgOj0gdG1wLlB2c2hpbS50b0MoJnB2aC5wdnNo
aW0pOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJj
b252ZXJ0aW5nIGZpZWxkIFB2c2hpbTogJXYiLCBlcnIpCiAJCX0KIAkJaWYgdG1wLlB2c2hpbVBh
dGggIT0gIiIgewogCQkJcHZoLnB2c2hpbV9wYXRoID0gQy5DU3RyaW5nKHRtcC5QdnNoaW1QYXRo
KQpAQCAtMTQyNywxMCArMTQyNywxMCBAQCBmdW5jICh4ICpEZXZpY2VWZmIpIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV92ZmIpIGVycm9yIHsKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmlu
Zyh4Yy5iYWNrZW5kX2RvbW5hbWUpCiAJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQogCWlmIGVy
ciA6PSB4LlZuYy5mcm9tQygmeGMudm5jKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVm5jOiAldiIsIGVycikKIAl9CiAJ
aWYgZXJyIDo9IHguU2RsLmZyb21DKCZ4Yy5zZGwpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVy
cgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBTZGw6ICV2IiwgZXJyKQog
CX0KIAl4LktleW1hcCA9IEMuR29TdHJpbmcoeGMua2V5bWFwKQogCkBAIC0xNDUwLDEwICsxNDUw
LDEwIEBAIGZ1bmMgKHggKkRldmljZVZmYikgdG9DKHhjICpDLmxpYnhsX2RldmljZV92ZmIpIChl
cnIgZXJyb3IpIHsKIAl9CiAJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCiAJaWYg
ZXJyIDo9IHguVm5jLnRvQygmeGMudm5jKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJ
cmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVm5jOiAldiIsIGVycikKIAl9CiAJ
aWYgZXJyIDo9IHguU2RsLnRvQygmeGMuc2RsKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIK
KwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgU2RsOiAldiIsIGVycikKIAl9
CiAJaWYgeC5LZXltYXAgIT0gIiIgewogCQl4Yy5rZXltYXAgPSBDLkNTdHJpbmcoeC5LZXltYXAp
CkBAIC0xNTI1LDEzICsxNTI1LDEzIEBAIGZ1bmMgKHggKkRldmljZURpc2spIGZyb21DKHhjICpD
LmxpYnhsX2RldmljZV9kaXNrKSBlcnJvciB7CiAJeC5Jc0Nkcm9tID0gaW50KHhjLmlzX2Nkcm9t
KQogCXguRGlyZWN0SW9TYWZlID0gYm9vbCh4Yy5kaXJlY3RfaW9fc2FmZSkKIAlpZiBlcnIgOj0g
eC5EaXNjYXJkRW5hYmxlLmZyb21DKCZ4Yy5kaXNjYXJkX2VuYWJsZSk7IGVyciAhPSBuaWwgewot
CQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIERpc2Nh
cmRFbmFibGU6ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5Db2xvRW5hYmxlLmZyb21DKCZ4
Yy5jb2xvX2VuYWJsZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENvbG9FbmFibGU6ICV2IiwgZXJyKQogCX0KIAlpZiBl
cnIgOj0geC5Db2xvUmVzdG9yZUVuYWJsZS5mcm9tQygmeGMuY29sb19yZXN0b3JlX2VuYWJsZSk7
IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0
aW5nIGZpZWxkIENvbG9SZXN0b3JlRW5hYmxlOiAldiIsIGVycikKIAl9CiAJeC5Db2xvSG9zdCA9
IEMuR29TdHJpbmcoeGMuY29sb19ob3N0KQogCXguQ29sb1BvcnQgPSBpbnQoeGMuY29sb19wb3J0
KQpAQCAtMTU2OSwxMyArMTU2OSwxMyBAQCBmdW5jICh4ICpEZXZpY2VEaXNrKSB0b0MoeGMgKkMu
bGlieGxfZGV2aWNlX2Rpc2spIChlcnIgZXJyb3IpIHsKIAl4Yy5pc19jZHJvbSA9IEMuaW50KHgu
SXNDZHJvbSkKIAl4Yy5kaXJlY3RfaW9fc2FmZSA9IEMuYm9vbCh4LkRpcmVjdElvU2FmZSkKIAlp
ZiBlcnIgOj0geC5EaXNjYXJkRW5hYmxlLnRvQygmeGMuZGlzY2FyZF9lbmFibGUpOyBlcnIgIT0g
bmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCBEaXNjYXJkRW5hYmxlOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQ29sb0VuYWJsZS50
b0MoJnhjLmNvbG9fZW5hYmxlKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJu
IGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ29sb0VuYWJsZTogJXYiLCBlcnIpCiAJfQog
CWlmIGVyciA6PSB4LkNvbG9SZXN0b3JlRW5hYmxlLnRvQygmeGMuY29sb19yZXN0b3JlX2VuYWJs
ZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252
ZXJ0aW5nIGZpZWxkIENvbG9SZXN0b3JlRW5hYmxlOiAldiIsIGVycikKIAl9CiAJaWYgeC5Db2xv
SG9zdCAhPSAiIiB7CiAJCXhjLmNvbG9faG9zdCA9IEMuQ1N0cmluZyh4LkNvbG9Ib3N0KQpAQCAt
MTYwMSw3ICsxNjAxLDcgQEAgZnVuYyAoeCAqRGV2aWNlTmljKSBmcm9tQyh4YyAqQy5saWJ4bF9k
ZXZpY2VfbmljKSBlcnJvciB7CiAJeC5NdHUgPSBpbnQoeGMubXR1KQogCXguTW9kZWwgPSBDLkdv
U3RyaW5nKHhjLm1vZGVsKQogCWlmIGVyciA6PSB4Lk1hYy5mcm9tQygmeGMubWFjKTsgZXJyICE9
IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgTWFjOiAldiIsIGVycikKIAl9CiAJeC5JcCA9IEMuR29TdHJpbmcoeGMuaXApCiAJeC5Ccmlk
Z2UgPSBDLkdvU3RyaW5nKHhjLmJyaWRnZSkKQEAgLTE2ODEsNyArMTY4MSw3IEBAIGZ1bmMgKHgg
KkRldmljZU5pYykgdG9DKHhjICpDLmxpYnhsX2RldmljZV9uaWMpIChlcnIgZXJyb3IpIHsKIAkJ
eGMubW9kZWwgPSBDLkNTdHJpbmcoeC5Nb2RlbCkKIAl9CiAJaWYgZXJyIDo9IHguTWFjLnRvQygm
eGMubWFjKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgTWFjOiAldiIsIGVycikKIAl9CiAJaWYgeC5JcCAhPSAiIiB7CiAJ
CXhjLmlwID0gQy5DU3RyaW5nKHguSXApCkBAIC0xOTUwLDcgKzE5NTAsNyBAQCBmdW5jICh4ICpE
ZXZpY2VVc2JkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JkZXYpIGVycm9yIHsKIAlj
YXNlIFVzYmRldlR5cGVIb3N0ZGV2OgogCQl2YXIgdHlwZUhvc3RkZXYgRGV2aWNlVXNiZGV2VHlw
ZVVuaW9uSG9zdGRldgogCQlpZiBlcnIgOj0gdHlwZUhvc3RkZXYuZnJvbUMoeGMpOyBlcnIgIT0g
bmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZp
ZWxkIHR5cGVIb3N0ZGV2OiAldiIsIGVycikKIAkJfQogCQl4LlR5cGVVbmlvbiA9IHR5cGVIb3N0
ZGV2CiAJZGVmYXVsdDoKQEAgLTIwMjQsNyArMjAyNCw3IEBAIGZ1bmMgKHggKkRldmljZVZ0cG0p
IGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9tbmFt
ZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQogCXguRGV2aWQgPSBEZXZpZCh4Yy5k
ZXZpZCkKIAlpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7Ci0J
CXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVXVpZDog
JXYiLCBlcnIpCiAJfQogCiAJcmV0dXJuIG5pbApAQCAtMjA0Myw3ICsyMDQzLDcgQEAgZnVuYyAo
eCAqRGV2aWNlVnRwbSkgdG9DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSAoZXJyIGVycm9yKSB7
CiAJfQogCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQogCWlmIGVyciA6PSB4LlV1
aWQudG9DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZt
dC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgVXVpZDogJXYiLCBlcnIpCiAJfQogCiAJcmV0dXJu
IG5pbApAQCAtMjExOSw3ICsyMTE5LDcgQEAgZnVuYyAoeCAqRGV2aWNlQ2hhbm5lbCkgZnJvbUMo
eGMgKkMubGlieGxfZGV2aWNlX2NoYW5uZWwpIGVycm9yIHsKIAljYXNlIENoYW5uZWxDb25uZWN0
aW9uU29ja2V0OgogCQl2YXIgY29ubmVjdGlvblNvY2tldCBEZXZpY2VDaGFubmVsQ29ubmVjdGlv
blVuaW9uU29ja2V0CiAJCWlmIGVyciA6PSBjb25uZWN0aW9uU29ja2V0LmZyb21DKHhjKTsgZXJy
ICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCisJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBjb25uZWN0aW9uU29ja2V0OiAldiIsIGVycikKIAkJfQogCQl4LkNvbm5lY3Rpb25V
bmlvbiA9IGNvbm5lY3Rpb25Tb2NrZXQKIAlkZWZhdWx0OgpAQCAtMjIwOSw3ICsyMjA5LDcgQEAg
ZnVuYyAoeCAqRGV2aWNlVmRpc3BsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmRpc3BsKSBl
cnJvciB7CiAJCXguQ29ubmVjdG9ycyA9IG1ha2UoW11Db25uZWN0b3JQYXJhbSwgbnVtQ29ubmVj
dG9ycykKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY0Nvbm5lY3RvcnMgewogCQkJaWYgZXJyIDo9IHgu
Q29ubmVjdG9yc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJ
CQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDb25uZWN0b3JzOiAldiIsIGVy
cikKIAkJCX0KIAkJfQogCX0KQEAgLTIyMzYsNyArMjIzNiw3IEBAIGZ1bmMgKHggKkRldmljZVZk
aXNwbCkgdG9DKHhjICpDLmxpYnhsX2RldmljZV92ZGlzcGwpIChlcnIgZXJyb3IpIHsKIAkJY0Nv
bm5lY3RvcnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbSkodW5zYWZlLlBv
aW50ZXIoeGMuY29ubmVjdG9ycykpWzpudW1Db25uZWN0b3JzOm51bUNvbm5lY3RvcnNdCiAJCWZv
ciBpLCB2IDo9IHJhbmdlIHguQ29ubmVjdG9ycyB7CiAJCQlpZiBlcnIgOj0gdi50b0MoJmNDb25u
ZWN0b3JzW2ldKTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENvbm5lY3RvcnM6ICV2IiwgZXJyKQogCQkJfQogCQl9
CiAJfQpAQCAtMjMwMiw3ICsyMzAyLDcgQEAgZnVuYyAoeCAqVnNuZFN0cmVhbSkgZnJvbUMoeGMg
KkMubGlieGxfdnNuZF9zdHJlYW0pIGVycm9yIHsKIAl4LlVuaXF1ZUlkID0gQy5Hb1N0cmluZyh4
Yy51bmlxdWVfaWQpCiAJeC5UeXBlID0gVnNuZFN0cmVhbVR5cGUoeGMuX3R5cGUpCiAJaWYgZXJy
IDo9IHguUGFyYW1zLmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVy
cgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQYXJhbXM6ICV2IiwgZXJy
KQogCX0KIAogCXJldHVybiBuaWwKQEAgLTIzMjAsNyArMjMyMCw3IEBAIGZ1bmMgKHggKlZzbmRT
dHJlYW0pIHRvQyh4YyAqQy5saWJ4bF92c25kX3N0cmVhbSkgKGVyciBlcnJvcikgewogCX0KIAl4
Yy5fdHlwZSA9IEMubGlieGxfdnNuZF9zdHJlYW1fdHlwZSh4LlR5cGUpCiAJaWYgZXJyIDo9IHgu
UGFyYW1zLnRvQygmeGMucGFyYW1zKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUGFyYW1zOiAldiIsIGVycikKIAl9CiAK
IAlyZXR1cm4gbmlsCkBAIC0yMzI5LDcgKzIzMjksNyBAQCBmdW5jICh4ICpWc25kU3RyZWFtKSB0
b0MoeGMgKkMubGlieGxfdnNuZF9zdHJlYW0pIChlcnIgZXJyb3IpIHsKIGZ1bmMgKHggKlZzbmRQ
Y20pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSBlcnJvciB7CiAJeC5OYW1lID0gQy5Hb1N0
cmluZyh4Yy5uYW1lKQogCWlmIGVyciA6PSB4LlBhcmFtcy5mcm9tQygmeGMucGFyYW1zKTsgZXJy
ICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgUGFyYW1zOiAldiIsIGVycikKIAl9CiAJeC5TdHJlYW1zID0gbmlsCiAJaWYgbnVtVnNu
ZFN0cmVhbXMgOj0gaW50KHhjLm51bV92c25kX3N0cmVhbXMpOyBudW1Wc25kU3RyZWFtcyA+IDAg
ewpAQCAtMjMzNyw3ICsyMzM3LDcgQEAgZnVuYyAoeCAqVnNuZFBjbSkgZnJvbUMoeGMgKkMubGli
eGxfdnNuZF9wY20pIGVycm9yIHsKIAkJeC5TdHJlYW1zID0gbWFrZShbXVZzbmRTdHJlYW0sIG51
bVZzbmRTdHJlYW1zKQogCQlmb3IgaSwgdiA6PSByYW5nZSBjU3RyZWFtcyB7CiAJCQlpZiBlcnIg
Oj0geC5TdHJlYW1zW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgor
CQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFN0cmVhbXM6ICV2IiwgZXJy
KQogCQkJfQogCQl9CiAJfQpAQCAtMjM1Niw3ICsyMzU2LDcgQEAgZnVuYyAoeCAqVnNuZFBjbSkg
dG9DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSAoZXJyIGVycm9yKSB7CiAJCXhjLm5hbWUgPSBDLkNT
dHJpbmcoeC5OYW1lKQogCX0KIAlpZiBlcnIgOj0geC5QYXJhbXMudG9DKCZ4Yy5wYXJhbXMpOyBl
cnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBQYXJhbXM6ICV2IiwgZXJyKQogCX0KIAlpZiBudW1Wc25kU3RyZWFtcyA6PSBsZW4o
eC5TdHJlYW1zKTsgbnVtVnNuZFN0cmVhbXMgPiAwIHsKIAkJeGMuc3RyZWFtcyA9ICgqQy5saWJ4
bF92c25kX3N0cmVhbSkoQy5tYWxsb2MoQy51bG9uZyhudW1Wc25kU3RyZWFtcykgKiBDLnNpemVv
Zl9saWJ4bF92c25kX3N0cmVhbSkpCkBAIC0yMzY0LDcgKzIzNjQsNyBAQCBmdW5jICh4ICpWc25k
UGNtKSB0b0MoeGMgKkMubGlieGxfdnNuZF9wY20pIChlcnIgZXJyb3IpIHsKIAkJY1N0cmVhbXMg
Oj0gKCpbMSA8PCAyOF1DLmxpYnhsX3ZzbmRfc3RyZWFtKSh1bnNhZmUuUG9pbnRlcih4Yy5zdHJl
YW1zKSlbOm51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJlYW1zXQogCQlmb3IgaSwgdiA6PSByYW5n
ZSB4LlN0cmVhbXMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjU3RyZWFtc1tpXSk7IGVyciAhPSBu
aWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBm
aWVsZCBTdHJlYW1zOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTIzNzksNyArMjM3OSw3
IEBAIGZ1bmMgKHggKkRldmljZVZzbmQpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92c25kKSBl
cnJvciB7CiAJeC5TaG9ydE5hbWUgPSBDLkdvU3RyaW5nKHhjLnNob3J0X25hbWUpCiAJeC5Mb25n
TmFtZSA9IEMuR29TdHJpbmcoeGMubG9uZ19uYW1lKQogCWlmIGVyciA6PSB4LlBhcmFtcy5mcm9t
QygmeGMucGFyYW1zKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5F
cnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUGFyYW1zOiAldiIsIGVycikKIAl9CiAJeC5QY21zID0g
bmlsCiAJaWYgbnVtVnNuZFBjbXMgOj0gaW50KHhjLm51bV92c25kX3BjbXMpOyBudW1Wc25kUGNt
cyA+IDAgewpAQCAtMjM4Nyw3ICsyMzg3LDcgQEAgZnVuYyAoeCAqRGV2aWNlVnNuZCkgZnJvbUMo
eGMgKkMubGlieGxfZGV2aWNlX3ZzbmQpIGVycm9yIHsKIAkJeC5QY21zID0gbWFrZShbXVZzbmRQ
Y20sIG51bVZzbmRQY21zKQogCQlmb3IgaSwgdiA6PSByYW5nZSBjUGNtcyB7CiAJCQlpZiBlcnIg
Oj0geC5QY21zW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFBjbXM6ICV2IiwgZXJyKQogCQkJ
fQogCQl9CiAJfQpAQCAtMjQxNCw3ICsyNDE0LDcgQEAgZnVuYyAoeCAqRGV2aWNlVnNuZCkgdG9D
KHhjICpDLmxpYnhsX2RldmljZV92c25kKSAoZXJyIGVycm9yKSB7CiAJCXhjLmxvbmdfbmFtZSA9
IEMuQ1N0cmluZyh4LkxvbmdOYW1lKQogCX0KIAlpZiBlcnIgOj0geC5QYXJhbXMudG9DKCZ4Yy5w
YXJhbXMpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCBQYXJhbXM6ICV2IiwgZXJyKQogCX0KIAlpZiBudW1Wc25kUGNtcyA6
PSBsZW4oeC5QY21zKTsgbnVtVnNuZFBjbXMgPiAwIHsKIAkJeGMucGNtcyA9ICgqQy5saWJ4bF92
c25kX3BjbSkoQy5tYWxsb2MoQy51bG9uZyhudW1Wc25kUGNtcykgKiBDLnNpemVvZl9saWJ4bF92
c25kX3BjbSkpCkBAIC0yNDIyLDcgKzI0MjIsNyBAQCBmdW5jICh4ICpEZXZpY2VWc25kKSB0b0Mo
eGMgKkMubGlieGxfZGV2aWNlX3ZzbmQpIChlcnIgZXJyb3IpIHsKIAkJY1BjbXMgOj0gKCpbMSA8
PCAyOF1DLmxpYnhsX3ZzbmRfcGNtKSh1bnNhZmUuUG9pbnRlcih4Yy5wY21zKSlbOm51bVZzbmRQ
Y21zOm51bVZzbmRQY21zXQogCQlmb3IgaSwgdiA6PSByYW5nZSB4LlBjbXMgewogCQkJaWYgZXJy
IDo9IHYudG9DKCZjUGNtc1tpXSk7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQY21zOiAldiIsIGVycikKIAkJCX0K
IAkJfQogCX0KQEAgLTI0MzIsMTAgKzI0MzIsMTAgQEAgZnVuYyAoeCAqRGV2aWNlVnNuZCkgdG9D
KHhjICpDLmxpYnhsX2RldmljZV92c25kKSAoZXJyIGVycm9yKSB7CiAKIGZ1bmMgKHggKkRvbWFp
bkNvbmZpZykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCWlmIGVy
ciA6PSB4LkNJbmZvLmZyb21DKCZ4Yy5jX2luZm8pOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVy
cgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDSW5mbzogJXYiLCBlcnIp
CiAJfQogCWlmIGVyciA6PSB4LkJJbmZvLmZyb21DKCZ4Yy5iX2luZm8pOyBlcnIgIT0gbmlsIHsK
LQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBCSW5m
bzogJXYiLCBlcnIpCiAJfQogCXguRGlza3MgPSBuaWwKIAlpZiBudW1EaXNrcyA6PSBpbnQoeGMu
bnVtX2Rpc2tzKTsgbnVtRGlza3MgPiAwIHsKQEAgLTI0NDMsNyArMjQ0Myw3IEBAIGZ1bmMgKHgg
KkRvbWFpbkNvbmZpZykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3Igewog
CQl4LkRpc2tzID0gbWFrZShbXURldmljZURpc2ssIG51bURpc2tzKQogCQlmb3IgaSwgdiA6PSBy
YW5nZSBjRGlza3MgewogCQkJaWYgZXJyIDo9IHguRGlza3NbaV0uZnJvbUMoJnYpOyBlcnIgIT0g
bmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgRGlza3M6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjQ1Myw3ICsyNDUzLDcg
QEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmln
KSBlcnJvciB7CiAJCXguTmljcyA9IG1ha2UoW11EZXZpY2VOaWMsIG51bU5pY3MpCiAJCWZvciBp
LCB2IDo9IHJhbmdlIGNOaWNzIHsKIAkJCWlmIGVyciA6PSB4Lk5pY3NbaV0uZnJvbUMoJnYpOyBl
cnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgTmljczogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC0yNDYzLDcgKzI0
NjMsNyBAQCBmdW5jICh4ICpEb21haW5Db25maWcpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9j
b25maWcpIGVycm9yIHsKIAkJeC5QY2lkZXZzID0gbWFrZShbXURldmljZVBjaSwgbnVtUGNpZGV2
cykKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY1BjaWRldnMgewogCQkJaWYgZXJyIDo9IHguUGNpZGV2
c1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQY2lkZXZzOiAldiIsIGVycikKIAkJCX0KIAkJ
fQogCX0KQEAgLTI0NzMsNyArMjQ3Myw3IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJvbUMo
eGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCQl4LlJkbXMgPSBtYWtlKFtdRGV2
aWNlUmRtLCBudW1SZG1zKQogCQlmb3IgaSwgdiA6PSByYW5nZSBjUmRtcyB7CiAJCQlpZiBlcnIg
Oj0geC5SZG1zW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFJkbXM6ICV2IiwgZXJyKQogCQkJ
fQogCQl9CiAJfQpAQCAtMjQ4Myw3ICsyNDgzLDcgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSBm
cm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJvciB7CiAJCXguRHRkZXZzID0gbWFr
ZShbXURldmljZUR0ZGV2LCBudW1EdGRldnMpCiAJCWZvciBpLCB2IDo9IHJhbmdlIGNEdGRldnMg
ewogCQkJaWYgZXJyIDo9IHguRHRkZXZzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJ
cmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIER0ZGV2
czogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC0yNDkzLDcgKzI0OTMsNyBAQCBmdW5jICh4
ICpEb21haW5Db25maWcpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIGVycm9yIHsK
IAkJeC5WZmJzID0gbWFrZShbXURldmljZVZmYiwgbnVtVmZicykKIAkJZm9yIGksIHYgOj0gcmFu
Z2UgY1ZmYnMgewogCQkJaWYgZXJyIDo9IHguVmZic1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwg
ewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCBWZmJzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI1MDMsNyArMjUwMyw3IEBAIGZ1
bmMgKHggKkRvbWFpbkNvbmZpZykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJy
b3IgewogCQl4LlZrYnMgPSBtYWtlKFtdRGV2aWNlVmtiLCBudW1Wa2JzKQogCQlmb3IgaSwgdiA6
PSByYW5nZSBjVmticyB7CiAJCQlpZiBlcnIgOj0geC5Wa2JzW2ldLmZyb21DKCZ2KTsgZXJyICE9
IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5n
IGZpZWxkIFZrYnM6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjUxMyw3ICsyNTEzLDcg
QEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmln
KSBlcnJvciB7CiAJCXguVnRwbXMgPSBtYWtlKFtdRGV2aWNlVnRwbSwgbnVtVnRwbXMpCiAJCWZv
ciBpLCB2IDo9IHJhbmdlIGNWdHBtcyB7CiAJCQlpZiBlcnIgOj0geC5WdHBtc1tpXS5mcm9tQygm
dik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCBWdHBtczogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC0yNTIz
LDcgKzI1MjMsNyBAQCBmdW5jICh4ICpEb21haW5Db25maWcpIGZyb21DKHhjICpDLmxpYnhsX2Rv
bWFpbl9jb25maWcpIGVycm9yIHsKIAkJeC5QOVMgPSBtYWtlKFtdRGV2aWNlUDksIG51bVA5UykK
IAkJZm9yIGksIHYgOj0gcmFuZ2UgY1A5UyB7CiAJCQlpZiBlcnIgOj0geC5QOVNbaV0uZnJvbUMo
JnYpOyBlcnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgUDlTOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI1MzMs
NyArMjUzMyw3IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJvbUMoeGMgKkMubGlieGxfZG9t
YWluX2NvbmZpZykgZXJyb3IgewogCQl4LlB2Y2FsbHNpZnMgPSBtYWtlKFtdRGV2aWNlUHZjYWxs
c2lmLCBudW1QdmNhbGxzaWZzKQogCQlmb3IgaSwgdiA6PSByYW5nZSBjUHZjYWxsc2lmcyB7CiAJ
CQlpZiBlcnIgOj0geC5QdmNhbGxzaWZzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJ
cmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFB2Y2Fs
bHNpZnM6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjU0Myw3ICsyNTQzLDcgQEAgZnVu
YyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJv
ciB7CiAJCXguVmRpc3BscyA9IG1ha2UoW11EZXZpY2VWZGlzcGwsIG51bVZkaXNwbHMpCiAJCWZv
ciBpLCB2IDo9IHJhbmdlIGNWZGlzcGxzIHsKIAkJCWlmIGVyciA6PSB4LlZkaXNwbHNbaV0uZnJv
bUMoJnYpOyBlcnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJv
cmYoImNvbnZlcnRpbmcgZmllbGQgVmRpc3BsczogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBA
IC0yNTUzLDcgKzI1NTMsNyBAQCBmdW5jICh4ICpEb21haW5Db25maWcpIGZyb21DKHhjICpDLmxp
YnhsX2RvbWFpbl9jb25maWcpIGVycm9yIHsKIAkJeC5Wc25kcyA9IG1ha2UoW11EZXZpY2VWc25k
LCBudW1Wc25kcykKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY1ZzbmRzIHsKIAkJCWlmIGVyciA6PSB4
LlZzbmRzW2ldLmZyb21DKCZ2KTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFZzbmRzOiAldiIsIGVycikKIAkJCX0K
IAkJfQogCX0KQEAgLTI1NjMsNyArMjU2Myw3IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJv
bUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCQl4LkNoYW5uZWxzID0gbWFr
ZShbXURldmljZUNoYW5uZWwsIG51bUNoYW5uZWxzKQogCQlmb3IgaSwgdiA6PSByYW5nZSBjQ2hh
bm5lbHMgewogCQkJaWYgZXJyIDo9IHguQ2hhbm5lbHNbaV0uZnJvbUMoJnYpOyBlcnIgIT0gbmls
IHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmll
bGQgQ2hhbm5lbHM6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjU3Myw3ICsyNTczLDcg
QEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmln
KSBlcnJvciB7CiAJCXguVXNiY3RybHMgPSBtYWtlKFtdRGV2aWNlVXNiY3RybCwgbnVtVXNiY3Ry
bHMpCiAJCWZvciBpLCB2IDo9IHJhbmdlIGNVc2JjdHJscyB7CiAJCQlpZiBlcnIgOj0geC5Vc2Jj
dHJsc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1
cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBVc2JjdHJsczogJXYiLCBlcnIpCiAJCQl9
CiAJCX0KIAl9CkBAIC0yNTgzLDcgKzI1ODMsNyBAQCBmdW5jICh4ICpEb21haW5Db25maWcpIGZy
b21DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIGVycm9yIHsKIAkJeC5Vc2JkZXZzID0gbWFr
ZShbXURldmljZVVzYmRldiwgbnVtVXNiZGV2cykKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY1VzYmRl
dnMgewogCQkJaWYgZXJyIDo9IHguVXNiZGV2c1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewot
CQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBV
c2JkZXZzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI2MDQsMTAgKzI2MDQsMTAgQEAg
ZnVuYyAoeCAqRG9tYWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgKGVy
ciBlcnJvcikgewogCX0oKQogCiAJaWYgZXJyIDo9IHguQ0luZm8udG9DKCZ4Yy5jX2luZm8pOyBl
cnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBDSW5mbzogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LkJJbmZvLnRvQygmeGMu
Yl9pbmZvKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgQkluZm86ICV2IiwgZXJyKQogCX0KIAlpZiBudW1EaXNrcyA6PSBs
ZW4oeC5EaXNrcyk7IG51bURpc2tzID4gMCB7CiAJCXhjLmRpc2tzID0gKCpDLmxpYnhsX2Rldmlj
ZV9kaXNrKShDLm1hbGxvYyhDLnVsb25nKG51bURpc2tzKSAqIEMuc2l6ZW9mX2xpYnhsX2Rldmlj
ZV9kaXNrKSkKQEAgLTI2MTUsNyArMjYxNSw3IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgdG9D
KHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIChlcnIgZXJyb3IpIHsKIAkJY0Rpc2tzIDo9ICgq
WzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfZGlzaykodW5zYWZlLlBvaW50ZXIoeGMuZGlza3MpKVs6
bnVtRGlza3M6bnVtRGlza3NdCiAJCWZvciBpLCB2IDo9IHJhbmdlIHguRGlza3MgewogCQkJaWYg
ZXJyIDo9IHYudG9DKCZjRGlza3NbaV0pOyBlcnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJ
CQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRGlza3M6ICV2IiwgZXJyKQog
CQkJfQogCQl9CiAJfQpAQCAtMjYyNSw3ICsyNjI1LDcgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmln
KSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgKGVyciBlcnJvcikgewogCQljTmljcyA6
PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX25pYykodW5zYWZlLlBvaW50ZXIoeGMubmljcykp
WzpudW1OaWNzOm51bU5pY3NdCiAJCWZvciBpLCB2IDo9IHJhbmdlIHguTmljcyB7CiAJCQlpZiBl
cnIgOj0gdi50b0MoJmNOaWNzW2ldKTsgZXJyICE9IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIE5pY3M6ICV2IiwgZXJyKQogCQkJ
fQogCQl9CiAJfQpAQCAtMjYzNSw3ICsyNjM1LDcgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSB0
b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgKGVyciBlcnJvcikgewogCQljUGNpZGV2cyA6
PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3BjaSkodW5zYWZlLlBvaW50ZXIoeGMucGNpZGV2
cykpWzpudW1QY2lkZXZzOm51bVBjaWRldnNdCiAJCWZvciBpLCB2IDo9IHJhbmdlIHguUGNpZGV2
cyB7CiAJCQlpZiBlcnIgOj0gdi50b0MoJmNQY2lkZXZzW2ldKTsgZXJyICE9IG5pbCB7Ci0JCQkJ
cmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFBjaWRl
dnM6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjY0NSw3ICsyNjQ1LDcgQEAgZnVuYyAo
eCAqRG9tYWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgKGVyciBlcnJv
cikgewogCQljUmRtcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3JkbSkodW5zYWZlLlBv
aW50ZXIoeGMucmRtcykpWzpudW1SZG1zOm51bVJkbXNdCiAJCWZvciBpLCB2IDo9IHJhbmdlIHgu
UmRtcyB7CiAJCQlpZiBlcnIgOj0gdi50b0MoJmNSZG1zW2ldKTsgZXJyICE9IG5pbCB7Ci0JCQkJ
cmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFJkbXM6
ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjY1NSw3ICsyNjU1LDcgQEAgZnVuYyAoeCAq
RG9tYWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgKGVyciBlcnJvcikg
ewogCQljRHRkZXZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfZHRkZXYpKHVuc2FmZS5Q
b2ludGVyKHhjLmR0ZGV2cykpWzpudW1EdGRldnM6bnVtRHRkZXZzXQogCQlmb3IgaSwgdiA6PSBy
YW5nZSB4LkR0ZGV2cyB7CiAJCQlpZiBlcnIgOj0gdi50b0MoJmNEdGRldnNbaV0pOyBlcnIgIT0g
bmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgRHRkZXZzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI2NjUsNyArMjY2NSw3
IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcp
IChlcnIgZXJyb3IpIHsKIAkJY1ZmYnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV92ZmIp
KHVuc2FmZS5Qb2ludGVyKHhjLnZmYnMpKVs6bnVtVmZiczpudW1WZmJzXQogCQlmb3IgaSwgdiA6
PSByYW5nZSB4LlZmYnMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjVmZic1tpXSk7IGVyciAhPSBu
aWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBm
aWVsZCBWZmJzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI2NzUsNyArMjY3NSw3IEBA
IGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIChl
cnIgZXJyb3IpIHsKIAkJY1ZrYnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV92a2IpKHVu
c2FmZS5Qb2ludGVyKHhjLnZrYnMpKVs6bnVtVmticzpudW1Wa2JzXQogCQlmb3IgaSwgdiA6PSBy
YW5nZSB4LlZrYnMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjVmtic1tpXSk7IGVyciAhPSBuaWwg
ewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCBWa2JzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI2ODUsNyArMjY4NSw3IEBAIGZ1
bmMgKHggKkRvbWFpbkNvbmZpZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIChlcnIg
ZXJyb3IpIHsKIAkJY1Z0cG1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdnRwbSkodW5z
YWZlLlBvaW50ZXIoeGMudnRwbXMpKVs6bnVtVnRwbXM6bnVtVnRwbXNdCiAJCWZvciBpLCB2IDo9
IHJhbmdlIHguVnRwbXMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjVnRwbXNbaV0pOyBlcnIgIT0g
bmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgVnRwbXM6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjY5NSw3ICsyNjk1LDcg
QEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykg
KGVyciBlcnJvcikgewogCQljUDlTIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfcDkpKHVu
c2FmZS5Qb2ludGVyKHhjLnA5cykpWzpudW1QOVM6bnVtUDlTXQogCQlmb3IgaSwgdiA6PSByYW5n
ZSB4LlA5UyB7CiAJCQlpZiBlcnIgOj0gdi50b0MoJmNQOVNbaV0pOyBlcnIgIT0gbmlsIHsKLQkJ
CQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgUDlT
OiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI3MDUsNyArMjcwNSw3IEBAIGZ1bmMgKHgg
KkRvbWFpbkNvbmZpZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIChlcnIgZXJyb3Ip
IHsKIAkJY1B2Y2FsbHNpZnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV9wdmNhbGxzaWYp
KHVuc2FmZS5Qb2ludGVyKHhjLnB2Y2FsbHNpZnMpKVs6bnVtUHZjYWxsc2lmczpudW1QdmNhbGxz
aWZzXQogCQlmb3IgaSwgdiA6PSByYW5nZSB4LlB2Y2FsbHNpZnMgewogCQkJaWYgZXJyIDo9IHYu
dG9DKCZjUHZjYWxsc2lmc1tpXSk7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBQdmNhbGxzaWZzOiAldiIsIGVycikK
IAkJCX0KIAkJfQogCX0KQEAgLTI3MTUsNyArMjcxNSw3IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZp
ZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIChlcnIgZXJyb3IpIHsKIAkJY1ZkaXNw
bHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2RldmljZV92ZGlzcGwpKHVuc2FmZS5Qb2ludGVyKHhj
LnZkaXNwbHMpKVs6bnVtVmRpc3BsczpudW1WZGlzcGxzXQogCQlmb3IgaSwgdiA6PSByYW5nZSB4
LlZkaXNwbHMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjVmRpc3Bsc1tpXSk7IGVyciAhPSBuaWwg
ewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCBWZGlzcGxzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI3MjUsNyArMjcyNSw3IEBA
IGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25maWcpIChl
cnIgZXJyb3IpIHsKIAkJY1ZzbmRzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdnNuZCko
dW5zYWZlLlBvaW50ZXIoeGMudnNuZHMpKVs6bnVtVnNuZHM6bnVtVnNuZHNdCiAJCWZvciBpLCB2
IDo9IHJhbmdlIHguVnNuZHMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjVnNuZHNbaV0pOyBlcnIg
IT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgVnNuZHM6ICV2IiwgZXJyKQogCQkJfQogCQl9CiAJfQpAQCAtMjczNSw3ICsyNzM1
LDcgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX2NvbmZp
ZykgKGVyciBlcnJvcikgewogCQljQ2hhbm5lbHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2Rldmlj
ZV9jaGFubmVsKSh1bnNhZmUuUG9pbnRlcih4Yy5jaGFubmVscykpWzpudW1DaGFubmVsczpudW1D
aGFubmVsc10KIAkJZm9yIGksIHYgOj0gcmFuZ2UgeC5DaGFubmVscyB7CiAJCQlpZiBlcnIgOj0g
di50b0MoJmNDaGFubmVsc1tpXSk7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDaGFubmVsczogJXYiLCBlcnIpCiAJ
CQl9CiAJCX0KIAl9CkBAIC0yNzQ1LDcgKzI3NDUsNyBAQCBmdW5jICh4ICpEb21haW5Db25maWcp
IHRvQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSAoZXJyIGVycm9yKSB7CiAJCWNVc2JjdHJs
cyA6PSAoKlsxIDw8IDI4XUMubGlieGxfZGV2aWNlX3VzYmN0cmwpKHVuc2FmZS5Qb2ludGVyKHhj
LnVzYmN0cmxzKSlbOm51bVVzYmN0cmxzOm51bVVzYmN0cmxzXQogCQlmb3IgaSwgdiA6PSByYW5n
ZSB4LlVzYmN0cmxzIHsKIAkJCWlmIGVyciA6PSB2LnRvQygmY1VzYmN0cmxzW2ldKTsgZXJyICE9
IG5pbCB7Ci0JCQkJcmV0dXJuIGVycgorCQkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5n
IGZpZWxkIFVzYmN0cmxzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTI3NTUsNyArMjc1
NSw3IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9jb25m
aWcpIChlcnIgZXJyb3IpIHsKIAkJY1VzYmRldnMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX2Rldmlj
ZV91c2JkZXYpKHVuc2FmZS5Qb2ludGVyKHhjLnVzYmRldnMpKVs6bnVtVXNiZGV2czpudW1Vc2Jk
ZXZzXQogCQlmb3IgaSwgdiA6PSByYW5nZSB4LlVzYmRldnMgewogCQkJaWYgZXJyIDo9IHYudG9D
KCZjVXNiZGV2c1tpXSk7IGVyciAhPSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBVc2JkZXZzOiAldiIsIGVycikKIAkJCX0KIAkJ
fQogCX0KQEAgLTI4NTIsNyArMjg1Miw3IEBAIGZ1bmMgKHggKlZ0cG1pbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF92dHBtaW5mbykgZXJyb3IgewogCXguRXZ0Y2ggPSBpbnQoeGMuZXZ0Y2gpCiAJeC5S
cmVmID0gaW50KHhjLnJyZWYpCiAJaWYgZXJyIDo9IHguVXVpZC5mcm9tQygmeGMudXVpZCk7IGVy
ciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5n
IGZpZWxkIFV1aWQ6ICV2IiwgZXJyKQogCX0KIAogCXJldHVybiBuaWwKQEAgLTI4NzgsNyArMjg3
OCw3IEBAIGZ1bmMgKHggKlZ0cG1pbmZvKSB0b0MoeGMgKkMubGlieGxfdnRwbWluZm8pIChlcnIg
ZXJyb3IpIHsKIAl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0Y2gpCiAJeGMucnJlZiA9IEMuaW50KHgu
UnJlZikKIAlpZiBlcnIgOj0geC5VdWlkLnRvQygmeGMudXVpZCk7IGVyciAhPSBuaWwgewotCQly
ZXR1cm4gZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIFV1aWQ6ICV2
IiwgZXJyKQogCX0KIAogCXJldHVybiBuaWwKQEAgLTI5MzYsMTAgKzI5MzYsMTAgQEAgZnVuYyAo
eCAqVmNwdWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZjcHVpbmZvKSBlcnJvciB7CiAJeC5SdW5u
aW5nID0gYm9vbCh4Yy5ydW5uaW5nKQogCXguVmNwdVRpbWUgPSB1aW50NjQoeGMudmNwdV90aW1l
KQogCWlmIGVyciA6PSB4LkNwdW1hcC5mcm9tQygmeGMuY3B1bWFwKTsgZXJyICE9IG5pbCB7Ci0J
CXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ3B1bWFw
OiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQ3B1bWFwU29mdC5mcm9tQygmeGMuY3B1bWFw
X3NvZnQpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCBDcHVtYXBTb2Z0OiAldiIsIGVycikKIAl9CiAKIAlyZXR1cm4gbmls
CkBAIC0yOTU5LDEwICsyOTU5LDEwIEBAIGZ1bmMgKHggKlZjcHVpbmZvKSB0b0MoeGMgKkMubGli
eGxfdmNwdWluZm8pIChlcnIgZXJyb3IpIHsKIAl4Yy5ydW5uaW5nID0gQy5ib29sKHguUnVubmlu
ZykKIAl4Yy52Y3B1X3RpbWUgPSBDLnVpbnQ2NF90KHguVmNwdVRpbWUpCiAJaWYgZXJyIDo9IHgu
Q3B1bWFwLnRvQygmeGMuY3B1bWFwKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ3B1bWFwOiAldiIsIGVycikKIAl9CiAJ
aWYgZXJyIDo9IHguQ3B1bWFwU29mdC50b0MoJnhjLmNwdW1hcF9zb2Z0KTsgZXJyICE9IG5pbCB7
Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ3B1
bWFwU29mdDogJXYiLCBlcnIpCiAJfQogCiAJcmV0dXJuIG5pbApAQCAtMjk4Myw3ICsyOTgzLDcg
QEAgZnVuYyAoeCAqUGh5c2luZm8pIGZyb21DKHhjICpDLmxpYnhsX3BoeXNpbmZvKSBlcnJvciB7
CiAJeC5NYXhQb3NzaWJsZU1mbiA9IHVpbnQ2NCh4Yy5tYXhfcG9zc2libGVfbWZuKQogCXguTnJO
b2RlcyA9IHVpbnQzMih4Yy5ucl9ub2RlcykKIAlpZiBlcnIgOj0geC5Id0NhcC5mcm9tQygmeGMu
aHdfY2FwKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgSHdDYXA6ICV2IiwgZXJyKQogCX0KIAl4LkNhcEh2bSA9IGJvb2wo
eGMuY2FwX2h2bSkKIAl4LkNhcFB2ID0gYm9vbCh4Yy5jYXBfcHYpCkBAIC0zMDE2LDcgKzMwMTYs
NyBAQCBmdW5jICh4ICpQaHlzaW5mbykgdG9DKHhjICpDLmxpYnhsX3BoeXNpbmZvKSAoZXJyIGVy
cm9yKSB7CiAJeGMubWF4X3Bvc3NpYmxlX21mbiA9IEMudWludDY0X3QoeC5NYXhQb3NzaWJsZU1m
bikKIAl4Yy5ucl9ub2RlcyA9IEMudWludDMyX3QoeC5Ock5vZGVzKQogCWlmIGVyciA6PSB4Lkh3
Q2FwLnRvQygmeGMuaHdfY2FwKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJu
IGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgSHdDYXA6ICV2IiwgZXJyKQogCX0KIAl4Yy5j
YXBfaHZtID0gQy5ib29sKHguQ2FwSHZtKQogCXhjLmNhcF9wdiA9IEMuYm9vbCh4LkNhcFB2KQpA
QCAtMzA3NCw3ICszMDc0LDcgQEAgZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMoeGMgKkMubGli
eGxfdmRpc3BsaW5mbykgZXJyb3IgewogCQl4LkNvbm5lY3RvcnMgPSBtYWtlKFtdQ29ubmVjdG9y
aW5mbywgbnVtQ29ubmVjdG9ycykKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY0Nvbm5lY3RvcnMgewog
CQkJaWYgZXJyIDo9IHguQ29ubmVjdG9yc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJ
CXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBDb25u
ZWN0b3JzOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTMxMDYsNyArMzEwNiw3IEBAIGZ1
bmMgKHggKlZkaXNwbGluZm8pIHRvQyh4YyAqQy5saWJ4bF92ZGlzcGxpbmZvKSAoZXJyIGVycm9y
KSB7CiAJCWNDb25uZWN0b3JzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9jb25uZWN0b3JpbmZvKSh1
bnNhZmUuUG9pbnRlcih4Yy5jb25uZWN0b3JzKSlbOm51bUNvbm5lY3RvcnM6bnVtQ29ubmVjdG9y
c10KIAkJZm9yIGksIHYgOj0gcmFuZ2UgeC5Db25uZWN0b3JzIHsKIAkJCWlmIGVyciA6PSB2LnRv
QygmY0Nvbm5lY3RvcnNbaV0pOyBlcnIgIT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0
dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ29ubmVjdG9yczogJXYiLCBlcnIpCiAJ
CQl9CiAJCX0KIAl9CkBAIC0zMTQxLDcgKzMxNDEsNyBAQCBmdW5jICh4ICpQY21pbmZvKSBmcm9t
Qyh4YyAqQy5saWJ4bF9wY21pbmZvKSBlcnJvciB7CiAJCXguU3RyZWFtcyA9IG1ha2UoW11TdHJl
YW1pbmZvLCBudW1Wc25kU3RyZWFtcykKIAkJZm9yIGksIHYgOj0gcmFuZ2UgY1N0cmVhbXMgewog
CQkJaWYgZXJyIDo9IHguU3RyZWFtc1tpXS5mcm9tQygmdik7IGVyciAhPSBuaWwgewotCQkJCXJl
dHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBTdHJlYW1z
OiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTMxNjIsNyArMzE2Miw3IEBAIGZ1bmMgKHgg
KlBjbWluZm8pIHRvQyh4YyAqQy5saWJ4bF9wY21pbmZvKSAoZXJyIGVycm9yKSB7CiAJCWNTdHJl
YW1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9zdHJlYW1pbmZvKSh1bnNhZmUuUG9pbnRlcih4Yy5z
dHJlYW1zKSlbOm51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJlYW1zXQogCQlmb3IgaSwgdiA6PSBy
YW5nZSB4LlN0cmVhbXMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjU3RyZWFtc1tpXSk7IGVyciAh
PSBuaWwgewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGlu
ZyBmaWVsZCBTdHJlYW1zOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTMxODMsNyArMzE4
Myw3IEBAIGZ1bmMgKHggKlZzbmRpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kaW5mbykgZXJy
b3IgewogCQl4LlBjbXMgPSBtYWtlKFtdUGNtaW5mbywgbnVtVnNuZFBjbXMpCiAJCWZvciBpLCB2
IDo9IHJhbmdlIGNQY21zIHsKIAkJCWlmIGVyciA6PSB4LlBjbXNbaV0uZnJvbUMoJnYpOyBlcnIg
IT0gbmlsIHsKLQkJCQlyZXR1cm4gZXJyCisJCQkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgUGNtczogJXYiLCBlcnIpCiAJCQl9CiAJCX0KIAl9CkBAIC0zMjE0LDcgKzMyMTQs
NyBAQCBmdW5jICh4ICpWc25kaW5mbykgdG9DKHhjICpDLmxpYnhsX3ZzbmRpbmZvKSAoZXJyIGVy
cm9yKSB7CiAJCWNQY21zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9wY21pbmZvKSh1bnNhZmUuUG9p
bnRlcih4Yy5wY21zKSlbOm51bVZzbmRQY21zOm51bVZzbmRQY21zXQogCQlmb3IgaSwgdiA6PSBy
YW5nZSB4LlBjbXMgewogCQkJaWYgZXJyIDo9IHYudG9DKCZjUGNtc1tpXSk7IGVyciAhPSBuaWwg
ewotCQkJCXJldHVybiBlcnIKKwkJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVs
ZCBQY21zOiAldiIsIGVycikKIAkJCX0KIAkJfQogCX0KQEAgLTMzNzEsMjYgKzMzNzEsMjYgQEAg
ZnVuYyAoeCAqU2NoZWRDcmVkaXQyUGFyYW1zKSB0b0MoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0
Ml9wYXJhbXMpIChlcnIgZXJyb3IpIHsKIGZ1bmMgKHggKkRvbWFpblJlbXVzSW5mbykgZnJvbUMo
eGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIGVycm9yIHsKIAl4LkludGVydmFsID0gaW50
KHhjLmludGVydmFsKQogCWlmIGVyciA6PSB4LkFsbG93VW5zYWZlLmZyb21DKCZ4Yy5hbGxvd191
bnNhZmUpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCBBbGxvd1Vuc2FmZTogJXYiLCBlcnIpCiAJfQogCWlmIGVyciA6PSB4
LkJsYWNraG9sZS5mcm9tQygmeGMuYmxhY2tob2xlKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBl
cnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQmxhY2tob2xlOiAldiIs
IGVycikKIAl9CiAJaWYgZXJyIDo9IHguQ29tcHJlc3Npb24uZnJvbUMoJnhjLmNvbXByZXNzaW9u
KTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZl
cnRpbmcgZmllbGQgQ29tcHJlc3Npb246ICV2IiwgZXJyKQogCX0KIAlpZiBlcnIgOj0geC5OZXRi
dWYuZnJvbUMoJnhjLm5ldGJ1Zik7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJldHVy
biBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIE5ldGJ1ZjogJXYiLCBlcnIpCiAJfQogCXgu
TmV0YnVmc2NyaXB0ID0gQy5Hb1N0cmluZyh4Yy5uZXRidWZzY3JpcHQpCiAJaWYgZXJyIDo9IHgu
RGlza2J1Zi5mcm9tQygmeGMuZGlza2J1Zik7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJ
CXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIERpc2tidWY6ICV2IiwgZXJyKQog
CX0KIAlpZiBlcnIgOj0geC5Db2xvLmZyb21DKCZ4Yy5jb2xvKTsgZXJyICE9IG5pbCB7Ci0JCXJl
dHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ29sbzogJXYi
LCBlcnIpCiAJfQogCWlmIGVyciA6PSB4LlVzZXJzcGFjZUNvbG9Qcm94eS5mcm9tQygmeGMudXNl
cnNwYWNlX2NvbG9fcHJveHkpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4g
Zm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBVc2Vyc3BhY2VDb2xvUHJveHk6ICV2IiwgZXJy
KQogCX0KIAogCXJldHVybiBuaWwKQEAgLTM0MDUsMjggKzM0MDUsMjggQEAgZnVuYyAoeCAqRG9t
YWluUmVtdXNJbmZvKSB0b0MoeGMgKkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIChlcnIgZXJy
b3IpIHsKIAogCXhjLmludGVydmFsID0gQy5pbnQoeC5JbnRlcnZhbCkKIAlpZiBlcnIgOj0geC5B
bGxvd1Vuc2FmZS50b0MoJnhjLmFsbG93X3Vuc2FmZSk7IGVyciAhPSBuaWwgewotCQlyZXR1cm4g
ZXJyCisJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIEFsbG93VW5zYWZlOiAl
diIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQmxhY2tob2xlLnRvQygmeGMuYmxhY2tob2xlKTsg
ZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRp
bmcgZmllbGQgQmxhY2tob2xlOiAldiIsIGVycikKIAl9CiAJaWYgZXJyIDo9IHguQ29tcHJlc3Np
b24udG9DKCZ4Yy5jb21wcmVzc2lvbik7IGVyciAhPSBuaWwgewotCQlyZXR1cm4gZXJyCisJCXJl
dHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIENvbXByZXNzaW9uOiAldiIsIGVycikK
IAl9CiAJaWYgZXJyIDo9IHguTmV0YnVmLnRvQygmeGMubmV0YnVmKTsgZXJyICE9IG5pbCB7Ci0J
CXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgTmV0YnVm
OiAldiIsIGVycikKIAl9CiAJaWYgeC5OZXRidWZzY3JpcHQgIT0gIiIgewogCQl4Yy5uZXRidWZz
Y3JpcHQgPSBDLkNTdHJpbmcoeC5OZXRidWZzY3JpcHQpCiAJfQogCWlmIGVyciA6PSB4LkRpc2ti
dWYudG9DKCZ4Yy5kaXNrYnVmKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJu
IGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgRGlza2J1ZjogJXYiLCBlcnIpCiAJfQogCWlm
IGVyciA6PSB4LkNvbG8udG9DKCZ4Yy5jb2xvKTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIK
KwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcgZmllbGQgQ29sbzogJXYiLCBlcnIpCiAJ
fQogCWlmIGVyciA6PSB4LlVzZXJzcGFjZUNvbG9Qcm94eS50b0MoJnhjLnVzZXJzcGFjZV9jb2xv
X3Byb3h5KTsgZXJyICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYo
ImNvbnZlcnRpbmcgZmllbGQgVXNlcnNwYWNlQ29sb1Byb3h5OiAldiIsIGVycikKIAl9CiAKIAly
ZXR1cm4gbmlsCkBAIC0zNDM0LDMzICszNDM0LDMzIEBAIGZ1bmMgKHggKkRvbWFpblJlbXVzSW5m
bykgdG9DKHhjICpDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvKSAoZXJyIGVycm9yKSB7CiAKIGZ1
bmMgKHggKkV2ZW50KSBmcm9tQyh4YyAqQy5saWJ4bF9ldmVudCkgZXJyb3IgewogCWlmIGVyciA6
PSB4LkxpbmsuZnJvbUMoJnhjLmxpbmspOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQly
ZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBMaW5rOiAldiIsIGVycikKIAl9CiAJ
eC5Eb21pZCA9IERvbWlkKHhjLmRvbWlkKQogCWlmIGVyciA6PSB4LkRvbXV1aWQuZnJvbUMoJnhj
LmRvbXV1aWQpOyBlcnIgIT0gbmlsIHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9y
ZigiY29udmVydGluZyBmaWVsZCBEb211dWlkOiAldiIsIGVycikKIAl9CiAJeC5Gb3JVc2VyID0g
dWludDY0KHhjLmZvcl91c2VyKQogCXguVHlwZSA9IEV2ZW50VHlwZSh4Yy5fdHlwZSkKIAlzd2l0
Y2ggeC5UeXBlIHsKLQljYXNlIEV2ZW50VHlwZU9wZXJhdGlvbkNvbXBsZXRlOgotCQl2YXIgdHlw
ZU9wZXJhdGlvbkNvbXBsZXRlIEV2ZW50VHlwZVVuaW9uT3BlcmF0aW9uQ29tcGxldGUKLQkJaWYg
ZXJyIDo9IHR5cGVPcGVyYXRpb25Db21wbGV0ZS5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgewotCQkJ
cmV0dXJuIGVycgotCQl9Ci0JCXguVHlwZVVuaW9uID0gdHlwZU9wZXJhdGlvbkNvbXBsZXRlCiAJ
Y2FzZSBFdmVudFR5cGVEb21haW5TaHV0ZG93bjoKIAkJdmFyIHR5cGVEb21haW5TaHV0ZG93biBF
dmVudFR5cGVVbmlvbkRvbWFpblNodXRkb3duCiAJCWlmIGVyciA6PSB0eXBlRG9tYWluU2h1dGRv
d24uZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVybiBlcnIKKwkJCXJldHVybiBmbXQu
RXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVEb21haW5TaHV0ZG93bjogJXYiLCBlcnIpCiAJ
CX0KIAkJeC5UeXBlVW5pb24gPSB0eXBlRG9tYWluU2h1dGRvd24KIAljYXNlIEV2ZW50VHlwZURp
c2tFamVjdDoKIAkJdmFyIHR5cGVEaXNrRWplY3QgRXZlbnRUeXBlVW5pb25EaXNrRWplY3QKIAkJ
aWYgZXJyIDo9IHR5cGVEaXNrRWplY3QuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKLQkJCXJldHVy
biBlcnIKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5nIGZpZWxkIHR5cGVEaXNrRWpl
Y3Q6ICV2IiwgZXJyKQogCQl9CiAJCXguVHlwZVVuaW9uID0gdHlwZURpc2tFamVjdAorCWNhc2Ug
RXZlbnRUeXBlT3BlcmF0aW9uQ29tcGxldGU6CisJCXZhciB0eXBlT3BlcmF0aW9uQ29tcGxldGUg
RXZlbnRUeXBlVW5pb25PcGVyYXRpb25Db21wbGV0ZQorCQlpZiBlcnIgOj0gdHlwZU9wZXJhdGlv
bkNvbXBsZXRlLmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZm10LkVycm9yZigi
Y29udmVydGluZyBmaWVsZCB0eXBlT3BlcmF0aW9uQ29tcGxldGU6ICV2IiwgZXJyKQorCQl9CisJ
CXguVHlwZVVuaW9uID0gdHlwZU9wZXJhdGlvbkNvbXBsZXRlCiAJZGVmYXVsdDoKIAkJcmV0dXJu
IGZtdC5FcnJvcmYoImludmFsaWQgdW5pb24ga2V5ICcldiciLCB4LlR5cGUpCiAJfQpAQCAtMzQ4
Niw3ICszNDg2LDcgQEAgZnVuYyAoeCAqRXZlbnRUeXBlVW5pb25EaXNrRWplY3QpIGZyb21DKHhj
ICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CiAJdG1wIDo9ICgqQy5saWJ4bF9ldmVudF90eXBlX3Vu
aW9uX2Rpc2tfZWplY3QpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKIAl4LlZkZXYgPSBDLkdv
U3RyaW5nKHRtcC52ZGV2KQogCWlmIGVyciA6PSB4LkRpc2suZnJvbUMoJnRtcC5kaXNrKTsgZXJy
ICE9IG5pbCB7Ci0JCXJldHVybiBlcnIKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImNvbnZlcnRpbmcg
ZmllbGQgRGlzazogJXYiLCBlcnIpCiAJfQogCXJldHVybiBuaWwKIH0KQEAgLTM1MDksMTEgKzM1
MDksMTEgQEAgZnVuYyAoeCAqRXZlbnQpIHRvQyh4YyAqQy5saWJ4bF9ldmVudCkgKGVyciBlcnJv
cikgewogCX0oKQogCiAJaWYgZXJyIDo9IHguTGluay50b0MoJnhjLmxpbmspOyBlcnIgIT0gbmls
IHsKLQkJcmV0dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBM
aW5rOiAldiIsIGVycikKIAl9CiAJeGMuZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguRG9taWQpCiAJ
aWYgZXJyIDo9IHguRG9tdXVpZC50b0MoJnhjLmRvbXV1aWQpOyBlcnIgIT0gbmlsIHsKLQkJcmV0
dXJuIGVycgorCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBEb211dWlkOiAl
diIsIGVycikKIAl9CiAJeGMuZm9yX3VzZXIgPSBDLnVpbnQ2NF90KHguRm9yVXNlcikKIAl4Yy5f
dHlwZSA9IEMubGlieGxfZXZlbnRfdHlwZSh4LlR5cGUpCkBAIC0zNTM3LDcgKzM1MzcsNyBAQCBm
dW5jICh4ICpFdmVudCkgdG9DKHhjICpDLmxpYnhsX2V2ZW50KSAoZXJyIGVycm9yKSB7CiAJCQlk
aXNrX2VqZWN0LnZkZXYgPSBDLkNTdHJpbmcodG1wLlZkZXYpCiAJCX0KIAkJaWYgZXJyIDo9IHRt
cC5EaXNrLnRvQygmZGlza19lamVjdC5kaXNrKTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJy
CisJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCBEaXNrOiAldiIsIGVycikK
IAkJfQogCQlkaXNrX2VqZWN0Qnl0ZXMgOj0gQy5Hb0J5dGVzKHVuc2FmZS5Qb2ludGVyKCZkaXNr
X2VqZWN0KSwgQy5zaXplb2ZfbGlieGxfZXZlbnRfdHlwZV91bmlvbl9kaXNrX2VqZWN0KQogCQlj
b3B5KHhjLnVbOl0sIGRpc2tfZWplY3RCeXRlcykKQEAgLTM1ODUsMTggKzM1ODUsMTggQEAgZnVu
YyAoeCAqUHNySHdJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfaHdfaW5mbykgZXJyb3Igewog
CXguSWQgPSB1aW50MzIoeGMuaWQpCiAJeC5UeXBlID0gUHNyRmVhdFR5cGUoeGMuX3R5cGUpCiAJ
c3dpdGNoIHguVHlwZSB7Ci0JY2FzZSBQc3JGZWF0VHlwZU1iYToKLQkJdmFyIHR5cGVNYmEgUHNy
SHdJbmZvVHlwZVVuaW9uTWJhCi0JCWlmIGVyciA6PSB0eXBlTWJhLmZyb21DKHhjKTsgZXJyICE9
IG5pbCB7Ci0JCQlyZXR1cm4gZXJyCi0JCX0KLQkJeC5UeXBlVW5pb24gPSB0eXBlTWJhCiAJY2Fz
ZSBQc3JGZWF0VHlwZUNhdDoKIAkJdmFyIHR5cGVDYXQgUHNySHdJbmZvVHlwZVVuaW9uQ2F0CiAJ
CWlmIGVyciA6PSB0eXBlQ2F0LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7Ci0JCQlyZXR1cm4gZXJy
CisJCQlyZXR1cm4gZm10LkVycm9yZigiY29udmVydGluZyBmaWVsZCB0eXBlQ2F0OiAldiIsIGVy
cikKIAkJfQogCQl4LlR5cGVVbmlvbiA9IHR5cGVDYXQKKwljYXNlIFBzckZlYXRUeXBlTWJhOgor
CQl2YXIgdHlwZU1iYSBQc3JId0luZm9UeXBlVW5pb25NYmEKKwkJaWYgZXJyIDo9IHR5cGVNYmEu
ZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBmbXQuRXJyb3JmKCJjb252ZXJ0aW5n
IGZpZWxkIHR5cGVNYmE6ICV2IiwgZXJyKQorCQl9CisJCXguVHlwZVVuaW9uID0gdHlwZU1iYQog
CWRlZmF1bHQ6CiAJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAnJXYnIiwg
eC5UeXBlKQogCX0KLS0gCjIuMjQuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhl
bnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5m
by94ZW4tZGV2ZWw=

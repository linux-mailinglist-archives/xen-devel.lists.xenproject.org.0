Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 26836C1AF1
	for <lists+xen-devel@lfdr.de>; Mon, 30 Sep 2019 07:24:38 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iEo8R-0002Dt-2w; Mon, 30 Sep 2019 05:22:11 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=hbFO=XZ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iEo8P-0002Bz-BJ
 for xen-devel@lists.xenproject.org; Mon, 30 Sep 2019 05:22:09 +0000
X-Inumbo-ID: 30c96e0e-e342-11e9-8628-bc764e2007e4
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 30c96e0e-e342-11e9-8628-bc764e2007e4;
 Mon, 30 Sep 2019 05:21:44 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id B0E86B0B7;
 Mon, 30 Sep 2019 05:21:41 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Mon, 30 Sep 2019 07:21:26 +0200
Message-Id: <20190930052135.11257-11-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190930052135.11257-1-jgross@suse.com>
References: <20190930052135.11257-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v5 10/19] xen/sched: move per-cpu variable
 cpupool to struct sched_resource
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Meng Xu <mengxu@cis.upenn.edu>,
 Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SGF2aW5nIGEgcG9pbnRlciB0byBzdHJ1Y3QgY3B1cG9vbCBpbiBzdHJ1Y3Qgc2NoZWRfcmVzb3Vy
Y2UgaW5zdGVhZApvZiBwZXIgY3B1IGlzIGVub3VnaC4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4g
R3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGlj
aEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IERhcmlvIEZhZ2dpb2xpIDxkZmFnZ2lvbGlAc3VzZS5j
b20+Ci0tLQpWMTogbmV3IHBhdGNoCi0tLQogeGVuL2NvbW1vbi9jcHVwb29sLmMgICAgICAgfCA0
ICstLS0KIHhlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMgIHwgMiArLQogeGVuL2NvbW1vbi9zY2hl
ZF9ydC5jICAgICAgfCAyICstCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAgICB8IDggKysrKy0t
LS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIHwgMiArLQogNSBmaWxlcyBjaGFuZ2VkLCA4
IGluc2VydGlvbnMoKyksIDEwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24v
Y3B1cG9vbC5jIGIveGVuL2NvbW1vbi9jcHVwb29sLmMKaW5kZXggNDQxYTI2ZjE2Yy4uNjBhODVm
NTBlMSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9jcHVwb29sLmMKKysrIGIveGVuL2NvbW1vbi9j
cHVwb29sLmMKQEAgLTM0LDggKzM0LDYgQEAgc3RhdGljIGNwdW1hc2tfdCBjcHVwb29sX2xvY2tl
ZF9jcHVzOwogCiBzdGF0aWMgREVGSU5FX1NQSU5MT0NLKGNwdXBvb2xfbG9jayk7CiAKLURFRklO
RV9QRVJfQ1BVKHN0cnVjdCBjcHVwb29sICosIGNwdXBvb2wpOwotCiBzdGF0aWMgdm9pZCBmcmVl
X2NwdXBvb2xfc3RydWN0KHN0cnVjdCBjcHVwb29sICpjKQogewogICAgIGlmICggYyApCkBAIC01
MDQsNyArNTAyLDcgQEAgc3RhdGljIGludCBjcHVwb29sX2NwdV9hZGQodW5zaWduZWQgaW50IGNw
dSkKICAgICAgKiAob3IgdW5wbHVnZ2luZyB3b3VsZCBoYXZlIGZhaWxlZCkgYW5kIHRoYXQgaXMg
dGhlIGRlZmF1bHQgYmVoYXZpb3IKICAgICAgKiBhbnl3YXkuCiAgICAgICovCi0gICAgcGVyX2Nw
dShjcHVwb29sLCBjcHUpID0gTlVMTDsKKyAgICBnZXRfc2NoZWRfcmVzKGNwdSktPmNwdXBvb2wg
PSBOVUxMOwogICAgIHJldCA9IGNwdXBvb2xfYXNzaWduX2NwdV9sb2NrZWQoY3B1cG9vbDAsIGNw
dSk7CiAKICAgICBzcGluX3VubG9jaygmY3B1cG9vbF9sb2NrKTsKZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vc2NoZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4IDg2
NjAzYWRjYjYuLjMxZmRjZDZhMmYgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtMTY4MSw3ICsxNjgxLDcgQEAg
c3RhdGljIHN0cnVjdCBjc2NoZWRfdW5pdCAqCiBjc2NoZWRfbG9hZF9iYWxhbmNlKHN0cnVjdCBj
c2NoZWRfcHJpdmF0ZSAqcHJ2LCBpbnQgY3B1LAogICAgIHN0cnVjdCBjc2NoZWRfdW5pdCAqc25l
eHQsIGJvb2wgKnN0b2xlbikKIHsKLSAgICBzdHJ1Y3QgY3B1cG9vbCAqYyA9IHBlcl9jcHUoY3B1
cG9vbCwgY3B1KTsKKyAgICBzdHJ1Y3QgY3B1cG9vbCAqYyA9IGdldF9zY2hlZF9yZXMoY3B1KS0+
Y3B1cG9vbDsKICAgICBzdHJ1Y3QgY3NjaGVkX3VuaXQgKnNwZWVyOwogICAgIGNwdW1hc2tfdCB3
b3JrZXJzOwogICAgIGNwdW1hc2tfdCAqb25saW5lOwpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9z
Y2hlZF9ydC5jIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCmluZGV4IGQyMWM0MTZjYWUuLjZlOTNl
NTBhY2IgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfcnQuYworKysgYi94ZW4vY29tbW9u
L3NjaGVkX3J0LmMKQEAgLTc3NCw3ICs3NzQsNyBAQCBydF9kZWluaXRfcGRhdGEoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwY3B1LCBpbnQgY3B1KQogCiAgICAgaWYgKCBwcnYt
PnJlcGxfdGltZXIuY3B1ID09IGNwdSApCiAgICAgewotICAgICAgICBzdHJ1Y3QgY3B1cG9vbCAq
YyA9IHBlcl9jcHUoY3B1cG9vbCwgY3B1KTsKKyAgICAgICAgc3RydWN0IGNwdXBvb2wgKmMgPSBn
ZXRfc2NoZWRfcmVzKGNwdSktPmNwdXBvb2w7CiAgICAgICAgIHVuc2lnbmVkIGludCBuZXdfY3B1
ID0gY3B1bWFza19jeWNsZShjcHUsIGNwdXBvb2xfb25saW5lX2NwdW1hc2soYykpOwogCiAgICAg
ICAgIC8qCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMgYi94ZW4vY29tbW9uL3Nj
aGVkdWxlLmMKaW5kZXggNWU5Y2VlMWY4Mi4uMjQ5ZmY4YTg4MiAxMDA2NDQKLS0tIGEveGVuL2Nv
bW1vbi9zY2hlZHVsZS5jCisrKyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwpAQCAtMTEyMCw3ICsx
MTIwLDcgQEAgaW50IGNwdV9kaXNhYmxlX3NjaGVkdWxlcih1bnNpZ25lZCBpbnQgY3B1KQogICAg
IGNwdW1hc2tfdCBvbmxpbmVfYWZmaW5pdHk7CiAgICAgaW50IHJldCA9IDA7CiAKLSAgICBjID0g
cGVyX2NwdShjcHVwb29sLCBjcHUpOworICAgIGMgPSBnZXRfc2NoZWRfcmVzKGNwdSktPmNwdXBv
b2w7CiAgICAgaWYgKCBjID09IE5VTEwgKQogICAgICAgICByZXR1cm4gcmV0OwogCkBAIC0xMTg5
LDcgKzExODksNyBAQCBzdGF0aWMgaW50IGNwdV9kaXNhYmxlX3NjaGVkdWxlcl9jaGVjayh1bnNp
Z25lZCBpbnQgY3B1KQogICAgIHN0cnVjdCB2Y3B1ICp2OwogICAgIHN0cnVjdCBjcHVwb29sICpj
OwogCi0gICAgYyA9IHBlcl9jcHUoY3B1cG9vbCwgY3B1KTsKKyAgICBjID0gZ2V0X3NjaGVkX3Jl
cyhjcHUpLT5jcHVwb29sOwogICAgIGlmICggYyA9PSBOVUxMICkKICAgICAgICAgcmV0dXJuIDA7
CiAKQEAgLTI1NTQsOCArMjU1NCw4IEBAIGludCBzY2hlZHVsZV9jcHVfc3dpdGNoKHVuc2lnbmVk
IGludCBjcHUsIHN0cnVjdCBjcHVwb29sICpjKQogICAgIHZvaWQgKnBwcml2LCAqcHByaXZfb2xk
LCAqdnByaXYsICp2cHJpdl9vbGQ7CiAgICAgc3RydWN0IHNjaGVkdWxlciAqb2xkX29wcyA9IGdl
dF9zY2hlZF9yZXMoY3B1KS0+c2NoZWR1bGVyOwogICAgIHN0cnVjdCBzY2hlZHVsZXIgKm5ld19v
cHMgPSAoYyA9PSBOVUxMKSA/ICZzY2hlZF9pZGxlX29wcyA6IGMtPnNjaGVkOwotICAgIHN0cnVj
dCBjcHVwb29sICpvbGRfcG9vbCA9IHBlcl9jcHUoY3B1cG9vbCwgY3B1KTsKICAgICBzdHJ1Y3Qg
c2NoZWRfcmVzb3VyY2UgKnNkID0gZ2V0X3NjaGVkX3JlcyhjcHUpOworICAgIHN0cnVjdCBjcHVw
b29sICpvbGRfcG9vbCA9IHNkLT5jcHVwb29sOwogICAgIHNwaW5sb2NrX3QgKm9sZF9sb2NrLCAq
bmV3X2xvY2s7CiAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIApAQCAtMjYzNyw3ICsyNjM3LDcg
QEAgaW50IHNjaGVkdWxlX2NwdV9zd2l0Y2godW5zaWduZWQgaW50IGNwdSwgc3RydWN0IGNwdXBv
b2wgKmMpCiAgICAgc2NoZWRfZnJlZV91ZGF0YShvbGRfb3BzLCB2cHJpdl9vbGQpOwogICAgIHNj
aGVkX2ZyZWVfcGRhdGEob2xkX29wcywgcHByaXZfb2xkLCBjcHUpOwogCi0gICAgcGVyX2NwdShj
cHVwb29sLCBjcHUpID0gYzsKKyAgICBnZXRfc2NoZWRfcmVzKGNwdSktPmNwdXBvb2wgPSBjOwog
ICAgIC8qIFdoZW4gYSBjcHUgaXMgYWRkZWQgdG8gYSBwb29sLCB0cmlnZ2VyIGl0IHRvIGdvIHBp
Y2sgdXAgc29tZSB3b3JrICovCiAgICAgaWYgKCBjICE9IE5VTEwgKQogICAgICAgICBjcHVfcmFp
c2Vfc29mdGlycShjcHUsIFNDSEVEVUxFX1NPRlRJUlEpOwpkaWZmIC0tZ2l0IGEveGVuL2luY2x1
ZGUveGVuL3NjaGVkLWlmLmggYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaAppbmRleCAwMTgy
MWIzZTViLi5lNjc1MDYxMjkwIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYu
aAorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaApAQCAtMzcsNiArMzcsNyBAQCBleHRl
cm4gY29uc3QgY3B1bWFza190ICpzY2hlZF9yZXNfbWFzazsKICAqIG9uZSBpdCB3YW50cyAoVGhp
cyBtYXkgYmUgdGhlIG9uZSByaWdodCBpbiBmcm9udCBvZiBpdCkuKi8KIHN0cnVjdCBzY2hlZF9y
ZXNvdXJjZSB7CiAgICAgc3RydWN0IHNjaGVkdWxlciAgICpzY2hlZHVsZXI7CisgICAgc3RydWN0
IGNwdXBvb2wgICAgICpjcHVwb29sOwogICAgIHNwaW5sb2NrX3QgICAgICAgICAqc2NoZWR1bGVf
bG9jaywKICAgICAgICAgICAgICAgICAgICAgICAgX2xvY2s7CiAgICAgc3RydWN0IHNjaGVkX3Vu
aXQgICpjdXJyOwpAQCAtNTAsNyArNTEsNiBAQCBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgewogICAg
IGNvbnN0IGNwdW1hc2tfdCAgICAqY3B1czsgICAgICAgICAgIC8qIGNwdXMgY292ZXJlZCBieSB0
aGlzIHN0cnVjdCAgICAgKi8KIH07CiAKLURFQ0xBUkVfUEVSX0NQVShzdHJ1Y3QgY3B1cG9vbCAq
LCBjcHVwb29sKTsKIERFQ0xBUkVfUEVSX0NQVShzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKiwgc2No
ZWRfcmVzKTsKIAogc3RhdGljIGlubGluZSBzdHJ1Y3Qgc2NoZWRfcmVzb3VyY2UgKmdldF9zY2hl
ZF9yZXModW5zaWduZWQgaW50IGNwdSkKLS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRl
dmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFp
bG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 04844B39A7
	for <lists+xen-devel@lfdr.de>; Mon, 16 Sep 2019 13:44:04 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9pNj-0005dE-3R; Mon, 16 Sep 2019 11:41:23 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GGTU=XL=amazon.de=prvs=1553567f6=wipawel@srs-us1.protection.inumbo.net>)
 id 1i9pNh-0005cf-Fi
 for xen-devel@lists.xen.org; Mon, 16 Sep 2019 11:41:21 +0000
X-Inumbo-ID: e66a39eb-d876-11e9-95e0-12813bfff9fa
Received: from smtp-fw-33001.amazon.com (unknown [207.171.190.10])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id e66a39eb-d876-11e9-95e0-12813bfff9fa;
 Mon, 16 Sep 2019 11:41:20 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1568634080; x=1600170080;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version:content-transfer-encoding;
 bh=bQrQHHnMSd8daBAlGmey2+xfIAI4r5FT8iKi1Efk5/Y=;
 b=N4sFsmt6G9bR5ynf/HdrAgYpKpJIZy/fEcUR7bBe4SqubsZSnUAA0wly
 QYbIKrPMNLMRoXvfyCIMMdHxn0ZzWhAGns297SuUDfZJMfFWabz2beFoM
 atybxJnKnUml8FVPRYvKoR/GJ0JyrzAdJSGVP5g7KZtHVS2nb/F+P8xDh g=;
X-IronPort-AV: E=Sophos;i="5.64,512,1559520000"; d="scan'208";a="832632158"
Received: from sea3-co-svc-lb6-vlan2.sea.amazon.com (HELO
 email-inbound-relay-2a-538b0bfb.us-west-2.amazon.com) ([10.47.22.34])
 by smtp-border-fw-out-33001.sea14.amazon.com with ESMTP;
 16 Sep 2019 11:41:01 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (pdx4-ws-svc-p6-lb7-vlan3.pdx.amazon.com [10.170.41.166])
 by email-inbound-relay-2a-538b0bfb.us-west-2.amazon.com (Postfix) with ESMTPS
 id 2A573A1E5D; Mon, 16 Sep 2019 11:41:01 +0000 (UTC)
Received: from EX13D05EUB003.ant.amazon.com (10.43.166.253) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:41:00 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D05EUB003.ant.amazon.com (10.43.166.253) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:41:00 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Mon, 16 Sep 2019 11:40:58 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>, <xen-devel@lists.xenproject.org>
Date: Mon, 16 Sep 2019 11:40:48 +0000
Message-ID: <20190916114048.17699-1-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190916105945.93632-13-wipawel@amazon.de>
References: <20190916105945.93632-13-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v3 12/12] livepatch: Add python bindings for
 livepatch operations
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Wei Liu <wl@xen.org>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 =?UTF-8?q?Marek=20Marczykowski-G=C3=B3recki?=
 <marmarek@invisiblethingslab.com>, Pawel Wieczorkiewicz <wipawel@amazon.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RXh0ZW5kIHRoZSBYQyBweXRob24gYmluZGluZ3MgbGlicmFyeSB0byBzdXBwb3J0IGFsc28gYWxs
IGNvbW1vbgpsaXZlcGF0Y2ggb3BlcmF0aW9ucyBhbmQgYWN0aW9ucy4KCkFkZCB0aGUgcHl0aG9u
IGJpbmRpbmdzIGZvciB0aGUgZm9sbG93aW5nIG9wZXJhdGlvbnM6Ci0gc3RhdHVzIChweXhjX2xp
dmVwYXRjaF9zdGF0dXMpOgogIFJlcXVpcmVzIGEgcGF5bG9hZCBuYW1lIGFzIGFuIGlucHV0Lgog
IFJldHVybnMgYSBzdGF0dXMgZGljdCBjb250YWluaW5nIGEgc3RhdGUgc3RyaW5nIGFuZCBhIHJl
dHVybiBjb2RlCiAgaW50ZWdlci4KLSBhY3Rpb24gKHB5eGNfbGl2ZXBhdGNoX2FjdGlvbik6CiAg
UmVxdWlyZXMgYSBwYXlsb2FkIG5hbWUgYW5kIGFuIGFjdGlvbiBpZCBhcyBhbiBpbnB1dC4gVGlt
ZW91dCBhbmQKICBmbGFncyBhcmUgb3B0aW9uYWwgcGFyYW1ldGVycy4KICBSZXR1cm5zIGEgcmV0
dXJuIGNvZGUgaW50ZWdlci4KLSB1cGxvYWQgKHB5eGNfbGl2ZXBhdGNoX3VwbG9hZCk6CiAgUmVx
dWlyZXMgYSBwYXlsb2FkIG5hbWUgYW5kIGEgbW9kdWxlJ3MgZmlsZW5hbWUgYXMgYW4gaW5wdXQu
CiAgUmV0dXJucyBhIHJldHVybiBjb2RlIGludGVnZXIuCi0gbGlzdCAocHl4Y19saXZlcGF0Y2hf
bGlzdCk6CiAgVGFrZXMgbm8gcGFyYW1ldGVycy4KICBSZXR1cm5zIGEgbGlzdCBvZiBkaWN0cyBj
b250YWluaW5nIGVhY2ggcGF5bG9hZCdzOgogICogbmFtZSBhcyBhIHN0cmluZwogICogc3RhdGUg
YXMgYSBzdHJpbmcKICAqIHJldHVybiBjb2RlIGFzIGFuIGludGVnZXIKICAqIGxpc3Qgb2YgbWV0
YWRhdGEga2V5PXZhbHVlIHN0cmluZ3MKCkVhY2ggZnVuY3Rpb25zIHRocm93cyBhbiBleGNlcHRp
b24gZXJyb3IgYmFzZWQgb24gdGhlIGVycm5vIHZhbHVlCnJlY2VpdmVkIGZyb20gaXRzIGNvcnJl
c3BvbmRpbmcgbGlieGMgZnVuY3Rpb24gY2FsbC4KClNpZ25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6
b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpvbi5kZT4KUmV2aWV3ZWQtYnk6IE1hcnRpbiBNYXplaW4g
PGFtYXplaW5AYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogQW5kcmEtSXJpbmEgUGFyYXNjaGl2IDxh
bmRyYXByc0BhbWF6b24uY29tPgpSZXZpZXdlZC1ieTogTGVvbmFyZCBGb2Vyc3RlciA8Zm9lcnNs
ZW9AYW1hem9uLmRlPgpSZXZpZXdlZC1ieTogTm9yYmVydCBNYW50aGV5IDxubWFudGhleUBhbWF6
b24uZGU+CkFja2VkLWJ5OiBNYXJlayBNYXJjenlrb3dza2ktR8OzcmVja2kgPG1hcm1hcmVrQGlu
dmlzaWJsZXRoaW5nc2xhYi5jb20+Ci0tLQpDaGFuZ2VkIHNpbmNlIHYxOgogICogY2hhbmdlZCBQ
eUxpc3RfQXBwZW5kKCkgd2l0aCBQeUxpc3RfU2V0SXRlbSgpIGFzIHJlcXVlc3RlZCBieQogICAg
TWFyZWsKCiB0b29scy9weXRob24veGVuL2xvd2xldmVsL3hjL3hjLmMgfCAyNzMgKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAyNzMgaW5zZXJ0
aW9ucygrKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL3B5dGhvbi94ZW4vbG93bGV2ZWwveGMveGMuYyBi
L3Rvb2xzL3B5dGhvbi94ZW4vbG93bGV2ZWwveGMveGMuYwppbmRleCA5ZDUzYzRjZjM3Li4yYTgy
MWU0NmQyIDEwMDY0NAotLS0gYS90b29scy9weXRob24veGVuL2xvd2xldmVsL3hjL3hjLmMKKysr
IGIvdG9vbHMvcHl0aG9uL3hlbi9sb3dsZXZlbC94Yy94Yy5jCkBAIC0xOTc5LDYgKzE5NzksMjMw
IEBAIHN0YXRpYyBQeU9iamVjdCAqcHlmbGFza19hY2Nlc3MoUHlPYmplY3QgKnNlbGYsIFB5T2Jq
ZWN0ICphcmdzLAogICAgIHJldHVybiBQeV9CdWlsZFZhbHVlKCJpIixyZXQpOwogfQogCitzdGF0
aWMgUHlPYmplY3QgKnB5eGNfbGl2ZXBhdGNoX3N0YXR1cyhYY09iamVjdCAqc2VsZiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmt3ZHMpCit7CisgICAg
eGVuX2xpdmVwYXRjaF9zdGF0dXNfdCBzdGF0dXM7CisgICAgUHlPYmplY3QgKmluZm9fZGljdCA9
IE5VTEw7CisgICAgY2hhciAqbmFtZTsKKyAgICBpbnQgcmM7CisKKyAgICBzdGF0aWMgY2hhciAq
a3dkX2xpc3RbXSA9IHsgIm5hbWUiLCBOVUxMIH07CisKKyAgICBpZiAoICFQeUFyZ19QYXJzZVR1
cGxlQW5kS2V5d29yZHMoYXJncywga3dkcywgInMiLCBrd2RfbGlzdCwgJm5hbWUpICkKKyAgICAg
ICAgZ290byBlcnJvcjsKKworICAgIHJjID0geGNfbGl2ZXBhdGNoX2dldChzZWxmLT54Y19oYW5k
bGUsIG5hbWUsICZzdGF0dXMpOworICAgIGlmICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOwor
CisgICAgaW5mb19kaWN0ID0gUHlfQnVpbGRWYWx1ZSgKKyAgICAgICAgICAgICJ7czppLHM6aX0i
LAorICAgICAgICAgICAgInN0YXRlIiwgICAgc3RhdHVzLnN0YXRlLAorICAgICAgICAgICAgInJj
IiwgICAgICAgc3RhdHVzLnJjKTsKKworZXJyb3I6CisgICAgcmV0dXJuIGluZm9fZGljdCA/OiBw
eXhjX2Vycm9yX3RvX2V4Y2VwdGlvbihzZWxmLT54Y19oYW5kbGUpOworfQorCitzdGF0aWMgUHlP
YmplY3QgKnB5eGNfbGl2ZXBhdGNoX2FjdGlvbihYY09iamVjdCAqc2VsZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICphcmdzLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgUHlPYmplY3QgKmt3ZHMpCit7CisgICAgaW50ICgq
YWN0aW9uX2Z1bmMpKHhjX2ludGVyZmFjZSAqeGNoLCBjaGFyICpuYW1lLCB1aW50MzJfdCB0aW1l
b3V0LCB1aW50NjRfdCBmbGFncyk7CisgICAgY2hhciAqbmFtZTsKKyAgICB1bnNpZ25lZCBpbnQg
YWN0aW9uOworICAgIHVpbnQzMl90IHRpbWVvdXQ7CisgICAgdWludDY0X3QgZmxhZ3M7CisgICAg
aW50IHJjOworCisgICAgc3RhdGljIGNoYXIgKmt3ZF9saXN0W10gPSB7ICJuYW1lIiwgImFjdGlv
biIsICJ0aW1lb3V0IiwgImZsYWdzIiwgTlVMTCB9OworCisgICAgaWYgKCAhUHlBcmdfUGFyc2VU
dXBsZUFuZEtleXdvcmRzKGFyZ3MsIGt3ZHMsICJzSXxJayIsIGt3ZF9saXN0LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbmFtZSwgJmFjdGlvbiwgJnRpbWVvdXQsICZm
bGFncykgKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgc3dpdGNoIChhY3Rpb24pCisgICAg
eworICAgIGNhc2UgTElWRVBBVENIX0FDVElPTl9VTkxPQUQ6CisgICAgICAgIGFjdGlvbl9mdW5j
ID0geGNfbGl2ZXBhdGNoX3VubG9hZDsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBMSVZFUEFU
Q0hfQUNUSU9OX1JFVkVSVDoKKyAgICAgICAgYWN0aW9uX2Z1bmMgPSB4Y19saXZlcGF0Y2hfcmV2
ZXJ0OworICAgICAgICBicmVhazsKKyAgICBjYXNlIExJVkVQQVRDSF9BQ1RJT05fQVBQTFk6Cisg
ICAgICAgIGFjdGlvbl9mdW5jID0geGNfbGl2ZXBhdGNoX2FwcGx5OworICAgICAgICBicmVhazsK
KyAgICBjYXNlIExJVkVQQVRDSF9BQ1RJT05fUkVQTEFDRToKKyAgICAgICAgYWN0aW9uX2Z1bmMg
PSB4Y19saXZlcGF0Y2hfcmVwbGFjZTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAg
ICAgICAgZ290byBlcnJvcjsKKyAgICB9CisKKyAgICByYyA9IGFjdGlvbl9mdW5jKHNlbGYtPnhj
X2hhbmRsZSwgbmFtZSwgdGltZW91dCwgZmxhZ3MpOworICAgIGlmICggcmMgKQorICAgICAgICBn
b3RvIGVycm9yOworCisgICAgcmV0dXJuIFB5X0J1aWxkVmFsdWUoImkiLCByYyk7CitlcnJvcjoK
KyAgICByZXR1cm4gcHl4Y19lcnJvcl90b19leGNlcHRpb24oc2VsZi0+eGNfaGFuZGxlKTsKK30K
Kworc3RhdGljIFB5T2JqZWN0ICpweXhjX2xpdmVwYXRjaF91cGxvYWQoWGNPYmplY3QgKnNlbGYs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQeU9iamVjdCAqYXJncywK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFB5T2JqZWN0ICprd2RzKQor
eworICAgIHVuc2lnbmVkIGNoYXIgKmZidWYgPSBNQVBfRkFJTEVEOworICAgIGNoYXIgKm5hbWUs
ICpmaWxlbmFtZTsKKyAgICBzdHJ1Y3Qgc3RhdCBidWY7CisgICAgaW50IGZkID0gMCwgcmM7Cisg
ICAgc3NpemVfdCBsZW47CisKKyAgICBzdGF0aWMgY2hhciAqa3dkX2xpc3RbXSA9IHsgIm5hbWUi
LCAiZmlsZW5hbWUiLCBOVUxMIH07CisKKyAgICBpZiAoICFQeUFyZ19QYXJzZVR1cGxlQW5kS2V5
d29yZHMoYXJncywga3dkcywgInNzIiwga3dkX2xpc3QsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICZuYW1lLCAmZmlsZW5hbWUpKQorICAgICAgICBnb3RvIGVycm9yOwor
CisgICAgZmQgPSBvcGVuKGZpbGVuYW1lLCBPX1JET05MWSk7CisgICAgaWYgKCBmZCA8IDAgKQor
ICAgICAgICBnb3RvIGVycm9yOworCisgICAgaWYgKCBzdGF0KGZpbGVuYW1lLCAmYnVmKSAhPSAw
ICkKKyAgICAgICAgZ290byBlcnJvcjsKKworICAgIGxlbiA9IGJ1Zi5zdF9zaXplOworICAgIGZi
dWYgPSBtbWFwKDAsIGxlbiwgUFJPVF9SRUFELCBNQVBfUFJJVkFURSwgZmQsIDApOworICAgIGlm
ICggZmJ1ZiA9PSBNQVBfRkFJTEVEICkKKyAgICAgICAgZ290byBlcnJvcjsKKworICAgIHJjID0g
eGNfbGl2ZXBhdGNoX3VwbG9hZChzZWxmLT54Y19oYW5kbGUsIG5hbWUsIGZidWYsIGxlbik7Cisg
ICAgaWYgKCByYyApCisgICAgICAgIGdvdG8gZXJyb3I7CisKKyAgICBpZiAoIG11bm1hcChmYnVm
LCBsZW4pICkKKyAgICB7CisgICAgICAgIGZidWYgPSBNQVBfRkFJTEVEOworICAgICAgICBnb3Rv
IGVycm9yOworICAgIH0KKyAgICBjbG9zZShmZCk7CisKKyAgICByZXR1cm4gUHlfQnVpbGRWYWx1
ZSgiaSIsIHJjKTs7CitlcnJvcjoKKyAgICBpZiAoIGZidWYgIT0gTUFQX0ZBSUxFRCApCisgICAg
ICAgIG11bm1hcChmYnVmLCBsZW4pOworICAgIGlmICggZmQgPj0gMCApCisgICAgICAgIGNsb3Nl
KGZkKTsKKyAgICByZXR1cm4gcHl4Y19lcnJvcl90b19leGNlcHRpb24oc2VsZi0+eGNfaGFuZGxl
KTsKK30KKworc3RhdGljIFB5T2JqZWN0ICpweXhjX2xpdmVwYXRjaF9saXN0KFhjT2JqZWN0ICpz
ZWxmKQoreworICAgIFB5T2JqZWN0ICpsaXN0OworICAgIHVuc2lnbmVkIGludCBuciwgZG9uZSwg
bGVmdCwgaTsKKyAgICB4ZW5fbGl2ZXBhdGNoX3N0YXR1c190ICppbmZvID0gTlVMTDsKKyAgICBj
aGFyICpuYW1lID0gTlVMTDsKKyAgICBjaGFyICptZXRhZGF0YSA9IE5VTEw7CisgICAgdWludDMy
X3QgKmxlbiA9IE5VTEw7CisgICAgdWludDMyX3QgKm1ldGFkYXRhX2xlbiA9IE5VTEw7CisgICAg
dWludDY0X3QgbmFtZV90b3RhbF9zaXplLCBtZXRhZGF0YV90b3RhbF9zaXplOworICAgIG9mZl90
IG5hbWVfb2ZmLCBtZXRhZGF0YV9vZmY7CisgICAgaW50IHJjOworCisgICAgcmMgPSB4Y19saXZl
cGF0Y2hfbGlzdF9nZXRfc2l6ZXMoc2VsZi0+eGNfaGFuZGxlLCAmbnIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJm5hbWVfdG90YWxfc2l6ZSwgJm1ldGFkYXRhX3RvdGFs
X3NpemUpOworICAgIGlmICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgaWYgKCBu
ciA9PSAwICkKKyAgICAgICAgcmV0dXJuIFB5TGlzdF9OZXcoMCk7CisKKyAgICByYyA9IEVOT01F
TTsKKyAgICBpbmZvID0gbWFsbG9jKG5yICogc2l6ZW9mKCppbmZvKSk7CisgICAgaWYgKCAhaW5m
byApCisgICAgICAgIGdvdG8gZXJyb3I7CisKKyAgICBuYW1lID0gbWFsbG9jKG5hbWVfdG90YWxf
c2l6ZSAqIHNpemVvZigqbmFtZSkpOworICAgIGlmICggIW5hbWUgKQorICAgICAgICBnb3RvIGVy
cm9yOworCisgICAgbGVuID0gbWFsbG9jKG5yICogc2l6ZW9mKCpsZW4pKTsKKyAgICBpZiAoICFs
ZW4gKQorICAgICAgICBnb3RvIGVycm9yOworCisgICAgbWV0YWRhdGEgPSBtYWxsb2MobWV0YWRh
dGFfdG90YWxfc2l6ZSAqIHNpemVvZigqbWV0YWRhdGEpKTsKKyAgICBpZiAoICFtZXRhZGF0YSAp
CisgICAgICAgIGdvdG8gZXJyb3I7CisKKyAgICBtZXRhZGF0YV9sZW4gPSBtYWxsb2MobnIgKiBz
aXplb2YoKm1ldGFkYXRhX2xlbikpOworICAgIGlmICggIW1ldGFkYXRhX2xlbiApCisgICAgICAg
IGdvdG8gZXJyb3I7CisKKyAgICByYyA9IHhjX2xpdmVwYXRjaF9saXN0KHNlbGYtPnhjX2hhbmRs
ZSwgbnIsIDAsIGluZm8sCisgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lLCBsZW4sIG5h
bWVfdG90YWxfc2l6ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLCBtZXRh
ZGF0YV9sZW4sIG1ldGFkYXRhX3RvdGFsX3NpemUsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAmZG9uZSwgJmxlZnQpOworICAgIGlmICggcmMgKQorICAgICAgICBnb3RvIGVycm9yOworCisg
ICAgbGlzdCA9IFB5TGlzdF9OZXcoZG9uZSk7CisgICAgbmFtZV9vZmYgPSBtZXRhZGF0YV9vZmYg
PSAwOworICAgIGZvciAoIGkgPSAwOyBpIDwgZG9uZTsgaSsrICkKKyAgICB7CisgICAgICAgIFB5
T2JqZWN0ICppbmZvX2RpY3QsICptZXRhZGF0YV9saXN0OworICAgICAgICBjaGFyICpuYW1lX3N0
ciwgKm1ldGFkYXRhX3N0cjsKKworICAgICAgICBuYW1lX3N0ciA9IG5hbWUgKyBuYW1lX29mZjsK
KyAgICAgICAgbWV0YWRhdGFfc3RyID0gbWV0YWRhdGEgKyBtZXRhZGF0YV9vZmY7CisKKyAgICAg
ICAgbWV0YWRhdGFfbGlzdCA9IFB5TGlzdF9OZXcoMCk7CisgICAgICAgIGZvciAoIGNoYXIgKnMg
PSBtZXRhZGF0YV9zdHI7IHMgPCBtZXRhZGF0YV9zdHIgKyBtZXRhZGF0YV9sZW5baV07IHMgKz0g
c3RybGVuKHMpICsgMSApCisgICAgICAgIHsKKyAgICAgICAgICAgIFB5T2JqZWN0ICpmaWVsZCA9
IFB5X0J1aWxkVmFsdWUoInMiLCBzKTsKKyAgICAgICAgICAgIGlmICggZmllbGQgPT0gTlVMTCAp
CisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgUHlfREVDUkVGKGxpc3QpOworICAgICAg
ICAgICAgICAgIFB5X0RFQ1JFRihtZXRhZGF0YV9saXN0KTsKKyAgICAgICAgICAgICAgICByYyA9
IEVGQVVMVDsKKyAgICAgICAgICAgICAgICBnb3RvIGVycm9yOworICAgICAgICAgICAgfQorCisg
ICAgICAgICAgICBQeUxpc3RfQXBwZW5kKG1ldGFkYXRhX2xpc3QsIGZpZWxkKTsKKyAgICAgICAg
ICAgIFB5X0RFQ1JFRihmaWVsZCk7CisgICAgICAgIH0KKworICAgICAgICBpbmZvX2RpY3QgPSBQ
eV9CdWlsZFZhbHVlKAorICAgICAgICAgICAgIntzOnMsczppLHM6aSxzOk59IiwKKyAgICAgICAg
ICAgICJuYW1lIiwgICAgIG5hbWVfc3RyLAorICAgICAgICAgICAgInN0YXRlIiwgICAgaW5mb1tp
XS5zdGF0ZSwKKyAgICAgICAgICAgICJyYyIsICAgICAgIGluZm9baV0ucmMsCisgICAgICAgICAg
ICAibWV0YWRhdGEiLCBtZXRhZGF0YV9saXN0KTsKKworICAgICAgICBpZiAoIGluZm9fZGljdCA9
PSBOVUxMICkKKyAgICAgICAgeworICAgICAgICAgICAgUHlfREVDUkVGKGxpc3QpOworICAgICAg
ICAgICAgUHlfREVDUkVGKG1ldGFkYXRhX2xpc3QpOworICAgICAgICAgICAgcmMgPSBFRkFVTFQ7
CisgICAgICAgICAgICBnb3RvIGVycm9yOworICAgICAgICB9CisgICAgICAgIFB5TGlzdF9TZXRJ
dGVtKGxpc3QsIGksIGluZm9fZGljdCk7CisgICAgICAgIFB5X0RFQ1JFRihpbmZvX2RpY3QpOwor
CisgICAgICAgIG5hbWVfb2ZmICs9IGxlbltpXTsKKyAgICAgICAgbWV0YWRhdGFfb2ZmICs9IG1l
dGFkYXRhX2xlbltpXTsKKyAgICB9CisKK2Vycm9yOgorICAgIGZyZWUoaW5mbyk7CisgICAgZnJl
ZShuYW1lKTsKKyAgICBmcmVlKGxlbik7CisgICAgZnJlZShtZXRhZGF0YSk7CisgICAgZnJlZSht
ZXRhZGF0YV9sZW4pOworICAgIHJldHVybiByYyA/IHB5eGNfZXJyb3JfdG9fZXhjZXB0aW9uKHNl
bGYtPnhjX2hhbmRsZSkgOiBsaXN0OworfQorCiBzdGF0aWMgUHlNZXRob2REZWYgcHl4Y19tZXRo
b2RzW10gPSB7CiAgICAgeyAiZG9tYWluX2NyZWF0ZSIsIAogICAgICAgKFB5Q0Z1bmN0aW9uKXB5
eGNfZG9tYWluX2NyZWF0ZSwgCkBAIC0yNTQyLDYgKzI3NjYsNDQgQEAgc3RhdGljIFB5TWV0aG9k
RGVmIHB5eGNfbWV0aG9kc1tdID0gewogICAgICAgIlJldHVybnM6IFtpbnRdOiAwIG9uIGFsbCBw
ZXJtaXNzaW9uIGdyYW50ZWQ7IC0xIGlmIGFueSBwZXJtaXNzaW9ucyBhcmUgXAogICAgICAgIGRl
bmllZFxuIiB9LCAKIAorICAgIHsgImxpdmVwYXRjaF9zdGF0dXMiLAorICAgICAgKFB5Q0Z1bmN0
aW9uKXB5eGNfbGl2ZXBhdGNoX3N0YXR1cywKKyAgICAgIE1FVEhfS0VZV09SRFMsICJcbiIKKyAg
ICAgICJHZXRzIGN1cnJlbnQgc3RhdGUgYW5kIHJldHVybiBjb2RlIGZvciBhIHNwZWNpZmllZCBt
b2R1bGUuXG4iCisgICAgICAiIG5hbWUgICAgIFtzdHJdOiBNb2R1bGUgbmFtZSB0byBiZSB1c2Vk
XG4iCisgICAgICAiUmV0dXJuczogW2RpY3RdIG9uIHN1Y2Nlc3M7IHRocm93aW5nIGFuIGV4Y2Vw
dGlvbiBvbiBlcnJvclxuIgorICAgICAgIiBzdGF0ZSAgICBbaW50XTogTW9kdWxlIGN1cnJlbnQg
c3RhdGU6IENIRUNLRUQgb3IgQVBQTElFRFxuIgorICAgICAgIiByYyAgICAgICBbaW50XTogUmV0
dXJuIGNvZGUgb2YgbGFzdCBtb2R1bGUncyBvcGVyYXRpb25cbiIgfSwKKworICAgIHsgImxpdmVw
YXRjaF91cGxvYWQiLAorICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBhdGNoX3VwbG9hZCwK
KyAgICAgIE1FVEhfS0VZV09SRFMsICJcbiIKKyAgICAgICJVcGxvYWRzIGEgbW9kdWxlIHdpdGgg
c3BlY2lmaWVkIG5hbWUgZnJvbSBmaWxlbmFtZS5cbiIKKyAgICAgICIgbmFtZSAgICAgW3N0cl06
IE1vZHVsZSBuYW1lIHRvIGJlIHVzZWRcbiIKKyAgICAgICIgZmlsZW5hbWUgW3N0cl06IEZpbGVu
YW1lIG9mIGEgbW9kdWxlIHRvIGJlIHVwbG9hZGVkXG4iCisgICAgICAiUmV0dXJuczogW2ludF0g
MCBvbiBzdWNjZXNzOyB0aHJvd2luZyBhbiBleGNlcHRpb24gb24gZXJyb3JcbiIgfSwKKworICAg
IHsgImxpdmVwYXRjaF9hY3Rpb24iLAorICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBhdGNo
X2FjdGlvbiwKKyAgICAgIE1FVEhfS0VZV09SRFMsICJcbiIKKyAgICAgICJQZXJmb3JtcyBhbiBh
Y3Rpb24gKHVubG9hZCwgcmV2ZXJ0LCBhcHBseSBvciByZXBsYWNlKSBvbiBhIHNwZWNpZmllZCBc
CisgICAgICAgbW9kdWxlLlxuIgorICAgICAgIiBuYW1lICAgICAgW3N0cl06IE1vZHVsZSBuYW1l
IHRvIGJlIHVzZWRcbiIKKyAgICAgICIgYWN0aW9uICAgW3VpbnRdOiBBY3Rpb24gZW51bSBpZFxu
IgorICAgICAgIiB0aW1lb3V0ICBbdWludF06IEFjdGlvbiBzY2hlZHVsZWQgZXhlY3V0aW9uIHRp
bWVvdXRcbiIKKyAgICAgICIgZmxhZ3MgICBbdWxvbmddOiBGbGFncyBzcGVjaWZ5aW5nIGFjdGlv
bidzIGV4dHJhIHBhcmFtZXRlcnNcbiIKKyAgICAgICJSZXR1cm5zOiBbaW50XSAwIG9uIHN1Y2Nl
c3M7IHRocm93aW5nIGFuIGV4Y2VwdGlvbiBvbiBlcnJvclxuIiB9LAorCisgICAgeyAibGl2ZXBh
dGNoX2xpc3QiLAorICAgICAgKFB5Q0Z1bmN0aW9uKXB5eGNfbGl2ZXBhdGNoX2xpc3QsCisgICAg
ICBNRVRIX05PQVJHUywgIlxuIgorICAgICAgIkxpc3QgYWxsIHVwbG9hZGVkIGxpdmVwYXRjaCBt
b2R1bGVzIHdpdGggdGhlaXIgY3VycmVudCBzdGF0ZSBhbmQgbWV0YWRhdGEuXG4iCisgICAgICAi
UmV0dXJuczogW2xpc3Qgb2YgZGljdHNdIG9uIHN1Y2Nlc3M7IHRocm93aW5nIGFuIGV4Y2VwdGlv
biBvbiBlcnJvclxuIgorICAgICAgIiBuYW1lICAgICBbc3RyXTogTW9kdWxlIG5hbWVcbiIKKyAg
ICAgICIgc3RhdGUgICAgW2ludF06IE1vZHVsZSBjdXJyZW50IHN0YXRlOiBDSEVDS0VEIG9yIEFQ
UExJRURcbiIKKyAgICAgICIgcmMgICAgICAgW2ludF06IFJldHVybiBjb2RlIG9mIGxhc3QgbW9k
dWxlJ3Mgb3BlcmF0aW9uXG4iCisgICAgICAiIG1ldGFkYXRhIFtsaXN0XTogTGlzdCBvZiBtb2R1
bGUncyBtZXRhZGF0YSAna2V5PXZhbHVlJyBzdHJpbmdzXG4iIH0sCisKICAgICB7IE5VTEwsIE5V
TEwsIDAsIE5VTEwgfQogfTsKIApAQCAtMjY1Myw2ICsyOTE1LDE3IEBAIFB5TU9ESU5JVF9GVU5D
IGluaXR4Yyh2b2lkKQogICAgIFB5TW9kdWxlX0FkZEludENvbnN0YW50KG0sICJYRU5fU0NIRURV
TEVSX0NSRURJVCIsIFhFTl9TQ0hFRFVMRVJfQ1JFRElUKTsKICAgICBQeU1vZHVsZV9BZGRJbnRD
b25zdGFudChtLCAiWEVOX1NDSEVEVUxFUl9DUkVESVQyIiwgWEVOX1NDSEVEVUxFUl9DUkVESVQy
KTsKIAorICAgIC8qIEV4cG9zZSBsaXZlcGF0Y2ggY29uc3RhbnRzIHRvIFB5dGhvbiAqLworICAg
IFB5TW9kdWxlX0FkZEludENvbnN0YW50KG0sICJMSVZFUEFUQ0hfQUNUSU9OX1VOTE9BRCIsIExJ
VkVQQVRDSF9BQ1RJT05fVU5MT0FEKTsKKyAgICBQeU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAi
TElWRVBBVENIX0FDVElPTl9SRVZFUlQiLCBMSVZFUEFUQ0hfQUNUSU9OX1JFVkVSVCk7CisgICAg
UHlNb2R1bGVfQWRkSW50Q29uc3RhbnQobSwgIkxJVkVQQVRDSF9BQ1RJT05fQVBQTFkiLCBMSVZF
UEFUQ0hfQUNUSU9OX0FQUExZKTsKKyAgICBQeU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAiTElW
RVBBVENIX0FDVElPTl9SRVBMQUNFIiwgTElWRVBBVENIX0FDVElPTl9SRVBMQUNFKTsKKworICAg
IFB5TW9kdWxlX0FkZEludENvbnN0YW50KG0sICJMSVZFUEFUQ0hfQUNUSU9OX0FQUExZX05PREVQ
UyIsIExJVkVQQVRDSF9BQ1RJT05fQVBQTFlfTk9ERVBTKTsKKworICAgIFB5TW9kdWxlX0FkZElu
dENvbnN0YW50KG0sICJMSVZFUEFUQ0hfU1RBVEVfQVBQTElFRCIsIExJVkVQQVRDSF9TVEFURV9B
UFBMSUVEKTsKKyAgICBQeU1vZHVsZV9BZGRJbnRDb25zdGFudChtLCAiTElWRVBBVENIX1NUQVRF
X0NIRUNLRUQiLCBMSVZFUEFUQ0hfU1RBVEVfQ0hFQ0tFRCk7CisKICNpZiBQWV9NQUpPUl9WRVJT
SU9OID49IDMKICAgICByZXR1cm4gbTsKICNlbmRpZgotLSAKMi4xNi41CgoKCgpBbWF6b24gRGV2
ZWxvcG1lbnQgQ2VudGVyIEdlcm1hbnkgR21iSApLcmF1c2Vuc3RyLiAzOAoxMDExNyBCZXJsaW4K
R2VzY2hhZWZ0c2Z1ZWhydW5nOiBDaHJpc3RpYW4gU2NobGFlZ2VyLCBSYWxmIEhlcmJyaWNoCkVp
bmdldHJhZ2VuIGFtIEFtdHNnZXJpY2h0IENoYXJsb3R0ZW5idXJnIHVudGVyIEhSQiAxNDkxNzMg
QgpTaXR6OiBCZXJsaW4KVXN0LUlEOiBERSAyODkgMjM3IDg3OQoKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVu
LWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcv
bWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

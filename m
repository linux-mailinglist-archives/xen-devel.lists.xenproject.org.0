Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 85601B2A9E
	for <lists+xen-devel@lfdr.de>; Sat, 14 Sep 2019 10:56:12 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i93nl-0007Wh-Kl; Sat, 14 Sep 2019 08:53:05 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=rDpt=XJ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1i93nj-0007Vc-K6
 for xen-devel@lists.xenproject.org; Sat, 14 Sep 2019 08:53:03 +0000
X-Inumbo-ID: 0b25a8d9-d6cd-11e9-95c1-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 0b25a8d9-d6cd-11e9-95c1-12813bfff9fa;
 Sat, 14 Sep 2019 08:52:56 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 297DCB60E;
 Sat, 14 Sep 2019 08:52:55 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 14 Sep 2019 10:52:07 +0200
Message-Id: <20190914085251.18816-4-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190914085251.18816-1-jgross@suse.com>
References: <20190914085251.18816-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v3 03/47] xen/sched: build a linked list of
 struct sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gb3JkZXIgdG8gbWFrZSBpdCBlYXN5IHRvIGl0ZXJhdGUgb3ZlciBzY2hlZF91bml0IGVsZW1l
bnRzIG9mIGEKZG9tYWluLCBidWlsZCBhIHNpbmdsZSBsaW5rZWQgbGlzdCBhbmQgYWRkIGFuIGl0
ZXJhdG9yIGZvciBpdC4gVGhlIG5ldwpsaXN0IGlzIGd1YXJkZWQgYnkgdGhlIHNhbWUgbWVjaGFu
aXNtcyBhcyB0aGUgdmNwdSBsaW5rZWQgbGlzdCBhcyBpdAppcyBtb2RpZmllZCBvbmx5IHZpYSB2
Y3B1X2NyZWF0ZSgpIG9yIHZjcHVfZGVzdHJveSgpLgoKRm9yIGNvbXBsZXRlbmVzcyBhZGQgYW5v
dGhlciBpdGVyYXRvciBmb3JfZWFjaF9zY2hlZF91bml0X3ZjcHUoKSB3aGljaAp3aWxsIGl0ZXJh
dGUgb3ZlciBhbGwgdmNwdXMgb2YgYSBzY2hlZF91bml0IChyaWdodCBub3cgb25seSBvbmUpLiBU
aGlzCndpbGwgYmUgbmVlZGVkIGxhdGVyIGZvciBsYXJnZXIgc2NoZWR1bGluZyBncmFudWxhcml0
eSAoZS5nLiBjb3JlcykuCgpTaWduZWQtb2ZmLWJ5OiBKdWVyZ2VuIEdyb3NzIDxqZ3Jvc3NAc3Vz
ZS5jb20+ClJldmlld2VkLWJ5OiBEYXJpbyBGYWdnaW9saSA8ZGZhZ2dpb2xpQHN1c2UuY29tPgot
LS0KVjI6Ci0gYWRkIGNvbW1lbnQgKERhcmlvIEZhZ2dpb2xpKQotLS0KIHhlbi9jb21tb24vc2No
ZWR1bGUuYyAgIHwgNjAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKyst
LS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggfCAxNCArKysrKysrKysrKysKIDIgZmls
ZXMgY2hhbmdlZCwgNjUgaW5zZXJ0aW9ucygrKSwgOSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQg
YS94ZW4vY29tbW9uL3NjaGVkdWxlLmMgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKaW5kZXggODhi
NjZmODA4Yy4uNjE0ZGY5ZDIyNiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jCisr
KyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwpAQCAtMzA1LDIwICszMDUsNjQgQEAgc3RhdGljIHZv
aWQgc2NoZWRfc3Bpbl91bmxvY2tfZG91YmxlKHNwaW5sb2NrX3QgKmxvY2sxLCBzcGlubG9ja190
ICpsb2NrMiwKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKGxvY2sxLCBmbGFncyk7CiB9CiAK
LWludCBzY2hlZF9pbml0X3ZjcHUoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwcm9jZXNz
b3IpCitzdGF0aWMgdm9pZCBzY2hlZF9mcmVlX3VuaXQoc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQp
CiB7Ci0gICAgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKLSAgICBzdHJ1Y3Qgc2NoZWRf
dW5pdCAqdW5pdDsKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqcHJldl91bml0OworICAgIHN0cnVj
dCBkb21haW4gKmQgPSB1bml0LT5kb21haW47CiAKLSAgICB2LT5wcm9jZXNzb3IgPSBwcm9jZXNz
b3I7CisgICAgaWYgKCBkLT5zY2hlZF91bml0X2xpc3QgPT0gdW5pdCApCisgICAgICAgIGQtPnNj
aGVkX3VuaXRfbGlzdCA9IHVuaXQtPm5leHRfaW5fbGlzdDsKKyAgICBlbHNlCisgICAgeworICAg
ICAgICBmb3JfZWFjaF9zY2hlZF91bml0ICggZCwgcHJldl91bml0ICkKKyAgICAgICAgeworICAg
ICAgICAgICAgaWYgKCBwcmV2X3VuaXQtPm5leHRfaW5fbGlzdCA9PSB1bml0ICkKKyAgICAgICAg
ICAgIHsKKyAgICAgICAgICAgICAgICBwcmV2X3VuaXQtPm5leHRfaW5fbGlzdCA9IHVuaXQtPm5l
eHRfaW5fbGlzdDsKKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIH0KKyAgICAg
ICAgfQorICAgIH0KKworICAgIHVuaXQtPnZjcHVfbGlzdC0+c2NoZWRfdW5pdCA9IE5VTEw7Cisg
ICAgeGZyZWUodW5pdCk7Cit9CisKK3N0YXRpYyBzdHJ1Y3Qgc2NoZWRfdW5pdCAqc2NoZWRfYWxs
b2NfdW5pdChzdHJ1Y3QgdmNwdSAqdikKK3sKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwg
KipwcmV2X3VuaXQ7CisgICAgc3RydWN0IGRvbWFpbiAqZCA9IHYtPmRvbWFpbjsKIAogICAgIGlm
ICggKHVuaXQgPSB4emFsbG9jKHN0cnVjdCBzY2hlZF91bml0KSkgPT0gTlVMTCApCi0gICAgICAg
IHJldHVybiAxOworICAgICAgICByZXR1cm4gTlVMTDsKKwogICAgIHVuaXQtPnZjcHVfbGlzdCA9
IHY7CiAgICAgdW5pdC0+dW5pdF9pZCA9IHYtPnZjcHVfaWQ7CiAgICAgdW5pdC0+ZG9tYWluID0g
ZDsKICAgICB2LT5zY2hlZF91bml0ID0gdW5pdDsKIAorICAgIGZvciAoIHByZXZfdW5pdCA9ICZk
LT5zY2hlZF91bml0X2xpc3Q7ICpwcmV2X3VuaXQ7CisgICAgICAgICAgcHJldl91bml0ID0gJigq
cHJldl91bml0KS0+bmV4dF9pbl9saXN0ICkKKyAgICAgICAgaWYgKCAoKnByZXZfdW5pdCktPm5l
eHRfaW5fbGlzdCAmJgorICAgICAgICAgICAgICgqcHJldl91bml0KS0+bmV4dF9pbl9saXN0LT51
bml0X2lkID4gdW5pdC0+dW5pdF9pZCApCisgICAgICAgICAgICBicmVhazsKKworICAgIHVuaXQt
Pm5leHRfaW5fbGlzdCA9ICpwcmV2X3VuaXQ7CisgICAgKnByZXZfdW5pdCA9IHVuaXQ7CisKKyAg
ICByZXR1cm4gdW5pdDsKK30KKworaW50IHNjaGVkX2luaXRfdmNwdShzdHJ1Y3QgdmNwdSAqdiwg
dW5zaWduZWQgaW50IHByb2Nlc3NvcikKK3sKKyAgICBzdHJ1Y3QgZG9tYWluICpkID0gdi0+ZG9t
YWluOworICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0OworCisgICAgdi0+cHJvY2Vzc29yID0g
cHJvY2Vzc29yOworCisgICAgaWYgKCAodW5pdCA9IHNjaGVkX2FsbG9jX3VuaXQodikpID09IE5V
TEwgKQorICAgICAgICByZXR1cm4gMTsKKwogICAgIC8qIEluaXRpYWxpc2UgdGhlIHBlci12Y3B1
IHRpbWVycy4gKi8KICAgICBzcGluX2xvY2tfaW5pdCgmdi0+cGVyaW9kaWNfdGltZXJfbG9jayk7
CiAgICAgaW5pdF90aW1lcigmdi0+cGVyaW9kaWNfdGltZXIsIHZjcHVfcGVyaW9kaWNfdGltZXJf
Zm4sCkBAIC0zMzEsOCArMzc1LDcgQEAgaW50IHNjaGVkX2luaXRfdmNwdShzdHJ1Y3QgdmNwdSAq
diwgdW5zaWduZWQgaW50IHByb2Nlc3NvcikKICAgICB1bml0LT5wcml2ID0gc2NoZWRfYWxsb2Nf
dmRhdGEoZG9tX3NjaGVkdWxlcihkKSwgdW5pdCwgZC0+c2NoZWRfcHJpdik7CiAgICAgaWYgKCB1
bml0LT5wcml2ID09IE5VTEwgKQogICAgIHsKLSAgICAgICAgdi0+c2NoZWRfdW5pdCA9IE5VTEw7
Ci0gICAgICAgIHhmcmVlKHVuaXQpOworICAgICAgICBzY2hlZF9mcmVlX3VuaXQodW5pdCk7CiAg
ICAgICAgIHJldHVybiAxOwogICAgIH0KIApAQCAtNDc1LDggKzUxOCw3IEBAIHZvaWQgc2NoZWRf
ZGVzdHJveV92Y3B1KHN0cnVjdCB2Y3B1ICp2KQogICAgICAgICBhdG9taWNfZGVjKCZwZXJfY3B1
KHNjaGVkdWxlX2RhdGEsIHYtPnByb2Nlc3NvcikudXJnZW50X2NvdW50KTsKICAgICBzY2hlZF9y
ZW1vdmVfdW5pdCh2Y3B1X3NjaGVkdWxlcih2KSwgdW5pdCk7CiAgICAgc2NoZWRfZnJlZV92ZGF0
YSh2Y3B1X3NjaGVkdWxlcih2KSwgdW5pdC0+cHJpdik7Ci0gICAgdi0+c2NoZWRfdW5pdCA9IE5V
TEw7Ci0gICAgeGZyZWUodW5pdCk7CisgICAgc2NoZWRfZnJlZV91bml0KHVuaXQpOwogfQogCiBp
bnQgc2NoZWRfaW5pdF9kb21haW4oc3RydWN0IGRvbWFpbiAqZCwgaW50IHBvb2xpZCkKZGlmZiAt
LWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgK
aW5kZXggMWY1OGI3MjM0MS4uODkwMzgzMzdiNCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVu
L3NjaGVkLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKQEAgLTI3Nyw5ICsyNzcsMjIg
QEAgc3RydWN0IHNjaGVkX3VuaXQgewogICAgIHN0cnVjdCBkb21haW4gICAgICAgICAqZG9tYWlu
OwogICAgIHN0cnVjdCB2Y3B1ICAgICAgICAgICAqdmNwdV9saXN0OwogICAgIHZvaWQgICAgICAg
ICAgICAgICAgICAqcHJpdjsgICAgICAvKiBzY2hlZHVsZXIgcHJpdmF0ZSBkYXRhICovCisgICAg
c3RydWN0IHNjaGVkX3VuaXQgICAgICpuZXh0X2luX2xpc3Q7CiAgICAgdW5zaWduZWQgaW50ICAg
ICAgICAgICB1bml0X2lkOwogfTsKIAorI2RlZmluZSBmb3JfZWFjaF9zY2hlZF91bml0KGQsIGUp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgZm9yICggKGUp
ID0gKGQpLT5zY2hlZF91bml0X2xpc3Q7IChlKSAhPSBOVUxMOyAoZSkgPSAoZSktPm5leHRfaW5f
bGlzdCApCisKKy8qCisgKiBBbGwgdmNwdXMgb2YgYSBkb21haW4gYXJlIGluIGEgc2luZ2xlIGxp
bmtlZCBsaXN0IHdpdGggdW5pdC0+dmNwdV9saXN0CisgKiBwb2ludGluZyB0byB0aGUgZmlyc3Qg
dmNwdSBvZiB0aGUgdW5pdC4gVGhlIGxvb3AgbXVzdCBiZSB0ZXJtaW5hdGVkIHdoZW4KKyAqIGEg
dmNwdSBpcyBoaXQgbm90IGJlaW5nIHBhcnQgb2YgdGhlIHVuaXQgdG8gbG9vcCBvdmVyLgorICov
CisjZGVmaW5lIGZvcl9lYWNoX3NjaGVkX3VuaXRfdmNwdShpLCB2KSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCAodikgPSAoaSktPnZjcHVfbGlzdDsgKHYp
ICE9IE5VTEwgJiYgKHYpLT5zY2hlZF91bml0ID09IChpKTsgICAgXAorICAgICAgICAgICh2KSA9
ICh2KS0+bmV4dF9pbl9saXN0ICkKKwogLyogUGVyLWRvbWFpbiBsb2NrIGNhbiBiZSByZWN1cnNp
dmVseSBhY3F1aXJlZCBpbiBmYXVsdCBoYW5kbGVycy4gKi8KICNkZWZpbmUgZG9tYWluX2xvY2so
ZCkgc3Bpbl9sb2NrX3JlY3Vyc2l2ZSgmKGQpLT5kb21haW5fbG9jaykKICNkZWZpbmUgZG9tYWlu
X3VubG9jayhkKSBzcGluX3VubG9ja19yZWN1cnNpdmUoJihkKS0+ZG9tYWluX2xvY2spCkBAIC0z
MzMsNiArMzQ2LDcgQEAgc3RydWN0IGRvbWFpbgogCiAgICAgLyogU2NoZWR1bGluZy4gKi8KICAg
ICB2b2lkICAgICAgICAgICAgKnNjaGVkX3ByaXY7ICAgIC8qIHNjaGVkdWxlci1zcGVjaWZpYyBk
YXRhICovCisgICAgc3RydWN0IHNjaGVkX3VuaXQgKnNjaGVkX3VuaXRfbGlzdDsKICAgICBzdHJ1
Y3QgY3B1cG9vbCAgKmNwdXBvb2w7CiAKICAgICBzdHJ1Y3QgZG9tYWluICAgKm5leHRfaW5fbGlz
dDsKLS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=

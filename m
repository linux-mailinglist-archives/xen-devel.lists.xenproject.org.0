Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B9A406E72A
	for <lists+xen-devel@lfdr.de>; Fri, 19 Jul 2019 16:10:56 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hoTY8-00073s-K5; Fri, 19 Jul 2019 14:07:52 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=RcFV=VQ=citrix.com=roger.pau@srs-us1.protection.inumbo.net>)
 id 1hoTY6-00073D-WE
 for xen-devel@lists.xenproject.org; Fri, 19 Jul 2019 14:07:51 +0000
X-Inumbo-ID: 9676bc19-aa2e-11e9-8980-bc764e045a96
Received: from esa3.hc3370-68.iphmx.com (unknown [216.71.145.155])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 9676bc19-aa2e-11e9-8980-bc764e045a96;
 Fri, 19 Jul 2019 14:07:48 +0000 (UTC)
Authentication-Results: esa3.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=roger.pau@citrix.com;
 spf=Pass smtp.mailfrom=roger.pau@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 roger.pau@citrix.com) identity=pra; client-ip=162.221.158.21;
 receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa3.hc3370-68.iphmx.com: domain of
 roger.pau@citrix.com designates 162.221.158.21 as permitted
 sender) identity=mailfrom; client-ip=162.221.158.21;
 receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: EOAS+Rj1csJSvB1j8fEc48Fl7obNLCLZS6nCVLDYbYMu122zAlqx4PhtT+IOdXIlTYehjlzQdX
 9fUrrliqWo0vyNrOzSnALCc7QRfIL8pBkqpve02Q87bKU6aOLHfhco8kKzjyP+PfA/BXlRd7e6
 XR6sfxBGmvMeyR4V+cBybOcdZHEnTKWKlRhOJ6fzIgU3G12tB4okjfuah7/BhmwyJVsltwHriP
 5qZYgvm7n4GvTYSWDhMyOD0g/kd+TeG1mLdZCyhF2HH00btT57KFcblFqq4ZPChlFkzO6YyFO/
 CFs=
X-SBRS: 2.7
X-MesageID: 3200829
X-Ironport-Server: esa3.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,282,1559534400"; 
   d="scan'208";a="3200829"
From: Roger Pau Monne <roger.pau@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Fri, 19 Jul 2019 16:07:23 +0200
Message-ID: <20190719140724.69596-6-roger.pau@citrix.com>
X-Mailer: git-send-email 2.20.1 (Apple Git-117)
In-Reply-To: <20190719140724.69596-1-roger.pau@citrix.com>
References: <20190719140724.69596-1-roger.pau@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v4 5/6] pci: switch pci_conf_write16 to use
 pci_sbdf_t
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>, Konrad
 Rzeszutek Wilk <konrad.wilk@oracle.com>, George
 Dunlap <George.Dunlap@eu.citrix.com>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyByZWR1Y2VzIHRoZSBudW1iZXIgb2YgcGFyYW1ldGVycyBvZiB0aGUgZnVuY3Rpb24gdG8g
dHdvLCBhbmQKc2ltcGxpZmllcyBzb21lIG9mIHRoZSBjYWxsaW5nIHNpdGVzLgoKU2lnbmVkLW9m
Zi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+ClJldmlld2VkLWJ5
OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQpDYzogSmFuIEJldWxpY2ggPGpi
ZXVsaWNoQHN1c2UuY29tPgpDYzogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4
LmNvbT4KQ2M6IFdlaSBMaXUgPHdsQHhlbi5vcmc+CkNjOiBHZW9yZ2UgRHVubGFwIDxHZW9yZ2Uu
RHVubGFwQGV1LmNpdHJpeC5jb20+CkNjOiBJYW4gSmFja3NvbiA8aWFuLmphY2tzb25AZXUuY2l0
cml4LmNvbT4KQ2M6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdyYWxsQGFybS5jb20+CkNjOiBLb25y
YWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+CkNjOiBTdGVmYW5vIFN0
YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CkNjOiBUaW0gRGVlZ2FuIDx0aW1AeGVu
Lm9yZz4KLS0tCkNoYW5nZXMgc2luY2UgdjM6CiAtIFJlbW92ZSBzdHJheSBjaGFuZ2Ugb2YgcGNp
X2NvbmZfd3JpdGUzMiBjYWxsLgotLS0KIHhlbi9hcmNoL3g4Ni9tc2kuYyAgICAgICAgICAgICAg
ICB8IDUzICsrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni94ODZf
NjQvcGNpLmMgICAgICAgICB8IDIxICsrKysrLS0tLS0tLQogeGVuL2RyaXZlcnMvY2hhci9laGNp
LWRiZ3AuYyAgICAgIHwgIDYgKystLQogeGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMgICAgICAg
IHwgIDkgKysrKy0tCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYyAgICAgfCAxOCArKysr
LS0tLS0tLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0cy5jIHwgIDYgKystLQogeGVu
L2RyaXZlcnMvcGNpL3BjaS5jICAgICAgICAgICAgIHwgIDYgKy0tLQogeGVuL2RyaXZlcnMvdnBj
aS9oZWFkZXIuYyAgICAgICAgIHwgMjIgKysrKy0tLS0tLS0tLQogeGVuL2RyaXZlcnMvdnBjaS9t
c2kuYyAgICAgICAgICAgIHwgIDQgKy0tCiB4ZW4vZHJpdmVycy92cGNpL21zaXguYyAgICAgICAg
ICAgfCAgMiArLQogeGVuL2RyaXZlcnMvdnBjaS92cGNpLmMgICAgICAgICAgIHwgIDggKystLS0K
IHhlbi9pbmNsdWRlL3hlbi9wY2kuaCAgICAgICAgICAgICB8ICA0ICstLQogMTIgZmlsZXMgY2hh
bmdlZCwgNjIgaW5zZXJ0aW9ucygrKSwgOTcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVu
L2FyY2gveDg2L21zaS5jIGIveGVuL2FyY2gveDg2L21zaS5jCmluZGV4IDUyNjE3Y2Q4NDMuLmYz
ZTVjNWNiMDMgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tc2kuYworKysgYi94ZW4vYXJjaC94
ODYvbXNpLmMKQEAgLTI2NywxMiArMjY3LDEwIEBAIHN0YXRpYyBpbnQgd3JpdGVfbXNpX21zZyhz
dHJ1Y3QgbXNpX2Rlc2MgKmVudHJ5LCBzdHJ1Y3QgbXNpX21zZyAqbXNnKQogICAgICAgICB7CiAg
ICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2lfdXBw
ZXJfYWRkcmVzc19yZWcocG9zKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLT5h
ZGRyZXNzX2hpKTsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIHNsb3Qs
IGZ1bmMsIG1zaV9kYXRhX3JlZyhwb3MsIDEpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBtc2ctPmRhdGEpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihkZXYtPnNiZGYsIG1z
aV9kYXRhX3JlZyhwb3MsIDEpLCBtc2ctPmRhdGEpOwogICAgICAgICB9CiAgICAgICAgIGVsc2UK
LSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIHNsb3QsIGZ1bmMsIG1zaV9k
YXRhX3JlZyhwb3MsIDApLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2ctPmRhdGEp
OworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihkZXYtPnNiZGYsIG1zaV9kYXRhX3JlZyhw
b3MsIDApLCBtc2ctPmRhdGEpOwogICAgICAgICBicmVhazsKICAgICB9CiAgICAgY2FzZSBQQ0lf
Q0FQX0lEX01TSVg6CkBAIC0zMjksNyArMzI3LDggQEAgdm9pZCBfX21zaV9zZXRfZW5hYmxlKHUx
NiBzZWcsIHU4IGJ1cywgdTggc2xvdCwgdTggZnVuYywgaW50IHBvcywgaW50IGVuYWJsZSkKICAg
ICBjb250cm9sICY9IH5QQ0lfTVNJX0ZMQUdTX0VOQUJMRTsKICAgICBpZiAoIGVuYWJsZSApCiAg
ICAgICAgIGNvbnRyb2wgfD0gUENJX01TSV9GTEFHU19FTkFCTEU7Ci0gICAgcGNpX2NvbmZfd3Jp
dGUxNihzZWcsIGJ1cywgc2xvdCwgZnVuYywgcG9zICsgUENJX01TSV9GTEFHUywgY29udHJvbCk7
CisgICAgcGNpX2NvbmZfd3JpdGUxNihQQ0lfU0JERihzZWcsIGJ1cywgc2xvdCwgZnVuYyksCisg
ICAgICAgICAgICAgICAgICAgICBwb3MgKyBQQ0lfTVNJX0ZMQUdTLCBjb250cm9sKTsKIH0KIAog
c3RhdGljIHZvaWQgbXNpX3NldF9lbmFibGUoc3RydWN0IHBjaV9kZXYgKmRldiwgaW50IGVuYWJs
ZSkKQEAgLTM2MCw3ICszNTksNyBAQCBzdGF0aWMgdm9pZCBtc2l4X3NldF9lbmFibGUoc3RydWN0
IHBjaV9kZXYgKmRldiwgaW50IGVuYWJsZSkKICAgICAgICAgY29udHJvbCAmPSB+UENJX01TSVhf
RkxBR1NfRU5BQkxFOwogICAgICAgICBpZiAoIGVuYWJsZSApCiAgICAgICAgICAgICBjb250cm9s
IHw9IFBDSV9NU0lYX0ZMQUdTX0VOQUJMRTsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzZWcs
IGJ1cywgc2xvdCwgZnVuYywgbXNpeF9jb250cm9sX3JlZyhwb3MpLCBjb250cm9sKTsKKyAgICAg
ICAgcGNpX2NvbmZfd3JpdGUxNihkZXYtPnNiZGYsIG1zaXhfY29udHJvbF9yZWcocG9zKSwgY29u
dHJvbCk7CiAgICAgfQogfQogCkBAIC00MDYsNyArNDA1LDcgQEAgc3RhdGljIGJvb2wgbXNpX3Nl
dF9tYXNrX2JpdChzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2MsIGJvb2wgaG9zdCwgYm9vbCBndWVzdCkK
ICAgICAgICAgaWYgKCB1bmxpa2VseSghKGNvbnRyb2wgJiBQQ0lfTVNJWF9GTEFHU19FTkFCTEUp
KSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBkZXYtPm1zaXgtPmhvc3RfbWFza2FsbCA9IDE7
Ci0gICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLAorICAg
ICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBtc2l4X2NvbnRyb2xfcmVnKGVudHJ5LT5tc2lfYXR0cmliLnBvcyksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgfCAoUENJX01TSVhfRkxBR1NfRU5BQkxF
IHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfTVNJWF9GTEFH
U19NQVNLQUxMKSk7CkBAIC00NDAsNyArNDM5LDcgQEAgc3RhdGljIGJvb2wgbXNpX3NldF9tYXNr
X2JpdChzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2MsIGJvb2wgaG9zdCwgYm9vbCBndWVzdCkKICAgICAg
ICAgcGRldi0+bXNpeC0+aG9zdF9tYXNrYWxsID0gbWFza2FsbDsKICAgICAgICAgaWYgKCBtYXNr
YWxsIHx8IHBkZXYtPm1zaXgtPmd1ZXN0X21hc2thbGwgKQogICAgICAgICAgICAgY29udHJvbCB8
PSBQQ0lfTVNJWF9GTEFHU19NQVNLQUxMOwotICAgICAgICBwY2lfY29uZl93cml0ZTE2KHNlZywg
YnVzLCBzbG90LCBmdW5jLAorICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgbXNpeF9jb250cm9sX3JlZyhlbnRyeS0+bXNpX2F0dHJp
Yi5wb3MpLCBjb250cm9sKTsKICAgICAgICAgcmV0dXJuIGZsYWc7CiAgICAgZGVmYXVsdDoKQEAg
LTU4MCw4ICs1NzksNyBAQCBpbnQgc2V0dXBfbXNpX2lycShzdHJ1Y3QgaXJxX2Rlc2MgKmRlc2Ms
IHN0cnVjdCBtc2lfZGVzYyAqbXNpZGVzYykKICAgICB7CiAgICAgICAgIGNvbnRyb2wgPSBwY2lf
Y29uZl9yZWFkMTYocGRldi0+c2JkZiwgY3Bvcyk7CiAgICAgICAgIGlmICggIShjb250cm9sICYg
UENJX01TSVhfRkxBR1NfRU5BQkxFKSApCi0gICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBk
ZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xPVChwZGV2LT5kZXZmbiksCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYtPmRldmZuKSwgY3BvcywKKyAgICAgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgY3BvcywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29udHJvbCB8IChQQ0lfTVNJWF9GTEFHU19FTkFCTEUgfAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9NU0lYX0ZMQUdTX01BU0tBTEwpKTsKICAg
ICB9CkBAIC01OTEsOCArNTg5LDcgQEAgaW50IHNldHVwX21zaV9pcnEoc3RydWN0IGlycV9kZXNj
ICpkZXNjLCBzdHJ1Y3QgbXNpX2Rlc2MgKm1zaWRlc2MpCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICZwY2lfbXNpX25vbm1hc2thYmxlKTsKIAog
ICAgIGlmICggIShjb250cm9sICYgUENJX01TSVhfRkxBR1NfRU5BQkxFKSApCi0gICAgICAgIHBj
aV9jb25mX3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIFBDSV9TTE9UKHBkZXYtPmRldmZu
KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfRlVOQyhwZGV2LT5kZXZmbiksIGNwb3Ms
IGNvbnRyb2wpOworICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIGNwb3MsIGNv
bnRyb2wpOwogCiAgICAgcmV0dXJuIHJjOwogfQpAQCAtNzM1LDcgKzczMiw3IEBAIHN0YXRpYyBp
bnQgbXNpX2NhcGFiaWxpdHlfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LAogICAgICAgICBwY2lf
aW50eChkZXYsIGZhbHNlKTsKICAgICAgICAgY29udHJvbCB8PSBQQ0lfTVNJX0ZMQUdTX0VOQUJM
RTsKICAgICB9Ci0gICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXNp
X2NvbnRyb2xfcmVnKHBvcyksIGNvbnRyb2wpOworICAgIHBjaV9jb25mX3dyaXRlMTYoZGV2LT5z
YmRmLCBtc2lfY29udHJvbF9yZWcocG9zKSwgY29udHJvbCk7CiAKICAgICByZXR1cm4gMDsKIH0K
QEAgLTg1NiwxMyArODUzLDEzIEBAIHN0YXRpYyBpbnQgbXNpeF9jYXBhYmlsaXR5X2luaXQoc3Ry
dWN0IHBjaV9kZXYgKmRldiwKICAgICAgKiBmdWxseSBzZXQgdXAuCiAgICAgICovCiAgICAgbXNp
eC0+aG9zdF9tYXNrYWxsID0gMTsKLSAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90
LCBmdW5jLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisgICAgcGNpX2NvbmZfd3JpdGUxNihkZXYt
PnNiZGYsIG1zaXhfY29udHJvbF9yZWcocG9zKSwKICAgICAgICAgICAgICAgICAgICAgIGNvbnRy
b2wgfCAoUENJX01TSVhfRkxBR1NfRU5BQkxFIHwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgUENJX01TSVhfRkxBR1NfTUFTS0FMTCkpOwogCiAgICAgaWYgKCB1bmxpa2VseSghbWVt
b3J5X2RlY29kZWQoZGV2KSkgKQogICAgIHsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzZWcs
IGJ1cywgc2xvdCwgZnVuYywgbXNpeF9jb250cm9sX3JlZyhwb3MpLAorICAgICAgICBwY2lfY29u
Zl93cml0ZTE2KGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnRyb2wgJiB+UENJX01TSVhfRkxBR1NfRU5BQkxFKTsKICAgICAgICAg
cmV0dXJuIC1FTlhJTzsKICAgICB9CkBAIC04NzIsNyArODY5LDcgQEAgc3RhdGljIGludCBtc2l4
X2NhcGFiaWxpdHlfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LAogICAgICAgICBlbnRyeSA9IGFs
bG9jX21zaV9lbnRyeSgxKTsKICAgICAgICAgaWYgKCAhZW50cnkgKQogICAgICAgICB7Ci0gICAg
ICAgICAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2l4X2NvbnRy
b2xfcmVnKHBvcyksCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+c2JkZiwgbXNp
eF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9s
ICYgflBDSV9NU0lYX0ZMQUdTX0VOQUJMRSk7CiAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsK
ICAgICAgICAgfQpAQCAtOTA1LDcgKzkwMiw3IEBAIHN0YXRpYyBpbnQgbXNpeF9jYXBhYmlsaXR5
X2luaXQoc3RydWN0IHBjaV9kZXYgKmRldiwKICAgICB7CiAgICAgICAgIGlmICggIW1zaSB8fCAh
bXNpLT50YWJsZV9iYXNlICkKICAgICAgICAgewotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUx
NihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXNpeF9jb250cm9sX3JlZyhwb3MpLAorICAgICAgICAg
ICAgcGNpX2NvbmZfd3JpdGUxNihkZXYtPnNiZGYsIG1zaXhfY29udHJvbF9yZWcocG9zKSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbCAmIH5QQ0lfTVNJWF9GTEFHU19FTkFC
TEUpOwogICAgICAgICAgICAgeGZyZWUoZW50cnkpOwogICAgICAgICAgICAgcmV0dXJuIC1FTlhJ
TzsKQEAgLTk0OCw3ICs5NDUsNyBAQCBzdGF0aWMgaW50IG1zaXhfY2FwYWJpbGl0eV9pbml0KHN0
cnVjdCBwY2lfZGV2ICpkZXYsCiAKICAgICAgICAgaWYgKCBpZHggPCAwICkKICAgICAgICAgewot
ICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXNpeF9j
b250cm9sX3JlZyhwb3MpLAorICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihkZXYtPnNiZGYs
IG1zaXhfY29udHJvbF9yZWcocG9zKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
dHJvbCAmIH5QQ0lfTVNJWF9GTEFHU19FTkFCTEUpOwogICAgICAgICAgICAgeGZyZWUoZW50cnkp
OwogICAgICAgICAgICAgcmV0dXJuIGlkeDsKQEAgLTEwMjQsNyArMTAyMSw3IEBAIHN0YXRpYyBp
bnQgbXNpeF9jYXBhYmlsaXR5X2luaXQoc3RydWN0IHBjaV9kZXYgKmRldiwKICAgICAgICAgbWFz
a2FsbCA9IDA7CiAgICAgfQogICAgIG1zaXgtPmhvc3RfbWFza2FsbCA9IG1hc2thbGw7Ci0gICAg
cGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXNpeF9jb250cm9sX3JlZyhw
b3MpLCBjb250cm9sKTsKKyAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+c2JkZiwgbXNpeF9jb250
cm9sX3JlZyhwb3MpLCBjb250cm9sKTsKIAogICAgIHJldHVybiAwOwogfQpAQCAtMTE2Niw3ICsx
MTYzLDcgQEAgc3RhdGljIHZvaWQgX19wY2lfZGlzYWJsZV9tc2l4KHN0cnVjdCBtc2lfZGVzYyAq
ZW50cnkpCiAgICAgaWYgKCB1bmxpa2VseSghKGNvbnRyb2wgJiBQQ0lfTVNJWF9GTEFHU19FTkFC
TEUpKSApCiAgICAgewogICAgICAgICBkZXYtPm1zaXgtPmhvc3RfbWFza2FsbCA9IDE7Ci0gICAg
ICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIHNsb3QsIGZ1bmMsIG1zaXhfY29udHJvbF9y
ZWcocG9zKSwKKyAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihkZXYtPnNiZGYsIG1zaXhfY29udHJv
bF9yZWcocG9zKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sIHwgKFBDSV9NU0lY
X0ZMQUdTX0VOQUJMRSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lf
TVNJWF9GTEFHU19NQVNLQUxMKSk7CiAgICAgfQpAQCAtMTE4NSw3ICsxMTgyLDcgQEAgc3RhdGlj
IHZvaWQgX19wY2lfZGlzYWJsZV9tc2l4KHN0cnVjdCBtc2lfZGVzYyAqZW50cnkpCiAgICAgZGV2
LT5tc2l4LT5ob3N0X21hc2thbGwgPSBtYXNrYWxsOwogICAgIGlmICggbWFza2FsbCB8fCBkZXYt
Pm1zaXgtPmd1ZXN0X21hc2thbGwgKQogICAgICAgICBjb250cm9sIHw9IFBDSV9NU0lYX0ZMQUdT
X01BU0tBTEw7Ci0gICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXNp
eF9jb250cm9sX3JlZyhwb3MpLCBjb250cm9sKTsKKyAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+
c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLCBjb250cm9sKTsKIAogICAgIF9wY2lfY2xlYW51
cF9tc2l4KGRldi0+bXNpeCk7CiB9CkBAIC0xMzgxLDggKzEzNzgsNyBAQCBpbnQgcGNpX3Jlc3Rv
cmVfbXNpX3N0YXRlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICAgICAgICAgICAgICBw
ZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgaSk7CiAgICAgICAgICAgICBzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZkZXNjLT5sb2NrLCBmbGFncyk7CiAgICAgICAgICAgICBpZiAoIHR5
cGUgPT0gUENJX0NBUF9JRF9NU0lYICkKLSAgICAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2
KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbXNpeF9jb250cm9sX3JlZyhwb3MpLAorICAgICAgICAgICAgICAgIHBjaV9j
b25mX3dyaXRlMTYocGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbCAmIH5QQ0lfTVNJWF9GTEFHU19FTkFCTEUp
OwogICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAgICAgICAgIH0KQEAgLTEzOTcsMTUgKzEz
OTMsMTMgQEAgaW50IHBjaV9yZXN0b3JlX21zaV9zdGF0ZShzdHJ1Y3QgcGNpX2RldiAqcGRldikK
ICAgICAgICAgZWxzZSBpZiAoICF0eXBlICYmIGVudHJ5LT5tc2lfYXR0cmliLnR5cGUgPT0gUENJ
X0NBUF9JRF9NU0lYICkKICAgICAgICAgewogICAgICAgICAgICAgY29udHJvbCA9IHBjaV9jb25m
X3JlYWQxNihwZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcykpOwotICAgICAgICAgICAg
cGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbXNpeF9jb250cm9sX3JlZyhwb3MpLAorICAgICAgICAg
ICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgfCAoUENJX01TSVhfRkxBR1NfRU5B
QkxFIHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfTVNJWF9G
TEFHU19NQVNLQUxMKSk7CiAgICAgICAgICAgICBpZiAoIHVubGlrZWx5KCFtZW1vcnlfZGVjb2Rl
ZChwZGV2KSkgKQogICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIHNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJmRlc2MtPmxvY2ssIGZsYWdzKTsKLSAgICAgICAgICAgICAgICBwY2lfY29uZl93
cml0ZTE2KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbXNpeF9jb250cm9sX3JlZyhwb3MpLAorICAgICAgICAgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbCAmIH5QQ0lfTVNJWF9GTEFHU19F
TkFCTEUpOwogICAgICAgICAgICAgICAgIHJldHVybiAtRU5YSU87CiAgICAgICAgICAgICB9CkBA
IC0xNDQwLDE1ICsxNDM0LDE0IEBAIGludCBwY2lfcmVzdG9yZV9tc2lfc3RhdGUoc3RydWN0IHBj
aV9kZXYgKnBkZXYpCiAKICAgICAgICAgICAgIGNvbnRyb2wgPSBwY2lfY29uZl9yZWFkMTYocGRl
di0+c2JkZiwgY3BvcykgJiB+UENJX01TSV9GTEFHU19RU0laRTsKICAgICAgICAgICAgIG11bHRp
X21zaV9lbmFibGUoY29udHJvbCwgZW50cnktPm1zaS5udmVjKTsKLSAgICAgICAgICAgIHBjaV9j
b25mX3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsIGNwb3MsIGNvbnRy
b2wpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBjcG9zLCBjb250
cm9sKTsKIAogICAgICAgICAgICAgbXNpX3NldF9lbmFibGUocGRldiwgMSk7CiAgICAgICAgIH0K
ICAgICB9CiAKICAgICBpZiAoIHR5cGUgPT0gUENJX0NBUF9JRF9NU0lYICkKLSAgICAgICAgcGNp
X2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywKLSAgICAgICAg
ICAgICAgICAgICAgICAgICBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisgICAgICAgIHBjaV9jb25m
X3dyaXRlMTYocGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnRyb2wgfCBQQ0lfTVNJWF9GTEFHU19FTkFCTEUpOwogCiAgICAgcmV0
dXJuIDA7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYveDg2XzY0L3BjaS5jIGIveGVuL2FyY2gv
eDg2L3g4Nl82NC9wY2kuYwppbmRleCBlYWE2N2IwNGYyLi5mMDE0ZmUwZmM1IDEwMDY0NAotLS0g
YS94ZW4vYXJjaC94ODYveDg2XzY0L3BjaS5jCisrKyBiL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGNp
LmMKQEAgLTU4LDIzICs1OCwxOCBAQCB2b2lkIHBjaV9jb25mX3dyaXRlOChwY2lfc2JkZl90IHNi
ZGYsIHVuc2lnbmVkIGludCByZWcsIHVpbnQ4X3QgZGF0YSkKICAgICAgICAgcGNpX2NvbmZfd3Jp
dGUoUENJX0NPTkZfQUREUkVTUyhzYmRmLCByZWcpLCByZWcgJiAzLCAxLCBkYXRhKTsKIH0KIAot
I3VuZGVmIFBDSV9DT05GX0FERFJFU1MKLSNkZWZpbmUgUENJX0NPTkZfQUREUkVTUyhidXMsIGRl
diwgZnVuYywgcmVnKSBcCi0gICAgKDB4ODAwMDAwMDAgfCAoYnVzIDw8IDE2KSB8IChkZXYgPDwg
MTEpIHwgKGZ1bmMgPDwgOCkgfCAocmVnICYgfjMpKQotCi12b2lkIHBjaV9jb25mX3dyaXRlMTYo
Ci0gICAgdW5zaWduZWQgaW50IHNlZywgdW5zaWduZWQgaW50IGJ1cywgdW5zaWduZWQgaW50IGRl
diwgdW5zaWduZWQgaW50IGZ1bmMsCi0gICAgdW5zaWduZWQgaW50IHJlZywgdWludDE2X3QgZGF0
YSkKK3ZvaWQgcGNpX2NvbmZfd3JpdGUxNihwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCBy
ZWcsIHVpbnQxNl90IGRhdGEpCiB7Ci0gICAgaWYgKCBzZWcgfHwgcmVnID4gMjU1ICkKLSAgICAg
ICAgcGNpX21tY2ZnX3dyaXRlKHNlZywgYnVzLCBQQ0lfREVWRk4oZGV2LCBmdW5jKSwgcmVnLCAy
LCBkYXRhKTsKKyAgICBpZiAoIHNiZGYuc2VnIHx8IHJlZyA+IDI1NSApCisgICAgICAgIHBjaV9t
bWNmZ193cml0ZShzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYuZGV2Zm4sIHJlZywgMiwgZGF0YSk7
CiAgICAgZWxzZQotICAgIHsKLSAgICAgICAgQlVHX09OKChidXMgPiAyNTUpIHx8IChkZXYgPiAz
MSkgfHwgKGZ1bmMgPiA3KSk7Ci0gICAgICAgIHBjaV9jb25mX3dyaXRlKFBDSV9DT05GX0FERFJF
U1MoYnVzLCBkZXYsIGZ1bmMsIHJlZyksIHJlZyAmIDIsIDIsIGRhdGEpOwotICAgIH0KKyAgICAg
ICAgcGNpX2NvbmZfd3JpdGUoUENJX0NPTkZfQUREUkVTUyhzYmRmLCByZWcpLCByZWcgJiAyLCAy
LCBkYXRhKTsKIH0KIAorI3VuZGVmIFBDSV9DT05GX0FERFJFU1MKKyNkZWZpbmUgUENJX0NPTkZf
QUREUkVTUyhidXMsIGRldiwgZnVuYywgcmVnKSBcCisgICAgKDB4ODAwMDAwMDAgfCAoYnVzIDw8
IDE2KSB8IChkZXYgPDwgMTEpIHwgKGZ1bmMgPDwgOCkgfCAocmVnICYgfjMpKQorCiB2b2lkIHBj
aV9jb25mX3dyaXRlMzIoCiAgICAgdW5zaWduZWQgaW50IHNlZywgdW5zaWduZWQgaW50IGJ1cywg
dW5zaWduZWQgaW50IGRldiwgdW5zaWduZWQgaW50IGZ1bmMsCiAgICAgdW5zaWduZWQgaW50IHJl
ZywgdWludDMyX3QgZGF0YSkKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL2NoYXIvZWhjaS1kYmdw
LmMgYi94ZW4vZHJpdmVycy9jaGFyL2VoY2ktZGJncC5jCmluZGV4IDAxMGZjM2M1YmMuLmI3ODAz
MzQ5NTMgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL2NoYXIvZWhjaS1kYmdwLmMKKysrIGIveGVu
L2RyaXZlcnMvY2hhci9laGNpLWRiZ3AuYwpAQCAtMTMyNCw4ICsxMzI0LDggQEAgc3RhdGljIHZv
aWQgX19pbml0IGVoY2lfZGJncF9pbml0X3ByZWlycShzdHJ1Y3Qgc2VyaWFsX3BvcnQgKnBvcnQp
CiAgICAgaWYgKCAhKGRiZ3AtPnBjaV9jciAmIFBDSV9DT01NQU5EX01FTU9SWSkgKQogICAgIHsK
ICAgICAgICAgZGJncC0+cGNpX2NyIHw9IFBDSV9DT01NQU5EX01FTU9SWTsKLSAgICAgICAgcGNp
X2NvbmZfd3JpdGUxNigwLCBkYmdwLT5idXMsIGRiZ3AtPnNsb3QsIGRiZ3AtPmZ1bmMsIFBDSV9D
T01NQU5ELAotICAgICAgICAgICAgICAgICAgICAgICAgIGRiZ3AtPnBjaV9jcik7CisgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwgZGJncC0+YnVzLCBkYmdwLT5zbG90LCBkYmdw
LT5mdW5jKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfQ09NTUFORCwgZGJncC0+cGNp
X2NyKTsKICAgICAgICAgZGJncF9wcmludGsoIk1NSU8gZm9yIEVIQ0kgZW5hYmxlZFxuIik7CiAg
ICAgfQogCkBAIC0xNDM4LDcgKzE0MzgsNyBAQCBzdGF0aWMgdm9pZCBlaGNpX2RiZ3BfcmVzdW1l
KHN0cnVjdCBzZXJpYWxfcG9ydCAqcG9ydCkKIAogICAgIHBjaV9jb25mX3dyaXRlMzIoMCwgZGJn
cC0+YnVzLCBkYmdwLT5zbG90LCBkYmdwLT5mdW5jLCBkYmdwLT5iYXIsCiAgICAgICAgICAgICAg
ICAgICAgICBkYmdwLT5iYXJfdmFsKTsKLSAgICBwY2lfY29uZl93cml0ZTE2KDAsIGRiZ3AtPmJ1
cywgZGJncC0+c2xvdCwgZGJncC0+ZnVuYywKKyAgICBwY2lfY29uZl93cml0ZTE2KFBDSV9TQkRG
KDAsIGRiZ3AtPmJ1cywgZGJncC0+c2xvdCwgZGJncC0+ZnVuYyksCiAgICAgICAgICAgICAgICAg
ICAgICBQQ0lfQ09NTUFORCwgZGJncC0+cGNpX2NyKTsKIAogICAgIGVoY2lfZGJncF9zZXR1cF9w
cmVpcnEoZGJncCk7CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYyBiL3hl
bi9kcml2ZXJzL2NoYXIvbnMxNjU1MC5jCmluZGV4IGZlNzE0MDZjYzEuLjIwZWFlY2VlNTkgMTAw
NjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL2NoYXIvbnMxNjU1MC5jCisrKyBiL3hlbi9kcml2ZXJzL2No
YXIvbnMxNjU1MC5jCkBAIC02MjQsNyArNjI0LDggQEAgc3RhdGljIHZvaWQgcGNpX3NlcmlhbF9l
YXJseV9pbml0KHN0cnVjdCBuczE2NTUwICp1YXJ0KQogICAgICAgICByZXR1cm47CiAKICAgICBp
ZiAoIHVhcnQtPnBiX2JkZl9lbmFibGUgKQotICAgICAgICBwY2lfY29uZl93cml0ZTE2KDAsIHVh
cnQtPnBiX2JkZlswXSwgdWFydC0+cGJfYmRmWzFdLCB1YXJ0LT5wYl9iZGZbMl0sCisgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwgdWFydC0+cGJfYmRmWzBdLCB1YXJ0LT5wYl9i
ZGZbMV0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWFydC0+cGJfYmRmWzJd
KSwKICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfSU9fQkFTRSwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAodWFydC0+aW9fYmFzZSAmIDB4RjAwMCkgfAogICAgICAgICAgICAgICAgICAg
ICAgICAgICgodWFydC0+aW9fYmFzZSAmIDB4RjAwMCkgPj4gOCkpOwpAQCAtNjMyLDcgKzYzMyw4
IEBAIHN0YXRpYyB2b2lkIHBjaV9zZXJpYWxfZWFybHlfaW5pdChzdHJ1Y3QgbnMxNjU1MCAqdWFy
dCkKICAgICBwY2lfY29uZl93cml0ZTMyKDAsIHVhcnQtPnBzX2JkZlswXSwgdWFydC0+cHNfYmRm
WzFdLCB1YXJ0LT5wc19iZGZbMl0sCiAgICAgICAgICAgICAgICAgICAgICBQQ0lfQkFTRV9BRERS
RVNTXzAsCiAgICAgICAgICAgICAgICAgICAgICB1YXJ0LT5pb19iYXNlIHwgUENJX0JBU0VfQURE
UkVTU19TUEFDRV9JTyk7Ci0gICAgcGNpX2NvbmZfd3JpdGUxNigwLCB1YXJ0LT5wc19iZGZbMF0s
IHVhcnQtPnBzX2JkZlsxXSwgdWFydC0+cHNfYmRmWzJdLAorICAgIHBjaV9jb25mX3dyaXRlMTYo
UENJX1NCREYoMCwgdWFydC0+cHNfYmRmWzBdLCB1YXJ0LT5wc19iZGZbMV0sCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1YXJ0LT5wc19iZGZbMl0pLAogICAgICAgICAgICAgICAgICAg
ICAgUENJX0NPTU1BTkQsIFBDSV9DT01NQU5EX0lPKTsKICNlbmRpZgogfQpAQCAtODY3LDcgKzg2
OSw4IEBAIHN0YXRpYyB2b2lkIF9uczE2NTUwX3Jlc3VtZShzdHJ1Y3Qgc2VyaWFsX3BvcnQgKnBv
cnQpCiAgICAgICAgICAgICAgICAgICAgICAgICB1YXJ0LT5wc19iZGZbMV0sIHVhcnQtPnBzX2Jk
ZlsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCArICh1YXJ0
LT5iYXJfaWR4KzEpKjQsIHVhcnQtPmJhcjY0KTsKIAotICAgICAgIHBjaV9jb25mX3dyaXRlMTYo
MCwgdWFydC0+cHNfYmRmWzBdLCB1YXJ0LT5wc19iZGZbMV0sIHVhcnQtPnBzX2JkZlsyXSwKKyAg
ICAgICBwY2lfY29uZl93cml0ZTE2KFBDSV9TQkRGKDAsIHVhcnQtPnBzX2JkZlswXSwgdWFydC0+
cHNfYmRmWzFdLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWFydC0+cHNfYmRm
WzJdKSwKICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9DT01NQU5ELCB1YXJ0LT5jcik7CiAg
ICAgfQogI2VuZGlmCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYyBi
L3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jCmluZGV4IDdmOTU3M2NlZWUuLmVlMmI5Y2Mw
MWMgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3BjaS5jCkBAIC0yNDgsMTUgKzI0OCwxMyBAQCBzdGF0aWMgdm9p
ZCBjaGVja19wZGV2KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgIHsKICAgICAgICAg
dmFsID0gcGNpX2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5EKTsKICAgICAgICAg
aWYgKCB2YWwgJiBjb21tYW5kX21hc2sgKQotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihz
ZWcsIGJ1cywgZGV2LCBmdW5jLCBQQ0lfQ09NTUFORCwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdmFsICYgfmNvbW1hbmRfbWFzayk7CisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2
KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5ELCB2YWwgJiB+Y29tbWFuZF9tYXNrKTsKICAgICAgICAg
dmFsID0gcGNpX2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9TVEFUVVMpOwogICAgICAgICBp
ZiAoIHZhbCAmIFBDSV9TVEFUVVNfQ0hFQ0sgKQogICAgICAgICB7CiAgICAgICAgICAgICBwcmlu
dGsoWEVOTE9HX0lORk8gIiUwNHg6JTAyeDolMDJ4LiV1IHN0YXR1cyAlMDR4IC0+ICUwNHhcbiIs
CiAgICAgICAgICAgICAgICAgICAgc2VnLCBidXMsIGRldiwgZnVuYywgdmFsLCB2YWwgJiB+UENJ
X1NUQVRVU19DSEVDSyk7Ci0gICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBk
ZXYsIGZ1bmMsIFBDSV9TVEFUVVMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbCAm
IFBDSV9TVEFUVVNfQ0hFQ0spOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5z
YmRmLCBQQ0lfU1RBVFVTLCB2YWwgJiBQQ0lfU1RBVFVTX0NIRUNLKTsKICAgICAgICAgfQogICAg
IH0KIApAQCAtMjY3LDcgKzI2NSw3IEBAIHN0YXRpYyB2b2lkIGNoZWNrX3BkZXYoY29uc3Qgc3Ry
dWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgdmFsID0gcGNp
X2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9CUklER0VfQ09OVFJPTCk7CiAgICAgICAgIGlm
ICggdmFsICYgYnJpZGdlX2N0bF9tYXNrICkKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYo
c2VnLCBidXMsIGRldiwgZnVuYywgUENJX0JSSURHRV9DT05UUk9MLAorICAgICAgICAgICAgcGNp
X2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBQQ0lfQlJJREdFX0NPTlRST0wsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZhbCAmIH5icmlkZ2VfY3RsX21hc2spOwogICAgICAgICB2YWwg
PSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX1NFQ19TVEFUVVMpOwogICAgICAgICBp
ZiAoIHZhbCAmIFBDSV9TVEFUVVNfQ0hFQ0sgKQpAQCAtMjc1LDcgKzI3Myw3IEBAIHN0YXRpYyB2
b2lkIGNoZWNrX3BkZXYoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgICAgICBw
cmludGsoWEVOTE9HX0lORk8KICAgICAgICAgICAgICAgICAgICAiJTA0eDolMDJ4OiUwMnguJXUg
c2Vjb25kYXJ5IHN0YXR1cyAlMDR4IC0+ICUwNHhcbiIsCiAgICAgICAgICAgICAgICAgICAgc2Vn
LCBidXMsIGRldiwgZnVuYywgdmFsLCB2YWwgJiB+UENJX1NUQVRVU19DSEVDSyk7Ci0gICAgICAg
ICAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBkZXYsIGZ1bmMsIFBDSV9TRUNfU1RBVFVT
LAorICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBQQ0lfU0VDX1NUQVRV
UywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsICYgUENJX1NUQVRVU19DSEVDSyk7
CiAgICAgICAgIH0KICAgICAgICAgYnJlYWs7CkBAIC01OTYsOCArNTk0LDYgQEAgc3RhdGljIHZv
aWQgcGNpX2VuYWJsZV9hY3Moc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgaW50IHBvczsKICAg
ICB1MTYgY2FwLCBjdHJsLCBzZWcgPSBwZGV2LT5zZWc7CiAgICAgdTggYnVzID0gcGRldi0+YnVz
OwotICAgIHU4IGRldiA9IFBDSV9TTE9UKHBkZXYtPmRldmZuKTsKLSAgICB1OCBmdW5jID0gUENJ
X0ZVTkMocGRldi0+ZGV2Zm4pOwogCiAgICAgaWYgKCAhaW9tbXVfZW5hYmxlZCApCiAgICAgICAg
IHJldHVybjsKQEAgLTYyMSw3ICs2MTcsNyBAQCBzdGF0aWMgdm9pZCBwY2lfZW5hYmxlX2Fjcyhz
dHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAvKiBVcHN0cmVhbSBGb3J3YXJkaW5nICovCiAgICAg
Y3RybCB8PSAoY2FwICYgUENJX0FDU19VRik7CiAKLSAgICBwY2lfY29uZl93cml0ZTE2KHNlZywg
YnVzLCBkZXYsIGZ1bmMsIHBvcyArIFBDSV9BQ1NfQ1RSTCwgY3RybCk7CisgICAgcGNpX2NvbmZf
d3JpdGUxNihwZGV2LT5zYmRmLCBwb3MgKyBQQ0lfQUNTX0NUUkwsIGN0cmwpOwogfQogCiBzdGF0
aWMgaW50IGlvbW11X2FkZF9kZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBkZXYpOwpAQCAtMTAzMSwx
MCArMTAyNyw4IEBAIHZvaWQgcGNpX2NoZWNrX2Rpc2FibGVfZGV2aWNlKHUxNiBzZWcsIHU4IGJ1
cywgdTggZGV2Zm4pCiAKICAgICAvKiBUZWxsIHRoZSBkZXZpY2UgdG8gc3RvcCBETUFpbmc7IHdl
IGNhbid0IHJlbHkgb24gdGhlIGd1ZXN0IHRvCiAgICAgICogY29udHJvbCBpdCBmb3IgdXMuICov
Ci0gICAgZGV2Zm4gPSBwZGV2LT5kZXZmbjsKICAgICBjd29yZCA9IHBjaV9jb25mX3JlYWQxNihw
ZGV2LT5zYmRmLCBQQ0lfQ09NTUFORCk7Ci0gICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywg
UENJX1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbiksCi0gICAgICAgICAgICAgICAgICAgICBQ
Q0lfQ09NTUFORCwgY3dvcmQgJiB+UENJX0NPTU1BTkRfTUFTVEVSKTsKKyAgICBwY2lfY29uZl93
cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5ELCBjd29yZCAmIH5QQ0lfQ09NTUFORF9NQVNU
RVIpOwogfQogCiAvKgpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0
cy5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0cy5jCmluZGV4IGNiMDIyYzU5OGEu
LjNlZWE3Zjg5ZmMgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9hdHMu
YworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvYXRzLmMKQEAgLTUwLDggKzUwLDcg
QEAgaW50IGVuYWJsZV9hdHNfZGV2aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBzdHJ1Y3QgbGlz
dF9oZWFkICphdHNfbGlzdCkKICAgICBpZiAoICEodmFsdWUgJiBBVFNfRU5BQkxFKSApCiAgICAg
ewogICAgICAgICB2YWx1ZSB8PSBBVFNfRU5BQkxFOwotICAgICAgICBwY2lfY29uZl93cml0ZTE2
KHNlZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICBwb3MgKyBBVFNfUkVHX0NUTCwgdmFsdWUpOworICAgICAgICBwY2lfY29u
Zl93cml0ZTE2KHBkZXYtPnNiZGYsIHBvcyArIEFUU19SRUdfQ1RMLCB2YWx1ZSk7CiAgICAgfQog
CiAgICAgaWYgKCBwb3MgKQpAQCAtODEsOCArODAsNyBAQCB2b2lkIGRpc2FibGVfYXRzX2Rldmlj
ZShzdHJ1Y3QgcGNpX2RldiAqcGRldikKIAogICAgIHZhbHVlID0gcGNpX2NvbmZfcmVhZDE2KHBk
ZXYtPnNiZGYsIHBkZXYtPmF0cy5jYXBfcG9zICsgQVRTX1JFR19DVEwpOwogICAgIHZhbHVlICY9
IH5BVFNfRU5BQkxFOwotICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIFBDSV9TTE9UKGRl
dmZuKSwgUENJX0ZVTkMoZGV2Zm4pLAotICAgICAgICAgICAgICAgICAgICAgcGRldi0+YXRzLmNh
cF9wb3MgKyBBVFNfUkVHX0NUTCwgdmFsdWUpOworICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+
c2JkZiwgcGRldi0+YXRzLmNhcF9wb3MgKyBBVFNfUkVHX0NUTCwgdmFsdWUpOwogCiAgICAgbGlz
dF9kZWwoJnBkZXYtPmF0cy5saXN0KTsKIApkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGNpL3Bj
aS5jIGIveGVuL2RyaXZlcnMvcGNpL3BjaS5jCmluZGV4IGIyNDcwMmUwYzMuLjRkZTVmZGY2Nzkg
MTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3BjaS9wY2kuYworKysgYi94ZW4vZHJpdmVycy9wY2kv
cGNpLmMKQEAgLTExNiwxNyArMTE2LDEzIEBAIGludCBwY2lfZmluZF9uZXh0X2V4dF9jYXBhYmls
aXR5KGludCBzZWcsIGludCBidXMsIGludCBkZXZmbiwgaW50IHN0YXJ0LCBpbnQgY2FwCiAKIHZv
aWQgcGNpX2ludHgoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIGJvb2wgZW5hYmxlKQogewot
ICAgIHVpbnQxNl90IHNlZyA9IHBkZXYtPnNlZzsKLSAgICB1aW50OF90IGJ1cyA9IHBkZXYtPmJ1
czsKLSAgICB1aW50OF90IHNsb3QgPSBQQ0lfU0xPVChwZGV2LT5kZXZmbik7Ci0gICAgdWludDhf
dCBmdW5jID0gUENJX0ZVTkMocGRldi0+ZGV2Zm4pOwogICAgIHVpbnQxNl90IGNtZCA9IHBjaV9j
b25mX3JlYWQxNihwZGV2LT5zYmRmLCBQQ0lfQ09NTUFORCk7CiAKICAgICBpZiAoIGVuYWJsZSAp
CiAgICAgICAgIGNtZCAmPSB+UENJX0NPTU1BTkRfSU5UWF9ESVNBQkxFOwogICAgIGVsc2UKICAg
ICAgICAgY21kIHw9IFBDSV9DT01NQU5EX0lOVFhfRElTQUJMRTsKLSAgICBwY2lfY29uZl93cml0
ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBQQ0lfQ09NTUFORCwgY21kKTsKKyAgICBwY2lfY29u
Zl93cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5ELCBjbWQpOwogfQogCiBjb25zdCBjaGFy
ICpfX2luaXQgcGFyc2VfcGNpKGNvbnN0IGNoYXIgKnMsIHVuc2lnbmVkIGludCAqc2VnX3AsCmRp
ZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5jIGIveGVuL2RyaXZlcnMvdnBjaS9o
ZWFkZXIuYwppbmRleCA3NDc2NjM0OTgyLi5mMzc3ZTZhYmRmIDEwMDY0NAotLS0gYS94ZW4vZHJp
dmVycy92cGNpL2hlYWRlci5jCisrKyBiL3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMKQEAgLTEy
Myw4ICsxMjMsNyBAQCBzdGF0aWMgdm9pZCBtb2RpZnlfZGVjb2RpbmcoY29uc3Qgc3RydWN0IHBj
aV9kZXYgKnBkZXYsIHVpbnQxNl90IGNtZCwKICAgICB9CiAKICAgICBpZiAoICFyb21fb25seSAp
Ci0gICAgICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1
bmMsIFBDSV9DT01NQU5ELAotICAgICAgICAgICAgICAgICAgICAgICAgIGNtZCk7CisgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIGNtZCk7CiAgICAgZWxz
ZQogICAgICAgICBBU1NFUlRfVU5SRUFDSEFCTEUoKTsKIH0KQEAgLTMzNSw3ICszMzQsNiBAQCBz
dGF0aWMgaW50IG1vZGlmeV9iYXJzKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1aW50MTZf
dCBjbWQsIGJvb2wgcm9tX29ubHkpCiBzdGF0aWMgdm9pZCBjbWRfd3JpdGUoY29uc3Qgc3RydWN0
IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgICAgICAgICAgICAgICAgICAg
dWludDMyX3QgY21kLCB2b2lkICpkYXRhKQogewotICAgIHVpbnQ4X3Qgc2xvdCA9IFBDSV9TTE9U
KHBkZXYtPmRldmZuKSwgZnVuYyA9IFBDSV9GVU5DKHBkZXYtPmRldmZuKTsKICAgICB1aW50MTZf
dCBjdXJyZW50X2NtZCA9IHBjaV9jb25mX3JlYWQxNihwZGV2LT5zYmRmLCByZWcpOwogCiAgICAg
LyoKQEAgLTM1MSw3ICszNDksNyBAQCBzdGF0aWMgdm9pZCBjbWRfd3JpdGUoY29uc3Qgc3RydWN0
IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgICAgICAqLwogICAgICAgICBt
b2RpZnlfYmFycyhwZGV2LCBjbWQsIGZhbHNlKTsKICAgICBlbHNlCi0gICAgICAgIHBjaV9jb25m
X3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsIHJlZywgY21kKTsKKyAg
ICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCByZWcsIGNtZCk7CiB9CiAKIHN0YXRp
YyB2b2lkIGJhcl93cml0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50
IHJlZywKQEAgLTM5Nyw4ICszOTUsNyBAQCBzdGF0aWMgdm9pZCBiYXJfd3JpdGUoY29uc3Qgc3Ry
dWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgICAgIHZhbCB8PSBiYXIt
PnByZWZldGNoYWJsZSA/IFBDSV9CQVNFX0FERFJFU1NfTUVNX1BSRUZFVENIIDogMDsKICAgICB9
CiAKLSAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYtPnNlZywgcGRldi0+YnVzLCBQQ0lfU0xPVChw
ZGV2LT5kZXZmbiksCi0gICAgICAgICAgICAgICAgICAgICBQQ0lfRlVOQyhwZGV2LT5kZXZmbiks
IHJlZywgdmFsKTsKKyAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYtPnNlZywgcGRldi0+YnVzLCBz
bG90LCBmdW5jLCByZWcsIHZhbCk7CiB9CiAKIHN0YXRpYyB2b2lkIHJvbV93cml0ZShjb25zdCBz
dHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKQEAgLTQ1Miw3ICs0NDksNiBA
QCBzdGF0aWMgdm9pZCByb21fd3JpdGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2ln
bmVkIGludCByZWcsCiAKIHN0YXRpYyBpbnQgaW5pdF9iYXJzKHN0cnVjdCBwY2lfZGV2ICpwZGV2
KQogewotICAgIHVpbnQ4X3Qgc2xvdCA9IFBDSV9TTE9UKHBkZXYtPmRldmZuKSwgZnVuYyA9IFBD
SV9GVU5DKHBkZXYtPmRldmZuKTsKICAgICB1aW50MTZfdCBjbWQ7CiAgICAgdWludDY0X3QgYWRk
ciwgc2l6ZTsKICAgICB1bnNpZ25lZCBpbnQgaSwgbnVtX2JhcnMsIHJvbV9yZWc7CkBAIC00ODgs
OCArNDg0LDcgQEAgc3RhdGljIGludCBpbml0X2JhcnMoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAg
ICAgLyogRGlzYWJsZSBtZW1vcnkgZGVjb2RpbmcgYmVmb3JlIHNpemluZy4gKi8KICAgICBjbWQg
PSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQpOwogICAgIGlmICggY21k
ICYgUENJX0NPTU1BTkRfTUVNT1JZICkKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5z
ZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgUENJX0NPTU1BTkQsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgY21kICYgflBDSV9DT01NQU5EX01FTU9SWSk7CisgICAgICAgIHBjaV9jb25mX3dy
aXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIGNtZCAmIH5QQ0lfQ09NTUFORF9NRU1PUlkp
OwogCiAgICAgZm9yICggaSA9IDA7IGkgPCBudW1fYmFyczsgaSsrICkKICAgICB7CkBAIC01MDMs
OCArNDk4LDcgQEAgc3RhdGljIGludCBpbml0X2JhcnMoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQsICZiYXJzW2ldKTsKICAgICAgICAg
ICAgIGlmICggcmMgKQogICAgICAgICAgICAgewotICAgICAgICAgICAgICAgIHBjaV9jb25mX3dy
aXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBQQ0lfQ09NTUFORCwgY21kKTsKKyAgICAgICAgICAgICAgICBwY2lf
Y29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5ELCBjbWQpOwogICAgICAgICAgICAg
ICAgIHJldHVybiByYzsKICAgICAgICAgICAgIH0KIApAQCAtNTI3LDggKzUyMSw3IEBAIHN0YXRp
YyBpbnQgaW5pdF9iYXJzKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKGkgPT0gbnVtX2JhcnMgLSAxKSA/IFBDSV9CQVJfTEFTVCA6IDApOwogICAg
ICAgICBpZiAoIHJjIDwgMCApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRl
MTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsIFBDSV9DT01NQU5ELAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjbWQpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUx
NihwZGV2LT5zYmRmLCBQQ0lfQ09NTUFORCwgY21kKTsKICAgICAgICAgICAgIHJldHVybiByYzsK
ICAgICAgICAgfQogCkBAIC01NDYsOCArNTM5LDcgQEAgc3RhdGljIGludCBpbml0X2JhcnMoc3Ry
dWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmJhcnNb
aV0pOwogICAgICAgICBpZiAoIHJjICkKICAgICAgICAgewotICAgICAgICAgICAgcGNpX2NvbmZf
d3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgUENJX0NPTU1BTkQsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZCk7CisgICAgICAgICAgICBwY2lfY29uZl93
cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5ELCBjbWQpOwogICAgICAgICAgICAgcmV0dXJu
IHJjOwogICAgICAgICB9CiAgICAgfQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBjaS9tc2ku
YyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpLmMKaW5kZXggOGZlODlmYzkxMi4uNWI2NjAyZjNjMiAx
MDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvdnBjaS9tc2kuYworKysgYi94ZW4vZHJpdmVycy92cGNp
L21zaS5jCkBAIC03Nyw5ICs3Nyw3IEBAIHN0YXRpYyB2b2lkIGNvbnRyb2xfd3JpdGUoY29uc3Qg
c3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAgICAgbXNpLT52ZWN0b3Jz
ID0gdmVjdG9yczsKICAgICBtc2ktPmVuYWJsZWQgPSBuZXdfZW5hYmxlZDsKIAotICAgIHBjaV9j
b25mX3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIFBDSV9TTE9UKHBkZXYtPmRldmZuKSwK
LSAgICAgICAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYtPmRldmZuKSwgcmVnLAotICAgICAg
ICAgICAgICAgICAgICAgY29udHJvbF9yZWFkKHBkZXYsIHJlZywgZGF0YSkpOworICAgIHBjaV9j
b25mX3dyaXRlMTYocGRldi0+c2JkZiwgcmVnLCBjb250cm9sX3JlYWQocGRldiwgcmVnLCBkYXRh
KSk7CiB9CiAKIHN0YXRpYyB2b2lkIHVwZGF0ZV9tc2koY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBk
ZXYsIHN0cnVjdCB2cGNpX21zaSAqbXNpKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBjaS9t
c2l4LmMgYi94ZW4vZHJpdmVycy92cGNpL21zaXguYwppbmRleCBjNjBjYmEwMTM3Li4zOGMxZTdl
NWRkIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy92cGNpL21zaXguYworKysgYi94ZW4vZHJpdmVy
cy92cGNpL21zaXguYwpAQCAtMTQ2LDcgKzE0Niw3IEBAIHN0YXRpYyB2b2lkIGNvbnRyb2xfd3Jp
dGUoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCiAKICAgICB2
YWwgPSBjb250cm9sX3JlYWQocGRldiwgcmVnLCBkYXRhKTsKICAgICBpZiAoIHBjaV9tc2lfY29u
Zl93cml0ZV9pbnRlcmNlcHQobXNpeC0+cGRldiwgcmVnLCAyLCAmdmFsKSA+PSAwICkKLSAgICAg
ICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgcmVn
LCB2YWwpOworICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIHJlZywgdmFsKTsK
IH0KIAogc3RhdGljIHN0cnVjdCB2cGNpX21zaXggKm1zaXhfZmluZChjb25zdCBzdHJ1Y3QgZG9t
YWluICpkLCB1bnNpZ25lZCBsb25nIGFkZHIpCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92cGNp
L3ZwY2kuYyBiL3hlbi9kcml2ZXJzL3ZwY2kvdnBjaS5jCmluZGV4IGIxNDFlNTc4ODMuLjZjZWY1
ZTQyMGEgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvdnBjaS5jCisrKyBiL3hlbi9kcml2
ZXJzL3ZwY2kvdnBjaS5jCkBAIC0yNjQsMTkgKzI2NCwxNyBAQCBzdGF0aWMgdm9pZCB2cGNpX3dy
aXRlX2h3KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdW5zaWduZWQgaW50IHNp
emUsCiAgICAgICAgIGlmICggcmVnICYgMSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHBjaV9j
b25mX3dyaXRlOChzYmRmLCByZWcsIGRhdGEpOwotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUx
NihzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYuZGV2LCBzYmRmLmZuLCByZWcgKyAxLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBkYXRhID4+IDgpOworICAgICAgICAgICAgcGNpX2NvbmZf
d3JpdGUxNihzYmRmLCByZWcgKyAxLCBkYXRhID4+IDgpOwogICAgICAgICB9CiAgICAgICAgIGVs
c2UKICAgICAgICAgewotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzYmRmLnNlZywgc2Jk
Zi5idXMsIHNiZGYuZGV2LCBzYmRmLmZuLCByZWcsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGRhdGEpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzYmRmLCByZWcsIGRhdGEp
OwogICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGU4KHNiZGYsIHJlZyArIDIsIGRhdGEgPj4gMTYp
OwogICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogCiAgICAgY2FzZSAyOgotICAgICAgICBwY2lf
Y29uZl93cml0ZTE2KHNiZGYuc2VnLCBzYmRmLmJ1cywgc2JkZi5kZXYsIHNiZGYuZm4sIHJlZywg
ZGF0YSk7CisgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2JkZiwgcmVnLCBkYXRhKTsKICAgICAg
ICAgYnJlYWs7CiAKICAgICBjYXNlIDE6CmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vcGNp
LmggYi94ZW4vaW5jbHVkZS94ZW4vcGNpLmgKaW5kZXggMTQ0Y2ZiMmU2Mi4uYmZkZmNhMDU3YiAx
MDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3BjaS5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9w
Y2kuaApAQCAtMTc2LDkgKzE3Niw3IEBAIHVpbnQ4X3QgcGNpX2NvbmZfcmVhZDgocGNpX3NiZGZf
dCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnKTsKIHVpbnQxNl90IHBjaV9jb25mX3JlYWQxNihwY2lf
c2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcpOwogdWludDMyX3QgcGNpX2NvbmZfcmVhZDMy
KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZyk7CiB2b2lkIHBjaV9jb25mX3dyaXRl
OChwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVpbnQ4X3QgZGF0YSk7Ci12b2lk
IHBjaV9jb25mX3dyaXRlMTYoCi0gICAgdW5zaWduZWQgaW50IHNlZywgdW5zaWduZWQgaW50IGJ1
cywgdW5zaWduZWQgaW50IGRldiwgdW5zaWduZWQgaW50IGZ1bmMsCi0gICAgdW5zaWduZWQgaW50
IHJlZywgdWludDE2X3QgZGF0YSk7Cit2b2lkIHBjaV9jb25mX3dyaXRlMTYocGNpX3NiZGZfdCBz
YmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1aW50MTZfdCBkYXRhKTsKIHZvaWQgcGNpX2NvbmZfd3Jp
dGUzMigKICAgICB1bnNpZ25lZCBpbnQgc2VnLCB1bnNpZ25lZCBpbnQgYnVzLCB1bnNpZ25lZCBp
bnQgZGV2LCB1bnNpZ25lZCBpbnQgZnVuYywKICAgICB1bnNpZ25lZCBpbnQgcmVnLCB1aW50MzJf
dCBkYXRhKTsKLS0gCjIuMjAuMSAoQXBwbGUgR2l0LTExNykKCgpfX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1k
ZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21h
aWxtYW4vbGlzdGluZm8veGVuLWRldmVs

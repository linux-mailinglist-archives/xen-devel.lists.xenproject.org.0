Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 2CF1C6E727
	for <lists+xen-devel@lfdr.de>; Fri, 19 Jul 2019 16:10:12 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hoTYB-00075l-4e; Fri, 19 Jul 2019 14:07:55 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=RcFV=VQ=citrix.com=roger.pau@srs-us1.protection.inumbo.net>)
 id 1hoTYA-00075T-Es
 for xen-devel@lists.xenproject.org; Fri, 19 Jul 2019 14:07:54 +0000
X-Inumbo-ID: 98defab5-aa2e-11e9-8980-bc764e045a96
Received: from esa2.hc3370-68.iphmx.com (unknown [216.71.145.153])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 98defab5-aa2e-11e9-8980-bc764e045a96;
 Fri, 19 Jul 2019 14:07:52 +0000 (UTC)
Authentication-Results: esa2.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=roger.pau@citrix.com;
 spf=Pass smtp.mailfrom=roger.pau@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa2.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 roger.pau@citrix.com) identity=pra; client-ip=162.221.158.21;
 receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com"; x-conformance=sidf_compatible
Received-SPF: Pass (esa2.hc3370-68.iphmx.com: domain of
 roger.pau@citrix.com designates 162.221.158.21 as permitted
 sender) identity=mailfrom; client-ip=162.221.158.21;
 receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa2.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa2.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: pbqpk4+WgkE5gGUYgGxTCSxstDTW7qm+YiDIdeqJAWBjojVWqhNVZKC0eEPP1M9d+XfNkcX65k
 n44StY0eHVgV3iNv7DGaf+wTsl4ScUsY6tH/zuD4ME6Eff2J0IOc/P/Ibw1n6L5jccsp8HasSP
 eQHFCTlgQGn3iCh2Czik2oIrlYYMcz5Dbkz6naS/rwPiP/mUBf6Xatpn4D3Sdx/hBJ1oIjdy25
 N/JIn/SET/ztl1OAntEqEW2/7XTnN0j0KxUuVub4o1/qXBUwqdUd3o4UxpBDGc6tYCRwb1j8XD
 Vio=
X-SBRS: 2.7
X-MesageID: 3182352
X-Ironport-Server: esa2.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.64,282,1559534400"; 
   d="scan'208";a="3182352"
From: Roger Pau Monne <roger.pau@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Fri, 19 Jul 2019 16:07:24 +0200
Message-ID: <20190719140724.69596-7-roger.pau@citrix.com>
X-Mailer: git-send-email 2.20.1 (Apple Git-117)
In-Reply-To: <20190719140724.69596-1-roger.pau@citrix.com>
References: <20190719140724.69596-1-roger.pau@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v4 6/6] pci: switch pci_conf_write32 to use
 pci_sbdf_t
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Tian <kevin.tian@intel.com>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Ian
 Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Brian Woods <brian.woods@amd.com>, Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyByZWR1Y2VzIHRoZSBudW1iZXIgb2YgcGFyYW1ldGVycyBvZiB0aGUgZnVuY3Rpb24gdG8g
dHdvLCBhbmQKc2ltcGxpZmllcyBzb21lIG9mIHRoZSBjYWxsaW5nIHNpdGVzLgoKU2lnbmVkLW9m
Zi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+ClJldmlld2VkLWJ5
OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkFja2VkLWJ5OiBCcmlhbiBXb29kcyA8
YnJpYW4ud29vZHNAYW1kLmNvbT4KLS0tCkNjOiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5j
b20+CkNjOiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgpDYzogV2Vp
IExpdSA8d2xAeGVuLm9yZz4KQ2M6IEdlb3JnZSBEdW5sYXAgPEdlb3JnZS5EdW5sYXBAZXUuY2l0
cml4LmNvbT4KQ2M6IElhbiBKYWNrc29uIDxpYW4uamFja3NvbkBldS5jaXRyaXguY29tPgpDYzog
SnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KQ2M6IEtvbnJhZCBSemVzenV0ZWsg
V2lsayA8a29ucmFkLndpbGtAb3JhY2xlLmNvbT4KQ2M6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3N0
YWJlbGxpbmlAa2VybmVsLm9yZz4KQ2M6IFRpbSBEZWVnYW4gPHRpbUB4ZW4ub3JnPgpDYzogU3Vy
YXZlZSBTdXRoaWt1bHBhbml0IDxzdXJhdmVlLnN1dGhpa3VscGFuaXRAYW1kLmNvbT4KQ2M6IEJy
aWFuIFdvb2RzIDxicmlhbi53b29kc0BhbWQuY29tPgpDYzogS2V2aW4gVGlhbiA8a2V2aW4udGlh
bkBpbnRlbC5jb20+Ci0tLQogeGVuL2FyY2gveDg2L2NwdS9hbWQuYyAgICAgICAgICAgICAgICAg
ICB8ICA0ICsrLS0KIHhlbi9hcmNoL3g4Ni9tc2kuYyAgICAgICAgICAgICAgICAgICAgICAgfCAx
MiArKysrLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9vcHJvZmlsZS9vcF9tb2RlbF9hdGhsb24uYyAg
fCAgNCArKystCiB4ZW4vYXJjaC94ODYveDg2XzY0L3BjaS5jICAgICAgICAgICAgICAgIHwgMTcg
KysrKy0tLS0tLS0tLS0tLS0KIHhlbi9kcml2ZXJzL2NoYXIvZWhjaS1kYmdwLmMgICAgICAgICAg
ICAgfCAgNSArKystLQogeGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMgICAgICAgICAgICAgICB8
IDIyICsrKysrKysrKysrKy0tLS0tLS0tLS0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9pbml0LmMgfCAgOCArKysrLS0tLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMg
ICAgICAgICAgICB8ICA4ICsrKystLS0tCiB4ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVp
cmtzLmMgICAgIHwgIDggKysrKy0tLS0KIHhlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMgICAgICAg
ICAgICAgICAgfCAgNyArKystLS0tCiB4ZW4vZHJpdmVycy92cGNpL3ZwY2kuYyAgICAgICAgICAg
ICAgICAgIHwgIDIgKy0KIHhlbi9pbmNsdWRlL3hlbi9wY2kuaCAgICAgICAgICAgICAgICAgICAg
fCAgNCArLS0tCiAxMiBmaWxlcyBjaGFuZ2VkLCA0NSBpbnNlcnRpb25zKCspLCA1NiBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvY3B1L2FtZC5jIGIveGVuL2FyY2gveDg2
L2NwdS9hbWQuYwppbmRleCBmNjZkZTM2MmNiLi5hMmY4M2M3OWE1IDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvY3B1L2FtZC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9jcHUvYW1kLmMKQEAgLTcxNCwx
MSArNzE0LDExIEBAIHN0YXRpYyB2b2lkIGluaXRfYW1kKHN0cnVjdCBjcHVpbmZvX3g4NiAqYykK
IAkJCQkgICAgICAgKGggJiAweDEpID8gImNsZWFyaW5nIEQxOEYzeDVDWzBdIiA6ICIiKTsKIAog
CQkJaWYgKGwgJiAweDFmKQotCQkJCXBjaV9jb25mX3dyaXRlMzIoMCwgMCwgMHgxOCwgMHgzLCAw
eDU4LAorCQkJCXBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwgMCwgMHgxOCwgMyksIDB4NTgs
CiAJCQkJCQkgbCAmIH4weDFmKTsKIAogCQkJaWYgKGggJiAweDEpCi0JCQkJcGNpX2NvbmZfd3Jp
dGUzMigwLCAwLCAweDE4LCAweDMsIDB4NWMsCisJCQkJcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JE
RigwLCAwLCAweDE4LCAzKSwgMHg1YywKIAkJCQkJCSBoICYgfjB4MSk7CiAJCX0KIApkaWZmIC0t
Z2l0IGEveGVuL2FyY2gveDg2L21zaS5jIGIveGVuL2FyY2gveDg2L21zaS5jCmluZGV4IGYzZTVj
NWNiMDMuLmQ2MzA2MDA1YTkgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tc2kuYworKysgYi94
ZW4vYXJjaC94ODYvbXNpLmMKQEAgLTI1MSwyMSArMjUxLDE3IEBAIHN0YXRpYyBpbnQgd3JpdGVf
bXNpX21zZyhzdHJ1Y3QgbXNpX2Rlc2MgKmVudHJ5LCBzdHJ1Y3QgbXNpX21zZyAqbXNnKQogICAg
IHsKICAgICAgICAgc3RydWN0IHBjaV9kZXYgKmRldiA9IGVudHJ5LT5kZXY7CiAgICAgICAgIGlu
dCBwb3MgPSBlbnRyeS0+bXNpX2F0dHJpYi5wb3M7Ci0gICAgICAgIHUxNiBzZWcgPSBkZXYtPnNl
ZzsKLSAgICAgICAgdTggYnVzID0gZGV2LT5idXM7Ci0gICAgICAgIHU4IHNsb3QgPSBQQ0lfU0xP
VChkZXYtPmRldmZuKTsKLSAgICAgICAgdTggZnVuYyA9IFBDSV9GVU5DKGRldi0+ZGV2Zm4pOwog
ICAgICAgICBpbnQgbnIgPSBlbnRyeS0+bXNpX2F0dHJpYi5lbnRyeV9ucjsKIAogICAgICAgICBB
U1NFUlQoKG1zZy0+ZGF0YSAmIChlbnRyeVstbnJdLm1zaS5udmVjIC0gMSkpID09IG5yKTsKICAg
ICAgICAgaWYgKCBuciApCiAgICAgICAgICAgICByZXR1cm4gMDsKIAotICAgICAgICBwY2lfY29u
Zl93cml0ZTMyKHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2lfbG93ZXJfYWRkcmVzc19yZWcocG9z
KSwKKyAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihkZXYtPnNiZGYsIG1zaV9sb3dlcl9hZGRyZXNz
X3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy0+YWRkcmVzc19sbyk7CiAg
ICAgICAgIGlmICggZW50cnktPm1zaV9hdHRyaWIuaXNfNjQgKQogICAgICAgICB7Ci0gICAgICAg
ICAgICBwY2lfY29uZl93cml0ZTMyKHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2lfdXBwZXJfYWRk
cmVzc19yZWcocG9zKSwKKyAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoZGV2LT5zYmRmLCBt
c2lfdXBwZXJfYWRkcmVzc19yZWcocG9zKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bXNnLT5hZGRyZXNzX2hpKTsKICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoZGV2LT5zYmRm
LCBtc2lfZGF0YV9yZWcocG9zLCAxKSwgbXNnLT5kYXRhKTsKICAgICAgICAgfQpAQCAtMzk1LDcg
KzM5MSw3IEBAIHN0YXRpYyBib29sIG1zaV9zZXRfbWFza19iaXQoc3RydWN0IGlycV9kZXNjICpk
ZXNjLCBib29sIGhvc3QsIGJvb2wgZ3Vlc3QpCiAgICAgICAgICAgICBtYXNrX2JpdHMgPSBwY2lf
Y29uZl9yZWFkMzIocGRldi0+c2JkZiwgZW50cnktPm1zaS5tcG9zKTsKICAgICAgICAgICAgIG1h
c2tfYml0cyAmPSB+KCh1MzIpMSA8PCBlbnRyeS0+bXNpX2F0dHJpYi5lbnRyeV9ucik7CiAgICAg
ICAgICAgICBtYXNrX2JpdHMgfD0gKHUzMilmbGFnIDw8IGVudHJ5LT5tc2lfYXR0cmliLmVudHJ5
X25yOwotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihzZWcsIGJ1cywgc2xvdCwgZnVuYywg
ZW50cnktPm1zaS5tcG9zLCBtYXNrX2JpdHMpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUz
MihwZGV2LT5zYmRmLCBlbnRyeS0+bXNpLm1wb3MsIG1hc2tfYml0cyk7CiAgICAgICAgIH0KICAg
ICAgICAgYnJlYWs7CiAgICAgY2FzZSBQQ0lfQ0FQX0lEX01TSVg6CkBAIC03MTYsNyArNzEyLDcg
QEAgc3RhdGljIGludCBtc2lfY2FwYWJpbGl0eV9pbml0KHN0cnVjdCBwY2lfZGV2ICpkZXYsCiAg
ICAgICAgIC8qIEFsbCBNU0lzIGFyZSB1bm1hc2tlZCBieSBkZWZhdWx0LCBNYXNrIHRoZW0gYWxs
ICovCiAgICAgICAgIG1hc2tiaXRzID0gcGNpX2NvbmZfcmVhZDMyKGRldi0+c2JkZiwgbXBvcyk7
CiAgICAgICAgIG1hc2tiaXRzIHw9IH4odTMyKTAgPj4gKDMyIC0gbWF4dmVjKTsKLSAgICAgICAg
cGNpX2NvbmZfd3JpdGUzMihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXBvcywgbWFza2JpdHMpOwor
ICAgICAgICBwY2lfY29uZl93cml0ZTMyKGRldi0+c2JkZiwgbXBvcywgbWFza2JpdHMpOwogICAg
IH0KICAgICBsaXN0X2FkZF90YWlsKCZlbnRyeS0+bGlzdCwgJmRldi0+bXNpX2xpc3QpOwogCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvb3Byb2ZpbGUvb3BfbW9kZWxfYXRobG9uLmMgYi94ZW4v
YXJjaC94ODYvb3Byb2ZpbGUvb3BfbW9kZWxfYXRobG9uLmMKaW5kZXggM2JmMGIwMjE0ZC4uNWM0
OGY4NjhhZSAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L29wcm9maWxlL29wX21vZGVsX2F0aGxv
bi5jCisrKyBiL3hlbi9hcmNoL3g4Ni9vcHJvZmlsZS9vcF9tb2RlbF9hdGhsb24uYwpAQCAtNDcy
LDcgKzQ3Miw5IEBAIHN0YXRpYyBpbnQgX19pbml0IGluaXRfaWJzX25taSh2b2lkKQogCQkJCWlm
ICgodmVuZG9yX2lkID09IFBDSV9WRU5ET1JfSURfQU1EKSAmJgogCQkJCQkoZGV2X2lkID09IFBD
SV9ERVZJQ0VfSURfQU1EXzEwSF9OQl9NSVNDKSkgewogCi0JCQkJCXBjaV9jb25mX3dyaXRlMzIo
MCwgYnVzLCBkZXYsIGZ1bmMsIElCU0NUTCwKKwkJCQkJcGNpX2NvbmZfd3JpdGUzMigKKwkJCQkJ
CVBDSV9TQkRGKDAsIGJ1cywgZGV2LCBmdW5jKSwKKwkJCQkJCUlCU0NUTCwKIAkJCQkJCUlCU0NU
TF9MVlRPRkZTRVRWQUwgfCBBUElDX0VJTFZUX0xWVE9GRl9JQlMpOwogCiAJCQkJCXZhbHVlID0g
cGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRGKDAsIGJ1cywgZGV2LCBmdW5jKSwKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL3g4Ni94ODZfNjQvcGNpLmMgYi94ZW4vYXJjaC94ODYveDg2XzY0L3BjaS5jCmlu
ZGV4IGYwMTRmZTBmYzUuLmFhZDFjM2Y3Y2YgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni94ODZf
NjQvcGNpLmMKKysrIGIveGVuL2FyY2gveDg2L3g4Nl82NC9wY2kuYwpAQCAtNjYsMTkgKzY2LDEw
IEBAIHZvaWQgcGNpX2NvbmZfd3JpdGUxNihwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCBy
ZWcsIHVpbnQxNl90IGRhdGEpCiAgICAgICAgIHBjaV9jb25mX3dyaXRlKFBDSV9DT05GX0FERFJF
U1Moc2JkZiwgcmVnKSwgcmVnICYgMiwgMiwgZGF0YSk7CiB9CiAKLSN1bmRlZiBQQ0lfQ09ORl9B
RERSRVNTCi0jZGVmaW5lIFBDSV9DT05GX0FERFJFU1MoYnVzLCBkZXYsIGZ1bmMsIHJlZykgXAot
ICAgICgweDgwMDAwMDAwIHwgKGJ1cyA8PCAxNikgfCAoZGV2IDw8IDExKSB8IChmdW5jIDw8IDgp
IHwgKHJlZyAmIH4zKSkKLQotdm9pZCBwY2lfY29uZl93cml0ZTMyKAotICAgIHVuc2lnbmVkIGlu
dCBzZWcsIHVuc2lnbmVkIGludCBidXMsIHVuc2lnbmVkIGludCBkZXYsIHVuc2lnbmVkIGludCBm
dW5jLAotICAgIHVuc2lnbmVkIGludCByZWcsIHVpbnQzMl90IGRhdGEpCit2b2lkIHBjaV9jb25m
X3dyaXRlMzIocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1aW50MzJfdCBkYXRh
KQogewotICAgIGlmICggc2VnIHx8IHJlZyA+IDI1NSApCi0gICAgICAgIHBjaV9tbWNmZ193cml0
ZShzZWcsIGJ1cywgUENJX0RFVkZOKGRldiwgZnVuYyksIHJlZywgNCwgZGF0YSk7CisgICAgaWYg
KCBzYmRmLnNlZyB8fCByZWcgPiAyNTUgKQorICAgICAgICBwY2lfbW1jZmdfd3JpdGUoc2JkZi5z
ZWcsIHNiZGYuYnVzLCBzYmRmLmRldmZuLCByZWcsIDQsIGRhdGEpOwogICAgIGVsc2UKLSAgICB7
Ci0gICAgICAgIEJVR19PTigoYnVzID4gMjU1KSB8fCAoZGV2ID4gMzEpIHx8IChmdW5jID4gNykp
OwotICAgICAgICBwY2lfY29uZl93cml0ZShQQ0lfQ09ORl9BRERSRVNTKGJ1cywgZGV2LCBmdW5j
LCByZWcpLCAwLCA0LCBkYXRhKTsKLSAgICB9CisgICAgICAgIHBjaV9jb25mX3dyaXRlKFBDSV9D
T05GX0FERFJFU1Moc2JkZiwgcmVnKSwgMCwgNCwgZGF0YSk7CiB9CmRpZmYgLS1naXQgYS94ZW4v
ZHJpdmVycy9jaGFyL2VoY2ktZGJncC5jIGIveGVuL2RyaXZlcnMvY2hhci9laGNpLWRiZ3AuYwpp
bmRleCBiNzgwMzM0OTUzLi5iNmUxNTVkMTdiIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9jaGFy
L2VoY2ktZGJncC5jCisrKyBiL3hlbi9kcml2ZXJzL2NoYXIvZWhjaS1kYmdwLmMKQEAgLTEwMTIs
NyArMTAxMiw4IEBAIHN0YXRpYyB2b2lkIG52aWRpYV9zZXRfZGVidWdfcG9ydChzdHJ1Y3QgZWhj
aV9kYmdwICpkYmdwLCB1bnNpZ25lZCBpbnQgcG9ydCkKIAogICAgIGR3b3JkICY9IH4oMHgwZiA8
PCAxMik7CiAgICAgZHdvcmQgfD0gKHBvcnQgJiAweDBmKSA8PCAxMjsKLSAgICBwY2lfY29uZl93
cml0ZTMyKDAsIGRiZ3AtPmJ1cywgZGJncC0+c2xvdCwgZGJncC0+ZnVuYywgMHg3NCwgZHdvcmQp
OworICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwgZGJncC0+YnVzLCBkYmdwLT5zbG90
LCBkYmdwLT5mdW5jKSwgMHg3NCwKKyAgICAgICAgICAgICAgICAgICAgIGR3b3JkKTsKICAgICBk
YmdwX3ByaW50aygic2V0IGRlYnVnIHBvcnQgdG8gJXVcbiIsIHBvcnQpOwogfQogCkBAIC0xNDM2
LDcgKzE0MzcsNyBAQCBzdGF0aWMgdm9pZCBlaGNpX2RiZ3BfcmVzdW1lKHN0cnVjdCBzZXJpYWxf
cG9ydCAqcG9ydCkKICAgICBpZiAoICFkYmdwLT5laGNpX2RlYnVnICkKICAgICAgICAgcmV0dXJu
OwogCi0gICAgcGNpX2NvbmZfd3JpdGUzMigwLCBkYmdwLT5idXMsIGRiZ3AtPnNsb3QsIGRiZ3At
PmZ1bmMsIGRiZ3AtPmJhciwKKyAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9TQkRGKDAsIGRiZ3At
PmJ1cywgZGJncC0+c2xvdCwgZGJncC0+ZnVuYyksIGRiZ3AtPmJhciwKICAgICAgICAgICAgICAg
ICAgICAgIGRiZ3AtPmJhcl92YWwpOwogICAgIHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwg
ZGJncC0+YnVzLCBkYmdwLT5zbG90LCBkYmdwLT5mdW5jKSwKICAgICAgICAgICAgICAgICAgICAg
IFBDSV9DT01NQU5ELCBkYmdwLT5wY2lfY3IpOwpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvY2hh
ci9uczE2NTUwLmMgYi94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYwppbmRleCAyMGVhZWNlZTU5
Li5lNTE4ZjJkNzkwIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYworKysg
Yi94ZW4vZHJpdmVycy9jaGFyL25zMTY1NTAuYwpAQCAtNjMwLDcgKzYzMCw4IEBAIHN0YXRpYyB2
b2lkIHBjaV9zZXJpYWxfZWFybHlfaW5pdChzdHJ1Y3QgbnMxNjU1MCAqdWFydCkKICAgICAgICAg
ICAgICAgICAgICAgICAgICAodWFydC0+aW9fYmFzZSAmIDB4RjAwMCkgfAogICAgICAgICAgICAg
ICAgICAgICAgICAgICgodWFydC0+aW9fYmFzZSAmIDB4RjAwMCkgPj4gOCkpOwogCi0gICAgcGNp
X2NvbmZfd3JpdGUzMigwLCB1YXJ0LT5wc19iZGZbMF0sIHVhcnQtPnBzX2JkZlsxXSwgdWFydC0+
cHNfYmRmWzJdLAorICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwgdWFydC0+cHNfYmRm
WzBdLCB1YXJ0LT5wc19iZGZbMV0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1YXJ0
LT5wc19iZGZbMl0pLAogICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wLAog
ICAgICAgICAgICAgICAgICAgICAgdWFydC0+aW9fYmFzZSB8IFBDSV9CQVNFX0FERFJFU1NfU1BB
Q0VfSU8pOwogICAgIHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwgdWFydC0+cHNfYmRmWzBd
LCB1YXJ0LT5wc19iZGZbMV0sCkBAIC04NjAsMTMgKzg2MSwxNCBAQCBzdGF0aWMgdm9pZCBfbnMx
NjU1MF9yZXN1bWUoc3RydWN0IHNlcmlhbF9wb3J0ICpwb3J0KQogCiAgICAgaWYgKCB1YXJ0LT5i
YXIgKQogICAgIHsKLSAgICAgICBwY2lfY29uZl93cml0ZTMyKDAsIHVhcnQtPnBzX2JkZlswXSwg
dWFydC0+cHNfYmRmWzFdLCB1YXJ0LT5wc19iZGZbMl0sCisgICAgICAgcGNpX2NvbmZfd3JpdGUz
MihQQ0lfU0JERigwLCB1YXJ0LT5wc19iZGZbMF0sIHVhcnQtPnBzX2JkZlsxXSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVhcnQtPnBzX2JkZlsyXSksCiAgICAgICAgICAgICAg
ICAgICAgICAgICBQQ0lfQkFTRV9BRERSRVNTXzAgKyB1YXJ0LT5iYXJfaWR4KjQsIHVhcnQtPmJh
cik7CiAKICAgICAgICAgLyogSWYgNjQgYml0IEJBUiwgd3JpdGUgaGlnaGVyIDMyIGJpdHMgdG8g
QkFSKzQgKi8KICAgICAgICAgaWYgKCB1YXJ0LT5iYXIgJiBQQ0lfQkFTRV9BRERSRVNTX01FTV9U
WVBFXzY0ICkKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoMCwgdWFydC0+cHNfYmRmWzBd
LAotICAgICAgICAgICAgICAgICAgICAgICAgdWFydC0+cHNfYmRmWzFdLCB1YXJ0LT5wc19iZGZb
Ml0sCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9TQkRGKDAsIHVhcnQtPnBzX2Jk
ZlswXSwgIHVhcnQtPnBzX2JkZlsxXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdWFydC0+cHNfYmRmWzJdKSwKICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNF
X0FERFJFU1NfMCArICh1YXJ0LT5iYXJfaWR4KzEpKjQsIHVhcnQtPmJhcjY0KTsKIAogICAgICAg
IHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwgdWFydC0+cHNfYmRmWzBdLCB1YXJ0LT5wc19i
ZGZbMV0sCkBAIC0xMTIxLDExICsxMTIzLDExIEBAIHBjaV91YXJ0X2NvbmZpZyhzdHJ1Y3QgbnMx
NjU1MCAqdWFydCwgYm9vbF90IHNraXBfYW10LCB1bnNpZ25lZCBpbnQgaWR4KQogICAgICAgICAg
ICAgICAgIC8qIE1NSU8gYmFzZWQgKi8KICAgICAgICAgICAgICAgICBpZiAoIHBhcmFtLT5tbWlv
ICYmICEoYmFyICYgUENJX0JBU0VfQUREUkVTU19TUEFDRV9JTykgKQogICAgICAgICAgICAgICAg
IHsKLSAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMigwLCBiLCBkLCBmLAorICAg
ICAgICAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCAr
IGJhcl9pZHgqNCwgfjB1KTsKICAgICAgICAgICAgICAgICAgICAgbGVuID0gcGNpX2NvbmZfcmVh
ZDMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wICsgYmFyX2lkeCAqIDQpOwotICAgICAgICAg
ICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKDAsIGIsIGQsIGYsCisgICAgICAgICAgICAgICAg
ICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwgYiwgZCwgZiksCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wICsgYmFyX2lkeCo0LCBi
YXIpOwogCiAgICAgICAgICAgICAgICAgICAgIC8qIEhhbmRsZSA2NCBiaXQgQkFSIGlmIGZvdW5k
ICovCkBAIC0xMTMzLDExICsxMTM1LDExIEBAIHBjaV91YXJ0X2NvbmZpZyhzdHJ1Y3QgbnMxNjU1
MCAqdWFydCwgYm9vbF90IHNraXBfYW10LCB1bnNpZ25lZCBpbnQgaWR4KQogICAgICAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICBiYXJfNjQgPSBwY2lfY29uZl9yZWFk
MzIoUENJX1NCREYoMCwgYiwgZCwgZiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCArIChiYXJfaWR4ICsgMSkgKiA0KTsKLSAgICAgICAg
ICAgICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoMCwgYiwgZCwgZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYoMCwgYiwgZCwgZiksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQQ0lfQkFTRV9BRERSRVNTXzAgKyAoYmFy
X2lkeCsxKSo0LCB+MHUpOwogICAgICAgICAgICAgICAgICAgICAgICAgbGVuXzY0ID0gcGNpX2Nv
bmZfcmVhZDMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18wICsgKGJhcl9pZHggKyAxKSAqIDQpOwotICAg
ICAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMigwLCBiLCBkLCBmLAorICAgICAg
ICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JERigwLCBiLCBkLCBmKSwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCAr
IChiYXJfaWR4KzEpKjQsIGJhcl82NCk7CiAgICAgICAgICAgICAgICAgICAgICAgICBzaXplICA9
ICgodTY0KX4wIDw8IDMyKSB8IFBDSV9CQVNFX0FERFJFU1NfTUVNX01BU0s7CiAgICAgICAgICAg
ICAgICAgICAgICAgICBzaXplICY9ICgodTY0KWxlbl82NCA8PCAzMikgfCBsZW47CkBAIC0xMTUx
LDExICsxMTUzLDExIEBAIHBjaV91YXJ0X2NvbmZpZyhzdHJ1Y3QgbnMxNjU1MCAqdWFydCwgYm9v
bF90IHNraXBfYW10LCB1bnNpZ25lZCBpbnQgaWR4KQogICAgICAgICAgICAgICAgIC8qIElPIGJh
c2VkICovCiAgICAgICAgICAgICAgICAgZWxzZSBpZiAoICFwYXJhbS0+bW1pbyAmJiAoYmFyICYg
UENJX0JBU0VfQUREUkVTU19TUEFDRV9JTykgKQogICAgICAgICAgICAgICAgIHsKLSAgICAgICAg
ICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUzMigwLCBiLCBkLCBmLAorICAgICAgICAgICAgICAg
ICAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9TQkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9CQVNFX0FERFJFU1NfMCArIGJhcl9pZHgqNCwg
fjB1KTsKICAgICAgICAgICAgICAgICAgICAgbGVuID0gcGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRG
KDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
UENJX0JBU0VfQUREUkVTU18wKTsKLSAgICAgICAgICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUz
MigwLCBiLCBkLCBmLAorICAgICAgICAgICAgICAgICAgICBwY2lfY29uZl93cml0ZTMyKFBDSV9T
QkRGKDAsIGIsIGQsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBD
SV9CQVNFX0FERFJFU1NfMCArIGJhcl9pZHgqNCwgYmFyKTsKICAgICAgICAgICAgICAgICAgICAg
c2l6ZSA9IGxlbiAmIFBDSV9CQVNFX0FERFJFU1NfSU9fTUFTSzsKIApkaWZmIC0tZ2l0IGEveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYyBiL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL2FtZC9pb21tdV9pbml0LmMKaW5kZXggZjYwMjM4YTViOC4uZDk3MGY4OGEyNyAxMDA2
NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYworKysgYi94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCkBAIC04NDQsMjIgKzg0NCwy
MiBAQCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfZXJyYXR1bV83NDZfd29ya2Fyb3VuZChzdHJ1Y3Qg
YW1kX2lvbW11ICppb21tdSkKICAgICAgICAgIChib290X2NwdV9kYXRhLng4Nl9tb2RlbCA+IDB4
MWYpICkKICAgICAgICAgcmV0dXJuOwogCi0gICAgcGNpX2NvbmZfd3JpdGUzMihpb21tdS0+c2Vn
LCBidXMsIGRldiwgZnVuYywgMHhmMCwgMHg5MCk7CisgICAgcGNpX2NvbmZfd3JpdGUzMihQQ0lf
U0JERjIoaW9tbXUtPnNlZywgaW9tbXUtPmJkZiksIDB4ZjAsIDB4OTApOwogICAgIHZhbHVlID0g
cGNpX2NvbmZfcmVhZDMyKFBDSV9TQkRGMihpb21tdS0+c2VnLCBpb21tdS0+YmRmKSwgMHhmNCk7
CiAKICAgICBpZiAoIHZhbHVlICYgKDEgPDwgMikgKQogICAgICAgICByZXR1cm47CiAKICAgICAv
KiBTZWxlY3QgTkIgaW5kaXJlY3QgcmVnaXN0ZXIgMHg5MCBhbmQgZW5hYmxlIHdyaXRpbmcgKi8K
LSAgICBwY2lfY29uZl93cml0ZTMyKGlvbW11LT5zZWcsIGJ1cywgZGV2LCBmdW5jLCAweGYwLCAw
eDkwIHwgKDEgPDwgOCkpOworICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYyKGlvbW11LT5z
ZWcsIGlvbW11LT5iZGYpLCAweGYwLCAweDkwIHwgKDEgPDwgOCkpOwogCi0gICAgcGNpX2NvbmZf
d3JpdGUzMihpb21tdS0+c2VnLCBidXMsIGRldiwgZnVuYywgMHhmNCwgdmFsdWUgfCAoMSA8PCAy
KSk7CisgICAgcGNpX2NvbmZfd3JpdGUzMihQQ0lfU0JERjIoaW9tbXUtPnNlZywgaW9tbXUtPmJk
ZiksIDB4ZjQsIHZhbHVlIHwgKDEgPDwgMikpOwogICAgIHByaW50ayhYRU5MT0dfSU5GTwogICAg
ICAgICAgICAiQU1ELVZpOiBBcHBseWluZyBlcnJhdHVtIDc0NiB3b3JrYXJvdW5kIGZvciBJT01N
VSBhdCAlMDR4OiUwMng6JTAyeC4ldVxuIiwKICAgICAgICAgICAgaW9tbXUtPnNlZywgYnVzLCBk
ZXYsIGZ1bmMpOwogCiAgICAgLyogQ2xlYXIgdGhlIGVuYWJsZSB3cml0aW5nIGJpdCAqLwotICAg
IHBjaV9jb25mX3dyaXRlMzIoaW9tbXUtPnNlZywgYnVzLCBkZXYsIGZ1bmMsIDB4ZjAsIDB4OTAp
OworICAgIHBjaV9jb25mX3dyaXRlMzIoUENJX1NCREYyKGlvbW11LT5zZWcsIGlvbW11LT5iZGYp
LCAweGYwLCAweDkwKTsKIH0KIAogc3RhdGljIHZvaWQgZW5hYmxlX2lvbW11KHN0cnVjdCBhbWRf
aW9tbXUgKmlvbW11KQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwppbmRleCBlZTJiOWNjMDFjLi43YzE5NmJh
NThiIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYworKysgYi94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYwpAQCAtNjM4LDcgKzYzOCw3IEBAIHVuc2lnbmVkIGlu
dCBwY2lfc2l6ZV9tZW1fYmFyKHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHBvcywKICAg
ICBBU1NFUlQoISgoZmxhZ3MgJiBQQ0lfQkFSX1ZGKSAmJiAoZmxhZ3MgJiBQQ0lfQkFSX1JPTSkp
KTsKICAgICBBU1NFUlQoKGZsYWdzICYgUENJX0JBUl9ST00pIHx8CiAgICAgICAgICAgIChiYXIg
JiBQQ0lfQkFTRV9BRERSRVNTX1NQQUNFKSA9PSBQQ0lfQkFTRV9BRERSRVNTX1NQQUNFX01FTU9S
WSk7Ci0gICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYuZGV2LCBz
YmRmLmZuLCBwb3MsIH4wKTsKKyAgICBwY2lfY29uZl93cml0ZTMyKHNiZGYsIHBvcywgfjApOwog
ICAgIGlmICggaXM2NGJpdHMgKQogICAgIHsKICAgICAgICAgaWYgKCBmbGFncyAmIFBDSV9CQVJf
TEFTVCApCkBAIC02NTEsMTcgKzY1MSwxNyBAQCB1bnNpZ25lZCBpbnQgcGNpX3NpemVfbWVtX2Jh
cihwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCBwb3MsCiAgICAgICAgICAgICByZXR1cm4g
MTsKICAgICAgICAgfQogICAgICAgICBoaSA9IHBjaV9jb25mX3JlYWQzMihzYmRmLCBwb3MgKyA0
KTsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYuZGV2
LCBzYmRmLmZuLCBwb3MgKyA0LCB+MCk7CisgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoc2JkZiwg
cG9zICsgNCwgfjApOwogICAgIH0KICAgICBzaXplID0gcGNpX2NvbmZfcmVhZDMyKHNiZGYsIHBv
cykgJiBtYXNrOwogICAgIGlmICggaXM2NGJpdHMgKQogICAgIHsKICAgICAgICAgc2l6ZSB8PSAo
dWludDY0X3QpcGNpX2NvbmZfcmVhZDMyKHNiZGYsIHBvcyArIDQpIDw8IDMyOwotICAgICAgICBw
Y2lfY29uZl93cml0ZTMyKHNiZGYuc2VnLCBzYmRmLmJ1cywgc2JkZi5kZXYsIHNiZGYuZm4sIHBv
cyArIDQsIGhpKTsKKyAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLCBwb3MgKyA0LCBoaSk7
CiAgICAgfQogICAgIGVsc2UgaWYgKCBzaXplICkKICAgICAgICAgc2l6ZSB8PSAodWludDY0X3Qp
fjAgPDwgMzI7Ci0gICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYu
ZGV2LCBzYmRmLmZuLCBwb3MsIGJhcik7CisgICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLCBwb3Ms
IGJhcik7CiAgICAgc2l6ZSA9IC1zaXplOwogCiAgICAgaWYgKCBwYWRkciApCmRpZmYgLS1naXQg
YS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcXVpcmtzLmMgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC92dGQvcXVpcmtzLmMKaW5kZXggNDBiYzI1ZDU0NC4uZDE1MTJiOTM0NyAxMDA2NDQK
LS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3F1aXJrcy5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xdWlya3MuYwpAQCAtNDM5LDcgKzQzOSw3IEBAIHZvaWQgcGNp
X3Z0ZF9xdWlyayhjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICBjYXNlIDB4MzcyODog
LyogWGVvbiBDNTUwMC9DMzUwMCAoSmFzcGVyRm9yZXN0KSAqLwogICAgIGNhc2UgMHgzYzI4OiAv
KiBTYW5keWJyaWRnZSAqLwogICAgICAgICB2YWwgPSBwY2lfY29uZl9yZWFkMzIocGRldi0+c2Jk
ZiwgMHgxQUMpOwotICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNlZywgYnVzLCBkZXYsIGZ1bmMs
IDB4MUFDLCB2YWwgfCAoMSA8PCAzMSkpOworICAgICAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYt
PnNiZGYsIDB4MUFDLCB2YWwgfCAoMSA8PCAzMSkpOwogICAgICAgICBwcmludGsoWEVOTE9HX0lO
Rk8gIk1hc2tlZCBWVC1kIGVycm9yIHNpZ25hbGluZyBvbiAlMDR4OiUwMng6JTAyeC4ldVxuIiwK
ICAgICAgICAgICAgICAgIHNlZywgYnVzLCBkZXYsIGZ1bmMpOwogICAgICAgICBicmVhazsKQEAg
LTQ4Nyw5ICs0ODcsOSBAQCB2b2lkIHBjaV92dGRfcXVpcmsoY29uc3Qgc3RydWN0IHBjaV9kZXYg
KnBkZXYpCiAgICAgICAgICAgICBhY3Rpb24gPSAiRm91bmQgbWFza2VkIjsKICAgICAgICAgZWxz
ZSBpZiAoICFmZiApCiAgICAgICAgIHsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoc2Vn
LCBidXMsIGRldiwgZnVuYywgcG9zICsgUENJX0VSUl9VTkNPUl9NQVNLLAorICAgICAgICAgICAg
cGNpX2NvbmZfd3JpdGUzMihwZGV2LT5zYmRmLCBwb3MgKyBQQ0lfRVJSX1VOQ09SX01BU0ssCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbCB8IFBDSV9FUlJfVU5DX1VOU1VQKTsKLSAg
ICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoc2VnLCBidXMsIGRldiwgZnVuYywgcG9zICsgUENJ
X0VSUl9DT1JfTUFTSywKKyAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2JkZiwg
cG9zICsgUENJX0VSUl9DT1JfTUFTSywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFs
MiB8IFBDSV9FUlJfQ09SX0FEVl9ORkFUKTsKICAgICAgICAgICAgIGFjdGlvbiA9ICJNYXNrZWQi
OwogICAgICAgICB9CkBAIC00OTgsNyArNDk4LDcgQEAgdm9pZCBwY2lfdnRkX3F1aXJrKGNvbnN0
IHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogCiAgICAgICAgIC8qIFhQVU5DRVJSTVNLIFNlbmQgQ29t
cGxldGlvbiB3aXRoIFVuc3VwcG9ydGVkIFJlcXVlc3QgKi8KICAgICAgICAgdmFsID0gcGNpX2Nv
bmZfcmVhZDMyKHBkZXYtPnNiZGYsIDB4MjBjKTsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUzMihz
ZWcsIGJ1cywgZGV2LCBmdW5jLCAweDIwYywgdmFsIHwgKDEgPDwgNCkpOworICAgICAgICBwY2lf
Y29uZl93cml0ZTMyKHBkZXYtPnNiZGYsIDB4MjBjLCB2YWwgfCAoMSA8PCA0KSk7CiAKICAgICAg
ICAgcHJpbnRrKFhFTkxPR19JTkZPICIlcyBVUiBzaWduYWxpbmcgb24gJTA0eDolMDJ4OiUwMngu
JXVcbiIsCiAgICAgICAgICAgICAgICBhY3Rpb24sIHNlZywgYnVzLCBkZXYsIGZ1bmMpOwpkaWZm
IC0tZ2l0IGEveGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYyBiL3hlbi9kcml2ZXJzL3ZwY2kvaGVh
ZGVyLmMKaW5kZXggZjM3N2U2YWJkZi4uM2M3OTRmNDg2ZCAxMDA2NDQKLS0tIGEveGVuL2RyaXZl
cnMvdnBjaS9oZWFkZXIuYworKysgYi94ZW4vZHJpdmVycy92cGNpL2hlYWRlci5jCkBAIC04NSw3
ICs4NSw2IEBAIHN0YXRpYyB2b2lkIG1vZGlmeV9kZWNvZGluZyhjb25zdCBzdHJ1Y3QgcGNpX2Rl
diAqcGRldiwgdWludDE2X3QgY21kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wg
cm9tX29ubHkpCiB7CiAgICAgc3RydWN0IHZwY2lfaGVhZGVyICpoZWFkZXIgPSAmcGRldi0+dnBj
aS0+aGVhZGVyOwotICAgIHVpbnQ4X3Qgc2xvdCA9IFBDSV9TTE9UKHBkZXYtPmRldmZuKSwgZnVu
YyA9IFBDSV9GVU5DKHBkZXYtPmRldmZuKTsKICAgICBib29sIG1hcCA9IGNtZCAmIFBDSV9DT01N
QU5EX01FTU9SWTsKICAgICB1bnNpZ25lZCBpbnQgaTsKIApAQCAtMTEzLDcgKzExMiw3IEBAIHN0
YXRpYyB2b2lkIG1vZGlmeV9kZWNvZGluZyhjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdWlu
dDE2X3QgY21kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1hcCA/IFBDSV9ST01fQURE
UkVTU19FTkFCTEUgOiAwKTsKIAogICAgICAgICAgICAgaGVhZGVyLT5iYXJzW2ldLmVuYWJsZWQg
PSBoZWFkZXItPnJvbV9lbmFibGVkID0gbWFwOwotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUz
MihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgcm9tX3BvcywgdmFsKTsKKyAgICAg
ICAgICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2JkZiwgcm9tX3BvcywgdmFsKTsKICAgICAg
ICAgICAgIHJldHVybjsKICAgICAgICAgfQogCkBAIC0zOTUsNyArMzk0LDcgQEAgc3RhdGljIHZv
aWQgYmFyX3dyaXRlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1bnNpZ25lZCBpbnQgcmVn
LAogICAgICAgICB2YWwgfD0gYmFyLT5wcmVmZXRjaGFibGUgPyBQQ0lfQkFTRV9BRERSRVNTX01F
TV9QUkVGRVRDSCA6IDA7CiAgICAgfQogCi0gICAgcGNpX2NvbmZfd3JpdGUzMihwZGV2LT5zZWcs
IHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgcmVnLCB2YWwpOworICAgIHBjaV9jb25mX3dyaXRlMzIo
cGRldi0+c2JkZiwgcmVnLCB2YWwpOwogfQogCiBzdGF0aWMgdm9pZCByb21fd3JpdGUoY29uc3Qg
c3RydWN0IHBjaV9kZXYgKnBkZXYsIHVuc2lnbmVkIGludCByZWcsCkBAIC00MjYsNyArNDI1LDcg
QEAgc3RhdGljIHZvaWQgcm9tX3dyaXRlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1bnNp
Z25lZCBpbnQgcmVnLAogICAgIHsKICAgICAgICAgLyogSnVzdCB1cGRhdGUgdGhlIFJPTSBCQVIg
ZmllbGQuICovCiAgICAgICAgIGhlYWRlci0+cm9tX2VuYWJsZWQgPSBuZXdfZW5hYmxlZDsKLSAg
ICAgICAgcGNpX2NvbmZfd3JpdGUzMihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywg
cmVnLCB2YWwpOworICAgICAgICBwY2lfY29uZl93cml0ZTMyKHBkZXYtPnNiZGYsIHJlZywgdmFs
KTsKICAgICB9CiAgICAgLyoKICAgICAgKiBQYXNzIFBDSV9DT01NQU5EX01FTU9SWSBvciAwIHRv
IHNpZ25hbCBhIG1hcC91bm1hcCByZXF1ZXN0LCBub3RlIHRoYXQKZGlmZiAtLWdpdCBhL3hlbi9k
cml2ZXJzL3ZwY2kvdnBjaS5jIGIveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMKaW5kZXggNmNlZjVl
NDIwYS4uNzU4ZDk0MjBlNyAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMKKysr
IGIveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMKQEAgLTI1Myw3ICsyNTMsNyBAQCBzdGF0aWMgdm9p
ZCB2cGNpX3dyaXRlX2h3KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdW5zaWdu
ZWQgaW50IHNpemUsCiAgICAgc3dpdGNoICggc2l6ZSApCiAgICAgewogICAgIGNhc2UgNDoKLSAg
ICAgICAgcGNpX2NvbmZfd3JpdGUzMihzYmRmLnNlZywgc2JkZi5idXMsIHNiZGYuZGV2LCBzYmRm
LmZuLCByZWcsIGRhdGEpOworICAgICAgICBwY2lfY29uZl93cml0ZTMyKHNiZGYsIHJlZywgZGF0
YSk7CiAgICAgICAgIGJyZWFrOwogCiAgICAgY2FzZSAzOgpkaWZmIC0tZ2l0IGEveGVuL2luY2x1
ZGUveGVuL3BjaS5oIGIveGVuL2luY2x1ZGUveGVuL3BjaS5oCmluZGV4IGJmZGZjYTA1N2IuLjgx
NDhmNWIyZTcgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9wY2kuaAorKysgYi94ZW4vaW5j
bHVkZS94ZW4vcGNpLmgKQEAgLTE3Nyw5ICsxNzcsNyBAQCB1aW50MTZfdCBwY2lfY29uZl9yZWFk
MTYocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnKTsKIHVpbnQzMl90IHBjaV9jb25m
X3JlYWQzMihwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcpOwogdm9pZCBwY2lfY29u
Zl93cml0ZTgocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1aW50OF90IGRhdGEp
Owogdm9pZCBwY2lfY29uZl93cml0ZTE2KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJl
ZywgdWludDE2X3QgZGF0YSk7Ci12b2lkIHBjaV9jb25mX3dyaXRlMzIoCi0gICAgdW5zaWduZWQg
aW50IHNlZywgdW5zaWduZWQgaW50IGJ1cywgdW5zaWduZWQgaW50IGRldiwgdW5zaWduZWQgaW50
IGZ1bmMsCi0gICAgdW5zaWduZWQgaW50IHJlZywgdWludDMyX3QgZGF0YSk7Cit2b2lkIHBjaV9j
b25mX3dyaXRlMzIocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1aW50MzJfdCBk
YXRhKTsKIHVpbnQzMl90IHBjaV9jb25mX3JlYWQodWludDMyX3QgY2Y4LCB1aW50OF90IG9mZnNl
dCwgdWludDhfdCBieXRlcyk7CiB2b2lkIHBjaV9jb25mX3dyaXRlKHVpbnQzMl90IGNmOCwgdWlu
dDhfdCBvZmZzZXQsIHVpbnQ4X3QgYnl0ZXMsIHVpbnQzMl90IGRhdGEpOwogaW50IHBjaV9tbWNm
Z19yZWFkKHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVkIGludCBidXMsCi0tIAoyLjIwLjEgKEFw
cGxlIEdpdC0xMTcpCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5v
cmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZl
bA==

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 63580EB052
	for <lists+xen-devel@lfdr.de>; Thu, 31 Oct 2019 13:31:45 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iQ9a1-000799-7C; Thu, 31 Oct 2019 12:29:33 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=CAAN=YY=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1iQ9Zz-00078j-4G
 for xen-devel@lists.xen.org; Thu, 31 Oct 2019 12:29:31 +0000
X-Inumbo-ID: 108b52c8-fbda-11e9-bbab-bc764e2007e4
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 108b52c8-fbda-11e9-bbab-bc764e2007e4;
 Thu, 31 Oct 2019 12:29:21 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iQ9Zi-00078q-AR; Thu, 31 Oct 2019 12:29:14 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1iQ9Zi-0002qc-7S; Thu, 31 Oct 2019 12:29:14 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1iQ9Zi-0002qc-7S@xenbits.xenproject.org>
Date: Thu, 31 Oct 2019 12:29:14 +0000
Subject: [Xen-devel] Xen Security Advisory 298 v3 (CVE-2019-18425) - missing
 descriptor table limit checking in x86 PV emulation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2019-18425 / XSA-298
                               version 3

      missing descriptor table limit checking in x86 PV emulation

UPDATES IN VERSION 3
====================

Public release.

ISSUE DESCRIPTION
=================

When emulating certain PV guest operations, descriptor table accesses
are performed by the emulating code.  Such accesses should respect the
guest specified limits, unless otherwise guaranteed to fail in such a
case.  Without this, emulation of 32-bit guest user mode calls through
call gates would allow guest user mode to install and then use
descriptors of their choice, as long as the guest kernel did not
itself install an LDT.  (Most OSes don't install any LDT by default).

IMPACT
======

32-bit PV guest user mode can elevate its privileges to that of the
guest kernel.

VULNERABLE SYSTEMS
==================

Xen versions from at least 3.2 onwards are affected.

Only 32-bit PV guest user mode can leverage this vulnerability.

HVM, PVH, as well as 64-bit PV guests cannot leverage this
vulnerability.

Arm systems are unaffected.

MITIGATION
==========

Running only HVM, PVH, or 64-bit PV guests will avoid this
vulnerability.

CREDITS
=======

This issue was discovered by Andrew Cooper of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa298.patch           xen-unstable, Xen 4.12.x
xsa298-4.11.patch      Xen 4.11.x
xsa298-4.10.patch      Xen 4.10.x
xsa298-4.9.patch       Xen 4.9.x, Xen 4.8.x, Xen 4.7.x

$ sha256sum xsa298*
82c6f626732f99711212155b280270fe2f6683460299b1a6fc3f70b3932970ce  xsa298.meta
3f422ad83abb54fe6afed460a5982cf1faa1717e51ab19fbf2375be1b5f8f4a3  xsa298.patch
da8d5bad97a46c072dd1715c96401b145cecda14f0303043e6dca313e7ffff0c  xsa298-4.9.patch
92dba14b6a208379c2569b9c1c11438da384ec47db2508b4761af30d74a9403d  xsa298-4.10.patch
d2d8eb5de5601b88f2a6503ecf6bb83207e4b2f17833d61a74fcd185ac7f5a71  xsa298-4.11.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl2601AMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZk/AH/iLP9TpdOKNoW8fJDuOjlIQHsI0RPtU6KIdSc1a8
nzrcPfwpdP3/89GJQyEHwi5ZZdXAnNcXSK7BC+EEzqznV/VwHRDusCBH0enjUe0z
jDpOsxeI5RsuyJnSFojhI2E+y1khjKtVvnbNWbHzBfWMPD9Inc+nw9Q1KWfpSkk6
TTS8OwR9DwNiVXz9Na+BKuIBOVinFd1wA+HBNZKJl3JCz8N0Oa6RHDKFQQKJ4Uy2
KzBdzm5dWr0xP4stQmnYoU7JobGbcvKyMVMwwryS3cffLyhOLuzCWjDO+n7RkoRy
xWmGWVeQWAeIzqvvtb104NrHSVwVeFSOsen0cqFLvV82MRw=
=tmUK
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa298.meta"
Content-Disposition: attachment; filename="xsa298.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyOTgsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMiIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIs
CiAgICAiNC45IiwKICAgICI0LjgiCiAgXSwKICAiVHJlZXMiOiBbCiAgICAi
eGVuIgogIF0sCiAgIlJlY2lwZXMiOiB7CiAgICAiNC4xMCI6IHsKICAgICAg
IlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFi
bGVSZWYiOiAiMzEzMWJmOTU2YWIxNTkyOTVlY2RkZTBjNWFkMDAzZDBjNWFm
NDY5NSIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjk2
CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAg
ICAgICJ4c2EyOTgtNC4xMC5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9
CiAgICAgIH0KICAgIH0sCiAgICAiNC4xMSI6IHsKICAgICAgIlJlY2lwZXMi
OiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYiOiAi
MzM0MmVlOTMxOGNkMzhiYTAwNjI1NWI2ODdhYjdhMTQ1Mzk5ZWE5MiIsCiAg
ICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMjk2CiAgICAgICAg
ICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2Ey
OTgtNC4xMS5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0K
ICAgIH0sCiAgICAiNC4xMiI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAgICAg
ICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYiOiAiNTk5ZDZkMjNj
YmI3OTBhNzg4ZjdhNDlhYjRmMTFmMWEzYjViNDI5ZSIsCiAgICAgICAgICAi
UHJlcmVxcyI6IFsKICAgICAgICAgICAgMjk2CiAgICAgICAgICBdLAogICAg
ICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EyOTgucGF0Y2gi
CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQu
OCI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAg
ICAgICAgICJTdGFibGVSZWYiOiAiYzY3MjEwZjYwZGZhODM1NjVkMjZhZTcx
MGU0ZjVlNzI5YTk1ZGNlNSIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAg
ICAgICAgICAgMjk2CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMi
OiBbCiAgICAgICAgICAgICJ4c2EyOTgtNC45LnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjkiOiB7CiAgICAg
ICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAiU3Rh
YmxlUmVmIjogIjhkMmE2ODgwMTUxOTNlMjBhZTQ3ZmUzYzIwOGY5OTEyODI0
MGY4MjEiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAgIDI5
NgogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAg
ICAgICAieHNhMjk4LTQuOS5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9
CiAgICAgIH0KICAgIH0sCiAgICAibWFzdGVyIjogewogICAgICAiUmVjaXBl
cyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6
ICI1NWFiMjkyYzQyZGI0MWIwNWNmZGJhMDEyNjgwYmYxZTBlYTAyZjdhIiwK
ICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAyOTYKICAgICAg
ICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhz
YTI5OC5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAg
IH0KICB9Cn0=

--=separator
Content-Type: application/octet-stream; name="xsa298.patch"
Content-Disposition: attachment; filename="xsa298.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUFY6IGNoZWNrIEdEVC9MRFQgbGltaXRzIGR1cmluZyBlbXVsYXRp
b24KCkFjY2Vzc2VzIGJleW9uZCB0aGUgTERUIGxpbWl0IG9yaWdpbmF0aW5n
IGZyb20gZW11bGF0aW9uIHdvdWxkIHRyaWdnZXIKdGhlIEFTU0VSVCgpIGlu
IHB2X21hcF9sZHRfc2hhZG93X3BhZ2UoKS4gT24gcHJvZHVjdGlvbiBidWls
ZHMgc3VjaAphY2Nlc3NlcyB3b3VsZCBjYXVzZSBhbiBhdHRlbXB0IHRvIHBy
b21vdGUgdGhlIHRvdWNoZWQgcGFnZSAob2Zmc2V0IGZyb20KdGhlIHByZXNl
bnQgTERUIGJhc2UgYWRkcmVzcykgdG8gYSBzZWdtZW50IGRlc2NyaXB0b3Ig
b25lLiBJZiB0aGlzCmhhcHBlbnMgdG8gc3VjY2VlZCwgZ3Vlc3QgdXNlciBt
b2RlIHdvdWxkIGJlIGFibGUgdG8gZWxldmF0ZSBpdHMKcHJpdmlsZWdlcyB0
byB0aGF0IG9mIHRoZSBndWVzdCBrZXJuZWwuIFRoaXMgaXMgcGFydGljdWxh
cmx5IGVhc3kgd2hlbgp0aGVyZSdzIG5vIExEVCBhdCBhbGwsIGluIHdoaWNo
IGNhc2UgdGhlIExEVCBiYXNlIHN0b3JlZCBpbnRlcm5hbGx5IHRvClhlbiBp
cyBzaW1wbHkgemVyby4KCkFsc28gYWRqdXN0IHRoZSBBU1NFUlQoKSB0aGF0
IHdhcyB0cmlnZ2VyaW5nOiBJdCB3YXMgb2ZmIGJ5IG9uZSB0bwpiZWdpbiB3
aXRoLCBhbmQgZm9yIHByb2R1Y3Rpb24gYnVpbGRzIHdlIGFsc28gYmV0dGVy
IHVzZQpBU1NFUlRfVU5SRUFDSEFCTEUoKSBpbnN0ZWFkIHdpdGggc3VpdGFi
bGUgcmVjb3ZlcnkgY29kZSBhZnRlcndhcmRzLgoKVGhpcyBpcyBYU0EtMjk4
LgoKUmVwb3J0ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIz
QGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1
bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFu
ZHJldy5jb29wZXIzQGNpdHJpeC5jb20+Ci0tLQp2MjogQ29ycmVjdCA2NC1i
aXQtb25seSBsaW1pdCBjaGVjayAoYnkgZm9sZGluZyBpbnRvIHRoZSBjb21t
b24gb25lKS4KCi0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLWdhdGUtb3Au
YworKysgYi94ZW4vYXJjaC94ODYvcHYvZW11bC1nYXRlLW9wLmMKQEAgLTUx
LDcgKzUxLDEzIEBAIHN0YXRpYyBpbnQgcmVhZF9nYXRlX2Rlc2NyaXB0b3Io
dW5zaWduZWQKICAgICBjb25zdCBzZWdfZGVzY190ICpwZGVzYyA9IGdkdF9s
ZHRfZGVzY19wdHIoZ2F0ZV9zZWwpOwogCiAgICAgaWYgKCAoZ2F0ZV9zZWwg
PCA0KSB8fAotICAgICAgICAgKChnYXRlX3NlbCA+PSBGSVJTVF9SRVNFUlZF
RF9HRFRfQllURSkgJiYgIShnYXRlX3NlbCAmIDQpKSB8fAorICAgICAgICAg
LyoKKyAgICAgICAgICAqIFdlJ3JlIGludGVyZXN0ZWQgaW4gY2FsbCBnYXRl
cyBvbmx5LCB3aGljaCBvY2N1cHkgYSBzaW5nbGUKKyAgICAgICAgICAqIHNl
Z19kZXNjX3QgZm9yIDMyLWJpdCBhbmQgYSBjb25zZWN1dGl2ZSBwYWlyIG9m
IHRoZW0gZm9yIDY0LWJpdC4KKyAgICAgICAgICAqLworICAgICAgICAgKChn
YXRlX3NlbCA+PiAzKSArICFpc19wdl8zMmJpdF92Y3B1KHYpID49CisgICAg
ICAgICAgKGdhdGVfc2VsICYgNCA/IHYtPmFyY2gucHYubGR0X2VudHMKKyAg
ICAgICAgICAgICAgICAgICAgICAgIDogdi0+YXJjaC5wdi5nZHRfZW50cykp
IHx8CiAgICAgICAgICBfX2dldF91c2VyKGRlc2MsIHBkZXNjKSApCiAgICAg
ICAgIHJldHVybiAwOwogCkBAIC03MCw3ICs3Niw3IEBAIHN0YXRpYyBpbnQg
cmVhZF9nYXRlX2Rlc2NyaXB0b3IodW5zaWduZWQKICAgICBpZiAoICFpc19w
dl8zMmJpdF92Y3B1KHYpICkKICAgICB7CiAgICAgICAgIGlmICggKCphciAm
IDB4MWYwMCkgIT0gMHgwYzAwIHx8Ci0gICAgICAgICAgICAgKGdhdGVfc2Vs
ID49IEZJUlNUX1JFU0VSVkVEX0dEVF9CWVRFIC0gOCAmJiAhKGdhdGVfc2Vs
ICYgNCkpIHx8CisgICAgICAgICAgICAgLyogTGltaXQgY2hlY2sgZG9uZSBh
Ym92ZSBhbHJlYWR5LiAqLwogICAgICAgICAgICAgIF9fZ2V0X3VzZXIoZGVz
YywgcGRlc2MgKyAxKSB8fAogICAgICAgICAgICAgIChkZXNjLmIgJiAweDFm
MDApICkKICAgICAgICAgICAgIHJldHVybiAwOwotLS0gYS94ZW4vYXJjaC94
ODYvcHYvZW11bGF0ZS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9lbXVsYXRl
LmMKQEAgLTMxLDcgKzMxLDE0IEBAIGludCBwdl9lbXVsX3JlYWRfZGVzY3Jp
cHRvcih1bnNpZ25lZCBpbnQKIHsKICAgICBzZWdfZGVzY190IGRlc2M7CiAK
LSAgICBpZiAoIHNlbCA8IDQpCisgICAgaWYgKCBzZWwgPCA0IHx8CisgICAg
ICAgICAvKgorICAgICAgICAgICogRG9uJ3QgYXBwbHkgdGhlIEdEVCBsaW1p
dCBoZXJlLCBhcyB0aGUgc2VsZWN0b3IgbWF5IGJlIGEgWGVuCisgICAgICAg
ICAgKiBwcm92aWRlZCBvbmUuIF9fZ2V0X3VzZXIoKSB3aWxsIGZhaWwgKHdp
dGhvdXQgdGFraW5nIGZ1cnRoZXIKKyAgICAgICAgICAqIGFjdGlvbikgZm9y
IG9uZXMgZmFsbGluZyBpbiB0aGUgZ2FwIGJldHdlZW4gZ3Vlc3QgcG9wdWxh
dGVkCisgICAgICAgICAgKiBhbmQgWGVuIG9uZXMuCisgICAgICAgICAgKi8K
KyAgICAgICAgICgoc2VsICYgNCkgJiYgKHNlbCA+PiAzKSA+PSB2LT5hcmNo
LnB2LmxkdF9lbnRzKSApCiAgICAgICAgIGRlc2MuYiA9IGRlc2MuYSA9IDA7
CiAgICAgZWxzZSBpZiAoIF9fZ2V0X3VzZXIoZGVzYywgZ2R0X2xkdF9kZXNj
X3B0cihzZWwpKSApCiAgICAgICAgIHJldHVybiAwOwotLS0gYS94ZW4vYXJj
aC94ODYvcHYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvcHYvbW0uYwpAQCAt
OTIsMTIgKzkyLDE2IEBAIGJvb2wgcHZfbWFwX2xkdF9zaGFkb3dfcGFnZSh1
bnNpZ25lZCBpbnQKICAgICBCVUdfT04odW5saWtlbHkoaW5faXJxKCkpKTsK
IAogICAgIC8qCi0gICAgICogSGFyZHdhcmUgbGltaXQgY2hlY2tpbmcgc2hv
dWxkIGd1YXJhbnRlZSB0aGlzIHByb3BlcnR5LiAgTkIuIFRoaXMgaXMKKyAg
ICAgKiBQcmlvciBsaW1pdCBjaGVja2luZyBzaG91bGQgZ3VhcmFudGVlIHRo
aXMgcHJvcGVydHkuICBOQi4gVGhpcyBpcwogICAgICAqIHNhZmUgYXMgdXBk
YXRlcyB0byB0aGUgTERUIGNhbiBvbmx5IGJlIG1hZGUgYnkgTU1VRVhUX1NF
VF9MRFQgdG8gdGhlCiAgICAgICogY3VycmVudCB2Y3B1LCBhbmQgdmNwdV9y
ZXNldCgpIHdpbGwgYmxvY2sgdW50aWwgdGhpcyB2Y3B1IGhhcyBiZWVuCiAg
ICAgICogZGVzY2hlZHVsZWQgYmVmb3JlIGNvbnRpbnVpbmcuCiAgICAgICov
Ci0gICAgQVNTRVJUKChvZmZzZXQgPj4gMykgPD0gY3Vyci0+YXJjaC5wdi5s
ZHRfZW50cyk7CisgICAgaWYgKCB1bmxpa2VseSgob2Zmc2V0ID4+IDMpID49
IGN1cnItPmFyY2gucHYubGR0X2VudHMpICkKKyAgICB7CisgICAgICAgIEFT
U0VSVF9VTlJFQUNIQUJMRSgpOworICAgICAgICByZXR1cm4gZmFsc2U7Cisg
ICAgfQogCiAgICAgaWYgKCBpc19wdl8zMmJpdF9kb21haW4oY3VycmQpICkK
ICAgICAgICAgbGluZWFyID0gKHVpbnQzMl90KWxpbmVhcjsK

--=separator
Content-Type: application/octet-stream; name="xsa298-4.9.patch"
Content-Disposition: attachment; filename="xsa298-4.9.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUFY6IGNoZWNrIEdEVC9MRFQgbGltaXRzIGR1cmluZyBlbXVsYXRp
b24KCkFjY2Vzc2VzIGJleW9uZCB0aGUgTERUIGxpbWl0IG9yaWdpbmF0aW5n
IGZyb20gZW11bGF0aW9uIHdvdWxkIHRyaWdnZXIKdGhlIEFTU0VSVCgpIGlu
IHB2X21hcF9sZHRfc2hhZG93X3BhZ2UoKS4gT24gcHJvZHVjdGlvbiBidWls
ZHMgc3VjaAphY2Nlc3NlcyB3b3VsZCBjYXVzZSBhbiBhdHRlbXB0IHRvIHBy
b21vdGUgdGhlIHRvdWNoZWQgcGFnZSAob2Zmc2V0IGZyb20KdGhlIHByZXNl
bnQgTERUIGJhc2UgYWRkcmVzcykgdG8gYSBzZWdtZW50IGRlc2NyaXB0b3Ig
b25lLiBJZiB0aGlzCmhhcHBlbnMgdG8gc3VjY2VlZCwgZ3Vlc3QgdXNlciBt
b2RlIHdvdWxkIGJlIGFibGUgdG8gZWxldmF0ZSBpdHMKcHJpdmlsZWdlcyB0
byB0aGF0IG9mIHRoZSBndWVzdCBrZXJuZWwuIFRoaXMgaXMgcGFydGljdWxh
cmx5IGVhc3kgd2hlbgp0aGVyZSdzIG5vIExEVCBhdCBhbGwsIGluIHdoaWNo
IGNhc2UgdGhlIExEVCBiYXNlIHN0b3JlZCBpbnRlcm5hbGx5IHRvClhlbiBp
cyBzaW1wbHkgemVyby4KCkFsc28gYWRqdXN0IHRoZSBBU1NFUlQoKSB0aGF0
IHdhcyB0cmlnZ2VyaW5nOiBJdCB3YXMgb2ZmIGJ5IG9uZSB0bwpiZWdpbiB3
aXRoLCBhbmQgZm9yIHByb2R1Y3Rpb24gYnVpbGRzIHdlIGFsc28gYmV0dGVy
IHVzZQpBU1NFUlRfVU5SRUFDSEFCTEUoKSBpbnN0ZWFkIHdpdGggc3VpdGFi
bGUgcmVjb3ZlcnkgY29kZSBhZnRlcndhcmRzLgoKVGhpcyBpcyBYU0EtMjk4
LgoKUmVwb3J0ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIz
QGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1
bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFu
ZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYv
bW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0uYwpAQCAtNzEyLDYgKzcxMiwx
OCBAQCBpbnQgbWFwX2xkdF9zaGFkb3dfcGFnZSh1bnNpZ25lZCBpbnQgb2Zm
CiAKICAgICBCVUdfT04odW5saWtlbHkoaW5faXJxKCkpKTsKIAorICAgIC8q
CisgICAgICogUHJpb3IgbGltaXQgY2hlY2tpbmcgc2hvdWxkIGd1YXJhbnRl
ZSB0aGlzIHByb3BlcnR5LiAgTkIuIFRoaXMgaXMKKyAgICAgKiBzYWZlIGFz
IHVwZGF0ZXMgdG8gdGhlIExEVCBjYW4gb25seSBiZSBtYWRlIGJ5IE1NVUVY
VF9TRVRfTERUIHRvIHRoZQorICAgICAqIGN1cnJlbnQgdmNwdSwgYW5kIHZj
cHVfcmVzZXQoKSB3aWxsIGJsb2NrIHVudGlsIHRoaXMgdmNwdSBoYXMgYmVl
bgorICAgICAqIGRlc2NoZWR1bGVkIGJlZm9yZSBjb250aW51aW5nLgorICAg
ICAqLworICAgIGlmICggdW5saWtlbHkoKG9mZiA+PiAzKSA+PSB2LT5hcmNo
LnB2X3ZjcHUubGR0X2VudHMpICkKKyAgICB7CisgICAgICAgIEFTU0VSVF9V
TlJFQUNIQUJMRSgpOworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisKICAg
ICBpZiAoIGlzX3B2XzMyYml0X2RvbWFpbihkKSApCiAgICAgICAgIGd2YSA9
ICh1MzIpZ3ZhOwogICAgIGd1ZXN0X2dldF9lZmZfa2Vybl9sMWUodiwgZ3Zh
LCAmbDFlKTsKLS0tIGEveGVuL2FyY2gveDg2L3RyYXBzLmMKKysrIGIveGVu
L2FyY2gveDg2L3RyYXBzLmMKQEAgLTE2MzksNyArMTYzOSwxNCBAQCBzdGF0
aWMgaW50IHJlYWRfZGVzY3JpcHRvcih1bnNpZ25lZCBpbnQKIHsKICAgICBz
dHJ1Y3QgZGVzY19zdHJ1Y3QgZGVzYzsKIAotICAgIGlmICggc2VsIDwgNCkK
KyAgICBpZiAoIHNlbCA8IDQgfHwKKyAgICAgICAgIC8qCisgICAgICAgICAg
KiBEb24ndCBhcHBseSB0aGUgR0RUIGxpbWl0IGhlcmUsIGFzIHRoZSBzZWxl
Y3RvciBtYXkgYmUgYSBYZW4KKyAgICAgICAgICAqIHByb3ZpZGVkIG9uZS4g
X19nZXRfdXNlcigpIHdpbGwgZmFpbCAod2l0aG91dCB0YWtpbmcgZnVydGhl
cgorICAgICAgICAgICogYWN0aW9uKSBmb3Igb25lcyBmYWxsaW5nIGluIHRo
ZSBnYXAgYmV0d2VlbiBndWVzdCBwb3B1bGF0ZWQKKyAgICAgICAgICAqIGFu
ZCBYZW4gb25lcy4KKyAgICAgICAgICAqLworICAgICAgICAgKChzZWwgJiA0
KSAmJiAoc2VsID4+IDMpID49IHYtPmFyY2gucHZfdmNwdS5sZHRfZW50cykg
KQogICAgICAgICBkZXNjLmIgPSBkZXNjLmEgPSAwOwogICAgIGVsc2UgaWYg
KCBfX2dldF91c2VyKGRlc2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
KGNvbnN0IHN0cnVjdCBkZXNjX3N0cnVjdCAqKSghKHNlbCAmIDQpCkBAIC0x
Njk4LDcgKzE3MDUsMTMgQEAgc3RhdGljIGludCByZWFkX2dhdGVfZGVzY3Jp
cHRvcih1bnNpZ25lZAogICAgICAgICAoIShnYXRlX3NlbCAmIDQpID8gR0RU
X1ZJUlRfU1RBUlQodikgOiBMRFRfVklSVF9TVEFSVCh2KSkKICAgICAgICAg
KyAoZ2F0ZV9zZWwgPj4gMyk7CiAgICAgaWYgKCAoZ2F0ZV9zZWwgPCA0KSB8
fAotICAgICAgICAgKChnYXRlX3NlbCA+PSBGSVJTVF9SRVNFUlZFRF9HRFRf
QllURSkgJiYgIShnYXRlX3NlbCAmIDQpKSB8fAorICAgICAgICAgLyoKKyAg
ICAgICAgICAqIFdlJ3JlIGludGVyZXN0ZWQgaW4gY2FsbCBnYXRlcyBvbmx5
LCB3aGljaCBvY2N1cHkgYSBzaW5nbGUKKyAgICAgICAgICAqIHNlZ19kZXNj
X3QgZm9yIDMyLWJpdCBhbmQgYSBjb25zZWN1dGl2ZSBwYWlyIG9mIHRoZW0g
Zm9yIDY0LWJpdC4KKyAgICAgICAgICAqLworICAgICAgICAgKChnYXRlX3Nl
bCA+PiAzKSArICFpc19wdl8zMmJpdF92Y3B1KHYpID49CisgICAgICAgICAg
KGdhdGVfc2VsICYgNCA/IHYtPmFyY2gucHZfdmNwdS5sZHRfZW50cworICAg
ICAgICAgICAgICAgICAgICAgICAgOiB2LT5hcmNoLnB2X3ZjcHUuZ2R0X2Vu
dHMpKSB8fAogICAgICAgICAgX19nZXRfdXNlcihkZXNjLCBwZGVzYykgKQog
ICAgICAgICByZXR1cm4gMDsKIApAQCAtMTcxNyw3ICsxNzMwLDcgQEAgc3Rh
dGljIGludCByZWFkX2dhdGVfZGVzY3JpcHRvcih1bnNpZ25lZAogICAgIGlm
ICggIWlzX3B2XzMyYml0X3ZjcHUodikgKQogICAgIHsKICAgICAgICAgaWYg
KCAoKmFyICYgMHgxZjAwKSAhPSAweDBjMDAgfHwKLSAgICAgICAgICAgICAo
Z2F0ZV9zZWwgPj0gRklSU1RfUkVTRVJWRURfR0RUX0JZVEUgLSA4ICYmICEo
Z2F0ZV9zZWwgJiA0KSkgfHwKKyAgICAgICAgICAgICAvKiBMaW1pdCBjaGVj
ayBkb25lIGFib3ZlIGFscmVhZHkuICovCiAgICAgICAgICAgICAgX19nZXRf
dXNlcihkZXNjLCBwZGVzYyArIDEpIHx8CiAgICAgICAgICAgICAgKGRlc2Mu
YiAmIDB4MWYwMCkgKQogICAgICAgICAgICAgcmV0dXJuIDA7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa298-4.10.patch"
Content-Disposition: attachment; filename="xsa298-4.10.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUFY6IGNoZWNrIEdEVC9MRFQgbGltaXRzIGR1cmluZyBlbXVsYXRp
b24KCkFjY2Vzc2VzIGJleW9uZCB0aGUgTERUIGxpbWl0IG9yaWdpbmF0aW5n
IGZyb20gZW11bGF0aW9uIHdvdWxkIHRyaWdnZXIKdGhlIEFTU0VSVCgpIGlu
IHB2X21hcF9sZHRfc2hhZG93X3BhZ2UoKS4gT24gcHJvZHVjdGlvbiBidWls
ZHMgc3VjaAphY2Nlc3NlcyB3b3VsZCBjYXVzZSBhbiBhdHRlbXB0IHRvIHBy
b21vdGUgdGhlIHRvdWNoZWQgcGFnZSAob2Zmc2V0IGZyb20KdGhlIHByZXNl
bnQgTERUIGJhc2UgYWRkcmVzcykgdG8gYSBzZWdtZW50IGRlc2NyaXB0b3Ig
b25lLiBJZiB0aGlzCmhhcHBlbnMgdG8gc3VjY2VlZCwgZ3Vlc3QgdXNlciBt
b2RlIHdvdWxkIGJlIGFibGUgdG8gZWxldmF0ZSBpdHMKcHJpdmlsZWdlcyB0
byB0aGF0IG9mIHRoZSBndWVzdCBrZXJuZWwuIFRoaXMgaXMgcGFydGljdWxh
cmx5IGVhc3kgd2hlbgp0aGVyZSdzIG5vIExEVCBhdCBhbGwsIGluIHdoaWNo
IGNhc2UgdGhlIExEVCBiYXNlIHN0b3JlZCBpbnRlcm5hbGx5IHRvClhlbiBp
cyBzaW1wbHkgemVyby4KCkFsc28gYWRqdXN0IHRoZSBBU1NFUlQoKSB0aGF0
IHdhcyB0cmlnZ2VyaW5nOiBJdCB3YXMgb2ZmIGJ5IG9uZSB0bwpiZWdpbiB3
aXRoLCBhbmQgZm9yIHByb2R1Y3Rpb24gYnVpbGRzIHdlIGFsc28gYmV0dGVy
IHVzZQpBU1NFUlRfVU5SRUFDSEFCTEUoKSBpbnN0ZWFkIHdpdGggc3VpdGFi
bGUgcmVjb3ZlcnkgY29kZSBhZnRlcndhcmRzLgoKVGhpcyBpcyBYU0EtMjk4
LgoKUmVwb3J0ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIz
QGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1
bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFu
ZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYv
cHYvZW11bC1nYXRlLW9wLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2VtdWwt
Z2F0ZS1vcC5jCkBAIC02MCw3ICs2MCwxMyBAQCBzdGF0aWMgaW50IHJlYWRf
Z2F0ZV9kZXNjcmlwdG9yKHVuc2lnbmVkCiAgICAgICAgICghKGdhdGVfc2Vs
ICYgNCkgPyBHRFRfVklSVF9TVEFSVCh2KSA6IExEVF9WSVJUX1NUQVJUKHYp
KQogICAgICAgICArIChnYXRlX3NlbCA+PiAzKTsKICAgICBpZiAoIChnYXRl
X3NlbCA8IDQpIHx8Ci0gICAgICAgICAoKGdhdGVfc2VsID49IEZJUlNUX1JF
U0VSVkVEX0dEVF9CWVRFKSAmJiAhKGdhdGVfc2VsICYgNCkpIHx8CisgICAg
ICAgICAvKgorICAgICAgICAgICogV2UncmUgaW50ZXJlc3RlZCBpbiBjYWxs
IGdhdGVzIG9ubHksIHdoaWNoIG9jY3VweSBhIHNpbmdsZQorICAgICAgICAg
ICogc2VnX2Rlc2NfdCBmb3IgMzItYml0IGFuZCBhIGNvbnNlY3V0aXZlIHBh
aXIgb2YgdGhlbSBmb3IgNjQtYml0LgorICAgICAgICAgICovCisgICAgICAg
ICAoKGdhdGVfc2VsID4+IDMpICsgIWlzX3B2XzMyYml0X3ZjcHUodikgPj0K
KyAgICAgICAgICAoZ2F0ZV9zZWwgJiA0ID8gdi0+YXJjaC5wdl92Y3B1Lmxk
dF9lbnRzCisgICAgICAgICAgICAgICAgICAgICAgICA6IHYtPmFyY2gucHZf
dmNwdS5nZHRfZW50cykpIHx8CiAgICAgICAgICBfX2dldF91c2VyKGRlc2Ms
IHBkZXNjKSApCiAgICAgICAgIHJldHVybiAwOwogCkBAIC03OSw3ICs4NSw3
IEBAIHN0YXRpYyBpbnQgcmVhZF9nYXRlX2Rlc2NyaXB0b3IodW5zaWduZWQK
ICAgICBpZiAoICFpc19wdl8zMmJpdF92Y3B1KHYpICkKICAgICB7CiAgICAg
ICAgIGlmICggKCphciAmIDB4MWYwMCkgIT0gMHgwYzAwIHx8Ci0gICAgICAg
ICAgICAgKGdhdGVfc2VsID49IEZJUlNUX1JFU0VSVkVEX0dEVF9CWVRFIC0g
OCAmJiAhKGdhdGVfc2VsICYgNCkpIHx8CisgICAgICAgICAgICAgLyogTGlt
aXQgY2hlY2sgZG9uZSBhYm92ZSBhbHJlYWR5LiAqLwogICAgICAgICAgICAg
IF9fZ2V0X3VzZXIoZGVzYywgcGRlc2MgKyAxKSB8fAogICAgICAgICAgICAg
IChkZXNjLmIgJiAweDFmMDApICkKICAgICAgICAgICAgIHJldHVybiAwOwot
LS0gYS94ZW4vYXJjaC94ODYvcHYvZW11bGF0ZS5jCisrKyBiL3hlbi9hcmNo
L3g4Ni9wdi9lbXVsYXRlLmMKQEAgLTMxLDcgKzMxLDE0IEBAIGludCBwdl9l
bXVsX3JlYWRfZGVzY3JpcHRvcih1bnNpZ25lZCBpbnQKIHsKICAgICBzdHJ1
Y3QgZGVzY19zdHJ1Y3QgZGVzYzsKIAotICAgIGlmICggc2VsIDwgNCkKKyAg
ICBpZiAoIHNlbCA8IDQgfHwKKyAgICAgICAgIC8qCisgICAgICAgICAgKiBE
b24ndCBhcHBseSB0aGUgR0RUIGxpbWl0IGhlcmUsIGFzIHRoZSBzZWxlY3Rv
ciBtYXkgYmUgYSBYZW4KKyAgICAgICAgICAqIHByb3ZpZGVkIG9uZS4gX19n
ZXRfdXNlcigpIHdpbGwgZmFpbCAod2l0aG91dCB0YWtpbmcgZnVydGhlcgor
ICAgICAgICAgICogYWN0aW9uKSBmb3Igb25lcyBmYWxsaW5nIGluIHRoZSBn
YXAgYmV0d2VlbiBndWVzdCBwb3B1bGF0ZWQKKyAgICAgICAgICAqIGFuZCBY
ZW4gb25lcy4KKyAgICAgICAgICAqLworICAgICAgICAgKChzZWwgJiA0KSAm
JiAoc2VsID4+IDMpID49IHYtPmFyY2gucHZfdmNwdS5sZHRfZW50cykgKQog
ICAgICAgICBkZXNjLmIgPSBkZXNjLmEgPSAwOwogICAgIGVsc2UgaWYgKCBf
X2dldF91c2VyKGRlc2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGNv
bnN0IHN0cnVjdCBkZXNjX3N0cnVjdCAqKSghKHNlbCAmIDQpCi0tLSBhL3hl
bi9hcmNoL3g4Ni9wdi9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9tbS5j
CkBAIC05OCwxMiArOTgsMTYgQEAgYm9vbCBwdl9tYXBfbGR0X3NoYWRvd19w
YWdlKHVuc2lnbmVkIGludAogICAgIEJVR19PTih1bmxpa2VseShpbl9pcnEo
KSkpOwogCiAgICAgLyoKLSAgICAgKiBIYXJkd2FyZSBsaW1pdCBjaGVja2lu
ZyBzaG91bGQgZ3VhcmFudGVlIHRoaXMgcHJvcGVydHkuICBOQi4gVGhpcyBp
cworICAgICAqIFByaW9yIGxpbWl0IGNoZWNraW5nIHNob3VsZCBndWFyYW50
ZWUgdGhpcyBwcm9wZXJ0eS4gIE5CLiBUaGlzIGlzCiAgICAgICogc2FmZSBh
cyB1cGRhdGVzIHRvIHRoZSBMRFQgY2FuIG9ubHkgYmUgbWFkZSBieSBNTVVF
WFRfU0VUX0xEVCB0byB0aGUKICAgICAgKiBjdXJyZW50IHZjcHUsIGFuZCB2
Y3B1X3Jlc2V0KCkgd2lsbCBibG9jayB1bnRpbCB0aGlzIHZjcHUgaGFzIGJl
ZW4KICAgICAgKiBkZXNjaGVkdWxlZCBiZWZvcmUgY29udGludWluZy4KICAg
ICAgKi8KLSAgICBBU1NFUlQoKG9mZnNldCA+PiAzKSA8PSBjdXJyLT5hcmNo
LnB2X3ZjcHUubGR0X2VudHMpOworICAgIGlmICggdW5saWtlbHkoKG9mZnNl
dCA+PiAzKSA+PSBjdXJyLT5hcmNoLnB2X3ZjcHUubGR0X2VudHMpICkKKyAg
ICB7CisgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOworICAgICAgICBy
ZXR1cm4gZmFsc2U7CisgICAgfQogCiAgICAgaWYgKCBpc19wdl8zMmJpdF9k
b21haW4oY3VycmQpICkKICAgICAgICAgbGluZWFyID0gKHVpbnQzMl90KWxp
bmVhcjsK

--=separator
Content-Type: application/octet-stream; name="xsa298-4.11.patch"
Content-Disposition: attachment; filename="xsa298-4.11.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiB4ODYvUFY6IGNoZWNrIEdEVC9MRFQgbGltaXRzIGR1cmluZyBlbXVsYXRp
b24KCkFjY2Vzc2VzIGJleW9uZCB0aGUgTERUIGxpbWl0IG9yaWdpbmF0aW5n
IGZyb20gZW11bGF0aW9uIHdvdWxkIHRyaWdnZXIKdGhlIEFTU0VSVCgpIGlu
IHB2X21hcF9sZHRfc2hhZG93X3BhZ2UoKS4gT24gcHJvZHVjdGlvbiBidWls
ZHMgc3VjaAphY2Nlc3NlcyB3b3VsZCBjYXVzZSBhbiBhdHRlbXB0IHRvIHBy
b21vdGUgdGhlIHRvdWNoZWQgcGFnZSAob2Zmc2V0IGZyb20KdGhlIHByZXNl
bnQgTERUIGJhc2UgYWRkcmVzcykgdG8gYSBzZWdtZW50IGRlc2NyaXB0b3Ig
b25lLiBJZiB0aGlzCmhhcHBlbnMgdG8gc3VjY2VlZCwgZ3Vlc3QgdXNlciBt
b2RlIHdvdWxkIGJlIGFibGUgdG8gZWxldmF0ZSBpdHMKcHJpdmlsZWdlcyB0
byB0aGF0IG9mIHRoZSBndWVzdCBrZXJuZWwuIFRoaXMgaXMgcGFydGljdWxh
cmx5IGVhc3kgd2hlbgp0aGVyZSdzIG5vIExEVCBhdCBhbGwsIGluIHdoaWNo
IGNhc2UgdGhlIExEVCBiYXNlIHN0b3JlZCBpbnRlcm5hbGx5IHRvClhlbiBp
cyBzaW1wbHkgemVyby4KCkFsc28gYWRqdXN0IHRoZSBBU1NFUlQoKSB0aGF0
IHdhcyB0cmlnZ2VyaW5nOiBJdCB3YXMgb2ZmIGJ5IG9uZSB0bwpiZWdpbiB3
aXRoLCBhbmQgZm9yIHByb2R1Y3Rpb24gYnVpbGRzIHdlIGFsc28gYmV0dGVy
IHVzZQpBU1NFUlRfVU5SRUFDSEFCTEUoKSBpbnN0ZWFkIHdpdGggc3VpdGFi
bGUgcmVjb3ZlcnkgY29kZSBhZnRlcndhcmRzLgoKVGhpcyBpcyBYU0EtMjk4
LgoKUmVwb3J0ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIz
QGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1
bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFu
ZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CgotLS0gYS94ZW4vYXJjaC94ODYv
cHYvZW11bC1nYXRlLW9wLmMKKysrIGIveGVuL2FyY2gveDg2L3B2L2VtdWwt
Z2F0ZS1vcC5jCkBAIC01MSw3ICs1MSwxMyBAQCBzdGF0aWMgaW50IHJlYWRf
Z2F0ZV9kZXNjcmlwdG9yKHVuc2lnbmVkCiAgICAgY29uc3Qgc3RydWN0IGRl
c2Nfc3RydWN0ICpwZGVzYyA9IGdkdF9sZHRfZGVzY19wdHIoZ2F0ZV9zZWwp
OwogCiAgICAgaWYgKCAoZ2F0ZV9zZWwgPCA0KSB8fAotICAgICAgICAgKChn
YXRlX3NlbCA+PSBGSVJTVF9SRVNFUlZFRF9HRFRfQllURSkgJiYgIShnYXRl
X3NlbCAmIDQpKSB8fAorICAgICAgICAgLyoKKyAgICAgICAgICAqIFdlJ3Jl
IGludGVyZXN0ZWQgaW4gY2FsbCBnYXRlcyBvbmx5LCB3aGljaCBvY2N1cHkg
YSBzaW5nbGUKKyAgICAgICAgICAqIHNlZ19kZXNjX3QgZm9yIDMyLWJpdCBh
bmQgYSBjb25zZWN1dGl2ZSBwYWlyIG9mIHRoZW0gZm9yIDY0LWJpdC4KKyAg
ICAgICAgICAqLworICAgICAgICAgKChnYXRlX3NlbCA+PiAzKSArICFpc19w
dl8zMmJpdF92Y3B1KHYpID49CisgICAgICAgICAgKGdhdGVfc2VsICYgNCA/
IHYtPmFyY2gucHZfdmNwdS5sZHRfZW50cworICAgICAgICAgICAgICAgICAg
ICAgICAgOiB2LT5hcmNoLnB2X3ZjcHUuZ2R0X2VudHMpKSB8fAogICAgICAg
ICAgX19nZXRfdXNlcihkZXNjLCBwZGVzYykgKQogICAgICAgICByZXR1cm4g
MDsKIApAQCAtNzAsNyArNzYsNyBAQCBzdGF0aWMgaW50IHJlYWRfZ2F0ZV9k
ZXNjcmlwdG9yKHVuc2lnbmVkCiAgICAgaWYgKCAhaXNfcHZfMzJiaXRfdmNw
dSh2KSApCiAgICAgewogICAgICAgICBpZiAoICgqYXIgJiAweDFmMDApICE9
IDB4MGMwMCB8fAotICAgICAgICAgICAgIChnYXRlX3NlbCA+PSBGSVJTVF9S
RVNFUlZFRF9HRFRfQllURSAtIDggJiYgIShnYXRlX3NlbCAmIDQpKSB8fAor
ICAgICAgICAgICAgIC8qIExpbWl0IGNoZWNrIGRvbmUgYWJvdmUgYWxyZWFk
eS4gKi8KICAgICAgICAgICAgICBfX2dldF91c2VyKGRlc2MsIHBkZXNjICsg
MSkgfHwKICAgICAgICAgICAgICAoZGVzYy5iICYgMHgxZjAwKSApCiAgICAg
ICAgICAgICByZXR1cm4gMDsKLS0tIGEveGVuL2FyY2gveDg2L3B2L2VtdWxh
dGUuYworKysgYi94ZW4vYXJjaC94ODYvcHYvZW11bGF0ZS5jCkBAIC0zMSw3
ICszMSwxNCBAQCBpbnQgcHZfZW11bF9yZWFkX2Rlc2NyaXB0b3IodW5zaWdu
ZWQgaW50CiB7CiAgICAgc3RydWN0IGRlc2Nfc3RydWN0IGRlc2M7CiAKLSAg
ICBpZiAoIHNlbCA8IDQpCisgICAgaWYgKCBzZWwgPCA0IHx8CisgICAgICAg
ICAvKgorICAgICAgICAgICogRG9uJ3QgYXBwbHkgdGhlIEdEVCBsaW1pdCBo
ZXJlLCBhcyB0aGUgc2VsZWN0b3IgbWF5IGJlIGEgWGVuCisgICAgICAgICAg
KiBwcm92aWRlZCBvbmUuIF9fZ2V0X3VzZXIoKSB3aWxsIGZhaWwgKHdpdGhv
dXQgdGFraW5nIGZ1cnRoZXIKKyAgICAgICAgICAqIGFjdGlvbikgZm9yIG9u
ZXMgZmFsbGluZyBpbiB0aGUgZ2FwIGJldHdlZW4gZ3Vlc3QgcG9wdWxhdGVk
CisgICAgICAgICAgKiBhbmQgWGVuIG9uZXMuCisgICAgICAgICAgKi8KKyAg
ICAgICAgICgoc2VsICYgNCkgJiYgKHNlbCA+PiAzKSA+PSB2LT5hcmNoLnB2
X3ZjcHUubGR0X2VudHMpICkKICAgICAgICAgZGVzYy5iID0gZGVzYy5hID0g
MDsKICAgICBlbHNlIGlmICggX19nZXRfdXNlcihkZXNjLCBnZHRfbGR0X2Rl
c2NfcHRyKHNlbCkpICkKICAgICAgICAgcmV0dXJuIDA7Ci0tLSBhL3hlbi9h
cmNoL3g4Ni9wdi9tbS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9tbS5jCkBA
IC05MiwxMiArOTIsMTYgQEAgYm9vbCBwdl9tYXBfbGR0X3NoYWRvd19wYWdl
KHVuc2lnbmVkIGludAogICAgIEJVR19PTih1bmxpa2VseShpbl9pcnEoKSkp
OwogCiAgICAgLyoKLSAgICAgKiBIYXJkd2FyZSBsaW1pdCBjaGVja2luZyBz
aG91bGQgZ3VhcmFudGVlIHRoaXMgcHJvcGVydHkuICBOQi4gVGhpcyBpcwor
ICAgICAqIFByaW9yIGxpbWl0IGNoZWNraW5nIHNob3VsZCBndWFyYW50ZWUg
dGhpcyBwcm9wZXJ0eS4gIE5CLiBUaGlzIGlzCiAgICAgICogc2FmZSBhcyB1
cGRhdGVzIHRvIHRoZSBMRFQgY2FuIG9ubHkgYmUgbWFkZSBieSBNTVVFWFRf
U0VUX0xEVCB0byB0aGUKICAgICAgKiBjdXJyZW50IHZjcHUsIGFuZCB2Y3B1
X3Jlc2V0KCkgd2lsbCBibG9jayB1bnRpbCB0aGlzIHZjcHUgaGFzIGJlZW4K
ICAgICAgKiBkZXNjaGVkdWxlZCBiZWZvcmUgY29udGludWluZy4KICAgICAg
Ki8KLSAgICBBU1NFUlQoKG9mZnNldCA+PiAzKSA8PSBjdXJyLT5hcmNoLnB2
X3ZjcHUubGR0X2VudHMpOworICAgIGlmICggdW5saWtlbHkoKG9mZnNldCA+
PiAzKSA+PSBjdXJyLT5hcmNoLnB2X3ZjcHUubGR0X2VudHMpICkKKyAgICB7
CisgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOworICAgICAgICByZXR1
cm4gZmFsc2U7CisgICAgfQogCiAgICAgaWYgKCBpc19wdl8zMmJpdF9kb21h
aW4oY3VycmQpICkKICAgICAgICAgbGluZWFyID0gKHVpbnQzMl90KWxpbmVh
cjsK

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--


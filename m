Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6BF9986DCD
	for <lists+xen-devel@lfdr.de>; Fri,  9 Aug 2019 01:15:20 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hvraQ-000321-7e; Thu, 08 Aug 2019 23:12:46 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=lyhG=WE=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1hvraO-00031e-FO
 for xen-devel@lists.xen.org; Thu, 08 Aug 2019 23:12:44 +0000
X-Inumbo-ID: 06c9864a-ba32-11e9-83ed-cfaf4b1f0b6e
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 06c9864a-ba32-11e9-83ed-cfaf4b1f0b6e;
 Thu, 08 Aug 2019 23:12:44 +0000 (UTC)
Received: from sstabellini-ThinkPad-T480s.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 1A4CF216C8;
 Thu,  8 Aug 2019 23:12:43 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1565305963;
 bh=2AfmFi7anX+X2pH4+meFLL4fdAtGDXbUKTLHh7lhCbE=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=gdEVdbJC5uFECdN6vYCYDEqeoxemtemaDSsQpYEbDAxL3/Agb7O4yw6EYC6TORHG5
 LvDLcDbR9ePV7MLHKBqVldRB9wnTglxxkPPGiBuY/+EEsa/hXwk+1vzJA2rqa6pN5R
 +fDvI7caPecJ56mwVC/0sBEnSQ0ydKe2JS/wV0+U=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Thu,  8 Aug 2019 16:12:37 -0700
Message-Id: <20190808231242.26424-1-sstabellini@kernel.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <alpine.DEB.2.21.1908081609510.22196@sstabellini-ThinkPad-T480s>
References: <alpine.DEB.2.21.1908081609510.22196@sstabellini-ThinkPad-T480s>
Subject: [Xen-devel] [PATCH v3 1/6] xen/arm: introduce handle_interrupts
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, sstabellini@kernel.org,
 andrii_anisov@epam.com, Achin.Gupta@arm.com, xen-devel@lists.xen.org,
 Volodymyr_Babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TW92ZSB0aGUgaW50ZXJydXB0IGhhbmRsaW5nIGNvZGUgb3V0IG9mIGhhbmRsZV9kZXZpY2UgdG8g
YSBuZXcgZnVuY3Rpb24Kc28gdGhhdCBpdCBjYW4gYmUgcmV1c2VkIGZvciBkb20wbGVzcyBWTXMg
bGF0ZXIuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHN0ZWZhbm9zQHhpbGlu
eC5jb20+Ci0tLQpDaGFuZ2VzIGluIHYzOgotIGFkZCBwYXRjaAoKVGhlIGRpZmYgaXMgaGFyZCB0
byByZWFkIGJ1dCBJIGp1c3QgbW92ZWQgdGhlIGludGVycnVwdHMgcmVsYXRlZCBjb2RlCmZyb20g
aGFuZGxlX2RldmljZXMgdG8gYSBuZXcgZnVuY3Rpb24gaGFuZGxlX2ludGVycnVwdHMsIGFuZCB2
ZXJ5IGxpdHRsZQplbHNlLgotLS0KIHhlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyB8IDc5ICsr
KysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA0OSBp
bnNlcnRpb25zKCspLCAzMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0v
ZG9tYWluX2J1aWxkLmMgYi94ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKaW5kZXggNGM4NDA0
MTU1YS4uMDBkZGIzYjA1ZCAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5j
CisrKyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYwpAQCAtMTIyMCw0MSArMTIyMCwxOSBA
QCBzdGF0aWMgaW50IF9faW5pdCBtYXBfZGV2aWNlX2NoaWxkcmVuKHN0cnVjdCBkb21haW4gKmQs
CiB9CiAKIC8qCi0gKiBGb3IgYSBnaXZlbiBkZXZpY2Ugbm9kZToKLSAqICAtIEdpdmUgcGVybWlz
c2lvbiB0byB0aGUgZ3Vlc3QgdG8gbWFuYWdlIElSUSBhbmQgTU1JTyByYW5nZQotICogIC0gUmV0
cmlldmUgdGhlIElSUSBjb25maWd1cmF0aW9uIChpLmUgZWRnZS9sZXZlbCkgZnJvbSBkZXZpY2Ug
dHJlZQotICogV2hlbiB0aGUgZGV2aWNlIGlzIG5vdCBtYXJrZWQgZm9yIGd1ZXN0IHBhc3N0aHJv
dWdoOgotICogIC0gQXNzaWduIHRoZSBkZXZpY2UgdG8gdGhlIGd1ZXN0IGlmIGl0J3MgcHJvdGVj
dGVkIGJ5IGFuIElPTU1VCi0gKiAgLSBNYXAgdGhlIElSUXMgYW5kIGlvbWVtIHJlZ2lvbnMgdG8g
RE9NMAorICogUmV0dXJuOgorICogICA8IDAgb24gZXJyb3IKKyAqICAgMCAgIG9uIG5vIG1hcHBp
bmcgcmVxdWlyZWQKKyAqICAgMSAgIElSUSBtYXBwaW5nIGRvbmUKICAqLwotc3RhdGljIGludCBf
X2luaXQgaGFuZGxlX2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2aWNlX25v
ZGUgKmRldiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX3R5cGVfdCBwMm10
KQorc3RhdGljIGludCBfX2luaXQgaGFuZGxlX2ludGVycnVwdHMoc3RydWN0IGRvbWFpbiAqZCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkdF9kZXZpY2Vfbm9k
ZSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBuZWVkX21h
cHBpbmcpCiB7Ci0gICAgdW5zaWduZWQgaW50IG5pcnE7Ci0gICAgdW5zaWduZWQgaW50IG5hZGRy
OwotICAgIHVuc2lnbmVkIGludCBpOwotICAgIGludCByZXM7CisgICAgaW50IGksIG5pcnEsIHJl
czsKICAgICBzdHJ1Y3QgZHRfcmF3X2lycSByaXJxOwotICAgIHU2NCBhZGRyLCBzaXplOwotICAg
IGJvb2wgbmVlZF9tYXBwaW5nID0gIWR0X2RldmljZV9mb3JfcGFzc3Rocm91Z2goZGV2KTsKIAog
ICAgIG5pcnEgPSBkdF9udW1iZXJfb2ZfaXJxKGRldik7Ci0gICAgbmFkZHIgPSBkdF9udW1iZXJf
b2ZfYWRkcmVzcyhkZXYpOwotCi0gICAgZHRfZHByaW50aygiJXMgcGFzc3Rocm91Z2ggPSAlZCBu
aXJxID0gJWQgbmFkZHIgPSAldVxuIiwKLSAgICAgICAgICAgICAgIGR0X25vZGVfZnVsbF9uYW1l
KGRldiksIG5lZWRfbWFwcGluZywgbmlycSwgbmFkZHIpOwotCi0gICAgaWYgKCBkdF9kZXZpY2Vf
aXNfcHJvdGVjdGVkKGRldikgJiYgbmVlZF9tYXBwaW5nICkKLSAgICB7Ci0gICAgICAgIGR0X2Rw
cmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKLSAgICAg
ICAgcmVzID0gaW9tbXVfYXNzaWduX2R0X2RldmljZShkLCBkZXYpOwotICAgICAgICBpZiAoIHJl
cyApCi0gICAgICAgIHsKLSAgICAgICAgICAgIHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQgdG8g
c2V0dXAgdGhlIElPTU1VIGZvciAlc1xuIiwKLSAgICAgICAgICAgICAgICAgICBkdF9ub2RlX2Z1
bGxfbmFtZShkZXYpKTsKLSAgICAgICAgICAgIHJldHVybiByZXM7Ci0gICAgICAgIH0KLSAgICB9
CiAKICAgICAvKiBHaXZlIHBlcm1pc3Npb24gYW5kIG1hcCBJUlFzICovCiAgICAgZm9yICggaSA9
IDA7IGkgPCBuaXJxOyBpKysgKQpAQCAtMTI5MSw2ICsxMjY5LDQ3IEBAIHN0YXRpYyBpbnQgX19p
bml0IGhhbmRsZV9kZXZpY2Uoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGR0X2RldmljZV9ub2Rl
ICpkZXYsCiAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgIH0KIAorICAgIHJldHVybiAhIShu
ZWVkX21hcHBpbmcgJiYgcmVzID09IDApOworfQorCisvKgorICogRm9yIGEgZ2l2ZW4gZGV2aWNl
IG5vZGU6CisgKiAgLSBHaXZlIHBlcm1pc3Npb24gdG8gdGhlIGd1ZXN0IHRvIG1hbmFnZSBJUlEg
YW5kIE1NSU8gcmFuZ2UKKyAqICAtIFJldHJpZXZlIHRoZSBJUlEgY29uZmlndXJhdGlvbiAoaS5l
IGVkZ2UvbGV2ZWwpIGZyb20gZGV2aWNlIHRyZWUKKyAqIFdoZW4gdGhlIGRldmljZSBpcyBub3Qg
bWFya2VkIGZvciBndWVzdCBwYXNzdGhyb3VnaDoKKyAqICAtIEFzc2lnbiB0aGUgZGV2aWNlIHRv
IHRoZSBndWVzdCBpZiBpdCdzIHByb3RlY3RlZCBieSBhbiBJT01NVQorICogIC0gTWFwIHRoZSBJ
UlFzIGFuZCBpb21lbSByZWdpb25zIHRvIERPTTAKKyAqLworc3RhdGljIGludCBfX2luaXQgaGFu
ZGxlX2RldmljZShzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKmRldiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDJtX3R5cGVfdCBwMm10KQoreworICAg
IHVuc2lnbmVkIGludCBuYWRkcjsKKyAgICB1bnNpZ25lZCBpbnQgaTsKKyAgICBpbnQgcmVzOwor
ICAgIHU2NCBhZGRyLCBzaXplOworICAgIGJvb2wgbmVlZF9tYXBwaW5nID0gIWR0X2RldmljZV9m
b3JfcGFzc3Rocm91Z2goZGV2KTsKKworICAgIG5hZGRyID0gZHRfbnVtYmVyX29mX2FkZHJlc3Mo
ZGV2KTsKKworICAgIGR0X2RwcmludGsoIiVzIHBhc3N0aHJvdWdoID0gJWQgbmFkZHIgPSAldVxu
IiwKKyAgICAgICAgICAgICAgIGR0X25vZGVfZnVsbF9uYW1lKGRldiksIG5lZWRfbWFwcGluZywg
bmFkZHIpOworCisgICAgaWYgKCBkdF9kZXZpY2VfaXNfcHJvdGVjdGVkKGRldikgJiYgbmVlZF9t
YXBwaW5nICkKKyAgICB7CisgICAgICAgIGR0X2RwcmludGsoIiVzIHNldHVwIGlvbW11XG4iLCBk
dF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKKyAgICAgICAgcmVzID0gaW9tbXVfYXNzaWduX2R0X2Rl
dmljZShkLCBkZXYpOworICAgICAgICBpZiAoIHJlcyApCisgICAgICAgIHsKKyAgICAgICAgICAg
IHByaW50ayhYRU5MT0dfRVJSICJGYWlsZWQgdG8gc2V0dXAgdGhlIElPTU1VIGZvciAlc1xuIiwK
KyAgICAgICAgICAgICAgICAgICBkdF9ub2RlX2Z1bGxfbmFtZShkZXYpKTsKKyAgICAgICAgICAg
IHJldHVybiByZXM7CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXMgPSBoYW5kbGVfaW50ZXJy
dXB0cyhkLCBkZXYsIG5lZWRfbWFwcGluZyk7CisgICAgaWYgKCByZXMgPCAwICkKKyAgICAgICAg
cmV0dXJuIHJlczsKKwogICAgIC8qIEdpdmUgcGVybWlzc2lvbiBhbmQgbWFwIE1NSU9zICovCiAg
ICAgZm9yICggaSA9IDA7IGkgPCBuYWRkcjsgaSsrICkKICAgICB7Ci0tIAoyLjE3LjEKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

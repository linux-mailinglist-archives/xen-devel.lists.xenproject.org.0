Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 7AA9F9E2E4
	for <lists+xen-devel@lfdr.de>; Tue, 27 Aug 2019 10:41:41 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i2Wz6-0001C4-GG; Tue, 27 Aug 2019 08:37:48 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=72vU=WX=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1i2Wz5-0001Bz-BM
 for xen-devel@lists.xenproject.org; Tue, 27 Aug 2019 08:37:47 +0000
X-Inumbo-ID: f08e1828-c8a5-11e9-ae2e-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id f08e1828-c8a5-11e9-ae2e-12813bfff9fa;
 Tue, 27 Aug 2019 08:37:44 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 9E88DAC8B;
 Tue, 27 Aug 2019 08:37:43 +0000 (UTC)
To: Andrew Cooper <andrew.cooper3@citrix.com>
References: <2d69ac51-9c4a-96f9-fd37-578658076571@suse.com>
 <1870d301-3c6e-ddda-610c-8664285a0897@citrix.com>
From: Jan Beulich <jbeulich@suse.com>
Message-ID: <23d4d354-0476-32d9-f029-5991994b381a@suse.com>
Date: Tue, 27 Aug 2019 10:37:42 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <1870d301-3c6e-ddda-610c-8664285a0897@citrix.com>
Content-Type: multipart/mixed; boundary="------------8EF38295BBE373D460132EDB"
Content-Language: en-US
Subject: Re: [Xen-devel] [PATCH 0/6] x86emul: further work
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>,
 Paul Durrant <Paul.Durrant@citrix.com>, Wei Liu <wl@xen.org>,
 Roger Pau Monne <roger.pau@citrix.com>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

This is a multi-part message in MIME format.
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

On 15.08.2019 16:24, Andrew Cooper wrote:
> On 01/07/2019 12:47, Jan Beulich wrote:
>> On top of the AVX512 series I'd like to put out for review/discussion
>>
>> 1: generalize wbinvd() hook
>> 2: support WBNOINVD
>> 3: generalize invlpg() hook
>> 4: move INVPCID_TYPE_* to x86-defns.h
>> 5: support INVPCID
>> 6: support MOVDIR{I,64B} insns
> 
> Do you have this series in patch form by any chance?

Sure, attached.

>Â  I encountered
> WBNOINVD while doing some more Rome support, but the patches themselves
> are almost unreviewable given the context mangling.

I'm sorry for this still unresolved issue.

Jan

--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=UTF-8;
 name="01-x86emul-cache-management.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="01-x86emul-cache-management.patch"

eDg2ZW11bDogZ2VuZXJhbGl6ZSB3YmludmQoKSBob29rCgpUaGUgaG9vayBpcyBhbHJlYWR5
IGluIHVzZSBmb3Igb3RoZXIgcHVycG9zZXMsIGFuZCBlbXVsYXRpbmcgZS5nLgpDTEZMVVNI
IGJ5IGlzc3VpbmcgV0JJTlZEIGlzLCB3ZWxsLCBub3QgdmVyeSBuaWNlLiBSZW5hbWUgdGhl
IGhvb2sgYW5kCmFkZCBwYXJhbWV0ZXJzLiBVc2UgbGlnaHRlciB3ZWlnaHQgZmx1c2hpbmcg
aW5zbnMgd2hlbiBwb3NzaWJsZSBpbgpodm1lbXVsX2NhY2hlX29wKCkuCgpodm1lbXVsX2Nh
Y2hlX29wKCkgdHJlYXRpbmcgeDg2ZW11bF9pbnZkIHRoZSBzYW1lIGFzIHg4NmVtdWxfd2Jp
bnZkIGlzCnRvIHJldGFpbiBvcmlnaW5hbCBiZWhhdmlvciwgYnV0IEknbSBub3Qgc3VyZSB0
aGlzIGlzIHdoYXQgd2Ugd2FudCBpbgp0aGUgbG9uZyBydW4uCgpTaWduZWQtb2ZmLWJ5OiBK
YW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQp2MzogUmUtYmFzZS4KdjI6IFVz
ZSBjYWNoZV9vcCgpIGFzIGhvb2sgbmFtZS4gQ29udmVydCBtYWNyb3MgdG8gaW5saW5lIGZ1
bmN0aW9ucyBpbgogICAgc3lzdGVtLmguIFJlLWJhc2UuCi0tLQpJIHdhcyB1bnN1cmUgYWJv
dXQgUFJFRkVUQ0gqIGFuZCBDTERFTU9URSAtIGJvdGggYXJlIGNhY2hlIG1hbmFnZW1lbnQK
aW5zbnMgdG9vLCBidXQgdGhlIGVtdWxhdG9yIGN1cnJlbnRseSB0cmVhdHMgdGhlbSBhcyBh
IE5PUCB3aXRob3V0Cmludm9raW5nIGFueSBob29rcy4KSSB3YXMgYWxzbyB1bmNlcnRhaW4g
YWJvdXQgdGhlIG5ldyBjYWNoZV9mbHVzaF9wZXJtaXR0ZWQoKSBpbnN0YW5jZSAtCmdlbmVy
YWxseSBJIHRoaW5rIGl0IHdvdWxkbid0IGJlIHRvbyBiYWQgaWYgd2UgYWxsb3dlZCBsaW5l
IGZsdXNoZXMgaW4KYWxsIGNhc2VzLCBpbiB3aGljaCBjYXNlIHRoZSBjaGVja3MgaW4gdGhl
IC0+d2JpbnZkX2ludGVyY2VwdCgpIGhhbmRsZXJzCndvdWxkIHN1ZmZpY2UgKGFzIHRoZXkg
ZGlkIHVudGlsIG5vdykuCgotLS0gYS90b29scy9mdXp6L3g4Nl9pbnN0cnVjdGlvbl9lbXVs
YXRvci9mdXp6LWVtdWwuYworKysgYi90b29scy9mdXp6L3g4Nl9pbnN0cnVjdGlvbl9lbXVs
YXRvci9mdXp6LWVtdWwuYwpAQCAtMzgyLDEwICszODIsMTMgQEAgc3RhdGljIGludCBmdXp6
X2ludmxwZygKICAgICByZXR1cm4gbWF5YmVfZmFpbChjdHh0LCAiaW52bHBnIiwgZmFsc2Up
OwogfQogCi1zdGF0aWMgaW50IGZ1enpfd2JpbnZkKAorc3RhdGljIGludCBmdXp6X2NhY2hl
X29wKAorICAgIGVudW0geDg2ZW11bF9jYWNoZV9vcCBvcCwKKyAgICBlbnVtIHg4Nl9zZWdt
ZW50IHNlZywKKyAgICB1bnNpZ25lZCBsb25nIG9mZnNldCwKICAgICBzdHJ1Y3QgeDg2X2Vt
dWxhdGVfY3R4dCAqY3R4dCkKIHsKLSAgICByZXR1cm4gbWF5YmVfZmFpbChjdHh0LCAid2Jp
bnZkIiwgdHJ1ZSk7CisgICAgcmV0dXJuIG1heWJlX2ZhaWwoY3R4dCwgImNhY2hlLW1hbmFn
ZW1lbnQiLCB0cnVlKTsKIH0KIAogc3RhdGljIGludCBmdXp6X3dyaXRlX2lvKApAQCAtNjIw
LDcgKzYyMyw3IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgeDg2X2VtdWxhdGVfb3BzIGFsbF8K
ICAgICBTRVQocmVhZF94Y3IpLAogICAgIFNFVChyZWFkX21zciksCiAgICAgU0VUKHdyaXRl
X21zciksCi0gICAgU0VUKHdiaW52ZCksCisgICAgU0VUKGNhY2hlX29wKSwKICAgICBTRVQo
aW52bHBnKSwKICAgICAuZ2V0X2ZwdSAgICA9IGVtdWxfdGVzdF9nZXRfZnB1LAogICAgIC5w
dXRfZnB1ICAgID0gZW11bF90ZXN0X3B1dF9mcHUsCkBAIC03MjksNyArNzMyLDcgQEAgZW51
bSB7CiAgICAgSE9PS19yZWFkX3hjciwKICAgICBIT09LX3JlYWRfbXNyLAogICAgIEhPT0tf
d3JpdGVfbXNyLAotICAgIEhPT0tfd2JpbnZkLAorICAgIEhPT0tfY2FjaGVfb3AsCiAgICAg
SE9PS19jcHVpZCwKICAgICBIT09LX2luamVjdF9od19leGNlcHRpb24sCiAgICAgSE9PS19p
bmplY3Rfc3dfaW50ZXJydXB0LApAQCAtNzczLDcgKzc3Niw3IEBAIHN0YXRpYyB2b2lkIGRp
c2FibGVfaG9va3Moc3RydWN0IHg4Nl9lbXUKICAgICBNQVlCRV9ESVNBQkxFX0hPT0socmVh
ZF94Y3IpOwogICAgIE1BWUJFX0RJU0FCTEVfSE9PSyhyZWFkX21zcik7CiAgICAgTUFZQkVf
RElTQUJMRV9IT09LKHdyaXRlX21zcik7Ci0gICAgTUFZQkVfRElTQUJMRV9IT09LKHdiaW52
ZCk7CisgICAgTUFZQkVfRElTQUJMRV9IT09LKGNhY2hlX29wKTsKICAgICBNQVlCRV9ESVNB
QkxFX0hPT0soY3B1aWQpOwogICAgIE1BWUJFX0RJU0FCTEVfSE9PSyhnZXRfZnB1KTsKICAg
ICBNQVlCRV9ESVNBQkxFX0hPT0soaW52bHBnKTsKLS0tIGEveGVuL2FyY2gveDg2L1J1bGVz
Lm1rCisrKyBiL3hlbi9hcmNoL3g4Ni9SdWxlcy5tawpAQCAtMTksNyArMTksOSBAQCAkKGNh
bGwgYXMtb3B0aW9uLWFkZCxDRkxBR1MsQ0MsImNyYzMyICVlCiAkKGNhbGwgYXMtb3B0aW9u
LWFkZCxDRkxBR1MsQ0MsImludmVwdCAoJXJheCkkJChjb21tYSklcmF4IiwtREhBVkVfQVNf
RVBUKQogJChjYWxsIGFzLW9wdGlvbi1hZGQsQ0ZMQUdTLENDLCJyZHJhbmQgJWVheCIsLURI
QVZFX0FTX1JEUkFORCkKICQoY2FsbCBhcy1vcHRpb24tYWRkLENGTEFHUyxDQywicmRmc2Jh
c2UgJXJheCIsLURIQVZFX0FTX0ZTR1NCQVNFKQorJChjYWxsIGFzLW9wdGlvbi1hZGQsQ0ZM
QUdTLENDLCJ4c2F2ZW9wdCAoJXJheCkiLC1ESEFWRV9BU19YU0FWRU9QVCkKICQoY2FsbCBh
cy1vcHRpb24tYWRkLENGTEFHUyxDQywicmRzZWVkICVlYXgiLC1ESEFWRV9BU19SRFNFRUQp
CiskKGNhbGwgYXMtb3B0aW9uLWFkZCxDRkxBR1MsQ0MsImNsd2IgKCVyYXgpIiwtREhBVkVf
QVNfQ0xXQikKICQoY2FsbCBhcy1vcHRpb24tYWRkLENGTEFHUyxDQywiLmVxdSBcInhcIiQk
KGNvbW1hKTEiLCBcCiAgICAgICAgICAgICAgICAgICAgICAtVV9fT0JKRUNUX0xBQkVMX18g
LURIQVZFX0FTX1FVT1RFRF9TWU0gXAogICAgICAgICAgICAgICAgICAgICAgJy1EX19PQkpF
Q1RfTEFCRUxfXz0kKHN1YnN0ICQoQkFTRURJUikvLCwkKENVUkRJUikpLyQkQCcpCi0tLSBh
L3hlbi9hcmNoL3g4Ni9odm0vZW11bGF0ZS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9odm0vZW11
bGF0ZS5jCkBAIC0yNSw2ICsyNSw3IEBACiAjaW5jbHVkZSA8YXNtL2h2bS90cmFjZS5oPgog
I2luY2x1ZGUgPGFzbS9odm0vc3VwcG9ydC5oPgogI2luY2x1ZGUgPGFzbS9odm0vc3ZtL3N2
bS5oPgorI2luY2x1ZGUgPGFzbS9pb2NhcC5oPgogI2luY2x1ZGUgPGFzbS92bV9ldmVudC5o
PgogCiBzdGF0aWMgdm9pZCBodm10cmFjZV9pb19hc3Npc3QoY29uc3QgaW9yZXFfdCAqcCkK
QEAgLTU1NSwxNiArNTU2LDEyIEBAIHN0YXRpYyB2b2lkICpodm1lbXVsX21hcF9saW5lYXJf
YWRkcigKICAgICBtZm5fdCAqbWZuID0gJmh2bWVtdWxfY3R4dC0+bWZuWzBdOwogCiAgICAg
LyoKLSAgICAgKiBUaGUgY2FsbGVyIGhhcyBubyBsZWdpdGltYXRlIHJlYXNvbiBmb3IgdHJ5
aW5nIGEgemVyby1ieXRlIHdyaXRlLCBidXQKLSAgICAgKiBhbGwgb3RoZXIgY29kZSBoZXJl
IGlzIHdyaXR0ZW4gdG8gd29yayBpZiB0aGUgY2hlY2sgYmVsb3cgd2FzIGRyb3BwZWQuCi0g
ICAgICoKLSAgICAgKiBUaGUgbWF4aW11bSB3cml0ZSBzaXplIGRlcGVuZHMgb24gdGhlIG51
bWJlciBvZiBhZGphY2VudCBtZm5zW10gd2hpY2gKKyAgICAgKiBUaGUgbWF4aW11bSBhY2Nl
c3Mgc2l6ZSBkZXBlbmRzIG9uIHRoZSBudW1iZXIgb2YgYWRqYWNlbnQgbWZuc1tdIHdoaWNo
CiAgICAgICogY2FuIGJlIHZtYXAoKSdkLCBhY2NvdXRpbmcgZm9yIHBvc3NpYmxlIG1pc2Fs
aWdubWVudCB3aXRoaW4gdGhlIHJlZ2lvbi4KICAgICAgKiBUaGUgaGlnaGVyIGxldmVsIGVt
dWxhdGlvbiBjYWxsZXJzIGFyZSByZXNwb25zaWJsZSBmb3IgZW5zdXJpbmcgdGhhdAotICAg
ICAqIG1mbnNbXSBpcyBsYXJnZSBlbm91Z2ggZm9yIHRoZSByZXF1ZXN0ZWQgd3JpdGUgc2l6
ZS4KKyAgICAgKiBtZm5zW10gaXMgbGFyZ2UgZW5vdWdoIGZvciB0aGUgcmVxdWVzdGVkIGFj
Y2VzcyBzaXplLgogICAgICAqLwotICAgIGlmICggYnl0ZXMgPT0gMCB8fAotICAgICAgICAg
bnJfZnJhbWVzID4gQVJSQVlfU0laRShodm1lbXVsX2N0eHQtPm1mbikgKQorICAgIGlmICgg
bnJfZnJhbWVzID4gQVJSQVlfU0laRShodm1lbXVsX2N0eHQtPm1mbikgKQogICAgIHsKICAg
ICAgICAgQVNTRVJUX1VOUkVBQ0hBQkxFKCk7CiAgICAgICAgIGdvdG8gdW5oYW5kbGVhYmxl
OwpAQCAtNjY5LDggKzY2Niw2IEBAIHN0YXRpYyB2b2lkIGh2bWVtdWxfdW5tYXBfbGluZWFy
X2FkZHIoCiAgICAgdW5zaWduZWQgaW50IGk7CiAgICAgbWZuX3QgKm1mbiA9ICZodm1lbXVs
X2N0eHQtPm1mblswXTsKIAotICAgIEFTU0VSVChieXRlcyA+IDApOwotCiAgICAgaWYgKCBu
cl9mcmFtZXMgPT0gMSApCiAgICAgICAgIHVubWFwX2RvbWFpbl9wYWdlKG1hcHBpbmcpOwog
ICAgIGVsc2UKQEAgLTE0ODMsNyArMTQ3OCwxMCBAQCBzdGF0aWMgaW50IGh2bWVtdWxfd3Jp
dGVfbXNyX2Rpc2NhcmQoCiAgICAgcmV0dXJuIFg4NkVNVUxfT0tBWTsKIH0KIAotc3RhdGlj
IGludCBodm1lbXVsX3diaW52ZF9kaXNjYXJkKAorc3RhdGljIGludCBodm1lbXVsX2NhY2hl
X29wX2Rpc2NhcmQoCisgICAgZW51bSB4ODZlbXVsX2NhY2hlX29wIG9wLAorICAgIGVudW0g
eDg2X3NlZ21lbnQgc2VnLAorICAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAogICAgIHN0cnVj
dCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0KQogewogICAgIHJldHVybiBYODZFTVVMX09LQVk7
CkBAIC0yMTU5LDEwICsyMTU3LDY1IEBAIHN0YXRpYyBpbnQgaHZtZW11bF93cml0ZV9tc3Io
CiAgICAgcmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50IGh2bWVtdWxfd2JpbnZkKAorc3Rh
dGljIGludCBodm1lbXVsX2NhY2hlX29wKAorICAgIGVudW0geDg2ZW11bF9jYWNoZV9vcCBv
cCwKKyAgICBlbnVtIHg4Nl9zZWdtZW50IHNlZywKKyAgICB1bnNpZ25lZCBsb25nIG9mZnNl
dCwKICAgICBzdHJ1Y3QgeDg2X2VtdWxhdGVfY3R4dCAqY3R4dCkKIHsKLSAgICBhbHRlcm5h
dGl2ZV92Y2FsbChodm1fZnVuY3Mud2JpbnZkX2ludGVyY2VwdCk7CisgICAgc3RydWN0IGh2
bV9lbXVsYXRlX2N0eHQgKmh2bWVtdWxfY3R4dCA9CisgICAgICAgIGNvbnRhaW5lcl9vZihj
dHh0LCBzdHJ1Y3QgaHZtX2VtdWxhdGVfY3R4dCwgY3R4dCk7CisgICAgdWludDMyX3QgcGZl
YyA9IFBGRUNfcGFnZV9wcmVzZW50OworCisgICAgaWYgKCAhY2FjaGVfZmx1c2hfcGVybWl0
dGVkKGN1cnJlbnQtPmRvbWFpbikgKQorICAgICAgICByZXR1cm4gWDg2RU1VTF9PS0FZOwor
CisgICAgc3dpdGNoICggb3AgKQorICAgIHsKKyAgICAgICAgdW5zaWduZWQgbG9uZyBhZGRy
OworICAgICAgICBpbnQgcmM7CisgICAgICAgIHZvaWQgKm1hcHBpbmc7CisKKyAgICBjYXNl
IHg4NmVtdWxfY2xmbHVzaDoKKyAgICBjYXNlIHg4NmVtdWxfY2xmbHVzaG9wdDoKKyAgICBj
YXNlIHg4NmVtdWxfY2x3YjoKKyAgICAgICAgQVNTRVJUKCFpc194ODZfc3lzdGVtX3NlZ21l
bnQoc2VnKSk7CisKKyAgICAgICAgcmMgPSBodm1lbXVsX3ZpcnR1YWxfdG9fbGluZWFyKHNl
Zywgb2Zmc2V0LCAwLCBOVUxMLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaHZtX2FjY2Vzc19yZWFkLCBodm1lbXVsX2N0eHQsICZhZGRyKTsKKyAgICAgICAg
aWYgKCByYyAhPSBYODZFTVVMX09LQVkgKQorICAgICAgICAgICAgYnJlYWs7CisKKyAgICAg
ICAgaWYgKCBodm1lbXVsX2N0eHQtPnNlZ19yZWdbeDg2X3NlZ19zc10uZHBsID09IDMgKQor
ICAgICAgICAgICAgcGZlYyB8PSBQRkVDX3VzZXJfbW9kZTsKKworICAgICAgICBtYXBwaW5n
ID0gaHZtZW11bF9tYXBfbGluZWFyX2FkZHIoYWRkciwgMCwgcGZlYywgaHZtZW11bF9jdHh0
KTsKKyAgICAgICAgaWYgKCBtYXBwaW5nID09IEVSUl9QVFIoflg4NkVNVUxfRVhDRVBUSU9O
KSApCisgICAgICAgICAgICByZXR1cm4gWDg2RU1VTF9FWENFUFRJT047CisgICAgICAgIGlm
ICggSVNfRVJSX09SX05VTEwobWFwcGluZykgKQorICAgICAgICAgICAgYnJlYWs7CisKKyAg
ICAgICAgaWYgKCBjcHVfaGFzX2NsZmx1c2ggKQorICAgICAgICB7CisgICAgICAgICAgICBp
ZiAoIG9wID09IHg4NmVtdWxfY2x3YiAmJiBjcHVfaGFzX2Nsd2IgKQorICAgICAgICAgICAg
ICAgIGNsd2IobWFwcGluZyk7CisgICAgICAgICAgICBlbHNlIGlmICggb3AgPT0geDg2ZW11
bF9jbGZsdXNob3B0ICYmIGNwdV9oYXNfY2xmbHVzaG9wdCApCisgICAgICAgICAgICAgICAg
Y2xmbHVzaG9wdChtYXBwaW5nKTsKKyAgICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAg
ICBjbGZsdXNoKG1hcHBpbmcpOworCisgICAgICAgICAgICBodm1lbXVsX3VubWFwX2xpbmVh
cl9hZGRyKG1hcHBpbmcsIGFkZHIsIDAsIGh2bWVtdWxfY3R4dCk7CisgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgfQorCisgICAgICAgIGh2bWVtdWxfdW5tYXBfbGluZWFyX2FkZHIo
bWFwcGluZywgYWRkciwgMCwgaHZtZW11bF9jdHh0KTsKKyAgICAgICAgLyogZmFsbCB0aHJv
dWdoICovCisgICAgY2FzZSB4ODZlbXVsX2ludmQ6CisgICAgY2FzZSB4ODZlbXVsX3diaW52
ZDoKKyAgICAgICAgYWx0ZXJuYXRpdmVfdmNhbGwoaHZtX2Z1bmNzLndiaW52ZF9pbnRlcmNl
cHQpOworICAgICAgICBicmVhazsKKyAgICB9CisKICAgICByZXR1cm4gWDg2RU1VTF9PS0FZ
OwogfQogCkBAIC0yMzYzLDcgKzI0MTYsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHg4Nl9l
bXVsYXRlX29wcyBodm1fCiAgICAgLndyaXRlX3hjciAgICAgPSBodm1lbXVsX3dyaXRlX3hj
ciwKICAgICAucmVhZF9tc3IgICAgICA9IGh2bWVtdWxfcmVhZF9tc3IsCiAgICAgLndyaXRl
X21zciAgICAgPSBodm1lbXVsX3dyaXRlX21zciwKLSAgICAud2JpbnZkICAgICAgICA9IGh2
bWVtdWxfd2JpbnZkLAorICAgIC5jYWNoZV9vcCAgICAgID0gaHZtZW11bF9jYWNoZV9vcCwK
ICAgICAuY3B1aWQgICAgICAgICA9IHg4NmVtdWxfY3B1aWQsCiAgICAgLmdldF9mcHUgICAg
ICAgPSBodm1lbXVsX2dldF9mcHUsCiAgICAgLnB1dF9mcHUgICAgICAgPSBodm1lbXVsX3B1
dF9mcHUsCkBAIC0yMzkwLDcgKzI0NDMsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHg4Nl9l
bXVsYXRlX29wcyBodm1fCiAgICAgLndyaXRlX3hjciAgICAgPSBodm1lbXVsX3dyaXRlX3hj
ciwKICAgICAucmVhZF9tc3IgICAgICA9IGh2bWVtdWxfcmVhZF9tc3IsCiAgICAgLndyaXRl
X21zciAgICAgPSBodm1lbXVsX3dyaXRlX21zcl9kaXNjYXJkLAotICAgIC53YmludmQgICAg
ICAgID0gaHZtZW11bF93YmludmRfZGlzY2FyZCwKKyAgICAuY2FjaGVfb3AgICAgICA9IGh2
bWVtdWxfY2FjaGVfb3BfZGlzY2FyZCwKICAgICAuY3B1aWQgICAgICAgICA9IHg4NmVtdWxf
Y3B1aWQsCiAgICAgLmdldF9mcHUgICAgICAgPSBodm1lbXVsX2dldF9mcHUsCiAgICAgLnB1
dF9mcHUgICAgICAgPSBodm1lbXVsX3B1dF9mcHUsCi0tLSBhL3hlbi9hcmNoL3g4Ni9wdi9l
bXVsLXByaXYtb3AuYworKysgYi94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMKQEAg
LTExMTcsOSArMTExNywxMSBAQCBzdGF0aWMgaW50IHdyaXRlX21zcih1bnNpZ25lZCBpbnQg
cmVnLCB1CiAgICAgcmV0dXJuIFg4NkVNVUxfVU5IQU5ETEVBQkxFOwogfQogCi0vKiBOYW1l
IGl0IGRpZmZlcmVudGx5IHRvIGF2b2lkIGNsYXNoaW5nIHdpdGggd2JpbnZkKCkgKi8KLXN0
YXRpYyBpbnQgX3diaW52ZChzdHJ1Y3QgeDg2X2VtdWxhdGVfY3R4dCAqY3R4dCkKK3N0YXRp
YyBpbnQgY2FjaGVfb3AoZW51bSB4ODZlbXVsX2NhY2hlX29wIG9wLCBlbnVtIHg4Nl9zZWdt
ZW50IHNlZywKKyAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBvZmZzZXQsIHN0
cnVjdCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0KQogeworICAgIEFTU0VSVChvcCA9PSB4ODZl
bXVsX3diaW52ZCk7CisKICAgICAvKiBJZ25vcmUgdGhlIGluc3RydWN0aW9uIGlmIHVucHJp
dmlsZWdlZC4gKi8KICAgICBpZiAoICFjYWNoZV9mbHVzaF9wZXJtaXR0ZWQoY3VycmVudC0+
ZG9tYWluKSApCiAgICAgICAgIC8qCkBAIC0xMjM3LDcgKzEyMzksNyBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IHg4Nl9lbXVsYXRlX29wcyBwcml2CiAgICAgLnJlYWRfbXNyICAgICAgICAg
ICAgPSByZWFkX21zciwKICAgICAud3JpdGVfbXNyICAgICAgICAgICA9IHdyaXRlX21zciwK
ICAgICAuY3B1aWQgICAgICAgICAgICAgICA9IHg4NmVtdWxfY3B1aWQsCi0gICAgLndiaW52
ZCAgICAgICAgICAgICAgPSBfd2JpbnZkLAorICAgIC5jYWNoZV9vcCAgICAgICAgICAgID0g
Y2FjaGVfb3AsCiB9OwogCiBpbnQgcHZfZW11bGF0ZV9wcml2aWxlZ2VkX29wKHN0cnVjdCBj
cHVfdXNlcl9yZWdzICpyZWdzKQotLS0gYS94ZW4vYXJjaC94ODYveDg2X2VtdWxhdGUveDg2
X2VtdWxhdGUuYworKysgYi94ZW4vYXJjaC94ODYveDg2X2VtdWxhdGUveDg2X2VtdWxhdGUu
YwpAQCAtNTkzMyw4ICs1OTMzLDExIEBAIHg4Nl9lbXVsYXRlKAogICAgIGNhc2UgWDg2RU1V
TF9PUEMoMHgwZiwgMHgwOCk6IC8qIGludmQgKi8KICAgICBjYXNlIFg4NkVNVUxfT1BDKDB4
MGYsIDB4MDkpOiAvKiB3YmludmQgKi8KICAgICAgICAgZ2VuZXJhdGVfZXhjZXB0aW9uX2lm
KCFtb2RlX3JpbmcwKCksIEVYQ19HUCwgMCk7Ci0gICAgICAgIGZhaWxfaWYob3BzLT53Ymlu
dmQgPT0gTlVMTCk7Ci0gICAgICAgIGlmICggKHJjID0gb3BzLT53YmludmQoY3R4dCkpICE9
IDAgKQorICAgICAgICBmYWlsX2lmKCFvcHMtPmNhY2hlX29wKTsKKyAgICAgICAgaWYgKCAo
cmMgPSBvcHMtPmNhY2hlX29wKGIgPT0gMHgwOSA/IHg4NmVtdWxfd2JpbnZkCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB4ODZlbXVsX2ludmQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ODZfc2VnX25vbmUsIDAsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHh0KSkgIT0gWDg2RU1VTF9PS0FZICkK
ICAgICAgICAgICAgIGdvdG8gZG9uZTsKICAgICAgICAgYnJlYWs7CiAKQEAgLTc4MDEsOCAr
NzgwNCw5IEBAIHg4Nl9lbXVsYXRlKAogICAgICAgICAgICAgLyogZWxzZSBjbHdiICovCiAg
ICAgICAgICAgICBmYWlsX2lmKCF2ZXgucGZ4KTsKICAgICAgICAgICAgIHZjcHVfbXVzdF9o
YXZlKGNsd2IpOwotICAgICAgICAgICAgZmFpbF9pZighb3BzLT53YmludmQpOwotICAgICAg
ICAgICAgaWYgKCAocmMgPSBvcHMtPndiaW52ZChjdHh0KSkgIT0gWDg2RU1VTF9PS0FZICkK
KyAgICAgICAgICAgIGZhaWxfaWYoIW9wcy0+Y2FjaGVfb3ApOworICAgICAgICAgICAgaWYg
KCAocmMgPSBvcHMtPmNhY2hlX29wKHg4NmVtdWxfY2x3YiwgZWEubWVtLnNlZywgZWEubWVt
Lm9mZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHh0KSkgIT0g
WDg2RU1VTF9PS0FZICkKICAgICAgICAgICAgICAgICBnb3RvIGRvbmU7CiAgICAgICAgICAg
ICBicmVhazsKICAgICAgICAgY2FzZSA3OgpAQCAtNzgxOCw4ICs3ODIyLDExIEBAIHg4Nl9l
bXVsYXRlKAogICAgICAgICAgICAgICAgIHZjcHVfbXVzdF9oYXZlKGNsZmx1c2gpOwogICAg
ICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgIHZjcHVfbXVzdF9oYXZlKGNsZmx1c2hv
cHQpOwotICAgICAgICAgICAgZmFpbF9pZihvcHMtPndiaW52ZCA9PSBOVUxMKTsKLSAgICAg
ICAgICAgIGlmICggKHJjID0gb3BzLT53YmludmQoY3R4dCkpICE9IDAgKQorICAgICAgICAg
ICAgZmFpbF9pZighb3BzLT5jYWNoZV9vcCk7CisgICAgICAgICAgICBpZiAoIChyYyA9IG9w
cy0+Y2FjaGVfb3AodmV4LnBmeCA/IHg4NmVtdWxfY2xmbHVzaG9wdAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB4ODZlbXVsX2NsZmx1c2gsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWEubWVtLnNlZywgZWEubWVt
Lm9mZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHh0KSkgIT0g
WDg2RU1VTF9PS0FZICkKICAgICAgICAgICAgICAgICBnb3RvIGRvbmU7CiAgICAgICAgICAg
ICBicmVhazsKICAgICAgICAgZGVmYXVsdDoKLS0tIGEveGVuL2FyY2gveDg2L3g4Nl9lbXVs
YXRlL3g4Nl9lbXVsYXRlLmgKKysrIGIveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9l
bXVsYXRlLmgKQEAgLTE3Niw2ICsxNzYsMTQgQEAgZW51bSB4ODZfZW11bGF0ZV9mcHVfdHlw
ZSB7CiAgICAgWDg2RU1VTF9GUFVfbm9uZQogfTsKIAorZW51bSB4ODZlbXVsX2NhY2hlX29w
IHsKKyAgICB4ODZlbXVsX2NsZmx1c2gsCisgICAgeDg2ZW11bF9jbGZsdXNob3B0LAorICAg
IHg4NmVtdWxfY2x3YiwKKyAgICB4ODZlbXVsX2ludmQsCisgICAgeDg2ZW11bF93YmludmQs
Cit9OworCiBzdHJ1Y3QgeDg2X2VtdWxhdGVfc3RhdGU7CiAKIC8qCkBAIC00NTIsOCArNDYw
LDE1IEBAIHN0cnVjdCB4ODZfZW11bGF0ZV9vcHMKICAgICAgICAgdWludDY0X3QgdmFsLAog
ICAgICAgICBzdHJ1Y3QgeDg2X2VtdWxhdGVfY3R4dCAqY3R4dCk7CiAKLSAgICAvKiB3Ymlu
dmQ6IFdyaXRlLWJhY2sgYW5kIGludmFsaWRhdGUgY2FjaGUgY29udGVudHMuICovCi0gICAg
aW50ICgqd2JpbnZkKSgKKyAgICAvKgorICAgICAqIGNhY2hlX29wOiBXcml0ZS1iYWNrIGFu
ZC9vciBpbnZhbGlkYXRlIGNhY2hlIGNvbnRlbnRzLgorICAgICAqCisgICAgICogQHNlZzpA
b2Zmc2V0IGFwcGxpY2FibGUgb25seSB0byBzb21lIG9mIGVudW0geDg2ZW11bF9jYWNoZV9v
cC4KKyAgICAgKi8KKyAgICBpbnQgKCpjYWNoZV9vcCkoCisgICAgICAgIGVudW0geDg2ZW11
bF9jYWNoZV9vcCBvcCwKKyAgICAgICAgZW51bSB4ODZfc2VnbWVudCBzZWcsCisgICAgICAg
IHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAogICAgICAgICBzdHJ1Y3QgeDg2X2VtdWxhdGVfY3R4
dCAqY3R4dCk7CiAKICAgICAvKiBjcHVpZDogRW11bGF0ZSBDUFVJRCB2aWEgZ2l2ZW4gc2V0
IG9mIEVBWC1FRFggaW5wdXRzL291dHB1dHMuICovCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14
ODYvY3B1ZmVhdHVyZS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvY3B1ZmVhdHVyZS5o
CkBAIC0xMDIsNiArMTAyLDggQEAKICNkZWZpbmUgY3B1X2hhc19yZHNlZWQgICAgICAgICAg
Ym9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX1JEU0VFRCkKICNkZWZpbmUgY3B1X2hhc19zbWFw
ICAgICAgICAgICAgYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX1NNQVApCiAjZGVmaW5lIGNw
dV9oYXNfYXZ4NTEyX2lmbWEgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9BVlg1MTJf
SUZNQSkKKyNkZWZpbmUgY3B1X2hhc19jbGZsdXNob3B0ICAgICAgYm9vdF9jcHVfaGFzKFg4
Nl9GRUFUVVJFX0NMRkxVU0hPUFQpCisjZGVmaW5lIGNwdV9oYXNfY2x3YiAgICAgICAgICAg
IGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9DTFdCKQogI2RlZmluZSBjcHVfaGFzX2F2eDUx
MmVyICAgICAgICBib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfQVZYNTEyRVIpCiAjZGVmaW5l
IGNwdV9oYXNfYXZ4NTEyY2QgICAgICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9BVlg1
MTJDRCkKICNkZWZpbmUgY3B1X2hhc19zaGEgICAgICAgICAgICAgYm9vdF9jcHVfaGFzKFg4
Nl9GRUFUVVJFX1NIQSkKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9zeXN0ZW0uaAorKysg
Yi94ZW4vaW5jbHVkZS9hc20teDg2L3N5c3RlbS5oCkBAIC0yMSw2ICsyMSwyMyBAQCBzdGF0
aWMgaW5saW5lIHZvaWQgY2xmbHVzaChjb25zdCB2b2lkICpwCiAgICAgYXNtIHZvbGF0aWxl
ICggImNsZmx1c2ggJTAiIDo6ICJtIiAoKihjb25zdCBjaGFyICopcCkgKTsKIH0KIAorc3Rh
dGljIGlubGluZSB2b2lkIGNsZmx1c2hvcHQoY29uc3Qgdm9pZCAqcCkKK3sKKyAgICBhc20g
dm9sYXRpbGUgKCAiZGF0YTE2IGNsZmx1c2ggJTAiIDo6ICJtIiAoKihjb25zdCBjaGFyICop
cCkgKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGNsd2IoY29uc3Qgdm9pZCAqcCkKK3sK
KyNpZiBkZWZpbmVkKEhBVkVfQVNfQ0xXQikKKyAgICBhc20gdm9sYXRpbGUgKCAiY2x3YiAl
MCIgOjogIm0iICgqKGNvbnN0IGNoYXIgKilwKSApOworI2VsaWYgZGVmaW5lZChIQVZFX0FT
X1hTQVZFT1BUKQorICAgIGFzbSB2b2xhdGlsZSAoICJkYXRhMTYgeHNhdmVvcHQgJTAiIDo6
ICJtIiAoKihjb25zdCBjaGFyICopcCkgKTsKKyNlbHNlCisgICAgYXNtIHZvbGF0aWxlICgg
Ii5ieXRlIDB4NjYsIDB4MGYsIDB4YWUsIDB4MzIiCisgICAgICAgICAgICAgICAgICAgOjog
ImQiIChwKSwgIm0iICgqKGNvbnN0IGNoYXIgKilwKSApOworI2VuZGlmCit9CisKICNkZWZp
bmUgeGNoZyhwdHIsdikgXAogICAgICgoX190eXBlb2ZfXygqKHB0cikpKV9feGNoZygodW5z
aWduZWQgbG9uZykodiksKHB0ciksc2l6ZW9mKCoocHRyKSkpKQogCg==
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=UTF-8;
 name="02-x86emul-WBNOINVD.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="02-x86emul-WBNOINVD.patch"

ClRPRE86IFBhdWwgdmFndWVseSBpbmRpY2F0ZXMgV0JOT0lOVkQgd2lsbCBoYXZlIGFuIGV4
aXQgcXVhbGlmaWNhdGlvbiBvZiAxLgogICAgICBXaGV0aGVyIHRoYXQncyBhbiBlbnVtIG9y
IGJpdCBtYXNrIGlzIHVuY2xlYXIuIE1heSB3YW50IHRvIGludGVncmF0ZQogICAgICB0aGlz
IG5ldmVydGhlbGVzcy4KCng4NmVtdWw6IHN1cHBvcnQgV0JOT0lOVkQKClJldiAwMzUgb2Yg
SW50ZWwncyBJU0EgZXh0ZW5zaW9ucyBkb2N1bWVudCBkb2VzIG5vdCBzdGF0ZSBpbnRlcmNl
cHQKYmVoYXZpb3IgZm9yIHRoZSBpbnNuIChJJ3ZlIGJlZW4gaW4tb2ZmaWNpYWxseSB0b2xk
IHRoYXQgdGhlIGRpc3RpbmN0aW9uCmlzIGdvaW5nIHRvIGJlIGJ5IGV4aXQgcXVhbGlmaWNh
dGlvbiwgYXMgSSB3b3VsZCBoYXZlIGFzc3VtZWQKY29uc2lkZXJpbmcgdGhhdCB0aGlzIHdh
eSBpdCdzIHN1ZmZpY2llbnRseSB0cmFuc3BhcmVudCB0byB1bmF3YXJlCnNvZnR3YXJlLCBh
bmQgdXNpbmcgV0JJTlZEIGluIHBsYWNlIG9mIFdCTk9JTlZEIGlzIGFsd2F5cyBjb3JyZWN0
LCBqdXN0Cmxlc3MgZWZmaWNpZW50KSwgc28gaW4gdGhlIEhWTSBjYXNlIGZvciBub3cgaXQn
bGwgYmUgYmFja2VkIGJ5IHRoZSBzYW1lCi0+d2JpbnZkX2ludGVyY2VwdCgpIGhhbmRsZXJz
LgoKVXNlIHRoaXMgb2NjYXNpb24gYW5kIGFsc28gYWRkIHRoZSB0d28gbWlzc2luZyB0YWJs
ZSBlbnRyaWVzIGZvcgpDTERFTU9URSwgd2hpY2ggZG9lc24ndCByZXF1aXJlIGFueSBmdXJ0
aGVyIGNoYW5nZXMgdG8gbWFrZSB3b3JrLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1
cnJhbnRAY2l0cml4LmNvbT4KLS0tCnYyOiBSZS1iYXNlLiBDb252ZXJ0IHdibm9pbnZkKCkg
aW5saW5lIGZ1bmN0aW9uLgoKLS0tIGEvdG9vbHMvbGlieGwvbGlieGxfY3B1aWQuYworKysg
Yi90b29scy9saWJ4bC9saWJ4bF9jcHVpZC5jCkBAIC0yMDgsNiArMjA4LDcgQEAgaW50IGxp
YnhsX2NwdWlkX3BhcnNlX2NvbmZpZyhsaWJ4bF9jcHVpZAogICAgICAgICB7ImF2eDUxMi1i
aXRhbGciLDB4MDAwMDAwMDcsICAwLCBDUFVJRF9SRUdfRUNYLCAxMiwgIDF9LAogICAgICAg
ICB7ImF2eDUxMi12cG9wY250ZHEiLDB4MDAwMDAwMDcsMCxDUFVJRF9SRUdfRUNYLCAxNCwg
IDF9LAogICAgICAgICB7InJkcGlkIiwgICAgICAgIDB4MDAwMDAwMDcsICAwLCBDUFVJRF9S
RUdfRUNYLCAyMiwgIDF9LAorICAgICAgICB7ImNsZGVtb3RlIiwgICAgIDB4MDAwMDAwMDcs
ICAwLCBDUFVJRF9SRUdfRUNYLCAyNSwgIDF9LAogCiAgICAgICAgIHsiYXZ4NTEyLTR2bm5p
dyIsMHgwMDAwMDAwNywgIDAsIENQVUlEX1JFR19FRFgsICAyLCAgMX0sCiAgICAgICAgIHsi
YXZ4NTEyLTRmbWFwcyIsMHgwMDAwMDAwNywgIDAsIENQVUlEX1JFR19FRFgsICAzLCAgMX0s
CkBAIC0yNTYsNiArMjU3LDcgQEAgaW50IGxpYnhsX2NwdWlkX3BhcnNlX2NvbmZpZyhsaWJ4
bF9jcHVpZAogCiAgICAgICAgIHsiaW52dHNjIiwgICAgICAgMHg4MDAwMDAwNywgTkEsIENQ
VUlEX1JFR19FRFgsICA4LCAgMX0sCiAKKyAgICAgICAgeyJ3Ym5vaW52ZCIsICAgICAweDgw
MDAwMDA4LCBOQSwgQ1BVSURfUkVHX0VCWCwgIDksICAxfSwKICAgICAgICAgeyJpYnBiIiwg
ICAgICAgICAweDgwMDAwMDA4LCBOQSwgQ1BVSURfUkVHX0VCWCwgMTIsICAxfSwKICAgICAg
ICAgeyJuYyIsICAgICAgICAgICAweDgwMDAwMDA4LCBOQSwgQ1BVSURfUkVHX0VDWCwgIDAs
ICA4fSwKICAgICAgICAgeyJhcGljaWRzaXplIiwgICAweDgwMDAwMDA4LCBOQSwgQ1BVSURf
UkVHX0VDWCwgMTIsICA0fSwKLS0tIGEvdG9vbHMvbWlzYy94ZW4tY3B1aWQuYworKysgYi90
b29scy9taXNjL3hlbi1jcHVpZC5jCkBAIC0xNDYsNiArMTQ2LDggQEAgc3RhdGljIGNvbnN0
IGNoYXIgKmNvbnN0IHN0cl9lOGJbMzJdID0KIHsKICAgICBbIDBdID0gImNsemVybyIsCiAK
KyAgICAvKiBbIDhdICovICAgICAgICAgICAgWyA5XSA9ICJ3Ym5vaW52ZCIsCisKICAgICBb
MTJdID0gImlicGIiLAogfTsKIAotLS0gYS94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYwor
KysgYi94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYwpAQCAtMjIxMiw2ICsyMjEyLDcgQEAg
c3RhdGljIGludCBodm1lbXVsX2NhY2hlX29wKAogICAgICAgICAvKiBmYWxsIHRocm91Z2gg
Ki8KICAgICBjYXNlIHg4NmVtdWxfaW52ZDoKICAgICBjYXNlIHg4NmVtdWxfd2JpbnZkOgor
ICAgIGNhc2UgeDg2ZW11bF93Ym5vaW52ZDoKICAgICAgICAgYWx0ZXJuYXRpdmVfdmNhbGwo
aHZtX2Z1bmNzLndiaW52ZF9pbnRlcmNlcHQpOwogICAgICAgICBicmVhazsKICAgICB9Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYworKysgYi94ZW4vYXJjaC94ODYv
cHYvZW11bC1wcml2LW9wLmMKQEAgLTExMjAsNyArMTEyMCw3IEBAIHN0YXRpYyBpbnQgd3Jp
dGVfbXNyKHVuc2lnbmVkIGludCByZWcsIHUKIHN0YXRpYyBpbnQgY2FjaGVfb3AoZW51bSB4
ODZlbXVsX2NhY2hlX29wIG9wLCBlbnVtIHg4Nl9zZWdtZW50IHNlZywKICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgbG9uZyBvZmZzZXQsIHN0cnVjdCB4ODZfZW11bGF0ZV9jdHh0
ICpjdHh0KQogewotICAgIEFTU0VSVChvcCA9PSB4ODZlbXVsX3diaW52ZCk7CisgICAgQVNT
RVJUKG9wID09IHg4NmVtdWxfd2JpbnZkIHx8IG9wID09IHg4NmVtdWxfd2Jub2ludmQpOwog
CiAgICAgLyogSWdub3JlIHRoZSBpbnN0cnVjdGlvbiBpZiB1bnByaXZpbGVnZWQuICovCiAg
ICAgaWYgKCAhY2FjaGVfZmx1c2hfcGVybWl0dGVkKGN1cnJlbnQtPmRvbWFpbikgKQpAQCAt
MTEyOSw2ICsxMTI5LDggQEAgc3RhdGljIGludCBjYWNoZV9vcChlbnVtIHg4NmVtdWxfY2Fj
aGVfbwogICAgICAgICAgKiBuZXdlciBsaW51eCB1c2VzIHRoaXMgaW4gc29tZSBzdGFydC1v
Zi1kYXkgdGltaW5nIGxvb3BzLgogICAgICAgICAgKi8KICAgICAgICAgOworICAgIGVsc2Ug
aWYgKCBvcCA9PSB4ODZlbXVsX3dibm9pbnZkICYmIGNwdV9oYXNfd2Jub2ludmQgKQorICAg
ICAgICB3Ym5vaW52ZCgpOwogICAgIGVsc2UKICAgICAgICAgd2JpbnZkKCk7CiAKLS0tIGEv
eGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmMKKysrIGIveGVuL2FyY2gv
eDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmMKQEAgLTE4NjksNiArMTg2OSw3IEBAIGlu
X3Byb3Rtb2RlKAogI2RlZmluZSB2Y3B1X2hhc19mbWE0KCkgICAgICAgIChjdHh0LT5jcHVp
ZC0+ZXh0ZC5mbWE0KQogI2RlZmluZSB2Y3B1X2hhc190Ym0oKSAgICAgICAgIChjdHh0LT5j
cHVpZC0+ZXh0ZC50Ym0pCiAjZGVmaW5lIHZjcHVfaGFzX2NsemVybygpICAgICAgKGN0eHQt
PmNwdWlkLT5leHRkLmNsemVybykKKyNkZWZpbmUgdmNwdV9oYXNfd2Jub2ludmQoKSAgICAo
Y3R4dC0+Y3B1aWQtPmV4dGQud2Jub2ludmQpCiAKICNkZWZpbmUgdmNwdV9oYXNfYm1pMSgp
ICAgICAgICAoY3R4dC0+Y3B1aWQtPmZlYXQuYm1pMSkKICNkZWZpbmUgdmNwdV9oYXNfaGxl
KCkgICAgICAgICAoY3R4dC0+Y3B1aWQtPmZlYXQuaGxlKQpAQCAtNTkzMSwxMCArNTkzMiwx
MyBAQCB4ODZfZW11bGF0ZSgKICAgICAgICAgYnJlYWs7CiAKICAgICBjYXNlIFg4NkVNVUxf
T1BDKDB4MGYsIDB4MDgpOiAvKiBpbnZkICovCi0gICAgY2FzZSBYODZFTVVMX09QQygweDBm
LCAweDA5KTogLyogd2JpbnZkICovCisgICAgY2FzZSBYODZFTVVMX09QQygweDBmLCAweDA5
KTogLyogd2JpbnZkIC8gd2Jub2ludmQgKi8KICAgICAgICAgZ2VuZXJhdGVfZXhjZXB0aW9u
X2lmKCFtb2RlX3JpbmcwKCksIEVYQ19HUCwgMCk7CiAgICAgICAgIGZhaWxfaWYoIW9wcy0+
Y2FjaGVfb3ApOwotICAgICAgICBpZiAoIChyYyA9IG9wcy0+Y2FjaGVfb3AoYiA9PSAweDA5
ID8geDg2ZW11bF93YmludmQKKyAgICAgICAgaWYgKCAocmMgPSBvcHMtPmNhY2hlX29wKGIg
PT0gMHgwOSA/ICFyZXBlX3ByZWZpeCgpIHx8CisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAhdmNwdV9oYXNfd2Jub2ludmQoKQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB4ODZlbXVsX3diaW52ZAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB4ODZlbXVsX3di
bm9pbnZkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB4
ODZlbXVsX2ludmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ODZfc2Vn
X25vbmUsIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHh0KSkgIT0g
WDg2RU1VTF9PS0FZICkKLS0tIGEveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVs
YXRlLmgKKysrIGIveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmgKQEAg
LTE4Miw2ICsxODIsNyBAQCBlbnVtIHg4NmVtdWxfY2FjaGVfb3AgewogICAgIHg4NmVtdWxf
Y2x3YiwKICAgICB4ODZlbXVsX2ludmQsCiAgICAgeDg2ZW11bF93YmludmQsCisgICAgeDg2
ZW11bF93Ym5vaW52ZCwKIH07CiAKIHN0cnVjdCB4ODZfZW11bGF0ZV9zdGF0ZTsKLS0tIGEv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9jcHVmZWF0dXJlLmgKKysrIGIveGVuL2luY2x1ZGUvYXNt
LXg4Ni9jcHVmZWF0dXJlLmgKQEAgLTEyOSw2ICsxMjksOSBAQAogI2RlZmluZSBjcHVfaGFz
X2F2eDUxMl80Zm1hcHMgICBib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfQVZYNTEyXzRGTUFQ
UykKICNkZWZpbmUgY3B1X2hhc190c3hfZm9yY2VfYWJvcnQgYm9vdF9jcHVfaGFzKFg4Nl9G
RUFUVVJFX1RTWF9GT1JDRV9BQk9SVCkKIAorLyogQ1BVSUQgbGV2ZWwgMHg4MDAwMDAwOC5l
YnggKi8KKyNkZWZpbmUgY3B1X2hhc193Ym5vaW52ZCAgICAgICAgYm9vdF9jcHVfaGFzKFg4
Nl9GRUFUVVJFX1dCTk9JTlZEKQorCiAvKiBTeW50aGVzaXplZC4gKi8KICNkZWZpbmUgY3B1
X2hhc19hcmNoX3BlcmZtb24gICAgYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0FSQ0hfUEVS
Rk1PTikKICNkZWZpbmUgY3B1X2hhc19jcHVpZF9mYXVsdGluZyAgYm9vdF9jcHVfaGFzKFg4
Nl9GRUFUVVJFX0NQVUlEX0ZBVUxUSU5HKQotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3N5
c3RlbS5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvc3lzdGVtLmgKQEAgLTE2LDYgKzE2
LDExIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB3YmludmQodm9pZCkKICAgICBhc20gdm9sYXRp
bGUgKCAid2JpbnZkIiA6OjogIm1lbW9yeSIgKTsKIH0KIAorc3RhdGljIGlubGluZSB2b2lk
IHdibm9pbnZkKHZvaWQpCit7CisgICAgYXNtIHZvbGF0aWxlICggInJlcGU7IHdiaW52ZCIg
OiA6IDogIm1lbW9yeSIgKTsKK30KKwogc3RhdGljIGlubGluZSB2b2lkIGNsZmx1c2goY29u
c3Qgdm9pZCAqcCkKIHsKICAgICBhc20gdm9sYXRpbGUgKCAiY2xmbHVzaCAlMCIgOjogIm0i
ICgqKGNvbnN0IGNoYXIgKilwKSApOwotLS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvYXJjaC14
ODYvY3B1ZmVhdHVyZXNldC5oCisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9hcmNoLXg4Ni9j
cHVmZWF0dXJlc2V0LmgKQEAgLTIzNiw2ICsyMzYsNyBAQCBYRU5fQ1BVRkVBVFVSRShBVlg1
MTJfVk5OSSwgICA2KjMyKzExKSAvCiBYRU5fQ1BVRkVBVFVSRShBVlg1MTJfQklUQUxHLCA2
KjMyKzEyKSAvKkEgIFN1cHBvcnQgZm9yIFZQT1BDTlRbQixXXSBhbmQgVlBTSFVGQklUUU1C
ICovCiBYRU5fQ1BVRkVBVFVSRShBVlg1MTJfVlBPUENOVERRLCA2KjMyKzE0KSAvKkEgIFBP
UENOVCBmb3IgdmVjdG9ycyBvZiBEVy9RVyAqLwogWEVOX0NQVUZFQVRVUkUoUkRQSUQsICAg
ICAgICAgNiozMisyMikgLypBICBSRFBJRCBpbnN0cnVjdGlvbiAqLworWEVOX0NQVUZFQVRV
UkUoQ0xERU1PVEUsICAgICAgNiozMisyNSkgLypBICBDTERFTU9URSBpbnN0cnVjdGlvbiAq
LwogCiAvKiBBTUQtZGVmaW5lZCBDUFUgZmVhdHVyZXMsIENQVUlEIGxldmVsIDB4ODAwMDAw
MDcuZWR4LCB3b3JkIDcgKi8KIFhFTl9DUFVGRUFUVVJFKElUU0MsICAgICAgICAgIDcqMzIr
IDgpIC8qICAgSW52YXJpYW50IFRTQyAqLwpAQCAtMjQzLDYgKzI0NCw3IEBAIFhFTl9DUFVG
RUFUVVJFKEVGUk8sICAgICAgICAgIDcqMzIrMTApIC8KIAogLyogQU1ELWRlZmluZWQgQ1BV
IGZlYXR1cmVzLCBDUFVJRCBsZXZlbCAweDgwMDAwMDA4LmVieCwgd29yZCA4ICovCiBYRU5f
Q1BVRkVBVFVSRShDTFpFUk8sICAgICAgICA4KjMyKyAwKSAvKkEgIENMWkVSTyBpbnN0cnVj
dGlvbiAqLworWEVOX0NQVUZFQVRVUkUoV0JOT0lOVkQsICAgICAgOCozMisgOSkgLypBICBX
Qk5PSU5WRCBpbnN0cnVjdGlvbiAqLwogWEVOX0NQVUZFQVRVUkUoSUJQQiwgICAgICAgICAg
OCozMisxMikgLypBICBJQlBCIHN1cHBvcnQgb25seSAobm8gSUJSUywgdXNlZCBieSBBTUQp
ICovCiAKIC8qIEludGVsLWRlZmluZWQgQ1BVIGZlYXR1cmVzLCBDUFVJRCBsZXZlbCAweDAw
MDAwMDA3OjAuZWR4LCB3b3JkIDkgKi8K
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=UTF-8;
 name="03-x86emul-TLB-management.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="03-x86emul-TLB-management.patch"

eDg2ZW11bDogZ2VuZXJhbGl6ZSBpbnZscGcoKSBob29rCgpUaGUgaG9vayBpcyBhbHJlYWR5
IGluIHVzZSBmb3IgSU5WTFBHQSBhcyB3ZWxsLiBSZW5hbWUgdGhlIGhvb2sgYW5kIGFkZApw
YXJhbWV0ZXJzLiBGb3IgdGhlIG1vbWVudCBJTlZMUEdBIHdpdGggYSBub24temVybyBBU0lE
IHJlbWFpbnMKdW5zdXBwb3J0ZWQsIGJ1dCB0aGUgVE9ETyBpdGVtIGdldHMgcHVzaGVkIGlu
dG8gdGhlIGFjdHVhbCBob29rIGhhbmRsZXIuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGlj
aCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBQYXVsIER1cnJhbnQgPHBhdWwu
ZHVycmFudEBjaXRyaXguY29tPgotLS0KdjI6IE5ldy4KCi0tLSBhL3Rvb2xzL2Z1enoveDg2
X2luc3RydWN0aW9uX2VtdWxhdG9yL2Z1enotZW11bC5jCisrKyBiL3Rvb2xzL2Z1enoveDg2
X2luc3RydWN0aW9uX2VtdWxhdG9yL2Z1enotZW11bC5jCkBAIC0zNzAsMTYgKzM3MCwyMyBA
QCBzdGF0aWMgaW50IGZ1enpfY21weGNoZygKICAgICByZXR1cm4gbWF5YmVfZmFpbChjdHh0
LCAiY21weGNoZyIsIHRydWUpOwogfQogCi1zdGF0aWMgaW50IGZ1enpfaW52bHBnKAotICAg
IGVudW0geDg2X3NlZ21lbnQgc2VnLAotICAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAorc3Rh
dGljIGludCBmdXp6X3RsYl9vcCgKKyAgICBlbnVtIHg4NmVtdWxfdGxiX29wIG9wLAorICAg
IHVuc2lnbmVkIGxvbmcgYWRkciwKKyAgICB1bnNpZ25lZCBsb25nIGF1eCwKICAgICBzdHJ1
Y3QgeDg2X2VtdWxhdGVfY3R4dCAqY3R4dCkKIHsKLSAgICAvKiBpbnZscGcoKSwgdW5saWtl
IGFsbCBvdGhlciBob29rcywgbWF5IGJlIGNhbGxlZCB3aXRoIHg4Nl9zZWdfbm9uZS4gKi8K
LSAgICBhc3NlcnQoaXNfeDg2X3VzZXJfc2VnbWVudChzZWcpIHx8IHNlZyA9PSB4ODZfc2Vn
X25vbmUpOwotICAgIGFzc2VydChjdHh0LT5hZGRyX3NpemUgPT0gNjQgfHwgIShvZmZzZXQg
Pj4gMzIpKTsKKyAgICBzd2l0Y2ggKCBvcCApCisgICAgeworICAgIGNhc2UgeDg2ZW11bF9p
bnZscGc6CisgICAgICAgIGFzc2VydChpc194ODZfdXNlcl9zZWdtZW50KGF1eCkpOworICAg
ICAgICAvKiBmYWxsIHRocm91Z2ggKi8KKyAgICBjYXNlIHg4NmVtdWxfaW52bHBnYToKKyAg
ICAgICAgYXNzZXJ0KGN0eHQtPmFkZHJfc2l6ZSA9PSA2NCB8fCAhKGFkZHIgPj4gMzIpKTsK
KyAgICAgICAgYnJlYWs7CisgICAgfQogCi0gICAgcmV0dXJuIG1heWJlX2ZhaWwoY3R4dCwg
ImludmxwZyIsIGZhbHNlKTsKKyAgICByZXR1cm4gbWF5YmVfZmFpbChjdHh0LCAiVExCLW1h
bmFnZW1lbnQiLCBmYWxzZSk7CiB9CiAKIHN0YXRpYyBpbnQgZnV6el9jYWNoZV9vcCgKQEAg
LTYyNCw3ICs2MzEsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHg4Nl9lbXVsYXRlX29wcyBh
bGxfCiAgICAgU0VUKHJlYWRfbXNyKSwKICAgICBTRVQod3JpdGVfbXNyKSwKICAgICBTRVQo
Y2FjaGVfb3ApLAotICAgIFNFVChpbnZscGcpLAorICAgIFNFVCh0bGJfb3ApLAogICAgIC5n
ZXRfZnB1ICAgID0gZW11bF90ZXN0X2dldF9mcHUsCiAgICAgLnB1dF9mcHUgICAgPSBlbXVs
X3Rlc3RfcHV0X2ZwdSwKICAgICAuY3B1aWQgICAgICA9IGVtdWxfdGVzdF9jcHVpZCwKQEAg
LTczMywxMiArNzQwLDEyIEBAIGVudW0gewogICAgIEhPT0tfcmVhZF9tc3IsCiAgICAgSE9P
S193cml0ZV9tc3IsCiAgICAgSE9PS19jYWNoZV9vcCwKKyAgICBIT09LX3RsYl9vcCwKICAg
ICBIT09LX2NwdWlkLAogICAgIEhPT0tfaW5qZWN0X2h3X2V4Y2VwdGlvbiwKICAgICBIT09L
X2luamVjdF9zd19pbnRlcnJ1cHQsCiAgICAgSE9PS19nZXRfZnB1LAogICAgIEhPT0tfcHV0
X2ZwdSwKLSAgICBIT09LX2ludmxwZywKICAgICBIT09LX3ZtZnVuYywKICAgICBDQU5PTklD
QUxJWkVfcmlwLAogICAgIENBTk9OSUNBTElaRV9yc3AsCkBAIC03NzcsOSArNzg0LDkgQEAg
c3RhdGljIHZvaWQgZGlzYWJsZV9ob29rcyhzdHJ1Y3QgeDg2X2VtdQogICAgIE1BWUJFX0RJ
U0FCTEVfSE9PSyhyZWFkX21zcik7CiAgICAgTUFZQkVfRElTQUJMRV9IT09LKHdyaXRlX21z
cik7CiAgICAgTUFZQkVfRElTQUJMRV9IT09LKGNhY2hlX29wKTsKKyAgICBNQVlCRV9ESVNB
QkxFX0hPT0sodGxiX29wKTsKICAgICBNQVlCRV9ESVNBQkxFX0hPT0soY3B1aWQpOwogICAg
IE1BWUJFX0RJU0FCTEVfSE9PSyhnZXRfZnB1KTsKLSAgICBNQVlCRV9ESVNBQkxFX0hPT0so
aW52bHBnKTsKIH0KIAogLyoKLS0tIGEveGVuL2FyY2gveDg2L2h2bS9lbXVsYXRlLmMKKysr
IGIveGVuL2FyY2gveDg2L2h2bS9lbXVsYXRlLmMKQEAgLTIzNDksMzYgKzIzNDksNTIgQEAg
c3RhdGljIHZvaWQgaHZtZW11bF9wdXRfZnB1KAogICAgIH0KIH0KIAotc3RhdGljIGludCBo
dm1lbXVsX2ludmxwZygKLSAgICBlbnVtIHg4Nl9zZWdtZW50IHNlZywKLSAgICB1bnNpZ25l
ZCBsb25nIG9mZnNldCwKK3N0YXRpYyBpbnQgaHZtZW11bF90bGJfb3AoCisgICAgZW51bSB4
ODZlbXVsX3RsYl9vcCBvcCwKKyAgICB1bnNpZ25lZCBsb25nIGFkZHIsCisgICAgdW5zaWdu
ZWQgbG9uZyBhdXgsCiAgICAgc3RydWN0IHg4Nl9lbXVsYXRlX2N0eHQgKmN0eHQpCiB7CiAg
ICAgc3RydWN0IGh2bV9lbXVsYXRlX2N0eHQgKmh2bWVtdWxfY3R4dCA9CiAgICAgICAgIGNv
bnRhaW5lcl9vZihjdHh0LCBzdHJ1Y3QgaHZtX2VtdWxhdGVfY3R4dCwgY3R4dCk7Ci0gICAg
dW5zaWduZWQgbG9uZyBhZGRyOwotICAgIGludCByYzsKLQotICAgIHJjID0gaHZtZW11bF92
aXJ0dWFsX3RvX2xpbmVhcigKLSAgICAgICAgc2VnLCBvZmZzZXQsIDEsIE5VTEwsIGh2bV9h
Y2Nlc3Nfbm9uZSwgaHZtZW11bF9jdHh0LCAmYWRkcik7CisgICAgaW50IHJjID0gWDg2RU1V
TF9PS0FZOwogCi0gICAgaWYgKCByYyA9PSBYODZFTVVMX0VYQ0VQVElPTiApCisgICAgc3dp
dGNoICggb3AgKQogICAgIHsKLSAgICAgICAgLyoKLSAgICAgICAgICogYGludmxwZ2AgdGFr
ZXMgc2VnbWVudCBiYXNlcyBpbnRvIGFjY291bnQsIGJ1dCBpcyBub3Qgc3ViamVjdCB0bwot
ICAgICAgICAgKiBmYXVsdHMgZnJvbSBzZWdtZW50IHR5cGUvbGltaXQgY2hlY2tzLCBhbmQg
aXMgc3BlY2lmaWVkIGFzIGEgTk9QCi0gICAgICAgICAqIHdoZW4gaXNzdWVkIG9uIG5vbi1j
YW5vbmljYWwgYWRkcmVzc2VzLgotICAgICAgICAgKgotICAgICAgICAgKiBodm1lbXVsX3Zp
cnR1YWxfdG9fbGluZWFyKCkgcmFpc2VzIGV4Y2VwdGlvbnMgZm9yIHR5cGUvbGltaXQKLSAg
ICAgICAgICogdmlvbGF0aW9ucywgc28gc3F1YXNoIHRoZW0uCi0gICAgICAgICAqLwotICAg
ICAgICB4ODZfZW11bF9yZXNldF9ldmVudChjdHh0KTsKLSAgICAgICAgcmMgPSBYODZFTVVM
X09LQVk7CisgICAgY2FzZSB4ODZlbXVsX2ludmxwZzoKKyAgICAgICAgcmMgPSBodm1lbXVs
X3ZpcnR1YWxfdG9fbGluZWFyKGF1eCwgYWRkciwgMSwgTlVMTCwgaHZtX2FjY2Vzc19ub25l
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHZtZW11bF9jdHh0
LCAmYWRkcik7CisKKyAgICAgICAgaWYgKCByYyA9PSBYODZFTVVMX0VYQ0VQVElPTiApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgKiBgaW52bHBnYCB0YWtl
cyBzZWdtZW50IGJhc2VzIGludG8gYWNjb3VudCwgYnV0IGlzIG5vdCBzdWJqZWN0CisgICAg
ICAgICAgICAgKiB0byBmYXVsdHMgZnJvbSBzZWdtZW50IHR5cGUvbGltaXQgY2hlY2tzLCBh
bmQgaXMgc3BlY2lmaWVkIGFzCisgICAgICAgICAgICAgKiBhIE5PUCB3aGVuIGlzc3VlZCBv
biBub24tY2Fub25pY2FsIGFkZHJlc3Nlcy4KKyAgICAgICAgICAgICAqCisgICAgICAgICAg
ICAgKiBodm1lbXVsX3ZpcnR1YWxfdG9fbGluZWFyKCkgcmFpc2VzIGV4Y2VwdGlvbnMgZm9y
IHR5cGUvbGltaXQKKyAgICAgICAgICAgICAqIHZpb2xhdGlvbnMsIHNvIHNxdWFzaCB0aGVt
LgorICAgICAgICAgICAgICovCisgICAgICAgICAgICB4ODZfZW11bF9yZXNldF9ldmVudChj
dHh0KTsKKyAgICAgICAgICAgIHJjID0gWDg2RU1VTF9PS0FZOworICAgICAgICB9CisKKyAg
ICAgICAgaWYgKCByYyA9PSBYODZFTVVMX09LQVkgKQorICAgICAgICAgICAgcGFnaW5nX2lu
dmxwZyhjdXJyZW50LCBhZGRyKTsKKyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNlIHg4NmVt
dWxfaW52bHBnYToKKyAgICAgICAgLyogVE9ETzogU3VwcG9ydCBBU0lEcy4gKi8KKyAgICAg
ICAgaWYgKCAhYXV4ICkKKyAgICAgICAgICAgIHBhZ2luZ19pbnZscGcoY3VycmVudCwgYWRk
cik7CisgICAgICAgIGVsc2UKKyAgICAgICAgeworICAgICAgICAgICAgeDg2X2VtdWxfaHdf
ZXhjZXB0aW9uKFRSQVBfaW52YWxpZF9vcCwgWDg2X0VWRU5UX05PX0VDLCBjdHh0KTsKKyAg
ICAgICAgICAgIHJjID0gWDg2RU1VTF9FWENFUFRJT047CisgICAgICAgIH0KKyAgICAgICAg
YnJlYWs7CiAgICAgfQogCi0gICAgaWYgKCByYyA9PSBYODZFTVVMX09LQVkgKQotICAgICAg
ICBwYWdpbmdfaW52bHBnKGN1cnJlbnQsIGFkZHIpOwotCiAgICAgcmV0dXJuIHJjOwogfQog
CkBAIC0yNDE4LDEwICsyNDM0LDEwIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgeDg2X2VtdWxh
dGVfb3BzIGh2bV8KICAgICAucmVhZF9tc3IgICAgICA9IGh2bWVtdWxfcmVhZF9tc3IsCiAg
ICAgLndyaXRlX21zciAgICAgPSBodm1lbXVsX3dyaXRlX21zciwKICAgICAuY2FjaGVfb3Ag
ICAgICA9IGh2bWVtdWxfY2FjaGVfb3AsCisgICAgLnRsYl9vcCAgICAgICAgPSBodm1lbXVs
X3RsYl9vcCwKICAgICAuY3B1aWQgICAgICAgICA9IHg4NmVtdWxfY3B1aWQsCiAgICAgLmdl
dF9mcHUgICAgICAgPSBodm1lbXVsX2dldF9mcHUsCiAgICAgLnB1dF9mcHUgICAgICAgPSBo
dm1lbXVsX3B1dF9mcHUsCi0gICAgLmludmxwZyAgICAgICAgPSBodm1lbXVsX2ludmxwZywK
ICAgICAudm1mdW5jICAgICAgICA9IGh2bWVtdWxfdm1mdW5jLAogfTsKIApAQCAtMjQ0NSwx
MCArMjQ2MSwxMCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHg4Nl9lbXVsYXRlX29wcyBodm1f
CiAgICAgLnJlYWRfbXNyICAgICAgPSBodm1lbXVsX3JlYWRfbXNyLAogICAgIC53cml0ZV9t
c3IgICAgID0gaHZtZW11bF93cml0ZV9tc3JfZGlzY2FyZCwKICAgICAuY2FjaGVfb3AgICAg
ICA9IGh2bWVtdWxfY2FjaGVfb3BfZGlzY2FyZCwKKyAgICAudGxiX29wICAgICAgICA9IGh2
bWVtdWxfdGxiX29wLAogICAgIC5jcHVpZCAgICAgICAgID0geDg2ZW11bF9jcHVpZCwKICAg
ICAuZ2V0X2ZwdSAgICAgICA9IGh2bWVtdWxfZ2V0X2ZwdSwKICAgICAucHV0X2ZwdSAgICAg
ICA9IGh2bWVtdWxfcHV0X2ZwdSwKLSAgICAuaW52bHBnICAgICAgICA9IGh2bWVtdWxfaW52
bHBnLAogICAgIC52bWZ1bmMgICAgICAgID0gaHZtZW11bF92bWZ1bmMsCiB9OwogCi0tLSBh
L3hlbi9hcmNoL3g4Ni94ODZfZW11bGF0ZS94ODZfZW11bGF0ZS5jCisrKyBiL3hlbi9hcmNo
L3g4Ni94ODZfZW11bGF0ZS94ODZfZW11bGF0ZS5jCkBAIC01NTkwLDEwICs1NTkwLDkgQEAg
eDg2X2VtdWxhdGUoCiAgICAgICAgICAgICBnZW5lcmF0ZV9leGNlcHRpb25faWYoIShtc3Jf
dmFsICYgRUZFUl9TVk1FKSB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICFpbl9wcm90bW9kZShjdHh0LCBvcHMpLCBFWENfVUQpOwogICAgICAgICAgICAgZ2VuZXJh
dGVfZXhjZXB0aW9uX2lmKCFtb2RlX3JpbmcwKCksIEVYQ19HUCwgMCk7Ci0gICAgICAgICAg
ICBnZW5lcmF0ZV9leGNlcHRpb25faWYoX3JlZ3MuZWN4LCBFWENfVUQpOyAvKiBUT0RPOiBT
dXBwb3J0IEFTSURzLiAqLwotICAgICAgICAgICAgZmFpbF9pZihvcHMtPmludmxwZyA9PSBO
VUxMKTsKLSAgICAgICAgICAgIGlmICggKHJjID0gb3BzLT5pbnZscGcoeDg2X3NlZ19ub25l
LCB0cnVuY2F0ZV9lYShfcmVncy5yKGF4KSksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGN0eHQpKSApCisgICAgICAgICAgICBmYWlsX2lmKCFvcHMtPnRsYl9vcCk7
CisgICAgICAgICAgICBpZiAoIChyYyA9IG9wcy0+dGxiX29wKHg4NmVtdWxfaW52bHBnYSwg
dHJ1bmNhdGVfZWEoX3JlZ3MucihheCkpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBfcmVncy5lY3gsIGN0eHQpKSAhPSBYODZFTVVMX09LQVkgKQogICAgICAgICAg
ICAgICAgIGdvdG8gZG9uZTsKICAgICAgICAgICAgIGJyZWFrOwogCkBAIC01NzQ3LDggKzU3
NDYsOSBAQCB4ODZfZW11bGF0ZSgKICAgICAgICAgY2FzZSBHUlA3X01FTSg3KTogLyogaW52
bHBnICovCiAgICAgICAgICAgICBBU1NFUlQoZWEudHlwZSA9PSBPUF9NRU0pOwogICAgICAg
ICAgICAgZ2VuZXJhdGVfZXhjZXB0aW9uX2lmKCFtb2RlX3JpbmcwKCksIEVYQ19HUCwgMCk7
Ci0gICAgICAgICAgICBmYWlsX2lmKG9wcy0+aW52bHBnID09IE5VTEwpOwotICAgICAgICAg
ICAgaWYgKCAocmMgPSBvcHMtPmludmxwZyhlYS5tZW0uc2VnLCBlYS5tZW0ub2ZmLCBjdHh0
KSkgKQorICAgICAgICAgICAgZmFpbF9pZighb3BzLT50bGJfb3ApOworICAgICAgICAgICAg
aWYgKCAocmMgPSBvcHMtPnRsYl9vcCh4ODZlbXVsX2ludmxwZywgZWEubWVtLm9mZiwgZWEu
bWVtLnNlZywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4dCkpICE9
IFg4NkVNVUxfT0tBWSApCiAgICAgICAgICAgICAgICAgZ290byBkb25lOwogICAgICAgICAg
ICAgYnJlYWs7CiAKLS0tIGEveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRl
LmgKKysrIGIveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmgKQEAgLTE4
NSw2ICsxODUsMTEgQEAgZW51bSB4ODZlbXVsX2NhY2hlX29wIHsKICAgICB4ODZlbXVsX3di
bm9pbnZkLAogfTsKIAorZW51bSB4ODZlbXVsX3RsYl9vcCB7CisgICAgeDg2ZW11bF9pbnZs
cGcsCisgICAgeDg2ZW11bF9pbnZscGdhLAorfTsKKwogc3RydWN0IHg4Nl9lbXVsYXRlX3N0
YXRlOwogCiAvKgpAQCAtNDcyLDYgKzQ3NywxOSBAQCBzdHJ1Y3QgeDg2X2VtdWxhdGVfb3Bz
CiAgICAgICAgIHVuc2lnbmVkIGxvbmcgb2Zmc2V0LAogICAgICAgICBzdHJ1Y3QgeDg2X2Vt
dWxhdGVfY3R4dCAqY3R4dCk7CiAKKyAgICAvKgorICAgICAqIHRsYl9vcDogSW52YWxpZGF0
ZSBwYWdpbmcgc3RydWN0dXJlcyB3aGljaCBtYXAgYWRkcmVzc2VkIGJ5dGUuCisgICAgICoK
KyAgICAgKiBAYWRkciBhbmQgQGF1eCBoYXZlIEBvcC1zcGVjaWZpYyBtZWFuaW5nOgorICAg
ICAqIC0gSU5WTFBHOiAgQGF1eDpAYWRkciByZXByZXNlbnQgc2VnOm9mZnNldAorICAgICAq
IC0gSU5WTFBHQTogQGFkZHIgaXMgdGhlIGxpbmVhciBhZGRyZXNzLCBAYXV4IHRoZSBBU0lE
CisgICAgICovCisgICAgaW50ICgqdGxiX29wKSgKKyAgICAgICAgZW51bSB4ODZlbXVsX3Rs
Yl9vcCBvcCwKKyAgICAgICAgdW5zaWduZWQgbG9uZyBhZGRyLAorICAgICAgICB1bnNpZ25l
ZCBsb25nIGF1eCwKKyAgICAgICAgc3RydWN0IHg4Nl9lbXVsYXRlX2N0eHQgKmN0eHQpOwor
CiAgICAgLyogY3B1aWQ6IEVtdWxhdGUgQ1BVSUQgdmlhIGdpdmVuIHNldCBvZiBFQVgtRURY
IGlucHV0cy9vdXRwdXRzLiAqLwogICAgIGludCAoKmNwdWlkKSgKICAgICAgICAgdWludDMy
X3QgbGVhZiwKQEAgLTQ5OSwxMiArNTE3LDYgQEAgc3RydWN0IHg4Nl9lbXVsYXRlX29wcwog
ICAgICAgICBlbnVtIHg4Nl9lbXVsYXRlX2ZwdV90eXBlIGJhY2tvdXQsCiAgICAgICAgIGNv
bnN0IHN0cnVjdCB4ODZfZW11bF9mcHVfYXV4ICphdXgpOwogCi0gICAgLyogaW52bHBnOiBJ
bnZhbGlkYXRlIHBhZ2luZyBzdHJ1Y3R1cmVzIHdoaWNoIG1hcCBhZGRyZXNzZWQgYnl0ZS4g
Ki8KLSAgICBpbnQgKCppbnZscGcpKAotICAgICAgICBlbnVtIHg4Nl9zZWdtZW50IHNlZywK
LSAgICAgICAgdW5zaWduZWQgbG9uZyBvZmZzZXQsCi0gICAgICAgIHN0cnVjdCB4ODZfZW11
bGF0ZV9jdHh0ICpjdHh0KTsKLQogICAgIC8qIHZtZnVuYzogRW11bGF0ZSBWTUZVTkMgdmlh
IGdpdmVuIHNldCBvZiBFQVggRUNYIGlucHV0cyAqLwogICAgIGludCAoKnZtZnVuYykoCiAg
ICAgICAgIHN0cnVjdCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0KTsK
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=UTF-8;
 name="04-x86-INVPCID-defs.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="04-x86-INVPCID-defs.patch"

eDg2OiBtb3ZlIElOVlBDSURfVFlQRV8qIHRvIHg4Ni1kZWZucy5oCgpUaGlzIHdheSB0aGUg
aW5zbiBlbXVsYXRvciBjYW4gdGhlbiB0b28gdXNlIHRoZSAjZGVmaW5lLXMuCgpTaWduZWQt
b2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+ClJldmlld2VkLWJ5OiBQ
YXVsIER1cnJhbnQgPHBhdWwuZHVycmFudEBjaXRyaXguY29tPgotLS0KdjI6IE5ldy4KCi0t
LSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaW52cGNpZC5oCisrKyBiL3hlbi9pbmNsdWRlL2Fz
bS14ODYvaW52cGNpZC5oCkBAIC01LDExICs1LDYgQEAKIAogZXh0ZXJuIGJvb2wgdXNlX2lu
dnBjaWQ7CiAKLSNkZWZpbmUgSU5WUENJRF9UWVBFX0lORElWX0FERFIgICAgICAwCi0jZGVm
aW5lIElOVlBDSURfVFlQRV9TSU5HTEVfQ1RYVCAgICAgMQotI2RlZmluZSBJTlZQQ0lEX1RZ
UEVfQUxMX0lOQ0xfR0xPQkFMIDIKLSNkZWZpbmUgSU5WUENJRF9UWVBFX0FMTF9OT05fR0xP
QkFMICAzCi0KICNkZWZpbmUgSU5WUENJRF9PUENPREUgIi5ieXRlIDB4NjYsIDB4MGYsIDB4
MzgsIDB4ODJcbiIKICNkZWZpbmUgTU9EUk1fRUNYXzAxICAgIi5ieXRlIDB4MDFcbiIKIApA
QCAtMzgsMjUgKzMzLDI1IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpbnZwY2lkKHVuc2lnbmVk
IGludAogLyogRmx1c2ggYWxsIG1hcHBpbmdzIGZvciBhIGdpdmVuIFBDSUQgYW5kIGFkZHIs
IG5vdCBpbmNsdWRpbmcgZ2xvYmFscyAqLwogc3RhdGljIGlubGluZSB2b2lkIGludnBjaWRf
Zmx1c2hfb25lKHVuc2lnbmVkIGludCBwY2lkLCB1bnNpZ25lZCBsb25nIGFkZHIpCiB7Ci0g
ICAgaW52cGNpZChwY2lkLCBhZGRyLCBJTlZQQ0lEX1RZUEVfSU5ESVZfQUREUik7CisgICAg
aW52cGNpZChwY2lkLCBhZGRyLCBYODZfSU5WUENJRF9UWVBFX0lORElWX0FERFIpOwogfQog
CiAvKiBGbHVzaCBhbGwgbWFwcGluZ3MgZm9yIGEgZ2l2ZW4gUENJRCwgbm90IGluY2x1ZGlu
ZyBnbG9iYWxzICovCiBzdGF0aWMgaW5saW5lIHZvaWQgaW52cGNpZF9mbHVzaF9zaW5nbGVf
Y29udGV4dCh1bnNpZ25lZCBpbnQgcGNpZCkKIHsKLSAgICBpbnZwY2lkKHBjaWQsIDAsIElO
VlBDSURfVFlQRV9TSU5HTEVfQ1RYVCk7CisgICAgaW52cGNpZChwY2lkLCAwLCBYODZfSU5W
UENJRF9UWVBFX1NJTkdMRV9DVFhUKTsKIH0KIAogLyogRmx1c2ggYWxsIG1hcHBpbmdzLCBp
bmNsdWRpbmcgZ2xvYmFscywgZm9yIGFsbCBQQ0lEcyAqLwogc3RhdGljIGlubGluZSB2b2lk
IGludnBjaWRfZmx1c2hfYWxsKHZvaWQpCiB7Ci0gICAgaW52cGNpZCgwLCAwLCBJTlZQQ0lE
X1RZUEVfQUxMX0lOQ0xfR0xPQkFMKTsKKyAgICBpbnZwY2lkKDAsIDAsIFg4Nl9JTlZQQ0lE
X1RZUEVfQUxMX0lOQ0xfR0xPQkFMKTsKIH0KIAogLyogRmx1c2ggYWxsIG1hcHBpbmdzIGZv
ciBhbGwgUENJRHMsIGV4Y2x1ZGluZyBnbG9iYWxzICovCiBzdGF0aWMgaW5saW5lIHZvaWQg
aW52cGNpZF9mbHVzaF9hbGxfbm9uZ2xvYmFscyh2b2lkKQogewotICAgIGludnBjaWQoMCwg
MCwgSU5WUENJRF9UWVBFX0FMTF9OT05fR0xPQkFMKTsKKyAgICBpbnZwY2lkKDAsIDAsIFg4
Nl9JTlZQQ0lEX1RZUEVfQUxMX05PTl9HTE9CQUwpOwogfQogCiAjZW5kaWYJLyogX0FTTV9Y
ODZfSU5WUENJRF9IXyAqLwotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L3g4Ni1kZWZucy5o
CisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYveDg2LWRlZm5zLmgKQEAgLTEwOCw0ICsxMDgs
MTIgQEAKICAqLwogI2RlZmluZSBYODZfRFI3X0RFRkFVTFQgICAgICAgICAweDAwMDAwNDAw
ICAvKiBEZWZhdWx0ICVkcjcgdmFsdWUuICovCiAKKy8qCisgKiBJbnZhbGlkYXRpb24gdHlw
ZXMgZm9yIHRoZSBJTlZQQ0lEIGluc3RydWN0aW9uLgorICovCisjZGVmaW5lIFg4Nl9JTlZQ
Q0lEX1RZUEVfSU5ESVZfQUREUiAgICAgIDAKKyNkZWZpbmUgWDg2X0lOVlBDSURfVFlQRV9T
SU5HTEVfQ1RYVCAgICAgMQorI2RlZmluZSBYODZfSU5WUENJRF9UWVBFX0FMTF9JTkNMX0dM
T0JBTCAyCisjZGVmaW5lIFg4Nl9JTlZQQ0lEX1RZUEVfQUxMX05PTl9HTE9CQUwgIDMKKwog
I2VuZGlmCS8qIF9fWEVOX1g4Nl9ERUZOU19IX18gKi8K
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=UTF-8;
 name="05-x86emul-INVPCID.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="05-x86emul-INVPCID.patch"

eDg2ZW11bDogc3VwcG9ydCBJTlZQQ0lECgpKdXN0IGxpa2UgZm9yIElOVkxQR0EgdGhlIEhW
TSBob29rIG9ubHkgc3VwcG9ydHMgUENJRCAwIGZvciB0aGUgdGltZQpiZWluZyBmb3IgaW5k
aXZpZHVhbCBhZGRyZXNzIGludmFsaWRhdGlvbi4gSXQgYWxzbyB0cmFuc2xhdGVzIHRoZSBv
dGhlcgp0eXBlcyB0byBhIGZ1bGwgZmx1c2gsIHdoaWNoIGlzIGFyY2hpdGVjdHVyYWxseSBw
ZXJtaXR0ZWQgYW5kCnBlcmZvcm1hbmNlLXdpc2UgcHJlc3VtYWJseSBub3QgbXVjaCB3b3Jz
ZSBiZWNhdXNlIGVtdWxhdGlvbiBpcyBzbG93CmFueXdheS4KClNpZ25lZC1vZmYtYnk6IEph
biBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2aWV3ZWQtYnk6IFBhdWwgRHVycmFu
dCA8cGF1bC5kdXJyYW50QGNpdHJpeC5jb20+Ci0tLQp2MjogTmV3LgoKLS0tIGEvdG9vbHMv
ZnV6ei94ODZfaW5zdHJ1Y3Rpb25fZW11bGF0b3IvZnV6ei1lbXVsLmMKKysrIGIvdG9vbHMv
ZnV6ei94ODZfaW5zdHJ1Y3Rpb25fZW11bGF0b3IvZnV6ei1lbXVsLmMKQEAgLTM4Miw2ICsz
ODIsNyBAQCBzdGF0aWMgaW50IGZ1enpfdGxiX29wKAogICAgICAgICBhc3NlcnQoaXNfeDg2
X3VzZXJfc2VnbWVudChhdXgpKTsKICAgICAgICAgLyogZmFsbCB0aHJvdWdoICovCiAgICAg
Y2FzZSB4ODZlbXVsX2ludmxwZ2E6CisgICAgY2FzZSB4ODZlbXVsX2ludnBjaWQ6CiAgICAg
ICAgIGFzc2VydChjdHh0LT5hZGRyX3NpemUgPT0gNjQgfHwgIShhZGRyID4+IDMyKSk7CiAg
ICAgICAgIGJyZWFrOwogICAgIH0KLS0tIGEvdG9vbHMvdGVzdHMveDg2X2VtdWxhdG9yL3Rl
c3RfeDg2X2VtdWxhdG9yLmMKKysrIGIvdG9vbHMvdGVzdHMveDg2X2VtdWxhdG9yL3Rlc3Rf
eDg2X2VtdWxhdG9yLmMKQEAgLTY4NCw2ICs2ODQsMzggQEAgc3RhdGljIGludCByZWFkX21z
cigKICAgICByZXR1cm4gWDg2RU1VTF9VTkhBTkRMRUFCTEU7CiB9CiAKKyNkZWZpbmUgSU5W
UENJRF9BRERSIDB4MTIzNDU2NzgKKyNkZWZpbmUgSU5WUENJRF9QQ0lEIDB4MTIzCisKK3N0
YXRpYyBpbnQgcmVhZF9jcl9pbnZwY2lkKAorICAgIHVuc2lnbmVkIGludCByZWcsCisgICAg
dW5zaWduZWQgbG9uZyAqdmFsLAorICAgIHN0cnVjdCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0
KQoreworICAgIGludCByYyA9IGVtdWxfdGVzdF9yZWFkX2NyKHJlZywgdmFsLCBjdHh0KTsK
KworICAgIGlmICggcmMgPT0gWDg2RU1VTF9PS0FZICYmIHJlZyA9PSA0ICkKKyAgICAgICAg
KnZhbCB8PSBYODZfQ1I0X1BDSURFOworCisgICAgcmV0dXJuIHJjOworfQorCitzdGF0aWMg
aW50IHRsYl9vcF9pbnZwY2lkKAorICAgIGVudW0geDg2ZW11bF90bGJfb3Agb3AsCisgICAg
dW5zaWduZWQgbG9uZyBhZGRyLAorICAgIHVuc2lnbmVkIGxvbmcgYXV4LAorICAgIHN0cnVj
dCB4ODZfZW11bGF0ZV9jdHh0ICpjdHh0KQoreworICAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
c2VxOworCisgICAgaWYgKCBvcCAhPSB4ODZlbXVsX2ludnBjaWQgfHwgYWRkciAhPSBJTlZQ
Q0lEX0FERFIgfHwKKyAgICAgICAgIHg4NmVtdWxfaW52cGNpZF9wY2lkKGF1eCkgIT0gKHNl
cSA8IDQgPyAwIDogSU5WUENJRF9QQ0lEKSB8fAorICAgICAgICAgeDg2ZW11bF9pbnZwY2lk
X3R5cGUoYXV4KSAhPSAoc2VxKysgJiAzKSApCisgICAgICAgIHJldHVybiBYODZFTVVMX1VO
SEFORExFQUJMRTsKKworICAgIHJldHVybiBYODZFTVVMX09LQVk7Cit9CisKIHN0YXRpYyBz
dHJ1Y3QgeDg2X2VtdWxhdGVfb3BzIGVtdWxvcHMgPSB7CiAgICAgLnJlYWQgICAgICAgPSBy
ZWFkLAogICAgIC5pbnNuX2ZldGNoID0gZmV0Y2gsCkBAIC00NDgyLDYgKzQ1MTQsNDYgQEAg
aW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQogICAgICAgICBwcmludGYoIm9rYXlc
biIpOwogICAgIH0KICAgICBlbHNlCisgICAgICAgIHByaW50Zigic2tpcHBlZFxuIik7CisK
KyAgICBwcmludGYoIiUtNDBzIiwgIlRlc3RpbmcgaW52cGNpZCAxNiglZWN4KSwlJWVkeC4u
LiIpOworICAgIGlmICggc3RhY2tfZXhlYyApCisgICAgeworICAgICAgICBkZWNsX2luc24o
aW52cGNpZCk7CisKKyAgICAgICAgYXNtIHZvbGF0aWxlICggcHV0X2luc24oaW52cGNpZCwg
ImludnBjaWQgMTYoJTApLCAlMSIpCisgICAgICAgICAgICAgICAgICAgICAgIDo6ICJjIiAo
TlVMTCksICJkIiAoMEwpICk7CisKKyAgICAgICAgcmVzWzRdID0gMDsKKyAgICAgICAgcmVz
WzVdID0gMDsKKyAgICAgICAgcmVzWzZdID0gSU5WUENJRF9BRERSOworICAgICAgICByZXNb
N10gPSAwOworICAgICAgICByZWdzLmVjeCA9ICh1bnNpZ25lZCBsb25nKXJlczsKKyAgICAg
ICAgZW11bG9wcy50bGJfb3AgPSB0bGJfb3BfaW52cGNpZDsKKworICAgICAgICBmb3IgKCA7
IDsgKQorICAgICAgICB7CisgICAgICAgICAgICBmb3IgKCByZWdzLmVkeCA9IDA7IHJlZ3Mu
ZWR4IDwgNDsgKytyZWdzLmVkeCApCisgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAg
c2V0X2luc24oaW52cGNpZCk7CisgICAgICAgICAgICAgICAgcmMgPSB4ODZfZW11bGF0ZSgm
Y3R4dCwgJmVtdWxvcHMpOworICAgICAgICAgICAgICAgIGlmICggcmMgIT0gWDg2RU1VTF9P
S0FZIHx8ICFjaGVja19laXAoaW52cGNpZCkgKQorICAgICAgICAgICAgICAgICAgICBnb3Rv
IGZhaWw7CisgICAgICAgICAgICB9CisKKyAgICAgICAgICAgIGlmICggY3R4dC5hZGRyX3Np
emUgPCA2NCB8fCByZXNbNF0gPT0gSU5WUENJRF9QQ0lEICkKKyAgICAgICAgICAgICAgICBi
cmVhazsKKworICAgICAgICAgICAgZW11bG9wcy5yZWFkX2NyID0gcmVhZF9jcl9pbnZwY2lk
OworICAgICAgICAgICAgcmVzWzRdID0gSU5WUENJRF9QQ0lEOworICAgICAgICB9CisKKyAg
ICAgICAgZW11bG9wcy5yZWFkX2NyID0gZW11bF90ZXN0X3JlYWRfY3I7CisgICAgICAgIGVt
dWxvcHMudGxiX29wID0gTlVMTDsKKworICAgICAgICBwcmludGYoIm9rYXlcbiIpOworICAg
IH0KKyAgICBlbHNlCiAgICAgICAgIHByaW50Zigic2tpcHBlZFxuIik7CiAKICN1bmRlZiBk
ZWNsX2luc24KLS0tIGEvdG9vbHMvdGVzdHMveDg2X2VtdWxhdG9yL3g4Ni1lbXVsYXRlLmMK
KysrIGIvdG9vbHMvdGVzdHMveDg2X2VtdWxhdG9yL3g4Ni1lbXVsYXRlLmMKQEAgLTcyLDYg
KzcyLDcgQEAgYm9vbCBlbXVsX3Rlc3RfaW5pdCh2b2lkKQogICAgICAqIHRoZW0uCiAgICAg
ICovCiAgICAgY3AuYmFzaWMubW92YmUgPSB0cnVlOworICAgIGNwLmZlYXQuaW52cGNpZCA9
IHRydWU7CiAgICAgY3AuZmVhdC5hZHggPSB0cnVlOwogICAgIGNwLmZlYXQuYXZ4NTEycGYg
PSBjcC5mZWF0LmF2eDUxMmY7CiAgICAgY3AuZmVhdC5yZHBpZCA9IHRydWU7CkBAIC0xNDEs
NyArMTQyLDcgQEAgaW50IGVtdWxfdGVzdF9jcHVpZCgKICAgICAgKi8KICAgICBpZiAoIGxl
YWYgPT0gNyAmJiBzdWJsZWFmID09IDAgKQogICAgIHsKLSAgICAgICAgcmVzLT5iIHw9IDFV
IDw8IDE5OworICAgICAgICByZXMtPmIgfD0gKDFVIDw8IDEwKSB8ICgxVSA8PCAxOSk7CiAg
ICAgICAgIGlmICggcmVzLT5iICYgKDFVIDw8IDE2KSApCiAgICAgICAgICAgICByZXMtPmIg
fD0gMVUgPDwgMjY7CiAgICAgICAgIHJlcy0+YyB8PSAxVSA8PCAyMjsKLS0tIGEveGVuL2Fy
Y2gveDg2L2h2bS9lbXVsYXRlLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9lbXVsYXRlLmMK
QEAgLTIzODMsOCArMjM4MywxNiBAQCBzdGF0aWMgaW50IGh2bWVtdWxfdGxiX29wKAogICAg
ICAgICAgICAgcGFnaW5nX2ludmxwZyhjdXJyZW50LCBhZGRyKTsKICAgICAgICAgYnJlYWs7
CiAKKyAgICBjYXNlIHg4NmVtdWxfaW52cGNpZDoKKyAgICAgICAgaWYgKCB4ODZlbXVsX2lu
dnBjaWRfdHlwZShhdXgpICE9IFg4Nl9JTlZQQ0lEX1RZUEVfSU5ESVZfQUREUiApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIGh2bV9hc2lkX2ZsdXNoX3ZjcHUoY3VycmVudCk7CisgICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBhdXggPSB4ODZlbXVsX2ludnBj
aWRfcGNpZChhdXgpOworICAgICAgICAvKiBmYWxsIHRocm91Z2ggKi8KICAgICBjYXNlIHg4
NmVtdWxfaW52bHBnYToKLSAgICAgICAgLyogVE9ETzogU3VwcG9ydCBBU0lEcy4gKi8KKyAg
ICAgICAgLyogVE9ETzogU3VwcG9ydCBBU0lEcy9QQ0lEcy4gKi8KICAgICAgICAgaWYgKCAh
YXV4ICkKICAgICAgICAgICAgIHBhZ2luZ19pbnZscGcoY3VycmVudCwgYWRkcik7CiAgICAg
ICAgIGVsc2UKLS0tIGEveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmMK
KysrIGIveGVuL2FyY2gveDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmMKQEAgLTQ5Niw2
ICs0OTYsNyBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGV4dDBmMzhfdGFibGUgewogICAgIFsw
eDdhIC4uLiAweDdjXSA9IHsgLnNpbWRfc2l6ZSA9IHNpbWRfbm9uZSwgLnR3b19vcCA9IDEg
fSwKICAgICBbMHg3ZCAuLi4gMHg3ZV0gPSB7IC5zaW1kX3NpemUgPSBzaW1kX3BhY2tlZF9p
bnQsIC5kOHMgPSBkOHNfdmwgfSwKICAgICBbMHg3Zl0gPSB7IC5zaW1kX3NpemUgPSBzaW1k
X3BhY2tlZF9mcCwgLmQ4cyA9IGQ4c192bCB9LAorICAgIFsweDgyXSA9IHsgLnNpbWRfc2l6
ZSA9IHNpbWRfb3RoZXIgfSwKICAgICBbMHg4M10gPSB7IC5zaW1kX3NpemUgPSBzaW1kX3Bh
Y2tlZF9pbnQsIC5kOHMgPSBkOHNfdmwgfSwKICAgICBbMHg4OF0gPSB7IC5zaW1kX3NpemUg
PSBzaW1kX3BhY2tlZF9mcCwgLnR3b19vcCA9IDEsIC5kOHMgPSBkOHNfZHEgfSwKICAgICBb
MHg4OV0gPSB7IC5zaW1kX3NpemUgPSBzaW1kX3BhY2tlZF9pbnQsIC50d29fb3AgPSAxLCAu
ZDhzID0gZDhzX2RxIH0sCkBAIC0xODc1LDYgKzE4NzYsNyBAQCBpbl9wcm90bW9kZSgKICNk
ZWZpbmUgdmNwdV9oYXNfaGxlKCkgICAgICAgICAoY3R4dC0+Y3B1aWQtPmZlYXQuaGxlKQog
I2RlZmluZSB2Y3B1X2hhc19hdngyKCkgICAgICAgIChjdHh0LT5jcHVpZC0+ZmVhdC5hdngy
KQogI2RlZmluZSB2Y3B1X2hhc19ibWkyKCkgICAgICAgIChjdHh0LT5jcHVpZC0+ZmVhdC5i
bWkyKQorI2RlZmluZSB2Y3B1X2hhc19pbnZwY2lkKCkgICAgIChjdHh0LT5jcHVpZC0+ZmVh
dC5pbnZwY2lkKQogI2RlZmluZSB2Y3B1X2hhc19ydG0oKSAgICAgICAgIChjdHh0LT5jcHVp
ZC0+ZmVhdC5ydG0pCiAjZGVmaW5lIHZjcHVfaGFzX21weCgpICAgICAgICAgKGN0eHQtPmNw
dWlkLT5mZWF0Lm1weCkKICNkZWZpbmUgdmNwdV9oYXNfYXZ4NTEyZigpICAgICAoY3R4dC0+
Y3B1aWQtPmZlYXQuYXZ4NTEyZikKQEAgLTkxMjQsNiArOTEyNiw0OCBAQCB4ODZfZW11bGF0
ZSgKICAgICAgICAgQVNTRVJUKCFzdGF0ZS0+c2ltZF9zaXplKTsKICAgICAgICAgYnJlYWs7
CiAKKyAgICBjYXNlIFg4NkVNVUxfT1BDXzY2KDB4MGYzOCwgMHg4Mik6IC8qIGludnBjaWQg
cmVnLG0xMjggKi8KKyAgICAgICAgdmNwdV9tdXN0X2hhdmUoaW52cGNpZCk7CisgICAgICAg
IGdlbmVyYXRlX2V4Y2VwdGlvbl9pZihlYS50eXBlICE9IE9QX01FTSwgRVhDX1VEKTsKKyAg
ICAgICAgZ2VuZXJhdGVfZXhjZXB0aW9uX2lmKCFtb2RlX3JpbmcwKCksIEVYQ19HUCwgMCk7
CisKKyAgICAgICAgaWYgKCAocmMgPSBvcHMtPnJlYWQoZWEubWVtLnNlZywgZWEubWVtLm9m
ZiwgbW12YWxwLCAxNiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4dCkpICE9
IFg4NkVNVUxfT0tBWSApCisgICAgICAgICAgICBnb3RvIGRvbmU7CisKKyAgICAgICAgZ2Vu
ZXJhdGVfZXhjZXB0aW9uX2lmKG1tdmFscC0+eG1tWzBdICYgfjB4ZmZmLCBFWENfR1AsIDAp
OworICAgICAgICBkc3QudmFsID0gbW9kZV82NGJpdCgpID8gKmRzdC5yZWcgOiAodWludDMy
X3QpKmRzdC5yZWc7CisKKyAgICAgICAgc3dpdGNoICggZHN0LnZhbCApCisgICAgICAgIHsK
KyAgICAgICAgY2FzZSBYODZfSU5WUENJRF9UWVBFX0lORElWX0FERFI6CisgICAgICAgICAg
ICAgZ2VuZXJhdGVfZXhjZXB0aW9uX2lmKCFpc19jYW5vbmljYWxfYWRkcmVzcyhtbXZhbHAt
PnhtbVsxXSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVYQ19HUCwg
MCk7CisgICAgICAgICAgICAgLyogZmFsbCB0aHJvdWdoICovCisgICAgICAgIGNhc2UgWDg2
X0lOVlBDSURfVFlQRV9TSU5HTEVfQ1RYVDoKKyAgICAgICAgICAgICBpZiAoICFtb2RlXzY0
Yml0KCkgfHwgIW9wcy0+cmVhZF9jciApCisgICAgICAgICAgICAgICAgIGNyNCA9IDA7Cisg
ICAgICAgICAgICAgZWxzZSBpZiAoIChyYyA9IG9wcy0+cmVhZF9jcig0LCAmY3I0LCBjdHh0
KSkgIT0gWDg2RU1VTF9PS0FZICkKKyAgICAgICAgICAgICAgICAgZ290byBkb25lOworICAg
ICAgICAgICAgIGdlbmVyYXRlX2V4Y2VwdGlvbl9pZighKGNyNCAmIFg4Nl9DUjRfUENJREUp
ICYmIG1tdmFscC0+eG1tWzBdLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBFWENfR1AsIDApOworICAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIFg4Nl9J
TlZQQ0lEX1RZUEVfQUxMX0lOQ0xfR0xPQkFMOgorICAgICAgICBjYXNlIFg4Nl9JTlZQQ0lE
X1RZUEVfQUxMX05PTl9HTE9CQUw6CisgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGRl
ZmF1bHQ6CisgICAgICAgICAgICAgZ2VuZXJhdGVfZXhjZXB0aW9uKEVYQ19HUCwgMCk7Cisg
ICAgICAgIH0KKworICAgICAgICBmYWlsX2lmKCFvcHMtPnRsYl9vcCk7CisgICAgICAgIGlm
ICggKHJjID0gb3BzLT50bGJfb3AoeDg2ZW11bF9pbnZwY2lkLCB0cnVuY2F0ZV9lYShtbXZh
bHAtPnhtbVsxXSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDg2ZW11bF9p
bnZwY2lkX2F1eChtbXZhbHAtPnhtbVswXSwgZHN0LnZhbCksCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY3R4dCkpICE9IFg4NkVNVUxfT0tBWSApCisgICAgICAgICAgICBn
b3RvIGRvbmU7CisKKyAgICAgICAgc3RhdGUtPnNpbWRfc2l6ZSA9IHNpbWRfbm9uZTsKKyAg
ICAgICAgYnJlYWs7CisKICAgICBjYXNlIFg4NkVNVUxfT1BDX0VWRVhfNjYoMHgwZjM4LCAw
eDgzKTogLyogdnBtdWx0aXNoaWZ0cWIgW3h5el1tbS9tZW0sW3h5el1tbSxbeHl6XW1te2t9
ICovCiAgICAgICAgIGdlbmVyYXRlX2V4Y2VwdGlvbl9pZighZXZleC53LCBFWENfVUQpOwog
ICAgICAgICBob3N0X2FuZF92Y3B1X211c3RfaGF2ZShhdng1MTJfdmJtaSk7Ci0tLSBhL3hl
bi9hcmNoL3g4Ni94ODZfZW11bGF0ZS94ODZfZW11bGF0ZS5oCisrKyBiL3hlbi9hcmNoL3g4
Ni94ODZfZW11bGF0ZS94ODZfZW11bGF0ZS5oCkBAIC0xODgsOCArMTg4LDI2IEBAIGVudW0g
eDg2ZW11bF9jYWNoZV9vcCB7CiBlbnVtIHg4NmVtdWxfdGxiX29wIHsKICAgICB4ODZlbXVs
X2ludmxwZywKICAgICB4ODZlbXVsX2ludmxwZ2EsCisgICAgeDg2ZW11bF9pbnZwY2lkLAog
fTsKIAorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQgeDg2ZW11bF9pbnZwY2lkX2F1eCh1
bnNpZ25lZCBpbnQgcGNpZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5zaWduZWQgaW50IHR5cGUpCit7CisgICAgQVNTRVJUKCEocGNpZCAmIH4w
eGZmZikpOworICAgIHJldHVybiAodHlwZSA8PCAxMikgfCBwY2lkOworfQorCitzdGF0aWMg
aW5saW5lIHVuc2lnbmVkIGludCB4ODZlbXVsX2ludnBjaWRfcGNpZCh1bnNpZ25lZCBpbnQg
YXV4KQoreworICAgIHJldHVybiBhdXggJiAweGZmZjsKK30KKworc3RhdGljIGlubGluZSB1
bnNpZ25lZCBpbnQgeDg2ZW11bF9pbnZwY2lkX3R5cGUodW5zaWduZWQgaW50IGF1eCkKK3sK
KyAgICByZXR1cm4gYXV4ID4+IDEyOworfQorCiBzdHJ1Y3QgeDg2X2VtdWxhdGVfc3RhdGU7
CiAKIC8qCkBAIC00ODMsNiArNTAxLDggQEAgc3RydWN0IHg4Nl9lbXVsYXRlX29wcwogICAg
ICAqIEBhZGRyIGFuZCBAYXV4IGhhdmUgQG9wLXNwZWNpZmljIG1lYW5pbmc6CiAgICAgICog
LSBJTlZMUEc6ICBAYXV4OkBhZGRyIHJlcHJlc2VudCBzZWc6b2Zmc2V0CiAgICAgICogLSBJ
TlZMUEdBOiBAYWRkciBpcyB0aGUgbGluZWFyIGFkZHJlc3MsIEBhdXggdGhlIEFTSUQKKyAg
ICAgKiAtIElOVlBDSUQ6IEBhZGRyIGlzIHRoZSBsaW5lYXIgYWRkcmVzcywgQGF1eCB0aGUg
Y29tYmluYXRpb24gb2YKKyAgICAgKiAgICAgICAgICAgIFBDSUQgYW5kIHR5cGUgKHNlZSB4
ODZlbXVsX2ludnBjaWRfKigpKS4KICAgICAgKi8KICAgICBpbnQgKCp0bGJfb3ApKAogICAg
ICAgICBlbnVtIHg4NmVtdWxfdGxiX29wIG9wLAo=
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset=UTF-8;
 name="06-x86emul-MOVDIR.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="06-x86emul-MOVDIR.patch"

eDg2ZW11bDogc3VwcG9ydCBNT1ZESVJ7SSw2NEJ9IGluc25zCgpOb3RlIHRoYXQgdGhlIElT
QSBleHRlbnNpb25zIGRvY3VtZW50IHJldmlzaW9uIDAzNSBkb2Vzbid0IHNwZWNpZnkKZXhj
ZXB0aW9uIGJlaGF2aW9yIGZvciBNb2RSTS5tb2QgIT0gMGIxMTsgYXNzdW1pbmcgI1VEIGhl
cmUuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Cgot
LS0gYS94ZW4vYXJjaC94ODYveDg2X2VtdWxhdGUveDg2X2VtdWxhdGUuYworKysgYi94ZW4v
YXJjaC94ODYveDg2X2VtdWxhdGUveDg2X2VtdWxhdGUuYwpAQCAtNTQ4LDYgKzU0OCw4IEBA
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgZXh0MGYzOF90YWJsZSB7CiAgICAgWzB4ZjFdID0geyAu
dG9fbWVtID0gMSwgLnR3b19vcCA9IDEgfSwKICAgICBbMHhmMiAuLi4gMHhmM10gPSB7fSwK
ICAgICBbMHhmNSAuLi4gMHhmN10gPSB7fSwKKyAgICBbMHhmOF0gPSB7IC5zaW1kX3NpemUg
PSBzaW1kX290aGVyIH0sCisgICAgWzB4ZjldID0geyAudG9fbWVtID0gMSB9LAogfTsKIAog
LyogU2hpZnQgdmFsdWVzIGJldHdlZW4gc3JjIGFuZCBkc3Qgc2l6ZXMgb2YgcG1vdntzLHp9
eHtiLHcsZH17dyxkLHF9LiAqLwpAQCAtMTkwMiw2ICsxOTA0LDggQEAgaW5fcHJvdG1vZGUo
CiAjZGVmaW5lIHZjcHVfaGFzX2F2eDUxMl9iaXRhbGcoKSAoY3R4dC0+Y3B1aWQtPmZlYXQu
YXZ4NTEyX2JpdGFsZykKICNkZWZpbmUgdmNwdV9oYXNfYXZ4NTEyX3Zwb3BjbnRkcSgpIChj
dHh0LT5jcHVpZC0+ZmVhdC5hdng1MTJfdnBvcGNudGRxKQogI2RlZmluZSB2Y3B1X2hhc19y
ZHBpZCgpICAgICAgIChjdHh0LT5jcHVpZC0+ZmVhdC5yZHBpZCkKKyNkZWZpbmUgdmNwdV9o
YXNfbW92ZGlyaSgpICAgICAoY3R4dC0+Y3B1aWQtPmZlYXQubW92ZGlyaSkKKyNkZWZpbmUg
dmNwdV9oYXNfbW92ZGlyNjRiKCkgICAoY3R4dC0+Y3B1aWQtPmZlYXQubW92ZGlyNjRiKQog
I2RlZmluZSB2Y3B1X2hhc19hdng1MTJfNHZubml3KCkgKGN0eHQtPmNwdWlkLT5mZWF0LmF2
eDUxMl80dm5uaXcpCiAjZGVmaW5lIHZjcHVfaGFzX2F2eDUxMl80Zm1hcHMoKSAoY3R4dC0+
Y3B1aWQtPmZlYXQuYXZ4NTEyXzRmbWFwcykKIApAQCAtMjY5MywxMCArMjY5NywxMiBAQCB4
ODZfZGVjb2RlXzBmMzgoCiAgICAgewogICAgIGNhc2UgMHgwMCAuLi4gMHhlZjoKICAgICBj
YXNlIDB4ZjIgLi4uIDB4ZjU6Ci0gICAgY2FzZSAweGY3IC4uLiAweGZmOgorICAgIGNhc2Ug
MHhmNyAuLi4gMHhmODoKKyAgICBjYXNlIDB4ZmEgLi4uIDB4ZmY6CiAgICAgICAgIG9wX2J5
dGVzID0gMDsKICAgICAgICAgLyogZmFsbCB0aHJvdWdoICovCiAgICAgY2FzZSAweGY2OiAv
KiBhZGN4IC8gYWRveCAqLworICAgIGNhc2UgMHhmOTogLyogbW92ZGlyaSAqLwogICAgICAg
ICBjdHh0LT5vcGNvZGUgfD0gTUFTS19JTlNSKHZleC5wZngsIFg4NkVNVUxfT1BDX1BGWF9N
QVNLKTsKICAgICAgICAgYnJlYWs7CiAKQEAgLTk4OTYsNiArOTkwMiwzMiBAQCB4ODZfZW11
bGF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICIwIiAoKHVpbnQzMl90KXNy
Yy52YWwpLCAicm0iIChfcmVncy5lZHgpICk7CiAgICAgICAgIGJyZWFrOwogCisgICAgY2Fz
ZSBYODZFTVVMX09QQ182NigweDBmMzgsIDB4ZjgpOiAvKiBtb3ZkaXI2NGIgcixtNTEyICov
CisgICAgICAgIHZjcHVfbXVzdF9oYXZlKG1vdmRpcjY0Yik7CisgICAgICAgIGdlbmVyYXRl
X2V4Y2VwdGlvbl9pZihlYS50eXBlICE9IE9QX01FTSwgRVhDX1VEKTsKKyAgICAgICAgc3Jj
LnZhbCA9IHRydW5jYXRlX2VhKCpkc3QucmVnKTsKKyAgICAgICAgZ2VuZXJhdGVfZXhjZXB0
aW9uX2lmKCFpc19hbGlnbmVkKHg4Nl9zZWdfZXMsIHNyYy52YWwsIDY0LCBjdHh0LCBvcHMp
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRVhDX0dQLCAwKTsKKyAgICAgICAg
LyogSWdub3JlIHRoZSBub24tdGVtcG9yYWwgYmVoYXZpb3IgZm9yIG5vdy4gKi8KKyAgICAg
ICAgZmFpbF9pZighb3BzLT53cml0ZSk7CisgICAgICAgIEJVSUxEX0JVR19PTihzaXplb2Yo
Km1tdmFscCkgPCA2NCk7CisgICAgICAgIGlmICggKHJjID0gb3BzLT5yZWFkKGVhLm1lbS5z
ZWcsIGVhLm1lbS5vZmYsIG1tdmFscCwgNjQsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGN0eHQpKSAhPSBYODZFTVVMX09LQVkgfHwKKyAgICAgICAgICAgICAocmMgPSBvcHMt
PndyaXRlKHg4Nl9zZWdfZXMsIHNyYy52YWwsIG1tdmFscCwgNjQsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjdHh0KSkgIT0gWDg2RU1VTF9PS0FZICkKKyAgICAgICAgICAg
IGdvdG8gZG9uZTsKKyAgICAgICAgc3RhdGUtPnNpbWRfc2l6ZSA9IHNpbWRfbm9uZTsKKyAg
ICAgICAgc2ZlbmNlID0gdHJ1ZTsKKyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNlIFg4NkVN
VUxfT1BDKDB4MGYzOCwgMHhmOSk6IC8qIG1vdmRpcmkgbWVtLHIgKi8KKyAgICAgICAgdmNw
dV9tdXN0X2hhdmUobW92ZGlyaSk7CisgICAgICAgIGdlbmVyYXRlX2V4Y2VwdGlvbl9pZihk
c3QudHlwZSAhPSBPUF9NRU0sIEVYQ19VRCk7CisgICAgICAgIC8qIElnbm9yZSB0aGUgbm9u
LXRlbXBvcmFsIGJlaGF2aW9yIGZvciBub3cuICovCisgICAgICAgIGRzdC52YWwgPSBzcmMu
dmFsOworICAgICAgICBzZmVuY2UgPSB0cnVlOworICAgICAgICBicmVhazsKKwogICAgIGNh
c2UgWDg2RU1VTF9PUENfVkVYXzY2KDB4MGYzYSwgMHgwMCk6IC8qIHZwZXJtcSAkaW1tOCx5
bW0vbTI1Nix5bW0gKi8KICAgICBjYXNlIFg4NkVNVUxfT1BDX1ZFWF82NigweDBmM2EsIDB4
MDEpOiAvKiB2cGVybXBkICRpbW04LHltbS9tMjU2LHltbSAqLwogICAgICAgICBnZW5lcmF0
ZV9leGNlcHRpb25faWYoIXZleC5sIHx8ICF2ZXgudywgRVhDX1VEKTsKLS0tIGEveGVuL2lu
Y2x1ZGUvcHVibGljL2FyY2gteDg2L2NwdWZlYXR1cmVzZXQuaAorKysgYi94ZW4vaW5jbHVk
ZS9wdWJsaWMvYXJjaC14ODYvY3B1ZmVhdHVyZXNldC5oCkBAIC0yMzcsNiArMjM3LDggQEAg
WEVOX0NQVUZFQVRVUkUoQVZYNTEyX0JJVEFMRywgNiozMisxMikgLwogWEVOX0NQVUZFQVRV
UkUoQVZYNTEyX1ZQT1BDTlREUSwgNiozMisxNCkgLypBICBQT1BDTlQgZm9yIHZlY3RvcnMg
b2YgRFcvUVcgKi8KIFhFTl9DUFVGRUFUVVJFKFJEUElELCAgICAgICAgIDYqMzIrMjIpIC8q
QSAgUkRQSUQgaW5zdHJ1Y3Rpb24gKi8KIFhFTl9DUFVGRUFUVVJFKENMREVNT1RFLCAgICAg
IDYqMzIrMjUpIC8qQSAgQ0xERU1PVEUgaW5zdHJ1Y3Rpb24gKi8KK1hFTl9DUFVGRUFUVVJF
KE1PVkRJUkksICAgICAgIDYqMzIrMjcpIC8qQSAgTU9WRElSSSBpbnN0cnVjdGlvbiAqLwor
WEVOX0NQVUZFQVRVUkUoTU9WRElSNjRCLCAgICAgNiozMisyOCkgLypBICBNT1ZESVI2NEIg
aW5zdHJ1Y3Rpb24gKi8KIAogLyogQU1ELWRlZmluZWQgQ1BVIGZlYXR1cmVzLCBDUFVJRCBs
ZXZlbCAweDgwMDAwMDA3LmVkeCwgd29yZCA3ICovCiBYRU5fQ1BVRkVBVFVSRShJVFNDLCAg
ICAgICAgICA3KjMyKyA4KSAvKiAgIEludmFyaWFudCBUU0MgKi8KLS0tIGEvdG9vbHMvdGVz
dHMveDg2X2VtdWxhdG9yL3Rlc3RfeDg2X2VtdWxhdG9yLmMKKysrIGIvdG9vbHMvdGVzdHMv
eDg2X2VtdWxhdG9yL3Rlc3RfeDg2X2VtdWxhdG9yLmMKQEAgLTIxOTYsNiArMjE5NiwzNiBA
QCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpCiAgICAgICAgIGdvdG8gZmFpbDsK
ICAgICBwcmludGYoIm9rYXlcbiIpOwogCisgICAgcHJpbnRmKCIlLTQwcyIsICJUZXN0aW5n
IG1vdmRpcmkgJWVkeCwoJWVjeCkuLi4iKTsKKyAgICBpbnN0clswXSA9IDB4MGY7IGluc3Ry
WzFdID0gMHgzODsgaW5zdHJbMl0gPSAweGY5OyBpbnN0clszXSA9IDB4MTE7CisgICAgcmVn
cy5laXAgPSAodW5zaWduZWQgbG9uZykmaW5zdHJbMF07CisgICAgcmVncy5lY3ggPSAodW5z
aWduZWQgbG9uZyltZW1zZXQocmVzLCAtMSwgMTYpOworICAgIHJlZ3MuZWR4ID0gMHg0NDMz
MjIxMTsKKyAgICByYyA9IHg4Nl9lbXVsYXRlKCZjdHh0LCAmZW11bG9wcyk7CisgICAgaWYg
KCAocmMgIT0gWDg2RU1VTF9PS0FZKSB8fAorICAgICAgICAgKHJlZ3MuZWlwICE9ICh1bnNp
Z25lZCBsb25nKSZpbnN0cls0XSkgfHwKKyAgICAgICAgIHJlc1swXSAhPSAweDQ0MzMyMjEx
IHx8IH5yZXNbMV0gKQorICAgICAgICBnb3RvIGZhaWw7CisgICAgcHJpbnRmKCJva2F5XG4i
KTsKKworICAgIHByaW50ZigiJS00MHMiLCAiVGVzdGluZyBtb3ZkaXI2NGIgMTQ0KCVlZHgp
LCVlY3guLi4iKTsKKyAgICBpbnN0clswXSA9IDB4NjY7IGluc3RyWzFdID0gMHgwZjsgaW5z
dHJbMl0gPSAweDM4OyBpbnN0clszXSA9IDB4Zjg7CisgICAgaW5zdHJbNF0gPSAweDhhOyBp
bnN0cls1XSA9IDB4OTA7IGluc3RyWzhdID0gaW5zdHJbN10gPSBpbnN0cls2XSA9IDA7Cisg
ICAgcmVncy5laXAgPSAodW5zaWduZWQgbG9uZykmaW5zdHJbMF07CisgICAgZm9yICggaSA9
IDA7IGkgPCA2NDsgKytpICkKKyAgICAgICAgcmVzW2ldID0gaSAtIDIwOworICAgIHJlZ3Mu
ZWR4ID0gKHVuc2lnbmVkIGxvbmcpcmVzOworICAgIHJlZ3MuZWN4ID0gKHVuc2lnbmVkIGxv
bmcpKHJlcyArIDE2KTsKKyAgICByYyA9IHg4Nl9lbXVsYXRlKCZjdHh0LCAmZW11bG9wcyk7
CisgICAgaWYgKCAocmMgIT0gWDg2RU1VTF9PS0FZKSB8fAorICAgICAgICAgKHJlZ3MuZWlw
ICE9ICh1bnNpZ25lZCBsb25nKSZpbnN0cls5XSkgfHwKKyAgICAgICAgIHJlc1sxNV0gIT0g
LTUgfHwgcmVzWzMyXSAhPSAxMiApCisgICAgICAgIGdvdG8gZmFpbDsKKyAgICBmb3IgKCBp
ID0gMTY7IGkgPCAzMjsgKytpICkKKyAgICAgICAgaWYgKCByZXNbaV0gIT0gaSApCisgICAg
ICAgICAgICBnb3RvIGZhaWw7CisgICAgcHJpbnRmKCJva2F5XG4iKTsKKwogICAgIHByaW50
ZigiJS00MHMiLCAiVGVzdGluZyBtb3ZxICVtbTMsKCVlY3gpLi4uIik7CiAgICAgaWYgKCBz
dGFja19leGVjICYmIGNwdV9oYXNfbW14ICkKICAgICB7Ci0tLSBhL3Rvb2xzL3Rlc3RzL3g4
Nl9lbXVsYXRvci94ODYtZW11bGF0ZS5jCisrKyBiL3Rvb2xzL3Rlc3RzL3g4Nl9lbXVsYXRv
ci94ODYtZW11bGF0ZS5jCkBAIC03Niw2ICs3Niw4IEBAIGJvb2wgZW11bF90ZXN0X2luaXQo
dm9pZCkKICAgICBjcC5mZWF0LmFkeCA9IHRydWU7CiAgICAgY3AuZmVhdC5hdng1MTJwZiA9
IGNwLmZlYXQuYXZ4NTEyZjsKICAgICBjcC5mZWF0LnJkcGlkID0gdHJ1ZTsKKyAgICBjcC5m
ZWF0Lm1vdmRpcmkgPSB0cnVlOworICAgIGNwLmZlYXQubW92ZGlyNjRiID0gdHJ1ZTsKICAg
ICBjcC5leHRkLmNsemVybyA9IHRydWU7CiAKICAgICBpZiAoIGNwdV9oYXNfeHNhdmUgKQpA
QCAtMTM3LDE1ICsxMzksMTUgQEAgaW50IGVtdWxfdGVzdF9jcHVpZCgKICAgICAgICAgcmVz
LT5jIHw9IDFVIDw8IDIyOwogCiAgICAgLyoKLSAgICAgKiBUaGUgZW11bGF0b3IgZG9lc24n
dCBpdHNlbGYgdXNlIEFEQ1gvQURPWC9SRFBJRCBub3IgdGhlIFMvRyBwcmVmZXRjaAotICAg
ICAqIGluc25zLCBzbyB3ZSBjYW4gYWx3YXlzIHJ1biB0aGUgcmVzcGVjdGl2ZSB0ZXN0cy4K
KyAgICAgKiBUaGUgZW11bGF0b3IgZG9lc24ndCBpdHNlbGYgdXNlIEFEQ1gvQURPWC9SRFBJ
RC9NT1ZESVIqIG5vciB0aGUgUy9HCisgICAgICogcHJlZmV0Y2ggaW5zbnMsIHNvIHdlIGNh
biBhbHdheXMgcnVuIHRoZSByZXNwZWN0aXZlIHRlc3RzLgogICAgICAqLwogICAgIGlmICgg
bGVhZiA9PSA3ICYmIHN1YmxlYWYgPT0gMCApCiAgICAgewogICAgICAgICByZXMtPmIgfD0g
KDFVIDw8IDEwKSB8ICgxVSA8PCAxOSk7CiAgICAgICAgIGlmICggcmVzLT5iICYgKDFVIDw8
IDE2KSApCiAgICAgICAgICAgICByZXMtPmIgfD0gMVUgPDwgMjY7Ci0gICAgICAgIHJlcy0+
YyB8PSAxVSA8PCAyMjsKKyAgICAgICAgcmVzLT5jIHw9ICgxVSA8PCAyMikgfCAoMVUgPDwg
MjcpIHwgKDFVIDw8IDI4KTsKICAgICB9CiAKICAgICAvKgo=
--------------8EF38295BBE373D460132EDB
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--------------8EF38295BBE373D460132EDB--


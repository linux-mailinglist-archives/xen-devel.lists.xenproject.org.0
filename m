Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 82EE810A5E1
	for <lists+xen-devel@lfdr.de>; Tue, 26 Nov 2019 22:19:41 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iZi9P-0006Bz-I0; Tue, 26 Nov 2019 21:13:35 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=dYem=ZS=dornerworks.com=jeff.kubascik@srs-us1.protection.inumbo.net>)
 id 1iZi9N-0006BS-Nb
 for xen-devel@lists.xenproject.org; Tue, 26 Nov 2019 21:13:33 +0000
X-Inumbo-ID: 990e1d9f-1091-11ea-a3a9-12813bfff9fa
Received: from webmail.dornerworks.com (unknown [12.207.209.150])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTP
 id 990e1d9f-1091-11ea-a3a9-12813bfff9fa;
 Tue, 26 Nov 2019 21:13:32 +0000 (UTC)
From: Jeff Kubascik <jeff.kubascik@dornerworks.com>
To: <xen-devel@lists.xenproject.org>
Date: Tue, 26 Nov 2019 16:13:24 -0500
Message-ID: <20191126211324.122736-1-jeff.kubascik@dornerworks.com>
X-Mailer: git-send-email 2.17.1
MIME-Version: 1.0
X-Originating-IP: [172.27.13.171]
X-ClientProxiedBy: Mcbain.dw.local (172.27.1.45) To Mcbain.dw.local
 (172.27.1.45)
X-spam-status: No, score=-2.9 required=3.5 tests=ALL_TRUSTED, BAYES_00,
 MAILSHELL_SCORE_0_4
X-Spam-Flag: NO
Subject: [Xen-devel] [PATCH v2] xen/arm: remove physical timer offset
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stewart Hildebrand <Stewart.Hildebrand@dornerworks.com>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHBoeXNpY2FsIHRpbWVyIHRyYXBzIGFwcGx5IGFuIG9mZnNldCBzbyB0aGF0IHRpbWUgc3Rh
cnRzIGF0IDAgZm9yCnRoZSBndWVzdC4gSG93ZXZlciwgdGhpcyBvZmZzZXQgaXMgbm90IGN1cnJl
bnRseSBhcHBsaWVkIHRvIHRoZSBwaHlzaWNhbApjb3VudGVyLiBQZXIgdGhlIEFSTXY4IFJlZmVy
ZW5jZSBNYW51YWwgKEFSTSBEREkgMDQ4N0UuYSksIHNlY3Rpb24KRDExLjIuNCBUaW1lcnMsIHRo
ZSAiT2Zmc2V0IiBiZXR3ZWVuIHRoZSBjb3VudGVyIGFuZCB0aW1lciBzaG91bGQgYmUKemVybyBm
b3IgYSBwaHlzaWNhbCB0aW1lci4gVGhpcyByZW1vdmVzIHRoZSBvZmZzZXQgdG8gbWFrZSB0aGUg
dGltZXIgYW5kCmNvdW50ZXIgY29uc2lzdGVudC4KCkZ1cnRoZXJtb3JlLCBzZWN0aW9uIEQxMS4y
LjQgc3BlY2lmaWVzIHRoYXQgdGhlIHZhbHVlcyBpbiB0aGUgVGltZXJWYWx1ZQp2aWV3IG9mIHRo
ZSB0aW1lcnMgYXJlIHNpZ25lZCBpbiBzdGFuZGFyZCB0d28ncyBjb21wbGVtZW50IGZvcm0uIFdo
ZW4Kd3JpdGluZyB0byB0aGUgVGltZXJWYWx1ZSByZWdpc3RlciwgaXQgc2hvdWxkIGJlIHNpZ25l
ZCBleHRlbmRlZCBhcwpkZXNjcmliZWQgYnkgdGhlIGVxdWF0aW9uCgogIENvbXBhcmVWYWx1ZSA9
IChDb3VudGVyWzYzOjBdICsgU2lnbkV4dGVuZChUaW1lclZhbHVlKSlbNjM6MF0KClNpZ25lZC1v
ZmYtYnk6IEplZmYgS3ViYXNjaWsgPGplZmYua3ViYXNjaWtAZG9ybmVyd29ya3MuY29tPgotLS0K
Q2hhbmdlcyBpbiB2MjoKLSBVcGRhdGUgY29tbWl0IG1lc3NhZ2UgdG8gc3BlY2lmeSByZWZlcmVu
Y2UgbWFudWFsIHZlcnNpb24gYW5kIHNlY3Rpb24KLSBDaGFuZ2UgcGh5c2ljYWwgdGltZXIgY3Zh
bCB0byBob2xkIGhhcmR3YXJlIHZhbHVlCi0gTWFrZSBzdXJlIHRvIHNpZ24gZXh0ZW5kIFRpbWVy
VmFsdWUgb24gd3JpdGVzLiBUaGlzIHdhcyBkb25lIGJ5IGZpcnN0CiAgY2FzdGluZyB0aGUgciBw
b2ludGVyIHRvIChpbnQzMl90ICopLCBkZXJlZmVyZW5jaW5nIGl0LCB0aGVuIGNhc3RpbmcKICB0
byB1aW50NjRfdC4gUGxlYXNlIGxldCBtZSBrbm93IGlmIHRoZXJlIGlzIGEgbW9yZSBjb3JyZWN0
IHdheSB0byBkbwogIHRoaXMKLS0tCiB4ZW4vYXJjaC9hcm0vdnRpbWVyLmMgICAgICAgIHwgMjEg
KysrKysrKysrLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20tYXJtL2RvbWFpbi5oIHwgIDMg
LS0tCiAyIGZpbGVzIGNoYW5nZWQsIDkgaW5zZXJ0aW9ucygrKSwgMTUgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL3Z0aW1lci5jIGIveGVuL2FyY2gvYXJtL3Z0aW1lci5j
CmluZGV4IGU2YWViZGFjOWUuLmViMTJhMDhhY2YgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL2FybS92
dGltZXIuYworKysgYi94ZW4vYXJjaC9hcm0vdnRpbWVyLmMKQEAgLTYyLDcgKzYyLDYgQEAgc3Rh
dGljIHZvaWQgdmlydF90aW1lcl9leHBpcmVkKHZvaWQgKmRhdGEpCiAKIGludCBkb21haW5fdnRp
bWVyX2luaXQoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHhlbl9hcmNoX2RvbWFpbmNvbmZpZyAq
Y29uZmlnKQogewotICAgIGQtPmFyY2gucGh5c190aW1lcl9iYXNlLm9mZnNldCA9IE5PVygpOwog
ICAgIGQtPmFyY2gudmlydF90aW1lcl9iYXNlLm9mZnNldCA9IFJFQURfU1lTUkVHNjQoQ05UUENU
X0VMMCk7CiAgICAgZC0+dGltZV9vZmZzZXRfc2Vjb25kcyA9IHRpY2tzX3RvX25zKGQtPmFyY2gu
dmlydF90aW1lcl9iYXNlLm9mZnNldCAtIGJvb3RfY291bnQpOwogICAgIGRvX2RpdihkLT50aW1l
X29mZnNldF9zZWNvbmRzLCAxMDAwMDAwMDAwKTsKQEAgLTE4NSw3ICsxODQsNyBAQCBzdGF0aWMg
Ym9vbCB2dGltZXJfY250cF9jdGwoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MsIHVpbnQzMl90
ICpyLCBib29sIHJlYWQpCiAgICAgICAgIGlmICggdi0+YXJjaC5waHlzX3RpbWVyLmN0bCAmIENO
VHhfQ1RMX0VOQUJMRSApCiAgICAgICAgIHsKICAgICAgICAgICAgIHNldF90aW1lcigmdi0+YXJj
aC5waHlzX3RpbWVyLnRpbWVyLAotICAgICAgICAgICAgICAgICAgICAgIHYtPmFyY2gucGh5c190
aW1lci5jdmFsICsgdi0+ZG9tYWluLT5hcmNoLnBoeXNfdGltZXJfYmFzZS5vZmZzZXQpOworICAg
ICAgICAgICAgICAgICAgICAgIHRpY2tzX3RvX25zKHYtPmFyY2gucGh5c190aW1lci5jdmFsIC0g
Ym9vdF9jb3VudCkpOwogICAgICAgICB9CiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIHN0b3Bf
dGltZXIoJnYtPmFyY2gucGh5c190aW1lci50aW1lcik7CkBAIC0xOTcsMjYgKzE5NiwyNSBAQCBz
dGF0aWMgYm9vbCB2dGltZXJfY250cF90dmFsKHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzLCB1
aW50MzJfdCAqciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCByZWFkKQogewog
ICAgIHN0cnVjdCB2Y3B1ICp2ID0gY3VycmVudDsKLSAgICBzX3RpbWVfdCBub3c7CisgICAgdWlu
dDY0X3QgY250cGN0OwogCiAgICAgaWYgKCAhQUNDRVNTX0FMTE9XRUQocmVncywgRUwwUFRFTikg
KQogICAgICAgICByZXR1cm4gZmFsc2U7CiAKLSAgICBub3cgPSBOT1coKSAtIHYtPmRvbWFpbi0+
YXJjaC5waHlzX3RpbWVyX2Jhc2Uub2Zmc2V0OworICAgIGNudHBjdCA9IGdldF9jeWNsZXMoKTsK
IAogICAgIGlmICggcmVhZCApCiAgICAgewotICAgICAgICAqciA9ICh1aW50MzJfdCkobnNfdG9f
dGlja3Modi0+YXJjaC5waHlzX3RpbWVyLmN2YWwgLSBub3cpICYgMHhmZmZmZmZmZnVsbCk7Cisg
ICAgICAgICpyID0gKHVpbnQzMl90KSgodi0+YXJjaC5waHlzX3RpbWVyLmN2YWwgLSBjbnRwY3Qp
ICYgMHhmZmZmZmZmZnVsbCk7CiAgICAgfQogICAgIGVsc2UKICAgICB7Ci0gICAgICAgIHYtPmFy
Y2gucGh5c190aW1lci5jdmFsID0gbm93ICsgdGlja3NfdG9fbnMoKnIpOworICAgICAgICB2LT5h
cmNoLnBoeXNfdGltZXIuY3ZhbCA9IGNudHBjdCArICh1aW50NjRfdCkoKigoaW50MzJfdCAqKXIp
KTsKICAgICAgICAgaWYgKCB2LT5hcmNoLnBoeXNfdGltZXIuY3RsICYgQ05UeF9DVExfRU5BQkxF
ICkKICAgICAgICAgewogICAgICAgICAgICAgdi0+YXJjaC5waHlzX3RpbWVyLmN0bCAmPSB+Q05U
eF9DVExfUEVORElORzsKICAgICAgICAgICAgIHNldF90aW1lcigmdi0+YXJjaC5waHlzX3RpbWVy
LnRpbWVyLAotICAgICAgICAgICAgICAgICAgICAgIHYtPmFyY2gucGh5c190aW1lci5jdmFsICsK
LSAgICAgICAgICAgICAgICAgICAgICB2LT5kb21haW4tPmFyY2gucGh5c190aW1lcl9iYXNlLm9m
ZnNldCk7CisgICAgICAgICAgICAgICAgICAgICAgdGlja3NfdG9fbnModi0+YXJjaC5waHlzX3Rp
bWVyLmN2YWwgLSBib290X2NvdW50KSk7CiAgICAgICAgIH0KICAgICB9CiAgICAgcmV0dXJuIHRy
dWU7CkBAIC0yMzIsMTcgKzIzMCwxNiBAQCBzdGF0aWMgYm9vbCB2dGltZXJfY250cF9jdmFsKHN0
cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzLCB1aW50NjRfdCAqciwKIAogICAgIGlmICggcmVhZCAp
CiAgICAgewotICAgICAgICAqciA9IG5zX3RvX3RpY2tzKHYtPmFyY2gucGh5c190aW1lci5jdmFs
KTsKKyAgICAgICAgKnIgPSB2LT5hcmNoLnBoeXNfdGltZXIuY3ZhbDsKICAgICB9CiAgICAgZWxz
ZQogICAgIHsKLSAgICAgICAgdi0+YXJjaC5waHlzX3RpbWVyLmN2YWwgPSB0aWNrc190b19ucygq
cik7CisgICAgICAgIHYtPmFyY2gucGh5c190aW1lci5jdmFsID0gKnI7CiAgICAgICAgIGlmICgg
di0+YXJjaC5waHlzX3RpbWVyLmN0bCAmIENOVHhfQ1RMX0VOQUJMRSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHYtPmFyY2gucGh5c190aW1lci5jdGwgJj0gfkNOVHhfQ1RMX1BFTkRJTkc7CiAg
ICAgICAgICAgICBzZXRfdGltZXIoJnYtPmFyY2gucGh5c190aW1lci50aW1lciwKLSAgICAgICAg
ICAgICAgICAgICAgICB2LT5hcmNoLnBoeXNfdGltZXIuY3ZhbCArCi0gICAgICAgICAgICAgICAg
ICAgICAgdi0+ZG9tYWluLT5hcmNoLnBoeXNfdGltZXJfYmFzZS5vZmZzZXQpOworICAgICAgICAg
ICAgICAgICAgICAgIHRpY2tzX3RvX25zKHYtPmFyY2gucGh5c190aW1lci5jdmFsIC0gYm9vdF9j
b3VudCkpOwogICAgICAgICB9CiAgICAgfQogICAgIHJldHVybiB0cnVlOwpkaWZmIC0tZ2l0IGEv
eGVuL2luY2x1ZGUvYXNtLWFybS9kb21haW4uaCBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vZG9tYWlu
LmgKaW5kZXggODZlYmRkMmJjZi4uMTZhNzE1MGE5NSAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUv
YXNtLWFybS9kb21haW4uaAorKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL2RvbWFpbi5oCkBAIC02
NSw5ICs2NSw2IEBAIHN0cnVjdCBhcmNoX2RvbWFpbgogICAgICAgICBSRUxNRU1fZG9uZSwKICAg
ICB9IHJlbG1lbTsKIAotICAgIHN0cnVjdCB7Ci0gICAgICAgIHVpbnQ2NF90IG9mZnNldDsKLSAg
ICB9IHBoeXNfdGltZXJfYmFzZTsKICAgICBzdHJ1Y3QgewogICAgICAgICB1aW50NjRfdCBvZmZz
ZXQ7CiAgICAgfSB2aXJ0X3RpbWVyX2Jhc2U7Ci0tIAoyLjE3LjEKCgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhl
bi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3Jn
L21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

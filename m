Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 2EC20274369
	for <lists+xen-devel@lfdr.de>; Tue, 22 Sep 2020 15:41:56 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1kKiXs-0004LK-HJ; Tue, 22 Sep 2020 13:41:24 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=pzSo=C7=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1kKiVj-0001gf-Ae
 for xen-devel@lists.xen.org; Tue, 22 Sep 2020 13:39:11 +0000
X-Inumbo-ID: 4fd9d5fa-9601-44b8-90f3-58d22c4288c0
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 4fd9d5fa-9601-44b8-90f3-58d22c4288c0;
 Tue, 22 Sep 2020 13:37:25 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
 s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
 Content-Transfer-Encoding:Content-Type;
 bh=cv2cHzbgE+rQHxKKk/YQTNnukmQ/m7QjE3hTDURZxQ4=; b=sWnakAPhotP6CQyg6WcvAlsyK0
 uRTsB/EOc2cuQ+74bzqn6otvzGW7r5KnBRX6/Os92rIzS1FJTODCB/Pruhqo8K8lhXUm4uWQrUp04
 PrgTeUpUvF6016/XLFDWovMWMJgmUclYg+fJ3hpCE4a5gOTAJmAEdzJHddxIawRxDsE8=;
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1kKiTv-0006qb-NZ; Tue, 22 Sep 2020 13:37:19 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1kKiTv-0002PV-Mj; Tue, 22 Sep 2020 13:37:19 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 344 v4 (CVE-2020-25601) - lack of
 preemption in evtchn_reset() / evtchn_destroy()
Message-Id: <E1kKiTv-0002PV-Mj@xenbits.xenproject.org>
Date: Tue, 22 Sep 2020 13:37:19 +0000
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2020-25601 / XSA-344
                               version 4

        lack of preemption in evtchn_reset() / evtchn_destroy()

UPDATES IN VERSION 4
====================

Public release.

ISSUE DESCRIPTION
=================

In particular the FIFO event channel model allows guests to have a large
number of event channels active at a time.  Closing all of these when
resetting all event channels or when cleaning up after the guest may
take extended periods of time.  So far there was no arrangement for
preemption at suitable intervals, allowing a CPU to spend an almost
unbounded amount of time in the processing of these operations.

IMPACT
======

Malicious or buggy guest kernels can mount a Denial of Service (DoS)
attack affecting the entire system.

VULNERABLE SYSTEMS
==================

All Xen versions are vulnerable in principle.  Whether versions 4.3
and older are vulnerable depends on underlying hardware characteristics.

MITIGATION
==========

The problem can be avoided by reducing the number of event channels
available to all guests to a suitably low limit.  For example, setting
"max_event_channels=256" in the xl domain configurations may be low
enough for all hardware Xen is able to run on.

CREDITS
=======

This issue was discovered by Jan Beulich of SUSE.

RESOLUTION
==========

Applying the appropriate set of attached patches resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa344/xsa344-?.patch           Xen 4.14 - xen-unstable
xsa344/xsa344-4.13-?.patch      Xen 4.13
xsa344/xsa344-4.12-?.patch      Xen 4.12
xsa344/xsa344-4.11-?.patch      Xen 4.11
xsa344/xsa344-4.10-?.patch      Xen 4.10

$ sha256sum xsa344* xsa344*/*
74ae97a618a3680920bed131e69656d5a7c039efbbec99b55b99af772e3e87df  xsa344.meta
5f9dbdc48bed502d614a76e5819afa41a72cec603c5a2c9491d73873a991a5ed  xsa344/xsa344-1.patch
381ca5c51bc120bfd5c742be3988f570abb870c4b75c8a48cf49ae4fa1046d73  xsa344/xsa344-2.patch
b52e4ecd6db8c3c6ebc0ab6facbd0f4fa0859657d13491819c3279fe439f66ec  xsa344/xsa344-4.10-1.patch
53ca9c954fd73344968f40689b0d0ea583bd19ece72166fd2d4eaa125b82f26f  xsa344/xsa344-4.10-2.patch
7abea30b406b0a572f7cd76bd9768d12262344a8e255ddd29d2ad893724638a0  xsa344/xsa344-4.11-1.patch
f2b39146ac410154043efd09880277e4e821a1dd47a0bd3000545e5568253b97  xsa344/xsa344-4.11-2.patch
a654c99f5d1c25d9d12ba267d2db10b0a1e0da337ce334fb5aafa6b2061ebc3c  xsa344/xsa344-4.12-1.patch
6af4e05f8536b11a3dc4c70620b8ed973ecf09efd4c64eb500f6363d5f0402e7  xsa344/xsa344-4.12-2.patch
9b81c7cf3cd33f9d43c43222a0434a8d4e0acff74f339a6842f16bfa2f304cb5  xsa344/xsa344-4.13-1.patch
80a41b7e08cdb54a28dfc82630a0d8d89fc25e381bc4505ed41017a760addf09  xsa344/xsa344-4.13-2.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAl9p/egMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZ114H/2QrxpADKwxDb2+aL8fhf46AJYwgxDa8SoI18INd
IVeHs8Lq4CQsfSFxBbXOWDGo82bUg43kwcdZ3ToSaX2JSC4R3r0us6tSdaRIqpNj
sQo56ozFXH63v4zTlB8gF58skm2n+CZQ5nKccnTUsN7KuqfPWm/2LfBnqnHYkYQ9
CVHBG5YXMnrHbASo+HglGqjgu6GyEsLoJpSQEj6oYF/UW86OYeAwZ2TFAFVZ/T04
XtxnH7aYCSMOeQRPU6BnCdoVKg/wn4ilSKyqYAin8uNFf7af3OSSCR4FTYkLX+VG
WYJnc27SUAb28+l9f65r8cwzs2+O5SlqhpqyS6xcM3A1248=
=UYAk
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa344.meta"
Content-Disposition: attachment; filename="xsa344.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAzNDQsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xNCIsCiAgICAiNC4xMyIsCiAgICAiNC4xMiIs
CiAgICAiNC4xMSIsCiAgICAiNC4xMCIKICBdLAogICJUcmVlcyI6IFsKICAg
ICJ4ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICI5M2JlOTQzZTdkNzU5MDE1YmQ1ZGI0MWE0OGY2ZGNlNThl
NTgwZDVhIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAz
MzYsCiAgICAgICAgICAgIDMzNywKICAgICAgICAgICAgMzM4LAogICAgICAg
ICAgICAzMzksCiAgICAgICAgICAgIDM0MCwKICAgICAgICAgICAgMzQyLAog
ICAgICAgICAgICAzNDMKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hl
cyI6IFsKICAgICAgICAgICAgInhzYTM0NC94c2EzNDQtNC4xMC0/LnBhdGNo
IgogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0
LjExIjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewog
ICAgICAgICAgIlN0YWJsZVJlZiI6ICJkZGFhY2NiYmFiNmIxOWJmMjFlZDJj
MDk3ZjMwNTVhM2MyNTQ0YzhkIiwKICAgICAgICAgICJQcmVyZXFzIjogWwog
ICAgICAgICAgICAzMzMsCiAgICAgICAgICAgIDMzNiwKICAgICAgICAgICAg
MzM3LAogICAgICAgICAgICAzMzgsCiAgICAgICAgICAgIDMzOSwKICAgICAg
ICAgICAgMzQwLAogICAgICAgICAgICAzNDIsCiAgICAgICAgICAgIDM0Mwog
ICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAg
ICAieHNhMzQ0L3hzYTM0NC00LjExLT8ucGF0Y2giCiAgICAgICAgICBdCiAg
ICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTIiOiB7CiAgICAgICJS
ZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAiU3RhYmxl
UmVmIjogIjEzMzZjYTE3NzQyNDcxZmM0YTU5ODc5YWUyZjYzN2E1OTUzMGE5
MzMiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAgIDMzMywK
ICAgICAgICAgICAgMzM0LAogICAgICAgICAgICAzMzYsCiAgICAgICAgICAg
IDMzNywKICAgICAgICAgICAgMzM4LAogICAgICAgICAgICAzMzksCiAgICAg
ICAgICAgIDM0MCwKICAgICAgICAgICAgMzQyLAogICAgICAgICAgICAzNDMK
ICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAg
ICAgInhzYTM0NC94c2EzNDQtNC4xMi0/LnBhdGNoIgogICAgICAgICAgXQog
ICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjEzIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICI5YjM2N2IyYjBiNzE0ZjNmZmI2OWVkNmJlMGExMThlOGQzZWFj
MDdmIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAzMzMs
CiAgICAgICAgICAgIDMzNCwKICAgICAgICAgICAgMzM2LAogICAgICAgICAg
ICAzMzcsCiAgICAgICAgICAgIDMzOCwKICAgICAgICAgICAgMzM5LAogICAg
ICAgICAgICAzNDAsCiAgICAgICAgICAgIDM0MiwKICAgICAgICAgICAgMzQz
CiAgICAgICAgICBdLAogICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAg
ICAgICJ4c2EzNDQveHNhMzQ0LTQuMTMtPy5wYXRjaCIKICAgICAgICAgIF0K
ICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAiNC4xNCI6IHsKICAgICAg
IlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFi
bGVSZWYiOiAiYzNhMGZjMjJhZjkwZWYyOGU2OGIxMTZjNmE0OWQ5Y2VjNTdm
NzFjZiIsCiAgICAgICAgICAiUHJlcmVxcyI6IFsKICAgICAgICAgICAgMzMz
LAogICAgICAgICAgICAzMzQsCiAgICAgICAgICAgIDMzNiwKICAgICAgICAg
ICAgMzM3LAogICAgICAgICAgICAzMzgsCiAgICAgICAgICAgIDMzOSwKICAg
ICAgICAgICAgMzQwLAogICAgICAgICAgICAzNDIsCiAgICAgICAgICAgIDM0
MwogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAgICAg
ICAgICAieHNhMzQ0L3hzYTM0NC0/LnBhdGNoIgogICAgICAgICAgXQogICAg
ICAgIH0KICAgICAgfQogICAgfSwKICAgICJtYXN0ZXIiOiB7CiAgICAgICJS
ZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAiU3RhYmxl
UmVmIjogImIxMTkxMDA4MmQ5MGJiMTU5N2Y2Njc5NTI0ZWI3MjZhMzMzMDY2
NzIiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAgIDMzMywK
ICAgICAgICAgICAgMzM0LAogICAgICAgICAgICAzMzYsCiAgICAgICAgICAg
IDMzNywKICAgICAgICAgICAgMzM4LAogICAgICAgICAgICAzMzksCiAgICAg
ICAgICAgIDM0MCwKICAgICAgICAgICAgMzQyLAogICAgICAgICAgICAzNDMK
ICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAg
ICAgInhzYTM0NC94c2EzNDQtPy5wYXRjaCIKICAgICAgICAgIF0KICAgICAg
ICB9CiAgICAgIH0KICAgIH0KICB9Cn0=

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-1.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX2Rl
c3Ryb3koKQoKRXNwZWNpYWxseSBjbG9zaW5nIG9mIGZ1bGx5IGVzdGFibGlz
aGVkIGludGVyZG9tYWluIGNoYW5uZWxzIGNhbiB0YWtlCnF1aXRlIHNvbWUg
dGltZSwgZHVlIHRvIHRoZSBsb2NraW5nIGludm9sdmVkLiBUaGVyZWZvcmUg
d2Ugc2hvdWxkbid0CmFzc3VtZSB3ZSBjYW4gY2xlYW4gdXAgc3RpbGwgYWN0
aXZlIHBvcnRzIGFsbCBpbiBvbmUgZ28uIEJlc2lkZXMgYWRkaW5nCnRoZSBu
ZWNlc3NhcnkgcHJlZW1wdGlvbiBjaGVjaywgYWxzbyBhdm9pZCBwb2ludGxl
c3NseSBzdGFydGluZyBmcm9tCihvciBub3cgcmVhbGx5IGVuZGluZyBhdCkg
MDsgMSBpcyB0aGUgbG93ZXN0IG51bWJlcmVkIHBvcnQgd2hpY2ggbWF5Cm5l
ZWQgY2xvc2luZy4KClNpbmNlIHdlJ3JlIG5vdyByZWR1Y2luZyAtPnZhbGlk
X2V2dGNobnMsIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoKSwKYW5kIChhdCBs
ZWFzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlKSBub3RpZnlfdmlhX3hlbl9l
dmVudF9jaGFubmVsKCkKbmVlZCB0byBjb3BlIHdpdGggYXR0ZW1wdHMgdG8g
Y2xvc2UgLyB1bmJpbmQgZnJvbSAvIHNlbmQgdGhyb3VnaCBhbHJlYWR5CmNs
b3NlZCAoYW5kIG5vIGxvbmdlciB2YWxpZCwgYXMgcGVyIHBvcnRfaXNfdmFs
aWQoKSkgcG9ydHMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NC4KClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQWNr
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmll
d2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5l
bC5vcmc+Ci0tLQp2ODogRHJvcCAtPmFjdGl2ZS0+ZXZ0Y2hucyBwYXJ0IG9m
IG1haW4gbG9vcCBjb25kaXRpb24uIERyb3AgQlVHX09OKCkKICAgIGNvbnZl
cnNpb24gaW4gZXZ0Y2huX2Nsb3NlKCkuCnY3OiBDb21tZW50IHRoZSBiYXJy
aWVycyBhZGRlZCBpbiB2Ni4KdjY6IEFkZCBiYXJyaWVycyBhaGVhZCBvZiBu
ZXcgLT5pc19keWluZyBjaGVja3MuCnY1OiBBbHNvIGFkanVzdCBCVUdfT04o
KSBpbiBldnRjaG5fY2xvc2UoKS4KdjQ6IE5ldy4KCi0tLSBhL3hlbi9jb21t
b24vZG9tYWluLmMKKysrIGIveGVuL2NvbW1vbi9kb21haW4uYwpAQCAtNzE1
LDEyICs3MTUsMTQgQEAgaW50IGRvbWFpbl9raWxsKHN0cnVjdCBkb21haW4g
KmQpCiAgICAgICAgICAgICByZXR1cm4gZG9tYWluX2tpbGwoZCk7CiAgICAg
ICAgIGQtPmlzX2R5aW5nID0gRE9NRFlJTkdfZHlpbmc7CiAgICAgICAgIGFy
Z29fZGVzdHJveShkKTsKLSAgICAgICAgZXZ0Y2huX2Rlc3Ryb3koZCk7CiAg
ICAgICAgIGdudHRhYl9yZWxlYXNlX21hcHBpbmdzKGQpOwogICAgICAgICB2
bnVtYV9kZXN0cm95KGQtPnZudW1hKTsKICAgICAgICAgZG9tYWluX3NldF9v
dXRzdGFuZGluZ19wYWdlcyhkLCAwKTsKICAgICAgICAgLyogZmFsbHRocm91
Z2ggKi8KICAgICBjYXNlIERPTURZSU5HX2R5aW5nOgorICAgICAgICByYyA9
IGV2dGNobl9kZXN0cm95KGQpOworICAgICAgICBpZiAoIHJjICkKKyAgICAg
ICAgICAgIGJyZWFrOwogICAgICAgICByYyA9IGRvbWFpbl9yZWxpbnF1aXNo
X3Jlc291cmNlcyhkKTsKICAgICAgICAgaWYgKCByYyAhPSAwICkKICAgICAg
ICAgICAgIGJyZWFrOwotLS0gYS94ZW4vY29tbW9uL2V2ZW50X2NoYW5uZWwu
YworKysgYi94ZW4vY29tbW9uL2V2ZW50X2NoYW5uZWwuYwpAQCAtMTI5Nyw3
ICsxMjk3LDE2IEBAIGludCBhbGxvY191bmJvdW5kX3hlbl9ldmVudF9jaGFu
bmVsKAogCiB2b2lkIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoc3RydWN0IGRv
bWFpbiAqZCwgaW50IHBvcnQpCiB7Ci0gICAgQlVHX09OKCFwb3J0X2lzX3Zh
bGlkKGQsIHBvcnQpKTsKKyAgICBpZiAoICFwb3J0X2lzX3ZhbGlkKGQsIHBv
cnQpICkKKyAgICB7CisgICAgICAgIC8qCisgICAgICAgICAqIE1ha2Ugc3Vy
ZSAtPmlzX2R5aW5nIGlzIHJlYWQgL2FmdGVyLyAtPnZhbGlkX2V2dGNobnMs
IHBhaXJpbmcKKyAgICAgICAgICogd2l0aCB0aGUgc3Bpbl9iYXJyaWVyKCkg
YW5kIEJVR19PTigpIGluIGV2dGNobl9kZXN0cm95KCkuCisgICAgICAgICAq
LworICAgICAgICBzbXBfcm1iKCk7CisgICAgICAgIEJVR19PTighZC0+aXNf
ZHlpbmcpOworICAgICAgICByZXR1cm47CisgICAgfQogCiAgICAgZXZ0Y2hu
X2Nsb3NlKGQsIHBvcnQsIDApOwogfQpAQCAtMTMwOSw3ICsxMzE4LDE3IEBA
IHZvaWQgbm90aWZ5X3ZpYV94ZW5fZXZlbnRfY2hhbm5lbChzdHJ1Y3QKICAg
ICBzdHJ1Y3QgZG9tYWluICpyZDsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdz
OwogCi0gICAgQVNTRVJUKHBvcnRfaXNfdmFsaWQobGQsIGxwb3J0KSk7Cisg
ICAgaWYgKCAhcG9ydF9pc192YWxpZChsZCwgbHBvcnQpICkKKyAgICB7Cisg
ICAgICAgIC8qCisgICAgICAgICAqIE1ha2Ugc3VyZSAtPmlzX2R5aW5nIGlz
IHJlYWQgL2FmdGVyLyAtPnZhbGlkX2V2dGNobnMsIHBhaXJpbmcKKyAgICAg
ICAgICogd2l0aCB0aGUgc3Bpbl9iYXJyaWVyKCkgYW5kIEJVR19PTigpIGlu
IGV2dGNobl9kZXN0cm95KCkuCisgICAgICAgICAqLworICAgICAgICBzbXBf
cm1iKCk7CisgICAgICAgIEFTU0VSVChsZC0+aXNfZHlpbmcpOworICAgICAg
ICByZXR1cm47CisgICAgfQorCiAgICAgbGNobiA9IGV2dGNobl9mcm9tX3Bv
cnQobGQsIGxwb3J0KTsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZsY2hu
LT5sb2NrLCBmbGFncyk7CkBAIC0xMzgwLDggKzEzOTksNyBAQCBpbnQgZXZ0
Y2huX2luaXQoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduCiAgICAgcmV0dXJu
IDA7CiB9CiAKLQotdm9pZCBldnRjaG5fZGVzdHJveShzdHJ1Y3QgZG9tYWlu
ICpkKQoraW50IGV2dGNobl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQpCiB7
CiAgICAgdW5zaWduZWQgaW50IGk7CiAKQEAgLTEzOTAsMTQgKzE0MDgsMjkg
QEAgdm9pZCBldnRjaG5fZGVzdHJveShzdHJ1Y3QgZG9tYWluICpkKQogICAg
IHNwaW5fYmFycmllcigmZC0+ZXZlbnRfbG9jayk7CiAKICAgICAvKiBDbG9z
ZSBhbGwgZXhpc3RpbmcgZXZlbnQgY2hhbm5lbHMuICovCi0gICAgZm9yICgg
aSA9IDA7IHBvcnRfaXNfdmFsaWQoZCwgaSk7IGkrKyApCisgICAgZm9yICgg
aSA9IGQtPnZhbGlkX2V2dGNobnM7IC0taTsgKQorICAgIHsKICAgICAgICAg
ZXZ0Y2huX2Nsb3NlKGQsIGksIDApOwogCisgICAgICAgIC8qCisgICAgICAg
ICAqIEF2b2lkIHByZWVtcHRpbmcgd2hlbiBjYWxsZWQgZnJvbSBkb21haW5f
Y3JlYXRlKCkncyBlcnJvciBwYXRoLAorICAgICAgICAgKiBhbmQgZG9uJ3Qg
Y2hlY2sgdG9vIG9mdGVuIChjaG9pY2Ugb2YgZnJlcXVlbmN5IGlzIGFyYml0
cmFyeSkuCisgICAgICAgICAqLworICAgICAgICBpZiAoIGkgJiYgIShpICYg
MHgzZikgJiYgZC0+aXNfZHlpbmcgIT0gRE9NRFlJTkdfZGVhZCAmJgorICAg
ICAgICAgICAgIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQorICAgICAg
ICB7CisgICAgICAgICAgICB3cml0ZV9hdG9taWMoJmQtPnZhbGlkX2V2dGNo
bnMsIGkpOworICAgICAgICAgICAgcmV0dXJuIC1FUkVTVEFSVDsKKyAgICAg
ICAgfQorICAgIH0KKwogICAgIEFTU0VSVCghZC0+YWN0aXZlX2V2dGNobnMp
OwogCiAgICAgY2xlYXJfZ2xvYmFsX3ZpcnFfaGFuZGxlcnMoZCk7CiAKICAg
ICBldnRjaG5fZmlmb19kZXN0cm95KGQpOworCisgICAgcmV0dXJuIDA7CiB9
CiAKIAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaAorKysgYi94ZW4v
aW5jbHVkZS94ZW4vc2NoZWQuaApAQCAtMTM4LDcgKzEzOCw3IEBAIHN0cnVj
dCBldnRjaG4KIH0gX19hdHRyaWJ1dGVfXygoYWxpZ25lZCg2NCkpKTsKIAog
aW50ICBldnRjaG5faW5pdChzdHJ1Y3QgZG9tYWluICpkLCB1bnNpZ25lZCBp
bnQgbWF4X3BvcnQpOwotdm9pZCBldnRjaG5fZGVzdHJveShzdHJ1Y3QgZG9t
YWluICpkKTsgLyogZnJvbSBkb21haW5fa2lsbCAqLworaW50ICBldnRjaG5f
ZGVzdHJveShzdHJ1Y3QgZG9tYWluICpkKTsgLyogZnJvbSBkb21haW5fa2ls
bCAqLwogdm9pZCBldnRjaG5fZGVzdHJveV9maW5hbChzdHJ1Y3QgZG9tYWlu
ICpkKTsgLyogZnJvbSBjb21wbGV0ZV9kb21haW5fZGVzdHJveSAqLwogCiBz
dHJ1Y3Qgd2FpdHF1ZXVlX3ZjcHU7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-2.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX3Jl
c2V0KCkKCkxpa2UgZm9yIGV2dGNobl9kZXN0cm95KCkgbG9vcGluZyBvdmVy
IGFsbCBwb3NzaWJsZSBldmVudCBjaGFubmVscyB0bwpjbG9zZSB0aGVtIGNh
biB0YWtlIGEgc2lnbmlmaWNhbnQgYW1vdW50IG9mIHRpbWUuIFVubGlrZSBk
b25lIHRoZXJlLCB3ZQpjYW4ndCBhbHRlciBkb21haW4gcHJvcGVydGllcyAo
aS5lLiBkLT52YWxpZF9ldnRjaG5zKSBoZXJlLiBCb3Jyb3csIGluIGEKbGln
aHR3ZWlnaHQgZm9ybSwgdGhlIHBhZ2luZyBkb21jdGwgY29udGludWF0aW9u
IGNvbmNlcHQsIHJlZGlyZWN0aW5nCnRoZSBjb250aW51YXRpb25zIHRvIGRp
ZmZlcmVudCBzdWItb3BzLiBKdXN0IGxpa2UgdGhlcmUgdGhpcyBpcyB0byBi
ZQphYmxlIHRvIGFsbG93IGZvciBwcmVkaWN0YWJsZSBvdmVyYWxsIHJlc3Vs
dHMgb2YgdGhlIGludm9sdmVkIHN1Yi1vcHM6ClJhY2luZyByZXF1ZXN0cyBz
aG91bGQgZWl0aGVyIGNvbXBsZXRlIG9yIGJlIHJlZnVzZWQuCgpOb3RlIHRo
YXQgYSBkb21haW4gY2FuJ3QgaW50ZXJmZXJlIHdpdGggYW4gYWxyZWFkeSBz
dGFydGVkIChieSBhIHJlbW90ZQpkb21haW4pIHJlc2V0LCBkdWUgdG8gYmVp
bmcgcGF1c2VkLiBJdCBjYW4gcHJldmVudCBhIHJlbW90ZSByZXNldCBmcm9t
CmhhcHBlbmluZyBieSBsZWF2aW5nIGEgcmVzZXQgdW5maW5pc2hlZCwgYnV0
IHRoYXQncyBvbmx5IGdvaW5nIHRvIGFmZmVjdAppdHNlbGYuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNo
IDxqYmV1bGljaEBzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJl
bGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+Ci0tLQp2OTogVW5kbyB2
NyBjaGFuZ2VzLgp2NzogTW92ZSBleHRlbnNpb24gb2YgbG9vcCBjb25kaXRp
b24gaW4gZXZ0Y2huX3Jlc2V0KCkgaGVyZSwgdG8gbWF0Y2gKICAgIHRoZSBl
YXJsaWVyIHBhdGNoJ2VzIGNoYW5nZSB0byBldnRjaG5fZGVzdHJveSgpLgp2
NjogQWxzbyBwcm90ZWN0IHRoZSBsYXN0IHdyaXRlIG9mIGQtPm5leHRfZXZ0
Y2huLiBSZS1iYXNlIG92ZXIgY2hhbmdlcwogICAgdG8gZWFybGllciBwYXRj
aGVzLgp2NDogTmV3LgoKLS0tIGEveGVuL2NvbW1vbi9kb21haW4uYworKysg
Yi94ZW4vY29tbW9uL2RvbWFpbi5jCkBAIC0xMTQ1LDcgKzExNDUsNyBAQCB2
b2lkIGRvbWFpbl91bnBhdXNlX2V4Y2VwdF9zZWxmKHN0cnVjdCBkCiAgICAg
ICAgIGRvbWFpbl91bnBhdXNlKGQpOwogfQogCi1pbnQgZG9tYWluX3NvZnRf
cmVzZXQoc3RydWN0IGRvbWFpbiAqZCkKK2ludCBkb21haW5fc29mdF9yZXNl
dChzdHJ1Y3QgZG9tYWluICpkLCBib29sIHJlc3VtaW5nKQogewogICAgIHN0
cnVjdCB2Y3B1ICp2OwogICAgIGludCByYzsKQEAgLTExNTksNyArMTE1OSw3
IEBAIGludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQog
ICAgICAgICB9CiAgICAgc3Bpbl91bmxvY2soJmQtPnNodXRkb3duX2xvY2sp
OwogCi0gICAgcmMgPSBldnRjaG5fcmVzZXQoZCk7CisgICAgcmMgPSBldnRj
aG5fcmVzZXQoZCwgcmVzdW1pbmcpOwogICAgIGlmICggcmMgKQogICAgICAg
ICByZXR1cm4gcmM7CiAKLS0tIGEveGVuL2NvbW1vbi9kb21jdGwuYworKysg
Yi94ZW4vY29tbW9uL2RvbWN0bC5jCkBAIC00NzcsMTIgKzQ3NywyMiBAQCBs
b25nIGRvX2RvbWN0bChYRU5fR1VFU1RfSEFORExFX1BBUkFNKHhlCiAgICAg
fQogCiAgICAgY2FzZSBYRU5fRE9NQ1RMX3NvZnRfcmVzZXQ6CisgICAgY2Fz
ZSBYRU5fRE9NQ1RMX3NvZnRfcmVzZXRfY29udDoKICAgICAgICAgaWYgKCBk
ID09IGN1cnJlbnQtPmRvbWFpbiApIC8qIG5vIGRvbWFpbl9wYXVzZSgpICov
CiAgICAgICAgIHsKICAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7CiAgICAg
ICAgICAgICBicmVhazsKICAgICAgICAgfQotICAgICAgICByZXQgPSBkb21h
aW5fc29mdF9yZXNldChkKTsKKyAgICAgICAgcmV0ID0gZG9tYWluX3NvZnRf
cmVzZXQoZCwgb3AtPmNtZCA9PSBYRU5fRE9NQ1RMX3NvZnRfcmVzZXRfY29u
dCk7CisgICAgICAgIGlmICggcmV0ID09IC1FUkVTVEFSVCApCisgICAgICAg
IHsKKyAgICAgICAgICAgIG9wLT5jbWQgPSBYRU5fRE9NQ1RMX3NvZnRfcmVz
ZXRfY29udDsKKyAgICAgICAgICAgIGlmICggIV9fY29weV9maWVsZF90b19n
dWVzdCh1X2RvbWN0bCwgb3AsIGNtZCkgKQorICAgICAgICAgICAgICAgIHJl
dCA9IGh5cGVyY2FsbF9jcmVhdGVfY29udGludWF0aW9uKF9fSFlQRVJWSVNP
Ul9kb21jdGwsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgImgiLCB1X2RvbWN0bCk7CisgICAgICAgICAg
ICBlbHNlCisgICAgICAgICAgICAgICAgcmV0ID0gLUVGQVVMVDsKKyAgICAg
ICAgfQogICAgICAgICBicmVhazsKIAogICAgIGNhc2UgWEVOX0RPTUNUTF9k
ZXN0cm95ZG9tYWluOgotLS0gYS94ZW4vY29tbW9uL2V2ZW50X2NoYW5uZWwu
YworKysgYi94ZW4vY29tbW9uL2V2ZW50X2NoYW5uZWwuYwpAQCAtMTA1Nyw3
ICsxMDU3LDcgQEAgaW50IGV2dGNobl91bm1hc2sodW5zaWduZWQgaW50IHBv
cnQpCiAgICAgcmV0dXJuIDA7CiB9CiAKLWludCBldnRjaG5fcmVzZXQoc3Ry
dWN0IGRvbWFpbiAqZCkKK2ludCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFp
biAqZCwgYm9vbCByZXN1bWluZykKIHsKICAgICB1bnNpZ25lZCBpbnQgaTsK
ICAgICBpbnQgcmMgPSAwOwpAQCAtMTA2NSwxMSArMTA2NSw0MCBAQCBpbnQg
ZXZ0Y2huX3Jlc2V0KHN0cnVjdCBkb21haW4gKmQpCiAgICAgaWYgKCBkICE9
IGN1cnJlbnQtPmRvbWFpbiAmJiAhZC0+Y29udHJvbGxlcl9wYXVzZV9jb3Vu
dCApCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCi0gICAgZm9yICggaSA9
IDA7IHBvcnRfaXNfdmFsaWQoZCwgaSk7IGkrKyApCisgICAgc3Bpbl9sb2Nr
KCZkLT5ldmVudF9sb2NrKTsKKworICAgIC8qCisgICAgICogSWYgd2UgYXJl
IHJlc3VtaW5nLCB0aGVuIHN0YXJ0IHdoZXJlIHdlIHN0b3BwZWQuIE90aGVy
d2lzZSwgY2hlY2sKKyAgICAgKiB0aGF0IGEgcmVzZXQgb3BlcmF0aW9uIGlz
IG5vdCBhbHJlYWR5IGluIHByb2dyZXNzLCBhbmQgaWYgbm9uZSBpcywKKyAg
ICAgKiByZWNvcmQgdGhhdCB0aGlzIGlzIG5vdyB0aGUgY2FzZS4KKyAgICAg
Ki8KKyAgICBpID0gcmVzdW1pbmcgPyBkLT5uZXh0X2V2dGNobiA6ICFkLT5u
ZXh0X2V2dGNobjsKKyAgICBpZiAoIGkgPiBkLT5uZXh0X2V2dGNobiApCisg
ICAgICAgIGQtPm5leHRfZXZ0Y2huID0gaTsKKworICAgIHNwaW5fdW5sb2Nr
KCZkLT5ldmVudF9sb2NrKTsKKworICAgIGlmICggIWkgKQorICAgICAgICBy
ZXR1cm4gLUVCVVNZOworCisgICAgZm9yICggOyBwb3J0X2lzX3ZhbGlkKGQs
IGkpOyBpKysgKQorICAgIHsKICAgICAgICAgZXZ0Y2huX2Nsb3NlKGQsIGks
IDEpOwogCisgICAgICAgIC8qIE5COiBDaG9pY2Ugb2YgZnJlcXVlbmN5IGlz
IGFyYml0cmFyeS4gKi8KKyAgICAgICAgaWYgKCAhKGkgJiAweDNmKSAmJiBo
eXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkKKyAgICAgICAgeworICAgICAg
ICAgICAgc3Bpbl9sb2NrKCZkLT5ldmVudF9sb2NrKTsKKyAgICAgICAgICAg
IGQtPm5leHRfZXZ0Y2huID0gaTsKKyAgICAgICAgICAgIHNwaW5fdW5sb2Nr
KCZkLT5ldmVudF9sb2NrKTsKKyAgICAgICAgICAgIHJldHVybiAtRVJFU1RB
UlQ7CisgICAgICAgIH0KKyAgICB9CisKICAgICBzcGluX2xvY2soJmQtPmV2
ZW50X2xvY2spOwogCisgICAgZC0+bmV4dF9ldnRjaG4gPSAwOworCiAgICAg
aWYgKCBkLT5hY3RpdmVfZXZ0Y2hucyA+IGQtPnhlbl9ldnRjaG5zICkKICAg
ICAgICAgcmMgPSAtRUFHQUlOOwogICAgIGVsc2UgaWYgKCBkLT5ldnRjaG5f
ZmlmbyApCkBAIC0xMjA0LDcgKzEyMzMsOCBAQCBsb25nIGRvX2V2ZW50X2No
YW5uZWxfb3AoaW50IGNtZCwgWEVOX0dVCiAgICAgICAgIGJyZWFrOwogICAg
IH0KIAotICAgIGNhc2UgRVZUQ0hOT1BfcmVzZXQ6IHsKKyAgICBjYXNlIEVW
VENITk9QX3Jlc2V0OgorICAgIGNhc2UgRVZUQ0hOT1BfcmVzZXRfY29udDog
ewogICAgICAgICBzdHJ1Y3QgZXZ0Y2huX3Jlc2V0IHJlc2V0OwogICAgICAg
ICBzdHJ1Y3QgZG9tYWluICpkOwogCkBAIC0xMjE3LDkgKzEyNDcsMTMgQEAg
bG9uZyBkb19ldmVudF9jaGFubmVsX29wKGludCBjbWQsIFhFTl9HVQogCiAg
ICAgICAgIHJjID0geHNtX2V2dGNobl9yZXNldChYU01fVEFSR0VULCBjdXJy
ZW50LT5kb21haW4sIGQpOwogICAgICAgICBpZiAoICFyYyApCi0gICAgICAg
ICAgICByYyA9IGV2dGNobl9yZXNldChkKTsKKyAgICAgICAgICAgIHJjID0g
ZXZ0Y2huX3Jlc2V0KGQsIGNtZCA9PSBFVlRDSE5PUF9yZXNldF9jb250KTsK
IAogICAgICAgICByY3VfdW5sb2NrX2RvbWFpbihkKTsKKworICAgICAgICBp
ZiAoIHJjID09IC1FUkVTVEFSVCApCisgICAgICAgICAgICByYyA9IGh5cGVy
Y2FsbF9jcmVhdGVfY29udGludWF0aW9uKF9fSFlQRVJWSVNPUl9ldmVudF9j
aGFubmVsX29wLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAiaWgiLCBFVlRDSE5PUF9yZXNldF9jb250LCBhcmcp
OwogICAgICAgICBicmVhazsKICAgICB9CiAKLS0tIGEveGVuL2luY2x1ZGUv
cHVibGljL2RvbWN0bC5oCisrKyBiL3hlbi9pbmNsdWRlL3B1YmxpYy9kb21j
dGwuaApAQCAtMTE1OSw3ICsxMTU5LDEwIEBAIHN0cnVjdCB4ZW5fZG9tY3Rs
IHsKICNkZWZpbmUgWEVOX0RPTUNUTF9pb21lbV9wZXJtaXNzaW9uICAgICAg
ICAgICAgICAyMAogI2RlZmluZSBYRU5fRE9NQ1RMX2lvcG9ydF9wZXJtaXNz
aW9uICAgICAgICAgICAgIDIxCiAjZGVmaW5lIFhFTl9ET01DVExfaHlwZXJj
YWxsX2luaXQgICAgICAgICAgICAgICAgMjIKLSNkZWZpbmUgWEVOX0RPTUNU
TF9hcmNoX3NldHVwICAgICAgICAgICAgICAgICAgICAyMyAvKiBPYnNvbGV0
ZSBJQTY0IG9ubHkgKi8KKyNpZmRlZiBfX1hFTl9fCisvKiAjZGVmaW5lIFhF
Tl9ET01DVExfYXJjaF9zZXR1cCAgICAgICAgICAgICAgICAgMjMgT2Jzb2xl
dGUgSUE2NCBvbmx5ICovCisjZGVmaW5lIFhFTl9ET01DVExfc29mdF9yZXNl
dF9jb250ICAgICAgICAgICAgICAgMjMKKyNlbmRpZgogI2RlZmluZSBYRU5f
RE9NQ1RMX3NldHRpbWVvZmZzZXQgICAgICAgICAgICAgICAgIDI0CiAjZGVm
aW5lIFhFTl9ET01DVExfZ2V0dmNwdWFmZmluaXR5ICAgICAgICAgICAgICAg
MjUKICNkZWZpbmUgWEVOX0RPTUNUTF9yZWFsX21vZGVfYXJlYSAgICAgICAg
ICAgICAgICAyNiAvKiBPYnNvbGV0ZSBQUEMgb25seSAqLwotLS0gYS94ZW4v
aW5jbHVkZS9wdWJsaWMvZXZlbnRfY2hhbm5lbC5oCisrKyBiL3hlbi9pbmNs
dWRlL3B1YmxpYy9ldmVudF9jaGFubmVsLmgKQEAgLTc0LDYgKzc0LDkgQEAK
ICNkZWZpbmUgRVZUQ0hOT1BfaW5pdF9jb250cm9sICAgIDExCiAjZGVmaW5l
IEVWVENITk9QX2V4cGFuZF9hcnJheSAgICAxMgogI2RlZmluZSBFVlRDSE5P
UF9zZXRfcHJpb3JpdHkgICAgMTMKKyNpZmRlZiBfX1hFTl9fCisjZGVmaW5l
IEVWVENITk9QX3Jlc2V0X2NvbnQgICAgICAxNAorI2VuZGlmCiAvKiBgIH0g
Ki8KIAogdHlwZWRlZiB1aW50MzJfdCBldnRjaG5fcG9ydF90OwotLS0gYS94
ZW4vaW5jbHVkZS94ZW4vZXZlbnQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4v
ZXZlbnQuaApAQCAtMTcxLDcgKzE3MSw3IEBAIHZvaWQgZXZ0Y2huX2NoZWNr
X3BvbGxlcnMoc3RydWN0IGRvbWFpbgogdm9pZCBldnRjaG5fMmxfaW5pdChz
dHJ1Y3QgZG9tYWluICpkKTsKIAogLyogQ2xvc2UgYWxsIGV2ZW50IGNoYW5u
ZWxzIGFuZCByZXNldCB0byAyLWxldmVsIEFCSS4gKi8KLWludCBldnRjaG5f
cmVzZXQoc3RydWN0IGRvbWFpbiAqZCk7CitpbnQgZXZ0Y2huX3Jlc2V0KHN0
cnVjdCBkb21haW4gKmQsIGJvb2wgcmVzdW1pbmcpOwogCiAvKgogICogTG93
LWxldmVsIGV2ZW50IGNoYW5uZWwgcG9ydCBvcHMuCi0tLSBhL3hlbi9pbmNs
dWRlL3hlbi9zY2hlZC5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5o
CkBAIC0zNzEsNiArMzcxLDggQEAgc3RydWN0IGRvbWFpbgogICAgICAqIEVW
VENITk9QX3Jlc2V0KS4gIFJlYWQvd3JpdGUgYWNjZXNzIGxpa2UgZm9yIGFj
dGl2ZV9ldnRjaG5zLgogICAgICAqLwogICAgIHVuc2lnbmVkIGludCAgICAg
eGVuX2V2dGNobnM7CisgICAgLyogUG9ydCB0byByZXN1bWUgZnJvbSBpbiBl
dnRjaG5fcmVzZXQoKSwgd2hlbiBpbiBhIGNvbnRpbnVhdGlvbi4gKi8KKyAg
ICB1bnNpZ25lZCBpbnQgICAgIG5leHRfZXZ0Y2huOwogICAgIHNwaW5sb2Nr
X3QgICAgICAgZXZlbnRfbG9jazsKICAgICBjb25zdCBzdHJ1Y3QgZXZ0Y2hu
X3BvcnRfb3BzICpldnRjaG5fcG9ydF9vcHM7CiAgICAgc3RydWN0IGV2dGNo
bl9maWZvX2RvbWFpbiAqZXZ0Y2huX2ZpZm87CkBAIC02NjMsNyArNjY1LDcg
QEAgaW50IGRvbWFpbl9raWxsKHN0cnVjdCBkb21haW4gKmQpOwogaW50IGRv
bWFpbl9zaHV0ZG93bihzdHJ1Y3QgZG9tYWluICpkLCB1OCByZWFzb24pOwog
dm9pZCBkb21haW5fcmVzdW1lKHN0cnVjdCBkb21haW4gKmQpOwogCi1pbnQg
ZG9tYWluX3NvZnRfcmVzZXQoc3RydWN0IGRvbWFpbiAqZCk7CitpbnQgZG9t
YWluX3NvZnRfcmVzZXQoc3RydWN0IGRvbWFpbiAqZCwgYm9vbCByZXN1bWlu
Zyk7CiAKIGludCB2Y3B1X3N0YXJ0X3NodXRkb3duX2RlZmVycmFsKHN0cnVj
dCB2Y3B1ICp2KTsKIHZvaWQgdmNwdV9lbmRfc2h1dGRvd25fZGVmZXJyYWwo
c3RydWN0IHZjcHUgKnYpOwo=

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.10-1.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.10-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX2Rl
c3Ryb3koKQoKRXNwZWNpYWxseSBjbG9zaW5nIG9mIGZ1bGx5IGVzdGFibGlz
aGVkIGludGVyZG9tYWluIGNoYW5uZWxzIGNhbiB0YWtlCnF1aXRlIHNvbWUg
dGltZSwgZHVlIHRvIHRoZSBsb2NraW5nIGludm9sdmVkLiBUaGVyZWZvcmUg
d2Ugc2hvdWxkbid0CmFzc3VtZSB3ZSBjYW4gY2xlYW4gdXAgc3RpbGwgYWN0
aXZlIHBvcnRzIGFsbCBpbiBvbmUgZ28uIEJlc2lkZXMgYWRkaW5nCnRoZSBu
ZWNlc3NhcnkgcHJlZW1wdGlvbiBjaGVjaywgYWxzbyBhdm9pZCBwb2ludGxl
c3NseSBzdGFydGluZyBmcm9tCihvciBub3cgcmVhbGx5IGVuZGluZyBhdCkg
MDsgMSBpcyB0aGUgbG93ZXN0IG51bWJlcmVkIHBvcnQgd2hpY2ggbWF5Cm5l
ZWQgY2xvc2luZy4KClNpbmNlIHdlJ3JlIG5vdyByZWR1Y2luZyAtPnZhbGlk
X2V2dGNobnMsIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoKSwKYW5kIChhdCBs
ZWFzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlKSBub3RpZnlfdmlhX3hlbl9l
dmVudF9jaGFubmVsKCkKbmVlZCB0byBjb3BlIHdpdGggYXR0ZW1wdHMgdG8g
Y2xvc2UgLyB1bmJpbmQgZnJvbSAvIHNlbmQgdGhyb3VnaCBhbHJlYWR5CmNs
b3NlZCAoYW5kIG5vIGxvbmdlciB2YWxpZCwgYXMgcGVyIHBvcnRfaXNfdmFs
aWQoKSkgcG9ydHMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NC4KClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQWNr
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmll
d2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5l
bC5vcmc+CgotLS0gYS94ZW4vY29tbW9uL2RvbWFpbi5jCisrKyBiL3hlbi9j
b21tb24vZG9tYWluLmMKQEAgLTYyNiw3ICs2MjYsNiBAQCBpbnQgZG9tYWlu
X2tpbGwoc3RydWN0IGRvbWFpbiAqZCkKICAgICAgICAgZG9tYWluX3BhdXNl
KGQpOwogICAgICAgICBkLT5pc19keWluZyA9IERPTURZSU5HX2R5aW5nOwog
ICAgICAgICBzcGluX2JhcnJpZXIoJmQtPmRvbWFpbl9sb2NrKTsKLSAgICAg
ICAgZXZ0Y2huX2Rlc3Ryb3koZCk7CiAgICAgICAgIGdudHRhYl9yZWxlYXNl
X21hcHBpbmdzKGQpOwogICAgICAgICB0bWVtX2Rlc3Ryb3koZC0+dG1lbV9j
bGllbnQpOwogICAgICAgICB2bnVtYV9kZXN0cm95KGQtPnZudW1hKTsKQEAg
LTYzNCw2ICs2MzMsOSBAQCBpbnQgZG9tYWluX2tpbGwoc3RydWN0IGRvbWFp
biAqZCkKICAgICAgICAgZC0+dG1lbV9jbGllbnQgPSBOVUxMOwogICAgICAg
ICAvKiBmYWxsdGhyb3VnaCAqLwogICAgIGNhc2UgRE9NRFlJTkdfZHlpbmc6
CisgICAgICAgIHJjID0gZXZ0Y2huX2Rlc3Ryb3koZCk7CisgICAgICAgIGlm
ICggcmMgKQorICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIHJjID0gZG9t
YWluX3JlbGlucXVpc2hfcmVzb3VyY2VzKGQpOwogICAgICAgICBpZiAoIHJj
ICE9IDAgKQogICAgICAgICAgICAgYnJlYWs7Ci0tLSBhL3hlbi9jb21tb24v
ZXZlbnRfY2hhbm5lbC5jCisrKyBiL3hlbi9jb21tb24vZXZlbnRfY2hhbm5l
bC5jCkBAIC0xMjk5LDcgKzEyOTksMTYgQEAgaW50IGFsbG9jX3VuYm91bmRf
eGVuX2V2ZW50X2NoYW5uZWwoCiAKIHZvaWQgZnJlZV94ZW5fZXZlbnRfY2hh
bm5lbChzdHJ1Y3QgZG9tYWluICpkLCBpbnQgcG9ydCkKIHsKLSAgICBCVUdf
T04oIXBvcnRfaXNfdmFsaWQoZCwgcG9ydCkpOworICAgIGlmICggIXBvcnRf
aXNfdmFsaWQoZCwgcG9ydCkgKQorICAgIHsKKyAgICAgICAgLyoKKyAgICAg
ICAgICogTWFrZSBzdXJlIC0+aXNfZHlpbmcgaXMgcmVhZCAvYWZ0ZXIvIC0+
dmFsaWRfZXZ0Y2hucywgcGFpcmluZworICAgICAgICAgKiB3aXRoIHRoZSBz
cGluX2JhcnJpZXIoKSBhbmQgQlVHX09OKCkgaW4gZXZ0Y2huX2Rlc3Ryb3ko
KS4KKyAgICAgICAgICovCisgICAgICAgIHNtcF9ybWIoKTsKKyAgICAgICAg
QlVHX09OKCFkLT5pc19keWluZyk7CisgICAgICAgIHJldHVybjsKKyAgICB9
CiAKICAgICBldnRjaG5fY2xvc2UoZCwgcG9ydCwgMCk7CiB9CkBAIC0xMzEx
LDcgKzEzMjAsMTcgQEAgdm9pZCBub3RpZnlfdmlhX3hlbl9ldmVudF9jaGFu
bmVsKHN0cnVjdAogICAgIHN0cnVjdCBkb21haW4gKnJkOwogICAgIHVuc2ln
bmVkIGxvbmcgZmxhZ3M7CiAKLSAgICBBU1NFUlQocG9ydF9pc192YWxpZChs
ZCwgbHBvcnQpKTsKKyAgICBpZiAoICFwb3J0X2lzX3ZhbGlkKGxkLCBscG9y
dCkgKQorICAgIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogTWFrZSBzdXJl
IC0+aXNfZHlpbmcgaXMgcmVhZCAvYWZ0ZXIvIC0+dmFsaWRfZXZ0Y2hucywg
cGFpcmluZworICAgICAgICAgKiB3aXRoIHRoZSBzcGluX2JhcnJpZXIoKSBh
bmQgQlVHX09OKCkgaW4gZXZ0Y2huX2Rlc3Ryb3koKS4KKyAgICAgICAgICov
CisgICAgICAgIHNtcF9ybWIoKTsKKyAgICAgICAgQVNTRVJUKGxkLT5pc19k
eWluZyk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKICAgICBsY2huID0g
ZXZ0Y2huX2Zyb21fcG9ydChsZCwgbHBvcnQpOwogCiAgICAgc3Bpbl9sb2Nr
X2lycXNhdmUoJmxjaG4tPmxvY2ssIGZsYWdzKTsKQEAgLTEzODMsOCArMTQw
Miw3IEBAIGludCBldnRjaG5faW5pdChzdHJ1Y3QgZG9tYWluICpkKQogICAg
IHJldHVybiAwOwogfQogCi0KLXZvaWQgZXZ0Y2huX2Rlc3Ryb3koc3RydWN0
IGRvbWFpbiAqZCkKK2ludCBldnRjaG5fZGVzdHJveShzdHJ1Y3QgZG9tYWlu
ICpkKQogewogICAgIHVuc2lnbmVkIGludCBpOwogCkBAIC0xMzkzLDE0ICsx
NDExLDI5IEBAIHZvaWQgZXZ0Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAq
ZCkKICAgICBzcGluX2JhcnJpZXIoJmQtPmV2ZW50X2xvY2spOwogCiAgICAg
LyogQ2xvc2UgYWxsIGV4aXN0aW5nIGV2ZW50IGNoYW5uZWxzLiAqLwotICAg
IGZvciAoIGkgPSAwOyBwb3J0X2lzX3ZhbGlkKGQsIGkpOyBpKysgKQorICAg
IGZvciAoIGkgPSBkLT52YWxpZF9ldnRjaG5zOyAtLWk7ICkKKyAgICB7CiAg
ICAgICAgIGV2dGNobl9jbG9zZShkLCBpLCAwKTsKIAorICAgICAgICAvKgor
ICAgICAgICAgKiBBdm9pZCBwcmVlbXB0aW5nIHdoZW4gY2FsbGVkIGZyb20g
ZG9tYWluX2NyZWF0ZSgpJ3MgZXJyb3IgcGF0aCwKKyAgICAgICAgICogYW5k
IGRvbid0IGNoZWNrIHRvbyBvZnRlbiAoY2hvaWNlIG9mIGZyZXF1ZW5jeSBp
cyBhcmJpdHJhcnkpLgorICAgICAgICAgKi8KKyAgICAgICAgaWYgKCBpICYm
ICEoaSAmIDB4M2YpICYmIGQtPmlzX2R5aW5nICE9IERPTURZSU5HX2RlYWQg
JiYKKyAgICAgICAgICAgICBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygpICkK
KyAgICAgICAgeworICAgICAgICAgICAgd3JpdGVfYXRvbWljKCZkLT52YWxp
ZF9ldnRjaG5zLCBpKTsKKyAgICAgICAgICAgIHJldHVybiAtRVJFU1RBUlQ7
CisgICAgICAgIH0KKyAgICB9CisKICAgICBBU1NFUlQoIWQtPmFjdGl2ZV9l
dnRjaG5zKTsKIAogICAgIGNsZWFyX2dsb2JhbF92aXJxX2hhbmRsZXJzKGQp
OwogCiAgICAgZXZ0Y2huX2ZpZm9fZGVzdHJveShkKTsKKworICAgIHJldHVy
biAwOwogfQogCiAKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysr
IGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKQEAgLTEzNCw3ICsxMzQsNyBA
QCBzdHJ1Y3QgZXZ0Y2huCiB9IF9fYXR0cmlidXRlX18oKGFsaWduZWQoNjQp
KSk7CiAKIGludCAgZXZ0Y2huX2luaXQoc3RydWN0IGRvbWFpbiAqZCk7IC8q
IGZyb20gZG9tYWluX2NyZWF0ZSAqLwotdm9pZCBldnRjaG5fZGVzdHJveShz
dHJ1Y3QgZG9tYWluICpkKTsgLyogZnJvbSBkb21haW5fa2lsbCAqLworaW50
ICBldnRjaG5fZGVzdHJveShzdHJ1Y3QgZG9tYWluICpkKTsgLyogZnJvbSBk
b21haW5fa2lsbCAqLwogdm9pZCBldnRjaG5fZGVzdHJveV9maW5hbChzdHJ1
Y3QgZG9tYWluICpkKTsgLyogZnJvbSBjb21wbGV0ZV9kb21haW5fZGVzdHJv
eSAqLwogCiBzdHJ1Y3Qgd2FpdHF1ZXVlX3ZjcHU7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.10-2.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.10-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX3Jl
c2V0KCkKCkxpa2UgZm9yIGV2dGNobl9kZXN0cm95KCkgbG9vcGluZyBvdmVy
IGFsbCBwb3NzaWJsZSBldmVudCBjaGFubmVscyB0bwpjbG9zZSB0aGVtIGNh
biB0YWtlIGEgc2lnbmlmaWNhbnQgYW1vdW50IG9mIHRpbWUuIFVubGlrZSBk
b25lIHRoZXJlLCB3ZQpjYW4ndCBhbHRlciBkb21haW4gcHJvcGVydGllcyAo
aS5lLiBkLT52YWxpZF9ldnRjaG5zKSBoZXJlLiBCb3Jyb3csIGluIGEKbGln
aHR3ZWlnaHQgZm9ybSwgdGhlIHBhZ2luZyBkb21jdGwgY29udGludWF0aW9u
IGNvbmNlcHQsIHJlZGlyZWN0aW5nCnRoZSBjb250aW51YXRpb25zIHRvIGRp
ZmZlcmVudCBzdWItb3BzLiBKdXN0IGxpa2UgdGhlcmUgdGhpcyBpcyB0byBi
ZQphYmxlIHRvIGFsbG93IGZvciBwcmVkaWN0YWJsZSBvdmVyYWxsIHJlc3Vs
dHMgb2YgdGhlIGludm9sdmVkIHN1Yi1vcHM6ClJhY2luZyByZXF1ZXN0cyBz
aG91bGQgZWl0aGVyIGNvbXBsZXRlIG9yIGJlIHJlZnVzZWQuCgpOb3RlIHRo
YXQgYSBkb21haW4gY2FuJ3QgaW50ZXJmZXJlIHdpdGggYW4gYWxyZWFkeSBz
dGFydGVkIChieSBhIHJlbW90ZQpkb21haW4pIHJlc2V0LCBkdWUgdG8gYmVp
bmcgcGF1c2VkLiBJdCBjYW4gcHJldmVudCBhIHJlbW90ZSByZXNldCBmcm9t
CmhhcHBlbmluZyBieSBsZWF2aW5nIGEgcmVzZXQgdW5maW5pc2hlZCwgYnV0
IHRoYXQncyBvbmx5IGdvaW5nIHRvIGFmZmVjdAppdHNlbGYuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNo
IDxqYmV1bGljaEBzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJl
bGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CgotLS0gYS94ZW4vY29t
bW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTEw
ODYsNyArMTA4Niw3IEBAIHZvaWQgZG9tYWluX3VucGF1c2VfZXhjZXB0X3Nl
bGYoc3RydWN0IGQKICAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7CiB9CiAK
LWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50
IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVjdCBkb21haW4gKmQsIGJvb2wgcmVz
dW1pbmcpCiB7CiAgICAgc3RydWN0IHZjcHUgKnY7CiAgICAgaW50IHJjOwpA
QCAtMTEwMCw3ICsxMTAwLDcgQEAgaW50IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0
cnVjdCBkb21haW4gKmQpCiAgICAgICAgIH0KICAgICBzcGluX3VubG9jaygm
ZC0+c2h1dGRvd25fbG9jayk7CiAKLSAgICByYyA9IGV2dGNobl9yZXNldChk
KTsKKyAgICByYyA9IGV2dGNobl9yZXNldChkLCByZXN1bWluZyk7CiAgICAg
aWYgKCByYyApCiAgICAgICAgIHJldHVybiByYzsKIAotLS0gYS94ZW4vY29t
bW9uL2RvbWN0bC5jCisrKyBiL3hlbi9jb21tb24vZG9tY3RsLmMKQEAgLTY2
NiwxMiArNjY2LDIyIEBAIGxvbmcgZG9fZG9tY3RsKFhFTl9HVUVTVF9IQU5E
TEVfUEFSQU0oeGUKICAgICB9CiAKICAgICBjYXNlIFhFTl9ET01DVExfc29m
dF9yZXNldDoKKyAgICBjYXNlIFhFTl9ET01DVExfc29mdF9yZXNldF9jb250
OgogICAgICAgICBpZiAoIGQgPT0gY3VycmVudC0+ZG9tYWluICkgLyogbm8g
ZG9tYWluX3BhdXNlKCkgKi8KICAgICAgICAgewogICAgICAgICAgICAgcmV0
ID0gLUVJTlZBTDsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9Ci0g
ICAgICAgIHJldCA9IGRvbWFpbl9zb2Z0X3Jlc2V0KGQpOworICAgICAgICBy
ZXQgPSBkb21haW5fc29mdF9yZXNldChkLCBvcC0+Y21kID09IFhFTl9ET01D
VExfc29mdF9yZXNldF9jb250KTsKKyAgICAgICAgaWYgKCByZXQgPT0gLUVS
RVNUQVJUICkKKyAgICAgICAgeworICAgICAgICAgICAgb3AtPmNtZCA9IFhF
Tl9ET01DVExfc29mdF9yZXNldF9jb250OworICAgICAgICAgICAgaWYgKCAh
X19jb3B5X2ZpZWxkX3RvX2d1ZXN0KHVfZG9tY3RsLCBvcCwgY21kKSApCisg
ICAgICAgICAgICAgICAgcmV0ID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51
YXRpb24oX19IWVBFUlZJU09SX2RvbWN0bCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaCIsIHVfZG9t
Y3RsKTsKKyAgICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICByZXQg
PSAtRUZBVUxUOworICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogCiAgICAg
Y2FzZSBYRU5fRE9NQ1RMX2Rlc3Ryb3lkb21haW46Ci0tLSBhL3hlbi9jb21t
b24vZXZlbnRfY2hhbm5lbC5jCisrKyBiL3hlbi9jb21tb24vZXZlbnRfY2hh
bm5lbC5jCkBAIC0xMDU5LDcgKzEwNTksNyBAQCBpbnQgZXZ0Y2huX3VubWFz
ayh1bnNpZ25lZCBpbnQgcG9ydCkKICAgICByZXR1cm4gMDsKIH0KIAotaW50
IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50IGV2dGNobl9y
ZXNldChzdHJ1Y3QgZG9tYWluICpkLCBib29sIHJlc3VtaW5nKQogewogICAg
IHVuc2lnbmVkIGludCBpOwogICAgIGludCByYyA9IDA7CkBAIC0xMDY3LDEx
ICsxMDY3LDQwIEBAIGludCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAq
ZCkKICAgICBpZiAoIGQgIT0gY3VycmVudC0+ZG9tYWluICYmICFkLT5jb250
cm9sbGVyX3BhdXNlX2NvdW50ICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
CiAKLSAgICBmb3IgKCBpID0gMDsgcG9ydF9pc192YWxpZChkLCBpKTsgaSsr
ICkKKyAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgLyoK
KyAgICAgKiBJZiB3ZSBhcmUgcmVzdW1pbmcsIHRoZW4gc3RhcnQgd2hlcmUg
d2Ugc3RvcHBlZC4gT3RoZXJ3aXNlLCBjaGVjaworICAgICAqIHRoYXQgYSBy
ZXNldCBvcGVyYXRpb24gaXMgbm90IGFscmVhZHkgaW4gcHJvZ3Jlc3MsIGFu
ZCBpZiBub25lIGlzLAorICAgICAqIHJlY29yZCB0aGF0IHRoaXMgaXMgbm93
IHRoZSBjYXNlLgorICAgICAqLworICAgIGkgPSByZXN1bWluZyA/IGQtPm5l
eHRfZXZ0Y2huIDogIWQtPm5leHRfZXZ0Y2huOworICAgIGlmICggaSA+IGQt
Pm5leHRfZXZ0Y2huICkKKyAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOwor
CisgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgaWYg
KCAhaSApCisgICAgICAgIHJldHVybiAtRUJVU1k7CisKKyAgICBmb3IgKCA7
IHBvcnRfaXNfdmFsaWQoZCwgaSk7IGkrKyApCisgICAgewogICAgICAgICBl
dnRjaG5fY2xvc2UoZCwgaSwgMSk7CiAKKyAgICAgICAgLyogTkI6IENob2lj
ZSBvZiBmcmVxdWVuY3kgaXMgYXJiaXRyYXJ5LiAqLworICAgICAgICBpZiAo
ICEoaSAmIDB4M2YpICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQor
ICAgICAgICB7CisgICAgICAgICAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xv
Y2spOworICAgICAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOworICAgICAg
ICAgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworICAgICAgICAg
ICAgcmV0dXJuIC1FUkVTVEFSVDsKKyAgICAgICAgfQorICAgIH0KKwogICAg
IHNwaW5fbG9jaygmZC0+ZXZlbnRfbG9jayk7CiAKKyAgICBkLT5uZXh0X2V2
dGNobiA9IDA7CisKICAgICBpZiAoIGQtPmFjdGl2ZV9ldnRjaG5zID4gZC0+
eGVuX2V2dGNobnMgKQogICAgICAgICByYyA9IC1FQUdBSU47CiAgICAgZWxz
ZSBpZiAoIGQtPmV2dGNobl9maWZvICkKQEAgLTEyMDYsNyArMTIzNSw4IEBA
IGxvbmcgZG9fZXZlbnRfY2hhbm5lbF9vcChpbnQgY21kLCBYRU5fR1UKICAg
ICAgICAgYnJlYWs7CiAgICAgfQogCi0gICAgY2FzZSBFVlRDSE5PUF9yZXNl
dDogeworICAgIGNhc2UgRVZUQ0hOT1BfcmVzZXQ6CisgICAgY2FzZSBFVlRD
SE5PUF9yZXNldF9jb250OiB7CiAgICAgICAgIHN0cnVjdCBldnRjaG5fcmVz
ZXQgcmVzZXQ7CiAgICAgICAgIHN0cnVjdCBkb21haW4gKmQ7CiAKQEAgLTEy
MTksOSArMTI0OSwxMyBAQCBsb25nIGRvX2V2ZW50X2NoYW5uZWxfb3AoaW50
IGNtZCwgWEVOX0dVCiAKICAgICAgICAgcmMgPSB4c21fZXZ0Y2huX3Jlc2V0
KFhTTV9UQVJHRVQsIGN1cnJlbnQtPmRvbWFpbiwgZCk7CiAgICAgICAgIGlm
ICggIXJjICkKLSAgICAgICAgICAgIHJjID0gZXZ0Y2huX3Jlc2V0KGQpOwor
ICAgICAgICAgICAgcmMgPSBldnRjaG5fcmVzZXQoZCwgY21kID09IEVWVENI
Tk9QX3Jlc2V0X2NvbnQpOwogCiAgICAgICAgIHJjdV91bmxvY2tfZG9tYWlu
KGQpOworCisgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKKyAgICAg
ICAgICAgIHJjID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51YXRpb24oX19I
WVBFUlZJU09SX2V2ZW50X2NoYW5uZWxfb3AsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpaCIsIEVWVENITk9Q
X3Jlc2V0X2NvbnQsIGFyZyk7CiAgICAgICAgIGJyZWFrOwogICAgIH0KIAot
LS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvZG9tY3RsLmgKKysrIGIveGVuL2lu
Y2x1ZGUvcHVibGljL2RvbWN0bC5oCkBAIC0xMTMwLDcgKzExMzAsMTAgQEAg
c3RydWN0IHhlbl9kb21jdGwgewogI2RlZmluZSBYRU5fRE9NQ1RMX2lvbWVt
X3Blcm1pc3Npb24gICAgICAgICAgICAgIDIwCiAjZGVmaW5lIFhFTl9ET01D
VExfaW9wb3J0X3Blcm1pc3Npb24gICAgICAgICAgICAgMjEKICNkZWZpbmUg
WEVOX0RPTUNUTF9oeXBlcmNhbGxfaW5pdCAgICAgICAgICAgICAgICAyMgot
I2RlZmluZSBYRU5fRE9NQ1RMX2FyY2hfc2V0dXAgICAgICAgICAgICAgICAg
ICAgIDIzIC8qIE9ic29sZXRlIElBNjQgb25seSAqLworI2lmZGVmIF9fWEVO
X18KKy8qICNkZWZpbmUgWEVOX0RPTUNUTF9hcmNoX3NldHVwICAgICAgICAg
ICAgICAgICAyMyBPYnNvbGV0ZSBJQTY0IG9ubHkgKi8KKyNkZWZpbmUgWEVO
X0RPTUNUTF9zb2Z0X3Jlc2V0X2NvbnQgICAgICAgICAgICAgICAyMworI2Vu
ZGlmCiAjZGVmaW5lIFhFTl9ET01DVExfc2V0dGltZW9mZnNldCAgICAgICAg
ICAgICAgICAgMjQKICNkZWZpbmUgWEVOX0RPTUNUTF9nZXR2Y3B1YWZmaW5p
dHkgICAgICAgICAgICAgICAyNQogI2RlZmluZSBYRU5fRE9NQ1RMX3JlYWxf
bW9kZV9hcmVhICAgICAgICAgICAgICAgIDI2IC8qIE9ic29sZXRlIFBQQyBv
bmx5ICovCi0tLSBhL3hlbi9pbmNsdWRlL3B1YmxpYy9ldmVudF9jaGFubmVs
LmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL2V2ZW50X2NoYW5uZWwuaApA
QCAtNzQsNiArNzQsOSBAQAogI2RlZmluZSBFVlRDSE5PUF9pbml0X2NvbnRy
b2wgICAgMTEKICNkZWZpbmUgRVZUQ0hOT1BfZXhwYW5kX2FycmF5ICAgIDEy
CiAjZGVmaW5lIEVWVENITk9QX3NldF9wcmlvcml0eSAgICAxMworI2lmZGVm
IF9fWEVOX18KKyNkZWZpbmUgRVZUQ0hOT1BfcmVzZXRfY29udCAgICAgIDE0
CisjZW5kaWYKIC8qIGAgfSAqLwogCiB0eXBlZGVmIHVpbnQzMl90IGV2dGNo
bl9wb3J0X3Q7Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCisrKyBi
L3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCkBAIC0xNjMsNyArMTYzLDcgQEAg
dm9pZCBldnRjaG5fY2hlY2tfcG9sbGVycyhzdHJ1Y3QgZG9tYWluCiB2b2lk
IGV2dGNobl8ybF9pbml0KHN0cnVjdCBkb21haW4gKmQpOwogCiAvKiBDbG9z
ZSBhbGwgZXZlbnQgY2hhbm5lbHMgYW5kIHJlc2V0IHRvIDItbGV2ZWwgQUJJ
LiAqLwotaW50IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKTsKK2lu
dCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAqZCwgYm9vbCByZXN1bWlu
Zyk7CiAKIC8qCiAgKiBMb3ctbGV2ZWwgZXZlbnQgY2hhbm5lbCBwb3J0IG9w
cy4KLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmgKQEAgLTM0OCw2ICszNDgsOCBAQCBzdHJ1Y3Qg
ZG9tYWluCiAgICAgICogRVZUQ0hOT1BfcmVzZXQpLiAgUmVhZC93cml0ZSBh
Y2Nlc3MgbGlrZSBmb3IgYWN0aXZlX2V2dGNobnMuCiAgICAgICovCiAgICAg
dW5zaWduZWQgaW50ICAgICB4ZW5fZXZ0Y2huczsKKyAgICAvKiBQb3J0IHRv
IHJlc3VtZSBmcm9tIGluIGV2dGNobl9yZXNldCgpLCB3aGVuIGluIGEgY29u
dGludWF0aW9uLiAqLworICAgIHVuc2lnbmVkIGludCAgICAgbmV4dF9ldnRj
aG47CiAgICAgc3BpbmxvY2tfdCAgICAgICBldmVudF9sb2NrOwogICAgIGNv
bnN0IHN0cnVjdCBldnRjaG5fcG9ydF9vcHMgKmV2dGNobl9wb3J0X29wczsK
ICAgICBzdHJ1Y3QgZXZ0Y2huX2ZpZm9fZG9tYWluICpldnRjaG5fZmlmbzsK
QEAgLTYxNiw3ICs2MTgsNyBAQCBpbnQgZG9tYWluX3NodXRkb3duKHN0cnVj
dCBkb21haW4gKmQsIHU4CiB2b2lkIGRvbWFpbl9yZXN1bWUoc3RydWN0IGRv
bWFpbiAqZCk7CiB2b2lkIGRvbWFpbl9wYXVzZV9mb3JfZGVidWdnZXIodm9p
ZCk7CiAKLWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpk
KTsKK2ludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkLCBi
b29sIHJlc3VtaW5nKTsKIAogaW50IHZjcHVfc3RhcnRfc2h1dGRvd25fZGVm
ZXJyYWwoc3RydWN0IHZjcHUgKnYpOwogdm9pZCB2Y3B1X2VuZF9zaHV0ZG93
bl9kZWZlcnJhbChzdHJ1Y3QgdmNwdSAqdik7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.11-1.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX2Rl
c3Ryb3koKQoKRXNwZWNpYWxseSBjbG9zaW5nIG9mIGZ1bGx5IGVzdGFibGlz
aGVkIGludGVyZG9tYWluIGNoYW5uZWxzIGNhbiB0YWtlCnF1aXRlIHNvbWUg
dGltZSwgZHVlIHRvIHRoZSBsb2NraW5nIGludm9sdmVkLiBUaGVyZWZvcmUg
d2Ugc2hvdWxkbid0CmFzc3VtZSB3ZSBjYW4gY2xlYW4gdXAgc3RpbGwgYWN0
aXZlIHBvcnRzIGFsbCBpbiBvbmUgZ28uIEJlc2lkZXMgYWRkaW5nCnRoZSBu
ZWNlc3NhcnkgcHJlZW1wdGlvbiBjaGVjaywgYWxzbyBhdm9pZCBwb2ludGxl
c3NseSBzdGFydGluZyBmcm9tCihvciBub3cgcmVhbGx5IGVuZGluZyBhdCkg
MDsgMSBpcyB0aGUgbG93ZXN0IG51bWJlcmVkIHBvcnQgd2hpY2ggbWF5Cm5l
ZWQgY2xvc2luZy4KClNpbmNlIHdlJ3JlIG5vdyByZWR1Y2luZyAtPnZhbGlk
X2V2dGNobnMsIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoKSwKYW5kIChhdCBs
ZWFzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlKSBub3RpZnlfdmlhX3hlbl9l
dmVudF9jaGFubmVsKCkKbmVlZCB0byBjb3BlIHdpdGggYXR0ZW1wdHMgdG8g
Y2xvc2UgLyB1bmJpbmQgZnJvbSAvIHNlbmQgdGhyb3VnaCBhbHJlYWR5CmNs
b3NlZCAoYW5kIG5vIGxvbmdlciB2YWxpZCwgYXMgcGVyIHBvcnRfaXNfdmFs
aWQoKSkgcG9ydHMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NC4KClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQWNr
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmll
d2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5l
bC5vcmc+CgotLS0gYS94ZW4vY29tbW9uL2RvbWFpbi5jCisrKyBiL3hlbi9j
b21tb24vZG9tYWluLmMKQEAgLTY0Niw3ICs2NDYsNiBAQCBpbnQgZG9tYWlu
X2tpbGwoc3RydWN0IGRvbWFpbiAqZCkKICAgICAgICAgaWYgKCBkLT5pc19k
eWluZyAhPSBET01EWUlOR19hbGl2ZSApCiAgICAgICAgICAgICByZXR1cm4g
ZG9tYWluX2tpbGwoZCk7CiAgICAgICAgIGQtPmlzX2R5aW5nID0gRE9NRFlJ
TkdfZHlpbmc7Ci0gICAgICAgIGV2dGNobl9kZXN0cm95KGQpOwogICAgICAg
ICBnbnR0YWJfcmVsZWFzZV9tYXBwaW5ncyhkKTsKICAgICAgICAgdG1lbV9k
ZXN0cm95KGQtPnRtZW1fY2xpZW50KTsKICAgICAgICAgdm51bWFfZGVzdHJv
eShkLT52bnVtYSk7CkBAIC02NTQsNiArNjUzLDkgQEAgaW50IGRvbWFpbl9r
aWxsKHN0cnVjdCBkb21haW4gKmQpCiAgICAgICAgIGQtPnRtZW1fY2xpZW50
ID0gTlVMTDsKICAgICAgICAgLyogZmFsbHRocm91Z2ggKi8KICAgICBjYXNl
IERPTURZSU5HX2R5aW5nOgorICAgICAgICByYyA9IGV2dGNobl9kZXN0cm95
KGQpOworICAgICAgICBpZiAoIHJjICkKKyAgICAgICAgICAgIGJyZWFrOwog
ICAgICAgICByYyA9IGRvbWFpbl9yZWxpbnF1aXNoX3Jlc291cmNlcyhkKTsK
ICAgICAgICAgaWYgKCByYyAhPSAwICkKICAgICAgICAgICAgIGJyZWFrOwot
LS0gYS94ZW4vY29tbW9uL2V2ZW50X2NoYW5uZWwuYworKysgYi94ZW4vY29t
bW9uL2V2ZW50X2NoYW5uZWwuYwpAQCAtMTI5MSw3ICsxMjkxLDE2IEBAIGlu
dCBhbGxvY191bmJvdW5kX3hlbl9ldmVudF9jaGFubmVsKAogCiB2b2lkIGZy
ZWVfeGVuX2V2ZW50X2NoYW5uZWwoc3RydWN0IGRvbWFpbiAqZCwgaW50IHBv
cnQpCiB7Ci0gICAgQlVHX09OKCFwb3J0X2lzX3ZhbGlkKGQsIHBvcnQpKTsK
KyAgICBpZiAoICFwb3J0X2lzX3ZhbGlkKGQsIHBvcnQpICkKKyAgICB7Cisg
ICAgICAgIC8qCisgICAgICAgICAqIE1ha2Ugc3VyZSAtPmlzX2R5aW5nIGlz
IHJlYWQgL2FmdGVyLyAtPnZhbGlkX2V2dGNobnMsIHBhaXJpbmcKKyAgICAg
ICAgICogd2l0aCB0aGUgc3Bpbl9iYXJyaWVyKCkgYW5kIEJVR19PTigpIGlu
IGV2dGNobl9kZXN0cm95KCkuCisgICAgICAgICAqLworICAgICAgICBzbXBf
cm1iKCk7CisgICAgICAgIEJVR19PTighZC0+aXNfZHlpbmcpOworICAgICAg
ICByZXR1cm47CisgICAgfQogCiAgICAgZXZ0Y2huX2Nsb3NlKGQsIHBvcnQs
IDApOwogfQpAQCAtMTMwMyw3ICsxMzEyLDE3IEBAIHZvaWQgbm90aWZ5X3Zp
YV94ZW5fZXZlbnRfY2hhbm5lbChzdHJ1Y3QKICAgICBzdHJ1Y3QgZG9tYWlu
ICpyZDsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwogCi0gICAgQVNTRVJU
KHBvcnRfaXNfdmFsaWQobGQsIGxwb3J0KSk7CisgICAgaWYgKCAhcG9ydF9p
c192YWxpZChsZCwgbHBvcnQpICkKKyAgICB7CisgICAgICAgIC8qCisgICAg
ICAgICAqIE1ha2Ugc3VyZSAtPmlzX2R5aW5nIGlzIHJlYWQgL2FmdGVyLyAt
PnZhbGlkX2V2dGNobnMsIHBhaXJpbmcKKyAgICAgICAgICogd2l0aCB0aGUg
c3Bpbl9iYXJyaWVyKCkgYW5kIEJVR19PTigpIGluIGV2dGNobl9kZXN0cm95
KCkuCisgICAgICAgICAqLworICAgICAgICBzbXBfcm1iKCk7CisgICAgICAg
IEFTU0VSVChsZC0+aXNfZHlpbmcpOworICAgICAgICByZXR1cm47CisgICAg
fQorCiAgICAgbGNobiA9IGV2dGNobl9mcm9tX3BvcnQobGQsIGxwb3J0KTsK
IAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZsY2huLT5sb2NrLCBmbGFncyk7
CkBAIC0xMzc1LDggKzEzOTQsNyBAQCBpbnQgZXZ0Y2huX2luaXQoc3RydWN0
IGRvbWFpbiAqZCkKICAgICByZXR1cm4gMDsKIH0KIAotCi12b2lkIGV2dGNo
bl9kZXN0cm95KHN0cnVjdCBkb21haW4gKmQpCitpbnQgZXZ0Y2huX2Rlc3Ry
b3koc3RydWN0IGRvbWFpbiAqZCkKIHsKICAgICB1bnNpZ25lZCBpbnQgaTsK
IApAQCAtMTM4NSwxNCArMTQwMywyOSBAQCB2b2lkIGV2dGNobl9kZXN0cm95
KHN0cnVjdCBkb21haW4gKmQpCiAgICAgc3Bpbl9iYXJyaWVyKCZkLT5ldmVu
dF9sb2NrKTsKIAogICAgIC8qIENsb3NlIGFsbCBleGlzdGluZyBldmVudCBj
aGFubmVscy4gKi8KLSAgICBmb3IgKCBpID0gMDsgcG9ydF9pc192YWxpZChk
LCBpKTsgaSsrICkKKyAgICBmb3IgKCBpID0gZC0+dmFsaWRfZXZ0Y2huczsg
LS1pOyApCisgICAgewogICAgICAgICBldnRjaG5fY2xvc2UoZCwgaSwgMCk7
CiAKKyAgICAgICAgLyoKKyAgICAgICAgICogQXZvaWQgcHJlZW1wdGluZyB3
aGVuIGNhbGxlZCBmcm9tIGRvbWFpbl9jcmVhdGUoKSdzIGVycm9yIHBhdGgs
CisgICAgICAgICAqIGFuZCBkb24ndCBjaGVjayB0b28gb2Z0ZW4gKGNob2lj
ZSBvZiBmcmVxdWVuY3kgaXMgYXJiaXRyYXJ5KS4KKyAgICAgICAgICovCisg
ICAgICAgIGlmICggaSAmJiAhKGkgJiAweDNmKSAmJiBkLT5pc19keWluZyAh
PSBET01EWUlOR19kZWFkICYmCisgICAgICAgICAgICAgaHlwZXJjYWxsX3By
ZWVtcHRfY2hlY2soKSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHdyaXRl
X2F0b21pYygmZC0+dmFsaWRfZXZ0Y2hucywgaSk7CisgICAgICAgICAgICBy
ZXR1cm4gLUVSRVNUQVJUOworICAgICAgICB9CisgICAgfQorCiAgICAgQVNT
RVJUKCFkLT5hY3RpdmVfZXZ0Y2hucyk7CiAKICAgICBjbGVhcl9nbG9iYWxf
dmlycV9oYW5kbGVycyhkKTsKIAogICAgIGV2dGNobl9maWZvX2Rlc3Ryb3ko
ZCk7CisKKyAgICByZXR1cm4gMDsKIH0KIAogCi0tLSBhL3hlbi9pbmNsdWRl
L3hlbi9zY2hlZC5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCkBA
IC0xMzUsNyArMTM1LDcgQEAgc3RydWN0IGV2dGNobgogfSBfX2F0dHJpYnV0
ZV9fKChhbGlnbmVkKDY0KSkpOwogCiBpbnQgIGV2dGNobl9pbml0KHN0cnVj
dCBkb21haW4gKmQpOyAvKiBmcm9tIGRvbWFpbl9jcmVhdGUgKi8KLXZvaWQg
ZXZ0Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCk7IC8qIGZyb20gZG9t
YWluX2tpbGwgKi8KK2ludCAgZXZ0Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFp
biAqZCk7IC8qIGZyb20gZG9tYWluX2tpbGwgKi8KIHZvaWQgZXZ0Y2huX2Rl
c3Ryb3lfZmluYWwoc3RydWN0IGRvbWFpbiAqZCk7IC8qIGZyb20gY29tcGxl
dGVfZG9tYWluX2Rlc3Ryb3kgKi8KIAogc3RydWN0IHdhaXRxdWV1ZV92Y3B1
Owo=

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.11-2.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX3Jl
c2V0KCkKCkxpa2UgZm9yIGV2dGNobl9kZXN0cm95KCkgbG9vcGluZyBvdmVy
IGFsbCBwb3NzaWJsZSBldmVudCBjaGFubmVscyB0bwpjbG9zZSB0aGVtIGNh
biB0YWtlIGEgc2lnbmlmaWNhbnQgYW1vdW50IG9mIHRpbWUuIFVubGlrZSBk
b25lIHRoZXJlLCB3ZQpjYW4ndCBhbHRlciBkb21haW4gcHJvcGVydGllcyAo
aS5lLiBkLT52YWxpZF9ldnRjaG5zKSBoZXJlLiBCb3Jyb3csIGluIGEKbGln
aHR3ZWlnaHQgZm9ybSwgdGhlIHBhZ2luZyBkb21jdGwgY29udGludWF0aW9u
IGNvbmNlcHQsIHJlZGlyZWN0aW5nCnRoZSBjb250aW51YXRpb25zIHRvIGRp
ZmZlcmVudCBzdWItb3BzLiBKdXN0IGxpa2UgdGhlcmUgdGhpcyBpcyB0byBi
ZQphYmxlIHRvIGFsbG93IGZvciBwcmVkaWN0YWJsZSBvdmVyYWxsIHJlc3Vs
dHMgb2YgdGhlIGludm9sdmVkIHN1Yi1vcHM6ClJhY2luZyByZXF1ZXN0cyBz
aG91bGQgZWl0aGVyIGNvbXBsZXRlIG9yIGJlIHJlZnVzZWQuCgpOb3RlIHRo
YXQgYSBkb21haW4gY2FuJ3QgaW50ZXJmZXJlIHdpdGggYW4gYWxyZWFkeSBz
dGFydGVkIChieSBhIHJlbW90ZQpkb21haW4pIHJlc2V0LCBkdWUgdG8gYmVp
bmcgcGF1c2VkLiBJdCBjYW4gcHJldmVudCBhIHJlbW90ZSByZXNldCBmcm9t
CmhhcHBlbmluZyBieSBsZWF2aW5nIGEgcmVzZXQgdW5maW5pc2hlZCwgYnV0
IHRoYXQncyBvbmx5IGdvaW5nIHRvIGFmZmVjdAppdHNlbGYuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNo
IDxqYmV1bGljaEBzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJl
bGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CgotLS0gYS94ZW4vY29t
bW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTEx
MDUsNyArMTEwNSw3IEBAIHZvaWQgZG9tYWluX3VucGF1c2VfZXhjZXB0X3Nl
bGYoc3RydWN0IGQKICAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7CiB9CiAK
LWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50
IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVjdCBkb21haW4gKmQsIGJvb2wgcmVz
dW1pbmcpCiB7CiAgICAgc3RydWN0IHZjcHUgKnY7CiAgICAgaW50IHJjOwpA
QCAtMTExOSw3ICsxMTE5LDcgQEAgaW50IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0
cnVjdCBkb21haW4gKmQpCiAgICAgICAgIH0KICAgICBzcGluX3VubG9jaygm
ZC0+c2h1dGRvd25fbG9jayk7CiAKLSAgICByYyA9IGV2dGNobl9yZXNldChk
KTsKKyAgICByYyA9IGV2dGNobl9yZXNldChkLCByZXN1bWluZyk7CiAgICAg
aWYgKCByYyApCiAgICAgICAgIHJldHVybiByYzsKIAotLS0gYS94ZW4vY29t
bW9uL2RvbWN0bC5jCisrKyBiL3hlbi9jb21tb24vZG9tY3RsLmMKQEAgLTY0
OCwxMiArNjQ4LDIyIEBAIGxvbmcgZG9fZG9tY3RsKFhFTl9HVUVTVF9IQU5E
TEVfUEFSQU0oeGUKICAgICB9CiAKICAgICBjYXNlIFhFTl9ET01DVExfc29m
dF9yZXNldDoKKyAgICBjYXNlIFhFTl9ET01DVExfc29mdF9yZXNldF9jb250
OgogICAgICAgICBpZiAoIGQgPT0gY3VycmVudC0+ZG9tYWluICkgLyogbm8g
ZG9tYWluX3BhdXNlKCkgKi8KICAgICAgICAgewogICAgICAgICAgICAgcmV0
ID0gLUVJTlZBTDsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9Ci0g
ICAgICAgIHJldCA9IGRvbWFpbl9zb2Z0X3Jlc2V0KGQpOworICAgICAgICBy
ZXQgPSBkb21haW5fc29mdF9yZXNldChkLCBvcC0+Y21kID09IFhFTl9ET01D
VExfc29mdF9yZXNldF9jb250KTsKKyAgICAgICAgaWYgKCByZXQgPT0gLUVS
RVNUQVJUICkKKyAgICAgICAgeworICAgICAgICAgICAgb3AtPmNtZCA9IFhF
Tl9ET01DVExfc29mdF9yZXNldF9jb250OworICAgICAgICAgICAgaWYgKCAh
X19jb3B5X2ZpZWxkX3RvX2d1ZXN0KHVfZG9tY3RsLCBvcCwgY21kKSApCisg
ICAgICAgICAgICAgICAgcmV0ID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51
YXRpb24oX19IWVBFUlZJU09SX2RvbWN0bCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaCIsIHVfZG9t
Y3RsKTsKKyAgICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICByZXQg
PSAtRUZBVUxUOworICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogCiAgICAg
Y2FzZSBYRU5fRE9NQ1RMX2Rlc3Ryb3lkb21haW46Ci0tLSBhL3hlbi9jb21t
b24vZXZlbnRfY2hhbm5lbC5jCisrKyBiL3hlbi9jb21tb24vZXZlbnRfY2hh
bm5lbC5jCkBAIC0xMDUxLDcgKzEwNTEsNyBAQCBpbnQgZXZ0Y2huX3VubWFz
ayh1bnNpZ25lZCBpbnQgcG9ydCkKICAgICByZXR1cm4gMDsKIH0KIAotaW50
IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50IGV2dGNobl9y
ZXNldChzdHJ1Y3QgZG9tYWluICpkLCBib29sIHJlc3VtaW5nKQogewogICAg
IHVuc2lnbmVkIGludCBpOwogICAgIGludCByYyA9IDA7CkBAIC0xMDU5LDEx
ICsxMDU5LDQwIEBAIGludCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAq
ZCkKICAgICBpZiAoIGQgIT0gY3VycmVudC0+ZG9tYWluICYmICFkLT5jb250
cm9sbGVyX3BhdXNlX2NvdW50ICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
CiAKLSAgICBmb3IgKCBpID0gMDsgcG9ydF9pc192YWxpZChkLCBpKTsgaSsr
ICkKKyAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgLyoK
KyAgICAgKiBJZiB3ZSBhcmUgcmVzdW1pbmcsIHRoZW4gc3RhcnQgd2hlcmUg
d2Ugc3RvcHBlZC4gT3RoZXJ3aXNlLCBjaGVjaworICAgICAqIHRoYXQgYSBy
ZXNldCBvcGVyYXRpb24gaXMgbm90IGFscmVhZHkgaW4gcHJvZ3Jlc3MsIGFu
ZCBpZiBub25lIGlzLAorICAgICAqIHJlY29yZCB0aGF0IHRoaXMgaXMgbm93
IHRoZSBjYXNlLgorICAgICAqLworICAgIGkgPSByZXN1bWluZyA/IGQtPm5l
eHRfZXZ0Y2huIDogIWQtPm5leHRfZXZ0Y2huOworICAgIGlmICggaSA+IGQt
Pm5leHRfZXZ0Y2huICkKKyAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOwor
CisgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgaWYg
KCAhaSApCisgICAgICAgIHJldHVybiAtRUJVU1k7CisKKyAgICBmb3IgKCA7
IHBvcnRfaXNfdmFsaWQoZCwgaSk7IGkrKyApCisgICAgewogICAgICAgICBl
dnRjaG5fY2xvc2UoZCwgaSwgMSk7CiAKKyAgICAgICAgLyogTkI6IENob2lj
ZSBvZiBmcmVxdWVuY3kgaXMgYXJiaXRyYXJ5LiAqLworICAgICAgICBpZiAo
ICEoaSAmIDB4M2YpICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQor
ICAgICAgICB7CisgICAgICAgICAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xv
Y2spOworICAgICAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOworICAgICAg
ICAgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworICAgICAgICAg
ICAgcmV0dXJuIC1FUkVTVEFSVDsKKyAgICAgICAgfQorICAgIH0KKwogICAg
IHNwaW5fbG9jaygmZC0+ZXZlbnRfbG9jayk7CiAKKyAgICBkLT5uZXh0X2V2
dGNobiA9IDA7CisKICAgICBpZiAoIGQtPmFjdGl2ZV9ldnRjaG5zID4gZC0+
eGVuX2V2dGNobnMgKQogICAgICAgICByYyA9IC1FQUdBSU47CiAgICAgZWxz
ZSBpZiAoIGQtPmV2dGNobl9maWZvICkKQEAgLTExOTgsNyArMTIyNyw4IEBA
IGxvbmcgZG9fZXZlbnRfY2hhbm5lbF9vcChpbnQgY21kLCBYRU5fR1UKICAg
ICAgICAgYnJlYWs7CiAgICAgfQogCi0gICAgY2FzZSBFVlRDSE5PUF9yZXNl
dDogeworICAgIGNhc2UgRVZUQ0hOT1BfcmVzZXQ6CisgICAgY2FzZSBFVlRD
SE5PUF9yZXNldF9jb250OiB7CiAgICAgICAgIHN0cnVjdCBldnRjaG5fcmVz
ZXQgcmVzZXQ7CiAgICAgICAgIHN0cnVjdCBkb21haW4gKmQ7CiAKQEAgLTEy
MTEsOSArMTI0MSwxMyBAQCBsb25nIGRvX2V2ZW50X2NoYW5uZWxfb3AoaW50
IGNtZCwgWEVOX0dVCiAKICAgICAgICAgcmMgPSB4c21fZXZ0Y2huX3Jlc2V0
KFhTTV9UQVJHRVQsIGN1cnJlbnQtPmRvbWFpbiwgZCk7CiAgICAgICAgIGlm
ICggIXJjICkKLSAgICAgICAgICAgIHJjID0gZXZ0Y2huX3Jlc2V0KGQpOwor
ICAgICAgICAgICAgcmMgPSBldnRjaG5fcmVzZXQoZCwgY21kID09IEVWVENI
Tk9QX3Jlc2V0X2NvbnQpOwogCiAgICAgICAgIHJjdV91bmxvY2tfZG9tYWlu
KGQpOworCisgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKKyAgICAg
ICAgICAgIHJjID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51YXRpb24oX19I
WVBFUlZJU09SX2V2ZW50X2NoYW5uZWxfb3AsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpaCIsIEVWVENITk9Q
X3Jlc2V0X2NvbnQsIGFyZyk7CiAgICAgICAgIGJyZWFrOwogICAgIH0KIAot
LS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvZG9tY3RsLmgKKysrIGIveGVuL2lu
Y2x1ZGUvcHVibGljL2RvbWN0bC5oCkBAIC0xMTIxLDcgKzExMjEsMTAgQEAg
c3RydWN0IHhlbl9kb21jdGwgewogI2RlZmluZSBYRU5fRE9NQ1RMX2lvbWVt
X3Blcm1pc3Npb24gICAgICAgICAgICAgIDIwCiAjZGVmaW5lIFhFTl9ET01D
VExfaW9wb3J0X3Blcm1pc3Npb24gICAgICAgICAgICAgMjEKICNkZWZpbmUg
WEVOX0RPTUNUTF9oeXBlcmNhbGxfaW5pdCAgICAgICAgICAgICAgICAyMgot
I2RlZmluZSBYRU5fRE9NQ1RMX2FyY2hfc2V0dXAgICAgICAgICAgICAgICAg
ICAgIDIzIC8qIE9ic29sZXRlIElBNjQgb25seSAqLworI2lmZGVmIF9fWEVO
X18KKy8qICNkZWZpbmUgWEVOX0RPTUNUTF9hcmNoX3NldHVwICAgICAgICAg
ICAgICAgICAyMyBPYnNvbGV0ZSBJQTY0IG9ubHkgKi8KKyNkZWZpbmUgWEVO
X0RPTUNUTF9zb2Z0X3Jlc2V0X2NvbnQgICAgICAgICAgICAgICAyMworI2Vu
ZGlmCiAjZGVmaW5lIFhFTl9ET01DVExfc2V0dGltZW9mZnNldCAgICAgICAg
ICAgICAgICAgMjQKICNkZWZpbmUgWEVOX0RPTUNUTF9nZXR2Y3B1YWZmaW5p
dHkgICAgICAgICAgICAgICAyNQogI2RlZmluZSBYRU5fRE9NQ1RMX3JlYWxf
bW9kZV9hcmVhICAgICAgICAgICAgICAgIDI2IC8qIE9ic29sZXRlIFBQQyBv
bmx5ICovCi0tLSBhL3hlbi9pbmNsdWRlL3B1YmxpYy9ldmVudF9jaGFubmVs
LmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL2V2ZW50X2NoYW5uZWwuaApA
QCAtNzQsNiArNzQsOSBAQAogI2RlZmluZSBFVlRDSE5PUF9pbml0X2NvbnRy
b2wgICAgMTEKICNkZWZpbmUgRVZUQ0hOT1BfZXhwYW5kX2FycmF5ICAgIDEy
CiAjZGVmaW5lIEVWVENITk9QX3NldF9wcmlvcml0eSAgICAxMworI2lmZGVm
IF9fWEVOX18KKyNkZWZpbmUgRVZUQ0hOT1BfcmVzZXRfY29udCAgICAgIDE0
CisjZW5kaWYKIC8qIGAgfSAqLwogCiB0eXBlZGVmIHVpbnQzMl90IGV2dGNo
bl9wb3J0X3Q7Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCisrKyBi
L3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCkBAIC0xNjMsNyArMTYzLDcgQEAg
dm9pZCBldnRjaG5fY2hlY2tfcG9sbGVycyhzdHJ1Y3QgZG9tYWluCiB2b2lk
IGV2dGNobl8ybF9pbml0KHN0cnVjdCBkb21haW4gKmQpOwogCiAvKiBDbG9z
ZSBhbGwgZXZlbnQgY2hhbm5lbHMgYW5kIHJlc2V0IHRvIDItbGV2ZWwgQUJJ
LiAqLwotaW50IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKTsKK2lu
dCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAqZCwgYm9vbCByZXN1bWlu
Zyk7CiAKIC8qCiAgKiBMb3ctbGV2ZWwgZXZlbnQgY2hhbm5lbCBwb3J0IG9w
cy4KLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmgKQEAgLTM1NSw2ICszNTUsOCBAQCBzdHJ1Y3Qg
ZG9tYWluCiAgICAgICogRVZUQ0hOT1BfcmVzZXQpLiAgUmVhZC93cml0ZSBh
Y2Nlc3MgbGlrZSBmb3IgYWN0aXZlX2V2dGNobnMuCiAgICAgICovCiAgICAg
dW5zaWduZWQgaW50ICAgICB4ZW5fZXZ0Y2huczsKKyAgICAvKiBQb3J0IHRv
IHJlc3VtZSBmcm9tIGluIGV2dGNobl9yZXNldCgpLCB3aGVuIGluIGEgY29u
dGludWF0aW9uLiAqLworICAgIHVuc2lnbmVkIGludCAgICAgbmV4dF9ldnRj
aG47CiAgICAgc3BpbmxvY2tfdCAgICAgICBldmVudF9sb2NrOwogICAgIGNv
bnN0IHN0cnVjdCBldnRjaG5fcG9ydF9vcHMgKmV2dGNobl9wb3J0X29wczsK
ICAgICBzdHJ1Y3QgZXZ0Y2huX2ZpZm9fZG9tYWluICpldnRjaG5fZmlmbzsK
QEAgLTYwOCw3ICs2MTAsNyBAQCBpbnQgZG9tYWluX3NodXRkb3duKHN0cnVj
dCBkb21haW4gKmQsIHU4CiB2b2lkIGRvbWFpbl9yZXN1bWUoc3RydWN0IGRv
bWFpbiAqZCk7CiB2b2lkIGRvbWFpbl9wYXVzZV9mb3JfZGVidWdnZXIodm9p
ZCk7CiAKLWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpk
KTsKK2ludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkLCBi
b29sIHJlc3VtaW5nKTsKIAogaW50IHZjcHVfc3RhcnRfc2h1dGRvd25fZGVm
ZXJyYWwoc3RydWN0IHZjcHUgKnYpOwogdm9pZCB2Y3B1X2VuZF9zaHV0ZG93
bl9kZWZlcnJhbChzdHJ1Y3QgdmNwdSAqdik7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.12-1.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.12-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX2Rl
c3Ryb3koKQoKRXNwZWNpYWxseSBjbG9zaW5nIG9mIGZ1bGx5IGVzdGFibGlz
aGVkIGludGVyZG9tYWluIGNoYW5uZWxzIGNhbiB0YWtlCnF1aXRlIHNvbWUg
dGltZSwgZHVlIHRvIHRoZSBsb2NraW5nIGludm9sdmVkLiBUaGVyZWZvcmUg
d2Ugc2hvdWxkbid0CmFzc3VtZSB3ZSBjYW4gY2xlYW4gdXAgc3RpbGwgYWN0
aXZlIHBvcnRzIGFsbCBpbiBvbmUgZ28uIEJlc2lkZXMgYWRkaW5nCnRoZSBu
ZWNlc3NhcnkgcHJlZW1wdGlvbiBjaGVjaywgYWxzbyBhdm9pZCBwb2ludGxl
c3NseSBzdGFydGluZyBmcm9tCihvciBub3cgcmVhbGx5IGVuZGluZyBhdCkg
MDsgMSBpcyB0aGUgbG93ZXN0IG51bWJlcmVkIHBvcnQgd2hpY2ggbWF5Cm5l
ZWQgY2xvc2luZy4KClNpbmNlIHdlJ3JlIG5vdyByZWR1Y2luZyAtPnZhbGlk
X2V2dGNobnMsIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoKSwKYW5kIChhdCBs
ZWFzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlKSBub3RpZnlfdmlhX3hlbl9l
dmVudF9jaGFubmVsKCkKbmVlZCB0byBjb3BlIHdpdGggYXR0ZW1wdHMgdG8g
Y2xvc2UgLyB1bmJpbmQgZnJvbSAvIHNlbmQgdGhyb3VnaCBhbHJlYWR5CmNs
b3NlZCAoYW5kIG5vIGxvbmdlciB2YWxpZCwgYXMgcGVyIHBvcnRfaXNfdmFs
aWQoKSkgcG9ydHMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NC4KClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQWNr
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmll
d2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5l
bC5vcmc+CgotLS0gYS94ZW4vY29tbW9uL2RvbWFpbi5jCisrKyBiL3hlbi9j
b21tb24vZG9tYWluLmMKQEAgLTcyNCw3ICs3MjQsNiBAQCBpbnQgZG9tYWlu
X2tpbGwoc3RydWN0IGRvbWFpbiAqZCkKICAgICAgICAgICAgIHJldHVybiBk
b21haW5fa2lsbChkKTsKICAgICAgICAgZC0+aXNfZHlpbmcgPSBET01EWUlO
R19keWluZzsKICAgICAgICAgYXJnb19kZXN0cm95KGQpOwotICAgICAgICBl
dnRjaG5fZGVzdHJveShkKTsKICAgICAgICAgZ250dGFiX3JlbGVhc2VfbWFw
cGluZ3MoZCk7CiAgICAgICAgIHRtZW1fZGVzdHJveShkLT50bWVtX2NsaWVu
dCk7CiAgICAgICAgIHZudW1hX2Rlc3Ryb3koZC0+dm51bWEpOwpAQCAtNzMy
LDYgKzczMSw5IEBAIGludCBkb21haW5fa2lsbChzdHJ1Y3QgZG9tYWluICpk
KQogICAgICAgICBkLT50bWVtX2NsaWVudCA9IE5VTEw7CiAgICAgICAgIC8q
IGZhbGx0aHJvdWdoICovCiAgICAgY2FzZSBET01EWUlOR19keWluZzoKKyAg
ICAgICAgcmMgPSBldnRjaG5fZGVzdHJveShkKTsKKyAgICAgICAgaWYgKCBy
YyApCisgICAgICAgICAgICBicmVhazsKICAgICAgICAgcmMgPSBkb21haW5f
cmVsaW5xdWlzaF9yZXNvdXJjZXMoZCk7CiAgICAgICAgIGlmICggcmMgIT0g
MCApCiAgICAgICAgICAgICBicmVhazsKLS0tIGEveGVuL2NvbW1vbi9ldmVu
dF9jaGFubmVsLmMKKysrIGIveGVuL2NvbW1vbi9ldmVudF9jaGFubmVsLmMK
QEAgLTEyOTcsNyArMTI5NywxNiBAQCBpbnQgYWxsb2NfdW5ib3VuZF94ZW5f
ZXZlbnRfY2hhbm5lbCgKIAogdm9pZCBmcmVlX3hlbl9ldmVudF9jaGFubmVs
KHN0cnVjdCBkb21haW4gKmQsIGludCBwb3J0KQogewotICAgIEJVR19PTigh
cG9ydF9pc192YWxpZChkLCBwb3J0KSk7CisgICAgaWYgKCAhcG9ydF9pc192
YWxpZChkLCBwb3J0KSApCisgICAgeworICAgICAgICAvKgorICAgICAgICAg
KiBNYWtlIHN1cmUgLT5pc19keWluZyBpcyByZWFkIC9hZnRlci8gLT52YWxp
ZF9ldnRjaG5zLCBwYWlyaW5nCisgICAgICAgICAqIHdpdGggdGhlIHNwaW5f
YmFycmllcigpIGFuZCBCVUdfT04oKSBpbiBldnRjaG5fZGVzdHJveSgpLgor
ICAgICAgICAgKi8KKyAgICAgICAgc21wX3JtYigpOworICAgICAgICBCVUdf
T04oIWQtPmlzX2R5aW5nKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KIAog
ICAgIGV2dGNobl9jbG9zZShkLCBwb3J0LCAwKTsKIH0KQEAgLTEzMDksNyAr
MTMxOCwxNyBAQCB2b2lkIG5vdGlmeV92aWFfeGVuX2V2ZW50X2NoYW5uZWwo
c3RydWN0CiAgICAgc3RydWN0IGRvbWFpbiAqcmQ7CiAgICAgdW5zaWduZWQg
bG9uZyBmbGFnczsKIAotICAgIEFTU0VSVChwb3J0X2lzX3ZhbGlkKGxkLCBs
cG9ydCkpOworICAgIGlmICggIXBvcnRfaXNfdmFsaWQobGQsIGxwb3J0KSAp
CisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBNYWtlIHN1cmUgLT5p
c19keWluZyBpcyByZWFkIC9hZnRlci8gLT52YWxpZF9ldnRjaG5zLCBwYWly
aW5nCisgICAgICAgICAqIHdpdGggdGhlIHNwaW5fYmFycmllcigpIGFuZCBC
VUdfT04oKSBpbiBldnRjaG5fZGVzdHJveSgpLgorICAgICAgICAgKi8KKyAg
ICAgICAgc21wX3JtYigpOworICAgICAgICBBU1NFUlQobGQtPmlzX2R5aW5n
KTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKwogICAgIGxjaG4gPSBldnRj
aG5fZnJvbV9wb3J0KGxkLCBscG9ydCk7CiAKICAgICBzcGluX2xvY2tfaXJx
c2F2ZSgmbGNobi0+bG9jaywgZmxhZ3MpOwpAQCAtMTM4MCw4ICsxMzk5LDcg
QEAgaW50IGV2dGNobl9pbml0KHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbgog
ICAgIHJldHVybiAwOwogfQogCi0KLXZvaWQgZXZ0Y2huX2Rlc3Ryb3koc3Ry
dWN0IGRvbWFpbiAqZCkKK2ludCBldnRjaG5fZGVzdHJveShzdHJ1Y3QgZG9t
YWluICpkKQogewogICAgIHVuc2lnbmVkIGludCBpOwogCkBAIC0xMzkwLDE0
ICsxNDA4LDI5IEBAIHZvaWQgZXZ0Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFp
biAqZCkKICAgICBzcGluX2JhcnJpZXIoJmQtPmV2ZW50X2xvY2spOwogCiAg
ICAgLyogQ2xvc2UgYWxsIGV4aXN0aW5nIGV2ZW50IGNoYW5uZWxzLiAqLwot
ICAgIGZvciAoIGkgPSAwOyBwb3J0X2lzX3ZhbGlkKGQsIGkpOyBpKysgKQor
ICAgIGZvciAoIGkgPSBkLT52YWxpZF9ldnRjaG5zOyAtLWk7ICkKKyAgICB7
CiAgICAgICAgIGV2dGNobl9jbG9zZShkLCBpLCAwKTsKIAorICAgICAgICAv
KgorICAgICAgICAgKiBBdm9pZCBwcmVlbXB0aW5nIHdoZW4gY2FsbGVkIGZy
b20gZG9tYWluX2NyZWF0ZSgpJ3MgZXJyb3IgcGF0aCwKKyAgICAgICAgICog
YW5kIGRvbid0IGNoZWNrIHRvbyBvZnRlbiAoY2hvaWNlIG9mIGZyZXF1ZW5j
eSBpcyBhcmJpdHJhcnkpLgorICAgICAgICAgKi8KKyAgICAgICAgaWYgKCBp
ICYmICEoaSAmIDB4M2YpICYmIGQtPmlzX2R5aW5nICE9IERPTURZSU5HX2Rl
YWQgJiYKKyAgICAgICAgICAgICBoeXBlcmNhbGxfcHJlZW1wdF9jaGVjaygp
ICkKKyAgICAgICAgeworICAgICAgICAgICAgd3JpdGVfYXRvbWljKCZkLT52
YWxpZF9ldnRjaG5zLCBpKTsKKyAgICAgICAgICAgIHJldHVybiAtRVJFU1RB
UlQ7CisgICAgICAgIH0KKyAgICB9CisKICAgICBBU1NFUlQoIWQtPmFjdGl2
ZV9ldnRjaG5zKTsKIAogICAgIGNsZWFyX2dsb2JhbF92aXJxX2hhbmRsZXJz
KGQpOwogCiAgICAgZXZ0Y2huX2ZpZm9fZGVzdHJveShkKTsKKworICAgIHJl
dHVybiAwOwogfQogCiAKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgK
KysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKQEAgLTEzNiw3ICsxMzYs
NyBAQCBzdHJ1Y3QgZXZ0Y2huCiB9IF9fYXR0cmlidXRlX18oKGFsaWduZWQo
NjQpKSk7CiAKIGludCAgZXZ0Y2huX2luaXQoc3RydWN0IGRvbWFpbiAqZCwg
dW5zaWduZWQgaW50IG1heF9wb3J0KTsKLXZvaWQgZXZ0Y2huX2Rlc3Ryb3ko
c3RydWN0IGRvbWFpbiAqZCk7IC8qIGZyb20gZG9tYWluX2tpbGwgKi8KK2lu
dCAgZXZ0Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCk7IC8qIGZyb20g
ZG9tYWluX2tpbGwgKi8KIHZvaWQgZXZ0Y2huX2Rlc3Ryb3lfZmluYWwoc3Ry
dWN0IGRvbWFpbiAqZCk7IC8qIGZyb20gY29tcGxldGVfZG9tYWluX2Rlc3Ry
b3kgKi8KIAogc3RydWN0IHdhaXRxdWV1ZV92Y3B1Owo=

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.12-2.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.12-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX3Jl
c2V0KCkKCkxpa2UgZm9yIGV2dGNobl9kZXN0cm95KCkgbG9vcGluZyBvdmVy
IGFsbCBwb3NzaWJsZSBldmVudCBjaGFubmVscyB0bwpjbG9zZSB0aGVtIGNh
biB0YWtlIGEgc2lnbmlmaWNhbnQgYW1vdW50IG9mIHRpbWUuIFVubGlrZSBk
b25lIHRoZXJlLCB3ZQpjYW4ndCBhbHRlciBkb21haW4gcHJvcGVydGllcyAo
aS5lLiBkLT52YWxpZF9ldnRjaG5zKSBoZXJlLiBCb3Jyb3csIGluIGEKbGln
aHR3ZWlnaHQgZm9ybSwgdGhlIHBhZ2luZyBkb21jdGwgY29udGludWF0aW9u
IGNvbmNlcHQsIHJlZGlyZWN0aW5nCnRoZSBjb250aW51YXRpb25zIHRvIGRp
ZmZlcmVudCBzdWItb3BzLiBKdXN0IGxpa2UgdGhlcmUgdGhpcyBpcyB0byBi
ZQphYmxlIHRvIGFsbG93IGZvciBwcmVkaWN0YWJsZSBvdmVyYWxsIHJlc3Vs
dHMgb2YgdGhlIGludm9sdmVkIHN1Yi1vcHM6ClJhY2luZyByZXF1ZXN0cyBz
aG91bGQgZWl0aGVyIGNvbXBsZXRlIG9yIGJlIHJlZnVzZWQuCgpOb3RlIHRo
YXQgYSBkb21haW4gY2FuJ3QgaW50ZXJmZXJlIHdpdGggYW4gYWxyZWFkeSBz
dGFydGVkIChieSBhIHJlbW90ZQpkb21haW4pIHJlc2V0LCBkdWUgdG8gYmVp
bmcgcGF1c2VkLiBJdCBjYW4gcHJldmVudCBhIHJlbW90ZSByZXNldCBmcm9t
CmhhcHBlbmluZyBieSBsZWF2aW5nIGEgcmVzZXQgdW5maW5pc2hlZCwgYnV0
IHRoYXQncyBvbmx5IGdvaW5nIHRvIGFmZmVjdAppdHNlbGYuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNo
IDxqYmV1bGljaEBzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJl
bGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CgotLS0gYS94ZW4vY29t
bW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTEx
NzAsNyArMTE3MCw3IEBAIHZvaWQgZG9tYWluX3VucGF1c2VfZXhjZXB0X3Nl
bGYoc3RydWN0IGQKICAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7CiB9CiAK
LWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50
IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVjdCBkb21haW4gKmQsIGJvb2wgcmVz
dW1pbmcpCiB7CiAgICAgc3RydWN0IHZjcHUgKnY7CiAgICAgaW50IHJjOwpA
QCAtMTE4NCw3ICsxMTg0LDcgQEAgaW50IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0
cnVjdCBkb21haW4gKmQpCiAgICAgICAgIH0KICAgICBzcGluX3VubG9jaygm
ZC0+c2h1dGRvd25fbG9jayk7CiAKLSAgICByYyA9IGV2dGNobl9yZXNldChk
KTsKKyAgICByYyA9IGV2dGNobl9yZXNldChkLCByZXN1bWluZyk7CiAgICAg
aWYgKCByYyApCiAgICAgICAgIHJldHVybiByYzsKIAotLS0gYS94ZW4vY29t
bW9uL2RvbWN0bC5jCisrKyBiL3hlbi9jb21tb24vZG9tY3RsLmMKQEAgLTU4
NSwxMiArNTg1LDIyIEBAIGxvbmcgZG9fZG9tY3RsKFhFTl9HVUVTVF9IQU5E
TEVfUEFSQU0oeGUKICAgICB9CiAKICAgICBjYXNlIFhFTl9ET01DVExfc29m
dF9yZXNldDoKKyAgICBjYXNlIFhFTl9ET01DVExfc29mdF9yZXNldF9jb250
OgogICAgICAgICBpZiAoIGQgPT0gY3VycmVudC0+ZG9tYWluICkgLyogbm8g
ZG9tYWluX3BhdXNlKCkgKi8KICAgICAgICAgewogICAgICAgICAgICAgcmV0
ID0gLUVJTlZBTDsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9Ci0g
ICAgICAgIHJldCA9IGRvbWFpbl9zb2Z0X3Jlc2V0KGQpOworICAgICAgICBy
ZXQgPSBkb21haW5fc29mdF9yZXNldChkLCBvcC0+Y21kID09IFhFTl9ET01D
VExfc29mdF9yZXNldF9jb250KTsKKyAgICAgICAgaWYgKCByZXQgPT0gLUVS
RVNUQVJUICkKKyAgICAgICAgeworICAgICAgICAgICAgb3AtPmNtZCA9IFhF
Tl9ET01DVExfc29mdF9yZXNldF9jb250OworICAgICAgICAgICAgaWYgKCAh
X19jb3B5X2ZpZWxkX3RvX2d1ZXN0KHVfZG9tY3RsLCBvcCwgY21kKSApCisg
ICAgICAgICAgICAgICAgcmV0ID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51
YXRpb24oX19IWVBFUlZJU09SX2RvbWN0bCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaCIsIHVfZG9t
Y3RsKTsKKyAgICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICByZXQg
PSAtRUZBVUxUOworICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogCiAgICAg
Y2FzZSBYRU5fRE9NQ1RMX2Rlc3Ryb3lkb21haW46Ci0tLSBhL3hlbi9jb21t
b24vZXZlbnRfY2hhbm5lbC5jCisrKyBiL3hlbi9jb21tb24vZXZlbnRfY2hh
bm5lbC5jCkBAIC0xMDU3LDcgKzEwNTcsNyBAQCBpbnQgZXZ0Y2huX3VubWFz
ayh1bnNpZ25lZCBpbnQgcG9ydCkKICAgICByZXR1cm4gMDsKIH0KIAotaW50
IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50IGV2dGNobl9y
ZXNldChzdHJ1Y3QgZG9tYWluICpkLCBib29sIHJlc3VtaW5nKQogewogICAg
IHVuc2lnbmVkIGludCBpOwogICAgIGludCByYyA9IDA7CkBAIC0xMDY1LDEx
ICsxMDY1LDQwIEBAIGludCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAq
ZCkKICAgICBpZiAoIGQgIT0gY3VycmVudC0+ZG9tYWluICYmICFkLT5jb250
cm9sbGVyX3BhdXNlX2NvdW50ICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
CiAKLSAgICBmb3IgKCBpID0gMDsgcG9ydF9pc192YWxpZChkLCBpKTsgaSsr
ICkKKyAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgLyoK
KyAgICAgKiBJZiB3ZSBhcmUgcmVzdW1pbmcsIHRoZW4gc3RhcnQgd2hlcmUg
d2Ugc3RvcHBlZC4gT3RoZXJ3aXNlLCBjaGVjaworICAgICAqIHRoYXQgYSBy
ZXNldCBvcGVyYXRpb24gaXMgbm90IGFscmVhZHkgaW4gcHJvZ3Jlc3MsIGFu
ZCBpZiBub25lIGlzLAorICAgICAqIHJlY29yZCB0aGF0IHRoaXMgaXMgbm93
IHRoZSBjYXNlLgorICAgICAqLworICAgIGkgPSByZXN1bWluZyA/IGQtPm5l
eHRfZXZ0Y2huIDogIWQtPm5leHRfZXZ0Y2huOworICAgIGlmICggaSA+IGQt
Pm5leHRfZXZ0Y2huICkKKyAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOwor
CisgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgaWYg
KCAhaSApCisgICAgICAgIHJldHVybiAtRUJVU1k7CisKKyAgICBmb3IgKCA7
IHBvcnRfaXNfdmFsaWQoZCwgaSk7IGkrKyApCisgICAgewogICAgICAgICBl
dnRjaG5fY2xvc2UoZCwgaSwgMSk7CiAKKyAgICAgICAgLyogTkI6IENob2lj
ZSBvZiBmcmVxdWVuY3kgaXMgYXJiaXRyYXJ5LiAqLworICAgICAgICBpZiAo
ICEoaSAmIDB4M2YpICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQor
ICAgICAgICB7CisgICAgICAgICAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xv
Y2spOworICAgICAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOworICAgICAg
ICAgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworICAgICAgICAg
ICAgcmV0dXJuIC1FUkVTVEFSVDsKKyAgICAgICAgfQorICAgIH0KKwogICAg
IHNwaW5fbG9jaygmZC0+ZXZlbnRfbG9jayk7CiAKKyAgICBkLT5uZXh0X2V2
dGNobiA9IDA7CisKICAgICBpZiAoIGQtPmFjdGl2ZV9ldnRjaG5zID4gZC0+
eGVuX2V2dGNobnMgKQogICAgICAgICByYyA9IC1FQUdBSU47CiAgICAgZWxz
ZSBpZiAoIGQtPmV2dGNobl9maWZvICkKQEAgLTEyMDQsNyArMTIzMyw4IEBA
IGxvbmcgZG9fZXZlbnRfY2hhbm5lbF9vcChpbnQgY21kLCBYRU5fR1UKICAg
ICAgICAgYnJlYWs7CiAgICAgfQogCi0gICAgY2FzZSBFVlRDSE5PUF9yZXNl
dDogeworICAgIGNhc2UgRVZUQ0hOT1BfcmVzZXQ6CisgICAgY2FzZSBFVlRD
SE5PUF9yZXNldF9jb250OiB7CiAgICAgICAgIHN0cnVjdCBldnRjaG5fcmVz
ZXQgcmVzZXQ7CiAgICAgICAgIHN0cnVjdCBkb21haW4gKmQ7CiAKQEAgLTEy
MTcsOSArMTI0NywxMyBAQCBsb25nIGRvX2V2ZW50X2NoYW5uZWxfb3AoaW50
IGNtZCwgWEVOX0dVCiAKICAgICAgICAgcmMgPSB4c21fZXZ0Y2huX3Jlc2V0
KFhTTV9UQVJHRVQsIGN1cnJlbnQtPmRvbWFpbiwgZCk7CiAgICAgICAgIGlm
ICggIXJjICkKLSAgICAgICAgICAgIHJjID0gZXZ0Y2huX3Jlc2V0KGQpOwor
ICAgICAgICAgICAgcmMgPSBldnRjaG5fcmVzZXQoZCwgY21kID09IEVWVENI
Tk9QX3Jlc2V0X2NvbnQpOwogCiAgICAgICAgIHJjdV91bmxvY2tfZG9tYWlu
KGQpOworCisgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKKyAgICAg
ICAgICAgIHJjID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51YXRpb24oX19I
WVBFUlZJU09SX2V2ZW50X2NoYW5uZWxfb3AsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpaCIsIEVWVENITk9Q
X3Jlc2V0X2NvbnQsIGFyZyk7CiAgICAgICAgIGJyZWFrOwogICAgIH0KIAot
LS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvZG9tY3RsLmgKKysrIGIveGVuL2lu
Y2x1ZGUvcHVibGljL2RvbWN0bC5oCkBAIC0xMTQ0LDcgKzExNDQsMTAgQEAg
c3RydWN0IHhlbl9kb21jdGwgewogI2RlZmluZSBYRU5fRE9NQ1RMX2lvbWVt
X3Blcm1pc3Npb24gICAgICAgICAgICAgIDIwCiAjZGVmaW5lIFhFTl9ET01D
VExfaW9wb3J0X3Blcm1pc3Npb24gICAgICAgICAgICAgMjEKICNkZWZpbmUg
WEVOX0RPTUNUTF9oeXBlcmNhbGxfaW5pdCAgICAgICAgICAgICAgICAyMgot
I2RlZmluZSBYRU5fRE9NQ1RMX2FyY2hfc2V0dXAgICAgICAgICAgICAgICAg
ICAgIDIzIC8qIE9ic29sZXRlIElBNjQgb25seSAqLworI2lmZGVmIF9fWEVO
X18KKy8qICNkZWZpbmUgWEVOX0RPTUNUTF9hcmNoX3NldHVwICAgICAgICAg
ICAgICAgICAyMyBPYnNvbGV0ZSBJQTY0IG9ubHkgKi8KKyNkZWZpbmUgWEVO
X0RPTUNUTF9zb2Z0X3Jlc2V0X2NvbnQgICAgICAgICAgICAgICAyMworI2Vu
ZGlmCiAjZGVmaW5lIFhFTl9ET01DVExfc2V0dGltZW9mZnNldCAgICAgICAg
ICAgICAgICAgMjQKICNkZWZpbmUgWEVOX0RPTUNUTF9nZXR2Y3B1YWZmaW5p
dHkgICAgICAgICAgICAgICAyNQogI2RlZmluZSBYRU5fRE9NQ1RMX3JlYWxf
bW9kZV9hcmVhICAgICAgICAgICAgICAgIDI2IC8qIE9ic29sZXRlIFBQQyBv
bmx5ICovCi0tLSBhL3hlbi9pbmNsdWRlL3B1YmxpYy9ldmVudF9jaGFubmVs
LmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL2V2ZW50X2NoYW5uZWwuaApA
QCAtNzQsNiArNzQsOSBAQAogI2RlZmluZSBFVlRDSE5PUF9pbml0X2NvbnRy
b2wgICAgMTEKICNkZWZpbmUgRVZUQ0hOT1BfZXhwYW5kX2FycmF5ICAgIDEy
CiAjZGVmaW5lIEVWVENITk9QX3NldF9wcmlvcml0eSAgICAxMworI2lmZGVm
IF9fWEVOX18KKyNkZWZpbmUgRVZUQ0hOT1BfcmVzZXRfY29udCAgICAgIDE0
CisjZW5kaWYKIC8qIGAgfSAqLwogCiB0eXBlZGVmIHVpbnQzMl90IGV2dGNo
bl9wb3J0X3Q7Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCisrKyBi
L3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCkBAIC0xNzEsNyArMTcxLDcgQEAg
dm9pZCBldnRjaG5fY2hlY2tfcG9sbGVycyhzdHJ1Y3QgZG9tYWluCiB2b2lk
IGV2dGNobl8ybF9pbml0KHN0cnVjdCBkb21haW4gKmQpOwogCiAvKiBDbG9z
ZSBhbGwgZXZlbnQgY2hhbm5lbHMgYW5kIHJlc2V0IHRvIDItbGV2ZWwgQUJJ
LiAqLwotaW50IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKTsKK2lu
dCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAqZCwgYm9vbCByZXN1bWlu
Zyk7CiAKIC8qCiAgKiBMb3ctbGV2ZWwgZXZlbnQgY2hhbm5lbCBwb3J0IG9w
cy4KLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmgKQEAgLTM1Niw2ICszNTYsOCBAQCBzdHJ1Y3Qg
ZG9tYWluCiAgICAgICogRVZUQ0hOT1BfcmVzZXQpLiAgUmVhZC93cml0ZSBh
Y2Nlc3MgbGlrZSBmb3IgYWN0aXZlX2V2dGNobnMuCiAgICAgICovCiAgICAg
dW5zaWduZWQgaW50ICAgICB4ZW5fZXZ0Y2huczsKKyAgICAvKiBQb3J0IHRv
IHJlc3VtZSBmcm9tIGluIGV2dGNobl9yZXNldCgpLCB3aGVuIGluIGEgY29u
dGludWF0aW9uLiAqLworICAgIHVuc2lnbmVkIGludCAgICAgbmV4dF9ldnRj
aG47CiAgICAgc3BpbmxvY2tfdCAgICAgICBldmVudF9sb2NrOwogICAgIGNv
bnN0IHN0cnVjdCBldnRjaG5fcG9ydF9vcHMgKmV2dGNobl9wb3J0X29wczsK
ICAgICBzdHJ1Y3QgZXZ0Y2huX2ZpZm9fZG9tYWluICpldnRjaG5fZmlmbzsK
QEAgLTYyOCw3ICs2MzAsNyBAQCBpbnQgZG9tYWluX3NodXRkb3duKHN0cnVj
dCBkb21haW4gKmQsIHU4CiB2b2lkIGRvbWFpbl9yZXN1bWUoc3RydWN0IGRv
bWFpbiAqZCk7CiB2b2lkIGRvbWFpbl9wYXVzZV9mb3JfZGVidWdnZXIodm9p
ZCk7CiAKLWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpk
KTsKK2ludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkLCBi
b29sIHJlc3VtaW5nKTsKIAogaW50IHZjcHVfc3RhcnRfc2h1dGRvd25fZGVm
ZXJyYWwoc3RydWN0IHZjcHUgKnYpOwogdm9pZCB2Y3B1X2VuZF9zaHV0ZG93
bl9kZWZlcnJhbChzdHJ1Y3QgdmNwdSAqdik7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.13-1.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.13-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX2Rl
c3Ryb3koKQoKRXNwZWNpYWxseSBjbG9zaW5nIG9mIGZ1bGx5IGVzdGFibGlz
aGVkIGludGVyZG9tYWluIGNoYW5uZWxzIGNhbiB0YWtlCnF1aXRlIHNvbWUg
dGltZSwgZHVlIHRvIHRoZSBsb2NraW5nIGludm9sdmVkLiBUaGVyZWZvcmUg
d2Ugc2hvdWxkbid0CmFzc3VtZSB3ZSBjYW4gY2xlYW4gdXAgc3RpbGwgYWN0
aXZlIHBvcnRzIGFsbCBpbiBvbmUgZ28uIEJlc2lkZXMgYWRkaW5nCnRoZSBu
ZWNlc3NhcnkgcHJlZW1wdGlvbiBjaGVjaywgYWxzbyBhdm9pZCBwb2ludGxl
c3NseSBzdGFydGluZyBmcm9tCihvciBub3cgcmVhbGx5IGVuZGluZyBhdCkg
MDsgMSBpcyB0aGUgbG93ZXN0IG51bWJlcmVkIHBvcnQgd2hpY2ggbWF5Cm5l
ZWQgY2xvc2luZy4KClNpbmNlIHdlJ3JlIG5vdyByZWR1Y2luZyAtPnZhbGlk
X2V2dGNobnMsIGZyZWVfeGVuX2V2ZW50X2NoYW5uZWwoKSwKYW5kIChhdCBs
ZWFzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlKSBub3RpZnlfdmlhX3hlbl9l
dmVudF9jaGFubmVsKCkKbmVlZCB0byBjb3BlIHdpdGggYXR0ZW1wdHMgdG8g
Y2xvc2UgLyB1bmJpbmQgZnJvbSAvIHNlbmQgdGhyb3VnaCBhbHJlYWR5CmNs
b3NlZCAoYW5kIG5vIGxvbmdlciB2YWxpZCwgYXMgcGVyIHBvcnRfaXNfdmFs
aWQoKSkgcG9ydHMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM0NC4KClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQWNr
ZWQtYnk6IEp1bGllbiBHcmFsbCA8amdyYWxsQGFtYXpvbi5jb20+ClJldmll
d2VkLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5l
bC5vcmc+CgotLS0gYS94ZW4vY29tbW9uL2RvbWFpbi5jCisrKyBiL3hlbi9j
b21tb24vZG9tYWluLmMKQEAgLTc3MCwxMiArNzcwLDE0IEBAIGludCBkb21h
aW5fa2lsbChzdHJ1Y3QgZG9tYWluICpkKQogICAgICAgICAgICAgcmV0dXJu
IGRvbWFpbl9raWxsKGQpOwogICAgICAgICBkLT5pc19keWluZyA9IERPTURZ
SU5HX2R5aW5nOwogICAgICAgICBhcmdvX2Rlc3Ryb3koZCk7Ci0gICAgICAg
IGV2dGNobl9kZXN0cm95KGQpOwogICAgICAgICBnbnR0YWJfcmVsZWFzZV9t
YXBwaW5ncyhkKTsKICAgICAgICAgdm51bWFfZGVzdHJveShkLT52bnVtYSk7
CiAgICAgICAgIGRvbWFpbl9zZXRfb3V0c3RhbmRpbmdfcGFnZXMoZCwgMCk7
CiAgICAgICAgIC8qIGZhbGx0aHJvdWdoICovCiAgICAgY2FzZSBET01EWUlO
R19keWluZzoKKyAgICAgICAgcmMgPSBldnRjaG5fZGVzdHJveShkKTsKKyAg
ICAgICAgaWYgKCByYyApCisgICAgICAgICAgICBicmVhazsKICAgICAgICAg
cmMgPSBkb21haW5fcmVsaW5xdWlzaF9yZXNvdXJjZXMoZCk7CiAgICAgICAg
IGlmICggcmMgIT0gMCApCiAgICAgICAgICAgICBicmVhazsKLS0tIGEveGVu
L2NvbW1vbi9ldmVudF9jaGFubmVsLmMKKysrIGIveGVuL2NvbW1vbi9ldmVu
dF9jaGFubmVsLmMKQEAgLTEyOTcsNyArMTI5NywxNiBAQCBpbnQgYWxsb2Nf
dW5ib3VuZF94ZW5fZXZlbnRfY2hhbm5lbCgKIAogdm9pZCBmcmVlX3hlbl9l
dmVudF9jaGFubmVsKHN0cnVjdCBkb21haW4gKmQsIGludCBwb3J0KQogewot
ICAgIEJVR19PTighcG9ydF9pc192YWxpZChkLCBwb3J0KSk7CisgICAgaWYg
KCAhcG9ydF9pc192YWxpZChkLCBwb3J0KSApCisgICAgeworICAgICAgICAv
KgorICAgICAgICAgKiBNYWtlIHN1cmUgLT5pc19keWluZyBpcyByZWFkIC9h
ZnRlci8gLT52YWxpZF9ldnRjaG5zLCBwYWlyaW5nCisgICAgICAgICAqIHdp
dGggdGhlIHNwaW5fYmFycmllcigpIGFuZCBCVUdfT04oKSBpbiBldnRjaG5f
ZGVzdHJveSgpLgorICAgICAgICAgKi8KKyAgICAgICAgc21wX3JtYigpOwor
ICAgICAgICBCVUdfT04oIWQtPmlzX2R5aW5nKTsKKyAgICAgICAgcmV0dXJu
OworICAgIH0KIAogICAgIGV2dGNobl9jbG9zZShkLCBwb3J0LCAwKTsKIH0K
QEAgLTEzMDksNyArMTMxOCwxNyBAQCB2b2lkIG5vdGlmeV92aWFfeGVuX2V2
ZW50X2NoYW5uZWwoc3RydWN0CiAgICAgc3RydWN0IGRvbWFpbiAqcmQ7CiAg
ICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIAotICAgIEFTU0VSVChwb3J0X2lz
X3ZhbGlkKGxkLCBscG9ydCkpOworICAgIGlmICggIXBvcnRfaXNfdmFsaWQo
bGQsIGxwb3J0KSApCisgICAgeworICAgICAgICAvKgorICAgICAgICAgKiBN
YWtlIHN1cmUgLT5pc19keWluZyBpcyByZWFkIC9hZnRlci8gLT52YWxpZF9l
dnRjaG5zLCBwYWlyaW5nCisgICAgICAgICAqIHdpdGggdGhlIHNwaW5fYmFy
cmllcigpIGFuZCBCVUdfT04oKSBpbiBldnRjaG5fZGVzdHJveSgpLgorICAg
ICAgICAgKi8KKyAgICAgICAgc21wX3JtYigpOworICAgICAgICBBU1NFUlQo
bGQtPmlzX2R5aW5nKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKwogICAg
IGxjaG4gPSBldnRjaG5fZnJvbV9wb3J0KGxkLCBscG9ydCk7CiAKICAgICBz
cGluX2xvY2tfaXJxc2F2ZSgmbGNobi0+bG9jaywgZmxhZ3MpOwpAQCAtMTM4
MCw4ICsxMzk5LDcgQEAgaW50IGV2dGNobl9pbml0KHN0cnVjdCBkb21haW4g
KmQsIHVuc2lnbgogICAgIHJldHVybiAwOwogfQogCi0KLXZvaWQgZXZ0Y2hu
X2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCkKK2ludCBldnRjaG5fZGVzdHJv
eShzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHVuc2lnbmVkIGludCBpOwog
CkBAIC0xMzkwLDE0ICsxNDA4LDI5IEBAIHZvaWQgZXZ0Y2huX2Rlc3Ryb3ko
c3RydWN0IGRvbWFpbiAqZCkKICAgICBzcGluX2JhcnJpZXIoJmQtPmV2ZW50
X2xvY2spOwogCiAgICAgLyogQ2xvc2UgYWxsIGV4aXN0aW5nIGV2ZW50IGNo
YW5uZWxzLiAqLwotICAgIGZvciAoIGkgPSAwOyBwb3J0X2lzX3ZhbGlkKGQs
IGkpOyBpKysgKQorICAgIGZvciAoIGkgPSBkLT52YWxpZF9ldnRjaG5zOyAt
LWk7ICkKKyAgICB7CiAgICAgICAgIGV2dGNobl9jbG9zZShkLCBpLCAwKTsK
IAorICAgICAgICAvKgorICAgICAgICAgKiBBdm9pZCBwcmVlbXB0aW5nIHdo
ZW4gY2FsbGVkIGZyb20gZG9tYWluX2NyZWF0ZSgpJ3MgZXJyb3IgcGF0aCwK
KyAgICAgICAgICogYW5kIGRvbid0IGNoZWNrIHRvbyBvZnRlbiAoY2hvaWNl
IG9mIGZyZXF1ZW5jeSBpcyBhcmJpdHJhcnkpLgorICAgICAgICAgKi8KKyAg
ICAgICAgaWYgKCBpICYmICEoaSAmIDB4M2YpICYmIGQtPmlzX2R5aW5nICE9
IERPTURZSU5HX2RlYWQgJiYKKyAgICAgICAgICAgICBoeXBlcmNhbGxfcHJl
ZW1wdF9jaGVjaygpICkKKyAgICAgICAgeworICAgICAgICAgICAgd3JpdGVf
YXRvbWljKCZkLT52YWxpZF9ldnRjaG5zLCBpKTsKKyAgICAgICAgICAgIHJl
dHVybiAtRVJFU1RBUlQ7CisgICAgICAgIH0KKyAgICB9CisKICAgICBBU1NF
UlQoIWQtPmFjdGl2ZV9ldnRjaG5zKTsKIAogICAgIGNsZWFyX2dsb2JhbF92
aXJxX2hhbmRsZXJzKGQpOwogCiAgICAgZXZ0Y2huX2ZpZm9fZGVzdHJveShk
KTsKKworICAgIHJldHVybiAwOwogfQogCiAKLS0tIGEveGVuL2luY2x1ZGUv
eGVuL3NjaGVkLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKQEAg
LTEzNiw3ICsxMzYsNyBAQCBzdHJ1Y3QgZXZ0Y2huCiB9IF9fYXR0cmlidXRl
X18oKGFsaWduZWQoNjQpKSk7CiAKIGludCAgZXZ0Y2huX2luaXQoc3RydWN0
IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IG1heF9wb3J0KTsKLXZvaWQgZXZ0
Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCk7IC8qIGZyb20gZG9tYWlu
X2tpbGwgKi8KK2ludCAgZXZ0Y2huX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAq
ZCk7IC8qIGZyb20gZG9tYWluX2tpbGwgKi8KIHZvaWQgZXZ0Y2huX2Rlc3Ry
b3lfZmluYWwoc3RydWN0IGRvbWFpbiAqZCk7IC8qIGZyb20gY29tcGxldGVf
ZG9tYWluX2Rlc3Ryb3kgKi8KIAogc3RydWN0IHdhaXRxdWV1ZV92Y3B1Owo=

--=separator
Content-Type: application/octet-stream; name="xsa344/xsa344-4.13-2.patch"
Content-Disposition: attachment; filename="xsa344/xsa344-4.13-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBldnRjaG46IGFycmFuZ2UgZm9yIHByZWVtcHRpb24gaW4gZXZ0Y2huX3Jl
c2V0KCkKCkxpa2UgZm9yIGV2dGNobl9kZXN0cm95KCkgbG9vcGluZyBvdmVy
IGFsbCBwb3NzaWJsZSBldmVudCBjaGFubmVscyB0bwpjbG9zZSB0aGVtIGNh
biB0YWtlIGEgc2lnbmlmaWNhbnQgYW1vdW50IG9mIHRpbWUuIFVubGlrZSBk
b25lIHRoZXJlLCB3ZQpjYW4ndCBhbHRlciBkb21haW4gcHJvcGVydGllcyAo
aS5lLiBkLT52YWxpZF9ldnRjaG5zKSBoZXJlLiBCb3Jyb3csIGluIGEKbGln
aHR3ZWlnaHQgZm9ybSwgdGhlIHBhZ2luZyBkb21jdGwgY29udGludWF0aW9u
IGNvbmNlcHQsIHJlZGlyZWN0aW5nCnRoZSBjb250aW51YXRpb25zIHRvIGRp
ZmZlcmVudCBzdWItb3BzLiBKdXN0IGxpa2UgdGhlcmUgdGhpcyBpcyB0byBi
ZQphYmxlIHRvIGFsbG93IGZvciBwcmVkaWN0YWJsZSBvdmVyYWxsIHJlc3Vs
dHMgb2YgdGhlIGludm9sdmVkIHN1Yi1vcHM6ClJhY2luZyByZXF1ZXN0cyBz
aG91bGQgZWl0aGVyIGNvbXBsZXRlIG9yIGJlIHJlZnVzZWQuCgpOb3RlIHRo
YXQgYSBkb21haW4gY2FuJ3QgaW50ZXJmZXJlIHdpdGggYW4gYWxyZWFkeSBz
dGFydGVkIChieSBhIHJlbW90ZQpkb21haW4pIHJlc2V0LCBkdWUgdG8gYmVp
bmcgcGF1c2VkLiBJdCBjYW4gcHJldmVudCBhIHJlbW90ZSByZXNldCBmcm9t
CmhhcHBlbmluZyBieSBsZWF2aW5nIGEgcmVzZXQgdW5maW5pc2hlZCwgYnV0
IHRoYXQncyBvbmx5IGdvaW5nIHRvIGFmZmVjdAppdHNlbGYuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM0NC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNo
IDxqYmV1bGljaEBzdXNlLmNvbT4KQWNrZWQtYnk6IEp1bGllbiBHcmFsbCA8
amdyYWxsQGFtYXpvbi5jb20+ClJldmlld2VkLWJ5OiBTdGVmYW5vIFN0YWJl
bGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CgotLS0gYS94ZW4vY29t
bW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTEy
MTQsNyArMTIxNCw3IEBAIHZvaWQgZG9tYWluX3VucGF1c2VfZXhjZXB0X3Nl
bGYoc3RydWN0IGQKICAgICAgICAgZG9tYWluX3VucGF1c2UoZCk7CiB9CiAK
LWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50
IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0cnVjdCBkb21haW4gKmQsIGJvb2wgcmVz
dW1pbmcpCiB7CiAgICAgc3RydWN0IHZjcHUgKnY7CiAgICAgaW50IHJjOwpA
QCAtMTIyOCw3ICsxMjI4LDcgQEAgaW50IGRvbWFpbl9zb2Z0X3Jlc2V0KHN0
cnVjdCBkb21haW4gKmQpCiAgICAgICAgIH0KICAgICBzcGluX3VubG9jaygm
ZC0+c2h1dGRvd25fbG9jayk7CiAKLSAgICByYyA9IGV2dGNobl9yZXNldChk
KTsKKyAgICByYyA9IGV2dGNobl9yZXNldChkLCByZXN1bWluZyk7CiAgICAg
aWYgKCByYyApCiAgICAgICAgIHJldHVybiByYzsKIAotLS0gYS94ZW4vY29t
bW9uL2RvbWN0bC5jCisrKyBiL3hlbi9jb21tb24vZG9tY3RsLmMKQEAgLTU3
MiwxMiArNTcyLDIyIEBAIGxvbmcgZG9fZG9tY3RsKFhFTl9HVUVTVF9IQU5E
TEVfUEFSQU0oeGUKICAgICB9CiAKICAgICBjYXNlIFhFTl9ET01DVExfc29m
dF9yZXNldDoKKyAgICBjYXNlIFhFTl9ET01DVExfc29mdF9yZXNldF9jb250
OgogICAgICAgICBpZiAoIGQgPT0gY3VycmVudC0+ZG9tYWluICkgLyogbm8g
ZG9tYWluX3BhdXNlKCkgKi8KICAgICAgICAgewogICAgICAgICAgICAgcmV0
ID0gLUVJTlZBTDsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9Ci0g
ICAgICAgIHJldCA9IGRvbWFpbl9zb2Z0X3Jlc2V0KGQpOworICAgICAgICBy
ZXQgPSBkb21haW5fc29mdF9yZXNldChkLCBvcC0+Y21kID09IFhFTl9ET01D
VExfc29mdF9yZXNldF9jb250KTsKKyAgICAgICAgaWYgKCByZXQgPT0gLUVS
RVNUQVJUICkKKyAgICAgICAgeworICAgICAgICAgICAgb3AtPmNtZCA9IFhF
Tl9ET01DVExfc29mdF9yZXNldF9jb250OworICAgICAgICAgICAgaWYgKCAh
X19jb3B5X2ZpZWxkX3RvX2d1ZXN0KHVfZG9tY3RsLCBvcCwgY21kKSApCisg
ICAgICAgICAgICAgICAgcmV0ID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51
YXRpb24oX19IWVBFUlZJU09SX2RvbWN0bCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaCIsIHVfZG9t
Y3RsKTsKKyAgICAgICAgICAgIGVsc2UKKyAgICAgICAgICAgICAgICByZXQg
PSAtRUZBVUxUOworICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogCiAgICAg
Y2FzZSBYRU5fRE9NQ1RMX2Rlc3Ryb3lkb21haW46Ci0tLSBhL3hlbi9jb21t
b24vZXZlbnRfY2hhbm5lbC5jCisrKyBiL3hlbi9jb21tb24vZXZlbnRfY2hh
bm5lbC5jCkBAIC0xMDU3LDcgKzEwNTcsNyBAQCBpbnQgZXZ0Y2huX3VubWFz
ayh1bnNpZ25lZCBpbnQgcG9ydCkKICAgICByZXR1cm4gMDsKIH0KIAotaW50
IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKQoraW50IGV2dGNobl9y
ZXNldChzdHJ1Y3QgZG9tYWluICpkLCBib29sIHJlc3VtaW5nKQogewogICAg
IHVuc2lnbmVkIGludCBpOwogICAgIGludCByYyA9IDA7CkBAIC0xMDY1LDEx
ICsxMDY1LDQwIEBAIGludCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAq
ZCkKICAgICBpZiAoIGQgIT0gY3VycmVudC0+ZG9tYWluICYmICFkLT5jb250
cm9sbGVyX3BhdXNlX2NvdW50ICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
CiAKLSAgICBmb3IgKCBpID0gMDsgcG9ydF9pc192YWxpZChkLCBpKTsgaSsr
ICkKKyAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgLyoK
KyAgICAgKiBJZiB3ZSBhcmUgcmVzdW1pbmcsIHRoZW4gc3RhcnQgd2hlcmUg
d2Ugc3RvcHBlZC4gT3RoZXJ3aXNlLCBjaGVjaworICAgICAqIHRoYXQgYSBy
ZXNldCBvcGVyYXRpb24gaXMgbm90IGFscmVhZHkgaW4gcHJvZ3Jlc3MsIGFu
ZCBpZiBub25lIGlzLAorICAgICAqIHJlY29yZCB0aGF0IHRoaXMgaXMgbm93
IHRoZSBjYXNlLgorICAgICAqLworICAgIGkgPSByZXN1bWluZyA/IGQtPm5l
eHRfZXZ0Y2huIDogIWQtPm5leHRfZXZ0Y2huOworICAgIGlmICggaSA+IGQt
Pm5leHRfZXZ0Y2huICkKKyAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOwor
CisgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworCisgICAgaWYg
KCAhaSApCisgICAgICAgIHJldHVybiAtRUJVU1k7CisKKyAgICBmb3IgKCA7
IHBvcnRfaXNfdmFsaWQoZCwgaSk7IGkrKyApCisgICAgewogICAgICAgICBl
dnRjaG5fY2xvc2UoZCwgaSwgMSk7CiAKKyAgICAgICAgLyogTkI6IENob2lj
ZSBvZiBmcmVxdWVuY3kgaXMgYXJiaXRyYXJ5LiAqLworICAgICAgICBpZiAo
ICEoaSAmIDB4M2YpICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNrKCkgKQor
ICAgICAgICB7CisgICAgICAgICAgICBzcGluX2xvY2soJmQtPmV2ZW50X2xv
Y2spOworICAgICAgICAgICAgZC0+bmV4dF9ldnRjaG4gPSBpOworICAgICAg
ICAgICAgc3Bpbl91bmxvY2soJmQtPmV2ZW50X2xvY2spOworICAgICAgICAg
ICAgcmV0dXJuIC1FUkVTVEFSVDsKKyAgICAgICAgfQorICAgIH0KKwogICAg
IHNwaW5fbG9jaygmZC0+ZXZlbnRfbG9jayk7CiAKKyAgICBkLT5uZXh0X2V2
dGNobiA9IDA7CisKICAgICBpZiAoIGQtPmFjdGl2ZV9ldnRjaG5zID4gZC0+
eGVuX2V2dGNobnMgKQogICAgICAgICByYyA9IC1FQUdBSU47CiAgICAgZWxz
ZSBpZiAoIGQtPmV2dGNobl9maWZvICkKQEAgLTEyMDQsNyArMTIzMyw4IEBA
IGxvbmcgZG9fZXZlbnRfY2hhbm5lbF9vcChpbnQgY21kLCBYRU5fR1UKICAg
ICAgICAgYnJlYWs7CiAgICAgfQogCi0gICAgY2FzZSBFVlRDSE5PUF9yZXNl
dDogeworICAgIGNhc2UgRVZUQ0hOT1BfcmVzZXQ6CisgICAgY2FzZSBFVlRD
SE5PUF9yZXNldF9jb250OiB7CiAgICAgICAgIHN0cnVjdCBldnRjaG5fcmVz
ZXQgcmVzZXQ7CiAgICAgICAgIHN0cnVjdCBkb21haW4gKmQ7CiAKQEAgLTEy
MTcsOSArMTI0NywxMyBAQCBsb25nIGRvX2V2ZW50X2NoYW5uZWxfb3AoaW50
IGNtZCwgWEVOX0dVCiAKICAgICAgICAgcmMgPSB4c21fZXZ0Y2huX3Jlc2V0
KFhTTV9UQVJHRVQsIGN1cnJlbnQtPmRvbWFpbiwgZCk7CiAgICAgICAgIGlm
ICggIXJjICkKLSAgICAgICAgICAgIHJjID0gZXZ0Y2huX3Jlc2V0KGQpOwor
ICAgICAgICAgICAgcmMgPSBldnRjaG5fcmVzZXQoZCwgY21kID09IEVWVENI
Tk9QX3Jlc2V0X2NvbnQpOwogCiAgICAgICAgIHJjdV91bmxvY2tfZG9tYWlu
KGQpOworCisgICAgICAgIGlmICggcmMgPT0gLUVSRVNUQVJUICkKKyAgICAg
ICAgICAgIHJjID0gaHlwZXJjYWxsX2NyZWF0ZV9jb250aW51YXRpb24oX19I
WVBFUlZJU09SX2V2ZW50X2NoYW5uZWxfb3AsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpaCIsIEVWVENITk9Q
X3Jlc2V0X2NvbnQsIGFyZyk7CiAgICAgICAgIGJyZWFrOwogICAgIH0KIAot
LS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvZG9tY3RsLmgKKysrIGIveGVuL2lu
Y2x1ZGUvcHVibGljL2RvbWN0bC5oCkBAIC0xMTUyLDcgKzExNTIsMTAgQEAg
c3RydWN0IHhlbl9kb21jdGwgewogI2RlZmluZSBYRU5fRE9NQ1RMX2lvbWVt
X3Blcm1pc3Npb24gICAgICAgICAgICAgIDIwCiAjZGVmaW5lIFhFTl9ET01D
VExfaW9wb3J0X3Blcm1pc3Npb24gICAgICAgICAgICAgMjEKICNkZWZpbmUg
WEVOX0RPTUNUTF9oeXBlcmNhbGxfaW5pdCAgICAgICAgICAgICAgICAyMgot
I2RlZmluZSBYRU5fRE9NQ1RMX2FyY2hfc2V0dXAgICAgICAgICAgICAgICAg
ICAgIDIzIC8qIE9ic29sZXRlIElBNjQgb25seSAqLworI2lmZGVmIF9fWEVO
X18KKy8qICNkZWZpbmUgWEVOX0RPTUNUTF9hcmNoX3NldHVwICAgICAgICAg
ICAgICAgICAyMyBPYnNvbGV0ZSBJQTY0IG9ubHkgKi8KKyNkZWZpbmUgWEVO
X0RPTUNUTF9zb2Z0X3Jlc2V0X2NvbnQgICAgICAgICAgICAgICAyMworI2Vu
ZGlmCiAjZGVmaW5lIFhFTl9ET01DVExfc2V0dGltZW9mZnNldCAgICAgICAg
ICAgICAgICAgMjQKICNkZWZpbmUgWEVOX0RPTUNUTF9nZXR2Y3B1YWZmaW5p
dHkgICAgICAgICAgICAgICAyNQogI2RlZmluZSBYRU5fRE9NQ1RMX3JlYWxf
bW9kZV9hcmVhICAgICAgICAgICAgICAgIDI2IC8qIE9ic29sZXRlIFBQQyBv
bmx5ICovCi0tLSBhL3hlbi9pbmNsdWRlL3B1YmxpYy9ldmVudF9jaGFubmVs
LmgKKysrIGIveGVuL2luY2x1ZGUvcHVibGljL2V2ZW50X2NoYW5uZWwuaApA
QCAtNzQsNiArNzQsOSBAQAogI2RlZmluZSBFVlRDSE5PUF9pbml0X2NvbnRy
b2wgICAgMTEKICNkZWZpbmUgRVZUQ0hOT1BfZXhwYW5kX2FycmF5ICAgIDEy
CiAjZGVmaW5lIEVWVENITk9QX3NldF9wcmlvcml0eSAgICAxMworI2lmZGVm
IF9fWEVOX18KKyNkZWZpbmUgRVZUQ0hOT1BfcmVzZXRfY29udCAgICAgIDE0
CisjZW5kaWYKIC8qIGAgfSAqLwogCiB0eXBlZGVmIHVpbnQzMl90IGV2dGNo
bl9wb3J0X3Q7Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCisrKyBi
L3hlbi9pbmNsdWRlL3hlbi9ldmVudC5oCkBAIC0xNzEsNyArMTcxLDcgQEAg
dm9pZCBldnRjaG5fY2hlY2tfcG9sbGVycyhzdHJ1Y3QgZG9tYWluCiB2b2lk
IGV2dGNobl8ybF9pbml0KHN0cnVjdCBkb21haW4gKmQpOwogCiAvKiBDbG9z
ZSBhbGwgZXZlbnQgY2hhbm5lbHMgYW5kIHJlc2V0IHRvIDItbGV2ZWwgQUJJ
LiAqLwotaW50IGV2dGNobl9yZXNldChzdHJ1Y3QgZG9tYWluICpkKTsKK2lu
dCBldnRjaG5fcmVzZXQoc3RydWN0IGRvbWFpbiAqZCwgYm9vbCByZXN1bWlu
Zyk7CiAKIC8qCiAgKiBMb3ctbGV2ZWwgZXZlbnQgY2hhbm5lbCBwb3J0IG9w
cy4KLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmgKQEAgLTM5NCw2ICszOTQsOCBAQCBzdHJ1Y3Qg
ZG9tYWluCiAgICAgICogRVZUQ0hOT1BfcmVzZXQpLiAgUmVhZC93cml0ZSBh
Y2Nlc3MgbGlrZSBmb3IgYWN0aXZlX2V2dGNobnMuCiAgICAgICovCiAgICAg
dW5zaWduZWQgaW50ICAgICB4ZW5fZXZ0Y2huczsKKyAgICAvKiBQb3J0IHRv
IHJlc3VtZSBmcm9tIGluIGV2dGNobl9yZXNldCgpLCB3aGVuIGluIGEgY29u
dGludWF0aW9uLiAqLworICAgIHVuc2lnbmVkIGludCAgICAgbmV4dF9ldnRj
aG47CiAgICAgc3BpbmxvY2tfdCAgICAgICBldmVudF9sb2NrOwogICAgIGNv
bnN0IHN0cnVjdCBldnRjaG5fcG9ydF9vcHMgKmV2dGNobl9wb3J0X29wczsK
ICAgICBzdHJ1Y3QgZXZ0Y2huX2ZpZm9fZG9tYWluICpldnRjaG5fZmlmbzsK
QEAgLTY2Myw3ICs2NjUsNyBAQCBpbnQgZG9tYWluX3NodXRkb3duKHN0cnVj
dCBkb21haW4gKmQsIHU4CiB2b2lkIGRvbWFpbl9yZXN1bWUoc3RydWN0IGRv
bWFpbiAqZCk7CiB2b2lkIGRvbWFpbl9wYXVzZV9mb3JfZGVidWdnZXIodm9p
ZCk7CiAKLWludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpk
KTsKK2ludCBkb21haW5fc29mdF9yZXNldChzdHJ1Y3QgZG9tYWluICpkLCBi
b29sIHJlc3VtaW5nKTsKIAogaW50IHZjcHVfc3RhcnRfc2h1dGRvd25fZGVm
ZXJyYWwoc3RydWN0IHZjcHUgKnYpOwogdm9pZCB2Y3B1X2VuZF9zaHV0ZG93
bl9kZWZlcnJhbChzdHJ1Y3QgdmNwdSAqdik7Cg==

--=separator--


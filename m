Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id BD5F21244EF
	for <lists+xen-devel@lfdr.de>; Wed, 18 Dec 2019 11:45:51 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1ihWnw-0004vE-Hu; Wed, 18 Dec 2019 10:43:44 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=HzQX=2I=amazon.com=prvs=248bb817a=sjpark@srs-us1.protection.inumbo.net>)
 id 1ihWnv-0004uw-Gk
 for xen-devel@lists.xenproject.org; Wed, 18 Dec 2019 10:43:43 +0000
X-Inumbo-ID: 41ece5a6-2183-11ea-9056-12813bfff9fa
Received: from smtp-fw-33001.amazon.com (unknown [207.171.190.10])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 41ece5a6-2183-11ea-9056-12813bfff9fa;
 Wed, 18 Dec 2019 10:43:42 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.com; i=@amazon.com; q=dns/txt; s=amazon201209;
 t=1576665823; x=1608201823;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=pwh42n4LScyU1VrZcW5OggIBsVlfrT3lJ8JlPu9F2P8=;
 b=mgGTpIC58m9v4b0r8vFmAU1+orwytiwlE9HMBHclM68trmd7FLWJKnaE
 osB1RPwsGg+fqFVOCIQddFNjt9W2gMwEDl4rxXA/9xIka2AcyWI9QG7fE
 n9jn2eLQIhZOyZo5G1r/mVODcajp39U21ttVYLh98zzINSZ3Jr2wVdNYU k=;
IronPort-SDR: +0plPABqRXJ0aNRkbxV67LZRJBe5YEQmSZQ6Kwt4MDKlYj5S3EfBJrnoac6cx/QzH2f/cM8kqo
 qEdWeXDp210w==
X-IronPort-AV: E=Sophos;i="5.69,329,1571702400"; d="scan'208";a="15600537"
Received: from sea32-co-svc-lb4-vlan3.sea.corp.amazon.com (HELO
 email-inbound-relay-2c-1968f9fa.us-west-2.amazon.com) ([10.47.23.38])
 by smtp-border-fw-out-33001.sea14.amazon.com with ESMTP;
 18 Dec 2019 10:43:30 +0000
Received: from EX13MTAUEA002.ant.amazon.com
 (pdx4-ws-svc-p6-lb7-vlan3.pdx.amazon.com [10.170.41.166])
 by email-inbound-relay-2c-1968f9fa.us-west-2.amazon.com (Postfix) with ESMTPS
 id 5856DA204D; Wed, 18 Dec 2019 10:43:29 +0000 (UTC)
Received: from EX13D31EUA001.ant.amazon.com (10.43.165.15) by
 EX13MTAUEA002.ant.amazon.com (10.43.61.77) with Microsoft SMTP Server (TLS)
 id 15.0.1236.3; Wed, 18 Dec 2019 10:43:28 +0000
Received: from u886c93fd17d25d.ant.amazon.com (10.43.160.100) by
 EX13D31EUA001.ant.amazon.com (10.43.165.15) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Wed, 18 Dec 2019 10:43:23 +0000
From: SeongJae Park <sjpark@amazon.com>
To: <jgross@suse.com>, <axboe@kernel.dk>, <konrad.wilk@oracle.com>,
 <roger.pau@citrix.com>
Date: Wed, 18 Dec 2019 11:42:30 +0100
Message-ID: <20191218104232.9606-4-sjpark@amazon.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20191218104232.9606-1-sjpark@amazon.com>
References: <20191218104232.9606-1-sjpark@amazon.com>
MIME-Version: 1.0
X-Originating-IP: [10.43.160.100]
X-ClientProxiedBy: EX13D18UWA003.ant.amazon.com (10.43.160.238) To
 EX13D31EUA001.ant.amazon.com (10.43.165.15)
Precedence: Bulk
Subject: [Xen-devel] [PATCH v12 3/5] xen/blkback: Squeeze page pools if a
 memory pressure is detected
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: linux-block@vger.kernel.org, sjpark@amazon.com, pdurrant@amazon.com,
 SeongJae Park <sjpark@amazon.de>, linux-kernel@vger.kernel.org,
 sj38.park@gmail.com, xen-devel@lists.xenproject.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogU2VvbmdKYWUgUGFyayA8c2pwYXJrQGFtYXpvbi5kZT4KCkVhY2ggYGJsa2lmYCBoYXMg
YSBmcmVlIHBhZ2VzIHBvb2wgZm9yIHRoZSBncmFudCBtYXBwaW5nLiAgVGhlIHNpemUgb2YKdGhl
IHBvb2wgc3RhcnRzIGZyb20gemVybyBhbmQgaXMgaW5jcmVhc2VkIG9uIGRlbWFuZCB3aGlsZSBw
cm9jZXNzaW5nCnRoZSBJL08gcmVxdWVzdHMuICBJZiBjdXJyZW50IEkvTyByZXF1ZXN0cyBoYW5k
bGluZyBpcyBmaW5pc2hlZCBvciAxMDAKbWlsbGlzZWNvbmRzIGhhcyBwYXNzZWQgc2luY2UgbGFz
dCBJL08gcmVxdWVzdHMgaGFuZGxpbmcsIGl0IGNoZWNrcyBhbmQKc2hyaW5rcyB0aGUgcG9vbCB0
byBub3QgZXhjZWVkIHRoZSBzaXplIGxpbWl0LCBgbWF4X2J1ZmZlcl9wYWdlc2AuCgpUaGVyZWZv
cmUsIGhvc3QgYWRtaW5pc3RyYXRvcnMgY2FuIGNhdXNlIG1lbW9yeSBwcmVzc3VyZSBpbiBibGti
YWNrIGJ5CmF0dGFjaGluZyBhIGxhcmdlIG51bWJlciBvZiBibG9jayBkZXZpY2VzIGFuZCBpbmR1
Y2luZyBJL08uICBTdWNoCnByb2JsZW1hdGljIHNpdHVhdGlvbnMgY2FuIGJlIGF2b2lkZWQgYnkg
bGltaXRpbmcgdGhlIG1heGltdW0gbnVtYmVyIG9mCmRldmljZXMgdGhhdCBjYW4gYmUgYXR0YWNo
ZWQsIGJ1dCBmaW5kaW5nIHRoZSBvcHRpbWFsIGxpbWl0IGlzIG5vdCBzbwplYXN5LiAgSW1wcm9w
ZXIgc2V0IG9mIHRoZSBsaW1pdCBjYW4gcmVzdWx0cyBpbiBtZW1vcnkgcHJlc3N1cmUgb3IgYQpy
ZXNvdXJjZSB1bmRlcnV0aWxpemF0aW9uLiAgVGhpcyBjb21taXQgYXZvaWRzIHN1Y2ggcHJvYmxl
bWF0aWMKc2l0dWF0aW9ucyBieSBzcXVlZXppbmcgdGhlIHBvb2xzIChyZXR1cm5zIGV2ZXJ5IGZy
ZWUgcGFnZSBpbiB0aGUgcG9vbAp0byB0aGUgc3lzdGVtKSBmb3IgYSB3aGlsZSAodXNlcnMgY2Fu
IHNldCB0aGlzIGR1cmF0aW9uIHZpYSBhIG1vZHVsZQpwYXJhbWV0ZXIpIGlmIG1lbW9yeSBwcmVz
c3VyZSBpcyBkZXRlY3RlZC4KCkRpc2N1c3Npb25zCj09PT09PT09PT09CgpUaGUgYGJsa2JhY2tg
J3Mgb3JpZ2luYWwgc2hyaW5raW5nIG1lY2hhbmlzbSByZXR1cm5zIG9ubHkgcGFnZXMgaW4gdGhl
CnBvb2wgd2hpY2ggYXJlIG5vdCBjdXJyZW50bHkgYmUgdXNlZCBieSBgYmxrYmFja2AgdG8gdGhl
IHN5c3RlbS4gIEluCm90aGVyIHdvcmRzLCB0aGUgcGFnZXMgdGhhdCBhcmUgbm90IG1hcHBlZCB3
aXRoIGdyYW50ZWQgcGFnZXMuICBCZWNhdXNlCnRoaXMgY29tbWl0IGlzIGNoYW5naW5nIG9ubHkg
dGhlIHNocmluayBsaW1pdCBidXQgc3RpbGwgdXNlcyB0aGUgc2FtZQpmcmVlaW5nIG1lY2hhbmlz
bSBpdCBkb2VzIG5vdCB0b3VjaCBwYWdlcyB3aGljaCBhcmUgY3VycmVudGx5IG1hcHBpbmcKZ3Jh
bnRzLgoKT25jZSBtZW1vcnkgcHJlc3N1cmUgaXMgZGV0ZWN0ZWQsIHRoaXMgY29tbWl0IGtlZXBz
IHRoZSBzcXVlZXppbmcgbGltaXQKZm9yIGEgdXNlci1zcGVjaWZpZWQgdGltZSBkdXJhdGlvbi4g
IFRoZSBkdXJhdGlvbiBzaG91bGQgYmUgbmVpdGhlciB0b28KbG9uZyBub3IgdG9vIHNob3J0LiAg
SWYgaXQgaXMgdG9vIGxvbmcsIHRoZSBzcXVlZXppbmcgaW5jdXJyaW5nIG92ZXJoZWFkCmNhbiBy
ZWR1Y2UgdGhlIEkvTyBwZXJmb3JtYW5jZS4gIElmIGl0IGlzIHRvbyBzaG9ydCwgYGJsa2JhY2tg
IHdpbGwgbm90CmZyZWUgZW5vdWdoIHBhZ2VzIHRvIHJlZHVjZSB0aGUgbWVtb3J5IHByZXNzdXJl
LiAgVGhpcyBjb21taXQgc2V0cyB0aGUKdmFsdWUgYXMgYDEwIG1pbGxpc2Vjb25kc2AgYnkgZGVm
YXVsdCBiZWNhdXNlIGl0IGlzIGEgc2hvcnQgdGltZSBpbgp0ZXJtcyBvZiBJL08gd2hpbGUgaXQg
aXMgYSBsb25nIHRpbWUgaW4gdGVybXMgb2YgbWVtb3J5IG9wZXJhdGlvbnMuCkFsc28sIGFzIHRo
ZSBvcmlnaW5hbCBzaHJpbmtpbmcgbWVjaGFuaXNtIHdvcmtzIGZvciBhdCBsZWFzdCBldmVyeSAx
MDAKbWlsbGlzZWNvbmRzLCB0aGlzIGNvdWxkIGJlIGEgc29tZXdoYXQgcmVhc29uYWJsZSBjaG9p
Y2UuICBJIGFsc28gdGVzdGVkCm90aGVyIGR1cmF0aW9ucyAocmVmZXIgdG8gdGhlIGJlbG93IHNl
Y3Rpb24gZm9yIG1vcmUgZGV0YWlscykgYW5kCmNvbmZpcm1lZCB0aGF0IDEwIG1pbGxpc2Vjb25k
cyBpcyB0aGUgb25lIHRoYXQgd29ya3MgYmVzdCB3aXRoIHRoZSB0ZXN0LgpUaGF0IHNhaWQsIHRo
ZSBwcm9wZXIgZHVyYXRpb24gZGVwZW5kcyBvbiBhY3R1YWwgY29uZmlndXJhdGlvbnMgYW5kCndv
cmtsb2Fkcy4gIFRoYXQncyB3aHkgdGhpcyBjb21taXQgYWxsb3dzIHVzZXJzIHRvIHNldCB0aGUg
ZHVyYXRpb24gYXMgYQptb2R1bGUgcGFyYW1ldGVyLgoKTWVtb3J5IFByZXNzdXJlIFRlc3QKPT09
PT09PT09PT09PT09PT09PT0KClRvIHNob3cgaG93IHRoaXMgY29tbWl0IGZpeGVzIHRoZSBtZW1v
cnkgcHJlc3N1cmUgc2l0dWF0aW9uIHdlbGwsIEkKY29uZmlndXJlZCBhIHRlc3QgZW52aXJvbm1l
bnQgb24gYSB4ZW4tcnVubmluZyB2aXJ0dWFsaXphdGlvbiBzeXN0ZW0uCk9uIHRoZSBgYmxrZnJv
bnRgIHJ1bm5pbmcgZ3Vlc3QgaW5zdGFuY2VzLCBJIGF0dGFjaCBhIGxhcmdlIG51bWJlciBvZgpu
ZXR3b3JrLWJhY2tlZCB2b2x1bWUgZGV2aWNlcyBhbmQgaW5kdWNlIEkvTyB0byB0aG9zZS4gIE1l
YW53aGlsZSwgSQptZWFzdXJlIHRoZSBudW1iZXIgb2YgcGFnZXMgdGhhdCBzd2FwcGVkIGluIChw
c3dwaW4pIGFuZCBvdXQgKHBzd3BvdXQpCm9uIHRoZSBgYmxrYmFja2AgcnVubmluZyBndWVzdC4g
IFRoZSB0ZXN0IHJhbiB0d2ljZSwgb25jZSBmb3IgdGhlCmBibGtiYWNrYCBiZWZvcmUgdGhpcyBj
b21taXQgYW5kIG9uY2UgZm9yIHRoYXQgYWZ0ZXIgdGhpcyBjb21taXQuICBBcwpzaG93biBiZWxv
dywgdGhpcyBjb21taXQgaGFzIGRyYW1hdGljYWxseSByZWR1Y2VkIHRoZSBtZW1vcnkgcHJlc3N1
cmU6CgogICAgICAgICAgICAgICAgcHN3cGluICBwc3dwb3V0CiAgICBiZWZvcmUgICAgICA3Niw2
NzIgIDE4NSw3OTkKICAgIGFmdGVyICAgICAgICAgIDg2NyAgICAzLDk2NwoKT3B0aW1hbCBBZ2dy
ZXNzaXZlIFNocmlua2luZyBEdXJhdGlvbgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCgpUbyBmaW5kIGEgYmVzdCBzcXVlZXppbmcgZHVyYXRpb24sIEkgcmVwZWF0ZWQgdGhl
IHRlc3Qgd2l0aCB0aHJlZQpkaWZmZXJlbnQgZHVyYXRpb25zICgxbXMsIDEwbXMsIGFuZCAxMDBt
cykuICBUaGUgcmVzdWx0cyBhcmUgYXMgYmVsb3c6CgogICAgZHVyYXRpb24gICAgcHN3cGluICBw
c3dwb3V0CiAgICAxICAgICAgICAgICA3MDcgICAgIDUsMDk1CiAgICAxMCAgICAgICAgICA4Njcg
ICAgIDMsOTY3CiAgICAxMDAgICAgICAgICAzNjIgICAgIDMsMzQ4CgpBcyBleHBlY3RlZCwgdGhl
IG1lbW9yeSBwcmVzc3VyZSBkZWNyZWFzZXMgYXMgdGhlIGR1cmF0aW9uIGluY3JlYXNlcywKYnV0
IHRoZSByZWR1Y3Rpb24gYmVjb21lIHNsb3cgZnJvbSB0aGUgYDEwbXNgLiAgQmFzZWQgb24gdGhp
cyByZXN1bHRzLCBJCmNob3NlIHRoZSBkZWZhdWx0IGR1cmF0aW9uIGFzIDEwbXMuCgpQZXJmb3Jt
YW5jZSBPdmVyaGVhZCBUZXN0Cj09PT09PT09PT09PT09PT09PT09PT09PT0KClRoaXMgY29tbWl0
IGNvdWxkIGluY3VyIEkvTyBwZXJmb3JtYW5jZSBkZWdyYWRhdGlvbiB1bmRlciBzZXZlcmUgbWVt
b3J5CnByZXNzdXJlIGJlY2F1c2UgdGhlIHNxdWVlemluZyB3aWxsIHJlcXVpcmUgbW9yZSBwYWdl
IGFsbG9jYXRpb25zIHBlcgpJL08uICBUbyBzaG93IHRoZSBvdmVyaGVhZCwgSSBhcnRpZmljaWFs
bHkgbWFkZSBhIHdvcnN0LWNhc2Ugc3F1ZWV6aW5nCnNpdHVhdGlvbiBhbmQgbWVhc3VyZWQgdGhl
IEkvTyBwZXJmb3JtYW5jZSBvZiBhIGBibGtmcm9udGAgcnVubmluZwpndWVzdC4KCkZvciB0aGUg
YXJ0aWZpY2lhbCBzcXVlZXppbmcsIEkgc2V0IHRoZSBgYmxrYmFjay5tYXhfYnVmZmVyX3BhZ2Vz
YCB1c2luZwp0aGUgYC9zeXMvbW9kdWxlL3hlbl9ibGtiYWNrL3BhcmFtZXRlcnMvbWF4X2J1ZmZl
cl9wYWdlc2AgZmlsZS4gIEluIHRoaXMKdGVzdCwgSSBzZXQgdGhlIHZhbHVlIHRvIGAxMDI0YCBh
bmQgYDBgLiAgVGhlIGAxMDI0YCBpcyB0aGUgZGVmYXVsdAp2YWx1ZS4gIFNldHRpbmcgdGhlIHZh
bHVlIGFzIGAwYCBpcyBzYW1lIHRvIGEgc2l0dWF0aW9uIGRvaW5nIHRoZQpzcXVlZXppbmcgYWx3
YXlzICh3b3JzdC1jYXNlKS4KCklmIHRoZSB1bmRlcmx5aW5nIGJsb2NrIGRldmljZSBpcyBzbG93
IGVub3VnaCwgdGhlIHNxdWVlemluZyBvdmVyaGVhZApjb3VsZCBiZSBoaWRkZW4uICBGb3IgdGhl
IHJlYXNvbiwgSSB1c2UgYSBmYXN0IGJsb2NrIGRldmljZSwgbmFtZWx5IHRoZQpyYmRbMV06Cgog
ICAgIyB4bCBibG9jay1hdHRhY2ggZ3Vlc3QgcGh5Oi9kZXYvcmFtMCB4dmRiIHcKCkZvciB0aGUg
SS9PIHBlcmZvcm1hbmNlIG1lYXN1cmVtZW50LCBJIHJ1biBhIHNpbXBsZSBgZGRgIGNvbW1hbmQg
NSB0aW1lcwpkaXJlY3RseSB0byB0aGUgZGV2aWNlIGFzIGJlbG93IGFuZCBjb2xsZWN0IHRoZSAn
TUIvcycgcmVzdWx0cy4KCiAgICAkIGZvciBpIGluIHsxLi41fTsgZG8gZGQgaWY9L2Rldi96ZXJv
IG9mPS9kZXYveHZkYiBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnM9NGsgY291bnQ9
JCgoMjU2KjUxMikpOyBzeW5jOyBkb25lCgpUaGUgcmVzdWx0cyBhcmUgYXMgYmVsb3cuICAnbWF4
X3BncycgcmVwcmVzZW50cyB0aGUgdmFsdWUgb2YgdGhlCmBibGtiYWNrLm1heF9idWZmZXJfcGFn
ZXNgIHBhcmFtZXRlci4KCiAgICBtYXhfcGdzICAgTWluICAgICAgIE1heCAgICAgICBNZWRpYW4g
ICAgIEF2ZyAgICBTdGRkZXYKICAgIDAgICAgICAgICA0MTcgICAgICAgNDIzICAgICAgIDQyMCAg
ICAgICAgNDE5LjQgIDIuNTA5OTgwMQogICAgMTAyNCAgICAgIDQxNCAgICAgICA0MjUgICAgICAg
NDE2ICAgICAgICA0MTcuOCAgNC40Mzg0NjgyCiAgICBObyBkaWZmZXJlbmNlIHByb3ZlbiBhdCA5
NS4wJSBjb25maWRlbmNlCgpJbiBzaG9ydCwgZXZlbiB3b3JzdCBjYXNlIHNxdWVlemluZyBvbiBy
YW1kaXNrIGJhc2VkIGZhc3QgYmxvY2sgZGV2aWNlCm1ha2VzIG5vIHZpc2libGUgcGVyZm9ybWFu
Y2UgZGVncmFkYXRpb24uICBQbGVhc2Ugbm90ZSB0aGF0IHRoaXMgaXMganVzdAphIHZlcnkgc2lt
cGxlIGFuZCBtaW5pbWFsIHRlc3QuICBPbiBzeXN0ZW1zIHVzaW5nIHN1cGVyLWZhc3QgYmxvY2sK
ZGV2aWNlcyBhbmQgYSBzcGVjaWFsIEkvTyB3b3JrbG9hZCwgdGhlIHJlc3VsdHMgbWlnaHQgYmUg
ZGlmZmVyZW50LiAgSWYKeW91IGhhdmUgYW55IGRvdWJ0LCB0ZXN0IG9uIHlvdXIgbWFjaGluZSB3
aXRoIHlvdXIgd29ya2xvYWQgdG8gZmluZCB0aGUKb3B0aW1hbCBzcXVlZXppbmcgZHVyYXRpb24g
Zm9yIHlvdS4KClsxXSBodHRwczovL3d3dy5rZXJuZWwub3JnL2RvYy9odG1sL2xhdGVzdC9hZG1p
bi1ndWlkZS9ibG9ja2Rldi9yYW1kaXNrLmh0bWwKClNpZ25lZC1vZmYtYnk6IFNlb25nSmFlIFBh
cmsgPHNqcGFya0BhbWF6b24uZGU+Ci0tLQogLi4uL0FCSS90ZXN0aW5nL3N5c2ZzLWRyaXZlci14
ZW4tYmxrYmFjayAgICAgIHwgMTAgKysrKysrCiBkcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Js
a2JhY2suYyAgICAgICAgICAgfCAgNyArKy0tCiBkcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Nv
bW1vbi5oICAgICAgICAgICAgfCAgMSArCiBkcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL3hlbmJ1
cy5jICAgICAgICAgICAgfCAzMiArKysrKysrKysrKysrKysrKystCiA0IGZpbGVzIGNoYW5nZWQs
IDQ3IGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvRG9jdW1lbnRh
dGlvbi9BQkkvdGVzdGluZy9zeXNmcy1kcml2ZXIteGVuLWJsa2JhY2sgYi9Eb2N1bWVudGF0aW9u
L0FCSS90ZXN0aW5nL3N5c2ZzLWRyaXZlci14ZW4tYmxrYmFjawppbmRleCA0ZTdiYWJiM2JhMWYu
LmYwMTIyNDIzMWYzZiAxMDA2NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi9BQkkvdGVzdGluZy9zeXNm
cy1kcml2ZXIteGVuLWJsa2JhY2sKKysrIGIvRG9jdW1lbnRhdGlvbi9BQkkvdGVzdGluZy9zeXNm
cy1kcml2ZXIteGVuLWJsa2JhY2sKQEAgLTI1LDMgKzI1LDEzIEBAIERlc2NyaXB0aW9uOgogICAg
ICAgICAgICAgICAgIGFsbG9jYXRlZCB3aXRob3V0IGJlaW5nIGluIHVzZS4gVGhlIHRpbWUgaXMg
aW4KICAgICAgICAgICAgICAgICBzZWNvbmRzLCAwIG1lYW5zIGluZGVmaW5pdGVseSBsb25nLgog
ICAgICAgICAgICAgICAgIFRoZSBkZWZhdWx0IGlzIDYwIHNlY29uZHMuCisKK1doYXQ6ICAgICAg
ICAgICAvc3lzL21vZHVsZS94ZW5fYmxrYmFjay9wYXJhbWV0ZXJzL2J1ZmZlcl9zcXVlZXplX2R1
cmF0aW9uX21zCitEYXRlOiAgICAgICAgICAgRGVjZW1iZXIgMjAxOQorS2VybmVsVmVyc2lvbjog
IDUuNQorQ29udGFjdDogICAgICAgIFNlb25nSmFlIFBhcmsgPHNqcGFya0BhbWF6b24uZGU+CitE
ZXNjcmlwdGlvbjoKKyAgICAgICAgICAgICAgICBXaGVuIG1lbW9yeSBwcmVzc3VyZSBpcyByZXBv
cnRlZCB0byBibGtiYWNrIHRoaXMgb3B0aW9uCisgICAgICAgICAgICAgICAgY29udHJvbHMgdGhl
IGR1cmF0aW9uIGluIG1pbGxpc2Vjb25kcyB0aGF0IGJsa2JhY2sgd2lsbCBub3QKKyAgICAgICAg
ICAgICAgICBjYWNoZSBhbnkgcGFnZSBub3QgYmFja2VkIGJ5IGEgZ3JhbnQgbWFwcGluZy4KKyAg
ICAgICAgICAgICAgICBUaGUgZGVmYXVsdCBpcyAxMG1zLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9i
bG9jay94ZW4tYmxrYmFjay9ibGtiYWNrLmMgYi9kcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL2Js
a2JhY2suYwppbmRleCBmZDFlMTlmMWE0OWYuLjc5ZjY3N2FlYjVjYyAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ibG9jay94ZW4tYmxrYmFjay9ibGtiYWNrLmMKKysrIGIvZHJpdmVycy9ibG9jay94ZW4t
YmxrYmFjay9ibGtiYWNrLmMKQEAgLTY1Niw4ICs2NTYsMTEgQEAgaW50IHhlbl9ibGtpZl9zY2hl
ZHVsZSh2b2lkICphcmcpCiAJCQlyaW5nLT5uZXh0X2xydSA9IGppZmZpZXMgKyBtc2Vjc190b19q
aWZmaWVzKExSVV9JTlRFUlZBTCk7CiAJCX0KIAotCQkvKiBTaHJpbmsgaWYgd2UgaGF2ZSBtb3Jl
IHRoYW4geGVuX2Jsa2lmX21heF9idWZmZXJfcGFnZXMgKi8KLQkJc2hyaW5rX2ZyZWVfcGFnZXBv
b2wocmluZywgeGVuX2Jsa2lmX21heF9idWZmZXJfcGFnZXMpOworCQkvKiBTaHJpbmsgdGhlIGZy
ZWUgcGFnZXMgcG9vbCBpZiBpdCBpcyB0b28gbGFyZ2UuICovCisJCWlmICh0aW1lX2JlZm9yZShq
aWZmaWVzLCBibGtpZi0+YnVmZmVyX3NxdWVlemVfZW5kKSkKKwkJCXNocmlua19mcmVlX3BhZ2Vw
b29sKHJpbmcsIDApOworCQllbHNlCisJCQlzaHJpbmtfZnJlZV9wYWdlcG9vbChyaW5nLCB4ZW5f
YmxraWZfbWF4X2J1ZmZlcl9wYWdlcyk7CiAKIAkJaWYgKGxvZ19zdGF0cyAmJiB0aW1lX2FmdGVy
KGppZmZpZXMsIHJpbmctPnN0X3ByaW50KSkKIAkJCXByaW50X3N0YXRzKHJpbmcpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ibG9jay94ZW4tYmxrYmFjay9jb21tb24uaCBiL2RyaXZlcnMvYmxvY2sv
eGVuLWJsa2JhY2svY29tbW9uLmgKaW5kZXggMWQzMDAyZDc3M2Y3Li41MzZjODRmNjFmZWQgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvYmxvY2sveGVuLWJsa2JhY2svY29tbW9uLmgKKysrIGIvZHJpdmVy
cy9ibG9jay94ZW4tYmxrYmFjay9jb21tb24uaApAQCAtMzE5LDYgKzMxOSw3IEBAIHN0cnVjdCB4
ZW5fYmxraWYgewogCS8qIEFsbCByaW5ncyBmb3IgdGhpcyBkZXZpY2UuICovCiAJc3RydWN0IHhl
bl9ibGtpZl9yaW5nCSpyaW5nczsKIAl1bnNpZ25lZCBpbnQJCW5yX3JpbmdzOworCXVuc2lnbmVk
IGxvbmcJCWJ1ZmZlcl9zcXVlZXplX2VuZDsKIH07CiAKIHN0cnVjdCBzZWdfYnVmIHsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvYmxvY2sveGVuLWJsa2JhY2sveGVuYnVzLmMgYi9kcml2ZXJzL2Jsb2Nr
L3hlbi1ibGtiYWNrL3hlbmJ1cy5jCmluZGV4IGI5MGRiY2Q5OWMwMy4uMjAwNDU4MjdhMzkxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL3hlbmJ1cy5jCisrKyBiL2RyaXZl
cnMvYmxvY2sveGVuLWJsa2JhY2sveGVuYnVzLmMKQEAgLTQ5Miw2ICs0OTIsNyBAQCBzdGF0aWMg
aW50IHhlbl92YmRfY3JlYXRlKHN0cnVjdCB4ZW5fYmxraWYgKmJsa2lmLCBibGtpZl92ZGV2X3Qg
aGFuZGxlLAogc3RhdGljIGludCB4ZW5fYmxrYmtfcmVtb3ZlKHN0cnVjdCB4ZW5idXNfZGV2aWNl
ICpkZXYpCiB7CiAJc3RydWN0IGJhY2tlbmRfaW5mbyAqYmUgPSBkZXZfZ2V0X2RydmRhdGEoJmRl
di0+ZGV2KTsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOwogCiAJcHJfZGVidWcoIiVzICVwICVkXG4i
LCBfX2Z1bmNfXywgZGV2LCBkZXYtPm90aGVyZW5kX2lkKTsKIApAQCAtNTA0LDYgKzUwNSw3IEBA
IHN0YXRpYyBpbnQgeGVuX2Jsa2JrX3JlbW92ZShzdHJ1Y3QgeGVuYnVzX2RldmljZSAqZGV2KQog
CQliZS0+YmFja2VuZF93YXRjaC5ub2RlID0gTlVMTDsKIAl9CiAKKwlzcGluX2xvY2tfaXJxc2F2
ZSgmZGV2LT5yZWNsYWltX2xvY2ssIGZsYWdzKTsKIAlkZXZfc2V0X2RydmRhdGEoJmRldi0+ZGV2
LCBOVUxMKTsKIAogCWlmIChiZS0+YmxraWYpIHsKQEAgLTUxMiw2ICs1MTQsNyBAQCBzdGF0aWMg
aW50IHhlbl9ibGtia19yZW1vdmUoc3RydWN0IHhlbmJ1c19kZXZpY2UgKmRldikKIAkJLyogUHV0
IHRoZSByZWZlcmVuY2Ugd2Ugc2V0IGluIHhlbl9ibGtpZl9hbGxvYygpLiAqLwogCQl4ZW5fYmxr
aWZfcHV0KGJlLT5ibGtpZik7CiAJfQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRldi0+cmVj
bGFpbV9sb2NrLCBmbGFncyk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTU5Nyw2ICs2MDAsNyBAQCBz
dGF0aWMgaW50IHhlbl9ibGtia19wcm9iZShzdHJ1Y3QgeGVuYnVzX2RldmljZSAqZGV2LAogCWlu
dCBlcnI7CiAJc3RydWN0IGJhY2tlbmRfaW5mbyAqYmUgPSBremFsbG9jKHNpemVvZihzdHJ1Y3Qg
YmFja2VuZF9pbmZvKSwKIAkJCQkJICBHRlBfS0VSTkVMKTsKKwl1bnNpZ25lZCBsb25nIGZsYWdz
OwogCiAJLyogbWF0Y2ggdGhlIHByX2RlYnVnIGluIHhlbl9ibGtia19yZW1vdmUgKi8KIAlwcl9k
ZWJ1ZygiJXMgJXAgJWRcbiIsIF9fZnVuY19fLCBkZXYsIGRldi0+b3RoZXJlbmRfaWQpOwpAQCAt
NjA3LDYgKzYxMSw3IEBAIHN0YXRpYyBpbnQgeGVuX2Jsa2JrX3Byb2JlKHN0cnVjdCB4ZW5idXNf
ZGV2aWNlICpkZXYsCiAJCXJldHVybiAtRU5PTUVNOwogCX0KIAliZS0+ZGV2ID0gZGV2OworCXNw
aW5fbG9ja19pcnFzYXZlKCZkZXYtPnJlY2xhaW1fbG9jaywgZmxhZ3MpOwogCWRldl9zZXRfZHJ2
ZGF0YSgmZGV2LT5kZXYsIGJlKTsKIAogCWJlLT5ibGtpZiA9IHhlbl9ibGtpZl9hbGxvYyhkZXYt
Pm90aGVyZW5kX2lkKTsKQEAgLTYxNCw4ICs2MTksMTAgQEAgc3RhdGljIGludCB4ZW5fYmxrYmtf
cHJvYmUoc3RydWN0IHhlbmJ1c19kZXZpY2UgKmRldiwKIAkJZXJyID0gUFRSX0VSUihiZS0+Ymxr
aWYpOwogCQliZS0+YmxraWYgPSBOVUxMOwogCQl4ZW5idXNfZGV2X2ZhdGFsKGRldiwgZXJyLCAi
Y3JlYXRpbmcgYmxvY2sgaW50ZXJmYWNlIik7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRl
di0+cmVjbGFpbV9sb2NrLCBmbGFncyk7CiAJCWdvdG8gZmFpbDsKIAl9CisJc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmZGV2LT5yZWNsYWltX2xvY2ssIGZsYWdzKTsKIAogCWVyciA9IHhlbmJ1c19w
cmludGYoWEJUX05JTCwgZGV2LT5ub2RlbmFtZSwKIAkJCSAgICAiZmVhdHVyZS1tYXgtaW5kaXJl
Y3Qtc2VnbWVudHMiLCAiJXUiLApAQCAtODI0LDYgKzgzMSwyOCBAQCBzdGF0aWMgdm9pZCBmcm9u
dGVuZF9jaGFuZ2VkKHN0cnVjdCB4ZW5idXNfZGV2aWNlICpkZXYsCiB9CiAKIAorLyogT25jZSBh
IG1lbW9yeSBwcmVzc3VyZSBpcyBkZXRlY3RlZCwgc3F1ZWV6ZSBmcmVlIHBhZ2UgcG9vbHMgZm9y
IGEgd2hpbGUuICovCitzdGF0aWMgdW5zaWduZWQgaW50IGJ1ZmZlcl9zcXVlZXplX2R1cmF0aW9u
X21zID0gMTA7Cittb2R1bGVfcGFyYW1fbmFtZWQoYnVmZmVyX3NxdWVlemVfZHVyYXRpb25fbXMs
CisJCWJ1ZmZlcl9zcXVlZXplX2R1cmF0aW9uX21zLCBpbnQsIDA2NDQpOworTU9EVUxFX1BBUk1f
REVTQyhidWZmZXJfc3F1ZWV6ZV9kdXJhdGlvbl9tcywKKyJEdXJhdGlvbiBpbiBtcyB0byBzcXVl
ZXplIHBhZ2VzIGJ1ZmZlciB3aGVuIGEgbWVtb3J5IHByZXNzdXJlIGlzIGRldGVjdGVkIik7CisK
Ky8qCisgKiBDYWxsYmFjayByZWNlaXZlZCB3aGVuIHRoZSBtZW1vcnkgcHJlc3N1cmUgaXMgZGV0
ZWN0ZWQuCisgKi8KK3N0YXRpYyB2b2lkIHJlY2xhaW1fbWVtb3J5KHN0cnVjdCB4ZW5idXNfZGV2
aWNlICpkZXYpCit7CisJc3RydWN0IGJhY2tlbmRfaW5mbyAqYmUgPSBkZXZfZ2V0X2RydmRhdGEo
JmRldi0+ZGV2KTsKKworCS8qIERldmljZSBpcyByZWdpc3RlcmVkIGJ1dCBub3QgcHJvYmVkIHll
dCAqLworCWlmICghYmUpCisJCXJldHVybjsKKworCWJlLT5ibGtpZi0+YnVmZmVyX3NxdWVlemVf
ZW5kID0gamlmZmllcyArCisJCW1zZWNzX3RvX2ppZmZpZXMoYnVmZmVyX3NxdWVlemVfZHVyYXRp
b25fbXMpOworfQorCiAvKiAqKiBDb25uZWN0aW9uICoqICovCiAKIApAQCAtMTExNSw3ICsxMTQ0
LDggQEAgc3RhdGljIHN0cnVjdCB4ZW5idXNfZHJpdmVyIHhlbl9ibGtia19kcml2ZXIgPSB7CiAJ
LmlkcyAgPSB4ZW5fYmxrYmtfaWRzLAogCS5wcm9iZSA9IHhlbl9ibGtia19wcm9iZSwKIAkucmVt
b3ZlID0geGVuX2Jsa2JrX3JlbW92ZSwKLQkub3RoZXJlbmRfY2hhbmdlZCA9IGZyb250ZW5kX2No
YW5nZWQKKwkub3RoZXJlbmRfY2hhbmdlZCA9IGZyb250ZW5kX2NoYW5nZWQsCisJLnJlY2xhaW1f
bWVtb3J5ID0gcmVjbGFpbV9tZW1vcnksCiB9OwogCiBpbnQgeGVuX2Jsa2lmX3hlbmJ1c19pbml0
KHZvaWQpCi0tIAoyLjE3LjEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9q
ZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVu
LWRldmVs

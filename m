Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6F2CCB390E
	for <lists+xen-devel@lfdr.de>; Mon, 16 Sep 2019 13:07:29 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i9onl-0005cH-O4; Mon, 16 Sep 2019 11:04:13 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=GGTU=XL=amazon.de=prvs=1553567f6=wipawel@srs-us1.protection.inumbo.net>)
 id 1i9onk-0005ao-2v
 for xen-devel@lists.xen.org; Mon, 16 Sep 2019 11:04:12 +0000
X-Inumbo-ID: b45878c3-d871-11e9-95df-12813bfff9fa
Received: from smtp-fw-33001.amazon.com (unknown [207.171.190.10])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id b45878c3-d871-11e9-95df-12813bfff9fa;
 Mon, 16 Sep 2019 11:04:08 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=amazon.de; i=@amazon.de; q=dns/txt; s=amazon201209;
 t=1568631848; x=1600167848;
 h=from:to:cc:subject:date:message-id:in-reply-to:
 references:mime-version;
 bh=bRjuJQiXsy/07kpBbggee7KuH8vU8OlxSZXKwcAZxQw=;
 b=r7KzxcM0egHfSc5M53dhRwp9pmlCGjD6YVfQiQScer7vlBH+JBR38I5z
 88/rbDZJdtV/nrahMUtxsVLmFeEnhd5M1GXjMn9728L9kJ9ogAqlVqbJR
 yX4XwnVY3rrBZQnMsb8wsQBp98T/P3Oocq9WcO9T4RufTz+mDEI7BADQq 4=;
X-IronPort-AV: E=Sophos;i="5.64,512,1559520000"; d="scan'208";a="832619373"
Received: from sea3-co-svc-lb6-vlan2.sea.amazon.com (HELO
 email-inbound-relay-1d-f273de60.us-east-1.amazon.com) ([10.47.22.34])
 by smtp-border-fw-out-33001.sea14.amazon.com with ESMTP;
 16 Sep 2019 11:04:06 +0000
Received: from EX13MTAUEA001.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan2.iad.amazon.com [10.40.159.162])
 by email-inbound-relay-1d-f273de60.us-east-1.amazon.com (Postfix) with ESMTPS
 id 90DBEA24CA; Mon, 16 Sep 2019 11:04:04 +0000 (UTC)
Received: from EX13D05EUB004.ant.amazon.com (10.43.166.115) by
 EX13MTAUEA001.ant.amazon.com (10.43.61.82) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:03:46 +0000
Received: from EX13MTAUEB001.ant.amazon.com (10.43.60.96) by
 EX13D05EUB004.ant.amazon.com (10.43.166.115) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Mon, 16 Sep 2019 11:03:45 +0000
Received: from dev-dsk-wipawel-1a-0c4e6d58.eu-west-1.amazon.com (10.4.134.33)
 by mail-relay.amazon.com (10.43.60.129) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Mon, 16 Sep 2019 11:03:43 +0000
From: Pawel Wieczorkiewicz <wipawel@amazon.de>
To: <xen-devel@lists.xen.org>, <xen-devel@lists.xenproject.org>
Date: Mon, 16 Sep 2019 10:59:40 +0000
Message-ID: <20190916105945.93632-8-wipawel@amazon.de>
X-Mailer: git-send-email 2.16.5
In-Reply-To: <20190916105945.93632-1-wipawel@amazon.de>
References: <20190916105945.93632-1-wipawel@amazon.de>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v3 07/12] livepatch: Add per-function
 applied/reverted state tracking marker
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: wipawel@amazon.com, Stefano Stabellini <sstabellini@kernel.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ross Lagerwall <ross.lagerwall@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, mpohlack@amazon.com,
 Tim Deegan <tim@xen.org>, Pawel Wieczorkiewicz <wipawel@amazon.de>,
 Julien Grall <julien.grall@arm.com>, Jan
 Beulich <jbeulich@suse.com>, Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

TGl2ZXBhdGNoIG9ubHkgdHJhY2tzIGFuIGVudGlyZSBwYXlsb2FkIGFwcGxpZWQvcmV2ZXJ0ZWQg
c3RhdGUuIEJ1dCwKd2l0aCBhbiBvcHRpb24gdG8gc3VwcGx5IHRoZSBhcHBseV9wYXlsb2FkKCkg
YW5kL29yIHJldmVydF9wYXlsb2FkKCkKZnVuY3Rpb25zIGFzIG9wdGlvbmFsIGhvb2tzLCBpdCBi
ZWNvbWVzIHBvc3NpYmxlIHRvIGludGVybWl4IHRoZQpleGVjdXRpb24gb2YgdGhlIG9yaWdpbmFs
IGFwcGx5X3BheWxvYWQoKS9yZXZlcnRfcGF5bG9hZCgpIGZ1bmN0aW9ucwp3aXRoIHRoZWlyIGR5
bmFtaWNhbGx5IHN1cHBsaWVkIGNvdW50ZXJwYXJ0cy4KSXQgaXMgaW1wb3J0YW50IHRoZW4gdG8g
dHJhY2sgdGhlIGN1cnJlbnQgc3RhdGUgb2YgZXZlcnkgZnVuY3Rpb24KYmVpbmcgcGF0Y2hlZCBh
bmQgcHJldmVudCBzaXR1YXRpb25zIG9mIHVuaW50ZW50aW9uYWwgZG91YmxlLWFwcGx5Cm9yIHVu
YXBwbGllZCByZXZlcnQuCgpUbyBzdXBwb3J0IHRoYXQsIGl0IGlzIG5lY2Vzc2FyeSB0byBleHRl
bmQgcHVibGljIGludGVyZmFjZSBvZiB0aGUKbGl2ZXBhdGNoLiBUaGUgc3RydWN0IGxpdmVwYXRj
aF9mdW5jIGdldHMgYWRkaXRpb25hbCBmaWVsZCBob2xkaW5nCnRoZSBhcHBsaWVkL3JldmVydGVk
IHN0YXRlIG1hcmtlci4KClRvIHJlZmxlY3QgdGhlIGxpdmVwYXRjaCBwYXlsb2FkIEFCSSBjaGFu
Z2UsIGJ1bXAgdGhlIHZlcnNpb24gZmxhZwpMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OIHVwIHRv
IDIuCgpbQW5kIGFsc28gdXBkYXRlIHRoZSB0b3Agb2YgdGhlIGRlc2lnbiBkb2N1bWVudF0KClNp
Z25lZC1vZmYtYnk6IFBhd2VsIFdpZWN6b3JraWV3aWN6IDx3aXBhd2VsQGFtYXpvbi5kZT4KUmV2
aWV3ZWQtYnk6IEFuZHJhLUlyaW5hIFBhcmFzY2hpdiA8YW5kcmFwcnNAYW1hem9uLmNvbT4KUmV2
aWV3ZWQtYnk6IEJqb2VybiBEb2ViZWwgPGRvZWJlbEBhbWF6b24uZGU+ClJldmlld2VkLWJ5OiBN
YXJ0aW4gUG9obGFjayA8bXBvaGxhY2tAYW1hem9uLmRlPgpTaWduZWQtb2ZmLWJ5OiBLb25yYWQg
Unplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+CkFja2VkLWJ5OiBKdWxpZW4g
R3JhbGwgPGp1bGllbi5ncmFsbEBhcm0uY29tPgotLS0KQ2hhbmdlZCBzaW5jZSB2MjoKICAqIERv
Y3VtZW50YXRpb24gZml4ZXMKCkNoYW5nZWQgc2luY2UgdjE6CiAgKiBzdXBwb3J0IHRoZSBmZWF0
dXJlIGZvciBhbGwgYXJjaCAoYWRkIGhhbmRsaW5nIGZvciBBcm0pCiAgKiBhZGQgY29tbW9uIGlz
X2Z1bmNfYXBwbGllZCgpIGFuZCBpc19mdW5jX3JldmVydGVkKCkgdG8gYmUKICAgIHVzZWQgYnkg
YWxsIGFyY2gKICAqIHJlbW92ZSBleHBsaWNpdCBlbnVtIHZhbHVlcyBmcm9tIGVudW0gbGl2ZXBh
dGNoX2Z1bmNfc3RhdGUKICAqIGFkZGVkIGNvcnJlc3BvbmRpbmcgZG9jdW1lbnRhdGlvbgogICog
YWRkZWQgdGVzdHMKCiBkb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYyAgICAgICAgICAgICAgICAg
ICAgIHwgIDE3ICsrLQogeGVuL2FyY2gvYXJtL2FybTMyL2xpdmVwYXRjaC5jICAgICAgICAgICAg
ICAgICB8ICAxMiArKy0KIHhlbi9hcmNoL2FybS9hcm02NC9saXZlcGF0Y2guYyAgICAgICAgICAg
ICAgICAgfCAgMTIgKystCiB4ZW4vYXJjaC9hcm0vbGl2ZXBhdGNoLmMgICAgICAgICAgICAgICAg
ICAgICAgIHwgIDEwICstCiB4ZW4vYXJjaC94ODYvbGl2ZXBhdGNoLmMgICAgICAgICAgICAgICAg
ICAgICAgIHwgIDIyICsrKy0KIHhlbi9jb21tb24vbGl2ZXBhdGNoLmMgICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgMzUgKysrKysrCiB4ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmggICAgICAg
ICAgICAgICAgICAgIHwgICA5ICstCiB4ZW4vaW5jbHVkZS94ZW4vbGl2ZXBhdGNoLmggICAgICAg
ICAgICAgICAgICAgIHwgIDI3ICsrKystCiB4ZW4vdGVzdC9saXZlcGF0Y2gvTWFrZWZpbGUgICAg
ICAgICAgICAgICAgICAgIHwgIDI3ICsrKystCiB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlv
bl9ob29rcy5jICAgICAgICAgIHwgICAyICsKIHhlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9u
X2hvb2tzX21hcmtlci5jICAgfCAxMTIgKysrKysrKysrKysrKysrKysrKwogeGVuL3Rlc3QvbGl2
ZXBhdGNoL3hlbl9hY3Rpb25faG9va3Nfbm9hcHBseS5jICB8IDEzNiArKysrKysrKysrKysrKysr
KysrKysrKwogeGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3Nfbm9yZXZlcnQuYyB8
IDE0MyArKysrKysrKysrKysrKysrKysrKysrKysrCiAxMyBmaWxlcyBjaGFuZ2VkLCA1NTQgaW5z
ZXJ0aW9ucygrKSwgMTAgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgeGVuL3Rlc3Qv
bGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3NfbWFya2VyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCB4
ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19ub2FwcGx5LmMKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCB4ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19ub3JldmVydC5jCgpk
aWZmIC0tZ2l0IGEvZG9jcy9taXNjL2xpdmVwYXRjaC5wYW5kb2MgYi9kb2NzL21pc2MvbGl2ZXBh
dGNoLnBhbmRvYwppbmRleCA2ZmFmYjllNGIxLi4zODNhOTg4YmEyIDEwMDY0NAotLS0gYS9kb2Nz
L21pc2MvbGl2ZXBhdGNoLnBhbmRvYworKysgYi9kb2NzL21pc2MvbGl2ZXBhdGNoLnBhbmRvYwpA
QCAtMSw0ICsxLDQgQEAKLSMgWGVuIExpdmUgUGF0Y2hpbmcgRGVzaWduIHYxCisjIFhlbiBMaXZl
IFBhdGNoaW5nIERlc2lnbiB2MgogCiAjIyBSYXRpb25hbGUKIApAQCAtMjk3LDEwICsyOTcsMTQg
QEAgd2hpY2ggZGVzY3JpYmUgdGhlIGZ1bmN0aW9ucyB0byBiZSBwYXRjaGVkOgogICAgICAgICB1
aW50MzJfdCBvbGRfc2l6ZTsKICAgICAgICAgdWludDhfdCB2ZXJzaW9uOwogICAgICAgICB1aW50
OF90IG9wYXF1ZVszMV07CisgICAgICAgIC8qIEFkZGVkIHRvIGxpdmVwYXRjaCBwYXlsb2FkIHZl
cnNpb24gMjogKi8KKyAgICAgICAgdWludDhfdCBhcHBsaWVkOworICAgICAgICB1aW50OF90IF9w
YWRbN107CiAgICAgfTsKIAogVGhlIHNpemUgb2YgdGhlIHN0cnVjdHVyZSBpcyA2NCBieXRlcyBv
biA2NC1iaXQgaHlwZXJ2aXNvcnMuIEl0IHdpbGwgYmUKIDUyIG9uIDMyLWJpdCBoeXBlcnZpc29y
cy4KK1RoZSB2ZXJzaW9uIDIgb2YgdGhlIHBheWxvYWQgYWRkcyBhZGRpdGlvbmFsIDggYnl0ZXMg
dG8gdGhlIHN0cnVjdHVyZSBzaXplLgogCiAgKiBgbmFtZWAgaXMgdGhlIHN5bWJvbCBuYW1lIG9m
IHRoZSBvbGQgZnVuY3Rpb24uIE9ubHkgdXNlZCBpZiBgb2xkX2FkZHJgIGlzCiAgICB6ZXJvLCBv
dGhlcndpc2Ugd2lsbCBiZSB1c2VkIGR1cmluZyBkeW5hbWljIGxpbmtpbmcgKHdoZW4gaHlwZXJ2
aXNvciBsb2FkcwpAQCAtMzI0LDkgKzMyOCwxNSBAQCBUaGUgc2l6ZSBvZiB0aGUgc3RydWN0dXJl
IGlzIDY0IGJ5dGVzIG9uIDY0LWJpdCBoeXBlcnZpc29ycy4gSXQgd2lsbCBiZQogICAgKiBJZiB0
aGUgdmFsdWUgb2YgYG5ld19hZGRyYCBpcyB6ZXJvIHRoZW4gYG5ld19zaXplYCBkZXRlcm1pbmVz
IGhvdyBtYW55CiAgICAgaW5zdHJ1Y3Rpb24gYnl0ZXMgdG8gTk9QICh1cCB0byBvcGFxdWUgc2l6
ZSBtb2R1bG8gc21hbGxlc3QgcGxhdGZvcm0KICAgICBpbnN0cnVjdGlvbiAtIDEgYnl0ZSB4ODYg
YW5kIDQgYnl0ZXMgb24gQVJNKS4KLSAqIGB2ZXJzaW9uYCBpcyB0byBiZSBvbmUuCisgKiBgdmVy
c2lvbmAgaW5kaWNhdGVzIHZlcnNpb24gb2YgdGhlIGdlbmVyYXRlZCBwYXlsb2FkLgogICogYG9w
YXF1ZWAgKipNVVNUKiogYmUgemVyby4KIAorVGhlIHZlcnNpb24gMiBvZiB0aGUgcGF5bG9hZCBh
ZGRzIHRoZSBmb2xsb3dpbmcgZmllbGRzIHRvIHRoZSBzdHJ1Y3R1cmU6CisKKyAgKiBgYXBwbGll
ZGAgdHJhY2tzIGZ1bmN0aW9uJ3MgYXBwbGllZC9yZXZlcnRlZCBzdGF0ZS4gSXQgaGFzIGEgYm9v
bGVhbiB0eXBlCisgICAgZWl0aGVyIExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVEIG9yIExJVkVQ
QVRDSF9GVU5DX0FQUExJRUQuCisgICogYF9wYWRbN11gIGFkZHMgcGFkZGluZyB0byBhbGlnbiB0
byA4IGJ5dGVzLgorCiBUaGUgc2l6ZSBvZiB0aGUgYGxpdmVwYXRjaF9mdW5jYCBhcnJheSBpcyBk
ZXRlcm1pbmVkIGZyb20gdGhlIEVMRiBzZWN0aW9uCiBzaXplLgogCkBAIC0zNzgsNiArMzg4LDkg
QEAgQSBzaW1wbGUgZXhhbXBsZSBvZiB3aGF0IGEgcGF5bG9hZCBmaWxlIGNhbiBiZToKICAgICAg
ICAgdWludDMyX3Qgb2xkX3NpemU7CiAgICAgICAgIHVpbnQ4X3QgdmVyc2lvbjsKICAgICAgICAg
dWludDhfdCBwYWRbMzFdOworICAgICAgICAvKiBBZGRlZCB0byBsaXZlcGF0Y2ggcGF5bG9hZCB2
ZXJzaW9uIDI6ICovCisgICAgICAgIHVpbnQ4X3QgYXBwbGllZDsKKyAgICAgICAgdWludDhfdCBf
cGFkWzddOwogICAgIH07CiAKICAgICAvKiBPdXIgcmVwbGFjZW1lbnQgZnVuY3Rpb24gZm9yIHhl
bl9leHRyYV92ZXJzaW9uLiAqLwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL2FybTMyL2xpdmVw
YXRjaC5jIGIveGVuL2FyY2gvYXJtL2FybTMyL2xpdmVwYXRjaC5jCmluZGV4IDQxMzc4YTU0YWUu
Ljc2NzgwZDY5YmYgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL2FybS9hcm0zMi9saXZlcGF0Y2guYwor
KysgYi94ZW4vYXJjaC9hcm0vYXJtMzIvbGl2ZXBhdGNoLmMKQEAgLTIyLDkgKzIyLDE2IEBAIHZv
aWQgYXJjaF9saXZlcGF0Y2hfYXBwbHkoc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jKQogCiAg
ICAgQVNTRVJUKHZtYXBfb2ZfeGVuX3RleHQpOwogCisgICAgLyoKKyAgICAgKiBJZiB0aGUgYXBw
bHkgYWN0aW9uIGhhcyBiZWVuIGFscmVhZHkgZXhlY3V0ZWQKKyAgICAgKiBvbiB0aGlzIGZ1bmN0
aW9uLCBkbyBub3RoaW5nLi4uCisgICAgICovCisgICAgaWYgKCBpc19mdW5jX2FwcGxpZWQoZnVu
YykgKQorICAgICAgICByZXR1cm47CisKICAgICBsZW4gPSBsaXZlcGF0Y2hfaW5zbl9sZW4oZnVu
Yyk7CiAgICAgaWYgKCAhbGVuICkKLSAgICAgICAgcmV0dXJuOworICAgICAgICBnb3RvIGFwcGxp
ZWQ7CiAKICAgICAvKiBTYXZlIG9sZCBvbmVzLiAqLwogICAgIG1lbWNweShmdW5jLT5vcGFxdWUs
IGZ1bmMtPm9sZF9hZGRyLCBsZW4pOwpAQCAtNzMsNiArODAsOSBAQCB2b2lkIGFyY2hfbGl2ZXBh
dGNoX2FwcGx5KHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAqZnVuYykKICAgICBpZiAoIGZ1bmMtPm5l
d19hZGRyICkKICAgICAgICAgY2xlYW5fYW5kX2ludmFsaWRhdGVfZGNhY2hlX3ZhX3JhbmdlKGZ1
bmMtPm5ld19hZGRyLCBmdW5jLT5uZXdfc2l6ZSk7CiAgICAgY2xlYW5fYW5kX2ludmFsaWRhdGVf
ZGNhY2hlX3ZhX3JhbmdlKG5ld19wdHIsIHNpemVvZiAoKm5ld19wdHIpICogbGVuKTsKKworYXBw
bGllZDoKKyAgICBmdW5jLT5hcHBsaWVkID0gTElWRVBBVENIX0ZVTkNfQVBQTElFRDsKIH0KIAog
LyogYXJjaF9saXZlcGF0Y2hfcmV2ZXJ0IHNoYXJlZCB3aXRoIEFSTSAzMi9BUk0gNjQuICovCmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0vYXJtNjQvbGl2ZXBhdGNoLmMgYi94ZW4vYXJjaC9hcm0v
YXJtNjQvbGl2ZXBhdGNoLmMKaW5kZXggNWM3NTc3OTI4NC4uNjFhNzY0ODE2YyAxMDA2NDQKLS0t
IGEveGVuL2FyY2gvYXJtL2FybTY0L2xpdmVwYXRjaC5jCisrKyBiL3hlbi9hcmNoL2FybS9hcm02
NC9saXZlcGF0Y2guYwpAQCAtMjYsOSArMjYsMTYgQEAgdm9pZCBhcmNoX2xpdmVwYXRjaF9hcHBs
eShzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMpCiAKICAgICBBU1NFUlQodm1hcF9vZl94ZW5f
dGV4dCk7CiAKKyAgICAvKgorICAgICAqIElmIHRoZSBhcHBseSBhY3Rpb24gaGFzIGJlZW4gYWxy
ZWFkeSBleGVjdXRlZAorICAgICAqIG9uIHRoaXMgZnVuY3Rpb24sIGRvIG5vdGhpbmcuLi4KKyAg
ICAgKi8KKyAgICBpZiAoIGlzX2Z1bmNfYXBwbGllZChmdW5jKSApCisgICAgICAgICByZXR1cm47
CisKICAgICBsZW4gPSBsaXZlcGF0Y2hfaW5zbl9sZW4oZnVuYyk7CiAgICAgaWYgKCAhbGVuICkK
LSAgICAgICAgcmV0dXJuOworICAgICAgICBnb3RvIGFwcGxpZWQ7CiAKICAgICAvKiBTYXZlIG9s
ZCBvbmVzLiAqLwogICAgIG1lbWNweShmdW5jLT5vcGFxdWUsIGZ1bmMtPm9sZF9hZGRyLCBsZW4p
OwpAQCAtNjAsNiArNjcsOSBAQCB2b2lkIGFyY2hfbGl2ZXBhdGNoX2FwcGx5KHN0cnVjdCBsaXZl
cGF0Y2hfZnVuYyAqZnVuYykKICAgICBpZiAoIGZ1bmMtPm5ld19hZGRyICkKICAgICAgICAgY2xl
YW5fYW5kX2ludmFsaWRhdGVfZGNhY2hlX3ZhX3JhbmdlKGZ1bmMtPm5ld19hZGRyLCBmdW5jLT5u
ZXdfc2l6ZSk7CiAgICAgY2xlYW5fYW5kX2ludmFsaWRhdGVfZGNhY2hlX3ZhX3JhbmdlKG5ld19w
dHIsIHNpemVvZiAoKm5ld19wdHIpICogbGVuKTsKKworYXBwbGllZDoKKyAgICBmdW5jLT5hcHBs
aWVkID0gTElWRVBBVENIX0ZVTkNfQVBQTElFRDsKIH0KIAogLyogYXJjaF9saXZlcGF0Y2hfcmV2
ZXJ0IHNoYXJlZCB3aXRoIEFSTSAzMi9BUk0gNjQuICovCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9h
cm0vbGl2ZXBhdGNoLmMgYi94ZW4vYXJjaC9hcm0vbGl2ZXBhdGNoLmMKaW5kZXggMjc5ZDUyY2M2
Yy4uMDIyNDAyZDU1ZiAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL2xpdmVwYXRjaC5jCisrKyBi
L3hlbi9hcmNoL2FybS9saXZlcGF0Y2guYwpAQCAtNzMsMTcgKzczLDI1IEBAIGludCBhcmNoX2xp
dmVwYXRjaF92ZXJpZnlfZnVuYyhjb25zdCBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMpCiAg
ICAgcmV0dXJuIDA7CiB9CiAKLXZvaWQgYXJjaF9saXZlcGF0Y2hfcmV2ZXJ0KGNvbnN0IHN0cnVj
dCBsaXZlcGF0Y2hfZnVuYyAqZnVuYykKK3ZvaWQgYXJjaF9saXZlcGF0Y2hfcmV2ZXJ0KHN0cnVj
dCBsaXZlcGF0Y2hfZnVuYyAqZnVuYykKIHsKICAgICB1aW50MzJfdCAqbmV3X3B0cjsKICAgICB1
bnNpZ25lZCBpbnQgbGVuOwogCisgICAgLyoKKyAgICAgKiBJZiB0aGUgYXBwbHkgYWN0aW9uIGhh
c24ndCBiZWVuIGV4ZWN1dGVkCisgICAgICogb24gdGhpcyBmdW5jdGlvbiwgZG8gbm90aGluZy4u
LgorICAgICAqLworICAgIGlmICggaXNfZnVuY19yZXZlcnRlZChmdW5jKSApCisgICAgICAgIHJl
dHVybjsKKwogICAgIG5ld19wdHIgPSBmdW5jLT5vbGRfYWRkciAtICh2b2lkICopX3N0YXJ0ICsg
dm1hcF9vZl94ZW5fdGV4dDsKIAogICAgIGxlbiA9IGxpdmVwYXRjaF9pbnNuX2xlbihmdW5jKTsK
ICAgICBtZW1jcHkobmV3X3B0ciwgZnVuYy0+b3BhcXVlLCBsZW4pOwogCiAgICAgY2xlYW5fYW5k
X2ludmFsaWRhdGVfZGNhY2hlX3ZhX3JhbmdlKG5ld19wdHIsIGxlbik7CisgICAgZnVuYy0+YXBw
bGllZCA9IExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVEOwogfQogCiB2b2lkIGFyY2hfbGl2ZXBh
dGNoX3Bvc3RfYWN0aW9uKHZvaWQpCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvbGl2ZXBhdGNo
LmMgYi94ZW4vYXJjaC94ODYvbGl2ZXBhdGNoLmMKaW5kZXggYzgyY2Y1M2I5ZS4uNTcwMWM5MGU0
OCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2xpdmVwYXRjaC5jCisrKyBiL3hlbi9hcmNoL3g4
Ni9saXZlcGF0Y2guYwpAQCAtNTYsMTAgKzU2LDE3IEBAIHZvaWQgbm9pbmxpbmUgYXJjaF9saXZl
cGF0Y2hfYXBwbHkoc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jKQogICAgIHVpbnQ4X3QgaW5z
bltzaXplb2YoZnVuYy0+b3BhcXVlKV07CiAgICAgdW5zaWduZWQgaW50IGxlbjsKIAorICAgIC8q
CisgICAgICogSWYgdGhlIGFwcGx5IGFjdGlvbiBoYXMgYmVlbiBhbHJlYWR5IGV4ZWN1dGVkCisg
ICAgICogb24gdGhpcyBmdW5jdGlvbiwgZG8gbm90aGluZy4uLgorICAgICAqLworICAgIGlmICgg
aXNfZnVuY19hcHBsaWVkKGZ1bmMpICkKKyAgICAgICAgIHJldHVybjsKKwogICAgIG9sZF9wdHIg
PSBmdW5jLT5vbGRfYWRkcjsKICAgICBsZW4gPSBsaXZlcGF0Y2hfaW5zbl9sZW4oZnVuYyk7CiAg
ICAgaWYgKCAhbGVuICkKLSAgICAgICAgcmV0dXJuOworICAgICAgICBnb3RvIGFwcGxpZWQ7CiAK
ICAgICBtZW1jcHkoZnVuYy0+b3BhcXVlLCBvbGRfcHRyLCBsZW4pOwogICAgIGlmICggZnVuYy0+
bmV3X2FkZHIgKQpAQCAtNzcsMTUgKzg0LDI2IEBAIHZvaWQgbm9pbmxpbmUgYXJjaF9saXZlcGF0
Y2hfYXBwbHkoc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jKQogICAgICAgICBhZGRfbm9wcyhp
bnNuLCBsZW4pOwogCiAgICAgbWVtY3B5KG9sZF9wdHIsIGluc24sIGxlbik7CisKK2FwcGxpZWQ6
CisgICAgZnVuYy0+YXBwbGllZCA9IExJVkVQQVRDSF9GVU5DX0FQUExJRUQ7CiB9CiAKIC8qCiAg
KiAibm9pbmxpbmUiIHRvIGNhdXNlIGNvbnRyb2wgZmxvdyBjaGFuZ2UgYW5kIHRodXMgaW52YWxp
ZGF0ZSBJJCBhbmQKICAqIGNhdXNlIHJlZmV0Y2ggYWZ0ZXIgbW9kaWZpY2F0aW9uLgogICovCi12
b2lkIG5vaW5saW5lIGFyY2hfbGl2ZXBhdGNoX3JldmVydChjb25zdCBzdHJ1Y3QgbGl2ZXBhdGNo
X2Z1bmMgKmZ1bmMpCit2b2lkIG5vaW5saW5lIGFyY2hfbGl2ZXBhdGNoX3JldmVydChzdHJ1Y3Qg
bGl2ZXBhdGNoX2Z1bmMgKmZ1bmMpCiB7CisgICAgLyoKKyAgICAgKiBJZiB0aGUgYXBwbHkgYWN0
aW9uIGhhc24ndCBiZWVuIGV4ZWN1dGVkCisgICAgICogb24gdGhpcyBmdW5jdGlvbiwgZG8gbm90
aGluZy4uLgorICAgICAqLworICAgIGlmICggaXNfZnVuY19yZXZlcnRlZChmdW5jKSApCisgICAg
ICAgIHJldHVybjsKKwogICAgIG1lbWNweShmdW5jLT5vbGRfYWRkciwgZnVuYy0+b3BhcXVlLCBs
aXZlcGF0Y2hfaW5zbl9sZW4oZnVuYykpOworICAgIGZ1bmMtPmFwcGxpZWQgPSBMSVZFUEFUQ0hf
RlVOQ19OT1RfQVBQTElFRDsKIH0KIAogLyoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vbGl2ZXBh
dGNoLmMgYi94ZW4vY29tbW9uL2xpdmVwYXRjaC5jCmluZGV4IDcwNWI1YjgxNTEuLmQ3NjYxOTg0
NGMgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vbGl2ZXBhdGNoLmMKKysrIGIveGVuL2NvbW1vbi9s
aXZlcGF0Y2guYwpAQCAtMTI0MCw2ICsxMjQwLDI5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCByZXZl
cnRfcGF5bG9hZF90YWlsKHN0cnVjdCBwYXlsb2FkICpkYXRhKQogICAgIGRhdGEtPnN0YXRlID0g
TElWRVBBVENIX1NUQVRFX0NIRUNLRUQ7CiB9CiAKKy8qCisgKiBDaGVjayBpZiBhbiBhY3Rpb24g
aGFzIGFwcGxpZWQgdGhlIHNhbWUgc3RhdGUgdG8gYWxsIHBheWxvYWQncyBmdW5jdGlvbnMgY29u
c2lzdGVudGx5LgorICovCitzdGF0aWMgaW5saW5lIGJvb2wgd2FzX2FjdGlvbl9jb25zaXN0ZW50
KGNvbnN0IHN0cnVjdCBwYXlsb2FkICpkYXRhLCBsaXZlcGF0Y2hfZnVuY19zdGF0ZV90IGV4cGVj
dGVkX3N0YXRlKQoreworICAgIGludCBpOworCisgICAgZm9yICggaSA9IDA7IGkgPCBkYXRhLT5u
ZnVuY3M7IGkrKyApCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmYgPSAm
KGRhdGEtPmZ1bmNzW2ldKTsKKworICAgICAgICBpZiAoIGYtPmFwcGxpZWQgIT0gZXhwZWN0ZWRf
c3RhdGUgKQorICAgICAgICB7CisgICAgICAgICAgICBwcmludGsoWEVOTE9HX0VSUiBMSVZFUEFU
Q0ggIiVzOiBQYXlsb2FkIGhhcyBhIGZ1bmN0aW9uOiAnJXMnIHdpdGggaW5jb25zaXN0ZW50IGFw
cGxpZWQgc3RhdGUuXG4iLAorICAgICAgICAgICAgICAgICAgIGRhdGEtPm5hbWUsIGYtPm5hbWUg
PzogIm5vbmFtZSIpOworCisgICAgICAgICAgICByZXR1cm4gZmFsc2U7CisgICAgICAgIH0KKyAg
ICB9CisKKyAgICByZXR1cm4gdHJ1ZTsKK30KKwogLyoKICAqIFRoaXMgZnVuY3Rpb24gaXMgZXhl
Y3V0ZWQgaGF2aW5nIGFsbCBvdGhlciBDUFVzIHdpdGggbm8gZGVlcCBzdGFjayAod2UgbWF5CiAg
KiBoYXZlIGNwdV9pZGxlIG9uIGl0KSBhbmQgSVJRcyBkaXNhYmxlZC4KQEAgLTEyNjYsNiArMTI4
OSw5IEBAIHN0YXRpYyB2b2lkIGxpdmVwYXRjaF9kb19hY3Rpb24odm9pZCkKICAgICAgICAgZWxz
ZQogICAgICAgICAgICAgcmMgPSBhcHBseV9wYXlsb2FkKGRhdGEpOwogCisgICAgICAgIGlmICgg
IXdhc19hY3Rpb25fY29uc2lzdGVudChkYXRhLCByYyA/IExJVkVQQVRDSF9GVU5DX05PVF9BUFBM
SUVEIDogTElWRVBBVENIX0ZVTkNfQVBQTElFRCkgKQorICAgICAgICAgICAgcGFuaWMoImxpdmVw
YXRjaDogcGFydGlhbGx5IGFwcGxpZWQgcGF5bG9hZCAnJXMnIVxuIiwgZGF0YS0+bmFtZSk7CisK
ICAgICAgICAgaWYgKCByYyA9PSAwICkKICAgICAgICAgICAgIGFwcGx5X3BheWxvYWRfdGFpbChk
YXRhKTsKICAgICAgICAgYnJlYWs7CkBAIC0xMjgwLDYgKzEzMDYsOSBAQCBzdGF0aWMgdm9pZCBs
aXZlcGF0Y2hfZG9fYWN0aW9uKHZvaWQpCiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIHJjID0g
cmV2ZXJ0X3BheWxvYWQoZGF0YSk7CiAKKyAgICAgICAgaWYgKCAhd2FzX2FjdGlvbl9jb25zaXN0
ZW50KGRhdGEsIHJjID8gTElWRVBBVENIX0ZVTkNfQVBQTElFRCA6IExJVkVQQVRDSF9GVU5DX05P
VF9BUFBMSUVEKSApCisgICAgICAgICAgICBwYW5pYygibGl2ZXBhdGNoOiBwYXJ0aWFsbHkgcmV2
ZXJ0ZWQgcGF5bG9hZCAnJXMnIVxuIiwgZGF0YS0+bmFtZSk7CisKICAgICAgICAgaWYgKCByYyA9
PSAwICkKICAgICAgICAgICAgIHJldmVydF9wYXlsb2FkX3RhaWwoZGF0YSk7CiAgICAgICAgIGJy
ZWFrOwpAQCAtMTMwMiw2ICsxMzMxLDkgQEAgc3RhdGljIHZvaWQgbGl2ZXBhdGNoX2RvX2FjdGlv
bih2b2lkKQogICAgICAgICAgICAgICAgIG90aGVyLT5yYyA9IHJldmVydF9wYXlsb2FkKG90aGVy
KTsKIAogCisgICAgICAgICAgICBpZiAoICF3YXNfYWN0aW9uX2NvbnNpc3RlbnQob3RoZXIsIHJj
ID8gTElWRVBBVENIX0ZVTkNfQVBQTElFRCA6IExJVkVQQVRDSF9GVU5DX05PVF9BUFBMSUVEKSAp
CisgICAgICAgICAgICAgICAgcGFuaWMoImxpdmVwYXRjaDogcGFydGlhbGx5IHJldmVydGVkIHBh
eWxvYWQgJyVzJyFcbiIsIG90aGVyLT5uYW1lKTsKKwogICAgICAgICAgICAgaWYgKCBvdGhlci0+
cmMgPT0gMCApCiAgICAgICAgICAgICAgICAgcmV2ZXJ0X3BheWxvYWRfdGFpbChvdGhlcik7CiAg
ICAgICAgICAgICBlbHNlCkBAIC0xMzIyLDYgKzEzNTQsOSBAQCBzdGF0aWMgdm9pZCBsaXZlcGF0
Y2hfZG9fYWN0aW9uKHZvaWQpCiAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgcmMg
PSBhcHBseV9wYXlsb2FkKGRhdGEpOwogCisgICAgICAgICAgICBpZiAoICF3YXNfYWN0aW9uX2Nv
bnNpc3RlbnQoZGF0YSwgcmMgPyBMSVZFUEFUQ0hfRlVOQ19OT1RfQVBQTElFRCA6IExJVkVQQVRD
SF9GVU5DX0FQUExJRUQpICkKKyAgICAgICAgICAgICAgICBwYW5pYygibGl2ZXBhdGNoOiBwYXJ0
aWFsbHkgYXBwbGllZCBwYXlsb2FkICclcychXG4iLCBkYXRhLT5uYW1lKTsKKwogICAgICAgICAg
ICAgaWYgKCByYyA9PSAwICkKICAgICAgICAgICAgICAgICBhcHBseV9wYXlsb2FkX3RhaWwoZGF0
YSk7CiAgICAgICAgIH0KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaCBi
L3hlbi9pbmNsdWRlL3B1YmxpYy9zeXNjdGwuaAppbmRleCAxYjJiMTY1YTZkLi4zYmNiODkyY2Ux
IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9wdWJsaWMvc3lzY3RsLmgKKysrIGIveGVuL2luY2x1
ZGUvcHVibGljL3N5c2N0bC5oCkBAIC04MTgsNyArODE4LDcgQEAgc3RydWN0IHhlbl9zeXNjdGxf
Y3B1X2ZlYXR1cmVzZXQgewogICogICAgIElmIHplcm8gZXhpdCB3aXRoIHN1Y2Nlc3MuCiAgKi8K
IAotI2RlZmluZSBMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OIDEKKyNkZWZpbmUgTElWRVBBVENI
X1BBWUxPQURfVkVSU0lPTiAyCiAvKgogICogLmxpdmVwYXRjaC5mdW5jcyBzdHJ1Y3R1cmUgbGF5
b3V0IGRlZmluZWQgaW4gdGhlIGBQYXlsb2FkIGZvcm1hdGAKICAqIHNlY3Rpb24gaW4gdGhlIExp
dmUgUGF0Y2ggZGVzaWduIGRvY3VtZW50LgpAQCAtODI2LDYgKzgyNiwxMSBAQCBzdHJ1Y3QgeGVu
X3N5c2N0bF9jcHVfZmVhdHVyZXNldCB7CiAgKiBXZSBndWFyZCB0aGlzIHdpdGggX19YRU5fXyBh
cyB0b29sc3RhY2tzIFNIT1VMRCBub3QgdXNlIGl0LgogICovCiAjaWZkZWYgX19YRU5fXwordHlw
ZWRlZiBlbnVtIGxpdmVwYXRjaF9mdW5jX3N0YXRlIHsKKyAgICBMSVZFUEFUQ0hfRlVOQ19OT1Rf
QVBQTElFRCwKKyAgICBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVECit9IGxpdmVwYXRjaF9mdW5jX3N0
YXRlX3Q7CisKIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyB7CiAgICAgY29uc3QgY2hhciAqbmFtZTsg
ICAgICAgLyogTmFtZSBvZiBmdW5jdGlvbiB0byBiZSBwYXRjaGVkLiAqLwogICAgIHZvaWQgKm5l
d19hZGRyOwpAQCAtODM0LDYgKzgzOSw4IEBAIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyB7CiAgICAg
dWludDMyX3Qgb2xkX3NpemU7CiAgICAgdWludDhfdCB2ZXJzaW9uOyAgICAgICAgLyogTVVTVCBi
ZSBMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OLiAqLwogICAgIHVpbnQ4X3Qgb3BhcXVlWzMxXTsK
KyAgICB1aW50OF90IGFwcGxpZWQ7CisgICAgdWludDhfdCBfcGFkWzddOwogfTsKIHR5cGVkZWYg
c3RydWN0IGxpdmVwYXRjaF9mdW5jIGxpdmVwYXRjaF9mdW5jX3Q7CiAjZW5kaWYKZGlmZiAtLWdp
dCBhL3hlbi9pbmNsdWRlL3hlbi9saXZlcGF0Y2guaCBiL3hlbi9pbmNsdWRlL3hlbi9saXZlcGF0
Y2guaAppbmRleCAyYWVjNTMyZWUyLi4yOGY5NTM2Nzc2IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVk
ZS94ZW4vbGl2ZXBhdGNoLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL2xpdmVwYXRjaC5oCkBAIC0x
MDksNiArMTA5LDMxIEBAIHN0YXRpYyBpbmxpbmUgaW50IGxpdmVwYXRjaF92ZXJpZnlfZGlzdGFu
Y2UoY29uc3Qgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jKQogCiAgICAgcmV0dXJuIDA7CiB9
CisKK3N0YXRpYyBpbmxpbmUgYm9vbF90IGlzX2Z1bmNfYXBwbGllZChjb25zdCBzdHJ1Y3QgbGl2
ZXBhdGNoX2Z1bmMgKmZ1bmMpCit7CisgICAgaWYgKCBmdW5jLT5hcHBsaWVkID09IExJVkVQQVRD
SF9GVU5DX0FQUExJRUQgKQorICAgIHsKKyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIExJ
VkVQQVRDSCAiJXM6ICVzIGhhcyBiZWVuIGFscmVhZHkgYXBwbGllZCBiZWZvcmVcbiIsCisgICAg
ICAgICAgICAgICAgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgICAgICByZXR1cm4gdHJ1ZTsK
KyAgICB9CisKKyAgICByZXR1cm4gZmFsc2U7Cit9CisKK3N0YXRpYyBpbmxpbmUgYm9vbF90IGlz
X2Z1bmNfcmV2ZXJ0ZWQoY29uc3Qgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jKQoreworICAg
IGlmICggIWZ1bmMtPm9sZF9hZGRyIHx8IGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNf
Tk9UX0FQUExJRUQgKQorICAgIHsKKyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIExJVkVQ
QVRDSCAiJXM6ICVzIGhhcyBub3QgYmVlbiBhcHBsaWVkIGJlZm9yZVxuIiwKKyAgICAgICAgICAg
ICAgICBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7CisgICAgICAgIHJldHVybiB0cnVlOworICAgIH0K
KworICAgIHJldHVybiBmYWxzZTsKK30KKwogLyoKICAqIFRoZXNlIGZ1bmN0aW9ucyBhcmUgY2Fs
bGVkIGFyb3VuZCB0aGUgY3JpdGljYWwgcmVnaW9uIHBhdGNoaW5nIGxpdmUgY29kZSwKICAqIGZv
ciBhbiBhcmNoaXRlY3R1cmUgdG8gdGFrZSBtYWtlIGFwcHJvcHJhdGllIGdsb2JhbCBzdGF0ZSBh
ZGp1c3RtZW50cy4KQEAgLTExNyw3ICsxNDIsNyBAQCBpbnQgYXJjaF9saXZlcGF0Y2hfcXVpZXNj
ZSh2b2lkKTsKIHZvaWQgYXJjaF9saXZlcGF0Y2hfcmV2aXZlKHZvaWQpOwogCiB2b2lkIGFyY2hf
bGl2ZXBhdGNoX2FwcGx5KHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAqZnVuYyk7Ci12b2lkIGFyY2hf
bGl2ZXBhdGNoX3JldmVydChjb25zdCBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMpOwordm9p
ZCBhcmNoX2xpdmVwYXRjaF9yZXZlcnQoc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jKTsKIHZv
aWQgYXJjaF9saXZlcGF0Y2hfcG9zdF9hY3Rpb24odm9pZCk7CiAKIHZvaWQgYXJjaF9saXZlcGF0
Y2hfbWFzayh2b2lkKTsKZGlmZiAtLWdpdCBhL3hlbi90ZXN0L2xpdmVwYXRjaC9NYWtlZmlsZSBi
L3hlbi90ZXN0L2xpdmVwYXRjaC9NYWtlZmlsZQppbmRleCBiYmM2YmRhZjY0Li4yMzExM2QzNDE4
IDEwMDY0NAotLS0gYS94ZW4vdGVzdC9saXZlcGF0Y2gvTWFrZWZpbGUKKysrIGIveGVuL3Rlc3Qv
bGl2ZXBhdGNoL01ha2VmaWxlCkBAIC0yNCw2ICsyNCw5IEBAIExJVkVQQVRDSF9QUkVQT1NUX0hP
T0tTIDo9IHhlbl9wcmVwb3N0X2hvb2tzLmxpdmVwYXRjaAogTElWRVBBVENIX1BSRVBPU1RfSE9P
S1NfRkFJTCA6PSB4ZW5fcHJlcG9zdF9ob29rc19mYWlsLmxpdmVwYXRjaAogTElWRVBBVENIX0FD
VElPTl9IT09LUyA6PSB4ZW5fYWN0aW9uX2hvb2tzLmxpdmVwYXRjaAogTElWRVBBVENIX0FDVElP
Tl9IT09LU19OT0ZVTkMgOj0geGVuX2FjdGlvbl9ob29rc19ub2Z1bmMubGl2ZXBhdGNoCitMSVZF
UEFUQ0hfQUNUSU9OX0hPT0tTX01BUktFUjo9IHhlbl9hY3Rpb25faG9va3NfbWFya2VyLmxpdmVw
YXRjaAorTElWRVBBVENIX0FDVElPTl9IT09LU19OT0FQUExZOj0geGVuX2FjdGlvbl9ob29rc19u
b2FwcGx5LmxpdmVwYXRjaAorTElWRVBBVENIX0FDVElPTl9IT09LU19OT1JFVkVSVDo9IHhlbl9h
Y3Rpb25faG9va3Nfbm9yZXZlcnQubGl2ZXBhdGNoCiAKIExJVkVQQVRDSEVTICs9ICQoTElWRVBB
VENIKQogTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfQllFKQpAQCAtMzQsNiArMzcsOSBAQCBM
SVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9QUkVQT1NUX0hPT0tTKQogTElWRVBBVENIRVMgKz0g
JChMSVZFUEFUQ0hfUFJFUE9TVF9IT09LU19GQUlMKQogTElWRVBBVENIRVMgKz0gJChMSVZFUEFU
Q0hfQUNUSU9OX0hPT0tTKQogTElWRVBBVENIRVMgKz0gJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tT
X05PRlVOQykKK0xJVkVQQVRDSEVTICs9ICQoTElWRVBBVENIX0FDVElPTl9IT09LU19NQVJLRVIp
CitMSVZFUEFUQ0hFUyArPSAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9BUFBMWSkKK0xJVkVQ
QVRDSEVTICs9ICQoTElWRVBBVENIX0FDVElPTl9IT09LU19OT1JFVkVSVCkKIAogTElWRVBBVENI
X0RFQlVHX0RJUiA/PSAkKERFQlVHX0RJUikveGVuLWxpdmVwYXRjaAogCkBAIC0xNTgsNyArMTY0
LDI2IEBAICQoTElWRVBBVENIX0FDVElPTl9IT09LUyk6IHhlbl9hY3Rpb25faG9va3MubyB4ZW5f
aGVsbG9fd29ybGRfZnVuYy5vIG5vdGUubyB4ZW5fCiAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1Nf
Tk9GVU5DKTogeGVuX2FjdGlvbl9ob29rc19ub2Z1bmMubyBub3RlLm8geGVuX25vdGUubwogCSQo
TEQpICQoTERGTEFHUykgJChidWlsZF9pZF9saW5rZXIpIC1yIC1vICQoTElWRVBBVENIX0FDVElP
Tl9IT09LU19OT0ZVTkMpICReCiAKK3hlbl9hY3Rpb25zX2hvb2tzX21hcmtlci5vOiBjb25maWcu
aAorCisuUEhPTlk6ICQoTElWRVBBVENIX0FDVElPTl9IT09LU19NQVJLRVIpCiskKExJVkVQQVRD
SF9BQ1RJT05fSE9PS1NfTUFSS0VSKTogeGVuX2FjdGlvbl9ob29rc19tYXJrZXIubyB4ZW5faGVs
bG9fd29ybGRfZnVuYy5vIG5vdGUubyB4ZW5fbm90ZS5vCisJJChMRCkgJChMREZMQUdTKSAkKGJ1
aWxkX2lkX2xpbmtlcikgLXIgLW8gJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX01BUktFUikgJF4K
KworeGVuX2FjdGlvbnNfaG9va3Nfbm9hcHBseS5vOiBjb25maWcuaAorCisuUEhPTlk6ICQoTElW
RVBBVENIX0FDVElPTl9IT09LU19OT0FQUExZKQorJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX05P
QVBQTFkpOiB4ZW5fYWN0aW9uX2hvb2tzX21hcmtlci5vIHhlbl9oZWxsb193b3JsZF9mdW5jLm8g
bm90ZS5vIHhlbl9ub3RlLm8KKwkkKExEKSAkKExERkxBR1MpICQoYnVpbGRfaWRfbGlua2VyKSAt
ciAtbyAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9BUFBMWSkgJF4KKworeGVuX2FjdGlvbnNf
aG9va3Nfbm9yZXZlcnQubzogY29uZmlnLmgKKworLlBIT05ZOiAkKExJVkVQQVRDSF9BQ1RJT05f
SE9PS1NfTk9SRVZFUlQpCiskKExJVkVQQVRDSF9BQ1RJT05fSE9PS1NfTk9SRVZFUlQpOiB4ZW5f
YWN0aW9uX2hvb2tzX21hcmtlci5vIHhlbl9oZWxsb193b3JsZF9mdW5jLm8gbm90ZS5vIHhlbl9u
b3RlLm8KKwkkKExEKSAkKExERkxBR1MpICQoYnVpbGRfaWRfbGlua2VyKSAtciAtbyAkKExJVkVQ
QVRDSF9BQ1RJT05fSE9PS1NfTk9SRVZFUlQpICReCisKIC5QSE9OWTogbGl2ZXBhdGNoCiBsaXZl
cGF0Y2g6ICQoTElWRVBBVENIKSAkKExJVkVQQVRDSF9CWUUpICQoTElWRVBBVENIX1JFUExBQ0Up
ICQoTElWRVBBVENIX05PUCkgJChMSVZFUEFUQ0hfTk9fWEVOX0JVSUxESUQpIFwKICAgICAgICAg
ICAgJChMSVZFUEFUQ0hfUFJFUE9TVF9IT09LUykgJChMSVZFUEFUQ0hfUFJFUE9TVF9IT09LU19G
QUlMKSAkKExJVkVQQVRDSF9BQ1RJT05fSE9PS1MpIFwKLSAgICAgICAgICAgJChMSVZFUEFUQ0hf
QUNUSU9OX0hPT0tTX05PRlVOQykKKyAgICAgICAgICAgJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tT
X05PRlVOQykgJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tTX01BUktFUikgJChMSVZFUEFUQ0hfQUNU
SU9OX0hPT0tTX05PQVBQTFkpIFwKKyAgICAgICAgICAgJChMSVZFUEFUQ0hfQUNUSU9OX0hPT0tT
X05PUkVWRVJUKQpkaWZmIC0tZ2l0IGEveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9v
a3MuYyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzLmMKaW5kZXggYTk0N2Fm
YzQxZi4uMzliNTMxMzAyNyAxMDA2NDQKLS0tIGEveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rp
b25faG9va3MuYworKysgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rcy5jCkBA
IC0yOCw2ICsyOCw3IEBAIHN0YXRpYyBpbnQgYXBwbHlfaG9vayhsaXZlcGF0Y2hfcGF5bG9hZF90
ICpwYXlsb2FkKQogICAgIHsKICAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jID0g
JnBheWxvYWQtPmZ1bmNzW2ldOwogCisgICAgICAgIGZ1bmMtPmFwcGxpZWQgPSBMSVZFUEFUQ0hf
RlVOQ19BUFBMSUVEOwogICAgICAgICBhcHBseV9jbnQrKzsKIAogICAgICAgICBwcmludGsoS0VS
Tl9ERUJVRyAiJXM6IGFwcGx5aW5nOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOwpAQCAt
NDgsNiArNDksNyBAQCBzdGF0aWMgaW50IHJldmVydF9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3Qg
KnBheWxvYWQpCiAgICAgewogICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAm
cGF5bG9hZC0+ZnVuY3NbaV07CiAKKyAgICAgICAgZnVuYy0+YXBwbGllZCA9IExJVkVQQVRDSF9G
VU5DX05PVF9BUFBMSUVEOwogICAgICAgICByZXZlcnRfY250Kys7CiAKICAgICAgICAgcHJpbnRr
KEtFUk5fREVCVUcgIiVzOiByZXZlcnRpbmc6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7
CmRpZmYgLS1naXQgYS94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19tYXJrZXIu
YyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzX21hcmtlci5jCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAuLjRmODA3YTU3N2YKLS0tIC9kZXYvbnVsbAor
KysgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19tYXJrZXIuYwpAQCAtMCww
ICsxLDExMiBAQAorLyoKKyAqIENvcHlyaWdodCAoYykgMjAxOSBBbWF6b24uY29tLCBJbmMuIG9y
IGl0cyBhZmZpbGlhdGVzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqLworCisjaW5jbHVk
ZSAiY29uZmlnLmgiCisjaW5jbHVkZSA8eGVuL2xpYi5oPgorI2luY2x1ZGUgPHhlbi90eXBlcy5o
PgorI2luY2x1ZGUgPHhlbi92ZXJzaW9uLmg+CisjaW5jbHVkZSA8eGVuL2xpdmVwYXRjaC5oPgor
I2luY2x1ZGUgPHhlbi9saXZlcGF0Y2hfcGF5bG9hZC5oPgorCisjaW5jbHVkZSA8cHVibGljL3N5
c2N0bC5oPgorCitzdGF0aWMgY29uc3QgY2hhciBoZWxsb193b3JsZF9wYXRjaF90aGlzX2ZuY1td
ID0gInhlbl9leHRyYV92ZXJzaW9uIjsKK2V4dGVybiBjb25zdCBjaGFyICp4ZW5faGVsbG9fd29y
bGQodm9pZCk7CisKK3N0YXRpYyBpbnQgcHJlX2FwcGx5X2hvb2sobGl2ZXBhdGNoX3BheWxvYWRf
dCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczog
SG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9IDA7IGkgPCBwYXls
b2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAq
ZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04oZnVuYy0+YXBwbGll
ZCA9PSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcg
IiVzOiBwcmUgYXBwbGllZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisK
KyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKKwor
ICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBwb3N0X2FwcGx5X2hvb2sobGl2ZXBhdGNo
X3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJOX0RF
QlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9IDA7
IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZlcGF0
Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04oZnVu
Yy0+YXBwbGllZCAhPSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRrKEtF
Uk5fREVCVUcgIiVzOiBwb3N0IGFwcGxpZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7
CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1
bmNfXyk7Cit9CisKK3N0YXRpYyBpbnQgcHJlX3JldmVydF9ob29rKGxpdmVwYXRjaF9wYXlsb2Fk
X3QgKnBheWxvYWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6
IEhvb2sgc3RhcnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5
bG9hZC0+bmZ1bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMg
KmZ1bmMgPSAmcGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxp
ZWQgIT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50ayhLRVJOX0RFQlVH
ICIlczogcHJlIHJldmVydGVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0K
KworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOwor
CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHBvc3RfcmV2ZXJ0X2hvb2sobGl2ZXBh
dGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJO
X0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9
IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZl
cGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04o
ZnVuYy0+YXBwbGllZCA9PSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRr
KEtFUk5fREVCVUcgIiVzOiBwb3N0IHJldmVydGVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5h
bWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwg
X19mdW5jX18pOworfQorCitMSVZFUEFUQ0hfUFJFQVBQTFlfSE9PSyhwcmVfYXBwbHlfaG9vayk7
CitMSVZFUEFUQ0hfUE9TVEFQUExZX0hPT0socG9zdF9hcHBseV9ob29rKTsKK0xJVkVQQVRDSF9Q
UkVSRVZFUlRfSE9PSyhwcmVfcmV2ZXJ0X2hvb2spOworTElWRVBBVENIX1BPU1RSRVZFUlRfSE9P
Syhwb3N0X3JldmVydF9ob29rKTsKKworc3RydWN0IGxpdmVwYXRjaF9mdW5jIF9fc2VjdGlvbigi
LmxpdmVwYXRjaC5mdW5jcyIpIGxpdmVwYXRjaF94ZW5faGVsbG9fd29ybGQgPSB7CisgICAgLnZl
cnNpb24gPSBMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OLAorICAgIC5uYW1lID0gaGVsbG9fd29y
bGRfcGF0Y2hfdGhpc19mbmMsCisgICAgLm5ld19hZGRyID0geGVuX2hlbGxvX3dvcmxkLAorICAg
IC5vbGRfYWRkciA9IHhlbl9leHRyYV92ZXJzaW9uLAorICAgIC5uZXdfc2l6ZSA9IE5FV19DT0RF
X1NaLAorICAgIC5vbGRfc2l6ZSA9IE9MRF9DT0RFX1NaLAorfTsKKworLyoKKyAqIExvY2FsIHZh
cmlhYmxlczoKKyAqIG1vZGU6IEMKKyAqIGMtZmlsZS1zdHlsZTogIkJTRCIKKyAqIGMtYmFzaWMt
b2Zmc2V0OiA0CisgKiB0YWItd2lkdGg6IDQKKyAqIGluZGVudC10YWJzLW1vZGU6IG5pbAorICog
RW5kOgorICovCmRpZmYgLS1naXQgYS94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29r
c19ub2FwcGx5LmMgYi94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlvbl9ob29rc19ub2FwcGx5
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMC4uNGM1NWMxNTZhNgotLS0g
L2Rldi9udWxsCisrKyBiL3hlbi90ZXN0L2xpdmVwYXRjaC94ZW5fYWN0aW9uX2hvb2tzX25vYXBw
bHkuYwpAQCAtMCwwICsxLDEzNiBAQAorLyoKKyAqIENvcHlyaWdodCAoYykgMjAxOSBBbWF6b24u
Y29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAq
LworCisjaW5jbHVkZSAiY29uZmlnLmgiCisjaW5jbHVkZSA8eGVuL2xpYi5oPgorI2luY2x1ZGUg
PHhlbi90eXBlcy5oPgorI2luY2x1ZGUgPHhlbi92ZXJzaW9uLmg+CisjaW5jbHVkZSA8eGVuL2xp
dmVwYXRjaC5oPgorI2luY2x1ZGUgPHhlbi9saXZlcGF0Y2hfcGF5bG9hZC5oPgorCisjaW5jbHVk
ZSA8cHVibGljL3N5c2N0bC5oPgorCitzdGF0aWMgY29uc3QgY2hhciBoZWxsb193b3JsZF9wYXRj
aF90aGlzX2ZuY1tdID0gInhlbl9leHRyYV92ZXJzaW9uIjsKK2V4dGVybiBjb25zdCBjaGFyICp4
ZW5faGVsbG9fd29ybGQodm9pZCk7CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgYXBwbHlfY250Owor
CitzdGF0aWMgaW50IHByZV9hcHBseV9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxvYWQp
Cit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3RhcnRp
bmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1bmNz
OyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAmcGF5
bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBB
VENIX0ZVTkNfQVBQTElFRCk7CisgICAgICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogcHJlIGFw
cGxpZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJpbnRr
KEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICByZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBhcHBseV9ob29rKGxpdmVwYXRjaF9wYXlsb2FkX3QgKnBheWxv
YWQpCit7CisgICAgaW50IGk7CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgc3Rh
cnRpbmcuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC0+bmZ1
bmNzOyBpKyspCisgICAgeworICAgICAgICBzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgKmZ1bmMgPSAm
cGF5bG9hZC0+ZnVuY3NbaV07CisKKyAgICAgICAgYXBwbHlfY250Kys7CisgICAgICAgIHByaW50
ayhLRVJOX0RFQlVHICIlczogYXBwbHlpbmc6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7
CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1
bmNfXyk7CisKKyAgICByZXR1cm4gLUVJTlZBTDsgLyogTWFyayBhY3Rpb24gYXMgaW5jb25zaXN0
ZW50ICovCit9CisKK3N0YXRpYyB2b2lkIHBvc3RfYXBwbHlfaG9vayhsaXZlcGF0Y2hfcGF5bG9h
ZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVz
OiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8IHBh
eWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5j
ICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19PTihhcHBseV9jbnQg
IT0gMSk7CisgICAgICAgIEJVR19PTihmdW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5DX0FQ
UExJRUQpOworICAgICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHBvc3QgYXBwbGllZDogJXNc
biIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsKKyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJV
RyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVuY19fKTsKK30KKworc3RhdGljIGludCBwcmVfcmV2
ZXJ0X2hvb2sobGl2ZXBhdGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKwor
ICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsK
KworICAgIGZvciAoaSA9IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAg
ICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKwor
ICAgICAgICBCVUdfT04oZnVuYy0+YXBwbGllZCA9PSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsK
KyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBwcmUgcmV2ZXJ0ZWQ6ICVzXG4iLCBfX2Z1
bmNfXywgZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBI
b29rIGRvbmUuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZv
aWQgcG9zdF9yZXZlcnRfaG9vayhsaXZlcGF0Y2hfcGF5bG9hZF90ICpwYXlsb2FkKQoreworICAg
IGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwg
X19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQor
ICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1
bmNzW2ldOworCisgICAgICAgIEJVR19PTihmdW5jLT5hcHBsaWVkID09IExJVkVQQVRDSF9GVU5D
X0FQUExJRUQpOworICAgICAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IHBvc3QgcmV2ZXJ0ZWQ6
ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5f
REVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1bmNfXyk7Cit9CisKK0xJVkVQQVRDSF9BUFBM
WV9IT09LKGFwcGx5X2hvb2spOworCitMSVZFUEFUQ0hfUFJFQVBQTFlfSE9PSyhwcmVfYXBwbHlf
aG9vayk7CitMSVZFUEFUQ0hfUE9TVEFQUExZX0hPT0socG9zdF9hcHBseV9ob29rKTsKK0xJVkVQ
QVRDSF9QUkVSRVZFUlRfSE9PSyhwcmVfcmV2ZXJ0X2hvb2spOworTElWRVBBVENIX1BPU1RSRVZF
UlRfSE9PSyhwb3N0X3JldmVydF9ob29rKTsKKworc3RydWN0IGxpdmVwYXRjaF9mdW5jIF9fc2Vj
dGlvbigiLmxpdmVwYXRjaC5mdW5jcyIpIGxpdmVwYXRjaF94ZW5faGVsbG9fd29ybGQgPSB7Cisg
ICAgLnZlcnNpb24gPSBMSVZFUEFUQ0hfUEFZTE9BRF9WRVJTSU9OLAorICAgIC5uYW1lID0gaGVs
bG9fd29ybGRfcGF0Y2hfdGhpc19mbmMsCisgICAgLm5ld19hZGRyID0geGVuX2hlbGxvX3dvcmxk
LAorICAgIC5vbGRfYWRkciA9IHhlbl9leHRyYV92ZXJzaW9uLAorICAgIC5uZXdfc2l6ZSA9IE5F
V19DT0RFX1NaLAorICAgIC5vbGRfc2l6ZSA9IE9MRF9DT0RFX1NaLAorfTsKKworLyoKKyAqIExv
Y2FsIHZhcmlhYmxlczoKKyAqIG1vZGU6IEMKKyAqIGMtZmlsZS1zdHlsZTogIkJTRCIKKyAqIGMt
YmFzaWMtb2Zmc2V0OiA0CisgKiB0YWItd2lkdGg6IDQKKyAqIGluZGVudC10YWJzLW1vZGU6IG5p
bAorICogRW5kOgorICovCmRpZmYgLS1naXQgYS94ZW4vdGVzdC9saXZlcGF0Y2gveGVuX2FjdGlv
bl9ob29rc19ub3JldmVydC5jIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9va3Nf
bm9yZXZlcnQuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwLi40NDA4MTY2
ZjQ3Ci0tLSAvZGV2L251bGwKKysrIGIveGVuL3Rlc3QvbGl2ZXBhdGNoL3hlbl9hY3Rpb25faG9v
a3Nfbm9yZXZlcnQuYwpAQCAtMCwwICsxLDE0MyBAQAorLyoKKyAqIENvcHlyaWdodCAoYykgMjAx
OSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgcmlnaHRzIHJlc2VydmVk
LgorICoKKyAqLworCisjaW5jbHVkZSAiY29uZmlnLmgiCisjaW5jbHVkZSA8eGVuL2xpYi5oPgor
I2luY2x1ZGUgPHhlbi90eXBlcy5oPgorI2luY2x1ZGUgPHhlbi92ZXJzaW9uLmg+CisjaW5jbHVk
ZSA8eGVuL2xpdmVwYXRjaC5oPgorI2luY2x1ZGUgPHhlbi9saXZlcGF0Y2hfcGF5bG9hZC5oPgor
CisjaW5jbHVkZSA8cHVibGljL3N5c2N0bC5oPgorCitzdGF0aWMgY29uc3QgY2hhciBoZWxsb193
b3JsZF9wYXRjaF90aGlzX2ZuY1tdID0gInhlbl9leHRyYV92ZXJzaW9uIjsKK2V4dGVybiBjb25z
dCBjaGFyICp4ZW5faGVsbG9fd29ybGQodm9pZCk7CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgcmV2
ZXJ0X2NudDsKKworc3RhdGljIGludCBwcmVfYXBwbHlfaG9vayhsaXZlcGF0Y2hfcGF5bG9hZF90
ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBI
b29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8IHBheWxv
YWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9mdW5jICpm
dW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19PTihmdW5jLT5hcHBsaWVk
ID09IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAgICBwcmludGsoS0VSTl9ERUJVRyAi
JXM6IHByZSBhcHBsaWVkOiAlc1xuIiwgX19mdW5jX18sIGZ1bmMtPm5hbWUpOworICAgIH0KKwor
ICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBkb25lLlxuIiwgX19mdW5jX18pOworCisg
ICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHBvc3RfYXBwbHlfaG9vayhsaXZlcGF0Y2hf
cGF5bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVC
VUcgIiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsg
aSA8IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRj
aF9mdW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIEJVR19PTihmdW5j
LT5hcHBsaWVkICE9IExJVkVQQVRDSF9GVU5DX0FQUExJRUQpOworICAgICAgICBwcmludGsoS0VS
Tl9ERUJVRyAiJXM6IHBvc3QgYXBwbGllZDogJXNcbiIsIF9fZnVuY19fLCBmdW5jLT5uYW1lKTsK
KyAgICB9CisKKyAgICBwcmludGsoS0VSTl9ERUJVRyAiJXM6IEhvb2sgZG9uZS5cbiIsIF9fZnVu
Y19fKTsKK30KKworc3RhdGljIGludCBwcmVfcmV2ZXJ0X2hvb2sobGl2ZXBhdGNoX3BheWxvYWRf
dCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczog
SG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZvciAoaSA9IDA7IGkgPCBwYXls
b2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVjdCBsaXZlcGF0Y2hfZnVuYyAq
ZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBCVUdfT04oZnVuYy0+YXBwbGll
ZCAhPSBMSVZFUEFUQ0hfRlVOQ19BUFBMSUVEKTsKKyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcg
IiVzOiBwcmUgcmV2ZXJ0ZWQ6ICVzXG4iLCBfX2Z1bmNfXywgZnVuYy0+bmFtZSk7CisgICAgfQor
CisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29rIGRvbmUuXG4iLCBfX2Z1bmNfXyk7CisK
KyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIGludCByZXZlcnRfaG9vayhsaXZlcGF0Y2hfcGF5
bG9hZF90ICpwYXlsb2FkKQoreworICAgIGludCBpOworCisgICAgcHJpbnRrKEtFUk5fREVCVUcg
IiVzOiBIb29rIHN0YXJ0aW5nLlxuIiwgX19mdW5jX18pOworCisgICAgZm9yIChpID0gMDsgaSA8
IHBheWxvYWQtPm5mdW5jczsgaSsrKQorICAgIHsKKyAgICAgICAgc3RydWN0IGxpdmVwYXRjaF9m
dW5jICpmdW5jID0gJnBheWxvYWQtPmZ1bmNzW2ldOworCisgICAgICAgIHJldmVydF9jbnQrKzsK
KyAgICAgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiByZXZlcnRpbmc6ICVzXG4iLCBfX2Z1bmNf
XywgZnVuYy0+bmFtZSk7CisgICAgfQorCisgICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBIb29r
IGRvbmUuXG4iLCBfX2Z1bmNfXyk7CisKKyAgICByZXR1cm4gLUVJTlZBTDsgLyogTWFyayBhY3Rp
b24gYXMgaW5jb25zaXN0ZW50ICovCit9CisKK3N0YXRpYyB2b2lkIHBvc3RfcmV2ZXJ0X2hvb2so
bGl2ZXBhdGNoX3BheWxvYWRfdCAqcGF5bG9hZCkKK3sKKyAgICBpbnQgaTsKKworICAgIHByaW50
ayhLRVJOX0RFQlVHICIlczogSG9vayBzdGFydGluZy5cbiIsIF9fZnVuY19fKTsKKworICAgIGZv
ciAoaSA9IDA7IGkgPCBwYXlsb2FkLT5uZnVuY3M7IGkrKykKKyAgICB7CisgICAgICAgIHN0cnVj
dCBsaXZlcGF0Y2hfZnVuYyAqZnVuYyA9ICZwYXlsb2FkLT5mdW5jc1tpXTsKKworICAgICAgICBC
VUdfT04ocmV2ZXJ0X2NudCAhPSAxKTsKKyAgICAgICAgQlVHX09OKGZ1bmMtPmFwcGxpZWQgIT0g
TElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisKKyAgICAgICAgLyogT3V0c2lkZSBvZiBxdWllc2Nl
IHpvbmU6IE1BWSBUUklHR0VSIEhPU1QgQ1JBU0gvVU5ERUZJTkVEIEJFSEFWSU9SICovCisgICAg
ICAgIGFyY2hfbGl2ZXBhdGNoX3F1aWVzY2UoKTsKKyAgICAgICAgYXJjaF9saXZlcGF0Y2hfcmV2
ZXJ0KHBheWxvYWQpOworICAgICAgICBhcmNoX2xpdmVwYXRjaF9yZXZpdmUoKTsKKyAgICAgICAg
QlVHX09OKGZ1bmMtPmFwcGxpZWQgPT0gTElWRVBBVENIX0ZVTkNfQVBQTElFRCk7CisKKyAgICAg
ICAgcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBwb3N0IHJldmVydGVkOiAlc1xuIiwgX19mdW5jX18s
IGZ1bmMtPm5hbWUpOworICAgIH0KKworICAgIHByaW50ayhLRVJOX0RFQlVHICIlczogSG9vayBk
b25lLlxuIiwgX19mdW5jX18pOworfQorCitMSVZFUEFUQ0hfQVBQTFlfSE9PSyhyZXZlcnRfaG9v
ayk7CisKK0xJVkVQQVRDSF9QUkVBUFBMWV9IT09LKHByZV9hcHBseV9ob29rKTsKK0xJVkVQQVRD
SF9QT1NUQVBQTFlfSE9PSyhwb3N0X2FwcGx5X2hvb2spOworTElWRVBBVENIX1BSRVJFVkVSVF9I
T09LKHByZV9yZXZlcnRfaG9vayk7CitMSVZFUEFUQ0hfUE9TVFJFVkVSVF9IT09LKHBvc3RfcmV2
ZXJ0X2hvb2spOworCitzdHJ1Y3QgbGl2ZXBhdGNoX2Z1bmMgX19zZWN0aW9uKCIubGl2ZXBhdGNo
LmZ1bmNzIikgbGl2ZXBhdGNoX3hlbl9oZWxsb193b3JsZCA9IHsKKyAgICAudmVyc2lvbiA9IExJ
VkVQQVRDSF9QQVlMT0FEX1ZFUlNJT04sCisgICAgLm5hbWUgPSBoZWxsb193b3JsZF9wYXRjaF90
aGlzX2ZuYywKKyAgICAubmV3X2FkZHIgPSB4ZW5faGVsbG9fd29ybGQsCisgICAgLm9sZF9hZGRy
ID0geGVuX2V4dHJhX3ZlcnNpb24sCisgICAgLm5ld19zaXplID0gTkVXX0NPREVfU1osCisgICAg
Lm9sZF9zaXplID0gT0xEX0NPREVfU1osCit9OworCisvKgorICogTG9jYWwgdmFyaWFibGVzOgor
ICogbW9kZTogQworICogYy1maWxlLXN0eWxlOiAiQlNEIgorICogYy1iYXNpYy1vZmZzZXQ6IDQK
KyAqIHRhYi13aWR0aDogNAorICogaW5kZW50LXRhYnMtbW9kZTogbmlsCisgKiBFbmQ6CisgKi8K
LS0gCjIuMTYuNQoKCgoKQW1hem9uIERldmVsb3BtZW50IENlbnRlciBHZXJtYW55IEdtYkgKS3Jh
dXNlbnN0ci4gMzgKMTAxMTcgQmVybGluCkdlc2NoYWVmdHNmdWVocnVuZzogQ2hyaXN0aWFuIFNj
aGxhZWdlciwgUmFsZiBIZXJicmljaApFaW5nZXRyYWdlbiBhbSBBbXRzZ2VyaWNodCBDaGFybG90
dGVuYnVyZyB1bnRlciBIUkIgMTQ5MTczIEIKU2l0ejogQmVybGluClVzdC1JRDogREUgMjg5IDIz
NyA4NzkKCgoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
Clhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0
dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

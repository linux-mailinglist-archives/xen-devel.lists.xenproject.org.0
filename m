Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id B2DB46ACF5
	for <lists+xen-devel@lfdr.de>; Tue, 16 Jul 2019 18:42:35 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hnQUn-0003BX-Py; Tue, 16 Jul 2019 16:40:05 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=LiPz=VN=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1hnQUm-0002xq-1g
 for xen-devel@lists.xenproject.org; Tue, 16 Jul 2019 16:40:04 +0000
X-Inumbo-ID: 5a283b1c-a7e8-11e9-a042-cf304ed0ffc3
Received: from m4a0041g.houston.softwaregrp.com (unknown [15.124.2.87])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 5a283b1c-a7e8-11e9-a042-cf304ed0ffc3;
 Tue, 16 Jul 2019 16:40:00 +0000 (UTC)
Received: FROM m4a0041g.houston.softwaregrp.com (15.120.17.146) BY
 m4a0041g.houston.softwaregrp.com WITH ESMTP; 
 Tue, 16 Jul 2019 16:39:59 +0000
Received: from M4W0335.microfocus.com (2002:f78:1193::f78:1193) by
 M4W0334.microfocus.com (2002:f78:1192::f78:1192) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.1591.10; Tue, 16 Jul 2019 16:37:52 +0000
Received: from NAM02-CY1-obe.outbound.protection.outlook.com (15.124.8.12) by
 M4W0335.microfocus.com (15.120.17.147) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.1591.10 via Frontend Transport; Tue, 16 Jul 2019 16:37:52 +0000
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=WrCpBH91lv+oukmhUXTGXMMr/D22A36kJbjkqMyoLgSsDLi4W1NeIuTFYnP88VYFkenmByQy6VCXLmixCyaMKe8HkocgFEBypDeN2KAx3iUZx7lmXAkfyqC14HKEbsm9fvb4SC5YrEkt/+XPwulZFZr4P9rHY5+Qe99gZ6nxp9LFKLVmPwysF1uSOsCDvoji5J1R/6qOtpEzZ1g4IDOj0KbI+HLvkqkTPZP1SbfJsQlHxhvm4tIpmXfIXbVrlVoZ+NGoEXqHr8U8hUVAqxKq9AiKrSH+80IzsTbVDQ/EnStGdRb7JEgM0IiUxOUEQGEyXz/5VFgRLitH8GR3Oc0qxw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=pbmVG+xtC/ndA7O3oJS9moz976STYe8Tu1Ukyrkn5Io=;
 b=m7WLTDx1OqelvvVXvvleOfLYiQcuWgtWoAQzdiJrmk0QJgxA2A5oOaue2qYMbO4XPEuF2qXArPN5HVnJP84jWpdFr8q7afOuZfjJcu8J8cn+mE1wudfErktgTSKRnQjDCHWvOsVMkJqYj7sGAiySAeXlP8rQ7JWzEFnAtLuo2rac6u3sEa1sDlTqD04+m/0u6RTCQYwUNhSRL82ENBu8PY0bHHNH+1rEqi7Aoynx/9apP2egMuPz8J5iiuKnK2CCJhLoYfQnwILMIJmRDy3GbquC3vHHdx3IgvR8Mepxhq6rCjcSWNPj08P8xGHp7EN7ydr6A1/1t+iRegxiaiC65g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=pass
 smtp.mailfrom=suse.com;dmarc=pass action=none header.from=suse.com;dkim=pass
 header.d=suse.com;arc=none
Received: from DM6PR18MB3401.namprd18.prod.outlook.com (10.255.174.218) by
 DM6PR18MB3164.namprd18.prod.outlook.com (10.255.172.93) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2073.14; Tue, 16 Jul 2019 16:37:52 +0000
Received: from DM6PR18MB3401.namprd18.prod.outlook.com
 ([fe80::1fe:35f6:faf3:78c7]) by DM6PR18MB3401.namprd18.prod.outlook.com
 ([fe80::1fe:35f6:faf3:78c7%7]) with mapi id 15.20.2073.012; Tue, 16 Jul 2019
 16:37:52 +0000
From: Jan Beulich <JBeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v3 07/14] AMD/IOMMU: pass IOMMU to
 {get,free,update}_intremap_entry()
Thread-Index: AQHVO/TPRJnsmnG7IEW/OeCiigfJ2A==
Date: Tue, 16 Jul 2019 16:37:51 +0000
Message-ID: <fc2933cf-c456-5a61-c982-995012081d78@suse.com>
References: <6272c301-a905-38cf-dd1a-645f3d703241@suse.com>
In-Reply-To: <6272c301-a905-38cf-dd1a-645f3d703241@suse.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: DB6PR07CA0053.eurprd07.prod.outlook.com
 (2603:10a6:6:2a::15) To DM6PR18MB3401.namprd18.prod.outlook.com
 (2603:10b6:5:1cc::26)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=JBeulich@suse.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [87.234.252.170]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: e3ca135e-fd3b-46bd-eabf-08d70a0bf214
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:DM6PR18MB3164; 
x-ms-traffictypediagnostic: DM6PR18MB3164:
x-microsoft-antispam-prvs: <DM6PR18MB316477055DCF40288118028EB3CE0@DM6PR18MB3164.namprd18.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:3383;
x-forefront-prvs: 0100732B76
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(4636009)(346002)(39860400002)(136003)(376002)(396003)(366004)(199004)(189003)(31696002)(14444005)(256004)(6512007)(36756003)(86362001)(53936002)(8676002)(6436002)(486006)(6486002)(66556008)(66946007)(66476007)(64756008)(5640700003)(66446008)(6506007)(66066001)(2906002)(446003)(6916009)(31686004)(2616005)(476003)(81156014)(386003)(11346002)(81166006)(3846002)(2351001)(71190400001)(80792005)(2501003)(186003)(4326008)(26005)(8936002)(52116002)(305945005)(25786009)(68736007)(54906003)(14454004)(316002)(478600001)(7736002)(102836004)(99286004)(76176011)(71200400001)(5660300002)(6116002)(15650500001)(142933001);
 DIR:OUT; SFP:1102; SCL:1; SRVR:DM6PR18MB3164;
 H:DM6PR18MB3401.namprd18.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: suse.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: PSdByxmysgb0cYtT3J+sDNSuiEd3lJJipMm1ys2CLY5sq8lqniOR6kYItOQzvHSgMaFlSX6+X1iT/vCUaauQXWrAZb8Dskd2TYiFpAcFmVRx4zAwrTr8RkjikHntlMzSdl352SxSk8L/azQcA7ofrgcPrtey/8BVQrGLkM8XirPv13aLeHVolCGNKcwjb2CdJM28S+EzN3U+IqQGvFvPpTyDanylueZuy9vykPGW6qXEiPm60OhotJB0RjHaz2vieSjAS9Af24mmmycQoCTNaMKGnni8tx5JhITgxymCZ0IY7hgy4baUw8/Qx4SzoB9th3RR/ZdInK/1yKmhYCgI+zd2zmd4dHXQoMRSza398IQmte/kk0TtTcWEiU8ZYS77n58HjgGkud8RoL/Eg2H9jBN1fVLMLNAYSDk96z4+i18=
Content-ID: <2CA212B55FC9B648A8B7145F8C4EF13F@namprd18.prod.outlook.com>
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-Network-Message-Id: e3ca135e-fd3b-46bd-eabf-08d70a0bf214
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 Jul 2019 16:37:51.9439 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 856b813c-16e5-49a5-85ec-6f081e13b527
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: JBeulich@suse.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR18MB3164
X-OriginatorOrg: suse.com
Subject: [Xen-devel] [PATCH v3 07/14] AMD/IOMMU: pass IOMMU to {get, free,
 update}_intremap_entry()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 Brian Woods <brian.woods@amd.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIGZ1bmN0aW9ucyB3aWxsIHdhbnQgdG8ga25vdyBJT01NVSBwcm9wZXJ0aWVzIChzcGVjaWZp
Y2FsbHkgdGhlIElSVEUNCnNpemUpIHN1YnNlcXVlbnRseS4NCg0KUmF0aGVyIHRoYW4gaW50cm9k
dWNpbmcgYSBzZWNvbmQgZXJyb3IgcGF0aCBib2d1c2x5IHJldHVybmluZyAtRS4uLiBmcm9tDQph
bWRfaW9tbXVfcmVhZF9pb2FwaWNfZnJvbV9pcmUoKSwgYWxzbyBjaGFuZ2UgdGhlIGV4aXN0aW5n
IG9uZSB0byBmb2xsb3cNClZULWQgaW4gcmV0dXJuaW5nIHRoZSByYXcgKHVudHJhbnNsYXRlZCkg
SU8tQVBJQyBSVEUuDQoNClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNl
LmNvbT4NCi0tLQ0KdjM6IE5ldy4NCg0KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2ludHIuYw0KKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2lu
dHIuYw0KQEAgLTEyMywxMSArMTIzLDExIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgYWxsb2NfaW50
cmVtYXBfZW50cnkNCiAgICAgIHJldHVybiBzbG90Ow0KICB9DQogIA0KLXN0YXRpYyB1bmlvbiBp
cnRlX3B0ciBnZXRfaW50cmVtYXBfZW50cnkodW5zaWduZWQgaW50IHNlZywgdW5zaWduZWQgaW50
IGJkZiwNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVk
IGludCBpbmRleCkNCitzdGF0aWMgdW5pb24gaXJ0ZV9wdHIgZ2V0X2ludHJlbWFwX2VudHJ5KGNv
bnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGJkZiwgdW5zaWduZWQgaW50IGluZGV4KQ0KICB7
DQogICAgICB1bmlvbiBpcnRlX3B0ciB0YWJsZSA9IHsNCi0gICAgICAgIC5wdHIgPSBnZXRfaXZy
c19tYXBwaW5ncyhzZWcpW2JkZl0uaW50cmVtYXBfdGFibGUNCisgICAgICAgIC5wdHIgPSBnZXRf
aXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVtiZGZdLmludHJlbWFwX3RhYmxlDQogICAgICB9Ow0K
ICANCiAgICAgIEFTU0VSVCh0YWJsZS5wdHIgJiYgKGluZGV4IDwgSU5UUkVNQVBfRU5UUklFUykp
Ow0KQEAgLTEzNywxOCArMTM3LDE5IEBAIHN0YXRpYyB1bmlvbiBpcnRlX3B0ciBnZXRfaW50cmVt
YXBfZW50cnkNCiAgICAgIHJldHVybiB0YWJsZTsNCiAgfQ0KICANCi1zdGF0aWMgdm9pZCBmcmVl
X2ludHJlbWFwX2VudHJ5KHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVkIGludCBiZGYsDQotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpDQorc3RhdGlj
IHZvaWQgZnJlZV9pbnRyZW1hcF9lbnRyeShjb25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwN
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBiZGYsIHVuc2ln
bmVkIGludCBpbmRleCkNCiAgew0KLSAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeSA9IGdldF9pbnRy
ZW1hcF9lbnRyeShzZWcsIGJkZiwgaW5kZXgpOw0KKyAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeSA9
IGdldF9pbnRyZW1hcF9lbnRyeShpb21tdSwgYmRmLCBpbmRleCk7DQogIA0KICAgICAgQUNDRVNT
X09OQ0UoZW50cnkucHRyMzItPnJhd1swXSkgPSAwOw0KICANCi0gICAgX19jbGVhcl9iaXQoaW5k
ZXgsIGdldF9pdnJzX21hcHBpbmdzKHNlZylbYmRmXS5pbnRyZW1hcF9pbnVzZSk7DQorICAgIF9f
Y2xlYXJfYml0KGluZGV4LCBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVtiZGZdLmludHJl
bWFwX2ludXNlKTsNCiAgfQ0KICANCi1zdGF0aWMgdm9pZCB1cGRhdGVfaW50cmVtYXBfZW50cnko
dW5pb24gaXJ0ZV9wdHIgZW50cnksIHVuc2lnbmVkIGludCB2ZWN0b3IsDQotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpbnRfdHlwZSwNCitzdGF0aWMgdm9p
ZCB1cGRhdGVfaW50cmVtYXBfZW50cnkoY29uc3Qgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsDQor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaW9uIGlydGVfcHRyIGVudHJ5LA0K
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgdmVjdG9yLCB1
bnNpZ25lZCBpbnQgaW50X3R5cGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1bnNpZ25lZCBpbnQgZGVzdF9tb2RlLCB1bnNpZ25lZCBpbnQgZGVzdCkNCiAgew0KICAgICAg
c3RydWN0IGlydGVfYmFzaWMgYmFzaWMgPSB7DQpAQCAtMjEyLDcgKzIxMyw3IEBAIHN0YXRpYyBp
bnQgdXBkYXRlX2ludHJlbWFwX2VudHJ5X2Zyb21faW8NCiAgICAgICAgICBsb191cGRhdGUgPSAx
Ow0KICAgICAgfQ0KICANCi0gICAgZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoaW9tbXUtPnNl
ZywgcmVxX2lkLCBvZmZzZXQpOw0KKyAgICBlbnRyeSA9IGdldF9pbnRyZW1hcF9lbnRyeShpb21t
dSwgcmVxX2lkLCBvZmZzZXQpOw0KICAgICAgaWYgKCAhbG9fdXBkYXRlICkNCiAgICAgIHsNCiAg
ICAgICAgICAvKg0KQEAgLTIyMyw3ICsyMjQsNyBAQCBzdGF0aWMgaW50IHVwZGF0ZV9pbnRyZW1h
cF9lbnRyeV9mcm9tX2lvDQogICAgICAgICAgdmVjdG9yID0gZW50cnkucHRyMzItPmJhc2ljLnZl
Y3RvcjsNCiAgICAgICAgICBkZWxpdmVyeV9tb2RlID0gZW50cnkucHRyMzItPmJhc2ljLmludF90
eXBlOw0KICAgICAgfQ0KLSAgICB1cGRhdGVfaW50cmVtYXBfZW50cnkoZW50cnksIHZlY3Rvciwg
ZGVsaXZlcnlfbW9kZSwgZGVzdF9tb2RlLCBkZXN0KTsNCisgICAgdXBkYXRlX2ludHJlbWFwX2Vu
dHJ5KGlvbW11LCBlbnRyeSwgdmVjdG9yLCBkZWxpdmVyeV9tb2RlLCBkZXN0X21vZGUsIGRlc3Qp
Ow0KICANCiAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOw0KICANCkBA
IC0yODgsOCArMjg5LDggQEAgaW50IF9faW5pdCBhbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFw
cA0KICAgICAgICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZShsb2NrLCBmbGFncyk7DQogICAgICAg
ICAgICAgIG9mZnNldCA9IGFsbG9jX2ludHJlbWFwX2VudHJ5KHNlZywgcmVxX2lkLCAxKTsNCiAg
ICAgICAgICAgICAgQlVHX09OKG9mZnNldCA+PSBJTlRSRU1BUF9FTlRSSUVTKTsNCi0gICAgICAg
ICAgICBlbnRyeSA9IGdldF9pbnRyZW1hcF9lbnRyeShpb21tdS0+c2VnLCByZXFfaWQsIG9mZnNl
dCk7DQotICAgICAgICAgICAgdXBkYXRlX2ludHJlbWFwX2VudHJ5KGVudHJ5LCB2ZWN0b3IsDQor
ICAgICAgICAgICAgZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoaW9tbXUsIHJlcV9pZCwgb2Zm
c2V0KTsNCisgICAgICAgICAgICB1cGRhdGVfaW50cmVtYXBfZW50cnkoaW9tbXUsIGVudHJ5LCB2
ZWN0b3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxpdmVyeV9tb2Rl
LCBkZXN0X21vZGUsIGRlc3QpOw0KICAgICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3Jl
KGxvY2ssIGZsYWdzKTsNCiAgDQpAQCAtNDEzLDcgKzQxNCw3IEBAIHVuc2lnbmVkIGludCBhbWRf
aW9tbXVfcmVhZF9pb2FwaWNfZnJvbV8NCiAgDQogICAgICBpZHggPSBpb2FwaWNfaWRfdG9faW5k
ZXgoSU9fQVBJQ19JRChhcGljKSk7DQogICAgICBpZiAoIGlkeCA9PSBNQVhfSU9fQVBJQ1MgKQ0K
LSAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQorICAgICAgICByZXR1cm4gdmFsOw0KICANCiAgICAg
IG9mZnNldCA9IGlvYXBpY19zYmRmW2lkeF0ucGluXzJfaWR4W3Bpbl07DQogIA0KQEAgLTQyMiw5
ICs0MjMsMTMgQEAgdW5zaWduZWQgaW50IGFtZF9pb21tdV9yZWFkX2lvYXBpY19mcm9tXw0KICAg
ICAgICAgIHUxNiBiZGYgPSBpb2FwaWNfc2JkZltpZHhdLmJkZjsNCiAgICAgICAgICB1MTYgc2Vn
ID0gaW9hcGljX3NiZGZbaWR4XS5zZWc7DQogICAgICAgICAgdTE2IHJlcV9pZCA9IGdldF9pbnRy
ZW1hcF9yZXF1ZXN0b3JfaWQoc2VnLCBiZGYpOw0KLSAgICAgICAgdW5pb24gaXJ0ZV9wdHIgZW50
cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoc2VnLCByZXFfaWQsIG9mZnNldCk7DQorICAgICAgICBj
b25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSA9IGZpbmRfaW9tbXVfZm9yX2RldmljZShzZWcs
IGJkZik7DQorICAgICAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeTsNCiAgDQorICAgICAgICBpZiAo
ICFpb21tdSApDQorICAgICAgICAgICAgcmV0dXJuIHZhbDsNCiAgICAgICAgICBBU1NFUlQob2Zm
c2V0ID09ICh2YWwgJiAoSU5UUkVNQVBfRU5UUklFUyAtIDEpKSk7DQorICAgICAgICBlbnRyeSA9
IGdldF9pbnRyZW1hcF9lbnRyeShpb21tdSwgcmVxX2lkLCBvZmZzZXQpOw0KICAgICAgICAgIHZh
bCAmPSB+KElOVFJFTUFQX0VOVFJJRVMgLSAxKTsNCiAgICAgICAgICB2YWwgfD0gTUFTS19JTlNS
KGVudHJ5LnB0cjMyLT5iYXNpYy5pbnRfdHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAg
IElPX0FQSUNfUkVESVJfREVMSVZfTU9ERV9NQVNLKTsNCkBAIC00NTQsNyArNDU5LDcgQEAgc3Rh
dGljIGludCB1cGRhdGVfaW50cmVtYXBfZW50cnlfZnJvbV9tcw0KICAgICAgICAgIGxvY2sgPSBn
ZXRfaW50cmVtYXBfbG9jayhpb21tdS0+c2VnLCByZXFfaWQpOw0KICAgICAgICAgIHNwaW5fbG9j
a19pcnFzYXZlKGxvY2ssIGZsYWdzKTsNCiAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IG5yOyAr
K2kgKQ0KLSAgICAgICAgICAgIGZyZWVfaW50cmVtYXBfZW50cnkoaW9tbXUtPnNlZywgcmVxX2lk
LCAqcmVtYXBfaW5kZXggKyBpKTsNCisgICAgICAgICAgICBmcmVlX2ludHJlbWFwX2VudHJ5KGlv
bW11LCByZXFfaWQsICpyZW1hcF9pbmRleCArIGkpOw0KICAgICAgICAgIHNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUobG9jaywgZmxhZ3MpOw0KICAgICAgICAgIGdvdG8gZG9uZTsNCiAgICAgIH0NCkBA
IC00NzksOCArNDg0LDggQEAgc3RhdGljIGludCB1cGRhdGVfaW50cmVtYXBfZW50cnlfZnJvbV9t
cw0KICAgICAgICAgICpyZW1hcF9pbmRleCA9IG9mZnNldDsNCiAgICAgIH0NCiAgDQotICAgIGVu
dHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5KGlvbW11LT5zZWcsIHJlcV9pZCwgb2Zmc2V0KTsNCi0g
ICAgdXBkYXRlX2ludHJlbWFwX2VudHJ5KGVudHJ5LCB2ZWN0b3IsIGRlbGl2ZXJ5X21vZGUsIGRl
c3RfbW9kZSwgZGVzdCk7DQorICAgIGVudHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5KGlvbW11LCBy
ZXFfaWQsIG9mZnNldCk7DQorICAgIHVwZGF0ZV9pbnRyZW1hcF9lbnRyeShpb21tdSwgZW50cnks
IHZlY3RvciwgZGVsaXZlcnlfbW9kZSwgZGVzdF9tb2RlLCBkZXN0KTsNCiAgICAgIHNwaW5fdW5s
b2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOw0KICANCiAgICAgICpkYXRhID0gKG1zZy0+ZGF0
YSAmIH4oSU5UUkVNQVBfRU5UUklFUyAtIDEpKSB8IG9mZnNldDsNCkBAIC01OTQsMTIgKzU5OSwx
MyBAQCB2b2lkIGFtZF9pb21tdV9yZWFkX21zaV9mcm9tX2lyZSgNCiAgICAgIGNvbnN0IHN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gbXNpX2Rlc2MtPmRldjsNCiAgICAgIHUxNiBiZGYgPSBwZGV2ID8g
UENJX0JERjIocGRldi0+YnVzLCBwZGV2LT5kZXZmbikgOiBocGV0X3NiZGYuYmRmOw0KICAgICAg
dTE2IHNlZyA9IHBkZXYgPyBwZGV2LT5zZWcgOiBocGV0X3NiZGYuc2VnOw0KKyAgICBjb25zdCBz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSA9IF9maW5kX2lvbW11X2Zvcl9kZXZpY2Uoc2VnLCBiZGYp
Ow0KICAgICAgdW5pb24gaXJ0ZV9wdHIgZW50cnk7DQogIA0KLSAgICBpZiAoIElTX0VSUl9PUl9O
VUxMKF9maW5kX2lvbW11X2Zvcl9kZXZpY2Uoc2VnLCBiZGYpKSApDQorICAgIGlmICggSVNfRVJS
X09SX05VTEwoaW9tbXUpICkNCiAgICAgICAgICByZXR1cm47DQogIA0KLSAgICBlbnRyeSA9IGdl
dF9pbnRyZW1hcF9lbnRyeShzZWcsIGdldF9kbWFfcmVxdWVzdG9yX2lkKHNlZywgYmRmKSwgb2Zm
c2V0KTsNCisgICAgZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoaW9tbXUsIGdldF9kbWFfcmVx
dWVzdG9yX2lkKHNlZywgYmRmKSwgb2Zmc2V0KTsNCiAgDQogICAgICBpZiAoIG1zaV9kZXNjLT5t
c2lfYXR0cmliLnR5cGUgPT0gUENJX0NBUF9JRF9NU0kgKQ0KICAgICAgew0KDQpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBs
aXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2pl
Y3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

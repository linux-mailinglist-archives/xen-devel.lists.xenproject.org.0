Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 9E86017A593
	for <lists+xen-devel@lfdr.de>; Thu,  5 Mar 2020 13:47:47 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1j9psr-00007y-JP; Thu, 05 Mar 2020 12:45:49 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=5BTO=4W=amzn.com=prvs=326a7180f=pdurrant@srs-us1.protection.inumbo.net>)
 id 1j9psq-00007n-HS
 for xen-devel@lists.xenproject.org; Thu, 05 Mar 2020 12:45:48 +0000
X-Inumbo-ID: 3c91ecb6-5edf-11ea-b52f-bc764e2007e4
Received: from smtp-fw-9101.amazon.com (unknown [207.171.184.25])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 3c91ecb6-5edf-11ea-b52f-bc764e2007e4;
 Thu, 05 Mar 2020 12:45:48 +0000 (UTC)
IronPort-SDR: fJSXx1pNHHRx+3aLfDl41WnVs5e2C85IGx/uLxgDnVPFmNmoxjpLWnkNzmn6tYoDb/NOlwAX2l
 RHAvwdPh8b/A==
X-IronPort-AV: E=Sophos;i="5.70,518,1574121600"; d="scan'208";a="21060556"
Received: from sea32-co-svc-lb4-vlan3.sea.corp.amazon.com (HELO
 email-inbound-relay-1a-821c648d.us-east-1.amazon.com) ([10.47.23.38])
 by smtp-border-fw-out-9101.sea19.amazon.com with ESMTP;
 05 Mar 2020 12:45:47 +0000
Received: from EX13MTAUEA002.ant.amazon.com
 (iad55-ws-svc-p15-lb9-vlan3.iad.amazon.com [10.40.159.166])
 by email-inbound-relay-1a-821c648d.us-east-1.amazon.com (Postfix) with ESMTPS
 id 772B2A28D4; Thu,  5 Mar 2020 12:45:42 +0000 (UTC)
Received: from EX13D32EUC004.ant.amazon.com (10.43.164.121) by
 EX13MTAUEA002.ant.amazon.com (10.43.61.77) with Microsoft SMTP Server (TLS)
 id 15.0.1236.3; Thu, 5 Mar 2020 12:45:15 +0000
Received: from EX13MTAUWC001.ant.amazon.com (10.43.162.135) by
 EX13D32EUC004.ant.amazon.com (10.43.164.121) with Microsoft SMTP Server (TLS)
 id 15.0.1367.3; Thu, 5 Mar 2020 12:45:14 +0000
Received: from u2f063a87eabd5f.cbg10.amazon.com (10.125.106.135) by
 mail-relay.amazon.com (10.43.162.232) with Microsoft SMTP Server id
 15.0.1367.3 via Frontend Transport; Thu, 5 Mar 2020 12:45:11 +0000
From: <pdurrant@amzn.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 5 Mar 2020 12:44:59 +0000
Message-ID: <20200305124504.3564-2-pdurrant@amzn.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200305124504.3564-1-pdurrant@amzn.com>
References: <20200305124504.3564-1-pdurrant@amzn.com>
MIME-Version: 1.0
Precedence: Bulk
Subject: [Xen-devel] [PATCH v3 1/6] domain: introduce
 alloc/free_shared_info() helpers...
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>, Paul Durrant <pdurrant@amazon.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 George Dunlap <george.dunlap@citrix.com>, Jan Beulich <jbeulich@suse.com>,
 Volodymyr Babchuk <Volodymyr_Babchuk@epam.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogUGF1bCBEdXJyYW50IDxwZHVycmFudEBhbWF6b24uY29tPgoKLi4uIGFuZCBzYXZlIHRo
ZSBNRk4uCgpUaGlzIHBhdGNoIG1vZGlmaWVzIHRoZSAnc2hhcmVkX2luZm8nIGZpZWxkIG9mIHN0
cnVjdCBkb21haW4gdG8gYmUKYSBzdHJ1Y3R1cmUgY29tcHJpc2luZyBhbiBNRk4gYW5kIGEgdmly
dHVhbCBhZGRyZXNzLiBBbGxvY2F0aW9ucyBhcmUKc3RpbGwgZG9uZSBmcm9tIHhlbmhlYXAsIHNv
IHRoZSB2aXJ0dWFsIGFkZHJlc3Mgc3RpbGwgZXF1YXRlcyB0bwp2aXJ0X3RvX21mbigpIGNhbGxl
ZCBvbiB0aGUgTUZOIGJ1dCBzdWJzZXF1ZW50IHBhdGNoIHdpbGwgY2hhbmdlIHRoaXMuCkhlbmNl
IHRoZSBuZWVkIHRvIHNhdmUgdGhlIE1GTi4KCk5PVEU6IFdoaXN0IGRlZmluaW5nIHRoZSBuZXcg
aGVscGVycywgdmlydF90b19tZm4oKSBpbiBjb21tb24vZG9tYWluLmMKICAgICAgaXMgbWFkZSB0
eXBlIHNhZmUuCiAgICAgIFRoZSBkZWZpbml0aW9uIG9mIG5taV9yZWFzb24oKSBpbiBhc20teDg2
L3NoYXJlZC5oIGlzIGFsc28gcmUtCiAgICAgIGZsb3dlZCB0byBhdm9pZCBvdmVybHkgbG9uZyBs
aW5lcy4KClNpZ25lZC1vZmYtYnk6IFBhdWwgRHVycmFudCA8cGR1cnJhbnRAYW1hem9uLmNvbT4K
UmV2aWV3ZWQtYnk6IEp1bGllbiBHcmFsbCA8anVsaWVuQHhlbi5vcmc+Ci0tLQpDYzogU3RlZmFu
byBTdGFiZWxsaW5pIDxzc3RhYmVsbGluaUBrZXJuZWwub3JnPgpDYzogVm9sb2R5bXlyIEJhYmNo
dWsgPFZvbG9keW15cl9CYWJjaHVrQGVwYW0uY29tPgpDYzogQW5kcmV3IENvb3BlciA8YW5kcmV3
LmNvb3BlcjNAY2l0cml4LmNvbT4KQ2M6IEdlb3JnZSBEdW5sYXAgPGdlb3JnZS5kdW5sYXBAY2l0
cml4LmNvbT4KQ2M6IElhbiBKYWNrc29uIDxpYW4uamFja3NvbkBldS5jaXRyaXguY29tPgpDYzog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpDYzogS29ucmFkIFJ6ZXN6dXRlayBXaWxr
IDxrb25yYWQud2lsa0BvcmFjbGUuY29tPgpDYzogV2VpIExpdSA8d2xAeGVuLm9yZz4KQ2M6ICJS
b2dlciBQYXUgTW9ubsOpIiA8cm9nZXIucGF1QGNpdHJpeC5jb20+Ci0tLQogeGVuL2FyY2gvYXJt
L2RvbWFpbi5jICAgICAgICB8ICA4ICsrLS0tLS0tCiB4ZW4vYXJjaC9hcm0vbW0uYyAgICAgICAg
ICAgIHwgIDIgKy0KIHhlbi9hcmNoL3g4Ni9kb21haW4uYyAgICAgICAgfCAxMSArKysrLS0tLS0t
LQogeGVuL2FyY2gveDg2L21tLmMgICAgICAgICAgICB8ICAyICstCiB4ZW4vYXJjaC94ODYvcHYv
ZG9tMF9idWlsZC5jIHwgIDIgKy0KIHhlbi9hcmNoL3g4Ni9wdi9zaGltLmMgICAgICAgfCAgMiAr
LQogeGVuL2NvbW1vbi9kb21haW4uYyAgICAgICAgICB8IDI2ICsrKysrKysrKysrKysrKysrKysr
KysrKysrCiB4ZW4vY29tbW9uL2RvbWN0bC5jICAgICAgICAgIHwgIDIgKy0KIHhlbi9jb21tb24v
dGltZS5jICAgICAgICAgICAgfCAgNCArKy0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L3NoYXJlZC5o
IHwgMTUgKysrKysrKystLS0tLS0tCiB4ZW4vaW5jbHVkZS94ZW4vZG9tYWluLmggICAgIHwgIDMg
KysrCiB4ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCAgICAgIHwgIDUgKysrKy0KIHhlbi9pbmNsdWRl
L3hlbi9zaGFyZWQuaCAgICAgfCAgMiArLQogMTMgZmlsZXMgY2hhbmdlZCwgNTUgaW5zZXJ0aW9u
cygrKSwgMjkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL2RvbWFpbi5j
IGIveGVuL2FyY2gvYXJtL2RvbWFpbi5jCmluZGV4IDY2MjdiZTI5MjIuLjUyOThkODBiZDIgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL2FybS9kb21haW4uYworKysgYi94ZW4vYXJjaC9hcm0vZG9tYWlu
LmMKQEAgLTY4OSwxMyArNjg5LDkgQEAgaW50IGFyY2hfZG9tYWluX2NyZWF0ZShzdHJ1Y3QgZG9t
YWluICpkLAogICAgIGlmICggKHJjID0gcDJtX2luaXQoZCkpICE9IDAgKQogICAgICAgICBnb3Rv
IGZhaWw7CiAKLSAgICByYyA9IC1FTk9NRU07Ci0gICAgaWYgKCAoZC0+c2hhcmVkX2luZm8gPSBh
bGxvY194ZW5oZWFwX3BhZ2VzKDAsIDApKSA9PSBOVUxMICkKKyAgICBpZiAoIChyYyA9IGFsbG9j
X3NoYXJlZF9pbmZvKGQsIDApKSAhPSAwICkKICAgICAgICAgZ290byBmYWlsOwogCi0gICAgY2xl
YXJfcGFnZShkLT5zaGFyZWRfaW5mbyk7Ci0gICAgc2hhcmVfeGVuX3BhZ2Vfd2l0aF9ndWVzdCh2
aXJ0X3RvX3BhZ2UoZC0+c2hhcmVkX2luZm8pLCBkLCBTSEFSRV9ydyk7Ci0KICAgICBzd2l0Y2gg
KCBjb25maWctPmFyY2guZ2ljX3ZlcnNpb24gKQogICAgIHsKICAgICBjYXNlIFhFTl9ET01DVExf
Q09ORklHX0dJQ19WMjoKQEAgLTc2Niw3ICs3NjIsNyBAQCB2b2lkIGFyY2hfZG9tYWluX2Rlc3Ry
b3koc3RydWN0IGRvbWFpbiAqZCkKICAgICBwMm1fdGVhcmRvd24oZCk7CiAgICAgZG9tYWluX3Zn
aWNfZnJlZShkKTsKICAgICBkb21haW5fdnVhcnRfZnJlZShkKTsKLSAgICBmcmVlX3hlbmhlYXBf
cGFnZShkLT5zaGFyZWRfaW5mbyk7CisgICAgZnJlZV9zaGFyZWRfaW5mbyhkKTsKICNpZmRlZiBD
T05GSUdfQUNQSQogICAgIGZyZWVfeGVuaGVhcF9wYWdlcyhkLT5hcmNoLmVmaV9hY3BpX3RhYmxl
LAogICAgICAgICAgICAgICAgICAgICAgICBnZXRfb3JkZXJfZnJvbV9ieXRlcyhkLT5hcmNoLmVm
aV9hY3BpX2xlbikpOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gvYXJtL21tLmMgYi94ZW4vYXJjaC9h
cm0vbW0uYwppbmRleCA3MjcxMDdlZWZhLi4yYmI1OTIxMDFkIDEwMDY0NAotLS0gYS94ZW4vYXJj
aC9hcm0vbW0uYworKysgYi94ZW4vYXJjaC9hcm0vbW0uYwpAQCAtMTQyNCw3ICsxNDI0LDcgQEAg
aW50IHhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUoCiAgICAgICAgIGlmICggaWR4ICE9IDAgKQog
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKLSAgICAgICAgbWZuID0gdmlydF90b19tZm4o
ZC0+c2hhcmVkX2luZm8pOworICAgICAgICBtZm4gPSBkLT5zaGFyZWRfaW5mby5tZm47CiAgICAg
ICAgIHQgPSBwMm1fcmFtX3J3OwogCiAgICAgICAgIGJyZWFrOwpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L2RvbWFpbi5jIGIveGVuL2FyY2gveDg2L2RvbWFpbi5jCmluZGV4IGNhZjJlY2FkN2Uu
LmJkY2MwZDk3MmEgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9kb21haW4uYworKysgYi94ZW4v
YXJjaC94ODYvZG9tYWluLmMKQEAgLTYxMSwxMiArNjExLDkgQEAgaW50IGFyY2hfZG9tYWluX2Ny
ZWF0ZShzdHJ1Y3QgZG9tYWluICpkLAogICAgICAqIFRoZSBzaGFyZWRfaW5mbyBtYWNoaW5lIGFk
ZHJlc3MgbXVzdCBmaXQgaW4gYSAzMi1iaXQgZmllbGQgd2l0aGluIGEKICAgICAgKiAzMi1iaXQg
Z3Vlc3QncyBzdGFydF9pbmZvIHN0cnVjdHVyZS4gSGVuY2Ugd2Ugc3BlY2lmeSBNRU1GX2JpdHMo
MzIpLgogICAgICAqLwotICAgIGlmICggKGQtPnNoYXJlZF9pbmZvID0gYWxsb2NfeGVuaGVhcF9w
YWdlcygwLCBNRU1GX2JpdHMoMzIpKSkgPT0gTlVMTCApCisgICAgaWYgKCAocmMgPSBhbGxvY19z
aGFyZWRfaW5mbyhkLCBNRU1GX2JpdHMoMzIpKSkgIT0gMCApCiAgICAgICAgIGdvdG8gZmFpbDsK
IAotICAgIGNsZWFyX3BhZ2UoZC0+c2hhcmVkX2luZm8pOwotICAgIHNoYXJlX3hlbl9wYWdlX3dp
dGhfZ3Vlc3QodmlydF90b19wYWdlKGQtPnNoYXJlZF9pbmZvKSwgZCwgU0hBUkVfcncpOwotCiAg
ICAgaWYgKCAocmMgPSBpbml0X2RvbWFpbl9pcnFfbWFwcGluZyhkKSkgIT0gMCApCiAgICAgICAg
IGdvdG8gZmFpbDsKIApAQCAtNjY0LDcgKzY2MSw3IEBAIGludCBhcmNoX2RvbWFpbl9jcmVhdGUo
c3RydWN0IGRvbWFpbiAqZCwKICAgICBwc3JfZG9tYWluX2ZyZWUoZCk7CiAgICAgaW9tbXVfZG9t
YWluX2Rlc3Ryb3koZCk7CiAgICAgY2xlYW51cF9kb21haW5faXJxX21hcHBpbmcoZCk7Ci0gICAg
ZnJlZV94ZW5oZWFwX3BhZ2UoZC0+c2hhcmVkX2luZm8pOworICAgIGZyZWVfc2hhcmVkX2luZm8o
ZCk7CiAgICAgeGZyZWUoZC0+YXJjaC5jcHVpZCk7CiAgICAgeGZyZWUoZC0+YXJjaC5tc3IpOwog
ICAgIGlmICggcGFnaW5nX2luaXRpYWxpc2VkICkKQEAgLTY5Myw3ICs2OTAsNyBAQCB2b2lkIGFy
Y2hfZG9tYWluX2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCkKICAgICAgICAgcHZfZG9tYWluX2Rl
c3Ryb3koZCk7CiAgICAgZnJlZV9wZXJkb21haW5fbWFwcGluZ3MoZCk7CiAKLSAgICBmcmVlX3hl
bmhlYXBfcGFnZShkLT5zaGFyZWRfaW5mbyk7CisgICAgZnJlZV9zaGFyZWRfaW5mbyhkKTsKICAg
ICBjbGVhbnVwX2RvbWFpbl9pcnFfbWFwcGluZyhkKTsKIAogICAgIHBzcl9kb21haW5fZnJlZShk
KTsKQEAgLTcxOSw3ICs3MTYsNyBAQCB2b2lkIGFyY2hfZG9tYWluX3VucGF1c2Uoc3RydWN0IGRv
bWFpbiAqZCkKIAogaW50IGFyY2hfZG9tYWluX3NvZnRfcmVzZXQoc3RydWN0IGRvbWFpbiAqZCkK
IHsKLSAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlID0gdmlydF90b19wYWdlKGQtPnNoYXJlZF9p
bmZvKSwgKm5ld19wYWdlOworICAgIHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UgPSBtZm5fdG9fcGFn
ZShkLT5zaGFyZWRfaW5mby5tZm4pLCAqbmV3X3BhZ2U7CiAgICAgaW50IHJldCA9IDA7CiAgICAg
c3RydWN0IGRvbWFpbiAqb3duZXI7CiAgICAgbWZuX3QgbWZuOwpkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21tLmMgYi94ZW4vYXJjaC94ODYvbW0uYwppbmRleCA2MjUwN2NhNjUxLi5iYTc1NjNl
ZDNjIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94ODYvbW0u
YwpAQCAtNDU0MCw3ICs0NTQwLDcgQEAgaW50IHhlbm1lbV9hZGRfdG9fcGh5c21hcF9vbmUoCiAg
ICAgewogICAgICAgICBjYXNlIFhFTk1BUFNQQUNFX3NoYXJlZF9pbmZvOgogICAgICAgICAgICAg
aWYgKCBpZHggPT0gMCApCi0gICAgICAgICAgICAgICAgbWZuID0gdmlydF90b19tZm4oZC0+c2hh
cmVkX2luZm8pOworICAgICAgICAgICAgICAgIG1mbiA9IGQtPnNoYXJlZF9pbmZvLm1mbjsKICAg
ICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIFhFTk1BUFNQQUNFX2dyYW50X3RhYmxlOgog
ICAgICAgICAgICAgcmMgPSBnbnR0YWJfbWFwX2ZyYW1lKGQsIGlkeCwgZ3BmbiwgJm1mbik7CmRp
ZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvcHYvZG9tMF9idWlsZC5jIGIveGVuL2FyY2gveDg2L3B2
L2RvbTBfYnVpbGQuYwppbmRleCA1Njc4ZGE3ODJkLi5kYzE2ZWYyZTc5IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvcHYvZG9tMF9idWlsZC5jCisrKyBiL3hlbi9hcmNoL3g4Ni9wdi9kb20wX2J1
aWxkLmMKQEAgLTc0Myw3ICs3NDMsNyBAQCBpbnQgX19pbml0IGRvbTBfY29uc3RydWN0X3B2KHN0
cnVjdCBkb21haW4gKmQsCiAgICAgY2xlYXJfcGFnZShzaSk7CiAgICAgc2ktPm5yX3BhZ2VzID0g
bnJfcGFnZXM7CiAKLSAgICBzaS0+c2hhcmVkX2luZm8gPSB2aXJ0X3RvX21hZGRyKGQtPnNoYXJl
ZF9pbmZvKTsKKyAgICBzaS0+c2hhcmVkX2luZm8gPSBtZm5fdG9fbWFkZHIoZC0+c2hhcmVkX2lu
Zm8ubWZuKTsKIAogICAgIGlmICggIXB2X3NoaW0gKQogICAgICAgICBzaS0+ZmxhZ3MgICAgPSBT
SUZfUFJJVklMRUdFRCB8IFNJRl9JTklURE9NQUlOOwpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2
L3B2L3NoaW0uYyBiL3hlbi9hcmNoL3g4Ni9wdi9zaGltLmMKaW5kZXggZDg2ZTJkZTExOC4uZjUx
MjgwOWRhZCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L3B2L3NoaW0uYworKysgYi94ZW4vYXJj
aC94ODYvcHYvc2hpbS5jCkBAIC0yODIsNyArMjgyLDcgQEAgc3RhdGljIHZvaWQgd3JpdGVfc3Rh
cnRfaW5mbyhzdHJ1Y3QgZG9tYWluICpkKQogICAgIHNucHJpbnRmKHNpLT5tYWdpYywgc2l6ZW9m
KHNpLT5tYWdpYyksICJ4ZW4tMy4wLXg4Nl8lcyIsCiAgICAgICAgICAgICAgaXNfcHZfMzJiaXRf
ZG9tYWluKGQpID8gIjMycCIgOiAiNjQiKTsKICAgICBzaS0+bnJfcGFnZXMgPSBkb21haW5fdG90
X3BhZ2VzKGQpOwotICAgIHNpLT5zaGFyZWRfaW5mbyA9IHZpcnRfdG9fbWFkZHIoZC0+c2hhcmVk
X2luZm8pOworICAgIHNpLT5zaGFyZWRfaW5mbyA9IG1mbl90b19tYWRkcihkLT5zaGFyZWRfaW5m
by5tZm4pOwogICAgIHNpLT5mbGFncyA9IDA7CiAgICAgQlVHX09OKHhlbl9oeXBlcmNhbGxfaHZt
X2dldF9wYXJhbShIVk1fUEFSQU1fU1RPUkVfUEZOLCAmc2ktPnN0b3JlX21mbikpOwogICAgIEJV
R19PTih4ZW5faHlwZXJjYWxsX2h2bV9nZXRfcGFyYW0oSFZNX1BBUkFNX1NUT1JFX0VWVENITiwg
JnBhcmFtKSk7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2RvbWFpbi5jIGIveGVuL2NvbW1vbi9k
b21haW4uYwppbmRleCA2YWQ0NThmYTZiLi5iYTdhOTA1MjU4IDEwMDY0NAotLS0gYS94ZW4vY29t
bW9uL2RvbWFpbi5jCisrKyBiL3hlbi9jb21tb24vZG9tYWluLmMKQEAgLTQ3LDYgKzQ3LDEwIEBA
CiAjaW5jbHVkZSA8YXNtL2d1ZXN0Lmg+CiAjZW5kaWYKIAorLyogT3ZlcnJpZGUgbWFjcm9zIGZy
b20gYXNtL3BhZ2UuaCB0byBtYWtlIHRoZW0gd29yayB3aXRoIG1mbl90ICovCisjdW5kZWYgdmly
dF90b19tZm4KKyNkZWZpbmUgdmlydF90b19tZm4odikgX21mbihfX3ZpcnRfdG9fbWZuKHYpKQor
CiAvKiBMaW51eCBjb25maWcgb3B0aW9uOiBwcm9wYWdldGVkIHRvIGRvbWFpbjAgKi8KIC8qIHhl
bl9wcm9jZXNzb3JfcG1iaXRzOiB4ZW4gY29udHJvbCBDeCwgUHgsIC4uLiAqLwogdW5zaWduZWQg
aW50IHhlbl9wcm9jZXNzb3JfcG1iaXRzID0gWEVOX1BST0NFU1NPUl9QTV9QWDsKQEAgLTE2NDQs
NiArMTY0OCwyOCBAQCBpbnQgY29udGludWVfaHlwZXJjYWxsX29uX2NwdSgKICAgICByZXR1cm4g
MDsKIH0KIAoraW50IGFsbG9jX3NoYXJlZF9pbmZvKHN0cnVjdCBkb21haW4gKmQsIHVuc2lnbmVk
IGludCBtZW1mbGFncykKK3sKKyAgICBpZiAoIChkLT5zaGFyZWRfaW5mby52aXJ0ID0gYWxsb2Nf
eGVuaGVhcF9wYWdlcygwLCBtZW1mbGFncykpID09IE5VTEwgKQorICAgICAgICByZXR1cm4gLUVO
T01FTTsKKworICAgIGQtPnNoYXJlZF9pbmZvLm1mbiA9IHZpcnRfdG9fbWZuKGQtPnNoYXJlZF9p
bmZvLnZpcnQpOworCisgICAgY2xlYXJfcGFnZShkLT5zaGFyZWRfaW5mby52aXJ0KTsKKyAgICBz
aGFyZV94ZW5fcGFnZV93aXRoX2d1ZXN0KG1mbl90b19wYWdlKGQtPnNoYXJlZF9pbmZvLm1mbiks
IGQsIFNIQVJFX3J3KTsKKworICAgIHJldHVybiAwOworfQorCit2b2lkIGZyZWVfc2hhcmVkX2lu
Zm8oc3RydWN0IGRvbWFpbiAqZCkKK3sKKyAgICBpZiAoICFkLT5zaGFyZWRfaW5mby52aXJ0ICkK
KyAgICAgICAgcmV0dXJuOworCisgICAgZnJlZV94ZW5oZWFwX3BhZ2UoZC0+c2hhcmVkX2luZm8u
dmlydCk7CisgICAgZC0+c2hhcmVkX2luZm8udmlydCA9IE5VTEw7Cit9CisKIC8qCiAgKiBMb2Nh
bCB2YXJpYWJsZXM6CiAgKiBtb2RlOiBDCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL2RvbWN0bC5j
IGIveGVuL2NvbW1vbi9kb21jdGwuYwppbmRleCBhNjliM2I1OWE4Li44MWYxOGU2M2E3IDEwMDY0
NAotLS0gYS94ZW4vY29tbW9uL2RvbWN0bC5jCisrKyBiL3hlbi9jb21tb24vZG9tY3RsLmMKQEAg
LTE5Niw3ICsxOTYsNyBAQCB2b2lkIGdldGRvbWFpbmluZm8oc3RydWN0IGRvbWFpbiAqZCwgc3Ry
dWN0IHhlbl9kb21jdGxfZ2V0ZG9tYWluaW5mbyAqaW5mbykKICAgICBpbmZvLT5vdXRzdGFuZGlu
Z19wYWdlcyA9IGQtPm91dHN0YW5kaW5nX3BhZ2VzOwogICAgIGluZm8tPnNocl9wYWdlcyAgICAg
ICAgID0gYXRvbWljX3JlYWQoJmQtPnNocl9wYWdlcyk7CiAgICAgaW5mby0+cGFnZWRfcGFnZXMg
ICAgICAgPSBhdG9taWNfcmVhZCgmZC0+cGFnZWRfcGFnZXMpOwotICAgIGluZm8tPnNoYXJlZF9p
bmZvX2ZyYW1lID0gbWZuX3RvX2dtZm4oZCwgdmlydF90b19tZm4oZC0+c2hhcmVkX2luZm8pKTsK
KyAgICBpbmZvLT5zaGFyZWRfaW5mb19mcmFtZSA9IG1mbl90b19nbWZuKGQsIG1mbl94KGQtPnNo
YXJlZF9pbmZvLm1mbikpOwogICAgIEJVR19PTihTSEFSRURfTTJQKGluZm8tPnNoYXJlZF9pbmZv
X2ZyYW1lKSk7CiAKICAgICBpbmZvLT5jcHVwb29sID0gY3B1cG9vbF9nZXRfaWQoZCk7CmRpZmYg
LS1naXQgYS94ZW4vY29tbW9uL3RpbWUuYyBiL3hlbi9jb21tb24vdGltZS5jCmluZGV4IDgyMzM2
ZTJkNWEuLjU4ZmE5YWJjNDAgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vdGltZS5jCisrKyBiL3hl
bi9jb21tb24vdGltZS5jCkBAIC0xMTAsOSArMTEwLDkgQEAgdm9pZCB1cGRhdGVfZG9tYWluX3dh
bGxjbG9ja190aW1lKHN0cnVjdCBkb21haW4gKmQpCiAgICAgc2hhcmVkX2luZm8oZCwgd2NfbnNl
YykgICA9IHdjX25zZWM7CiAjaWZkZWYgQ09ORklHX1g4NgogICAgIGlmICggbGlrZWx5KCFoYXNf
MzJiaXRfc2hpbmZvKGQpKSApCi0gICAgICAgIGQtPnNoYXJlZF9pbmZvLT5uYXRpdmUud2Nfc2Vj
X2hpID0gc2VjID4+IDMyOworICAgICAgICBkLT5zaGFyZWRfaW5mby52aXJ0LT5uYXRpdmUud2Nf
c2VjX2hpID0gc2VjID4+IDMyOwogICAgIGVsc2UKLSAgICAgICAgZC0+c2hhcmVkX2luZm8tPmNv
bXBhdC5hcmNoLndjX3NlY19oaSA9IHNlYyA+PiAzMjsKKyAgICAgICAgZC0+c2hhcmVkX2luZm8u
dmlydC0+Y29tcGF0LmFyY2gud2Nfc2VjX2hpID0gc2VjID4+IDMyOwogI2Vsc2UKICAgICBzaGFy
ZWRfaW5mbyhkLCB3Y19zZWNfaGkpID0gc2VjID4+IDMyOwogI2VuZGlmCmRpZmYgLS1naXQgYS94
ZW4vaW5jbHVkZS9hc20teDg2L3NoYXJlZC5oIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9zaGFyZWQu
aAppbmRleCBhZjVkOTU5ZDA0Li5kNDU4OGUwOGE2IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS9h
c20teDg2L3NoYXJlZC5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvc2hhcmVkLmgKQEAgLTEs
MjQgKzEsMjUgQEAKICNpZm5kZWYgX19YRU5fWDg2X1NIQVJFRF9IX18KICNkZWZpbmUgX19YRU5f
WDg2X1NIQVJFRF9IX18KIAotI2RlZmluZSBubWlfcmVhc29uKGQpICghaGFzXzMyYml0X3NoaW5m
byhkKSA/ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAgICAgICAgICAg
ICAgICh1MzIgKikmKGQpLT5zaGFyZWRfaW5mby0+bmF0aXZlLmFyY2gubm1pX3JlYXNvbiA6IFwK
LSAgICAgICAgICAgICAgICAgICAgICAgKHUzMiAqKSYoZCktPnNoYXJlZF9pbmZvLT5jb21wYXQu
YXJjaC5ubWlfcmVhc29uKQorI2RlZmluZSBubWlfcmVhc29uKGQpICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAoIWhhc18zMmJpdF9zaGluZm8oZCkgPyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICh1MzIgKikmKGQpLT5z
aGFyZWRfaW5mby52aXJ0LT5uYXRpdmUuYXJjaC5ubWlfcmVhc29uIDogICAgXAorICAgICAodTMy
ICopJihkKS0+c2hhcmVkX2luZm8udmlydC0+Y29tcGF0LmFyY2gubm1pX3JlYXNvbikKIAogI2Rl
ZmluZSBHRVRfU0VUX1NIQVJFRCh0eXBlLCBmaWVsZCkgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKIHN0YXRpYyBpbmxpbmUgdHlwZSBhcmNoX2dldF8jI2ZpZWxkKGNvbnN0IHN0cnVjdCBk
b21haW4gKmQpICAgICBcCiB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAogICAgIHJldHVybiAhaGFzXzMyYml0X3NoaW5mbyhk
KSA/ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgICAgZC0+c2hhcmVk
X2luZm8tPm5hdGl2ZS5hcmNoLmZpZWxkIDogICAgICAgICAgICAgICAgICBcCi0gICAgICAgICAg
IGQtPnNoYXJlZF9pbmZvLT5jb21wYXQuYXJjaC5maWVsZDsgICAgICAgICAgICAgICAgICAgXAor
ICAgICAgICAgICBkLT5zaGFyZWRfaW5mby52aXJ0LT5uYXRpdmUuYXJjaC5maWVsZCA6ICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgZC0+c2hhcmVkX2luZm8udmlydC0+Y29tcGF0LmFyY2guZmll
bGQ7ICAgICAgICAgICAgICBcCiB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogc3RhdGljIGlubGluZSB2b2lkIGFyY2hfc2V0
XyMjZmllbGQoc3RydWN0IGRvbWFpbiAqZCwgICAgICAgICAgIFwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHR5cGUgdmFsKSAgICAgICAgICAgICAgICAgICBcCiB7ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAogICAgIGlmICggIWhhc18zMmJpdF9zaGluZm8oZCkgKSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKLSAgICAgICAgZC0+c2hhcmVkX2luZm8tPm5hdGl2ZS5hcmNoLmZpZWxkID0g
dmFsOyAgICAgICAgICAgICAgICBcCisgICAgICAgIGQtPnNoYXJlZF9pbmZvLnZpcnQtPm5hdGl2
ZS5hcmNoLmZpZWxkID0gdmFsOyAgICAgICAgICAgXAogICAgIGVsc2UgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKLSAgICAgICAgZC0+c2hh
cmVkX2luZm8tPmNvbXBhdC5hcmNoLmZpZWxkID0gdmFsOyAgICAgICAgICAgICAgICBcCisgICAg
ICAgIGQtPnNoYXJlZF9pbmZvLnZpcnQtPmNvbXBhdC5hcmNoLmZpZWxkID0gdmFsOyAgICAgICAg
ICAgXAogfQogCiAjZGVmaW5lIEdFVF9TRVRfVkNQVSh0eXBlLCBmaWVsZCkgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXApkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL2RvbWFpbi5o
IGIveGVuL2luY2x1ZGUveGVuL2RvbWFpbi5oCmluZGV4IDdlNTFkMzYxZGUuLjc0MGUyMDMyYWQg
MTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hlbi9kb21haW4uaAorKysgYi94ZW4vaW5jbHVkZS94
ZW4vZG9tYWluLmgKQEAgLTEzMCw0ICsxMzAsNyBAQCBzdHJ1Y3Qgdm51bWFfaW5mbyB7CiAKIHZv
aWQgdm51bWFfZGVzdHJveShzdHJ1Y3Qgdm51bWFfaW5mbyAqdm51bWEpOwogCitpbnQgYWxsb2Nf
c2hhcmVkX2luZm8oc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IG1lbWZsYWdzKTsKK3Zv
aWQgZnJlZV9zaGFyZWRfaW5mbyhzdHJ1Y3QgZG9tYWluICpkKTsKKwogI2VuZGlmIC8qIF9fWEVO
X0RPTUFJTl9IX18gKi8KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oIGIveGVu
L2luY2x1ZGUveGVuL3NjaGVkLmgKaW5kZXggM2E0ZjQzMDk4Yy4uZjQxZDBhZDJhMCAxMDA2NDQK
LS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVk
LmgKQEAgLTM0Niw3ICszNDYsMTAgQEAgc3RydWN0IGRvbWFpbgogICAgIHVuc2lnbmVkIGludCAg
ICAgbWF4X3ZjcHVzOwogICAgIHN0cnVjdCB2Y3B1ICAgICoqdmNwdTsKIAotICAgIHNoYXJlZF9p
bmZvX3QgICAqc2hhcmVkX2luZm87ICAgICAvKiBzaGFyZWQgZGF0YSBhcmVhICovCisgICAgc3Ry
dWN0IHsKKyAgICAgICAgbWZuX3QgbWZuOworICAgICAgICBzaGFyZWRfaW5mb190ICp2aXJ0Owor
ICAgIH0gc2hhcmVkX2luZm87IC8qIHNoYXJlZCBkYXRhIGFyZWEgKi8KIAogICAgIHNwaW5sb2Nr
X3QgICAgICAgZG9tYWluX2xvY2s7CiAKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zaGFy
ZWQuaCBiL3hlbi9pbmNsdWRlL3hlbi9zaGFyZWQuaAppbmRleCBhNDExYThhM2UzLi41N2IyZmYx
ZTM0IDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vc2hhcmVkLmgKKysrIGIveGVuL2luY2x1
ZGUveGVuL3NoYXJlZC5oCkBAIC00Myw3ICs0Myw3IEBAIHR5cGVkZWYgc3RydWN0IHZjcHVfaW5m
byB2Y3B1X2luZm9fdDsKIAogZXh0ZXJuIHZjcHVfaW5mb190IGR1bW15X3ZjcHVfaW5mbzsKIAot
I2RlZmluZSBzaGFyZWRfaW5mbyhkLCBmaWVsZCkgICAgICBfX3NoYXJlZF9pbmZvKGQsIChkKS0+
c2hhcmVkX2luZm8sIGZpZWxkKQorI2RlZmluZSBzaGFyZWRfaW5mbyhkLCBmaWVsZCkgICAgICBf
X3NoYXJlZF9pbmZvKGQsIChkKS0+c2hhcmVkX2luZm8udmlydCwgZmllbGQpCiAjZGVmaW5lIHZj
cHVfaW5mbyh2LCBmaWVsZCkgICAgICAgIF9fdmNwdV9pbmZvKHYsICh2KS0+dmNwdV9pbmZvLCBm
aWVsZCkKIAogI2VuZGlmIC8qIF9fWEVOX1NIQVJFRF9IX18gKi8KLS0gCjIuMjAuMQoKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWls
aW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVu
cHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

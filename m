Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 2AFC5118D06
	for <lists+xen-devel@lfdr.de>; Tue, 10 Dec 2019 16:51:22 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iehl4-0003bi-K7; Tue, 10 Dec 2019 15:49:06 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=A1/D=2A=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iehl3-0003b4-TM
 for xen-devel@lists.xenproject.org; Tue, 10 Dec 2019 15:49:05 +0000
X-Inumbo-ID: 76eb48f8-1b64-11ea-b6f1-bc764e2007e4
Received: from mail-qt1-x834.google.com (unknown [2607:f8b0:4864:20::834])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 76eb48f8-1b64-11ea-b6f1-bc764e2007e4;
 Tue, 10 Dec 2019 15:48:09 +0000 (UTC)
Received: by mail-qt1-x834.google.com with SMTP id 38so3131172qtb.13
 for <xen-devel@lists.xenproject.org>; Tue, 10 Dec 2019 07:48:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=IKxnF64WqOtC2gu9kOieP6MMS1r7pR3op50iaDflv5Q=;
 b=Sd4MjQiozvV4+2KgB1L1BR501ktZauaE0xOZNJRmwgmYFW9hilqPReAxtKj9rB6akb
 6utXZ0My7hAwSz7ekmyMEp/hdNJxsUGSYAsQ/PGhVs0R6Yl2VpsjXvNTSzUXJ7/+q72o
 G2kJLK0uyaz6mtNFJC6tHF2cfdiZBHGrUXX5HB/JIQzLNLJ771f7CcR9D8+PbhoXE4Sj
 w77mf7gTw1Tp0QVs5zcZzKKabJe/dLHdMuEKcgtCcmljpXsTHzGC++ubCpGwSXpdbhYJ
 HEmIlEbiiOL0PbUkE6+XHPeJzP4whU0YLCzgCTbQUVNKz17aAUrIYSb5FgZEo2Cj5MZU
 4Dhw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=IKxnF64WqOtC2gu9kOieP6MMS1r7pR3op50iaDflv5Q=;
 b=sKUNyEiGvZV99a+IJx3LxfgcWQrrouOCJalV9pHxb7cwGQoytTvW5THpemGqdrVEO4
 jA9T6AlKmOWIkBfPneM4KzAqY0Ntj7P2xWeLvMIBJIYOtnocmTfs6NYmS9Av8/wDQ+oR
 ODDF9Vi7WDyyo1TrCp0KiSUKVaWQ+VwUtj9Ver94A9HZPbsbTSx/I9ELJvKzJ+MFmHRZ
 lF8zmnq1zdKdccltTkGXLQYWIb+9U5yvvYfCufbCsoqOlZuDVjNbfu3gZDbeTH+FERxa
 iUvmQMj7NS/Og2tv/fupszjxwXdimT+J0exqyuMVUdS0WAZw+SJgGkvCkVIfbxs5zafb
 MF5A==
X-Gm-Message-State: APjAAAXsIViAnrIKgN3oib9SP2hLuygwbnCYrTQgGF2ejFekVPJS0j7a
 A0HSKiqfDeRhAhlcZay0EOj70a4c
X-Google-Smtp-Source: APXvYqzcKxw3ICT7f6AE6J7dTOUhQlrQl4h3mF85T9AEpcdvnE1KkHDZqCqi5pQ7twlNRqkwgM1kYQ==
X-Received: by 2002:ac8:36f5:: with SMTP id b50mr31179907qtc.268.1575992887871; 
 Tue, 10 Dec 2019 07:48:07 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id m29sm1247848qtf.1.2019.12.10.07.48.06
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 10 Dec 2019 07:48:07 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 10 Dec 2019 10:47:30 -0500
Message-Id: <3c638e0022455d8c670af7aa0ad5c98305c91221.1575990937.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1575990937.git.rosbrookn@ainfosec.com>
References: <cover.1575990937.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 15/22] golang/xenlight: begin C to Go type
 marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KCkJlZ2luIGltcGxl
bWVudGF0aW9uIG9mIGZyb21DIG1hcnNoYWxpbmcgZnVuY3Rpb25zIGZvciBnZW5lcmF0ZWQgc3Ry
dWN0CnR5cGVzLiBUaGlzIGluY2x1ZGVzIHN1cHBvcnQgZm9yIGNvbnZlcnRpbmcgZmllbGRzIHRo
YXQgYXJlIGJhc2ljCnByaW1pdGl2ZSB0eXBlcyBzdWNoIGFzIHN0cmluZyBhbmQgaW50ZWdlciB0
eXBlcywgbmVzdGVkIGFub255bW91cwpzdHJ1Y3RzLCBuZXN0ZWQgbGlieGwgc3RydWN0cywgYW5k
IGxpYnhsIGJ1aWx0LWluIHR5cGVzLgoKVGhpcyBwYXRjaCBkb2VzIG5vdCBpbXBsZW1lbnQgY29u
dmVyc2lvbiBvZiBhcnJheXMgb3Iga2V5ZWQgdW5pb25zLgoKU2lnbmVkLW9mZi1ieTogTmljayBS
b3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KLS0tCkNoYW5nZXMgaW4gdjI6Ci0gQWRk
IE1ha2VmaWxlIGNoYW5nZXMgZm9yIGhlbHBlcnMuZ2VuLmdvLgotIFJlLWdlbmVyYXRlIGhlbHBl
cnMuZ2VuLmdvIHRvIGluY2x1ZGUgbGlieGwgY2hhbmdlcyBhZnRlciByZWJhc2UuCkNoYW5nZXMg
aW4gdjM6Ci0gQnJlYWsgb3V0IGZpZWxkIGNvcHlpbmcvdHlwZSBjb252ZXJzaW9uIGNvZGUgaW50
byBpdHMgb3duIGZ1bmN0aW9uCiAgY2FsbGVkIHhlbmxpZ2h0X2dvbGFuZ19jb252ZXJ0X2Zyb21f
QyB0byBhbGxvdyB0aGF0IGNvZGUgdG8gYmUgZWFzaWx5CiAgcmUtdXNlZC4KLSBVc2UgY29uc2lz
dGVudCBzdHlsZSBmb3IgY2FsbGluZyBmcm9tQyBvbiBzdHJ1Y3QgZmllbGRzIHRoYXQgcmVxdWly
ZQogIGl0LiBOYW1lbHksIGRvIG5vdCB1c2UgYSB0ZW1wb3JhcnkgdmFyaWFibGUgLSBjYWxsIGZy
b21DIGRpcmVjdGx5IG9uCiAgdGhlIHN0cnVjdCBmaWVsZC4KLS0tCiB0b29scy9nb2xhbmcveGVu
bGlnaHQvTWFrZWZpbGUgICAgICAgfCAgIDIgKwogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dlbmdv
dHlwZXMucHkgIHwgMTE4ICsrKysKIHRvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5n
byB8IDkwMSArKysrKysrKysrKysrKysrKysrKysrKysrKysKIHRvb2xzL2dvbGFuZy94ZW5saWdo
dC94ZW5saWdodC5nbyAgICB8IDExMSArLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDEwMzIgaW5zZXJ0
aW9ucygrKSwgMTAwIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IHRvb2xzL2dvbGFu
Zy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwoKZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFuZy94ZW5s
aWdodC9NYWtlZmlsZSBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9NYWtlZmlsZQppbmRleCA2ODFm
MzJjMjM0Li4wN2I4ODk2ZTViIDEwMDY0NAotLS0gYS90b29scy9nb2xhbmcveGVubGlnaHQvTWFr
ZWZpbGUKKysrIGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L01ha2VmaWxlCkBAIC0xOSw2ICsxOSw3
IEBAICQoWEVOX0dPUEFUSCkvc3JjLyQoWEVOX0dPQ09ERV9VUkwpL3hlbmxpZ2h0LzogJS5nZW4u
Z28KIAkkKElOU1RBTExfRElSKSAkKFhFTl9HT1BBVEgpJChHT1hMX1BLR19ESVIpCiAJJChJTlNU
QUxMX0RBVEEpIHhlbmxpZ2h0LmdvICQoWEVOX0dPUEFUSCkkKEdPWExfUEtHX0RJUikKIAkkKElO
U1RBTExfREFUQSkgdHlwZXMuZ2VuLmdvICQoWEVOX0dPUEFUSCkkKEdPWExfUEtHX0RJUikKKwkk
KElOU1RBTExfREFUQSkgaGVscGVycy5nZW4uZ28gJChYRU5fR09QQVRIKSQoR09YTF9QS0dfRElS
KQogCiAlLmdlbi5nbzogZ2VuZ290eXBlcy5weSAkKFhFTl9ST09UKS90b29scy9saWJ4bC9saWJ4
bF90eXBlcy5pZGwgJChYRU5fUk9PVCkvdG9vbHMvbGlieGwvaWRsLnB5CiAJWEVOX1JPT1Q9JChY
RU5fUk9PVCkgJChQWVRIT04pIGdlbmdvdHlwZXMucHkgLi4vLi4vbGlieGwvbGlieGxfdHlwZXMu
aWRsCkBAIC0zOSw2ICs0MCw3IEBAIGluc3RhbGw6IGJ1aWxkCiAJJChJTlNUQUxMX0RJUikgJChE
RVNURElSKSQoR09YTF9JTlNUQUxMX0RJUikKIAkkKElOU1RBTExfREFUQSkgJChYRU5fR09QQVRI
KSQoR09YTF9QS0dfRElSKXhlbmxpZ2h0LmdvICQoREVTVERJUikkKEdPWExfSU5TVEFMTF9ESVIp
CiAJJChJTlNUQUxMX0RBVEEpICQoWEVOX0dPUEFUSCkkKEdPWExfUEtHX0RJUil0eXBlcy5nZW4u
Z28gJChERVNURElSKSQoR09YTF9JTlNUQUxMX0RJUikKKwkkKElOU1RBTExfREFUQSkgJChYRU5f
R09QQVRIKSQoR09YTF9QS0dfRElSKWhlbHBlcnMuZ2VuLmdvICQoREVTVERJUikkKEdPWExfSU5T
VEFMTF9ESVIpCiAKIC5QSE9OWTogdW5pbnN0YWxsCiAJcm0gLXJmICQoREVTVERJUikkKEdPWExf
SU5TVEFMTF9ESVIpCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBl
cy5weSBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CmluZGV4IDg5NjNiMTRl
ZWUuLjFmZTU2MTc5ZTIgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5
cGVzLnB5CisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CkBAIC0xOCw2
ICsxOCwxMiBAQCBidWlsdGluX3R5cGVfbmFtZXMgPSB7CiAgICAgaWRsLnVpbnQ2NC50eXBlbmFt
ZTogJ3VpbnQ2NCcsCiB9CiAKKyMgU29tZSBnbyBrZXl3b3JkcyB0aGF0IGNvbmZsaWN0IHdpdGgg
ZmllbGQgbmFtZXMgaW4gbGlieGwgc3RydWN0cy4KK2dvX2tleXdvcmRzID0gWyd0eXBlJywgJ2Z1
bmMnXQorCitnb19idWlsdGluX3R5cGVzID0gWydib29sJywgJ3N0cmluZycsICdpbnQnLCAnYnl0
ZScsCisgICAgICAgICAgICAgICAgICAgICd1aW50MTYnLCAndWludDMyJywgJ3VpbnQ2NCddCisK
IGRlZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJhdGVfdHlwZXMocGF0aCA9IE5vbmUsIHR5cGVzID0g
Tm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAgICIiIgogICAgIEdlbmVyYXRlIGEgLmdvIGZpbGUg
KHR5cGVzLmdlbi5nbyBieSBkZWZhdWx0KQpAQCAtMTc2LDYgKzE4MiwxMTYgQEAgZGVmIHhlbmxp
Z2h0X2dvbGFuZ19kZWZpbmVfdW5pb24odHkgPSBOb25lLCBzdHJ1Y3RuYW1lID0gJycpOgogCiAg
ICAgcmV0dXJuIChzLGV4dHJhcykKIAorZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5lcmF0ZV9oZWxw
ZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5vbmUsIGNvbW1lbnQgPSBOb25lKToKKyAgICAiIiIK
KyAgICBHZW5lcmF0ZSBhIC5nbyBmaWxlIChoZWxwZXJzLmdlbi5nbyBieSBkZWZhdWx0KQorICAg
IHRoYXQgY29udGFpbnMgaGVscGVyIGZ1bmN0aW9ucyBmb3IgbWFyc2hhbGluZyBiZXR3ZWVuCisg
ICAgQyBhbmQgR28gdHlwZXMuCisgICAgIiIiCisgICAgaWYgcGF0aCBpcyBOb25lOgorICAgICAg
ICBwYXRoID0gJ2hlbHBlcnMuZ2VuLmdvJworCisgICAgd2l0aCBvcGVuKHBhdGgsICd3JykgYXMg
ZjoKKyAgICAgICAgaWYgY29tbWVudCBpcyBub3QgTm9uZToKKyAgICAgICAgICAgIGYud3JpdGUo
Y29tbWVudCkKKyAgICAgICAgZi53cml0ZSgncGFja2FnZSB4ZW5saWdodFxuJykKKworICAgICAg
ICAjIENnbyBwcmVhbWJsZQorICAgICAgICBmLndyaXRlKCcvKlxuJykKKyAgICAgICAgZi53cml0
ZSgnI2NnbyBMREZMQUdTOiAtbHhlbmxpZ2h0XG4nKQorICAgICAgICBmLndyaXRlKCcjaW5jbHVk
ZSA8c3RkbGliLmg+XG4nKQorICAgICAgICBmLndyaXRlKCcjaW5jbHVkZSA8bGlieGwuaD5cbicp
CisgICAgICAgIGYud3JpdGUoJ1xuJykKKworICAgICAgICBmLndyaXRlKCcqL1xuaW1wb3J0ICJD
IlxuJykKKworICAgICAgICBmb3IgdHkgaW4gdHlwZXM6CisgICAgICAgICAgICBpZiBub3QgaXNp
bnN0YW5jZSh0eSwgaWRsLlN0cnVjdCk6CisgICAgICAgICAgICAgICAgY29udGludWUKKworICAg
ICAgICAgICAgZi53cml0ZSh4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSkpCisgICAg
ICAgICAgICBmLndyaXRlKCdcbicpCisKKyAgICBnb19mbXQocGF0aCkKKworZGVmIHhlbmxpZ2h0
X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5ID0gTm9uZSk6CisgICAgIiIiCisgICAgRGVmaW5lIHRo
ZSBmcm9tQyBtYXJzaGFsaW5nIGZ1bmN0aW9uIGZvciB0aGUgdHlwZQorICAgIHJlcHJlc2VudGVk
IGJ5IHR5LgorICAgICIiIgorICAgIGZ1bmMgPSAnZnVuYyAoeCAqe30pIGZyb21DKHhjICpDLnt9
KSBlcnJvciB7e1xuIHt9IFxuIHJldHVybiBuaWx9fVxuJworCisgICAgZ29uYW1lID0geGVubGln
aHRfZ29sYW5nX2ZtdF9uYW1lKHR5LnR5cGVuYW1lKQorICAgIGNuYW1lICA9IHR5LnR5cGVuYW1l
CisKKyAgICBib2R5ID0gJycKKworICAgIGZvciBmIGluIHR5LmZpZWxkczoKKyAgICAgICAgaWYg
Zi50eXBlLnR5cGVuYW1lIGlzIG5vdCBOb25lOgorICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShm
LnR5cGUsIGlkbC5BcnJheSk6CisgICAgICAgICAgICAgICAgIyBUT0RPCisgICAgICAgICAgICAg
ICAgY29udGludWUKKworICAgICAgICAgICAgYm9keSArPSB4ZW5saWdodF9nb2xhbmdfY29udmVy
dF9mcm9tX0MoZikKKworICAgICAgICBlbGlmIGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuU3RydWN0
KToKKyAgICAgICAgICAgICMgR28gdGhyb3VnaCB0aGUgZmllbGRzIG9mIHRoZSBhbm9ueW1vdXMg
bmVzdGVkIHN0cnVjdC4KKyAgICAgICAgICAgIGZvciBuZiBpbiBmLnR5cGUuZmllbGRzOgorICAg
ICAgICAgICAgICAgIGJvZHkgKz0geGVubGlnaHRfZ29sYW5nX2NvbnZlcnRfZnJvbV9DKG5mLG91
dGVyX25hbWU9Zi5uYW1lKQorCisgICAgICAgIGVsaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5L
ZXllZFVuaW9uKToKKyAgICAgICAgICAgIHBhc3MKKworICAgICAgICBlbHNlOgorICAgICAgICAg
ICAgcmFpc2UgRXhjZXB0aW9uKCd0eXBlIHt9IG5vdCBzdXBwb3J0ZWQnLmZvcm1hdChmLnR5cGUp
KQorCisgICAgcmV0dXJuIGZ1bmMuZm9ybWF0KGdvbmFtZSwgY25hbWUsIGJvZHkpCisKK2RlZiB4
ZW5saWdodF9nb2xhbmdfY29udmVydF9mcm9tX0ModHkgPSBOb25lLCBvdXRlcl9uYW1lID0gTm9u
ZSk6CisgICAgIiIiCisgICAgUmV0dXJucyBhIGxpbmUgb2YgR28gY29kZSB0aGF0IGNvbnZlcnRz
IHRoZSBDIHR5cGUgcmVwcmVzZW50ZWQKKyAgICBieSB0eSB0byBpdHMgY29ycmVzcG9uZGluZyBH
byB0eXBlLgorCisgICAgSWYgb3V0ZXJfbmFtZSBpcyBzZXQsIHRoZSB0eXBlIGlzIHRyZWF0ZWQg
YXMgbmVzdGVkIHdpdGhpbiBhbm90aGVyIGZpZWxkCisgICAgbmFtZWQgb3V0ZXJfbmFtZS4KKyAg
ICAiIiIKKyAgICBzID0gJycKKworICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10
X25hbWUodHkudHlwZS50eXBlbmFtZSkKKyAgICBnb25hbWUgICAgID0geGVubGlnaHRfZ29sYW5n
X2ZtdF9uYW1lKHR5Lm5hbWUpCisgICAgY25hbWUgICAgICA9IHR5Lm5hbWUKKworICAgICMgSW4g
Y2dvLCBDIG5hbWVzIHRoYXQgY29uZmxpY3Qgd2l0aCBHbyBrZXl3b3JkcyBjYW4gYmUKKyAgICAj
IGFjY2Vzc2VkIGJ5IHByZXBlbmRpbmcgYW4gdW5kZXJzY29yZSB0byB0aGUgbmFtZS4KKyAgICBp
ZiBjbmFtZSBpbiBnb19rZXl3b3JkczoKKyAgICAgICAgY25hbWUgPSAnXycgKyBjbmFtZQorCisg
ICAgIyBJZiBvdXRlcl9uYW1lIGlzIHNldCwgdHJlYXQgdGhpcyBhcyBuZXN0ZWQuCisgICAgaWYg
b3V0ZXJfbmFtZSBpcyBub3QgTm9uZToKKyAgICAgICAgZ29uYW1lID0gJ3t9Lnt9Jy5mb3JtYXQo
eGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG91dGVyX25hbWUpLCBnb25hbWUpCisgICAgICAgIGNu
YW1lICA9ICd7fS57fScuZm9ybWF0KG91dGVyX25hbWUsIGNuYW1lKQorCisgICAgIyBUeXBlcyB0
aGF0IHNhdGlzZnkgdGhpcyBjb25kaXRpb24gY2FuIGJlIGVhc2lseSBjYXN0ZWQgb3IKKyAgICAj
IGNvbnZlcnRlZCB0byBhIEdvIGJ1aWx0aW4gdHlwZS4KKyAgICBpc19jYXN0YWJsZSA9ICh0eS50
eXBlLmpzb25fcGFyc2VfdHlwZSA9PSAnSlNPTl9JTlRFR0VSJyBvcgorICAgICAgICAgICAgICAg
ICAgIGlzaW5zdGFuY2UodHkudHlwZSwgaWRsLkVudW1lcmF0aW9uKSBvcgorICAgICAgICAgICAg
ICAgICAgIGdvdHlwZW5hbWUgaW4gZ29fYnVpbHRpbl90eXBlcykKKworICAgIGlmIG5vdCBpc19j
YXN0YWJsZToKKyAgICAgICAgIyBJZiB0aGUgdHlwZSBpcyBub3QgY2FzdGFibGUsIHdlIG5lZWQg
dG8gY2FsbCBpdHMgZnJvbUMKKyAgICAgICAgIyBmdW5jdGlvbi4KKyAgICAgICAgcyArPSAnaWYg
ZXJyIDo9IHgue30uZnJvbUMoJnhjLnt9KTsnLmZvcm1hdChnb25hbWUsY25hbWUpCisgICAgICAg
IHMgKz0gJ2VyciAhPSBuaWwge1xuIHJldHVybiBlcnIgXG59XG4nCisKKyAgICBlbGlmIGdvdHlw
ZW5hbWUgPT0gJ3N0cmluZyc6CisgICAgICAgICMgVXNlIHRoZSBjZ28gaGVscGVyIGZvciBjb252
ZXJ0aW5nIEMgc3RyaW5ncy4KKyAgICAgICAgcyArPSAneC57fSA9IEMuR29TdHJpbmcoeGMue30p
XG4nLmZvcm1hdChnb25hbWUsIGNuYW1lKQorCisgICAgZWxzZToKKyAgICAgICAgcyArPSAneC57
fSA9IHt9KHhjLnt9KVxuJy5mb3JtYXQoZ29uYW1lLCBnb3R5cGVuYW1lLCBjbmFtZSkKKworICAg
IHJldHVybiBzCisKIGRlZiB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUobmFtZSwgZXhwb3J0ZWQg
PSBUcnVlKToKICAgICAiIiIKICAgICBUYWtlIGEgZ2l2ZW4gdHlwZSBuYW1lIGFuZCByZXR1cm4g
YW4KQEAgLTIxOCwzICszMzQsNSBAQCBpZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogCiAgICAg
eGVubGlnaHRfZ29sYW5nX2dlbmVyYXRlX3R5cGVzKHR5cGVzPXR5cGVzLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50PWhlYWRlcl9jb21tZW50KQorICAgIHhlbmxp
Z2h0X2dvbGFuZ19nZW5lcmF0ZV9oZWxwZXJzKHR5cGVzPXR5cGVzLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ9aGVhZGVyX2NvbW1lbnQpCmRpZmYgLS1naXQg
YS90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28gYi90b29scy9nb2xhbmcveGVu
bGlnaHQvaGVscGVycy5nZW4uZ28KbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAw
MC4uNTc2YWViY2Y2ZAotLS0gL2Rldi9udWxsCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9o
ZWxwZXJzLmdlbi5nbwpAQCAtMCwwICsxLDkwMSBAQAorLy8gRE8gTk9UIEVESVQuCisvLworLy8g
VGhpcyBmaWxlIGlzIGdlbmVyYXRlZCBieToKKy8vIGdlbmdvdHlwZXMucHkgLi4vLi4vbGlieGwv
bGlieGxfdHlwZXMuaWRsCisvLworcGFja2FnZSB4ZW5saWdodAorCisvKgorI2NnbyBMREZMQUdT
OiAtbHhlbmxpZ2h0CisjaW5jbHVkZSA8c3RkbGliLmg+CisjaW5jbHVkZSA8bGlieGwuaD4KKwor
Ki8KK2ltcG9ydCAiQyIKKworZnVuYyAoeCAqSW9wb3J0UmFuZ2UpIGZyb21DKHhjICpDLmxpYnhs
X2lvcG9ydF9yYW5nZSkgZXJyb3IgeworCXguRmlyc3QgPSB1aW50MzIoeGMuZmlyc3QpCisJeC5O
dW1iZXIgPSB1aW50MzIoeGMubnVtYmVyKQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpJ
b21lbVJhbmdlKSBmcm9tQyh4YyAqQy5saWJ4bF9pb21lbV9yYW5nZSkgZXJyb3IgeworCXguU3Rh
cnQgPSB1aW50NjQoeGMuc3RhcnQpCisJeC5OdW1iZXIgPSB1aW50NjQoeGMubnVtYmVyKQorCXgu
R2ZuID0gdWludDY0KHhjLmdmbikKKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqVmdhSW50
ZXJmYWNlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmdhX2ludGVyZmFjZV9pbmZvKSBlcnJvciB7
CisJeC5LaW5kID0gVmdhSW50ZXJmYWNlVHlwZSh4Yy5raW5kKQorCisJcmV0dXJuIG5pbAorfQor
CitmdW5jICh4ICpWbmNJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bmNfaW5mbykgZXJyb3Igewor
CWlmIGVyciA6PSB4LkVuYWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBlcnIKKwl9CisJeC5MaXN0ZW4gPSBDLkdvU3RyaW5nKHhjLmxpc3RlbikKKwl4LlBhc3N3
ZCA9IEMuR29TdHJpbmcoeGMucGFzc3dkKQorCXguRGlzcGxheSA9IGludCh4Yy5kaXNwbGF5KQor
CWlmIGVyciA6PSB4LkZpbmR1bnVzZWQuZnJvbUMoJnhjLmZpbmR1bnVzZWQpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqU3BpY2VJ
bmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9zcGljZV9pbmZvKSBlcnJvciB7CisJaWYgZXJyIDo9IHgu
RW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
Kwl4LlBvcnQgPSBpbnQoeGMucG9ydCkKKwl4LlRsc1BvcnQgPSBpbnQoeGMudGxzX3BvcnQpCisJ
eC5Ib3N0ID0gQy5Hb1N0cmluZyh4Yy5ob3N0KQorCWlmIGVyciA6PSB4LkRpc2FibGVUaWNrZXRp
bmcuZnJvbUMoJnhjLmRpc2FibGVfdGlja2V0aW5nKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJeC5QYXNzd2QgPSBDLkdvU3RyaW5nKHhjLnBhc3N3ZCkKKwlpZiBlcnIgOj0geC5B
Z2VudE1vdXNlLmZyb21DKCZ4Yy5hZ2VudF9tb3VzZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4g
ZXJyCisJfQorCWlmIGVyciA6PSB4LlZkYWdlbnQuZnJvbUMoJnhjLnZkYWdlbnQpOyBlcnIgIT0g
bmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5DbGlwYm9hcmRTaGFyaW5nLmZy
b21DKCZ4Yy5jbGlwYm9hcmRfc2hhcmluZyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCXguVXNicmVkaXJlY3Rpb24gPSBpbnQoeGMudXNicmVkaXJlY3Rpb24pCisJeC5JbWFnZUNv
bXByZXNzaW9uID0gQy5Hb1N0cmluZyh4Yy5pbWFnZV9jb21wcmVzc2lvbikKKwl4LlN0cmVhbWlu
Z1ZpZGVvID0gQy5Hb1N0cmluZyh4Yy5zdHJlYW1pbmdfdmlkZW8pCisKKwlyZXR1cm4gbmlsCit9
CisKK2Z1bmMgKHggKlNkbEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3NkbF9pbmZvKSBlcnJvciB7
CisJaWYgZXJyIDo9IHguRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5PcGVuZ2wuZnJvbUMoJnhjLm9wZW5nbCk7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguRGlzcGxheSA9IEMuR29TdHJpbmcoeGMu
ZGlzcGxheSkKKwl4LlhhdXRob3JpdHkgPSBDLkdvU3RyaW5nKHhjLnhhdXRob3JpdHkpCisKKwly
ZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWlu
Zm8pIGVycm9yIHsKKwlpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5Eb21pZCA9IERvbWlkKHhjLmRvbWlkKQorCXguU3Np
ZHJlZiA9IHVpbnQzMih4Yy5zc2lkcmVmKQorCXguU3NpZExhYmVsID0gQy5Hb1N0cmluZyh4Yy5z
c2lkX2xhYmVsKQorCXguUnVubmluZyA9IGJvb2woeGMucnVubmluZykKKwl4LkJsb2NrZWQgPSBi
b29sKHhjLmJsb2NrZWQpCisJeC5QYXVzZWQgPSBib29sKHhjLnBhdXNlZCkKKwl4LlNodXRkb3du
ID0gYm9vbCh4Yy5zaHV0ZG93bikKKwl4LkR5aW5nID0gYm9vbCh4Yy5keWluZykKKwl4Lk5ldmVy
U3RvcCA9IGJvb2woeGMubmV2ZXJfc3RvcCkKKwl4LlNodXRkb3duUmVhc29uID0gU2h1dGRvd25S
ZWFzb24oeGMuc2h1dGRvd25fcmVhc29uKQorCXguT3V0c3RhbmRpbmdNZW1rYiA9IHVpbnQ2NCh4
Yy5vdXRzdGFuZGluZ19tZW1rYikKKwl4LkN1cnJlbnRNZW1rYiA9IHVpbnQ2NCh4Yy5jdXJyZW50
X21lbWtiKQorCXguU2hhcmVkTWVta2IgPSB1aW50NjQoeGMuc2hhcmVkX21lbWtiKQorCXguUGFn
ZWRNZW1rYiA9IHVpbnQ2NCh4Yy5wYWdlZF9tZW1rYikKKwl4Lk1heE1lbWtiID0gdWludDY0KHhj
Lm1heF9tZW1rYikKKwl4LkNwdVRpbWUgPSB1aW50NjQoeGMuY3B1X3RpbWUpCisJeC5WY3B1TWF4
SWQgPSB1aW50MzIoeGMudmNwdV9tYXhfaWQpCisJeC5WY3B1T25saW5lID0gdWludDMyKHhjLnZj
cHVfb25saW5lKQorCXguQ3B1cG9vbCA9IHVpbnQzMih4Yy5jcHVwb29sKQorCXguRG9tYWluVHlw
ZSA9IERvbWFpblR5cGUoeGMuZG9tYWluX3R5cGUpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMg
KHggKkNwdXBvb2xpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jcHVwb29saW5mbykgZXJyb3Igewor
CXguUG9vbGlkID0gdWludDMyKHhjLnBvb2xpZCkKKwl4LlBvb2xOYW1lID0gQy5Hb1N0cmluZyh4
Yy5wb29sX25hbWUpCisJeC5TY2hlZCA9IFNjaGVkdWxlcih4Yy5zY2hlZCkKKwl4Lk5Eb20gPSB1
aW50MzIoeGMubl9kb20pCisJaWYgZXJyIDo9IHguQ3B1bWFwLmZyb21DKCZ4Yy5jcHVtYXApOyBl
cnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKworZnVuYyAo
eCAqQ2hhbm5lbGluZm8pIGZyb21DKHhjICpDLmxpYnhsX2NoYW5uZWxpbmZvKSBlcnJvciB7CisJ
eC5CYWNrZW5kID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQorCXguQmFja2VuZElkID0gdWludDMy
KHhjLmJhY2tlbmRfaWQpCisJeC5Gcm9udGVuZCA9IEMuR29TdHJpbmcoeGMuZnJvbnRlbmQpCisJ
eC5Gcm9udGVuZElkID0gdWludDMyKHhjLmZyb250ZW5kX2lkKQorCXguRGV2aWQgPSBEZXZpZCh4
Yy5kZXZpZCkKKwl4LlN0YXRlID0gaW50KHhjLnN0YXRlKQorCXguRXZ0Y2ggPSBpbnQoeGMuZXZ0
Y2gpCisJeC5ScmVmID0gaW50KHhjLnJyZWYpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHgg
KlZtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm1pbmZvKSBlcnJvciB7CisJaWYgZXJyIDo9IHgu
VXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXgu
RG9taWQgPSBEb21pZCh4Yy5kb21pZCkKKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqVmVy
c2lvbkluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZlcnNpb25faW5mbykgZXJyb3IgeworCXguWGVu
VmVyc2lvbk1ham9yID0gaW50KHhjLnhlbl92ZXJzaW9uX21ham9yKQorCXguWGVuVmVyc2lvbk1p
bm9yID0gaW50KHhjLnhlbl92ZXJzaW9uX21pbm9yKQorCXguWGVuVmVyc2lvbkV4dHJhID0gQy5H
b1N0cmluZyh4Yy54ZW5fdmVyc2lvbl9leHRyYSkKKwl4LkNvbXBpbGVyID0gQy5Hb1N0cmluZyh4
Yy5jb21waWxlcikKKwl4LkNvbXBpbGVCeSA9IEMuR29TdHJpbmcoeGMuY29tcGlsZV9ieSkKKwl4
LkNvbXBpbGVEb21haW4gPSBDLkdvU3RyaW5nKHhjLmNvbXBpbGVfZG9tYWluKQorCXguQ29tcGls
ZURhdGUgPSBDLkdvU3RyaW5nKHhjLmNvbXBpbGVfZGF0ZSkKKwl4LkNhcGFiaWxpdGllcyA9IEMu
R29TdHJpbmcoeGMuY2FwYWJpbGl0aWVzKQorCXguQ2hhbmdlc2V0ID0gQy5Hb1N0cmluZyh4Yy5j
aGFuZ2VzZXQpCisJeC5WaXJ0U3RhcnQgPSB1aW50NjQoeGMudmlydF9zdGFydCkKKwl4LlBhZ2Vz
aXplID0gaW50KHhjLnBhZ2VzaXplKQorCXguQ29tbWFuZGxpbmUgPSBDLkdvU3RyaW5nKHhjLmNv
bW1hbmRsaW5lKQorCXguQnVpbGRJZCA9IEMuR29TdHJpbmcoeGMuYnVpbGRfaWQpCisKKwlyZXR1
cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIGZyb21DKHhjICpDLmxpYnhs
X2RvbWFpbl9jcmVhdGVfaW5mbykgZXJyb3IgeworCXguVHlwZSA9IERvbWFpblR5cGUoeGMuX3R5
cGUpCisJaWYgZXJyIDo9IHguSGFwLmZyb21DKCZ4Yy5oYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0
dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5Pb3MuZnJvbUMoJnhjLm9vcyk7IGVyciAhPSBuaWwg
eworCQlyZXR1cm4gZXJyCisJfQorCXguU3NpZHJlZiA9IHVpbnQzMih4Yy5zc2lkcmVmKQorCXgu
U3NpZExhYmVsID0gQy5Hb1N0cmluZyh4Yy5zc2lkX2xhYmVsKQorCXguTmFtZSA9IEMuR29TdHJp
bmcoeGMubmFtZSkKKwlpZiBlcnIgOj0geC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguWHNkYXRhLmZyb21DKCZ4Yy54c2Rh
dGEpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5QbGF0Zm9y
bWRhdGEuZnJvbUMoJnhjLnBsYXRmb3JtZGF0YSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJy
CisJfQorCXguUG9vbGlkID0gdWludDMyKHhjLnBvb2xpZCkKKwl4LlBvb2xOYW1lID0gQy5Hb1N0
cmluZyh4Yy5wb29sX25hbWUpCisJaWYgZXJyIDo9IHguUnVuSG90cGx1Z1NjcmlwdHMuZnJvbUMo
JnhjLnJ1bl9ob3RwbHVnX3NjcmlwdHMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
KwlpZiBlcnIgOj0geC5Ecml2ZXJEb21haW4uZnJvbUMoJnhjLmRyaXZlcl9kb21haW4pOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlBhc3N0aHJvdWdoID0gUGFzc3Rocm91Z2go
eGMucGFzc3Rocm91Z2gpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpblJlc3Rv
cmVQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtcykgZXJyb3Ig
eworCXguQ2hlY2twb2ludGVkU3RyZWFtID0gaW50KHhjLmNoZWNrcG9pbnRlZF9zdHJlYW0pCisJ
eC5TdHJlYW1WZXJzaW9uID0gdWludDMyKHhjLnN0cmVhbV92ZXJzaW9uKQorCXguQ29sb1Byb3h5
U2NyaXB0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3Byb3h5X3NjcmlwdCkKKwlpZiBlcnIgOj0geC5V
c2Vyc3BhY2VDb2xvUHJveHkuZnJvbUMoJnhjLnVzZXJzcGFjZV9jb2xvX3Byb3h5KTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlNj
aGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9wYXJhbXMpIGVycm9yIHsKKwl4LlZj
cHVpZCA9IGludCh4Yy52Y3B1aWQpCisJeC5XZWlnaHQgPSBpbnQoeGMud2VpZ2h0KQorCXguQ2Fw
ID0gaW50KHhjLmNhcCkKKwl4LlBlcmlvZCA9IGludCh4Yy5wZXJpb2QpCisJeC5FeHRyYXRpbWUg
PSBpbnQoeGMuZXh0cmF0aW1lKQorCXguQnVkZ2V0ID0gaW50KHhjLmJ1ZGdldCkKKworCXJldHVy
biBuaWwKK30KKworZnVuYyAoeCAqVmNwdVNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92
Y3B1X3NjaGVkX3BhcmFtcykgZXJyb3IgeworCXguU2NoZWQgPSBTY2hlZHVsZXIoeGMuc2NoZWQp
CisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpblNjaGVkUGFyYW1zKSBmcm9tQyh4
YyAqQy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zKSBlcnJvciB7CisJeC5TY2hlZCA9IFNjaGVk
dWxlcih4Yy5zY2hlZCkKKwl4LldlaWdodCA9IGludCh4Yy53ZWlnaHQpCisJeC5DYXAgPSBpbnQo
eGMuY2FwKQorCXguUGVyaW9kID0gaW50KHhjLnBlcmlvZCkKKwl4LkJ1ZGdldCA9IGludCh4Yy5i
dWRnZXQpCisJeC5FeHRyYXRpbWUgPSBpbnQoeGMuZXh0cmF0aW1lKQorCXguU2xpY2UgPSBpbnQo
eGMuc2xpY2UpCisJeC5MYXRlbmN5ID0gaW50KHhjLmxhdGVuY3kpCisKKwlyZXR1cm4gbmlsCit9
CisKK2Z1bmMgKHggKlZub2RlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm5vZGVfaW5mbykgZXJy
b3IgeworCXguTWVta2IgPSB1aW50NjQoeGMubWVta2IpCisJeC5Qbm9kZSA9IHVpbnQzMih4Yy5w
bm9kZSkKKwlpZiBlcnIgOj0geC5WY3B1cy5mcm9tQygmeGMudmNwdXMpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqUmRtUmVzZXJ2
ZSkgZnJvbUMoeGMgKkMubGlieGxfcmRtX3Jlc2VydmUpIGVycm9yIHsKKwl4LlN0cmF0ZWd5ID0g
UmRtUmVzZXJ2ZVN0cmF0ZWd5KHhjLnN0cmF0ZWd5KQorCXguUG9saWN5ID0gUmRtUmVzZXJ2ZVBv
bGljeSh4Yy5wb2xpY3kpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpbkJ1aWxk
SW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm8pIGVycm9yIHsKKwl4Lk1h
eFZjcHVzID0gaW50KHhjLm1heF92Y3B1cykKKwlpZiBlcnIgOj0geC5BdmFpbFZjcHVzLmZyb21D
KCZ4Yy5hdmFpbF92Y3B1cyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVy
ciA6PSB4LkNwdW1hcC5mcm9tQygmeGMuY3B1bWFwKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJaWYgZXJyIDo9IHguTm9kZW1hcC5mcm9tQygmeGMubm9kZW1hcCk7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4Lk51bWFQbGFjZW1lbnQuZnJvbUMo
JnhjLm51bWFfcGxhY2VtZW50KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5U
c2NNb2RlID0gVHNjTW9kZSh4Yy50c2NfbW9kZSkKKwl4Lk1heE1lbWtiID0gdWludDY0KHhjLm1h
eF9tZW1rYikKKwl4LlRhcmdldE1lbWtiID0gdWludDY0KHhjLnRhcmdldF9tZW1rYikKKwl4LlZp
ZGVvTWVta2IgPSB1aW50NjQoeGMudmlkZW9fbWVta2IpCisJeC5TaGFkb3dNZW1rYiA9IHVpbnQ2
NCh4Yy5zaGFkb3dfbWVta2IpCisJeC5Jb21tdU1lbWtiID0gdWludDY0KHhjLmlvbW11X21lbWti
KQorCXguUnRjVGltZW9mZnNldCA9IHVpbnQzMih4Yy5ydGNfdGltZW9mZnNldCkKKwl4LkV4ZWNT
c2lkcmVmID0gdWludDMyKHhjLmV4ZWNfc3NpZHJlZikKKwl4LkV4ZWNTc2lkTGFiZWwgPSBDLkdv
U3RyaW5nKHhjLmV4ZWNfc3NpZF9sYWJlbCkKKwlpZiBlcnIgOj0geC5Mb2NhbHRpbWUuZnJvbUMo
JnhjLmxvY2FsdGltZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6
PSB4LkRpc2FibGVNaWdyYXRlLmZyb21DKCZ4Yy5kaXNhYmxlX21pZ3JhdGUpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5DcHVpZC5mcm9tQygmeGMuY3B1aWQp
OyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkJsa2RldlN0YXJ0ID0gQy5Hb1N0
cmluZyh4Yy5ibGtkZXZfc3RhcnQpCisJeC5NYXhHcmFudEZyYW1lcyA9IHVpbnQzMih4Yy5tYXhf
Z3JhbnRfZnJhbWVzKQorCXguTWF4TWFwdHJhY2tGcmFtZXMgPSB1aW50MzIoeGMubWF4X21hcHRy
YWNrX2ZyYW1lcykKKwl4LkRldmljZU1vZGVsVmVyc2lvbiA9IERldmljZU1vZGVsVmVyc2lvbih4
Yy5kZXZpY2VfbW9kZWxfdmVyc2lvbikKKwlpZiBlcnIgOj0geC5EZXZpY2VNb2RlbFN0dWJkb21h
aW4uZnJvbUMoJnhjLmRldmljZV9tb2RlbF9zdHViZG9tYWluKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBlcnIKKwl9CisJeC5EZXZpY2VNb2RlbCA9IEMuR29TdHJpbmcoeGMuZGV2aWNlX21vZGVs
KQorCXguRGV2aWNlTW9kZWxTc2lkcmVmID0gdWludDMyKHhjLmRldmljZV9tb2RlbF9zc2lkcmVm
KQorCXguRGV2aWNlTW9kZWxTc2lkTGFiZWwgPSBDLkdvU3RyaW5nKHhjLmRldmljZV9tb2RlbF9z
c2lkX2xhYmVsKQorCXguRGV2aWNlTW9kZWxVc2VyID0gQy5Hb1N0cmluZyh4Yy5kZXZpY2VfbW9k
ZWxfdXNlcikKKwlpZiBlcnIgOj0geC5FeHRyYS5mcm9tQygmeGMuZXh0cmEpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5FeHRyYVB2LmZyb21DKCZ4Yy5leHRy
YV9wdik7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkV4dHJh
SHZtLmZyb21DKCZ4Yy5leHRyYV9odm0pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
KwlpZiBlcnIgOj0geC5TY2hlZFBhcmFtcy5mcm9tQygmeGMuc2NoZWRfcGFyYW1zKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguQ2xhaW1Nb2RlLmZyb21DKCZ4
Yy5jbGFpbV9tb2RlKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5FdmVudENo
YW5uZWxzID0gdWludDMyKHhjLmV2ZW50X2NoYW5uZWxzKQorCXguS2VybmVsID0gQy5Hb1N0cmlu
Zyh4Yy5rZXJuZWwpCisJeC5DbWRsaW5lID0gQy5Hb1N0cmluZyh4Yy5jbWRsaW5lKQorCXguUmFt
ZGlzayA9IEMuR29TdHJpbmcoeGMucmFtZGlzaykKKwl4LkRldmljZVRyZWUgPSBDLkdvU3RyaW5n
KHhjLmRldmljZV90cmVlKQorCWlmIGVyciA6PSB4LkFjcGkuZnJvbUMoJnhjLmFjcGkpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LkJvb3Rsb2FkZXIgPSBDLkdvU3RyaW5nKHhj
LmJvb3Rsb2FkZXIpCisJaWYgZXJyIDo9IHguQm9vdGxvYWRlckFyZ3MuZnJvbUMoJnhjLmJvb3Rs
b2FkZXJfYXJncyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguVGltZXJNb2Rl
ID0gVGltZXJNb2RlKHhjLnRpbWVyX21vZGUpCisJaWYgZXJyIDo9IHguTmVzdGVkSHZtLmZyb21D
KCZ4Yy5uZXN0ZWRfaHZtKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJy
IDo9IHguQXBpYy5mcm9tQygmeGMuYXBpYyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCWlmIGVyciA6PSB4LkRtUmVzdHJpY3QuZnJvbUMoJnhjLmRtX3Jlc3RyaWN0KTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5UZWUgPSBUZWVUeXBlKHhjLnRlZSkKKwl4LkFy
Y2hBcm0uR2ljVmVyc2lvbiA9IEdpY1ZlcnNpb24oeGMuYXJjaF9hcm0uZ2ljX3ZlcnNpb24pCisJ
eC5BcmNoQXJtLlZ1YXJ0ID0gVnVhcnRUeXBlKHhjLmFyY2hfYXJtLnZ1YXJ0KQorCXguQWx0cDJN
ID0gQWx0cDJNTW9kZSh4Yy5hbHRwMm0pCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRl
dmljZVZmYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgZXJyb3IgeworCXguQmFja2Vu
ZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKKwl4LkJhY2tlbmREb21uYW1lID0gQy5H
b1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQor
CWlmIGVyciA6PSB4LlZuYy5mcm9tQygmeGMudm5jKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJaWYgZXJyIDo9IHguU2RsLmZyb21DKCZ4Yy5zZGwpOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwl4LktleW1hcCA9IEMuR29TdHJpbmcoeGMua2V5bWFwKQorCisJcmV0
dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VWa2IpIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV92a2IpIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQp
CisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQorCXgu
RGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKwl4LkJhY2tlbmRUeXBlID0gVmtiQmFja2VuZCh4Yy5i
YWNrZW5kX3R5cGUpCisJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQorCXgu
RmVhdHVyZURpc2FibGVLZXlib2FyZCA9IGJvb2woeGMuZmVhdHVyZV9kaXNhYmxlX2tleWJvYXJk
KQorCXguRmVhdHVyZURpc2FibGVQb2ludGVyID0gYm9vbCh4Yy5mZWF0dXJlX2Rpc2FibGVfcG9p
bnRlcikKKwl4LkZlYXR1cmVBYnNQb2ludGVyID0gYm9vbCh4Yy5mZWF0dXJlX2Fic19wb2ludGVy
KQorCXguRmVhdHVyZVJhd1BvaW50ZXIgPSBib29sKHhjLmZlYXR1cmVfcmF3X3BvaW50ZXIpCisJ
eC5GZWF0dXJlTXVsdGlUb3VjaCA9IGJvb2woeGMuZmVhdHVyZV9tdWx0aV90b3VjaCkKKwl4Lldp
ZHRoID0gdWludDMyKHhjLndpZHRoKQorCXguSGVpZ2h0ID0gdWludDMyKHhjLmhlaWdodCkKKwl4
Lk11bHRpVG91Y2hXaWR0aCA9IHVpbnQzMih4Yy5tdWx0aV90b3VjaF93aWR0aCkKKwl4Lk11bHRp
VG91Y2hIZWlnaHQgPSB1aW50MzIoeGMubXVsdGlfdG91Y2hfaGVpZ2h0KQorCXguTXVsdGlUb3Vj
aE51bUNvbnRhY3RzID0gdWludDMyKHhjLm11bHRpX3RvdWNoX251bV9jb250YWN0cykKKworCXJl
dHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlRGlzaykgZnJvbUMoeGMgKkMubGlieGxfZGV2
aWNlX2Rpc2spIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9t
aWQpCisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQor
CXguUGRldlBhdGggPSBDLkdvU3RyaW5nKHhjLnBkZXZfcGF0aCkKKwl4LlZkZXYgPSBDLkdvU3Ry
aW5nKHhjLnZkZXYpCisJeC5CYWNrZW5kID0gRGlza0JhY2tlbmQoeGMuYmFja2VuZCkKKwl4LkZv
cm1hdCA9IERpc2tGb3JtYXQoeGMuZm9ybWF0KQorCXguU2NyaXB0ID0gQy5Hb1N0cmluZyh4Yy5z
Y3JpcHQpCisJeC5SZW1vdmFibGUgPSBpbnQoeGMucmVtb3ZhYmxlKQorCXguUmVhZHdyaXRlID0g
aW50KHhjLnJlYWR3cml0ZSkKKwl4LklzQ2Ryb20gPSBpbnQoeGMuaXNfY2Ryb20pCisJeC5EaXJl
Y3RJb1NhZmUgPSBib29sKHhjLmRpcmVjdF9pb19zYWZlKQorCWlmIGVyciA6PSB4LkRpc2NhcmRF
bmFibGUuZnJvbUMoJnhjLmRpc2NhcmRfZW5hYmxlKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBl
cnIKKwl9CisJaWYgZXJyIDo9IHguQ29sb0VuYWJsZS5mcm9tQygmeGMuY29sb19lbmFibGUpOyBl
cnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5Db2xvUmVzdG9yZUVu
YWJsZS5mcm9tQygmeGMuY29sb19yZXN0b3JlX2VuYWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gZXJyCisJfQorCXguQ29sb0hvc3QgPSBDLkdvU3RyaW5nKHhjLmNvbG9faG9zdCkKKwl4LkNv
bG9Qb3J0ID0gaW50KHhjLmNvbG9fcG9ydCkKKwl4LkNvbG9FeHBvcnQgPSBDLkdvU3RyaW5nKHhj
LmNvbG9fZXhwb3J0KQorCXguQWN0aXZlRGlzayA9IEMuR29TdHJpbmcoeGMuYWN0aXZlX2Rpc2sp
CisJeC5IaWRkZW5EaXNrID0gQy5Hb1N0cmluZyh4Yy5oaWRkZW5fZGlzaykKKworCXJldHVybiBu
aWwKK30KKworZnVuYyAoeCAqRGV2aWNlTmljKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2Vfbmlj
KSBlcnJvciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXgu
QmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LkRldmlk
ID0gRGV2aWQoeGMuZGV2aWQpCisJeC5NdHUgPSBpbnQoeGMubXR1KQorCXguTW9kZWwgPSBDLkdv
U3RyaW5nKHhjLm1vZGVsKQorCWlmIGVyciA6PSB4Lk1hYy5mcm9tQygmeGMubWFjKTsgZXJyICE9
IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5JcCA9IEMuR29TdHJpbmcoeGMuaXApCisJeC5C
cmlkZ2UgPSBDLkdvU3RyaW5nKHhjLmJyaWRnZSkKKwl4LklmbmFtZSA9IEMuR29TdHJpbmcoeGMu
aWZuYW1lKQorCXguU2NyaXB0ID0gQy5Hb1N0cmluZyh4Yy5zY3JpcHQpCisJeC5OaWN0eXBlID0g
TmljVHlwZSh4Yy5uaWN0eXBlKQorCXguUmF0ZUJ5dGVzUGVySW50ZXJ2YWwgPSB1aW50NjQoeGMu
cmF0ZV9ieXRlc19wZXJfaW50ZXJ2YWwpCisJeC5SYXRlSW50ZXJ2YWxVc2VjcyA9IHVpbnQzMih4
Yy5yYXRlX2ludGVydmFsX3VzZWNzKQorCXguR2F0ZXdheWRldiA9IEMuR29TdHJpbmcoeGMuZ2F0
ZXdheWRldikKKwl4LkNvbG9mdEZvcndhcmRkZXYgPSBDLkdvU3RyaW5nKHhjLmNvbG9mdF9mb3J3
YXJkZGV2KQorCXguQ29sb1NvY2tNaXJyb3JJZCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX21p
cnJvcl9pZCkKKwl4LkNvbG9Tb2NrTWlycm9ySXAgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19t
aXJyb3JfaXApCisJeC5Db2xvU29ja01pcnJvclBvcnQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29j
a19taXJyb3JfcG9ydCkKKwl4LkNvbG9Tb2NrQ29tcGFyZVByaUluSWQgPSBDLkdvU3RyaW5nKHhj
LmNvbG9fc29ja19jb21wYXJlX3ByaV9pbl9pZCkKKwl4LkNvbG9Tb2NrQ29tcGFyZVByaUluSXAg
PSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19jb21wYXJlX3ByaV9pbl9pcCkKKwl4LkNvbG9Tb2Nr
Q29tcGFyZVByaUluUG9ydCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX2NvbXBhcmVfcHJpX2lu
X3BvcnQpCisJeC5Db2xvU29ja0NvbXBhcmVTZWNJbklkID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3Nv
Y2tfY29tcGFyZV9zZWNfaW5faWQpCisJeC5Db2xvU29ja0NvbXBhcmVTZWNJbklwID0gQy5Hb1N0
cmluZyh4Yy5jb2xvX3NvY2tfY29tcGFyZV9zZWNfaW5faXApCisJeC5Db2xvU29ja0NvbXBhcmVT
ZWNJblBvcnQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19jb21wYXJlX3NlY19pbl9wb3J0KQor
CXguQ29sb1NvY2tDb21wYXJlTm90aWZ5SWQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19jb21w
YXJlX25vdGlmeV9pZCkKKwl4LkNvbG9Tb2NrQ29tcGFyZU5vdGlmeUlwID0gQy5Hb1N0cmluZyh4
Yy5jb2xvX3NvY2tfY29tcGFyZV9ub3RpZnlfaXApCisJeC5Db2xvU29ja0NvbXBhcmVOb3RpZnlQ
b3J0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfY29tcGFyZV9ub3RpZnlfcG9ydCkKKwl4LkNv
bG9Tb2NrUmVkaXJlY3RvcjBJZCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3JlZGlyZWN0b3Iw
X2lkKQorCXguQ29sb1NvY2tSZWRpcmVjdG9yMElwID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tf
cmVkaXJlY3RvcjBfaXApCisJeC5Db2xvU29ja1JlZGlyZWN0b3IwUG9ydCA9IEMuR29TdHJpbmco
eGMuY29sb19zb2NrX3JlZGlyZWN0b3IwX3BvcnQpCisJeC5Db2xvU29ja1JlZGlyZWN0b3IxSWQg
PSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19yZWRpcmVjdG9yMV9pZCkKKwl4LkNvbG9Tb2NrUmVk
aXJlY3RvcjFJcCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3JlZGlyZWN0b3IxX2lwKQorCXgu
Q29sb1NvY2tSZWRpcmVjdG9yMVBvcnQgPSBDLkdvU3RyaW5nKHhjLmNvbG9fc29ja19yZWRpcmVj
dG9yMV9wb3J0KQorCXguQ29sb1NvY2tSZWRpcmVjdG9yMklkID0gQy5Hb1N0cmluZyh4Yy5jb2xv
X3NvY2tfcmVkaXJlY3RvcjJfaWQpCisJeC5Db2xvU29ja1JlZGlyZWN0b3IySXAgPSBDLkdvU3Ry
aW5nKHhjLmNvbG9fc29ja19yZWRpcmVjdG9yMl9pcCkKKwl4LkNvbG9Tb2NrUmVkaXJlY3RvcjJQ
b3J0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjJfcG9ydCkKKwl4LkNvbG9G
aWx0ZXJNaXJyb3JRdWV1ZSA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJfbWlycm9yX3F1ZXVl
KQorCXguQ29sb0ZpbHRlck1pcnJvck91dGRldiA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJf
bWlycm9yX291dGRldikKKwl4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMFF1ZXVlID0gQy5Hb1N0cmlu
Zyh4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMF9xdWV1ZSkKKwl4LkNvbG9GaWx0ZXJSZWRpcmVj
dG9yMEluZGV2ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMF9pbmRldikK
Kwl4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yME91dGRldiA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0
ZXJfcmVkaXJlY3RvcjBfb3V0ZGV2KQorCXguQ29sb0ZpbHRlclJlZGlyZWN0b3IxUXVldWUgPSBD
LkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3IxX3F1ZXVlKQorCXguQ29sb0ZpbHRl
clJlZGlyZWN0b3IxSW5kZXYgPSBDLkdvU3RyaW5nKHhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3Ix
X2luZGV2KQorCXguQ29sb0ZpbHRlclJlZGlyZWN0b3IxT3V0ZGV2ID0gQy5Hb1N0cmluZyh4Yy5j
b2xvX2ZpbHRlcl9yZWRpcmVjdG9yMV9vdXRkZXYpCisJeC5Db2xvQ29tcGFyZVByaUluID0gQy5H
b1N0cmluZyh4Yy5jb2xvX2NvbXBhcmVfcHJpX2luKQorCXguQ29sb0NvbXBhcmVTZWNJbiA9IEMu
R29TdHJpbmcoeGMuY29sb19jb21wYXJlX3NlY19pbikKKwl4LkNvbG9Db21wYXJlT3V0ID0gQy5H
b1N0cmluZyh4Yy5jb2xvX2NvbXBhcmVfb3V0KQorCXguQ29sb0NvbXBhcmVOb3RpZnlEZXYgPSBD
LkdvU3RyaW5nKHhjLmNvbG9fY29tcGFyZV9ub3RpZnlfZGV2KQorCXguQ29sb1NvY2tTZWNSZWRp
cmVjdG9yMElkID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfc2VjX3JlZGlyZWN0b3IwX2lkKQor
CXguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMElwID0gQy5Hb1N0cmluZyh4Yy5jb2xvX3NvY2tfc2Vj
X3JlZGlyZWN0b3IwX2lwKQorCXguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMFBvcnQgPSBDLkdvU3Ry
aW5nKHhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjBfcG9ydCkKKwl4LkNvbG9Tb2NrU2VjUmVk
aXJlY3RvcjFJZCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMV9pZCkK
Kwl4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjFJcCA9IEMuR29TdHJpbmcoeGMuY29sb19zb2NrX3Nl
Y19yZWRpcmVjdG9yMV9pcCkKKwl4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjFQb3J0ID0gQy5Hb1N0
cmluZyh4Yy5jb2xvX3NvY2tfc2VjX3JlZGlyZWN0b3IxX3BvcnQpCisJeC5Db2xvRmlsdGVyU2Vj
UmVkaXJlY3RvcjBRdWV1ZSA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0
b3IwX3F1ZXVlKQorCXguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IwSW5kZXYgPSBDLkdvU3RyaW5n
KHhjLmNvbG9fZmlsdGVyX3NlY19yZWRpcmVjdG9yMF9pbmRldikKKwl4LkNvbG9GaWx0ZXJTZWNS
ZWRpcmVjdG9yME91dGRldiA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0
b3IwX291dGRldikKKwl4LkNvbG9GaWx0ZXJTZWNSZWRpcmVjdG9yMVF1ZXVlID0gQy5Hb1N0cmlu
Zyh4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfcXVldWUpCisJeC5Db2xvRmlsdGVyU2Vj
UmVkaXJlY3RvcjFJbmRldiA9IEMuR29TdHJpbmcoeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0
b3IxX2luZGV2KQorCXguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxT3V0ZGV2ID0gQy5Hb1N0cmlu
Zyh4Yy5jb2xvX2ZpbHRlcl9zZWNfcmVkaXJlY3RvcjFfb3V0ZGV2KQorCXguQ29sb0ZpbHRlclNl
Y1Jld3JpdGVyMFF1ZXVlID0gQy5Hb1N0cmluZyh4Yy5jb2xvX2ZpbHRlcl9zZWNfcmV3cml0ZXIw
X3F1ZXVlKQorCXguQ29sb0NoZWNrcG9pbnRIb3N0ID0gQy5Hb1N0cmluZyh4Yy5jb2xvX2NoZWNr
cG9pbnRfaG9zdCkKKwl4LkNvbG9DaGVja3BvaW50UG9ydCA9IEMuR29TdHJpbmcoeGMuY29sb19j
aGVja3BvaW50X3BvcnQpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRldmljZVBjaSkg
ZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3BjaSkgZXJyb3IgeworCXguRnVuYyA9IGJ5dGUoeGMu
X2Z1bmMpCisJeC5EZXYgPSBieXRlKHhjLmRldikKKwl4LkJ1cyA9IGJ5dGUoeGMuYnVzKQorCXgu
RG9tYWluID0gaW50KHhjLmRvbWFpbikKKwl4LlZkZXZmbiA9IHVpbnQzMih4Yy52ZGV2Zm4pCisJ
eC5WZnVuY01hc2sgPSB1aW50MzIoeGMudmZ1bmNfbWFzaykKKwl4Lk1zaXRyYW5zbGF0ZSA9IGJv
b2woeGMubXNpdHJhbnNsYXRlKQorCXguUG93ZXJNZ210ID0gYm9vbCh4Yy5wb3dlcl9tZ210KQor
CXguUGVybWlzc2l2ZSA9IGJvb2woeGMucGVybWlzc2l2ZSkKKwl4LlNlaXplID0gYm9vbCh4Yy5z
ZWl6ZSkKKwl4LlJkbVBvbGljeSA9IFJkbVJlc2VydmVQb2xpY3koeGMucmRtX3BvbGljeSkKKwor
CXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlUmRtKSBmcm9tQyh4YyAqQy5saWJ4bF9k
ZXZpY2VfcmRtKSBlcnJvciB7CisJeC5TdGFydCA9IHVpbnQ2NCh4Yy5zdGFydCkKKwl4LlNpemUg
PSB1aW50NjQoeGMuc2l6ZSkKKwl4LlBvbGljeSA9IFJkbVJlc2VydmVQb2xpY3koeGMucG9saWN5
KQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBmcm9tQyh4YyAq
Qy5saWJ4bF9kZXZpY2VfdXNiY3RybCkgZXJyb3IgeworCXguVHlwZSA9IFVzYmN0cmxUeXBlKHhj
Ll90eXBlKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKwl4LlZlcnNpb24gPSBpbnQoeGMu
dmVyc2lvbikKKwl4LlBvcnRzID0gaW50KHhjLnBvcnRzKQorCXguQmFja2VuZERvbWlkID0gRG9t
aWQoeGMuYmFja2VuZF9kb21pZCkKKwl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5i
YWNrZW5kX2RvbW5hbWUpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRldmljZVVzYmRl
dikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3VzYmRldikgZXJyb3IgeworCXguQ3RybCA9IERl
dmlkKHhjLmN0cmwpCisJeC5Qb3J0ID0gaW50KHhjLnBvcnQpCisKKwlyZXR1cm4gbmlsCit9CisK
K2Z1bmMgKHggKkRldmljZUR0ZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfZHRkZXYpIGVy
cm9yIHsKKwl4LlBhdGggPSBDLkdvU3RyaW5nKHhjLnBhdGgpCisKKwlyZXR1cm4gbmlsCit9CisK
K2Z1bmMgKHggKkRldmljZVZ0cG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92dHBtKSBlcnJv
ciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXguQmFja2Vu
ZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LkRldmlkID0gRGV2
aWQoeGMuZGV2aWQpCisJaWYgZXJyIDo9IHguVXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gZXJyCisJfQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZp
Y2VQOSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3A5KSBlcnJvciB7CisJeC5CYWNrZW5kRG9t
aWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3Ry
aW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LlRhZyA9IEMuR29TdHJpbmcoeGMudGFnKQorCXgu
UGF0aCA9IEMuR29TdHJpbmcoeGMucGF0aCkKKwl4LlNlY3VyaXR5TW9kZWwgPSBDLkdvU3RyaW5n
KHhjLnNlY3VyaXR5X21vZGVsKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKworCXJldHVy
biBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlUHZjYWxsc2lmKSBmcm9tQyh4YyAqQy5saWJ4bF9k
ZXZpY2VfcHZjYWxsc2lmKSBlcnJvciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNr
ZW5kX2RvbWlkKQorCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9t
bmFtZSkKKwl4LkRldmlkID0gRGV2aWQoeGMuZGV2aWQpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1
bmMgKHggKkRldmljZUNoYW5uZWwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9jaGFubmVsKSBl
cnJvciB7CisJeC5CYWNrZW5kRG9taWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQorCXguQmFj
a2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKKwl4LkRldmlkID0g
RGV2aWQoeGMuZGV2aWQpCisJeC5OYW1lID0gQy5Hb1N0cmluZyh4Yy5uYW1lKQorCisJcmV0dXJu
IG5pbAorfQorCitmdW5jICh4ICpDb25uZWN0b3JQYXJhbSkgZnJvbUMoeGMgKkMubGlieGxfY29u
bmVjdG9yX3BhcmFtKSBlcnJvciB7CisJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVl
X2lkKQorCXguV2lkdGggPSB1aW50MzIoeGMud2lkdGgpCisJeC5IZWlnaHQgPSB1aW50MzIoeGMu
aGVpZ2h0KQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpEZXZpY2VWZGlzcGwpIGZyb21D
KHhjICpDLmxpYnhsX2RldmljZV92ZGlzcGwpIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERv
bWlkKHhjLmJhY2tlbmRfZG9taWQpCisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMu
YmFja2VuZF9kb21uYW1lKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKwl4LkJlQWxsb2Mg
PSBib29sKHhjLmJlX2FsbG9jKQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpWc25kUGFy
YW1zKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kX3BhcmFtcykgZXJyb3IgeworCXguQ2hhbm5lbHNN
aW4gPSB1aW50MzIoeGMuY2hhbm5lbHNfbWluKQorCXguQ2hhbm5lbHNNYXggPSB1aW50MzIoeGMu
Y2hhbm5lbHNfbWF4KQorCXguQnVmZmVyU2l6ZSA9IHVpbnQzMih4Yy5idWZmZXJfc2l6ZSkKKwor
CXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqVnNuZFN0cmVhbSkgZnJvbUMoeGMgKkMubGlieGxf
dnNuZF9zdHJlYW0pIGVycm9yIHsKKwl4LlVuaXF1ZUlkID0gQy5Hb1N0cmluZyh4Yy51bmlxdWVf
aWQpCisJeC5UeXBlID0gVnNuZFN0cmVhbVR5cGUoeGMuX3R5cGUpCisJaWYgZXJyIDo9IHguUGFy
YW1zLmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwor
CXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqVnNuZFBjbSkgZnJvbUMoeGMgKkMubGlieGxfdnNu
ZF9wY20pIGVycm9yIHsKKwl4Lk5hbWUgPSBDLkdvU3RyaW5nKHhjLm5hbWUpCisJaWYgZXJyIDo9
IHguUGFyYW1zLmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgor
CX0KKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRGV2aWNlVnNuZCkgZnJvbUMoeGMgKkMu
bGlieGxfZGV2aWNlX3ZzbmQpIGVycm9yIHsKKwl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJh
Y2tlbmRfZG9taWQpCisJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9k
b21uYW1lKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZpZCkKKwl4LlNob3J0TmFtZSA9IEMuR29T
dHJpbmcoeGMuc2hvcnRfbmFtZSkKKwl4LkxvbmdOYW1lID0gQy5Hb1N0cmluZyh4Yy5sb25nX25h
bWUpCisJaWYgZXJyIDo9IHguUGFyYW1zLmZyb21DKCZ4Yy5wYXJhbXMpOyBlcnIgIT0gbmlsIHsK
KwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRG9tYWluQ29u
ZmlnKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fY29uZmlnKSBlcnJvciB7CisJaWYgZXJyIDo9
IHguQ0luZm8uZnJvbUMoJnhjLmNfaW5mbyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCWlmIGVyciA6PSB4LkJJbmZvLmZyb21DKCZ4Yy5iX2luZm8pOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwl4Lk9uUG93ZXJvZmYgPSBBY3Rpb25PblNodXRkb3duKHhjLm9uX3Bv
d2Vyb2ZmKQorCXguT25SZWJvb3QgPSBBY3Rpb25PblNodXRkb3duKHhjLm9uX3JlYm9vdCkKKwl4
Lk9uV2F0Y2hkb2cgPSBBY3Rpb25PblNodXRkb3duKHhjLm9uX3dhdGNoZG9nKQorCXguT25DcmFz
aCA9IEFjdGlvbk9uU2h1dGRvd24oeGMub25fY3Jhc2gpCisJeC5PblNvZnRSZXNldCA9IEFjdGlv
bk9uU2h1dGRvd24oeGMub25fc29mdF9yZXNldCkKKworCXJldHVybiBuaWwKK30KKworZnVuYyAo
eCAqRGlza2luZm8pIGZyb21DKHhjICpDLmxpYnhsX2Rpc2tpbmZvKSBlcnJvciB7CisJeC5CYWNr
ZW5kID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQorCXguQmFja2VuZElkID0gdWludDMyKHhjLmJh
Y2tlbmRfaWQpCisJeC5Gcm9udGVuZCA9IEMuR29TdHJpbmcoeGMuZnJvbnRlbmQpCisJeC5Gcm9u
dGVuZElkID0gdWludDMyKHhjLmZyb250ZW5kX2lkKQorCXguRGV2aWQgPSBEZXZpZCh4Yy5kZXZp
ZCkKKwl4LlN0YXRlID0gaW50KHhjLnN0YXRlKQorCXguRXZ0Y2ggPSBpbnQoeGMuZXZ0Y2gpCisJ
eC5ScmVmID0gaW50KHhjLnJyZWYpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKk5pY2lu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsKKwl4LkJhY2tlbmQgPSBDLkdv
U3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkK
Kwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVuZCkKKwl4LkZyb250ZW5kSWQgPSB1
aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQorCXguU3Rh
dGUgPSBpbnQoeGMuc3RhdGUpCisJeC5FdnRjaCA9IGludCh4Yy5ldnRjaCkKKwl4LlJyZWZUeCA9
IGludCh4Yy5ycmVmX3R4KQorCXguUnJlZlJ4ID0gaW50KHhjLnJyZWZfcngpCisKKwlyZXR1cm4g
bmlsCit9CisKK2Z1bmMgKHggKlZ0cG1pbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92dHBtaW5mbykg
ZXJyb3IgeworCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMuYmFja2VuZCkKKwl4LkJhY2tlbmRJ
ZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQorCXguRnJvbnRlbmQgPSBDLkdvU3RyaW5nKHhjLmZy
b250ZW5kKQorCXguRnJvbnRlbmRJZCA9IHVpbnQzMih4Yy5mcm9udGVuZF9pZCkKKwl4LkRldmlk
ID0gRGV2aWQoeGMuZGV2aWQpCisJeC5TdGF0ZSA9IGludCh4Yy5zdGF0ZSkKKwl4LkV2dGNoID0g
aW50KHhjLmV2dGNoKQorCXguUnJlZiA9IGludCh4Yy5ycmVmKQorCWlmIGVyciA6PSB4LlV1aWQu
ZnJvbUMoJnhjLnV1aWQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKworCXJldHVy
biBuaWwKK30KKworZnVuYyAoeCAqVXNiY3RybGluZm8pIGZyb21DKHhjICpDLmxpYnhsX3VzYmN0
cmxpbmZvKSBlcnJvciB7CisJeC5UeXBlID0gVXNiY3RybFR5cGUoeGMuX3R5cGUpCisJeC5EZXZp
ZCA9IERldmlkKHhjLmRldmlkKQorCXguVmVyc2lvbiA9IGludCh4Yy52ZXJzaW9uKQorCXguUG9y
dHMgPSBpbnQoeGMucG9ydHMpCisJeC5CYWNrZW5kID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQor
CXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQpCisJeC5Gcm9udGVuZCA9IEMuR29T
dHJpbmcoeGMuZnJvbnRlbmQpCisJeC5Gcm9udGVuZElkID0gdWludDMyKHhjLmZyb250ZW5kX2lk
KQorCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCisJeC5FdnRjaCA9IGludCh4Yy5ldnRjaCkKKwl4
LlJlZlVyYiA9IGludCh4Yy5yZWZfdXJiKQorCXguUmVmQ29ubiA9IGludCh4Yy5yZWZfY29ubikK
KworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqVmNwdWluZm8pIGZyb21DKHhjICpDLmxpYnhs
X3ZjcHVpbmZvKSBlcnJvciB7CisJeC5WY3B1aWQgPSB1aW50MzIoeGMudmNwdWlkKQorCXguQ3B1
ID0gdWludDMyKHhjLmNwdSkKKwl4Lk9ubGluZSA9IGJvb2woeGMub25saW5lKQorCXguQmxvY2tl
ZCA9IGJvb2woeGMuYmxvY2tlZCkKKwl4LlJ1bm5pbmcgPSBib29sKHhjLnJ1bm5pbmcpCisJeC5W
Y3B1VGltZSA9IHVpbnQ2NCh4Yy52Y3B1X3RpbWUpCisJaWYgZXJyIDo9IHguQ3B1bWFwLmZyb21D
KCZ4Yy5jcHVtYXApOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0g
eC5DcHVtYXBTb2Z0LmZyb21DKCZ4Yy5jcHVtYXBfc29mdCk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gZXJyCisJfQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpQaHlzaW5mbykgZnJvbUMo
eGMgKkMubGlieGxfcGh5c2luZm8pIGVycm9yIHsKKwl4LlRocmVhZHNQZXJDb3JlID0gdWludDMy
KHhjLnRocmVhZHNfcGVyX2NvcmUpCisJeC5Db3Jlc1BlclNvY2tldCA9IHVpbnQzMih4Yy5jb3Jl
c19wZXJfc29ja2V0KQorCXguTWF4Q3B1SWQgPSB1aW50MzIoeGMubWF4X2NwdV9pZCkKKwl4Lk5y
Q3B1cyA9IHVpbnQzMih4Yy5ucl9jcHVzKQorCXguQ3B1S2h6ID0gdWludDMyKHhjLmNwdV9raHop
CisJeC5Ub3RhbFBhZ2VzID0gdWludDY0KHhjLnRvdGFsX3BhZ2VzKQorCXguRnJlZVBhZ2VzID0g
dWludDY0KHhjLmZyZWVfcGFnZXMpCisJeC5TY3J1YlBhZ2VzID0gdWludDY0KHhjLnNjcnViX3Bh
Z2VzKQorCXguT3V0c3RhbmRpbmdQYWdlcyA9IHVpbnQ2NCh4Yy5vdXRzdGFuZGluZ19wYWdlcykK
Kwl4LlNoYXJpbmdGcmVlZFBhZ2VzID0gdWludDY0KHhjLnNoYXJpbmdfZnJlZWRfcGFnZXMpCisJ
eC5TaGFyaW5nVXNlZEZyYW1lcyA9IHVpbnQ2NCh4Yy5zaGFyaW5nX3VzZWRfZnJhbWVzKQorCXgu
TWF4UG9zc2libGVNZm4gPSB1aW50NjQoeGMubWF4X3Bvc3NpYmxlX21mbikKKwl4Lk5yTm9kZXMg
PSB1aW50MzIoeGMubnJfbm9kZXMpCisJaWYgZXJyIDo9IHguSHdDYXAuZnJvbUMoJnhjLmh3X2Nh
cCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXguQ2FwSHZtID0gYm9vbCh4Yy5j
YXBfaHZtKQorCXguQ2FwUHYgPSBib29sKHhjLmNhcF9wdikKKwl4LkNhcEh2bURpcmVjdGlvID0g
Ym9vbCh4Yy5jYXBfaHZtX2RpcmVjdGlvKQorCXguQ2FwSGFwID0gYm9vbCh4Yy5jYXBfaGFwKQor
CXguQ2FwU2hhZG93ID0gYm9vbCh4Yy5jYXBfc2hhZG93KQorCXguQ2FwSW9tbXVIYXBQdFNoYXJl
ID0gYm9vbCh4Yy5jYXBfaW9tbXVfaGFwX3B0X3NoYXJlKQorCisJcmV0dXJuIG5pbAorfQorCitm
dW5jICh4ICpDb25uZWN0b3JpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jb25uZWN0b3JpbmZvKSBl
cnJvciB7CisJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lkKQorCXguV2lkdGgg
PSB1aW50MzIoeGMud2lkdGgpCisJeC5IZWlnaHQgPSB1aW50MzIoeGMuaGVpZ2h0KQorCXguUmVx
RXZ0Y2ggPSBpbnQoeGMucmVxX2V2dGNoKQorCXguUmVxUnJlZiA9IGludCh4Yy5yZXFfcnJlZikK
Kwl4LkV2dEV2dGNoID0gaW50KHhjLmV2dF9ldnRjaCkKKwl4LkV2dFJyZWYgPSBpbnQoeGMuZXZ0
X3JyZWYpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKlZkaXNwbGluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3ZkaXNwbGluZm8pIGVycm9yIHsKKwl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhj
LmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKKwl4LkZyb250
ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVuZCkKKwl4LkZyb250ZW5kSWQgPSB1aW50MzIoeGMu
ZnJvbnRlbmRfaWQpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlkKQorCXguU3RhdGUgPSBpbnQo
eGMuc3RhdGUpCisJeC5CZUFsbG9jID0gYm9vbCh4Yy5iZV9hbGxvYykKKworCXJldHVybiBuaWwK
K30KKworZnVuYyAoeCAqU3RyZWFtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfc3RyZWFtaW5mbykg
ZXJyb3IgeworCXguUmVxRXZ0Y2ggPSBpbnQoeGMucmVxX2V2dGNoKQorCXguUmVxUnJlZiA9IGlu
dCh4Yy5yZXFfcnJlZikKKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqUGNtaW5mbykgZnJv
bUMoeGMgKkMubGlieGxfcGNtaW5mbykgZXJyb3IgeworCisJcmV0dXJuIG5pbAorfQorCitmdW5j
ICh4ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8pIGVycm9yIHsKKwl4LkJh
Y2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMu
YmFja2VuZF9pZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVuZCkKKwl4LkZy
b250ZW5kSWQgPSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5EZXZpZCA9IERldmlkKHhjLmRl
dmlkKQorCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMg
KHggKlZrYmluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZrYmluZm8pIGVycm9yIHsKKwl4LkJhY2tl
bmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCisJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFj
a2VuZF9pZCkKKwl4LkZyb250ZW5kID0gQy5Hb1N0cmluZyh4Yy5mcm9udGVuZCkKKwl4LkZyb250
ZW5kSWQgPSB1aW50MzIoeGMuZnJvbnRlbmRfaWQpCisJeC5EZXZpZCA9IERldmlkKHhjLmRldmlk
KQorCXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCisJeC5FdnRjaCA9IGludCh4Yy5ldnRjaCkKKwl4
LlJyZWYgPSBpbnQoeGMucnJlZikKKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqTnVtYWlu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX251bWFpbmZvKSBlcnJvciB7CisJeC5TaXplID0gdWludDY0
KHhjLnNpemUpCisJeC5GcmVlID0gdWludDY0KHhjLmZyZWUpCisKKwlyZXR1cm4gbmlsCit9CisK
K2Z1bmMgKHggKkNwdXRvcG9sb2d5KSBmcm9tQyh4YyAqQy5saWJ4bF9jcHV0b3BvbG9neSkgZXJy
b3IgeworCXguQ29yZSA9IHVpbnQzMih4Yy5jb3JlKQorCXguU29ja2V0ID0gdWludDMyKHhjLnNv
Y2tldCkKKwl4Lk5vZGUgPSB1aW50MzIoeGMubm9kZSkKKworCXJldHVybiBuaWwKK30KKworZnVu
YyAoeCAqUGNpdG9wb2xvZ3kpIGZyb21DKHhjICpDLmxpYnhsX3BjaXRvcG9sb2d5KSBlcnJvciB7
CisJeC5TZWcgPSB1aW50MTYoeGMuc2VnKQorCXguQnVzID0gYnl0ZSh4Yy5idXMpCisJeC5EZXZm
biA9IGJ5dGUoeGMuZGV2Zm4pCisJeC5Ob2RlID0gdWludDMyKHhjLm5vZGUpCisKKwlyZXR1cm4g
bmlsCit9CisKK2Z1bmMgKHggKlNjaGVkQ3JlZGl0UGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9z
Y2hlZF9jcmVkaXRfcGFyYW1zKSBlcnJvciB7CisJeC5Uc2xpY2VNcyA9IGludCh4Yy50c2xpY2Vf
bXMpCisJeC5SYXRlbGltaXRVcyA9IGludCh4Yy5yYXRlbGltaXRfdXMpCisJeC5WY3B1TWlnckRl
bGF5VXMgPSBpbnQoeGMudmNwdV9taWdyX2RlbGF5X3VzKQorCisJcmV0dXJuIG5pbAorfQorCitm
dW5jICh4ICpTY2hlZENyZWRpdDJQYXJhbXMpIGZyb21DKHhjICpDLmxpYnhsX3NjaGVkX2NyZWRp
dDJfcGFyYW1zKSBlcnJvciB7CisJeC5SYXRlbGltaXRVcyA9IGludCh4Yy5yYXRlbGltaXRfdXMp
CisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkRvbWFpblJlbXVzSW5mbykgZnJvbUMoeGMg
KkMubGlieGxfZG9tYWluX3JlbXVzX2luZm8pIGVycm9yIHsKKwl4LkludGVydmFsID0gaW50KHhj
LmludGVydmFsKQorCWlmIGVyciA6PSB4LkFsbG93VW5zYWZlLmZyb21DKCZ4Yy5hbGxvd191bnNh
ZmUpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5CbGFja2hv
bGUuZnJvbUMoJnhjLmJsYWNraG9sZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQor
CWlmIGVyciA6PSB4LkNvbXByZXNzaW9uLmZyb21DKCZ4Yy5jb21wcmVzc2lvbik7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4Lk5ldGJ1Zi5mcm9tQygmeGMubmV0
YnVmKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5OZXRidWZzY3JpcHQgPSBD
LkdvU3RyaW5nKHhjLm5ldGJ1ZnNjcmlwdCkKKwlpZiBlcnIgOj0geC5EaXNrYnVmLmZyb21DKCZ4
Yy5kaXNrYnVmKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHgu
Q29sby5mcm9tQygmeGMuY29sbyk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlm
IGVyciA6PSB4LlVzZXJzcGFjZUNvbG9Qcm94eS5mcm9tQygmeGMudXNlcnNwYWNlX2NvbG9fcHJv
eHkpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKworCXJldHVybiBuaWwKK30KKwor
ZnVuYyAoeCAqRXZlbnQpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CisJaWYgZXJy
IDo9IHguTGluay5mcm9tQygmeGMubGluayk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJ
fQorCXguRG9taWQgPSBEb21pZCh4Yy5kb21pZCkKKwlpZiBlcnIgOj0geC5Eb211dWlkLmZyb21D
KCZ4Yy5kb211dWlkKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5Gb3JVc2Vy
ID0gdWludDY0KHhjLmZvcl91c2VyKQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpQc3JD
YXRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfY2F0X2luZm8pIGVycm9yIHsKKwl4LklkID0g
dWludDMyKHhjLmlkKQorCXguQ29zTWF4ID0gdWludDMyKHhjLmNvc19tYXgpCisJeC5DYm1MZW4g
PSB1aW50MzIoeGMuY2JtX2xlbikKKwl4LkNkcEVuYWJsZWQgPSBib29sKHhjLmNkcF9lbmFibGVk
KQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpQc3JId0luZm8pIGZyb21DKHhjICpDLmxp
YnhsX3Bzcl9od19pbmZvKSBlcnJvciB7CisJeC5JZCA9IHVpbnQzMih4Yy5pZCkKKworCXJldHVy
biBuaWwKK30KZGlmZiAtLWdpdCBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC94ZW5saWdodC5nbyBi
L3Rvb2xzL2dvbGFuZy94ZW5saWdodC94ZW5saWdodC5nbwppbmRleCBmYjFjNmQ5ZTUxLi5mMzJl
YjExMzg0IDEwMDY0NAotLS0gYS90b29scy9nb2xhbmcveGVubGlnaHQveGVubGlnaHQuZ28KKysr
IGIvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L3hlbmxpZ2h0LmdvCkBAIC00MDUsNDcgKzQwNSw2IEBA
IGZ1bmMgKGJtICpCaXRtYXApIHRvQygpIChDLmxpYnhsX2JpdG1hcCwgZXJyb3IpIHsKIAlyZXR1
cm4gY2JtLCBuaWwKIH0KIAotZnVuYyAoY3BoeXMgKkMubGlieGxfcGh5c2luZm8pIHRvR28oKSAo
cGh5c2luZm8gKlBoeXNpbmZvKSB7Ci0KLQlwaHlzaW5mbyA9ICZQaHlzaW5mb3t9Ci0JcGh5c2lu
Zm8uVGhyZWFkc1BlckNvcmUgPSB1aW50MzIoY3BoeXMudGhyZWFkc19wZXJfY29yZSkKLQlwaHlz
aW5mby5Db3Jlc1BlclNvY2tldCA9IHVpbnQzMihjcGh5cy5jb3Jlc19wZXJfc29ja2V0KQotCXBo
eXNpbmZvLk1heENwdUlkID0gdWludDMyKGNwaHlzLm1heF9jcHVfaWQpCi0JcGh5c2luZm8uTnJD
cHVzID0gdWludDMyKGNwaHlzLm5yX2NwdXMpCi0JcGh5c2luZm8uQ3B1S2h6ID0gdWludDMyKGNw
aHlzLmNwdV9raHopCi0JcGh5c2luZm8uVG90YWxQYWdlcyA9IHVpbnQ2NChjcGh5cy50b3RhbF9w
YWdlcykKLQlwaHlzaW5mby5GcmVlUGFnZXMgPSB1aW50NjQoY3BoeXMuZnJlZV9wYWdlcykKLQlw
aHlzaW5mby5TY3J1YlBhZ2VzID0gdWludDY0KGNwaHlzLnNjcnViX3BhZ2VzKQotCXBoeXNpbmZv
LlNjcnViUGFnZXMgPSB1aW50NjQoY3BoeXMuc2NydWJfcGFnZXMpCi0JcGh5c2luZm8uU2hhcmlu
Z0ZyZWVkUGFnZXMgPSB1aW50NjQoY3BoeXMuc2hhcmluZ19mcmVlZF9wYWdlcykKLQlwaHlzaW5m
by5TaGFyaW5nVXNlZEZyYW1lcyA9IHVpbnQ2NChjcGh5cy5zaGFyaW5nX3VzZWRfZnJhbWVzKQot
CXBoeXNpbmZvLk5yTm9kZXMgPSB1aW50MzIoY3BoeXMubnJfbm9kZXMpCi0JcGh5c2luZm8uSHdD
YXAuZnJvbUMoJmNwaHlzLmh3X2NhcCkKLQlwaHlzaW5mby5DYXBIdm0gPSBib29sKGNwaHlzLmNh
cF9odm0pCi0JcGh5c2luZm8uQ2FwSHZtRGlyZWN0aW8gPSBib29sKGNwaHlzLmNhcF9odm1fZGly
ZWN0aW8pCi0KLQlyZXR1cm4KLX0KLQotZnVuYyAoY2luZm8gKkMubGlieGxfdmVyc2lvbl9pbmZv
KSB0b0dvKCkgKGluZm8gKlZlcnNpb25JbmZvKSB7Ci0JaW5mbyA9ICZWZXJzaW9uSW5mb3t9Ci0J
aW5mby5YZW5WZXJzaW9uTWFqb3IgPSBpbnQoY2luZm8ueGVuX3ZlcnNpb25fbWFqb3IpCi0JaW5m
by5YZW5WZXJzaW9uTWlub3IgPSBpbnQoY2luZm8ueGVuX3ZlcnNpb25fbWlub3IpCi0JaW5mby5Y
ZW5WZXJzaW9uRXh0cmEgPSBDLkdvU3RyaW5nKGNpbmZvLnhlbl92ZXJzaW9uX2V4dHJhKQotCWlu
Zm8uQ29tcGlsZXIgPSBDLkdvU3RyaW5nKGNpbmZvLmNvbXBpbGVyKQotCWluZm8uQ29tcGlsZUJ5
ID0gQy5Hb1N0cmluZyhjaW5mby5jb21waWxlX2J5KQotCWluZm8uQ29tcGlsZURvbWFpbiA9IEMu
R29TdHJpbmcoY2luZm8uY29tcGlsZV9kb21haW4pCi0JaW5mby5Db21waWxlRGF0ZSA9IEMuR29T
dHJpbmcoY2luZm8uY29tcGlsZV9kYXRlKQotCWluZm8uQ2FwYWJpbGl0aWVzID0gQy5Hb1N0cmlu
ZyhjaW5mby5jYXBhYmlsaXRpZXMpCi0JaW5mby5DaGFuZ2VzZXQgPSBDLkdvU3RyaW5nKGNpbmZv
LmNoYW5nZXNldCkKLQlpbmZvLlZpcnRTdGFydCA9IHVpbnQ2NChjaW5mby52aXJ0X3N0YXJ0KQot
CWluZm8uUGFnZXNpemUgPSBpbnQoY2luZm8ucGFnZXNpemUpCi0JaW5mby5Db21tYW5kbGluZSA9
IEMuR29TdHJpbmcoY2luZm8uY29tbWFuZGxpbmUpCi0JaW5mby5CdWlsZElkID0gQy5Hb1N0cmlu
ZyhjaW5mby5idWlsZF9pZCkKLQotCXJldHVybgotfQotCiBmdW5jIChzciBTaHV0ZG93blJlYXNv
bikgU3RyaW5nKCkgKHN0ciBzdHJpbmcpIHsKIAljc3RyIDo9IEMubGlieGxfc2h1dGRvd25fcmVh
c29uX3RvX3N0cmluZyhDLmxpYnhsX3NodXRkb3duX3JlYXNvbihzcikpCiAJc3RyID0gQy5Hb1N0
cmluZyhjc3RyKQpAQCAtNDYwLDM0ICs0MTksNiBAQCBmdW5jIChkdCBEb21haW5UeXBlKSBTdHJp
bmcoKSAoc3RyIHN0cmluZykgewogCXJldHVybgogfQogCi1mdW5jIChjZGkgKkMubGlieGxfZG9t
aW5mbykgdG9HbygpIChkaSAqRG9taW5mbykgewotCi0JZGkgPSAmRG9taW5mb3t9Ci0JZGkuVXVp
ZC5mcm9tQygmY2RpLnV1aWQpCi0JZGkuRG9taWQgPSBEb21pZChjZGkuZG9taWQpCi0JZGkuU3Np
ZHJlZiA9IHVpbnQzMihjZGkuc3NpZHJlZikKLQlkaS5Tc2lkTGFiZWwgPSBDLkdvU3RyaW5nKGNk
aS5zc2lkX2xhYmVsKQotCWRpLlJ1bm5pbmcgPSBib29sKGNkaS5ydW5uaW5nKQotCWRpLkJsb2Nr
ZWQgPSBib29sKGNkaS5ibG9ja2VkKQotCWRpLlBhdXNlZCA9IGJvb2woY2RpLnBhdXNlZCkKLQlk
aS5TaHV0ZG93biA9IGJvb2woY2RpLnNodXRkb3duKQotCWRpLkR5aW5nID0gYm9vbChjZGkuZHlp
bmcpCi0JZGkuTmV2ZXJTdG9wID0gYm9vbChjZGkubmV2ZXJfc3RvcCkKLQlkaS5TaHV0ZG93blJl
YXNvbiA9IFNodXRkb3duUmVhc29uKGNkaS5zaHV0ZG93bl9yZWFzb24pCi0JZGkuT3V0c3RhbmRp
bmdNZW1rYiA9IHVpbnQ2NChjZGkub3V0c3RhbmRpbmdfbWVta2IpCi0JZGkuQ3VycmVudE1lbWti
ID0gdWludDY0KGNkaS5jdXJyZW50X21lbWtiKQotCWRpLlNoYXJlZE1lbWtiID0gdWludDY0KGNk
aS5zaGFyZWRfbWVta2IpCi0JZGkuUGFnZWRNZW1rYiA9IHVpbnQ2NChjZGkucGFnZWRfbWVta2Ip
Ci0JZGkuTWF4TWVta2IgPSB1aW50NjQoY2RpLm1heF9tZW1rYikKLQlkaS5DcHVUaW1lID0gdWlu
dDY0KGNkaS5jcHVfdGltZSkKLQlkaS5WY3B1TWF4SWQgPSB1aW50MzIoY2RpLnZjcHVfbWF4X2lk
KQotCWRpLlZjcHVPbmxpbmUgPSB1aW50MzIoY2RpLnZjcHVfb25saW5lKQotCWRpLkNwdXBvb2wg
PSB1aW50MzIoY2RpLmNwdXBvb2wpCi0JZGkuRG9tYWluVHlwZSA9IERvbWFpblR5cGUoY2RpLmRv
bWFpbl90eXBlKQotCi0JcmV0dXJuCi19Ci0KIC8vIGNvbnN0IGNoYXIgKmxpYnhsX3NjaGVkdWxl
cl90b19zdHJpbmcobGlieGxfc2NoZWR1bGVyIHApOwogZnVuYyAocyBTY2hlZHVsZXIpIFN0cmlu
ZygpIHN0cmluZyB7CiAJY3MgOj0gQy5saWJ4bF9zY2hlZHVsZXJfdG9fc3RyaW5nKEMubGlieGxf
c2NoZWR1bGVyKHMpKQpAQCAtNTE5LDE2ICs0NTAsNiBAQCBmdW5jIFNjaGVkdWxlckZyb21TdHJp
bmcobmFtZSBzdHJpbmcpIChzIFNjaGVkdWxlciwgZXJyIGVycm9yKSB7CiAJcmV0dXJuCiB9CiAK
LWZ1bmMgKGNjaSBDLmxpYnhsX2NwdXBvb2xpbmZvKSB0b0dvKCkgKGdjaSBDcHVwb29saW5mbykg
ewotCWdjaS5Qb29saWQgPSB1aW50MzIoY2NpLnBvb2xpZCkKLQlnY2kuUG9vbE5hbWUgPSBDLkdv
U3RyaW5nKGNjaS5wb29sX25hbWUpCi0JZ2NpLlNjaGVkID0gU2NoZWR1bGVyKGNjaS5zY2hlZCkK
LQlnY2kuTkRvbSA9IHVpbnQzMihjY2kubl9kb20pCi0JZ2NpLkNwdW1hcC5mcm9tQygmY2NpLmNw
dW1hcCkKLQotCXJldHVybgotfQotCiAvLyBsaWJ4bF9jcHVwb29saW5mbyAqIGxpYnhsX2xpc3Rf
Y3B1cG9vbChsaWJ4bF9jdHgqLCBpbnQgKm5iX3Bvb2xfb3V0KTsKIC8vIHZvaWQgbGlieGxfY3B1
cG9vbGluZm9fbGlzdF9mcmVlKGxpYnhsX2NwdXBvb2xpbmZvICpsaXN0LCBpbnQgbmJfcG9vbCk7
CiBmdW5jIChDdHggKkNvbnRleHQpIExpc3RDcHVwb29sKCkgKGxpc3QgW11DcHVwb29saW5mbykg
ewpAQCAtNTUwLDcgKzQ3MSw4IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgTGlzdENwdXBvb2woKSAo
bGlzdCBbXUNwdXBvb2xpbmZvKSB7CiAJLy8gTWFnaWMKIAljcHVwb29sTGlzdFNsaWNlIDo9ICgq
WzEgPDwgMzBdQy5saWJ4bF9jcHVwb29saW5mbykodW5zYWZlLlBvaW50ZXIoY19jcHVwb29sX2xp
c3QpKVs6bmJQb29sOm5iUG9vbF0KIAlmb3IgaSA6PSByYW5nZSBjcHVwb29sTGlzdFNsaWNlIHsK
LQkJaW5mbyA6PSBjcHVwb29sTGlzdFNsaWNlW2ldLnRvR28oKQorCQl2YXIgaW5mbyBDcHVwb29s
aW5mbworCQlfID0gaW5mby5mcm9tQygmY3B1cG9vbExpc3RTbGljZVtpXSkKIAkJbGlzdCA9IGFw
cGVuZChsaXN0LCBpbmZvKQogCX0KIApAQCAtNTczLDcgKzQ5NSw3IEBAIGZ1bmMgKEN0eCAqQ29u
dGV4dCkgQ3B1cG9vbEluZm8oUG9vbGlkIHVpbnQzMikgKHBvb2wgQ3B1cG9vbGluZm8pIHsKIAl9
CiAJZGVmZXIgQy5saWJ4bF9jcHVwb29saW5mb19kaXNwb3NlKCZjX2NwdXBvb2wpCiAKLQlwb29s
ID0gY19jcHVwb29sLnRvR28oKQorCV8gPSBwb29sLmZyb21DKCZjX2NwdXBvb2wpCiAKIAlyZXR1
cm4KIH0KQEAgLTEwNjQsNyArOTg2LDcgQEAgZnVuYyAoQ3R4ICpDb250ZXh0KSBHZXRQaHlzaW5m
bygpIChwaHlzaW5mbyAqUGh5c2luZm8sIGVyciBlcnJvcikgewogCQllcnIgPSBFcnJvcihyZXQp
CiAJCXJldHVybgogCX0KLQlwaHlzaW5mbyA9IGNwaHlzLnRvR28oKQorCWVyciA9IHBoeXNpbmZv
LmZyb21DKCZjcGh5cykKIAogCXJldHVybgogfQpAQCAtMTA4MCw3ICsxMDAyLDcgQEAgZnVuYyAo
Q3R4ICpDb250ZXh0KSBHZXRWZXJzaW9uSW5mbygpIChpbmZvICpWZXJzaW9uSW5mbywgZXJyIGVy
cm9yKSB7CiAKIAljaW5mbyA9IEMubGlieGxfZ2V0X3ZlcnNpb25faW5mbyhDdHguY3R4KQogCi0J
aW5mbyA9IGNpbmZvLnRvR28oKQorCWVyciA9IGluZm8uZnJvbUMoY2luZm8pCiAKIAlyZXR1cm4K
IH0KQEAgLTExMDIsNyArMTAyNCw3IEBAIGZ1bmMgKEN0eCAqQ29udGV4dCkgRG9tYWluSW5mbyhJ
ZCBEb21pZCkgKGRpICpEb21pbmZvLCBlcnIgZXJyb3IpIHsKIAkJcmV0dXJuCiAJfQogCi0JZGkg
PSBjZGkudG9HbygpCisJZXJyID0gZGkuZnJvbUMoJmNkaSkKIAogCXJldHVybgogfQpAQCAtMTE4
NCwyNiArMTEwNiwxNCBAQCBmdW5jIChDdHggKkNvbnRleHQpIExpc3REb21haW4oKSAoZ2xpc3Qg
W11Eb21pbmZvKSB7CiAKIAlnc2xpY2UgOj0gKCpbMSA8PCAzMF1DLmxpYnhsX2RvbWluZm8pKHVu
c2FmZS5Qb2ludGVyKGNsaXN0KSlbOm5iRG9tYWluOm5iRG9tYWluXQogCWZvciBpIDo9IHJhbmdl
IGdzbGljZSB7Ci0JCWluZm8gOj0gZ3NsaWNlW2ldLnRvR28oKQotCQlnbGlzdCA9IGFwcGVuZChn
bGlzdCwgKmluZm8pCisJCXZhciBpbmZvIERvbWluZm8KKwkJXyA9IGluZm8uZnJvbUMoJmdzbGlj
ZVtpXSkKKwkJZ2xpc3QgPSBhcHBlbmQoZ2xpc3QsIGluZm8pCiAJfQogCiAJcmV0dXJuCiB9CiAK
LWZ1bmMgKGN2Y2kgQy5saWJ4bF92Y3B1aW5mbykgdG9HbygpIChndmNpIFZjcHVpbmZvKSB7Ci0J
Z3ZjaS5WY3B1aWQgPSB1aW50MzIoY3ZjaS52Y3B1aWQpCi0JZ3ZjaS5DcHUgPSB1aW50MzIoY3Zj
aS5jcHUpCi0JZ3ZjaS5PbmxpbmUgPSBib29sKGN2Y2kub25saW5lKQotCWd2Y2kuQmxvY2tlZCA9
IGJvb2woY3ZjaS5ibG9ja2VkKQotCWd2Y2kuUnVubmluZyA9IGJvb2woY3ZjaS5ydW5uaW5nKQot
CWd2Y2kuVmNwdVRpbWUgPSB1aW50NjQoY3ZjaS52Y3B1X3RpbWUpCi0JZ3ZjaS5DcHVtYXAuZnJv
bUMoJmN2Y2kuY3B1bWFwKQotCWd2Y2kuQ3B1bWFwU29mdC5mcm9tQygmY3ZjaS5jcHVtYXBfc29m
dCkKLQotCXJldHVybgotfQotCiAvL2xpYnhsX3ZjcHVpbmZvICpsaWJ4bF9saXN0X3ZjcHUobGli
eGxfY3R4ICpjdHgsIHVpbnQzMl90IGRvbWlkLAogLy8JCQkJaW50ICpuYl92Y3B1LCBpbnQgKm5y
X2NwdXNfb3V0KTsKIC8vdm9pZCBsaWJ4bF92Y3B1aW5mb19saXN0X2ZyZWUobGlieGxfdmNwdWlu
Zm8gKiwgaW50IG5yX3ZjcHVzKTsKQEAgLTEyMjUsNyArMTEzNSw4IEBAIGZ1bmMgKEN0eCAqQ29u
dGV4dCkgTGlzdFZjcHUoaWQgRG9taWQpIChnbGlzdCBbXVZjcHVpbmZvKSB7CiAKIAlnc2xpY2Ug
Oj0gKCpbMSA8PCAzMF1DLmxpYnhsX3ZjcHVpbmZvKSh1bnNhZmUuUG9pbnRlcihjbGlzdCkpWzpu
YlZjcHU6bmJWY3B1XQogCWZvciBpIDo9IHJhbmdlIGdzbGljZSB7Ci0JCWluZm8gOj0gZ3NsaWNl
W2ldLnRvR28oKQorCQl2YXIgaW5mbyBWY3B1aW5mbworCQlfID0gaW5mby5mcm9tQygmZ3NsaWNl
W2ldKQogCQlnbGlzdCA9IGFwcGVuZChnbGlzdCwgaW5mbykKIAl9CiAKLS0gCjIuMTkuMQoKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBt
YWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMu
eGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

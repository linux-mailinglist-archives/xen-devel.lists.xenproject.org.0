Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 33DA9A65D6
	for <lists+xen-devel@lfdr.de>; Tue,  3 Sep 2019 11:41:51 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i55I3-00060V-CI; Tue, 03 Sep 2019 09:39:55 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=CRa/=W6=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1i55I1-00060B-4V
 for xen-devel@lists.xenproject.org; Tue, 03 Sep 2019 09:39:53 +0000
X-Inumbo-ID: c74863f4-ce2e-11e9-ab8c-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id c74863f4-ce2e-11e9-ab8c-12813bfff9fa;
 Tue, 03 Sep 2019 09:39:52 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 9BFB3ABED;
 Tue,  3 Sep 2019 09:39:51 +0000 (UTC)
From: Jan Beulich <jbeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
References: <347e51f2-e80c-992c-6d0b-3b2bfdb75cce@suse.com>
Message-ID: <fa007bb5-1644-6116-fe96-00b00f7241a4@suse.com>
Date: Tue, 3 Sep 2019 11:39:57 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <347e51f2-e80c-992c-6d0b-3b2bfdb75cce@suse.com>
Content-Language: en-US
Subject: [Xen-devel] [PATCH v3 5/8] x86emul: support MOVDIR{I,64B} insns
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wl@xen.org>,
 Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

Tm90ZSB0aGF0IFNETSByZXZpc2lvbiAwNzAgZG9lc24ndCBzcGVjaWZ5IGV4Y2VwdGlvbiBiZWhh
dmlvciBmb3IKTW9kUk0ubW9kICE9IDBiMTE7IGFzc3VtaW5nICNVRCBoZXJlLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KdjM6IFVwZGF0ZSBkZXNj
cmlwdGlvbi4KCi0tLSBhL3Rvb2xzL3Rlc3RzL3g4Nl9lbXVsYXRvci90ZXN0X3g4Nl9lbXVsYXRv
ci5jCisrKyBiL3Rvb2xzL3Rlc3RzL3g4Nl9lbXVsYXRvci90ZXN0X3g4Nl9lbXVsYXRvci5jCkBA
IC0yMTk2LDYgKzIxOTYsMzYgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2KQogICAg
ICAgICBnb3RvIGZhaWw7CiAgICAgcHJpbnRmKCJva2F5XG4iKTsKIAorICAgIHByaW50ZigiJS00
MHMiLCAiVGVzdGluZyBtb3ZkaXJpICVlZHgsKCVlY3gpLi4uIik7CisgICAgaW5zdHJbMF0gPSAw
eDBmOyBpbnN0clsxXSA9IDB4Mzg7IGluc3RyWzJdID0gMHhmOTsgaW5zdHJbM10gPSAweDExOwor
ICAgIHJlZ3MuZWlwID0gKHVuc2lnbmVkIGxvbmcpJmluc3RyWzBdOworICAgIHJlZ3MuZWN4ID0g
KHVuc2lnbmVkIGxvbmcpbWVtc2V0KHJlcywgLTEsIDE2KTsKKyAgICByZWdzLmVkeCA9IDB4NDQz
MzIyMTE7CisgICAgcmMgPSB4ODZfZW11bGF0ZSgmY3R4dCwgJmVtdWxvcHMpOworICAgIGlmICgg
KHJjICE9IFg4NkVNVUxfT0tBWSkgfHwKKyAgICAgICAgIChyZWdzLmVpcCAhPSAodW5zaWduZWQg
bG9uZykmaW5zdHJbNF0pIHx8CisgICAgICAgICByZXNbMF0gIT0gMHg0NDMzMjIxMSB8fCB+cmVz
WzFdICkKKyAgICAgICAgZ290byBmYWlsOworICAgIHByaW50Zigib2theVxuIik7CisKKyAgICBw
cmludGYoIiUtNDBzIiwgIlRlc3RpbmcgbW92ZGlyNjRiIDE0NCglZWR4KSwlZWN4Li4uIik7Cisg
ICAgaW5zdHJbMF0gPSAweDY2OyBpbnN0clsxXSA9IDB4MGY7IGluc3RyWzJdID0gMHgzODsgaW5z
dHJbM10gPSAweGY4OworICAgIGluc3RyWzRdID0gMHg4YTsgaW5zdHJbNV0gPSAweDkwOyBpbnN0
cls4XSA9IGluc3RyWzddID0gaW5zdHJbNl0gPSAwOworICAgIHJlZ3MuZWlwID0gKHVuc2lnbmVk
IGxvbmcpJmluc3RyWzBdOworICAgIGZvciAoIGkgPSAwOyBpIDwgNjQ7ICsraSApCisgICAgICAg
IHJlc1tpXSA9IGkgLSAyMDsKKyAgICByZWdzLmVkeCA9ICh1bnNpZ25lZCBsb25nKXJlczsKKyAg
ICByZWdzLmVjeCA9ICh1bnNpZ25lZCBsb25nKShyZXMgKyAxNik7CisgICAgcmMgPSB4ODZfZW11
bGF0ZSgmY3R4dCwgJmVtdWxvcHMpOworICAgIGlmICggKHJjICE9IFg4NkVNVUxfT0tBWSkgfHwK
KyAgICAgICAgIChyZWdzLmVpcCAhPSAodW5zaWduZWQgbG9uZykmaW5zdHJbOV0pIHx8CisgICAg
ICAgICByZXNbMTVdICE9IC01IHx8IHJlc1szMl0gIT0gMTIgKQorICAgICAgICBnb3RvIGZhaWw7
CisgICAgZm9yICggaSA9IDE2OyBpIDwgMzI7ICsraSApCisgICAgICAgIGlmICggcmVzW2ldICE9
IGkgKQorICAgICAgICAgICAgZ290byBmYWlsOworICAgIHByaW50Zigib2theVxuIik7CisKICAg
ICBwcmludGYoIiUtNDBzIiwgIlRlc3RpbmcgbW92cSAlbW0zLCglZWN4KS4uLiIpOwogICAgIGlm
ICggc3RhY2tfZXhlYyAmJiBjcHVfaGFzX21teCApCiAgICAgewotLS0gYS90b29scy90ZXN0cy94
ODZfZW11bGF0b3IveDg2LWVtdWxhdGUuYworKysgYi90b29scy90ZXN0cy94ODZfZW11bGF0b3Iv
eDg2LWVtdWxhdGUuYwpAQCAtNzYsNiArNzYsOCBAQCBib29sIGVtdWxfdGVzdF9pbml0KHZvaWQp
CiAgICAgY3AuZmVhdC5hZHggPSB0cnVlOwogICAgIGNwLmZlYXQuYXZ4NTEycGYgPSBjcC5mZWF0
LmF2eDUxMmY7CiAgICAgY3AuZmVhdC5yZHBpZCA9IHRydWU7CisgICAgY3AuZmVhdC5tb3ZkaXJp
ID0gdHJ1ZTsKKyAgICBjcC5mZWF0Lm1vdmRpcjY0YiA9IHRydWU7CiAgICAgY3AuZXh0ZC5jbHpl
cm8gPSB0cnVlOwogCiAgICAgaWYgKCBjcHVfaGFzX3hzYXZlICkKQEAgLTEzNywxNSArMTM5LDE1
IEBAIGludCBlbXVsX3Rlc3RfY3B1aWQoCiAgICAgICAgIHJlcy0+YyB8PSAxVSA8PCAyMjsKIAog
ICAgIC8qCi0gICAgICogVGhlIGVtdWxhdG9yIGRvZXNuJ3QgaXRzZWxmIHVzZSBBRENYL0FET1gv
UkRQSUQgbm9yIHRoZSBTL0cgcHJlZmV0Y2gKLSAgICAgKiBpbnNucywgc28gd2UgY2FuIGFsd2F5
cyBydW4gdGhlIHJlc3BlY3RpdmUgdGVzdHMuCisgICAgICogVGhlIGVtdWxhdG9yIGRvZXNuJ3Qg
aXRzZWxmIHVzZSBBRENYL0FET1gvUkRQSUQvTU9WRElSKiBub3IgdGhlIFMvRworICAgICAqIHBy
ZWZldGNoIGluc25zLCBzbyB3ZSBjYW4gYWx3YXlzIHJ1biB0aGUgcmVzcGVjdGl2ZSB0ZXN0cy4K
ICAgICAgKi8KICAgICBpZiAoIGxlYWYgPT0gNyAmJiBzdWJsZWFmID09IDAgKQogICAgIHsKICAg
ICAgICAgcmVzLT5iIHw9ICgxVSA8PCAxMCkgfCAoMVUgPDwgMTkpOwogICAgICAgICBpZiAoIHJl
cy0+YiAmICgxVSA8PCAxNikgKQogICAgICAgICAgICAgcmVzLT5iIHw9IDFVIDw8IDI2OwotICAg
ICAgICByZXMtPmMgfD0gMVUgPDwgMjI7CisgICAgICAgIHJlcy0+YyB8PSAoMVUgPDwgMjIpIHwg
KDFVIDw8IDI3KSB8ICgxVSA8PCAyOCk7CiAgICAgfQogCiAgICAgLyoKLS0tIGEveGVuL2FyY2gv
eDg2L3g4Nl9lbXVsYXRlL3g4Nl9lbXVsYXRlLmMKKysrIGIveGVuL2FyY2gveDg2L3g4Nl9lbXVs
YXRlL3g4Nl9lbXVsYXRlLmMKQEAgLTU0OCw2ICs1NDgsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0
IGV4dDBmMzhfdGFibGUgewogICAgIFsweGYxXSA9IHsgLnRvX21lbSA9IDEsIC50d29fb3AgPSAx
IH0sCiAgICAgWzB4ZjIgLi4uIDB4ZjNdID0ge30sCiAgICAgWzB4ZjUgLi4uIDB4ZjddID0ge30s
CisgICAgWzB4ZjhdID0geyAuc2ltZF9zaXplID0gc2ltZF9vdGhlciB9LAorICAgIFsweGY5XSA9
IHsgLnRvX21lbSA9IDEgfSwKIH07CiAKIC8qIFNoaWZ0IHZhbHVlcyBiZXR3ZWVuIHNyYyBhbmQg
ZHN0IHNpemVzIG9mIHBtb3Z7cyx6fXh7Yix3LGR9e3csZCxxfS4gKi8KQEAgLTE5MDIsNiArMTkw
NCw4IEBAIGluX3Byb3Rtb2RlKAogI2RlZmluZSB2Y3B1X2hhc19hdng1MTJfYml0YWxnKCkgKGN0
eHQtPmNwdWlkLT5mZWF0LmF2eDUxMl9iaXRhbGcpCiAjZGVmaW5lIHZjcHVfaGFzX2F2eDUxMl92
cG9wY250ZHEoKSAoY3R4dC0+Y3B1aWQtPmZlYXQuYXZ4NTEyX3Zwb3BjbnRkcSkKICNkZWZpbmUg
dmNwdV9oYXNfcmRwaWQoKSAgICAgICAoY3R4dC0+Y3B1aWQtPmZlYXQucmRwaWQpCisjZGVmaW5l
IHZjcHVfaGFzX21vdmRpcmkoKSAgICAgKGN0eHQtPmNwdWlkLT5mZWF0Lm1vdmRpcmkpCisjZGVm
aW5lIHZjcHVfaGFzX21vdmRpcjY0YigpICAgKGN0eHQtPmNwdWlkLT5mZWF0Lm1vdmRpcjY0YikK
ICNkZWZpbmUgdmNwdV9oYXNfYXZ4NTEyXzR2bm5pdygpIChjdHh0LT5jcHVpZC0+ZmVhdC5hdng1
MTJfNHZubml3KQogI2RlZmluZSB2Y3B1X2hhc19hdng1MTJfNGZtYXBzKCkgKGN0eHQtPmNwdWlk
LT5mZWF0LmF2eDUxMl80Zm1hcHMpCiAKQEAgLTI2OTMsMTAgKzI2OTcsMTIgQEAgeDg2X2RlY29k
ZV8wZjM4KAogICAgIHsKICAgICBjYXNlIDB4MDAgLi4uIDB4ZWY6CiAgICAgY2FzZSAweGYyIC4u
LiAweGY1OgotICAgIGNhc2UgMHhmNyAuLi4gMHhmZjoKKyAgICBjYXNlIDB4ZjcgLi4uIDB4Zjg6
CisgICAgY2FzZSAweGZhIC4uLiAweGZmOgogICAgICAgICBvcF9ieXRlcyA9IDA7CiAgICAgICAg
IC8qIGZhbGwgdGhyb3VnaCAqLwogICAgIGNhc2UgMHhmNjogLyogYWRjeCAvIGFkb3ggKi8KKyAg
ICBjYXNlIDB4Zjk6IC8qIG1vdmRpcmkgKi8KICAgICAgICAgY3R4dC0+b3Bjb2RlIHw9IE1BU0tf
SU5TUih2ZXgucGZ4LCBYODZFTVVMX09QQ19QRlhfTUFTSyk7CiAgICAgICAgIGJyZWFrOwogCkBA
IC05ODk2LDYgKzk5MDIsMzIgQEAgeDg2X2VtdWxhdGUoCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOiAiMCIgKCh1aW50MzJfdClzcmMudmFsKSwgInJtIiAoX3JlZ3MuZWR4KSApOwogICAg
ICAgICBicmVhazsKIAorICAgIGNhc2UgWDg2RU1VTF9PUENfNjYoMHgwZjM4LCAweGY4KTogLyog
bW92ZGlyNjRiIHIsbTUxMiAqLworICAgICAgICB2Y3B1X211c3RfaGF2ZShtb3ZkaXI2NGIpOwor
ICAgICAgICBnZW5lcmF0ZV9leGNlcHRpb25faWYoZWEudHlwZSAhPSBPUF9NRU0sIEVYQ19VRCk7
CisgICAgICAgIHNyYy52YWwgPSB0cnVuY2F0ZV9lYSgqZHN0LnJlZyk7CisgICAgICAgIGdlbmVy
YXRlX2V4Y2VwdGlvbl9pZighaXNfYWxpZ25lZCh4ODZfc2VnX2VzLCBzcmMudmFsLCA2NCwgY3R4
dCwgb3BzKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVYQ19HUCwgMCk7CisgICAg
ICAgIC8qIElnbm9yZSB0aGUgbm9uLXRlbXBvcmFsIGJlaGF2aW9yIGZvciBub3cuICovCisgICAg
ICAgIGZhaWxfaWYoIW9wcy0+d3JpdGUpOworICAgICAgICBCVUlMRF9CVUdfT04oc2l6ZW9mKCpt
bXZhbHApIDwgNjQpOworICAgICAgICBpZiAoIChyYyA9IG9wcy0+cmVhZChlYS5tZW0uc2VnLCBl
YS5tZW0ub2ZmLCBtbXZhbHAsIDY0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHh0
KSkgIT0gWDg2RU1VTF9PS0FZIHx8CisgICAgICAgICAgICAgKHJjID0gb3BzLT53cml0ZSh4ODZf
c2VnX2VzLCBzcmMudmFsLCBtbXZhbHAsIDY0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY3R4dCkpICE9IFg4NkVNVUxfT0tBWSApCisgICAgICAgICAgICBnb3RvIGRvbmU7CisgICAg
ICAgIHN0YXRlLT5zaW1kX3NpemUgPSBzaW1kX25vbmU7CisgICAgICAgIHNmZW5jZSA9IHRydWU7
CisgICAgICAgIGJyZWFrOworCisgICAgY2FzZSBYODZFTVVMX09QQygweDBmMzgsIDB4ZjkpOiAv
KiBtb3ZkaXJpIG1lbSxyICovCisgICAgICAgIHZjcHVfbXVzdF9oYXZlKG1vdmRpcmkpOworICAg
ICAgICBnZW5lcmF0ZV9leGNlcHRpb25faWYoZHN0LnR5cGUgIT0gT1BfTUVNLCBFWENfVUQpOwor
ICAgICAgICAvKiBJZ25vcmUgdGhlIG5vbi10ZW1wb3JhbCBiZWhhdmlvciBmb3Igbm93LiAqLwor
ICAgICAgICBkc3QudmFsID0gc3JjLnZhbDsKKyAgICAgICAgc2ZlbmNlID0gdHJ1ZTsKKyAgICAg
ICAgYnJlYWs7CisKICAgICBjYXNlIFg4NkVNVUxfT1BDX1ZFWF82NigweDBmM2EsIDB4MDApOiAv
KiB2cGVybXEgJGltbTgseW1tL20yNTYseW1tICovCiAgICAgY2FzZSBYODZFTVVMX09QQ19WRVhf
NjYoMHgwZjNhLCAweDAxKTogLyogdnBlcm1wZCAkaW1tOCx5bW0vbTI1Nix5bW0gKi8KICAgICAg
ICAgZ2VuZXJhdGVfZXhjZXB0aW9uX2lmKCF2ZXgubCB8fCAhdmV4LncsIEVYQ19VRCk7Ci0tLSBh
L3hlbi9pbmNsdWRlL3B1YmxpYy9hcmNoLXg4Ni9jcHVmZWF0dXJlc2V0LmgKKysrIGIveGVuL2lu
Y2x1ZGUvcHVibGljL2FyY2gteDg2L2NwdWZlYXR1cmVzZXQuaApAQCAtMjM3LDYgKzIzNyw4IEBA
IFhFTl9DUFVGRUFUVVJFKEFWWDUxMl9CSVRBTEcsIDYqMzIrMTIpIC8KIFhFTl9DUFVGRUFUVVJF
KEFWWDUxMl9WUE9QQ05URFEsIDYqMzIrMTQpIC8qQSAgUE9QQ05UIGZvciB2ZWN0b3JzIG9mIERX
L1FXICovCiBYRU5fQ1BVRkVBVFVSRShSRFBJRCwgICAgICAgICA2KjMyKzIyKSAvKkEgIFJEUElE
IGluc3RydWN0aW9uICovCiBYRU5fQ1BVRkVBVFVSRShDTERFTU9URSwgICAgICA2KjMyKzI1KSAv
KkEgIENMREVNT1RFIGluc3RydWN0aW9uICovCitYRU5fQ1BVRkVBVFVSRShNT1ZESVJJLCAgICAg
ICA2KjMyKzI3KSAvKkEgIE1PVkRJUkkgaW5zdHJ1Y3Rpb24gKi8KK1hFTl9DUFVGRUFUVVJFKE1P
VkRJUjY0QiwgICAgIDYqMzIrMjgpIC8qQSAgTU9WRElSNjRCIGluc3RydWN0aW9uICovCiAKIC8q
IEFNRC1kZWZpbmVkIENQVSBmZWF0dXJlcywgQ1BVSUQgbGV2ZWwgMHg4MDAwMDAwNy5lZHgsIHdv
cmQgNyAqLwogWEVOX0NQVUZFQVRVUkUoSVRTQywgICAgICAgICAgNyozMisgOCkgLyogICBJbnZh
cmlhbnQgVFNDICovCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9y
ZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 45276B2AA6
	for <lists+xen-devel@lfdr.de>; Sat, 14 Sep 2019 10:56:26 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1i93oF-00082I-HE; Sat, 14 Sep 2019 08:53:35 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=rDpt=XJ=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1i93oD-00080D-LL
 for xen-devel@lists.xenproject.org; Sat, 14 Sep 2019 08:53:33 +0000
X-Inumbo-ID: 0e37e663-d6cd-11e9-95c1-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 0e37e663-d6cd-11e9-95c1-12813bfff9fa;
 Sat, 14 Sep 2019 08:53:01 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 4A747B663;
 Sat, 14 Sep 2019 08:52:59 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Sat, 14 Sep 2019 10:52:17 +0200
Message-Id: <20190914085251.18816-14-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190914085251.18816-1-jgross@suse.com>
References: <20190914085251.18816-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v3 13/47] xen/sched: add is_running indicator to
 struct sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Dario Faggioli <dfaggioli@suse.com>,
 Julien Grall <julien.grall@arm.com>, Meng Xu <mengxu@cis.upenn.edu>,
 Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWRkIGFuIGlzX3J1bm5pbmcgaW5kaWNhdG9yIHRvIHN0cnVjdCBzY2hlZF91bml0IHdoaWNoIHdp
bGwgYmUgc2V0CndoZW5ldmVyIHRoZSB1bml0IGlzIGJlaW5nIHNjaGVkdWxlZC4gU3dpdGNoIHNj
aGVkdWxlciBjb2RlIHRvIHVzZQp1bml0LT5pc19ydW5uaW5nIGluc3RlYWQgb2YgdmNwdS0+aXNf
cnVubmluZyBmb3Igc2NoZWR1bGluZyBkZWNpc2lvbnMuCgpBdCB0aGUgc2FtZSB0aW1lIGludHJv
ZHVjZSBhIHN0YXRlX2VudHJ5X3RpbWUgZmllbGQgaW4gc3RydWN0CnNjaGVkX3VuaXQgYmVpbmcg
dXBkYXRlZCB3aGVuZXZlciB0aGUgaXNfcnVubmluZyBpbmRpY2F0b3IgaXMgY2hhbmdlZC4KVXNl
IHRoYXQgbmV3IGZpZWxkIGluIHRoZSBzY2hlZHVsZXJzIGluc3RlYWQgb2YgdGhlIHNpbWlsYXIg
dmNwdSBmaWVsZC4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNv
bT4KLS0tClJGQyBWMjoKLSBmaXggYXJtIGJ1aWxkLCBkb24ndCBkcm9wIHYtPmlzX3J1bm5pbmcK
VjM6Ci0gYXZvaWQgaG9sZXMgaW4gc3RydWN0dXJlcyAoSmFuIEJldWxpY2gpCi0tLQogeGVuL2Nv
bW1vbi9zY2hlZF9jcmVkaXQuYyAgfCAxMiArKysrKysrLS0tLS0KIHhlbi9jb21tb24vc2NoZWRf
Y3JlZGl0Mi5jIHwgMTggKysrKysrKysrLS0tLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX3J0LmMg
ICAgICB8ICAyICstCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAgICB8IDEzICsrKysrKysrKyst
LS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC5oICAgIHwgIDYgKysrKysrCiA1IGZpbGVzIGNoYW5n
ZWQsIDMzIGluc2VydGlvbnMoKyksIDE4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9j
b21tb24vc2NoZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4IDJi
ZjExYjA2MTYuLmMwZjZlZjgzMWUgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtNzA5LDcgKzcwOSw3IEBAIF9f
Y3NjaGVkX3ZjcHVfaXNfbWlncmF0ZWFibGUoY29uc3Qgc3RydWN0IGNzY2hlZF9wcml2YXRlICpw
cnYsIHN0cnVjdCB2Y3B1ICp2YywKICAgICAgKiBUaGUgY2FsbGVyIGlzIHN1cHBvc2VkIHRvIGhh
dmUgYWxyZWFkeSBjaGVja2VkIHRoYXQgdmMgaXMgYWxzbwogICAgICAqIG5vdCBydW5uaW5nLgog
ICAgICAqLwotICAgIEFTU0VSVCghdmMtPmlzX3J1bm5pbmcpOworICAgIEFTU0VSVCghdmMtPnNj
aGVkX3VuaXQtPmlzX3J1bm5pbmcpOwogCiAgICAgcmV0dXJuICFfX2NzY2hlZF92Y3B1X2lzX2Nh
Y2hlX2hvdChwcnYsIHN2YykgJiYKICAgICAgICAgICAgY3B1bWFza190ZXN0X2NwdShkZXN0X2Nw
dSwgbWFzayk7CkBAIC0xMDMzLDcgKzEwMzMsOCBAQCBjc2NoZWRfdW5pdF9pbnNlcnQoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIAogICAgIGxv
Y2sgPSB1bml0X3NjaGVkdWxlX2xvY2tfaXJxKHVuaXQpOwogCi0gICAgaWYgKCAhX192Y3B1X29u
X3J1bnEoc3ZjKSAmJiB2Y3B1X3J1bm5hYmxlKHZjKSAmJiAhdmMtPmlzX3J1bm5pbmcgKQorICAg
IGlmICggIV9fdmNwdV9vbl9ydW5xKHN2YykgJiYgdmNwdV9ydW5uYWJsZSh2YykgJiYKKyAgICAg
ICAgICF2Yy0+c2NoZWRfdW5pdC0+aXNfcnVubmluZyApCiAgICAgICAgIHJ1bnFfaW5zZXJ0KHN2
Yyk7CiAKICAgICB1bml0X3NjaGVkdWxlX3VubG9ja19pcnEobG9jaywgdW5pdCk7CkBAIC0xNjQ2
LDggKzE2NDcsOSBAQCBjc2NoZWRfcnVucV9zdGVhbChpbnQgcGVlcl9jcHUsIGludCBjcHUsIGlu
dCBwcmksIGludCBiYWxhbmNlX3N0ZXApCiAgICAgICAgICAqIHZDUFVzIHdpdGggdXNlZnVsIHNv
ZnQgYWZmaW5pdGllcyBpbiBzb21lIHNvcnQgb2YgYml0bWFwCiAgICAgICAgICAqIG9yIGNvdW50
ZXIuCiAgICAgICAgICAqLwotICAgICAgICBpZiAoIHZjLT5pc19ydW5uaW5nIHx8IChiYWxhbmNl
X3N0ZXAgPT0gQkFMQU5DRV9TT0ZUX0FGRklOSVRZICYmCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICFoYXNfc29mdF9hZmZpbml0eSh2Yy0+c2NoZWRfdW5pdCkpICkKKyAgICAgICAg
aWYgKCB2Yy0+c2NoZWRfdW5pdC0+aXNfcnVubmluZyB8fAorICAgICAgICAgICAgIChiYWxhbmNl
X3N0ZXAgPT0gQkFMQU5DRV9TT0ZUX0FGRklOSVRZICYmCisgICAgICAgICAgICAgICFoYXNfc29m
dF9hZmZpbml0eSh2Yy0+c2NoZWRfdW5pdCkpICkKICAgICAgICAgICAgIGNvbnRpbnVlOwogCiAg
ICAgICAgIGFmZmluaXR5X2JhbGFuY2VfY3B1bWFzayh2Yy0+c2NoZWRfdW5pdCwgYmFsYW5jZV9z
dGVwLCBjcHVtYXNrX3NjcmF0Y2gpOwpAQCAtMTg1NSw3ICsxODU3LDcgQEAgY3NjaGVkX3NjaGVk
dWxlKAogICAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgY2hhciAqKSZkKTsKICAgICB9CiAK
LSAgICBydW50aW1lID0gbm93IC0gY3VycmVudC0+cnVuc3RhdGUuc3RhdGVfZW50cnlfdGltZTsK
KyAgICBydW50aW1lID0gbm93IC0gY3VycmVudC0+c2NoZWRfdW5pdC0+c3RhdGVfZW50cnlfdGlt
ZTsKICAgICBpZiAoIHJ1bnRpbWUgPCAwICkgLyogRG9lcyB0aGlzIGV2ZXIgaGFwcGVuPyAqLwog
ICAgICAgICBydW50aW1lID0gMDsKIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9jcmVk
aXQyLmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYwppbmRleCA5MTA0NDBkNWQ5Li5hNjA4
MzI4OWY2IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYworKysgYi94ZW4v
Y29tbW9uL3NjaGVkX2NyZWRpdDIuYwpAQCAtMTI4NCw3ICsxMjg0LDcgQEAgcnVucV9pbnNlcnQo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgY3NjaGVkMl91bml0ICpzdmMpCiAK
ICAgICBBU1NFUlQoJnN2Yy0+cnFkLT5ydW5xID09IHJ1bnEpOwogICAgIEFTU0VSVCghaXNfaWRs
ZV92Y3B1KHN2Yy0+dmNwdSkpOwotICAgIEFTU0VSVCghc3ZjLT52Y3B1LT5pc19ydW5uaW5nKTsK
KyAgICBBU1NFUlQoIXN2Yy0+dmNwdS0+c2NoZWRfdW5pdC0+aXNfcnVubmluZyk7CiAgICAgQVNT
RVJUKCEoc3ZjLT5mbGFncyAmIENTRkxBR19zY2hlZHVsZWQpKTsKIAogICAgIGxpc3RfZm9yX2Vh
Y2goIGl0ZXIsIHJ1bnEgKQpAQCAtMTM0MSw4ICsxMzQxLDggQEAgc3RhdGljIGlubGluZSBib29s
IGlzX3ByZWVtcHRhYmxlKGNvbnN0IHN0cnVjdCBjc2NoZWQyX3VuaXQgKnN2YywKICAgICBpZiAo
IHJhdGVsaW1pdCA8PSBDU0NIRUQyX1JBVEVMSU1JVF9USUNLTEVfVE9MRVJBTkNFICkKICAgICAg
ICAgcmV0dXJuIHRydWU7CiAKLSAgICBBU1NFUlQoc3ZjLT52Y3B1LT5pc19ydW5uaW5nKTsKLSAg
ICByZXR1cm4gbm93IC0gc3ZjLT52Y3B1LT5ydW5zdGF0ZS5zdGF0ZV9lbnRyeV90aW1lID4KKyAg
ICBBU1NFUlQoc3ZjLT52Y3B1LT5zY2hlZF91bml0LT5pc19ydW5uaW5nKTsKKyAgICByZXR1cm4g
bm93IC0gc3ZjLT52Y3B1LT5zY2hlZF91bml0LT5zdGF0ZV9lbnRyeV90aW1lID4KICAgICAgICAg
ICAgcmF0ZWxpbWl0IC0gQ1NDSEVEMl9SQVRFTElNSVRfVElDS0xFX1RPTEVSQU5DRTsKIH0KIApA
QCAtMjkzMiw3ICsyOTMyLDcgQEAgY3NjaGVkMl9kb21fY250bCgKICAgICAgICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICAgICAgIHN2YyA9IGNzY2hlZDJfdW5pdCh2LT5zY2hlZF91bml0KTsK
ICAgICAgICAgICAgICAgICAgICAgbG9jayA9IHVuaXRfc2NoZWR1bGVfbG9jayhzdmMtPnZjcHUt
PnNjaGVkX3VuaXQpOwotICAgICAgICAgICAgICAgICAgICBpZiAoIHYtPmlzX3J1bm5pbmcgKQor
ICAgICAgICAgICAgICAgICAgICBpZiAoIHYtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcgKQogICAg
ICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQg
Y3B1ID0gdi0+cHJvY2Vzc29yOwogICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNzY2hl
ZDJfcnVucXVldWVfZGF0YSAqcnFkID0gYzJycWQob3BzLCBjcHUpOwpAQCAtMzIwNSw4ICszMjA1
LDggQEAgY3NjaGVkMl9ydW50aW1lKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgaW50IGNw
dSwKICAgICBpZiAoIHBydi0+cmF0ZWxpbWl0X3VzICkKICAgICB7CiAgICAgICAgIHNfdGltZV90
IHJhdGVsaW1pdF9taW4gPSBNSUNST1NFQ1MocHJ2LT5yYXRlbGltaXRfdXMpOwotICAgICAgICBp
ZiAoIHNuZXh0LT52Y3B1LT5pc19ydW5uaW5nICkKLSAgICAgICAgICAgIHJhdGVsaW1pdF9taW4g
PSBzbmV4dC0+dmNwdS0+cnVuc3RhdGUuc3RhdGVfZW50cnlfdGltZSArCisgICAgICAgIGlmICgg
c25leHQtPnZjcHUtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcgKQorICAgICAgICAgICAgcmF0ZWxp
bWl0X21pbiA9IHNuZXh0LT52Y3B1LT5zY2hlZF91bml0LT5zdGF0ZV9lbnRyeV90aW1lICsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBNSUNST1NFQ1MocHJ2LT5yYXRlbGltaXRfdXMpIC0g
bm93OwogICAgICAgICBpZiAoIHJhdGVsaW1pdF9taW4gPiBtaW5fdGltZSApCiAgICAgICAgICAg
ICBtaW5fdGltZSA9IHJhdGVsaW1pdF9taW47CkBAIC0zMzAzLDcgKzMzMDMsNyBAQCBydW5xX2Nh
bmRpZGF0ZShzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQsCiAgICAgICogbm8gcG9p
bnQgZm9yY2luZyBpdCB0byBkbyBzbyB1bnRpbCByYXRlIGxpbWl0aW5nIGV4cGlyZXMuCiAgICAg
ICovCiAgICAgaWYgKCAheWllbGQgJiYgcHJ2LT5yYXRlbGltaXRfdXMgJiYgdmNwdV9ydW5uYWJs
ZShzY3Vyci0+dmNwdSkgJiYKLSAgICAgICAgIChub3cgLSBzY3Vyci0+dmNwdS0+cnVuc3RhdGUu
c3RhdGVfZW50cnlfdGltZSkgPAorICAgICAgICAgKG5vdyAtIHNjdXJyLT52Y3B1LT5zY2hlZF91
bml0LT5zdGF0ZV9lbnRyeV90aW1lKSA8CiAgICAgICAgICAgTUlDUk9TRUNTKHBydi0+cmF0ZWxp
bWl0X3VzKSApCiAgICAgewogICAgICAgICBpZiAoIHVubGlrZWx5KHRiX2luaXRfZG9uZSkgKQpA
QCAtMzMxNCw3ICszMzE0LDcgQEAgcnVucV9jYW5kaWRhdGUoc3RydWN0IGNzY2hlZDJfcnVucXVl
dWVfZGF0YSAqcnFkLAogICAgICAgICAgICAgfSBkOwogICAgICAgICAgICAgZC5kb20gPSBzY3Vy
ci0+dmNwdS0+ZG9tYWluLT5kb21haW5faWQ7CiAgICAgICAgICAgICBkLnZjcHUgPSBzY3Vyci0+
dmNwdS0+dmNwdV9pZDsKLSAgICAgICAgICAgIGQucnVudGltZSA9IG5vdyAtIHNjdXJyLT52Y3B1
LT5ydW5zdGF0ZS5zdGF0ZV9lbnRyeV90aW1lOworICAgICAgICAgICAgZC5ydW50aW1lID0gbm93
IC0gc2N1cnItPnZjcHUtPnNjaGVkX3VuaXQtPnN0YXRlX2VudHJ5X3RpbWU7CiAgICAgICAgICAg
ICBfX3RyYWNlX3ZhcihUUkNfQ1NDSEVEMl9SQVRFTElNSVQsIDEsCiAgICAgICAgICAgICAgICAg
ICAgICAgICBzaXplb2YoZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgY2hh
ciAqKSZkKTsKQEAgLTM1NjIsNyArMzU2Miw3IEBAIGNzY2hlZDJfc2NoZWR1bGUoCiAgICAgICAg
IGlmICggc25leHQgIT0gc2N1cnIgKQogICAgICAgICB7CiAgICAgICAgICAgICBBU1NFUlQoc25l
eHQtPnJxZCA9PSBycWQpOwotICAgICAgICAgICAgQVNTRVJUKCFzbmV4dC0+dmNwdS0+aXNfcnVu
bmluZyk7CisgICAgICAgICAgICBBU1NFUlQoIXNuZXh0LT52Y3B1LT5zY2hlZF91bml0LT5pc19y
dW5uaW5nKTsKIAogICAgICAgICAgICAgcnVucV9yZW1vdmUoc25leHQpOwogICAgICAgICAgICAg
X19zZXRfYml0KF9fQ1NGTEFHX3NjaGVkdWxlZCwgJnNuZXh0LT5mbGFncyk7CmRpZmYgLS1naXQg
YS94ZW4vY29tbW9uL3NjaGVkX3J0LmMgYi94ZW4vY29tbW9uL3NjaGVkX3J0LmMKaW5kZXggOGI1
YWUxNTliMi4uYTQ3Y2M1OThhOSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9ydC5jCisr
KyBiL3hlbi9jb21tb24vc2NoZWRfcnQuYwpAQCAtOTA2LDcgKzkwNiw3IEBAIHJ0X3VuaXRfaW5z
ZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQp
CiAgICAgewogICAgICAgICByZXBscV9pbnNlcnQob3BzLCBzdmMpOwogCi0gICAgICAgIGlmICgg
IXZjLT5pc19ydW5uaW5nICkKKyAgICAgICAgaWYgKCAhdW5pdC0+aXNfcnVubmluZyApCiAgICAg
ICAgICAgICBydW5xX2luc2VydChvcHMsIHN2Yyk7CiAgICAgfQogICAgIHVuaXRfc2NoZWR1bGVf
dW5sb2NrX2lycShsb2NrLCB1bml0KTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWR1bGUu
YyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwppbmRleCA5MmE3NGI3MzFiLi4wNWJjNDJkN2U5IDEw
MDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZHVs
ZS5jCkBAIC00MTEsNiArNDExLDggQEAgaW50IHNjaGVkX2luaXRfdmNwdShzdHJ1Y3QgdmNwdSAq
diwgdW5zaWduZWQgaW50IHByb2Nlc3NvcikKICAgICB7CiAgICAgICAgIGdldF9zY2hlZF9yZXMo
di0+cHJvY2Vzc29yKS0+Y3VyciA9IHVuaXQ7CiAgICAgICAgIHYtPmlzX3J1bm5pbmcgPSAxOwor
ICAgICAgICB1bml0LT5pc19ydW5uaW5nID0gMTsKKyAgICAgICAgdW5pdC0+c3RhdGVfZW50cnlf
dGltZSA9IE5PVygpOwogICAgIH0KICAgICBlbHNlCiAgICAgewpAQCAtNzMxLDcgKzczMyw4IEBA
IHN0YXRpYyB2b2lkIHZjcHVfbWlncmF0ZV9maW5pc2goc3RydWN0IHZjcHUgKnYpCiAgICAgICog
Y29udGV4dF9zYXZlZCgpOyBhbmQgaW4gYW55IGNhc2UsIGlmIHRoZSBiaXQgaXMgY2xlYXJlZCwg
dGhlbgogICAgICAqIHNvbWVvbmUgZWxzZSBoYXMgYWxyZWFkeSBkb25lIHRoZSB3b3JrIHNvIHdl
IGRvbid0IG5lZWQgdG8uCiAgICAgICovCi0gICAgaWYgKCB2LT5pc19ydW5uaW5nIHx8ICF0ZXN0
X2JpdChfVlBGX21pZ3JhdGluZywgJnYtPnBhdXNlX2ZsYWdzKSApCisgICAgaWYgKCB2LT5zY2hl
ZF91bml0LT5pc19ydW5uaW5nIHx8CisgICAgICAgICAhdGVzdF9iaXQoX1ZQRl9taWdyYXRpbmcs
ICZ2LT5wYXVzZV9mbGFncykgKQogICAgICAgICByZXR1cm47CiAKICAgICBvbGRfY3B1ID0gbmV3
X2NwdSA9IHYtPnByb2Nlc3NvcjsKQEAgLTc4NSw3ICs3ODgsNyBAQCBzdGF0aWMgdm9pZCB2Y3B1
X21pZ3JhdGVfZmluaXNoKHN0cnVjdCB2Y3B1ICp2KQogICAgICAqIGJlY2F1c2UgdGhleSBib3Ro
IGhhcHBlbiBpbiAoZGlmZmVyZW50KSBzcGlubG9jayByZWdpb25zLCBhbmQgdGhvc2UKICAgICAg
KiByZWdpb25zIGFyZSBzdHJpY3RseSBzZXJpYWxpc2VkLgogICAgICAqLwotICAgIGlmICggdi0+
aXNfcnVubmluZyB8fAorICAgIGlmICggdi0+c2NoZWRfdW5pdC0+aXNfcnVubmluZyB8fAogICAg
ICAgICAgIXRlc3RfYW5kX2NsZWFyX2JpdChfVlBGX21pZ3JhdGluZywgJnYtPnBhdXNlX2ZsYWdz
KSApCiAgICAgewogICAgICAgICBzY2hlZF9zcGluX3VubG9ja19kb3VibGUob2xkX2xvY2ssIG5l
d19sb2NrLCBmbGFncyk7CkBAIC0xNjczLDggKzE2NzYsMTAgQEAgc3RhdGljIHZvaWQgc2NoZWR1
bGUodm9pZCkKICAgICAgKiBzd2l0Y2gsIGVsc2UgbG9zdF9yZWNvcmRzIHJlc3VtZSB3aWxsIG5v
dCB3b3JrIHByb3Blcmx5LgogICAgICAqLwogCi0gICAgQVNTRVJUKCFuZXh0LT5pc19ydW5uaW5n
KTsKKyAgICBBU1NFUlQoIW5leHQtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcpOwogICAgIG5leHQt
PmlzX3J1bm5pbmcgPSAxOworICAgIG5leHQtPnNjaGVkX3VuaXQtPmlzX3J1bm5pbmcgPSAxOwor
ICAgIG5leHQtPnNjaGVkX3VuaXQtPnN0YXRlX2VudHJ5X3RpbWUgPSBub3c7CiAKICAgICBwY3B1
X3NjaGVkdWxlX3VubG9ja19pcnEobG9jaywgY3B1KTsKIApAQCAtMTY5Niw2ICsxNzAxLDggQEAg
dm9pZCBjb250ZXh0X3NhdmVkKHN0cnVjdCB2Y3B1ICpwcmV2KQogICAgIHNtcF93bWIoKTsKIAog
ICAgIHByZXYtPmlzX3J1bm5pbmcgPSAwOworICAgIHByZXYtPnNjaGVkX3VuaXQtPmlzX3J1bm5p
bmcgPSAwOworICAgIHByZXYtPnNjaGVkX3VuaXQtPnN0YXRlX2VudHJ5X3RpbWUgPSBOT1coKTsK
IAogICAgIC8qIENoZWNrIGZvciBtaWdyYXRpb24gcmVxdWVzdCAvYWZ0ZXIvIGNsZWFyaW5nIHJ1
bm5pbmcgZmxhZy4gKi8KICAgICBzbXBfbWIoKTsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hl
bi9zY2hlZC5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKaW5kZXggOTQ5YmI2YjY5Ni4uZDQ2
OThiM2YwZCAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmgKQEAgLTI3MCw4ICsyNzAsMTQgQEAgc3RydWN0IHNjaGVkX3VuaXQg
ewogICAgIHN0cnVjdCBzY2hlZF9yZXNvdXJjZSAqcmVzOwogICAgIHVuc2lnbmVkIGludCAgICAg
ICAgICAgdW5pdF9pZDsKIAorICAgIC8qIEN1cnJlbnRseSBydW5uaW5nIG9uIGEgQ1BVPyAqLwor
ICAgIGJvb2wgICAgICAgICAgICAgICAgICAgaXNfcnVubmluZzsKICAgICAvKiBEb2VzIHNvZnQg
YWZmaW5pdHkgYWN0dWFsbHkgcGxheSBhIHJvbGUgKGdpdmVuIGhhcmQgYWZmaW5pdHkpPyAqLwog
ICAgIGJvb2wgICAgICAgICAgICAgICAgICAgc29mdF9hZmZfZWZmZWN0aXZlOworCisgICAgLyog
TGFzdCB0aW1lIHVuaXQgZ290IChkZS0pc2NoZWR1bGVkLiAqLworICAgIHVpbnQ2NF90ICAgICAg
ICAgICAgICAgc3RhdGVfZW50cnlfdGltZTsKKwogICAgIC8qIEJpdG1hc2sgb2YgQ1BVcyBvbiB3
aGljaCB0aGlzIFZDUFUgbWF5IHJ1bi4gKi8KICAgICBjcHVtYXNrX3Zhcl90ICAgICAgICAgIGNw
dV9oYXJkX2FmZmluaXR5OwogICAgIC8qIFVzZWQgdG8gc2F2ZSBhZmZpbml0eSBkdXJpbmcgdGVt
cG9yYXJ5IHBpbm5pbmcuICovCi0tIAoyLjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBs
aXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4v
bGlzdGluZm8veGVuLWRldmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 8631A510B0
	for <lists+xen-devel@lfdr.de>; Mon, 24 Jun 2019 17:36:49 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hfQy3-00025V-4L; Mon, 24 Jun 2019 15:33:15 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=EXrY=UX=citrix.com=anthony.perard@srs-us1.protection.inumbo.net>)
 id 1hfQy0-00024p-TV
 for xen-devel@lists.xenproject.org; Mon, 24 Jun 2019 15:33:12 +0000
X-Inumbo-ID: 5fb91738-9695-11e9-8980-bc764e045a96
Received: from esa3.hc3370-68.iphmx.com (unknown [216.71.145.155])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 5fb91738-9695-11e9-8980-bc764e045a96;
 Mon, 24 Jun 2019 15:33:11 +0000 (UTC)
Authentication-Results: esa3.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=anthony.perard@citrix.com;
 spf=Pass smtp.mailfrom=anthony.perard@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 anthony.perard@citrix.com) identity=pra;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="anthony.perard@citrix.com";
 x-sender="anthony.perard@citrix.com";
 x-conformance=sidf_compatible
Received-SPF: Pass (esa3.hc3370-68.iphmx.com: domain of
 anthony.perard@citrix.com designates 162.221.158.21 as
 permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="anthony.perard@citrix.com";
 x-sender="anthony.perard@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 ip4:209.167.231.154 ip4:178.63.86.133
 ip4:195.66.111.40/30 ip4:85.115.9.32/28 ip4:199.102.83.4
 ip4:192.28.146.160 ip4:192.28.146.107 ip4:216.52.6.88
 ip4:216.52.6.188 ip4:162.221.158.21 ip4:162.221.156.83 ~all"
Received-SPF: None (esa3.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa3.hc3370-68.iphmx.com;
 envelope-from="anthony.perard@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: B3wKRDHoAjpADVOFuiATXfXHImcAfgyg7BNFdetLoH3TdtHsH3YaUosadRE04AfSH31Zg9wEHq
 7+aivZYNxOifUV9NRFPB3nbSMjjQh/8AOIZcyzkucR7NEzFw2BGYlQT89rHb6Vv67eOPph3pbs
 MM+xcRSWQsLwO8nLUZ19pg7VQp/GWi8xsEg0a2qYoc41UY32w41g8DOkpksoj+HlI6z5IHBHoL
 DGpXE2o2y99Ee3BYEGog+nxL2QiwmdWI5teBBTzIBY2x6BGAU0oLyudiXVzr6PCpxM4W7CEsGO
 W8E=
X-SBRS: 2.7
X-MesageID: 2148102
X-Ironport-Server: esa3.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,412,1557201600"; 
   d="scan'208";a="2148102"
From: Anthony PERARD <anthony.perard@citrix.com>
To: <qemu-devel@nongnu.org>
Date: Mon, 24 Jun 2019 16:32:51 +0100
Message-ID: <20190624153257.20163-3-anthony.perard@citrix.com>
X-Mailer: git-send-email 2.22.0
In-Reply-To: <20190624153257.20163-1-anthony.perard@citrix.com>
References: <20190624153257.20163-1-anthony.perard@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PULL 2/8] xen-bus: use a separate fd for each event
 channel
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>, xen-devel@lists.xenproject.org,
 Peter Maydell <peter.maydell@linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNvbT4KClRvIGJldHRlciBz
dXBwb3J0IHVzZSBvZiBJT1RocmVhZC1zIGl0IHdpbGwgYmUgbmVjZXNzYXJ5IHRvIGJlIGFibGUg
dG8gc2V0CnRoZSBBaW9Db250ZXh0IGZvciBlYWNoIFhlbkV2ZW50Q2hhbm5lbCBhbmQgaGVuY2Ug
aXQgaXMgbmVjZXNzYXJ5IHRvIG9wZW4gYQpzZXBhcmF0ZSBoYW5kbGUgdG8gbGlieGVuZXZ0Y2hh
biBmb3IgZWFjaCBjaGFubmVsLgoKVGhpcyBwYXRjaCBzdG9wcyB1c2luZyBOb3RpZmllckxpc3Qg
Zm9yIGV2ZW50IGNoYW5uZWwgY2FsbGJhY2tzLCByZXBsYWNpbmcKdGhhdCBjb25zdHJ1Y3QgYnkg
YSBsaXN0IG9mIGNvbXBsZXRlIFhlbkV2ZW50Q2hhbm5lbCBzdHJ1Y3R1cmVzLiBFYWNoIG9mCnRo
ZXNlIG5vdyBoYXMgYSB4ZW5ldnRjaG5faGFuZGxlIHBvaW50ZXIgaW4gcGxhY2Ugb2YgdGhlIHNp
bmdsZSBwb2ludGVyCnByZXZpb3VzbHkgaGVsZCBpbiB0aGUgWGVuRGV2aWNlIHN0cnVjdHVyZS4g
VGhlIGluZGl2aWR1YWwgaGFuZGxlcyBhcmUKb3BlbmVkL2Nsb3NlZCBpbiB4ZW5fZGV2aWNlX2Jp
bmQvdW5iaW5kX2V2ZW50X2NoYW5uZWwoKSwgcmVwbGFjaW5nIHRoZQpzaW5nbGUgb3Blbi9jbG9z
ZSBpbiB4ZW5fZGV2aWNlX3JlYWxpemUvdW5yZWFsaXplKCkuCgpOT1RFOiBUaGlzIHBhdGNoIGRv
ZXMgbm90IGFkZCBhbiBBaW9Db250ZXh0IHBhcmFtZXRlciB0bwogICAgICB4ZW5fZGV2aWNlX2Jp
bmRfZXZlbnRfY2hhbm5lbCgpLiBUaGF0IHdpbGwgYmUgZG9uZSBpbiBhIHN1YnNlcXVlbnQKICAg
ICAgcGF0Y2guCgpTaWduZWQtb2ZmLWJ5OiBQYXVsIER1cnJhbnQgPHBhdWwuZHVycmFudEBjaXRy
aXguY29tPgpSZXZpZXdlZC1ieTogQW50aG9ueSBQRVJBUkQgPGFudGhvbnkucGVyYXJkQGNpdHJp
eC5jb20+Ck1lc3NhZ2UtSWQ6IDwyMDE5MDQwODE1MTYxNy4xMzAyNS0yLXBhdWwuZHVycmFudEBj
aXRyaXguY29tPgpTaWduZWQtb2ZmLWJ5OiBBbnRob255IFBFUkFSRCA8YW50aG9ueS5wZXJhcmRA
Y2l0cml4LmNvbT4KLS0tCiBody94ZW4veGVuLWJ1cy5jICAgICAgICAgfCA3OSArKysrKysrKysr
KysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tCiBpbmNsdWRlL2h3L3hlbi94ZW4tYnVzLmgg
fCAgNiArLS0KIDIgZmlsZXMgY2hhbmdlZCwgNDIgaW5zZXJ0aW9ucygrKSwgNDMgZGVsZXRpb25z
KC0pCgpkaWZmIC0tZ2l0IGEvaHcveGVuL3hlbi1idXMuYyBiL2h3L3hlbi94ZW4tYnVzLmMKaW5k
ZXggYTQ0MTZkMGJjZi4uNDNhOTBjYWU0MiAxMDA2NDQKLS0tIGEvaHcveGVuL3hlbi1idXMuYwor
KysgYi9ody94ZW4veGVuLWJ1cy5jCkBAIC05MjQsMTkgKzkyNCwyMiBAQCB2b2lkIHhlbl9kZXZp
Y2VfY29weV9ncmFudF9yZWZzKFhlbkRldmljZSAqeGVuZGV2LCBib29sIHRvX2RvbWFpbiwKIH0K
IAogc3RydWN0IFhlbkV2ZW50Q2hhbm5lbCB7CisgICAgUUxJU1RfRU5UUlkoWGVuRXZlbnRDaGFu
bmVsKSBsaXN0OworICAgIHhlbmV2dGNobl9oYW5kbGUgKnhlaDsKICAgICBldnRjaG5fcG9ydF90
IGxvY2FsX3BvcnQ7CiAgICAgWGVuRXZlbnRIYW5kbGVyIGhhbmRsZXI7CiAgICAgdm9pZCAqb3Bh
cXVlOwotICAgIE5vdGlmaWVyIG5vdGlmaWVyOwogfTsKIAotc3RhdGljIHZvaWQgZXZlbnRfbm90
aWZ5KE5vdGlmaWVyICpuLCB2b2lkICpkYXRhKQorc3RhdGljIHZvaWQgeGVuX2RldmljZV9ldmVu
dCh2b2lkICpvcGFxdWUpCiB7Ci0gICAgWGVuRXZlbnRDaGFubmVsICpjaGFubmVsID0gY29udGFp
bmVyX29mKG4sIFhlbkV2ZW50Q2hhbm5lbCwgbm90aWZpZXIpOwotICAgIHVuc2lnbmVkIGxvbmcg
cG9ydCA9ICh1bnNpZ25lZCBsb25nKWRhdGE7CisgICAgWGVuRXZlbnRDaGFubmVsICpjaGFubmVs
ID0gb3BhcXVlOworICAgIHVuc2lnbmVkIGxvbmcgcG9ydCA9IHhlbmV2dGNobl9wZW5kaW5nKGNo
YW5uZWwtPnhlaCk7CiAKICAgICBpZiAocG9ydCA9PSBjaGFubmVsLT5sb2NhbF9wb3J0KSB7CiAg
ICAgICAgIGNoYW5uZWwtPmhhbmRsZXIoY2hhbm5lbC0+b3BhcXVlKTsKKworICAgICAgICB4ZW5l
dnRjaG5fdW5tYXNrKGNoYW5uZWwtPnhlaCwgcG9ydCk7CiAgICAgfQogfQogCkBAIC05NDgsMjQg
Kzk1MSwzOSBAQCBYZW5FdmVudENoYW5uZWwgKnhlbl9kZXZpY2VfYmluZF9ldmVudF9jaGFubmVs
KFhlbkRldmljZSAqeGVuZGV2LAogICAgIFhlbkV2ZW50Q2hhbm5lbCAqY2hhbm5lbCA9IGdfbmV3
MChYZW5FdmVudENoYW5uZWwsIDEpOwogICAgIHhlbmV2dGNobl9wb3J0X29yX2Vycm9yX3QgbG9j
YWxfcG9ydDsKIAotICAgIGxvY2FsX3BvcnQgPSB4ZW5ldnRjaG5fYmluZF9pbnRlcmRvbWFpbih4
ZW5kZXYtPnhlaCwKKyAgICBjaGFubmVsLT54ZWggPSB4ZW5ldnRjaG5fb3BlbihOVUxMLCAwKTsK
KyAgICBpZiAoIWNoYW5uZWwtPnhlaCkgeworICAgICAgICBlcnJvcl9zZXRnX2Vycm5vKGVycnAs
IGVycm5vLCAiZmFpbGVkIHhlbmV2dGNobl9vcGVuIik7CisgICAgICAgIGdvdG8gZmFpbDsKKyAg
ICB9CisKKyAgICBsb2NhbF9wb3J0ID0geGVuZXZ0Y2huX2JpbmRfaW50ZXJkb21haW4oY2hhbm5l
bC0+eGVoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5k
ZXYtPmZyb250ZW5kX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBwb3J0KTsKICAgICBpZiAobG9jYWxfcG9ydCA8IDApIHsKICAgICAgICAgZXJyb3Jfc2V0
Z19lcnJubyhlcnJwLCBlcnJubywgInhlbmV2dGNobl9iaW5kX2ludGVyZG9tYWluIGZhaWxlZCIp
OwotCi0gICAgICAgIGdfZnJlZShjaGFubmVsKTsKLSAgICAgICAgcmV0dXJuIE5VTEw7CisgICAg
ICAgIGdvdG8gZmFpbDsKICAgICB9CiAKICAgICBjaGFubmVsLT5sb2NhbF9wb3J0ID0gbG9jYWxf
cG9ydDsKICAgICBjaGFubmVsLT5oYW5kbGVyID0gaGFuZGxlcjsKICAgICBjaGFubmVsLT5vcGFx
dWUgPSBvcGFxdWU7Ci0gICAgY2hhbm5lbC0+bm90aWZpZXIubm90aWZ5ID0gZXZlbnRfbm90aWZ5
OwogCi0gICAgbm90aWZpZXJfbGlzdF9hZGQoJnhlbmRldi0+ZXZlbnRfbm90aWZpZXJzLCAmY2hh
bm5lbC0+bm90aWZpZXIpOworICAgIHFlbXVfc2V0X2ZkX2hhbmRsZXIoeGVuZXZ0Y2huX2ZkKGNo
YW5uZWwtPnhlaCksIHhlbl9kZXZpY2VfZXZlbnQsIE5VTEwsCisgICAgICAgICAgICAgICAgICAg
ICAgICBjaGFubmVsKTsKKworICAgIFFMSVNUX0lOU0VSVF9IRUFEKCZ4ZW5kZXYtPmV2ZW50X2No
YW5uZWxzLCBjaGFubmVsLCBsaXN0KTsKIAogICAgIHJldHVybiBjaGFubmVsOworCitmYWlsOgor
ICAgIGlmIChjaGFubmVsLT54ZWgpIHsKKyAgICAgICAgeGVuZXZ0Y2huX2Nsb3NlKGNoYW5uZWwt
PnhlaCk7CisgICAgfQorCisgICAgZ19mcmVlKGNoYW5uZWwpOworCisgICAgcmV0dXJuIE5VTEw7
CiB9CiAKIHZvaWQgeGVuX2RldmljZV9ub3RpZnlfZXZlbnRfY2hhbm5lbChYZW5EZXZpY2UgKnhl
bmRldiwKQEAgLTk3Nyw3ICs5OTUsNyBAQCB2b2lkIHhlbl9kZXZpY2Vfbm90aWZ5X2V2ZW50X2No
YW5uZWwoWGVuRGV2aWNlICp4ZW5kZXYsCiAgICAgICAgIHJldHVybjsKICAgICB9CiAKLSAgICBp
ZiAoeGVuZXZ0Y2huX25vdGlmeSh4ZW5kZXYtPnhlaCwgY2hhbm5lbC0+bG9jYWxfcG9ydCkgPCAw
KSB7CisgICAgaWYgKHhlbmV2dGNobl9ub3RpZnkoY2hhbm5lbC0+eGVoLCBjaGFubmVsLT5sb2Nh
bF9wb3J0KSA8IDApIHsKICAgICAgICAgZXJyb3Jfc2V0Z19lcnJubyhlcnJwLCBlcnJubywgInhl
bmV2dGNobl9ub3RpZnkgZmFpbGVkIik7CiAgICAgfQogfQpAQCAtOTkxLDEyICsxMDA5LDE1IEBA
IHZvaWQgeGVuX2RldmljZV91bmJpbmRfZXZlbnRfY2hhbm5lbChYZW5EZXZpY2UgKnhlbmRldiwK
ICAgICAgICAgcmV0dXJuOwogICAgIH0KIAotICAgIG5vdGlmaWVyX3JlbW92ZSgmY2hhbm5lbC0+
bm90aWZpZXIpOworICAgIFFMSVNUX1JFTU9WRShjaGFubmVsLCBsaXN0KTsKIAotICAgIGlmICh4
ZW5ldnRjaG5fdW5iaW5kKHhlbmRldi0+eGVoLCBjaGFubmVsLT5sb2NhbF9wb3J0KSA8IDApIHsK
KyAgICBxZW11X3NldF9mZF9oYW5kbGVyKHhlbmV2dGNobl9mZChjaGFubmVsLT54ZWgpLCBOVUxM
LCBOVUxMLCBOVUxMKTsKKworICAgIGlmICh4ZW5ldnRjaG5fdW5iaW5kKGNoYW5uZWwtPnhlaCwg
Y2hhbm5lbC0+bG9jYWxfcG9ydCkgPCAwKSB7CiAgICAgICAgIGVycm9yX3NldGdfZXJybm8oZXJy
cCwgZXJybm8sICJ4ZW5ldnRjaG5fdW5iaW5kIGZhaWxlZCIpOwogICAgIH0KIAorICAgIHhlbmV2
dGNobl9jbG9zZShjaGFubmVsLT54ZWgpOwogICAgIGdfZnJlZShjaGFubmVsKTsKIH0KIApAQCAt
MTAwNSw2ICsxMDI2LDcgQEAgc3RhdGljIHZvaWQgeGVuX2RldmljZV91bnJlYWxpemUoRGV2aWNl
U3RhdGUgKmRldiwgRXJyb3IgKiplcnJwKQogICAgIFhlbkRldmljZSAqeGVuZGV2ID0gWEVOX0RF
VklDRShkZXYpOwogICAgIFhlbkRldmljZUNsYXNzICp4ZW5kZXZfY2xhc3MgPSBYRU5fREVWSUNF
X0dFVF9DTEFTUyh4ZW5kZXYpOwogICAgIGNvbnN0IGNoYXIgKnR5cGUgPSBvYmplY3RfZ2V0X3R5
cGVuYW1lKE9CSkVDVCh4ZW5kZXYpKTsKKyAgICBYZW5FdmVudENoYW5uZWwgKmNoYW5uZWwsICpu
ZXh0OwogCiAgICAgaWYgKCF4ZW5kZXYtPm5hbWUpIHsKICAgICAgICAgcmV0dXJuOwpAQCAtMTAy
MSwxNSArMTA0MywxNCBAQCBzdGF0aWMgdm9pZCB4ZW5fZGV2aWNlX3VucmVhbGl6ZShEZXZpY2VT
dGF0ZSAqZGV2LCBFcnJvciAqKmVycnApCiAgICAgICAgIHhlbmRldl9jbGFzcy0+dW5yZWFsaXpl
KHhlbmRldiwgZXJycCk7CiAgICAgfQogCisgICAgLyogTWFrZSBzdXJlIGFsbCBldmVudCBjaGFu
bmVscyBhcmUgY2xlYW5lZCB1cCAqLworICAgIFFMSVNUX0ZPUkVBQ0hfU0FGRShjaGFubmVsLCAm
eGVuZGV2LT5ldmVudF9jaGFubmVscywgbGlzdCwgbmV4dCkgeworICAgICAgICB4ZW5fZGV2aWNl
X3VuYmluZF9ldmVudF9jaGFubmVsKHhlbmRldiwgY2hhbm5lbCwgTlVMTCk7CisgICAgfQorCiAg
ICAgeGVuX2RldmljZV9mcm9udGVuZF9kZXN0cm95KHhlbmRldik7CiAgICAgeGVuX2RldmljZV9i
YWNrZW5kX2Rlc3Ryb3koeGVuZGV2KTsKIAotICAgIGlmICh4ZW5kZXYtPnhlaCkgewotICAgICAg
ICBxZW11X3NldF9mZF9oYW5kbGVyKHhlbmV2dGNobl9mZCh4ZW5kZXYtPnhlaCksIE5VTEwsIE5V
TEwsIE5VTEwpOwotICAgICAgICB4ZW5ldnRjaG5fY2xvc2UoeGVuZGV2LT54ZWgpOwotICAgICAg
ICB4ZW5kZXYtPnhlaCA9IE5VTEw7Ci0gICAgfQotCiAgICAgaWYgKHhlbmRldi0+eGd0aCkgewog
ICAgICAgICB4ZW5nbnR0YWJfY2xvc2UoeGVuZGV2LT54Z3RoKTsKICAgICAgICAgeGVuZGV2LT54
Z3RoID0gTlVMTDsKQEAgLTEwNDYsMTYgKzEwNjcsNiBAQCBzdGF0aWMgdm9pZCB4ZW5fZGV2aWNl
X2V4aXQoTm90aWZpZXIgKm4sIHZvaWQgKmRhdGEpCiAgICAgeGVuX2RldmljZV91bnJlYWxpemUo
REVWSUNFKHhlbmRldiksICZlcnJvcl9hYm9ydCk7CiB9CiAKLXN0YXRpYyB2b2lkIHhlbl9kZXZp
Y2VfZXZlbnQodm9pZCAqb3BhcXVlKQotewotICAgIFhlbkRldmljZSAqeGVuZGV2ID0gb3BhcXVl
OwotICAgIHVuc2lnbmVkIGxvbmcgcG9ydCA9IHhlbmV2dGNobl9wZW5kaW5nKHhlbmRldi0+eGVo
KTsKLQotICAgIG5vdGlmaWVyX2xpc3Rfbm90aWZ5KCZ4ZW5kZXYtPmV2ZW50X25vdGlmaWVycywg
KHZvaWQgKilwb3J0KTsKLQotICAgIHhlbmV2dGNobl91bm1hc2soeGVuZGV2LT54ZWgsIHBvcnQp
OwotfQotCiBzdGF0aWMgdm9pZCB4ZW5fZGV2aWNlX3JlYWxpemUoRGV2aWNlU3RhdGUgKmRldiwg
RXJyb3IgKiplcnJwKQogewogICAgIFhlbkRldmljZSAqeGVuZGV2ID0gWEVOX0RFVklDRShkZXYp
OwpAQCAtMTA5NiwxNiArMTEwNyw2IEBAIHN0YXRpYyB2b2lkIHhlbl9kZXZpY2VfcmVhbGl6ZShE
ZXZpY2VTdGF0ZSAqZGV2LCBFcnJvciAqKmVycnApCiAgICAgeGVuZGV2LT5mZWF0dXJlX2dyYW50
X2NvcHkgPQogICAgICAgICAoeGVuZ250dGFiX2dyYW50X2NvcHkoeGVuZGV2LT54Z3RoLCAwLCBO
VUxMKSA9PSAwKTsKIAotICAgIHhlbmRldi0+eGVoID0geGVuZXZ0Y2huX29wZW4oTlVMTCwgMCk7
Ci0gICAgaWYgKCF4ZW5kZXYtPnhlaCkgewotICAgICAgICBlcnJvcl9zZXRnX2Vycm5vKGVycnAs
IGVycm5vLCAiZmFpbGVkIHhlbmV2dGNobl9vcGVuIik7Ci0gICAgICAgIGdvdG8gdW5yZWFsaXpl
OwotICAgIH0KLQotICAgIG5vdGlmaWVyX2xpc3RfaW5pdCgmeGVuZGV2LT5ldmVudF9ub3RpZmll
cnMpOwotICAgIHFlbXVfc2V0X2ZkX2hhbmRsZXIoeGVuZXZ0Y2huX2ZkKHhlbmRldi0+eGVoKSwg
eGVuX2RldmljZV9ldmVudCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgICAgICAgIHhlbmRldik7
Ci0KICAgICB4ZW5fZGV2aWNlX2JhY2tlbmRfY3JlYXRlKHhlbmRldiwgJmxvY2FsX2Vycik7CiAg
ICAgaWYgKGxvY2FsX2VycikgewogICAgICAgICBlcnJvcl9wcm9wYWdhdGUoZXJycCwgbG9jYWxf
ZXJyKTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvaHcveGVuL3hlbi1idXMuaCBiL2luY2x1ZGUvaHcv
eGVuL3hlbi1idXMuaAppbmRleCAzMTgzZjEwZTNjLi4zMzE1ZjBkZTIwIDEwMDY0NAotLS0gYS9p
bmNsdWRlL2h3L3hlbi94ZW4tYnVzLmgKKysrIGIvaW5jbHVkZS9ody94ZW4veGVuLWJ1cy5oCkBA
IC0xNSw2ICsxNSw3IEBACiB0eXBlZGVmIHZvaWQgKCpYZW5XYXRjaEhhbmRsZXIpKHZvaWQgKm9w
YXF1ZSk7CiAKIHR5cGVkZWYgc3RydWN0IFhlbldhdGNoIFhlbldhdGNoOwordHlwZWRlZiBzdHJ1
Y3QgWGVuRXZlbnRDaGFubmVsIFhlbkV2ZW50Q2hhbm5lbDsKIAogdHlwZWRlZiBzdHJ1Y3QgWGVu
RGV2aWNlIHsKICAgICBEZXZpY2VTdGF0ZSBxZGV2OwpAQCAtMjgsOCArMjksNyBAQCB0eXBlZGVm
IHN0cnVjdCBYZW5EZXZpY2UgewogICAgIFhlbldhdGNoICpiYWNrZW5kX29ubGluZV93YXRjaDsK
ICAgICB4ZW5nbnR0YWJfaGFuZGxlICp4Z3RoOwogICAgIGJvb2wgZmVhdHVyZV9ncmFudF9jb3B5
OwotICAgIHhlbmV2dGNobl9oYW5kbGUgKnhlaDsKLSAgICBOb3RpZmllckxpc3QgZXZlbnRfbm90
aWZpZXJzOworICAgIFFMSVNUX0hFQUQoLCBYZW5FdmVudENoYW5uZWwpIGV2ZW50X2NoYW5uZWxz
OwogfSBYZW5EZXZpY2U7CiAKIHR5cGVkZWYgY2hhciAqKCpYZW5EZXZpY2VHZXROYW1lKShYZW5E
ZXZpY2UgKnhlbmRldiwgRXJyb3IgKiplcnJwKTsKQEAgLTExOSw4ICsxMTksNiBAQCB2b2lkIHhl
bl9kZXZpY2VfY29weV9ncmFudF9yZWZzKFhlbkRldmljZSAqeGVuZGV2LCBib29sIHRvX2RvbWFp
biwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWGVuRGV2aWNlR3JhbnRDb3B5U2Vn
bWVudCBzZWdzW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGlu
dCBucl9zZWdzLCBFcnJvciAqKmVycnApOwogCi10eXBlZGVmIHN0cnVjdCBYZW5FdmVudENoYW5u
ZWwgWGVuRXZlbnRDaGFubmVsOwotCiB0eXBlZGVmIHZvaWQgKCpYZW5FdmVudEhhbmRsZXIpKHZv
aWQgKm9wYXF1ZSk7CiAKIFhlbkV2ZW50Q2hhbm5lbCAqeGVuX2RldmljZV9iaW5kX2V2ZW50X2No
YW5uZWwoWGVuRGV2aWNlICp4ZW5kZXYsCi0tIApBbnRob255IFBFUkFSRAoKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxp
c3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVj
dC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

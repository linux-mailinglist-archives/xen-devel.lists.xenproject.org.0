Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 57B8B118D0A
	for <lists+xen-devel@lfdr.de>; Tue, 10 Dec 2019 16:51:49 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iehlP-0003v4-JC; Tue, 10 Dec 2019 15:49:27 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=A1/D=2A=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iehlN-0003tq-UZ
 for xen-devel@lists.xenproject.org; Tue, 10 Dec 2019 15:49:26 +0000
X-Inumbo-ID: 79756568-1b64-11ea-88e7-bc764e2007e4
Received: from mail-qt1-x82d.google.com (unknown [2607:f8b0:4864:20::82d])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 79756568-1b64-11ea-88e7-bc764e2007e4;
 Tue, 10 Dec 2019 15:48:13 +0000 (UTC)
Received: by mail-qt1-x82d.google.com with SMTP id 5so3211594qtz.1
 for <xen-devel@lists.xenproject.org>; Tue, 10 Dec 2019 07:48:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=OXSNz2MEBIs7JpBT0cL0HMNBR/NYhbhpDmMVqQGDU20=;
 b=sJJZ7DseMALkXWnzl5Osh9GYuem3Rvsrm/8t8vCn17HASVcEG2rxBL7PyQEGTtNRwy
 qpyzxnbMrSQXM3RAKL11QFhytYPKbQNA1pSxJTXG1BpSVt+qAdXnJhX6hn8n0gBdvFGW
 uZ9xSwYI5b9AkFzS6abCYug24rSQRi5lbkNLmxY1qjb+ZBRn6bzZLA4jFBhLsxws49pT
 OEdYqumfMZ0HT74XfqgMXpJY/9VdVMRSWzkXecmYgKN4/FdRKXNIraQyrqquQkgX2GFH
 HjQdF59NtZUFTneawOYn0oJbBnMXnAG5usAPnq9lPy1tkcdGrRiFBwO/GqSVcoXmMffn
 gx+g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=OXSNz2MEBIs7JpBT0cL0HMNBR/NYhbhpDmMVqQGDU20=;
 b=WefK4CJZm/0CUGgoK5wUrZil+zqSn8KKR9r6rqa4z9Wo43ggKVX8+1EtALKLsndnw1
 vMNzZekCCUiYMD/6SNAYvDdVc+nQoqTY6jswDqnOIeJJ59y77+91zHr0r/s3BneQvirE
 auINVKmPjxDv0STSmMjpCPXnft1BuR0L08KvIeAmtqYJZmBe23HmDfNe2h3wQgd+V6QJ
 CTMK8TiXq7lFdjNr9xtCRk1Y7p+7IV35yho2kQrytD27Ma61IlnPr/WgT/fdhyTx926b
 KJJt47Gayfy3tvwE57pdXXszbhIEWe1uQkneo4ZnlFA0yE9Nydn3JWoC/W5BTKAuVrMR
 Knng==
X-Gm-Message-State: APjAAAWP2NMD8m0B4YTgECEkfNm16whLj5bUEgwnSnawsP946CVvDQ42
 En0ZWxLrY/IojJamR4JbjGH48mcg
X-Google-Smtp-Source: APXvYqxT9w59+KU+OqBAkMPyDe8EtY86k/xrwuAePHMpysEFy1RGHdS5ga8TnE0JESxFVWJO9aiS1Q==
X-Received: by 2002:aed:3fce:: with SMTP id w14mr32183358qth.0.1575992892079; 
 Tue, 10 Dec 2019 07:48:12 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id m29sm1247848qtf.1.2019.12.10.07.48.10
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 10 Dec 2019 07:48:11 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 10 Dec 2019 10:47:33 -0500
Message-Id: <79dbba7b8217f653c55a6e166055be4ab3a31400.1575990937.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1575990937.git.rosbrookn@ainfosec.com>
References: <cover.1575990937.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 18/22] golang/xenlight: begin Go to C type
 marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KCkltcGxlbWVudCBj
b252ZXJzaW9uIG9mIGJhc2ljIHR5cGUgY29udmVyc2lvbnMgc3VjaCBhcyBzdHJpbmdzCmFuZCBp
bnRlZ2VyIHR5cGVzIGluIHRvQyBmdW5jdGlvbnMuCgpTaWduZWQtb2ZmLWJ5OiBOaWNrIFJvc2Jy
b29rIDxyb3Nicm9va25AYWluZm9zZWMuY29tPgotLS0KIHRvb2xzL2dvbGFuZy94ZW5saWdodC9n
ZW5nb3R5cGVzLnB5ICB8ICAgODAgKysKIHRvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdl
bi5nbyB8IDEwMTUgKysrKysrKysrKysrKysrKysrKysrKysrKysKIDIgZmlsZXMgY2hhbmdlZCwg
MTA5NSBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2dl
bmdvdHlwZXMucHkgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQppbmRleCBl
ZTlhYWY5ZWZmLi5jYjliMTgyMThmIDEwMDY0NAotLS0gYS90b29scy9nb2xhbmcveGVubGlnaHQv
Z2VuZ290eXBlcy5weQorKysgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQpA
QCAtMjM0LDYgKzIzNCw5IEBAIGRlZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJhdGVfaGVscGVycyhw
YXRoID0gTm9uZSwgdHlwZXMgPSBOb25lLCBjb21tZW50ID0gTm9uZSk6CiAgICAgICAgICAgICAg
ICAgZi53cml0ZShleHRyYSkKICAgICAgICAgICAgICAgICBmLndyaXRlKCdcbicpCiAKKyAgICAg
ICAgICAgIGYud3JpdGUoeGVubGlnaHRfZ29sYW5nX2RlZmluZV90b19DKHR5KSkKKyAgICAgICAg
ICAgIGYud3JpdGUoJ1xuJykKKwogICAgIGdvX2ZtdChwYXRoKQogCiBkZWYgeGVubGlnaHRfZ29s
YW5nX2RlZmluZV9mcm9tX0ModHkgPSBOb25lKToKQEAgLTQzNiw2ICs0MzksODMgQEAgZGVmIHhl
bmxpZ2h0X2dvbGFuZ19hcnJheV9mcm9tX0ModHkgPSBOb25lKToKIAogICAgIHJldHVybiBzCiAK
K2RlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX3RvX0ModHkgPSBOb25lLCB0eXBlbmFtZSA9IE5v
bmUsIG5lc3RlZCA9IEZhbHNlKToKKyAgICBzID0gJycKKworICAgIGdvdHlwZW5hbWUgPSBjdHlw
ZW5hbWUgPSAnJworCisgICAgaWYgdHlwZW5hbWUgaXMgbm90IE5vbmU6CisgICAgICAgIGdvdHlw
ZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUodHlwZW5hbWUpCisgICAgICAgIGN0eXBl
bmFtZSAgPSB0eXBlbmFtZQorICAgIGVsc2U6CisgICAgICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdo
dF9nb2xhbmdfZm10X25hbWUodHkudHlwZW5hbWUpCisgICAgICAgIGN0eXBlbmFtZSAgPSB0eS50
eXBlbmFtZQorCisgICAgaWYgbm90IG5lc3RlZDoKKyAgICAgICAgcyArPSAnZnVuYyAoeCAqe30p
IHRvQygpICh4YyBDLnt9LGVyciBlcnJvcikge3tcbicuZm9ybWF0KGdvdHlwZW5hbWUsY3R5cGVu
YW1lKQorICAgICAgICBzICs9ICdDLnt9KCZ4YylcbicuZm9ybWF0KHR5LmluaXRfZm4pCisKKyAg
ICBmb3IgZiBpbiB0eS5maWVsZHM6CisgICAgICAgIGlmIGYudHlwZS50eXBlbmFtZSBpcyBub3Qg
Tm9uZToKKyAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoZi50eXBlLCBpZGwuQXJyYXkpOgorICAg
ICAgICAgICAgICAgICMgVE9ETworICAgICAgICAgICAgICAgIGNvbnRpbnVlCisKKyAgICAgICAg
ICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUoZi50eXBlLnR5cGVuYW1l
KQorICAgICAgICAgICAgY3R5cGVuYW1lICA9IGYudHlwZS50eXBlbmFtZQorICAgICAgICAgICAg
Z29mbmFtZSAgICA9IHhlbmxpZ2h0X2dvbGFuZ19mbXRfbmFtZShmLm5hbWUpCisgICAgICAgICAg
ICBjZm5hbWUgICAgID0gZi5uYW1lCisKKyAgICAgICAgICAgICMgSW4gY2dvLCBDIG5hbWVzIHRo
YXQgY29uZmxpY3Qgd2l0aCBHbyBrZXl3b3JkcyBjYW4gYmUKKyAgICAgICAgICAgICMgYWNjZXNz
ZWQgYnkgcHJlcGVuZGluZyBhbiB1bmRlcnNjb3JlIHRvIHRoZSBuYW1lLgorICAgICAgICAgICAg
aWYgY2ZuYW1lIGluIGdvX2tleXdvcmRzOgorICAgICAgICAgICAgICAgIGNmbmFtZSA9ICdfJyAr
IGNmbmFtZQorCisgICAgICAgICAgICAjIElmIHRoaXMgaXMgbmVzdGVkLCB3ZSBuZWVkIHRoZSBv
dXRlciBuYW1lIHRvby4KKyAgICAgICAgICAgIGlmIG5lc3RlZCBhbmQgdHlwZW5hbWUgaXMgbm90
IE5vbmU6CisgICAgICAgICAgICAgICAgZ29uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1l
KHR5cGVuYW1lKQorICAgICAgICAgICAgICAgIGdvbmFtZSA9ICd7fS57fScuZm9ybWF0KGdvbmFt
ZSwgZ29mbmFtZSkKKyAgICAgICAgICAgICAgICBjbmFtZSAgPSAne30ue30nLmZvcm1hdCh0eXBl
bmFtZSwgY2ZuYW1lKQorCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgIGdvbmFt
ZSA9IGdvZm5hbWUKKyAgICAgICAgICAgICAgICBjbmFtZSAgPSBjZm5hbWUKKworICAgICAgICAg
ICAgaXNfY2FzdGFibGUgPSAoZi50eXBlLmpzb25fcGFyc2VfdHlwZSA9PSAnSlNPTl9JTlRFR0VS
JyBvcgorICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5F
bnVtZXJhdGlvbikgb3IKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdHlwZW5hbWUgaW4g
Z29fYnVpbHRpbl90eXBlcykKKworICAgICAgICAgICAgaWYgaXNfY2FzdGFibGU6CisgICAgICAg
ICAgICAgICAgIyBVc2UgdGhlIGNnbyBoZWxwZXIgZm9yIGNvbnZlcnRpbmcgQyBzdHJpbmdzLgor
ICAgICAgICAgICAgICAgIGlmIGdvdHlwZW5hbWUgPT0gJ3N0cmluZyc6CisgICAgICAgICAgICAg
ICAgICAgIHMgKz0gJ3hjLnt9ID0gQy5DU3RyaW5nKHgue30pXG4nLmZvcm1hdChjbmFtZSxnb25h
bWUpCisgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCisKKyAgICAgICAgICAgICAgICBzICs9
ICd4Yy57fSA9IEMue30oeC57fSlcbicuZm9ybWF0KGNuYW1lLGN0eXBlbmFtZSxnb25hbWUpCisK
KyAgICAgICAgICAgIGVsc2U6CisgICAgICAgICAgICAgICAgcyArPSAneGMue30sIGVyciA9IHgu
e30udG9DKClcbicuZm9ybWF0KGNuYW1lLGdvbmFtZSkKKyAgICAgICAgICAgICAgICBzICs9ICdp
ZiBlcnIgIT0gbmlsIHtcbicKKyAgICAgICAgICAgICAgICBzICs9ICdDLnt9KCZ4YylcbicuZm9y
bWF0KHR5LmRpc3Bvc2VfZm4pCisgICAgICAgICAgICAgICAgcyArPSAncmV0dXJuIHhjLCBlcnJc
bicKKyAgICAgICAgICAgICAgICBzICs9ICd9XG4nCisKKyAgICAgICAgZWxpZiBpc2luc3RhbmNl
KGYudHlwZSwgaWRsLlN0cnVjdCk6CisgICAgICAgICAgICBzICs9IHhlbmxpZ2h0X2dvbGFuZ19k
ZWZpbmVfdG9fQyhmLnR5cGUsIHR5cGVuYW1lPWYubmFtZSwgbmVzdGVkPVRydWUpCisKKyAgICAg
ICAgZWxpZiBpc2luc3RhbmNlKGYudHlwZSwgaWRsLktleWVkVW5pb24pOgorICAgICAgICAgICAg
IyBUT0RPCisgICAgICAgICAgICBwYXNzCisKKyAgICAgICAgZWxzZToKKyAgICAgICAgICAgIHJh
aXNlIEV4Y2VwdGlvbigndHlwZSB7fSBub3Qgc3VwcG9ydGVkJy5mb3JtYXQoZi50eXBlKSkKKwor
ICAgIGlmIG5vdCBuZXN0ZWQ6CisgICAgICAgIHMgKz0gJ3JldHVybiB4YywgbmlsJworICAgICAg
ICBzICs9ICd9XG4nCisKKyAgICByZXR1cm4gcworCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9u
YW1lKG5hbWUsIGV4cG9ydGVkID0gVHJ1ZSk6CiAgICAgIiIiCiAgICAgVGFrZSBhIGdpdmVuIHR5
cGUgbmFtZSBhbmQgcmV0dXJuIGFuCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQv
aGVscGVycy5nZW4uZ28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5k
ZXggMmY5MTdjYWM1OC4uYTE1NWIwOTFhNyAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxp
Z2h0L2hlbHBlcnMuZ2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdl
bi5nbwpAQCAtMzcsNiArMzcsMTMgQEAgZnVuYyAoeCAqSW9wb3J0UmFuZ2UpIGZyb21DKHhjICpD
LmxpYnhsX2lvcG9ydF9yYW5nZSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAq
SW9wb3J0UmFuZ2UpIHRvQygpICh4YyBDLmxpYnhsX2lvcG9ydF9yYW5nZSwgZXJyIGVycm9yKSB7
CisJQy5saWJ4bF9pb3BvcnRfcmFuZ2VfaW5pdCgmeGMpCisJeGMuZmlyc3QgPSBDLnVpbnQzMl90
KHguRmlyc3QpCisJeGMubnVtYmVyID0gQy51aW50MzJfdCh4Lk51bWJlcikKKwlyZXR1cm4geGMs
IG5pbAorfQorCiBmdW5jICh4ICpJb21lbVJhbmdlKSBmcm9tQyh4YyAqQy5saWJ4bF9pb21lbV9y
YW5nZSkgZXJyb3IgewogCXguU3RhcnQgPSB1aW50NjQoeGMuc3RhcnQpCiAJeC5OdW1iZXIgPSB1
aW50NjQoeGMubnVtYmVyKQpAQCAtNDUsMTIgKzUyLDI2IEBAIGZ1bmMgKHggKklvbWVtUmFuZ2Up
IGZyb21DKHhjICpDLmxpYnhsX2lvbWVtX3JhbmdlKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQog
CitmdW5jICh4ICpJb21lbVJhbmdlKSB0b0MoKSAoeGMgQy5saWJ4bF9pb21lbV9yYW5nZSwgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9pb21lbV9yYW5nZV9pbml0KCZ4YykKKwl4Yy5zdGFydCA9IEMu
dWludDY0X3QoeC5TdGFydCkKKwl4Yy5udW1iZXIgPSBDLnVpbnQ2NF90KHguTnVtYmVyKQorCXhj
LmdmbiA9IEMudWludDY0X3QoeC5HZm4pCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAq
VmdhSW50ZXJmYWNlSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmdhX2ludGVyZmFjZV9pbmZvKSBl
cnJvciB7CiAJeC5LaW5kID0gVmdhSW50ZXJmYWNlVHlwZSh4Yy5raW5kKQogCiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpWZ2FJbnRlcmZhY2VJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92Z2Ff
aW50ZXJmYWNlX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfdmdhX2ludGVyZmFjZV9pbmZv
X2luaXQoJnhjKQorCXhjLmtpbmQgPSBDLmxpYnhsX3ZnYV9pbnRlcmZhY2VfdHlwZSh4LktpbmQp
CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVm5jSW5mbykgZnJvbUMoeGMgKkMubGli
eGxfdm5jX2luZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0geC5FbmFibGUuZnJvbUMoJnhjLmVuYWJs
ZSk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZXJyCkBAIC02NSw2ICs4NiwyNCBAQCBmdW5jICh4
ICpWbmNJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bmNfaW5mbykgZXJyb3IgewogCXJldHVybiBu
aWwKIH0KIAorZnVuYyAoeCAqVm5jSW5mbykgdG9DKCkgKHhjIEMubGlieGxfdm5jX2luZm8sIGVy
ciBlcnJvcikgeworCUMubGlieGxfdm5jX2luZm9faW5pdCgmeGMpCisJeGMuZW5hYmxlLCBlcnIg
PSB4LkVuYWJsZS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3ZuY19pbmZvX2Rp
c3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5saXN0ZW4gPSBDLkNTdHJpbmco
eC5MaXN0ZW4pCisJeGMucGFzc3dkID0gQy5DU3RyaW5nKHguUGFzc3dkKQorCXhjLmRpc3BsYXkg
PSBDLmludCh4LkRpc3BsYXkpCisJeGMuZmluZHVudXNlZCwgZXJyID0geC5GaW5kdW51c2VkLnRv
QygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdm5jX2luZm9fZGlzcG9zZSgmeGMpCisJ
CXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlNwaWNl
SW5mbykgZnJvbUMoeGMgKkMubGlieGxfc3BpY2VfaW5mbykgZXJyb3IgewogCWlmIGVyciA6PSB4
LkVuYWJsZS5mcm9tQygmeGMuZW5hYmxlKTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBlcnIKQEAg
LTkyLDYgKzEzMSw0MyBAQCBmdW5jICh4ICpTcGljZUluZm8pIGZyb21DKHhjICpDLmxpYnhsX3Nw
aWNlX2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlNwaWNlSW5mbykg
dG9DKCkgKHhjIEMubGlieGxfc3BpY2VfaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9zcGlj
ZV9pbmZvX2luaXQoJnhjKQorCXhjLmVuYWJsZSwgZXJyID0geC5FbmFibGUudG9DKCkKKwlpZiBl
cnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9zcGljZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4g
eGMsIGVycgorCX0KKwl4Yy5wb3J0ID0gQy5pbnQoeC5Qb3J0KQorCXhjLnRsc19wb3J0ID0gQy5p
bnQoeC5UbHNQb3J0KQorCXhjLmhvc3QgPSBDLkNTdHJpbmcoeC5Ib3N0KQorCXhjLmRpc2FibGVf
dGlja2V0aW5nLCBlcnIgPSB4LkRpc2FibGVUaWNrZXRpbmcudG9DKCkKKwlpZiBlcnIgIT0gbmls
IHsKKwkJQy5saWJ4bF9zcGljZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy5wYXNzd2QgPSBDLkNTdHJpbmcoeC5QYXNzd2QpCisJeGMuYWdlbnRfbW91c2UsIGVy
ciA9IHguQWdlbnRNb3VzZS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3NwaWNl
X2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnZkYWdlbnQsIGVy
ciA9IHguVmRhZ2VudC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3NwaWNlX2lu
Zm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmNsaXBib2FyZF9zaGFy
aW5nLCBlcnIgPSB4LkNsaXBib2FyZFNoYXJpbmcudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJ
Qy5saWJ4bF9zcGljZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4
Yy51c2JyZWRpcmVjdGlvbiA9IEMuaW50KHguVXNicmVkaXJlY3Rpb24pCisJeGMuaW1hZ2VfY29t
cHJlc3Npb24gPSBDLkNTdHJpbmcoeC5JbWFnZUNvbXByZXNzaW9uKQorCXhjLnN0cmVhbWluZ192
aWRlbyA9IEMuQ1N0cmluZyh4LlN0cmVhbWluZ1ZpZGVvKQorCXJldHVybiB4YywgbmlsCit9CisK
IGZ1bmMgKHggKlNkbEluZm8pIGZyb21DKHhjICpDLmxpYnhsX3NkbF9pbmZvKSBlcnJvciB7CiAJ
aWYgZXJyIDo9IHguRW5hYmxlLmZyb21DKCZ4Yy5lbmFibGUpOyBlcnIgIT0gbmlsIHsKIAkJcmV0
dXJuIGVycgpAQCAtMTA1LDYgKzE4MSwyMyBAQCBmdW5jICh4ICpTZGxJbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF9zZGxfaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqU2Rs
SW5mbykgdG9DKCkgKHhjIEMubGlieGxfc2RsX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxf
c2RsX2luZm9faW5pdCgmeGMpCisJeGMuZW5hYmxlLCBlcnIgPSB4LkVuYWJsZS50b0MoKQorCWlm
IGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3NkbF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4g
eGMsIGVycgorCX0KKwl4Yy5vcGVuZ2wsIGVyciA9IHguT3BlbmdsLnRvQygpCisJaWYgZXJyICE9
IG5pbCB7CisJCUMubGlieGxfc2RsX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJy
CisJfQorCXhjLmRpc3BsYXkgPSBDLkNTdHJpbmcoeC5EaXNwbGF5KQorCXhjLnhhdXRob3JpdHkg
PSBDLkNTdHJpbmcoeC5YYXV0aG9yaXR5KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHgg
KkRvbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWluZm8pIGVycm9yIHsKIAlpZiBlcnIgOj0g
eC5VdWlkLmZyb21DKCZ4Yy51dWlkKTsgZXJyICE9IG5pbCB7CiAJCXJldHVybiBlcnIKQEAgLTEz
Myw2ICsyMjYsMzYgQEAgZnVuYyAoeCAqRG9taW5mbykgZnJvbUMoeGMgKkMubGlieGxfZG9taW5m
bykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRG9taW5mbykgdG9DKCkgKHhj
IEMubGlieGxfZG9taW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kb21pbmZvX2luaXQoJnhj
KQorCXhjLnV1aWQsIGVyciA9IHguVXVpZC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxp
YnhsX2RvbWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmRvbWlk
ID0gQy5saWJ4bF9kb21pZCh4LkRvbWlkKQorCXhjLnNzaWRyZWYgPSBDLnVpbnQzMl90KHguU3Np
ZHJlZikKKwl4Yy5zc2lkX2xhYmVsID0gQy5DU3RyaW5nKHguU3NpZExhYmVsKQorCXhjLnJ1bm5p
bmcgPSBDLmJvb2woeC5SdW5uaW5nKQorCXhjLmJsb2NrZWQgPSBDLmJvb2woeC5CbG9ja2VkKQor
CXhjLnBhdXNlZCA9IEMuYm9vbCh4LlBhdXNlZCkKKwl4Yy5zaHV0ZG93biA9IEMuYm9vbCh4LlNo
dXRkb3duKQorCXhjLmR5aW5nID0gQy5ib29sKHguRHlpbmcpCisJeGMubmV2ZXJfc3RvcCA9IEMu
Ym9vbCh4Lk5ldmVyU3RvcCkKKwl4Yy5zaHV0ZG93bl9yZWFzb24gPSBDLmxpYnhsX3NodXRkb3du
X3JlYXNvbih4LlNodXRkb3duUmVhc29uKQorCXhjLm91dHN0YW5kaW5nX21lbWtiID0gQy51aW50
NjRfdCh4Lk91dHN0YW5kaW5nTWVta2IpCisJeGMuY3VycmVudF9tZW1rYiA9IEMudWludDY0X3Qo
eC5DdXJyZW50TWVta2IpCisJeGMuc2hhcmVkX21lbWtiID0gQy51aW50NjRfdCh4LlNoYXJlZE1l
bWtiKQorCXhjLnBhZ2VkX21lbWtiID0gQy51aW50NjRfdCh4LlBhZ2VkTWVta2IpCisJeGMubWF4
X21lbWtiID0gQy51aW50NjRfdCh4Lk1heE1lbWtiKQorCXhjLmNwdV90aW1lID0gQy51aW50NjRf
dCh4LkNwdVRpbWUpCisJeGMudmNwdV9tYXhfaWQgPSBDLnVpbnQzMl90KHguVmNwdU1heElkKQor
CXhjLnZjcHVfb25saW5lID0gQy51aW50MzJfdCh4LlZjcHVPbmxpbmUpCisJeGMuY3B1cG9vbCA9
IEMudWludDMyX3QoeC5DcHVwb29sKQorCXhjLmRvbWFpbl90eXBlID0gQy5saWJ4bF9kb21haW5f
dHlwZSh4LkRvbWFpblR5cGUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqQ3B1cG9v
bGluZm8pIGZyb21DKHhjICpDLmxpYnhsX2NwdXBvb2xpbmZvKSBlcnJvciB7CiAJeC5Qb29saWQg
PSB1aW50MzIoeGMucG9vbGlkKQogCXguUG9vbE5hbWUgPSBDLkdvU3RyaW5nKHhjLnBvb2xfbmFt
ZSkKQEAgLTE0NSw2ICsyNjgsMjAgQEAgZnVuYyAoeCAqQ3B1cG9vbGluZm8pIGZyb21DKHhjICpD
LmxpYnhsX2NwdXBvb2xpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpD
cHVwb29saW5mbykgdG9DKCkgKHhjIEMubGlieGxfY3B1cG9vbGluZm8sIGVyciBlcnJvcikgewor
CUMubGlieGxfY3B1cG9vbGluZm9faW5pdCgmeGMpCisJeGMucG9vbGlkID0gQy51aW50MzJfdCh4
LlBvb2xpZCkKKwl4Yy5wb29sX25hbWUgPSBDLkNTdHJpbmcoeC5Qb29sTmFtZSkKKwl4Yy5zY2hl
ZCA9IEMubGlieGxfc2NoZWR1bGVyKHguU2NoZWQpCisJeGMubl9kb20gPSBDLnVpbnQzMl90KHgu
TkRvbSkKKwl4Yy5jcHVtYXAsIGVyciA9IHguQ3B1bWFwLnRvQygpCisJaWYgZXJyICE9IG5pbCB7
CisJCUMubGlieGxfY3B1cG9vbGluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJ
fQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkNoYW5uZWxpbmZvKSBmcm9tQyh4YyAq
Qy5saWJ4bF9jaGFubmVsaW5mbykgZXJyb3IgewogCXguQmFja2VuZCA9IEMuR29TdHJpbmcoeGMu
YmFja2VuZCkKIAl4LkJhY2tlbmRJZCA9IHVpbnQzMih4Yy5iYWNrZW5kX2lkKQpAQCAtMTc5LDYg
KzMxNiwxOSBAQCBmdW5jICh4ICpDaGFubmVsaW5mb0Nvbm5lY3Rpb25VbmlvblB0eSkgZnJvbUMo
eGMgKkMubGlieGxfY2hhbm5lbGluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMg
KHggKkNoYW5uZWxpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9jaGFubmVsaW5mbywgZXJyIGVycm9y
KSB7CisJQy5saWJ4bF9jaGFubmVsaW5mb19pbml0KCZ4YykKKwl4Yy5iYWNrZW5kID0gQy5DU3Ry
aW5nKHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJZCkK
Kwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lkID0g
Qy51aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2
aWQpCisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5FdnRj
aCkKKwl4Yy5ycmVmID0gQy5pbnQoeC5ScmVmKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMg
KHggKlZtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm1pbmZvKSBlcnJvciB7CiAJaWYgZXJyIDo9
IHguVXVpZC5mcm9tQygmeGMudXVpZCk7IGVyciAhPSBuaWwgewogCQlyZXR1cm4gZXJyCkBAIC0x
ODgsNiArMzM4LDE3IEBAIGZ1bmMgKHggKlZtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdm1pbmZv
KSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWbWluZm8pIHRvQygpICh4YyBD
LmxpYnhsX3ZtaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92bWluZm9faW5pdCgmeGMpCisJ
eGMudXVpZCwgZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxf
dm1pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5Eb21pZCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWZXJz
aW9uSW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmVyc2lvbl9pbmZvKSBlcnJvciB7CiAJeC5YZW5W
ZXJzaW9uTWFqb3IgPSBpbnQoeGMueGVuX3ZlcnNpb25fbWFqb3IpCiAJeC5YZW5WZXJzaW9uTWlu
b3IgPSBpbnQoeGMueGVuX3ZlcnNpb25fbWlub3IpCkBAIC0yMDYsNiArMzY3LDI0IEBAIGZ1bmMg
KHggKlZlcnNpb25JbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92ZXJzaW9uX2luZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZlcnNpb25JbmZvKSB0b0MoKSAoeGMgQy5saWJ4
bF92ZXJzaW9uX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfdmVyc2lvbl9pbmZvX2luaXQo
JnhjKQorCXhjLnhlbl92ZXJzaW9uX21ham9yID0gQy5pbnQoeC5YZW5WZXJzaW9uTWFqb3IpCisJ
eGMueGVuX3ZlcnNpb25fbWlub3IgPSBDLmludCh4LlhlblZlcnNpb25NaW5vcikKKwl4Yy54ZW5f
dmVyc2lvbl9leHRyYSA9IEMuQ1N0cmluZyh4LlhlblZlcnNpb25FeHRyYSkKKwl4Yy5jb21waWxl
ciA9IEMuQ1N0cmluZyh4LkNvbXBpbGVyKQorCXhjLmNvbXBpbGVfYnkgPSBDLkNTdHJpbmcoeC5D
b21waWxlQnkpCisJeGMuY29tcGlsZV9kb21haW4gPSBDLkNTdHJpbmcoeC5Db21waWxlRG9tYWlu
KQorCXhjLmNvbXBpbGVfZGF0ZSA9IEMuQ1N0cmluZyh4LkNvbXBpbGVEYXRlKQorCXhjLmNhcGFi
aWxpdGllcyA9IEMuQ1N0cmluZyh4LkNhcGFiaWxpdGllcykKKwl4Yy5jaGFuZ2VzZXQgPSBDLkNT
dHJpbmcoeC5DaGFuZ2VzZXQpCisJeGMudmlydF9zdGFydCA9IEMudWludDY0X3QoeC5WaXJ0U3Rh
cnQpCisJeGMucGFnZXNpemUgPSBDLmludCh4LlBhZ2VzaXplKQorCXhjLmNvbW1hbmRsaW5lID0g
Qy5DU3RyaW5nKHguQ29tbWFuZGxpbmUpCisJeGMuYnVpbGRfaWQgPSBDLkNTdHJpbmcoeC5CdWls
ZElkKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpbkNyZWF0ZUluZm8pIGZy
b21DKHhjICpDLmxpYnhsX2RvbWFpbl9jcmVhdGVfaW5mbykgZXJyb3IgewogCXguVHlwZSA9IERv
bWFpblR5cGUoeGMuX3R5cGUpCiAJaWYgZXJyIDo9IHguSGFwLmZyb21DKCZ4Yy5oYXApOyBlcnIg
IT0gbmlsIHsKQEAgLTIzOSw2ICs0MTgsNTMgQEAgZnVuYyAoeCAqRG9tYWluQ3JlYXRlSW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpEb21haW5DcmVhdGVJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21h
aW5fY3JlYXRlX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfZG9tYWluX2NyZWF0ZV9pbmZv
X2luaXQoJnhjKQorCXhjLl90eXBlID0gQy5saWJ4bF9kb21haW5fdHlwZSh4LlR5cGUpCisJeGMu
aGFwLCBlcnIgPSB4LkhhcC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFp
bl9jcmVhdGVfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMub29z
LCBlcnIgPSB4Lk9vcy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9j
cmVhdGVfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuc3NpZHJl
ZiA9IEMudWludDMyX3QoeC5Tc2lkcmVmKQorCXhjLnNzaWRfbGFiZWwgPSBDLkNTdHJpbmcoeC5T
c2lkTGFiZWwpCisJeGMubmFtZSA9IEMuQ1N0cmluZyh4Lk5hbWUpCisJeGMudXVpZCwgZXJyID0g
eC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2NyZWF0ZV9p
bmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy54c2RhdGEsIGVyciA9
IHguWHNkYXRhLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2NyZWF0
ZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5wbGF0Zm9ybWRh
dGEsIGVyciA9IHguUGxhdGZvcm1kYXRhLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGli
eGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0K
Kwl4Yy5wb29saWQgPSBDLnVpbnQzMl90KHguUG9vbGlkKQorCXhjLnBvb2xfbmFtZSA9IEMuQ1N0
cmluZyh4LlBvb2xOYW1lKQorCXhjLnJ1bl9ob3RwbHVnX3NjcmlwdHMsIGVyciA9IHguUnVuSG90
cGx1Z1NjcmlwdHMudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fY3Jl
YXRlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmRyaXZlcl9k
b21haW4sIGVyciA9IHguRHJpdmVyRG9tYWluLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMu
bGlieGxfZG9tYWluX2NyZWF0ZV9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy5wYXNzdGhyb3VnaCA9IEMubGlieGxfcGFzc3Rocm91Z2goeC5QYXNzdGhyb3VnaCkK
KwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEb21haW5SZXN0b3JlUGFyYW1zKSBmcm9t
Qyh4YyAqQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXMpIGVycm9yIHsKIAl4LkNoZWNrcG9p
bnRlZFN0cmVhbSA9IGludCh4Yy5jaGVja3BvaW50ZWRfc3RyZWFtKQogCXguU3RyZWFtVmVyc2lv
biA9IHVpbnQzMih4Yy5zdHJlYW1fdmVyc2lvbikKQEAgLTI1MCw2ICs0NzYsMTkgQEAgZnVuYyAo
eCAqRG9tYWluUmVzdG9yZVBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX3Jlc3RvcmVf
cGFyYW1zKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEb21haW5SZXN0b3Jl
UGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21haW5fcmVzdG9yZV9wYXJhbXMsIGVyciBlcnJv
cikgeworCUMubGlieGxfZG9tYWluX3Jlc3RvcmVfcGFyYW1zX2luaXQoJnhjKQorCXhjLmNoZWNr
cG9pbnRlZF9zdHJlYW0gPSBDLmludCh4LkNoZWNrcG9pbnRlZFN0cmVhbSkKKwl4Yy5zdHJlYW1f
dmVyc2lvbiA9IEMudWludDMyX3QoeC5TdHJlYW1WZXJzaW9uKQorCXhjLmNvbG9fcHJveHlfc2Ny
aXB0ID0gQy5DU3RyaW5nKHguQ29sb1Byb3h5U2NyaXB0KQorCXhjLnVzZXJzcGFjZV9jb2xvX3By
b3h5LCBlcnIgPSB4LlVzZXJzcGFjZUNvbG9Qcm94eS50b0MoKQorCWlmIGVyciAhPSBuaWwgewor
CQlDLmxpYnhsX2RvbWFpbl9yZXN0b3JlX3BhcmFtc19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhj
LCBlcnIKKwl9CisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqU2NoZWRQYXJhbXMpIGZy
b21DKHhjICpDLmxpYnhsX3NjaGVkX3BhcmFtcykgZXJyb3IgewogCXguVmNwdWlkID0gaW50KHhj
LnZjcHVpZCkKIAl4LldlaWdodCA9IGludCh4Yy53ZWlnaHQpCkBAIC0yNjEsNiArNTAwLDE3IEBA
IGZ1bmMgKHggKlNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9zY2hlZF9wYXJhbXMpIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlNjaGVkUGFyYW1zKSB0b0MoKSAoeGMg
Qy5saWJ4bF9zY2hlZF9wYXJhbXMsIGVyciBlcnJvcikgeworCUMubGlieGxfc2NoZWRfcGFyYW1z
X2luaXQoJnhjKQorCXhjLnZjcHVpZCA9IEMuaW50KHguVmNwdWlkKQorCXhjLndlaWdodCA9IEMu
aW50KHguV2VpZ2h0KQorCXhjLmNhcCA9IEMuaW50KHguQ2FwKQorCXhjLnBlcmlvZCA9IEMuaW50
KHguUGVyaW9kKQorCXhjLmV4dHJhdGltZSA9IEMuaW50KHguRXh0cmF0aW1lKQorCXhjLmJ1ZGdl
dCA9IEMuaW50KHguQnVkZ2V0KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZjcHVT
Y2hlZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXMpIGVycm9yIHsK
IAl4LlNjaGVkID0gU2NoZWR1bGVyKHhjLnNjaGVkKQogCW51bVZjcHVzIDo9IGludCh4Yy5udW1f
dmNwdXMpCkBAIC0yNzcsNiArNTI3LDEyIEBAIGZ1bmMgKHggKlZjcHVTY2hlZFBhcmFtcykgZnJv
bUMoeGMgKkMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9
CiAKK2Z1bmMgKHggKlZjcHVTY2hlZFBhcmFtcykgdG9DKCkgKHhjIEMubGlieGxfdmNwdV9zY2hl
ZF9wYXJhbXMsIGVyciBlcnJvcikgeworCUMubGlieGxfdmNwdV9zY2hlZF9wYXJhbXNfaW5pdCgm
eGMpCisJeGMuc2NoZWQgPSBDLmxpYnhsX3NjaGVkdWxlcih4LlNjaGVkKQorCXJldHVybiB4Yywg
bmlsCit9CisKIGZ1bmMgKHggKkRvbWFpblNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9k
b21haW5fc2NoZWRfcGFyYW1zKSBlcnJvciB7CiAJeC5TY2hlZCA9IFNjaGVkdWxlcih4Yy5zY2hl
ZCkKIAl4LldlaWdodCA9IGludCh4Yy53ZWlnaHQpCkBAIC0yOTAsNiArNTQ2LDE5IEBAIGZ1bmMg
KHggKkRvbWFpblNjaGVkUGFyYW1zKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fc2NoZWRfcGFy
YW1zKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEb21haW5TY2hlZFBhcmFt
cykgdG9DKCkgKHhjIEMubGlieGxfZG9tYWluX3NjaGVkX3BhcmFtcywgZXJyIGVycm9yKSB7CisJ
Qy5saWJ4bF9kb21haW5fc2NoZWRfcGFyYW1zX2luaXQoJnhjKQorCXhjLnNjaGVkID0gQy5saWJ4
bF9zY2hlZHVsZXIoeC5TY2hlZCkKKwl4Yy53ZWlnaHQgPSBDLmludCh4LldlaWdodCkKKwl4Yy5j
YXAgPSBDLmludCh4LkNhcCkKKwl4Yy5wZXJpb2QgPSBDLmludCh4LlBlcmlvZCkKKwl4Yy5idWRn
ZXQgPSBDLmludCh4LkJ1ZGdldCkKKwl4Yy5leHRyYXRpbWUgPSBDLmludCh4LkV4dHJhdGltZSkK
Kwl4Yy5zbGljZSA9IEMuaW50KHguU2xpY2UpCisJeGMubGF0ZW5jeSA9IEMuaW50KHguTGF0ZW5j
eSkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWbm9kZUluZm8pIGZyb21DKHhjICpD
LmxpYnhsX3Zub2RlX2luZm8pIGVycm9yIHsKIAl4Lk1lbWtiID0gdWludDY0KHhjLm1lbWtiKQog
CW51bURpc3RhbmNlcyA6PSBpbnQoeGMubnVtX2Rpc3RhbmNlcykKQEAgLTMwNiw2ICs1NzUsMTgg
QEAgZnVuYyAoeCAqVm5vZGVJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92bm9kZV9pbmZvKSBlcnJv
ciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpWbm9kZUluZm8pIHRvQygpICh4YyBDLmxp
YnhsX3Zub2RlX2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfdm5vZGVfaW5mb19pbml0KCZ4
YykKKwl4Yy5tZW1rYiA9IEMudWludDY0X3QoeC5NZW1rYikKKwl4Yy5wbm9kZSA9IEMudWludDMy
X3QoeC5Qbm9kZSkKKwl4Yy52Y3B1cywgZXJyID0geC5WY3B1cy50b0MoKQorCWlmIGVyciAhPSBu
aWwgeworCQlDLmxpYnhsX3Zub2RlX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJy
CisJfQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlJkbVJlc2VydmUpIGZyb21DKHhj
ICpDLmxpYnhsX3JkbV9yZXNlcnZlKSBlcnJvciB7CiAJeC5TdHJhdGVneSA9IFJkbVJlc2VydmVT
dHJhdGVneSh4Yy5zdHJhdGVneSkKIAl4LlBvbGljeSA9IFJkbVJlc2VydmVQb2xpY3koeGMucG9s
aWN5KQpAQCAtMzEzLDYgKzU5NCwxMyBAQCBmdW5jICh4ICpSZG1SZXNlcnZlKSBmcm9tQyh4YyAq
Qy5saWJ4bF9yZG1fcmVzZXJ2ZSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAq
UmRtUmVzZXJ2ZSkgdG9DKCkgKHhjIEMubGlieGxfcmRtX3Jlc2VydmUsIGVyciBlcnJvcikgewor
CUMubGlieGxfcmRtX3Jlc2VydmVfaW5pdCgmeGMpCisJeGMuc3RyYXRlZ3kgPSBDLmxpYnhsX3Jk
bV9yZXNlcnZlX3N0cmF0ZWd5KHguU3RyYXRlZ3kpCisJeGMucG9saWN5ID0gQy5saWJ4bF9yZG1f
cmVzZXJ2ZV9wb2xpY3koeC5Qb2xpY3kpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAq
RG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykgZXJy
b3IgewogCXguTWF4VmNwdXMgPSBpbnQoeGMubWF4X3ZjcHVzKQogCWlmIGVyciA6PSB4LkF2YWls
VmNwdXMuZnJvbUMoJnhjLmF2YWlsX3ZjcHVzKTsgZXJyICE9IG5pbCB7CkBAIC02MjUsNiArOTEz
LDEzMCBAQCBmdW5jICh4ICpEb21haW5CdWlsZEluZm9UeXBlVW5pb25QdmgpIGZyb21DKHhjICpD
LmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvKSBlcnJvcgogCXJldHVybiBuaWwKIH0KIAorZnVuYyAo
eCAqRG9tYWluQnVpbGRJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbywg
ZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19pbml0KCZ4YykKKwl4Yy5t
YXhfdmNwdXMgPSBDLmludCh4Lk1heFZjcHVzKQorCXhjLmF2YWlsX3ZjcHVzLCBlcnIgPSB4LkF2
YWlsVmNwdXMudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRf
aW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY3B1bWFwLCBlcnIg
PSB4LkNwdW1hcC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWls
ZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5ub2RlbWFwLCBl
cnIgPSB4Lk5vZGVtYXAudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5f
YnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMubnVtYV9w
bGFjZW1lbnQsIGVyciA9IHguTnVtYVBsYWNlbWVudC50b0MoKQorCWlmIGVyciAhPSBuaWwgewor
CQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVy
cgorCX0KKwl4Yy50c2NfbW9kZSA9IEMubGlieGxfdHNjX21vZGUoeC5Uc2NNb2RlKQorCXhjLm1h
eF9tZW1rYiA9IEMudWludDY0X3QoeC5NYXhNZW1rYikKKwl4Yy50YXJnZXRfbWVta2IgPSBDLnVp
bnQ2NF90KHguVGFyZ2V0TWVta2IpCisJeGMudmlkZW9fbWVta2IgPSBDLnVpbnQ2NF90KHguVmlk
ZW9NZW1rYikKKwl4Yy5zaGFkb3dfbWVta2IgPSBDLnVpbnQ2NF90KHguU2hhZG93TWVta2IpCisJ
eGMuaW9tbXVfbWVta2IgPSBDLnVpbnQ2NF90KHguSW9tbXVNZW1rYikKKwl4Yy5ydGNfdGltZW9m
ZnNldCA9IEMudWludDMyX3QoeC5SdGNUaW1lb2Zmc2V0KQorCXhjLmV4ZWNfc3NpZHJlZiA9IEMu
dWludDMyX3QoeC5FeGVjU3NpZHJlZikKKwl4Yy5leGVjX3NzaWRfbGFiZWwgPSBDLkNTdHJpbmco
eC5FeGVjU3NpZExhYmVsKQorCXhjLmxvY2FsdGltZSwgZXJyID0geC5Mb2NhbHRpbWUudG9DKCkK
KwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4
YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZGlzYWJsZV9taWdyYXRlLCBlcnIgPSB4LkRp
c2FibGVNaWdyYXRlLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1
aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmNwdWlkLCBl
cnIgPSB4LkNwdWlkLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1
aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmJsa2Rldl9z
dGFydCA9IEMuQ1N0cmluZyh4LkJsa2RldlN0YXJ0KQorCXhjLm1heF9ncmFudF9mcmFtZXMgPSBD
LnVpbnQzMl90KHguTWF4R3JhbnRGcmFtZXMpCisJeGMubWF4X21hcHRyYWNrX2ZyYW1lcyA9IEMu
dWludDMyX3QoeC5NYXhNYXB0cmFja0ZyYW1lcykKKwl4Yy5kZXZpY2VfbW9kZWxfdmVyc2lvbiA9
IEMubGlieGxfZGV2aWNlX21vZGVsX3ZlcnNpb24oeC5EZXZpY2VNb2RlbFZlcnNpb24pCisJeGMu
ZGV2aWNlX21vZGVsX3N0dWJkb21haW4sIGVyciA9IHguRGV2aWNlTW9kZWxTdHViZG9tYWluLnRv
QygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9z
ZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmRldmljZV9tb2RlbCA9IEMuQ1N0cmlu
Zyh4LkRldmljZU1vZGVsKQorCXhjLmRldmljZV9tb2RlbF9zc2lkcmVmID0gQy51aW50MzJfdCh4
LkRldmljZU1vZGVsU3NpZHJlZikKKwl4Yy5kZXZpY2VfbW9kZWxfc3NpZF9sYWJlbCA9IEMuQ1N0
cmluZyh4LkRldmljZU1vZGVsU3NpZExhYmVsKQorCXhjLmRldmljZV9tb2RlbF91c2VyID0gQy5D
U3RyaW5nKHguRGV2aWNlTW9kZWxVc2VyKQorCXhjLmV4dHJhLCBlcnIgPSB4LkV4dHJhLnRvQygp
CisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9zZSgm
eGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmV4dHJhX3B2LCBlcnIgPSB4LkV4dHJhUHYu
dG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNw
b3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZXh0cmFfaHZtLCBlcnIgPSB4LkV4
dHJhSHZtLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2lu
Zm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnNjaGVkX3BhcmFtcywg
ZXJyID0geC5TY2hlZFBhcmFtcy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2Rv
bWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5j
bGFpbV9tb2RlLCBlcnIgPSB4LkNsYWltTW9kZS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlD
LmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgor
CX0KKwl4Yy5ldmVudF9jaGFubmVscyA9IEMudWludDMyX3QoeC5FdmVudENoYW5uZWxzKQorCXhj
Lmtlcm5lbCA9IEMuQ1N0cmluZyh4Lktlcm5lbCkKKwl4Yy5jbWRsaW5lID0gQy5DU3RyaW5nKHgu
Q21kbGluZSkKKwl4Yy5yYW1kaXNrID0gQy5DU3RyaW5nKHguUmFtZGlzaykKKwl4Yy5kZXZpY2Vf
dHJlZSA9IEMuQ1N0cmluZyh4LkRldmljZVRyZWUpCisJeGMuYWNwaSwgZXJyID0geC5BY3BpLnRv
QygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fZGlzcG9z
ZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmJvb3Rsb2FkZXIgPSBDLkNTdHJpbmco
eC5Cb290bG9hZGVyKQorCXhjLmJvb3Rsb2FkZXJfYXJncywgZXJyID0geC5Cb290bG9hZGVyQXJn
cy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rp
c3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy50aW1lcl9tb2RlID0gQy5saWJ4
bF90aW1lcl9tb2RlKHguVGltZXJNb2RlKQorCXhjLm5lc3RlZF9odm0sIGVyciA9IHguTmVzdGVk
SHZtLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9f
ZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLmFwaWMsIGVyciA9IHguQXBp
Yy50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rp
c3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5kbV9yZXN0cmljdCwgZXJyID0g
eC5EbVJlc3RyaWN0LnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2J1
aWxkX2luZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLnRlZSA9IEMu
bGlieGxfdGVlX3R5cGUoeC5UZWUpCisJeGMuYXJjaF9hcm0uZ2ljX3ZlcnNpb24gPSBDLmxpYnhs
X2dpY192ZXJzaW9uKHguQXJjaEFybS5HaWNWZXJzaW9uKQorCXhjLmFyY2hfYXJtLnZ1YXJ0ID0g
Qy5saWJ4bF92dWFydF90eXBlKHguQXJjaEFybS5WdWFydCkKKwl4Yy5hbHRwMm0gPSBDLmxpYnhs
X2FsdHAybV9tb2RlKHguQWx0cDJNKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRl
dmljZVZmYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZmYikgZXJyb3IgewogCXguQmFja2Vu
ZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5H
b1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC02NDAsNiArMTA1MiwyNSBAQCBmdW5jICh4
ICpEZXZpY2VWZmIpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92ZmIpIGVycm9yIHsKIAlyZXR1
cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVZmYikgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNl
X3ZmYiwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdmZiX2luaXQoJnhjKQorCXhjLmJh
Y2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQorCXhjLmJhY2tlbmRf
ZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhjLmRldmlkID0gQy5saWJ4
bF9kZXZpZCh4LkRldmlkKQorCXhjLnZuYywgZXJyID0geC5WbmMudG9DKCkKKwlpZiBlcnIgIT0g
bmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfdmZiX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVy
cgorCX0KKwl4Yy5zZGwsIGVyciA9IHguU2RsLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMu
bGlieGxfZGV2aWNlX3ZmYl9kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMu
a2V5bWFwID0gQy5DU3RyaW5nKHguS2V5bWFwKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMg
KHggKkRldmljZVZrYikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3ZrYikgZXJyb3IgewogCXgu
QmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1l
ID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC02NjAsNiArMTA5MSwyNiBAQCBm
dW5jICh4ICpEZXZpY2VWa2IpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV92a2IpIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZVZrYikgdG9DKCkgKHhjIEMubGlieGxf
ZGV2aWNlX3ZrYiwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9kZXZpY2VfdmtiX2luaXQoJnhjKQor
CXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlkKQorCXhjLmJh
Y2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhjLmRldmlkID0g
Qy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLmJhY2tlbmRfdHlwZSA9IEMubGlieGxfdmtiX2Jh
Y2tlbmQoeC5CYWNrZW5kVHlwZSkKKwl4Yy51bmlxdWVfaWQgPSBDLkNTdHJpbmcoeC5VbmlxdWVJ
ZCkKKwl4Yy5mZWF0dXJlX2Rpc2FibGVfa2V5Ym9hcmQgPSBDLmJvb2woeC5GZWF0dXJlRGlzYWJs
ZUtleWJvYXJkKQorCXhjLmZlYXR1cmVfZGlzYWJsZV9wb2ludGVyID0gQy5ib29sKHguRmVhdHVy
ZURpc2FibGVQb2ludGVyKQorCXhjLmZlYXR1cmVfYWJzX3BvaW50ZXIgPSBDLmJvb2woeC5GZWF0
dXJlQWJzUG9pbnRlcikKKwl4Yy5mZWF0dXJlX3Jhd19wb2ludGVyID0gQy5ib29sKHguRmVhdHVy
ZVJhd1BvaW50ZXIpCisJeGMuZmVhdHVyZV9tdWx0aV90b3VjaCA9IEMuYm9vbCh4LkZlYXR1cmVN
dWx0aVRvdWNoKQorCXhjLndpZHRoID0gQy51aW50MzJfdCh4LldpZHRoKQorCXhjLmhlaWdodCA9
IEMudWludDMyX3QoeC5IZWlnaHQpCisJeGMubXVsdGlfdG91Y2hfd2lkdGggPSBDLnVpbnQzMl90
KHguTXVsdGlUb3VjaFdpZHRoKQorCXhjLm11bHRpX3RvdWNoX2hlaWdodCA9IEMudWludDMyX3Qo
eC5NdWx0aVRvdWNoSGVpZ2h0KQorCXhjLm11bHRpX3RvdWNoX251bV9jb250YWN0cyA9IEMudWlu
dDMyX3QoeC5NdWx0aVRvdWNoTnVtQ29udGFjdHMpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVu
YyAoeCAqRGV2aWNlRGlzaykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX2Rpc2spIGVycm9yIHsK
IAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9t
bmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1lKQpAQCAtNjkwLDYgKzExNDEsNDIg
QEAgZnVuYyAoeCAqRGV2aWNlRGlzaykgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX2Rpc2spIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkRldmljZURpc2spIHRvQygpICh4YyBD
LmxpYnhsX2RldmljZV9kaXNrLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RldmljZV9kaXNrX2lu
aXQoJnhjKQorCXhjLmJhY2tlbmRfZG9taWQgPSBDLmxpYnhsX2RvbWlkKHguQmFja2VuZERvbWlk
KQorCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1lKQorCXhj
LnBkZXZfcGF0aCA9IEMuQ1N0cmluZyh4LlBkZXZQYXRoKQorCXhjLnZkZXYgPSBDLkNTdHJpbmco
eC5WZGV2KQorCXhjLmJhY2tlbmQgPSBDLmxpYnhsX2Rpc2tfYmFja2VuZCh4LkJhY2tlbmQpCisJ
eGMuZm9ybWF0ID0gQy5saWJ4bF9kaXNrX2Zvcm1hdCh4LkZvcm1hdCkKKwl4Yy5zY3JpcHQgPSBD
LkNTdHJpbmcoeC5TY3JpcHQpCisJeGMucmVtb3ZhYmxlID0gQy5pbnQoeC5SZW1vdmFibGUpCisJ
eGMucmVhZHdyaXRlID0gQy5pbnQoeC5SZWFkd3JpdGUpCisJeGMuaXNfY2Ryb20gPSBDLmludCh4
LklzQ2Ryb20pCisJeGMuZGlyZWN0X2lvX3NhZmUgPSBDLmJvb2woeC5EaXJlY3RJb1NhZmUpCisJ
eGMuZGlzY2FyZF9lbmFibGUsIGVyciA9IHguRGlzY2FyZEVuYWJsZS50b0MoKQorCWlmIGVyciAh
PSBuaWwgeworCQlDLmxpYnhsX2RldmljZV9kaXNrX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMs
IGVycgorCX0KKwl4Yy5jb2xvX2VuYWJsZSwgZXJyID0geC5Db2xvRW5hYmxlLnRvQygpCisJaWYg
ZXJyICE9IG5pbCB7CisJCUMubGlieGxfZGV2aWNlX2Rpc2tfZGlzcG9zZSgmeGMpCisJCXJldHVy
biB4YywgZXJyCisJfQorCXhjLmNvbG9fcmVzdG9yZV9lbmFibGUsIGVyciA9IHguQ29sb1Jlc3Rv
cmVFbmFibGUudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kZXZpY2VfZGlza19k
aXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY29sb19ob3N0ID0gQy5DU3Ry
aW5nKHguQ29sb0hvc3QpCisJeGMuY29sb19wb3J0ID0gQy5pbnQoeC5Db2xvUG9ydCkKKwl4Yy5j
b2xvX2V4cG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9FeHBvcnQpCisJeGMuYWN0aXZlX2Rpc2sgPSBD
LkNTdHJpbmcoeC5BY3RpdmVEaXNrKQorCXhjLmhpZGRlbl9kaXNrID0gQy5DU3RyaW5nKHguSGlk
ZGVuRGlzaykKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VOaWMpIGZyb21D
KHhjICpDLmxpYnhsX2RldmljZV9uaWMpIGVycm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlk
KHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZF9kb21uYW1lKQpAQCAtNzYwLDYgKzEyNDcsNzggQEAgZnVuYyAoeCAqRGV2aWNlTmljKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfbmljKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpEZXZpY2VOaWMpIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV9uaWMsIGVyciBlcnJv
cikgeworCUMubGlieGxfZGV2aWNlX25pY19pbml0KCZ4YykKKwl4Yy5iYWNrZW5kX2RvbWlkID0g
Qy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNrZW5kX2RvbW5hbWUgPSBDLkNT
dHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZp
ZCkKKwl4Yy5tdHUgPSBDLmludCh4Lk10dSkKKwl4Yy5tb2RlbCA9IEMuQ1N0cmluZyh4Lk1vZGVs
KQorCXhjLm1hYywgZXJyID0geC5NYWMudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJQy5saWJ4
bF9kZXZpY2VfbmljX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5pcCA9
IEMuQ1N0cmluZyh4LklwKQorCXhjLmJyaWRnZSA9IEMuQ1N0cmluZyh4LkJyaWRnZSkKKwl4Yy5p
Zm5hbWUgPSBDLkNTdHJpbmcoeC5JZm5hbWUpCisJeGMuc2NyaXB0ID0gQy5DU3RyaW5nKHguU2Ny
aXB0KQorCXhjLm5pY3R5cGUgPSBDLmxpYnhsX25pY190eXBlKHguTmljdHlwZSkKKwl4Yy5yYXRl
X2J5dGVzX3Blcl9pbnRlcnZhbCA9IEMudWludDY0X3QoeC5SYXRlQnl0ZXNQZXJJbnRlcnZhbCkK
Kwl4Yy5yYXRlX2ludGVydmFsX3VzZWNzID0gQy51aW50MzJfdCh4LlJhdGVJbnRlcnZhbFVzZWNz
KQorCXhjLmdhdGV3YXlkZXYgPSBDLkNTdHJpbmcoeC5HYXRld2F5ZGV2KQorCXhjLmNvbG9mdF9m
b3J3YXJkZGV2ID0gQy5DU3RyaW5nKHguQ29sb2Z0Rm9yd2FyZGRldikKKwl4Yy5jb2xvX3NvY2tf
bWlycm9yX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tNaXJyb3JJZCkKKwl4Yy5jb2xvX3NvY2tf
bWlycm9yX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tNaXJyb3JJcCkKKwl4Yy5jb2xvX3NvY2tf
bWlycm9yX3BvcnQgPSBDLkNTdHJpbmcoeC5Db2xvU29ja01pcnJvclBvcnQpCisJeGMuY29sb19z
b2NrX2NvbXBhcmVfcHJpX2luX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlUHJpSW5J
ZCkKKwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9wcmlfaW5faXAgPSBDLkNTdHJpbmcoeC5Db2xvU29j
a0NvbXBhcmVQcmlJbklwKQorCXhjLmNvbG9fc29ja19jb21wYXJlX3ByaV9pbl9wb3J0ID0gQy5D
U3RyaW5nKHguQ29sb1NvY2tDb21wYXJlUHJpSW5Qb3J0KQorCXhjLmNvbG9fc29ja19jb21wYXJl
X3NlY19pbl9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrQ29tcGFyZVNlY0luSWQpCisJeGMuY29s
b19zb2NrX2NvbXBhcmVfc2VjX2luX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tDb21wYXJlU2Vj
SW5JcCkKKwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9zZWNfaW5fcG9ydCA9IEMuQ1N0cmluZyh4LkNv
bG9Tb2NrQ29tcGFyZVNlY0luUG9ydCkKKwl4Yy5jb2xvX3NvY2tfY29tcGFyZV9ub3RpZnlfaWQg
PSBDLkNTdHJpbmcoeC5Db2xvU29ja0NvbXBhcmVOb3RpZnlJZCkKKwl4Yy5jb2xvX3NvY2tfY29t
cGFyZV9ub3RpZnlfaXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja0NvbXBhcmVOb3RpZnlJcCkKKwl4
Yy5jb2xvX3NvY2tfY29tcGFyZV9ub3RpZnlfcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrQ29t
cGFyZU5vdGlmeVBvcnQpCisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IwX2lkID0gQy5DU3RyaW5n
KHguQ29sb1NvY2tSZWRpcmVjdG9yMElkKQorCXhjLmNvbG9fc29ja19yZWRpcmVjdG9yMF9pcCA9
IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjBJcCkKKwl4Yy5jb2xvX3NvY2tfcmVkaXJl
Y3RvcjBfcG9ydCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjBQb3J0KQorCXhjLmNv
bG9fc29ja19yZWRpcmVjdG9yMV9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrUmVkaXJlY3RvcjFJ
ZCkKKwl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjFfaXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1Jl
ZGlyZWN0b3IxSXApCisJeGMuY29sb19zb2NrX3JlZGlyZWN0b3IxX3BvcnQgPSBDLkNTdHJpbmco
eC5Db2xvU29ja1JlZGlyZWN0b3IxUG9ydCkKKwl4Yy5jb2xvX3NvY2tfcmVkaXJlY3RvcjJfaWQg
PSBDLkNTdHJpbmcoeC5Db2xvU29ja1JlZGlyZWN0b3IySWQpCisJeGMuY29sb19zb2NrX3JlZGly
ZWN0b3IyX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRpcmVjdG9yMklwKQorCXhjLmNvbG9f
c29ja19yZWRpcmVjdG9yMl9wb3J0ID0gQy5DU3RyaW5nKHguQ29sb1NvY2tSZWRpcmVjdG9yMlBv
cnQpCisJeGMuY29sb19maWx0ZXJfbWlycm9yX3F1ZXVlID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRl
ck1pcnJvclF1ZXVlKQorCXhjLmNvbG9fZmlsdGVyX21pcnJvcl9vdXRkZXYgPSBDLkNTdHJpbmco
eC5Db2xvRmlsdGVyTWlycm9yT3V0ZGV2KQorCXhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3IwX3F1
ZXVlID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclJlZGlyZWN0b3IwUXVldWUpCisJeGMuY29sb19m
aWx0ZXJfcmVkaXJlY3RvcjBfaW5kZXYgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyUmVkaXJlY3Rv
cjBJbmRldikKKwl4Yy5jb2xvX2ZpbHRlcl9yZWRpcmVjdG9yMF9vdXRkZXYgPSBDLkNTdHJpbmco
eC5Db2xvRmlsdGVyUmVkaXJlY3RvcjBPdXRkZXYpCisJeGMuY29sb19maWx0ZXJfcmVkaXJlY3Rv
cjFfcXVldWUgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyUmVkaXJlY3RvcjFRdWV1ZSkKKwl4Yy5j
b2xvX2ZpbHRlcl9yZWRpcmVjdG9yMV9pbmRldiA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJSZWRp
cmVjdG9yMUluZGV2KQorCXhjLmNvbG9fZmlsdGVyX3JlZGlyZWN0b3IxX291dGRldiA9IEMuQ1N0
cmluZyh4LkNvbG9GaWx0ZXJSZWRpcmVjdG9yMU91dGRldikKKwl4Yy5jb2xvX2NvbXBhcmVfcHJp
X2luID0gQy5DU3RyaW5nKHguQ29sb0NvbXBhcmVQcmlJbikKKwl4Yy5jb2xvX2NvbXBhcmVfc2Vj
X2luID0gQy5DU3RyaW5nKHguQ29sb0NvbXBhcmVTZWNJbikKKwl4Yy5jb2xvX2NvbXBhcmVfb3V0
ID0gQy5DU3RyaW5nKHguQ29sb0NvbXBhcmVPdXQpCisJeGMuY29sb19jb21wYXJlX25vdGlmeV9k
ZXYgPSBDLkNTdHJpbmcoeC5Db2xvQ29tcGFyZU5vdGlmeURldikKKwl4Yy5jb2xvX3NvY2tfc2Vj
X3JlZGlyZWN0b3IwX2lkID0gQy5DU3RyaW5nKHguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMElkKQor
CXhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjBfaXAgPSBDLkNTdHJpbmcoeC5Db2xvU29ja1Nl
Y1JlZGlyZWN0b3IwSXApCisJeGMuY29sb19zb2NrX3NlY19yZWRpcmVjdG9yMF9wb3J0ID0gQy5D
U3RyaW5nKHguQ29sb1NvY2tTZWNSZWRpcmVjdG9yMFBvcnQpCisJeGMuY29sb19zb2NrX3NlY19y
ZWRpcmVjdG9yMV9pZCA9IEMuQ1N0cmluZyh4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjFJZCkKKwl4
Yy5jb2xvX3NvY2tfc2VjX3JlZGlyZWN0b3IxX2lwID0gQy5DU3RyaW5nKHguQ29sb1NvY2tTZWNS
ZWRpcmVjdG9yMUlwKQorCXhjLmNvbG9fc29ja19zZWNfcmVkaXJlY3RvcjFfcG9ydCA9IEMuQ1N0
cmluZyh4LkNvbG9Tb2NrU2VjUmVkaXJlY3RvcjFQb3J0KQorCXhjLmNvbG9fZmlsdGVyX3NlY19y
ZWRpcmVjdG9yMF9xdWV1ZSA9IEMuQ1N0cmluZyh4LkNvbG9GaWx0ZXJTZWNSZWRpcmVjdG9yMFF1
ZXVlKQorCXhjLmNvbG9fZmlsdGVyX3NlY19yZWRpcmVjdG9yMF9pbmRldiA9IEMuQ1N0cmluZyh4
LkNvbG9GaWx0ZXJTZWNSZWRpcmVjdG9yMEluZGV2KQorCXhjLmNvbG9fZmlsdGVyX3NlY19yZWRp
cmVjdG9yMF9vdXRkZXYgPSBDLkNTdHJpbmcoeC5Db2xvRmlsdGVyU2VjUmVkaXJlY3RvcjBPdXRk
ZXYpCisJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IxX3F1ZXVlID0gQy5DU3RyaW5nKHgu
Q29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxUXVldWUpCisJeGMuY29sb19maWx0ZXJfc2VjX3JlZGly
ZWN0b3IxX2luZGV2ID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1JlZGlyZWN0b3IxSW5kZXYp
CisJeGMuY29sb19maWx0ZXJfc2VjX3JlZGlyZWN0b3IxX291dGRldiA9IEMuQ1N0cmluZyh4LkNv
bG9GaWx0ZXJTZWNSZWRpcmVjdG9yMU91dGRldikKKwl4Yy5jb2xvX2ZpbHRlcl9zZWNfcmV3cml0
ZXIwX3F1ZXVlID0gQy5DU3RyaW5nKHguQ29sb0ZpbHRlclNlY1Jld3JpdGVyMFF1ZXVlKQorCXhj
LmNvbG9fY2hlY2twb2ludF9ob3N0ID0gQy5DU3RyaW5nKHguQ29sb0NoZWNrcG9pbnRIb3N0KQor
CXhjLmNvbG9fY2hlY2twb2ludF9wb3J0ID0gQy5DU3RyaW5nKHguQ29sb0NoZWNrcG9pbnRQb3J0
KQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVBjaSkgZnJvbUMoeGMgKkMu
bGlieGxfZGV2aWNlX3BjaSkgZXJyb3IgewogCXguRnVuYyA9IGJ5dGUoeGMuX2Z1bmMpCiAJeC5E
ZXYgPSBieXRlKHhjLmRldikKQEAgLTc3Niw2ICsxMzM1LDIyIEBAIGZ1bmMgKHggKkRldmljZVBj
aSkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3BjaSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0K
IAorZnVuYyAoeCAqRGV2aWNlUGNpKSB0b0MoKSAoeGMgQy5saWJ4bF9kZXZpY2VfcGNpLCBlcnIg
ZXJyb3IpIHsKKwlDLmxpYnhsX2RldmljZV9wY2lfaW5pdCgmeGMpCisJeGMuX2Z1bmMgPSBDLnVp
bnQ4X3QoeC5GdW5jKQorCXhjLmRldiA9IEMudWludDhfdCh4LkRldikKKwl4Yy5idXMgPSBDLnVp
bnQ4X3QoeC5CdXMpCisJeGMuZG9tYWluID0gQy5pbnQoeC5Eb21haW4pCisJeGMudmRldmZuID0g
Qy51aW50MzJfdCh4LlZkZXZmbikKKwl4Yy52ZnVuY19tYXNrID0gQy51aW50MzJfdCh4LlZmdW5j
TWFzaykKKwl4Yy5tc2l0cmFuc2xhdGUgPSBDLmJvb2woeC5Nc2l0cmFuc2xhdGUpCisJeGMucG93
ZXJfbWdtdCA9IEMuYm9vbCh4LlBvd2VyTWdtdCkKKwl4Yy5wZXJtaXNzaXZlID0gQy5ib29sKHgu
UGVybWlzc2l2ZSkKKwl4Yy5zZWl6ZSA9IEMuYm9vbCh4LlNlaXplKQorCXhjLnJkbV9wb2xpY3kg
PSBDLmxpYnhsX3JkbV9yZXNlcnZlX3BvbGljeSh4LlJkbVBvbGljeSkKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VSZG0pIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9yZG0p
IGVycm9yIHsKIAl4LlN0YXJ0ID0gdWludDY0KHhjLnN0YXJ0KQogCXguU2l6ZSA9IHVpbnQ2NCh4
Yy5zaXplKQpAQCAtNzg0LDYgKzEzNTksMTQgQEAgZnVuYyAoeCAqRGV2aWNlUmRtKSBmcm9tQyh4
YyAqQy5saWJ4bF9kZXZpY2VfcmRtKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4
ICpEZXZpY2VSZG0pIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV9yZG0sIGVyciBlcnJvcikgewor
CUMubGlieGxfZGV2aWNlX3JkbV9pbml0KCZ4YykKKwl4Yy5zdGFydCA9IEMudWludDY0X3QoeC5T
dGFydCkKKwl4Yy5zaXplID0gQy51aW50NjRfdCh4LlNpemUpCisJeGMucG9saWN5ID0gQy5saWJ4
bF9yZG1fcmVzZXJ2ZV9wb2xpY3koeC5Qb2xpY3kpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVu
YyAoeCAqRGV2aWNlVXNiY3RybCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3VzYmN0cmwpIGVy
cm9yIHsKIAl4LlR5cGUgPSBVc2JjdHJsVHlwZSh4Yy5fdHlwZSkKIAl4LkRldmlkID0gRGV2aWQo
eGMuZGV2aWQpCkBAIC03OTUsNiArMTM3OCwxNyBAQCBmdW5jICh4ICpEZXZpY2VVc2JjdHJsKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiY3RybCkgZXJyb3IgewogCXJldHVybiBuaWwKIH0K
IAorZnVuYyAoeCAqRGV2aWNlVXNiY3RybCkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3VzYmN0
cmwsIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX3VzYmN0cmxfaW5pdCgmeGMpCisJeGMu
X3R5cGUgPSBDLmxpYnhsX3VzYmN0cmxfdHlwZSh4LlR5cGUpCisJeGMuZGV2aWQgPSBDLmxpYnhs
X2RldmlkKHguRGV2aWQpCisJeGMudmVyc2lvbiA9IEMuaW50KHguVmVyc2lvbikKKwl4Yy5wb3J0
cyA9IEMuaW50KHguUG9ydHMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5C
YWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERv
bW5hbWUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNlVXNiZGV2KSBmcm9t
Qyh4YyAqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSBlcnJvciB7CiAJeC5DdHJsID0gRGV2aWQoeGMu
Y3RybCkKIAl4LlBvcnQgPSBpbnQoeGMucG9ydCkKQEAgLTgyNCwxMiArMTQxOCwyNSBAQCBmdW5j
ICh4ICpEZXZpY2VVc2JkZXZUeXBlVW5pb25Ib3N0ZGV2KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZp
Y2VfdXNiZGV2KSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpEZXZpY2VVc2Jk
ZXYpIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV91c2JkZXYsIGVyciBlcnJvcikgeworCUMubGli
eGxfZGV2aWNlX3VzYmRldl9pbml0KCZ4YykKKwl4Yy5jdHJsID0gQy5saWJ4bF9kZXZpZCh4LkN0
cmwpCisJeGMucG9ydCA9IEMuaW50KHguUG9ydCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5j
ICh4ICpEZXZpY2VEdGRldikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX2R0ZGV2KSBlcnJvciB7
CiAJeC5QYXRoID0gQy5Hb1N0cmluZyh4Yy5wYXRoKQogCiAJcmV0dXJuIG5pbAogfQogCitmdW5j
ICh4ICpEZXZpY2VEdGRldikgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX2R0ZGV2LCBlcnIgZXJy
b3IpIHsKKwlDLmxpYnhsX2RldmljZV9kdGRldl9pbml0KCZ4YykKKwl4Yy5wYXRoID0gQy5DU3Ry
aW5nKHguUGF0aCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VWdHBtKSBm
cm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdnRwbSkgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0g
RG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4
Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC04NDEsNiArMTQ0OCwxOSBAQCBmdW5jICh4ICpEZXZpY2VW
dHBtKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdnRwbSkgZXJyb3IgewogCXJldHVybiBuaWwK
IH0KIAorZnVuYyAoeCAqRGV2aWNlVnRwbSkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3Z0cG0s
IGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX3Z0cG1faW5pdCgmeGMpCisJeGMuYmFja2Vu
ZF9kb21pZCA9IEMubGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21u
YW1lID0gQy5DU3RyaW5nKHguQmFja2VuZERvbW5hbWUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2Rl
dmlkKHguRGV2aWQpCisJeGMudXVpZCwgZXJyID0geC5VdWlkLnRvQygpCisJaWYgZXJyICE9IG5p
bCB7CisJCUMubGlieGxfZGV2aWNlX3Z0cG1fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJy
CisJfQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRldmljZVA5KSBmcm9tQyh4YyAq
Qy5saWJ4bF9kZXZpY2VfcDkpIGVycm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJh
Y2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9k
b21uYW1lKQpAQCAtODUyLDYgKzE0NzIsMTcgQEAgZnVuYyAoeCAqRGV2aWNlUDkpIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV9wOSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAq
RGV2aWNlUDkpIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV9wOSwgZXJyIGVycm9yKSB7CisJQy5s
aWJ4bF9kZXZpY2VfcDlfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMubGlieGxfZG9t
aWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3RyaW5nKHguQmFj
a2VuZERvbW5hbWUpCisJeGMudGFnID0gQy5DU3RyaW5nKHguVGFnKQorCXhjLnBhdGggPSBDLkNT
dHJpbmcoeC5QYXRoKQorCXhjLnNlY3VyaXR5X21vZGVsID0gQy5DU3RyaW5nKHguU2VjdXJpdHlN
b2RlbCkKKwl4Yy5kZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpEZXZpY2VQdmNhbGxzaWYpIGZyb21DKHhjICpDLmxpYnhsX2Rldmlj
ZV9wdmNhbGxzaWYpIGVycm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlkKHhjLmJhY2tlbmRf
ZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFja2VuZF9kb21uYW1l
KQpAQCAtODYwLDYgKzE0OTEsMTQgQEAgZnVuYyAoeCAqRGV2aWNlUHZjYWxsc2lmKSBmcm9tQyh4
YyAqQy5saWJ4bF9kZXZpY2VfcHZjYWxsc2lmKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpEZXZpY2VQdmNhbGxzaWYpIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV9wdmNhbGxz
aWYsIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX3B2Y2FsbHNpZl9pbml0KCZ4YykKKwl4
Yy5iYWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNr
ZW5kX2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9IEMu
bGlieGxfZGV2aWQoeC5EZXZpZCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZp
Y2VDaGFubmVsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCkgZXJyb3IgewogCXgu
QmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFja2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1l
ID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2RvbW5hbWUpCkBAIC04OTAsNiArMTUyOSwxNSBAQCBm
dW5jICh4ICpEZXZpY2VDaGFubmVsQ29ubmVjdGlvblVuaW9uU29ja2V0KSBmcm9tQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfY2hhbm5lbCkgZQogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNl
Q2hhbm5lbCkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX2NoYW5uZWwsIGVyciBlcnJvcikgewor
CUMubGlieGxfZGV2aWNlX2NoYW5uZWxfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3Ry
aW5nKHguQmFja2VuZERvbW5hbWUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQp
CisJeGMubmFtZSA9IEMuQ1N0cmluZyh4Lk5hbWUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVu
YyAoeCAqQ29ubmVjdG9yUGFyYW0pIGZyb21DKHhjICpDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbSkg
ZXJyb3IgewogCXguVW5pcXVlSWQgPSBDLkdvU3RyaW5nKHhjLnVuaXF1ZV9pZCkKIAl4LldpZHRo
ID0gdWludDMyKHhjLndpZHRoKQpAQCAtODk4LDYgKzE1NDYsMTQgQEAgZnVuYyAoeCAqQ29ubmVj
dG9yUGFyYW0pIGZyb21DKHhjICpDLmxpYnhsX2Nvbm5lY3Rvcl9wYXJhbSkgZXJyb3IgewogCXJl
dHVybiBuaWwKIH0KIAorZnVuYyAoeCAqQ29ubmVjdG9yUGFyYW0pIHRvQygpICh4YyBDLmxpYnhs
X2Nvbm5lY3Rvcl9wYXJhbSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9jb25uZWN0b3JfcGFyYW1f
aW5pdCgmeGMpCisJeGMudW5pcXVlX2lkID0gQy5DU3RyaW5nKHguVW5pcXVlSWQpCisJeGMud2lk
dGggPSBDLnVpbnQzMl90KHguV2lkdGgpCisJeGMuaGVpZ2h0ID0gQy51aW50MzJfdCh4LkhlaWdo
dCkKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VWZGlzcGwpIGZyb21DKHhj
ICpDLmxpYnhsX2RldmljZV92ZGlzcGwpIGVycm9yIHsKIAl4LkJhY2tlbmREb21pZCA9IERvbWlk
KHhjLmJhY2tlbmRfZG9taWQpCiAJeC5CYWNrZW5kRG9tbmFtZSA9IEMuR29TdHJpbmcoeGMuYmFj
a2VuZF9kb21uYW1lKQpAQCAtOTE3LDYgKzE1NzMsMTUgQEAgZnVuYyAoeCAqRGV2aWNlVmRpc3Bs
KSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmRpc3BsKSBlcnJvciB7CiAJcmV0dXJuIG5pbAog
fQogCitmdW5jICh4ICpEZXZpY2VWZGlzcGwpIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV92ZGlz
cGwsIGVyciBlcnJvcikgeworCUMubGlieGxfZGV2aWNlX3ZkaXNwbF9pbml0KCZ4YykKKwl4Yy5i
YWNrZW5kX2RvbWlkID0gQy5saWJ4bF9kb21pZCh4LkJhY2tlbmREb21pZCkKKwl4Yy5iYWNrZW5k
X2RvbW5hbWUgPSBDLkNTdHJpbmcoeC5CYWNrZW5kRG9tbmFtZSkKKwl4Yy5kZXZpZCA9IEMubGli
eGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5iZV9hbGxvYyA9IEMuYm9vbCh4LkJlQWxsb2MpCisJcmV0
dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqVnNuZFBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxf
dnNuZF9wYXJhbXMpIGVycm9yIHsKIAludW1TYW1wbGVSYXRlcyA6PSBpbnQoeGMubnVtX3NhbXBs
ZV9yYXRlcykKIAljU2FtcGxlUmF0ZXMgOj0gKCpbMSA8PCAyOF1DLnVpbnQzMl90KSh1bnNhZmUu
UG9pbnRlcih4Yy5zYW1wbGVfcmF0ZXMpKVs6bnVtU2FtcGxlUmF0ZXM6bnVtU2FtcGxlUmF0ZXNd
CkBAIC05MzcsNiArMTYwMiwxNCBAQCBmdW5jICh4ICpWc25kUGFyYW1zKSBmcm9tQyh4YyAqQy5s
aWJ4bF92c25kX3BhcmFtcykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVnNu
ZFBhcmFtcykgdG9DKCkgKHhjIEMubGlieGxfdnNuZF9wYXJhbXMsIGVyciBlcnJvcikgeworCUMu
bGlieGxfdnNuZF9wYXJhbXNfaW5pdCgmeGMpCisJeGMuY2hhbm5lbHNfbWluID0gQy51aW50MzJf
dCh4LkNoYW5uZWxzTWluKQorCXhjLmNoYW5uZWxzX21heCA9IEMudWludDMyX3QoeC5DaGFubmVs
c01heCkKKwl4Yy5idWZmZXJfc2l6ZSA9IEMudWludDMyX3QoeC5CdWZmZXJTaXplKQorCXJldHVy
biB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZzbmRTdHJlYW0pIGZyb21DKHhjICpDLmxpYnhsX3Zz
bmRfc3RyZWFtKSBlcnJvciB7CiAJeC5VbmlxdWVJZCA9IEMuR29TdHJpbmcoeGMudW5pcXVlX2lk
KQogCXguVHlwZSA9IFZzbmRTdHJlYW1UeXBlKHhjLl90eXBlKQpAQCAtOTQ3LDYgKzE2MjAsMTgg
QEAgZnVuYyAoeCAqVnNuZFN0cmVhbSkgZnJvbUMoeGMgKkMubGlieGxfdnNuZF9zdHJlYW0pIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZzbmRTdHJlYW0pIHRvQygpICh4YyBD
LmxpYnhsX3ZzbmRfc3RyZWFtLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3ZzbmRfc3RyZWFtX2lu
aXQoJnhjKQorCXhjLnVuaXF1ZV9pZCA9IEMuQ1N0cmluZyh4LlVuaXF1ZUlkKQorCXhjLl90eXBl
ID0gQy5saWJ4bF92c25kX3N0cmVhbV90eXBlKHguVHlwZSkKKwl4Yy5wYXJhbXMsIGVyciA9IHgu
UGFyYW1zLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfdnNuZF9zdHJlYW1fZGlz
cG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1
bmMgKHggKlZzbmRQY20pIGZyb21DKHhjICpDLmxpYnhsX3ZzbmRfcGNtKSBlcnJvciB7CiAJeC5O
YW1lID0gQy5Hb1N0cmluZyh4Yy5uYW1lKQogCWlmIGVyciA6PSB4LlBhcmFtcy5mcm9tQygmeGMu
cGFyYW1zKTsgZXJyICE9IG5pbCB7CkBAIC05NjYsNiArMTY1MSwxNyBAQCBmdW5jICh4ICpWc25k
UGNtKSBmcm9tQyh4YyAqQy5saWJ4bF92c25kX3BjbSkgZXJyb3IgewogCXJldHVybiBuaWwKIH0K
IAorZnVuYyAoeCAqVnNuZFBjbSkgdG9DKCkgKHhjIEMubGlieGxfdnNuZF9wY20sIGVyciBlcnJv
cikgeworCUMubGlieGxfdnNuZF9wY21faW5pdCgmeGMpCisJeGMubmFtZSA9IEMuQ1N0cmluZyh4
Lk5hbWUpCisJeGMucGFyYW1zLCBlcnIgPSB4LlBhcmFtcy50b0MoKQorCWlmIGVyciAhPSBuaWwg
eworCQlDLmxpYnhsX3ZzbmRfcGNtX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0K
KwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpEZXZpY2VWc25kKSBmcm9tQyh4YyAqQy5s
aWJ4bF9kZXZpY2VfdnNuZCkgZXJyb3IgewogCXguQmFja2VuZERvbWlkID0gRG9taWQoeGMuYmFj
a2VuZF9kb21pZCkKIAl4LkJhY2tlbmREb21uYW1lID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kX2Rv
bW5hbWUpCkBAIC05ODksNiArMTY4NSwyMSBAQCBmdW5jICh4ICpEZXZpY2VWc25kKSBmcm9tQyh4
YyAqQy5saWJ4bF9kZXZpY2VfdnNuZCkgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAo
eCAqRGV2aWNlVnNuZCkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3ZzbmQsIGVyciBlcnJvcikg
eworCUMubGlieGxfZGV2aWNlX3ZzbmRfaW5pdCgmeGMpCisJeGMuYmFja2VuZF9kb21pZCA9IEMu
bGlieGxfZG9taWQoeC5CYWNrZW5kRG9taWQpCisJeGMuYmFja2VuZF9kb21uYW1lID0gQy5DU3Ry
aW5nKHguQmFja2VuZERvbW5hbWUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQp
CisJeGMuc2hvcnRfbmFtZSA9IEMuQ1N0cmluZyh4LlNob3J0TmFtZSkKKwl4Yy5sb25nX25hbWUg
PSBDLkNTdHJpbmcoeC5Mb25nTmFtZSkKKwl4Yy5wYXJhbXMsIGVyciA9IHguUGFyYW1zLnRvQygp
CisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZGV2aWNlX3ZzbmRfZGlzcG9zZSgmeGMpCisJ
CXJldHVybiB4YywgZXJyCisJfQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFp
bkNvbmZpZykgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCWlmIGVy
ciA6PSB4LkNJbmZvLmZyb21DKCZ4Yy5jX2luZm8pOyBlcnIgIT0gbmlsIHsKIAkJcmV0dXJuIGVy
cgpAQCAtMTE1NSw2ICsxODY2LDI2IEBAIGZ1bmMgKHggKkRvbWFpbkNvbmZpZykgZnJvbUMoeGMg
KkMubGlieGxfZG9tYWluX2NvbmZpZykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAo
eCAqRG9tYWluQ29uZmlnKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21haW5fY29uZmlnLCBlcnIgZXJy
b3IpIHsKKwlDLmxpYnhsX2RvbWFpbl9jb25maWdfaW5pdCgmeGMpCisJeGMuY19pbmZvLCBlcnIg
PSB4LkNJbmZvLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2NvbmZp
Z19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuYl9pbmZvLCBlcnIgPSB4
LkJJbmZvLnRvQygpCisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX2NvbmZpZ19k
aXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMub25fcG93ZXJvZmYgPSBDLmxp
YnhsX2FjdGlvbl9vbl9zaHV0ZG93bih4Lk9uUG93ZXJvZmYpCisJeGMub25fcmVib290ID0gQy5s
aWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PblJlYm9vdCkKKwl4Yy5vbl93YXRjaGRvZyA9IEMu
bGlieGxfYWN0aW9uX29uX3NodXRkb3duKHguT25XYXRjaGRvZykKKwl4Yy5vbl9jcmFzaCA9IEMu
bGlieGxfYWN0aW9uX29uX3NodXRkb3duKHguT25DcmFzaCkKKwl4Yy5vbl9zb2Z0X3Jlc2V0ID0g
Qy5saWJ4bF9hY3Rpb25fb25fc2h1dGRvd24oeC5PblNvZnRSZXNldCkKKwlyZXR1cm4geGMsIG5p
bAorfQorCiBmdW5jICh4ICpEaXNraW5mbykgZnJvbUMoeGMgKkMubGlieGxfZGlza2luZm8pIGVy
cm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQg
PSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTExNjgsNiArMTg5OSwxOSBAQCBmdW5jICh4ICpE
aXNraW5mbykgZnJvbUMoeGMgKkMubGlieGxfZGlza2luZm8pIGVycm9yIHsKIAlyZXR1cm4gbmls
CiB9CiAKK2Z1bmMgKHggKkRpc2tpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9kaXNraW5mbywgZXJy
IGVycm9yKSB7CisJQy5saWJ4bF9kaXNraW5mb19pbml0KCZ4YykKKwl4Yy5iYWNrZW5kID0gQy5D
U3RyaW5nKHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4LkJhY2tlbmRJ
ZCkKKwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZyb250ZW5kX2lk
ID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHgu
RGV2aWQpCisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0gQy5pbnQoeC5F
dnRjaCkKKwl4Yy5ycmVmID0gQy5pbnQoeC5ScmVmKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1
bmMgKHggKk5pY2luZm8pIGZyb21DKHhjICpDLmxpYnhsX25pY2luZm8pIGVycm9yIHsKIAl4LkJh
Y2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5kSWQgPSB1aW50MzIoeGMu
YmFja2VuZF9pZCkKQEAgLTExODIsNiArMTkyNiwyMCBAQCBmdW5jICh4ICpOaWNpbmZvKSBmcm9t
Qyh4YyAqQy5saWJ4bF9uaWNpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4
ICpOaWNpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9uaWNpbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxp
YnhsX25pY2luZm9faW5pdCgmeGMpCisJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQp
CisJeGMuYmFja2VuZF9pZCA9IEMudWludDMyX3QoeC5CYWNrZW5kSWQpCisJeGMuZnJvbnRlbmQg
PSBDLkNTdHJpbmcoeC5Gcm9udGVuZCkKKwl4Yy5mcm9udGVuZF9pZCA9IEMudWludDMyX3QoeC5G
cm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQorCXhjLnN0YXRl
ID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0Y2gpCisJeGMucnJlZl90
eCA9IEMuaW50KHguUnJlZlR4KQorCXhjLnJyZWZfcnggPSBDLmludCh4LlJyZWZSeCkKKwlyZXR1
cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWdHBtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnRw
bWluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5C
YWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTExOTgsNiArMTk1NiwyNCBAQCBm
dW5jICh4ICpWdHBtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnRwbWluZm8pIGVycm9yIHsKIAly
ZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZ0cG1pbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92dHBt
aW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92dHBtaW5mb19pbml0KCZ4YykKKwl4Yy5iYWNr
ZW5kID0gQy5DU3RyaW5nKHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJfdCh4
LkJhY2tlbmRJZCkKKwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhjLmZy
b250ZW5kX2lkID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxpYnhs
X2RldmlkKHguRGV2aWQpCisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXhjLmV2dGNoID0g
Qy5pbnQoeC5FdnRjaCkKKwl4Yy5ycmVmID0gQy5pbnQoeC5ScmVmKQorCXhjLnV1aWQsIGVyciA9
IHguVXVpZC50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX3Z0cG1pbmZvX2Rpc3Bv
c2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5j
ICh4ICpVc2JjdHJsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdXNiY3RybGluZm8pIGVycm9yIHsK
IAl4LlR5cGUgPSBVc2JjdHJsVHlwZSh4Yy5fdHlwZSkKIAl4LkRldmlkID0gRGV2aWQoeGMuZGV2
aWQpCkBAIC0xMjE1LDYgKzE5OTEsMjMgQEAgZnVuYyAoeCAqVXNiY3RybGluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3VzYmN0cmxpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4
ICpVc2JjdHJsaW5mbykgdG9DKCkgKHhjIEMubGlieGxfdXNiY3RybGluZm8sIGVyciBlcnJvcikg
eworCUMubGlieGxfdXNiY3RybGluZm9faW5pdCgmeGMpCisJeGMuX3R5cGUgPSBDLmxpYnhsX3Vz
YmN0cmxfdHlwZSh4LlR5cGUpCisJeGMuZGV2aWQgPSBDLmxpYnhsX2RldmlkKHguRGV2aWQpCisJ
eGMudmVyc2lvbiA9IEMuaW50KHguVmVyc2lvbikKKwl4Yy5wb3J0cyA9IEMuaW50KHguUG9ydHMp
CisJeGMuYmFja2VuZCA9IEMuQ1N0cmluZyh4LkJhY2tlbmQpCisJeGMuYmFja2VuZF9pZCA9IEMu
dWludDMyX3QoeC5CYWNrZW5kSWQpCisJeGMuZnJvbnRlbmQgPSBDLkNTdHJpbmcoeC5Gcm9udGVu
ZCkKKwl4Yy5mcm9udGVuZF9pZCA9IEMudWludDMyX3QoeC5Gcm9udGVuZElkKQorCXhjLnN0YXRl
ID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0Y2gpCisJeGMucmVmX3Vy
YiA9IEMuaW50KHguUmVmVXJiKQorCXhjLnJlZl9jb25uID0gQy5pbnQoeC5SZWZDb25uKQorCXJl
dHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlZjcHVpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92
Y3B1aW5mbykgZXJyb3IgewogCXguVmNwdWlkID0gdWludDMyKHhjLnZjcHVpZCkKIAl4LkNwdSA9
IHVpbnQzMih4Yy5jcHUpCkBAIC0xMjMyLDYgKzIwMjUsMjcgQEAgZnVuYyAoeCAqVmNwdWluZm8p
IGZyb21DKHhjICpDLmxpYnhsX3ZjcHVpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitm
dW5jICh4ICpWY3B1aW5mbykgdG9DKCkgKHhjIEMubGlieGxfdmNwdWluZm8sIGVyciBlcnJvcikg
eworCUMubGlieGxfdmNwdWluZm9faW5pdCgmeGMpCisJeGMudmNwdWlkID0gQy51aW50MzJfdCh4
LlZjcHVpZCkKKwl4Yy5jcHUgPSBDLnVpbnQzMl90KHguQ3B1KQorCXhjLm9ubGluZSA9IEMuYm9v
bCh4Lk9ubGluZSkKKwl4Yy5ibG9ja2VkID0gQy5ib29sKHguQmxvY2tlZCkKKwl4Yy5ydW5uaW5n
ID0gQy5ib29sKHguUnVubmluZykKKwl4Yy52Y3B1X3RpbWUgPSBDLnVpbnQ2NF90KHguVmNwdVRp
bWUpCisJeGMuY3B1bWFwLCBlcnIgPSB4LkNwdW1hcC50b0MoKQorCWlmIGVyciAhPSBuaWwgewor
CQlDLmxpYnhsX3ZjcHVpbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4
Yy5jcHVtYXBfc29mdCwgZXJyID0geC5DcHVtYXBTb2Z0LnRvQygpCisJaWYgZXJyICE9IG5pbCB7
CisJCUMubGlieGxfdmNwdWluZm9fZGlzcG9zZSgmeGMpCisJCXJldHVybiB4YywgZXJyCisJfQor
CXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlBoeXNpbmZvKSBmcm9tQyh4YyAqQy5saWJ4
bF9waHlzaW5mbykgZXJyb3IgewogCXguVGhyZWFkc1BlckNvcmUgPSB1aW50MzIoeGMudGhyZWFk
c19wZXJfY29yZSkKIAl4LkNvcmVzUGVyU29ja2V0ID0gdWludDMyKHhjLmNvcmVzX3Blcl9zb2Nr
ZXQpCkBAIC0xMjU5LDYgKzIwNzMsMzUgQEAgZnVuYyAoeCAqUGh5c2luZm8pIGZyb21DKHhjICpD
LmxpYnhsX3BoeXNpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpQaHlz
aW5mbykgdG9DKCkgKHhjIEMubGlieGxfcGh5c2luZm8sIGVyciBlcnJvcikgeworCUMubGlieGxf
cGh5c2luZm9faW5pdCgmeGMpCisJeGMudGhyZWFkc19wZXJfY29yZSA9IEMudWludDMyX3QoeC5U
aHJlYWRzUGVyQ29yZSkKKwl4Yy5jb3Jlc19wZXJfc29ja2V0ID0gQy51aW50MzJfdCh4LkNvcmVz
UGVyU29ja2V0KQorCXhjLm1heF9jcHVfaWQgPSBDLnVpbnQzMl90KHguTWF4Q3B1SWQpCisJeGMu
bnJfY3B1cyA9IEMudWludDMyX3QoeC5OckNwdXMpCisJeGMuY3B1X2toeiA9IEMudWludDMyX3Qo
eC5DcHVLaHopCisJeGMudG90YWxfcGFnZXMgPSBDLnVpbnQ2NF90KHguVG90YWxQYWdlcykKKwl4
Yy5mcmVlX3BhZ2VzID0gQy51aW50NjRfdCh4LkZyZWVQYWdlcykKKwl4Yy5zY3J1Yl9wYWdlcyA9
IEMudWludDY0X3QoeC5TY3J1YlBhZ2VzKQorCXhjLm91dHN0YW5kaW5nX3BhZ2VzID0gQy51aW50
NjRfdCh4Lk91dHN0YW5kaW5nUGFnZXMpCisJeGMuc2hhcmluZ19mcmVlZF9wYWdlcyA9IEMudWlu
dDY0X3QoeC5TaGFyaW5nRnJlZWRQYWdlcykKKwl4Yy5zaGFyaW5nX3VzZWRfZnJhbWVzID0gQy51
aW50NjRfdCh4LlNoYXJpbmdVc2VkRnJhbWVzKQorCXhjLm1heF9wb3NzaWJsZV9tZm4gPSBDLnVp
bnQ2NF90KHguTWF4UG9zc2libGVNZm4pCisJeGMubnJfbm9kZXMgPSBDLnVpbnQzMl90KHguTnJO
b2RlcykKKwl4Yy5od19jYXAsIGVyciA9IHguSHdDYXAudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsK
KwkJQy5saWJ4bF9waHlzaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJ
eGMuY2FwX2h2bSA9IEMuYm9vbCh4LkNhcEh2bSkKKwl4Yy5jYXBfcHYgPSBDLmJvb2woeC5DYXBQ
dikKKwl4Yy5jYXBfaHZtX2RpcmVjdGlvID0gQy5ib29sKHguQ2FwSHZtRGlyZWN0aW8pCisJeGMu
Y2FwX2hhcCA9IEMuYm9vbCh4LkNhcEhhcCkKKwl4Yy5jYXBfc2hhZG93ID0gQy5ib29sKHguQ2Fw
U2hhZG93KQorCXhjLmNhcF9pb21tdV9oYXBfcHRfc2hhcmUgPSBDLmJvb2woeC5DYXBJb21tdUhh
cFB0U2hhcmUpCisJcmV0dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqQ29ubmVjdG9yaW5mbykg
ZnJvbUMoeGMgKkMubGlieGxfY29ubmVjdG9yaW5mbykgZXJyb3IgewogCXguVW5pcXVlSWQgPSBD
LkdvU3RyaW5nKHhjLnVuaXF1ZV9pZCkKIAl4LldpZHRoID0gdWludDMyKHhjLndpZHRoKQpAQCAt
MTI3MSw2ICsyMTE0LDE4IEBAIGZ1bmMgKHggKkNvbm5lY3RvcmluZm8pIGZyb21DKHhjICpDLmxp
YnhsX2Nvbm5lY3RvcmluZm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkNv
bm5lY3RvcmluZm8pIHRvQygpICh4YyBDLmxpYnhsX2Nvbm5lY3RvcmluZm8sIGVyciBlcnJvcikg
eworCUMubGlieGxfY29ubmVjdG9yaW5mb19pbml0KCZ4YykKKwl4Yy51bmlxdWVfaWQgPSBDLkNT
dHJpbmcoeC5VbmlxdWVJZCkKKwl4Yy53aWR0aCA9IEMudWludDMyX3QoeC5XaWR0aCkKKwl4Yy5o
ZWlnaHQgPSBDLnVpbnQzMl90KHguSGVpZ2h0KQorCXhjLnJlcV9ldnRjaCA9IEMuaW50KHguUmVx
RXZ0Y2gpCisJeGMucmVxX3JyZWYgPSBDLmludCh4LlJlcVJyZWYpCisJeGMuZXZ0X2V2dGNoID0g
Qy5pbnQoeC5FdnRFdnRjaCkKKwl4Yy5ldnRfcnJlZiA9IEMuaW50KHguRXZ0UnJlZikKKwlyZXR1
cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWZGlzcGxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92
ZGlzcGxpbmZvKSBlcnJvciB7CiAJeC5CYWNrZW5kID0gQy5Hb1N0cmluZyh4Yy5iYWNrZW5kKQog
CXguQmFja2VuZElkID0gdWludDMyKHhjLmJhY2tlbmRfaWQpCkBAIC0xMjkzLDYgKzIxNDgsMTgg
QEAgZnVuYyAoeCAqVmRpc3BsaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdmRpc3BsaW5mbykgZXJy
b3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqVmRpc3BsaW5mbykgdG9DKCkgKHhjIEMu
bGlieGxfdmRpc3BsaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92ZGlzcGxpbmZvX2luaXQo
JnhjKQorCXhjLmJhY2tlbmQgPSBDLkNTdHJpbmcoeC5CYWNrZW5kKQorCXhjLmJhY2tlbmRfaWQg
PSBDLnVpbnQzMl90KHguQmFja2VuZElkKQorCXhjLmZyb250ZW5kID0gQy5DU3RyaW5nKHguRnJv
bnRlbmQpCisJeGMuZnJvbnRlbmRfaWQgPSBDLnVpbnQzMl90KHguRnJvbnRlbmRJZCkKKwl4Yy5k
ZXZpZCA9IEMubGlieGxfZGV2aWQoeC5EZXZpZCkKKwl4Yy5zdGF0ZSA9IEMuaW50KHguU3RhdGUp
CisJeGMuYmVfYWxsb2MgPSBDLmJvb2woeC5CZUFsbG9jKQorCXJldHVybiB4YywgbmlsCit9CisK
IGZ1bmMgKHggKlN0cmVhbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3N0cmVhbWluZm8pIGVycm9y
IHsKIAl4LlJlcUV2dGNoID0gaW50KHhjLnJlcV9ldnRjaCkKIAl4LlJlcVJyZWYgPSBpbnQoeGMu
cmVxX3JyZWYpCkBAIC0xMzAwLDYgKzIxNjcsMTMgQEAgZnVuYyAoeCAqU3RyZWFtaW5mbykgZnJv
bUMoeGMgKkMubGlieGxfc3RyZWFtaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVu
YyAoeCAqU3RyZWFtaW5mbykgdG9DKCkgKHhjIEMubGlieGxfc3RyZWFtaW5mbywgZXJyIGVycm9y
KSB7CisJQy5saWJ4bF9zdHJlYW1pbmZvX2luaXQoJnhjKQorCXhjLnJlcV9ldnRjaCA9IEMuaW50
KHguUmVxRXZ0Y2gpCisJeGMucmVxX3JyZWYgPSBDLmludCh4LlJlcVJyZWYpCisJcmV0dXJuIHhj
LCBuaWwKK30KKwogZnVuYyAoeCAqUGNtaW5mbykgZnJvbUMoeGMgKkMubGlieGxfcGNtaW5mbykg
ZXJyb3IgewogCW51bVZzbmRTdHJlYW1zIDo9IGludCh4Yy5udW1fdnNuZF9zdHJlYW1zKQogCWNT
dHJlYW1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9zdHJlYW1pbmZvKSh1bnNhZmUuUG9pbnRlcih4
Yy5zdHJlYW1zKSlbOm51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJlYW1zXQpAQCAtMTMxNSw2ICsy
MTg5LDExIEBAIGZ1bmMgKHggKlBjbWluZm8pIGZyb21DKHhjICpDLmxpYnhsX3BjbWluZm8pIGVy
cm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlBjbWluZm8pIHRvQygpICh4YyBDLmxp
YnhsX3BjbWluZm8sIGVyciBlcnJvcikgeworCUMubGlieGxfcGNtaW5mb19pbml0KCZ4YykKKwly
ZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxf
dnNuZGluZm8pIGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJ
eC5CYWNrZW5kSWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTEzMzYsNiArMjIxNSwxNyBA
QCBmdW5jICh4ICpWc25kaW5mbykgZnJvbUMoeGMgKkMubGlieGxfdnNuZGluZm8pIGVycm9yIHsK
IAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKlZzbmRpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92
c25kaW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF92c25kaW5mb19pbml0KCZ4YykKKwl4Yy5i
YWNrZW5kID0gQy5DU3RyaW5nKHguQmFja2VuZCkKKwl4Yy5iYWNrZW5kX2lkID0gQy51aW50MzJf
dCh4LkJhY2tlbmRJZCkKKwl4Yy5mcm9udGVuZCA9IEMuQ1N0cmluZyh4LkZyb250ZW5kKQorCXhj
LmZyb250ZW5kX2lkID0gQy51aW50MzJfdCh4LkZyb250ZW5kSWQpCisJeGMuZGV2aWQgPSBDLmxp
YnhsX2RldmlkKHguRGV2aWQpCisJeGMuc3RhdGUgPSBDLmludCh4LlN0YXRlKQorCXJldHVybiB4
YywgbmlsCit9CisKIGZ1bmMgKHggKlZrYmluZm8pIGZyb21DKHhjICpDLmxpYnhsX3ZrYmluZm8p
IGVycm9yIHsKIAl4LkJhY2tlbmQgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmQpCiAJeC5CYWNrZW5k
SWQgPSB1aW50MzIoeGMuYmFja2VuZF9pZCkKQEAgLTEzNDksNiArMjIzOSwxOSBAQCBmdW5jICh4
ICpWa2JpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF92a2JpbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5p
bAogfQogCitmdW5jICh4ICpWa2JpbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF92a2JpbmZvLCBlcnIg
ZXJyb3IpIHsKKwlDLmxpYnhsX3ZrYmluZm9faW5pdCgmeGMpCisJeGMuYmFja2VuZCA9IEMuQ1N0
cmluZyh4LkJhY2tlbmQpCisJeGMuYmFja2VuZF9pZCA9IEMudWludDMyX3QoeC5CYWNrZW5kSWQp
CisJeGMuZnJvbnRlbmQgPSBDLkNTdHJpbmcoeC5Gcm9udGVuZCkKKwl4Yy5mcm9udGVuZF9pZCA9
IEMudWludDMyX3QoeC5Gcm9udGVuZElkKQorCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRl
dmlkKQorCXhjLnN0YXRlID0gQy5pbnQoeC5TdGF0ZSkKKwl4Yy5ldnRjaCA9IEMuaW50KHguRXZ0
Y2gpCisJeGMucnJlZiA9IEMuaW50KHguUnJlZikKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5j
ICh4ICpOdW1haW5mbykgZnJvbUMoeGMgKkMubGlieGxfbnVtYWluZm8pIGVycm9yIHsKIAl4LlNp
emUgPSB1aW50NjQoeGMuc2l6ZSkKIAl4LkZyZWUgPSB1aW50NjQoeGMuZnJlZSkKQEAgLTEzNjIs
NiArMjI2NSwxMyBAQCBmdW5jICh4ICpOdW1haW5mbykgZnJvbUMoeGMgKkMubGlieGxfbnVtYWlu
Zm8pIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKk51bWFpbmZvKSB0b0MoKSAo
eGMgQy5saWJ4bF9udW1haW5mbywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9udW1haW5mb19pbml0
KCZ4YykKKwl4Yy5zaXplID0gQy51aW50NjRfdCh4LlNpemUpCisJeGMuZnJlZSA9IEMudWludDY0
X3QoeC5GcmVlKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkNwdXRvcG9sb2d5KSBm
cm9tQyh4YyAqQy5saWJ4bF9jcHV0b3BvbG9neSkgZXJyb3IgewogCXguQ29yZSA9IHVpbnQzMih4
Yy5jb3JlKQogCXguU29ja2V0ID0gdWludDMyKHhjLnNvY2tldCkKQEAgLTEzNzAsNiArMjI4MCwx
NCBAQCBmdW5jICh4ICpDcHV0b3BvbG9neSkgZnJvbUMoeGMgKkMubGlieGxfY3B1dG9wb2xvZ3kp
IGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMgKHggKkNwdXRvcG9sb2d5KSB0b0MoKSAo
eGMgQy5saWJ4bF9jcHV0b3BvbG9neSwgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9jcHV0b3BvbG9n
eV9pbml0KCZ4YykKKwl4Yy5jb3JlID0gQy51aW50MzJfdCh4LkNvcmUpCisJeGMuc29ja2V0ID0g
Qy51aW50MzJfdCh4LlNvY2tldCkKKwl4Yy5ub2RlID0gQy51aW50MzJfdCh4Lk5vZGUpCisJcmV0
dXJuIHhjLCBuaWwKK30KKwogZnVuYyAoeCAqUGNpdG9wb2xvZ3kpIGZyb21DKHhjICpDLmxpYnhs
X3BjaXRvcG9sb2d5KSBlcnJvciB7CiAJeC5TZWcgPSB1aW50MTYoeGMuc2VnKQogCXguQnVzID0g
Ynl0ZSh4Yy5idXMpCkBAIC0xMzc5LDYgKzIyOTcsMTUgQEAgZnVuYyAoeCAqUGNpdG9wb2xvZ3kp
IGZyb21DKHhjICpDLmxpYnhsX3BjaXRvcG9sb2d5KSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQog
CitmdW5jICh4ICpQY2l0b3BvbG9neSkgdG9DKCkgKHhjIEMubGlieGxfcGNpdG9wb2xvZ3ksIGVy
ciBlcnJvcikgeworCUMubGlieGxfcGNpdG9wb2xvZ3lfaW5pdCgmeGMpCisJeGMuc2VnID0gQy51
aW50MTZfdCh4LlNlZykKKwl4Yy5idXMgPSBDLnVpbnQ4X3QoeC5CdXMpCisJeGMuZGV2Zm4gPSBD
LnVpbnQ4X3QoeC5EZXZmbikKKwl4Yy5ub2RlID0gQy51aW50MzJfdCh4Lk5vZGUpCisJcmV0dXJu
IHhjLCBuaWwKK30KKwogZnVuYyAoeCAqU2NoZWRDcmVkaXRQYXJhbXMpIGZyb21DKHhjICpDLmxp
YnhsX3NjaGVkX2NyZWRpdF9wYXJhbXMpIGVycm9yIHsKIAl4LlRzbGljZU1zID0gaW50KHhjLnRz
bGljZV9tcykKIAl4LlJhdGVsaW1pdFVzID0gaW50KHhjLnJhdGVsaW1pdF91cykKQEAgLTEzODcs
MTIgKzIzMTQsMjYgQEAgZnVuYyAoeCAqU2NoZWRDcmVkaXRQYXJhbXMpIGZyb21DKHhjICpDLmxp
YnhsX3NjaGVkX2NyZWRpdF9wYXJhbXMpIGVycm9yIHsKIAlyZXR1cm4gbmlsCiB9CiAKK2Z1bmMg
KHggKlNjaGVkQ3JlZGl0UGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF9zY2hlZF9jcmVkaXRfcGFy
YW1zLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX3NjaGVkX2NyZWRpdF9wYXJhbXNfaW5pdCgmeGMp
CisJeGMudHNsaWNlX21zID0gQy5pbnQoeC5Uc2xpY2VNcykKKwl4Yy5yYXRlbGltaXRfdXMgPSBD
LmludCh4LlJhdGVsaW1pdFVzKQorCXhjLnZjcHVfbWlncl9kZWxheV91cyA9IEMuaW50KHguVmNw
dU1pZ3JEZWxheVVzKQorCXJldHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKlNjaGVkQ3JlZGl0
MlBhcmFtcykgZnJvbUMoeGMgKkMubGlieGxfc2NoZWRfY3JlZGl0Ml9wYXJhbXMpIGVycm9yIHsK
IAl4LlJhdGVsaW1pdFVzID0gaW50KHhjLnJhdGVsaW1pdF91cykKIAogCXJldHVybiBuaWwKIH0K
IAorZnVuYyAoeCAqU2NoZWRDcmVkaXQyUGFyYW1zKSB0b0MoKSAoeGMgQy5saWJ4bF9zY2hlZF9j
cmVkaXQyX3BhcmFtcywgZXJyIGVycm9yKSB7CisJQy5saWJ4bF9zY2hlZF9jcmVkaXQyX3BhcmFt
c19pbml0KCZ4YykKKwl4Yy5yYXRlbGltaXRfdXMgPSBDLmludCh4LlJhdGVsaW1pdFVzKQorCXJl
dHVybiB4YywgbmlsCit9CisKIGZ1bmMgKHggKkRvbWFpblJlbXVzSW5mbykgZnJvbUMoeGMgKkMu
bGlieGxfZG9tYWluX3JlbXVzX2luZm8pIGVycm9yIHsKIAl4LkludGVydmFsID0gaW50KHhjLmlu
dGVydmFsKQogCWlmIGVyciA6PSB4LkFsbG93VW5zYWZlLmZyb21DKCZ4Yy5hbGxvd191bnNhZmUp
OyBlcnIgIT0gbmlsIHsKQEAgLTE0MjEsNiArMjM2Miw0OCBAQCBmdW5jICh4ICpEb21haW5SZW11
c0luZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvKSBlcnJvciB7CiAJcmV0
dXJuIG5pbAogfQogCitmdW5jICh4ICpEb21haW5SZW11c0luZm8pIHRvQygpICh4YyBDLmxpYnhs
X2RvbWFpbl9yZW11c19pbmZvLCBlcnIgZXJyb3IpIHsKKwlDLmxpYnhsX2RvbWFpbl9yZW11c19p
bmZvX2luaXQoJnhjKQorCXhjLmludGVydmFsID0gQy5pbnQoeC5JbnRlcnZhbCkKKwl4Yy5hbGxv
d191bnNhZmUsIGVyciA9IHguQWxsb3dVbnNhZmUudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJ
Qy5saWJ4bF9kb21haW5fcmVtdXNfaW5mb19kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIK
Kwl9CisJeGMuYmxhY2tob2xlLCBlcnIgPSB4LkJsYWNraG9sZS50b0MoKQorCWlmIGVyciAhPSBu
aWwgeworCQlDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4g
eGMsIGVycgorCX0KKwl4Yy5jb21wcmVzc2lvbiwgZXJyID0geC5Db21wcmVzc2lvbi50b0MoKQor
CWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9yZW11c19pbmZvX2Rpc3Bvc2UoJnhj
KQorCQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5uZXRidWYsIGVyciA9IHguTmV0YnVmLnRvQygp
CisJaWYgZXJyICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgm
eGMpCisJCXJldHVybiB4YywgZXJyCisJfQorCXhjLm5ldGJ1ZnNjcmlwdCA9IEMuQ1N0cmluZyh4
Lk5ldGJ1ZnNjcmlwdCkKKwl4Yy5kaXNrYnVmLCBlcnIgPSB4LkRpc2tidWYudG9DKCkKKwlpZiBl
cnIgIT0gbmlsIHsKKwkJQy5saWJ4bF9kb21haW5fcmVtdXNfaW5mb19kaXNwb3NlKCZ4YykKKwkJ
cmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuY29sbywgZXJyID0geC5Db2xvLnRvQygpCisJaWYgZXJy
ICE9IG5pbCB7CisJCUMubGlieGxfZG9tYWluX3JlbXVzX2luZm9fZGlzcG9zZSgmeGMpCisJCXJl
dHVybiB4YywgZXJyCisJfQorCXhjLnVzZXJzcGFjZV9jb2xvX3Byb3h5LCBlcnIgPSB4LlVzZXJz
cGFjZUNvbG9Qcm94eS50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2RvbWFpbl9y
ZW11c19pbmZvX2Rpc3Bvc2UoJnhjKQorCQlyZXR1cm4geGMsIGVycgorCX0KKwlyZXR1cm4geGMs
IG5pbAorfQorCiBmdW5jICh4ICpFdmVudCkgZnJvbUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9y
IHsKIAlpZiBlcnIgOj0geC5MaW5rLmZyb21DKCZ4Yy5saW5rKTsgZXJyICE9IG5pbCB7CiAJCXJl
dHVybiBlcnIKQEAgLTE0OTAsNiArMjQ3MywyMyBAQCBmdW5jICh4ICpFdmVudFR5cGVVbmlvbk9w
ZXJhdGlvbkNvbXBsZXRlKSBmcm9tQyh4YyAqQy5saWJ4bF9ldmVudCkgZXJyb3IgewogCXJldHVy
biBuaWwKIH0KIAorZnVuYyAoeCAqRXZlbnQpIHRvQygpICh4YyBDLmxpYnhsX2V2ZW50LCBlcnIg
ZXJyb3IpIHsKKwlDLmxpYnhsX2V2ZW50X2luaXQoJnhjKQorCXhjLmxpbmssIGVyciA9IHguTGlu
ay50b0MoKQorCWlmIGVyciAhPSBuaWwgeworCQlDLmxpYnhsX2V2ZW50X2Rpc3Bvc2UoJnhjKQor
CQlyZXR1cm4geGMsIGVycgorCX0KKwl4Yy5kb21pZCA9IEMubGlieGxfZG9taWQoeC5Eb21pZCkK
Kwl4Yy5kb211dWlkLCBlcnIgPSB4LkRvbXV1aWQudG9DKCkKKwlpZiBlcnIgIT0gbmlsIHsKKwkJ
Qy5saWJ4bF9ldmVudF9kaXNwb3NlKCZ4YykKKwkJcmV0dXJuIHhjLCBlcnIKKwl9CisJeGMuZm9y
X3VzZXIgPSBDLnVpbnQ2NF90KHguRm9yVXNlcikKKwlyZXR1cm4geGMsIG5pbAorfQorCiBmdW5j
ICh4ICpQc3JDYXRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9wc3JfY2F0X2luZm8pIGVycm9yIHsK
IAl4LklkID0gdWludDMyKHhjLmlkKQogCXguQ29zTWF4ID0gdWludDMyKHhjLmNvc19tYXgpCkBA
IC0xNDk5LDYgKzI0OTksMTUgQEAgZnVuYyAoeCAqUHNyQ2F0SW5mbykgZnJvbUMoeGMgKkMubGli
eGxfcHNyX2NhdF9pbmZvKSBlcnJvciB7CiAJcmV0dXJuIG5pbAogfQogCitmdW5jICh4ICpQc3JD
YXRJbmZvKSB0b0MoKSAoeGMgQy5saWJ4bF9wc3JfY2F0X2luZm8sIGVyciBlcnJvcikgeworCUMu
bGlieGxfcHNyX2NhdF9pbmZvX2luaXQoJnhjKQorCXhjLmlkID0gQy51aW50MzJfdCh4LklkKQor
CXhjLmNvc19tYXggPSBDLnVpbnQzMl90KHguQ29zTWF4KQorCXhjLmNibV9sZW4gPSBDLnVpbnQz
Ml90KHguQ2JtTGVuKQorCXhjLmNkcF9lbmFibGVkID0gQy5ib29sKHguQ2RwRW5hYmxlZCkKKwly
ZXR1cm4geGMsIG5pbAorfQorCiBmdW5jICh4ICpQc3JId0luZm8pIGZyb21DKHhjICpDLmxpYnhs
X3Bzcl9od19pbmZvKSBlcnJvciB7CiAJeC5JZCA9IHVpbnQzMih4Yy5pZCkKIAl4LlR5cGUgPSBQ
c3JGZWF0VHlwZSh4Yy5fdHlwZSkKQEAgLTE1NDUsMyArMjU1NCw5IEBAIGZ1bmMgKHggKlBzckh3
SW5mb1R5cGVVbmlvbk1iYSkgZnJvbUMoeGMgKkMubGlieGxfcHNyX2h3X2luZm8pIGVycm9yIHsK
IAl4LkxpbmVhciA9IGJvb2wodG1wLmxpbmVhcikKIAlyZXR1cm4gbmlsCiB9CisKK2Z1bmMgKHgg
KlBzckh3SW5mbykgdG9DKCkgKHhjIEMubGlieGxfcHNyX2h3X2luZm8sIGVyciBlcnJvcikgewor
CUMubGlieGxfcHNyX2h3X2luZm9faW5pdCgmeGMpCisJeGMuaWQgPSBDLnVpbnQzMl90KHguSWQp
CisJcmV0dXJuIHhjLCBuaWwKK30KLS0gCjIuMTkuMQoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=

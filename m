Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id C2156F9107
	for <lists+xen-devel@lfdr.de>; Tue, 12 Nov 2019 14:50:26 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iUWWE-000483-FX; Tue, 12 Nov 2019 13:47:42 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=BqWi=ZE=oracle.com=daniel.kiper@srs-us1.protection.inumbo.net>)
 id 1iUWWC-00047p-Ej
 for xen-devel@lists.xenproject.org; Tue, 12 Nov 2019 13:47:40 +0000
X-Inumbo-ID: fd6dec32-0552-11ea-b678-bc764e2007e4
Received: from userp2120.oracle.com (unknown [156.151.31.85])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id fd6dec32-0552-11ea-b678-bc764e2007e4;
 Tue, 12 Nov 2019 13:47:39 +0000 (UTC)
Received: from pps.filterd (userp2120.oracle.com [127.0.0.1])
 by userp2120.oracle.com (8.16.0.27/8.16.0.27) with SMTP id xACDiUcO168872;
 Tue, 12 Nov 2019 13:47:12 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=oracle.com;
 h=from : to : cc :
 subject : date : message-id : in-reply-to : references; s=corp-2019-08-05;
 bh=YyKxGpJDpaDWifU0sKp3E5yL9HOsisRnsMM0XF0sVeM=;
 b=HcZJ91h/ZGq772sUekLep+y0Q6vRL8riKNnIi7Q3bsuwndaRTJ/jZ13vHVl3peKN7v01
 Me5QcZ4gpnJipZJrtUVt0QcU+GpP3oYEmCPnPi0pQder8pem5edAwx8TAOZBY0Sx/BDi
 cxXzuEYjXvFCJGe1B3R2EN7/NP5+1YifW0mPyLfSq03ZpE/ZoUcGUfgJN38FqbcOSAtP
 SoIdYgBD1K1kqN4gfh7q9meU2Rmu7HWYFsz9XGGTrcVQqt/pawo2bcoMRvfj1cPpDwxM
 UhcVXKuwuKM99w7ZbRmjQKxZIiOjL53AwlUzxQ+hAojLPcxfw1MuRXNFke4XuzUPUtcn RA== 
Received: from aserp3020.oracle.com (aserp3020.oracle.com [141.146.126.70])
 by userp2120.oracle.com with ESMTP id 2w5p3qmres-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Tue, 12 Nov 2019 13:47:12 +0000
Received: from pps.filterd (aserp3020.oracle.com [127.0.0.1])
 by aserp3020.oracle.com (8.16.0.27/8.16.0.27) with SMTP id xACDiCOP124160;
 Tue, 12 Nov 2019 13:47:11 GMT
Received: from userv0121.oracle.com (userv0121.oracle.com [156.151.31.72])
 by aserp3020.oracle.com with ESMTP id 2w7j00ubdq-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Tue, 12 Nov 2019 13:47:11 +0000
Received: from abhmp0012.oracle.com (abhmp0012.oracle.com [141.146.116.18])
 by userv0121.oracle.com (8.14.4/8.13.8) with ESMTP id xACDl9kc009153;
 Tue, 12 Nov 2019 13:47:09 GMT
Received: from tomti.i.net-space.pl (/10.175.202.33)
 by default (Oracle Beehive Gateway v4.0)
 with ESMTP ; Tue, 12 Nov 2019 05:47:08 -0800
From: Daniel Kiper <daniel.kiper@oracle.com>
To: linux-efi@vger.kernel.org, linux-kernel@vger.kernel.org, x86@kernel.org,
 xen-devel@lists.xenproject.org
Date: Tue, 12 Nov 2019 14:46:40 +0100
Message-Id: <20191112134640.16035-4-daniel.kiper@oracle.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20191112134640.16035-1-daniel.kiper@oracle.com>
References: <20191112134640.16035-1-daniel.kiper@oracle.com>
X-Proofpoint-Virus-Version: vendor=nai engine=6000 definitions=9438
 signatures=668685
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0 suspectscore=0
 malwarescore=0
 phishscore=0 bulkscore=0 spamscore=0 mlxscore=0 mlxlogscore=999
 adultscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.0.1-1910280000 definitions=main-1911120124
X-Proofpoint-Virus-Version: vendor=nai engine=6000 definitions=9438
 signatures=668685
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0
 priorityscore=1501 malwarescore=0
 suspectscore=0 phishscore=0 bulkscore=0 spamscore=0 clxscore=1015
 lowpriorityscore=0 mlxscore=0 impostorscore=0 mlxlogscore=999 adultscore=0
 classifier=spam adjust=0 reason=mlx scancount=1 engine=8.0.1-1910280000
 definitions=main-1911120124
Subject: [Xen-devel] [PATCH v6 3/3] x86/boot: Introduce the setup_indirect
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: jgross@suse.com, eric.snowberg@oracle.com, ard.biesheuvel@linaro.org,
 konrad.wilk@oracle.com, corbet@lwn.net, peterz@infradead.org,
 ross.philipson@oracle.com, dave.hansen@linux.intel.com, mingo@redhat.com,
 bp@alien8.de, rdunlap@infradead.org, luto@kernel.org, hpa@zytor.com,
 kanth.ghatraju@oracle.com, boris.ostrovsky@oracle.com, tglx@linutronix.de
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhlIHNldHVwX2RhdGEgaXMgYSBiaXQgYXdrd2FyZCB0byB1c2UgZm9yIGV4dHJlbWVseSBsYXJn
ZSBkYXRhIG9iamVjdHMsCmJvdGggYmVjYXVzZSB0aGUgc2V0dXBfZGF0YSBoZWFkZXIgaGFzIHRv
IGJlIGFkamFjZW50IHRvIHRoZSBkYXRhIG9iamVjdAphbmQgYmVjYXVzZSBpdCBoYXMgYSAzMi1i
aXQgbGVuZ3RoIGZpZWxkLiBIb3dldmVyLCBpdCBpcyBpbXBvcnRhbnQgdGhhdAppbnRlcm1lZGlh
dGUgc3RhZ2VzIG9mIHRoZSBib290IHByb2Nlc3MgaGF2ZSBhIHdheSB0byBpZGVudGlmeSB3aGlj
aApjaHVua3Mgb2YgbWVtb3J5IGFyZSBvY2N1cGllZCBieSBrZXJuZWwgZGF0YS4gVGh1cyBpbnRy
b2R1Y2UgYW4gdW5pZm9ybQp3YXkgdG8gc3BlY2lmeSBzdWNoIGluZGlyZWN0IGRhdGEgYXMgc2V0
dXBfaW5kaXJlY3Qgc3RydWN0IGFuZApTRVRVUF9JTkRJUkVDVCB0eXBlLgoKQW5kIGZpbmFsbHkg
YnVtcCBzZXR1cF9oZWFkZXIgdmVyc2lvbiBpbiBhcmNoL3g4Ni9ib290L2hlYWRlci5TLgoKU3Vn
Z2VzdGVkLWJ5OiBILiBQZXRlciBBbnZpbiAoSW50ZWwpIDxocGFAenl0b3IuY29tPgpTaWduZWQt
b2ZmLWJ5OiBEYW5pZWwgS2lwZXIgPGRhbmllbC5raXBlckBvcmFjbGUuY29tPgpBY2tlZC1ieTog
S29ucmFkIFJ6ZXN6dXRlayBXaWxrIDxrb25yYWQud2lsa0BvcmFjbGUuY29tPgpSZXZpZXdlZC1i
eTogUm9zcyBQaGlsaXBzb24gPHJvc3MucGhpbGlwc29uQG9yYWNsZS5jb20+ClJldmlld2VkLWJ5
OiBILiBQZXRlciBBbnZpbiAoSW50ZWwpIDxocGFAenl0b3IuY29tPgotLS0KdjYgLSBzdWdnZXN0
aW9ucy9maXhlczoKICAgLSBhZGQgYSBjb21tZW50IHRvIGFyY2gveDg2L2tlcm5lbC9rZGVidWdm
cy5jCiAgICAgKHN1Z2dlc3RlZCBieSBCb3Jpc2xhdiBQZXRrb3YpLAogICAtIGRvIHNvbWUgZm9y
bWF0dGluZyB0cmlja3MgdG8gaW5jcmVhc2UgY29kZSByZWFkYWJpbGl0eQogICAgIChzdWdnZXN0
ZWQgYnkgQm9yaXNsYXYgUGV0a292KSwKICAgLSBkcm9wICJ3ZSIgZnJvbSB0aGUgY29tbWl0IG1l
c3NhZ2UKICAgICAoc3VnZ2VzdGVkIGJ5IEJvcmlzbGF2IFBldGtvdikuCgp2NSAtIHN1Z2dlc3Rp
b25zL2ZpeGVzOgogICAtIGJ1bXAgc2V0dXBfaGVhZGVyIHZlcnNpb24gaW4gYXJjaC94ODYvYm9v
dC9oZWFkZXIuUwogICAgIChzdWdnZXN0ZWQgYnkgSC4gUGV0ZXIgQW52aW4pLgoKdjQgLSBzdWdn
ZXN0aW9ucy9maXhlczoKICAgLSBjaGFuZ2UgIk5vdGU6IiB0byAiLi4gbm90ZTo6Ii4KCnYzIC0g
c3VnZ2VzdGlvbnMvZml4ZXM6CiAgIC0gYWRkIHNldHVwX2luZGlyZWN0IG1hcHBpbmcvS0FTTFIg
YXZvaWRhbmNlL2V0Yy4gY29kZQogICAgIChzdWdnZXN0ZWQgYnkgSC4gUGV0ZXIgQW52aW4pLAog
ICAtIHRoZSBTRVRVUF9JTkRJUkVDVCBzZXRzIG1vc3Qgc2lnbmlmaWNhbnQgYml0IHJpZ2h0IG5v
dzsKICAgICB0aGlzIHdheSBpdCBpcyBwb3NzaWJsZSB0byBkaWZmZXJlbnRpYXRlIHJlZ3VsYXIg
c2V0dXBfZGF0YQogICAgIGFuZCBzZXR1cF9pbmRpcmVjdCBvYmplY3RzIGluIHRoZSBkZWJ1Z2Zz
IGZpbGVzeXN0ZW0uCgp2MiAtIHN1Z2dlc3Rpb25zL2ZpeGVzOgogICAtIGFkZCBzZXR1cF9pbmRp
cmVjdCB1c2FnZSBleGFtcGxlCiAgICAgKHN1Z2dlc3RlZCBieSBFcmljIFNub3diZXJnIGFuZCBS
b3NzIFBoaWxpcHNvbikuCi0tLQogRG9jdW1lbnRhdGlvbi94ODYvYm9vdC5yc3QgICAgICAgICAg
ICAgfCA0MyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiBhcmNoL3g4Ni9ib290
L2NvbXByZXNzZWQva2FzbHIuYyAgICAgICB8IDEyICsrKysrKysrKysKIGFyY2gveDg2L2Jvb3Qv
Y29tcHJlc3NlZC9rZXJuZWxfaW5mby5TIHwgIDIgKy0KIGFyY2gveDg2L2Jvb3QvaGVhZGVyLlMg
ICAgICAgICAgICAgICAgIHwgIDIgKy0KIGFyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20vYm9vdHBh
cmFtLmggIHwgMTYgKysrKysrKysrKy0tLQogYXJjaC94ODYva2VybmVsL2U4MjAuYyAgICAgICAg
ICAgICAgICAgfCAxMSArKysrKysrKysKIGFyY2gveDg2L2tlcm5lbC9rZGVidWdmcy5jICAgICAg
ICAgICAgIHwgMjEgKysrKysrKysrKysrKy0tLS0KIGFyY2gveDg2L2tlcm5lbC9rc3lzZnMuYyAg
ICAgICAgICAgICAgIHwgMzEgKysrKysrKysrKysrKysrKysrLS0tLS0tCiBhcmNoL3g4Ni9rZXJu
ZWwvc2V0dXAuYyAgICAgICAgICAgICAgICB8ICA2ICsrKysrCiBhcmNoL3g4Ni9tbS9pb3JlbWFw
LmMgICAgICAgICAgICAgICAgICB8IDExICsrKysrKysrKwogMTAgZmlsZXMgY2hhbmdlZCwgMTM4
IGluc2VydGlvbnMoKyksIDE3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRp
b24veDg2L2Jvb3QucnN0IGIvRG9jdW1lbnRhdGlvbi94ODYvYm9vdC5yc3QKaW5kZXggNmNkZDc2
N2MzODM1Li45MGJiOGY1YWIzODQgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24veDg2L2Jvb3Qu
cnN0CisrKyBiL0RvY3VtZW50YXRpb24veDg2L2Jvb3QucnN0CkBAIC04MjcsNiArODI3LDQ3IEBA
IFByb3RvY29sOgkyLjA5KwogICBzdXJlIHRvIGNvbnNpZGVyIHRoZSBjYXNlIHdoZXJlIHRoZSBs
aW5rZWQgbGlzdCBhbHJlYWR5IGNvbnRhaW5zCiAgIGVudHJpZXMuCiAKKyAgVGhlIHNldHVwX2Rh
dGEgaXMgYSBiaXQgYXdrd2FyZCB0byB1c2UgZm9yIGV4dHJlbWVseSBsYXJnZSBkYXRhIG9iamVj
dHMsCisgIGJvdGggYmVjYXVzZSB0aGUgc2V0dXBfZGF0YSBoZWFkZXIgaGFzIHRvIGJlIGFkamFj
ZW50IHRvIHRoZSBkYXRhIG9iamVjdAorICBhbmQgYmVjYXVzZSBpdCBoYXMgYSAzMi1iaXQgbGVu
Z3RoIGZpZWxkLiBIb3dldmVyLCBpdCBpcyBpbXBvcnRhbnQgdGhhdAorICBpbnRlcm1lZGlhdGUg
c3RhZ2VzIG9mIHRoZSBib290IHByb2Nlc3MgaGF2ZSBhIHdheSB0byBpZGVudGlmeSB3aGljaAor
ICBjaHVua3Mgb2YgbWVtb3J5IGFyZSBvY2N1cGllZCBieSBrZXJuZWwgZGF0YS4KKworICBUaHVz
IHNldHVwX2luZGlyZWN0IHN0cnVjdCBhbmQgU0VUVVBfSU5ESVJFQ1QgdHlwZSB3ZXJlIGludHJv
ZHVjZWQgaW4KKyAgcHJvdG9jb2wgMi4xNS4KKworICBzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3Qgewor
ICAgIF9fdTMyIHR5cGU7CisgICAgX191MzIgcmVzZXJ2ZWQ7ICAvKiBSZXNlcnZlZCwgbXVzdCBi
ZSBzZXQgdG8gemVyby4gKi8KKyAgICBfX3U2NCBsZW47CisgICAgX191NjQgYWRkcjsKKyAgfTsK
KworICBUaGUgdHlwZSBtZW1iZXIgaXMgYSBTRVRVUF9JTkRJUkVDVCB8IFNFVFVQXyogdHlwZS4g
SG93ZXZlciwgaXQgY2Fubm90IGJlCisgIFNFVFVQX0lORElSRUNUIGl0c2VsZiBzaW5jZSBtYWtp
bmcgdGhlIHNldHVwX2luZGlyZWN0IGEgdHJlZSBzdHJ1Y3R1cmUKKyAgY291bGQgcmVxdWlyZSBh
IGxvdCBvZiBzdGFjayBzcGFjZSBpbiBzb21ldGhpbmcgdGhhdCBuZWVkcyB0byBwYXJzZSBpdAor
ICBhbmQgc3RhY2sgc3BhY2UgY2FuIGJlIGxpbWl0ZWQgaW4gYm9vdCBjb250ZXh0cy4KKworICBM
ZXQncyBnaXZlIGFuIGV4YW1wbGUgaG93IHRvIHBvaW50IHRvIFNFVFVQX0U4MjBfRVhUIGRhdGEg
dXNpbmcgc2V0dXBfaW5kaXJlY3QuCisgIEluIHRoaXMgY2FzZSBzZXR1cF9kYXRhIGFuZCBzZXR1
cF9pbmRpcmVjdCB3aWxsIGxvb2sgbGlrZSB0aGlzOgorCisgIHN0cnVjdCBzZXR1cF9kYXRhIHsK
KyAgICBfX3U2NCBuZXh0ID0gMCBvciA8YWRkcl9vZl9uZXh0X3NldHVwX2RhdGFfc3RydWN0PjsK
KyAgICBfX3UzMiB0eXBlID0gU0VUVVBfSU5ESVJFQ1Q7CisgICAgX191MzIgbGVuID0gc2l6ZW9m
KHNldHVwX2RhdGEpOworICAgIF9fdTggZGF0YVtzaXplb2Yoc2V0dXBfaW5kaXJlY3QpXSA9IHN0
cnVjdCBzZXR1cF9pbmRpcmVjdCB7CisgICAgICBfX3UzMiB0eXBlID0gU0VUVVBfSU5ESVJFQ1Qg
fCBTRVRVUF9FODIwX0VYVDsKKyAgICAgIF9fdTMyIHJlc2VydmVkID0gMDsKKyAgICAgIF9fdTY0
IGxlbiA9IDxsZW5fb2ZfU0VUVVBfRTgyMF9FWFRfZGF0YT47CisgICAgICBfX3U2NCBhZGRyID0g
PGFkZHJfb2ZfU0VUVVBfRTgyMF9FWFRfZGF0YT47CisgICAgfQorICB9CisKKy4uIG5vdGU6Ogor
ICAgICBTRVRVUF9JTkRJUkVDVCB8IFNFVFVQX05PTkUgb2JqZWN0cyBjYW5ub3QgYmUgcHJvcGVy
bHkgZGlzdGluZ3Vpc2hlZAorICAgICBmcm9tIFNFVFVQX0lORElSRUNUIGl0c2VsZi4gU28sIHRo
aXMga2luZCBvZiBvYmplY3RzIGNhbm5vdCBiZSBwcm92aWRlZAorICAgICBieSB0aGUgYm9vdGxv
YWRlcnMuCisKID09PT09PT09PT09PQk9PT09PT09PT09PT0KIEZpZWxkIG5hbWU6CXByZWZfYWRk
cmVzcwogVHlwZToJCXJlYWQgKHJlbG9jKQpAQCAtOTg2LDcgKzEwMjcsNyBAQCBGaWVsZCBuYW1l
OglzZXR1cF90eXBlX21heAogT2Zmc2V0L3NpemU6CTB4MDAwYy80CiA9PT09PT09PT09PT0JPT09
PT09PT09PT09PT0KIAotICBUaGlzIGZpZWxkIGNvbnRhaW5zIG1heGltYWwgYWxsb3dlZCB0eXBl
IGZvciBzZXR1cF9kYXRhLgorICBUaGlzIGZpZWxkIGNvbnRhaW5zIG1heGltYWwgYWxsb3dlZCB0
eXBlIGZvciBzZXR1cF9kYXRhIGFuZCBzZXR1cF9pbmRpcmVjdCBzdHJ1Y3RzLgogCiAKIFRoZSBJ
bWFnZSBDaGVja3N1bQpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvYm9vdC9jb21wcmVzc2VkL2thc2xy
LmMgYi9hcmNoL3g4Ni9ib290L2NvbXByZXNzZWQva2FzbHIuYwppbmRleCAyZTUzYzA1NmJhMjAu
LmJiOWJmZWYxNzRhZSAxMDA2NDQKLS0tIGEvYXJjaC94ODYvYm9vdC9jb21wcmVzc2VkL2thc2xy
LmMKKysrIGIvYXJjaC94ODYvYm9vdC9jb21wcmVzc2VkL2thc2xyLmMKQEAgLTQ1OSw2ICs0NTks
MTggQEAgc3RhdGljIGJvb2wgbWVtX2F2b2lkX292ZXJsYXAoc3RydWN0IG1lbV92ZWN0b3IgKmlt
ZywKIAkJCWlzX292ZXJsYXBwaW5nID0gdHJ1ZTsKIAkJfQogCisJCWlmIChwdHItPnR5cGUgPT0g
U0VUVVBfSU5ESVJFQ1QgJiYKKwkJICAgICgoc3RydWN0IHNldHVwX2luZGlyZWN0ICopcHRyLT5k
YXRhKS0+dHlwZSAhPSBTRVRVUF9JTkRJUkVDVCkgeworCQkJYXZvaWQuc3RhcnQgPSAoKHN0cnVj
dCBzZXR1cF9pbmRpcmVjdCAqKXB0ci0+ZGF0YSktPmFkZHI7CisJCQlhdm9pZC5zaXplID0gKChz
dHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilwdHItPmRhdGEpLT5sZW47CisKKwkJCWlmIChtZW1fb3Zl
cmxhcHMoaW1nLCAmYXZvaWQpICYmIChhdm9pZC5zdGFydCA8IGVhcmxpZXN0KSkgeworCQkJCSpv
dmVybGFwID0gYXZvaWQ7CisJCQkJZWFybGllc3QgPSBvdmVybGFwLT5zdGFydDsKKwkJCQlpc19v
dmVybGFwcGluZyA9IHRydWU7CisJCQl9CisJCX0KKwogCQlwdHIgPSAoc3RydWN0IHNldHVwX2Rh
dGEgKikodW5zaWduZWQgbG9uZylwdHItPm5leHQ7CiAJfQogCmRpZmYgLS1naXQgYS9hcmNoL3g4
Ni9ib290L2NvbXByZXNzZWQva2VybmVsX2luZm8uUyBiL2FyY2gveDg2L2Jvb3QvY29tcHJlc3Nl
ZC9rZXJuZWxfaW5mby5TCmluZGV4IDAxOGRhY2JkNzUzZS4uZjgxOGVlOGZiYTM4IDEwMDY0NAot
LS0gYS9hcmNoL3g4Ni9ib290L2NvbXByZXNzZWQva2VybmVsX2luZm8uUworKysgYi9hcmNoL3g4
Ni9ib290L2NvbXByZXNzZWQva2VybmVsX2luZm8uUwpAQCAtMTQsNyArMTQsNyBAQCBrZXJuZWxf
aW5mbzoKIAkvKiBTaXplIHRvdGFsLiAqLwogCS5sb25nCWtlcm5lbF9pbmZvX2VuZCAtIGtlcm5l
bF9pbmZvCiAKLQkvKiBNYXhpbWFsIGFsbG93ZWQgdHlwZSBmb3Igc2V0dXBfZGF0YS4gKi8KKwkv
KiBNYXhpbWFsIGFsbG93ZWQgdHlwZSBmb3Igc2V0dXBfZGF0YSBhbmQgc2V0dXBfaW5kaXJlY3Qg
c3RydWN0cy4gKi8KIAkubG9uZwlTRVRVUF9UWVBFX01BWAogCiBrZXJuZWxfaW5mb192YXJfbGVu
X2RhdGE6CmRpZmYgLS1naXQgYS9hcmNoL3g4Ni9ib290L2hlYWRlci5TIGIvYXJjaC94ODYvYm9v
dC9oZWFkZXIuUwppbmRleCAyMmRjZWNhYWE4OTguLjk3ZDliNmQ2YzFhZiAxMDA2NDQKLS0tIGEv
YXJjaC94ODYvYm9vdC9oZWFkZXIuUworKysgYi9hcmNoL3g4Ni9ib290L2hlYWRlci5TCkBAIC0z
MDAsNyArMzAwLDcgQEAgX3N0YXJ0OgogCSMgUGFydCAyIG9mIHRoZSBoZWFkZXIsIGZyb20gdGhl
IG9sZCBzZXR1cC5TCiAKIAkJLmFzY2lpCSJIZHJTIgkJIyBoZWFkZXIgc2lnbmF0dXJlCi0JCS53
b3JkCTB4MDIwZAkJIyBoZWFkZXIgdmVyc2lvbiBudW1iZXIgKD49IDB4MDEwNSkKKwkJLndvcmQJ
MHgwMjBmCQkjIGhlYWRlciB2ZXJzaW9uIG51bWJlciAoPj0gMHgwMTA1KQogCQkJCQkjIG9yIGVs
c2Ugb2xkIGxvYWRsaW4tMS41IHdpbGwgZmFpbCkKIAkJLmdsb2JsIHJlYWxtb2RlX3N3dGNoCiBy
ZWFsbW9kZV9zd3RjaDoJLndvcmQJMCwgMAkJIyBkZWZhdWx0X3N3aXRjaCwgU0VUVVBTRUcKZGlm
ZiAtLWdpdCBhL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20vYm9vdHBhcmFtLmggYi9hcmNoL3g4
Ni9pbmNsdWRlL3VhcGkvYXNtL2Jvb3RwYXJhbS5oCmluZGV4IGRiYjQxMTI4ZTVhMC4uOTQ5MDY2
YjUzOThhIDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9pbmNsdWRlL3VhcGkvYXNtL2Jvb3RwYXJhbS5o
CisrKyBiL2FyY2gveDg2L2luY2x1ZGUvdWFwaS9hc20vYm9vdHBhcmFtLmgKQEAgLTIsNyArMiw3
IEBACiAjaWZuZGVmIF9BU01fWDg2X0JPT1RQQVJBTV9ICiAjZGVmaW5lIF9BU01fWDg2X0JPT1RQ
QVJBTV9ICiAKLS8qIHNldHVwX2RhdGEgdHlwZXMgKi8KKy8qIHNldHVwX2RhdGEvc2V0dXBfaW5k
aXJlY3QgdHlwZXMgKi8KICNkZWZpbmUgU0VUVVBfTk9ORQkJCTAKICNkZWZpbmUgU0VUVVBfRTgy
MF9FWFQJCQkxCiAjZGVmaW5lIFNFVFVQX0RUQgkJCTIKQEAgLTExLDggKzExLDEwIEBACiAjZGVm
aW5lIFNFVFVQX0FQUExFX1BST1BFUlRJRVMJCTUKICNkZWZpbmUgU0VUVVBfSkFJTEhPVVNFCQkJ
NgogCi0vKiBtYXgoU0VUVVBfKikgKi8KLSNkZWZpbmUgU0VUVVBfVFlQRV9NQVgJCQlTRVRVUF9K
QUlMSE9VU0UKKyNkZWZpbmUgU0VUVVBfSU5ESVJFQ1QJCQkoMTw8MzEpCisKKy8qIFNFVFVQX0lO
RElSRUNUIHwgbWF4KFNFVFVQXyopICovCisjZGVmaW5lIFNFVFVQX1RZUEVfTUFYCQkJKFNFVFVQ
X0lORElSRUNUIHwgU0VUVVBfSkFJTEhPVVNFKQogCiAvKiByYW1fc2l6ZSBmbGFncyAqLwogI2Rl
ZmluZSBSQU1ESVNLX0lNQUdFX1NUQVJUX01BU0sJMHgwN0ZGCkBAIC01Miw2ICs1NCwxNCBAQCBz
dHJ1Y3Qgc2V0dXBfZGF0YSB7CiAJX191OCBkYXRhWzBdOwogfTsKIAorLyogZXh0ZW5zaWJsZSBz
ZXR1cCBpbmRpcmVjdCBkYXRhIG5vZGUgKi8KK3N0cnVjdCBzZXR1cF9pbmRpcmVjdCB7CisJX191
MzIgdHlwZTsKKwlfX3UzMiByZXNlcnZlZDsgIC8qIFJlc2VydmVkLCBtdXN0IGJlIHNldCB0byB6
ZXJvLiAqLworCV9fdTY0IGxlbjsKKwlfX3U2NCBhZGRyOworfTsKKwogc3RydWN0IHNldHVwX2hl
YWRlciB7CiAJX191OAlzZXR1cF9zZWN0czsKIAlfX3UxNglyb290X2ZsYWdzOwpkaWZmIC0tZ2l0
IGEvYXJjaC94ODYva2VybmVsL2U4MjAuYyBiL2FyY2gveDg2L2tlcm5lbC9lODIwLmMKaW5kZXgg
N2RhMmJjZDJiOGViLi4wYmZlOWE2ODViM2IgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2tlcm5lbC9l
ODIwLmMKKysrIGIvYXJjaC94ODYva2VybmVsL2U4MjAuYwpAQCAtOTk5LDYgKzk5OSwxNyBAQCB2
b2lkIF9faW5pdCBlODIwX19yZXNlcnZlX3NldHVwX2RhdGEodm9pZCkKIAkJZGF0YSA9IGVhcmx5
X21lbXJlbWFwKHBhX2RhdGEsIHNpemVvZigqZGF0YSkpOwogCQllODIwX19yYW5nZV91cGRhdGUo
cGFfZGF0YSwgc2l6ZW9mKCpkYXRhKStkYXRhLT5sZW4sIEU4MjBfVFlQRV9SQU0sIEU4MjBfVFlQ
RV9SRVNFUlZFRF9LRVJOKTsKIAkJZTgyMF9fcmFuZ2VfdXBkYXRlX2tleGVjKHBhX2RhdGEsIHNp
emVvZigqZGF0YSkrZGF0YS0+bGVuLCBFODIwX1RZUEVfUkFNLCBFODIwX1RZUEVfUkVTRVJWRURf
S0VSTik7CisKKwkJaWYgKGRhdGEtPnR5cGUgPT0gU0VUVVBfSU5ESVJFQ1QgJiYKKwkJICAgICgo
c3RydWN0IHNldHVwX2luZGlyZWN0ICopZGF0YS0+ZGF0YSktPnR5cGUgIT0gU0VUVVBfSU5ESVJF
Q1QpIHsKKwkJCWU4MjBfX3JhbmdlX3VwZGF0ZSgoKHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRh
dGEtPmRhdGEpLT5hZGRyLAorCQkJCQkgICAoKHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRhdGEt
PmRhdGEpLT5sZW4sCisJCQkJCSAgIEU4MjBfVFlQRV9SQU0sIEU4MjBfVFlQRV9SRVNFUlZFRF9L
RVJOKTsKKwkJCWU4MjBfX3JhbmdlX3VwZGF0ZV9rZXhlYygoKHN0cnVjdCBzZXR1cF9pbmRpcmVj
dCAqKWRhdGEtPmRhdGEpLT5hZGRyLAorCQkJCQkJICgoc3RydWN0IHNldHVwX2luZGlyZWN0ICop
ZGF0YS0+ZGF0YSktPmxlbiwKKwkJCQkJCSBFODIwX1RZUEVfUkFNLCBFODIwX1RZUEVfUkVTRVJW
RURfS0VSTik7CisJCX0KKwogCQlwYV9kYXRhID0gZGF0YS0+bmV4dDsKIAkJZWFybHlfbWVtdW5t
YXAoZGF0YSwgc2l6ZW9mKCpkYXRhKSk7CiAJfQpkaWZmIC0tZ2l0IGEvYXJjaC94ODYva2VybmVs
L2tkZWJ1Z2ZzLmMgYi9hcmNoL3g4Ni9rZXJuZWwva2RlYnVnZnMuYwppbmRleCBlZGFhMzBiMjA4
NDEuLjY0YjZkYTk1YWY5OCAxMDA2NDQKLS0tIGEvYXJjaC94ODYva2VybmVsL2tkZWJ1Z2ZzLmMK
KysrIGIvYXJjaC94ODYva2VybmVsL2tkZWJ1Z2ZzLmMKQEAgLTQ0LDcgKzQ0LDEyIEBAIHN0YXRp
YyBzc2l6ZV90IHNldHVwX2RhdGFfcmVhZChzdHJ1Y3QgZmlsZSAqZmlsZSwgY2hhciBfX3VzZXIg
KnVzZXJfYnVmLAogCWlmIChjb3VudCA+IG5vZGUtPmxlbiAtIHBvcykKIAkJY291bnQgPSBub2Rl
LT5sZW4gLSBwb3M7CiAKLQlwYSA9IG5vZGUtPnBhZGRyICsgc2l6ZW9mKHN0cnVjdCBzZXR1cF9k
YXRhKSArIHBvczsKKwlwYSA9IG5vZGUtPnBhZGRyICsgcG9zOworCisJLyogSXMgaXQgZGlyZWN0
IGRhdGEgb3IgaW52YWxpZCBpbmRpcmVjdCBvbmU/ICovCisJaWYgKCEobm9kZS0+dHlwZSAmIFNF
VFVQX0lORElSRUNUKSB8fCBub2RlLT50eXBlID09IFNFVFVQX0lORElSRUNUKQorCQlwYSArPSBz
aXplb2Yoc3RydWN0IHNldHVwX2RhdGEpOworCiAJcCA9IG1lbXJlbWFwKHBhLCBjb3VudCwgTUVN
UkVNQVBfV0IpOwogCWlmICghcCkKIAkJcmV0dXJuIC1FTk9NRU07CkBAIC0xMDgsOSArMTEzLDE3
IEBAIHN0YXRpYyBpbnQgX19pbml0IGNyZWF0ZV9zZXR1cF9kYXRhX25vZGVzKHN0cnVjdCBkZW50
cnkgKnBhcmVudCkKIAkJCWdvdG8gZXJyX2RpcjsKIAkJfQogCi0JCW5vZGUtPnBhZGRyID0gcGFf
ZGF0YTsKLQkJbm9kZS0+dHlwZSA9IGRhdGEtPnR5cGU7Ci0JCW5vZGUtPmxlbiA9IGRhdGEtPmxl
bjsKKwkJaWYgKGRhdGEtPnR5cGUgPT0gU0VUVVBfSU5ESVJFQ1QgJiYKKwkJICAgICgoc3RydWN0
IHNldHVwX2luZGlyZWN0ICopZGF0YS0+ZGF0YSktPnR5cGUgIT0gU0VUVVBfSU5ESVJFQ1QpIHsK
KwkJCW5vZGUtPnBhZGRyID0gKChzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilkYXRhLT5kYXRhKS0+
YWRkcjsKKwkJCW5vZGUtPnR5cGUgID0gKChzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilkYXRhLT5k
YXRhKS0+dHlwZTsKKwkJCW5vZGUtPmxlbiAgID0gKChzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilk
YXRhLT5kYXRhKS0+bGVuOworCQl9IGVsc2UgeworCQkJbm9kZS0+cGFkZHIgPSBwYV9kYXRhOwor
CQkJbm9kZS0+dHlwZSAgPSBkYXRhLT50eXBlOworCQkJbm9kZS0+bGVuICAgPSBkYXRhLT5sZW47
CisJCX0KKwogCQljcmVhdGVfc2V0dXBfZGF0YV9ub2RlKGQsIG5vLCBub2RlKTsKIAkJcGFfZGF0
YSA9IGRhdGEtPm5leHQ7CiAKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2tlcm5lbC9rc3lzZnMuYyBi
L2FyY2gveDg2L2tlcm5lbC9rc3lzZnMuYwppbmRleCA3OTY5ZGE5MzkyMTMuLmQwYTE5MTIxYzZh
NCAxMDA2NDQKLS0tIGEvYXJjaC94ODYva2VybmVsL2tzeXNmcy5jCisrKyBiL2FyY2gveDg2L2tl
cm5lbC9rc3lzZnMuYwpAQCAtMTAwLDcgKzEwMCwxMiBAQCBzdGF0aWMgaW50IF9faW5pdCBnZXRf
c2V0dXBfZGF0YV9zaXplKGludCBuciwgc2l6ZV90ICpzaXplKQogCQlpZiAoIWRhdGEpCiAJCQly
ZXR1cm4gLUVOT01FTTsKIAkJaWYgKG5yID09IGkpIHsKLQkJCSpzaXplID0gZGF0YS0+bGVuOwor
CQkJaWYgKGRhdGEtPnR5cGUgPT0gU0VUVVBfSU5ESVJFQ1QgJiYKKwkJCSAgICAoKHN0cnVjdCBz
ZXR1cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT50eXBlICE9IFNFVFVQX0lORElSRUNUKQorCQkJ
CSpzaXplID0gKChzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilkYXRhLT5kYXRhKS0+bGVuOworCQkJ
ZWxzZQorCQkJCSpzaXplID0gZGF0YS0+bGVuOworCiAJCQltZW11bm1hcChkYXRhKTsKIAkJCXJl
dHVybiAwOwogCQl9CkBAIC0xMzAsNyArMTM1LDEwIEBAIHN0YXRpYyBzc2l6ZV90IHR5cGVfc2hv
dyhzdHJ1Y3Qga29iamVjdCAqa29iaiwKIAlpZiAoIWRhdGEpCiAJCXJldHVybiAtRU5PTUVNOwog
Ci0JcmV0ID0gc3ByaW50ZihidWYsICIweCV4XG4iLCBkYXRhLT50eXBlKTsKKwlpZiAoZGF0YS0+
dHlwZSA9PSBTRVRVUF9JTkRJUkVDVCkKKwkJcmV0ID0gc3ByaW50ZihidWYsICIweCV4XG4iLCAo
KHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT50eXBlKTsKKwllbHNlCisJCXJl
dCA9IHNwcmludGYoYnVmLCAiMHgleFxuIiwgZGF0YS0+dHlwZSk7CiAJbWVtdW5tYXAoZGF0YSk7
CiAJcmV0dXJuIHJldDsKIH0KQEAgLTE0Miw3ICsxNTAsNyBAQCBzdGF0aWMgc3NpemVfdCBzZXR1
cF9kYXRhX2RhdGFfcmVhZChzdHJ1Y3QgZmlsZSAqZnAsCiAJCQkJICAgIGxvZmZfdCBvZmYsIHNp
emVfdCBjb3VudCkKIHsKIAlpbnQgbnIsIHJldCA9IDA7Ci0JdTY0IHBhZGRyOworCXU2NCBwYWRk
ciwgbGVuOwogCXN0cnVjdCBzZXR1cF9kYXRhICpkYXRhOwogCXZvaWQgKnA7CiAKQEAgLTE1Nywx
OSArMTY1LDI4IEBAIHN0YXRpYyBzc2l6ZV90IHNldHVwX2RhdGFfZGF0YV9yZWFkKHN0cnVjdCBm
aWxlICpmcCwKIAlpZiAoIWRhdGEpCiAJCXJldHVybiAtRU5PTUVNOwogCi0JaWYgKG9mZiA+IGRh
dGEtPmxlbikgeworCWlmIChkYXRhLT50eXBlID09IFNFVFVQX0lORElSRUNUICYmCisJICAgICgo
c3RydWN0IHNldHVwX2luZGlyZWN0ICopZGF0YS0+ZGF0YSktPnR5cGUgIT0gU0VUVVBfSU5ESVJF
Q1QpIHsKKwkJcGFkZHIgPSAoKHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT5h
ZGRyOworCQlsZW4gPSAoKHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT5sZW47
CisJfSBlbHNlIHsKKwkJcGFkZHIgKz0gc2l6ZW9mKCpkYXRhKTsKKwkJbGVuID0gZGF0YS0+bGVu
OworCX0KKworCWlmIChvZmYgPiBsZW4pIHsKIAkJcmV0ID0gLUVJTlZBTDsKIAkJZ290byBvdXQ7
CiAJfQogCi0JaWYgKGNvdW50ID4gZGF0YS0+bGVuIC0gb2ZmKQotCQljb3VudCA9IGRhdGEtPmxl
biAtIG9mZjsKKwlpZiAoY291bnQgPiBsZW4gLSBvZmYpCisJCWNvdW50ID0gbGVuIC0gb2ZmOwog
CiAJaWYgKCFjb3VudCkKIAkJZ290byBvdXQ7CiAKIAlyZXQgPSBjb3VudDsKLQlwID0gbWVtcmVt
YXAocGFkZHIgKyBzaXplb2YoKmRhdGEpLCBkYXRhLT5sZW4sIE1FTVJFTUFQX1dCKTsKKwlwID0g
bWVtcmVtYXAocGFkZHIsIGxlbiwgTUVNUkVNQVBfV0IpOwogCWlmICghcCkgewogCQlyZXQgPSAt
RU5PTUVNOwogCQlnb3RvIG91dDsKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2tlcm5lbC9zZXR1cC5j
IGIvYXJjaC94ODYva2VybmVsL3NldHVwLmMKaW5kZXggNzdlYTk2Yjc5NGJkLi44ZjQ4YmI4ZjJj
ZWIgMTAwNjQ0Ci0tLSBhL2FyY2gveDg2L2tlcm5lbC9zZXR1cC5jCisrKyBiL2FyY2gveDg2L2tl
cm5lbC9zZXR1cC5jCkBAIC00MzgsNiArNDM4LDEyIEBAIHN0YXRpYyB2b2lkIF9faW5pdCBtZW1i
bG9ja194ODZfcmVzZXJ2ZV9yYW5nZV9zZXR1cF9kYXRhKHZvaWQpCiAJd2hpbGUgKHBhX2RhdGEp
IHsKIAkJZGF0YSA9IGVhcmx5X21lbXJlbWFwKHBhX2RhdGEsIHNpemVvZigqZGF0YSkpOwogCQlt
ZW1ibG9ja19yZXNlcnZlKHBhX2RhdGEsIHNpemVvZigqZGF0YSkgKyBkYXRhLT5sZW4pOworCisJ
CWlmIChkYXRhLT50eXBlID09IFNFVFVQX0lORElSRUNUICYmCisJCSAgICAoKHN0cnVjdCBzZXR1
cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT50eXBlICE9IFNFVFVQX0lORElSRUNUKQorCQkJbWVt
YmxvY2tfcmVzZXJ2ZSgoKHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT5hZGRy
LAorCQkJCQkgKChzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilkYXRhLT5kYXRhKS0+bGVuKTsKKwog
CQlwYV9kYXRhID0gZGF0YS0+bmV4dDsKIAkJZWFybHlfbWVtdW5tYXAoZGF0YSwgc2l6ZW9mKCpk
YXRhKSk7CiAJfQpkaWZmIC0tZ2l0IGEvYXJjaC94ODYvbW0vaW9yZW1hcC5jIGIvYXJjaC94ODYv
bW0vaW9yZW1hcC5jCmluZGV4IGEzOWRjZGI1YWUzNC4uMWZmOWMyMDMwYjRmIDEwMDY0NAotLS0g
YS9hcmNoL3g4Ni9tbS9pb3JlbWFwLmMKKysrIGIvYXJjaC94ODYvbW0vaW9yZW1hcC5jCkBAIC02
MjYsNiArNjI2LDE3IEBAIHN0YXRpYyBib29sIG1lbXJlbWFwX2lzX3NldHVwX2RhdGEocmVzb3Vy
Y2Vfc2l6ZV90IHBoeXNfYWRkciwKIAkJcGFkZHJfbmV4dCA9IGRhdGEtPm5leHQ7CiAJCWxlbiA9
IGRhdGEtPmxlbjsKIAorCQlpZiAoKHBoeXNfYWRkciA+IHBhZGRyKSAmJiAocGh5c19hZGRyIDwg
KHBhZGRyICsgbGVuKSkpIHsKKwkJCW1lbXVubWFwKGRhdGEpOworCQkJcmV0dXJuIHRydWU7CisJ
CX0KKworCQlpZiAoZGF0YS0+dHlwZSA9PSBTRVRVUF9JTkRJUkVDVCAmJgorCQkgICAgKChzdHJ1
Y3Qgc2V0dXBfaW5kaXJlY3QgKilkYXRhLT5kYXRhKS0+dHlwZSAhPSBTRVRVUF9JTkRJUkVDVCkg
eworCQkJcGFkZHIgPSAoKHN0cnVjdCBzZXR1cF9pbmRpcmVjdCAqKWRhdGEtPmRhdGEpLT5hZGRy
OworCQkJbGVuID0gKChzdHJ1Y3Qgc2V0dXBfaW5kaXJlY3QgKilkYXRhLT5kYXRhKS0+bGVuOwor
CQl9CisKIAkJbWVtdW5tYXAoZGF0YSk7CiAKIAkJaWYgKChwaHlzX2FkZHIgPiBwYWRkcikgJiYg
KHBoeXNfYWRkciA8IChwYWRkciArIGxlbikpKQotLSAKMi4xMS4wCgoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApY
ZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

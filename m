Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6638936F67
	for <lists+xen-devel@lfdr.de>; Thu,  6 Jun 2019 11:05:24 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hYoIP-0006t5-2a; Thu, 06 Jun 2019 09:02:53 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=/1VA=UF=citrix.com=roger.pau@srs-us1.protection.inumbo.net>)
 id 1hYoIN-0006rx-EJ
 for xen-devel@lists.xenproject.org; Thu, 06 Jun 2019 09:02:51 +0000
X-Inumbo-ID: db014f72-8839-11e9-b0fd-8f50800e82be
Received: from esa4.hc3370-68.iphmx.com (unknown [216.71.155.144])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id db014f72-8839-11e9-b0fd-8f50800e82be;
 Thu, 06 Jun 2019 09:02:48 +0000 (UTC)
Authentication-Results: esa4.hc3370-68.iphmx.com;
 dkim=none (message not signed) header.i=none;
 spf=None smtp.pra=roger.pau@citrix.com;
 spf=SoftFail smtp.mailfrom=roger.pau@citrix.com;
 spf=None smtp.helo=postmaster@mail.citrix.com
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 roger.pau@citrix.com) identity=pra; client-ip=162.221.158.21;
 receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com"; x-conformance=sidf_compatible
Received-SPF: SoftFail (esa4.hc3370-68.iphmx.com: domain of
 roger.pau@citrix.com is inclined to not designate
 162.221.158.21 as permitted sender) identity=mailfrom;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="roger.pau@citrix.com";
 x-conformance=sidf_compatible; x-record-type="v=spf1";
 x-record-text="v=spf1 include:spf.citrix.com
 include:spf2.citrix.com include:ironport.citrix.com
 exists:%{i}._spf.mta.salesforce.com ~all"
Received-SPF: None (esa4.hc3370-68.iphmx.com: no sender
 authenticity information available from domain of
 postmaster@mail.citrix.com) identity=helo;
 client-ip=162.221.158.21; receiver=esa4.hc3370-68.iphmx.com;
 envelope-from="roger.pau@citrix.com";
 x-sender="postmaster@mail.citrix.com";
 x-conformance=sidf_compatible
IronPort-SDR: 9Cd8gVVQ4KRrS0wdOWd4i0fEDuNrU+70V1RMCO03TIPDLw3c9XY8VIREabEDVgzMe2kSRQ/oXG
 57jP/Kojt4hpTz2WTwUGYWKza0CKS+eFaqs26v/uEPYR12Au327RtbcIDwPWrqNufwWOJ8YJWr
 gEkakF+1YOR0DKOB6fVLqYm9cs5+BcJOH3om6BEdW+LNYaLoSOPwRXWZPA62hZAbQ15Cjfqf53
 AP9nAzR3nLg4KFdkk4ckwvTfFfhzhufveYFk9nSsP08fsCfZWpFyRhQDDLlVYVZrgwl63yU7uV
 v7w=
X-SBRS: -0.9
X-MesageID: 1386121
X-Ironport-Server: esa4.hc3370-68.iphmx.com
X-Remote-IP: 162.221.158.21
X-Policy: $RELAYED
X-IronPort-AV: E=Sophos;i="5.63,558,1557201600"; 
   d="scan'208";a="1386121"
From: Roger Pau Monne <roger.pau@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 6 Jun 2019 11:01:44 +0200
Message-ID: <20190606090146.77381-11-roger.pau@citrix.com>
X-Mailer: git-send-email 2.20.1 (Apple Git-117)
In-Reply-To: <20190606090146.77381-1-roger.pau@citrix.com>
References: <20190606090146.77381-1-roger.pau@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v2 10/12] pci: switch pci_conf_write16 to use
 pci_sbdf_t
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>, Konrad
 Rzeszutek Wilk <konrad.wilk@oracle.com>, George
 Dunlap <George.Dunlap@eu.citrix.com>, Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Tim Deegan <tim@xen.org>,
 Julien Grall <julien.grall@arm.com>, Jan Beulich <jbeulich@suse.com>,
 Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyByZWR1Y2VzIHRoZSBudW1iZXIgb2YgcGFyYW1ldGVycyBvZiB0aGUgZnVuY3Rpb24gdG8g
dHdvLCBhbmQKc2ltcGxpZmllcyBzb21lIG9mIHRoZSBjYWxsaW5nIHNpdGVzLgoKU2lnbmVkLW9m
Zi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+Ci0tLQpDYzogSmFu
IEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpDYzogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNv
b3BlcjNAY2l0cml4LmNvbT4KQ2M6IFdlaSBMaXUgPHdsQHhlbi5vcmc+CkNjOiBHZW9yZ2UgRHVu
bGFwIDxHZW9yZ2UuRHVubGFwQGV1LmNpdHJpeC5jb20+CkNjOiBJYW4gSmFja3NvbiA8aWFuLmph
Y2tzb25AZXUuY2l0cml4LmNvbT4KQ2M6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdyYWxsQGFybS5j
b20+CkNjOiBLb25yYWQgUnplc3p1dGVrIFdpbGsgPGtvbnJhZC53aWxrQG9yYWNsZS5jb20+CkNj
OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHNzdGFiZWxsaW5pQGtlcm5lbC5vcmc+CkNjOiBUaW0gRGVl
Z2FuIDx0aW1AeGVuLm9yZz4KLS0tCiB4ZW4vYXJjaC94ODYvY3B1L2FtZC5jICAgICAgICAgICAg
fCAgNCArLS0KIHhlbi9hcmNoL3g4Ni9tc2kuYyAgICAgICAgICAgICAgICB8IDUzICsrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni94ODZfNjQvcGNpLmMgICAgICAg
ICB8IDIxICsrKysrLS0tLS0tLQogeGVuL2RyaXZlcnMvY2hhci9laGNpLWRiZ3AuYyAgICAgIHwg
IDYgKystLQogeGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMgICAgICAgIHwgIDkgKysrKy0tCiB4
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9wY2kuYyAgICAgfCAxOCArKysrLS0tLS0tLQogeGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gveDg2L2F0cy5jIHwgIDYgKystLQogeGVuL2RyaXZlcnMvcGNpL3Bj
aS5jICAgICAgICAgICAgIHwgIDYgKy0tLQogeGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIuYyAgICAg
ICAgIHwgMjIgKysrKy0tLS0tLS0tLQogeGVuL2RyaXZlcnMvdnBjaS9tc2kuYyAgICAgICAgICAg
IHwgIDQgKy0tCiB4ZW4vZHJpdmVycy92cGNpL21zaXguYyAgICAgICAgICAgfCAgMiArLQogeGVu
L2RyaXZlcnMvdnBjaS92cGNpLmMgICAgICAgICAgIHwgIDggKystLS0KIHhlbi9pbmNsdWRlL3hl
bi9wY2kuaCAgICAgICAgICAgICB8ICA0ICstLQogMTMgZmlsZXMgY2hhbmdlZCwgNjQgaW5zZXJ0
aW9ucygrKSwgOTkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2NwdS9h
bWQuYyBiL3hlbi9hcmNoL3g4Ni9jcHUvYW1kLmMKaW5kZXggZTA1MzBlNzI2NS4uYWEyMmE2OGZh
MiAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L2NwdS9hbWQuYworKysgYi94ZW4vYXJjaC94ODYv
Y3B1L2FtZC5jCkBAIC03MDcsMTEgKzcwNywxMSBAQCBzdGF0aWMgdm9pZCBpbml0X2FtZChzdHJ1
Y3QgY3B1aW5mb194ODYgKmMpCiAJCQkJICAgICAgIChoICYgMHgxKSA/ICJjbGVhcmluZyBEMThG
M3g1Q1swXSIgOiAiIik7CiAKIAkJCWlmIChsICYgMHgxZikKLQkJCQlwY2lfY29uZl93cml0ZTMy
KDAsIDAsIDB4MTgsIDB4MywgMHg1OCwKKwkJCQlwY2lfY29uZl93cml0ZTMyKDAsIDAsIDB4MTgs
IDMsIDB4NTgsCiAJCQkJCQkgbCAmIH4weDFmKTsKIAogCQkJaWYgKGggJiAweDEpCi0JCQkJcGNp
X2NvbmZfd3JpdGUzMigwLCAwLCAweDE4LCAweDMsIDB4NWMsCisJCQkJcGNpX2NvbmZfd3JpdGUz
MigwLCAwLCAweDE4LCAzLCAweDVjLAogCQkJCQkJIGggJiB+MHgxKTsKIAkJfQogCmRpZmYgLS1n
aXQgYS94ZW4vYXJjaC94ODYvbXNpLmMgYi94ZW4vYXJjaC94ODYvbXNpLmMKaW5kZXggMzkyY2Jl
Y2ZlNC4uY2JjMWUzYjNmMCAxMDA2NDQKLS0tIGEveGVuL2FyY2gveDg2L21zaS5jCisrKyBiL3hl
bi9hcmNoL3g4Ni9tc2kuYwpAQCAtMjY3LDEyICsyNjcsMTAgQEAgc3RhdGljIGludCB3cml0ZV9t
c2lfbXNnKHN0cnVjdCBtc2lfZGVzYyAqZW50cnksIHN0cnVjdCBtc2lfbXNnICptc2cpCiAgICAg
ICAgIHsKICAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMzIoc2VnLCBidXMsIHNsb3QsIGZ1bmMs
IG1zaV91cHBlcl9hZGRyZXNzX3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBtc2ctPmFkZHJlc3NfaGkpOwotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1
cywgc2xvdCwgZnVuYywgbXNpX2RhdGFfcmVnKHBvcywgMSksCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1zZy0+ZGF0YSk7CisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+
c2JkZiwgbXNpX2RhdGFfcmVnKHBvcywgMSksIG1zZy0+ZGF0YSk7CiAgICAgICAgIH0KICAgICAg
ICAgZWxzZQotICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgc2xvdCwgZnVu
YywgbXNpX2RhdGFfcmVnKHBvcywgMCksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1z
Zy0+ZGF0YSk7CisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+c2JkZiwgbXNpX2Rh
dGFfcmVnKHBvcywgMCksIG1zZy0+ZGF0YSk7CiAgICAgICAgIGJyZWFrOwogICAgIH0KICAgICBj
YXNlIFBDSV9DQVBfSURfTVNJWDoKQEAgLTMyOSw3ICszMjcsOCBAQCB2b2lkIF9fbXNpX3NldF9l
bmFibGUodTE2IHNlZywgdTggYnVzLCB1OCBzbG90LCB1OCBmdW5jLCBpbnQgcG9zLCBpbnQgZW5h
YmxlKQogICAgIGNvbnRyb2wgJj0gflBDSV9NU0lfRkxBR1NfRU5BQkxFOwogICAgIGlmICggZW5h
YmxlICkKICAgICAgICAgY29udHJvbCB8PSBQQ0lfTVNJX0ZMQUdTX0VOQUJMRTsKLSAgICBwY2lf
Y29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBwb3MgKyBQQ0lfTVNJX0ZMQUdTLCBj
b250cm9sKTsKKyAgICBwY2lfY29uZl93cml0ZTE2KFBDSV9TQkRGKHNlZywgYnVzLCBzbG90LCBm
dW5jKSwKKyAgICAgICAgICAgICAgICAgICAgIHBvcyArIFBDSV9NU0lfRkxBR1MsIGNvbnRyb2wp
OwogfQogCiBzdGF0aWMgdm9pZCBtc2lfc2V0X2VuYWJsZShzdHJ1Y3QgcGNpX2RldiAqZGV2LCBp
bnQgZW5hYmxlKQpAQCAtMzYwLDcgKzM1OSw3IEBAIHN0YXRpYyB2b2lkIG1zaXhfc2V0X2VuYWJs
ZShzdHJ1Y3QgcGNpX2RldiAqZGV2LCBpbnQgZW5hYmxlKQogICAgICAgICBjb250cm9sICY9IH5Q
Q0lfTVNJWF9GTEFHU19FTkFCTEU7CiAgICAgICAgIGlmICggZW5hYmxlICkKICAgICAgICAgICAg
IGNvbnRyb2wgfD0gUENJX01TSVhfRkxBR1NfRU5BQkxFOwotICAgICAgICBwY2lfY29uZl93cml0
ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksIGNvbnRyb2wp
OworICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhw
b3MpLCBjb250cm9sKTsKICAgICB9CiB9CiAKQEAgLTQwNiw3ICs0MDUsNyBAQCBzdGF0aWMgYm9v
bCBtc2lfc2V0X21hc2tfYml0KHN0cnVjdCBpcnFfZGVzYyAqZGVzYywgYm9vbCBob3N0LCBib29s
IGd1ZXN0KQogICAgICAgICBpZiAoIHVubGlrZWx5KCEoY29udHJvbCAmIFBDSV9NU0lYX0ZMQUdT
X0VOQUJMRSkpICkKICAgICAgICAgewogICAgICAgICAgICAgcGRldi0+bXNpeC0+aG9zdF9tYXNr
YWxsID0gMTsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIHNsb3QsIGZ1
bmMsCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1zaXhfY29udHJvbF9yZWcoZW50cnktPm1zaV9hdHRyaWIucG9z
KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbCB8IChQQ0lfTVNJWF9GTEFH
U19FTkFCTEUgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9N
U0lYX0ZMQUdTX01BU0tBTEwpKTsKQEAgLTQ0MCw3ICs0MzksNyBAQCBzdGF0aWMgYm9vbCBtc2lf
c2V0X21hc2tfYml0KHN0cnVjdCBpcnFfZGVzYyAqZGVzYywgYm9vbCBob3N0LCBib29sIGd1ZXN0
KQogICAgICAgICBwZGV2LT5tc2l4LT5ob3N0X21hc2thbGwgPSBtYXNrYWxsOwogICAgICAgICBp
ZiAoIG1hc2thbGwgfHwgcGRldi0+bXNpeC0+Z3Vlc3RfbWFza2FsbCApCiAgICAgICAgICAgICBj
b250cm9sIHw9IFBDSV9NU0lYX0ZMQUdTX01BU0tBTEw7Ci0gICAgICAgIHBjaV9jb25mX3dyaXRl
MTYoc2VnLCBidXMsIHNsb3QsIGZ1bmMsCisgICAgICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+
c2JkZiwKICAgICAgICAgICAgICAgICAgICAgICAgICBtc2l4X2NvbnRyb2xfcmVnKGVudHJ5LT5t
c2lfYXR0cmliLnBvcyksIGNvbnRyb2wpOwogICAgICAgICByZXR1cm4gZmxhZzsKICAgICBkZWZh
dWx0OgpAQCAtNTgwLDggKzU3OSw3IEBAIGludCBzZXR1cF9tc2lfaXJxKHN0cnVjdCBpcnFfZGVz
YyAqZGVzYywgc3RydWN0IG1zaV9kZXNjICptc2lkZXNjKQogICAgIHsKICAgICAgICAgY29udHJv
bCA9IHBjaV9jb25mX3JlYWQxNihwZGV2LT5zYmRmLCBjcG9zKTsKICAgICAgICAgaWYgKCAhKGNv
bnRyb2wgJiBQQ0lfTVNJWF9GTEFHU19FTkFCTEUpICkKLSAgICAgICAgICAgIHBjaV9jb25mX3dy
aXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIFBDSV9TTE9UKHBkZXYtPmRldmZuKSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgUENJX0ZVTkMocGRldi0+ZGV2Zm4pLCBjcG9zLAorICAg
ICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBjcG9zLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb250cm9sIHwgKFBDSV9NU0lYX0ZMQUdTX0VOQUJMRSB8CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUENJX01TSVhfRkxBR1NfTUFTS0FM
TCkpOwogICAgIH0KQEAgLTU5MSw4ICs1ODksNyBAQCBpbnQgc2V0dXBfbXNpX2lycShzdHJ1Y3Qg
aXJxX2Rlc2MgKmRlc2MsIHN0cnVjdCBtc2lfZGVzYyAqbXNpZGVzYykKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJnBjaV9tc2lfbm9ubWFza2Fi
bGUpOwogCiAgICAgaWYgKCAhKGNvbnRyb2wgJiBQQ0lfTVNJWF9GTEFHU19FTkFCTEUpICkKLSAg
ICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgUENJX1NMT1QocGRl
di0+ZGV2Zm4pLAotICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYtPmRldmZu
KSwgY3BvcywgY29udHJvbCk7CisgICAgICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwg
Y3BvcywgY29udHJvbCk7CiAKICAgICByZXR1cm4gcmM7CiB9CkBAIC03MzUsNyArNzMyLDcgQEAg
c3RhdGljIGludCBtc2lfY2FwYWJpbGl0eV9pbml0KHN0cnVjdCBwY2lfZGV2ICpkZXYsCiAgICAg
ICAgIHBjaV9pbnR4KGRldiwgZmFsc2UpOwogICAgICAgICBjb250cm9sIHw9IFBDSV9NU0lfRkxB
R1NfRU5BQkxFOwogICAgIH0KLSAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBm
dW5jLCBtc2lfY29udHJvbF9yZWcocG9zKSwgY29udHJvbCk7CisgICAgcGNpX2NvbmZfd3JpdGUx
NihkZXYtPnNiZGYsIG1zaV9jb250cm9sX3JlZyhwb3MpLCBjb250cm9sKTsKIAogICAgIHJldHVy
biAwOwogfQpAQCAtODU2LDEzICs4NTMsMTMgQEAgc3RhdGljIGludCBtc2l4X2NhcGFiaWxpdHlf
aW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LAogICAgICAqIGZ1bGx5IHNldCB1cC4KICAgICAgKi8K
ICAgICBtc2l4LT5ob3N0X21hc2thbGwgPSAxOwotICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBi
dXMsIHNsb3QsIGZ1bmMsIG1zaXhfY29udHJvbF9yZWcocG9zKSwKKyAgICBwY2lfY29uZl93cml0
ZTE2KGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAg
ICAgY29udHJvbCB8IChQQ0lfTVNJWF9GTEFHU19FTkFCTEUgfAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBQQ0lfTVNJWF9GTEFHU19NQVNLQUxMKSk7CiAKICAgICBpZiAoIHVubGlr
ZWx5KCFtZW1vcnlfZGVjb2RlZChkZXYpKSApCiAgICAgewotICAgICAgICBwY2lfY29uZl93cml0
ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYoZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29udHJvbCAmIH5QQ0lfTVNJWF9GTEFHU19FTkFCTEUpOwog
ICAgICAgICByZXR1cm4gLUVOWElPOwogICAgIH0KQEAgLTg3Miw3ICs4NjksNyBAQCBzdGF0aWMg
aW50IG1zaXhfY2FwYWJpbGl0eV9pbml0KHN0cnVjdCBwY2lfZGV2ICpkZXYsCiAgICAgICAgIGVu
dHJ5ID0gYWxsb2NfbXNpX2VudHJ5KDEpOwogICAgICAgICBpZiAoICFlbnRyeSApCiAgICAgICAg
IHsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIHNsb3QsIGZ1bmMsIG1z
aXhfY29udHJvbF9yZWcocG9zKSwKKyAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoZGV2LT5z
YmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnRyb2wgJiB+UENJX01TSVhfRkxBR1NfRU5BQkxFKTsKICAgICAgICAgICAgIHJldHVybiAt
RU5PTUVNOwogICAgICAgICB9CkBAIC05MDUsNyArOTAyLDcgQEAgc3RhdGljIGludCBtc2l4X2Nh
cGFiaWxpdHlfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LAogICAgIHsKICAgICAgICAgaWYgKCAh
bXNpIHx8ICFtc2ktPnRhYmxlX2Jhc2UgKQogICAgICAgICB7Ci0gICAgICAgICAgICBwY2lfY29u
Zl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisg
ICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhw
b3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sICYgflBDSV9NU0lYX0ZM
QUdTX0VOQUJMRSk7CiAgICAgICAgICAgICB4ZnJlZShlbnRyeSk7CiAgICAgICAgICAgICByZXR1
cm4gLUVOWElPOwpAQCAtOTQ4LDcgKzk0NSw3IEBAIHN0YXRpYyBpbnQgbXNpeF9jYXBhYmlsaXR5
X2luaXQoc3RydWN0IHBjaV9kZXYgKmRldiwKIAogICAgICAgICBpZiAoIGlkeCA8IDAgKQogICAg
ICAgICB7Ci0gICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5j
LCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRl
di0+c2JkZiwgbXNpeF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb250cm9sICYgflBDSV9NU0lYX0ZMQUdTX0VOQUJMRSk7CiAgICAgICAgICAgICB4ZnJl
ZShlbnRyeSk7CiAgICAgICAgICAgICByZXR1cm4gaWR4OwpAQCAtMTAyNCw3ICsxMDIxLDcgQEAg
c3RhdGljIGludCBtc2l4X2NhcGFiaWxpdHlfaW5pdChzdHJ1Y3QgcGNpX2RldiAqZGV2LAogICAg
ICAgICBtYXNrYWxsID0gMDsKICAgICB9CiAgICAgbXNpeC0+aG9zdF9tYXNrYWxsID0gbWFza2Fs
bDsKLSAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBmdW5jLCBtc2l4X2NvbnRy
b2xfcmVnKHBvcyksIGNvbnRyb2wpOworICAgIHBjaV9jb25mX3dyaXRlMTYoZGV2LT5zYmRmLCBt
c2l4X2NvbnRyb2xfcmVnKHBvcyksIGNvbnRyb2wpOwogCiAgICAgcmV0dXJuIDA7CiB9CkBAIC0x
MTY2LDcgKzExNjMsNyBAQCBzdGF0aWMgdm9pZCBfX3BjaV9kaXNhYmxlX21zaXgoc3RydWN0IG1z
aV9kZXNjICplbnRyeSkKICAgICBpZiAoIHVubGlrZWx5KCEoY29udHJvbCAmIFBDSV9NU0lYX0ZM
QUdTX0VOQUJMRSkpICkKICAgICB7CiAgICAgICAgIGRldi0+bXNpeC0+aG9zdF9tYXNrYWxsID0g
MTsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgc2xvdCwgZnVuYywgbXNpeF9j
b250cm9sX3JlZyhwb3MpLAorICAgICAgICBwY2lfY29uZl93cml0ZTE2KGRldi0+c2JkZiwgbXNp
eF9jb250cm9sX3JlZyhwb3MpLAogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgfCAo
UENJX01TSVhfRkxBR1NfRU5BQkxFIHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFBDSV9NU0lYX0ZMQUdTX01BU0tBTEwpKTsKICAgICB9CkBAIC0xMTg1LDcgKzExODIsNyBA
QCBzdGF0aWMgdm9pZCBfX3BjaV9kaXNhYmxlX21zaXgoc3RydWN0IG1zaV9kZXNjICplbnRyeSkK
ICAgICBkZXYtPm1zaXgtPmhvc3RfbWFza2FsbCA9IG1hc2thbGw7CiAgICAgaWYgKCBtYXNrYWxs
IHx8IGRldi0+bXNpeC0+Z3Vlc3RfbWFza2FsbCApCiAgICAgICAgIGNvbnRyb2wgfD0gUENJX01T
SVhfRkxBR1NfTUFTS0FMTDsKLSAgICBwY2lfY29uZl93cml0ZTE2KHNlZywgYnVzLCBzbG90LCBm
dW5jLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksIGNvbnRyb2wpOworICAgIHBjaV9jb25mX3dyaXRl
MTYoZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksIGNvbnRyb2wpOwogCiAgICAgX3Bj
aV9jbGVhbnVwX21zaXgoZGV2LT5tc2l4KTsKIH0KQEAgLTEzODAsOCArMTM3Nyw3IEBAIGludCBw
Y2lfcmVzdG9yZV9tc2lfc3RhdGUoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgICAgICAg
ICAgICAgIHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLCBpKTsKICAgICAgICAgICAg
IHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRlc2MtPmxvY2ssIGZsYWdzKTsKICAgICAgICAgICAg
IGlmICggdHlwZSA9PSBQQ0lfQ0FQX0lEX01TSVggKQotICAgICAgICAgICAgICAgIHBjaV9jb25m
X3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisgICAgICAgICAgICAg
ICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sICYgflBDSV9NU0lYX0ZMQUdT
X0VOQUJMRSk7CiAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKICAgICAgICAgfQpAQCAtMTM5
NiwxNSArMTM5MiwxMyBAQCBpbnQgcGNpX3Jlc3RvcmVfbXNpX3N0YXRlKHN0cnVjdCBwY2lfZGV2
ICpwZGV2KQogICAgICAgICBlbHNlIGlmICggIXR5cGUgJiYgZW50cnktPm1zaV9hdHRyaWIudHlw
ZSA9PSBQQ0lfQ0FQX0lEX01TSVggKQogICAgICAgICB7CiAgICAgICAgICAgICBjb250cm9sID0g
cGNpX2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIG1zaXhfY29udHJvbF9yZWcocG9zKSk7Ci0gICAg
ICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5j
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisg
ICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIG1zaXhfY29udHJvbF9yZWco
cG9zKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbCB8IChQQ0lfTVNJWF9G
TEFHU19FTkFCTEUgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBD
SV9NU0lYX0ZMQUdTX01BU0tBTEwpKTsKICAgICAgICAgICAgIGlmICggdW5saWtlbHkoIW1lbW9y
eV9kZWNvZGVkKHBkZXYpKSApCiAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgc3Bpbl91
bmxvY2tfaXJxcmVzdG9yZSgmZGVzYy0+bG9jaywgZmxhZ3MpOwotICAgICAgICAgICAgICAgIHBj
aV9jb25mX3dyaXRlMTYocGRldi0+c2VnLCBwZGV2LT5idXMsIHNsb3QsIGZ1bmMsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCisgICAgICAg
ICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBv
cyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sICYgflBDSV9NU0lY
X0ZMQUdTX0VOQUJMRSk7CiAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTlhJTzsKICAgICAgICAg
ICAgIH0KQEAgLTE0MzksMTUgKzE0MzMsMTQgQEAgaW50IHBjaV9yZXN0b3JlX21zaV9zdGF0ZShz
dHJ1Y3QgcGNpX2RldiAqcGRldikKIAogICAgICAgICAgICAgY29udHJvbCA9IHBjaV9jb25mX3Jl
YWQxNihwZGV2LT5zYmRmLCBjcG9zKSAmIH5QQ0lfTVNJX0ZMQUdTX1FTSVpFOwogICAgICAgICAg
ICAgbXVsdGlfbXNpX2VuYWJsZShjb250cm9sLCBlbnRyeS0+bXNpLm52ZWMpOwotICAgICAgICAg
ICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgY3Bv
cywgY29udHJvbCk7CisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIGNw
b3MsIGNvbnRyb2wpOwogCiAgICAgICAgICAgICBtc2lfc2V0X2VuYWJsZShwZGV2LCAxKTsKICAg
ICAgICAgfQogICAgIH0KIAogICAgIGlmICggdHlwZSA9PSBQQ0lfQ0FQX0lEX01TSVggKQotICAg
ICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLAot
ICAgICAgICAgICAgICAgICAgICAgICAgIG1zaXhfY29udHJvbF9yZWcocG9zKSwKKyAgICAgICAg
cGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBtc2l4X2NvbnRyb2xfcmVnKHBvcyksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29udHJvbCB8IFBDSV9NU0lYX0ZMQUdTX0VOQUJMRSk7CiAK
ICAgICByZXR1cm4gMDsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGNpLmMgYi94
ZW4vYXJjaC94ODYveDg2XzY0L3BjaS5jCmluZGV4IGVhYTY3YjA0ZjIuLmYwMTRmZTBmYzUgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni94ODZfNjQvcGNpLmMKKysrIGIveGVuL2FyY2gveDg2L3g4
Nl82NC9wY2kuYwpAQCAtNTgsMjMgKzU4LDE4IEBAIHZvaWQgcGNpX2NvbmZfd3JpdGU4KHBjaV9z
YmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdWludDhfdCBkYXRhKQogICAgICAgICBwY2lf
Y29uZl93cml0ZShQQ0lfQ09ORl9BRERSRVNTKHNiZGYsIHJlZyksIHJlZyAmIDMsIDEsIGRhdGEp
OwogfQogCi0jdW5kZWYgUENJX0NPTkZfQUREUkVTUwotI2RlZmluZSBQQ0lfQ09ORl9BRERSRVNT
KGJ1cywgZGV2LCBmdW5jLCByZWcpIFwKLSAgICAoMHg4MDAwMDAwMCB8IChidXMgPDwgMTYpIHwg
KGRldiA8PCAxMSkgfCAoZnVuYyA8PCA4KSB8IChyZWcgJiB+MykpCi0KLXZvaWQgcGNpX2NvbmZf
d3JpdGUxNigKLSAgICB1bnNpZ25lZCBpbnQgc2VnLCB1bnNpZ25lZCBpbnQgYnVzLCB1bnNpZ25l
ZCBpbnQgZGV2LCB1bnNpZ25lZCBpbnQgZnVuYywKLSAgICB1bnNpZ25lZCBpbnQgcmVnLCB1aW50
MTZfdCBkYXRhKQordm9pZCBwY2lfY29uZl93cml0ZTE2KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWdu
ZWQgaW50IHJlZywgdWludDE2X3QgZGF0YSkKIHsKLSAgICBpZiAoIHNlZyB8fCByZWcgPiAyNTUg
KQotICAgICAgICBwY2lfbW1jZmdfd3JpdGUoc2VnLCBidXMsIFBDSV9ERVZGTihkZXYsIGZ1bmMp
LCByZWcsIDIsIGRhdGEpOworICAgIGlmICggc2JkZi5zZWcgfHwgcmVnID4gMjU1ICkKKyAgICAg
ICAgcGNpX21tY2ZnX3dyaXRlKHNiZGYuc2VnLCBzYmRmLmJ1cywgc2JkZi5kZXZmbiwgcmVnLCAy
LCBkYXRhKTsKICAgICBlbHNlCi0gICAgewotICAgICAgICBCVUdfT04oKGJ1cyA+IDI1NSkgfHwg
KGRldiA+IDMxKSB8fCAoZnVuYyA+IDcpKTsKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUoUENJX0NP
TkZfQUREUkVTUyhidXMsIGRldiwgZnVuYywgcmVnKSwgcmVnICYgMiwgMiwgZGF0YSk7Ci0gICAg
fQorICAgICAgICBwY2lfY29uZl93cml0ZShQQ0lfQ09ORl9BRERSRVNTKHNiZGYsIHJlZyksIHJl
ZyAmIDIsIDIsIGRhdGEpOwogfQogCisjdW5kZWYgUENJX0NPTkZfQUREUkVTUworI2RlZmluZSBQ
Q0lfQ09ORl9BRERSRVNTKGJ1cywgZGV2LCBmdW5jLCByZWcpIFwKKyAgICAoMHg4MDAwMDAwMCB8
IChidXMgPDwgMTYpIHwgKGRldiA8PCAxMSkgfCAoZnVuYyA8PCA4KSB8IChyZWcgJiB+MykpCisK
IHZvaWQgcGNpX2NvbmZfd3JpdGUzMigKICAgICB1bnNpZ25lZCBpbnQgc2VnLCB1bnNpZ25lZCBp
bnQgYnVzLCB1bnNpZ25lZCBpbnQgZGV2LCB1bnNpZ25lZCBpbnQgZnVuYywKICAgICB1bnNpZ25l
ZCBpbnQgcmVnLCB1aW50MzJfdCBkYXRhKQpkaWZmIC0tZ2l0IGEveGVuL2RyaXZlcnMvY2hhci9l
aGNpLWRiZ3AuYyBiL3hlbi9kcml2ZXJzL2NoYXIvZWhjaS1kYmdwLmMKaW5kZXggMDEwZmMzYzVi
Yy4uYjc4MDMzNDk1MyAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvY2hhci9laGNpLWRiZ3AuYwor
KysgYi94ZW4vZHJpdmVycy9jaGFyL2VoY2ktZGJncC5jCkBAIC0xMzI0LDggKzEzMjQsOCBAQCBz
dGF0aWMgdm9pZCBfX2luaXQgZWhjaV9kYmdwX2luaXRfcHJlaXJxKHN0cnVjdCBzZXJpYWxfcG9y
dCAqcG9ydCkKICAgICBpZiAoICEoZGJncC0+cGNpX2NyICYgUENJX0NPTU1BTkRfTUVNT1JZKSAp
CiAgICAgewogICAgICAgICBkYmdwLT5wY2lfY3IgfD0gUENJX0NPTU1BTkRfTUVNT1JZOwotICAg
ICAgICBwY2lfY29uZl93cml0ZTE2KDAsIGRiZ3AtPmJ1cywgZGJncC0+c2xvdCwgZGJncC0+ZnVu
YywgUENJX0NPTU1BTkQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgZGJncC0+cGNpX2NyKTsK
KyAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihQQ0lfU0JERigwLCBkYmdwLT5idXMsIGRiZ3AtPnNs
b3QsIGRiZ3AtPmZ1bmMpLAorICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9DT01NQU5ELCBk
YmdwLT5wY2lfY3IpOwogICAgICAgICBkYmdwX3ByaW50aygiTU1JTyBmb3IgRUhDSSBlbmFibGVk
XG4iKTsKICAgICB9CiAKQEAgLTE0MzgsNyArMTQzOCw3IEBAIHN0YXRpYyB2b2lkIGVoY2lfZGJn
cF9yZXN1bWUoc3RydWN0IHNlcmlhbF9wb3J0ICpwb3J0KQogCiAgICAgcGNpX2NvbmZfd3JpdGUz
MigwLCBkYmdwLT5idXMsIGRiZ3AtPnNsb3QsIGRiZ3AtPmZ1bmMsIGRiZ3AtPmJhciwKICAgICAg
ICAgICAgICAgICAgICAgIGRiZ3AtPmJhcl92YWwpOwotICAgIHBjaV9jb25mX3dyaXRlMTYoMCwg
ZGJncC0+YnVzLCBkYmdwLT5zbG90LCBkYmdwLT5mdW5jLAorICAgIHBjaV9jb25mX3dyaXRlMTYo
UENJX1NCREYoMCwgZGJncC0+YnVzLCBkYmdwLT5zbG90LCBkYmdwLT5mdW5jKSwKICAgICAgICAg
ICAgICAgICAgICAgIFBDSV9DT01NQU5ELCBkYmdwLT5wY2lfY3IpOwogCiAgICAgZWhjaV9kYmdw
X3NldHVwX3ByZWlycShkYmdwKTsKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL2NoYXIvbnMxNjU1
MC5jIGIveGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMKaW5kZXggZmU3MTQwNmNjMS4uMjBlYWVj
ZWU1OSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvY2hhci9uczE2NTUwLmMKKysrIGIveGVuL2Ry
aXZlcnMvY2hhci9uczE2NTUwLmMKQEAgLTYyNCw3ICs2MjQsOCBAQCBzdGF0aWMgdm9pZCBwY2lf
c2VyaWFsX2Vhcmx5X2luaXQoc3RydWN0IG5zMTY1NTAgKnVhcnQpCiAgICAgICAgIHJldHVybjsK
IAogICAgIGlmICggdWFydC0+cGJfYmRmX2VuYWJsZSApCi0gICAgICAgIHBjaV9jb25mX3dyaXRl
MTYoMCwgdWFydC0+cGJfYmRmWzBdLCB1YXJ0LT5wYl9iZGZbMV0sIHVhcnQtPnBiX2JkZlsyXSwK
KyAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihQQ0lfU0JERigwLCB1YXJ0LT5wYl9iZGZbMF0sIHVh
cnQtPnBiX2JkZlsxXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1YXJ0LT5w
Yl9iZGZbMl0pLAogICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9JT19CQVNFLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICh1YXJ0LT5pb19iYXNlICYgMHhGMDAwKSB8CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgKCh1YXJ0LT5pb19iYXNlICYgMHhGMDAwKSA+PiA4KSk7CkBAIC02MzIs
NyArNjMzLDggQEAgc3RhdGljIHZvaWQgcGNpX3NlcmlhbF9lYXJseV9pbml0KHN0cnVjdCBuczE2
NTUwICp1YXJ0KQogICAgIHBjaV9jb25mX3dyaXRlMzIoMCwgdWFydC0+cHNfYmRmWzBdLCB1YXJ0
LT5wc19iZGZbMV0sIHVhcnQtPnBzX2JkZlsyXSwKICAgICAgICAgICAgICAgICAgICAgIFBDSV9C
QVNFX0FERFJFU1NfMCwKICAgICAgICAgICAgICAgICAgICAgIHVhcnQtPmlvX2Jhc2UgfCBQQ0lf
QkFTRV9BRERSRVNTX1NQQUNFX0lPKTsKLSAgICBwY2lfY29uZl93cml0ZTE2KDAsIHVhcnQtPnBz
X2JkZlswXSwgdWFydC0+cHNfYmRmWzFdLCB1YXJ0LT5wc19iZGZbMl0sCisgICAgcGNpX2NvbmZf
d3JpdGUxNihQQ0lfU0JERigwLCB1YXJ0LT5wc19iZGZbMF0sIHVhcnQtPnBzX2JkZlsxXSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVhcnQtPnBzX2JkZlsyXSksCiAgICAgICAgICAg
ICAgICAgICAgICBQQ0lfQ09NTUFORCwgUENJX0NPTU1BTkRfSU8pOwogI2VuZGlmCiB9CkBAIC04
NjcsNyArODY5LDggQEAgc3RhdGljIHZvaWQgX25zMTY1NTBfcmVzdW1lKHN0cnVjdCBzZXJpYWxf
cG9ydCAqcG9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgIHVhcnQtPnBzX2JkZlsxXSwgdWFy
dC0+cHNfYmRmWzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgUENJX0JBU0VfQUREUkVTU18w
ICsgKHVhcnQtPmJhcl9pZHgrMSkqNCwgdWFydC0+YmFyNjQpOwogCi0gICAgICAgcGNpX2NvbmZf
d3JpdGUxNigwLCB1YXJ0LT5wc19iZGZbMF0sIHVhcnQtPnBzX2JkZlsxXSwgdWFydC0+cHNfYmRm
WzJdLAorICAgICAgIHBjaV9jb25mX3dyaXRlMTYoUENJX1NCREYoMCwgdWFydC0+cHNfYmRmWzBd
LCB1YXJ0LT5wc19iZGZbMV0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1YXJ0
LT5wc19iZGZbMl0pLAogICAgICAgICAgICAgICAgICAgICAgICAgUENJX0NPTU1BTkQsIHVhcnQt
PmNyKTsKICAgICB9CiAjZW5kaWYKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdo
L3BjaS5jIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMKaW5kZXggYWQzYzk5MzVjYS4u
MDdjOTIxZjE3NiAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMKKysr
IGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvcGNpLmMKQEAgLTI0OCwxNSArMjQ4LDEzIEBAIHN0
YXRpYyB2b2lkIGNoZWNrX3BkZXYoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgewog
ICAgICAgICB2YWwgPSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQpOwog
ICAgICAgICBpZiAoIHZhbCAmIGNvbW1hbmRfbWFzayApCi0gICAgICAgICAgICBwY2lfY29uZl93
cml0ZTE2KHNlZywgYnVzLCBkZXYsIGZ1bmMsIFBDSV9DT01NQU5ELAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2YWwgJiB+Y29tbWFuZF9tYXNrKTsKKyAgICAgICAgICAgIHBjaV9jb25m
X3dyaXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIHZhbCAmIH5jb21tYW5kX21hc2spOwog
ICAgICAgICB2YWwgPSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX1NUQVRVUyk7CiAg
ICAgICAgIGlmICggdmFsICYgUENJX1NUQVRVU19DSEVDSyApCiAgICAgICAgIHsKICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfSU5GTyAiJTA0eDolMDJ4OiUwMnguJXUgc3RhdHVzICUwNHggLT4g
JTA0eFxuIiwKICAgICAgICAgICAgICAgICAgICBzZWcsIGJ1cywgZGV2LCBmdW5jLCB2YWwsIHZh
bCAmIH5QQ0lfU1RBVFVTX0NIRUNLKTsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2Vn
LCBidXMsIGRldiwgZnVuYywgUENJX1NUQVRVUywKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdmFsICYgUENJX1NUQVRVU19DSEVDSyk7CisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2
KHBkZXYtPnNiZGYsIFBDSV9TVEFUVVMsIHZhbCAmIFBDSV9TVEFUVVNfQ0hFQ0spOwogICAgICAg
ICB9CiAgICAgfQogCkBAIC0yNjcsNyArMjY1LDcgQEAgc3RhdGljIHZvaWQgY2hlY2tfcGRldihj
b25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB2
YWwgPSBwY2lfY29uZl9yZWFkMTYocGRldi0+c2JkZiwgUENJX0JSSURHRV9DT05UUk9MKTsKICAg
ICAgICAgaWYgKCB2YWwgJiBicmlkZ2VfY3RsX21hc2sgKQotICAgICAgICAgICAgcGNpX2NvbmZf
d3JpdGUxNihzZWcsIGJ1cywgZGV2LCBmdW5jLCBQQ0lfQlJJREdFX0NPTlRST0wsCisgICAgICAg
ICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9CUklER0VfQ09OVFJPTCwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsICYgfmJyaWRnZV9jdGxfbWFzayk7CiAgICAg
ICAgIHZhbCA9IHBjaV9jb25mX3JlYWQxNihwZGV2LT5zYmRmLCBQQ0lfU0VDX1NUQVRVUyk7CiAg
ICAgICAgIGlmICggdmFsICYgUENJX1NUQVRVU19DSEVDSyApCkBAIC0yNzUsNyArMjczLDcgQEAg
c3RhdGljIHZvaWQgY2hlY2tfcGRldihjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAg
ICAgICAgIHByaW50ayhYRU5MT0dfSU5GTwogICAgICAgICAgICAgICAgICAgICIlMDR4OiUwMng6
JTAyeC4ldSBzZWNvbmRhcnkgc3RhdHVzICUwNHggLT4gJTA0eFxuIiwKICAgICAgICAgICAgICAg
ICAgICBzZWcsIGJ1cywgZGV2LCBmdW5jLCB2YWwsIHZhbCAmIH5QQ0lfU1RBVFVTX0NIRUNLKTsK
LSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2VnLCBidXMsIGRldiwgZnVuYywgUENJX1NF
Q19TVEFUVVMsCisgICAgICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9T
RUNfU1RBVFVTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwgJiBQQ0lfU1RBVFVT
X0NIRUNLKTsKICAgICAgICAgfQogICAgICAgICBicmVhazsKQEAgLTU5Niw4ICs1OTQsNiBAQCBz
dGF0aWMgdm9pZCBwY2lfZW5hYmxlX2FjcyhzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICBpbnQg
cG9zOwogICAgIHUxNiBjYXAsIGN0cmwsIHNlZyA9IHBkZXYtPnNlZzsKICAgICB1OCBidXMgPSBw
ZGV2LT5idXM7Ci0gICAgdTggZGV2ID0gUENJX1NMT1QocGRldi0+ZGV2Zm4pOwotICAgIHU4IGZ1
bmMgPSBQQ0lfRlVOQyhwZGV2LT5kZXZmbik7CiAKICAgICBpZiAoICFpb21tdV9lbmFibGVkICkK
ICAgICAgICAgcmV0dXJuOwpAQCAtNjIxLDcgKzYxNyw3IEBAIHN0YXRpYyB2b2lkIHBjaV9lbmFi
bGVfYWNzKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogICAgIC8qIFVwc3RyZWFtIEZvcndhcmRpbmcg
Ki8KICAgICBjdHJsIHw9IChjYXAgJiBQQ0lfQUNTX1VGKTsKIAotICAgIHBjaV9jb25mX3dyaXRl
MTYoc2VnLCBidXMsIGRldiwgZnVuYywgcG9zICsgUENJX0FDU19DVFJMLCBjdHJsKTsKKyAgICBw
Y2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIHBvcyArIFBDSV9BQ1NfQ1RSTCwgY3RybCk7CiB9
CiAKIHN0YXRpYyBpbnQgaW9tbXVfYWRkX2RldmljZShzdHJ1Y3QgcGNpX2RldiAqcGRldik7CkBA
IC0xMDMxLDEwICsxMDI3LDggQEAgdm9pZCBwY2lfY2hlY2tfZGlzYWJsZV9kZXZpY2UodTE2IHNl
ZywgdTggYnVzLCB1OCBkZXZmbikKIAogICAgIC8qIFRlbGwgdGhlIGRldmljZSB0byBzdG9wIERN
QWluZzsgd2UgY2FuJ3QgcmVseSBvbiB0aGUgZ3Vlc3QgdG8KICAgICAgKiBjb250cm9sIGl0IGZv
ciB1cy4gKi8KLSAgICBkZXZmbiA9IHBkZXYtPmRldmZuOwogICAgIGN3b3JkID0gcGNpX2NvbmZf
cmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5EKTsKLSAgICBwY2lfY29uZl93cml0ZTE2KHNl
ZywgYnVzLCBQQ0lfU0xPVChkZXZmbiksIFBDSV9GVU5DKGRldmZuKSwKLSAgICAgICAgICAgICAg
ICAgICAgIFBDSV9DT01NQU5ELCBjd29yZCAmIH5QQ0lfQ09NTUFORF9NQVNURVIpOworICAgIHBj
aV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIGN3b3JkICYgflBDSV9DT01N
QU5EX01BU1RFUik7CiB9CiAKIC8qCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC94ODYvYXRzLmMgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC94ODYvYXRzLmMKaW5kZXggY2Iw
MjJjNTk4YS4uM2VlYTdmODlmYyAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
eDg2L2F0cy5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3g4Ni9hdHMuYwpAQCAtNTAs
OCArNTAsNyBAQCBpbnQgZW5hYmxlX2F0c19kZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBkZXYsIHN0
cnVjdCBsaXN0X2hlYWQgKmF0c19saXN0KQogICAgIGlmICggISh2YWx1ZSAmIEFUU19FTkFCTEUp
ICkKICAgICB7CiAgICAgICAgIHZhbHVlIHw9IEFUU19FTkFCTEU7Ci0gICAgICAgIHBjaV9jb25m
X3dyaXRlMTYoc2VnLCBidXMsIFBDSV9TTE9UKGRldmZuKSwgUENJX0ZVTkMoZGV2Zm4pLAotICAg
ICAgICAgICAgICAgICAgICAgICAgIHBvcyArIEFUU19SRUdfQ1RMLCB2YWx1ZSk7CisgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgcG9zICsgQVRTX1JFR19DVEwsIHZhbHVlKTsK
ICAgICB9CiAKICAgICBpZiAoIHBvcyApCkBAIC04MSw4ICs4MCw3IEBAIHZvaWQgZGlzYWJsZV9h
dHNfZGV2aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2KQogCiAgICAgdmFsdWUgPSBwY2lfY29uZl9y
ZWFkMTYocGRldi0+c2JkZiwgcGRldi0+YXRzLmNhcF9wb3MgKyBBVFNfUkVHX0NUTCk7CiAgICAg
dmFsdWUgJj0gfkFUU19FTkFCTEU7Ci0gICAgcGNpX2NvbmZfd3JpdGUxNihzZWcsIGJ1cywgUENJ
X1NMT1QoZGV2Zm4pLCBQQ0lfRlVOQyhkZXZmbiksCi0gICAgICAgICAgICAgICAgICAgICBwZGV2
LT5hdHMuY2FwX3BvcyArIEFUU19SRUdfQ1RMLCB2YWx1ZSk7CisgICAgcGNpX2NvbmZfd3JpdGUx
NihwZGV2LT5zYmRmLCBwZGV2LT5hdHMuY2FwX3BvcyArIEFUU19SRUdfQ1RMLCB2YWx1ZSk7CiAK
ICAgICBsaXN0X2RlbCgmcGRldi0+YXRzLmxpc3QpOwogCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVy
cy9wY2kvcGNpLmMgYi94ZW4vZHJpdmVycy9wY2kvcGNpLmMKaW5kZXggYjI0NzAyZTBjMy4uNGRl
NWZkZjY3OSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvcGNpL3BjaS5jCisrKyBiL3hlbi9kcml2
ZXJzL3BjaS9wY2kuYwpAQCAtMTE2LDE3ICsxMTYsMTMgQEAgaW50IHBjaV9maW5kX25leHRfZXh0
X2NhcGFiaWxpdHkoaW50IHNlZywgaW50IGJ1cywgaW50IGRldmZuLCBpbnQgc3RhcnQsIGludCBj
YXAKIAogdm9pZCBwY2lfaW50eChjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgYm9vbCBlbmFi
bGUpCiB7Ci0gICAgdWludDE2X3Qgc2VnID0gcGRldi0+c2VnOwotICAgIHVpbnQ4X3QgYnVzID0g
cGRldi0+YnVzOwotICAgIHVpbnQ4X3Qgc2xvdCA9IFBDSV9TTE9UKHBkZXYtPmRldmZuKTsKLSAg
ICB1aW50OF90IGZ1bmMgPSBQQ0lfRlVOQyhwZGV2LT5kZXZmbik7CiAgICAgdWludDE2X3QgY21k
ID0gcGNpX2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5EKTsKIAogICAgIGlmICgg
ZW5hYmxlICkKICAgICAgICAgY21kICY9IH5QQ0lfQ09NTUFORF9JTlRYX0RJU0FCTEU7CiAgICAg
ZWxzZQogICAgICAgICBjbWQgfD0gUENJX0NPTU1BTkRfSU5UWF9ESVNBQkxFOwotICAgIHBjaV9j
b25mX3dyaXRlMTYoc2VnLCBidXMsIHNsb3QsIGZ1bmMsIFBDSV9DT01NQU5ELCBjbWQpOworICAg
IHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIGNtZCk7CiB9CiAKIGNv
bnN0IGNoYXIgKl9faW5pdCBwYXJzZV9wY2koY29uc3QgY2hhciAqcywgdW5zaWduZWQgaW50ICpz
ZWdfcCwKZGlmZiAtLWdpdCBhL3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMgYi94ZW4vZHJpdmVy
cy92cGNpL2hlYWRlci5jCmluZGV4IDg2ZjZmNTBhMjkuLjVkMTA0MDIxNDIgMTAwNjQ0Ci0tLSBh
L3hlbi9kcml2ZXJzL3ZwY2kvaGVhZGVyLmMKKysrIGIveGVuL2RyaXZlcnMvdnBjaS9oZWFkZXIu
YwpAQCAtMTIzLDggKzEyMyw3IEBAIHN0YXRpYyB2b2lkIG1vZGlmeV9kZWNvZGluZyhjb25zdCBz
dHJ1Y3QgcGNpX2RldiAqcGRldiwgdWludDE2X3QgY21kLAogICAgIH0KIAogICAgIGlmICggIXJv
bV9vbmx5ICkKLSAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywg
c2xvdCwgZnVuYywgUENJX0NPTU1BTkQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgY21kKTsK
KyAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBQQ0lfQ09NTUFORCwgY21kKTsK
ICAgICBlbHNlCiAgICAgICAgIEFTU0VSVF9VTlJFQUNIQUJMRSgpOwogfQpAQCAtMzM1LDcgKzMz
NCw2IEBAIHN0YXRpYyBpbnQgbW9kaWZ5X2JhcnMoY29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYs
IHVpbnQxNl90IGNtZCwgYm9vbCByb21fb25seSkKIHN0YXRpYyB2b2lkIGNtZF93cml0ZShjb25z
dCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKICAgICAgICAgICAgICAg
ICAgICAgICB1aW50MzJfdCBjbWQsIHZvaWQgKmRhdGEpCiB7Ci0gICAgdWludDhfdCBzbG90ID0g
UENJX1NMT1QocGRldi0+ZGV2Zm4pLCBmdW5jID0gUENJX0ZVTkMocGRldi0+ZGV2Zm4pOwogICAg
IHVpbnQxNl90IGN1cnJlbnRfY21kID0gcGNpX2NvbmZfcmVhZDE2KHBkZXYtPnNiZGYsIHJlZyk7
CiAKICAgICAvKgpAQCAtMzUxLDcgKzM0OSw3IEBAIHN0YXRpYyB2b2lkIGNtZF93cml0ZShjb25z
dCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKICAgICAgICAgICovCiAg
ICAgICAgIG1vZGlmeV9iYXJzKHBkZXYsIGNtZCwgZmFsc2UpOwogICAgIGVsc2UKLSAgICAgICAg
cGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgcmVnLCBj
bWQpOworICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNiZGYsIHJlZywgY21kKTsKIH0K
IAogc3RhdGljIHZvaWQgYmFyX3dyaXRlKGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1bnNp
Z25lZCBpbnQgcmVnLApAQCAtMzk3LDggKzM5NSw3IEBAIHN0YXRpYyB2b2lkIGJhcl93cml0ZShj
b25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKICAgICAgICAgdmFs
IHw9IGJhci0+cHJlZmV0Y2hhYmxlID8gUENJX0JBU0VfQUREUkVTU19NRU1fUFJFRkVUQ0ggOiAw
OwogICAgIH0KIAotICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2VnLCBwZGV2LT5idXMsIFBD
SV9TTE9UKHBkZXYtPmRldmZuKSwKLSAgICAgICAgICAgICAgICAgICAgIFBDSV9GVU5DKHBkZXYt
PmRldmZuKSwgcmVnLCB2YWwpOworICAgIHBjaV9jb25mX3dyaXRlMzIocGRldi0+c2VnLCBwZGV2
LT5idXMsIHNsb3QsIGZ1bmMsIHJlZywgdmFsKTsKIH0KIAogc3RhdGljIHZvaWQgcm9tX3dyaXRl
KGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2LCB1bnNpZ25lZCBpbnQgcmVnLApAQCAtNDUyLDcg
KzQ0OSw2IEBAIHN0YXRpYyB2b2lkIHJvbV93cml0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRl
diwgdW5zaWduZWQgaW50IHJlZywKIAogc3RhdGljIGludCBpbml0X2JhcnMoc3RydWN0IHBjaV9k
ZXYgKnBkZXYpCiB7Ci0gICAgdWludDhfdCBzbG90ID0gUENJX1NMT1QocGRldi0+ZGV2Zm4pLCBm
dW5jID0gUENJX0ZVTkMocGRldi0+ZGV2Zm4pOwogICAgIHVpbnQxNl90IGNtZDsKICAgICB1aW50
NjRfdCBhZGRyLCBzaXplOwogICAgIHVuc2lnbmVkIGludCBpLCBudW1fYmFycywgcm9tX3JlZzsK
QEAgLTQ4OCw4ICs0ODQsNyBAQCBzdGF0aWMgaW50IGluaXRfYmFycyhzdHJ1Y3QgcGNpX2RldiAq
cGRldikKICAgICAvKiBEaXNhYmxlIG1lbW9yeSBkZWNvZGluZyBiZWZvcmUgc2l6aW5nLiAqLwog
ICAgIGNtZCA9IHBjaV9jb25mX3JlYWQxNihwZGV2LT5zYmRmLCBQQ0lfQ09NTUFORCk7CiAgICAg
aWYgKCBjbWQgJiBQQ0lfQ09NTUFORF9NRU1PUlkgKQotICAgICAgICBwY2lfY29uZl93cml0ZTE2
KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLCBQQ0lfQ09NTUFORCwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICBjbWQgJiB+UENJX0NPTU1BTkRfTUVNT1JZKTsKKyAgICAgICAgcGNp
X2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCBQQ0lfQ09NTUFORCwgY21kICYgflBDSV9DT01NQU5E
X01FTU9SWSk7CiAKICAgICBmb3IgKCBpID0gMDsgaSA8IG51bV9iYXJzOyBpKysgKQogICAgIHsK
QEAgLTUwMyw4ICs0OTgsNyBAQCBzdGF0aWMgaW50IGluaXRfYmFycyhzdHJ1Y3QgcGNpX2RldiAq
cGRldikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNCwgJmJhcnNbaV0pOwog
ICAgICAgICAgICAgaWYgKCByYyApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcGNp
X2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFBDSV9DT01NQU5ELCBjbWQpOworICAgICAgICAgICAg
ICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIGNtZCk7CiAgICAg
ICAgICAgICAgICAgcmV0dXJuIHJjOwogICAgICAgICAgICAgfQogCkBAIC01MjcsOCArNTIxLDcg
QEAgc3RhdGljIGludCBpbml0X2JhcnMoc3RydWN0IHBjaV9kZXYgKnBkZXYpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAoaSA9PSBudW1fYmFycyAtIDEpID8gUENJX0JBUl9MQVNUIDog
MCk7CiAgICAgICAgIGlmICggcmMgPCAwICkKICAgICAgICAgewotICAgICAgICAgICAgcGNpX2Nv
bmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgc2xvdCwgZnVuYywgUENJX0NPTU1BTkQs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZCk7CisgICAgICAgICAgICBwY2lfY29u
Zl93cml0ZTE2KHBkZXYtPnNiZGYsIFBDSV9DT01NQU5ELCBjbWQpOwogICAgICAgICAgICAgcmV0
dXJuIHJjOwogICAgICAgICB9CiAKQEAgLTU0Niw4ICs1MzksNyBAQCBzdGF0aWMgaW50IGluaXRf
YmFycyhzdHJ1Y3QgcGNpX2RldiAqcGRldikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAmYmFyc1tpXSk7CiAgICAgICAgIGlmICggcmMgKQogICAgICAgICB7Ci0gICAgICAgICAgICBw
Y2lfY29uZl93cml0ZTE2KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBmdW5jLCBQQ0lfQ09N
TUFORCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kKTsKKyAgICAgICAgICAgIHBj
aV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgUENJX0NPTU1BTkQsIGNtZCk7CiAgICAgICAgICAg
ICByZXR1cm4gcmM7CiAgICAgICAgIH0KICAgICB9CmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy92
cGNpL21zaS5jIGIveGVuL2RyaXZlcnMvdnBjaS9tc2kuYwppbmRleCAzOTg5YTcyZjc0Li42Mjk3
MmI0NDBhIDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy92cGNpL21zaS5jCisrKyBiL3hlbi9kcml2
ZXJzL3ZwY2kvbXNpLmMKQEAgLTc3LDkgKzc3LDcgQEAgc3RhdGljIHZvaWQgY29udHJvbF93cml0
ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywKICAgICBtc2kt
PnZlY3RvcnMgPSB2ZWN0b3JzOwogICAgIG1zaS0+ZW5hYmxlZCA9IG5ld19lbmFibGVkOwogCi0g
ICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zZWcsIHBkZXYtPmJ1cywgUENJX1NMT1QocGRldi0+
ZGV2Zm4pLAotICAgICAgICAgICAgICAgICAgICAgUENJX0ZVTkMocGRldi0+ZGV2Zm4pLCByZWcs
Ci0gICAgICAgICAgICAgICAgICAgICBjb250cm9sX3JlYWQocGRldiwgcmVnLCBkYXRhKSk7Cisg
ICAgcGNpX2NvbmZfd3JpdGUxNihwZGV2LT5zYmRmLCByZWcsIGNvbnRyb2xfcmVhZChwZGV2LCBy
ZWcsIGRhdGEpKTsKIH0KIAogc3RhdGljIHZvaWQgdXBkYXRlX21zaShjb25zdCBzdHJ1Y3QgcGNp
X2RldiAqcGRldiwgc3RydWN0IHZwY2lfbXNpICptc2kpCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVy
cy92cGNpL21zaXguYyBiL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jCmluZGV4IGM2MGNiYTAxMzcu
LjM4YzFlN2U1ZGQgMTAwNjQ0Ci0tLSBhL3hlbi9kcml2ZXJzL3ZwY2kvbXNpeC5jCisrKyBiL3hl
bi9kcml2ZXJzL3ZwY2kvbXNpeC5jCkBAIC0xNDYsNyArMTQ2LDcgQEAgc3RhdGljIHZvaWQgY29u
dHJvbF93cml0ZShjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRldiwgdW5zaWduZWQgaW50IHJlZywK
IAogICAgIHZhbCA9IGNvbnRyb2xfcmVhZChwZGV2LCByZWcsIGRhdGEpOwogICAgIGlmICggcGNp
X21zaV9jb25mX3dyaXRlX2ludGVyY2VwdChtc2l4LT5wZGV2LCByZWcsIDIsICZ2YWwpID49IDAg
KQotICAgICAgICBwY2lfY29uZl93cml0ZTE2KHBkZXYtPnNlZywgcGRldi0+YnVzLCBzbG90LCBm
dW5jLCByZWcsIHZhbCk7CisgICAgICAgIHBjaV9jb25mX3dyaXRlMTYocGRldi0+c2JkZiwgcmVn
LCB2YWwpOwogfQogCiBzdGF0aWMgc3RydWN0IHZwY2lfbXNpeCAqbXNpeF9maW5kKGNvbnN0IHN0
cnVjdCBkb21haW4gKmQsIHVuc2lnbmVkIGxvbmcgYWRkcikKZGlmZiAtLWdpdCBhL3hlbi9kcml2
ZXJzL3ZwY2kvdnBjaS5jIGIveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMKaW5kZXggYjlhYWExMTE0
Mi4uMGYwNjg4MDkzZiAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvdnBjaS92cGNpLmMKKysrIGIv
eGVuL2RyaXZlcnMvdnBjaS92cGNpLmMKQEAgLTI2NCwxOSArMjY0LDE3IEBAIHN0YXRpYyB2b2lk
IHZwY2lfd3JpdGVfaHcocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnLCB1bnNpZ25l
ZCBpbnQgc2l6ZSwKICAgICAgICAgaWYgKCByZWcgJiAxICkKICAgICAgICAgewogICAgICAgICAg
ICAgcGNpX2NvbmZfd3JpdGU4KHNiZGYsIHJlZywgZGF0YSk7Ci0gICAgICAgICAgICBwY2lfY29u
Zl93cml0ZTE2KHNiZGYuc2VnLCBzYmRmLmJ1cywgc2JkZi5kZXYsIHNiZGYuZnVuYywgcmVnICsg
MSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA+PiA4KTsKKyAgICAgICAgICAg
IHBjaV9jb25mX3dyaXRlMTYoc2JkZiwgcmVnICsgMSwgZGF0YSA+PiA4KTsKICAgICAgICAgfQog
ICAgICAgICBlbHNlCiAgICAgICAgIHsKLSAgICAgICAgICAgIHBjaV9jb25mX3dyaXRlMTYoc2Jk
Zi5zZWcsIHNiZGYuYnVzLCBzYmRmLmRldiwgc2JkZi5mdW5jLCByZWcsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGRhdGEpOworICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzYmRm
LCByZWcsIGRhdGEpOwogICAgICAgICAgICAgcGNpX2NvbmZfd3JpdGU4KHNiZGYsIHJlZyArIDIs
IGRhdGEgPj4gMTYpOwogICAgICAgICB9CiAgICAgICAgIGJyZWFrOwogCiAgICAgY2FzZSAyOgot
ICAgICAgICBwY2lfY29uZl93cml0ZTE2KHNiZGYuc2VnLCBzYmRmLmJ1cywgc2JkZi5kZXYsIHNi
ZGYuZnVuYywgcmVnLCBkYXRhKTsKKyAgICAgICAgcGNpX2NvbmZfd3JpdGUxNihzYmRmLCByZWcs
IGRhdGEpOwogICAgICAgICBicmVhazsKIAogICAgIGNhc2UgMToKZGlmZiAtLWdpdCBhL3hlbi9p
bmNsdWRlL3hlbi9wY2kuaCBiL3hlbi9pbmNsdWRlL3hlbi9wY2kuaAppbmRleCBmZGVhN2IzMDdk
Li44MjA4MTM3YTUxIDEwMDY0NAotLS0gYS94ZW4vaW5jbHVkZS94ZW4vcGNpLmgKKysrIGIveGVu
L2luY2x1ZGUveGVuL3BjaS5oCkBAIC0xNzYsOSArMTc2LDcgQEAgdWludDhfdCBwY2lfY29uZl9y
ZWFkOChwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcpOwogdWludDE2X3QgcGNpX2Nv
bmZfcmVhZDE2KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZyk7CiB1aW50MzJfdCBw
Y2lfY29uZl9yZWFkMzIocGNpX3NiZGZfdCBzYmRmLCB1bnNpZ25lZCBpbnQgcmVnKTsKIHZvaWQg
cGNpX2NvbmZfd3JpdGU4KHBjaV9zYmRmX3Qgc2JkZiwgdW5zaWduZWQgaW50IHJlZywgdWludDhf
dCBkYXRhKTsKLXZvaWQgcGNpX2NvbmZfd3JpdGUxNigKLSAgICB1bnNpZ25lZCBpbnQgc2VnLCB1
bnNpZ25lZCBpbnQgYnVzLCB1bnNpZ25lZCBpbnQgZGV2LCB1bnNpZ25lZCBpbnQgZnVuYywKLSAg
ICB1bnNpZ25lZCBpbnQgcmVnLCB1aW50MTZfdCBkYXRhKTsKK3ZvaWQgcGNpX2NvbmZfd3JpdGUx
NihwY2lfc2JkZl90IHNiZGYsIHVuc2lnbmVkIGludCByZWcsIHVpbnQxNl90IGRhdGEpOwogdm9p
ZCBwY2lfY29uZl93cml0ZTMyKAogICAgIHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVkIGludCBi
dXMsIHVuc2lnbmVkIGludCBkZXYsIHVuc2lnbmVkIGludCBmdW5jLAogICAgIHVuc2lnbmVkIGlu
dCByZWcsIHVpbnQzMl90IGRhdGEpOwotLSAKMi4yMC4xIChBcHBsZSBHaXQtMTE3KQoKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWls
aW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVu
cHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

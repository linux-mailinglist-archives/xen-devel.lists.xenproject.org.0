Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 44090118D0D
	for <lists+xen-devel@lfdr.de>; Tue, 10 Dec 2019 16:52:19 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iehlA-0003go-85; Tue, 10 Dec 2019 15:49:12 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=A1/D=2A=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iehl8-0003fz-Td
 for xen-devel@lists.xenproject.org; Tue, 10 Dec 2019 15:49:10 +0000
X-Inumbo-ID: 775cd34c-1b64-11ea-a1e1-bc764e2007e4
Received: from mail-qk1-x732.google.com (unknown [2607:f8b0:4864:20::732])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 775cd34c-1b64-11ea-a1e1-bc764e2007e4;
 Tue, 10 Dec 2019 15:48:10 +0000 (UTC)
Received: by mail-qk1-x732.google.com with SMTP id d202so16808753qkb.1
 for <xen-devel@lists.xenproject.org>; Tue, 10 Dec 2019 07:48:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=6bFttf93Zv7bJw+HhrXFNoNF5zm0+Ns2KTF1xAY7wfU=;
 b=YSOwNhHOINHafwHrTozijvpCCUTZw4CF4f9Xde08G5lN/lT5x+t50BZoZ/JDp+97bV
 WdR/vz/OLl6sOrXlwjEXG0zZ88d2fyprVXDlLRNcmaW0yVlFu584yISzdme3/k/aKtmD
 JoBbjyCtXD5DzoOL+qdTxaanRUrxT9h6IPZUxRBc0FJCTHVmjAxL6N3CX57OjPOnvbto
 tNkLDMzYb9O8HZ5IIn1kOoxwyZ4/7Synz2jYoIViduXzvLU4BuCqq43vreVvr3BMC7Ci
 WBg0mQn1TH9G5QjxDPmybFrKHJ6hpO91OxaWvHKxULRApKPwPTY0Bf/4ksrYE6ET37Ay
 qNnw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=6bFttf93Zv7bJw+HhrXFNoNF5zm0+Ns2KTF1xAY7wfU=;
 b=nycQ7TggWgq8xhqIFUR5JjPlI2aFJ9s0Dj02pwKtvp0PbXYFsYRxLJJ4Ls5xYtVv2S
 6VGPRLv5B3wq9ttrffcXg3ukPgfaItbMuZ7eXPqNmvlrRm2U6GIQB7eth1GD3QHCmE6W
 O4CAUsUuTzT+hHOYtWTBVpnbujf5yhWSx2zOmiOiBPvE+0PqRsaA4xE1FVlLMDTj7G+N
 Jkfu30Km9cPSX/tJY8mGJljRQ4a6BhHAXyPycqK6hWFZTsFbh6Jt5py0gQ7pxP8FWI6E
 VOKwSBtBFFIb6IyDn5cdaaLwFiVtdlEHC4TFUK3IX0O4stOTb5PpPP6AjpguSM4rthFN
 1LcQ==
X-Gm-Message-State: APjAAAXQt4D8J2N9rPgO0WC8OTFauFgM+LoCfQaq7gVY8X2tVlOWGrhc
 Qb8ivsARdnxq3OPyR0JWQAc/am3P
X-Google-Smtp-Source: APXvYqxgVOQgzkzyL9VxP4Yr1fHy7lSCRl5pj/wBz9R+kACeKCs39hebWZq2Rxh27veMx843VeBFtw==
X-Received: by 2002:a37:e55:: with SMTP id 82mr33915836qko.370.1575992889007; 
 Tue, 10 Dec 2019 07:48:09 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id m29sm1247848qtf.1.2019.12.10.07.48.07
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 10 Dec 2019 07:48:08 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 10 Dec 2019 10:47:31 -0500
Message-Id: <55d5a61e30b20df027a159834f18d777c8e6b0d9.1575990937.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1575990937.git.rosbrookn@ainfosec.com>
References: <cover.1575990937.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 16/22] golang/xenlight: implement keyed union
 C to Go marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClN3aXRjaCBvdmVy
IHVuaW9uIGtleSB0byBkZXRlcm1pbmUgaG93IHRvIHBvcHVsYXRlICd1bmlvbicgaW4gR28gc3Ry
dWN0LgoKU2luY2UgdGhlIHVuaW9ucyBvZiBDIHR5cGVzIGNhbm5vdCBiZSBkaXJlY3RseSBhY2Nl
c3NlZCBpbiBjZ28sIHVzZSBhCnR5cGVvZiB0cmljayB0byB0eXBlZGVmIGEgc3RydWN0IGluIHRo
ZSBjZ28gcHJlYW1ibGUgdGhhdCBpcyBhbmFsYWdvdXMKdG8gZWFjaCBpbm5lciBzdHJ1Y3Qgb2Yg
YSBrZXllZCB1bmlvbi4gRm9yIGV4YW1wbGUsIHRvIGRlZmluZSBhIHN0cnVjdApmb3IgdGhlIGh2
bSBpbm5lciBzdHJ1Y3Qgb2YgbGlieGxfZG9tYWluX2J1aWxkX2luZm8sIGRvOgoKICB0eXBlZGVm
IHR5cGVvZigoKHN0cnVjdCBsaWJ4bF9kb21haW5fYnVpbGRfaW5mbyAqKU5VTEwpLT51Lmh2bSkg
bGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9odm07CgpTaWduZWQtb2ZmLWJ5OiBO
aWNrIFJvc2Jyb29rIDxyb3Nicm9va25AYWluZm9zZWMuY29tPgotLS0KQ2hhbmdlcyBpbiB2MjoK
LSBEbyBub3QgdXNlIGdsb2JhbCB2YXJpYWJsZSBmb3IgZXh0cmEgaGVscGVyIGZ1bmN0aW9uIGRl
ZmluaXRpb25zLgogIEluc3RlYWQsIHJldHVybiBhIHR1cGxlIHdoaWNoIGNvbnRhaW5zIGEgbGlz
dCBvZiBleHRyYSBoZWxwZXIKICBmdW5jdGlvbnMgYXNzb2NpYXRlZCB3aXRoIHRoZSBvcmlnaW5h
bC4KQ2hhbmdlcyBpbiB2MzoKLSBVc2UgdGhlIG5ldyB4ZW5saWdodF9nb2xhbmdfY29udmVydF9m
cm9tX0MgZnVuY3Rpb24gZm9yIGZpZWxkIGNvcHlpbmcvCiAgdHlwZSBjb252ZXJzaW9uLgotIFVz
ZSBhIHR5cGVvZiB0cmljayBpbiB0aGUgY2dvIHByZWFtYmxlIHRvIGRlZmluZSBzdHJ1Y3RzIGZv
ciB0aGUgaW5uZXIKICBzdHJ1Y3Qgb2Yga2V5ZWQgdW5pb25zLCBpbnN0ZWFkIG9mIGV4cGxpY2l0
bHkgZGVmaW5pbmcgdGhlIGZpZWxkcy4KLS0tCiB0b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290
eXBlcy5weSAgfCAxMjkgKysrKysrKysrLQogdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMu
Z2VuLmdvIHwgMzQ2ICsrKysrKysrKysrKysrKysrKysrKysrKysrKwogMiBmaWxlcyBjaGFuZ2Vk
LCA0NjQgaW5zZXJ0aW9ucygrKSwgMTEgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvdG9vbHMv
Z29sYW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkgYi90b29scy9nb2xhbmcveGVubGlnaHQvZ2Vu
Z290eXBlcy5weQppbmRleCAxZmU1NjE3OWUyLi5iNjhjMWFhNjZiIDEwMDY0NAotLS0gYS90b29s
cy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weQorKysgYi90b29scy9nb2xhbmcveGVubGln
aHQvZ2VuZ290eXBlcy5weQpAQCAtMjQsNiArMjQsMTAgQEAgZ29fa2V5d29yZHMgPSBbJ3R5cGUn
LCAnZnVuYyddCiBnb19idWlsdGluX3R5cGVzID0gWydib29sJywgJ3N0cmluZycsICdpbnQnLCAn
Ynl0ZScsCiAgICAgICAgICAgICAgICAgICAgICd1aW50MTYnLCAndWludDMyJywgJ3VpbnQ2NCdd
CiAKKyMgY2dvIHByZWFtYmxlIGZvciB4ZW5saWdodF9oZWxwZXJzLmdvLCBjcmVhdGVkIGR1cmlu
ZyB0eXBlIGdlbmVyYXRpb24gYW5kCisjIHdyaXR0ZW4gbGF0ZXIuCitjZ29faGVscGVyc19wcmVh
bWJsZSA9IFtdCisKIGRlZiB4ZW5saWdodF9nb2xhbmdfZ2VuZXJhdGVfdHlwZXMocGF0aCA9IE5v
bmUsIHR5cGVzID0gTm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAgICIiIgogICAgIEdlbmVyYXRl
IGEgLmdvIGZpbGUgKHR5cGVzLmdlbi5nbyBieSBkZWZhdWx0KQpAQCAtMTI0LDcgKzEyOCw3IEBA
IGRlZiB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX3N0cnVjdCh0eSA9IE5vbmUsIHR5cGVuYW1lID0g
Tm9uZSwgbmVzdGVkID0gRmFsc2UpOgogICAgICAgICAgICAgZXh0cmFzLmV4dGVuZChyWzFdKQog
CiAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5LZXllZFVuaW9uKToKLSAgICAg
ICAgICAgIHIgPSB4ZW5saWdodF9nb2xhbmdfZGVmaW5lX3VuaW9uKGYudHlwZSwgdHkudHlwZW5h
bWUpCisgICAgICAgICAgICByID0geGVubGlnaHRfZ29sYW5nX2RlZmluZV91bmlvbihmLnR5cGUs
IHR5LnR5cGVuYW1lLCBmLm5hbWUpCiAKICAgICAgICAgICAgIHMgKz0gclswXQogICAgICAgICAg
ICAgZXh0cmFzLmV4dGVuZChyWzFdKQpAQCAtMTM3LDcgKzE0MSw3IEBAIGRlZiB4ZW5saWdodF9n
b2xhbmdfZGVmaW5lX3N0cnVjdCh0eSA9IE5vbmUsIHR5cGVuYW1lID0gTm9uZSwgbmVzdGVkID0g
RmFsc2UpOgogCiAgICAgcmV0dXJuIChzLGV4dHJhcykKIAotZGVmIHhlbmxpZ2h0X2dvbGFuZ19k
ZWZpbmVfdW5pb24odHkgPSBOb25lLCBzdHJ1Y3RuYW1lID0gJycpOgorZGVmIHhlbmxpZ2h0X2dv
bGFuZ19kZWZpbmVfdW5pb24odHkgPSBOb25lLCBzdHJ1Y3RfbmFtZSA9ICcnLCB1bmlvbl9uYW1l
ID0gJycpOgogICAgICIiIgogICAgIEdlbmVyYXRlIHRoZSBHbyB0cmFuc2xhdGlvbiBvZiBhIEtl
eWVkVW5pb24uCiAKQEAgLTE0OSw3ICsxNTMsNyBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2RlZmlu
ZV91bmlvbih0eSA9IE5vbmUsIHN0cnVjdG5hbWUgPSAnJyk6CiAgICAgcyA9ICcnCiAgICAgZXh0
cmFzID0gW10KIAotICAgIGludGVyZmFjZV9uYW1lID0gJ3t9X3t9X3VuaW9uJy5mb3JtYXQoc3Ry
dWN0bmFtZSwgdHkua2V5dmFyLm5hbWUpCisgICAgaW50ZXJmYWNlX25hbWUgPSAne31fe31fdW5p
b24nLmZvcm1hdChzdHJ1Y3RfbmFtZSwgdHkua2V5dmFyLm5hbWUpCiAgICAgaW50ZXJmYWNlX25h
bWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUoaW50ZXJmYWNlX25hbWUsIGV4cG9ydGVkPUZh
bHNlKQogCiAgICAgcyArPSAndHlwZSB7fSBpbnRlcmZhY2Uge3tcbicuZm9ybWF0KGludGVyZmFj
ZV9uYW1lKQpAQCAtMTYzLDExICsxNjcsMTggQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVf
dW5pb24odHkgPSBOb25lLCBzdHJ1Y3RuYW1lID0gJycpOgogICAgICAgICAgICAgY29udGludWUK
IAogICAgICAgICAjIERlZmluZSBzdHJ1Y3QKLSAgICAgICAgbmFtZSA9ICd7fV97fV91bmlvbl97
fScuZm9ybWF0KHN0cnVjdG5hbWUsIHR5LmtleXZhci5uYW1lLCBmLm5hbWUpCisgICAgICAgIG5h
bWUgPSAne31fe31fdW5pb25fe30nLmZvcm1hdChzdHJ1Y3RfbmFtZSwgdHkua2V5dmFyLm5hbWUs
IGYubmFtZSkKICAgICAgICAgciA9IHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfc3RydWN0KGYudHlw
ZSwgdHlwZW5hbWU9bmFtZSkKICAgICAgICAgZXh0cmFzLmFwcGVuZChyWzBdKQogICAgICAgICBl
eHRyYXMuZXh0ZW5kKHJbMV0pCiAKKyAgICAgICAgIyBUaGlzIHR5cGVvZiB0cmljayBlbnN1cmVz
IHRoYXQgdGhlIGZpZWxkcyB1c2VkIGluIHRoZSBjZ28gc3RydWN0CisgICAgICAgICMgdXNlZCBm
b3IgbWFyc2hhbGluZyBhcmUgdGhlIHNhbWUgYXMgdGhlIGZpZWxkcyBvZiB0aGUgdW5pb24gaW4g
dGhlCisgICAgICAgICMgYWN0dWFsIEMgdHlwZSwgYW5kIGF2b2lkcyByZS1kZWZpbmluZyBhbGwg
b2YgdGhvc2UgZmllbGRzLgorICAgICAgICBzID0gJ3R5cGVkZWYgdHlwZW9mKCgoc3RydWN0IHt9
ICopTlVMTCktPnt9Lnt9KXt9OycKKyAgICAgICAgcyA9IHMuZm9ybWF0KHN0cnVjdF9uYW1lLCB1
bmlvbl9uYW1lLCBmLm5hbWUsIG5hbWUpCisgICAgICAgIGNnb19oZWxwZXJzX3ByZWFtYmxlLmFw
cGVuZChzKQorCiAgICAgICAgICMgRGVmaW5lIGZ1bmN0aW9uIHRvIGltcGxlbWVudCAndW5pb24n
IGludGVyZmFjZQogICAgICAgICBuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG5hbWUp
CiAgICAgICAgIHMgPSAnZnVuYyAoeCB7fSkgaXN7fSgpe3t9fVxuJy5mb3JtYXQobmFtZSwgaW50
ZXJmYWNlX25hbWUpCkBAIC0xOTUsNiArMjA2LDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19nZW5l
cmF0ZV9oZWxwZXJzKHBhdGggPSBOb25lLCB0eXBlcyA9IE5vbmUsIGNvbW1lbnQgPSBOb25lKToK
ICAgICAgICAgaWYgY29tbWVudCBpcyBub3QgTm9uZToKICAgICAgICAgICAgIGYud3JpdGUoY29t
bWVudCkKICAgICAgICAgZi53cml0ZSgncGFja2FnZSB4ZW5saWdodFxuJykKKyAgICAgICAgZi53
cml0ZSgnaW1wb3J0IChcbiJ1bnNhZmUiXG4iZXJyb3JzIlxuImZtdCJcbilcbicpCiAKICAgICAg
ICAgIyBDZ28gcHJlYW1ibGUKICAgICAgICAgZi53cml0ZSgnLypcbicpCkBAIC0yMDMsMTUgKzIx
NSwyNSBAQCBkZWYgeGVubGlnaHRfZ29sYW5nX2dlbmVyYXRlX2hlbHBlcnMocGF0aCA9IE5vbmUs
IHR5cGVzID0gTm9uZSwgY29tbWVudCA9IE5vbmUpOgogICAgICAgICBmLndyaXRlKCcjaW5jbHVk
ZSA8bGlieGwuaD5cbicpCiAgICAgICAgIGYud3JpdGUoJ1xuJykKIAorICAgICAgICBmb3IgcyBp
biBjZ29faGVscGVyc19wcmVhbWJsZToKKyAgICAgICAgICAgIGYud3JpdGUocykKKyAgICAgICAg
ICAgIGYud3JpdGUoJ1xuJykKKwogICAgICAgICBmLndyaXRlKCcqL1xuaW1wb3J0ICJDIlxuJykK
IAogICAgICAgICBmb3IgdHkgaW4gdHlwZXM6CiAgICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5j
ZSh0eSwgaWRsLlN0cnVjdCk6CiAgICAgICAgICAgICAgICAgY29udGludWUKIAotICAgICAgICAg
ICAgZi53cml0ZSh4ZW5saWdodF9nb2xhbmdfZGVmaW5lX2Zyb21fQyh0eSkpCisgICAgICAgICAg
ICAoZmRlZiwgZXh0cmFzKSA9IHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5KQorCisg
ICAgICAgICAgICBmLndyaXRlKGZkZWYpCiAgICAgICAgICAgICBmLndyaXRlKCdcbicpCiAKKyAg
ICAgICAgICAgIGZvciBleHRyYSBpbiBleHRyYXM6CisgICAgICAgICAgICAgICAgZi53cml0ZShl
eHRyYSkKKyAgICAgICAgICAgICAgICBmLndyaXRlKCdcbicpCisKICAgICBnb19mbXQocGF0aCkK
IAogZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5ID0gTm9uZSk6CkBAIC0yMjUs
NiArMjQ3LDcgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19kZWZpbmVfZnJvbV9DKHR5ID0gTm9uZSk6
CiAgICAgY25hbWUgID0gdHkudHlwZW5hbWUKIAogICAgIGJvZHkgPSAnJworICAgIGV4dHJhcyA9
IFtdCiAKICAgICBmb3IgZiBpbiB0eS5maWVsZHM6CiAgICAgICAgIGlmIGYudHlwZS50eXBlbmFt
ZSBpcyBub3QgTm9uZToKQEAgLTI0MCwxNCArMjYzLDE3IEBAIGRlZiB4ZW5saWdodF9nb2xhbmdf
ZGVmaW5lX2Zyb21fQyh0eSA9IE5vbmUpOgogICAgICAgICAgICAgICAgIGJvZHkgKz0geGVubGln
aHRfZ29sYW5nX2NvbnZlcnRfZnJvbV9DKG5mLG91dGVyX25hbWU9Zi5uYW1lKQogCiAgICAgICAg
IGVsaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlkbC5LZXllZFVuaW9uKToKLSAgICAgICAgICAgIHBh
c3MKKyAgICAgICAgICAgIHIgPSB4ZW5saWdodF9nb2xhbmdfdW5pb25fZnJvbV9DKGYudHlwZSwg
Zi5uYW1lLCB0eS50eXBlbmFtZSkKKworICAgICAgICAgICAgYm9keSArPSByWzBdCisgICAgICAg
ICAgICBleHRyYXMuZXh0ZW5kKHJbMV0pCiAKICAgICAgICAgZWxzZToKICAgICAgICAgICAgIHJh
aXNlIEV4Y2VwdGlvbigndHlwZSB7fSBub3Qgc3VwcG9ydGVkJy5mb3JtYXQoZi50eXBlKSkKIAot
ICAgIHJldHVybiBmdW5jLmZvcm1hdChnb25hbWUsIGNuYW1lLCBib2R5KQorICAgIHJldHVybiAo
ZnVuYy5mb3JtYXQoZ29uYW1lLCBjbmFtZSwgYm9keSksIGV4dHJhcykKIAotZGVmIHhlbmxpZ2h0
X2dvbGFuZ19jb252ZXJ0X2Zyb21fQyh0eSA9IE5vbmUsIG91dGVyX25hbWUgPSBOb25lKToKK2Rl
ZiB4ZW5saWdodF9nb2xhbmdfY29udmVydF9mcm9tX0ModHkgPSBOb25lLCBvdXRlcl9uYW1lID0g
Tm9uZSwgY3Zhcm5hbWUgPSBOb25lKToKICAgICAiIiIKICAgICBSZXR1cm5zIGEgbGluZSBvZiBH
byBjb2RlIHRoYXQgY29udmVydHMgdGhlIEMgdHlwZSByZXByZXNlbnRlZAogICAgIGJ5IHR5IHRv
IGl0cyBjb3JyZXNwb25kaW5nIEdvIHR5cGUuCkBAIC0yNTcsNiArMjgzLDEwIEBAIGRlZiB4ZW5s
aWdodF9nb2xhbmdfY29udmVydF9mcm9tX0ModHkgPSBOb25lLCBvdXRlcl9uYW1lID0gTm9uZSk6
CiAgICAgIiIiCiAgICAgcyA9ICcnCiAKKyAgICAjIFVzZSAneGMnIGFzIHRoZSBuYW1lIGZvciB0
aGUgQyB2YXJpYWJsZSB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZAorICAgIGlmIGN2YXJuYW1l
IGlzIE5vbmU6CisgICAgICAgIGN2YXJuYW1lID0gJ3hjJworCiAgICAgZ290eXBlbmFtZSA9IHhl
bmxpZ2h0X2dvbGFuZ19mbXRfbmFtZSh0eS50eXBlLnR5cGVuYW1lKQogICAgIGdvbmFtZSAgICAg
PSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUodHkubmFtZSkKICAgICBjbmFtZSAgICAgID0gdHku
bmFtZQpAQCAtMjgwLDE4ICszMTAsOTUgQEAgZGVmIHhlbmxpZ2h0X2dvbGFuZ19jb252ZXJ0X2Zy
b21fQyh0eSA9IE5vbmUsIG91dGVyX25hbWUgPSBOb25lKToKICAgICBpZiBub3QgaXNfY2FzdGFi
bGU6CiAgICAgICAgICMgSWYgdGhlIHR5cGUgaXMgbm90IGNhc3RhYmxlLCB3ZSBuZWVkIHRvIGNh
bGwgaXRzIGZyb21DCiAgICAgICAgICMgZnVuY3Rpb24uCi0gICAgICAgIHMgKz0gJ2lmIGVyciA6
PSB4Lnt9LmZyb21DKCZ4Yy57fSk7Jy5mb3JtYXQoZ29uYW1lLGNuYW1lKQorICAgICAgICBzICs9
ICdpZiBlcnIgOj0geC57fS5mcm9tQygme30ue30pOycuZm9ybWF0KGdvbmFtZSxjdmFybmFtZSxj
bmFtZSkKICAgICAgICAgcyArPSAnZXJyICE9IG5pbCB7XG4gcmV0dXJuIGVyciBcbn1cbicKIAog
ICAgIGVsaWYgZ290eXBlbmFtZSA9PSAnc3RyaW5nJzoKICAgICAgICAgIyBVc2UgdGhlIGNnbyBo
ZWxwZXIgZm9yIGNvbnZlcnRpbmcgQyBzdHJpbmdzLgotICAgICAgICBzICs9ICd4Lnt9ID0gQy5H
b1N0cmluZyh4Yy57fSlcbicuZm9ybWF0KGdvbmFtZSwgY25hbWUpCisgICAgICAgIHMgKz0gJ3gu
e30gPSBDLkdvU3RyaW5nKHt9Lnt9KVxuJy5mb3JtYXQoZ29uYW1lLGN2YXJuYW1lLGNuYW1lKQog
CiAgICAgZWxzZToKLSAgICAgICAgcyArPSAneC57fSA9IHt9KHhjLnt9KVxuJy5mb3JtYXQoZ29u
YW1lLCBnb3R5cGVuYW1lLCBjbmFtZSkKKyAgICAgICAgcyArPSAneC57fSA9IHt9KHt9Lnt9KVxu
Jy5mb3JtYXQoZ29uYW1lLGdvdHlwZW5hbWUsY3Zhcm5hbWUsY25hbWUpCiAKICAgICByZXR1cm4g
cwogCitkZWYgeGVubGlnaHRfZ29sYW5nX3VuaW9uX2Zyb21fQyh0eSA9IE5vbmUsIHVuaW9uX25h
bWUgPSAnJywgc3RydWN0X25hbWUgPSAnJyk6CisgICAgZXh0cmFzID0gW10KKworICAgIGtleW5h
bWUgICA9IHR5LmtleXZhci5uYW1lCisgICAgZ29rZXluYW1lID0geGVubGlnaHRfZ29sYW5nX2Zt
dF9uYW1lKGtleW5hbWUpCisgICAga2V5dHlwZSAgID0gdHkua2V5dmFyLnR5cGUudHlwZW5hbWUK
KyAgICBnb2tleXR5cGUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUoa2V5dHlwZSkKKworICAg
IGludGVyZmFjZV9uYW1lID0gJ3t9X3t9X3VuaW9uJy5mb3JtYXQoc3RydWN0X25hbWUsIGtleW5h
bWUpCisgICAgaW50ZXJmYWNlX25hbWUgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUoaW50ZXJm
YWNlX25hbWUsIGV4cG9ydGVkPUZhbHNlKQorCisgICAgY2dvX2tleW5hbWUgPSBrZXluYW1lCisg
ICAgaWYgY2dvX2tleW5hbWUgaW4gZ29fa2V5d29yZHM6CisgICAgICAgIGNnb19rZXluYW1lID0g
J18nICsgY2dvX2tleW5hbWUKKworICAgIGNhc2VzID0ge30KKworICAgIGZvciBmIGluIHR5LmZp
ZWxkczoKKyAgICAgICAgdmFsID0gJ3t9X3t9Jy5mb3JtYXQoa2V5dHlwZSwgZi5uYW1lKQorICAg
ICAgICB2YWwgPSB4ZW5saWdodF9nb2xhbmdfZm10X25hbWUodmFsKQorCisgICAgICAgICMgQWRk
IHRvIGxpc3Qgb2YgY2FzZXMgdG8gbWFrZSBmb3IgdGhlIHN3aXRjaAorICAgICAgICAjIHN0YXRl
bWVudCBiZWxvdy4KKyAgICAgICAgaWYgZi50eXBlIGlzIE5vbmU6CisgICAgICAgICAgICBjb250
aW51ZQorCisgICAgICAgIGNhc2VzW2YubmFtZV0gPSB2YWwKKworICAgICAgICAjIERlZmluZSBm
cm9tQyBmdW5jIGZvciAndW5pb24nIHN0cnVjdC4KKyAgICAgICAgdHlwZW5hbWUgICA9ICd7fV97
fV91bmlvbl97fScuZm9ybWF0KHN0cnVjdF9uYW1lLGtleW5hbWUsZi5uYW1lKQorICAgICAgICBn
b3R5cGVuYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKHR5cGVuYW1lKQorCisgICAgICAg
ICMgRGVmaW5lIHRoZSBmdW5jdGlvbiBoZXJlLiBUaGUgY2FzZXMgZm9yIGtleWVkIHVuaW9ucyBh
cmUgYSBsaXR0bGUKKyAgICAgICAgIyBkaWZmZXJlbnQuCisgICAgICAgIHMgPSAnZnVuYyAoeCAq
e30pIGZyb21DKHhjICpDLnt9KSBlcnJvciB7e1xuJy5mb3JtYXQoZ290eXBlbmFtZSxzdHJ1Y3Rf
bmFtZSkKKyAgICAgICAgcyArPSAnaWYge30oeGMue30pICE9IHt9IHt7XG4nLmZvcm1hdChnb2tl
eXR5cGUsY2dvX2tleW5hbWUsdmFsKQorICAgICAgICBlcnJfc3RyaW5nID0gJyJleHBlY3RlZCB1
bmlvbiBrZXkge30iJy5mb3JtYXQodmFsKQorICAgICAgICBzICs9ICdyZXR1cm4gZXJyb3JzLk5l
dyh7fSlcbicuZm9ybWF0KGVycl9zdHJpbmcpCisgICAgICAgIHMgKz0gJ31cblxuJworICAgICAg
ICBzICs9ICd0bXAgOj0gKCpDLnt9KSh1bnNhZmUuUG9pbnRlcigmeGMue31bMF0pKVxuJy5mb3Jt
YXQodHlwZW5hbWUsdW5pb25fbmFtZSkKKworICAgICAgICBmb3IgbmYgaW4gZi50eXBlLmZpZWxk
czoKKyAgICAgICAgICAgIHMgKz0geGVubGlnaHRfZ29sYW5nX2NvbnZlcnRfZnJvbV9DKG5mLGN2
YXJuYW1lPSd0bXAnKQorCisgICAgICAgIHMgKz0gJ3JldHVybiBuaWxcbicKKyAgICAgICAgcyAr
PSAnfVxuJworCisgICAgICAgIGV4dHJhcy5hcHBlbmQocykKKworICAgIHMgPSAneC57fSA9IHt9
KHhjLnt9KVxuJy5mb3JtYXQoZ29rZXluYW1lLGdva2V5dHlwZSxjZ29fa2V5bmFtZSkKKyAgICBz
ICs9ICdzd2l0Y2ggeC57fXt7XG4nLmZvcm1hdChnb2tleW5hbWUpCisKKyAgICAjIENyZWF0ZSBz
d2l0Y2ggc3RhdGVtZW50IHRvIGRldGVybWluZSB3aGljaCAndW5pb24gZWxlbWVudCcKKyAgICAj
IHRvIHBvcHVsYXRlIGluIHRoZSBHbyBzdHJ1Y3QuCisgICAgZm9yIGNhc2VfbmFtZSwgY2FzZV92
YWwgaW4gY2FzZXMuaXRlbXMoKToKKyAgICAgICAgcyArPSAnY2FzZSB7fTpcbicuZm9ybWF0KGNh
c2VfdmFsKQorCisgICAgICAgIGdvdHlwZSA9ICd7fV97fV91bmlvbl97fScuZm9ybWF0KHN0cnVj
dF9uYW1lLGtleW5hbWUsY2FzZV9uYW1lKQorICAgICAgICBnb3R5cGUgPSB4ZW5saWdodF9nb2xh
bmdfZm10X25hbWUoZ290eXBlKQorICAgICAgICBnb25hbWUgPSAne31fe30nLmZvcm1hdChrZXlu
YW1lLGNhc2VfbmFtZSkKKyAgICAgICAgZ29uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1l
KGdvbmFtZSxleHBvcnRlZD1GYWxzZSkKKworICAgICAgICBzICs9ICd2YXIge30ge31cbicuZm9y
bWF0KGdvbmFtZSwgZ290eXBlKQorICAgICAgICBzICs9ICdpZiBlcnIgOj0ge30uZnJvbUMoeGMp
OycuZm9ybWF0KGdvbmFtZSkKKyAgICAgICAgcyArPSAnZXJyICE9IG5pbCB7XG4gcmV0dXJuIGVy
ciBcbn1cbicKKworICAgICAgICBmaWVsZF9uYW1lID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1l
KCd7fV91bmlvbicuZm9ybWF0KGtleW5hbWUpKQorICAgICAgICBzICs9ICd4Lnt9ID0ge31cbicu
Zm9ybWF0KGZpZWxkX25hbWUsIGdvbmFtZSkKKworICAgICMgRW5kIHN3aXRjaCBzdGF0ZW1lbnQK
KyAgICBzICs9ICdkZWZhdWx0OlxuJworICAgIGVycl9zdHJpbmcgPSAnImludmFsaWQgdW5pb24g
a2V5IFwnJXZcJyIsIHgue30nLmZvcm1hdChnb2tleW5hbWUpCisgICAgcyArPSAncmV0dXJuIGZt
dC5FcnJvcmYoe30pJy5mb3JtYXQoZXJyX3N0cmluZykKKyAgICBzICs9ICd9XG4nCisKKyAgICBy
ZXR1cm4gKHMsZXh0cmFzKQorCiBkZWYgeGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKG5hbWUsIGV4
cG9ydGVkID0gVHJ1ZSk6CiAgICAgIiIiCiAgICAgVGFrZSBhIGdpdmVuIHR5cGUgbmFtZSBhbmQg
cmV0dXJuIGFuCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4u
Z28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5nZW4uZ28KaW5kZXggNTc2YWViY2Y2
ZC4uZTZlZWUyMzRjMCAxMDA2NDQKLS0tIGEvdG9vbHMvZ29sYW5nL3hlbmxpZ2h0L2hlbHBlcnMu
Z2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9oZWxwZXJzLmdlbi5nbwpAQCAtNSwx
MSArNSwyOCBAQAogLy8KIHBhY2thZ2UgeGVubGlnaHQKIAoraW1wb3J0ICgKKwkiZXJyb3JzIgor
CSJmbXQiCisJInVuc2FmZSIKKykKKwogLyoKICNjZ28gTERGTEFHUzogLWx4ZW5saWdodAogI2lu
Y2x1ZGUgPHN0ZGxpYi5oPgogI2luY2x1ZGUgPGxpYnhsLmg+CiAKK3R5cGVkZWYgdHlwZW9mKCgo
c3RydWN0IGxpYnhsX2NoYW5uZWxpbmZvICopTlVMTCktPnUucHR5KWxpYnhsX2NoYW5uZWxpbmZv
X2Nvbm5lY3Rpb25fdW5pb25fcHR5OwordHlwZWRlZiB0eXBlb2YoKChzdHJ1Y3QgbGlieGxfZG9t
YWluX2J1aWxkX2luZm8gKilOVUxMKS0+dS5odm0pbGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlw
ZV91bmlvbl9odm07Cit0eXBlZGVmIHR5cGVvZigoKHN0cnVjdCBsaWJ4bF9kb21haW5fYnVpbGRf
aW5mbyAqKU5VTEwpLT51LnB2KWxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX3R5cGVfdW5pb25fcHY7
Cit0eXBlZGVmIHR5cGVvZigoKHN0cnVjdCBsaWJ4bF9kb21haW5fYnVpbGRfaW5mbyAqKU5VTEwp
LT51LnB2aClsaWJ4bF9kb21haW5fYnVpbGRfaW5mb190eXBlX3VuaW9uX3B2aDsKK3R5cGVkZWYg
dHlwZW9mKCgoc3RydWN0IGxpYnhsX2RldmljZV91c2JkZXYgKilOVUxMKS0+dS5ob3N0ZGV2KWxp
YnhsX2RldmljZV91c2JkZXZfdHlwZV91bmlvbl9ob3N0ZGV2OwordHlwZWRlZiB0eXBlb2YoKChz
dHJ1Y3QgbGlieGxfZGV2aWNlX2NoYW5uZWwgKilOVUxMKS0+dS5zb2NrZXQpbGlieGxfZGV2aWNl
X2NoYW5uZWxfY29ubmVjdGlvbl91bmlvbl9zb2NrZXQ7Cit0eXBlZGVmIHR5cGVvZigoKHN0cnVj
dCBsaWJ4bF9ldmVudCAqKU5VTEwpLT51LmRvbWFpbl9zaHV0ZG93bilsaWJ4bF9ldmVudF90eXBl
X3VuaW9uX2RvbWFpbl9zaHV0ZG93bjsKK3R5cGVkZWYgdHlwZW9mKCgoc3RydWN0IGxpYnhsX2V2
ZW50ICopTlVMTCktPnUuZGlza19lamVjdClsaWJ4bF9ldmVudF90eXBlX3VuaW9uX2Rpc2tfZWpl
Y3Q7Cit0eXBlZGVmIHR5cGVvZigoKHN0cnVjdCBsaWJ4bF9ldmVudCAqKU5VTEwpLT51Lm9wZXJh
dGlvbl9jb21wbGV0ZSlsaWJ4bF9ldmVudF90eXBlX3VuaW9uX29wZXJhdGlvbl9jb21wbGV0ZTsK
K3R5cGVkZWYgdHlwZW9mKCgoc3RydWN0IGxpYnhsX3Bzcl9od19pbmZvICopTlVMTCktPnUuY2F0
KWxpYnhsX3Bzcl9od19pbmZvX3R5cGVfdW5pb25fY2F0OwordHlwZWRlZiB0eXBlb2YoKChzdHJ1
Y3QgbGlieGxfcHNyX2h3X2luZm8gKilOVUxMKS0+dS5tYmEpbGlieGxfcHNyX2h3X2luZm9fdHlw
ZV91bmlvbl9tYmE7CiAqLwogaW1wb3J0ICJDIgogCkBAIC0xMzcsNyArMTU0LDI4IEBAIGZ1bmMg
KHggKkNoYW5uZWxpbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9jaGFubmVsaW5mbykgZXJyb3Igewog
CXguU3RhdGUgPSBpbnQoeGMuc3RhdGUpCiAJeC5FdnRjaCA9IGludCh4Yy5ldnRjaCkKIAl4LlJy
ZWYgPSBpbnQoeGMucnJlZikKKwl4LkNvbm5lY3Rpb24gPSBDaGFubmVsQ29ubmVjdGlvbih4Yy5j
b25uZWN0aW9uKQorCXN3aXRjaCB4LkNvbm5lY3Rpb24geworCWNhc2UgQ2hhbm5lbENvbm5lY3Rp
b25QdHk6CisJCXZhciBjb25uZWN0aW9uUHR5IENoYW5uZWxpbmZvQ29ubmVjdGlvblVuaW9uUHR5
CisJCWlmIGVyciA6PSBjb25uZWN0aW9uUHR5LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJCQly
ZXR1cm4gZXJyCisJCX0KKwkJeC5Db25uZWN0aW9uVW5pb24gPSBjb25uZWN0aW9uUHR5CisJZGVm
YXVsdDoKKwkJcmV0dXJuIGZtdC5FcnJvcmYoImludmFsaWQgdW5pb24ga2V5ICcldiciLCB4LkNv
bm5lY3Rpb24pCisJfQorCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpDaGFubmVsaW5mb0Nv
bm5lY3Rpb25VbmlvblB0eSkgZnJvbUMoeGMgKkMubGlieGxfY2hhbm5lbGluZm8pIGVycm9yIHsK
KwlpZiBDaGFubmVsQ29ubmVjdGlvbih4Yy5jb25uZWN0aW9uKSAhPSBDaGFubmVsQ29ubmVjdGlv
blB0eSB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgQ2hhbm5lbENv
bm5lY3Rpb25QdHkiKQorCX0KIAorCXRtcCA6PSAoKkMubGlieGxfY2hhbm5lbGluZm9fY29ubmVj
dGlvbl91bmlvbl9wdHkpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4LlBhdGggPSBDLkdv
U3RyaW5nKHRtcC5wYXRoKQogCXJldHVybiBuaWwKIH0KIApAQCAtMzQwLDYgKzM3OCwyOSBAQCBm
dW5jICh4ICpEb21haW5CdWlsZEluZm8pIGZyb21DKHhjICpDLmxpYnhsX2RvbWFpbl9idWlsZF9p
bmZvKSBlcnJvciB7CiAJCXJldHVybiBlcnIKIAl9CiAJeC5UZWUgPSBUZWVUeXBlKHhjLnRlZSkK
Kwl4LlR5cGUgPSBEb21haW5UeXBlKHhjLl90eXBlKQorCXN3aXRjaCB4LlR5cGUgeworCWNhc2Ug
RG9tYWluVHlwZVB2OgorCQl2YXIgdHlwZVB2IERvbWFpbkJ1aWxkSW5mb1R5cGVVbmlvblB2CisJ
CWlmIGVyciA6PSB0eXBlUHYuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIK
KwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVQdgorCWNhc2UgRG9tYWluVHlwZUh2bToKKwkJdmFy
IHR5cGVIdm0gRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uSHZtCisJCWlmIGVyciA6PSB0eXBlSHZt
LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5p
b24gPSB0eXBlSHZtCisJY2FzZSBEb21haW5UeXBlUHZoOgorCQl2YXIgdHlwZVB2aCBEb21haW5C
dWlsZEluZm9UeXBlVW5pb25QdmgKKwkJaWYgZXJyIDo9IHR5cGVQdmguZnJvbUMoeGMpOyBlcnIg
IT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVQdmgKKwlk
ZWZhdWx0OgorCQlyZXR1cm4gZm10LkVycm9yZigiaW52YWxpZCB1bmlvbiBrZXkgJyV2JyIsIHgu
VHlwZSkKKwl9CiAJeC5BcmNoQXJtLkdpY1ZlcnNpb24gPSBHaWNWZXJzaW9uKHhjLmFyY2hfYXJt
LmdpY192ZXJzaW9uKQogCXguQXJjaEFybS5WdWFydCA9IFZ1YXJ0VHlwZSh4Yy5hcmNoX2FybS52
dWFydCkKIAl4LkFsdHAyTSA9IEFsdHAyTU1vZGUoeGMuYWx0cDJtKQpAQCAtMzQ3LDYgKzQwOCwx
NTEgQEAgZnVuYyAoeCAqRG9tYWluQnVpbGRJbmZvKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5f
YnVpbGRfaW5mbykgZXJyb3IgewogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRG9tYWluQnVp
bGRJbmZvVHlwZVVuaW9uSHZtKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mbykg
ZXJyb3IgeworCWlmIERvbWFpblR5cGUoeGMuX3R5cGUpICE9IERvbWFpblR5cGVIdm0geworCQly
ZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQgdW5pb24ga2V5IERvbWFpblR5cGVIdm0iKQorCX0K
KworCXRtcCA6PSAoKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91bmlvbl9odm0pKHVu
c2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4LkZpcm13YXJlID0gQy5Hb1N0cmluZyh0bXAuZmly
bXdhcmUpCisJeC5CaW9zID0gQmlvc1R5cGUodG1wLmJpb3MpCisJaWYgZXJyIDo9IHguUGFlLmZy
b21DKCZ0bXAucGFlKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9
IHguQXBpYy5mcm9tQygmdG1wLmFwaWMpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0K
KwlpZiBlcnIgOj0geC5BY3BpLmZyb21DKCZ0bXAuYWNwaSk7IGVyciAhPSBuaWwgeworCQlyZXR1
cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkFjcGlTMy5mcm9tQygmdG1wLmFjcGlfczMpOyBlcnIg
IT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5BY3BpUzQuZnJvbUMoJnRt
cC5hY3BpX3M0KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHgu
QWNwaUxhcHRvcFNsYXRlLmZyb21DKCZ0bXAuYWNwaV9sYXB0b3Bfc2xhdGUpOyBlcnIgIT0gbmls
IHsKKwkJcmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5OeC5mcm9tQygmdG1wLm54KTsgZXJy
ICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguVmlyaWRpYW4uZnJvbUMo
JnRtcC52aXJpZGlhbik7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6
PSB4LlZpcmlkaWFuRW5hYmxlLmZyb21DKCZ0bXAudmlyaWRpYW5fZW5hYmxlKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguVmlyaWRpYW5EaXNhYmxlLmZyb21D
KCZ0bXAudmlyaWRpYW5fZGlzYWJsZSk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQor
CXguVGltZW9mZnNldCA9IEMuR29TdHJpbmcodG1wLnRpbWVvZmZzZXQpCisJaWYgZXJyIDo9IHgu
SHBldC5mcm9tQygmdG1wLmhwZXQpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwlp
ZiBlcnIgOj0geC5WcHRBbGlnbi5mcm9tQygmdG1wLnZwdF9hbGlnbik7IGVyciAhPSBuaWwgewor
CQlyZXR1cm4gZXJyCisJfQorCXguTW1pb0hvbGVNZW1rYiA9IHVpbnQ2NCh0bXAubW1pb19ob2xl
X21lbWtiKQorCXguVGltZXJNb2RlID0gVGltZXJNb2RlKHRtcC50aW1lcl9tb2RlKQorCWlmIGVy
ciA6PSB4Lk5lc3RlZEh2bS5mcm9tQygmdG1wLm5lc3RlZF9odm0pOyBlcnIgIT0gbmlsIHsKKwkJ
cmV0dXJuIGVycgorCX0KKwlpZiBlcnIgOj0geC5BbHRwMk0uZnJvbUMoJnRtcC5hbHRwMm0pOyBl
cnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlN5c3RlbUZpcm13YXJlID0gQy5Hb1N0
cmluZyh0bXAuc3lzdGVtX2Zpcm13YXJlKQorCXguU21iaW9zRmlybXdhcmUgPSBDLkdvU3RyaW5n
KHRtcC5zbWJpb3NfZmlybXdhcmUpCisJeC5BY3BpRmlybXdhcmUgPSBDLkdvU3RyaW5nKHRtcC5h
Y3BpX2Zpcm13YXJlKQorCXguSGR0eXBlID0gSGR0eXBlKHRtcC5oZHR5cGUpCisJaWYgZXJyIDo9
IHguTm9ncmFwaGljLmZyb21DKCZ0bXAubm9ncmFwaGljKTsgZXJyICE9IG5pbCB7CisJCXJldHVy
biBlcnIKKwl9CisJaWYgZXJyIDo9IHguVmdhLmZyb21DKCZ0bXAudmdhKTsgZXJyICE9IG5pbCB7
CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguVm5jLmZyb21DKCZ0bXAudm5jKTsgZXJy
ICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5LZXltYXAgPSBDLkdvU3RyaW5nKHRtcC5r
ZXltYXApCisJaWYgZXJyIDo9IHguU2RsLmZyb21DKCZ0bXAuc2RsKTsgZXJyICE9IG5pbCB7CisJ
CXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguU3BpY2UuZnJvbUMoJnRtcC5zcGljZSk7IGVy
ciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LkdmeFBhc3N0aHJ1LmZy
b21DKCZ0bXAuZ2Z4X3Bhc3N0aHJ1KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJ
eC5HZnhQYXNzdGhydUtpbmQgPSBHZnhQYXNzdGhydUtpbmQodG1wLmdmeF9wYXNzdGhydV9raW5k
KQorCXguU2VyaWFsID0gQy5Hb1N0cmluZyh0bXAuc2VyaWFsKQorCXguQm9vdCA9IEMuR29TdHJp
bmcodG1wLmJvb3QpCisJaWYgZXJyIDo9IHguVXNiLmZyb21DKCZ0bXAudXNiKTsgZXJyICE9IG5p
bCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5Vc2J2ZXJzaW9uID0gaW50KHRtcC51c2J2ZXJzaW9u
KQorCXguVXNiZGV2aWNlID0gQy5Hb1N0cmluZyh0bXAudXNiZGV2aWNlKQorCWlmIGVyciA6PSB4
LlZrYkRldmljZS5mcm9tQygmdG1wLnZrYl9kZXZpY2UpOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJu
IGVycgorCX0KKwl4LlNvdW5kaHcgPSBDLkdvU3RyaW5nKHRtcC5zb3VuZGh3KQorCWlmIGVyciA6
PSB4LlhlblBsYXRmb3JtUGNpLmZyb21DKCZ0bXAueGVuX3BsYXRmb3JtX3BjaSk7IGVyciAhPSBu
aWwgeworCQlyZXR1cm4gZXJyCisJfQorCWlmIGVyciA6PSB4LlVzYmRldmljZUxpc3QuZnJvbUMo
JnRtcC51c2JkZXZpY2VfbGlzdCk7IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXgu
VmVuZG9yRGV2aWNlID0gVmVuZG9yRGV2aWNlKHRtcC52ZW5kb3JfZGV2aWNlKQorCWlmIGVyciA6
PSB4Lk1zVm1HZW5pZC5mcm9tQygmdG1wLm1zX3ZtX2dlbmlkKTsgZXJyICE9IG5pbCB7CisJCXJl
dHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguU2VyaWFsTGlzdC5mcm9tQygmdG1wLnNlcmlhbF9s
aXN0KTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJaWYgZXJyIDo9IHguUmRtLmZy
b21DKCZ0bXAucmRtKTsgZXJyICE9IG5pbCB7CisJCXJldHVybiBlcnIKKwl9CisJeC5SZG1NZW1C
b3VuZGFyeU1lbWtiID0gdWludDY0KHRtcC5yZG1fbWVtX2JvdW5kYXJ5X21lbWtiKQorCXguTWNh
Q2FwcyA9IHVpbnQ2NCh0bXAubWNhX2NhcHMpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpE
b21haW5CdWlsZEluZm9UeXBlVW5pb25QdikgZnJvbUMoeGMgKkMubGlieGxfZG9tYWluX2J1aWxk
X2luZm8pIGVycm9yIHsKKwlpZiBEb21haW5UeXBlKHhjLl90eXBlKSAhPSBEb21haW5UeXBlUHYg
eworCQlyZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQgdW5pb24ga2V5IERvbWFpblR5cGVQdiIp
CisJfQorCisJdG1wIDo9ICgqQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb190eXBlX3VuaW9uX3B2
KSh1bnNhZmUuUG9pbnRlcigmeGMudVswXSkpCisJeC5LZXJuZWwgPSBDLkdvU3RyaW5nKHRtcC5r
ZXJuZWwpCisJeC5TbGFja01lbWtiID0gdWludDY0KHRtcC5zbGFja19tZW1rYikKKwl4LkJvb3Rs
b2FkZXIgPSBDLkdvU3RyaW5nKHRtcC5ib290bG9hZGVyKQorCWlmIGVyciA6PSB4LkJvb3Rsb2Fk
ZXJBcmdzLmZyb21DKCZ0bXAuYm9vdGxvYWRlcl9hcmdzKTsgZXJyICE9IG5pbCB7CisJCXJldHVy
biBlcnIKKwl9CisJeC5DbWRsaW5lID0gQy5Hb1N0cmluZyh0bXAuY21kbGluZSkKKwl4LlJhbWRp
c2sgPSBDLkdvU3RyaW5nKHRtcC5yYW1kaXNrKQorCXguRmVhdHVyZXMgPSBDLkdvU3RyaW5nKHRt
cC5mZWF0dXJlcykKKwlpZiBlcnIgOj0geC5FODIwSG9zdC5mcm9tQygmdG1wLmU4MjBfaG9zdCk7
IGVyciAhPSBuaWwgeworCQlyZXR1cm4gZXJyCisJfQorCXJldHVybiBuaWwKK30KKworZnVuYyAo
eCAqRG9tYWluQnVpbGRJbmZvVHlwZVVuaW9uUHZoKSBmcm9tQyh4YyAqQy5saWJ4bF9kb21haW5f
YnVpbGRfaW5mbykgZXJyb3IgeworCWlmIERvbWFpblR5cGUoeGMuX3R5cGUpICE9IERvbWFpblR5
cGVQdmggeworCQlyZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQgdW5pb24ga2V5IERvbWFpblR5
cGVQdmgiKQorCX0KKworCXRtcCA6PSAoKkMubGlieGxfZG9tYWluX2J1aWxkX2luZm9fdHlwZV91
bmlvbl9wdmgpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwlpZiBlcnIgOj0geC5QdnNoaW0u
ZnJvbUMoJnRtcC5wdnNoaW0pOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVycgorCX0KKwl4LlB2
c2hpbVBhdGggPSBDLkdvU3RyaW5nKHRtcC5wdnNoaW1fcGF0aCkKKwl4LlB2c2hpbUNtZGxpbmUg
PSBDLkdvU3RyaW5nKHRtcC5wdnNoaW1fY21kbGluZSkKKwl4LlB2c2hpbUV4dHJhID0gQy5Hb1N0
cmluZyh0bXAucHZzaGltX2V4dHJhKQorCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRGV2aWNl
VmZiKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfdmZiKSBlcnJvciB7CiAJeC5CYWNrZW5kRG9t
aWQgPSBEb21pZCh4Yy5iYWNrZW5kX2RvbWlkKQogCXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3Ry
aW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKQEAgLTUyMCwxMCArNzI2LDMyIEBAIGZ1bmMgKHggKkRl
dmljZVVzYmN0cmwpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JjdHJsKSBlcnJvciB7CiBm
dW5jICh4ICpEZXZpY2VVc2JkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV91c2JkZXYpIGVy
cm9yIHsKIAl4LkN0cmwgPSBEZXZpZCh4Yy5jdHJsKQogCXguUG9ydCA9IGludCh4Yy5wb3J0KQor
CXguVHlwZSA9IFVzYmRldlR5cGUoeGMuX3R5cGUpCisJc3dpdGNoIHguVHlwZSB7CisJY2FzZSBV
c2JkZXZUeXBlSG9zdGRldjoKKwkJdmFyIHR5cGVIb3N0ZGV2IERldmljZVVzYmRldlR5cGVVbmlv
bkhvc3RkZXYKKwkJaWYgZXJyIDo9IHR5cGVIb3N0ZGV2LmZyb21DKHhjKTsgZXJyICE9IG5pbCB7
CisJCQlyZXR1cm4gZXJyCisJCX0KKwkJeC5UeXBlVW5pb24gPSB0eXBlSG9zdGRldgorCWRlZmF1
bHQ6CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAnJXYnIiwgeC5UeXBl
KQorCX0KIAogCXJldHVybiBuaWwKIH0KIAorZnVuYyAoeCAqRGV2aWNlVXNiZGV2VHlwZVVuaW9u
SG9zdGRldikgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX3VzYmRldikgZXJyb3IgeworCWlmIFVz
YmRldlR5cGUoeGMuX3R5cGUpICE9IFVzYmRldlR5cGVIb3N0ZGV2IHsKKwkJcmV0dXJuIGVycm9y
cy5OZXcoImV4cGVjdGVkIHVuaW9uIGtleSBVc2JkZXZUeXBlSG9zdGRldiIpCisJfQorCisJdG1w
IDo9ICgqQy5saWJ4bF9kZXZpY2VfdXNiZGV2X3R5cGVfdW5pb25faG9zdGRldikodW5zYWZlLlBv
aW50ZXIoJnhjLnVbMF0pKQorCXguSG9zdGJ1cyA9IGJ5dGUodG1wLmhvc3RidXMpCisJeC5Ib3N0
YWRkciA9IGJ5dGUodG1wLmhvc3RhZGRyKQorCXJldHVybiBuaWwKK30KKwogZnVuYyAoeCAqRGV2
aWNlRHRkZXYpIGZyb21DKHhjICpDLmxpYnhsX2RldmljZV9kdGRldikgZXJyb3IgewogCXguUGF0
aCA9IEMuR29TdHJpbmcoeGMucGF0aCkKIApAQCAtNTY1LDcgKzc5MywyOCBAQCBmdW5jICh4ICpE
ZXZpY2VDaGFubmVsKSBmcm9tQyh4YyAqQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCkgZXJyb3Igewog
CXguQmFja2VuZERvbW5hbWUgPSBDLkdvU3RyaW5nKHhjLmJhY2tlbmRfZG9tbmFtZSkKIAl4LkRl
dmlkID0gRGV2aWQoeGMuZGV2aWQpCiAJeC5OYW1lID0gQy5Hb1N0cmluZyh4Yy5uYW1lKQorCXgu
Q29ubmVjdGlvbiA9IENoYW5uZWxDb25uZWN0aW9uKHhjLmNvbm5lY3Rpb24pCisJc3dpdGNoIHgu
Q29ubmVjdGlvbiB7CisJY2FzZSBDaGFubmVsQ29ubmVjdGlvblNvY2tldDoKKwkJdmFyIGNvbm5l
Y3Rpb25Tb2NrZXQgRGV2aWNlQ2hhbm5lbENvbm5lY3Rpb25VbmlvblNvY2tldAorCQlpZiBlcnIg
Oj0gY29ubmVjdGlvblNvY2tldC5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVy
cgorCQl9CisJCXguQ29ubmVjdGlvblVuaW9uID0gY29ubmVjdGlvblNvY2tldAorCWRlZmF1bHQ6
CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9uIGtleSAnJXYnIiwgeC5Db25uZWN0
aW9uKQorCX0KKworCXJldHVybiBuaWwKK30KIAorZnVuYyAoeCAqRGV2aWNlQ2hhbm5lbENvbm5l
Y3Rpb25VbmlvblNvY2tldCkgZnJvbUMoeGMgKkMubGlieGxfZGV2aWNlX2NoYW5uZWwpIGVycm9y
IHsKKwlpZiBDaGFubmVsQ29ubmVjdGlvbih4Yy5jb25uZWN0aW9uKSAhPSBDaGFubmVsQ29ubmVj
dGlvblNvY2tldCB7CisJCXJldHVybiBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgQ2hh
bm5lbENvbm5lY3Rpb25Tb2NrZXQiKQorCX0KKworCXRtcCA6PSAoKkMubGlieGxfZGV2aWNlX2No
YW5uZWxfY29ubmVjdGlvbl91bmlvbl9zb2NrZXQpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkK
Kwl4LlBhdGggPSBDLkdvU3RyaW5nKHRtcC5wYXRoKQogCXJldHVybiBuaWwKIH0KIApAQCAtODgx
LDcgKzExMzAsNjMgQEAgZnVuYyAoeCAqRXZlbnQpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBl
cnJvciB7CiAJCXJldHVybiBlcnIKIAl9CiAJeC5Gb3JVc2VyID0gdWludDY0KHhjLmZvcl91c2Vy
KQorCXguVHlwZSA9IEV2ZW50VHlwZSh4Yy5fdHlwZSkKKwlzd2l0Y2ggeC5UeXBlIHsKKwljYXNl
IEV2ZW50VHlwZU9wZXJhdGlvbkNvbXBsZXRlOgorCQl2YXIgdHlwZU9wZXJhdGlvbkNvbXBsZXRl
IEV2ZW50VHlwZVVuaW9uT3BlcmF0aW9uQ29tcGxldGUKKwkJaWYgZXJyIDo9IHR5cGVPcGVyYXRp
b25Db21wbGV0ZS5mcm9tQyh4Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJ
CXguVHlwZVVuaW9uID0gdHlwZU9wZXJhdGlvbkNvbXBsZXRlCisJY2FzZSBFdmVudFR5cGVEb21h
aW5TaHV0ZG93bjoKKwkJdmFyIHR5cGVEb21haW5TaHV0ZG93biBFdmVudFR5cGVVbmlvbkRvbWFp
blNodXRkb3duCisJCWlmIGVyciA6PSB0eXBlRG9tYWluU2h1dGRvd24uZnJvbUMoeGMpOyBlcnIg
IT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVEb21haW5T
aHV0ZG93bgorCWNhc2UgRXZlbnRUeXBlRGlza0VqZWN0OgorCQl2YXIgdHlwZURpc2tFamVjdCBF
dmVudFR5cGVVbmlvbkRpc2tFamVjdAorCQlpZiBlcnIgOj0gdHlwZURpc2tFamVjdC5mcm9tQyh4
Yyk7IGVyciAhPSBuaWwgeworCQkJcmV0dXJuIGVycgorCQl9CisJCXguVHlwZVVuaW9uID0gdHlw
ZURpc2tFamVjdAorCWRlZmF1bHQ6CisJCXJldHVybiBmbXQuRXJyb3JmKCJpbnZhbGlkIHVuaW9u
IGtleSAnJXYnIiwgeC5UeXBlKQorCX0KKworCXJldHVybiBuaWwKK30KKworZnVuYyAoeCAqRXZl
bnRUeXBlVW5pb25Eb21haW5TaHV0ZG93bikgZnJvbUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9y
IHsKKwlpZiBFdmVudFR5cGUoeGMuX3R5cGUpICE9IEV2ZW50VHlwZURvbWFpblNodXRkb3duIHsK
KwkJcmV0dXJuIGVycm9ycy5OZXcoImV4cGVjdGVkIHVuaW9uIGtleSBFdmVudFR5cGVEb21haW5T
aHV0ZG93biIpCisJfQogCisJdG1wIDo9ICgqQy5saWJ4bF9ldmVudF90eXBlX3VuaW9uX2RvbWFp
bl9zaHV0ZG93bikodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0pKQorCXguU2h1dGRvd25SZWFzb24g
PSBieXRlKHRtcC5zaHV0ZG93bl9yZWFzb24pCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpF
dmVudFR5cGVVbmlvbkRpc2tFamVjdCkgZnJvbUMoeGMgKkMubGlieGxfZXZlbnQpIGVycm9yIHsK
KwlpZiBFdmVudFR5cGUoeGMuX3R5cGUpICE9IEV2ZW50VHlwZURpc2tFamVjdCB7CisJCXJldHVy
biBlcnJvcnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgRXZlbnRUeXBlRGlza0VqZWN0IikKKwl9
CisKKwl0bXAgOj0gKCpDLmxpYnhsX2V2ZW50X3R5cGVfdW5pb25fZGlza19lamVjdCkodW5zYWZl
LlBvaW50ZXIoJnhjLnVbMF0pKQorCXguVmRldiA9IEMuR29TdHJpbmcodG1wLnZkZXYpCisJaWYg
ZXJyIDo9IHguRGlzay5mcm9tQygmdG1wLmRpc2spOyBlcnIgIT0gbmlsIHsKKwkJcmV0dXJuIGVy
cgorCX0KKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMgKHggKkV2ZW50VHlwZVVuaW9uT3BlcmF0aW9u
Q29tcGxldGUpIGZyb21DKHhjICpDLmxpYnhsX2V2ZW50KSBlcnJvciB7CisJaWYgRXZlbnRUeXBl
KHhjLl90eXBlKSAhPSBFdmVudFR5cGVPcGVyYXRpb25Db21wbGV0ZSB7CisJCXJldHVybiBlcnJv
cnMuTmV3KCJleHBlY3RlZCB1bmlvbiBrZXkgRXZlbnRUeXBlT3BlcmF0aW9uQ29tcGxldGUiKQor
CX0KKworCXRtcCA6PSAoKkMubGlieGxfZXZlbnRfdHlwZV91bmlvbl9vcGVyYXRpb25fY29tcGxl
dGUpKHVuc2FmZS5Qb2ludGVyKCZ4Yy51WzBdKSkKKwl4LlJjID0gaW50KHRtcC5yYykKIAlyZXR1
cm4gbmlsCiB9CiAKQEAgLTg5Niw2ICsxMjAxLDQ3IEBAIGZ1bmMgKHggKlBzckNhdEluZm8pIGZy
b21DKHhjICpDLmxpYnhsX3Bzcl9jYXRfaW5mbykgZXJyb3IgewogCiBmdW5jICh4ICpQc3JId0lu
Zm8pIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9od19pbmZvKSBlcnJvciB7CiAJeC5JZCA9IHVpbnQz
Mih4Yy5pZCkKKwl4LlR5cGUgPSBQc3JGZWF0VHlwZSh4Yy5fdHlwZSkKKwlzd2l0Y2ggeC5UeXBl
IHsKKwljYXNlIFBzckZlYXRUeXBlTWJhOgorCQl2YXIgdHlwZU1iYSBQc3JId0luZm9UeXBlVW5p
b25NYmEKKwkJaWYgZXJyIDo9IHR5cGVNYmEuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJl
dHVybiBlcnIKKwkJfQorCQl4LlR5cGVVbmlvbiA9IHR5cGVNYmEKKwljYXNlIFBzckZlYXRUeXBl
Q2F0OgorCQl2YXIgdHlwZUNhdCBQc3JId0luZm9UeXBlVW5pb25DYXQKKwkJaWYgZXJyIDo9IHR5
cGVDYXQuZnJvbUMoeGMpOyBlcnIgIT0gbmlsIHsKKwkJCXJldHVybiBlcnIKKwkJfQorCQl4LlR5
cGVVbmlvbiA9IHR5cGVDYXQKKwlkZWZhdWx0OgorCQlyZXR1cm4gZm10LkVycm9yZigiaW52YWxp
ZCB1bmlvbiBrZXkgJyV2JyIsIHguVHlwZSkKKwl9CisKKwlyZXR1cm4gbmlsCit9CisKK2Z1bmMg
KHggKlBzckh3SW5mb1R5cGVVbmlvbkNhdCkgZnJvbUMoeGMgKkMubGlieGxfcHNyX2h3X2luZm8p
IGVycm9yIHsKKwlpZiBQc3JGZWF0VHlwZSh4Yy5fdHlwZSkgIT0gUHNyRmVhdFR5cGVDYXQgewor
CQlyZXR1cm4gZXJyb3JzLk5ldygiZXhwZWN0ZWQgdW5pb24ga2V5IFBzckZlYXRUeXBlQ2F0IikK
Kwl9CisKKwl0bXAgOj0gKCpDLmxpYnhsX3Bzcl9od19pbmZvX3R5cGVfdW5pb25fY2F0KSh1bnNh
ZmUuUG9pbnRlcigmeGMudVswXSkpCisJeC5Db3NNYXggPSB1aW50MzIodG1wLmNvc19tYXgpCisJ
eC5DYm1MZW4gPSB1aW50MzIodG1wLmNibV9sZW4pCisJeC5DZHBFbmFibGVkID0gYm9vbCh0bXAu
Y2RwX2VuYWJsZWQpCisJcmV0dXJuIG5pbAorfQorCitmdW5jICh4ICpQc3JId0luZm9UeXBlVW5p
b25NYmEpIGZyb21DKHhjICpDLmxpYnhsX3Bzcl9od19pbmZvKSBlcnJvciB7CisJaWYgUHNyRmVh
dFR5cGUoeGMuX3R5cGUpICE9IFBzckZlYXRUeXBlTWJhIHsKKwkJcmV0dXJuIGVycm9ycy5OZXco
ImV4cGVjdGVkIHVuaW9uIGtleSBQc3JGZWF0VHlwZU1iYSIpCisJfQogCisJdG1wIDo9ICgqQy5s
aWJ4bF9wc3JfaHdfaW5mb190eXBlX3VuaW9uX21iYSkodW5zYWZlLlBvaW50ZXIoJnhjLnVbMF0p
KQorCXguQ29zTWF4ID0gdWludDMyKHRtcC5jb3NfbWF4KQorCXguVGhydGxNYXggPSB1aW50MzIo
dG1wLnRocnRsX21heCkKKwl4LkxpbmVhciA9IGJvb2wodG1wLmxpbmVhcikKIAlyZXR1cm4gbmls
CiB9Ci0tIAoyLjE5LjEKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0
Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRl
dmVs

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 7A187C4882
	for <lists+xen-devel@lfdr.de>; Wed,  2 Oct 2019 09:30:39 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iFZ3F-0001Hm-QA; Wed, 02 Oct 2019 07:27:57 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=lglc=X3=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1iFZ3E-0001H3-LW
 for xen-devel@lists.xenproject.org; Wed, 02 Oct 2019 07:27:56 +0000
X-Inumbo-ID: 22ddf1ae-e4e6-11e9-9710-12813bfff9fa
Received: from mx1.suse.de (unknown [195.135.220.15])
 by localhost (Halon) with ESMTPS
 id 22ddf1ae-e4e6-11e9-9710-12813bfff9fa;
 Wed, 02 Oct 2019 07:27:49 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id BB108AF61;
 Wed,  2 Oct 2019 07:27:48 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Wed,  2 Oct 2019 09:27:27 +0200
Message-Id: <20191002072745.24919-3-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20191002072745.24919-1-jgross@suse.com>
References: <20191002072745.24919-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v6 02/20] xen/sched: introduce
 unit_runnable_state()
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>,
 Stefano Stabellini <sstabellini@kernel.org>, Julien Grall <julien@xen.org>,
 Wei Liu <wl@xen.org>, Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <George.Dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>, Tim Deegan <tim@xen.org>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>,
 Dario Faggioli <dfaggioli@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VG9kYXkgdGhlIHZjcHUgcnVuc3RhdGUgb2YgYSBuZXcgc2NoZWR1bGVkIHZjcHUgaXMgYWx3YXlz
IHNldCB0bwoicnVubmluZyIgZXZlbiBpZiBhdCB0aGF0IHRpbWUgdmNwdV9ydW5uYWJsZSgpIGlz
IGFscmVhZHkgcmV0dXJuaW5nCmZhbHNlIGR1ZSB0byBhIHJhY2UgKGUuZy4gd2l0aCBwYXVzaW5n
IHRoZSB2Y3B1KS4KCldpdGggY29yZSBzY2hlZHVsaW5nIHRoaXMgY2FuIG5vIGxvbmdlciB3b3Jr
IGFzIG5vdCBhbGwgdmNwdXMgb2YgYQpzY2hlZHVsZSB1bml0IGhhdmUgdG8gYmUgInJ1bm5pbmci
IHdoZW4gYmVpbmcgc2NoZWR1bGVkLiBTbyB0aGUgdmNwdSdzCm5ldyBydW5zdGF0ZSBoYXMgdG8g
YmUgc2VsZWN0ZWQgYXQgdGhlIHNhbWUgdGltZSBhcyB0aGUgcnVubmFiaWxpdHkgb2YKdGhlIHJl
bGF0ZWQgc2NoZWR1bGUgdW5pdCBpcyBwcm9iZWQuCgpGb3IgdGhpcyBwdXJwb3NlIGludHJvZHVj
ZSBhIG5ldyBoZWxwZXIgdW5pdF9ydW5uYWJsZV9zdGF0ZSgpIHdoaWNoCndpbGwgc2F2ZSB0aGUg
bmV3IHJ1bnN0YXRlIG9mIGFsbCB0ZXN0ZWQgdmNwdXMgaW4gYSBuZXcgZmllbGQgb2YgdGhlCnZj
cHUgc3RydWN0LgoKU2lnbmVkLW9mZi1ieTogSnVlcmdlbiBHcm9zcyA8amdyb3NzQHN1c2UuY29t
PgpSZXZpZXdlZC1ieTogRGFyaW8gRmFnZ2lvbGkgPGRmYWdnaW9saUBzdXNlLmNvbT4KLS0tClJG
QyBWMjoKLSBuZXcgcGF0Y2gKVjM6Ci0gYWRkIHZjcHUgbG9vcCB0byB1bml0X3J1bm5hYmxlX3N0
YXRlKCkgcmlnaHQgbm93IGluc3RlYWQgb2YgZG9pbmcKICBzbyBpbiBuZXh0IHBhdGNoIChKYW4g
QmV1bGljaCwgRGFyaW8gRmFnZ2lvbGkpCi0gbWFrZSBuZXdfc3RhdGUgdW5zaWduZWQgaW50IChK
YW4gQmV1bGljaCkKVjQ6Ci0gYWRkIGNvbW1lbnQgZXhwbGFpbmluZyB1bml0X3J1bm5hYmxlX3N0
YXRlKCkgKEphbiBCZXVsaWNoKQotLS0KIHhlbi9jb21tb24vZG9tYWluLmMgICAgICAgICB8ICAx
ICsKIHhlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYyB8ICAyICstCiB4ZW4vY29tbW9uL3NjaGVk
X2NyZWRpdC5jICAgfCA0OSArKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0t
LS0tLS0KIHhlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jICB8ICA3ICsrKystLS0KIHhlbi9jb21t
b24vc2NoZWRfbnVsbC5jICAgICB8ICAzICsrLQogeGVuL2NvbW1vbi9zY2hlZF9ydC5jICAgICAg
IHwgIDggKysrKysrKy0KIHhlbi9jb21tb24vc2NoZWR1bGUuYyAgICAgICB8ICAyICstCiB4ZW4v
aW5jbHVkZS94ZW4vc2NoZWQtaWYuaCAgfCAzMCArKysrKysrKysrKysrKysrKysrKysrKysrKysK
IHhlbi9pbmNsdWRlL3hlbi9zY2hlZC5oICAgICB8ICAxICsKIDkgZmlsZXMgY2hhbmdlZCwgNzMg
aW5zZXJ0aW9ucygrKSwgMzAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9k
b21haW4uYyBiL3hlbi9jb21tb24vZG9tYWluLmMKaW5kZXggNjAxZGEyOGM5Yy4uYTk4ODI1MDll
ZCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9kb21haW4uYworKysgYi94ZW4vY29tbW9uL2RvbWFp
bi5jCkBAIC0xNTcsNiArMTU3LDcgQEAgc3RydWN0IHZjcHUgKnZjcHVfY3JlYXRlKHN0cnVjdCBk
b21haW4gKmQsIHVuc2lnbmVkIGludCB2Y3B1X2lkKQogICAgIGlmICggaXNfaWRsZV9kb21haW4o
ZCkgKQogICAgIHsKICAgICAgICAgdi0+cnVuc3RhdGUuc3RhdGUgPSBSVU5TVEFURV9ydW5uaW5n
OworICAgICAgICB2LT5uZXdfc3RhdGUgPSBSVU5TVEFURV9ydW5uaW5nOwogICAgIH0KICAgICBl
bHNlCiAgICAgewpkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jIGIveGVu
L2NvbW1vbi9zY2hlZF9hcmluYzY1My5jCmluZGV4IGZjZjgxZGIxOWEuLmRkNTg3NmVhY2QgMTAw
NjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYworKysgYi94ZW4vY29tbW9uL3Nj
aGVkX2FyaW5jNjUzLmMKQEAgLTU2Myw3ICs1NjMsNyBAQCBhNjUzc2NoZWRfZG9fc2NoZWR1bGUo
CiAgICAgaWYgKCAhKChuZXdfdGFzayAhPSBOVUxMKQogICAgICAgICAgICAmJiAoQVVOSVQobmV3
X3Rhc2spICE9IE5VTEwpCiAgICAgICAgICAgICYmIEFVTklUKG5ld190YXNrKS0+YXdha2UKLSAg
ICAgICAgICAgJiYgdW5pdF9ydW5uYWJsZShuZXdfdGFzaykpICkKKyAgICAgICAgICAgJiYgdW5p
dF9ydW5uYWJsZV9zdGF0ZShuZXdfdGFzaykpICkKICAgICAgICAgbmV3X3Rhc2sgPSBJRExFVEFT
SyhjcHUpOwogICAgIEJVR19PTihuZXdfdGFzayA9PSBOVUxMKTsKIApkaWZmIC0tZ2l0IGEveGVu
L2NvbW1vbi9zY2hlZF9jcmVkaXQuYyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKaW5kZXgg
Mjk5ZWZmMjFhYy4uMDBiZWFjM2VhNCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9jcmVk
aXQuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCkBAIC0xODk0LDcgKzE4OTQsNyBA
QCBzdGF0aWMgdm9pZCBjc2NoZWRfc2NoZWR1bGUoCiAgICAgaWYgKCAhdGVzdF9iaXQoQ1NDSEVE
X0ZMQUdfVU5JVF9ZSUVMRCwgJnNjdXJyLT5mbGFncykKICAgICAgICAgICYmICF0YXNrbGV0X3dv
cmtfc2NoZWR1bGVkCiAgICAgICAgICAmJiBwcnYtPnJhdGVsaW1pdAotICAgICAgICAgJiYgdW5p
dF9ydW5uYWJsZSh1bml0KQorICAgICAgICAgJiYgdW5pdF9ydW5uYWJsZV9zdGF0ZSh1bml0KQog
ICAgICAgICAgJiYgIWlzX2lkbGVfdW5pdCh1bml0KQogICAgICAgICAgJiYgcnVudGltZSA8IHBy
di0+cmF0ZWxpbWl0ICkKICAgICB7CkBAIC0xOTM5LDMzICsxOTM5LDM2IEBAIHN0YXRpYyB2b2lk
IGNzY2hlZF9zY2hlZHVsZSgKICAgICAgICAgZGVjX25yX3J1bm5hYmxlKHNjaGVkX2NwdSk7CiAg
ICAgfQogCi0gICAgc25leHQgPSBfX3J1bnFfZWxlbShydW5xLT5uZXh0KTsKLQotICAgIC8qIFRh
c2tsZXQgd29yayAod2hpY2ggcnVucyBpbiBpZGxlIFVOSVQgY29udGV4dCkgb3ZlcnJpZGVzIGFs
bCBlbHNlLiAqLwotICAgIGlmICggdGFza2xldF93b3JrX3NjaGVkdWxlZCApCi0gICAgewotICAg
ICAgICBUUkFDRV8wRChUUkNfQ1NDSEVEX1NDSEVEX1RBU0tMRVQpOwotICAgICAgICBzbmV4dCA9
IENTQ0hFRF9VTklUKHNjaGVkX2lkbGVfdW5pdChzY2hlZF9jcHUpKTsKLSAgICAgICAgc25leHQt
PnByaSA9IENTQ0hFRF9QUklfVFNfQk9PU1Q7Ci0gICAgfQotCiAgICAgLyoKICAgICAgKiBDbGVh
ciBZSUVMRCBmbGFnIGJlZm9yZSBzY2hlZHVsaW5nIG91dAogICAgICAqLwogICAgIGNsZWFyX2Jp
dChDU0NIRURfRkxBR19VTklUX1lJRUxELCAmc2N1cnItPmZsYWdzKTsKIAotICAgIC8qCi0gICAg
ICogU01QIExvYWQgYmFsYW5jZToKLSAgICAgKgotICAgICAqIElmIHRoZSBuZXh0IGhpZ2hlc3Qg
cHJpb3JpdHkgbG9jYWwgcnVubmFibGUgVU5JVCBoYXMgYWxyZWFkeSBlYXRlbgotICAgICAqIHRo
cm91Z2ggaXRzIGNyZWRpdHMsIGxvb2sgb24gb3RoZXIgUENQVXMgdG8gc2VlIGlmIHdlIGhhdmUg
bW9yZQotICAgICAqIHVyZ2VudCB3b3JrLi4uIElmIG5vdCwgY3NjaGVkX2xvYWRfYmFsYW5jZSgp
IHdpbGwgcmV0dXJuIHNuZXh0LCBidXQKLSAgICAgKiBhbHJlYWR5IHJlbW92ZWQgZnJvbSB0aGUg
cnVucS4KLSAgICAgKi8KLSAgICBpZiAoIHNuZXh0LT5wcmkgPiBDU0NIRURfUFJJX1RTX09WRVIg
KQotICAgICAgICBfX3J1bnFfcmVtb3ZlKHNuZXh0KTsKLSAgICBlbHNlCi0gICAgICAgIHNuZXh0
ID0gY3NjaGVkX2xvYWRfYmFsYW5jZShwcnYsIHNjaGVkX2NwdSwgc25leHQsICZtaWdyYXRlZCk7
CisgICAgZG8geworICAgICAgICBzbmV4dCA9IF9fcnVucV9lbGVtKHJ1bnEtPm5leHQpOworCisg
ICAgICAgIC8qIFRhc2tsZXQgd29yayAod2hpY2ggcnVucyBpbiBpZGxlIFVOSVQgY29udGV4dCkg
b3ZlcnJpZGVzIGFsbCBlbHNlLiAqLworICAgICAgICBpZiAoIHRhc2tsZXRfd29ya19zY2hlZHVs
ZWQgKQorICAgICAgICB7CisgICAgICAgICAgICBUUkFDRV8wRChUUkNfQ1NDSEVEX1NDSEVEX1RB
U0tMRVQpOworICAgICAgICAgICAgc25leHQgPSBDU0NIRURfVU5JVChzY2hlZF9pZGxlX3VuaXQo
c2NoZWRfY3B1KSk7CisgICAgICAgICAgICBzbmV4dC0+cHJpID0gQ1NDSEVEX1BSSV9UU19CT09T
VDsKKyAgICAgICAgfQorCisgICAgICAgIC8qCisgICAgICAgICAqIFNNUCBMb2FkIGJhbGFuY2U6
CisgICAgICAgICAqCisgICAgICAgICAqIElmIHRoZSBuZXh0IGhpZ2hlc3QgcHJpb3JpdHkgbG9j
YWwgcnVubmFibGUgVU5JVCBoYXMgYWxyZWFkeSBlYXRlbgorICAgICAgICAgKiB0aHJvdWdoIGl0
cyBjcmVkaXRzLCBsb29rIG9uIG90aGVyIFBDUFVzIHRvIHNlZSBpZiB3ZSBoYXZlIG1vcmUKKyAg
ICAgICAgICogdXJnZW50IHdvcmsuLi4gSWYgbm90LCBjc2NoZWRfbG9hZF9iYWxhbmNlKCkgd2ls
bCByZXR1cm4gc25leHQsIGJ1dAorICAgICAgICAgKiBhbHJlYWR5IHJlbW92ZWQgZnJvbSB0aGUg
cnVucS4KKyAgICAgICAgICovCisgICAgICAgIGlmICggc25leHQtPnByaSA+IENTQ0hFRF9QUklf
VFNfT1ZFUiApCisgICAgICAgICAgICBfX3J1bnFfcmVtb3ZlKHNuZXh0KTsKKyAgICAgICAgZWxz
ZQorICAgICAgICAgICAgc25leHQgPSBjc2NoZWRfbG9hZF9iYWxhbmNlKHBydiwgc2NoZWRfY3B1
LCBzbmV4dCwgJm1pZ3JhdGVkKTsKKworICAgIH0gd2hpbGUgKCAhdW5pdF9ydW5uYWJsZV9zdGF0
ZShzbmV4dC0+dW5pdCkgKTsKIAogICAgIC8qCiAgICAgICogVXBkYXRlIGlkbGVycyBtYXNrIGlm
IG5lY2Vzc2FyeS4gV2hlbiB3ZSdyZSBpZGxpbmcsIG90aGVyIENQVXMKZGlmZiAtLWdpdCBhL3hl
bi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMKaW5k
ZXggODdkMTQyYmJlNC4uMGUyOWU1NmQ1YSAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9j
cmVkaXQyLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMKQEAgLTMyOTEsNyArMzI5
MSw3IEBAIHJ1bnFfY2FuZGlkYXRlKHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJxZCwK
ICAgICAgKiBJbiBmYWN0LCBpdCBtYXkgYmUgdGhlIGNhc2UgdGhhdCBzY3VyciBpcyBhYm91dCB0
byBzcGluLCBhbmQgdGhlcmUncwogICAgICAqIG5vIHBvaW50IGZvcmNpbmcgaXQgdG8gZG8gc28g
dW50aWwgcmF0ZSBsaW1pdGluZyBleHBpcmVzLgogICAgICAqLwotICAgIGlmICggIXlpZWxkICYm
IHBydi0+cmF0ZWxpbWl0X3VzICYmIHVuaXRfcnVubmFibGUoc2N1cnItPnVuaXQpICYmCisgICAg
aWYgKCAheWllbGQgJiYgcHJ2LT5yYXRlbGltaXRfdXMgJiYgdW5pdF9ydW5uYWJsZV9zdGF0ZShz
Y3Vyci0+dW5pdCkgJiYKICAgICAgICAgIChub3cgLSBzY3Vyci0+dW5pdC0+c3RhdGVfZW50cnlf
dGltZSkgPCBNSUNST1NFQ1MocHJ2LT5yYXRlbGltaXRfdXMpICkKICAgICB7CiAgICAgICAgIGlm
ICggdW5saWtlbHkodGJfaW5pdF9kb25lKSApCkBAIC0zMzQ1LDcgKzMzNDUsNyBAQCBydW5xX2Nh
bmRpZGF0ZShzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICpycWQsCiAgICAgICoKICAgICAg
KiBPZiBjb3Vyc2UsIHdlIGFsc28gZGVmYXVsdCB0byBpZGxlIGFsc28gaWYgc2N1cnIgaXMgbm90
IHJ1bm5hYmxlLgogICAgICAqLwotICAgIGlmICggdW5pdF9ydW5uYWJsZShzY3Vyci0+dW5pdCkg
JiYgIXNvZnRfYWZmX3ByZWVtcHQgKQorICAgIGlmICggdW5pdF9ydW5uYWJsZV9zdGF0ZShzY3Vy
ci0+dW5pdCkgJiYgIXNvZnRfYWZmX3ByZWVtcHQgKQogICAgICAgICBzbmV4dCA9IHNjdXJyOwog
ICAgIGVsc2UKICAgICAgICAgc25leHQgPSBjc2NoZWQyX3VuaXQoc2NoZWRfaWRsZV91bml0KGNw
dSkpOwpAQCAtMzQwNSw3ICszNDA1LDggQEAgcnVucV9jYW5kaWRhdGUoc3RydWN0IGNzY2hlZDJf
cnVucXVldWVfZGF0YSAqcnFkLAogICAgICAgICAgKiBzb21lIGJ1ZGdldCwgdGhlbiBjaG9vc2Ug
aXQuCiAgICAgICAgICAqLwogICAgICAgICBpZiAoICh5aWVsZCB8fCBzdmMtPmNyZWRpdCA+IHNu
ZXh0LT5jcmVkaXQpICYmCi0gICAgICAgICAgICAgKCFoYXNfY2FwKHN2YykgfHwgdW5pdF9ncmFi
X2J1ZGdldChzdmMpKSApCisgICAgICAgICAgICAgKCFoYXNfY2FwKHN2YykgfHwgdW5pdF9ncmFi
X2J1ZGdldChzdmMpKSAmJgorICAgICAgICAgICAgIHVuaXRfcnVubmFibGVfc3RhdGUoc3ZjLT51
bml0KSApCiAgICAgICAgICAgICBzbmV4dCA9IHN2YzsKIAogICAgICAgICAvKiBJbiBhbnkgY2Fz
ZSwgaWYgd2UgZ290IHRoaXMgZmFyLCBicmVhay4gKi8KZGlmZiAtLWdpdCBhL3hlbi9jb21tb24v
c2NoZWRfbnVsbC5jIGIveGVuL2NvbW1vbi9zY2hlZF9udWxsLmMKaW5kZXggODBhN2Q0NTkzNS4u
M2RkZTFkY2QwMCAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9udWxsLmMKKysrIGIveGVu
L2NvbW1vbi9zY2hlZF9udWxsLmMKQEAgLTg2NCw3ICs4NjQsOCBAQCBzdGF0aWMgdm9pZCBudWxs
X3NjaGVkdWxlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQg
KnByZXYsCiAgICAgICAgICAgICBjcHVtYXNrX3NldF9jcHUoc2NoZWRfY3B1LCAmcHJ2LT5jcHVz
X2ZyZWUpOwogICAgIH0KIAotICAgIGlmICggdW5saWtlbHkocHJldi0+bmV4dF90YXNrID09IE5V
TEwgfHwgIXVuaXRfcnVubmFibGUocHJldi0+bmV4dF90YXNrKSkgKQorICAgIGlmICggdW5saWtl
bHkocHJldi0+bmV4dF90YXNrID09IE5VTEwgfHwKKyAgICAgICAgICAgICAgICAgICF1bml0X3J1
bm5hYmxlX3N0YXRlKHByZXYtPm5leHRfdGFzaykpICkKICAgICAgICAgcHJldi0+bmV4dF90YXNr
ID0gc2NoZWRfaWRsZV91bml0KHNjaGVkX2NwdSk7CiAKICAgICBOVUxMX1VOSVRfQ0hFQ0socHJl
di0+bmV4dF90YXNrKTsKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfcnQuYyBiL3hlbi9j
b21tb24vc2NoZWRfcnQuYwppbmRleCBjZmQ3ZDMzNGZhLi5mZDg4MmYyY2E0IDEwMDY0NAotLS0g
YS94ZW4vY29tbW9uL3NjaGVkX3J0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCkBAIC0x
MDkyLDEyICsxMDkyLDE4IEBAIHJ0X3NjaGVkdWxlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHNjaGVkX3VuaXQgKmN1cnJ1bml0LAogICAgIGVsc2UKICAgICB7CiAgICAgICAg
IHNuZXh0ID0gcnVucV9waWNrKG9wcywgY3B1bWFza19vZihzY2hlZF9jcHUpKTsKKwogICAgICAg
ICBpZiAoIHNuZXh0ID09IE5VTEwgKQogICAgICAgICAgICAgc25leHQgPSBydF91bml0KHNjaGVk
X2lkbGVfdW5pdChzY2hlZF9jcHUpKTsKKyAgICAgICAgZWxzZSBpZiAoICF1bml0X3J1bm5hYmxl
X3N0YXRlKHNuZXh0LT51bml0KSApCisgICAgICAgIHsKKyAgICAgICAgICAgIHFfcmVtb3ZlKHNu
ZXh0KTsKKyAgICAgICAgICAgIHNuZXh0ID0gcnRfdW5pdChzY2hlZF9pZGxlX3VuaXQoc2NoZWRf
Y3B1KSk7CisgICAgICAgIH0KIAogICAgICAgICAvKiBpZiBzY3VyciBoYXMgaGlnaGVyIHByaW9y
aXR5IGFuZCBidWRnZXQsIHN0aWxsIHBpY2sgc2N1cnIgKi8KICAgICAgICAgaWYgKCAhaXNfaWRs
ZV91bml0KGN1cnJ1bml0KSAmJgotICAgICAgICAgICAgIHVuaXRfcnVubmFibGUoY3VycnVuaXQp
ICYmCisgICAgICAgICAgICAgdW5pdF9ydW5uYWJsZV9zdGF0ZShjdXJydW5pdCkgJiYKICAgICAg
ICAgICAgICBzY3Vyci0+Y3VyX2J1ZGdldCA+IDAgJiYKICAgICAgICAgICAgICAoIGlzX2lkbGVf
dW5pdChzbmV4dC0+dW5pdCkgfHwKICAgICAgICAgICAgICAgIGNvbXBhcmVfdW5pdF9wcmlvcml0
eShzY3Vyciwgc25leHQpID4gMCApICkKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWR1bGUu
YyBiL3hlbi9jb21tb24vc2NoZWR1bGUuYwppbmRleCBmZjY3ZmIzNjMzLi45YzFiMDQ0YjQ5IDEw
MDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkdWxlLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZHVs
ZS5jCkBAIC0yODAsNyArMjgwLDcgQEAgc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3VuaXRfcnVu
c3RhdGVfY2hhbmdlKHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAogICAgIGZvcl9lYWNoX3NjaGVk
X3VuaXRfdmNwdSAoIHVuaXQsIHYgKQogICAgIHsKICAgICAgICAgaWYgKCBydW5uaW5nICkKLSAg
ICAgICAgICAgIHZjcHVfcnVuc3RhdGVfY2hhbmdlKHYsIFJVTlNUQVRFX3J1bm5pbmcsIG5ld19l
bnRyeV90aW1lKTsKKyAgICAgICAgICAgIHZjcHVfcnVuc3RhdGVfY2hhbmdlKHYsIHYtPm5ld19z
dGF0ZSwgbmV3X2VudHJ5X3RpbWUpOwogICAgICAgICBlbHNlCiAgICAgICAgICAgICB2Y3B1X3J1
bnN0YXRlX2NoYW5nZSh2LAogICAgICAgICAgICAgICAgICgodi0+cGF1c2VfZmxhZ3MgJiBWUEZf
YmxvY2tlZCkgPyBSVU5TVEFURV9ibG9ja2VkIDoKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hl
bi9zY2hlZC1pZi5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKaW5kZXggYzY1ZGZhOTQz
Yi4uN2U1NjhhOWQ5ZiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKKysr
IGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKQEAgLTkzLDYgKzkzLDM2IEBAIHN0YXRpYyBp
bmxpbmUgYm9vbCB1bml0X3J1bm5hYmxlKGNvbnN0IHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQog
ICAgIHJldHVybiBmYWxzZTsKIH0KIAorLyoKKyAqIFJldHVybnMgd2hldGhlciBhIHNjaGVkX3Vu
aXQgaXMgcnVubmFibGUgYW5kIHNldHMgbmV3X3N0YXRlIGZvciBlYWNoIG9mIGl0cworICogdmNw
dXMuIEl0IGlzIG1hbmRhdG9yeSB0byBkZXRlcm1pbmUgdGhlIG5ldyBydW5zdGF0ZSBmb3IgYWxs
IHZjcHVzIG9mIGEgdW5pdAorICogd2l0aG91dCBkcm9wcGluZyB0aGUgc2NoZWR1bGUgbG9jayAo
d2hpY2ggaGFwcGVucyB3aGVuIHN5bmNocm9uaXppbmcgdGhlCisgKiBjb250ZXh0IHN3aXRjaCBv
ZiB0aGUgdmNwdXMgb2YgYSB1bml0KSBpbiBvcmRlciB0byBhdm9pZCByYWNlcyB3aXRoIGUuZy4K
KyAqIHZjcHVfc2xlZXAoKS4KKyAqLworc3RhdGljIGlubGluZSBib29sIHVuaXRfcnVubmFibGVf
c3RhdGUoY29uc3Qgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCit7CisgICAgc3RydWN0IHZjcHUg
KnY7CisgICAgYm9vbCBydW5uYWJsZSwgcmV0ID0gZmFsc2U7CisKKyAgICBpZiAoIGlzX2lkbGVf
dW5pdCh1bml0KSApCisgICAgICAgIHJldHVybiB0cnVlOworCisgICAgZm9yX2VhY2hfc2NoZWRf
dW5pdF92Y3B1ICggdW5pdCwgdiApCisgICAgeworICAgICAgICBydW5uYWJsZSA9IHZjcHVfcnVu
bmFibGUodik7CisKKyAgICAgICAgdi0+bmV3X3N0YXRlID0gcnVubmFibGUgPyBSVU5TVEFURV9y
dW5uaW5nCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKHYtPnBhdXNlX2ZsYWdz
ICYgVlBGX2Jsb2NrZWQpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBSVU5T
VEFURV9ibG9ja2VkIDogUlVOU1RBVEVfb2ZmbGluZTsKKworICAgICAgICBpZiAoIHJ1bm5hYmxl
ICkKKyAgICAgICAgICAgIHJldCA9IHRydWU7CisgICAgfQorCisgICAgcmV0dXJuIHJldDsKK30K
Kwogc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3NldF9yZXMoc3RydWN0IHNjaGVkX3VuaXQgKnVu
aXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfcmVzb3Vy
Y2UgKnJlcykKIHsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oIGIveGVuL2lu
Y2x1ZGUveGVuL3NjaGVkLmgKaW5kZXggYzc3MGFiNGFhMC4uMTJmMDBjZDc4ZCAxMDA2NDQKLS0t
IGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgK
QEAgLTE3NCw2ICsxNzQsNyBAQCBzdHJ1Y3QgdmNwdQogICAgICAgICBYRU5fR1VFU1RfSEFORExF
KHZjcHVfcnVuc3RhdGVfaW5mb19jb21wYXRfdCkgY29tcGF0OwogICAgIH0gcnVuc3RhdGVfZ3Vl
c3Q7IC8qIGd1ZXN0IGFkZHJlc3MgKi8KICNlbmRpZgorICAgIHVuc2lnbmVkIGludCAgICAgbmV3
X3N0YXRlOwogCiAgICAgLyogSGFzIHRoZSBGUFUgYmVlbiBpbml0aWFsaXNlZD8gKi8KICAgICBi
b29sICAgICAgICAgICAgIGZwdV9pbml0aWFsaXNlZDsKLS0gCjIuMTYuNAoKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxp
c3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVj
dC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

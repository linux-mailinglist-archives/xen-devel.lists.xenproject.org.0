Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E1A34186285
	for <lists+xen-devel@lfdr.de>; Mon, 16 Mar 2020 03:38:56 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1jDfb3-00054z-Ez; Mon, 16 Mar 2020 02:35:17 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=Dpgy=5B=kernel.org=sashal@srs-us1.protection.inumbo.net>)
 id 1jDfb1-00054Z-O9
 for xen-devel@lists.xenproject.org; Mon, 16 Mar 2020 02:35:15 +0000
X-Inumbo-ID: c4728a6c-672e-11ea-b76c-12813bfff9fa
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id c4728a6c-672e-11ea-b76c-12813bfff9fa;
 Mon, 16 Mar 2020 02:35:15 +0000 (UTC)
Received: from sasha-vm.mshome.net (c-73-47-72-35.hsd1.nh.comcast.net
 [73.47.72.35])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 13967206E9;
 Mon, 16 Mar 2020 02:35:13 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1584326114;
 bh=8utJ4PbiBkJFqLWavO/QYmjVPSaB2McN1fDCS3CNWwg=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=qR56NZ+aAVOb1ywkJI/0LW7mTMLtkhkie/HAS0y/cgLjBSbBu99FWBoGYzAZ2aqkl
 yOPyQ3sStR1O9ZzfINCjMpgCmHOe4Uk3a2E17JEjxWSPCUk0CpWfBHLOR+AwO0jOrv
 47anb2CzZBRwO78oO/ZqygtbYRZg/Yn0tQBAQrSk=
From: Sasha Levin <sashal@kernel.org>
To: linux-kernel@vger.kernel.org,
	stable@vger.kernel.org
Date: Sun, 15 Mar 2020 22:34:50 -0400
Message-Id: <20200316023453.1800-17-sashal@kernel.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20200316023453.1800-1-sashal@kernel.org>
References: <20200316023453.1800-1-sashal@kernel.org>
MIME-Version: 1.0
X-stable: review
X-Patchwork-Hint: Ignore
Subject: [Xen-devel] [PATCH AUTOSEL 4.19 17/20] xenbus: req->body should be
 updated before req->state
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Sasha Levin <sashal@kernel.org>, Dongli Zhang <dongli.zhang@oracle.com>,
 Julien Grall <jgrall@amazon.com>, Boris Ostrovsky <boris.ostrovsky@oracle.com>,
 xen-devel@lists.xenproject.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogRG9uZ2xpIFpoYW5nIDxkb25nbGkuemhhbmdAb3JhY2xlLmNvbT4KClsgVXBzdHJlYW0g
Y29tbWl0IDFiNmE1MWU4NmNjZTM4Y2Y0ZDQ4Y2U5YzI0MjEyMDI4M2FlMmY2MDMgXQoKVGhlIHJl
cS0+Ym9keSBzaG91bGQgYmUgdXBkYXRlZCBiZWZvcmUgcmVxLT5zdGF0ZSBpcyB1cGRhdGVkIGFu
ZCB0aGUKb3JkZXIgc2hvdWxkIGJlIGd1YXJhbnRlZWQgYnkgYSBiYXJyaWVyLgoKT3RoZXJ3aXNl
LCByZWFkX3JlcGx5KCkgbWlnaHQgcmV0dXJuIHJlcS0+Ym9keSA9IE5VTEwuCgpCZWxvdyBpcyBz
YW1wbGUgY2FsbHN0YWNrIHdoZW4gdGhlIGlzc3VlIGlzIHJlcHJvZHVjZWQgb24gcHVycG9zZSBi
eQpyZW9yZGVyaW5nIHRoZSB1cGRhdGVzIG9mIHJlcS0+Ym9keSBhbmQgcmVxLT5zdGF0ZSBhbmQg
YWRkaW5nIGRlbGF5IGluCmNvZGUgYmV0d2VlbiB1cGRhdGVzIG9mIHJlcS0+c3RhdGUgYW5kIHJl
cS0+Ym9keS4KClsgICAyMi4zNTYxMDVdIGdlbmVyYWwgcHJvdGVjdGlvbiBmYXVsdDogMDAwMCBb
IzFdIFNNUCBQVEkKWyAgIDIyLjM2MTE4NV0gQ1BVOiAyIFBJRDogNTIgQ29tbTogeGVud2F0Y2gg
Tm90IHRhaW50ZWQgNS41LjB4ZW4rICM2ClsgICAyMi4zNjY3MjddIEhhcmR3YXJlIG5hbWU6IFhl
biBIVk0gZG9tVSwgQklPUyAuLi4KWyAgIDIyLjM3MjI0NV0gUklQOiAwMDEwOl9wYXJzZV9pbnRl
Z2VyX2ZpeHVwX3JhZGl4KzB4Ni8weDYwCi4uLiAuLi4KWyAgIDIyLjM5MjE2M10gUlNQOiAwMDE4
OmZmZmZiMmQ2NDAyM2ZkZjAgRUZMQUdTOiAwMDAxMDI0NgpbICAgMjIuMzk1OTMzXSBSQVg6IDAw
MDAwMDAwMDAwMDAwMDAgUkJYOiA3NTc0NmU3NTYyNzU1ZjZkIFJDWDogMDAwMDAwMDAwMDAwMDAw
MApbICAgMjIuNDAwODcxXSBSRFg6IDAwMDAwMDAwMDAwMDAwMDAgUlNJOiBmZmZmYjJkNjQwMjNm
ZGZjIFJESTogNzU3NDZlNzU2Mjc1NWY2ZApbICAgMjIuNDA1ODc0XSBSQlA6IDAwMDAwMDAwMDAw
MDAwMDAgUjA4OiAwMDAwMDAwMDAwMDAwMWU4IFIwOTogMDAwMDAwMDAwMGNkY2RjZApbICAgMjIu
NDEwOTQ1XSBSMTA6IGZmZmZiMmQ2NDAyZmZlMDAgUjExOiBmZmZmOWQ5NTM5NWVhZWIwIFIxMjog
ZmZmZjlkOTUzNTkzNTAwMApbICAgMjIuNDE3NjEzXSBSMTM6IGZmZmY5ZDk1MjZkNGEwMDAgUjE0
OiBmZmZmOWQ5NTI2ZjRmMzQwIFIxNTogZmZmZjlkOTUzNzY1NDAwMApbICAgMjIuNDIzNzI2XSBG
UzogIDAwMDAwMDAwMDAwMDAwMDAoMDAwMCkgR1M6ZmZmZjlkOTUzYmM4MDAwMCgwMDAwKSBrbmxH
UzowMDAwMDAwMDAwMDAwMDAwClsgICAyMi40Mjk4OThdIENTOiAgMDAxMCBEUzogMDAwMCBFUzog
MDAwMCBDUjA6IDAwMDAwMDAwODAwNTAwMzMKWyAgIDIyLjQzNDM0Ml0gQ1IyOiAwMDAwMDBjNDIw
NmE5MDAwIENSMzogMDAwMDAwMDFlYTNmYzAwMiBDUjQ6IDAwMDAwMDAwMDAxNjA2ZTAKWyAgIDIy
LjQzOTY0NV0gRFIwOiAwMDAwMDAwMDAwMDAwMDAwIERSMTogMDAwMDAwMDAwMDAwMDAwMCBEUjI6
IDAwMDAwMDAwMDAwMDAwMDAKWyAgIDIyLjQ0NDk0MV0gRFIzOiAwMDAwMDAwMDAwMDAwMDAwIERS
NjogMDAwMDAwMDBmZmZlMGZmMCBEUjc6IDAwMDAwMDAwMDAwMDA0MDAKWyAgIDIyLjQ1MDM0Ml0g
Q2FsbCBUcmFjZToKWyAgIDIyLjQ1MjUwOV0gIHNpbXBsZV9zdHJ0b3VsbCsweDI3LzB4NzAKWyAg
IDIyLjQ1NTU3Ml0gIHhlbmJ1c190cmFuc2FjdGlvbl9zdGFydCsweDMxLzB4NTAKWyAgIDIyLjQ1
OTEwNF0gIG5ldGJhY2tfY2hhbmdlZCsweDc2Yy8weGNjMSBbeGVuX25ldGZyb250XQpbICAgMjIu
NDYzMjc5XSAgPyBmaW5kX3dhdGNoKzB4NDAvMHg0MApbICAgMjIuNDY2MTU2XSAgeGVud2F0Y2hf
dGhyZWFkKzB4YjQvMHgxNTAKWyAgIDIyLjQ2OTMwOV0gID8gd2FpdF93b2tlbisweDgwLzB4ODAK
WyAgIDIyLjQ3MjE5OF0gIGt0aHJlYWQrMHgxMGUvMHgxMzAKWyAgIDIyLjQ3NDkyNV0gID8ga3Ro
cmVhZF9wYXJrKzB4ODAvMHg4MApbICAgMjIuNDc3OTQ2XSAgcmV0X2Zyb21fZm9yaysweDM1LzB4
NDAKWyAgIDIyLjQ4MDk2OF0gTW9kdWxlcyBsaW5rZWQgaW46IHhlbl9rYmRmcm9udCB4ZW5fZmJm
cm9udCgrKSB4ZW5fbmV0ZnJvbnQgeGVuX2Jsa2Zyb250ClsgICAyMi40ODY3ODNdIC0tLVsgZW5k
IHRyYWNlIGE5MjIyMDMwYTc0N2MzZjcgXS0tLQpbICAgMjIuNDkwNDI0XSBSSVA6IDAwMTA6X3Bh
cnNlX2ludGVnZXJfZml4dXBfcmFkaXgrMHg2LzB4NjAKClRoZSB2aXJ0X3JtYigpIGlzIGFkZGVk
IGluIHRoZSAndHJ1ZScgcGF0aCBvZiB0ZXN0X3JlcGx5KCkuIFRoZSAid2hpbGUiCmlzIGNoYW5n
ZWQgdG8gImRvIHdoaWxlIiBzbyB0aGF0IHRlc3RfcmVwbHkoKSBpcyB1c2VkIGFzIGEgcmVhZCBt
ZW1vcnkKYmFycmllci4KClNpZ25lZC1vZmYtYnk6IERvbmdsaSBaaGFuZyA8ZG9uZ2xpLnpoYW5n
QG9yYWNsZS5jb20+Ckxpbms6IGh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL3IvMjAyMDAzMDMyMjE0
MjMuMjE5NjItMS1kb25nbGkuemhhbmdAb3JhY2xlLmNvbQpSZXZpZXdlZC1ieTogSnVsaWVuIEdy
YWxsIDxqZ3JhbGxAYW1hem9uLmNvbT4KU2lnbmVkLW9mZi1ieTogQm9yaXMgT3N0cm92c2t5IDxi
b3Jpcy5vc3Ryb3Zza3lAb3JhY2xlLmNvbT4KU2lnbmVkLW9mZi1ieTogU2FzaGEgTGV2aW4gPHNh
c2hhbEBrZXJuZWwub3JnPgotLS0KIGRyaXZlcnMveGVuL3hlbmJ1cy94ZW5idXNfY29tbXMuYyB8
IDIgKysKIGRyaXZlcnMveGVuL3hlbmJ1cy94ZW5idXNfeHMuYyAgICB8IDkgKysrKysrLS0tCiAy
IGZpbGVzIGNoYW5nZWQsIDggaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3hlbi94ZW5idXMveGVuYnVzX2NvbW1zLmMgYi9kcml2ZXJzL3hlbi94ZW5i
dXMveGVuYnVzX2NvbW1zLmMKaW5kZXggZDIzOWZjM2M1ZTNkZS4uODUyZWQxNjFmYzJhNyAxMDA2
NDQKLS0tIGEvZHJpdmVycy94ZW4veGVuYnVzL3hlbmJ1c19jb21tcy5jCisrKyBiL2RyaXZlcnMv
eGVuL3hlbmJ1cy94ZW5idXNfY29tbXMuYwpAQCAtMzEzLDYgKzMxMyw4IEBAIHN0YXRpYyBpbnQg
cHJvY2Vzc19tc2codm9pZCkKIAkJCXJlcS0+bXNnLnR5cGUgPSBzdGF0ZS5tc2cudHlwZTsKIAkJ
CXJlcS0+bXNnLmxlbiA9IHN0YXRlLm1zZy5sZW47CiAJCQlyZXEtPmJvZHkgPSBzdGF0ZS5ib2R5
OworCQkJLyogd3JpdGUgYm9keSwgdGhlbiB1cGRhdGUgc3RhdGUgKi8KKwkJCXZpcnRfd21iKCk7
CiAJCQlyZXEtPnN0YXRlID0geGJfcmVxX3N0YXRlX2dvdF9yZXBseTsKIAkJCXJlcS0+Y2IocmVx
KTsKIAkJfSBlbHNlCmRpZmYgLS1naXQgYS9kcml2ZXJzL3hlbi94ZW5idXMveGVuYnVzX3hzLmMg
Yi9kcml2ZXJzL3hlbi94ZW5idXMveGVuYnVzX3hzLmMKaW5kZXggZGRjMThkYTYxODM0ZS4uM2Ew
NmViNjk5ZjMzMyAxMDA2NDQKLS0tIGEvZHJpdmVycy94ZW4veGVuYnVzL3hlbmJ1c194cy5jCisr
KyBiL2RyaXZlcnMveGVuL3hlbmJ1cy94ZW5idXNfeHMuYwpAQCAtMTkxLDggKzE5MSwxMSBAQCBz
dGF0aWMgYm9vbCB4ZW5idXNfb2sodm9pZCkKIAogc3RhdGljIGJvb2wgdGVzdF9yZXBseShzdHJ1
Y3QgeGJfcmVxX2RhdGEgKnJlcSkKIHsKLQlpZiAocmVxLT5zdGF0ZSA9PSB4Yl9yZXFfc3RhdGVf
Z290X3JlcGx5IHx8ICF4ZW5idXNfb2soKSkKKwlpZiAocmVxLT5zdGF0ZSA9PSB4Yl9yZXFfc3Rh
dGVfZ290X3JlcGx5IHx8ICF4ZW5idXNfb2soKSkgeworCQkvKiByZWFkIHJlcS0+c3RhdGUgYmVm
b3JlIGFsbCBvdGhlciBmaWVsZHMgKi8KKwkJdmlydF9ybWIoKTsKIAkJcmV0dXJuIHRydWU7CisJ
fQogCiAJLyogTWFrZSBzdXJlIHRvIHJlcmVhZCByZXEtPnN0YXRlIGVhY2ggdGltZS4gKi8KIAli
YXJyaWVyKCk7CkBAIC0yMDIsNyArMjA1LDcgQEAgc3RhdGljIGJvb2wgdGVzdF9yZXBseShzdHJ1
Y3QgeGJfcmVxX2RhdGEgKnJlcSkKIAogc3RhdGljIHZvaWQgKnJlYWRfcmVwbHkoc3RydWN0IHhi
X3JlcV9kYXRhICpyZXEpCiB7Ci0Jd2hpbGUgKHJlcS0+c3RhdGUgIT0geGJfcmVxX3N0YXRlX2dv
dF9yZXBseSkgeworCWRvIHsKIAkJd2FpdF9ldmVudChyZXEtPndxLCB0ZXN0X3JlcGx5KHJlcSkp
OwogCiAJCWlmICgheGVuYnVzX29rKCkpCkBAIC0yMTYsNyArMjE5LDcgQEAgc3RhdGljIHZvaWQg
KnJlYWRfcmVwbHkoc3RydWN0IHhiX3JlcV9kYXRhICpyZXEpCiAJCWlmIChyZXEtPmVycikKIAkJ
CXJldHVybiBFUlJfUFRSKHJlcS0+ZXJyKTsKIAotCX0KKwl9IHdoaWxlIChyZXEtPnN0YXRlICE9
IHhiX3JlcV9zdGF0ZV9nb3RfcmVwbHkpOwogCiAJcmV0dXJuIHJlcS0+Ym9keTsKIH0KLS0gCjIu
MjAuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhl
bi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBz
Oi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 240F539FD57
	for <lists+xen-devel@lfdr.de>; Tue,  8 Jun 2021 19:14:40 +0200 (CEST)
Received: from list by lists.xenproject.org with outflank-mailman.138782.256786 (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1lqfJ3-0003jr-Kb; Tue, 08 Jun 2021 17:14:25 +0000
X-Outflank-Mailman: Message body and most headers restored to incoming version
Received: by outflank-mailman (output) from mailman id 138782.256786; Tue, 08 Jun 2021 17:14:25 +0000
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.92)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1lqfJ3-0003cA-C1; Tue, 08 Jun 2021 17:14:25 +0000
Received: by outflank-mailman (input) for mailman id 138782;
 Tue, 08 Jun 2021 17:14:23 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.92) (envelope-from
 <SRS0=CbVg=LC=xenbits.xen.org=iwj@srs-us1.protection.inumbo.net>)
 id 1lqfAG-0007tU-Pb
 for xen-devel@lists.xen.org; Tue, 08 Jun 2021 17:05:20 +0000
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id d72a1b62-f0df-4bfb-a265-c632ed6c1b57;
 Tue, 08 Jun 2021 17:04:37 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1lqf9R-0004gU-89; Tue, 08 Jun 2021 17:04:29 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.92)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1lqf9R-0004sG-6W; Tue, 08 Jun 2021 17:04:29 +0000
X-BeenThere: xen-devel@lists.xenproject.org
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Errors-To: xen-devel-bounces@lists.xenproject.org
Precedence: list
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>
X-Inumbo-ID: d72a1b62-f0df-4bfb-a265-c632ed6c1b57
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=xen.org;
	s=20200302mail; h=Date:Message-Id:Subject:CC:From:To:MIME-Version:
	Content-Transfer-Encoding:Content-Type;
	bh=SDVFctSv2PMnBZCWe0sMgIhEUf1wCGU8fcv1bKj95EE=; b=AhabBF0EpCQTSyDErdVNqpPU0R
	m0fuCOvQLwx0DgXPRJQAHsszdRCyeUnvuhtv/I/mTl9bN+ziOaiNwKT+S5O+bP1AM+ZMlxZtXZOgp
	rNCVmgh4+eVtFYXcfAmSrCAs5S9fm9+3jjh3H5xYDU5PczLTbe9sFBpx4XK9Tw0Xo45c=;
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.509 (Entity 5.509)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
CC: Xen.org security team <security-team-members@xen.org>
Subject: Xen Security Advisory 373 v2 (CVE-2021-28692) - inappropriate x86
 IOMMU timeout detection / handling
Message-Id: <E1lqf9R-0004sG-6W@xenbits.xenproject.org>
Date: Tue, 08 Jun 2021 17:04:29 +0000

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2021-28692 / XSA-373
                               version 2

         inappropriate x86 IOMMU timeout detection / handling

UPDATES IN VERSION 2
====================

Public release.

ISSUE DESCRIPTION
=================

IOMMUs process commands issued to them in parallel with the operation
of the CPU(s) issuing such commands.  In the current implementation in
Xen, asynchronous notification of the completion of such commands is
not used.  Instead, the issuing CPU spin-waits for the completion of
the most recently issued command(s).  Some of these waiting loops try
to apply a timeout to fail overly-slow commands.  The course of action
upon a perceived timeout actually being detected is inappropriate:
 - on Intel hardware guests which did not originally cause the timeout
   may be marked as crashed,
 - on AMD hardware higher layer callers would not be notified of the
   issue, making them continue as if the IOMMU operation succeeded.

IMPACT
======

A malicious guest may be able to elevate its privileges to that of the
host, cause host or guest Denial of Service (DoS), or cause information
leaks.

VULNERABLE SYSTEMS
==================

All Xen versions from at least 3.2 onwards are vulnerable.  Earlier
versions have not been inspected.

Only x86 systems with in-use IOMMU hardware are vulnerable.  x86 systems
without any IOMMUs in use are not vulnerable.  On Arm systems IOMMU /
SMMU use is not security supported.

Only x86 guests which have physical devices passed through to them can
leverage the vulnerability.

MITIGATION
==========

Not passing through physical devices to untrusted guests will avoid
the vulnerability.

CREDITS
=======

This issue was discovered by Igor Druzhinin and Andrew Cooper of Citrix,
and further issues were uncovered by by Jan Beulich of SUSE while trying
to fix the first issue.

RESOLUTION
==========

Applying the appropriate set of attached patches resolves this issue.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa373/xsa373-?.patch           xen-unstable
xsa373/xsa373-4.15-?.patch      Xen 4.15.x
xsa373/xsa373-4.14-?.patch      Xen 4.14.x
xsa373/xsa373-4.13-?.patch      Xen 4.13.x
xsa373/xsa373-4.12-?.patch      Xen 4.12.x
xsa373/xsa373-4.11-?.patch      Xen 4.11.x

$ sha256sum xsa373* xsa373*/*
2ded01092088735e0d8a0e378a41b772ec0f17ceb7afabc78228670c43407fc2  xsa373.meta
f62df56cd176237521aa2ed4a22b0e893318b85bb0ce3c17bd7fca5282b6105b  xsa373/xsa373-1.patch
9eed9566508e116c4da6c201b36fe7e53e98f2daf96cce8ed0a9ca192d783edc  xsa373/xsa373-2.patch
ffee9d17e40798c053a67707dd13d7a944e4a53de7bcfe3e146eac7871ca2608  xsa373/xsa373-3.patch
c51bea462222c090ae671f14471ece00724348e6c04e5850f9b91d0b1eceaad8  xsa373/xsa373-4.11-1.patch
9a3b331e404a38c72ec154cefd78f1f67db6f25dcc1bd554b37ff50899ea42ff  xsa373/xsa373-4.11-2.patch
dba77bce4e6c88ec43df61e88bd5c8bee6e32c0ff681cbeddc4bceb0ee6c73dd  xsa373/xsa373-4.11-3.patch
b1f14e8885e3004de79c5012a1d9278d7a0c39633c5b73cbfda28679f1722c38  xsa373/xsa373-4.11-4.patch
791bccec1e7ba4429a0bafef5fd5a35a68562cee333d0962c70477172493ef3b  xsa373/xsa373-4.11-5.patch
cc4e1bcef148dbfc94ada92bef4408c5516cff2cf249e43c5595b1dbffbbc1e4  xsa373/xsa373-4.12-1.patch
12ffdac1526d96c4f1b572360a7f1a0371e8a177cf15228b126c1032de4e8930  xsa373/xsa373-4.12-2.patch
619425ba44f449bf7b0f519040ee579adff0d0293a95e9b0f70c943c02ae22fb  xsa373/xsa373-4.12-3.patch
b1f14e8885e3004de79c5012a1d9278d7a0c39633c5b73cbfda28679f1722c38  xsa373/xsa373-4.12-4.patch
96b3dd11d38ca8ca0b2dfe2dfb571045fcda78dbfe416580c9b04c5a8ce5fcef  xsa373/xsa373-4.12-5.patch
4add1d05ad2780904ebc89b4d1a93a8f2757b6e9f45b075afce46392ae406b58  xsa373/xsa373-4.13-1.patch
b064324db709078b8ef479df0c31ff3391a506755bfb0186d7d165592d025357  xsa373/xsa373-4.13-2.patch
6fe47fbba0c9d86f48643182d8a7c64ff70a7c8b290b0e93afe1d43d04bed480  xsa373/xsa373-4.13-3.patch
b1f14e8885e3004de79c5012a1d9278d7a0c39633c5b73cbfda28679f1722c38  xsa373/xsa373-4.13-4.patch
96b3dd11d38ca8ca0b2dfe2dfb571045fcda78dbfe416580c9b04c5a8ce5fcef  xsa373/xsa373-4.13-5.patch
4add1d05ad2780904ebc89b4d1a93a8f2757b6e9f45b075afce46392ae406b58  xsa373/xsa373-4.14-1.patch
8e61b7dda9ea21a830454e629fd23e3379b73fb230bd04107618e45975e117d1  xsa373/xsa373-4.14-2.patch
a5aa80d8e893c268f171a5e429bfef0c553522f860e3e5132b4bd87d3a73c6b7  xsa373/xsa373-4.14-3.patch
25bfd2b821ae2cc867b8e2d480528ebd435da76cfab766e8106573cf8dc6f36c  xsa373/xsa373-4.14-4.patch
162b3f14d15fe5ca2cb659efad6635f3803dde6fa97a6f0f1f7f202d3ea72d94  xsa373/xsa373-4.14-5.patch
4add1d05ad2780904ebc89b4d1a93a8f2757b6e9f45b075afce46392ae406b58  xsa373/xsa373-4.15-1.patch
9eed9566508e116c4da6c201b36fe7e53e98f2daf96cce8ed0a9ca192d783edc  xsa373/xsa373-4.15-2.patch
13642541b056ed47129d8143a919bcc81a73797baedc3bd90afeb33f021e6d31  xsa373/xsa373-4.15-3.patch
b2517a7e92c26a818e94ed5133d5aef6ef1d3a7a98f2f5355f1ad6f30baa3ab9  xsa373/xsa373-4.15-4.patch
3ca056796b93cb07ddb7e1dfda98410162382fc56135eb08bc5ff19137d8c427  xsa373/xsa373-4.15-5.patch
b2517a7e92c26a818e94ed5133d5aef6ef1d3a7a98f2f5355f1ad6f30baa3ab9  xsa373/xsa373-4.patch
0b7bb146330f7fdc7c8c331a618307819073654a13d9fe1d0a8b83ab037ae802  xsa373/xsa373-5.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmC/oxIMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZ7oQH/39iA05B0xCxHjYxZJmwplLhtr/RwNt+3zOgsesg
jaG8KMWRobWsfLWpbQdEuWKLQ5kPcK47KBGdFkadbSgNW6ZKeG6iR+HWC04/9uA6
3jjlhyqcdetfGnRUh/EO+4gLEaWxdWegWLWMBqYYp+f9b9lKDp8vyWj5yfzU1FFF
+YOu4bSRnqbY21hapsy2iupbBJugJF1vCLVfMLxQjba8KOjl4bk6cIxx/WgX3FPI
XIH6T+0MtLioCbv7MFaSlfeWoMNjpcimMA8/dmePS6XBtjGX02ahEYSO66lHKk7T
BsrN4QLibAsb8vMb5KjcjGE8ukhrg3AH5EOE950duWF5heQ=
=fAD/
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa373.meta"
Content-Disposition: attachment; filename="xsa373.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAzNzMsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xNSIsCiAgICAiNC4xNCIsCiAgICAiNC4xMyIs
CiAgICAiNC4xMiIsCiAgICAiNC4xMSIKICBdLAogICJUcmVlcyI6IFsKICAg
ICJ4ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjExIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICJiMWU0NmJjMzY5YmI0OTBiNzIxYzc3ZjE1ZDI1ODNiYmY0
NjYxNTJkIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAz
NzIKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTM3My94c2EzNzMtNC4xMS0/LnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjEyIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICI1OTg0OTA1YjI2MzhkZjg3YTAyNjJkMWVlOTFmMGE2ZTE0
YTg2ZGY2IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAz
NzIKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTM3My94c2EzNzMtNC4xMi0/LnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjEzIjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICIyODQxMzI5Mzg5MDBjZThjM2IxMWJhYmY3MjU1ZjVjNmRi
YjIxNzE2IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAz
NzIKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTM3My94c2EzNzMtNC4xMy0/LnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjE0IjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICIxMGYwYjJkNDkzNzY4NjVkNDk2ODBmMDZjNTJiNDUxZmFi
Y2UzYmI1IiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAz
NzIKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTM3My94c2EzNzMtNC4xNC0/LnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICI0LjE1IjogewogICAg
ICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0
YWJsZVJlZiI6ICIyODBkNDcyZjRmY2EwNzBhMTAzNzdlMzE4ZDkwY2FiZmMy
NTQwODEwIiwKICAgICAgICAgICJQcmVyZXFzIjogWwogICAgICAgICAgICAz
NzIKICAgICAgICAgIF0sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTM3My94c2EzNzMtNC4xNS0/LnBhdGNoIgogICAgICAgICAg
XQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICJtYXN0ZXIiOiB7CiAg
ICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAgICAi
U3RhYmxlUmVmIjogImFhNzdhY2MyODA5OGQwNDk0NWFmOTk4ZjNmYzBkYmQz
NzU5YjViNDEiLAogICAgICAgICAgIlByZXJlcXMiOiBbCiAgICAgICAgICAg
IDM3MgogICAgICAgICAgXSwKICAgICAgICAgICJQYXRjaGVzIjogWwogICAg
ICAgICAgICAieHNhMzczL3hzYTM3My0/LnBhdGNoIgogICAgICAgICAgXQog
ICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-1.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBzaXplIHFpbnZhbCBxdWV1ZSBkeW5hbWljYWxseQoKV2l0aCB0
aGUgcHJlc2VudCBzeW5jaHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xv
dHMgZm9yIGV2ZXJ5Cm9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYg
YW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRoZXJlIGNhbiBiZQpvbmUgc3Vj
aCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gVG8gZW5zdXJl
IHRoYXQgdW5kZXIgYWxsCm5vcm1hbCBjaXJjdW1zdGFuY2VzIGEgc2xvdCBp
cyBhbHdheXMgYXZhaWxhYmxlIHdoZW4gb25lIGlzIHJlcXVlc3RlZCwKc2l6
ZSB0aGUgcXVldWUgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJlciBvZiBw
cmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuaApAQCAtNDUyLDE3ICs0NTIsOSBAQCBzdHJ1Y3QgcWludmFsX2VudHJ5
IHsKICAgICB9cTsKIH07CiAKLS8qIE9yZGVyIG9mIHF1ZXVlIGludmFsaWRh
dGlvbiBwYWdlcyhtYXggaXMgOCkgKi8KLSNkZWZpbmUgUUlOVkFMX1BBR0Vf
T1JERVIgICAyCi0KLSNkZWZpbmUgUUlOVkFMX0FSQ0hfUEFHRV9PUkRFUiAg
KFFJTlZBTF9QQUdFX09SREVSICsgUEFHRV9TSElGVF80SyAtIFBBR0VfU0hJ
RlQpCi0jZGVmaW5lIFFJTlZBTF9BUkNIX1BBR0VfTlIgICAgICggUUlOVkFM
X0FSQ0hfUEFHRV9PUkRFUiA8IDAgPyAgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAxIDogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBRSU5W
QUxfQVJDSF9QQUdFX09SREVSICkKLQogLyogRWFjaCBlbnRyeSBpcyAxNiBi
eXRlcywgc28gMl44IGVudHJpZXMgcGVyIHBhZ2UgKi8KICNkZWZpbmUgUUlO
VkFMX0VOVFJZX09SREVSICAoIFBBR0VfU0hJRlQgLSA0ICkKLSNkZWZpbmUg
UUlOVkFMX0VOVFJZX05SICAgICAoMSA8PCAoUUlOVkFMX1BBR0VfT1JERVIg
KyA4KSkKKyNkZWZpbmUgUUlOVkFMX01BWF9FTlRSWV9OUiAoMXUgPDwgKDcg
KyBRSU5WQUxfRU5UUllfT1JERVIpKQogCiAvKiBTdGF0dXMgZGF0YSBmbGFn
ICovCiAjZGVmaW5lIFFJTlZBTF9TVEFUX0lOSVQgIDAKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMzEsNiArMzEsOSBA
QAogCiAjZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKIAorc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOworc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOworCiBzdGF0
aWMgaW50IF9fbXVzdF9jaGVjayBpbnZhbGlkYXRlX3N5bmMoc3RydWN0IHZ0
ZF9pb21tdSAqaW9tbXUpOwogCiBzdGF0aWMgdm9pZCBwcmludF9xaV9yZWdz
KGNvbnN0IHN0cnVjdCB2dGRfaW9tbXUgKmlvbW11KQpAQCAtNDcsNyArNTAs
NyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IHFpbnZhbF9uZXh0X2luZGV4KHN0
CiAgICAgdGFpbCA+Pj0gUUlOVkFMX0lOREVYX1NISUZUOwogCiAgICAgLyog
KHRhaWwrMSA9PSBoZWFkKSBpbmRpY2F0ZXMgYSBmdWxsIHF1ZXVlLCB3YWl0
IGZvciBIVyAqLwotICAgIHdoaWxlICggKHRhaWwgKyAxKSAlIFFJTlZBTF9F
TlRSWV9OUiA9PQorICAgIHdoaWxlICggKCh0YWlsICsgMSkgJiAocWlfZW50
cnlfbnIgLSAxKSkgPT0KICAgICAgICAgICAgIChkbWFyX3JlYWRsKGlvbW11
LT5yZWcsIERNQVJfSVFIX1JFRykgPj4gUUlOVkFMX0lOREVYX1NISUZUKSAp
CiAgICAgICAgIGNwdV9yZWxheCgpOwogCkBAIC02MCw3ICs2Myw3IEBAIHN0
YXRpYyB2b2lkIHFpbnZhbF91cGRhdGVfcXRhaWwoc3RydWN0IHYKIAogICAg
IC8qIE5lZWQgaG9sZCByZWdpc3RlciBsb2NrIHdoZW4gdXBkYXRlIHRhaWwg
Ki8KICAgICBBU1NFUlQoIHNwaW5faXNfbG9ja2VkKCZpb21tdS0+cmVnaXN0
ZXJfbG9jaykgKTsKLSAgICB2YWwgPSAoaW5kZXggKyAxKSAlIFFJTlZBTF9F
TlRSWV9OUjsKKyAgICB2YWwgPSAoaW5kZXggKyAxKSAmIChxaV9lbnRyeV9u
ciAtIDEpOwogICAgIGRtYXJfd3JpdGVsKGlvbW11LT5yZWcsIERNQVJfSVFU
X1JFRywgdmFsIDw8IFFJTlZBTF9JTkRFWF9TSElGVCk7CiB9CiAKQEAgLTM5
NSw4ICszOTgsMjggQEAgaW50IGVuYWJsZV9xaW52YWwoc3RydWN0IHZ0ZF9p
b21tdSAqaW9tbQogCiAgICAgaWYgKCBpb21tdS0+cWludmFsX21hZGRyID09
IDAgKQogICAgIHsKLSAgICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciA9IGFs
bG9jX3BndGFibGVfbWFkZHIoUUlOVkFMX0FSQ0hfUEFHRV9OUiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW9tbXUtPm5vZGUpOworICAgICAgICBpZiAoICFxaV9lbnRyeV9uciApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgKiBXaXRo
IHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1vZGVsLCB3ZSBuZWVkIHR3byBz
bG90cyBmb3IgZXZlcnkKKyAgICAgICAgICAgICAqIG9wZXJhdGlvbiAodGhl
IG9wZXJhdGlvbiBpdHNlbGYgYW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRo
ZXJlCisgICAgICAgICAgICAgKiBjYW4gYmUgb25lIHN1Y2ggcGFpciBvZiBy
ZXF1ZXN0cyBwZW5kaW5nIHBlciBDUFUuICBPbmUgZXh0cmEKKyAgICAgICAg
ICAgICAqIGVudHJ5IGlzIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25zaWRl
cmVkIGZ1bGwgd2hlbiB0aGVyZSdzCisgICAgICAgICAgICAgKiBvbmx5IG9u
ZSBlbnRyeSBsZWZ0LgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBC
VUlMRF9CVUdfT04oQ09ORklHX05SX0NQVVMgKiAyID49IFFJTlZBTF9NQVhf
RU5UUllfTlIpOworICAgICAgICAgICAgcWlfcGdfb3JkZXIgPSBnZXRfb3Jk
ZXJfZnJvbV9ieXRlcygobnVtX3ByZXNlbnRfY3B1cygpICogMiArIDEpIDw8
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChQQUdFX1NISUZUIC0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFFJTlZBTF9FTlRSWV9PUkRFUikpOwor
ICAgICAgICAgICAgcWlfZW50cnlfbnIgPSAxdSA8PCAocWlfcGdfb3JkZXIg
KyBRSU5WQUxfRU5UUllfT1JERVIpOworCisgICAgICAgICAgICBkcHJpbnRr
KFhFTkxPR19JTkZPIFZURFBSRUZJWCwKKyAgICAgICAgICAgICAgICAgICAg
IlFJOiB1c2luZyAldS1lbnRyeSByaW5nKHMpXG4iLCBxaV9lbnRyeV9ucik7
CisgICAgICAgIH0KKworICAgICAgICBpb21tdS0+cWludmFsX21hZGRyID0K
KyAgICAgICAgICAgIGFsbG9jX3BndGFibGVfbWFkZHIocWlfZW50cnlfbnIg
Pj4gUUlOVkFMX0VOVFJZX09SREVSLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpb21tdS0+bm9kZSk7CiAgICAgICAgIGlmICggaW9tbXUt
PnFpbnZhbF9tYWRkciA9PSAwICkKICAgICAgICAgewogICAgICAgICAgICAg
ZHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgsCkBAIC00MTAsMTUg
KzQzMywxNiBAQCBpbnQgZW5hYmxlX3FpbnZhbChzdHJ1Y3QgdnRkX2lvbW11
ICppb21tCiAKICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPnJlZ2lz
dGVyX2xvY2ssIGZsYWdzKTsKIAotICAgIC8qIFNldHVwIEludmFsaWRhdGlv
biBRdWV1ZSBBZGRyZXNzKElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUKLSAgICAg
KiBhZGRyZXNzIG9mIHRoZSBwYWdlIHdlIGp1c3QgYWxsb2NhdGVkLiAgUVMg
ZmllbGQgYXQKLSAgICAgKiBiaXRzWzI6MF0gdG8gaW5kaWNhdGUgc2l6ZSBv
ZiBxdWV1ZSBpcyBvbmUgNEtCIHBhZ2UuCi0gICAgICogVGhhdCdzIDI1NiBl
bnRyaWVzLiAgUXVldWVkIEhlYWQgKElRSCkgYW5kIFF1ZXVlIFRhaWwgKElR
VCkKLSAgICAgKiByZWdpc3RlcnMgYXJlIGF1dG9tYXRpY2FsbHkgcmVzZXQg
dG8gMCB3aXRoIHdyaXRlCi0gICAgICogdG8gSVFBIHJlZ2lzdGVyLgorICAg
IC8qCisgICAgICogU2V0dXAgSW52YWxpZGF0aW9uIFF1ZXVlIEFkZHJlc3Mg
KElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUgYWRkcmVzcyBvZiB0aGUKKyAgICAg
KiBwYWdlcyB3ZSBqdXN0IGFsbG9jYXRlZC4gIFRoZSBRUyBmaWVsZCBhdCBi
aXRzWzI6MF0gaW5kaWNhdGVzIHRoZSBzaXplCisgICAgICogKHBhZ2Ugb3Jk
ZXIpIG9mIHRoZSBxdWV1ZS4KKyAgICAgKgorICAgICAqIFF1ZXVlZCBIZWFk
IChJUUgpIGFuZCBRdWV1ZSBUYWlsIChJUVQpIHJlZ2lzdGVycyBhcmUgYXV0
b21hdGljYWxseQorICAgICAqIHJlc2V0IHRvIDAgd2l0aCB3cml0ZSB0byBJ
UUEgcmVnaXN0ZXIuCiAgICAgICovCiAgICAgZG1hcl93cml0ZXEoaW9tbXUt
PnJlZywgRE1BUl9JUUFfUkVHLAotICAgICAgICAgICAgICAgIGlvbW11LT5x
aW52YWxfbWFkZHIgfCBRSU5WQUxfUEFHRV9PUkRFUik7CisgICAgICAgICAg
ICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciB8IHFpX3BnX29yZGVyKTsKIAog
ICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIERNQVJfSVFUX1JFRywgMCk7
CiAK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-2.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHNpemUgY29tbWFuZCBidWZmZXIgZHluYW1pY2FsbHkK
CldpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9kZWwsIHdlIG5lZWQg
dHdvIHNsb3RzIGZvciBldmVyeQpvcGVyYXRpb24gKHRoZSBvcGVyYXRpb24g
aXRzZWxmIGFuZCBhIHdhaXQgY29tbWFuZCkuICBUaGVyZSBjYW4gYmUgb25l
CnN1Y2ggcGFpciBvZiBjb21tYW5kcyBwZW5kaW5nIHBlciBDUFUuIFRvIGVu
c3VyZSB0aGF0IHVuZGVyIGFsbCBub3JtYWwKY2lyY3Vtc3RhbmNlcyBhIHNs
b3QgaXMgYWx3YXlzIGF2YWlsYWJsZSB3aGVuIG9uZSBpcyByZXF1ZXN0ZWQs
IHNpemUgdGhlCmNvbW1hbmQgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJl
ciBvZiBwcmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAv
IENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50
IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXUtZGVmcy5oCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdS1kZWZzLmgKQEAgLTIwLDkgKzIwLDYgQEAKICNpZm5k
ZWYgQU1EX0lPTU1VX0RFRlNfSAogI2RlZmluZSBBTURfSU9NTVVfREVGU19I
CiAKLS8qIElPTU1VIENvbW1hbmQgQnVmZmVyIGVudHJpZXM6IGluIHBvd2Vy
IG9mIDIgaW5jcmVtZW50cywgbWluaW11bSBvZiAyNTYgKi8KLSNkZWZpbmUg
SU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VOVFJJRVMJNTEyCi0KIC8qIElP
TU1VIEV2ZW50IExvZyBlbnRyaWVzOiBpbiBwb3dlciBvZiAyIGluY3JlbWVu
dHMsIG1pbmltdW0gb2YgMjU2ICovCiAjZGVmaW5lIElPTU1VX0VWRU5UX0xP
R19ERUZBVUxUX0VOVFJJRVMgICAgIDUxMgogCkBAIC0xNjQsOCArMTYxLDgg
QEAgc3RydWN0IGFtZF9pb21tdV9kdGUgewogI2RlZmluZSBJT01NVV9DTURf
QlVGRkVSX0xFTkdUSF9NQVNLCQkweDBGMDAwMDAwCiAjZGVmaW5lIElPTU1V
X0NNRF9CVUZGRVJfTEVOR1RIX1NISUZUCQkyNAogCi0jZGVmaW5lIElPTU1V
X0NNRF9CVUZGRVJfRU5UUllfU0laRQkJCTE2Ci0jZGVmaW5lIElPTU1VX0NN
RF9CVUZGRVJfUE9XRVJfT0YyX0VOVFJJRVNfUEVSX1BBR0UJOAorI2RlZmlu
ZSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSICAgICAgICAgICAgNAor
I2RlZmluZSBJT01NVV9DTURfQlVGRkVSX01BWF9FTlRSSUVTICAgICAgICAg
ICAgKDF1IDw8IDE1KQogCiAjZGVmaW5lIElPTU1VX0NNRF9PUENPREVfTUFT
SwkJCTB4RjAwMDAwMDAKICNkZWZpbmUgSU9NTVVfQ01EX09QQ09ERV9TSElG
VAkJCTI4Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9jbWQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfY21kLmMKQEAgLTI0LDcgKzI0LDcgQEAgc3RhdGljIGludCBxdWV1ZV9p
b21tdV9jb21tYW5kKHN0cnVjdCBhbQogewogICAgIHVpbnQzMl90IHRhaWws
IGhlYWQ7CiAKLSAgICB0YWlsID0gaW9tbXUtPmNtZF9idWZmZXIudGFpbCAr
IElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRTsKKyAgICB0YWlsID0gaW9t
bXUtPmNtZF9idWZmZXIudGFpbCArIHNpemVvZihjbWRfZW50cnlfdCk7CiAg
ICAgaWYgKCB0YWlsID09IGlvbW11LT5jbWRfYnVmZmVyLnNpemUgKQogICAg
ICAgICB0YWlsID0gMDsKIApAQCAtMzMsNyArMzMsNyBAQCBzdGF0aWMgaW50
IHF1ZXVlX2lvbW11X2NvbW1hbmQoc3RydWN0IGFtCiAgICAgaWYgKCBoZWFk
ICE9IHRhaWwgKQogICAgIHsKICAgICAgICAgbWVtY3B5KGlvbW11LT5jbWRf
YnVmZmVyLmJ1ZmZlciArIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwsCi0gICAg
ICAgICAgICAgICBjbWQsIElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRSk7
CisgICAgICAgICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwog
CiAgICAgICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWlsOwogICAg
ICAgICByZXR1cm4gMTsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfaW5pdC5jCkBAIC0xMTgsNyArMTE4LDcgQEAgc3RhdGlj
IHZvaWQgcmVnaXN0ZXJfaW9tbXVfY21kX2J1ZmZlcl9pbgogICAgIHdyaXRl
bChlbnRyeSwgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NNRF9CVUZGRVJf
QkFTRV9MT1dfT0ZGU0VUKTsKIAogICAgIHBvd2VyX29mMl9lbnRyaWVzID0g
Z2V0X29yZGVyX2Zyb21fYnl0ZXMoaW9tbXUtPmNtZF9idWZmZXIuc2l6ZSkg
KwotICAgICAgICBJT01NVV9DTURfQlVGRkVSX1BPV0VSX09GMl9FTlRSSUVT
X1BFUl9QQUdFOworICAgICAgICBQQUdFX1NISUZUIC0gSU9NTVVfQ01EX0JV
RkZFUl9FTlRSWV9PUkRFUjsKIAogICAgIGVudHJ5ID0gMDsKICAgICBpb21t
dV9zZXRfYWRkcl9oaV90b19yZWcoJmVudHJ5LCBhZGRyX2hpKTsKQEAgLTEw
MTgsOSArMTAxOCwzMSBAQCBzdGF0aWMgdm9pZCAqX19pbml0IGFsbG9jYXRl
X3JpbmdfYnVmZmVyCiBzdGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0ZV9j
bWRfYnVmZmVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQogewogICAgIC8q
IGFsbG9jYXRlICdjb21tYW5kIGJ1ZmZlcicgaW4gcG93ZXIgb2YgMiBpbmNy
ZW1lbnRzIG9mIDRLICovCisgICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3Jl
YWRfbW9zdGx5IG5yX2VudHM7CisKKyAgICBpZiAoICFucl9lbnRzICkKKyAg
ICB7CisgICAgICAgIHVuc2lnbmVkIGludCBvcmRlcjsKKworICAgICAgICAv
KgorICAgICAgICAgKiBXaXRoIHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1v
ZGVsLCB3ZSBuZWVkIHR3byBzbG90cyBmb3IgZXZlcnkKKyAgICAgICAgICog
b3BlcmF0aW9uICh0aGUgb3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0IGNv
bW1hbmQpLiAgVGhlcmUgY2FuIGJlCisgICAgICAgICAqIG9uZSBzdWNoIHBh
aXIgb2YgcmVxdWVzdHMgcGVuZGluZyBwZXIgQ1BVLiAgT25lIGV4dHJhIGVu
dHJ5IGlzCisgICAgICAgICAqIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25z
aWRlcmVkIGZ1bGwgd2hlbiB0aGVyZSdzIG9ubHkgb25lIGVudHJ5CisgICAg
ICAgICAqIGxlZnQuCisgICAgICAgICAqLworICAgICAgICBCVUlMRF9CVUdf
T04oQ09ORklHX05SX0NQVVMgKiAyID49IElPTU1VX0NNRF9CVUZGRVJfTUFY
X0VOVFJJRVMpOworICAgICAgICBvcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5
dGVzKChudW1fcHJlc2VudF9jcHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9DTURfQlVGRkVS
X0VOVFJZX09SREVSKTsKKyAgICAgICAgbnJfZW50cyA9IDF1IDw8IChvcmRl
ciArIFBBR0VfU0hJRlQgLSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVS
KTsKKworICAgICAgICBBTURfSU9NTVVfREVCVUcoInVzaW5nICV1LWVudHJ5
IGNtZCByaW5nKHMpXG4iLCBucl9lbnRzKTsKKyAgICB9CisKKyAgICBCVUlM
RF9CVUdfT04oc2l6ZW9mKGNtZF9lbnRyeV90KSAhPSAoMXUgPDwgSU9NTVVf
Q01EX0JVRkZFUl9FTlRSWV9PUkRFUikpOworCiAgICAgcmV0dXJuIGFsbG9j
YXRlX3JpbmdfYnVmZmVyKCZpb21tdS0+Y21kX2J1ZmZlciwgc2l6ZW9mKGNt
ZF9lbnRyeV90KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VOVFJJRVMsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICJDb21tYW5kIEJ1ZmZlciIsIGZhbHNl
KTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJfZW50cywg
IkNvbW1hbmQgQnVmZmVyIiwgZmFsc2UpOwogfQogCiBzdGF0aWMgdm9pZCAq
IF9faW5pdCBhbGxvY2F0ZV9ldmVudF9sb2coc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUpCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-3.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBlbGltaW5hdGUgZmx1c2ggcmVsYXRlZCB0aW1lb3V0cwoKTGVh
dmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24gcGVuZGluZyB3aGVuIGl0
IGFwcGVhcnMgdG8gdGFrZSB0b28KbG9uZyBpcyBwcm9ibGVtYXRpYzogSWYg
ZS5nLiBhIFFJIGNvbW1hbmQgY29tcGxldGVkIGxhdGVyLCB0aGUgd3JpdGUg
dG8KdGhlICJwb2xsIHNsb3QiIG1heSBpbnN0ZWFkIGJlIHVuZGVyc3Rvb2Qg
dG8gc2lnbmFsIGEgc3Vic2VxdWVudGx5CnN0YXJ0ZWQgY29tbWFuZCdzIGNv
bXBsZXRpb24uIEFsc28gb3VyIGFjY291bnRpbmcgb2YgdGhlIHRpbWVvdXQg
cGVyaW9kCndhcyBhY3R1YWxseSB3cm9uZzogV2UgaW5jbHVkZWQgdGhlIHRp
bWUgaXQgdG9vayBmb3IgdGhlIGNvbW1hbmQgdG8KYWN0dWFsbHkgbWFrZSBp
dCB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLCB3aGljaCBjb3VsZCBiZSBo
ZWF2aWx5CmFmZmVjdGVkIGJ5IGd1ZXN0cyBvdGhlciB0aGFuIHRoZSBvbmUg
Zm9yIHdoaWNoIHRoZSBmbHVzaCBpcyBiZWluZwpwZXJmb3JtZWQuCgpEbyBh
d2F5IHdpdGggYWxsIHRpbWVvdXQgZGV0ZWN0aW9uIG9uIGFsbCBmbHVzaCBy
ZWxhdGVkIGNvZGUgcGF0aHMuCkxvZyBleGNlc3NpdmVseSBsb25nIHByb2Nl
c3NpbmcgdGltZXMgKHdpdGggYSBwcm9ncmVzc2l2ZSB0aHJlc2hvbGQpIHRv
CmhhdmUgc29tZSBpbmRpY2F0aW9uIG9mIHByb2JsZW1zIGluIHRoaXMgYXJl
YS4KCkFkZGl0aW9uYWxseSBsb2cgKG9uY2UpIGlmIHFpbnZhbF9uZXh0X2lu
ZGV4KCkgZGlkbid0IGltbWVkaWF0ZWx5IGZpbmQKYW4gYXZhaWxhYmxlIHNs
b3QuIFRvZ2V0aGVyIHdpdGggdGhlIGVhcmxpZXIgY2hhbmdlIHNpemluZyB0
aGUgcXVldWUocykKZHluYW1pY2FsbHksIHdlIHNob3VsZCBub3cgaGF2ZSBh
IGd1YXJhbnRlZSB0aGF0IHdpdGggb3VyIGZ1bGx5CnN5bmNocm9ub3VzIG1v
ZGVsIGFueSBkZW1hbmQgZm9yIHNsb3RzIGNhbiBhY3R1YWxseSBiZSBzYXRp
c2ZpZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4
NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5v
cmc+Ci0tLQpUQkQ6IEluIHF1ZXVlX2ludmFsaWRhdGVfd2FpdCgpIHdlIGhh
dmUgdGhlIG9wdGlvbiBvZiBwcm9jZXNzaW5nCiAgICAgc29mdGlycXMgZXZl
cnkgb25jZSBpbiBhIHdoaWxlLCBhcyB0aGVyZSBJUlFzIGFyZW4ndCBvZmYg
d2hpbGUKICAgICBzcGlubmluZy4gVGhpcyB3b3VsZCBrZWVwIHRoZSB3YXRj
aGRvZyBoYXBweS4gSSdtIG5vdCBzdXJlIHRob3VnaAogICAgIHdoZXRoZXIg
d2UgYXJlbid0IGJldHRlciBvZmYgaWYgaXQgYWN0dWFsbHkgdHJpZ2dlcmVk
IGluIGNhc2Ugd2UKICAgICBzcGluIGZvciBhIGxvbmcgdGltZS4KCi0tLSBh
L3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmgKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL2RtYXIuaApAQCAtMTI3LDYgKzEy
NywzNCBAQCBkbyB7CiAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAogfSB3aGlsZSAo
MCkKIAorI2RlZmluZSBJT01NVV9GTFVTSF9XQUlUKHdoYXQsIGlvbW11LCBv
ZmZzZXQsIG9wLCBjb25kLCBzdHMpICAgICAgIFwKK2RvIHsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9z
dGx5IHRocmVzaG9sZCA9IDE7ICAgICAgICAgICAgICAgXAorICAgIHNfdGlt
ZV90IHN0YXJ0ID0gTk9XKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICBzX3RpbWVfdCB0aW1lb3V0ID0gc3RhcnQg
KyBETUFSX09QRVJBVElPTl9USU1FT1VUICogdGhyZXNob2xkOyBcCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIGZvciAoIDsgOyApICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIHN0cyA9IG9wKGlv
bW11LT5yZWcsIG9mZnNldCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICBpZiAoIGNvbmQgKSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgIGJy
ZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgICAgIGlmICggdGltZW91dCAmJiBOT1coKSA+IHRp
bWVvdXQgKSAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgICAgIHRocmVzaG9sZCB8PSB0aHJl
c2hvbGQgPDwgMTsgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklYICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICIgSU9N
TVUjJXU6ICVzIGZsdXNoIHRha2luZyB0b28gbG9uZ1xuIiwgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIHdoYXQpOyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICB0aW1lb3V0
ID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgY3B1X3Jl
bGF4KCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICBpZiAoICF0aW1lb3V0ICkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVggICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgIiBJT01NVSMl
dTogJXMgZmx1c2ggdG9vayAlbHVtc1xuIiwgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgIGlvbW11LT5pbmRleCwgd2hhdCwgKE5PVygpIC0g
c3RhcnQpIC8gMTAwMDAwMDApOyAgICBcCit9IHdoaWxlICggZmFsc2UgKQor
CiBpbnQgdnRkX2h3X2NoZWNrKHZvaWQpOwogdm9pZCBkaXNhYmxlX3Btcihz
dHJ1Y3QgdnRkX2lvbW11ICppb21tdSk7CiBpbnQgaXNfaWdkX2RyaGQoc3Ry
dWN0IGFjcGlfZHJoZF91bml0ICpkcmhkKTsKLS0tIGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvdnRkL2lvbW11LmMKQEAgLTM3Myw4ICszNzMsOCBAQCBzdGF0
aWMgdm9pZCBpb21tdV9mbHVzaF93cml0ZV9idWZmZXIoc3RyCiAgICAgZG1h
cl93cml0ZWwoaW9tbXUtPnJlZywgRE1BUl9HQ01EX1JFRywgdmFsIHwgRE1B
X0dDTURfV0JGKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBoYXJkd2FyZSBjb21w
bGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9tbXUsIERNQVJfR1NU
U19SRUcsIGRtYXJfcmVhZGwsCi0gICAgICAgICAgICAgICAgICAhKHZhbCAm
IERNQV9HU1RTX1dCRlMpLCB2YWwpOworICAgIElPTU1VX0ZMVVNIX1dBSVQo
IndyaXRlIGJ1ZmZlciIsIGlvbW11LCBETUFSX0dTVFNfUkVHLCBkbWFyX3Jl
YWRsLAorICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBETUFfR1NUU19X
QkZTKSwgdmFsKTsKIAogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlv
bW11LT5yZWdpc3Rlcl9sb2NrLCBmbGFncyk7CiB9CkBAIC00MjMsOCArNDIz
LDggQEAgaW50IHZ0ZF9mbHVzaF9jb250ZXh0X3JlZyhzdHJ1Y3QgdnRkX2lv
bQogICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIERNQVJfQ0NNRF9SRUcs
IHZhbCk7CiAKICAgICAvKiBNYWtlIHN1cmUgaGFyZHdhcmUgY29tcGxldGUg
aXQgKi8KLSAgICBJT01NVV9XQUlUX09QKGlvbW11LCBETUFSX0NDTURfUkVH
LCBkbWFyX3JlYWRxLAotICAgICAgICAgICAgICAgICAgISh2YWwgJiBETUFf
Q0NNRF9JQ0MpLCB2YWwpOworICAgIElPTU1VX0ZMVVNIX1dBSVQoImNvbnRl
eHQiLCBpb21tdSwgRE1BUl9DQ01EX1JFRywgZG1hcl9yZWFkcSwKKyAgICAg
ICAgICAgICAgICAgICAgICEodmFsICYgRE1BX0NDTURfSUNDKSwgdmFsKTsK
IAogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11LT5yZWdpc3Rl
cl9sb2NrLCBmbGFncyk7CiAgICAgLyogZmx1c2ggY29udGV4dCBlbnRyeSB3
aWxsIGltcGxpY2l0bHkgZmx1c2ggd3JpdGUgYnVmZmVyICovCkBAIC01MDEs
OCArNTAxLDggQEAgaW50IHZ0ZF9mbHVzaF9pb3RsYl9yZWcoc3RydWN0IHZ0
ZF9pb21tdQogICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIHRsYl9vZmZz
ZXQgKyA4LCB2YWwpOwogCiAgICAgLyogTWFrZSBzdXJlIGhhcmR3YXJlIGNv
bXBsZXRlIGl0ICovCi0gICAgSU9NTVVfV0FJVF9PUChpb21tdSwgKHRsYl9v
ZmZzZXQgKyA4KSwgZG1hcl9yZWFkcSwKLSAgICAgICAgICAgICAgICAgICEo
dmFsICYgRE1BX1RMQl9JVlQpLCB2YWwpOworICAgIElPTU1VX0ZMVVNIX1dB
SVQoImlvdGxiIiwgaW9tbXUsICh0bGJfb2Zmc2V0ICsgOCksIGRtYXJfcmVh
ZHEsCisgICAgICAgICAgICAgICAgICAgICAhKHZhbCAmIERNQV9UTEJfSVZU
KSwgdmFsKTsKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21tdS0+
cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogCiAgICAgLyogY2hlY2sgSU9UTEIg
aW52YWxpZGF0aW9uIGdyYW51bGFyaXR5ICovCi0tLSBhL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYworKysgYi94ZW4vZHJpdmVycy9w
YXNzdGhyb3VnaC92dGQvcWludmFsLmMKQEAgLTI5LDggKzI5LDYgQEAKICNp
bmNsdWRlICJleHRlcm4uaCIKICNpbmNsdWRlICIuLi9hdHMuaCIKIAotI2Rl
ZmluZSBWVERfUUlfVElNRU9VVAkxCi0KIHN0YXRpYyB1bnNpZ25lZCBpbnQg
X19yZWFkX21vc3RseSBxaV9wZ19vcmRlcjsKIHN0YXRpYyB1bnNpZ25lZCBp
bnQgX19yZWFkX21vc3RseSBxaV9lbnRyeV9ucjsKIApAQCAtNTIsNyArNTAs
MTEgQEAgc3RhdGljIHVuc2lnbmVkIGludCBxaW52YWxfbmV4dF9pbmRleChz
dAogICAgIC8qICh0YWlsKzEgPT0gaGVhZCkgaW5kaWNhdGVzIGEgZnVsbCBx
dWV1ZSwgd2FpdCBmb3IgSFcgKi8KICAgICB3aGlsZSAoICgodGFpbCArIDEp
ICYgKHFpX2VudHJ5X25yIC0gMSkpID09CiAgICAgICAgICAgICAoZG1hcl9y
ZWFkbChpb21tdS0+cmVnLCBETUFSX0lRSF9SRUcpID4+IFFJTlZBTF9JTkRF
WF9TSElGVCkgKQorICAgIHsKKyAgICAgICAgcHJpbnRrX29uY2UoWEVOTE9H
X0VSUiBWVERQUkVGSVggIiBJT01NVSMldTogbm8gUUkgc2xvdCBhdmFpbGFi
bGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRleCk7CiAg
ICAgICAgIGNwdV9yZWxheCgpOworICAgIH0KIAogICAgIHJldHVybiB0YWls
OwogfQpAQCAtMTcyLDIzICsxNzQsMzIgQEAgc3RhdGljIGludCBfX211c3Rf
Y2hlY2sgcXVldWVfaW52YWxpZGF0ZQogICAgIC8qIE5vdyB3ZSBkb24ndCBz
dXBwb3J0IGludGVycnVwdCBtZXRob2QgKi8KICAgICBpZiAoIHN3ICkKICAg
ICB7Ci0gICAgICAgIHNfdGltZV90IHRpbWVvdXQ7Ci0KLSAgICAgICAgLyog
SW4gY2FzZSBhbGwgd2FpdCBkZXNjcmlwdG9yIHdyaXRlcyB0byBzYW1lIGFk
ZHIgd2l0aCBzYW1lIGRhdGEgKi8KLSAgICAgICAgdGltZW91dCA9IE5PVygp
ICsgTUlMTElTRUNTKGZsdXNoX2Rldl9pb3RsYiA/Ci0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpb21tdV9kZXZfaW90bGJfdGltZW91
dCA6IFZURF9RSV9USU1FT1VUKTsKKyAgICAgICAgc3RhdGljIHVuc2lnbmVk
IGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7CisgICAgICAgIHNf
dGltZV90IHN0YXJ0ID0gTk9XKCk7CisgICAgICAgIHNfdGltZV90IHRpbWVv
dXQgPSBzdGFydCArIChmbHVzaF9kZXZfaW90bGIKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgID8gaW9tbXVfZGV2X2lvdGxiX3RpbWVv
dXQKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMTAw
KSAqIE1JTExJU0VDUyh0aHJlc2hvbGQpOwogCiAgICAgICAgIHdoaWxlICgg
QUNDRVNTX09OQ0UoKnRoaXNfcG9sbF9zbG90KSAhPSBRSU5WQUxfU1RBVF9E
T05FICkKICAgICAgICAgewotICAgICAgICAgICAgaWYgKCBOT1coKSA+IHRp
bWVvdXQgKQorICAgICAgICAgICAgaWYgKCB0aW1lb3V0ICYmIE5PVygpID4g
dGltZW91dCApCiAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgcHJp
bnRfcWlfcmVncyhpb21tdSk7CisgICAgICAgICAgICAgICAgdGhyZXNob2xk
IHw9IHRocmVzaG9sZCA8PCAxOwogICAgICAgICAgICAgICAgIHByaW50ayhY
RU5MT0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAgICAgICAgICAgICAg
ICAgIiBRdWV1ZSBpbnZhbGlkYXRlIHdhaXQgZGVzY3JpcHRvciB0aW1lZCBv
dXRcbiIpOwotICAgICAgICAgICAgICAgIHJldHVybiAtRVRJTUVET1VUOwor
ICAgICAgICAgICAgICAgICAgICAgICAiIElPTU1VIyV1OiBRSSVzIHdhaXQg
ZGVzY3JpcHRvciB0YWtpbmcgdG9vIGxvbmdcbiIsCisgICAgICAgICAgICAg
ICAgICAgICAgIGlvbW11LT5pbmRleCwgZmx1c2hfZGV2X2lvdGxiID8gIiBk
ZXYiIDogIiIpOworICAgICAgICAgICAgICAgIHByaW50X3FpX3JlZ3MoaW9t
bXUpOworICAgICAgICAgICAgICAgIHRpbWVvdXQgPSAwOwogICAgICAgICAg
ICAgfQogICAgICAgICAgICAgY3B1X3JlbGF4KCk7CiAgICAgICAgIH0KKwor
ICAgICAgICBpZiAoICF0aW1lb3V0ICkKKyAgICAgICAgICAgIHByaW50ayhY
RU5MT0dfV0FSTklORyBWVERQUkVGSVgKKyAgICAgICAgICAgICAgICAgICAi
IElPTU1VIyV1OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0b29rICVsdW1zXG4i
LAorICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRleCwgZmx1c2hfZGV2
X2lvdGxiID8gIiBkZXYiIDogIiIsCisgICAgICAgICAgICAgICAgICAgKE5P
VygpIC0gc3RhcnQpIC8gMTAwMDAwMDApOworCiAgICAgICAgIHJldHVybiAw
OwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.11-1.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBzaXplIHFpbnZhbCBxdWV1ZSBkeW5hbWljYWxseQoKV2l0aCB0
aGUgcHJlc2VudCBzeW5jaHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xv
dHMgZm9yIGV2ZXJ5Cm9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYg
YW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRoZXJlIGNhbiBiZQpvbmUgc3Vj
aCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gVG8gZW5zdXJl
IHRoYXQgdW5kZXIgYWxsCm5vcm1hbCBjaXJjdW1zdGFuY2VzIGEgc2xvdCBp
cyBhbHdheXMgYXZhaWxhYmxlIHdoZW4gb25lIGlzIHJlcXVlc3RlZCwKc2l6
ZSB0aGUgcXVldWUgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJlciBvZiBw
cmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuaApAQCAtNDQ3LDE3ICs0NDcsOSBAQCBzdHJ1Y3QgcWludmFsX2VudHJ5
IHsKICAgICB9cTsKIH07CiAKLS8qIE9yZGVyIG9mIHF1ZXVlIGludmFsaWRh
dGlvbiBwYWdlcyhtYXggaXMgOCkgKi8KLSNkZWZpbmUgUUlOVkFMX1BBR0Vf
T1JERVIgICAyCi0KLSNkZWZpbmUgUUlOVkFMX0FSQ0hfUEFHRV9PUkRFUiAg
KFFJTlZBTF9QQUdFX09SREVSICsgUEFHRV9TSElGVF80SyAtIFBBR0VfU0hJ
RlQpCi0jZGVmaW5lIFFJTlZBTF9BUkNIX1BBR0VfTlIgICAgICggUUlOVkFM
X0FSQ0hfUEFHRV9PUkRFUiA8IDAgPyAgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAxIDogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBRSU5W
QUxfQVJDSF9QQUdFX09SREVSICkKLQogLyogRWFjaCBlbnRyeSBpcyAxNiBi
eXRlcywgc28gMl44IGVudHJpZXMgcGVyIHBhZ2UgKi8KICNkZWZpbmUgUUlO
VkFMX0VOVFJZX09SREVSICAoIFBBR0VfU0hJRlQgLSA0ICkKLSNkZWZpbmUg
UUlOVkFMX0VOVFJZX05SICAgICAoMSA8PCAoUUlOVkFMX1BBR0VfT1JERVIg
KyA4KSkKKyNkZWZpbmUgUUlOVkFMX01BWF9FTlRSWV9OUiAoMXUgPDwgKDcg
KyBRSU5WQUxfRU5UUllfT1JERVIpKQogCiAvKiBTdGF0dXMgZGF0YSBmbGFn
ICovCiAjZGVmaW5lIFFJTlZBTF9TVEFUX0lOSVQgIDAKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMzEsNiArMzEsOSBA
QAogCiAjZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKIAorc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOworc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOworCiBzdGF0
aWMgaW50IF9fbXVzdF9jaGVjayBpbnZhbGlkYXRlX3N5bmMoc3RydWN0IGlv
bW11ICppb21tdSk7CiAKIHN0YXRpYyB2b2lkIHByaW50X3FpX3JlZ3Moc3Ry
dWN0IGlvbW11ICppb21tdSkKQEAgLTU1LDcgKzU4LDcgQEAgc3RhdGljIHVu
c2lnbmVkIGludCBxaW52YWxfbmV4dF9pbmRleChzdAogICAgIHRhaWwgPj49
IFFJTlZBTF9JTkRFWF9TSElGVDsKIAogICAgIC8qICh0YWlsKzEgPT0gaGVh
ZCkgaW5kaWNhdGVzIGEgZnVsbCBxdWV1ZSwgd2FpdCBmb3IgSFcgKi8KLSAg
ICB3aGlsZSAoICggdGFpbCArIDEgKSAlIFFJTlZBTF9FTlRSWV9OUiA9PQor
ICAgIHdoaWxlICggKCh0YWlsICsgMSkgJiAocWlfZW50cnlfbnIgLSAxKSkg
PT0KICAgICAgICAgICAgICggZG1hcl9yZWFkcShpb21tdS0+cmVnLCBETUFS
X0lRSF9SRUcpID4+IFFJTlZBTF9JTkRFWF9TSElGVCApICkKICAgICAgICAg
Y3B1X3JlbGF4KCk7CiAKQEAgLTY4LDcgKzcxLDcgQEAgc3RhdGljIHZvaWQg
cWludmFsX3VwZGF0ZV9xdGFpbChzdHJ1Y3QgaQogCiAgICAgLyogTmVlZCBo
b2xkIHJlZ2lzdGVyIGxvY2sgd2hlbiB1cGRhdGUgdGFpbCAqLwogICAgIEFT
U0VSVCggc3Bpbl9pc19sb2NrZWQoJmlvbW11LT5yZWdpc3Rlcl9sb2NrKSAp
OwotICAgIHZhbCA9IChpbmRleCArIDEpICUgUUlOVkFMX0VOVFJZX05SOwor
ICAgIHZhbCA9IChpbmRleCArIDEpICYgKHFpX2VudHJ5X25yIC0gMSk7CiAg
ICAgZG1hcl93cml0ZXEoaW9tbXUtPnJlZywgRE1BUl9JUVRfUkVHLCAodmFs
IDw8IFFJTlZBTF9JTkRFWF9TSElGVCkpOwogfQogCkBAIC00MTcsNyArNDIw
LDI3IEBAIGludCBlbmFibGVfcWludmFsKHN0cnVjdCBpb21tdSAqaW9tbXUp
CiAgICAgaWYgKCBxaV9jdHJsLT5xaW52YWxfbWFkZHIgPT0gMCApCiAgICAg
ewogICAgICAgICBkcmhkID0gaW9tbXVfdG9fZHJoZChpb21tdSk7Ci0gICAg
ICAgIHFpX2N0cmwtPnFpbnZhbF9tYWRkciA9IGFsbG9jX3BndGFibGVfbWFk
ZHIoZHJoZCwgUUlOVkFMX0FSQ0hfUEFHRV9OUik7CisgICAgICAgIGlmICgg
IXFpX2VudHJ5X25yICkKKyAgICAgICAgeworICAgICAgICAgICAgLyoKKyAg
ICAgICAgICAgICAqIFdpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9k
ZWwsIHdlIG5lZWQgdHdvIHNsb3RzIGZvciBldmVyeQorICAgICAgICAgICAg
ICogb3BlcmF0aW9uICh0aGUgb3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0
IGRlc2NyaXB0b3IpLiAgVGhlcmUKKyAgICAgICAgICAgICAqIGNhbiBiZSBv
bmUgc3VjaCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gIE9u
ZSBleHRyYQorICAgICAgICAgICAgICogZW50cnkgaXMgbmVlZGVkIGFzIHRo
ZSByaW5nIGlzIGNvbnNpZGVyZWQgZnVsbCB3aGVuIHRoZXJlJ3MKKyAgICAg
ICAgICAgICAqIG9ubHkgb25lIGVudHJ5IGxlZnQuCisgICAgICAgICAgICAg
Ki8KKyAgICAgICAgICAgIEJVSUxEX0JVR19PTihDT05GSUdfTlJfQ1BVUyAq
IDIgPj0gUUlOVkFMX01BWF9FTlRSWV9OUik7CisgICAgICAgICAgICBxaV9w
Z19vcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5dGVzKChudW1fcHJlc2VudF9j
cHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKFBBR0VfU0hJRlQgLQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUUlOVkFM
X0VOVFJZX09SREVSKSk7CisgICAgICAgICAgICBxaV9lbnRyeV9uciA9IDF1
IDw8IChxaV9wZ19vcmRlciArIFFJTlZBTF9FTlRSWV9PUkRFUik7CisKKyAg
ICAgICAgICAgIGRwcmludGsoWEVOTE9HX0lORk8gVlREUFJFRklYLAorICAg
ICAgICAgICAgICAgICAgICAiUUk6IHVzaW5nICV1LWVudHJ5IHJpbmcocylc
biIsIHFpX2VudHJ5X25yKTsKKyAgICAgICAgfQorCisgICAgICAgIHFpX2N0
cmwtPnFpbnZhbF9tYWRkciA9CisgICAgICAgICAgICBhbGxvY19wZ3RhYmxl
X21hZGRyKGRyaGQsIHFpX2VudHJ5X25yID4+IFFJTlZBTF9FTlRSWV9PUkRF
Uik7CiAgICAgICAgIGlmICggcWlfY3RybC0+cWludmFsX21hZGRyID09IDAg
KQogICAgICAgICB7CiAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19XQVJO
SU5HIFZURFBSRUZJWCwKQEAgLTQzMSwxNSArNDU0LDE2IEBAIGludCBlbmFi
bGVfcWludmFsKHN0cnVjdCBpb21tdSAqaW9tbXUpCiAKICAgICBzcGluX2xv
Y2tfaXJxc2F2ZSgmaW9tbXUtPnJlZ2lzdGVyX2xvY2ssIGZsYWdzKTsKIAot
ICAgIC8qIFNldHVwIEludmFsaWRhdGlvbiBRdWV1ZSBBZGRyZXNzKElRQSkg
cmVnaXN0ZXIgd2l0aCB0aGUKLSAgICAgKiBhZGRyZXNzIG9mIHRoZSBwYWdl
IHdlIGp1c3QgYWxsb2NhdGVkLiAgUVMgZmllbGQgYXQKLSAgICAgKiBiaXRz
WzI6MF0gdG8gaW5kaWNhdGUgc2l6ZSBvZiBxdWV1ZSBpcyBvbmUgNEtCIHBh
Z2UuCi0gICAgICogVGhhdCdzIDI1NiBlbnRyaWVzLiAgUXVldWVkIEhlYWQg
KElRSCkgYW5kIFF1ZXVlIFRhaWwgKElRVCkKLSAgICAgKiByZWdpc3RlcnMg
YXJlIGF1dG9tYXRpY2FsbHkgcmVzZXQgdG8gMCB3aXRoIHdyaXRlCi0gICAg
ICogdG8gSVFBIHJlZ2lzdGVyLgorICAgIC8qCisgICAgICogU2V0dXAgSW52
YWxpZGF0aW9uIFF1ZXVlIEFkZHJlc3MgKElRQSkgcmVnaXN0ZXIgd2l0aCB0
aGUgYWRkcmVzcyBvZiB0aGUKKyAgICAgKiBwYWdlcyB3ZSBqdXN0IGFsbG9j
YXRlZC4gIFRoZSBRUyBmaWVsZCBhdCBiaXRzWzI6MF0gaW5kaWNhdGVzIHRo
ZSBzaXplCisgICAgICogKHBhZ2Ugb3JkZXIpIG9mIHRoZSBxdWV1ZS4KKyAg
ICAgKgorICAgICAqIFF1ZXVlZCBIZWFkIChJUUgpIGFuZCBRdWV1ZSBUYWls
IChJUVQpIHJlZ2lzdGVycyBhcmUgYXV0b21hdGljYWxseQorICAgICAqIHJl
c2V0IHRvIDAgd2l0aCB3cml0ZSB0byBJUUEgcmVnaXN0ZXIuCiAgICAgICov
CiAgICAgZG1hcl93cml0ZXEoaW9tbXUtPnJlZywgRE1BUl9JUUFfUkVHLAot
ICAgICAgICAgICAgICAgIHFpX2N0cmwtPnFpbnZhbF9tYWRkciB8IFFJTlZB
TF9QQUdFX09SREVSKTsKKyAgICAgICAgICAgICAgICBxaV9jdHJsLT5xaW52
YWxfbWFkZHIgfCBxaV9wZ19vcmRlcik7CiAKICAgICBkbWFyX3dyaXRlcShp
b21tdS0+cmVnLCBETUFSX0lRVF9SRUcsIDApOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.11-2.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHNpemUgY29tbWFuZCBidWZmZXIgZHluYW1pY2FsbHkK
CldpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9kZWwsIHdlIG5lZWQg
dHdvIHNsb3RzIGZvciBldmVyeQpvcGVyYXRpb24gKHRoZSBvcGVyYXRpb24g
aXRzZWxmIGFuZCBhIHdhaXQgY29tbWFuZCkuICBUaGVyZSBjYW4gYmUgb25l
CnN1Y2ggcGFpciBvZiBjb21tYW5kcyBwZW5kaW5nIHBlciBDUFUuIFRvIGVu
c3VyZSB0aGF0IHVuZGVyIGFsbCBub3JtYWwKY2lyY3Vtc3RhbmNlcyBhIHNs
b3QgaXMgYWx3YXlzIGF2YWlsYWJsZSB3aGVuIG9uZSBpcyByZXF1ZXN0ZWQs
IHNpemUgdGhlCmNvbW1hbmQgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJl
ciBvZiBwcmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAv
IENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50
IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yNCw4ICsyNCw3IEBACiAKIHN0YXRp
YyBpbnQgcXVldWVfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW1kX2lvbW11ICpp
b21tdSwgdTMyIGNtZFtdKQogewotICAgIHUzMiB0YWlsLCBoZWFkLCAqY21k
X2J1ZmZlcjsKLSAgICBpbnQgaTsKKyAgICB1aW50MzJfdCB0YWlsLCBoZWFk
OwogCiAgICAgdGFpbCA9IGlvbW11LT5jbWRfYnVmZmVyLnRhaWw7CiAgICAg
aWYgKCArK3RhaWwgPT0gaW9tbXUtPmNtZF9idWZmZXIuZW50cmllcyApCkBA
IC0zNSwxMiArMzQsOSBAQCBzdGF0aWMgaW50IHF1ZXVlX2lvbW11X2NvbW1h
bmQoc3RydWN0IGFtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpKTsKICAgICBp
ZiAoIGhlYWQgIT0gdGFpbCApCiAgICAgewotICAgICAgICBjbWRfYnVmZmVy
ID0gKHUzMiAqKShpb21tdS0+Y21kX2J1ZmZlci5idWZmZXIgKwotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAoaW9tbXUtPmNtZF9idWZmZXIudGFp
bCAqCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0NNRF9C
VUZGRVJfRU5UUllfU0laRSkpOwotCi0gICAgICAgIGZvciAoIGkgPSAwOyBp
IDwgSU9NTVVfQ01EX0JVRkZFUl9VMzJfUEVSX0VOVFJZOyBpKysgKQotICAg
ICAgICAgICAgY21kX2J1ZmZlcltpXSA9IGNtZFtpXTsKKyAgICAgICAgbWVt
Y3B5KGlvbW11LT5jbWRfYnVmZmVyLmJ1ZmZlciArCisgICAgICAgICAgICAg
ICAoaW9tbXUtPmNtZF9idWZmZXIudGFpbCAqIHNpemVvZihjbWRfZW50cnlf
dCkpLAorICAgICAgICAgICAgICAgY21kLCBzaXplb2YoY21kX2VudHJ5X3Qp
KTsKIAogICAgICAgICBpb21tdS0+Y21kX2J1ZmZlci50YWlsID0gdGFpbDsK
ICAgICAgICAgcmV0dXJuIDE7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdV9pbml0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Ro
cm91Z2gvYW1kL2lvbW11X2luaXQuYwpAQCAtMTM2LDcgKzEzNiw3IEBAIHN0
YXRpYyB2b2lkIHJlZ2lzdGVyX2lvbW11X2NtZF9idWZmZXJfaW4KICAgICB3
cml0ZWwoZW50cnksIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DTURfQlVG
RkVSX0JBU0VfTE9XX09GRlNFVCk7CiAKICAgICBwb3dlcl9vZjJfZW50cmll
cyA9IGdldF9vcmRlcl9mcm9tX2J5dGVzKGlvbW11LT5jbWRfYnVmZmVyLmFs
bG9jX3NpemUpICsKLSAgICAgICAgSU9NTVVfQ01EX0JVRkZFUl9QT1dFUl9P
RjJfRU5UUklFU19QRVJfUEFHRTsKKyAgICAgICAgUEFHRV9TSElGVCAtIElP
TU1VX0NNRF9CVUZGRVJfRU5UUllfT1JERVI7CiAKICAgICBlbnRyeSA9IDA7
CiAgICAgaW9tbXVfc2V0X2FkZHJfaGlfdG9fcmVnKCZlbnRyeSwgYWRkcl9o
aSk7CkBAIC0xMDAwLDkgKzEwMDAsMzEgQEAgc3RhdGljIHZvaWQgKiBfX2lu
aXQgYWxsb2NhdGVfcmluZ19idWZmZQogc3RhdGljIHZvaWQgKiBfX2luaXQg
YWxsb2NhdGVfY21kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkK
IHsKICAgICAvKiBhbGxvY2F0ZSAnY29tbWFuZCBidWZmZXInIGluIHBvd2Vy
IG9mIDIgaW5jcmVtZW50cyBvZiA0SyAqLworICAgIHN0YXRpYyB1bnNpZ25l
ZCBpbnQgX19yZWFkX21vc3RseSBucl9lbnRzOworCisgICAgaWYgKCAhbnJf
ZW50cyApCisgICAgeworICAgICAgICB1bnNpZ25lZCBpbnQgb3JkZXI7CisK
KyAgICAgICAgLyoKKyAgICAgICAgICogV2l0aCB0aGUgcHJlc2VudCBzeW5j
aHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xvdHMgZm9yIGV2ZXJ5Cisg
ICAgICAgICAqIG9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYgYW5k
IGEgd2FpdCBjb21tYW5kKS4gIFRoZXJlIGNhbiBiZQorICAgICAgICAgKiBv
bmUgc3VjaCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gIE9u
ZSBleHRyYSBlbnRyeSBpcworICAgICAgICAgKiBuZWVkZWQgYXMgdGhlIHJp
bmcgaXMgY29uc2lkZXJlZCBmdWxsIHdoZW4gdGhlcmUncyBvbmx5IG9uZSBl
bnRyeQorICAgICAgICAgKiBsZWZ0LgorICAgICAgICAgKi8KKyAgICAgICAg
QlVJTERfQlVHX09OKENPTkZJR19OUl9DUFVTICogMiA+PSBJT01NVV9DTURf
QlVGRkVSX01BWF9FTlRSSUVTKTsKKyAgICAgICAgb3JkZXIgPSBnZXRfb3Jk
ZXJfZnJvbV9ieXRlcygobnVtX3ByZXNlbnRfY3B1cygpICogMiArIDEpIDw8
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVf
Q01EX0JVRkZFUl9FTlRSWV9PUkRFUik7CisgICAgICAgIG5yX2VudHMgPSAx
dSA8PCAob3JkZXIgKyBQQUdFX1NISUZUIC0gSU9NTVVfQ01EX0JVRkZFUl9F
TlRSWV9PUkRFUik7CisKKyAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJ1c2lu
ZyAldS1lbnRyeSBjbWQgcmluZyhzKVxuIiwgbnJfZW50cyk7CisgICAgfQor
CisgICAgQlVJTERfQlVHX09OKHNpemVvZihjbWRfZW50cnlfdCkgIT0gKDF1
IDw8IElPTU1VX0NNRF9CVUZGRVJfRU5UUllfT1JERVIpKTsKKwogICAgIHJl
dHVybiBhbGxvY2F0ZV9yaW5nX2J1ZmZlcigmaW9tbXUtPmNtZF9idWZmZXIs
IHNpemVvZihjbWRfZW50cnlfdCksCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIElPTU1VX0NNRF9CVUZGRVJfREVGQVVMVF9FTlRSSUVTLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ29tbWFuZCBCdWZm
ZXIiKTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJfZW50
cywgIkNvbW1hbmQgQnVmZmVyIik7CiB9CiAKIHN0YXRpYyB2b2lkICogX19p
bml0IGFsbG9jYXRlX2V2ZW50X2xvZyhzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSkKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21t
dS1kZWZzLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2Ft
ZC1pb21tdS1kZWZzLmgKQEAgLTIwLDkgKzIwLDYgQEAKICNpZm5kZWYgX0FT
TV9YODZfNjRfQU1EX0lPTU1VX0RFRlNfSAogI2RlZmluZSBfQVNNX1g4Nl82
NF9BTURfSU9NTVVfREVGU19ICiAKLS8qIElPTU1VIENvbW1hbmQgQnVmZmVy
IGVudHJpZXM6IGluIHBvd2VyIG9mIDIgaW5jcmVtZW50cywgbWluaW11bSBv
ZiAyNTYgKi8KLSNkZWZpbmUgSU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VO
VFJJRVMJNTEyCi0KIC8qIElPTU1VIEV2ZW50IExvZyBlbnRyaWVzOiBpbiBw
b3dlciBvZiAyIGluY3JlbWVudHMsIG1pbmltdW0gb2YgMjU2ICovCiAjZGVm
aW5lIElPTU1VX0VWRU5UX0xPR19ERUZBVUxUX0VOVFJJRVMgICAgIDUxMgog
CkBAIC0xODUsOSArMTgyLDggQEAKICNkZWZpbmUgSU9NTVVfQ01EX0JVRkZF
Ul9MRU5HVEhfTUFTSwkJMHgwRjAwMDAwMAogI2RlZmluZSBJT01NVV9DTURf
QlVGRkVSX0xFTkdUSF9TSElGVAkJMjQKIAotI2RlZmluZSBJT01NVV9DTURf
QlVGRkVSX0VOVFJZX1NJWkUJCQkxNgotI2RlZmluZSBJT01NVV9DTURfQlVG
RkVSX1BPV0VSX09GMl9FTlRSSUVTX1BFUl9QQUdFCTgKLSNkZWZpbmUgSU9N
TVVfQ01EX0JVRkZFUl9VMzJfUEVSX0VOVFJZIAkoSU9NTVVfQ01EX0JVRkZF
Ul9FTlRSWV9TSVpFIC8gNCkKKyNkZWZpbmUgSU9NTVVfQ01EX0JVRkZFUl9F
TlRSWV9PUkRFUiAgICAgICAgICAgIDQKKyNkZWZpbmUgSU9NTVVfQ01EX0JV
RkZFUl9NQVhfRU5UUklFUyAgICAgICAgICAgICgxdSA8PCAxNSkKIAogI2Rl
ZmluZSBJT01NVV9DTURfT1BDT0RFX01BU0sJCQkweEYwMDAwMDAwCiAjZGVm
aW5lIElPTU1VX0NNRF9PUENPREVfU0hJRlQJCQkyOAo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.11-3.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.11-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBlbGltaW5hdGUgZmx1c2ggcmVsYXRlZCB0aW1lb3V0cwoKTGVh
dmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24gcGVuZGluZyB3aGVuIGl0
IGFwcGVhcnMgdG8gdGFrZSB0b28KbG9uZyBpcyBwcm9ibGVtYXRpYzogSWYg
ZS5nLiBhIFFJIGNvbW1hbmQgY29tcGxldGVkIGxhdGVyLCB0aGUgd3JpdGUg
dG8KdGhlICJwb2xsIHNsb3QiIG1heSBpbnN0ZWFkIGJlIHVuZGVyc3Rvb2Qg
dG8gc2lnbmFsIGEgc3Vic2VxdWVudGx5CnN0YXJ0ZWQgY29tbWFuZCdzIGNv
bXBsZXRpb24uIEFsc28gb3VyIGFjY291bnRpbmcgb2YgdGhlIHRpbWVvdXQg
cGVyaW9kCndhcyBhY3R1YWxseSB3cm9uZzogV2UgaW5jbHVkZWQgdGhlIHRp
bWUgaXQgdG9vayBmb3IgdGhlIGNvbW1hbmQgdG8KYWN0dWFsbHkgbWFrZSBp
dCB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLCB3aGljaCBjb3VsZCBiZSBo
ZWF2aWx5CmFmZmVjdGVkIGJ5IGd1ZXN0cyBvdGhlciB0aGFuIHRoZSBvbmUg
Zm9yIHdoaWNoIHRoZSBmbHVzaCBpcyBiZWluZwpwZXJmb3JtZWQuCgpEbyBh
d2F5IHdpdGggYWxsIHRpbWVvdXQgZGV0ZWN0aW9uIG9uIGFsbCBmbHVzaCBy
ZWxhdGVkIGNvZGUgcGF0aHMuCkxvZyBleGNlc3NpdmVseSBsb25nIHByb2Nl
c3NpbmcgdGltZXMgKHdpdGggYSBwcm9ncmVzc2l2ZSB0aHJlc2hvbGQpIHRv
CmhhdmUgc29tZSBpbmRpY2F0aW9uIG9mIHByb2JsZW1zIGluIHRoaXMgYXJl
YS4KCkFkZGl0aW9uYWxseSBsb2cgKG9uY2UpIGlmIHFpbnZhbF9uZXh0X2lu
ZGV4KCkgZGlkbid0IGltbWVkaWF0ZWx5IGZpbmQKYW4gYXZhaWxhYmxlIHNs
b3QuIFRvZ2V0aGVyIHdpdGggdGhlIGVhcmxpZXIgY2hhbmdlIHNpemluZyB0
aGUgcXVldWUocykKZHluYW1pY2FsbHksIHdlIHNob3VsZCBub3cgaGF2ZSBh
IGd1YXJhbnRlZSB0aGF0IHdpdGggb3VyIGZ1bGx5CnN5bmNocm9ub3VzIG1v
ZGVsIGFueSBkZW1hbmQgZm9yIHNsb3RzIGNhbiBhY3R1YWxseSBiZSBzYXRp
c2ZpZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4
NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5v
cmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZG1hci5o
CisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmgKQEAg
LTEyNyw2ICsxMjcsMzQgQEAgZG8gewogICAgIH0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
IH0gd2hpbGUgKDApCiAKKyNkZWZpbmUgSU9NTVVfRkxVU0hfV0FJVCh3aGF0
LCBpb21tdSwgb2Zmc2V0LCBvcCwgY29uZCwgc3RzKSAgICAgICBcCitkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
X19yZWFkX21vc3RseSB0aHJlc2hvbGQgPSAxOyAgICAgICAgICAgICAgIFwK
KyAgICBzX3RpbWVfdCBzdGFydCA9IE5PVygpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgc190aW1lX3QgdGltZW91
dCA9IHN0YXJ0ICsgRE1BUl9PUEVSQVRJT05fVElNRU9VVCAqIHRocmVzaG9s
ZDsgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCA7IDsg
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBz
dHMgPSBvcChpb21tdS0+cmVnLCBvZmZzZXQpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBjb25kICkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICBpZiAoIHRpbWVvdXQgJiYg
Tk9XKCkgPiB0aW1lb3V0ICkgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICB0aHJlc2hv
bGQgfD0gdGhyZXNob2xkIDw8IDE7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBS
RUZJWCAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAiIElPTU1VIyV1OiAlcyBmbHVzaCB0YWtpbmcgdG9vIGxvbmdcbiIs
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCB3
aGF0KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgdGltZW91dCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgfSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgIGNwdV9yZWxheCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIH0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgaWYgKCAhdGltZW91dCAp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklY
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICIgSU9NTVUjJXU6ICVzIGZsdXNoIHRvb2sgJWx1bXNcbiIsICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIHdoYXQs
IChOT1coKSAtIHN0YXJ0KSAvIDEwMDAwMDAwKTsgICAgXAorfSB3aGlsZSAo
IGZhbHNlICkKKwogaW50IHZ0ZF9od19jaGVjayh2b2lkKTsKIHZvaWQgZGlz
YWJsZV9wbXIoc3RydWN0IGlvbW11ICppb21tdSk7CiBpbnQgaXNfaWdkX2Ry
aGQoc3RydWN0IGFjcGlfZHJoZF91bml0ICpkcmhkKTsKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKQEAgLTM1Nyw4ICszNTcsOCBA
QCBzdGF0aWMgdm9pZCBpb21tdV9mbHVzaF93cml0ZV9idWZmZXIoc3RyCiAg
ICAgZG1hcl93cml0ZWwoaW9tbXUtPnJlZywgRE1BUl9HQ01EX1JFRywgdmFs
IHwgRE1BX0dDTURfV0JGKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBoYXJkd2Fy
ZSBjb21wbGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9tbXUsIERN
QVJfR1NUU19SRUcsIGRtYXJfcmVhZGwsCi0gICAgICAgICAgICAgICAgICAh
KHZhbCAmIERNQV9HU1RTX1dCRlMpLCB2YWwpOworICAgIElPTU1VX0ZMVVNI
X1dBSVQoIndyaXRlIGJ1ZmZlciIsIGlvbW11LCBETUFSX0dTVFNfUkVHLCBk
bWFyX3JlYWRsLAorICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBETUFf
R1NUU19XQkZTKSwgdmFsKTsKIAogICAgIHNwaW5fdW5sb2NrX2lycXJlc3Rv
cmUoJmlvbW11LT5yZWdpc3Rlcl9sb2NrLCBmbGFncyk7CiB9CkBAIC00MDgs
OCArNDA4LDggQEAgc3RhdGljIGludCBfX211c3RfY2hlY2sgZmx1c2hfY29u
dGV4dF9yZQogICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIERNQVJfQ0NN
RF9SRUcsIHZhbCk7CiAKICAgICAvKiBNYWtlIHN1cmUgaGFyZHdhcmUgY29t
cGxldGUgaXQgKi8KLSAgICBJT01NVV9XQUlUX09QKGlvbW11LCBETUFSX0ND
TURfUkVHLCBkbWFyX3JlYWRxLAotICAgICAgICAgICAgICAgICAgISh2YWwg
JiBETUFfQ0NNRF9JQ0MpLCB2YWwpOworICAgIElPTU1VX0ZMVVNIX1dBSVQo
ImNvbnRleHQiLCBpb21tdSwgRE1BUl9DQ01EX1JFRywgZG1hcl9yZWFkcSwK
KyAgICAgICAgICAgICAgICAgICAgICEodmFsICYgRE1BX0NDTURfSUNDKSwg
dmFsKTsKIAogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11LT5y
ZWdpc3Rlcl9sb2NrLCBmbGFncyk7CiAgICAgLyogZmx1c2ggY29udGV4dCBl
bnRyeSB3aWxsIGltcGxpY2l0bHkgZmx1c2ggd3JpdGUgYnVmZmVyICovCkBA
IC00OTEsOCArNDkxLDggQEAgc3RhdGljIGludCBfX211c3RfY2hlY2sgZmx1
c2hfaW90bGJfcmVnKAogICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIHRs
Yl9vZmZzZXQgKyA4LCB2YWwpOwogCiAgICAgLyogTWFrZSBzdXJlIGhhcmR3
YXJlIGNvbXBsZXRlIGl0ICovCi0gICAgSU9NTVVfV0FJVF9PUChpb21tdSwg
KHRsYl9vZmZzZXQgKyA4KSwgZG1hcl9yZWFkcSwKLSAgICAgICAgICAgICAg
ICAgICEodmFsICYgRE1BX1RMQl9JVlQpLCB2YWwpOworICAgIElPTU1VX0ZM
VVNIX1dBSVQoImlvdGxiIiwgaW9tbXUsICh0bGJfb2Zmc2V0ICsgOCksIGRt
YXJfcmVhZHEsCisgICAgICAgICAgICAgICAgICAgICAhKHZhbCAmIERNQV9U
TEJfSVZUKSwgdmFsKTsKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZp
b21tdS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogCiAgICAgLyogY2hlY2sg
SU9UTEIgaW52YWxpZGF0aW9uIGdyYW51bGFyaXR5ICovCi0tLSBhL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYworKysgYi94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC92dGQvcWludmFsLmMKQEAgLTI5LDggKzI5LDYg
QEAKICNpbmNsdWRlICJleHRlcm4uaCIKICNpbmNsdWRlICIuLi9hdHMuaCIK
IAotI2RlZmluZSBWVERfUUlfVElNRU9VVAkxCi0KIHN0YXRpYyB1bnNpZ25l
ZCBpbnQgX19yZWFkX21vc3RseSBxaV9wZ19vcmRlcjsKIHN0YXRpYyB1bnNp
Z25lZCBpbnQgX19yZWFkX21vc3RseSBxaV9lbnRyeV9ucjsKIApAQCAtNjAs
NyArNTgsMTEgQEAgc3RhdGljIHVuc2lnbmVkIGludCBxaW52YWxfbmV4dF9p
bmRleChzdAogICAgIC8qICh0YWlsKzEgPT0gaGVhZCkgaW5kaWNhdGVzIGEg
ZnVsbCBxdWV1ZSwgd2FpdCBmb3IgSFcgKi8KICAgICB3aGlsZSAoICgodGFp
bCArIDEpICYgKHFpX2VudHJ5X25yIC0gMSkpID09CiAgICAgICAgICAgICAo
IGRtYXJfcmVhZHEoaW9tbXUtPnJlZywgRE1BUl9JUUhfUkVHKSA+PiBRSU5W
QUxfSU5ERVhfU0hJRlQgKSApCisgICAgeworICAgICAgICBwcmludGtfb25j
ZShYRU5MT0dfRVJSIFZURFBSRUZJWCAiIElPTU1VIyV1OiBubyBRSSBzbG90
IGF2YWlsYWJsZVxuIiwKKyAgICAgICAgICAgICAgICAgICAgaW9tbXUtPmlu
ZGV4KTsKICAgICAgICAgY3B1X3JlbGF4KCk7CisgICAgfQogCiAgICAgcmV0
dXJuIHRhaWw7CiB9CkBAIC0xODAsMjMgKzE4MiwzMiBAQCBzdGF0aWMgaW50
IF9fbXVzdF9jaGVjayBxdWV1ZV9pbnZhbGlkYXRlCiAgICAgLyogTm93IHdl
IGRvbid0IHN1cHBvcnQgaW50ZXJydXB0IG1ldGhvZCAqLwogICAgIGlmICgg
c3cgKQogICAgIHsKLSAgICAgICAgc190aW1lX3QgdGltZW91dDsKLQotICAg
ICAgICAvKiBJbiBjYXNlIGFsbCB3YWl0IGRlc2NyaXB0b3Igd3JpdGVzIHRv
IHNhbWUgYWRkciB3aXRoIHNhbWUgZGF0YSAqLwotICAgICAgICB0aW1lb3V0
ID0gTk9XKCkgKyBNSUxMSVNFQ1MoZmx1c2hfZGV2X2lvdGxiID8KLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlvbW11X2Rldl9pb3Rs
Yl90aW1lb3V0IDogVlREX1FJX1RJTUVPVVQpOworICAgICAgICBzdGF0aWMg
dW5zaWduZWQgaW50IF9fcmVhZF9tb3N0bHkgdGhyZXNob2xkID0gMTsKKyAg
ICAgICAgc190aW1lX3Qgc3RhcnQgPSBOT1coKTsKKyAgICAgICAgc190aW1l
X3QgdGltZW91dCA9IHN0YXJ0ICsgKGZsdXNoX2Rldl9pb3RsYgorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBpb21tdV9kZXZfaW90
bGJfdGltZW91dAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgOiAxMDApICogTUlMTElTRUNTKHRocmVzaG9sZCk7CiAKICAgICAgICAg
d2hpbGUgKCBBQ0NFU1NfT05DRSgqdGhpc19wb2xsX3Nsb3QpICE9IFFJTlZB
TF9TVEFUX0RPTkUgKQogICAgICAgICB7Ci0gICAgICAgICAgICBpZiAoIE5P
VygpID4gdGltZW91dCApCisgICAgICAgICAgICBpZiAoIHRpbWVvdXQgJiYg
Tk9XKCkgPiB0aW1lb3V0ICkKICAgICAgICAgICAgIHsKLSAgICAgICAgICAg
ICAgICBwcmludF9xaV9yZWdzKGlvbW11KTsKKyAgICAgICAgICAgICAgICB0
aHJlc2hvbGQgfD0gdGhyZXNob2xkIDw8IDE7CiAgICAgICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWAotICAgICAgICAgICAg
ICAgICAgICAgICAiIFF1ZXVlIGludmFsaWRhdGUgd2FpdCBkZXNjcmlwdG9y
IHRpbWVkIG91dFxuIik7Ci0gICAgICAgICAgICAgICAgcmV0dXJuIC1FVElN
RURPVVQ7CisgICAgICAgICAgICAgICAgICAgICAgICIgSU9NTVUjJXU6IFFJ
JXMgd2FpdCBkZXNjcmlwdG9yIHRha2luZyB0b28gbG9uZ1xuIiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCBmbHVzaF9kZXZfaW90
bGIgPyAiIGRldiIgOiAiIik7CisgICAgICAgICAgICAgICAgcHJpbnRfcWlf
cmVncyhpb21tdSk7CisgICAgICAgICAgICAgICAgdGltZW91dCA9IDA7CiAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICBjcHVfcmVsYXgoKTsKICAgICAg
ICAgfQorCisgICAgICAgIGlmICggIXRpbWVvdXQgKQorICAgICAgICAgICAg
cHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBSRUZJWAorICAgICAgICAgICAg
ICAgICAgICIgSU9NTVUjJXU6IFFJJXMgd2FpdCBkZXNjcmlwdG9yIHRvb2sg
JWx1bXNcbiIsCisgICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCBm
bHVzaF9kZXZfaW90bGIgPyAiIGRldiIgOiAiIiwKKyAgICAgICAgICAgICAg
ICAgICAoTk9XKCkgLSBzdGFydCkgLyAxMDAwMDAwMCk7CisKICAgICAgICAg
cmV0dXJuIDA7CiAgICAgfQogCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.11-4.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.11-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHdhaXQgZm9yIGNvbW1hbmQgc2xvdCB0byBiZSBhdmFp
bGFibGUKCk5vIGNhbGxlciBjYXJlZCBhYm91dCBzZW5kX2lvbW11X2NvbW1h
bmQoKSBpbmRpY2F0aW5nIHVuYXZhaWxhYmlsaXR5IG9mCmEgc2xvdC4gSGVu
Y2UgaWYgYSBzdWZmaWNpZW50IG51bWJlciBwcmlvciBjb21tYW5kcyB0aW1l
ZCBvdXQsIHdlIGRpZApibGluZGx5IGFzc3VtZSB0aGF0IHRoZSByZXF1ZXN0
ZWQgY29tbWFuZCB3YXMgc3VibWl0dGVkIHRvIHRoZSBJT01NVQp3aGVuIHJl
YWxseSBpdCB3YXNuJ3QuIFRoaXMgY291bGQgbWVhbiBib3RoIGEgaGFuZ2lu
ZyBzeXN0ZW0gKHdhaXRpbmcKZm9yIGEgY29tbWFuZCB0byBjb21wbGV0ZSB0
aGF0IHdhcyBuZXZlciBzZWVuIGJ5IHRoZSBJT01NVSkgb3IgYmxpbmRseQpw
cm9wYWdhdGluZyBzdWNjZXNzIGJhY2sgdG8gY2FsbGVycywgbWFraW5nIHRo
ZW0gYmVsaWV2ZSB0aGV5J3JlIGZpbmUKdG8gZS5nLiBmcmVlIHByZXZpb3Vz
bHkgdW5tYXBwZWQgcGFnZXMuCgpGb2xkIHRoZSB0aHJlZSBpbnZvbHZlZCBm
dW5jdGlvbnMgaW50byBvbmUsIGFkZCBzcGluIHdhaXRpbmcgZm9yIGFuCmF2
YWlsYWJsZSBzbG90IGFsb25nIHRoZSBsaW5lcyBvZiBWVC1kJ3MgcWludmFs
X25leHRfaW5kZXgoKSwgYW5kIGFzIGEKY29uc2VxdWVuY2UgZHJvcCBhbGwg
ZXJyb3IgaW5kaWNhdG9yIHJldHVybiB0eXBlcy92YWx1ZXMuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yMiw0
OCArMjIsMzYgQEAKICNpbmNsdWRlIDxhc20vaHZtL3N2bS9hbWQtaW9tbXUt
cHJvdG8uaD4KICNpbmNsdWRlICIuLi9hdHMuaCIKIAotc3RhdGljIGludCBx
dWV1ZV9pb21tdV9jb21tYW5kKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1
MzIgY21kW10pCitzdGF0aWMgdm9pZCBzZW5kX2lvbW11X2NvbW1hbmQoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgdWludDMyX3QgY21kWzRdKQogewotICAgIHVpbnQz
Ml90IHRhaWwsIGhlYWQ7CisgICAgdWludDMyX3QgdGFpbDsKIAogICAgIHRh
aWwgPSBpb21tdS0+Y21kX2J1ZmZlci50YWlsOwogICAgIGlmICggKyt0YWls
ID09IGlvbW11LT5jbWRfYnVmZmVyLmVudHJpZXMgKQogICAgICAgICB0YWls
ID0gMDsKIAotICAgIGhlYWQgPSBpb21tdV9nZXRfcmJfcG9pbnRlcihyZWFk
bChpb21tdS0+bW1pb19iYXNlICsKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU9NTVVfQ01EX0JVRkZFUl9IRUFEX09GRlNFVCkp
OwotICAgIGlmICggaGVhZCAhPSB0YWlsICkKKyAgICB3aGlsZSAoIHRhaWwg
PT0gaW9tbXVfZ2V0X3JiX3BvaW50ZXIocmVhZGwoaW9tbXUtPm1taW9fYmFz
ZSArCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpKSApCiAgICAg
ewotICAgICAgICBtZW1jcHkoaW9tbXUtPmNtZF9idWZmZXIuYnVmZmVyICsK
LSAgICAgICAgICAgICAgIChpb21tdS0+Y21kX2J1ZmZlci50YWlsICogc2l6
ZW9mKGNtZF9lbnRyeV90KSksCi0gICAgICAgICAgICAgICBjbWQsIHNpemVv
ZihjbWRfZW50cnlfdCkpOwotCi0gICAgICAgIGlvbW11LT5jbWRfYnVmZmVy
LnRhaWwgPSB0YWlsOwotICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgcHJp
bnRrX29uY2UoWEVOTE9HX0VSUgorICAgICAgICAgICAgICAgICAgICAiQU1E
IElPTU1VICUwNHg6JTAyeDolMDJ4LiV1OiBubyBjbWQgc2xvdCBhdmFpbGFi
bGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11LT5zZWcsIFBDSV9C
VVMoaW9tbXUtPmJkZiksCisgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9U
KGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSk7CisgICAgICAg
IGNwdV9yZWxheCgpOwogICAgIH0KIAotICAgIHJldHVybiAwOwotfQorICAg
IG1lbWNweShpb21tdS0+Y21kX2J1ZmZlci5idWZmZXIgKworICAgICAgICAg
ICAoaW9tbXUtPmNtZF9idWZmZXIudGFpbCAqIHNpemVvZihjbWRfZW50cnlf
dCkpLAorICAgICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwog
Ci1zdGF0aWMgdm9pZCBjb21taXRfaW9tbXVfY29tbWFuZF9idWZmZXIoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUpCi17Ci0gICAgdTMyIHRhaWwgPSAwOwor
ICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWlsOwogCisgICAgdGFp
bCA9IDA7CiAgICAgaW9tbXVfc2V0X3JiX3BvaW50ZXIoJnRhaWwsIGlvbW11
LT5jbWRfYnVmZmVyLnRhaWwpOwogICAgIHdyaXRlbCh0YWlsLCBpb21tdS0+
bW1pb19iYXNlK0lPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZTRVQpOwogfQog
Ci1pbnQgc2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11LCB1MzIgY21kW10pCi17Ci0gICAgaWYgKCBxdWV1ZV9pb21tdV9jb21t
YW5kKGlvbW11LCBjbWQpICkKLSAgICB7Ci0gICAgICAgIGNvbW1pdF9pb21t
dV9jb21tYW5kX2J1ZmZlcihpb21tdSk7Ci0gICAgICAgIHJldHVybiAxOwot
ICAgIH0KLQotICAgIHJldHVybiAwOwotfQotCiBzdGF0aWMgdm9pZCBmbHVz
aF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKIHsK
ICAgICB1MzIgY21kWzRdLCBzdGF0dXM7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.11-5.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.11-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRyb3AgY29tbWFuZCBjb21wbGV0aW9uIHRpbWVvdXQK
CkZpcnN0IGFuZCBmb3JlbW9zdCAtIHN1Y2ggdGltZW91dHMgd2VyZSBub3Qg
c2lnbmFsZWQgdG8gY2FsbGVycywgbWFraW5nCnRoZW0gYmVsaWV2ZSB0aGV5
J3JlIGZpbmUgdG8gZS5nLiBmcmVlIHByZXZpb3VzbHkgdW5tYXBwZWQgcGFn
ZXMuCgpNaXJyb3IgVlQtZCdzIGJlaGF2aW9yOiBBIGZpeGVkIG51bWJlciBv
ZiBsb29wIGl0ZXJhdGlvbnMgaXMgbm90IGEKc3VpdGFibGUgd2F5IHRvIGRl
dGVjdCB0aW1lb3V0cyBpbiBhbiBlbnZpcm9ubWVudCAoQ1BVIGFuZCBidXMg
c3BlZWRzKQppbmRlcGVuZGVudCBtYW5uZXIgYW55d2F5LiBGdXJ0aGVybW9y
ZSwgbGVhdmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24KcGVuZGluZyB3
aGVuIGl0IGFwcGVhcnMgdG8gdGFrZSB0b28gbG9uZyBpcyBwcm9ibGVtYXRp
YzogSWYgYSBjb21tYW5kCmNvbXBsZXRlZCBsYXRlciwgdGhlIHNpZ25hbGlu
ZyBvZiBpdHMgY29tcGxldGlvbiBtYXkgaW5zdGVhZCBiZQp1bmRlcnN0b29k
IHRvIHNpZ25hbCBhIHN1YnNlcXVlbnRseSBzdGFydGVkIGNvbW1hbmQncyBj
b21wbGV0aW9uLgoKTG9nIGV4Y2Vzc2l2ZWx5IGxvbmcgcHJvY2Vzc2luZyB0
aW1lcyAod2l0aCBhIHByb2dyZXNzaXZlIHRocmVzaG9sZCkgdG8KaGF2ZSBz
b21lIGluZGljYXRpb24gb2YgcHJvYmxlbXMgaW4gdGhpcyBhcmVhLiBBbGxv
dyBjYWxsZXJzIHRvIHNwZWNpZnkKYSBub24tZGVmYXVsdCB0aW1lb3V0IGJp
YXMgZm9yIHRoaXMgbG9nZ2luZywgdXNpbmcgdGhlIHNhbWUgdmFsdWVzIGFz
ClZULWQgZG9lcywgd2hpY2ggaW4gcGFydGljdWxhciBtZWFucyBhIChieSBk
ZWZhdWx0KSBtdWNoIGxhcmdlciB2YWx1ZQpmb3IgZGV2aWNlIElPIFRMQiBp
bnZhbGlkYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2NtZC5jCkBAIC01MiwxMCArNTIsMTIgQEAgc3RhdGljIHZvaWQg
c2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbQogICAgIHdyaXRlbCh0YWls
LCBpb21tdS0+bW1pb19iYXNlK0lPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZT
RVQpOwogfQogCi1zdGF0aWMgdm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKK3N0YXRpYyB2b2lkIGZsdXNoX2Nv
bW1hbmRfYnVmZmVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHRpbWVv
dXRfYmFzZSkKIHsKLSAgICB1MzIgY21kWzRdLCBzdGF0dXM7Ci0gICAgaW50
IGxvb3BfY291bnQsIGNvbXBfd2FpdDsKKyAgICB1aW50MzJfdCBjbWRbNF07
CisgICAgc190aW1lX3Qgc3RhcnQsIHRpbWVvdXQ7CisgICAgc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7CiAKICAg
ICAvKiBSVzFDICdDb21XYWl0SW50JyBpbiBzdGF0dXMgcmVnaXN0ZXIgKi8K
ICAgICB3cml0ZWwoSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRfTUFTSywK
QEAgLTcxLDI0ICs3MywzMSBAQCBzdGF0aWMgdm9pZCBmbHVzaF9jb21tYW5k
X2J1ZmZlcihzdHJ1Y3QKICAgICAgICAgICAgICAgICAgICAgICAgICBJT01N
VV9DT01QX1dBSVRfSV9GTEFHX1NISUZULCAmY21kWzBdKTsKICAgICBzZW5k
X2lvbW11X2NvbW1hbmQoaW9tbXUsIGNtZCk7CiAKLSAgICAvKiBNYWtlIGxv
b3BfY291bnQgbG9uZyBlbm91Z2ggZm9yIHBvbGxpbmcgY29tcGxldGlvbiB3
YWl0IGJpdCAqLwotICAgIGxvb3BfY291bnQgPSAxMDAwOwotICAgIGRvIHsK
LSAgICAgICAgc3RhdHVzID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0gICAgICAgIGNvbXBfd2FpdCA9
IGdldF9maWVsZF9mcm9tX3JlZ191MzIoc3RhdHVzLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1NUQVRVU19D
T01QX1dBSVRfSU5UX01BU0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRf
U0hJRlQpOwotICAgICAgICAtLWxvb3BfY291bnQ7Ci0gICAgfSB3aGlsZSAo
ICFjb21wX3dhaXQgJiYgbG9vcF9jb3VudCApOwotCi0gICAgaWYgKCBjb21w
X3dhaXQgKQorICAgIHN0YXJ0ID0gTk9XKCk7CisgICAgdGltZW91dCA9IHN0
YXJ0ICsgKHRpbWVvdXRfYmFzZSA/OiAxMDApICogTUlMTElTRUNTKHRocmVz
aG9sZCk7CisgICAgd2hpbGUgKCAhKHJlYWRsKGlvbW11LT5tbWlvX2Jhc2Ug
KyBJT01NVV9TVEFUVVNfTU1JT19PRkZTRVQpICYKKyAgICAgICAgICAgICAg
SU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRfTUFTSykgKQogICAgIHsKLSAg
ICAgICAgLyogUlcxQyAnQ29tV2FpdEludCcgaW4gc3RhdHVzIHJlZ2lzdGVy
ICovCi0gICAgICAgIHdyaXRlbChJT01NVV9TVEFUVVNfQ09NUF9XQUlUX0lO
VF9NQVNLLAotICAgICAgICAgICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0gICAgICAgIHJldHVybjsKKyAg
ICAgICAgaWYgKCB0aW1lb3V0ICYmIE5PVygpID4gdGltZW91dCApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIHRocmVzaG9sZCB8PSB0aHJlc2hvbGQgPDwg
MTsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORworICAgICAg
ICAgICAgICAgICAgICJBTUQgSU9NTVUgJTA0eDolMDJ4OiUwMnguJXU6ICVz
Y29tcGxldGlvbiB3YWl0IHRha2luZyB0b28gbG9uZ1xuIiwKKyAgICAgICAg
ICAgICAgICAgICBpb21tdS0+c2VnLCBQQ0lfQlVTKGlvbW11LT5iZGYpLAor
ICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQQ0lf
RlVOQyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgICAgICB0aW1lb3V0
X2Jhc2UgPyAiaW90bGIgIiA6ICIiKTsKKyAgICAgICAgICAgIHRpbWVvdXQg
PSAwOworICAgICAgICB9CisgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0K
LSAgICBBTURfSU9NTVVfREVCVUcoIldhcm5pbmc6IENvbVdhaXRJbnQgYml0
IGRpZCBub3QgYXNzZXJ0IVxuIik7CisKKyAgICBpZiAoICF0aW1lb3V0ICkK
KyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HCisgICAgICAgICAgICAg
ICAiQU1EIElPTU1VICUwNHg6JTAyeDolMDJ4LiV1OiAlc2NvbXBsZXRpb24g
d2FpdCB0b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgaW9tbXUtPnNl
ZywgUENJX0JVUyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgIFBDSV9T
TE9UKGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSwKKyAgICAg
ICAgICAgICAgIHRpbWVvdXRfYmFzZSA/ICJpb3RsYiAiIDogIiIsCisgICAg
ICAgICAgICAgICAoTk9XKCkgLSBzdGFydCkgLyAxMDAwMDAwMCk7CiB9CiAK
IC8qIEJ1aWxkIGxvdyBsZXZlbCBpb21tdSBjb21tYW5kIG1lc3NhZ2VzICov
CkBAIC0zMDAsNyArMzA5LDcgQEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW90
bGIodTggZGV2Zm4sIGNvbgogICAgIC8qIHNlbmQgSU5WQUxJREFURV9JT1RM
Ql9QQUdFUyBjb21tYW5kICovCiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlv
bW11LT5sb2NrLCBmbGFncyk7CiAgICAgaW52YWxpZGF0ZV9pb3RsYl9wYWdl
cyhpb21tdSwgbWF4cGVuZCwgMCwgcXVldWVpZCwgZ2FkZHIsIHJlcV9pZCwg
b3JkZXIpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAg
ICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgaW9tbXVfZGV2X2lvdGxi
X3RpbWVvdXQpOwogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11
LT5sb2NrLCBmbGFncyk7CiB9CiAKQEAgLTMzNyw3ICszNDYsNyBAQCBzdGF0
aWMgdm9pZCBfYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKHN0cnVjCiAgICAgewog
ICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdz
KTsKICAgICAgICAgaW52YWxpZGF0ZV9pb21tdV9wYWdlcyhpb21tdSwgZ2Fk
ZHIsIGRvbV9pZCwgb3JkZXIpOwotICAgICAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSk7CisgICAgICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlv
bW11LCAwKTsKICAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9t
bXUtPmxvY2ssIGZsYWdzKTsKICAgICB9CiAKQEAgLTM2MSw3ICszNzAsNyBA
QCB2b2lkIGFtZF9pb21tdV9mbHVzaF9kZXZpY2Uoc3RydWN0IGFtZF9pCiAg
ICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPmxvY2spICk7CiAK
ICAgICBpbnZhbGlkYXRlX2Rldl90YWJsZV9lbnRyeShpb21tdSwgYmRmKTsK
LSAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAgZmx1c2hf
Y29tbWFuZF9idWZmZXIoaW9tbXUsIDApOwogfQogCiB2b2lkIGFtZF9pb21t
dV9mbHVzaF9pbnRyZW1hcChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWlu
dDE2X3QgYmRmKQpAQCAtMzY5LDcgKzM3OCw3IEBAIHZvaWQgYW1kX2lvbW11
X2ZsdXNoX2ludHJlbWFwKHN0cnVjdCBhbWQKICAgICBBU1NFUlQoIHNwaW5f
aXNfbG9ja2VkKCZpb21tdS0+bG9jaykgKTsKIAogICAgIGludmFsaWRhdGVf
aW50ZXJydXB0X3RhYmxlKGlvbW11LCBiZGYpOwotICAgIGZsdXNoX2NvbW1h
bmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihp
b21tdSwgMCk7CiB9CiAKIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9jYWNo
ZXMoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCkBAIC0zNzcsNyArMzg2LDcg
QEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfYWxsX2NhY2hlcyhzdHJ1Y3QgYQog
ICAgIEFTU0VSVCggc3Bpbl9pc19sb2NrZWQoJmlvbW11LT5sb2NrKSApOwog
CiAgICAgaW52YWxpZGF0ZV9pb21tdV9hbGwoaW9tbXUpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSwgMCk7CiB9CiAKIHZvaWQgYW1kX2lvbW11X3NlbmRfZ3Vl
c3RfY21kKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1MzIgY21kW10pCkBA
IC0zODcsNyArMzk2LDggQEAgdm9pZCBhbWRfaW9tbXVfc2VuZF9ndWVzdF9j
bWQoc3RydWN0IGFtZAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+
bG9jaywgZmxhZ3MpOwogCiAgICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11
LCBjbWQpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAg
ICAvKiBUQkQ6IFRpbWVvdXQgc2VsZWN0aW9uIG1heSByZXF1aXJlIHBlZWtp
bmcgaW50byBjbWRbXS4gKi8KKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihp
b21tdSwgMCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21t
dS0+bG9jaywgZmxhZ3MpOwogfQo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.12-1.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.12-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBzaXplIHFpbnZhbCBxdWV1ZSBkeW5hbWljYWxseQoKV2l0aCB0
aGUgcHJlc2VudCBzeW5jaHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xv
dHMgZm9yIGV2ZXJ5Cm9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYg
YW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRoZXJlIGNhbiBiZQpvbmUgc3Vj
aCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gVG8gZW5zdXJl
IHRoYXQgdW5kZXIgYWxsCm5vcm1hbCBjaXJjdW1zdGFuY2VzIGEgc2xvdCBp
cyBhbHdheXMgYXZhaWxhYmxlIHdoZW4gb25lIGlzIHJlcXVlc3RlZCwKc2l6
ZSB0aGUgcXVldWUgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJlciBvZiBw
cmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuaApAQCAtNDUwLDE3ICs0NTAsOSBAQCBzdHJ1Y3QgcWludmFsX2VudHJ5
IHsKICAgICB9cTsKIH07CiAKLS8qIE9yZGVyIG9mIHF1ZXVlIGludmFsaWRh
dGlvbiBwYWdlcyhtYXggaXMgOCkgKi8KLSNkZWZpbmUgUUlOVkFMX1BBR0Vf
T1JERVIgICAyCi0KLSNkZWZpbmUgUUlOVkFMX0FSQ0hfUEFHRV9PUkRFUiAg
KFFJTlZBTF9QQUdFX09SREVSICsgUEFHRV9TSElGVF80SyAtIFBBR0VfU0hJ
RlQpCi0jZGVmaW5lIFFJTlZBTF9BUkNIX1BBR0VfTlIgICAgICggUUlOVkFM
X0FSQ0hfUEFHRV9PUkRFUiA8IDAgPyAgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAxIDogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBRSU5W
QUxfQVJDSF9QQUdFX09SREVSICkKLQogLyogRWFjaCBlbnRyeSBpcyAxNiBi
eXRlcywgc28gMl44IGVudHJpZXMgcGVyIHBhZ2UgKi8KICNkZWZpbmUgUUlO
VkFMX0VOVFJZX09SREVSICAoIFBBR0VfU0hJRlQgLSA0ICkKLSNkZWZpbmUg
UUlOVkFMX0VOVFJZX05SICAgICAoMSA8PCAoUUlOVkFMX1BBR0VfT1JERVIg
KyA4KSkKKyNkZWZpbmUgUUlOVkFMX01BWF9FTlRSWV9OUiAoMXUgPDwgKDcg
KyBRSU5WQUxfRU5UUllfT1JERVIpKQogCiAvKiBTdGF0dXMgZGF0YSBmbGFn
ICovCiAjZGVmaW5lIFFJTlZBTF9TVEFUX0lOSVQgIDAKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMzEsNiArMzEsOSBA
QAogCiAjZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKIAorc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOworc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOworCiBzdGF0
aWMgaW50IF9fbXVzdF9jaGVjayBpbnZhbGlkYXRlX3N5bmMoc3RydWN0IGlv
bW11ICppb21tdSk7CiAKIHN0YXRpYyB2b2lkIHByaW50X3FpX3JlZ3Moc3Ry
dWN0IGlvbW11ICppb21tdSkKQEAgLTU1LDcgKzU4LDcgQEAgc3RhdGljIHVu
c2lnbmVkIGludCBxaW52YWxfbmV4dF9pbmRleChzdAogICAgIHRhaWwgPj49
IFFJTlZBTF9JTkRFWF9TSElGVDsKIAogICAgIC8qICh0YWlsKzEgPT0gaGVh
ZCkgaW5kaWNhdGVzIGEgZnVsbCBxdWV1ZSwgd2FpdCBmb3IgSFcgKi8KLSAg
ICB3aGlsZSAoICggdGFpbCArIDEgKSAlIFFJTlZBTF9FTlRSWV9OUiA9PQor
ICAgIHdoaWxlICggKCh0YWlsICsgMSkgJiAocWlfZW50cnlfbnIgLSAxKSkg
PT0KICAgICAgICAgICAgICggZG1hcl9yZWFkcShpb21tdS0+cmVnLCBETUFS
X0lRSF9SRUcpID4+IFFJTlZBTF9JTkRFWF9TSElGVCApICkKICAgICAgICAg
Y3B1X3JlbGF4KCk7CiAKQEAgLTY4LDcgKzcxLDcgQEAgc3RhdGljIHZvaWQg
cWludmFsX3VwZGF0ZV9xdGFpbChzdHJ1Y3QgaQogCiAgICAgLyogTmVlZCBo
b2xkIHJlZ2lzdGVyIGxvY2sgd2hlbiB1cGRhdGUgdGFpbCAqLwogICAgIEFT
U0VSVCggc3Bpbl9pc19sb2NrZWQoJmlvbW11LT5yZWdpc3Rlcl9sb2NrKSAp
OwotICAgIHZhbCA9IChpbmRleCArIDEpICUgUUlOVkFMX0VOVFJZX05SOwor
ICAgIHZhbCA9IChpbmRleCArIDEpICYgKHFpX2VudHJ5X25yIC0gMSk7CiAg
ICAgZG1hcl93cml0ZXEoaW9tbXUtPnJlZywgRE1BUl9JUVRfUkVHLCAodmFs
IDw8IFFJTlZBTF9JTkRFWF9TSElGVCkpOwogfQogCkBAIC00MTcsNyArNDIw
LDI3IEBAIGludCBlbmFibGVfcWludmFsKHN0cnVjdCBpb21tdSAqaW9tbXUp
CiAgICAgaWYgKCBxaV9jdHJsLT5xaW52YWxfbWFkZHIgPT0gMCApCiAgICAg
ewogICAgICAgICBkcmhkID0gaW9tbXVfdG9fZHJoZChpb21tdSk7Ci0gICAg
ICAgIHFpX2N0cmwtPnFpbnZhbF9tYWRkciA9IGFsbG9jX3BndGFibGVfbWFk
ZHIoZHJoZCwgUUlOVkFMX0FSQ0hfUEFHRV9OUik7CisgICAgICAgIGlmICgg
IXFpX2VudHJ5X25yICkKKyAgICAgICAgeworICAgICAgICAgICAgLyoKKyAg
ICAgICAgICAgICAqIFdpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9k
ZWwsIHdlIG5lZWQgdHdvIHNsb3RzIGZvciBldmVyeQorICAgICAgICAgICAg
ICogb3BlcmF0aW9uICh0aGUgb3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0
IGRlc2NyaXB0b3IpLiAgVGhlcmUKKyAgICAgICAgICAgICAqIGNhbiBiZSBv
bmUgc3VjaCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gIE9u
ZSBleHRyYQorICAgICAgICAgICAgICogZW50cnkgaXMgbmVlZGVkIGFzIHRo
ZSByaW5nIGlzIGNvbnNpZGVyZWQgZnVsbCB3aGVuIHRoZXJlJ3MKKyAgICAg
ICAgICAgICAqIG9ubHkgb25lIGVudHJ5IGxlZnQuCisgICAgICAgICAgICAg
Ki8KKyAgICAgICAgICAgIEJVSUxEX0JVR19PTihDT05GSUdfTlJfQ1BVUyAq
IDIgPj0gUUlOVkFMX01BWF9FTlRSWV9OUik7CisgICAgICAgICAgICBxaV9w
Z19vcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5dGVzKChudW1fcHJlc2VudF9j
cHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKFBBR0VfU0hJRlQgLQorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUUlOVkFM
X0VOVFJZX09SREVSKSk7CisgICAgICAgICAgICBxaV9lbnRyeV9uciA9IDF1
IDw8IChxaV9wZ19vcmRlciArIFFJTlZBTF9FTlRSWV9PUkRFUik7CisKKyAg
ICAgICAgICAgIGRwcmludGsoWEVOTE9HX0lORk8gVlREUFJFRklYLAorICAg
ICAgICAgICAgICAgICAgICAiUUk6IHVzaW5nICV1LWVudHJ5IHJpbmcocylc
biIsIHFpX2VudHJ5X25yKTsKKyAgICAgICAgfQorCisgICAgICAgIHFpX2N0
cmwtPnFpbnZhbF9tYWRkciA9CisgICAgICAgICAgICBhbGxvY19wZ3RhYmxl
X21hZGRyKGRyaGQsIHFpX2VudHJ5X25yID4+IFFJTlZBTF9FTlRSWV9PUkRF
Uik7CiAgICAgICAgIGlmICggcWlfY3RybC0+cWludmFsX21hZGRyID09IDAg
KQogICAgICAgICB7CiAgICAgICAgICAgICBkcHJpbnRrKFhFTkxPR19XQVJO
SU5HIFZURFBSRUZJWCwKQEAgLTQzMSwxNSArNDU0LDE2IEBAIGludCBlbmFi
bGVfcWludmFsKHN0cnVjdCBpb21tdSAqaW9tbXUpCiAKICAgICBzcGluX2xv
Y2tfaXJxc2F2ZSgmaW9tbXUtPnJlZ2lzdGVyX2xvY2ssIGZsYWdzKTsKIAot
ICAgIC8qIFNldHVwIEludmFsaWRhdGlvbiBRdWV1ZSBBZGRyZXNzKElRQSkg
cmVnaXN0ZXIgd2l0aCB0aGUKLSAgICAgKiBhZGRyZXNzIG9mIHRoZSBwYWdl
IHdlIGp1c3QgYWxsb2NhdGVkLiAgUVMgZmllbGQgYXQKLSAgICAgKiBiaXRz
WzI6MF0gdG8gaW5kaWNhdGUgc2l6ZSBvZiBxdWV1ZSBpcyBvbmUgNEtCIHBh
Z2UuCi0gICAgICogVGhhdCdzIDI1NiBlbnRyaWVzLiAgUXVldWVkIEhlYWQg
KElRSCkgYW5kIFF1ZXVlIFRhaWwgKElRVCkKLSAgICAgKiByZWdpc3RlcnMg
YXJlIGF1dG9tYXRpY2FsbHkgcmVzZXQgdG8gMCB3aXRoIHdyaXRlCi0gICAg
ICogdG8gSVFBIHJlZ2lzdGVyLgorICAgIC8qCisgICAgICogU2V0dXAgSW52
YWxpZGF0aW9uIFF1ZXVlIEFkZHJlc3MgKElRQSkgcmVnaXN0ZXIgd2l0aCB0
aGUgYWRkcmVzcyBvZiB0aGUKKyAgICAgKiBwYWdlcyB3ZSBqdXN0IGFsbG9j
YXRlZC4gIFRoZSBRUyBmaWVsZCBhdCBiaXRzWzI6MF0gaW5kaWNhdGVzIHRo
ZSBzaXplCisgICAgICogKHBhZ2Ugb3JkZXIpIG9mIHRoZSBxdWV1ZS4KKyAg
ICAgKgorICAgICAqIFF1ZXVlZCBIZWFkIChJUUgpIGFuZCBRdWV1ZSBUYWls
IChJUVQpIHJlZ2lzdGVycyBhcmUgYXV0b21hdGljYWxseQorICAgICAqIHJl
c2V0IHRvIDAgd2l0aCB3cml0ZSB0byBJUUEgcmVnaXN0ZXIuCiAgICAgICov
CiAgICAgZG1hcl93cml0ZXEoaW9tbXUtPnJlZywgRE1BUl9JUUFfUkVHLAot
ICAgICAgICAgICAgICAgIHFpX2N0cmwtPnFpbnZhbF9tYWRkciB8IFFJTlZB
TF9QQUdFX09SREVSKTsKKyAgICAgICAgICAgICAgICBxaV9jdHJsLT5xaW52
YWxfbWFkZHIgfCBxaV9wZ19vcmRlcik7CiAKICAgICBkbWFyX3dyaXRlcShp
b21tdS0+cmVnLCBETUFSX0lRVF9SRUcsIDApOwogCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.12-2.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.12-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHNpemUgY29tbWFuZCBidWZmZXIgZHluYW1pY2FsbHkK
CldpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9kZWwsIHdlIG5lZWQg
dHdvIHNsb3RzIGZvciBldmVyeQpvcGVyYXRpb24gKHRoZSBvcGVyYXRpb24g
aXRzZWxmIGFuZCBhIHdhaXQgY29tbWFuZCkuICBUaGVyZSBjYW4gYmUgb25l
CnN1Y2ggcGFpciBvZiBjb21tYW5kcyBwZW5kaW5nIHBlciBDUFUuIFRvIGVu
c3VyZSB0aGF0IHVuZGVyIGFsbCBub3JtYWwKY2lyY3Vtc3RhbmNlcyBhIHNs
b3QgaXMgYWx3YXlzIGF2YWlsYWJsZSB3aGVuIG9uZSBpcyByZXF1ZXN0ZWQs
IHNpemUgdGhlCmNvbW1hbmQgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJl
ciBvZiBwcmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAv
IENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50
IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0zNSw4ICszNSw4IEBAIHN0YXRpYyBp
bnQgcXVldWVfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW0KICAgICBpZiAoIGhl
YWQgIT0gdGFpbCApCiAgICAgewogICAgICAgICBtZW1jcHkoaW9tbXUtPmNt
ZF9idWZmZXIuYnVmZmVyICsKLSAgICAgICAgICAgICAgIChpb21tdS0+Y21k
X2J1ZmZlci50YWlsICogSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9TSVpFKSwK
LSAgICAgICAgICAgICAgIGNtZCwgSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9T
SVpFKTsKKyAgICAgICAgICAgICAgIChpb21tdS0+Y21kX2J1ZmZlci50YWls
ICogc2l6ZW9mKGNtZF9lbnRyeV90KSksCisgICAgICAgICAgICAgICBjbWQs
IHNpemVvZihjbWRfZW50cnlfdCkpOwogCiAgICAgICAgIGlvbW11LT5jbWRf
YnVmZmVyLnRhaWwgPSB0YWlsOwogICAgICAgICByZXR1cm4gMTsKLS0tIGEv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYworKysg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCkBA
IC0xMzYsNyArMTM2LDcgQEAgc3RhdGljIHZvaWQgcmVnaXN0ZXJfaW9tbXVf
Y21kX2J1ZmZlcl9pbgogICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9f
YmFzZSArIElPTU1VX0NNRF9CVUZGRVJfQkFTRV9MT1dfT0ZGU0VUKTsKIAog
ICAgIHBvd2VyX29mMl9lbnRyaWVzID0gZ2V0X29yZGVyX2Zyb21fYnl0ZXMo
aW9tbXUtPmNtZF9idWZmZXIuYWxsb2Nfc2l6ZSkgKwotICAgICAgICBJT01N
VV9DTURfQlVGRkVSX1BPV0VSX09GMl9FTlRSSUVTX1BFUl9QQUdFOworICAg
ICAgICBQQUdFX1NISUZUIC0gSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9PUkRF
UjsKIAogICAgIGVudHJ5ID0gMDsKICAgICBpb21tdV9zZXRfYWRkcl9oaV90
b19yZWcoJmVudHJ5LCBhZGRyX2hpKTsKQEAgLTEwMDAsOSArMTAwMCwzMSBA
QCBzdGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0ZV9yaW5nX2J1ZmZlCiBz
dGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0ZV9jbWRfYnVmZmVyKHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11KQogewogICAgIC8qIGFsbG9jYXRlICdjb21t
YW5kIGJ1ZmZlcicgaW4gcG93ZXIgb2YgMiBpbmNyZW1lbnRzIG9mIDRLICov
CisgICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IG5yX2Vu
dHM7CisKKyAgICBpZiAoICFucl9lbnRzICkKKyAgICB7CisgICAgICAgIHVu
c2lnbmVkIGludCBvcmRlcjsKKworICAgICAgICAvKgorICAgICAgICAgKiBX
aXRoIHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1vZGVsLCB3ZSBuZWVkIHR3
byBzbG90cyBmb3IgZXZlcnkKKyAgICAgICAgICogb3BlcmF0aW9uICh0aGUg
b3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0IGNvbW1hbmQpLiAgVGhlcmUg
Y2FuIGJlCisgICAgICAgICAqIG9uZSBzdWNoIHBhaXIgb2YgcmVxdWVzdHMg
cGVuZGluZyBwZXIgQ1BVLiAgT25lIGV4dHJhIGVudHJ5IGlzCisgICAgICAg
ICAqIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25zaWRlcmVkIGZ1bGwgd2hl
biB0aGVyZSdzIG9ubHkgb25lIGVudHJ5CisgICAgICAgICAqIGxlZnQuCisg
ICAgICAgICAqLworICAgICAgICBCVUlMRF9CVUdfT04oQ09ORklHX05SX0NQ
VVMgKiAyID49IElPTU1VX0NNRF9CVUZGRVJfTUFYX0VOVFJJRVMpOworICAg
ICAgICBvcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5dGVzKChudW1fcHJlc2Vu
dF9jcHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSKTsK
KyAgICAgICAgbnJfZW50cyA9IDF1IDw8IChvcmRlciArIFBBR0VfU0hJRlQg
LSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSKTsKKworICAgICAgICBB
TURfSU9NTVVfREVCVUcoInVzaW5nICV1LWVudHJ5IGNtZCByaW5nKHMpXG4i
LCBucl9lbnRzKTsKKyAgICB9CisKKyAgICBCVUlMRF9CVUdfT04oc2l6ZW9m
KGNtZF9lbnRyeV90KSAhPSAoMXUgPDwgSU9NTVVfQ01EX0JVRkZFUl9FTlRS
WV9PUkRFUikpOworCiAgICAgcmV0dXJuIGFsbG9jYXRlX3JpbmdfYnVmZmVy
KCZpb21tdS0+Y21kX2J1ZmZlciwgc2l6ZW9mKGNtZF9lbnRyeV90KSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfQ01EX0JVRkZF
Ul9ERUZBVUxUX0VOVFJJRVMsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICJDb21tYW5kIEJ1ZmZlciIpOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBucl9lbnRzLCAiQ29tbWFuZCBCdWZmZXIiKTsKIH0K
IAogc3RhdGljIHZvaWQgKiBfX2luaXQgYWxsb2NhdGVfZXZlbnRfbG9nKHN0
cnVjdCBhbWRfaW9tbXUgKmlvbW11KQotLS0gYS94ZW4vaW5jbHVkZS9hc20t
eDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMuaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMuaApAQCAtMjAsOSAr
MjAsNiBAQAogI2lmbmRlZiBfQVNNX1g4Nl82NF9BTURfSU9NTVVfREVGU19I
CiAjZGVmaW5lIF9BU01fWDg2XzY0X0FNRF9JT01NVV9ERUZTX0gKIAotLyog
SU9NTVUgQ29tbWFuZCBCdWZmZXIgZW50cmllczogaW4gcG93ZXIgb2YgMiBp
bmNyZW1lbnRzLCBtaW5pbXVtIG9mIDI1NiAqLwotI2RlZmluZSBJT01NVV9D
TURfQlVGRkVSX0RFRkFVTFRfRU5UUklFUwk1MTIKLQogLyogSU9NTVUgRXZl
bnQgTG9nIGVudHJpZXM6IGluIHBvd2VyIG9mIDIgaW5jcmVtZW50cywgbWlu
aW11bSBvZiAyNTYgKi8KICNkZWZpbmUgSU9NTVVfRVZFTlRfTE9HX0RFRkFV
TFRfRU5UUklFUyAgICAgNTEyCiAKQEAgLTE4NCw4ICsxODEsOCBAQAogI2Rl
ZmluZSBJT01NVV9DTURfQlVGRkVSX0xFTkdUSF9NQVNLCQkweDBGMDAwMDAw
CiAjZGVmaW5lIElPTU1VX0NNRF9CVUZGRVJfTEVOR1RIX1NISUZUCQkyNAog
Ci0jZGVmaW5lIElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRQkJCTE2Ci0j
ZGVmaW5lIElPTU1VX0NNRF9CVUZGRVJfUE9XRVJfT0YyX0VOVFJJRVNfUEVS
X1BBR0UJOAorI2RlZmluZSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVS
ICAgICAgICAgICAgNAorI2RlZmluZSBJT01NVV9DTURfQlVGRkVSX01BWF9F
TlRSSUVTICAgICAgICAgICAgKDF1IDw8IDE1KQogCiAjZGVmaW5lIElPTU1V
X0NNRF9PUENPREVfTUFTSwkJCTB4RjAwMDAwMDAKICNkZWZpbmUgSU9NTVVf
Q01EX09QQ09ERV9TSElGVAkJCTI4Cg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.12-3.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.12-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBlbGltaW5hdGUgZmx1c2ggcmVsYXRlZCB0aW1lb3V0cwoKTGVh
dmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24gcGVuZGluZyB3aGVuIGl0
IGFwcGVhcnMgdG8gdGFrZSB0b28KbG9uZyBpcyBwcm9ibGVtYXRpYzogSWYg
ZS5nLiBhIFFJIGNvbW1hbmQgY29tcGxldGVkIGxhdGVyLCB0aGUgd3JpdGUg
dG8KdGhlICJwb2xsIHNsb3QiIG1heSBpbnN0ZWFkIGJlIHVuZGVyc3Rvb2Qg
dG8gc2lnbmFsIGEgc3Vic2VxdWVudGx5CnN0YXJ0ZWQgY29tbWFuZCdzIGNv
bXBsZXRpb24uIEFsc28gb3VyIGFjY291bnRpbmcgb2YgdGhlIHRpbWVvdXQg
cGVyaW9kCndhcyBhY3R1YWxseSB3cm9uZzogV2UgaW5jbHVkZWQgdGhlIHRp
bWUgaXQgdG9vayBmb3IgdGhlIGNvbW1hbmQgdG8KYWN0dWFsbHkgbWFrZSBp
dCB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLCB3aGljaCBjb3VsZCBiZSBo
ZWF2aWx5CmFmZmVjdGVkIGJ5IGd1ZXN0cyBvdGhlciB0aGFuIHRoZSBvbmUg
Zm9yIHdoaWNoIHRoZSBmbHVzaCBpcyBiZWluZwpwZXJmb3JtZWQuCgpEbyBh
d2F5IHdpdGggYWxsIHRpbWVvdXQgZGV0ZWN0aW9uIG9uIGFsbCBmbHVzaCBy
ZWxhdGVkIGNvZGUgcGF0aHMuCkxvZyBleGNlc3NpdmVseSBsb25nIHByb2Nl
c3NpbmcgdGltZXMgKHdpdGggYSBwcm9ncmVzc2l2ZSB0aHJlc2hvbGQpIHRv
CmhhdmUgc29tZSBpbmRpY2F0aW9uIG9mIHByb2JsZW1zIGluIHRoaXMgYXJl
YS4KCkFkZGl0aW9uYWxseSBsb2cgKG9uY2UpIGlmIHFpbnZhbF9uZXh0X2lu
ZGV4KCkgZGlkbid0IGltbWVkaWF0ZWx5IGZpbmQKYW4gYXZhaWxhYmxlIHNs
b3QuIFRvZ2V0aGVyIHdpdGggdGhlIGVhcmxpZXIgY2hhbmdlIHNpemluZyB0
aGUgcXVldWUocykKZHluYW1pY2FsbHksIHdlIHNob3VsZCBub3cgaGF2ZSBh
IGd1YXJhbnRlZSB0aGF0IHdpdGggb3VyIGZ1bGx5CnN5bmNocm9ub3VzIG1v
ZGVsIGFueSBkZW1hbmQgZm9yIHNsb3RzIGNhbiBhY3R1YWxseSBiZSBzYXRp
c2ZpZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4
NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5v
cmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZG1hci5o
CisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmgKQEAg
LTEyNyw2ICsxMjcsMzQgQEAgZG8gewogICAgIH0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
IH0gd2hpbGUgKDApCiAKKyNkZWZpbmUgSU9NTVVfRkxVU0hfV0FJVCh3aGF0
LCBpb21tdSwgb2Zmc2V0LCBvcCwgY29uZCwgc3RzKSAgICAgICBcCitkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
X19yZWFkX21vc3RseSB0aHJlc2hvbGQgPSAxOyAgICAgICAgICAgICAgIFwK
KyAgICBzX3RpbWVfdCBzdGFydCA9IE5PVygpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgc190aW1lX3QgdGltZW91
dCA9IHN0YXJ0ICsgRE1BUl9PUEVSQVRJT05fVElNRU9VVCAqIHRocmVzaG9s
ZDsgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCA7IDsg
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBz
dHMgPSBvcChpb21tdS0+cmVnLCBvZmZzZXQpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBjb25kICkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICBpZiAoIHRpbWVvdXQgJiYg
Tk9XKCkgPiB0aW1lb3V0ICkgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICB0aHJlc2hv
bGQgfD0gdGhyZXNob2xkIDw8IDE7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBS
RUZJWCAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAiIElPTU1VIyV1OiAlcyBmbHVzaCB0YWtpbmcgdG9vIGxvbmdcbiIs
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCB3
aGF0KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgdGltZW91dCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgfSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgIGNwdV9yZWxheCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIH0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgaWYgKCAhdGltZW91dCAp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklY
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICIgSU9NTVUjJXU6ICVzIGZsdXNoIHRvb2sgJWx1bXNcbiIsICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIHdoYXQs
IChOT1coKSAtIHN0YXJ0KSAvIDEwMDAwMDAwKTsgICAgXAorfSB3aGlsZSAo
IGZhbHNlICkKKwogaW50IHZ0ZF9od19jaGVjayh2b2lkKTsKIHZvaWQgZGlz
YWJsZV9wbXIoc3RydWN0IGlvbW11ICppb21tdSk7CiBpbnQgaXNfaWdkX2Ry
aGQoc3RydWN0IGFjcGlfZHJoZF91bml0ICpkcmhkKTsKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKKysrIGIveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvdnRkL2lvbW11LmMKQEAgLTM1Nyw4ICszNTcsOCBA
QCBzdGF0aWMgdm9pZCBpb21tdV9mbHVzaF93cml0ZV9idWZmZXIoc3RyCiAg
ICAgZG1hcl93cml0ZWwoaW9tbXUtPnJlZywgRE1BUl9HQ01EX1JFRywgdmFs
IHwgRE1BX0dDTURfV0JGKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBoYXJkd2Fy
ZSBjb21wbGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9tbXUsIERN
QVJfR1NUU19SRUcsIGRtYXJfcmVhZGwsCi0gICAgICAgICAgICAgICAgICAh
KHZhbCAmIERNQV9HU1RTX1dCRlMpLCB2YWwpOworICAgIElPTU1VX0ZMVVNI
X1dBSVQoIndyaXRlIGJ1ZmZlciIsIGlvbW11LCBETUFSX0dTVFNfUkVHLCBk
bWFyX3JlYWRsLAorICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBETUFf
R1NUU19XQkZTKSwgdmFsKTsKIAogICAgIHNwaW5fdW5sb2NrX2lycXJlc3Rv
cmUoJmlvbW11LT5yZWdpc3Rlcl9sb2NrLCBmbGFncyk7CiB9CkBAIC00MDgs
OCArNDA4LDggQEAgaW50IHZ0ZF9mbHVzaF9jb250ZXh0X3JlZyh2b2lkICpf
aW9tbXUsCiAgICAgZG1hcl93cml0ZXEoaW9tbXUtPnJlZywgRE1BUl9DQ01E
X1JFRywgdmFsKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBoYXJkd2FyZSBjb21w
bGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9tbXUsIERNQVJfQ0NN
RF9SRUcsIGRtYXJfcmVhZHEsCi0gICAgICAgICAgICAgICAgICAhKHZhbCAm
IERNQV9DQ01EX0lDQyksIHZhbCk7CisgICAgSU9NTVVfRkxVU0hfV0FJVCgi
Y29udGV4dCIsIGlvbW11LCBETUFSX0NDTURfUkVHLCBkbWFyX3JlYWRxLAor
ICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBETUFfQ0NNRF9JQ0MpLCB2
YWwpOwogCiAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPnJl
Z2lzdGVyX2xvY2ssIGZsYWdzKTsKICAgICAvKiBmbHVzaCBjb250ZXh0IGVu
dHJ5IHdpbGwgaW1wbGljaXRseSBmbHVzaCB3cml0ZSBidWZmZXIgKi8KQEAg
LTQ5MSw4ICs0OTEsOCBAQCBpbnQgdnRkX2ZsdXNoX2lvdGxiX3JlZyh2b2lk
ICpfaW9tbXUsIHVpCiAgICAgZG1hcl93cml0ZXEoaW9tbXUtPnJlZywgdGxi
X29mZnNldCArIDgsIHZhbCk7CiAKICAgICAvKiBNYWtlIHN1cmUgaGFyZHdh
cmUgY29tcGxldGUgaXQgKi8KLSAgICBJT01NVV9XQUlUX09QKGlvbW11LCAo
dGxiX29mZnNldCArIDgpLCBkbWFyX3JlYWRxLAotICAgICAgICAgICAgICAg
ICAgISh2YWwgJiBETUFfVExCX0lWVCksIHZhbCk7CisgICAgSU9NTVVfRkxV
U0hfV0FJVCgiaW90bGIiLCBpb21tdSwgKHRsYl9vZmZzZXQgKyA4KSwgZG1h
cl9yZWFkcSwKKyAgICAgICAgICAgICAgICAgICAgICEodmFsICYgRE1BX1RM
Ql9JVlQpLCB2YWwpOwogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlv
bW11LT5yZWdpc3Rlcl9sb2NrLCBmbGFncyk7CiAKICAgICAvKiBjaGVjayBJ
T1RMQiBpbnZhbGlkYXRpb24gZ3JhbnVsYXJpdHkgKi8KLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMjksOCArMjksNiBA
QAogI2luY2x1ZGUgImV4dGVybi5oIgogI2luY2x1ZGUgIi4uL2F0cy5oIgog
Ci0jZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKLQogc3RhdGljIHVuc2lnbmVk
IGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOwogc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOwogCkBAIC02MCw3
ICs1OCwxMSBAQCBzdGF0aWMgdW5zaWduZWQgaW50IHFpbnZhbF9uZXh0X2lu
ZGV4KHN0CiAgICAgLyogKHRhaWwrMSA9PSBoZWFkKSBpbmRpY2F0ZXMgYSBm
dWxsIHF1ZXVlLCB3YWl0IGZvciBIVyAqLwogICAgIHdoaWxlICggKCh0YWls
ICsgMSkgJiAocWlfZW50cnlfbnIgLSAxKSkgPT0KICAgICAgICAgICAgICgg
ZG1hcl9yZWFkcShpb21tdS0+cmVnLCBETUFSX0lRSF9SRUcpID4+IFFJTlZB
TF9JTkRFWF9TSElGVCApICkKKyAgICB7CisgICAgICAgIHByaW50a19vbmNl
KFhFTkxPR19FUlIgVlREUFJFRklYICIgSU9NTVUjJXU6IG5vIFFJIHNsb3Qg
YXZhaWxhYmxlXG4iLAorICAgICAgICAgICAgICAgICAgICBpb21tdS0+aW5k
ZXgpOwogICAgICAgICBjcHVfcmVsYXgoKTsKKyAgICB9CiAKICAgICByZXR1
cm4gdGFpbDsKIH0KQEAgLTE4MCwyMyArMTgyLDMyIEBAIHN0YXRpYyBpbnQg
X19tdXN0X2NoZWNrIHF1ZXVlX2ludmFsaWRhdGUKICAgICAvKiBOb3cgd2Ug
ZG9uJ3Qgc3VwcG9ydCBpbnRlcnJ1cHQgbWV0aG9kICovCiAgICAgaWYgKCBz
dyApCiAgICAgewotICAgICAgICBzX3RpbWVfdCB0aW1lb3V0OwotCi0gICAg
ICAgIC8qIEluIGNhc2UgYWxsIHdhaXQgZGVzY3JpcHRvciB3cml0ZXMgdG8g
c2FtZSBhZGRyIHdpdGggc2FtZSBkYXRhICovCi0gICAgICAgIHRpbWVvdXQg
PSBOT1coKSArIE1JTExJU0VDUyhmbHVzaF9kZXZfaW90bGIgPwotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9tbXVfZGV2X2lvdGxi
X3RpbWVvdXQgOiBWVERfUUlfVElNRU9VVCk7CisgICAgICAgIHN0YXRpYyB1
bnNpZ25lZCBpbnQgX19yZWFkX21vc3RseSB0aHJlc2hvbGQgPSAxOworICAg
ICAgICBzX3RpbWVfdCBzdGFydCA9IE5PVygpOworICAgICAgICBzX3RpbWVf
dCB0aW1lb3V0ID0gc3RhcnQgKyAoZmx1c2hfZGV2X2lvdGxiCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGlvbW11X2Rldl9pb3Rs
Yl90aW1lb3V0CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICA6IDEwMCkgKiBNSUxMSVNFQ1ModGhyZXNob2xkKTsKIAogICAgICAgICB3
aGlsZSAoIEFDQ0VTU19PTkNFKCp0aGlzX3BvbGxfc2xvdCkgIT0gUUlOVkFM
X1NUQVRfRE9ORSApCiAgICAgICAgIHsKLSAgICAgICAgICAgIGlmICggTk9X
KCkgPiB0aW1lb3V0ICkKKyAgICAgICAgICAgIGlmICggdGltZW91dCAmJiBO
T1coKSA+IHRpbWVvdXQgKQogICAgICAgICAgICAgewotICAgICAgICAgICAg
ICAgIHByaW50X3FpX3JlZ3MoaW9tbXUpOworICAgICAgICAgICAgICAgIHRo
cmVzaG9sZCB8PSB0aHJlc2hvbGQgPDwgMTsKICAgICAgICAgICAgICAgICBw
cmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklYCi0gICAgICAgICAgICAg
ICAgICAgICAgICIgUXVldWUgaW52YWxpZGF0ZSB3YWl0IGRlc2NyaXB0b3Ig
dGltZWQgb3V0XG4iKTsKLSAgICAgICAgICAgICAgICByZXR1cm4gLUVUSU1F
RE9VVDsKKyAgICAgICAgICAgICAgICAgICAgICAgIiBJT01NVSMldTogUUkl
cyB3YWl0IGRlc2NyaXB0b3IgdGFraW5nIHRvbyBsb25nXG4iLAorICAgICAg
ICAgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIGZsdXNoX2Rldl9pb3Rs
YiA/ICIgZGV2IiA6ICIiKTsKKyAgICAgICAgICAgICAgICBwcmludF9xaV9y
ZWdzKGlvbW11KTsKKyAgICAgICAgICAgICAgICB0aW1lb3V0ID0gMDsKICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgIGNwdV9yZWxheCgpOwogICAgICAg
ICB9CisKKyAgICAgICAgaWYgKCAhdGltZW91dCApCisgICAgICAgICAgICBw
cmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklYCisgICAgICAgICAgICAg
ICAgICAgIiBJT01NVSMldTogUUklcyB3YWl0IGRlc2NyaXB0b3IgdG9vayAl
bHVtc1xuIiwKKyAgICAgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIGZs
dXNoX2Rldl9pb3RsYiA/ICIgZGV2IiA6ICIiLAorICAgICAgICAgICAgICAg
ICAgIChOT1coKSAtIHN0YXJ0KSAvIDEwMDAwMDAwKTsKKwogICAgICAgICBy
ZXR1cm4gMDsKICAgICB9CiAK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.12-4.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.12-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHdhaXQgZm9yIGNvbW1hbmQgc2xvdCB0byBiZSBhdmFp
bGFibGUKCk5vIGNhbGxlciBjYXJlZCBhYm91dCBzZW5kX2lvbW11X2NvbW1h
bmQoKSBpbmRpY2F0aW5nIHVuYXZhaWxhYmlsaXR5IG9mCmEgc2xvdC4gSGVu
Y2UgaWYgYSBzdWZmaWNpZW50IG51bWJlciBwcmlvciBjb21tYW5kcyB0aW1l
ZCBvdXQsIHdlIGRpZApibGluZGx5IGFzc3VtZSB0aGF0IHRoZSByZXF1ZXN0
ZWQgY29tbWFuZCB3YXMgc3VibWl0dGVkIHRvIHRoZSBJT01NVQp3aGVuIHJl
YWxseSBpdCB3YXNuJ3QuIFRoaXMgY291bGQgbWVhbiBib3RoIGEgaGFuZ2lu
ZyBzeXN0ZW0gKHdhaXRpbmcKZm9yIGEgY29tbWFuZCB0byBjb21wbGV0ZSB0
aGF0IHdhcyBuZXZlciBzZWVuIGJ5IHRoZSBJT01NVSkgb3IgYmxpbmRseQpw
cm9wYWdhdGluZyBzdWNjZXNzIGJhY2sgdG8gY2FsbGVycywgbWFraW5nIHRo
ZW0gYmVsaWV2ZSB0aGV5J3JlIGZpbmUKdG8gZS5nLiBmcmVlIHByZXZpb3Vz
bHkgdW5tYXBwZWQgcGFnZXMuCgpGb2xkIHRoZSB0aHJlZSBpbnZvbHZlZCBm
dW5jdGlvbnMgaW50byBvbmUsIGFkZCBzcGluIHdhaXRpbmcgZm9yIGFuCmF2
YWlsYWJsZSBzbG90IGFsb25nIHRoZSBsaW5lcyBvZiBWVC1kJ3MgcWludmFs
X25leHRfaW5kZXgoKSwgYW5kIGFzIGEKY29uc2VxdWVuY2UgZHJvcCBhbGwg
ZXJyb3IgaW5kaWNhdG9yIHJldHVybiB0eXBlcy92YWx1ZXMuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yMiw0
OCArMjIsMzYgQEAKICNpbmNsdWRlIDxhc20vaHZtL3N2bS9hbWQtaW9tbXUt
cHJvdG8uaD4KICNpbmNsdWRlICIuLi9hdHMuaCIKIAotc3RhdGljIGludCBx
dWV1ZV9pb21tdV9jb21tYW5kKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1
MzIgY21kW10pCitzdGF0aWMgdm9pZCBzZW5kX2lvbW11X2NvbW1hbmQoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgdWludDMyX3QgY21kWzRdKQogewotICAgIHVpbnQz
Ml90IHRhaWwsIGhlYWQ7CisgICAgdWludDMyX3QgdGFpbDsKIAogICAgIHRh
aWwgPSBpb21tdS0+Y21kX2J1ZmZlci50YWlsOwogICAgIGlmICggKyt0YWls
ID09IGlvbW11LT5jbWRfYnVmZmVyLmVudHJpZXMgKQogICAgICAgICB0YWls
ID0gMDsKIAotICAgIGhlYWQgPSBpb21tdV9nZXRfcmJfcG9pbnRlcihyZWFk
bChpb21tdS0+bW1pb19iYXNlICsKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU9NTVVfQ01EX0JVRkZFUl9IRUFEX09GRlNFVCkp
OwotICAgIGlmICggaGVhZCAhPSB0YWlsICkKKyAgICB3aGlsZSAoIHRhaWwg
PT0gaW9tbXVfZ2V0X3JiX3BvaW50ZXIocmVhZGwoaW9tbXUtPm1taW9fYmFz
ZSArCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpKSApCiAgICAg
ewotICAgICAgICBtZW1jcHkoaW9tbXUtPmNtZF9idWZmZXIuYnVmZmVyICsK
LSAgICAgICAgICAgICAgIChpb21tdS0+Y21kX2J1ZmZlci50YWlsICogc2l6
ZW9mKGNtZF9lbnRyeV90KSksCi0gICAgICAgICAgICAgICBjbWQsIHNpemVv
ZihjbWRfZW50cnlfdCkpOwotCi0gICAgICAgIGlvbW11LT5jbWRfYnVmZmVy
LnRhaWwgPSB0YWlsOwotICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgcHJp
bnRrX29uY2UoWEVOTE9HX0VSUgorICAgICAgICAgICAgICAgICAgICAiQU1E
IElPTU1VICUwNHg6JTAyeDolMDJ4LiV1OiBubyBjbWQgc2xvdCBhdmFpbGFi
bGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11LT5zZWcsIFBDSV9C
VVMoaW9tbXUtPmJkZiksCisgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9U
KGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSk7CisgICAgICAg
IGNwdV9yZWxheCgpOwogICAgIH0KIAotICAgIHJldHVybiAwOwotfQorICAg
IG1lbWNweShpb21tdS0+Y21kX2J1ZmZlci5idWZmZXIgKworICAgICAgICAg
ICAoaW9tbXUtPmNtZF9idWZmZXIudGFpbCAqIHNpemVvZihjbWRfZW50cnlf
dCkpLAorICAgICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwog
Ci1zdGF0aWMgdm9pZCBjb21taXRfaW9tbXVfY29tbWFuZF9idWZmZXIoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUpCi17Ci0gICAgdTMyIHRhaWwgPSAwOwor
ICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWlsOwogCisgICAgdGFp
bCA9IDA7CiAgICAgaW9tbXVfc2V0X3JiX3BvaW50ZXIoJnRhaWwsIGlvbW11
LT5jbWRfYnVmZmVyLnRhaWwpOwogICAgIHdyaXRlbCh0YWlsLCBpb21tdS0+
bW1pb19iYXNlK0lPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZTRVQpOwogfQog
Ci1pbnQgc2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11LCB1MzIgY21kW10pCi17Ci0gICAgaWYgKCBxdWV1ZV9pb21tdV9jb21t
YW5kKGlvbW11LCBjbWQpICkKLSAgICB7Ci0gICAgICAgIGNvbW1pdF9pb21t
dV9jb21tYW5kX2J1ZmZlcihpb21tdSk7Ci0gICAgICAgIHJldHVybiAxOwot
ICAgIH0KLQotICAgIHJldHVybiAwOwotfQotCiBzdGF0aWMgdm9pZCBmbHVz
aF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKIHsK
ICAgICB1MzIgY21kWzRdLCBzdGF0dXM7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.12-5.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.12-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRyb3AgY29tbWFuZCBjb21wbGV0aW9uIHRpbWVvdXQK
CkZpcnN0IGFuZCBmb3JlbW9zdCAtIHN1Y2ggdGltZW91dHMgd2VyZSBub3Qg
c2lnbmFsZWQgdG8gY2FsbGVycywgbWFraW5nCnRoZW0gYmVsaWV2ZSB0aGV5
J3JlIGZpbmUgdG8gZS5nLiBmcmVlIHByZXZpb3VzbHkgdW5tYXBwZWQgcGFn
ZXMuCgpNaXJyb3IgVlQtZCdzIGJlaGF2aW9yOiBBIGZpeGVkIG51bWJlciBv
ZiBsb29wIGl0ZXJhdGlvbnMgaXMgbm90IGEKc3VpdGFibGUgd2F5IHRvIGRl
dGVjdCB0aW1lb3V0cyBpbiBhbiBlbnZpcm9ubWVudCAoQ1BVIGFuZCBidXMg
c3BlZWRzKQppbmRlcGVuZGVudCBtYW5uZXIgYW55d2F5LiBGdXJ0aGVybW9y
ZSwgbGVhdmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24KcGVuZGluZyB3
aGVuIGl0IGFwcGVhcnMgdG8gdGFrZSB0b28gbG9uZyBpcyBwcm9ibGVtYXRp
YzogSWYgYSBjb21tYW5kCmNvbXBsZXRlZCBsYXRlciwgdGhlIHNpZ25hbGlu
ZyBvZiBpdHMgY29tcGxldGlvbiBtYXkgaW5zdGVhZCBiZQp1bmRlcnN0b29k
IHRvIHNpZ25hbCBhIHN1YnNlcXVlbnRseSBzdGFydGVkIGNvbW1hbmQncyBj
b21wbGV0aW9uLgoKTG9nIGV4Y2Vzc2l2ZWx5IGxvbmcgcHJvY2Vzc2luZyB0
aW1lcyAod2l0aCBhIHByb2dyZXNzaXZlIHRocmVzaG9sZCkgdG8KaGF2ZSBz
b21lIGluZGljYXRpb24gb2YgcHJvYmxlbXMgaW4gdGhpcyBhcmVhLiBBbGxv
dyBjYWxsZXJzIHRvIHNwZWNpZnkKYSBub24tZGVmYXVsdCB0aW1lb3V0IGJp
YXMgZm9yIHRoaXMgbG9nZ2luZywgdXNpbmcgdGhlIHNhbWUgdmFsdWVzIGFz
ClZULWQgZG9lcywgd2hpY2ggaW4gcGFydGljdWxhciBtZWFucyBhIChieSBk
ZWZhdWx0KSBtdWNoIGxhcmdlciB2YWx1ZQpmb3IgZGV2aWNlIElPIFRMQiBp
bnZhbGlkYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2NtZC5jCkBAIC01MiwxMCArNTIsMTIgQEAgc3RhdGljIHZvaWQg
c2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbQogICAgIHdyaXRlbCh0YWls
LCBpb21tdS0+bW1pb19iYXNlK0lPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZT
RVQpOwogfQogCi1zdGF0aWMgdm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKK3N0YXRpYyB2b2lkIGZsdXNoX2Nv
bW1hbmRfYnVmZmVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHRpbWVv
dXRfYmFzZSkKIHsKLSAgICB1MzIgY21kWzRdLCBzdGF0dXM7Ci0gICAgaW50
IGxvb3BfY291bnQsIGNvbXBfd2FpdDsKKyAgICB1aW50MzJfdCBjbWRbNF07
CisgICAgc190aW1lX3Qgc3RhcnQsIHRpbWVvdXQ7CisgICAgc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7CiAKICAg
ICAvKiBSVzFDICdDb21XYWl0SW50JyBpbiBzdGF0dXMgcmVnaXN0ZXIgKi8K
ICAgICB3cml0ZWwoSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRfTUFTSywK
QEAgLTcxLDI0ICs3MywzMSBAQCBzdGF0aWMgdm9pZCBmbHVzaF9jb21tYW5k
X2J1ZmZlcihzdHJ1Y3QKICAgICAgICAgICAgICAgICAgICAgICAgICBJT01N
VV9DT01QX1dBSVRfSV9GTEFHX1NISUZULCAmY21kWzBdKTsKICAgICBzZW5k
X2lvbW11X2NvbW1hbmQoaW9tbXUsIGNtZCk7CiAKLSAgICAvKiBNYWtlIGxv
b3BfY291bnQgbG9uZyBlbm91Z2ggZm9yIHBvbGxpbmcgY29tcGxldGlvbiB3
YWl0IGJpdCAqLwotICAgIGxvb3BfY291bnQgPSAxMDAwOwotICAgIGRvIHsK
LSAgICAgICAgc3RhdHVzID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0gICAgICAgIGNvbXBfd2FpdCA9
IGdldF9maWVsZF9mcm9tX3JlZ191MzIoc3RhdHVzLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1NUQVRVU19D
T01QX1dBSVRfSU5UX01BU0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRf
U0hJRlQpOwotICAgICAgICAtLWxvb3BfY291bnQ7Ci0gICAgfSB3aGlsZSAo
ICFjb21wX3dhaXQgJiYgbG9vcF9jb3VudCApOwotCi0gICAgaWYgKCBjb21w
X3dhaXQgKQorICAgIHN0YXJ0ID0gTk9XKCk7CisgICAgdGltZW91dCA9IHN0
YXJ0ICsgKHRpbWVvdXRfYmFzZSA/OiAxMDApICogTUlMTElTRUNTKHRocmVz
aG9sZCk7CisgICAgd2hpbGUgKCAhKHJlYWRsKGlvbW11LT5tbWlvX2Jhc2Ug
KyBJT01NVV9TVEFUVVNfTU1JT19PRkZTRVQpICYKKyAgICAgICAgICAgICAg
SU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRfTUFTSykgKQogICAgIHsKLSAg
ICAgICAgLyogUlcxQyAnQ29tV2FpdEludCcgaW4gc3RhdHVzIHJlZ2lzdGVy
ICovCi0gICAgICAgIHdyaXRlbChJT01NVV9TVEFUVVNfQ09NUF9XQUlUX0lO
VF9NQVNLLAotICAgICAgICAgICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0gICAgICAgIHJldHVybjsKKyAg
ICAgICAgaWYgKCB0aW1lb3V0ICYmIE5PVygpID4gdGltZW91dCApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIHRocmVzaG9sZCB8PSB0aHJlc2hvbGQgPDwg
MTsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORworICAgICAg
ICAgICAgICAgICAgICJBTUQgSU9NTVUgJTA0eDolMDJ4OiUwMnguJXU6ICVz
Y29tcGxldGlvbiB3YWl0IHRha2luZyB0b28gbG9uZ1xuIiwKKyAgICAgICAg
ICAgICAgICAgICBpb21tdS0+c2VnLCBQQ0lfQlVTKGlvbW11LT5iZGYpLAor
ICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQQ0lf
RlVOQyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgICAgICB0aW1lb3V0
X2Jhc2UgPyAiaW90bGIgIiA6ICIiKTsKKyAgICAgICAgICAgIHRpbWVvdXQg
PSAwOworICAgICAgICB9CisgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0K
LSAgICBBTURfSU9NTVVfREVCVUcoIldhcm5pbmc6IENvbVdhaXRJbnQgYml0
IGRpZCBub3QgYXNzZXJ0IVxuIik7CisKKyAgICBpZiAoICF0aW1lb3V0ICkK
KyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HCisgICAgICAgICAgICAg
ICAiQU1EIElPTU1VICUwNHg6JTAyeDolMDJ4LiV1OiAlc2NvbXBsZXRpb24g
d2FpdCB0b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgaW9tbXUtPnNl
ZywgUENJX0JVUyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgIFBDSV9T
TE9UKGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSwKKyAgICAg
ICAgICAgICAgIHRpbWVvdXRfYmFzZSA/ICJpb3RsYiAiIDogIiIsCisgICAg
ICAgICAgICAgICAoTk9XKCkgLSBzdGFydCkgLyAxMDAwMDAwMCk7CiB9CiAK
IC8qIEJ1aWxkIGxvdyBsZXZlbCBpb21tdSBjb21tYW5kIG1lc3NhZ2VzICov
CkBAIC0zMDAsNyArMzA5LDcgQEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW90
bGIodTggZGV2Zm4sIGNvbgogICAgIC8qIHNlbmQgSU5WQUxJREFURV9JT1RM
Ql9QQUdFUyBjb21tYW5kICovCiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlv
bW11LT5sb2NrLCBmbGFncyk7CiAgICAgaW52YWxpZGF0ZV9pb3RsYl9wYWdl
cyhpb21tdSwgbWF4cGVuZCwgMCwgcXVldWVpZCwgZGFkZHIsIHJlcV9pZCwg
b3JkZXIpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAg
ICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgaW9tbXVfZGV2X2lvdGxi
X3RpbWVvdXQpOwogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11
LT5sb2NrLCBmbGFncyk7CiB9CiAKQEAgLTMzNyw3ICszNDYsNyBAQCBzdGF0
aWMgdm9pZCBfYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKHN0cnVjCiAgICAgewog
ICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdz
KTsKICAgICAgICAgaW52YWxpZGF0ZV9pb21tdV9wYWdlcyhpb21tdSwgZGFk
ZHIsIGRvbV9pZCwgb3JkZXIpOwotICAgICAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSk7CisgICAgICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlv
bW11LCAwKTsKICAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9t
bXUtPmxvY2ssIGZsYWdzKTsKICAgICB9CiAKQEAgLTM2MSw3ICszNzAsNyBA
QCB2b2lkIGFtZF9pb21tdV9mbHVzaF9kZXZpY2Uoc3RydWN0IGFtZF9pCiAg
ICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPmxvY2spICk7CiAK
ICAgICBpbnZhbGlkYXRlX2Rldl90YWJsZV9lbnRyeShpb21tdSwgYmRmKTsK
LSAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAgZmx1c2hf
Y29tbWFuZF9idWZmZXIoaW9tbXUsIDApOwogfQogCiB2b2lkIGFtZF9pb21t
dV9mbHVzaF9pbnRyZW1hcChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWlu
dDE2X3QgYmRmKQpAQCAtMzY5LDcgKzM3OCw3IEBAIHZvaWQgYW1kX2lvbW11
X2ZsdXNoX2ludHJlbWFwKHN0cnVjdCBhbWQKICAgICBBU1NFUlQoIHNwaW5f
aXNfbG9ja2VkKCZpb21tdS0+bG9jaykgKTsKIAogICAgIGludmFsaWRhdGVf
aW50ZXJydXB0X3RhYmxlKGlvbW11LCBiZGYpOwotICAgIGZsdXNoX2NvbW1h
bmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihp
b21tdSwgMCk7CiB9CiAKIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9jYWNo
ZXMoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCkBAIC0zNzcsNyArMzg2LDcg
QEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfYWxsX2NhY2hlcyhzdHJ1Y3QgYQog
ICAgIEFTU0VSVCggc3Bpbl9pc19sb2NrZWQoJmlvbW11LT5sb2NrKSApOwog
CiAgICAgaW52YWxpZGF0ZV9pb21tdV9hbGwoaW9tbXUpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSwgMCk7CiB9CiAKIHZvaWQgYW1kX2lvbW11X3NlbmRfZ3Vl
c3RfY21kKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1MzIgY21kW10pCkBA
IC0zODcsNyArMzk2LDggQEAgdm9pZCBhbWRfaW9tbXVfc2VuZF9ndWVzdF9j
bWQoc3RydWN0IGFtZAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+
bG9jaywgZmxhZ3MpOwogCiAgICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11
LCBjbWQpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAg
ICAvKiBUQkQ6IFRpbWVvdXQgc2VsZWN0aW9uIG1heSByZXF1aXJlIHBlZWtp
bmcgaW50byBjbWRbXS4gKi8KKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihp
b21tdSwgMCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21t
dS0+bG9jaywgZmxhZ3MpOwogfQo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.13-1.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.13-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBzaXplIHFpbnZhbCBxdWV1ZSBkeW5hbWljYWxseQoKV2l0aCB0
aGUgcHJlc2VudCBzeW5jaHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xv
dHMgZm9yIGV2ZXJ5Cm9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYg
YW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRoZXJlIGNhbiBiZQpvbmUgc3Vj
aCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gVG8gZW5zdXJl
IHRoYXQgdW5kZXIgYWxsCm5vcm1hbCBjaXJjdW1zdGFuY2VzIGEgc2xvdCBp
cyBhbHdheXMgYXZhaWxhYmxlIHdoZW4gb25lIGlzIHJlcXVlc3RlZCwKc2l6
ZSB0aGUgcXVldWUgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJlciBvZiBw
cmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuaApAQCAtNDUwLDE3ICs0NTAsOSBAQCBzdHJ1Y3QgcWludmFsX2VudHJ5
IHsKICAgICB9cTsKIH07CiAKLS8qIE9yZGVyIG9mIHF1ZXVlIGludmFsaWRh
dGlvbiBwYWdlcyhtYXggaXMgOCkgKi8KLSNkZWZpbmUgUUlOVkFMX1BBR0Vf
T1JERVIgICAyCi0KLSNkZWZpbmUgUUlOVkFMX0FSQ0hfUEFHRV9PUkRFUiAg
KFFJTlZBTF9QQUdFX09SREVSICsgUEFHRV9TSElGVF80SyAtIFBBR0VfU0hJ
RlQpCi0jZGVmaW5lIFFJTlZBTF9BUkNIX1BBR0VfTlIgICAgICggUUlOVkFM
X0FSQ0hfUEFHRV9PUkRFUiA8IDAgPyAgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAxIDogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBRSU5W
QUxfQVJDSF9QQUdFX09SREVSICkKLQogLyogRWFjaCBlbnRyeSBpcyAxNiBi
eXRlcywgc28gMl44IGVudHJpZXMgcGVyIHBhZ2UgKi8KICNkZWZpbmUgUUlO
VkFMX0VOVFJZX09SREVSICAoIFBBR0VfU0hJRlQgLSA0ICkKLSNkZWZpbmUg
UUlOVkFMX0VOVFJZX05SICAgICAoMSA8PCAoUUlOVkFMX1BBR0VfT1JERVIg
KyA4KSkKKyNkZWZpbmUgUUlOVkFMX01BWF9FTlRSWV9OUiAoMXUgPDwgKDcg
KyBRSU5WQUxfRU5UUllfT1JERVIpKQogCiAvKiBTdGF0dXMgZGF0YSBmbGFn
ICovCiAjZGVmaW5lIFFJTlZBTF9TVEFUX0lOSVQgIDAKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMzEsNiArMzEsOSBA
QAogCiAjZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKIAorc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOworc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOworCiBzdGF0
aWMgaW50IF9fbXVzdF9jaGVjayBpbnZhbGlkYXRlX3N5bmMoc3RydWN0IHZ0
ZF9pb21tdSAqaW9tbXUpOwogCiBzdGF0aWMgdm9pZCBwcmludF9xaV9yZWdz
KHN0cnVjdCB2dGRfaW9tbXUgKmlvbW11KQpAQCAtNTUsNyArNTgsNyBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IHFpbnZhbF9uZXh0X2luZGV4KHN0CiAgICAg
dGFpbCA+Pj0gUUlOVkFMX0lOREVYX1NISUZUOwogCiAgICAgLyogKHRhaWwr
MSA9PSBoZWFkKSBpbmRpY2F0ZXMgYSBmdWxsIHF1ZXVlLCB3YWl0IGZvciBI
VyAqLwotICAgIHdoaWxlICggKCB0YWlsICsgMSApICUgUUlOVkFMX0VOVFJZ
X05SID09CisgICAgd2hpbGUgKCAoKHRhaWwgKyAxKSAmIChxaV9lbnRyeV9u
ciAtIDEpKSA9PQogICAgICAgICAgICAgKCBkbWFyX3JlYWRxKGlvbW11LT5y
ZWcsIERNQVJfSVFIX1JFRykgPj4gUUlOVkFMX0lOREVYX1NISUZUICkgKQog
ICAgICAgICBjcHVfcmVsYXgoKTsKIApAQCAtNjgsNyArNzEsNyBAQCBzdGF0
aWMgdm9pZCBxaW52YWxfdXBkYXRlX3F0YWlsKHN0cnVjdCB2CiAKICAgICAv
KiBOZWVkIGhvbGQgcmVnaXN0ZXIgbG9jayB3aGVuIHVwZGF0ZSB0YWlsICov
CiAgICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPnJlZ2lzdGVy
X2xvY2spICk7Ci0gICAgdmFsID0gKGluZGV4ICsgMSkgJSBRSU5WQUxfRU5U
UllfTlI7CisgICAgdmFsID0gKGluZGV4ICsgMSkgJiAocWlfZW50cnlfbnIg
LSAxKTsKICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVnLCBETUFSX0lRVF9S
RUcsICh2YWwgPDwgUUlOVkFMX0lOREVYX1NISUZUKSk7CiB9CiAKQEAgLTQw
Myw4ICs0MDYsMjggQEAgaW50IGVuYWJsZV9xaW52YWwoc3RydWN0IHZ0ZF9p
b21tdSAqaW9tbQogCiAgICAgaWYgKCBpb21tdS0+cWludmFsX21hZGRyID09
IDAgKQogICAgIHsKLSAgICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciA9IGFs
bG9jX3BndGFibGVfbWFkZHIoUUlOVkFMX0FSQ0hfUEFHRV9OUiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW9tbXUtPm5vZGUpOworICAgICAgICBpZiAoICFxaV9lbnRyeV9uciApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgKiBXaXRo
IHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1vZGVsLCB3ZSBuZWVkIHR3byBz
bG90cyBmb3IgZXZlcnkKKyAgICAgICAgICAgICAqIG9wZXJhdGlvbiAodGhl
IG9wZXJhdGlvbiBpdHNlbGYgYW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRo
ZXJlCisgICAgICAgICAgICAgKiBjYW4gYmUgb25lIHN1Y2ggcGFpciBvZiBy
ZXF1ZXN0cyBwZW5kaW5nIHBlciBDUFUuICBPbmUgZXh0cmEKKyAgICAgICAg
ICAgICAqIGVudHJ5IGlzIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25zaWRl
cmVkIGZ1bGwgd2hlbiB0aGVyZSdzCisgICAgICAgICAgICAgKiBvbmx5IG9u
ZSBlbnRyeSBsZWZ0LgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBC
VUlMRF9CVUdfT04oQ09ORklHX05SX0NQVVMgKiAyID49IFFJTlZBTF9NQVhf
RU5UUllfTlIpOworICAgICAgICAgICAgcWlfcGdfb3JkZXIgPSBnZXRfb3Jk
ZXJfZnJvbV9ieXRlcygobnVtX3ByZXNlbnRfY3B1cygpICogMiArIDEpIDw8
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChQQUdFX1NISUZUIC0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFFJTlZBTF9FTlRSWV9PUkRFUikpOwor
ICAgICAgICAgICAgcWlfZW50cnlfbnIgPSAxdSA8PCAocWlfcGdfb3JkZXIg
KyBRSU5WQUxfRU5UUllfT1JERVIpOworCisgICAgICAgICAgICBkcHJpbnRr
KFhFTkxPR19JTkZPIFZURFBSRUZJWCwKKyAgICAgICAgICAgICAgICAgICAg
IlFJOiB1c2luZyAldS1lbnRyeSByaW5nKHMpXG4iLCBxaV9lbnRyeV9ucik7
CisgICAgICAgIH0KKworICAgICAgICBpb21tdS0+cWludmFsX21hZGRyID0K
KyAgICAgICAgICAgIGFsbG9jX3BndGFibGVfbWFkZHIocWlfZW50cnlfbnIg
Pj4gUUlOVkFMX0VOVFJZX09SREVSLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpb21tdS0+bm9kZSk7CiAgICAgICAgIGlmICggaW9tbXUt
PnFpbnZhbF9tYWRkciA9PSAwICkKICAgICAgICAgewogICAgICAgICAgICAg
ZHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgsCkBAIC00MTgsMTUg
KzQ0MSwxNiBAQCBpbnQgZW5hYmxlX3FpbnZhbChzdHJ1Y3QgdnRkX2lvbW11
ICppb21tCiAKICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPnJlZ2lz
dGVyX2xvY2ssIGZsYWdzKTsKIAotICAgIC8qIFNldHVwIEludmFsaWRhdGlv
biBRdWV1ZSBBZGRyZXNzKElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUKLSAgICAg
KiBhZGRyZXNzIG9mIHRoZSBwYWdlIHdlIGp1c3QgYWxsb2NhdGVkLiAgUVMg
ZmllbGQgYXQKLSAgICAgKiBiaXRzWzI6MF0gdG8gaW5kaWNhdGUgc2l6ZSBv
ZiBxdWV1ZSBpcyBvbmUgNEtCIHBhZ2UuCi0gICAgICogVGhhdCdzIDI1NiBl
bnRyaWVzLiAgUXVldWVkIEhlYWQgKElRSCkgYW5kIFF1ZXVlIFRhaWwgKElR
VCkKLSAgICAgKiByZWdpc3RlcnMgYXJlIGF1dG9tYXRpY2FsbHkgcmVzZXQg
dG8gMCB3aXRoIHdyaXRlCi0gICAgICogdG8gSVFBIHJlZ2lzdGVyLgorICAg
IC8qCisgICAgICogU2V0dXAgSW52YWxpZGF0aW9uIFF1ZXVlIEFkZHJlc3Mg
KElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUgYWRkcmVzcyBvZiB0aGUKKyAgICAg
KiBwYWdlcyB3ZSBqdXN0IGFsbG9jYXRlZC4gIFRoZSBRUyBmaWVsZCBhdCBi
aXRzWzI6MF0gaW5kaWNhdGVzIHRoZSBzaXplCisgICAgICogKHBhZ2Ugb3Jk
ZXIpIG9mIHRoZSBxdWV1ZS4KKyAgICAgKgorICAgICAqIFF1ZXVlZCBIZWFk
IChJUUgpIGFuZCBRdWV1ZSBUYWlsIChJUVQpIHJlZ2lzdGVycyBhcmUgYXV0
b21hdGljYWxseQorICAgICAqIHJlc2V0IHRvIDAgd2l0aCB3cml0ZSB0byBJ
UUEgcmVnaXN0ZXIuCiAgICAgICovCiAgICAgZG1hcl93cml0ZXEoaW9tbXUt
PnJlZywgRE1BUl9JUUFfUkVHLAotICAgICAgICAgICAgICAgIGlvbW11LT5x
aW52YWxfbWFkZHIgfCBRSU5WQUxfUEFHRV9PUkRFUik7CisgICAgICAgICAg
ICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciB8IHFpX3BnX29yZGVyKTsKIAog
ICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIERNQVJfSVFUX1JFRywgMCk7
CiAK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.13-2.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.13-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHNpemUgY29tbWFuZCBidWZmZXIgZHluYW1pY2FsbHkK
CldpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9kZWwsIHdlIG5lZWQg
dHdvIHNsb3RzIGZvciBldmVyeQpvcGVyYXRpb24gKHRoZSBvcGVyYXRpb24g
aXRzZWxmIGFuZCBhIHdhaXQgY29tbWFuZCkuICBUaGVyZSBjYW4gYmUgb25l
CnN1Y2ggcGFpciBvZiBjb21tYW5kcyBwZW5kaW5nIHBlciBDUFUuIFRvIGVu
c3VyZSB0aGF0IHVuZGVyIGFsbCBub3JtYWwKY2lyY3Vtc3RhbmNlcyBhIHNs
b3QgaXMgYWx3YXlzIGF2YWlsYWJsZSB3aGVuIG9uZSBpcyByZXF1ZXN0ZWQs
IHNpemUgdGhlCmNvbW1hbmQgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJl
ciBvZiBwcmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAv
IENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50
IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0zNSw4ICszNSw4IEBAIHN0YXRpYyBp
bnQgcXVldWVfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW0KICAgICBpZiAoIGhl
YWQgIT0gdGFpbCApCiAgICAgewogICAgICAgICBtZW1jcHkoaW9tbXUtPmNt
ZF9idWZmZXIuYnVmZmVyICsKLSAgICAgICAgICAgICAgIChpb21tdS0+Y21k
X2J1ZmZlci50YWlsICogSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9TSVpFKSwK
LSAgICAgICAgICAgICAgIGNtZCwgSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9T
SVpFKTsKKyAgICAgICAgICAgICAgIChpb21tdS0+Y21kX2J1ZmZlci50YWls
ICogc2l6ZW9mKGNtZF9lbnRyeV90KSksCisgICAgICAgICAgICAgICBjbWQs
IHNpemVvZihjbWRfZW50cnlfdCkpOwogCiAgICAgICAgIGlvbW11LT5jbWRf
YnVmZmVyLnRhaWwgPSB0YWlsOwogICAgICAgICByZXR1cm4gMTsKLS0tIGEv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYworKysg
Yi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCkBA
IC0xMjUsNyArMTI1LDcgQEAgc3RhdGljIHZvaWQgcmVnaXN0ZXJfaW9tbXVf
Y21kX2J1ZmZlcl9pbgogICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9f
YmFzZSArIElPTU1VX0NNRF9CVUZGRVJfQkFTRV9MT1dfT0ZGU0VUKTsKIAog
ICAgIHBvd2VyX29mMl9lbnRyaWVzID0gZ2V0X29yZGVyX2Zyb21fYnl0ZXMo
aW9tbXUtPmNtZF9idWZmZXIuYWxsb2Nfc2l6ZSkgKwotICAgICAgICBJT01N
VV9DTURfQlVGRkVSX1BPV0VSX09GMl9FTlRSSUVTX1BFUl9QQUdFOworICAg
ICAgICBQQUdFX1NISUZUIC0gSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9PUkRF
UjsKIAogICAgIGVudHJ5ID0gMDsKICAgICBpb21tdV9zZXRfYWRkcl9oaV90
b19yZWcoJmVudHJ5LCBhZGRyX2hpKTsKQEAgLTEwNTAsOSArMTA1MCwzMSBA
QCBzdGF0aWMgdm9pZCAqX19pbml0IGFsbG9jYXRlX3JpbmdfYnVmZmVyCiBz
dGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0ZV9jbWRfYnVmZmVyKHN0cnVj
dCBhbWRfaW9tbXUgKmlvbW11KQogewogICAgIC8qIGFsbG9jYXRlICdjb21t
YW5kIGJ1ZmZlcicgaW4gcG93ZXIgb2YgMiBpbmNyZW1lbnRzIG9mIDRLICov
CisgICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IG5yX2Vu
dHM7CisKKyAgICBpZiAoICFucl9lbnRzICkKKyAgICB7CisgICAgICAgIHVu
c2lnbmVkIGludCBvcmRlcjsKKworICAgICAgICAvKgorICAgICAgICAgKiBX
aXRoIHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1vZGVsLCB3ZSBuZWVkIHR3
byBzbG90cyBmb3IgZXZlcnkKKyAgICAgICAgICogb3BlcmF0aW9uICh0aGUg
b3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0IGNvbW1hbmQpLiAgVGhlcmUg
Y2FuIGJlCisgICAgICAgICAqIG9uZSBzdWNoIHBhaXIgb2YgcmVxdWVzdHMg
cGVuZGluZyBwZXIgQ1BVLiAgT25lIGV4dHJhIGVudHJ5IGlzCisgICAgICAg
ICAqIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25zaWRlcmVkIGZ1bGwgd2hl
biB0aGVyZSdzIG9ubHkgb25lIGVudHJ5CisgICAgICAgICAqIGxlZnQuCisg
ICAgICAgICAqLworICAgICAgICBCVUlMRF9CVUdfT04oQ09ORklHX05SX0NQ
VVMgKiAyID49IElPTU1VX0NNRF9CVUZGRVJfTUFYX0VOVFJJRVMpOworICAg
ICAgICBvcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5dGVzKChudW1fcHJlc2Vu
dF9jcHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSKTsK
KyAgICAgICAgbnJfZW50cyA9IDF1IDw8IChvcmRlciArIFBBR0VfU0hJRlQg
LSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSKTsKKworICAgICAgICBB
TURfSU9NTVVfREVCVUcoInVzaW5nICV1LWVudHJ5IGNtZCByaW5nKHMpXG4i
LCBucl9lbnRzKTsKKyAgICB9CisKKyAgICBCVUlMRF9CVUdfT04oc2l6ZW9m
KGNtZF9lbnRyeV90KSAhPSAoMXUgPDwgSU9NTVVfQ01EX0JVRkZFUl9FTlRS
WV9PUkRFUikpOworCiAgICAgcmV0dXJuIGFsbG9jYXRlX3JpbmdfYnVmZmVy
KCZpb21tdS0+Y21kX2J1ZmZlciwgc2l6ZW9mKGNtZF9lbnRyeV90KSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfQ01EX0JVRkZF
Ul9ERUZBVUxUX0VOVFJJRVMsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICJDb21tYW5kIEJ1ZmZlciIsIGZhbHNlKTsKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbnJfZW50cywgIkNvbW1hbmQgQnVmZmVy
IiwgZmFsc2UpOwogfQogCiBzdGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0
ZV9ldmVudF9sb2coc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCi0tLSBhL3hl
bi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtZGVmcy5oCisr
KyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtZGVm
cy5oCkBAIC0yMCw5ICsyMCw2IEBACiAjaWZuZGVmIF9BU01fWDg2XzY0X0FN
RF9JT01NVV9ERUZTX0gKICNkZWZpbmUgX0FTTV9YODZfNjRfQU1EX0lPTU1V
X0RFRlNfSAogCi0vKiBJT01NVSBDb21tYW5kIEJ1ZmZlciBlbnRyaWVzOiBp
biBwb3dlciBvZiAyIGluY3JlbWVudHMsIG1pbmltdW0gb2YgMjU2ICovCi0j
ZGVmaW5lIElPTU1VX0NNRF9CVUZGRVJfREVGQVVMVF9FTlRSSUVTCTUxMgot
CiAvKiBJT01NVSBFdmVudCBMb2cgZW50cmllczogaW4gcG93ZXIgb2YgMiBp
bmNyZW1lbnRzLCBtaW5pbXVtIG9mIDI1NiAqLwogI2RlZmluZSBJT01NVV9F
VkVOVF9MT0dfREVGQVVMVF9FTlRSSUVTICAgICA1MTIKIApAQCAtMTY4LDgg
KzE2NSw4IEBAIHN0cnVjdCBhbWRfaW9tbXVfZHRlIHsKICNkZWZpbmUgSU9N
TVVfQ01EX0JVRkZFUl9MRU5HVEhfTUFTSwkJMHgwRjAwMDAwMAogI2RlZmlu
ZSBJT01NVV9DTURfQlVGRkVSX0xFTkdUSF9TSElGVAkJMjQKIAotI2RlZmlu
ZSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX1NJWkUJCQkxNgotI2RlZmluZSBJ
T01NVV9DTURfQlVGRkVSX1BPV0VSX09GMl9FTlRSSUVTX1BFUl9QQUdFCTgK
KyNkZWZpbmUgSU9NTVVfQ01EX0JVRkZFUl9FTlRSWV9PUkRFUiAgICAgICAg
ICAgIDQKKyNkZWZpbmUgSU9NTVVfQ01EX0JVRkZFUl9NQVhfRU5UUklFUyAg
ICAgICAgICAgICgxdSA8PCAxNSkKIAogI2RlZmluZSBJT01NVV9DTURfT1BD
T0RFX01BU0sJCQkweEYwMDAwMDAwCiAjZGVmaW5lIElPTU1VX0NNRF9PUENP
REVfU0hJRlQJCQkyOAo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.13-3.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.13-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBlbGltaW5hdGUgZmx1c2ggcmVsYXRlZCB0aW1lb3V0cwoKTGVh
dmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24gcGVuZGluZyB3aGVuIGl0
IGFwcGVhcnMgdG8gdGFrZSB0b28KbG9uZyBpcyBwcm9ibGVtYXRpYzogSWYg
ZS5nLiBhIFFJIGNvbW1hbmQgY29tcGxldGVkIGxhdGVyLCB0aGUgd3JpdGUg
dG8KdGhlICJwb2xsIHNsb3QiIG1heSBpbnN0ZWFkIGJlIHVuZGVyc3Rvb2Qg
dG8gc2lnbmFsIGEgc3Vic2VxdWVudGx5CnN0YXJ0ZWQgY29tbWFuZCdzIGNv
bXBsZXRpb24uIEFsc28gb3VyIGFjY291bnRpbmcgb2YgdGhlIHRpbWVvdXQg
cGVyaW9kCndhcyBhY3R1YWxseSB3cm9uZzogV2UgaW5jbHVkZWQgdGhlIHRp
bWUgaXQgdG9vayBmb3IgdGhlIGNvbW1hbmQgdG8KYWN0dWFsbHkgbWFrZSBp
dCB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLCB3aGljaCBjb3VsZCBiZSBo
ZWF2aWx5CmFmZmVjdGVkIGJ5IGd1ZXN0cyBvdGhlciB0aGFuIHRoZSBvbmUg
Zm9yIHdoaWNoIHRoZSBmbHVzaCBpcyBiZWluZwpwZXJmb3JtZWQuCgpEbyBh
d2F5IHdpdGggYWxsIHRpbWVvdXQgZGV0ZWN0aW9uIG9uIGFsbCBmbHVzaCBy
ZWxhdGVkIGNvZGUgcGF0aHMuCkxvZyBleGNlc3NpdmVseSBsb25nIHByb2Nl
c3NpbmcgdGltZXMgKHdpdGggYSBwcm9ncmVzc2l2ZSB0aHJlc2hvbGQpIHRv
CmhhdmUgc29tZSBpbmRpY2F0aW9uIG9mIHByb2JsZW1zIGluIHRoaXMgYXJl
YS4KCkFkZGl0aW9uYWxseSBsb2cgKG9uY2UpIGlmIHFpbnZhbF9uZXh0X2lu
ZGV4KCkgZGlkbid0IGltbWVkaWF0ZWx5IGZpbmQKYW4gYXZhaWxhYmxlIHNs
b3QuIFRvZ2V0aGVyIHdpdGggdGhlIGVhcmxpZXIgY2hhbmdlIHNpemluZyB0
aGUgcXVldWUocykKZHluYW1pY2FsbHksIHdlIHNob3VsZCBub3cgaGF2ZSBh
IGd1YXJhbnRlZSB0aGF0IHdpdGggb3VyIGZ1bGx5CnN5bmNocm9ub3VzIG1v
ZGVsIGFueSBkZW1hbmQgZm9yIHNsb3RzIGNhbiBhY3R1YWxseSBiZSBzYXRp
c2ZpZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4
NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5v
cmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZG1hci5o
CisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmgKQEAg
LTEyNyw2ICsxMjcsMzQgQEAgZG8gewogICAgIH0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
IH0gd2hpbGUgKDApCiAKKyNkZWZpbmUgSU9NTVVfRkxVU0hfV0FJVCh3aGF0
LCBpb21tdSwgb2Zmc2V0LCBvcCwgY29uZCwgc3RzKSAgICAgICBcCitkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
X19yZWFkX21vc3RseSB0aHJlc2hvbGQgPSAxOyAgICAgICAgICAgICAgIFwK
KyAgICBzX3RpbWVfdCBzdGFydCA9IE5PVygpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgc190aW1lX3QgdGltZW91
dCA9IHN0YXJ0ICsgRE1BUl9PUEVSQVRJT05fVElNRU9VVCAqIHRocmVzaG9s
ZDsgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCA7IDsg
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBz
dHMgPSBvcChpb21tdS0+cmVnLCBvZmZzZXQpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBjb25kICkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICBpZiAoIHRpbWVvdXQgJiYg
Tk9XKCkgPiB0aW1lb3V0ICkgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICB0aHJlc2hv
bGQgfD0gdGhyZXNob2xkIDw8IDE7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBS
RUZJWCAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAiIElPTU1VIyV1OiAlcyBmbHVzaCB0YWtpbmcgdG9vIGxvbmdcbiIs
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCB3
aGF0KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgdGltZW91dCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgfSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgIGNwdV9yZWxheCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIH0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgaWYgKCAhdGltZW91dCAp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklY
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICIgSU9NTVUjJXU6ICVzIGZsdXNoIHRvb2sgJWx1bXNcbiIsICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIHdoYXQs
IChOT1coKSAtIHN0YXJ0KSAvIDEwMDAwMDAwKTsgICAgXAorfSB3aGlsZSAo
IGZhbHNlICkKKwogaW50IHZ0ZF9od19jaGVjayh2b2lkKTsKIHZvaWQgZGlz
YWJsZV9wbXIoc3RydWN0IHZ0ZF9pb21tdSAqaW9tbXUpOwogaW50IGlzX2ln
ZF9kcmhkKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCk7Ci0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCkBAIC0zMjAsOCArMzIw
LDggQEAgc3RhdGljIHZvaWQgaW9tbXVfZmx1c2hfd3JpdGVfYnVmZmVyKHN0
cgogICAgIGRtYXJfd3JpdGVsKGlvbW11LT5yZWcsIERNQVJfR0NNRF9SRUcs
IHZhbCB8IERNQV9HQ01EX1dCRik7CiAKICAgICAvKiBNYWtlIHN1cmUgaGFy
ZHdhcmUgY29tcGxldGUgaXQgKi8KLSAgICBJT01NVV9XQUlUX09QKGlvbW11
LCBETUFSX0dTVFNfUkVHLCBkbWFyX3JlYWRsLAotICAgICAgICAgICAgICAg
ICAgISh2YWwgJiBETUFfR1NUU19XQkZTKSwgdmFsKTsKKyAgICBJT01NVV9G
TFVTSF9XQUlUKCJ3cml0ZSBidWZmZXIiLCBpb21tdSwgRE1BUl9HU1RTX1JF
RywgZG1hcl9yZWFkbCwKKyAgICAgICAgICAgICAgICAgICAgICEodmFsICYg
RE1BX0dTVFNfV0JGUyksIHZhbCk7CiAKICAgICBzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpb21tdS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogfQpAQCAt
MzcwLDggKzM3MCw4IEBAIGludCB2dGRfZmx1c2hfY29udGV4dF9yZWcoc3Ry
dWN0IHZ0ZF9pb20KICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVnLCBETUFS
X0NDTURfUkVHLCB2YWwpOwogCiAgICAgLyogTWFrZSBzdXJlIGhhcmR3YXJl
IGNvbXBsZXRlIGl0ICovCi0gICAgSU9NTVVfV0FJVF9PUChpb21tdSwgRE1B
Ul9DQ01EX1JFRywgZG1hcl9yZWFkcSwKLSAgICAgICAgICAgICAgICAgICEo
dmFsICYgRE1BX0NDTURfSUNDKSwgdmFsKTsKKyAgICBJT01NVV9GTFVTSF9X
QUlUKCJjb250ZXh0IiwgaW9tbXUsIERNQVJfQ0NNRF9SRUcsIGRtYXJfcmVh
ZHEsCisgICAgICAgICAgICAgICAgICAgICAhKHZhbCAmIERNQV9DQ01EX0lD
QyksIHZhbCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21t
dS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogICAgIC8qIGZsdXNoIGNvbnRl
eHQgZW50cnkgd2lsbCBpbXBsaWNpdGx5IGZsdXNoIHdyaXRlIGJ1ZmZlciAq
LwpAQCAtNDQ4LDggKzQ0OCw4IEBAIGludCB2dGRfZmx1c2hfaW90bGJfcmVn
KHN0cnVjdCB2dGRfaW9tbXUKICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVn
LCB0bGJfb2Zmc2V0ICsgOCwgdmFsKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBo
YXJkd2FyZSBjb21wbGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9t
bXUsICh0bGJfb2Zmc2V0ICsgOCksIGRtYXJfcmVhZHEsCi0gICAgICAgICAg
ICAgICAgICAhKHZhbCAmIERNQV9UTEJfSVZUKSwgdmFsKTsKKyAgICBJT01N
VV9GTFVTSF9XQUlUKCJpb3RsYiIsIGlvbW11LCAodGxiX29mZnNldCArIDgp
LCBkbWFyX3JlYWRxLAorICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBE
TUFfVExCX0lWVCksIHZhbCk7CiAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmaW9tbXUtPnJlZ2lzdGVyX2xvY2ssIGZsYWdzKTsKIAogICAgIC8qIGNo
ZWNrIElPVExCIGludmFsaWRhdGlvbiBncmFudWxhcml0eSAqLwotLS0gYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcWludmFsLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCkBAIC0yOSw4ICsy
OSw2IEBACiAjaW5jbHVkZSAiZXh0ZXJuLmgiCiAjaW5jbHVkZSAiLi4vYXRz
LmgiCiAKLSNkZWZpbmUgVlREX1FJX1RJTUVPVVQJMQotCiBzdGF0aWMgdW5z
aWduZWQgaW50IF9fcmVhZF9tb3N0bHkgcWlfcGdfb3JkZXI7CiBzdGF0aWMg
dW5zaWduZWQgaW50IF9fcmVhZF9tb3N0bHkgcWlfZW50cnlfbnI7CiAKQEAg
LTYwLDcgKzU4LDExIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgcWludmFsX25l
eHRfaW5kZXgoc3QKICAgICAvKiAodGFpbCsxID09IGhlYWQpIGluZGljYXRl
cyBhIGZ1bGwgcXVldWUsIHdhaXQgZm9yIEhXICovCiAgICAgd2hpbGUgKCAo
KHRhaWwgKyAxKSAmIChxaV9lbnRyeV9uciAtIDEpKSA9PQogICAgICAgICAg
ICAgKCBkbWFyX3JlYWRxKGlvbW11LT5yZWcsIERNQVJfSVFIX1JFRykgPj4g
UUlOVkFMX0lOREVYX1NISUZUICkgKQorICAgIHsKKyAgICAgICAgcHJpbnRr
X29uY2UoWEVOTE9HX0VSUiBWVERQUkVGSVggIiBJT01NVSMldTogbm8gUUkg
c2xvdCBhdmFpbGFibGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11
LT5pbmRleCk7CiAgICAgICAgIGNwdV9yZWxheCgpOworICAgIH0KIAogICAg
IHJldHVybiB0YWlsOwogfQpAQCAtMTgwLDIzICsxODIsMzIgQEAgc3RhdGlj
IGludCBfX211c3RfY2hlY2sgcXVldWVfaW52YWxpZGF0ZQogICAgIC8qIE5v
dyB3ZSBkb24ndCBzdXBwb3J0IGludGVycnVwdCBtZXRob2QgKi8KICAgICBp
ZiAoIHN3ICkKICAgICB7Ci0gICAgICAgIHNfdGltZV90IHRpbWVvdXQ7Ci0K
LSAgICAgICAgLyogSW4gY2FzZSBhbGwgd2FpdCBkZXNjcmlwdG9yIHdyaXRl
cyB0byBzYW1lIGFkZHIgd2l0aCBzYW1lIGRhdGEgKi8KLSAgICAgICAgdGlt
ZW91dCA9IE5PVygpICsgTUlMTElTRUNTKGZsdXNoX2Rldl9pb3RsYiA/Ci0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb21tdV9kZXZf
aW90bGJfdGltZW91dCA6IFZURF9RSV9USU1FT1VUKTsKKyAgICAgICAgc3Rh
dGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7
CisgICAgICAgIHNfdGltZV90IHN0YXJ0ID0gTk9XKCk7CisgICAgICAgIHNf
dGltZV90IHRpbWVvdXQgPSBzdGFydCArIChmbHVzaF9kZXZfaW90bGIKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gaW9tbXVfZGV2
X2lvdGxiX3RpbWVvdXQKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDogMTAwKSAqIE1JTExJU0VDUyh0aHJlc2hvbGQpOwogCiAgICAg
ICAgIHdoaWxlICggQUNDRVNTX09OQ0UoKnRoaXNfcG9sbF9zbG90KSAhPSBR
SU5WQUxfU1RBVF9ET05FICkKICAgICAgICAgewotICAgICAgICAgICAgaWYg
KCBOT1coKSA+IHRpbWVvdXQgKQorICAgICAgICAgICAgaWYgKCB0aW1lb3V0
ICYmIE5PVygpID4gdGltZW91dCApCiAgICAgICAgICAgICB7Ci0gICAgICAg
ICAgICAgICAgcHJpbnRfcWlfcmVncyhpb21tdSk7CisgICAgICAgICAgICAg
ICAgdGhyZXNob2xkIHw9IHRocmVzaG9sZCA8PCAxOwogICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAg
ICAgICAgICAgICAgICAgIiBRdWV1ZSBpbnZhbGlkYXRlIHdhaXQgZGVzY3Jp
cHRvciB0aW1lZCBvdXRcbiIpOwotICAgICAgICAgICAgICAgIHJldHVybiAt
RVRJTUVET1VUOworICAgICAgICAgICAgICAgICAgICAgICAiIElPTU1VIyV1
OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0YWtpbmcgdG9vIGxvbmdcbiIsCisg
ICAgICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRleCwgZmx1c2hfZGV2
X2lvdGxiID8gIiBkZXYiIDogIiIpOworICAgICAgICAgICAgICAgIHByaW50
X3FpX3JlZ3MoaW9tbXUpOworICAgICAgICAgICAgICAgIHRpbWVvdXQgPSAw
OwogICAgICAgICAgICAgfQogICAgICAgICAgICAgY3B1X3JlbGF4KCk7CiAg
ICAgICAgIH0KKworICAgICAgICBpZiAoICF0aW1lb3V0ICkKKyAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKKyAgICAgICAg
ICAgICAgICAgICAiIElPTU1VIyV1OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0
b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRl
eCwgZmx1c2hfZGV2X2lvdGxiID8gIiBkZXYiIDogIiIsCisgICAgICAgICAg
ICAgICAgICAgKE5PVygpIC0gc3RhcnQpIC8gMTAwMDAwMDApOworCiAgICAg
ICAgIHJldHVybiAwOwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.13-4.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.13-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHdhaXQgZm9yIGNvbW1hbmQgc2xvdCB0byBiZSBhdmFp
bGFibGUKCk5vIGNhbGxlciBjYXJlZCBhYm91dCBzZW5kX2lvbW11X2NvbW1h
bmQoKSBpbmRpY2F0aW5nIHVuYXZhaWxhYmlsaXR5IG9mCmEgc2xvdC4gSGVu
Y2UgaWYgYSBzdWZmaWNpZW50IG51bWJlciBwcmlvciBjb21tYW5kcyB0aW1l
ZCBvdXQsIHdlIGRpZApibGluZGx5IGFzc3VtZSB0aGF0IHRoZSByZXF1ZXN0
ZWQgY29tbWFuZCB3YXMgc3VibWl0dGVkIHRvIHRoZSBJT01NVQp3aGVuIHJl
YWxseSBpdCB3YXNuJ3QuIFRoaXMgY291bGQgbWVhbiBib3RoIGEgaGFuZ2lu
ZyBzeXN0ZW0gKHdhaXRpbmcKZm9yIGEgY29tbWFuZCB0byBjb21wbGV0ZSB0
aGF0IHdhcyBuZXZlciBzZWVuIGJ5IHRoZSBJT01NVSkgb3IgYmxpbmRseQpw
cm9wYWdhdGluZyBzdWNjZXNzIGJhY2sgdG8gY2FsbGVycywgbWFraW5nIHRo
ZW0gYmVsaWV2ZSB0aGV5J3JlIGZpbmUKdG8gZS5nLiBmcmVlIHByZXZpb3Vz
bHkgdW5tYXBwZWQgcGFnZXMuCgpGb2xkIHRoZSB0aHJlZSBpbnZvbHZlZCBm
dW5jdGlvbnMgaW50byBvbmUsIGFkZCBzcGluIHdhaXRpbmcgZm9yIGFuCmF2
YWlsYWJsZSBzbG90IGFsb25nIHRoZSBsaW5lcyBvZiBWVC1kJ3MgcWludmFs
X25leHRfaW5kZXgoKSwgYW5kIGFzIGEKY29uc2VxdWVuY2UgZHJvcCBhbGwg
ZXJyb3IgaW5kaWNhdG9yIHJldHVybiB0eXBlcy92YWx1ZXMuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yMiw0
OCArMjIsMzYgQEAKICNpbmNsdWRlIDxhc20vaHZtL3N2bS9hbWQtaW9tbXUt
cHJvdG8uaD4KICNpbmNsdWRlICIuLi9hdHMuaCIKIAotc3RhdGljIGludCBx
dWV1ZV9pb21tdV9jb21tYW5kKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1
MzIgY21kW10pCitzdGF0aWMgdm9pZCBzZW5kX2lvbW11X2NvbW1hbmQoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgdWludDMyX3QgY21kWzRdKQogewotICAgIHVpbnQz
Ml90IHRhaWwsIGhlYWQ7CisgICAgdWludDMyX3QgdGFpbDsKIAogICAgIHRh
aWwgPSBpb21tdS0+Y21kX2J1ZmZlci50YWlsOwogICAgIGlmICggKyt0YWls
ID09IGlvbW11LT5jbWRfYnVmZmVyLmVudHJpZXMgKQogICAgICAgICB0YWls
ID0gMDsKIAotICAgIGhlYWQgPSBpb21tdV9nZXRfcmJfcG9pbnRlcihyZWFk
bChpb21tdS0+bW1pb19iYXNlICsKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU9NTVVfQ01EX0JVRkZFUl9IRUFEX09GRlNFVCkp
OwotICAgIGlmICggaGVhZCAhPSB0YWlsICkKKyAgICB3aGlsZSAoIHRhaWwg
PT0gaW9tbXVfZ2V0X3JiX3BvaW50ZXIocmVhZGwoaW9tbXUtPm1taW9fYmFz
ZSArCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpKSApCiAgICAg
ewotICAgICAgICBtZW1jcHkoaW9tbXUtPmNtZF9idWZmZXIuYnVmZmVyICsK
LSAgICAgICAgICAgICAgIChpb21tdS0+Y21kX2J1ZmZlci50YWlsICogc2l6
ZW9mKGNtZF9lbnRyeV90KSksCi0gICAgICAgICAgICAgICBjbWQsIHNpemVv
ZihjbWRfZW50cnlfdCkpOwotCi0gICAgICAgIGlvbW11LT5jbWRfYnVmZmVy
LnRhaWwgPSB0YWlsOwotICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgcHJp
bnRrX29uY2UoWEVOTE9HX0VSUgorICAgICAgICAgICAgICAgICAgICAiQU1E
IElPTU1VICUwNHg6JTAyeDolMDJ4LiV1OiBubyBjbWQgc2xvdCBhdmFpbGFi
bGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11LT5zZWcsIFBDSV9C
VVMoaW9tbXUtPmJkZiksCisgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9U
KGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSk7CisgICAgICAg
IGNwdV9yZWxheCgpOwogICAgIH0KIAotICAgIHJldHVybiAwOwotfQorICAg
IG1lbWNweShpb21tdS0+Y21kX2J1ZmZlci5idWZmZXIgKworICAgICAgICAg
ICAoaW9tbXUtPmNtZF9idWZmZXIudGFpbCAqIHNpemVvZihjbWRfZW50cnlf
dCkpLAorICAgICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwog
Ci1zdGF0aWMgdm9pZCBjb21taXRfaW9tbXVfY29tbWFuZF9idWZmZXIoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUpCi17Ci0gICAgdTMyIHRhaWwgPSAwOwor
ICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWlsOwogCisgICAgdGFp
bCA9IDA7CiAgICAgaW9tbXVfc2V0X3JiX3BvaW50ZXIoJnRhaWwsIGlvbW11
LT5jbWRfYnVmZmVyLnRhaWwpOwogICAgIHdyaXRlbCh0YWlsLCBpb21tdS0+
bW1pb19iYXNlK0lPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZTRVQpOwogfQog
Ci1pbnQgc2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11LCB1MzIgY21kW10pCi17Ci0gICAgaWYgKCBxdWV1ZV9pb21tdV9jb21t
YW5kKGlvbW11LCBjbWQpICkKLSAgICB7Ci0gICAgICAgIGNvbW1pdF9pb21t
dV9jb21tYW5kX2J1ZmZlcihpb21tdSk7Ci0gICAgICAgIHJldHVybiAxOwot
ICAgIH0KLQotICAgIHJldHVybiAwOwotfQotCiBzdGF0aWMgdm9pZCBmbHVz
aF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKIHsK
ICAgICB1MzIgY21kWzRdLCBzdGF0dXM7Cg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.13-5.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.13-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRyb3AgY29tbWFuZCBjb21wbGV0aW9uIHRpbWVvdXQK
CkZpcnN0IGFuZCBmb3JlbW9zdCAtIHN1Y2ggdGltZW91dHMgd2VyZSBub3Qg
c2lnbmFsZWQgdG8gY2FsbGVycywgbWFraW5nCnRoZW0gYmVsaWV2ZSB0aGV5
J3JlIGZpbmUgdG8gZS5nLiBmcmVlIHByZXZpb3VzbHkgdW5tYXBwZWQgcGFn
ZXMuCgpNaXJyb3IgVlQtZCdzIGJlaGF2aW9yOiBBIGZpeGVkIG51bWJlciBv
ZiBsb29wIGl0ZXJhdGlvbnMgaXMgbm90IGEKc3VpdGFibGUgd2F5IHRvIGRl
dGVjdCB0aW1lb3V0cyBpbiBhbiBlbnZpcm9ubWVudCAoQ1BVIGFuZCBidXMg
c3BlZWRzKQppbmRlcGVuZGVudCBtYW5uZXIgYW55d2F5LiBGdXJ0aGVybW9y
ZSwgbGVhdmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24KcGVuZGluZyB3
aGVuIGl0IGFwcGVhcnMgdG8gdGFrZSB0b28gbG9uZyBpcyBwcm9ibGVtYXRp
YzogSWYgYSBjb21tYW5kCmNvbXBsZXRlZCBsYXRlciwgdGhlIHNpZ25hbGlu
ZyBvZiBpdHMgY29tcGxldGlvbiBtYXkgaW5zdGVhZCBiZQp1bmRlcnN0b29k
IHRvIHNpZ25hbCBhIHN1YnNlcXVlbnRseSBzdGFydGVkIGNvbW1hbmQncyBj
b21wbGV0aW9uLgoKTG9nIGV4Y2Vzc2l2ZWx5IGxvbmcgcHJvY2Vzc2luZyB0
aW1lcyAod2l0aCBhIHByb2dyZXNzaXZlIHRocmVzaG9sZCkgdG8KaGF2ZSBz
b21lIGluZGljYXRpb24gb2YgcHJvYmxlbXMgaW4gdGhpcyBhcmVhLiBBbGxv
dyBjYWxsZXJzIHRvIHNwZWNpZnkKYSBub24tZGVmYXVsdCB0aW1lb3V0IGJp
YXMgZm9yIHRoaXMgbG9nZ2luZywgdXNpbmcgdGhlIHNhbWUgdmFsdWVzIGFz
ClZULWQgZG9lcywgd2hpY2ggaW4gcGFydGljdWxhciBtZWFucyBhIChieSBk
ZWZhdWx0KSBtdWNoIGxhcmdlciB2YWx1ZQpmb3IgZGV2aWNlIElPIFRMQiBp
bnZhbGlkYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2NtZC5jCkBAIC01MiwxMCArNTIsMTIgQEAgc3RhdGljIHZvaWQg
c2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbQogICAgIHdyaXRlbCh0YWls
LCBpb21tdS0+bW1pb19iYXNlK0lPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZT
RVQpOwogfQogCi1zdGF0aWMgdm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKK3N0YXRpYyB2b2lkIGZsdXNoX2Nv
bW1hbmRfYnVmZmVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IHRpbWVv
dXRfYmFzZSkKIHsKLSAgICB1MzIgY21kWzRdLCBzdGF0dXM7Ci0gICAgaW50
IGxvb3BfY291bnQsIGNvbXBfd2FpdDsKKyAgICB1aW50MzJfdCBjbWRbNF07
CisgICAgc190aW1lX3Qgc3RhcnQsIHRpbWVvdXQ7CisgICAgc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7CiAKICAg
ICAvKiBSVzFDICdDb21XYWl0SW50JyBpbiBzdGF0dXMgcmVnaXN0ZXIgKi8K
ICAgICB3cml0ZWwoSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRfTUFTSywK
QEAgLTcxLDI0ICs3MywzMSBAQCBzdGF0aWMgdm9pZCBmbHVzaF9jb21tYW5k
X2J1ZmZlcihzdHJ1Y3QKICAgICAgICAgICAgICAgICAgICAgICAgICBJT01N
VV9DT01QX1dBSVRfSV9GTEFHX1NISUZULCAmY21kWzBdKTsKICAgICBzZW5k
X2lvbW11X2NvbW1hbmQoaW9tbXUsIGNtZCk7CiAKLSAgICAvKiBNYWtlIGxv
b3BfY291bnQgbG9uZyBlbm91Z2ggZm9yIHBvbGxpbmcgY29tcGxldGlvbiB3
YWl0IGJpdCAqLwotICAgIGxvb3BfY291bnQgPSAxMDAwOwotICAgIGRvIHsK
LSAgICAgICAgc3RhdHVzID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0gICAgICAgIGNvbXBfd2FpdCA9
IGdldF9maWVsZF9mcm9tX3JlZ191MzIoc3RhdHVzLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1NUQVRVU19D
T01QX1dBSVRfSU5UX01BU0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRf
U0hJRlQpOwotICAgICAgICAtLWxvb3BfY291bnQ7Ci0gICAgfSB3aGlsZSAo
ICFjb21wX3dhaXQgJiYgbG9vcF9jb3VudCApOwotCi0gICAgaWYgKCBjb21w
X3dhaXQgKQorICAgIHN0YXJ0ID0gTk9XKCk7CisgICAgdGltZW91dCA9IHN0
YXJ0ICsgKHRpbWVvdXRfYmFzZSA/OiAxMDApICogTUlMTElTRUNTKHRocmVz
aG9sZCk7CisgICAgd2hpbGUgKCAhKHJlYWRsKGlvbW11LT5tbWlvX2Jhc2Ug
KyBJT01NVV9TVEFUVVNfTU1JT19PRkZTRVQpICYKKyAgICAgICAgICAgICAg
SU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlRfTUFTSykgKQogICAgIHsKLSAg
ICAgICAgLyogUlcxQyAnQ29tV2FpdEludCcgaW4gc3RhdHVzIHJlZ2lzdGVy
ICovCi0gICAgICAgIHdyaXRlbChJT01NVV9TVEFUVVNfQ09NUF9XQUlUX0lO
VF9NQVNLLAotICAgICAgICAgICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0gICAgICAgIHJldHVybjsKKyAg
ICAgICAgaWYgKCB0aW1lb3V0ICYmIE5PVygpID4gdGltZW91dCApCisgICAg
ICAgIHsKKyAgICAgICAgICAgIHRocmVzaG9sZCB8PSB0aHJlc2hvbGQgPDwg
MTsKKyAgICAgICAgICAgIHByaW50ayhYRU5MT0dfV0FSTklORworICAgICAg
ICAgICAgICAgICAgICJBTUQgSU9NTVUgJTA0eDolMDJ4OiUwMnguJXU6ICVz
Y29tcGxldGlvbiB3YWl0IHRha2luZyB0b28gbG9uZ1xuIiwKKyAgICAgICAg
ICAgICAgICAgICBpb21tdS0+c2VnLCBQQ0lfQlVTKGlvbW11LT5iZGYpLAor
ICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQQ0lf
RlVOQyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgICAgICB0aW1lb3V0
X2Jhc2UgPyAiaW90bGIgIiA6ICIiKTsKKyAgICAgICAgICAgIHRpbWVvdXQg
PSAwOworICAgICAgICB9CisgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0K
LSAgICBBTURfSU9NTVVfREVCVUcoIldhcm5pbmc6IENvbVdhaXRJbnQgYml0
IGRpZCBub3QgYXNzZXJ0IVxuIik7CisKKyAgICBpZiAoICF0aW1lb3V0ICkK
KyAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HCisgICAgICAgICAgICAg
ICAiQU1EIElPTU1VICUwNHg6JTAyeDolMDJ4LiV1OiAlc2NvbXBsZXRpb24g
d2FpdCB0b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgaW9tbXUtPnNl
ZywgUENJX0JVUyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgIFBDSV9T
TE9UKGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSwKKyAgICAg
ICAgICAgICAgIHRpbWVvdXRfYmFzZSA/ICJpb3RsYiAiIDogIiIsCisgICAg
ICAgICAgICAgICAoTk9XKCkgLSBzdGFydCkgLyAxMDAwMDAwMCk7CiB9CiAK
IC8qIEJ1aWxkIGxvdyBsZXZlbCBpb21tdSBjb21tYW5kIG1lc3NhZ2VzICov
CkBAIC0zMDAsNyArMzA5LDcgQEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW90
bGIodTggZGV2Zm4sIGNvbgogICAgIC8qIHNlbmQgSU5WQUxJREFURV9JT1RM
Ql9QQUdFUyBjb21tYW5kICovCiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlv
bW11LT5sb2NrLCBmbGFncyk7CiAgICAgaW52YWxpZGF0ZV9pb3RsYl9wYWdl
cyhpb21tdSwgbWF4cGVuZCwgMCwgcXVldWVpZCwgZGFkZHIsIHJlcV9pZCwg
b3JkZXIpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAg
ICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgaW9tbXVfZGV2X2lvdGxi
X3RpbWVvdXQpOwogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11
LT5sb2NrLCBmbGFncyk7CiB9CiAKQEAgLTMzNyw3ICszNDYsNyBAQCBzdGF0
aWMgdm9pZCBfYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKHN0cnVjCiAgICAgewog
ICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdz
KTsKICAgICAgICAgaW52YWxpZGF0ZV9pb21tdV9wYWdlcyhpb21tdSwgZGFk
ZHIsIGRvbV9pZCwgb3JkZXIpOwotICAgICAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSk7CisgICAgICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlv
bW11LCAwKTsKICAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9t
bXUtPmxvY2ssIGZsYWdzKTsKICAgICB9CiAKQEAgLTM2MSw3ICszNzAsNyBA
QCB2b2lkIGFtZF9pb21tdV9mbHVzaF9kZXZpY2Uoc3RydWN0IGFtZF9pCiAg
ICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPmxvY2spICk7CiAK
ICAgICBpbnZhbGlkYXRlX2Rldl90YWJsZV9lbnRyeShpb21tdSwgYmRmKTsK
LSAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAgZmx1c2hf
Y29tbWFuZF9idWZmZXIoaW9tbXUsIDApOwogfQogCiB2b2lkIGFtZF9pb21t
dV9mbHVzaF9pbnRyZW1hcChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWlu
dDE2X3QgYmRmKQpAQCAtMzY5LDcgKzM3OCw3IEBAIHZvaWQgYW1kX2lvbW11
X2ZsdXNoX2ludHJlbWFwKHN0cnVjdCBhbWQKICAgICBBU1NFUlQoIHNwaW5f
aXNfbG9ja2VkKCZpb21tdS0+bG9jaykgKTsKIAogICAgIGludmFsaWRhdGVf
aW50ZXJydXB0X3RhYmxlKGlvbW11LCBiZGYpOwotICAgIGZsdXNoX2NvbW1h
bmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihp
b21tdSwgMCk7CiB9CiAKIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9jYWNo
ZXMoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCkBAIC0zNzcsNyArMzg2LDcg
QEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfYWxsX2NhY2hlcyhzdHJ1Y3QgYQog
ICAgIEFTU0VSVCggc3Bpbl9pc19sb2NrZWQoJmlvbW11LT5sb2NrKSApOwog
CiAgICAgaW52YWxpZGF0ZV9pb21tdV9hbGwoaW9tbXUpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSwgMCk7CiB9CiAKIHZvaWQgYW1kX2lvbW11X3NlbmRfZ3Vl
c3RfY21kKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1MzIgY21kW10pCkBA
IC0zODcsNyArMzk2LDggQEAgdm9pZCBhbWRfaW9tbXVfc2VuZF9ndWVzdF9j
bWQoc3RydWN0IGFtZAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+
bG9jaywgZmxhZ3MpOwogCiAgICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11
LCBjbWQpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAg
ICAvKiBUQkQ6IFRpbWVvdXQgc2VsZWN0aW9uIG1heSByZXF1aXJlIHBlZWtp
bmcgaW50byBjbWRbXS4gKi8KKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihp
b21tdSwgMCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21t
dS0+bG9jaywgZmxhZ3MpOwogfQo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.14-1.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.14-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBzaXplIHFpbnZhbCBxdWV1ZSBkeW5hbWljYWxseQoKV2l0aCB0
aGUgcHJlc2VudCBzeW5jaHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xv
dHMgZm9yIGV2ZXJ5Cm9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYg
YW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRoZXJlIGNhbiBiZQpvbmUgc3Vj
aCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gVG8gZW5zdXJl
IHRoYXQgdW5kZXIgYWxsCm5vcm1hbCBjaXJjdW1zdGFuY2VzIGEgc2xvdCBp
cyBhbHdheXMgYXZhaWxhYmxlIHdoZW4gb25lIGlzIHJlcXVlc3RlZCwKc2l6
ZSB0aGUgcXVldWUgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJlciBvZiBw
cmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuaApAQCAtNDUwLDE3ICs0NTAsOSBAQCBzdHJ1Y3QgcWludmFsX2VudHJ5
IHsKICAgICB9cTsKIH07CiAKLS8qIE9yZGVyIG9mIHF1ZXVlIGludmFsaWRh
dGlvbiBwYWdlcyhtYXggaXMgOCkgKi8KLSNkZWZpbmUgUUlOVkFMX1BBR0Vf
T1JERVIgICAyCi0KLSNkZWZpbmUgUUlOVkFMX0FSQ0hfUEFHRV9PUkRFUiAg
KFFJTlZBTF9QQUdFX09SREVSICsgUEFHRV9TSElGVF80SyAtIFBBR0VfU0hJ
RlQpCi0jZGVmaW5lIFFJTlZBTF9BUkNIX1BBR0VfTlIgICAgICggUUlOVkFM
X0FSQ0hfUEFHRV9PUkRFUiA8IDAgPyAgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAxIDogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBRSU5W
QUxfQVJDSF9QQUdFX09SREVSICkKLQogLyogRWFjaCBlbnRyeSBpcyAxNiBi
eXRlcywgc28gMl44IGVudHJpZXMgcGVyIHBhZ2UgKi8KICNkZWZpbmUgUUlO
VkFMX0VOVFJZX09SREVSICAoIFBBR0VfU0hJRlQgLSA0ICkKLSNkZWZpbmUg
UUlOVkFMX0VOVFJZX05SICAgICAoMSA8PCAoUUlOVkFMX1BBR0VfT1JERVIg
KyA4KSkKKyNkZWZpbmUgUUlOVkFMX01BWF9FTlRSWV9OUiAoMXUgPDwgKDcg
KyBRSU5WQUxfRU5UUllfT1JERVIpKQogCiAvKiBTdGF0dXMgZGF0YSBmbGFn
ICovCiAjZGVmaW5lIFFJTlZBTF9TVEFUX0lOSVQgIDAKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMzEsNiArMzEsOSBA
QAogCiAjZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKIAorc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOworc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOworCiBzdGF0
aWMgaW50IF9fbXVzdF9jaGVjayBpbnZhbGlkYXRlX3N5bmMoc3RydWN0IHZ0
ZF9pb21tdSAqaW9tbXUpOwogCiBzdGF0aWMgdm9pZCBwcmludF9xaV9yZWdz
KHN0cnVjdCB2dGRfaW9tbXUgKmlvbW11KQpAQCAtNTUsNyArNTgsNyBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IHFpbnZhbF9uZXh0X2luZGV4KHN0CiAgICAg
dGFpbCA+Pj0gUUlOVkFMX0lOREVYX1NISUZUOwogCiAgICAgLyogKHRhaWwr
MSA9PSBoZWFkKSBpbmRpY2F0ZXMgYSBmdWxsIHF1ZXVlLCB3YWl0IGZvciBI
VyAqLwotICAgIHdoaWxlICggKCB0YWlsICsgMSApICUgUUlOVkFMX0VOVFJZ
X05SID09CisgICAgd2hpbGUgKCAoKHRhaWwgKyAxKSAmIChxaV9lbnRyeV9u
ciAtIDEpKSA9PQogICAgICAgICAgICAgKCBkbWFyX3JlYWRxKGlvbW11LT5y
ZWcsIERNQVJfSVFIX1JFRykgPj4gUUlOVkFMX0lOREVYX1NISUZUICkgKQog
ICAgICAgICBjcHVfcmVsYXgoKTsKIApAQCAtNjgsNyArNzEsNyBAQCBzdGF0
aWMgdm9pZCBxaW52YWxfdXBkYXRlX3F0YWlsKHN0cnVjdCB2CiAKICAgICAv
KiBOZWVkIGhvbGQgcmVnaXN0ZXIgbG9jayB3aGVuIHVwZGF0ZSB0YWlsICov
CiAgICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPnJlZ2lzdGVy
X2xvY2spICk7Ci0gICAgdmFsID0gKGluZGV4ICsgMSkgJSBRSU5WQUxfRU5U
UllfTlI7CisgICAgdmFsID0gKGluZGV4ICsgMSkgJiAocWlfZW50cnlfbnIg
LSAxKTsKICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVnLCBETUFSX0lRVF9S
RUcsICh2YWwgPDwgUUlOVkFMX0lOREVYX1NISUZUKSk7CiB9CiAKQEAgLTQw
Myw4ICs0MDYsMjggQEAgaW50IGVuYWJsZV9xaW52YWwoc3RydWN0IHZ0ZF9p
b21tdSAqaW9tbQogCiAgICAgaWYgKCBpb21tdS0+cWludmFsX21hZGRyID09
IDAgKQogICAgIHsKLSAgICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciA9IGFs
bG9jX3BndGFibGVfbWFkZHIoUUlOVkFMX0FSQ0hfUEFHRV9OUiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW9tbXUtPm5vZGUpOworICAgICAgICBpZiAoICFxaV9lbnRyeV9uciApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgKiBXaXRo
IHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1vZGVsLCB3ZSBuZWVkIHR3byBz
bG90cyBmb3IgZXZlcnkKKyAgICAgICAgICAgICAqIG9wZXJhdGlvbiAodGhl
IG9wZXJhdGlvbiBpdHNlbGYgYW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRo
ZXJlCisgICAgICAgICAgICAgKiBjYW4gYmUgb25lIHN1Y2ggcGFpciBvZiBy
ZXF1ZXN0cyBwZW5kaW5nIHBlciBDUFUuICBPbmUgZXh0cmEKKyAgICAgICAg
ICAgICAqIGVudHJ5IGlzIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25zaWRl
cmVkIGZ1bGwgd2hlbiB0aGVyZSdzCisgICAgICAgICAgICAgKiBvbmx5IG9u
ZSBlbnRyeSBsZWZ0LgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBC
VUlMRF9CVUdfT04oQ09ORklHX05SX0NQVVMgKiAyID49IFFJTlZBTF9NQVhf
RU5UUllfTlIpOworICAgICAgICAgICAgcWlfcGdfb3JkZXIgPSBnZXRfb3Jk
ZXJfZnJvbV9ieXRlcygobnVtX3ByZXNlbnRfY3B1cygpICogMiArIDEpIDw8
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChQQUdFX1NISUZUIC0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFFJTlZBTF9FTlRSWV9PUkRFUikpOwor
ICAgICAgICAgICAgcWlfZW50cnlfbnIgPSAxdSA8PCAocWlfcGdfb3JkZXIg
KyBRSU5WQUxfRU5UUllfT1JERVIpOworCisgICAgICAgICAgICBkcHJpbnRr
KFhFTkxPR19JTkZPIFZURFBSRUZJWCwKKyAgICAgICAgICAgICAgICAgICAg
IlFJOiB1c2luZyAldS1lbnRyeSByaW5nKHMpXG4iLCBxaV9lbnRyeV9ucik7
CisgICAgICAgIH0KKworICAgICAgICBpb21tdS0+cWludmFsX21hZGRyID0K
KyAgICAgICAgICAgIGFsbG9jX3BndGFibGVfbWFkZHIocWlfZW50cnlfbnIg
Pj4gUUlOVkFMX0VOVFJZX09SREVSLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpb21tdS0+bm9kZSk7CiAgICAgICAgIGlmICggaW9tbXUt
PnFpbnZhbF9tYWRkciA9PSAwICkKICAgICAgICAgewogICAgICAgICAgICAg
ZHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgsCkBAIC00MTgsMTUg
KzQ0MSwxNiBAQCBpbnQgZW5hYmxlX3FpbnZhbChzdHJ1Y3QgdnRkX2lvbW11
ICppb21tCiAKICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPnJlZ2lz
dGVyX2xvY2ssIGZsYWdzKTsKIAotICAgIC8qIFNldHVwIEludmFsaWRhdGlv
biBRdWV1ZSBBZGRyZXNzKElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUKLSAgICAg
KiBhZGRyZXNzIG9mIHRoZSBwYWdlIHdlIGp1c3QgYWxsb2NhdGVkLiAgUVMg
ZmllbGQgYXQKLSAgICAgKiBiaXRzWzI6MF0gdG8gaW5kaWNhdGUgc2l6ZSBv
ZiBxdWV1ZSBpcyBvbmUgNEtCIHBhZ2UuCi0gICAgICogVGhhdCdzIDI1NiBl
bnRyaWVzLiAgUXVldWVkIEhlYWQgKElRSCkgYW5kIFF1ZXVlIFRhaWwgKElR
VCkKLSAgICAgKiByZWdpc3RlcnMgYXJlIGF1dG9tYXRpY2FsbHkgcmVzZXQg
dG8gMCB3aXRoIHdyaXRlCi0gICAgICogdG8gSVFBIHJlZ2lzdGVyLgorICAg
IC8qCisgICAgICogU2V0dXAgSW52YWxpZGF0aW9uIFF1ZXVlIEFkZHJlc3Mg
KElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUgYWRkcmVzcyBvZiB0aGUKKyAgICAg
KiBwYWdlcyB3ZSBqdXN0IGFsbG9jYXRlZC4gIFRoZSBRUyBmaWVsZCBhdCBi
aXRzWzI6MF0gaW5kaWNhdGVzIHRoZSBzaXplCisgICAgICogKHBhZ2Ugb3Jk
ZXIpIG9mIHRoZSBxdWV1ZS4KKyAgICAgKgorICAgICAqIFF1ZXVlZCBIZWFk
IChJUUgpIGFuZCBRdWV1ZSBUYWlsIChJUVQpIHJlZ2lzdGVycyBhcmUgYXV0
b21hdGljYWxseQorICAgICAqIHJlc2V0IHRvIDAgd2l0aCB3cml0ZSB0byBJ
UUEgcmVnaXN0ZXIuCiAgICAgICovCiAgICAgZG1hcl93cml0ZXEoaW9tbXUt
PnJlZywgRE1BUl9JUUFfUkVHLAotICAgICAgICAgICAgICAgIGlvbW11LT5x
aW52YWxfbWFkZHIgfCBRSU5WQUxfUEFHRV9PUkRFUik7CisgICAgICAgICAg
ICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciB8IHFpX3BnX29yZGVyKTsKIAog
ICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIERNQVJfSVFUX1JFRywgMCk7
CiAK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.14-2.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.14-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHNpemUgY29tbWFuZCBidWZmZXIgZHluYW1pY2FsbHkK
CldpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9kZWwsIHdlIG5lZWQg
dHdvIHNsb3RzIGZvciBldmVyeQpvcGVyYXRpb24gKHRoZSBvcGVyYXRpb24g
aXRzZWxmIGFuZCBhIHdhaXQgY29tbWFuZCkuICBUaGVyZSBjYW4gYmUgb25l
CnN1Y2ggcGFpciBvZiBjb21tYW5kcyBwZW5kaW5nIHBlciBDUFUuIFRvIGVu
c3VyZSB0aGF0IHVuZGVyIGFsbCBub3JtYWwKY2lyY3Vtc3RhbmNlcyBhIHNs
b3QgaXMgYWx3YXlzIGF2YWlsYWJsZSB3aGVuIG9uZSBpcyByZXF1ZXN0ZWQs
IHNpemUgdGhlCmNvbW1hbmQgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJl
ciBvZiBwcmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAv
IENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50
IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXUtZGVmcy5oCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdS1kZWZzLmgKQEAgLTIwLDkgKzIwLDYgQEAKICNpZm5k
ZWYgQU1EX0lPTU1VX0RFRlNfSAogI2RlZmluZSBBTURfSU9NTVVfREVGU19I
CiAKLS8qIElPTU1VIENvbW1hbmQgQnVmZmVyIGVudHJpZXM6IGluIHBvd2Vy
IG9mIDIgaW5jcmVtZW50cywgbWluaW11bSBvZiAyNTYgKi8KLSNkZWZpbmUg
SU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VOVFJJRVMJNTEyCi0KIC8qIElP
TU1VIEV2ZW50IExvZyBlbnRyaWVzOiBpbiBwb3dlciBvZiAyIGluY3JlbWVu
dHMsIG1pbmltdW0gb2YgMjU2ICovCiAjZGVmaW5lIElPTU1VX0VWRU5UX0xP
R19ERUZBVUxUX0VOVFJJRVMgICAgIDUxMgogCkBAIC0xNjQsOCArMTYxLDgg
QEAgc3RydWN0IGFtZF9pb21tdV9kdGUgewogI2RlZmluZSBJT01NVV9DTURf
QlVGRkVSX0xFTkdUSF9NQVNLCQkweDBGMDAwMDAwCiAjZGVmaW5lIElPTU1V
X0NNRF9CVUZGRVJfTEVOR1RIX1NISUZUCQkyNAogCi0jZGVmaW5lIElPTU1V
X0NNRF9CVUZGRVJfRU5UUllfU0laRQkJCTE2Ci0jZGVmaW5lIElPTU1VX0NN
RF9CVUZGRVJfUE9XRVJfT0YyX0VOVFJJRVNfUEVSX1BBR0UJOAorI2RlZmlu
ZSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSICAgICAgICAgICAgNAor
I2RlZmluZSBJT01NVV9DTURfQlVGRkVSX01BWF9FTlRSSUVTICAgICAgICAg
ICAgKDF1IDw8IDE1KQogCiAjZGVmaW5lIElPTU1VX0NNRF9PUENPREVfTUFT
SwkJCTB4RjAwMDAwMDAKICNkZWZpbmUgSU9NTVVfQ01EX09QQ09ERV9TSElG
VAkJCTI4Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9jbWQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfY21kLmMKQEAgLTI0LDcgKzI0LDcgQEAgc3RhdGljIGludCBxdWV1ZV9p
b21tdV9jb21tYW5kKHN0cnVjdCBhbQogewogICAgIHVpbnQzMl90IHRhaWws
IGhlYWQ7CiAKLSAgICB0YWlsID0gaW9tbXUtPmNtZF9idWZmZXIudGFpbCAr
IElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRTsKKyAgICB0YWlsID0gaW9t
bXUtPmNtZF9idWZmZXIudGFpbCArIHNpemVvZihjbWRfZW50cnlfdCk7CiAg
ICAgaWYgKCB0YWlsID09IGlvbW11LT5jbWRfYnVmZmVyLnNpemUgKQogICAg
ICAgICB0YWlsID0gMDsKIApAQCAtMzMsNyArMzMsNyBAQCBzdGF0aWMgaW50
IHF1ZXVlX2lvbW11X2NvbW1hbmQoc3RydWN0IGFtCiAgICAgaWYgKCBoZWFk
ICE9IHRhaWwgKQogICAgIHsKICAgICAgICAgbWVtY3B5KGlvbW11LT5jbWRf
YnVmZmVyLmJ1ZmZlciArIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwsCi0gICAg
ICAgICAgICAgICBjbWQsIElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRSk7
CisgICAgICAgICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwog
CiAgICAgICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWlsOwogICAg
ICAgICByZXR1cm4gMTsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfaW5pdC5jCkBAIC0xMTgsNyArMTE4LDcgQEAgc3RhdGlj
IHZvaWQgcmVnaXN0ZXJfaW9tbXVfY21kX2J1ZmZlcl9pbgogICAgIHdyaXRl
bChlbnRyeSwgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NNRF9CVUZGRVJf
QkFTRV9MT1dfT0ZGU0VUKTsKIAogICAgIHBvd2VyX29mMl9lbnRyaWVzID0g
Z2V0X29yZGVyX2Zyb21fYnl0ZXMoaW9tbXUtPmNtZF9idWZmZXIuc2l6ZSkg
KwotICAgICAgICBJT01NVV9DTURfQlVGRkVSX1BPV0VSX09GMl9FTlRSSUVT
X1BFUl9QQUdFOworICAgICAgICBQQUdFX1NISUZUIC0gSU9NTVVfQ01EX0JV
RkZFUl9FTlRSWV9PUkRFUjsKIAogICAgIGVudHJ5ID0gMDsKICAgICBpb21t
dV9zZXRfYWRkcl9oaV90b19yZWcoJmVudHJ5LCBhZGRyX2hpKTsKQEAgLTEw
MjIsOSArMTAyMiwzMSBAQCBzdGF0aWMgdm9pZCAqX19pbml0IGFsbG9jYXRl
X3JpbmdfYnVmZmVyCiBzdGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0ZV9j
bWRfYnVmZmVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQogewogICAgIC8q
IGFsbG9jYXRlICdjb21tYW5kIGJ1ZmZlcicgaW4gcG93ZXIgb2YgMiBpbmNy
ZW1lbnRzIG9mIDRLICovCisgICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3Jl
YWRfbW9zdGx5IG5yX2VudHM7CisKKyAgICBpZiAoICFucl9lbnRzICkKKyAg
ICB7CisgICAgICAgIHVuc2lnbmVkIGludCBvcmRlcjsKKworICAgICAgICAv
KgorICAgICAgICAgKiBXaXRoIHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1v
ZGVsLCB3ZSBuZWVkIHR3byBzbG90cyBmb3IgZXZlcnkKKyAgICAgICAgICog
b3BlcmF0aW9uICh0aGUgb3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0IGNv
bW1hbmQpLiAgVGhlcmUgY2FuIGJlCisgICAgICAgICAqIG9uZSBzdWNoIHBh
aXIgb2YgcmVxdWVzdHMgcGVuZGluZyBwZXIgQ1BVLiAgT25lIGV4dHJhIGVu
dHJ5IGlzCisgICAgICAgICAqIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25z
aWRlcmVkIGZ1bGwgd2hlbiB0aGVyZSdzIG9ubHkgb25lIGVudHJ5CisgICAg
ICAgICAqIGxlZnQuCisgICAgICAgICAqLworICAgICAgICBCVUlMRF9CVUdf
T04oQ09ORklHX05SX0NQVVMgKiAyID49IElPTU1VX0NNRF9CVUZGRVJfTUFY
X0VOVFJJRVMpOworICAgICAgICBvcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5
dGVzKChudW1fcHJlc2VudF9jcHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9DTURfQlVGRkVS
X0VOVFJZX09SREVSKTsKKyAgICAgICAgbnJfZW50cyA9IDF1IDw8IChvcmRl
ciArIFBBR0VfU0hJRlQgLSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVS
KTsKKworICAgICAgICBBTURfSU9NTVVfREVCVUcoInVzaW5nICV1LWVudHJ5
IGNtZCByaW5nKHMpXG4iLCBucl9lbnRzKTsKKyAgICB9CisKKyAgICBCVUlM
RF9CVUdfT04oc2l6ZW9mKGNtZF9lbnRyeV90KSAhPSAoMXUgPDwgSU9NTVVf
Q01EX0JVRkZFUl9FTlRSWV9PUkRFUikpOworCiAgICAgcmV0dXJuIGFsbG9j
YXRlX3JpbmdfYnVmZmVyKCZpb21tdS0+Y21kX2J1ZmZlciwgc2l6ZW9mKGNt
ZF9lbnRyeV90KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VOVFJJRVMsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICJDb21tYW5kIEJ1ZmZlciIsIGZhbHNl
KTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJfZW50cywg
IkNvbW1hbmQgQnVmZmVyIiwgZmFsc2UpOwogfQogCiBzdGF0aWMgdm9pZCAq
IF9faW5pdCBhbGxvY2F0ZV9ldmVudF9sb2coc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUpCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.14-3.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.14-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBlbGltaW5hdGUgZmx1c2ggcmVsYXRlZCB0aW1lb3V0cwoKTGVh
dmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24gcGVuZGluZyB3aGVuIGl0
IGFwcGVhcnMgdG8gdGFrZSB0b28KbG9uZyBpcyBwcm9ibGVtYXRpYzogSWYg
ZS5nLiBhIFFJIGNvbW1hbmQgY29tcGxldGVkIGxhdGVyLCB0aGUgd3JpdGUg
dG8KdGhlICJwb2xsIHNsb3QiIG1heSBpbnN0ZWFkIGJlIHVuZGVyc3Rvb2Qg
dG8gc2lnbmFsIGEgc3Vic2VxdWVudGx5CnN0YXJ0ZWQgY29tbWFuZCdzIGNv
bXBsZXRpb24uIEFsc28gb3VyIGFjY291bnRpbmcgb2YgdGhlIHRpbWVvdXQg
cGVyaW9kCndhcyBhY3R1YWxseSB3cm9uZzogV2UgaW5jbHVkZWQgdGhlIHRp
bWUgaXQgdG9vayBmb3IgdGhlIGNvbW1hbmQgdG8KYWN0dWFsbHkgbWFrZSBp
dCB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLCB3aGljaCBjb3VsZCBiZSBo
ZWF2aWx5CmFmZmVjdGVkIGJ5IGd1ZXN0cyBvdGhlciB0aGFuIHRoZSBvbmUg
Zm9yIHdoaWNoIHRoZSBmbHVzaCBpcyBiZWluZwpwZXJmb3JtZWQuCgpEbyBh
d2F5IHdpdGggYWxsIHRpbWVvdXQgZGV0ZWN0aW9uIG9uIGFsbCBmbHVzaCBy
ZWxhdGVkIGNvZGUgcGF0aHMuCkxvZyBleGNlc3NpdmVseSBsb25nIHByb2Nl
c3NpbmcgdGltZXMgKHdpdGggYSBwcm9ncmVzc2l2ZSB0aHJlc2hvbGQpIHRv
CmhhdmUgc29tZSBpbmRpY2F0aW9uIG9mIHByb2JsZW1zIGluIHRoaXMgYXJl
YS4KCkFkZGl0aW9uYWxseSBsb2cgKG9uY2UpIGlmIHFpbnZhbF9uZXh0X2lu
ZGV4KCkgZGlkbid0IGltbWVkaWF0ZWx5IGZpbmQKYW4gYXZhaWxhYmxlIHNs
b3QuIFRvZ2V0aGVyIHdpdGggdGhlIGVhcmxpZXIgY2hhbmdlIHNpemluZyB0
aGUgcXVldWUocykKZHluYW1pY2FsbHksIHdlIHNob3VsZCBub3cgaGF2ZSBh
IGd1YXJhbnRlZSB0aGF0IHdpdGggb3VyIGZ1bGx5CnN5bmNocm9ub3VzIG1v
ZGVsIGFueSBkZW1hbmQgZm9yIHNsb3RzIGNhbiBhY3R1YWxseSBiZSBzYXRp
c2ZpZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4
NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5v
cmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZG1hci5o
CisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmgKQEAg
LTEyNyw2ICsxMjcsMzQgQEAgZG8gewogICAgIH0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
IH0gd2hpbGUgKDApCiAKKyNkZWZpbmUgSU9NTVVfRkxVU0hfV0FJVCh3aGF0
LCBpb21tdSwgb2Zmc2V0LCBvcCwgY29uZCwgc3RzKSAgICAgICBcCitkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
X19yZWFkX21vc3RseSB0aHJlc2hvbGQgPSAxOyAgICAgICAgICAgICAgIFwK
KyAgICBzX3RpbWVfdCBzdGFydCA9IE5PVygpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgc190aW1lX3QgdGltZW91
dCA9IHN0YXJ0ICsgRE1BUl9PUEVSQVRJT05fVElNRU9VVCAqIHRocmVzaG9s
ZDsgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCA7IDsg
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBz
dHMgPSBvcChpb21tdS0+cmVnLCBvZmZzZXQpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBjb25kICkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICBpZiAoIHRpbWVvdXQgJiYg
Tk9XKCkgPiB0aW1lb3V0ICkgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICB0aHJlc2hv
bGQgfD0gdGhyZXNob2xkIDw8IDE7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBS
RUZJWCAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAiIElPTU1VIyV1OiAlcyBmbHVzaCB0YWtpbmcgdG9vIGxvbmdcbiIs
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCB3
aGF0KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgdGltZW91dCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgfSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgIGNwdV9yZWxheCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIH0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgaWYgKCAhdGltZW91dCAp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklY
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICIgSU9NTVUjJXU6ICVzIGZsdXNoIHRvb2sgJWx1bXNcbiIsICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIHdoYXQs
IChOT1coKSAtIHN0YXJ0KSAvIDEwMDAwMDAwKTsgICAgXAorfSB3aGlsZSAo
IGZhbHNlICkKKwogaW50IHZ0ZF9od19jaGVjayh2b2lkKTsKIHZvaWQgZGlz
YWJsZV9wbXIoc3RydWN0IHZ0ZF9pb21tdSAqaW9tbXUpOwogaW50IGlzX2ln
ZF9kcmhkKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCk7Ci0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCkBAIC0zMjYsOCArMzI2
LDggQEAgc3RhdGljIHZvaWQgaW9tbXVfZmx1c2hfd3JpdGVfYnVmZmVyKHN0
cgogICAgIGRtYXJfd3JpdGVsKGlvbW11LT5yZWcsIERNQVJfR0NNRF9SRUcs
IHZhbCB8IERNQV9HQ01EX1dCRik7CiAKICAgICAvKiBNYWtlIHN1cmUgaGFy
ZHdhcmUgY29tcGxldGUgaXQgKi8KLSAgICBJT01NVV9XQUlUX09QKGlvbW11
LCBETUFSX0dTVFNfUkVHLCBkbWFyX3JlYWRsLAotICAgICAgICAgICAgICAg
ICAgISh2YWwgJiBETUFfR1NUU19XQkZTKSwgdmFsKTsKKyAgICBJT01NVV9G
TFVTSF9XQUlUKCJ3cml0ZSBidWZmZXIiLCBpb21tdSwgRE1BUl9HU1RTX1JF
RywgZG1hcl9yZWFkbCwKKyAgICAgICAgICAgICAgICAgICAgICEodmFsICYg
RE1BX0dTVFNfV0JGUyksIHZhbCk7CiAKICAgICBzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpb21tdS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogfQpAQCAt
Mzc2LDggKzM3Niw4IEBAIGludCB2dGRfZmx1c2hfY29udGV4dF9yZWcoc3Ry
dWN0IHZ0ZF9pb20KICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVnLCBETUFS
X0NDTURfUkVHLCB2YWwpOwogCiAgICAgLyogTWFrZSBzdXJlIGhhcmR3YXJl
IGNvbXBsZXRlIGl0ICovCi0gICAgSU9NTVVfV0FJVF9PUChpb21tdSwgRE1B
Ul9DQ01EX1JFRywgZG1hcl9yZWFkcSwKLSAgICAgICAgICAgICAgICAgICEo
dmFsICYgRE1BX0NDTURfSUNDKSwgdmFsKTsKKyAgICBJT01NVV9GTFVTSF9X
QUlUKCJjb250ZXh0IiwgaW9tbXUsIERNQVJfQ0NNRF9SRUcsIGRtYXJfcmVh
ZHEsCisgICAgICAgICAgICAgICAgICAgICAhKHZhbCAmIERNQV9DQ01EX0lD
QyksIHZhbCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21t
dS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogICAgIC8qIGZsdXNoIGNvbnRl
eHQgZW50cnkgd2lsbCBpbXBsaWNpdGx5IGZsdXNoIHdyaXRlIGJ1ZmZlciAq
LwpAQCAtNDU0LDggKzQ1NCw4IEBAIGludCB2dGRfZmx1c2hfaW90bGJfcmVn
KHN0cnVjdCB2dGRfaW9tbXUKICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVn
LCB0bGJfb2Zmc2V0ICsgOCwgdmFsKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBo
YXJkd2FyZSBjb21wbGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9t
bXUsICh0bGJfb2Zmc2V0ICsgOCksIGRtYXJfcmVhZHEsCi0gICAgICAgICAg
ICAgICAgICAhKHZhbCAmIERNQV9UTEJfSVZUKSwgdmFsKTsKKyAgICBJT01N
VV9GTFVTSF9XQUlUKCJpb3RsYiIsIGlvbW11LCAodGxiX29mZnNldCArIDgp
LCBkbWFyX3JlYWRxLAorICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBE
TUFfVExCX0lWVCksIHZhbCk7CiAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmaW9tbXUtPnJlZ2lzdGVyX2xvY2ssIGZsYWdzKTsKIAogICAgIC8qIGNo
ZWNrIElPVExCIGludmFsaWRhdGlvbiBncmFudWxhcml0eSAqLwotLS0gYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcWludmFsLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCkBAIC0yOSw4ICsy
OSw2IEBACiAjaW5jbHVkZSAiZXh0ZXJuLmgiCiAjaW5jbHVkZSAiLi4vYXRz
LmgiCiAKLSNkZWZpbmUgVlREX1FJX1RJTUVPVVQJMQotCiBzdGF0aWMgdW5z
aWduZWQgaW50IF9fcmVhZF9tb3N0bHkgcWlfcGdfb3JkZXI7CiBzdGF0aWMg
dW5zaWduZWQgaW50IF9fcmVhZF9tb3N0bHkgcWlfZW50cnlfbnI7CiAKQEAg
LTYwLDcgKzU4LDExIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgcWludmFsX25l
eHRfaW5kZXgoc3QKICAgICAvKiAodGFpbCsxID09IGhlYWQpIGluZGljYXRl
cyBhIGZ1bGwgcXVldWUsIHdhaXQgZm9yIEhXICovCiAgICAgd2hpbGUgKCAo
KHRhaWwgKyAxKSAmIChxaV9lbnRyeV9uciAtIDEpKSA9PQogICAgICAgICAg
ICAgKCBkbWFyX3JlYWRxKGlvbW11LT5yZWcsIERNQVJfSVFIX1JFRykgPj4g
UUlOVkFMX0lOREVYX1NISUZUICkgKQorICAgIHsKKyAgICAgICAgcHJpbnRr
X29uY2UoWEVOTE9HX0VSUiBWVERQUkVGSVggIiBJT01NVSMldTogbm8gUUkg
c2xvdCBhdmFpbGFibGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11
LT5pbmRleCk7CiAgICAgICAgIGNwdV9yZWxheCgpOworICAgIH0KIAogICAg
IHJldHVybiB0YWlsOwogfQpAQCAtMTgwLDIzICsxODIsMzIgQEAgc3RhdGlj
IGludCBfX211c3RfY2hlY2sgcXVldWVfaW52YWxpZGF0ZQogICAgIC8qIE5v
dyB3ZSBkb24ndCBzdXBwb3J0IGludGVycnVwdCBtZXRob2QgKi8KICAgICBp
ZiAoIHN3ICkKICAgICB7Ci0gICAgICAgIHNfdGltZV90IHRpbWVvdXQ7Ci0K
LSAgICAgICAgLyogSW4gY2FzZSBhbGwgd2FpdCBkZXNjcmlwdG9yIHdyaXRl
cyB0byBzYW1lIGFkZHIgd2l0aCBzYW1lIGRhdGEgKi8KLSAgICAgICAgdGlt
ZW91dCA9IE5PVygpICsgTUlMTElTRUNTKGZsdXNoX2Rldl9pb3RsYiA/Ci0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb21tdV9kZXZf
aW90bGJfdGltZW91dCA6IFZURF9RSV9USU1FT1VUKTsKKyAgICAgICAgc3Rh
dGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7
CisgICAgICAgIHNfdGltZV90IHN0YXJ0ID0gTk9XKCk7CisgICAgICAgIHNf
dGltZV90IHRpbWVvdXQgPSBzdGFydCArIChmbHVzaF9kZXZfaW90bGIKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gaW9tbXVfZGV2
X2lvdGxiX3RpbWVvdXQKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDogMTAwKSAqIE1JTExJU0VDUyh0aHJlc2hvbGQpOwogCiAgICAg
ICAgIHdoaWxlICggQUNDRVNTX09OQ0UoKnRoaXNfcG9sbF9zbG90KSAhPSBR
SU5WQUxfU1RBVF9ET05FICkKICAgICAgICAgewotICAgICAgICAgICAgaWYg
KCBOT1coKSA+IHRpbWVvdXQgKQorICAgICAgICAgICAgaWYgKCB0aW1lb3V0
ICYmIE5PVygpID4gdGltZW91dCApCiAgICAgICAgICAgICB7Ci0gICAgICAg
ICAgICAgICAgcHJpbnRfcWlfcmVncyhpb21tdSk7CisgICAgICAgICAgICAg
ICAgdGhyZXNob2xkIHw9IHRocmVzaG9sZCA8PCAxOwogICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAg
ICAgICAgICAgICAgICAgIiBRdWV1ZSBpbnZhbGlkYXRlIHdhaXQgZGVzY3Jp
cHRvciB0aW1lZCBvdXRcbiIpOwotICAgICAgICAgICAgICAgIHJldHVybiAt
RVRJTUVET1VUOworICAgICAgICAgICAgICAgICAgICAgICAiIElPTU1VIyV1
OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0YWtpbmcgdG9vIGxvbmdcbiIsCisg
ICAgICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRleCwgZmx1c2hfZGV2
X2lvdGxiID8gIiBkZXYiIDogIiIpOworICAgICAgICAgICAgICAgIHByaW50
X3FpX3JlZ3MoaW9tbXUpOworICAgICAgICAgICAgICAgIHRpbWVvdXQgPSAw
OwogICAgICAgICAgICAgfQogICAgICAgICAgICAgY3B1X3JlbGF4KCk7CiAg
ICAgICAgIH0KKworICAgICAgICBpZiAoICF0aW1lb3V0ICkKKyAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKKyAgICAgICAg
ICAgICAgICAgICAiIElPTU1VIyV1OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0
b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRl
eCwgZmx1c2hfZGV2X2lvdGxiID8gIiBkZXYiIDogIiIsCisgICAgICAgICAg
ICAgICAgICAgKE5PVygpIC0gc3RhcnQpIC8gMTAwMDAwMDApOworCiAgICAg
ICAgIHJldHVybiAwOwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.14-4.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.14-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHdhaXQgZm9yIGNvbW1hbmQgc2xvdCB0byBiZSBhdmFp
bGFibGUKCk5vIGNhbGxlciBjYXJlZCBhYm91dCBzZW5kX2lvbW11X2NvbW1h
bmQoKSBpbmRpY2F0aW5nIHVuYXZhaWxhYmlsaXR5IG9mCmEgc2xvdC4gSGVu
Y2UgaWYgYSBzdWZmaWNpZW50IG51bWJlciBwcmlvciBjb21tYW5kcyB0aW1l
ZCBvdXQsIHdlIGRpZApibGluZGx5IGFzc3VtZSB0aGF0IHRoZSByZXF1ZXN0
ZWQgY29tbWFuZCB3YXMgc3VibWl0dGVkIHRvIHRoZSBJT01NVQp3aGVuIHJl
YWxseSBpdCB3YXNuJ3QuIFRoaXMgY291bGQgbWVhbiBib3RoIGEgaGFuZ2lu
ZyBzeXN0ZW0gKHdhaXRpbmcKZm9yIGEgY29tbWFuZCB0byBjb21wbGV0ZSB0
aGF0IHdhcyBuZXZlciBzZWVuIGJ5IHRoZSBJT01NVSkgb3IgYmxpbmRseQpw
cm9wYWdhdGluZyBzdWNjZXNzIGJhY2sgdG8gY2FsbGVycywgbWFraW5nIHRo
ZW0gYmVsaWV2ZSB0aGV5J3JlIGZpbmUKdG8gZS5nLiBmcmVlIHByZXZpb3Vz
bHkgdW5tYXBwZWQgcGFnZXMuCgpGb2xkIHRoZSB0aHJlZSBpbnZvbHZlZCBm
dW5jdGlvbnMgaW50byBvbmUsIGFkZCBzcGluIHdhaXRpbmcgZm9yIGFuCmF2
YWlsYWJsZSBzbG90IGFsb25nIHRoZSBsaW5lcyBvZiBWVC1kJ3MgcWludmFs
X25leHRfaW5kZXgoKSwgYW5kIGFzIGEKY29uc2VxdWVuY2UgZHJvcCBhbGwg
ZXJyb3IgaW5kaWNhdG9yIHJldHVybiB0eXBlcy92YWx1ZXMuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yMCw0
MyArMjAsMzIgQEAKICNpbmNsdWRlICJpb21tdS5oIgogI2luY2x1ZGUgIi4u
L2F0cy5oIgogCi1zdGF0aWMgaW50IHF1ZXVlX2lvbW11X2NvbW1hbmQoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsIHUzMiBjbWRbXSkKK3N0YXRpYyB2b2lk
IHNlbmRfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJf
dCBjbWRbNF0pCiB7Ci0gICAgdWludDMyX3QgdGFpbCwgaGVhZDsKKyAgICB1
aW50MzJfdCB0YWlsOwogCiAgICAgdGFpbCA9IGlvbW11LT5jbWRfYnVmZmVy
LnRhaWwgKyBzaXplb2YoY21kX2VudHJ5X3QpOwogICAgIGlmICggdGFpbCA9
PSBpb21tdS0+Y21kX2J1ZmZlci5zaXplICkKICAgICAgICAgdGFpbCA9IDA7
CiAKLSAgICBoZWFkID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArCi0gICAg
ICAgICAgICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpICYg
SU9NTVVfUklOR19CVUZGRVJfUFRSX01BU0s7Ci0gICAgaWYgKCBoZWFkICE9
IHRhaWwgKQorICAgIHdoaWxlICggdGFpbCA9PSAocmVhZGwoaW9tbXUtPm1t
aW9fYmFzZSArCisgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9D
TURfQlVGRkVSX0hFQURfT0ZGU0VUKSAmCisgICAgICAgICAgICAgICAgICAg
ICBJT01NVV9SSU5HX0JVRkZFUl9QVFJfTUFTSykgKQogICAgIHsKLSAgICAg
ICAgbWVtY3B5KGlvbW11LT5jbWRfYnVmZmVyLmJ1ZmZlciArIGlvbW11LT5j
bWRfYnVmZmVyLnRhaWwsCi0gICAgICAgICAgICAgICBjbWQsIHNpemVvZihj
bWRfZW50cnlfdCkpOwotCi0gICAgICAgIGlvbW11LT5jbWRfYnVmZmVyLnRh
aWwgPSB0YWlsOwotICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgcHJpbnRr
X29uY2UoWEVOTE9HX0VSUgorICAgICAgICAgICAgICAgICAgICAiQU1EIElP
TU1VICUwNHg6JTAyeDolMDJ4LiV1OiBubyBjbWQgc2xvdCBhdmFpbGFibGVc
biIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11LT5zZWcsIFBDSV9CVVMo
aW9tbXUtPmJkZiksCisgICAgICAgICAgICAgICAgICAgIFBDSV9TTE9UKGlv
bW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSk7CisgICAgICAgIGNw
dV9yZWxheCgpOwogICAgIH0KIAotICAgIHJldHVybiAwOwotfQotCi1zdGF0
aWMgdm9pZCBjb21taXRfaW9tbXVfY29tbWFuZF9idWZmZXIoc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXUpCi17Ci0gICAgd3JpdGVsKGlvbW11LT5jbWRfYnVm
ZmVyLnRhaWwsCi0gICAgICAgICAgIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01N
VV9DTURfQlVGRkVSX1RBSUxfT0ZGU0VUKTsKLX0KKyAgICBtZW1jcHkoaW9t
bXUtPmNtZF9idWZmZXIuYnVmZmVyICsgaW9tbXUtPmNtZF9idWZmZXIudGFp
bCwKKyAgICAgICAgICAgY21kLCBzaXplb2YoY21kX2VudHJ5X3QpKTsKIAot
c3RhdGljIGludCBzZW5kX2lvbW11X2NvbW1hbmQoc3RydWN0IGFtZF9pb21t
dSAqaW9tbXUsIHUzMiBjbWRbXSkKLXsKLSAgICBpZiAoIHF1ZXVlX2lvbW11
X2NvbW1hbmQoaW9tbXUsIGNtZCkgKQotICAgIHsKLSAgICAgICAgY29tbWl0
X2lvbW11X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKLSAgICAgICAgcmV0dXJu
IDE7Ci0gICAgfQorICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWls
OwogCi0gICAgcmV0dXJuIDA7CisgICAgd3JpdGVsKHRhaWwsIGlvbW11LT5t
bWlvX2Jhc2UgKyBJT01NVV9DTURfQlVGRkVSX1RBSUxfT0ZGU0VUKTsKIH0K
IAogc3RhdGljIHZvaWQgZmx1c2hfY29tbWFuZF9idWZmZXIoc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXUpCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.14-5.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.14-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRyb3AgY29tbWFuZCBjb21wbGV0aW9uIHRpbWVvdXQK
CkZpcnN0IGFuZCBmb3JlbW9zdCAtIHN1Y2ggdGltZW91dHMgd2VyZSBub3Qg
c2lnbmFsZWQgdG8gY2FsbGVycywgbWFraW5nCnRoZW0gYmVsaWV2ZSB0aGV5
J3JlIGZpbmUgdG8gZS5nLiBmcmVlIHByZXZpb3VzbHkgdW5tYXBwZWQgcGFn
ZXMuCgpNaXJyb3IgVlQtZCdzIGJlaGF2aW9yOiBBIGZpeGVkIG51bWJlciBv
ZiBsb29wIGl0ZXJhdGlvbnMgaXMgbm90IGEKc3VpdGFibGUgd2F5IHRvIGRl
dGVjdCB0aW1lb3V0cyBpbiBhbiBlbnZpcm9ubWVudCAoQ1BVIGFuZCBidXMg
c3BlZWRzKQppbmRlcGVuZGVudCBtYW5uZXIgYW55d2F5LiBGdXJ0aGVybW9y
ZSwgbGVhdmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24KcGVuZGluZyB3
aGVuIGl0IGFwcGVhcnMgdG8gdGFrZSB0b28gbG9uZyBpcyBwcm9ibGVtYXRp
YzogSWYgYSBjb21tYW5kCmNvbXBsZXRlZCBsYXRlciwgdGhlIHNpZ25hbGlu
ZyBvZiBpdHMgY29tcGxldGlvbiBtYXkgaW5zdGVhZCBiZQp1bmRlcnN0b29k
IHRvIHNpZ25hbCBhIHN1YnNlcXVlbnRseSBzdGFydGVkIGNvbW1hbmQncyBj
b21wbGV0aW9uLgoKTG9nIGV4Y2Vzc2l2ZWx5IGxvbmcgcHJvY2Vzc2luZyB0
aW1lcyAod2l0aCBhIHByb2dyZXNzaXZlIHRocmVzaG9sZCkgdG8KaGF2ZSBz
b21lIGluZGljYXRpb24gb2YgcHJvYmxlbXMgaW4gdGhpcyBhcmVhLiBBbGxv
dyBjYWxsZXJzIHRvIHNwZWNpZnkKYSBub24tZGVmYXVsdCB0aW1lb3V0IGJp
YXMgZm9yIHRoaXMgbG9nZ2luZywgdXNpbmcgdGhlIHNhbWUgdmFsdWVzIGFz
ClZULWQgZG9lcywgd2hpY2ggaW4gcGFydGljdWxhciBtZWFucyBhIChieSBk
ZWZhdWx0KSBtdWNoIGxhcmdlciB2YWx1ZQpmb3IgZGV2aWNlIElPIFRMQiBp
bnZhbGlkYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2NtZC5jCkBAIC00OCwxMCArNDgsMTIgQEAgc3RhdGljIHZvaWQg
c2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbQogICAgIHdyaXRlbCh0YWls
LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ01EX0JVRkZFUl9UQUlMX09G
RlNFVCk7CiB9CiAKLXN0YXRpYyB2b2lkIGZsdXNoX2NvbW1hbmRfYnVmZmVy
KHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQorc3RhdGljIHZvaWQgZmx1c2hf
Y29tbWFuZF9idWZmZXIoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgdGlt
ZW91dF9iYXNlKQogewotICAgIHVuc2lnbmVkIGludCBjbWRbNF0sIHN0YXR1
cywgbG9vcF9jb3VudDsKLSAgICBib29sIGNvbXBfd2FpdDsKKyAgICB1aW50
MzJfdCBjbWRbNF07CisgICAgc190aW1lX3Qgc3RhcnQsIHRpbWVvdXQ7Cisg
ICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9s
ZCA9IDE7CiAKICAgICAvKiBSVzFDICdDb21XYWl0SW50JyBpbiBzdGF0dXMg
cmVnaXN0ZXIgKi8KICAgICB3cml0ZWwoSU9NTVVfU1RBVFVTX0NPTVBfV0FJ
VF9JTlQsCkBAIC02NywyMiArNjksMzEgQEAgc3RhdGljIHZvaWQgZmx1c2hf
Y29tbWFuZF9idWZmZXIoc3RydWN0CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVfQ09NUF9XQUlUX0lfRkxBR19TSElGVCwgJmNtZFswXSk7CiAg
ICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11LCBjbWQpOwogCi0gICAgLyog
TWFrZSBsb29wX2NvdW50IGxvbmcgZW5vdWdoIGZvciBwb2xsaW5nIGNvbXBs
ZXRpb24gd2FpdCBiaXQgKi8KLSAgICBsb29wX2NvdW50ID0gMTAwMDsKLSAg
ICBkbyB7Ci0gICAgICAgIHN0YXR1cyA9IHJlYWRsKGlvbW11LT5tbWlvX2Jh
c2UgKyBJT01NVV9TVEFUVVNfTU1JT19PRkZTRVQpOwotICAgICAgICBjb21w
X3dhaXQgPSBzdGF0dXMgJiBJT01NVV9TVEFUVVNfQ09NUF9XQUlUX0lOVDsK
LSAgICAgICAgLS1sb29wX2NvdW50OwotICAgIH0gd2hpbGUgKCAhY29tcF93
YWl0ICYmIGxvb3BfY291bnQgKTsKLQotICAgIGlmICggY29tcF93YWl0ICkK
KyAgICBzdGFydCA9IE5PVygpOworICAgIHRpbWVvdXQgPSBzdGFydCArICh0
aW1lb3V0X2Jhc2UgPzogMTAwKSAqIE1JTExJU0VDUyh0aHJlc2hvbGQpOwor
ICAgIHdoaWxlICggIShyZWFkbChpb21tdS0+bW1pb19iYXNlICsgSU9NTVVf
U1RBVFVTX01NSU9fT0ZGU0VUKSAmCisgICAgICAgICAgICAgIElPTU1VX1NU
QVRVU19DT01QX1dBSVRfSU5UKSApCiAgICAgewotICAgICAgICAvKiBSVzFD
ICdDb21XYWl0SW50JyBpbiBzdGF0dXMgcmVnaXN0ZXIgKi8KLSAgICAgICAg
d3JpdGVsKElPTU1VX1NUQVRVU19DT01QX1dBSVRfSU5ULAotICAgICAgICAg
ICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX1NUQVRVU19NTUlPX09G
RlNFVCk7Ci0gICAgICAgIHJldHVybjsKKyAgICAgICAgaWYgKCB0aW1lb3V0
ICYmIE5PVygpID4gdGltZW91dCApCisgICAgICAgIHsKKyAgICAgICAgICAg
IHRocmVzaG9sZCB8PSB0aHJlc2hvbGQgPDwgMTsKKyAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfV0FSTklORworICAgICAgICAgICAgICAgICAgICJBTUQg
SU9NTVUgJTA0eDolMDJ4OiUwMnguJXU6ICVzY29tcGxldGlvbiB3YWl0IHRh
a2luZyB0b28gbG9uZ1xuIiwKKyAgICAgICAgICAgICAgICAgICBpb21tdS0+
c2VnLCBQQ0lfQlVTKGlvbW11LT5iZGYpLAorICAgICAgICAgICAgICAgICAg
IFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSwK
KyAgICAgICAgICAgICAgICAgICB0aW1lb3V0X2Jhc2UgPyAiaW90bGIgIiA6
ICIiKTsKKyAgICAgICAgICAgIHRpbWVvdXQgPSAwOworICAgICAgICB9Cisg
ICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0KLSAgICBBTURfSU9NTVVfREVC
VUcoIldhcm5pbmc6IENvbVdhaXRJbnQgYml0IGRpZCBub3QgYXNzZXJ0IVxu
Iik7CisKKyAgICBpZiAoICF0aW1lb3V0ICkKKyAgICAgICAgcHJpbnRrKFhF
TkxPR19XQVJOSU5HCisgICAgICAgICAgICAgICAiQU1EIElPTU1VICUwNHg6
JTAyeDolMDJ4LiV1OiAlc2NvbXBsZXRpb24gd2FpdCB0b29rICVsdW1zXG4i
LAorICAgICAgICAgICAgICAgaW9tbXUtPnNlZywgUENJX0JVUyhpb21tdS0+
YmRmKSwKKyAgICAgICAgICAgICAgIFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQ
Q0lfRlVOQyhpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgIHRpbWVvdXRf
YmFzZSA/ICJpb3RsYiAiIDogIiIsCisgICAgICAgICAgICAgICAoTk9XKCkg
LSBzdGFydCkgLyAxMDAwMDAwMCk7CiB9CiAKIC8qIEJ1aWxkIGxvdyBsZXZl
bCBpb21tdSBjb21tYW5kIG1lc3NhZ2VzICovCkBAIC0yOTQsNyArMzA1LDcg
QEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW90bGIodTggZGV2Zm4sIGNvbgog
ICAgIC8qIHNlbmQgSU5WQUxJREFURV9JT1RMQl9QQUdFUyBjb21tYW5kICov
CiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlvbW11LT5sb2NrLCBmbGFncyk7
CiAgICAgaW52YWxpZGF0ZV9pb3RsYl9wYWdlcyhpb21tdSwgbWF4cGVuZCwg
MCwgcXVldWVpZCwgZGFkZHIsIHJlcV9pZCwgb3JkZXIpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSwgaW9tbXVfZGV2X2lvdGxiX3RpbWVvdXQpOwogICAgIHNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11LT5sb2NrLCBmbGFncyk7CiB9
CiAKQEAgLTMzMSw3ICszNDIsNyBAQCBzdGF0aWMgdm9pZCBfYW1kX2lvbW11
X2ZsdXNoX3BhZ2VzKHN0cnVjCiAgICAgewogICAgICAgICBzcGluX2xvY2tf
aXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKICAgICAgICAgaW52YWxp
ZGF0ZV9pb21tdV9wYWdlcyhpb21tdSwgZGFkZHIsIGRvbV9pZCwgb3JkZXIp
OwotICAgICAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAg
ICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11LCAwKTsKICAgICAgICAg
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsK
ICAgICB9CiAKQEAgLTM1NSw3ICszNjYsNyBAQCB2b2lkIGFtZF9pb21tdV9m
bHVzaF9kZXZpY2Uoc3RydWN0IGFtZF9pCiAgICAgQVNTRVJUKCBzcGluX2lz
X2xvY2tlZCgmaW9tbXUtPmxvY2spICk7CiAKICAgICBpbnZhbGlkYXRlX2Rl
dl90YWJsZV9lbnRyeShpb21tdSwgYmRmKTsKLSAgICBmbHVzaF9jb21tYW5k
X2J1ZmZlcihpb21tdSk7CisgICAgZmx1c2hfY29tbWFuZF9idWZmZXIoaW9t
bXUsIDApOwogfQogCiB2b2lkIGFtZF9pb21tdV9mbHVzaF9pbnRyZW1hcChz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWludDE2X3QgYmRmKQpAQCAtMzYz
LDcgKzM3NCw3IEBAIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2ludHJlbWFwKHN0
cnVjdCBhbWQKICAgICBBU1NFUlQoIHNwaW5faXNfbG9ja2VkKCZpb21tdS0+
bG9jaykgKTsKIAogICAgIGludmFsaWRhdGVfaW50ZXJydXB0X3RhYmxlKGlv
bW11LCBiZGYpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsK
KyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiB9CiAKIHZv
aWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9jYWNoZXMoc3RydWN0IGFtZF9pb21t
dSAqaW9tbXUpCkBAIC0zNzEsNyArMzgyLDcgQEAgdm9pZCBhbWRfaW9tbXVf
Zmx1c2hfYWxsX2NhY2hlcyhzdHJ1Y3QgYQogICAgIEFTU0VSVCggc3Bpbl9p
c19sb2NrZWQoJmlvbW11LT5sb2NrKSApOwogCiAgICAgaW52YWxpZGF0ZV9p
b21tdV9hbGwoaW9tbXUpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlv
bW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiB9
CiAKIHZvaWQgYW1kX2lvbW11X3NlbmRfZ3Vlc3RfY21kKHN0cnVjdCBhbWRf
aW9tbXUgKmlvbW11LCB1MzIgY21kW10pCkBAIC0zODEsNyArMzkyLDggQEAg
dm9pZCBhbWRfaW9tbXVfc2VuZF9ndWVzdF9jbWQoc3RydWN0IGFtZAogICAg
IHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwogCiAg
ICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11LCBjbWQpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICAvKiBUQkQ6IFRpbWVvdXQg
c2VsZWN0aW9uIG1heSByZXF1aXJlIHBlZWtpbmcgaW50byBjbWRbXS4gKi8K
KyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiAKICAgICBz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwog
fQo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.15-1.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.15-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBzaXplIHFpbnZhbCBxdWV1ZSBkeW5hbWljYWxseQoKV2l0aCB0
aGUgcHJlc2VudCBzeW5jaHJvbm91cyBtb2RlbCwgd2UgbmVlZCB0d28gc2xv
dHMgZm9yIGV2ZXJ5Cm9wZXJhdGlvbiAodGhlIG9wZXJhdGlvbiBpdHNlbGYg
YW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRoZXJlIGNhbiBiZQpvbmUgc3Vj
aCBwYWlyIG9mIHJlcXVlc3RzIHBlbmRpbmcgcGVyIENQVS4gVG8gZW5zdXJl
IHRoYXQgdW5kZXIgYWxsCm5vcm1hbCBjaXJjdW1zdGFuY2VzIGEgc2xvdCBp
cyBhbHdheXMgYXZhaWxhYmxlIHdoZW4gb25lIGlzIHJlcXVlc3RlZCwKc2l6
ZSB0aGUgcXVldWUgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJlciBvZiBw
cmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQv
aW9tbXUuaAorKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvaW9t
bXUuaApAQCAtNDUwLDE3ICs0NTAsOSBAQCBzdHJ1Y3QgcWludmFsX2VudHJ5
IHsKICAgICB9cTsKIH07CiAKLS8qIE9yZGVyIG9mIHF1ZXVlIGludmFsaWRh
dGlvbiBwYWdlcyhtYXggaXMgOCkgKi8KLSNkZWZpbmUgUUlOVkFMX1BBR0Vf
T1JERVIgICAyCi0KLSNkZWZpbmUgUUlOVkFMX0FSQ0hfUEFHRV9PUkRFUiAg
KFFJTlZBTF9QQUdFX09SREVSICsgUEFHRV9TSElGVF80SyAtIFBBR0VfU0hJ
RlQpCi0jZGVmaW5lIFFJTlZBTF9BUkNIX1BBR0VfTlIgICAgICggUUlOVkFM
X0FSQ0hfUEFHRV9PUkRFUiA8IDAgPyAgXAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAxIDogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA8PCBRSU5W
QUxfQVJDSF9QQUdFX09SREVSICkKLQogLyogRWFjaCBlbnRyeSBpcyAxNiBi
eXRlcywgc28gMl44IGVudHJpZXMgcGVyIHBhZ2UgKi8KICNkZWZpbmUgUUlO
VkFMX0VOVFJZX09SREVSICAoIFBBR0VfU0hJRlQgLSA0ICkKLSNkZWZpbmUg
UUlOVkFMX0VOVFJZX05SICAgICAoMSA8PCAoUUlOVkFMX1BBR0VfT1JERVIg
KyA4KSkKKyNkZWZpbmUgUUlOVkFMX01BWF9FTlRSWV9OUiAoMXUgPDwgKDcg
KyBRSU5WQUxfRU5UUllfT1JERVIpKQogCiAvKiBTdGF0dXMgZGF0YSBmbGFn
ICovCiAjZGVmaW5lIFFJTlZBTF9TVEFUX0lOSVQgIDAKLS0tIGEveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCisrKyBiL3hlbi9kcml2
ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9xaW52YWwuYwpAQCAtMzEsNiArMzEsOSBA
QAogCiAjZGVmaW5lIFZURF9RSV9USU1FT1VUCTEKIAorc3RhdGljIHVuc2ln
bmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX3BnX29yZGVyOworc3RhdGljIHVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHFpX2VudHJ5X25yOworCiBzdGF0
aWMgaW50IF9fbXVzdF9jaGVjayBpbnZhbGlkYXRlX3N5bmMoc3RydWN0IHZ0
ZF9pb21tdSAqaW9tbXUpOwogCiBzdGF0aWMgdm9pZCBwcmludF9xaV9yZWdz
KHN0cnVjdCB2dGRfaW9tbXUgKmlvbW11KQpAQCAtNTUsNyArNTgsNyBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IHFpbnZhbF9uZXh0X2luZGV4KHN0CiAgICAg
dGFpbCA+Pj0gUUlOVkFMX0lOREVYX1NISUZUOwogCiAgICAgLyogKHRhaWwr
MSA9PSBoZWFkKSBpbmRpY2F0ZXMgYSBmdWxsIHF1ZXVlLCB3YWl0IGZvciBI
VyAqLwotICAgIHdoaWxlICggKCB0YWlsICsgMSApICUgUUlOVkFMX0VOVFJZ
X05SID09CisgICAgd2hpbGUgKCAoKHRhaWwgKyAxKSAmIChxaV9lbnRyeV9u
ciAtIDEpKSA9PQogICAgICAgICAgICAgKCBkbWFyX3JlYWRxKGlvbW11LT5y
ZWcsIERNQVJfSVFIX1JFRykgPj4gUUlOVkFMX0lOREVYX1NISUZUICkgKQog
ICAgICAgICBjcHVfcmVsYXgoKTsKIApAQCAtNjgsNyArNzEsNyBAQCBzdGF0
aWMgdm9pZCBxaW52YWxfdXBkYXRlX3F0YWlsKHN0cnVjdCB2CiAKICAgICAv
KiBOZWVkIGhvbGQgcmVnaXN0ZXIgbG9jayB3aGVuIHVwZGF0ZSB0YWlsICov
CiAgICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPnJlZ2lzdGVy
X2xvY2spICk7Ci0gICAgdmFsID0gKGluZGV4ICsgMSkgJSBRSU5WQUxfRU5U
UllfTlI7CisgICAgdmFsID0gKGluZGV4ICsgMSkgJiAocWlfZW50cnlfbnIg
LSAxKTsKICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVnLCBETUFSX0lRVF9S
RUcsICh2YWwgPDwgUUlOVkFMX0lOREVYX1NISUZUKSk7CiB9CiAKQEAgLTQw
Myw4ICs0MDYsMjggQEAgaW50IGVuYWJsZV9xaW52YWwoc3RydWN0IHZ0ZF9p
b21tdSAqaW9tbQogCiAgICAgaWYgKCBpb21tdS0+cWludmFsX21hZGRyID09
IDAgKQogICAgIHsKLSAgICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciA9IGFs
bG9jX3BndGFibGVfbWFkZHIoUUlOVkFMX0FSQ0hfUEFHRV9OUiwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW9tbXUtPm5vZGUpOworICAgICAgICBpZiAoICFxaV9lbnRyeV9uciApCisg
ICAgICAgIHsKKyAgICAgICAgICAgIC8qCisgICAgICAgICAgICAgKiBXaXRo
IHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1vZGVsLCB3ZSBuZWVkIHR3byBz
bG90cyBmb3IgZXZlcnkKKyAgICAgICAgICAgICAqIG9wZXJhdGlvbiAodGhl
IG9wZXJhdGlvbiBpdHNlbGYgYW5kIGEgd2FpdCBkZXNjcmlwdG9yKS4gIFRo
ZXJlCisgICAgICAgICAgICAgKiBjYW4gYmUgb25lIHN1Y2ggcGFpciBvZiBy
ZXF1ZXN0cyBwZW5kaW5nIHBlciBDUFUuICBPbmUgZXh0cmEKKyAgICAgICAg
ICAgICAqIGVudHJ5IGlzIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25zaWRl
cmVkIGZ1bGwgd2hlbiB0aGVyZSdzCisgICAgICAgICAgICAgKiBvbmx5IG9u
ZSBlbnRyeSBsZWZ0LgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBC
VUlMRF9CVUdfT04oQ09ORklHX05SX0NQVVMgKiAyID49IFFJTlZBTF9NQVhf
RU5UUllfTlIpOworICAgICAgICAgICAgcWlfcGdfb3JkZXIgPSBnZXRfb3Jk
ZXJfZnJvbV9ieXRlcygobnVtX3ByZXNlbnRfY3B1cygpICogMiArIDEpIDw8
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIChQQUdFX1NISUZUIC0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFFJTlZBTF9FTlRSWV9PUkRFUikpOwor
ICAgICAgICAgICAgcWlfZW50cnlfbnIgPSAxdSA8PCAocWlfcGdfb3JkZXIg
KyBRSU5WQUxfRU5UUllfT1JERVIpOworCisgICAgICAgICAgICBkcHJpbnRr
KFhFTkxPR19JTkZPIFZURFBSRUZJWCwKKyAgICAgICAgICAgICAgICAgICAg
IlFJOiB1c2luZyAldS1lbnRyeSByaW5nKHMpXG4iLCBxaV9lbnRyeV9ucik7
CisgICAgICAgIH0KKworICAgICAgICBpb21tdS0+cWludmFsX21hZGRyID0K
KyAgICAgICAgICAgIGFsbG9jX3BndGFibGVfbWFkZHIocWlfZW50cnlfbnIg
Pj4gUUlOVkFMX0VOVFJZX09SREVSLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpb21tdS0+bm9kZSk7CiAgICAgICAgIGlmICggaW9tbXUt
PnFpbnZhbF9tYWRkciA9PSAwICkKICAgICAgICAgewogICAgICAgICAgICAg
ZHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgsCkBAIC00MTgsMTUg
KzQ0MSwxNiBAQCBpbnQgZW5hYmxlX3FpbnZhbChzdHJ1Y3QgdnRkX2lvbW11
ICppb21tCiAKICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmaW9tbXUtPnJlZ2lz
dGVyX2xvY2ssIGZsYWdzKTsKIAotICAgIC8qIFNldHVwIEludmFsaWRhdGlv
biBRdWV1ZSBBZGRyZXNzKElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUKLSAgICAg
KiBhZGRyZXNzIG9mIHRoZSBwYWdlIHdlIGp1c3QgYWxsb2NhdGVkLiAgUVMg
ZmllbGQgYXQKLSAgICAgKiBiaXRzWzI6MF0gdG8gaW5kaWNhdGUgc2l6ZSBv
ZiBxdWV1ZSBpcyBvbmUgNEtCIHBhZ2UuCi0gICAgICogVGhhdCdzIDI1NiBl
bnRyaWVzLiAgUXVldWVkIEhlYWQgKElRSCkgYW5kIFF1ZXVlIFRhaWwgKElR
VCkKLSAgICAgKiByZWdpc3RlcnMgYXJlIGF1dG9tYXRpY2FsbHkgcmVzZXQg
dG8gMCB3aXRoIHdyaXRlCi0gICAgICogdG8gSVFBIHJlZ2lzdGVyLgorICAg
IC8qCisgICAgICogU2V0dXAgSW52YWxpZGF0aW9uIFF1ZXVlIEFkZHJlc3Mg
KElRQSkgcmVnaXN0ZXIgd2l0aCB0aGUgYWRkcmVzcyBvZiB0aGUKKyAgICAg
KiBwYWdlcyB3ZSBqdXN0IGFsbG9jYXRlZC4gIFRoZSBRUyBmaWVsZCBhdCBi
aXRzWzI6MF0gaW5kaWNhdGVzIHRoZSBzaXplCisgICAgICogKHBhZ2Ugb3Jk
ZXIpIG9mIHRoZSBxdWV1ZS4KKyAgICAgKgorICAgICAqIFF1ZXVlZCBIZWFk
IChJUUgpIGFuZCBRdWV1ZSBUYWlsIChJUVQpIHJlZ2lzdGVycyBhcmUgYXV0
b21hdGljYWxseQorICAgICAqIHJlc2V0IHRvIDAgd2l0aCB3cml0ZSB0byBJ
UUEgcmVnaXN0ZXIuCiAgICAgICovCiAgICAgZG1hcl93cml0ZXEoaW9tbXUt
PnJlZywgRE1BUl9JUUFfUkVHLAotICAgICAgICAgICAgICAgIGlvbW11LT5x
aW52YWxfbWFkZHIgfCBRSU5WQUxfUEFHRV9PUkRFUik7CisgICAgICAgICAg
ICAgICAgaW9tbXUtPnFpbnZhbF9tYWRkciB8IHFpX3BnX29yZGVyKTsKIAog
ICAgIGRtYXJfd3JpdGVxKGlvbW11LT5yZWcsIERNQVJfSVFUX1JFRywgMCk7
CiAK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.15-2.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.15-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHNpemUgY29tbWFuZCBidWZmZXIgZHluYW1pY2FsbHkK
CldpdGggdGhlIHByZXNlbnQgc3luY2hyb25vdXMgbW9kZWwsIHdlIG5lZWQg
dHdvIHNsb3RzIGZvciBldmVyeQpvcGVyYXRpb24gKHRoZSBvcGVyYXRpb24g
aXRzZWxmIGFuZCBhIHdhaXQgY29tbWFuZCkuICBUaGVyZSBjYW4gYmUgb25l
CnN1Y2ggcGFpciBvZiBjb21tYW5kcyBwZW5kaW5nIHBlciBDUFUuIFRvIGVu
c3VyZSB0aGF0IHVuZGVyIGFsbCBub3JtYWwKY2lyY3Vtc3RhbmNlcyBhIHNs
b3QgaXMgYWx3YXlzIGF2YWlsYWJsZSB3aGVuIG9uZSBpcyByZXF1ZXN0ZWQs
IHNpemUgdGhlCmNvbW1hbmQgcmluZyBhY2NvcmRpbmcgdG8gdGhlIG51bWJl
ciBvZiBwcmVzZW50IENQVXMuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAv
IENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50
IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXUtZGVmcy5oCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJv
dWdoL2FtZC9pb21tdS1kZWZzLmgKQEAgLTIwLDkgKzIwLDYgQEAKICNpZm5k
ZWYgQU1EX0lPTU1VX0RFRlNfSAogI2RlZmluZSBBTURfSU9NTVVfREVGU19I
CiAKLS8qIElPTU1VIENvbW1hbmQgQnVmZmVyIGVudHJpZXM6IGluIHBvd2Vy
IG9mIDIgaW5jcmVtZW50cywgbWluaW11bSBvZiAyNTYgKi8KLSNkZWZpbmUg
SU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VOVFJJRVMJNTEyCi0KIC8qIElP
TU1VIEV2ZW50IExvZyBlbnRyaWVzOiBpbiBwb3dlciBvZiAyIGluY3JlbWVu
dHMsIG1pbmltdW0gb2YgMjU2ICovCiAjZGVmaW5lIElPTU1VX0VWRU5UX0xP
R19ERUZBVUxUX0VOVFJJRVMgICAgIDUxMgogCkBAIC0xNjQsOCArMTYxLDgg
QEAgc3RydWN0IGFtZF9pb21tdV9kdGUgewogI2RlZmluZSBJT01NVV9DTURf
QlVGRkVSX0xFTkdUSF9NQVNLCQkweDBGMDAwMDAwCiAjZGVmaW5lIElPTU1V
X0NNRF9CVUZGRVJfTEVOR1RIX1NISUZUCQkyNAogCi0jZGVmaW5lIElPTU1V
X0NNRF9CVUZGRVJfRU5UUllfU0laRQkJCTE2Ci0jZGVmaW5lIElPTU1VX0NN
RF9CVUZGRVJfUE9XRVJfT0YyX0VOVFJJRVNfUEVSX1BBR0UJOAorI2RlZmlu
ZSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVSICAgICAgICAgICAgNAor
I2RlZmluZSBJT01NVV9DTURfQlVGRkVSX01BWF9FTlRSSUVTICAgICAgICAg
ICAgKDF1IDw8IDE1KQogCiAjZGVmaW5lIElPTU1VX0NNRF9PUENPREVfTUFT
SwkJCTB4RjAwMDAwMDAKICNkZWZpbmUgSU9NTVVfQ01EX09QQ09ERV9TSElG
VAkJCTI4Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9jbWQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfY21kLmMKQEAgLTI0LDcgKzI0LDcgQEAgc3RhdGljIGludCBxdWV1ZV9p
b21tdV9jb21tYW5kKHN0cnVjdCBhbQogewogICAgIHVpbnQzMl90IHRhaWws
IGhlYWQ7CiAKLSAgICB0YWlsID0gaW9tbXUtPmNtZF9idWZmZXIudGFpbCAr
IElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRTsKKyAgICB0YWlsID0gaW9t
bXUtPmNtZF9idWZmZXIudGFpbCArIHNpemVvZihjbWRfZW50cnlfdCk7CiAg
ICAgaWYgKCB0YWlsID09IGlvbW11LT5jbWRfYnVmZmVyLnNpemUgKQogICAg
ICAgICB0YWlsID0gMDsKIApAQCAtMzMsNyArMzMsNyBAQCBzdGF0aWMgaW50
IHF1ZXVlX2lvbW11X2NvbW1hbmQoc3RydWN0IGFtCiAgICAgaWYgKCBoZWFk
ICE9IHRhaWwgKQogICAgIHsKICAgICAgICAgbWVtY3B5KGlvbW11LT5jbWRf
YnVmZmVyLmJ1ZmZlciArIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwsCi0gICAg
ICAgICAgICAgICBjbWQsIElPTU1VX0NNRF9CVUZGRVJfRU5UUllfU0laRSk7
CisgICAgICAgICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwog
CiAgICAgICAgIGlvbW11LT5jbWRfYnVmZmVyLnRhaWwgPSB0YWlsOwogICAg
ICAgICByZXR1cm4gMTsKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfaW5pdC5jCkBAIC0xMTgsNyArMTE4LDcgQEAgc3RhdGlj
IHZvaWQgcmVnaXN0ZXJfaW9tbXVfY21kX2J1ZmZlcl9pbgogICAgIHdyaXRl
bChlbnRyeSwgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NNRF9CVUZGRVJf
QkFTRV9MT1dfT0ZGU0VUKTsKIAogICAgIHBvd2VyX29mMl9lbnRyaWVzID0g
Z2V0X29yZGVyX2Zyb21fYnl0ZXMoaW9tbXUtPmNtZF9idWZmZXIuc2l6ZSkg
KwotICAgICAgICBJT01NVV9DTURfQlVGRkVSX1BPV0VSX09GMl9FTlRSSUVT
X1BFUl9QQUdFOworICAgICAgICBQQUdFX1NISUZUIC0gSU9NTVVfQ01EX0JV
RkZFUl9FTlRSWV9PUkRFUjsKIAogICAgIGVudHJ5ID0gMDsKICAgICBpb21t
dV9zZXRfYWRkcl9oaV90b19yZWcoJmVudHJ5LCBhZGRyX2hpKTsKQEAgLTEw
MTgsOSArMTAxOCwzMSBAQCBzdGF0aWMgdm9pZCAqX19pbml0IGFsbG9jYXRl
X3JpbmdfYnVmZmVyCiBzdGF0aWMgdm9pZCAqIF9faW5pdCBhbGxvY2F0ZV9j
bWRfYnVmZmVyKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQogewogICAgIC8q
IGFsbG9jYXRlICdjb21tYW5kIGJ1ZmZlcicgaW4gcG93ZXIgb2YgMiBpbmNy
ZW1lbnRzIG9mIDRLICovCisgICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3Jl
YWRfbW9zdGx5IG5yX2VudHM7CisKKyAgICBpZiAoICFucl9lbnRzICkKKyAg
ICB7CisgICAgICAgIHVuc2lnbmVkIGludCBvcmRlcjsKKworICAgICAgICAv
KgorICAgICAgICAgKiBXaXRoIHRoZSBwcmVzZW50IHN5bmNocm9ub3VzIG1v
ZGVsLCB3ZSBuZWVkIHR3byBzbG90cyBmb3IgZXZlcnkKKyAgICAgICAgICog
b3BlcmF0aW9uICh0aGUgb3BlcmF0aW9uIGl0c2VsZiBhbmQgYSB3YWl0IGNv
bW1hbmQpLiAgVGhlcmUgY2FuIGJlCisgICAgICAgICAqIG9uZSBzdWNoIHBh
aXIgb2YgcmVxdWVzdHMgcGVuZGluZyBwZXIgQ1BVLiAgT25lIGV4dHJhIGVu
dHJ5IGlzCisgICAgICAgICAqIG5lZWRlZCBhcyB0aGUgcmluZyBpcyBjb25z
aWRlcmVkIGZ1bGwgd2hlbiB0aGVyZSdzIG9ubHkgb25lIGVudHJ5CisgICAg
ICAgICAqIGxlZnQuCisgICAgICAgICAqLworICAgICAgICBCVUlMRF9CVUdf
T04oQ09ORklHX05SX0NQVVMgKiAyID49IElPTU1VX0NNRF9CVUZGRVJfTUFY
X0VOVFJJRVMpOworICAgICAgICBvcmRlciA9IGdldF9vcmRlcl9mcm9tX2J5
dGVzKChudW1fcHJlc2VudF9jcHVzKCkgKiAyICsgMSkgPDwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9DTURfQlVGRkVS
X0VOVFJZX09SREVSKTsKKyAgICAgICAgbnJfZW50cyA9IDF1IDw8IChvcmRl
ciArIFBBR0VfU0hJRlQgLSBJT01NVV9DTURfQlVGRkVSX0VOVFJZX09SREVS
KTsKKworICAgICAgICBBTURfSU9NTVVfREVCVUcoInVzaW5nICV1LWVudHJ5
IGNtZCByaW5nKHMpXG4iLCBucl9lbnRzKTsKKyAgICB9CisKKyAgICBCVUlM
RF9CVUdfT04oc2l6ZW9mKGNtZF9lbnRyeV90KSAhPSAoMXUgPDwgSU9NTVVf
Q01EX0JVRkZFUl9FTlRSWV9PUkRFUikpOworCiAgICAgcmV0dXJuIGFsbG9j
YXRlX3JpbmdfYnVmZmVyKCZpb21tdS0+Y21kX2J1ZmZlciwgc2l6ZW9mKGNt
ZF9lbnRyeV90KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfQ01EX0JVRkZFUl9ERUZBVUxUX0VOVFJJRVMsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICJDb21tYW5kIEJ1ZmZlciIsIGZhbHNl
KTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnJfZW50cywg
IkNvbW1hbmQgQnVmZmVyIiwgZmFsc2UpOwogfQogCiBzdGF0aWMgdm9pZCAq
IF9faW5pdCBhbGxvY2F0ZV9ldmVudF9sb2coc3RydWN0IGFtZF9pb21tdSAq
aW9tbXUpCg==

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.15-3.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.15-3.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBWVC1kOiBlbGltaW5hdGUgZmx1c2ggcmVsYXRlZCB0aW1lb3V0cwoKTGVh
dmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24gcGVuZGluZyB3aGVuIGl0
IGFwcGVhcnMgdG8gdGFrZSB0b28KbG9uZyBpcyBwcm9ibGVtYXRpYzogSWYg
ZS5nLiBhIFFJIGNvbW1hbmQgY29tcGxldGVkIGxhdGVyLCB0aGUgd3JpdGUg
dG8KdGhlICJwb2xsIHNsb3QiIG1heSBpbnN0ZWFkIGJlIHVuZGVyc3Rvb2Qg
dG8gc2lnbmFsIGEgc3Vic2VxdWVudGx5CnN0YXJ0ZWQgY29tbWFuZCdzIGNv
bXBsZXRpb24uIEFsc28gb3VyIGFjY291bnRpbmcgb2YgdGhlIHRpbWVvdXQg
cGVyaW9kCndhcyBhY3R1YWxseSB3cm9uZzogV2UgaW5jbHVkZWQgdGhlIHRp
bWUgaXQgdG9vayBmb3IgdGhlIGNvbW1hbmQgdG8KYWN0dWFsbHkgbWFrZSBp
dCB0byB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlLCB3aGljaCBjb3VsZCBiZSBo
ZWF2aWx5CmFmZmVjdGVkIGJ5IGd1ZXN0cyBvdGhlciB0aGFuIHRoZSBvbmUg
Zm9yIHdoaWNoIHRoZSBmbHVzaCBpcyBiZWluZwpwZXJmb3JtZWQuCgpEbyBh
d2F5IHdpdGggYWxsIHRpbWVvdXQgZGV0ZWN0aW9uIG9uIGFsbCBmbHVzaCBy
ZWxhdGVkIGNvZGUgcGF0aHMuCkxvZyBleGNlc3NpdmVseSBsb25nIHByb2Nl
c3NpbmcgdGltZXMgKHdpdGggYSBwcm9ncmVzc2l2ZSB0aHJlc2hvbGQpIHRv
CmhhdmUgc29tZSBpbmRpY2F0aW9uIG9mIHByb2JsZW1zIGluIHRoaXMgYXJl
YS4KCkFkZGl0aW9uYWxseSBsb2cgKG9uY2UpIGlmIHFpbnZhbF9uZXh0X2lu
ZGV4KCkgZGlkbid0IGltbWVkaWF0ZWx5IGZpbmQKYW4gYXZhaWxhYmxlIHNs
b3QuIFRvZ2V0aGVyIHdpdGggdGhlIGVhcmxpZXIgY2hhbmdlIHNpemluZyB0
aGUgcXVldWUocykKZHluYW1pY2FsbHksIHdlIHNob3VsZCBub3cgaGF2ZSBh
IGd1YXJhbnRlZSB0aGF0IHdpdGggb3VyIGZ1bGx5CnN5bmNocm9ub3VzIG1v
ZGVsIGFueSBkZW1hbmQgZm9yIHNsb3RzIGNhbiBhY3R1YWxseSBiZSBzYXRp
c2ZpZWQuCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4
NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1
c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5v
cmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvZG1hci5o
CisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9kbWFyLmgKQEAg
LTEyNyw2ICsxMjcsMzQgQEAgZG8gewogICAgIH0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
IH0gd2hpbGUgKDApCiAKKyNkZWZpbmUgSU9NTVVfRkxVU0hfV0FJVCh3aGF0
LCBpb21tdSwgb2Zmc2V0LCBvcCwgY29uZCwgc3RzKSAgICAgICBcCitkbyB7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIHN0YXRpYyB1bnNpZ25lZCBpbnQg
X19yZWFkX21vc3RseSB0aHJlc2hvbGQgPSAxOyAgICAgICAgICAgICAgIFwK
KyAgICBzX3RpbWVfdCBzdGFydCA9IE5PVygpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgc190aW1lX3QgdGltZW91
dCA9IHN0YXJ0ICsgRE1BUl9PUEVSQVRJT05fVElNRU9VVCAqIHRocmVzaG9s
ZDsgXAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBmb3IgKCA7IDsg
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICBz
dHMgPSBvcChpb21tdS0+cmVnLCBvZmZzZXQpOyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgaWYgKCBjb25kICkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICBpZiAoIHRpbWVvdXQgJiYg
Tk9XKCkgPiB0aW1lb3V0ICkgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICB0aHJlc2hv
bGQgfD0gdGhyZXNob2xkIDw8IDE7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HIFZURFBS
RUZJWCAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAiIElPTU1VIyV1OiAlcyBmbHVzaCB0YWtpbmcgdG9vIGxvbmdcbiIs
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgaW9tbXUtPmluZGV4LCB3
aGF0KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgdGltZW91dCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgfSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgIGNwdV9yZWxheCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgIH0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgaWYgKCAhdGltZW91dCAp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcgVlREUFJFRklY
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICIgSU9NTVUjJXU6ICVzIGZsdXNoIHRvb2sgJWx1bXNcbiIsICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICBpb21tdS0+aW5kZXgsIHdoYXQs
IChOT1coKSAtIHN0YXJ0KSAvIDEwMDAwMDAwKTsgICAgXAorfSB3aGlsZSAo
IGZhbHNlICkKKwogaW50IHZ0ZF9od19jaGVjayh2b2lkKTsKIHZvaWQgZGlz
YWJsZV9wbXIoc3RydWN0IHZ0ZF9pb21tdSAqaW9tbXUpOwogaW50IGlzX2ln
ZF9kcmhkKHN0cnVjdCBhY3BpX2RyaGRfdW5pdCAqZHJoZCk7Ci0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL3Z0ZC9pb21tdS5jCkBAIC0zNzMsOCArMzcz
LDggQEAgc3RhdGljIHZvaWQgaW9tbXVfZmx1c2hfd3JpdGVfYnVmZmVyKHN0
cgogICAgIGRtYXJfd3JpdGVsKGlvbW11LT5yZWcsIERNQVJfR0NNRF9SRUcs
IHZhbCB8IERNQV9HQ01EX1dCRik7CiAKICAgICAvKiBNYWtlIHN1cmUgaGFy
ZHdhcmUgY29tcGxldGUgaXQgKi8KLSAgICBJT01NVV9XQUlUX09QKGlvbW11
LCBETUFSX0dTVFNfUkVHLCBkbWFyX3JlYWRsLAotICAgICAgICAgICAgICAg
ICAgISh2YWwgJiBETUFfR1NUU19XQkZTKSwgdmFsKTsKKyAgICBJT01NVV9G
TFVTSF9XQUlUKCJ3cml0ZSBidWZmZXIiLCBpb21tdSwgRE1BUl9HU1RTX1JF
RywgZG1hcl9yZWFkbCwKKyAgICAgICAgICAgICAgICAgICAgICEodmFsICYg
RE1BX0dTVFNfV0JGUyksIHZhbCk7CiAKICAgICBzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZpb21tdS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogfQpAQCAt
NDIzLDggKzQyMyw4IEBAIGludCB2dGRfZmx1c2hfY29udGV4dF9yZWcoc3Ry
dWN0IHZ0ZF9pb20KICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVnLCBETUFS
X0NDTURfUkVHLCB2YWwpOwogCiAgICAgLyogTWFrZSBzdXJlIGhhcmR3YXJl
IGNvbXBsZXRlIGl0ICovCi0gICAgSU9NTVVfV0FJVF9PUChpb21tdSwgRE1B
Ul9DQ01EX1JFRywgZG1hcl9yZWFkcSwKLSAgICAgICAgICAgICAgICAgICEo
dmFsICYgRE1BX0NDTURfSUNDKSwgdmFsKTsKKyAgICBJT01NVV9GTFVTSF9X
QUlUKCJjb250ZXh0IiwgaW9tbXUsIERNQVJfQ0NNRF9SRUcsIGRtYXJfcmVh
ZHEsCisgICAgICAgICAgICAgICAgICAgICAhKHZhbCAmIERNQV9DQ01EX0lD
QyksIHZhbCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21t
dS0+cmVnaXN0ZXJfbG9jaywgZmxhZ3MpOwogICAgIC8qIGZsdXNoIGNvbnRl
eHQgZW50cnkgd2lsbCBpbXBsaWNpdGx5IGZsdXNoIHdyaXRlIGJ1ZmZlciAq
LwpAQCAtNTAxLDggKzUwMSw4IEBAIGludCB2dGRfZmx1c2hfaW90bGJfcmVn
KHN0cnVjdCB2dGRfaW9tbXUKICAgICBkbWFyX3dyaXRlcShpb21tdS0+cmVn
LCB0bGJfb2Zmc2V0ICsgOCwgdmFsKTsKIAogICAgIC8qIE1ha2Ugc3VyZSBo
YXJkd2FyZSBjb21wbGV0ZSBpdCAqLwotICAgIElPTU1VX1dBSVRfT1AoaW9t
bXUsICh0bGJfb2Zmc2V0ICsgOCksIGRtYXJfcmVhZHEsCi0gICAgICAgICAg
ICAgICAgICAhKHZhbCAmIERNQV9UTEJfSVZUKSwgdmFsKTsKKyAgICBJT01N
VV9GTFVTSF9XQUlUKCJpb3RsYiIsIGlvbW11LCAodGxiX29mZnNldCArIDgp
LCBkbWFyX3JlYWRxLAorICAgICAgICAgICAgICAgICAgICAgISh2YWwgJiBE
TUFfVExCX0lWVCksIHZhbCk7CiAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9y
ZSgmaW9tbXUtPnJlZ2lzdGVyX2xvY2ssIGZsYWdzKTsKIAogICAgIC8qIGNo
ZWNrIElPVExCIGludmFsaWRhdGlvbiBncmFudWxhcml0eSAqLwotLS0gYS94
ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC92dGQvcWludmFsLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvdnRkL3FpbnZhbC5jCkBAIC0yOSw4ICsy
OSw2IEBACiAjaW5jbHVkZSAiZXh0ZXJuLmgiCiAjaW5jbHVkZSAiLi4vYXRz
LmgiCiAKLSNkZWZpbmUgVlREX1FJX1RJTUVPVVQJMQotCiBzdGF0aWMgdW5z
aWduZWQgaW50IF9fcmVhZF9tb3N0bHkgcWlfcGdfb3JkZXI7CiBzdGF0aWMg
dW5zaWduZWQgaW50IF9fcmVhZF9tb3N0bHkgcWlfZW50cnlfbnI7CiAKQEAg
LTYwLDcgKzU4LDExIEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgcWludmFsX25l
eHRfaW5kZXgoc3QKICAgICAvKiAodGFpbCsxID09IGhlYWQpIGluZGljYXRl
cyBhIGZ1bGwgcXVldWUsIHdhaXQgZm9yIEhXICovCiAgICAgd2hpbGUgKCAo
KHRhaWwgKyAxKSAmIChxaV9lbnRyeV9uciAtIDEpKSA9PQogICAgICAgICAg
ICAgKCBkbWFyX3JlYWRxKGlvbW11LT5yZWcsIERNQVJfSVFIX1JFRykgPj4g
UUlOVkFMX0lOREVYX1NISUZUICkgKQorICAgIHsKKyAgICAgICAgcHJpbnRr
X29uY2UoWEVOTE9HX0VSUiBWVERQUkVGSVggIiBJT01NVSMldTogbm8gUUkg
c2xvdCBhdmFpbGFibGVcbiIsCisgICAgICAgICAgICAgICAgICAgIGlvbW11
LT5pbmRleCk7CiAgICAgICAgIGNwdV9yZWxheCgpOworICAgIH0KIAogICAg
IHJldHVybiB0YWlsOwogfQpAQCAtMTgwLDIzICsxODIsMzIgQEAgc3RhdGlj
IGludCBfX211c3RfY2hlY2sgcXVldWVfaW52YWxpZGF0ZQogICAgIC8qIE5v
dyB3ZSBkb24ndCBzdXBwb3J0IGludGVycnVwdCBtZXRob2QgKi8KICAgICBp
ZiAoIHN3ICkKICAgICB7Ci0gICAgICAgIHNfdGltZV90IHRpbWVvdXQ7Ci0K
LSAgICAgICAgLyogSW4gY2FzZSBhbGwgd2FpdCBkZXNjcmlwdG9yIHdyaXRl
cyB0byBzYW1lIGFkZHIgd2l0aCBzYW1lIGRhdGEgKi8KLSAgICAgICAgdGlt
ZW91dCA9IE5PVygpICsgTUlMTElTRUNTKGZsdXNoX2Rldl9pb3RsYiA/Ci0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb21tdV9kZXZf
aW90bGJfdGltZW91dCA6IFZURF9RSV9USU1FT1VUKTsKKyAgICAgICAgc3Rh
dGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9sZCA9IDE7
CisgICAgICAgIHNfdGltZV90IHN0YXJ0ID0gTk9XKCk7CisgICAgICAgIHNf
dGltZV90IHRpbWVvdXQgPSBzdGFydCArIChmbHVzaF9kZXZfaW90bGIKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gaW9tbXVfZGV2
X2lvdGxiX3RpbWVvdXQKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDogMTAwKSAqIE1JTExJU0VDUyh0aHJlc2hvbGQpOwogCiAgICAg
ICAgIHdoaWxlICggQUNDRVNTX09OQ0UoKnRoaXNfcG9sbF9zbG90KSAhPSBR
SU5WQUxfU1RBVF9ET05FICkKICAgICAgICAgewotICAgICAgICAgICAgaWYg
KCBOT1coKSA+IHRpbWVvdXQgKQorICAgICAgICAgICAgaWYgKCB0aW1lb3V0
ICYmIE5PVygpID4gdGltZW91dCApCiAgICAgICAgICAgICB7Ci0gICAgICAg
ICAgICAgICAgcHJpbnRfcWlfcmVncyhpb21tdSk7CisgICAgICAgICAgICAg
ICAgdGhyZXNob2xkIHw9IHRocmVzaG9sZCA8PCAxOwogICAgICAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKLSAgICAgICAg
ICAgICAgICAgICAgICAgIiBRdWV1ZSBpbnZhbGlkYXRlIHdhaXQgZGVzY3Jp
cHRvciB0aW1lZCBvdXRcbiIpOwotICAgICAgICAgICAgICAgIHJldHVybiAt
RVRJTUVET1VUOworICAgICAgICAgICAgICAgICAgICAgICAiIElPTU1VIyV1
OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0YWtpbmcgdG9vIGxvbmdcbiIsCisg
ICAgICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRleCwgZmx1c2hfZGV2
X2lvdGxiID8gIiBkZXYiIDogIiIpOworICAgICAgICAgICAgICAgIHByaW50
X3FpX3JlZ3MoaW9tbXUpOworICAgICAgICAgICAgICAgIHRpbWVvdXQgPSAw
OwogICAgICAgICAgICAgfQogICAgICAgICAgICAgY3B1X3JlbGF4KCk7CiAg
ICAgICAgIH0KKworICAgICAgICBpZiAoICF0aW1lb3V0ICkKKyAgICAgICAg
ICAgIHByaW50ayhYRU5MT0dfV0FSTklORyBWVERQUkVGSVgKKyAgICAgICAg
ICAgICAgICAgICAiIElPTU1VIyV1OiBRSSVzIHdhaXQgZGVzY3JpcHRvciB0
b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgICAgIGlvbW11LT5pbmRl
eCwgZmx1c2hfZGV2X2lvdGxiID8gIiBkZXYiIDogIiIsCisgICAgICAgICAg
ICAgICAgICAgKE5PVygpIC0gc3RhcnQpIC8gMTAwMDAwMDApOworCiAgICAg
ICAgIHJldHVybiAwOwogICAgIH0KIAo=

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.15-4.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.15-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHdhaXQgZm9yIGNvbW1hbmQgc2xvdCB0byBiZSBhdmFp
bGFibGUKCk5vIGNhbGxlciBjYXJlZCBhYm91dCBzZW5kX2lvbW11X2NvbW1h
bmQoKSBpbmRpY2F0aW5nIHVuYXZhaWxhYmlsaXR5IG9mCmEgc2xvdC4gSGVu
Y2UgaWYgYSBzdWZmaWNpZW50IG51bWJlciBwcmlvciBjb21tYW5kcyB0aW1l
ZCBvdXQsIHdlIGRpZApibGluZGx5IGFzc3VtZSB0aGF0IHRoZSByZXF1ZXN0
ZWQgY29tbWFuZCB3YXMgc3VibWl0dGVkIHRvIHRoZSBJT01NVQp3aGVuIHJl
YWxseSBpdCB3YXNuJ3QuIFRoaXMgY291bGQgbWVhbiBib3RoIGEgaGFuZ2lu
ZyBzeXN0ZW0gKHdhaXRpbmcKZm9yIGEgY29tbWFuZCB0byBjb21wbGV0ZSB0
aGF0IHdhcyBuZXZlciBzZWVuIGJ5IHRoZSBJT01NVSkgb3IgYmxpbmRseQpw
cm9wYWdhdGluZyBzdWNjZXNzIGJhY2sgdG8gY2FsbGVycywgbWFraW5nIHRo
ZW0gYmVsaWV2ZSB0aGV5J3JlIGZpbmUKdG8gZS5nLiBmcmVlIHByZXZpb3Vz
bHkgdW5tYXBwZWQgcGFnZXMuCgpGb2xkIHRoZSB0aHJlZSBpbnZvbHZlZCBm
dW5jdGlvbnMgaW50byBvbmUsIGFkZCBzcGluIHdhaXRpbmcgZm9yIGFuCmF2
YWlsYWJsZSBzbG90IGFsb25nIHRoZSBsaW5lcyBvZiBWVC1kJ3MgcWludmFs
X25leHRfaW5kZXgoKSwgYW5kIGFzIGEKY29uc2VxdWVuY2UgZHJvcCBhbGwg
ZXJyb3IgaW5kaWNhdG9yIHJldHVybiB0eXBlcy92YWx1ZXMuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yMCw0
MyArMjAsMzAgQEAKICNpbmNsdWRlICJpb21tdS5oIgogI2luY2x1ZGUgIi4u
L2F0cy5oIgogCi1zdGF0aWMgaW50IHF1ZXVlX2lvbW11X2NvbW1hbmQoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsIHUzMiBjbWRbXSkKK3N0YXRpYyB2b2lk
IHNlbmRfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJf
dCBjbWRbNF0pCiB7Ci0gICAgdWludDMyX3QgdGFpbCwgaGVhZDsKKyAgICB1
aW50MzJfdCB0YWlsOwogCiAgICAgdGFpbCA9IGlvbW11LT5jbWRfYnVmZmVy
LnRhaWwgKyBzaXplb2YoY21kX2VudHJ5X3QpOwogICAgIGlmICggdGFpbCA9
PSBpb21tdS0+Y21kX2J1ZmZlci5zaXplICkKICAgICAgICAgdGFpbCA9IDA7
CiAKLSAgICBoZWFkID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArCi0gICAg
ICAgICAgICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpICYg
SU9NTVVfUklOR19CVUZGRVJfUFRSX01BU0s7Ci0gICAgaWYgKCBoZWFkICE9
IHRhaWwgKQorICAgIHdoaWxlICggdGFpbCA9PSAocmVhZGwoaW9tbXUtPm1t
aW9fYmFzZSArCisgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9D
TURfQlVGRkVSX0hFQURfT0ZGU0VUKSAmCisgICAgICAgICAgICAgICAgICAg
ICBJT01NVV9SSU5HX0JVRkZFUl9QVFJfTUFTSykgKQogICAgIHsKLSAgICAg
ICAgbWVtY3B5KGlvbW11LT5jbWRfYnVmZmVyLmJ1ZmZlciArIGlvbW11LT5j
bWRfYnVmZmVyLnRhaWwsCi0gICAgICAgICAgICAgICBjbWQsIHNpemVvZihj
bWRfZW50cnlfdCkpOwotCi0gICAgICAgIGlvbW11LT5jbWRfYnVmZmVyLnRh
aWwgPSB0YWlsOwotICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgcHJpbnRr
X29uY2UoWEVOTE9HX0VSUiAiQU1EIElPTU1VICVwcDogbm8gY21kIHNsb3Qg
YXZhaWxhYmxlXG4iLAorICAgICAgICAgICAgICAgICAgICAmUENJX1NCREYy
KGlvbW11LT5zZWcsIGlvbW11LT5iZGYpKTsKKyAgICAgICAgY3B1X3JlbGF4
KCk7CiAgICAgfQogCi0gICAgcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lk
IGNvbW1pdF9pb21tdV9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdSkKLXsKLSAgICB3cml0ZWwoaW9tbXUtPmNtZF9idWZmZXIudGFp
bCwKLSAgICAgICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NNRF9C
VUZGRVJfVEFJTF9PRkZTRVQpOwotfQorICAgIG1lbWNweShpb21tdS0+Y21k
X2J1ZmZlci5idWZmZXIgKyBpb21tdS0+Y21kX2J1ZmZlci50YWlsLAorICAg
ICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwogCi1zdGF0aWMg
aW50IHNlbmRfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSwgdTMyIGNtZFtdKQotewotICAgIGlmICggcXVldWVfaW9tbXVfY29tbWFu
ZChpb21tdSwgY21kKSApCi0gICAgewotICAgICAgICBjb21taXRfaW9tbXVf
Y29tbWFuZF9idWZmZXIoaW9tbXUpOwotICAgICAgICByZXR1cm4gMTsKLSAg
ICB9CisgICAgaW9tbXUtPmNtZF9idWZmZXIudGFpbCA9IHRhaWw7CiAKLSAg
ICByZXR1cm4gMDsKKyAgICB3cml0ZWwodGFpbCwgaW9tbXUtPm1taW9fYmFz
ZSArIElPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZTRVQpOwogfQogCiBzdGF0
aWMgdm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdSkK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.15-5.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.15-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRyb3AgY29tbWFuZCBjb21wbGV0aW9uIHRpbWVvdXQK
CkZpcnN0IGFuZCBmb3JlbW9zdCAtIHN1Y2ggdGltZW91dHMgd2VyZSBub3Qg
c2lnbmFsZWQgdG8gY2FsbGVycywgbWFraW5nCnRoZW0gYmVsaWV2ZSB0aGV5
J3JlIGZpbmUgdG8gZS5nLiBmcmVlIHByZXZpb3VzbHkgdW5tYXBwZWQgcGFn
ZXMuCgpNaXJyb3IgVlQtZCdzIGJlaGF2aW9yOiBBIGZpeGVkIG51bWJlciBv
ZiBsb29wIGl0ZXJhdGlvbnMgaXMgbm90IGEKc3VpdGFibGUgd2F5IHRvIGRl
dGVjdCB0aW1lb3V0cyBpbiBhbiBlbnZpcm9ubWVudCAoQ1BVIGFuZCBidXMg
c3BlZWRzKQppbmRlcGVuZGVudCBtYW5uZXIgYW55d2F5LiBGdXJ0aGVybW9y
ZSwgbGVhdmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24KcGVuZGluZyB3
aGVuIGl0IGFwcGVhcnMgdG8gdGFrZSB0b28gbG9uZyBpcyBwcm9ibGVtYXRp
YzogSWYgYSBjb21tYW5kCmNvbXBsZXRlZCBsYXRlciwgdGhlIHNpZ25hbGlu
ZyBvZiBpdHMgY29tcGxldGlvbiBtYXkgaW5zdGVhZCBiZQp1bmRlcnN0b29k
IHRvIHNpZ25hbCBhIHN1YnNlcXVlbnRseSBzdGFydGVkIGNvbW1hbmQncyBj
b21wbGV0aW9uLgoKTG9nIGV4Y2Vzc2l2ZWx5IGxvbmcgcHJvY2Vzc2luZyB0
aW1lcyAod2l0aCBhIHByb2dyZXNzaXZlIHRocmVzaG9sZCkgdG8KaGF2ZSBz
b21lIGluZGljYXRpb24gb2YgcHJvYmxlbXMgaW4gdGhpcyBhcmVhLiBBbGxv
dyBjYWxsZXJzIHRvIHNwZWNpZnkKYSBub24tZGVmYXVsdCB0aW1lb3V0IGJp
YXMgZm9yIHRoaXMgbG9nZ2luZywgdXNpbmcgdGhlIHNhbWUgdmFsdWVzIGFz
ClZULWQgZG9lcywgd2hpY2ggaW4gcGFydGljdWxhciBtZWFucyBhIChieSBk
ZWZhdWx0KSBtdWNoIGxhcmdlciB2YWx1ZQpmb3IgZGV2aWNlIElPIFRMQiBp
bnZhbGlkYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+CgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfY21kLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1k
L2lvbW11X2NtZC5jCkBAIC00NiwxMCArNDYsMTIgQEAgc3RhdGljIHZvaWQg
c2VuZF9pb21tdV9jb21tYW5kKHN0cnVjdCBhbQogICAgIHdyaXRlbCh0YWls
LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ01EX0JVRkZFUl9UQUlMX09G
RlNFVCk7CiB9CiAKLXN0YXRpYyB2b2lkIGZsdXNoX2NvbW1hbmRfYnVmZmVy
KHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQorc3RhdGljIHZvaWQgZmx1c2hf
Y29tbWFuZF9idWZmZXIoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgdGlt
ZW91dF9iYXNlKQogewotICAgIHVuc2lnbmVkIGludCBjbWRbNF0sIHN0YXR1
cywgbG9vcF9jb3VudDsKLSAgICBib29sIGNvbXBfd2FpdDsKKyAgICB1aW50
MzJfdCBjbWRbNF07CisgICAgc190aW1lX3Qgc3RhcnQsIHRpbWVvdXQ7Cisg
ICAgc3RhdGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHRocmVzaG9s
ZCA9IDE7CiAKICAgICAvKiBSVzFDICdDb21XYWl0SW50JyBpbiBzdGF0dXMg
cmVnaXN0ZXIgKi8KICAgICB3cml0ZWwoSU9NTVVfU1RBVFVTX0NPTVBfV0FJ
VF9JTlQsCkBAIC02NSwyMiArNjcsMjkgQEAgc3RhdGljIHZvaWQgZmx1c2hf
Y29tbWFuZF9idWZmZXIoc3RydWN0CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVfQ09NUF9XQUlUX0lfRkxBR19TSElGVCwgJmNtZFswXSk7CiAg
ICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11LCBjbWQpOwogCi0gICAgLyog
TWFrZSBsb29wX2NvdW50IGxvbmcgZW5vdWdoIGZvciBwb2xsaW5nIGNvbXBs
ZXRpb24gd2FpdCBiaXQgKi8KLSAgICBsb29wX2NvdW50ID0gMTAwMDsKLSAg
ICBkbyB7Ci0gICAgICAgIHN0YXR1cyA9IHJlYWRsKGlvbW11LT5tbWlvX2Jh
c2UgKyBJT01NVV9TVEFUVVNfTU1JT19PRkZTRVQpOwotICAgICAgICBjb21w
X3dhaXQgPSBzdGF0dXMgJiBJT01NVV9TVEFUVVNfQ09NUF9XQUlUX0lOVDsK
LSAgICAgICAgLS1sb29wX2NvdW50OwotICAgIH0gd2hpbGUgKCAhY29tcF93
YWl0ICYmIGxvb3BfY291bnQgKTsKLQotICAgIGlmICggY29tcF93YWl0ICkK
KyAgICBzdGFydCA9IE5PVygpOworICAgIHRpbWVvdXQgPSBzdGFydCArICh0
aW1lb3V0X2Jhc2UgPzogMTAwKSAqIE1JTExJU0VDUyh0aHJlc2hvbGQpOwor
ICAgIHdoaWxlICggIShyZWFkbChpb21tdS0+bW1pb19iYXNlICsgSU9NTVVf
U1RBVFVTX01NSU9fT0ZGU0VUKSAmCisgICAgICAgICAgICAgIElPTU1VX1NU
QVRVU19DT01QX1dBSVRfSU5UKSApCiAgICAgewotICAgICAgICAvKiBSVzFD
ICdDb21XYWl0SW50JyBpbiBzdGF0dXMgcmVnaXN0ZXIgKi8KLSAgICAgICAg
d3JpdGVsKElPTU1VX1NUQVRVU19DT01QX1dBSVRfSU5ULAotICAgICAgICAg
ICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX1NUQVRVU19NTUlPX09G
RlNFVCk7Ci0gICAgICAgIHJldHVybjsKKyAgICAgICAgaWYgKCB0aW1lb3V0
ICYmIE5PVygpID4gdGltZW91dCApCisgICAgICAgIHsKKyAgICAgICAgICAg
IHRocmVzaG9sZCB8PSB0aHJlc2hvbGQgPDwgMTsKKyAgICAgICAgICAgIHBy
aW50ayhYRU5MT0dfV0FSTklORworICAgICAgICAgICAgICAgICAgICJBTUQg
SU9NTVUgJXBwOiAlc2NvbXBsZXRpb24gd2FpdCB0YWtpbmcgdG9vIGxvbmdc
biIsCisgICAgICAgICAgICAgICAgICAgJlBDSV9TQkRGMihpb21tdS0+c2Vn
LCBpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgICAgICB0aW1lb3V0X2Jh
c2UgPyAiaW90bGIgIiA6ICIiKTsKKyAgICAgICAgICAgIHRpbWVvdXQgPSAw
OworICAgICAgICB9CisgICAgICAgIGNwdV9yZWxheCgpOwogICAgIH0KLSAg
ICBBTURfSU9NTVVfREVCVUcoIldhcm5pbmc6IENvbVdhaXRJbnQgYml0IGRp
ZCBub3QgYXNzZXJ0IVxuIik7CisKKyAgICBpZiAoICF0aW1lb3V0ICkKKyAg
ICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HCisgICAgICAgICAgICAgICAi
QU1EIElPTU1VICVwcDogJXNjb21wbGV0aW9uIHdhaXQgdG9vayAlbHVtc1xu
IiwKKyAgICAgICAgICAgICAgICZQQ0lfU0JERjIoaW9tbXUtPnNlZywgaW9t
bXUtPmJkZiksCisgICAgICAgICAgICAgICB0aW1lb3V0X2Jhc2UgPyAiaW90
bGIgIiA6ICIiLAorICAgICAgICAgICAgICAgKE5PVygpIC0gc3RhcnQpIC8g
MTAwMDAwMDApOwogfQogCiAvKiBCdWlsZCBsb3cgbGV2ZWwgaW9tbXUgY29t
bWFuZCBtZXNzYWdlcyAqLwpAQCAtMjkxLDcgKzMwMCw3IEBAIHZvaWQgYW1k
X2lvbW11X2ZsdXNoX2lvdGxiKHU4IGRldmZuLCBjb24KICAgICAvKiBzZW5k
IElOVkFMSURBVEVfSU9UTEJfUEFHRVMgY29tbWFuZCAqLwogICAgIHNwaW5f
bG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwogICAgIGludmFs
aWRhdGVfaW90bGJfcGFnZXMoaW9tbXUsIG1heHBlbmQsIDAsIHF1ZXVlaWQs
IGRhZGRyLCByZXFfaWQsIG9yZGVyKTsKLSAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSk7CisgICAgZmx1c2hfY29tbWFuZF9idWZmZXIoaW9tbXUs
IGlvbW11X2Rldl9pb3RsYl90aW1lb3V0KTsKICAgICBzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwogfQogCkBAIC0zMjgs
NyArMzM3LDcgQEAgc3RhdGljIHZvaWQgX2FtZF9pb21tdV9mbHVzaF9wYWdl
cyhzdHJ1YwogICAgIHsKICAgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlv
bW11LT5sb2NrLCBmbGFncyk7CiAgICAgICAgIGludmFsaWRhdGVfaW9tbXVf
cGFnZXMoaW9tbXUsIGRhZGRyLCBkb21faWQsIG9yZGVyKTsKLSAgICAgICAg
Zmx1c2hfY29tbWFuZF9idWZmZXIoaW9tbXUpOworICAgICAgICBmbHVzaF9j
b21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiAgICAgICAgIHNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJmlvbW11LT5sb2NrLCBmbGFncyk7CiAgICAgfQogCkBA
IC0zNTIsNyArMzYxLDcgQEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfZGV2aWNl
KHN0cnVjdCBhbWRfaQogICAgIEFTU0VSVCggc3Bpbl9pc19sb2NrZWQoJmlv
bW11LT5sb2NrKSApOwogCiAgICAgaW52YWxpZGF0ZV9kZXZfdGFibGVfZW50
cnkoaW9tbXUsIGJkZik7Ci0gICAgZmx1c2hfY29tbWFuZF9idWZmZXIoaW9t
bXUpOworICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11LCAwKTsKIH0K
IAogdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW50cmVtYXAoc3RydWN0IGFtZF9p
b21tdSAqaW9tbXUsIHVpbnQxNl90IGJkZikKQEAgLTM2MCw3ICszNjksNyBA
QCB2b2lkIGFtZF9pb21tdV9mbHVzaF9pbnRyZW1hcChzdHJ1Y3QgYW1kCiAg
ICAgQVNTRVJUKCBzcGluX2lzX2xvY2tlZCgmaW9tbXUtPmxvY2spICk7CiAK
ICAgICBpbnZhbGlkYXRlX2ludGVycnVwdF90YWJsZShpb21tdSwgYmRmKTsK
LSAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAgZmx1c2hf
Y29tbWFuZF9idWZmZXIoaW9tbXUsIDApOwogfQogCiB2b2lkIGFtZF9pb21t
dV9mbHVzaF9hbGxfY2FjaGVzKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQpA
QCAtMzY4LDcgKzM3Nyw3IEBAIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9j
YWNoZXMoc3RydWN0IGEKICAgICBBU1NFUlQoIHNwaW5faXNfbG9ja2VkKCZp
b21tdS0+bG9jaykgKTsKIAogICAgIGludmFsaWRhdGVfaW9tbXVfYWxsKGlv
bW11KTsKLSAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAg
Zmx1c2hfY29tbWFuZF9idWZmZXIoaW9tbXUsIDApOwogfQogCiB2b2lkIGFt
ZF9pb21tdV9zZW5kX2d1ZXN0X2NtZChzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSwgdTMyIGNtZFtdKQpAQCAtMzc4LDcgKzM4Nyw4IEBAIHZvaWQgYW1kX2lv
bW11X3NlbmRfZ3Vlc3RfY21kKHN0cnVjdCBhbWQKICAgICBzcGluX2xvY2tf
aXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKIAogICAgIHNlbmRfaW9t
bXVfY29tbWFuZChpb21tdSwgY21kKTsKLSAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSk7CisgICAgLyogVEJEOiBUaW1lb3V0IHNlbGVjdGlvbiBt
YXkgcmVxdWlyZSBwZWVraW5nIGludG8gY21kW10uICovCisgICAgZmx1c2hf
Y29tbWFuZF9idWZmZXIoaW9tbXUsIDApOwogCiAgICAgc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKIH0K

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-4.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-4.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHdhaXQgZm9yIGNvbW1hbmQgc2xvdCB0byBiZSBhdmFp
bGFibGUKCk5vIGNhbGxlciBjYXJlZCBhYm91dCBzZW5kX2lvbW11X2NvbW1h
bmQoKSBpbmRpY2F0aW5nIHVuYXZhaWxhYmlsaXR5IG9mCmEgc2xvdC4gSGVu
Y2UgaWYgYSBzdWZmaWNpZW50IG51bWJlciBwcmlvciBjb21tYW5kcyB0aW1l
ZCBvdXQsIHdlIGRpZApibGluZGx5IGFzc3VtZSB0aGF0IHRoZSByZXF1ZXN0
ZWQgY29tbWFuZCB3YXMgc3VibWl0dGVkIHRvIHRoZSBJT01NVQp3aGVuIHJl
YWxseSBpdCB3YXNuJ3QuIFRoaXMgY291bGQgbWVhbiBib3RoIGEgaGFuZ2lu
ZyBzeXN0ZW0gKHdhaXRpbmcKZm9yIGEgY29tbWFuZCB0byBjb21wbGV0ZSB0
aGF0IHdhcyBuZXZlciBzZWVuIGJ5IHRoZSBJT01NVSkgb3IgYmxpbmRseQpw
cm9wYWdhdGluZyBzdWNjZXNzIGJhY2sgdG8gY2FsbGVycywgbWFraW5nIHRo
ZW0gYmVsaWV2ZSB0aGV5J3JlIGZpbmUKdG8gZS5nLiBmcmVlIHByZXZpb3Vz
bHkgdW5tYXBwZWQgcGFnZXMuCgpGb2xkIHRoZSB0aHJlZSBpbnZvbHZlZCBm
dW5jdGlvbnMgaW50byBvbmUsIGFkZCBzcGluIHdhaXRpbmcgZm9yIGFuCmF2
YWlsYWJsZSBzbG90IGFsb25nIHRoZSBsaW5lcyBvZiBWVC1kJ3MgcWludmFs
X25leHRfaW5kZXgoKSwgYW5kIGFzIGEKY29uc2VxdWVuY2UgZHJvcCBhbGwg
ZXJyb3IgaW5kaWNhdG9yIHJldHVybiB0eXBlcy92YWx1ZXMuCgpUaGlzIGlz
IHBhcnQgb2YgWFNBLTM3MyAvIENWRS0yMDIxLTI4NjkyLgoKU2lnbmVkLW9m
Zi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsQHhlbi5vcmc+CgotLS0gYS94ZW4v
ZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKKysrIGIveGVu
L2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2NtZC5jCkBAIC0yMCw0
MyArMjAsMzAgQEAKICNpbmNsdWRlICJpb21tdS5oIgogI2luY2x1ZGUgIi4u
L2F0cy5oIgogCi1zdGF0aWMgaW50IHF1ZXVlX2lvbW11X2NvbW1hbmQoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsIHUzMiBjbWRbXSkKK3N0YXRpYyB2b2lk
IHNlbmRfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1aW50MzJf
dCBjbWRbNF0pCiB7Ci0gICAgdWludDMyX3QgdGFpbCwgaGVhZDsKKyAgICB1
aW50MzJfdCB0YWlsOwogCiAgICAgdGFpbCA9IGlvbW11LT5jbWRfYnVmZmVy
LnRhaWwgKyBzaXplb2YoY21kX2VudHJ5X3QpOwogICAgIGlmICggdGFpbCA9
PSBpb21tdS0+Y21kX2J1ZmZlci5zaXplICkKICAgICAgICAgdGFpbCA9IDA7
CiAKLSAgICBoZWFkID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArCi0gICAg
ICAgICAgICAgICAgIElPTU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpICYg
SU9NTVVfUklOR19CVUZGRVJfUFRSX01BU0s7Ci0gICAgaWYgKCBoZWFkICE9
IHRhaWwgKQorICAgIHdoaWxlICggdGFpbCA9PSAocmVhZGwoaW9tbXUtPm1t
aW9fYmFzZSArCisgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9D
TURfQlVGRkVSX0hFQURfT0ZGU0VUKSAmCisgICAgICAgICAgICAgICAgICAg
ICBJT01NVV9SSU5HX0JVRkZFUl9QVFJfTUFTSykgKQogICAgIHsKLSAgICAg
ICAgbWVtY3B5KGlvbW11LT5jbWRfYnVmZmVyLmJ1ZmZlciArIGlvbW11LT5j
bWRfYnVmZmVyLnRhaWwsCi0gICAgICAgICAgICAgICBjbWQsIHNpemVvZihj
bWRfZW50cnlfdCkpOwotCi0gICAgICAgIGlvbW11LT5jbWRfYnVmZmVyLnRh
aWwgPSB0YWlsOwotICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgcHJpbnRr
X29uY2UoWEVOTE9HX0VSUiAiQU1EIElPTU1VICVwcDogbm8gY21kIHNsb3Qg
YXZhaWxhYmxlXG4iLAorICAgICAgICAgICAgICAgICAgICAmUENJX1NCREYy
KGlvbW11LT5zZWcsIGlvbW11LT5iZGYpKTsKKyAgICAgICAgY3B1X3JlbGF4
KCk7CiAgICAgfQogCi0gICAgcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyB2b2lk
IGNvbW1pdF9pb21tdV9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdSkKLXsKLSAgICB3cml0ZWwoaW9tbXUtPmNtZF9idWZmZXIudGFp
bCwKLSAgICAgICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NNRF9C
VUZGRVJfVEFJTF9PRkZTRVQpOwotfQorICAgIG1lbWNweShpb21tdS0+Y21k
X2J1ZmZlci5idWZmZXIgKyBpb21tdS0+Y21kX2J1ZmZlci50YWlsLAorICAg
ICAgICAgICBjbWQsIHNpemVvZihjbWRfZW50cnlfdCkpOwogCi1zdGF0aWMg
aW50IHNlbmRfaW9tbXVfY29tbWFuZChzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSwgdTMyIGNtZFtdKQotewotICAgIGlmICggcXVldWVfaW9tbXVfY29tbWFu
ZChpb21tdSwgY21kKSApCi0gICAgewotICAgICAgICBjb21taXRfaW9tbXVf
Y29tbWFuZF9idWZmZXIoaW9tbXUpOwotICAgICAgICByZXR1cm4gMTsKLSAg
ICB9CisgICAgaW9tbXUtPmNtZF9idWZmZXIudGFpbCA9IHRhaWw7CiAKLSAg
ICByZXR1cm4gMDsKKyAgICB3cml0ZWwodGFpbCwgaW9tbXUtPm1taW9fYmFz
ZSArIElPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZTRVQpOwogfQogCiBzdGF0
aWMgdm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdSkK

--=separator
Content-Type: application/octet-stream; name="xsa373/xsa373-5.patch"
Content-Disposition: attachment; filename="xsa373/xsa373-5.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IGRyb3AgY29tbWFuZCBjb21wbGV0aW9uIHRpbWVvdXQK
CkZpcnN0IGFuZCBmb3JlbW9zdCAtIHN1Y2ggdGltZW91dHMgd2VyZSBub3Qg
c2lnbmFsZWQgdG8gY2FsbGVycywgbWFraW5nCnRoZW0gYmVsaWV2ZSB0aGV5
J3JlIGZpbmUgdG8gZS5nLiBmcmVlIHByZXZpb3VzbHkgdW5tYXBwZWQgcGFn
ZXMuCgpNaXJyb3IgVlQtZCdzIGJlaGF2aW9yOiBBIGZpeGVkIG51bWJlciBv
ZiBsb29wIGl0ZXJhdGlvbnMgaXMgbm90IGEKc3VpdGFibGUgd2F5IHRvIGRl
dGVjdCB0aW1lb3V0cyBpbiBhbiBlbnZpcm9ubWVudCAoQ1BVIGFuZCBidXMg
c3BlZWRzKQppbmRlcGVuZGVudCBtYW5uZXIgYW55d2F5LiBGdXJ0aGVybW9y
ZSwgbGVhdmluZyBhbiBpbi1wcm9ncmVzcyBvcGVyYXRpb24KcGVuZGluZyB3
aGVuIGl0IGFwcGVhcnMgdG8gdGFrZSB0b28gbG9uZyBpcyBwcm9ibGVtYXRp
YzogSWYgYSBjb21tYW5kCmNvbXBsZXRlZCBsYXRlciwgdGhlIHNpZ25hbGlu
ZyBvZiBpdHMgY29tcGxldGlvbiBtYXkgaW5zdGVhZCBiZQp1bmRlcnN0b29k
IHRvIHNpZ25hbCBhIHN1YnNlcXVlbnRseSBzdGFydGVkIGNvbW1hbmQncyBj
b21wbGV0aW9uLgoKTG9nIGV4Y2Vzc2l2ZWx5IGxvbmcgcHJvY2Vzc2luZyB0
aW1lcyAod2l0aCBhIHByb2dyZXNzaXZlIHRocmVzaG9sZCkgdG8KaGF2ZSBz
b21lIGluZGljYXRpb24gb2YgcHJvYmxlbXMgaW4gdGhpcyBhcmVhLiBBbGxv
dyBjYWxsZXJzIHRvIHNwZWNpZnkKYSBub24tZGVmYXVsdCB0aW1lb3V0IGJp
YXMgZm9yIHRoaXMgbG9nZ2luZywgdXNpbmcgdGhlIHNhbWUgdmFsdWVzIGFz
ClZULWQgZG9lcywgd2hpY2ggaW4gcGFydGljdWxhciBtZWFucyBhIChieSBk
ZWZhdWx0KSBtdWNoIGxhcmdlciB2YWx1ZQpmb3IgZGV2aWNlIElPIFRMQiBp
bnZhbGlkYXRpb24uCgpUaGlzIGlzIHBhcnQgb2YgWFNBLTM3MyAvIENWRS0y
MDIxLTI4NjkyLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVs
aWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVs
QHhlbi5vcmc+Ci0tLQp2MjogQXZvaWQgbGVhZGluZyBibGFua3MgaW4gbG9n
IG1lc3NhZ2VzLgotLS0KVEJEOiBBcyBsb25nIGFzIHRoZSBzcGlubmluZyBo
YXBwZW5zIHVuZGVyIGxvY2ssIDEwMG1zIG1heSBiZSB0b28gbGFyZ2UKICAg
ICBhIGdyYW51bGFyaXR5LiBCdXQgSSd2ZSBsZWZ0IGl0IHNpbWlsYXIgdG8g
VlQtZCBhcyBzdWJzZXF1ZW50bHkgSSdtCiAgICAgaW50ZW5kaW5nIHRvIHJl
LXdvcmsgdGhlIGxvY2tpbmcgc3VjaCB0aGF0IHRoZSBzcGlubmluZyB3aWxs
IHN0YXJ0CiAgICAgb25seSBhZnRlciBkcm9wcGluZyB0aGUgbG9jaywgbGlr
ZSBWVC1kIFFJIGFsc28gZG9lcy4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0
aHJvdWdoL2FtZC9pb21tdV9jbWQuYworKysgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9hbWQvaW9tbXVfY21kLmMKQEAgLTQ2LDEwICs0NiwxMiBAQCBz
dGF0aWMgdm9pZCBzZW5kX2lvbW11X2NvbW1hbmQoc3RydWN0IGFtCiAgICAg
d3JpdGVsKHRhaWwsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DTURfQlVG
RkVSX1RBSUxfT0ZGU0VUKTsKIH0KIAotc3RhdGljIHZvaWQgZmx1c2hfY29t
bWFuZF9idWZmZXIoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpCitzdGF0aWMg
dm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QgYW1kX2lvbW11ICpp
b21tdSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCB0aW1lb3V0X2Jhc2UpCiB7Ci0gICAgdW5zaWduZWQgaW50IGNt
ZFs0XSwgc3RhdHVzLCBsb29wX2NvdW50OwotICAgIGJvb2wgY29tcF93YWl0
OworICAgIHVpbnQzMl90IGNtZFs0XTsKKyAgICBzX3RpbWVfdCBzdGFydCwg
dGltZW91dDsKKyAgICBzdGF0aWMgdW5zaWduZWQgaW50IF9fcmVhZF9tb3N0
bHkgdGhyZXNob2xkID0gMTsKIAogICAgIC8qIFJXMUMgJ0NvbVdhaXRJbnQn
IGluIHN0YXR1cyByZWdpc3RlciAqLwogICAgIHdyaXRlbChJT01NVV9TVEFU
VVNfQ09NUF9XQUlUX0lOVCwKQEAgLTY1LDIyICs2NywyOSBAQCBzdGF0aWMg
dm9pZCBmbHVzaF9jb21tYW5kX2J1ZmZlcihzdHJ1Y3QKICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9DT01QX1dBSVRfSV9GTEFHX1NISUZULCAm
Y21kWzBdKTsKICAgICBzZW5kX2lvbW11X2NvbW1hbmQoaW9tbXUsIGNtZCk7
CiAKLSAgICAvKiBNYWtlIGxvb3BfY291bnQgbG9uZyBlbm91Z2ggZm9yIHBv
bGxpbmcgY29tcGxldGlvbiB3YWl0IGJpdCAqLwotICAgIGxvb3BfY291bnQg
PSAxMDAwOwotICAgIGRvIHsKLSAgICAgICAgc3RhdHVzID0gcmVhZGwoaW9t
bXUtPm1taW9fYmFzZSArIElPTU1VX1NUQVRVU19NTUlPX09GRlNFVCk7Ci0g
ICAgICAgIGNvbXBfd2FpdCA9IHN0YXR1cyAmIElPTU1VX1NUQVRVU19DT01Q
X1dBSVRfSU5UOwotICAgICAgICAtLWxvb3BfY291bnQ7Ci0gICAgfSB3aGls
ZSAoICFjb21wX3dhaXQgJiYgbG9vcF9jb3VudCApOwotCi0gICAgaWYgKCBj
b21wX3dhaXQgKQorICAgIHN0YXJ0ID0gTk9XKCk7CisgICAgdGltZW91dCA9
IHN0YXJ0ICsgKHRpbWVvdXRfYmFzZSA/OiAxMDApICogTUlMTElTRUNTKHRo
cmVzaG9sZCk7CisgICAgd2hpbGUgKCAhKHJlYWRsKGlvbW11LT5tbWlvX2Jh
c2UgKyBJT01NVV9TVEFUVVNfTU1JT19PRkZTRVQpICYKKyAgICAgICAgICAg
ICAgSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlQpICkKICAgICB7Ci0gICAg
ICAgIC8qIFJXMUMgJ0NvbVdhaXRJbnQnIGluIHN0YXR1cyByZWdpc3RlciAq
LwotICAgICAgICB3cml0ZWwoSU9NTVVfU1RBVFVTX0NPTVBfV0FJVF9JTlQs
Ci0gICAgICAgICAgICAgICBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfU1RB
VFVTX01NSU9fT0ZGU0VUKTsKLSAgICAgICAgcmV0dXJuOworICAgICAgICBp
ZiAoIHRpbWVvdXQgJiYgTk9XKCkgPiB0aW1lb3V0ICkKKyAgICAgICAgewor
ICAgICAgICAgICAgdGhyZXNob2xkIHw9IHRocmVzaG9sZCA8PCAxOworICAg
ICAgICAgICAgcHJpbnRrKFhFTkxPR19XQVJOSU5HCisgICAgICAgICAgICAg
ICAgICAgIkFNRCBJT01NVSAlcHA6ICVzY29tcGxldGlvbiB3YWl0IHRha2lu
ZyB0b28gbG9uZ1xuIiwKKyAgICAgICAgICAgICAgICAgICAmUENJX1NCREYy
KGlvbW11LT5zZWcsIGlvbW11LT5iZGYpLAorICAgICAgICAgICAgICAgICAg
IHRpbWVvdXRfYmFzZSA/ICJpb3RsYiAiIDogIiIpOworICAgICAgICAgICAg
dGltZW91dCA9IDA7CisgICAgICAgIH0KKyAgICAgICAgY3B1X3JlbGF4KCk7
CiAgICAgfQotICAgIEFNRF9JT01NVV9ERUJVRygiV2FybmluZzogQ29tV2Fp
dEludCBiaXQgZGlkIG5vdCBhc3NlcnQhXG4iKTsKKworICAgIGlmICggIXRp
bWVvdXQgKQorICAgICAgICBwcmludGsoWEVOTE9HX1dBUk5JTkcKKyAgICAg
ICAgICAgICAgICJBTUQgSU9NTVUgJXBwOiAlc2NvbXBsZXRpb24gd2FpdCB0
b29rICVsdW1zXG4iLAorICAgICAgICAgICAgICAgJlBDSV9TQkRGMihpb21t
dS0+c2VnLCBpb21tdS0+YmRmKSwKKyAgICAgICAgICAgICAgIHRpbWVvdXRf
YmFzZSA/ICJpb3RsYiAiIDogIiIsCisgICAgICAgICAgICAgICAoTk9XKCkg
LSBzdGFydCkgLyAxMDAwMDAwMCk7CiB9CiAKIC8qIEJ1aWxkIGxvdyBsZXZl
bCBpb21tdSBjb21tYW5kIG1lc3NhZ2VzICovCkBAIC0yOTEsNyArMzAwLDcg
QEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfaW90bGIodTggZGV2Zm4sIGNvbgog
ICAgIC8qIHNlbmQgSU5WQUxJREFURV9JT1RMQl9QQUdFUyBjb21tYW5kICov
CiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlvbW11LT5sb2NrLCBmbGFncyk7
CiAgICAgaW52YWxpZGF0ZV9pb3RsYl9wYWdlcyhpb21tdSwgbWF4cGVuZCwg
MCwgcXVldWVpZCwgZGFkZHIsIHJlcV9pZCwgb3JkZXIpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1
ZmZlcihpb21tdSwgaW9tbXVfZGV2X2lvdGxiX3RpbWVvdXQpOwogICAgIHNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJmlvbW11LT5sb2NrLCBmbGFncyk7CiB9
CiAKQEAgLTMyOCw3ICszMzcsNyBAQCBzdGF0aWMgdm9pZCBfYW1kX2lvbW11
X2ZsdXNoX3BhZ2VzKHN0cnVjCiAgICAgewogICAgICAgICBzcGluX2xvY2tf
aXJxc2F2ZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsKICAgICAgICAgaW52YWxp
ZGF0ZV9pb21tdV9wYWdlcyhpb21tdSwgZGFkZHIsIGRvbV9pZCwgb3JkZXIp
OwotICAgICAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSk7CisgICAg
ICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11LCAwKTsKICAgICAgICAg
c3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPmxvY2ssIGZsYWdzKTsK
ICAgICB9CiAKQEAgLTM1Miw3ICszNjEsNyBAQCB2b2lkIGFtZF9pb21tdV9m
bHVzaF9kZXZpY2Uoc3RydWN0IGFtZF9pCiAgICAgQVNTRVJUKCBzcGluX2lz
X2xvY2tlZCgmaW9tbXUtPmxvY2spICk7CiAKICAgICBpbnZhbGlkYXRlX2Rl
dl90YWJsZV9lbnRyeShpb21tdSwgYmRmKTsKLSAgICBmbHVzaF9jb21tYW5k
X2J1ZmZlcihpb21tdSk7CisgICAgZmx1c2hfY29tbWFuZF9idWZmZXIoaW9t
bXUsIDApOwogfQogCiB2b2lkIGFtZF9pb21tdV9mbHVzaF9pbnRyZW1hcChz
dHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWludDE2X3QgYmRmKQpAQCAtMzYw
LDcgKzM2OSw3IEBAIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2ludHJlbWFwKHN0
cnVjdCBhbWQKICAgICBBU1NFUlQoIHNwaW5faXNfbG9ja2VkKCZpb21tdS0+
bG9jaykgKTsKIAogICAgIGludmFsaWRhdGVfaW50ZXJydXB0X3RhYmxlKGlv
bW11LCBiZGYpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlvbW11KTsK
KyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiB9CiAKIHZv
aWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9jYWNoZXMoc3RydWN0IGFtZF9pb21t
dSAqaW9tbXUpCkBAIC0zNjgsNyArMzc3LDcgQEAgdm9pZCBhbWRfaW9tbXVf
Zmx1c2hfYWxsX2NhY2hlcyhzdHJ1Y3QgYQogICAgIEFTU0VSVCggc3Bpbl9p
c19sb2NrZWQoJmlvbW11LT5sb2NrKSApOwogCiAgICAgaW52YWxpZGF0ZV9p
b21tdV9hbGwoaW9tbXUpOwotICAgIGZsdXNoX2NvbW1hbmRfYnVmZmVyKGlv
bW11KTsKKyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiB9
CiAKIHZvaWQgYW1kX2lvbW11X3NlbmRfZ3Vlc3RfY21kKHN0cnVjdCBhbWRf
aW9tbXUgKmlvbW11LCB1MzIgY21kW10pCkBAIC0zNzgsNyArMzg3LDggQEAg
dm9pZCBhbWRfaW9tbXVfc2VuZF9ndWVzdF9jbWQoc3RydWN0IGFtZAogICAg
IHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwogCiAg
ICAgc2VuZF9pb21tdV9jb21tYW5kKGlvbW11LCBjbWQpOwotICAgIGZsdXNo
X2NvbW1hbmRfYnVmZmVyKGlvbW11KTsKKyAgICAvKiBUQkQ6IFRpbWVvdXQg
c2VsZWN0aW9uIG1heSByZXF1aXJlIHBlZWtpbmcgaW50byBjbWRbXS4gKi8K
KyAgICBmbHVzaF9jb21tYW5kX2J1ZmZlcihpb21tdSwgMCk7CiAKICAgICBz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwog
fQo=

--=separator--


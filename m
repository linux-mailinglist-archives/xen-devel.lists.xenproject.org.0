Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 3EB0787DA1
	for <lists+xen-devel@lfdr.de>; Fri,  9 Aug 2019 17:03:41 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hw6Lr-0006P7-Uf; Fri, 09 Aug 2019 14:58:43 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=yG4W=WF=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hw6Lq-0006Om-C3
 for xen-devel@lists.xenproject.org; Fri, 09 Aug 2019 14:58:42 +0000
X-Inumbo-ID: 2afa70a4-bab6-11e9-8fca-4bf3aad99f02
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 2afa70a4-bab6-11e9-8fca-4bf3aad99f02;
 Fri, 09 Aug 2019 14:58:38 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 95019AF83;
 Fri,  9 Aug 2019 14:58:37 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Fri,  9 Aug 2019 16:57:47 +0200
Message-Id: <20190809145833.1020-3-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190809145833.1020-1-jgross@suse.com>
References: <20190809145833.1020-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH v2 02/48] xen/sched: move per-vcpu scheduler
 private data pointer to sched_unit
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

VGhpcyBwcmVwYXJlcyBtYWtpbmcgdGhlIGRpZmZlcmVudCBzY2hlZHVsZXJzIHZjcHUgYWdub3N0
aWMuCgpOb3RlIHRoYXQgc29tZSBzY2hlZHVsZXIgc3BlY2lmaWMgYWNjZXNzb3IgZnVuY3Rpb24g
YXJlIG1pc25hbWVkIGFmdGVyCnRoaXMgcGF0Y2guIFRoaXMgd2lsbCBiZSBjb3JyZWN0ZWQgaW4g
bGF0ZXIgcGF0Y2hlcy4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNl
LmNvbT4KLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMgfCAgNCArKy0tCiB4ZW4vY29t
bW9uL3NjaGVkX2NyZWRpdC5jICAgfCAgNiArKystLS0KIHhlbi9jb21tb24vc2NoZWRfY3JlZGl0
Mi5jICB8IDEwICsrKysrLS0tLS0KIHhlbi9jb21tb24vc2NoZWRfbnVsbC5jICAgICB8ICA0ICsr
LS0KIHhlbi9jb21tb24vc2NoZWRfcnQuYyAgICAgICB8ICA0ICsrLS0KIHhlbi9jb21tb24vc2No
ZWR1bGUuYyAgICAgICB8IDE0ICsrKysrKystLS0tLS0tCiB4ZW4vaW5jbHVkZS94ZW4vc2NoZWQu
aCAgICAgfCAgMiArLQogNyBmaWxlcyBjaGFuZ2VkLCAyMiBpbnNlcnRpb25zKCspLCAyMiBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMgYi94ZW4v
Y29tbW9uL3NjaGVkX2FyaW5jNjUzLmMKaW5kZXggMjA1OTMxNDc5MS4uYzEyYjM2YjJkOCAxMDA2
NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jCisrKyBiL3hlbi9jb21tb24vc2No
ZWRfYXJpbmM2NTMuYwpAQCAtNTMsNyArNTMsNyBAQAogICogUmV0dXJuIGEgcG9pbnRlciB0byB0
aGUgQVJJTkMgNjUzLXNwZWNpZmljIHNjaGVkdWxlciBkYXRhIGluZm9ybWF0aW9uCiAgKiBhc3Nv
Y2lhdGVkIHdpdGggdGhlIGdpdmVuIFZDUFUgKHZjKQogICovCi0jZGVmaW5lIEFWQ1BVKHZjKSAo
KGFyaW5jNjUzX3ZjcHVfdCAqKSh2YyktPnNjaGVkX3ByaXYpCisjZGVmaW5lIEFWQ1BVKHZjKSAo
KGFyaW5jNjUzX3ZjcHVfdCAqKSh2YyktPnNjaGVkX3VuaXQtPnByaXYpCiAKIC8qKgogICogUmV0
dXJuIHRoZSBnbG9iYWwgc2NoZWR1bGVyIHByaXZhdGUgZGF0YSBnaXZlbiB0aGUgc2NoZWR1bGVy
IG9wcyBwb2ludGVyCkBAIC02NDcsNyArNjQ3LDcgQEAgYTY1M19zd2l0Y2hfc2NoZWQoc3RydWN0
IHNjaGVkdWxlciAqbmV3X29wcywgdW5zaWduZWQgaW50IGNwdSwKIAogICAgIEFTU0VSVCghcGRh
dGEgJiYgc3ZjICYmIGlzX2lkbGVfdmNwdShzdmMtPnZjKSk7CiAKLSAgICBpZGxlX3ZjcHVbY3B1
XS0+c2NoZWRfcHJpdiA9IHZkYXRhOworICAgIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91bml0LT5w
cml2ID0gdmRhdGE7CiAKICAgICByZXR1cm4gJnNkLT5fbG9jazsKIH0KZGlmZiAtLWdpdCBhL3hl
bi9jb21tb24vc2NoZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4
IDQ2NDE5NGE1NzguLmU4MzVhNDkzMGEgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3Jl
ZGl0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtODMsNyArODMsNyBAQAog
ICAgICgoc3RydWN0IGNzY2hlZF9wcml2YXRlICopKChfb3BzKS0+c2NoZWRfZGF0YSkpCiAjZGVm
aW5lIENTQ0hFRF9QQ1BVKF9jKSAgICAgXAogICAgICgoc3RydWN0IGNzY2hlZF9wY3B1ICopcGVy
X2NwdShzY2hlZHVsZV9kYXRhLCBfYykuc2NoZWRfcHJpdikKLSNkZWZpbmUgQ1NDSEVEX1ZDUFUo
X3ZjcHUpICAoKHN0cnVjdCBjc2NoZWRfdmNwdSAqKSAoX3ZjcHUpLT5zY2hlZF9wcml2KQorI2Rl
ZmluZSBDU0NIRURfVkNQVShfdmNwdSkgICgoc3RydWN0IGNzY2hlZF92Y3B1ICopIChfdmNwdSkt
PnNjaGVkX3VuaXQtPnByaXYpCiAjZGVmaW5lIENTQ0hFRF9ET00oX2RvbSkgICAgKChzdHJ1Y3Qg
Y3NjaGVkX2RvbSAqKSAoX2RvbSktPnNjaGVkX3ByaXYpCiAjZGVmaW5lIFJVTlEoX2NwdSkgICAg
ICAgICAgKCYoQ1NDSEVEX1BDUFUoX2NwdSktPnJ1bnEpKQogCkBAIC02MzQsNyArNjM0LDcgQEAg
Y3NjaGVkX3N3aXRjaF9zY2hlZChzdHJ1Y3Qgc2NoZWR1bGVyICpuZXdfb3BzLCB1bnNpZ25lZCBp
bnQgY3B1LAogCiAgICAgQVNTRVJUKHN2YyAmJiBpc19pZGxlX3ZjcHUoc3ZjLT52Y3B1KSk7CiAK
LSAgICBpZGxlX3ZjcHVbY3B1XS0+c2NoZWRfcHJpdiA9IHZkYXRhOworICAgIGlkbGVfdmNwdVtj
cHVdLT5zY2hlZF91bml0LT5wcml2ID0gdmRhdGE7CiAKICAgICAvKgogICAgICAqIFdlIGFyZSBo
b2xkaW5nIHRoZSBydW5xdWV1ZSBsb2NrIGFscmVhZHkgKGl0J3MgYmVlbiB0YWtlbiBpbgpAQCAt
MTAxNyw3ICsxMDE3LDcgQEAgc3RhdGljIHZvaWQKIGNzY2hlZF91bml0X2luc2VydChjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAgIHN0
cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKLSAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUg
KnN2YyA9IHZjLT5zY2hlZF9wcml2OworICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqc3ZjID0gdW5p
dC0+cHJpdjsKICAgICBzcGlubG9ja190ICpsb2NrOwogCiAgICAgQlVHX09OKCBpc19pZGxlX3Zj
cHUodmMpICk7CmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyBiL3hlbi9j
b21tb24vc2NoZWRfY3JlZGl0Mi5jCmluZGV4IDIxMjBkYTZmOTguLmEyNDAzZTQxOTggMTAwNjQ0
Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRf
Y3JlZGl0Mi5jCkBAIC01NzMsNyArNTczLDcgQEAgc3RhdGljIGlubGluZSBzdHJ1Y3QgY3NjaGVk
Ml9wY3B1ICpjc2NoZWQyX3BjcHUodW5zaWduZWQgaW50IGNwdSkKIAogc3RhdGljIGlubGluZSBz
dHJ1Y3QgY3NjaGVkMl92Y3B1ICpjc2NoZWQyX3ZjcHUoY29uc3Qgc3RydWN0IHZjcHUgKnYpCiB7
Ci0gICAgcmV0dXJuIHYtPnNjaGVkX3ByaXY7CisgICAgcmV0dXJuIHYtPnNjaGVkX3VuaXQtPnBy
aXY7CiB9CiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IGNzY2hlZDJfZG9tICpjc2NoZWQyX2RvbShj
b25zdCBzdHJ1Y3QgZG9tYWluICpkKQpAQCAtOTcxLDcgKzk3MSw3IEBAIF9ydW5xX2Fzc2lnbihz
dHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMsIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnJx
ZCkKIHN0YXRpYyB2b2lkCiBydW5xX2Fzc2lnbihjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMs
IHN0cnVjdCB2Y3B1ICp2YykKIHsKLSAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2Yy0+
c2NoZWRfcHJpdjsKKyAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2Yy0+c2NoZWRfdW5p
dC0+cHJpdjsKIAogICAgIEFTU0VSVChzdmMtPnJxZCA9PSBOVUxMKTsKIApAQCAtOTk4LDcgKzk5
OCw3IEBAIF9ydW5xX2RlYXNzaWduKHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YykKIHN0YXRpYyB2
b2lkCiBydW5xX2RlYXNzaWduKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnZjKQogewotICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF9wcml2
OworICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF91bml0LT5wcml2Owog
CiAgICAgQVNTRVJUKHN2Yy0+cnFkID09IGMycnFkKG9wcywgdmMtPnByb2Nlc3NvcikpOwogCkBA
IC0zMTA5LDcgKzMxMDksNyBAQCBzdGF0aWMgdm9pZAogY3NjaGVkMl91bml0X2luc2VydChjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogewogICAg
IHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHVfbGlzdDsKLSAgICBzdHJ1Y3QgY3NjaGVkMl92
Y3B1ICpzdmMgPSB2Yy0+c2NoZWRfcHJpdjsKKyAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMg
PSB1bml0LT5wcml2OwogICAgIHN0cnVjdCBjc2NoZWQyX2RvbSAqIGNvbnN0IHNkb20gPSBzdmMt
PnNkb207CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKIApAQCAtMzg5MSw3ICszODkxLDcgQEAgY3Nj
aGVkMl9zd2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxlciAqbmV3X29wcywgdW5zaWduZWQgaW50
IGNwdSwKICAgICBBU1NFUlQoIWxvY2FsX2lycV9pc19lbmFibGVkKCkpOwogICAgIHdyaXRlX2xv
Y2soJnBydi0+bG9jayk7CiAKLSAgICBpZGxlX3ZjcHVbY3B1XS0+c2NoZWRfcHJpdiA9IHZkYXRh
OworICAgIGlkbGVfdmNwdVtjcHVdLT5zY2hlZF91bml0LT5wcml2ID0gdmRhdGE7CiAKICAgICBy
cWkgPSBpbml0X3BkYXRhKHBydiwgcGRhdGEsIGNwdSk7CiAKZGlmZiAtLWdpdCBhL3hlbi9jb21t
b24vc2NoZWRfbnVsbC5jIGIveGVuL2NvbW1vbi9zY2hlZF9udWxsLmMKaW5kZXggZmQwMzFjOTg5
Yi4uYmRiYTIzNzk4MiAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9udWxsLmMKKysrIGIv
eGVuL2NvbW1vbi9zY2hlZF9udWxsLmMKQEAgLTExNiw3ICsxMTYsNyBAQCBzdGF0aWMgaW5saW5l
IHN0cnVjdCBudWxsX3ByaXZhdGUgKm51bGxfcHJpdihjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpv
cHMpCiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IG51bGxfdmNwdSAqbnVsbF92Y3B1KGNvbnN0IHN0
cnVjdCB2Y3B1ICp2KQogewotICAgIHJldHVybiB2LT5zY2hlZF9wcml2OworICAgIHJldHVybiB2
LT5zY2hlZF91bml0LT5wcml2OwogfQogCiBzdGF0aWMgaW5saW5lIGJvb2wgdmNwdV9jaGVja19h
ZmZpbml0eShzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgaW50IGNwdSwKQEAgLTQyMiw3ICs0MjIs
NyBAQCBzdGF0aWMgc3BpbmxvY2tfdCAqbnVsbF9zd2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxl
ciAqbmV3X29wcywKIAogICAgIEFTU0VSVChudmMgJiYgaXNfaWRsZV92Y3B1KG52Yy0+dmNwdSkp
OwogCi0gICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3ByaXYgPSB2ZGF0YTsKKyAgICBpZGxlX3Zj
cHVbY3B1XS0+c2NoZWRfdW5pdC0+cHJpdiA9IHZkYXRhOwogCiAgICAgLyoKICAgICAgKiBXZSBh
cmUgaG9sZGluZyB0aGUgcnVucXVldWUgbG9jayBhbHJlYWR5IChpdCdzIGJlZW4gdGFrZW4gaW4K
ZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfcnQuYyBiL3hlbi9jb21tb24vc2NoZWRfcnQu
YwppbmRleCBkYTc2YTQxNDM2Li4wZjk3YzBmMmE1IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3Nj
aGVkX3J0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCkBAIC0yMzUsNyArMjM1LDcgQEAg
c3RhdGljIGlubGluZSBzdHJ1Y3QgcnRfcHJpdmF0ZSAqcnRfcHJpdihjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMpCiAKIHN0YXRpYyBpbmxpbmUgc3RydWN0IHJ0X3ZjcHUgKnJ0X3ZjcHUoY29u
c3Qgc3RydWN0IHZjcHUgKnZjcHUpCiB7Ci0gICAgcmV0dXJuIHZjcHUtPnNjaGVkX3ByaXY7Cisg
ICAgcmV0dXJuIHZjcHUtPnNjaGVkX3VuaXQtPnByaXY7CiB9CiAKIHN0YXRpYyBpbmxpbmUgc3Ry
dWN0IGxpc3RfaGVhZCAqcnRfcnVucShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMpCkBAIC03
NjAsNyArNzYwLDcgQEAgcnRfc3dpdGNoX3NjaGVkKHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMs
IHVuc2lnbmVkIGludCBjcHUsCiAgICAgICAgIGRwcmludGsoWEVOTE9HX0RFQlVHLCAiUlREUzog
dGltZXIgaW5pdGlhbGl6ZWQgb24gY3B1ICV1XG4iLCBjcHUpOwogICAgIH0KIAotICAgIGlkbGVf
dmNwdVtjcHVdLT5zY2hlZF9wcml2ID0gdmRhdGE7CisgICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVk
X3VuaXQtPnByaXYgPSB2ZGF0YTsKIAogICAgIHJldHVybiAmcHJ2LT5sb2NrOwogfQpkaWZmIC0t
Z2l0IGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jIGIveGVuL2NvbW1vbi9zY2hlZHVsZS5jCmluZGV4
IDJjMWE3MmMzYzkuLjAzOGViZjVhZTkgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWR1bGUu
YworKysgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKQEAgLTgxLDcgKzgxLDcgQEAgc3RhdGljIHNw
aW5sb2NrX3QgKgogc2NoZWRfaWRsZV9zd2l0Y2hfc2NoZWQoc3RydWN0IHNjaGVkdWxlciAqbmV3
X29wcywgdW5zaWduZWQgaW50IGNwdSwKICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnBk
YXRhLCB2b2lkICp2ZGF0YSkKIHsKLSAgICBpZGxlX3ZjcHVbY3B1XS0+c2NoZWRfcHJpdiA9IE5V
TEw7CisgICAgaWRsZV92Y3B1W2NwdV0tPnNjaGVkX3VuaXQtPnByaXYgPSBOVUxMOwogCiAgICAg
cmV0dXJuICZzY2hlZF9mcmVlX2NwdV9sb2NrOwogfQpAQCAtMzI3LDggKzMyNyw4IEBAIGludCBz
Y2hlZF9pbml0X3ZjcHUoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwcm9jZXNzb3IpCiAg
ICAgaW5pdF90aW1lcigmdi0+cG9sbF90aW1lciwgcG9sbF90aW1lcl9mbiwKICAgICAgICAgICAg
ICAgIHYsIHYtPnByb2Nlc3Nvcik7CiAKLSAgICB2LT5zY2hlZF9wcml2ID0gc2NoZWRfYWxsb2Nf
dmRhdGEoZG9tX3NjaGVkdWxlcihkKSwgdW5pdCwgZC0+c2NoZWRfcHJpdik7Ci0gICAgaWYgKCB2
LT5zY2hlZF9wcml2ID09IE5VTEwgKQorICAgIHVuaXQtPnByaXYgPSBzY2hlZF9hbGxvY192ZGF0
YShkb21fc2NoZWR1bGVyKGQpLCB1bml0LCBkLT5zY2hlZF9wcml2KTsKKyAgICBpZiAoIHVuaXQt
PnByaXYgPT0gTlVMTCApCiAgICAgewogICAgICAgICB2LT5zY2hlZF91bml0ID0gTlVMTDsKICAg
ICAgICAgeGZyZWUodW5pdCk7CkBAIC00MjMsNyArNDIzLDcgQEAgaW50IHNjaGVkX21vdmVfZG9t
YWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogICAgIHsKICAgICAgICAg
c3BpbmxvY2tfdCAqbG9jazsKIAotICAgICAgICB2Y3B1ZGF0YSA9IHYtPnNjaGVkX3ByaXY7Cisg
ICAgICAgIHZjcHVkYXRhID0gdi0+c2NoZWRfdW5pdC0+cHJpdjsKIAogICAgICAgICBtaWdyYXRl
X3RpbWVyKCZ2LT5wZXJpb2RpY190aW1lciwgbmV3X3ApOwogICAgICAgICBtaWdyYXRlX3RpbWVy
KCZ2LT5zaW5nbGVzaG90X3RpbWVyLCBuZXdfcCk7CkBAIC00NDEsNyArNDQxLDcgQEAgaW50IHNj
aGVkX21vdmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogICAg
ICAgICAgKi8KICAgICAgICAgc3Bpbl91bmxvY2tfaXJxKGxvY2spOwogCi0gICAgICAgIHYtPnNj
aGVkX3ByaXYgPSB2Y3B1X3ByaXZbdi0+dmNwdV9pZF07CisgICAgICAgIHYtPnNjaGVkX3VuaXQt
PnByaXYgPSB2Y3B1X3ByaXZbdi0+dmNwdV9pZF07CiAgICAgICAgIGlmICggIWQtPmlzX2R5aW5n
ICkKICAgICAgICAgICAgIHNjaGVkX21vdmVfaXJxcyh2KTsKIApAQCAtNDczLDcgKzQ3Myw3IEBA
IHZvaWQgc2NoZWRfZGVzdHJveV92Y3B1KHN0cnVjdCB2Y3B1ICp2KQogICAgIGlmICggdGVzdF9h
bmRfY2xlYXJfYm9vbCh2LT5pc191cmdlbnQpICkKICAgICAgICAgYXRvbWljX2RlYygmcGVyX2Nw
dShzY2hlZHVsZV9kYXRhLCB2LT5wcm9jZXNzb3IpLnVyZ2VudF9jb3VudCk7CiAgICAgc2NoZWRf
cmVtb3ZlX3VuaXQodmNwdV9zY2hlZHVsZXIodiksIHVuaXQpOwotICAgIHNjaGVkX2ZyZWVfdmRh
dGEodmNwdV9zY2hlZHVsZXIodiksIHYtPnNjaGVkX3ByaXYpOworICAgIHNjaGVkX2ZyZWVfdmRh
dGEodmNwdV9zY2hlZHVsZXIodiksIHVuaXQtPnByaXYpOwogICAgIHhmcmVlKHVuaXQpOwogICAg
IHYtPnNjaGVkX3VuaXQgPSBOVUxMOwogfQpAQCAtMTkyMiw3ICsxOTIyLDcgQEAgaW50IHNjaGVk
dWxlX2NwdV9zd2l0Y2godW5zaWduZWQgaW50IGNwdSwgc3RydWN0IGNwdXBvb2wgKmMpCiAgICAg
ICovCiAgICAgb2xkX2xvY2sgPSBwY3B1X3NjaGVkdWxlX2xvY2tfaXJxc2F2ZShjcHUsICZmbGFn
cyk7CiAKLSAgICB2cHJpdl9vbGQgPSBpZGxlLT5zY2hlZF9wcml2OworICAgIHZwcml2X29sZCA9
IGlkbGUtPnNjaGVkX3VuaXQtPnByaXY7CiAgICAgcHByaXZfb2xkID0gc2QtPnNjaGVkX3ByaXY7
CiAgICAgbmV3X2xvY2sgPSBzY2hlZF9zd2l0Y2hfc2NoZWQobmV3X29wcywgY3B1LCBwcHJpdiwg
dnByaXYpOwogCmRpZmYgLS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCBiL3hlbi9pbmNs
dWRlL3hlbi9zY2hlZC5oCmluZGV4IGQ3ZGQxODI4ODUuLmEzODliYTVlMWEgMTAwNjQ0Ci0tLSBh
L3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCkBA
IC0xNjIsNyArMTYyLDYgQEAgc3RydWN0IHZjcHUKICAgICBzdHJ1Y3QgdGltZXIgICAgIHBvbGxf
dGltZXI7ICAgIC8qIHRpbWVvdXQgZm9yIFNDSEVET1BfcG9sbCAqLwogCiAgICAgc3RydWN0IHNj
aGVkX3VuaXQgKnNjaGVkX3VuaXQ7Ci0gICAgdm9pZCAgICAgICAgICAgICpzY2hlZF9wcml2OyAg
ICAvKiBzY2hlZHVsZXItc3BlY2lmaWMgZGF0YSAqLwogCiAgICAgc3RydWN0IHZjcHVfcnVuc3Rh
dGVfaW5mbyBydW5zdGF0ZTsKICNpZm5kZWYgQ09ORklHX0NPTVBBVApAQCAtMjc3LDYgKzI3Niw3
IEBAIHN0cnVjdCB2Y3B1CiBzdHJ1Y3Qgc2NoZWRfdW5pdCB7CiAgICAgc3RydWN0IGRvbWFpbiAg
ICAgICAgICpkb21haW47CiAgICAgc3RydWN0IHZjcHUgICAgICAgICAgICp2Y3B1X2xpc3Q7Cisg
ICAgdm9pZCAgICAgICAgICAgICAgICAgICpwcml2OyAgICAgIC8qIHNjaGVkdWxlciBwcml2YXRl
IGRhdGEgKi8KICAgICBpbnQgICAgICAgICAgICAgICAgICAgIHVuaXRfaWQ7CiB9OwogCi0tIAoy
LjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpY
ZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRw
czovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

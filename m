Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id A7C7074F6A
	for <lists+xen-devel@lfdr.de>; Thu, 25 Jul 2019 15:28:58 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hqdkC-0006U8-Ny; Thu, 25 Jul 2019 13:25:16 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=dOpT=VW=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1hqdkB-0006U3-SA
 for xen-devel@lists.xenproject.org; Thu, 25 Jul 2019 13:25:16 +0000
X-Inumbo-ID: 9f793815-aedf-11e9-8980-bc764e045a96
Received: from m4a0040g.houston.softwaregrp.com (unknown [15.124.2.86])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 9f793815-aedf-11e9-8980-bc764e045a96;
 Thu, 25 Jul 2019 13:25:09 +0000 (UTC)
Received: FROM m4a0040g.houston.softwaregrp.com (15.120.17.147) BY
 m4a0040g.houston.softwaregrp.com WITH ESMTP; 
 Thu, 25 Jul 2019 13:25:08 +0000
Received: from M9W0068.microfocus.com (2002:f79:bf::f79:bf) by
 M4W0335.microfocus.com (2002:f78:1193::f78:1193) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.1591.10; Thu, 25 Jul 2019 13:19:13 +0000
Received: from NAM04-BN3-obe.outbound.protection.outlook.com (15.124.72.14) by
 M9W0068.microfocus.com (15.121.0.191) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.1591.10 via Frontend Transport; Thu, 25 Jul 2019 13:19:13 +0000
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=GHBp+iOW/fqEpkRC5wNRktGF8iJ3pKy8GWYLhjK0I6D3dGtmEKgQHwI7I+eWPejfN9GWwGGxmQcG8YEP7b5aV27sPBgIS1203YGX2QrWfsBmi6J7BDLo9ctF26+AkllJWxbdmp5YTe2emRmtVqCJq4wy/eC1lIHkSPrqVTLaSCoHVECI2Co0vJovQpDM4ZxoF6GuFpE7aivlwNrVYQgGg67ujFCJMjReYTDije9TxuCdCFv+A4XGoYhbCEiTS/mQU6j9C9O1kyeR19la2MkSCVFXjZ3AzZOVUQGtLQc+lds054d5dhjNw9EY3AnMFiasIFO24JC8vcEvYvrbbPs7Ag==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=inva99NKVdO4Wi3kgt9SIKHphAynYcJZntyoDzfovVk=;
 b=lTB/vtkYCk9KC4LmRxA4NFYgYE40MnoqAHaL89HFQAXVmgYEMmiDBLB0Dppbj5WjU+F5qPEQ0e1M9Uq2uw7UZRtfQAYXn0SwYX3m7Qp1HMfeWR8u0qrpNYVHF85m39xny0QaiQWPbQ5O+a3wbIwwGndURne5OGJgS3va54rWL1nEx1cbSz9O9pwdBAZNCDPIkzsbpoI+LyL6JAdifojjOlxZZpls8d236SAkP/fFjOeDbPxBnyVWQQ2MP9C9DUdqEbi+6yZI7jOuSg0+FtGam9RMEupT2K9IB0Xw6WBm/LWMFXj4mJo9yI8cyX1ULTXzaLNF84JV69xkLvi/VCuxgg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=pass
 smtp.mailfrom=suse.com;dmarc=pass action=none header.from=suse.com;dkim=pass
 header.d=suse.com;arc=none
Received: from BY5PR18MB3394.namprd18.prod.outlook.com (10.255.139.95) by
 BY5PR18MB3364.namprd18.prod.outlook.com (10.255.139.25) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2115.10; Thu, 25 Jul 2019 13:19:11 +0000
Received: from BY5PR18MB3394.namprd18.prod.outlook.com
 ([fe80::a4f0:4f46:c076:f74b]) by BY5PR18MB3394.namprd18.prod.outlook.com
 ([fe80::a4f0:4f46:c076:f74b%7]) with mapi id 15.20.2115.005; Thu, 25 Jul 2019
 13:19:11 +0000
From: Jan Beulich <JBeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v4 00/12] x86: AMD x2APIC support / AMD IOMMU improvements
Thread-Index: AQHVQuuLFz/xcW0bSEiljQcI5/yghg==
Date: Thu, 25 Jul 2019 13:19:11 +0000
Message-ID: <b8ae110a-f94a-4ed2-5cf9-c00ff1c0cb81@suse.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
x-clientproxiedby: LNXP265CA0060.GBRP265.PROD.OUTLOOK.COM
 (2603:10a6:600:5d::24) To BY5PR18MB3394.namprd18.prod.outlook.com
 (2603:10b6:a03:194::31)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=JBeulich@suse.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [87.234.252.170]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 5b79b058-6b58-479f-fa30-08d71102addc
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(49563074)(7193020);
 SRVR:BY5PR18MB3364; 
x-ms-traffictypediagnostic: BY5PR18MB3364:
x-microsoft-antispam-prvs: <BY5PR18MB3364B72D4E284C4A794BC44EB3C10@BY5PR18MB3364.namprd18.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:6790;
x-forefront-prvs: 0109D382B0
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(4636009)(396003)(376002)(366004)(136003)(346002)(39860400002)(199004)(189003)(99936001)(52116002)(26005)(486006)(3846002)(478600001)(66066001)(476003)(4326008)(256004)(4744005)(6116002)(2616005)(186003)(54906003)(5024004)(81156014)(81166006)(14444005)(8676002)(71190400001)(99286004)(316002)(31686004)(86362001)(6486002)(386003)(66476007)(66446008)(53936002)(64756008)(66556008)(6436002)(6506007)(5640700003)(2351001)(2501003)(305945005)(5660300002)(102836004)(14454004)(6512007)(25786009)(80792005)(6916009)(66946007)(36756003)(2906002)(71200400001)(7736002)(68736007)(31696002)(66576008)(8936002);
 DIR:OUT; SFP:1102; SCL:1; SRVR:BY5PR18MB3364;
 H:BY5PR18MB3394.namprd18.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: suse.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: bIFiR1lyIEDgw/5KvMw4+H3is7UJhMruH16uczODaaSevo28kMvEm4rG7wthnkz3dftHPabZ3qSy16XKRjaE5r+AA0MxeWAKj90XJ5QHxvV+ve6nLgOKCg2pvkCBUX2UMlj9N5KswsjZDA0cSmAtakTp9ClqXf8u+swycFyGUpjdUncAuElKhlvVWzGcnx81WaiZeZ0QQSdGQNkt1o3lQ8aZQqBnadEauAfFZXDcpj2cEm/2RVIdI/Qu0+ivLdDvUY+1b+gznxYVio3pdayekUd4+zMqYNKDSbfH3ZABAZ3GdJtchL+Wu2jIq2uThwsmA5J27lFfYXdyNY6MY/noZi4f9VbCTJ1KQgbnO5pe5gZEz53Cd13d55LNQW8qLCrgLWywyO0vgzwheIq8Ktjl+Dg+q7rSlyKF2MHnLGxtdU4=
Content-Type: multipart/mixed;
 boundary="_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_"
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-Network-Message-Id: 5b79b058-6b58-479f-fa30-08d71102addc
X-MS-Exchange-CrossTenant-originalarrivaltime: 25 Jul 2019 13:19:11.1055 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 856b813c-16e5-49a5-85ec-6f081e13b527
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: JBeulich@suse.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BY5PR18MB3364
X-OriginatorOrg: suse.com
Subject: [Xen-devel] [PATCH v4 00/12] x86: AMD x2APIC support / AMD IOMMU
 improvements
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 Brian Woods <brian.woods@amd.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; charset="utf-8"
Content-ID: <E6D40719E5B1B644864F35810B0D6263@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

RGVzcGl0ZSB0aGUgdGl0bGUgdGhpcyBpcyBhY3R1YWxseSBhbGwgQU1EIElPTU1VIHNpZGUgd29y
azsgYWxsIHg4Ng0Kc2lkZSBhZGp1c3RtZW50cyBoYXZlIGFscmVhZHkgYmVlbiBjYXJyaWVkIG91
dC4NCg0KVGhlIGZpbmFsIGZldyBwYXRjaGVzIGFyZW4ndCByZWFsbHkgeDJBUElDIHJlbGF0ZWQs
IGJ1dCB3ZXJlIGZvdW5kDQpoZWxwZnVsIGluIHRoZSBjb3Vyc2Ugb2YgdGhlIHJlLXdvcmsgZG9u
ZSBmb3IgdGhpcyB2ZXJzaW9uLg0KDQpTZWUgaW5kaXZpZHVhbCBwYXRjaGVzIGZvciBjaGFuZ2Vz
IGZyb20gdjMuDQoNCjAxOiB1c2UgYml0IGZpZWxkIGZvciBleHRlbmRlZCBmZWF0dXJlIHJlZ2lz
dGVyDQowMjogdXNlIGJpdCBmaWVsZCBmb3IgY29udHJvbCByZWdpc3Rlcg0KMDM6IHVzZSBiaXQg
ZmllbGQgZm9yIElSVEUNCjA0OiBwYXNzIElPTU1VIHRvIHtnZXQsZnJlZSx1cGRhdGV9X2ludHJl
bWFwX2VudHJ5KCkNCjA1OiBpbnRyb2R1Y2UgMTI4LWJpdCBJUlRFIG5vbi1ndWVzdC1BUElDIElS
VEUgZm9ybWF0DQowNjogc3BsaXQgYW1kX2lvbW11X2luaXRfb25lKCkNCjA3OiBhbGxvdyBlbmFi
bGluZyB3aXRoIElSUSBub3QgeWV0IHNldCB1cA0KMDg6IGFkanVzdCBzZXR1cCBvZiBpbnRlcm5h
bCBpbnRlcnJ1cHQgZm9yIHgyQVBJQyBtb2RlDQowOTogZW5hYmxlIHgyQVBJQyBtb2RlIHdoZW4g
YXZhaWxhYmxlDQoxMDogY29ycmVjdCBJUlRFIHVwZGF0aW5nDQoxMTogZG9uJ3QgbmVlZGxlc3Ns
eSBsb2cgaGVhZGVycyB3aGVuIGR1bXBpbmcgSVJUcw0KMTI6IG1pc2NlbGxhbmVvdXMgRFRFIGhh
bmRsaW5nIGFkanVzdG1lbnRzDQoNCkZ1bGwgc2V0IG9mIHBhdGNoZXMgb25jZSBhZ2FpbiBhdHRh
Y2hlZCBoZXJlIGR1ZSB0byBzdGlsbCB1bnJlc29sdmVkDQplbWFpbCBpc3N1ZXMgb3ZlciBoZXJl
Lg0KDQpKYW4NCg0K

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="01-AMD-IOMMU-bitfield-ext-feat.patch"
Content-Description: 01-AMD-IOMMU-bitfield-ext-feat.patch
Content-Disposition: attachment;
	filename="01-AMD-IOMMU-bitfield-ext-feat.patch"; size=14818;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <1371F2746D776944802DF72E42E6209B@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiB1c2UgYml0IGZpZWxkIGZvciBleHRlbmRlZCBmZWF0dXJlIHJlZ2lzdGVyCgpU
aGlzIGFsc28gdGFrZXMgY2FyZSBvZiBzZXZlcmFsIG9mIHRoZSBzaGlmdCB2YWx1ZXMgd3Jvbmds
eSBoYXZpbmcgYmVlbgpzcGVjaWZpZWQgYXMgaGV4IHJhdGhlciB0aGFuIGRlYy4KClRha2UgdGhl
IG9wcG9ydHVuaXR5IGFuZAotIHJlcGxhY2UgYSByZWFkbCgpIHBhaXIgYnkgYSBzaW5nbGUgcmVh
ZHEoKSwKLSBhZGQgZnVydGhlciBmaWVsZHMuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8
amJldWxpY2hAc3VzZS5jb20+CkFja2VkLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVy
M0BjaXRyaXguY29tPgotLS0KdjQ6IERyb3Agc3RyYXkvbGVmdG92ZXIgI3VuZGVmLgp2MzogQW5v
dGhlciBhdHRlbXB0IGF0IGRlcml2aW5nIG1hc2tzIGZyb20gYml0ZmllbGRzLCBob3BlZnVsbHkg
YmV0dGVyCiAgICBsaWtlZCBieSBjbGFuZyAobWluZSB3YXMgZmluZSBldmVuIHdpdGggdGhlIHYy
IHZhcmlhbnQpLgp2MjogQ29ycmVjdCBzYXRzX3N1cCBwb3NpdGlvbiBhbmQgbmFtZS4gUmUtYmFz
ZSBvdmVyIG5ldyBlYXJsaWVyIHBhdGNoLgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2RldGVjdC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9kZXRlY3QuYwpAQCAtNjAsNDkgKzYwLDc2IEBAIHN0YXRpYyBpbnQgX19pbml0IGdldF9pb21t
dV9jYXBhYmlsaXRpZXMKIAogdm9pZCBfX2luaXQgZ2V0X2lvbW11X2ZlYXR1cmVzKHN0cnVjdCBh
bWRfaW9tbXUgKmlvbW11KQogewotICAgIHUzMiBsb3csIGhpZ2g7Ci0gICAgaW50IGkgPSAwIDsK
ICAgICBjb25zdCBzdHJ1Y3QgYW1kX2lvbW11ICpmaXJzdDsKLSAgICBzdGF0aWMgY29uc3QgY2hh
ciAqX19pbml0ZGF0YSBmZWF0dXJlX3N0cltdID0gewotICAgICAgICAiLSBQcmVmZXRjaCBQYWdl
cyBDb21tYW5kIiwgCi0gICAgICAgICItIFBlcmlwaGVyYWwgUGFnZSBTZXJ2aWNlIFJlcXVlc3Qi
LCAKLSAgICAgICAgIi0gWDJBUElDIFN1cHBvcnRlZCIsIAotICAgICAgICAiLSBOWCBiaXQgU3Vw
cG9ydGVkIiwgCi0gICAgICAgICItIEd1ZXN0IFRyYW5zbGF0aW9uIiwgCi0gICAgICAgICItIFJl
c2VydmVkIGJpdCBbNV0iLAotICAgICAgICAiLSBJbnZhbGlkYXRlIEFsbCBDb21tYW5kIiwgCi0g
ICAgICAgICItIEd1ZXN0IEFQSUMgc3VwcG9ydGVkIiwgCi0gICAgICAgICItIEhhcmR3YXJlIEVy
cm9yIFJlZ2lzdGVycyIsIAotICAgICAgICAiLSBQZXJmb3JtYW5jZSBDb3VudGVycyIsIAotICAg
ICAgICBOVUxMCi0gICAgfTsKLQogICAgIEFTU0VSVCggaW9tbXUtPm1taW9fYmFzZSApOwogCiAg
ICAgaWYgKCAhaW9tbXVfaGFzX2NhcChpb21tdSwgUENJX0NBUF9FRlJTVVBfU0hJRlQpICkKICAg
ICB7Ci0gICAgICAgIGlvbW11LT5mZWF0dXJlcyA9IDA7CisgICAgICAgIGlvbW11LT5mZWF0dXJl
cy5yYXcgPSAwOwogICAgICAgICByZXR1cm47CiAgICAgfQogCi0gICAgbG93ID0gcmVhZGwoaW9t
bXUtPm1taW9fYmFzZSArIElPTU1VX0VYVF9GRUFUVVJFX01NSU9fT0ZGU0VUKTsKLSAgICBoaWdo
ID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0VYVF9GRUFUVVJFX01NSU9fT0ZGU0VU
ICsgNCk7Ci0KLSAgICBpb21tdS0+ZmVhdHVyZXMgPSAoKHU2NCloaWdoIDw8IDMyKSB8IGxvdzsK
KyAgICBpb21tdS0+ZmVhdHVyZXMucmF3ID0KKyAgICAgICAgcmVhZHEoaW9tbXUtPm1taW9fYmFz
ZSArIElPTU1VX0VYVF9GRUFUVVJFX01NSU9fT0ZGU0VUKTsKIAogICAgIC8qIERvbid0IGxvZyB0
aGUgc2FtZSBzZXQgb2YgZmVhdHVyZXMgb3ZlciBhbmQgb3Zlci4gKi8KICAgICBmaXJzdCA9IGxp
c3RfZmlyc3RfZW50cnkoJmFtZF9pb21tdV9oZWFkLCBzdHJ1Y3QgYW1kX2lvbW11LCBsaXN0KTsK
LSAgICBpZiAoIGlvbW11ICE9IGZpcnN0ICYmIGlvbW11LT5mZWF0dXJlcyA9PSBmaXJzdC0+ZmVh
dHVyZXMgKQorICAgIGlmICggaW9tbXUgIT0gZmlyc3QgJiYgaW9tbXUtPmZlYXR1cmVzLnJhdyA9
PSBmaXJzdC0+ZmVhdHVyZXMucmF3ICkKICAgICAgICAgcmV0dXJuOwogCiAgICAgcHJpbnRrKCJB
TUQtVmk6IElPTU1VIEV4dGVuZGVkIEZlYXR1cmVzOlxuIik7CiAKLSAgICB3aGlsZSAoIGZlYXR1
cmVfc3RyW2ldICkKKyNkZWZpbmUgRkVBVChmbGQsIHN0cikgZG8geyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKKyAgICBpZiAoIC0tKCh1bmlvbiBhbWRfaW9tbXVfZXh0X2Zl
YXR1cmVzKXt9KS5mbGRzLmZsZCA+IDEgKSAgIFwKKyAgICAgICAgcHJpbnRrKCAiLSAiIHN0ciAi
OiAlI3hcbiIsIGlvbW11LT5mZWF0dXJlcy5mbGRzLmZsZCk7IFwKKyAgICBlbHNlIGlmICggaW9t
bXUtPmZlYXR1cmVzLmZsZHMuZmxkICkgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAg
cHJpbnRrKCAiLSAiIHN0ciAiXG4iKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
K30gd2hpbGUgKCBmYWxzZSApCisKKyAgICBGRUFUKHByZWZfc3VwLCAgICAgICAgICAgIlByZWZl
dGNoIFBhZ2VzIENvbW1hbmQiKTsKKyAgICBGRUFUKHBwcl9zdXAsICAgICAgICAgICAgIlBlcmlw
aGVyYWwgUGFnZSBTZXJ2aWNlIFJlcXVlc3QiKTsKKyAgICBGRUFUKHh0X3N1cCwgICAgICAgICAg
ICAgIngyQVBJQyIpOworICAgIEZFQVQobnhfc3VwLCAgICAgICAgICAgICAiTlggYml0Iik7Cisg
ICAgRkVBVChnYXBwaV9zdXAsICAgICAgICAgICJHdWVzdCBBUElDIFBoeXNpY2FsIFByb2Nlc3Nv
ciBJbnRlcnJ1cHQiKTsKKyAgICBGRUFUKGlhX3N1cCwgICAgICAgICAgICAgIkludmFsaWRhdGUg
QWxsIENvbW1hbmQiKTsKKyAgICBGRUFUKGdhX3N1cCwgICAgICAgICAgICAgIkd1ZXN0IEFQSUMi
KTsKKyAgICBGRUFUKGhlX3N1cCwgICAgICAgICAgICAgIkhhcmR3YXJlIEVycm9yIFJlZ2lzdGVy
cyIpOworICAgIEZFQVQocGNfc3VwLCAgICAgICAgICAgICAiUGVyZm9ybWFuY2UgQ291bnRlcnMi
KTsKKyAgICBGRUFUKGhhdHMsICAgICAgICAgICAgICAgIkhvc3QgQWRkcmVzcyBUcmFuc2xhdGlv
biBTaXplIik7CisKKyAgICBpZiAoIGlvbW11LT5mZWF0dXJlcy5mbGRzLmd0X3N1cCApCiAgICAg
ewotICAgICAgICBpZiAoIGFtZF9pb21tdV9oYXNfZmVhdHVyZShpb21tdSwgaSkgKQotICAgICAg
ICAgICAgcHJpbnRrKCAiICVzXG4iLCBmZWF0dXJlX3N0cltpXSk7Ci0gICAgICAgIGkrKzsKKyAg
ICAgICAgRkVBVChnYXRzLCAgICAgICAgICAgIkd1ZXN0IEFkZHJlc3MgVHJhbnNsYXRpb24gU2l6
ZSIpOworICAgICAgICBGRUFUKGdseF9zdXAsICAgICAgICAiR3Vlc3QgQ1IzIFJvb3QgVGFibGUg
TGV2ZWwiKTsKKyAgICAgICAgRkVBVChwYXNfbWF4LCAgICAgICAgIk1heGltdW0gUEFTSUQiKTsK
ICAgICB9CisKKyAgICBGRUFUKHNtaWZfc3VwLCAgICAgICAgICAgIlNNSSBGaWx0ZXIgUmVnaXN0
ZXIiKTsKKyAgICBGRUFUKHNtaWZfcmMsICAgICAgICAgICAgIlNNSSBGaWx0ZXIgUmVnaXN0ZXIg
Q291bnQiKTsKKyAgICBGRUFUKGdhbV9zdXAsICAgICAgICAgICAgIkd1ZXN0IFZpcnR1YWwgQVBJ
QyBNb2RlcyIpOworICAgIEZFQVQoZHVhbF9wcHJfbG9nX3N1cCwgICAiRHVhbCBQUFIgTG9nIik7
CisgICAgRkVBVChkdWFsX2V2ZW50X2xvZ19zdXAsICJEdWFsIEV2ZW50IExvZyIpOworICAgIEZF
QVQoc2F0c19zdXAsICAgICAgICAgICAiU2VjdXJlIEFUUyIpOworICAgIEZFQVQodXNfc3VwLCAg
ICAgICAgICAgICAiVXNlciAvIFN1cGVydmlzb3IgUGFnZSBQcm90ZWN0aW9uIik7CisgICAgRkVB
VChkZXZfdGJsX3NlZ19zdXAsICAgICJEZXZpY2UgVGFibGUgU2VnbWVudGF0aW9uIik7CisgICAg
RkVBVChwcHJfZWFybHlfb2Zfc3VwLCAgICJQUFIgTG9nIE92ZXJmbG93IEVhcmx5IFdhcm5pbmci
KTsKKyAgICBGRUFUKHBwcl9hdXRvX3JzcF9zdXAsICAgIlBQUiBBdXRvbWF0aWMgUmVzcG9uc2Ui
KTsKKyAgICBGRUFUKG1hcmNfc3VwLCAgICAgICAgICAgIk1lbW9yeSBBY2Nlc3MgUm91dGluZyBh
bmQgQ29udHJvbCIpOworICAgIEZFQVQoYmxrX3N0b3BfbXJrX3N1cCwgICAiQmxvY2sgU3RvcE1h
cmsgTWVzc2FnZSIpOworICAgIEZFQVQocGVyZl9vcHRfc3VwICwgICAgICAiUGVyZm9ybWFuY2Ug
T3B0aW1pemF0aW9uIik7CisgICAgRkVBVChtc2lfY2FwX21taW9fc3VwLCAgICJNU0kgQ2FwYWJp
bGl0eSBNTUlPIEFjY2VzcyIpOworICAgIEZFQVQoZ2lvX3N1cCwgICAgICAgICAgICAiR3Vlc3Qg
SS9PIFByb3RlY3Rpb24iKTsKKyAgICBGRUFUKGhhX3N1cCwgICAgICAgICAgICAgIkhvc3QgQWNj
ZXNzIik7CisgICAgRkVBVChlcGhfc3VwLCAgICAgICAgICAgICJFbmhhbmNlZCBQUFIgSGFuZGxp
bmciKTsKKyAgICBGRUFUKGF0dHJfZndfc3VwLCAgICAgICAgIkF0dHJpYnV0ZSBGb3J3YXJkIik7
CisgICAgRkVBVChoZF9zdXAsICAgICAgICAgICAgICJIb3N0IERpcnR5Iik7CisgICAgRkVBVChp
bnZfaW90bGJfdHlwZV9zdXAsICJJbnZhbGlkYXRlIElPVExCIFR5cGUiKTsKKyAgICBGRUFUKHZp
b21tdV9zdXAsICAgICAgICAgIlZpcnR1YWxpemVkIElPTU1VIik7CisgICAgRkVBVCh2bV9ndWFy
ZF9pb19zdXAsICAgICJWTUd1YXJkIEkvTyBTdXBwb3J0Iik7CisgICAgRkVBVCh2bV90YWJsZV9z
aXplLCAgICAgICJWTSBUYWJsZSBTaXplIik7CisgICAgRkVBVChnYV91cGRhdGVfZGlzX3N1cCwg
ICJHdWVzdCBBY2Nlc3MgQml0IFVwZGF0ZSBEaXNhYmxlIik7CisKKyN1bmRlZiBGRUFUCiB9CiAK
IGludCBfX2luaXQgYW1kX2lvbW11X2RldGVjdF9vbmVfYWNwaSgKLS0tIGEveGVuL2RyaXZlcnMv
cGFzc3Rocm91Z2gvYW1kL2lvbW11X2d1ZXN0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91
Z2gvYW1kL2lvbW11X2d1ZXN0LmMKQEAgLTYzOCw3ICs2MzgsNyBAQCBzdGF0aWMgdWludDY0X3Qg
aW9tbXVfbW1pb19yZWFkNjQoc3RydWN0CiAgICAgICAgIHZhbCA9IHJlZ190b191NjQoaW9tbXUt
PnJlZ19zdGF0dXMpOwogICAgICAgICBicmVhazsKICAgICBjYXNlIElPTU1VX0VYVF9GRUFUVVJF
X01NSU9fT0ZGU0VUOgotICAgICAgICB2YWwgPSByZWdfdG9fdTY0KGlvbW11LT5yZWdfZXh0X2Zl
YXR1cmUpOworICAgICAgICB2YWwgPSBpb21tdS0+cmVnX2V4dF9mZWF0dXJlLnJhdzsKICAgICAg
ICAgYnJlYWs7CiAKICAgICBkZWZhdWx0OgpAQCAtODAyLDM5ICs4MDIsMjYgQEAgaW50IGd1ZXN0
X2lvbW11X3NldF9iYXNlKHN0cnVjdCBkb21haW4gKgogLyogSW5pdGlhbGl6ZSBtbWlvIHJlYWQg
b25seSBiaXRzICovCiBzdGF0aWMgdm9pZCBndWVzdF9pb21tdV9yZWdfaW5pdChzdHJ1Y3QgZ3Vl
c3RfaW9tbXUgKmlvbW11KQogewotICAgIHVpbnQzMl90IGxvd2VyLCB1cHBlcjsKKyAgICB1bmlv
biBhbWRfaW9tbXVfZXh0X2ZlYXR1cmVzIGVmID0geworICAgICAgICAvKiBTdXBwb3J0IHByZWZl
dGNoICovCisgICAgICAgIC5mbGRzLnByZWZfc3VwID0gMSwKKyAgICAgICAgLyogU3VwcG9ydCBQ
UFIgbG9nICovCisgICAgICAgIC5mbGRzLnBwcl9zdXAgPSAxLAorICAgICAgICAvKiBTdXBwb3J0
IGd1ZXN0IHRyYW5zbGF0aW9uICovCisgICAgICAgIC5mbGRzLmd0X3N1cCA9IDEsCisgICAgICAg
IC8qIFN1cHBvcnQgaW52YWxpZGF0ZSBhbGwgY29tbWFuZCAqLworICAgICAgICAuZmxkcy5pYV9z
dXAgPSAxLAorICAgICAgICAvKiBIb3N0IHRyYW5zbGF0aW9uIHNpemUgaGFzIDYgbGV2ZWxzICov
CisgICAgICAgIC5mbGRzLmhhdHMgPSBIT1NUX0FERFJFU1NfU0laRV82X0xFVkVMLAorICAgICAg
ICAvKiBHdWVzdCB0cmFuc2xhdGlvbiBzaXplIGhhcyA2IGxldmVscyAqLworICAgICAgICAuZmxk
cy5nYXRzID0gR1VFU1RfQUREUkVTU19TSVpFXzZfTEVWRUwsCisgICAgICAgIC8qIFNpbmdsZSBs
ZXZlbCBnQ1IzICovCisgICAgICAgIC5mbGRzLmdseF9zdXAgPSBHVUVTVF9DUjNfMV9MRVZFTCwK
KyAgICAgICAgLyogOSBiaXQgUEFTSUQgKi8KKyAgICAgICAgLmZsZHMucGFzX21heCA9IFBBU01B
WF85X2JpdCwKKyAgICB9OwogCi0gICAgbG93ZXIgPSB1cHBlciA9IDA7Ci0gICAgLyogU3VwcG9y
dCBwcmVmZXRjaCAqLwotICAgIGlvbW11X3NldF9iaXQoJmxvd2VyLElPTU1VX0VYVF9GRUFUVVJF
X1BSRUZTVVBfU0hJRlQpOwotICAgIC8qIFN1cHBvcnQgUFBSIGxvZyAqLwotICAgIGlvbW11X3Nl
dF9iaXQoJmxvd2VyLElPTU1VX0VYVF9GRUFUVVJFX1BQUlNVUF9TSElGVCk7Ci0gICAgLyogU3Vw
cG9ydCBndWVzdCB0cmFuc2xhdGlvbiAqLwotICAgIGlvbW11X3NldF9iaXQoJmxvd2VyLElPTU1V
X0VYVF9GRUFUVVJFX0dUU1VQX1NISUZUKTsKLSAgICAvKiBTdXBwb3J0IGludmFsaWRhdGUgYWxs
IGNvbW1hbmQgKi8KLSAgICBpb21tdV9zZXRfYml0KCZsb3dlcixJT01NVV9FWFRfRkVBVFVSRV9J
QVNVUF9TSElGVCk7Ci0KLSAgICAvKiBIb3N0IHRyYW5zbGF0aW9uIHNpemUgaGFzIDYgbGV2ZWxz
ICovCi0gICAgc2V0X2ZpZWxkX2luX3JlZ191MzIoSE9TVF9BRERSRVNTX1NJWkVfNl9MRVZFTCwg
bG93ZXIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfRVhUX0ZFQVRVUkVfSEFUU19N
QVNLLAotICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0VYVF9GRUFUVVJFX0hBVFNfU0hJ
RlQsCi0gICAgICAgICAgICAgICAgICAgICAgICAgJmxvd2VyKTsKLSAgICAvKiBHdWVzdCB0cmFu
c2xhdGlvbiBzaXplIGhhcyA2IGxldmVscyAqLwotICAgIHNldF9maWVsZF9pbl9yZWdfdTMyKEdV
RVNUX0FERFJFU1NfU0laRV82X0xFVkVMLCBsb3dlciwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICBJT01NVV9FWFRfRkVBVFVSRV9HQVRTX01BU0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfRVhUX0ZFQVRVUkVfR0FUU19TSElGVCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAm
bG93ZXIpOwotICAgIC8qIFNpbmdsZSBsZXZlbCBnQ1IzICovCi0gICAgc2V0X2ZpZWxkX2luX3Jl
Z191MzIoR1VFU1RfQ1IzXzFfTEVWRUwsIGxvd2VyLAotICAgICAgICAgICAgICAgICAgICAgICAg
IElPTU1VX0VYVF9GRUFUVVJFX0dMWFNVUF9NQVNLLAotICAgICAgICAgICAgICAgICAgICAgICAg
IElPTU1VX0VYVF9GRUFUVVJFX0dMWFNVUF9TSElGVCwgJmxvd2VyKTsKLSAgICAvKiA5IGJpdCBQ
QVNJRCAqLwotICAgIHNldF9maWVsZF9pbl9yZWdfdTMyKFBBU01BWF85X2JpdCwgdXBwZXIsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfRVhUX0ZFQVRVUkVfUEFTTUFYX01BU0ssCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfRVhUX0ZFQVRVUkVfUEFTTUFYX1NISUZULCAm
dXBwZXIpOwotCi0gICAgaW9tbXUtPnJlZ19leHRfZmVhdHVyZS5sbyA9IGxvd2VyOwotICAgIGlv
bW11LT5yZWdfZXh0X2ZlYXR1cmUuaGkgPSB1cHBlcjsKKyAgICBpb21tdS0+cmVnX2V4dF9mZWF0
dXJlID0gZWY7CiB9CiAKIHN0YXRpYyBpbnQgZ3Vlc3RfaW9tbXVfbW1pb19yYW5nZShzdHJ1Y3Qg
dmNwdSAqdiwgdW5zaWduZWQgbG9uZyBhZGRyKQotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfaW5pdC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9pbml0LmMKQEAgLTg4Miw3ICs4ODIsNyBAQCBzdGF0aWMgdm9pZCBlbmFibGVfaW9tbXUoc3Ry
dWN0IGFtZF9pb21tCiAgICAgcmVnaXN0ZXJfaW9tbXVfZXZlbnRfbG9nX2luX21taW9fc3BhY2Uo
aW9tbXUpOwogICAgIHJlZ2lzdGVyX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShpb21tdSk7CiAKLSAg
ICBpZiAoIGFtZF9pb21tdV9oYXNfZmVhdHVyZShpb21tdSwgSU9NTVVfRVhUX0ZFQVRVUkVfUFBS
U1VQX1NISUZUKSApCisgICAgaWYgKCBpb21tdS0+ZmVhdHVyZXMuZmxkcy5wcHJfc3VwICkKICAg
ICAgICAgcmVnaXN0ZXJfaW9tbXVfcHByX2xvZ19pbl9tbWlvX3NwYWNlKGlvbW11KTsKIAogICAg
IGRlc2MgPSBpcnFfdG9fZGVzYyhpb21tdS0+bXNpLmlycSk7CkBAIC04OTYsMTUgKzg5NiwxNSBA
QCBzdGF0aWMgdm9pZCBlbmFibGVfaW9tbXUoc3RydWN0IGFtZF9pb21tCiAgICAgc2V0X2lvbW11
X2NvbW1hbmRfYnVmZmVyX2NvbnRyb2woaW9tbXUsIElPTU1VX0NPTlRST0xfRU5BQkxFRCk7CiAg
ICAgc2V0X2lvbW11X2V2ZW50X2xvZ19jb250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJM
RUQpOwogCi0gICAgaWYgKCBhbWRfaW9tbXVfaGFzX2ZlYXR1cmUoaW9tbXUsIElPTU1VX0VYVF9G
RUFUVVJFX1BQUlNVUF9TSElGVCkgKQorICAgIGlmICggaW9tbXUtPmZlYXR1cmVzLmZsZHMucHBy
X3N1cCApCiAgICAgICAgIHNldF9pb21tdV9wcHJfbG9nX2NvbnRyb2woaW9tbXUsIElPTU1VX0NP
TlRST0xfRU5BQkxFRCk7CiAKLSAgICBpZiAoIGFtZF9pb21tdV9oYXNfZmVhdHVyZShpb21tdSwg
SU9NTVVfRVhUX0ZFQVRVUkVfR1RTVVBfU0hJRlQpICkKKyAgICBpZiAoIGlvbW11LT5mZWF0dXJl
cy5mbGRzLmd0X3N1cCApCiAgICAgICAgIHNldF9pb21tdV9ndWVzdF90cmFuc2xhdGlvbl9jb250
cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJMRUQpOwogCiAgICAgc2V0X2lvbW11X3RyYW5z
bGF0aW9uX2NvbnRyb2woaW9tbXUsIElPTU1VX0NPTlRST0xfRU5BQkxFRCk7CiAKLSAgICBpZiAo
IGFtZF9pb21tdV9oYXNfZmVhdHVyZShpb21tdSwgSU9NTVVfRVhUX0ZFQVRVUkVfSUFTVVBfU0hJ
RlQpICkKKyAgICBpZiAoIGlvbW11LT5mZWF0dXJlcy5mbGRzLmlhX3N1cCApCiAgICAgICAgIGFt
ZF9pb21tdV9mbHVzaF9hbGxfY2FjaGVzKGlvbW11KTsKIAogICAgIGlvbW11LT5lbmFibGVkID0g
MTsKQEAgLTkyNywxMCArOTI3LDEwIEBAIHN0YXRpYyB2b2lkIGRpc2FibGVfaW9tbXUoc3RydWN0
IGFtZF9pb20KICAgICBzZXRfaW9tbXVfY29tbWFuZF9idWZmZXJfY29udHJvbChpb21tdSwgSU9N
TVVfQ09OVFJPTF9ESVNBQkxFRCk7CiAgICAgc2V0X2lvbW11X2V2ZW50X2xvZ19jb250cm9sKGlv
bW11LCBJT01NVV9DT05UUk9MX0RJU0FCTEVEKTsKIAotICAgIGlmICggYW1kX2lvbW11X2hhc19m
ZWF0dXJlKGlvbW11LCBJT01NVV9FWFRfRkVBVFVSRV9QUFJTVVBfU0hJRlQpICkKKyAgICBpZiAo
IGlvbW11LT5mZWF0dXJlcy5mbGRzLnBwcl9zdXAgKQogICAgICAgICBzZXRfaW9tbXVfcHByX2xv
Z19jb250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0RJU0FCTEVEKTsKIAotICAgIGlmICggYW1k
X2lvbW11X2hhc19mZWF0dXJlKGlvbW11LCBJT01NVV9FWFRfRkVBVFVSRV9HVFNVUF9TSElGVCkg
KQorICAgIGlmICggaW9tbXUtPmZlYXR1cmVzLmZsZHMuZ3Rfc3VwICkKICAgICAgICAgc2V0X2lv
bW11X2d1ZXN0X3RyYW5zbGF0aW9uX2NvbnRyb2woaW9tbXUsIElPTU1VX0NPTlRST0xfRElTQUJM
RUQpOwogCiAgICAgc2V0X2lvbW11X3RyYW5zbGF0aW9uX2NvbnRyb2woaW9tbXUsIElPTU1VX0NP
TlRST0xfRElTQUJMRUQpOwpAQCAtMTAyNiw3ICsxMDI2LDcgQEAgc3RhdGljIGludCBfX2luaXQg
YW1kX2lvbW11X2luaXRfb25lKHN0cgogCiAgICAgZ2V0X2lvbW11X2ZlYXR1cmVzKGlvbW11KTsK
IAotICAgIGlmICggaW9tbXUtPmZlYXR1cmVzICkKKyAgICBpZiAoIGlvbW11LT5mZWF0dXJlcy5y
YXcgKQogICAgICAgICBpb21tdXYyX2VuYWJsZWQgPSAxOwogCiAgICAgaWYgKCBhbGxvY2F0ZV9j
bWRfYnVmZmVyKGlvbW11KSA9PSBOVUxMICkKQEAgLTEwMzUsOSArMTAzNSw4IEBAIHN0YXRpYyBp
bnQgX19pbml0IGFtZF9pb21tdV9pbml0X29uZShzdHIKICAgICBpZiAoIGFsbG9jYXRlX2V2ZW50
X2xvZyhpb21tdSkgPT0gTlVMTCApCiAgICAgICAgIGdvdG8gZXJyb3Jfb3V0OwogCi0gICAgaWYg
KCBhbWRfaW9tbXVfaGFzX2ZlYXR1cmUoaW9tbXUsIElPTU1VX0VYVF9GRUFUVVJFX1BQUlNVUF9T
SElGVCkgKQotICAgICAgICBpZiAoIGFsbG9jYXRlX3Bwcl9sb2coaW9tbXUpID09IE5VTEwgKQot
ICAgICAgICAgICAgZ290byBlcnJvcl9vdXQ7CisgICAgaWYgKCBpb21tdS0+ZmVhdHVyZXMuZmxk
cy5wcHJfc3VwICYmICFhbGxvY2F0ZV9wcHJfbG9nKGlvbW11KSApCisgICAgICAgIGdvdG8gZXJy
b3Jfb3V0OwogCiAgICAgaWYgKCAhc2V0X2lvbW11X2ludGVycnVwdF9oYW5kbGVyKGlvbW11KSAp
CiAgICAgICAgIGdvdG8gZXJyb3Jfb3V0OwpAQCAtMTM5Myw3ICsxMzkyLDcgQEAgdm9pZCBhbWRf
aW9tbXVfcmVzdW1lKHZvaWQpCiAgICAgfQogCiAgICAgLyogZmx1c2ggYWxsIGNhY2hlIGVudHJp
ZXMgYWZ0ZXIgaW9tbXUgcmUtZW5hYmxlZCAqLwotICAgIGlmICggIWFtZF9pb21tdV9oYXNfZmVh
dHVyZShpb21tdSwgSU9NTVVfRVhUX0ZFQVRVUkVfSUFTVVBfU0hJRlQpICkKKyAgICBpZiAoICFp
b21tdS0+ZmVhdHVyZXMuZmxkcy5pYV9zdXAgKQogICAgIHsKICAgICAgICAgaW52YWxpZGF0ZV9h
bGxfZGV2aWNlcygpOwogICAgICAgICBpbnZhbGlkYXRlX2FsbF9kb21haW5fcGFnZXMoKTsKLS0t
IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9hbWQtaW9tbXUuaAorKysgYi94ZW4vaW5jbHVkZS9hc20t
eDg2L2FtZC1pb21tdS5oCkBAIC04Myw3ICs4Myw3IEBAIHN0cnVjdCBhbWRfaW9tbXUgewogICAg
IGlvbW11X2NhcF90IGNhcDsKIAogICAgIHU4IGh0X2ZsYWdzOwotICAgIHU2NCBmZWF0dXJlczsK
KyAgICB1bmlvbiBhbWRfaW9tbXVfZXh0X2ZlYXR1cmVzIGZlYXR1cmVzOwogCiAgICAgdm9pZCAq
bW1pb19iYXNlOwogICAgIHVuc2lnbmVkIGxvbmcgbW1pb19iYXNlX3BoeXM7CkBAIC0xNzUsNyAr
MTc1LDcgQEAgc3RydWN0IGd1ZXN0X2lvbW11IHsKICAgICAvKiBNTUlPIHJlZ3MgKi8KICAgICBz
dHJ1Y3QgbW1pb19yZWcgICAgICAgICByZWdfY3RybDsgICAgICAgICAgICAgIC8qIE1NSU8gb2Zm
c2V0IDAwMThoICovCiAgICAgc3RydWN0IG1taW9fcmVnICAgICAgICAgcmVnX3N0YXR1czsgICAg
ICAgICAgICAvKiBNTUlPIG9mZnNldCAyMDIwaCAqLwotICAgIHN0cnVjdCBtbWlvX3JlZyAgICAg
ICAgIHJlZ19leHRfZmVhdHVyZTsgICAgICAgLyogTU1JTyBvZmZzZXQgMDAzMGggKi8KKyAgICB1
bmlvbiBhbWRfaW9tbXVfZXh0X2ZlYXR1cmVzIHJlZ19leHRfZmVhdHVyZTsgIC8qIE1NSU8gb2Zm
c2V0IDAwMzBoICovCiAKICAgICAvKiBndWVzdCBpbnRlcnJ1cHQgc2V0dGluZ3MgKi8KICAgICBz
dHJ1Y3QgZ3Vlc3RfaW9tbXVfbXNpICBtc2k7Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZt
L3N2bS9hbWQtaW9tbXUtZGVmcy5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9h
bWQtaW9tbXUtZGVmcy5oCkBAIC0zNDYsMjYgKzM0Niw1NyBAQCBzdHJ1Y3QgYW1kX2lvbW11X2R0
ZSB7CiAjZGVmaW5lIElPTU1VX0VYQ0xVU0lPTl9MSU1JVF9ISUdIX01BU0sJCTB4RkZGRkZGRkYK
ICNkZWZpbmUgSU9NTVVfRVhDTFVTSU9OX0xJTUlUX0hJR0hfU0hJRlQJMAogCi0vKiBFeHRlbmRl
ZCBGZWF0dXJlIFJlZ2lzdGVyKi8KKy8qIEV4dGVuZGVkIEZlYXR1cmUgUmVnaXN0ZXIgKi8KICNk
ZWZpbmUgSU9NTVVfRVhUX0ZFQVRVUkVfTU1JT19PRkZTRVQgICAgICAgICAgICAgICAgICAgMHgz
MAotI2RlZmluZSBJT01NVV9FWFRfRkVBVFVSRV9QUkVGU1VQX1NISUZUICAgICAgICAgICAgICAg
ICAweDAKLSNkZWZpbmUgSU9NTVVfRVhUX0ZFQVRVUkVfUFBSU1VQX1NISUZUICAgICAgICAgICAg
ICAgICAgMHgxCi0jZGVmaW5lIElPTU1VX0VYVF9GRUFUVVJFX1hUU1VQX1NISUZUICAgICAgICAg
ICAgICAgICAgIDB4MgotI2RlZmluZSBJT01NVV9FWFRfRkVBVFVSRV9OWFNVUF9TSElGVCAgICAg
ICAgICAgICAgICAgICAweDMKLSNkZWZpbmUgSU9NTVVfRVhUX0ZFQVRVUkVfR1RTVVBfU0hJRlQg
ICAgICAgICAgICAgICAgICAgMHg0Ci0jZGVmaW5lIElPTU1VX0VYVF9GRUFUVVJFX0lBU1VQX1NI
SUZUICAgICAgICAgICAgICAgICAgIDB4NgotI2RlZmluZSBJT01NVV9FWFRfRkVBVFVSRV9HQVNV
UF9TSElGVCAgICAgICAgICAgICAgICAgICAweDcKLSNkZWZpbmUgSU9NTVVfRVhUX0ZFQVRVUkVf
SEVTVVBfU0hJRlQgICAgICAgICAgICAgICAgICAgMHg4Ci0jZGVmaW5lIElPTU1VX0VYVF9GRUFU
VVJFX1BDU1VQX1NISUZUICAgICAgICAgICAgICAgICAgIDB4OQotI2RlZmluZSBJT01NVV9FWFRf
RkVBVFVSRV9IQVRTX1NISUZUICAgICAgICAgICAgICAgICAgICAweDEwCi0jZGVmaW5lIElPTU1V
X0VYVF9GRUFUVVJFX0hBVFNfTUFTSyAgICAgICAgICAgICAgICAgICAgIDB4MDAwMDBDMDAKLSNk
ZWZpbmUgSU9NTVVfRVhUX0ZFQVRVUkVfR0FUU19TSElGVCAgICAgICAgICAgICAgICAgICAgMHgx
MgotI2RlZmluZSBJT01NVV9FWFRfRkVBVFVSRV9HQVRTX01BU0sgICAgICAgICAgICAgICAgICAg
ICAweDAwMDAzMDAwCi0jZGVmaW5lIElPTU1VX0VYVF9GRUFUVVJFX0dMWFNVUF9TSElGVCAgICAg
ICAgICAgICAgICAgIDB4MTQKLSNkZWZpbmUgSU9NTVVfRVhUX0ZFQVRVUkVfR0xYU1VQX01BU0sg
ICAgICAgICAgICAgICAgICAgMHgwMDAwQzAwMAogCi0jZGVmaW5lIElPTU1VX0VYVF9GRUFUVVJF
X1BBU01BWF9TSElGVCAgICAgICAgICAgICAgICAgIDB4MAotI2RlZmluZSBJT01NVV9FWFRfRkVB
VFVSRV9QQVNNQVhfTUFTSyAgICAgICAgICAgICAgICAgICAweDAwMDAwMDFGCit1bmlvbiBhbWRf
aW9tbXVfZXh0X2ZlYXR1cmVzIHsKKyAgICB1aW50NjRfdCByYXc7CisgICAgc3RydWN0IHsKKyAg
ICAgICAgdW5zaWduZWQgaW50IHByZWZfc3VwOjE7CisgICAgICAgIHVuc2lnbmVkIGludCBwcHJf
c3VwOjE7CisgICAgICAgIHVuc2lnbmVkIGludCB4dF9zdXA6MTsKKyAgICAgICAgdW5zaWduZWQg
aW50IG54X3N1cDoxOworICAgICAgICB1bnNpZ25lZCBpbnQgZ3Rfc3VwOjE7CisgICAgICAgIHVu
c2lnbmVkIGludCBnYXBwaV9zdXA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IGlhX3N1cDoxOwor
ICAgICAgICB1bnNpZ25lZCBpbnQgZ2Ffc3VwOjE7CisgICAgICAgIHVuc2lnbmVkIGludCBoZV9z
dXA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IHBjX3N1cDoxOworICAgICAgICB1bnNpZ25lZCBp
bnQgaGF0czoyOworICAgICAgICB1bnNpZ25lZCBpbnQgZ2F0czoyOworICAgICAgICB1bnNpZ25l
ZCBpbnQgZ2x4X3N1cDoyOworICAgICAgICB1bnNpZ25lZCBpbnQgc21pZl9zdXA6MjsKKyAgICAg
ICAgdW5zaWduZWQgaW50IHNtaWZfcmM6MzsKKyAgICAgICAgdW5zaWduZWQgaW50IGdhbV9zdXA6
MzsKKyAgICAgICAgdW5zaWduZWQgaW50IGR1YWxfcHByX2xvZ19zdXA6MjsKKyAgICAgICAgdW5z
aWduZWQgaW50IDoyOworICAgICAgICB1bnNpZ25lZCBpbnQgZHVhbF9ldmVudF9sb2dfc3VwOjI7
CisgICAgICAgIHVuc2lnbmVkIGludCA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IHNhdHNfc3Vw
OjE7CisgICAgICAgIHVuc2lnbmVkIGludCBwYXNfbWF4OjU7CisgICAgICAgIHVuc2lnbmVkIGlu
dCB1c19zdXA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IGRldl90Ymxfc2VnX3N1cDoyOworICAg
ICAgICB1bnNpZ25lZCBpbnQgcHByX2Vhcmx5X29mX3N1cDoxOworICAgICAgICB1bnNpZ25lZCBp
bnQgcHByX2F1dG9fcnNwX3N1cDoxOworICAgICAgICB1bnNpZ25lZCBpbnQgbWFyY19zdXA6MjsK
KyAgICAgICAgdW5zaWduZWQgaW50IGJsa19zdG9wX21ya19zdXA6MTsKKyAgICAgICAgdW5zaWdu
ZWQgaW50IHBlcmZfb3B0X3N1cDoxOworICAgICAgICB1bnNpZ25lZCBpbnQgbXNpX2NhcF9tbWlv
X3N1cDoxOworICAgICAgICB1bnNpZ25lZCBpbnQgOjE7CisgICAgICAgIHVuc2lnbmVkIGludCBn
aW9fc3VwOjE7CisgICAgICAgIHVuc2lnbmVkIGludCBoYV9zdXA6MTsKKyAgICAgICAgdW5zaWdu
ZWQgaW50IGVwaF9zdXA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IGF0dHJfZndfc3VwOjE7Cisg
ICAgICAgIHVuc2lnbmVkIGludCBoZF9zdXA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IDoxOwor
ICAgICAgICB1bnNpZ25lZCBpbnQgaW52X2lvdGxiX3R5cGVfc3VwOjE7CisgICAgICAgIHVuc2ln
bmVkIGludCB2aW9tbXVfc3VwOjE7CisgICAgICAgIHVuc2lnbmVkIGludCB2bV9ndWFyZF9pb19z
dXA6MTsKKyAgICAgICAgdW5zaWduZWQgaW50IHZtX3RhYmxlX3NpemU6NDsKKyAgICAgICAgdW5z
aWduZWQgaW50IGdhX3VwZGF0ZV9kaXNfc3VwOjE7CisgICAgICAgIHVuc2lnbmVkIGludCA6MjsK
KyAgICB9IGZsZHM7Cit9OwogCiAvKiBTdGF0dXMgUmVnaXN0ZXIqLwogI2RlZmluZSBJT01NVV9T
VEFUVVNfTU1JT19PRkZTRVQJCTB4MjAyMAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9z
dm0vYW1kLWlvbW11LXByb3RvLmgKKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2Ft
ZC1pb21tdS1wcm90by5oCkBAIC0yMTgsMTMgKzIxOCw2IEBAIHN0YXRpYyBpbmxpbmUgaW50IGlv
bW11X2hhc19jYXAoc3RydWN0IGEKICAgICByZXR1cm4gISEoaW9tbXUtPmNhcC5oZWFkZXIgJiAo
MXUgPDwgYml0KSk7CiB9CiAKLXN0YXRpYyBpbmxpbmUgaW50IGFtZF9pb21tdV9oYXNfZmVhdHVy
ZShzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdWludDMyX3QgYml0KQotewotICAgIGlmICggIWlv
bW11X2hhc19jYXAoaW9tbXUsIFBDSV9DQVBfRUZSU1VQX1NISUZUKSApCi0gICAgICAgIHJldHVy
biAwOwotICAgIHJldHVybiAhIShpb21tdS0+ZmVhdHVyZXMgJiAoMVUgPDwgYml0KSk7Ci19Ci0K
IC8qIGFjY2VzcyB0YWlsIG9yIGhlYWQgcG9pbnRlciBvZiByaW5nIGJ1ZmZlciAqLwogc3RhdGlj
IGlubGluZSB1aW50MzJfdCBpb21tdV9nZXRfcmJfcG9pbnRlcih1aW50MzJfdCByZWcpCiB7Cg==

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="02-AMD-IOMMU-bitfield-control.patch"
Content-Description: 02-AMD-IOMMU-bitfield-control.patch
Content-Disposition: attachment;
	filename="02-AMD-IOMMU-bitfield-control.patch"; size=19474;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <55EB738C2ADF164EA39896D8DBE8D8C7@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiB1c2UgYml0IGZpZWxkIGZvciBjb250cm9sIHJlZ2lzdGVyCgpBbHNvIGludHJv
ZHVjZSBhIGZpZWxkIGluIHN0cnVjdCBhbWRfaW9tbXUgY2FjaGluZyB0aGUgbW9zdCByZWNlbnRs
eQp3cml0dGVuIGNvbnRyb2wgcmVnaXN0ZXIuIEFsbCB3cml0ZXMgc2hvdWxkIG5vdyBoYXBwZW4g
ZXhjbHVzaXZlbHkgZnJvbQp0aGF0IGNhY2hlZCB2YWx1ZSwgc3VjaCB0aGF0IGl0IGlzIGd1YXJh
bnRlZWQgdG8gYmUgdXAgdG8gZGF0ZS4KClRha2UgdGhlIG9wcG9ydHVuaXR5IGFuZCBhZGQgZnVy
dGhlciBmaWVsZHMuIEFsc28gY29udmVydCBhIGZldyBib29sZWFuCmZ1bmN0aW9uIHBhcmFtZXRl
cnMgdG8gYm9vbCwgc3VjaCB0aGF0IHVzZSBvZiAhISBjYW4gYmUgYXZvaWRlZC4KCkJlY2F1c2Ug
b2YgdGhlcmUgbm93IGJlaW5nIGRlZmluaXRpb25zIGJleW9uZCBiaXQgMzEsIHdyaXRlbCgpIGFs
c28gZ2V0cwpyZXBsYWNlZCBieSB3cml0ZXEoKSB3aGVuIHVwZGF0aW5nIGhhcmR3YXJlLgoKU2ln
bmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpBY2tlZC1ieTogQW5k
cmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEJyaWFuIFdv
b2RzIDxicmlhbi53b29kc0BhbWQuY29tPgotLS0KdjM6IFN3aXRjaCBib29sZWFuIGJpdGZpZWxk
cyB0byBib29sLgp2MjogQWRkIGRvbWFpbl9pZF9wbmUgZmllbGQuIE1lbnRpb24gd3JpdGVsKCkg
LT4gd3JpdGVxKCkgY2hhbmdlLgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lv
bW11X2d1ZXN0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2d1ZXN0
LmMKQEAgLTMxNyw3ICszMTcsNyBAQCBzdGF0aWMgaW50IGRvX2ludmFsaWRhdGVfaW90bGJfcGFn
ZXMoc3RyCiAKIHN0YXRpYyBpbnQgZG9fY29tcGxldGlvbl93YWl0KHN0cnVjdCBkb21haW4gKmQs
IGNtZF9lbnRyeV90ICpjbWQpCiB7Ci0gICAgYm9vbF90IGNvbV93YWl0X2ludF9lbiwgY29tX3dh
aXRfaW50LCBpLCBzOworICAgIGJvb2wgY29tX3dhaXRfaW50LCBpLCBzOwogICAgIHN0cnVjdCBn
dWVzdF9pb21tdSAqaW9tbXU7CiAgICAgdW5zaWduZWQgbG9uZyBnZm47CiAgICAgcDJtX3R5cGVf
dCBwMm10OwpAQCAtMzU0LDEyICszNTQsMTAgQEAgc3RhdGljIGludCBkb19jb21wbGV0aW9uX3dh
aXQoc3RydWN0IGRvbQogICAgICAgICB1bm1hcF9kb21haW5fcGFnZSh2YWRkcik7CiAgICAgfQog
Ci0gICAgY29tX3dhaXRfaW50X2VuID0gaW9tbXVfZ2V0X2JpdChpb21tdS0+cmVnX2N0cmwubG8s
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9DT05UUk9MX0NPTVBf
V0FJVF9JTlRfU0hJRlQpOwogICAgIGNvbV93YWl0X2ludCA9IGlvbW11X2dldF9iaXQoaW9tbXUt
PnJlZ19zdGF0dXMubG8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9T
VEFUVVNfQ09NUF9XQUlUX0lOVF9TSElGVCk7CiAKLSAgICBpZiAoIGNvbV93YWl0X2ludF9lbiAm
JiBjb21fd2FpdF9pbnQgKQorICAgIGlmICggaW9tbXUtPnJlZ19jdHJsLmNvbV93YWl0X2ludF9l
biAmJiBjb21fd2FpdF9pbnQgKQogICAgICAgICBndWVzdF9pb21tdV9kZWxpdmVyX21zaShkKTsK
IAogICAgIHJldHVybiAwOwpAQCAtNTIxLDQwICs1MTksMTcgQEAgc3RhdGljIHZvaWQgZ3Vlc3Rf
aW9tbXVfcHJvY2Vzc19jb21tYW5kKAogICAgIHJldHVybjsKIH0KIAotc3RhdGljIGludCBndWVz
dF9pb21tdV93cml0ZV9jdHJsKHN0cnVjdCBndWVzdF9pb21tdSAqaW9tbXUsIHVpbnQ2NF90IG5l
d2N0cmwpCitzdGF0aWMgaW50IGd1ZXN0X2lvbW11X3dyaXRlX2N0cmwoc3RydWN0IGd1ZXN0X2lv
bW11ICppb21tdSwgdWludDY0X3QgdmFsKQogewotICAgIGJvb2xfdCBjbWRfZW4sIGV2ZW50X2Vu
LCBpb21tdV9lbiwgcHByX2VuLCBwcHJfbG9nX2VuOwotICAgIGJvb2xfdCBjbWRfZW5fb2xkLCBl
dmVudF9lbl9vbGQsIGlvbW11X2VuX29sZDsKLSAgICBib29sX3QgY21kX3J1bjsKLQotICAgIGlv
bW11X2VuID0gaW9tbXVfZ2V0X2JpdChuZXdjdHJsLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBJT01NVV9DT05UUk9MX1RSQU5TTEFUSU9OX0VOQUJMRV9TSElGVCk7Ci0gICAgaW9tbXVf
ZW5fb2xkID0gaW9tbXVfZ2V0X2JpdChpb21tdS0+cmVnX2N0cmwubG8sCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBJT01NVV9DT05UUk9MX1RSQU5TTEFUSU9OX0VOQUJMRV9TSElG
VCk7Ci0KLSAgICBjbWRfZW4gPSBpb21tdV9nZXRfYml0KG5ld2N0cmwsCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9DT05UUk9MX0NPTU1BTkRfQlVGRkVSX0VOQUJMRV9TSElGVCk7
Ci0gICAgY21kX2VuX29sZCA9IGlvbW11X2dldF9iaXQoaW9tbXUtPnJlZ19jdHJsLmxvLAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0NPTlRST0xfQ09NTUFORF9CVUZGRVJf
RU5BQkxFX1NISUZUKTsKLSAgICBjbWRfcnVuID0gaW9tbXVfZ2V0X2JpdChpb21tdS0+cmVnX3N0
YXR1cy5sbywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9TVEFUVVNfQ01EX0JV
RkZFUl9SVU5fU0hJRlQpOwotICAgIGV2ZW50X2VuID0gaW9tbXVfZ2V0X2JpdChuZXdjdHJsLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19FTkFC
TEVfU0hJRlQpOwotICAgIGV2ZW50X2VuX29sZCA9IGlvbW11X2dldF9iaXQoaW9tbXUtPnJlZ19j
dHJsLmxvLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9F
VkVOVF9MT0dfRU5BQkxFX1NISUZUKTsKLQotICAgIHBwcl9lbiA9IGlvbW11X2dldF9iaXQobmV3
Y3RybCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0NPTlRST0xfUFBSX0VOQUJM
RV9TSElGVCk7Ci0gICAgcHByX2xvZ19lbiA9IGlvbW11X2dldF9iaXQobmV3Y3RybCwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9DT05UUk9MX1BQUl9MT0dfRU5BQkxFX1NI
SUZUKTsKKyAgICB1bmlvbiBhbWRfaW9tbXVfY29udHJvbCBuZXdjdHJsID0geyAucmF3ID0gdmFs
IH07CiAKLSAgICBpZiAoIGlvbW11X2VuICkKKyAgICBpZiAoIG5ld2N0cmwuaW9tbXVfZW4gKQog
ICAgIHsKICAgICAgICAgZ3Vlc3RfaW9tbXVfZW5hYmxlKGlvbW11KTsKICAgICAgICAgZ3Vlc3Rf
aW9tbXVfZW5hYmxlX2Rldl90YWJsZShpb21tdSk7CiAgICAgfQogCi0gICAgaWYgKCBpb21tdV9l
biAmJiBjbWRfZW4gKQorICAgIGlmICggbmV3Y3RybC5pb21tdV9lbiAmJiBuZXdjdHJsLmNtZF9i
dWZfZW4gKQogICAgIHsKICAgICAgICAgZ3Vlc3RfaW9tbXVfZW5hYmxlX3JpbmdfYnVmZmVyKGlv
bW11LCAmaW9tbXUtPmNtZF9idWZmZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzaXplb2YoY21kX2VudHJ5X3QpKTsKQEAgLTU2Miw3ICs1MzcsNyBAQCBzdGF0aWMg
aW50IGd1ZXN0X2lvbW11X3dyaXRlX2N0cmwoc3RydWN0CiAgICAgICAgIHRhc2tsZXRfc2NoZWR1
bGUoJmlvbW11LT5jbWRfYnVmZmVyX3Rhc2tsZXQpOwogICAgIH0KIAotICAgIGlmICggaW9tbXVf
ZW4gJiYgZXZlbnRfZW4gKQorICAgIGlmICggbmV3Y3RybC5pb21tdV9lbiAmJiBuZXdjdHJsLmV2
ZW50X2xvZ19lbiApCiAgICAgewogICAgICAgICBndWVzdF9pb21tdV9lbmFibGVfcmluZ19idWZm
ZXIoaW9tbXUsICZpb21tdS0+ZXZlbnRfbG9nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc2l6ZW9mKGV2ZW50X2VudHJ5X3QpKTsKQEAgLTU3MCw3ICs1NDUsNyBAQCBz
dGF0aWMgaW50IGd1ZXN0X2lvbW11X3dyaXRlX2N0cmwoc3RydWN0CiAgICAgICAgIGd1ZXN0X2lv
bW11X2NsZWFyX3N0YXR1cyhpb21tdSwgSU9NTVVfU1RBVFVTX0VWRU5UX09WRVJGTE9XX1NISUZU
KTsKICAgICB9CiAKLSAgICBpZiAoIGlvbW11X2VuICYmIHBwcl9lbiAmJiBwcHJfbG9nX2VuICkK
KyAgICBpZiAoIG5ld2N0cmwuaW9tbXVfZW4gJiYgbmV3Y3RybC5wcHJfZW4gJiYgbmV3Y3RybC5w
cHJfbG9nX2VuICkKICAgICB7CiAgICAgICAgIGd1ZXN0X2lvbW11X2VuYWJsZV9yaW5nX2J1ZmZl
cihpb21tdSwgJmlvbW11LT5wcHJfbG9nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc2l6ZW9mKHBwcl9lbnRyeV90KSk7CkBAIC01NzgsMTkgKzU1MywyMSBAQCBzdGF0
aWMgaW50IGd1ZXN0X2lvbW11X3dyaXRlX2N0cmwoc3RydWN0CiAgICAgICAgIGd1ZXN0X2lvbW11
X2NsZWFyX3N0YXR1cyhpb21tdSwgSU9NTVVfU1RBVFVTX1BQUl9MT0dfT1ZFUkZMT1dfU0hJRlQp
OwogICAgIH0KIAotICAgIGlmICggaW9tbXVfZW4gJiYgY21kX2VuX29sZCAmJiAhY21kX2VuICkK
KyAgICBpZiAoIG5ld2N0cmwuaW9tbXVfZW4gJiYgaW9tbXUtPnJlZ19jdHJsLmNtZF9idWZfZW4g
JiYKKyAgICAgICAgICFuZXdjdHJsLmNtZF9idWZfZW4gKQogICAgIHsKICAgICAgICAgLyogRGlz
YWJsZSBpb21tdSBjb21tYW5kIHByb2Nlc3NpbmcgKi8KICAgICAgICAgdGFza2xldF9raWxsKCZp
b21tdS0+Y21kX2J1ZmZlcl90YXNrbGV0KTsKICAgICB9CiAKLSAgICBpZiAoIGV2ZW50X2VuX29s
ZCAmJiAhZXZlbnRfZW4gKQorICAgIGlmICggaW9tbXUtPnJlZ19jdHJsLmV2ZW50X2xvZ19lbiAm
JiAhbmV3Y3RybC5ldmVudF9sb2dfZW4gKQogICAgICAgICBndWVzdF9pb21tdV9jbGVhcl9zdGF0
dXMoaW9tbXUsIElPTU1VX1NUQVRVU19FVkVOVF9MT0dfUlVOX1NISUZUKTsKIAotICAgIGlmICgg
aW9tbXVfZW5fb2xkICYmICFpb21tdV9lbiApCisgICAgaWYgKCBpb21tdS0+cmVnX2N0cmwuaW9t
bXVfZW4gJiYgIW5ld2N0cmwuaW9tbXVfZW4gKQogICAgICAgICBndWVzdF9pb21tdV9kaXNhYmxl
KGlvbW11KTsKIAotICAgIHU2NF90b19yZWcoJmlvbW11LT5yZWdfY3RybCwgbmV3Y3RybCk7Cisg
ICAgaW9tbXUtPnJlZ19jdHJsID0gbmV3Y3RybDsKKwogICAgIHJldHVybiAwOwogfQogCkBAIC02
MzIsNyArNjA5LDcgQEAgc3RhdGljIHVpbnQ2NF90IGlvbW11X21taW9fcmVhZDY0KHN0cnVjdAog
ICAgICAgICB2YWwgPSByZWdfdG9fdTY0KGlvbW11LT5wcHJfbG9nLnJlZ190YWlsKTsKICAgICAg
ICAgYnJlYWs7CiAgICAgY2FzZSBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUOgotICAgICAgICB2
YWwgPSByZWdfdG9fdTY0KGlvbW11LT5yZWdfY3RybCk7CisgICAgICAgIHZhbCA9IGlvbW11LT5y
ZWdfY3RybC5yYXc7CiAgICAgICAgIGJyZWFrOwogICAgIGNhc2UgSU9NTVVfU1RBVFVTX01NSU9f
T0ZGU0VUOgogICAgICAgICB2YWwgPSByZWdfdG9fdTY0KGlvbW11LT5yZWdfc3RhdHVzKTsKLS0t
IGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYworKysgYi94ZW4vZHJp
dmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCkBAIC00MSw3ICs0MSw3IEBAIExJU1Rf
SEVBRF9SRUFEX01PU1RMWShhbWRfaW9tbXVfaGVhZCk7CiBzdHJ1Y3QgdGFibGVfc3RydWN0IGRl
dmljZV90YWJsZTsKIGJvb2xfdCBpb21tdXYyX2VuYWJsZWQ7CiAKLXN0YXRpYyBpbnQgaW9tbXVf
aGFzX2h0X2ZsYWcoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsIHU4IG1hc2spCitzdGF0aWMgYm9v
bCBpb21tdV9oYXNfaHRfZmxhZyhzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdTggbWFzaykKIHsK
ICAgICByZXR1cm4gaW9tbXUtPmh0X2ZsYWdzICYgbWFzazsKIH0KQEAgLTY5LDMxICs2OSwxOCBA
QCBzdGF0aWMgdm9pZCBfX2luaXQgdW5tYXBfaW9tbXVfbW1pb19yZWdpCiAKIHN0YXRpYyB2b2lk
IHNldF9pb21tdV9odF9mbGFncyhzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKIHsKLSAgICB1MzIg
ZW50cnk7Ci0gICAgZW50cnkgPSByZWFkbChpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJP
TF9NTUlPX09GRlNFVCk7Ci0KICAgICAvKiBTZXR1cCBIVCBmbGFncyAqLwogICAgIGlmICggaW9t
bXVfaGFzX2NhcChpb21tdSwgUENJX0NBUF9IVF9UVU5ORUxfU0hJRlQpICkKLSAgICAgICAgaW9t
bXVfaGFzX2h0X2ZsYWcoaW9tbXUsIEFDUElfSVZIRF9UVF9FTkFCTEUpID8KLSAgICAgICAgICAg
IGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0hUX1RVTk5FTF9UUkFOU0xBVElP
Tl9TSElGVCkgOgotICAgICAgICAgICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09O
VFJPTF9IVF9UVU5ORUxfVFJBTlNMQVRJT05fU0hJRlQpOwotCi0gICAgaW9tbXVfaGFzX2h0X2Zs
YWcoaW9tbXUsIEFDUElfSVZIRF9SRVNfUEFTU19QVykgPwotICAgICAgICBpb21tdV9zZXRfYml0
KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9SRVNQX1BBU1NfUE9TVEVEX1dSSVRFX1NISUZUKToKLSAg
ICAgICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9SRVNQX1BBU1NfUE9T
VEVEX1dSSVRFX1NISUZUKTsKLQotICAgIGlvbW11X2hhc19odF9mbGFnKGlvbW11LCBBQ1BJX0lW
SERfSVNPQykgPwotICAgICAgICBpb21tdV9zZXRfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9J
U09DSFJPTk9VU19TSElGVCk6Ci0gICAgICAgIGlvbW11X2NsZWFyX2JpdCgmZW50cnksIElPTU1V
X0NPTlRST0xfSVNPQ0hST05PVVNfU0hJRlQpOwotCi0gICAgaW9tbXVfaGFzX2h0X2ZsYWcoaW9t
bXUsIEFDUElfSVZIRF9QQVNTX1BXKSA/Ci0gICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJ
T01NVV9DT05UUk9MX1BBU1NfUE9TVEVEX1dSSVRFX1NISUZUKToKLSAgICAgICAgaW9tbXVfY2xl
YXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9QQVNTX1BPU1RFRF9XUklURV9TSElGVCk7Cisg
ICAgICAgIGlvbW11LT5jdHJsLmh0X3R1bl9lbiA9IGlvbW11X2hhc19odF9mbGFnKGlvbW11LCBB
Q1BJX0lWSERfVFRfRU5BQkxFKTsKKworICAgIGlvbW11LT5jdHJsLnBhc3NfcHcgICAgID0gaW9t
bXVfaGFzX2h0X2ZsYWcoaW9tbXUsIEFDUElfSVZIRF9QQVNTX1BXKTsKKyAgICBpb21tdS0+Y3Ry
bC5yZXNfcGFzc19wdyA9IGlvbW11X2hhc19odF9mbGFnKGlvbW11LCBBQ1BJX0lWSERfUkVTX1BB
U1NfUFcpOworICAgIGlvbW11LT5jdHJsLmlzb2MgICAgICAgID0gaW9tbXVfaGFzX2h0X2ZsYWco
aW9tbXUsIEFDUElfSVZIRF9JU09DKTsKIAogICAgIC8qIEZvcmNlIGNvaGVyZW50ICovCi0gICAg
aW9tbXVfc2V0X2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfQ09IRVJFTlRfU0hJRlQpOworICAg
IGlvbW11LT5jdHJsLmNvaGVyZW50ID0gdHJ1ZTsKIAotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUt
Pm1taW9fYmFzZStJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKKyAgICB3cml0ZXEoaW9tbXUt
PmN0cmwucmF3LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7
CiB9CiAKIHN0YXRpYyB2b2lkIHJlZ2lzdGVyX2lvbW11X2Rldl90YWJsZV9pbl9tbWlvX3NwYWNl
KHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11KQpAQCAtMjA1LDU1ICsxOTIsMzcgQEAgc3RhdGljIHZv
aWQgcmVnaXN0ZXJfaW9tbXVfcHByX2xvZ19pbl9tbQogCiAKIHN0YXRpYyB2b2lkIHNldF9pb21t
dV90cmFuc2xhdGlvbl9jb250cm9sKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBlbmFibGUpCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGVuYWJsZSkKIHsKLSAg
ICB1MzIgZW50cnk7CisgICAgaW9tbXUtPmN0cmwuaW9tbXVfZW4gPSBlbmFibGU7CiAKLSAgICBl
bnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VU
KTsKLQotICAgIGVuYWJsZSA/Ci0gICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9D
T05UUk9MX1RSQU5TTEFUSU9OX0VOQUJMRV9TSElGVCkgOgotICAgICAgICBpb21tdV9jbGVhcl9i
aXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX1RSQU5TTEFUSU9OX0VOQUJMRV9TSElGVCk7Ci0KLSAg
ICB3cml0ZWwoZW50cnksIGlvbW11LT5tbWlvX2Jhc2UrSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNF
VCk7CisgICAgd3JpdGVxKGlvbW11LT5jdHJsLnJhdywgaW9tbXUtPm1taW9fYmFzZSArIElPTU1V
X0NPTlRST0xfTU1JT19PRkZTRVQpOwogfQogCiBzdGF0aWMgdm9pZCBzZXRfaW9tbXVfZ3Vlc3Rf
dHJhbnNsYXRpb25fY29udHJvbChzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBlbmFibGUpCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGVuYWJsZSkKIHsK
LSAgICB1MzIgZW50cnk7Ci0KLSAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJ
T01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKKyAgICBpb21tdS0+Y3RybC5ndF9lbiA9IGVuYWJs
ZTsKIAotICAgIGVuYWJsZSA/Ci0gICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9D
T05UUk9MX0dUX0VOQUJMRV9TSElGVCkgOgotICAgICAgICBpb21tdV9jbGVhcl9iaXQoJmVudHJ5
LCBJT01NVV9DT05UUk9MX0dUX0VOQUJMRV9TSElGVCk7Ci0KLSAgICB3cml0ZWwoZW50cnksIGlv
bW11LT5tbWlvX2Jhc2UrSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7CisgICAgd3JpdGVxKGlv
bW11LT5jdHJsLnJhdywgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZT
RVQpOwogCiAgICAgaWYgKCBlbmFibGUgKQogICAgICAgICBBTURfSU9NTVVfREVCVUcoIkd1ZXN0
IFRyYW5zbGF0aW9uIEVuYWJsZWQuXG4iKTsKIH0KIAogc3RhdGljIHZvaWQgc2V0X2lvbW11X2Nv
bW1hbmRfYnVmZmVyX2NvbnRyb2woc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGVuYWJsZSkKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgZW5hYmxlKQog
ewotICAgIHUzMiBlbnRyeTsKLQotICAgIGVudHJ5ID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSAr
IElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOwotCi0gICAgLypyZXNldCBoZWFkIGFuZCB0YWls
IHBvaW50ZXIgbWFudWFsbHkgYmVmb3JlIGVuYWJsZW1lbnQgKi8KKyAgICAvKiBSZXNldCBoZWFk
IGFuZCB0YWlsIHBvaW50ZXIgbWFudWFsbHkgYmVmb3JlIGVuYWJsZW1lbnQgKi8KICAgICBpZiAo
IGVuYWJsZSApCiAgICAgewogICAgICAgICB3cml0ZXEoMCwgaW9tbXUtPm1taW9fYmFzZSArIElP
TU1VX0NNRF9CVUZGRVJfSEVBRF9PRkZTRVQpOwogICAgICAgICB3cml0ZXEoMCwgaW9tbXUtPm1t
aW9fYmFzZSArIElPTU1VX0NNRF9CVUZGRVJfVEFJTF9PRkZTRVQpOwotCi0gICAgICAgIGlvbW11
X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0NPTU1BTkRfQlVGRkVSX0VOQUJMRV9TSElG
VCk7CiAgICAgfQotICAgIGVsc2UKLSAgICAgICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9N
TVVfQ09OVFJPTF9DT01NQU5EX0JVRkZFUl9FTkFCTEVfU0hJRlQpOwogCi0gICAgd3JpdGVsKGVu
dHJ5LCBpb21tdS0+bW1pb19iYXNlK0lPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOworICAgIGlv
bW11LT5jdHJsLmNtZF9idWZfZW4gPSBlbmFibGU7CisKKyAgICB3cml0ZXEoaW9tbXUtPmN0cmwu
cmF3LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7CiB9CiAK
IHN0YXRpYyB2b2lkIHJlZ2lzdGVyX2lvbW11X2V4Y2x1c2lvbl9yYW5nZShzdHJ1Y3QgYW1kX2lv
bW11ICppb21tdSkKQEAgLTI5NSw1NyArMjY0LDM4IEBAIHN0YXRpYyB2b2lkIHJlZ2lzdGVyX2lv
bW11X2V4Y2x1c2lvbl9yYW4KIH0KIAogc3RhdGljIHZvaWQgc2V0X2lvbW11X2V2ZW50X2xvZ19j
b250cm9sKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAotICAgICAgICAgICAgaW50IGVuYWJsZSkK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGVuYWJsZSkKIHsK
LSAgICB1MzIgZW50cnk7Ci0KLSAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJ
T01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKLQotICAgIC8qcmVzZXQgaGVhZCBhbmQgdGFpbCBw
b2ludGVyIG1hbnVhbGx5IGJlZm9yZSBlbmFibGVtZW50ICovCisgICAgLyogUmVzZXQgaGVhZCBh
bmQgdGFpbCBwb2ludGVyIG1hbnVhbGx5IGJlZm9yZSBlbmFibGVtZW50ICovCiAgICAgaWYgKCBl
bmFibGUgKQogICAgIHsKICAgICAgICAgd3JpdGVxKDAsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01N
VV9FVkVOVF9MT0dfSEVBRF9PRkZTRVQpOwogICAgICAgICB3cml0ZXEoMCwgaW9tbXUtPm1taW9f
YmFzZSArIElPTU1VX0VWRU5UX0xPR19UQUlMX09GRlNFVCk7Ci0KLSAgICAgICAgaW9tbXVfc2V0
X2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfRVZFTlRfTE9HX0lOVF9TSElGVCk7Ci0gICAgICAg
IGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19FTkFCTEVfU0hJ
RlQpOwotICAgIH0KLSAgICBlbHNlCi0gICAgewotICAgICAgICBpb21tdV9jbGVhcl9iaXQoJmVu
dHJ5LCBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19JTlRfU0hJRlQpOwotICAgICAgICBpb21tdV9j
bGVhcl9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19FTkFCTEVfU0hJRlQpOwog
ICAgIH0KIAotICAgIGlvbW11X2NsZWFyX2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfQ09NUF9X
QUlUX0lOVF9TSElGVCk7CisgICAgaW9tbXUtPmN0cmwuZXZlbnRfaW50X2VuID0gZW5hYmxlOwor
ICAgIGlvbW11LT5jdHJsLmV2ZW50X2xvZ19lbiA9IGVuYWJsZTsKKyAgICBpb21tdS0+Y3RybC5j
b21fd2FpdF9pbnRfZW4gPSBmYWxzZTsKIAotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9f
YmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOworICAgIHdyaXRlcShpb21tdS0+Y3Ry
bC5yYXcsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKIH0K
IAogc3RhdGljIHZvaWQgc2V0X2lvbW11X3Bwcl9sb2dfY29udHJvbChzdHJ1Y3QgYW1kX2lvbW11
ICppb21tdSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGVuYWJs
ZSkKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBlbmFibGUpCiB7
Ci0gICAgdTMyIGVudHJ5OwotCi0gICAgZW50cnkgPSByZWFkbChpb21tdS0+bW1pb19iYXNlICsg
SU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7Ci0KLSAgICAvKnJlc2V0IGhlYWQgYW5kIHRhaWwg
cG9pbnRlciBtYW51YWxseSBiZWZvcmUgZW5hYmxlbWVudCAqLworICAgIC8qIFJlc2V0IGhlYWQg
YW5kIHRhaWwgcG9pbnRlciBtYW51YWxseSBiZWZvcmUgZW5hYmxlbWVudCAqLwogICAgIGlmICgg
ZW5hYmxlICkKICAgICB7CiAgICAgICAgIHdyaXRlcSgwLCBpb21tdS0+bW1pb19iYXNlICsgSU9N
TVVfUFBSX0xPR19IRUFEX09GRlNFVCk7CiAgICAgICAgIHdyaXRlcSgwLCBpb21tdS0+bW1pb19i
YXNlICsgSU9NTVVfUFBSX0xPR19UQUlMX09GRlNFVCk7Ci0KLSAgICAgICAgaW9tbXVfc2V0X2Jp
dCgmZW50cnksIElPTU1VX0NPTlRST0xfUFBSX0VOQUJMRV9TSElGVCk7Ci0gICAgICAgIGlvbW11
X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX1BQUl9MT0dfSU5UX1NISUZUKTsKLSAgICAg
ICAgaW9tbXVfc2V0X2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfUFBSX0xPR19FTkFCTEVfU0hJ
RlQpOwotICAgIH0KLSAgICBlbHNlCi0gICAgewotICAgICAgICBpb21tdV9jbGVhcl9iaXQoJmVu
dHJ5LCBJT01NVV9DT05UUk9MX1BQUl9FTkFCTEVfU0hJRlQpOwotICAgICAgICBpb21tdV9jbGVh
cl9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX1BQUl9MT0dfSU5UX1NISUZUKTsKLSAgICAgICAg
aW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9QUFJfTE9HX0VOQUJMRV9TSElG
VCk7CiAgICAgfQogCi0gICAgd3JpdGVsKGVudHJ5LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVf
Q09OVFJPTF9NTUlPX09GRlNFVCk7CisgICAgaW9tbXUtPmN0cmwucHByX2VuID0gZW5hYmxlOwor
ICAgIGlvbW11LT5jdHJsLnBwcl9pbnRfZW4gPSBlbmFibGU7CisgICAgaW9tbXUtPmN0cmwucHBy
X2xvZ19lbiA9IGVuYWJsZTsKKworICAgIHdyaXRlcShpb21tdS0+Y3RybC5yYXcsIGlvbW11LT5t
bWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKKwogICAgIGlmICggZW5hYmxl
ICkKICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJQUFIgTG9nIEVuYWJsZWQuXG4iKTsKIH0KQEAg
LTM5OCw3ICszNDgsNyBAQCBzdGF0aWMgaW50IGlvbW11X3JlYWRfbG9nKHN0cnVjdCBhbWRfaW9t
CiAvKiByZXNldCBldmVudCBsb2cgb3IgcHByIGxvZyB3aGVuIG92ZXJmbG93ICovCiBzdGF0aWMg
dm9pZCBpb21tdV9yZXNldF9sb2coc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHJpbmdfYnVmZmVyICpsb2csCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdm9pZCAoKmN0cmxfZnVuYykoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUs
IGludCkpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAoKmN0cmxfZnVuYykoc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsIGJvb2wpKQogewogICAgIHUzMiBlbnRyeTsKICAgICBpbnQg
bG9nX3J1biwgcnVuX2JpdDsKQEAgLTYxNSwxMSArNTY1LDExIEBAIHN0YXRpYyB2b2lkIGlvbW11
X2NoZWNrX2V2ZW50X2xvZyhzdHJ1Y3QKICAgICAgICAgaW9tbXVfcmVzZXRfbG9nKGlvbW11LCAm
aW9tbXUtPmV2ZW50X2xvZywgc2V0X2lvbW11X2V2ZW50X2xvZ19jb250cm9sKTsKICAgICBlbHNl
CiAgICAgewotICAgICAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9D
T05UUk9MX01NSU9fT0ZGU0VUKTsKLSAgICAgICAgaWYgKCAhKGVudHJ5ICYgSU9NTVVfQ09OVFJP
TF9FVkVOVF9MT0dfSU5UX01BU0spICkKKyAgICAgICAgaWYgKCAhaW9tbXUtPmN0cmwuZXZlbnRf
aW50X2VuICkKICAgICAgICAgewotICAgICAgICAgICAgZW50cnkgfD0gSU9NTVVfQ09OVFJPTF9F
VkVOVF9MT0dfSU5UX01BU0s7Ci0gICAgICAgICAgICB3cml0ZWwoZW50cnksIGlvbW11LT5tbWlv
X2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKKyAgICAgICAgICAgIGlvbW11LT5j
dHJsLmV2ZW50X2ludF9lbiA9IHRydWU7CisgICAgICAgICAgICB3cml0ZXEoaW9tbXUtPmN0cmwu
cmF3LAorICAgICAgICAgICAgICAgICAgIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9M
X01NSU9fT0ZGU0VUKTsKICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgKiBSZS1zY2hlZHVs
ZSB0aGUgdGFza2xldCB0byBoYW5kbGUgZXZlbnR1YWwgbG9nIGVudHJpZXMgYWRkZWQKICAgICAg
ICAgICAgICAqIGJldHdlZW4gcmVhZGluZyB0aGUgbG9nIGFib3ZlIGFuZCByZS1lbmFibGluZyB0
aGUgaW50ZXJydXB0LgpAQCAtNzA0LDExICs2NTQsMTEgQEAgc3RhdGljIHZvaWQgaW9tbXVfY2hl
Y2tfcHByX2xvZyhzdHJ1Y3QgYQogICAgICAgICBpb21tdV9yZXNldF9sb2coaW9tbXUsICZpb21t
dS0+cHByX2xvZywgc2V0X2lvbW11X3Bwcl9sb2dfY29udHJvbCk7CiAgICAgZWxzZQogICAgIHsK
LSAgICAgICAgZW50cnkgPSByZWFkbChpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJPTF9N
TUlPX09GRlNFVCk7Ci0gICAgICAgIGlmICggIShlbnRyeSAmIElPTU1VX0NPTlRST0xfUFBSX0xP
R19JTlRfTUFTSykgKQorICAgICAgICBpZiAoICFpb21tdS0+Y3RybC5wcHJfaW50X2VuICkKICAg
ICAgICAgewotICAgICAgICAgICAgZW50cnkgfD0gSU9NTVVfQ09OVFJPTF9QUFJfTE9HX0lOVF9N
QVNLOwotICAgICAgICAgICAgd3JpdGVsKGVudHJ5LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVf
Q09OVFJPTF9NTUlPX09GRlNFVCk7CisgICAgICAgICAgICBpb21tdS0+Y3RybC5wcHJfaW50X2Vu
ID0gdHJ1ZTsKKyAgICAgICAgICAgIHdyaXRlcShpb21tdS0+Y3RybC5yYXcsCisgICAgICAgICAg
ICAgICAgICAgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOwog
ICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAqIFJlLXNjaGVkdWxlIHRoZSB0YXNrbGV0IHRv
IGhhbmRsZSBldmVudHVhbCBsb2cgZW50cmllcyBhZGRlZAogICAgICAgICAgICAgICogYmV0d2Vl
biByZWFkaW5nIHRoZSBsb2cgYWJvdmUgYW5kIHJlLWVuYWJsaW5nIHRoZSBpbnRlcnJ1cHQuCkBA
IC03NTQsNyArNzA0LDYgQEAgc3RhdGljIHZvaWQgZG9fYW1kX2lvbW11X2lycSh1bnNpZ25lZCBs
bwogc3RhdGljIHZvaWQgaW9tbXVfaW50ZXJydXB0X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGV2
X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNwdV91c2Vy
X3JlZ3MgKnJlZ3MpCiB7Ci0gICAgdTMyIGVudHJ5OwogICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7
CiAgICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUgPSBkZXZfaWQ7CiAKQEAgLTc2NCwxMCArNzEz
LDkgQEAgc3RhdGljIHZvaWQgaW9tbXVfaW50ZXJydXB0X2hhbmRsZXIoaW50CiAgICAgICogU2ls
ZW5jZSBpbnRlcnJ1cHRzIGZyb20gYm90aCBldmVudCBhbmQgUFBSIGJ5IGNsZWFyaW5nIHRoZQog
ICAgICAqIGVuYWJsZSBsb2dnaW5nIGJpdHMgaW4gdGhlIGNvbnRyb2wgcmVnaXN0ZXIKICAgICAg
Ki8KLSAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01N
SU9fT0ZGU0VUKTsKLSAgICBpb21tdV9jbGVhcl9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0VW
RU5UX0xPR19JTlRfU0hJRlQpOwotICAgIGlvbW11X2NsZWFyX2JpdCgmZW50cnksIElPTU1VX0NP
TlRST0xfUFBSX0xPR19JTlRfU0hJRlQpOwotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9f
YmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOworICAgIGlvbW11LT5jdHJsLmV2ZW50
X2ludF9lbiA9IGZhbHNlOworICAgIGlvbW11LT5jdHJsLnBwcl9pbnRfZW4gPSBmYWxzZTsKKyAg
ICB3cml0ZXEoaW9tbXUtPmN0cmwucmF3LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJP
TF9NTUlPX09GRlNFVCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb21tdS0+bG9j
aywgZmxhZ3MpOwogCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvYW1kLWlvbW11LmgKKysrIGIv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9hbWQtaW9tbXUuaApAQCAtODgsNiArODgsOCBAQCBzdHJ1Y3Qg
YW1kX2lvbW11IHsKICAgICB2b2lkICptbWlvX2Jhc2U7CiAgICAgdW5zaWduZWQgbG9uZyBtbWlv
X2Jhc2VfcGh5czsKIAorICAgIHVuaW9uIGFtZF9pb21tdV9jb250cm9sIGN0cmw7CisKICAgICBz
dHJ1Y3QgdGFibGVfc3RydWN0IGRldl90YWJsZTsKICAgICBzdHJ1Y3QgcmluZ19idWZmZXIgY21k
X2J1ZmZlcjsKICAgICBzdHJ1Y3QgcmluZ19idWZmZXIgZXZlbnRfbG9nOwpAQCAtMTczLDcgKzE3
NSw3IEBAIHN0cnVjdCBndWVzdF9pb21tdSB7CiAgICAgdWludDY0X3QgICAgICAgICAgICAgICAg
bW1pb19iYXNlOyAgICAgICAgICAgICAvKiBNTUlPIGJhc2UgYWRkcmVzcyAqLwogCiAgICAgLyog
TU1JTyByZWdzICovCi0gICAgc3RydWN0IG1taW9fcmVnICAgICAgICAgcmVnX2N0cmw7ICAgICAg
ICAgICAgICAvKiBNTUlPIG9mZnNldCAwMDE4aCAqLworICAgIHVuaW9uIGFtZF9pb21tdV9jb250
cm9sIHJlZ19jdHJsOyAgICAgICAgICAgICAgLyogTU1JTyBvZmZzZXQgMDAxOGggKi8KICAgICBz
dHJ1Y3QgbW1pb19yZWcgICAgICAgICByZWdfc3RhdHVzOyAgICAgICAgICAgIC8qIE1NSU8gb2Zm
c2V0IDIwMjBoICovCiAgICAgdW5pb24gYW1kX2lvbW11X2V4dF9mZWF0dXJlcyByZWdfZXh0X2Zl
YXR1cmU7ICAvKiBNTUlPIG9mZnNldCAwMDMwaCAqLwogCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14
ODYvaHZtL3N2bS9hbWQtaW9tbXUtZGVmcy5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZt
L3N2bS9hbWQtaW9tbXUtZGVmcy5oCkBAIC0yOTUsMzggKzI5NSw1NiBAQCBzdHJ1Y3QgYW1kX2lv
bW11X2R0ZSB7CiAKIC8qIENvbnRyb2wgUmVnaXN0ZXIgKi8KICNkZWZpbmUgSU9NTVVfQ09OVFJP
TF9NTUlPX09GRlNFVAkJCTB4MTgKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9UUkFOU0xBVElPTl9F
TkFCTEVfTUFTSwkJMHgwMDAwMDAwMQotI2RlZmluZSBJT01NVV9DT05UUk9MX1RSQU5TTEFUSU9O
X0VOQUJMRV9TSElGVAkJMAotI2RlZmluZSBJT01NVV9DT05UUk9MX0hUX1RVTk5FTF9UUkFOU0xB
VElPTl9NQVNLCTB4MDAwMDAwMDIKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9IVF9UVU5ORUxfVFJB
TlNMQVRJT05fU0hJRlQJMQotI2RlZmluZSBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19FTkFCTEVf
TUFTSwkJMHgwMDAwMDAwNAotI2RlZmluZSBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19FTkFCTEVf
U0hJRlQJCTIKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0dfSU5UX01BU0sJCTB4MDAw
MDAwMDgKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0dfSU5UX1NISUZUCQkzCi0jZGVm
aW5lIElPTU1VX0NPTlRST0xfQ09NUF9XQUlUX0lOVF9NQVNLCQkweDAwMDAwMDEwCi0jZGVmaW5l
IElPTU1VX0NPTlRST0xfQ09NUF9XQUlUX0lOVF9TSElGVAkJNAotI2RlZmluZSBJT01NVV9DT05U
Uk9MX0lOVkFMSURBVElPTl9USU1FT1VUX01BU0sJCTB4MDAwMDAwRTAKLSNkZWZpbmUgSU9NTVVf
Q09OVFJPTF9JTlZBTElEQVRJT05fVElNRU9VVF9TSElGVAk1Ci0jZGVmaW5lIElPTU1VX0NPTlRS
T0xfUEFTU19QT1NURURfV1JJVEVfTUFTSwkJMHgwMDAwMDEwMAotI2RlZmluZSBJT01NVV9DT05U
Uk9MX1BBU1NfUE9TVEVEX1dSSVRFX1NISUZUCQk4Ci0jZGVmaW5lIElPTU1VX0NPTlRST0xfUkVT
UF9QQVNTX1BPU1RFRF9XUklURV9NQVNLCTB4MDAwMDAyMDAKLSNkZWZpbmUgSU9NTVVfQ09OVFJP
TF9SRVNQX1BBU1NfUE9TVEVEX1dSSVRFX1NISUZUCTkKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9D
T0hFUkVOVF9NQVNLCQkJMHgwMDAwMDQwMAotI2RlZmluZSBJT01NVV9DT05UUk9MX0NPSEVSRU5U
X1NISUZUCQkJMTAKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9JU09DSFJPTk9VU19NQVNLCQkJMHgw
MDAwMDgwMAotI2RlZmluZSBJT01NVV9DT05UUk9MX0lTT0NIUk9OT1VTX1NISUZUCQkJMTEKLSNk
ZWZpbmUgSU9NTVVfQ09OVFJPTF9DT01NQU5EX0JVRkZFUl9FTkFCTEVfTUFTSwkweDAwMDAxMDAw
Ci0jZGVmaW5lIElPTU1VX0NPTlRST0xfQ09NTUFORF9CVUZGRVJfRU5BQkxFX1NISUZUCTEyCi0j
ZGVmaW5lIElPTU1VX0NPTlRST0xfUFBSX0xPR19FTkFCTEVfTUFTSwkJMHgwMDAwMjAwMAotI2Rl
ZmluZSBJT01NVV9DT05UUk9MX1BQUl9MT0dfRU5BQkxFX1NISUZUCQkxMwotI2RlZmluZSBJT01N
VV9DT05UUk9MX1BQUl9MT0dfSU5UX01BU0sJCQkweDAwMDA0MDAwCi0jZGVmaW5lIElPTU1VX0NP
TlRST0xfUFBSX0xPR19JTlRfU0hJRlQJCQkxNAotI2RlZmluZSBJT01NVV9DT05UUk9MX1BQUl9F
TkFCTEVfTUFTSwkJCTB4MDAwMDgwMDAKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9QUFJfRU5BQkxF
X1NISUZUCQkJMTUKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9HVF9FTkFCTEVfTUFTSwkJCTB4MDAw
MTAwMDAKLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9HVF9FTkFCTEVfU0hJRlQJCQkxNgotI2RlZmlu
ZSBJT01NVV9DT05UUk9MX1JFU1RBUlRfTUFTSwkJCTB4ODAwMDAwMDAKLSNkZWZpbmUgSU9NTVVf
Q09OVFJPTF9SRVNUQVJUX1NISUZUCQkJMzEKKwordW5pb24gYW1kX2lvbW11X2NvbnRyb2wgewor
ICAgIHVpbnQ2NF90IHJhdzsKKyAgICBzdHJ1Y3QgeworICAgICAgICBib29sIGlvbW11X2VuOjE7
CisgICAgICAgIGJvb2wgaHRfdHVuX2VuOjE7CisgICAgICAgIGJvb2wgZXZlbnRfbG9nX2VuOjE7
CisgICAgICAgIGJvb2wgZXZlbnRfaW50X2VuOjE7CisgICAgICAgIGJvb2wgY29tX3dhaXRfaW50
X2VuOjE7CisgICAgICAgIHVuc2lnbmVkIGludCBpbnZfdGltZW91dDozOworICAgICAgICBib29s
IHBhc3NfcHc6MTsKKyAgICAgICAgYm9vbCByZXNfcGFzc19wdzoxOworICAgICAgICBib29sIGNv
aGVyZW50OjE7CisgICAgICAgIGJvb2wgaXNvYzoxOworICAgICAgICBib29sIGNtZF9idWZfZW46
MTsKKyAgICAgICAgYm9vbCBwcHJfbG9nX2VuOjE7CisgICAgICAgIGJvb2wgcHByX2ludF9lbjox
OworICAgICAgICBib29sIHBwcl9lbjoxOworICAgICAgICBib29sIGd0X2VuOjE7CisgICAgICAg
IGJvb2wgZ2FfZW46MTsKKyAgICAgICAgdW5zaWduZWQgaW50IGNydzo0OworICAgICAgICBib29s
IHNtaWZfZW46MTsKKyAgICAgICAgYm9vbCBzbGZfd2JfZGlzOjE7CisgICAgICAgIGJvb2wgc21p
Zl9sb2dfZW46MTsKKyAgICAgICAgdW5zaWduZWQgaW50IGdhbV9lbjozOworICAgICAgICBib29s
IGdhX2xvZ19lbjoxOworICAgICAgICBib29sIGdhX2ludF9lbjoxOworICAgICAgICB1bnNpZ25l
ZCBpbnQgZHVhbF9wcHJfbG9nX2VuOjI7CisgICAgICAgIHVuc2lnbmVkIGludCBkdWFsX2V2ZW50
X2xvZ19lbjoyOworICAgICAgICB1bnNpZ25lZCBpbnQgZGV2X3RibF9zZWdfZW46MzsKKyAgICAg
ICAgdW5zaWduZWQgaW50IHByaXZfYWJydF9lbjoyOworICAgICAgICBib29sIHBwcl9hdXRvX3Jz
cF9lbjoxOworICAgICAgICBib29sIG1hcmNfZW46MTsKKyAgICAgICAgYm9vbCBibGtfc3RvcF9t
cmtfZW46MTsKKyAgICAgICAgYm9vbCBwcHJfYXV0b19yc3BfYW9uOjE7CisgICAgICAgIGJvb2wg
ZG9tYWluX2lkX3BuZToxOworICAgICAgICB1bnNpZ25lZCBpbnQgOjE7CisgICAgICAgIGJvb2wg
ZXBoX2VuOjE7CisgICAgICAgIHVuc2lnbmVkIGludCBoYWRfdXBkYXRlOjI7CisgICAgICAgIGJv
b2wgZ2RfdXBkYXRlX2RpczoxOworICAgICAgICB1bnNpZ25lZCBpbnQgOjE7CisgICAgICAgIGJv
b2wgeHRfZW46MTsKKyAgICAgICAgYm9vbCBpbnRfY2FwX3h0X2VuOjE7CisgICAgICAgIGJvb2wg
dmNtZF9lbjoxOworICAgICAgICBib29sIHZpb21tdV9lbjoxOworICAgICAgICBib29sIGdhX3Vw
ZGF0ZV9kaXM6MTsKKyAgICAgICAgYm9vbCBnYXBwaV9lbjoxOworICAgICAgICB1bnNpZ25lZCBp
bnQgOjg7CisgICAgfTsKK307CiAKIC8qIEV4Y2x1c2lvbiBSZWdpc3RlciAqLwogI2RlZmluZSBJ
T01NVV9FWENMVVNJT05fQkFTRV9MT1dfT0ZGU0VUCQkweDIwCg==

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="03-AMD-IOMMU-bitfield-IRTE.patch"
Content-Description: 03-AMD-IOMMU-bitfield-IRTE.patch
Content-Disposition: attachment;
	filename="03-AMD-IOMMU-bitfield-IRTE.patch"; size=9373;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <C16EDBF04C5AD24EAC25B17EDDCF8C7C@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiB1c2UgYml0IGZpZWxkIGZvciBJUlRFCgpBdCB0aGUgc2FtZSB0aW1lIHJlc3Ry
aWN0IGl0cyBzY29wZSB0byBqdXN0IHRoZSBzaW5nbGUgc291cmNlIGZpbGUKYWN0dWFsbHkgdXNp
bmcgaXQsIGFuZCBhYnN0cmFjdCBhY2Nlc3NlcyBieSBpbnRyb2R1Y2luZyBhIHVuaW9uIG9mCnBv
aW50ZXJzLiAoQSB1bmlvbiBvZiB0aGUgYWN0dWFsIHRhYmxlIGVudHJpZXMgaXMgbm90IHVzZWQg
dG8gbWFrZSBpdAppbXBvc3NpYmxlIHRvIFt3cm9uZ2x5LCBvbmNlIHRoZSAxMjgtYml0IGZvcm0g
Z2V0cyBhZGRlZF0gcGVyZm9ybQpwb2ludGVyIGFyaXRobWV0aWMgLyBhcnJheSBhY2Nlc3NlcyBv
biBkZXJpdmVkIHR5cGVzLikKCkFsc28gbW92ZSBhd2F5IGZyb20gdXBkYXRpbmcgdGhlIGVudHJp
ZXMgcGllY2VtZWFsOiBDb25zdHJ1Y3QgYSBmdWxsIG5ldwplbnRyeSwgYW5kIHdyaXRlIGl0IG91
dC4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KQWNrZWQt
Ynk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CkFja2VkLWJ5OiBC
cmlhbiBXb29kcyA8YnJpYW4ud29vZHNAYW1kLmNvbT4KLS0tCnY0OiBSZS1iYXNlLiBEbyBhd2F5
IHdpdGggc3RhbmRhbG9uZSBzdHJ1Y3QgaXJ0ZV9iYXNpYy4KdjM6IFN3aXRjaCBib29sZWFuIGJp
dGZpZWxkcyB0byBib29sLgp2MjogbmFtZSB7Z2V0LGZyZWV9X2ludHJlbWFwX2VudHJ5KCkncyBs
YXN0IHBhcmFtZXRlciAiaW5kZXgiIGluc3RlYWQgb2YKICAgICJvZmZzZXQiLiBJbnRyb2R1Y2Ug
dW5pb24gaXJ0ZTMyLgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2lu
dHIuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50ci5jCkBAIC0y
NCw2ICsyNCwyNiBAQAogI2luY2x1ZGUgPHhlbi9rZXloYW5kbGVyLmg+CiAjaW5jbHVkZSA8eGVu
L3NvZnRpcnEuaD4KIAordW5pb24gaXJ0ZTMyIHsKKyAgICB1aW50MzJfdCByYXc7CisgICAgc3Ry
dWN0IHsKKyAgICAgICAgYm9vbCByZW1hcF9lbjoxOworICAgICAgICBib29sIHN1cF9pb19wZjox
OworICAgICAgICB1bnNpZ25lZCBpbnQgaW50X3R5cGU6MzsKKyAgICAgICAgYm9vbCBycV9lb2k6
MTsKKyAgICAgICAgYm9vbCBkbToxOworICAgICAgICBib29sIGd1ZXN0X21vZGU6MTsgLyogTUJa
ICovCisgICAgICAgIHVuc2lnbmVkIGludCBkZXN0Ojg7CisgICAgICAgIHVuc2lnbmVkIGludCB2
ZWN0b3I6ODsKKyAgICAgICAgdW5zaWduZWQgaW50IDo4OworICAgIH0gZmxkczsKK307CisKK3Vu
aW9uIGlydGVfcHRyIHsKKyAgICB2b2lkICpwdHI7CisgICAgdW5pb24gaXJ0ZTMyICpwdHIzMjsK
K307CisKICNkZWZpbmUgSU5UUkVNQVBfVEFCTEVfT1JERVIgICAgMQogI2RlZmluZSBJTlRSRU1B
UF9MRU5HVEggMHhCCiAjZGVmaW5lIElOVFJFTUFQX0VOVFJJRVMgKDEgPDwgSU5UUkVNQVBfTEVO
R1RIKQpAQCAtMTAyLDQ3ICsxMjIsNDUgQEAgc3RhdGljIHVuc2lnbmVkIGludCBhbGxvY19pbnRy
ZW1hcF9lbnRyeQogICAgIHJldHVybiBzbG90OwogfQogCi1zdGF0aWMgdTMyICpnZXRfaW50cmVt
YXBfZW50cnkoaW50IHNlZywgaW50IGJkZiwgaW50IG9mZnNldCkKK3N0YXRpYyB1bmlvbiBpcnRl
X3B0ciBnZXRfaW50cmVtYXBfZW50cnkodW5zaWduZWQgaW50IHNlZywgdW5zaWduZWQgaW50IGJk
ZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50
IGluZGV4KQogewotICAgIHUzMiAqdGFibGUgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcpW2JkZl0u
aW50cmVtYXBfdGFibGU7CisgICAgdW5pb24gaXJ0ZV9wdHIgdGFibGUgPSB7CisgICAgICAgIC5w
dHIgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcpW2JkZl0uaW50cmVtYXBfdGFibGUKKyAgICB9Owor
CisgICAgQVNTRVJUKHRhYmxlLnB0ciAmJiAoaW5kZXggPCBJTlRSRU1BUF9FTlRSSUVTKSk7CiAK
LSAgICBBU1NFUlQoICh0YWJsZSAhPSBOVUxMKSAmJiAob2Zmc2V0IDwgSU5UUkVNQVBfRU5UUklF
UykgKTsKKyAgICB0YWJsZS5wdHIzMiArPSBpbmRleDsKIAotICAgIHJldHVybiB0YWJsZSArIG9m
ZnNldDsKKyAgICByZXR1cm4gdGFibGU7CiB9CiAKLXN0YXRpYyB2b2lkIGZyZWVfaW50cmVtYXBf
ZW50cnkoaW50IHNlZywgaW50IGJkZiwgaW50IG9mZnNldCkKLXsKLSAgICB1MzIgKmVudHJ5ID0g
Z2V0X2ludHJlbWFwX2VudHJ5KHNlZywgYmRmLCBvZmZzZXQpOwotCi0gICAgbWVtc2V0KGVudHJ5
LCAwLCBzaXplb2YodTMyKSk7Ci0gICAgX19jbGVhcl9iaXQob2Zmc2V0LCBnZXRfaXZyc19tYXBw
aW5ncyhzZWcpW2JkZl0uaW50cmVtYXBfaW51c2UpOwotfQotCi1zdGF0aWMgdm9pZCB1cGRhdGVf
aW50cmVtYXBfZW50cnkodTMyKiBlbnRyeSwgdTggdmVjdG9yLCB1OCBpbnRfdHlwZSwKLSAgICB1
OCBkZXN0X21vZGUsIHU4IGRlc3QpCi17Ci0gICAgc2V0X2ZpZWxkX2luX3JlZ191MzIoSU9NTVVf
Q09OVFJPTF9FTkFCTEVELCAwLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOVF9SRU1B
UF9FTlRSWV9SRU1BUEVOX01BU0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgSU5UX1JF
TUFQX0VOVFJZX1JFTUFQRU5fU0hJRlQsIGVudHJ5KTsKLSAgICBzZXRfZmllbGRfaW5fcmVnX3Uz
MihJT01NVV9DT05UUk9MX0RJU0FCTEVELCAqZW50cnksCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgSU5UX1JFTUFQX0VOVFJZX1NVUElPUEZfTUFTSywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBJTlRfUkVNQVBfRU5UUllfU1VQSU9QRl9TSElGVCwgZW50cnkpOwotICAgIHNldF9m
aWVsZF9pbl9yZWdfdTMyKGludF90eXBlLCAqZW50cnksCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgSU5UX1JFTUFQX0VOVFJZX0lOVFRZUEVfTUFTSywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBJTlRfUkVNQVBfRU5UUllfSU5UVFlQRV9TSElGVCwgZW50cnkpOwotICAgIHNldF9m
aWVsZF9pbl9yZWdfdTMyKElPTU1VX0NPTlRST0xfRElTQUJMRUQsICplbnRyeSwKLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBJTlRfUkVNQVBfRU5UUllfUkVRRU9JX01BU0ssCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX1JFUUVPSV9TSElGVCwgZW50cnkp
OwotICAgIHNldF9maWVsZF9pbl9yZWdfdTMyKCh1MzIpZGVzdF9tb2RlLCAqZW50cnksCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX0RNX01BU0ssCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX0RNX1NISUZULCBlbnRyeSk7Ci0g
ICAgc2V0X2ZpZWxkX2luX3JlZ191MzIoKHUzMilkZXN0LCAqZW50cnksCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX0RFU1RfTUFTVCwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJTlRfUkVNQVBfRU5UUllfREVTVF9TSElGVCwgZW50cnkpOwotICAgIHNl
dF9maWVsZF9pbl9yZWdfdTMyKCh1MzIpdmVjdG9yLCAqZW50cnksCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX1ZFQ1RPUl9NQVNLLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIElOVF9SRU1BUF9FTlRSWV9WRUNUT1JfU0hJRlQsIGVudHJ5KTsKK3N0YXRp
YyB2b2lkIGZyZWVfaW50cmVtYXBfZW50cnkodW5zaWduZWQgaW50IHNlZywgdW5zaWduZWQgaW50
IGJkZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGluZGV4
KQoreworICAgIHVuaW9uIGlydGVfcHRyIGVudHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5KHNlZywg
YmRmLCBpbmRleCk7CisKKyAgICBBQ0NFU1NfT05DRShlbnRyeS5wdHIzMi0+cmF3KSA9IDA7CisK
KyAgICBfX2NsZWFyX2JpdChpbmRleCwgZ2V0X2l2cnNfbWFwcGluZ3Moc2VnKVtiZGZdLmludHJl
bWFwX2ludXNlKTsKK30KKworc3RhdGljIHZvaWQgdXBkYXRlX2ludHJlbWFwX2VudHJ5KHVuaW9u
IGlydGVfcHRyIGVudHJ5LCB1bnNpZ25lZCBpbnQgdmVjdG9yLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpbnRfdHlwZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgZGVzdF9tb2RlLCB1bnNpZ25lZCBpbnQgZGVz
dCkKK3sKKyAgICB1bmlvbiBpcnRlMzIgaXJ0ZSA9IHsKKyAgICAgICAgLmZsZHMgPSB7CisgICAg
ICAgICAgICAucmVtYXBfZW4gPSB0cnVlLAorICAgICAgICAgICAgLmludF90eXBlID0gaW50X3R5
cGUsCisgICAgICAgICAgICAuZG0gPSBkZXN0X21vZGUsCisgICAgICAgICAgICAuZGVzdCA9IGRl
c3QsCisgICAgICAgICAgICAudmVjdG9yID0gdmVjdG9yLAorICAgICAgICB9LAorICAgIH07CisK
KyAgICBBQ0NFU1NfT05DRShlbnRyeS5wdHIzMi0+cmF3KSA9IGlydGUucmF3OwogfQogCiBzdGF0
aWMgaW5saW5lIGludCBnZXRfcnRlX2luZGV4KGNvbnN0IHN0cnVjdCBJT19BUElDX3JvdXRlX2Vu
dHJ5ICpydGUpCkBAIC0xNjQsNyArMTgyLDcgQEAgc3RhdGljIGludCB1cGRhdGVfaW50cmVtYXBf
ZW50cnlfZnJvbV9pbwogICAgIHUxNiAqaW5kZXgpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBmbGFn
czsKLSAgICB1MzIqIGVudHJ5OworICAgIHVuaW9uIGlydGVfcHRyIGVudHJ5OwogICAgIHU4IGRl
bGl2ZXJ5X21vZGUsIGRlc3QsIHZlY3RvciwgZGVzdF9tb2RlOwogICAgIGludCByZXFfaWQ7CiAg
ICAgc3BpbmxvY2tfdCAqbG9jazsKQEAgLTIwMiwxMiArMjIwLDggQEAgc3RhdGljIGludCB1cGRh
dGVfaW50cmVtYXBfZW50cnlfZnJvbV9pbwogICAgICAgICAgKiBzbyBuZWVkIHRvIHJlY292ZXIg
dmVjdG9yIGFuZCBkZWxpdmVyeSBtb2RlIGZyb20gSVJURS4KICAgICAgICAgICovCiAgICAgICAg
IEFTU0VSVChnZXRfcnRlX2luZGV4KHJ0ZSkgPT0gb2Zmc2V0KTsKLSAgICAgICAgdmVjdG9yID0g
Z2V0X2ZpZWxkX2Zyb21fcmVnX3UzMigqZW50cnksCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX1ZFQ1RPUl9NQVNLLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOVF9SRU1BUF9FTlRSWV9WRUNUT1JfU0hJRlQp
OwotICAgICAgICBkZWxpdmVyeV9tb2RlID0gZ2V0X2ZpZWxkX2Zyb21fcmVnX3UzMigqZW50cnks
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOVF9SRU1B
UF9FTlRSWV9JTlRUWVBFX01BU0ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIElOVF9SRU1BUF9FTlRSWV9JTlRUWVBFX1NISUZUKTsKKyAgICAgICAgdmVj
dG9yID0gZW50cnkucHRyMzItPmZsZHMudmVjdG9yOworICAgICAgICBkZWxpdmVyeV9tb2RlID0g
ZW50cnkucHRyMzItPmZsZHMuaW50X3R5cGU7CiAgICAgfQogICAgIHVwZGF0ZV9pbnRyZW1hcF9l
bnRyeShlbnRyeSwgdmVjdG9yLCBkZWxpdmVyeV9tb2RlLCBkZXN0X21vZGUsIGRlc3QpOwogCkBA
IC0yMjksNyArMjQzLDcgQEAgaW50IF9faW5pdCBhbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFw
cAogewogICAgIHN0cnVjdCBJT19BUElDX3JvdXRlX2VudHJ5IHJ0ZTsKICAgICB1bnNpZ25lZCBs
b25nIGZsYWdzOwotICAgIHUzMiogZW50cnk7CisgICAgdW5pb24gaXJ0ZV9wdHIgZW50cnk7CiAg
ICAgaW50IGFwaWMsIHBpbjsKICAgICB1OCBkZWxpdmVyeV9tb2RlLCBkZXN0LCB2ZWN0b3IsIGRl
c3RfbW9kZTsKICAgICB1MTYgc2VnLCBiZGYsIHJlcV9pZDsKQEAgLTQwOCwxNiArNDIyLDE0IEBA
IHVuc2lnbmVkIGludCBhbWRfaW9tbXVfcmVhZF9pb2FwaWNfZnJvbV8KICAgICAgICAgdTE2IGJk
ZiA9IGlvYXBpY19zYmRmW2lkeF0uYmRmOwogICAgICAgICB1MTYgc2VnID0gaW9hcGljX3NiZGZb
aWR4XS5zZWc7CiAgICAgICAgIHUxNiByZXFfaWQgPSBnZXRfaW50cmVtYXBfcmVxdWVzdG9yX2lk
KHNlZywgYmRmKTsKLSAgICAgICAgY29uc3QgdTMyICplbnRyeSA9IGdldF9pbnRyZW1hcF9lbnRy
eShzZWcsIHJlcV9pZCwgb2Zmc2V0KTsKKyAgICAgICAgdW5pb24gaXJ0ZV9wdHIgZW50cnkgPSBn
ZXRfaW50cmVtYXBfZW50cnkoc2VnLCByZXFfaWQsIG9mZnNldCk7CiAKICAgICAgICAgQVNTRVJU
KG9mZnNldCA9PSAodmFsICYgKElOVFJFTUFQX0VOVFJJRVMgLSAxKSkpOwogICAgICAgICB2YWwg
Jj0gfihJTlRSRU1BUF9FTlRSSUVTIC0gMSk7Ci0gICAgICAgIHZhbCB8PSBnZXRfZmllbGRfZnJv
bV9yZWdfdTMyKCplbnRyeSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU5UX1JFTUFQX0VOVFJZX0lOVFRZUEVfTUFTSywKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX0lOVFRZUEVfU0hJRlQpIDw8IDg7Ci0gICAgICAg
IHZhbCB8PSBnZXRfZmllbGRfZnJvbV9yZWdfdTMyKCplbnRyeSwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX1ZFQ1RPUl9NQVNLLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJTlRfUkVNQVBfRU5UUllfVkVDVE9SX1NI
SUZUKTsKKyAgICAgICAgdmFsIHw9IE1BU0tfSU5TUihlbnRyeS5wdHIzMi0+Zmxkcy5pbnRfdHlw
ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICBJT19BUElDX1JFRElSX0RFTElWX01PREVfTUFT
Syk7CisgICAgICAgIHZhbCB8PSBNQVNLX0lOU1IoZW50cnkucHRyMzItPmZsZHMudmVjdG9yLAor
ICAgICAgICAgICAgICAgICAgICAgICAgIElPX0FQSUNfUkVESVJfVkVDVE9SX01BU0spOwogICAg
IH0KIAogICAgIHJldHVybiB2YWw7CkBAIC00MjgsNyArNDQwLDcgQEAgc3RhdGljIGludCB1cGRh
dGVfaW50cmVtYXBfZW50cnlfZnJvbV9tcwogICAgIGludCAqcmVtYXBfaW5kZXgsIGNvbnN0IHN0
cnVjdCBtc2lfbXNnICptc2csIHUzMiAqZGF0YSkKIHsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdz
OwotICAgIHUzMiogZW50cnk7CisgICAgdW5pb24gaXJ0ZV9wdHIgZW50cnk7CiAgICAgdTE2IHJl
cV9pZCwgYWxpYXNfaWQ7CiAgICAgdTggZGVsaXZlcnlfbW9kZSwgZGVzdCwgdmVjdG9yLCBkZXN0
X21vZGU7CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKQEAgLTU4Miw3ICs1OTQsNyBAQCB2b2lkIGFt
ZF9pb21tdV9yZWFkX21zaV9mcm9tX2lyZSgKICAgICBjb25zdCBzdHJ1Y3QgcGNpX2RldiAqcGRl
diA9IG1zaV9kZXNjLT5kZXY7CiAgICAgdTE2IGJkZiA9IHBkZXYgPyBQQ0lfQkRGMihwZGV2LT5i
dXMsIHBkZXYtPmRldmZuKSA6IGhwZXRfc2JkZi5iZGY7CiAgICAgdTE2IHNlZyA9IHBkZXYgPyBw
ZGV2LT5zZWcgOiBocGV0X3NiZGYuc2VnOwotICAgIGNvbnN0IHUzMiAqZW50cnk7CisgICAgdW5p
b24gaXJ0ZV9wdHIgZW50cnk7CiAKICAgICBpZiAoIElTX0VSUl9PUl9OVUxMKF9maW5kX2lvbW11
X2Zvcl9kZXZpY2Uoc2VnLCBiZGYpKSApCiAgICAgICAgIHJldHVybjsKQEAgLTU5OCwxMiArNjEw
LDEwIEBAIHZvaWQgYW1kX2lvbW11X3JlYWRfbXNpX2Zyb21faXJlKAogICAgIH0KIAogICAgIG1z
Zy0+ZGF0YSAmPSB+KElOVFJFTUFQX0VOVFJJRVMgLSAxKTsKLSAgICBtc2ctPmRhdGEgfD0gZ2V0
X2ZpZWxkX2Zyb21fcmVnX3UzMigqZW50cnksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX0lOVFRZUEVfTUFTSywKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBJTlRfUkVNQVBfRU5UUllfSU5UVFlQRV9TSElGVCkg
PDwgODsKLSAgICBtc2ctPmRhdGEgfD0gZ2V0X2ZpZWxkX2Zyb21fcmVnX3UzMigqZW50cnksCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU5UX1JFTUFQX0VOVFJZX1ZF
Q1RPUl9NQVNLLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElOVF9S
RU1BUF9FTlRSWV9WRUNUT1JfU0hJRlQpOworICAgIG1zZy0+ZGF0YSB8PSBNQVNLX0lOU1IoZW50
cnkucHRyMzItPmZsZHMuaW50X3R5cGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICBNU0lf
REFUQV9ERUxJVkVSWV9NT0RFX01BU0spOworICAgIG1zZy0+ZGF0YSB8PSBNQVNLX0lOU1IoZW50
cnkucHRyMzItPmZsZHMudmVjdG9yLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgTVNJX0RB
VEFfVkVDVE9SX01BU0spOwogfQogCiBpbnQgX19pbml0IGFtZF9pb21tdV9mcmVlX2ludHJlbWFw
X3RhYmxlKAotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMu
aAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMuaApAQCAt
NDY5LDIyICs0NjksNiBAQCBzdHJ1Y3QgYW1kX2lvbW11X3B0ZSB7CiAjZGVmaW5lIElPTU1VX0NP
TlRST0xfRElTQUJMRUQJMAogI2RlZmluZSBJT01NVV9DT05UUk9MX0VOQUJMRUQJMQogCi0vKiBp
bnRlcnJ1cHQgcmVtYXBwaW5nIHRhYmxlICovCi0jZGVmaW5lIElOVF9SRU1BUF9FTlRSWV9SRU1B
UEVOX01BU0sgICAgMHgwMDAwMDAwMQotI2RlZmluZSBJTlRfUkVNQVBfRU5UUllfUkVNQVBFTl9T
SElGVCAgIDAKLSNkZWZpbmUgSU5UX1JFTUFQX0VOVFJZX1NVUElPUEZfTUFTSyAgICAweDAwMDAw
MDAyCi0jZGVmaW5lIElOVF9SRU1BUF9FTlRSWV9TVVBJT1BGX1NISUZUICAgMQotI2RlZmluZSBJ
TlRfUkVNQVBfRU5UUllfSU5UVFlQRV9NQVNLICAgIDB4MDAwMDAwMUMKLSNkZWZpbmUgSU5UX1JF
TUFQX0VOVFJZX0lOVFRZUEVfU0hJRlQgICAyCi0jZGVmaW5lIElOVF9SRU1BUF9FTlRSWV9SRVFF
T0lfTUFTSyAgICAgMHgwMDAwMDAyMAotI2RlZmluZSBJTlRfUkVNQVBfRU5UUllfUkVRRU9JX1NI
SUZUICAgIDUKLSNkZWZpbmUgSU5UX1JFTUFQX0VOVFJZX0RNX01BU0sgICAgICAgICAweDAwMDAw
MDQwCi0jZGVmaW5lIElOVF9SRU1BUF9FTlRSWV9ETV9TSElGVCAgICAgICAgNgotI2RlZmluZSBJ
TlRfUkVNQVBfRU5UUllfREVTVF9NQVNUICAgICAgIDB4MDAwMEZGMDAKLSNkZWZpbmUgSU5UX1JF
TUFQX0VOVFJZX0RFU1RfU0hJRlQgICAgICA4Ci0jZGVmaW5lIElOVF9SRU1BUF9FTlRSWV9WRUNU
T1JfTUFTSyAgICAgMHgwMEZGMDAwMAotI2RlZmluZSBJTlRfUkVNQVBfRU5UUllfVkVDVE9SX1NI
SUZUICAgIDE2Ci0KICNkZWZpbmUgSU5WX0lPTU1VX0FMTF9QQUdFU19BRERSRVNTICAgICAgKCgx
VUxMIDw8IDYzKSAtIDEpCiAKICNkZWZpbmUgSU9NTVVfUklOR19CVUZGRVJfUFRSX01BU0sgICAg
ICAgICAgICAgICAgICAweDAwMDdGRkYwCg==

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="04-AMD-IOMMU-get-IRTE-IOMMU.patch"
Content-Description: 04-AMD-IOMMU-get-IRTE-IOMMU.patch
Content-Disposition: attachment;
	filename="04-AMD-IOMMU-get-IRTE-IOMMU.patch"; size=6015;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <BA8296741160224FA9D63A882997B9B7@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBwYXNzIElPTU1VIHRvIHtnZXQsZnJlZSx1cGRhdGV9X2ludHJlbWFwX2VudHJ5
KCkKClRoZSBmdW5jdGlvbnMgd2lsbCB3YW50IHRvIGtub3cgSU9NTVUgcHJvcGVydGllcyAoc3Bl
Y2lmaWNhbGx5IHRoZSBJUlRFCnNpemUpIHN1YnNlcXVlbnRseS4KClJhdGhlciB0aGFuIGludHJv
ZHVjaW5nIGEgc2Vjb25kIGVycm9yIHBhdGggYm9ndXNseSByZXR1cm5pbmcgLUUuLi4gZnJvbQph
bWRfaW9tbXVfcmVhZF9pb2FwaWNfZnJvbV9pcmUoKSwgYWxzbyBjaGFuZ2UgdGhlIGV4aXN0aW5n
IG9uZSB0byBmb2xsb3cKVlQtZCBpbiByZXR1cm5pbmcgdGhlIHJhdyAodW50cmFuc2xhdGVkKSBJ
Ty1BUElDIFJURS4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNv
bT4KQWNrZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CkFj
a2VkLWJ5OiBCcmlhbiBXb29kcyA8YnJpYW4ud29vZHNAYW1kLmNvbT4KLS0tCnYzOiBOZXcuCgot
LS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW50ci5jCisrKyBiL3hlbi9k
cml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMKQEAgLTEyMiwxMSArMTIyLDExIEBA
IHN0YXRpYyB1bnNpZ25lZCBpbnQgYWxsb2NfaW50cmVtYXBfZW50cnkKICAgICByZXR1cm4gc2xv
dDsKIH0KIAotc3RhdGljIHVuaW9uIGlydGVfcHRyIGdldF9pbnRyZW1hcF9lbnRyeSh1bnNpZ25l
ZCBpbnQgc2VnLCB1bnNpZ25lZCBpbnQgYmRmLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpCitzdGF0aWMgdW5pb24gaXJ0ZV9wdHIg
Z2V0X2ludHJlbWFwX2VudHJ5KGNvbnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgYmRmLCB1bnNp
Z25lZCBpbnQgaW5kZXgpCiB7CiAgICAgdW5pb24gaXJ0ZV9wdHIgdGFibGUgPSB7Ci0gICAgICAg
IC5wdHIgPSBnZXRfaXZyc19tYXBwaW5ncyhzZWcpW2JkZl0uaW50cmVtYXBfdGFibGUKKyAgICAg
ICAgLnB0ciA9IGdldF9pdnJzX21hcHBpbmdzKGlvbW11LT5zZWcpW2JkZl0uaW50cmVtYXBfdGFi
bGUKICAgICB9OwogCiAgICAgQVNTRVJUKHRhYmxlLnB0ciAmJiAoaW5kZXggPCBJTlRSRU1BUF9F
TlRSSUVTKSk7CkBAIC0xMzYsMTggKzEzNiwxOSBAQCBzdGF0aWMgdW5pb24gaXJ0ZV9wdHIgZ2V0
X2ludHJlbWFwX2VudHJ5CiAgICAgcmV0dXJuIHRhYmxlOwogfQogCi1zdGF0aWMgdm9pZCBmcmVl
X2ludHJlbWFwX2VudHJ5KHVuc2lnbmVkIGludCBzZWcsIHVuc2lnbmVkIGludCBiZGYsCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBpbmRleCkKK3N0YXRpYyB2
b2lkIGZyZWVfaW50cmVtYXBfZW50cnkoY29uc3Qgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBiZGYsIHVuc2lnbmVk
IGludCBpbmRleCkKIHsKLSAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeSA9IGdldF9pbnRyZW1hcF9l
bnRyeShzZWcsIGJkZiwgaW5kZXgpOworICAgIHVuaW9uIGlydGVfcHRyIGVudHJ5ID0gZ2V0X2lu
dHJlbWFwX2VudHJ5KGlvbW11LCBiZGYsIGluZGV4KTsKIAogICAgIEFDQ0VTU19PTkNFKGVudHJ5
LnB0cjMyLT5yYXcpID0gMDsKIAotICAgIF9fY2xlYXJfYml0KGluZGV4LCBnZXRfaXZyc19tYXBw
aW5ncyhzZWcpW2JkZl0uaW50cmVtYXBfaW51c2UpOworICAgIF9fY2xlYXJfYml0KGluZGV4LCBn
ZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVtiZGZdLmludHJlbWFwX2ludXNlKTsKIH0KIAot
c3RhdGljIHZvaWQgdXBkYXRlX2ludHJlbWFwX2VudHJ5KHVuaW9uIGlydGVfcHRyIGVudHJ5LCB1
bnNpZ25lZCBpbnQgdmVjdG9yLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBpbnRfdHlwZSwKK3N0YXRpYyB2b2lkIHVwZGF0ZV9pbnRyZW1hcF9lbnRyeShj
b25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBpbnQgdmVjdG9yLCB1bnNpZ25lZCBpbnQgaW50X3R5cGUsCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGRlc3RfbW9kZSwgdW5z
aWduZWQgaW50IGRlc3QpCiB7CiAgICAgdW5pb24gaXJ0ZTMyIGlydGUgPSB7CkBAIC0yMTIsNyAr
MjEzLDcgQEAgc3RhdGljIGludCB1cGRhdGVfaW50cmVtYXBfZW50cnlfZnJvbV9pbwogICAgICAg
ICBsb191cGRhdGUgPSAxOwogICAgIH0KIAotICAgIGVudHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5
KGlvbW11LT5zZWcsIHJlcV9pZCwgb2Zmc2V0KTsKKyAgICBlbnRyeSA9IGdldF9pbnRyZW1hcF9l
bnRyeShpb21tdSwgcmVxX2lkLCBvZmZzZXQpOwogICAgIGlmICggIWxvX3VwZGF0ZSApCiAgICAg
ewogICAgICAgICAvKgpAQCAtMjIzLDcgKzIyNCw3IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2ludHJl
bWFwX2VudHJ5X2Zyb21faW8KICAgICAgICAgdmVjdG9yID0gZW50cnkucHRyMzItPmZsZHMudmVj
dG9yOwogICAgICAgICBkZWxpdmVyeV9tb2RlID0gZW50cnkucHRyMzItPmZsZHMuaW50X3R5cGU7
CiAgICAgfQotICAgIHVwZGF0ZV9pbnRyZW1hcF9lbnRyeShlbnRyeSwgdmVjdG9yLCBkZWxpdmVy
eV9tb2RlLCBkZXN0X21vZGUsIGRlc3QpOworICAgIHVwZGF0ZV9pbnRyZW1hcF9lbnRyeShpb21t
dSwgZW50cnksIHZlY3RvciwgZGVsaXZlcnlfbW9kZSwgZGVzdF9tb2RlLCBkZXN0KTsKIAogICAg
IHNwaW5fdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOwogCkBAIC0yODgsOCArMjg5LDgg
QEAgaW50IF9faW5pdCBhbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFwcAogICAgICAgICAgICAg
c3Bpbl9sb2NrX2lycXNhdmUobG9jaywgZmxhZ3MpOwogICAgICAgICAgICAgb2Zmc2V0ID0gYWxs
b2NfaW50cmVtYXBfZW50cnkoc2VnLCByZXFfaWQsIDEpOwogICAgICAgICAgICAgQlVHX09OKG9m
ZnNldCA+PSBJTlRSRU1BUF9FTlRSSUVTKTsKLSAgICAgICAgICAgIGVudHJ5ID0gZ2V0X2ludHJl
bWFwX2VudHJ5KGlvbW11LT5zZWcsIHJlcV9pZCwgb2Zmc2V0KTsKLSAgICAgICAgICAgIHVwZGF0
ZV9pbnRyZW1hcF9lbnRyeShlbnRyeSwgdmVjdG9yLAorICAgICAgICAgICAgZW50cnkgPSBnZXRf
aW50cmVtYXBfZW50cnkoaW9tbXUsIHJlcV9pZCwgb2Zmc2V0KTsKKyAgICAgICAgICAgIHVwZGF0
ZV9pbnRyZW1hcF9lbnRyeShpb21tdSwgZW50cnksIHZlY3RvciwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkZWxpdmVyeV9tb2RlLCBkZXN0X21vZGUsIGRlc3QpOwogICAgICAg
ICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZShsb2NrLCBmbGFncyk7CiAKQEAgLTQxMyw3ICs0
MTQsNyBAQCB1bnNpZ25lZCBpbnQgYW1kX2lvbW11X3JlYWRfaW9hcGljX2Zyb21fCiAKICAgICBp
ZHggPSBpb2FwaWNfaWRfdG9faW5kZXgoSU9fQVBJQ19JRChhcGljKSk7CiAgICAgaWYgKCBpZHgg
PT0gTUFYX0lPX0FQSUNTICkKLSAgICAgICAgcmV0dXJuIC1FSU5WQUw7CisgICAgICAgIHJldHVy
biB2YWw7CiAKICAgICBvZmZzZXQgPSBpb2FwaWNfc2JkZltpZHhdLnBpbl8yX2lkeFtwaW5dOwog
CkBAIC00MjIsOSArNDIzLDEzIEBAIHVuc2lnbmVkIGludCBhbWRfaW9tbXVfcmVhZF9pb2FwaWNf
ZnJvbV8KICAgICAgICAgdTE2IGJkZiA9IGlvYXBpY19zYmRmW2lkeF0uYmRmOwogICAgICAgICB1
MTYgc2VnID0gaW9hcGljX3NiZGZbaWR4XS5zZWc7CiAgICAgICAgIHUxNiByZXFfaWQgPSBnZXRf
aW50cmVtYXBfcmVxdWVzdG9yX2lkKHNlZywgYmRmKTsKLSAgICAgICAgdW5pb24gaXJ0ZV9wdHIg
ZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoc2VnLCByZXFfaWQsIG9mZnNldCk7CisgICAgICAg
IGNvbnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11ID0gZmluZF9pb21tdV9mb3JfZGV2aWNlKHNl
ZywgYmRmKTsKKyAgICAgICAgdW5pb24gaXJ0ZV9wdHIgZW50cnk7CiAKKyAgICAgICAgaWYgKCAh
aW9tbXUgKQorICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgQVNTRVJUKG9mZnNldCA9
PSAodmFsICYgKElOVFJFTUFQX0VOVFJJRVMgLSAxKSkpOworICAgICAgICBlbnRyeSA9IGdldF9p
bnRyZW1hcF9lbnRyeShpb21tdSwgcmVxX2lkLCBvZmZzZXQpOwogICAgICAgICB2YWwgJj0gfihJ
TlRSRU1BUF9FTlRSSUVTIC0gMSk7CiAgICAgICAgIHZhbCB8PSBNQVNLX0lOU1IoZW50cnkucHRy
MzItPmZsZHMuaW50X3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgSU9fQVBJQ19SRURJ
Ul9ERUxJVl9NT0RFX01BU0spOwpAQCAtNDU0LDcgKzQ1OSw3IEBAIHN0YXRpYyBpbnQgdXBkYXRl
X2ludHJlbWFwX2VudHJ5X2Zyb21fbXMKICAgICAgICAgbG9jayA9IGdldF9pbnRyZW1hcF9sb2Nr
KGlvbW11LT5zZWcsIHJlcV9pZCk7CiAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKGxvY2ssIGZs
YWdzKTsKICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBucjsgKytpICkKLSAgICAgICAgICAgIGZy
ZWVfaW50cmVtYXBfZW50cnkoaW9tbXUtPnNlZywgcmVxX2lkLCAqcmVtYXBfaW5kZXggKyBpKTsK
KyAgICAgICAgICAgIGZyZWVfaW50cmVtYXBfZW50cnkoaW9tbXUsIHJlcV9pZCwgKnJlbWFwX2lu
ZGV4ICsgaSk7CiAgICAgICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOwog
ICAgICAgICBnb3RvIGRvbmU7CiAgICAgfQpAQCAtNDc5LDggKzQ4NCw4IEBAIHN0YXRpYyBpbnQg
dXBkYXRlX2ludHJlbWFwX2VudHJ5X2Zyb21fbXMKICAgICAgICAgKnJlbWFwX2luZGV4ID0gb2Zm
c2V0OwogICAgIH0KIAotICAgIGVudHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5KGlvbW11LT5zZWcs
IHJlcV9pZCwgb2Zmc2V0KTsKLSAgICB1cGRhdGVfaW50cmVtYXBfZW50cnkoZW50cnksIHZlY3Rv
ciwgZGVsaXZlcnlfbW9kZSwgZGVzdF9tb2RlLCBkZXN0KTsKKyAgICBlbnRyeSA9IGdldF9pbnRy
ZW1hcF9lbnRyeShpb21tdSwgcmVxX2lkLCBvZmZzZXQpOworICAgIHVwZGF0ZV9pbnRyZW1hcF9l
bnRyeShpb21tdSwgZW50cnksIHZlY3RvciwgZGVsaXZlcnlfbW9kZSwgZGVzdF9tb2RlLCBkZXN0
KTsKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKGxvY2ssIGZsYWdzKTsKIAogICAgICpkYXRh
ID0gKG1zZy0+ZGF0YSAmIH4oSU5UUkVNQVBfRU5UUklFUyAtIDEpKSB8IG9mZnNldDsKQEAgLTU5
NCwxMiArNTk5LDEzIEBAIHZvaWQgYW1kX2lvbW11X3JlYWRfbXNpX2Zyb21faXJlKAogICAgIGNv
bnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gbXNpX2Rlc2MtPmRldjsKICAgICB1MTYgYmRmID0g
cGRldiA/IFBDSV9CREYyKHBkZXYtPmJ1cywgcGRldi0+ZGV2Zm4pIDogaHBldF9zYmRmLmJkZjsK
ICAgICB1MTYgc2VnID0gcGRldiA/IHBkZXYtPnNlZyA6IGhwZXRfc2JkZi5zZWc7CisgICAgY29u
c3Qgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUgPSBfZmluZF9pb21tdV9mb3JfZGV2aWNlKHNlZywg
YmRmKTsKICAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeTsKIAotICAgIGlmICggSVNfRVJSX09SX05V
TEwoX2ZpbmRfaW9tbXVfZm9yX2RldmljZShzZWcsIGJkZikpICkKKyAgICBpZiAoIElTX0VSUl9P
Ul9OVUxMKGlvbW11KSApCiAgICAgICAgIHJldHVybjsKIAotICAgIGVudHJ5ID0gZ2V0X2ludHJl
bWFwX2VudHJ5KHNlZywgZ2V0X2RtYV9yZXF1ZXN0b3JfaWQoc2VnLCBiZGYpLCBvZmZzZXQpOwor
ICAgIGVudHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5KGlvbW11LCBnZXRfZG1hX3JlcXVlc3Rvcl9p
ZChzZWcsIGJkZiksIG9mZnNldCk7CiAKICAgICBpZiAoIG1zaV9kZXNjLT5tc2lfYXR0cmliLnR5
cGUgPT0gUENJX0NBUF9JRF9NU0kgKQogICAgIHsK

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="05-AMD-IOMMU-128bit-IRTE.patch"
Content-Description: 05-AMD-IOMMU-128bit-IRTE.patch
Content-Disposition: attachment; filename="05-AMD-IOMMU-128bit-IRTE.patch";
	size=17280; creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <4013F7E94D40874985700C7E75A87322@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBpbnRyb2R1Y2UgMTI4LWJpdCBJUlRFIG5vbi1ndWVzdC1BUElDIElSVEUgZm9y
bWF0CgpUaGlzIGlzIGluIHByZXBhcmF0aW9uIG9mIGFjdHVhbGx5IGVuYWJsaW5nIHgyQVBJQyBt
b2RlLCB3aGljaCByZXF1aXJlcwp0aGlzIHdpZGVyIElSVEUgZm9ybWF0IHRvIGJlIHVzZWQuCgpB
IHNwZWNpZmljIHJlbWFyayByZWdhcmRpbmcgdGhlIGZpcnN0IGh1bmsgY2hhbmdpbmcKYW1kX2lv
bW11X2lvYXBpY191cGRhdGVfaXJlKCk6IFRoaXMgYnlwYXNzIHdhcyBpbnRyb2R1Y2VkIGZvciBY
U0EtMzYsCmkuZS4gYnkgOTRkNGExMTE5ZCAoIkFNRCxJT01NVTogQ2xlYW4gdXAgb2xkIGVudHJp
ZXMgaW4gcmVtYXBwaW5nCnRhYmxlcyB3aGVuIGNyZWF0aW5nIG5ldyBvbmUiKS4gT3RoZXIgY29k
ZSBpbnRyb2R1Y2VkIGJ5IHRoYXQgY2hhbmdlIGhhcwptZWFud2hpbGUgZGlzYXBwZWFyZWQgb3Ig
ZnVydGhlciBjaGFuZ2VkLCBhbmQgSSB3b25kZXIgaWYgLSByYXRoZXIgdGhhbgphZGRpbmcgYW4g
eDJhcGljX2VuYWJsZWQgY2hlY2sgdG8gdGhlIGNvbmRpdGlvbmFsIC0gdGhlIGJ5cGFzcyBjb3Vs
ZG4ndApiZSBkZWxldGVkIGFsdG9nZXRoZXIuIEZvciBub3cgdGhlIGdvYWwgaXMgdG8gYWZmZWN0
IHRoZSBub24teDJBUElDCnBhdGhzIGFzIGxpdHRsZSBhcyBwb3NzaWJsZS4KClRha2UgdGhlIGxp
YmVydHkgYW5kIHVzZSB0aGUgbmV3ICJmcmVzaCIgZmxhZyB0byBzdXBwcmVzcyBhbiB1bm5lZWRl
ZApmbHVzaCBpbiB1cGRhdGVfaW50cmVtYXBfZW50cnlfZnJvbV9pb2FwaWMoKS4KClNpZ25lZC1v
ZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KLS0tCnY0OiBSZS1iYXNlLiBE
byBhd2F5IHdpdGggc3RhbmRhbG9uZSBzdHJ1Y3QgaXJ0ZV9mdWxsLiBVc2Ugc21wX3dtYigpLgp2
MzogQXZvaWQgdW5yZWxhdGVkIHR5cGUgY2hhbmdlcyBpbiB1cGRhdGVfaW50cmVtYXBfZW50cnlf
ZnJvbV9pb2FwaWMoKS4KICAgIERyb3AgaXJ0ZV9tb2RlIGVudW0gYW5kIHZhcmlhYmxlLiBDb252
ZXJ0IElOVFJFTUFQX1RBQkxFX09SREVSIGludG8KICAgIGEgc3RhdGljIGhlbHBlci4gQ29tbWVu
dCBiYXJyaWVyKCkgdXNlcy4gU3dpdGNoIGJvb2xlYW4gYml0ZmllbGRzIHRvCiAgICBib29sLgp2
MjogQWRkIGNhc3QgaW4gZ2V0X2Z1bGxfZGVzdCgpLiBSZS1iYXNlIG92ZXIgY2hhbmdlcyBlYXJs
aWVyIGluIHRoZQogICAgc2VyaWVzLiBEb24ndCB1c2UgY21weGNoZzE2Yi4gVXNlIGJhcnJpZXIo
KSBpbnN0ZWFkIG9mIHdtYigpLgotLS0KTm90ZSB0aGF0IEFNRCdzIGRvYyBzYXlzIExvd2VzdCBQ
cmlvcml0eSAoIkFyYml0cmF0ZWQiIGJ5IHRoZWlyIG5hbWluZykKbW9kZSBpcyB1bmF2YWlsYWJs
ZSBpbiB4MkFQSUMgbW9kZSwgYnV0IHRoZXkndmUgY29uZmlybWVkIHRoaXMgdG8gYmUgYQptaXN0
YWtlIG9uIHRoZWlyIHBhcnQuCgotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9t
bXVfaW50ci5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMK
QEAgLTM5LDEyICszOSwzNiBAQCB1bmlvbiBpcnRlMzIgewogICAgIH0gZmxkczsKIH07CiAKK3Vu
aW9uIGlydGUxMjggeworICAgIHVpbnQ2NF90IHJhd1syXTsKKyAgICBzdHJ1Y3QgeworICAgICAg
ICBib29sIHJlbWFwX2VuOjE7CisgICAgICAgIGJvb2wgc3VwX2lvX3BmOjE7CisgICAgICAgIHVu
c2lnbmVkIGludCBpbnRfdHlwZTozOworICAgICAgICBib29sIHJxX2VvaToxOworICAgICAgICBi
b29sIGRtOjE7CisgICAgICAgIGJvb2wgZ3Vlc3RfbW9kZToxOyAvKiBNQlogKi8KKyAgICAgICAg
dW5zaWduZWQgaW50IGRlc3RfbG86MjQ7CisgICAgICAgIHVuc2lnbmVkIGludCA6MzI7CisgICAg
ICAgIHVuc2lnbmVkIGludCB2ZWN0b3I6ODsKKyAgICAgICAgdW5zaWduZWQgaW50IDoyNDsKKyAg
ICAgICAgdW5zaWduZWQgaW50IDoyNDsKKyAgICAgICAgdW5zaWduZWQgaW50IGRlc3RfaGk6ODsK
KyAgICB9IGZ1bGw7Cit9OworCiB1bmlvbiBpcnRlX3B0ciB7CiAgICAgdm9pZCAqcHRyOwogICAg
IHVuaW9uIGlydGUzMiAqcHRyMzI7CisgICAgdW5pb24gaXJ0ZTEyOCAqcHRyMTI4OwogfTsKIAot
I2RlZmluZSBJTlRSRU1BUF9UQUJMRV9PUkRFUiAgICAxCit1bmlvbiBpcnRlX2NwdHIgeworICAg
IGNvbnN0IHZvaWQgKnB0cjsKKyAgICBjb25zdCB1bmlvbiBpcnRlMzIgKnB0cjMyOworICAgIGNv
bnN0IHVuaW9uIGlydGUxMjggKnB0cjEyODsKK30gX190cmFuc3BhcmVudF9fOworCiAjZGVmaW5l
IElOVFJFTUFQX0xFTkdUSCAweEIKICNkZWZpbmUgSU5UUkVNQVBfRU5UUklFUyAoMSA8PCBJTlRS
RU1BUF9MRU5HVEgpCiAKQEAgLTU3LDYgKzgxLDEzIEBAIHVuc2lnbmVkIGludCBucl9pb2FwaWNf
c2JkZjsKIAogc3RhdGljIHZvaWQgZHVtcF9pbnRyZW1hcF90YWJsZXModW5zaWduZWQgY2hhciBr
ZXkpOwogCitzdGF0aWMgdW5zaWduZWQgaW50IF9faW5pdCBpbnRyZW1hcF90YWJsZV9vcmRlcihj
b25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkKK3sKKyAgICByZXR1cm4gaW9tbXUtPmN0cmwu
Z2FfZW4KKyAgICAgICAgICAgPyBnZXRfb3JkZXJfZnJvbV9ieXRlcyhJTlRSRU1BUF9FTlRSSUVT
ICogc2l6ZW9mKHVuaW9uIGlydGUxMjgpKQorICAgICAgICAgICA6IGdldF9vcmRlcl9mcm9tX2J5
dGVzKElOVFJFTUFQX0VOVFJJRVMgKiBzaXplb2YodW5pb24gaXJ0ZTMyKSk7Cit9CisKIHVuc2ln
bmVkIGludCBpb2FwaWNfaWRfdG9faW5kZXgodW5zaWduZWQgaW50IGFwaWNfaWQpCiB7CiAgICAg
dW5zaWduZWQgaW50IGlkeDsKQEAgLTEzMSw3ICsxNjIsMTAgQEAgc3RhdGljIHVuaW9uIGlydGVf
cHRyIGdldF9pbnRyZW1hcF9lbnRyeQogCiAgICAgQVNTRVJUKHRhYmxlLnB0ciAmJiAoaW5kZXgg
PCBJTlRSRU1BUF9FTlRSSUVTKSk7CiAKLSAgICB0YWJsZS5wdHIzMiArPSBpbmRleDsKKyAgICBp
ZiAoIGlvbW11LT5jdHJsLmdhX2VuICkKKyAgICAgICAgdGFibGUucHRyMTI4ICs9IGluZGV4Owor
ICAgIGVsc2UKKyAgICAgICAgdGFibGUucHRyMzIgKz0gaW5kZXg7CiAKICAgICByZXR1cm4gdGFi
bGU7CiB9CkBAIC0xNDEsNyArMTc1LDIyIEBAIHN0YXRpYyB2b2lkIGZyZWVfaW50cmVtYXBfZW50
cnkoY29uc3Qgc3QKIHsKICAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeSA9IGdldF9pbnRyZW1hcF9l
bnRyeShpb21tdSwgYmRmLCBpbmRleCk7CiAKLSAgICBBQ0NFU1NfT05DRShlbnRyeS5wdHIzMi0+
cmF3KSA9IDA7CisgICAgaWYgKCBpb21tdS0+Y3RybC5nYV9lbiApCisgICAgeworICAgICAgICBB
Q0NFU1NfT05DRShlbnRyeS5wdHIxMjgtPnJhd1swXSkgPSAwOworICAgICAgICAvKgorICAgICAg
ICAgKiBMb3cgaGFsZiAoY29udGFpbmluZyBSZW1hcEVuKSBuZWVkcyB0byBiZSBjbGVhcmVkIGZp
cnN0LiAgTm90ZSB0aGF0CisgICAgICAgICAqIHN0cmljdGx5IHNwZWFraW5nIHNtcF93bWIoKSBp
c24ndCBlbm91Z2gsIGFzIGNvbmNlcHR1YWxseSBpdCBleHBhbmRzCisgICAgICAgICAqIHRvIGp1
c3QgYmFycmllcigpIHdoZW4gIUNPTkZJR19TTVAuICBCdXQgd21iKCkgd291bGQgYmUgbW9yZSB0
aGFuIHdlCisgICAgICAgICAqIG5lZWQsIHNpbmNlIHRoZSBJT01NVSBpcyBhIGNhY2hlLWNvaGVy
ZW50IGVudGl0eSBvbiB0aGUgYnVzLiAgQW5kCisgICAgICAgICAqIGdpdmVuIHRoYXQgd2UgZG9u
J3QgYWxsb3cgQ09ORklHX1NNUCB0byBiZSB0dXJuZWQgb2ZmLCB0aGUgU01QCisgICAgICAgICAq
IHZhcmlhbnQgd2lsbCBkby4KKyAgICAgICAgICovCisgICAgICAgIHNtcF93bWIoKTsKKyAgICAg
ICAgZW50cnkucHRyMTI4LT5yYXdbMV0gPSAwOworICAgIH0KKyAgICBlbHNlCisgICAgICAgIEFD
Q0VTU19PTkNFKGVudHJ5LnB0cjMyLT5yYXcpID0gMDsKIAogICAgIF9fY2xlYXJfYml0KGluZGV4
LCBnZXRfaXZyc19tYXBwaW5ncyhpb21tdS0+c2VnKVtiZGZdLmludHJlbWFwX2ludXNlKTsKIH0K
QEAgLTE1MSwxNyArMjAwLDQ0IEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9pbnRyZW1hcF9lbnRyeShj
b25zdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCB2ZWN0
b3IsIHVuc2lnbmVkIGludCBpbnRfdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1bnNpZ25lZCBpbnQgZGVzdF9tb2RlLCB1bnNpZ25lZCBpbnQgZGVzdCkKIHsKLSAgICB1
bmlvbiBpcnRlMzIgaXJ0ZSA9IHsKLSAgICAgICAgLmZsZHMgPSB7Ci0gICAgICAgICAgICAucmVt
YXBfZW4gPSB0cnVlLAotICAgICAgICAgICAgLmludF90eXBlID0gaW50X3R5cGUsCi0gICAgICAg
ICAgICAuZG0gPSBkZXN0X21vZGUsCi0gICAgICAgICAgICAuZGVzdCA9IGRlc3QsCi0gICAgICAg
ICAgICAudmVjdG9yID0gdmVjdG9yLAotICAgICAgICB9LAotICAgIH07CisgICAgaWYgKCBpb21t
dS0+Y3RybC5nYV9lbiApCisgICAgeworICAgICAgICB1bmlvbiBpcnRlMTI4IGlydGUgPSB7Cisg
ICAgICAgICAgICAuZnVsbCA9IHsKKyAgICAgICAgICAgICAgICAucmVtYXBfZW4gPSB0cnVlLAor
ICAgICAgICAgICAgICAgIC5pbnRfdHlwZSA9IGludF90eXBlLAorICAgICAgICAgICAgICAgIC5k
bSA9IGRlc3RfbW9kZSwKKyAgICAgICAgICAgICAgICAuZGVzdF9sbyA9IGRlc3QsCisgICAgICAg
ICAgICAgICAgLmRlc3RfaGkgPSBkZXN0ID4+IDI0LAorICAgICAgICAgICAgICAgIC52ZWN0b3Ig
PSB2ZWN0b3IsCisgICAgICAgICAgICB9LAorICAgICAgICB9OworCisgICAgICAgIEFDQ0VTU19P
TkNFKGVudHJ5LnB0cjEyOC0+cmF3WzBdKSA9IDA7CisgICAgICAgIC8qCisgICAgICAgICAqIExv
dyBoYWxmLCBpbiBwYXJ0aWN1bGFyIFJlbWFwRW4sIG5lZWRzIHRvIGJlIGNsZWFyZWQgZmlyc3Qu
ICBTZWUKKyAgICAgICAgICogY29tbWVudCBpbiBmcmVlX2ludHJlbWFwX2VudHJ5KCkgcmVnYXJk
aW5nIHRoZSBjaG9pY2Ugb2YgYmFycmllci4KKyAgICAgICAgICovCisgICAgICAgIHNtcF93bWIo
KTsKKyAgICAgICAgZW50cnkucHRyMTI4LT5yYXdbMV0gPSBpcnRlLnJhd1sxXTsKKyAgICAgICAg
LyogSGlnaCBoYWxmIG5lZWRzIHRvIGJlIHNldCBiZWZvcmUgbG93IG9uZSAoY29udGFpbmluZyBS
ZW1hcEVuKS4gKi8KKyAgICAgICAgc21wX3dtYigpOworICAgICAgICBBQ0NFU1NfT05DRShlbnRy
eS5wdHIxMjgtPnJhd1swXSkgPSBpcnRlLnJhd1swXTsKKyAgICB9CisgICAgZWxzZQorICAgIHsK
KyAgICAgICAgdW5pb24gaXJ0ZTMyIGlydGUgPSB7CisgICAgICAgICAgICAuZmxkcyA9IHsKKyAg
ICAgICAgICAgICAgICAucmVtYXBfZW4gPSB0cnVlLAorICAgICAgICAgICAgICAgIC5pbnRfdHlw
ZSA9IGludF90eXBlLAorICAgICAgICAgICAgICAgIC5kbSA9IGRlc3RfbW9kZSwKKyAgICAgICAg
ICAgICAgICAuZGVzdCA9IGRlc3QsCisgICAgICAgICAgICAgICAgLnZlY3RvciA9IHZlY3RvciwK
KyAgICAgICAgICAgIH0sCisgICAgICAgIH07CiAKLSAgICBBQ0NFU1NfT05DRShlbnRyeS5wdHIz
Mi0+cmF3KSA9IGlydGUucmF3OworICAgICAgICBBQ0NFU1NfT05DRShlbnRyeS5wdHIzMi0+cmF3
KSA9IGlydGUucmF3OworICAgIH0KIH0KIAogc3RhdGljIGlubGluZSBpbnQgZ2V0X3J0ZV9pbmRl
eChjb25zdCBzdHJ1Y3QgSU9fQVBJQ19yb3V0ZV9lbnRyeSAqcnRlKQpAQCAtMTc1LDYgKzI1MSwx
MSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgc2V0X3J0ZV9pbmRleChzdHJ1Y3QKICAgICBydGUtPmRl
bGl2ZXJ5X21vZGUgPSBvZmZzZXQgPj4gODsKIH0KIAorc3RhdGljIGlubGluZSB1bnNpZ25lZCBp
bnQgZ2V0X2Z1bGxfZGVzdChjb25zdCB1bmlvbiBpcnRlMTI4ICplbnRyeSkKK3sKKyAgICByZXR1
cm4gZW50cnktPmZ1bGwuZGVzdF9sbyB8ICgodW5zaWduZWQgaW50KWVudHJ5LT5mdWxsLmRlc3Rf
aGkgPDwgMjQpOworfQorCiBzdGF0aWMgaW50IHVwZGF0ZV9pbnRyZW1hcF9lbnRyeV9mcm9tX2lv
YXBpYygKICAgICBpbnQgYmRmLAogICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LApAQCAtMTg0
LDEwICsyNjUsMTEgQEAgc3RhdGljIGludCB1cGRhdGVfaW50cmVtYXBfZW50cnlfZnJvbV9pbwog
ewogICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgdW5pb24gaXJ0ZV9wdHIgZW50cnk7Ci0g
ICAgdTggZGVsaXZlcnlfbW9kZSwgZGVzdCwgdmVjdG9yLCBkZXN0X21vZGU7CisgICAgdWludDhf
dCBkZWxpdmVyeV9tb2RlLCB2ZWN0b3IsIGRlc3RfbW9kZTsKICAgICBpbnQgcmVxX2lkOwogICAg
IHNwaW5sb2NrX3QgKmxvY2s7Ci0gICAgdW5zaWduZWQgaW50IG9mZnNldDsKKyAgICB1bnNpZ25l
ZCBpbnQgZGVzdCwgb2Zmc2V0OworICAgIGJvb2wgZnJlc2ggPSBmYWxzZTsKIAogICAgIHJlcV9p
ZCA9IGdldF9pbnRyZW1hcF9yZXF1ZXN0b3JfaWQoaW9tbXUtPnNlZywgYmRmKTsKICAgICBsb2Nr
ID0gZ2V0X2ludHJlbWFwX2xvY2soaW9tbXUtPnNlZywgcmVxX2lkKTsKQEAgLTE5NSw3ICsyNzcs
NyBAQCBzdGF0aWMgaW50IHVwZGF0ZV9pbnRyZW1hcF9lbnRyeV9mcm9tX2lvCiAgICAgZGVsaXZl
cnlfbW9kZSA9IHJ0ZS0+ZGVsaXZlcnlfbW9kZTsKICAgICB2ZWN0b3IgPSBydGUtPnZlY3RvcjsK
ICAgICBkZXN0X21vZGUgPSBydGUtPmRlc3RfbW9kZTsKLSAgICBkZXN0ID0gcnRlLT5kZXN0Lmxv
Z2ljYWwubG9naWNhbF9kZXN0OworICAgIGRlc3QgPSB4MmFwaWNfZW5hYmxlZCA/IHJ0ZS0+ZGVz
dC5kZXN0MzIgOiBydGUtPmRlc3QubG9naWNhbC5sb2dpY2FsX2Rlc3Q7CiAKICAgICBzcGluX2xv
Y2tfaXJxc2F2ZShsb2NrLCBmbGFncyk7CiAKQEAgLTIxMCwyNSArMjkyLDQwIEBAIHN0YXRpYyBp
bnQgdXBkYXRlX2ludHJlbWFwX2VudHJ5X2Zyb21faW8KICAgICAgICAgICAgIHJldHVybiAtRU5P
U1BDOwogICAgICAgICB9CiAgICAgICAgICppbmRleCA9IG9mZnNldDsKLSAgICAgICAgbG9fdXBk
YXRlID0gMTsKKyAgICAgICAgZnJlc2ggPSB0cnVlOwogICAgIH0KIAogICAgIGVudHJ5ID0gZ2V0
X2ludHJlbWFwX2VudHJ5KGlvbW11LCByZXFfaWQsIG9mZnNldCk7Ci0gICAgaWYgKCAhbG9fdXBk
YXRlICkKKyAgICBpZiAoIGZyZXNoICkKKyAgICAgICAgLyogbm90aGluZyAqLzsKKyAgICBlbHNl
IGlmICggIWxvX3VwZGF0ZSApCiAgICAgewogICAgICAgICAvKgogICAgICAgICAgKiBMb3cgaGFs
ZiBvZiBpbmNvbWluZyBSVEUgaXMgYWxyZWFkeSBpbiByZW1hcHBlZCBmb3JtYXQsCiAgICAgICAg
ICAqIHNvIG5lZWQgdG8gcmVjb3ZlciB2ZWN0b3IgYW5kIGRlbGl2ZXJ5IG1vZGUgZnJvbSBJUlRF
LgogICAgICAgICAgKi8KICAgICAgICAgQVNTRVJUKGdldF9ydGVfaW5kZXgocnRlKSA9PSBvZmZz
ZXQpOwotICAgICAgICB2ZWN0b3IgPSBlbnRyeS5wdHIzMi0+Zmxkcy52ZWN0b3I7CisgICAgICAg
IGlmICggaW9tbXUtPmN0cmwuZ2FfZW4gKQorICAgICAgICAgICAgdmVjdG9yID0gZW50cnkucHRy
MTI4LT5mdWxsLnZlY3RvcjsKKyAgICAgICAgZWxzZQorICAgICAgICAgICAgdmVjdG9yID0gZW50
cnkucHRyMzItPmZsZHMudmVjdG9yOworICAgICAgICAvKiBUaGUgSW50VHlwZSBmaWVsZHMgbWF0
Y2ggZm9yIGJvdGggZm9ybWF0cy4gKi8KICAgICAgICAgZGVsaXZlcnlfbW9kZSA9IGVudHJ5LnB0
cjMyLT5mbGRzLmludF90eXBlOwogICAgIH0KKyAgICBlbHNlIGlmICggeDJhcGljX2VuYWJsZWQg
KQorICAgIHsKKyAgICAgICAgLyoKKyAgICAgICAgICogSGlnaCBoYWxmIG9mIGluY29taW5nIFJU
RSB3YXMgcmVhZCBmcm9tIHRoZSBJL08gQVBJQyBhbmQgaGVuY2UgbWF5CisgICAgICAgICAqIG5v
dCBob2xkIHRoZSBmdWxsIGRlc3RpbmF0aW9uLCBzbyBuZWVkIHRvIHJlY292ZXIgZnVsbCBkZXN0
aW5hdGlvbgorICAgICAgICAgKiBmcm9tIElSVEUuCisgICAgICAgICAqLworICAgICAgICBkZXN0
ID0gZ2V0X2Z1bGxfZGVzdChlbnRyeS5wdHIxMjgpOworICAgIH0KICAgICB1cGRhdGVfaW50cmVt
YXBfZW50cnkoaW9tbXUsIGVudHJ5LCB2ZWN0b3IsIGRlbGl2ZXJ5X21vZGUsIGRlc3RfbW9kZSwg
ZGVzdCk7CiAKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKGxvY2ssIGZsYWdzKTsKIAotICAg
IGlmICggaW9tbXUtPmVuYWJsZWQgKQorICAgIGlmICggaW9tbXUtPmVuYWJsZWQgJiYgIWZyZXNo
ICkKICAgICB7CiAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3Mp
OwogICAgICAgICBhbWRfaW9tbXVfZmx1c2hfaW50cmVtYXAoaW9tbXUsIHJlcV9pZCk7CkBAIC0y
ODYsNiArMzgzLDE4IEBAIGludCBfX2luaXQgYW1kX2lvbW11X3NldHVwX2lvYXBpY19yZW1hcHAK
ICAgICAgICAgICAgIGRlc3RfbW9kZSA9IHJ0ZS5kZXN0X21vZGU7CiAgICAgICAgICAgICBkZXN0
ID0gcnRlLmRlc3QubG9naWNhbC5sb2dpY2FsX2Rlc3Q7CiAKKyAgICAgICAgICAgIGlmICggaW9t
bXUtPmN0cmwueHRfZW4gKQorICAgICAgICAgICAgeworICAgICAgICAgICAgICAgIC8qCisgICAg
ICAgICAgICAgICAgICogSW4geDJBUElDIG1vZGUgd2UgaGF2ZSBubyB3YXkgb2YgZGlzY292ZXJp
bmcgdGhlIGhpZ2ggMjQKKyAgICAgICAgICAgICAgICAgKiBiaXRzIG9mIHRoZSBkZXN0aW5hdGlv
biBvZiBhbiBhbHJlYWR5IGVuYWJsZWQgaW50ZXJydXB0LgorICAgICAgICAgICAgICAgICAqIFdl
IGNvbWUgaGVyZSBlYXJsaWVyIHRoYW4gZm9yIHhBUElDIG1vZGUsIHNvIG5vIGludGVycnVwdHMK
KyAgICAgICAgICAgICAgICAgKiBzaG91bGQgaGF2ZSBiZWVuIHNldCB1cCBiZWZvcmUuCisgICAg
ICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJVbm1hc2tl
ZCBJTy1BUElDIyV1IGVudHJ5ICV1IGluIHgyQVBJQyBtb2RlXG4iLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBJT19BUElDX0lEKGFwaWMpLCBwaW4pOworICAgICAgICAgICAgfQor
CiAgICAgICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZShsb2NrLCBmbGFncyk7CiAgICAgICAgICAg
ICBvZmZzZXQgPSBhbGxvY19pbnRyZW1hcF9lbnRyeShzZWcsIHJlcV9pZCwgMSk7CiAgICAgICAg
ICAgICBCVUdfT04ob2Zmc2V0ID49IElOVFJFTUFQX0VOVFJJRVMpOwpAQCAtMzIwLDcgKzQyOSw4
IEBAIHZvaWQgYW1kX2lvbW11X2lvYXBpY191cGRhdGVfaXJlKAogICAgIHN0cnVjdCBJT19BUElD
X3JvdXRlX2VudHJ5IG5ld19ydGUgPSB7IDAgfTsKICAgICB1bnNpZ25lZCBpbnQgcnRlX2xvID0g
KHJlZyAmIDEpID8gcmVnIC0gMSA6IHJlZzsKICAgICB1bnNpZ25lZCBpbnQgcGluID0gKHJlZyAt
IDB4MTApIC8gMjsKLSAgICBpbnQgc2F2ZWRfbWFzaywgc2VnLCBiZGYsIHJjOworICAgIGludCBz
ZWcsIGJkZiwgcmM7CisgICAgYm9vbCBzYXZlZF9tYXNrLCBmcmVzaCA9IGZhbHNlOwogICAgIHN0
cnVjdCBhbWRfaW9tbXUgKmlvbW11OwogICAgIHVuc2lnbmVkIGludCBpZHg7CiAKQEAgLTM2Miwx
MiArNDcyLDIyIEBAIHZvaWQgYW1kX2lvbW11X2lvYXBpY191cGRhdGVfaXJlKAogICAgICAgICAq
KCgodTMyICopJm5ld19ydGUpICsgMSkgPSB2YWx1ZTsKICAgICB9CiAKLSAgICBpZiAoIG5ld19y
dGUubWFzayAmJgotICAgICAgICAgaW9hcGljX3NiZGZbaWR4XS5waW5fMl9pZHhbcGluXSA+PSBJ
TlRSRU1BUF9FTlRSSUVTICkKKyAgICBpZiAoIGlvYXBpY19zYmRmW2lkeF0ucGluXzJfaWR4W3Bp
bl0gPj0gSU5UUkVNQVBfRU5UUklFUyApCiAgICAgewogICAgICAgICBBU1NFUlQoc2F2ZWRfbWFz
ayk7Ci0gICAgICAgIF9faW9fYXBpY193cml0ZShhcGljLCByZWcsIHZhbHVlKTsKLSAgICAgICAg
cmV0dXJuOworCisgICAgICAgIC8qCisgICAgICAgICAqIFRoZXJlJ3Mgbm93aGVyZSBleGNlcHQg
dGhlIElSVEUgdG8gc3RvcmUgYSBmdWxsIDMyLWJpdCBkZXN0aW5hdGlvbiwKKyAgICAgICAgICog
c28gd2UgbWF5IG5vdCBieXBhc3MgZW50cnkgYWxsb2NhdGlvbiBhbmQgdXBkYXRpbmcgb2YgdGhl
IGxvdyBSVEUKKyAgICAgICAgICogaGFsZiBpbiB0aGUgKHVzdWFsKSBjYXNlIG9mIHRoZSBoaWdo
IFJURSBoYWxmIGdldHRpbmcgd3JpdHRlbiBmaXJzdC4KKyAgICAgICAgICovCisgICAgICAgIGlm
ICggbmV3X3J0ZS5tYXNrICYmICF4MmFwaWNfZW5hYmxlZCApCisgICAgICAgIHsKKyAgICAgICAg
ICAgIF9faW9fYXBpY193cml0ZShhcGljLCByZWcsIHZhbHVlKTsKKyAgICAgICAgICAgIHJldHVy
bjsKKyAgICAgICAgfQorCisgICAgICAgIGZyZXNoID0gdHJ1ZTsKICAgICB9CiAKICAgICAvKiBt
YXNrIHRoZSBpbnRlcnJ1cHQgd2hpbGUgd2UgY2hhbmdlIHRoZSBpbnRyZW1hcCB0YWJsZSAqLwpA
QCAtMzk2LDggKzUxNiwxMiBAQCB2b2lkIGFtZF9pb21tdV9pb2FwaWNfdXBkYXRlX2lyZSgKICAg
ICBpZiAoIHJlZyA9PSBydGVfbG8gKQogICAgICAgICByZXR1cm47CiAKLSAgICAvKiB1bm1hc2sg
dGhlIGludGVycnVwdCBhZnRlciB3ZSBoYXZlIHVwZGF0ZWQgdGhlIGludHJlbWFwIHRhYmxlICov
Ci0gICAgaWYgKCAhc2F2ZWRfbWFzayApCisgICAgLyoKKyAgICAgKiBVbm1hc2sgdGhlIGludGVy
cnVwdCBhZnRlciB3ZSBoYXZlIHVwZGF0ZWQgdGhlIGludHJlbWFwIHRhYmxlLiBBbHNvCisgICAg
ICogd3JpdGUgdGhlIGxvdyBoYWxmIGlmIGEgZnJlc2ggZW50cnkgd2FzIGFsbG9jYXRlZCBmb3Ig
YSBoaWdoIGhhbGYKKyAgICAgKiB1cGRhdGUgaW4geDJBUElDIG1vZGUuCisgICAgICovCisgICAg
aWYgKCAhc2F2ZWRfbWFzayB8fCAoeDJhcGljX2VuYWJsZWQgJiYgZnJlc2gpICkKICAgICB7CiAg
ICAgICAgIG9sZF9ydGUubWFzayA9IHNhdmVkX21hc2s7CiAgICAgICAgIF9faW9fYXBpY193cml0
ZShhcGljLCBydGVfbG8sICooKHUzMiAqKSZvbGRfcnRlKSk7CkBAIC00MTEsMzEgKzUzNSw0MCBA
QCB1bnNpZ25lZCBpbnQgYW1kX2lvbW11X3JlYWRfaW9hcGljX2Zyb21fCiAgICAgdW5zaWduZWQg
aW50IG9mZnNldDsKICAgICB1bnNpZ25lZCBpbnQgdmFsID0gX19pb19hcGljX3JlYWQoYXBpYywg
cmVnKTsKICAgICB1bnNpZ25lZCBpbnQgcGluID0gKHJlZyAtIDB4MTApIC8gMjsKKyAgICB1aW50
MTZfdCBzZWcsIGJkZiwgcmVxX2lkOworICAgIGNvbnN0IHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11
OworICAgIHVuaW9uIGlydGVfcHRyIGVudHJ5OwogCiAgICAgaWR4ID0gaW9hcGljX2lkX3RvX2lu
ZGV4KElPX0FQSUNfSUQoYXBpYykpOwogICAgIGlmICggaWR4ID09IE1BWF9JT19BUElDUyApCiAg
ICAgICAgIHJldHVybiB2YWw7CiAKICAgICBvZmZzZXQgPSBpb2FwaWNfc2JkZltpZHhdLnBpbl8y
X2lkeFtwaW5dOworICAgIGlmICggb2Zmc2V0ID49IElOVFJFTUFQX0VOVFJJRVMgKQorICAgICAg
ICByZXR1cm4gdmFsOwogCi0gICAgaWYgKCAhKHJlZyAmIDEpICYmIG9mZnNldCA8IElOVFJFTUFQ
X0VOVFJJRVMgKQotICAgIHsKLSAgICAgICAgdTE2IGJkZiA9IGlvYXBpY19zYmRmW2lkeF0uYmRm
OwotICAgICAgICB1MTYgc2VnID0gaW9hcGljX3NiZGZbaWR4XS5zZWc7Ci0gICAgICAgIHUxNiBy
ZXFfaWQgPSBnZXRfaW50cmVtYXBfcmVxdWVzdG9yX2lkKHNlZywgYmRmKTsKLSAgICAgICAgY29u
c3Qgc3RydWN0IGFtZF9pb21tdSAqaW9tbXUgPSBmaW5kX2lvbW11X2Zvcl9kZXZpY2Uoc2VnLCBi
ZGYpOwotICAgICAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeTsKKyAgICBzZWcgPSBpb2FwaWNfc2Jk
ZltpZHhdLnNlZzsKKyAgICBiZGYgPSBpb2FwaWNfc2JkZltpZHhdLmJkZjsKKyAgICBpb21tdSA9
IGZpbmRfaW9tbXVfZm9yX2RldmljZShzZWcsIGJkZik7CisgICAgaWYgKCAhaW9tbXUgKQorICAg
ICAgICByZXR1cm4gdmFsOworICAgIHJlcV9pZCA9IGdldF9pbnRyZW1hcF9yZXF1ZXN0b3JfaWQo
c2VnLCBiZGYpOworICAgIGVudHJ5ID0gZ2V0X2ludHJlbWFwX2VudHJ5KGlvbW11LCByZXFfaWQs
IG9mZnNldCk7CiAKLSAgICAgICAgaWYgKCAhaW9tbXUgKQotICAgICAgICAgICAgcmV0dXJuIHZh
bDsKKyAgICBpZiAoICEocmVnICYgMSkgKQorICAgIHsKICAgICAgICAgQVNTRVJUKG9mZnNldCA9
PSAodmFsICYgKElOVFJFTUFQX0VOVFJJRVMgLSAxKSkpOwotICAgICAgICBlbnRyeSA9IGdldF9p
bnRyZW1hcF9lbnRyeShpb21tdSwgcmVxX2lkLCBvZmZzZXQpOwogICAgICAgICB2YWwgJj0gfihJ
TlRSRU1BUF9FTlRSSUVTIC0gMSk7CisgICAgICAgIC8qIFRoZSBJbnRUeXBlIGZpZWxkcyBtYXRj
aCBmb3IgYm90aCBmb3JtYXRzLiAqLwogICAgICAgICB2YWwgfD0gTUFTS19JTlNSKGVudHJ5LnB0
cjMyLT5mbGRzLmludF90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgIElPX0FQSUNfUkVE
SVJfREVMSVZfTU9ERV9NQVNLKTsKLSAgICAgICAgdmFsIHw9IE1BU0tfSU5TUihlbnRyeS5wdHIz
Mi0+Zmxkcy52ZWN0b3IsCisgICAgICAgIHZhbCB8PSBNQVNLX0lOU1IoaW9tbXUtPmN0cmwuZ2Ff
ZW4KKyAgICAgICAgICAgICAgICAgICAgICAgICA/IGVudHJ5LnB0cjEyOC0+ZnVsbC52ZWN0b3IK
KyAgICAgICAgICAgICAgICAgICAgICAgICA6IGVudHJ5LnB0cjMyLT5mbGRzLnZlY3RvciwKICAg
ICAgICAgICAgICAgICAgICAgICAgICBJT19BUElDX1JFRElSX1ZFQ1RPUl9NQVNLKTsKICAgICB9
CisgICAgZWxzZSBpZiAoIHgyYXBpY19lbmFibGVkICkKKyAgICAgICAgdmFsID0gZ2V0X2Z1bGxf
ZGVzdChlbnRyeS5wdHIxMjgpOwogCiAgICAgcmV0dXJuIHZhbDsKIH0KQEAgLTQ0Nyw5ICs1ODAs
OSBAQCBzdGF0aWMgaW50IHVwZGF0ZV9pbnRyZW1hcF9lbnRyeV9mcm9tX21zCiAgICAgdW5zaWdu
ZWQgbG9uZyBmbGFnczsKICAgICB1bmlvbiBpcnRlX3B0ciBlbnRyeTsKICAgICB1MTYgcmVxX2lk
LCBhbGlhc19pZDsKLSAgICB1OCBkZWxpdmVyeV9tb2RlLCBkZXN0LCB2ZWN0b3IsIGRlc3RfbW9k
ZTsKKyAgICB1aW50OF90IGRlbGl2ZXJ5X21vZGUsIHZlY3RvciwgZGVzdF9tb2RlOwogICAgIHNw
aW5sb2NrX3QgKmxvY2s7Ci0gICAgdW5zaWduZWQgaW50IG9mZnNldCwgaTsKKyAgICB1bnNpZ25l
ZCBpbnQgZGVzdCwgb2Zmc2V0LCBpOwogCiAgICAgcmVxX2lkID0gZ2V0X2RtYV9yZXF1ZXN0b3Jf
aWQoaW9tbXUtPnNlZywgYmRmKTsKICAgICBhbGlhc19pZCA9IGdldF9pbnRyZW1hcF9yZXF1ZXN0
b3JfaWQoaW9tbXUtPnNlZywgYmRmKTsKQEAgLTQ3MCw3ICs2MDMsMTIgQEAgc3RhdGljIGludCB1
cGRhdGVfaW50cmVtYXBfZW50cnlfZnJvbV9tcwogICAgIGRlc3RfbW9kZSA9IChtc2ctPmFkZHJl
c3NfbG8gPj4gTVNJX0FERFJfREVTVE1PREVfU0hJRlQpICYgMHgxOwogICAgIGRlbGl2ZXJ5X21v
ZGUgPSAobXNnLT5kYXRhID4+IE1TSV9EQVRBX0RFTElWRVJZX01PREVfU0hJRlQpICYgMHgxOwog
ICAgIHZlY3RvciA9IChtc2ctPmRhdGEgPj4gTVNJX0RBVEFfVkVDVE9SX1NISUZUKSAmIE1TSV9E
QVRBX1ZFQ1RPUl9NQVNLOwotICAgIGRlc3QgPSAobXNnLT5hZGRyZXNzX2xvID4+IE1TSV9BRERS
X0RFU1RfSURfU0hJRlQpICYgMHhmZjsKKworICAgIGlmICggeDJhcGljX2VuYWJsZWQgKQorICAg
ICAgICBkZXN0ID0gbXNnLT5kZXN0MzI7CisgICAgZWxzZQorICAgICAgICBkZXN0ID0gTUFTS19F
WFRSKG1zZy0+YWRkcmVzc19sbywgTVNJX0FERFJfREVTVF9JRF9NQVNLKTsKKwogICAgIG9mZnNl
dCA9ICpyZW1hcF9pbmRleDsKICAgICBpZiAoIG9mZnNldCA+PSBJTlRSRU1BUF9FTlRSSUVTICkK
ICAgICB7CkBAIC02MTYsMTAgKzc1NCwyMSBAQCB2b2lkIGFtZF9pb21tdV9yZWFkX21zaV9mcm9t
X2lyZSgKICAgICB9CiAKICAgICBtc2ctPmRhdGEgJj0gfihJTlRSRU1BUF9FTlRSSUVTIC0gMSk7
CisgICAgLyogVGhlIEludFR5cGUgZmllbGRzIG1hdGNoIGZvciBib3RoIGZvcm1hdHMuICovCiAg
ICAgbXNnLT5kYXRhIHw9IE1BU0tfSU5TUihlbnRyeS5wdHIzMi0+Zmxkcy5pbnRfdHlwZSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIE1TSV9EQVRBX0RFTElWRVJZX01PREVfTUFTSyk7Ci0g
ICAgbXNnLT5kYXRhIHw9IE1BU0tfSU5TUihlbnRyeS5wdHIzMi0+Zmxkcy52ZWN0b3IsCi0gICAg
ICAgICAgICAgICAgICAgICAgICAgICBNU0lfREFUQV9WRUNUT1JfTUFTSyk7CisgICAgaWYgKCBp
b21tdS0+Y3RybC5nYV9lbiApCisgICAgeworICAgICAgICBtc2ctPmRhdGEgfD0gTUFTS19JTlNS
KGVudHJ5LnB0cjEyOC0+ZnVsbC52ZWN0b3IsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgTVNJX0RBVEFfVkVDVE9SX01BU0spOworICAgICAgICBtc2ctPmRlc3QzMiA9IGdldF9mdWxs
X2Rlc3QoZW50cnkucHRyMTI4KTsKKyAgICB9CisgICAgZWxzZQorICAgIHsKKyAgICAgICAgbXNn
LT5kYXRhIHw9IE1BU0tfSU5TUihlbnRyeS5wdHIzMi0+Zmxkcy52ZWN0b3IsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgTVNJX0RBVEFfVkVDVE9SX01BU0spOworICAgICAgICBtc2ct
PmRlc3QzMiA9IGVudHJ5LnB0cjMyLT5mbGRzLmRlc3Q7CisgICAgfQogfQogCiBpbnQgX19pbml0
IGFtZF9pb21tdV9mcmVlX2ludHJlbWFwX3RhYmxlKApAQCAtNjMxLDcgKzc4MCw3IEBAIGludCBf
X2luaXQgYW1kX2lvbW11X2ZyZWVfaW50cmVtYXBfdGFibGUKIAogICAgIGlmICggdGIgKQogICAg
IHsKLSAgICAgICAgX19mcmVlX2FtZF9pb21tdV90YWJsZXModGIsIElOVFJFTUFQX1RBQkxFX09S
REVSKTsKKyAgICAgICAgX19mcmVlX2FtZF9pb21tdV90YWJsZXModGIsIGludHJlbWFwX3RhYmxl
X29yZGVyKGlvbW11KSk7CiAgICAgICAgIGl2cnNfbWFwcGluZy0+aW50cmVtYXBfdGFibGUgPSBO
VUxMOwogICAgIH0KIApAQCAtNjQxLDEwICs3OTAsMTAgQEAgaW50IF9faW5pdCBhbWRfaW9tbXVf
ZnJlZV9pbnRyZW1hcF90YWJsZQogdm9pZCAqX19pbml0IGFtZF9pb21tdV9hbGxvY19pbnRyZW1h
cF90YWJsZSgKICAgICBjb25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwgdW5zaWduZWQgbG9u
ZyAqKmludXNlX21hcCkKIHsKLSAgICB2b2lkICp0YjsKLSAgICB0YiA9IF9fYWxsb2NfYW1kX2lv
bW11X3RhYmxlcyhJTlRSRU1BUF9UQUJMRV9PUkRFUik7CisgICAgdm9pZCAqdGIgPSBfX2FsbG9j
X2FtZF9pb21tdV90YWJsZXMoaW50cmVtYXBfdGFibGVfb3JkZXIoaW9tbXUpKTsKKwogICAgIEJV
R19PTih0YiA9PSBOVUxMKTsKLSAgICBtZW1zZXQodGIsIDAsIFBBR0VfU0laRSAqICgxVUwgPDwg
SU5UUkVNQVBfVEFCTEVfT1JERVIpKTsKKyAgICBtZW1zZXQodGIsIDAsIFBBR0VfU0laRSA8PCBp
bnRyZW1hcF90YWJsZV9vcmRlcihpb21tdSkpOwogICAgICppbnVzZV9tYXAgPSB4emFsbG9jX2Fy
cmF5KHVuc2lnbmVkIGxvbmcsIEJJVFNfVE9fTE9OR1MoSU5UUkVNQVBfRU5UUklFUykpOwogICAg
IEJVR19PTigqaW51c2VfbWFwID09IE5VTEwpOwogICAgIHJldHVybiB0YjsKQEAgLTY4NSwxOCAr
ODM0LDI5IEBAIGludCBfX2luaXQgYW1kX3NldHVwX2hwZXRfbXNpKHN0cnVjdCBtc2kKICAgICBy
ZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyB2b2lkIGR1bXBfaW50cmVtYXBfdGFibGUoY29uc3QgdTMy
ICp0YWJsZSkKK3N0YXRpYyB2b2lkIGR1bXBfaW50cmVtYXBfdGFibGUoY29uc3Qgc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaW9uIGly
dGVfY3B0ciB0YmwpCiB7Ci0gICAgdTMyIGNvdW50OworICAgIHVuc2lnbmVkIGludCBjb3VudDsK
IAotICAgIGlmICggIXRhYmxlICkKKyAgICBpZiAoICF0YmwucHRyICkKICAgICAgICAgcmV0dXJu
OwogCiAgICAgZm9yICggY291bnQgPSAwOyBjb3VudCA8IElOVFJFTUFQX0VOVFJJRVM7IGNvdW50
KysgKQogICAgIHsKLSAgICAgICAgaWYgKCAhdGFibGVbY291bnRdICkKLSAgICAgICAgICAgIGNv
bnRpbnVlOwotICAgICAgICBwcmludGsoIiAgICBJUlRFWyUwM3hdICUwOHhcbiIsIGNvdW50LCB0
YWJsZVtjb3VudF0pOworICAgICAgICBpZiAoIGlvbW11LT5jdHJsLmdhX2VuICkKKyAgICAgICAg
eworICAgICAgICAgICAgaWYgKCAhdGJsLnB0cjEyOFtjb3VudF0ucmF3WzBdICYmICF0YmwucHRy
MTI4W2NvdW50XS5yYXdbMV0gKQorICAgICAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICAg
ICAgcHJpbnRrKCIgICAgSVJURVslMDN4XSAlMDE2bHhfJTAxNmx4XG4iLAorICAgICAgICAgICAg
ICAgICAgIGNvdW50LCB0YmwucHRyMTI4W2NvdW50XS5yYXdbMV0sIHRibC5wdHIxMjhbY291bnRd
LnJhd1swXSk7CisgICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICB7CisgICAgICAgICAg
ICBpZiAoICF0YmwucHRyMzJbY291bnRdLnJhdyApCisgICAgICAgICAgICAgICAgY29udGludWU7
CisgICAgICAgICAgICBwcmludGsoIiAgICBJUlRFWyUwM3hdICUwOHhcbiIsIGNvdW50LCB0Ymwu
cHRyMzJbY291bnRdLnJhdyk7CisgICAgICAgIH0KICAgICB9CiB9CiAKQEAgLTcxNCw3ICs4NzQs
NyBAQCBzdGF0aWMgaW50IGR1bXBfaW50cmVtYXBfbWFwcGluZyhjb25zdCBzCiAgICAgICAgICAg
IFBDSV9GVU5DKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCkpOwogCiAgICAgc3Bpbl9s
b2NrX2lycXNhdmUoJihpdnJzX21hcHBpbmctPmludHJlbWFwX2xvY2spLCBmbGFncyk7Ci0gICAg
ZHVtcF9pbnRyZW1hcF90YWJsZShpdnJzX21hcHBpbmctPmludHJlbWFwX3RhYmxlKTsKKyAgICBk
dW1wX2ludHJlbWFwX3RhYmxlKGlvbW11LCBpdnJzX21hcHBpbmctPmludHJlbWFwX3RhYmxlKTsK
ICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCYoaXZyc19tYXBwaW5nLT5pbnRyZW1hcF9sb2Nr
KSwgZmxhZ3MpOwogCiAgICAgcHJvY2Vzc19wZW5kaW5nX3NvZnRpcnFzKCk7CkBAIC03MzMsNiAr
ODkzLDggQEAgc3RhdGljIHZvaWQgZHVtcF9pbnRyZW1hcF90YWJsZXModW5zaWduZQogICAgIHBy
aW50aygiLS0tIER1bXBpbmcgU2hhcmVkIElPTU1VIEludGVycnVwdCBSZW1hcHBpbmcgVGFibGUg
LS0tXG4iKTsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZzaGFyZWRfaW50cmVtYXBfbG9jaywg
ZmxhZ3MpOwotICAgIGR1bXBfaW50cmVtYXBfdGFibGUoc2hhcmVkX2ludHJlbWFwX3RhYmxlKTsK
KyAgICBkdW1wX2ludHJlbWFwX3RhYmxlKGxpc3RfZmlyc3RfZW50cnkoJmFtZF9pb21tdV9oZWFk
LCBzdHJ1Y3QgYW1kX2lvbW11LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBsaXN0KSwKKyAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZF9pbnRyZW1hcF90YWJs
ZSk7CiAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmc2hhcmVkX2ludHJlbWFwX2xvY2ssIGZs
YWdzKTsKIH0K

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="06-AMD-IOMMU-split-init-one.patch"
Content-Description: 06-AMD-IOMMU-split-init-one.patch
Content-Disposition: attachment;
	filename="06-AMD-IOMMU-split-init-one.patch"; size=1647;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <6A5581D5BFDC474D8D3D4DF410D32822@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBzcGxpdCBhbWRfaW9tbXVfaW5pdF9vbmUoKQoKTWFwcGluZyB0aGUgTU1JTyBz
cGFjZSBhbmQgb2J0YWluaW5nIGZlYXR1cmUgaW5mb3JtYXRpb24gbmVlZHMgdG8gaGFwcGVuCnNs
aWdodGx5IGVhcmxpZXIsIHN1Y2ggdGhhdCBmb3IgeDJBUElDIHN1cHBvcnQgd2UgY2FuIHNldCBY
VEVuIHByaW9yIHRvCmNhbGxpbmcgYW1kX2lvbW11X3VwZGF0ZV9pdnJzX21hcHBpbmdfYWNwaSgp
IGFuZAphbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFwcGluZygpLgoKU2lnbmVkLW9mZi1ieTog
SmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdlZC1ieTogQW5kcmV3IENvb3Bl
ciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEJyaWFuIFdvb2RzIDxicmlh
bi53b29kc0BhbWQuY29tPgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfaW5pdC5jCkBA
IC05NjksMTQgKzk2OSw2IEBAIHN0YXRpYyB2b2lkICogX19pbml0IGFsbG9jYXRlX3Bwcl9sb2co
c3QKIAogc3RhdGljIGludCBfX2luaXQgYW1kX2lvbW11X2luaXRfb25lKHN0cnVjdCBhbWRfaW9t
bXUgKmlvbW11KQogewotICAgIGlmICggbWFwX2lvbW11X21taW9fcmVnaW9uKGlvbW11KSAhPSAw
ICkKLSAgICAgICAgZ290byBlcnJvcl9vdXQ7Ci0KLSAgICBnZXRfaW9tbXVfZmVhdHVyZXMoaW9t
bXUpOwotCi0gICAgaWYgKCBpb21tdS0+ZmVhdHVyZXMucmF3ICkKLSAgICAgICAgaW9tbXV2Ml9l
bmFibGVkID0gMTsKLQogICAgIGlmICggYWxsb2NhdGVfY21kX2J1ZmZlcihpb21tdSkgPT0gTlVM
TCApCiAgICAgICAgIGdvdG8gZXJyb3Jfb3V0OwogCkBAIC0xMjAxLDYgKzExOTMsMjMgQEAgc3Rh
dGljIGJvb2xfdCBfX2luaXQgYW1kX3NwNTEwMF9lcnJhdHVtMgogICAgIHJldHVybiAwOwogfQog
CitzdGF0aWMgaW50IF9faW5pdCBhbWRfaW9tbXVfcHJlcGFyZV9vbmUoc3RydWN0IGFtZF9pb21t
dSAqaW9tbXUpCit7CisgICAgaW50IHJjID0gYWxsb2NfaXZyc19tYXBwaW5ncyhpb21tdS0+c2Vn
KTsKKworICAgIGlmICggIXJjICkKKyAgICAgICAgcmMgPSBtYXBfaW9tbXVfbW1pb19yZWdpb24o
aW9tbXUpOworICAgIGlmICggcmMgKQorICAgICAgICByZXR1cm4gcmM7CisKKyAgICBnZXRfaW9t
bXVfZmVhdHVyZXMoaW9tbXUpOworCisgICAgaWYgKCBpb21tdS0+ZmVhdHVyZXMucmF3ICkKKyAg
ICAgICAgaW9tbXV2Ml9lbmFibGVkID0gdHJ1ZTsKKworICAgIHJldHVybiAwOworfQorCiBpbnQg
X19pbml0IGFtZF9pb21tdV9pbml0KHZvaWQpCiB7CiAgICAgc3RydWN0IGFtZF9pb21tdSAqaW9t
bXU7CkBAIC0xMjMxLDcgKzEyNDAsNyBAQCBpbnQgX19pbml0IGFtZF9pb21tdV9pbml0KHZvaWQp
CiAgICAgcmFkaXhfdHJlZV9pbml0KCZpdnJzX21hcHMpOwogICAgIGZvcl9lYWNoX2FtZF9pb21t
dSAoIGlvbW11ICkKICAgICB7Ci0gICAgICAgIHJjID0gYWxsb2NfaXZyc19tYXBwaW5ncyhpb21t
dS0+c2VnKTsKKyAgICAgICAgcmMgPSBhbWRfaW9tbXVfcHJlcGFyZV9vbmUoaW9tbXUpOwogICAg
ICAgICBpZiAoIHJjICkKICAgICAgICAgICAgIGdvdG8gZXJyb3Jfb3V0OwogICAgIH0K

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="07-AMD-IOMMU-enable-no-IRQ.patch"
Content-Description: 07-AMD-IOMMU-enable-no-IRQ.patch
Content-Disposition: attachment;
	filename="07-AMD-IOMMU-enable-no-IRQ.patch"; size=1874;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <3BCB8C3AAC39C342B577110D8BFCCA1D@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBhbGxvdyBlbmFibGluZyB3aXRoIElSUSBub3QgeWV0IHNldCB1cAoKRWFybHkg
ZW5hYmxpbmcgKHRvIGVudGVyIHgyQVBJQyBtb2RlKSByZXF1aXJlcyBkZWZlcnJpbmcgb2YgdGhl
IElSUQpzZXR1cC4gQ29kZSB0byBhY3R1YWxseSBkbyB0aGF0IHNldHVwIGluIHRoZSB4MkFQSUMg
Y2FzZSB3aWxsIGdldCBhZGRlZApzdWJzZXF1ZW50bHkuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1
bGljaCA8amJldWxpY2hAc3VzZS5jb20+CkFja2VkLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcu
Y29vcGVyM0BjaXRyaXguY29tPgpBY2tlZC1ieTogQnJpYW4gV29vZHMgPGJyaWFuLndvb2RzQGFt
ZC5jb20+Ci0tLQp2MzogUmUtYmFzZS4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdV9pbml0LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2lu
aXQuYwpAQCAtODEzLDcgKzgxMyw2IEBAIHN0YXRpYyB2b2lkIGFtZF9pb21tdV9lcnJhdHVtXzc0
Nl93b3JrYXIKIHN0YXRpYyB2b2lkIGVuYWJsZV9pb21tdShzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dSkKIHsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwotICAgIHN0cnVjdCBpcnFfZGVzYyAqZGVz
YzsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+bG9jaywgZmxhZ3MpOwogCkBAIC04
MzMsMTkgKzgzMiwyNyBAQCBzdGF0aWMgdm9pZCBlbmFibGVfaW9tbXUoc3RydWN0IGFtZF9pb21t
CiAgICAgaWYgKCBpb21tdS0+ZmVhdHVyZXMuZmxkcy5wcHJfc3VwICkKICAgICAgICAgcmVnaXN0
ZXJfaW9tbXVfcHByX2xvZ19pbl9tbWlvX3NwYWNlKGlvbW11KTsKIAotICAgIGRlc2MgPSBpcnFf
dG9fZGVzYyhpb21tdS0+bXNpLmlycSk7Ci0gICAgc3Bpbl9sb2NrKCZkZXNjLT5sb2NrKTsKLSAg
ICBzZXRfbXNpX2FmZmluaXR5KGRlc2MsIE5VTEwpOwotICAgIHNwaW5fdW5sb2NrKCZkZXNjLT5s
b2NrKTsKKyAgICBpZiAoIGlvbW11LT5tc2kuaXJxID4gMCApCisgICAgeworICAgICAgICBzdHJ1
Y3QgaXJxX2Rlc2MgKmRlc2MgPSBpcnFfdG9fZGVzYyhpb21tdS0+bXNpLmlycSk7CisKKyAgICAg
ICAgc3Bpbl9sb2NrKCZkZXNjLT5sb2NrKTsKKyAgICAgICAgc2V0X21zaV9hZmZpbml0eShkZXNj
LCBOVUxMKTsKKyAgICAgICAgc3Bpbl91bmxvY2soJmRlc2MtPmxvY2spOworICAgIH0KIAogICAg
IGFtZF9pb21tdV9tc2lfZW5hYmxlKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJMRUQpOwogCiAg
ICAgc2V0X2lvbW11X2h0X2ZsYWdzKGlvbW11KTsKICAgICBzZXRfaW9tbXVfY29tbWFuZF9idWZm
ZXJfY29udHJvbChpb21tdSwgSU9NTVVfQ09OVFJPTF9FTkFCTEVEKTsKLSAgICBzZXRfaW9tbXVf
ZXZlbnRfbG9nX2NvbnRyb2woaW9tbXUsIElPTU1VX0NPTlRST0xfRU5BQkxFRCk7CiAKLSAgICBp
ZiAoIGlvbW11LT5mZWF0dXJlcy5mbGRzLnBwcl9zdXAgKQotICAgICAgICBzZXRfaW9tbXVfcHBy
X2xvZ19jb250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJMRUQpOworICAgIGlmICggaW9t
bXUtPm1zaS5pcnEgPiAwICkKKyAgICB7CisgICAgICAgIHNldF9pb21tdV9ldmVudF9sb2dfY29u
dHJvbChpb21tdSwgSU9NTVVfQ09OVFJPTF9FTkFCTEVEKTsKKworICAgICAgICBpZiAoIGlvbW11
LT5mZWF0dXJlcy5mbGRzLnBwcl9zdXAgKQorICAgICAgICAgICAgc2V0X2lvbW11X3Bwcl9sb2df
Y29udHJvbChpb21tdSwgSU9NTVVfQ09OVFJPTF9FTkFCTEVEKTsKKyAgICB9CiAKICAgICBpZiAo
IGlvbW11LT5mZWF0dXJlcy5mbGRzLmd0X3N1cCApCiAgICAgICAgIHNldF9pb21tdV9ndWVzdF90
cmFuc2xhdGlvbl9jb250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJMRUQpOwo=

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="08-AMD-IOMMU-x2APIC-control.patch"
Content-Description: 08-AMD-IOMMU-x2APIC-control.patch
Content-Disposition: attachment;
	filename="08-AMD-IOMMU-x2APIC-control.patch"; size=6245;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <B20D46133926144C8CE7EDAB602ABCFD@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBhZGp1c3Qgc2V0dXAgb2YgaW50ZXJuYWwgaW50ZXJydXB0IGZvciB4MkFQSUMg
bW9kZQoKSW4gb3JkZXIgdG8gYmUgYWJsZSB0byBleHByZXNzIGFsbCBwb3NzaWJsZSBkZXN0aW5h
dGlvbnMgd2UgbmVlZCB0byBtYWtlCnVzZSBvZiB0aGlzIG5vbi1NU0ktY2FwYWJpbGl0eSBiYXNl
ZCBtZWNoYW5pc20uIFRoZSBuZXcgSVJRIGNvbnRyb2xsZXIKc3RydWN0dXJlIGNhbiByZS11c2Ug
Y2VydGFpbiBNU0kgZnVuY3Rpb25zLCB0aG91Z2guCgpGb3Igbm93IGdlbmVyYWwgYW5kIFBQUiBp
bnRlcnJ1cHRzIHN0aWxsIHNoYXJlIGEgc2luZ2xlIHZlY3RvciwgSVJRLCBhbmQKaGVuY2UgaGFu
ZGxlci4KClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KUmV2
aWV3ZWQtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+CkFja2Vk
LWJ5OiBCcmlhbiBXb29kcyA8YnJpYW4ud29vZHNAYW1kLmNvbT4KLS0tCnY0OiBSZS1iYXNlLgp2
MzogUmUtYmFzZS4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0
LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYwpAQCAtNDcy
LDYgKzQ3Miw0NCBAQCBzdGF0aWMgaHdfaXJxX2NvbnRyb2xsZXIgaW9tbXVfbWFza2FibGVfCiAg
ICAgLnNldF9hZmZpbml0eSA9IHNldF9tc2lfYWZmaW5pdHksCiB9OwogCitzdGF0aWMgdm9pZCBz
ZXRfeDJhcGljX2FmZmluaXR5KHN0cnVjdCBpcnFfZGVzYyAqZGVzYywgY29uc3QgY3B1bWFza190
ICptYXNrKQoreworICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11ID0gZGVzYy0+YWN0aW9uLT5k
ZXZfaWQ7CisgICAgdW5zaWduZWQgaW50IGRlc3QgPSBzZXRfZGVzY19hZmZpbml0eShkZXNjLCBt
YXNrKTsKKyAgICB1bmlvbiBhbWRfaW9tbXVfeDJhcGljX2NvbnRyb2wgY3RybCA9IHt9OworICAg
IHVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKyAgICBpZiAoIGRlc3QgPT0gQkFEX0FQSUNJRCApCisg
ICAgICAgIHJldHVybjsKKworICAgIG1zaV9jb21wb3NlX21zZyhkZXNjLT5hcmNoLnZlY3Rvciwg
TlVMTCwgJmlvbW11LT5tc2kubXNnKTsKKyAgICBpb21tdS0+bXNpLm1zZy5kZXN0MzIgPSBkZXN0
OworCisgICAgY3RybC5kZXN0X21vZGUgPSBNQVNLX0VYVFIoaW9tbXUtPm1zaS5tc2cuYWRkcmVz
c19sbywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNU0lfQUREUl9ERVNUTU9ERV9N
QVNLKTsKKyAgICBjdHJsLmludF90eXBlID0gTUFTS19FWFRSKGlvbW11LT5tc2kubXNnLmRhdGEs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNU0lfREFUQV9ERUxJVkVSWV9NT0RFX01B
U0spOworICAgIGN0cmwudmVjdG9yID0gZGVzYy0+YXJjaC52ZWN0b3I7CisgICAgY3RybC5kZXN0
X2xvID0gZGVzdDsKKyAgICBjdHJsLmRlc3RfaGkgPSBkZXN0ID4+IDI0OworCisgICAgc3Bpbl9s
b2NrX2lycXNhdmUoJmlvbW11LT5sb2NrLCBmbGFncyk7CisgICAgd3JpdGVxKGN0cmwucmF3LCBp
b21tdS0+bW1pb19iYXNlICsgSU9NTVVfWFRfSU5UX0NUUkxfTU1JT19PRkZTRVQpOworICAgIHdy
aXRlcShjdHJsLnJhdywgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX1hUX1BQUl9JTlRfQ1RSTF9N
TUlPX09GRlNFVCk7CisgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPmxvY2ssIGZs
YWdzKTsKK30KKworc3RhdGljIGh3X2lycV9jb250cm9sbGVyIGlvbW11X3gyYXBpY190eXBlID0g
eworICAgIC50eXBlbmFtZSAgICAgPSAiSU9NTVUteDJBUElDIiwKKyAgICAuc3RhcnR1cCAgICAg
ID0gaXJxX3N0YXJ0dXBfbm9uZSwKKyAgICAuc2h1dGRvd24gICAgID0gaXJxX3NodXRkb3duX25v
bmUsCisgICAgLmVuYWJsZSAgICAgICA9IGlycV9lbmFibGVfbm9uZSwKKyAgICAuZGlzYWJsZSAg
ICAgID0gaXJxX2Rpc2FibGVfbm9uZSwKKyAgICAuYWNrICAgICAgICAgID0gYWNrX25vbm1hc2th
YmxlX21zaV9pcnEsCisgICAgLmVuZCAgICAgICAgICA9IGVuZF9ub25tYXNrYWJsZV9tc2lfaXJx
LAorICAgIC5zZXRfYWZmaW5pdHkgPSBzZXRfeDJhcGljX2FmZmluaXR5LAorfTsKKwogc3RhdGlj
IHZvaWQgcGFyc2VfZXZlbnRfbG9nX2VudHJ5KHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1MzIg
ZW50cnlbXSkKIHsKICAgICB1MTYgZG9tYWluX2lkLCBkZXZpY2VfaWQsIGZsYWdzOwpAQCAtNzI2
LDggKzc2NCw2IEBAIHN0YXRpYyB2b2lkIGlvbW11X2ludGVycnVwdF9oYW5kbGVyKGludAogc3Rh
dGljIGJvb2xfdCBfX2luaXQgc2V0X2lvbW11X2ludGVycnVwdF9oYW5kbGVyKHN0cnVjdCBhbWRf
aW9tbXUgKmlvbW11KQogewogICAgIGludCBpcnEsIHJldDsKLSAgICBod19pcnFfY29udHJvbGxl
ciAqaGFuZGxlcjsKLSAgICB1MTYgY29udHJvbDsKIAogICAgIGlycSA9IGNyZWF0ZV9pcnEoTlVN
QV9OT19OT0RFKTsKICAgICBpZiAoIGlycSA8PSAwICkKQEAgLTc0NywxOSArNzgzLDQyIEBAIHN0
YXRpYyBib29sX3QgX19pbml0IHNldF9pb21tdV9pbnRlcnJ1cHQKICAgICAgICAgICAgICAgICAg
ICAgICAgIFBDSV9TTE9UKGlvbW11LT5iZGYpLCBQQ0lfRlVOQyhpb21tdS0+YmRmKSk7CiAgICAg
ICAgIHJldHVybiAwOwogICAgIH0KLSAgICBjb250cm9sID0gcGNpX2NvbmZfcmVhZDE2KFBDSV9T
QkRGMihpb21tdS0+c2VnLCBpb21tdS0+YmRmKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGlvbW11LT5tc2kubXNpX2F0dHJpYi5wb3MgKyBQQ0lfTVNJX0ZMQUdTKTsKLSAgICBpb21t
dS0+bXNpLm1zaS5udmVjID0gMTsKLSAgICBpZiAoIGlzX21hc2tfYml0X3N1cHBvcnQoY29udHJv
bCkgKQotICAgIHsKLSAgICAgICAgaW9tbXUtPm1zaS5tc2lfYXR0cmliLm1hc2tiaXQgPSAxOwot
ICAgICAgICBpb21tdS0+bXNpLm1zaS5tcG9zID0gbXNpX21hc2tfYml0c19yZWcoaW9tbXUtPm1z
aS5tc2lfYXR0cmliLnBvcywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGlzXzY0Yml0X2FkZHJlc3MoY29udHJvbCkpOwotICAgICAgICBoYW5kbGVyID0g
JmlvbW11X21hc2thYmxlX21zaV90eXBlOworCisgICAgaWYgKCBpb21tdS0+Y3RybC5pbnRfY2Fw
X3h0X2VuICkKKyAgICB7CisgICAgICAgIHN0cnVjdCBpcnFfZGVzYyAqZGVzYyA9IGlycV90b19k
ZXNjKGlycSk7CisKKyAgICAgICAgaW9tbXUtPm1zaS5tc2lfYXR0cmliLnBvcyA9IE1TSV9UWVBF
X0lPTU1VOworICAgICAgICBpb21tdS0+bXNpLm1zaV9hdHRyaWIubWFza2JpdCA9IDA7CisgICAg
ICAgIGlvbW11LT5tc2kubXNpX2F0dHJpYi5pc182NCA9IDE7CisKKyAgICAgICAgZGVzYy0+bXNp
X2Rlc2MgPSAmaW9tbXUtPm1zaTsKKyAgICAgICAgZGVzYy0+aGFuZGxlciA9ICZpb21tdV94MmFw
aWNfdHlwZTsKKworICAgICAgICByZXQgPSAwOwogICAgIH0KICAgICBlbHNlCi0gICAgICAgIGhh
bmRsZXIgPSAmaW9tbXVfbXNpX3R5cGU7Ci0gICAgcmV0ID0gX19zZXR1cF9tc2lfaXJxKGlycV90
b19kZXNjKGlycSksICZpb21tdS0+bXNpLCBoYW5kbGVyKTsKKyAgICB7CisgICAgICAgIGh3X2ly
cV9jb250cm9sbGVyICpoYW5kbGVyOworICAgICAgICB1MTYgY29udHJvbDsKKworICAgICAgICBj
b250cm9sID0gcGNpX2NvbmZfcmVhZDE2KFBDSV9TQkRGMihpb21tdS0+c2VnLCBpb21tdS0+YmRm
KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpb21tdS0+bXNpLm1zaV9hdHRy
aWIucG9zICsgUENJX01TSV9GTEFHUyk7CisKKyAgICAgICAgaW9tbXUtPm1zaS5tc2kubnZlYyA9
IDE7CisgICAgICAgIGlmICggaXNfbWFza19iaXRfc3VwcG9ydChjb250cm9sKSApCisgICAgICAg
IHsKKyAgICAgICAgICAgIGlvbW11LT5tc2kubXNpX2F0dHJpYi5tYXNrYml0ID0gMTsKKyAgICAg
ICAgICAgIGlvbW11LT5tc2kubXNpLm1wb3MgPSBtc2lfbWFza19iaXRzX3JlZyhpb21tdS0+bXNp
Lm1zaV9hdHRyaWIucG9zLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlzXzY0Yml0X2FkZHJlc3MoY29udHJvbCkpOworICAgICAgICAgICAgaGFu
ZGxlciA9ICZpb21tdV9tYXNrYWJsZV9tc2lfdHlwZTsKKyAgICAgICAgfQorICAgICAgICBlbHNl
CisgICAgICAgICAgICBoYW5kbGVyID0gJmlvbW11X21zaV90eXBlOworCisgICAgICAgIHJldCA9
IF9fc2V0dXBfbXNpX2lycShpcnFfdG9fZGVzYyhpcnEpLCAmaW9tbXUtPm1zaSwgaGFuZGxlcik7
CisgICAgfQorCiAgICAgaWYgKCAhcmV0ICkKICAgICAgICAgcmV0ID0gcmVxdWVzdF9pcnEoaXJx
LCAwLCBpb21tdV9pbnRlcnJ1cHRfaGFuZGxlciwgImFtZF9pb21tdSIsIGlvbW11KTsKICAgICBp
ZiAoIHJldCApCkBAIC04MzcsOCArODk2LDE5IEBAIHN0YXRpYyB2b2lkIGVuYWJsZV9pb21tdShz
dHJ1Y3QgYW1kX2lvbW0KICAgICAgICAgc3RydWN0IGlycV9kZXNjICpkZXNjID0gaXJxX3RvX2Rl
c2MoaW9tbXUtPm1zaS5pcnEpOwogCiAgICAgICAgIHNwaW5fbG9jaygmZGVzYy0+bG9jayk7Ci0g
ICAgICAgIHNldF9tc2lfYWZmaW5pdHkoZGVzYywgTlVMTCk7Ci0gICAgICAgIHNwaW5fdW5sb2Nr
KCZkZXNjLT5sb2NrKTsKKworICAgICAgICBpZiAoIGlvbW11LT5jdHJsLmludF9jYXBfeHRfZW4g
KQorICAgICAgICB7CisgICAgICAgICAgICBzZXRfeDJhcGljX2FmZmluaXR5KGRlc2MsIE5VTEwp
OworICAgICAgICAgICAgc3Bpbl91bmxvY2soJmRlc2MtPmxvY2spOworICAgICAgICB9CisgICAg
ICAgIGVsc2UKKyAgICAgICAgeworICAgICAgICAgICAgc2V0X21zaV9hZmZpbml0eShkZXNjLCBO
VUxMKTsKKyAgICAgICAgICAgIHNwaW5fdW5sb2NrKCZkZXNjLT5sb2NrKTsKKworICAgICAgICAg
ICAgYW1kX2lvbW11X21zaV9lbmFibGUoaW9tbXUsIElPTU1VX0NPTlRST0xfRU5BQkxFRCk7Cisg
ICAgICAgIH0KICAgICB9CiAKICAgICBhbWRfaW9tbXVfbXNpX2VuYWJsZShpb21tdSwgSU9NTVVf
Q09OVFJPTF9FTkFCTEVEKTsKQEAgLTg3OCw3ICs5NDgsOSBAQCBzdGF0aWMgdm9pZCBkaXNhYmxl
X2lvbW11KHN0cnVjdCBhbWRfaW9tCiAgICAgICAgIHJldHVybjsKICAgICB9CiAKLSAgICBhbWRf
aW9tbXVfbXNpX2VuYWJsZShpb21tdSwgSU9NTVVfQ09OVFJPTF9ESVNBQkxFRCk7CisgICAgaWYg
KCAhaW9tbXUtPmN0cmwuaW50X2NhcF94dF9lbiApCisgICAgICAgIGFtZF9pb21tdV9tc2lfZW5h
YmxlKGlvbW11LCBJT01NVV9DT05UUk9MX0RJU0FCTEVEKTsKKwogICAgIHNldF9pb21tdV9jb21t
YW5kX2J1ZmZlcl9jb250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0RJU0FCTEVEKTsKICAgICBz
ZXRfaW9tbXVfZXZlbnRfbG9nX2NvbnRyb2woaW9tbXUsIElPTU1VX0NPTlRST0xfRElTQUJMRUQp
OwogCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtZGVmcy5oCisr
KyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUtZGVmcy5oCkBAIC00MTYs
NiArNDE2LDI1IEBAIHVuaW9uIGFtZF9pb21tdV9leHRfZmVhdHVyZXMgewogICAgIH0gZmxkczsK
IH07CiAKKy8qIHgyQVBJQyBDb250cm9sIFJlZ2lzdGVycyAqLworI2RlZmluZSBJT01NVV9YVF9J
TlRfQ1RSTF9NTUlPX09GRlNFVAkJMHgwMTcwCisjZGVmaW5lIElPTU1VX1hUX1BQUl9JTlRfQ1RS
TF9NTUlPX09GRlNFVAkweDAxNzgKKyNkZWZpbmUgSU9NTVVfWFRfR0FfSU5UX0NUUkxfTU1JT19P
RkZTRVQJMHgwMTgwCisKK3VuaW9uIGFtZF9pb21tdV94MmFwaWNfY29udHJvbCB7CisgICAgdWlu
dDY0X3QgcmF3OworICAgIHN0cnVjdCB7CisgICAgICAgIHVuc2lnbmVkIGludCA6MjsKKyAgICAg
ICAgdW5zaWduZWQgaW50IGRlc3RfbW9kZToxOworICAgICAgICB1bnNpZ25lZCBpbnQgOjU7Cisg
ICAgICAgIHVuc2lnbmVkIGludCBkZXN0X2xvOjI0OworICAgICAgICB1bnNpZ25lZCBpbnQgdmVj
dG9yOjg7CisgICAgICAgIHVuc2lnbmVkIGludCBpbnRfdHlwZToxOyAvKiBETSBpbiBJT01NVSBz
cGVjIDMuMDQgKi8KKyAgICAgICAgdW5zaWduZWQgaW50IDoxNTsKKyAgICAgICAgdW5zaWduZWQg
aW50IGRlc3RfaGk6ODsKKyAgICB9OworfTsKKwogLyogU3RhdHVzIFJlZ2lzdGVyKi8KICNkZWZp
bmUgSU9NTVVfU1RBVFVTX01NSU9fT0ZGU0VUCQkweDIwMjAKICNkZWZpbmUgSU9NTVVfU1RBVFVT
X0VWRU5UX09WRVJGTE9XX01BU0sJMHgwMDAwMDAwMQo=

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="09-AMD-IOMMU-enable-x2APIC.patch"
Content-Description: 09-AMD-IOMMU-enable-x2APIC.patch
Content-Disposition: attachment;
	filename="09-AMD-IOMMU-enable-x2APIC.patch"; size=9893;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <84537DD487855C409BAA90C679A2723E@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBlbmFibGUgeDJBUElDIG1vZGUgd2hlbiBhdmFpbGFibGUKCkluIG9yZGVyIGZv
ciB0aGUgQ1BVcyB0byB1c2UgeDJBUElDIG1vZGUsIHRoZSBJT01NVShzKSBmaXJzdCBuZWVkIHRv
IGJlCnN3aXRjaGVkIGludG8gc3VpdGFibGUgc3RhdGUuCgpUaGUgcG9zdC1BUC1icmluZ3VwIElS
USBhZmZpbml0eSBhZGp1c3RtZW50IGlzIGRvbmUgYWxzbyBmb3IgdGhlIG5vbi0KeDJBUElDIGNh
c2UsIG1hdGNoaW5nIHdoYXQgVlQtZCBkb2VzLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2gg
PGpiZXVsaWNoQHN1c2UuY29tPgpBY2tlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3Bl
cjNAY2l0cml4LmNvbT4KQWNrZWQtYnk6IEJyaWFuIFdvb2RzIDxicmlhbi53b29kc0BhbWQuY29t
PgotLS0KdjQ6IFJlLWJhc2UuCnYzOiBTZXQgR0FFbiAoYW5kIG90aGVyIGNvbnRyb2wgcmVnaXN0
ZXIgYml0cykgZWFybGllci4gQWxzbyBjbGVhciB0aGUKICAgIGJpdHMgZW5hYmxlZCBoZXJlIGlu
IGFtZF9pb21tdV9pbml0X2NsZWFudXAoKS4gUmUtYmFzZS4gUGFzcyBOVUxMCiAgICBDUFUgbWFz
ayB0byBzZXRfe3gyYXBpYyxtc2l9X2FmZmluaXR5KCkuCnYyOiBEcm9wIGNwdV9oYXNfY3gxNiBj
aGVjay4gQWRkIGNvbW1lbnQuCi0tLQpUQkQ6IEluc3RlYWQgb2YgdGhlIHN5c3RlbV9zdGF0ZSBj
aGVjayBpbiBpb3ZfZW5hYmxlX3h0KCkgdGhlIGZ1bmN0aW9uCiAgICAgY291bGQgYWxzbyB6YXAg
aXRzIG93biBob29rIHBvaW50ZXIsIGF0IHdoaWNoIHBvaW50IGl0IGNvdWxkIGFsc28KICAgICBi
ZWNvbWUgX19pbml0LiBUaGlzIHdvdWxkLCBob3dldmVyLCByZXF1aXJlIHRoYXQgZWl0aGVyCiAg
ICAgcmVzdW1lX3gyYXBpYygpIGJlIGJvdW5kIHRvIGlnbm9yZSBpb21tdV9lbmFibGVfeDJhcGlj
KCkgZXJyb3JzCiAgICAgZm9yZXZlciwgb3IgdGhhdCBpb21tdV9lbmFibGVfeDJhcGljKCkgYmUg
c2xpZ2h0bHkgcmUtYXJyYW5nZWQgdG8KICAgICBub3QgcmV0dXJuIC1FT1BOT1RTVVBQIHdoZW4g
ZmluZGluZyBhIE5VTEwgaG9vayBkdXJpbmcgcmVzdW1lLgoKLS0tIGEveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X2luaXQuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9h
bWQvaW9tbXVfaW5pdC5jCkBAIC04MzMsNiArODMzLDMwIEBAIHN0YXRpYyBib29sX3QgX19pbml0
IHNldF9pb21tdV9pbnRlcnJ1cHQKICAgICByZXR1cm4gMTsKIH0KIAoraW50IGlvdl9hZGp1c3Rf
aXJxX2FmZmluaXRpZXModm9pZCkKK3sKKyAgICBjb25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21t
dTsKKworICAgIGlmICggIWlvbW11X2VuYWJsZWQgKQorICAgICAgICByZXR1cm4gMDsKKworICAg
IGZvcl9lYWNoX2FtZF9pb21tdSAoIGlvbW11ICkKKyAgICB7CisgICAgICAgIHN0cnVjdCBpcnFf
ZGVzYyAqZGVzYyA9IGlycV90b19kZXNjKGlvbW11LT5tc2kuaXJxKTsKKyAgICAgICAgdW5zaWdu
ZWQgbG9uZyBmbGFnczsKKworICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmZGVzYy0+bG9jaywg
ZmxhZ3MpOworICAgICAgICBpZiAoIGlvbW11LT5jdHJsLmludF9jYXBfeHRfZW4gKQorICAgICAg
ICAgICAgc2V0X3gyYXBpY19hZmZpbml0eShkZXNjLCBOVUxMKTsKKyAgICAgICAgZWxzZQorICAg
ICAgICAgICAgc2V0X21zaV9hZmZpbml0eShkZXNjLCBOVUxMKTsKKyAgICAgICAgc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmZGVzYy0+bG9jaywgZmxhZ3MpOworICAgIH0KKworICAgIHJldHVybiAw
OworfQorX19pbml0Y2FsbChpb3ZfYWRqdXN0X2lycV9hZmZpbml0aWVzKTsKKwogLyoKICAqIEZh
bWlseTE1aCBNb2RlbCAxMGgtMWZoIGVycmF0dW0gNzQ2IChJT01NVSBMb2dnaW5nIE1heSBTdGFs
bCBUcmFuc2xhdGlvbnMpCiAgKiBXb3JrYXJvdW5kOgpAQCAtMTA0Niw3ICsxMDcwLDcgQEAgc3Rh
dGljIHZvaWQgKiBfX2luaXQgYWxsb2NhdGVfcHByX2xvZyhzdAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9QUFJfTE9HX0RFRkFVTFRfRU5UUklFUywgIlBQUiBMb2ciKTsK
IH0KIAotc3RhdGljIGludCBfX2luaXQgYW1kX2lvbW11X2luaXRfb25lKHN0cnVjdCBhbWRfaW9t
bXUgKmlvbW11KQorc3RhdGljIGludCBfX2luaXQgYW1kX2lvbW11X2luaXRfb25lKHN0cnVjdCBh
bWRfaW9tbXUgKmlvbW11LCBib29sIGludHIpCiB7CiAgICAgaWYgKCBhbGxvY2F0ZV9jbWRfYnVm
ZmVyKGlvbW11KSA9PSBOVUxMICkKICAgICAgICAgZ290byBlcnJvcl9vdXQ7CkBAIC0xMDU3LDcg
KzEwODEsNyBAQCBzdGF0aWMgaW50IF9faW5pdCBhbWRfaW9tbXVfaW5pdF9vbmUoc3RyCiAgICAg
aWYgKCBpb21tdS0+ZmVhdHVyZXMuZmxkcy5wcHJfc3VwICYmICFhbGxvY2F0ZV9wcHJfbG9nKGlv
bW11KSApCiAgICAgICAgIGdvdG8gZXJyb3Jfb3V0OwogCi0gICAgaWYgKCAhc2V0X2lvbW11X2lu
dGVycnVwdF9oYW5kbGVyKGlvbW11KSApCisgICAgaWYgKCBpbnRyICYmICFzZXRfaW9tbXVfaW50
ZXJydXB0X2hhbmRsZXIoaW9tbXUpICkKICAgICAgICAgZ290byBlcnJvcl9vdXQ7CiAKICAgICAv
KiBUbyBtYWtlIHN1cmUgdGhhdCBkZXZpY2VfdGFibGUuYnVmZmVyIGhhcyBiZWVuIHN1Y2Nlc3Nm
dWxseSBhbGxvY2F0ZWQgKi8KQEAgLTEwODYsOCArMTExMCwxNiBAQCBzdGF0aWMgdm9pZCBfX2lu
aXQgYW1kX2lvbW11X2luaXRfY2xlYW51CiAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlICgg
aW9tbXUsIG5leHQsICZhbWRfaW9tbXVfaGVhZCwgbGlzdCApCiAgICAgewogICAgICAgICBsaXN0
X2RlbCgmaW9tbXUtPmxpc3QpOworCisgICAgICAgIGlvbW11LT5jdHJsLmdhX2VuID0gMDsKKyAg
ICAgICAgaW9tbXUtPmN0cmwueHRfZW4gPSAwOworICAgICAgICBpb21tdS0+Y3RybC5pbnRfY2Fw
X3h0X2VuID0gMDsKKwogICAgICAgICBpZiAoIGlvbW11LT5lbmFibGVkICkKICAgICAgICAgICAg
IGRpc2FibGVfaW9tbXUoaW9tbXUpOworICAgICAgICBlbHNlIGlmICggaW9tbXUtPm1taW9fYmFz
ZSApCisgICAgICAgICAgICB3cml0ZXEoaW9tbXUtPmN0cmwucmF3LAorICAgICAgICAgICAgICAg
ICAgIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsKIAogICAg
ICAgICBkZWFsbG9jYXRlX3JpbmdfYnVmZmVyKCZpb21tdS0+Y21kX2J1ZmZlcik7CiAgICAgICAg
IGRlYWxsb2NhdGVfcmluZ19idWZmZXIoJmlvbW11LT5ldmVudF9sb2cpOwpAQCAtMTI4OSw3ICsx
MzIxLDcgQEAgc3RhdGljIGludCBfX2luaXQgYW1kX2lvbW11X3ByZXBhcmVfb25lKAogICAgIHJl
dHVybiAwOwogfQogCi1pbnQgX19pbml0IGFtZF9pb21tdV9pbml0KHZvaWQpCitpbnQgX19pbml0
IGFtZF9pb21tdV9wcmVwYXJlKGJvb2wgeHQpCiB7CiAgICAgc3RydWN0IGFtZF9pb21tdSAqaW9t
bXU7CiAgICAgaW50IHJjID0gLUVOT0RFVjsKQEAgLTEzMDQsOSArMTMzNiwxNCBAQCBpbnQgX19p
bml0IGFtZF9pb21tdV9pbml0KHZvaWQpCiAgICAgaWYgKCB1bmxpa2VseShhY3BpX2dibF9GQURU
LmJvb3RfZmxhZ3MgJiBBQ1BJX0ZBRFRfTk9fTVNJKSApCiAgICAgICAgIGdvdG8gZXJyb3Jfb3V0
OwogCisgICAgLyogSGF2ZSB3ZSBiZWVuIGhlcmUgYmVmb3JlPyAqLworICAgIGlmICggaXZoZF90
eXBlICkKKyAgICAgICAgcmV0dXJuIDA7CisKICAgICByYyA9IGFtZF9pb21tdV9nZXRfc3VwcG9y
dGVkX2l2aGRfdHlwZSgpOwogICAgIGlmICggcmMgPCAwICkKICAgICAgICAgZ290byBlcnJvcl9v
dXQ7CisgICAgQlVHX09OKCFyYyk7CiAgICAgaXZoZF90eXBlID0gcmM7CiAKICAgICByYyA9IGFt
ZF9pb21tdV9nZXRfaXZyc19kZXZfZW50cmllcygpOwpAQCAtMTMyMiw5ICsxMzU5LDM3IEBAIGlu
dCBfX2luaXQgYW1kX2lvbW11X2luaXQodm9pZCkKICAgICAgICAgcmMgPSBhbWRfaW9tbXVfcHJl
cGFyZV9vbmUoaW9tbXUpOwogICAgICAgICBpZiAoIHJjICkKICAgICAgICAgICAgIGdvdG8gZXJy
b3Jfb3V0OworCisgICAgICAgIHJjID0gLUVOT0RFVjsKKyAgICAgICAgaWYgKCB4dCAmJiAoIWlv
bW11LT5mZWF0dXJlcy5mbGRzLmdhX3N1cCB8fCAhaW9tbXUtPmZlYXR1cmVzLmZsZHMueHRfc3Vw
KSApCisgICAgICAgICAgICBnb3RvIGVycm9yX291dDsKKyAgICB9CisKKyAgICBmb3JfZWFjaF9h
bWRfaW9tbXUgKCBpb21tdSApCisgICAgeworICAgICAgICAvKiBOQjogVGhlcmUncyBubyBuZWVk
IHRvIGFjdHVhbGx5IHdyaXRlIHRoZXNlIG91dCByaWdodCBoZXJlLiAqLworICAgICAgICBpb21t
dS0+Y3RybC5nYV9lbiB8PSB4dDsKKyAgICAgICAgaW9tbXUtPmN0cmwueHRfZW4gPSB4dDsKKyAg
ICAgICAgaW9tbXUtPmN0cmwuaW50X2NhcF94dF9lbiA9IHh0OwogICAgIH0KIAogICAgIHJjID0g
YW1kX2lvbW11X3VwZGF0ZV9pdnJzX21hcHBpbmdfYWNwaSgpOworCisgZXJyb3Jfb3V0OgorICAg
IGlmICggcmMgKQorICAgIHsKKyAgICAgICAgYW1kX2lvbW11X2luaXRfY2xlYW51cCgpOworICAg
ICAgICBpdmhkX3R5cGUgPSAwOworICAgIH0KKworICAgIHJldHVybiByYzsKK30KKworaW50IF9f
aW5pdCBhbWRfaW9tbXVfaW5pdChib29sIHh0KQoreworICAgIHN0cnVjdCBhbWRfaW9tbXUgKmlv
bW11OworICAgIGludCByYyA9IGFtZF9pb21tdV9wcmVwYXJlKHh0KTsKKwogICAgIGlmICggcmMg
KQogICAgICAgICBnb3RvIGVycm9yX291dDsKIApAQCAtMTM1MCw3ICsxNDE1LDEyIEBAIGludCBf
X2luaXQgYW1kX2lvbW11X2luaXQodm9pZCkKICAgICAvKiBwZXIgaW9tbXUgaW5pdGlhbGl6YXRp
b24gICovCiAgICAgZm9yX2VhY2hfYW1kX2lvbW11ICggaW9tbXUgKQogICAgIHsKLSAgICAgICAg
cmMgPSBhbWRfaW9tbXVfaW5pdF9vbmUoaW9tbXUpOworICAgICAgICAvKgorICAgICAgICAgKiBT
ZXR0aW5nIHVwIG9mIHRoZSBJT01NVSBpbnRlcnJ1cHRzIGNhbm5vdCBvY2N1ciB5ZXQgYXQgdGhl
ICh2ZXJ5CisgICAgICAgICAqIGVhcmx5KSB0aW1lIHdlIGdldCBoZXJlIHdoZW4gZW5hYmxpbmcg
eDJBUElDIG1vZGUuIFN1cHByZXNzIGl0CisgICAgICAgICAqIGhlcmUsIGFuZCBkbyBpdCBleHBs
aWNpdGx5IGluIGFtZF9pb21tdV9pbml0X2ludGVycnVwdCgpLgorICAgICAgICAgKi8KKyAgICAg
ICAgcmMgPSBhbWRfaW9tbXVfaW5pdF9vbmUoaW9tbXUsICF4dCk7CiAgICAgICAgIGlmICggcmMg
KQogICAgICAgICAgICAgZ290byBlcnJvcl9vdXQ7CiAgICAgfQpAQCAtMTM2Miw2ICsxNDMyLDQw
IEBAIGVycm9yX291dDoKICAgICByZXR1cm4gcmM7CiB9CiAKK2ludCBfX2luaXQgYW1kX2lvbW11
X2luaXRfaW50ZXJydXB0KHZvaWQpCit7CisgICAgc3RydWN0IGFtZF9pb21tdSAqaW9tbXU7Cisg
ICAgaW50IHJjID0gMDsKKworICAgIGZvcl9lYWNoX2FtZF9pb21tdSAoIGlvbW11ICkKKyAgICB7
CisgICAgICAgIHN0cnVjdCBpcnFfZGVzYyAqZGVzYzsKKworICAgICAgICBpZiAoICFzZXRfaW9t
bXVfaW50ZXJydXB0X2hhbmRsZXIoaW9tbXUpICkKKyAgICAgICAgeworICAgICAgICAgICAgcmMg
PSAtRUlPOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKworICAgICAgICBkZXNjID0g
aXJxX3RvX2Rlc2MoaW9tbXUtPm1zaS5pcnEpOworCisgICAgICAgIHNwaW5fbG9jaygmZGVzYy0+
bG9jayk7CisgICAgICAgIEFTU0VSVChpb21tdS0+Y3RybC5pbnRfY2FwX3h0X2VuKTsKKyAgICAg
ICAgc2V0X3gyYXBpY19hZmZpbml0eShkZXNjLCAmY3B1X29ubGluZV9tYXApOworICAgICAgICBz
cGluX3VubG9jaygmZGVzYy0+bG9jayk7CisKKyAgICAgICAgc2V0X2lvbW11X2V2ZW50X2xvZ19j
b250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJMRUQpOworCisgICAgICAgIGlmICggaW9t
bXUtPmZlYXR1cmVzLmZsZHMucHByX3N1cCApCisgICAgICAgICAgICBzZXRfaW9tbXVfcHByX2xv
Z19jb250cm9sKGlvbW11LCBJT01NVV9DT05UUk9MX0VOQUJMRUQpOworICAgIH0KKworICAgIGlm
ICggcmMgKQorICAgICAgICBhbWRfaW9tbXVfaW5pdF9jbGVhbnVwKCk7CisKKyAgICByZXR1cm4g
cmM7Cit9CisKIHN0YXRpYyB2b2lkIGludmFsaWRhdGVfYWxsX2RvbWFpbl9wYWdlcyh2b2lkKQog
ewogICAgIHN0cnVjdCBkb21haW4gKmQ7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9pb21tdV9pbnRyLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2lu
dHIuYwpAQCAtNzk5LDYgKzc5OSwzNSBAQCB2b2lkICpfX2luaXQgYW1kX2lvbW11X2FsbG9jX2lu
dHJlbWFwX3RhCiAgICAgcmV0dXJuIHRiOwogfQogCitib29sIF9faW5pdCBpb3Zfc3VwcG9ydHNf
eHQodm9pZCkKK3sKKyAgICB1bnNpZ25lZCBpbnQgYXBpYzsKKworICAgIGlmICggIWlvbW11X2Vu
YWJsZSB8fCAhaW9tbXVfaW50cmVtYXAgKQorICAgICAgICByZXR1cm4gZmFsc2U7CisKKyAgICBp
ZiAoIGFtZF9pb21tdV9wcmVwYXJlKHRydWUpICkKKyAgICAgICAgcmV0dXJuIGZhbHNlOworCisg
ICAgZm9yICggYXBpYyA9IDA7IGFwaWMgPCBucl9pb2FwaWNzOyBhcGljKysgKQorICAgIHsKKyAg
ICAgICAgdW5zaWduZWQgaW50IGlkeCA9IGlvYXBpY19pZF90b19pbmRleChJT19BUElDX0lEKGFw
aWMpKTsKKworICAgICAgICBpZiAoIGlkeCA9PSBNQVhfSU9fQVBJQ1MgKQorICAgICAgICAgICAg
cmV0dXJuIGZhbHNlOworCisgICAgICAgIGlmICggIWZpbmRfaW9tbXVfZm9yX2RldmljZShpb2Fw
aWNfc2JkZltpZHhdLnNlZywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlv
YXBpY19zYmRmW2lkeF0uYmRmKSApCisgICAgICAgIHsKKyAgICAgICAgICAgIEFNRF9JT01NVV9E
RUJVRygiTm8gSU9NTVUgZm9yIElPLUFQSUMgJSN4IChJRCAleClcbiIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYXBpYywgSU9fQVBJQ19JRChhcGljKSk7CisgICAgICAgICAgICByZXR1
cm4gZmFsc2U7CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXR1cm4gdHJ1ZTsKK30KKwogaW50
IF9faW5pdCBhbWRfc2V0dXBfaHBldF9tc2koc3RydWN0IG1zaV9kZXNjICptc2lfZGVzYykKIHsK
ICAgICBzcGlubG9ja190ICpsb2NrOwotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
cGNpX2FtZF9pb21tdS5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9wY2lfYW1k
X2lvbW11LmMKQEAgLTE3MCw3ICsxNzAsOCBAQCBzdGF0aWMgaW50IF9faW5pdCBpb3ZfZGV0ZWN0
KHZvaWQpCiAgICAgaWYgKCAhaW9tbXVfZW5hYmxlICYmICFpb21tdV9pbnRyZW1hcCApCiAgICAg
ICAgIHJldHVybiAwOwogCi0gICAgaWYgKCBhbWRfaW9tbXVfaW5pdCgpICE9IDAgKQorICAgIGVs
c2UgaWYgKCAoaW5pdF9kb25lID8gYW1kX2lvbW11X2luaXRfaW50ZXJydXB0KCkKKyAgICAgICAg
ICAgICAgICAgICAgICAgICA6IGFtZF9pb21tdV9pbml0KGZhbHNlKSkgIT0gMCApCiAgICAgewog
ICAgICAgICBwcmludGsoIkFNRC1WaTogRXJyb3IgaW5pdGlhbGl6YXRpb25cbiIpOwogICAgICAg
ICByZXR1cm4gLUVOT0RFVjsKQEAgLTE4NCw2ICsxODUsMjUgQEAgc3RhdGljIGludCBfX2luaXQg
aW92X2RldGVjdCh2b2lkKQogICAgIHJldHVybiAwOwogfQogCitzdGF0aWMgaW50IGlvdl9lbmFi
bGVfeHQodm9pZCkKK3sKKyAgICBpbnQgcmM7CisKKyAgICBpZiAoIHN5c3RlbV9zdGF0ZSA+PSBT
WVNfU1RBVEVfYWN0aXZlICkKKyAgICAgICAgcmV0dXJuIDA7CisKKyAgICBpZiAoIChyYyA9IGFt
ZF9pb21tdV9pbml0KHRydWUpKSAhPSAwICkKKyAgICB7CisgICAgICAgIHByaW50aygiQU1ELVZp
OiBFcnJvciAlZCBpbml0aWFsaXppbmcgZm9yIHgyQVBJQyBtb2RlXG4iLCByYyk7CisgICAgICAg
IC8qIC1FTlhJTyBoYXMgc3BlY2lhbCBtZWFuaW5nIHRvIHRoZSBjYWxsZXIgLSBjb252ZXJ0IGl0
LiAqLworICAgICAgICByZXR1cm4gcmMgIT0gLUVOWElPID8gcmMgOiAtRU5PREFUQTsKKyAgICB9
CisKKyAgICBpbml0X2RvbmUgPSB0cnVlOworCisgICAgcmV0dXJuIDA7Cit9CisKIGludCBhbWRf
aW9tbXVfYWxsb2Nfcm9vdChzdHJ1Y3QgZG9tYWluX2lvbW11ICpoZCkKIHsKICAgICBpZiAoIHVu
bGlrZWx5KCFoZC0+YXJjaC5yb290X3RhYmxlKSApCkBAIC01NTcsMTEgKzU3NywxMyBAQCBzdGF0
aWMgY29uc3Qgc3RydWN0IGlvbW11X29wcyBfX2luaXRjb25zCiAgICAgLmZyZWVfcGFnZV90YWJs
ZSA9IGRlYWxsb2NhdGVfcGFnZV90YWJsZSwKICAgICAucmVhc3NpZ25fZGV2aWNlID0gcmVhc3Np
Z25fZGV2aWNlLAogICAgIC5nZXRfZGV2aWNlX2dyb3VwX2lkID0gYW1kX2lvbW11X2dyb3VwX2lk
LAorICAgIC5lbmFibGVfeDJhcGljID0gaW92X2VuYWJsZV94dCwKICAgICAudXBkYXRlX2lyZV9m
cm9tX2FwaWMgPSBhbWRfaW9tbXVfaW9hcGljX3VwZGF0ZV9pcmUsCiAgICAgLnVwZGF0ZV9pcmVf
ZnJvbV9tc2kgPSBhbWRfaW9tbXVfbXNpX21zZ191cGRhdGVfaXJlLAogICAgIC5yZWFkX2FwaWNf
ZnJvbV9pcmUgPSBhbWRfaW9tbXVfcmVhZF9pb2FwaWNfZnJvbV9pcmUsCiAgICAgLnJlYWRfbXNp
X2Zyb21faXJlID0gYW1kX2lvbW11X3JlYWRfbXNpX2Zyb21faXJlLAogICAgIC5zZXR1cF9ocGV0
X21zaSA9IGFtZF9zZXR1cF9ocGV0X21zaSwKKyAgICAuYWRqdXN0X2lycV9hZmZpbml0aWVzID0g
aW92X2FkanVzdF9pcnFfYWZmaW5pdGllcywKICAgICAuc3VzcGVuZCA9IGFtZF9pb21tdV9zdXNw
ZW5kLAogICAgIC5yZXN1bWUgPSBhbWRfaW9tbXVfcmVzdW1lLAogICAgIC5jcmFzaF9zaHV0ZG93
biA9IGFtZF9pb21tdV9jcmFzaF9zaHV0ZG93biwKQEAgLTU3MSw0ICs1OTMsNSBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IGlvbW11X29wcyBfX2luaXRjb25zCiBzdGF0aWMgY29uc3Qgc3RydWN0IGlv
bW11X2luaXRfb3BzIF9faW5pdGNvbnN0cmVsIF9pb21tdV9pbml0X29wcyA9IHsKICAgICAub3Bz
ID0gJl9pb21tdV9vcHMsCiAgICAgLnNldHVwID0gaW92X2RldGVjdCwKKyAgICAuc3VwcG9ydHNf
eDJhcGljID0gaW92X3N1cHBvcnRzX3h0LAogfTsKLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9o
dm0vc3ZtL2FtZC1pb21tdS1wcm90by5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2
bS9hbWQtaW9tbXUtcHJvdG8uaApAQCAtNDgsOCArNDgsMTEgQEAgaW50IGFtZF9pb21tdV9kZXRl
Y3RfYWNwaSh2b2lkKTsKIHZvaWQgZ2V0X2lvbW11X2ZlYXR1cmVzKHN0cnVjdCBhbWRfaW9tbXUg
KmlvbW11KTsKIAogLyogYW1kLWlvbW11LWluaXQgZnVuY3Rpb25zICovCi1pbnQgYW1kX2lvbW11
X2luaXQodm9pZCk7CitpbnQgYW1kX2lvbW11X3ByZXBhcmUoYm9vbCB4dCk7CitpbnQgYW1kX2lv
bW11X2luaXQoYm9vbCB4dCk7CitpbnQgYW1kX2lvbW11X2luaXRfaW50ZXJydXB0KHZvaWQpOwog
aW50IGFtZF9pb21tdV91cGRhdGVfaXZyc19tYXBwaW5nX2FjcGkodm9pZCk7CitpbnQgaW92X2Fk
anVzdF9pcnFfYWZmaW5pdGllcyh2b2lkKTsKIAogLyogbWFwcGluZyBmdW5jdGlvbnMgKi8KIGlu
dCBfX211c3RfY2hlY2sgYW1kX2lvbW11X21hcF9wYWdlKHN0cnVjdCBkb21haW4gKmQsIGRmbl90
IGRmbiwKQEAgLTkzLDYgKzk2LDcgQEAgdm9pZCBhbWRfaW9tbXVfZmx1c2hfYWxsX2NhY2hlcyhz
dHJ1Y3QgYQogc3RydWN0IGFtZF9pb21tdSAqZmluZF9pb21tdV9mb3JfZGV2aWNlKGludCBzZWcs
IGludCBiZGYpOwogCiAvKiBpbnRlcnJ1cHQgcmVtYXBwaW5nICovCitib29sIGlvdl9zdXBwb3J0
c194dCh2b2lkKTsKIGludCBhbWRfaW9tbXVfc2V0dXBfaW9hcGljX3JlbWFwcGluZyh2b2lkKTsK
IHZvaWQgKmFtZF9pb21tdV9hbGxvY19pbnRyZW1hcF90YWJsZSgKICAgICBjb25zdCBzdHJ1Y3Qg
YW1kX2lvbW11ICosIHVuc2lnbmVkIGxvbmcgKiopOwo=

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="10-AMD-IOMMU-IRTE-update-ordering.patch"
Content-Description: 10-AMD-IOMMU-IRTE-update-ordering.patch
Content-Disposition: attachment;
	filename="10-AMD-IOMMU-IRTE-update-ordering.patch"; size=5016;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <E5511018B4BBA44A99AC7229BC290433@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBjb3JyZWN0IElSVEUgdXBkYXRpbmcKCkZsdXNoaW5nIGRpZG4ndCBnZXQgZG9u
ZSBhbG9uZyB0aGUgbGluZXMgb2Ygd2hhdCB0aGUgc3BlY2lmaWNhdGlvbiBzYXlzLgpNYXJrIGVu
dHJpZXMgdG8gYmUgdXBkYXRlZCBhcyBub3QgcmVtYXBwZWQgKHdoaWNoIHdpbGwgcmVzdWx0IGlu
CmludGVycnVwdCByZXF1ZXN0cyB0byBnZXQgdGFyZ2V0IGFib3J0ZWQsIGJ1dCB0aGUgaW50ZXJy
dXB0cyBzaG91bGQgYmUKbWFza2VkIGFueXdheSBhdCB0aGF0IHBvaW50IGluIHRpbWUpLCBpc3N1
ZSB0aGUgZmx1c2gsIGFuZCBvbmx5IHRoZW4Kd3JpdGUgdGhlIG5ldyBlbnRyeS4KCkluIHVwZGF0
ZV9pbnRyZW1hcF9lbnRyeV9mcm9tX21zaV9tc2coKSBhbHNvIGZvbGQgdGhlIGR1cGxpY2F0ZSBp
bml0aWFsCmxvY2sgZGV0ZXJtaW5hdGlvbiBhbmQgYWNxdWlyZSBpbnRvIGp1c3QgYSBzaW5nbGUg
aW5zdGFuY2UuCgpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+
CkFja2VkLWJ5OiBBbmRyZXcgQ29vcGVyIDxhbmRyZXcuY29vcGVyM0BjaXRyaXguY29tPgotLS0K
UkZDOiBQdXR0aW5nIHRoZSBmbHVzaCBpbnZvY2F0aW9ucyBpbiBsb29wcyBpc24ndCBvdmVybHkg
bmljZSwgYnV0IEkKICAgICBkb24ndCB0aGluayB0aGlzIGNhbiByZWFsbHkgYmUgYWJ1c2VkLCBz
aW5jZSBjYWxsZXJzIHVwIHRoZSBzdGFjawogICAgIGhvbGQgZnVydGhlciBsb2Nrcy4gTmV2ZXJ0
aGVsZXNzIEknZCBsaWtlIHRvIGFzayBmb3IgYmV0dGVyCiAgICAgc3VnZ2VzdGlvbnMuCi0tLQp2
NDogUmUtYmFzZS4KdjM6IFJlbW92ZSBzdGFsZSBwYXJ0cyBvZiBkZXNjcmlwdGlvbi4gUmUtYmFz
ZS4KdjI6IFBhcnRzIG1vcnBoZWQgaW50byBlYXJsaWVyIHBhdGNoLgoKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2ludHIuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9hbWQvaW9tbXVfaW50ci5jCkBAIC0yMTMsMTUgKzIxMywxMyBAQCBzdGF0aWMgdm9pZCB1
cGRhdGVfaW50cmVtYXBfZW50cnkoY29uc3QKICAgICAgICAgICAgIH0sCiAgICAgICAgIH07CiAK
LSAgICAgICAgQUNDRVNTX09OQ0UoZW50cnkucHRyMTI4LT5yYXdbMF0pID0gMDsKKyAgICAgICAg
QVNTRVJUKCFlbnRyeS5wdHIxMjgtPmZ1bGwucmVtYXBfZW4pOworICAgICAgICBlbnRyeS5wdHIx
MjgtPnJhd1sxXSA9IGlydGUucmF3WzFdOwogICAgICAgICAvKgotICAgICAgICAgKiBMb3cgaGFs
ZiwgaW4gcGFydGljdWxhciBSZW1hcEVuLCBuZWVkcyB0byBiZSBjbGVhcmVkIGZpcnN0LiAgU2Vl
CisgICAgICAgICAqIEhpZ2ggaGFsZiBuZWVkcyB0byBiZSBzZXQgYmVmb3JlIGxvdyBvbmUgKGNv
bnRhaW5pbmcgUmVtYXBFbikuICBTZWUKICAgICAgICAgICogY29tbWVudCBpbiBmcmVlX2ludHJl
bWFwX2VudHJ5KCkgcmVnYXJkaW5nIHRoZSBjaG9pY2Ugb2YgYmFycmllci4KICAgICAgICAgICov
CiAgICAgICAgIHNtcF93bWIoKTsKLSAgICAgICAgZW50cnkucHRyMTI4LT5yYXdbMV0gPSBpcnRl
LnJhd1sxXTsKLSAgICAgICAgLyogSGlnaCBoYWxmIG5lZWRzIHRvIGJlIHNldCBiZWZvcmUgbG93
IG9uZSAoY29udGFpbmluZyBSZW1hcEVuKS4gKi8KLSAgICAgICAgc21wX3dtYigpOwogICAgICAg
ICBBQ0NFU1NfT05DRShlbnRyeS5wdHIxMjgtPnJhd1swXSkgPSBpcnRlLnJhd1swXTsKICAgICB9
CiAgICAgZWxzZQpAQCAtMjk2LDYgKzI5NCwyMCBAQCBzdGF0aWMgaW50IHVwZGF0ZV9pbnRyZW1h
cF9lbnRyeV9mcm9tX2lvCiAgICAgfQogCiAgICAgZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnko
aW9tbXUsIHJlcV9pZCwgb2Zmc2V0KTsKKworICAgIC8qIFRoZSBSZW1hcEVuIGZpZWxkcyBtYXRj
aCBmb3IgYWxsIGZvcm1hdHMuICovCisgICAgd2hpbGUgKCBpb21tdS0+ZW5hYmxlZCAmJiBlbnRy
eS5wdHIzMi0+Zmxkcy5yZW1hcF9lbiApCisgICAgeworICAgICAgICBlbnRyeS5wdHIzMi0+Zmxk
cy5yZW1hcF9lbiA9IGZhbHNlOworICAgICAgICBzcGluX3VubG9jayhsb2NrKTsKKworICAgICAg
ICBzcGluX2xvY2soJmlvbW11LT5sb2NrKTsKKyAgICAgICAgYW1kX2lvbW11X2ZsdXNoX2ludHJl
bWFwKGlvbW11LCByZXFfaWQpOworICAgICAgICBzcGluX3VubG9jaygmaW9tbXUtPmxvY2spOwor
CisgICAgICAgIHNwaW5fbG9jayhsb2NrKTsKKyAgICB9CisKICAgICBpZiAoIGZyZXNoICkKICAg
ICAgICAgLyogbm90aGluZyAqLzsKICAgICBlbHNlIGlmICggIWxvX3VwZGF0ZSApCkBAIC0zMjUs
MTMgKzMzNyw2IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2ludHJlbWFwX2VudHJ5X2Zyb21faW8KIAog
ICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOwogCi0gICAgaWYgKCBpb21t
dS0+ZW5hYmxlZCAmJiAhZnJlc2ggKQotICAgIHsKLSAgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUo
JmlvbW11LT5sb2NrLCBmbGFncyk7Ci0gICAgICAgIGFtZF9pb21tdV9mbHVzaF9pbnRyZW1hcChp
b21tdSwgcmVxX2lkKTsKLSAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPmxv
Y2ssIGZsYWdzKTsKLSAgICB9Ci0KICAgICBzZXRfcnRlX2luZGV4KHJ0ZSwgb2Zmc2V0KTsKIAog
ICAgIHJldHVybiAwOwpAQCAtNTg3LDE5ICs1OTIsMjcgQEAgc3RhdGljIGludCB1cGRhdGVfaW50
cmVtYXBfZW50cnlfZnJvbV9tcwogICAgIHJlcV9pZCA9IGdldF9kbWFfcmVxdWVzdG9yX2lkKGlv
bW11LT5zZWcsIGJkZik7CiAgICAgYWxpYXNfaWQgPSBnZXRfaW50cmVtYXBfcmVxdWVzdG9yX2lk
KGlvbW11LT5zZWcsIGJkZik7CiAKKyAgICBsb2NrID0gZ2V0X2ludHJlbWFwX2xvY2soaW9tbXUt
PnNlZywgcmVxX2lkKTsKKyAgICBzcGluX2xvY2tfaXJxc2F2ZShsb2NrLCBmbGFncyk7CisKICAg
ICBpZiAoIG1zZyA9PSBOVUxMICkKICAgICB7Ci0gICAgICAgIGxvY2sgPSBnZXRfaW50cmVtYXBf
bG9jayhpb21tdS0+c2VnLCByZXFfaWQpOwotICAgICAgICBzcGluX2xvY2tfaXJxc2F2ZShsb2Nr
LCBmbGFncyk7CiAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgbnI7ICsraSApCiAgICAgICAgICAg
ICBmcmVlX2ludHJlbWFwX2VudHJ5KGlvbW11LCByZXFfaWQsICpyZW1hcF9pbmRleCArIGkpOwog
ICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKGxvY2ssIGZsYWdzKTsKLSAgICAgICAgZ290
byBkb25lOwotICAgIH0KIAotICAgIGxvY2sgPSBnZXRfaW50cmVtYXBfbG9jayhpb21tdS0+c2Vn
LCByZXFfaWQpOworICAgICAgICBpZiAoIGlvbW11LT5lbmFibGVkICkKKyAgICAgICAgeworICAg
ICAgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlvbW11LT5sb2NrLCBmbGFncyk7CisgICAgICAg
ICAgICBhbWRfaW9tbXVfZmx1c2hfaW50cmVtYXAoaW9tbXUsIHJlcV9pZCk7CisgICAgICAgICAg
ICBpZiAoIGFsaWFzX2lkICE9IHJlcV9pZCApCisgICAgICAgICAgICAgICAgYW1kX2lvbW11X2Zs
dXNoX2ludHJlbWFwKGlvbW11LCBhbGlhc19pZCk7CisgICAgICAgICAgICBzcGluX3VubG9ja19p
cnFyZXN0b3JlKCZpb21tdS0+bG9jaywgZmxhZ3MpOworICAgICAgICB9CisKKyAgICAgICAgcmV0
dXJuIDA7CisgICAgfQogCi0gICAgc3Bpbl9sb2NrX2lycXNhdmUobG9jaywgZmxhZ3MpOwogICAg
IGRlc3RfbW9kZSA9IChtc2ctPmFkZHJlc3NfbG8gPj4gTVNJX0FERFJfREVTVE1PREVfU0hJRlQp
ICYgMHgxOwogICAgIGRlbGl2ZXJ5X21vZGUgPSAobXNnLT5kYXRhID4+IE1TSV9EQVRBX0RFTElW
RVJZX01PREVfU0hJRlQpICYgMHgxOwogICAgIHZlY3RvciA9IChtc2ctPmRhdGEgPj4gTVNJX0RB
VEFfVkVDVE9SX1NISUZUKSAmIE1TSV9EQVRBX1ZFQ1RPUl9NQVNLOwpAQCAtNjIzLDYgKzYzNiwy
MiBAQCBzdGF0aWMgaW50IHVwZGF0ZV9pbnRyZW1hcF9lbnRyeV9mcm9tX21zCiAgICAgfQogCiAg
ICAgZW50cnkgPSBnZXRfaW50cmVtYXBfZW50cnkoaW9tbXUsIHJlcV9pZCwgb2Zmc2V0KTsKKwor
ICAgIC8qIFRoZSBSZW1hcEVuIGZpZWxkcyBtYXRjaCBmb3IgYWxsIGZvcm1hdHMuICovCisgICAg
d2hpbGUgKCBpb21tdS0+ZW5hYmxlZCAmJiBlbnRyeS5wdHIzMi0+Zmxkcy5yZW1hcF9lbiApCisg
ICAgeworICAgICAgICBlbnRyeS5wdHIzMi0+Zmxkcy5yZW1hcF9lbiA9IGZhbHNlOworICAgICAg
ICBzcGluX3VubG9jayhsb2NrKTsKKworICAgICAgICBzcGluX2xvY2soJmlvbW11LT5sb2NrKTsK
KyAgICAgICAgYW1kX2lvbW11X2ZsdXNoX2ludHJlbWFwKGlvbW11LCByZXFfaWQpOworICAgICAg
ICBpZiAoIGFsaWFzX2lkICE9IHJlcV9pZCApCisgICAgICAgICAgICBhbWRfaW9tbXVfZmx1c2hf
aW50cmVtYXAoaW9tbXUsIGFsaWFzX2lkKTsKKyAgICAgICAgc3Bpbl91bmxvY2soJmlvbW11LT5s
b2NrKTsKKworICAgICAgICBzcGluX2xvY2sobG9jayk7CisgICAgfQorCiAgICAgdXBkYXRlX2lu
dHJlbWFwX2VudHJ5KGlvbW11LCBlbnRyeSwgdmVjdG9yLCBkZWxpdmVyeV9tb2RlLCBkZXN0X21v
ZGUsIGRlc3QpOwogICAgIHNwaW5fdW5sb2NrX2lycXJlc3RvcmUobG9jaywgZmxhZ3MpOwogCkBA
IC02NDIsMTYgKzY3MSw2IEBAIHN0YXRpYyBpbnQgdXBkYXRlX2ludHJlbWFwX2VudHJ5X2Zyb21f
bXMKICAgICAgICAgICAgICAgIGdldF9pdnJzX21hcHBpbmdzKGlvbW11LT5zZWcpW2FsaWFzX2lk
XS5pbnRyZW1hcF90YWJsZSk7CiAgICAgfQogCi1kb25lOgotICAgIGlmICggaW9tbXUtPmVuYWJs
ZWQgKQotICAgIHsKLSAgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlvbW11LT5sb2NrLCBmbGFn
cyk7Ci0gICAgICAgIGFtZF9pb21tdV9mbHVzaF9pbnRyZW1hcChpb21tdSwgcmVxX2lkKTsKLSAg
ICAgICAgaWYgKCBhbGlhc19pZCAhPSByZXFfaWQgKQotICAgICAgICAgICAgYW1kX2lvbW11X2Zs
dXNoX2ludHJlbWFwKGlvbW11LCBhbGlhc19pZCk7Ci0gICAgICAgIHNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJmlvbW11LT5sb2NrLCBmbGFncyk7Ci0gICAgfQotCiAgICAgcmV0dXJuIDA7CiB9CiAK

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain;
	name="11-AMD-IOMMU-IRT-dump-suppress-headers.patch"
Content-Description: 11-AMD-IOMMU-IRT-dump-suppress-headers.patch
Content-Disposition: attachment;
	filename="11-AMD-IOMMU-IRT-dump-suppress-headers.patch"; size=4009;
	creation-date="Thu, 25 Jul 2019 13:19:10 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:10 GMT"
Content-ID: <0593F02ED9060B47BC2714DC2012EFD9@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBkb24ndCBuZWVkbGVzc2x5IGxvZyBoZWFkZXJzIHdoZW4gZHVtcGluZyBJUlRz
CgpMb2cgU0JERiBoZWFkZXJzIG9ubHkgd2hlbiB0aGVyZSBhcmUgYWN0dWFsIElSVEVzIHRvIGxv
Zy4gVGhpcyBpcwpwYXJ0aWN1bGFybHkgaW1wb3J0YW50IGZvciB0aGUgdG90YWwgdm9sdW1lIG9m
IG91dHB1dCB3aGVuIHRoZSBBQ1BJCnRhYmxlcyBkZXNjcmliZSBmYXIgbW9yZSB0aGFuIGp1c3Qg
dGhlIGV4aXN0aW5nIGRldmljZXMuIE9uIG15IFJvbWUKc3lzdGVtIHNvIGZhciB0aGVyZSB3YXMg
b25lIGxpbmUgZm9yIGV2ZXJ5IGZ1bmN0aW9uIG9mIGV2ZXJ5IGRldmljZSBvbgphbGwgMjU2IGJ1
c2VzIG9mIHNlZ21lbnQgMCwgd2l0aCBleHRyZW1lbHkgZmV3IGV4Y2VwdGlvbnMgKGxpa2UgdGhl
CklPTU1VcyB0aGVtc2VsdmVzKS4KCkFsc28gb25seSBsb2cgb25lIG9mIHRoZSAicGVyLWRldmlj
ZSIgb3IgInNoYXJlZCIgb3ZlcmFsbCBoZWFkZXJzLgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxp
Y2ggPGpiZXVsaWNoQHN1c2UuY29tPgotLS0KdjQ6IE5ldy4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bh
c3N0aHJvdWdoL2FtZC9pb21tdV9pbnRyLmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gv
YW1kL2lvbW11X2ludHIuYwpAQCAtODgzLDcgKzg4Myw4IEBAIGludCBfX2luaXQgYW1kX3NldHVw
X2hwZXRfbXNpKHN0cnVjdCBtc2kKIH0KIAogc3RhdGljIHZvaWQgZHVtcF9pbnRyZW1hcF90YWJs
ZShjb25zdCBzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdW5pb24gaXJ0ZV9jcHRyIHRibCkKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdW5pb24gaXJ0ZV9jcHRyIHRibCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29uc3Qgc3RydWN0IGl2cnNfbWFwcGluZ3MgKml2cnNfbWFwcGluZykKIHsKICAgICB1bnNp
Z25lZCBpbnQgY291bnQ7CiAKQEAgLTg5MiwxOSArODkzLDI1IEBAIHN0YXRpYyB2b2lkIGR1bXBf
aW50cmVtYXBfdGFibGUoY29uc3Qgc3QKIAogICAgIGZvciAoIGNvdW50ID0gMDsgY291bnQgPCBJ
TlRSRU1BUF9FTlRSSUVTOyBjb3VudCsrICkKICAgICB7Ci0gICAgICAgIGlmICggaW9tbXUtPmN0
cmwuZ2FfZW4gKQotICAgICAgICB7Ci0gICAgICAgICAgICBpZiAoICF0YmwucHRyMTI4W2NvdW50
XS5yYXdbMF0gJiYgIXRibC5wdHIxMjhbY291bnRdLnJhd1sxXSApCisgICAgICAgIGlmICggaW9t
bXUtPmN0cmwuZ2FfZW4KKyAgICAgICAgICAgICA/ICF0YmwucHRyMTI4W2NvdW50XS5yYXdbMF0g
JiYgIXRibC5wdHIxMjhbY291bnRdLnJhd1sxXQorICAgICAgICAgICAgIDogIXRibC5wdHIzMltj
b3VudF0ucmF3ICkKICAgICAgICAgICAgICAgICBjb250aW51ZTsKKworICAgICAgICBpZiAoIGl2
cnNfbWFwcGluZyApCisgICAgICAgIHsKKyAgICAgICAgICAgIHByaW50aygiICAlMDR4OiUwMng6
JTAyeDoldTpcbiIsIGlvbW11LT5zZWcsCisgICAgICAgICAgICAgICAgICAgUENJX0JVUyhpdnJz
X21hcHBpbmctPmR0ZV9yZXF1ZXN0b3JfaWQpLAorICAgICAgICAgICAgICAgICAgIFBDSV9TTE9U
KGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCksCisgICAgICAgICAgICAgICAgICAgUENJ
X0ZVTkMoaXZyc19tYXBwaW5nLT5kdGVfcmVxdWVzdG9yX2lkKSk7CisgICAgICAgICAgICBpdnJz
X21hcHBpbmcgPSBOVUxMOworICAgICAgICB9CisKKyAgICAgICAgaWYgKCBpb21tdS0+Y3RybC5n
YV9lbiApCiAgICAgICAgICAgICBwcmludGsoIiAgICBJUlRFWyUwM3hdICUwMTZseF8lMDE2bHhc
biIsCiAgICAgICAgICAgICAgICAgICAgY291bnQsIHRibC5wdHIxMjhbY291bnRdLnJhd1sxXSwg
dGJsLnB0cjEyOFtjb3VudF0ucmF3WzBdKTsKLSAgICAgICAgfQogICAgICAgICBlbHNlCi0gICAg
ICAgIHsKLSAgICAgICAgICAgIGlmICggIXRibC5wdHIzMltjb3VudF0ucmF3ICkKLSAgICAgICAg
ICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgIHByaW50aygiICAgIElSVEVbJTAzeF0gJTA4
eFxuIiwgY291bnQsIHRibC5wdHIzMltjb3VudF0ucmF3KTsKLSAgICAgICAgfQogICAgIH0KIH0K
IApAQCAtOTE2LDEzICs5MjMsOCBAQCBzdGF0aWMgaW50IGR1bXBfaW50cmVtYXBfbWFwcGluZyhj
b25zdCBzCiAgICAgaWYgKCAhaXZyc19tYXBwaW5nICkKICAgICAgICAgcmV0dXJuIDA7CiAKLSAg
ICBwcmludGsoIiAgJTA0eDolMDJ4OiUwMng6JXU6XG4iLCBpb21tdS0+c2VnLAotICAgICAgICAg
ICBQQ0lfQlVTKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCksCi0gICAgICAgICAgIFBD
SV9TTE9UKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCksCi0gICAgICAgICAgIFBDSV9G
VU5DKGl2cnNfbWFwcGluZy0+ZHRlX3JlcXVlc3Rvcl9pZCkpOwotCiAgICAgc3Bpbl9sb2NrX2ly
cXNhdmUoJihpdnJzX21hcHBpbmctPmludHJlbWFwX2xvY2spLCBmbGFncyk7Ci0gICAgZHVtcF9p
bnRyZW1hcF90YWJsZShpb21tdSwgaXZyc19tYXBwaW5nLT5pbnRyZW1hcF90YWJsZSk7CisgICAg
ZHVtcF9pbnRyZW1hcF90YWJsZShpb21tdSwgaXZyc19tYXBwaW5nLT5pbnRyZW1hcF90YWJsZSwg
aXZyc19tYXBwaW5nKTsKICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCYoaXZyc19tYXBwaW5n
LT5pbnRyZW1hcF9sb2NrKSwgZmxhZ3MpOwogCiAgICAgcHJvY2Vzc19wZW5kaW5nX3NvZnRpcnFz
KCk7CkBAIC05MzIsMTcgKzkzNCwyMiBAQCBzdGF0aWMgaW50IGR1bXBfaW50cmVtYXBfbWFwcGlu
Zyhjb25zdCBzCiAKIHN0YXRpYyB2b2lkIGR1bXBfaW50cmVtYXBfdGFibGVzKHVuc2lnbmVkIGNo
YXIga2V5KQogewotICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7Ci0KLSAgICBwcmludGsoIi0tLSBE
dW1waW5nIFBlci1kZXYgSU9NTVUgSW50ZXJydXB0IFJlbWFwcGluZyBUYWJsZSAtLS1cbiIpOwor
ICAgIGlmICggIXNoYXJlZF9pbnRyZW1hcF90YWJsZSApCisgICAgeworICAgICAgICBwcmludGso
Ii0tLSBEdW1waW5nIFBlci1kZXYgSU9NTVUgSW50ZXJydXB0IFJlbWFwcGluZyBUYWJsZSAtLS1c
biIpOwogCi0gICAgaXRlcmF0ZV9pdnJzX2VudHJpZXMoZHVtcF9pbnRyZW1hcF9tYXBwaW5nKTsK
KyAgICAgICAgaXRlcmF0ZV9pdnJzX2VudHJpZXMoZHVtcF9pbnRyZW1hcF9tYXBwaW5nKTsKKyAg
ICB9CisgICAgZWxzZQorICAgIHsKKyAgICAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKIAotICAg
IHByaW50aygiLS0tIER1bXBpbmcgU2hhcmVkIElPTU1VIEludGVycnVwdCBSZW1hcHBpbmcgVGFi
bGUgLS0tXG4iKTsKKyAgICAgICAgcHJpbnRrKCItLS0gRHVtcGluZyBTaGFyZWQgSU9NTVUgSW50
ZXJydXB0IFJlbWFwcGluZyBUYWJsZSAtLS1cbiIpOwogCi0gICAgc3Bpbl9sb2NrX2lycXNhdmUo
JnNoYXJlZF9pbnRyZW1hcF9sb2NrLCBmbGFncyk7Ci0gICAgZHVtcF9pbnRyZW1hcF90YWJsZShs
aXN0X2ZpcnN0X2VudHJ5KCZhbWRfaW9tbXVfaGVhZCwgc3RydWN0IGFtZF9pb21tdSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCksCi0gICAgICAgICAgICAg
ICAgICAgICAgICBzaGFyZWRfaW50cmVtYXBfdGFibGUpOwotICAgIHNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJnNoYXJlZF9pbnRyZW1hcF9sb2NrLCBmbGFncyk7CisgICAgICAgIHNwaW5fbG9ja19p
cnFzYXZlKCZzaGFyZWRfaW50cmVtYXBfbG9jaywgZmxhZ3MpOworICAgICAgICBkdW1wX2ludHJl
bWFwX3RhYmxlKGxpc3RfZmlyc3RfZW50cnkoJmFtZF9pb21tdV9oZWFkLCBzdHJ1Y3QgYW1kX2lv
bW11LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCks
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkX2ludHJlbWFwX3RhYmxlLCBOVUxM
KTsKKyAgICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmc2hhcmVkX2ludHJlbWFwX2xvY2ss
IGZsYWdzKTsKKyAgICB9CiB9Cg==

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; name="12-AMD-IOMMU-misc-DTE.patch"
Content-Description: 12-AMD-IOMMU-misc-DTE.patch
Content-Disposition: attachment; filename="12-AMD-IOMMU-misc-DTE.patch";
	size=9249; creation-date="Thu, 25 Jul 2019 13:19:11 GMT";
	modification-date="Thu, 25 Jul 2019 13:19:11 GMT"
Content-ID: <FA0E99A285739743AC4AD7FF435E74F0@namprd18.prod.outlook.com>
Content-Transfer-Encoding: base64

QU1EL0lPTU1VOiBtaXNjZWxsYW5lb3VzIERURSBoYW5kbGluZyBhZGp1c3RtZW50cwoKRmlyc3Qg
YW5kIGZvcmVtb3N0IHN3aXRjaCBib29sZWFuIGZpZWxkcyB0byBib29sLiBBZGp1c3QgYSBmZXcg
cmVsYXRlZApmdW5jdGlvbiBwYXJhbWV0ZXJzIGFzIHdlbGwuIFRoZW4KLSBpbiBhbWRfaW9tbXVf
c2V0X2ludHJlbWFwX3RhYmxlKCkgZG9uJ3QgdXNlIGxpdGVyYWwgbnVtYmVycywKLSBpbiBpb21t
dV9kdGVfYWRkX2RldmljZV9lbnRyeSgpIHVzZSBhIGNvbXBvdW5kIGxpdGVyYWwgaW5zdGVhZCBv
ZiBtYW55CiAgYXNzaWdubWVudHMsCi0gaW4gYW1kX2lvbW11X3NldHVwX2RvbWFpbl9kZXZpY2Uo
KQogIC0gZWxpbWluYXRlIGEgcG9pbnRsZXNzIGxvY2FsIHZhcmlhYmxlLAogIC0gdXNlIHx8IGlu
c3RlYWQgb2YgJiYgd2hlbiBkZWNpZGluZyB3aGV0aGVyIHRvIGNsZWFyIGFuIGVudHJ5LAogIC0g
Y2xlYXIgdGhlIEkgZmllbGQgd2l0aG91dCBhbnkgY2hlY2tpbmcgb2YgQVRTIC8gSU9UTEIgc3Rh
dGUsCi0gbGVhdmUgcmVzZXJ2ZWQgZmllbGRzIHVubmFtZWQuCgpTaWduZWQtb2ZmLWJ5OiBKYW4g
QmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+Ci0tLQp2NDogTmV3LgoKLS0tIGEveGVuL2RyaXZl
cnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2ludHIuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhy
b3VnaC9hbWQvaW9tbXVfaW50ci5jCkBAIC02OSw4ICs2OSw3IEBAIHVuaW9uIGlydGVfY3B0ciB7
CiAgICAgY29uc3QgdW5pb24gaXJ0ZTEyOCAqcHRyMTI4OwogfSBfX3RyYW5zcGFyZW50X187CiAK
LSNkZWZpbmUgSU5UUkVNQVBfTEVOR1RIIDB4QgotI2RlZmluZSBJTlRSRU1BUF9FTlRSSUVTICgx
IDw8IElOVFJFTUFQX0xFTkdUSCkKKyNkZWZpbmUgSU5UUkVNQVBfRU5UUklFUyAoMSA8PCBJT01N
VV9JTlRSRU1BUF9MRU5HVEgpCiAKIHN0cnVjdCBpb2FwaWNfc2JkZiBpb2FwaWNfc2JkZltNQVhf
SU9fQVBJQ1NdOwogc3RydWN0IGhwZXRfc2JkZiBocGV0X3NiZGY7Ci0tLSBhL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9tYXAuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3Vn
aC9hbWQvaW9tbXVfbWFwLmMKQEAgLTEwMSw1MSArMTAxLDUyIEBAIHN0YXRpYyB1bnNpZ25lZCBp
bnQgc2V0X2lvbW11X3B0ZV9wcmVzZW4KIAogdm9pZCBhbWRfaW9tbXVfc2V0X3Jvb3RfcGFnZV90
YWJsZShzdHJ1Y3QgYW1kX2lvbW11X2R0ZSAqZHRlLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50NjRfdCByb290X3B0ciwgdWludDE2X3QgZG9tYWluX2lkLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90IHBhZ2luZ19tb2RlLCB1aW50OF90
IHZhbGlkKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90IHBhZ2lu
Z19tb2RlLCBib29sIHZhbGlkKQogewogICAgIGR0ZS0+ZG9tYWluX2lkID0gZG9tYWluX2lkOwog
ICAgIGR0ZS0+cHRfcm9vdCA9IHBhZGRyX3RvX3Bmbihyb290X3B0cik7Ci0gICAgZHRlLT5pdyA9
IDE7Ci0gICAgZHRlLT5pciA9IDE7CisgICAgZHRlLT5pdyA9IHRydWU7CisgICAgZHRlLT5pciA9
IHRydWU7CiAgICAgZHRlLT5wYWdpbmdfbW9kZSA9IHBhZ2luZ19tb2RlOwotICAgIGR0ZS0+dHYg
PSAxOworICAgIGR0ZS0+dHYgPSB0cnVlOwogICAgIGR0ZS0+diA9IHZhbGlkOwogfQogCiB2b2lk
IF9faW5pdCBhbWRfaW9tbXVfc2V0X2ludHJlbWFwX3RhYmxlKAotICAgIHN0cnVjdCBhbWRfaW9t
bXVfZHRlICpkdGUsIHVpbnQ2NF90IGludHJlbWFwX3B0ciwgdWludDhfdCBpbnRfdmFsaWQpCisg
ICAgc3RydWN0IGFtZF9pb21tdV9kdGUgKmR0ZSwgdWludDY0X3QgaW50cmVtYXBfcHRyLCBib29s
IHZhbGlkKQogewogICAgIGR0ZS0+aXRfcm9vdCA9IGludHJlbWFwX3B0ciA+PiA2OwotICAgIGR0
ZS0+aW50X3RhYl9sZW4gPSAweGI7IC8qIDIwNDggZW50cmllcyAqLwotICAgIGR0ZS0+aW50X2N0
bCA9IDI7IC8qIGZpeGVkIGFuZCBhcmJpdHJhdGVkIGludGVycnVwdHMgcmVtYXBwZWQgKi8KLSAg
ICBkdGUtPmlnID0gMDsgLyogdW5tYXBwZWQgaW50ZXJydXB0IHJlc3VsdHMgaW8gcGFnZSBmYXVs
dHMgKi8KLSAgICBkdGUtPml2ID0gaW50X3ZhbGlkOworICAgIGR0ZS0+aW50X3RhYl9sZW4gPSBJ
T01NVV9JTlRSRU1BUF9MRU5HVEg7CisgICAgZHRlLT5pbnRfY3RsID0gSU9NTVVfREVWX1RBQkxF
X0lOVF9DT05UUk9MX1RSQU5TTEFURUQ7CisgICAgZHRlLT5pZyA9IGZhbHNlOyAvKiB1bm1hcHBl
ZCBpbnRlcnJ1cHRzIHJlc3VsdCBpbiBpL28gcGFnZSBmYXVsdHMgKi8KKyAgICBkdGUtPml2ID0g
dmFsaWQ7CiB9CiAKIHZvaWQgX19pbml0IGlvbW11X2R0ZV9hZGRfZGV2aWNlX2VudHJ5KHN0cnVj
dCBhbWRfaW9tbXVfZHRlICpkdGUsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19kZXYpCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgaXZyc19tYXBwaW5ncyAqaXZyc19kZXYp
CiB7CiAgICAgdWludDhfdCBmbGFncyA9IGl2cnNfZGV2LT5kZXZpY2VfZmxhZ3M7CiAKLSAgICBt
ZW1zZXQoZHRlLCAwLCBzaXplb2YoKmR0ZSkpOwotCi0gICAgZHRlLT5pbml0X3Bhc3MgPSBNQVNL
X0VYVFIoZmxhZ3MsIEFDUElfSVZIRF9JTklUX1BBU1MpOwotICAgIGR0ZS0+ZXh0X2ludF9wYXNz
ID0gTUFTS19FWFRSKGZsYWdzLCBBQ1BJX0lWSERfRUlOVF9QQVNTKTsKLSAgICBkdGUtPm5taV9w
YXNzID0gTUFTS19FWFRSKGZsYWdzLCBBQ1BJX0lWSERfTk1JX1BBU1MpOwotICAgIGR0ZS0+bGlu
dDBfcGFzcyA9IE1BU0tfRVhUUihmbGFncywgQUNQSV9JVkhEX0xJTlQwX1BBU1MpOwotICAgIGR0
ZS0+bGludDFfcGFzcyA9IE1BU0tfRVhUUihmbGFncywgQUNQSV9JVkhEX0xJTlQxX1BBU1MpOwot
ICAgIGR0ZS0+c3lzX21ndCA9IE1BU0tfRVhUUihmbGFncywgQUNQSV9JVkhEX1NZU1RFTV9NR01U
KTsKLSAgICBkdGUtPmV4ID0gaXZyc19kZXYtPmR0ZV9hbGxvd19leGNsdXNpb247CisgICAgKmR0
ZSA9IChzdHJ1Y3QgYW1kX2lvbW11X2R0ZSl7CisgICAgICAgIC5pbml0X3Bhc3MgPSBmbGFncyAm
IEFDUElfSVZIRF9JTklUX1BBU1MsCisgICAgICAgIC5leHRfaW50X3Bhc3MgPSBmbGFncyAmIEFD
UElfSVZIRF9FSU5UX1BBU1MsCisgICAgICAgIC5ubWlfcGFzcyA9IGZsYWdzICYgQUNQSV9JVkhE
X05NSV9QQVNTLAorICAgICAgICAubGludDBfcGFzcyA9IGZsYWdzICYgQUNQSV9JVkhEX0xJTlQw
X1BBU1MsCisgICAgICAgIC5saW50MV9wYXNzID0gZmxhZ3MgJiBBQ1BJX0lWSERfTElOVDFfUEFT
UywKKyAgICAgICAgLmlvY3RsID0gSU9NTVVfREVWX1RBQkxFX0lPX0NPTlRST0xfQUJPUlRFRCwK
KyAgICAgICAgLnN5c19tZ3QgPSBNQVNLX0VYVFIoZmxhZ3MsIEFDUElfSVZIRF9TWVNURU1fTUdN
VCksCisgICAgICAgIC5leCA9IGl2cnNfZGV2LT5kdGVfYWxsb3dfZXhjbHVzaW9uLAorICAgIH07
CiB9CiAKIHZvaWQgaW9tbXVfZHRlX3NldF9ndWVzdF9jcjMoc3RydWN0IGFtZF9pb21tdV9kdGUg
KmR0ZSwgdWludDE2X3QgZG9tX2lkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50
NjRfdCBnY3IzX21mbiwgdWludDhfdCBndiwgdWludDhfdCBnbHgpCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVpbnQ2NF90IGdjcjNfbWZuLCBib29sIGd2LCB1aW50OF90IGdseCkKIHsK
ICNkZWZpbmUgR0NSM19NQVNLKGhpLCBsbykgKCgoMXVsIDw8ICgoaGkpICsgMSkpIC0gMSkgJiB+
KCgxdWwgPDwgKGxvKSkgLSAxKSkKICNkZWZpbmUgR0NSM19TSElGVChsbykgKChsbykgLSBQQUdF
X1NISUZUKQogCiAgICAgLyogSSBiaXQgbXVzdCBiZSBzZXQgd2hlbiBnY3IzIGlzIGVuYWJsZWQg
Ki8KLSAgICBkdGUtPmkgPSAxOworICAgIGR0ZS0+aSA9IHRydWU7CiAKICAgICBkdGUtPmdjcjNf
dHJwXzE0XzEyID0gKGdjcjNfbWZuICYgR0NSM19NQVNLKDE0LCAxMikpID4+IEdDUjNfU0hJRlQo
MTIpOwogICAgIGR0ZS0+Z2NyM190cnBfMzBfMTUgPSAoZ2NyM19tZm4gJiBHQ1IzX01BU0soMzAs
IDE1KSkgPj4gR0NSM19TSElGVCgxNSk7Ci0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2Ft
ZC9wY2lfYW1kX2lvbW11LmMKKysrIGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL3BjaV9h
bWRfaW9tbXUuYwpAQCAtOTMsNyArOTMsNiBAQCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfc2V0dXBf
ZG9tYWluX2RldmljCiAgICAgc3RydWN0IGFtZF9pb21tdV9kdGUgKnRhYmxlLCAqZHRlOwogICAg
IHVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAgICAgaW50IHJlcV9pZCwgdmFsaWQgPSAxOwotICAgIGlu
dCBkdGVfaSA9IDA7CiAgICAgdTggYnVzID0gcGRldi0+YnVzOwogICAgIGNvbnN0IHN0cnVjdCBk
b21haW5faW9tbXUgKmhkID0gZG9tX2lvbW11KGRvbWFpbik7CiAKQEAgLTEwMyw5ICsxMDIsNiBA
QCBzdGF0aWMgdm9pZCBhbWRfaW9tbXVfc2V0dXBfZG9tYWluX2RldmljCiAgICAgaWYgKCBpb21t
dV9od2RvbV9wYXNzdGhyb3VnaCAmJiBpc19oYXJkd2FyZV9kb21haW4oZG9tYWluKSApCiAgICAg
ICAgIHZhbGlkID0gMDsKIAotICAgIGlmICggYXRzX2VuYWJsZWQgKQotICAgICAgICBkdGVfaSA9
IDE7Ci0KICAgICAvKiBnZXQgZGV2aWNlLXRhYmxlIGVudHJ5ICovCiAgICAgcmVxX2lkID0gZ2V0
X2RtYV9yZXF1ZXN0b3JfaWQoaW9tbXUtPnNlZywgUENJX0JERjIoYnVzLCBkZXZmbikpOwogICAg
IHRhYmxlID0gaW9tbXUtPmRldl90YWJsZS5idWZmZXI7CkBAIC0xMjIsNyArMTE4LDcgQEAgc3Rh
dGljIHZvaWQgYW1kX2lvbW11X3NldHVwX2RvbWFpbl9kZXZpYwogCiAgICAgICAgIGlmICggcGNp
X2F0c19kZXZpY2UoaW9tbXUtPnNlZywgYnVzLCBwZGV2LT5kZXZmbikgJiYKICAgICAgICAgICAg
ICBpb21tdV9oYXNfY2FwKGlvbW11LCBQQ0lfQ0FQX0lPVExCX1NISUZUKSApCi0gICAgICAgICAg
ICBkdGUtPmkgPSBkdGVfaTsKKyAgICAgICAgICAgIGR0ZS0+aSA9IGF0c19lbmFibGVkOwogCiAg
ICAgICAgIGFtZF9pb21tdV9mbHVzaF9kZXZpY2UoaW9tbXUsIHJlcV9pZCk7CiAKQEAgLTI4OCwx
NCArMjg0LDExIEBAIHZvaWQgYW1kX2lvbW11X2Rpc2FibGVfZG9tYWluX2RldmljZShzdHIKICAg
ICBkdGUgPSAmdGFibGVbcmVxX2lkXTsKIAogICAgIHNwaW5fbG9ja19pcnFzYXZlKCZpb21tdS0+
bG9jaywgZmxhZ3MpOwotICAgIGlmICggZHRlLT50diAmJiBkdGUtPnYgKQorICAgIGlmICggZHRl
LT50diB8fCBkdGUtPnYgKQogICAgIHsKLSAgICAgICAgZHRlLT50diA9IDA7Ci0gICAgICAgIGR0
ZS0+diA9IDA7Ci0KLSAgICAgICAgaWYgKCBwY2lfYXRzX2RldmljZShpb21tdS0+c2VnLCBidXMs
IHBkZXYtPmRldmZuKSAmJgotICAgICAgICAgICAgIGlvbW11X2hhc19jYXAoaW9tbXUsIFBDSV9D
QVBfSU9UTEJfU0hJRlQpICkKLSAgICAgICAgICAgIGR0ZS0+aSA9IDA7CisgICAgICAgIGR0ZS0+
dHYgPSBmYWxzZTsKKyAgICAgICAgZHRlLT52ID0gZmFsc2U7CisgICAgICAgIGR0ZS0+aSA9IGZh
bHNlOwogCiAgICAgICAgIGFtZF9pb21tdV9mbHVzaF9kZXZpY2UoaW9tbXUsIHJlcV9pZCk7CiAK
LS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21tdS1kZWZzLmgKKysrIGIv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1pb21tdS1kZWZzLmgKQEAgLTEwNyw1NyAr
MTA3LDYwIEBACiAjZGVmaW5lIElPTU1VX0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9GT1JXQVJERUQJ
MHgxCiAjZGVmaW5lIElPTU1VX0RFVl9UQUJMRV9JTlRfQ09OVFJPTF9UUkFOU0xBVEVECTB4Mgog
CisvKiBGb3Igbm93IHdlIGFsd2F5cyBhbGxvY2F0ZSBtYXhpbXVtIHBvc3NpYmxlIGludGVycnVw
dCByZW1hcHBpbmcgdGFibGVzLiAqLworI2RlZmluZSBJT01NVV9JTlRSRU1BUF9MRU5HVEgJCQkw
eEIKKwogc3RydWN0IGFtZF9pb21tdV9kdGUgewogICAgIC8qIDAgLSA2MyAqLwotICAgIHVpbnQ2
NF90IHY6MTsKLSAgICB1aW50NjRfdCB0djoxOwotICAgIHVpbnQ2NF90IHJlc2VydmVkMDo1Owot
ICAgIHVpbnQ2NF90IGhhZDoyOwotICAgIHVpbnQ2NF90IHBhZ2luZ19tb2RlOjM7CisgICAgYm9v
bCB2OjE7CisgICAgYm9vbCB0djoxOworICAgIHVuc2lnbmVkIGludCA6NTsKKyAgICB1bnNpZ25l
ZCBpbnQgaGFkOjI7CisgICAgdW5zaWduZWQgaW50IHBhZ2luZ19tb2RlOjM7CiAgICAgdWludDY0
X3QgcHRfcm9vdDo0MDsKLSAgICB1aW50NjRfdCBwcHI6MTsKLSAgICB1aW50NjRfdCBncHJwOjE7
Ci0gICAgdWludDY0X3QgZ2lvdjoxOwotICAgIHVpbnQ2NF90IGd2OjE7Ci0gICAgdWludDY0X3Qg
Z2x4OjI7Ci0gICAgdWludDY0X3QgZ2NyM190cnBfMTRfMTI6MzsKLSAgICB1aW50NjRfdCBpcjox
OwotICAgIHVpbnQ2NF90IGl3OjE7Ci0gICAgdWludDY0X3QgcmVzZXJ2ZWQxOjE7CisgICAgYm9v
bCBwcHI6MTsKKyAgICBib29sIGdwcnA6MTsKKyAgICBib29sIGdpb3Y6MTsKKyAgICBib29sIGd2
OjE7CisgICAgdW5zaWduZWQgaW50IGdseDoyOworICAgIHVuc2lnbmVkIGludCBnY3IzX3RycF8x
NF8xMjozOworICAgIGJvb2wgaXI6MTsKKyAgICBib29sIGl3OjE7CisgICAgdW5zaWduZWQgaW50
IDoxOwogCiAgICAgLyogNjQgLSAxMjcgKi8KLSAgICB1aW50NjRfdCBkb21haW5faWQ6MTY7Ci0g
ICAgdWludDY0X3QgZ2NyM190cnBfMzBfMTU6MTY7Ci0gICAgdWludDY0X3QgaToxOwotICAgIHVp
bnQ2NF90IHNlOjE7Ci0gICAgdWludDY0X3Qgc2E6MTsKLSAgICB1aW50NjRfdCBpb2N0bDoyOwot
ICAgIHVpbnQ2NF90IGNhY2hlOjE7Ci0gICAgdWludDY0X3Qgc2Q6MTsKLSAgICB1aW50NjRfdCBl
eDoxOwotICAgIHVpbnQ2NF90IHN5c19tZ3Q6MjsKLSAgICB1aW50NjRfdCByZXNlcnZlZDI6MTsK
LSAgICB1aW50NjRfdCBnY3IzX3RycF81MV8zMToyMTsKKyAgICB1bnNpZ25lZCBpbnQgZG9tYWlu
X2lkOjE2OworICAgIHVuc2lnbmVkIGludCBnY3IzX3RycF8zMF8xNToxNjsKKyAgICBib29sIGk6
MTsKKyAgICBib29sIHNlOjE7CisgICAgYm9vbCBzYToxOworICAgIHVuc2lnbmVkIGludCBpb2N0
bDoyOworICAgIGJvb2wgY2FjaGU6MTsKKyAgICBib29sIHNkOjE7CisgICAgYm9vbCBleDoxOwor
ICAgIHVuc2lnbmVkIGludCBzeXNfbWd0OjI7CisgICAgdW5zaWduZWQgaW50IDoxOworICAgIHVu
c2lnbmVkIGludCBnY3IzX3RycF81MV8zMToyMTsKIAogICAgIC8qIDEyOCAtIDE5MSAqLwotICAg
IHVpbnQ2NF90IGl2OjE7Ci0gICAgdWludDY0X3QgaW50X3RhYl9sZW46NDsKLSAgICB1aW50NjRf
dCBpZzoxOworICAgIGJvb2wgaXY6MTsKKyAgICB1bnNpZ25lZCBpbnQgaW50X3RhYl9sZW46NDsK
KyAgICBib29sIGlnOjE7CiAgICAgdWludDY0X3QgaXRfcm9vdDo0NjsKLSAgICB1aW50NjRfdCBy
ZXNlcnZlZDM6NDsKLSAgICB1aW50NjRfdCBpbml0X3Bhc3M6MTsKLSAgICB1aW50NjRfdCBleHRf
aW50X3Bhc3M6MTsKLSAgICB1aW50NjRfdCBubWlfcGFzczoxOwotICAgIHVpbnQ2NF90IHJlc2Vy
dmVkNDoxOwotICAgIHVpbnQ2NF90IGludF9jdGw6MjsKLSAgICB1aW50NjRfdCBsaW50MF9wYXNz
OjE7Ci0gICAgdWludDY0X3QgbGludDFfcGFzczoxOworICAgIHVuc2lnbmVkIGludCA6NDsKKyAg
ICBib29sIGluaXRfcGFzczoxOworICAgIGJvb2wgZXh0X2ludF9wYXNzOjE7CisgICAgYm9vbCBu
bWlfcGFzczoxOworICAgIHVuc2lnbmVkIGludCA6MTsKKyAgICB1bnNpZ25lZCBpbnQgaW50X2N0
bDoyOworICAgIGJvb2wgbGludDBfcGFzczoxOworICAgIGJvb2wgbGludDFfcGFzczoxOwogCiAg
ICAgLyogMTkyIC0gMjU1ICovCi0gICAgdWludDY0X3QgcmVzZXJ2ZWQ1OjU0OwotICAgIHVpbnQ2
NF90IGF0dHJfdjoxOwotICAgIHVpbnQ2NF90IG1vZGUwX2ZjOjE7Ci0gICAgdWludDY0X3Qgc25v
b3BfYXR0cjo4OworICAgIHVpbnQ2NF90IDo1NDsKKyAgICBib29sIGF0dHJfdjoxOworICAgIGJv
b2wgbW9kZTBfZmM6MTsKKyAgICB1bnNpZ25lZCBpbnQgc25vb3BfYXR0cjo4OwogfTsKIAogLyog
Q29tbWFuZCBCdWZmZXIgKi8KLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vc3ZtL2FtZC1p
b21tdS1wcm90by5oCisrKyBiL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUt
cHJvdG8uaApAQCAtNzMsMTQgKzczLDE0IEBAIGludCBfX211c3RfY2hlY2sgYW1kX2lvbW11X2Zs
dXNoX2lvdGxiX2EKIGludCBnZXRfZG1hX3JlcXVlc3Rvcl9pZCh1aW50MTZfdCBzZWcsIHVpbnQx
Nl90IGJkZik7CiB2b2lkIGFtZF9pb21tdV9zZXRfaW50cmVtYXBfdGFibGUoc3RydWN0IGFtZF9p
b21tdV9kdGUgKmR0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50NjRf
dCBpbnRyZW1hcF9wdHIsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhf
dCBpbnRfdmFsaWQpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdmFs
aWQpOwogdm9pZCBhbWRfaW9tbXVfc2V0X3Jvb3RfcGFnZV90YWJsZShzdHJ1Y3QgYW1kX2lvbW11
X2R0ZSAqZHRlLAogCQkJCSAgIHVpbnQ2NF90IHJvb3RfcHRyLCB1aW50MTZfdCBkb21haW5faWQs
Ci0JCQkJICAgdWludDhfdCBwYWdpbmdfbW9kZSwgdWludDhfdCB2YWxpZCk7CisJCQkJICAgdWlu
dDhfdCBwYWdpbmdfbW9kZSwgYm9vbCB2YWxpZCk7CiB2b2lkIGlvbW11X2R0ZV9hZGRfZGV2aWNl
X2VudHJ5KHN0cnVjdCBhbWRfaW9tbXVfZHRlICpkdGUsCi0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX2Rldik7CisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBpdnJzX21hcHBpbmdzICppdnJzX2Rldik7
CiB2b2lkIGlvbW11X2R0ZV9zZXRfZ3Vlc3RfY3IzKHN0cnVjdCBhbWRfaW9tbXVfZHRlICpkdGUs
IHVpbnQxNl90IGRvbV9pZCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDY0X3Qg
Z2NyM19tZm4sIHVpbnQ4X3QgZ3YsIHVpbnQ4X3QgZ2x4KTsKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdWludDY0X3QgZ2NyM19tZm4sIGJvb2wgZ3YsIHVpbnQ4X3QgZ2x4KTsKIAogLyog
c2VuZCBjbWQgdG8gaW9tbXUgKi8KIHZvaWQgYW1kX2lvbW11X2ZsdXNoX2FsbF9wYWdlcyhzdHJ1
Y3QgZG9tYWluICpkKTsK

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--_013_b8ae110af94a4ed25cf9c00ff1c0cb81susecom_--


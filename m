Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 42FFD144DE
	for <lists+xen-devel@lfdr.de>; Mon,  6 May 2019 09:01:01 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hNXYW-0001sx-Ty; Mon, 06 May 2019 06:56:56 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=XZcu=TG=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hNXYV-0001sh-52
 for xen-devel@lists.xenproject.org; Mon, 06 May 2019 06:56:55 +0000
X-Inumbo-ID: 1ecbb7a7-6fcc-11e9-843c-bc764e045a96
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 1ecbb7a7-6fcc-11e9-843c-bc764e045a96;
 Mon, 06 May 2019 06:56:50 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id B4AC2AC8E;
 Mon,  6 May 2019 06:56:48 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Mon,  6 May 2019 08:56:01 +0200
Message-Id: <20190506065644.7415-3-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190506065644.7415-1-jgross@suse.com>
References: <20190506065644.7415-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH RFC V2 02/45] xen/sched: use new sched_item
 instead of vcpu in scheduler interfaces
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wei.liu2@citrix.com>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gb3JkZXIgdG8gcHJlcGFyZSBjb3JlLSBhbmQgc29ja2V0LXNjaGVkdWxpbmcgdXNlIGEgbmV3
IHN0cnVjdApzY2hlZF9pdGVtIGluc3RlYWQgb2Ygc3RydWN0IHZjcHUgZm9yIGludGVyZmFjZXMg
b2YgdGhlIGRpZmZlcmVudApzY2hlZHVsZXJzLgoKUmVuYW1lIHRoZSBwZXItc2NoZWR1bGVyIGZ1
bmN0aW9ucyBpbnNlcnRfdmNwdSBhbmQgcmVtb3ZlX3ZjcHUgdG8KaW5zZXJ0X2l0ZW0gYW5kIHJl
bW92ZV9pdGVtIHRvIHJlZmxlY3QgdGhlIGNoYW5nZSBvZiB0aGUgcGFyYW1ldGVyLgpJbiB0aGUg
c2NoZWR1bGVycyByZW5hbWUgbG9jYWwgZnVuY3Rpb25zIHN3aXRjaGVkIHRvIHNjaGVkX2l0ZW0s
IHRvby4KCkZvciBub3cgdGhpcyBuZXcgc3RydWN0IHdpbGwgY29udGFpbiBhIHZjcHUgcG9pbnRl
ciBvbmx5IGFuZCBpcwphbGxvY2F0ZWQgb24gdGhlIHN0YWNrLiBUaGlzIHdpbGwgYmUgY2hhbmdl
ZCBsYXRlci4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4K
LS0tClJGQyBWMjoKLSBtb3ZlIGRlZmluaXRpb24gb2Ygc3RydWN0IHNjaGVkX2l0ZW0gdG8gc2No
ZWQuaCAoQW5kcmV3IENvb3BlcikKLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMgfCAz
MCArKysrKysrKystLS0tLS0KIHhlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMgICB8IDQxICsrKysr
KysrKysrKy0tLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyAgfCA1NyArKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX251bGwuYyAgICAgfCAzOSAr
KysrKysrKysrKystLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX3J0LmMgICAgICAgfCAzMyArKysr
KysrKystLS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkdWxlLmMgICAgICAgfCA1MyArKysrKysrKysr
KysrKysrKystLS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmggIHwgOTIgKysrKysr
KysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS94ZW4v
c2NoZWQuaCAgICAgfCAgNCArKwogOCBmaWxlcyBjaGFuZ2VkLCAyMTggaW5zZXJ0aW9ucygrKSwg
MTMxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMu
YyBiL3hlbi9jb21tb24vc2NoZWRfYXJpbmM2NTMuYwppbmRleCBhNGM2ZDAwYjgxLi5mZmZlMjMx
MTNlIDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMKKysrIGIveGVuL2Nv
bW1vbi9zY2hlZF9hcmluYzY1My5jCkBAIC0zNzYsMTMgKzM3NiwxNiBAQCBhNjUzc2NoZWRfZGVp
bml0KHN0cnVjdCBzY2hlZHVsZXIgKm9wcykKICAqIFRoaXMgZnVuY3Rpb24gYWxsb2NhdGVzIHNj
aGVkdWxlci1zcGVjaWZpYyBkYXRhIGZvciBhIFZDUFUKICAqCiAgKiBAcGFyYW0gb3BzICAgICAg
IFBvaW50ZXIgdG8gdGhpcyBpbnN0YW5jZSBvZiB0aGUgc2NoZWR1bGVyIHN0cnVjdHVyZQorICog
QHBhcmFtIGl0ZW0gICAgICBQb2ludGVyIHRvIHN0cnVjdCBzY2hlZF9pdGVtCiAgKgogICogQHJl
dHVybiAgICAgICAgICBQb2ludGVyIHRvIHRoZSBhbGxvY2F0ZWQgZGF0YQogICovCiBzdGF0aWMg
dm9pZCAqCi1hNjUzc2NoZWRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
LCBzdHJ1Y3QgdmNwdSAqdmMsIHZvaWQgKmRkKQorYTY1M3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0sCisgICAgICAg
ICAgICAgICAgICAgICAgdm9pZCAqZGQpCiB7CiAgICAgYTY1M3NjaGVkX3ByaXZfdCAqc2NoZWRf
cHJpdiA9IFNDSEVEX1BSSVYob3BzKTsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1
OwogICAgIGFyaW5jNjUzX3ZjcHVfdCAqc3ZjOwogICAgIHVuc2lnbmVkIGludCBlbnRyeTsKICAg
ICB1bnNpZ25lZCBsb25nIGZsYWdzOwpAQCAtNDU4LDExICs0NjEsMTMgQEAgYTY1M3NjaGVkX2Zy
ZWVfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwcml2KQogICogWGVu
IHNjaGVkdWxlciBjYWxsYmFjayBmdW5jdGlvbiB0byBzbGVlcCBhIFZDUFUKICAqCiAgKiBAcGFy
YW0gb3BzICAgICAgIFBvaW50ZXIgdG8gdGhpcyBpbnN0YW5jZSBvZiB0aGUgc2NoZWR1bGVyIHN0
cnVjdHVyZQotICogQHBhcmFtIHZjICAgICAgICBQb2ludGVyIHRvIHRoZSBWQ1BVIHN0cnVjdHVy
ZSBmb3IgdGhlIGN1cnJlbnQgZG9tYWluCisgKiBAcGFyYW0gaXRlbSAgICAgIFBvaW50ZXIgdG8g
c3RydWN0IHNjaGVkX2l0ZW0KICAqLwogc3RhdGljIHZvaWQKLWE2NTNzY2hlZF92Y3B1X3NsZWVw
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorYTY1M3NjaGVk
X2l0ZW1fc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRl
bSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1OworCiAgICAgaWYg
KCBBVkNQVSh2YykgIT0gTlVMTCApCiAgICAgICAgIEFWQ1BVKHZjKS0+YXdha2UgPSAwOwogCkBA
IC00NzgsMTEgKzQ4MywxMyBAQCBhNjUzc2NoZWRfdmNwdV9zbGVlcChjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKICAqIFhlbiBzY2hlZHVsZXIgY2FsbGJhY2sg
ZnVuY3Rpb24gdG8gd2FrZSB1cCBhIFZDUFUKICAqCiAgKiBAcGFyYW0gb3BzICAgICAgIFBvaW50
ZXIgdG8gdGhpcyBpbnN0YW5jZSBvZiB0aGUgc2NoZWR1bGVyIHN0cnVjdHVyZQotICogQHBhcmFt
IHZjICAgICAgICBQb2ludGVyIHRvIHRoZSBWQ1BVIHN0cnVjdHVyZSBmb3IgdGhlIGN1cnJlbnQg
ZG9tYWluCisgKiBAcGFyYW0gaXRlbSAgICAgIFBvaW50ZXIgdG8gc3RydWN0IHNjaGVkX2l0ZW0K
ICAqLwogc3RhdGljIHZvaWQKLWE2NTNzY2hlZF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCithNjUzc2NoZWRfaXRlbV93YWtlKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAgc3Ry
dWN0IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsKKwogICAgIGlmICggQVZDUFUodmMpICE9IE5VTEwg
KQogICAgICAgICBBVkNQVSh2YyktPmF3YWtlID0gMTsKIApAQCAtNTk3LDEzICs2MDQsMTQgQEAg
YTY1M3NjaGVkX2RvX3NjaGVkdWxlKAogICogWGVuIHNjaGVkdWxlciBjYWxsYmFjayBmdW5jdGlv
biB0byBzZWxlY3QgYSBDUFUgZm9yIHRoZSBWQ1BVIHRvIHJ1biBvbgogICoKICAqIEBwYXJhbSBv
cHMgICAgICAgUG9pbnRlciB0byB0aGlzIGluc3RhbmNlIG9mIHRoZSBzY2hlZHVsZXIgc3RydWN0
dXJlCi0gKiBAcGFyYW0gdiAgICAgICAgIFBvaW50ZXIgdG8gdGhlIFZDUFUgc3RydWN0dXJlIGZv
ciB0aGUgY3VycmVudCBkb21haW4KKyAqIEBwYXJhbSBpdGVtICAgICAgUG9pbnRlciB0byBzdHJ1
Y3Qgc2NoZWRfaXRlbQogICoKICAqIEByZXR1cm4gICAgICAgICAgTnVtYmVyIG9mIHNlbGVjdGVk
IHBoeXNpY2FsIENQVQogICovCiBzdGF0aWMgaW50Ci1hNjUzc2NoZWRfcGlja19jcHUoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCithNjUzc2NoZWRfcGlja19j
cHUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkK
IHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIGNwdW1hc2tfdCAqb25s
aW5lOwogICAgIHVuc2lnbmVkIGludCBjcHU7CiAKQEAgLTcxMiwxMSArNzIwLDExIEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyIHNjaGVkX2FyaW5jNjUzX2RlZiA9IHsKICAgICAuZnJl
ZV92ZGF0YSAgICAgPSBhNjUzc2NoZWRfZnJlZV92ZGF0YSwKICAgICAuYWxsb2NfdmRhdGEgICAg
PSBhNjUzc2NoZWRfYWxsb2NfdmRhdGEsCiAKLSAgICAuaW5zZXJ0X3ZjcHUgICAgPSBOVUxMLAot
ICAgIC5yZW1vdmVfdmNwdSAgICA9IE5VTEwsCisgICAgLmluc2VydF9pdGVtICAgID0gTlVMTCwK
KyAgICAucmVtb3ZlX2l0ZW0gICAgPSBOVUxMLAogCi0gICAgLnNsZWVwICAgICAgICAgID0gYTY1
M3NjaGVkX3ZjcHVfc2xlZXAsCi0gICAgLndha2UgICAgICAgICAgID0gYTY1M3NjaGVkX3ZjcHVf
d2FrZSwKKyAgICAuc2xlZXAgICAgICAgICAgPSBhNjUzc2NoZWRfaXRlbV9zbGVlcCwKKyAgICAu
d2FrZSAgICAgICAgICAgPSBhNjUzc2NoZWRfaXRlbV93YWtlLAogICAgIC55aWVsZCAgICAgICAg
ICA9IE5VTEwsCiAgICAgLmNvbnRleHRfc2F2ZWQgID0gTlVMTCwKIApkaWZmIC0tZ2l0IGEveGVu
L2NvbW1vbi9zY2hlZF9jcmVkaXQuYyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKaW5kZXgg
M2FiZTIwZGVmOC4uMzczNTQ4NmI0YyAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZF9jcmVk
aXQuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCkBAIC04NjgsMTUgKzg2OCwxNiBA
QCBfY3NjaGVkX2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnZjLCBib29sX3QgY29tbWl0KQogfQogCiBzdGF0aWMgaW50Ci1jc2NoZWRfY3B1X3BpY2so
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWRfY3B1
X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRl
bSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBjc2No
ZWRfdmNwdSAqc3ZjID0gQ1NDSEVEX1ZDUFUodmMpOwogCiAgICAgLyoKICAgICAgKiBXZSBoYXZl
IGJlZW4gY2FsbGVkIGJ5IHZjcHVfbWlncmF0ZSgpIChpbiBzY2hlZHVsZS5jKSwgYXMgcGFydAog
ICAgICAqIG9mIHRoZSBwcm9jZXNzIG9mIHNlZWluZyBpZiB2YyBjYW4gYmUgbWlncmF0ZWQgdG8g
YW5vdGhlciBwY3B1LgogICAgICAqIFdlIG1ha2UgYSBub3RlIGFib3V0IHRoaXMgaW4gc3ZjLT5m
bGFncyBzbyB0aGF0IGxhdGVyLCBpbgotICAgICAqIGNzY2hlZF92Y3B1X3dha2UoKSAoc3RpbGwg
Y2FsbGVkIGZyb20gdmNwdV9taWdyYXRlKCkpIHdlIHdvbid0CisgICAgICogY3NjaGVkX2l0ZW1f
d2FrZSgpIChzdGlsbCBjYWxsZWQgZnJvbSB2Y3B1X21pZ3JhdGUoKSkgd2Ugd29uJ3QKICAgICAg
KiBnZXQgYm9vc3RlZCwgd2hpY2ggd2UgZG9uJ3QgZGVzZXJ2ZSBhcyB3ZSBhcmUgIm9ubHkiIG1p
Z3JhdGluZy4KICAgICAgKi8KICAgICBzZXRfYml0KENTQ0hFRF9GTEFHX1ZDUFVfTUlHUkFUSU5H
LCAmc3ZjLT5mbGFncyk7CkBAIC0xMDA0LDggKzEwMDUsMTAgQEAgY3NjaGVkX3ZjcHVfYWNjdChz
dHJ1Y3QgY3NjaGVkX3ByaXZhdGUgKnBydiwgdW5zaWduZWQgaW50IGNwdSkKIH0KIAogc3RhdGlj
IHZvaWQgKgotY3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHZjcHUgKnZjLCB2b2lkICpkZCkKK2NzY2hlZF9hbGxvY192ZGF0YShjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtLAorICAgICAgICAgICAg
ICAgICAgIHZvaWQgKmRkKQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IGl0ZW0tPnZjcHU7CiAg
ICAgc3RydWN0IGNzY2hlZF92Y3B1ICpzdmM7CiAKICAgICAvKiBBbGxvY2F0ZSBwZXItVkNQVSBp
bmZvICovCkBAIC0xMDI1LDggKzEwMjgsOSBAQCBjc2NoZWRfYWxsb2NfdmRhdGEoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMsIHZvaWQgKmRkKQogfQogCiBzdGF0
aWMgdm9pZAotY3NjaGVkX3ZjcHVfaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHZjcHUgKnZjKQorY3NjaGVkX2l0ZW1faW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0IHZjcHUgKnZj
ID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF9w
cml2OwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAKQEAgLTEwMzUsNyArMTAzOSw3IEBAIGNzY2hl
ZF92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2
YykKICAgICAvKiBjc2NoZWRfY3B1X3BpY2soKSBsb29rcyBpbiB2Yy0+cHJvY2Vzc29yJ3MgcnVu
cSwgc28gd2UgbmVlZCB0aGUgbG9jay4gKi8KICAgICBsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2Nr
X2lycSh2Yyk7CiAKLSAgICB2Yy0+cHJvY2Vzc29yID0gY3NjaGVkX2NwdV9waWNrKG9wcywgdmMp
OworICAgIHZjLT5wcm9jZXNzb3IgPSBjc2NoZWRfY3B1X3BpY2sob3BzLCBpdGVtKTsKIAogICAg
IHNwaW5fdW5sb2NrX2lycShsb2NrKTsKIApAQCAtMTA2MCw5ICsxMDY0LDEwIEBAIGNzY2hlZF9m
cmVlX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgdm9pZCAqcHJpdikKIH0KIAog
c3RhdGljIHZvaWQKLWNzY2hlZF92Y3B1X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpv
cHMsIHN0cnVjdCB2Y3B1ICp2YykKK2NzY2hlZF9pdGVtX3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtKQogewogICAgIHN0cnVjdCBjc2No
ZWRfcHJpdmF0ZSAqcHJ2ID0gQ1NDSEVEX1BSSVYob3BzKTsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMg
PSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqIGNvbnN0IHN2YyA9IENTQ0hF
RF9WQ1BVKHZjKTsKICAgICBzdHJ1Y3QgY3NjaGVkX2RvbSAqIGNvbnN0IHNkb20gPSBzdmMtPnNk
b207CiAKQEAgLTEwODcsOCArMTA5Miw5IEBAIGNzY2hlZF92Y3B1X3JlbW92ZShjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKIH0KIAogc3RhdGljIHZvaWQKLWNz
Y2hlZF92Y3B1X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUg
KnZjKQorY3NjaGVkX2l0ZW1fc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1
Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1
OwogICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqIGNvbnN0IHN2YyA9IENTQ0hFRF9WQ1BVKHZjKTsK
ICAgICB1bnNpZ25lZCBpbnQgY3B1ID0gdmMtPnByb2Nlc3NvcjsKIApAQCAtMTExMSw4ICsxMTE3
LDkgQEAgY3NjaGVkX3ZjcHVfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1
Y3QgdmNwdSAqdmMpCiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWRfdmNwdV93YWtlKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorY3NjaGVkX2l0ZW1fd2FrZShj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtKQogewor
ICAgIHN0cnVjdCB2Y3B1ICp2YyA9IGl0ZW0tPnZjcHU7CiAgICAgc3RydWN0IGNzY2hlZF92Y3B1
ICogY29uc3Qgc3ZjID0gQ1NDSEVEX1ZDUFUodmMpOwogICAgIGJvb2xfdCBtaWdyYXRpbmc7CiAK
QEAgLTExNzIsOCArMTE3OSw5IEBAIGNzY2hlZF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWRfdmNw
dV95aWVsZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2Nz
Y2hlZF9pdGVtX3lpZWxkKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVk
X2l0ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsKICAgICBz
dHJ1Y3QgY3NjaGVkX3ZjcHUgKiBjb25zdCBzdmMgPSBDU0NIRURfVkNQVSh2Yyk7CiAKICAgICAv
KiBMZXQgdGhlIHNjaGVkdWxlciBrbm93IHRoYXQgdGhpcyB2Y3B1IGlzIHRyeWluZyB0byB5aWVs
ZCAqLwpAQCAtMTIyNiw5ICsxMjM0LDEwIEBAIGNzY2hlZF9kb21fY250bCgKIH0KIAogc3RhdGlj
IHZvaWQKLWNzY2hlZF9hZmZfY250bChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVj
dCB2Y3B1ICp2LAorY3NjaGVkX2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0sCiAgICAgICAgICAgICAgICAgY29uc3QgY3B1bWFza190
ICpoYXJkLCBjb25zdCBjcHVtYXNrX3QgKnNvZnQpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSBp
dGVtLT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqc3ZjID0gQ1NDSEVEX1ZDUFUodik7
CiAKICAgICBpZiAoICFoYXJkICkKQEAgLTE3NTYsNyArMTc2NSw3IEBAIGNzY2hlZF9sb2FkX2Jh
bGFuY2Uoc3RydWN0IGNzY2hlZF9wcml2YXRlICpwcnYsIGludCBjcHUsCiAgICAgICAgICAgICAg
ICAgICogLSBpZiB3ZSByYWNlIHdpdGggaW5jX25yX3J1bm5hYmxlKCksIHdlIHNraXAgYSBwQ1BV
IHRoYXQgbWF5CiAgICAgICAgICAgICAgICAgICogICBoYXZlIHJ1bm5hYmxlIHZDUFVzIGluIGl0
cyBydW5xdWV1ZSwgYnV0IHRoYXQncyBub3QgYQogICAgICAgICAgICAgICAgICAqICAgcHJvYmxl
bSBiZWNhdXNlOgotICAgICAgICAgICAgICAgICAqICAgKyBpZiByYWNpbmcgd2l0aCBjc2NoZWRf
dmNwdV9pbnNlcnQoKSBvciBjc2NoZWRfdmNwdV93YWtlKCksCisgICAgICAgICAgICAgICAgICog
ICArIGlmIHJhY2luZyB3aXRoIGNzY2hlZF9pdGVtX2luc2VydCgpIG9yIGNzY2hlZF9pdGVtX3dh
a2UoKSwKICAgICAgICAgICAgICAgICAgKiAgICAgX19ydW5xX3RpY2tsZSgpIHdpbGwgYmUgY2Fs
bGVkIGFmdGVyd29yZHMsIHNvIHRoZSB2Q1BVCiAgICAgICAgICAgICAgICAgICogICAgIHdvbid0
IGdldCBzdHVjayBpbiB0aGUgcnVucXVldWUgZm9yIHRvbyBsb25nOwogICAgICAgICAgICAgICAg
ICAqICAgKyBpZiByYWNpbmcgd2l0aCBjc2NoZWRfcnVucV9zdGVhbCgpLCBpdCBtYXkgYmUgdGhh
dCBhCkBAIC0yMjY4LDEyICsyMjc3LDEyIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
IHNjaGVkX2NyZWRpdF9kZWYgPSB7CiAKICAgICAuZ2xvYmFsX2luaXQgICAgPSBjc2NoZWRfZ2xv
YmFsX2luaXQsCiAKLSAgICAuaW5zZXJ0X3ZjcHUgICAgPSBjc2NoZWRfdmNwdV9pbnNlcnQsCi0g
ICAgLnJlbW92ZV92Y3B1ICAgID0gY3NjaGVkX3ZjcHVfcmVtb3ZlLAorICAgIC5pbnNlcnRfaXRl
bSAgICA9IGNzY2hlZF9pdGVtX2luc2VydCwKKyAgICAucmVtb3ZlX2l0ZW0gICAgPSBjc2NoZWRf
aXRlbV9yZW1vdmUsCiAKLSAgICAuc2xlZXAgICAgICAgICAgPSBjc2NoZWRfdmNwdV9zbGVlcCwK
LSAgICAud2FrZSAgICAgICAgICAgPSBjc2NoZWRfdmNwdV93YWtlLAotICAgIC55aWVsZCAgICAg
ICAgICA9IGNzY2hlZF92Y3B1X3lpZWxkLAorICAgIC5zbGVlcCAgICAgICAgICA9IGNzY2hlZF9p
dGVtX3NsZWVwLAorICAgIC53YWtlICAgICAgICAgICA9IGNzY2hlZF9pdGVtX3dha2UsCisgICAg
LnlpZWxkICAgICAgICAgID0gY3NjaGVkX2l0ZW1feWllbGQsCiAKICAgICAuYWRqdXN0ICAgICAg
ICAgPSBjc2NoZWRfZG9tX2NudGwsCiAgICAgLmFkanVzdF9hZmZpbml0eT0gY3NjaGVkX2FmZl9j
bnRsLApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMgYi94ZW4vY29tbW9u
L3NjaGVkX2NyZWRpdDIuYwppbmRleCA2OTU4YjI2NWZjLi5mNDQyODZjMmE1IDEwMDY0NAotLS0g
YS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRp
dDIuYwpAQCAtMjczLDcgKzI3Myw3IEBACiAgKiBDU0ZMQUdfZGVsYXllZF9ydW5xX2FkZDogRG8g
d2UgbmVlZCB0byBhZGQgdGhpcyB0byB0aGUgcnVucXVldWUgb25jZSBpdCdkIGRvbmUKICAqIGJl
aW5nIGNvbnRleHQgc3dpdGNoZWQgb3V0PwogICogKyBTZXQgd2hlbiBzY2hlZHVsaW5nIG91dCBp
biBjc2NoZWQyX3NjaGVkdWxlKCkgaWYgcHJldiBpcyBydW5uYWJsZQotICogKyBTZXQgaW4gY3Nj
aGVkMl92Y3B1X3dha2UgaWYgaXQgZmluZHMgQ1NGTEFHX3NjaGVkdWxlZCBzZXQKKyAqICsgU2V0
IGluIGNzY2hlZDJfaXRlbV93YWtlIGlmIGl0IGZpbmRzIENTRkxBR19zY2hlZHVsZWQgc2V0CiAg
KiArIFJlYWQgaW4gY3NjaGVkMl9jb250ZXh0X3NhdmVkKCkuICBJZiBzZXQsIGl0IGFkZHMgcHJl
diB0byB0aGUgcnVucXVldWUgYW5kCiAgKiAgIGNsZWFycyB0aGUgYml0LgogICovCkBAIC02MjMs
MTQgKzYyMywxNCBAQCBzdGF0aWMgaW5saW5lIGJvb2wgaGFzX2NhcChjb25zdCBzdHJ1Y3QgY3Nj
aGVkMl92Y3B1ICpzdmMpCiAgKiBUaGlzIGxvZ2ljIGlzIGVudGlyZWx5IGltcGxlbWVudGVkIGlu
IHJ1bnFfdGlja2xlKCksIGFuZCB0aGF0IGlzIGVub3VnaC4KICAqIEluIGZhY3QsIGluIHRoaXMg
c2NoZWR1bGVyLCBwbGFjZW1lbnQgb2YgYSB2Y3B1IG9uIG9uZSBvZiB0aGUgcGNwdXMgb2YgYQog
ICogcnVucSwgX2Fsd2F5c18gaGFwcGVucyBieSBtZWFucyBvZiB0aWNrbGluZzoKLSAqICAtIHdo
ZW4gYSB2Y3B1IHdha2VzIHVwLCBpdCBjYWxscyBjc2NoZWQyX3ZjcHVfd2FrZSgpLCB3aGljaCBj
YWxscworICogIC0gd2hlbiBhIHZjcHUgd2FrZXMgdXAsIGl0IGNhbGxzIGNzY2hlZDJfaXRlbV93
YWtlKCksIHdoaWNoIGNhbGxzCiAgKiAgICBydW5xX3RpY2tsZSgpOwogICogIC0gd2hlbiBhIG1p
Z3JhdGlvbiBpcyBpbml0aWF0ZWQgaW4gc2NoZWR1bGUuYywgd2UgY2FsbCBjc2NoZWQyX2NwdV9w
aWNrKCksCi0gKiAgICBjc2NoZWQyX3ZjcHVfbWlncmF0ZSgpICh3aGljaCBjYWxscyBtaWdyYXRl
KCkpIGFuZCBjc2NoZWQyX3ZjcHVfd2FrZSgpLgorICogICAgY3NjaGVkMl9pdGVtX21pZ3JhdGUo
KSAod2hpY2ggY2FsbHMgbWlncmF0ZSgpKSBhbmQgY3NjaGVkMl9pdGVtX3dha2UoKS4KICAqICAg
IGNzY2hlZDJfY3B1X3BpY2soKSBsb29rcyBmb3IgdGhlIGxlYXN0IGxvYWRlZCBydW5xIGFuZCBy
ZXR1cm4ganVzdCBhbnkKLSAqICAgIG9mIGl0cyBwcm9jZXNzb3JzLiBUaGVuLCBjc2NoZWQyX3Zj
cHVfbWlncmF0ZSgpIGp1c3QgbW92ZXMgdGhlIHZjcHUgdG8KKyAqICAgIG9mIGl0cyBwcm9jZXNz
b3JzLiBUaGVuLCBjc2NoZWQyX2l0ZW1fbWlncmF0ZSgpIGp1c3QgbW92ZXMgdGhlIHZjcHUgdG8K
ICAqICAgIHRoZSBjaG9zZW4gcnVucSwgYW5kIGl0IGlzIGFnYWluIHJ1bnFfdGlja2xlKCksIGNh
bGxlZCBieQotICogICAgY3NjaGVkMl92Y3B1X3dha2UoKSB0aGF0IGFjdHVhbGx5IGRlY2lkZXMg
d2hhdCBwY3B1IHRvIHVzZSB3aXRoaW4gdGhlCisgKiAgICBjc2NoZWQyX2l0ZW1fd2FrZSgpIHRo
YXQgYWN0dWFsbHkgZGVjaWRlcyB3aGF0IHBjcHUgdG8gdXNlIHdpdGhpbiB0aGUKICAqICAgIGNo
b3NlbiBydW5xOwogICogIC0gd2hlbiBhIG1pZ3JhdGlvbiBpcyBpbml0aWF0ZWQgaW4gc2NoZWRf
Y3JlZGl0Mi5jLCBieSBjYWxsaW5nICBtaWdyYXRlKCkKICAqICAgIGRpcmVjdGx5LCB0aGF0IGFn
YWluIHRlbXBvcmFyaWx5IHVzZSBhIHJhbmRvbSBwY3B1IGZyb20gdGhlIG5ldyBydW5xLApAQCAt
MjAyNiw4ICsyMDI2LDEwIEBAIGNzY2hlZDJfdmNwdV9jaGVjayhzdHJ1Y3QgdmNwdSAqdmMpCiAj
ZW5kaWYKIAogc3RhdGljIHZvaWQgKgotY3NjaGVkMl9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2Yywgdm9pZCAqZGQpCitjc2NoZWQyX2FsbG9j
X3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0
ZW0sCisgICAgICAgICAgICAgICAgICAgIHZvaWQgKmRkKQogeworICAgIHN0cnVjdCB2Y3B1ICp2
YyA9IGl0ZW0tPnZjcHU7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqc3ZjOwogCiAgICAgLyog
QWxsb2NhdGUgcGVyLVZDUFUgaW5mbyAqLwpAQCAtMjA2OSw4ICsyMDcxLDkgQEAgY3NjaGVkMl9h
bGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2Yywg
dm9pZCAqZGQpCiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWQyX3ZjcHVfc2xlZXAoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWQyX2l0ZW1fc2xlZXAo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsK
KyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWQyX3Zj
cHUgKiBjb25zdCBzdmMgPSBjc2NoZWQyX3ZjcHUodmMpOwogCiAgICAgQVNTRVJUKCFpc19pZGxl
X3ZjcHUodmMpKTsKQEAgLTIwOTEsOCArMjA5NCw5IEBAIGNzY2hlZDJfdmNwdV9zbGVlcChjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKIH0KIAogc3RhdGljIHZv
aWQKLWNzY2hlZDJfdmNwdV93YWtlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0
IHZjcHUgKnZjKQorY3NjaGVkMl9pdGVtX3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
LCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSBpdGVt
LT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKiBjb25zdCBzdmMgPSBjc2NoZWQyX3Zj
cHUodmMpOwogICAgIHVuc2lnbmVkIGludCBjcHUgPSB2Yy0+cHJvY2Vzc29yOwogICAgIHNfdGlt
ZV90IG5vdzsKQEAgLTIxNDYsMTYgKzIxNTAsMTggQEAgb3V0OgogfQogCiBzdGF0aWMgdm9pZAot
Y3NjaGVkMl92Y3B1X3lpZWxkKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnYpCitjc2NoZWQyX2l0ZW1feWllbGQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBz
dHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IGl0ZW0tPnZj
cHU7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNzY2hlZDJfdmNwdSh2
KTsKIAogICAgIF9fc2V0X2JpdChfX0NTRkxBR192Y3B1X3lpZWxkLCAmc3ZjLT5mbGFncyk7CiB9
CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWQyX2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWQyX2NvbnRleHRfc2F2ZWQoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBz
dHJ1Y3QgdmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKiBj
b25zdCBzdmMgPSBjc2NoZWQyX3ZjcHUodmMpOwogICAgIHNwaW5sb2NrX3QgKmxvY2sgPSB2Y3B1
X3NjaGVkdWxlX2xvY2tfaXJxKHZjKTsKICAgICBzX3RpbWVfdCBub3cgPSBOT1coKTsKQEAgLTIx
OTYsOSArMjIwMiwxMCBAQCBjc2NoZWQyX2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCiAKICNkZWZpbmUgTUFYX0xPQUQgKFNUSU1FX01B
WCkKIHN0YXRpYyBpbnQKLWNzY2hlZDJfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWQyX2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CiAgICAgc3RydWN0IGNzY2hl
ZDJfcHJpdmF0ZSAqcHJ2ID0gY3NjaGVkMl9wcml2KG9wcyk7CisgICAgc3RydWN0IHZjcHUgKnZj
ID0gaXRlbS0+dmNwdTsKICAgICBpbnQgaSwgbWluX3JxaSA9IC0xLCBtaW5fc19ycWkgPSAtMTsK
ICAgICB1bnNpZ25lZCBpbnQgbmV3X2NwdSwgY3B1ID0gdmMtPnByb2Nlc3NvcjsKICAgICBzdHJ1
Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSBjc2NoZWQyX3ZjcHUodmMpOwpAQCAtMjczMyw5ICsyNzQw
LDEwIEBAIHJldHJ5OgogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVkMl92Y3B1X21pZ3JhdGUoCi0g
ICAgY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMsIHVuc2lnbmVk
IGludCBuZXdfY3B1KQorY3NjaGVkMl9pdGVtX21pZ3JhdGUoCisgICAgY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSwgdW5zaWduZWQgaW50IG5ld19j
cHUpCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgZG9t
YWluICpkID0gdmMtPmRvbWFpbjsKICAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICogY29uc3Qgc3Zj
ID0gY3NjaGVkMl92Y3B1KHZjKTsKICAgICBzdHJ1Y3QgY3NjaGVkMl9ydW5xdWV1ZV9kYXRhICp0
cnFkOwpAQCAtMjk5Niw5ICszMDA0LDEwIEBAIGNzY2hlZDJfZG9tX2NudGwoCiB9CiAKIHN0YXRp
YyB2b2lkCi1jc2NoZWQyX2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3Ry
dWN0IHZjcHUgKnYsCitjc2NoZWQyX2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0sCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNwdW1h
c2tfdCAqaGFyZCwgY29uc3QgY3B1bWFza190ICpzb2Z0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2
ID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSBjc2NoZWQyX3Zj
cHUodik7CiAKICAgICBpZiAoICFoYXJkICkKQEAgLTMwOTYsOCArMzEwNSw5IEBAIGNzY2hlZDJf
ZnJlZV9kb21kYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgdm9pZCAqZGF0YSkKIH0K
IAogc3RhdGljIHZvaWQKLWNzY2hlZDJfdmNwdV9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWQyX2l0ZW1faW5zZXJ0KGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0
IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmMgPSB2
Yy0+c2NoZWRfcHJpdjsKICAgICBzdHJ1Y3QgY3NjaGVkMl9kb20gKiBjb25zdCBzZG9tID0gc3Zj
LT5zZG9tOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CkBAIC0zMTA4LDcgKzMxMTgsNyBAQCBjc2No
ZWQyX3ZjcHVfaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUg
KnZjKQogICAgIC8qIGNzY2hlZDJfY3B1X3BpY2soKSBleHBlY3RzIHRoZSBwY3B1IGxvY2sgdG8g
YmUgaGVsZCAqLwogICAgIGxvY2sgPSB2Y3B1X3NjaGVkdWxlX2xvY2tfaXJxKHZjKTsKIAotICAg
IHZjLT5wcm9jZXNzb3IgPSBjc2NoZWQyX2NwdV9waWNrKG9wcywgdmMpOworICAgIHZjLT5wcm9j
ZXNzb3IgPSBjc2NoZWQyX2NwdV9waWNrKG9wcywgaXRlbSk7CiAKICAgICBzcGluX3VubG9ja19p
cnEobG9jayk7CiAKQEAgLTMxMzUsOCArMzE0NSw5IEBAIGNzY2hlZDJfZnJlZV92ZGF0YShjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHZvaWQgKnByaXYpCiB9CiAKIHN0YXRpYyB2b2lkCi1j
c2NoZWQyX3ZjcHVfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnZjKQorY3NjaGVkMl9pdGVtX3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMs
IHN0cnVjdCBzY2hlZF9pdGVtICppdGVtKQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IGl0ZW0t
PnZjcHU7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNzY2hlZDJfdmNw
dSh2Yyk7CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKIApAQCAtNDA4NCwxOSArNDA5NSwxOSBAQCBz
dGF0aWMgY29uc3Qgc3RydWN0IHNjaGVkdWxlciBzY2hlZF9jcmVkaXQyX2RlZiA9IHsKIAogICAg
IC5nbG9iYWxfaW5pdCAgICA9IGNzY2hlZDJfZ2xvYmFsX2luaXQsCiAKLSAgICAuaW5zZXJ0X3Zj
cHUgICAgPSBjc2NoZWQyX3ZjcHVfaW5zZXJ0LAotICAgIC5yZW1vdmVfdmNwdSAgICA9IGNzY2hl
ZDJfdmNwdV9yZW1vdmUsCisgICAgLmluc2VydF9pdGVtICAgID0gY3NjaGVkMl9pdGVtX2luc2Vy
dCwKKyAgICAucmVtb3ZlX2l0ZW0gICAgPSBjc2NoZWQyX2l0ZW1fcmVtb3ZlLAogCi0gICAgLnNs
ZWVwICAgICAgICAgID0gY3NjaGVkMl92Y3B1X3NsZWVwLAotICAgIC53YWtlICAgICAgICAgICA9
IGNzY2hlZDJfdmNwdV93YWtlLAotICAgIC55aWVsZCAgICAgICAgICA9IGNzY2hlZDJfdmNwdV95
aWVsZCwKKyAgICAuc2xlZXAgICAgICAgICAgPSBjc2NoZWQyX2l0ZW1fc2xlZXAsCisgICAgLndh
a2UgICAgICAgICAgID0gY3NjaGVkMl9pdGVtX3dha2UsCisgICAgLnlpZWxkICAgICAgICAgID0g
Y3NjaGVkMl9pdGVtX3lpZWxkLAogCiAgICAgLmFkanVzdCAgICAgICAgID0gY3NjaGVkMl9kb21f
Y250bCwKICAgICAuYWRqdXN0X2FmZmluaXR5PSBjc2NoZWQyX2FmZl9jbnRsLAogICAgIC5hZGp1
c3RfZ2xvYmFsICA9IGNzY2hlZDJfc3lzX2NudGwsCiAKICAgICAucGlja19jcHUgICAgICAgPSBj
c2NoZWQyX2NwdV9waWNrLAotICAgIC5taWdyYXRlICAgICAgICA9IGNzY2hlZDJfdmNwdV9taWdy
YXRlLAorICAgIC5taWdyYXRlICAgICAgICA9IGNzY2hlZDJfaXRlbV9taWdyYXRlLAogICAgIC5k
b19zY2hlZHVsZSAgICA9IGNzY2hlZDJfc2NoZWR1bGUsCiAgICAgLmNvbnRleHRfc2F2ZWQgID0g
Y3NjaGVkMl9jb250ZXh0X3NhdmVkLAogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX251
bGwuYyBiL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCmluZGV4IGE1OWRiYjI2OTIuLjdiNTA4ZjM1
YTQgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jCisrKyBiL3hlbi9jb21tb24v
c2NoZWRfbnVsbC5jCkBAIC0xOTQsOCArMTk0LDkgQEAgc3RhdGljIHZvaWQgbnVsbF9kZWluaXRf
cGRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwY3B1LCBpbnQgY3B1KQog
fQogCiBzdGF0aWMgdm9pZCAqbnVsbF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdmNwdSAqdiwgdm9p
ZCAqZGQpCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAq
aXRlbSwgdm9pZCAqZGQpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSBpdGVtLT52Y3B1OwogICAg
IHN0cnVjdCBudWxsX3ZjcHUgKm52YzsKIAogICAgIG52YyA9IHh6YWxsb2Moc3RydWN0IG51bGxf
dmNwdSk7CkBAIC00MTMsOCArNDE0LDEwIEBAIHN0YXRpYyB2b2lkIG51bGxfc3dpdGNoX3NjaGVk
KHN0cnVjdCBzY2hlZHVsZXIgKm5ld19vcHMsIHVuc2lnbmVkIGludCBjcHUsCiAgICAgc2QtPnNj
aGVkdWxlX2xvY2sgPSAmc2QtPl9sb2NrOwogfQogCi1zdGF0aWMgdm9pZCBudWxsX3ZjcHVfaW5z
ZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMg
dm9pZCBudWxsX2l0ZW1faW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAg
c3RydWN0IHZjcHUgKnYgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBy
diA9IG51bGxfcHJpdihvcHMpOwogICAgIHN0cnVjdCBudWxsX3ZjcHUgKm52YyA9IG51bGxfdmNw
dSh2KTsKICAgICB1bnNpZ25lZCBpbnQgY3B1OwpAQCAtNTA1LDggKzUwOCwxMCBAQCBzdGF0aWMg
dm9pZCBfdmNwdV9yZW1vdmUoc3RydWN0IG51bGxfcHJpdmF0ZSAqcHJ2LCBzdHJ1Y3QgdmNwdSAq
dikKICAgICBzcGluX3VubG9jaygmcHJ2LT53YWl0cV9sb2NrKTsKIH0KIAotc3RhdGljIHZvaWQg
bnVsbF92Y3B1X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1
ICp2KQorc3RhdGljIHZvaWQgbnVsbF9pdGVtX3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF9pdGVtICpp
dGVtKQogeworICAgIHN0cnVjdCB2Y3B1ICp2ID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgbnVs
bF9wcml2YXRlICpwcnYgPSBudWxsX3ByaXYob3BzKTsKICAgICBzdHJ1Y3QgbnVsbF92Y3B1ICpu
dmMgPSBudWxsX3ZjcHUodik7CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKQEAgLTUzNiw4ICs1NDEs
MTEgQEAgc3RhdGljIHZvaWQgbnVsbF92Y3B1X3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQogICAgIFNDSEVEX1NUQVRfQ1JBTksodmNwdV9yZW1vdmUp
OwogfQogCi1zdGF0aWMgdm9pZCBudWxsX3ZjcHVfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIHZvaWQgbnVsbF9pdGVtX3dha2UoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSBpdGVtLT52Y3B1Owor
CiAgICAgQVNTRVJUKCFpc19pZGxlX3ZjcHUodikpOwogCiAgICAgaWYgKCB1bmxpa2VseShjdXJy
X29uX2NwdSh2LT5wcm9jZXNzb3IpID09IHYpICkKQEAgLTU2Miw4ICs1NzAsMTEgQEAgc3RhdGlj
IHZvaWQgbnVsbF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qg
dmNwdSAqdikKICAgICBjcHVfcmFpc2Vfc29mdGlycSh2LT5wcm9jZXNzb3IsIFNDSEVEVUxFX1NP
RlRJUlEpOwogfQogCi1zdGF0aWMgdm9pZCBudWxsX3ZjcHVfc2xlZXAoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdikKK3N0YXRpYyB2b2lkIG51bGxfaXRlbV9zbGVl
cChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSBpdGVt
LT52Y3B1OworCiAgICAgQVNTRVJUKCFpc19pZGxlX3ZjcHUodikpOwogCiAgICAgLyogSWYgdiBp
cyBub3QgYXNzaWduZWQgdG8gYSBwQ1BVLCBvciBpcyBub3QgcnVubmluZywgbm8gbmVlZCB0byBi
b3RoZXIgKi8KQEAgLTU3MywxNSArNTg0LDE3IEBAIHN0YXRpYyB2b2lkIG51bGxfdmNwdV9zbGVl
cChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQogICAgIFNDSEVE
X1NUQVRfQ1JBTksodmNwdV9zbGVlcCk7CiB9CiAKLXN0YXRpYyBpbnQgbnVsbF9jcHVfcGljayhj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGludCBu
dWxsX2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0
ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSBpdGVtLT52Y3B1OwogICAgIEFTU0VS
VCghaXNfaWRsZV92Y3B1KHYpKTsKICAgICByZXR1cm4gcGlja19jcHUobnVsbF9wcml2KG9wcyks
IHYpOwogfQogCi1zdGF0aWMgdm9pZCBudWxsX3ZjcHVfbWlncmF0ZShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2LAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IG5ld19jcHUpCitzdGF0aWMgdm9pZCBudWxsX2l0ZW1fbWlncmF0ZShj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSwgdW5zaWduZWQgaW50IG5ld19jcHUpCiB7CisgICAg
c3RydWN0IHZjcHUgKnYgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBy
diA9IG51bGxfcHJpdihvcHMpOwogICAgIHN0cnVjdCBudWxsX3ZjcHUgKm52YyA9IG51bGxfdmNw
dSh2KTsKIApAQCAtODg4LDEzICs5MDEsMTMgQEAgY29uc3Qgc3RydWN0IHNjaGVkdWxlciBzY2hl
ZF9udWxsX2RlZiA9IHsKICAgICAuYWxsb2NfZG9tZGF0YSAgPSBudWxsX2FsbG9jX2RvbWRhdGEs
CiAgICAgLmZyZWVfZG9tZGF0YSAgID0gbnVsbF9mcmVlX2RvbWRhdGEsCiAKLSAgICAuaW5zZXJ0
X3ZjcHUgICAgPSBudWxsX3ZjcHVfaW5zZXJ0LAotICAgIC5yZW1vdmVfdmNwdSAgICA9IG51bGxf
dmNwdV9yZW1vdmUsCisgICAgLmluc2VydF9pdGVtICAgID0gbnVsbF9pdGVtX2luc2VydCwKKyAg
ICAucmVtb3ZlX2l0ZW0gICAgPSBudWxsX2l0ZW1fcmVtb3ZlLAogCi0gICAgLndha2UgICAgICAg
ICAgID0gbnVsbF92Y3B1X3dha2UsCi0gICAgLnNsZWVwICAgICAgICAgID0gbnVsbF92Y3B1X3Ns
ZWVwLAorICAgIC53YWtlICAgICAgICAgICA9IG51bGxfaXRlbV93YWtlLAorICAgIC5zbGVlcCAg
ICAgICAgICA9IG51bGxfaXRlbV9zbGVlcCwKICAgICAucGlja19jcHUgICAgICAgPSBudWxsX2Nw
dV9waWNrLAotICAgIC5taWdyYXRlICAgICAgICA9IG51bGxfdmNwdV9taWdyYXRlLAorICAgIC5t
aWdyYXRlICAgICAgICA9IG51bGxfaXRlbV9taWdyYXRlLAogICAgIC5kb19zY2hlZHVsZSAgICA9
IG51bGxfc2NoZWR1bGUsCiAKICAgICAuZHVtcF9jcHVfc3RhdGUgPSBudWxsX2R1bXBfcGNwdSwK
ZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfcnQuYyBiL3hlbi9jb21tb24vc2NoZWRfcnQu
YwppbmRleCBmMWI4MWYwMzczLi5hYjhmYTAyMzA2IDEwMDY0NAotLS0gYS94ZW4vY29tbW9uL3Nj
aGVkX3J0LmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9ydC5jCkBAIC0xMzYsNyArMTM2LDcgQEAK
ICAqIFJURFNfZGVsYXllZF9ydW5xX2FkZDogRG8gd2UgbmVlZCB0byBhZGQgdGhpcyB0byB0aGUg
UnVuUS9EZXBsZXRlZFEKICAqIG9uY2UgaXQncyBkb25lIGJlaW5nIGNvbnRleHQgc3dpdGNoaW5n
IG91dD8KICAqICsgU2V0IHdoZW4gc2NoZWR1bGluZyBvdXQgaW4gcnRfc2NoZWR1bGUoKSBpZiBw
cmV2IGlzIHJ1bmFibGUKLSAqICsgU2V0IGluIHJ0X3ZjcHVfd2FrZSBpZiBpdCBmaW5kcyBSVERT
X3NjaGVkdWxlZCBzZXQKKyAqICsgU2V0IGluIHJ0X2l0ZW1fd2FrZSBpZiBpdCBmaW5kcyBSVERT
X3NjaGVkdWxlZCBzZXQKICAqICsgUmVhZCBpbiBydF9jb250ZXh0X3NhdmVkKCkuIElmIHNldCwg
aXQgYWRkcyBwcmV2IHRvIHRoZSBSdW5xdWV1ZS9EZXBsZXRlZFEKICAqICAgYW5kIGNsZWFycyB0
aGUgYml0LgogICovCkBAIC02MzcsOCArNjM3LDkgQEAgcmVwbHFfcmVpbnNlcnQoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgcnRfdmNwdSAqc3ZjKQogICogYW5kIGF2YWlsYWJs
ZSBjcHVzCiAgKi8KIHN0YXRpYyBpbnQKLXJ0X2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorcnRfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAq
dmMgPSBpdGVtLT52Y3B1OwogICAgIGNwdW1hc2tfdCBjcHVzOwogICAgIGNwdW1hc2tfdCAqb25s
aW5lOwogICAgIGludCBjcHU7CkBAIC04NDYsOCArODQ3LDkgQEAgcnRfZnJlZV9kb21kYXRhKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgdm9pZCAqZGF0YSkKIH0KIAogc3RhdGljIHZvaWQg
KgotcnRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNw
dSAqdmMsIHZvaWQgKmRkKQorcnRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSwgdm9pZCAqZGQpCiB7CisgICAgc3RydWN0IHZj
cHUgKnZjID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgcnRfdmNwdSAqc3ZjOwogCiAgICAgLyog
QWxsb2NhdGUgcGVyLVZDUFUgaW5mbyAqLwpAQCAtODg5LDggKzg5MSw5IEBAIHJ0X2ZyZWVfdmRh
dGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwcml2KQogICogZGVzdC4gY3B1
cG9vbC4KICAqLwogc3RhdGljIHZvaWQKLXJ0X3ZjcHVfaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorcnRfaXRlbV9pbnNlcnQoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3Qg
dmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBydF92Y3B1ICpzdmMgPSBydF92Y3B1
KHZjKTsKICAgICBzX3RpbWVfdCBub3c7CiAgICAgc3BpbmxvY2tfdCAqbG9jazsKQEAgLTg5OCw3
ICs5MDEsNyBAQCBydF92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCB2Y3B1ICp2YykKICAgICBCVUdfT04oIGlzX2lkbGVfdmNwdSh2YykgKTsKIAogICAgIC8q
IFRoaXMgaXMgc2FmZSBiZWNhdXNlIHZjIGlzbid0IHlldCBiZWluZyBzY2hlZHVsZWQgKi8KLSAg
ICB2Yy0+cHJvY2Vzc29yID0gcnRfY3B1X3BpY2sob3BzLCB2Yyk7CisgICAgdmMtPnByb2Nlc3Nv
ciA9IHJ0X2NwdV9waWNrKG9wcywgaXRlbSk7CiAKICAgICBsb2NrID0gdmNwdV9zY2hlZHVsZV9s
b2NrX2lycSh2Yyk7CiAKQEAgLTkyMiw4ICs5MjUsOSBAQCBydF92Y3B1X2luc2VydChjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKICAqIFJlbW92ZSBydF92Y3B1
IHN2YyBmcm9tIHRoZSBvbGQgc2NoZWR1bGVyIGluIHNvdXJjZSBjcHVwb29sLgogICovCiBzdGF0
aWMgdm9pZAotcnRfdmNwdV9yZW1vdmUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1
Y3QgdmNwdSAqdmMpCitydF9pdGVtX3JlbW92ZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMs
IHN0cnVjdCBzY2hlZF9pdGVtICppdGVtKQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IGl0ZW0t
PnZjcHU7CiAgICAgc3RydWN0IHJ0X3ZjcHUgKiBjb25zdCBzdmMgPSBydF92Y3B1KHZjKTsKICAg
ICBzdHJ1Y3QgcnRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKICAgICBzcGlubG9ja190
ICpsb2NrOwpAQCAtMTE0Miw4ICsxMTQ2LDkgQEAgcnRfc2NoZWR1bGUoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzX3RpbWVfdCBub3csIGJvb2xfdCB0YXNrbGV0X3dvcmtfc2NoZWQKICAq
IFRoZSBsb2NrIGlzIGFscmVhZHkgZ3JhYmJlZCBpbiBzY2hlZHVsZS5jLCBubyBuZWVkIHRvIGxv
Y2sgaGVyZQogICovCiBzdGF0aWMgdm9pZAotcnRfdmNwdV9zbGVlcChjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK3J0X2l0ZW1fc2xlZXAoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfaXRlbSAqaXRlbSkKIHsKKyAgICBzdHJ1Y3Qg
dmNwdSAqdmMgPSBpdGVtLT52Y3B1OwogICAgIHN0cnVjdCBydF92Y3B1ICogY29uc3Qgc3ZjID0g
cnRfdmNwdSh2Yyk7CiAKICAgICBCVUdfT04oIGlzX2lkbGVfdmNwdSh2YykgKTsKQEAgLTEyNTcs
OCArMTI2Miw5IEBAIHJ1bnFfdGlja2xlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3Ry
dWN0IHJ0X3ZjcHUgKm5ldykKICAqIFRPRE86IHdoYXQgaWYgdGhlc2UgdHdvIHZjcHVzIGJlbG9u
Z3MgdG8gdGhlIHNhbWUgZG9tYWluPwogICovCiBzdGF0aWMgdm9pZAotcnRfdmNwdV93YWtlKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorcnRfaXRlbV93YWtl
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7
CisgICAgc3RydWN0IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsKICAgICBzdHJ1Y3QgcnRfdmNwdSAq
IGNvbnN0IHN2YyA9IHJ0X3ZjcHUodmMpOwogICAgIHNfdGltZV90IG5vdzsKICAgICBib29sX3Qg
bWlzc2VkOwpAQCAtMTMyNyw4ICsxMzMzLDkgQEAgcnRfdmNwdV93YWtlKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQogICogYW5kIHRoZW4gcGljayB0aGUgaGln
aGVzdCBwcmlvcml0eSB2Y3B1IGZyb20gcnVucSB0byBydW4KICAqLwogc3RhdGljIHZvaWQKLXJ0
X2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAq
dmMpCitydF9jb250ZXh0X3NhdmVkKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0
IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gaXRlbS0+dmNwdTsK
ICAgICBzdHJ1Y3QgcnRfdmNwdSAqc3ZjID0gcnRfdmNwdSh2Yyk7CiAgICAgc3BpbmxvY2tfdCAq
bG9jayA9IHZjcHVfc2NoZWR1bGVfbG9ja19pcnEodmMpOwogCkBAIC0xNTU3LDE1ICsxNTY0LDE1
IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyIHNjaGVkX3J0ZHNfZGVmID0gewogICAg
IC5mcmVlX2RvbWRhdGEgICA9IHJ0X2ZyZWVfZG9tZGF0YSwKICAgICAuYWxsb2NfdmRhdGEgICAg
PSBydF9hbGxvY192ZGF0YSwKICAgICAuZnJlZV92ZGF0YSAgICAgPSBydF9mcmVlX3ZkYXRhLAot
ICAgIC5pbnNlcnRfdmNwdSAgICA9IHJ0X3ZjcHVfaW5zZXJ0LAotICAgIC5yZW1vdmVfdmNwdSAg
ICA9IHJ0X3ZjcHVfcmVtb3ZlLAorICAgIC5pbnNlcnRfaXRlbSAgICA9IHJ0X2l0ZW1faW5zZXJ0
LAorICAgIC5yZW1vdmVfaXRlbSAgICA9IHJ0X2l0ZW1fcmVtb3ZlLAogCiAgICAgLmFkanVzdCAg
ICAgICAgID0gcnRfZG9tX2NudGwsCiAKICAgICAucGlja19jcHUgICAgICAgPSBydF9jcHVfcGlj
aywKICAgICAuZG9fc2NoZWR1bGUgICAgPSBydF9zY2hlZHVsZSwKLSAgICAuc2xlZXAgICAgICAg
ICAgPSBydF92Y3B1X3NsZWVwLAotICAgIC53YWtlICAgICAgICAgICA9IHJ0X3ZjcHVfd2FrZSwK
KyAgICAuc2xlZXAgICAgICAgICAgPSBydF9pdGVtX3NsZWVwLAorICAgIC53YWtlICAgICAgICAg
ICA9IHJ0X2l0ZW1fd2FrZSwKICAgICAuY29udGV4dF9zYXZlZCAgPSBydF9jb250ZXh0X3NhdmVk
LAogfTsKIApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jIGIveGVuL2NvbW1vbi9z
Y2hlZHVsZS5jCmluZGV4IDM1YTQwYTQwYzguLjI3ZDhkMzY1MDQgMTAwNjQ0Ci0tLSBhL3hlbi9j
b21tb24vc2NoZWR1bGUuYworKysgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKQEAgLTI1Miw2ICsy
NTIsNyBAQCBzdGF0aWMgdm9pZCBzY2hlZF9zcGluX3VubG9ja19kb3VibGUoc3BpbmxvY2tfdCAq
bG9jazEsIHNwaW5sb2NrX3QgKmxvY2syLAogaW50IHNjaGVkX2luaXRfdmNwdShzdHJ1Y3QgdmNw
dSAqdiwgdW5zaWduZWQgaW50IHByb2Nlc3NvcikKIHsKICAgICBzdHJ1Y3QgZG9tYWluICpkID0g
di0+ZG9tYWluOworICAgIHN0cnVjdCBzY2hlZF9pdGVtIGl0ZW0gPSB7IC52Y3B1ID0gdiB9Owog
CiAgICAgdi0+cHJvY2Vzc29yID0gcHJvY2Vzc29yOwogCkBAIC0yNjMsNyArMjY0LDcgQEAgaW50
IHNjaGVkX2luaXRfdmNwdShzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQgaW50IHByb2Nlc3NvcikK
ICAgICBpbml0X3RpbWVyKCZ2LT5wb2xsX3RpbWVyLCBwb2xsX3RpbWVyX2ZuLAogICAgICAgICAg
ICAgICAgdiwgdi0+cHJvY2Vzc29yKTsKIAotICAgIHYtPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxv
Y192ZGF0YShkb21fc2NoZWR1bGVyKGQpLCB2LCBkLT5zY2hlZF9wcml2KTsKKyAgICB2LT5zY2hl
ZF9wcml2ID0gc2NoZWRfYWxsb2NfdmRhdGEoZG9tX3NjaGVkdWxlcihkKSwgJml0ZW0sIGQtPnNj
aGVkX3ByaXYpOwogICAgIGlmICggdi0+c2NoZWRfcHJpdiA9PSBOVUxMICkKICAgICAgICAgcmV0
dXJuIDE7CiAKQEAgLTI4NCw3ICsyODUsNyBAQCBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2
Y3B1ICp2LCB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yKQogICAgIH0KICAgICBlbHNlCiAgICAgewot
ICAgICAgICBzY2hlZF9pbnNlcnRfdmNwdShkb21fc2NoZWR1bGVyKGQpLCB2KTsKKyAgICAgICAg
c2NoZWRfaW5zZXJ0X2l0ZW0oZG9tX3NjaGVkdWxlcihkKSwgJml0ZW0pOwogICAgIH0KIAogICAg
IHJldHVybiAwOwpAQCAtMzA1LDYgKzMwNiw3IEBAIGludCBzY2hlZF9tb3ZlX2RvbWFpbihzdHJ1
Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICB2b2lkICp2Y3B1ZGF0YTsKICAg
ICBzdHJ1Y3Qgc2NoZWR1bGVyICpvbGRfb3BzOwogICAgIHZvaWQgKm9sZF9kb21kYXRhOworICAg
IHN0cnVjdCBzY2hlZF9pdGVtIGl0ZW07CiAKICAgICBmb3JfZWFjaF92Y3B1ICggZCwgdiApCiAg
ICAgewpAQCAtMzI1LDcgKzMyNyw4IEBAIGludCBzY2hlZF9tb3ZlX2RvbWFpbihzdHJ1Y3QgZG9t
YWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKIAogICAgIGZvcl9lYWNoX3ZjcHUgKCBkLCB2ICkK
ICAgICB7Ci0gICAgICAgIHZjcHVfcHJpdlt2LT52Y3B1X2lkXSA9IHNjaGVkX2FsbG9jX3ZkYXRh
KGMtPnNjaGVkLCB2LCBkb21kYXRhKTsKKyAgICAgICAgaXRlbS52Y3B1ID0gdjsKKyAgICAgICAg
dmNwdV9wcml2W3YtPnZjcHVfaWRdID0gc2NoZWRfYWxsb2NfdmRhdGEoYy0+c2NoZWQsICZpdGVt
LCBkb21kYXRhKTsKICAgICAgICAgaWYgKCB2Y3B1X3ByaXZbdi0+dmNwdV9pZF0gPT0gTlVMTCAp
CiAgICAgICAgIHsKICAgICAgICAgICAgIGZvcl9lYWNoX3ZjcHUgKCBkLCB2ICkKQEAgLTM0Myw3
ICszNDYsOCBAQCBpbnQgc2NoZWRfbW92ZV9kb21haW4oc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0
IGNwdXBvb2wgKmMpCiAKICAgICBmb3JfZWFjaF92Y3B1ICggZCwgdiApCiAgICAgewotICAgICAg
ICBzY2hlZF9yZW1vdmVfdmNwdShvbGRfb3BzLCB2KTsKKyAgICAgICAgaXRlbS52Y3B1ID0gdjsK
KyAgICAgICAgc2NoZWRfcmVtb3ZlX2l0ZW0ob2xkX29wcywgJml0ZW0pOwogICAgIH0KIAogICAg
IGQtPmNwdXBvb2wgPSBjOwpAQCAtMzU0LDYgKzM1OCw3IEBAIGludCBzY2hlZF9tb3ZlX2RvbWFp
bihzdHJ1Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKICAgICB7CiAgICAgICAgIHNw
aW5sb2NrX3QgKmxvY2s7CiAKKyAgICAgICAgaXRlbS52Y3B1ID0gdjsKICAgICAgICAgdmNwdWRh
dGEgPSB2LT5zY2hlZF9wcml2OwogCiAgICAgICAgIG1pZ3JhdGVfdGltZXIoJnYtPnBlcmlvZGlj
X3RpbWVyLCBuZXdfcCk7CkBAIC0zNzgsNyArMzgzLDcgQEAgaW50IHNjaGVkX21vdmVfZG9tYWlu
KHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogCiAgICAgICAgIG5ld19wID0g
Y3B1bWFza19jeWNsZShuZXdfcCwgYy0+Y3B1X3ZhbGlkKTsKIAotICAgICAgICBzY2hlZF9pbnNl
cnRfdmNwdShjLT5zY2hlZCwgdik7CisgICAgICAgIHNjaGVkX2luc2VydF9pdGVtKGMtPnNjaGVk
LCAmaXRlbSk7CiAKICAgICAgICAgc2NoZWRfZnJlZV92ZGF0YShvbGRfb3BzLCB2Y3B1ZGF0YSk7
CiAgICAgfQpAQCAtMzk2LDEyICs0MDEsMTQgQEAgaW50IHNjaGVkX21vdmVfZG9tYWluKHN0cnVj
dCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogCiB2b2lkIHNjaGVkX2Rlc3Ryb3lfdmNw
dShzdHJ1Y3QgdmNwdSAqdikKIHsKKyAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSBpdGVtID0geyAudmNw
dSA9IHYgfTsKKwogICAgIGtpbGxfdGltZXIoJnYtPnBlcmlvZGljX3RpbWVyKTsKICAgICBraWxs
X3RpbWVyKCZ2LT5zaW5nbGVzaG90X3RpbWVyKTsKICAgICBraWxsX3RpbWVyKCZ2LT5wb2xsX3Rp
bWVyKTsKICAgICBpZiAoIHRlc3RfYW5kX2NsZWFyX2Jvb2wodi0+aXNfdXJnZW50KSApCiAgICAg
ICAgIGF0b21pY19kZWMoJnBlcl9jcHUoc2NoZWR1bGVfZGF0YSwgdi0+cHJvY2Vzc29yKS51cmdl
bnRfY291bnQpOwotICAgIHNjaGVkX3JlbW92ZV92Y3B1KHZjcHVfc2NoZWR1bGVyKHYpLCB2KTsK
KyAgICBzY2hlZF9yZW1vdmVfaXRlbSh2Y3B1X3NjaGVkdWxlcih2KSwgJml0ZW0pOwogICAgIHNj
aGVkX2ZyZWVfdmRhdGEodmNwdV9zY2hlZHVsZXIodiksIHYtPnNjaGVkX3ByaXYpOwogfQogCkBA
IC00NDYsNiArNDUzLDggQEAgdm9pZCBzY2hlZF9kZXN0cm95X2RvbWFpbihzdHJ1Y3QgZG9tYWlu
ICpkKQogCiB2b2lkIHZjcHVfc2xlZXBfbm9zeW5jX2xvY2tlZChzdHJ1Y3QgdmNwdSAqdikKIHsK
KyAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSBpdGVtID0geyAudmNwdSA9IHYgfTsKKwogICAgIEFTU0VS
VChzcGluX2lzX2xvY2tlZChwZXJfY3B1KHNjaGVkdWxlX2RhdGEsdi0+cHJvY2Vzc29yKS5zY2hl
ZHVsZV9sb2NrKSk7CiAKICAgICBpZiAoIGxpa2VseSghdmNwdV9ydW5uYWJsZSh2KSkgKQpAQCAt
NDUzLDcgKzQ2Miw3IEBAIHZvaWQgdmNwdV9zbGVlcF9ub3N5bmNfbG9ja2VkKHN0cnVjdCB2Y3B1
ICp2KQogICAgICAgICBpZiAoIHYtPnJ1bnN0YXRlLnN0YXRlID09IFJVTlNUQVRFX3J1bm5hYmxl
ICkKICAgICAgICAgICAgIHZjcHVfcnVuc3RhdGVfY2hhbmdlKHYsIFJVTlNUQVRFX29mZmxpbmUs
IE5PVygpKTsKIAotICAgICAgICBzY2hlZF9zbGVlcCh2Y3B1X3NjaGVkdWxlcih2KSwgdik7Cisg
ICAgICAgIHNjaGVkX3NsZWVwKHZjcHVfc2NoZWR1bGVyKHYpLCAmaXRlbSk7CiAgICAgfQogfQog
CkBAIC00ODUsNiArNDk0LDcgQEAgdm9pZCB2Y3B1X3dha2Uoc3RydWN0IHZjcHUgKnYpCiB7CiAg
ICAgdW5zaWduZWQgbG9uZyBmbGFnczsKICAgICBzcGlubG9ja190ICpsb2NrOworICAgIHN0cnVj
dCBzY2hlZF9pdGVtIGl0ZW0gPSB7IC52Y3B1ID0gdiB9OwogCiAgICAgVFJBQ0VfMkQoVFJDX1ND
SEVEX1dBS0UsIHYtPmRvbWFpbi0+ZG9tYWluX2lkLCB2LT52Y3B1X2lkKTsKIApAQCAtNDk0LDcg
KzUwNCw3IEBAIHZvaWQgdmNwdV93YWtlKHN0cnVjdCB2Y3B1ICp2KQogICAgIHsKICAgICAgICAg
aWYgKCB2LT5ydW5zdGF0ZS5zdGF0ZSA+PSBSVU5TVEFURV9ibG9ja2VkICkKICAgICAgICAgICAg
IHZjcHVfcnVuc3RhdGVfY2hhbmdlKHYsIFJVTlNUQVRFX3J1bm5hYmxlLCBOT1coKSk7Ci0gICAg
ICAgIHNjaGVkX3dha2UodmNwdV9zY2hlZHVsZXIodiksIHYpOworICAgICAgICBzY2hlZF93YWtl
KHZjcHVfc2NoZWR1bGVyKHYpLCAmaXRlbSk7CiAgICAgfQogICAgIGVsc2UgaWYgKCAhKHYtPnBh
dXNlX2ZsYWdzICYgVlBGX2Jsb2NrZWQpICkKICAgICB7CkBAIC01MzMsNiArNTQzLDcgQEAgdm9p
ZCB2Y3B1X3VuYmxvY2soc3RydWN0IHZjcHUgKnYpCiBzdGF0aWMgdm9pZCB2Y3B1X21vdmVfbG9j
a2VkKHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgbmV3X2NwdSkKIHsKICAgICB1bnNpZ25l
ZCBpbnQgb2xkX2NwdSA9IHYtPnByb2Nlc3NvcjsKKyAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSBpdGVt
ID0geyAudmNwdSA9IHYgfTsKIAogICAgIC8qCiAgICAgICogVHJhbnNmZXIgdXJnZW5jeSBzdGF0
dXMgdG8gbmV3IENQVSBiZWZvcmUgc3dpdGNoaW5nIENQVXMsIGFzCkBAIC01NDksNyArNTYwLDcg
QEAgc3RhdGljIHZvaWQgdmNwdV9tb3ZlX2xvY2tlZChzdHJ1Y3QgdmNwdSAqdiwgdW5zaWduZWQg
aW50IG5ld19jcHUpCiAgICAgICogQWN0dWFsIENQVSBzd2l0Y2ggdG8gbmV3IENQVS4gIFRoaXMg
aXMgc2FmZSBiZWNhdXNlIHRoZSBsb2NrCiAgICAgICogcG9pbnRlciBjYW4ndCBjaGFuZ2Ugd2hp
bGUgdGhlIGN1cnJlbnQgbG9jayBpcyBoZWxkLgogICAgICAqLwotICAgIHNjaGVkX21pZ3JhdGUo
dmNwdV9zY2hlZHVsZXIodiksIHYsIG5ld19jcHUpOworICAgIHNjaGVkX21pZ3JhdGUodmNwdV9z
Y2hlZHVsZXIodiksICZpdGVtLCBuZXdfY3B1KTsKIH0KIAogLyoKQEAgLTU5MSw2ICs2MDIsNyBA
QCBzdGF0aWMgdm9pZCB2Y3B1X21pZ3JhdGVfZmluaXNoKHN0cnVjdCB2Y3B1ICp2KQogICAgIHVu
c2lnbmVkIGludCBvbGRfY3B1LCBuZXdfY3B1OwogICAgIHNwaW5sb2NrX3QgKm9sZF9sb2NrLCAq
bmV3X2xvY2s7CiAgICAgYm9vbF90IHBpY2tfY2FsbGVkID0gMDsKKyAgICBzdHJ1Y3Qgc2NoZWRf
aXRlbSBpdGVtID0geyAudmNwdSA9IHYgfTsKIAogICAgIC8qCiAgICAgICogSWYgdGhlIHZjcHUg
aXMgY3VycmVudGx5IHJ1bm5pbmcsIHRoaXMgd2lsbCBiZSBoYW5kbGVkIGJ5CkBAIC02MjcsNyAr
NjM5LDcgQEAgc3RhdGljIHZvaWQgdmNwdV9taWdyYXRlX2ZpbmlzaChzdHJ1Y3QgdmNwdSAqdikK
ICAgICAgICAgICAgICAgICBicmVhazsKIAogICAgICAgICAgICAgLyogU2VsZWN0IGEgbmV3IENQ
VS4gKi8KLSAgICAgICAgICAgIG5ld19jcHUgPSBzY2hlZF9waWNrX2NwdSh2Y3B1X3NjaGVkdWxl
cih2KSwgdik7CisgICAgICAgICAgICBuZXdfY3B1ID0gc2NoZWRfcGlja19jcHUodmNwdV9zY2hl
ZHVsZXIodiksICZpdGVtKTsKICAgICAgICAgICAgIGlmICggKG5ld19sb2NrID09IHBlcl9jcHUo
c2NoZWR1bGVfZGF0YSwgbmV3X2NwdSkuc2NoZWR1bGVfbG9jaykgJiYKICAgICAgICAgICAgICAg
ICAgY3B1bWFza190ZXN0X2NwdShuZXdfY3B1LCB2LT5kb21haW4tPmNwdXBvb2wtPmNwdV92YWxp
ZCkgKQogICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtNjk3LDYgKzcwOSw3IEBAIHZvaWQgcmVz
dG9yZV92Y3B1X2FmZmluaXR5KHN0cnVjdCBkb21haW4gKmQpCiAgICAgewogICAgICAgICBzcGlu
bG9ja190ICpsb2NrOwogICAgICAgICB1bnNpZ25lZCBpbnQgb2xkX2NwdSA9IHYtPnByb2Nlc3Nv
cjsKKyAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gaXRlbSA9IHsgLnZjcHUgPSB2IH07CiAKICAg
ICAgICAgQVNTRVJUKCF2Y3B1X3J1bm5hYmxlKHYpKTsKIApAQCAtNzMyLDcgKzc0NSw3IEBAIHZv
aWQgcmVzdG9yZV92Y3B1X2FmZmluaXR5KHN0cnVjdCBkb21haW4gKmQpCiAgICAgICAgIHYtPnBy
b2Nlc3NvciA9IGNwdW1hc2tfYW55KGNwdW1hc2tfc2NyYXRjaF9jcHUoY3B1KSk7CiAKICAgICAg
ICAgbG9jayA9IHZjcHVfc2NoZWR1bGVfbG9ja19pcnEodik7Ci0gICAgICAgIHYtPnByb2Nlc3Nv
ciA9IHNjaGVkX3BpY2tfY3B1KHZjcHVfc2NoZWR1bGVyKHYpLCB2KTsKKyAgICAgICAgdi0+cHJv
Y2Vzc29yID0gc2NoZWRfcGlja19jcHUodmNwdV9zY2hlZHVsZXIodiksICZpdGVtKTsKICAgICAg
ICAgc3Bpbl91bmxvY2tfaXJxKGxvY2spOwogCiAgICAgICAgIGlmICggb2xkX2NwdSAhPSB2LT5w
cm9jZXNzb3IgKQpAQCAtODQ0LDcgKzg1Nyw5IEBAIHN0YXRpYyBpbnQgY3B1X2Rpc2FibGVfc2No
ZWR1bGVyX2NoZWNrKHVuc2lnbmVkIGludCBjcHUpCiB2b2lkIHNjaGVkX3NldF9hZmZpbml0eSgK
ICAgICBzdHJ1Y3QgdmNwdSAqdiwgY29uc3QgY3B1bWFza190ICpoYXJkLCBjb25zdCBjcHVtYXNr
X3QgKnNvZnQpCiB7Ci0gICAgc2NoZWRfYWRqdXN0X2FmZmluaXR5KGRvbV9zY2hlZHVsZXIodi0+
ZG9tYWluKSwgdiwgaGFyZCwgc29mdCk7CisgICAgc3RydWN0IHNjaGVkX2l0ZW0gaXRlbSA9IHsg
LnZjcHUgPSB2IH07CisKKyAgICBzY2hlZF9hZGp1c3RfYWZmaW5pdHkoZG9tX3NjaGVkdWxlcih2
LT5kb21haW4pLCAmaXRlbSwgaGFyZCwgc29mdCk7CiAKICAgICBpZiAoIGhhcmQgKQogICAgICAg
ICBjcHVtYXNrX2NvcHkodi0+Y3B1X2hhcmRfYWZmaW5pdHksIGhhcmQpOwpAQCAtMTAxNyw5ICsx
MDMyLDEwIEBAIHN0YXRpYyBsb25nIGRvX3BvbGwoc3RydWN0IHNjaGVkX3BvbGwgKnNjaGVkX3Bv
bGwpCiBsb25nIHZjcHVfeWllbGQodm9pZCkKIHsKICAgICBzdHJ1Y3QgdmNwdSAqIHY9Y3VycmVu
dDsKKyAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSBpdGVtID0geyAudmNwdSA9IHYgfTsKICAgICBzcGlu
bG9ja190ICpsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2KTsKIAotICAgIHNjaGVkX3lp
ZWxkKHZjcHVfc2NoZWR1bGVyKHYpLCB2KTsKKyAgICBzY2hlZF95aWVsZCh2Y3B1X3NjaGVkdWxl
cih2KSwgJml0ZW0pOwogICAgIHZjcHVfc2NoZWR1bGVfdW5sb2NrX2lycShsb2NrLCB2KTsKIAog
ICAgIFNDSEVEX1NUQVRfQ1JBTksodmNwdV95aWVsZCk7CkBAIC0xNTE0LDYgKzE1MzAsOCBAQCBz
dGF0aWMgdm9pZCBzY2hlZHVsZSh2b2lkKQogCiB2b2lkIGNvbnRleHRfc2F2ZWQoc3RydWN0IHZj
cHUgKnByZXYpCiB7CisgICAgc3RydWN0IHNjaGVkX2l0ZW0gaXRlbSA9IHsgLnZjcHUgPSBwcmV2
IH07CisKICAgICAvKiBDbGVhciBydW5uaW5nIGZsYWcgL2FmdGVyLyB3cml0aW5nIGNvbnRleHQg
dG8gbWVtb3J5LiAqLwogICAgIHNtcF93bWIoKTsKIApAQCAtMTUyMiw3ICsxNTQwLDcgQEAgdm9p
ZCBjb250ZXh0X3NhdmVkKHN0cnVjdCB2Y3B1ICpwcmV2KQogICAgIC8qIENoZWNrIGZvciBtaWdy
YXRpb24gcmVxdWVzdCAvYWZ0ZXIvIGNsZWFyaW5nIHJ1bm5pbmcgZmxhZy4gKi8KICAgICBzbXBf
bWIoKTsKIAotICAgIHNjaGVkX2NvbnRleHRfc2F2ZWQodmNwdV9zY2hlZHVsZXIocHJldiksIHBy
ZXYpOworICAgIHNjaGVkX2NvbnRleHRfc2F2ZWQodmNwdV9zY2hlZHVsZXIocHJldiksICZpdGVt
KTsKIAogICAgIHZjcHVfbWlncmF0ZV9maW5pc2gocHJldik7CiB9CkBAIC0xNTc4LDYgKzE1OTYs
NyBAQCBzdGF0aWMgaW50IGNwdV9zY2hlZHVsZV91cCh1bnNpZ25lZCBpbnQgY3B1KQogICAgIGVs
c2UKICAgICB7CiAgICAgICAgIHN0cnVjdCB2Y3B1ICppZGxlID0gaWRsZV92Y3B1W2NwdV07Cisg
ICAgICAgIHN0cnVjdCBzY2hlZF9pdGVtIGl0ZW0gPSB7IC52Y3B1ID0gaWRsZSB9OwogCiAgICAg
ICAgIC8qCiAgICAgICAgICAqIER1cmluZyAoQUNQST8pIHN1c3BlbmQgdGhlIGlkbGUgdkNQVSBm
b3IgdGhpcyBwQ1BVIGlzIG5vdCBmcmVlZCwKQEAgLTE1OTEsNyArMTYxMCw3IEBAIHN0YXRpYyBp
bnQgY3B1X3NjaGVkdWxlX3VwKHVuc2lnbmVkIGludCBjcHUpCiAgICAgICAgICAqLwogICAgICAg
ICBBU1NFUlQoaWRsZS0+c2NoZWRfcHJpdiA9PSBOVUxMKTsKIAotICAgICAgICBpZGxlLT5zY2hl
ZF9wcml2ID0gc2NoZWRfYWxsb2NfdmRhdGEoJm9wcywgaWRsZSwKKyAgICAgICAgaWRsZS0+c2No
ZWRfcHJpdiA9IHNjaGVkX2FsbG9jX3ZkYXRhKCZvcHMsICZpdGVtLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRsZS0+ZG9tYWluLT5zY2hlZF9wcml2KTsK
ICAgICAgICAgaWYgKCBpZGxlLT5zY2hlZF9wcml2ID09IE5VTEwgKQogICAgICAgICAgICAgcmV0
dXJuIC1FTk9NRU07CkBAIC0xNzg0LDYgKzE4MDMsNyBAQCB2b2lkIF9faW5pdCBzY2hlZHVsZXJf
aW5pdCh2b2lkKQogaW50IHNjaGVkdWxlX2NwdV9zd2l0Y2godW5zaWduZWQgaW50IGNwdSwgc3Ry
dWN0IGNwdXBvb2wgKmMpCiB7CiAgICAgc3RydWN0IHZjcHUgKmlkbGU7CisgICAgc3RydWN0IHNj
aGVkX2l0ZW0gaXRlbTsKICAgICB2b2lkICpwcHJpdiwgKnBwcml2X29sZCwgKnZwcml2LCAqdnBy
aXZfb2xkOwogICAgIHN0cnVjdCBzY2hlZHVsZXIgKm9sZF9vcHMgPSBwZXJfY3B1KHNjaGVkdWxl
ciwgY3B1KTsKICAgICBzdHJ1Y3Qgc2NoZWR1bGVyICpuZXdfb3BzID0gKGMgPT0gTlVMTCkgPyAm
b3BzIDogYy0+c2NoZWQ7CkBAIC0xODE5LDEwICsxODM5LDExIEBAIGludCBzY2hlZHVsZV9jcHVf
c3dpdGNoKHVuc2lnbmVkIGludCBjcHUsIHN0cnVjdCBjcHVwb29sICpjKQogICAgICAqICAgIHNj
aGVkX3ByaXYgZmllbGQgb2YgdGhlIHBlci12Q1BVIGluZm8gb2YgdGhlIGlkbGUgZG9tYWluLgog
ICAgICAqLwogICAgIGlkbGUgPSBpZGxlX3ZjcHVbY3B1XTsKKyAgICBpdGVtLnZjcHUgPSBpZGxl
OwogICAgIHBwcml2ID0gc2NoZWRfYWxsb2NfcGRhdGEobmV3X29wcywgY3B1KTsKICAgICBpZiAo
IElTX0VSUihwcHJpdikgKQogICAgICAgICByZXR1cm4gUFRSX0VSUihwcHJpdik7Ci0gICAgdnBy
aXYgPSBzY2hlZF9hbGxvY192ZGF0YShuZXdfb3BzLCBpZGxlLCBpZGxlLT5kb21haW4tPnNjaGVk
X3ByaXYpOworICAgIHZwcml2ID0gc2NoZWRfYWxsb2NfdmRhdGEobmV3X29wcywgJml0ZW0sIGlk
bGUtPmRvbWFpbi0+c2NoZWRfcHJpdik7CiAgICAgaWYgKCB2cHJpdiA9PSBOVUxMICkKICAgICB7
CiAgICAgICAgIHNjaGVkX2ZyZWVfcGRhdGEobmV3X29wcywgcHByaXYsIGNwdSk7CmRpZmYgLS1n
aXQgYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQtaWYuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1p
Zi5oCmluZGV4IDU5M2NkNzkyOTcuLmI0YTkzYmI3NmIgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRl
L3hlbi9zY2hlZC1pZi5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oCkBAIC0xNDEs
OCArMTQxLDggQEAgc3RydWN0IHNjaGVkdWxlciB7CiAgICAgdm9pZCAgICAgICAgICgqZGVpbml0
KSAgICAgICAgIChzdHJ1Y3Qgc2NoZWR1bGVyICopOwogCiAgICAgdm9pZCAgICAgICAgICgqZnJl
ZV92ZGF0YSkgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHZvaWQgKik7Ci0gICAgdm9p
ZCAqICAgICAgICgqYWxsb2NfdmRhdGEpICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0
cnVjdCB2Y3B1ICosCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICop
OworICAgIHZvaWQgKiAgICAgICAoKmFsbG9jX3ZkYXRhKSAgICAoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVk
X2l0ZW0gKiwgdm9pZCAqKTsKICAgICB2b2lkICAgICAgICAgKCpmcmVlX3BkYXRhKSAgICAgKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgdm9pZCAqLCBpbnQpOwogICAgIHZvaWQgKiAgICAgICAo
KmFsbG9jX3BkYXRhKSAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBpbnQpOwogICAgIHZv
aWQgICAgICAgICAoKmluaXRfcGRhdGEpICAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCB2
b2lkICosIGludCk7CkBAIC0xNTYsMjQgKzE1NiwzMiBAQCBzdHJ1Y3Qgc2NoZWR1bGVyIHsKICAg
ICB2b2lkICAgICAgICAgKCpzd2l0Y2hfc2NoZWQpICAgKHN0cnVjdCBzY2hlZHVsZXIgKiwgdW5z
aWduZWQgaW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqLCB2
b2lkICopOwogCi0gICAgLyogQWN0aXZhdGUgLyBkZWFjdGl2YXRlIHZjcHVzIGluIGEgY3B1IHBv
b2wgKi8KLSAgICB2b2lkICAgICAgICAgKCppbnNlcnRfdmNwdSkgICAgKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKiwgc3RydWN0IHZjcHUgKik7Ci0gICAgdm9pZCAgICAgICAgICgqcmVtb3ZlX3Zj
cHUpICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2Y3B1ICopOwotCi0gICAg
dm9pZCAgICAgICAgICgqc2xlZXApICAgICAgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICos
IHN0cnVjdCB2Y3B1ICopOwotICAgIHZvaWQgICAgICAgICAoKndha2UpICAgICAgICAgICAoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqKTsKLSAgICB2b2lkICAgICAgICAg
KCp5aWVsZCkgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0IHZjcHUg
Kik7Ci0gICAgdm9pZCAgICAgICAgICgqY29udGV4dF9zYXZlZCkgIChjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICosIHN0cnVjdCB2Y3B1ICopOworICAgIC8qIEFjdGl2YXRlIC8gZGVhY3RpdmF0ZSBp
dGVtcyBpbiBhIGNwdSBwb29sICovCisgICAgdm9pZCAgICAgICAgICgqaW5zZXJ0X2l0ZW0pICAg
IChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqKTsKKyAgICB2b2lkICAgICAgICAgKCpyZW1vdmVf
aXRlbSkgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF9pdGVtICopOworCisgICAgdm9pZCAgICAgICAg
ICgqc2xlZXApICAgICAgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqKTsKKyAgICB2b2lk
ICAgICAgICAgKCp3YWtlKSAgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF9pdGVtICopOwor
ICAgIHZvaWQgICAgICAgICAoKnlpZWxkKSAgICAgICAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0
ZW0gKik7CisgICAgdm9pZCAgICAgICAgICgqY29udGV4dF9zYXZlZCkgIChjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c2NoZWRfaXRlbSAqKTsKIAogICAgIHN0cnVjdCB0YXNrX3NsaWNlICgqZG9fc2NoZWR1bGUpIChj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHNfdGltZV90LAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBib29sX3QgdGFza2xldF93b3JrX3NjaGVkdWxlZCk7CiAKLSAgICBp
bnQgICAgICAgICAgKCpwaWNrX2NwdSkgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwg
c3RydWN0IHZjcHUgKik7Ci0gICAgdm9pZCAgICAgICAgICgqbWlncmF0ZSkgICAgICAgIChjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2Y3B1ICosCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQpOworICAgIGludCAgICAgICAgICAoKnBpY2tf
Y3B1KSAgICAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKik7CisgICAgdm9pZCAgICAgICAg
ICgqbWlncmF0ZSkgICAgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfaXRlbSAqLCB1bnNpZ25lZCBp
bnQpOwogICAgIGludCAgICAgICAgICAoKmFkanVzdCkgICAgICAgICAoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqLCBzdHJ1Y3QgZG9tYWluICosCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgeGVuX2RvbWN0bF9zY2hlZHVsZXJfb3AgKik7Ci0gICAgdm9pZCAgICAg
ICAgICgqYWRqdXN0X2FmZmluaXR5KShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2
Y3B1ICosCisgICAgdm9pZCAgICAgICAgICgqYWRqdXN0X2FmZmluaXR5KShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c2NoZWRfaXRlbSAqLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
c3RydWN0IGNwdW1hc2sgKiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IHN0cnVjdCBjcHVtYXNrICopOwogICAgIGludCAgICAgICAgICAoKmFkanVzdF9nbG9iYWwp
ICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLApAQCAtMjg1LDExICsyOTMsMTEgQEAgc3RhdGlj
IGlubGluZSB2b2lkIHNjaGVkX2RlaW5pdF9wZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpz
LCB2b2lkICpkYXRhLAogICAgICAgICBzLT5kZWluaXRfcGRhdGEocywgZGF0YSwgY3B1KTsKIH0K
IAotc3RhdGljIGlubGluZSB2b2lkICpzY2hlZF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpzLCBzdHJ1Y3QgdmNwdSAqdiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdm9pZCAqZG9tX2RhdGEpCitzdGF0aWMgaW5saW5lIHZvaWQgKnNjaGVkX2FsbG9j
X3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtLCB2b2lkICpkb21fZGF0YSkK
IHsKICAgICBpZiAoIHMtPmFsbG9jX3ZkYXRhICkKLSAgICAgICAgcmV0dXJuIHMtPmFsbG9jX3Zk
YXRhKHMsIHYsIGRvbV9kYXRhKTsKKyAgICAgICAgcmV0dXJuIHMtPmFsbG9jX3ZkYXRhKHMsIGl0
ZW0sIGRvbV9kYXRhKTsKICAgICBlbHNlCiAgICAgICAgIHJldHVybiBOVUxMOwogfQpAQCAtMzA2
LDY1ICszMTQsNzEgQEAgc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2ZyZWVfdmRhdGEoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqcywgdm9pZCAqZGF0YSkKICAgICAgICAgQVNTRVJUKCFkYXRhKTsK
IH0KIAotc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2luc2VydF92Y3B1KGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKnMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2lu
c2VydF9pdGVtKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7Ci0gICAgaWYgKCBz
LT5pbnNlcnRfdmNwdSApCi0gICAgICAgIHMtPmluc2VydF92Y3B1KHMsIHYpOworICAgIGlmICgg
cy0+aW5zZXJ0X2l0ZW0gKQorICAgICAgICBzLT5pbnNlcnRfaXRlbShzLCBpdGVtKTsKIH0KIAot
c3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3JlbW92ZV92Y3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKnMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3JlbW92ZV9p
dGVtKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7Ci0gICAgaWYgKCBzLT5yZW1v
dmVfdmNwdSApCi0gICAgICAgIHMtPnJlbW92ZV92Y3B1KHMsIHYpOworICAgIGlmICggcy0+cmVt
b3ZlX2l0ZW0gKQorICAgICAgICBzLT5yZW1vdmVfaXRlbShzLCBpdGVtKTsKIH0KIAotc3RhdGlj
IGlubGluZSB2b2lkIHNjaGVkX3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVj
dCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3NsZWVwKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVk
X2l0ZW0gKml0ZW0pCiB7CiAgICAgaWYgKCBzLT5zbGVlcCApCi0gICAgICAgIHMtPnNsZWVwKHMs
IHYpOworICAgICAgICBzLT5zbGVlcChzLCBpdGVtKTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lk
IHNjaGVkX3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywgc3RydWN0IHZjcHUgKnYpCitz
dGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpzLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7
CiAgICAgaWYgKCBzLT53YWtlICkKLSAgICAgICAgcy0+d2FrZShzLCB2KTsKKyAgICAgICAgcy0+
d2FrZShzLCBpdGVtKTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3lpZWxkKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lk
IHNjaGVkX3lpZWxkKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CiAgICAgaWYgKCBzLT55
aWVsZCApCi0gICAgICAgIHMtPnlpZWxkKHMsIHYpOworICAgICAgICBzLT55aWVsZChzLCBpdGVt
KTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2NvbnRleHRfc2F2ZWQoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqcywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCB2Y3B1ICp2KQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0pCiB7CiAgICAgaWYgKCBzLT5jb250ZXh0X3NhdmVkICkK
LSAgICAgICAgcy0+Y29udGV4dF9zYXZlZChzLCB2KTsKKyAgICAgICAgcy0+Y29udGV4dF9zYXZl
ZChzLCBpdGVtKTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX21pZ3JhdGUoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqcywgc3RydWN0IHZjcHUgKnYsCi0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgY3B1KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVk
X21pZ3JhdGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtLCB1bnNpZ25lZCBpbnQgY3B1KQog
ewogICAgIGlmICggcy0+bWlncmF0ZSApCi0gICAgICAgIHMtPm1pZ3JhdGUocywgdiwgY3B1KTsK
KyAgICAgICAgcy0+bWlncmF0ZShzLCBpdGVtLCBjcHUpOwogICAgIGVsc2UKLSAgICAgICAgdi0+
cHJvY2Vzc29yID0gY3B1OworICAgICAgICBpdGVtLT52Y3B1LT5wcm9jZXNzb3IgPSBjcHU7CiB9
CiAKLXN0YXRpYyBpbmxpbmUgaW50IHNjaGVkX3BpY2tfY3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKnMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSBpbnQgc2NoZWRfcGlja19jcHUo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBzY2hlZF9pdGVtICppdGVtKQogewogICAgIEFTU0VSVChzLT5waWNrX2NwdSk7
Ci0gICAgcmV0dXJuIHMtPnBpY2tfY3B1KHMsIHYpOworICAgIHJldHVybiBzLT5waWNrX2NwdShz
LCBpdGVtKTsKIH0KIAogc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2FkanVzdF9hZmZpbml0eShj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpzLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgdmNwdSAqdiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IHNjaGVkX2l0ZW0gKml0ZW0sCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNwdW1hc2tfdCAqaGFyZCwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3B1bWFza190ICpzb2Z0KQogewog
ICAgIGlmICggcy0+YWRqdXN0X2FmZmluaXR5ICkKLSAgICAgICAgcy0+YWRqdXN0X2FmZmluaXR5
KHMsIHYsIGhhcmQsIHNvZnQpOworICAgICAgICBzLT5hZGp1c3RfYWZmaW5pdHkocywgaXRlbSwg
aGFyZCwgc29mdCk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgaW50IHNjaGVkX2FkanVzdF9kb20oY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqcywgc3RydWN0IGRvbWFpbiAqZCwKZGlmZiAtLWdpdCBhL3hl
bi9pbmNsdWRlL3hlbi9zY2hlZC5oIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKaW5kZXggNzQ4
YmIwZjJmOS4uOTQ2YTcxZmZkYyAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgK
KysrIGIveGVuL2luY2x1ZGUveGVuL3NjaGVkLmgKQEAgLTI3NSw2ICsyNzUsMTAgQEAgc3RydWN0
IHZjcHUKICAgICBzdHJ1Y3QgYXJjaF92Y3B1IGFyY2g7CiB9OwogCitzdHJ1Y3Qgc2NoZWRfaXRl
bSB7CisgICAgc3RydWN0IHZjcHUgICAgICAgICAgICp2Y3B1OworfTsKKwogLyogUGVyLWRvbWFp
biBsb2NrIGNhbiBiZSByZWN1cnNpdmVseSBhY3F1aXJlZCBpbiBmYXVsdCBoYW5kbGVycy4gKi8K
ICNkZWZpbmUgZG9tYWluX2xvY2soZCkgc3Bpbl9sb2NrX3JlY3Vyc2l2ZSgmKGQpLT5kb21haW5f
bG9jaykKICNkZWZpbmUgZG9tYWluX3VubG9jayhkKSBzcGluX3VubG9ja19yZWN1cnNpdmUoJihk
KS0+ZG9tYWluX2xvY2spCi0tIAoyLjE2LjQKCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0
cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlz
dGluZm8veGVuLWRldmVs

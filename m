Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id ED7E1C04C3
	for <lists+xen-devel@lfdr.de>; Fri, 27 Sep 2019 14:01:15 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iDot4-0002YE-TF; Fri, 27 Sep 2019 11:58:14 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=A1rL=XW=gmail.com=olekstysh@srs-us1.protection.inumbo.net>)
 id 1iDot4-0002Y8-9o
 for xen-devel@lists.xenproject.org; Fri, 27 Sep 2019 11:58:14 +0000
X-Inumbo-ID: 14ae082c-e11e-11e9-bf31-bc764e2007e4
Received: from mail-lj1-x242.google.com (unknown [2a00:1450:4864:20::242])
 by localhost (Halon) with ESMTPS
 id 14ae082c-e11e-11e9-bf31-bc764e2007e4;
 Fri, 27 Sep 2019 11:58:13 +0000 (UTC)
Received: by mail-lj1-x242.google.com with SMTP id m13so2188832ljj.11
 for <xen-devel@lists.xenproject.org>; Fri, 27 Sep 2019 04:58:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id;
 bh=UdLcNM0m8KyMX2czbvhpEmCu6gzp8xQvc51H9sjWnXE=;
 b=dmDUJOzisAA4ExQnDL+McDpFklDULWeSuC7vEt4188O2BJJPzer89gGKIewtrByAJH
 Qkto2Fil+ajPflDIlBe7We5L2KV0r9m515mCiopPASsD/6r1s2esvsdSRXnp+AAZeIux
 6khvEJoc6beObz7Gztzu+DBHAfUagpjCJLUJ1qmnNVox5ujQ3qmMpwqY2GJfIKpTDKnt
 SoKwKxelyvPR6L/haNweHaVBWBFsaqzHB2UwVIDXPd6/3gPt4LynHSPrIvKAaV1qzz4c
 edb99XHsQnEEu2K7jbgegxyq1Qkpb1uZ1I6QPf5EUwb3ajLnCNIxG4XWWn16p6WWzKtA
 hu0g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id;
 bh=UdLcNM0m8KyMX2czbvhpEmCu6gzp8xQvc51H9sjWnXE=;
 b=FO27k476B+wpo090Uqp+3RtDUqF9ugsu22QuPGKOvgcto0gqP0kAr16Mn5Zd/d9Mj4
 LKcAiwyNaEQRK4WPxmzBuCFIaIt+u7Zl01L3nOm7QVbqxLZwaneADthSqe/gmJ9ItTjs
 Yu7BrHe5SA+VRYBlgCocBSAaywFX0tSyoHmoUPojVrvwbNO6aZq3GZQ+nRdWKNCZVuBE
 syL2ew0qKq2d+BNH0k1xnhmgOKV69tQ9Dh26ti8PYNUfG6gqMG3Zzk5//sJAGwPF5I8i
 39pcSh03E7o8BJ0XByBrDN+SFPpKBgcZ91eVXlLiPkaE9jJZK7Dokw1KwZkw1RC+QMS0
 LA2w==
X-Gm-Message-State: APjAAAX2wDWVFSrZhvfoIoqhWfeLQb3209ouJa4Gjbpp6yDVfU8RDQ/h
 Vpo1Tk7VTfXyUziI2XZaX9Tg60L7MAM=
X-Google-Smtp-Source: APXvYqyFbP7gvsKjcx1U6caBDg7FdNEqJqdGUxN0hmsoW+fEWgOdP49piMOeIoOJpltM9QQMTuDkZQ==
X-Received: by 2002:a2e:8642:: with SMTP id i2mr2632908ljj.110.1569585491560; 
 Fri, 27 Sep 2019 04:58:11 -0700 (PDT)
Received: from otyshchenko.kyiv.epam.com (ll-22.209.223.85.sovam.net.ua.
 [85.223.209.22])
 by smtp.gmail.com with ESMTPSA id q13sm432014lfk.51.2019.09.27.04.58.10
 (version=TLS1_2 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
 Fri, 27 Sep 2019 04:58:10 -0700 (PDT)
From: Oleksandr Tyshchenko <olekstysh@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Fri, 27 Sep 2019 14:57:54 +0300
Message-Id: <1569585474-8955-1-git-send-email-olekstysh@gmail.com>
X-Mailer: git-send-email 2.7.4
Subject: [Xen-devel] [PATCH V5] xen/arm: Restrict "p2m_ipa_bits" according
 to the IOMMU requirements
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Oleksandr Tyshchenko <oleksandr_tyshchenko@epam.com>, julien.grall@arm.com,
 sstabellini@kernel.org, volodymyr_babchuk@epam.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogT2xla3NhbmRyIFR5c2hjaGVua28gPG9sZWtzYW5kcl90eXNoY2hlbmtvQGVwYW0uY29t
PgoKVGhlcmUgaXMgYSBzdHJpY3QgcmVxdWlyZW1lbnQgZm9yIHRoZSBJT01NVSB3aGljaCB3YW50
cyB0byBzaGFyZQp0aGUgUDJNIHRhYmxlIHdpdGggdGhlIENQVS4gVGhlIElPTU1VJ3MgU3RhZ2Ut
MiBpbnB1dCBzaXplIG11c3QgYmUgZXF1YWwKdG8gdGhlIFAyTSBJUEEgc2l6ZS4gSXQgaXMgbm90
IGEgcHJvYmxlbSB3aGVuIHRoZSBJT01NVSBjYW4gc3VwcG9ydAphbGwgdmFsdWVzIHRoZSBDUFUg
c3VwcG9ydHMuIEluIHRoYXQgY2FzZSwgdGhlIElPTU1VIGRyaXZlciB3b3VsZCBqdXN0CnVzZSBh
bnkgInAybV9pcGFfYml0cyIgdmFsdWUgYXMgaXMuIEJ1dCwgdGhlcmUgYXJlIGNhc2VzIHdoZW4g
bm90LgoKSW4gb3JkZXIgdG8gbWFrZSBQMk0gc2hhcmluZyBwb3NzaWJsZSBvbiB0aGUgcGxhdGZv
cm1zIHdoaWNoCklPTU1VcyBoYXZlIGEgbGltaXRhdGlvbiBpbiBtYXhpbXVtIFN0YWdlLTIgaW5w
dXQgc2l6ZSBpbnRyb2R1Y2UKdGhlIGZvbGxvd2luZyBsb2dpYy4KCkZpcnN0IGluaXRpYWxpemUg
dGhlIElPTU1VIHN1YnN5c3RlbSBhbmQgZ2F0aGVyIHJlcXVpcmVtZW50cyByZWdhcmRpbmcKdGhl
IG1heGltdW0gSVBBIGJpdHMgc3VwcG9ydGVkIGJ5IGVhY2ggSU9NTVUgZGV2aWNlIHRvIGZpZ3Vy
ZSBvdXQKdGhlIG1pbmltdW0gdmFsdWUgYW1vbmcgdGhlbS4gSW4gdGhlIFAyTSBjb2RlLCB0YWtl
IGludG8gdGhlIGFjY291bnQKdGhlIElPTU1VIHJlcXVpcmVtZW50cyBhbmQgY2hvb3NlIHN1aXRh
YmxlICJwYV9yYW5nZSIgYWNjb3JkaW5nCnRvIHRoZSByZXN0cmljdGVkICJwMm1faXBhX2JpdHMi
LgoKU2lnbmVkLW9mZi1ieTogT2xla3NhbmRyIFR5c2hjaGVua28gPG9sZWtzYW5kcl90eXNoY2hl
bmtvQGVwYW0uY29tPgpDQzogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNvbT4KCi0t
LQpQbGVhc2Ugbm90ZSwgdGhpcyBwYXRjaCB3YXNuJ3QgY2hlY2tlZCBmb3IgdGhlIFNNTVUuCgpG
b3IgSVBNTVUgaXQgd29ya3Mgd2VsbDoKCncvIElPTU1VOgooWEVOKSBJL08gdmlydHVhbGlzYXRp
b24gZW5hYmxlZAooWEVOKSAgLSBEb20wIG1vZGU6IFJlbGF4ZWQKKFhFTikgSW50ZXJydXB0IHJl
bWFwcGluZyBlbmFibGVkCihYRU4pIFAyTTogNDAtYml0IElQQSB3aXRoIDQwLWJpdCBQQSBhbmQg
OC1iaXQgVk1JRAooWEVOKSBQMk06IDMgbGV2ZWxzIHdpdGggb3JkZXItMSByb290LCBWVENSIDB4
ODAwMjM1NTgKKFhFTikgQWRkaW5nIGNwdSAwIHRvIHJ1bnF1ZXVlIDAKCncvbyBJT01NVToKKFhF
TikgSS9PIHZpcnR1YWxpc2F0aW9uIGRpc2FibGVkCihYRU4pIFAyTTogNDQtYml0IElQQSB3aXRo
IDQ0LWJpdCBQQSBhbmQgOC1iaXQgVk1JRAooWEVOKSBQMk06IDQgbGV2ZWxzIHdpdGggb3JkZXIt
MCByb290LCBWVENSIDB4ODAwNDM1OTQKCgpDaGFuZ2VzIFY0IFs0XSAtPiBWNToKICAgLSBbU01N
VV0gVXNlIHAybV9pcGFfYml0cyBpbnN0ZWFkIG9mIHNtbXUtPnMyX2lucHV0X3NpemUgZm9yCiAg
ICAgdGhlIFRUQkNSIGNhbGN1bGF0aW9uCgpDaGFuZ2VzIFJGQyBWMyBbM10gLT4gVjQgWzRdOgog
ICAtIE1vdmUgY2hlY2sgZm9yIHAybV9pcGFfYml0cyB0byBiZSBhdCBsZWFzdCA0MCBiaXQKICAg
ICB1bmRlciAjaWZkZWYgQ09ORklHX0FSTV8zMgogICAtIFJld29yZCB0aGUgInBhbmljIiBtZXNz
YWdlCgpDaGFuZ2VzIFJGQyBWMiBbMl0gLT4gUkZDIFYzIFszXToKICAgLSBDaGVjayBpbiBzZXR1
cF92aXJ0X3BhZ2luZygpIHRoYXQgdGhlICJyZXN0cmljdGVkIgogICAgIFAyTSBJUEEgc2l6ZSBp
cyBhdCBsZWFzdCA0MC1iaXQKICAgLSBNb2RpZnkgbG9naWMgaW4gc2V0dXBfdmlydF9wYWdpbmco
KSBhIGJpdCB0byBtYWtlIGl0CiAgICAgIklPTU1VLWFnbm9zdGljIgogICAtIENsYXJpZnkgY29t
bWVudHMgaW4gY29kZSwgYWRkIHNvbWUgZXhwbGFuYXRpb25zCiAgIC0gQXZvaWQgdXNpbmcgdGhl
IHRlcm0gIklPTU1VIiBpbiBQMk0gY29kZSB3aGVyZSBwb3NzaWJsZQoKQ2hhbmdlcyBSRkMgVjEg
WzFdIC0+IFJGQyBWMiBbMl06CiAgIC0gRG9uJ3QgdXBkYXRlIHAybV9pcGFfYml0cyBieSB0aGUg
SU9NTVUgZHJpdmVycyBkaXJlY3RseSwKICAgICBpbnRyb2R1Y2UgcDJtX3Jlc3RyaWN0X2lwYV9i
aXRzKCkKICAgLSBDbGFyaWZ5IHBhdGNoIHN1YmplY3QvZGVzY3JpcHRpb24KICAgLSBBZGQgbW9y
ZSBjb21tZW50cyB0byBjb2RlCiAgIC0gQ2hlY2sgZm9yIGVxdWl2YWxlbnQgInBhYml0cyIgaW4g
c2V0dXBfdmlydF9wYWdpbmcoKQogICAtIFJlbW92ZSBBU1NFUlRzIGZyb20gdGhlIFNNTVUgYW5k
IElQTU1VIGRyaXZlcnMKClsxXSBodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3JnL2FyY2hpdmVz
L2h0bWwveGVuLWRldmVsLzIwMTktMDgvbXNnMDIwNzguaHRtbApbMl0gaHR0cHM6Ly9saXN0cy54
ZW5wcm9qZWN0Lm9yZy9hcmNoaXZlcy9odG1sL3hlbi1kZXZlbC8yMDE5LTA4L21zZzAyMjM3Lmh0
bWwKWzNdIGh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvYXJjaGl2ZXMvaHRtbC94ZW4tZGV2
ZWwvMjAxOS0wOS9tc2cwMDk3My5odG1sCls0XSBodHRwczovL2xpc3RzLnhlbnByb2plY3Qub3Jn
L2FyY2hpdmVzL2h0bWwveGVuLWRldmVsLzIwMTktMDkvbXNnMDIzMDQuaHRtbAotLS0KIHhlbi9h
cmNoL2FybS9wMm0uYyAgICAgICAgICAgICAgICAgICAgICAgfCA0MSArKysrKysrKysrKysrKysr
KysrKysrKysrKysrLS0tLQogeGVuL2FyY2gvYXJtL3NldHVwLmMgICAgICAgICAgICAgICAgICAg
ICB8ICA5ICsrKysrLS0KIHhlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FybS9pcG1tdS12bXNhLmMg
fCAxOCArKy0tLS0tLS0tLS0tLQogeGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYXJtL3NtbXUuYyAg
ICAgICB8IDE3ICsrKysrKystLS0tLS0KIHhlbi9pbmNsdWRlL2FzbS1hcm0vcDJtLmggICAgICAg
ICAgICAgICAgfCAgOSArKysrKysrCiA1IGZpbGVzIGNoYW5nZWQsIDYzIGluc2VydGlvbnMoKyks
IDMxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9wMm0uYyBiL3hlbi9h
cmNoL2FybS9wMm0uYwppbmRleCBlODU5NzYzLi41Yzc1MDRlIDEwMDY0NAotLS0gYS94ZW4vYXJj
aC9hcm0vcDJtLmMKKysrIGIveGVuL2FyY2gvYXJtL3AybS5jCkBAIC0zNCw3ICszNCwxMSBAQCBz
dGF0aWMgdW5zaWduZWQgaW50IF9fcmVhZF9tb3N0bHkgbWF4X3ZtaWQgPSBNQVhfVk1JRF84X0JJ
VDsKIAogI2RlZmluZSBQMk1fUk9PVF9QQUdFUyAgICAoMTw8UDJNX1JPT1RfT1JERVIpCiAKLXVu
c2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IHAybV9pcGFfYml0czsKKy8qCisgKiBTZXQgbGFyZ2Vy
IHRoYW4gYW55IHBvc3NpYmxlIHZhbHVlLCBzbyB0aGUgbnVtYmVyIG9mIElQQSBiaXRzIGNhbiBi
ZQorICogcmVzdHJpY3RlZCBieSBleHRlcm5hbCBlbnRpdHkgKGUuZy4gSU9NTVUpLgorICovCit1
bnNpZ25lZCBpbnQgX19yZWFkX21vc3RseSBwMm1faXBhX2JpdHMgPSA2NDsKIAogLyogSGVscGVy
cyB0byBsb29rdXAgdGhlIHByb3BlcnRpZXMgb2YgZWFjaCBsZXZlbCAqLwogc3RhdGljIGNvbnN0
IHBhZGRyX3QgbGV2ZWxfbWFza3NbXSA9CkBAIC0xOTI3LDYgKzE5MzEsMTYgQEAgc3RydWN0IHBh
Z2VfaW5mbyAqZ2V0X3BhZ2VfZnJvbV9ndmEoc3RydWN0IHZjcHUgKnYsIHZhZGRyX3QgdmEsCiAg
ICAgcmV0dXJuIHBhZ2U7CiB9CiAKK3ZvaWQgX19pbml0IHAybV9yZXN0cmljdF9pcGFfYml0cyh1
bnNpZ25lZCBpbnQgaXBhX2JpdHMpCit7CisgICAgLyoKKyAgICAgKiBDYWxjdWxhdGUgdGhlIG1p
bmltdW0gb2YgdGhlIG1heGltdW0gSVBBIGJpdHMgdGhhdCBhbnkgZXh0ZXJuYWwgZW50aXR5Cisg
ICAgICogY2FuIHN1cHBvcnQuCisgICAgICovCisgICAgaWYgKCBpcGFfYml0cyA8IHAybV9pcGFf
Yml0cyApCisgICAgICAgIHAybV9pcGFfYml0cyA9IGlwYV9iaXRzOworfQorCiAvKiBWVENSIHZh
bHVlIHRvIGJlIGNvbmZpZ3VyZWQgYnkgYWxsIENQVXMuIFNldCBvbmx5IG9uY2UgYnkgdGhlIGJv
b3QgQ1BVICovCiBzdGF0aWMgdWludDMyX3QgX19yZWFkX21vc3RseSB2dGNyOwogCkBAIC0xOTU4
LDYgKzE5NzIsMTAgQEAgdm9pZCBfX2luaXQgc2V0dXBfdmlydF9wYWdpbmcodm9pZCkKICAgICB1
bnNpZ25lZCBsb25nIHZhbCA9IFZUQ1JfUkVTMXxWVENSX1NIMF9JU3xWVENSX09SR04wX1dCV0F8
VlRDUl9JUkdOMF9XQldBOwogCiAjaWZkZWYgQ09ORklHX0FSTV8zMgorICAgIGlmICggcDJtX2lw
YV9iaXRzIDwgNDAgKQorICAgICAgICBwYW5pYygiUDJNOiBOb3QgYWJsZSB0byBzdXBwb3J0ICV1
LWJpdCBJUEEgYXQgdGhlIG1vbWVudFxuIiwKKyAgICAgICAgICAgICAgcDJtX2lwYV9iaXRzKTsK
KwogICAgIHByaW50aygiUDJNOiA0MC1iaXQgSVBBXG4iKTsKICAgICBwMm1faXBhX2JpdHMgPSA0
MDsKICAgICB2YWwgfD0gVlRDUl9UMFNaKDB4MTgpOyAvKiA0MCBiaXQgSVBBICovCkBAIC0xOTgx
LDE1ICsxOTk5LDIwIEBAIHZvaWQgX19pbml0IHNldHVwX3ZpcnRfcGFnaW5nKHZvaWQpCiAgICAg
ICAgIFs3XSA9IHsgMCB9ICAvKiBJbnZhbGlkICovCiAgICAgfTsKIAotICAgIHVuc2lnbmVkIGlu
dCBjcHU7CisgICAgdW5zaWduZWQgaW50IGksIGNwdTsKICAgICB1bnNpZ25lZCBpbnQgcGFfcmFu
Z2UgPSAweDEwOyAvKiBMYXJnZXIgdGhhbiBhbnkgcG9zc2libGUgdmFsdWUgKi8KICAgICBib29s
IHZtaWRfOF9iaXQgPSBmYWxzZTsKIAogICAgIGZvcl9lYWNoX29ubGluZV9jcHUgKCBjcHUgKQog
ICAgIHsKICAgICAgICAgY29uc3Qgc3RydWN0IGNwdWluZm9fYXJtICppbmZvID0gJmNwdV9kYXRh
W2NwdV07Ci0gICAgICAgIGlmICggaW5mby0+bW02NC5wYV9yYW5nZSA8IHBhX3JhbmdlICkKLSAg
ICAgICAgICAgIHBhX3JhbmdlID0gaW5mby0+bW02NC5wYV9yYW5nZTsKKworICAgICAgICAvKgor
ICAgICAgICAgKiBSZXN0cmljdCAicDJtX2lwYV9iaXRzIiBpZiBuZWVkZWQuIEFzIFAyTSB0YWJs
ZSBpcyBhbHdheXMgY29uZmlndXJlZAorICAgICAgICAgKiB3aXRoIElQQSBiaXRzID09IFBBIGJp
dHMsIGNvbXBhcmUgYWdhaW5zdCAicGFiaXRzIi4KKyAgICAgICAgICovCisgICAgICAgIGlmICgg
cGFfcmFuZ2VfaW5mb1tpbmZvLT5tbTY0LnBhX3JhbmdlXS5wYWJpdHMgPCBwMm1faXBhX2JpdHMg
KQorICAgICAgICAgICAgcDJtX2lwYV9iaXRzID0gcGFfcmFuZ2VfaW5mb1tpbmZvLT5tbTY0LnBh
X3JhbmdlXS5wYWJpdHM7CiAKICAgICAgICAgLyogU2V0IGEgZmxhZyBpZiB0aGUgY3VycmVudCBj
cHUgZG9lcyBub3Qgc3VwcG9ydCAxNiBiaXQgVk1JRHMuICovCiAgICAgICAgIGlmICggaW5mby0+
bW02NC52bWlkX2JpdHMgIT0gTU02NF9WTUlEXzE2X0JJVFNfU1VQUE9SVCApCkBAIC0yMDAzLDYg
KzIwMjYsMTYgQEAgdm9pZCBfX2luaXQgc2V0dXBfdmlydF9wYWdpbmcodm9pZCkKICAgICBpZiAo
ICF2bWlkXzhfYml0ICkKICAgICAgICAgbWF4X3ZtaWQgPSBNQVhfVk1JRF8xNl9CSVQ7CiAKKyAg
ICAvKiBDaG9vc2Ugc3VpdGFibGUgInBhX3JhbmdlIiBhY2NvcmRpbmcgdG8gdGhlIHJlc3VsdGVk
ICJwMm1faXBhX2JpdHMiLiAqLworICAgIGZvciAoIGkgPSAwOyBpIDwgQVJSQVlfU0laRShwYV9y
YW5nZV9pbmZvKTsgaSsrICkKKyAgICB7CisgICAgICAgIGlmICggcDJtX2lwYV9iaXRzID09IHBh
X3JhbmdlX2luZm9baV0ucGFiaXRzICkKKyAgICAgICAgeworICAgICAgICAgICAgcGFfcmFuZ2Ug
PSBpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyAgICB9CisKICAgICAvKiBwYV9y
YW5nZSBpcyA0IGJpdHMsIGJ1dCB0aGUgZGVmaW5lZCBlbmNvZGluZ3MgYXJlIG9ubHkgMyBiaXRz
ICovCiAgICAgaWYgKCBwYV9yYW5nZSA+PSBBUlJBWV9TSVpFKHBhX3JhbmdlX2luZm8pIHx8ICFw
YV9yYW5nZV9pbmZvW3BhX3JhbmdlXS5wYWJpdHMgKQogICAgICAgICBwYW5pYygiVW5rbm93biBl
bmNvZGluZyBvZiBJRF9BQTY0TU1GUjBfRUwxLlBBUmFuZ2UgJXhcbiIsIHBhX3JhbmdlKTsKZGlm
ZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9zZXR1cC5jIGIveGVuL2FyY2gvYXJtL3NldHVwLmMKaW5k
ZXggZmNhN2U2OC4uNzkwZWFiOSAxMDA2NDQKLS0tIGEveGVuL2FyY2gvYXJtL3NldHVwLmMKKysr
IGIveGVuL2FyY2gvYXJtL3NldHVwLmMKQEAgLTkyOCwxMiArOTI4LDE3IEBAIHZvaWQgX19pbml0
IHN0YXJ0X3hlbih1bnNpZ25lZCBsb25nIGJvb3RfcGh5c19vZmZzZXQsCiAgICAgcHJpbnRrKCJC
cm91Z2h0IHVwICVsZCBDUFVzXG4iLCAobG9uZyludW1fb25saW5lX2NwdXMoKSk7CiAgICAgLyog
VE9ETzogc21wX2NwdXNfZG9uZSgpOyAqLwogCi0gICAgc2V0dXBfdmlydF9wYWdpbmcoKTsKLQor
ICAgIC8qCisgICAgICogVGhlIElPTU1VIHN1YnN5c3RlbSBtdXN0IGJlIGluaXRpYWxpemVkIGJl
Zm9yZSBQMk0gYXMgd2UgbmVlZAorICAgICAqIHRvIGdhdGhlciByZXF1aXJlbWVudHMgcmVnYXJk
aW5nIHRoZSBtYXhpbXVtIElQQSBiaXRzIHN1cHBvcnRlZCBieQorICAgICAqIGVhY2ggSU9NTVUg
ZGV2aWNlLgorICAgICAqLwogICAgIHJjID0gaW9tbXVfc2V0dXAoKTsKICAgICBpZiAoICFpb21t
dV9lbmFibGVkICYmIHJjICE9IC1FTk9ERVYgKQogICAgICAgICBwYW5pYygiQ291bGRuJ3QgY29u
ZmlndXJlIGNvcnJlY3RseSBhbGwgdGhlIElPTU1Vcy5cbiIpOwogCisgICAgc2V0dXBfdmlydF9w
YWdpbmcoKTsKKwogICAgIGRvX2luaXRjYWxscygpOwogCiAgICAgLyoKZGlmZiAtLWdpdCBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FybS9pcG1tdS12bXNhLmMgYi94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9hcm0vaXBtbXUtdm1zYS5jCmluZGV4IGYyZmI0YTIuLjljZmFlN2UgMTAwNjQ0Ci0t
LSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FybS9pcG1tdS12bXNhLmMKKysrIGIveGVuL2Ry
aXZlcnMvcGFzc3Rocm91Z2gvYXJtL2lwbW11LXZtc2EuYwpAQCAtODQ0LDIyICs4NDQsOCBAQCBz
dGF0aWMgaW50IGlwbW11X3Byb2JlKHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqbm9kZSkKICAgICAg
ICAgICAgIGdvdG8gb3V0OwogICAgICAgICB9CiAKLSAgICAgICAgLyoKLSAgICAgICAgICogQXMg
NC1sZXZlbCB0cmFuc2xhdGlvbiB0YWJsZSBpcyBub3Qgc3VwcG9ydGVkIGluIElQTU1VLCB3ZSBu
ZWVkCi0gICAgICAgICAqIHRvIGNoZWNrIElQQSBzaXplIHVzZWQgZm9yIFAyTSB0YWJsZSBiZWZv
cmVoYW5kIHRvIGJlIHN1cmUgaXQgaXMKLSAgICAgICAgICogMy1sZXZlbCBhbmQgdGhlIElQTU1V
IHdpbGwgYmUgYWJsZSB0byB1c2UgaXQuCi0gICAgICAgICAqCi0gICAgICAgICAqIFRPRE86IEZp
cnN0IGluaXRpYWxpemUgdGhlIElPTU1VIGFuZCBnYXRoZXIgdGhlIHJlcXVpcmVtZW50cyBhbmQK
LSAgICAgICAgICogdGhlbiBpbml0aWFsaXplIHRoZSBQMk0uIEluIHRoZSBQMk0gY29kZSwgdGFr
ZSBpbnRvIHRoZSBhY2NvdW50Ci0gICAgICAgICAqIHRoZSBJT01NVSByZXF1aXJlbWVudHMgYW5k
IHJlc3RyaWN0ICJwYV9yYW5nZSIgaWYgbmVjZXNzYXJ5LgotICAgICAgICAgKi8KLSAgICAgICAg
aWYgKCBJUE1NVV9NQVhfUDJNX0lQQV9CSVRTIDwgcDJtX2lwYV9iaXRzICkKLSAgICAgICAgewot
ICAgICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgImlwbW11OiBQMk0gSVBBIHNpemUgaXMgbm90
IHN1cHBvcnRlZCAoUDJNPSV1IElQTU1VPSV1KSFcbiIsCi0gICAgICAgICAgICAgICAgICAgcDJt
X2lwYV9iaXRzLCBJUE1NVV9NQVhfUDJNX0lQQV9CSVRTKTsKLSAgICAgICAgICAgIHJldCA9IC1F
Tk9ERVY7Ci0gICAgICAgICAgICBnb3RvIG91dDsKLSAgICAgICAgfQorICAgICAgICAvKiBTZXQg
bWF4aW11bSBTdGFnZS0yIGlucHV0IHNpemUgc3VwcG9ydGVkIGJ5IHRoZSBJUE1NVS4gKi8KKyAg
ICAgICAgcDJtX3Jlc3RyaWN0X2lwYV9iaXRzKElQTU1VX01BWF9QMk1fSVBBX0JJVFMpOwogCiAg
ICAgICAgIGlycSA9IHBsYXRmb3JtX2dldF9pcnEobm9kZSwgMCk7CiAgICAgICAgIGlmICggaXJx
IDwgMCApCmRpZmYgLS1naXQgYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hcm0vc21tdS5jIGIv
eGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYXJtL3NtbXUuYwppbmRleCA4YWU5ODZhLi45NDY2MmE4
IDEwMDY0NAotLS0gYS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hcm0vc21tdS5jCisrKyBiL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FybS9zbW11LmMKQEAgLTExMTAsNyArMTExMCwxMSBAQCBz
dGF0aWMgdm9pZCBhcm1fc21tdV9pbml0X2NvbnRleHRfYmFuayhzdHJ1Y3QgYXJtX3NtbXVfZG9t
YWluICpzbW11X2RvbWFpbikKIAkJCXJlZyA9IFRUQkNSX1RHMF82NEs7CiAKIAkJaWYgKCFzdGFn
ZTEpIHsKLQkJCXJlZyB8PSAoNjQgLSBzbW11LT5zMl9pbnB1dF9zaXplKSA8PCBUVEJDUl9UMFNa
X1NISUZUOworCQkJLyoKKwkJCSAqIFhlbjogVGhlIElPTU1VIHNoYXJlIHRoZSBwYWdlLXRhYmxl
cyB3aXRoIHRoZSBQMk0KKwkJCSAqIHdoaWNoIG1heSBoYXZlIHJlc3RyaWN0IHRoZSBzaXplIGZ1
cnRoZXIuCisJCQkgKi8KKwkJCXJlZyB8PSAoNjQgLSBwMm1faXBhX2JpdHMpIDw8IFRUQkNSX1Qw
U1pfU0hJRlQ7CiAKIAkJCXN3aXRjaCAoc21tdS0+czJfb3V0cHV0X3NpemUpIHsKIAkJCWNhc2Ug
MzI6CkBAIC0yMTk4LDE0ICsyMjAyLDkgQEAgc3RhdGljIGludCBhcm1fc21tdV9kZXZpY2VfY2Zn
X3Byb2JlKHN0cnVjdCBhcm1fc21tdV9kZXZpY2UgKnNtbXUpCiAJc2l6ZSA9IGFybV9zbW11X2lk
X3NpemVfdG9fYml0cygoaWQgPj4gSUQyX0lBU19TSElGVCkgJiBJRDJfSUFTX01BU0spOwogCXNt
bXUtPnMxX291dHB1dF9zaXplID0gbWluX3QodW5zaWduZWQgbG9uZywgUEhZU19NQVNLX1NISUZU
LCBzaXplKTsKIAotCS8qIFhlbjogU3RhZ2UtMiBpbnB1dCBzaXplIGhhcyB0byBtYXRjaCBwMm1f
aXBhX2JpdHMuICAqLwotCWlmIChzaXplIDwgcDJtX2lwYV9iaXRzKSB7Ci0JCWRldl9lcnIoc21t
dS0+ZGV2LAotCQkJIlAyTSBJUEEgc2l6ZSBub3Qgc3VwcG9ydGVkIChQMk09JXUgU01NVT0lbHUp
IVxuIiwKLQkJCXAybV9pcGFfYml0cywgc2l6ZSk7Ci0JCXJldHVybiAtRU5PREVWOwotCX0KLQlz
bW11LT5zMl9pbnB1dF9zaXplID0gcDJtX2lwYV9iaXRzOworCS8qIFhlbjogU2V0IG1heGltdW0g
U3RhZ2UtMiBpbnB1dCBzaXplIHN1cHBvcnRlZCBieSB0aGUgU01NVS4gKi8KKwlwMm1fcmVzdHJp
Y3RfaXBhX2JpdHMoc2l6ZSk7CisJc21tdS0+czJfaW5wdXRfc2l6ZSA9IHNpemU7CiAjaWYgMAog
CS8qIFN0YWdlLTIgaW5wdXQgc2l6ZSBsaW1pdGVkIGR1ZSB0byBwZ2QgYWxsb2NhdGlvbiAoUFRS
U19QRVJfUEdEKSAqLwogI2lmZGVmIENPTkZJR182NEJJVApkaWZmIC0tZ2l0IGEveGVuL2luY2x1
ZGUvYXNtLWFybS9wMm0uaCBiL3hlbi9pbmNsdWRlL2FzbS1hcm0vcDJtLmgKaW5kZXggMDNmMmVl
Ny4uODlmODJkZiAxMDA2NDQKLS0tIGEveGVuL2luY2x1ZGUvYXNtLWFybS9wMm0uaAorKysgYi94
ZW4vaW5jbHVkZS9hc20tYXJtL3AybS5oCkBAIC0xNTksNiArMTU5LDE1IEBAIHZvaWQgcDJtX2Fs
dHAybV9jaGVjayhzdHJ1Y3QgdmNwdSAqdiwgdWludDE2X3QgaWR4KQogICAgIC8qIE5vdCBzdXBw
b3J0ZWQgb24gQVJNLiAqLwogfQogCisvKgorICogSGVscGVyIHRvIHJlc3RyaWN0ICJwMm1faXBh
X2JpdHMiIGFjY29yZGluZyB0aGUgZXh0ZXJuYWwgZW50aXR5CisgKiAoZS5nLiBJT01NVSkgcmVx
dWlyZW1lbnRzLgorICoKKyAqIEVhY2ggY29ycmVzcG9uZGluZyBkcml2ZXIgc2hvdWxkIHJlcG9y
dCB0aGUgbWF4aW11bSBJUEEgYml0cworICogKFN0YWdlLTIgaW5wdXQgc2l6ZSkgaXQgY2FuIHN1
cHBvcnQuCisgKi8KK3ZvaWQgcDJtX3Jlc3RyaWN0X2lwYV9iaXRzKHVuc2lnbmVkIGludCBpcGFf
Yml0cyk7CisKIC8qIFNlY29uZCBzdGFnZSBwYWdpbmcgc2V0dXAsIHRvIGJlIGNhbGxlZCBvbiBh
bGwgQ1BVcyAqLwogdm9pZCBzZXR1cF92aXJ0X3BhZ2luZyh2b2lkKTsKIAotLSAKMi43LjQKCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwg
bWFpbGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3Rz
LnhlbnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs

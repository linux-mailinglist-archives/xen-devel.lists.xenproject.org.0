Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E26CB2C47A
	for <lists+xen-devel@lfdr.de>; Tue, 28 May 2019 12:36:41 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hVZQ6-0004dS-Vf; Tue, 28 May 2019 10:33:26 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=31/0=T4=suse.com=jgross@srs-us1.protection.inumbo.net>)
 id 1hVZQ4-0004Zk-8k
 for xen-devel@lists.xenproject.org; Tue, 28 May 2019 10:33:24 +0000
X-Inumbo-ID: 016259ac-8134-11e9-920d-2f09432cb57d
Received: from mx1.suse.de (unknown [195.135.220.15])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 016259ac-8134-11e9-920d-2f09432cb57d;
 Tue, 28 May 2019 10:33:17 +0000 (UTC)
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id E8371AC66;
 Tue, 28 May 2019 10:33:16 +0000 (UTC)
From: Juergen Gross <jgross@suse.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 28 May 2019 12:32:17 +0200
Message-Id: <20190528103313.1343-5-jgross@suse.com>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20190528103313.1343-1-jgross@suse.com>
References: <20190528103313.1343-1-jgross@suse.com>
Subject: [Xen-devel] [PATCH 04/60] xen/sched: use new sched_unit instead of
 vcpu in scheduler interfaces
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Juergen Gross <jgross@suse.com>, Tim Deegan <tim@xen.org>,
 Stefano Stabellini <sstabellini@kernel.org>, Wei Liu <wl@xen.org>,
 Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>,
 George Dunlap <george.dunlap@eu.citrix.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>,
 Robert VanVossen <robert.vanvossen@dornerworks.com>,
 Dario Faggioli <dfaggioli@suse.com>, Julien Grall <julien.grall@arm.com>,
 Josh Whitehead <josh.whitehead@dornerworks.com>,
 Meng Xu <mengxu@cis.upenn.edu>, Jan Beulich <jbeulich@suse.com>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

SW4gb3JkZXIgdG8gcHJlcGFyZSBjb3JlLSBhbmQgc29ja2V0LXNjaGVkdWxpbmcgdXNlIGEgbmV3
IHN0cnVjdApzY2hlZF91bml0IGluc3RlYWQgb2Ygc3RydWN0IHZjcHUgZm9yIGludGVyZmFjZXMg
b2YgdGhlIGRpZmZlcmVudApzY2hlZHVsZXJzLgoKUmVuYW1lIHRoZSBwZXItc2NoZWR1bGVyIGZ1
bmN0aW9ucyBpbnNlcnRfdmNwdSBhbmQgcmVtb3ZlX3ZjcHUgdG8KaW5zZXJ0X3VuaXQgYW5kIHJl
bW92ZV91bml0IHRvIHJlZmxlY3QgdGhlIGNoYW5nZSBvZiB0aGUgcGFyYW1ldGVyLgpJbiB0aGUg
c2NoZWR1bGVycyByZW5hbWUgbG9jYWwgZnVuY3Rpb25zIHN3aXRjaGVkIHRvIHNjaGVkX3VuaXQs
IHRvby4KCkZvciBub3cgdGhpcyBuZXcgc3RydWN0IHdpbGwgY29udGFpbiBhIHZjcHUgcG9pbnRl
ciBvbmx5IGFuZCBpcwphbGxvY2F0ZWQgb24gdGhlIHN0YWNrLiBUaGlzIHdpbGwgYmUgY2hhbmdl
ZCBsYXRlci4KClNpZ25lZC1vZmYtYnk6IEp1ZXJnZW4gR3Jvc3MgPGpncm9zc0BzdXNlLmNvbT4K
LS0tClJGQyBWMjoKLSBtb3ZlIGRlZmluaXRpb24gb2Ygc3RydWN0IHNjaGVkX3VuaXQgdG8gc2No
ZWQuaCAoQW5kcmV3IENvb3BlcikKVjE6Ci0gcmVuYW1lICJpdGVtIiB0byAidW5pdCIgKEdlb3Jn
ZSBEdW5sYXApCi0tLQogeGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jIHwgMzAgKysrKysrKysr
LS0tLS0tCiB4ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jICAgfCA0MSArKysrKysrKysrKystLS0t
LS0tLQogeGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQyLmMgIHwgNTcgKysrKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9udWxsLmMgICAgIHwgMzkgKysrKysrKysrKysr
LS0tLS0tLQogeGVuL2NvbW1vbi9zY2hlZF9ydC5jICAgICAgIHwgMzMgKysrKysrKysrLS0tLS0t
LQogeGVuL2NvbW1vbi9zY2hlZHVsZS5jICAgICAgIHwgNTMgKysrKysrKysrKysrKysrKysrLS0t
LS0tLS0KIHhlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oICB8IDkyICsrKysrKysrKysrKysrKysr
KysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLQogeGVuL2luY2x1ZGUveGVuL3NjaGVkLmggICAg
IHwgIDQgKysKIDggZmlsZXMgY2hhbmdlZCwgMjE4IGluc2VydGlvbnMoKyksIDEzMSBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVkX2FyaW5jNjUzLmMgYi94ZW4vY29t
bW9uL3NjaGVkX2FyaW5jNjUzLmMKaW5kZXggNzJiOTg4ZWE1Zi4uMjgzNzMwYjNmOCAxMDA2NDQK
LS0tIGEveGVuL2NvbW1vbi9zY2hlZF9hcmluYzY1My5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRf
YXJpbmM2NTMuYwpAQCAtMzc2LDEzICszNzYsMTYgQEAgYTY1M3NjaGVkX2RlaW5pdChzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMpCiAgKiBUaGlzIGZ1bmN0aW9uIGFsbG9jYXRlcyBzY2hlZHVsZXItc3Bl
Y2lmaWMgZGF0YSBmb3IgYSBWQ1BVCiAgKgogICogQHBhcmFtIG9wcyAgICAgICBQb2ludGVyIHRv
IHRoaXMgaW5zdGFuY2Ugb2YgdGhlIHNjaGVkdWxlciBzdHJ1Y3R1cmUKKyAqIEBwYXJhbSB1bml0
ICAgICAgUG9pbnRlciB0byBzdHJ1Y3Qgc2NoZWRfdW5pdAogICoKICAqIEByZXR1cm4gICAgICAg
ICAgUG9pbnRlciB0byB0aGUgYWxsb2NhdGVkIGRhdGEKICAqLwogc3RhdGljIHZvaWQgKgotYTY1
M3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnZjLCB2b2lkICpkZCkKK2E2NTNzY2hlZF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAorICAgICAgICAgICAgICAgICAg
ICAgIHZvaWQgKmRkKQogewogICAgIGE2NTNzY2hlZF9wcml2X3QgKnNjaGVkX3ByaXYgPSBTQ0hF
RF9QUklWKG9wcyk7CisgICAgc3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBhcmlu
YzY1M192Y3B1X3QgKnN2YzsKICAgICB1bnNpZ25lZCBpbnQgZW50cnk7CiAgICAgdW5zaWduZWQg
bG9uZyBmbGFnczsKQEAgLTQ1OCwxMSArNDYxLDEzIEBAIGE2NTNzY2hlZF9mcmVlX3ZkYXRhKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgdm9pZCAqcHJpdikKICAqIFhlbiBzY2hlZHVsZXIg
Y2FsbGJhY2sgZnVuY3Rpb24gdG8gc2xlZXAgYSBWQ1BVCiAgKgogICogQHBhcmFtIG9wcyAgICAg
ICBQb2ludGVyIHRvIHRoaXMgaW5zdGFuY2Ugb2YgdGhlIHNjaGVkdWxlciBzdHJ1Y3R1cmUKLSAq
IEBwYXJhbSB2YyAgICAgICAgUG9pbnRlciB0byB0aGUgVkNQVSBzdHJ1Y3R1cmUgZm9yIHRoZSBj
dXJyZW50IGRvbWFpbgorICogQHBhcmFtIHVuaXQgICAgICBQb2ludGVyIHRvIHN0cnVjdCBzY2hl
ZF91bml0CiAgKi8KIHN0YXRpYyB2b2lkCi1hNjUzc2NoZWRfdmNwdV9zbGVlcChjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2E2NTNzY2hlZF91bml0X3NsZWVw
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7
CisgICAgc3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKKwogICAgIGlmICggQVZDUFUodmMp
ICE9IE5VTEwgKQogICAgICAgICBBVkNQVSh2YyktPmF3YWtlID0gMDsKIApAQCAtNDc4LDExICs0
ODMsMTMgQEAgYTY1M3NjaGVkX3ZjcHVfc2xlZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3Bz
LCBzdHJ1Y3QgdmNwdSAqdmMpCiAgKiBYZW4gc2NoZWR1bGVyIGNhbGxiYWNrIGZ1bmN0aW9uIHRv
IHdha2UgdXAgYSBWQ1BVCiAgKgogICogQHBhcmFtIG9wcyAgICAgICBQb2ludGVyIHRvIHRoaXMg
aW5zdGFuY2Ugb2YgdGhlIHNjaGVkdWxlciBzdHJ1Y3R1cmUKLSAqIEBwYXJhbSB2YyAgICAgICAg
UG9pbnRlciB0byB0aGUgVkNQVSBzdHJ1Y3R1cmUgZm9yIHRoZSBjdXJyZW50IGRvbWFpbgorICog
QHBhcmFtIHVuaXQgICAgICBQb2ludGVyIHRvIHN0cnVjdCBzY2hlZF91bml0CiAgKi8KIHN0YXRp
YyB2b2lkCi1hNjUzc2NoZWRfdmNwdV93YWtlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHZjcHUgKnZjKQorYTY1M3NjaGVkX3VuaXRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2
YyA9IHVuaXQtPnZjcHU7CisKICAgICBpZiAoIEFWQ1BVKHZjKSAhPSBOVUxMICkKICAgICAgICAg
QVZDUFUodmMpLT5hd2FrZSA9IDE7CiAKQEAgLTU5NywxMyArNjA0LDE0IEBAIGE2NTNzY2hlZF9k
b19zY2hlZHVsZSgKICAqIFhlbiBzY2hlZHVsZXIgY2FsbGJhY2sgZnVuY3Rpb24gdG8gc2VsZWN0
IGEgQ1BVIGZvciB0aGUgVkNQVSB0byBydW4gb24KICAqCiAgKiBAcGFyYW0gb3BzICAgICAgIFBv
aW50ZXIgdG8gdGhpcyBpbnN0YW5jZSBvZiB0aGUgc2NoZWR1bGVyIHN0cnVjdHVyZQotICogQHBh
cmFtIHYgICAgICAgICBQb2ludGVyIHRvIHRoZSBWQ1BVIHN0cnVjdHVyZSBmb3IgdGhlIGN1cnJl
bnQgZG9tYWluCisgKiBAcGFyYW0gdW5pdCAgICAgIFBvaW50ZXIgdG8gc3RydWN0IHNjaGVkX3Vu
aXQKICAqCiAgKiBAcmV0dXJuICAgICAgICAgIE51bWJlciBvZiBzZWxlY3RlZCBwaHlzaWNhbCBD
UFUKICAqLwogc3RhdGljIGludAotYTY1M3NjaGVkX3BpY2tfY3B1KGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorYTY1M3NjaGVkX3BpY2tfY3B1KGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAgc3Ry
dWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBjcHVtYXNrX3QgKm9ubGluZTsKICAgICB1
bnNpZ25lZCBpbnQgY3B1OwogCkBAIC03MDIsMTEgKzcxMCwxMSBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciBzY2hlZF9hcmluYzY1M19kZWYgPSB7CiAgICAgLmZyZWVfdmRhdGEgICAg
ID0gYTY1M3NjaGVkX2ZyZWVfdmRhdGEsCiAgICAgLmFsbG9jX3ZkYXRhICAgID0gYTY1M3NjaGVk
X2FsbG9jX3ZkYXRhLAogCi0gICAgLmluc2VydF92Y3B1ICAgID0gTlVMTCwKLSAgICAucmVtb3Zl
X3ZjcHUgICAgPSBOVUxMLAorICAgIC5pbnNlcnRfdW5pdCAgICA9IE5VTEwsCisgICAgLnJlbW92
ZV91bml0ICAgID0gTlVMTCwKIAotICAgIC5zbGVlcCAgICAgICAgICA9IGE2NTNzY2hlZF92Y3B1
X3NsZWVwLAotICAgIC53YWtlICAgICAgICAgICA9IGE2NTNzY2hlZF92Y3B1X3dha2UsCisgICAg
LnNsZWVwICAgICAgICAgID0gYTY1M3NjaGVkX3VuaXRfc2xlZXAsCisgICAgLndha2UgICAgICAg
ICAgID0gYTY1M3NjaGVkX3VuaXRfd2FrZSwKICAgICAueWllbGQgICAgICAgICAgPSBOVUxMLAog
ICAgIC5jb250ZXh0X3NhdmVkICA9IE5VTEwsCiAKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2No
ZWRfY3JlZGl0LmMgYi94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdC5jCmluZGV4IDYyMWM0MDhlZDAu
LmViYTRkYjM4YmIgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0LmMKKysrIGIv
eGVuL2NvbW1vbi9zY2hlZF9jcmVkaXQuYwpAQCAtODU5LDE1ICs4NTksMTYgQEAgX2NzY2hlZF9j
cHVfcGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YywgYm9v
bF90IGNvbW1pdCkKIH0KIAogc3RhdGljIGludAotY3NjaGVkX2NwdV9waWNrKGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorY3NjaGVkX2NwdV9waWNrKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAg
c3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKnN2
YyA9IENTQ0hFRF9WQ1BVKHZjKTsKIAogICAgIC8qCiAgICAgICogV2UgaGF2ZSBiZWVuIGNhbGxl
ZCBieSB2Y3B1X21pZ3JhdGUoKSAoaW4gc2NoZWR1bGUuYyksIGFzIHBhcnQKICAgICAgKiBvZiB0
aGUgcHJvY2VzcyBvZiBzZWVpbmcgaWYgdmMgY2FuIGJlIG1pZ3JhdGVkIHRvIGFub3RoZXIgcGNw
dS4KICAgICAgKiBXZSBtYWtlIGEgbm90ZSBhYm91dCB0aGlzIGluIHN2Yy0+ZmxhZ3Mgc28gdGhh
dCBsYXRlciwgaW4KLSAgICAgKiBjc2NoZWRfdmNwdV93YWtlKCkgKHN0aWxsIGNhbGxlZCBmcm9t
IHZjcHVfbWlncmF0ZSgpKSB3ZSB3b24ndAorICAgICAqIGNzY2hlZF91bml0X3dha2UoKSAoc3Rp
bGwgY2FsbGVkIGZyb20gdmNwdV9taWdyYXRlKCkpIHdlIHdvbid0CiAgICAgICogZ2V0IGJvb3N0
ZWQsIHdoaWNoIHdlIGRvbid0IGRlc2VydmUgYXMgd2UgYXJlICJvbmx5IiBtaWdyYXRpbmcuCiAg
ICAgICovCiAgICAgc2V0X2JpdChDU0NIRURfRkxBR19WQ1BVX01JR1JBVElORywgJnN2Yy0+Zmxh
Z3MpOwpAQCAtOTk1LDggKzk5NiwxMCBAQCBjc2NoZWRfdmNwdV9hY2N0KHN0cnVjdCBjc2NoZWRf
cHJpdmF0ZSAqcHJ2LCB1bnNpZ25lZCBpbnQgY3B1KQogfQogCiBzdGF0aWMgdm9pZCAqCi1jc2No
ZWRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAq
dmMsIHZvaWQgKmRkKQorY3NjaGVkX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
Km9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQsCisgICAgICAgICAgICAgICAgICAgdm9pZCAq
ZGQpCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBzdHJ1Y3QgY3Nj
aGVkX3ZjcHUgKnN2YzsKIAogICAgIC8qIEFsbG9jYXRlIHBlci1WQ1BVIGluZm8gKi8KQEAgLTEw
MTYsOCArMTAxOSw5IEBAIGNzY2hlZF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2Yywgdm9pZCAqZGQpCiB9CiAKIHN0YXRpYyB2b2lkCi1jc2No
ZWRfdmNwdV9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAq
dmMpCitjc2NoZWRfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1
Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1
OwogICAgIHN0cnVjdCBjc2NoZWRfdmNwdSAqc3ZjID0gdmMtPnNjaGVkX3ByaXY7CiAgICAgc3Bp
bmxvY2tfdCAqbG9jazsKIApAQCAtMTAyNiw3ICsxMDMwLDcgQEAgY3NjaGVkX3ZjcHVfaW5zZXJ0
KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQogICAgIC8qIGNz
Y2hlZF9jcHVfcGljaygpIGxvb2tzIGluIHZjLT5wcm9jZXNzb3IncyBydW5xLCBzbyB3ZSBuZWVk
IHRoZSBsb2NrLiAqLwogICAgIGxvY2sgPSB2Y3B1X3NjaGVkdWxlX2xvY2tfaXJxKHZjKTsKIAot
ICAgIHZjLT5wcm9jZXNzb3IgPSBjc2NoZWRfY3B1X3BpY2sob3BzLCB2Yyk7CisgICAgdmMtPnBy
b2Nlc3NvciA9IGNzY2hlZF9jcHVfcGljayhvcHMsIHVuaXQpOwogCiAgICAgc3Bpbl91bmxvY2tf
aXJxKGxvY2spOwogCkBAIC0xMDUxLDkgKzEwNTUsMTAgQEAgY3NjaGVkX2ZyZWVfdmRhdGEoY29u
c3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpwcml2KQogfQogCiBzdGF0aWMgdm9pZAot
Y3NjaGVkX3ZjcHVfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnZjKQorY3NjaGVkX3VuaXRfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywg
c3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAgc3RydWN0IGNzY2hlZF9wcml2YXRlICpw
cnYgPSBDU0NIRURfUFJJVihvcHMpOworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7
CiAgICAgc3RydWN0IGNzY2hlZF92Y3B1ICogY29uc3Qgc3ZjID0gQ1NDSEVEX1ZDUFUodmMpOwog
ICAgIHN0cnVjdCBjc2NoZWRfZG9tICogY29uc3Qgc2RvbSA9IHN2Yy0+c2RvbTsKIApAQCAtMTA3
OCw4ICsxMDgzLDkgQEAgY3NjaGVkX3ZjcHVfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
Km9wcywgc3RydWN0IHZjcHUgKnZjKQogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVkX3ZjcHVfc2xl
ZXAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWRf
dW5pdF9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0
ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7CiAgICAgc3RydWN0
IGNzY2hlZF92Y3B1ICogY29uc3Qgc3ZjID0gQ1NDSEVEX1ZDUFUodmMpOwogICAgIHVuc2lnbmVk
IGludCBjcHUgPSB2Yy0+cHJvY2Vzc29yOwogCkBAIC0xMTAyLDggKzExMDgsOSBAQCBjc2NoZWRf
dmNwdV9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykK
IH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2NoZWRfdW5pdF93YWtlKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAgc3RydWN0IHZj
cHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBzdHJ1Y3QgY3NjaGVkX3ZjcHUgKiBjb25zdCBzdmMg
PSBDU0NIRURfVkNQVSh2Yyk7CiAgICAgYm9vbF90IG1pZ3JhdGluZzsKIApAQCAtMTE2Myw4ICsx
MTcwLDkgQEAgY3NjaGVkX3ZjcHVfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCB2Y3B1ICp2YykKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZF92Y3B1X3lpZWxkKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorY3NjaGVkX3VuaXRfeWll
bGQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkK
IHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWRf
dmNwdSAqIGNvbnN0IHN2YyA9IENTQ0hFRF9WQ1BVKHZjKTsKIAogICAgIC8qIExldCB0aGUgc2No
ZWR1bGVyIGtub3cgdGhhdCB0aGlzIHZjcHUgaXMgdHJ5aW5nIHRvIHlpZWxkICovCkBAIC0xMjE3
LDkgKzEyMjUsMTAgQEAgY3NjaGVkX2RvbV9jbnRsKAogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVk
X2FmZl9jbnRsKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYsCitj
c2NoZWRfYWZmX2NudGwoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRf
dW5pdCAqdW5pdCwKICAgICAgICAgICAgICAgICBjb25zdCBjcHVtYXNrX3QgKmhhcmQsIGNvbnN0
IGNwdW1hc2tfdCAqc29mdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IHVuaXQtPnZjcHU7CiAg
ICAgc3RydWN0IGNzY2hlZF92Y3B1ICpzdmMgPSBDU0NIRURfVkNQVSh2KTsKIAogICAgIGlmICgg
IWhhcmQgKQpAQCAtMTc0OCw3ICsxNzU3LDcgQEAgY3NjaGVkX2xvYWRfYmFsYW5jZShzdHJ1Y3Qg
Y3NjaGVkX3ByaXZhdGUgKnBydiwgaW50IGNwdSwKICAgICAgICAgICAgICAgICAgKiAtIGlmIHdl
IHJhY2Ugd2l0aCBpbmNfbnJfcnVubmFibGUoKSwgd2Ugc2tpcCBhIHBDUFUgdGhhdCBtYXkKICAg
ICAgICAgICAgICAgICAgKiAgIGhhdmUgcnVubmFibGUgdkNQVXMgaW4gaXRzIHJ1bnF1ZXVlLCBi
dXQgdGhhdCdzIG5vdCBhCiAgICAgICAgICAgICAgICAgICogICBwcm9ibGVtIGJlY2F1c2U6Ci0g
ICAgICAgICAgICAgICAgICogICArIGlmIHJhY2luZyB3aXRoIGNzY2hlZF92Y3B1X2luc2VydCgp
IG9yIGNzY2hlZF92Y3B1X3dha2UoKSwKKyAgICAgICAgICAgICAgICAgKiAgICsgaWYgcmFjaW5n
IHdpdGggY3NjaGVkX3VuaXRfaW5zZXJ0KCkgb3IgY3NjaGVkX3VuaXRfd2FrZSgpLAogICAgICAg
ICAgICAgICAgICAqICAgICBfX3J1bnFfdGlja2xlKCkgd2lsbCBiZSBjYWxsZWQgYWZ0ZXJ3b3Jk
cywgc28gdGhlIHZDUFUKICAgICAgICAgICAgICAgICAgKiAgICAgd29uJ3QgZ2V0IHN0dWNrIGlu
IHRoZSBydW5xdWV1ZSBmb3IgdG9vIGxvbmc7CiAgICAgICAgICAgICAgICAgICogICArIGlmIHJh
Y2luZyB3aXRoIGNzY2hlZF9ydW5xX3N0ZWFsKCksIGl0IG1heSBiZSB0aGF0IGEKQEAgLTIyNjAs
MTIgKzIyNjksMTIgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgc2NoZWRfY3JlZGl0
X2RlZiA9IHsKIAogICAgIC5nbG9iYWxfaW5pdCAgICA9IGNzY2hlZF9nbG9iYWxfaW5pdCwKIAot
ICAgIC5pbnNlcnRfdmNwdSAgICA9IGNzY2hlZF92Y3B1X2luc2VydCwKLSAgICAucmVtb3ZlX3Zj
cHUgICAgPSBjc2NoZWRfdmNwdV9yZW1vdmUsCisgICAgLmluc2VydF91bml0ICAgID0gY3NjaGVk
X3VuaXRfaW5zZXJ0LAorICAgIC5yZW1vdmVfdW5pdCAgICA9IGNzY2hlZF91bml0X3JlbW92ZSwK
IAotICAgIC5zbGVlcCAgICAgICAgICA9IGNzY2hlZF92Y3B1X3NsZWVwLAotICAgIC53YWtlICAg
ICAgICAgICA9IGNzY2hlZF92Y3B1X3dha2UsCi0gICAgLnlpZWxkICAgICAgICAgID0gY3NjaGVk
X3ZjcHVfeWllbGQsCisgICAgLnNsZWVwICAgICAgICAgID0gY3NjaGVkX3VuaXRfc2xlZXAsCisg
ICAgLndha2UgICAgICAgICAgID0gY3NjaGVkX3VuaXRfd2FrZSwKKyAgICAueWllbGQgICAgICAg
ICAgPSBjc2NoZWRfdW5pdF95aWVsZCwKIAogICAgIC5hZGp1c3QgICAgICAgICA9IGNzY2hlZF9k
b21fY250bCwKICAgICAuYWRqdXN0X2FmZmluaXR5PSBjc2NoZWRfYWZmX2NudGwsCmRpZmYgLS1n
aXQgYS94ZW4vY29tbW9uL3NjaGVkX2NyZWRpdDIuYyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0
Mi5jCmluZGV4IDhlNDM4MWQ4YTcuLmRlZjhkODc0ODQgMTAwNjQ0Ci0tLSBhL3hlbi9jb21tb24v
c2NoZWRfY3JlZGl0Mi5jCisrKyBiL3hlbi9jb21tb24vc2NoZWRfY3JlZGl0Mi5jCkBAIC0yNzMs
NyArMjczLDcgQEAKICAqIENTRkxBR19kZWxheWVkX3J1bnFfYWRkOiBEbyB3ZSBuZWVkIHRvIGFk
ZCB0aGlzIHRvIHRoZSBydW5xdWV1ZSBvbmNlIGl0J2QgZG9uZQogICogYmVpbmcgY29udGV4dCBz
d2l0Y2hlZCBvdXQ/CiAgKiArIFNldCB3aGVuIHNjaGVkdWxpbmcgb3V0IGluIGNzY2hlZDJfc2No
ZWR1bGUoKSBpZiBwcmV2IGlzIHJ1bm5hYmxlCi0gKiArIFNldCBpbiBjc2NoZWQyX3ZjcHVfd2Fr
ZSBpZiBpdCBmaW5kcyBDU0ZMQUdfc2NoZWR1bGVkIHNldAorICogKyBTZXQgaW4gY3NjaGVkMl91
bml0X3dha2UgaWYgaXQgZmluZHMgQ1NGTEFHX3NjaGVkdWxlZCBzZXQKICAqICsgUmVhZCBpbiBj
c2NoZWQyX2NvbnRleHRfc2F2ZWQoKS4gIElmIHNldCwgaXQgYWRkcyBwcmV2IHRvIHRoZSBydW5x
dWV1ZSBhbmQKICAqICAgY2xlYXJzIHRoZSBiaXQuCiAgKi8KQEAgLTYyMywxNCArNjIzLDE0IEBA
IHN0YXRpYyBpbmxpbmUgYm9vbCBoYXNfY2FwKGNvbnN0IHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2
YykKICAqIFRoaXMgbG9naWMgaXMgZW50aXJlbHkgaW1wbGVtZW50ZWQgaW4gcnVucV90aWNrbGUo
KSwgYW5kIHRoYXQgaXMgZW5vdWdoLgogICogSW4gZmFjdCwgaW4gdGhpcyBzY2hlZHVsZXIsIHBs
YWNlbWVudCBvZiBhIHZjcHUgb24gb25lIG9mIHRoZSBwY3B1cyBvZiBhCiAgKiBydW5xLCBfYWx3
YXlzXyBoYXBwZW5zIGJ5IG1lYW5zIG9mIHRpY2tsaW5nOgotICogIC0gd2hlbiBhIHZjcHUgd2Fr
ZXMgdXAsIGl0IGNhbGxzIGNzY2hlZDJfdmNwdV93YWtlKCksIHdoaWNoIGNhbGxzCisgKiAgLSB3
aGVuIGEgdmNwdSB3YWtlcyB1cCwgaXQgY2FsbHMgY3NjaGVkMl91bml0X3dha2UoKSwgd2hpY2gg
Y2FsbHMKICAqICAgIHJ1bnFfdGlja2xlKCk7CiAgKiAgLSB3aGVuIGEgbWlncmF0aW9uIGlzIGlu
aXRpYXRlZCBpbiBzY2hlZHVsZS5jLCB3ZSBjYWxsIGNzY2hlZDJfY3B1X3BpY2soKSwKLSAqICAg
IGNzY2hlZDJfdmNwdV9taWdyYXRlKCkgKHdoaWNoIGNhbGxzIG1pZ3JhdGUoKSkgYW5kIGNzY2hl
ZDJfdmNwdV93YWtlKCkuCisgKiAgICBjc2NoZWQyX3VuaXRfbWlncmF0ZSgpICh3aGljaCBjYWxs
cyBtaWdyYXRlKCkpIGFuZCBjc2NoZWQyX3VuaXRfd2FrZSgpLgogICogICAgY3NjaGVkMl9jcHVf
cGljaygpIGxvb2tzIGZvciB0aGUgbGVhc3QgbG9hZGVkIHJ1bnEgYW5kIHJldHVybiBqdXN0IGFu
eQotICogICAgb2YgaXRzIHByb2Nlc3NvcnMuIFRoZW4sIGNzY2hlZDJfdmNwdV9taWdyYXRlKCkg
anVzdCBtb3ZlcyB0aGUgdmNwdSB0bworICogICAgb2YgaXRzIHByb2Nlc3NvcnMuIFRoZW4sIGNz
Y2hlZDJfdW5pdF9taWdyYXRlKCkganVzdCBtb3ZlcyB0aGUgdmNwdSB0bwogICogICAgdGhlIGNo
b3NlbiBydW5xLCBhbmQgaXQgaXMgYWdhaW4gcnVucV90aWNrbGUoKSwgY2FsbGVkIGJ5Ci0gKiAg
ICBjc2NoZWQyX3ZjcHVfd2FrZSgpIHRoYXQgYWN0dWFsbHkgZGVjaWRlcyB3aGF0IHBjcHUgdG8g
dXNlIHdpdGhpbiB0aGUKKyAqICAgIGNzY2hlZDJfdW5pdF93YWtlKCkgdGhhdCBhY3R1YWxseSBk
ZWNpZGVzIHdoYXQgcGNwdSB0byB1c2Ugd2l0aGluIHRoZQogICogICAgY2hvc2VuIHJ1bnE7CiAg
KiAgLSB3aGVuIGEgbWlncmF0aW9uIGlzIGluaXRpYXRlZCBpbiBzY2hlZF9jcmVkaXQyLmMsIGJ5
IGNhbGxpbmcgIG1pZ3JhdGUoKQogICogICAgZGlyZWN0bHksIHRoYXQgYWdhaW4gdGVtcG9yYXJp
bHkgdXNlIGEgcmFuZG9tIHBjcHUgZnJvbSB0aGUgbmV3IHJ1bnEsCkBAIC0yMDI2LDggKzIwMjYs
MTAgQEAgY3NjaGVkMl92Y3B1X2NoZWNrKHN0cnVjdCB2Y3B1ICp2YykKICNlbmRpZgogCiBzdGF0
aWMgdm9pZCAqCi1jc2NoZWQyX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9w
cywgc3RydWN0IHZjcHUgKnZjLCB2b2lkICpkZCkKK2NzY2hlZDJfYWxsb2NfdmRhdGEoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCwKKyAgICAgICAg
ICAgICAgICAgICAgdm9pZCAqZGQpCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNw
dTsKICAgICBzdHJ1Y3QgY3NjaGVkMl92Y3B1ICpzdmM7CiAKICAgICAvKiBBbGxvY2F0ZSBwZXIt
VkNQVSBpbmZvICovCkBAIC0yMDY5LDggKzIwNzEsOSBAQCBjc2NoZWQyX2FsbG9jX3ZkYXRhKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjLCB2b2lkICpkZCkKIH0K
IAogc3RhdGljIHZvaWQKLWNzY2hlZDJfdmNwdV9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK2NzY2hlZDJfdW5pdF9zbGVlcChjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2
Y3B1ICp2YyA9IHVuaXQtPnZjcHU7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2
YyA9IGNzY2hlZDJfdmNwdSh2Yyk7CiAKICAgICBBU1NFUlQoIWlzX2lkbGVfdmNwdSh2YykpOwpA
QCAtMjA5MSw4ICsyMDk0LDkgQEAgY3NjaGVkMl92Y3B1X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQogfQogCiBzdGF0aWMgdm9pZAotY3NjaGVkMl92
Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitj
c2NoZWQyX3VuaXRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hl
ZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7CiAgICAg
c3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNzY2hlZDJfdmNwdSh2Yyk7CiAgICAg
dW5zaWduZWQgaW50IGNwdSA9IHZjLT5wcm9jZXNzb3I7CiAgICAgc190aW1lX3Qgbm93OwpAQCAt
MjE0NiwxNiArMjE1MCwxOCBAQCBvdXQ6CiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWQyX3ZjcHVf
eWllbGQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdikKK2NzY2hl
ZDJfdW5pdF95aWVsZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91
bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2ID0gdW5pdC0+dmNwdTsKICAgICBzdHJ1
Y3QgY3NjaGVkMl92Y3B1ICogY29uc3Qgc3ZjID0gY3NjaGVkMl92Y3B1KHYpOwogCiAgICAgX19z
ZXRfYml0KF9fQ1NGTEFHX3ZjcHVfeWllbGQsICZzdmMtPmZsYWdzKTsKIH0KIAogc3RhdGljIHZv
aWQKLWNzY2hlZDJfY29udGV4dF9zYXZlZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCB2Y3B1ICp2YykKK2NzY2hlZDJfY29udGV4dF9zYXZlZChjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2
YyA9IHVuaXQtPnZjcHU7CiAgICAgc3RydWN0IGNzY2hlZDJfdmNwdSAqIGNvbnN0IHN2YyA9IGNz
Y2hlZDJfdmNwdSh2Yyk7CiAgICAgc3BpbmxvY2tfdCAqbG9jayA9IHZjcHVfc2NoZWR1bGVfbG9j
a19pcnEodmMpOwogICAgIHNfdGltZV90IG5vdyA9IE5PVygpOwpAQCAtMjE5Niw5ICsyMjAyLDEw
IEBAIGNzY2hlZDJfY29udGV4dF9zYXZlZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0
cnVjdCB2Y3B1ICp2YykKIAogI2RlZmluZSBNQVhfTE9BRCAoU1RJTUVfTUFYKQogc3RhdGljIGlu
dAotY3NjaGVkMl9jcHVfcGljayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2
Y3B1ICp2YykKK2NzY2hlZDJfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBz
dHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKICAgICBzdHJ1Y3QgY3NjaGVkMl9wcml2YXRlICpw
cnYgPSBjc2NoZWQyX3ByaXYob3BzKTsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1
OwogICAgIGludCBpLCBtaW5fcnFpID0gLTEsIG1pbl9zX3JxaSA9IC0xOwogICAgIHVuc2lnbmVk
IGludCBuZXdfY3B1LCBjcHUgPSB2Yy0+cHJvY2Vzc29yOwogICAgIHN0cnVjdCBjc2NoZWQyX3Zj
cHUgKnN2YyA9IGNzY2hlZDJfdmNwdSh2Yyk7CkBAIC0yNzMzLDkgKzI3NDAsMTAgQEAgcmV0cnk6
CiB9CiAKIHN0YXRpYyB2b2lkCi1jc2NoZWQyX3ZjcHVfbWlncmF0ZSgKLSAgICBjb25zdCBzdHJ1
Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YywgdW5zaWduZWQgaW50IG5ld19jcHUp
Citjc2NoZWQyX3VuaXRfbWlncmF0ZSgKKyAgICBjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMs
IHN0cnVjdCBzY2hlZF91bml0ICp1bml0LCB1bnNpZ25lZCBpbnQgbmV3X2NwdSkKIHsKKyAgICBz
dHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1OwogICAgIHN0cnVjdCBkb21haW4gKmQgPSB2Yy0+
ZG9tYWluOwogICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKiBjb25zdCBzdmMgPSBjc2NoZWQyX3Zj
cHUodmMpOwogICAgIHN0cnVjdCBjc2NoZWQyX3J1bnF1ZXVlX2RhdGEgKnRycWQ7CkBAIC0yOTk2
LDkgKzMwMDQsMTAgQEAgY3NjaGVkMl9kb21fY250bCgKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hl
ZDJfYWZmX2NudGwoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdiwK
K2NzY2hlZDJfYWZmX2NudGwoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2No
ZWRfdW5pdCAqdW5pdCwKICAgICAgICAgICAgICAgICAgY29uc3QgY3B1bWFza190ICpoYXJkLCBj
b25zdCBjcHVtYXNrX3QgKnNvZnQpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSB1bml0LT52Y3B1
OwogICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IGNzY2hlZDJfdmNwdSh2KTsKIAogICAg
IGlmICggIWhhcmQgKQpAQCAtMzA5Niw4ICszMTA1LDkgQEAgY3NjaGVkMl9mcmVlX2RvbWRhdGEo
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpkYXRhKQogfQogCiBzdGF0aWMgdm9p
ZAotY3NjaGVkMl92Y3B1X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVj
dCB2Y3B1ICp2YykKK2NzY2hlZDJfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1
bml0LT52Y3B1OwogICAgIHN0cnVjdCBjc2NoZWQyX3ZjcHUgKnN2YyA9IHZjLT5zY2hlZF9wcml2
OwogICAgIHN0cnVjdCBjc2NoZWQyX2RvbSAqIGNvbnN0IHNkb20gPSBzdmMtPnNkb207CiAgICAg
c3BpbmxvY2tfdCAqbG9jazsKQEAgLTMxMDgsNyArMzExOCw3IEBAIGNzY2hlZDJfdmNwdV9pbnNl
cnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCiAgICAgLyog
Y3NjaGVkMl9jcHVfcGljaygpIGV4cGVjdHMgdGhlIHBjcHUgbG9jayB0byBiZSBoZWxkICovCiAg
ICAgbG9jayA9IHZjcHVfc2NoZWR1bGVfbG9ja19pcnEodmMpOwogCi0gICAgdmMtPnByb2Nlc3Nv
ciA9IGNzY2hlZDJfY3B1X3BpY2sob3BzLCB2Yyk7CisgICAgdmMtPnByb2Nlc3NvciA9IGNzY2hl
ZDJfY3B1X3BpY2sob3BzLCB1bml0KTsKIAogICAgIHNwaW5fdW5sb2NrX2lycShsb2NrKTsKIApA
QCAtMzEzNSw4ICszMTQ1LDkgQEAgY3NjaGVkMl9mcmVlX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKm9wcywgdm9pZCAqcHJpdikKIH0KIAogc3RhdGljIHZvaWQKLWNzY2hlZDJfdmNwdV9y
ZW1vdmUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitjc2No
ZWQyX3VuaXRfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVk
X3VuaXQgKnVuaXQpCiB7CisgICAgc3RydWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBz
dHJ1Y3QgY3NjaGVkMl92Y3B1ICogY29uc3Qgc3ZjID0gY3NjaGVkMl92Y3B1KHZjKTsKICAgICBz
cGlubG9ja190ICpsb2NrOwogCkBAIC00MDc0LDE5ICs0MDg1LDE5IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyIHNjaGVkX2NyZWRpdDJfZGVmID0gewogCiAgICAgLmdsb2JhbF9pbml0
ICAgID0gY3NjaGVkMl9nbG9iYWxfaW5pdCwKIAotICAgIC5pbnNlcnRfdmNwdSAgICA9IGNzY2hl
ZDJfdmNwdV9pbnNlcnQsCi0gICAgLnJlbW92ZV92Y3B1ICAgID0gY3NjaGVkMl92Y3B1X3JlbW92
ZSwKKyAgICAuaW5zZXJ0X3VuaXQgICAgPSBjc2NoZWQyX3VuaXRfaW5zZXJ0LAorICAgIC5yZW1v
dmVfdW5pdCAgICA9IGNzY2hlZDJfdW5pdF9yZW1vdmUsCiAKLSAgICAuc2xlZXAgICAgICAgICAg
PSBjc2NoZWQyX3ZjcHVfc2xlZXAsCi0gICAgLndha2UgICAgICAgICAgID0gY3NjaGVkMl92Y3B1
X3dha2UsCi0gICAgLnlpZWxkICAgICAgICAgID0gY3NjaGVkMl92Y3B1X3lpZWxkLAorICAgIC5z
bGVlcCAgICAgICAgICA9IGNzY2hlZDJfdW5pdF9zbGVlcCwKKyAgICAud2FrZSAgICAgICAgICAg
PSBjc2NoZWQyX3VuaXRfd2FrZSwKKyAgICAueWllbGQgICAgICAgICAgPSBjc2NoZWQyX3VuaXRf
eWllbGQsCiAKICAgICAuYWRqdXN0ICAgICAgICAgPSBjc2NoZWQyX2RvbV9jbnRsLAogICAgIC5h
ZGp1c3RfYWZmaW5pdHk9IGNzY2hlZDJfYWZmX2NudGwsCiAgICAgLmFkanVzdF9nbG9iYWwgID0g
Y3NjaGVkMl9zeXNfY250bCwKIAogICAgIC5waWNrX2NwdSAgICAgICA9IGNzY2hlZDJfY3B1X3Bp
Y2ssCi0gICAgLm1pZ3JhdGUgICAgICAgID0gY3NjaGVkMl92Y3B1X21pZ3JhdGUsCisgICAgLm1p
Z3JhdGUgICAgICAgID0gY3NjaGVkMl91bml0X21pZ3JhdGUsCiAgICAgLmRvX3NjaGVkdWxlICAg
ID0gY3NjaGVkMl9zY2hlZHVsZSwKICAgICAuY29udGV4dF9zYXZlZCAgPSBjc2NoZWQyX2NvbnRl
eHRfc2F2ZWQsCiAKZGlmZiAtLWdpdCBhL3hlbi9jb21tb24vc2NoZWRfbnVsbC5jIGIveGVuL2Nv
bW1vbi9zY2hlZF9udWxsLmMKaW5kZXggMTA0MjdiMzdhYi4uYmY1MmM4NGIwZiAxMDA2NDQKLS0t
IGEveGVuL2NvbW1vbi9zY2hlZF9udWxsLmMKKysrIGIveGVuL2NvbW1vbi9zY2hlZF9udWxsLmMK
QEAgLTE5NCw4ICsxOTQsOSBAQCBzdGF0aWMgdm9pZCBudWxsX2RlaW5pdF9wZGF0YShjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHZvaWQgKnBjcHUsIGludCBjcHUpCiB9CiAKIHN0YXRpYyB2
b2lkICpudWxsX2FsbG9jX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1ICp2LCB2b2lkICpkZCkKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LCB2b2lkICpk
ZCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IHVuaXQtPnZjcHU7CiAgICAgc3RydWN0IG51bGxf
dmNwdSAqbnZjOwogCiAgICAgbnZjID0geHphbGxvYyhzdHJ1Y3QgbnVsbF92Y3B1KTsKQEAgLTQw
NSw4ICs0MDYsMTAgQEAgc3RhdGljIHNwaW5sb2NrX3QgKm51bGxfc3dpdGNoX3NjaGVkKHN0cnVj
dCBzY2hlZHVsZXIgKm5ld19vcHMsCiAgICAgcmV0dXJuICZzZC0+X2xvY2s7CiB9CiAKLXN0YXRp
YyB2b2lkIG51bGxfdmNwdV9pbnNlcnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1
Y3QgdmNwdSAqdikKK3N0YXRpYyB2b2lkIG51bGxfdW5pdF9pbnNlcnQoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRf
dW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IHVuaXQtPnZjcHU7CiAgICAgc3Ry
dWN0IG51bGxfcHJpdmF0ZSAqcHJ2ID0gbnVsbF9wcml2KG9wcyk7CiAgICAgc3RydWN0IG51bGxf
dmNwdSAqbnZjID0gbnVsbF92Y3B1KHYpOwogICAgIHVuc2lnbmVkIGludCBjcHU7CkBAIC00OTcs
OCArNTAwLDEwIEBAIHN0YXRpYyB2b2lkIF92Y3B1X3JlbW92ZShzdHJ1Y3QgbnVsbF9wcml2YXRl
ICpwcnYsIHN0cnVjdCB2Y3B1ICp2KQogICAgIHNwaW5fdW5sb2NrKCZwcnYtPndhaXRxX2xvY2sp
OwogfQogCi1zdGF0aWMgdm9pZCBudWxsX3ZjcHVfcmVtb3ZlKGNvbnN0IHN0cnVjdCBzY2hlZHVs
ZXIgKm9wcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgdm9pZCBudWxsX3VuaXRfcmVtb3ZlKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAgc3RydWN0IHZjcHUgKnYgPSB1bml0LT52
Y3B1OwogICAgIHN0cnVjdCBudWxsX3ByaXZhdGUgKnBydiA9IG51bGxfcHJpdihvcHMpOwogICAg
IHN0cnVjdCBudWxsX3ZjcHUgKm52YyA9IG51bGxfdmNwdSh2KTsKICAgICBzcGlubG9ja190ICps
b2NrOwpAQCAtNTI4LDggKzUzMywxMSBAQCBzdGF0aWMgdm9pZCBudWxsX3ZjcHVfcmVtb3ZlKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYpCiAgICAgU0NIRURfU1RB
VF9DUkFOSyh2Y3B1X3JlbW92ZSk7CiB9CiAKLXN0YXRpYyB2b2lkIG51bGxfdmNwdV93YWtlKGNv
bnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgdm9pZCBu
dWxsX3VuaXRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNw
dSAqdiA9IHVuaXQtPnZjcHU7CisKICAgICBBU1NFUlQoIWlzX2lkbGVfdmNwdSh2KSk7CiAKICAg
ICBpZiAoIHVubGlrZWx5KGN1cnJfb25fY3B1KHYtPnByb2Nlc3NvcikgPT0gdikgKQpAQCAtNTU0
LDggKzU2MiwxMSBAQCBzdGF0aWMgdm9pZCBudWxsX3ZjcHVfd2FrZShjb25zdCBzdHJ1Y3Qgc2No
ZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQogICAgIGNwdV9yYWlzZV9zb2Z0aXJxKHYtPnBy
b2Nlc3NvciwgU0NIRURVTEVfU09GVElSUSk7CiB9CiAKLXN0YXRpYyB2b2lkIG51bGxfdmNwdV9z
bGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGlj
IHZvaWQgbnVsbF91bml0X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBz
dHJ1Y3QgdmNwdSAqdiA9IHVuaXQtPnZjcHU7CisKICAgICBBU1NFUlQoIWlzX2lkbGVfdmNwdSh2
KSk7CiAKICAgICAvKiBJZiB2IGlzIG5vdCBhc3NpZ25lZCB0byBhIHBDUFUsIG9yIGlzIG5vdCBy
dW5uaW5nLCBubyBuZWVkIHRvIGJvdGhlciAqLwpAQCAtNTY1LDE1ICs1NzYsMTcgQEAgc3RhdGlj
IHZvaWQgbnVsbF92Y3B1X3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0
IHZjcHUgKnYpCiAgICAgU0NIRURfU1RBVF9DUkFOSyh2Y3B1X3NsZWVwKTsKIH0KIAotc3RhdGlj
IGludCBudWxsX2NwdV9waWNrKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZj
cHUgKnYpCitzdGF0aWMgaW50IG51bGxfY3B1X3BpY2soY29uc3Qgc3RydWN0IHNjaGVkdWxlciAq
b3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IHVu
aXQtPnZjcHU7CiAgICAgQVNTRVJUKCFpc19pZGxlX3ZjcHUodikpOwogICAgIHJldHVybiBwaWNr
X2NwdShudWxsX3ByaXYob3BzKSwgdik7CiB9CiAKLXN0YXRpYyB2b2lkIG51bGxfdmNwdV9taWdy
YXRlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnYsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgbmV3X2NwdSkKK3N0YXRpYyB2b2lk
IG51bGxfdW5pdF9taWdyYXRlKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LCB1bnNpZ25lZCBp
bnQgbmV3X2NwdSkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdiA9IHVuaXQtPnZjcHU7CiAgICAgc3Ry
dWN0IG51bGxfcHJpdmF0ZSAqcHJ2ID0gbnVsbF9wcml2KG9wcyk7CiAgICAgc3RydWN0IG51bGxf
dmNwdSAqbnZjID0gbnVsbF92Y3B1KHYpOwogCkBAIC04ODAsMTMgKzg5MywxMyBAQCBjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyIHNjaGVkX251bGxfZGVmID0gewogICAgIC5hbGxvY19kb21kYXRhICA9
IG51bGxfYWxsb2NfZG9tZGF0YSwKICAgICAuZnJlZV9kb21kYXRhICAgPSBudWxsX2ZyZWVfZG9t
ZGF0YSwKIAotICAgIC5pbnNlcnRfdmNwdSAgICA9IG51bGxfdmNwdV9pbnNlcnQsCi0gICAgLnJl
bW92ZV92Y3B1ICAgID0gbnVsbF92Y3B1X3JlbW92ZSwKKyAgICAuaW5zZXJ0X3VuaXQgICAgPSBu
dWxsX3VuaXRfaW5zZXJ0LAorICAgIC5yZW1vdmVfdW5pdCAgICA9IG51bGxfdW5pdF9yZW1vdmUs
CiAKLSAgICAud2FrZSAgICAgICAgICAgPSBudWxsX3ZjcHVfd2FrZSwKLSAgICAuc2xlZXAgICAg
ICAgICAgPSBudWxsX3ZjcHVfc2xlZXAsCisgICAgLndha2UgICAgICAgICAgID0gbnVsbF91bml0
X3dha2UsCisgICAgLnNsZWVwICAgICAgICAgID0gbnVsbF91bml0X3NsZWVwLAogICAgIC5waWNr
X2NwdSAgICAgICA9IG51bGxfY3B1X3BpY2ssCi0gICAgLm1pZ3JhdGUgICAgICAgID0gbnVsbF92
Y3B1X21pZ3JhdGUsCisgICAgLm1pZ3JhdGUgICAgICAgID0gbnVsbF91bml0X21pZ3JhdGUsCiAg
ICAgLmRvX3NjaGVkdWxlICAgID0gbnVsbF9zY2hlZHVsZSwKIAogICAgIC5kdW1wX2NwdV9zdGF0
ZSA9IG51bGxfZHVtcF9wY3B1LApkaWZmIC0tZ2l0IGEveGVuL2NvbW1vbi9zY2hlZF9ydC5jIGIv
eGVuL2NvbW1vbi9zY2hlZF9ydC5jCmluZGV4IDBhY2ZjM2Q3MDIuLjYzZWM3MzIxNTcgMTAwNjQ0
Ci0tLSBhL3hlbi9jb21tb24vc2NoZWRfcnQuYworKysgYi94ZW4vY29tbW9uL3NjaGVkX3J0LmMK
QEAgLTEzNiw3ICsxMzYsNyBAQAogICogUlREU19kZWxheWVkX3J1bnFfYWRkOiBEbyB3ZSBuZWVk
IHRvIGFkZCB0aGlzIHRvIHRoZSBSdW5RL0RlcGxldGVkUQogICogb25jZSBpdCdzIGRvbmUgYmVp
bmcgY29udGV4dCBzd2l0Y2hpbmcgb3V0PwogICogKyBTZXQgd2hlbiBzY2hlZHVsaW5nIG91dCBp
biBydF9zY2hlZHVsZSgpIGlmIHByZXYgaXMgcnVuYWJsZQotICogKyBTZXQgaW4gcnRfdmNwdV93
YWtlIGlmIGl0IGZpbmRzIFJURFNfc2NoZWR1bGVkIHNldAorICogKyBTZXQgaW4gcnRfdW5pdF93
YWtlIGlmIGl0IGZpbmRzIFJURFNfc2NoZWR1bGVkIHNldAogICogKyBSZWFkIGluIHJ0X2NvbnRl
eHRfc2F2ZWQoKS4gSWYgc2V0LCBpdCBhZGRzIHByZXYgdG8gdGhlIFJ1bnF1ZXVlL0RlcGxldGVk
UQogICogICBhbmQgY2xlYXJzIHRoZSBiaXQuCiAgKi8KQEAgLTYzNyw4ICs2MzcsOSBAQCByZXBs
cV9yZWluc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBydF92Y3B1ICpz
dmMpCiAgKiBhbmQgYXZhaWxhYmxlIGNwdXMKICAqLwogc3RhdGljIGludAotcnRfY3B1X3BpY2so
Y29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitydF9jcHVfcGlj
ayhjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0KQog
eworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7CiAgICAgY3B1bWFza190IGNwdXM7
CiAgICAgY3B1bWFza190ICpvbmxpbmU7CiAgICAgaW50IGNwdTsKQEAgLTgzOCw4ICs4MzksOSBA
QCBydF9mcmVlX2RvbWRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCB2b2lkICpkYXRh
KQogfQogCiBzdGF0aWMgdm9pZCAqCi1ydF9hbGxvY192ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2Yywgdm9pZCAqZGQpCitydF9hbGxvY192ZGF0YShjb25z
dCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LCB2b2lkICpk
ZCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1OwogICAgIHN0cnVjdCBydF92
Y3B1ICpzdmM7CiAKICAgICAvKiBBbGxvY2F0ZSBwZXItVkNQVSBpbmZvICovCkBAIC04ODEsOCAr
ODgzLDkgQEAgcnRfZnJlZV92ZGF0YShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHZvaWQg
KnByaXYpCiAgKiBkZXN0LiBjcHVwb29sLgogICovCiBzdGF0aWMgdm9pZAotcnRfdmNwdV9pbnNl
cnQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCitydF91bml0
X2luc2VydChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1
bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7CiAgICAgc3RydWN0IHJ0
X3ZjcHUgKnN2YyA9IHJ0X3ZjcHUodmMpOwogICAgIHNfdGltZV90IG5vdzsKICAgICBzcGlubG9j
a190ICpsb2NrOwpAQCAtODkwLDcgKzg5Myw3IEBAIHJ0X3ZjcHVfaW5zZXJ0KGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQogICAgIEJVR19PTiggaXNfaWRsZV92
Y3B1KHZjKSApOwogCiAgICAgLyogVGhpcyBpcyBzYWZlIGJlY2F1c2UgdmMgaXNuJ3QgeWV0IGJl
aW5nIHNjaGVkdWxlZCAqLwotICAgIHZjLT5wcm9jZXNzb3IgPSBydF9jcHVfcGljayhvcHMsIHZj
KTsKKyAgICB2Yy0+cHJvY2Vzc29yID0gcnRfY3B1X3BpY2sob3BzLCB1bml0KTsKIAogICAgIGxv
Y2sgPSB2Y3B1X3NjaGVkdWxlX2xvY2tfaXJxKHZjKTsKIApAQCAtOTE0LDggKzkxNyw5IEBAIHJ0
X3ZjcHVfaW5zZXJ0KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZj
KQogICogUmVtb3ZlIHJ0X3ZjcHUgc3ZjIGZyb20gdGhlIG9sZCBzY2hlZHVsZXIgaW4gc291cmNl
IGNwdXBvb2wuCiAgKi8KIHN0YXRpYyB2b2lkCi1ydF92Y3B1X3JlbW92ZShjb25zdCBzdHJ1Y3Qg
c2NoZWR1bGVyICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK3J0X3VuaXRfcmVtb3ZlKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CisgICAgc3Ry
dWN0IHZjcHUgKnZjID0gdW5pdC0+dmNwdTsKICAgICBzdHJ1Y3QgcnRfdmNwdSAqIGNvbnN0IHN2
YyA9IHJ0X3ZjcHUodmMpOwogICAgIHN0cnVjdCBydF9kb20gKiBjb25zdCBzZG9tID0gc3ZjLT5z
ZG9tOwogICAgIHNwaW5sb2NrX3QgKmxvY2s7CkBAIC0xMTM0LDggKzExMzgsOSBAQCBydF9zY2hl
ZHVsZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHNfdGltZV90IG5vdywgYm9vbF90IHRh
c2tsZXRfd29ya19zY2hlZAogICogVGhlIGxvY2sgaXMgYWxyZWFkeSBncmFiYmVkIGluIHNjaGVk
dWxlLmMsIG5vIG5lZWQgdG8gbG9jayBoZXJlCiAgKi8KIHN0YXRpYyB2b2lkCi1ydF92Y3B1X3Ns
ZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKm9wcywgc3RydWN0IHZjcHUgKnZjKQorcnRfdW5p
dF9zbGVlcChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpvcHMsIHN0cnVjdCBzY2hlZF91bml0ICp1
bml0KQogeworICAgIHN0cnVjdCB2Y3B1ICp2YyA9IHVuaXQtPnZjcHU7CiAgICAgc3RydWN0IHJ0
X3ZjcHUgKiBjb25zdCBzdmMgPSBydF92Y3B1KHZjKTsKIAogICAgIEJVR19PTiggaXNfaWRsZV92
Y3B1KHZjKSApOwpAQCAtMTI0OSw4ICsxMjU0LDkgQEAgcnVucV90aWNrbGUoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgcnRfdmNwdSAqbmV3KQogICogVE9ETzogd2hhdCBpZiB0
aGVzZSB0d28gdmNwdXMgYmVsb25ncyB0byB0aGUgc2FtZSBkb21haW4/CiAgKi8KIHN0YXRpYyB2
b2lkCi1ydF92Y3B1X3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNw
dSAqdmMpCitydF91bml0X3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3Qg
c2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNwdSAqdmMgPSB1bml0LT52Y3B1Owog
ICAgIHN0cnVjdCBydF92Y3B1ICogY29uc3Qgc3ZjID0gcnRfdmNwdSh2Yyk7CiAgICAgc190aW1l
X3Qgbm93OwogICAgIGJvb2xfdCBtaXNzZWQ7CkBAIC0xMzE5LDggKzEzMjUsOSBAQCBydF92Y3B1
X3dha2UoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqb3BzLCBzdHJ1Y3QgdmNwdSAqdmMpCiAgKiBh
bmQgdGhlbiBwaWNrIHRoZSBoaWdoZXN0IHByaW9yaXR5IHZjcHUgZnJvbSBydW5xIHRvIHJ1bgog
ICovCiBzdGF0aWMgdm9pZAotcnRfY29udGV4dF9zYXZlZChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVy
ICpvcHMsIHN0cnVjdCB2Y3B1ICp2YykKK3J0X2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqb3BzLCBzdHJ1Y3Qgc2NoZWRfdW5pdCAqdW5pdCkKIHsKKyAgICBzdHJ1Y3QgdmNw
dSAqdmMgPSB1bml0LT52Y3B1OwogICAgIHN0cnVjdCBydF92Y3B1ICpzdmMgPSBydF92Y3B1KHZj
KTsKICAgICBzcGlubG9ja190ICpsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2Yyk7CiAK
QEAgLTE1NDksMTUgKzE1NTYsMTUgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgc2No
ZWRfcnRkc19kZWYgPSB7CiAgICAgLmZyZWVfZG9tZGF0YSAgID0gcnRfZnJlZV9kb21kYXRhLAog
ICAgIC5hbGxvY192ZGF0YSAgICA9IHJ0X2FsbG9jX3ZkYXRhLAogICAgIC5mcmVlX3ZkYXRhICAg
ICA9IHJ0X2ZyZWVfdmRhdGEsCi0gICAgLmluc2VydF92Y3B1ICAgID0gcnRfdmNwdV9pbnNlcnQs
Ci0gICAgLnJlbW92ZV92Y3B1ICAgID0gcnRfdmNwdV9yZW1vdmUsCisgICAgLmluc2VydF91bml0
ICAgID0gcnRfdW5pdF9pbnNlcnQsCisgICAgLnJlbW92ZV91bml0ICAgID0gcnRfdW5pdF9yZW1v
dmUsCiAKICAgICAuYWRqdXN0ICAgICAgICAgPSBydF9kb21fY250bCwKIAogICAgIC5waWNrX2Nw
dSAgICAgICA9IHJ0X2NwdV9waWNrLAogICAgIC5kb19zY2hlZHVsZSAgICA9IHJ0X3NjaGVkdWxl
LAotICAgIC5zbGVlcCAgICAgICAgICA9IHJ0X3ZjcHVfc2xlZXAsCi0gICAgLndha2UgICAgICAg
ICAgID0gcnRfdmNwdV93YWtlLAorICAgIC5zbGVlcCAgICAgICAgICA9IHJ0X3VuaXRfc2xlZXAs
CisgICAgLndha2UgICAgICAgICAgID0gcnRfdW5pdF93YWtlLAogICAgIC5jb250ZXh0X3NhdmVk
ICA9IHJ0X2NvbnRleHRfc2F2ZWQsCiB9OwogCmRpZmYgLS1naXQgYS94ZW4vY29tbW9uL3NjaGVk
dWxlLmMgYi94ZW4vY29tbW9uL3NjaGVkdWxlLmMKaW5kZXggNmRjOTZiM2NkNC4uOGE4ZTczZmU1
NyAxMDA2NDQKLS0tIGEveGVuL2NvbW1vbi9zY2hlZHVsZS5jCisrKyBiL3hlbi9jb21tb24vc2No
ZWR1bGUuYwpAQCAtMjUyLDYgKzI1Miw3IEBAIHN0YXRpYyB2b2lkIHNjaGVkX3NwaW5fdW5sb2Nr
X2RvdWJsZShzcGlubG9ja190ICpsb2NrMSwgc3BpbmxvY2tfdCAqbG9jazIsCiBpbnQgc2NoZWRf
aW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgcHJvY2Vzc29yKQogewogICAg
IHN0cnVjdCBkb21haW4gKmQgPSB2LT5kb21haW47CisgICAgc3RydWN0IHNjaGVkX3VuaXQgdW5p
dCA9IHsgLnZjcHUgPSB2IH07CiAKICAgICB2LT5wcm9jZXNzb3IgPSBwcm9jZXNzb3I7CiAKQEAg
LTI2Myw3ICsyNjQsNyBAQCBpbnQgc2NoZWRfaW5pdF92Y3B1KHN0cnVjdCB2Y3B1ICp2LCB1bnNp
Z25lZCBpbnQgcHJvY2Vzc29yKQogICAgIGluaXRfdGltZXIoJnYtPnBvbGxfdGltZXIsIHBvbGxf
dGltZXJfZm4sCiAgICAgICAgICAgICAgICB2LCB2LT5wcm9jZXNzb3IpOwogCi0gICAgdi0+c2No
ZWRfcHJpdiA9IHNjaGVkX2FsbG9jX3ZkYXRhKGRvbV9zY2hlZHVsZXIoZCksIHYsIGQtPnNjaGVk
X3ByaXYpOworICAgIHYtPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxvY192ZGF0YShkb21fc2NoZWR1
bGVyKGQpLCAmdW5pdCwgZC0+c2NoZWRfcHJpdik7CiAgICAgaWYgKCB2LT5zY2hlZF9wcml2ID09
IE5VTEwgKQogICAgICAgICByZXR1cm4gMTsKIApAQCAtMjg0LDcgKzI4NSw3IEBAIGludCBzY2hl
ZF9pbml0X3ZjcHUoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBwcm9jZXNzb3IpCiAgICAg
fQogICAgIGVsc2UKICAgICB7Ci0gICAgICAgIHNjaGVkX2luc2VydF92Y3B1KGRvbV9zY2hlZHVs
ZXIoZCksIHYpOworICAgICAgICBzY2hlZF9pbnNlcnRfdW5pdChkb21fc2NoZWR1bGVyKGQpLCAm
dW5pdCk7CiAgICAgfQogCiAgICAgcmV0dXJuIDA7CkBAIC0zMDUsNiArMzA2LDcgQEAgaW50IHNj
aGVkX21vdmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogICAg
IHZvaWQgKnZjcHVkYXRhOwogICAgIHN0cnVjdCBzY2hlZHVsZXIgKm9sZF9vcHM7CiAgICAgdm9p
ZCAqb2xkX2RvbWRhdGE7CisgICAgc3RydWN0IHNjaGVkX3VuaXQgdW5pdDsKIAogICAgIGZvcl9l
YWNoX3ZjcHUgKCBkLCB2ICkKICAgICB7CkBAIC0zMjUsNyArMzI3LDggQEAgaW50IHNjaGVkX21v
dmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpjKQogCiAgICAgZm9y
X2VhY2hfdmNwdSAoIGQsIHYgKQogICAgIHsKLSAgICAgICAgdmNwdV9wcml2W3YtPnZjcHVfaWRd
ID0gc2NoZWRfYWxsb2NfdmRhdGEoYy0+c2NoZWQsIHYsIGRvbWRhdGEpOworICAgICAgICB1bml0
LnZjcHUgPSB2OworICAgICAgICB2Y3B1X3ByaXZbdi0+dmNwdV9pZF0gPSBzY2hlZF9hbGxvY192
ZGF0YShjLT5zY2hlZCwgJnVuaXQsIGRvbWRhdGEpOwogICAgICAgICBpZiAoIHZjcHVfcHJpdlt2
LT52Y3B1X2lkXSA9PSBOVUxMICkKICAgICAgICAgewogICAgICAgICAgICAgZm9yX2VhY2hfdmNw
dSAoIGQsIHYgKQpAQCAtMzQzLDcgKzM0Niw4IEBAIGludCBzY2hlZF9tb3ZlX2RvbWFpbihzdHJ1
Y3QgZG9tYWluICpkLCBzdHJ1Y3QgY3B1cG9vbCAqYykKIAogICAgIGZvcl9lYWNoX3ZjcHUgKCBk
LCB2ICkKICAgICB7Ci0gICAgICAgIHNjaGVkX3JlbW92ZV92Y3B1KG9sZF9vcHMsIHYpOworICAg
ICAgICB1bml0LnZjcHUgPSB2OworICAgICAgICBzY2hlZF9yZW1vdmVfdW5pdChvbGRfb3BzLCAm
dW5pdCk7CiAgICAgfQogCiAgICAgZC0+Y3B1cG9vbCA9IGM7CkBAIC0zNTQsNiArMzU4LDcgQEAg
aW50IHNjaGVkX21vdmVfZG9tYWluKHN0cnVjdCBkb21haW4gKmQsIHN0cnVjdCBjcHVwb29sICpj
KQogICAgIHsKICAgICAgICAgc3BpbmxvY2tfdCAqbG9jazsKIAorICAgICAgICB1bml0LnZjcHUg
PSB2OwogICAgICAgICB2Y3B1ZGF0YSA9IHYtPnNjaGVkX3ByaXY7CiAKICAgICAgICAgbWlncmF0
ZV90aW1lcigmdi0+cGVyaW9kaWNfdGltZXIsIG5ld19wKTsKQEAgLTM3OCw3ICszODMsNyBAQCBp
bnQgc2NoZWRfbW92ZV9kb21haW4oc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGNwdXBvb2wgKmMp
CiAKICAgICAgICAgbmV3X3AgPSBjcHVtYXNrX2N5Y2xlKG5ld19wLCBjLT5jcHVfdmFsaWQpOwog
Ci0gICAgICAgIHNjaGVkX2luc2VydF92Y3B1KGMtPnNjaGVkLCB2KTsKKyAgICAgICAgc2NoZWRf
aW5zZXJ0X3VuaXQoYy0+c2NoZWQsICZ1bml0KTsKIAogICAgICAgICBzY2hlZF9mcmVlX3ZkYXRh
KG9sZF9vcHMsIHZjcHVkYXRhKTsKICAgICB9CkBAIC0zOTYsMTIgKzQwMSwxNCBAQCBpbnQgc2No
ZWRfbW92ZV9kb21haW4oc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IGNwdXBvb2wgKmMpCiAKIHZv
aWQgc2NoZWRfZGVzdHJveV92Y3B1KHN0cnVjdCB2Y3B1ICp2KQogeworICAgIHN0cnVjdCBzY2hl
ZF91bml0IHVuaXQgPSB7IC52Y3B1ID0gdiB9OworCiAgICAga2lsbF90aW1lcigmdi0+cGVyaW9k
aWNfdGltZXIpOwogICAgIGtpbGxfdGltZXIoJnYtPnNpbmdsZXNob3RfdGltZXIpOwogICAgIGtp
bGxfdGltZXIoJnYtPnBvbGxfdGltZXIpOwogICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYm9vbCh2
LT5pc191cmdlbnQpICkKICAgICAgICAgYXRvbWljX2RlYygmcGVyX2NwdShzY2hlZHVsZV9kYXRh
LCB2LT5wcm9jZXNzb3IpLnVyZ2VudF9jb3VudCk7Ci0gICAgc2NoZWRfcmVtb3ZlX3ZjcHUodmNw
dV9zY2hlZHVsZXIodiksIHYpOworICAgIHNjaGVkX3JlbW92ZV91bml0KHZjcHVfc2NoZWR1bGVy
KHYpLCAmdW5pdCk7CiAgICAgc2NoZWRfZnJlZV92ZGF0YSh2Y3B1X3NjaGVkdWxlcih2KSwgdi0+
c2NoZWRfcHJpdik7CiB9CiAKQEAgLTQ0Niw2ICs0NTMsOCBAQCB2b2lkIHNjaGVkX2Rlc3Ryb3lf
ZG9tYWluKHN0cnVjdCBkb21haW4gKmQpCiAKIHZvaWQgdmNwdV9zbGVlcF9ub3N5bmNfbG9ja2Vk
KHN0cnVjdCB2Y3B1ICp2KQogeworICAgIHN0cnVjdCBzY2hlZF91bml0IHVuaXQgPSB7IC52Y3B1
ID0gdiB9OworCiAgICAgQVNTRVJUKHNwaW5faXNfbG9ja2VkKHBlcl9jcHUoc2NoZWR1bGVfZGF0
YSx2LT5wcm9jZXNzb3IpLnNjaGVkdWxlX2xvY2spKTsKIAogICAgIGlmICggbGlrZWx5KCF2Y3B1
X3J1bm5hYmxlKHYpKSApCkBAIC00NTMsNyArNDYyLDcgQEAgdm9pZCB2Y3B1X3NsZWVwX25vc3lu
Y19sb2NrZWQoc3RydWN0IHZjcHUgKnYpCiAgICAgICAgIGlmICggdi0+cnVuc3RhdGUuc3RhdGUg
PT0gUlVOU1RBVEVfcnVubmFibGUgKQogICAgICAgICAgICAgdmNwdV9ydW5zdGF0ZV9jaGFuZ2Uo
diwgUlVOU1RBVEVfb2ZmbGluZSwgTk9XKCkpOwogCi0gICAgICAgIHNjaGVkX3NsZWVwKHZjcHVf
c2NoZWR1bGVyKHYpLCB2KTsKKyAgICAgICAgc2NoZWRfc2xlZXAodmNwdV9zY2hlZHVsZXIodiks
ICZ1bml0KTsKICAgICB9CiB9CiAKQEAgLTQ4NSw2ICs0OTQsNyBAQCB2b2lkIHZjcHVfd2FrZShz
dHJ1Y3QgdmNwdSAqdikKIHsKICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOwogICAgIHNwaW5sb2Nr
X3QgKmxvY2s7CisgICAgc3RydWN0IHNjaGVkX3VuaXQgdW5pdCA9IHsgLnZjcHUgPSB2IH07CiAK
ICAgICBUUkFDRV8yRChUUkNfU0NIRURfV0FLRSwgdi0+ZG9tYWluLT5kb21haW5faWQsIHYtPnZj
cHVfaWQpOwogCkBAIC00OTQsNyArNTA0LDcgQEAgdm9pZCB2Y3B1X3dha2Uoc3RydWN0IHZjcHUg
KnYpCiAgICAgewogICAgICAgICBpZiAoIHYtPnJ1bnN0YXRlLnN0YXRlID49IFJVTlNUQVRFX2Js
b2NrZWQgKQogICAgICAgICAgICAgdmNwdV9ydW5zdGF0ZV9jaGFuZ2UodiwgUlVOU1RBVEVfcnVu
bmFibGUsIE5PVygpKTsKLSAgICAgICAgc2NoZWRfd2FrZSh2Y3B1X3NjaGVkdWxlcih2KSwgdik7
CisgICAgICAgIHNjaGVkX3dha2UodmNwdV9zY2hlZHVsZXIodiksICZ1bml0KTsKICAgICB9CiAg
ICAgZWxzZSBpZiAoICEodi0+cGF1c2VfZmxhZ3MgJiBWUEZfYmxvY2tlZCkgKQogICAgIHsKQEAg
LTUzMyw2ICs1NDMsNyBAQCB2b2lkIHZjcHVfdW5ibG9jayhzdHJ1Y3QgdmNwdSAqdikKIHN0YXRp
YyB2b2lkIHZjcHVfbW92ZV9sb2NrZWQoc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGludCBuZXdf
Y3B1KQogewogICAgIHVuc2lnbmVkIGludCBvbGRfY3B1ID0gdi0+cHJvY2Vzc29yOworICAgIHN0
cnVjdCBzY2hlZF91bml0IHVuaXQgPSB7IC52Y3B1ID0gdiB9OwogCiAgICAgLyoKICAgICAgKiBU
cmFuc2ZlciB1cmdlbmN5IHN0YXR1cyB0byBuZXcgQ1BVIGJlZm9yZSBzd2l0Y2hpbmcgQ1BVcywg
YXMKQEAgLTU0OSw3ICs1NjAsNyBAQCBzdGF0aWMgdm9pZCB2Y3B1X21vdmVfbG9ja2VkKHN0cnVj
dCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgbmV3X2NwdSkKICAgICAgKiBBY3R1YWwgQ1BVIHN3aXRj
aCB0byBuZXcgQ1BVLiAgVGhpcyBpcyBzYWZlIGJlY2F1c2UgdGhlIGxvY2sKICAgICAgKiBwb2lu
dGVyIGNhbid0IGNoYW5nZSB3aGlsZSB0aGUgY3VycmVudCBsb2NrIGlzIGhlbGQuCiAgICAgICov
Ci0gICAgc2NoZWRfbWlncmF0ZSh2Y3B1X3NjaGVkdWxlcih2KSwgdiwgbmV3X2NwdSk7CisgICAg
c2NoZWRfbWlncmF0ZSh2Y3B1X3NjaGVkdWxlcih2KSwgJnVuaXQsIG5ld19jcHUpOwogfQogCiAv
KgpAQCAtNTkxLDYgKzYwMiw3IEBAIHN0YXRpYyB2b2lkIHZjcHVfbWlncmF0ZV9maW5pc2goc3Ry
dWN0IHZjcHUgKnYpCiAgICAgdW5zaWduZWQgaW50IG9sZF9jcHUsIG5ld19jcHU7CiAgICAgc3Bp
bmxvY2tfdCAqb2xkX2xvY2ssICpuZXdfbG9jazsKICAgICBib29sX3QgcGlja19jYWxsZWQgPSAw
OworICAgIHN0cnVjdCBzY2hlZF91bml0IHVuaXQgPSB7IC52Y3B1ID0gdiB9OwogCiAgICAgLyoK
ICAgICAgKiBJZiB0aGUgdmNwdSBpcyBjdXJyZW50bHkgcnVubmluZywgdGhpcyB3aWxsIGJlIGhh
bmRsZWQgYnkKQEAgLTYyNyw3ICs2MzksNyBAQCBzdGF0aWMgdm9pZCB2Y3B1X21pZ3JhdGVfZmlu
aXNoKHN0cnVjdCB2Y3B1ICp2KQogICAgICAgICAgICAgICAgIGJyZWFrOwogCiAgICAgICAgICAg
ICAvKiBTZWxlY3QgYSBuZXcgQ1BVLiAqLwotICAgICAgICAgICAgbmV3X2NwdSA9IHNjaGVkX3Bp
Y2tfY3B1KHZjcHVfc2NoZWR1bGVyKHYpLCB2KTsKKyAgICAgICAgICAgIG5ld19jcHUgPSBzY2hl
ZF9waWNrX2NwdSh2Y3B1X3NjaGVkdWxlcih2KSwgJnVuaXQpOwogICAgICAgICAgICAgaWYgKCAo
bmV3X2xvY2sgPT0gcGVyX2NwdShzY2hlZHVsZV9kYXRhLCBuZXdfY3B1KS5zY2hlZHVsZV9sb2Nr
KSAmJgogICAgICAgICAgICAgICAgICBjcHVtYXNrX3Rlc3RfY3B1KG5ld19jcHUsIHYtPmRvbWFp
bi0+Y3B1cG9vbC0+Y3B1X3ZhbGlkKSApCiAgICAgICAgICAgICAgICAgYnJlYWs7CkBAIC02OTcs
NiArNzA5LDcgQEAgdm9pZCByZXN0b3JlX3ZjcHVfYWZmaW5pdHkoc3RydWN0IGRvbWFpbiAqZCkK
ICAgICB7CiAgICAgICAgIHNwaW5sb2NrX3QgKmxvY2s7CiAgICAgICAgIHVuc2lnbmVkIGludCBv
bGRfY3B1ID0gdi0+cHJvY2Vzc29yOworICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCB1bml0ID0g
eyAudmNwdSA9IHYgfTsKIAogICAgICAgICBBU1NFUlQoIXZjcHVfcnVubmFibGUodikpOwogCkBA
IC03MzIsNyArNzQ1LDcgQEAgdm9pZCByZXN0b3JlX3ZjcHVfYWZmaW5pdHkoc3RydWN0IGRvbWFp
biAqZCkKICAgICAgICAgdi0+cHJvY2Vzc29yID0gY3B1bWFza19hbnkoY3B1bWFza19zY3JhdGNo
X2NwdShjcHUpKTsKIAogICAgICAgICBsb2NrID0gdmNwdV9zY2hlZHVsZV9sb2NrX2lycSh2KTsK
LSAgICAgICAgdi0+cHJvY2Vzc29yID0gc2NoZWRfcGlja19jcHUodmNwdV9zY2hlZHVsZXIodiks
IHYpOworICAgICAgICB2LT5wcm9jZXNzb3IgPSBzY2hlZF9waWNrX2NwdSh2Y3B1X3NjaGVkdWxl
cih2KSwgJnVuaXQpOwogICAgICAgICBzcGluX3VubG9ja19pcnEobG9jayk7CiAKICAgICAgICAg
aWYgKCBvbGRfY3B1ICE9IHYtPnByb2Nlc3NvciApCkBAIC04NDQsNyArODU3LDkgQEAgc3RhdGlj
IGludCBjcHVfZGlzYWJsZV9zY2hlZHVsZXJfY2hlY2sodW5zaWduZWQgaW50IGNwdSkKIHZvaWQg
c2NoZWRfc2V0X2FmZmluaXR5KAogICAgIHN0cnVjdCB2Y3B1ICp2LCBjb25zdCBjcHVtYXNrX3Qg
KmhhcmQsIGNvbnN0IGNwdW1hc2tfdCAqc29mdCkKIHsKLSAgICBzY2hlZF9hZGp1c3RfYWZmaW5p
dHkoZG9tX3NjaGVkdWxlcih2LT5kb21haW4pLCB2LCBoYXJkLCBzb2Z0KTsKKyAgICBzdHJ1Y3Qg
c2NoZWRfdW5pdCB1bml0ID0geyAudmNwdSA9IHYgfTsKKworICAgIHNjaGVkX2FkanVzdF9hZmZp
bml0eShkb21fc2NoZWR1bGVyKHYtPmRvbWFpbiksICZ1bml0LCBoYXJkLCBzb2Z0KTsKIAogICAg
IGlmICggaGFyZCApCiAgICAgICAgIGNwdW1hc2tfY29weSh2LT5jcHVfaGFyZF9hZmZpbml0eSwg
aGFyZCk7CkBAIC0xMDE3LDkgKzEwMzIsMTAgQEAgc3RhdGljIGxvbmcgZG9fcG9sbChzdHJ1Y3Qg
c2NoZWRfcG9sbCAqc2NoZWRfcG9sbCkKIGxvbmcgdmNwdV95aWVsZCh2b2lkKQogewogICAgIHN0
cnVjdCB2Y3B1ICogdj1jdXJyZW50OworICAgIHN0cnVjdCBzY2hlZF91bml0IHVuaXQgPSB7IC52
Y3B1ID0gdiB9OwogICAgIHNwaW5sb2NrX3QgKmxvY2sgPSB2Y3B1X3NjaGVkdWxlX2xvY2tfaXJx
KHYpOwogCi0gICAgc2NoZWRfeWllbGQodmNwdV9zY2hlZHVsZXIodiksIHYpOworICAgIHNjaGVk
X3lpZWxkKHZjcHVfc2NoZWR1bGVyKHYpLCAmdW5pdCk7CiAgICAgdmNwdV9zY2hlZHVsZV91bmxv
Y2tfaXJxKGxvY2ssIHYpOwogCiAgICAgU0NIRURfU1RBVF9DUkFOSyh2Y3B1X3lpZWxkKTsKQEAg
LTE1MTQsNiArMTUzMCw4IEBAIHN0YXRpYyB2b2lkIHNjaGVkdWxlKHZvaWQpCiAKIHZvaWQgY29u
dGV4dF9zYXZlZChzdHJ1Y3QgdmNwdSAqcHJldikKIHsKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCB1
bml0ID0geyAudmNwdSA9IHByZXYgfTsKKwogICAgIC8qIENsZWFyIHJ1bm5pbmcgZmxhZyAvYWZ0
ZXIvIHdyaXRpbmcgY29udGV4dCB0byBtZW1vcnkuICovCiAgICAgc21wX3dtYigpOwogCkBAIC0x
NTIyLDcgKzE1NDAsNyBAQCB2b2lkIGNvbnRleHRfc2F2ZWQoc3RydWN0IHZjcHUgKnByZXYpCiAg
ICAgLyogQ2hlY2sgZm9yIG1pZ3JhdGlvbiByZXF1ZXN0IC9hZnRlci8gY2xlYXJpbmcgcnVubmlu
ZyBmbGFnLiAqLwogICAgIHNtcF9tYigpOwogCi0gICAgc2NoZWRfY29udGV4dF9zYXZlZCh2Y3B1
X3NjaGVkdWxlcihwcmV2KSwgcHJldik7CisgICAgc2NoZWRfY29udGV4dF9zYXZlZCh2Y3B1X3Nj
aGVkdWxlcihwcmV2KSwgJnVuaXQpOwogCiAgICAgdmNwdV9taWdyYXRlX2ZpbmlzaChwcmV2KTsK
IH0KQEAgLTE1NzgsNiArMTU5Niw3IEBAIHN0YXRpYyBpbnQgY3B1X3NjaGVkdWxlX3VwKHVuc2ln
bmVkIGludCBjcHUpCiAgICAgZWxzZQogICAgIHsKICAgICAgICAgc3RydWN0IHZjcHUgKmlkbGUg
PSBpZGxlX3ZjcHVbY3B1XTsKKyAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgdW5pdCA9IHsgLnZj
cHUgPSBpZGxlIH07CiAKICAgICAgICAgLyoKICAgICAgICAgICogRHVyaW5nIChBQ1BJPykgc3Vz
cGVuZCB0aGUgaWRsZSB2Q1BVIGZvciB0aGlzIHBDUFUgaXMgbm90IGZyZWVkLApAQCAtMTU5MSw3
ICsxNjEwLDcgQEAgc3RhdGljIGludCBjcHVfc2NoZWR1bGVfdXAodW5zaWduZWQgaW50IGNwdSkK
ICAgICAgICAgICovCiAgICAgICAgIEFTU0VSVChpZGxlLT5zY2hlZF9wcml2ID09IE5VTEwpOwog
Ci0gICAgICAgIGlkbGUtPnNjaGVkX3ByaXYgPSBzY2hlZF9hbGxvY192ZGF0YSgmb3BzLCBpZGxl
LAorICAgICAgICBpZGxlLT5zY2hlZF9wcml2ID0gc2NoZWRfYWxsb2NfdmRhdGEoJm9wcywgJnVu
aXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZGxlLT5k
b21haW4tPnNjaGVkX3ByaXYpOwogICAgICAgICBpZiAoIGlkbGUtPnNjaGVkX3ByaXYgPT0gTlVM
TCApCiAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKQEAgLTE4MDgsNiArMTgyNyw3IEBAIHZv
aWQgX19pbml0IHNjaGVkdWxlcl9pbml0KHZvaWQpCiBpbnQgc2NoZWR1bGVfY3B1X3N3aXRjaCh1
bnNpZ25lZCBpbnQgY3B1LCBzdHJ1Y3QgY3B1cG9vbCAqYykKIHsKICAgICBzdHJ1Y3QgdmNwdSAq
aWRsZTsKKyAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCB1bml0OwogICAgIHZvaWQgKnBwcml2LCAqcHBy
aXZfb2xkLCAqdnByaXYsICp2cHJpdl9vbGQ7CiAgICAgc3RydWN0IHNjaGVkdWxlciAqb2xkX29w
cyA9IHBlcl9jcHUoc2NoZWR1bGVyLCBjcHUpOwogICAgIHN0cnVjdCBzY2hlZHVsZXIgKm5ld19v
cHMgPSAoYyA9PSBOVUxMKSA/ICZvcHMgOiBjLT5zY2hlZDsKQEAgLTE4NDQsMTAgKzE4NjQsMTEg
QEAgaW50IHNjaGVkdWxlX2NwdV9zd2l0Y2godW5zaWduZWQgaW50IGNwdSwgc3RydWN0IGNwdXBv
b2wgKmMpCiAgICAgICogICAgc2NoZWRfcHJpdiBmaWVsZCBvZiB0aGUgcGVyLXZDUFUgaW5mbyBv
ZiB0aGUgaWRsZSBkb21haW4uCiAgICAgICovCiAgICAgaWRsZSA9IGlkbGVfdmNwdVtjcHVdOwor
ICAgIHVuaXQudmNwdSA9IGlkbGU7CiAgICAgcHByaXYgPSBzY2hlZF9hbGxvY19wZGF0YShuZXdf
b3BzLCBjcHUpOwogICAgIGlmICggSVNfRVJSKHBwcml2KSApCiAgICAgICAgIHJldHVybiBQVFJf
RVJSKHBwcml2KTsKLSAgICB2cHJpdiA9IHNjaGVkX2FsbG9jX3ZkYXRhKG5ld19vcHMsIGlkbGUs
IGlkbGUtPmRvbWFpbi0+c2NoZWRfcHJpdik7CisgICAgdnByaXYgPSBzY2hlZF9hbGxvY192ZGF0
YShuZXdfb3BzLCAmdW5pdCwgaWRsZS0+ZG9tYWluLT5zY2hlZF9wcml2KTsKICAgICBpZiAoIHZw
cml2ID09IE5VTEwgKQogICAgIHsKICAgICAgICAgc2NoZWRfZnJlZV9wZGF0YShuZXdfb3BzLCBw
cHJpdiwgY3B1KTsKZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC1pZi5oIGIveGVu
L2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKaW5kZXggYjhlMmIyZTQ5ZS4uOGRkYmViNGZmZCAxMDA2
NDQKLS0tIGEveGVuL2luY2x1ZGUveGVuL3NjaGVkLWlmLmgKKysrIGIveGVuL2luY2x1ZGUveGVu
L3NjaGVkLWlmLmgKQEAgLTE0MSw4ICsxNDEsOCBAQCBzdHJ1Y3Qgc2NoZWR1bGVyIHsKICAgICB2
b2lkICAgICAgICAgKCpkZWluaXQpICAgICAgICAgKHN0cnVjdCBzY2hlZHVsZXIgKik7CiAKICAg
ICB2b2lkICAgICAgICAgKCpmcmVlX3ZkYXRhKSAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIg
Kiwgdm9pZCAqKTsKLSAgICB2b2lkICogICAgICAgKCphbGxvY192ZGF0YSkgICAgKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0IHZjcHUgKiwKLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHZvaWQgKik7CisgICAgdm9pZCAqICAgICAgICgqYWxsb2NfdmRhdGEpICAg
IChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqLCB2b2lkICopOwogICAgIHZvaWQgICAgICAgICAo
KmZyZWVfcGRhdGEpICAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCB2b2lkICosIGludCk7
CiAgICAgdm9pZCAqICAgICAgICgqYWxsb2NfcGRhdGEpICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1
bGVyICosIGludCk7CiAgICAgdm9pZCAgICAgICAgICgqaW5pdF9wZGF0YSkgICAgIChjb25zdCBz
dHJ1Y3Qgc2NoZWR1bGVyICosIHZvaWQgKiwgaW50KTsKQEAgLTE1NiwyNCArMTU2LDMyIEBAIHN0
cnVjdCBzY2hlZHVsZXIgewogICAgIHNwaW5sb2NrX3QgKiAoKnN3aXRjaF9zY2hlZCkgICAoc3Ry
dWN0IHNjaGVkdWxlciAqLCB1bnNpZ25lZCBpbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB2b2lkICosIHZvaWQgKik7CiAKLSAgICAvKiBBY3RpdmF0ZSAvIGRlYWN0aXZh
dGUgdmNwdXMgaW4gYSBjcHUgcG9vbCAqLwotICAgIHZvaWQgICAgICAgICAoKmluc2VydF92Y3B1
KSAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqKTsKLSAgICB2b2lk
ICAgICAgICAgKCpyZW1vdmVfdmNwdSkgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3Ry
dWN0IHZjcHUgKik7Ci0KLSAgICB2b2lkICAgICAgICAgKCpzbGVlcCkgICAgICAgICAgKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0IHZjcHUgKik7Ci0gICAgdm9pZCAgICAgICAgICgq
d2FrZSkgICAgICAgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCB2Y3B1ICop
OwotICAgIHZvaWQgICAgICAgICAoKnlpZWxkKSAgICAgICAgICAoY29uc3Qgc3RydWN0IHNjaGVk
dWxlciAqLCBzdHJ1Y3QgdmNwdSAqKTsKLSAgICB2b2lkICAgICAgICAgKCpjb250ZXh0X3NhdmVk
KSAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0IHZjcHUgKik7CisgICAgLyogQWN0
aXZhdGUgLyBkZWFjdGl2YXRlIHVuaXRzIGluIGEgY3B1IHBvb2wgKi8KKyAgICB2b2lkICAgICAg
ICAgKCppbnNlcnRfdW5pdCkgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICopOworICAgIHZv
aWQgICAgICAgICAoKnJlbW92ZV91bml0KSAgICAoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKik7
CisKKyAgICB2b2lkICAgICAgICAgKCpzbGVlcCkgICAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hl
ZF91bml0ICopOworICAgIHZvaWQgICAgICAgICAoKndha2UpICAgICAgICAgICAoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHNjaGVkX3VuaXQgKik7CisgICAgdm9pZCAgICAgICAgICgqeWllbGQpICAgICAgICAgIChj
b25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAqKTsKKyAgICB2b2lkICAgICAgICAgKCpjb250ZXh0X3Nh
dmVkKSAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICopOwogCiAgICAgc3RydWN0IHRhc2tfc2xp
Y2UgKCpkb19zY2hlZHVsZSkgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc190aW1lX3QsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xfdCB0YXNrbGV0X3dvcmtf
c2NoZWR1bGVkKTsKIAotICAgIGludCAgICAgICAgICAoKnBpY2tfY3B1KSAgICAgICAoY29uc3Qg
c3RydWN0IHNjaGVkdWxlciAqLCBzdHJ1Y3QgdmNwdSAqKTsKLSAgICB2b2lkICAgICAgICAgKCpt
aWdyYXRlKSAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwgc3RydWN0IHZjcHUgKiwK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCk7CisgICAg
aW50ICAgICAgICAgICgqcGlja19jcHUpICAgICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICos
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NoZWRfdW5pdCAq
KTsKKyAgICB2b2lkICAgICAgICAgKCptaWdyYXRlKSAgICAgICAgKGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hl
ZF91bml0ICosIHVuc2lnbmVkIGludCk7CiAgICAgaW50ICAgICAgICAgICgqYWRqdXN0KSAgICAg
ICAgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosIHN0cnVjdCBkb21haW4gKiwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB4ZW5fZG9tY3RsX3NjaGVkdWxlcl9v
cCAqKTsKLSAgICB2b2lkICAgICAgICAgKCphZGp1c3RfYWZmaW5pdHkpKGNvbnN0IHN0cnVjdCBz
Y2hlZHVsZXIgKiwgc3RydWN0IHZjcHUgKiwKKyAgICB2b2lkICAgICAgICAgKCphZGp1c3RfYWZm
aW5pdHkpKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICosCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgY3B1bWFzayAqLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IGNwdW1hc2sgKik7CiAgICAgaW50ICAgICAg
ICAgICgqYWRqdXN0X2dsb2JhbCkgIChjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICosCkBAIC0yNjcs
MTAgKzI3NSwxMCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgc2NoZWRfZGVpbml0X3BkYXRhKGNvbnN0
IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHZvaWQgKmRhdGEsCiAgICAgICAgIHMtPmRlaW5pdF9wZGF0
YShzLCBkYXRhLCBjcHUpOwogfQogCi1zdGF0aWMgaW5saW5lIHZvaWQgKnNjaGVkX2FsbG9jX3Zk
YXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCB2Y3B1ICp2LAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpkb21fZGF0YSkKK3N0YXRpYyBpbmxp
bmUgdm9pZCAqc2NoZWRfYWxsb2NfdmRhdGEoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVu
aXQsIHZvaWQgKmRvbV9kYXRhKQogewotICAgIHJldHVybiBzLT5hbGxvY192ZGF0YShzLCB2LCBk
b21fZGF0YSk7CisgICAgcmV0dXJuIHMtPmFsbG9jX3ZkYXRhKHMsIHVuaXQsIGRvbV9kYXRhKTsK
IH0KIAogc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2ZyZWVfdmRhdGEoY29uc3Qgc3RydWN0IHNj
aGVkdWxlciAqcywgdm9pZCAqZGF0YSkKQEAgLTI3OCw2NCArMjg2LDcwIEBAIHN0YXRpYyBpbmxp
bmUgdm9pZCBzY2hlZF9mcmVlX3ZkYXRhKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHZvaWQg
KmRhdGEpCiAgICAgcy0+ZnJlZV92ZGF0YShzLCBkYXRhKTsKIH0KIAotc3RhdGljIGlubGluZSB2
b2lkIHNjaGVkX2luc2VydF92Y3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCB2
Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX2luc2VydF91bml0KGNvbnN0IHN0cnVj
dCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7Ci0gICAgaWYgKCBzLT5pbnNlcnRfdmNwdSApCi0gICAg
ICAgIHMtPmluc2VydF92Y3B1KHMsIHYpOworICAgIGlmICggcy0+aW5zZXJ0X3VuaXQgKQorICAg
ICAgICBzLT5pbnNlcnRfdW5pdChzLCB1bml0KTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHNj
aGVkX3JlbW92ZV92Y3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCB2Y3B1ICp2
KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3JlbW92ZV91bml0KGNvbnN0IHN0cnVjdCBzY2hl
ZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNj
aGVkX3VuaXQgKnVuaXQpCiB7Ci0gICAgaWYgKCBzLT5yZW1vdmVfdmNwdSApCi0gICAgICAgIHMt
PnJlbW92ZV92Y3B1KHMsIHYpOworICAgIGlmICggcy0+cmVtb3ZlX3VuaXQgKQorICAgICAgICBz
LT5yZW1vdmVfdW5pdChzLCB1bml0KTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3Ns
ZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlu
bGluZSB2b2lkIHNjaGVkX3NsZWVwKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAg
aWYgKCBzLT5zbGVlcCApCi0gICAgICAgIHMtPnNsZWVwKHMsIHYpOworICAgICAgICBzLT5zbGVl
cChzLCB1bml0KTsKIH0KIAotc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3dha2UoY29uc3Qgc3Ry
dWN0IHNjaGVkdWxlciAqcywgc3RydWN0IHZjcHUgKnYpCitzdGF0aWMgaW5saW5lIHZvaWQgc2No
ZWRfd2FrZShjb25zdCBzdHJ1Y3Qgc2NoZWR1bGVyICpzLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAgaWYgKCBzLT53YWtlICkK
LSAgICAgICAgcy0+d2FrZShzLCB2KTsKKyAgICAgICAgcy0+d2FrZShzLCB1bml0KTsKIH0KIAot
c3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3lpZWxkKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMs
IHN0cnVjdCB2Y3B1ICp2KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX3lpZWxkKGNvbnN0IHN0
cnVjdCBzY2hlZHVsZXIgKnMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHNjaGVkX3VuaXQgKnVuaXQpCiB7CiAgICAgaWYgKCBzLT55aWVsZCApCi0gICAgICAgIHMtPnlp
ZWxkKHMsIHYpOworICAgICAgICBzLT55aWVsZChzLCB1bml0KTsKIH0KIAogc3RhdGljIGlubGlu
ZSB2b2lkIHNjaGVkX2NvbnRleHRfc2F2ZWQoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1ICp2KQorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjaGVkX3VuaXQgKnVu
aXQpCiB7CiAgICAgaWYgKCBzLT5jb250ZXh0X3NhdmVkICkKLSAgICAgICAgcy0+Y29udGV4dF9z
YXZlZChzLCB2KTsKKyAgICAgICAgcy0+Y29udGV4dF9zYXZlZChzLCB1bml0KTsKIH0KIAotc3Rh
dGljIGlubGluZSB2b2lkIHNjaGVkX21pZ3JhdGUoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywg
c3RydWN0IHZjcHUgKnYsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgY3B1KQorc3RhdGljIGlubGluZSB2b2lkIHNjaGVkX21pZ3JhdGUoY29uc3Qgc3RydWN0
IHNjaGVkdWxlciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBz
Y2hlZF91bml0ICp1bml0LCB1bnNpZ25lZCBpbnQgY3B1KQogewogICAgIGlmICggcy0+bWlncmF0
ZSApCi0gICAgICAgIHMtPm1pZ3JhdGUocywgdiwgY3B1KTsKKyAgICAgICAgcy0+bWlncmF0ZShz
LCB1bml0LCBjcHUpOwogICAgIGVsc2UKLSAgICAgICAgdi0+cHJvY2Vzc29yID0gY3B1OworICAg
ICAgICB1bml0LT52Y3B1LT5wcm9jZXNzb3IgPSBjcHU7CiB9CiAKLXN0YXRpYyBpbmxpbmUgaW50
IHNjaGVkX3BpY2tfY3B1KGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCB2Y3B1ICp2
KQorc3RhdGljIGlubGluZSBpbnQgc2NoZWRfcGlja19jcHUoY29uc3Qgc3RydWN0IHNjaGVkdWxl
ciAqcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0
ICp1bml0KQogewotICAgIHJldHVybiBzLT5waWNrX2NwdShzLCB2KTsKKyAgICByZXR1cm4gcy0+
cGlja19jcHUocywgdW5pdCk7CiB9CiAKIHN0YXRpYyBpbmxpbmUgdm9pZCBzY2hlZF9hZGp1c3Rf
YWZmaW5pdHkoY29uc3Qgc3RydWN0IHNjaGVkdWxlciAqcywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHZjcHUgKnYsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2hlZF91bml0ICp1bml0LAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjcHVtYXNrX3QgKmhhcmQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNwdW1hc2tfdCAq
c29mdCkKIHsKICAgICBpZiAoIHMtPmFkanVzdF9hZmZpbml0eSApCi0gICAgICAgIHMtPmFkanVz
dF9hZmZpbml0eShzLCB2LCBoYXJkLCBzb2Z0KTsKKyAgICAgICAgcy0+YWRqdXN0X2FmZmluaXR5
KHMsIHVuaXQsIGhhcmQsIHNvZnQpOwogfQogCiBzdGF0aWMgaW5saW5lIGludCBzY2hlZF9hZGp1
c3RfZG9tKGNvbnN0IHN0cnVjdCBzY2hlZHVsZXIgKnMsIHN0cnVjdCBkb21haW4gKmQsCmRpZmYg
LS1naXQgYS94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaCBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5o
CmluZGV4IDIyMDFmYWNhNmIuLjcyYTE3NzU4YTEgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL3hl
bi9zY2hlZC5oCisrKyBiL3hlbi9pbmNsdWRlL3hlbi9zY2hlZC5oCkBAIC0yNzUsNiArMjc1LDEw
IEBAIHN0cnVjdCB2Y3B1CiAgICAgc3RydWN0IGFyY2hfdmNwdSBhcmNoOwogfTsKIAorc3RydWN0
IHNjaGVkX3VuaXQgeworICAgIHN0cnVjdCB2Y3B1ICAgICAgICAgICAqdmNwdTsKK307CisKIC8q
IFBlci1kb21haW4gbG9jayBjYW4gYmUgcmVjdXJzaXZlbHkgYWNxdWlyZWQgaW4gZmF1bHQgaGFu
ZGxlcnMuICovCiAjZGVmaW5lIGRvbWFpbl9sb2NrKGQpIHNwaW5fbG9ja19yZWN1cnNpdmUoJihk
KS0+ZG9tYWluX2xvY2spCiAjZGVmaW5lIGRvbWFpbl91bmxvY2soZCkgc3Bpbl91bmxvY2tfcmVj
dXJzaXZlKCYoZCktPmRvbWFpbl9sb2NrKQotLSAKMi4xNi40CgoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4t
ZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9t
YWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

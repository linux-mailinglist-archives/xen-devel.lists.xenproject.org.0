Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6AE8E17EECA
	for <lists+xen-devel@lfdr.de>; Tue, 10 Mar 2020 03:44:08 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1jBUo8-00019N-G0; Tue, 10 Mar 2020 02:39:48 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=pT5j=43=intel.com=kevin.tian@srs-us1.protection.inumbo.net>)
 id 1jBUo6-00019I-S4
 for xen-devel@lists.xenproject.org; Tue, 10 Mar 2020 02:39:46 +0000
X-Inumbo-ID: 644f388e-6278-11ea-ace3-12813bfff9fa
Received: from mga05.intel.com (unknown [192.55.52.43])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id 644f388e-6278-11ea-ace3-12813bfff9fa;
 Tue, 10 Mar 2020 02:39:43 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 09 Mar 2020 19:39:40 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.70,535,1574150400"; d="scan'208";a="235909707"
Received: from fmsmsx107.amr.corp.intel.com ([10.18.124.205])
 by orsmga008.jf.intel.com with ESMTP; 09 Mar 2020 19:39:39 -0700
Received: from shsmsx105.ccr.corp.intel.com (10.239.4.158) by
 fmsmsx107.amr.corp.intel.com (10.18.124.205) with Microsoft SMTP Server (TLS)
 id 14.3.439.0; Mon, 9 Mar 2020 19:39:38 -0700
Received: from shsmsx104.ccr.corp.intel.com ([169.254.5.206]) by
 SHSMSX105.ccr.corp.intel.com ([169.254.11.144]) with mapi id 14.03.0439.000;
 Tue, 10 Mar 2020 10:39:35 +0800
From: "Tian, Kevin" <kevin.tian@intel.com>
To: Jan Beulich <jbeulich@suse.com>, "xen-devel@lists.xenproject.org"
 <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v5 2/4] x86/HVM: implement memory read caching for insn
 emulation
Thread-Index: AQHV8UT3ZAlTniCSrkK5dvC9Y95HUKhBJYkQ
Date: Tue, 10 Mar 2020 02:39:34 +0000
Message-ID: <AADFC41AFE54684AB9EE6CBC0274A5D19D7C5BBA@SHSMSX104.ccr.corp.intel.com>
References: <1e1ccd2a-526c-631b-7889-35f993b2005e@suse.com>
 <b9aa8053-b35b-1d0f-8303-abc39e1ae17d@suse.com>
In-Reply-To: <b9aa8053-b35b-1d0f-8303-abc39e1ae17d@suse.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-ctpclassification: CTP_NT
x-titus-metadata-40: eyJDYXRlZ29yeUxhYmVscyI6IiIsIk1ldGFkYXRhIjp7Im5zIjoiaHR0cDpcL1wvd3d3LnRpdHVzLmNvbVwvbnNcL0ludGVsMyIsImlkIjoiNzFmZDBiMWUtNzJmNC00Mjc4LTgzODMtZjBjOTAyYWQ5N2ZjIiwicHJvcHMiOlt7Im4iOiJDVFBDbGFzc2lmaWNhdGlvbiIsInZhbHMiOlt7InZhbHVlIjoiQ1RQX05UIn1dfV19LCJTdWJqZWN0TGFiZWxzIjpbXSwiVE1DVmVyc2lvbiI6IjE3LjEwLjE4MDQuNDkiLCJUcnVzdGVkTGFiZWxIYXNoIjoiT1pUS1Bjc0FuQ1kwMUpZN3pXYk1DUGJqRytIVHBnem15M0p5Y0J5WVlRM1N3bzc1cFZvRVZ0UnFnZklCbmQzUSJ9
dlp-product: dlpe-windows
dlp-version: 11.2.0.6
dlp-reaction: no-action
x-originating-ip: [10.239.127.40]
MIME-Version: 1.0
Subject: Re: [Xen-devel] [PATCH v5 2/4] x86/HVM: implement memory read
 caching for insn emulation
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 =?utf-8?B?Um9nZXIgUGF1IE1vbm7DqQ==?= <roger.pau@citrix.com>, "Nakajima,
 Jun" <jun.nakajima@intel.com>, Wei Liu <wl@xen.org>,
 Paul Durrant <paul@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

PiBGcm9tOiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+DQo+IFNlbnQ6IFR1ZXNkYXks
IE1hcmNoIDMsIDIwMjAgNjoxNyBQTQ0KPiANCj4gRW11bGF0aW9uIHJlcXVpcmluZyBkZXZpY2Ug
bW9kZWwgYXNzaXN0YW5jZSB1c2VzIGEgZm9ybSBvZiBpbnN0cnVjdGlvbg0KPiByZS1leGVjdXRp
b24sIGFzc3VtaW5nIHRoYXQgdGhlIHNlY29uZCAoYW5kIGFueSBmdXJ0aGVyKSBwYXNzIHRha2Vz
DQo+IGV4YWN0bHkgdGhlIHNhbWUgcGF0aC4gVGhpcyBpcyBhIHZhbGlkIGFzc3VtcHRpb24gYXMg
ZmFyIGFzIHVzZSBvZiBDUFUNCg0KYWgsIEkgd2FzIG5vdCBhd2FyZSBvZiBzdWNoIGZvcm0uIEkg
dGhvdWdodCB0aGUgZW11bGF0aW9uIGlzIHNwbGl0DQppbnRvIHR3byBwaGFzZXM6IGRlY29kaW5n
IGFuZCBzZW5kIGkvbyByZXF1ZXN0IHRvIGRldmljZSBtb2RlbCwgYW5kDQp0aGVuIGNvbXBsZXRp
bmcgaW5zdCBlbXVsYXRpb24gd2l0aCBkZXZpY2UgbW9kZWwncyByZXNwb25zZSBhbmQNCnByZXZp
b3VzbHktZGVjb2RlZCBpbmZvcm1hdGlvbi4uLiANCg0KPiByZWdpc3RlcnMgZ29lcyAoYXMgdGhv
c2UgY2FuJ3QgY2hhbmdlIHdpdGhvdXQgYW55IG90aGVyIGluc3RydWN0aW9uDQo+IGV4ZWN1dGlu
ZyBpbiBiZXR3ZWVuIFsxXSksIGJ1dCBpcyB3cm9uZyBmb3IgbWVtb3J5IGFjY2Vzc2VzLiBJbg0K
PiBwYXJ0aWN1bGFyIGl0IGhhcyBiZWVuIG9ic2VydmVkIHRoYXQgV2luZG93cyBtaWdodCBwYWdl
IG91dCBidWZmZXJzDQo+IHVuZGVybmVhdGggYW4gaW5zdHJ1Y3Rpb24gY3VycmVudGx5IHVuZGVy
IGVtdWxhdGlvbiAoaGl0dGluZyBiZXR3ZWVuIHR3bw0KPiBwYXNzZXMpLiBJZiB0aGUgZmlyc3Qg
cGFzcyByZWFkIGEgbWVtb3J5IG9wZXJhbmQgc3VjY2Vzc2Z1bGx5LCBhbnkNCj4gc3Vic2VxdWVu
dCBwYXNzIG5lZWRzIHRvIGdldCB0byBzZWUgdGhlIGV4YWN0IHNhbWUgdmFsdWUuDQo+IA0KPiBJ
bnRyb2R1Y2UgYSBjYWNoZSB0byBtYWtlIHN1cmUgYWJvdmUgZGVzY3JpYmVkIGFzc3VtcHRpb24g
aG9sZHMuIFRoaXMNCj4gaXMgYSB2ZXJ5IHNpbXBsaXN0aWMgaW1wbGVtZW50YXRpb24gZm9yIG5v
dzogT25seSBleGFjdCBtYXRjaGVzIGFyZQ0KPiBzYXRpc2ZpZWQgKG5vIG92ZXJsYXBzIG9yIHBh
cnRpYWwgcmVhZHMgb3IgYW55dGhpbmcpOyB0aGlzIGlzIHN1ZmZpY2llbnQNCj4gZm9yIHRoZSBp
bW1lZGlhdGUgcHVycG9zZSBvZiBtYWtpbmcgcmUtZXhlY3V0aW9uIGFuIGV4YWN0IHJlcGxheS4g
VGhlDQo+IGNhY2hlIGFsc28gd29uJ3QgYmUgdXNlZCBqdXN0IHlldCBmb3IgZ3Vlc3QgcGFnZSB3
YWxrczsgdGhhdCdsbCBiZSB0aGUNCj4gc3ViamVjdCBvZiBhIHN1YnNlcXVlbnQgY2hhbmdlLg0K
DQphIGNhY2hlIGltcGxpZXMgdGhhdCB0aGUgYWZvcmVtZW50aW9uZWQgdHdvLXBhc3MgcHJvYmxl
bSBpcyBvbmx5DQptaXRpZ2F0ZWQgaW5zdGVhZCBvZiBjb21wbGV0ZWx5IGZpeGVkPw0KDQpidHcg
aXMgdGhlcmUgYW55IHBlcmZvcm1hbmNlIGltcGFjdCBmcm9tIHRoaXMgcGF0Y2g/DQoNCj4gDQo+
IFdpdGggdGhlIGNhY2hlIGJlaW5nIGdlbmVyYWxseSB0cmFuc3BhcmVudCB0byB1cHBlciBsYXll
cnMsIGJ1dCB3aXRoIGl0DQo+IGhhdmluZyBsaW1pdGVkIGNhcGFjaXR5IHlldCBiZWluZyByZXF1
aXJlZCBmb3IgY29ycmVjdG5lc3MsIGNlcnRhaW4NCj4gdXNlcnMgb2YgaHZtX2NvcHlfZnJvbV9n
dWVzdF8qKCkgbmVlZCB0byBkaXNhYmxlIGNhY2hpbmcgdGVtcG9yYXJpbHksDQo+IHdpdGhvdXQg
aW52YWxpZGF0aW5nIHRoZSBjYWNoZS4gTm90ZSB0aGF0IHRoZSBhZGp1c3RtZW50cyBoZXJlIHRv
DQo+IGh2bV9oeXBlcmNhbGwoKSBhbmQgaHZtX3Rhc2tfc3dpdGNoKCkgYXJlIGJlbmlnbiBhdCB0
aGlzIHBvaW50OyB0aGV5J2xsDQo+IGJlY29tZSByZWxldmFudCBvbmNlIHdlIHN0YXJ0IHRvIGJl
IGFibGUgdG8gZW11bGF0ZSByZXNwZWN0aXZlIGluc25zDQo+IHRocm91Z2ggdGhlIG1haW4gZW11
bGF0b3IgKGFuZCBtb3JlIGNoYW5nZXMgd2lsbCB0aGVuIGxpa2VseSBiZSBuZWVkZWQNCj4gdG8g
bmVzdGVkIGNvZGUpLg0KPiANCj4gQXMgdG8gdGhlIGFjdHVhbCBkYXRhIHBhZ2UgaW4gYSBwcm9i
bGFtdGljIHNjZW5hcmlvLCB0aGVyZSBhcmUgYSBjb3VwbGUNCj4gb2YgYXNwZWN0cyB0byB0YWtl
IGludG8gY29uc2lkZXJhdGlvbjoNCj4gLSBXZSBtdXN0IGJlIHRhbGtpbmcgYWJvdXQgYW4gaW5z
biBhY2Nlc3NpbmcgdHdvIGxvY2F0aW9ucyAodHdvIG1lbW9yeQ0KPiAgIG9uZXMsIG9uZSBvZiB3
aGljaCBpcyBNTUlPLCBvciBhIG1lbW9yeSBhbmQgYW4gSS9PIG9uZSkuDQo+IC0gSWYgdGhlIG5v
biBJL08gLyBNTUlPIHNpZGUgaXMgYmVpbmcgcmVhZCwgdGhlIHJlLXJlYWQgKGlmIGl0IG9jY3Vy
cyBhdA0KPiAgIGFsbCkgaXMgaGF2aW5nIGl0cyByZXN1bHQgZGlzY2FyZGVkLCBieSB0YWtpbmcg
dGhlIHNob3J0Y3V0IHRocm91Z2gNCj4gICB0aGUgZmlyc3Qgc3dpdGNoKCkncyBTVEFURV9JT1JF
U1BfUkVBRFkgY2FzZSBpbiBodm1lbXVsX2RvX2lvKCkuIE5vdGUNCj4gICBob3csIGFtb25nIGFs
bCB0aGUgcmUtaXNzdWUgc2FuaXR5IGNoZWNrcyB0aGVyZSwgd2UgYXZvaWQgY29tcGFyaW5nDQo+
ICAgdGhlIGFjdHVhbCBkYXRhLg0KPiAtIElmIHRoZSBub24gSS9PIC8gTU1JTyBzaWRlIGlzIGJl
aW5nIHdyaXR0ZW4sIGl0IGlzIHRoZSBPU2VzDQo+ICAgcmVzcG9uc2liaWxpdHkgdG8gYXZvaWQg
YWN0dWFsbHkgbW92aW5nIHBhZ2UgY29udGVudHMgdG8gZGlzayB3aGlsZQ0KPiAgIHRoZXJlIG1p
Z2h0IHN0aWxsIGJlIGEgd3JpdGUgYWNjZXNzIGluIGZsaWdodCAtIHRoaXMgaXMgbm8gZGlmZmVy
ZW50DQo+ICAgaW4gYmVoYXZpb3IgZnJvbSBiYXJlIGhhcmR3YXJlLg0KPiAtIFJlYWQtbW9kaWZ5
LXdyaXRlIGFjY2Vzc2VzIGFyZSwgYXMgYWx3YXlzLCBjb21wbGljYXRlZCwgYW5kIHdoaWxlIHdl
DQo+ICAgZGVhbCB3aXRoIHRoZW0gYmV0dGVyIG5vd2FkYXlzIHRoYW4gd2UgZGlkIGluIHRoZSBw
YXN0LCB3ZSdyZSBzdGlsbA0KPiAgIG5vdCBxdWl0ZSB0aGVyZSB0byBndWFyYW50ZWUgaGFyZHdh
cmUgbGlrZSBiZWhhdmlvciBpbiBhbGwgY2FzZXMNCj4gICBhbnl3YXkuIE5vdGhpbmcgaXMgZ2V0
dGluZyB3b3JzZSBieSB0aGUgY2hhbmdlcyBtYWRlIGhlcmUsIGFmYWljdC4NCj4gDQo+IEluIF9f
aHZtX2NvcHkoKSBhbHNvIHJlZHVjZSBwJ3Mgc2NvcGUgYW5kIGNoYW5nZSBpdHMgdHlwZSB0byB2
b2lkICouDQo+IA0KPiBbMV0gT3RoZXIgdGhhbiBvbiBhY3R1YWwgaGFyZHdhcmUsIGFjdGlvbnMg
bGlrZQ0KPiAgICAgWEVOX0RPTUNUTF9zZXRodm1jb250ZXh0LCBYRU5fRE9NQ1RMX3NldHZjcHVj
b250ZXh0LA0KPiAgICAgVkNQVU9QX2luaXRpYWxpc2UsIElOSVQsIG9yIFNJUEkgaXNzdWVkIGFn
YWluc3QgdGhlIHZDUFUgY2FuIG9jY3VyDQo+ICAgICB3aGlsZSB0aGUgdkNQVSBpcyBibG9ja2Vk
IHdhaXRpbmcgZm9yIGEgZGV2aWNlIG1vZGVsIHRvIHJldHVybiBkYXRhLg0KPiAgICAgSW4gc3Vj
aCBjYXNlcyBlbXVsYXRpb24gbm93IGdldHMgY2FuY2VsZWQsIHRob3VnaCwgYW5kIGhlbmNlIHJl
LQ0KPiAgICAgZXhlY3V0aW9uIGNvcnJlY3RuZXNzIGlzIHVuYWZmZWN0ZWQuDQo+IA0KPiBTaWdu
ZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3VzZS5jb20+DQo+IC0tLQ0KPiBUQkQ6
IEluIHByaW5jaXBsZSB0aGUgY2FjaGluZyBoZXJlIHlpZWxkcyB1bm5lY2Vzc2FyeSB0aGUgb25l
IHVzZWQgZm9yDQo+ICAgICAgaW5zbiBieXRlcyAodmlvLT5tbWlvX2luc257LF9ieXRlc30uIEhv
d2V2ZXIsIHRvIHNlZWQgdGhlIGNhY2hlDQo+ICAgICAgd2l0aCB0aGUgZGF0YSBTVk0gbWF5IGhh
dmUgbWFkZSBhdmFpbGFibGUsIHdlJ2QgaGF2ZSB0byBhbHNvIGtub3cNCj4gICAgICB0aGUgY29y
cmVzcG9uZGluZyBHUEEuIEl0J3Mgbm90IHNhZmUsIGhvd2V2ZXIsIHRvIHJlLXdhbGsgdGhlIHBh
Z2UNCj4gICAgICB0YWJsZXMgdG8gZmluZCBvdXQsIGFzIHRoZSBwYWdlIHRhYmxlcyBtYXkgaGF2
ZSBjaGFuZ2VkIGluIHRoZQ0KPiAgICAgIG1lYW50aW1lLiBUaGVyZWZvcmUgSSBndWVzcyB3ZSBu
ZWVkIHRvIGtlZXAgdGhlIGR1cGxpY2F0ZQ0KPiAgICAgIGZ1bmN0aW9uYWxpdHkgZm9yIG5vdy4g
QSBwb3NzaWJsZSBzb2x1dGlvbiB0byB0aGlzIGNvdWxkIGJlIHRvIHVzZQ0KPiAgICAgIGEgcGh5
c2ljYWwtYWRkcmVzcy1iYXNlZCBjYWNoZSBmb3IgcGFnZSB0YWJsZSBhY2Nlc3NlcyAoYW5kIGxv
b2tpbmcNCj4gICAgICBmb3J3YXJkIGFsc28gZS5nLiBTVk0vVk1YIGluc24gZW11bGF0aW9uKSwg
YW5kIGEgbGluZWFyLWFkZHJlc3MtDQo+ICAgICAgYmFzZWQgb25lIGZvciBhbGwgb3RoZXIgcmVh
ZHMuDQo+IC0tLQ0KPiB2NTogUmUtYXJyYW5nZSBiaXRmaWVsZC4gVXNlIGRvbWFpbl9jcmFzaCgp
IGluIGh2bWVtdWxfd3JpdGVfY2FjaGUoKS4NCj4gICAgIE1vdmUgaHZtZW11bF97cmVhZCx3cml0
ZX1fY2FjaGUoKSBzdHVicyB0byBsYXRlciBwYXRjaC4gQWxzbyBhZGp1c3QNCj4gICAgIGh2bWVt
dWxfY2FuY2VsKCkuIEFkZCAvIGV4dGVuZCBjb21tZW50cy4gUmUtYmFzZS4NCj4gdjQ6IFJlLXdy
aXRlIGZvciBjYWNoZSB0byBiZWNvbWUgdHJhbnNwYXJlbnQgdG8gY2FsbGVycy4NCj4gdjM6IEFk
ZCB0ZXh0IGFib3V0IHRoZSBhY3R1YWwgZGF0YSBwYWdlIHRvIHRoZSBkZXNjcmlwdGlvbi4NCj4g
djI6IFJlLWJhc2UuDQo+IA0KPiAtLS0gYS94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYw0KPiAr
KysgYi94ZW4vYXJjaC94ODYvaHZtL2VtdWxhdGUuYw0KPiBAQCAtMjgsNiArMjgsMTkgQEANCj4g
ICNpbmNsdWRlIDxhc20vaW9jYXAuaD4NCj4gICNpbmNsdWRlIDxhc20vdm1fZXZlbnQuaD4NCj4g
DQo+ICtzdHJ1Y3QgaHZtZW11bF9jYWNoZQ0KPiArew0KPiArICAgIC8qIFRoZSBjYWNoZSBpcyBk
aXNhYmxlZCBhcyBsb25nIGFzIG51bV9lbnRzID4gbWF4X2VudHMuICovDQo+ICsgICAgdW5zaWdu
ZWQgaW50IG51bV9lbnRzOw0KPiArICAgIHVuc2lnbmVkIGludCBtYXhfZW50czsNCj4gKyAgICBz
dHJ1Y3Qgew0KPiArICAgICAgICBwYWRkcl90IGdwYTpQQUREUl9CSVRTOw0KPiArICAgICAgICB1
bnNpZ25lZCBpbnQgOkJJVFNfUEVSX0xPTkcgLSBQQUREUl9CSVRTIC0gODsNCj4gKyAgICAgICAg
dW5zaWduZWQgaW50IHNpemU6ODsNCj4gKyAgICAgICAgdW5zaWduZWQgbG9uZyBkYXRhOw0KPiAr
ICAgIH0gZW50c1tdOw0KPiArfTsNCj4gKw0KPiAgc3RhdGljIHZvaWQgaHZtdHJhY2VfaW9fYXNz
aXN0KGNvbnN0IGlvcmVxX3QgKnApDQo+ICB7DQo+ICAgICAgdW5zaWduZWQgaW50IHNpemUsIGV2
ZW50Ow0KPiBAQCAtMTM2LDYgKzE0OSw4IEBAIHZvaWQgaHZtZW11bF9jYW5jZWwoc3RydWN0IHZj
cHUgKnYpDQo+ICAgICAgdmlvLT5tbWlvX2FjY2VzcyA9IChzdHJ1Y3QgbnBmZWMpe307DQo+ICAg
ICAgdmlvLT5tbWlvX3JldHJ5ID0gZmFsc2U7DQo+ICAgICAgdmlvLT5nMm1faW9wb3J0ID0gTlVM
TDsNCj4gKw0KPiArICAgIGh2bWVtdWxfY2FjaGVfZGlzYWJsZSh2KTsNCj4gIH0NCj4gDQo+ICBz
dGF0aWMgaW50IGh2bWVtdWxfZG9faW8oDQo+IEBAIC0xODgzLDEyICsxODk4LDE3IEBAIHN0YXRp
YyBpbnQgaHZtZW11bF9yZXBfbW92cygNCj4gICAgICAgICAgcmMgPSBIVk1UUkFOU19va2F5Ow0K
PiAgICAgIH0NCj4gICAgICBlbHNlDQo+ICsgICAgew0KPiArICAgICAgICB1bnNpZ25lZCBpbnQg
dG9rZW4gPSBodm1lbXVsX2NhY2hlX2Rpc2FibGUoY3Vycik7DQo+ICsNCj4gICAgICAgICAgLyoN
Cj4gICAgICAgICAgICogV2UgZG8gYSBtb2RpY3VtIG9mIGNoZWNraW5nIGhlcmUsIGp1c3QgZm9y
IHBhcmFub2lhJ3Mgc2FrZSBhbmQgdG8NCj4gICAgICAgICAgICogZGVmaW5pdGVseSBhdm9pZCBj
b3B5aW5nIGFuIHVuaXRpYWxpc2VkIGJ1ZmZlciBpbnRvIGd1ZXN0IGFkZHJlc3MNCj4gICAgICAg
ICAgICogc3BhY2UuDQo+ICAgICAgICAgICAqLw0KPiAgICAgICAgICByYyA9IGh2bV9jb3B5X2Zy
b21fZ3Vlc3RfcGh5cyhidWYsIHNncGEsIGJ5dGVzKTsNCj4gKyAgICAgICAgaHZtZW11bF9jYWNo
ZV9yZXN0b3JlKGN1cnIsIHRva2VuKTsNCj4gKyAgICB9DQo+IA0KPiAgICAgIGlmICggcmMgPT0g
SFZNVFJBTlNfb2theSApDQo+ICAgICAgICAgIHJjID0gaHZtX2NvcHlfdG9fZ3Vlc3RfcGh5cyhk
Z3BhLCBidWYsIGJ5dGVzLCBjdXJyKTsNCj4gQEAgLTI1NTEsNiArMjU3MSwxOSBAQCBzdGF0aWMg
aW50IF9odm1fZW11bGF0ZV9vbmUoc3RydWN0IGh2bV9lDQo+ICAgICAgc3RydWN0IGh2bV92Y3B1
X2lvICp2aW8gPSAmY3Vyci0+YXJjaC5odm0uaHZtX2lvOw0KPiAgICAgIGludCByYzsNCj4gDQo+
ICsgICAgLyoNCj4gKyAgICAgKiBFbmFibGUgY2FjaGluZyBpZiBpdCdzIGN1cnJlbnRseSBkaXNh
YmxlZCwgYnV0IGxlYXZlIHRoZSBjYWNoZQ0KPiArICAgICAqIHVudG91Y2hlZCBpZiBpdCdzIGFs
cmVhZHkgZW5hYmxlZCwgZm9yIHJlLWV4ZWN1dGlvbiB0byBjb25zdW1lDQo+ICsgICAgICogZW50
cmllcyBwb3B1bGF0ZWQgYnkgYW4gZWFybGllciBwYXNzLg0KPiArICAgICAqLw0KPiArICAgIGlm
ICggdmlvLT5jYWNoZS0+bnVtX2VudHMgPiB2aW8tPmNhY2hlLT5tYXhfZW50cyApDQo+ICsgICAg
ew0KPiArICAgICAgICBBU1NFUlQodmlvLT5pb19yZXEuc3RhdGUgPT0gU1RBVEVfSU9SRVFfTk9O
RSk7DQo+ICsgICAgICAgIHZpby0+Y2FjaGUtPm51bV9lbnRzID0gMDsNCj4gKyAgICB9DQo+ICsg
ICAgZWxzZQ0KPiArICAgICAgICBBU1NFUlQodmlvLT5pb19yZXEuc3RhdGUgPT0gU1RBVEVfSU9S
RVNQX1JFQURZKTsNCj4gKw0KPiAgICAgIGh2bV9lbXVsYXRlX2luaXRfcGVyX2luc24oaHZtZW11
bF9jdHh0LCB2aW8tPm1taW9faW5zbiwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHZpby0+bW1pb19pbnNuX2J5dGVzKTsNCj4gDQo+IEBAIC0yNTY0LDYgKzI1OTcsNyBAQCBzdGF0
aWMgaW50IF9odm1fZW11bGF0ZV9vbmUoc3RydWN0IGh2bV9lDQo+ICAgICAgew0KPiAgICAgICAg
ICB2aW8tPm1taW9fY2FjaGVfY291bnQgPSAwOw0KPiAgICAgICAgICB2aW8tPm1taW9faW5zbl9i
eXRlcyA9IDA7DQo+ICsgICAgICAgIGh2bWVtdWxfY2FjaGVfZGlzYWJsZShjdXJyKTsNCj4gICAg
ICB9DQo+ICAgICAgZWxzZQ0KPiAgICAgIHsNCj4gQEAgLTI4NTYsNiArMjg5MCwxMjMgQEAgdm9p
ZCBodm1fZHVtcF9lbXVsYXRpb25fc3RhdGUoY29uc3QgY2hhcg0KPiAgICAgICAgICAgICBodm1l
bXVsX2N0eHQtPmluc25fYnVmKTsNCj4gIH0NCj4gDQo+ICtpbnQgaHZtZW11bF9jYWNoZV9pbml0
KHN0cnVjdCB2Y3B1ICp2KQ0KPiArew0KPiArICAgIC8qDQo+ICsgICAgICogTm8gaW5zbiBjYW4g
YWNjZXNzIG1vcmUgdGhhbiAxNiBpbmRlcGVuZGVudCBsaW5lYXIgYWRkcmVzc2VzDQo+IChBVlg1
MTJGDQo+ICsgICAgICogc2NhdHRlcnMvZ2F0aGVycyBiZWluZyB0aGUgd29yc3QpLiBFYWNoIHN1
Y2ggbGluZWFyIHJhbmdlIGNhbiBzcGFuIGENCj4gKyAgICAgKiBwYWdlIGJvdW5kYXJ5LCBpLmUu
IG1heSByZXF1aXJlIHR3byBwYWdlIHdhbGtzLiBBY2NvdW50IGZvciBlYWNoIGluc24NCj4gKyAg
ICAgKiBieXRlIGluZGl2aWR1YWxseSwgZm9yIHNpbXBsaWNpdHkuDQo+ICsgICAgICovDQo+ICsg
ICAgY29uc3QgdW5zaWduZWQgaW50IG5lbnRzID0gKENPTkZJR19QQUdJTkdfTEVWRUxTICsgMSkg
Kg0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChNQVhfSU5TVF9MRU4gKyAxNiAq
IDIpOw0KPiArICAgIHN0cnVjdCBodm1lbXVsX2NhY2hlICpjYWNoZSA9IHhtYWxsb2NfZmxleF9z
dHJ1Y3Qoc3RydWN0DQo+IGh2bWVtdWxfY2FjaGUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRzLCBuZW50cyk7DQo+ICsNCj4gKyAg
ICBpZiAoICFjYWNoZSApDQo+ICsgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiArDQo+ICsgICAg
LyogQ2FjaGUgaXMgZGlzYWJsZWQgaW5pdGlhbGx5LiAqLw0KPiArICAgIGNhY2hlLT5udW1fZW50
cyA9IG5lbnRzICsgMTsNCj4gKyAgICBjYWNoZS0+bWF4X2VudHMgPSBuZW50czsNCj4gKw0KPiAr
ICAgIHYtPmFyY2guaHZtLmh2bV9pby5jYWNoZSA9IGNhY2hlOw0KPiArDQo+ICsgICAgcmV0dXJu
IDA7DQo+ICt9DQo+ICsNCj4gK3Vuc2lnbmVkIGludCBodm1lbXVsX2NhY2hlX2Rpc2FibGUoc3Ry
dWN0IHZjcHUgKnYpDQo+ICt7DQo+ICsgICAgc3RydWN0IGh2bWVtdWxfY2FjaGUgKmNhY2hlID0g
di0+YXJjaC5odm0uaHZtX2lvLmNhY2hlOw0KPiArICAgIHVuc2lnbmVkIGludCB0b2tlbiA9IGNh
Y2hlLT5udW1fZW50czsNCj4gKw0KPiArICAgIGNhY2hlLT5udW1fZW50cyA9IGNhY2hlLT5tYXhf
ZW50cyArIDE7DQo+ICsNCj4gKyAgICByZXR1cm4gdG9rZW47DQo+ICt9DQo+ICsNCj4gK3ZvaWQg
aHZtZW11bF9jYWNoZV9yZXN0b3JlKHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBpbnQgdG9rZW4p
DQo+ICt7DQo+ICsgICAgc3RydWN0IGh2bWVtdWxfY2FjaGUgKmNhY2hlID0gdi0+YXJjaC5odm0u
aHZtX2lvLmNhY2hlOw0KPiArDQo+ICsgICAgQVNTRVJUKGNhY2hlLT5udW1fZW50cyA+IGNhY2hl
LT5tYXhfZW50cyk7DQo+ICsgICAgY2FjaGUtPm51bV9lbnRzID0gdG9rZW47DQo+ICt9DQo+ICsN
Cj4gK2Jvb2wgaHZtZW11bF9yZWFkX2NhY2hlKGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCBwYWRkcl90
IGdwYSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmJ1ZmZlciwgdW5zaWduZWQg
aW50IHNpemUpDQo+ICt7DQo+ICsgICAgY29uc3Qgc3RydWN0IGh2bWVtdWxfY2FjaGUgKmNhY2hl
ID0gdi0+YXJjaC5odm0uaHZtX2lvLmNhY2hlOw0KPiArICAgIHVuc2lnbmVkIGludCBpOw0KPiAr
DQo+ICsgICAgLyogQ2FjaGUgdW5hdmFpbGFibGU/ICovDQo+ICsgICAgaWYgKCBjYWNoZS0+bnVt
X2VudHMgPiBjYWNoZS0+bWF4X2VudHMgKQ0KPiArICAgICAgICByZXR1cm4gZmFsc2U7DQo+ICsN
Cj4gKyAgICB3aGlsZSAoIHNpemUgPiBzaXplb2YoY2FjaGUtPmVudHMtPmRhdGEpICkNCj4gKyAg
ICB7DQo+ICsgICAgICAgIGkgPSBncGEgJiAoc2l6ZW9mKGNhY2hlLT5lbnRzLT5kYXRhKSAtIDEp
DQo+ICsgICAgICAgICAgICA/IC1ncGEgJiAoc2l6ZW9mKGNhY2hlLT5lbnRzLT5kYXRhKSAtIDEp
DQo+ICsgICAgICAgICAgICA6IHNpemVvZihjYWNoZS0+ZW50cy0+ZGF0YSk7DQo+ICsgICAgICAg
IGlmICggIWh2bWVtdWxfcmVhZF9jYWNoZSh2LCBncGEsIGJ1ZmZlciwgaSkgKQ0KPiArICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOw0KPiArICAgICAgICBncGEgKz0gaTsNCj4gKyAgICAgICAgYnVm
ZmVyICs9IGk7DQo+ICsgICAgICAgIHNpemUgLT0gaTsNCj4gKyAgICB9DQo+ICsNCj4gKyAgICBm
b3IgKCBpID0gMDsgaSA8IGNhY2hlLT5udW1fZW50czsgKytpICkNCj4gKyAgICAgICAgaWYgKCBj
YWNoZS0+ZW50c1tpXS5ncGEgPT0gZ3BhICYmIGNhY2hlLT5lbnRzW2ldLnNpemUgPT0gc2l6ZSAp
DQo+ICsgICAgICAgIHsNCj4gKyAgICAgICAgICAgIG1lbWNweShidWZmZXIsICZjYWNoZS0+ZW50
c1tpXS5kYXRhLCBzaXplKTsNCj4gKyAgICAgICAgICAgIHJldHVybiB0cnVlOw0KPiArICAgICAg
ICB9DQo+ICsNCj4gKyAgICByZXR1cm4gZmFsc2U7DQo+ICt9DQo+ICsNCj4gK3ZvaWQgaHZtZW11
bF93cml0ZV9jYWNoZShjb25zdCBzdHJ1Y3QgdmNwdSAqdiwgcGFkZHJfdCBncGEsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3Qgdm9pZCAqYnVmZmVyLCB1bnNpZ25lZCBpbnQgc2l6
ZSkNCj4gK3sNCj4gKyAgICBzdHJ1Y3QgaHZtZW11bF9jYWNoZSAqY2FjaGUgPSB2LT5hcmNoLmh2
bS5odm1faW8uY2FjaGU7DQo+ICsgICAgdW5zaWduZWQgaW50IGk7DQo+ICsNCj4gKyAgICAvKiBD
YWNoZSB1bmF2YWlsYWJsZT8gKi8NCj4gKyAgICBpZiAoIGNhY2hlLT5udW1fZW50cyA+IGNhY2hl
LT5tYXhfZW50cyApDQo+ICsgICAgICAgIHJldHVybjsNCj4gKw0KPiArICAgIHdoaWxlICggc2l6
ZSA+IHNpemVvZihjYWNoZS0+ZW50cy0+ZGF0YSkgKQ0KPiArICAgIHsNCj4gKyAgICAgICAgaSA9
IGdwYSAmIChzaXplb2YoY2FjaGUtPmVudHMtPmRhdGEpIC0gMSkNCj4gKyAgICAgICAgICAgID8g
LWdwYSAmIChzaXplb2YoY2FjaGUtPmVudHMtPmRhdGEpIC0gMSkNCj4gKyAgICAgICAgICAgIDog
c2l6ZW9mKGNhY2hlLT5lbnRzLT5kYXRhKTsNCj4gKyAgICAgICAgaHZtZW11bF93cml0ZV9jYWNo
ZSh2LCBncGEsIGJ1ZmZlciwgaSk7DQo+ICsgICAgICAgIGdwYSArPSBpOw0KPiArICAgICAgICBi
dWZmZXIgKz0gaTsNCj4gKyAgICAgICAgc2l6ZSAtPSBpOw0KPiArICAgIH0NCj4gKw0KPiArICAg
IGZvciAoIGkgPSAwOyBpIDwgY2FjaGUtPm51bV9lbnRzOyArK2kgKQ0KPiArICAgICAgICBpZiAo
IGNhY2hlLT5lbnRzW2ldLmdwYSA9PSBncGEgJiYgY2FjaGUtPmVudHNbaV0uc2l6ZSA9PSBzaXpl
ICkNCj4gKyAgICAgICAgew0KPiArICAgICAgICAgICAgbWVtY3B5KCZjYWNoZS0+ZW50c1tpXS5k
YXRhLCBidWZmZXIsIHNpemUpOw0KPiArICAgICAgICAgICAgcmV0dXJuOw0KPiArICAgICAgICB9
DQo+ICsNCj4gKyAgICBpZiAoIHVubGlrZWx5KGkgPj0gY2FjaGUtPm1heF9lbnRzKSApDQo+ICsg
ICAgew0KPiArICAgICAgICBkb21haW5fY3Jhc2godi0+ZG9tYWluKTsNCj4gKyAgICAgICAgcmV0
dXJuOw0KPiArICAgIH0NCj4gKw0KPiArICAgIGNhY2hlLT5lbnRzW2ldLmdwYSAgPSBncGE7DQo+
ICsgICAgY2FjaGUtPmVudHNbaV0uc2l6ZSA9IHNpemU7DQo+ICsNCj4gKyAgICBtZW1jcHkoJmNh
Y2hlLT5lbnRzW2ldLmRhdGEsIGJ1ZmZlciwgc2l6ZSk7DQo+ICsNCj4gKyAgICBjYWNoZS0+bnVt
X2VudHMgPSBpICsgMTsNCj4gK30NCj4gKw0KPiAgLyoNCj4gICAqIExvY2FsIHZhcmlhYmxlczoN
Cj4gICAqIG1vZGU6IEMNCj4gLS0tIGEveGVuL2FyY2gveDg2L2h2bS9odm0uYw0KPiArKysgYi94
ZW4vYXJjaC94ODYvaHZtL2h2bS5jDQo+IEBAIC03MjYsNiArNzI2LDggQEAgaW50IGh2bV9kb21h
aW5faW5pdGlhbGlzZShzdHJ1Y3QgZG9tYWluDQo+ICAvKiBUaGlzIGZ1bmN0aW9uIGFuZCBhbGwg
aXRzIGRlc2NlbmRhbnRzIG5lZWQgdG8gYmUgdG8gYmUgaWRlbXBvdGVudC4gKi8NCj4gIHZvaWQg
aHZtX2RvbWFpbl9yZWxpbnF1aXNoX3Jlc291cmNlcyhzdHJ1Y3QgZG9tYWluICpkKQ0KPiAgew0K
PiArICAgIHN0cnVjdCB2Y3B1ICp2Ow0KPiArDQo+ICAgICAgaWYgKCBodm1fZnVuY3MuZG9tYWlu
X3JlbGlucXVpc2hfcmVzb3VyY2VzICkNCj4gICAgICAgICAgYWx0ZXJuYXRpdmVfdmNhbGwoaHZt
X2Z1bmNzLmRvbWFpbl9yZWxpbnF1aXNoX3Jlc291cmNlcywgZCk7DQo+IA0KPiBAQCAtNzQyLDYg
Kzc0NCw5IEBAIHZvaWQgaHZtX2RvbWFpbl9yZWxpbnF1aXNoX3Jlc291cmNlcyhzdHINCj4gICAg
ICBydGNfZGVpbml0KGQpOw0KPiAgICAgIHBtdGltZXJfZGVpbml0KGQpOw0KPiAgICAgIGhwZXRf
ZGVpbml0KGQpOw0KPiArDQo+ICsgICAgZm9yX2VhY2hfdmNwdSAoIGQsIHYgKQ0KPiArICAgICAg
ICBodm1lbXVsX2NhY2hlX2Rlc3Ryb3kodik7DQo+ICB9DQo+IA0KPiAgdm9pZCBodm1fZG9tYWlu
X2Rlc3Ryb3koc3RydWN0IGRvbWFpbiAqZCkNCj4gQEAgLTE1NDksNiArMTU1NCwxMCBAQCBpbnQg
aHZtX3ZjcHVfaW5pdGlhbGlzZShzdHJ1Y3QgdmNwdSAqdikNCj4gDQo+ICAgICAgdi0+YXJjaC5o
dm0uaW5qZWN0X2V2ZW50LnZlY3RvciA9IEhWTV9FVkVOVF9WRUNUT1JfVU5TRVQ7DQo+IA0KPiAr
ICAgIHJjID0gaHZtZW11bF9jYWNoZV9pbml0KHYpOw0KPiArICAgIGlmICggcmMgKQ0KPiArICAg
ICAgICBnb3RvIGZhaWw0Ow0KPiArDQo+ICAgICAgcmMgPSBzZXR1cF9jb21wYXRfYXJnX3hsYXQo
dik7IC8qIHRlYXJkb3duOiBmcmVlX2NvbXBhdF9hcmdfeGxhdCgpICovDQo+ICAgICAgaWYgKCBy
YyAhPSAwICkNCj4gICAgICAgICAgZ290byBmYWlsNDsNCj4gQEAgLTE1ODQsNiArMTU5Myw3IEBA
IGludCBodm1fdmNwdV9pbml0aWFsaXNlKHN0cnVjdCB2Y3B1ICp2KQ0KPiAgIGZhaWw1Og0KPiAg
ICAgIGZyZWVfY29tcGF0X2FyZ194bGF0KHYpOw0KPiAgIGZhaWw0Og0KPiArICAgIGh2bWVtdWxf
Y2FjaGVfZGVzdHJveSh2KTsNCj4gICAgICBodm1fZnVuY3MudmNwdV9kZXN0cm95KHYpOw0KPiAg
IGZhaWwzOg0KPiAgICAgIHZsYXBpY19kZXN0cm95KHYpOw0KPiBAQCAtMjk0NSw2ICsyOTU1LDcg
QEAgdm9pZCBodm1fdGFza19zd2l0Y2goDQo+ICAgICAgdW5zaWduZWQgaW50IGVmbGFncywgbmV3
X2NwbDsNCj4gICAgICBwYWdlZmF1bHRfaW5mb190IHBmaW5mbzsNCj4gICAgICBpbnQgZXhuX3Jh
aXNlZCwgcmM7DQo+ICsgICAgdW5zaWduZWQgaW50IHRva2VuID0gaHZtZW11bF9jYWNoZV9kaXNh
YmxlKHYpOw0KPiAgICAgIHN0cnVjdCB0c3MzMiB0c3M7DQo+IA0KPiAgICAgIGh2bV9nZXRfc2Vn
bWVudF9yZWdpc3Rlcih2LCB4ODZfc2VnX2dkdHIsICZnZHQpOw0KPiBAQCAtMzE1Miw2ICszMTYz
LDggQEAgdm9pZCBodm1fdGFza19zd2l0Y2goDQo+ICAgb3V0Og0KPiAgICAgIGh2bV91bm1hcF9l
bnRyeShvcHRzc19kZXNjKTsNCj4gICAgICBodm1fdW5tYXBfZW50cnkobnB0c3NfZGVzYyk7DQo+
ICsNCj4gKyAgICBodm1lbXVsX2NhY2hlX3Jlc3RvcmUodiwgdG9rZW4pOw0KPiAgfQ0KPiANCj4g
IGVudW0gaHZtX3RyYW5zbGF0aW9uX3Jlc3VsdCBodm1fdHJhbnNsYXRlX2dldF9wYWdlKA0KPiBA
QCAtMzI0Miw3ICszMjU1LDYgQEAgc3RhdGljIGVudW0gaHZtX3RyYW5zbGF0aW9uX3Jlc3VsdCBf
X2h2bQ0KPiAgICAgIGdmbl90IGdmbjsNCj4gICAgICBzdHJ1Y3QgcGFnZV9pbmZvICpwYWdlOw0K
PiAgICAgIHAybV90eXBlX3QgcDJtdDsNCj4gLSAgICBjaGFyICpwOw0KPiAgICAgIGludCBjb3Vu
dCwgdG9kbyA9IHNpemU7DQo+IA0KPiAgICAgIEFTU0VSVChpc19odm1fdmNwdSh2KSk7DQo+IEBA
IC0zMjkwLDExICszMzAyLDE3IEBAIHN0YXRpYyBlbnVtIGh2bV90cmFuc2xhdGlvbl9yZXN1bHQg
X19odm0NCj4gICAgICAgICAgICAgIHJldHVybiBIVk1UUkFOU19uZWVkX3JldHJ5Ow0KPiAgICAg
ICAgICB9DQo+IA0KPiAtICAgICAgICBwID0gX19tYXBfZG9tYWluX3BhZ2UocGFnZSkgKyBwZ29m
ZjsNCj4gLQ0KPiAtICAgICAgICBpZiAoIGZsYWdzICYgSFZNQ09QWV90b19ndWVzdCApDQo+ICsg
ICAgICAgIGlmICggKGZsYWdzICYgSFZNQ09QWV90b19ndWVzdCkgfHwNCj4gKyAgICAgICAgICAg
ICAhaHZtZW11bF9yZWFkX2NhY2hlKHYsIGdmbl90b19nYWRkcihnZm4pIHwgcGdvZmYsIGJ1Ziwg
Y291bnQpICkNCj4gICAgICAgICAgew0KPiAtICAgICAgICAgICAgaWYgKCBwMm1faXNfZGlzY2Fy
ZF93cml0ZShwMm10KSApDQo+ICsgICAgICAgICAgICB2b2lkICpwID0gX19tYXBfZG9tYWluX3Bh
Z2UocGFnZSkgKyBwZ29mZjsNCj4gKw0KPiArICAgICAgICAgICAgaWYgKCAhKGZsYWdzICYgSFZN
Q09QWV90b19ndWVzdCkgKQ0KPiArICAgICAgICAgICAgew0KPiArICAgICAgICAgICAgICAgIG1l
bWNweShidWYsIHAsIGNvdW50KTsNCj4gKyAgICAgICAgICAgICAgICBodm1lbXVsX3dyaXRlX2Nh
Y2hlKHYsIGdmbl90b19nYWRkcihnZm4pIHwgcGdvZmYsIGJ1ZiwgY291bnQpOw0KPiArICAgICAg
ICAgICAgfQ0KPiArICAgICAgICAgICAgZWxzZSBpZiAoIHAybV9pc19kaXNjYXJkX3dyaXRlKHAy
bXQpICkNCj4gICAgICAgICAgICAgIHsNCj4gICAgICAgICAgICAgICAgICBzdGF0aWMgdW5zaWdu
ZWQgbG9uZyBsYXN0cGFnZTsNCj4gDQo+IEBAIC0zMzExLDEzICszMzI5LDkgQEAgc3RhdGljIGVu
dW0gaHZtX3RyYW5zbGF0aW9uX3Jlc3VsdCBfX2h2bQ0KPiAgICAgICAgICAgICAgICAgICAgICBt
ZW1zZXQocCwgMCwgY291bnQpOw0KPiAgICAgICAgICAgICAgICAgIHBhZ2luZ19tYXJrX3Bmbl9k
aXJ0eSh2LT5kb21haW4sIF9wZm4oZ2ZuX3goZ2ZuKSkpOw0KPiAgICAgICAgICAgICAgfQ0KPiAt
ICAgICAgICB9DQo+IC0gICAgICAgIGVsc2UNCj4gLSAgICAgICAgew0KPiAtICAgICAgICAgICAg
bWVtY3B5KGJ1ZiwgcCwgY291bnQpOw0KPiAtICAgICAgICB9DQo+IA0KPiAtICAgICAgICB1bm1h
cF9kb21haW5fcGFnZShwKTsNCj4gKyAgICAgICAgICAgIHVubWFwX2RvbWFpbl9wYWdlKHApOw0K
PiArICAgICAgICB9DQo+IA0KPiAgICAgICAgICBhZGRyICs9IGNvdW50Ow0KPiAgICAgICAgICBp
ZiAoIGJ1ZiApDQo+IC0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vaHlwZXJjYWxsLmMNCj4gKysrIGIv
eGVuL2FyY2gveDg2L2h2bS9oeXBlcmNhbGwuYw0KPiBAQCAtMjIsNiArMjIsNyBAQA0KPiAgI2lu
Y2x1ZGUgPHhlbi9oeXBlcmNhbGwuaD4NCj4gICNpbmNsdWRlIDx4ZW4vbm9zcGVjLmg+DQo+IA0K
PiArI2luY2x1ZGUgPGFzbS9odm0vZW11bGF0ZS5oPg0KPiAgI2luY2x1ZGUgPGFzbS9odm0vc3Vw
cG9ydC5oPg0KPiANCj4gIHN0YXRpYyBsb25nIGh2bV9tZW1vcnlfb3AoaW50IGNtZCwgWEVOX0dV
RVNUX0hBTkRMRV9QQVJBTSh2b2lkKQ0KPiBhcmcpDQo+IEBAIC0xNTksNiArMTYwLDcgQEAgaW50
IGh2bV9oeXBlcmNhbGwoc3RydWN0IGNwdV91c2VyX3JlZ3MgKg0KPiAgICAgIHN0cnVjdCBkb21h
aW4gKmN1cnJkID0gY3Vyci0+ZG9tYWluOw0KPiAgICAgIGludCBtb2RlID0gaHZtX2d1ZXN0X3g4
Nl9tb2RlKGN1cnIpOw0KPiAgICAgIHVuc2lnbmVkIGxvbmcgZWF4ID0gcmVncy0+ZWF4Ow0KPiAr
ICAgIHVuc2lnbmVkIGludCB0b2tlbjsNCj4gDQo+ICAgICAgc3dpdGNoICggbW9kZSApDQo+ICAg
ICAgew0KPiBAQCAtMTgzLDcgKzE4NSwxOCBAQCBpbnQgaHZtX2h5cGVyY2FsbChzdHJ1Y3QgY3B1
X3VzZXJfcmVncyAqDQo+ICAgICAgfQ0KPiANCj4gICAgICBpZiAoIChlYXggJiAweDgwMDAwMDAw
KSAmJiBpc192aXJpZGlhbl9kb21haW4oY3VycmQpICkNCj4gLSAgICAgICAgcmV0dXJuIHZpcmlk
aWFuX2h5cGVyY2FsbChyZWdzKTsNCj4gKyAgICB7DQo+ICsgICAgICAgIGludCByZXQ7DQo+ICsN
Cj4gKyAgICAgICAgLyogU2VlIGNvbW1lbnQgYmVsb3cuICovDQo+ICsgICAgICAgIHRva2VuID0g
aHZtZW11bF9jYWNoZV9kaXNhYmxlKGN1cnIpOw0KPiArDQo+ICsgICAgICAgIHJldCA9IHZpcmlk
aWFuX2h5cGVyY2FsbChyZWdzKTsNCj4gKw0KPiArICAgICAgICBodm1lbXVsX2NhY2hlX3Jlc3Rv
cmUoY3VyciwgdG9rZW4pOw0KPiArDQo+ICsgICAgICAgIHJldHVybiByZXQ7DQo+ICsgICAgfQ0K
PiANCj4gICAgICBCVUlMRF9CVUdfT04oQVJSQVlfU0laRShodm1faHlwZXJjYWxsX3RhYmxlKSA+
DQo+ICAgICAgICAgICAgICAgICAgIEFSUkFZX1NJWkUoaHlwZXJjYWxsX2FyZ3NfdGFibGUpKTsN
Cj4gQEAgLTIwMiw2ICsyMTUsMTIgQEAgaW50IGh2bV9oeXBlcmNhbGwoc3RydWN0IGNwdV91c2Vy
X3JlZ3MgKg0KPiAgICAgICAgICByZXR1cm4gSFZNX0hDQUxMX2NvbXBsZXRlZDsNCj4gICAgICB9
DQo+IA0KPiArICAgIC8qDQo+ICsgICAgICogQ2FjaGluZyBpcyBpbnRlbmRlZCBmb3IgaW5zdHJ1
Y3Rpb24gZW11bGF0aW9uIG9ubHkuIERpc2FibGUgaXQNCj4gKyAgICAgKiBmb3IgYW55IGFjY2Vz
c2VzIGJ5IGh5cGVyY2FsbCBhcmd1bWVudCBjb3B5LWluIC8gY29weS1vdXQuDQo+ICsgICAgICov
DQo+ICsgICAgdG9rZW4gPSBodm1lbXVsX2NhY2hlX2Rpc2FibGUoY3Vycik7DQo+ICsNCj4gICAg
ICBjdXJyLT5oY2FsbF9wcmVlbXB0ZWQgPSBmYWxzZTsNCj4gDQo+ICAgICAgaWYgKCBtb2RlID09
IDggKQ0KPiBAQCAtMjk1LDYgKzMxNCw4IEBAIGludCBodm1faHlwZXJjYWxsKHN0cnVjdCBjcHVf
dXNlcl9yZWdzICoNCj4gICNlbmRpZg0KPiAgICAgIH0NCj4gDQo+ICsgICAgaHZtZW11bF9jYWNo
ZV9yZXN0b3JlKGN1cnIsIHRva2VuKTsNCj4gKw0KPiAgICAgIEhWTV9EQkdfTE9HKERCR19MRVZF
TF9IQ0FMTCwgImhjYWxsJWx1IC0+ICVseCIsIGVheCwgcmVncy0+cmF4KTsNCj4gDQo+ICAgICAg
aWYgKCBjdXJyLT5oY2FsbF9wcmVlbXB0ZWQgKQ0KPiAtLS0gYS94ZW4vYXJjaC94ODYvaHZtL2lu
dGVyY2VwdC5jDQo+ICsrKyBiL3hlbi9hcmNoL3g4Ni9odm0vaW50ZXJjZXB0LmMNCj4gQEAgLTIw
LDYgKzIwLDcgQEANCj4gICNpbmNsdWRlIDx4ZW4vdHlwZXMuaD4NCj4gICNpbmNsdWRlIDx4ZW4v
c2NoZWQuaD4NCj4gICNpbmNsdWRlIDxhc20vcmVncy5oPg0KPiArI2luY2x1ZGUgPGFzbS9odm0v
ZW11bGF0ZS5oPg0KPiAgI2luY2x1ZGUgPGFzbS9odm0vaHZtLmg+DQo+ICAjaW5jbHVkZSA8YXNt
L2h2bS9zdXBwb3J0Lmg+DQo+ICAjaW5jbHVkZSA8YXNtL2h2bS9kb21haW4uaD4NCj4gQEAgLTE2
Myw2ICsxNjQsOSBAQCBpbnQgaHZtX3Byb2Nlc3NfaW9faW50ZXJjZXB0KGNvbnN0IHN0cnVjDQo+
ICAgICAgICAgIHsNCj4gICAgICAgICAgICAgIGlmICggcC0+ZGF0YV9pc19wdHIgKQ0KPiAgICAg
ICAgICAgICAgew0KPiArICAgICAgICAgICAgICAgIHN0cnVjdCB2Y3B1ICpjdXJyID0gY3VycmVu
dDsNCj4gKyAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQgdG9rZW4gPSBodm1lbXVsX2NhY2hl
X2Rpc2FibGUoY3Vycik7DQo+ICsNCj4gICAgICAgICAgICAgICAgICBkYXRhID0gMDsNCj4gICAg
ICAgICAgICAgICAgICBzd2l0Y2ggKCBodm1fY29weV9mcm9tX2d1ZXN0X3BoeXMoJmRhdGEsIHAt
PmRhdGEgKyBzdGVwICogaSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcC0+c2l6ZSkgKQ0KPiBAQCAtMTc5LDkgKzE4MywxMSBAQCBpbnQgaHZt
X3Byb2Nlc3NfaW9faW50ZXJjZXB0KGNvbnN0IHN0cnVjDQo+ICAgICAgICAgICAgICAgICAgICAg
IEFTU0VSVF9VTlJFQUNIQUJMRSgpOw0KPiAgICAgICAgICAgICAgICAgICAgICAvKiBmYWxsIHRo
cm91Z2ggKi8NCj4gICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KPiAtICAgICAgICAgICAgICAg
ICAgICBkb21haW5fY3Jhc2goY3VycmVudC0+ZG9tYWluKTsNCj4gKyAgICAgICAgICAgICAgICAg
ICAgZG9tYWluX2NyYXNoKGN1cnItPmRvbWFpbik7DQo+ICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiBYODZFTVVMX1VOSEFORExFQUJMRTsNCj4gICAgICAgICAgICAgICAgICB9DQo+ICsNCj4g
KyAgICAgICAgICAgICAgICBodm1lbXVsX2NhY2hlX3Jlc3RvcmUoY3VyciwgdG9rZW4pOw0KPiAg
ICAgICAgICAgICAgfQ0KPiAgICAgICAgICAgICAgZWxzZQ0KPiAgICAgICAgICAgICAgICAgIGRh
dGEgPSBwLT5kYXRhOw0KPiAtLS0gYS94ZW4vYXJjaC94ODYvaHZtL3N2bS9zdm0uYw0KPiArKysg
Yi94ZW4vYXJjaC94ODYvaHZtL3N2bS9zdm0uYw0KPiBAQCAtMTA0MCw2ICsxMDQwLDggQEAgdm9p
ZCBzdm1fdm1lbnRlcl9oZWxwZXIoY29uc3Qgc3RydWN0IGNwdQ0KPiAgICAgIHN0cnVjdCB2Y3B1
ICpjdXJyID0gY3VycmVudDsNCj4gICAgICBzdHJ1Y3Qgdm1jYl9zdHJ1Y3QgKnZtY2IgPSBjdXJy
LT5hcmNoLmh2bS5zdm0udm1jYjsNCj4gDQo+ICsgICAgQVNTRVJUKGh2bWVtdWxfY2FjaGVfZGlz
YWJsZWQoY3VycikpOw0KPiArDQo+ICAgICAgc3ZtX2FzaWRfaGFuZGxlX3ZtcnVuKCk7DQo+IA0K
PiAgICAgIGlmICggdW5saWtlbHkodGJfaW5pdF9kb25lKSApDQo+IC0tLSBhL3hlbi9hcmNoL3g4
Ni9odm0vdm1zaS5jDQo+ICsrKyBiL3hlbi9hcmNoL3g4Ni9odm0vdm1zaS5jDQo+IEBAIC0zNSw2
ICszNSw3IEBADQo+ICAjaW5jbHVkZSA8eGVuL2lycS5oPg0KPiAgI2luY2x1ZGUgPHhlbi92cGNp
Lmg+DQo+ICAjaW5jbHVkZSA8cHVibGljL2h2bS9pb3JlcS5oPg0KPiArI2luY2x1ZGUgPGFzbS9o
dm0vZW11bGF0ZS5oPg0KPiAgI2luY2x1ZGUgPGFzbS9odm0vaW8uaD4NCj4gICNpbmNsdWRlIDxh
c20vaHZtL3ZwaWMuaD4NCj4gICNpbmNsdWRlIDxhc20vaHZtL3ZsYXBpYy5oPg0KPiBAQCAtNjA3
LDYgKzYwOCw3IEBAIHZvaWQgbXNpeF93cml0ZV9jb21wbGV0aW9uKHN0cnVjdCB2Y3B1ICoNCj4g
ICAgICBpZiAoICFjdHJsX2FkZHJlc3MgJiYgc25vb3BfYWRkciAmJg0KPiAgICAgICAgICAgdi0+
YXJjaC5odm0uaHZtX2lvLm1zaXhfc25vb3BfZ3BhICkNCj4gICAgICB7DQo+ICsgICAgICAgIHVu
c2lnbmVkIGludCB0b2tlbiA9IGh2bWVtdWxfY2FjaGVfZGlzYWJsZSh2KTsNCj4gICAgICAgICAg
Y29uc3Qgc3RydWN0IG1zaV9kZXNjICpkZXNjOw0KPiAgICAgICAgICB1aW50MzJfdCBkYXRhOw0K
PiANCj4gQEAgLTYyMSw2ICs2MjMsOCBAQCB2b2lkIG1zaXhfd3JpdGVfY29tcGxldGlvbihzdHJ1
Y3QgdmNwdSAqDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVv
ZihkYXRhKSkgPT0gSFZNVFJBTlNfb2theSAmJg0KPiAgICAgICAgICAgICAgICEoZGF0YSAmIFBD
SV9NU0lYX1ZFQ1RPUl9CSVRNQVNLKSApDQo+ICAgICAgICAgICAgICBjdHJsX2FkZHJlc3MgPSBz
bm9vcF9hZGRyOw0KPiArDQo+ICsgICAgICAgIGh2bWVtdWxfY2FjaGVfcmVzdG9yZSh2LCB0b2tl
bik7DQo+ICAgICAgfQ0KPiANCj4gICAgICBpZiAoICFjdHJsX2FkZHJlc3MgKQ0KPiAtLS0gYS94
ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYw0KPiArKysgYi94ZW4vYXJjaC94ODYvaHZtL3ZteC92
bXguYw0KPiBAQCAtNDM2Miw2ICs0MzYyLDggQEAgYm9vbCB2bXhfdm1lbnRlcl9oZWxwZXIoY29u
c3Qgc3RydWN0IGNwdQ0KPiAgICAgIHN0cnVjdCBodm1fdmNwdV9hc2lkICpwX2FzaWQ7DQo+ICAg
ICAgYm9vbF90IG5lZWRfZmx1c2g7DQo+IA0KPiArICAgIEFTU0VSVChodm1lbXVsX2NhY2hlX2Rp
c2FibGVkKGN1cnIpKTsNCj4gKw0KPiAgICAgIC8qIFNoYWRvdyBFUFRQIGNhbid0IGJlIHVwZGF0
ZWQgaGVyZSBiZWNhdXNlIGlycXMgYXJlIGRpc2FibGVkICovDQo+ICAgICAgIGlmICggbmVzdGVk
aHZtX3ZjcHVfaW5fZ3Vlc3Rtb2RlKGN1cnIpICYmDQo+IHZjcHVfbmVzdGVkaHZtKGN1cnIpLnN0
YWxlX25wMm0gKQ0KPiAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KPiAtLS0gYS94ZW4vaW5jbHVk
ZS9hc20teDg2L2h2bS9lbXVsYXRlLmgNCj4gKysrIGIveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0v
ZW11bGF0ZS5oDQo+IEBAIC0xMyw2ICsxMyw3IEBADQo+ICAjZGVmaW5lIF9fQVNNX1g4Nl9IVk1f
RU1VTEFURV9IX18NCj4gDQo+ICAjaW5jbHVkZSA8eGVuL2Vyci5oPg0KPiArI2luY2x1ZGUgPHhl
bi9zY2hlZC5oPg0KPiAgI2luY2x1ZGUgPGFzbS9odm0vaHZtLmg+DQo+ICAjaW5jbHVkZSA8YXNt
L3g4Nl9lbXVsYXRlLmg+DQo+IA0KPiBAQCAtOTcsNiArOTgsMzkgQEAgaW50IGh2bWVtdWxfZG9f
cGlvX2J1ZmZlcih1aW50MTZfdCBwb3J0LA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
aW50OF90IGRpciwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqYnVmZmVyKTsN
Cj4gDQo+ICsjaWZkZWYgQ09ORklHX0hWTQ0KPiArLyoNCj4gKyAqIFRoZSBjYWNoZSBjb250cm9s
bGVkIGJ5IHRoZSBmdW5jdGlvbnMgYmVsb3cgaXMgbm90IGxpa2UgYW4gb3JkaW5hcnkgQ1BVDQo+
ICsgKiBjYWNoZSwgaS5lLiBhaW1pbmcgdG8gaGVscCBwZXJmb3JtYW5jZSwgYnV0IGEgInNlY3Jl
dCBzdG9yZSIgd2hpY2ggaXMNCj4gKyAqIG5lZWRlZCBmb3IgY29ycmVjdG5lc3MuICBUaGUgaXNz
dWUgaXQgaGVscHMgYWRkcmVzc2luZyBpcyB0aGUgbmVlZCBmb3INCj4gKyAqIHJlLWV4ZWN1dGlv
biBvZiBhbiBpbnNuIChhZnRlciBkYXRhIHdhcyBwcm92aWRlZCBieSBhIGRldmljZSBtb2RlbCkg
dG8NCj4gKyAqIG9ic2VydmUgdGhlIGV4YWN0IHNhbWUgbWVtb3J5IHN0YXRlLCBpLmUuIHRvIHNw
ZWNpZmljYWxseSBub3Qgb2JzZXJ2ZSBhbnkNCj4gKyAqIHVwZGF0ZXMgd2hpY2ggbWF5IGhhdmUg
b2NjdXJyZWQgaW4gdGhlIG1lYW50aW1lIGJ5IG90aGVyIGFnZW50cy4NCj4gKyAqIFRoZXJlZm9y
ZSB0aGlzIGNhY2hlIGdldHMNCj4gKyAqIC0gZW5hYmxlZCB3aGVuIGVtdWxhdGlvbiBvZiBhbiBp
bnNuIHN0YXJ0cywNCj4gKyAqIC0gZGlzYWJsZWQgYWNyb3NzIHByb2Nlc3Npbmcgc2Vjb25kYXJ5
IHRoaW5ncyBsaWtlIGEgaHlwZXJjYWxsIHJlc3VsdGluZw0KPiArICogICBmcm9tIGluc24gZW11
bGF0aW9uLA0KPiArICogLSBkaXNhYmxlZCBhZ2FpbiB3aGVuIGFuIGVtdWxhdGVkIGluc24gaXMg
a25vd24gdG8gbm90IHJlcXVpcmUgYW55DQo+ICsgKiAgIGZ1cnRoZXIgcmUtZXhlY3V0aW9uLg0K
PiArICovDQo+ICtpbnQgX19tdXN0X2NoZWNrIGh2bWVtdWxfY2FjaGVfaW5pdChzdHJ1Y3QgdmNw
dSAqdik7DQo+ICtzdGF0aWMgaW5saW5lIHZvaWQgaHZtZW11bF9jYWNoZV9kZXN0cm95KHN0cnVj
dCB2Y3B1ICp2KQ0KPiArew0KPiArICAgIFhGUkVFKHYtPmFyY2guaHZtLmh2bV9pby5jYWNoZSk7
DQo+ICt9DQo+ICtib29sIGh2bWVtdWxfcmVhZF9jYWNoZShjb25zdCBzdHJ1Y3QgdmNwdSAqLCBw
YWRkcl90IGdwYSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmJ1ZmZlciwgdW5z
aWduZWQgaW50IHNpemUpOw0KPiArdm9pZCBodm1lbXVsX3dyaXRlX2NhY2hlKGNvbnN0IHN0cnVj
dCB2Y3B1ICosIHBhZGRyX3QgZ3BhLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHZvaWQgKmJ1ZmZlciwgdW5zaWduZWQgaW50IHNpemUpOw0KPiArdW5zaWduZWQgaW50IGh2bWVt
dWxfY2FjaGVfZGlzYWJsZShzdHJ1Y3QgdmNwdSAqKTsNCj4gK3ZvaWQgaHZtZW11bF9jYWNoZV9y
ZXN0b3JlKHN0cnVjdCB2Y3B1ICosIHVuc2lnbmVkIGludCB0b2tlbik7DQo+ICsvKiBGb3IgdXNl
IGluIEFTU0VSVCgpcyBvbmx5OiAqLw0KPiArc3RhdGljIGlubGluZSBib29sIGh2bWVtdWxfY2Fj
aGVfZGlzYWJsZWQoc3RydWN0IHZjcHUgKnYpDQo+ICt7DQo+ICsgICAgcmV0dXJuIGh2bWVtdWxf
Y2FjaGVfZGlzYWJsZSh2KSA9PSBodm1lbXVsX2NhY2hlX2Rpc2FibGUodik7DQo+ICt9DQo+ICsj
ZW5kaWYNCj4gKw0KPiAgdm9pZCBodm1fZHVtcF9lbXVsYXRpb25fc3RhdGUoY29uc3QgY2hhciAq
bG9nbHZsLCBjb25zdCBjaGFyICpwcmVmaXgsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgaHZtX2VtdWxhdGVfY3R4dCAqaHZtZW11bF9jdHh0LCBpbnQgcmMpOw0KPiAN
Cj4gLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vdmNwdS5oDQo+ICsrKyBiL3hlbi9pbmNs
dWRlL2FzbS14ODYvaHZtL3ZjcHUuaA0KPiBAQCAtNzcsNiArNzcsOCBAQCBzdHJ1Y3QgaHZtX3Zj
cHVfaW8gew0KPiAgICAgIC8qIEZvciByZXRyaWVzIHdlIHNob3VsZG4ndCByZS1mZXRjaCB0aGUg
aW5zdHJ1Y3Rpb24uICovDQo+ICAgICAgdW5zaWduZWQgaW50IG1taW9faW5zbl9ieXRlczsNCj4g
ICAgICB1bnNpZ25lZCBjaGFyIG1taW9faW5zblsxNl07DQo+ICsgICAgc3RydWN0IGh2bWVtdWxf
Y2FjaGUgKmNhY2hlOw0KPiArDQo+ICAgICAgLyoNCj4gICAgICAgKiBGb3Igc3RyaW5nIGluc3Ry
dWN0aW9uIGVtdWxhdGlvbiB3ZSBuZWVkIHRvIGJlIGFibGUgdG8gc2lnbmFsIGENCj4gICAgICAg
KiBuZWNlc3NhcnkgcmV0cnkgdGhyb3VnaCBvdGhlciB0aGFuIGZ1bmN0aW9uIHJldHVybiBjb2Rl
cy4NCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1k
ZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8v
bGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id E399C118D0F
	for <lists+xen-devel@lfdr.de>; Tue, 10 Dec 2019 16:52:30 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1iehlU-0003zu-68; Tue, 10 Dec 2019 15:49:32 +0000
Received: from us1-rack-iad1.inumbo.com ([172.99.69.81])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=A1/D=2A=gmail.com=rosbrookn@srs-us1.protection.inumbo.net>)
 id 1iehlS-0003z0-UV
 for xen-devel@lists.xenproject.org; Tue, 10 Dec 2019 15:49:30 +0000
X-Inumbo-ID: 7aa1e862-1b64-11ea-a1e1-bc764e2007e4
Received: from mail-qk1-x744.google.com (unknown [2607:f8b0:4864:20::744])
 by us1-rack-iad1.inumbo.com (Halon) with ESMTPS
 id 7aa1e862-1b64-11ea-a1e1-bc764e2007e4;
 Tue, 10 Dec 2019 15:48:15 +0000 (UTC)
Received: by mail-qk1-x744.google.com with SMTP id c16so8378823qko.6
 for <xen-devel@lists.xenproject.org>; Tue, 10 Dec 2019 07:48:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=BudUVN1eN5Wzy8WDafjhGteC9aUwDbyqCo7hMdaiTi4=;
 b=hBUQWIAsSqLRaX/+47gL8R4ajDiKDMQaiDl3I/ANkAIPlAXckhaQACMZo7LyoNkMyF
 FWy/G0zFLIgM5WRrD4+YtSlutsz6W4BsSk0eLMMsv488zu8dCk3CNfgkal5sEOYnzF/w
 utaZ15Q971S3dQZbC1hS2xciXpwcWP67hAzM9DCBjnvDh5AowLbzFNYdTs1PO+2aq5NM
 TnszsZXPp6HnWekb1fjHUBTWzQaS+z+DdvAxHy/HEI2/+1QhfThOM28tQcHfu6/z4UVv
 MqEfJA4ImlWIZn5+bvgxVL8e57cmOwT1z/QoEcPYRd9dJ6u79n9sWp/qkc27jokYlzq3
 cf9Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=BudUVN1eN5Wzy8WDafjhGteC9aUwDbyqCo7hMdaiTi4=;
 b=fc9Zz7r9JaVBGucFzAvbhP4Bcq3gSyd2f7t5Ng80fTv5zt/0ZKyPCXHIqPxqsj+D2V
 qIMotjfSgDBAMzTViR9dba1aSqGWyfb4i/tRjTtN8zvcJAFztR948dZCeCgWy31x0Aeq
 EKyI2UvBFgEmATgwYUq8/+vMDL2VkNB1zZuAPg10WXVSH3CKbdoYbINifpquU4HDyso0
 gdVS3FSRraoEfCPDQhRkP/hss2PtCwispEaRuTrM2x8Mg902nO4i8A1/zwqFkHJO8H+R
 i3fz0tfE6atQ3Do2KmPgOfvOg0gLgnAafJRYPQtLVaU0/ZRGbKNwHxyFO8jVW2E2luH8
 xMbw==
X-Gm-Message-State: APjAAAXiXlFy/lg85uRsCzI/clMJPB9lMJWrgvpF9R7MdVbTAWCP15La
 6gvnE2xNka55JCTQcCzdaQD/Urjk
X-Google-Smtp-Source: APXvYqzB0N4eExJYGv9dRT2vsH6DI+zs+NhTKGG/Rv7pGEw2Go+Eptaf5peHaETuc6uiie/S3AnHzA==
X-Received: by 2002:ae9:ec03:: with SMTP id h3mr10693513qkg.369.1575992894657; 
 Tue, 10 Dec 2019 07:48:14 -0800 (PST)
Received: from five.crux.rad.ainfosec.com (209-217-208-226.northland.net.
 [209.217.208.226])
 by smtp.googlemail.com with ESMTPSA id m29sm1247848qtf.1.2019.12.10.07.48.13
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 10 Dec 2019 07:48:13 -0800 (PST)
From: Nick Rosbrook <rosbrookn@gmail.com>
To: xen-devel@lists.xenproject.org
Date: Tue, 10 Dec 2019 10:47:35 -0500
Message-Id: <d9faff83d9d8a4c035669dd76ea18d265b6752a7.1575990937.git.rosbrookn@ainfosec.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <cover.1575990937.git.rosbrookn@ainfosec.com>
References: <cover.1575990937.git.rosbrookn@ainfosec.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v3 20/22] golang/xenlight: implement array Go to
 C marshaling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Nick Rosbrook <rosbrookn@ainfosec.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, kerriganb@ainfosec.com,
 George Dunlap <george.dunlap@citrix.com>, Wei Liu <wl@xen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

RnJvbTogTmljayBSb3Nicm9vayA8cm9zYnJvb2tuQGFpbmZvc2VjLmNvbT4KClNpZ25lZC1vZmYt
Ynk6IE5pY2sgUm9zYnJvb2sgPHJvc2Jyb29rbkBhaW5mb3NlYy5jb20+Ci0tLQogdG9vbHMvZ29s
YW5nL3hlbmxpZ2h0L2dlbmdvdHlwZXMucHkgIHwgIDQ0ICsrKy0KIHRvb2xzL2dvbGFuZy94ZW5s
aWdodC9oZWxwZXJzLmdlbi5nbyB8IDM1OSArKysrKysrKysrKysrKysrKysrKysrKysrKysKIDIg
ZmlsZXMgY2hhbmdlZCwgNDAyIGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24oLSkKCmRpZmYgLS1n
aXQgYS90b29scy9nb2xhbmcveGVubGlnaHQvZ2VuZ290eXBlcy5weSBiL3Rvb2xzL2dvbGFuZy94
ZW5saWdodC9nZW5nb3R5cGVzLnB5CmluZGV4IDE4MzlhYzE0YjYuLjI0ZDI3ZTMwYWQgMTAwNjQ0
Ci0tLSBhL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CisrKyBiL3Rvb2xzL2dv
bGFuZy94ZW5saWdodC9nZW5nb3R5cGVzLnB5CkBAIC00NTgsNyArNDU4LDcgQEAgZGVmIHhlbmxp
Z2h0X2dvbGFuZ19kZWZpbmVfdG9fQyh0eSA9IE5vbmUsIHR5cGVuYW1lID0gTm9uZSwgbmVzdGVk
ID0gRmFsc2UpOgogICAgIGZvciBmIGluIHR5LmZpZWxkczoKICAgICAgICAgaWYgZi50eXBlLnR5
cGVuYW1lIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShmLnR5cGUsIGlk
bC5BcnJheSk6Ci0gICAgICAgICAgICAgICAgIyBUT0RPCisgICAgICAgICAgICAgICAgcyArPSB4
ZW5saWdodF9nb2xhbmdfYXJyYXlfdG9fQyhmLCB0eS5kaXNwb3NlX2ZuKQogICAgICAgICAgICAg
ICAgIGNvbnRpbnVlCiAKICAgICAgICAgICAgIGdvdHlwZW5hbWUgPSB4ZW5saWdodF9nb2xhbmdf
Zm10X25hbWUoZi50eXBlLnR5cGVuYW1lKQpAQCAtNTg5LDYgKzU4OSw0OCBAQCBkZWYgeGVubGln
aHRfZ29sYW5nX3VuaW9uX3RvX0ModHkgPSBOb25lLCB1bmlvbl9uYW1lID0gJycsCiAKICAgICBy
ZXR1cm4gcwogCitkZWYgeGVubGlnaHRfZ29sYW5nX2FycmF5X3RvX0ModHkgPSBOb25lLCBkaXNw
b3NlX2ZuID0gJycpOgorICAgIHMgPSAnJworCisgICAgZ290eXBlbmFtZSA9IHhlbmxpZ2h0X2dv
bGFuZ19mbXRfbmFtZSh0eS50eXBlLmVsZW1fdHlwZS50eXBlbmFtZSkKKyAgICBnb25hbWUgICAg
ID0geGVubGlnaHRfZ29sYW5nX2ZtdF9uYW1lKHR5Lm5hbWUpCisgICAgY3R5cGVuYW1lICA9IHR5
LnR5cGUuZWxlbV90eXBlLnR5cGVuYW1lCisgICAgY25hbWUgICAgICA9IHR5Lm5hbWUKKyAgICBj
bGVudmFyICAgID0gdHkudHlwZS5sZW52YXIubmFtZQorICAgIGdvbGVudmFyICAgPSB4ZW5saWdo
dF9nb2xhbmdfZm10X25hbWUoY2xlbnZhcixleHBvcnRlZD1GYWxzZSkKKworICAgIGlzX2VudW0g
PSBpc2luc3RhbmNlKHR5LnR5cGUuZWxlbV90eXBlLGlkbC5FbnVtZXJhdGlvbikKKyAgICBpZiBn
b3R5cGVuYW1lIGluIGdvX2J1aWx0aW5fdHlwZXMgb3IgaXNfZW51bToKKyAgICAgICAgcyArPSAn
e30gOj0gbGVuKHgue30pXG4nLmZvcm1hdChnb2xlbnZhcixnb25hbWUpCisgICAgICAgIHMgKz0g
J3hjLnt9ID0gKCpDLnt9KShDLm1hbGxvYyhDLnNpemVfdCh7fSp7fSkpKVxuJy5mb3JtYXQoY25h
bWUsY3R5cGVuYW1lLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGdvbGVudmFyLGdvbGVudmFyKQorICAgICAgICBzICs9
ICd4Yy57fSA9IEMuaW50KHt9KVxuJy5mb3JtYXQoY2xlbnZhcixnb2xlbnZhcikKKyAgICAgICAg
cyArPSAnY3t9IDo9ICgqWzE8PDI4XUMue30pKHVuc2FmZS5Qb2ludGVyKHhjLnt9KSlbOnt9Ont9
XVxuJy5mb3JtYXQoZ29uYW1lLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eXBlbmFtZSxjbmFtZSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBnb2xlbnZhcixnb2xlbnZhcikKKyAgICAgICAgcyArPSAnZm9yIGksdiA6PSByYW5n
ZSB4Lnt9IHt7XG4nLmZvcm1hdChnb25hbWUpCisgICAgICAgIHMgKz0gJ2N7fVtpXSA9IEMue30o
dilcbicuZm9ybWF0KGdvbmFtZSxjdHlwZW5hbWUpCisgICAgICAgIHMgKz0gJ31cbicKKworICAg
ICAgICByZXR1cm4gcworCisgICAgcyArPSAne30gOj0gbGVuKHgue30pXG4nLmZvcm1hdChnb2xl
bnZhcixnb25hbWUpCisgICAgcyArPSAneGMue30gPSAoKkMue30pKEMubWFsbG9jKEMudWxvbmco
e30pKkMuc2l6ZW9mX3t9KSlcbicuZm9ybWF0KGNuYW1lLGN0eXBlbmFtZSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
b2xlbnZhcixjdHlwZW5hbWUpCisgICAgcyArPSAneGMue30gPSBDLmludCh7fSlcbicuZm9ybWF0
KGNsZW52YXIsZ29sZW52YXIpCisgICAgcyArPSAnY3t9IDo9ICgqWzE8PDI4XUMue30pKHVuc2Fm
ZS5Qb2ludGVyKHhjLnt9KSlbOnt9Ont9XVxuJy5mb3JtYXQoZ29uYW1lLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGN0eXBlbmFtZSxjbmFtZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb2xlbnZhcixnb2xlbnZhcikK
KyAgICBzICs9ICdmb3IgaSx2IDo9IHJhbmdlIHgue30ge3tcbicuZm9ybWF0KGdvbmFtZSkKKyAg
ICBzICs9ICd0bXAsIGVyciA6PSB2LnRvQygpXG4nCisgICAgcyArPSAnaWYgZXJyICE9IG5pbCB7
XG4nCisgICAgcyArPSAnQy57fSgmeGMpXG4nLmZvcm1hdChkaXNwb3NlX2ZuKQorICAgIHMgKz0g
J3JldHVybiB4YyxlcnJcbn1cbicKKyAgICBzICs9ICdje31baV0gPSB0bXBcbicuZm9ybWF0KGdv
bmFtZSkKKyAgICBzICs9ICd9XG4nCisKKyAgICByZXR1cm4gcworCiBkZWYgeGVubGlnaHRfZ29s
YW5nX2ZtdF9uYW1lKG5hbWUsIGV4cG9ydGVkID0gVHJ1ZSk6CiAgICAgIiIiCiAgICAgVGFrZSBh
IGdpdmVuIHR5cGUgbmFtZSBhbmQgcmV0dXJuIGFuCmRpZmYgLS1naXQgYS90b29scy9nb2xhbmcv
eGVubGlnaHQvaGVscGVycy5nZW4uZ28gYi90b29scy9nb2xhbmcveGVubGlnaHQvaGVscGVycy5n
ZW4uZ28KaW5kZXggNzNhZDVlOTc2MS4uOThiNGJiYTRiMiAxMDA2NDQKLS0tIGEvdG9vbHMvZ29s
YW5nL3hlbmxpZ2h0L2hlbHBlcnMuZ2VuLmdvCisrKyBiL3Rvb2xzL2dvbGFuZy94ZW5saWdodC9o
ZWxwZXJzLmdlbi5nbwpAQCAtNTQ1LDYgKzU0NSwxOCBAQCBmdW5jICh4ICpWY3B1U2NoZWRQYXJh
bXMpIGZyb21DKHhjICpDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zKSBlcnJvciB7CiBmdW5jICh4
ICpWY3B1U2NoZWRQYXJhbXMpIHRvQygpICh4YyBDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zLCBl
cnIgZXJyb3IpIHsKIAlDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zX2luaXQoJnhjKQogCXhjLnNj
aGVkID0gQy5saWJ4bF9zY2hlZHVsZXIoeC5TY2hlZCkKKwludW1WY3B1cyA6PSBsZW4oeC5WY3B1
cykKKwl4Yy52Y3B1cyA9ICgqQy5saWJ4bF9zY2hlZF9wYXJhbXMpKEMubWFsbG9jKEMudWxvbmco
bnVtVmNwdXMpICogQy5zaXplb2ZfbGlieGxfc2NoZWRfcGFyYW1zKSkKKwl4Yy5udW1fdmNwdXMg
PSBDLmludChudW1WY3B1cykKKwljVmNwdXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3NjaGVkX3Bh
cmFtcykodW5zYWZlLlBvaW50ZXIoeGMudmNwdXMpKVs6bnVtVmNwdXM6bnVtVmNwdXNdCisJZm9y
IGksIHYgOj0gcmFuZ2UgeC5WY3B1cyB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYgZXJy
ICE9IG5pbCB7CisJCQlDLmxpYnhsX3ZjcHVfc2NoZWRfcGFyYW1zX2Rpc3Bvc2UoJnhjKQorCQkJ
cmV0dXJuIHhjLCBlcnIKKwkJfQorCQljVmNwdXNbaV0gPSB0bXAKKwl9CiAJcmV0dXJuIHhjLCBu
aWwKIH0KIApAQCAtNTkzLDYgKzYwNSwxMyBAQCBmdW5jICh4ICpWbm9kZUluZm8pIGZyb21DKHhj
ICpDLmxpYnhsX3Zub2RlX2luZm8pIGVycm9yIHsKIGZ1bmMgKHggKlZub2RlSW5mbykgdG9DKCkg
KHhjIEMubGlieGxfdm5vZGVfaW5mbywgZXJyIGVycm9yKSB7CiAJQy5saWJ4bF92bm9kZV9pbmZv
X2luaXQoJnhjKQogCXhjLm1lbWtiID0gQy51aW50NjRfdCh4Lk1lbWtiKQorCW51bURpc3RhbmNl
cyA6PSBsZW4oeC5EaXN0YW5jZXMpCisJeGMuZGlzdGFuY2VzID0gKCpDLnVpbnQzMl90KShDLm1h
bGxvYyhDLnNpemVfdChudW1EaXN0YW5jZXMgKiBudW1EaXN0YW5jZXMpKSkKKwl4Yy5udW1fZGlz
dGFuY2VzID0gQy5pbnQobnVtRGlzdGFuY2VzKQorCWNEaXN0YW5jZXMgOj0gKCpbMSA8PCAyOF1D
LnVpbnQzMl90KSh1bnNhZmUuUG9pbnRlcih4Yy5kaXN0YW5jZXMpKVs6bnVtRGlzdGFuY2VzOm51
bURpc3RhbmNlc10KKwlmb3IgaSwgdiA6PSByYW5nZSB4LkRpc3RhbmNlcyB7CisJCWNEaXN0YW5j
ZXNbaV0gPSBDLnVpbnQzMl90KHYpCisJfQogCXhjLnBub2RlID0gQy51aW50MzJfdCh4LlBub2Rl
KQogCXhjLnZjcHVzLCBlcnIgPSB4LlZjcHVzLnRvQygpCiAJaWYgZXJyICE9IG5pbCB7CkBAIC05
NDYsNiArOTY1LDMwIEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5mbykgdG9DKCkgKHhjIEMubGli
eGxfZG9tYWluX2J1aWxkX2luZm8sIGVyciBlcnJvcikgewogCQlDLmxpYnhsX2RvbWFpbl9idWls
ZF9pbmZvX2Rpc3Bvc2UoJnhjKQogCQlyZXR1cm4geGMsIGVycgogCX0KKwludW1WY3B1SGFyZEFm
ZmluaXR5IDo9IGxlbih4LlZjcHVIYXJkQWZmaW5pdHkpCisJeGMudmNwdV9oYXJkX2FmZmluaXR5
ID0gKCpDLmxpYnhsX2JpdG1hcCkoQy5tYWxsb2MoQy51bG9uZyhudW1WY3B1SGFyZEFmZmluaXR5
KSAqIEMuc2l6ZW9mX2xpYnhsX2JpdG1hcCkpCisJeGMubnVtX3ZjcHVfaGFyZF9hZmZpbml0eSA9
IEMuaW50KG51bVZjcHVIYXJkQWZmaW5pdHkpCisJY1ZjcHVIYXJkQWZmaW5pdHkgOj0gKCpbMSA8
PCAyOF1DLmxpYnhsX2JpdG1hcCkodW5zYWZlLlBvaW50ZXIoeGMudmNwdV9oYXJkX2FmZmluaXR5
KSlbOm51bVZjcHVIYXJkQWZmaW5pdHk6bnVtVmNwdUhhcmRBZmZpbml0eV0KKwlmb3IgaSwgdiA6
PSByYW5nZSB4LlZjcHVIYXJkQWZmaW5pdHkgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlm
IGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykK
KwkJCXJldHVybiB4YywgZXJyCisJCX0KKwkJY1ZjcHVIYXJkQWZmaW5pdHlbaV0gPSB0bXAKKwl9
CisJbnVtVmNwdVNvZnRBZmZpbml0eSA6PSBsZW4oeC5WY3B1U29mdEFmZmluaXR5KQorCXhjLnZj
cHVfc29mdF9hZmZpbml0eSA9ICgqQy5saWJ4bF9iaXRtYXApKEMubWFsbG9jKEMudWxvbmcobnVt
VmNwdVNvZnRBZmZpbml0eSkgKiBDLnNpemVvZl9saWJ4bF9iaXRtYXApKQorCXhjLm51bV92Y3B1
X3NvZnRfYWZmaW5pdHkgPSBDLmludChudW1WY3B1U29mdEFmZmluaXR5KQorCWNWY3B1U29mdEFm
ZmluaXR5IDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9iaXRtYXApKHVuc2FmZS5Qb2ludGVyKHhjLnZj
cHVfc29mdF9hZmZpbml0eSkpWzpudW1WY3B1U29mdEFmZmluaXR5Om51bVZjcHVTb2Z0QWZmaW5p
dHldCisJZm9yIGksIHYgOj0gcmFuZ2UgeC5WY3B1U29mdEFmZmluaXR5IHsKKwkJdG1wLCBlcnIg
Oj0gdi50b0MoKQorCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZG9tYWluX2J1aWxkX2lu
Zm9fZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgorCQl9CisJCWNWY3B1U29mdEFmZmlu
aXR5W2ldID0gdG1wCisJfQogCXhjLm51bWFfcGxhY2VtZW50LCBlcnIgPSB4Lk51bWFQbGFjZW1l
bnQudG9DKCkKIAlpZiBlcnIgIT0gbmlsIHsKIAkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19k
aXNwb3NlKCZ4YykKQEAgLTk3Niw2ICsxMDE5LDE4IEBAIGZ1bmMgKHggKkRvbWFpbkJ1aWxkSW5m
bykgdG9DKCkgKHhjIEMubGlieGxfZG9tYWluX2J1aWxkX2luZm8sIGVyciBlcnJvcikgewogCQly
ZXR1cm4geGMsIGVycgogCX0KIAl4Yy5ibGtkZXZfc3RhcnQgPSBDLkNTdHJpbmcoeC5CbGtkZXZT
dGFydCkKKwludW1WbnVtYU5vZGVzIDo9IGxlbih4LlZudW1hTm9kZXMpCisJeGMudm51bWFfbm9k
ZXMgPSAoKkMubGlieGxfdm5vZGVfaW5mbykoQy5tYWxsb2MoQy51bG9uZyhudW1WbnVtYU5vZGVz
KSAqIEMuc2l6ZW9mX2xpYnhsX3Zub2RlX2luZm8pKQorCXhjLm51bV92bnVtYV9ub2RlcyA9IEMu
aW50KG51bVZudW1hTm9kZXMpCisJY1ZudW1hTm9kZXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3Zu
b2RlX2luZm8pKHVuc2FmZS5Qb2ludGVyKHhjLnZudW1hX25vZGVzKSlbOm51bVZudW1hTm9kZXM6
bnVtVm51bWFOb2Rlc10KKwlmb3IgaSwgdiA6PSByYW5nZSB4LlZudW1hTm9kZXMgeworCQl0bXAs
IGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5fYnVp
bGRfaW5mb19kaXNwb3NlKCZ4YykKKwkJCXJldHVybiB4YywgZXJyCisJCX0KKwkJY1ZudW1hTm9k
ZXNbaV0gPSB0bXAKKwl9CiAJeGMubWF4X2dyYW50X2ZyYW1lcyA9IEMudWludDMyX3QoeC5NYXhH
cmFudEZyYW1lcykKIAl4Yy5tYXhfbWFwdHJhY2tfZnJhbWVzID0gQy51aW50MzJfdCh4Lk1heE1h
cHRyYWNrRnJhbWVzKQogCXhjLmRldmljZV9tb2RlbF92ZXJzaW9uID0gQy5saWJ4bF9kZXZpY2Vf
bW9kZWxfdmVyc2lvbih4LkRldmljZU1vZGVsVmVyc2lvbikKQEAgLTEwMDgsNiArMTA2MywzNyBA
QCBmdW5jICh4ICpEb21haW5CdWlsZEluZm8pIHRvQygpICh4YyBDLmxpYnhsX2RvbWFpbl9idWls
ZF9pbmZvLCBlcnIgZXJyb3IpIHsKIAkJQy5saWJ4bF9kb21haW5fYnVpbGRfaW5mb19kaXNwb3Nl
KCZ4YykKIAkJcmV0dXJuIHhjLCBlcnIKIAl9CisJbnVtSW9wb3J0cyA6PSBsZW4oeC5Jb3BvcnRz
KQorCXhjLmlvcG9ydHMgPSAoKkMubGlieGxfaW9wb3J0X3JhbmdlKShDLm1hbGxvYyhDLnVsb25n
KG51bUlvcG9ydHMpICogQy5zaXplb2ZfbGlieGxfaW9wb3J0X3JhbmdlKSkKKwl4Yy5udW1faW9w
b3J0cyA9IEMuaW50KG51bUlvcG9ydHMpCisJY0lvcG9ydHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhs
X2lvcG9ydF9yYW5nZSkodW5zYWZlLlBvaW50ZXIoeGMuaW9wb3J0cykpWzpudW1Jb3BvcnRzOm51
bUlvcG9ydHNdCisJZm9yIGksIHYgOj0gcmFuZ2UgeC5Jb3BvcnRzIHsKKwkJdG1wLCBlcnIgOj0g
di50b0MoKQorCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZG9tYWluX2J1aWxkX2luZm9f
ZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgorCQl9CisJCWNJb3BvcnRzW2ldID0gdG1w
CisJfQorCW51bUlycXMgOj0gbGVuKHguSXJxcykKKwl4Yy5pcnFzID0gKCpDLnVpbnQzMl90KShD
Lm1hbGxvYyhDLnNpemVfdChudW1JcnFzICogbnVtSXJxcykpKQorCXhjLm51bV9pcnFzID0gQy5p
bnQobnVtSXJxcykKKwljSXJxcyA6PSAoKlsxIDw8IDI4XUMudWludDMyX3QpKHVuc2FmZS5Qb2lu
dGVyKHhjLmlycXMpKVs6bnVtSXJxczpudW1JcnFzXQorCWZvciBpLCB2IDo9IHJhbmdlIHguSXJx
cyB7CisJCWNJcnFzW2ldID0gQy51aW50MzJfdCh2KQorCX0KKwludW1Jb21lbSA6PSBsZW4oeC5J
b21lbSkKKwl4Yy5pb21lbSA9ICgqQy5saWJ4bF9pb21lbV9yYW5nZSkoQy5tYWxsb2MoQy51bG9u
ZyhudW1Jb21lbSkgKiBDLnNpemVvZl9saWJ4bF9pb21lbV9yYW5nZSkpCisJeGMubnVtX2lvbWVt
ID0gQy5pbnQobnVtSW9tZW0pCisJY0lvbWVtIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9pb21lbV9y
YW5nZSkodW5zYWZlLlBvaW50ZXIoeGMuaW9tZW0pKVs6bnVtSW9tZW06bnVtSW9tZW1dCisJZm9y
IGksIHYgOj0gcmFuZ2UgeC5Jb21lbSB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYgZXJy
ICE9IG5pbCB7CisJCQlDLmxpYnhsX2RvbWFpbl9idWlsZF9pbmZvX2Rpc3Bvc2UoJnhjKQorCQkJ
cmV0dXJuIHhjLCBlcnIKKwkJfQorCQljSW9tZW1baV0gPSB0bXAKKwl9CiAJeGMuY2xhaW1fbW9k
ZSwgZXJyID0geC5DbGFpbU1vZGUudG9DKCkKIAlpZiBlcnIgIT0gbmlsIHsKIAkJQy5saWJ4bF9k
b21haW5fYnVpbGRfaW5mb19kaXNwb3NlKCZ4YykKQEAgLTE4MzUsNiArMTkyMSwxOCBAQCBmdW5j
ICh4ICpEZXZpY2VWZGlzcGwpIHRvQygpICh4YyBDLmxpYnhsX2RldmljZV92ZGlzcGwsIGVyciBl
cnJvcikgewogCXhjLmJhY2tlbmRfZG9tbmFtZSA9IEMuQ1N0cmluZyh4LkJhY2tlbmREb21uYW1l
KQogCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQogCXhjLmJlX2FsbG9jID0gQy5i
b29sKHguQmVBbGxvYykKKwludW1Db25uZWN0b3JzIDo9IGxlbih4LkNvbm5lY3RvcnMpCisJeGMu
Y29ubmVjdG9ycyA9ICgqQy5saWJ4bF9jb25uZWN0b3JfcGFyYW0pKEMubWFsbG9jKEMudWxvbmco
bnVtQ29ubmVjdG9ycykgKiBDLnNpemVvZl9saWJ4bF9jb25uZWN0b3JfcGFyYW0pKQorCXhjLm51
bV9jb25uZWN0b3JzID0gQy5pbnQobnVtQ29ubmVjdG9ycykKKwljQ29ubmVjdG9ycyA6PSAoKlsx
IDw8IDI4XUMubGlieGxfY29ubmVjdG9yX3BhcmFtKSh1bnNhZmUuUG9pbnRlcih4Yy5jb25uZWN0
b3JzKSlbOm51bUNvbm5lY3RvcnM6bnVtQ29ubmVjdG9yc10KKwlmb3IgaSwgdiA6PSByYW5nZSB4
LkNvbm5lY3RvcnMgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgewor
CQkJQy5saWJ4bF9kZXZpY2VfdmRpc3BsX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIK
KwkJfQorCQljQ29ubmVjdG9yc1tpXSA9IHRtcAorCX0KIAlyZXR1cm4geGMsIG5pbAogfQogCkBA
IC0xODYwLDYgKzE5NTgsMjAgQEAgZnVuYyAoeCAqVnNuZFBhcmFtcykgZnJvbUMoeGMgKkMubGli
eGxfdnNuZF9wYXJhbXMpIGVycm9yIHsKIAogZnVuYyAoeCAqVnNuZFBhcmFtcykgdG9DKCkgKHhj
IEMubGlieGxfdnNuZF9wYXJhbXMsIGVyciBlcnJvcikgewogCUMubGlieGxfdnNuZF9wYXJhbXNf
aW5pdCgmeGMpCisJbnVtU2FtcGxlUmF0ZXMgOj0gbGVuKHguU2FtcGxlUmF0ZXMpCisJeGMuc2Ft
cGxlX3JhdGVzID0gKCpDLnVpbnQzMl90KShDLm1hbGxvYyhDLnNpemVfdChudW1TYW1wbGVSYXRl
cyAqIG51bVNhbXBsZVJhdGVzKSkpCisJeGMubnVtX3NhbXBsZV9yYXRlcyA9IEMuaW50KG51bVNh
bXBsZVJhdGVzKQorCWNTYW1wbGVSYXRlcyA6PSAoKlsxIDw8IDI4XUMudWludDMyX3QpKHVuc2Fm
ZS5Qb2ludGVyKHhjLnNhbXBsZV9yYXRlcykpWzpudW1TYW1wbGVSYXRlczpudW1TYW1wbGVSYXRl
c10KKwlmb3IgaSwgdiA6PSByYW5nZSB4LlNhbXBsZVJhdGVzIHsKKwkJY1NhbXBsZVJhdGVzW2ld
ID0gQy51aW50MzJfdCh2KQorCX0KKwludW1TYW1wbGVGb3JtYXRzIDo9IGxlbih4LlNhbXBsZUZv
cm1hdHMpCisJeGMuc2FtcGxlX2Zvcm1hdHMgPSAoKkMubGlieGxfdnNuZF9wY21fZm9ybWF0KShD
Lm1hbGxvYyhDLnNpemVfdChudW1TYW1wbGVGb3JtYXRzICogbnVtU2FtcGxlRm9ybWF0cykpKQor
CXhjLm51bV9zYW1wbGVfZm9ybWF0cyA9IEMuaW50KG51bVNhbXBsZUZvcm1hdHMpCisJY1NhbXBs
ZUZvcm1hdHMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3ZzbmRfcGNtX2Zvcm1hdCkodW5zYWZlLlBv
aW50ZXIoeGMuc2FtcGxlX2Zvcm1hdHMpKVs6bnVtU2FtcGxlRm9ybWF0czpudW1TYW1wbGVGb3Jt
YXRzXQorCWZvciBpLCB2IDo9IHJhbmdlIHguU2FtcGxlRm9ybWF0cyB7CisJCWNTYW1wbGVGb3Jt
YXRzW2ldID0gQy5saWJ4bF92c25kX3BjbV9mb3JtYXQodikKKwl9CiAJeGMuY2hhbm5lbHNfbWlu
ID0gQy51aW50MzJfdCh4LkNoYW5uZWxzTWluKQogCXhjLmNoYW5uZWxzX21heCA9IEMudWludDMy
X3QoeC5DaGFubmVsc01heCkKIAl4Yy5idWZmZXJfc2l6ZSA9IEMudWludDMyX3QoeC5CdWZmZXJT
aXplKQpAQCAtMTkxNSw2ICsyMDI3LDE4IEBAIGZ1bmMgKHggKlZzbmRQY20pIHRvQygpICh4YyBD
LmxpYnhsX3ZzbmRfcGNtLCBlcnIgZXJyb3IpIHsKIAkJQy5saWJ4bF92c25kX3BjbV9kaXNwb3Nl
KCZ4YykKIAkJcmV0dXJuIHhjLCBlcnIKIAl9CisJbnVtVnNuZFN0cmVhbXMgOj0gbGVuKHguU3Ry
ZWFtcykKKwl4Yy5zdHJlYW1zID0gKCpDLmxpYnhsX3ZzbmRfc3RyZWFtKShDLm1hbGxvYyhDLnVs
b25nKG51bVZzbmRTdHJlYW1zKSAqIEMuc2l6ZW9mX2xpYnhsX3ZzbmRfc3RyZWFtKSkKKwl4Yy5u
dW1fdnNuZF9zdHJlYW1zID0gQy5pbnQobnVtVnNuZFN0cmVhbXMpCisJY1N0cmVhbXMgOj0gKCpb
MSA8PCAyOF1DLmxpYnhsX3ZzbmRfc3RyZWFtKSh1bnNhZmUuUG9pbnRlcih4Yy5zdHJlYW1zKSlb
Om51bVZzbmRTdHJlYW1zOm51bVZzbmRTdHJlYW1zXQorCWZvciBpLCB2IDo9IHJhbmdlIHguU3Ry
ZWFtcyB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxp
YnhsX3ZzbmRfcGNtX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIKKwkJfQorCQljU3Ry
ZWFtc1tpXSA9IHRtcAorCX0KIAlyZXR1cm4geGMsIG5pbAogfQogCkBAIC0xOTUzLDYgKzIwNzcs
MTggQEAgZnVuYyAoeCAqRGV2aWNlVnNuZCkgdG9DKCkgKHhjIEMubGlieGxfZGV2aWNlX3ZzbmQs
IGVyciBlcnJvcikgewogCQlDLmxpYnhsX2RldmljZV92c25kX2Rpc3Bvc2UoJnhjKQogCQlyZXR1
cm4geGMsIGVycgogCX0KKwludW1Wc25kUGNtcyA6PSBsZW4oeC5QY21zKQorCXhjLnBjbXMgPSAo
KkMubGlieGxfdnNuZF9wY20pKEMubWFsbG9jKEMudWxvbmcobnVtVnNuZFBjbXMpICogQy5zaXpl
b2ZfbGlieGxfdnNuZF9wY20pKQorCXhjLm51bV92c25kX3BjbXMgPSBDLmludChudW1Wc25kUGNt
cykKKwljUGNtcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfdnNuZF9wY20pKHVuc2FmZS5Qb2ludGVy
KHhjLnBjbXMpKVs6bnVtVnNuZFBjbXM6bnVtVnNuZFBjbXNdCisJZm9yIGksIHYgOj0gcmFuZ2Ug
eC5QY21zIHsKKwkJdG1wLCBlcnIgOj0gdi50b0MoKQorCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMu
bGlieGxfZGV2aWNlX3ZzbmRfZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgorCQl9CisJ
CWNQY21zW2ldID0gdG1wCisJfQogCXJldHVybiB4YywgbmlsCiB9CiAKQEAgLTIxMzQsNiArMjI3
MCwxODYgQEAgZnVuYyAoeCAqRG9tYWluQ29uZmlnKSB0b0MoKSAoeGMgQy5saWJ4bF9kb21haW5f
Y29uZmlnLCBlcnIgZXJyb3IpIHsKIAkJQy5saWJ4bF9kb21haW5fY29uZmlnX2Rpc3Bvc2UoJnhj
KQogCQlyZXR1cm4geGMsIGVycgogCX0KKwludW1EaXNrcyA6PSBsZW4oeC5EaXNrcykKKwl4Yy5k
aXNrcyA9ICgqQy5saWJ4bF9kZXZpY2VfZGlzaykoQy5tYWxsb2MoQy51bG9uZyhudW1EaXNrcykg
KiBDLnNpemVvZl9saWJ4bF9kZXZpY2VfZGlzaykpCisJeGMubnVtX2Rpc2tzID0gQy5pbnQobnVt
RGlza3MpCisJY0Rpc2tzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfZGlzaykodW5zYWZl
LlBvaW50ZXIoeGMuZGlza3MpKVs6bnVtRGlza3M6bnVtRGlza3NdCisJZm9yIGksIHYgOj0gcmFu
Z2UgeC5EaXNrcyB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYgZXJyICE9IG5pbCB7CisJ
CQlDLmxpYnhsX2RvbWFpbl9jb25maWdfZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgor
CQl9CisJCWNEaXNrc1tpXSA9IHRtcAorCX0KKwludW1OaWNzIDo9IGxlbih4Lk5pY3MpCisJeGMu
bmljcyA9ICgqQy5saWJ4bF9kZXZpY2VfbmljKShDLm1hbGxvYyhDLnVsb25nKG51bU5pY3MpICog
Qy5zaXplb2ZfbGlieGxfZGV2aWNlX25pYykpCisJeGMubnVtX25pY3MgPSBDLmludChudW1OaWNz
KQorCWNOaWNzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfbmljKSh1bnNhZmUuUG9pbnRl
cih4Yy5uaWNzKSlbOm51bU5pY3M6bnVtTmljc10KKwlmb3IgaSwgdiA6PSByYW5nZSB4Lk5pY3Mg
eworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9k
b21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIKKwkJfQorCQljTmlj
c1tpXSA9IHRtcAorCX0KKwludW1QY2lkZXZzIDo9IGxlbih4LlBjaWRldnMpCisJeGMucGNpZGV2
cyA9ICgqQy5saWJ4bF9kZXZpY2VfcGNpKShDLm1hbGxvYyhDLnVsb25nKG51bVBjaWRldnMpICog
Qy5zaXplb2ZfbGlieGxfZGV2aWNlX3BjaSkpCisJeGMubnVtX3BjaWRldnMgPSBDLmludChudW1Q
Y2lkZXZzKQorCWNQY2lkZXZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfcGNpKSh1bnNh
ZmUuUG9pbnRlcih4Yy5wY2lkZXZzKSlbOm51bVBjaWRldnM6bnVtUGNpZGV2c10KKwlmb3IgaSwg
diA6PSByYW5nZSB4LlBjaWRldnMgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAh
PSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJu
IHhjLCBlcnIKKwkJfQorCQljUGNpZGV2c1tpXSA9IHRtcAorCX0KKwludW1SZG1zIDo9IGxlbih4
LlJkbXMpCisJeGMucmRtcyA9ICgqQy5saWJ4bF9kZXZpY2VfcmRtKShDLm1hbGxvYyhDLnVsb25n
KG51bVJkbXMpICogQy5zaXplb2ZfbGlieGxfZGV2aWNlX3JkbSkpCisJeGMubnVtX3JkbXMgPSBD
LmludChudW1SZG1zKQorCWNSZG1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfcmRtKSh1
bnNhZmUuUG9pbnRlcih4Yy5yZG1zKSlbOm51bVJkbXM6bnVtUmRtc10KKwlmb3IgaSwgdiA6PSBy
YW5nZSB4LlJkbXMgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgewor
CQkJQy5saWJ4bF9kb21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIK
KwkJfQorCQljUmRtc1tpXSA9IHRtcAorCX0KKwludW1EdGRldnMgOj0gbGVuKHguRHRkZXZzKQor
CXhjLmR0ZGV2cyA9ICgqQy5saWJ4bF9kZXZpY2VfZHRkZXYpKEMubWFsbG9jKEMudWxvbmcobnVt
RHRkZXZzKSAqIEMuc2l6ZW9mX2xpYnhsX2RldmljZV9kdGRldikpCisJeGMubnVtX2R0ZGV2cyA9
IEMuaW50KG51bUR0ZGV2cykKKwljRHRkZXZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2Vf
ZHRkZXYpKHVuc2FmZS5Qb2ludGVyKHhjLmR0ZGV2cykpWzpudW1EdGRldnM6bnVtRHRkZXZzXQor
CWZvciBpLCB2IDo9IHJhbmdlIHguRHRkZXZzIHsKKwkJdG1wLCBlcnIgOj0gdi50b0MoKQorCQlp
ZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZG9tYWluX2NvbmZpZ19kaXNwb3NlKCZ4YykKKwkJ
CXJldHVybiB4YywgZXJyCisJCX0KKwkJY0R0ZGV2c1tpXSA9IHRtcAorCX0KKwludW1WZmJzIDo9
IGxlbih4LlZmYnMpCisJeGMudmZicyA9ICgqQy5saWJ4bF9kZXZpY2VfdmZiKShDLm1hbGxvYyhD
LnVsb25nKG51bVZmYnMpICogQy5zaXplb2ZfbGlieGxfZGV2aWNlX3ZmYikpCisJeGMubnVtX3Zm
YnMgPSBDLmludChudW1WZmJzKQorCWNWZmJzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2Vf
dmZiKSh1bnNhZmUuUG9pbnRlcih4Yy52ZmJzKSlbOm51bVZmYnM6bnVtVmZic10KKwlmb3IgaSwg
diA6PSByYW5nZSB4LlZmYnMgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBu
aWwgeworCQkJQy5saWJ4bF9kb21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhj
LCBlcnIKKwkJfQorCQljVmZic1tpXSA9IHRtcAorCX0KKwludW1Wa2JzIDo9IGxlbih4LlZrYnMp
CisJeGMudmticyA9ICgqQy5saWJ4bF9kZXZpY2VfdmtiKShDLm1hbGxvYyhDLnVsb25nKG51bVZr
YnMpICogQy5zaXplb2ZfbGlieGxfZGV2aWNlX3ZrYikpCisJeGMubnVtX3ZrYnMgPSBDLmludChu
dW1Wa2JzKQorCWNWa2JzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdmtiKSh1bnNhZmUu
UG9pbnRlcih4Yy52a2JzKSlbOm51bVZrYnM6bnVtVmtic10KKwlmb3IgaSwgdiA6PSByYW5nZSB4
LlZrYnMgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5s
aWJ4bF9kb21haW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIKKwkJfQor
CQljVmtic1tpXSA9IHRtcAorCX0KKwludW1WdHBtcyA6PSBsZW4oeC5WdHBtcykKKwl4Yy52dHBt
cyA9ICgqQy5saWJ4bF9kZXZpY2VfdnRwbSkoQy5tYWxsb2MoQy51bG9uZyhudW1WdHBtcykgKiBD
LnNpemVvZl9saWJ4bF9kZXZpY2VfdnRwbSkpCisJeGMubnVtX3Z0cG1zID0gQy5pbnQobnVtVnRw
bXMpCisJY1Z0cG1zIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdnRwbSkodW5zYWZlLlBv
aW50ZXIoeGMudnRwbXMpKVs6bnVtVnRwbXM6bnVtVnRwbXNdCisJZm9yIGksIHYgOj0gcmFuZ2Ug
eC5WdHBtcyB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlD
LmxpYnhsX2RvbWFpbl9jb25maWdfZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgorCQl9
CisJCWNWdHBtc1tpXSA9IHRtcAorCX0KKwludW1QOVMgOj0gbGVuKHguUDlTKQorCXhjLnA5cyA9
ICgqQy5saWJ4bF9kZXZpY2VfcDkpKEMubWFsbG9jKEMudWxvbmcobnVtUDlTKSAqIEMuc2l6ZW9m
X2xpYnhsX2RldmljZV9wOSkpCisJeGMubnVtX3A5cyA9IEMuaW50KG51bVA5UykKKwljUDlTIDo9
ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfcDkpKHVuc2FmZS5Qb2ludGVyKHhjLnA5cykpWzpu
dW1QOVM6bnVtUDlTXQorCWZvciBpLCB2IDo9IHJhbmdlIHguUDlTIHsKKwkJdG1wLCBlcnIgOj0g
di50b0MoKQorCQlpZiBlcnIgIT0gbmlsIHsKKwkJCUMubGlieGxfZG9tYWluX2NvbmZpZ19kaXNw
b3NlKCZ4YykKKwkJCXJldHVybiB4YywgZXJyCisJCX0KKwkJY1A5U1tpXSA9IHRtcAorCX0KKwlu
dW1QdmNhbGxzaWZzIDo9IGxlbih4LlB2Y2FsbHNpZnMpCisJeGMucHZjYWxsc2lmcyA9ICgqQy5s
aWJ4bF9kZXZpY2VfcHZjYWxsc2lmKShDLm1hbGxvYyhDLnVsb25nKG51bVB2Y2FsbHNpZnMpICog
Qy5zaXplb2ZfbGlieGxfZGV2aWNlX3B2Y2FsbHNpZikpCisJeGMubnVtX3B2Y2FsbHNpZnMgPSBD
LmludChudW1QdmNhbGxzaWZzKQorCWNQdmNhbGxzaWZzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9k
ZXZpY2VfcHZjYWxsc2lmKSh1bnNhZmUuUG9pbnRlcih4Yy5wdmNhbGxzaWZzKSlbOm51bVB2Y2Fs
bHNpZnM6bnVtUHZjYWxsc2lmc10KKwlmb3IgaSwgdiA6PSByYW5nZSB4LlB2Y2FsbHNpZnMgewor
CQl0bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21h
aW5fY29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIKKwkJfQorCQljUHZjYWxs
c2lmc1tpXSA9IHRtcAorCX0KKwludW1WZGlzcGxzIDo9IGxlbih4LlZkaXNwbHMpCisJeGMudmRp
c3BscyA9ICgqQy5saWJ4bF9kZXZpY2VfdmRpc3BsKShDLm1hbGxvYyhDLnVsb25nKG51bVZkaXNw
bHMpICogQy5zaXplb2ZfbGlieGxfZGV2aWNlX3ZkaXNwbCkpCisJeGMubnVtX3ZkaXNwbHMgPSBD
LmludChudW1WZGlzcGxzKQorCWNWZGlzcGxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2Vf
dmRpc3BsKSh1bnNhZmUuUG9pbnRlcih4Yy52ZGlzcGxzKSlbOm51bVZkaXNwbHM6bnVtVmRpc3Bs
c10KKwlmb3IgaSwgdiA6PSByYW5nZSB4LlZkaXNwbHMgeworCQl0bXAsIGVyciA6PSB2LnRvQygp
CisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5fY29uZmlnX2Rpc3Bvc2UoJnhj
KQorCQkJcmV0dXJuIHhjLCBlcnIKKwkJfQorCQljVmRpc3Bsc1tpXSA9IHRtcAorCX0KKwludW1W
c25kcyA6PSBsZW4oeC5Wc25kcykKKwl4Yy52c25kcyA9ICgqQy5saWJ4bF9kZXZpY2VfdnNuZCko
Qy5tYWxsb2MoQy51bG9uZyhudW1Wc25kcykgKiBDLnNpemVvZl9saWJ4bF9kZXZpY2VfdnNuZCkp
CisJeGMubnVtX3ZzbmRzID0gQy5pbnQobnVtVnNuZHMpCisJY1ZzbmRzIDo9ICgqWzEgPDwgMjhd
Qy5saWJ4bF9kZXZpY2VfdnNuZCkodW5zYWZlLlBvaW50ZXIoeGMudnNuZHMpKVs6bnVtVnNuZHM6
bnVtVnNuZHNdCisJZm9yIGksIHYgOj0gcmFuZ2UgeC5Wc25kcyB7CisJCXRtcCwgZXJyIDo9IHYu
dG9DKCkKKwkJaWYgZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX2RvbWFpbl9jb25maWdfZGlzcG9z
ZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgorCQl9CisJCWNWc25kc1tpXSA9IHRtcAorCX0KKwlu
dW1DaGFubmVscyA6PSBsZW4oeC5DaGFubmVscykKKwl4Yy5jaGFubmVscyA9ICgqQy5saWJ4bF9k
ZXZpY2VfY2hhbm5lbCkoQy5tYWxsb2MoQy51bG9uZyhudW1DaGFubmVscykgKiBDLnNpemVvZl9s
aWJ4bF9kZXZpY2VfY2hhbm5lbCkpCisJeGMubnVtX2NoYW5uZWxzID0gQy5pbnQobnVtQ2hhbm5l
bHMpCisJY0NoYW5uZWxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfY2hhbm5lbCkodW5z
YWZlLlBvaW50ZXIoeGMuY2hhbm5lbHMpKVs6bnVtQ2hhbm5lbHM6bnVtQ2hhbm5lbHNdCisJZm9y
IGksIHYgOj0gcmFuZ2UgeC5DaGFubmVscyB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYg
ZXJyICE9IG5pbCB7CisJCQlDLmxpYnhsX2RvbWFpbl9jb25maWdfZGlzcG9zZSgmeGMpCisJCQly
ZXR1cm4geGMsIGVycgorCQl9CisJCWNDaGFubmVsc1tpXSA9IHRtcAorCX0KKwludW1Vc2JjdHJs
cyA6PSBsZW4oeC5Vc2JjdHJscykKKwl4Yy51c2JjdHJscyA9ICgqQy5saWJ4bF9kZXZpY2VfdXNi
Y3RybCkoQy5tYWxsb2MoQy51bG9uZyhudW1Vc2JjdHJscykgKiBDLnNpemVvZl9saWJ4bF9kZXZp
Y2VfdXNiY3RybCkpCisJeGMubnVtX3VzYmN0cmxzID0gQy5pbnQobnVtVXNiY3RybHMpCisJY1Vz
YmN0cmxzIDo9ICgqWzEgPDwgMjhdQy5saWJ4bF9kZXZpY2VfdXNiY3RybCkodW5zYWZlLlBvaW50
ZXIoeGMudXNiY3RybHMpKVs6bnVtVXNiY3RybHM6bnVtVXNiY3RybHNdCisJZm9yIGksIHYgOj0g
cmFuZ2UgeC5Vc2JjdHJscyB7CisJCXRtcCwgZXJyIDo9IHYudG9DKCkKKwkJaWYgZXJyICE9IG5p
bCB7CisJCQlDLmxpYnhsX2RvbWFpbl9jb25maWdfZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMs
IGVycgorCQl9CisJCWNVc2JjdHJsc1tpXSA9IHRtcAorCX0KKwludW1Vc2JkZXZzIDo9IGxlbih4
LlVzYmRldnMpCisJeGMudXNiZGV2cyA9ICgqQy5saWJ4bF9kZXZpY2VfdXNiZGV2KShDLm1hbGxv
YyhDLnVsb25nKG51bVVzYmRldnMpICogQy5zaXplb2ZfbGlieGxfZGV2aWNlX3VzYmRldikpCisJ
eGMubnVtX3VzYmRldnMgPSBDLmludChudW1Vc2JkZXZzKQorCWNVc2JkZXZzIDo9ICgqWzEgPDwg
MjhdQy5saWJ4bF9kZXZpY2VfdXNiZGV2KSh1bnNhZmUuUG9pbnRlcih4Yy51c2JkZXZzKSlbOm51
bVVzYmRldnM6bnVtVXNiZGV2c10KKwlmb3IgaSwgdiA6PSByYW5nZSB4LlVzYmRldnMgeworCQl0
bXAsIGVyciA6PSB2LnRvQygpCisJCWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9kb21haW5f
Y29uZmlnX2Rpc3Bvc2UoJnhjKQorCQkJcmV0dXJuIHhjLCBlcnIKKwkJfQorCQljVXNiZGV2c1tp
XSA9IHRtcAorCX0KIAl4Yy5vbl9wb3dlcm9mZiA9IEMubGlieGxfYWN0aW9uX29uX3NodXRkb3du
KHguT25Qb3dlcm9mZikKIAl4Yy5vbl9yZWJvb3QgPSBDLmxpYnhsX2FjdGlvbl9vbl9zaHV0ZG93
bih4Lk9uUmVib290KQogCXhjLm9uX3dhdGNoZG9nID0gQy5saWJ4bF9hY3Rpb25fb25fc2h1dGRv
d24oeC5PbldhdGNoZG9nKQpAQCAtMjQxMyw2ICsyNzI5LDE4IEBAIGZ1bmMgKHggKlZkaXNwbGlu
Zm8pIHRvQygpICh4YyBDLmxpYnhsX3ZkaXNwbGluZm8sIGVyciBlcnJvcikgewogCXhjLmRldmlk
ID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQogCXhjLnN0YXRlID0gQy5pbnQoeC5TdGF0ZSkKIAl4
Yy5iZV9hbGxvYyA9IEMuYm9vbCh4LkJlQWxsb2MpCisJbnVtQ29ubmVjdG9ycyA6PSBsZW4oeC5D
b25uZWN0b3JzKQorCXhjLmNvbm5lY3RvcnMgPSAoKkMubGlieGxfY29ubmVjdG9yaW5mbykoQy5t
YWxsb2MoQy51bG9uZyhudW1Db25uZWN0b3JzKSAqIEMuc2l6ZW9mX2xpYnhsX2Nvbm5lY3Rvcmlu
Zm8pKQorCXhjLm51bV9jb25uZWN0b3JzID0gQy5pbnQobnVtQ29ubmVjdG9ycykKKwljQ29ubmVj
dG9ycyA6PSAoKlsxIDw8IDI4XUMubGlieGxfY29ubmVjdG9yaW5mbykodW5zYWZlLlBvaW50ZXIo
eGMuY29ubmVjdG9ycykpWzpudW1Db25uZWN0b3JzOm51bUNvbm5lY3RvcnNdCisJZm9yIGksIHYg
Oj0gcmFuZ2UgeC5Db25uZWN0b3JzIHsKKwkJdG1wLCBlcnIgOj0gdi50b0MoKQorCQlpZiBlcnIg
IT0gbmlsIHsKKwkJCUMubGlieGxfdmRpc3BsaW5mb19kaXNwb3NlKCZ4YykKKwkJCXJldHVybiB4
YywgZXJyCisJCX0KKwkJY0Nvbm5lY3RvcnNbaV0gPSB0bXAKKwl9CiAJcmV0dXJuIHhjLCBuaWwK
IH0KIApAQCAtMjQ0Nyw2ICsyNzc1LDE4IEBAIGZ1bmMgKHggKlBjbWluZm8pIGZyb21DKHhjICpD
LmxpYnhsX3BjbWluZm8pIGVycm9yIHsKIAogZnVuYyAoeCAqUGNtaW5mbykgdG9DKCkgKHhjIEMu
bGlieGxfcGNtaW5mbywgZXJyIGVycm9yKSB7CiAJQy5saWJ4bF9wY21pbmZvX2luaXQoJnhjKQor
CW51bVZzbmRTdHJlYW1zIDo9IGxlbih4LlN0cmVhbXMpCisJeGMuc3RyZWFtcyA9ICgqQy5saWJ4
bF9zdHJlYW1pbmZvKShDLm1hbGxvYyhDLnVsb25nKG51bVZzbmRTdHJlYW1zKSAqIEMuc2l6ZW9m
X2xpYnhsX3N0cmVhbWluZm8pKQorCXhjLm51bV92c25kX3N0cmVhbXMgPSBDLmludChudW1Wc25k
U3RyZWFtcykKKwljU3RyZWFtcyA6PSAoKlsxIDw8IDI4XUMubGlieGxfc3RyZWFtaW5mbykodW5z
YWZlLlBvaW50ZXIoeGMuc3RyZWFtcykpWzpudW1Wc25kU3RyZWFtczpudW1Wc25kU3RyZWFtc10K
Kwlmb3IgaSwgdiA6PSByYW5nZSB4LlN0cmVhbXMgeworCQl0bXAsIGVyciA6PSB2LnRvQygpCisJ
CWlmIGVyciAhPSBuaWwgeworCQkJQy5saWJ4bF9wY21pbmZvX2Rpc3Bvc2UoJnhjKQorCQkJcmV0
dXJuIHhjLCBlcnIKKwkJfQorCQljU3RyZWFtc1tpXSA9IHRtcAorCX0KIAlyZXR1cm4geGMsIG5p
bAogfQogCkBAIC0yNDc5LDYgKzI4MTksMTggQEAgZnVuYyAoeCAqVnNuZGluZm8pIHRvQygpICh4
YyBDLmxpYnhsX3ZzbmRpbmZvLCBlcnIgZXJyb3IpIHsKIAl4Yy5mcm9udGVuZF9pZCA9IEMudWlu
dDMyX3QoeC5Gcm9udGVuZElkKQogCXhjLmRldmlkID0gQy5saWJ4bF9kZXZpZCh4LkRldmlkKQog
CXhjLnN0YXRlID0gQy5pbnQoeC5TdGF0ZSkKKwludW1Wc25kUGNtcyA6PSBsZW4oeC5QY21zKQor
CXhjLnBjbXMgPSAoKkMubGlieGxfcGNtaW5mbykoQy5tYWxsb2MoQy51bG9uZyhudW1Wc25kUGNt
cykgKiBDLnNpemVvZl9saWJ4bF9wY21pbmZvKSkKKwl4Yy5udW1fdnNuZF9wY21zID0gQy5pbnQo
bnVtVnNuZFBjbXMpCisJY1BjbXMgOj0gKCpbMSA8PCAyOF1DLmxpYnhsX3BjbWluZm8pKHVuc2Fm
ZS5Qb2ludGVyKHhjLnBjbXMpKVs6bnVtVnNuZFBjbXM6bnVtVnNuZFBjbXNdCisJZm9yIGksIHYg
Oj0gcmFuZ2UgeC5QY21zIHsKKwkJdG1wLCBlcnIgOj0gdi50b0MoKQorCQlpZiBlcnIgIT0gbmls
IHsKKwkJCUMubGlieGxfdnNuZGluZm9fZGlzcG9zZSgmeGMpCisJCQlyZXR1cm4geGMsIGVycgor
CQl9CisJCWNQY21zW2ldID0gdG1wCisJfQogCXJldHVybiB4YywgbmlsCiB9CiAKQEAgLTI1MjUs
NiArMjg3NywxMyBAQCBmdW5jICh4ICpOdW1haW5mbykgdG9DKCkgKHhjIEMubGlieGxfbnVtYWlu
Zm8sIGVyciBlcnJvcikgewogCUMubGlieGxfbnVtYWluZm9faW5pdCgmeGMpCiAJeGMuc2l6ZSA9
IEMudWludDY0X3QoeC5TaXplKQogCXhjLmZyZWUgPSBDLnVpbnQ2NF90KHguRnJlZSkKKwludW1E
aXN0cyA6PSBsZW4oeC5EaXN0cykKKwl4Yy5kaXN0cyA9ICgqQy51aW50MzJfdCkoQy5tYWxsb2Mo
Qy5zaXplX3QobnVtRGlzdHMgKiBudW1EaXN0cykpKQorCXhjLm51bV9kaXN0cyA9IEMuaW50KG51
bURpc3RzKQorCWNEaXN0cyA6PSAoKlsxIDw8IDI4XUMudWludDMyX3QpKHVuc2FmZS5Qb2ludGVy
KHhjLmRpc3RzKSlbOm51bURpc3RzOm51bURpc3RzXQorCWZvciBpLCB2IDo9IHJhbmdlIHguRGlz
dHMgeworCQljRGlzdHNbaV0gPSBDLnVpbnQzMl90KHYpCisJfQogCXJldHVybiB4YywgbmlsCiB9
CiAKLS0gCjIuMTkuMQoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=

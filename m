Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6943C6ACED
	for <lists+xen-devel@lfdr.de>; Tue, 16 Jul 2019 18:40:04 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hnQS4-0002A9-44; Tue, 16 Jul 2019 16:37:16 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=LiPz=VN=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1hnQS2-0002A2-GR
 for xen-devel@lists.xenproject.org; Tue, 16 Jul 2019 16:37:14 +0000
X-Inumbo-ID: f45b0026-a7e7-11e9-aaef-b31b2a92f41e
Received: from m4a0041g.houston.softwaregrp.com (unknown [15.124.2.87])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id f45b0026-a7e7-11e9-aaef-b31b2a92f41e;
 Tue, 16 Jul 2019 16:37:09 +0000 (UTC)
Received: FROM m4a0041g.houston.softwaregrp.com (15.120.17.146) BY
 m4a0041g.houston.softwaregrp.com WITH ESMTP; 
 Tue, 16 Jul 2019 16:37:08 +0000
Received: from M9W0067.microfocus.com (2002:f79:be::f79:be) by
 M4W0334.microfocus.com (2002:f78:1192::f78:1192) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.1591.10; Tue, 16 Jul 2019 16:36:09 +0000
Received: from NAM01-BN3-obe.outbound.protection.outlook.com (15.124.72.13) by
 M9W0067.microfocus.com (15.121.0.190) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256) id
 15.1.1591.10 via Frontend Transport; Tue, 16 Jul 2019 16:36:09 +0000
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=QBQHgYRvqX0mhmMU/3Dh3NXksurxFsTAuKiAE/Iw+pGxXurFmAxcQms+C3Ctv0aVjDkCtYk829ioC7XyPns+aSbcuCsj0SEzaXsZnYv4eKvUywRt8QhooX/JtCMQrTG3cciDso2eeIHTMX3R5B5cSXs7KAlR8brbZHZ3sZyjOJQ/EmaEjH0mFd4Ltue6zhWA0+eWvKUtzAT/4zIZMgXK9u4jr9U83Y4KE9YAPtExGeMO6xDm7gVgXKDtGzFsmw/lzYCo++oDZeNWldsAb2hughJkDv0ZXKHWgEasqZcgtFdT7LvpKkOdSJRA5abL312AfqcI80S8LHoJaqcA7hN8bw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=+L9DpxY6N+OqCiYyBpJUE3oOULyLv6LQLbBVLUWHmaM=;
 b=Ep+FrIamf/WH+pnN5qc/KyeO4L/5XjMknaEjH33JxwdPpvCYCm/1vA2H1QEYxBumgPk8omZKYdzYEy93lRue9sXN8AVh5+Y19Abi+cnXqiUIsD4ePYJ95smpMuVn99TStT+a8sHCUlzarra1yJ09EJxzASTKI4zBOeIQGESKhb66hCtYD4zEN6SIS/mCpORKKX5J099SE0oOS53EV8dEmP20HL+Mi5KpOSyDilqVdr/p5wKWpY2Z8NdOKiklXclxliwPin0I/6PxsTWxf/cZx1/G2GN6S7tsE8xt+dJy69hWGNQGoATvFWeHynkfT4lrIV6PH1leJh5Otu1/s6K2wA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1;spf=pass
 smtp.mailfrom=suse.com;dmarc=pass action=none header.from=suse.com;dkim=pass
 header.d=suse.com;arc=none
Received: from DM6PR18MB3401.namprd18.prod.outlook.com (10.255.174.218) by
 DM6PR18MB2764.namprd18.prod.outlook.com (20.179.49.145) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.2073.14; Tue, 16 Jul 2019 16:36:07 +0000
Received: from DM6PR18MB3401.namprd18.prod.outlook.com
 ([fe80::1fe:35f6:faf3:78c7]) by DM6PR18MB3401.namprd18.prod.outlook.com
 ([fe80::1fe:35f6:faf3:78c7%7]) with mapi id 15.20.2073.012; Tue, 16 Jul 2019
 16:36:07 +0000
From: Jan Beulich <JBeulich@suse.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v3 03/14] AMD/IOMMU: use bit field for control register
Thread-Index: AQHVO/SRnAccqyvNqEup1oh+z/xKQg==
Date: Tue, 16 Jul 2019 16:36:06 +0000
Message-ID: <3bca9f91-7cd8-e1bd-6d4c-736998fd3f0a@suse.com>
References: <6272c301-a905-38cf-dd1a-645f3d703241@suse.com>
In-Reply-To: <6272c301-a905-38cf-dd1a-645f3d703241@suse.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: DB3PR0202CA0032.eurprd02.prod.outlook.com
 (2603:10a6:8:1::45) To DM6PR18MB3401.namprd18.prod.outlook.com
 (2603:10b6:5:1cc::26)
authentication-results: spf=none (sender IP is )
 smtp.mailfrom=JBeulich@suse.com; 
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [87.234.252.170]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 7c1e0ac5-ec38-4e93-45bc-08d70a0bb375
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390118)(7020095)(4652040)(8989299)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(5600148)(711020)(4605104)(1401327)(2017052603328)(7193020);
 SRVR:DM6PR18MB2764; 
x-ms-traffictypediagnostic: DM6PR18MB2764:
x-microsoft-antispam-prvs: <DM6PR18MB276494CB1B74EA116ECF231AB3CE0@DM6PR18MB2764.namprd18.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:2582;
x-forefront-prvs: 0100732B76
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(4636009)(346002)(366004)(376002)(396003)(39860400002)(136003)(199004)(189003)(80792005)(76176011)(478600001)(14454004)(66066001)(2906002)(31696002)(2501003)(52116002)(7736002)(2616005)(25786009)(186003)(68736007)(11346002)(446003)(386003)(14444005)(6506007)(36756003)(8676002)(6512007)(476003)(53946003)(305945005)(26005)(31686004)(8936002)(3846002)(4326008)(2351001)(6486002)(30864003)(81166006)(81156014)(486006)(316002)(53936002)(54906003)(5640700003)(256004)(102836004)(86362001)(71200400001)(6116002)(66946007)(66476007)(66556008)(64756008)(66446008)(5660300002)(99286004)(6916009)(6436002)(71190400001);
 DIR:OUT; SFP:1102; SCL:1; SRVR:DM6PR18MB2764;
 H:DM6PR18MB3401.namprd18.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; A:1; MX:1; 
received-spf: None (protection.outlook.com: suse.com does not designate
 permitted sender hosts)
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam-message-info: i2VpiyVl83DwpFoDbMhFcHUCvokPFEXl9Ll6GGX7cGXW9Q3RXbhr7ng1KQY6mjUyB4mStaP7E6/NWtH05kSiwW3fbZN+QUvBjjXCKSSulj7zp/A/9X+tOXICVaX5Nt8mAs1x+i7I1c1YYY/Mk+hnoqLZXs/8rs6sA1Ctr7PK27SwvxsG8YQTb3MRX3jFarwi7ZB+beZAyYuE8nwSNjpABNrLgO9W6hSE7YEqGXzkhPlNGIqxwXh8NQubaCDtNFIuYLAtp2nSMl5oc8jqOGMyiY2ttMexO5eWoUZ3Hd+EAMdfWFwaQXTRYM5YhfmY9hfnvPbAez4+u6Ha64Y1TrCKm+8ScUtKNiQU/OVv94NOLyfnNcCck/VxNhoE4QRbsmrW5Q1TrgNY6b0Ei7K9dZjl9m0gEyYiiGKwsGpw1DDZgM0=
Content-ID: <B39E4FB0CF88904792EB5F9988C160E8@namprd18.prod.outlook.com>
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-Network-Message-Id: 7c1e0ac5-ec38-4e93-45bc-08d70a0bb375
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 Jul 2019 16:36:06.9978 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 856b813c-16e5-49a5-85ec-6f081e13b527
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: JBeulich@suse.com
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR18MB2764
X-OriginatorOrg: suse.com
Subject: [Xen-devel] [PATCH v3 03/14] AMD/IOMMU: use bit field for control
 register
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>,
 Brian Woods <brian.woods@amd.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

QWxzbyBpbnRyb2R1Y2UgYSBmaWVsZCBpbiBzdHJ1Y3QgYW1kX2lvbW11IGNhY2hpbmcgdGhlIG1v
c3QgcmVjZW50bHkNCndyaXR0ZW4gY29udHJvbCByZWdpc3Rlci4gQWxsIHdyaXRlcyBzaG91bGQg
bm93IGhhcHBlbiBleGNsdXNpdmVseSBmcm9tDQp0aGF0IGNhY2hlZCB2YWx1ZSwgc3VjaCB0aGF0
IGl0IGlzIGd1YXJhbnRlZWQgdG8gYmUgdXAgdG8gZGF0ZS4NCg0KVGFrZSB0aGUgb3Bwb3J0dW5p
dHkgYW5kIGFkZCBmdXJ0aGVyIGZpZWxkcy4gQWxzbyBjb252ZXJ0IGEgZmV3IGJvb2xlYW4NCmZ1
bmN0aW9uIHBhcmFtZXRlcnMgdG8gYm9vbCwgc3VjaCB0aGF0IHVzZSBvZiAhISBjYW4gYmUgYXZv
aWRlZC4NCg0KQmVjYXVzZSBvZiB0aGVyZSBub3cgYmVpbmcgZGVmaW5pdGlvbnMgYmV5b25kIGJp
dCAzMSwgd3JpdGVsKCkgYWxzbyBnZXRzDQpyZXBsYWNlZCBieSB3cml0ZXEoKSB3aGVuIHVwZGF0
aW5nIGhhcmR3YXJlLg0KDQpTaWduZWQtb2ZmLWJ5OiBKYW4gQmV1bGljaCA8amJldWxpY2hAc3Vz
ZS5jb20+DQpBY2tlZC1ieTogQW5kcmV3IENvb3BlciA8YW5kcmV3LmNvb3BlcjNAY2l0cml4LmNv
bT4NCi0tLQ0KdjM6IFN3aXRjaCBib29sZWFuIGJpdGZpZWxkcyB0byBib29sLg0KdjI6IEFkZCBk
b21haW5faWRfcG5lIGZpZWxkLiBNZW50aW9uIHdyaXRlbCgpIC0+IHdyaXRlcSgpIGNoYW5nZS4N
Cg0KLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X2d1ZXN0LmMNCisrKyBi
L3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9ndWVzdC5jDQpAQCAtMzE3LDcgKzMx
Nyw3IEBAIHN0YXRpYyBpbnQgZG9faW52YWxpZGF0ZV9pb3RsYl9wYWdlcyhzdHINCiAgDQogIHN0
YXRpYyBpbnQgZG9fY29tcGxldGlvbl93YWl0KHN0cnVjdCBkb21haW4gKmQsIGNtZF9lbnRyeV90
ICpjbWQpDQogIHsNCi0gICAgYm9vbF90IGNvbV93YWl0X2ludF9lbiwgY29tX3dhaXRfaW50LCBp
LCBzOw0KKyAgICBib29sIGNvbV93YWl0X2ludCwgaSwgczsNCiAgICAgIHN0cnVjdCBndWVzdF9p
b21tdSAqaW9tbXU7DQogICAgICB1bnNpZ25lZCBsb25nIGdmbjsNCiAgICAgIHAybV90eXBlX3Qg
cDJtdDsNCkBAIC0zNTQsMTIgKzM1NCwxMCBAQCBzdGF0aWMgaW50IGRvX2NvbXBsZXRpb25fd2Fp
dChzdHJ1Y3QgZG9tDQogICAgICAgICAgdW5tYXBfZG9tYWluX3BhZ2UodmFkZHIpOw0KICAgICAg
fQ0KICANCi0gICAgY29tX3dhaXRfaW50X2VuID0gaW9tbXVfZ2V0X2JpdChpb21tdS0+cmVnX2N0
cmwubG8sDQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfQ09OVFJP
TF9DT01QX1dBSVRfSU5UX1NISUZUKTsNCiAgICAgIGNvbV93YWl0X2ludCA9IGlvbW11X2dldF9i
aXQoaW9tbXUtPnJlZ19zdGF0dXMubG8sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIElPTU1VX1NUQVRVU19DT01QX1dBSVRfSU5UX1NISUZUKTsNCiAgDQotICAgIGlmICggY29t
X3dhaXRfaW50X2VuICYmIGNvbV93YWl0X2ludCApDQorICAgIGlmICggaW9tbXUtPnJlZ19jdHJs
LmNvbV93YWl0X2ludF9lbiAmJiBjb21fd2FpdF9pbnQgKQ0KICAgICAgICAgIGd1ZXN0X2lvbW11
X2RlbGl2ZXJfbXNpKGQpOw0KICANCiAgICAgIHJldHVybiAwOw0KQEAgLTUyMSw0MCArNTE5LDE3
IEBAIHN0YXRpYyB2b2lkIGd1ZXN0X2lvbW11X3Byb2Nlc3NfY29tbWFuZCgNCiAgICAgIHJldHVy
bjsNCiAgfQ0KICANCi1zdGF0aWMgaW50IGd1ZXN0X2lvbW11X3dyaXRlX2N0cmwoc3RydWN0IGd1
ZXN0X2lvbW11ICppb21tdSwgdWludDY0X3QgbmV3Y3RybCkNCitzdGF0aWMgaW50IGd1ZXN0X2lv
bW11X3dyaXRlX2N0cmwoc3RydWN0IGd1ZXN0X2lvbW11ICppb21tdSwgdWludDY0X3QgdmFsKQ0K
ICB7DQotICAgIGJvb2xfdCBjbWRfZW4sIGV2ZW50X2VuLCBpb21tdV9lbiwgcHByX2VuLCBwcHJf
bG9nX2VuOw0KLSAgICBib29sX3QgY21kX2VuX29sZCwgZXZlbnRfZW5fb2xkLCBpb21tdV9lbl9v
bGQ7DQotICAgIGJvb2xfdCBjbWRfcnVuOw0KLQ0KLSAgICBpb21tdV9lbiA9IGlvbW11X2dldF9i
aXQobmV3Y3RybCwNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0NPTlRST0xf
VFJBTlNMQVRJT05fRU5BQkxFX1NISUZUKTsNCi0gICAgaW9tbXVfZW5fb2xkID0gaW9tbXVfZ2V0
X2JpdChpb21tdS0+cmVnX2N0cmwubG8sDQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVfQ09OVFJPTF9UUkFOU0xBVElPTl9FTkFCTEVfU0hJRlQpOw0KLQ0KLSAgICBjbWRf
ZW4gPSBpb21tdV9nZXRfYml0KG5ld2N0cmwsDQotICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfQ09OVFJPTF9DT01NQU5EX0JVRkZFUl9FTkFCTEVfU0hJRlQpOw0KLSAgICBjbWRfZW5f
b2xkID0gaW9tbXVfZ2V0X2JpdChpb21tdS0+cmVnX2N0cmwubG8sDQotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIElPTU1VX0NPTlRST0xfQ09NTUFORF9CVUZGRVJfRU5BQkxFX1NISUZU
KTsNCi0gICAgY21kX3J1biA9IGlvbW11X2dldF9iaXQoaW9tbXUtPnJlZ19zdGF0dXMubG8sDQot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1NUQVRVU19DTURfQlVGRkVSX1JVTl9T
SElGVCk7DQotICAgIGV2ZW50X2VuID0gaW9tbXVfZ2V0X2JpdChuZXdjdHJsLA0KLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0dfRU5BQkxFX1NISUZU
KTsNCi0gICAgZXZlbnRfZW5fb2xkID0gaW9tbXVfZ2V0X2JpdChpb21tdS0+cmVnX2N0cmwubG8s
DQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfQ09OVFJPTF9FVkVOVF9M
T0dfRU5BQkxFX1NISUZUKTsNCi0NCi0gICAgcHByX2VuID0gaW9tbXVfZ2V0X2JpdChuZXdjdHJs
LA0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0NPTlRST0xfUFBSX0VOQUJMRV9T
SElGVCk7DQotICAgIHBwcl9sb2dfZW4gPSBpb21tdV9nZXRfYml0KG5ld2N0cmwsDQotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX0NPTlRST0xfUFBSX0xPR19FTkFCTEVfU0hJ
RlQpOw0KKyAgICB1bmlvbiBhbWRfaW9tbXVfY29udHJvbCBuZXdjdHJsID0geyAucmF3ID0gdmFs
IH07DQogIA0KLSAgICBpZiAoIGlvbW11X2VuICkNCisgICAgaWYgKCBuZXdjdHJsLmlvbW11X2Vu
ICkNCiAgICAgIHsNCiAgICAgICAgICBndWVzdF9pb21tdV9lbmFibGUoaW9tbXUpOw0KICAgICAg
ICAgIGd1ZXN0X2lvbW11X2VuYWJsZV9kZXZfdGFibGUoaW9tbXUpOw0KICAgICAgfQ0KICANCi0g
ICAgaWYgKCBpb21tdV9lbiAmJiBjbWRfZW4gKQ0KKyAgICBpZiAoIG5ld2N0cmwuaW9tbXVfZW4g
JiYgbmV3Y3RybC5jbWRfYnVmX2VuICkNCiAgICAgIHsNCiAgICAgICAgICBndWVzdF9pb21tdV9l
bmFibGVfcmluZ19idWZmZXIoaW9tbXUsICZpb21tdS0+Y21kX2J1ZmZlciwNCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKGNtZF9lbnRyeV90KSk7DQpAQCAt
NTYyLDcgKzUzNyw3IEBAIHN0YXRpYyBpbnQgZ3Vlc3RfaW9tbXVfd3JpdGVfY3RybChzdHJ1Y3QN
CiAgICAgICAgICB0YXNrbGV0X3NjaGVkdWxlKCZpb21tdS0+Y21kX2J1ZmZlcl90YXNrbGV0KTsN
CiAgICAgIH0NCiAgDQotICAgIGlmICggaW9tbXVfZW4gJiYgZXZlbnRfZW4gKQ0KKyAgICBpZiAo
IG5ld2N0cmwuaW9tbXVfZW4gJiYgbmV3Y3RybC5ldmVudF9sb2dfZW4gKQ0KICAgICAgew0KICAg
ICAgICAgIGd1ZXN0X2lvbW11X2VuYWJsZV9yaW5nX2J1ZmZlcihpb21tdSwgJmlvbW11LT5ldmVu
dF9sb2csDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihl
dmVudF9lbnRyeV90KSk7DQpAQCAtNTcwLDcgKzU0NSw3IEBAIHN0YXRpYyBpbnQgZ3Vlc3RfaW9t
bXVfd3JpdGVfY3RybChzdHJ1Y3QNCiAgICAgICAgICBndWVzdF9pb21tdV9jbGVhcl9zdGF0dXMo
aW9tbXUsIElPTU1VX1NUQVRVU19FVkVOVF9PVkVSRkxPV19TSElGVCk7DQogICAgICB9DQogIA0K
LSAgICBpZiAoIGlvbW11X2VuICYmIHBwcl9lbiAmJiBwcHJfbG9nX2VuICkNCisgICAgaWYgKCBu
ZXdjdHJsLmlvbW11X2VuICYmIG5ld2N0cmwucHByX2VuICYmIG5ld2N0cmwucHByX2xvZ19lbiAp
DQogICAgICB7DQogICAgICAgICAgZ3Vlc3RfaW9tbXVfZW5hYmxlX3JpbmdfYnVmZmVyKGlvbW11
LCAmaW9tbXUtPnBwcl9sb2csDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNpemVvZihwcHJfZW50cnlfdCkpOw0KQEAgLTU3OCwxOSArNTUzLDIxIEBAIHN0YXRpYyBp
bnQgZ3Vlc3RfaW9tbXVfd3JpdGVfY3RybChzdHJ1Y3QNCiAgICAgICAgICBndWVzdF9pb21tdV9j
bGVhcl9zdGF0dXMoaW9tbXUsIElPTU1VX1NUQVRVU19QUFJfTE9HX09WRVJGTE9XX1NISUZUKTsN
CiAgICAgIH0NCiAgDQotICAgIGlmICggaW9tbXVfZW4gJiYgY21kX2VuX29sZCAmJiAhY21kX2Vu
ICkNCisgICAgaWYgKCBuZXdjdHJsLmlvbW11X2VuICYmIGlvbW11LT5yZWdfY3RybC5jbWRfYnVm
X2VuICYmDQorICAgICAgICAgIW5ld2N0cmwuY21kX2J1Zl9lbiApDQogICAgICB7DQogICAgICAg
ICAgLyogRGlzYWJsZSBpb21tdSBjb21tYW5kIHByb2Nlc3NpbmcgKi8NCiAgICAgICAgICB0YXNr
bGV0X2tpbGwoJmlvbW11LT5jbWRfYnVmZmVyX3Rhc2tsZXQpOw0KICAgICAgfQ0KICANCi0gICAg
aWYgKCBldmVudF9lbl9vbGQgJiYgIWV2ZW50X2VuICkNCisgICAgaWYgKCBpb21tdS0+cmVnX2N0
cmwuZXZlbnRfbG9nX2VuICYmICFuZXdjdHJsLmV2ZW50X2xvZ19lbiApDQogICAgICAgICAgZ3Vl
c3RfaW9tbXVfY2xlYXJfc3RhdHVzKGlvbW11LCBJT01NVV9TVEFUVVNfRVZFTlRfTE9HX1JVTl9T
SElGVCk7DQogIA0KLSAgICBpZiAoIGlvbW11X2VuX29sZCAmJiAhaW9tbXVfZW4gKQ0KKyAgICBp
ZiAoIGlvbW11LT5yZWdfY3RybC5pb21tdV9lbiAmJiAhbmV3Y3RybC5pb21tdV9lbiApDQogICAg
ICAgICAgZ3Vlc3RfaW9tbXVfZGlzYWJsZShpb21tdSk7DQogIA0KLSAgICB1NjRfdG9fcmVnKCZp
b21tdS0+cmVnX2N0cmwsIG5ld2N0cmwpOw0KKyAgICBpb21tdS0+cmVnX2N0cmwgPSBuZXdjdHJs
Ow0KKw0KICAgICAgcmV0dXJuIDA7DQogIH0NCiAgDQpAQCAtNjMyLDcgKzYwOSw3IEBAIHN0YXRp
YyB1aW50NjRfdCBpb21tdV9tbWlvX3JlYWQ2NChzdHJ1Y3QNCiAgICAgICAgICB2YWwgPSByZWdf
dG9fdTY0KGlvbW11LT5wcHJfbG9nLnJlZ190YWlsKTsNCiAgICAgICAgICBicmVhazsNCiAgICAg
IGNhc2UgSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVDoNCi0gICAgICAgIHZhbCA9IHJlZ190b191
NjQoaW9tbXUtPnJlZ19jdHJsKTsNCisgICAgICAgIHZhbCA9IGlvbW11LT5yZWdfY3RybC5yYXc7
DQogICAgICAgICAgYnJlYWs7DQogICAgICBjYXNlIElPTU1VX1NUQVRVU19NTUlPX09GRlNFVDoN
CiAgICAgICAgICB2YWwgPSByZWdfdG9fdTY0KGlvbW11LT5yZWdfc3RhdHVzKTsNCi0tLSBhL3hl
bi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMNCisrKyBiL3hlbi9kcml2ZXJz
L3Bhc3N0aHJvdWdoL2FtZC9pb21tdV9pbml0LmMNCkBAIC00MSw3ICs0MSw3IEBAIExJU1RfSEVB
RF9SRUFEX01PU1RMWShhbWRfaW9tbXVfaGVhZCk7DQogIHN0cnVjdCB0YWJsZV9zdHJ1Y3QgZGV2
aWNlX3RhYmxlOw0KICBib29sX3QgaW9tbXV2Ml9lbmFibGVkOw0KICANCi1zdGF0aWMgaW50IGlv
bW11X2hhc19odF9mbGFnKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1OCBtYXNrKQ0KK3N0YXRp
YyBib29sIGlvbW11X2hhc19odF9mbGFnKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCB1OCBtYXNr
KQ0KICB7DQogICAgICByZXR1cm4gaW9tbXUtPmh0X2ZsYWdzICYgbWFzazsNCiAgfQ0KQEAgLTY5
LDMxICs2OSwxOCBAQCBzdGF0aWMgdm9pZCBfX2luaXQgdW5tYXBfaW9tbXVfbW1pb19yZWdpDQog
IA0KICBzdGF0aWMgdm9pZCBzZXRfaW9tbXVfaHRfZmxhZ3Moc3RydWN0IGFtZF9pb21tdSAqaW9t
bXUpDQogIHsNCi0gICAgdTMyIGVudHJ5Ow0KLSAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlv
X2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCi0NCiAgICAgIC8qIFNldHVwIEhU
IGZsYWdzICovDQogICAgICBpZiAoIGlvbW11X2hhc19jYXAoaW9tbXUsIFBDSV9DQVBfSFRfVFVO
TkVMX1NISUZUKSApDQotICAgICAgICBpb21tdV9oYXNfaHRfZmxhZyhpb21tdSwgQUNQSV9JVkhE
X1RUX0VOQUJMRSkgPw0KLSAgICAgICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9D
T05UUk9MX0hUX1RVTk5FTF9UUkFOU0xBVElPTl9TSElGVCkgOg0KLSAgICAgICAgICAgIGlvbW11
X2NsZWFyX2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfSFRfVFVOTkVMX1RSQU5TTEFUSU9OX1NI
SUZUKTsNCi0NCi0gICAgaW9tbXVfaGFzX2h0X2ZsYWcoaW9tbXUsIEFDUElfSVZIRF9SRVNfUEFT
U19QVykgPw0KLSAgICAgICAgaW9tbXVfc2V0X2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfUkVT
UF9QQVNTX1BPU1RFRF9XUklURV9TSElGVCk6DQotICAgICAgICBpb21tdV9jbGVhcl9iaXQoJmVu
dHJ5LCBJT01NVV9DT05UUk9MX1JFU1BfUEFTU19QT1NURURfV1JJVEVfU0hJRlQpOw0KLQ0KLSAg
ICBpb21tdV9oYXNfaHRfZmxhZyhpb21tdSwgQUNQSV9JVkhEX0lTT0MpID8NCi0gICAgICAgIGlv
bW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0lTT0NIUk9OT1VTX1NISUZUKToNCi0g
ICAgICAgIGlvbW11X2NsZWFyX2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfSVNPQ0hST05PVVNf
U0hJRlQpOw0KLQ0KLSAgICBpb21tdV9oYXNfaHRfZmxhZyhpb21tdSwgQUNQSV9JVkhEX1BBU1Nf
UFcpID8NCi0gICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX1BBU1Nf
UE9TVEVEX1dSSVRFX1NISUZUKToNCi0gICAgICAgIGlvbW11X2NsZWFyX2JpdCgmZW50cnksIElP
TU1VX0NPTlRST0xfUEFTU19QT1NURURfV1JJVEVfU0hJRlQpOw0KKyAgICAgICAgaW9tbXUtPmN0
cmwuaHRfdHVuX2VuID0gaW9tbXVfaGFzX2h0X2ZsYWcoaW9tbXUsIEFDUElfSVZIRF9UVF9FTkFC
TEUpOw0KKw0KKyAgICBpb21tdS0+Y3RybC5wYXNzX3B3ICAgICA9IGlvbW11X2hhc19odF9mbGFn
KGlvbW11LCBBQ1BJX0lWSERfUEFTU19QVyk7DQorICAgIGlvbW11LT5jdHJsLnJlc19wYXNzX3B3
ID0gaW9tbXVfaGFzX2h0X2ZsYWcoaW9tbXUsIEFDUElfSVZIRF9SRVNfUEFTU19QVyk7DQorICAg
IGlvbW11LT5jdHJsLmlzb2MgICAgICAgID0gaW9tbXVfaGFzX2h0X2ZsYWcoaW9tbXUsIEFDUElf
SVZIRF9JU09DKTsNCiAgDQogICAgICAvKiBGb3JjZSBjb2hlcmVudCAqLw0KLSAgICBpb21tdV9z
ZXRfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9DT0hFUkVOVF9TSElGVCk7DQorICAgIGlvbW11
LT5jdHJsLmNvaGVyZW50ID0gdHJ1ZTsNCiAgDQotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1t
aW9fYmFzZStJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCisgICAgd3JpdGVxKGlvbW11LT5j
dHJsLnJhdywgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOw0K
ICB9DQogIA0KICBzdGF0aWMgdm9pZCByZWdpc3Rlcl9pb21tdV9kZXZfdGFibGVfaW5fbW1pb19z
cGFjZShzdHJ1Y3QgYW1kX2lvbW11ICppb21tdSkNCkBAIC0yMDUsNTUgKzE5MiwzNyBAQCBzdGF0
aWMgdm9pZCByZWdpc3Rlcl9pb21tdV9wcHJfbG9nX2luX21tDQogIA0KICANCiAgc3RhdGljIHZv
aWQgc2V0X2lvbW11X3RyYW5zbGF0aW9uX2NvbnRyb2woc3RydWN0IGFtZF9pb21tdSAqaW9tbXUs
DQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBl
bmFibGUpDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBl
bmFibGUpDQogIHsNCi0gICAgdTMyIGVudHJ5Ow0KKyAgICBpb21tdS0+Y3RybC5pb21tdV9lbiA9
IGVuYWJsZTsNCiAgDQotICAgIGVudHJ5ID0gcmVhZGwoaW9tbXUtPm1taW9fYmFzZSArIElPTU1V
X0NPTlRST0xfTU1JT19PRkZTRVQpOw0KLQ0KLSAgICBlbmFibGUgPw0KLSAgICAgICAgaW9tbXVf
c2V0X2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfVFJBTlNMQVRJT05fRU5BQkxFX1NISUZUKSA6
DQotICAgICAgICBpb21tdV9jbGVhcl9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX1RSQU5TTEFU
SU9OX0VOQUJMRV9TSElGVCk7DQotDQotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9fYmFz
ZStJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCisgICAgd3JpdGVxKGlvbW11LT5jdHJsLnJh
dywgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOw0KICB9DQog
IA0KICBzdGF0aWMgdm9pZCBzZXRfaW9tbXVfZ3Vlc3RfdHJhbnNsYXRpb25fY29udHJvbChzdHJ1
Y3QgYW1kX2lvbW11ICppb21tdSwNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpbnQgZW5hYmxlKQ0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJvb2wgZW5hYmxlKQ0KICB7DQotICAgIHUzMiBlbnRyeTsNCi0N
Ci0gICAgZW50cnkgPSByZWFkbChpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJPTF9NTUlP
X09GRlNFVCk7DQorICAgIGlvbW11LT5jdHJsLmd0X2VuID0gZW5hYmxlOw0KICANCi0gICAgZW5h
YmxlID8NCi0gICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0dUX0VO
QUJMRV9TSElGVCkgOg0KLSAgICAgICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09O
VFJPTF9HVF9FTkFCTEVfU0hJRlQpOw0KLQ0KLSAgICB3cml0ZWwoZW50cnksIGlvbW11LT5tbWlv
X2Jhc2UrSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7DQorICAgIHdyaXRlcShpb21tdS0+Y3Ry
bC5yYXcsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCiAg
DQogICAgICBpZiAoIGVuYWJsZSApDQogICAgICAgICAgQU1EX0lPTU1VX0RFQlVHKCJHdWVzdCBU
cmFuc2xhdGlvbiBFbmFibGVkLlxuIik7DQogIH0NCiAgDQogIHN0YXRpYyB2b2lkIHNldF9pb21t
dV9jb21tYW5kX2J1ZmZlcl9jb250cm9sKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LA0KLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZW5hYmxl
KQ0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgZW5h
YmxlKQ0KICB7DQotICAgIHUzMiBlbnRyeTsNCi0NCi0gICAgZW50cnkgPSByZWFkbChpb21tdS0+
bW1pb19iYXNlICsgSU9NTVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7DQotDQotICAgIC8qcmVzZXQg
aGVhZCBhbmQgdGFpbCBwb2ludGVyIG1hbnVhbGx5IGJlZm9yZSBlbmFibGVtZW50ICovDQorICAg
IC8qIFJlc2V0IGhlYWQgYW5kIHRhaWwgcG9pbnRlciBtYW51YWxseSBiZWZvcmUgZW5hYmxlbWVu
dCAqLw0KICAgICAgaWYgKCBlbmFibGUgKQ0KICAgICAgew0KICAgICAgICAgIHdyaXRlcSgwLCBp
b21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ01EX0JVRkZFUl9IRUFEX09GRlNFVCk7DQogICAgICAg
ICAgd3JpdGVxKDAsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DTURfQlVGRkVSX1RBSUxfT0ZG
U0VUKTsNCi0NCi0gICAgICAgIGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0NP
TU1BTkRfQlVGRkVSX0VOQUJMRV9TSElGVCk7DQogICAgICB9DQotICAgIGVsc2UNCi0gICAgICAg
IGlvbW11X2NsZWFyX2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfQ09NTUFORF9CVUZGRVJfRU5B
QkxFX1NISUZUKTsNCiAgDQotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9fYmFzZStJT01N
VV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCisgICAgaW9tbXUtPmN0cmwuY21kX2J1Zl9lbiA9IGVu
YWJsZTsNCisNCisgICAgd3JpdGVxKGlvbW11LT5jdHJsLnJhdywgaW9tbXUtPm1taW9fYmFzZSAr
IElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOw0KICB9DQogIA0KICBzdGF0aWMgdm9pZCByZWdp
c3Rlcl9pb21tdV9leGNsdXNpb25fcmFuZ2Uoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUpDQpAQCAt
Mjk1LDU3ICsyNjQsMzggQEAgc3RhdGljIHZvaWQgcmVnaXN0ZXJfaW9tbXVfZXhjbHVzaW9uX3Jh
bg0KICB9DQogIA0KICBzdGF0aWMgdm9pZCBzZXRfaW9tbXVfZXZlbnRfbG9nX2NvbnRyb2woc3Ry
dWN0IGFtZF9pb21tdSAqaW9tbXUsDQotICAgICAgICAgICAgaW50IGVuYWJsZSkNCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBlbmFibGUpDQogIHsNCi0gICAg
dTMyIGVudHJ5Ow0KLQ0KLSAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01N
VV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCi0NCi0gICAgLypyZXNldCBoZWFkIGFuZCB0YWlsIHBv
aW50ZXIgbWFudWFsbHkgYmVmb3JlIGVuYWJsZW1lbnQgKi8NCisgICAgLyogUmVzZXQgaGVhZCBh
bmQgdGFpbCBwb2ludGVyIG1hbnVhbGx5IGJlZm9yZSBlbmFibGVtZW50ICovDQogICAgICBpZiAo
IGVuYWJsZSApDQogICAgICB7DQogICAgICAgICAgd3JpdGVxKDAsIGlvbW11LT5tbWlvX2Jhc2Ug
KyBJT01NVV9FVkVOVF9MT0dfSEVBRF9PRkZTRVQpOw0KICAgICAgICAgIHdyaXRlcSgwLCBpb21t
dS0+bW1pb19iYXNlICsgSU9NTVVfRVZFTlRfTE9HX1RBSUxfT0ZGU0VUKTsNCi0NCi0gICAgICAg
IGlvbW11X3NldF9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19JTlRfU0hJRlQp
Ow0KLSAgICAgICAgaW9tbXVfc2V0X2JpdCgmZW50cnksIElPTU1VX0NPTlRST0xfRVZFTlRfTE9H
X0VOQUJMRV9TSElGVCk7DQotICAgIH0NCi0gICAgZWxzZQ0KLSAgICB7DQotICAgICAgICBpb21t
dV9jbGVhcl9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX0VWRU5UX0xPR19JTlRfU0hJRlQpOw0K
LSAgICAgICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0df
RU5BQkxFX1NISUZUKTsNCiAgICAgIH0NCiAgDQotICAgIGlvbW11X2NsZWFyX2JpdCgmZW50cnks
IElPTU1VX0NPTlRST0xfQ09NUF9XQUlUX0lOVF9TSElGVCk7DQorICAgIGlvbW11LT5jdHJsLmV2
ZW50X2ludF9lbiA9IGVuYWJsZTsNCisgICAgaW9tbXUtPmN0cmwuZXZlbnRfbG9nX2VuID0gZW5h
YmxlOw0KKyAgICBpb21tdS0+Y3RybC5jb21fd2FpdF9pbnRfZW4gPSBmYWxzZTsNCiAgDQotICAg
IHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9fYmFzZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZT
RVQpOw0KKyAgICB3cml0ZXEoaW9tbXUtPmN0cmwucmF3LCBpb21tdS0+bW1pb19iYXNlICsgSU9N
TVVfQ09OVFJPTF9NTUlPX09GRlNFVCk7DQogIH0NCiAgDQogIHN0YXRpYyB2b2lkIHNldF9pb21t
dV9wcHJfbG9nX2NvbnRyb2woc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsDQotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgZW5hYmxlKQ0KKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYm9vbCBlbmFibGUpDQogIHsNCi0gICAgdTMyIGVudHJ5Ow0K
LQ0KLSAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01N
SU9fT0ZGU0VUKTsNCi0NCi0gICAgLypyZXNldCBoZWFkIGFuZCB0YWlsIHBvaW50ZXIgbWFudWFs
bHkgYmVmb3JlIGVuYWJsZW1lbnQgKi8NCisgICAgLyogUmVzZXQgaGVhZCBhbmQgdGFpbCBwb2lu
dGVyIG1hbnVhbGx5IGJlZm9yZSBlbmFibGVtZW50ICovDQogICAgICBpZiAoIGVuYWJsZSApDQog
ICAgICB7DQogICAgICAgICAgd3JpdGVxKDAsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9QUFJf
TE9HX0hFQURfT0ZGU0VUKTsNCiAgICAgICAgICB3cml0ZXEoMCwgaW9tbXUtPm1taW9fYmFzZSAr
IElPTU1VX1BQUl9MT0dfVEFJTF9PRkZTRVQpOw0KLQ0KLSAgICAgICAgaW9tbXVfc2V0X2JpdCgm
ZW50cnksIElPTU1VX0NPTlRST0xfUFBSX0VOQUJMRV9TSElGVCk7DQotICAgICAgICBpb21tdV9z
ZXRfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9QUFJfTE9HX0lOVF9TSElGVCk7DQotICAgICAg
ICBpb21tdV9zZXRfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9QUFJfTE9HX0VOQUJMRV9TSElG
VCk7DQotICAgIH0NCi0gICAgZWxzZQ0KLSAgICB7DQotICAgICAgICBpb21tdV9jbGVhcl9iaXQo
JmVudHJ5LCBJT01NVV9DT05UUk9MX1BQUl9FTkFCTEVfU0hJRlQpOw0KLSAgICAgICAgaW9tbXVf
Y2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9QUFJfTE9HX0lOVF9TSElGVCk7DQotICAg
ICAgICBpb21tdV9jbGVhcl9iaXQoJmVudHJ5LCBJT01NVV9DT05UUk9MX1BQUl9MT0dfRU5BQkxF
X1NISUZUKTsNCiAgICAgIH0NCiAgDQotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9fYmFz
ZSArIElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOw0KKyAgICBpb21tdS0+Y3RybC5wcHJfZW4g
PSBlbmFibGU7DQorICAgIGlvbW11LT5jdHJsLnBwcl9pbnRfZW4gPSBlbmFibGU7DQorICAgIGlv
bW11LT5jdHJsLnBwcl9sb2dfZW4gPSBlbmFibGU7DQorDQorICAgIHdyaXRlcShpb21tdS0+Y3Ry
bC5yYXcsIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCisN
CiAgICAgIGlmICggZW5hYmxlICkNCiAgICAgICAgICBBTURfSU9NTVVfREVCVUcoIlBQUiBMb2cg
RW5hYmxlZC5cbiIpOw0KICB9DQpAQCAtMzk4LDcgKzM0OCw3IEBAIHN0YXRpYyBpbnQgaW9tbXVf
cmVhZF9sb2coc3RydWN0IGFtZF9pb20NCiAgLyogcmVzZXQgZXZlbnQgbG9nIG9yIHBwciBsb2cg
d2hlbiBvdmVyZmxvdyAqLw0KICBzdGF0aWMgdm9pZCBpb21tdV9yZXNldF9sb2coc3RydWN0IGFt
ZF9pb21tdSAqaW9tbXUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgcmlu
Z19idWZmZXIgKmxvZywNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAoKmN0cmxf
ZnVuYykoc3RydWN0IGFtZF9pb21tdSAqaW9tbXUsIGludCkpDQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZvaWQgKCpjdHJsX2Z1bmMpKHN0cnVjdCBhbWRfaW9tbXUgKmlvbW11LCBib29s
KSkNCiAgew0KICAgICAgdTMyIGVudHJ5Ow0KICAgICAgaW50IGxvZ19ydW4sIHJ1bl9iaXQ7DQpA
QCAtNjE1LDExICs1NjUsMTEgQEAgc3RhdGljIHZvaWQgaW9tbXVfY2hlY2tfZXZlbnRfbG9nKHN0
cnVjdA0KICAgICAgICAgIGlvbW11X3Jlc2V0X2xvZyhpb21tdSwgJmlvbW11LT5ldmVudF9sb2cs
IHNldF9pb21tdV9ldmVudF9sb2dfY29udHJvbCk7DQogICAgICBlbHNlDQogICAgICB7DQotICAg
ICAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9f
T0ZGU0VUKTsNCi0gICAgICAgIGlmICggIShlbnRyeSAmIElPTU1VX0NPTlRST0xfRVZFTlRfTE9H
X0lOVF9NQVNLKSApDQorICAgICAgICBpZiAoICFpb21tdS0+Y3RybC5ldmVudF9pbnRfZW4gKQ0K
ICAgICAgICAgIHsNCi0gICAgICAgICAgICBlbnRyeSB8PSBJT01NVV9DT05UUk9MX0VWRU5UX0xP
R19JTlRfTUFTSzsNCi0gICAgICAgICAgICB3cml0ZWwoZW50cnksIGlvbW11LT5tbWlvX2Jhc2Ug
KyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCisgICAgICAgICAgICBpb21tdS0+Y3RybC5l
dmVudF9pbnRfZW4gPSB0cnVlOw0KKyAgICAgICAgICAgIHdyaXRlcShpb21tdS0+Y3RybC5yYXcs
DQorICAgICAgICAgICAgICAgICAgIGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01N
SU9fT0ZGU0VUKTsNCiAgICAgICAgICAgICAgLyoNCiAgICAgICAgICAgICAgICogUmUtc2NoZWR1
bGUgdGhlIHRhc2tsZXQgdG8gaGFuZGxlIGV2ZW50dWFsIGxvZyBlbnRyaWVzIGFkZGVkDQogICAg
ICAgICAgICAgICAqIGJldHdlZW4gcmVhZGluZyB0aGUgbG9nIGFib3ZlIGFuZCByZS1lbmFibGlu
ZyB0aGUgaW50ZXJydXB0Lg0KQEAgLTcwNCwxMSArNjU0LDExIEBAIHN0YXRpYyB2b2lkIGlvbW11
X2NoZWNrX3Bwcl9sb2coc3RydWN0IGENCiAgICAgICAgICBpb21tdV9yZXNldF9sb2coaW9tbXUs
ICZpb21tdS0+cHByX2xvZywgc2V0X2lvbW11X3Bwcl9sb2dfY29udHJvbCk7DQogICAgICBlbHNl
DQogICAgICB7DQotICAgICAgICBlbnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01N
VV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCi0gICAgICAgIGlmICggIShlbnRyeSAmIElPTU1VX0NP
TlRST0xfUFBSX0xPR19JTlRfTUFTSykgKQ0KKyAgICAgICAgaWYgKCAhaW9tbXUtPmN0cmwucHBy
X2ludF9lbiApDQogICAgICAgICAgew0KLSAgICAgICAgICAgIGVudHJ5IHw9IElPTU1VX0NPTlRS
T0xfUFBSX0xPR19JTlRfTUFTSzsNCi0gICAgICAgICAgICB3cml0ZWwoZW50cnksIGlvbW11LT5t
bWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VUKTsNCisgICAgICAgICAgICBpb21t
dS0+Y3RybC5wcHJfaW50X2VuID0gdHJ1ZTsNCisgICAgICAgICAgICB3cml0ZXEoaW9tbXUtPmN0
cmwucmF3LA0KKyAgICAgICAgICAgICAgICAgICBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09O
VFJPTF9NTUlPX09GRlNFVCk7DQogICAgICAgICAgICAgIC8qDQogICAgICAgICAgICAgICAqIFJl
LXNjaGVkdWxlIHRoZSB0YXNrbGV0IHRvIGhhbmRsZSBldmVudHVhbCBsb2cgZW50cmllcyBhZGRl
ZA0KICAgICAgICAgICAgICAgKiBiZXR3ZWVuIHJlYWRpbmcgdGhlIGxvZyBhYm92ZSBhbmQgcmUt
ZW5hYmxpbmcgdGhlIGludGVycnVwdC4NCkBAIC03NTQsNyArNzA0LDYgQEAgc3RhdGljIHZvaWQg
ZG9fYW1kX2lvbW11X2lycSh1bnNpZ25lZCBsbw0KICBzdGF0aWMgdm9pZCBpb21tdV9pbnRlcnJ1
cHRfaGFuZGxlcihpbnQgaXJxLCB2b2lkICpkZXZfaWQsDQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQ0KICB7DQotICAgIHUz
MiBlbnRyeTsNCiAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7DQogICAgICBzdHJ1Y3QgYW1kX2lv
bW11ICppb21tdSA9IGRldl9pZDsNCiAgDQpAQCAtNzY0LDEwICs3MTMsOSBAQCBzdGF0aWMgdm9p
ZCBpb21tdV9pbnRlcnJ1cHRfaGFuZGxlcihpbnQNCiAgICAgICAqIFNpbGVuY2UgaW50ZXJydXB0
cyBmcm9tIGJvdGggZXZlbnQgYW5kIFBQUiBieSBjbGVhcmluZyB0aGUNCiAgICAgICAqIGVuYWJs
ZSBsb2dnaW5nIGJpdHMgaW4gdGhlIGNvbnRyb2wgcmVnaXN0ZXINCiAgICAgICAqLw0KLSAgICBl
bnRyeSA9IHJlYWRsKGlvbW11LT5tbWlvX2Jhc2UgKyBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VU
KTsNCi0gICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0df
SU5UX1NISUZUKTsNCi0gICAgaW9tbXVfY2xlYXJfYml0KCZlbnRyeSwgSU9NTVVfQ09OVFJPTF9Q
UFJfTE9HX0lOVF9TSElGVCk7DQotICAgIHdyaXRlbChlbnRyeSwgaW9tbXUtPm1taW9fYmFzZSAr
IElPTU1VX0NPTlRST0xfTU1JT19PRkZTRVQpOw0KKyAgICBpb21tdS0+Y3RybC5ldmVudF9pbnRf
ZW4gPSBmYWxzZTsNCisgICAgaW9tbXUtPmN0cmwucHByX2ludF9lbiA9IGZhbHNlOw0KKyAgICB3
cml0ZXEoaW9tbXUtPmN0cmwucmF3LCBpb21tdS0+bW1pb19iYXNlICsgSU9NTVVfQ09OVFJPTF9N
TUlPX09GRlNFVCk7DQogIA0KICAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmaW9tbXUtPmxv
Y2ssIGZsYWdzKTsNCiAgDQotLS0gYS94ZW4vaW5jbHVkZS9hc20teDg2L2FtZC1pb21tdS5oDQor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2FtZC1pb21tdS5oDQpAQCAtODgsNiArODgsOCBAQCBz
dHJ1Y3QgYW1kX2lvbW11IHsNCiAgICAgIHZvaWQgKm1taW9fYmFzZTsNCiAgICAgIHVuc2lnbmVk
IGxvbmcgbW1pb19iYXNlX3BoeXM7DQogIA0KKyAgICB1bmlvbiBhbWRfaW9tbXVfY29udHJvbCBj
dHJsOw0KKw0KICAgICAgc3RydWN0IHRhYmxlX3N0cnVjdCBkZXZfdGFibGU7DQogICAgICBzdHJ1
Y3QgcmluZ19idWZmZXIgY21kX2J1ZmZlcjsNCiAgICAgIHN0cnVjdCByaW5nX2J1ZmZlciBldmVu
dF9sb2c7DQpAQCAtMTcyLDcgKzE3NCw3IEBAIHN0cnVjdCBndWVzdF9pb21tdSB7DQogICAgICB1
aW50NjRfdCAgICAgICAgICAgICAgICBtbWlvX2Jhc2U7ICAgICAgICAgICAgIC8qIE1NSU8gYmFz
ZSBhZGRyZXNzICovDQogIA0KICAgICAgLyogTU1JTyByZWdzICovDQotICAgIHN0cnVjdCBtbWlv
X3JlZyAgICAgICAgIHJlZ19jdHJsOyAgICAgICAgICAgICAgLyogTU1JTyBvZmZzZXQgMDAxOGgg
Ki8NCisgICAgdW5pb24gYW1kX2lvbW11X2NvbnRyb2wgcmVnX2N0cmw7ICAgICAgICAgICAgICAv
KiBNTUlPIG9mZnNldCAwMDE4aCAqLw0KICAgICAgc3RydWN0IG1taW9fcmVnICAgICAgICAgcmVn
X3N0YXR1czsgICAgICAgICAgICAvKiBNTUlPIG9mZnNldCAyMDIwaCAqLw0KICAgICAgdW5pb24g
YW1kX2lvbW11X2V4dF9mZWF0dXJlcyByZWdfZXh0X2ZlYXR1cmU7ICAvKiBNTUlPIG9mZnNldCAw
MDMwaCAqLw0KICANCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL3N2bS9hbWQtaW9tbXUt
ZGVmcy5oDQorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2h2bS9zdm0vYW1kLWlvbW11LWRlZnMu
aA0KQEAgLTI5NSwzOCArMjk1LDU2IEBAIHN0cnVjdCBhbWRfaW9tbXVfZHRlIHsNCiAgDQogIC8q
IENvbnRyb2wgUmVnaXN0ZXIgKi8NCiAgI2RlZmluZSBJT01NVV9DT05UUk9MX01NSU9fT0ZGU0VU
CQkJMHgxOA0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9UUkFOU0xBVElPTl9FTkFCTEVfTUFTSwkJ
MHgwMDAwMDAwMQ0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9UUkFOU0xBVElPTl9FTkFCTEVfU0hJ
RlQJCTANCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfSFRfVFVOTkVMX1RSQU5TTEFUSU9OX01BU0sJ
MHgwMDAwMDAwMg0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9IVF9UVU5ORUxfVFJBTlNMQVRJT05f
U0hJRlQJMQ0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0dfRU5BQkxFX01BU0sJCTB4
MDAwMDAwMDQNCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfRVZFTlRfTE9HX0VOQUJMRV9TSElGVAkJ
Mg0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9FVkVOVF9MT0dfSU5UX01BU0sJCTB4MDAwMDAwMDgN
Ci0jZGVmaW5lIElPTU1VX0NPTlRST0xfRVZFTlRfTE9HX0lOVF9TSElGVAkJMw0KLSNkZWZpbmUg
SU9NTVVfQ09OVFJPTF9DT01QX1dBSVRfSU5UX01BU0sJCTB4MDAwMDAwMTANCi0jZGVmaW5lIElP
TU1VX0NPTlRST0xfQ09NUF9XQUlUX0lOVF9TSElGVAkJNA0KLSNkZWZpbmUgSU9NTVVfQ09OVFJP
TF9JTlZBTElEQVRJT05fVElNRU9VVF9NQVNLCQkweDAwMDAwMEUwDQotI2RlZmluZSBJT01NVV9D
T05UUk9MX0lOVkFMSURBVElPTl9USU1FT1VUX1NISUZUCTUNCi0jZGVmaW5lIElPTU1VX0NPTlRS
T0xfUEFTU19QT1NURURfV1JJVEVfTUFTSwkJMHgwMDAwMDEwMA0KLSNkZWZpbmUgSU9NTVVfQ09O
VFJPTF9QQVNTX1BPU1RFRF9XUklURV9TSElGVAkJOA0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9S
RVNQX1BBU1NfUE9TVEVEX1dSSVRFX01BU0sJMHgwMDAwMDIwMA0KLSNkZWZpbmUgSU9NTVVfQ09O
VFJPTF9SRVNQX1BBU1NfUE9TVEVEX1dSSVRFX1NISUZUCTkNCi0jZGVmaW5lIElPTU1VX0NPTlRS
T0xfQ09IRVJFTlRfTUFTSwkJCTB4MDAwMDA0MDANCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfQ09I
RVJFTlRfU0hJRlQJCQkxMA0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9JU09DSFJPTk9VU19NQVNL
CQkJMHgwMDAwMDgwMA0KLSNkZWZpbmUgSU9NTVVfQ09OVFJPTF9JU09DSFJPTk9VU19TSElGVAkJ
CTExDQotI2RlZmluZSBJT01NVV9DT05UUk9MX0NPTU1BTkRfQlVGRkVSX0VOQUJMRV9NQVNLCTB4
MDAwMDEwMDANCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfQ09NTUFORF9CVUZGRVJfRU5BQkxFX1NI
SUZUCTEyDQotI2RlZmluZSBJT01NVV9DT05UUk9MX1BQUl9MT0dfRU5BQkxFX01BU0sJCTB4MDAw
MDIwMDANCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfUFBSX0xPR19FTkFCTEVfU0hJRlQJCTEzDQot
I2RlZmluZSBJT01NVV9DT05UUk9MX1BQUl9MT0dfSU5UX01BU0sJCQkweDAwMDA0MDAwDQotI2Rl
ZmluZSBJT01NVV9DT05UUk9MX1BQUl9MT0dfSU5UX1NISUZUCQkJMTQNCi0jZGVmaW5lIElPTU1V
X0NPTlRST0xfUFBSX0VOQUJMRV9NQVNLCQkJMHgwMDAwODAwMA0KLSNkZWZpbmUgSU9NTVVfQ09O
VFJPTF9QUFJfRU5BQkxFX1NISUZUCQkJMTUNCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfR1RfRU5B
QkxFX01BU0sJCQkweDAwMDEwMDAwDQotI2RlZmluZSBJT01NVV9DT05UUk9MX0dUX0VOQUJMRV9T
SElGVAkJCTE2DQotI2RlZmluZSBJT01NVV9DT05UUk9MX1JFU1RBUlRfTUFTSwkJCTB4ODAwMDAw
MDANCi0jZGVmaW5lIElPTU1VX0NPTlRST0xfUkVTVEFSVF9TSElGVAkJCTMxDQorDQordW5pb24g
YW1kX2lvbW11X2NvbnRyb2wgew0KKyAgICB1aW50NjRfdCByYXc7DQorICAgIHN0cnVjdCB7DQor
ICAgICAgICBib29sIGlvbW11X2VuOjE7DQorICAgICAgICBib29sIGh0X3R1bl9lbjoxOw0KKyAg
ICAgICAgYm9vbCBldmVudF9sb2dfZW46MTsNCisgICAgICAgIGJvb2wgZXZlbnRfaW50X2VuOjE7
DQorICAgICAgICBib29sIGNvbV93YWl0X2ludF9lbjoxOw0KKyAgICAgICAgdW5zaWduZWQgaW50
IGludl90aW1lb3V0OjM7DQorICAgICAgICBib29sIHBhc3NfcHc6MTsNCisgICAgICAgIGJvb2wg
cmVzX3Bhc3NfcHc6MTsNCisgICAgICAgIGJvb2wgY29oZXJlbnQ6MTsNCisgICAgICAgIGJvb2wg
aXNvYzoxOw0KKyAgICAgICAgYm9vbCBjbWRfYnVmX2VuOjE7DQorICAgICAgICBib29sIHBwcl9s
b2dfZW46MTsNCisgICAgICAgIGJvb2wgcHByX2ludF9lbjoxOw0KKyAgICAgICAgYm9vbCBwcHJf
ZW46MTsNCisgICAgICAgIGJvb2wgZ3RfZW46MTsNCisgICAgICAgIGJvb2wgZ2FfZW46MTsNCisg
ICAgICAgIHVuc2lnbmVkIGludCBjcnc6NDsNCisgICAgICAgIGJvb2wgc21pZl9lbjoxOw0KKyAg
ICAgICAgYm9vbCBzbGZfd2JfZGlzOjE7DQorICAgICAgICBib29sIHNtaWZfbG9nX2VuOjE7DQor
ICAgICAgICB1bnNpZ25lZCBpbnQgZ2FtX2VuOjM7DQorICAgICAgICBib29sIGdhX2xvZ19lbjox
Ow0KKyAgICAgICAgYm9vbCBnYV9pbnRfZW46MTsNCisgICAgICAgIHVuc2lnbmVkIGludCBkdWFs
X3Bwcl9sb2dfZW46MjsNCisgICAgICAgIHVuc2lnbmVkIGludCBkdWFsX2V2ZW50X2xvZ19lbjoy
Ow0KKyAgICAgICAgdW5zaWduZWQgaW50IGRldl90Ymxfc2VnX2VuOjM7DQorICAgICAgICB1bnNp
Z25lZCBpbnQgcHJpdl9hYnJ0X2VuOjI7DQorICAgICAgICBib29sIHBwcl9hdXRvX3JzcF9lbjox
Ow0KKyAgICAgICAgYm9vbCBtYXJjX2VuOjE7DQorICAgICAgICBib29sIGJsa19zdG9wX21ya19l
bjoxOw0KKyAgICAgICAgYm9vbCBwcHJfYXV0b19yc3BfYW9uOjE7DQorICAgICAgICBib29sIGRv
bWFpbl9pZF9wbmU6MTsNCisgICAgICAgIHVuc2lnbmVkIGludCA6MTsNCisgICAgICAgIGJvb2wg
ZXBoX2VuOjE7DQorICAgICAgICB1bnNpZ25lZCBpbnQgaGFkX3VwZGF0ZToyOw0KKyAgICAgICAg
Ym9vbCBnZF91cGRhdGVfZGlzOjE7DQorICAgICAgICB1bnNpZ25lZCBpbnQgOjE7DQorICAgICAg
ICBib29sIHh0X2VuOjE7DQorICAgICAgICBib29sIGludF9jYXBfeHRfZW46MTsNCisgICAgICAg
IGJvb2wgdmNtZF9lbjoxOw0KKyAgICAgICAgYm9vbCB2aW9tbXVfZW46MTsNCisgICAgICAgIGJv
b2wgZ2FfdXBkYXRlX2RpczoxOw0KKyAgICAgICAgYm9vbCBnYXBwaV9lbjoxOw0KKyAgICAgICAg
dW5zaWduZWQgaW50IDo4Ow0KKyAgICB9Ow0KK307DQogIA0KICAvKiBFeGNsdXNpb24gUmVnaXN0
ZXIgKi8NCiAgI2RlZmluZSBJT01NVV9FWENMVVNJT05fQkFTRV9MT1dfT0ZGU0VUCQkweDIwDQoN
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZl
bCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlz
dHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=

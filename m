Return-Path: <xen-devel-bounces@lists.xenproject.org>
X-Original-To: lists+xen-devel@lfdr.de
Delivered-To: lists+xen-devel@lfdr.de
Received: from lists.xenproject.org (lists.xenproject.org [192.237.175.120])
	by mail.lfdr.de (Postfix) with ESMTPS id 6AD39E141
	for <lists+xen-devel@lfdr.de>; Mon, 29 Apr 2019 13:27:36 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1hL4Os-0007xx-Ah; Mon, 29 Apr 2019 11:24:46 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <SRS0=Gpsw=S7=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1hL4Oq-0007xe-FS
 for xen-devel@lists.xenproject.org; Mon, 29 Apr 2019 11:24:44 +0000
X-Inumbo-ID: 62bac5e2-6a71-11e9-843c-bc764e045a96
Received: from prv1-mh.provo.novell.com (unknown [137.65.248.33])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 62bac5e2-6a71-11e9-843c-bc764e045a96;
 Mon, 29 Apr 2019 11:24:43 +0000 (UTC)
Received: from INET-PRV1-MTA by prv1-mh.provo.novell.com
 with Novell_GroupWise; Mon, 29 Apr 2019 05:24:43 -0600
Message-Id: <5CC6DEF70200007800229EA3@prv1-mh.provo.novell.com>
X-Mailer: Novell GroupWise Internet Agent 18.1.0 
Date: Mon, 29 Apr 2019 05:24:39 -0600
From: "Jan Beulich" <JBeulich@suse.com>
To: "xen-devel" <xen-devel@lists.xenproject.org>
References: <5CC6DD090200007800229E80@prv1-mh.provo.novell.com>
In-Reply-To: <5CC6DD090200007800229E80@prv1-mh.provo.novell.com>
Mime-Version: 1.0
Content-Disposition: inline
Subject: [Xen-devel] [PATCH 4/9] x86/IRQ: desc->affinity should strictly
 represent the requested value
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wei.liu2@citrix.com>,
 Roger Pau Monne <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: "Xen-devel" <xen-devel-bounces@lists.xenproject.org>

ZGVzYy0+YXJjaC5jcHVfbWFzayByZWZsZWN0cyB0aGUgYWN0dWFsIHNldCBvZiB0YXJnZXQgQ1BV
cy4gRG9uJ3QgZXZlcgpmaWRkbGUgd2l0aCBkZXNjLT5hZmZpbml0eSBpdHNlbGYsIGV4Y2VwdCB0
byBzdG9yZSBjYWxsZXIgcmVxdWVzdGVkCnZhbHVlcy4KClRoaXMgcmVuZGVycyBib3RoIHNldF9u
YXRpdmVfaXJxX2luZm8oKSB1c2VzICh3aGljaCB3ZXJlbid0IHVzaW5nIHByb3Blcgpsb2NraW5n
IGFueXdheSkgcmVkdW5kYW50IC0gZHJvcCB0aGUgZnVuY3Rpb24gYWx0b2dldGhlci4KClNpZ25l
ZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBzdXNlLmNvbT4KCi0tLSBhL3hlbi9hcmNo
L3g4Ni9pb19hcGljLmMKKysrIGIveGVuL2FyY2gveDg2L2lvX2FwaWMuYwpAQCAtMTA0Miw3ICsx
MDQyLDYgQEAgc3RhdGljIHZvaWQgX19pbml0IHNldHVwX0lPX0FQSUNfaXJxcyh2bwogICAgICAg
ICAgICAgU0VUX0RFU1QoZW50cnksIGxvZ2ljYWwsIGNwdV9tYXNrX3RvX2FwaWNpZChUQVJHRVRf
Q1BVUykpOwogICAgICAgICAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlvYXBpY19sb2NrLCBmbGFn
cyk7CiAgICAgICAgICAgICBfX2lvYXBpY193cml0ZV9lbnRyeShhcGljLCBwaW4sIDAsIGVudHJ5
KTsKLSAgICAgICAgICAgIHNldF9uYXRpdmVfaXJxX2luZm8oaXJxLCBUQVJHRVRfQ1BVUyk7CiAg
ICAgICAgICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZpb2FwaWNfbG9jaywgZmxhZ3MpOwog
ICAgICAgICB9CiAgICAgfQpAQCAtMjI1MSw3ICsyMjUwLDYgQEAgaW50IGlvX2FwaWNfc2V0X3Bj
aV9yb3V0aW5nIChpbnQgaW9hcGljLAogCiAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJmlvYXBpY19s
b2NrLCBmbGFncyk7CiAgICAgX19pb2FwaWNfd3JpdGVfZW50cnkoaW9hcGljLCBwaW4sIDAsIGVu
dHJ5KTsKLSAgICBzZXRfbmF0aXZlX2lycV9pbmZvKGlycSwgVEFSR0VUX0NQVVMpOwogICAgIHNw
aW5fdW5sb2NrKCZpb2FwaWNfbG9jayk7CiAKICAgICBzcGluX2xvY2soJmRlc2MtPmxvY2spOwot
LS0gYS94ZW4vYXJjaC94ODYvaXJxLmMKKysrIGIveGVuL2FyY2gveDg2L2lycS5jCkBAIC01NzIs
MTEgKzU3MiwxNiBAQCBpbnQgYXNzaWduX2lycV92ZWN0b3IoaW50IGlycSwgY29uc3QgY3B1CiAK
ICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmdmVjdG9yX2xvY2ssIGZsYWdzKTsKICAgICByZXQgPSBf
X2Fzc2lnbl9pcnFfdmVjdG9yKGlycSwgZGVzYywgbWFzayA/OiBUQVJHRVRfQ1BVUyk7Ci0gICAg
aWYgKCFyZXQpIHsKKyAgICBpZiAoICFyZXQgKQorICAgIHsKICAgICAgICAgcmV0ID0gZGVzYy0+
YXJjaC52ZWN0b3I7Ci0gICAgICAgIGNwdW1hc2tfY29weShkZXNjLT5hZmZpbml0eSwgZGVzYy0+
YXJjaC5jcHVfbWFzayk7CisgICAgICAgIGlmICggbWFzayApCisgICAgICAgICAgICBjcHVtYXNr
X2NvcHkoZGVzYy0+YWZmaW5pdHksIG1hc2spOworICAgICAgICBlbHNlCisgICAgICAgICAgICBj
cHVtYXNrX3NldGFsbChkZXNjLT5hZmZpbml0eSk7CiAgICAgfQogICAgIHNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJnZlY3Rvcl9sb2NrLCBmbGFncyk7CisKICAgICByZXR1cm4gcmV0OwogfQogCkBA
IC0yMzE4LDkgKzIzMjMsMTAgQEAgc3RhdGljIHZvaWQgZHVtcF9pcnFzKHVuc2lnbmVkIGNoYXIg
a2V5KQogCiAgICAgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZkZXNjLT5sb2NrLCBmbGFncyk7CiAK
LSAgICAgICAgcHJpbnRrKCIgICBJUlE6JTRkIGFmZjolKnBiIHZlYzolMDJ4ICUtMTVzIHN0YXR1
cz0lMDN4ICIsCi0gICAgICAgICAgICAgICBpcnEsIG5yX2NwdV9pZHMsIGNwdW1hc2tfYml0cyhk
ZXNjLT5hZmZpbml0eSksIGRlc2MtPmFyY2gudmVjdG9yLAotICAgICAgICAgICAgICAgZGVzYy0+
aGFuZGxlci0+dHlwZW5hbWUsIGRlc2MtPnN0YXR1cyk7CisgICAgICAgIHByaW50aygiICAgSVJR
OiU0ZCBhZmY6JSpwYi8lKnBiIHZlYzolMDJ4ICUtMTVzIHN0YXR1cz0lMDN4ICIsCisgICAgICAg
ICAgICAgICBpcnEsIG5yX2NwdV9pZHMsIGNwdW1hc2tfYml0cyhkZXNjLT5hZmZpbml0eSksCisg
ICAgICAgICAgICAgICBucl9jcHVfaWRzLCBjcHVtYXNrX2JpdHMoZGVzYy0+YXJjaC5jcHVfbWFz
ayksCisgICAgICAgICAgICAgICBkZXNjLT5hcmNoLnZlY3RvciwgZGVzYy0+aGFuZGxlci0+dHlw
ZW5hbWUsIGRlc2MtPnN0YXR1cyk7CiAKICAgICAgICAgaWYgKCBzc2lkICkKICAgICAgICAgICAg
IHByaW50aygiWj0lLTI1cyAiLCBzc2lkKTsKQEAgLTI0MDgsOCArMjQxNCw3IEBAIHZvaWQgZml4
dXBfaXJxcyhjb25zdCBjcHVtYXNrX3QgKm1hc2ssIGIKICAgICAgICAgICAgICAgICByZWxlYXNl
X29sZF92ZWMoZGVzYyk7CiAgICAgICAgIH0KIAotICAgICAgICBjcHVtYXNrX2NvcHkoJmFmZmlu
aXR5LCBkZXNjLT5hZmZpbml0eSk7Ci0gICAgICAgIGlmICggIWRlc2MtPmFjdGlvbiB8fCBjcHVt
YXNrX3N1YnNldCgmYWZmaW5pdHksIG1hc2spICkKKyAgICAgICAgaWYgKCAhZGVzYy0+YWN0aW9u
IHx8IGNwdW1hc2tfc3Vic2V0KGRlc2MtPmFmZmluaXR5LCBtYXNrKSApCiAgICAgICAgIHsKICAg
ICAgICAgICAgIHNwaW5fdW5sb2NrKCZkZXNjLT5sb2NrKTsKICAgICAgICAgICAgIGNvbnRpbnVl
OwpAQCAtMjQzMywxMiArMjQzOCwxMyBAQCB2b2lkIGZpeHVwX2lycXMoY29uc3QgY3B1bWFza190
ICptYXNrLCBiCiAgICAgICAgICAgICBkZXNjLT5hcmNoLm1vdmVfaW5fcHJvZ3Jlc3MgPSAwOwog
ICAgICAgICB9CiAKLSAgICAgICAgY3B1bWFza19hbmQoJmFmZmluaXR5LCAmYWZmaW5pdHksIG1h
c2spOwotICAgICAgICBpZiAoIGNwdW1hc2tfZW1wdHkoJmFmZmluaXR5KSApCisgICAgICAgIGlm
ICggIWNwdW1hc2tfaW50ZXJzZWN0cyhtYXNrLCBkZXNjLT5hZmZpbml0eSkgKQogICAgICAgICB7
CiAgICAgICAgICAgICBicmVha19hZmZpbml0eSA9IHRydWU7Ci0gICAgICAgICAgICBjcHVtYXNr
X2NvcHkoJmFmZmluaXR5LCBtYXNrKTsKKyAgICAgICAgICAgIGNwdW1hc2tfc2V0YWxsKCZhZmZp
bml0eSk7CiAgICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICAgICAgY3B1bWFza19jb3B5
KCZhZmZpbml0eSwgZGVzYy0+YWZmaW5pdHkpOwogCiAgICAgICAgIGlmICggZGVzYy0+aGFuZGxl
ci0+ZGlzYWJsZSApCiAgICAgICAgICAgICBkZXNjLT5oYW5kbGVyLT5kaXNhYmxlKGRlc2MpOwot
LS0gYS94ZW4vaW5jbHVkZS94ZW4vaXJxLmgKKysrIGIveGVuL2luY2x1ZGUveGVuL2lycS5oCkBA
IC0xNjIsMTEgKzE2Miw2IEBAIGV4dGVybiBpcnFfZGVzY190ICpkb21haW5fc3Bpbl9sb2NrX2ly
cV8KIGV4dGVybiBpcnFfZGVzY190ICpwaXJxX3NwaW5fbG9ja19pcnFfZGVzYygKICAgICBjb25z
dCBzdHJ1Y3QgcGlycSAqLCB1bnNpZ25lZCBsb25nICpwZmxhZ3MpOwogCi1zdGF0aWMgaW5saW5l
IHZvaWQgc2V0X25hdGl2ZV9pcnFfaW5mbyh1bnNpZ25lZCBpbnQgaXJxLCBjb25zdCBjcHVtYXNr
X3QgKm1hc2spCi17Ci0gICAgY3B1bWFza19jb3B5KGlycV90b19kZXNjKGlycSktPmFmZmluaXR5
LCBtYXNrKTsKLX0KLQogdW5zaWduZWQgaW50IHNldF9kZXNjX2FmZmluaXR5KHN0cnVjdCBpcnFf
ZGVzYyAqLCBjb25zdCBjcHVtYXNrX3QgKik7CiAKICNpZm5kZWYgYXJjaF9od2RvbV9pcnFzCgoK
CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRl
dmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9s
aXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==
